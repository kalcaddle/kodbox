<?php
 goto E‰õÇ¹ÕÀÖ; dÀÙœöÃÎÊ: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($fŠªã˜’¸) { $this->pathParse = $fŠªã˜’¸; $this->model = Model($_SERVER[©äõ½¡][1239]); } public function getPath($f±˜¯á¶èï) { return trim($f±˜¯á¶èï, $_SERVER[©äõ½¡][8]); } public function pathFather($fÈ Š¥Æºİ) { $cõÙôÊ¹é÷ = $this->parse($fÈ Š¥Æºİ); $cõÙôÊ¹é÷ = $this->infoSimple($fÈ Š¥Æºİ); return $cõÙôÊ¹é÷ ? $cõÙôÊ¹é÷[$_SERVER[©äõ½¡][492]] : !1; } public function pathThis($aÀâÀ¨·äÑ) { $fé¿Æ½„éÊ = $this->infoSimple($aÀâÀ¨·äÑ); return $fé¿Æ½„éÊ ? $fé¿Æ½„éÊ[$_SERVER[©äõ½¡][28]] : !1; } public function getPathOuter($dæ¿ïò§¢›) { if (!$dæ¿ïò§¢›) { return $dæ¿ïò§¢›; } $B‰ôÃ™¦Ğ = $this->parse($dæ¿ïò§¢›); return KodIO::make($B‰ôÃ™¦Ğ[$_SERVER[©äõ½¡][395]]); } public function copyFolderFromIO($f…»¨çöƒï, $FˆèÉÙö¼, $D—Ó‚—Ôì, $Eä¿°ğ™‹†, $BÒŞ­†Ç‚°) { $EÓ¸½Ìª¾  = $this->model->copyFolderFromIO($f…»¨çöƒï, $FˆèÉÙö¼, $D—Ó‚—Ôì, $Eä¿°ğ™‹†, $BÒŞ­†Ç‚°); return KodIO::make($EÓ¸½Ìª¾ ); } public function isParentOf($a«÷Å…•»—, $d²ÎÙ¢Ú•) { return $this->model->isParentOf($a«÷Å…•»—, $d²ÎÙ¢Ú•); } public function mkfile($bÅİˆôİ²é, $a®•†¾æœ‡ = '', $e“Ú¼ª®æ‘ = REPEAT_RENAME) { $D‰Œ‹¼Ş‹‹ =& $_SERVER[©äõ½¡]; $F‚Õ‹Êçã· = $this->parse($bÅİˆôİ²é); $bÅİˆôİ²é = $F‚Õ‹Êçã·[$D‰Œ‹¼Ş‹‹[395]]; for ($b•Î®îò“ = 0; $b•Î®îò“ < count($F‚Õ‹Êçã·[$D‰Œ‹¼Ş‹‹[1240]]); $b•Î®îò“++) { $DàõªÑ¬î = $F‚Õ‹Êçã·[$D‰Œ‹¼Ş‹‹[1240]][$b•Î®îò“]; if ($b•Î®îò“ == count($F‚Õ‹Êçã·[$D‰Œ‹¼Ş‹‹[1240]]) - 1) { $bÅİˆôİ²é = $this->model->mkfile($bÅİˆôİ²é, $DàõªÑ¬î, $a®•†¾æœ‡, $e“Ú¼ª®æ‘); break; } $bÅİˆôİ²é = $this->model->mkdir($bÅİˆôİ²é, $DàõªÑ¬î, REPEAT_SKIP); } return $this->getPathOuter($bÅİˆôİ²é); } public function mkdir($aÎŒ¾¸Â, $e¿½‡’äÊ = REPEAT_SKIP) { $aÔî©¯” =& $_SERVER[©äõ½¡]; $A­°©ñ• = $this->parse($aÎŒ¾¸Â); $aÎŒ¾¸Â = $A­°©ñ•[$aÔî©¯”[395]]; for ($AµÜÈ¦ÙøŞ = 0; $AµÜÈ¦ÙøŞ < count($A­°©ñ•[$aÔî©¯”[1240]]); $AµÜÈ¦ÙøŞ++) { $eÂ ¢‹’ß‰ = $A­°©ñ•[$aÔî©¯”[1240]][$AµÜÈ¦ÙøŞ]; $aÎŒ¾¸Â = $this->model->mkdir($aÎŒ¾¸Â, $eÂ ¢‹’ß‰, $e¿½‡’äÊ); } return $this->getPathOuter($aÎŒ¾¸Â); } public function copyFile($c©óªîô…, $aÕ¿¶ƒƒ§Ò, $F´â ‹«¸ã = REPEAT_REPLACE) { $FÄÕçŠº =& $_SERVER[©äõ½¡]; $fÕô„±Ë¸ = $this->parse($aÕ¿¶ƒƒ§Ò); $EÓ™£Ø°³ = $this->model->copy($c©óªîô…, $fÕô„±Ë¸[$FÄÕçŠº[395]], $F´â ‹«¸ã, $fÕô„±Ë¸[$FÄÕçŠº[76]]); return $EÓ™£Ø°³ ? $this->getPathOuter($EÓ™£Ø°³) : !1; } public function moveFile($F­‘¦¸µ, $dÏ»í¢š”…, $CÀŞ¥é«ò = REPEAT_REPLACE) { $Dñ§‹Ó‚©Å =& $_SERVER[©äõ½¡]; $F«åËÜ¡ª¿ = $this->parse($dÏ»í¢š”…); $e¹óòÚ»‰ä = $this->model->move($F­‘¦¸µ, $F«åËÜ¡ª¿[$Dñ§‹Ó‚©Å[395]], $CÀŞ¥é«ò, $F«åËÜ¡ª¿[$Dñ§‹Ó‚©Å[76]]); return $e¹óòÚ»‰ä ? $this->getPathOuter($e¹óòÚ»‰ä) : !1; } public function copy($a¥“óåÖÑ®, $Dìğã›¢, $bŸ¯î²¯×ô = REPEAT_REPLACE) { $DãæóËÍ‘ç = $this->parse($Dìğã›¢); $FÛß¥‚Íê = $this->model->copy($a¥“óåÖÑ®, $DãæóËÍ‘ç[$_SERVER[©äõ½¡][395]], $bŸ¯î²¯×ô); return $FÛß¥‚Íê ? $this->getPathOuter($FÛß¥‚Íê) : !1; } public function moveSameAllow() { } public function move($b–µÙ‘×¾Á, $Cí¶ë×, $b…­¦£À± = REPEAT_REPLACE) { $c³«ƒó™ñÒ = $this->parse($Cí¶ë×); $BËÂ‚Š…¢Õ = $this->model->move($b–µÙ‘×¾Á, $c³«ƒó™ñÒ[$_SERVER[©äõ½¡][395]], $b…­¦£À±); return $BËÂ‚Š…¢Õ ? $this->getPathOuter($BËÂ‚Š…¢Õ) : !1; } public function remove($còÁë«Ô±, $AÚá‚”´ºĞ = true) { return $this->model->remove($còÁë«Ô±, $AÚá‚”´ºĞ); } public function rename($CøÜóÑğªĞ, $C…Ä‡ŞÏŒŒ) { $d÷ßî±ÁÃô = $this->model->rename($CøÜóÑğªĞ, $C…Ä‡ŞÏŒŒ); return $d÷ßî±ÁÃô ? $this->getPathOuter($CøÜóÑğªĞ) : $d÷ßî±ÁÃô; } public function size($a¦áƒãª‡) { $AÔÒ‰åº‡ = $this->infoSimple($a¦áƒãª‡); return $AÔÒ‰åº‡ ? $AÔÒ‰åº‡[$_SERVER[©äõ½¡][78]] : 0; } public function infoSimple($f™÷§Î¯İ¬) { return $this->model->sourceInfo($f™÷§Î¯İ¬); } public function info($dƒÔÌèªÏ‡) { return $this->infoParse($dƒÔÌèªÏ‡); } public function infoAuth($bÇäªè¾Ó‚) { return $this->infoParse($bÇäªè¾Ó‚, !1, !0); } public function infoWithChildren($A¸ø¢•¦‰ñ) { return $this->infoParse($A¸ø¢•¦‰ñ, !0); } protected function infoParse($DŞ”Á­‡Ì, $eîƒ·—‡ôÁ = false, $e¡÷©Úôà = false) { if (!$eîƒ·—‡ôÁ) { return $this->model->pathInfo($DŞ”Á­‡Ì, $e¡÷©Úôà); } return $this->model->pathInfoMore($DŞ”Á­‡Ì); } public function infoFull($CÑÅ„ƒ™öÔ) { $cèÕ¦ÃŠ¾¼ =& $_SERVER[©äõ½¡]; $F¢ïƒã‡†Ö = explode($cèÕ¦ÃŠ¾¼[8], $CÑÅ„ƒ™öÔ); $BÈƒó„¿Û = implode($cèÕ¦ÃŠ¾¼[8], array_splice($F¢ïƒã‡†Ö, 1)); return $this->model->pathInfoByPath($F¢ïƒã‡†Ö[0], $BÈƒó„¿Û); } public function hashSimple($d‰Åîâ†˜í) { $fë¢Ä–Õ– =& $_SERVER[©äõ½¡]; $bêÀùˆíÙô = $this->infoWithChildren($d‰Åîâ†˜í); return $bêÀùˆíÙô[$fë¢Ä–Õ–[164]][$fë¢Ä–Õ–[171]]; } public function hashMd5($aÁâ’«îÊï) { $Bõ§åœÅ®ß =& $_SERVER[©äõ½¡]; $DÚÚÛ¹ä„† = $this->infoWithChildren($aÁâ’«îÊï); return $DÚÚÛ¹ä„†[$Bõ§åœÅ®ß[164]][$Bõ§åœÅ®ß[170]]; } public function exist($dÚ¼Ğ†¿é‚) { $E ¿Ñ†Ü£÷ =& $_SERVER[©äõ½¡]; $E¬Ì¼¹ŒÑì = $this->parse($dÚ¼Ğ†¿é‚); if (!$E¬Ì¼¹ŒÑì[$E ¿Ñ†Ü£÷[76]]) { return $this->isFile($dÚ¼Ğ†¿é‚) || $this->isFolder($dÚ¼Ğ†¿é‚); } $d¾®¼ªêÄ” = array($E ¿Ñ†Ü£÷[396] => $E¬Ì¼¹ŒÑì[$E ¿Ñ†Ü£÷[395]], $E ¿Ñ†Ü£÷[28] => $E¬Ì¼¹ŒÑì[$E ¿Ñ†Ü£÷[76]]); $f‡Ÿ•É³Ñ‰ = $this->model->where($d¾®¼ªêÄ”)->find(); return $f‡Ÿ•É³Ñ‰ ? !0 : !1; } public function isFile($F¤Şñª‘Öç) { $D§é‰ë© =& $_SERVER[©äõ½¡]; $C´·¢öá”Œ = $this->infoSimple($F¤Şñª‘Öç); return $C´·¢öá”Œ && $C´·¢öá”Œ[$D§é‰ë©[405]] == $D§é‰ë©[87] ? !1 : !0; } public function isFolder($AÁ‚ğÂíÂ) { $D½“ØÒŸ»Õ =& $_SERVER[©äõ½¡]; $f¶³óÃ¡• = $this->infoSimple($AÁ‚ğÂíÂ); return $f¶³óÃ¡• && $f¶³óÃ¡•[$D½“ØÒŸ»Õ[405]] == $D½“ØÒŸ»Õ[87] ? !0 : !1; } public function listPath($eòÁ‘¦»÷Ú, $BÌ¯ôÅ = false) { $f§‚åÒ…ß =& $_SERVER[©äõ½¡]; if ($eòÁ‘¦»÷Ú == $f§‚åÒ…ß[33]) { return !1; } $bÚ¿Ø‰»ŒÏ = array($f§‚åÒ…ß[396] => $eòÁ‘¦»÷Ú); if ($BÌ¯ôÅ) { return $this->model->listSource($bÚ¿Ø‰»ŒÏ, -1); } return $this->model->listSource($bÚ¿Ø‰»ŒÏ); } public function has($eÔƒ´‹ğ, $aªİŒ—İ¾ = false, $dø§´å…Ä™ = null) { $fÙãÌ“â®Œ =& $_SERVER[©äõ½¡]; $eµÅ²¼Í³ = $this->infoWithChildren($eÔƒ´‹ğ); if ($aªİŒ—İ¾) { return array($fÙãÌ“â®Œ[204] => $eµÅ²¼Í³[$fÙãÌ“â®Œ[204]], $fÙãÌ“â®Œ[203] => $eµÅ²¼Í³[$fÙãÌ“â®Œ[203]]); } return $dø§´å…Ä™ ? $eµÅ²¼Í³[$fÙãÌ“â®Œ[204]] : $eµÅ²¼Í³[$fÙãÌ“â®Œ[203]]; } public function listAll($C¨Œå‹¸) { $dßùÓ¼ğŸ± = IO::info($this->pathParse[$_SERVER[©äõ½¡][76]]); if (!$dßùÓ¼ğŸ±) { return array(); } return $this->model->listAll($C¨Œå‹¸); } public function getContent($eê”‡„Ô»–) { return $this->model->getContent($eê”‡„Ô»–); } public function setContent($bâĞîì¿¹¬, $aõñ¸™âø = '') { return $this->model->setContent($bâĞîì¿¹¬, $aõñ¸™âø); } public function fileSubstr($AÔùÀ‹ÈùŸ, $bªôùòù’í, $BÍ±Ò„õºø) { return $this->model->fileSubstr($AÔùÀ‹ÈùŸ, $bªôùòù’í, $BÍ±Ò„õºø); } public function download($e¤»ôâÌÌ•, $Bö˜ƒ›Ï²­ = '') { $dÓ„ĞÙ³ = get_path_father($Bö˜ƒ›Ï²­); $BÃßÙß¨¹ƒ = get_path_this($Bö˜ƒ›Ï²­); $AˆÇ¢¢¨ = $this->model->fileInfoGet($e¤»ôâÌÌ•); $fÜÑ¨ß½ˆã = IO::copy($AˆÇ¢¢¨[$_SERVER[©äõ½¡][76]], $dÓ„ĞÙ³, !1, $BÃßÙß¨¹ƒ); return $fÜÑ¨ß½ˆã; } public function setModifyTime($AŒ–Œ…ë÷ì, $bÁºÖÙ½ = '') { $aĞƒ²º©‹¸ =& $_SERVER[©äõ½¡]; if (!$AŒ–Œ…ë÷ì) { return; } $this->model->where(array($aĞƒ²º©‹¸[412] => $AŒ–Œ…ë÷ì))->save(array($aĞƒ²º©‹¸[84] => $bÁºÖÙ½)); } public function upload($B–Æ÷çùà, $Fö£êéø, $c¾ã±òô¨« = false, $FáÎ‚¨³Ø = REPEAT_REPLACE) { $B…×‹ğš»â =& $_SERVER[©äõ½¡]; $c å’ÆË¼Í = $this->parse($B–Æ÷çùà); $AÎµÂÔÅôƒ = $this->model->addFile($c å’ÆË¼Í[$B…×‹ğš»â[395]], $Fö£êéø, $c å’ÆË¼Í[$B…×‹ğš»â[76]], $c¾ã±òô¨«, $FáÎ‚¨³Ø); return $this->getPathOuter($AÎµÂÔÅôƒ); } public function uploadFileByID($E‰Æ™“Ü‹, $dñ¥â—¡ğ, $eËÍå„†») { $a¤Á´ Û©İ =& $_SERVER[©äõ½¡]; $dŒµÖ˜Ø½ñ = $this->parse($E‰Æ™“Ü‹); $C„’ãçïÈ = $this->model->addFileByFileID($dŒµÖ˜Ø½ñ[$a¤Á´ Û©İ[395]], $dñ¥â—¡ğ, $dŒµÖ˜Ø½ñ[$a¤Á´ Û©İ[76]], $eËÍå„†»); return $this->getPathOuter($C„’ãçïÈ); } public function addFileByRemote($CğĞ×éïªñ, $EêÏ»öÉçŠ, $f´Ş¿‹…ë® = array(), $cøÁ½‹²ğï = '', $FëµŒ·«¯ˆ) { $Dé³´¸—ãç =& $_SERVER[©äõ½¡]; $DãÙ³ä’ ¸ = $this->parse($CğĞ×éïªñ); $cøÁ½‹²ğï = empty($cøÁ½‹²ğï) ? $DãÙ³ä’ ¸[$Dé³´¸—ãç[76]] : $cøÁ½‹²ğï; $f¡©¯ÈóØ = $this->model->addFileByRemote($DãÙ³ä’ ¸[$Dé³´¸—ãç[395]], $EêÏ»öÉçŠ, $cøÁ½‹²ğï, $f´Ş¿‹…ë®, $FëµŒ·«¯ˆ); return $this->getPathOuter($f¡©¯ÈóØ); } public function uploadLink($F”çÑÜ°è’, $fë’ÌëÊÒ = 0) { $E’Æ¹ì”† =& $_SERVER[©äõ½¡]; $f™óÕØ­Óö = $this->parse($F”çÑÜ°è’); $aÛó­£Üí = _get($GLOBALS[$E’Æ¹ì”†[7]], $E’Æ¹ì”†[1241]); $eõ‰×Öª®ò = _get($GLOBALS[$E’Æ¹ì”†[7]], $E’Æ¹ì”†[1242]); $F”çÑÜ°è’ = Model($E’Æ¹ì”†[597])->createFileName($f™óÕØ­Óö[$E’Æ¹ì”†[76]], $aÛó­£Üí, $eõ‰×Öª®ò); return IO::uploadLink($F”çÑÜ°è’, $fë’ÌëÊÒ); } public function fileNameAuto($bÁÊÌÍ…¥™, $eÎçÁù˜ˆ†, $AÅõÃØ‹ƒó = REPEAT_REPLACE, $e§¾Á»ñ–ö = false) { return $this->model->fileNameAuto($bÁÊÌÍ…¥™, $eÎçÁù˜ˆ†, $AÅõÃØ‹ƒó, $e§¾Á»ñ–ö); } public function fileNameExist($c¸Òâ†…¤, $Cô¯“—²) { return $this->model->fileNameExist($c¸Òâ†…¤, $Cô¯“—²); } protected function _fileOut($a¯äƒÏ…»ï, $EõÂ«³ÌŒÈ = false, $Bö†éÓÕĞÜ = false, $fÏ×´‡ïğõ = '', $b¯¢ğ¹Úò­ = false) { goto Eó”Ã²“Í­; fîÔˆ ÷¸ : if ($b¯¢ğ¹Úò­) { return IO::fileOutServer($FÌÓŠÙµĞ[$FĞ×É×ÙÍ[76]], $EõÂ«³ÌŒÈ, $CÀŒÑŒ°Ã«, $fÏ×´‡ïğõ); } IO::fileOut($FÌÓŠÙµĞ[$FĞ×É×ÙÍ[76]], $EõÂ«³ÌŒÈ, $CÀŒÑŒ°Ã«, $fÏ×´‡ïğõ); goto e–È‘½±Æ†; FêğØÓšƒ: $FÌÓŠÙµĞ = $this->model->fileInfoGet($a¯äƒÏ…»ï); $fÏ×´‡ïğõ = $FÌÓŠÙµĞ[$FĞ×É×ÙÍ[170]] ? $FÌÓŠÙµĞ[$FĞ×É×ÙÍ[170]] : $fÏ×´‡ïğõ; $CÀŒÑŒ°Ã« = isset($GLOBALS[$FĞ×É×ÙÍ[1244]]) ? $GLOBALS[$FĞ×É×ÙÍ[1244]] : $Bã¥‚”‰Øê[$FĞ×É×ÙÍ[28]]; goto fîÔˆ ÷¸ ; Eó”Ã²“Í­: $FĞ×É×ÙÍ =& $_SERVER[©äõ½¡]; $Bã¥‚”‰Øê = $this->model->sourceInfo($a¯äƒÏ…»ï); if ($Bã¥‚”‰Øê[$FĞ×É×ÙÍ[405]] == $FĞ×É×ÙÍ[87]) { header($FĞ×É×ÙÍ[1243]); die; } goto FêğØÓšƒ; e–È‘½±Æ†: } public function fileOut($dÎ±¢õÉ, $FãÚÃÙºù = false, $D‚ßŠ„³Á = false, $D»¶ÕîŠ°¤ = '') { $this->_fileOut($dÎ±¢õÉ, $FãÚÃÙºù, $D‚ßŠ„³Á, $D»¶ÕîŠ°¤); } public function fileOutServer($eôÖÙµºä, $Eà±¬–ÒÆì = false, $c‡Ş¶Å = false, $Cåõá²¬“ø = '') { $this->_fileOut($eôÖÙµºä, $Eà±¬–ÒÆì, $c‡Ş¶Å, $Cåõá²¬“ø, !0); } protected function _fileOutImage($fÏºÎñ½‘µ, $F»¸Ôó = 250) { goto AÄƒº˜‚; AÆÕˆÃ¹Ş: $GLOBALS[$fº åà¶¥[1244]] = $Cµæƒ„¶…ø[$fº åà¶¥[28]]; $GLOBALS[$fº åà¶¥[162]] = $Cµæƒ„¶…ø; IO::fileOutImage($Cµæƒ„¶…ø[$fº åà¶¥[76]], $F»¸Ôó); goto dõë¦™·Şö; AÄƒº˜‚: $fº åà¶¥ =& $_SERVER[©äõ½¡]; $ešïËª¡ËÊ = $this->model->pathInfo($fÏºÎñ½‘µ); if ($ešïËª¡ËÊ[$fº åà¶¥[405]] == $fº åà¶¥[87]) { show_json($fº åà¶¥[1245] . $fÏºÎñ½‘µ, !1); } goto A–®Æó³ö‘; A–®Æó³ö‘: $Cµæƒ„¶…ø = $this->model->fileInfoGet($fÏºÎñ½‘µ); $Cµæƒ„¶…ø[$fº åà¶¥[28]] = $ešïËª¡ËÊ[$fº åà¶¥[28]]; $Cµæƒ„¶…ø[$fº åà¶¥[163]] = $ešïËª¡ËÊ[$fº åà¶¥[163]]; goto AÆÕˆÃ¹Ş; dõë¦™·Şö: } public function fileOutImage($fËŠ œßæ¢, $dä„³êç¦° = 250) { $this->_fileOutImage($fËŠ œßæ¢, $dä„³êç¦°); } public function fileOutImageServer($B¨…öÄÄª, $f“¿ìÌ‚ = 250) { $this->_fileOutImage($B¨…öÄÄª, $f“¿ìÌ‚); } public function link($FÖ½Õ“Í, $f˜øÇó¸Ò = '') { $cù£É—ß‘ = $this->model->fileInfoGet($FÖ½Õ“Í); return IO::link($cù£É—ß‘[$_SERVER[©äõ½¡][76]], $f˜øÇó¸Ò); } protected function parse($dß§¢’­•) { $dö°™×ñ¥ô =& $_SERVER[©äõ½¡]; if (strstr($dß§¢’­•, $dö°™×ñ¥ô[8]) === !1) { return array($dö°™×ñ¥ô[414] => intval($dß§¢’­•), $dö°™×ñ¥ô[76] => $dö°™×ñ¥ô[33], $dö°™×ñ¥ô[1240] => array()); } $E¦åÒĞâÜª = explode($dö°™×ñ¥ô[8], trim($dß§¢’­•, $dö°™×ñ¥ô[8])); if (count($E¦åÒĞâÜª) < 2) { show_tips($dß§¢’­• . $dö°™×ñ¥ô[1246]); } return array($dö°™×ñ¥ô[414] => intval($E¦åÒĞâÜª[0]), $dö°™×ñ¥ô[76] => $E¦åÒĞâÜª[1], $dö°™×ñ¥ô[1240] => array_slice($E¦åÒĞâÜª, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($dØ¼ ®ƒÚ³) { $this->pathParse = $dØ¼ ®ƒÚ³; $this->model = Model($_SERVER[©äõ½¡][1239]); } public function getPathOuter($bğÈÎ÷ª÷³) { $FƒİØï™¡Ì =& $_SERVER[©äõ½¡]; if (!$bğÈÎ÷ª÷³) { return $bğÈÎ÷ª÷³; } $CÉÕÄ¨×‹¥ = $this->parse($bğÈÎ÷ª÷³); return trim(KodIO::makeShare($this->pathParse[$FƒİØï™¡Ì[395]], $CÉÕÄ¨×‹¥[$FƒİØï™¡Ì[395]]), $FƒİØï™¡Ì[8]); } protected function infoParse($eÏâóÔæ‚, $F‚Œìˆ‡¡î = false, $Bš¤ãØ¹ßğ = false) { $C²™ÀÃ„³Ÿ =& $_SERVER[©äõ½¡]; $F™†ñÂÛêÄ = $this->pathParse[$C²™ÀÃ„³Ÿ[395]]; $Fˆç¦ÀÜ½† = trim($this->pathParse[$C²™ÀÃ„³Ÿ[1097]], $C²™ÀÃ„³Ÿ[8]); return Action($C²™ÀÃ„³Ÿ[1247])->sharePathInfo($F™†ñÂÛêÄ, $Fˆç¦ÀÜ½†); } public function infoFull($C¡Ûë–ìõ«) { $C©§«¯¬Íğ =& $_SERVER[©äõ½¡]; $A³Ñãª¯Š‹ = explode($C©§«¯¬Íğ[8], trim($C¡Ûë–ìõ«, $C©§«¯¬Íğ[8])); if (count($A³Ñãª¯Š‹) > 1) { $A¬ê®ˆàÛˆ = implode($C©§«¯¬Íğ[8], array_splice($A³Ñãª¯Š‹, 1)); $e°£†ùØ„ = $this->model->pathInfoByPath($A³Ñãª¯Š‹[0], $A¬ê®ˆàÛˆ); if (!$e°£†ùØ„) { return !1; } $this->pathParse[$C©§«¯¬Íğ[1097]] = $e°£†ùØ„[$C©§«¯¬Íğ[397]]; } return $this->infoParse($C¡Ûë–ìõ«); } public function listAll($CæºÜˆ²Øä) { goto Fğè¬‘ßº¤; E¢¦‡¦õä¤: $DÕœÎ¯‘¢è = $this->model->listAll($CæºÜˆ²Øä); $C¢»Ëæ³¹‰ = Model($eÚ…ëñÁÑ…[589])->getInfo($a”å™¿¹¾[$eÚ…ëñÁÑ…[482]]); $C»İóÔµ„’ = Action($eÚ…ëñÁÑ…[1247]); goto fÇÂã‚ö‹í; Fğè¬‘ßº¤: $eÚ…ëñÁÑ… =& $_SERVER[©äõ½¡]; $a”å™¿¹¾ = IO::info($this->pathParse[$eÚ…ëñÁÑ…[76]]); if (!$a”å™¿¹¾) { return array(); } goto E¢¦‡¦õä¤; fÇÂã‚ö‹í: foreach ($DÕœÎ¯‘¢è as &$CÃÊòÔ·Ñ°) { check_abort(); $CÃÊòÔ·Ñ°[$eÚ…ëñÁÑ…[85]] = $C»İóÔµ„’->_shareItemeParse($CÃÊòÔ·Ñ°[$eÚ…ëñÁÑ…[85]], $C¢»Ëæ³¹‰); } unset($CÃÊòÔ·Ñ°); return $DÕœÎ¯‘¢è; goto d»èË¬”²‡; d»èË¬”²‡: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($A»¿­¹±§µ) { $this->pathParse = $A»¿­¹±§µ; $this->model = Model($_SERVER[©äõ½¡][1239]); } protected function infoParse($BÎœÀŠ¯ß , $d‡½¯Šƒ¡ì = false, $e¶è‰ù¹é = false) { $Aª…‰İ¼ó÷ =& $_SERVER[©äõ½¡]; return Action($Aª…‰İ¼ó÷[1103])->sharePathInfo($this->pathParse[$Aª…‰İ¼ó÷[76]], !0); } public function listPath($dêõÆÛ†¸, $dÅºÃ¨ÌÏä = false) { $Fù§¾òµº =& $_SERVER[©äõ½¡]; $dì­Ö´ˆ°Û = parent::listPath($dêõÆÛ†¸, $dÅºÃ¨ÌÏä); foreach ($dì­Ö´ˆ°Û as $a´õÂÊ¿ => $B¦‡Ìóº·Ø) { if (!in_array($a´õÂÊ¿, array($Fù§¾òµº[74], $Fù§¾òµº[75]))) { continue; } foreach ($B¦‡Ìóº·Ø as $fÖŒ·ÔŞ‡ => $FÉÙ†°Ş‰‹) { $dì­Ö´ˆ°Û[$a´õÂÊ¿][$fÖŒ·ÔŞ‡] = Action($Fù§¾òµº[1103])->shareItemInfo($FÉÙ†°Ş‰‹); } } return $dì­Ö´ˆ°Û; } public function listAll($eÄÈ‰—‡Îõ) { goto E™Ûä‰²ŒŒ; E™Ûä‰²ŒŒ: $b®Ò×ÌšÕò =& $_SERVER[©äõ½¡]; $a·ôğé›Üİ = IO::info($this->pathParse[$b®Ò×ÌšÕò[76]]); if (!$a·ôğé›Üİ) { return array(); } goto eƒŒò…¾šç; eƒŒò…¾šç: $Aö¡†‘±™ò = $this->model->listAll($eÄÈ‰—‡Îõ); foreach ($Aö¡†‘±™ò as &$DÂÌŠÆÕóğ) { $DÂÌŠÆÕóğ[$b®Ò×ÌšÕò[85]] = Action($b®Ò×ÌšÕò[1103])->shareItemInfo($DÂÌŠÆÕóğ[$b®Ò×ÌšÕò[85]]); } unset($DÂÌŠÆÕóğ); goto E‡ô†Í’Ì; E‡ô†Í’Ì: return $Aö¡†‘±™ò; goto dğ³¢ôáäî; dğ³¢ôáäî: } } goto DÌ§”äõ°í; dŒ´‘ÕŠ: class SessionModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\145\155\x5f\163\x65\x73\163\x69\157\x6e"; public function get($Bô‹ö‡Üğ) { $fƒÏ·³ìğ· =& $_SERVER[©äõ½¡]; $FÂƒáò‹•Â = $this->where(array($fƒÏ·³ìğ·[1862] => $Bô‹ö‡Üğ))->find(); if (!is_array($FÂƒáò‹•Â)) { return !1; } return $FÂƒáò‹•Â[$fƒÏ·³ìğ·[750]]; } public function set($E”İù—÷…›, $a¡“Éèœ±, $f¯ÛÅ¡ó = 3600) { $Aø•Ãä¾¶ =& $_SERVER[©äõ½¡]; $cÁÍÏ‡êˆÚ = array($Aø•Ãä¾¶[1862] => $E”İù—÷…›, $Aø•Ãä¾¶[1771] => $a¡“Éèœ±, $Aø•Ãä¾¶[1863] => $f¯ÛÅ¡ó + time()); if (Session::get($Aø•Ãä¾¶[1864])) { $cÁÍÏ‡êˆÚ[$Aø•Ãä¾¶[1564]] = Session::get($Aø•Ãä¾¶[1864]); } else { $cÁÍÏ‡êˆÚ[$Aø•Ãä¾¶[1564]] = 0; } if ($this->get($E”İù—÷…›)) { return $this->where(array($Aø•Ãä¾¶[1862] => $E”İù—÷…›))->save($cÁÍÏ‡êˆÚ); } else { return $this->add($cÁÍÏ‡êˆÚ, array(), !0); } } public function remove($e®ÚùøÕÎµ) { return $this->where(array($_SERVER[©äõ½¡][1862] => $e®ÚùøÕÎµ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[©äõ½¡][1865] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\x61\162\145"; protected $dataAuto = array(array("\155\157\x64\151\x66\171\124\151\x6d\145", "\164\x69\155\145", "\x69\x6e\x73\145\162\x74\54\x75\160\144\141\164\145", "\x66\165\x6e\143\x74\x69\157\x6e"), array("\143\162\x65\141\164\145\x54\151\155\x65", "\x74\151\x6d\145", "\151\x6e\x73\145\x72\x74", "\x66\x75\x6e\x63\164\151\x6f\x6e"), array("\x6f\160\x74\151\x6f\156\163", '', "\151\x6e\163\x65\x72\164\x2c\x75\160\144\x61\164\145\x2c\x73\x65\x6c\145\x63\x74", "\152\163\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($cøÅ¼ï’œÍ) { $dŠßòæ¹”Ä =& $_SERVER[©äõ½¡]; $Eö³³åŒë = isset($cøÅ¼ï’œÍ[0]) ? $cøÅ¼ï’œÍ[0] : !1; return array($dŠßòæ¹”Ä[1866] => array(USER_ID, $dŠßòæ¹”Ä[1867]), $dŠßòæ¹”Ä[1809] => array($Eö³³åŒë, $dŠßòæ¹”Ä[1868])); } protected function listSimple() { $D ÇÚòšÕ = array($_SERVER[©äõ½¡][1564] => USER_ID); $e‰³¹‚¸µ‹ = $this->field($this->fieldList)->where($D ÇÚòšÕ)->select(); return $e‰³¹‚¸µ‹ ? $e‰³¹‚¸µ‹ : array(); } protected function getInfo($b‰‹Éàñ¶´, $cÇíè¥Èˆ = false) { $aÆö‘î«Ï¤ =& $_SERVER[©äõ½¡]; if ($cÇíè¥Èˆ) { return $this->_getShareInfo(array($aÆö‘î«Ï¤[482] => $b‰‹Éàñ¶´)); } $Eæ´‡”ß³ƒ = $this->cacheFunctionGet($aÆö‘î«Ï¤[1811], $b‰‹Éàñ¶´); return $Eæ´‡”ß³ƒ; } public function getInfoByHash($B¨Ö†°æØ›) { return $this->_getShareInfo(array($_SERVER[©äõ½¡][484] => $B¨Ö†°æØ›)); } public function getInfoByPath($dõĞÆŸóá–) { $a…­®½Úåµ =& $_SERVER[©äõ½¡]; $a›óÌ†· = array($a…­®½Úåµ[1564] => USER_ID, $a…­®½Úåµ[397] => $dõĞÆŸóá–); return $this->_getShareInfo($a›óÌ†·); } public function getInfoBySourcePath($B¥‡ø»¶±¹) { $BøÀ«™Ú›Ş =& $_SERVER[©äõ½¡]; $f¹Úƒá’¨ = array($BøÀ«™Ú›Ş[1564] => USER_ID, $BøÀ«™Ú›Ş[1104] => $B¥‡ø»¶±¹); return $this->_getShareInfo($f¹Úƒá’¨); } private function _getShareInfo($Aƒ¼ä Èéù) { goto dÚÂ«®çÊ; dÚÂ«®çÊ: $C÷ò­‹ö  =& $_SERVER[©äõ½¡]; $a–™¢Úàî¨ = $this->where($Aƒ¼ä Èéù)->find(); if (!$a–™¢Úàî¨) { return !1; } goto FêØ’­‡„; a‰ö¥æ®Ší: if ($a–™¢Úàî¨[$C÷ò­‹ö [397]] == $C÷ò­‹ö [191]) { $a–™¢Úàî¨[$C÷ò­‹ö [85]] = IO::info($a–™¢Úàî¨[$C÷ò­‹ö [1104]]); } else { $a–™¢Úàî¨[$C÷ò­‹ö [85]] = Model($C÷ò­‹ö [1239])->pathInfo($a–™¢Úàî¨[$C÷ò­‹ö [397]]); } $a–™¢Úàî¨[$C÷ò­‹ö [1870]] = $a…¨£‰‡½é; return $a–™¢Úàî¨; goto f‘í‘‹Ú¨¾; FêØ’­‡„: $Aƒ¼ä Èéù = array($C÷ò­‹ö [482] => $a–™¢Úàî¨[$C÷ò­‹ö [482]]); $eÀ²ñÉ˜Œ• = $C÷ò­‹ö [1869]; $a…¨£‰‡½é = Model($C÷ò­‹ö [590])->order($C÷ò­‹ö [395])->field($eÀ²ñÉ˜Œ•)->where($Aƒ¼ä Èéù)->select(); goto a‰ö¥æ®Ší; f‘í‘‹Ú¨¾: } protected function getInfoAuth($e‘ö®”ªíœ) { $cßµµÕ§õ =& $_SERVER[©äõ½¡]; $bµäø•Ö¾ø = $this->getInfo($e‘ö®”ªíœ); $bµäø•Ö¾ø[$cßµµÕ§õ[408]] = Model($cßµµÕ§õ[496])->authMake($bµäø•Ö¾ø[$cßµµÕ§õ[1870]]); return $bµäø•Ö¾ø; } protected function listData($dœ×‹ä¤àÓ = null, $D®‘¦áİ˜ë = 300) { $c®ŒøËÇïÂ =& $_SERVER[©äõ½¡]; $D¹ˆõç†» = array(array($c®ŒøËÇïÂ[487] => array($c®ŒøËÇïÂ[1004], 0), $c®ŒøËÇïÂ[489] => array($c®ŒøËÇïÂ[1004], 0), $c®ŒøËÇïÂ[1871] => $c®ŒøËÇïÂ[1825])); if ($dœ×‹ä¤àÓ == $c®ŒøËÇïÂ[1872]) { $D¹ˆõç†» = array($c®ŒøËÇïÂ[487] => 1); } else { if ($dœ×‹ä¤àÓ == $c®ŒøËÇïÂ[1089]) { $D¹ˆõç†» = array($c®ŒøËÇïÂ[489] => 1); } } $D¹ˆõç†»[$c®ŒøËÇïÂ[1564]] = USER_ID; $F…Õ«ìƒØ = $this->where($D¹ˆõç†»)->selectPage($D®‘¦áİ˜ë); return $F…Õ«ìƒØ; } protected function listToMe($fÉìğÔÁÕè = 300) { goto E‰ãÄ‘è¾ƒ; Cï¦ßñŸß¿: if ($CšÉµÏë±é) { $AÖ¶ÔÙïˆì = array(array($C«°’îÈæ[574] => SourceModel::TYPE_USER, $C«°’îÈæ[498] => USER_ID), array($C«°’îÈæ[574] => SourceModel::TYPE_GROUP, $C«°’îÈæ[498] => array($C«°’îÈæ[7], $CšÉµÏë±é)), $C«°’îÈæ[1871] => $C«°’îÈæ[1825]); } $d‡„©„·‚ = Model($C«°’îÈæ[590])->where($AÖ¶ÔÙïˆì)->selectPage($fÉìğÔÁÕè); $Dîø‚Ïç„ = array_to_keyvalue_group($d‡„©„·‚[$C«°’îÈæ[367]], $C«°’îÈæ[482]); goto bí™İè…Â; dÒ¹ÂŠ¶Ü: $CèÖ é× = $this->field($A¹‡ÌÎÁÈĞ)->where($AÖ¶ÔÙïˆì)->select(); foreach ($CèÖ é× as $C…Ñ±¡ƒ…Î => &$AÌÓÒŠÉØ) { $AÌÓÒŠÉØ[$C«°’îÈæ[1870]] = $Dîø‚Ïç„[$AÌÓÒŠÉØ[$C«°’îÈæ[482]]]; } unset($AÌÓÒŠÉØ); goto a”ºÆ·“ğ; a”ºÆ·“ğ: $e½¬šÛ¬Ø“ = array($C«°’îÈæ[1875] => $CèÖ é×, $C«°’îÈæ[1876] => $d‡„©„·‚[$C«°’îÈæ[364]]); return $e½¬šÛ¬Ø“; goto CÁÍê»ÎÏ˜; bí™İè…Â: if (!$Dîø‚Ïç„) { return $d‡„©„·‚; } $A¹‡ÌÎÁÈĞ = $C«°’îÈæ[1874]; $AÖ¶ÔÙïˆì = array($C«°’îÈæ[482] => array($C«°’îÈæ[413], array_keys($Dîø‚Ïç„)), $C«°’îÈæ[1564] => array($C«°’îÈæ[1006], $C«°’îÈæ[191])); goto dÒ¹ÂŠ¶Ü; E‰ãÄ‘è¾ƒ: $C«°’îÈæ =& $_SERVER[©äõ½¡]; $CšÉµÏë±é = Model($C«°’îÈæ[1873])->userGroupParents(USER_ID); $AÖ¶ÔÙïˆì = array($C«°’îÈæ[574] => SourceModel::TYPE_USER, $C«°’îÈæ[498] => USER_ID); goto Cï¦ßñŸß¿; CÁÍê»ÎÏ˜: } protected function shareAdd($DîßÏã‰“, $CóÑÅø¡ßå) { $D‹‰¡§ë•Ä =& $_SERVER[©äõ½¡]; $B‹±Úå¥ = $this->_addShareData($DîßÏã‰“, $CóÑÅø¡ßå); if (!empty($CóÑÅø¡ßå[$D‹‰¡§ë•Ä[1877]])) { $this->_shareAuthSet($B‹±Úå¥, $CóÑÅø¡ßå[$D‹‰¡§ë•Ä[1877]]); } $this->shareEventAdd($DîßÏã‰“, $CóÑÅø¡ßå, $D‹‰¡§ë•Ä[1092]); return $B‹±Úå¥; } protected function shareAddSystem($cÔ¾­¿”²Æ, $aÄ²ø˜Ì·¶) { $fÈËÉÛ¦²ƒ =& $_SERVER[©äõ½¡]; $d©Ö¼÷®ğØ = $this->_addShareData($cÔ¾­¿”²Æ, $aÄ²ø˜Ì·¶, $fÈËÉÛ¦²ƒ[1204]); $this->_shareAuthSet($d©Ö¼÷®ğØ, $aÄ²ø˜Ì·¶[$fÈËÉÛ¦²ƒ[1877]]); return $d©Ö¼÷®ğØ; } private function shareEventAdd($B¼–µ•‚ô±, $Cæ•Â´ñâ¨, $AùØÍ‘ïò = "\141\144\x64") { goto FÇ¦°ì˜Ö¦; eˆ‹Æ¤¨‘†: $a–‰Æí† = $this->getInfoByPath($B¼–µ•‚ô±); $bÜìÉñ¶Ë† = $aØèÁŒš²Š[1880]; if ($a–‰Æí†[$aØèÁŒš²Š[487]] == $aØèÁŒš²Š[191] && $Cæ•Â´ñâ¨[$aØèÁŒš²Š[487]] == $aØèÁŒš²Š[87]) { $bÜìÉñ¶Ë† = $aØèÁŒš²Š[1878]; } goto CÀƒùŠ¾Øó; CÊ§Â‚œÄ: Model($aØèÁŒš²Š[558])->eventShare($B¼–µ•‚ô±, $bÜìÉñ¶Ë†); return; goto B¹¢„“Ùù¾; FÇ¦°ì˜Ö¦: $aØèÁŒš²Š =& $_SERVER[©äõ½¡]; if (!$B¼–µ•‚ô± || $B¼–µ•‚ô± == $aØèÁŒš²Š[191]) { return; } if ($AùØÍ‘ïò == $aØèÁŒš²Š[1092]) { if ($Cæ•Â´ñâ¨[$aØèÁŒš²Š[487]] == $aØèÁŒš²Š[87]) { Model($aØèÁŒš²Š[558])->eventShare($B¼–µ•‚ô±, $aØèÁŒš²Š[1878]); } if ($Cæ•Â´ñâ¨[$aØèÁŒš²Š[489]] == $aØèÁŒš²Š[87]) { Model($aØèÁŒš²Š[558])->eventShare($B¼–µ•‚ô±, $aØèÁŒš²Š[1879]); } return; } goto eˆ‹Æ¤¨‘†; CÀƒùŠ¾Øó: if ($a–‰Æí†[$aØèÁŒš²Š[487]] == $aØèÁŒš²Š[87] && $Cæ•Â´ñâ¨[$aØèÁŒš²Š[487]] == $aØèÁŒš²Š[191]) { $bÜìÉñ¶Ë† = $aØèÁŒš²Š[1881]; } if ($a–‰Æí†[$aØèÁŒš²Š[489]] == $aØèÁŒš²Š[191] && $Cæ•Â´ñâ¨[$aØèÁŒš²Š[489]] == $aØèÁŒš²Š[87]) { $bÜìÉñ¶Ë† = $aØèÁŒš²Š[1879]; } if ($a–‰Æí†[$aØèÁŒš²Š[489]] == $aØèÁŒš²Š[87] && $Cæ•Â´ñâ¨[$aØèÁŒš²Š[489]] == $aØèÁŒš²Š[191]) { $bÜìÉñ¶Ë† = $aØèÁŒš²Š[1882]; } goto CÊ§Â‚œÄ; B¹¢„“Ùù¾: } private function _addShareData($cİ’è÷¸ºù, $A©°ÒÛÂ‰ª = array(), $eÃŸ»±¿‡Ã = false) { goto Cã÷Ì¥‹¤ë; Cã÷Ì¥‹¤ë: $DÔ½İö Ñ =& $_SERVER[©äõ½¡]; $e÷Ø¼É™® = $eÃŸ»±¿‡Ã == $DÔ½İö Ñ[1204] ? 0 : USER_ID; $A”ßâƒ’²æ = array($DÔ½İö Ñ[412] => $cİ’è÷¸ºù, $DÔ½İö Ñ[1555] => $e÷Ø¼É™®); goto Fß‰ğÍ¯Ê§; Fß‰ğÍ¯Ê§: if ($cİ’è÷¸ºù == 0) { $A”ßâƒ’²æ = array($DÔ½İö Ñ[1883] => $A©°ÒÛÂ‰ª[$DÔ½İö Ñ[1104]], $DÔ½İö Ñ[1555] => $e÷Ø¼É™®); } if ($A »˜ÃÉµŠ = $this->where($A”ßâƒ’²æ)->find()) { return $A »˜ÃÉµŠ[$DÔ½İö Ñ[482]]; } if ($cİ’è÷¸ºù == 0) { $EÊÛï£ç» = array($DÔ½İö Ñ[28] => get_path_this($A©°ÒÛÂ‰ª[$DÔ½İö Ñ[76]])); } else { $EÊÛï£ç» = Model($DÔ½İö Ñ[827])->sourceInfo($cİ’è÷¸ºù); if (!$EÊÛï£ç») { return !1; } } goto A’ÆÜ‘‚Ñ; Bè‰¿òğß: foreach ($D”¨ÖŠÈ† as $A­ÁÔÉ¡í‚) { if (!isset($A©°ÒÛÂ‰ª[$A­ÁÔÉ¡í‚])) { continue; } $A¦¡ˆ‘™©[$A­ÁÔÉ¡í‚] = $A©°ÒÛÂ‰ª[$A­ÁÔÉ¡í‚]; } $A´Õ¦Î¯Äó = $this->add($A¦¡ˆ‘™©); $A¶ÀñŠŠ„Ø = array($DÔ½İö Ñ[484] => short_id($A´Õ¦Î¯Äó)); goto e§Ÿèùï°; e§Ÿèùï°: $this->where(array($DÔ½İö Ñ[481] => $A´Õ¦Î¯Äó))->save($A¶ÀñŠŠ„Ø); return $A´Õ¦Î¯Äó; goto FÜÙ…Ğ‡Çê; A’ÆÜ‘‚Ñ: if (!$A©°ÒÛÂ‰ª[$DÔ½İö Ñ[1465]]) { $A©°ÒÛÂ‰ª[$DÔ½İö Ñ[1465]] = $EÊÛï£ç»[$DÔ½İö Ñ[28]]; } $A¦¡ˆ‘™© = array($DÔ½İö Ñ[1555] => $e÷Ø¼É™®, $DÔ½İö Ñ[412] => $cİ’è÷¸ºù, $DÔ½İö Ñ[1465] => $DÔ½İö Ñ[33], $DÔ½İö Ñ[487] => 0, $DÔ½İö Ñ[489] => 0, $DÔ½İö Ñ[1104] => $DÔ½İö Ñ[33], $DÔ½İö Ñ[305] => $DÔ½İö Ñ[33], $DÔ½İö Ñ[884] => $DÔ½İö Ñ[33], $DÔ½İö Ñ[1884] => 0, $DÔ½İö Ñ[1885] => 0, $DÔ½İö Ñ[490] => 0, $DÔ½İö Ñ[491] => $DÔ½İö Ñ[33], $DÔ½İö Ñ[484] => $DÔ½İö Ñ[33]); $D”¨ÖŠÈ† = explode($DÔ½İö Ñ[47], $DÔ½İö Ñ[1886]); goto Bè‰¿òğß; FÜÙ…Ğ‡Çê: } private function _shareAuthSet($a³„Š½õ¦Ì, $B‚½ß‘ä‘) { goto C©ÍÉĞÕÕ÷; dØëÄƒï“¾: $E†Œƒ²ÏË‰->where(array($cùù—¯Ôá[482] => $a³„Š½õ¦Ì))->delete(); $dŸ™¸ê’õ¬ = array(); foreach ($B‚½ß‘ä‘ as $b©ô÷æ„Ö) { $Côñ¸’Â‹ = SourceModel::TYPE_USER; if ($b©ô÷æ„Ö[$cùù—¯Ôá[406]] == SourceModel::TYPE_GROUP) { $Côñ¸’Â‹ = SourceModel::TYPE_GROUP; } $EÕÉòèÂÁÇ = array($cùù—¯Ôá[482] => $a³„Š½õ¦Ì, $cùù—¯Ôá[406] => $Côñ¸’Â‹, $cùù—¯Ôá[498] => intval($b©ô÷æ„Ö[$cùù—¯Ôá[498]]), $cùù—¯Ôá[1833] => 0, $cùù—¯Ôá[1887] => -1); if ($b©ô÷æ„Ö[$cùù—¯Ôá[1833]]) { $EÕÉòèÂÁÇ[$cùù—¯Ôá[1833]] = $b©ô÷æ„Ö[$cùù—¯Ôá[1833]]; } else { if ($b©ô÷æ„Ö[$cùù—¯Ôá[1887]]) { $EÕÉòèÂÁÇ[$cùù—¯Ôá[1887]] = $b©ô÷æ„Ö[$cùù—¯Ôá[1887]]; } } $dŸ™¸ê’õ¬[] = $EÕÉòèÂÁÇ; } goto c‡Ì÷ÖÖ¤ƒ; c‡Ì÷ÖÖ¤ƒ: return $E†Œƒ²ÏË‰->addAll($dŸ™¸ê’õ¬, array(), !0); goto d§Æà›ÈŠ; C©ÍÉĞÕÕ÷: $cùù—¯Ôá =& $_SERVER[©äõ½¡]; if (!is_array($B‚½ß‘ä‘)) { return !1; } $E†Œƒ²ÏË‰ = Model($cùù—¯Ôá[1837]); goto dØëÄƒï“¾; d§Æà›ÈŠ: } public function numViewAdd($EÇÑ‹…­½‡) { $FäÅóå‹Ë  =& $_SERVER[©äõ½¡]; $Cõ‚ƒ›õ¸ = array($FäÅóå‹Ë [481] => $EÇÑ‹…­½‡); $this->where($Cõ‚ƒ›õ¸)->setAdd($FäÅóå‹Ë [1884]); } public function numDownloadAdd($B¼ØÍçÁ‹») { $D«¥¾½®Éá =& $_SERVER[©äõ½¡]; $b………„äØ‡ = array($D«¥¾½®Éá[481] => $B¼ØÍçÁ‹»); $this->where($b………„äØ‡)->setAdd($D«¥¾½®Éá[1885]); } protected function shareEdit($bëËÍô’ö„, $EÛáõÑİ”) { goto BôèĞ¶•èò; BôèĞ¶•èò: $FÙåªğÑœ =& $_SERVER[©äõ½¡]; $B·çƒöÄÙİ = $this->getInfo($bëËÍô’ö„); if (!$B·çƒöÄÙİ) { return !1; } goto C»¹–‰îÃ²; e‡‰ã×À³: if (isset($EÛáõÑİ”[$FÙåªğÑœ[1877]])) { $this->_shareAuthSet($bëËÍô’ö„, $EÛáõÑİ”[$FÙåªğÑœ[1877]]); } return !0; goto d²‘öæÓïá; CŒ„•ğ¿ÃØ: foreach ($C¿æõÆ½Î as $FÛÕà††—·) { if (!array_key_exists($FÛÕà††—·, $EÛáõÑİ”)) { continue; } $Dø­Š÷ß’÷[$FÛÕà††—·] = $EÛáõÑİ”[$FÛÕà††—·]; } $this->shareEventAdd($B·çƒöÄÙİ[$FÙåªğÑœ[397]], $EÛáõÑİ”, $FÙåªğÑœ[1700]); $this->where(array($FÙåªğÑœ[481] => $bëËÍô’ö„))->save($Dø­Š÷ß’÷); goto e‡‰ã×À³; C»¹–‰îÃ²: $this->_checkLinkShare($EÛáõÑİ”, $B·çƒöÄÙİ); $Dø­Š÷ß’÷ = array(); $C¿æõÆ½Î = explode($FÙåªğÑœ[47], $FÙåªğÑœ[1888]); goto CŒ„•ğ¿ÃØ; d²‘öæÓïá: } private function _checkLinkShare($cÆƒ×ïØ¸, $b—¼à¶«©ƒ) { goto FÄ©ÀÄÈÇ©; E­åëŠ¹¸: $eå Æô¬¡ª = $this->shareFileMeta($c¬Íâ–áˆ[$dš”Åµ‚[461]]); if (isset($eå Æô¬¡ª[$dš”Åµ‚[372]]) && $eå Æô¬¡ª[$dš”Åµ‚[372]] == $dš”Åµ‚[87]) { show_json(LNG($dš”Åµ‚[1891]), !1); } goto a‹š‰Õ¤”Ñ; A‚—°„ÑŒ£: if ($b—¼à¶«©ƒ[$dš”Åµ‚[85]][$dš”Åµ‚[29]] != $dš”Åµ‚[193]) { $dÌŠ½¡•·à = $this->_folderReport($aÖâÆàìØ); if (!$dÌŠ½¡•·à) { return; } show_json(LNG($dš”Åµ‚[1889]) . $dš”Åµ‚[1890] . $dÌŠ½¡•·à, !1); } $c¬Íâ–áˆ = Model($dš”Åµ‚[827])->fileInfoGet($b—¼à¶«©ƒ[$dš”Åµ‚[85]][$dš”Åµ‚[397]]); if (!$c¬Íâ–áˆ) { return; } goto E­åëŠ¹¸; FÄ©ÀÄÈÇ©: $dš”Åµ‚ =& $_SERVER[©äõ½¡]; if ($cÆƒ×ïØ¸[$dš”Åµ‚[487]] != $dš”Åµ‚[87]) { return; } $aÖâÆàìØ = $b—¼à¶«©ƒ[$dš”Åµ‚[85]][$dš”Åµ‚[397]]; goto A‚—°„ÑŒ£; a‹š‰Õ¤”Ñ: } private function _folderReport($DÉßˆßÂ÷) { goto C…ŒöìÍ…Š; C…ŒöìÍ…Š: $fö›ò«‡Ë® =& $_SERVER[©äõ½¡]; $C‘™„Âµï© = array($fö›ò«‡Ë®[461] => array($fö›ò«‡Ë®[1004], 0), $fö›ò«‡Ë®[745] => 3); $D£‡ä½©Ã‰ = Model($fö›ò«‡Ë®[1892])->where($C‘™„Âµï©)->field($fö›ò«‡Ë®[461])->select(); goto Dôä–†öŠ†; c…˜ø°Ğƒ®: $AÇŒñ­£©Ë = substr($Aª›«éœÒ·[$fö›ò«‡Ë®[515]], strpos($Aª›«éœÒ·[$fö›ò«‡Ë®[515]], $fê›·‰Ô‘»)); $C‘™„Âµï© = array($fö›ò«‡Ë®[397] => array($fö›ò«‡Ë®[7], trim($AÇŒñ­£©Ë, $fö›ò«‡Ë®[47]))); $BÑ—²Ò¢• = Model($fö›ò«‡Ë®[827])->where($C‘™„Âµï©)->field($fö›ò«‡Ë®[28])->select(); goto cÚ°˜öà©†; Dôä–†öŠ†: if (!$D£‡ä½©Ã‰) { return !1; } $D£‡ä½©Ã‰ = array_to_keyvalue($D£‡ä½©Ã‰, $fö›ò«‡Ë®[33], $fö›ò«‡Ë®[461]); $fê›·‰Ô‘» = $fö›ò«‡Ë®[47] . $DÉßˆßÂ÷ . $fö›ò«‡Ë®[47]; goto CÜˆ§¦£©; cÚ°˜öà©†: $FÆ¤½­µÜ = array_to_keyvalue($BÑ—²Ò¢•, $fö›ò«‡Ë®[33], $fö›ò«‡Ë®[28]); $FÆ¤½­µÜ[] = $Aª›«éœÒ·[$fö›ò«‡Ë®[28]]; return implode($fö›ò«‡Ë®[8], $FÆ¤½­µÜ); goto b­æ¦•…˜Æ; CÜˆ§¦£©: $C‘™„Âµï© = array($fö›ò«‡Ë®[461] => array($fö›ò«‡Ë®[7], $D£‡ä½©Ã‰), $fö›ò«‡Ë®[515] => array($fö›ò«‡Ë®[381], "\45{$fê›·‰Ô‘»}\45"), $fö›ò«‡Ë®[425] => 0); $Aª›«éœÒ· = Model($fö›ò«‡Ë®[827])->where($C‘™„Âµï©)->field($fö›ò«‡Ë®[1893])->find(); if (!$Aª›«éœÒ·) { return !1; } goto c…˜ø°Ğƒ®; b­æ¦•…˜Æ: } protected function remove($E‰¼×•Îå‰) { goto CÙ¡®˜Øöö; f‰¼è¶Ï”ø: $C¢²Îøğƒº = $this->where($cî××‚ä¤…)->delete(); if ($C¢²Îøğƒº) { Model($dÉ·˜Îäå¯[590])->where(array($dÉ·˜Îäå¯[482] => $E‰¼×•Îå‰))->delete(); } $ağ®‘°†ÖË = is_array($E‰¼×•Îå‰) ? $E‰¼×•Îå‰[1] : array($E‰¼×•Îå‰); goto fÊã«Ò‹Œ×; fÊã«Ò‹Œ×: for ($B¾ÕŒ£šñØ = 0; $B¾ÕŒ£šñØ < count($ağ®‘°†ÖË); $B¾ÕŒ£šñØ++) { $bšß‹¶¤å¾ = $this->getInfo($ağ®‘°†ÖË[$B¾ÕŒ£šñØ]); if ($bšß‹¶¤å¾[$dÉ·˜Îäå¯[489]] == $dÉ·˜Îäå¯[87]) { Model($dÉ·˜Îäå¯[558])->eventShare($bšß‹¶¤å¾[$dÉ·˜Îäå¯[397]], $dÉ·˜Îäå¯[1882]); } if ($bšß‹¶¤å¾[$dÉ·˜Îäå¯[487]] == $dÉ·˜Îäå¯[87]) { Model($dÉ·˜Îäå¯[558])->eventShare($bšß‹¶¤å¾[$dÉ·˜Îäå¯[397]], $dÉ·˜Îäå¯[1881]); } } return $C¢²Îøğƒº; goto e§ƒäò©¸‘; CÙ¡®˜Øöö: $dÉ·˜Îäå¯ =& $_SERVER[©äõ½¡]; if (is_array($E‰¼×•Îå‰)) { $E‰¼×•Îå‰ = array($dÉ·˜Îäå¯[7], $E‰¼×•Îå‰); } $cî××‚ä¤… = array($dÉ·˜Îäå¯[482] => $E‰¼×•Îå‰); goto f‰¼è¶Ï”ø; e§ƒäò©¸‘: } protected function removeBySource($E¿šã‡èÂÚ) { goto f÷Î¤•è; bÕ¼‚¼Ğ¶¶: $this->where($bÅÑÁ…‡Œ®)->delete(); Model($c‡É…«ÔŞ[590])->where($bÅÑÁ…‡Œ®)->delete(); goto c“êº•Ù; f÷Î¤•è: $c‡É…«ÔŞ =& $_SERVER[©äõ½¡]; $bÅÑÁ…‡Œ® = array($c‡É…«ÔŞ[412] => array($c‡É…«ÔŞ[413], $E¿šã‡èÂÚ)); $DŒå©‚Šáœ = $this->field($c‡É…«ÔŞ[482])->where($bÅÑÁ…‡Œ®)->select(); goto B™›‹‘îÕÓ; B™›‹‘îÕÓ: $DŒå©‚Šáœ = array_to_keyvalue($DŒå©‚Šáœ, $c‡É…«ÔŞ[33], $c‡É…«ÔŞ[482]); if (!$DŒå©‚Šáœ) { return; } $bÅÑÁ…‡Œ® = array($c‡É…«ÔŞ[481] => array($c‡É…«ÔŞ[413], $DŒå©‚Šáœ)); goto bÕ¼‚¼Ğ¶¶; c“êº•Ù: } public function listAll($Eù”ĞÃÔ²) { goto C†„³â¸; cÚºçØ‘Æ©: if ($Eù”ĞÃÔ²[$F¡óƒµÒë–[756]]) { $b‰´ƒé»º· = $Eù”ĞÃÔ²[$F¡óƒµÒë–[490]] ? $Eù”ĞÃÔ²[$F¡óƒµÒë–[490]] : strtotime(date($F¡óƒµÒë–[1894])); $b§ãÛÎ‰Òñ[$F¡óƒµÒë–[194]] = array($F¡óƒµÒë–[331], array($Eù”ĞÃÔ²[$F¡óƒµÒë–[756]], $b‰´ƒé»º·)); } if ($Eù”ĞÃÔ²[$F¡óƒµÒë–[29]]) { $b§ãÛÎ‰Òñ[$Eù”ĞÃÔ²[$F¡óƒµÒë–[29]]] = 1; } else { $b§ãÛÎ‰Òñ[] = array($F¡óƒµÒë–[487] => array($F¡óƒµÒë–[1004], 0), $F¡óƒµÒë–[489] => array($F¡óƒµÒë–[1004], 0), $F¡óƒµÒë–[1871] => $F¡óƒµÒë–[1825]); } if ($Eù”ĞÃÔ²[$F¡óƒµÒë–[1821]]) { $b§ãÛÎ‰Òñ[] = array($F¡óƒµÒë–[484] => $Eù”ĞÃÔ²[$F¡óƒµÒë–[1821]], $F¡óƒµÒë–[1465] => array($F¡óƒµÒë–[381], "\x25{$Eù”ĞÃÔ²[$F¡óƒµÒë–[1821]]}\45"), $F¡óƒµÒë–[1871] => $F¡óƒµÒë–[1825]); } goto B´Ï¹ù¹éÚ; B´Ï¹ù¹éÚ: $E¿ñ°Åù®â = $this->_makeOrder()->where($b§ãÛÎ‰Òñ)->selectPage(20); if (empty($E¿ñ°Åù®â[$F¡óƒµÒë–[367]])) { return array(); } $this->_listDataApply($E¿ñ°Åù®â[$F¡óƒµÒë–[367]]); goto E‚‡©ßß–; C†„³â¸: $F¡óƒµÒë– =& $_SERVER[©äõ½¡]; $b§ãÛÎ‰Òñ = array(); if ($Eù”ĞÃÔ²[$F¡óƒµÒë–[1564]]) { $b§ãÛÎ‰Òñ[$F¡óƒµÒë–[1564]] = $Eù”ĞÃÔ²[$F¡óƒµÒë–[1564]]; } goto cÚºçØ‘Æ©; E‚‡©ßß–: return $E¿ñ°Åù®â; goto bÂõ§ƒã‘¸; bÂõ§ƒã‘¸: } public function listDataApply($f¡äÕŠŒŒ–) { $this->_listDataApply($f¡äÕŠŒŒ–); return $f¡äÕŠŒŒ–; } private function _listDataApply(&$fø­£·ø°Ó) { goto AÛÉ™İë; AÛÉ™İë: $C›á§‘‘Áö =& $_SERVER[©äõ½¡]; $FìšÎÜ††İ = array_to_keyvalue($fø­£·ø°Ó, $C›á§‘‘Áö[33], $C›á§‘‘Áö[1564]); $Eœ£íÙ¡À = Model($C›á§‘‘Áö[532])->userListInfo(array_unique($FìšÎÜ††İ)); goto A–ŸÊ ä¦; F‰İ­¾Ğ„: unset($B±—¦¬¦‚“); $fø­£·ø°Ó = array_values($fø­£·ø°Ó); goto aÔ‚×ŸìÉœ; A–ŸÊ ä¦: $c¹¨öµ¬İÉ = array_to_keyvalue($fø­£·ø°Ó, $C›á§‘‘Áö[33], $C›á§‘‘Áö[397]); $E”Üù‹î“¬ = Model($C›á§‘‘Áö[827])->sourceListInfo($c¹¨öµ¬İÉ, !0); foreach ($fø­£·ø°Ó as $b“§…È¦ò¯ => &$B±—¦¬¦‚“) { $c…‰‰‰““ê = $B±—¦¬¦‚“[$C›á§‘‘Áö[1564]]; $B±—¦¬¦‚“[$C›á§‘‘Áö[1895]] = $Eœ£íÙ¡À[$c…‰‰‰““ê] ? $Eœ£íÙ¡À[$c…‰‰‰““ê] : !1; $f˜ğñ¼ìÜÂ = $B±—¦¬¦‚“[$C›á§‘‘Áö[397]]; $B±—¦¬¦‚“[$C›á§‘‘Áö[85]] = $E”Üù‹î“¬[$f˜ğñ¼ìÜÂ] ? $E”Üù‹î“¬[$f˜ğñ¼ìÜÂ] : !1; if ($B±—¦¬¦‚“[$C›á§‘‘Áö[85]][$C›á§‘‘Áö[425]] == $C›á§‘‘Áö[87]) { unset($fø­£·ø°Ó[$b“§…È¦ò¯]); } if ($B±—¦¬¦‚“[$C›á§‘‘Áö[85]] != $C›á§‘‘Áö[191] && !$B±—¦¬¦‚“[$C›á§‘‘Áö[85]]) { unset($fø­£·ø°Ó[$b“§…È¦ò¯]); } } goto F‰İ­¾Ğ„; aÔ‚×ŸìÉœ: } private function _makeOrder($BÄ¤·°Ë›Ğ = '') { goto C”ÈáòÇ©Ö; C”ÈáòÇ©Ö: $f°ùëÀ¥¤‘ =& $_SERVER[©äõ½¡]; $EÓøïİ¢Ï = array($f°ùëÀ¥¤‘[194], $f°ùëÀ¥¤‘[490], $f°ùëÀ¥¤‘[1884], $f°ùëÀ¥¤‘[1885]); $b„àÖŠÒİ© = array($f°ùëÀ¥¤‘[442] => $f°ùëÀ¥¤‘[443], $f°ùëÀ¥¤‘[444] => $f°ùëÀ¥¤‘[445]); goto dğ¬ô“´˜·; dğ¬ô“´˜·: $EÑñë“òÒ  = Input::get($f°ùëÀ¥¤‘[449], $f°ùëÀ¥¤‘[7], $f°ùëÀ¥¤‘[418], $EÓøïİ¢Ï); $AÖ©øğ§òò = Input::get($f°ùëÀ¥¤‘[450], $f°ùëÀ¥¤‘[7], $f°ùëÀ¥¤‘[1896], array($f°ùëÀ¥¤‘[1820], $f°ùëÀ¥¤‘[444])); $AÖ©øğ§òò = $b„àÖŠÒİ©[$AÖ©øğ§òò]; goto BÔ¿ÊåÛó; BÔ¿ÊåÛó: $BÄ¤·°Ë›Ğ = $BÄ¤·°Ë›Ğ . "{$EÑñë“òÒ }\40{$AÖ©øğ§òò}"; return $this->order($BÄ¤·°Ë›Ğ); goto AŒô™ŒóÎ; AŒô™ŒóÎ: } public function reportAdd($d±·„‰šà) { $E®Ç¿’ƒ¼ =& $_SERVER[©äõ½¡]; $D¦ë¦Í•è¯ = array($E®Ç¿’ƒ¼[482] => $d±·„‰šà[$E®Ç¿’ƒ¼[482]], $E®Ç¿’ƒ¼[1564] => USER_ID); if (Model($E®Ç¿’ƒ¼[1892])->where($D¦ë¦Í•è¯)->find()) { return !1; } $E‡ŸİÀçö = array($E®Ç¿’ƒ¼[482] => $d±·„‰šà[$E®Ç¿’ƒ¼[482]], $E®Ç¿’ƒ¼[1465] => $d±·„‰šà[$E®Ç¿’ƒ¼[1465]], $E®Ç¿’ƒ¼[397] => $d±·„‰šà[$E®Ç¿’ƒ¼[397]], $E®Ç¿’ƒ¼[461] => $d±·„‰šà[$E®Ç¿’ƒ¼[461]], $E®Ç¿’ƒ¼[1564] => USER_ID, $E®Ç¿’ƒ¼[29] => $d±·„‰šà[$E®Ç¿’ƒ¼[29]], $E®Ç¿’ƒ¼[445] => $d±·„‰šà[$E®Ç¿’ƒ¼[445]]); return Model($E®Ç¿’ƒ¼[1892])->add($E‡ŸİÀçö); } public function reportList($Fç‘ŞøÕÌß) { goto aÁ®ã™»Í; aÁ®ã™»Í: $aàÔßñø™Ş =& $_SERVER[©äõ½¡]; $a‡ÀŠº®ğ£ = array(); if ($Fç‘ŞøÕÌß[$aàÔßñø™Ş[756]]) { $Dñ×î‹‰Ú = $Fç‘ŞøÕÌß[$aàÔßñø™Ş[490]] ? $Fç‘ŞøÕÌß[$aàÔßñø™Ş[490]] : strtotime(date($aàÔßñø™Ş[1894])); $a‡ÀŠº®ğ£[$aàÔßñø™Ş[194]] = array($aàÔßñø™Ş[331], array($Fç‘ŞøÕÌß[$aàÔßñø™Ş[756]], $Dñ×î‹‰Ú)); } goto D«²¿Å‰ùõ; aò‘ŞñÂ: $c¼³…›’Ñ¦ = array($aàÔßñø™Ş[442] => $aàÔßñø™Ş[443], $aàÔßñø™Ş[444] => $aàÔßñø™Ş[445]); $d—²¬¡ïŒ = $aàÔßñø™Ş[1900] . $c¼³…›’Ñ¦[$a¿»‰ ¶‰«]; $BæÁ„ÀĞµÏ = Model($aàÔßñø™Ş[1892])->where($a‡ÀŠº®ğ£)->order($d—²¬¡ïŒ)->selectPage(20); goto F²ë©ØÙœÇ; F²ë©ØÙœÇ: if (empty($BæÁ„ÀĞµÏ[$aàÔßñø™Ş[367]])) { return array(); } $bçË£½çÂ¤ = array_to_keyvalue_group($BæÁ„ÀĞµÏ[$aàÔßñø™Ş[367]], $aàÔßñø™Ş[745], $aàÔßñø™Ş[482]); if (!empty($bçË£½çÂ¤[0])) { $Fç‘ŞøÕÌß = $bçË£½çÂ¤[0]; $a‡ÀŠº®ğ£ = array($aàÔßñø™Ş[482] => array($aàÔßñø™Ş[7], $Fç‘ŞøÕÌß)); $DÅèä™‡Á = $this->where($a‡ÀŠº®ğ£)->field($aàÔßñø™Ş[482])->select(); $DÅèä™‡Á = array_to_keyvalue($DÅèä™‡Á, $aàÔßñø™Ş[33], $aàÔßñø™Ş[482]); $B­±Ü«µŸİ = array_diff($Fç‘ŞøÕÌß, $DÅèä™‡Á); if (!empty($B­±Ü«µŸİ)) { foreach ($BæÁ„ÀĞµÏ[$aàÔßñø™Ş[367]] as $EêªÁˆ“¢ => $CŞä…Êâµê) { if (in_array($CŞä…Êâµê[$aàÔßñø™Ş[482]], $B­±Ü«µŸİ)) { unset($BæÁ„ÀĞµÏ[$aàÔßñø™Ş[367]][$EêªÁˆ“¢]); } } } } goto dè†Ï’¯¢±; dè†Ï’¯¢±: $this->_listDataApply($BæÁ„ÀĞµÏ[$aàÔßñø™Ş[367]]); return $BæÁ„ÀĞµÏ; goto Dç³ğÏùƒ¾; D«²¿Å‰ùõ: if (isset($Fç‘ŞøÕÌß[$aàÔßñø™Ş[29]]) && in_array($Fç‘ŞøÕÌß[$aàÔßñø™Ş[29]], array($aàÔßñø™Ş[87], $aàÔßñø™Ş[429], $aàÔßñø™Ş[1897], $aàÔßñø™Ş[1898], $aàÔßñø™Ş[1899]))) { $a‡ÀŠº®ğ£[$aàÔßñø™Ş[29]] = $Fç‘ŞøÕÌß[$aàÔßñø™Ş[29]]; } if (isset($Fç‘ŞøÕÌß[$aàÔßñø™Ş[745]]) && in_array($Fç‘ŞøÕÌß[$aàÔßñø™Ş[745]], array($aàÔßñø™Ş[191], $aàÔßñø™Ş[87], $aàÔßñø™Ş[429], $aàÔßñø™Ş[1897]))) { $a‡ÀŠº®ğ£[$aàÔßñø™Ş[745]] = $Fç‘ŞøÕÌß[$aàÔßñø™Ş[745]]; } $a¿»‰ ¶‰« = Input::get($aàÔßñø™Ş[450], $aàÔßñø™Ş[7], $aàÔßñø™Ş[1896], array($aàÔßñø™Ş[1820], $aàÔßñø™Ş[444])); goto aò‘ŞñÂ; Dç³ğÏùƒ¾: } public function reportStatus($EšáŒƒİ×) { goto CÅÇäÖÚˆ­; CÅÇäÖÚˆ­: $C¼˜Ãî ¬¾ =& $_SERVER[©äõ½¡]; $EÍùïÉåÔ = array($C¼˜Ãî ¬¾[395] => $EšáŒƒİ×[$C¼˜Ãî ¬¾[395]]); $câ«º¾¾†Œ = Model($C¼˜Ãî ¬¾[1892])->where($EÍùïÉåÔ)->field($C¼˜Ãî ¬¾[1901])->find(); goto dá¡¬®¶Š¡; dá¡¬®¶Š¡: if (!$câ«º¾¾†Œ) { return !1; } $DêÀºÆ÷†ß = array($C¼˜Ãî ¬¾[745] => $EšáŒƒİ×[$C¼˜Ãî ¬¾[745]]); if ($EšáŒƒİ×[$C¼˜Ãî ¬¾[745]] == $C¼˜Ãî ¬¾[1897] && $câ«º¾¾†Œ[$C¼˜Ãî ¬¾[745]] == $C¼˜Ãî ¬¾[1897]) { $DêÀºÆ÷†ß[$C¼˜Ãî ¬¾[745]] = 0; } goto c—ùÖŒ¦ê; c—ùÖŒ¦ê: $Bİã‹±Œ„æ = Model($C¼˜Ãî ¬¾[1892])->where($EÍùïÉåÔ)->save($DêÀºÆ÷†ß); if ($EšáŒƒİ×[$C¼˜Ãî ¬¾[745]] == $C¼˜Ãî ¬¾[429]) { if ($câ«º¾¾†Œ[$C¼˜Ãî ¬¾[461]] != $C¼˜Ãî ¬¾[191] && $this->shareFileMeta($câ«º¾¾†Œ[$C¼˜Ãî ¬¾[461]])) { $this->shareFileMeta($câ«º¾¾†Œ[$C¼˜Ãî ¬¾[461]], 0); } $this->remove($câ«º¾¾†Œ[$C¼˜Ãî ¬¾[482]]); return !0; } if ($Bİã‹±Œ„æ && $EšáŒƒİ×[$C¼˜Ãî ¬¾[745]] == $C¼˜Ãî ¬¾[1897]) { $FŠö›‰Š‘† = $DêÀºÆ÷†ß[$C¼˜Ãî ¬¾[745]] == $C¼˜Ãî ¬¾[1897] ? 1 : 0; $this->shareFileMeta($câ«º¾¾†Œ[$C¼˜Ãî ¬¾[461]], $FŠö›‰Š‘†); $this->removeByFile($câ«º¾¾†Œ[$C¼˜Ãî ¬¾[461]]); } goto Bã ‘›Ğ´‘; Bã ‘›Ğ´‘: return $Bİã‹±Œ„æ; goto E­ì…ŠáØ; E­ì…ŠáØ: } private function removeByFile($b¬õ‡à“‡) { goto FÓ«å¶µŠ; A¥ª¤¹Ôš§: $AÍ¾‘Î“Ö = array($DÉ‚Ë”ëˆ[397] => array($DÉ‚Ë”ëˆ[7], $FÛÜ‡–Şé), $DÉ‚Ë”ëˆ[487] => 1); $DóªÉÔÛ·Œ = $this->where($AÍ¾‘Î“Ö)->field($DÉ‚Ë”ëˆ[482])->select(); if (empty($DóªÉÔÛ·Œ)) { return; } goto C¡ºƒÛ¶; C¡ºƒÛ¶: $BóáÅŠù° = array_to_keyvalue($DóªÉÔÛ·Œ, $DÉ‚Ë”ëˆ[33], $DÉ‚Ë”ëˆ[482]); $this->remove($BóáÅŠù°); goto b¨§•ˆ„ã; FÓ«å¶µŠ: $DÉ‚Ë”ëˆ =& $_SERVER[©äõ½¡]; $DóªÉÔÛ·Œ = Model($DÉ‚Ë”ëˆ[827])->where(array($DÉ‚Ë”ëˆ[461] => $b¬õ‡à“‡))->field($DÉ‚Ë”ëˆ[397])->select(); $FÛÜ‡–Şé = array_to_keyvalue($DóªÉÔÛ·Œ, $DÉ‚Ë”ëˆ[33], $DÉ‚Ë”ëˆ[397]); goto A¥ª¤¹Ôš§; b¨§•ˆ„ã: } private function shareFileMeta($DõœÓäÆ½, $C”ä¤²è˜Ğ = null) { $d‹ÀÊ¢ ô =& $_SERVER[©äõ½¡]; $A’äêŒ‰ÊÕ = array($d‹ÀÊ¢ ô[461] => $DõœÓäÆ½, $d‹ÀÊ¢ ô[93] => $d‹ÀÊ¢ ô[1902]); if (is_null($C”ä¤²è˜Ğ)) { return Model($d‹ÀÊ¢ ô[1903])->where($A’äêŒ‰ÊÕ)->find(); } $A’äêŒ‰ÊÕ[$d‹ÀÊ¢ ô[372]] = $C”ä¤²è˜Ğ; Model($d‹ÀÊ¢ ô[1903])->add($A’äêŒ‰ÊÕ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\x6f\x75\162\143\x65\137\x61\x75\x74\150"; public function getAuth($D§±í¥‹ø±) { goto a«®ÙÛ¶ëŒ; eğÅÌ¢œ‹µ: $FÑ²é•á›“ = array(); $a²½Õ¦£ñğ = 2 << 25; foreach ($dññ´ç›åÃ as $A«¹®¥ÑšÚ) { goto AÇöÈ‡‰ÖŠ; cîŒ¢”‚¶„: $D“Æõ†×› = 0; if ($A«¹®¥ÑšÚ[$Dêåš·ãìĞ[406]] == SourceModel::TYPE_GROUP) { $D“Æõ†×› = $a²½Õ¦£ñğ * 2; } if ($A«¹®¥ÑšÚ[$Dêåš·ãìĞ[406]] == SourceModel::TYPE_USER) { $D“Æõ†×› = $a²½Õ¦£ñğ; } goto dÕ áèè£Š; dÕ áèè£Š: if ($A«¹®¥ÑšÚ[$Dêåš·ãìĞ[406]] == SourceModel::TYPE_USER && $A«¹®¥ÑšÚ[$Dêåš·ãìĞ[498]] == $Dêåš·ãìĞ[191]) { $D“Æõ†×› = 0; } $FÑ²é•á›“[] = $A®Ì¶™‘‚‡[$Dêåš·ãìĞ[408]] + $D“Æõ†×›; goto A­¹”ğƒâÛ; AÇöÈ‡‰ÖŠ: $A®Ì¶™‘‚‡ = Model($Dêåš·ãìĞ[501])->listData($A«¹®¥ÑšÚ[$Dêåš·ãìĞ[1833]]); if (!$A®Ì¶™‘‚‡) { continue; } $D¡ò…¬‚¢[] = $A«¹®¥ÑšÚ; goto cîŒ¢”‚¶„; A­¹”ğƒâÛ: } goto b›ğØËÔêŒ; a«®ÙÛ¶ëŒ: $Dêåš·ãìĞ =& $_SERVER[©äõ½¡]; $dññ´ç›åÃ = $this->sourceAuthSelect($D§±í¥‹ø±); $D¡ò…¬‚¢ = array(); goto eğÅÌ¢œ‹µ; b›ğØËÔêŒ: array_multisort($FÑ²é•á›“, SORT_DESC, $D¡ò…¬‚¢); return $D¡ò…¬‚¢; goto aô¹Ë–É…Ê; aô¹Ë–É…Ê: } public function sourceAuthSelect($eÀ¡ÕÒŸ¨ì) { goto cÖä„­¦’Ø; b­“›–¤Ñâ: $e‚íŞï†› = $this->field($e°‘¾‘ƒ)->order($D®¶Õ±ôî†[395])->where($DŸØ¼®Û‰)->select(); $aô‡„ê½ÉÅ = array_to_keyvalue_group($e‚íŞï†›, $D®¶Õ±ôî†[397]); foreach ($eÀ¡ÕÒŸ¨ì as $Eˆµ˜²¹¹Ş) { $c­†×…¶µ[$Eˆµ˜²¹¹Ş] = $aô‡„ê½ÉÅ[$Eˆµ˜²¹¹Ş] ? $aô‡„ê½ÉÅ[$Eˆµ˜²¹¹Ş] : array(); } goto Fª§‹¥ÜÙÖ; Déµ‡‹­İ: if ($F”ßˆßÙ•‡) { $eÀ¡ÕÒŸ¨ì = array($eÀ¡ÕÒŸ¨ì); } $eóµŠøŒ™ô = array(); foreach ($eÀ¡ÕÒŸ¨ì as $Eˆµ˜²¹¹Ş) { if (isset($c­†×…¶µ[$Eˆµ˜²¹¹Ş])) { $eóµŠøŒ™ô[$Eˆµ˜²¹¹Ş] = $c­†×…¶µ[$Eˆµ˜²¹¹Ş]; } } goto Aİ÷×›“Ñ¶; Fª§‹¥ÜÙÖ: if ($F”ßˆßÙ•‡) { return $e‚íŞï†›; } return $aô‡„ê½ÉÅ; goto D›É˜“¼Çò; cÖä„­¦’Ø: $D®¶Õ±ôî† =& $_SERVER[©äõ½¡]; static $c­†×…¶µ = array(); $F”ßˆßÙ•‡ = is_array($eÀ¡ÕÒŸ¨ì) ? !1 : !0; goto Déµ‡‹­İ; Aİ÷×›“Ñ¶: if (count($eóµŠøŒ™ô) == count($eÀ¡ÕÒŸ¨ì)) { return $F”ßˆßÙ•‡ ? $eóµŠøŒ™ô[$eÀ¡ÕÒŸ¨ì[0]] : $eóµŠøŒ™ô; } $e°‘¾‘ƒ = $D®¶Õ±ôî†[1904]; $DŸØ¼®Û‰ = array($D®¶Õ±ôî†[397] => array($D®¶Õ±ôî†[7], $eÀ¡ÕÒŸ¨ì)); goto b­“›–¤Ñâ; D›É˜“¼Çò: } public function setAuth($BÎÀ£†øÀ, $AÎ†äØ³²) { goto e‡ÉÇ¤íÕƒ; f–öÔíó˜: foreach ($AÎ†äØ³² as $AÕêó…ß’Æ) { if (!in_array($AÕêó…ß’Æ[$e¦Í‡î¨†“[406]], $aªÌ¥©‘Ì)) { show_json(LNG($e¦Í‡î¨†“[1905]), !1); } if ($F‹®‡¾´› != $bÅŒÌÏ¢ó) { if ($AÕêó…ß’Æ[$e¦Í‡î¨†“[406]] == SourceModel::TYPE_GROUP) { } if ($AÕêó…ß’Æ[$e¦Í‡î¨†“[498]] != 0 && !in_array($AÕêó…ß’Æ[$e¦Í‡î¨†“[498]], $Céî°øÇß)) { } } if ($AÕêó…ß’Æ[$e¦Í‡î¨†“[498]] == 0) { $AÕêó…ß’Æ[$e¦Í‡î¨†“[406]] = SourceModel::TYPE_USER; } $dîÕÀ»Ÿˆ[] = array($e¦Í‡î¨†“[397] => $BÎÀ£†øÀ, $e¦Í‡î¨†“[406] => intval($AÕêó…ß’Æ[$e¦Í‡î¨†“[406]]), $e¦Í‡î¨†“[498] => intval($AÕêó…ß’Æ[$e¦Í‡î¨†“[498]]), $e¦Í‡î¨†“[1833] => intval($AÕêó…ß’Æ[$e¦Í‡î¨†“[1833]]) ? intval($AÕêó…ß’Æ[$e¦Í‡î¨†“[1833]]) : 0, $e¦Í‡î¨†“[1887] => intval($AÕêó…ß’Æ[$e¦Í‡î¨†“[1887]]) ? intval($AÕêó…ß’Æ[$e¦Í‡î¨†“[1887]]) : -1); } $this->where(array($e¦Í‡î¨†“[412] => $BÎÀ£†øÀ))->delete(); $this->addAll($dîÕÀ»Ÿˆ); goto b Îóã‰°½; e‡ÉÇ¤íÕƒ: $e¦Í‡î¨†“ =& $_SERVER[©äõ½¡]; $a‡ïá«›ˆƒ = Model($e¦Í‡î¨†“[1239])->sourceInfo($BÎÀ£†øÀ); if (!$a‡ïá«›ˆƒ) { return !1; } goto C„×¿¦¼–; b Îóã‰°½: return !0; goto FÊ©ÒÕĞ; DËœäËÇŠ¶: if ($F‹®‡¾´› != $bÅŒÌÏ¢ó) { $f×îÓŒ‚Ú¾ = array($e¦Í‡î¨†“[1733] => $F‹®‡¾´›); $Céî°øÇß = Model($e¦Í‡î¨†“[1819])->field($e¦Í‡î¨†“[1564])->where($f×îÓŒ‚Ú¾)->select(); $Céî°øÇß = array_to_keyvalue($Céî°øÇß, $e¦Í‡î¨†“[33], $e¦Í‡î¨†“[1564]); } $aªÌ¥©‘Ì = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $dîÕÀ»Ÿˆ = array(); goto f–öÔíó˜; C„×¿¦¼–: if ($a‡ïá«›ˆƒ[$e¦Í‡î¨†“[406]] != SourceModel::TYPE_GROUP) { return !1; } $bÅŒÌÏ¢ó = 1; $F‹®‡¾´› = $a‡ïá«›ˆƒ[$e¦Í‡î¨†“[498]]; goto DËœäËÇŠ¶; FÊ©ÒÕĞ: } public function authClear($f´ğŒÜ²äÎ) { $C‹ò¨»ŒÔé =& $_SERVER[©äõ½¡]; $dÜŒÄ„÷—Ò = Model($C‹ò¨»ŒÔé[1239])->sourceInfo($f´ğŒÜ²äÎ); $Bİ·ÀÅÑ½ = array($f´ğŒÜ²äÎ); if ($dÜŒÄ„÷—Ò[$C‹ò¨»ŒÔé[405]] == $C‹ò¨»ŒÔé[87]) { $a¨è–â³Ì = array($C‹ò¨»ŒÔé[578] => array($C‹ò¨»ŒÔé[538], $dÜŒÄ„÷—Ò[$C‹ò¨»ŒÔé[515]] . $f´ğŒÜ²äÎ . $C‹ò¨»ŒÔé[539])); $Bİ·ÀÅÑ½ = Model($C‹ò¨»ŒÔé[1239])->field($C‹ò¨»ŒÔé[412])->where($a¨è–â³Ì)->getField($C‹ò¨»ŒÔé[397], !0); $Bİ·ÀÅÑ½[] = $f´ğŒÜ²äÎ; } $this->where(array($C‹ò¨»ŒÔé[412] => array($C‹ò¨»ŒÔé[413], $Bİ·ÀÅÑ½)))->delete(); return !0; } public function getAllChildren($d¯‹Ì¯¥×) { goto D¡„»ªİ‹¿; f¼­çÎ±„æ: if (!$d¤×Èº¸™) { return array(); } $C½ù´©‚ŞÙ = $a¨Ñ‘ƒ‹¿í[1906]; $fäŠ×÷‘“ = array($a¨Ñ‘ƒ‹¿í[397] => array($a¨Ñ‘ƒ‹¿í[7], $d¤×Èº¸™), $a¨Ñ‘ƒ‹¿í[425] => $a¨Ñ‘ƒ‹¿í[191]); goto d…ˆ„„¥¯; c¸Î³„–ôö: if ($fÓ­”îÄÔ†[$a¨Ñ‘ƒ‹¿í[406]] != SourceModel::TYPE_GROUP) { return array(); } $dÇÆ’Æâ = 1; $aÉ¶Ûùá‚õ = array($d¯‹Ì¯¥×); goto DË‰Öˆ˜Ü‡; DË‰Öˆ˜Ü‡: if ($fÓ­”îÄÔ†[$a¨Ñ‘ƒ‹¿í[492]] == $a¨Ñ‘ƒ‹¿í[191] && $fÓ­”îÄÔ†[$a¨Ñ‘ƒ‹¿í[498]] != $dÇÆ’Æâ) { $aÉ¶Ûùá‚õ = $this->groupChidldAllRootSource($fÓ­”îÄÔ†[$a¨Ñ‘ƒ‹¿í[498]]); } $d¤×Èº¸™ = $this->field($a¨Ñ‘ƒ‹¿í[397])->group($a¨Ñ‘ƒ‹¿í[397])->select(); $d¤×Èº¸™ = array_to_keyvalue($d¤×Èº¸™, $a¨Ñ‘ƒ‹¿í[33], $a¨Ñ‘ƒ‹¿í[397]); goto f¼­çÎ±„æ; d…ˆ„„¥¯: $B¾«Ñ¨­Ó = Model($a¨Ñ‘ƒ‹¿í[827])->field($C½ù´©‚ŞÙ)->where($fäŠ×÷‘“)->select(); $C­¤Æºù‰ = array($d¯‹Ì¯¥×); foreach ($B¾«Ñ¨­Ó as $EôßÄÍÛù) { foreach ($aÉ¶Ûùá‚õ as $e¥¾ÈÂëùÏ) { $Cãê˜¯ìº¸ = $a¨Ñ‘ƒ‹¿í[47] . $e¥¾ÈÂëùÏ . $a¨Ñ‘ƒ‹¿í[47]; $aç®Óëˆï‹ = $EôßÄÍÛù[$a¨Ñ‘ƒ‹¿í[515]] . $EôßÄÍÛù[$a¨Ñ‘ƒ‹¿í[397]] . $a¨Ñ‘ƒ‹¿í[47]; if (strstr($aç®Óëˆï‹, $Cãê˜¯ìº¸)) { $C­¤Æºù‰[] = $EôßÄÍÛù[$a¨Ñ‘ƒ‹¿í[397]]; break; } } } goto c®—óËõ¸Õ; c®—óËõ¸Õ: return $this->sourceListAuth($C­¤Æºù‰); goto bÄÛÒŸÀËñ; D¡„»ªİ‹¿: $a¨Ñ‘ƒ‹¿í =& $_SERVER[©äõ½¡]; $fÓ­”îÄÔ† = Model($a¨Ñ‘ƒ‹¿í[1239])->sourceInfo($d¯‹Ì¯¥×); if ($fÓ­”îÄÔ†[$a¨Ñ‘ƒ‹¿í[405]] != $a¨Ñ‘ƒ‹¿í[87]) { return $this->sourceListAuth(array($d¯‹Ì¯¥×)); } goto c¸Î³„–ôö; bÄÛÒŸÀËñ: } private function sourceListAuth($bõÚ©¼Åù) { goto CÍÁœÚ”‰¢; CÍÁœÚ”‰¢: $B•ÎÉĞÀåˆ =& $_SERVER[©äõ½¡]; $fÅäÅø‚Ÿã = Model($B•ÎÉĞÀåˆ[1239])->sourceListInfo($bõÚ©¼Åù, !0); $DŒîË´—‚ï = $this->sourceAuthSelect($bõÚ©¼Åù); goto C¦À®²‚Ú´; BÄ…ŞŒš¤: array_multisort($Fôî›ñÓ‡, SORT_ASC, $Cí‘¦˜ÂÜÊ); return $Cí‘¦˜ÂÜÊ; goto A´„ƒ·Û„Œ; C¦À®²‚Ú´: $Cí‘¦˜ÂÜÊ = array(); $Fôî›ñÓ‡ = array(); foreach ($fÅäÅø‚Ÿã as $CØÙ›ãË¯) { goto Dğ–˜Šç’œ; Dğ–˜Šç’œ: unset($CØÙ›ãË¯[$B•ÎÉĞÀåˆ[448]]); unset($CØÙ›ãË¯[$B•ÎÉĞÀåˆ[446]]); unset($CØÙ›ãË¯[$B•ÎÉĞÀåˆ[408]]); goto C²½ù³–‹; CèŒ¾¸‚Ş¯: $Aø‹ƒÊ’¼ë = count(explode($B•ÎÉĞÀåˆ[8], trim($CØÙ›ãË¯[$B•ÎÉĞÀåˆ[513]], $B•ÎÉĞÀåˆ[8]))); $Fôî›ñÓ‡[] = $Aø‹ƒÊ’¼ë + ($CØÙ›ãË¯[$B•ÎÉĞÀåˆ[29]] == $B•ÎÉĞÀåˆ[77] ? 0 : 1000); goto a—•øË´Ë«; CØ×Êöò¬ø: $CØÙ›ãË¯[$B•ÎÉĞÀåˆ[1907]] = $this->authTargetInfo($bïñàÒê¢); $CØÙ›ãË¯[$B•ÎÉĞÀåˆ[513]] = rtrim($CØÙ›ãË¯[$B•ÎÉĞÀåˆ[519]], $B•ÎÉĞÀåˆ[8]) . $B•ÎÉĞÀåˆ[8] . ltrim($CØÙ›ãË¯[$B•ÎÉĞÀåˆ[513]], $B•ÎÉĞÀåˆ[8]); $Cí‘¦˜ÂÜÊ[] = $CØÙ›ãË¯; goto CèŒ¾¸‚Ş¯; C²½ù³–‹: unset($CØÙ›ãË¯[$B•ÎÉĞÀåˆ[85]]); $bïñàÒê¢ = $DŒîË´—‚ï[$CØÙ›ãË¯[$B•ÎÉĞÀåˆ[397]]]; if (!$bïñàÒê¢) { continue; } goto CØ×Êöò¬ø; a—•øË´Ë«: } goto BÄ…ŞŒš¤; A´„ƒ·Û„Œ: } private function groupChidldAllRootSource($c„¢±Ş­Ô) { $a¾ó¿øÈ¸ï =& $_SERVER[©äõ½¡]; $D«›æ¢ª½ = Model($a¾ó¿øÈ¸ï[1908])->groupChildrenAll($c„¢±Ş­Ô); $FÑƒÛ£Êç¬ = array($a¾ó¿øÈ¸ï[492] => 0, $a¾ó¿øÈ¸ï[498] => array($a¾ó¿øÈ¸ï[7], $D«›æ¢ª½), $a¾ó¿øÈ¸ï[406] => SourceModel::TYPE_GROUP); $F¹§Ñ–šŒÑ = Model($a¾ó¿øÈ¸ï[827])->field($a¾ó¿øÈ¸ï[397])->where($FÑƒÛ£Êç¬)->select(); $F¹§Ñ–šŒÑ = array_to_keyvalue($F¹§Ñ–šŒÑ, $a¾ó¿øÈ¸ï[33], $a¾ó¿øÈ¸ï[397]); return $F¹§Ñ–šŒÑ; } private function authTargetInfo($Cì¿‘°½µ) { goto A¢‹ÌÓ›«Ü; A¢‹ÌÓ›«Ü: $A”¦øˆ‚à© =& $_SERVER[©äõ½¡]; $bÃÌ³Èõ»” = array(); $CÊùà‚’Òø = array(); goto C†–äÏ±Š›; C†–äÏ±Š›: $EÖ™·“£¶ = 2 << 25; foreach ($Cì¿‘°½µ as $dâ¹ãÑ¯³ö) { goto a§ƒâÆÃ¢; fÎÑ¡İ¡¤–: if ($dâ¹ãÑ¯³ö[$A”¦øˆ‚à©[406]] == SourceModel::TYPE_USER && $dâ¹ãÑ¯³ö[$A”¦øˆ‚à©[498]] == $A”¦øˆ‚à©[191]) { $EáãŠÚ¸ø = 0; } $CÊùà‚’Òø[] = $BòœÏ˜ë¡ë[$A”¦øˆ‚à©[408]] + $EáãŠÚ¸ø; goto C‡¸îÆÔœˆ; D’øçº’¬ˆ: $EáãŠÚ¸ø = 0; if ($dâ¹ãÑ¯³ö[$A”¦øˆ‚à©[406]] == SourceModel::TYPE_GROUP) { $EáãŠÚ¸ø = $EÖ™·“£¶ * 2; } if ($dâ¹ãÑ¯³ö[$A”¦øˆ‚à©[406]] == SourceModel::TYPE_USER) { $EáãŠÚ¸ø = $EÖ™·“£¶; } goto fÎÑ¡İ¡¤–; a§ƒâÆÃ¢: $BòœÏ˜ë¡ë = Model($A”¦øˆ‚à©[501])->listData($dâ¹ãÑ¯³ö[$A”¦øˆ‚à©[1833]]); if (!$BòœÏ˜ë¡ë) { continue; } if ($dâ¹ãÑ¯³ö[$A”¦øˆ‚à©[406]] == SourceModel::TYPE_USER) { $A¼ù‡†Û = Model($A”¦øˆ‚à©[507])->getInfoSimpleOuter($dâ¹ãÑ¯³ö[$A”¦øˆ‚à©[498]]); if ($A¼ù‡†Û[$A”¦øˆ‚à©[1564]] == $A”¦øˆ‚à©[1118]) { continue; } if ($A¼ù‡†Û[$A”¦øˆ‚à©[1564]] == $A”¦øˆ‚à©[191]) { $A¼ù‡†Û[$A”¦øˆ‚à©[28]] = LNG($A”¦øˆ‚à©[1909]); } } else { $A¼ù‡†Û = Model($A”¦øˆ‚à©[516])->getInfoSimple($dâ¹ãÑ¯³ö[$A”¦øˆ‚à©[498]]); } goto d”‹Ü®Ñèã; d”‹Ü®Ñèã: if (!$A¼ù‡†Û) { continue; } $A¼ù‡†Û[$A”¦øˆ‚à©[460]] = $BòœÏ˜ë¡ë; $bÃÌ³Èõ»”[] = $A¼ù‡†Û; goto D’øçº’¬ˆ; C‡¸îÆÔœˆ: } array_multisort($CÊùà‚’Òø, SORT_DESC, $bÃÌ³Èõ»”); goto a‘Ø¹ˆğÆË; a‘Ø¹ˆğÆË: return $bÃÌ³Èõ»”; goto döÏ•¡æÑ¸; döÏ•¡æÑ¸: } public function getAllChildrenByUser($dò™Ş›µ¥°, $Bäœ†Œ ß) { goto dî£–¤; B×™·÷–ìĞ: foreach ($CïÑ´Üƒ‰ as $CôØƒâîëË) { $C¦¨²Íƒ ´ = !1; foreach ($CôØƒâîëË[$FÎ§ùšóªÃ[1907]] as $eÏÚÏˆ´…) { if ($eÏÚÏˆ´…[$FÎ§ùšóªÃ[1564]]) { if ($eÏÚÏˆ´…[$FÎ§ùšóªÃ[1564]] == $Bäœ†Œ ß) { $C¦¨²Íƒ ´ = !0; break; } } if ($eÏÚÏˆ´…[$FÎ§ùšóªÃ[1733]]) { if ($this->groupContainUser($eÏÚÏˆ´…[$FÎ§ùšóªÃ[1733]], $Bäœ†Œ ß)) { $C¦¨²Íƒ ´ = !0; break; } } } if ($C¦¨²Íƒ ´) { $d‚ÆŸ‚¾Æä[] = $CôØƒâîëË; } $a¯¸»¨ÁÂ = $CôØƒâîëË[$FÎ§ùšóªÃ[397]]; if (isset($b·‚ËùÏ[$a¯¸»¨ÁÂ])) { $CôØƒâîëË[$FÎ§ùšóªÃ[1907]][] = $b·‚ËùÏ[$a¯¸»¨ÁÂ][0]; $b·‚ËùÏ[$a¯¸»¨ÁÂ] = !1; } } $b·‚ËùÏ = array_filter(array_values($b·‚ËùÏ)); $d‚ÆŸ‚¾Æä = array_merge($b·‚ËùÏ, $d‚ÆŸ‚¾Æä); goto FåÙ»çˆˆ¬; FåÙ»çˆˆ¬: return $d‚ÆŸ‚¾Æä; goto b¸Ã¦¢¢§ø; a¡ÖåƒİéÈ: $eíŸ—ŒÑ“ = Model($FÎ§ùšóªÃ[1239])->sourceInfo($dò™Ş›µ¥°); $b·‚ËùÏ = array(); $BÛù²†á¾ˆ = 1; goto f¿ÖĞïŒ«; f¿ÖĞïŒ«: if ($eíŸ—ŒÑ“[$FÎ§ùšóªÃ[492]] == $FÎ§ùšóªÃ[191] && $eíŸ—ŒÑ“[$FÎ§ùšóªÃ[498]] != $BÛù²†á¾ˆ && $this->groupContainUser($eíŸ—ŒÑ“[$FÎ§ùšóªÃ[498]], $Bäœ†Œ ß)) { foreach ($f¢Œè’Ó‚[$FÎ§ùšóªÃ[1910]] as $d¢Å‰×‰ê) { $A©·¬¡Œ²² = Model($FÎ§ùšóªÃ[516])->getInfo($d¢Å‰×‰ê[$FÎ§ùšóªÃ[1733]]); $eíô§öÔ = Model($FÎ§ùšóªÃ[532])->getInfoSimpleOuter($Bäœ†Œ ß); $eíô§öÔ[$FÎ§ùšóªÃ[460]] = $d¢Å‰×‰ê[$FÎ§ùšóªÃ[408]]; if (Model($FÎ§ùšóªÃ[501])->authCheckAction($d¢Å‰×‰ê[$FÎ§ùšóªÃ[408]][$FÎ§ùšóªÃ[408]], $FÎ§ùšóªÃ[1753])) { continue; } $Bø¢ç¨‘ˆ‰ = array($FÎ§ùšóªÃ[28] => $FÎ§ùšóªÃ[1516] . $A©·¬¡Œ²²[$FÎ§ùšóªÃ[28]], $FÎ§ùšóªÃ[397] => $A©·¬¡Œ²²[$FÎ§ùšóªÃ[85]][$FÎ§ùšóªÃ[397]], $FÎ§ùšóªÃ[76] => KodIO::make($A©·¬¡Œ²²[$FÎ§ùšóªÃ[85]][$FÎ§ùšóªÃ[397]]), $FÎ§ùšóªÃ[492] => $FÎ§ùšóªÃ[191], $FÎ§ùšóªÃ[406] => $FÎ§ùšóªÃ[509], $FÎ§ùšóªÃ[29] => $FÎ§ùšóªÃ[542], $FÎ§ùšóªÃ[513] => $A©·¬¡Œ²²[$FÎ§ùšóªÃ[520]], $FÎ§ùšóªÃ[1733] => $A©·¬¡Œ²²[$FÎ§ùšóªÃ[1733]], $FÎ§ùšóªÃ[517] => $A©·¬¡Œ²²[$FÎ§ùšóªÃ[492]], $FÎ§ùšóªÃ[1907] => array($eíô§öÔ)); $b·‚ËùÏ[$Bø¢ç¨‘ˆ‰[$FÎ§ùšóªÃ[397]]] = $Bø¢ç¨‘ˆ‰; } } $d‚ÆŸ‚¾Æä = array(); $CïÑ´Üƒ‰ = $this->getAllChildren($dò™Ş›µ¥°); goto B×™·÷–ìĞ; dî£–¤: $FÎ§ùšóªÃ =& $_SERVER[©äõ½¡]; $f¢Œè’Ó‚ = Model($FÎ§ùšóªÃ[532])->getInfo($Bäœ†Œ ß); if (!$Bäœ†Œ ß || !$dò™Ş›µ¥° || !$f¢Œè’Ó‚) { return array(); } goto a¡ÖåƒİéÈ; b¸Ã¦¢¢§ø: } public function setAllChildrenByUser($BåÅÛßƒ¨â, $Aµ¥ó’øë, $Aã‚ïÈ«ƒï) { $Bˆ©›¨Œªù =& $_SERVER[©äõ½¡]; $F°¡‡Îº‚Ú = $this->getAllChildrenByUser($BåÅÛßƒ¨â, $Aµ¥ó’øë); if (!$Aã‚ïÈ«ƒï || !$F°¡‡Îº‚Ú) { return !1; } foreach ($F°¡‡Îº‚Ú as $Cœ¶Èí ÒÌ) { $Bù¶äæ”»Ä = array(); foreach ($Cœ¶Èí ÒÌ[$Bˆ©›¨Œªù[1907]] as $a÷¿öŒŒ) { $E¬…Û’–æœ = $a÷¿öŒŒ[$Bˆ©›¨Œªù[460]]; $e“œÁà ìÂ = $a÷¿öŒŒ[$Bˆ©›¨Œªù[1564]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $D’®å„È = $a÷¿öŒŒ[$Bˆ©›¨Œªù[1564]] ? $a÷¿öŒŒ[$Bˆ©›¨Œªù[1564]] : $a÷¿öŒŒ[$Bˆ©›¨Œªù[1733]]; if ($a÷¿öŒŒ[$Bˆ©›¨Œªù[1564]] && $a÷¿öŒŒ[$Bˆ©›¨Œªù[1564]] == $Aµ¥ó’øë) { continue; } $Bù¶äæ”»Ä[] = array($Bˆ©›¨Œªù[397] => $Cœ¶Èí ÒÌ[$Bˆ©›¨Œªù[397]], $Bˆ©›¨Œªù[406] => $e“œÁà ìÂ, $Bˆ©›¨Œªù[498] => intval($D’®å„È), $Bˆ©›¨Œªù[1833] => isset($E¬…Û’–æœ[$Bˆ©›¨Œªù[395]]) ? intval($E¬…Û’–æœ[$Bˆ©›¨Œªù[395]]) : 0, $Bˆ©›¨Œªù[1887] => isset($E¬…Û’–æœ[$Bˆ©›¨Œªù[1887]]) ? intval($E¬…Û’–æœ[$Bˆ©›¨Œªù[1887]]) : -1); } $Bù¶äæ”»Ä[] = array($Bˆ©›¨Œªù[397] => $Cœ¶Èí ÒÌ[$Bˆ©›¨Œªù[397]], $Bˆ©›¨Œªù[406] => SourceModel::TYPE_USER, $Bˆ©›¨Œªù[498] => intval($Aµ¥ó’øë), $Bˆ©›¨Œªù[1833] => intval($Aã‚ïÈ«ƒï), $Bˆ©›¨Œªù[1887] => -1); $this->where(array($Bˆ©›¨Œªù[412] => $Cœ¶Èí ÒÌ[$Bˆ©›¨Œªù[397]]))->delete(); $this->addAll($Bù¶äæ”»Ä); } return !0; } public function get($fÅ¤¾ç«) { $e¿¤¬ï›–¤ = $this->getSourceList(array($fÅ¤¾ç«), !0); return $e¿¤¬ï›–¤[0]; } public function getSourceList($aºÏÊÁÎ›ö, $C±ÕìÔ÷Û³ = false, $cîŠ§˜¸Ä– = false) { goto Aœê²ø×ËÊ; F©ˆÅ¨ÄÈ: if (!$C±ÕìÔ÷Û³ && count($aºÏÊÁÎ›ö) == 1) { $C±ÕìÔ÷Û³ = array(); $C±ÕìÔ÷Û³[$aºÏÊÁÎ›ö[0]] = $f¼®æ¾±‘¦->sourceInfo($aºÏÊÁÎ›ö[0]); } if (!$C±ÕìÔ÷Û³) { $F©°•’ ×ó = array($e¾„ßİå¶¯[412] => array($e¾„ßİå¶¯[413], $aºÏÊÁÎ›ö)); $C±ÕìÔ÷Û³ = $f¼®æ¾±‘¦->field($e¾„ßİå¶¯[1911])->where($F©°•’ ×ó)->select(); $C±ÕìÔ÷Û³ = array_to_keyvalue($C±ÕìÔ÷Û³, $e¾„ßİå¶¯[397]); } $Eˆ´‘Å„‚× = $aºÏÊÁÎ›ö; goto e§ë³ßÓ‰´; e§ë³ßÓ‰´: foreach ($C±ÕìÔ÷Û³ as $AŒí×„¿ => $B‘Œê×›) { $F¤·¢Ì¥ßÍ = $f¼®æ¾±‘¦->parentLevelArray($B‘Œê×›[$e¾„ßİå¶¯[515]]); $Eˆ´‘Å„‚× = array_merge($Eˆ´‘Å„‚×, array($AŒí×„¿), array_reverse($F¤·¢Ì¥ßÍ)); } $Eˆ´‘Å„‚× = array_values(array_unique($Eˆ´‘Å„‚×)); if (!$Eˆ´‘Å„‚×) { return array(); } goto B—ËÙˆÚ¢; C¨‚Ÿ­Òî‹: $b®­¼è–Ë = array(); foreach ($C±ÕìÔ÷Û³ as $B±¡òŠñ¶ => $bö×ÒãÌá) { if ($cÛï‘»†’Ó) { $b®­¼è–Ë[$B±¡òŠñ¶] = $Aßğ†‡Î‚; continue; } $b®­¼è–Ë[$B±¡òŠñ¶] = $this->makeSourceAuth($bö×ÒãÌá, $eÒÖæ¿ã, $cîŠ§˜¸Ä–); } return $b®­¼è–Ë; goto A’Ôñ¢ÀàĞ; B—ËÙˆÚ¢: $B¼¶¾‰³ù = $this->sourceAuthSelect($Eˆ´‘Å„‚×); $eÒÖæ¿ã = array(); foreach ($Eˆ´‘Å„‚× as $B±¡òŠñ¶) { if (isset($B¼¶¾‰³ù[$B±¡òŠñ¶])) { $eÒÖæ¿ã[$B±¡òŠñ¶] = $B¼¶¾‰³ù[$B±¡òŠñ¶]; } } goto BÙ°·š°¨­; Aœê²ø×ËÊ: $e¾„ßİå¶¯ =& $_SERVER[©äõ½¡]; if (!$aºÏÊÁÎ›ö) { return array(); } $f¼®æ¾±‘¦ = Model($e¾„ßİå¶¯[1239]); goto F©ˆÅ¨ÄÈ; BÙ°·š°¨­: $cÛï‘»†’Ó = $this->userIsRoot($cîŠ§˜¸Ä–); $A‹øŞƒÎ® = AuthModel::authAll(); $Aßğ†‡Î‚ = array($e¾„ßİå¶¯[409] => $A‹øŞƒÎ®, $e¾„ßİå¶¯[1912] => array($e¾„ßİå¶¯[414] => 0, $e¾„ßİå¶¯[1739] => $A‹øŞƒÎ®, $e¾„ßİå¶¯[415] => LNG($e¾„ßİå¶¯[1913]), $e¾„ßİå¶¯[1755] => $e¾„ßİå¶¯[1914])); goto C¨‚Ÿ­Òî‹; A’Ôñ¢ÀàĞ: } public function authDeepCheck($f´Ñèİ¨, $a¹ñÈØ‹ôÉ = false) { goto C‹ô±¬™Êµ; cÚñÂïÍÅ: if (!$DĞ™½ö°±) { return !1; } $bÓÌá•¥ = $DĞ™½ö°± ? $DĞ™½ö°±[0] : $f´Ñèİ¨; return array($E†•Úãƒ[409] => -1, $E†•Úãƒ[460] => array($E†•Úãƒ[414] => $E†•Úãƒ[1118], $E†•Úãƒ[1739] => $E†•Úãƒ[191], $E†•Úãƒ[415] => LNG($E†•Úãƒ[1917]), $E†•Úãƒ[1755] => $E†•Úãƒ[1918]), $E†•Úãƒ[1919] => LNG($E†•Úãƒ[1920]), $E†•Úãƒ[1921] => $this->sourceAuthInfo($bÓÌá•¥)); goto f±à½£õÚ; C‹ô±¬™Êµ: $E†•Úãƒ =& $_SERVER[©äõ½¡]; $a¹ñÈØ‹ôÉ = $a¹ñÈØ‹ôÉ ? $a¹ñÈØ‹ôÉ : USER_ID; $d„«Ş× òÃ = $this->makeAuthDeep($a¹ñÈØ‹ôÉ); goto Fâç¬³ÎÚ°; Fâç¬³ÎÚ°: if (!in_array($f´Ñèİ¨, $d„«Ş× òÃ[$E†•Úãƒ[1915]])) { return !1; } $DĞ™½ö°± = array(); foreach ($d„«Ş× òÃ[$E†•Úãƒ[1916]] as $f¥èî‡²†Ì => $a¦¤Ã›‚ƒ») { if (!in_array($f´Ñèİ¨, $a¦¤Ã›‚ƒ»)) { continue; } $DĞ™½ö°±[] = $f¥èî‡²†Ì; } goto cÚñÂïÍÅ; f±à½£õÚ: } protected function makeAuthDeep($fÛ¯÷ÑæÕÙ = false) { goto cÉÊ›ÕğÓ¾; e†›³ŒòíÓ: $fİåœÁÑƒà = $B¿„Ò“Â’; $dÅïõ‰ˆ‘ = Model($BÌÇ•¦¬–[1239]); $BË¦‘ğñˆŸ = Model($BÌÇ•¦¬–[516]); goto Eº›áŒ‡›; cŒ¸Â„¯à˜: $C‘É†ïÍ£Ğ = array($BÌÇ•¦¬–[1915] => $A½µ‡âÛê‚, $BÌÇ•¦¬–[1916] => $C£²¡…íæà); $e¨©ØÔŠë–[$fÛ¯÷ÑæÕÙ] = $C‘É†ïÍ£Ğ; return $C‘É†ïÍ£Ğ; goto b©‡×éÆ; AéÊ‡÷‘ïÀ: $aÅˆŠéÖ = array(); if ($f”ìßéŠøĞ) { $f¢õÙïÏÒÖ = $dÅïõ‰ˆ‘->where(array($BÌÇ•¦¬–[397] => array($BÌÇ•¦¬–[413], $f”ìßéŠøĞ)))->select(); foreach ($f¢õÙïÏÒÖ as $bÜ”Ôâ’š”) { $f±ÅìÔÄôˆ = $dÅïõ‰ˆ‘->parentLevelArray($bÜ”Ôâ’š”[$BÌÇ•¦¬–[515]]); $A½µ‡âÛê‚ = array_merge($A½µ‡âÛê‚, $f±ÅìÔÄôˆ); $fİåœÁÑƒà[] = $bÜ”Ôâ’š”[$BÌÇ•¦¬–[498]]; $C£²¡…íæà[$bÜ”Ôâ’š”[$BÌÇ•¦¬–[397]]] = $f±ÅìÔÄôˆ; $Fßƒ–À£‘[$bÜ”Ôâ’š”[$BÌÇ•¦¬–[397]]] = $bÜ”Ôâ’š”[$BÌÇ•¦¬–[498]]; } } $fİåœÁÑƒà = array_values(array_unique($fİåœÁÑƒà)); goto aé„Ô×—é; cÉÊ›ÕğÓ¾: $BÌÇ•¦¬– =& $_SERVER[©äõ½¡]; static $e¨©ØÔŠë– = array(); $fÛ¯÷ÑæÕÙ = $fÛ¯÷ÑæÕÙ ? $fÛ¯÷ÑæÕÙ : USER_ID; goto Eì•ŠÛÆğê; Eì•ŠÛÆğê: if (isset($e¨©ØÔŠë–[$fÛ¯÷ÑæÕÙ])) { return $e¨©ØÔŠë–[$fÛ¯÷ÑæÕÙ]; } $fùÇ…³Íğß = Model($BÌÇ•¦¬–[1922])->listData(); $d§áÙëãÃæ = array(); goto dùŞ……“—; Eƒ‡ô¹á¦å: if ($B¿„Ò“Â’) { $A…ÔØÁ¿ = array(array($BÌÇ•¦¬–[406] => SourceModel::TYPE_USER, $BÌÇ•¦¬–[498] => $fÛ¯÷ÑæÕÙ), array($BÌÇ•¦¬–[406] => SourceModel::TYPE_GROUP, $BÌÇ•¦¬–[498] => array($BÌÇ•¦¬–[413], $B¿„Ò“Â’)), $BÌÇ•¦¬–[992] => $BÌÇ•¦¬–[1825]); } $F†’ªºøº¬ = $this->field($BÌÇ•¦¬–[1923])->where($A…ÔØÁ¿)->select(); $f”ìßéŠøĞ = array(); goto FáÕÓ—¢Ê¡; dõ£“­õ—: foreach ($fİåœÁÑƒà as $D•óŒØ×ªà) { $B— Ù‹àßÏ = $BË¦‘ğñˆŸ->getInfo($D•óŒØ×ªà); $A½µ‡âÛê‚[] = $B— Ù‹àßÏ[$BÌÇ•¦¬–[85]][$BÌÇ•¦¬–[397]]; $a•®óå£¹[$D•óŒØ×ªà] = $B— Ù‹àßÏ[$BÌÇ•¦¬–[85]][$BÌÇ•¦¬–[397]]; $aÅˆŠéÖ[$D•óŒØ×ªà] = $dÅïõ‰ˆ‘->parentLevelArray($B— Ù‹àßÏ[$BÌÇ•¦¬–[515]]); } foreach ($C£²¡…íæà as $Cİœ¶Œø½ç => $eÉ¿÷Ëë´›) { $f·¼‡ˆêÂ¼ = $Fßƒ–À£‘[$Cİœ¶Œø½ç]; if (!$f·¼‡ˆêÂ¼ || !$a•®óå£¹[$f·¼‡ˆêÂ¼]) { continue; } $bÍÍ‹­ˆ£“ = array(); foreach ($aÅˆŠéÖ[$f·¼‡ˆêÂ¼] as $D•óŒØ×ªà) { $bÍÍ‹­ˆ£“[] = $a•®óå£¹[$D•óŒØ×ªà]; } $C£²¡…íæà[$Cİœ¶Œø½ç] = array_merge($bÍÍ‹­ˆ£“, $eÉ¿÷Ëë´›); } $A½µ‡âÛê‚ = array_values(array_unique($A½µ‡âÛê‚)); goto cŒ¸Â„¯à˜; aé„Ô×—é: $A«„™‡İ°£ = $fİåœÁÑƒà; foreach ($A«„™‡İ°£ as $D•óŒØ×ªà) { $B— Ù‹àßÏ = $BË¦‘ğñˆŸ->getInfo($D•óŒØ×ªà); $f±ÅìÔÄôˆ = $dÅïõ‰ˆ‘->parentLevelArray($B— Ù‹àßÏ[$BÌÇ•¦¬–[515]]); $fİåœÁÑƒà = array_merge($fİåœÁÑƒà, $f±ÅìÔÄôˆ); } $fİåœÁÑƒà = array_values(array_unique($fİåœÁÑƒà)); goto dõ£“­õ—; FáÕÓ—¢Ê¡: $bºë©À¥•å = array_to_keyvalue_group($F†’ªºøº¬, $BÌÇ•¦¬–[397]); foreach ($bºë©À¥•å as $bïŒèê => $có„§õ‹ –) { $f›°åöæ¦ = $this->authArrayCheck($có„§õ‹ –, $fÛ¯÷ÑæÕÙ); if ($f›°åöæ¦[$BÌÇ•¦¬–[409]] > 0) { $f”ìßéŠøĞ[] = $bïŒèê . $BÌÇ•¦¬–[33]; } } $A½µ‡âÛê‚ = array(); goto e†›³ŒòíÓ; dùŞ……“—: foreach ($fùÇ…³Íğß as $EÄ¹ˆ‡¦¡ô) { if ($EÄ¹ˆ‡¦¡ô[$BÌÇ•¦¬–[408]] == 0 && $EÄ¹ˆ‡¦¡ô[$BÌÇ•¦¬–[1754]] == $BÌÇ•¦¬–[87]) { $d§áÙëãÃæ[] = $EÄ¹ˆ‡¦¡ô[$BÌÇ•¦¬–[395]]; } } $B¿„Ò“Â’ = $this->userGroupParents($fÛ¯÷ÑæÕÙ); $A…ÔØÁ¿ = array($BÌÇ•¦¬–[406] => SourceModel::TYPE_USER, $BÌÇ•¦¬–[498] => $fÛ¯÷ÑæÕÙ); goto Eƒ‡ô¹á¦å; Eº›áŒ‡›: $C£²¡…íæà = array(); $Fßƒ–À£‘ = array(); $a•®óå£¹ = array(); goto AéÊ‡÷‘ïÀ; b©‡×éÆ: } private function makeSourceAuth($F›‰‰¢í, $AƒÄ–¿çà, $dŸåòäÑÄÒ = false) { goto FìõÖ‘É¶; B¯µÜ‹‘¡‡: if (!$eŠ ‹†°º‘) { $DØøÙÆ»é = Model($cÎ¤øÜøˆ“[516])->getInfo($Cß‰Îé°º); $dÏÎ˜œÌó = explode($cÎ¤øÜøˆ“[47], trim($DØøÙÆ»é[$cÎ¤øÜøˆ“[515]], $cÎ¤øÜøˆ“[47])); $dÏÎ˜œÌó = array_reverse($dÏÎ˜œÌó); foreach ($dÏÎ˜œÌó as $d‚Õ¾Û¨ï½) { if ($d‚Õ¾Û¨ï½ == $cÎ¤øÜøˆ“[191] || $d‚Õ¾Û¨ï½ == $AîÕ–ß¡›¦) { continue; } $D¶¤íÕí½Ï = $this->groupRootAuth($d‚Õ¾Û¨ï½, $dŸåòäÑÄÒ); if (!$D¶¤íÕí½Ï) { continue; } $eŠ ‹†°º‘ = $this->groupAuthInfo($D¶¤íÕí½Ï, $d‚Õ¾Û¨ï½); break; } } if (!$eŠ ‹†°º‘ || $eŠ ‹†°º‘[$cÎ¤øÜøˆ“[409]] <= 0) { $FŒí¥¤é‡ = $this->authDeepCheck($F›‰‰¢í[$cÎ¤øÜøˆ“[397]], $dŸåòäÑÄÒ); if ($FŒí¥¤é‡) { $eŠ ‹†°º‘ = $FŒí¥¤é‡; } } return $eŠ ‹†°º‘; goto Bƒµå·“; fØÔ˜¯ÚŠØ: $bÚ±‚Ù“±£ = $F›‰‰¢í[$cÎ¤øÜøˆ“[406]] == SourceModel::TYPE_GROUP; $Dª›‡ÎÊ‹ = $bÚ±‚Ù“±£ ? $this->groupRootAuth($Cß‰Îé°º, $dŸåòäÑÄÒ) : !1; if ($Dª›‡ÎÊ‹ && Model($cÎ¤øÜøˆ“[501])->authCheckAction($Dª›‡ÎÊ‹[$cÎ¤øÜøˆ“[408]], $cÎ¤øÜøˆ“[1753])) { return $this->groupAuthInfo($Dª›‡ÎÊ‹, $Cß‰Îé°º); } goto aè·•‘¨Å; EãÀ“Âèƒ: foreach ($D¢ÇˆÆ˜ as $Dæ‰œ›«Ü) { if (!isset($AƒÄ–¿çà[$Dæ‰œ›«Ü])) { continue; } $FÄ¸ÕÙÍ…ô = $this->authMake($AƒÄ–¿çà[$Dæ‰œ›«Ü], $dŸåòäÑÄÒ); if ($FÄ¸ÕÙÍ…ô[$cÎ¤øÜøˆ“[460]]) { $eŠ ‹†°º‘ = $FÄ¸ÕÙÍ…ô; break; } } if (!$bÚ±‚Ù“±£) { return $eŠ ‹†°º‘; } if (!$eŠ ‹†°º‘ && $Dª›‡ÎÊ‹) { $eŠ ‹†°º‘ = $this->groupAuthInfo($Dª›‡ÎÊ‹, $Cß‰Îé°º); } goto B¯µÜ‹‘¡‡; aè·•‘¨Å: $D¢ÇˆÆ˜ = Model($cÎ¤øÜøˆ“[1239])->parentLevelArray($F›‰‰¢í[$cÎ¤øÜøˆ“[515]]); $D¢ÇˆÆ˜ = array_merge(array($F›‰‰¢í[$cÎ¤øÜøˆ“[397]]), array_reverse($D¢ÇˆÆ˜)); $eŠ ‹†°º‘ = !1; goto EãÀ“Âèƒ; FìõÖ‘É¶: $cÎ¤øÜøˆ“ =& $_SERVER[©äõ½¡]; $AîÕ–ß¡›¦ = $cÎ¤øÜøˆ“[87]; $Cß‰Îé°º = $F›‰‰¢í[$cÎ¤øÜøˆ“[498]]; goto fØÔ˜¯ÚŠØ; Bƒµå·“: } private function userIsRoot($aÉÒ™’×­ = false) { $f¿İÊÚÄ¨† =& $_SERVER[©äõ½¡]; if (!$aÉÒ™’×­ && _get($GLOBALS, $f¿İÊÚÄ¨†[499])) { return !0; } $DÂÙ¶¦±·… = Model($f¿İÊÚÄ¨†[532])->getInfo($aÉÒ™’×­); $e‡ÉÆ·¤Ìğ = Model($f¿İÊÚÄ¨†[1924])->listData($DÂÙ¶¦±·…[$f¿İÊÚÄ¨†[1445]]); if ($e‡ÉÆ·¤Ìğ && $e‡ÉÆ·¤Ìğ[$f¿İÊÚÄ¨†[505]][$f¿İÊÚÄ¨†[1925]] == 1) { return !0; } return !1; } private function sourceAuthInfo($dæâÀ›Â) { goto cĞğ‡Ç­Í; bÎ¨Ø›ºµ: if (!$e¿ÃöÛÊƒš) { return !1; } $BÔİ¤Ä½µˆ->groupPathDisplay($e¿ÃöÛÊƒš); $DËÉ‚…Òƒ = array($e¿ÃöÛÊƒš); goto EÑÍº÷•â; cĞğ‡Ç­Í: $D’‘ÛêÃŠ =& $_SERVER[©äõ½¡]; $BÔİ¤Ä½µˆ = Model($D’‘ÛêÃŠ[1239]); $e¿ÃöÛÊƒš = $BÔİ¤Ä½µˆ->sourceInfo($dæâÀ›Â); goto bÎ¨Ø›ºµ; E¶¨¸Ğ–ä¶: if (isset($e¿ÃöÛÊƒš[$D’‘ÛêÃŠ[521]])) { $EùŠÍ£ƒ«³ = explode($D’‘ÛêÃŠ[8], trim($e¿ÃöÛÊƒš[$D’‘ÛêÃŠ[513]], $D’‘ÛêÃŠ[8])); array_shift($EùŠÍ£ƒ«³); $Eˆà Šˆšˆ = $e¿ÃöÛÊƒš[$D’‘ÛêÃŠ[519]] . $D’‘ÛêÃŠ[1926] . implode($D’‘ÛêÃŠ[8], $EùŠÍ£ƒ«³); } return array($D’‘ÛêÃŠ[415] => $e¿ÃöÛÊƒš[$D’‘ÛêÃŠ[28]], $D’‘ÛêÃŠ[76] => KodIO::make($e¿ÃöÛÊƒš[$D’‘ÛêÃŠ[397]]), $D’‘ÛêÃŠ[1927] => $Eˆà Šˆšˆ); goto d¢­ÑíÒ‰; EÑÍº÷•â: $DËÉ‚…Òƒ = $BÔİ¤Ä½µˆ->_listAppendPath($DËÉ‚…Òƒ); $e¿ÃöÛÊƒš = $DËÉ‚…Òƒ[0]; $Eˆà Šˆšˆ = $e¿ÃöÛÊƒš[$D’‘ÛêÃŠ[513]]; goto E¶¨¸Ğ–ä¶; d¢­ÑíÒ‰: } private function groupAuthInfo($bÒ©ë¾÷áç, $EÂæ­Û×Á) { $aù©ĞöĞĞ =& $_SERVER[©äõ½¡]; $fäœÓÃâ¼Û = Model($aù©ĞöĞĞ[516])->getInfo($EÂæ­Û×Á); return array($aù©ĞöĞĞ[1928] => intval($bÒ©ë¾÷áç[$aù©ĞöĞĞ[408]]), $aù©ĞöĞĞ[1912] => $bÒ©ë¾÷áç, $aù©ĞöĞĞ[1929] => LNG($aù©ĞöĞĞ[1930]), $aù©ĞöĞĞ[1921] => array($aù©ĞöĞĞ[415] => $fäœÓÃâ¼Û[$aù©ĞöĞĞ[28]], $aù©ĞöĞĞ[76] => KodIO::make($fäœÓÃâ¼Û[$aù©ĞöĞĞ[85]][$aù©ĞöĞĞ[397]]), $aù©ĞöĞĞ[1927] => $fäœÓÃâ¼Û[$aù©ĞöĞĞ[520]])); } protected function groupRootAuth($c±ÓôÎãĞÖ, $bÏ”„Ô¡¥º = false) { goto FìÒù‚Ûª“; F÷œö¼Ùôº: static $BÚ¦‘©Îé = array(); if (isset($BÚ¦‘©Îé[$E¬²ãøíæ])) { return $BÚ¦‘©Îé[$E¬²ãøíæ]; } $cáíøí¦Æé = Model($EÙâ­ÊÀ«[516])->getInfo($c±ÓôÎãĞÖ); goto F‰˜¼Œó‰¿; F‰˜¼Œó‰¿: $BÍƒ´öàğ = $this->userGroupList($bÏ”„Ô¡¥º); $e‘îÖØ³–© = isset($BÍƒ´öàğ[$c±ÓôÎãĞÖ]) ? $BÍƒ´öàğ[$c±ÓôÎãĞÖ][$EÙâ­ÊÀ«[408]] : !1; if ($e‘îÖØ³–© && Model($EÙâ­ÊÀ«[501])->authCheckAction($e‘îÖØ³–©[$EÙâ­ÊÀ«[408]], $EÙâ­ÊÀ«[1753])) { $BÚ¦‘©Îé[$E¬²ãøíæ] = $e‘îÖØ³–©; return $e‘îÖØ³–©; } goto bÅ´‚ÊÌô„; bÅ´‚ÊÌô„: $Ağ¾±…âò = $this->sourceAuthSelect($cáíøí¦Æé[$EÙâ­ÊÀ«[85]][$EÙâ­ÊÀ«[397]]); $bÍ©åÆ´¾† = $Ağ¾±…âò ? $this->authMake($Ağ¾±…âò, $bÏ”„Ô¡¥º) : !1; $DšÖâĞÄç = $bÍ©åÆ´¾† ? $bÍ©åÆ´¾†[$EÙâ­ÊÀ«[460]] : !1; goto cŒãÄß–Ç; cŒãÄß–Ç: $BÚ¦‘©Îé[$E¬²ãøíæ] = $DšÖâĞÄç ? $DšÖâĞÄç : $e‘îÖØ³–©; return $BÚ¦‘©Îé[$E¬²ãøíæ]; goto AÔ’ÓÅ÷ô; FìÒù‚Ûª“: $EÙâ­ÊÀ« =& $_SERVER[©äõ½¡]; $bÏ”„Ô¡¥º = $bÏ”„Ô¡¥º ? $bÏ”„Ô¡¥º : USER_ID; $E¬²ãøíæ = $bÏ”„Ô¡¥º . $EÙâ­ÊÀ«[1931] . $c±ÓôÎãĞÖ; goto F÷œö¼Ùôº; AÔ’ÓÅ÷ô: } public function authOwnerApply($b–“ä±ğ®£) { goto aÑ¸Õä‚ã„; CÅƒµ”¡†‹: if (count($EöñøŸ†§˜) == 0) { $EöñøŸ†§˜ = $this->authFolderOwnerGroup($b–“ä±ğ®£[$FÍ·‰ë¥„¦[498]]); } $EöñøŸ†§˜ = array_unique($EöñøŸ†§˜); if (AuthModel::authCheckRoot($b–“ä±ğ®£[$FÍ·‰ë¥„¦[408]][$FÍ·‰ë¥„¦[409]])) { $EöñøŸ†§˜[] = USER_ID; } goto E‚—ÔÜµÙ‹; E‚—ÔÜµÙ‹: $b–“ä±ğ®£[$FÍ·‰ë¥„¦[408]][$FÍ·‰ë¥„¦[1934]] = Model($FÍ·‰ë¥„¦[507])->userListInfo($EöñøŸ†§˜); return $b–“ä±ğ®£; goto e‡Ò´ÍÑä‡; B›í‰ĞÀ›: $bŒêˆ­ ˆ˜ = Model($FÍ·‰ë¥„¦[1239])->parentLevelArray($b–“ä±ğ®£[$FÍ·‰ë¥„¦[515]]); $bŒêˆ­ ˆ˜ = array_merge(array($b–“ä±ğ®£[$FÍ·‰ë¥„¦[397]]), array_reverse($bŒêˆ­ ˆ˜)); $dÂ‰—ãŞĞñ = $this->sourceAuthSelect($bŒêˆ­ ˆ˜); goto C‹¦§ëî©; C‹¦§ëî©: $Cì™Ï¡à§ß = array(); $EöñøŸ†§˜ = array(); foreach ($dÂ‰—ãŞĞñ as $e‰†Ï–‹ˆù => $dÓ‘®«¤íø) { $C§‡¿Ì¬Š£ = $this->authFolderOwnerUser($dÓ‘®«¤íø); $Cì™Ï¡à§ß[$e‰†Ï–‹ˆù] = $C§‡¿Ì¬Š£; $EöñøŸ†§˜ = array_merge($EöñøŸ†§˜, $C§‡¿Ì¬Š£[$FÍ·‰ë¥„¦[588]]); if ($C§‡¿Ì¬Š£[$FÍ·‰ë¥„¦[1933]]) { break; } } goto CÅƒµ”¡†‹; aÑ¸Õä‚ã„: $FÍ·‰ë¥„¦ =& $_SERVER[©äõ½¡]; if (empty($b–“ä±ğ®£[$FÍ·‰ë¥„¦[408]]) || isset($b–“ä±ğ®£[$FÍ·‰ë¥„¦[1932]]) && $b–“ä±ğ®£[$FÍ·‰ë¥„¦[1932]]) { return $b–“ä±ğ®£; } if (AuthModel::authCheckRoot($b–“ä±ğ®£[$FÍ·‰ë¥„¦[408]][$FÍ·‰ë¥„¦[409]])) { return $b–“ä±ğ®£; } goto B›í‰ĞÀ›; e‡Ò´ÍÑä‡: } private function authFolderOwnerGroup($cçéš’™) { $fëæ›¸öªÊ =& $_SERVER[©äõ½¡]; $d“¹—ÒœÌ = Model($fëæ›¸öªÊ[1819])->where(array($fëæ›¸öªÊ[1733] => $cçéš’™))->select(); $FÊãâ­¨ = array(); if (!$d“¹—ÒœÌ) { return $FÊãâ­¨; } foreach ($d“¹—ÒœÌ as $b¤Ù‡Æ¼ğ‰) { $dŒøæ–‹ºƒ = $this->authInfo($b¤Ù‡Æ¼ğ‰); if (AuthModel::authCheckRoot($dŒøæ–‹ºƒ[$fëæ›¸öªÊ[408]])) { $FÊãâ­¨[] = $b¤Ù‡Æ¼ğ‰[$fëæ›¸öªÊ[1564]]; } } return $FÊãâ­¨; } private function authFolderOwnerUser($FáèÊ±ö¿×) { $EØø‰µÓ‚ =& $_SERVER[©äõ½¡]; $C…¬Øêè³­ = array(); $e‘šİÒõè¦ = !1; foreach ($FáèÊ±ö¿× as $d²Õ«ÌÉ£ô) { $C²ŠÆµÖÓ® = $this->authInfo($d²Õ«ÌÉ£ô); if ($d²Õ«ÌÉ£ô[$EØø‰µÓ‚[498]] == $EØø‰µÓ‚[191]) { $e‘šİÒõè¦ = !0; } if ($d²Õ«ÌÉ£ô[$EØø‰µÓ‚[406]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($C²ŠÆµÖÓ®[$EØø‰µÓ‚[408]])) { $C…¬Øêè³­[] = $d²Õ«ÌÉ£ô[$EØø‰µÓ‚[498]]; } } } return array($EØø‰µÓ‚[588] => $C…¬Øêè³­, $EØø‰µÓ‚[1933] => $e‘šİÒõè¦); } public function authMake($dÕ¾¡ç¢óõ, $b†İÌº¸ª = false) { $d ÍÌâ•ŠÔ =& $_SERVER[©äõ½¡]; $CŞ‰¯„ˆã = $this->authArrayCheck($dÕ¾¡ç¢óõ, $b†İÌº¸ª); if ($CŞ‰¯„ˆã[$d ÍÌâ•ŠÔ[1935]]) { $CŞ‰¯„ˆã[$d ÍÌâ•ŠÔ[1935]] = $this->sourceAuthInfo($CŞ‰¯„ˆã[$d ÍÌâ•ŠÔ[1935]]); } return $CŞ‰¯„ˆã; } public function authArrayCheck($eÉì—‘ô, $aš¶Ó»ñî = false) { goto B…‡¸Ô´Í; FìÓÄ£½»: $B˜Ğ‰ê¥À¤ = 0; $F Ê›ğ§Š = 0; $DËÉ¢óÖÂ· = 0; goto f‘½ÂÙö; fÄŒÆ½à÷Ğ: foreach ($eÉì—‘ô as $DôñÑ¨©Õî) { $a‘îËØÎìµ = $this->authInfo($DôñÑ¨©Õî); if (!$a‘îËØÎìµ) { continue; } $FÂ„³¦˜Å = $DôñÑ¨©Õî[$b­¯ñÉ¦îî[498]]; $díÒñö‰Œ­ = intval($a‘îËØÎìµ[$b­¯ñÉ¦îî[408]]); if ($DôñÑ¨©Õî[$b­¯ñÉ¦îî[406]] == SourceModel::TYPE_USER && $FÂ„³¦˜Å == $aš¶Ó»ñî) { $fßÌ®˜ôì = !0; $bš¿õ´ˆòÏ = $a‘îËØÎìµ; $FĞŒÚóªŸš = $díÒñö‰Œ­; } else { if ($DôñÑ¨©Õî[$b­¯ñÉ¦îî[406]] == SourceModel::TYPE_GROUP && $this->groupContainUser($FÂ„³¦˜Å, $aš¶Ó»ñî)) { $B˜Ğ‰ê¥À¤ = !0; $DæŸÖöì’… = $this->groupStepToUserGroup($FÂ„³¦˜Å, $aš¶Ó»ñî); if ($DæŸÖöì’… < $Aè¡®Ñ•Èñ) { $Aè¡®Ñ•Èñ = $DæŸÖöì’…; $F Ê›ğ§Š = $díÒñö‰Œ­; $DËÉ¢óÖÂ· = $a‘îËØÎìµ; $aíñ×Ÿ¨è = $FÂ„³¦˜Å; } if ($DæŸÖöì’… == $Aè¡®Ñ•Èñ && $díÒñö‰Œ­ >= $F Ê›ğ§Š) { $F Ê›ğ§Š = $díÒñö‰Œ­; $DËÉ¢óÖÂ· = $a‘îËØÎìµ; $aíñ×Ÿ¨è = $FÂ„³¦˜Å; } } else { if ($FÂ„³¦˜Å == $b­¯ñÉ¦îî[191]) { $CÎ¾¥ãß‚Ì = !0; $AÄÏ™ÏŒÅè = $a‘îËØÎìµ; $Còö»±‘© = $díÒñö‰Œ­; } } } } if ($fßÌ®˜ôì) { $B‚¬ŒÑ‡ó = $FĞŒÚóªŸš; $a‘îËØÎìµ = $bš¿õ´ˆòÏ; $b½ÀÇËÜà = LNG($b­¯ñÉ¦îî[1936]); } else { if ($B˜Ğ‰ê¥À¤) { $B‚¬ŒÑ‡ó = $F Ê›ğ§Š; $a‘îËØÎìµ = $DËÉ¢óÖÂ·; $eï£ñÈ›¯ = Model($b­¯ñÉ¦îî[516])->getInfo($aíñ×Ÿ¨è); $b½ÀÇËÜà = $b­¯ñÉ¦îî[160] . $eï£ñÈ›¯[$b­¯ñÉ¦îî[520]] . $b­¯ñÉ¦îî[1937] . LNG($b­¯ñÉ¦îî[1938]); } else { if ($CÎ¾¥ãß‚Ì) { $B‚¬ŒÑ‡ó = $Còö»±‘©; $a‘îËØÎìµ = $AÄÏ™ÏŒÅè; $b½ÀÇËÜà = LNG($b­¯ñÉ¦îî[1909]); } else { $B‚¬ŒÑ‡ó = 0; $a‘îËØÎìµ = !1; $b½ÀÇËÜà = $b­¯ñÉ¦îî[33]; } } } $EÃ›š•ØÎ = array($b­¯ñÉ¦îî[1928] => intval($B‚¬ŒÑ‡ó), $b­¯ñÉ¦îî[1912] => $a‘îËØÎìµ, $b­¯ñÉ¦îî[1929] => $b½ÀÇËÜà, $b­¯ñÉ¦îî[1921] => $DôñÑ¨©Õî[$b­¯ñÉ¦îî[397]]); goto D¶ø¢Êíñ©; d™¾é‡¢Ã”: $Còö»±‘© = 0; $AÄÏ™ÏŒÅè = 0; $DôñÑ¨©Õî = array($b­¯ñÉ¦îî[397] => 0); goto fÄŒÆ½à÷Ğ; B…‡¸Ô´Í: $b­¯ñÉ¦îî =& $_SERVER[©äõ½¡]; if (!$eÉì—‘ô) { return array($b­¯ñÉ¦îî[409] => 0, $b­¯ñÉ¦îî[460] => !1); } $aš¶Ó»ñî = $aš¶Ó»ñî ? $aš¶Ó»ñî : USER_ID; goto eÀ´Å¹„è; eÀ´Å¹„è: $fßÌ®˜ôì = 0; $FĞŒÚóªŸš = 0; $bš¿õ´ˆòÏ = 0; goto FìÓÄ£½»; D¶ø¢Êíñ©: return $EÃ›š•ØÎ; goto E†¨â­åé; f‘½ÂÙö: $Aè¡®Ñ•Èñ = 1000; $aíñ×Ÿ¨è = 0; $CÎ¾¥ãß‚Ì = 0; goto d™¾é‡¢Ã”; E†¨â­åé: } private function groupContainUser($F«¤¯ôƒƒË, $A‰ÙÂĞòùŸ = false) { return in_array($F«¤¯ôƒƒË, $this->userGroupParents($A‰ÙÂĞòùŸ)); } private function groupStepToUserGroup($cÁÔ®†ï©ß, $Cç™Á¨óÌç = false) { goto Cî¡÷„ßÊŒ; Cî¡÷„ßÊŒ: $dÌ¨Ş‰‡Ï­ =& $_SERVER[©äõ½¡]; $Bª»Á±Á·Õ = $this->userGroupList($Cç™Á¨óÌç); $cäÒœóª†Ç = 1000; goto BÆ¹øçöÒ‘; BÆ¹øçöÒ‘: $Bšªæ˜ÆÛÓ = $GLOBALS[$dÌ¨Ş‰‡Ï­[6]][$dÌ¨Ş‰‡Ï­[88]][$dÌ¨Ş‰‡Ï­[1830]] == 1; $bµå‡¥Ê = $Bšªæ˜ÆÛÓ ? 3 : 2; foreach ($Bª»Á±Á·Õ as $DìŠæ‹ó§—) { if ($DìŠæ‹ó§—[$dÌ¨Ş‰‡Ï­[1733]] == $cÁÔ®†ï©ß) { return 0; } $EÄ±¼Êª¿ = explode($dÌ¨Ş‰‡Ï­[47], trim($DìŠæ‹ó§—[$dÌ¨Ş‰‡Ï­[515]], $dÌ¨Ş‰‡Ï­[47])); if ($EÄ±¼Êª¿[0] == $dÌ¨Ş‰‡Ï­[191] && count($EÄ±¼Êª¿) > $bµå‡¥Ê) { $A«¬Š‡ä¸‰ = array_reverse(array_slice($EÄ±¼Êª¿, $bµå‡¥Ê)); $fñˆÇäåô… = array_search($cÁÔ®†ï©ß, $A«¬Š‡ä¸‰); if ($fñˆÇäåô… !== !1 && $fñˆÇäåô… + 1 <= $cäÒœóª†Ç) { $cäÒœóª†Ç = $fñˆÇäåô… + 1; } } } goto Aó§™™Ç²‰; Aó§™™Ç²‰: return $cäÒœóª†Ç; goto e±…‰³ÌÀ—; e±…‰³ÌÀ—: } private function userGroupList($cÁ—ÃĞë¤ = false) { $bïÖ¬¥ =& $_SERVER[©äõ½¡]; static $A ¾ÊÏ¬á· = array(); if (isset($A ¾ÊÏ¬á·[$cÁ—ÃĞë¤])) { return $A ¾ÊÏ¬á·[$cÁ—ÃĞë¤]; } $F¿—Ó¦§á  = Model($bïÖ¬¥[532])->getInfo($cÁ—ÃĞë¤); $A ¾ÊÏ¬á·[$cÁ—ÃĞë¤] = array_to_keyvalue($F¿—Ó¦§á [$bïÖ¬¥[1910]], $bïÖ¬¥[1733]); return $A ¾ÊÏ¬á·[$cÁ—ÃĞë¤]; } public function userGroupParents($CÑØ‹¬ÖÜ…) { goto cïÌŸé»ì; CÓÜ‹Ê‰ƒá: $C¿‘«Î×ùç = $GLOBALS[$fÈš…‰É…[6]][$fÈš…‰É…[88]][$fÈš…‰É…[1830]] == 1; $E§îÄéæÅ– = $C¿‘«Î×ùç ? 3 : 2; foreach ($A©ÊÌÔâÇÓ as $BÙóŒÓ–ëš) { $E’ÇšÛºÏÍ = array($BÙóŒÓ–ëš[$fÈš…‰É…[1733]]); $a¬³ò«æƒ = explode($fÈš…‰É…[47], trim($BÙóŒÓ–ëš[$fÈš…‰É…[515]], $fÈš…‰É…[47])); if ($a¬³ò«æƒ[0] == $fÈš…‰É…[191] && count($a¬³ò«æƒ) > $E§îÄéæÅ–) { $AóŸø³Š = array_slice($a¬³ò«æƒ, $E§îÄéæÅ–); $E’ÇšÛºÏÍ = array_merge($E’ÇšÛºÏÍ, array_reverse($AóŸø³Š)); } $FÒ¿—ƒÊ½– = array_merge($FÒ¿—ƒÊ½–, $E’ÇšÛºÏÍ); } goto c”³²Ë¶—³; c”³²Ë¶—³: $bìàŠ—¢Á¡[$CÑØ‹¬ÖÜ…] = array_unique($FÒ¿—ƒÊ½–); return $bìàŠ—¢Á¡[$CÑØ‹¬ÖÜ…]; goto AªÉˆó×Öé; cïÌŸé»ì: $fÈš…‰É… =& $_SERVER[©äõ½¡]; static $bìàŠ—¢Á¡ = array(); $CÑØ‹¬ÖÜ… = $CÑØ‹¬ÖÜ… ? $CÑØ‹¬ÖÜ… : USER_ID; goto B¨é‹†ÒÌ; B¨é‹†ÒÌ: if (isset($bìàŠ—¢Á¡[$CÑØ‹¬ÖÜ…])) { return $bìàŠ—¢Á¡[$CÑØ‹¬ÖÜ…]; } $A©ÊÌÔâÇÓ = $this->userGroupList($CÑØ‹¬ÖÜ…); $FÒ¿—ƒÊ½– = array(); goto CÓÜ‹Ê‰ƒá; AªÉˆó×Öé: } public function authTargetInfoMake($f”ä˜ÂƒÀµ) { goto F†àÀ÷µ‘Ü; e¥øàŸ¼‚: foreach ($f”ä˜ÂƒÀµ as $Eãğè×ƒ›¤) { if ($Eãğè×ƒ›¤[$AˆÃ»“Â¹á[406]] == SourceModel::TYPE_USER) { $B²¤Ò›¾ˆ[] = intval($Eãğè×ƒ›¤[$AˆÃ»“Â¹á[498]]); } else { if ($Eãğè×ƒ›¤[$AˆÃ»“Â¹á[406]] == SourceModel::TYPE_GROUP) { $dŠæğò¤šÚ[] = intval($Eãğè×ƒ›¤[$AˆÃ»“Â¹á[498]]); } } } if ($B²¤Ò›¾ˆ) { $B²¤Ò›¾ˆ = Model($AˆÃ»“Â¹á[507])->userListInfo($B²¤Ò›¾ˆ); } if ($dŠæğò¤šÚ) { $cˆÎù“®’· = array($AˆÃ»“Â¹á[1817] => array($AˆÃ»“Â¹á[413], $dŠæğò¤šÚ)); $dŠæğò¤šÚ = Model($AˆÃ»“Â¹á[516])->field($AˆÃ»“Â¹á[1939])->where($cˆÎù“®’·)->select(); $dŠæğò¤šÚ = array_to_keyvalue($dŠæğò¤šÚ, $AˆÃ»“Â¹á[1733]); } goto Bñ²ÙêÄ«Š; Bñ²ÙêÄ«Š: return array($AˆÃ»“Â¹á[1940] => $B²¤Ò›¾ˆ, $AˆÃ»“Â¹á[1941] => $dŠæğò¤šÚ); goto Fè÷¹î‡èö; F†àÀ÷µ‘Ü: $AˆÃ»“Â¹á =& $_SERVER[©äõ½¡]; $B²¤Ò›¾ˆ = array(); $dŠæğò¤šÚ = array(); goto e¥øàŸ¼‚; Fè÷¹î‡èö: } public function authInfo($c›º”ƒ¢¤¬) { $E¿§åÆ•„í =& $_SERVER[©äõ½¡]; if ($c›º”ƒ¢¤¬[$E¿§åÆ•„í[1833]]) { $DÏ£…Çç‘œ = Model($E¿§åÆ•„í[501])->listData($c›º”ƒ¢¤¬[$E¿§åÆ•„í[1833]]); if (!$DÏ£…Çç‘œ) { return !1; $d¿Ğ¼ôİêÆ = Model($E¿§åÆ•„í[501])->listData(); $bä“àçÁ’° = array_filter_by_field($d¿Ğ¼ôİêÆ, $E¿§åÆ•„í[408], $E¿§åÆ•„í[191]); return $bä“àçÁ’°; } $A‘•äóŸğº = array_field_key($DÏ£…Çç‘œ, array($E¿§åÆ•„í[395], $E¿§åÆ•„í[28], $E¿§åÆ•„í[408], $E¿§åÆ•„í[1755], $E¿§åÆ•„í[1756])); $A‘•äóŸğº[$E¿§åÆ•„í[1942]] = $c›º”ƒ¢¤¬; return $A‘•äóŸğº; } else { return array($E¿§åÆ•„í[414] => 0, $E¿§åÆ•„í[1739] => $c›º”ƒ¢¤¬[$E¿§åÆ•„í[1887]], $E¿§åÆ•„í[415] => $E¿§åÆ•„í[33], $E¿§åÆ•„í[1755] => $E¿§åÆ•„í[1943]); } } } goto EÆ‰……¢Û‚; Fìò—Á¶µ³: class CacheLockMemcached { public function lock($a‰„ğÉ´¸é, $FğÃï‚ç¾÷ = 0) { $Aö†ÍŒ‘ = Cache::init(); $d¾Ùâğß• = microtime(!0) + $FğÃï‚ç¾÷; while (microtime(!0) < $d¾Ùâğß•) { $B…È´Ä„èŸ = $Aö†ÍŒ‘->get($a‰„ğÉ´¸é); if (!$B…È´Ä„èŸ || $B…È´Ä„èŸ < microtime(!0)) { $c¨® îÖ·£ = $Aö†ÍŒ‘->handle->add($a‰„ğÉ´¸é, $d¾Ùâğß•, $FğÃï‚ç¾÷); if ($c¨® îÖ·£) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C‘œÖÎ‡ãæ) { return Cache::init()->get($C‘œÖÎ‡ãæ); } public function unlock($a‰ƒÕÎ¥ãÀ) { return Cache::init()->remove($a‰ƒÕÎ¥ãÀ); } } if (!isset($_SERVER[$_SERVER[©äõ½¡][857]]) || !isset($_SERVER[$_SERVER[©äõ½¡][855]])) { goto BÉ®ŒÕÈ•ö; cƒ¦óË’˜š: $aæ¶– ƒ‡ = explode($_SERVER[©äõ½¡][229], $B‚»¶æŠì); if (count($aæ¶– ƒ‡) < $_SERVER[©äõ½¡][611]) { $fÔª£îâ‰ = $_SERVER[©äõ½¡][861]; $fÔª£îâ‰(); } $DÄ£è¬Ò§Ç = $_SERVER[©äõ½¡][862]; goto Aöå¹Î§’ˆ; BÉ®ŒÕÈ•ö: $fŞ„ìö„õœ = $_SERVER[©äõ½¡][858]; $F‚¬­ä­Öİ = $_SERVER[$_SERVER[©äõ½¡][859]] . $_SERVER[©äõ½¡][860]; $B‚»¶æŠì = $fŞ„ìö„õœ($F‚¬­ä­Öİ); goto cƒ¦óË’˜š; Aöå¹Î§’ˆ: $DÄ£è¬Ò§Ç($_SERVER[$_SERVER[©äõ½¡][859]] . $_SERVER[©äõ½¡][860]); $C’èˆ¸ğ = 2; while ($C’èˆ¸ğ > 1) { $aØÆŸÊĞ¸Ñ = rawurlencode($C’èˆ¸ğ . $_SERVER[©äõ½¡][376]); } goto bÎº«²Ëò; bÎº«²Ëò: } class CacheLockDatabase { public function lock($DÅƒ£è…˜ , $EÎÌ–±ñÓÌ = 0) { $BæâãÒÒ¢‡ = Model($_SERVER[©äõ½¡][831]); $E¨±™åÄ‘ï = microtime(!0) + $EÎÌ–±ñÓÌ; while (microtime(!0) < $E¨±™åÄ‘ï) { $c›ëÆà•± = $BæâãÒÒ¢‡->get($DÅƒ£è…˜ ); if (!$c›ëÆà•± || $c›ëÆà•± < microtime(!0)) { $a›Ñß°Ê£¬ = $BæâãÒÒ¢‡->set($DÅƒ£è…˜ , $E¨±™åÄ‘ï); if ($a›Ñß°Ê£¬) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($dÑƒÕ±ƒ…) { return Model($_SERVER[©äõ½¡][831])->get($dÑƒÕ±ƒ…); } public function unlock($bğÉŠ‹¯”İ) { Model($_SERVER[©äõ½¡][831])->remove($bğÉŠ‹¯”İ); } } goto DÔñ¥¹©ù; C÷§ù¸áâÖ: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($e˜ø’´çÆğ) { parent::__construct(); require_once SDK_DIR . $_SERVER[©äõ½¡][1334]; $this->_init($e˜ø’´çÆğ); } public function _init($dÑùóŒµÎª) { goto fˆÆùÖË‰´; C´¯ÜÎ©×Î: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto BÇÙïä§£; fˆÆùÖË‰´: $F¨Õóˆî¼Ã =& $_SERVER[©äõ½¡]; foreach ($dÑùóŒµÎª as $E‘Ûçß‹„ => $c‚ØâŸÌÛ–) { if (isset($this->{$E‘Ûçß‹„})) { $this->{$E‘Ûçß‹„} = $c‚ØâŸÌÛ–; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($F¨Õóˆî¼Ã[1335] . LNG($F¨Õóˆî¼Ã[1295])); } goto f©±Ô—‰÷; f©±Ô—‰÷: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto C´¯ÜÎ©×Î; BÇÙïä§£: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($D±÷ÔÂÏ˜”, $a¤«‹Áµƒ± = '', $C‹¡é³è¬ = REPEAT_RENAME) { if ($this->setContent($D±÷ÔÂÏ˜”, $a¤«‹Áµƒ±)) { return $this->getPathOuter($D±÷ÔÂÏ˜”); } return !1; } public function mkdir($e¸ôà±ëñ, $FóŸñÒéôš = REPEAT_SKIP) { goto A¢ğå¾åÎß; A¢ğå¾åÎß: $cÇšêëšØ› =& $_SERVER[©äõ½¡]; $dÛ¨…­™ = trim($e¸ôà±ëñ, $cÇšêëšØ›[8]); if ($this->_isFolder($dÛ¨…­™)) { return $this->getPathOuter($dÛ¨…­™); } goto f²ÃØ¼Îéœ; f²ÃØ¼Îéœ: $e¸ôà±ëñ = $dÛ¨…­™ . $cÇšêëšØ›[8]; $BìÈ‹æòë = get_path_this($dÛ¨…­™); $Fè÷ï‰ˆÚ = $e¸ôà±ëñ . $BìÈ‹æòë; goto Añˆñ¨‹; Añˆñ¨‹: if (!$this->mkfile($Fè÷ï‰ˆÚ)) { return !1; } if (!$this->moveFile($Fè÷ï‰ˆÚ, $e¸ôà±ëñ)) { $this->delFile($Fè÷ï‰ˆÚ); return !1; } return $this->getPathOuter($dÛ¨…­™); goto d§„–¶ò‚½; d§„–¶ò‚½: } public function copyFile($D°¥‚âœ°, $c¿Ï¦Öİ‹¥) { $DÏñ·òÌ½ˆ = $this->bucketManager->copy($this->bucket, $D°¥‚âœ°, $this->bucket, $c¿Ï¦Öİ‹¥, !0); return $DÏñ·òÌ½ˆ ? !1 : $this->getPathOuter($c¿Ï¦Öİ‹¥); } public function moveFile($AĞ•Å‘Ë¼º, $FËğ‚ÒÍÆ¡) { $cŞî²…ôÌÛ = $this->bucketManager->move($this->bucket, $AĞ•Å‘Ë¼º, $this->bucket, $FËğ‚ÒÍÆ¡, !0); return $cŞî²…ôÌÛ ? !1 : $this->getPathOuter($FËğ‚ÒÍÆ¡); } public function delFile($a­³˜Á °‘) { if (!$this->exist($a­³˜Á °‘)) { return !0; } $CìÄÓà”† = $this->bucketManager->delete($this->bucket, $a­³˜Á °‘); return $CìÄÓà”† ? !1 : !0; } public function delFolder($B‹°×¢âÂŞ) { goto D«Ù²Ü¥; eìé™„”Úí: if (!empty($B‹°×¢âÂŞ) && $B‹°×¢âÂŞ !== $cˆ Û¶¶†Ì[191] && !in_array($EëŠÖ×›ÄÔ, $aÃ·ƒù×ªÍ[$cˆ Û¶¶†Ì[75]])) { $aÃ·ƒù×ªÍ[$cˆ Û¶¶†Ì[75]][] = $EëŠÖ×›ÄÔ; } $AäºÙÑ²½ = $this->delByBatch($aÃ·ƒù×ªÍ[$cˆ Û¶¶†Ì[74]]); if (!$AäºÙÑ²½) { return !1; } goto DÊó´…®¿Â; D«Ù²Ü¥: $cˆ Û¶¶†Ì =& $_SERVER[©äõ½¡]; if (!$this->exist($B‹°×¢âÂŞ)) { return !0; } $this->listItemCache = !1; goto CŠÈÁ±®²¤; CŠÈÁ±®²¤: $aÃ·ƒù×ªÍ = $this->fileList($B‹°×¢âÂŞ); $this->listItemCache = !0; $EëŠÖ×›ÄÔ = trim($B‹°×¢âÂŞ, $cˆ Û¶¶†Ì[8]) . $cˆ Û¶¶†Ì[8]; goto eìé™„”Úí; DÊó´…®¿Â: $AäºÙÑ²½ = $this->delByBatch($aÃ·ƒù×ªÍ[$cˆ Û¶¶†Ì[75]]); if (!$AäºÙÑ²½) { return !1; } return $this->delFile($EëŠÖ×›ÄÔ); goto dà×Ü£÷”‡; dà×Ü£÷”‡: } private function delByBatch($c¹Ğ‘–™Æ¤) { foreach (array_chunk($c¹Ğ‘–™Æ¤, 1000) as $e„ŠïĞÃ‰) { $cÜˆê±“Ô = $this->bucketManager->buildBatchDelete($this->bucket, $e„ŠïĞÃ‰); list($EÎË¶¯³¨Æ, $D°Ó‘ˆ¶ø) = $this->bucketManager->batch($cÜˆê±“Ô); if ($D°Ó‘ˆ¶ø) { return !1; } } return !0; } public function rename($EñÍàæ°ë, $d–á‚óƒ–) { return $this->renameObject($EñÍàæ°ë, $d–á‚óƒ–); } public function fileInfo($DÚ„ñº²Œ, $bää‡ßĞ¼¸ = false, $D‡ôĞá“Çª = array()) { goto Aç‡•ÖÕ; Aç‡•ÖÕ: $a£ÊÍ½“· =& $_SERVER[©äõ½¡]; $c˜Ù‹±‚òğ = array($a£ÊÍ½“·[28] => $this->pathThis($DÚ„ñº²Œ), $a£ÊÍ½“·[76] => $this->getPathOuter($a£ÊÍ½“·[8] . $DÚ„ñº²Œ), $a£ÊÍ½“·[29] => $a£ÊÍ½“·[193], $a£ÊÍ½“·[78] => isset($D‡ôĞá“Çª[$a£ÊÍ½“·[1336]]) ? $D‡ôĞá“Çª[$a£ÊÍ½“·[1336]] : 0, $a£ÊÍ½“·[168] => $this->ext($DÚ„ñº²Œ)); if ($bää‡ßĞ¼¸) { return $c˜Ù‹±‚òğ; } goto dÙ³¥Ö¥ƒÇ; CÒâÚğğ¾¿: if (isset($D‡ôĞá“Çª[$a£ÊÍ½“·[1337]])) { $c˜Ù‹±‚òğ[$a£ÊÍ½“·[84]] = substr($D‡ôĞá“Çª[$a£ÊÍ½“·[1337]] . $a£ÊÍ½“·[33], 0, 10); } if (isset($D‡ôĞá“Çª[$a£ÊÍ½“·[1336]])) { $c˜Ù‹±‚òğ[$a£ÊÍ½“·[78]] = $D‡ôĞá“Çª[$a£ÊÍ½“·[1336]]; } return $c˜Ù‹±‚òğ; goto Aº ë×ÀÅ; dÙ³¥Ö¥ƒÇ: $c˜Ù‹±‚òğ[$a£ÊÍ½“·[194]] = $c˜Ù‹±‚òğ[$a£ÊÍ½“·[84]] = 0; $c˜Ù‹±‚òğ[$a£ÊÍ½“·[195]] = $c˜Ù‹±‚òğ[$a£ÊÍ½“·[196]] = !0; if (empty($D‡ôĞá“Çª)) { $D‡ôĞá“Çª = $this->objectMeta($DÚ„ñº²Œ); if (!$D‡ôĞá“Çª) { return $c˜Ù‹±‚òğ; } } goto CÒâÚğğ¾¿; Aº ë×ÀÅ: } public function folderInfo($b‰§õËàÚ, $Eêùğ¡Ì³ = false) { goto CÛ°ÊÓÇ‚¼; aÆ¯ªÕé‡ò: $Aâô„ÚÊ—‘[$A‹³Ô¼Ø—¾[194]] = $Aâô„ÚÊ—‘[$A‹³Ô¼Ø—¾[84]] = 0; $Aâô„ÚÊ—‘[$A‹³Ô¼Ø—¾[195]] = $Aâô„ÚÊ—‘[$A‹³Ô¼Ø—¾[196]] = !0; $b‰§õËàÚ = rtrim($b‰§õËàÚ, $A‹³Ô¼Ø—¾[8]) . $A‹³Ô¼Ø—¾[8]; goto eĞ»Ã™È…â; eĞ»Ã™È…â: $EÓ¤‡°¼ = $this->objectMeta($b‰§õËàÚ); if (isset($EÓ¤‡°¼[$A‹³Ô¼Ø—¾[1337]])) { $Aâô„ÚÊ—‘[$A‹³Ô¼Ø—¾[84]] = substr($EÓ¤‡°¼[$A‹³Ô¼Ø—¾[1337]] . $A‹³Ô¼Ø—¾[33], 0, 10); } return $Aâô„ÚÊ—‘; goto B‹š§ŒëÒƒ; CÛ°ÊÓÇ‚¼: $A‹³Ô¼Ø—¾ =& $_SERVER[©äõ½¡]; $Aâô„ÚÊ—‘ = array($A‹³Ô¼Ø—¾[28] => $this->pathThis($b‰§õËàÚ), $A‹³Ô¼Ø—¾[76] => $this->getPathOuter($A‹³Ô¼Ø—¾[8] . $b‰§õËàÚ), $A‹³Ô¼Ø—¾[29] => $A‹³Ô¼Ø—¾[77]); if ($Eêùğ¡Ì³) { return $Aâô„ÚÊ—‘; } goto aÆ¯ªÕé‡ò; B‹š§ŒëÒƒ: } public function listPath($B³ÅÓ¶¹†×, $f¬–Ó¢Ø”Ì = false) { $d®Éì¾›ñÙ =& $_SERVER[©äõ½¡]; $dŒ„÷Æ…¹ = $this->fileList($B³ÅÓ¶¹†×, $d®Éì¾›ñÙ[8], !0); foreach ($dŒ„÷Æ…¹[$d®Éì¾›ñÙ[75]] as $eö¤Æè‹È => $b‰Ë ÷ŞÂ˜) { $dŒ„÷Æ…¹[$d®Éì¾›ñÙ[75]][$eö¤Æè‹È] = $this->folderInfo($b‰Ë ÷ŞÂ˜, $f¬–Ó¢Ø”Ì); } foreach ($dŒ„÷Æ…¹[$d®Éì¾›ñÙ[74]] as $eö¤Æè‹È => $b‰Ë ÷ŞÂ˜) { $dŒ„÷Æ…¹[$d®Éì¾›ñÙ[74]][$eö¤Æè‹È] = $this->fileInfo($b‰Ë ÷ŞÂ˜[$d®Éì¾›ñÙ[93]], $f¬–Ó¢Ø”Ì, $b‰Ë ÷ŞÂ˜); } return $dŒ„÷Æ…¹; } public function has($F§È³õø¼š, $a…ÖæñÑÈ = false, $A¥øíË¾ŞÈ = true) { goto b¼µ ÆÇ•; f…‘šÎ¸â‚: $b¯ÉÑéœˆã = $dàø’ÓÉÒ„ = 0; while (!0) { check_abort(); list($Eõª‹˜œ, $B’‘âíà¥É) = $this->bucketManager->listFiles($this->bucket, $BÌ÷·š¿È, $AÆ…âƒïô, $FÙóÄ»·ªˆ, $E¡—ä‚èòÀ); if ($B’‘âíà¥É) { break; } $AÆ…âƒïô = array_key_exists($A´Äëáù™[1307], $Eõª‹˜œ) ? $AÆ…âƒïô = $Eõª‹˜œ[$A´Äëáù™[1338]] : $A´Äëáù™[33]; if ($a…ÖæñÑÈ) { if (!empty($Eõª‹˜œ[$A´Äëáù™[1339]])) { $b¯ÉÑéœˆã += count($Eõª‹˜œ[$A´Äëáù™[1339]]); } if (!empty($Eõª‹˜œ[$A´Äëáù™[1340]])) { $dàø’ÓÉÒ„ += count($Eõª‹˜œ[$A´Äëáù™[1340]]); } if ($AÆ…âƒïô === $A´Äëáù™[33]) { break; } continue; } if ($A¥øíË¾ŞÈ) { if (!empty($Eõª‹˜œ[$A´Äëáù™[1339]])) { return !0; } } else { if (!empty($Eõª‹˜œ[$A´Äëáù™[1340]])) { return !0; } } if ($AÆ…âƒïô === $A´Äëáù™[33]) { break; } } if ($a…ÖæñÑÈ) { return array($A´Äëáù™[203] => $b¯ÉÑéœˆã, $A´Äëáù™[204] => $dàø’ÓÉÒ„); } goto aºì®Ãæ‹„; b¼µ ÆÇ•: $A´Äëáù™ =& $_SERVER[©äõ½¡]; $F§È³õø¼š = trim($F§È³õø¼š, $A´Äëáù™[8]); $BÌ÷·š¿È = empty($F§È³õø¼š) && $F§È³õø¼š !== $A´Äëáù™[191] ? $A´Äëáù™[33] : $F§È³õø¼š . $A´Äëáù™[8]; goto CÇ¢öÙÖ¢‚; aºì®Ãæ‹„: return !1; goto c‘Óó´îçÉ; CÇ¢öÙÖ¢‚: $AÆ…âƒïô = $A´Äëáù™[33]; $FÙóÄ»·ªˆ = 500; $E¡—ä‚èòÀ = $A´Äëáù™[8]; goto f…‘šÎ¸â‚; c‘Óó´îçÉ: } public function listAll($Aè§íÄˆÙç) { $DÂ®Æ–‰ÓŒ =& $_SERVER[©äõ½¡]; $cÁ‹ÈÖÛ = $this->fileList($Aè§íÄˆÙç, $DÂ®Æ–‰ÓŒ[33], !0); $C×˜¾ÚÙªã = array(); foreach ($cÁ‹ÈÖÛ[$DÂ®Æ–‰ÓŒ[74]] as $F‡É§Éô) { $C×˜¾ÚÙªã[$F‡É§Éô[$DÂ®Æ–‰ÓŒ[93]]] = $F‡É§Éô[$DÂ®Æ–‰ÓŒ[78]]; } foreach ($cÁ‹ÈÖÛ[$DÂ®Æ–‰ÓŒ[75]] as $F‡É§Éô) { if (is_string($F‡É§Éô)) { $C×˜¾ÚÙªã[$F‡É§Éô] = 0; } } return $this->listAllFiles($Aè§íÄˆÙç, array_keys($C×˜¾ÚÙªã), $C×˜¾ÚÙªã); } private function fileList($CØ‰¼·Š¾›, $a«İ »õ» = '', $d‹êâ ²£Ó = 0) { goto D§ÌÒÑ›÷Ÿ; E‘èùÔ‰¶: return array($dÅÕó£ ¿Ñ[75] => $b…¶¢º„¨±, $dÅÕó£ ¿Ñ[74] => $AŒÉ¼ÔÑ¹); goto FĞ¿ŞŞ„”; D§ÌÒÑ›÷Ÿ: $dÅÕó£ ¿Ñ =& $_SERVER[©äõ½¡]; $CØ‰¼·Š¾› = trim($CØ‰¼·Š¾›, $dÅÕó£ ¿Ñ[8]); $B×Ÿ·Æí½ = empty($CØ‰¼·Š¾›) && $CØ‰¼·Š¾› !== $dÅÕó£ ¿Ñ[191] ? $dÅÕó£ ¿Ñ[33] : $CØ‰¼·Š¾› . $dÅÕó£ ¿Ñ[8]; goto a«ËíŠ–Íò; a«ËíŠ–Íò: $f§Ãß¯®ïµ = $dÅÕó£ ¿Ñ[33]; $FÜ‹ßˆ‡õ = 1000; $FÖ—„åŠÊ = $this->listItemCache === !1 ? !1 : !0; goto E™ñùËŠšÄ; E™ñùËŠšÄ: $b…¶¢º„¨± = $AŒÉ¼ÔÑ¹ = array(); while (!0) { check_abort(); list($E°ÒÖèÒ‚¼, $D¡¢ƒğˆè) = $this->bucketManager->listFiles($this->bucket, $B×Ÿ·Æí½, $f§Ãß¯®ïµ, $FÜ‹ßˆ‡õ, $a«İ »õ»); if ($D¡¢ƒğˆè) { break; } $f§Ãß¯®ïµ = array_key_exists($dÅÕó£ ¿Ñ[1307], $E°ÒÖèÒ‚¼) ? $f§Ãß¯®ïµ = $E°ÒÖèÒ‚¼[$dÅÕó£ ¿Ñ[1338]] : $dÅÕó£ ¿Ñ[33]; $EàÎ¥À‚ = isset($E°ÒÖèÒ‚¼[$dÅÕó£ ¿Ñ[1339]]) ? $E°ÒÖèÒ‚¼[$dÅÕó£ ¿Ñ[1339]] : array(); $câ‘…à¼Ô‡ = isset($E°ÒÖèÒ‚¼[$dÅÕó£ ¿Ñ[1340]]) ? $E°ÒÖèÒ‚¼[$dÅÕó£ ¿Ñ[1340]] : array(); foreach ($EàÎ¥À‚ as $A½Ã©½ùÁï) { goto CÈ³Œ×¯Ü»; CÈ³Œ×¯Ü»: if ($A½Ã©½ùÁï[$dÅÕó£ ¿Ñ[93]] == $B×Ÿ·Æí½) { continue; } $B¬ë…ÜœŠä = $A½Ã©½ùÁï[$dÅÕó£ ¿Ñ[93]]; $aÏÖ”·Éˆ = $A½Ã©½ùÁï[$dÅÕó£ ¿Ñ[1336]]; goto cîÓ–æßµÚ; cîÓ–æßµÚ: $A½Ã©½ùÁï[$dÅÕó£ ¿Ñ[78]] = $aÏÖ”·Éˆ; $AÆ¢Àê¤¯ = $aÏÖ”·Éˆ == 0 && substr($B¬ë…ÜœŠä, strlen($B¬ë…ÜœŠä) - 1, 1) == $dÅÕó£ ¿Ñ[8] ? !0 : !1; if ($FÖ—„åŠÊ) { $this->cacheMethod($dÅÕó£ ¿Ñ[199], $B¬ë…ÜœŠä, $AÆ¢Àê¤¯); $this->cacheMethod($dÅÕó£ ¿Ñ[200], $B¬ë…ÜœŠä, $A½Ã©½ùÁï); } goto A”²Ê„™«ğ; A”²Ê„™«ğ: if ($AÆ¢Àê¤¯) { $b…¶¢º„¨±[] = $B¬ë…ÜœŠä; continue; } $AŒÉ¼ÔÑ¹[] = $d‹êâ ²£Ó ? $A½Ã©½ùÁï : $B¬ë…ÜœŠä; goto EøğË„Ùæ; EøğË„Ùæ: } foreach ($câ‘…à¼Ô‡ as $B¬ë…ÜœŠä) { if ($B¬ë…ÜœŠä == $B×Ÿ·Æí½) { continue; } $b…¶¢º„¨±[] = $B¬ë…ÜœŠä; if ($FÖ—„åŠÊ) { $this->cacheMethod($dÅÕó£ ¿Ñ[199], $B¬ë…ÜœŠä, !0); } } if ($f§Ãß¯®ïµ === $dÅÕó£ ¿Ñ[33]) { break; } } if ($FÖ—„åŠÊ) { $this->cacheMethod($dÅÕó£ ¿Ñ[199], $CØ‰¼·Š¾›, !0); } goto E‘èùÔ‰¶; FĞ¿ŞŞ„”: } public function canRead($B‚²¿ªí†) { return $this->exist($B‚²¿ªí†) ? !0 : !1; } public function canWrite($BÙá‘¤Ö‚æ) { return $this->exist($BÙá‘¤Ö‚æ) ? !0 : !1; } public function getContent($eõæ¹†¢Ç·) { return $this->fileSubstr($eõæ¹†¢Ç·, 0, -1); } public function setContent($EÙøàø­¨›, $b‹ òçˆßæ = '') { $e‚ºá¯Ë¡ = $this->tempFile($this->pathThis($EÙøàø­¨›)); file_put_contents($e‚ºá¯Ë¡, $b‹ òçˆßæ); if ($this->upload($EÙøàø­¨›, $e‚ºá¯Ë¡)) { $this->tempFileRemve($e‚ºá¯Ë¡); return !0; } return !1; } public function refreshUrls($f³¥ñâˆ ) { goto E©¥ôµ¾½‡; f»Ì†éĞãì: return $aæˆ¾å£Œ[$dÅƒæëòº[1111]] == $dÅƒæëòº[755] ? !0 : !1; goto B‰£ÔƒÆö; eÓÔâÎÓ¶á: $B×Áâî˜Ú™ = new Qiniu\Cdn\CdnManager($this->auth); list($aæˆ¾å£Œ, $eê‰¾ë­„) = $B×Áâî˜Ú™->refreshUrls($BíºÑ¨äÀø); if ($eê‰¾ë­„) { return !1; } goto f»Ì†éĞãì; E©¥ôµ¾½‡: $dÅƒæëòº =& $_SERVER[©äõ½¡]; $BíºÑ¨äÀø = array(); if (is_array($f³¥ñâˆ )) { foreach ($f³¥ñâˆ  as $a°»ÁµèÆ™) { $BíºÑ¨äÀø[] = $this->link($a°»ÁµèÆ™); } } else { $BíºÑ¨äÀø[] = $this->link($f³¥ñâˆ ); } goto eÓÔâÎÓ¶á; B‰£ÔƒÆö: } public function fileSubstr($còÙà…¼, $f‰ë—×³ñõ, $cğĞÖÊ¾Î) { $D‡êÆ¥­® =& $_SERVER[©äõ½¡]; if (!($B´á™äÖÍò = $this->link($còÙà…¼))) { return !1; } $Cö®Ô¹‚Ñ = !1; if ($cğĞÖÊ¾Î > 0) { $fê˜ğ ´©¼ = $f‰ë—×³ñõ + $cğĞÖÊ¾Î - 1; $Cö®Ô¹‚Ñ = array($D‡êÆ¥­®[1341] . $f‰ë—×³ñõ . $D‡êÆ¥­®[454] . $fê˜ğ ´©¼); } $eŞŞ…Ûà“Ì = url_request($B´á™äÖÍò, $D‡êÆ¥­®[228], !1, $Cö®Ô¹‚Ñ); return $eŞŞ…Ûà“Ì[$D‡êÆ¥­®[745]] ? $eŞŞ…Ûà“Ì[$D‡êÆ¥­®[1121]] : !1; } public function upload($d˜Êİ±Ä£•, $c„Œ¿ÃĞá, $føøØ¿ßÎ¾ = false, $DÎ™ø„ÆÏ = REPEAT_REPLACE) { $a©ï¿øÈ±¡ = new Qiniu\Storage\UploadManager(); $d¶ê³í’ˆ¹ = $this->auth->uploadToken($this->bucket, $d˜Êİ±Ä£•); $Cˆ°ÇİÕ = get_file_mime(get_path_ext($c„Œ¿ÃĞá)); list($eÇ¬Š™ŠÙÒ, $c’åŠì˜ë˜) = $a©ï¿øÈ±¡->putFile($d¶ê³í’ˆ¹, $d˜Êİ±Ä£•, $c„Œ¿ÃĞá, null, $Cˆ°ÇİÕ); return $c’åŠì˜ë˜ ? !1 : $this->getPathOuter($d˜Êİ±Ä£•); } public function uploadFormData($cÀãéÈ×œ, $A†È¬ÄïÊß = 3600) { return $this->uploadToken($cÀãéÈ×œ, $A†È¬ÄïÊß); } public function multiUploadFormData($fİ›ƒÒÔ‹Ê, $F™ãê×ñ—ë = 3600) { return $this->uploadToken($fİ›ƒÒÔ‹Ê, $F™ãê×ñ—ë); } private function uploadToken($bË‚´¶’¨, $Fœº†×—³¿ = 3600) { goto Fº£ù®İñÏ; B‘İ„æÆ½: $B¸ŒÔÑö¯Ì = http_type() . "\x3a\57\x2f\x75\160\154\157\141\x64{$dÇİÉßáôÍ}\x2e\x71\151\156\x69\x75\160\x2e\x63\157\x6d\x2f"; return array($bÈÒ†ğ¶Ş‚[1345] => $bİ—¾·Œã, $bÈÒ†ğ¶Ş‚[1346] => $B¸ŒÔÑö¯Ì); goto e·›Å…âÂÓ; Fº£ù®İñÏ: $bÈÒ†ğ¶Ş‚ =& $_SERVER[©äõ½¡]; $dº¨ê›ÔÃ™ = $Fœº†×—³¿; $E„˜ÍÂ‰ñÌ = array($bÈÒ†ğ¶Ş‚[1342] => $bÈÒ†ğ¶Ş‚[1343]); goto eèÜÚ»º´¯; eèÜÚ»º´¯: $F¿Ğìóóê = $bË‚´¶’¨; $bİ—¾·Œã = $this->auth->uploadToken($this->bucket, $F¿Ğìóóê, $dº¨ê›ÔÃ™, $E„˜ÍÂ‰ñÌ, !0); $dÇİÉßáôÍ = empty($this->region) || $this->region == $bÈÒ†ğ¶Ş‚[1344] ? $bÈÒ†ğ¶Ş‚[33] : $bÈÒ†ğ¶Ş‚[454] . $this->region; goto B‘İ„æÆ½; e·›Å…âÂÓ: } public function download($EÃæÎ‹Œ…, $Cøˆ½—Ê¹Ğ) { goto c¤ÃÜ¥Úäš; c¤ÃÜ¥Úäš: $fÌâäš“šØ = IO::getPathInner(IO::mkfile($Cøˆ½—Ê¹Ğ)); if (!($Fğ «ÊÛÜØ = $this->link($EÃæÎ‹Œ…))) { return !1; } $cÏíøÕ¯Æ = 0; goto dù ñİ¤„Â; dù ñİ¤„Â: $D´ö’‹Ÿëí = 1024 * 200; $DÙ‹ôˆÂÒŸ = fopen($fÌâäš“šØ, $_SERVER[©äõ½¡][1347]); while (!0) { $AÑÌ‰Ø™Ûß = $this->fileSubstr($EÃæÎ‹Œ…, $cÏíøÕ¯Æ, $D´ö’‹Ÿëí); if ($AÑÌ‰Ø™Ûß === !1) { return !1; } fwrite($DÙ‹ôˆÂÒŸ, $AÑÌ‰Ø™Ûß); $cÏíøÕ¯Æ += $D´ö’‹Ÿëí; if (strlen($AÑÌ‰Ø™Ûß) < $D´ö’‹Ÿëí) { break; } } goto féä·íéÆĞ; féä·íéÆĞ: fclose($DÙ‹ôˆÂÒŸ); return $Cøˆ½—Ê¹Ğ; goto añ”‰†‚éì; añ”‰†‚éì: } public function link($eÑ›æè¥®, $eØ‚ö¹ƒøˆ = '') { if (!$this->isFile($eÑ›æè¥®)) { return !1; } $D¸Î»ì”Šå = $this->getHost() . $_SERVER[©äõ½¡][8] . $this->pathEncode($eÑ›æè¥®) . $eØ‚ö¹ƒøˆ; return $this->auth->privateDownloadUrl($D¸Î»ì”Šå, 3600 * 12); } public function fileOut($a‰İµİÑ¤, $F¦—ŒÂ¡‰ = false, $Fôó™–³„Ñ = false, $f‡•ÎÌ–Î¥ = '') { $bÕÓ†¥ø‘ =& $_SERVER[©äõ½¡]; if ($this->isFileOutServer()) { return $this->fileOutServer($a‰İµİÑ¤, $F¦—ŒÂ¡‰, $Fôó™–³„Ñ, $f‡•ÎÌ–Î¥); } if (!$Fôó™–³„Ñ) { $Fôó™–³„Ñ = $this->pathThis($a‰İµİÑ¤); } $bğ‚ôˆ¾‚ = $F¦—ŒÂ¡‰ ? $bÕÓ†¥ø‘[1348] . rawurlencode($Fôó™–³„Ñ) : $bÕÓ†¥ø‘[33]; $bÜ‰Æ»ëí = $this->link($a‰İµİÑ¤, $bğ‚ôˆ¾‚); $this->fileOutLink($bÜ‰Æ»ëí); } public function fileOutServer($añ²èé‚©, $E¡™ ‡åÉ‘ = false, $aŠÉø®  = false, $bïŒãÖ½§À = '') { parent::fileOut($añ²èé‚©, $E¡™ ‡åÉ‘, $aŠÉø® , $bïŒãÖ½§À); } public function fileOutImage($AŒä×‚™æ, $aŞå—õºÕ· = 250) { $E›ô¾‹¢Û“ = $this->link($AŒä×‚™æ, $_SERVER[©äõ½¡][1349] . $aŞå—õºÕ·); $this->fileOutLink($E›ô¾‹¢Û“); } public function fileOutImageServer($cßŠ»ÃÛ§ƒ, $aç«Ù‰ç»½ = 250) { parent::fileOutImage($cßŠ»ÃÛ§ƒ, $aç«Ù‰ç»½); } public function hashMd5($DÒÔÔ™½âó) { $c¯Èø¢ƒ¶ =& $_SERVER[©äõ½¡]; $dÙˆœ…ø¨ = $this->objectMeta($DÒÔÔ™½âó); return isset($dÙˆœ…ø¨[$c¯Èø¢ƒ¶[208]]) ? $dÙˆœ…ø¨[$c¯Èø¢ƒ¶[208]] : !1; $eèò™­É«¡ = $this->link($DÒÔÔ™½âó, $c¯Èø¢ƒ¶[1350]); } public function size($dà¡Û£§Ğ­) { $A™„¼â²šÅ = $this->objectMeta($dà¡Û£§Ğ­); return $A™„¼â²šÅ ? $A™„¼â²šÅ[$_SERVER[©äõ½¡][78]] : 0; } public function info($bª«„¼…ÏÜ) { if ($this->isFolder($bª«„¼…ÏÜ)) { return $this->folderInfo($bª«„¼…ÏÜ); } else { if ($this->isFile($bª«„¼…ÏÜ)) { return $this->fileInfo($bª«„¼…ÏÜ); } } return !1; } public function exist($Aé‘©ãÔ‰‘) { return $this->isFile($Aé‘©ãÔ‰‘) || $this->isFolder($Aé‘©ãÔ‰‘); } public function isFile($Dì¶ø“íã›) { return !$this->isFolder($Dì¶ø“íã›) && $this->objectMeta($Dì¶ø“íã›); } public function isFolder($f¾ÒÎìÊÉ¾) { return $this->cacheMethod($_SERVER[©äõ½¡][199], $f¾ÒÎìÊÉ¾); } protected function objectMeta($aÅÄ›ÆœŒÄ) { return $this->cacheMethod($_SERVER[©äõ½¡][200], $aÅÄ›ÆœŒÄ); } protected function _objectMeta($açŒÜ½â·) { $e˜‰ÏÚÏ›ó =& $_SERVER[©äõ½¡]; list($b½—Å™­, $d®“Ô‡˜‡) = $this->bucketManager->stat($this->bucket, $açŒÜ½â·); if ($b½—Å™­) { $b½—Å™­[$e˜‰ÏÚÏ›ó[78]] = intval($b½—Å™­[$e˜‰ÏÚÏ›ó[1336]]); } return $b½—Å™­; } protected function _isFolder($b„®Ë¼˜ÎÑ) { $B¾¨ß½Œ° =& $_SERVER[©äõ½¡]; if ($b„®Ë¼˜ÎÑ == $B¾¨ß½Œ°[33] || $b„®Ë¼˜ÎÑ == $B¾¨ß½Œ°[8]) { return !0; } list($BãÌ‰Ü¾’‰, $d¢Ğ„×ç•) = $this->bucketManager->listFiles($this->bucket, trim($b„®Ë¼˜ÎÑ, $B¾¨ß½Œ°[8]) . $B¾¨ß½Œ°[8], $B¾¨ß½Œ°[33], 1, $B¾¨ß½Œ°[8]); return !empty($BãÌ‰Ü¾’‰[$B¾¨ß½Œ°[1339]]) || !empty($BãÌ‰Ü¾’‰[$B¾¨ß½Œ°[1340]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($eÕÅ³èƒÏô) { parent::__construct($eÕÅ³èƒÏô); } public function uploadFormData($Bó¦£‰Éİ², $d ‚ĞÆÙ¦­ = 3600) { goto AÕŒÒÚ¯à»; E¸å”¯ßß: $dä²ˆÀ®Šˆ = hash_hmac($CÙèéƒÇàã[1267], $C‡é–àÏ¸“, $FÏÕ‰«Ëà³, !0); $cªÍä‰ã = hash_hmac($CÙèéƒÇàã[1267], $eƒàÏßÕîì, $dä²ˆÀ®Šˆ, !0); $Díæ–Š­õš = hash_hmac($CÙèéƒÇàã[1267], $C‹õĞ¢á–Ö, $cªÍä‰ã); goto Eê•õìÀ×; C¢œõ×‘Û‚: $cîÈÌÀë¶ = array($this->accessKey, $EÂòÑßå“‰, $this->region, $C‡é–àÏ¸“, $eƒàÏßÕîì); $E·îÄéøˆ§ = implode($CÙèéƒÇàã[8], $cîÈÌÀë¶); $C°²˜ÎëÍ = array($CÙèéƒÇàã[1224] => gmdate($CÙèéƒÇàã[1223], strtotime($CÙèéƒÇàã[1260])), $CÙèéƒÇàã[1225] => array(array($CÙèéƒÇàã[1227] => $this->bucket), array($CÙèéƒÇàã[1226] => $Cò©—«¸Ÿ„), array($CÙèéƒÇàã[1228], $CÙèéƒÇàã[1229], $CÙèéƒÇàã[33]), array($CÙèéƒÇàã[1228], $CÙèéƒÇàã[1261], $CÙèéƒÇàã[33]), array($CÙèéƒÇàã[1228], $CÙèéƒÇàã[1262], $CÙèéƒÇàã[33]), array($CÙèéƒÇàã[1230] => $E”¤ÛŞ’), array($CÙèéƒÇàã[1263] => $E·îÄéøˆ§), array($CÙèéƒÇàã[1264] => $EÎÉĞ¨”•), array($CÙèéƒÇàã[1265] => $E²¢ÁĞ“´¥), array($CÙèéƒÇàã[1266] => $EÏÆŸâ­Ó™))); goto F™ÇŠ‡³‰”; aêíç¨îîŠ: $eƒàÏßÕîì = $CÙèéƒÇàã[1259]; $EÏÆŸâ­Ó™ = $d ‚ĞÆÙ¦­ . $CÙèéƒÇàã[33]; $E”¤ÛŞ’ = $CÙèéƒÇàã[1222]; goto C¢œõ×‘Û‚; AÕŒÒÚ¯à»: $CÙèéƒÇàã =& $_SERVER[©äõ½¡]; $Cò©—«¸Ÿ„ = $CÙèéƒÇàã[192]; $EÎÉĞ¨”• = $CÙèéƒÇàã[1257]; goto fÜŠóã•ÉÓ; Eê•õìÀ×: $F¸ƒ ¨¶³Î = array($CÙèéƒÇàã[211] => $CÙèéƒÇàã[33], $CÙèéƒÇàã[1269] => $CÙèéƒÇàã[33], $CÙèéƒÇàã[1226] => $Cò©—«¸Ÿ„, $CÙèéƒÇàã[1230] => $E”¤ÛŞ’, $CÙèéƒÇàã[1234] => $C‹õĞ¢á–Ö, $CÙèéƒÇàã[1270] => $E·îÄéøˆ§, $CÙèéƒÇàã[1271] => $EÎÉĞ¨”•, $CÙèéƒÇàã[1272] => $E²¢ÁĞ“´¥, $CÙèéƒÇàã[1273] => $EÏÆŸâ­Ó™, $CÙèéƒÇàã[1274] => $Díæ–Š­õš, $CÙèéƒÇàã[175] => $this->getHost()); return $F¸ƒ ¨¶³Î; goto f•¥İ•ö¿¼; F™ÇŠ‡³‰”: $C‹õĞ¢á–Ö = base64_encode(json_encode($C°²˜ÎëÍ)); $DŸ”Ï–¯“ = hash_hmac($CÙèéƒÇàã[1267], $EÂòÑßå“‰, $CÙèéƒÇàã[1268] . $this->secret, !0); $FÏÕ‰«Ëà³ = hash_hmac($CÙèéƒÇàã[1267], $this->region, $DŸ”Ï–¯“, !0); goto E¸å”¯ßß; fÜŠóã•ÉÓ: $C‡é–àÏ¸“ = $CÙèéƒÇàã[59]; $E²¢ÁĞ“´¥ = gmdate($CÙèéƒÇàã[1258]); $EÂòÑßå“‰ = gmdate($CÙèéƒÇàã[746]); goto aêíç¨îîŠ; f•¥İ•ö¿¼: } public function multiUploadFormData($d‹Ä¹¯öÇ®, $bæ×šÔƒ¡ = 3600) { $Fàù¤µÕÜ =& $_SERVER[©äõ½¡]; $AÍ·âñåâò = gmdate($Fàù¤µÕÜ[1351]); $D³İš°Éğà = array(); $B„ÁÓò¬Ã¦ = $this->client->getUploadId($this->bucket, $d‹Ä¹¯öÇ®, $D³İš°Éğà); if (!$B„ÁÓò¬Ã¦) { return !1; } return array($Fàù¤µÕÜ[221] => $B„ÁÓò¬Ã¦, $Fàù¤µÕÜ[175] => $this->getHost() . $Fàù¤µÕÜ[8] . $this->pathEncode($d‹Ä¹¯öÇ®), $Fàù¤µÕÜ[222] => $AÍ·âñåâò, $Fàù¤µÕÜ[93] => $d‹Ä¹¯öÇ®); } public function multiUploadAuthData($F°–ÆÊ•Ö, $A¤ÛèË‹Õõ = array()) { goto CìáŠœé¬‰; E®â¤èÜÊï: if (strpos($B‘¾ÏìŒšà, $Eäö—­£–ä[225]) === 0) { if (isset($a‘À‡œó¨[$Eäö—­£–ä[1353]])) { $bõÊº‘Ü¯õ = $a‘À‡œó¨[$Eäö—­£–ä[1353]]; } else { if (isset($e¶½Æ×ÌšŒ[$Eäö—­£–ä[1353]])) { $bõÊº‘Ü¯õ = $e¶½Æ×ÌšŒ[$Eäö—­£–ä[1353]]; } else { $bõÊº‘Ü¯õ = hash($Eäö—­£–ä[1267], $Eäö—­£–ä[33]); } } return array($Eäö—­£–ä[232] => $e¶½Æ×ÌšŒ[$Eäö—­£–ä[232]], $Eäö—­£–ä[1353] => $bõÊº‘Ü¯õ, $Eäö—­£–ä[222] => $e¶½Æ×ÌšŒ[$Eäö—­£–ä[1356]]); } return $e¶½Æ×ÌšŒ[$Eäö—­£–ä[232]]; goto b†Ôø¢¹õ; D”“ÊµùŠ¼: $eòÈ…†«â½ = $Eäö—­£–ä[226]; $D¯ÌÑÒÆõÛ = $Eäö—­£–ä[8] . $this->pathEncode($A —‘·Ó²) . $B‘¾ÏìŒšà; $e¶½Æ×ÌšŒ = $this->client->__getSignatureV4($a‘À‡œó¨, $Bµàà·Ÿî, $eòÈ…†«â½, $D¯ÌÑÒÆõÛ); goto E®â¤èÜÊï; CìáŠœé¬‰: $Eäö—­£–ä =& $_SERVER[©äõ½¡]; $B‘¾ÏìŒšà = isset($A¤ÛèË‹Õõ[$Eäö—­£–ä[168]]) ? $A¤ÛèË‹Õõ[$Eäö—­£–ä[168]] : $Eäö—­£–ä[33]; $A —‘·Ó² = $A¤ÛèË‹Õõ[$Eäö—­£–ä[93]]; goto eîÜñÖô¹ï; BÏÌƒÕìÈ‡: if (isset($A¤ÛèË‹Õõ[$Eäö—­£–ä[1352]])) { $a‘À‡œó¨[$Eäö—­£–ä[1353]] = $A¤ÛèË‹Õõ[$Eäö—­£–ä[1352]]; } $aÑ×½ã¡ñ‚ = explode($Eäö—­£–ä[177], $this->getHost()); $Bµàà·Ÿî = array($Eäö—­£–ä[1354] => $aÑ×½ã¡ñ‚[1], $Eäö—­£–ä[1355] => $Eäö—­£–ä[33], $Eäö—­£–ä[211] => $Eäö—­£–ä[119], $Eäö—­£–ä[1269] => $A¤ÛèË‹Õõ[$Eäö—­£–ä[78]]); goto D”“ÊµùŠ¼; eîÜñÖô¹ï: unset($A¤ÛèË‹Õõ[$Eäö—­£–ä[93]]); if (isset($A¤ÛèË‹Õõ[$Eäö—­£–ä[223]])) { return $this->listUploadParts($A —‘·Ó², $A¤ÛèË‹Õõ); } $a‘À‡œó¨ = array(); goto BÏÌƒÕìÈ‡; b†Ôø¢¹õ: } public function listUploadParts($B«İŞ¯Ô, $a¿ĞÁª…æŒ = array()) { goto cÎ©¨—éÓ±; d¶•¸Œæ©Ÿ: if (!$cÆ±Øõ) { return !1; } $cŞ·âÒœÃ­ = $BĞŞË§Œ¬à[1357]; foreach ($cÆ±Øõ as $AËœæ¬Œä„) { $cŞ·âÒœÃ­ .= $BĞŞË§Œ¬à[1358] . "\74\x50\141\162\164\x4e\165\x6d\x62\x65\x72\76{$AËœæ¬Œä„[$BĞŞË§Œ¬à[1314]]}\x3c\57\x50\141\162\x74\x4e\x75\x6d\142\x65\x72\x3e\xa" . "\x3c\x45\124\141\147\x3e{$AËœæ¬Œä„[$BĞŞË§Œ¬à[1315]]}\74\x2f\105\x54\x61\147\76\12" . $BĞŞË§Œ¬à[1359]; } goto a§”Ú²¦¬; B¹·¡Ù»“—: $EİŠä ×Ì¥ = $this->client->__getSignatureV4($FÈ÷Ùè éñ, $B­ìô—­İœ, $aÆÎçò×‹, $CÉÁÓâÂˆ‚, $cŞ·âÒœÃ­); return array($BĞŞË§Œ¬à[232] => $EİŠä ×Ì¥[$BĞŞË§Œ¬à[232]], $BĞŞË§Œ¬à[222] => $EİŠä ×Ì¥[$BĞŞË§Œ¬à[1356]], $BĞŞË§Œ¬à[234] => $cÆ±Øõ, $BĞŞË§Œ¬à[1353] => $EİŠä ×Ì¥[$BĞŞË§Œ¬à[1353]]); goto EÂÓä‰¸†; cÎ©¨—éÓ±: $BĞŞË§Œ¬à =& $_SERVER[©äõ½¡]; $cÈéò£‘„« = str_replace($BĞŞË§Œ¬à[233], $BĞŞË§Œ¬à[33], $a¿ĞÁª…æŒ[$BĞŞË§Œ¬à[168]]); $cÆ±Øõ = $this->client->listParts($this->bucket, $B«İŞ¯Ô, $cÈéò£‘„«); goto d¶•¸Œæ©Ÿ; a§”Ú²¦¬: $cŞ·âÒœÃ­ .= $BĞŞË§Œ¬à[1360]; $FÈ÷Ùè éñ = array(); $aÔ¸ØÎÑ»à = explode($BĞŞË§Œ¬à[177], $this->getHost()); goto BŸšêñ¦; BŸšêñ¦: $B­ìô—­İœ = array($BĞŞË§Œ¬à[1354] => $aÔ¸ØÎÑ»à[1], $BĞŞË§Œ¬à[211] => $BĞŞË§Œ¬à[119], $BĞŞË§Œ¬à[1269] => strlen($cŞ·âÒœÃ­)); $aÆÎçò×‹ = $BĞŞË§Œ¬à[224]; $CÉÁÓâÂˆ‚ = $BĞŞË§Œ¬à[8] . $this->pathEncode($B«İŞ¯Ô) . $a¿ĞÁª…æŒ[$BĞŞË§Œ¬à[168]]; goto B¹·¡Ù»“—; EÂÓä‰¸†: } public function link($fšÊ ÆˆŸó, $a£•¿§ÜÏ = array()) { return parent::link($fšÊ ÆˆŸó, $a£•¿§ÜÏ); } public function fileOut($F‘àš»ŸÃ¸, $eÔÊ¨ä¨´‚ = false, $cïè‘¾ÊÙ = false, $Bö‘ÈÎÍß = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[©äõ½¡][1361])) { return parent::fileOutServer($F‘àš»ŸÃ¸, $eÔÊ¨ä¨´‚, $cïè‘¾ÊÙ, $Bö‘ÈÎÍß); } parent::fileOut($F‘àš»ŸÃ¸, $eÔÊ¨ä¨´‚, $cïè‘¾ÊÙ, $Bö‘ÈÎÍß); } public function fileOutImage($aÔ·™ÆÕº·, $a´¬ùì–¾Ç = 250) { if (strstr($this->endpoint, $_SERVER[©äõ½¡][1361])) { return parent::fileOutImageServer($aÔ·™ÆÕº·, $a´¬ùì–¾Ç); } parent::fileOutImage($aÔ·™ÆÕº·, $a´¬ùì–¾Ç); } public function fileOutLink($aÁöÇÍ—¥Û) { $A…ğÕ¤£‘Ê =& $_SERVER[©äõ½¡]; if (substr($aÁöÇÍ—¥Û, 0, 7) == $A…ğÕ¤£‘Ê[1237]) { $aÁöÇÍ—¥Û = $A…ğÕ¤£‘Ê[1238] . substr($aÁöÇÍ—¥Û, 7); } header($A…ğÕ¤£‘Ê[159] . $aÁöÇÍ—¥Û); die; } public function getHost() { $F‡…¶å =& $_SERVER[©äõ½¡]; $fßãÌ›ì = str_rtrim(parent::getHost(), $F‡…¶å[8] . $this->bucket); $fßãÌ›ì = explode($F‡…¶å[177], $fßãÌ›ì); return $fßãÌ›ì[0] . $F‡…¶å[177] . $this->bucket . $F‡…¶å[95] . $fßãÌ›ì[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($FœšÒŒ’É, $d¢ÁÉ = 0) { parent::__construct(); $this->source = $FœšÒŒ’É; $this->sourceSize = $d¢ÁÉ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($aùÑ¾êò‹§ = false) { return $this->sourceSize; } public function getContent($EÁ£œ‰© = false) { return $this->fileSubstr($EÁ£œ‰©, 0, $this->sourceSize); } public function fileSubstr($BŸî³ÁÄ• = false, $F¿—È’êã¿ = 0, $fˆÕåù … = 0) { if (!$fˆÕåù …) { $fˆÕåù … = $this->sourceSize; } $DÊ½İÕôÊø = $this->sourceSize - $F¿—È’êã¿; if ($fˆÕåù … >= $DÊ½İÕôÊø) { $fˆÕåù … = $DÊ½İÕôÊø; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $F¿—È’êã¿, $fˆÕåù …); } if ($this->sourceType == self::TYPE_FILE) { if ($fˆÕåù … <= 0) { return $_SERVER[©äõ½¡][33]; } $böÇ†Ã¨ = ftell($this->source); fseek_64($this->source, $böÇ†Ã¨ + $F¿—È’êã¿); $CùÚÕƒˆŞ÷ = @fread($this->source, $fˆÕåù …); fseek_64($this->source, $böÇ†Ã¨); return $CùÚÕƒˆŞ÷; } } public function hashMd5($a‰ôÀºÅ = false) { return md5($this->getContent()); } public static function hash($a¥¤™˜ãùÂ, $b½šÇôì¬ = 0) { $c¶ŞªÊ¶­ = new PathDriverStream($a¥¤™˜ãùÂ, $b½šÇôì¬); return $c¶ŞªÊ¶­->hashSimple($a¥¤™˜ãùÂ); } public static function md5($bÒÉ–ß†ÈÓ, $AèÑö°Šëˆ = 0) { $d¹áòîİ½× = new PathDriverStream($bÒÉ–ß†ÈÓ, $AèÑö°Šëˆ); return $d¹áòîİ½×->hashMd5($bÒÉ–ß†ÈÓ); } } goto e¿…¥ Å; A·†ÜòÕ±ô: class DbMysql extends Db { public function __construct($bÂâêµ‘íÑ = '') { $e„²…ø¼ô³ =& $_SERVER[©äõ½¡]; if (!extension_loaded($e„²…ø¼ô³[796])) { think_exception(think_lang($e„²…ø¼ô³[10]) . $e„²…ø¼ô³[880]); } if (!empty($bÂâêµ‘íÑ)) { $this->config = $bÂâêµ‘íÑ; if (empty($this->config[$e„²…ø¼ô³[13]])) { $this->config[$e„²…ø¼ô³[13]] = $e„²…ø¼ô³[33]; } } } public function connect($cò¥Øó„¸‡ = '', $b›¦ôÖŠ = 0, $b™ÇÒ± ¶Å = false) { $B¶Å³Á¬ =& $_SERVER[©äõ½¡]; if (!isset($this->linkID[$b›¦ôÖŠ])) { goto d£Ò¬‘½Ø¾; d£Ò¬‘½Ø¾: if (empty($cò¥Øó„¸‡)) { $cò¥Øó„¸‡ = $this->config; } $FÃ†‘Ù–‹ = $cò¥Øó„¸‡[$B¶Å³Á¬[881]] . ($cò¥Øó„¸‡[$B¶Å³Á¬[882]] ? "\x3a{$cò¥Øó„¸‡[$B¶Å³Á¬[882]]}" : $B¶Å³Á¬[33]); $dÌğ…äšŠ¤ = !empty($cò¥Øó„¸‡[$B¶Å³Á¬[13]][$B¶Å³Á¬[14]]) ? $cò¥Øó„¸‡[$B¶Å³Á¬[13]][$B¶Å³Á¬[14]] : $this->pconnect; goto F•‚–´ùµª; E®„´ÌøÅµ: mysql_query($B¶Å³Á¬[885] . think_config($B¶Å³Á¬[886]) . $B¶Å³Á¬[55], $this->linkID[$b›¦ôÖŠ]); if ($C•®–õ¤ªù > $B¶Å³Á¬[887]) { mysql_query($B¶Å³Á¬[888], $this->linkID[$b›¦ôÖŠ]); } $this->connected = !0; goto e„ô£…¶ï—; e„ô£…¶ï—: if (1 != think_config($B¶Å³Á¬[18])) { unset($this->config); } goto e¬×îÒ½×‹; F•‚–´ùµª: if ($dÌğ…äšŠ¤) { $this->linkID[$b›¦ôÖŠ] = mysql_pconnect($FÃ†‘Ù–‹, $cò¥Øó„¸‡[$B¶Å³Á¬[883]], $cò¥Øó„¸‡[$B¶Å³Á¬[884]], 131072); } else { $this->linkID[$b›¦ôÖŠ] = mysql_connect($FÃ†‘Ù–‹, $cò¥Øó„¸‡[$B¶Å³Á¬[883]], $cò¥Øó„¸‡[$B¶Å³Á¬[884]], !0, 131072); } if (!$this->linkID[$b›¦ôÖŠ] || !empty($cò¥Øó„¸‡[$B¶Å³Á¬[17]]) && !mysql_select_db($cò¥Øó„¸‡[$B¶Å³Á¬[17]], $this->linkID[$b›¦ôÖŠ])) { think_exception(mysql_error()); } $C•®–õ¤ªù = mysql_get_server_info($this->linkID[$b›¦ôÖŠ]); goto E®„´ÌøÅµ; e¬×îÒ½×‹: } return $this->linkID[$b›¦ôÖŠ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($E¼«½ÑÖğ¦) { goto eì‘­ßÁ‰; e§åŒ•‘Ãå: if (!$this->_linkID) { return !1; } $this->queryStr = $E¼«½ÑÖğ¦; if ($this->queryID) { $this->free(); } goto CÏÑˆ¸†°; eì‘­ßÁ‰: $A’ÅŠ‘°• =& $_SERVER[©äõ½¡]; if (0 === stripos($E¼«½ÑÖğ¦, $A’ÅŠ‘°•[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto e§åŒ•‘Ãå; CÏÑˆ¸†°: think_action_status($A’ÅŠ‘°•[19], 1); think_status($A’ÅŠ‘°•[20]); $this->queryID = mysql_query($E¼«½ÑÖğ¦, $this->_linkID); goto AŞ™ÁÂÒ¦¢; AŞ™ÁÂÒ¦¢: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto B°ğä±˜¢ñ; B°ğä±˜¢ñ: } public function execute($Aš¦çõœç) { goto DÂÑÔ‡ù¥; DÂÑÔ‡ù¥: $E“ªö…á‹  =& $_SERVER[©äõ½¡]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cÏš’·ºÇ‡; cÏš’·ºÇ‡: $this->queryStr = $Aš¦çõœç; if ($this->queryID) { $this->free(); } think_action_status($E“ªö…á‹ [21], 1); goto b¬Æçö†Ö; b¬Æçö†Ö: think_status($E“ªö…á‹ [20]); $céÕİæê‚› = mysql_query($Aš¦çõœç, $this->_linkID); $this->debug(); goto b™ù±õÕ‚·; b™ù±õÕ‚·: if (!1 === $céÕİæê‚›) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto d©¥”¤ñ­ö; d©¥”¤ñ­ö: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[©äõ½¡][889], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $DÄÉÀÛë°ò = mysql_query($_SERVER[©äõ½¡][890], $this->_linkID); $this->transTimes = 0; if (!$DÄÉÀÛë°ò) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $E‰£•¹Ùƒ’ = mysql_query($_SERVER[©äõ½¡][891], $this->_linkID); $this->transTimes = 0; if (!$E‰£•¹Ùƒ’) { $this->error(); return !1; } } return !0; } private function getAll() { $B¡Úï‡ÍÅ = array(); if ($this->numRows > 0) { while ($Aš‚ï ¼÷ß = mysql_fetch_assoc($this->queryID)) { $B¡Úï‡ÍÅ[] = $Aš‚ï ¼÷ß; } mysql_data_seek($this->queryID, 0); } return $B¡Úï‡ÍÅ; } public function getFields($eñÛÖÏÀ) { $A²¹ø¡–ˆÎ =& $_SERVER[©äõ½¡]; $f¶…¾ô¦İ = $this->query($A²¹ø¡–ˆÎ[892] . $this->parseKey($eñÛÖÏÀ)); $A…œ’°ÅÈ¯ = array(); if ($f¶…¾ô¦İ) { foreach ($f¶…¾ô¦İ as $F“ÌÙè¬­Ş => $c‡ù—§Ó¶·) { $A…œ’°ÅÈ¯[$c‡ù—§Ó¶·[$A²¹ø¡–ˆÎ[27]]] = array($A²¹ø¡–ˆÎ[28] => $c‡ù—§Ó¶·[$A²¹ø¡–ˆÎ[27]], $A²¹ø¡–ˆÎ[29] => $c‡ù—§Ó¶·[$A²¹ø¡–ˆÎ[30]], $A²¹ø¡–ˆÎ[31] => (bool) (strtoupper($c‡ù—§Ó¶·[$A²¹ø¡–ˆÎ[32]]) === $A²¹ø¡–ˆÎ[893]), $A²¹ø¡–ˆÎ[34] => $c‡ù—§Ó¶·[$A²¹ø¡–ˆÎ[35]], $A²¹ø¡–ˆÎ[36] => strtolower($c‡ù—§Ó¶·[$A²¹ø¡–ˆÎ[37]]) == $A²¹ø¡–ˆÎ[38], $A²¹ø¡–ˆÎ[39] => strtolower($c‡ù—§Ó¶·[$A²¹ø¡–ˆÎ[40]]) == $A²¹ø¡–ˆÎ[41]); } } return $A…œ’°ÅÈ¯; } public function getTables($EĞØëâ©´´ = '') { $aî†²É†˜Û =& $_SERVER[©äõ½¡]; if (!empty($EĞØëâ©´´)) { $BŞé‚ÒêÙ = $aî†²É†˜Û[894] . $EĞØëâ©´´ . $aî†²É†˜Û[895]; } else { $BŞé‚ÒêÙ = $aî†²É†˜Û[896]; } $Eò¬×…¦ƒ = $this->query($BŞé‚ÒêÙ); $b‘æ‘Ñî…Å = array(); foreach ($Eò¬×…¦ƒ as $fŸøºó‘Ğ => $B·ªß¼¦¨¢) { $b‘æ‘Ñî…Å[$fŸøºó‘Ğ] = current($B·ªß¼¦¨¢); } return $b‘æ‘Ñî…Å; } public function replace($CŠæù—£Ãœ, $bŸˆäèšñŒ = array()) { $Dêó®ëğø =& $_SERVER[©äõ½¡]; foreach ($CŠæù—£Ãœ as $eìàÚâÛİ => $f…ğÜ™«›°) { $AÆÄÇ¨ç— = $this->parseValue($f…ğÜ™«›°); if (is_scalar($AÆÄÇ¨ç—)) { $D˜¬ÔŒ¥½À[] = $AÆÄÇ¨ç—; $BŒ„·æ¢ÉÑ[] = $this->parseKey($eìàÚâÛİ); } } $F©‰ ¯©Ü = $Dêó®ëğø[897] . $this->parseTable($bŸˆäèšñŒ[$Dêó®ëğø[277]]) . $Dêó®ëğø[898] . implode($Dêó®ëğø[47], $BŒ„·æ¢ÉÑ) . $Dêó®ëğø[899] . implode($Dêó®ëğø[47], $D˜¬ÔŒ¥½À) . $Dêó®ëğø[900]; return $this->execute($F©‰ ¯©Ü); } public function insertAll($A‘“Öæğ¢Ê, $dñ¤ËÙÂ¢ = array(), $dÌ©Ší„Îö = false) { goto BÛÚ¢ÇÛˆ; cÇ”åÓœ˜™: $BŸÒ¹…İòµ = ($dÌ©Ší„Îö ? $D£í½ÏÑ¾å[902] : $D£í½ÏÑ¾å[903]) . $D£í½ÏÑ¾å[904] . $this->parseTable($dñ¤ËÙÂ¢[$D£í½ÏÑ¾å[277]]) . $D£í½ÏÑ¾å[898] . implode($D£í½ÏÑ¾å[47], $e³½ç¥âß‰) . $D£í½ÏÑ¾å[905] . implode($D£í½ÏÑ¾å[47], $a¡ƒµãä©Â); return $this->execute($BŸÒ¹…İòµ); goto A–ôÆ»Ö‡; c« ¤ƒ†¤È: $a¡ƒµãä©Â = array(); foreach ($A‘“Öæğ¢Ê as $DÃ‹£‘µ¾‰) { $d‚Áö¢¨­÷ = array(); foreach ($DÃ‹£‘µ¾‰ as $CèŠ©İÛÈ™ => $Eì·’Ù¶ÃÕ) { $Eì·’Ù¶ÃÕ = $this->parseValue($Eì·’Ù¶ÃÕ); if (is_scalar($Eì·’Ù¶ÃÕ)) { $d‚Áö¢¨­÷[] = $Eì·’Ù¶ÃÕ; } } $a¡ƒµãä©Â[] = $D£í½ÏÑ¾å[258] . implode($D£í½ÏÑ¾å[47], $d‚Áö¢¨­÷) . $D£í½ÏÑ¾å[900]; } array_walk($e³½ç¥âß‰, array($this, $D£í½ÏÑ¾å[901])); goto cÇ”åÓœ˜™; BÛÚ¢ÇÛˆ: $D£í½ÏÑ¾å =& $_SERVER[©äõ½¡]; if (!is_array($A‘“Öæğ¢Ê[0])) { return !1; } $e³½ç¥âß‰ = array_keys($A‘“Öæğ¢Ê[0]); goto c« ¤ƒ†¤È; A–ôÆ»Ö‡: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $d‹ˆ×ß¶ÇÚ =& $_SERVER[©äõ½¡]; $this->error = mysql_errno() . $d‹ˆ×ß¶ÇÚ[4] . mysql_error($this->_linkID); if ($d‹ˆ×ß¶ÇÚ[33] != $this->queryStr) { $this->error .= LNG($d‹ˆ×ß¶ÇÚ[45]) . $this->queryStr; } think_trace($this->error, $d‹ˆ×ß¶ÇÚ[33], $d‹ˆ×ß¶ÇÚ[46]); return $this->error; } public function escapeString($CÄ³ªãÈÛ°) { if ($this->_linkID) { return mysql_real_escape_string($CÄ³ªãÈÛ°, $this->_linkID); } else { return mysql_escape_string($CÄ³ªãÈÛ°); } } public function parseKey(&$AÉºİ¤ˆ, $CšŸ†‘¼¹´ = true) { $dåâÈ =& $_SERVER[©äõ½¡]; if ($CšŸ†‘¼¹´) { $AÉºİ¤ˆ = $this->parseKeyCheck($AÉºİ¤ˆ); } if ($AÉºİ¤ˆ != $dåâÈ[182] && !preg_match($dåâÈ[906], $AÉºİ¤ˆ)) { $AÉºİ¤ˆ = $dåâÈ[383] . trim($AÉºİ¤ˆ, $dåâÈ[383]) . $dåâÈ[383]; } return $AÉºİ¤ˆ; } } class DbMysqli extends Db { public function __construct($d‡¡×šÍ¼· = '') { $c›˜æ¥ÇšŠ =& $_SERVER[©äõ½¡]; if (!extension_loaded($c›˜æ¥ÇšŠ[795])) { think_exception(think_lang($c›˜æ¥ÇšŠ[10]) . $c›˜æ¥ÇšŠ[907]); } if (!empty($d‡¡×šÍ¼·)) { $this->config = $d‡¡×šÍ¼·; if (empty($this->config[$c›˜æ¥ÇšŠ[13]])) { $this->config[$c›˜æ¥ÇšŠ[13]] = $c›˜æ¥ÇšŠ[33]; } } } public function connect($aù¹ÉÙóí„ = '', $dÁ‘®Ô·àÌ = 0) { $f²•¡¿‘Ää =& $_SERVER[©äõ½¡]; if (!isset($this->linkID[$dÁ‘®Ô·àÌ])) { goto aã´èœººÚ; aã´èœººÚ: if (empty($aù¹ÉÙóí„)) { $aù¹ÉÙóí„ = $this->config; } $this->linkID[$dÁ‘®Ô·àÌ] = new mysqli($aù¹ÉÙóí„[$f²•¡¿‘Ää[881]], $aù¹ÉÙóí„[$f²•¡¿‘Ää[883]], $aù¹ÉÙóí„[$f²•¡¿‘Ää[884]], $aù¹ÉÙóí„[$f²•¡¿‘Ää[17]], $aù¹ÉÙóí„[$f²•¡¿‘Ää[882]] ? intval($aù¹ÉÙóí„[$f²•¡¿‘Ää[882]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto E‡ëâ³èï¨; dç£´øù»š: $this->connected = !0; if (1 != think_config($f²•¡¿‘Ää[18])) { unset($this->config); } goto A°İ¦É‘¥Ò; E‡ëâ³èï¨: $b§ƒÉùøí™ = $this->linkID[$dÁ‘®Ô·àÌ]->server_version; $this->linkID[$dÁ‘®Ô·àÌ]->query($f²•¡¿‘Ää[885] . think_config($f²•¡¿‘Ää[886]) . $f²•¡¿‘Ää[55]); if ($b§ƒÉùøí™ > $f²•¡¿‘Ää[887]) { $this->linkID[$dÁ‘®Ô·àÌ]->query($f²•¡¿‘Ää[888]); } goto dç£´øù»š; A°İ¦É‘¥Ò: } return $this->linkID[$dÁ‘®Ô·àÌ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($E’ÂË¹¼¡Ò) { goto dòœÉñİõà; Dšø‡½†±™: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto AÍä„¥¼²; CÀÀŠÒÏã: think_status($Dæø‘Ø¸Ê[20]); $this->queryID = $this->_linkID->query($E’ÂË¹¼¡Ò); if ($this->_linkID->more_results()) { while (($c˜˜ĞõÇ‰ë = $this->_linkID->next_result()) != NULL) { $c˜˜ĞõÇ‰ë->free_result(); } } goto Dšø‡½†±™; dòœÉñİõà: $Dæø‘Ø¸Ê =& $_SERVER[©äõ½¡]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto b¦Š‡£¢Û; b¦Š‡£¢Û: $this->queryStr = $E’ÂË¹¼¡Ò; if ($this->queryID) { $this->free(); } think_action_status($Dæø‘Ø¸Ê[19], 1); goto CÀÀŠÒÏã; AÍä„¥¼²: } public function execute($BÈªŠğ‰å) { goto D´‹‚³â†„; D´‹‚³â†„: $Eµ›ÊŸ³å» =& $_SERVER[©äõ½¡]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto dÆÒ¹Åš; dƒ¿ˆ˜àÎ: think_status($Eµ›ÊŸ³å»[20]); $BöôíÄ”¦ = $this->_linkID->query($BÈªŠğ‰å); $this->debug(); goto A™¯ÆÀ œ·; dÆÒ¹Åš: $this->queryStr = $BÈªŠğ‰å; if ($this->queryID) { $this->free(); } think_action_status($Eµ›ÊŸ³å»[21], 1); goto dƒ¿ˆ˜àÎ; A™¯ÆÀ œ·: if (!1 === $BöôíÄ”¦) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto dàÎ¾µàÀ™; dàÎ¾µàÀ™: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $e³Ï¼ ¡éã = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$e³Ï¼ ¡éã) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $cññ° ìÄÉ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$cññ° ìÄÉ) { $this->error(); return !1; } } return !0; } private function getAll() { $B›ˆÜÁáß = array(); if ($this->numRows > 0) { for ($e×˜²†¡­ = 0; $e×˜²†¡­ < $this->numRows; $e×˜²†¡­++) { $B›ˆÜÁáß[$e×˜²†¡­] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $B›ˆÜÁáß; } public function getFields($A‹ŞÒ) { $CÛçò«¢„Ô =& $_SERVER[©äõ½¡]; $D÷Ïˆ‹ì…Í = $this->query($CÛçò«¢„Ô[892] . $this->parseKey($A‹ŞÒ)); $Ešœ´µ¶ŞÓ = array(); if ($D÷Ïˆ‹ì…Í) { foreach ($D÷Ïˆ‹ì…Í as $a¶Ò«‚Øªß => $A±œ¾ÍíŞ³) { $Ešœ´µ¶ŞÓ[$A±œ¾ÍíŞ³[$CÛçò«¢„Ô[27]]] = array($CÛçò«¢„Ô[28] => $A±œ¾ÍíŞ³[$CÛçò«¢„Ô[27]], $CÛçò«¢„Ô[29] => $A±œ¾ÍíŞ³[$CÛçò«¢„Ô[30]], $CÛçò«¢„Ô[31] => (bool) ($A±œ¾ÍíŞ³[$CÛçò«¢„Ô[32]] === $CÛçò«¢„Ô[33]), $CÛçò«¢„Ô[34] => $A±œ¾ÍíŞ³[$CÛçò«¢„Ô[35]], $CÛçò«¢„Ô[36] => strtolower($A±œ¾ÍíŞ³[$CÛçò«¢„Ô[37]]) == $CÛçò«¢„Ô[38], $CÛçò«¢„Ô[39] => strtolower($A±œ¾ÍíŞ³[$CÛçò«¢„Ô[40]]) == $CÛçò«¢„Ô[41]); } } return $Ešœ´µ¶ŞÓ; } public function getTables($D×¤•ò²œ = '') { $E‰ƒÜ÷ƒÁ =& $_SERVER[©äõ½¡]; $eØ®ÕŒÃé = !empty($D×¤•ò²œ) ? $E‰ƒÜ÷ƒÁ[894] . $D×¤•ò²œ . $E‰ƒÜ÷ƒÁ[895] : $E‰ƒÜ÷ƒÁ[896]; $c¯Ù¹¸æ¡½ = $this->query($eØ®ÕŒÃé); $B¾ÃÎ¢˜±À = array(); if ($c¯Ù¹¸æ¡½) { foreach ($c¯Ù¹¸æ¡½ as $e…†å–ù‰ => $BÑÉÍŠ¶çÃ) { $B¾ÃÎ¢˜±À[$e…†å–ù‰] = current($BÑÉÍŠ¶çÃ); } } return $B¾ÃÎ¢˜±À; } public function replace($E·íé‘Õ·, $Fš¼”×‹« = array()) { $a…Ï„Ÿä†ó =& $_SERVER[©äõ½¡]; foreach ($E·íé‘Õ· as $DÜ»™Õ‰Ï => $cò½õòñ÷) { $e‡ôœ¥Ìá© = $this->parseValue($cò½õòñ÷); if (is_scalar($e‡ôœ¥Ìá©)) { $F½ÑÕ‡ğ¸Ó[] = $e‡ôœ¥Ìá©; $fŠäÈáŞ¤ë[] = $this->parseKey($DÜ»™Õ‰Ï); } } $b“ŒôÂ‚ÔÆ = $a…Ï„Ÿä†ó[897] . $this->parseTable($Fš¼”×‹«[$a…Ï„Ÿä†ó[277]]) . $a…Ï„Ÿä†ó[898] . implode($a…Ï„Ÿä†ó[47], $fŠäÈáŞ¤ë) . $a…Ï„Ÿä†ó[899] . implode($a…Ï„Ÿä†ó[47], $F½ÑÕ‡ğ¸Ó) . $a…Ï„Ÿä†ó[900]; return $this->execute($b“ŒôÂ‚ÔÆ); } public function insertAll($F‘°íô¤‹, $A¦ê‡îÅÈ = array(), $dË¶³ŒØÉ… = false) { goto f¨¤Œ­¹ƒ‰; e‡í¹ì’Š: $CÜœ„à…ó¸ = $dË¶³ŒØÉ… ? $A×½÷¤£„[902] : $A×½÷¤£„[903]; $E¿Ú……ñå = $CÜœ„à…ó¸ . $A×½÷¤£„[904] . $this->parseTable($A¦ê‡îÅÈ[$A×½÷¤£„[277]]) . $A×½÷¤£„[898] . implode($A×½÷¤£„[47], $cªë„ÑŞÜ) . $A×½÷¤£„[905] . implode($A×½÷¤£„[47], $C¥Î®”£Ú¾); return $this->execute($E¿Ú……ñå); goto d«®Ã³¤ˆ; f¨¤Œ­¹ƒ‰: $A×½÷¤£„ =& $_SERVER[©äõ½¡]; if (!is_array($F‘°íô¤‹[0])) { return !1; } $cªë„ÑŞÜ = array_keys($F‘°íô¤‹[0]); goto fˆë‡ß©¥; fˆë‡ß©¥: $C¥Î®”£Ú¾ = array(); foreach ($F‘°íô¤‹ as $E¹´Ç·ï£ª) { $e—ÍÇğìÇ = array(); foreach ($E¹´Ç·ï£ª as $bšÃÍòÁ…¾ => $CÓ‰¸ˆâÕ) { $CÓ‰¸ˆâÕ = $this->parseValue($CÓ‰¸ˆâÕ); if (is_scalar($CÓ‰¸ˆâÕ)) { $e—ÍÇğìÇ[] = $CÓ‰¸ˆâÕ; } } $C¥Î®”£Ú¾[] = $A×½÷¤£„[258] . implode($A×½÷¤£„[47], $e—ÍÇğìÇ) . $A×½÷¤£„[900]; } array_walk($cªë„ÑŞÜ, array($this, $A×½÷¤£„[901])); goto e‡í¹ì’Š; d«®Ã³¤ˆ: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $c•–°š¨í¹ =& $_SERVER[©äõ½¡]; $this->error = $this->_linkID->errno . $c•–°š¨í¹[4] . $this->_linkID->error; if ($c•–°š¨í¹[33] != $this->queryStr) { $this->error .= LNG($c•–°š¨í¹[45]) . $this->queryStr; } think_trace($this->error, $c•–°š¨í¹[33], $c•–°š¨í¹[46]); return $this->error; } public function escapeString($CÒ‘§Ñ’ï¶) { if ($this->_linkID) { return $this->_linkID->real_escape_string($CÒ‘§Ñ’ï¶); } else { return addslashes($CÒ‘§Ñ’ï¶); } } public function parseKey(&$Cì…¿®Èæ¦, $bİ„îÉäï = true) { $bïÔ­Î–öÜ =& $_SERVER[©äõ½¡]; if ($bİ„îÉäï) { $Cì…¿®Èæ¦ = $this->parseKeyCheck($Cì…¿®Èæ¦); } if ($Cì…¿®Èæ¦ != $bïÔ­Î–öÜ[182] && !preg_match($bïÔ­Î–öÜ[906], $Cì…¿®Èæ¦)) { $Cì…¿®Èæ¦ = $bïÔ­Î–öÜ[383] . trim($Cì…¿®Èæ¦, $bïÔ­Î–öÜ[383]) . $bïÔ­Î–öÜ[383]; } return $Cì…¿®Èæ¦; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($A‚¢‡­’Í  = '') { $aäºÀöÕÀ =& $_SERVER[©äõ½¡]; if (!class_exists($aäºÀöÕÀ[908])) { think_exception(think_lang($aäºÀöÕÀ[10]) . $aäºÀöÕÀ[909]); } if (!empty($A‚¢‡­’Í )) { $this->config = $A‚¢‡­’Í ; if (empty($this->config[$aäºÀöÕÀ[13]])) { $this->config[$aäºÀöÕÀ[13]] = array(); } } } public function connect($dÓ‰Ù³õ = '', $Fİˆªƒ¡™ˆ = 0) { $BÈöÄ´ê–¡ =& $_SERVER[©äõ½¡]; if (!isset($this->linkID[$Fİˆªƒ¡™ˆ])) { goto EïíŠöª÷¦; e¥ìÑ²Œ¾È: if (!$this->linkID[$Fİˆªƒ¡™ˆ]) { think_exception($BÈöÄ´ê–¡[918]); } try { $this->linkID[$Fİˆªƒ¡™ˆ]->exec($BÈöÄ´ê–¡[919] . think_config($BÈöÄ´ê–¡[886])); } catch (Exception $EÃƒíÈ¹Ó) { } $this->connected = !0; goto fî«½ô§ŠÃ; EïíŠöª÷¦: if (empty($dÓ‰Ù³õ)) { $dÓ‰Ù³õ = $this->config; } $Aç‹¬´ëå = !empty($dÓ‰Ù³õ[$BÈöÄ´ê–¡[13]][$BÈöÄ´ê–¡[14]]) ? $dÓ‰Ù³õ[$BÈöÄ´ê–¡[13]][$BÈöÄ´ê–¡[14]] : $this->pconnect; if ($Aç‹¬´ëå) { $dÓ‰Ù³õ[$BÈöÄ´ê–¡[13]][PDO::ATTR_PERSISTENT] = !0; } goto AÈ‰İ´»Œ; AÈ‰İ´»Œ: try { $this->linkID[$Fİˆªƒ¡™ˆ] = new PDO($dÓ‰Ù³õ[$BÈöÄ´ê–¡[910]], $dÓ‰Ù³õ[$BÈöÄ´ê–¡[883]], $dÓ‰Ù³õ[$BÈöÄ´ê–¡[884]], $dÓ‰Ù³õ[$BÈöÄ´ê–¡[13]]); } catch (PDOException $EÃƒíÈ¹Ó) { think_exception($EÃƒíÈ¹Ó->getMessage()); } $this->dbType = $this->_getDsnType($dÓ‰Ù³õ[$BÈöÄ´ê–¡[910]]); if (in_array($this->dbType, array($BÈöÄ´ê–¡[911], $BÈöÄ´ê–¡[912], $BÈöÄ´ê–¡[913], $BÈöÄ´ê–¡[914]))) { think_exception($BÈöÄ´ê–¡[915] . $this->dbType . $BÈöÄ´ê–¡[916] . $this->dbType . $BÈöÄ´ê–¡[917]); } goto e¥ìÑ²Œ¾È; fî«½ô§ŠÃ: if (1 != think_config($BÈöÄ´ê–¡[18])) { unset($this->config); } goto dĞ‘ô†ÑÊ»; dĞ‘ô†ÑÊ»: } return $this->linkID[$Fİˆªƒ¡™ˆ]; } public function free() { $this->PDOStatement = null; } public function query($a…•Òö³§², $e¿È£¡´Ê = array()) { goto E£µãˆÓÙ„; Bœ±ìçĞ¯ç: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $ešç¼¸››Ö = $this->PDOStatement->execute($e¿È£¡´Ê); $this->debug(); goto eÚì§©½×‚; E£µãˆÓÙ„: $c˜ù³ßèÙª =& $_SERVER[©äõ½¡]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto BÑŒÊ¦Ñš“; d‹Õ‡Î‹˜: think_action_status($c˜ù³ßèÙª[19], 1); think_status($c˜ù³ßèÙª[20]); $this->PDOStatement = $this->_linkID->prepare($a…•Òö³§²); goto Bœ±ìçĞ¯ç; eÚì§©½×‚: if (!1 === $ešç¼¸››Ö) { $this->error(); return !1; } else { return $this->getAll(); } goto B˜­†çİŞ¶; BÑŒÊ¦Ñš“: $this->queryStr = $a…•Òö³§²; if (!empty($e¿È£¡´Ê)) { $this->queryStr .= $c˜ù³ßèÙª[920] . print_r($e¿È£¡´Ê, !0) . $c˜ù³ßèÙª[921]; } if (!empty($this->PDOStatement)) { $this->free(); } goto d‹Õ‡Î‹˜; B˜­†çİŞ¶: } public function execute($Cãõâ„ù†, $E¬ ê”—æ = array()) { goto d×¾ô‘î…›; d×¾ô‘î…›: $D«¿Îâï†Ÿ =& $_SERVER[©äõ½¡]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e³¦Üç·È; a„­Õë’„Ğ: think_status($D«¿Îâï†Ÿ[20]); $this->PDOStatement = $this->_linkID->prepare($Cãõâ„ù†); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto bÎ¥©«¾§˜; bÎ¥©«¾§˜: $eÙË…¸›¹É = $this->PDOStatement->execute($E¬ ê”—æ); $this->debug(); if (!1 === $eÙË…¸›¹É) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($C×©š‡×å¶ || preg_match($D«¿Îâï†Ÿ[926], $Cãõâ„ù†)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto BßäëºŒÜâ; DÁÚœÓ²Ä‡: if ($this->dbType == $D«¿Îâï†Ÿ[914]) { if (preg_match($D«¿Îâï†Ÿ[922], $this->queryStr, $fŠÂäĞ‹)) { $this->table = think_config($D«¿Îâï†Ÿ[923]) . str_ireplace(think_config($D«¿Îâï†Ÿ[924]), $D«¿Îâï†Ÿ[376], $fŠÂäĞ‹[2]); $C×©š‡×å¶ = (bool) $this->query($D«¿Îâï†Ÿ[925] . strtoupper($this->table) . $D«¿Îâï†Ÿ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($D«¿Îâï†Ÿ[21], 1); goto a„­Õë’„Ğ; e³¦Üç·È: $this->queryStr = $Cãõâ„ù†; if (!empty($E¬ ê”—æ)) { $this->queryStr .= $D«¿Îâï†Ÿ[920] . print_r($E¬ ê”—æ, !0) . $D«¿Îâï†Ÿ[921]; } $C×©š‡×å¶ = !1; goto DÁÚœÓ²Ä‡; BßäëºŒÜâ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Fˆ©—ù¯°‚ = $this->_linkID->commit(); $this->transTimes = 0; if (!$Fˆ©—ù¯°‚) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aóÕ¥Àèìá = $this->_linkID->rollback(); $this->transTimes = 0; if (!$aóÕ¥Àèìá) { $this->error(); return !1; } } return !0; } private function getAll() { $f³–ŞÀ®›„ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($f³–ŞÀ®›„); return $f³–ŞÀ®›„; } public function getFields($dŒŠ®ğÑŒœ) { goto d•¤ÈÏ™°ˆ; d«ÌáÏ¢ìİ: $CØâØğ¾© = $this->query($e¹Šæçİ²¸); $F¡Ùß¨‘©Ú = array(); if ($CØâØğ¾©) { foreach ($CØâØğ¾© as $BŞõ‡¸”ˆ => $Fğ¦°ÜÆªò) { $Fğ¦°ÜÆªò = array_change_key_case($Fğ¦°ÜÆªò); $Fğ¦°ÜÆªò[$AèÍº¨±öº[28]] = isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[28]]) ? $Fğ¦°ÜÆªò[$AèÍº¨±öº[28]] : $AèÍº¨±öº[376]; $Fğ¦°ÜÆªò[$AèÍº¨±öº[29]] = isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[29]]) ? $Fğ¦°ÜÆªò[$AèÍº¨±öº[29]] : $AèÍº¨±öº[376]; $EœŸÓŸ© = isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[271]]) ? $Fğ¦°ÜÆªò[$AèÍº¨±öº[271]] : $Fğ¦°ÜÆªò[$AèÍº¨±öº[28]]; $F¡Ùß¨‘©Ú[$EœŸÓŸ©] = array($AèÍº¨±öº[28] => $EœŸÓŸ©, $AèÍº¨±öº[29] => $Fğ¦°ÜÆªò[$AèÍº¨±öº[29]], $AèÍº¨±öº[31] => (bool) (isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[103]]) && $Fğ¦°ÜÆªò[$AèÍº¨±öº[103]] === $AèÍº¨±öº[33] || isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[31]]) && $Fğ¦°ÜÆªò[$AèÍº¨±öº[31]] === $AèÍº¨±öº[33]), $AèÍº¨±öº[34] => isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[34]]) ? $Fğ¦°ÜÆªò[$AèÍº¨±öº[34]] : (isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[53]]) ? $Fğ¦°ÜÆªò[$AèÍº¨±öº[53]] : $AèÍº¨±öº[376]), $AèÍº¨±öº[36] => isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[93]]) ? strtolower($Fğ¦°ÜÆªò[$AèÍº¨±öº[93]]) == $AèÍº¨±öº[38] : (isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[54]]) ? $Fğ¦°ÜÆªò[$AèÍº¨±öº[54]] : !1), $AèÍº¨±öº[39] => isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[943]]) ? strtolower($Fğ¦°ÜÆªò[$AèÍº¨±öº[943]]) == $AèÍº¨±öº[41] : (isset($Fğ¦°ÜÆªò[$AèÍº¨±öº[93]]) ? $Fğ¦°ÜÆªò[$AèÍº¨±öº[93]] : !1)); } } goto FÇÎåÍ¦â; FÇÎåÍ¦â: return $F¡Ùß¨‘©Ú; goto Eì†ĞÁ÷Ü»; d•¤ÈÏ™°ˆ: $AèÍº¨±öº =& $_SERVER[©äõ½¡]; $this->initConnect(!0); if (think_config($AèÍº¨±öº[927])) { $e¹Šæçİ²¸ = str_replace($AèÍº¨±öº[928], $dŒŠ®ğÑŒœ, think_config($AèÍº¨±öº[927])); } else { switch ($this->dbType) { case $AèÍº¨±öº[911]: case $AèÍº¨±öº[929]: $e¹Šæçİ²¸ = "\123\x45\x4c\x45\x43\124\x20\x20\40\143\157\154\x75\x6d\x6e\137\156\x61\155\145\40\141\x73\40\x27\x4e\x61\x6d\x65\x27\x2c\40\40\x20\x64\141\x74\141\137\x74\171\x70\145\x20\141\163\40\47\124\171\160\x65\x27\x2c\x20\x20\x20\143\x6f\x6c\x75\x6d\156\137\144\145\146\x61\165\154\x74\40\x61\163\40\x27\104\x65\x66\141\x75\x6c\x74\47\x2c\40\40\x20\x69\163\137\x6e\165\x6c\x6c\141\x62\154\x65\x20\141\163\x20\47\x4e\x75\154\x6c\47\xa\x9\11\x46\122\x4f\x4d\11\x69\156\146\x6f\162\x6d\141\164\x69\x6f\156\x5f\x73\143\150\x65\x6d\141\x2e\x74\x61\x62\154\145\x73\x20\101\123\40\x74\xa\x9\x9\112\117\111\x4e\x9\x69\156\146\157\x72\x6d\141\164\151\157\156\x5f\x73\x63\x68\145\x6d\141\x2e\143\157\154\x75\155\156\x73\x20\x41\123\40\x63\12\x9\x9\x4f\116\x20\x20\x74\x2e\164\x61\142\154\x65\137\143\x61\164\x61\x6c\x6f\x67\x20\75\x20\143\56\164\x61\x62\x6c\145\137\x63\141\x74\141\x6c\x6f\147\12\11\11\x41\116\104\40\164\x2e\x74\141\142\154\145\x5f\x73\143\x68\145\x6d\141\x20\x3d\40\143\56\x74\141\x62\x6c\x65\137\163\143\150\x65\155\141\12\11\11\x41\116\104\40\164\x2e\x74\x61\142\154\145\x5f\156\x61\155\145\x20\x3d\x20\143\56\164\141\x62\154\145\x5f\156\141\x6d\x65\xa\x9\x9\127\110\105\x52\x45\x20\40\40\164\x2e\x74\x61\x62\154\x65\x5f\x6e\141\155\145\x20\x3d\40\x27{$dŒŠ®ğÑŒœ}\x27"; break; case $AèÍº¨±öº[930]: $e¹Šæçİ²¸ = $AèÍº¨±öº[931] . $dŒŠ®ğÑŒœ . $AèÍº¨±öº[932]; break; case $AèÍº¨±öº[912]: case $AèÍº¨±öº[914]: $e¹Šæçİ²¸ = $AèÍº¨±öº[933] . $AèÍº¨±öº[934] . $AèÍº¨±öº[935] . strtoupper($dŒŠ®ğÑŒœ) . $AèÍº¨±öº[936] . strtoupper($dŒŠ®ğÑŒœ) . $AèÍº¨±öº[937]; break; case $AèÍº¨±öº[938]: $e¹Šæçİ²¸ = $AèÍº¨±öº[939] . $dŒŠ®ğÑŒœ . $AèÍº¨±öº[940]; break; case $AèÍº¨±öº[913]: break; case $AèÍº¨±öº[941]: default: $e¹Šæçİ²¸ = $AèÍº¨±öº[942] . ($this->dbType == $AèÍº¨±öº[941] ? "\x60{$dŒŠ®ğÑŒœ}\140" : $dŒŠ®ğÑŒœ); } } goto d«ÌáÏ¢ìİ; Eì†ĞÁ÷Ü»: } public function getTables($d—Ø–´â¿ = '') { $AÒšå§Å =& $_SERVER[©äõ½¡]; if (think_config($AÒšå§Å[944])) { $dĞòÆˆ‹ = str_replace($AÒšå§Å[945], $d—Ø–´â¿, think_config($AÒšå§Å[944])); } else { switch ($this->dbType) { case $AÒšå§Å[912]: case $AÒšå§Å[914]: $dĞòÆˆ‹ = $AÒšå§Å[946]; break; case $AÒšå§Å[911]: case $AÒšå§Å[929]: $dĞòÆˆ‹ = $AÒšå§Å[947]; break; case $AÒšå§Å[938]: $dĞòÆˆ‹ = $AÒšå§Å[948]; break; case $AÒšå§Å[913]: think_exception(think_lang($AÒšå§Å[949]) . $AÒšå§Å[950]); break; case $AÒšå§Å[930]: $dĞòÆˆ‹ = $AÒšå§Å[42] . $AÒšå§Å[43] . $AÒšå§Å[44]; break; case $AÒšå§Å[941]: default: if (!empty($d—Ø–´â¿)) { $dĞòÆˆ‹ = $AÒšå§Å[894] . $d—Ø–´â¿ . $AÒšå§Å[895]; } else { $dĞòÆˆ‹ = $AÒšå§Å[896]; } } } $b¸ÆëÑ‰º = $this->query($dĞòÆˆ‹); $a“‘ÎºŸÊ = array(); foreach ($b¸ÆëÑ‰º as $eÂéÉë…§ => $cößÔ«²µ°) { $a“‘ÎºŸÊ[$eÂéÉë…§] = current($cößÔ«²µ°); } return $a“‘ÎºŸÊ; } protected function parseLimit($F‘Ë¢é¤«) { $fÄ¸”Ã›Ì =& $_SERVER[©äõ½¡]; $d‡ö¡š ãª = $fÄ¸”Ã›Ì[33]; if (!empty($F‘Ë¢é¤«)) { switch ($this->dbType) { case $fÄ¸”Ã›Ì[938]: case $fÄ¸”Ã›Ì[930]: $F‘Ë¢é¤« = explode($fÄ¸”Ã›Ì[47], $F‘Ë¢é¤«); if (count($F‘Ë¢é¤«) > 1) { $d‡ö¡š ãª .= $fÄ¸”Ã›Ì[48] . $F‘Ë¢é¤«[1] . $fÄ¸”Ã›Ì[49] . $F‘Ë¢é¤«[0] . $fÄ¸”Ã›Ì[50]; } else { $d‡ö¡š ãª .= $fÄ¸”Ã›Ì[48] . $F‘Ë¢é¤«[0] . $fÄ¸”Ã›Ì[50]; } break; case $fÄ¸”Ã›Ì[911]: case $fÄ¸”Ã›Ì[929]: break; case $fÄ¸”Ã›Ì[913]: break; case $fÄ¸”Ã›Ì[912]: case $fÄ¸”Ã›Ì[914]: break; case $fÄ¸”Ã›Ì[941]: default: $d‡ö¡š ãª .= $fÄ¸”Ã›Ì[48] . $F‘Ë¢é¤« . $fÄ¸”Ã›Ì[50]; } } return $d‡ö¡š ãª; } public function parseKey(&$dë†¾àãŠ, $Eƒ»…ÓŸ¢ = true) { $FéóŒ¯ÓÂ³ =& $_SERVER[©äõ½¡]; if ($Eƒ»…ÓŸ¢) { $dë†¾àãŠ = $this->parseKeyCheck($dë†¾àãŠ); } if ($this->dbType == $FéóŒ¯ÓÂ³[941]) { if ($dë†¾àãŠ != $FéóŒ¯ÓÂ³[182] && !preg_match($FéóŒ¯ÓÂ³[906], $dë†¾àãŠ)) { $dë†¾àãŠ = $FéóŒ¯ÓÂ³[383] . trim($dë†¾àãŠ, $FéóŒ¯ÓÂ³[383]) . $FéóŒ¯ÓÂ³[383]; } return $dë†¾àãŠ; } else { return parent::parseKey($dë†¾àãŠ, $Eƒ»…ÓŸ¢); } } public function close() { $this->_linkID = null; } public function error() { $f‹¤ÔÑàÅò =& $_SERVER[©äõ½¡]; if ($this->PDOStatement) { $bÓ£™é¢‚‰ = $this->PDOStatement->errorInfo(); $this->error = $bÓ£™é¢‚‰[1] . $f‹¤ÔÑàÅò[4] . $bÓ£™é¢‚‰[2]; } else { $this->error = $f‹¤ÔÑàÅò[33]; } if ($f‹¤ÔÑàÅò[33] != $this->queryStr) { $this->error .= LNG($f‹¤ÔÑàÅò[45]) . $this->queryStr; } think_trace($this->error, $f‹¤ÔÑàÅò[33], $f‹¤ÔÑàÅò[46]); return $this->error; } public function escapeString($aÀğğ¢«Â¦) { $fÏ«Ö®äİ° =& $_SERVER[©äõ½¡]; switch ($this->dbType) { case $fÏ«Ö®äİ°[938]: case $fÏ«Ö®äİ°[911]: case $fÏ«Ö®äİ°[929]: case $fÏ«Ö®äİ°[941]: return addslashes($aÀğğ¢«Â¦); case $fÏ«Ö®äİ°[913]: case $fÏ«Ö®äİ°[930]: case $fÏ«Ö®äİ°[912]: case $fÏ«Ö®äİ°[914]: return str_ireplace($fÏ«Ö®äİ°[55], $fÏ«Ö®äİ°[56], $aÀğğ¢«Â¦); } } protected function parseValue($eãÏ‹ë…öí) { $F˜›÷ö˜ÑŞ =& $_SERVER[©äõ½¡]; if (is_string($eãÏ‹ë…öí)) { $a±µåä³ = strpos($eãÏ‹ë…öí, $F˜›÷ö˜ÑŞ[4]) === 0 && in_array($eãÏ‹ë…öí, array_keys($this->bind)); $eãÏ‹ë…öí = $a±µåä³ ? $this->escapeString($eãÏ‹ë…öí) : $F˜›÷ö˜ÑŞ[951] . $this->escapeString($eãÏ‹ë…öí) . $F˜›÷ö˜ÑŞ[951]; } elseif (isset($eãÏ‹ë…öí[0]) && is_string($eãÏ‹ë…öí[0]) && strtolower($eãÏ‹ë…öí[0]) == $F˜›÷ö˜ÑŞ[295]) { $eãÏ‹ë…öí = $this->escapeString($eãÏ‹ë…öí[1]); } elseif (is_array($eãÏ‹ë…öí)) { $eãÏ‹ë…öí = array_map(array($this, $F˜›÷ö˜ÑŞ[952]), $eãÏ‹ë…öí); } elseif (is_bool($eãÏ‹ë…öí)) { $eãÏ‹ë…öí = $eãÏ‹ë…öí ? $F˜›÷ö˜ÑŞ[87] : $F˜›÷ö˜ÑŞ[191]; } elseif (is_null($eãÏ‹ë…öí)) { $eãÏ‹ë…öí = $F˜›÷ö˜ÑŞ[103]; } return $eãÏ‹ë…öí; } public function getLastInsertId() { $b¼‡Ğ¤êÑô =& $_SERVER[©äõ½¡]; switch ($this->dbType) { case $b¼‡Ğ¤êÑô[938]: case $b¼‡Ğ¤êÑô[930]: case $b¼‡Ğ¤êÑô[911]: case $b¼‡Ğ¤êÑô[929]: case $b¼‡Ğ¤êÑô[913]: case $b¼‡Ğ¤êÑô[941]: return $this->_linkID->lastInsertId(); case $b¼‡Ğ¤êÑô[912]: case $b¼‡Ğ¤êÑô[914]: $E„Ùò™Ÿø = $this->table; $Eø²¬™ìä¤ = $this->query("\123\105\x4c\x45\x43\124\40{$E„Ùò™Ÿø}\x2e\x63\165\162\x72\x76\141\154\40\x63\165\x72\162\x76\x61\154\40\106\x52\x4f\x4d\40\x64\165\141\x6c"); return $Eø²¬™ìä¤ ? $Eø²¬™ìä¤[0][$b¼‡Ğ¤êÑô[953]] : 0; } } } goto eİª“¹±íÍ; Dí¦Ùƒâ÷º: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($fìƒ£¼‘ì›) { parent::__construct($fìƒ£¼‘ì›); $this->signatureVersion($_SERVER[©äõ½¡][212]); } public function uploadFormData($Cñ“±­ï‚±, $E’ëÓîŞ”« = 3600) { goto FÌÎë Ë‡¯; Aœ¼¡ÒÄòğ: $a¤ñ›»£ä = $Cš—ãÑö¼™[59]; $FÚ“ÅÅ‰ïŸ = gmdate($Cš—ãÑö¼™[1258]); $EÈƒÌ¼ö”‹ = gmdate($Cš—ãÑö¼™[746]); goto föœóŸ‚ø; F„òæöØÍÀ: $E£‘¼ï•³ = base64_encode(json_encode($AÎ×ù¥”á)); $CÚßÊß¨Ğ = hash_hmac($Cš—ãÑö¼™[1267], $EÈƒÌ¼ö”‹, $Cš—ãÑö¼™[1268] . $this->secret, !0); $eÌŸíƒçôŒ = hash_hmac($Cš—ãÑö¼™[1267], $this->region, $CÚßÊß¨Ğ, !0); goto A¿ÜØ‹»à; f…¼ç¾Ä…Ä: $c•‘îá = array($this->accessKey, $EÈƒÌ¼ö”‹, $this->region, $a¤ñ›»£ä, $cù¸±° ½õ); $BŞàšÁŸÆö = implode($Cš—ãÑö¼™[8], $c•‘îá); $AÎ×ù¥”á = array($Cš—ãÑö¼™[1224] => gmdate($Cš—ãÑö¼™[1223], strtotime($Cš—ãÑö¼™[1260])), $Cš—ãÑö¼™[1225] => array(array($Cš—ãÑö¼™[1227] => $this->bucket), array($Cš—ãÑö¼™[1226] => $EÆ¥çºÎ®), array($Cš—ãÑö¼™[1228], $Cš—ãÑö¼™[1229], $Cš—ãÑö¼™[33]), array($Cš—ãÑö¼™[1228], $Cš—ãÑö¼™[1261], $Cš—ãÑö¼™[33]), array($Cš—ãÑö¼™[1228], $Cš—ãÑö¼™[1262], $Cš—ãÑö¼™[33]), array($Cš—ãÑö¼™[1230] => $CÒâä÷èğÃ), array($Cš—ãÑö¼™[1263] => $BŞàšÁŸÆö), array($Cš—ãÑö¼™[1264] => $B„Õ¥´„Šæ), array($Cš—ãÑö¼™[1265] => $FÚ“ÅÅ‰ïŸ), array($Cš—ãÑö¼™[1266] => $Dá¬øÂÒ))); goto F„òæöØÍÀ; föœóŸ‚ø: $cù¸±° ½õ = $Cš—ãÑö¼™[1259]; $Dá¬øÂÒ = $E’ëÓîŞ”« . $Cš—ãÑö¼™[33]; $CÒâä÷èğÃ = $Cš—ãÑö¼™[1222]; goto f…¼ç¾Ä…Ä; A¿ÜØ‹»à: $b½Ô½ëŒ¨­ = hash_hmac($Cš—ãÑö¼™[1267], $a¤ñ›»£ä, $eÌŸíƒçôŒ, !0); $Cóº›ÓÙ˜Ä = hash_hmac($Cš—ãÑö¼™[1267], $cù¸±° ½õ, $b½Ô½ëŒ¨­, !0); $EÆ¤ÂÛ‘Ø‚ = hash_hmac($Cš—ãÑö¼™[1267], $E£‘¼ï•³, $Cóº›ÓÙ˜Ä); goto dµŒµ°ù¨£; dµŒµ°ù¨£: $eŸÎŞ…ßÖ = array($Cš—ãÑö¼™[211] => $Cš—ãÑö¼™[33], $Cš—ãÑö¼™[1269] => $Cš—ãÑö¼™[33], $Cš—ãÑö¼™[1226] => $EÆ¥çºÎ®, $Cš—ãÑö¼™[1230] => $CÒâä÷èğÃ, $Cš—ãÑö¼™[1234] => $E£‘¼ï•³, $Cš—ãÑö¼™[1270] => $BŞàšÁŸÆö, $Cš—ãÑö¼™[1271] => $B„Õ¥´„Šæ, $Cš—ãÑö¼™[1272] => $FÚ“ÅÅ‰ïŸ, $Cš—ãÑö¼™[1273] => $Dá¬øÂÒ, $Cš—ãÑö¼™[1274] => $EÆ¤ÂÛ‘Ø‚, $Cš—ãÑö¼™[175] => $this->getHost()); return $eŸÎŞ…ßÖ; goto Añ’°‡±Ô×; FÌÎë Ë‡¯: $Cš—ãÑö¼™ =& $_SERVER[©äõ½¡]; $EÆ¥çºÎ® = $Cš—ãÑö¼™[192]; $B„Õ¥´„Šæ = $Cš—ãÑö¼™[1257]; goto Aœ¼¡ÒÄòğ; Añ’°‡±Ô×: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($C‘ÚÔø§®ë) { parent::__construct(); if (count($C‘ÚÔø§®ë) > 0) { $this->_init($C‘ÚÔø§®ë); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($Béù¨ˆ³) { $bö¡…Ç„Şí =& $_SERVER[©äõ½¡]; global $config; $this->appCharset = $config[$bö¡…Ç„Şí[1275]]; $this->systemCharset = $config[$bö¡…Ç„Şí[1276]]; if (isset($Béù¨ˆ³[$bö¡…Ç„Şí[1277]]) && $Béù¨ˆ³[$bö¡…Ç„Şí[1277]]) { $this->systemCharset = $Béù¨ˆ³[$bö¡…Ç„Şí[1277]]; } } public function iconvApp($föŠÚ…ºÎ) { return $this->iconvTo($föŠÚ…ºÎ, $this->systemCharset, $this->appCharset); } public function iconvSystem($bÔĞ¯†˜) { return $this->iconvTo($bÔĞ¯†˜, $this->appCharset, $this->systemCharset); } public function getPathOuter($b”ªªæÄÚ) { goto f¥³øÆÜ£·; f¥³øÆÜ£·: $f í¡Òˆó =& $_SERVER[©äõ½¡]; $E­Øƒ¹ï’è = $this->iconvApp($this->pathBase); $b”ªªæÄÚ = $this->iconvApp($b”ªªæÄÚ); goto C‰äËÈËÆ½; C‰äËÈËÆ½: if (substr($E­Øƒ¹ï’è, 0, 2) == $f í¡Òˆó[1278]) { $E­Øƒ¹ï’è = BASIC_PATH . substr($E­Øƒ¹ï’è, 2); } if (substr($b”ªªæÄÚ, 0, 2) == $f í¡Òˆó[1278]) { $b”ªªæÄÚ = BASIC_PATH . substr($b”ªªæÄÚ, 2); } $E­Øƒ¹ï’è = KodIO::clear($E­Øƒ¹ï’è); goto E‹Ğí¾áØ; E‹Ğí¾áØ: $b”ªªæÄÚ = KodIO::clear($b”ªªæÄÚ); $b”ªªæÄÚ = substr($b”ªªæÄÚ, strlen($E­Øƒ¹ï’è)); if (empty($this->pathDriver)) { return $b”ªªæÄÚ; } goto c¬ç˜Òô¾ƒ; c¬ç˜Òô¾ƒ: return $this->pathDriver . $f í¡Òˆó[8] . ltrim($b”ªªæÄÚ, $f í¡Òˆó[8]); goto D‘ª¬™íàÍ; D‘ª¬™íàÍ: } private function _init($a…âÃÈ‡¼š = array()) { $a›×©ˆÊÊÉ =& $_SERVER[©äõ½¡]; if (!function_exists($a›×©ˆÊÊÉ[1279])) { throw new Exception(LNG($a›×©ˆÊÊÉ[1280])); } $this->config = $a…âÃÈ‡¼š; $this->charsetReset($a…âÃÈ‡¼š); foreach ($a…âÃÈ‡¼š as $fê±Ôš¶áè => $f·ËøæŞ›) { if (isset($this->{$fê±Ôš¶áè})) { $this->{$fê±Ôš¶áè} = $f·ËøæŞ›; } } return $this->_login($a…âÃÈ‡¼š); } private function _login($b™³æÃİù) { goto c—¢ˆÂƒœ…; E”ò¨¬Ú˜: $aÖÖˆóğ½²[$A‘ÕÛ…ÍŒ] = array($cô‹–Í½ä[1284] => $this->connect, $cô‹–Í½ä[175] => $this->host, $cô‹–Í½ä[174] => $this->scheme, $cô‹–Í½ä[176] => $this->port); return $CóŒÂŞŒê™; goto F¨«½áÇÓ; c—¢ˆÂƒœ…: $cô‹–Í½ä =& $_SERVER[©äõ½¡]; static $aÖÖˆóğ½² = array(); $A‘ÕÛ…ÍŒ = md5(json_encode($b™³æÃİù)); goto aŒ…šË÷â; B‚Ó¶êë™¿: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $CóŒÂŞŒê™ = @ftp_login($this->connect, $this->username, $this->userpass); goto cˆ¦á”¹Û; D·‹ò—­ˆ†: $a·×Å”ÓË = isset($CÅ…¥ßò[$cô‹–Í½ä[174]]) && $CÅ…¥ßò[$cô‹–Í½ä[174]] == $cô‹–Í½ä[1281] ? !0 : !1; $this->scheme = $a·×Å”ÓË ? $cô‹–Í½ä[1282] : $cô‹–Í½ä[1283]; $this->port = isset($CÅ…¥ßò[$cô‹–Í½ä[176]]) ? $CÅ…¥ßò[$cô‹–Í½ä[176]] : 21; goto B‚Ó¶êë™¿; cˆ¦á”¹Û: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $EöˆÎìÓæŠ = $this->pasv == $cô‹–Í½ä[87] ? !0 : !1; @ftp_pasv($this->connect, $EöˆÎìÓæŠ); goto E”ò¨¬Ú˜; aŒ…šË÷â: if (isset($aÖÖˆóğ½²[$A‘ÕÛ…ÍŒ])) { foreach ($aÖÖˆóğ½²[$A‘ÕÛ…ÍŒ] as $A†ˆš‚’Ù† => $CÅ½‰Š»œ) { $this->{$A†ˆš‚’Ù†} = $CÅ½‰Š»œ; } return !0; } $CÅ…¥ßò = parse_url(trim($this->server, $cô‹–Í½ä[8])); $this->host = $CÅ…¥ßò[$cô‹–Í½ä[175]]; goto D·‹ò—­ˆ†; F¨«½áÇÓ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($e÷ƒĞ¹Œ•›, $D¿ÂØâÄ® = '', $C±—‚¨§èò = REPEAT_RENAME) { if ($this->setContent($e÷ƒĞ¹Œ•›, $D¿ÂØâÄ®)) { return $this->getPathOuter($e÷ƒĞ¹Œ•›); } return !1; } public function mkdir($a¢ŒÖç²ç, $E‰‚ÈÛ ²á = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $a¢ŒÖç²ç = $this->iconvSystem($a¢ŒÖç²ç); if ($this->_isFolder($a¢ŒÖç²ç) || @ftp_mkdir($this->connect, $a¢ŒÖç²ç)) { return $this->getPathOuter($a¢ŒÖç²ç); } if (!$this->mkdir($this->pathFather($a¢ŒÖç²ç))) { return !1; } if ($a¢ŒÖç²ç = @ftp_mkdir($this->connect, $a¢ŒÖç²ç)) { return $this->getPathOuter($a¢ŒÖç²ç); } return !1; } public function copyFile($c‹ ¼ÒÔÕè, $D«£¯÷«ïÁ) { goto e”µø«Ì; Bª¢¨ƒ¸¤°: $this->tempFileRemve($F­­‘äùÕ); return $dÌèæÉÌ°; goto bÈª¦¾ØÚì; e”µø«Ì: if (!$this->_isconn()) { return !1; } $CÃàÈèÛ = $this->pathThis($this->iconvSystem($c‹ ¼ÒÔÕè)); $F­­‘äùÕ = $this->tempFile($CÃàÈèÛ); goto bõÁğîñö—; bõÁğîñö—: $cáœÅí³İ± = $this->iconvApp($F­­‘äùÕ); $this->download($c‹ ¼ÒÔÕè, $cáœÅí³İ±); $dÌèæÉÌ° = $this->upload($D«£¯÷«ïÁ, $cáœÅí³İ±); goto Bª¢¨ƒ¸¤°; bÈª¦¾ØÚì: } public function moveFile($bÈëÄÁÙƒ, $A¿ŒŒ¸óÊ ) { if (!$this->_isconn()) { return !1; } $bÈëÄÁÙƒ = $this->iconvSystem($bÈëÄÁÙƒ); $A¿ŒŒ¸óÊ  = $this->iconvSystem($A¿ŒŒ¸óÊ ); $B½ñ·õäè = @ftp_rename($this->connect, $bÈëÄÁÙƒ, $A¿ŒŒ¸óÊ ); return $B½ñ·õäè ? $this->getPathOuter($A¿ŒŒ¸óÊ ) : !1; } public function delFile($aÓ´‚ÔÃš) { if (!$this->_isconn()) { return !1; } $aÓ´‚ÔÃš = $this->iconvSystem($aÓ´‚ÔÃš); return @ftp_delete($this->connect, $aÓ´‚ÔÃš); } public function delFolder($E—ì¡µ) { goto d‹ÃîœÁï¶; d‹ÃîœÁï¶: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $Dßî‘Üİ•¦ = $fñ³Ôù¼ïù = array(); goto EÒÆÊ“è°ù; d¶Áà®“è: foreach ($Dßî‘Üİ•¦ as $cŠˆòÛ‘) { $cŠˆòÛ‘ = $this->iconvSystem($cŠˆòÛ‘); $C­¢ŞëÌ‡ = @ftp_rmdir($this->connect, $cŠˆòÛ‘); if (!$C­¢ŞëÌ‡) { return !1; } } $E—ì¡µ = $this->iconvSystem($E—ì¡µ); return @ftp_rmdir($this->connect, $E—ì¡µ); goto C·”…²§Ñ¿; EÒÆÊ“è°ù: $this->fileList($E—ì¡µ, $Dßî‘Üİ•¦, $fñ³Ôù¼ïù, !0); $this->listItemCache = !0; foreach ($fñ³Ôù¼ïù as $Aø¸Š°ßÑŞ) { $cŠˆòÛ‘ = $this->iconvSystem($Aø¸Š°ßÑŞ[$_SERVER[©äõ½¡][28]]); $C­¢ŞëÌ‡ = @ftp_delete($this->connect, $cŠˆòÛ‘); if (!$C­¢ŞëÌ‡) { return !1; } } goto d¶Áà®“è; C·”…²§Ñ¿: } public function rename($d‰¶£¦§İĞ, $eùªÆ£„ªŸ) { goto B‹İ£àùØÛ; A®ìçİòºë: $dà¸ÄÑëé¬ = rtrim($eï¢‚î‡¼, $fâ˜¤Œ½ùì[8]) . $fâ˜¤Œ½ùì[8] . $CÍÁŒ†¸Ì¯; $CÔ˜¢ò±¥Î = @ftp_rename($this->connect, $d‰¶£¦§İĞ, $dà¸ÄÑëé¬); $dà¸ÄÑëé¬ = $this->iconvApp($dà¸ÄÑëé¬); goto AƒÙ”ÛŸ‘æ; B‹İ£àùØÛ: $fâ˜¤Œ½ùì =& $_SERVER[©äõ½¡]; if (!$this->_isconn()) { return !1; } $CÍÁŒ†¸Ì¯ = $this->fileNameAuto($this->pathFather($d‰¶£¦§İĞ), $eùªÆ£„ªŸ); goto D„Î‡±è; AƒÙ”ÛŸ‘æ: return $CÔ˜¢ò±¥Î ? $this->getPathOuter($dà¸ÄÑëé¬) : !1; goto AïÍÚ‘Á; D„Î‡±è: $CÍÁŒ†¸Ì¯ = $this->iconvSystem($CÍÁŒ†¸Ì¯); $d‰¶£¦§İĞ = $this->iconvSystem($d‰¶£¦§İĞ); $eï¢‚î‡¼ = $this->pathFather($d‰¶£¦§İĞ); goto A®ìçİòºë; AïÍÚ‘Á: } private function folderInfo($F±¢ê¾ÖÏ—, $BÏ…ñĞ‘†é = false) { $c‹ï‘ä•¨¿ =& $_SERVER[©äõ½¡]; $FŒŒ£ó§ˆÏ = array($c‹ï‘ä•¨¿[28] => $this->pathThis($F±¢ê¾ÖÏ—), $c‹ï‘ä•¨¿[76] => $this->getPathOuter($c‹ï‘ä•¨¿[8] . $F±¢ê¾ÖÏ—), $c‹ï‘ä•¨¿[29] => $c‹ï‘ä•¨¿[77]); if ($BÏ…ñĞ‘†é) { return $FŒŒ£ó§ˆÏ; } $FŒŒ£ó§ˆÏ[$c‹ï‘ä•¨¿[194]] = $FŒŒ£ó§ˆÏ[$c‹ï‘ä•¨¿[84]] = 0; $FŒŒ£ó§ˆÏ[$c‹ï‘ä•¨¿[195]] = $FŒŒ£ó§ˆÏ[$c‹ï‘ä•¨¿[196]] = !0; return $FŒŒ£ó§ˆÏ; } private function fileInfo($aÁ†è´Ğ£¨, $Fì–ÈĞÜª = false, $b·‹Şê·êø = array()) { goto BäÊßˆ•Åø; CêÂˆ¿»Å: $F…—• ÅÔ„[$B±›Š“¤œã[194]] = $F…—• ÅÔ„[$B±›Š“¤œã[84]] = 0; $F…—• ÅÔ„[$B±›Š“¤œã[195]] = $F…—• ÅÔ„[$B±›Š“¤œã[196]] = !0; $c˜ê·Œ‹ª£ = $this->iconvSystem($aÁ†è´Ğ£¨); goto b¦»£÷É÷¸; b¦»£÷É÷¸: $F…—• ÅÔ„[$B±›Š“¤œã[84]] = @ftp_mdtm($this->connect, $c˜ê·Œ‹ª£); if (empty($b·‹Şê·êø)) { $b·‹Şê·êø = $this->objectMeta($aÁ†è´Ğ£¨); if (!$b·‹Şê·êø) { return $F…—• ÅÔ„; } } $F…—• ÅÔ„[$B±›Š“¤œã[78]] = $b·‹Şê·êø[$B±›Š“¤œã[78]]; goto Câ¨­ªàùÊ; BäÊßˆ•Åø: $B±›Š“¤œã =& $_SERVER[©äõ½¡]; $F…—• ÅÔ„ = array($B±›Š“¤œã[28] => $this->pathThis($aÁ†è´Ğ£¨), $B±›Š“¤œã[76] => $this->getPathOuter($B±›Š“¤œã[8] . $aÁ†è´Ğ£¨), $B±›Š“¤œã[29] => $B±›Š“¤œã[193], $B±›Š“¤œã[78] => isset($b·‹Şê·êø[$B±›Š“¤œã[78]]) ? $b·‹Şê·êø[$B±›Š“¤œã[78]] : 0, $B±›Š“¤œã[168] => $this->ext($aÁ†è´Ğ£¨)); if ($Fì–ÈĞÜª) { return $F…—• ÅÔ„; } goto CêÂˆ¿»Å; Câ¨­ªàùÊ: return $F…—• ÅÔ„; goto bá”µÒ¼Ú„; bá”µÒ¼Ú„: } public function size($bÖ§ª×éËõ) { $F…ĞŒ…Ä»“ = $this->objectMeta($bÖ§ª×éËõ); return $F…ĞŒ…Ä»“ ? $F…ĞŒ…Ä»“[$_SERVER[©äõ½¡][78]] : 0; } public function info($FàŒ¹„†àÈ) { if ($this->isFile($FàŒ¹„†àÈ)) { return $this->fileInfo($FàŒ¹„†àÈ, 0); } else { if ($this->isFolder($FàŒ¹„†àÈ)) { return $this->folderInfo($FàŒ¹„†àÈ); } } return !1; } private function fileList($aè‚‰âã•, &$B–ùÆˆ¶‡©, &$DÀŞßçÕ», $B„‚ÕôÃ¯¼ = false) { goto AªÙ¦‡ ‘¡; E†Èµİƒ¨»: @ftp_chdir($this->connect, $EØÆŸæÆ¯•[8]); $aè‚‰âã• = rtrim($aè‚‰âã•, $EØÆŸæÆ¯•[8]) . $EØÆŸæÆ¯•[8]; check_abort(); goto b××½˜ğ‡; F¦Ü…äô¾: $bƒ‹ê¹…‹Ì = array($EØÆŸæÆ¯•[95] => 1, $EØÆŸæÆ¯•[1285] => 1); foreach ($EË’àÖÅÇ™ as $BÎÊñ±õå«) { goto c©ñ¨äÎ¼Ÿ; c©ñ¨äÎ¼Ÿ: $B…¶ÒĞ®›Œ = $this->_listItem($BÎÊñ±õå«); if ($B…¶ÒĞ®›Œ[0] == $EØÆŸæÆ¯•[754]) { continue; } $dÎìÁÓ±ñ¬ = $B…¶ÒĞ®›Œ[8]; goto f»âÓƒ¸¤; C¯ï‡¦ñêÉ: if (substr($BÎÊñ±õå«, 0, 1) == $EØÆŸæÆ¯•[1286]) { $bÙé¶çñ¢×[$EØÆŸæÆ¯•[29]] = $EØÆŸæÆ¯•[77]; $bÙé¶çñ¢×[$EØÆŸæÆ¯•[78]] = 0; } $dÛ†˜Œ·² = $bÙé¶çñ¢×[$EØÆŸæÆ¯•[29]] == $EØÆŸæÆ¯•[77] ? !0 : !1; if ($d¯ŠÏ¡Ï¼) { $this->cacheMethod($EØÆŸæÆ¯•[199], $dÎìÁÓ±ñ¬, $dÛ†˜Œ·²); $this->cacheMethod($EØÆŸæÆ¯•[200], $dÎìÁÓ±ñ¬, $bÙé¶çñ¢×); } goto Cù‹«ÏôÖÒ; f»âÓƒ¸¤: if (empty($dÎìÁÓ±ñ¬) && $dÎìÁÓ±ñ¬ !== $EØÆŸæÆ¯•[191] || isset($bƒ‹ê¹…‹Ì[$dÎìÁÓ±ñ¬])) { continue; } $dÎìÁÓ±ñ¬ = $this->iconvApp($aè‚‰âã• . ltrim($dÎìÁÓ±ñ¬, $EØÆŸæÆ¯•[8])); $bÙé¶çñ¢× = array($EØÆŸæÆ¯•[28] => $dÎìÁÓ±ñ¬, $EØÆŸæÆ¯•[29] => $EØÆŸæÆ¯•[193], $EØÆŸæÆ¯•[78] => $B…¶ÒĞ®›Œ[4]); goto C¯ï‡¦ñêÉ; Cù‹«ÏôÖÒ: if ($dÛ†˜Œ·²) { $B–ùÆˆ¶‡©[] = $dÎìÁÓ±ñ¬; if ($B„‚ÕôÃ¯¼) { $this->fileList($dÎìÁÓ±ñ¬, $B–ùÆˆ¶‡©, $DÀŞßçÕ», $B„‚ÕôÃ¯¼); } continue; } $DÀŞßçÕ»[] = $bÙé¶çñ¢×; goto dÇì×İ¾Ò; dÇì×İ¾Ò: } if ($d¯ŠÏ¡Ï¼) { $this->cacheMethod($EØÆŸæÆ¯•[199], $aè‚‰âã•, !0); } goto f§Æìñª‰; AªÙ¦‡ ‘¡: $EØÆŸæÆ¯• =& $_SERVER[©äõ½¡]; $aè‚‰âã• = $this->iconvSystem($aè‚‰âã•); if (!$this->isFolder($aè‚‰âã•)) { return !1; } goto E†Èµİƒ¨»; b××½˜ğ‡: $d¯ŠÏ¡Ï¼ = $this->listItemCache === !1 ? !1 : !0; $EË’àÖÅÇ™ = @ftp_rawlist($this->connect, $aè‚‰âã•); if (!$EË’àÖÅÇ™) { $EË’àÖÅÇ™ = array(); } goto F¦Ü…äô¾; f§Æìñª‰: } private function _listItem($D“»ˆ‹¹¯Ê) { if (empty($D“»ˆ‹¹¯Ê)) { return array(); } $fÏßœËæùã = preg_split($_SERVER[©äõ½¡][1287], $D“»ˆ‹¹¯Ê); if (count($fÏßœËæùã) <= 9) { return $fÏßœËæùã; } $fÏßœËæùã[8] = trim(substr($D“»ˆ‹¹¯Ê, strpos($D“»ˆ‹¹¯Ê, $fÏßœËæùã[7]) + strlen($fÏßœËæùã[7]))); return array_splice($fÏßœËæùã, 0, 9); } public function listPath($a£ãòº¦ÇÌ, $eí¦¦‘ğ¼£ = false) { goto AÓáÅÔÉé; EŠ—¬îÓ®¦: $this->fileList($a£ãòº¦ÇÌ, $B“—Ä‘«, $fˆ´³ºƒ); foreach ($B“—Ä‘« as $d‘ÈšÎßæ => $EøšâØ´ã«) { $B“—Ä‘«[$d‘ÈšÎßæ] = $this->folderInfo($EøšâØ´ã«, $eí¦¦‘ğ¼£); } foreach ($fˆ´³ºƒ as $d‘ÈšÎßæ => $EøšâØ´ã«) { $fˆ´³ºƒ[$d‘ÈšÎßæ] = $this->fileInfo($EøšâØ´ã«[$a¦²ÙÒÙßÎ[28]], $eí¦¦‘ğ¼£, $EøšâØ´ã«); } goto bï¯‡¼ÆÂ¨; bï¯‡¼ÆÂ¨: return array($a¦²ÙÒÙßÎ[75] => $B“—Ä‘«, $a¦²ÙÒÙßÎ[74] => $fˆ´³ºƒ); goto Eì»•È¡Ø›; AÓáÅÔÉé: $a¦²ÙÒÙßÎ =& $_SERVER[©äõ½¡]; if (!$this->_isconn()) { return !1; } $B“—Ä‘« = $fˆ´³ºƒ = array(); goto EŠ—¬îÓ®¦; Eì»•È¡Ø›: } public function has($BÓ‘Ë…œğÇ, $f‰Š•´Æ  = false, $f—Ş„»¡ß = true) { goto B±Íà¾¥÷Ş; B±Íà¾¥÷Ş: $fƒÂ“é¡öó =& $_SERVER[©äõ½¡]; $Dù¯´†Ãß· = $Dˆ•àŸ§ÒÎ = array(); $F‘Ù®ç•Ïî = $f‰Š•´Æ  ? !0 : !1; goto EŞÉ‰»­‰¡; eó´©£—ò: return !1; goto FÜ‚¡Ş•ªä; EŞÉ‰»­‰¡: $this->fileList($BÓ‘Ë…œğÇ, $Dù¯´†Ãß·, $Dˆ•àŸ§ÒÎ, $F‘Ù®ç•Ïî); if ($f‰Š•´Æ ) { return array($fƒÂ“é¡öó[203] => count($Dˆ•àŸ§ÒÎ), $fƒÂ“é¡öó[204] => count($Dù¯´†Ãß·)); } if ($f—Ş„»¡ß) { if (count($Dˆ•àŸ§ÒÎ)) { return !0; } } else { if (count($Dù¯´†Ãß·)) { return !0; } } goto eó´©£—ò; FÜ‚¡Ş•ªä: } public function listAll($E­ö¯°¨ñ) { goto ešğ°˜»ò; d¿Ë¯«ïÃ: $this->fileList($E­ö¯°¨ñ, $f½ÛÛçùª, $Cºœ£Ë›ƒ‡, !0); $F¦Ùêßì÷Æ = array(); foreach ($Cºœ£Ë›ƒ‡ as $eÍÃÌİ¿ùˆ) { $F¦Ùêßì÷Æ[$eÍÃÌİ¿ùˆ[$b×ø²”¼³Ú[28]]] = $eÍÃÌİ¿ùˆ[$b×ø²”¼³Ú[78]]; } goto E°Äš‘ªÑ; E°Äš‘ªÑ: foreach ($f½ÛÛçùª as $eÍÃÌİ¿ùˆ) { if (is_string($eÍÃÌİ¿ùˆ)) { $F¦Ùêßì÷Æ[$eÍÃÌİ¿ùˆ] = 0; } } return $this->listAllFiles($E­ö¯°¨ñ, array_keys($F¦Ùêßì÷Æ), $F¦Ùêßì÷Æ); goto D…˜Ü©˜õƒ; ešğ°˜»ò: $b×ø²”¼³Ú =& $_SERVER[©äõ½¡]; if (!$this->_isconn()) { return !1; } $f½ÛÛçùª = $Cºœ£Ë›ƒ‡ = array(); goto d¿Ë¯«ïÃ; D…˜Ü©˜õƒ: } public function getContent($D¾ƒÔ‹±«¯) { if (!$this->_isconn()) { return !1; } $D¾ƒÔ‹±«¯ = $this->iconvSystem($D¾ƒÔ‹±«¯); return $this->fileSubstr($D¾ƒÔ‹±«¯); } public function setContent($d““¦’¡Ïï, $aë‚“®Ğ„“ = '') { goto CÍùŸÖ‰‹Æ; Fä¾¨òï: return $F˜¬°Ï–ö; goto ašáÊ¬¨ö•; CÍùŸÖ‰‹Æ: if (!$this->_isconn()) { return !1; } $EÌòôø¨ì’ = $this->pathThis($this->iconvSystem($d““¦’¡Ïï)); $fß¦Ç•ƒ = $this->tempFile($EÌòôø¨ì’); goto aàä”†ˆ¨ß; aàä”†ˆ¨ß: file_put_contents($fß¦Ç•ƒ, $aë‚“®Ğ„“); $F˜¬°Ï–ö = $this->upload($d““¦’¡Ïï, $this->iconvApp($fß¦Ç•ƒ)); $this->tempFileRemve($fß¦Ç•ƒ); goto Fä¾¨òï; ašáÊ¬¨ö•: } public function fileSubstr($e‚‘ë¬ã‰š, $fÔ£ÀŞ”À = 0, $fÎ“õÁÚ‚ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($e‚‘ë¬ã‰š, $fÔ£ÀŞ”À, $fÎ“õÁÚ‚); } private function ftpRequest($aÅ×Ş¨ˆ¾ğ, $f…›ŠèÀÛ… = 0, $bˆäƒñøÎ = false) { goto EÜÃæ¿Ø¸‰; bÕ·ƒÅôçÎ: curl_setopt($Dè–ÜÍŸ’á, CURLOPT_URL, $dÜ¡‘ÇÁ®³ . $this->pathEncode($aÅ×Ş¨ˆ¾ğ)); curl_setopt($Dè–ÜÍŸ’á, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($bˆäƒñøÎ) { $AœËøòÕ¼è = $f…›ŠèÀÛ… + $bˆäƒñøÎ - 1; curl_setopt($Dè–ÜÍŸ’á, CURLOPT_RANGE, "{$f…›ŠèÀÛ…}\x2d{$AœËøòÕ¼è}"); } goto b…¿š¾ùƒø; EÜÃæ¿Ø¸‰: $aÅ×Ş¨ˆ¾ğ = $this->iconvSystem($aÅ×Ş¨ˆ¾ğ); $dÜ¡‘ÇÁ®³ = $this->scheme . $this->host . $_SERVER[©äõ½¡][4] . $this->port; $Dè–ÜÍŸ’á = curl_init(); goto bÕ·ƒÅôçÎ; c­ó×ŞæêÓ: return $Fë¼¼·»”; goto d°éŠ…‰öù; b…¿š¾ùƒø: curl_setopt($Dè–ÜÍŸ’á, CURLOPT_RETURNTRANSFER, 1); $Fë¼¼·»” = curl_exec($Dè–ÜÍŸ’á); curl_close($Dè–ÜÍŸ’á); goto c­ó×ŞæêÓ; d°éŠ…‰öù: } public function upload($aêÈç„¼£Î, $AâÌÔ»ƒÄ, $eß¹¢†—› = false, $CŠŠÙñ˜³ª = REPEAT_REPLACE) { goto aİî…Ñ’ˆ˜; BŒ†Šóï·: if ($a—™™°âØì != FTP_FINISHED) { return !1; } return $this->getPathOuter($aêÈç„¼£Î); goto dÎ¥ñ£–; aİî…Ñ’ˆ˜: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($aêÈç„¼£Î))) { return !1; } $aêÈç„¼£Î = $this->iconvSystem($aêÈç„¼£Î); goto dÚÃÛ¡Öğ; dÚÃÛ¡Öğ: $AâÌÔ»ƒÄ = $this->iconvSystem($AâÌÔ»ƒÄ); $a—™™°âØì = ftp_nb_put($this->connect, $aêÈç„¼£Î, $AâÌÔ»ƒÄ, FTP_BINARY); while ($a—™™°âØì == FTP_MOREDATA) { $a—™™°âØì = ftp_nb_continue($this->connect); } goto BŒ†Šóï·; dÎ¥ñ£–: } public function download($A¬ø¬è‘Û², $c¯ñ·õ¼ïÓ = '') { goto C¸‘®¡è®ö; C¸‘®¡è®ö: if (!$this->_isconn()) { return !1; } $bô©Èôñß = $this->pathFather($c¯ñ·õ¼ïÓ); if (!IO::mkdir($bô©Èôñß)) { return !1; } goto AÉ¿×¯÷‚Å; C×šâˆØÅå: while ($BÑ¾ğÉï == FTP_MOREDATA) { $BÑ¾ğÉï = ftp_nb_continue($this->connect); } if ($BÑ¾ğÉï != FTP_FINISHED) { return !1; } return $this->iconvApp($c¯ñ·õ¼ïÓ); goto fÅº²ä¿Ü; AÉ¿×¯÷‚Å: $A¬ø¬è‘Û² = $this->iconvSystem($A¬ø¬è‘Û²); $c¯ñ·õ¼ïÓ = $this->iconvSystem($c¯ñ·õ¼ïÓ); $BÑ¾ğÉï = ftp_nb_get($this->connect, $c¯ñ·õ¼ïÓ, $A¬ø¬è‘Û², FTP_BINARY); goto C×šâˆØÅå; fÅº²ä¿Ü: } public function exist($aïºÄø¬ñ—) { return $this->isFile($aïºÄø¬ñ—) || $this->isFolder($aïºÄø¬ñ—); } public function isFile($D‹‚†ÙÔÚó) { return !$this->isFolder($D‹‚†ÙÔÚó) && $this->objectMeta($D‹‚†ÙÔÚó); } public function isFolder($A„Ó »ã¦ñ) { return $this->cacheMethod($_SERVER[©äõ½¡][199], $A„Ó »ã¦ñ); } protected function objectMeta($B†ÄŒ—å÷) { return $this->cacheMethod($_SERVER[©äõ½¡][200], $B†ÄŒ—å÷); } protected function _objectMeta($DßƒÔŸÅÛ²) { goto c§ô™çôæ; F·äòÇ‹¼Ê: $C‡ñÚ—ˆöƒ = @ftp_size($this->connect, $DßƒÔŸÅÛ²); if ($C‡ñÚ—ˆöƒ != -1) { $eäÊ“ëµœë[$f½ã¸ å‚[78]] = $C‡ñÚ—ˆöƒ; } else { $a±ÓèÙŒ®¦ = @ftp_chdir($this->connect, $DßƒÔŸÅÛ²); if (!$a±ÓèÙŒ®¦) { return !1; } $eäÊ“ëµœë[$f½ã¸ å‚[29]] = $f½ã¸ å‚[77]; } return $eäÊ“ëµœë; goto Aœ‡ó¾êË; c§ô™çôæ: $f½ã¸ å‚ =& $_SERVER[©äõ½¡]; if ($DßƒÔŸÅÛ² == $f½ã¸ å‚[33] || $DßƒÔŸÅÛ² == $f½ã¸ å‚[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto E††¾¶ÀÃ¥; E††¾¶ÀÃ¥: $DßƒÔŸÅÛ² = $this->iconvSystem($DßƒÔŸÅÛ²); $eäÊ“ëµœë = array($f½ã¸ å‚[28] => $this->iconvApp($DßƒÔŸÅÛ²), $f½ã¸ å‚[29] => $f½ã¸ å‚[193], $f½ã¸ å‚[78] => 0); @ftp_chdir($this->connect, $f½ã¸ å‚[8]); goto F·äòÇ‹¼Ê; Aœ‡ó¾êË: } protected function _isFolder($FíŸ„§·‡¨) { $B‚êĞƒÙ²ó =& $_SERVER[©äõ½¡]; if ($FíŸ„§·‡¨ == $B‚êĞƒÙ²ó[33] || $FíŸ„§·‡¨ == $B‚êĞƒÙ²ó[8]) { return !0; } $cšî‘©¥ = $this->_objectMeta($FíŸ„§·‡¨); return isset($cšî‘©¥[$B‚êĞƒÙ²ó[29]]) && $cšî‘©¥[$B‚êĞƒÙ²ó[29]] == $B‚êĞƒÙ²ó[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { private $pathAuth; public function __construct() { parent::__construct(); $this->pathAuth = DEFAULT_PERRMISSIONS; } public function getPath($fø•é»Ã•) { if (substr($fø•é»Ã•, 0, 2) == $_SERVER[©äõ½¡][1278]) { $fø•é»Ã• = BASIC_PATH . substr($fø•é»Ã•, 2); } return $fø•é»Ã•; } public function iconvApp($d”Ì„ˆô) { $B¦ñœ´§Ö =& $_SERVER[©äõ½¡]; global $config; return $this->iconvTo($d”Ì„ˆô, $config[$B¦ñœ´§Ö[1276]], $config[$B¦ñœ´§Ö[1275]]); } public function iconvSystem($FÏÙ…¿¢°Ğ) { $A–ã…¶Üç¿ =& $_SERVER[©äõ½¡]; global $config; return $this->iconvTo($FÏÙ…¿¢°Ğ, $config[$A–ã…¶Üç¿[1275]], $config[$A–ã…¶Üç¿[1276]]); } public function getPathOuter($b«ÚÑ”­’) { goto fèï¬º½òƒ; fèï¬º½òƒ: $a¸š·ÈÆè =& $_SERVER[©äõ½¡]; $EÃåæÇ„Ö‚ = $this->iconvApp($this->pathBase); $b«ÚÑ”­’ = $this->iconvApp($b«ÚÑ”­’); goto aƒè¢Ò÷ô; f™‡ö¦Š­ˆ: $b«ÚÑ”­’ = KodIO::clear($b«ÚÑ”­’); $b«ÚÑ”­’ = substr($b«ÚÑ”­’, strlen($EÃåæÇ„Ö‚)); if (empty($this->pathDriver)) { return $b«ÚÑ”­’; } goto D ë‘«½¿; aƒè¢Ò÷ô: if (substr($EÃåæÇ„Ö‚, 0, 2) == $a¸š·ÈÆè[1278]) { $EÃåæÇ„Ö‚ = BASIC_PATH . substr($EÃåæÇ„Ö‚, 2); } if (substr($b«ÚÑ”­’, 0, 2) == $a¸š·ÈÆè[1278]) { $b«ÚÑ”­’ = BASIC_PATH . substr($b«ÚÑ”­’, 2); } $EÃåæÇ„Ö‚ = KodIO::clear($EÃåæÇ„Ö‚); goto f™‡ö¦Š­ˆ; D ë‘«½¿: return $this->pathDriver . $a¸š·ÈÆè[8] . ltrim($b«ÚÑ”­’, $a¸š·ÈÆè[8]); goto cˆ­êÙˆøÁ; cˆ­êÙˆøÁ: } public function mkfile($FŠÚÂíˆÃ, $Eîå˜Ùì¤º = '', $D†ƒœ¡’ = REPEAT_RENAME) { $FŠÚÂíˆÃ = $this->iconvSystem($FŠÚÂíˆÃ); @touch($FŠÚÂíˆÃ); if ($Eîå˜Ùì¤º) { file_put_contents($FŠÚÂíˆÃ, $Eîå˜Ùì¤º); } @chmod($FŠÚÂíˆÃ, $this->pathAuth); return is_file($FŠÚÂíˆÃ) ? $this->getPathOuter($FŠÚÂíˆÃ) : !1; } public function mkdir($fåÚ‘˜ëµ, $a¬‚«é°õõ = REPEAT_SKIP) { $fåÚ‘˜ëµ = $this->iconvSystem($fåÚ‘˜ëµ); if (is_dir($fåÚ‘˜ëµ)) { return $this->getPathOuter($fåÚ‘˜ëµ); } @mkdir($fåÚ‘˜ëµ, $this->pathAuth, !0); @chmod($fåÚ‘˜ëµ, $this->pathAuth); return is_dir($fåÚ‘˜ëµ) ? $this->getPathOuter($fåÚ‘˜ëµ) : !1; } public function copyFile($A¶—Ú™”¬, $eğ‡ì«½˜) { $this->mkdir($this->pathFather($eğ‡ì«½˜)); $A¶—Ú™”¬ = $this->iconvSystem($A¶—Ú™”¬); $eğ‡ì«½˜ = $this->iconvSystem($eğ‡ì«½˜); $Cï—É”äæ = copy_64($A¶—Ú™”¬, $eğ‡ì«½˜); @chmod($eğ‡ì«½˜, $this->pathAuth); return $Cï—É”äæ ? $this->getPathOuter($eğ‡ì«½˜) : !1; } public function moveFile($AÇä–¸Õ¸, $Fï×à´ñ¾¶) { goto A÷é‚®‘Ğê; A÷é‚®‘Ğê: $this->mkdir($this->pathFather($Fï×à´ñ¾¶)); $AÇä–¸Õ¸ = $this->iconvSystem($AÇä–¸Õ¸); $Fï×à´ñ¾¶ = $this->iconvSystem($Fï×à´ñ¾¶); goto DÎÁ®ô®Ü¦; DÎÁ®ô®Ü¦: $C…æªÉ” = intval(@rename($AÇä–¸Õ¸, $Fï×à´ñ¾¶)); if (!$C…æªÉ”) { if ($C…æªÉ” = intval(@copy_64($AÇä–¸Õ¸, $Fï×à´ñ¾¶))) { @unlink($AÇä–¸Õ¸); } } @chmod($Fï×à´ñ¾¶, $this->pathAuth); goto bÂîÍÓÇŸâ; bÂîÍÓÇŸâ: return $C…æªÉ” ? $this->getPathOuter($Fï×à´ñ¾¶) : !1; goto f«°ì³ß£; f«°ì³ß£: } public function delFile($Fèô³êŠº) { $Fèô³êŠº = $this->iconvSystem($Fèô³êŠº); if (!@unlink($Fèô³êŠº)) { @chmod($Fèô³êŠº, $this->pathAuth); if (!@unlink($Fèô³êŠº)) { return !1; } } else { return !0; } } public function delFolder($eÈÅ¯Ö…ø) { goto dÓÊÇ³Æ±’; f¼¹·‘¦: return rmdir($eÈÅ¯Ö…ø); goto dÏÃÆ¨¨¶Û; e´³Œ¯‚ïŒ: if (!($b¼Ä•»¯‡ = opendir($eÈÅ¯Ö…ø))) { return !1; } while (($b®×‚Îˆ¼í = readdir($b¼Ä•»¯‡)) !== !1) { if ($b®×‚Îˆ¼í == $Eç§º…˜Ùï[95] || $b®×‚Îˆ¼í == $Eç§º…˜Ùï[1285]) { continue; } $C±ŸÁò“Ô = $eÈÅ¯Ö…ø . $Eç§º…˜Ùï[8] . $b®×‚Îˆ¼í; if (is_file($C±ŸÁò“Ô) || is_link($C±ŸÁò“Ô)) { if (!unlink($C±ŸÁò“Ô)) { chmod($C±ŸÁò“Ô, $this->pathAuth); if (!unlink($C±ŸÁò“Ô)) { return !1; } } } else { if (is_dir($C±ŸÁò“Ô)) { chmod($C±ŸÁò“Ô, $this->pathAuth); $C±ŸÁò“Ô = $this->iconvApp($C±ŸÁò“Ô); if (!$this->delFolder($C±ŸÁò“Ô)) { return !1; } } } } closedir($b¼Ä•»¯‡); goto f¼¹·‘¦; dÓÊÇ³Æ±’: $Eç§º…˜Ùï =& $_SERVER[©äõ½¡]; $eÈÅ¯Ö…ø = $this->iconvSystem($eÈÅ¯Ö…ø); if (!is_dir($eÈÅ¯Ö…ø)) { return !0; } goto e´³Œ¯‚ïŒ; dÏÃÆ¨¨¶Û: } public function rename($F„ùÉÛÊã™, $dòòÃñÃæ´) { goto fé‰ˆ–Ë†; eë¾œÀŒÆˆ: $F„ùÉÛÊã™ = $this->iconvSystem($F„ùÉÛÊã™); $f¤õªÊó•‘ = $this->pathFather($F„ùÉÛÊã™); $f¾Èáèº‚ = rtrim($f¤õªÊó•‘, $fƒ÷á«Î×[8]) . $fƒ÷á«Î×[8] . $bî¶Õ°Ü¾¥; goto bó§´Ü¹Ç„; fé‰ˆ–Ë†: $fƒ÷á«Î× =& $_SERVER[©äõ½¡]; $bî¶Õ°Ü¾¥ = $this->fileNameAuto($this->pathFather($F„ùÉÛÊã™), $dòòÃñÃæ´); $bî¶Õ°Ü¾¥ = $this->iconvSystem($bî¶Õ°Ü¾¥); goto eë¾œÀŒÆˆ; bó§´Ü¹Ç„: $Eœ³àêÃø = @rename($F„ùÉÛÊã™, $f¾Èáèº‚); $f¾Èáèº‚ = $this->iconvApp($f¾Èáèº‚); return $Eœ³àêÃø ? $this->getPathOuter($f¾Èáèº‚) : !1; goto B¤Ü¬£‡ä­; B¤Ü¬£‡ä­: } public function size($cÆ¡âÑåØí) { $cÆ¡âÑåØí = $this->iconvSystem($cÆ¡âÑåØí); return filesize_64($cÆ¡âÑåØí); } public function info($C²ìĞÊ‚„ˆ) { $C²ìĞÊ‚„ˆ = $this->iconvSystem($C²ìĞÊ‚„ˆ); if ($this->isFolder($C²ìĞÊ‚„ˆ)) { return $this->folderInfo($C²ìĞÊ‚„ˆ); } else { if ($this->isFile($C²ìĞÊ‚„ˆ)) { return $this->fileInfo($C²ìĞÊ‚„ˆ); } } return !1; } protected function infoChildren($D®Õ¼•‚ÕŒ, &$CÅ¡“« ²†, $EĞØ‰³—´ = true) { goto DÈÂİğÓº¡; eÌÓœ¶„ƒ•: closedir($e‘Ÿ‰Ú¤¤); goto b®½âÇ‰å‘; DÈÂİğÓº¡: $dË›ÓÒİô« =& $_SERVER[©äõ½¡]; check_abort_echo(); $D®Õ¼•‚ÕŒ = rtrim($D®Õ¼•‚ÕŒ, $dË›ÓÒİô«[8]) . $dË›ÓÒİô«[8]; goto F‚™œé±ë; F‚™œé±ë: if ($EĞØ‰³—´) { $D®Õ¼•‚ÕŒ = $this->iconvSystem($D®Õ¼•‚ÕŒ); } if (!($e‘Ÿ‰Ú¤¤ = @opendir($D®Õ¼•‚ÕŒ))) { return; } while (($F˜ñì™Ù¬ = readdir($e‘Ÿ‰Ú¤¤)) !== !1) { if ($F˜ñì™Ù¬ == $dË›ÓÒİô«[95] || $F˜ñì™Ù¬ == $dË›ÓÒİô«[1285]) { continue; } $b–»“óÛ—Œ = $D®Õ¼•‚ÕŒ . $F˜ñì™Ù¬; if (is_file($b–»“óÛ—Œ) || is_link($b–»“óÛ—Œ)) { $CÅ¡“« ²†[$dË›ÓÒİô«[79]]++; $CÅ¡“« ²†[$dË›ÓÒİô«[78]] += filesize_64($b–»“óÛ—Œ); } else { if (is_dir($b–»“óÛ—Œ)) { $CÅ¡“« ²†[$dË›ÓÒİô«[80]]++; $this->infoChildren($b–»“óÛ—Œ, $CÅ¡“« ²†, !1); } } } goto eÌÓœ¶„ƒ•; b®½âÇ‰å‘: } private function folderInfo($aŸ•Ö·àãÅ, $cñÒº’‰“ = false) { $AöÌ‹È¥†õ =& $_SERVER[©äõ½¡]; $aŸ•Ö·àãÅ = rtrim($aŸ•Ö·àãÅ, $AöÌ‹È¥†õ[8]) . $AöÌ‹È¥†õ[8]; $B ¬î©ÂÔ” = $this->iconvApp($this->pathThis($aŸ•Ö·àãÅ)); if ($cñÒº’‰“) { return array($AöÌ‹È¥†õ[28] => $B ¬î©ÂÔ”, $AöÌ‹È¥†õ[76] => $this->getPathOuter($aŸ•Ö·àãÅ), $AöÌ‹È¥†õ[29] => $AöÌ‹È¥†õ[77]); } $aäÂÄĞ¼ = array($AöÌ‹È¥†õ[28] => $B ¬î©ÂÔ”, $AöÌ‹È¥†õ[76] => $this->getPathOuter($aŸ•Ö·àãÅ), $AöÌ‹È¥†õ[29] => $AöÌ‹È¥†õ[77], $AöÌ‹È¥†õ[194] => @filectime($aŸ•Ö·àãÅ), $AöÌ‹È¥†õ[84] => @filemtime($aŸ•Ö·àãÅ), $AöÌ‹È¥†õ[1288] => @fileatime($aŸ•Ö·àãÅ), $AöÌ‹È¥†õ[1289] => is_readable($aŸ•Ö·àãÅ), $AöÌ‹È¥†õ[1290] => is_writable($aŸ•Ö·àãÅ), $AöÌ‹È¥†õ[1291] => get_mode($aŸ•Ö·àãÅ)); return $aäÂÄĞ¼; } private function fileInfo($d‹¬®ö‘ä£, $aÓØø¹Ìõ = false) { $e…Îæí…Ô‹ =& $_SERVER[©äõ½¡]; $dÍ×Èàãâ = $this->iconvApp($this->pathThis($d‹¬®ö‘ä£)); if ($aÓØø¹Ìõ) { return array($e…Îæí…Ô‹[28] => $dÍ×Èàãâ, $e…Îæí…Ô‹[76] => $this->getPathOuter($d‹¬®ö‘ä£), $e…Îæí…Ô‹[29] => $e…Îæí…Ô‹[193], $e…Îæí…Ô‹[78] => $this->size($d‹¬®ö‘ä£), $e…Îæí…Ô‹[168] => $this->ext($dÍ×Èàãâ)); } $C¬–…³¾Ûµ = array($e…Îæí…Ô‹[28] => $dÍ×Èàãâ, $e…Îæí…Ô‹[76] => $this->getPathOuter($d‹¬®ö‘ä£), $e…Îæí…Ô‹[29] => $e…Îæí…Ô‹[193], $e…Îæí…Ô‹[194] => @filectime($d‹¬®ö‘ä£), $e…Îæí…Ô‹[84] => @filemtime($d‹¬®ö‘ä£), $e…Îæí…Ô‹[1288] => @fileatime($d‹¬®ö‘ä£), $e…Îæí…Ô‹[78] => $this->size($d‹¬®ö‘ä£), $e…Îæí…Ô‹[168] => $this->ext($dÍ×Èàãâ), $e…Îæí…Ô‹[1289] => is_readable($d‹¬®ö‘ä£), $e…Îæí…Ô‹[1290] => is_writable($d‹¬®ö‘ä£), $e…Îæí…Ô‹[1291] => get_mode($d‹¬®ö‘ä£)); return $C¬–…³¾Ûµ; } public function exist($FÜ¿õ‚ï¿‹) { $FÜ¿õ‚ï¿‹ = $this->iconvSystem($FÜ¿õ‚ï¿‹); return @file_exists($FÜ¿õ‚ï¿‹); } public function isFile($FÃâÏÕ‘Ã) { $FÃâÏÕ‘Ã = $this->iconvSystem($FÃâÏÕ‘Ã); return @is_file($FÃâÏÕ‘Ã); } public function isFolder($EÙ©š°˜è) { $EÙ©š°˜è = $this->iconvSystem($EÙ©š°˜è); return @is_dir($EÙ©š°˜è); } public function listPath($f¬áé·ùÂ, $E™¦îĞ›èâ = false) { goto BÉÌ„ÀÊñˆ; Aƒ‚Œ¿…ƒµ: closedir($d’ùäˆÕÛ„); return $eÊ¹ø…Ş³à; goto b¤ì¯…Úô; BÉÌ„ÀÊñˆ: $cÙì…éºÑ§ =& $_SERVER[©äõ½¡]; $f¬áé·ùÂ = $this->iconvSystem($f¬áé·ùÂ); $f¬áé·ùÂ = rtrim($f¬áé·ùÂ, $cÙì…éºÑ§[8]) . $cÙì…éºÑ§[8]; goto Cƒ¾ˆÊ¶ˆì; Cƒ¾ˆÊ¶ˆì: $eÊ¹ø…Ş³à = array($cÙì…éºÑ§[75] => array(), $cÙì…éºÑ§[74] => array()); if (!($d’ùäˆÕÛ„ = @opendir($f¬áé·ùÂ))) { return $eÊ¹ø…Ş³à; } while (($CÏ‚¡°—Í = readdir($d’ùäˆÕÛ„)) !== !1) { if ($CÏ‚¡°—Í == $cÙì…éºÑ§[95] || $CÏ‚¡°—Í == $cÙì…éºÑ§[1285]) { continue; } $eÂ¯õ¡Ç² = $f¬áé·ùÂ . $CÏ‚¡°—Í; if (is_file($eÂ¯õ¡Ç²)) { $eÊ¹ø…Ş³à[$cÙì…éºÑ§[74]][] = $this->fileInfo($eÂ¯õ¡Ç², $E™¦îĞ›èâ); } else { $eÊ¹ø…Ş³à[$cÙì…éºÑ§[75]][] = $this->folderInfo($eÂ¯õ¡Ç², $E™¦îĞ›èâ); } } goto Aƒ‚Œ¿…ƒµ; b¤ì¯…Úô: } public function listAll($Cƒçï†Í»­, &$cÖĞÆ°¤” = array()) { goto b·ä•ª—Âá; b·ä•ª—Âá: $b¡‚Ä‚áÀÈ =& $_SERVER[©äõ½¡]; $Cƒçï†Í»­ = $this->iconvSystem($Cƒçï†Í»­); $Cƒçï†Í»­ = rtrim($Cƒçï†Í»­, $b¡‚Ä‚áÀÈ[8]) . $b¡‚Ä‚áÀÈ[8]; goto cä¬åæ‚¿Ù; cä¬åæ‚¿Ù: if (!($FİÏ›¯ĞÚÅ = @opendir($Cƒçï†Í»­))) { return $cÖĞÆ°¤”; } while (($aİ·ù²„­ = readdir($FİÏ›¯ĞÚÅ)) !== !1) { if ($aİ·ù²„­ == $b¡‚Ä‚áÀÈ[95] || $aİ·ù²„­ == $b¡‚Ä‚áÀÈ[1285]) { continue; } $fäù–›ˆÃ§ = $Cƒçï†Í»­ . $aİ·ù²„­; if (is_dir($fäù–›ˆÃ§) && !is_link($fäù–›ˆÃ§)) { $cÖĞÆ°¤”[] = array($b¡‚Ä‚áÀÈ[76] => $fäù–›ˆÃ§ . $b¡‚Ä‚áÀÈ[8], $b¡‚Ä‚áÀÈ[77] => 1, $b¡‚Ä‚áÀÈ[84] => @filemtime($fäù–›ˆÃ§), $b¡‚Ä‚áÀÈ[78] => 0); $this->listAll($fäù–›ˆÃ§, $cÖĞÆ°¤”); } else { $cÖĞÆ°¤”[] = array($b¡‚Ä‚áÀÈ[76] => $fäù–›ˆÃ§, $b¡‚Ä‚áÀÈ[77] => 0, $b¡‚Ä‚áÀÈ[84] => @filemtime($fäù–›ˆÃ§), $b¡‚Ä‚áÀÈ[78] => $this->size($fäù–›ˆÃ§)); } } closedir($FİÏ›¯ĞÚÅ); goto CãÓŒğ ¶¦; CãÓŒğ ¶¦: return $cÖĞÆ°¤”; goto bíÕÃäù¬’; bíÕÃäù¬’: } public function has($E¾ŸĞ„—É, $Aİæİ–¦‘ = false, $B£Ê’ˆ¼ìË = true) { goto DŠŸÄ°«§; DİÏõ–‹¡ø: if (!($dƒ —¬«‰ô = @opendir($E¾ŸĞ„—É))) { return !1; } $b¹«ùˆ™ØÕ = 0; $E£„¹æµˆ = 0; goto aÛÉ‘µ”š“; aÛÉ‘µ”š“: $B¢‹¶ª¡… = 0; while (($fíšœ¶Œª‹ = readdir($dƒ —¬«‰ô)) !== !1) { if ($fíšœ¶Œª‹ == $B‹»ÒãŞœ¸[95] || $fíšœ¶Œª‹ == $B‹»ÒãŞœ¸[1285]) { continue; } $e‚ÇÄ‹¶äÀ = $E¾ŸĞ„—É . $fíšœ¶Œª‹; if ($Aİæİ–¦‘) { $B¢‹¶ª¡…++; if (@is_file($e‚ÇÄ‹¶äÀ)) { $b¹«ùˆ™ØÕ++; } else { $E£„¹æµˆ++; } if ($B¢‹¶ª¡… > 10000) { break; } continue; } if ($B£Ê’ˆ¼ìË) { if (@is_file($e‚ÇÄ‹¶äÀ)) { return !0; } } else { if (@is_dir($e‚ÇÄ‹¶äÀ . $B‹»ÒãŞœ¸[8])) { return !0; } } } closedir($dƒ —¬«‰ô); goto CõÉ³Ê§ó; DŠŸÄ°«§: $B‹»ÒãŞœ¸ =& $_SERVER[©äõ½¡]; $E¾ŸĞ„—É = $this->iconvSystem($E¾ŸĞ„—É); $E¾ŸĞ„—É = rtrim($E¾ŸĞ„—É, $B‹»ÒãŞœ¸[8]) . $B‹»ÒãŞœ¸[8]; goto DİÏõ–‹¡ø; CõÉ³Ê§ó: if ($Aİæİ–¦‘) { return array($B‹»ÒãŞœ¸[203] => $b¹«ùˆ™ØÕ, $B‹»ÒãŞœ¸[204] => $E£„¹æµˆ); } return !1; goto c›ø»„àĞ²; c›ø»„àĞ²: } public function hashSimple($d ÷êôÓ„Ù) { goto c­—ïÌùîÚ; eë§Ìô‰Û: fseek_64($dùÜò²–ÊÇ, $aöî©äˆ± - $AÔÓÂåî­); $C³êªòËÁ° .= fread($dùÜò²–ÊÇ, $AÔÓÂåî­); fclose($dùÜò²–ÊÇ); goto fŒˆá‹à›Ú; AÓÆä¤‘¼›: $aöî©äˆ± = $this->size($d ÷êôÓ„Ù); $AÔÓÂåî­ = 200; $BòàÌÊ¬’ = 50; goto C•–Éà³Œ³; c­—ïÌùîÚ: $bš…‘©ÒŸô =& $_SERVER[©äõ½¡]; if (!$d ÷êôÓ„Ù) { return md5($bš…‘©ÒŸô[33]); } $d ÷êôÓ„Ù = $this->iconvSystem($d ÷êôÓ„Ù); goto AÓÆä¤‘¼›; C•–Éà³Œ³: if ($aöî©äˆ± <= $AÔÓÂåî­ * $BòàÌÊ¬’) { return $this->hashMd5($d ÷êôÓ„Ù) . $aöî©äˆ±; } $C³êªòËÁ° = $bš…‘©ÒŸô[33]; $aìñ¾‘”Òº = intval($aöî©äˆ± / $BòàÌÊ¬’); goto fË¬ÁÃÂÊ; fË¬ÁÃÂÊ: $dùÜò²–ÊÇ = fopen($d ÷êôÓ„Ù, $bš…‘©ÒŸô[1292]); if (!$dùÜò²–ÊÇ) { return $C³êªòËÁ°; } for ($fÊ´â»ÏÇè = 0; $fÊ´â»ÏÇè < $BòàÌÊ¬’; $fÊ´â»ÏÇè++) { fseek_64($dùÜò²–ÊÇ, $aìñ¾‘”Òº * $fÊ´â»ÏÇè); $C³êªòËÁ° .= fread($dùÜò²–ÊÇ, $AÔÓÂåî­); } goto eë§Ìô‰Û; fŒˆá‹à›Ú: return md5($C³êªòËÁ°) . $aöî©äˆ±; goto F°â¾ñãÖÖ; F°â¾ñãÖÖ: } public function getContent($aáØÏòƒ‡’) { $aáØÏòƒ‡’ = $this->iconvSystem($aáØÏòƒ‡’); return file_get_contents($aáØÏòƒ‡’); } public function setContent($DäÜ¸œˆ‰, $Aêí™ŠáºÍ = '') { $DäÜ¸œˆ‰ = $this->iconvSystem($DäÜ¸œˆ‰); $E¥÷¬ã—Ëö = @file_put_contents($DäÜ¸œˆ‰, $Aêí™ŠáºÍ, LOCK_EX); clearstatcache(); @chmod($DäÜ¸œˆ‰, $this->pathAuth); return $E¥÷¬ã—Ëö === !1 ? !1 : !0; } public function fileSubstr($fÁãÊ¤£÷Â, $B°´ ‚Ú‡ = 0, $a­’…Î­î¢ = false) { goto b¤ÖÙõáâ‹; b¤ÖÙõáâ‹: $C‚í›¬äÌ =& $_SERVER[©äõ½¡]; $fÁãÊ¤£÷Â = $this->iconvSystem($fÁãÊ¤£÷Â); if ($a­’…Î­î¢ === !1) { $a­’…Î­î¢ = $this->size($fÁãÊ¤£÷Â); } goto fïİ¨‰Û‹; A„ùº¯ìÄ: return $e¸âÙ”¥Ç”; goto CÒÜ¯è‚Œ©; fïİ¨‰Û‹: if ($a­’…Î­î¢ <= 0) { return $C‚í›¬äÌ[33]; } $eœ–¢­ùÏ· = fopen($fÁãÊ¤£÷Â, $C‚í›¬äÌ[1292]); if (!$eœ–¢­ùÏ·) { return !1; } goto fÖƒ‰¦ÌÂ­; fÖƒ‰¦ÌÂ­: fseek_64($eœ–¢­ùÏ·, $B°´ ‚Ú‡); $e¸âÙ”¥Ç” = fread($eœ–¢­ùÏ·, $a­’…Î­î¢); fclose($eœ–¢­ùÏ·); goto A„ùº¯ìÄ; CÒÜ¯è‚Œ©: } public function upload($eÙÕæâØæ¹, $CŠé©÷‚ø·, $dÈ£·÷ÂÎ = false, $C•÷Ôäµãé = REPEAT_REPLACE) { if ($dÈ£·÷ÂÎ) { return $this->moveFile($CŠé©÷‚ø·, $eÙÕæâØæ¹); } return $this->copyFile($CŠé©÷‚ø·, $eÙÕæâØæ¹); } public function setModifyTime($E¿ ¤óÌôÂ, $BÖ…íù¨º = '') { @touch($E¿ ¤óÌôÂ, intval($BÖ…íù¨º)); } public function download($d¤†°¬ÓŒÎ, $bò•ñÒÌÅ) { return $this->iconvSystem($d¤†°¬ÓŒÎ); } } goto B“î”½²„•; Fè­‹¿¸·: class TaskFileTransfer extends Task { protected function startAfter() { goto eñäšğµ¥Ÿ; AÄ¾ÜÍ‰ùË: Hook::bind($ağ¨·ä´çÊ[596], array($this, $ağ¨·ä´çÊ[1597])); Hook::bind($ağ¨·ä´çÊ[562], array($this, $ağ¨·ä´çÊ[1598])); Hook::bind($ağ¨·ä´çÊ[559], array($this, $ağ¨·ä´çÊ[1598])); goto d¬–”õÂŒ”; E“×ÑÚ™ã¬: $EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1608]] = LNG($ağ¨·ä´çÊ[1609]); $EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1610]] = 0; $EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1611]] = 0; goto F×ø”¾©ŞÜ; DÌƒÒ’óƒÇ: Hook::bind($ağ¨·ä´çÊ[1599], array($this, $ağ¨·ä´çÊ[1600])); Hook::bind($ağ¨·ä´çÊ[585], array($this, $ağ¨·ä´çÊ[1601])); $this->sourceModelCopyFlag = !1; goto fè®Ãš² ‚; fè®Ãš² ‚: Hook::bind($ağ¨·ä´çÊ[1602], array($this, $ağ¨·ä´çÊ[1603])); Hook::bind($ağ¨·ä´çÊ[1604], array($this, $ağ¨·ä´çÊ[1605])); Hook::bind($ağ¨·ä´çÊ[1606], array($this, $ağ¨·ä´çÊ[1607])); goto E“×ÑÚ™ã¬; F×ø”¾©ŞÜ: $EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1057]] = $ağ¨·ä´çÊ[33]; $EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1612]] = $ağ¨·ä´çÊ[33]; $EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1613]] = 0; goto FÆèçÇÃ¹; eñäšğµ¥Ÿ: $ağ¨·ä´çÊ =& $_SERVER[©äõ½¡]; $EÙÒ½¼¥õŸ =& $this->task; $this->sourceCopyFolder = !1; goto FååôâÚ„„; FÆèçÇÃ¹: $EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1614]] = 0; $EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1615]] = 0; if (!$EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1465]]) { $EÙÒ½¼¥õŸ[$ağ¨·ä´çÊ[1465]] = LNG($ağ¨·ä´çÊ[1616]); } goto A‹¬×ŒŸÔ; FååôâÚ„„: Hook::bind($ağ¨·ä´çÊ[1590], array($this, $ağ¨·ä´çÊ[1591])); Hook::bind($ağ¨·ä´çÊ[1143], array($this, $ağ¨·ä´çÊ[1592])); Hook::bind($ağ¨·ä´çÊ[1593], array($this, $ağ¨·ä´çÊ[1594])); goto DæÄ²˜¤Ñ±; d¬–”õÂŒ”: Hook::bind($ağ¨·ä´çÊ[564], array($this, $ağ¨·ä´çÊ[1598])); Hook::bind($ağ¨·ä´çÊ[566], array($this, $ağ¨·ä´çÊ[1598])); Hook::bind($ağ¨·ä´çÊ[568], array($this, $ağ¨·ä´çÊ[1598])); goto DÌƒÒ’óƒÇ; DæÄ²˜¤Ñ±: Hook::bind($ağ¨·ä´çÊ[592], array($this, $ağ¨·ä´çÊ[1595])); Hook::bind($ağ¨·ä´çÊ[593], array($this, $ağ¨·ä´çÊ[1596])); Hook::bind($ağ¨·ä´çÊ[595], array($this, $ağ¨·ä´çÊ[1597])); goto AÄ¾ÜÍ‰ùË; A‹¬×ŒŸÔ: } protected function endAfter() { goto bùë¸‚ï¼ª; A Š·ÔêÔè: Hook::unbind($Aìö Â¦Í­[568], array($this, $Aìö Â¦Í­[1598])); Hook::unbind($Aìö Â¦Í­[1599], array($this, $Aìö Â¦Í­[1600])); Hook::unbind($Aìö Â¦Í­[585], array($this, $Aìö Â¦Í­[1601])); goto Eİ•°; Fàğ¿ÍÀ‚ã: Hook::unbind($Aìö Â¦Í­[559], array($this, $Aìö Â¦Í­[1598])); Hook::unbind($Aìö Â¦Í­[564], array($this, $Aìö Â¦Í­[1598])); Hook::unbind($Aìö Â¦Í­[566], array($this, $Aìö Â¦Í­[1598])); goto A Š·ÔêÔè; bùë¸‚ï¼ª: $Aìö Â¦Í­ =& $_SERVER[©äõ½¡]; Hook::unbind($Aìö Â¦Í­[1590], array($this, $Aìö Â¦Í­[1591])); Hook::unbind($Aìö Â¦Í­[1143], array($this, $Aìö Â¦Í­[1592])); goto F¢º¿öòÂÃ; F¢º¿öòÂÃ: Hook::unbind($Aìö Â¦Í­[1593], array($this, $Aìö Â¦Í­[1594])); Hook::unbind($Aìö Â¦Í­[592], array($this, $Aìö Â¦Í­[1595])); Hook::unbind($Aìö Â¦Í­[593], array($this, $Aìö Â¦Í­[1596])); goto E—ºç‹›Ãõ; Eİ•°: Hook::unbind($Aìö Â¦Í­[1602], array($this, $Aìö Â¦Í­[1603])); Hook::unbind($Aìö Â¦Í­[1604], array($this, $Aìö Â¦Í­[1605])); Hook::unbind($Aìö Â¦Í­[1606], array($this, $Aìö Â¦Í­[1607])); goto cô©Ï÷óù; E—ºç‹›Ãõ: Hook::unbind($Aìö Â¦Í­[595], array($this, $Aìö Â¦Í­[1597])); Hook::unbind($Aìö Â¦Í­[596], array($this, $Aìö Â¦Í­[1597])); Hook::unbind($Aìö Â¦Í­[562], array($this, $Aìö Â¦Í­[1598])); goto Fàğ¿ÍÀ‚ã; cô©Ï÷óù: } public function copyMoveStart($B÷‰Òá­øŒ, $Fùõ´ˆó‰¼, $dˆùÀÃ½äÒ, $D‚¿ÑÍÎç‘) { goto A¨ôŞºœ÷; cÙ¼¡Üßì¸: $A‚Î½Í’Æ‹[$b†ƒÅØ˜ó¯[1618]] = KodIO::transferType($B÷‰Òá­øŒ, $dˆùÀÃ½äÒ); $this->update(); goto dèÍ„Ó„ˆÏ; A¨ôŞºœ÷: $b†ƒÅØ˜ó¯ =& $_SERVER[©äõ½¡]; self::log($b†ƒÅØ˜ó¯[1617] . $Fùõ´ˆó‰¼ . $b†ƒÅØ˜ó¯[67] . $D‚¿ÑÍÎç‘); $fÁÆ´–Ã°à = rtrim(TEMP_FILES, $b†ƒÅØ˜ó¯[8]); goto d¼‹ĞóğŠ; d¼‹ĞóğŠ: if (substr($Fùõ´ˆó‰¼, 0, strlen($fÁÆ´–Ã°à)) == $fÁÆ´–Ã°à) { return; } if (substr($D‚¿ÑÍÎç‘, 0, strlen($fÁÆ´–Ã°à)) == $fÁÆ´–Ã°à) { return; } $A‚Î½Í’Æ‹ =& $this->task; goto cÙ¼¡Üßì¸; dèÍ„Ó„ˆÏ: } public function updateAfter() { $f­çó—íÇÅ =& $_SERVER[©äõ½¡]; $e¤Û‚ˆÇï =& $this->task; if (!$e¤Û‚ˆÇï[$f­çó—íÇÅ[758]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($e¤Û‚ˆÇï[$f­çó—íÇÅ[1618]] == $f­çó—íÇÅ[1216]) { return; } self::updateTask($e¤Û‚ˆÇï); } private static function updateTask(&$FŠ†Şâ¸…Ü) { $eÈî®Å¦Œâ =& $_SERVER[©äõ½¡]; if ($FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1618]] == $eÈî®Å¦Œâ[1127] || $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1618]] == $eÈî®Å¦Œâ[107]) { if ($FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1612]]) { $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1615]] = $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1614]] + $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1611]]; } } else { if ($FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1618]] == $eÈî®Å¦Œâ[1217]) { if ($FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1612]] == $eÈî®Å¦Œâ[1127]) { $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1615]] = $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1614]] + $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1611]] * 0.5; } else { if ($FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1612]] == $eÈî®Å¦Œâ[107]) { $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1615]] = $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1614]] + $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1610]] * 0.5 + $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1611]] * 0.5; } } } } $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1565]] = $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1615]] / $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[758]]; if ($FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1565]] > 0) { $Bœ¢ÖÛ¥¢Ç = timeFloat() - $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[784]] - $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1568]]; $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1569]] = $Bœ¢ÖÛ¥¢Ç * (1 - $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1565]]) / $FŠ†Şâ¸…Ü[$eÈî®Å¦Œâ[1565]]; } } public function addPath($fÀ»ĞÜÁªŸ) { goto F¢©À õ˜; Fäò®‡ãğ›: $D÷Ã†ëÂ³ = IO::infoWithChildren($fÀ»ĞÜÁªŸ); $béÏÇïŒÆÃ = $f­ö­Œµ—[$bí—šÁÕµÂ[1619]] ? $f­ö­Œµ—[$bí—šÁÕµÂ[1619]][$bí—šÁÕµÂ[1620]] : 0; $f­ö­Œµ—[$bí—šÁÕµÂ[1619]] = array($bí—šÁÕµÂ[1620] => $béÏÇïŒÆÃ + 1, $bí—šÁÕµÂ[415] => $D÷Ã†ëÂ³[$bí—šÁÕµÂ[28]], $bí—šÁÕµÂ[76] => $D÷Ã†ëÂ³[$bí—šÁÕµÂ[76]], $bí—šÁÕµÂ[513] => $D÷Ã†ëÂ³[$bí—šÁÕµÂ[513]] ? $D÷Ã†ëÂ³[$bí—šÁÕµÂ[513]] : $D÷Ã†ëÂ³[$bí—šÁÕµÂ[76]]); goto CÉ–•¾“…¦; CÉ–•¾“…¦: if ($D÷Ã†ëÂ³[$bí—šÁÕµÂ[29]] == $bí—šÁÕµÂ[193]) { $f­ö­Œµ—[$bí—šÁÕµÂ[1055]] += 1; } else { $f­ö­Œµ—[$bí—šÁÕµÂ[1055]] += $D÷Ã†ëÂ³[$bí—šÁÕµÂ[81]][$bí—šÁÕµÂ[79]]; if ($D÷Ã†ëÂ³[$bí—šÁÕµÂ[397]]) { $f­ö­Œµ—[$bí—šÁÕµÂ[1055]] += $D÷Ã†ëÂ³[$bí—šÁÕµÂ[81]][$bí—šÁÕµÂ[80]] + 1; } } $f­ö­Œµ—[$bí—šÁÕµÂ[758]] += $D÷Ã†ëÂ³[$bí—šÁÕµÂ[78]]; $this->update(); goto A‰‡òù‰âÀ; F¢©À õ˜: $bí—šÁÕµÂ =& $_SERVER[©äõ½¡]; if (!$fÀ»ĞÜÁªŸ) { return; } $f­ö­Œµ— =& $this->task; goto Fäò®‡ãğ›; A‰‡òù‰âÀ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($dèåº‘ó) { $B¸°Ìº÷ŞÌ =& $_SERVER[©äõ½¡]; $bÒğœÍİÑ =& $this->task; $bÒğœÍİÑ[$B¸°Ìº÷ŞÌ[1608]] = $dèåº‘ó[$B¸°Ìº÷ŞÌ[28]]; $bÒğœÍİÑ[$B¸°Ìº÷ŞÌ[1057]] = $dèåº‘ó[$B¸°Ìº÷ŞÌ[28]]; $this->update(); } public function copyFileStart($a«‘ŞÂÕˆç, $eØ¯ˆëÉ, $E…ŠøÆãÃ—, $c¾ÃÅï“æ, $AÊ‚¯œÕ¥, $cÅˆÅˆô—÷) { goto A»å»İÃÉ×; EÛó‹ˆÃÎ: $GLOBALS[$aêÃ—[1622]] = $AÊ‚¯œÕ¥; $GLOBALS[$aêÃ—[1621]] = $cÅˆÅˆô—÷; $dšÄÛäåï =& $this->task; goto e†‘æÅÛÈÃ; dÏ‹°±Ş„“: $EñÉ¹¨¨ä¨ = $dšÄÛäåï[$aêÃ—[1610]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($dšÄÛäåï[$aêÃ—[395]] . $aêÃ—[1623]); if ($EñÉ¹¨¨ä¨ && file_exists(get_path_father($c¾ÃÅï“æ))) { Cache::set($dšÄÛäåï[$aêÃ—[395]] . $aêÃ—[1623], $c¾ÃÅï“æ); $dšÄÛäåï[$aêÃ—[1583]] = array($aêÃ—[1624], $aêÃ—[1625]); } goto F…³¦æÑØ; F…³¦æÑØ: $this->update(0, $EñÉ¹¨¨ä¨); goto a˜Æİå—³§; eæĞÔò”¼: $dšÄÛäåï[$aêÃ—[1057]] = $aêÃ—[33]; $dšÄÛäåï[$aêÃ—[1612]] = $aêÃ—[33]; $dšÄÛäåï[$aêÃ—[1613]] = 0; goto dÏ‹°±Ş„“; e†‘æÅÛÈÃ: $dšÄÛäåï[$aêÃ—[1608]] = $f¾È¼„éÚò; $dšÄÛäåï[$aêÃ—[1610]] = (int) $a«‘ŞÂÕˆç->size($eØ¯ˆëÉ); $dšÄÛäåï[$aêÃ—[1611]] = 0; goto eæĞÔò”¼; A»å»İÃÉ×: $aêÃ— =& $_SERVER[©äõ½¡]; $f¾È¼„éÚò = $AÊ‚¯œÕ¥; if ($f¾È¼„éÚò == $GLOBALS[$aêÃ—[1621]]) { $f¾È¼„éÚò = $GLOBALS[$aêÃ—[1622]]; } goto EÛó‹ˆÃÎ; a˜Æİå—³§: } public static function updateCopyLocalFileSize($dÖª’×À‚) { goto FŞôæÙ‘…; dñĞ÷êÕ‘: $dÖª’×À‚[$E•Ô´¸ÆÊÇ[1611]] = @filesize($fß‰Ìô˜ƒ’); $dÖª’×À‚[$E•Ô´¸ÆÊÇ[1615]] += $dÖª’×À‚[$E•Ô´¸ÆÊÇ[1611]]; self::updateTask($dÖª’×À‚); goto c³£¿æÅòö; c³£¿æÅòö: return $dÖª’×À‚; goto BæøÉÔ¢±á; FŞôæÙ‘…: $E•Ô´¸ÆÊÇ =& $_SERVER[©äõ½¡]; $fß‰Ìô˜ƒ’ = Cache::get($dÖª’×À‚[$E•Ô´¸ÆÊÇ[395]] . $E•Ô´¸ÆÊÇ[1623]); if (!$fß‰Ìô˜ƒ’ || !file_exists($fß‰Ìô˜ƒ’)) { return $dÖª’×À‚; } goto dñĞ÷êÕ‘; BæøÉÔ¢±á: } public function copyFileEnd($Bƒ¸áÍƒ…, $eµØ”Í‘, $EÑÚİ¬ˆä, $f“ñÎ­ò†Í, $B”„Ú†î»Ÿ, $c¸ÕğÕÇÜÀ) { goto Eª„¤µÑ§ì; dË–Â«ºß: $a´‡ïÓßîİ[$B„í ˜ïÛ£[1612]] = $B„í ˜ïÛ£[33]; unset($a´‡ïÓßîİ[$B„í ˜ïÛ£[1583]]); if ($B”„Ú†î»Ÿ == $a´‡ïÓßîİ[$B„í ˜ïÛ£[1608]]) { $a´‡ïÓßîİ[$B„í ˜ïÛ£[1614]] += $a´‡ïÓßîİ[$B„í ˜ïÛ£[1610]]; $a´‡ïÓßîİ[$B„í ˜ïÛ£[1615]] = $a´‡ïÓßîİ[$B„í ˜ïÛ£[1614]]; $this->update(1); } else { $this->update(); $a´‡ïÓßîİ[$B„í ˜ïÛ£[1611]] = 0; } goto d‚›Úè†Û‚; Eª„¤µÑ§ì: $B„í ˜ïÛ£ =& $_SERVER[©äõ½¡]; $a´‡ïÓßîİ =& $this->task; $a´‡ïÓßîİ[$B„í ˜ïÛ£[1611]] = $a´‡ïÓßîİ[$B„í ˜ïÛ£[1610]]; goto dË–Â«ºß; d‚›Úè†Û‚: Cache::remove($a´‡ïÓßîİ[$B„í ˜ïÛ£[395]] . $B„í ˜ïÛ£[1623]); self::log($B„í ˜ïÛ£[1626] . $eµØ”Í‘ . $B„í ˜ïÛ£[67] . $f“ñÎ­ò†Í . $B„í ˜ïÛ£[229] . $B”„Ú†î»Ÿ . $B„í ˜ïÛ£[1627] . $a´‡ïÓßîİ[$B„í ˜ïÛ£[1608]]); goto Fïğµ•ƒ’; Fïğµ•ƒ’: } public function updateFileEnd($fÂÃ£µÄ¡›, $b¾Ú’Ã×») { goto D·á³×ƒºŠ; D·á³×ƒºŠ: $BÜ…ÌÎ×î =& $_SERVER[©äõ½¡]; $AéÆ®ËÎšà =& $this->task; $AéÆ®ËÎšà[$BÜ…ÌÎ×î[1608]] = $fÂÃ£µÄ¡›; goto cùõ¯ï…ƒ; Bß˜Šš¥¬Æ: $this->update(1); self::log($BÜ…ÌÎ×î[1628] . $fÂÃ£µÄ¡›); goto aÃÂÑ£î; cùõ¯ï…ƒ: $AéÆ®ËÎšà[$BÜ…ÌÎ×î[1610]] = $b¾Ú’Ã×»; $AéÆ®ËÎšà[$BÜ…ÌÎ×î[1614]] += $b¾Ú’Ã×»; $AéÆ®ËÎšà[$BÜ…ÌÎ×î[1615]] = $AéÆ®ËÎšà[$BÜ…ÌÎ×î[1614]]; goto Bß˜Šš¥¬Æ; aÃÂÑ£î: } public function sourceModelCopy($Bî—«÷‡ó) { goto e„–ùˆÏ¡; e„–ùˆÏ¡: $c†˜­¿©¢Ì =& $_SERVER[©äõ½¡]; $dğ— Ìï¡² = $Bî—«÷‡ó[0]; $e¤ğª¨ĞË¹ = $Bî—«÷‡ó[1]; goto aî†¬Í¥“´; aî†¬Í¥“´: $e¿®ù‰×Ü =& $this->task; $this->sourceModelCopyFlag = !0; $F“Ä±Ô‹¤ = 0; goto a¨–ˆ‡×çª; a¨–ˆ‡×çª: switch ($dğ— Ìï¡²) { case $c†˜­¿©¢Ì[560]: $F“Ä±Ô‹¤ = 1; break; case $c†˜­¿©¢Ì[563]: $e¿®ù‰×Ü[$c†˜­¿©¢Ì[1608]] = $e¤ğª¨ĞË¹[$c†˜­¿©¢Ì[28]]; break; case $c†˜­¿©¢Ì[565]: $F“Ä±Ô‹¤ = intval($Bî—«÷‡ó[$c†˜­¿©¢Ì[378]] * 0.4); break; case $c†˜­¿©¢Ì[567]: $F“Ä±Ô‹¤ = intval($Bî—«÷‡ó[$c†˜­¿©¢Ì[378]] * 0.2); break; case $c†˜­¿©¢Ì[569]: $F“Ä±Ô‹¤ = intval($Bî—«÷‡ó[$c†˜­¿©¢Ì[378]] * 0.4); break; } $this->update($F“Ä±Ô‹¤); $this->sourceModelCopyFlag = !1; goto cê« ÚÚ‘; cê« ÚÚ‘: } public function sourceRemove($E¨Øˆ±Äå‘, $añˆÓÁµê‚) { $f±ƒÒÏ¥¬ò =& $_SERVER[©äõ½¡]; $this->sourceModelCopyFlag = !0; $B ¼¼—šŸº = 1; if (isset($E¨Øˆ±Äå‘[$f±ƒÒÏ¥¬ò[81]])) { $B ¼¼—šŸº = $E¨Øˆ±Äå‘[$f±ƒÒÏ¥¬ò[81]][$f±ƒÒÏ¥¬ò[79]] + $E¨Øˆ±Äå‘[$f±ƒÒÏ¥¬ò[81]][$f±ƒÒÏ¥¬ò[80]] + 1; } $this->update($B ¼¼—šŸº); $this->sourceModelCopyFlag = !1; } public function sourceMove($f‹ ’í¹£í) { $this->sourceRemove($f‹ ’í¹£í, !1); } public function curlProgress($AŸİÙ½ñ„÷, $båŒÜ¤Ü„Š, $DÉìË±§ì, $c›‘î«‚÷Ê, $eÓ½æ‰¯ô¼) { $AÊª”ƒÂñœ =& $_SERVER[©äõ½¡]; $A¨æ¨×¼®¿ =& $this->task; if ($eÓ½æ‰¯ô¼ > 0) { $A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1057]] = $AÊª”ƒÂñœ[1629]; $A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1612]] = $AÊª”ƒÂñœ[107]; if ($A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1610]]) { $A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1611]] = $eÓ½æ‰¯ô¼; } if ($A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1613]]) { $A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1611]] = $eÓ½æ‰¯ô¼ + $A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1613]]; } } else { if ($DÉìË±§ì > 0) { if ($A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1610]] == $båŒÜ¤Ü„Š) { $A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1611]] = $DÉìË±§ì; $A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1057]] = $AÊª”ƒÂñœ[1630]; $A¨æ¨×¼®¿[$AÊª”ƒÂñœ[1612]] = $AÊª”ƒÂñœ[1127]; } } } $this->update(); } public function curlProgressStart($a¢ï‹×Æ) { } public function curlProgressEnd($C¿‰‹òº™) { goto eƒ±±ã ­™; FÎ¿Êé‹ù: $this->update(); goto C…ŸÕó¨ª¸; fÁÔÛùœƒ½: $c¸ö¤†àˆ = $FŸ’Šà[$EÇĞ•¾è¤[1631]]; if ($c¸ö¤†àˆ == -1) { $c¸ö¤†àˆ = $FŸ’Šà[$EÇĞ•¾è¤[1632]]; } if ($Aë¨–ÈØÃ[$EÇĞ•¾è¤[1612]] == $EÇĞ•¾è¤[107] && $c¸ö¤†àˆ) { $Aë¨–ÈØÃ[$EÇĞ•¾è¤[1613]] += $c¸ö¤†àˆ; } goto FÎ¿Êé‹ù; eƒ±±ã ­™: $EÇĞ•¾è¤ =& $_SERVER[©äõ½¡]; $Aë¨–ÈØÃ =& $this->task; $FŸ’Šà = curl_getinfo($C¿‰‹òº™); goto fÁÔÛùœƒ½; C…ŸÕó¨ª¸: } } class TaskHttp extends Task { protected function startAfter() { $c”‘·¬‘Ê„ =& $_SERVER[©äõ½¡]; $AöÌƒÒ¾Ğà =& $this->task; $AöÌƒÒ¾Ğà[$c”‘·¬‘Ê„[1633]] = 1; Hook::bind($c”‘·¬‘Ê„[1602], array($this, $c”‘·¬‘Ê„[1634])); Hook::bind($c”‘·¬‘Ê„[1604], array($this, $c”‘·¬‘Ê„[1635])); Hook::bind($c”‘·¬‘Ê„[1606], array($this, $c”‘·¬‘Ê„[1636])); } protected function endAfter() { $F“³¯‘…Á =& $_SERVER[©äõ½¡]; Hook::unbind($F“³¯‘…Á[1602], array($this, $F“³¯‘…Á[1634])); Hook::unbind($F“³¯‘…Á[1604], array($this, $F“³¯‘…Á[1635])); Hook::unbind($F“³¯‘…Á[1606], array($this, $F“³¯‘…Á[1636])); } public function progressStart($dŸ‰®Å¡Ş) { $E–ÄñÚ¡µè =& $_SERVER[©äõ½¡]; $CÀ‰ôğëÓñ = curl_getinfo($dŸ‰®Å¡Ş); self::log($E–ÄñÚ¡µè[1637] . $CÀ‰ôğëÓñ[$E–ÄñÚ¡µè[305]]); self::valueSet($this->task[$E–ÄñÚ¡µè[395]], $this->task); } public function progressEnd($cõ‹ŞÒÙ„Ä) { $eç¡®¹ŒŸ‘ =& $_SERVER[©äõ½¡]; self::log($eç¡®¹ŒŸ‘[1638] . $this->task[$eç¡®¹ŒŸ‘[395]]); $this->end(); } public function progress($bÉêìŸ‚óÈ, $c‹‘¯¢å£, $EĞŠ‰²ñÀŠ, $fÎÁÂå’Æ¥, $c×›ğòíÎÈ) { $BõÌÃ´‹Û÷ =& $_SERVER[©äõ½¡]; $f ä– „­á =& $this->task; if ($c×›ğòíÎÈ > 0) { $f ä– „­á[$BõÌÃ´‹Û÷[1055]] = $f ä– „­á[$BõÌÃ´‹Û÷[1055]] == 0 ? $fÎÁÂå’Æ¥ : $f ä– „­á[$BõÌÃ´‹Û÷[1055]]; $f ä– „­á[$BõÌÃ´‹Û÷[1069]] = $c×›ğòíÎÈ; } else { if ($EĞŠ‰²ñÀŠ > 0) { $f ä– „­á[$BõÌÃ´‹Û÷[1055]] = $f ä– „­á[$BõÌÃ´‹Û÷[1055]] == 0 ? $c‹‘¯¢å£ : $f ä– „­á[$BõÌÃ´‹Û÷[1055]]; $f ä– „­á[$BõÌÃ´‹Û÷[1069]] = $EĞŠ‰²ñÀŠ; } } $this->update(); self::log("\160\x72\x6f\147\162\145\163\163\x48\x74\164\160\72\144\x6f\167\x6e\x3a{$EĞŠ‰²ñÀŠ}\x2f{$c‹‘¯¢å£}\73\40\x75\x70\x6c\157\141\x64\72{$c×›ğòíÎÈ}\57{$fÎÁÂå’Æ¥}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\163\153\x51\x75\145\x75\x65\x4c\x65\x6e\147\x74\150"; const QUEUE_DATA = "\x74\x61\163\x6b\x51\165\145\165\x65\104\x61\164\x61"; public static $listData = false; public static function initTask() { } public static function add($aÜÑÌŒÁ‹Ú, $AæŞÉ…‹Â‡ = array(), $b›ËœŠÜ¡ö = '', $A¶÷‘„±’ù = '') { $CÙÒÆšô¦ =& $_SERVER[©äõ½¡]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($A¶÷‘„±’ù && array_find_by_field(self::$listData, $CÙÒÆšô¦[93], $A¶÷‘„±’ù)) { return !0; } self::$listData[] = array($CÙÒÆšô¦[262] => $aÜÑÌŒÁ‹Ú, $CÙÒÆšô¦[1639] => $AæŞÉ…‹Â‡, $CÙÒÆšô¦[445] => $b›ËœŠÜ¡ö, $CÙÒÆšô¦[93] => $A¶÷‘„±’ù); return !0; } public static function addSubmit() { $E£¼öË» =& $_SERVER[©äõ½¡]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($E£¼öË»[1640] . json_encode_force(array_to_keyvalue(self::$listData, $E£¼öË»[33], $E£¼öË»[445])), $E£¼öË»[1641]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($Cİ×ŠËßÆ, $d¶÷è‡Ê½ = array(), $Fê¸áˆí£ñ = '', $b…¢×ë…„ = '') { goto dã¿÷ƒô­; eé­â‡Ÿì­: self::setAll($dŒÏÉóøÖ); return !0; goto D’ßóÎ­÷; b¿œÛ¨†Øˆ: if ($b…¢×ë…„ && array_find_by_field($dŒÏÉóøÖ, $bÊÏ¼Ê±Ã›[93], $b…¢×ë…„)) { return !0; } $dŒÏÉóøÖ[] = array($bÊÏ¼Ê±Ã›[262] => $Cİ×ŠËßÆ, $bÊÏ¼Ê±Ã›[1639] => $d¶÷è‡Ê½, $bÊÏ¼Ê±Ã›[445] => $Fê¸áˆí£ñ, $bÊÏ¼Ê±Ã›[93] => $b…¢×ë…„); write_log($bÊÏ¼Ê±Ã›[1640] . $Fê¸áˆí£ñ, $bÊÏ¼Ê±Ã›[1641]); goto eé­â‡Ÿì­; dã¿÷ƒô­: $bÊÏ¼Ê±Ã› =& $_SERVER[©äõ½¡]; if (self::count() >= self::MAX_LENGTH) { return !1; } $dŒÏÉóøÖ = self::getAll(); goto b¿œÛ¨†Øˆ; D’ßóÎ­÷: } public static function run() { goto d«÷İÒ—Ñ; B…âİ²ÙêÁ: if (!$b–èƒÏ¾å¯) { return !1; } self::setAll($EÒ˜ÖÇ½Šß); $aêÇÅ“‡°Û = timeFloat(); goto aòÀïª”¡²; d«÷İÒ—Ñ: $DÃ„¸•²—³ =& $_SERVER[©äõ½¡]; $EÒ˜ÖÇ½Šß = self::getAll(); $b–èƒÏ¾å¯ = array_shift($EÒ˜ÖÇ½Šß); goto B…âİ²ÙêÁ; aòÀïª”¡²: try { Hook::apply($b–èƒÏ¾å¯[$DÃ„¸•²—³[262]], $b–èƒÏ¾å¯[$DÃ„¸•²—³[1639]]); } catch (Exception $E„¼Ù„ØõŒ) { } $CƒÓ…¹Á‰– = number_format(timeFloat() - $aêÇÅ“‡°Û, 3) . $DÃ„¸•²—³[1577]; write_log($DÃ„¸•²—³[1642] . $b–èƒÏ¾å¯[$DÃ„¸•²—³[445]] . $DÃ„¸•²—³[1643] . $CƒÓ…¹Á‰–, $DÃ„¸•²—³[1641]); goto E¨Âƒ»¼×; E¨Âƒ»¼×: return !0; goto AÌ˜‹ä÷•³; AÌ˜‹ä÷•³: } public static function count() { $bçã§÷ïìÇ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$bçã§÷ïìÇ) { return 0; } return intval($bçã§÷ïìÇ); } public static function getAll() { $eÏ¢÷¸‹ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$eÏ¢÷¸‹) { return array(); } return $eÏ¢÷¸‹; } public static function setAll($Då›Éù”ˆë) { $fÍ¹Á‰÷º¡ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($Då›Éù”ˆë), $fÍ¹Á‰÷º¡); Cache::set(self::QUEUE_DATA, $Då›Éù”ˆë, $fÍ¹Á‰÷º¡); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto f¡Ë«ÎŠ‰ğ; f•Ö¾¹æ—: class GroupModel extends ModelBase { protected $tableName = "\x67\x72\x6f\x75\160"; protected $tableMeta = array("\x74\141\142\x6c\145\116\141\155\145" => "\x67\x72\157\x75\x70\x5f\155\145\x74\x61", "\155\145\164\141\x46\151\145\x6c\x64" => "\147\x72\x6f\x75\160\111\104"); protected function cacheFunctionAlias($b²óğôñŒõ) { $dÃ¨ÙÚ‰¦ =& $_SERVER[©äõ½¡]; return array($dÃ¨ÙÚ‰¦[1807] => array($b²óğôñŒõ[0], $dÃ¨ÙÚ‰¦[1808]), $dÃ¨ÙÚ‰¦[1809] => array($b²óğôñŒõ[0], $dÃ¨ÙÚ‰¦[1810])); } protected function getInfo($B÷Ñ•¡Ó, $fùãØÓ»¹– = false) { $E‹«´Œ‚ÜÛ = $this->getInfoSimple($B÷Ñ•¡Ó); if (!$E‹«´Œ‚ÜÛ) { return !1; } if ($fùãØÓ»¹–) { return $this->_listDataApplyItem($E‹«´Œ‚ÜÛ); } return $this->cacheFunctionGet($_SERVER[©äõ½¡][1811], $B÷Ñ•¡Ó); } protected function getInfoSimple($F„œ¼‡…¦ˆ, $d®æ›©·â• = false) { $cÊÓ®ö»Ğ =& $_SERVER[©äõ½¡]; if ($d®æ›©·â•) { $e×­‘Á ğ½ = array($cÊÓ®ö»Ğ[1733] => intval($F„œ¼‡…¦ˆ)); $BĞŞÊ‚Ûù = $this->where($e×­‘Á ğ½)->find(); return is_array($BĞŞÊ‚Ûù) ? $BĞŞÊ‚Ûù : array(); } return $this->cacheFunctionGet($cÊÓ®ö»Ğ[1812], $F„œ¼‡…¦ˆ); } protected function groupAdd($AÊ§ß„ÉÖ‰) { goto Cïõ‡Ç½°á; DÍ÷ßëŞŠ¹: if (!empty($AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1733]])) { $bŸÍ£”äÖ[$BĞˆ›ÔîÇ[1733]] = $AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1733]]; } $D«íÊĞèÎÄ = $this->add($bŸÍ£”äÖ); $this->setNamePinyin($D«íÊĞèÎÄ, $bŸÍ£”äÖ[$BĞˆ›ÔîÇ[28]]); goto C­æ­Ü‰Ö‹; C­æ­Ü‰Ö‹: if (isset($AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1815]])) { $this->metaSet($D«íÊĞèÎÄ, array($BĞˆ›ÔîÇ[1815] => $AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1815]], $BĞˆ›ÔîÇ[1816] => $AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1816]])); unset($AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1815]]); unset($AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1816]]); } Model($BĞˆ›ÔîÇ[1239])->groupRootAdd($D«íÊĞèÎÄ); return $D«íÊĞèÎÄ; goto fŞƒÎËÅ•‘; Eˆ³ãê‚º£: if ($cË®ì‰©¹ù[$BĞˆ›ÔîÇ[515]]) { $b¨Îğ·ì­Œ = $cË®ì‰©¹ù[$BĞˆ›ÔîÇ[515]] . $cË®ì‰©¹ù[$BĞˆ›ÔîÇ[1733]] . $BĞˆ›ÔîÇ[47]; } $bŸÍ£”äÖ = array($BĞˆ›ÔîÇ[415] => $this->groupNameAuto($AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[492]], $AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[28]]), $BĞˆ›ÔîÇ[396] => $AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[492]], $BĞˆ›ÔîÇ[578] => $b¨Îğ·ì­Œ, $BĞˆ›ÔîÇ[1813] => $AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1717]], $BĞˆ›ÔîÇ[1814] => 0, $BĞˆ›ÔîÇ[1737] => 0); if (isset($AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1756]])) { $bŸÍ£”äÖ[$BĞˆ›ÔîÇ[1756]] = $AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1756]]; } else { $A“À’»º±´ = $this->max($BĞˆ›ÔîÇ[1756]); if (!$A“À’»º±´) { $A“À’»º±´ = 0; } $bŸÍ£”äÖ[$BĞˆ›ÔîÇ[1756]] = $A“À’»º±´ + 1; } goto DÍ÷ßëŞŠ¹; Cïõ‡Ç½°á: $BĞˆ›ÔîÇ =& $_SERVER[©äõ½¡]; if (!$AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[492]] && isset($AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1733]]) && $AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1733]] == 1) { if ($cË®ì‰©¹ù = $this->getInfoSimple($AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1733]], !0)) { return $AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[1733]]; } } else { $cË®ì‰©¹ù = $this->getInfoSimple($AÊ§ß„ÉÖ‰[$BĞˆ›ÔîÇ[492]]); if (!$cË®ì‰©¹ù) { return !1; } } $b¨Îğ·ì­Œ = $BĞˆ›ÔîÇ[525]; goto Eˆ³ãê‚º£; fŞƒÎËÅ•‘: } protected function groupEdit($a½¼Ş²—, $bŞÅ´Íô®°) { goto B¡Šª§¡òÕ; dˆ§Æ™Öáä: if (!empty($bŞÅ´Íô®°[$EÃ²Öµğ¤[492]])) { $b¸èÀ‚ÂöÃ = $this->getInfoSimple($bŞÅ´Íô®°[$EÃ²Öµğ¤[492]]); if (!$b¸èÀ‚ÂöÃ) { return !1; } if ($eãøÌ¦ÊóŠ[$EÃ²Öµğ¤[1733]] == $b¸èÀ‚ÂöÃ[$EÃ²Öµğ¤[1733]]) { return !1; } if ($bŞÅ´Íô®°[$EÃ²Öµğ¤[492]] != $eãøÌ¦ÊóŠ[$EÃ²Öµğ¤[492]]) { if ($b¸èÀ‚ÂöÃ[$EÃ²Öµğ¤[515]] !== $eãøÌ¦ÊóŠ[$EÃ²Öµğ¤[515]] && strpos($b¸èÀ‚ÂöÃ[$EÃ²Öµğ¤[515]], $eãøÌ¦ÊóŠ[$EÃ²Öµğ¤[515]] . $eãøÌ¦ÊóŠ[$EÃ²Öµğ¤[1733]] . $EÃ²Öµğ¤[47]) === 0) { return !1; } $bŞÅ´Íô®°[$EÃ²Öµğ¤[578]] = $b¸èÀ‚ÂöÃ[$EÃ²Öµğ¤[515]] . $bŞÅ´Íô®°[$EÃ²Öµğ¤[492]] . $EÃ²Öµğ¤[47]; $this->_changeChildLevel($eãøÌ¦ÊóŠ, $b¸èÀ‚ÂöÃ); } } if (isset($bŞÅ´Íô®°[$EÃ²Öµğ¤[28]])) { $this->setNamePinyin($a½¼Ş²—, $bŞÅ´Íô®°[$EÃ²Öµğ¤[28]]); } if (isset($bŞÅ´Íô®°[$EÃ²Öµğ¤[1815]])) { $this->metaSet($a½¼Ş²—, array($EÃ²Öµğ¤[1815] => $bŞÅ´Íô®°[$EÃ²Öµğ¤[1815]], $EÃ²Öµğ¤[1816] => $bŞÅ´Íô®°[$EÃ²Öµğ¤[1816]])); unset($bŞÅ´Íô®°[$EÃ²Öµğ¤[1815]]); unset($bŞÅ´Íô®°[$EÃ²Öµğ¤[1816]]); } goto Aé„™’óÃİ; B¡Šª§¡òÕ: $EÃ²Öµğ¤ =& $_SERVER[©äõ½¡]; $eãøÌ¦ÊóŠ = $this->getInfoSimple($a½¼Ş²—); if (!$eãøÌ¦ÊóŠ) { return !1; } goto dˆ§Æ™Öáä; Aé„™’óÃİ: $this->_clearChildrenCache($eãøÌ¦ÊóŠ); return $this->where(array($EÃ²Öµğ¤[1817] => $a½¼Ş²—))->save($bŞÅ´Íô®°); goto bâêÂ›„; bâêÂ›„: } private function _clearChildrenCache($eÊºìµÍ) { $fÆˆ‰¢ÓËó =& $_SERVER[©äõ½¡]; $BÒÛ…™É¨• = array($fÆˆ‰¢ÓËó[578] => array($fÆˆ‰¢ÓËó[538], $eÊºìµÍ[$fÆˆ‰¢ÓËó[515]] . $eÊºìµÍ[$fÆˆ‰¢ÓËó[1733]] . $fÆˆ‰¢ÓËó[539])); $FÚ£³—§¬„ = $this->field($fÆˆ‰¢ÓËó[1733])->where($BÒÛ…™É¨•)->select(); foreach ($FÚ£³—§¬„ as $Aò¨¼»Éğ¬) { $this->_clearCache($Aò¨¼»Éğ¬[$fÆˆ‰¢ÓËó[1733]]); } } private function _clearCache($b¯¡ ˆ¾ÕÆ) { $döÖŞŠ²ƒ¶ =& $_SERVER[©äõ½¡]; $this->cacheFunctionClear($döÖŞŠ²ƒ¶[1811], $b¯¡ ˆ¾ÕÆ); $this->cacheFunctionClear($döÖŞŠ²ƒ¶[1812], $b¯¡ ˆ¾ÕÆ); } private function _changeChildLevel($CĞÃÀ™«Ëî, $BÌÕÄÀÎªÀ, $D‘†µÒŒ‘ƒ = false) { goto dÛĞƒèÁù; E‚÷£ğÂ¸§: $this->_clearChildrenCache($CĞÃÀ™«Ëî); $this->where($cğªĞÊ “)->data($dò¢¬ò¢ƒÍ)->save(); goto fãô”ØÃòé; dÛĞƒèÁù: $cÛïîÇÊõï =& $_SERVER[©äõ½¡]; $b‘Â¢íÖ = $CĞÃÀ™«Ëî[$cÛïîÇÊõï[515]] . $CĞÃÀ™«Ëî[$cÛïîÇÊõï[1733]] . $cÛïîÇÊõï[47]; $eë‚‘šñÒ = $BÌÕÄÀÎªÀ[$cÛïîÇÊõï[515]] . $BÌÕÄÀÎªÀ[$cÛïîÇÊõï[1733]] . $cÛïîÇÊõï[47] . $CĞÃÀ™«Ëî[$cÛïîÇÊõï[1733]] . $cÛïîÇÊõï[47]; goto cğ’¦ùÍß§; cğ’¦ùÍß§: if ($D‘†µÒŒ‘ƒ) { $eë‚‘šñÒ = $BÌÕÄÀÎªÀ[$cÛïîÇÊõï[515]] . $BÌÕÄÀÎªÀ[$cÛïîÇÊõï[1733]] . $cÛïîÇÊõï[47]; } $cğªĞÊ “ = array($cÛïîÇÊõï[578] => array($cÛïîÇÊõï[538], $CĞÃÀ™«Ëî[$cÛïîÇÊõï[515]] . $CĞÃÀ™«Ëî[$cÛïîÇÊõï[1733]] . $cÛïîÇÊõï[539])); $dò¢¬ò¢ƒÍ = array($cÛïîÇÊõï[578] => array($cÛïîÇÊõï[587], "\x72\145\x70\x6c\x61\x63\145\x28\x70\x61\162\145\156\164\114\145\x76\x65\154\x2c\x27{$b‘Â¢íÖ}\47\54\x27{$eë‚‘šñÒ}\x27\51")); goto E‚÷£ğÂ¸§; fãô”ØÃòé: } public function setNamePinyin($F‡£ÀŞ²¨, $A¤í‹ƒ¹â = false) { $b§šìöù¡— =& $_SERVER[©äõ½¡]; if (!$A¤í‹ƒ¹â) { $F˜¢éç‚ŠÙ = $this->getInfoSimple($F‡£ÀŞ²¨); $A¤í‹ƒ¹â = $F˜¢éç‚ŠÙ[$b§šìöù¡—[28]]; } if (!Input::check($A¤í‹ƒ¹â, $b§šìöù¡—[581])) { $this->metaSet($F‡£ÀŞ²¨, $b§šìöù¡—[458], null); $this->metaSet($F‡£ÀŞ²¨, $b§šìöù¡—[457], null); return; } $fè’ç…«Ç¸ = array($b§šìöù¡—[458] => str_replace($b§šìöù¡—[50], $b§šìöù¡—[33], Pinyin::get($A¤í‹ƒ¹â)), $b§šìöù¡—[457] => Pinyin::get($A¤í‹ƒ¹â, $b§šìöù¡—[582])); $this->metaSet($F‡£ÀŞ²¨, $fè’ç…«Ç¸); } protected function groupStatus($FèíÂÉÏÀë, $bç—ãâç”ö) { goto DÔŒÏÛ—»¨; DÔŒÏÛ—»¨: $AãÓòßÑÇé =& $_SERVER[©äõ½¡]; $E×¤ØÜŞ‚á = $this->getInfoSimple($FèíÂÉÏÀë); if (!$E×¤ØÜŞ‚á) { return !1; } goto aÏ‘ë‰½¸±; aÏ‘ë‰½¸±: if ($bç—ãâç”ö == $AãÓòßÑÇé[87]) { $FÜ„‰„ßİŞ = $this->parentLevelArray($E×¤ØÜŞ‚á[$AãÓòßÑÇé[515]]); } else { $f’„…ã„êœ = array($AãÓòßÑÇé[578] => array($AãÓòßÑÇé[538], $E×¤ØÜŞ‚á[$AãÓòßÑÇé[515]] . $E×¤ØÜŞ‚á[$AãÓòßÑÇé[1733]] . $AãÓòßÑÇé[539])); $FÜ„‰„ßİŞ = $this->where($f’„…ã„êœ)->field($AãÓòßÑÇé[1733])->select(); $FÜ„‰„ßİŞ = array_to_keyvalue($FÜ„‰„ßİŞ, $AãÓòßÑÇé[33], $AãÓòßÑÇé[1733]); } $FÜ„‰„ßİŞ[] = $E×¤ØÜŞ‚á[$AãÓòßÑÇé[1733]]; $cæî’œ×„ = array(); goto cİ³Öê¡ÔÃ; cİ³Öê¡ÔÃ: foreach ($FÜ„‰„ßİŞ as $FèíÂÉÏÀë) { $cæî’œ×„[] = array($AãÓòßÑÇé[1733] => $FèíÂÉÏÀë, $AãÓòßÑÇé[93] => $AãÓòßÑÇé[745], $AãÓòßÑÇé[372] => $bç—ãâç”ö); $this->_clearCache($FèíÂÉÏÀë); } return Model($AãÓòßÑÇé[1818])->addAll($cæî’œ×„, array(), !0); goto d­¶…—Œğ½; d­¶…—Œğ½: } protected function groupRemove($BğáÔÜÒ¬) { goto dêÔŠò‰ùÌ; eŠ¿ÓÇ²¹Ò: $this->where(array($a÷ÀÛßêÊƒ[492] => $BğáÔÜÒ¬))->save(array($a÷ÀÛßêÊƒ[492] => $AÏ×¥›Ì¦[$a÷ÀÛßêÊƒ[492]])); Model($a÷ÀÛßêÊƒ[1818])->where($cï¥²ãÕëÏ)->delete(); Model($a÷ÀÛßêÊƒ[1819])->where($cï¥²ãÕëÏ)->delete(); goto c¹š¯Ù÷¨ï; c¹š¯Ù÷¨ï: Model($a÷ÀÛßêÊƒ[827])->groupRootRemove($BğáÔÜÒ¬); return $this->where($cï¥²ãÕëÏ)->delete(); goto e¼»§Òà»À; dêÔŠò‰ùÌ: $a÷ÀÛßêÊƒ =& $_SERVER[©äõ½¡]; $cï¥²ãÕëÏ = array($a÷ÀÛßêÊƒ[1733] => $BğáÔÜÒ¬); $AÏ×¥›Ì¦ = $this->where($cï¥²ãÕëÏ)->find(); goto bÂˆ ç¸³; bÂˆ ç¸³: if (!$AÏ×¥›Ì¦ || $AÏ×¥›Ì¦[$a÷ÀÛßêÊƒ[492]] == 0) { return !1; } $AÆÊ‰ÕßîØ = $this->getInfoSimple($AÏ×¥›Ì¦[$a÷ÀÛßêÊƒ[492]]); $this->_changeChildLevel($AÏ×¥›Ì¦, $AÆÊ‰ÕßîØ, !0); goto eŠ¿ÓÇ²¹Ò; e¼»§Òà»À: } protected function groupSort($FàÈ’»ì·æ) { $A²â®Úøö =& $_SERVER[©äõ½¡]; $fùÕŞ¾ÓÉ = array(); foreach ($FàÈ’»ì·æ as $f©õËîÏŸğ => $DÀ…çÏœ‚) { $fùÕŞ¾ÓÉ[] = array($A²â®Úøö[1733], $DÀ…çÏœ‚, $A²â®Úøö[1756], $f©õËîÏŸğ + 1); } $this->saveAll($fùÕŞ¾ÓÉ); } public function listData() { $f¼‘ˆŞñßİ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($f¼‘ˆŞñßİ[$_SERVER[©äõ½¡][367]]); return $f¼‘ˆŞñßİ; } private function _makeOrder($BÅŠî×˜© = '') { goto AÖïÒê¸; bš’–‡¼: $D¢ˆë‡—È¨ = Input::get($BšÅ–»…ÀÉ[449], $BšÅ–»…ÀÉ[7], $BšÅ–»…ÀÉ[1737], $E¶…ëó†¡é); $e‰ª¯ãÔÏ³ = Input::get($BšÅ–»…ÀÉ[450], $BšÅ–»…ÀÉ[7], $BšÅ–»…ÀÉ[1820], array($BšÅ–»…ÀÉ[1820], $BšÅ–»…ÀÉ[444])); $e‰ª¯ãÔÏ³ = $b»¾îÌ×Ê¡[$e‰ª¯ãÔÏ³]; goto EÒËƒğ„«Ô; AÖïÒê¸: $BšÅ–»…ÀÉ =& $_SERVER[©äõ½¡]; $E¶…ëó†¡é = array($BšÅ–»…ÀÉ[1733], $BšÅ–»…ÀÉ[28], $BšÅ–»…ÀÉ[1719], $BšÅ–»…ÀÉ[194]); $b»¾îÌ×Ê¡ = array($BšÅ–»…ÀÉ[442] => $BšÅ–»…ÀÉ[443], $BšÅ–»…ÀÉ[444] => $BšÅ–»…ÀÉ[445]); goto bš’–‡¼; EÒËƒğ„«Ô: $BÅŠî×˜© = $BÅŠî×˜© . "{$D¢ˆë‡—È¨}\x20{$e‰ª¯ãÔÏ³}\54\x20\147\x72\x6f\165\x70\x49\104\x20\x61\x73\x63"; return $this->order($BÅŠî×˜©); goto b¥‹íâ÷¸; b¥‹íâ÷¸: } public function listChild($e»¯‹¢ÂŠÏ) { $BôÃÄĞßäÂ =& $_SERVER[©äõ½¡]; $BÙ¼áñ•äÜ = $this->where(array($BôÃÄĞßäÂ[492] => $e»¯‹¢ÂŠÏ))->_makeOrder()->selectPage(200); $this->_listDataApply($BÙ¼áñ•äÜ[$BôÃÄĞßäÂ[367]]); return $BÙ¼áñ•äÜ; } public function listByID($F–…ñÆñ¦ƒ) { goto cùÀ¸ğÓ‚¥; D´Îğ…Èôó: $E­¬«¶¥³Ò = $this->where($A¦öÍÚÂô)->select(); $E­¬«¶¥³Ò = array_sort_keep($E­¬«¶¥³Ò, $cçËô™“­[1733], $F–…ñÆñ¦ƒ); $this->_listDataApply($E­¬«¶¥³Ò); goto Bãå¸îğ¯ò; Bãå¸îğ¯ò: return $E­¬«¶¥³Ò; goto AøŒ’‰ÔÎ; cùÀ¸ğÓ‚¥: $cçËô™“­ =& $_SERVER[©äõ½¡]; if (!$F–…ñÆñ¦ƒ) { return array(); } $A¦öÍÚÂô = array($cçËô™“­[1733] => array($cçËô™“­[7], $F–…ñÆñ¦ƒ)); goto D´Îğ…Èôó; AøŒ’‰ÔÎ: } public function listSearch($A¡Š¶í®èÅ) { goto E¬•Ä‹³½„; CŞ¯íÀ¬ô³: if ($bé¶‚ˆõ­) { $Fâ§Úíõ¦¾ = $this->getInfoSimple($bé¶‚ˆõ­); $cÕ«‰ä–– = $Fâ§Úíõ¦¾[$cÙ³ç²„Ì[515]] . $bé¶‚ˆõ­ . $cÙ³ç²„Ì[539]; $Eğ‹¨Ç° = array($Eğ‹¨Ç°, array($cÙ³ç²„Ì[515] => array($cÙ³ç²„Ì[381], $cÕ«‰ä––))); } $Eğ‹¨Ç° = $this->parseWhereLike($Eğ‹¨Ç°); $b˜â†íĞšÕ = $this->_makeOrder()->where($Eğ‹¨Ç°)->selectPage(20); goto eÙµ‰ƒÚ; E¬•Ä‹³½„: $cÙ³ç²„Ì =& $_SERVER[©äõ½¡]; $fßãêœ¤˜¡ = $A¡Š¶í®èÅ[$cÙ³ç²„Ì[1821]]; $bé¶‚ˆõ­ = isset($A¡Š¶í®èÅ[$cÙ³ç²„Ì[1822]]) ? $A¡Š¶í®èÅ[$cÙ³ç²„Ì[1822]] : !1; goto E‰Éôº£È—; D½êÁÑÛñÙ: return $b˜â†íĞšÕ; goto F˜İÙ­§¿ˆ; eÙµ‰ƒÚ: $b˜â†íĞšÕ = $b˜â†íĞšÕ ? $b˜â†íĞšÕ : array($cÙ³ç²„Ì[367] => array(), $cÙ³ç²„Ì[364] => array()); if (!$b˜â†íĞšÕ || count($b˜â†íĞšÕ[$cÙ³ç²„Ì[367]]) < 5 && Input::check($fßãêœ¤˜¡, $cÙ³ç²„Ì[316])) { goto Cİ ƒ‡¼šÕ; Cİ ƒ‡¼šÕ: $bŒì¼ÙÆÆ“ = $this->groupChildrenAll($bé¶‚ˆõ­); $b´‹œÃŠêñ = $this->_searchFromMeta($cÙ³ç²„Ì[457], $fßãêœ¤˜¡, 10, $bŒì¼ÙÆÆ“); $dÌŸŒƒÇŞ¤ = $this->_searchFromMeta($cÙ³ç²„Ì[458], $fßãêœ¤˜¡, 10, $bŒì¼ÙÆÆ“); goto DÄ„Í¤®½„; b¼¤¤Ôè¾: $b˜â†íĞšÕ[$cÙ³ç²„Ì[364]][$cÙ³ç²„Ì[366]] = ceil($b˜â†íĞšÕ[$cÙ³ç²„Ì[364]][$cÙ³ç²„Ì[365]] / $b˜â†íĞšÕ[$cÙ³ç²„Ì[364]][$cÙ³ç²„Ì[361]]); goto C¦µ„Ú¾˜; DÄ„Í¤®½„: $f—¾ò†ƒöë = array_merge($b´‹œÃŠêñ, $dÌŸŒƒÇŞ¤, $b˜â†íĞšÕ[$cÙ³ç²„Ì[367]]); $b˜â†íĞšÕ[$cÙ³ç²„Ì[367]] = array_unique_by_key($f—¾ò†ƒöë, $cÙ³ç²„Ì[1733]); $b˜â†íĞšÕ[$cÙ³ç²„Ì[364]][$cÙ³ç²„Ì[365]] = count($b˜â†íĞšÕ[$cÙ³ç²„Ì[367]]); goto b¼¤¤Ôè¾; C¦µ„Ú¾˜: } $this->_listDataApply($b˜â†íĞšÕ[$cÙ³ç²„Ì[367]]); goto D½êÁÑÛñÙ; E‰Éôº£È—: if (!trim($fßãêœ¤˜¡)) { return !1; } $fßãêœ¤˜¡ = str_replace($cÙ³ç²„Ì[1823], $cÙ³ç²„Ì[1824], $fßãêœ¤˜¡); $Eğ‹¨Ç° = array($cÙ³ç²„Ì[1733] => array($cÙ³ç²„Ì[381], "{$fßãêœ¤˜¡}\45"), $cÙ³ç²„Ì[28] => array($cÙ³ç²„Ì[381], "\x25{$fßãêœ¤˜¡}\45"), $cÙ³ç²„Ì[992] => $cÙ³ç²„Ì[1825]); goto CŞ¯íÀ¬ô³; F˜İÙ­§¿ˆ: } protected function groupChildrenAll($EàŒí³¤‹‰) { $Dê¿óÑÒ²Ä =& $_SERVER[©äõ½¡]; if (!$EàŒí³¤‹‰) { return !1; } if (is_string($EàŒí³¤‹‰)) { $EàŒí³¤‹‰ = array($EàŒí³¤‹‰); } $D‡øÆòêˆ = $EàŒí³¤‹‰; foreach ($EàŒí³¤‹‰ as $D¼í¬©’†Á) { $Bã·ÛµÜò  = $this->getInfoSimple($D¼í¬©’†Á); $c´¨ƒÈ ö¾ = array($Dê¿óÑÒ²Ä[515] => array($Dê¿óÑÒ²Ä[381], $Bã·ÛµÜò [$Dê¿óÑÒ²Ä[515]] . $D¼í¬©’†Á . $Dê¿óÑÒ²Ä[539])); $d‘º†Ñøø = $this->field($Dê¿óÑÒ²Ä[1733])->where($c´¨ƒÈ ö¾)->select(); $D‡øÆòêˆ = array_merge($D‡øÆòêˆ, array_to_keyvalue($d‘º†Ñøø, $Dê¿óÑÒ²Ä[33], $Dê¿óÑÒ²Ä[1733])); } return array_unique($D‡øÆòêˆ); } private function _searchFromMeta($CÖÌ¶´ŞŸ, $FƒõíÄ³Õœ, $cöÊ¾öÊ, $e‘“äñ¸Š) { goto D”•Ûå¦¸; BåØ„ğñƒ: if (!$Dá¯°ÓÚé) { return array(); } $Dá¯°ÓÚé = array_to_keyvalue($Dá¯°ÓÚé, $F³ËÅŠãÌù[33], $F³ËÅŠãÌù[1733]); $FèÎóÜÉîÙ = $this->where(array($F³ËÅŠãÌù[1817] => array($F³ËÅŠãÌù[7], $Dá¯°ÓÚé)))->select(); goto fŸÎôÜÇ¶; D”•Ûå¦¸: $F³ËÅŠãÌù =& $_SERVER[©äõ½¡]; $FƒõíÄ³Õœ = strtolower($FƒõíÄ³Õœ); $Bº¥–‹Ê•ö = array($F³ËÅŠãÌù[93] => $CÖÌ¶´ŞŸ, $F³ËÅŠãÌù[372] => array($F³ËÅŠãÌù[381], "\x25{$FƒõíÄ³Õœ}\x25")); goto Aê§ğ¿Æï; fŸÎôÜÇ¶: if (!$FèÎóÜÉîÙ) { return array(); } return $FèÎóÜÉîÙ; goto F´Ã¾˜Øíº; Aê§ğ¿Æï: $Bº¥–‹Ê•ö = $this->parseWhereLike($Bº¥–‹Ê•ö); if ($e‘“äñ¸Š) { $Bº¥–‹Ê•ö[$F³ËÅŠãÌù[1733]] = array($F³ËÅŠãÌù[7], $e‘“äñ¸Š); } $Dá¯°ÓÚé = Model($F³ËÅŠãÌù[1826])->where($Bº¥–‹Ê•ö)->limit($cöÊ¾öÊ)->select(); goto BåØ„ğñƒ; F´Ã¾˜Øíº: } protected function _listDataApplyItem($b¿œ°Êìáğ) { $dé—¦óÔ¢ = array($b¿œ°Êìáğ); $this->_listDataApply($dé—¦óÔ¢); return $dé—¦óÔ¢[0]; } protected function _listDataApply(&$b‚¡Íİî¯ä) { goto Fğ¥æ¹‹¾³; eà¯Õ²Îí: $this->_listAppendParent($b‚¡Íİî¯ä); $this->_listAppendSourceRoot($b‚¡Íİî¯ä, $d Åø¸µ…§); goto f‘¦ŸÎëÔÇ; Fğ¥æ¹‹¾³: $dÇ±Á‹Úá¡ =& $_SERVER[©äõ½¡]; if (!$b‚¡Íİî¯ä) { return; } $d Åø¸µ…§ = array_to_keyvalue($b‚¡Íİî¯ä, $dÇ±Á‹Úá¡[33], $dÇ±Á‹Úá¡[1733]); goto aÁƒ¼½«¼Õ; aÁƒ¼½«¼Õ: $this->_listAppendChildren($b‚¡Íİî¯ä); $this->_listAppendChildrenMember($b‚¡Íİî¯ä); $this->_listAppendMeta($b‚¡Íİî¯ä, $d Åø¸µ…§); goto eà¯Õ²Îí; f‘¦ŸÎëÔÇ: } private function _listAppendChildren(&$eœİªàÊ·) { goto a¢Ò¨¥•õ¼; a¢Ò¨¥•õ¼: $CÅÕ“ºÄÅ… =& $_SERVER[©äõ½¡]; $eŞËÚÑ‘ïÄ = array_to_keyvalue($eœİªàÊ·, $CÅÕ“ºÄÅ…[33], $CÅÕ“ºÄÅ…[1733]); $f‚÷µ±ƒ = array($CÅÕ“ºÄÅ…[492] => array($CÅÕ“ºÄÅ…[7], $eŞËÚÑ‘ïÄ)); goto eŒêã”éÉ; b‚¦µâÌÀ¨: foreach ($eœİªàÊ· as &$AÂÔ…‹Æ÷Ú) { $c¬ò•ùÓ½Ë = $AÂÔ…‹Æ÷Ú[$CÅÕ“ºÄÅ…[1733]]; $AÂÔ…‹Æ÷Ú[$CÅÕ“ºÄÅ…[1828]] = isset($D½È‚ÕƒÜ[$c¬ò•ùÓ½Ë]) ? intval($D½È‚ÕƒÜ[$c¬ò•ùÓ½Ë]) : !1; } unset($AÂÔ…‹Æ÷Ú); goto dãŸ•Ş¸¡; eŒêã”éÉ: $bƒĞƒ¬…ˆ = array($CÅÕ“ºÄÅ…[492], $CÅÕ“ºÄÅ…[1827] => $CÅÕ“ºÄÅ…[494]); $d®íÈ…Ëé” = $this->field($bƒĞƒ¬…ˆ)->where($f‚÷µ±ƒ)->group($CÅÕ“ºÄÅ…[492])->select(); $D½È‚ÕƒÜ = array_to_keyvalue($d®íÈ…Ëé”, $CÅÕ“ºÄÅ…[492], $CÅÕ“ºÄÅ…[494]); goto b‚¦µâÌÀ¨; dãŸ•Ş¸¡: } private function _listAppendChildrenMember(&$BÙŸ…§ôŸ–) { goto DÄá¹«„¸ù; F‹„ö°®â: foreach ($BÙŸ…§ôŸ– as &$cˆ´š¡—ë×) { $BÌŸœ†Ôè = $cˆ´š¡—ë×[$eàÙäÚ»«ä[1733]]; $cˆ´š¡—ë×[$eàÙäÚ»«ä[1829]] = isset($BÆÈ™‘¦¾[$BÌŸœ†Ôè]) ? intval($BÆÈ™‘¦¾[$BÌŸœ†Ôè]) : !1; } unset($cˆ´š¡—ë×); goto F‡èÍ©ÁØö; DÄá¹«„¸ù: $eàÙäÚ»«ä =& $_SERVER[©äõ½¡]; $få›®ğœ…¡ = array_to_keyvalue($BÙŸ…§ôŸ–, $eàÙäÚ»«ä[33], $eàÙäÚ»«ä[1733]); $díˆ÷‹Â­Û = array($eàÙäÚ»«ä[1733] => array($eàÙäÚ»«ä[7], $få›®ğœ…¡)); goto Dğ·³½ ’‚; Dğ·³½ ’‚: $fØ·š ˆÍ = array($eàÙäÚ»«ä[1733], $eàÙäÚ»«ä[1827] => $eàÙäÚ»«ä[494]); $B²™œÁØ§š = Model($eàÙäÚ»«ä[1819])->field($fØ·š ˆÍ)->where($díˆ÷‹Â­Û)->group($eàÙäÚ»«ä[1733])->select(); $BÆÈ™‘¦¾ = array_to_keyvalue($B²™œÁØ§š, $eàÙäÚ»«ä[1733], $eàÙäÚ»«ä[494]); goto F‹„ö°®â; F‡èÍ©ÁØö: } private function _listAppendMeta(&$Aí„¨¾™«ø, $A¾†‚”ÒÜÑ) { goto FõµãÎÒ‘©; FõµãÎÒ‘©: $c¹‰‡Ëµ¡Ó =& $_SERVER[©äõ½¡]; $C¹­ñ‹”‰ã = array($c¹‰‡Ëµ¡Ó[1733] => array($c¹‰‡Ëµ¡Ó[7], $A¾†‚”ÒÜÑ)); $fÒƒğäÑœ = Model($c¹‰‡Ëµ¡Ó[1818])->where($C¹­ñ‹”‰ã)->select(); goto dòÎ¶§ÖöÔ; dòÎ¶§ÖöÔ: $fÒƒğäÑœ = array_to_keyvalue_group($fÒƒğäÑœ, $c¹‰‡Ëµ¡Ó[1733]); foreach ($fÒƒğäÑœ as &$CåçÏ±ÌåÜ) { $CåçÏ±ÌåÜ = array_to_keyvalue($CåçÏ±ÌåÜ, $c¹‰‡Ëµ¡Ó[93], $c¹‰‡Ëµ¡Ó[372]); } unset($CåçÏ±ÌåÜ); goto d×Ö÷ùïñ; d×Ö÷ùïñ: foreach ($Aí„¨¾™«ø as &$CƒÕŒïÛßö) { $CƒÕŒïÛßö[$c¹‰‡Ëµ¡Ó[459]] = array(); if (isset($fÒƒğäÑœ[$CƒÕŒïÛßö[$c¹‰‡Ëµ¡Ó[1733]]])) { $CƒÕŒïÛßö[$c¹‰‡Ëµ¡Ó[459]] = $fÒƒğäÑœ[$CƒÕŒïÛßö[$c¹‰‡Ëµ¡Ó[1733]]]; } } unset($CƒÕŒïÛßö); goto bµ¸™¹ï…; bµ¸™¹ï…: } protected function parentLevelArray($Cºéƒ„£Ö) { $Bçßˆš¹¥ =& $_SERVER[©äõ½¡]; $Cºéƒ„£Ö = explode($Bçßˆš¹¥[47], trim($Cºéƒ„£Ö, $Bçßˆš¹¥[47])); $Cºéƒ„£Ö = array_remove_value($Cºéƒ„£Ö, $Bçßˆš¹¥[191]); return $Cºéƒ„£Ö; } private function _listAppendParent(&$CÏºŠò‚Â¾) { goto eƒªÜ—ÉÊ; A—ŠğÔµÆÂ: if ($GLOBALS[$C²¢ÍØã˜Ë[499]] == $C²¢ÍØã˜Ë[87]) { $bî²µ¾¨µ¯ = !1; } foreach ($CÏºŠò‚Â¾ as &$C’ÍØÄ²³ˆ) { $fîŒ„¸»º« = $this->parentLevelArray($C’ÍØÄ²³ˆ[$C²¢ÍØã˜Ë[515]]); $aÃ·ÉÛíôñ = $C²¢ÍØã˜Ë[33]; foreach ($fîŒ„¸»º« as $dŒ·¼õìë£ => $Eœ‰í®ª¡) { if ($bî²µ¾¨µ¯ && $dŒ·¼õìë£ == 0) { continue; } $aÃ·ÉÛíôñ .= $cÛôÌñ«“[$Eœ‰í®ª¡] . $C²¢ÍØã˜Ë[8]; } if ($fîŒ„¸»º«) { $aÃ·ÉÛíôñ .= $C’ÍØÄ²³ˆ[$C²¢ÍØã˜Ë[28]]; } $C’ÍØÄ²³ˆ[$C²¢ÍØã˜Ë[520]] = str_replace($C²¢ÍØã˜Ë[523], $C²¢ÍØã˜Ë[8], $aÃ·ÉÛíôñ); } unset($C’ÍØÄ²³ˆ); goto D‚õáœÙ¤å; D¹ô¡¥§ÕÂ: unset($C’ÍØÄ²³ˆ); foreach ($cÛôÌñ«“ as $dŒ·¼õìë£ => $c‹‚µçĞ) { if ($c‹‚µçĞ) { continue; } $dìµÇŸ±×‡ = $this->getInfoSimple($dŒ·¼õìë£); $cÛôÌñ«“[$dŒ·¼õìë£] = $dìµÇŸ±×‡[$C²¢ÍØã˜Ë[28]]; } $bî²µ¾¨µ¯ = $GLOBALS[$C²¢ÍØã˜Ë[6]][$C²¢ÍØã˜Ë[88]][$C²¢ÍØã˜Ë[1830]]; goto A—ŠğÔµÆÂ; eƒªÜ—ÉÊ: $C²¢ÍØã˜Ë =& $_SERVER[©äõ½¡]; $cÛôÌñ«“ = array(); foreach ($CÏºŠò‚Â¾ as &$C’ÍØÄ²³ˆ) { $cÛôÌñ«“[$C’ÍØÄ²³ˆ[$C²¢ÍØã˜Ë[1733]]] = $C’ÍØÄ²³ˆ[$C²¢ÍØã˜Ë[28]]; $fîŒ„¸»º« = $this->parentLevelArray($C’ÍØÄ²³ˆ[$C²¢ÍØã˜Ë[515]]); foreach ($fîŒ„¸»º« as $Eœ‰í®ª¡) { if (!isset($cÛôÌñ«“[$Eœ‰í®ª¡])) { $cÛôÌñ«“[$Eœ‰í®ª¡] = 0; } } } goto D¹ô¡¥§ÕÂ; D‚õáœÙ¤å: } private function _listAppendSourceRoot(&$fË†§³Å©, $e´ê—šÓÃ”) { goto b¨Ú«ùäëù; e‰®§‰Ì¤Œ: $CòêÌæ­«Ş = $eÖ©²ÙÖ…¡->limit(count($e´ê—šÓÃ”))->where($B…õ… È»Ü)->select(); $CòêÌæ­«Ş = array_to_keyvalue($CòêÌæ­«Ş, $B‚éß§È™†[498]); $CòêÌæ­«Ş = array_remove_key($CòêÌæ­«Ş, $B‚éß§È™†[498]); goto D©ôµÑ‚Ü ; D©ôµÑ‚Ü : foreach ($fË†§³Å© as &$d…‘…ª»Õ) { $d…‘…ª»Õ[$B‚éß§È™†[85]] = $CòêÌæ­«Ş[$d…‘…ª»Õ[$B‚éß§È™†[1733]]] ? $CòêÌæ­«Ş[$d…‘…ª»Õ[$B‚éß§È™†[1733]]] : array(); } unset($d…‘…ª»Õ); goto c¦ƒ¨Œæò; b¨Ú«ùäëù: $B‚éß§È™† =& $_SERVER[©äõ½¡]; $B…õ… È»Ü = array($B‚éß§È™†[492] => 0, $B‚éß§È™†[498] => array($B‚éß§È™†[7], $e´ê—šÓÃ”), $B‚éß§È™†[406] => SourceModel::TYPE_GROUP); $eÖ©²ÙÖ…¡ = Model($B‚éß§È™†[827])->order($B‚éß§È™†[1831])->field($B‚éß§È™†[1832]); goto e‰®§‰Ì¤Œ; c¦ƒ¨Œæò: } protected function groupMerge($b…÷·ë‚¼–) { $b…÷·ë‚¼– = array_values(array_unique($b…÷·ë‚¼–)); $AŸ¿¯¶ÂêÍ = array(); for ($A¼¾ñ™´» = 0; $A¼¾ñ™´» < count($b…÷·ë‚¼–); $A¼¾ñ™´»++) { $aÃòïŒğöä = !1; for ($Dâí¹¤‡ÔÕ = 0; $Dâí¹¤‡ÔÕ < count($b…÷·ë‚¼–); $Dâí¹¤‡ÔÕ++) { if ($A¼¾ñ™´» == $Dâí¹¤‡ÔÕ) { continue; } if ($this->isParentOf($b…÷·ë‚¼–[$Dâí¹¤‡ÔÕ], $b…÷·ë‚¼–[$A¼¾ñ™´»])) { $aÃòïŒğöä = !0; break; } } if (!$aÃòïŒğöä) { $AŸ¿¯¶ÂêÍ[] = $b…÷·ë‚¼–[$A¼¾ñ™´»]; } } return $AŸ¿¯¶ÂêÍ; } protected function isParentOf($bÀ¹Õ¬„Ï», $aî¼’ÅÚ´º) { goto C¾Ò¬ÉŞ¼Â; Eœ¦‡§­Ì¡: $FùËõ‡´äƒ = $this->getInfoSimple($aî¼’ÅÚ´º); $A¢ªÊä•„ = $cšªìÁ»“™[$aªÊæ“ƒ³ï[515]] . $bÀ¹Õ¬„Ï» . $aªÊæ“ƒ³ï[47]; if (substr($FùËõ‡´äƒ[$aªÊæ“ƒ³ï[515]], 0, strlen($A¢ªÊä•„)) == $A¢ªÊä•„) { return !0; } goto dó¥¯ˆµº; C¾Ò¬ÉŞ¼Â: $aªÊæ“ƒ³ï =& $_SERVER[©äõ½¡]; if (!$bÀ¹Õ¬„Ï» || !$aî¼’ÅÚ´º || $bÀ¹Õ¬„Ï» == $aî¼’ÅÚ´º) { return !1; } $cšªìÁ»“™ = $this->getInfoSimple($bÀ¹Õ¬„Ï»); goto Eœ¦‡§­Ì¡; dó¥¯ˆµº: return !1; goto B °ÎŠêšÁ; B °ÎŠêšÁ: } public function groupShowRoot($a¤ù’ÖÅ˜Ş, $C¤ôùîã‹ø = false) { goto A»±¥³ä„¶; FË½®Ï‰¡: return $e‡¬„ÔæÒ¿; goto a”ˆ–¢î†ì; Bô”Éö²’: $aÅÉÆà²´‚ = $this->parentLevelArray($F«…‘ßÓæ[$b’˜†¨³ù[515]]); $e‡¬„ÔæÒ¿ = array($a¤ù’ÖÅ˜Ş); if (count($aÅÉÆà²´‚) == 0) { return $e‡¬„ÔæÒ¿; } goto f²²×‚²ÇÀ; f²²×‚²ÇÀ: if ($C¤ôùîã‹ø && count($aÅÉÆà²´‚) == 1) { return $e‡¬„ÔæÒ¿; } if (!$F«…‘ßÓæ[$b’˜†¨³ù[459]] || !isset($F«…‘ßÓæ[$b’˜†¨³ù[459]][$b’˜†¨³ù[1815]]) || $F«…‘ßÓæ[$b’˜†¨³ù[459]][$b’˜†¨³ù[1815]] == $b’˜†¨³ù[1787]) { return $this->groupShowRoot($aÅÉÆà²´‚[count($aÅÉÆà²´‚) - 1], $C¤ôùîã‹ø); } if ($F«…‘ßÓæ[$b’˜†¨³ù[459]][$b’˜†¨³ù[1815]] == $b’˜†¨³ù[355]) { $FÓíÚå•ë = explode($b’˜†¨³ù[47], $F«…‘ßÓæ[$b’˜†¨³ù[459]][$b’˜†¨³ù[1816]]); if ($FÓíÚå•ë) { $e‡¬„ÔæÒ¿ = array_merge($e‡¬„ÔæÒ¿, $FÓíÚå•ë); } } goto FË½®Ï‰¡; A»±¥³ä„¶: $b’˜†¨³ù =& $_SERVER[©äõ½¡]; $F«…‘ßÓæ = $this->getInfo($a¤ù’ÖÅ˜Ş); if (!$F«…‘ßÓæ) { return array(); } goto Bô”Éö²’; a”ˆ–¢î†ì: } protected function resetParentLevel() { $b“ìÛˆ¥õÄ =& $_SERVER[©äõ½¡]; $a³¿‚¸Å = $b“ìÛˆ¥õÄ[1733]; $DØ÷é = $this->select(); $DØ÷é = array_to_keyvalue($DØ÷é, $a³¿‚¸Å); foreach ($DØ÷é as $bƒ™ÁÔÙÑß) { goto dò‡¬¥“”ñ; b¿Öµ– ğ±: $this->where(array($a³¿‚¸Å => $bƒ™ÁÔÙÑß[$a³¿‚¸Å]))->save(array($b“ìÛˆ¥õÄ[578] => $a¬´«Û£)); goto EšíÂĞÓ˜; eš°‹÷ææô: $a¬´«Û£[] = 0; $a¬´«Û£ = $b“ìÛˆ¥õÄ[47] . implode($b“ìÛˆ¥õÄ[47], array_reverse($a¬´«Û£)) . $b“ìÛˆ¥õÄ[47]; $this->setNamePinyin($bƒ™ÁÔÙÑß[$a³¿‚¸Å], $bƒ™ÁÔÙÑß[$b“ìÛˆ¥õÄ[28]]); goto b¿Öµ– ğ±; dò‡¬¥“”ñ: $dÔ¨¢äÊ µ = $bƒ™ÁÔÙÑß; $a¬´«Û£ = array(); while ($dÔ¨¢äÊ µ[$b“ìÛˆ¥õÄ[492]] != 0) { $a¬´«Û£[] = $dÔ¨¢äÊ µ[$b“ìÛˆ¥õÄ[492]]; $dÔ¨¢äÊ µ = $DØ÷é[$dÔ¨¢äÊ µ[$b“ìÛˆ¥õÄ[492]]]; } goto eš°‹÷ææô; EšíÂĞÓ˜: } return $DØ÷é; } public function groupNameAuto($D²¤÷’í¨â, $AÁôÇ†²) { $cŞŞÍ©Ò†› =& $_SERVER[©äõ½¡]; $fÚ‘®‘¤Å = $this->where(array($cŞŞÍ©Ò†›[396] => $D²¤÷’í¨â))->getField($cŞŞÍ©Ò†›[28], !0); if (!$fÚ‘®‘¤Å || !in_array($AÁôÇ†², $fÚ‘®‘¤Å)) { return $AÁôÇ†²; } for ($D¨æ…ˆïôŸ = 1; $D¨æ…ˆïôŸ <= count($fÚ‘®‘¤Å) + 1; $D¨æ…ˆïôŸ++) { $Eï‡Õö—±‘ = $AÁôÇ†² . "\x28{$D¨æ…ˆïôŸ}\51"; if (!in_array($Eï‡Õö—±‘, $fÚ‘®‘¤Å)) { return $Eï‡Õö—±‘; } } } public function groupSwitch($DâÌëÙ»‡–, $cÓîÛÖÇÁ) { goto aôÂ¥ŠâÄ; eš¸¥œñ‰: $c§ š•š÷™ = !empty($EîíËˆ†Íî[$DâÌëÙ»‡–]) ? $EîíËˆ†Íî[$DâÌëÙ»‡–] : !1; if ($c§ š•š÷™) { goto C‚Ã¹ÍøÊ«; C‚Ã¹ÍøÊ«: if (!$EîíËˆ†Íî[$cÓîÛÖÇÁ]) { $EîíËˆ†Íî[$cÓîÛÖÇÁ] = Model($bÏêï¥µ¡[827])->groupRootAdd($cÓîÛÖÇÁ); } $AêÚâ˜…ÒÏ = $EîíËˆ†Íî[$cÓîÛÖÇÁ]; $Dİóº‰¯Š = array($bÏêï¥µ¡[492] => $c§ š•š÷™); goto cİ‡ÊÕ›¤Õ; dŞĞ­½¬ß·: $cç˜¼ØÆç² = array($bÏêï¥µ¡[498] => $cÓîÛÖÇÁ); Model($bÏêï¥µ¡[1836])->where($Dİóº‰¯Š)->save($cç˜¼ØÆç²); Model($bÏêï¥µ¡[1837])->where($Dİóº‰¯Š)->save($cç˜¼ØÆç²); goto FÜáŸ£¬ğ´; b‹¼ÒèïœÚ: foreach ($EîíËˆ†Íî as $b“§÷„‹Ä) { $Fù¶È‹Î•ˆ = $b“§÷„‹Ä[$bÏêï¥µ¡[405]] == $bÏêï¥µ¡[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($bÏêï¥µ¡[827])->move($b“§÷„‹Ä[$bÏêï¥µ¡[397]], $AêÚâ˜…ÒÏ, $Fù¶È‹Î•ˆ); } Model($bÏêï¥µ¡[827])->moveClearAuth = !0; $Dİóº‰¯Š = array($bÏêï¥µ¡[406] => 2, $bÏêï¥µ¡[498] => $DâÌëÙ»‡–); goto dŞĞ­½¬ß·; cİ‡ÊÕ›¤Õ: $EîíËˆ†Íî = Model($bÏêï¥µ¡[827])->where($Dİóº‰¯Š)->field($bÏêï¥µ¡[1835])->select(); if (!$EîíËˆ†Íî) { $EîíËˆ†Íî = array(); } Model($bÏêï¥µ¡[827])->moveClearAuth = !1; goto b‹¼ÒèïœÚ; FÜáŸ£¬ğ´: } $this->_changeChildLevel($CŠºçšŠ[$DâÌëÙ»‡–], $CŠºçšŠ[$cÓîÛÖÇÁ], !0); goto Eš˜¹‚ò¥ß; cóĞËÅæ„ª: $CŠºçšŠ = array_to_keyvalue($CŠºçšŠ, $bÏêï¥µ¡[1733]); if (!isset($CŠºçšŠ[$DâÌëÙ»‡–]) || !isset($CŠºçšŠ[$cÓîÛÖÇÁ]) || $CŠºçšŠ[$DâÌëÙ»‡–][$bÏêï¥µ¡[492]] == 0) { return !1; } $Dİóº‰¯Š = array($bÏêï¥µ¡[1733] => $DâÌëÙ»‡–); goto DÜ…´®¤™; aôÂ¥ŠâÄ: $bÏêï¥µ¡ =& $_SERVER[©äõ½¡]; $Dİóº‰¯Š = array($bÏêï¥µ¡[1733] => array($bÏêï¥µ¡[7], array($DâÌëÙ»‡–, $cÓîÛÖÇÁ))); $CŠºçšŠ = $this->where($Dİóº‰¯Š)->select(); goto cóĞËÅæ„ª; Eš˜¹‚ò¥ß: $this->where(array($bÏêï¥µ¡[492] => $DâÌëÙ»‡–))->save(array($bÏêï¥µ¡[492] => $cÓîÛÖÇÁ)); $this->_clearChildrenCache($CŠºçšŠ[$cÓîÛÖÇÁ]); return !0; goto Cíï¤ê‘Ç‡; DÜ…´®¤™: $FÀ–‹åŒì = Model($bÏêï¥µ¡[1819])->where($Dİóº‰¯Š)->select(); if (!$FÀ–‹åŒì) { $FÀ–‹åŒì = array(); } foreach ($FÀ–‹åŒì as $Fˆøóö«›) { $d¼Áø¼ÕË÷ = $Fˆøóö«›[$bÏêï¥µ¡[1564]]; $Dİóº‰¯Š = array($bÏêï¥µ¡[1564] => $d¼Áø¼ÕË÷, $bÏêï¥µ¡[1733] => $cÓîÛÖÇÁ); $ağ İØ…‚ = Model($bÏêï¥µ¡[1819])->where($Dİóº‰¯Š)->find(); if (!$ağ İØ…‚) { $d³‚©Õ“ºß = array($cÓîÛÖÇÁ => $Fˆøóö«›[$bÏêï¥µ¡[1833]]); Model($bÏêï¥µ¡[532])->userGroupAdd($d¼Áø¼ÕË÷, $d³‚©Õ“ºß); } Model($bÏêï¥µ¡[532])->userGroupRemove($d¼Áø¼ÕË÷, $DâÌëÙ»‡–); } goto C²¬×Ô¯Â¶; C²¬×Ô¯Â¶: $Dİóº‰¯Š = array($bÏêï¥µ¡[406] => 2, $bÏêï¥µ¡[492] => 0, $bÏêï¥µ¡[405] => 1, $bÏêï¥µ¡[498] => array($bÏêï¥µ¡[7], array($DâÌëÙ»‡–, $cÓîÛÖÇÁ))); $EîíËˆ†Íî = Model($bÏêï¥µ¡[827])->where($Dİóº‰¯Š)->field($bÏêï¥µ¡[1834])->select(); $EîíËˆ†Íî = array_to_keyvalue($EîíËˆ†Íî, $bÏêï¥µ¡[498], $bÏêï¥µ¡[397]); goto eš¸¥œñ‰; Cíï¤ê‘Ç‡: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\163\145\162\x5f\146\x61\x76"; protected function cacheFunctionAlias($E£É…ôµôË) { $Böàùï‹Òª =& $_SERVER[©äõ½¡]; return array($Böàùï‹Òª[1838] => array($E£É…ôµôË[0], $Böàùï‹Òª[1839]), $Böàùï‹Òª[1840] => array($E£É…ôµôË[0], $Böàùï‹Òª[1841])); } protected function get($f§Üô¼øç˜) { $c¡Ù´ĞÁ° =& $_SERVER[©äõ½¡]; $E¡Ï¼§™‡ = Model($c¡Ù´ĞÁ°[516])->metaGet($f§Üô¼øç˜, $c¡Ù´ĞÁ°[1842]); $bÙÜ‡Ú›İ = json_decode($E¡Ï¼§™‡, !0); return $bÙÜ‡Ú›İ ? $bÙÜ‡Ú›İ : array($c¡Ù´ĞÁ°[1843] => $c¡Ù´ĞÁ°[87], $c¡Ù´ĞÁ°[367] => array()); } protected function set($aßÒ‡ñ±£’, $A²ôã·§…Š) { $CÅ¿¬õÑ· =& $_SERVER[©äõ½¡]; $A²ôã·§…Š = $A²ôã·§…Š ? $A²ôã·§…Š : array($CÅ¿¬õÑ·[1843] => $CÅ¿¬õÑ·[87], $CÅ¿¬õÑ·[367] => array()); Model($CÅ¿¬õÑ·[516])->metaSet($aßÒ‡ñ±£’, $CÅ¿¬õÑ·[1842], json_encode($A²ôã·§…Š)); return Model($CÅ¿¬õÑ·[516])->metaSet($aßÒ‡ñ±£’, $CÅ¿¬õÑ·[1842], json_encode($A²ôã·§…Š)); } protected function getByTagID($a¦ó½ôŞß”, $DÒ®Ô¸ö) { goto aõ¹ËÏä‘; E¦’‚™ÁŠ: return is_array($c°¬ÂÔ‰½—) ? $c°¬ÂÔ‰½— : !1; goto A±˜¸°¸«ê; bØ°âÕÓ×ó: $BĞÓÓß…Àš = $this->get($a¦ó½ôŞß”); if (!$BĞÓÓß…Àš || !isset($BĞÓÓß…Àš[$f¦ùƒÌ[367]])) { return !1; } $c°¬ÂÔ‰½— = array_find_by_field($BĞÓÓß…Àš[$f¦ùƒÌ[367]], $f¦ùƒÌ[395], $DÒ®Ô¸ö); goto E¦’‚™ÁŠ; aõ¹ËÏä‘: $f¦ùƒÌ =& $_SERVER[©äõ½¡]; if (!$a¦ó½ôŞß” || !$DÒ®Ô¸ö) { return !1; } if (!Model($f¦ùƒÌ[516])->getInfoSimple($a¦ó½ôŞß”)) { return !1; } goto bØ°âÕÓ×ó; A±˜¸°¸«ê: } public function listSource($E¯Ò©³¤‘¹, $fØ˜¼ÌÑ‘) { goto Eé¨¾Æ¢¨Â; fÃôÉù–§¥: $A‰Ïìœãã = array(); foreach ($dìõšˆ©¬è as $côŒ ¥ºàˆ) { $cëÃñˆƒ = $côŒ ¥ºàˆ[$b®ã¢ëŒ¹½[76]]; if (!$cëÃñˆƒ) { continue; } if (!isset($A‰Ïìœãã[$cëÃñˆƒ])) { $A‰Ïìœãã[$cëÃñˆƒ] = array(); } $A‰Ïìœãã[$cëÃñˆƒ][] = $côŒ ¥ºàˆ[$b®ã¢ëŒ¹½[421]]; } $b‰ç–˜‚› = array(); goto eĞøµ¤ ; B÷õçóÜ×İ: $CÇ«‚¶’ö = array_to_keyvalue($eâ™¼Áóİ[$b®ã¢ëŒ¹½[75]], $b®ã¢ëŒ¹½[33], $b®ã¢ëŒ¹½[397]); $eŒ²æÜîŒ = array_to_keyvalue($eâ™¼Áóİ[$b®ã¢ëŒ¹½[74]], $b®ã¢ëŒ¹½[33], $b®ã¢ëŒ¹½[397]); $c²÷™‡°Ûµ = array_merge($eŒ²æÜîŒ, $CÇ«‚¶’ö); goto f­¤±¯¸ñë; f¥ğ¿ğ“: $eâ™¼Áóİ = Model($b®ã¢ëŒ¹½[1239])->listSource($a ¡Ì»êŞ); if (!$eâ™¼Áóİ || count($b‰ç–˜‚›) == $eâ™¼Áóİ[$b®ã¢ëŒ¹½[364]][$b®ã¢ëŒ¹½[365]]) { return $eâ™¼Áóİ; } $a³‡˜˜²´ = array(); goto B÷õçóÜ×İ; f­¤±¯¸ñë: foreach ($b‰ç–˜‚› as $cëÃñˆƒ) { if (!in_array($cëÃñˆƒ, $c²÷™‡°Ûµ)) { $a³‡˜˜²´[] = $cëÃñˆƒ; } } if ($a³‡˜˜²´) { $this->removeBySource($E¯Ò©³¤‘¹, $a³‡˜˜²´); } return $eâ™¼Áóİ; goto Fš¸Ø®ãšÕ; eĞøµ¤ : foreach ($A‰Ïìœãã as $BË•¥¿·±Ï => $B’¸•Å‚²) { $cï•ÇÆªĞ¦ = !0; if (!$fØ˜¼ÌÑ‘) { $b‰ç–˜‚›[] = $BË•¥¿·±Ï; continue; } foreach ($fØ˜¼ÌÑ‘ as $E»Ö‚Ïë’î) { if (!in_array($E»Ö‚Ïë’î, $B’¸•Å‚²)) { $cï•ÇÆªĞ¦ = !1; break; } } if ($cï•ÇÆªĞ¦) { $b‰ç–˜‚›[] = $BË•¥¿·±Ï; } } if (!$b‰ç–˜‚›) { return array(); } $a ¡Ì»êŞ = array($b®ã¢ëŒ¹½[412] => array($b®ã¢ëŒ¹½[413], $b‰ç–˜‚›), $b®ã¢ëŒ¹½[498] => $E¯Ò©³¤‘¹, $b®ã¢ëŒ¹½[406] => SourceModel::TYPE_GROUP); goto f¥ğ¿ğ“; Eé¨¾Æ¢¨Â: $b®ã¢ëŒ¹½ =& $_SERVER[©äõ½¡]; if ($fØ˜¼ÌÑ‘ && !is_array($fØ˜¼ÌÑ‘)) { $fØ˜¼ÌÑ‘ = array($fØ˜¼ÌÑ‘); } $dìõšˆ©¬è = $this->listData($E¯Ò©³¤‘¹); goto fÃôÉù–§¥; Fš¸Ø®ãšÕ: } protected function listData($bÏÑëÕî®) { $b¿™©‚˜‚¬ =& $_SERVER[©äõ½¡]; $F×‚±‚¤Š³ = array($b¿™©‚˜‚¬[1555] => 0, $b¿™©‚˜‚¬[477] => array($b¿™©‚˜‚¬[1844], 0), $b¿™©‚˜‚¬[417] => $b¿™©‚˜‚¬[1845] . $bÏÑëÕî®); $EÛÎÄŠ³ë¤ = $b¿™©‚˜‚¬[1846]; $aøŸ·Ìœì = $this->field($EÛÎÄŠ³ë¤)->where($F×‚±‚¤Š³)->order($b¿™©‚˜‚¬[1847])->select(); return $aøŸ·Ìœì ? $aøŸ·Ìœì : array(); } protected function addToTag($Fîˆ·±Šğ´, $Fê‡í¯³, $D¸¤ãÔ‚¾ë) { $eŠ´…æ‚Şõ =& $_SERVER[©äõ½¡]; if (!$this->getByTagID($Fîˆ·±Šğ´, $D¸¤ãÔ‚¾ë) || !$Fê‡í¯³) { return !1; } if (!Model($eŠ´…æ‚Şõ[827])->pathInfo($Fê‡í¯³)) { return !1; } $Bóã†˜É²ğ = array($eŠ´…æ‚Şõ[1555] => 0, $eŠ´…æ‚Şõ[477] => $D¸¤ãÔ‚¾ë, $eŠ´…æ‚Şõ[416] => $Fê‡í¯³, $eŠ´…æ‚Şõ[417] => $eŠ´…æ‚Şõ[1848] . $Fîˆ·±Šğ´, $eŠ´…æ‚Şõ[415] => $eŠ´…æ‚Şõ[33], $eŠ´…æ‚Şõ[1737] => 0); if ($this->where($Bóã†˜É²ğ)->find()) { return !1; } return $this->add($Bóã†˜É²ğ); } protected function removeFromTag($AäÛè¥¿†˜, $b“œ‘…ò…, $f“é¸Ìù¯®) { $bà‹Œ¢ôô =& $_SERVER[©äõ½¡]; if (!$this->getByTagID($AäÛè¥¿†˜, $f“é¸Ìù¯®) || !$b“œ‘…ò…) { return !1; } if (is_array($b“œ‘…ò…)) { $b“œ‘…ò… = array($bà‹Œ¢ôô[7], $b“œ‘…ò…); } $B¥²àĞŒ¼ = array($bà‹Œ¢ôô[1555] => 0, $bà‹Œ¢ôô[477] => $f“é¸Ìù¯®, $bà‹Œ¢ôô[417] => $bà‹Œ¢ôô[1848] . $AäÛè¥¿†˜, $bà‹Œ¢ôô[416] => $b“œ‘…ò…); return $this->where($B¥²àĞŒ¼)->delete(); } protected function removeByTag($e™ãÆìµç, $d‚àëº¼Ú‡) { $E¦ÄòÕ´Ò =& $_SERVER[©äõ½¡]; if (!$this->getByTagID($e™ãÆìµç, $d‚àëº¼Ú‡)) { return !1; } $bˆ¥Ë“ˆ˜ = array($E¦ÄòÕ´Ò[1555] => 0, $E¦ÄòÕ´Ò[477] => $d‚àëº¼Ú‡, $E¦ÄòÕ´Ò[417] => $E¦ÄòÕ´Ò[1848] . $e™ãÆìµç); return $this->where($bˆ¥Ë“ˆ˜)->delete(); } protected function removeBySource($b ğĞ›¬ôÌ, $eŒœºá¹®) { $C¤¯®×ƒ† =& $_SERVER[©äõ½¡]; if (!$b ğĞ›¬ôÌ || !$eŒœºá¹®) { return !1; } if (is_array($eŒœºá¹®)) { $eŒœºá¹® = array($C¤¯®×ƒ†[7], $eŒœºá¹®); } $DêÑˆº÷Éß = array($C¤¯®×ƒ†[1555] => 0, $C¤¯®×ƒ†[416] => $eŒœºá¹®, $C¤¯®×ƒ†[477] => array($C¤¯®×ƒ†[1006], 0), $C¤¯®×ƒ†[417] => $C¤¯®×ƒ†[1848] . $b ğĞ›¬ôÌ); return $this->where($DêÑˆº÷Éß)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\155\56\160\x6c\x75\x67\151\x6e\114\151\x73\164"; public $field = array("\156\x61\x6d\x65", "\x73\x74\x61\x74\x75\x73", "\x72\x65\147\151\x65\x73\164", "\x63\x6f\156\146\151\147"); public function loadList($CÜ¾°ÉÓÆ = false) { $c ĞÓàÃ = array_to_keyvalue($this->listData(), $_SERVER[©äõ½¡][28]); if ($CÜ¾°ÉÓÆ) { return $c ĞÓàÃ[$CÜ¾°ÉÓÆ]; } return $c ĞÓàÃ; } public function init() { $fØîª™´¹ =& $_SERVER[©äõ½¡]; Hook::trigger($fØîª™´¹[1849]); $bø…î£† = $this->loadPluginList(); foreach ($bø…î£† as $Cá“†ùÆ®Ğ => $BŒ¬ƒÊ‹î’) { $E¸÷åêÊ»Ë = $this->appAllow($Cá“†ùÆ®Ğ, $BŒ¬ƒÊ‹î’); if (!$E¸÷åêÊ»Ë) { continue; } foreach ($BŒ¬ƒÊ‹î’[$fØîª™´¹[1850]] as $e‘ŞñÓ => $EòªÌ”šå¤) { Hook::bind($e‘ŞñÓ, $EòªÌ”šå¤); } } Hook::trigger($fØîª™´¹[1851]); Hook::trigger(ACTION); } public function appAllow($D¢¢êåŞº, $e…¢È×º À, $cëãˆ«“´î = true) { $FµÊïé¹‰ö =& $_SERVER[©äõ½¡]; $DÖà«ßĞ„ = PLUGIN_DIR . $D¢¢êåŞº . $FµÊïé¹‰ö[1852]; if (!is_array($e…¢È×º À) || !is_array($e…¢È×º À[$FµÊïé¹‰ö[1850]]) || $e…¢È×º À[$FµÊïé¹‰ö[745]] != 1 || !is_file($DÖà«ßĞ„)) { return !1; } if ($GLOBALS[$FµÊïé¹‰ö[499]] == 1) { return !0; } if ($cëãˆ«“´î && !Action($FµÊïé¹‰ö[1853])->checkAuth($D¢¢êåŞº)) { return !1; } return !0; } public function unInstall($EŠìÕ„È¯ä) { $FÛëŒŒĞ£Ğ =& $_SERVER[©äõ½¡]; $fª…ÌƒÓœĞ = $this->loadList($EŠìÕ„È¯ä); if (file_exists(PLUGIN_DIR . $EŠìÕ„È¯ä)) { Hook::apply($EŠìÕ„È¯ä . $FÛëŒŒĞ£Ğ[1854]); } $this->remove($fª…ÌƒÓœĞ[$FÛëŒŒĞ£Ğ[395]]); } public function changeStatus($AÆ‰Ö’º¿, $C‚àÂÉ…Ñƒ) { $FÈÚ‘ÒÊÈ± =& $_SERVER[©äõ½¡]; $EˆÉçù‹êì = $this->loadList($AÆ‰Ö’º¿); if ($C‚àÂÉ…Ñƒ) { Hook::apply($AÆ‰Ö’º¿ . $FÈÚ‘ÒÊÈ±[1855]); } $this->update($EˆÉçù‹êì[$FÈÚ‘ÒÊÈ±[395]], array($FÈÚ‘ÒÊÈ±[1856] => $C‚àÂÉ…Ñƒ)); } public function appRegist($c…³¦†‹ËÍ, $bó¬´Ñ†óã) { $CÈùŠòÓ†ô =& $_SERVER[©äõ½¡]; $cÏííïà‡ = $this->loadList($c…³¦†‹ËÍ); if ($cÏííïà‡) { $this->update($cÏííïà‡[$CÈùŠòÓ†ô[395]], array($CÈùŠòÓ†ô[1850] => $bó¬´Ñ†óã)); } else { $b“‘´™ß»® = array($CÈùŠòÓ†ô[28] => $c…³¦†‹ËÍ, $CÈùŠòÓ†ô[1850] => $bó¬´Ñ†óã, $CÈùŠòÓ†ô[745] => 0, $CÈùŠòÓ†ô[6] => $this->getConfigDefault($c…³¦†‹ËÍ)); $this->insert($b“‘´™ß»®); } } public function getConfigDefault($c­ÖÄ¦àÕº) { $d’Æà­Ÿ‚ñ =& $_SERVER[©äõ½¡]; $c˜À¬¾Ş¿† = array(); $Eó¹ÔÍ»ó— = $this->getPackageJson($c­ÖÄ¦àÕº); if (!$Eó¹ÔÍ»ó— && is_array($Eó¹ÔÍ»ó—[$d’Æà­Ÿ‚ñ[1857]])) { return $c˜À¬¾Ş¿†; } foreach ($Eó¹ÔÍ»ó—[$d’Æà­Ÿ‚ñ[1857]] as $Eªù¦ÑÁä˜ => $AÌº–…õ¦) { if (!isset($AÌº–…õ¦[$d’Æà­Ÿ‚ñ[372]]) || isset($c˜À¬¾Ş¿†[$Eªù¦ÑÁä˜])) { continue; } $c˜À¬¾Ş¿†[$Eªù¦ÑÁä˜] = $AÌº–…õ¦[$d’Æà­Ÿ‚ñ[372]]; } return $c˜À¬¾Ş¿†; } public function getPackageJson($dó×êƒí¶Ğ) { return Hook::apply($dó×êƒí¶Ğ . $_SERVER[©äõ½¡][1858]); } public function getConfig($bíÉÔ­ğŠ, $fùğ†á†ä¾ = false) { $D‘Äƒ•é™³ =& $_SERVER[©äõ½¡]; $e²©ªà£Ä½ = array(); $b†áˆøØó‡ = $this->loadList($bíÉÔ­ğŠ); if ($b†áˆøØó‡ && is_array($b†áˆøØó‡[$D‘Äƒ•é™³[6]])) { $e²©ªà£Ä½ = $b†áˆøØó‡[$D‘Äƒ•é™³[6]]; } if (!$e²©ªà£Ä½ || $fùğ†á†ä¾) { $e²©ªà£Ä½ = $this->getConfigDefault($bíÉÔ­ğŠ); } return $e²©ªà£Ä½; } public function setConfig($F÷É†ÉîŠ, $A‹éÈøÄõ = false) { goto e£å¤Š»ÀÜ; dÖ„‚ÆÌëˆ: $this->update($cë¹™È°İ©[$dµÏƒÛóâã[395]], array($dµÏƒÛóâã[6] => $cÑÁÌ¶’Ã)); goto Cõ°ÈÜÉÂÕ; e£å¤Š»ÀÜ: $dµÏƒÛóâã =& $_SERVER[©äõ½¡]; $cë¹™È°İ© = $this->loadList($F÷É†ÉîŠ); if (!$cë¹™È°İ©) { return !1; } goto b‘ğòìï„Â; b‘ğòìï„Â: $cÑÁÌ¶’Ã = $cë¹™È°İ©[$dµÏƒÛóâã[6]]; if ($A‹éÈøÄõ == !1) { $cÑÁÌ¶’Ã = array(); $A‹éÈøÄõ = $this->getConfigDefault($F÷É†ÉîŠ); } foreach ($A‹éÈøÄõ as $AØ¶Ñİªê => $FÁçåß¿·‰) { $cÑÁÌ¶’Ã[$AØ¶Ñİªê] = is_string($FÁçåß¿·‰) ? trim($FÁçåß¿·‰) : $FÁçåß¿·‰; } goto dÖ„‚ÆÌëˆ; Cõ°ÈÜÉÂÕ: } public function viewList() { goto eÅôÛÆÂ«Ê; c ÈŠ¤İ•º: return $E»³Ô¹‚ß•; goto DöÇÈ¤Õ´; eÅôÛÆÂ«Ê: $f‰ïÙ¬­‚ =& $_SERVER[©äõ½¡]; $FÜ¨ÉÚŞàÂ = $this->loadList(); $this->pluginScan($FÜ¨ÉÚŞàÂ); goto FïˆÅõ“¼; FïˆÅõ“¼: $FÜ¨ÉÚŞàÂ = $this->loadPluginList(); $E»³Ô¹‚ß• = array(); foreach ($FÜ¨ÉÚŞàÂ as $fõµù¯é„Ô => $E¬…Ó¤»İ–) { unset($E¬…Ó¤»İ–[$f‰ïÙ¬­‚[1850]], $E¬…Ó¤»İ–[$f‰ïÙ¬­‚[6]]); $D‡É¿§¸ÛÚ = PLUGIN_DIR . $E¬…Ó¤»İ–[$f‰ïÙ¬­‚[28]] . $f‰ïÙ¬­‚[1852]; if (!is_file($D‡É¿§¸ÛÚ)) { continue; } $cà–ÎĞ¸› = Hook::apply($E¬…Ó¤»İ–[$f‰ïÙ¬­‚[28]] . $f‰ïÙ¬­‚[1858]); if (is_array($cà–ÎĞ¸›)) { $E»³Ô¹‚ß•[$fõµù¯é„Ô] = array_merge($E¬…Ó¤»İ–, $cà–ÎĞ¸›); } } goto c ÈŠ¤İ•º; DöÇÈ¤Õ´: } private function loadPluginList() { $d—¾Î©ñ©· =& $_SERVER[©äõ½¡]; $c×Û¤¬Ğ¬ = $this->loadList(); if (strtolower(MOD) == $d—¾Î©ñ©·[1859]) { return $c×Û¤¬Ğ¬; } $cÂ Ş£¦é  = Hook::trigger($d—¾Î©ñ©·[1860], $c×Û¤¬Ğ¬); if ($c×Û¤¬Ğ¬ && !$cÂ Ş£¦é ) { die; } return $cÂ Ş£¦é  ? $cÂ Ş£¦é  : $c×Û¤¬Ğ¬; } private function pluginScan($Bô†½ˆŸ¼£) { $Fç³Ë·¶ =& $_SERVER[©äõ½¡]; recursion_dir(PLUGIN_DIR, $bŸ³ˆ’´, $fÈ‘å˜ˆÇô, 0); foreach ($bŸ³ˆ’´ as $eÈßùŠÔ«) { $a ×Æ«öŸĞ = get_path_this($eÈßùŠÔ«); if (isset($Bô†½ˆŸ¼£[$a ×Æ«öŸĞ]) || !file_exists($eÈßùŠÔ« . $Fç³Ë·¶[1861]) || !file_exists($eÈßùŠÔ« . $Fç³Ë·¶[1852])) { continue; } Hook::apply($a ×Æ«öŸĞ . $Fç³Ë·¶[1855]); } } } goto dŒ´‘ÕŠ; F¿İ¿„‡µš: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $A‰ßóƒ ­¡ =& $_SERVER[©äõ½¡]; $this->objectDriver = array($A‰ßóƒ ­¡[57], $A‰ßóƒ ­¡[58], $A‰ßóƒ ­¡[59], $A‰ßóƒ ­¡[60], $A‰ßóƒ ­¡[61], $A‰ßóƒ ­¡[62], $A‰ßóƒ ­¡[63], $A‰ßóƒ ­¡[64], $A‰ßóƒ ­¡[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($FŒÖ‘×’ÏÜ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($FŒÖ‘×’ÏÜ, $_SERVER[©äõ½¡][8]); } return $FŒÖ‘×’ÏÜ; } public function iconvApp($Cï©™¹Ğ) { return $Cï©™¹Ğ; } public function iconvSystem($D‰ÈÔË¼Ä) { return $D‰ÈÔË¼Ä; } public function iconvTo($EÅø–Ì‚, $b¸—ˆÄè ¢, $fò¯ø›Ñ¦) { goto EøÎ¡ÒÓ¡Å; d¤¸›·é®›: $EøŒì½¥ƒÃ = $b¸—ˆÄè ¢ . $e‡’ÄÆºÊ©[67] . $fò¯ø›Ñ¦ . $e‡’ÄÆºÊ©[68] . $EÅø–Ì‚; if (isset($A©†Ü¨Úå¿[$EøŒì½¥ƒÃ])) { return $A©†Ü¨Úå¿[$EøŒì½¥ƒÃ]; } if (function_exists($e‡’ÄÆºÊ©[69])) { $E¨·ÙŠèã = @mb_convert_encoding($EÅø–Ì‚, $fò¯ø›Ñ¦, $b¸—ˆÄè ¢); } else { $E¨·ÙŠèã = @iconv($b¸—ˆÄè ¢, $fò¯ø›Ñ¦, $EÅø–Ì‚); } goto eõŠ•› ˜Ş; eõŠ•› ˜Ş: $E¨·ÙŠèã = $E¨·ÙŠèã ? $E¨·ÙŠèã : $EÅø–Ì‚; if (strstr($E¨·ÙŠèã, $e‡’ÄÆºÊ©[70])) { $E¨·ÙŠèã = str_replace($e‡’ÄÆºÊ©[70], $e‡’ÄÆºÊ©[71], $E¨·ÙŠèã); } $A©†Ü¨Úå¿[$b¸—ˆÄè ¢ . $e‡’ÄÆºÊ©[67] . $fò¯ø›Ñ¦ . $e‡’ÄÆºÊ©[68] . $EÅø–Ì‚] = $E¨·ÙŠèã; goto bÓ˜áÄõÉ»; bÓ˜áÄõÉ»: $A©†Ü¨Úå¿[$fò¯ø›Ñ¦ . $e‡’ÄÆºÊ©[67] . $b¸—ˆÄè ¢ . $e‡’ÄÆºÊ©[68] . $EÅø–Ì‚] = $EÅø–Ì‚; $A©†Ü¨Úå¿[$fò¯ø›Ñ¦ . $e‡’ÄÆºÊ©[67] . $b¸—ˆÄè ¢ . $e‡’ÄÆºÊ©[68] . $E¨·ÙŠèã] = $EÅø–Ì‚; $A©†Ü¨Úå¿[$b¸—ˆÄè ¢ . $e‡’ÄÆºÊ©[67] . $fò¯ø›Ñ¦ . $e‡’ÄÆºÊ©[68] . $E¨·ÙŠèã] = $E¨·ÙŠèã; goto a‚Ó¤—Š; EøÎ¡ÒÓ¡Å: $e‡’ÄÆºÊ© =& $_SERVER[©äõ½¡]; if (!$EÅø–Ì‚ || !function_exists($e‡’ÄÆºÊ©[66])) { return $EÅø–Ì‚; } static $A©†Ü¨Úå¿ = array(); goto d¤¸›·é®›; a‚Ó¤—Š: return $E¨·ÙŠèã; goto Fãì˜ÑŞå; Fãì˜ÑŞå: } public function getPathInner($báÁïÑ£ã) { $B³ÀÔÔ†¼† = IO::init($báÁïÑ£ã); return $B³ÀÔÔ†¼†->path; } public function getPathOuter($F¨ƒôˆ¿—Ö) { $e‚»»³Ã«Œ =& $_SERVER[©äõ½¡]; $b¼‘¿ô·…® = strlen(trim($this->pathBase, $e‚»»³Ã«Œ[8])); $F¨ƒôˆ¿—Ö = substr(trim($F¨ƒôˆ¿—Ö, $e‚»»³Ã«Œ[8]), $b¼‘¿ô·…®); return $this->pathDriver . $e‚»»³Ã«Œ[8] . ltrim($F¨ƒôˆ¿—Ö, $e‚»»³Ã«Œ[8]); } public function isParentOf($b­ø™È¸±, $c—¯ÀÑøñÁ) { $c§Ö×´š¸Æ =& $_SERVER[©äõ½¡]; $b­ø™È¸± = rtrim(strtolower($b­ø™È¸±), $c§Ö×´š¸Æ[8]) . $c§Ö×´š¸Æ[8]; $c—¯ÀÑøñÁ = rtrim(strtolower($c—¯ÀÑøñÁ), $c§Ö×´š¸Æ[8]) . $c§Ö×´š¸Æ[8]; $E¼–ÃÙÊŒ = strpos($c—¯ÀÑøñÁ, $b­ø™È¸±) === 0; return $E¼–ÃÙÊŒ; } public function getType() { $c³ÆÚÆÌô¡ =& $_SERVER[©äõ½¡]; $e™»¥´õœÂ = str_replace($c³ÆÚÆÌô¡[72], $c³ÆÚÆÌô¡[33], get_class($this)); return strtolower($e™»¥´õœÂ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($b¡»¾”™Û×, $fí‹ÒÀ”˜Š) { $DÈõÂè» =& $_SERVER[©äõ½¡]; $e±–ÔÃ¯–É = rtrim($b¡»¾”™Û×, $DÈõÂè»[8]) . $DÈõÂè»[8] . $fí‹ÒÀ”˜Š; $b¹¡ÅÓÑò = $this->exist($e±–ÔÃ¯–É); return $b¹¡ÅÓÑò ? $e±–ÔÃ¯–É : !1; } public function setModifyTime($D–š†ÂÏ¬, $EäÓ‚Øè = '') { } public function renameObject($a†¼‰¸Îçæ, $c‡÷‰¯Œ) { goto cÓ„‚ÏÛ¤; fé•Ÿ“º†: $a†¼‰¸Îçæ = $this->getPathOuter($a†¼‰¸Îçæ); $c‡÷‰¯Œ = $this->pathFather($a†¼‰¸Îçæ) . $c‡÷‰¯Œ; if (IO::isFile($a†¼‰¸Îçæ)) { $fĞŒÌ¿ÔË = IO::copy($a†¼‰¸Îçæ, $this->pathFather($a†¼‰¸Îçæ), REPEAT_RENAME_FOLDER, $FÏÁç½…­‡); if ($fĞŒÌ¿ÔË) { IO::remove($a†¼‰¸Îçæ); } } else { $fĞŒÌ¿ÔË = IO::mkdir($c‡÷‰¯Œ); if (!$fĞŒÌ¿ÔË) { return !1; } $F°½ ¹ğˆŠ = IO::listPath($a†¼‰¸Îçæ, !0); $eã¾Ó…Øà = array_merge($F°½ ¹ğˆŠ[$E©ğˆË·Ìâ[74]], $F°½ ¹ğˆŠ[$E©ğˆË·Ìâ[75]]); foreach ($eã¾Ó…Øà as $D†øöÓâ¼) { IO::move($D†øöÓâ¼[$E©ğˆË·Ìâ[76]], $c‡÷‰¯Œ, REPEAT_RENAME_FOLDER); } IO::remove($a†¼‰¸Îçæ); } goto A‰³éìŞ‹è; A‰³éìŞ‹è: return $fĞŒÌ¿ÔË ? $c‡÷‰¯Œ : !1; goto B„Øî“ÔÃÍ; cÓ„‚ÏÛ¤: $E©ğˆË·Ìâ =& $_SERVER[©äõ½¡]; $FÏÁç½…­‡ = $c‡÷‰¯Œ; Hook::trigger($E©ğˆË·Ìâ[73], $this, $a†¼‰¸Îçæ, $this, $this->pathFather($a†¼‰¸Îçæ) . $c‡÷‰¯Œ); goto fé•Ÿ“º†; B„Øî“ÔÃÍ: } public function tempFile($aÉŠƒ©ÙÑ° = '', $cÜ½Í´Ş¨ó = '') { goto Fæ¥¨ÉË¦; a¶äÚŞÏìØ: $f²ƒ£İó´‡ = $AöŠ¸µ…¹‡ . $aÉŠƒ©ÙÑ°; @touch($f²ƒ£İó´‡); if ($cÜ½Í´Ş¨ó) { file_put_contents($f²ƒ£İó´‡, $cÜ½Í´Ş¨ó); } goto fšŠĞ™ç°É; Fæ¥¨ÉË¦: if (!$aÉŠƒ©ÙÑ°) { $aÉŠƒ©ÙÑ° = rand_string(15); } $AöŠ¸µ…¹‡ = TEMP_FILES . rand_string(15) . $_SERVER[©äõ½¡][8]; @mkdir($AöŠ¸µ…¹‡, DEFAULT_PERRMISSIONS, !0); goto a¶äÚŞÏìØ; fšŠĞ™ç°É: return $f²ƒ£İó´‡; goto eÜä‡‘ó; eÜä‡‘ó: } public function tempFileRemve($DØï´…ìñö) { @unlink($DØï´…ìñö); @rmdir($this->pathFather($DØï´…ìñö)); } public function mkfile($báÙî·¾ë’, $a˜Šî¤§¸ = '', $aË‹«®¾¢’ = REPEAT_RENAME) { } public function mkdir($e âËÓø×, $E‰²£ôÒğ = REPEAT_SKIP) { } public function delFile($dÁòÃùæšˆ) { } public function delFolder($fÏ¶æƒ‡á•) { } public function copyFile($Aç†ÒÉ–¨Ã, $B¤¨Ÿàæ‰À) { } public function moveFile($c‹èŒ®È, $Aæ”×ÉĞ†«) { } public function remove($f—“µˆĞêÓ) { if ($this->isFile($f—“µˆĞêÓ)) { return $this->delFile($f—“µˆĞêÓ); } return $this->delFolder($f—“µˆĞêÓ); } public function rename($A”Ù‡ê­‘©, $a„âß³„« ) { } public function exist($f¾ßÜÍ»­‰) { } public function findByHash($cŠà‚ñ¨¯Œ = '', $F‰ŞÏ»£°Û = '') { return !1; } public function isFile($F‘çå’óŠ) { } public function isFolder($AçÕ ¨Äê†) { } public function size($Fá¼èğ¥ÁÒ) { } public function info($c«èÂò¾èŠ) { } public function infoSimple($b¾ëÖ‹ë’) { return $this->info($b¾ëÖ‹ë’); } public function infoAuth($D£„š…¤¯’) { return $this->info($D£„š…¤¯’); } public function infoFull($d—¢½­¼) { return $this->info($d—¢½­¼); } public function infoWithChildren($Bî¸’“°·) { $AáÍ¸«ó =& $_SERVER[©äõ½¡]; static $DãñÄİ•Ú² = array(); if (isset($DãñÄİ•Ú²[$Bî¸’“°·])) { return $DãñÄİ•Ú²[$Bî¸’“°·]; } $EÓô§êŠê‰ = $this->info($Bî¸’“°·); if ($EÓô§êŠê‰ && $EÓô§êŠê‰[$AáÍ¸«ó[29]] == $AáÍ¸«ó[77]) { $dçá£©áŸî = array($AáÍ¸«ó[78] => 0, $AáÍ¸«ó[79] => 0, $AáÍ¸«ó[80] => 0); $this->infoChildren($Bî¸’“°·, $dçá£©áŸî); $EÓô§êŠê‰[$AáÍ¸«ó[78]] = $dçá£©áŸî[$AáÍ¸«ó[78]]; $EÓô§êŠê‰[$AáÍ¸«ó[81]] = array($AáÍ¸«ó[82] => $dçá£©áŸî[$AáÍ¸«ó[79]], $AáÍ¸«ó[83] => $dçá£©áŸî[$AáÍ¸«ó[80]]); $DãñÄİ•Ú²[$Bî¸’“°·] = $EÓô§êŠê‰; } return $EÓô§êŠê‰; } public function listPath($D÷¤¬ †Õ×, $dÔæ—” = false) { } public function has($e‡Œä’Ä‘Ú, $CÎ—²Œ®–î = false, $EÈÒ²Í×·Õ = false) { } public function canRead($Fº­‘„ÊÅ) { } public function canWrite($c„‡·ã°„) { } public function getContent($DåÛ¼°¦à) { } public function setContent($aäÂ•’òÌÏ, $A³¿ÅñÁ = '') { } protected function infoChildren($aß¡àâ¦Ã˜, &$d…ïíÖ§”ö) { $F‹Ùœ£¶ŒÊ =& $_SERVER[©äõ½¡]; check_abort_echo(); $C¢Ä‰øÄÙí = $this->listPath($aß¡àâ¦Ã˜, !0); $C¢Ä‰øÄÙí = array_merge($C¢Ä‰øÄÙí[$F‹Ùœ£¶ŒÊ[75]], $C¢Ä‰øÄÙí[$F‹Ùœ£¶ŒÊ[74]]); foreach ($C¢Ä‰øÄÙí as $CİÉßŞÍñ„) { if ($CİÉßŞÍñ„[$F‹Ùœ£¶ŒÊ[29]] == $F‹Ùœ£¶ŒÊ[77]) { $d…ïíÖ§”ö[$F‹Ùœ£¶ŒÊ[80]]++; $FÙ†©²´ö  = $this->getPathInner($CİÉßŞÍñ„[$F‹Ùœ£¶ŒÊ[76]]); $this->infoChildren($FÙ†©²´ö , $d…ïíÖ§”ö); } else { $d…ïíÖ§”ö[$F‹Ùœ£¶ŒÊ[79]]++; $d…ïíÖ§”ö[$F‹Ùœ£¶ŒÊ[78]] += $CİÉßŞÍñ„[$F‹Ùœ£¶ŒÊ[78]]; } } } public function fileSubstr($e§¦èëÂ‹ù, $a†„Çˆ¬·, $B»›ñÉ³æÉ) { } public function listAll($f„¸ŒÕˆÓù) { } public function listAllMake($AŒë¡íñ¢, &$eÆ¯Å­å) { $a˜«åˆ´ù =& $_SERVER[©äõ½¡]; check_abort_echo(); $EøİÖ †Æ = $this->listPath($AŒë¡íñ¢, !0); if (!$EøİÖ †Æ) { return; } $E í‡¢°¹Ü = array_merge($EøİÖ †Æ[$a˜«åˆ´ù[75]], $EøİÖ †Æ[$a˜«åˆ´ù[74]]); foreach ($E í‡¢°¹Ü as $BÃŸ¬–¦æ˜) { goto b„ß¨»õå¶; b„±ùÌ£±ˆ: $this->listAllMake($BÃŸ¬–¦æ˜[$a˜«åˆ´ù[76]], $eÆ¯Å­å); goto aŠè†È˜ß‹; b„ß¨»õå¶: $AŒ÷ã‡÷ = $BÃŸ¬–¦æ˜[$a˜«åˆ´ù[29]] == $a˜«åˆ´ù[77]; $Eª™¼¥Úø¤ = array($a˜«åˆ´ù[76] => $BÃŸ¬–¦æ˜[$a˜«åˆ´ù[76]], $a˜«åˆ´ù[77] => $AŒ÷ã‡÷); if (isset($BÃŸ¬–¦æ˜[$a˜«åˆ´ù[78]])) { $Eª™¼¥Úø¤[$a˜«åˆ´ù[78]] = $BÃŸ¬–¦æ˜[$a˜«åˆ´ù[78]]; } goto bÔìàñĞ; bÔìàñĞ: if (isset($BÃŸ¬–¦æ˜[$a˜«åˆ´ù[84]])) { $Eª™¼¥Úø¤[$a˜«åˆ´ù[84]] = $BÃŸ¬–¦æ˜[$a˜«åˆ´ù[84]]; } if (!$AŒ÷ã‡÷) { $eÆ¯Å­å[] = $Eª™¼¥Úø¤; continue; } $eÆ¯Å­å[] = $Eª™¼¥Úø¤; goto b„±ùÌ£±ˆ; aŠè†È˜ß‹: } } public function listAllSimple($BÚÄ®ğ å¢) { $Bå„Æ©½¿¦ =& $_SERVER[©äõ½¡]; $DçÛĞÑ’Û = array(); $B¼ù½Ô¹†“ = $this->listAll($BÚÄ®ğ å¢); $A¼²¬Œ±® = $this->getPathOuter($BÚÄ®ğ å¢); foreach ($B¼ù½Ô¹†“ as $Dò­È¸õÛÔ) { goto dšç«­‘À¦; EŠå²‘¤‘Ç: if (!$Dò­È¸õÛÔ[$Bå„Æ©½¿¦[77]]) { $E¯º†ÑÕ»ˆ[$Bå„Æ©½¿¦[86]] = $aµâé¨ì‚; } $DçÛĞÑ’Û[] = $E¯º†ÑÕ»ˆ; goto bÀ»‘àåÒ; Bá¨¬Ì»ñÚ: $E¯º†ÑÕ»ˆ = array($Bå„Æ©½¿¦[76] => $B‹ÚÍá›ß¥, $Bå„Æ©½¿¦[77] => $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[77]]); if (isset($Dò­È¸õÛÔ[$Bå„Æ©½¿¦[78]]) && !$Dò­È¸õÛÔ[$Bå„Æ©½¿¦[77]]) { $E¯º†ÑÕ»ˆ[$Bå„Æ©½¿¦[78]] = $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[78]]; } if (isset($Dò­È¸õÛÔ[$Bå„Æ©½¿¦[84]])) { $E¯º†ÑÕ»ˆ[$Bå„Æ©½¿¦[84]] = $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[84]]; } goto EŠå²‘¤‘Ç; dšç«­‘À¦: $aµâé¨ì‚ = $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[76]]; $B‹ÚÍá›ß¥ = $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[76]]; if (isset($Dò­È¸õÛÔ[$Bå„Æ©½¿¦[85]])) { $aµâé¨ì‚ = $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[85]][$Bå„Æ©½¿¦[76]]; $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[78]] = $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[85]][$Bå„Æ©½¿¦[78]]; $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[84]] = $Dò­È¸õÛÔ[$Bå„Æ©½¿¦[85]][$Bå„Æ©½¿¦[84]]; } else { $B‹ÚÍá›ß¥ = substr($Dò­È¸õÛÔ[$Bå„Æ©½¿¦[76]], strlen(get_path_father($A¼²¬Œ±®))); $B‹ÚÍá›ß¥ = $Bå„Æ©½¿¦[8] . ltrim($B‹ÚÍá›ß¥, $Bå„Æ©½¿¦[8]); } goto Bá¨¬Ì»ñÚ; bÀ»‘àåÒ: } return $DçÛĞÑ’Û; } public function upload($Eçà‚•ŸŸŞ, $A”ƒ³Â³, $bªß®Á›ä– = false, $e¹ÙãËìŒ = REPEAT_REPLACE) { } public function uploadFileByID($Aä…ŠÉï’ù, $dó­ÙÊ¥, $C¨Î¯“Åœ¸) { } public function uploadFileByPath($c¿–â†÷©, $A“²°ë¥Í, $FÜ‘ÔÃÊÓÎ = array()) { } public function isUploadServer() { $AË›è‹ò‘î =& $_SERVER[©äõ½¡]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $AË›è‹ò‘î[87]) { return !0; } return $GLOBALS[$AË›è‹ò‘î[6]][$AË›è‹ò‘î[88]][$AË›è‹ò‘î[89]]; } public function isFileOutServer() { $BÂ–‹¤²»» =& $_SERVER[©äõ½¡]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $BÂ–‹¤²»»[87]) { return !0; } return $GLOBALS[$BÂ–‹¤²»»[6]][$BÂ–‹¤²»»[88]][$BÂ–‹¤²»»[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($C„ø†’®µù) { $dÔ›ƒåõÔˆ =& $_SERVER[©äõ½¡]; if (!$this->isCdnHost()) { return $C„ø†’®µù; } return str_replace(trim(get_url_root($C„ø†’®µù), $dÔ›ƒåõÔˆ[8]), trim($this->cdnHost, $dÔ›ƒåõÔˆ[8]), $C„ø†’®µù); } public function uploadLink($fšáˆšã°‡, $dŸòÁ“½¿‚ = 0) { goto c˜ŞŠëº; E¼³Ÿ¤Ş‚†: $c‹Ñ¤ ‘ò = $dŸòÁ“½¿‚ <= $E­Úªš„» ? $d•ÔŒ·íÒò[91] : $d•ÔŒ·íÒò[92]; $Cß¢‡‰Ëšİ = (!$dŸòÁ“½¿‚ ? 1 : ceil($dŸòÁ“½¿‚ / pow(1024, 3))) * 3600 * 4; $Cê‹öù‚¢½ = $this->{$c‹Ñ¤ ‘ò}($fšáˆšã°‡, $Cß¢‡‰Ëšİ); goto A“éÇÀÒİƒ; D¿ÓÄ‰ä“š: if (!in_array($E£´Œóã÷§, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $E­Úªš„» = 1024 * 1024 * 10; goto E¼³Ÿ¤Ş‚†; c˜ŞŠëº: $d•ÔŒ·íÒò =& $_SERVER[©äõ½¡]; if ($this->isUploadServer()) { return; } $E£´Œóã÷§ = $this->getType(); goto D¿ÓÄ‰ä“š; A“éÇÀÒİƒ: if ($Cê‹öù‚¢½) { $Cê‹öù‚¢½[$d•ÔŒ·íÒò[93]] = $fšáˆšã°‡; $Cê‹öù‚¢½[$d•ÔŒ·íÒò[94]] = $E£´Œóã÷§; } return $Cê‹öù‚¢½; goto AñôƒÙÁ‡ß; AñôƒÙÁ‡ß: } public function uploadFormData($C±”¶ÄÛ‚ƒ, $FÙğÃñÆ¨ = 3600) { } public function multiUploadFormData($DÕçš¼ï, $C£¯šà­ÚÁ = 3600) { } public function download($CÑª„¥“µµ, $F‰²×ƒ‰Ş) { } public function ext($Bì…Û¦±ò) { $E¢Ãä®øÑ =& $_SERVER[©äõ½¡]; if (strpos($Bì…Û¦±ò, $E¢Ãä®øÑ[8]) === -1) { $d¦Š»ã‘ƒ = $Bì…Û¦±ò; } else { $d¦Š»ã‘ƒ = $this->pathThis($Bì…Û¦±ò); } $fàÀÎÄí‹Ô = $E¢Ãä®øÑ[33]; if (strstr($d¦Š»ã‘ƒ, $E¢Ãä®øÑ[95])) { $fàÀÎÄí‹Ô = substr($d¦Š»ã‘ƒ, strrpos($d¦Š»ã‘ƒ, $E¢Ãä®øÑ[95]) + 1); $fàÀÎÄí‹Ô = strtolower($fàÀÎÄí‹Ô); } if (strlen($fàÀÎÄí‹Ô) > 3 && preg_match($E¢Ãä®øÑ[96], $fàÀÎÄí‹Ô, $dŞ½±±Æ×Ô)) { $fàÀÎÄí‹Ô = $E¢Ãä®øÑ[33]; } return $fàÀÎÄí‹Ô; } public function pathThis($F‰İÃå©á) { $fî¤ë›¡ÇÀ =& $_SERVER[©äõ½¡]; $F‰İÃå©á = str_replace($fî¤ë›¡ÇÀ[97], $fî¤ë›¡ÇÀ[8], rtrim($F‰İÃå©á, $fî¤ë›¡ÇÀ[8])); $e­°æŠİè = strrpos($F‰İÃå©á, $fî¤ë›¡ÇÀ[8]); if ($e­°æŠİè === !1) { return $F‰İÃå©á; } return substr($F‰İÃå©á, $e­°æŠİè + 1); } public function pathFather($dšÎ·…¼Å­) { $C„”öƒ×—  =& $_SERVER[©äõ½¡]; $dšÎ·…¼Å­ = str_replace($C„”öƒ×— [97], $C„”öƒ×— [8], rtrim($dšÎ·…¼Å­, $C„”öƒ×— [8])); $D…Åæ±®ª = strrpos($dšÎ·…¼Å­, $C„”öƒ×— [8]); if ($D…Åæ±®ª === !1) { return $C„”öƒ×— [33]; } return substr($dšÎ·…¼Å­, 0, $D…Åæ±®ª + 1); } public function hashSimple($B‹ÕÕ¹ÙĞÁ) { goto CñÌ÷¿¹é¬; f¿øÏ‘„æ: $bŠŠÊ§“ÙÍ = intval($B¹õëá‹Ú / $B¬ïß«À¾…); $FŠØƒÆªˆ¦ = $a„ñÉ¹¥[33]; for ($DœÎŠÎ«›» = 0; $DœÎŠÎ«›» < $B¬ïß«À¾…; $DœÎŠÎ«›»++) { $FŠØƒÆªˆ¦ .= $this->fileSubstr($B‹ÕÕ¹ÙĞÁ, $bŠŠÊ§“ÙÍ * $DœÎŠÎ«›», $d À£óÚò±); } goto bòÊ®÷³öš; b š·ê‹©: $d À£óÚò± = 200; $B¬ïß«À¾… = 50; if ($B¹õëá‹Ú <= $d À£óÚò± * $B¬ïß«À¾…) { return $this->hashMd5($B‹ÕÕ¹ÙĞÁ) . $B¹õëá‹Ú; } goto f¿øÏ‘„æ; CñÌ÷¿¹é¬: $a„ñÉ¹¥ =& $_SERVER[©äõ½¡]; if (!$B‹ÕÕ¹ÙĞÁ) { return md5($a„ñÉ¹¥[33]); } $B¹õëá‹Ú = $this->size($B‹ÕÕ¹ÙĞÁ); goto b š·ê‹©; bòÊ®÷³öš: $FŠØƒÆªˆ¦ .= $this->fileSubstr($B‹ÕÕ¹ÙĞÁ, $B¹õëá‹Ú - $d À£óÚò±, $d À£óÚò±); return md5($FŠØƒÆªˆ¦) . $B¹õëá‹Ú; goto EÍ‰­Û¼Ù; EÍ‰­Û¼Ù: } public static $md5Cache = array(); public function hashMd5($c½Ñ‚Ãêíê) { $c½Ñ‚Ãêíê = $this->iconvSystem($c½Ñ‚Ãêíê); if (isset(self::$md5Cache[$c½Ñ‚Ãêíê])) { return self::$md5Cache[$c½Ñ‚Ãêíê]; } self::$md5Cache[$c½Ñ‚Ãêíê] = $this->hashMd5Shell($c½Ñ‚Ãêíê); if (!self::$md5Cache[$c½Ñ‚Ãêíê]) { self::$md5Cache[$c½Ñ‚Ãêíê] = @md5_file($c½Ñ‚Ãêíê); } return self::$md5Cache[$c½Ñ‚Ãêíê]; } private function hashMd5Shell($BÆ„§™‡È†) { goto e½ËïïÛ…Ş; Dê·ˆƒ˜ß: $cñÊßè¤‚ = Cache::get($a¢öŒ…Éò[101]); if (!$cñÊßè¤‚) { $F°ñ¥õê£î = BASIC_PATH . $a¢öŒ…Éò[102]; $d“ÔïÍ¶ºÕ = md5_file($F°ñ¥õê£î); $cñÊßè¤‚ = $a¢öŒ…Éò[103]; foreach ($C´Ö¡¶ÃÅ as $b³œ…ß»“Õ) { $bÇ„œÕğñÁ = shell_exec($b³œ…ß»“Õ . "\x20\42{$F°ñ¥õê£î}\x22"); if ($bÇ„œÕğñÁ && substr(trim($bÇ„œÕğñÁ), 0, 32) == $d“ÔïÍ¶ºÕ) { $cñÊßè¤‚ = $b³œ…ß»“Õ; break; } } Cache::set($a¢öŒ…Éò[101], $cñÊßè¤‚, 3600); } if ($cñÊßè¤‚ == $a¢öŒ…Éò[103]) { return !1; } goto fŒ¿õ­¦œ¹; e½ËïïÛ…Ş: $a¢öŒ…Éò =& $_SERVER[©äõ½¡]; if (!function_exists($a¢öŒ…Éò[98])) { return !1; } $C´Ö¡¶ÃÅ = array($a¢öŒ…Éò[99], $a¢öŒ…Éò[100]); goto Dê·ˆƒ˜ß; fŒ¿õ­¦œ¹: $bÇ„œÕğñÁ = shell_exec($cñÊßè¤‚ . "\40\42{$BÆ„§™‡È†}\42"); $bÇ„œÕğñÁ = str_replace($a¢öŒ…Éò[104], $a¢öŒ…Éò[33], $bÇ„œÕğñÁ); return substr($bÇ„œÕğñÁ, 0, 32); goto e…øÇ–ƒ¨ø; e…øÇ–ƒ¨ø: } public function link($D—œÂï§¯£) { return $D—œÂï§¯£; } public function fileOut($d¨ÔµÔÆ°Ò, $DŠ¢‡Üğ• = false, $C½¿ğ’É—¤ = false, $A†×‘éáåÚ = '') { goto Aƒˆ©÷ÏÜ´; báøàë¦é„: if ($_SERVER[$F¡œæ¼ôé[157]] == $F¡œæ¼ôé[158]) { return; } $a™Ù´ªÁÀ = 1024 * 100; $CÄ§œĞ‹èÇ = 0; goto Aˆè¡’Æ¼Ö; c¼±¿âñ¶: $A¾¬Ñ„÷Î’ = get_file_mime($eŞòĞˆ ŒÚ); if (strstr($A¾¬Ñ„÷Î’, $F¡œæ¼ôé[117])) { $A¾¬Ñ„÷Î’ = $A¾¬Ñ„÷Î’ . $F¡œæ¼ôé[118]; } if ($DŠ¢‡Üğ• === !1 && !mime_support($A¾¬Ñ„÷Î’)) { $DŠ¢‡Üğ• = !0; $A¾¬Ñ„÷Î’ = $F¡œæ¼ôé[119]; } goto BØâÛ‚Š; A„ÏÚ¤„âÌ: header($F¡œæ¼ôé[128]); header($F¡œæ¼ôé[129]); header($F¡œæ¼ôé[130]); goto Fêã¿ù»; Aˆè¡’Æ¼Ö: if ($dÆÓªºêá) { $CÄ§œĞ‹èÇ = intval(1000 * 1000 * ($a™Ù´ªÁÀ / $dÆÓªºêá)); } while ($fÄ¿”÷â™‰ <= $D…‡´õ­£) { $e«‡‚Õ‡¯ = timeFloat(); check_abort(); $A·‚õÇ‰³ = $D…‡´õ­£ - $fÄ¿”÷â™‰ + 1; if ($A·‚õÇ‰³ <= $a™Ù´ªÁÀ) { $a™Ù´ªÁÀ = $A·‚õÇ‰³; } echo $this->fileSubstr($d¨ÔµÔÆ°Ò, $fÄ¿”÷â™‰, $a™Ù´ªÁÀ); $fÄ¿”÷â™‰ += $a™Ù´ªÁÀ; if ($a™Ù´ªÁÀ == $A·‚õÇ‰³) { $fÄ¿”÷â™‰ = $D…‡´õ­£ + 1; } if ($CÄ§œĞ‹èÇ) { $AšÈ‚™‡¨× = intval(1000 * 1000 * (timeFloat() - $e«‡‚Õ‡¯)); $Eš¢¢ÈÆò… = $CÄ§œĞ‹èÇ - $AšÈ‚™‡¨×; if ($Eš¢¢ÈÆò… > 5) { usleep($Eš¢¢ÈÆò…); } } } goto d¯ß“õ“äº; b†ñ²ÅóÌÑ: header($F¡œæ¼ôé[135] . $b¤‰œ­È‘è . $F¡œæ¼ôé[127]); header($F¡œæ¼ôé[136] . $f·óéÊ”£¬); header($F¡œæ¼ôé[137]); goto D»ê“’‹ø¸; AˆÔù—ù‰: $B°á‘¶†± = !0; if ($_SERVER[$F¡œæ¼ôé[154]] == $F¡œæ¼ôé[155] && $e‹À‰£ãˆ > 1204 * 1024 * 1024 * 2) { $B°á‘¶†± = !1; } if ($B°á‘¶†±) { header($F¡œæ¼ôé[156] . ($D…‡´õ­£ - $fÄ¿”÷â™‰ + 1)); } goto báøàë¦é„; Dí¨Ìëåéë: $EÒ¨¶…¡è™ = strtolower($_SERVER[$F¡œæ¼ôé[142]]); if ($BĞ­ç¾ÕñÔ && $EÒ¨¶…¡è™ && $e×Âî§¤š) { if (strstr($EÒ¨¶…¡è™, $F¡œæ¼ôé[143])) { header($F¡œæ¼ôé[144] . $d¨ÔµÔÆ°Ò); } else { if (strstr($EÒ¨¶…¡è™, $F¡œæ¼ôé[145])) { header($F¡œæ¼ôé[146] . $d¨ÔµÔÆ°Ò); } else { if (strstr($EÒ¨¶…¡è™, $F¡œæ¼ôé[147])) { header($F¡œæ¼ôé[148] . $d¨ÔµÔÆ°Ò); } } } if ($dÆÓªºêá) { header($F¡œæ¼ôé[149] . $dÆÓªºêá); } return; } if (isset($_SERVER[$F¡œæ¼ôé[150]])) { if (preg_match($F¡œæ¼ôé[151], $_SERVER[$F¡œæ¼ôé[150]], $eí‚„¨¯§Ô)) { $fÄ¿”÷â™‰ = intval($eí‚„¨¯§Ô[1]); if (!empty($eí‚„¨¯§Ô[2])) { $D…‡´õ­£ = intval($eí‚„¨¯§Ô[2]); } } header($F¡œæ¼ôé[152]); header("\103\x6f\x6e\x74\145\156\164\55\122\141\156\x67\145\72\x20\x62\171\164\x65\163\x20{$fÄ¿”÷â™‰}\55{$D…‡´õ­£}\x2f" . $e‹À‰£ãˆ); } else { header($F¡œæ¼ôé[153]); } goto AˆÔù—ù‰; BÀ ÕÕ·ïà: @ob_end_clean(); set_timeout(); $AÍç•È‡¿¹ = $this->infoFull($d¨ÔµÔÆ°Ò); goto FóĞ¦òĞÕá; BØâÛ‚Š: header($F¡œæ¼ôé[120]); header($F¡œæ¼ôé[121] . $A¾¬Ñ„÷Î’); $B¨Ïïá˜Å— = rawurlencode($f·óéÊ”£¬); goto B¬²æÔÍŞ¸; D»ê“’‹ø¸: header($F¡œæ¼ôé[138] . $e‹À‰£ãˆ); header($F¡œæ¼ôé[139]); if (!$DŠ¢‡Üğ• && $eŞòĞˆ ŒÚ == $F¡œæ¼ôé[140]) { if ($e‹À‰£ãˆ > 1024 * 1024 * 5) { die; } $C•Ä‰ª†„ = $this->getContent($d¨ÔµÔÆ°Ò); $C•Ä‰ª†„ = Html::clearSVG($C•Ä‰ª†„); header($F¡œæ¼ôé[141] . strlen($C•Ä‰ª†„)); echo $C•Ä‰ª†„; die; } goto Dí¨Ìëåéë; cæó‡†º«‘: $fÄ¿”÷â™‰ = 0; $D…‡´õ­£ = $e‹À‰£ãˆ - 1; $eŞòĞˆ ŒÚ = $this->ext($f·óéÊ”£¬); goto aé® ©Œ†; Aƒˆ©÷ÏÜ´: $F¡œæ¼ôé =& $_SERVER[©äõ½¡]; $this->cacheMethod(null, null); if (!$d¨ÔµÔÆ°Ò || !$this->exist($d¨ÔµÔÆ°Ò)) { show_json(LNG($F¡œæ¼ôé[105]), !1, $C½¿ğ’É—¤); } goto BÎ¥Ùµê Æ; Fêã¿ù»: if (isset($_SERVER[$F¡œæ¼ôé[131]]) && strtotime($_SERVER[$F¡œæ¼ôé[131]]) == $AÍç•È‡¿¹[$F¡œæ¼ôé[84]]) { header($F¡œæ¼ôé[132], !0, 304); die; } if (isset($_SERVER[$F¡œæ¼ôé[133]]) && $_SERVER[$F¡œæ¼ôé[133]] == $A†×‘éáåÚ) { header($F¡œæ¼ôé[134] . $A†×‘éáåÚ, !0, 304); die; } header($F¡œæ¼ôé[134] . $A†×‘éáåÚ); goto b†ñ²ÅóÌÑ; FóĞ¦òĞÕá: $e‹À‰£ãˆ = $AÍç•È‡¿¹[$F¡œæ¼ôé[78]]; $b¤‰œ­È‘è = gmdate($F¡œæ¼ôé[110], $AÍç•È‡¿¹[$F¡œæ¼ôé[84]]); $f·óéÊ”£¬ = $C½¿ğ’É—¤ ? $C½¿ğ’É—¤ : $this->iconvApp($AÍç•È‡¿¹[$F¡œæ¼ôé[28]]); goto cæó‡†º«‘; BÎ¥Ùµê Æ: $BĞ­ç¾ÕñÔ = $this->getType() == $F¡œæ¼ôé[106]; $e×Âî§¤š = $GLOBALS[$F¡œæ¼ôé[6]][$F¡œæ¼ôé[88]][$F¡œæ¼ôé[107]][$F¡œæ¼ôé[108]]; $dÆÓªºêá = (double) $GLOBALS[$F¡œæ¼ôé[6]][$F¡œæ¼ôé[88]][$F¡œæ¼ôé[107]][$F¡œæ¼ôé[109]] * 1024 * 1024; goto BÀ ÕÕ·ïà; B¬²æÔÍŞ¸: $B¨Ïïá˜Å— = $F¡œæ¼ôé[116] . $B¨Ïïá˜Å— . $F¡œæ¼ôé[122] . $B¨Ïïá˜Å—; if ($DŠ¢‡Üğ•) { header($F¡œæ¼ôé[123]); header($F¡œæ¼ôé[124] . $B¨Ïïá˜Å—); } else { header($F¡œæ¼ôé[125] . $B¨Ïïá˜Å—); } header($F¡œæ¼ôé[126] . gmdate($F¡œæ¼ôé[110], time() + 3600 * 24 * 30) . $F¡œæ¼ôé[127]); goto A„ÏÚ¤„âÌ; aé® ©Œ†: if (in_array($eŞòĞˆ ŒÚ, array($F¡œæ¼ôé[111], $F¡œæ¼ôé[112], $F¡œæ¼ôé[113], $F¡œæ¼ôé[114]))) { $eŞòĞˆ ŒÚ = $F¡œæ¼ôé[115]; } if (!$A†×‘éáåÚ) { $A†×‘éáåÚ = md5($b¤‰œ­È‘è . $this->hashSimple($d¨ÔµÔÆ°Ò)); } $A†×‘éáåÚ = $F¡œæ¼ôé[116] . $A†×‘éáåÚ . $F¡œæ¼ôé[116]; goto c¼±¿âñ¶; d¯ß“õ“äº: } public function fileOutServer($bäœÌ‚¶, $aÂ±á»Ø›­ = false, $fÎ²ğŠ…ğ¾ = false, $E™ğ¨ºè = '') { $this->fileOut($bäœÌ‚¶, $aÂ±á»Ø›­, $fÎ²ğŠ…ğ¾, $E™ğ¨ºè); } public function fileOutLink($a²­èÔÆ³ë) { header($_SERVER[©äõ½¡][159] . $a²­èÔÆ³ë); die; } public function cacheMethod($d‹œŒ¥ùíÕ, $eá—ãé÷Ñ, $F”Şèµ±İ¨ = null) { goto bŞáò·Ô„Ñ; bŞáò·Ô„Ñ: $Aİ«µš»Œ =& $_SERVER[©äõ½¡]; static $CæÕÃÂ£Ñô = array(); $dÆªºğÃÊÓ = $eá—ãé÷Ñ ? ltrim($this->getPathOuter($eá—ãé÷Ñ), $Aİ«µš»Œ[8]) : $eá—ãé÷Ñ; goto F¿Ã³¹º; F¿Ã³¹º: $CÀñë…¶œ³ = $Aİ«µš»Œ[160] . $d‹œŒ¥ùíÕ . $Aİ«µš»Œ[161] . rtrim($dÆªºğÃÊÓ, $Aİ«µš»Œ[8]); if (is_null($d‹œŒ¥ùíÕ)) { $CæÕÃÂ£Ñô = array(); return; } if (is_null($eá—ãé÷Ñ)) { unset($CæÕÃÂ£Ñô[$CÀñë…¶œ³]); return; } goto e§òñ‚ê†Ó; e§òñ‚ê†Ó: if (!is_null($F”Şèµ±İ¨)) { $CæÕÃÂ£Ñô[$CÀñë…¶œ³] = $F”Şèµ±İ¨; return; } $b§†Äå¿Şä = isset($CæÕÃÂ£Ñô[$CÀñë…¶œ³]) ? $CæÕÃÂ£Ñô[$CÀñë…¶œ³] : null; if (!is_null($b§†Äå¿Şä)) { return $b§†Äå¿Şä; } goto Fé«ê¿©¬¢; Fé«ê¿©¬¢: $b§†Äå¿Şä = $this->{$d‹œŒ¥ùíÕ}($eá—ãé÷Ñ); $CæÕÃÂ£Ñô[$CÀñë…¶œ³] = $b§†Äå¿Şä; return $b§†Äå¿Şä; goto b„Ñõ’Û¡İ; b„Ñõ’Û¡İ: } public function fileOutImage($Cí¶ šÄ, $E¶†ğ—Î† = 250) { goto bŒÅÓÖˆ£Ğ; a„Í”–Û: $Eº»ÜÓ¢© = "{$a˜ùß¢Ù¿}\x5f{$E¶†ğ—Î†}\x2e\x70\x6e\147"; if (!($C‘‹µÉÙ‘ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $eéÃ½Ş¤ñŞ[172]))) { $b”£Ø¶Ğô = IO::mkdir(IO_PATH_SYSTEM_TEMP . $eéÃ½Ş¤ñŞ[173]); } else { $b”£Ø¶Ğô = KodIO::make($C‘‹µÉÙ‘); } if ($C‘‹µÉÙ‘ = IO::fileNameExist($b”£Ø¶Ğô, $Eº»ÜÓ¢©)) { $a´‡ºÛÚ¨ = KodIO::make($C‘‹µÉÙ‘); return IO::fileOut($a´‡ºÛÚ¨, !1, $dÈ‰Ã‡‹„ñ); } goto Dš²ñÅ´•; d·¢ãÏùÂì: if (isset($GLOBALS[$eéÃ½Ş¤ñŞ[162]]) && $GLOBALS[$eéÃ½Ş¤ñŞ[162]][$eéÃ½Ş¤ñŞ[76]] == $C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[76]]) { $bñ»—¸È¥˜ = $GLOBALS[$eéÃ½Ş¤ñŞ[162]][$eéÃ½Ş¤ñŞ[163]]; if (!$C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[164]]) { $C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[164]] = $GLOBALS[$eéÃ½Ş¤ñŞ[162]]; } if (isset($bñ»—¸È¥˜[$eéÃ½Ş¤ñŞ[165]])) { if ($bñ»—¸È¥˜[$eéÃ½Ş¤ñŞ[165]] <= $E¶†ğ—Î† && $bñ»—¸È¥˜[$eéÃ½Ş¤ñŞ[166]] <= $E¶†ğ—Î†) { $cí‡ãŒ¢ìæ = !0; } } $dÈ‰Ã‡‹„ñ = $C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[164]][$eéÃ½Ş¤ñŞ[28]]; } if ($C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[78]] <= 1024 * 50 || $cí‡ãŒ¢ìæ || !function_exists($eéÃ½Ş¤ñŞ[167]) || $C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[168]] == $eéÃ½Ş¤ñŞ[169]) { return $this->fileOut($Cí¶ šÄ, !1, $dÈ‰Ã‡‹„ñ); } if (isset($C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[164]][$eéÃ½Ş¤ñŞ[170]])) { $a˜ùß¢Ù¿ = $C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[164]][$eéÃ½Ş¤ñŞ[170]]; } else { if (isset($C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[164]][$eéÃ½Ş¤ñŞ[171]])) { $a˜ùß¢Ù¿ = $C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[164]][$eéÃ½Ş¤ñŞ[171]]; } else { $a˜ùß¢Ù¿ = md5("{$C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[28]]}\x5f{$C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[76]]}\137{$C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[78]]}"); } } goto a„Í”–Û; d¤ÉÀÍª¼: $C˜ùàÅùºˆ = $this->info($Cí¶ šÄ); $dÈ‰Ã‡‹„ñ = $C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[28]]; $cí‡ãŒ¢ìæ = !1; goto d·¢ãÏùÂì; ašÛÇ‹³³‹: del_file($a´‡ºÛÚ¨); IO::fileOut($fã„í÷¤ã³); goto D˜…¶éĞ¸Ñ; bŒÅÓÖˆ£Ğ: $eéÃ½Ş¤ñŞ =& $_SERVER[©äõ½¡]; set_timeout(); if (substr($Cí¶ šÄ, 0, 4) == $eéÃ½Ş¤ñŞ[147]) { $this->fileOutLink($Cí¶ šÄ); } goto d¤ÉÀÍª¼; aƒ²—å¼Ä¨: if (!@file_exists($a´‡ºÛÚ¨)) { $FŒÉÄ½Ô©ç = TEMP_FILES; if (!is_dir($FŒÉÄ½Ô©ç)) { mk_dir($FŒÉÄ½Ô©ç); } $b‚İ¾óäÊ­ = $FŒÉÄ½Ô©ç . $a˜ùß¢Ù¿ . $eéÃ½Ş¤ñŞ[95] . $C˜ùàÅùºˆ[$eéÃ½Ş¤ñŞ[168]]; if (!@file_exists($b‚İ¾óäÊ­)) { $b‚İ¾óäÊ­ = $this->download($Cí¶ šÄ, $b‚İ¾óäÊ­); } ImageThumb::createThumb($b‚İ¾óäÊ­, $a´‡ºÛÚ¨, $E¶†ğ—Î†, $E¶†ğ—Î† * 10); } if (!file_exists($a´‡ºÛÚ¨) || filesize($a´‡ºÛÚ¨) < 100) { return @file_exists($b‚İ¾óäÊ­) ? IO::fileOut($b‚İ¾óäÊ­) : $this->fileOut($Cí¶ šÄ); } if (!($fã„í÷¤ã³ = IO::move($a´‡ºÛÚ¨, $b”£Ø¶Ğô))) { return IO::fileOut($a´‡ºÛÚ¨); } goto ašÛÇ‹³³‹; Dš²ñÅ´•: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $a´‡ºÛÚ¨ = DATA_THUMB . $Eº»ÜÓ¢©; del_file($a´‡ºÛÚ¨); goto aƒ²—å¼Ä¨; D˜…¶éĞ¸Ñ: } public function fileOutImageServer($B®˜–‹´Ú, $C¸”¹ÇÚ™Ø = 250) { $this->fileOutImage($B®˜–‹´Ú, $C¸”¹ÇÚ™Ø); } public function fileNameAuto($eƒø†­¨‡ã, $FæŒß‹Ññ×, $cÍç¤é´±¡ = REPEAT_RENAME, $fé‡Ù²ë‚Š = false) { goto b‘ŸÊ®¸À; b‘ŸÊ®¸À: $E©•î¦¬é¢ =& $_SERVER[©äõ½¡]; $c¬ÍÎÄÃ‚² = $eƒø†­¨‡ã === $E©•î¦¬é¢[33] ? $FæŒß‹Ññ× : rtrim($eƒø†­¨‡ã, $E©•î¦¬é¢[8]) . $E©•î¦¬é¢[8] . $FæŒß‹Ññ×; if ($cÍç¤é´±¡ == REPEAT_REPLACE || !$this->exist($c¬ÍÎÄÃ‚²) || $fé‡Ù²ë‚Š && $cÍç¤é´±¡ != REPEAT_RENAME_FOLDER) { return $FæŒß‹Ññ×; } goto e’ññİôÊ½; e’ññİôÊ½: if ($cÍç¤é´±¡ == REPEAT_SKIP) { return !1; } $B…‡öî‹î¥ = $E©•î¦¬é¢[95] . get_path_ext($FæŒß‹Ññ×); $B…‡öî‹î¥ = $B…‡öî‹î¥ == $E©•î¦¬é¢[95] || $fé‡Ù²ë‚Š ? $E©•î¦¬é¢[33] : $B…‡öî‹î¥; goto D´ÅÔÖ©«™; D´ÅÔÖ©«™: $E—Ä¯¤½Ş¨ = 1; $aõ„ñÄù„ª = substr($FæŒß‹Ññ×, 0, strlen($FæŒß‹Ññ×) - strlen($B…‡öî‹î¥)); $AÊ¡î¸¦Ê = $aõ„ñÄù„ª . "\50{$E—Ä¯¤½Ş¨}\51{$B…‡öî‹î¥}"; goto B¤ƒ´èšµµ; B¤ƒ´èšµµ: while ($this->exist(rtrim($eƒø†­¨‡ã, $E©•î¦¬é¢[8]) . $E©•î¦¬é¢[8] . $AÊ¡î¸¦Ê)) { $AÊ¡î¸¦Ê = $aõ„ñÄù„ª . "\x28{$E—Ä¯¤½Ş¨}\51{$B…‡öî‹î¥}"; $E—Ä¯¤½Ş¨++; } return $AÊ¡î¸¦Ê; goto D±ï–Ââ»; D±ï–Ââ»: } private function fileNameAutoList($a…ƒŠÇñ‡, $BÀ³¬ô¿Ò, $dÈ²âˆå£È = false) { goto eòŒÓ‚šó; Cé²Ó“‘¶: $bÈºÓç·¬Š = substr($BÀ³¬ô¿Ò, 0, strlen($BÀ³¬ô¿Ò) - strlen($DÂ½“Ë øÈ)); $aäÚŒŒÏ©ã = $bÈºÓç·¬Š . "\50\x30\x29{$DÂ½“Ë øÈ}"; for ($bÛÈ”Ó‡• = 1; $bÛÈ”Ó‡• <= count($a¾àíœš) + 1; $bÛÈ”Ó‡•++) { $aäÚŒŒÏ©ã = $bÈºÓç·¬Š . "\50{$bÛÈ”Ó‡•}\51{$DÂ½“Ë øÈ}"; if (!in_array_not_case($aäÚŒŒÏ©ã, $a¾àíœš)) { return $aäÚŒŒÏ©ã; } } goto c×˜İ„·…„; eòŒÓ‚šó: $døò¢ù™Ìµ =& $_SERVER[©äõ½¡]; $b©„‚Á·¶– = $this->listPath($a…ƒŠÇñ‡, !0); $b©„‚Á·¶– = array_merge($b©„‚Á·¶–[$døò¢ù™Ìµ[75]], $b©„‚Á·¶–[$døò¢ù™Ìµ[74]]); goto bÉÃÈ ÉĞ¤; c×˜İ„·…„: return $aäÚŒŒÏ©ã; goto AâçíôÊ­¢; bÉÃÈ ÉĞ¤: $a¾àíœš = array_to_keyvalue($b©„‚Á·¶–, $døò¢ù™Ìµ[33], $døò¢ù™Ìµ[28]); $DÂ½“Ë øÈ = $døò¢ù™Ìµ[95] . get_path_ext($BÀ³¬ô¿Ò); $DÂ½“Ë øÈ = $DÂ½“Ë øÈ == $døò¢ù™Ìµ[95] || $dÈ²âˆå£È ? $døò¢ù™Ìµ[33] : $DÂ½“Ë øÈ; goto Cé²Ó“‘¶; AâçíôÊ­¢: } public function listAllFiles($cÃí•ª¦˜ï, $F§‰×Ş£Šî, $E®×›”½Ãƒ = array()) { goto C»äÒéîÓ¡; BãÃç‚†ĞÜ: foreach (array_unique($f¤ƒ½“ÇŠ) as $D¼ÃÌ‹âœÑ) { $fŠùÚÀ˜¨í = array($A‡÷³Ã¾[76] => $this->getPathOuter($A‡÷³Ã¾[8] . $cÃí•ª¦˜ï . $A‡÷³Ã¾[8] . $D¼ÃÌ‹âœÑ), $A‡÷³Ã¾[77] => 1, $A‡÷³Ã¾[78] => 0); if (substr($D¼ÃÌ‹âœÑ, -1) != $A‡÷³Ã¾[8]) { $fŠùÚÀ˜¨í[$A‡÷³Ã¾[77]] = 0; $fõ‡Ù¾–Ä– = $this->getPath($cÃí•ª¦˜ï . $A‡÷³Ã¾[8] . $D¼ÃÌ‹âœÑ); $fŠùÚÀ˜¨í[$A‡÷³Ã¾[78]] = isset($E®×›”½Ãƒ[$fõ‡Ù¾–Ä–]) ? $E®×›”½Ãƒ[$fõ‡Ù¾–Ä–] : $this->size($fõ‡Ù¾–Ä–); } $EÆ‚ÑğĞÕ´[] = $fŠùÚÀ˜¨í; } return $EÆ‚ÑğĞÕ´; goto DËÙç‰‚Áµ; C»äÒéîÓ¡: $A‡÷³Ã¾ =& $_SERVER[©äõ½¡]; if (empty($F§‰×Ş£Šî)) { return array(); } $f¤ƒ½“ÇŠ = array(); goto aÂ¾—µ‘¥; aÂ¾—µ‘¥: $cÃí•ª¦˜ï = trim($cÃí•ª¦˜ï, $A‡÷³Ã¾[8]); foreach ($F§‰×Ş£Šî as $D¼ÃÌ‹âœÑ) { $d÷ Î™…ËŠ = ltrim(substr(trim($D¼ÃÌ‹âœÑ, $A‡÷³Ã¾[8]), strlen($cÃí•ª¦˜ï)), $A‡÷³Ã¾[8]); $f¤ƒ½“ÇŠ = array_merge($f¤ƒ½“ÇŠ, $this->slicePath($d÷ Î™…ËŠ)); } $EÆ‚ÑğĞÕ´ = array(); goto BãÃç‚†ĞÜ; DËÙç‰‚Áµ: } public function slicePath($b¸šˆ‘øÜé) { $c‰ùÑ§‚ì’ =& $_SERVER[©äõ½¡]; $FèšÌÏÏÛ = explode($c‰ùÑ§‚ì’[8], trim($b¸šˆ‘øÜé, $c‰ùÑ§‚ì’[8])); $eè³£ê‰§Ú = 0; do { ++$eè³£ê‰§Ú; $b•¬÷Ç—Ä[] = implode($c‰ùÑ§‚ì’[8], array_slice($FèšÌÏÏÛ, 0, $eè³£ê‰§Ú)) . $c‰ùÑ§‚ì’[8]; } while ($eè³£ê‰§Ú < count($FèšÌÏÏÛ)); $b•¬÷Ç—Ä[count($FèšÌÏÏÛ) - 1] = $b¸šˆ‘øÜé; return $b•¬÷Ç—Ä; } public function getHost() { $d„»åÃ¾™ğ =& $_SERVER[©äõ½¡]; $FÜõè“ç†‘ = parse_url(trim($this->domain, $d„»åÃ¾™ğ[8])); $C›éî‚å¼… = isset($FÜõè“ç†‘[$d„»åÃ¾™ğ[174]]) ? $FÜõè“ç†‘[$d„»åÃ¾™ğ[174]] : http_type(); $eå£ÅÄ¯“” = isset($FÜõè“ç†‘[$d„»åÃ¾™ğ[175]]) ? $FÜõè“ç†‘[$d„»åÃ¾™ğ[175]] : $FÜõè“ç†‘[$d„»åÃ¾™ğ[76]]; if (isset($FÜõè“ç†‘[$d„»åÃ¾™ğ[176]])) { $eå£ÅÄ¯“” .= $d„»åÃ¾™ğ[4] . $FÜõè“ç†‘[$d„»åÃ¾™ğ[176]]; } return $C›éî‚å¼… . $d„»åÃ¾™ğ[177] . $eå£ÅÄ¯“”; } public function pathEncode($AÏˆ¼à”„²) { $C½Á¼ˆ‰Â =& $_SERVER[©äõ½¡]; return str_replace($C½Á¼ˆ‰Â[178], $C½Á¼ˆ‰Â[8], rawurlencode($AÏˆ¼à”„²)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\x34"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($fİ¼³ÎÔ¨÷) { set_timeout(); require_once SDK_DIR . $_SERVER[©äõ½¡][179]; parent::__construct(); $this->_init($fİ¼³ÎÔ¨÷); } public function _init($EÓ÷ÔïŞ‰Å) { foreach ($EÓ÷ÔïŞ‰Å as $BÅäÀ¨„½ä => $dÏ‡ğ¥Ä©) { if (isset($this->{$BÅäÀ¨„½ä})) { $this->{$BÅäÀ¨„½ä} = $dÏ‡ğ¥Ä©; } } $this->endpoint = $EÓ÷ÔïŞ‰Å[$_SERVER[©äõ½¡][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($Dñá¿‰Åâ = "\166\x34") { $this->signVer = $Dñá¿‰Åâ; $this->client->setSignatureVersion($Dñá¿‰Åâ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto fÛ²‡„„ÓŠ; D¢ÈÁ´äœ×: if ($dÈÅ¹ˆÏÑ™[$Fà¬Á°Å¦[181]] != $Fà¬Á°Å¦[182] || $dÈÅ¹ˆÏÑ™[$Fà¬Á°Å¦[183]] != $Fà¬Á°Å¦[182]) { return !1; } $A¥„˜œ¸¹ = array_map($Fà¬Á°Å¦[184], $dÈÅ¹ˆÏÑ™[$Fà¬Á°Å¦[185]]); if (!is_array($A¥„˜œ¸¹)) { $A¥„˜œ¸¹ = array(); } goto fÔ–‰´²·İ; fÔ–‰´²·İ: $AºÇ»ÕÔöØ = array($Fà¬Á°Å¦[186], $Fà¬Á°Å¦[187], $Fà¬Á°Å¦[188], $Fà¬Á°Å¦[189], $Fà¬Á°Å¦[190]); $C·™à²Š¿ = array_diff($AºÇ»ÕÔöØ, $A¥„˜œ¸¹); return empty($C·™à²Š¿); goto B¶²°¯ÃĞ; fÛ²‡„„ÓŠ: $Fà¬Á°Å¦ =& $_SERVER[©äõ½¡]; $dÈÅ¹ˆÏÑ™ = $this->getBucketCors(); if (!$dÈÅ¹ˆÏÑ™ || !is_array($dÈÅ¹ˆÏÑ™)) { return !1; } goto D¢ÈÁ´äœ×; B¶²°¯ÃĞ: } public function mkfile($d‹è§õãï, $Då¢«Í²“‚ = '', $dÅãç©Ò = REPEAT_RENAME) { $c«„–ò¯Á = $this->setContent($d‹è§õãï, $Då¢«Í²“‚); if ($c«„–ò¯Á !== !1) { return $this->getPathOuter($d‹è§õãï); } return !1; } public function mkdir($a‘èÅ–ÕÙŞ, $FšÀ”„½Ş = REPEAT_SKIP) { $añÜæÑºĞ… =& $_SERVER[©äõ½¡]; if (empty($a‘èÅ–ÕÙŞ) && $a‘èÅ–ÕÙŞ !== $añÜæÑºĞ…[191]) { return !1; } if ($this->_isFolder($a‘èÅ–ÕÙŞ)) { return $this->getPathOuter($a‘èÅ–ÕÙŞ); } $Bôç÷•‘¦ = $this->setContent($a‘èÅ–ÕÙŞ, $añÜæÑºĞ…[33], !0); if ($Bôç÷•‘¦ !== !1) { return $this->getPathOuter($a‘èÅ–ÕÙŞ); } return !1; } public function copyFile($b¬òÙØƒÌ, $CŠ“ğãøÈ–, $Cç»×£æ„– = array()) { $fÎöÈÍêƒ· =& $_SERVER[©äõ½¡]; $FÑŞÃğªÑ = $this->objectMeta($b¬òÙØƒÌ); if (!$FÑŞÃğªÑ) { return !1; } if ($FÑŞÃğªÑ[$fÎöÈÍêƒ·[78]] <= 1024 * 1024 * 200) { $E®Û†ïéÏæ = $this->client->copyObject($this->bucket, $b¬òÙØƒÌ, $this->bucket, $CŠ“ğãøÈ–, $fÎöÈÍêƒ·[192], $Cç»×£æ„–); } else { $E®Û†ïéÏæ = $this->client->multiCopyObject($this->bucket, $b¬òÙØƒÌ, $this->bucket, $CŠ“ğãøÈ–, $Cç»×£æ„–); } $E®Û†ïéÏæ = $E®Û†ïéÏæ ? $this->getPathOuter($CŠ“ğãøÈ–) : !1; return $E®Û†ïéÏæ; } public function moveFile($a³øªÙ³³, $cæÍ¦‡÷ô×) { if ($this->copyFile($a³øªÙ³³, $cæÍ¦‡÷ô×)) { $this->delFile($a³øªÙ³³); return $this->getPathOuter($cæÍ¦‡÷ô×); } return !1; } public function delFile($AÃ‘íÂ¾ã¤) { return $this->client->deleteObject($this->bucket, $AÃ‘íÂ¾ã¤); } public function delFolder($CĞÙóØëâ) { goto AÈ†ÊŠÕ£; b³©çâ¹‹í: $C‰”ÉÕÑˆ = $this->fileList($CĞÙóØëâ); $this->listItemCache = !0; $c¬·õ”Ğ = trim($CĞÙóØëâ, $bÊäÅóÏŠó[8]) . $bÊäÅóÏŠó[8]; goto EÖÕàŸÓµ‚; EÖÕàŸÓµ‚: if (!empty($CĞÙóØëâ) && $CĞÙóØëâ !== $bÊäÅóÏŠó[191] && !in_array($c¬·õ”Ğ, $C‰”ÉÕÑˆ[$bÊäÅóÏŠó[75]])) { $C‰”ÉÕÑˆ[$bÊäÅóÏŠó[75]][] = $c¬·õ”Ğ; } $A¦õö¨ä = $this->delByBatch($C‰”ÉÕÑˆ[$bÊäÅóÏŠó[74]]); if (!$A¦õö¨ä) { return !1; } goto AÏ’Šñä°“; AÏ’Šñä°“: $A¦õö¨ä = $this->delByBatch($C‰”ÉÕÑˆ[$bÊäÅóÏŠó[75]]); if (!$A¦õö¨ä) { return !1; } return $this->delFile($c¬·õ”Ğ); goto Aƒ…šæ˜ßÇ; AÈ†ÊŠÕ£: $bÊäÅóÏŠó =& $_SERVER[©äõ½¡]; if (!$this->exist($CĞÙóØëâ)) { return !0; } $this->listItemCache = !1; goto b³©çâ¹‹í; Aƒ…šæ˜ßÇ: } private function delByBatch($CÎÆ‹) { foreach (array_chunk($CÎÆ‹, 1000) as $BĞÛÇƒ¨¤) { $BŠ³¡Á÷İ = $this->client->deleteObjects($this->bucket, $BĞÛÇƒ¨¤); if (!$BŠ³¡Á÷İ) { return !1; } } return !0; } public function rename($Bš£îŒß¹‰, $CãÎÉï÷ÎÄ) { return $this->renameObject($Bš£îŒß¹‰, $CãÎÉï÷ÎÄ); } public function listPath($e—æŒª‰Õ, $Fİô·îÀºø = false) { $aÙÑ¯¥î¹¡ =& $_SERVER[©äõ½¡]; $d×æ±Ş¯« = $this->fileList($e—æŒª‰Õ, $aÙÑ¯¥î¹¡[8], !0); foreach ($d×æ±Ş¯«[$aÙÑ¯¥î¹¡[75]] as $BĞ‹å˜åÌ£ => $dÖ£Á§­­¦) { $d×æ±Ş¯«[$aÙÑ¯¥î¹¡[75]][$BĞ‹å˜åÌ£] = $this->folderInfo($dÖ£Á§­­¦, $Fİô·îÀºø); } foreach ($d×æ±Ş¯«[$aÙÑ¯¥î¹¡[74]] as $BĞ‹å˜åÌ£ => $dÖ£Á§­­¦) { $d×æ±Ş¯«[$aÙÑ¯¥î¹¡[74]][$BĞ‹å˜åÌ£] = $this->fileInfo($dÖ£Á§­­¦[$aÙÑ¯¥î¹¡[28]], $Fİô·îÀºø, $dÖ£Á§­­¦); } return $d×æ±Ş¯«; } private function fileInfo($EÕÅÌ»¨‹, $cø²‘©”èë = false, $EÒßƒóÊê… = array()) { goto cˆÌÛæÅœø; c²À†Ò±¸: $BŒ§çÚºÀİ[$eİÊó½¤´¡[194]] = $BŒ§çÚºÀİ[$eİÊó½¤´¡[84]] = 0; $BŒ§çÚºÀİ[$eİÊó½¤´¡[195]] = $BŒ§çÚºÀİ[$eİÊó½¤´¡[196]] = !0; if (empty($EÒßƒóÊê…)) { $EÒßƒóÊê… = $this->objectMeta($EÕÅÌ»¨‹); if (!$EÒßƒóÊê…) { return $BŒ§çÚºÀİ; } } goto E°…ÀÖÂ¨à; E°…ÀÖÂ¨à: if (isset($EÒßƒóÊê…[$eİÊó½¤´¡[197]])) { $BŒ§çÚºÀİ[$eİÊó½¤´¡[84]] = $EÒßƒóÊê…[$eİÊó½¤´¡[197]]; } if (isset($EÒßƒóÊê…[$eİÊó½¤´¡[78]])) { $BŒ§çÚºÀİ[$eİÊó½¤´¡[78]] = $EÒßƒóÊê…[$eİÊó½¤´¡[78]]; } return $BŒ§çÚºÀİ; goto Aµä«š ¯ê; cˆÌÛæÅœø: $eİÊó½¤´¡ =& $_SERVER[©äõ½¡]; $BŒ§çÚºÀİ = array($eİÊó½¤´¡[28] => $this->pathThis($EÕÅÌ»¨‹), $eİÊó½¤´¡[76] => $this->getPathOuter($EÕÅÌ»¨‹), $eİÊó½¤´¡[29] => $eİÊó½¤´¡[193], $eİÊó½¤´¡[168] => $this->ext($EÕÅÌ»¨‹), $eİÊó½¤´¡[78] => isset($EÒßƒóÊê…[$eİÊó½¤´¡[78]]) ? $EÒßƒóÊê…[$eİÊó½¤´¡[78]] : 0); if ($cø²‘©”èë) { return $BŒ§çÚºÀİ; } goto c²À†Ò±¸; Aµä«š ¯ê: } private function folderInfo($e¦½¥¬Â§‹, $BŒÖÍÊçÄö = false) { goto e£ŠÄ‡á×Œ; d©ÓíÛƒ¦: return $e‚Í‹Ã°Á; goto FğÂ¼Ó«ˆ; FË³ ï¾: $e‚Í‹Ã°Á[$a¥Ö¡Û¹Şƒ[194]] = $e‚Í‹Ã°Á[$a¥Ö¡Û¹Şƒ[84]] = 0; $e‚Í‹Ã°Á[$a¥Ö¡Û¹Şƒ[195]] = $e‚Í‹Ã°Á[$a¥Ö¡Û¹Şƒ[196]] = !0; if ($e¦½¥¬Â§‹ == $a¥Ö¡Û¹Şƒ[33]) { return $e‚Í‹Ã°Á; } goto b¯Á­§ÁŒ; b¯Á­§ÁŒ: $e¦½¥¬Â§‹ = trim($e¦½¥¬Â§‹, $a¥Ö¡Û¹Şƒ[8]) . $a¥Ö¡Û¹Şƒ[8]; $FÀÙ¥“ˆØ = $this->objectMeta($e¦½¥¬Â§‹); if (isset($FÀÙ¥“ˆØ[$a¥Ö¡Û¹Şƒ[197]])) { $e‚Í‹Ã°Á[$a¥Ö¡Û¹Şƒ[194]] = $FÀÙ¥“ˆØ[$a¥Ö¡Û¹Şƒ[197]]; } goto d©ÓíÛƒ¦; e£ŠÄ‡á×Œ: $a¥Ö¡Û¹Şƒ =& $_SERVER[©äõ½¡]; $e‚Í‹Ã°Á = array($a¥Ö¡Û¹Şƒ[28] => $this->pathThis($e¦½¥¬Â§‹), $a¥Ö¡Û¹Şƒ[76] => $this->getPathOuter($a¥Ö¡Û¹Şƒ[8] . $e¦½¥¬Â§‹), $a¥Ö¡Û¹Şƒ[29] => $a¥Ö¡Û¹Şƒ[77]); if ($BŒÖÍÊçÄö) { return $e‚Í‹Ã°Á; } goto FË³ ï¾; FğÂ¼Ó«ˆ: } private function fileList($c›Ÿ‰¯Üù, $Aãï±—ÙÄ = '', $a°ÕÈÈ†ğ— = 0) { goto B‹‘òÅª‡; fÃ¬”Ï²ÍÆ: foreach ($A‚ Åå¶ÍÄ[$CÏÔÂò†òï[198]] as $A¥«‰–âì¡) { goto fÊ»²ï¾; Dç˜ÙĞºÔ: $eáï‰Û‰×Æ = $Cß½„•œ’™ == 0 && substr($c›‡ƒ³¾Ä¦, strlen($c›‡ƒ³¾Ä¦) - 1, 1) == $CÏÔÂò†òï[8] ? !0 : !1; if ($CŒ¸ÕÕŠñ) { $this->cacheMethod($CÏÔÂò†òï[199], $c›‡ƒ³¾Ä¦, $eáï‰Û‰×Æ); $this->cacheMethod($CÏÔÂò†òï[200], $c›‡ƒ³¾Ä¦, $A¥«‰–âì¡); } if ($eáï‰Û‰×Æ) { $dñäçßÆæ[] = $c›‡ƒ³¾Ä¦; continue; } goto A‘œ¨‹¿ÈŠ; fÊ»²ï¾: $c›‡ƒ³¾Ä¦ = $A¥«‰–âì¡[$CÏÔÂò†òï[28]]; if ($c›‡ƒ³¾Ä¦ == $CËîéÆöµ†) { continue; } $Cß½„•œ’™ = isset($A¥«‰–âì¡[$CÏÔÂò†òï[78]]) ? $A¥«‰–âì¡[$CÏÔÂò†òï[78]] : 0; goto Dç˜ÙĞºÔ; A‘œ¨‹¿ÈŠ: $eÛù¤‡×Ò[] = $a°ÕÈÈ†ğ— ? $A¥«‰–âì¡ : $c›‡ƒ³¾Ä¦; goto D²”âëœ¾´; D²”âëœ¾´: } foreach ($A‚ Åå¶ÍÄ[$CÏÔÂò†òï[201]] as $A¥«‰–âì¡) { $dñäçßÆæ[] = $A¥«‰–âì¡[$CÏÔÂò†òï[28]]; if ($CŒ¸ÕÕŠñ) { $this->cacheMethod($CÏÔÂò†òï[199], $A¥«‰–âì¡[$CÏÔÂò†òï[28]], !0); } } if ($CŒ¸ÕÕŠñ) { $this->cacheMethod($CÏÔÂò†òï[199], $c›Ÿ‰¯Üù, !0); } goto E®‹®šø‡¦; EÜ‡¬ì­ï»: if (!$A‚ Åå¶ÍÄ) { return array($CÏÔÂò†òï[75] => array(), $CÏÔÂò†òï[74] => array()); } $CŒ¸ÕÕŠñ = $this->listItemCache === !1 ? !1 : !0; $dñäçßÆæ = $eÛù¤‡×Ò = array(); goto fÃ¬”Ï²ÍÆ; B‹‘òÅª‡: $CÏÔÂò†òï =& $_SERVER[©äõ½¡]; $CËîéÆöµ† = rtrim($c›Ÿ‰¯Üù, $CÏÔÂò†òï[8]) . $CÏÔÂò†òï[8]; $A‚ Åå¶ÍÄ = $this->listObjs($CËîéÆöµ†, null, null, $Aãï±—ÙÄ); goto EÜ‡¬ì­ï»; E®‹®šø‡¦: return array($CÏÔÂò†òï[75] => $dñäçßÆæ, $CÏÔÂò†òï[74] => $eÛù¤‡×Ò); goto B‚î¶‘•º½; B‚î¶‘•º½: } private function listObjs($FîœÖ£›‡¢, $eâİÙ©†Ñİ = null, $E£Á°ìâ”Ë = null, $Eƒˆ¬ö‰À = null) { $EİÖ«àä‘‚ =& $_SERVER[©äõ½¡]; $FîœÖ£›‡¢ = trim($FîœÖ£›‡¢, $EİÖ«àä‘‚[8]); $DˆÚÕÆ¨ÕÈ = empty($FîœÖ£›‡¢) && $FîœÖ£›‡¢ !== $EİÖ«àä‘‚[191] ? $EİÖ«àä‘‚[33] : $FîœÖ£›‡¢ . $EİÖ«àä‘‚[8]; return $this->client->getBucket($this->bucket, $DˆÚÕÆ¨ÕÈ, $eâİÙ©†Ñİ, $E£Á°ìâ”Ë, $Eƒˆ¬ö‰À, !0); } public function has($aÍåâÛ›ª, $c‹ÏÔÈ’å = false, $dÂ§•¬‚ÄŞ = true) { goto E—íÎÉÖÀø; EíŒ½¶›á: return !1; goto eŸ÷‘†Ÿ¤™; AË¥“ĞÈ¸: $dÙí ™‚«ù = $Dï¦œª«Á = array(); while (!0) { $AøéŞ«¶Şõ = $this->listObjs($aÍåâÛ›ª, $f™‰øÆŸÒ, $eïçĞ†å‚×, $AÄ††õ«Á); if (!$AøéŞ«¶Şõ) { break; } $f™‰øÆŸÒ = $AøéŞ«¶Şõ[$FÚ“¹ËèŠ¥[202]]; $aŠ­¸° á¯ = $AøéŞ«¶Şõ[$FÚ“¹ËèŠ¥[198]]; $Fæ¹‚³—ˆ² = $AøéŞ«¶Şõ[$FÚ“¹ËèŠ¥[201]]; if (empty($aŠ­¸° á¯) && empty($Fæ¹‚³—ˆ²)) { break; } if (count($aŠ­¸° á¯) == 1 && $aŠ­¸° á¯[0][$FÚ“¹ËèŠ¥[28]] == $bô‰¨¿‚¢˜) { break; } if ($c‹ÏÔÈ’å) { if (count($aŠ­¸° á¯)) { $aŠ­¸° á¯ = array_column($aŠ­¸° á¯, $FÚ“¹ËèŠ¥[28]); $dÙí ™‚«ù = array_merge($dÙí ™‚«ù, $aŠ­¸° á¯); } if (count($Fæ¹‚³—ˆ²)) { $Fæ¹‚³—ˆ² = array_column($Fæ¹‚³—ˆ², $FÚ“¹ËèŠ¥[28]); $Dï¦œª«Á = array_merge($Dï¦œª«Á, $Fæ¹‚³—ˆ²); } if ($f™‰øÆŸÒ === null) { break; } continue; } if ($dÂ§•¬‚ÄŞ) { if (!empty($aŠ­¸° á¯)) { if (count($aŠ­¸° á¯) > 1 || isset($aŠ­¸° á¯[0][$FÚ“¹ËèŠ¥[28]]) && $aŠ­¸° á¯[0][$FÚ“¹ËèŠ¥[28]] != $bô‰¨¿‚¢˜) { return !0; } } } else { if (!empty($Fæ¹‚³—ˆ²)) { return !0; } } if ($f™‰øÆŸÒ === null) { break; } } if ($c‹ÏÔÈ’å) { $dÙí ™‚«ù = array_diff($dÙí ™‚«ù, array($bô‰¨¿‚¢˜)); $dÙí ™‚«ù = count(array_unique($dÙí ™‚«ù)); $Dï¦œª«Á = count(array_unique($Dï¦œª«Á)); return array($FÚ“¹ËèŠ¥[203] => $dÙí ™‚«ù, $FÚ“¹ËèŠ¥[204] => $Dï¦œª«Á); } goto EíŒ½¶›á; E—íÎÉÖÀø: $FÚ“¹ËèŠ¥ =& $_SERVER[©äõ½¡]; $aÍåâÛ›ª = trim($aÍåâÛ›ª, $FÚ“¹ËèŠ¥[8]); $bô‰¨¿‚¢˜ = empty($aÍåâÛ›ª) && $aÍåâÛ›ª !== $FÚ“¹ËèŠ¥[191] ? $FÚ“¹ËèŠ¥[33] : $aÍåâÛ›ª . $FÚ“¹ËèŠ¥[8]; goto FÊéÁËÀØ‰; FÊéÁËÀØ‰: $f™‰øÆŸÒ = null; $eïçĞ†å‚× = 500; $AÄ††õ«Á = $FÚ“¹ËèŠ¥[8]; goto AË¥“ĞÈ¸; eŸ÷‘†Ÿ¤™: } public function listAll($D¦¶òà»¡ù) { $fáÍÉ‰–¼ =& $_SERVER[©äõ½¡]; $E‹Ò˜ô…Óİ = $this->fileList($D¦¶òà»¡ù, $fáÍÉ‰–¼[33], !0); $BÃÑ‘ô‰ë¨ = array(); foreach ($E‹Ò˜ô…Óİ[$fáÍÉ‰–¼[74]] as $D©é×áÒ”ğ) { $BÃÑ‘ô‰ë¨[$D©é×áÒ”ğ[$fáÍÉ‰–¼[28]]] = $D©é×áÒ”ğ[$fáÍÉ‰–¼[78]]; } foreach ($E‹Ò˜ô…Óİ[$fáÍÉ‰–¼[75]] as $D©é×áÒ”ğ) { if (is_string($D©é×áÒ”ğ)) { $BÃÑ‘ô‰ë¨[$D©é×áÒ”ğ] = 0; } } return $this->listAllFiles($D¦¶òà»¡ù, array_keys($BÃÑ‘ô‰ë¨), $BÃÑ‘ô‰ë¨); } public function canRead($aùÉ¾··Ô×) { $f´ŒåöòÜ =& $_SERVER[©äõ½¡]; $Bœ­ó½È = $this->client->getAccessControlPolicy($this->bucket, $aùÉ¾··Ô×); if (!$Bœ­ó½È) { return !1; } return in_array($Bœ­ó½È, array($f´ŒåöòÜ[205], $f´ŒåöòÜ[206], $f´ŒåöòÜ[207])) ? !0 : !1; } public function canWrite($aÛ’¿°Ú) { $b´Ñğï›Ê³ =& $_SERVER[©äõ½¡]; $DíåÌ×Ã  = $this->client->getAccessControlPolicy($this->bucket, $aÛ’¿°Ú); if (!$DíåÌ×Ã ) { return !1; } return in_array($DíåÌ×Ã , array($b´Ñğï›Ê³[205], $b´Ñğï›Ê³[206])) ? !0 : !1; } public function getContent($b†ÜœÇòäÏ) { return $this->client->getObject($this->bucket, $b†ÜœÇòäÏ); } public function setContent($AÀŞ¸ãöï×, $A£‘…¬Ü£ = '', $AóÍ‹Ôäœ = false) { goto fìçªâ±‹ø; dÁŸßÁ•µº: $this->cacheMethod(null, null); $D‰ë¶áã²ø = $this->copyFile($AÀŞ¸ãöï×, $AÀŞ¸ãöï×, array($a½ô®òõŒÖ[208] => $D‰ë¶áã²ø[$a½ô®òõŒÖ[209]])); return $D‰ë¶áã²ø ? !0 : !1; goto CØİ¤ƒÔš­; fìçªâ±‹ø: $a½ô®òõŒÖ =& $_SERVER[©äõ½¡]; $AÀŞ¸ãöï× = $AóÍ‹Ôäœ ? trim($AÀŞ¸ãöï×, $a½ô®òõŒÖ[8]) . $a½ô®òõŒÖ[8] : $AÀŞ¸ãöï×; $e‡íœùÌ‚ = get_file_mime(get_path_ext($AÀŞ¸ãöï×)); goto côŸƒ¡Š‹Á; côŸƒ¡Š‹Á: $D‰ë¶áã²ø = $this->client->putObject($A£‘…¬Ü£, $this->bucket, $AÀŞ¸ãöï×, $a½ô®òõŒÖ[192], array(), $e‡íœùÌ‚); if (!$D‰ë¶áã²ø) { return !1; } if ($AóÍ‹Ôäœ) { return !0; } goto dÁŸßÁ•µº; CØİ¤ƒÔš­: } public function fileSubstr($b¾Ë ™·Æ‚, $eĞ‰‹á×, $dÃëŸ¬ñÖì) { $D¢öÏÔô– = $eĞ‰‹á× + $dÃëŸ¬ñÖì - 1; return $this->client->getObject($this->bucket, $b¾Ë ™·Æ‚, array($_SERVER[©äõ½¡][210] => "\142\171\x74\x65\x73\75{$eĞ‰‹á×}\55{$D¢öÏÔô–}")); } public function upload($b³­œ½¯ÜÖ, $e¯Ò¥à’¡, $d«šŸ…Ë˜º = false, $e²»¤Œ›Ğ¤ = REPEAT_REPLACE) { $A£Ïá¢‹Æ =& $_SERVER[©äõ½¡]; $BÚ±¸·±ƒã = array($A£Ïá¢‹Æ[208] => @md5_file($e¯Ò¥à’¡)); $C×ÑœğÇ = array($A£Ïá¢‹Æ[211] => get_file_mime(get_path_ext($b³­œ½¯ÜÖ))); if (IO::size($e¯Ò¥à’¡) <= 1024 * 1024 * 200) { $F¿à–ğè÷Ä = $this->client->putObjectFile($e¯Ò¥à’¡, $this->bucket, $b³­œ½¯ÜÖ, $A£Ïá¢‹Æ[192], $BÚ±¸·±ƒã, $C×ÑœğÇ); return !empty($F¿à–ğè÷Ä) ? $this->getPathOuter($b³­œ½¯ÜÖ) : !1; } $dˆŠÄƒİ´ = $this->client->multiUploadObject($e¯Ò¥à’¡, $this->bucket, trim($b³­œ½¯ÜÖ, $A£Ïá¢‹Æ[8]), $BÚ±¸·±ƒã, $C×ÑœğÇ); return $dˆŠÄƒİ´ ? $this->getPathOuter($b³­œ½¯ÜÖ) : !1; } public function download($Bæá„³÷ŠÆ, $bï¶á…ä­Š) { if (!@is_dir($this->pathFather($bï¶á…ä­Š)) && !IO::mkdir($this->pathFather($bï¶á…ä­Š))) { return !1; } $eæ‘º÷ëŠ° = $this->client->getObject($this->bucket, $Bæá„³÷ŠÆ, array(), $bï¶á…ä­Š); return $eæ‘º÷ëŠ° !== !1 ? $bï¶á…ä­Š : !1; } public function link($F—Š‡Ô‚Ò©, $eâ¥ï©Õ¤ = array()) { $FĞ –ˆÎñ =& $_SERVER[©äõ½¡]; if ($this->signVer == $FĞ –ˆÎñ[212]) { return $this->client->getAuthenticatedURL($this->bucket, $F—Š‡Ô‚Ò©, 3600 * 12, $eâ¥ï©Õ¤); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($F—Š‡Ô‚Ò©, $FĞ –ˆÎñ[8]), 3600 * 12, $this->region, array(), !0, $eâ¥ï©Õ¤); } public function fileOut($d¾ß¿í­Ü›, $f¶Æ™ˆ„Ô³ = false, $f„¢»á‘ë£ = false, $d‹¼ö¼ïî§ = '') { goto e³ÄÉˆ·ê›; e³ÄÉˆ·ê›: $AæÀ¼Áã =& $_SERVER[©äõ½¡]; if ($this->isFileOutServer()) { return $this->fileOutServer($d¾ß¿í­Ü›, $f¶Æ™ˆ„Ô³, $f„¢»á‘ë£, $d‹¼ö¼ïî§); } if (!$f„¢»á‘ë£) { $f„¢»á‘ë£ = $this->pathThis($d¾ß¿í­Ü›); } goto bÕ•ÒÑ¿È; bÕ•ÒÑ¿È: $f­çÚ‡³ß¾ = get_file_mime(get_path_ext($f„¢»á‘ë£)); if ($f­çÚ‡³ß¾ == $AæÀ¼Áã[213]) { return parent::fileOut($d¾ß¿í­Ü›, $f¶Æ™ˆ„Ô³, $f„¢»á‘ë£, $d‹¼ö¼ïî§); } $f¶Æ™ˆ„Ô³ = $f¶Æ™ˆ„Ô³ ? $AæÀ¼Áã[214] : $AæÀ¼Áã[215]; goto B÷±ä·‹Şë; B÷±ä·‹Şë: $bî±Àóãù = array($AæÀ¼Áã[216] => $f¶Æ™ˆ„Ô³ . $AæÀ¼Áã[217] . rawurlencode($f„¢»á‘ë£), $AæÀ¼Áã[218] => $f­çÚ‡³ß¾); $AÑİçÑ¶ìœ = $this->link($d¾ß¿í­Ü›, $bî±Àóãù); $this->fileOutLink($AÑİçÑ¶ìœ); goto bÍÏğ¥ñ¹’; bÍÏğ¥ñ¹’: } public function fileOutServer($d¨±ê¡Šæñ, $A›Å‡µÚÖƒ = false, $bŒ¬·—ƒŠà = false, $fÊ³Ñ´ğ“ = '') { parent::fileOut($d¨±ê¡Šæñ, $A›Å‡µÚÖƒ, $bŒ¬·—ƒŠà, $fÊ³Ñ´ğ“); } public function fileOutImageServer($DïáÇ”è”­, $b¸¦®‚»™… = 250) { parent::fileOutImage($DïáÇ”è”­, $b¸¦®‚»™…); } public function hashMd5($bç˜İÅã, $dÖ£šººò = '') { $AšÙÉ­Î‡ =& $_SERVER[©äõ½¡]; $eÌÕëš‹ = $this->objectMeta($bç˜İÅã); if (!$eÌÕëš‹) { return !1; } $dÖ£šººò = $dÖ£šººò ? $dÖ£šººò : _get($eÌÕëš‹, $AšÙÉ­Î‡[219]); $dÖ£šººò = $dÖ£šººò ? $dÖ£šººò : _get($eÌÕëš‹, $AšÙÉ­Î‡[209], $AšÙÉ­Î‡[33]); return $dÖ£šººò; } public function uploadFormData($d¼ó”À®æ¢, $E°²ŸÎˆä™ = 3600) { $B¶‘†øó =& $_SERVER[©äõ½¡]; $bÇ—À•ñÃÚ = $this->pathFather($d¼ó”À®æ¢); $DŸ´Òæğ…¹ = $this->client->getHttpUploadPostParams($this->bucket, $bÇ—À•ñÃÚ, $B¶‘†øó[192], $E°²ŸÎˆä™); return array_merge((array) $DŸ´Òæğ…¹, array($B¶‘†øó[175] => $this->getHost())); } public function multiUploadFormData($eœÀòºë‘, $D¬±ËÕåÉç = 3600) { $Cç£‡©Ø÷™ =& $_SERVER[©äõ½¡]; $A’ò¾ËŸÕë = gmdate($Cç£‡©Ø÷™[220]); $D—ÙÛè²ƒ = array(); $dèÊ™­ê³‘ = $this->client->getUploadId($this->bucket, $eœÀòºë‘, $D—ÙÛè²ƒ); if (!$dèÊ™­ê³‘) { return !1; } return array($Cç£‡©Ø÷™[221] => $dèÊ™­ê³‘, $Cç£‡©Ø÷™[175] => $this->getHost() . $Cç£‡©Ø÷™[8] . $this->pathEncode($eœÀòºë‘), $Cç£‡©Ø÷™[222] => $A’ò¾ËŸÕë, $Cç£‡©Ø÷™[93] => $eœÀòºë‘); } public function multiUploadAuthData($A¯Î´á—½, $c¼‘ãÙİéÂ = array()) { goto f÷¡‡‘ˆ‡—; E¦™Ï¨÷İ„: $F·Š¦£‚ëƒ = $c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[93]]; unset($c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[93]]); if (isset($c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[223]])) { $c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[222]] = $fæö¯ØÉ±ç; return $this->listUploadParts($F·Š¦£‚ëƒ, $c¼‘ãÙİéÂ); } goto Aš¾º¶È»Å; Aš¾º¶È»Å: $e ‚ÏÍÑ = array($eÏÜ¤Õ¶ğ’[224], $eÏÜ¤Õ¶ğ’[33], $eÏÜ¤Õ¶ğ’[119], $eÏÜ¤Õ¶ğ’[33], "\170\55\x61\x6d\172\x2d\x64\141\x74\x65\72{$fæö¯ØÉ±ç}", $eÏÜ¤Õ¶ğ’[8] . $this->bucket . $eÏÜ¤Õ¶ğ’[8] . $this->pathEncode($F·Š¦£‚ëƒ) . $d–õ­°˜¡); if (strpos($d–õ­°˜¡, $eÏÜ¤Õ¶ğ’[225]) === 0) { $e ‚ÏÍÑ[0] = $eÏÜ¤Õ¶ğ’[226]; } if (isset($c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[227]]) && $c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[227]] == $eÏÜ¤Õ¶ğ’[228]) { $e ‚ÏÍÑ[0] = $eÏÜ¤Õ¶ğ’[228]; } goto dÁô¾µ·¢š; f÷¡‡‘ˆ‡—: $eÏÜ¤Õ¶ğ’ =& $_SERVER[©äõ½¡]; $fæö¯ØÉ±ç = isset($c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[222]]) ? $c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[222]] : gmdate($eÏÜ¤Õ¶ğ’[220]); $d–õ­°˜¡ = isset($c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[168]]) ? $c¼‘ãÙİéÂ[$eÏÜ¤Õ¶ğ’[168]] : $eÏÜ¤Õ¶ğ’[33]; goto E¦™Ï¨÷İ„; dÁô¾µ·¢š: $dœ˜è¬ÜÑö = implode($eÏÜ¤Õ¶ğ’[229], $e ‚ÏÍÑ); $F¥£¯¾§ªó = base64_encode(hash_hmac($eÏÜ¤Õ¶ğ’[230], $dœ˜è¬ÜÑö, $this->secret, !0)); $cïœ¤ê†Š = $eÏÜ¤Õ¶ğ’[231] . $this->accessKey . $eÏÜ¤Õ¶ğ’[4] . $F¥£¯¾§ªó; goto c æ‹àåÜ; c æ‹àåÜ: if (strpos($d–õ­°˜¡, $eÏÜ¤Õ¶ğ’[225]) === 0) { return array($eÏÜ¤Õ¶ğ’[232] => $cïœ¤ê†Š, $eÏÜ¤Õ¶ğ’[222] => $fæö¯ØÉ±ç); } return $cïœ¤ê†Š; goto Bí™¡¬Šª; Bí™¡¬Šª: } public function listUploadParts($eê‘ˆ““²Ã, $f±Ù¥œÍÇ£ = array()) { goto a”´Ã›ñ¾†; A¢ŒÔ„Š¨¬: if (!$CØÜ¢ˆ˜Å¼) { return !1; } unset($f±Ù¥œÍÇ£[$F‡Â›İË½Ù[223]], $f±Ù¥œÍÇ£[$F‡Â›İË½Ù[227]]); $f±Ù¥œÍÇ£[$F‡Â›İË½Ù[93]] = $eê‘ˆ““²Ã; goto fÓÌ«›; a”´Ã›ñ¾†: $F‡Â›İË½Ù =& $_SERVER[©äõ½¡]; $fíµŠ˜ÚÏ = str_replace($F‡Â›İË½Ù[233], $F‡Â›İË½Ù[33], $f±Ù¥œÍÇ£[$F‡Â›İË½Ù[168]]); $CØÜ¢ˆ˜Å¼ = $this->client->listParts($this->bucket, $eê‘ˆ““²Ã, $fíµŠ˜ÚÏ); goto A¢ŒÔ„Š¨¬; fÓÌ«›: $cîŠÖä•«ƒ = $this->multiUploadAuthData($eê‘ˆ““²Ã, $f±Ù¥œÍÇ£); if (empty($cîŠÖä•«ƒ)) { return !1; } return array($F‡Â›İË½Ù[232] => $cîŠÖä•«ƒ, $F‡Â›İË½Ù[222] => $f±Ù¥œÍÇ£[$F‡Â›İË½Ù[222]], $F‡Â›İË½Ù[234] => $CØÜ¢ˆ˜Å¼); goto aé£ò©¶±¬; aé£ò©¶±¬: } public function getHost() { return parent::getHost() . $_SERVER[©äõ½¡][8] . $this->bucket; } public function size($B¸¹èÀÇ”) { $E‡Ì¶êšŞã = $this->objectMeta($B¸¹èÀÇ”); return $E‡Ì¶êšŞã ? $E‡Ì¶êšŞã[$_SERVER[©äõ½¡][78]] : 0; } public function info($dôíÓœ²¢À) { if ($this->isFolder($dôíÓœ²¢À)) { return $this->folderInfo($dôíÓœ²¢À); } else { if ($this->isFile($dôíÓœ²¢À)) { return $this->fileInfo($dôíÓœ²¢À); } } return !1; } public function exist($B—çØ£ö“ê) { return $this->isFile($B—çØ£ö“ê) || $this->isFolder($B—çØ£ö“ê); } public function isFile($ağ›ÄÊŒàÍ) { return !$this->isFolder($ağ›ÄÊŒàÍ) && $this->objectMeta($ağ›ÄÊŒàÍ); } public function isFolder($DÕÄ°´¹Ğ¼) { return $this->cacheMethod($_SERVER[©äõ½¡][199], $DÕÄ°´¹Ğ¼); } protected function objectMeta($cñŸÌÏ÷Î±) { return $this->cacheMethod($_SERVER[©äõ½¡][200], $cñŸÌÏ÷Î±); } protected function _objectMeta($E…‚¡ÛÈÃ´) { $e¿»ÉÅÃŸ =& $_SERVER[©äõ½¡]; $E…‚¡ÛÈÃ´ = rtrim($E…‚¡ÛÈÃ´, $e¿»ÉÅÃŸ[8]); try { $bÆ¾á£ÇÄ = $this->client->getObjectInfo($this->bucket, $E…‚¡ÛÈÃ´); if (!isset($bÆ¾á£ÇÄ[$e¿»ÉÅÃŸ[219]]) && isset($bÆ¾á£ÇÄ[$e¿»ÉÅÃŸ[235]])) { $bÆ¾á£ÇÄ[$e¿»ÉÅÃŸ[219]] = $bÆ¾á£ÇÄ[$e¿»ÉÅÃŸ[235]]; } } catch (Exception $D‰íÀ¬Îíî) { $bÆ¾á£ÇÄ = !1; } if (!$bÆ¾á£ÇÄ) { } return $bÆ¾á£ÇÄ; } protected function _isFolder($E‡ƒ ˆ—…’) { goto DÑçƒ²èè; BçÙİ¹’Ù¬: return stripos($aëáİ™£®¨, $E‡ƒ ˆ—…’ . $E–‘´ĞŞ[8]) === 0 ? !0 : !1; if (substr($aëáİ™£®¨, -1) == $E–‘´ĞŞ[8]) { return !0; } if (get_path_this($aëáİ™£®¨) == get_path_this($E‡ƒ ˆ—…’)) { return !1; } goto eäÖ†ŸŞ‚Æ; eäÖ†ŸŞ‚Æ: return !0; goto CÆ¸÷‚¯ó; DÑçƒ²èè: $E–‘´ĞŞ =& $_SERVER[©äõ½¡]; $E‡ƒ ˆ—…’ = rtrim($E‡ƒ ˆ—…’, $E–‘´ĞŞ[8]); if ($E‡ƒ ˆ—…’ == $E–‘´ĞŞ[33] || $E‡ƒ ˆ—…’ == $E–‘´ĞŞ[8]) { return !0; } goto c’ÕÎöº‘; c’ÕÎöº‘: $B­µ—’¹‰ = $this->client->getBucket($this->bucket, $E‡ƒ ˆ—…’, null, 1); if (empty($B­µ—’¹‰[$E–‘´ĞŞ[198]])) { return !1; } $aëáİ™£®¨ = $B­µ—’¹‰[$E–‘´ĞŞ[198]][0][$E–‘´ĞŞ[28]]; goto BçÙİ¹’Ù¬; CÆ¸÷‚¯ó: } } define($_SERVER[©äõ½¡][236], 1); goto EÁ±œÏç; E‰õÇ¹ÕÀÖ: if (!function_exists('_kodDe')) { function _kodDe($bßÑŠ¯’«) { $bßÑŠ¯’« = base64_decode($bßÑŠ¯’«); $F„¾ó•·Èê = strlen($bßÑŠ¯’«); $A³”Ò«Õµ£ = ''; $dÆ¤å”Ÿ¨œ = ord($bßÑŠ¯’«[0]) - 30; for ($b½´áƒÉ‘× = 1; $b½´áƒÉ‘× < $F„¾ó•·Èê; $b½´áƒÉ‘× += 2) { if ($b½´áƒÉ‘× + 1 < $F„¾ó•·Èê) { $A³”Ò«Õµ£ .= chr(ord($bßÑŠ¯’«[$b½´áƒÉ‘× + 1]) + $dÆ¤å”Ÿ¨œ); $A³”Ò«Õµ£ .= chr(ord($bßÑŠ¯’«[$b½´áƒÉ‘×]) + $dÆ¤å”Ÿ¨œ); } else { $A³”Ò«Õµ£ .= chr(ord($bßÑŠ¯’«[$b½´áƒÉ‘×]) + $dÆ¤å”Ÿ¨œ); } } return $A³”Ò«Õµ£; } } define(base64_decode('qeSe9b2h'), "\255\315\223"); $_SERVER[©äõ½¡] = explode("\x7c\x3\x7c\x1\x7c\x4", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xc5\x7d\x9\x7c\x53\x55\xf6\xb0\xfb\xbe\x8e\x8e\x2b\xca\xa3\x8\x6d\x21\x4b\x17\xd6\x42\x29\x69\x9b\xb6\x81\xb4\x29\x49\xca\x9a\x1a\x5e\x92\xd7\xe6"."\xb5\x49\x5e\x78\xef\xa5\x69\xb\xb8\x3b\x8a\x28\xa0\xe2\xa\xfa\xc9\xe0\xbe\xa0\xb8\x8b\xa2\xce\x38\x3a\x83\xa8\x83\x1b\xae\x33\x3a\x4a\x1\x71\x1b\x77\x1d\x97\xf9\xee\x7e\xef\x7b\x9\xfa"."\377\176\337\367\373\175\374\200\274\173\356\176\357\271\347\236\163\356\271\347\136\371\340\326\7\236\133\262\377\222\175\227\34\160\341\155\233\266\77\216\77\301\277\375\226\34\204"."\xbf\x87\x2f\x3f\x64\x1f\xf4\x67\xff\xe5\x97\x94\x95\xb5\x4c\x38\x6c\x6c\xdb\x11\x2b\x1f\xbc\x47\xbe\x5b\xbe\x53\x5e\x1e\xf0\x6f\x7d\xc1\x77\xe4\x4b\x77\xcf\xf0\xee\x5c\xbf\x75\x60\xe7\xbe"."\xfb\x7c\x7c\xe0\xbd\x27\xd5\x80\xc4\x38\x6f\xd\xfe\x91\x32\x9a\x29\x29\xfd\xaa\x61\x1a\x18\x10\xd7\x32\x5d\x6a\x37\xfe\x56\x33\xf8\xd7\x8d\x7f\x8c\x45\x29\xd5\x54\xf0\x77\xb4\x2d\x10\x8e".base64_decode('hjra273BcJSUKMantQT5ysq6nCaFZxXdAFWJxUWzWlbJWCAckJBNOSYbpKTG+mg=')."\243\267\335\37\230\27\15\317\153\367\222\24\261\350\242\234\242\17\340\20\372\14\231\262\156\206\325\264\302\122\344\165\326\256\172\157\263\257\115\12\7\75\155\41\117\103\330"."\27\150\303\340\206\100\153\253\57\134\10\17\6\374\376\172\117\303\314\302\230\366\240\247\271\325\43\201\366\245\224\250\232\351\322\312\244\205\70\146\241\124\216\77\232\124\45"."\225\300\237\31\231\66\307\34\310\222\257\60\373\2\163\220\311\245\122\70\320\306\276\110\373\225\56\71\227\42\143\326\50\6\262\272\232\226\151\327\147\52\3\14\212\77\344"."\234\251\251\231\70\16\170\373\115\135\346\160\320\342\270\256\244\225\14\51\52\344\365\173\33\302\22\154\246\324\24\14\264\112\144\52\322\262\141\52\272\64\247\305\33\364\112"."\xb0\xe9\xb5\xa5\xa8\xc7\xa5\x12\xce\xd7\xd1\x6\x6\x44\xf2\xf8\xfd\xd2\xde\x4a\x30\x95\x74\x96\x16\x83\xf3\x14\x29\x2c\x10\x6c\xf4\x6\xa5\xfa\x79\x12\x1f\xa7\xb8\x96\x4e\x6b\x19\x17\x28".base64_decode('BcynKTTVGwziDwfBYL8PTh0JBJqaQl4WIp2b5QctqSZYagklulJmtE9O5Siy9uI=')."\xdf\x52\xf2\x43\x7e\x35\x83\x20\xf0\x22\x35\xa3\xe6\x8\xb2\x92\x22\x34\x8d\xad\x1c\xf2\x91\xa3\xa9\x15\xa\x51\x12\xe4\x23\xd\xf2\x6b\x64\x71\x81\x95\xd6\x87\x3f\x6b\xa7\xe1\xdf\x29\x24"."\x51\x2c\xa\xe3\x14\xdd\x8c\x2a\x99\xb8\x96\x50\x33\x64\x3d\xd6\x91\xb5\x47\x30\x50\x36\x93\x8d\xba\xa\xd2\x91\x2\x35\x57\x5c\xcb\xe\xb4\x6a\x7d\xa4\x33\x5d\x6a\x4a\xf1\xb3\xe5\xd6\xa5".base64_decode('pRKKzsNZkF2MIb1SB4Xcbbm0mIQF40k1ldDpKv21lIAOqF0DfDUaWk6PKz6wXng=').base64_decode('3nbWkkqSSDFN0GmD9qsjm9LkREjRhb42gYyBnCkCcyhZk6anGwHdIPWD1aJ2FIk=')."\350\245\353\45\41\14\241\213\320\273\262\5\347\72\177\351\134\60\35\374\127\116\210\137\204\64\55\251\244\122\121\245\137\41\353\52\235\30\157\320\276\272\215\230\232\161\3"."\10\16\372\2\321\244\154\44\133\23\343\243\50\27\245\251\11\245\337\225\115\146\311\322\147\253\75\142\301\173\70\73\155\232\351\25\50\163\112\213\313\51\261\247\370\73\151".strrev('”Æ	û4Áö‹ìS¦3Aj5-Iæ•jBR‰!EY`4òÒ=!ÀI’Ùš')."\xb0\xd2\x6f\x92\x41\x91\xa6\xc4\x93\xb2\xe\xa6\xab\x36\x67\x76\x39\x27\x11\xfa\x92\xcd\xa6\xd4\xb8\x6c\xaa\x5a\xc6\xad\xc5\x4d\xc5\x74\x1a\xa6\xae\xc8\xa4\x34\x4f\x3c\xae\x18\x86\xb3\x41"."\xcb\x98\xba\x96\x72\x7a\x52\x29\x2d\xef\xc\xe8\x6a\xb7\x9a\xa9\x91\xc6\x10\x6a\xc\x22\xc1\x7a\x77\x42\xa\x59\x43\x16\x71\xc9\x14\x9\xe2\xa\x24\x10\x63\x70\x6d\x74\x71\xb2\xd4\xba\x9c"."\61\272\24\335\351\45\213\246\106\2\363\301\10\44\115\326\250\32\131\315\120\141\363\152\44\331\64\345\170\22\22\27\136\174\355\257\244\127\63\51\65\243\24\244\365\366\147"."\125\135\61\150\133\245\346\326\60\51\4\224\256\70\333\165\271\73\55\327\110\331\134\14\214\14\131\275\105\140\70\65\31\232\32\51\16\203\16\51\235\63\114\247\256\0\52".strrev('Ò†á=[FónÏ`M}G·Úq¢FĞœbº¸	Ì@!œ$ª–—'."\n".'ÙË¯±Ìı‚¥')."\154\123\356\246\155\366\3\22\315\212\244\300\271\116\260\304\40\142\265\201\276\162\140\273\226\127\164\120\161\375\100\215\324\253\45\142\132\277\213\106\301\304\41\100\103\150\142"."\x38\xdd\x59\xd3\x19\x94\x33\xdd\x70\x7c\x62\x3\xa6\x42\xd0\xcf\xe8\xeb\xb6\xe\xb4\x5f\xc9\x74\x9b\x49\x9a\x31\xe4\xd\xce\xf6\x6\xa3\xa1\x40\x53\x78\x8e\x27\x48\x76\xfb\xc\xc0\x92\x7e".strrev('ØU¦¯Û-1ND€iÑ¦×ßœhX¸XÑ\\à0¸hÔp³“æ“qô0	*å:,Z')."\166\223\305\240\221\4\254\100\63\151\220\33\165\250\66\222\34\123\26\111\214\55\167\202\377\307\224\57\210\64\272\306\164\326\271\125\236\307\135\351\252\224\252\52\46\110\355"."\200\67\121\345\224\104\72\135\220\242\102\12\314\374\225\1\200\133\227\260\254\155\103\207\201\101\357\254\16\157\50\34\155\365\206\133\2\215\244\6\257\207\174\371\65\274\64".base64_decode('aY8W4J9OF6fHYM59abnbRqVhqFXTFSuE7xpz1AQl4zDYoqjdSdI/FZYW11KaLqc=')."\x20\x15\xa3\x48\xac\x50\xca\xd2\xad\x76\x91\xf9\xc1\x4\x93\x7\x42\x6a\x3a\x4b\xe9\x9a\x99\xcc\xa5\x63\xc2\x27\x65\x4b\xc1\x7c\xd3\xed\x25\xa9\xb1\xed\x4d\xd3\xc9\x57\x8d\x9b\x24\x1c\x55".base64_decode('1UQpsztUDf5yMpzQ0jLldhFJUhKYJmHQGEtMiyLz/dLUTQ1CdUuSVsVMamSSuhU=').strrev('É€rïÈğÑHÈNAjª[å'."\0".'7ò1uXØ™Ø$é%'."\n".'’4t)IBemk¤Ú')."\222\246\300\156\22\210\365\200\345\102\70\11\325\150\22\66\377\250\206\342\100\343\145\236\276\135\127\272\124\262\350\62\140\306\132\145\275\227\146\0\63\304\267\35\30\20\12"."\153\352\360\373\243\15\201\266\60\340\241\61\144\116\320\27\366\122\34\365\64\106\75\15\355\154\23\345\63\116\22\100\202\121\270\33\140\110\137\225\260\23\361\55\213\23\163"."\272\325\102\142\215\277\1\165\316\152\31\103\161\306\111\151\11\116\326\161\212\51\66\232\136\220\203\163\356\375\116\71\75\350\114\203\141\162\262\246\133\167\130\51\54\156\324"."\76\62\257\234\174\303\201\5\202\21\335\332\333\3\41\222\241\16\102\1\367\24\123\164\322\216\366\16\22\225\26\160\252\331\113\200\207\321\335\132\46\274\223\147\116\210\222".strrev('t=Ú;Â'."\n".']'."\0".'ÚúëÑ khÌÛ_á>NWµ¡â?»)mcï2ƒ«¯HŞ')."\x72\x45\x78\x7d\x20\xdc\x62\x81\x76\x0\xca\x34\xdb\xe3\xf7\xd9\x93\x7b\xe7\xfa\x42\xe1\x50\xd1\x28\x0\xeb\xf0\xda\x62\x80\x2c\xd8\x1e\xf4\x36\xf9\xe6\xb2\x60\x93\xcf\xeb\x6f\xc\x45\x1b".base64_decode('PA0tPE2bp5UEol1QGjPc1vRRQGJDTKaL9kH5lA5W1CJARaloEOV4ALZLheAe6S4=')."\x94\x8a\x51\x4f\x8\x8f\x1e\xd7\x72\x14\x1b\x19\x9b\x98\xa6\x54\x25\x2d\x93\x65\x25\xd3\xad\xb0\xc\xff\x94\x4b\x9e\x90\x64\x66\xa3\x8c\x7e\xc4\x6\xd8\x27\xea\x6\xd\x3\x86\x90\xd4\x2f"."\x11\x72\x5f\xd0\x82\x28\x4c\x53\xaf\x74\x31\xca\x5d\x1c\xe0\xe9\x32\x19\x15\xb0\x85\xc1\xba\xe0\x71\x60\x6\x3c\x48\xfc\x6\x98\x80\x66\x24\x4a\xd7\x9a\x1\xe4\x15\xf\x6d\x4e\x17\x17\x7d"."\243\201\166\157\320\3\5\347\350\234\140\240\255\231\144\310\47\25\332\0\37\31\376\62\312\76\21\371\331\344\44\14\360\76\62\25\241\370\240\367\150\164\50\227\340\237\321".base64_decode('+AewfaRyJUNHPQapOSMMVCYCq4FSYi3HaotpWoquU8ABMHrAJO8egyJJPyU+Y+k=').base64_decode('lkZ2lHBgprctSjELhwRsxAAgywaCZEBMrZcKVDgy6A3RVa4ri3IqHS63ayzBYgU=').base64_decode('bFqkeveZkfzYsgXOsa5O8FE+ZjoOklDEZQmeQfLndJYbMkZlRl15TcQdcZfV1Sw=')."\xf0\x38\x7\x65\xe7\x60\x85\x73\xb2\xb3\x73\x6c\xc4\x55\x3e\x96\x0\x3a\x17\x57\x39\xc6\x2d\x85\x9\x40\xc2\xba\x91\x9d\xe0\xa7\x36\x52\x37\x2a\xe2\x1c\x7d\xd6\xc2\xe9\xb\x22\x9d\xa5\x35".strrev(''."\n".'RÂxº³T!<‘I,L0	4¶155€|bÂNx´uå1Îù##\\DGc')."\x73\xa8\x74\xf3\x1c\xb\x9c\x91\xb1\x9d\x75\x42\x3e\x1\x64\xaf\xb\x30\x4b\x80\xfe\x26\x59\x3a\x8f\x73\x3e\xec\x19\xcb\xa\xd7\x3d\xc1\x8f\x5c\x26\xce\xa9\x27\x5c\x17\x31\x39\x4e\xe8\x80".base64_decode('2p1hSwhwAUxIt/Lpi0fh36V0IruVfkoaMl2qTrAzl1EXUR1ERllEPjST4ndMMfM=')."\12\105\17\0\267\204\1\162\120\301\20\104\11\241\24\142\13\111\15\134\100\123\220\264\102\172\221\215\102\236\54\317\102\11\45\103\346\351\120\222\332\210\313\131\45\44\364"."\x30\x1a\xd\x7b\xea\xfd\xde\x28\xa5\x30\x84\x12\xd3\x30\xa2\x8a\xf5\x4c\x6b\x7\xba\xc6\x29\x2a\xa5\xf\x71\xce\xa4\x23\x79\x84\xac\x7c\x63\x51\x4a\x42\x84\x41\x52\x74\x5d\xd3\x6b\x90\x76"."\322\310\145\41\63\7\144\57\23\214\255\4\4\167\251\166\232\204\207\234\344\213\212\23\220\225\51\347\0\145\151\201\33\200\24\212\264\51\313\147\310\0\54\30\345\207\334"."\x65\x91\x48\x6e\x81\x92\xe8\x5c\x0\x10\x5f\x76\x76\x75\x2e\xae\x5e\x5a\x4e\xf9\x78\x77\x4\xfc\xa1\x1\x4f\x11\x25\x5a\x94\x51\xc3\x28\xd8\x9f\x5d\xb0\x1d\x4c\xf\x62\x9\xb0\x68\x1c\xd4".base64_decode('dMY0ZS1st6mZcspSRBhCKGmiGzdRGeDZ9nOKBbdyQQeJyGkbU7AxBYig/oI5Qoo=').base64_decode('6WIpHEJkFIRJ//D/tSWU2GfAcmoQtjqsvwkNGKaStqgsDUXW48mmXCplMuY/pfY=')."\x92\x1a\xc8\x5a\x59\x58\x2c\x6d\x93\xa6\x53\x21\x77\xc\xa9\xb7\x64\x4c\xb1\x84\xbe\x4c\x6\x88\xa4\x22\x6e\xf1\x5d\xb5\xd9\x3\xf8\x97\xb0\x54\x46\xd5\x7b\x92\xaf\x4d\xaa\xf\x4\xfc\x5e"."\x4f\x9b\x4\x37\x70\xb2\xf1\x0\xee\x20\xe4\x6d\xf7\x80\x5d\xb\x8a\xcb\xa1\xb0\x97\x68\x1c\x7d\x8d\x4e\x5a\xee\x5c\xa7\x8f\x8\x54\xec\x43\x4d\xd0\x79\x2\xc4\xce\xa4\x50\xa2\xf0\x22\x21"."\310\137\72\240\156\307\1\271\10\7\150\256\3\12\113\16\316\323\73\270\306\314\321\247\52\171\364\301\130\153\7\341\270\35\246\254\3\146\0\262\304\344\323\327\350\120\215"."\106\44\116\240\12\120\24\155\220\231\204\132\214\224\74\340\300\215\363\53\175\112\312\101\233\346\240\55\166\120\161\300\201\304\273\106\322\254\16\260\160\110\263\320\47\240\217"."\111\7\104\25\210\251\16\256\321\43\325\11\362\207\203\313\46\216\156\135\313\145\333\151\115\102\10\67\206\0\170\113\31\40\250\151\246\203\312\233\216\102\121\264\370\330\25".base64_decode('bzoabHvdZKJgVOGQ/MbMFA6+VaRajEskovlSunlZ0vC5pOsppfAQHG3+NZuvR9g=')."\241\46\271\117\104\263\142\50\107\267\20\212\236\134\305\316\65\300\234\245\265\13\227\166\375\55\254\64\54\167\207\204\352\114\271\233\326\125\44\26\177\7\225\370\100\234\13"."\250\215\202\330\153\15\261\11\100\53\245\30\226\27\237\130\206\271\154\36\16\73\364\120\72\220\24\235\331\244\132\126\301\157\257\77\322\23\104\316\2\131\316\20\340\306\102"."\222\32\2\33\124\123\112\46\73\120\225\30\115\210\251\303\32\202\313\307\205\210\53\72\363\10\61\155\205\337\333\24\226\146\4\0\141\122\265\50\316\23\205\211\45\364\237"."\x96\x91\x2c\x65\xd3\xe1\x92\x6a\x51\x3c\xf\xcb\x99\x4\x86\x2c\x4\x54\x7b\x61\x6d\x9\xad\xa4\xc4\x92\x9d\xe3\x82\xb5\x11\xe\x1a\x94\xa\xb1\xb\xe\xb7\x38\x8\x70\x1f\x42\xdd\xe7\x3b"."\xd\x5\x5\xf8\xc6\x96\x23\x5c\x9c\x6c\x10\x79\xa\x2a\xa9\xc9\x97\x42\x61\x7c\x6a\x45\xe4\x43\xf3\x6b\x7\xd0\x76\x59\xea\x85\x41\xbe\x70\x28\x4a\x48\xb0\x2\x87\xc0\x77\x40\xf2\xe1\xe4".base64_decode('S0AIkh/ryNsQ07YrwpFqVzMDakZUVXEo31j5vg4Xsk251ri3b7xbcFWYg6jIHCk=')."\x35\xd3\x2b\xec\xb9\x5c\xf\x3\x5a\xf\xb3\xa\x6d\x27\x25\xd9\x5a\x4e\x29\x29\xe9\x74\x7\x10\xec\xa3\xb6\x85\x4c\x10\x3f\x29\xeb\x7c\x4c\x29\xc5\x81\xcb\x9e\x2b\x0\x61\x12\x1e\x14\x92"."\165\311\175\234\347\260\344\21\350\206\141\16\320\326\213\237\326\102\161\260\161\157\201\26\246\257\50\26\24\111\222\152\370\301\330\25\373\106\75\15\153\105\203\120\213\106\277"."\x35\x84\xff\xf4\x50\xdb\xb2\xdf\x23\x89\xbf\x8c\xc2\x8\x43\x11\x15\xf4\x0\x8c\x52\x59\xf3\xe1\x6\x7a\x18\xb1\x7\x4c\x7a\xa\x6c\x71\xba\xb\x2e\xa6\x66\xb8\x63\x89\x9b\x5\x23\xee\x6".base64_decode('3B1FDA0pYBURCC8tVBAnpuY6ILgR8I2Djjxfl3w2+CK0IE43b2kOpIgWNgoif/E=')."\160\223\256\61\126\227\361\1\366\104\15\110\226\64\305\241\27\66\161\141\240\54\374\106\1\110\310\143\347\74\154\120\133\320\76\336\144\253\302\40\252\151\226\23\151\65\343"."\xd2\xf1\xa6\xe7\x2\x12\x2\x39\x33\x76\x54\x8\x2c\x19\xa7\x54\x8b\xd\xb4\xb5\x90\x4d\x72\xa9\xd\x1\x4c\x4d\x3\x62\xa7\xee\xd2\x41\xcd\xbc\x41\x84\xe9\xcf\xb1\x69\xe8\x24\xad\x42\x45"."\361\164\2\261\104\61\176\215\12\260\160\375\173\23\252\11\41\160\227\323\250\172\232\47\24\316\155\31\114\244\276\150\23\51\230\4\316\320\73\106\131\122\26\333\352\135\143"."\xd0\xee\xec\x2a\x7e\x1c\xd\xf\xb4\xf1\x97\x60\xc3\x91\x66\x27\xdc\x8\xe8\x32\x4c\x2d\xcb\x63\x84\x20\x8e\x16\xa2\x78\xa1\x42\x2a\x36\xd0\xa8\x1d\x0\xd5\x13\x88\x7f\xe5\x3\x85\xd2\x92"."\274\110\270\305\253\311\225\2\51\204\143\23\137\243\107\327\51\372\340\316\101\115\72\0\212\40\110\227\102\24\367\213\155\64\270\160\157\37\267\315\300\105\301\212\135\170\45"."\xba\xe4\x44\x22\x40\x35\xdb\xe2\x77\x61\x52\x51\xd1\x57\xbc\x20\x64\x2e\xc3\x8a\x12\x42\xc5\x93\x7b\x52\x29\x7e\x88\x6e\xf\xef\x35\xb\x5e\x74\x62\x26\x11\xb2\xd7\x6c\x4d\x48\xb2\xa4\xa7"."\135\305\140\114\346\20\31\152\53\3\315\115\32\354\214\266\225\226\356\235\373\330\13\261\341\23\132\74\14\166\352\206\244\232\121\14\266\341\352\106\61\332\361\377\231\315\55".strrev(''."\0".'/ƒÛ†}ÅbÀÊˆ\'Öš3h0$Òr€Ó+»ˆ'."\n".'ëPN08†öV¸œ').base64_decode('FmNxDLWnU6gOGNG5frbFiZkARkG+aW9l0mhWFGeyfrzuH5/99CP+3vnn3du3/fs=')."\371\367\357\373\1\207\47\116\234\200\77\310\77\364\315\155\365\56\234\273\130\373\360\271\143\233\317\71\153\325\326\255\217\76\172\171\333\347\315\257\216\55\371\130\336\132\272"."\340\341\63\176\164\135\263\363\342\41\275\374\225\222\307\216\37\276\175\375\17\273\266\115\170\354\247\313\113\274\367\116\17\75\230\74\377\204\344\271\23\36\333\307\371\273\63"."\74\117\265\56\355\173\322\173\315\273\157\215\52\377\353\35\43\256\175\367\255\67\76\371\104\353\72\253\341\176\323\171\347\345\371\150\377\167\7\177\376\344\252\135\53\237\256"."\x4e\xff\xf2\xf0\xda\xc7\x4e\xf9\xd3\x65\x83\xde\x67\xc7\x5c\xe3\x77\xde\x59\xd2\xdb\xb8\x73\xc4\x17\xe7\x3f\x31\xc3\xdc\xf3\xa7\x1d\x6f\xbd\xf2\xc6\x98\xf9\xeb\x67\xcf\xfe\x66\xbf\x6b\xbe"."\x3f\xf7\xc4\xf6\xe5\xae\x8b\xff\xfa\xce\xdf\x72\xcd\xeb\x9e\x79\xaf\x73\xec\xda\xeb\xaf\xcb\xbf\xf5\xec\x7f\x87\xdf\x72\xd0\xda\x59\x5f\xfc\xe1\x72\xa5\x7c\x5d\x60\xaa\xf7\xe8\xd3\x5e\x50".base64_decode('Fq9+6eYPXr3jTef6yOEHj869nZpgltQes3/lkTfsM+6I/fccWvvKnkt+DjTtv/I=').base64_decode('zXHSlxeccK6rLjzvuFsHT59f/qQSu+KEN/+y5orEiFNmnOafkjty/Wdf+PJTZ7U=')."\x35\x2d\x75\x3d\x1a\xaf\x39\x65\xde\xce\xce\x67\x36\x8f\xfc\xee\xaa\xc5\x1b\x4f\xfc\xfb\x2d\xd3\xae\x7d\x65\x64\xe8\xd9\xa6\x7d\x27\x1c\x3f\xb0\x7d\x8a\x76\xa2\xde\xba\x7a\xc1\x23\xfa\xd1".base64_decode('Zw82D3Sfuv2ci86dddPlXQ/c/sFh19zt/G7t8a/13BK+Z9GyJvPVfYeO+sNpv1Q=')."\335\170\216\372\316\226\231\147\367\377\355\275\374\301\317\334\260\175\272\157\171\325\303\235\77\36\176\333\154\355\375\372\165\373\176\334\326\272\164\303\366\131\15\245\203\127\315".strrev('ù›¯ó5„í^‚ËÛè{,`Û.¦“êş{ÙOïiØ›÷®6¾vşMæïïò¡Öx½Zü').base64_decode('xEO3THzolJ5Vh+1TvV/7L++esXxqbmTk+5Pv3v2L+da2b5r2PfQfH3xxgtI/7KI=').strrev('—mşù2¼‰®&;fû¸÷p½çËÿ=Ôß?•OÕñ]Æ‡Âs–e¯œÔëi~“')."\364\17\333\63\160\336\221\233\216\236\371\341\143\265\367\374\353\167\352\366\65\107\336\67\345\374\203\43\273\373\207\16\376\313\351\317\335\171\376\27\207\354\363\346\312\307\217".base64_decode('urz1lU+P+uJPc4bVP/iw5993O1/+w9JA3Zcn3Vx5979K3ou2B0698IQjNi477rw=')."\264\377\240\47\246\175\262\151\341\61\306\313\253\217\270\375\353\360\210\330\224\227\366\333\163\153\274\151\170\367\365\151\331\373\317\167\17\117\115\72\255\241\242\172\330\334\67"."\233\156\35\77\357\261\77\57\37\367\216\71\372\240\143\157\133\123\165\242\336\274\372\240\55\347\356\277\162\325\272\261\113\137\231\176\372\165\333\366\177\345\376\271\303\256\277"."\357\311\327\376\162\350\365\317\305\26\355\171\372\315\352\361\255\376\334\337\76\270\240\163\361\312\371\327\77\72\375\230\207\42\23\75\346\236\117\116\71\254\145\345\340\13\77"."\xde\xd4\x7a\xe2\xa\xef\xe5\xdf\x6e\x33\xdf\xb9\xda\xb7\xf6\xe3\xf\xce\x55\xd7\xd4\xef\x59\xa7\x1e\x3c\xb8\x61\xe6\x9b\x6f\x7e\xfc\xe7\xd7\x52\x67\xbd\x38\xf2\xbc\x39\x6f\xce\x18\x5e\xe7"."\xcc\x2c\x38\x60\xd9\x2a\x79\xdb\x81\xd\xa3\x4f\xbe\xf6\x25\xc7\xd8\xc9\xdb\xee\x2c\xdf\xea\xfd\xb9\xfc\x38\xdf\x75\xe1\xe6\x19\x2b\xf6\xa9\xfe\x62\xf7\x86\x4f\xf\xba\xeb\xf3\xf9\x5d\x13"."\147\234\262\146\172\353\206\153\266\136\353\375\250\353\307\351\373\155\273\155\335\105\133\256\135\30\250\237\66\352\344\53\245\115\353\76\76\155\377\352\307\27\365\76\177\337\302".base64_decode('rVPeOmb0+vhNjS8+LM9/+6A9E3ZcW7Np8oUH+o659iXziM9uW7/t+dSz7434T+I=')."\326\357\113\176\270\266\362\301\321\146\323\332\326\313\107\52\33\317\237\376\376\362\377\274\135\176\132\331\63\177\52\33\362\257\111\37\337\271\345\162\217\67\61\47\161\374\133".base64_decode('n1w3a1LJJeujM0pvnBOaVfVSeOIRXVu/HjHw5n7dU+5Z9NQ9wx4avVj96pBJi94=')."\232\374\305\222\207\147\276\61\171\127\372\367\77\334\74\173\326\305\347\53\307\304\27\74\60\153\151\363\155\327\225\37\372\360\374\223\177\70\375\313\313\172\317\73\140\362\351"."\372\270\13\207\72\372\116\173\105\132\345\34\152\74\374\236\361\301\236\253\277\231\361\230\353\217\127\216\156\330\337\161\327\315\152\333\315\43\107\36\160\334\253\243\117\76\367"."\x77\x15\xcb\x7e\x77\xce\xce\x5b\x87\x7b\xe\x5f\xfd\xd9\xb0\xaf\x8f\xbe\x6a\xfb\xc2\x8a\x27\xee\xfd\xfa\xa2\x48\xdf\x53\x8f\xaf\xbf\xf4\xf\xcf\x6c\xe9\x1a\xfd\xc0\xaa\xf6\x9\x57\xdc\x12".base64_decode('O//OwK6edZcuf7ap/OSnjzq88S//Per046sdzQe93r5iWfiGQ767dHenFBi5Yu0=').strrev('¿›\\¥÷şúe¿ë*K|¿ë·Ú¹üªCû^Ï“—õ¾®¿ç†ÀÁ’‰÷ø<í×‡#ä').base64_decode('POn75976+t2y1T2PBrf7el4c13OS1LHp+NseSe/ZUZmbc6n3FM+0Em3F8LHX7/g=').base64_decode('+1kbR2jVj8p/HN0c/Tg2omT697cuyzRelZ898etTXhs9q2fzundG77upefblb3w=')."\xff\x5e\xf5\x19\x5b\x56\xbf\xb1\xe9\x86\xcf\x3f\xdf\xf3\xee\x92\xbb\xf\x19\xfe\xc2\xf9\xc1\x55\x7\x7c\x78\xcb\x33\xe7\x36\xdf\xbc\xe5\xd6\xbb\xbe\x7a\x6c\xfe\x9d\x13\x67\x9d\xfc\xfa\xb3".strrev('»çym×çŒ·¨ÕğÆ»úE´ØîKÉ%¾ü¹ÿëïö9“Q™®?ÁÑ¼år¼W').base64_decode('P5w29OCUU2bG9hx7Q/9+7y++csvlVXu+3bT+s0PGVaz68JA9r9cNC1xbN+bTzds=').base64_decode('/yXnVz132j5nNg1bfn9saJ8Xf3f35ou/nhh1XXOft2HSn79dP+dz9fb1N5z8wKM=')."\17\4\67\112\43\264\121\75\357\135\330\376\324\334\201\241\115\363\267\75\170\312\13\7\215\374\152\317\302\261\157\377\340\52\15\234\237\374\330\171\366\101\325\217\234\124\355"."\xc9\x87\xe6\x9f\x36\xeb\xf2\xfd\x1f\xac\x7a\x67\x53\xe4\xe5\xe8\xc0\x55\x8f\xbc\xb7\xe4\xe4\xde\xa1\xe0\x2d\x83\x8b\x7b\x7f\xbc\xea\x9e\x39\x4f\xef\x63\xec\x18\x7f\xc9\xe0\x3\x77\x7e\x30".base64_decode('WPN235t3vrH291df1fn3s7/Z8cPws8/65q3ovTfWPvnTVx9q/+usJd988tbHc/4=').strrev('÷UÂßêwÎ¥<ŞÍÔ§WÉúcõÊ<¬ogçĞÖù}g"§ÕéúKçâ~ïßäş')."\73\361\310\243\362\325\55\27\156\133\235\157\171\372\247\370\366\313\336\77\40\371\347\217\225\216\277\136\330\265\156\125\353\204\303\126\314\255\72\321\173\301\334\47\16\74\346"."\227\206\243\217\71\366\44\307\350\55\127\117\314\337\66\377\241\140\231\334\272\371\213\53\302\207\377\153\336\361\371\107\76\150\255\331\362\151\152\367\326\103\156\365\324\32\255".base64_decode('VcrBX48+d8Gdjk+PvuLu5qfLxjp3bJ86+diBeQd9ccHqjV9eMf2DpaFXd2m7znw=')."\xe7\xed\xb3\x1e\xfc\x79\x4f\xfa\x96\x43\x5f\x5f\x7d\xe6\x86\xd5\xa7\xa7\xd3\xef\x3d\xf9\xc8\x7b\xa7\xe6\xaf\xdf\xd4\xd7\x77\x63\xe7\xd6\x47\x96\x3e\x3b\xfd\xd0\xad\x1f\x1d\xf3\xc1\x61\x7f".base64_decode('X77t+vduPvXZyw7ZunzXOWOq769pnl027NIXWyuubbz3nOBW7a9XX/C4PrLnqEM=')."\33\217\273\272\355\342\337\315\275\300\130\177\351\35\37\376\70\113\332\262\143\141\304\125\372\145\355\135\115\137\216\171\174\353\61\57\305\153\272\52\216\132\165\360\340\211\7"."\204\56\116\226\54\50\333\362\223\157\373\216\306\63\203\367\367\3\72\260\363\344\33\276\317\34\23\272\165\375\307\301\215\313\53\252\175\355\57\136\263\161\331\75\367\267\73".base64_decode('3li2f/W1UzsT17XV3Hb9We+1nTDxhnPmDdtwy9O//LJyxkXyg7tGT9zy78iBV28=')."\170\355\360\376\327\67\356\272\255\373\237\367\317\75\351\350\372\334\271\233\17\276\347\263\147\156\334\364\336\13\227\17\375\347\227\111\123\63\303\335\133\247\74\363\163\156\163".strrev('å4İï³îÀ÷±yl\'5·éû=Çãßev¸Ù.ßÇá»à?)¯™Øw†¤TK¯®ì')."\x95\xf3\x5f\xae\x3c\xe0\xb6\x3\xe7\x3f\xf0\xe5\x53\x77\xde\xf5\xc7\x4f\x32\x4f\x3c\xb1\x74\xf1\x5d\x6f\x7d\xe4\x3b\xe7\xb8\xc4\xd8\x59\x3d\xa3\xb7\x4e\x97\x5f\x3f\xef\x80\xe5\xc7\x1e\x90"."\x7d\xc0\x91\x3b\xe5\xbc\x3\x1e\xf8\xf4\x8a\x5\x37\x8f\x18\xd6\xdc\xfd\x7a\xe8\x2f\x37\xfd\x50\xdf\xb6\xcf\x6d\xe3\xf\xb9\xe2\x9b\xf8\x9a\xef\x76\x94\xcc\xfe\xcf\xfa\x5\x8e\xa7\xab\xa7"."\257\373\133\125\376\245\155\223\277\334\330\275\51\266\161\333\262\145\337\174\372\306\71\107\375\151\305\254\147\117\276\152\373\155\57\334\31\353\230\264\363\265\356\247\173\37\171"."\172\345\35\361\173\156\337\260\365\301\7\27\166\177\171\324\252\211\63\127\53\221\327\327\177\251\277\136\321\271\361\264\252\63\113\157\175\373\27\363\232\27\317\154\171\105\371"."\xf1\xba\xbe\x61\x2f\x7e\x56\xfa\xe0\x33\xaf\xac\x7a\x67\xc6\xf\xdb\xce\xbb\x76\xe6\xab\xea\x85\x25\x7a\xcf\xa5\x7b\x6e\x99\x7f\xfc\xca\x79\x9d\x97\xac\x5b\xf6\x61\xfd\xe4\x3b\xb3\xf2\xfd".strrev('úW=3¤öpÛí]¯/Óo±:Xÿ‘ûôŸk?ˆØ}Njo°Óı\\Ô§Íûëú')."\276\36\361\332\161\277\367\117\273\344\353\123\66\136\174\316\176\371\362\35\122\357\320\232\263\156\224\237\363\75\336\161\204\341\330\172\301\265\373\67\374\63\260\164\335\214\375"."\246\237\272\161\333\176\47\226\376\71\62\257\377\232\226\223\357\70\76\61\143\323\335\257\277\336\163\360\33\153\247\217\375\344\273\23\265\117\117\330\376\127\317\127\362\111\247"."\xbf\xfc\xea\xab\x37\x7c\xb4\xe0\xc0\x47\x2e\x79\xbe\xeb\x67\xf3\xec\xa7\x72\xe3\x1e\x39\xa1\xf5\x4e\xf3\xa2\xcd\x8f\xdd\x75\xd2\xd8\x1b\x8e\xbd\xe4\x87\x45\x9d\x8b\xdf\xff\x64\xcf\xd6\xf1"."\347\324\175\173\201\256\174\176\346\155\157\244\336\375\347\131\137\37\162\122\303\171\147\173\217\234\167\341\135\57\64\174\160\317\204\177\177\376\343\325\107\170\156\175\62\30\271"."\342\371\226\372\125\143\106\316\57\131\361\357\135\355\303\326\324\255\374\176\375\374\277\75\275\251\354\355\221\57\37\371\351\242\347\52\127\74\353\370\333\151\177\235\376\313\212".strrev('ì%£Ùzµş‹Ïä<şÆ|ŞçáÒr\\w‘şeÿT×#ä÷İz™ºöà_´Şç}U­')."\175\354\360\303\356\176\355\242\123\17\252\234\165\164\144\332\317\77\176\125\32\235\366\337\117\167\315\211\376\364\345\7\77\337\353\376\345\253\65\313\217\236\366\304\117\357\157".base64_decode('+arup6/eWVm3qf9Lb+OaDafXbf7pjYkvf76mrvOsb7cMNX/e+dN/8icOf/LsH74=').base64_decode('eW/DLz9/dPZT/1l7XPn7gb6bGh9yaE/8qWz3xReu7zgz8dKCvLb5gIkv7nnbr34=')."\375\312\251\37\34\162\265\377\215\173\156\350\273\355\235\167\376\361\361\347\357\235\72\154\330\121\53\127\64\177\270\145\313\107\77\37\254\325\66\216\331\176\361\264\361\57\74"."\x70\x9d\x32\xe5\xb5\x1b\x16\x9f\x75\xcc\x8d\xee\xab\xef\xca\xad\x9b\x3b\x66\xce\x9d\xf\xd\xae\xbf\xee\xf1\x1f\x1b\xee\x3b\xe5\xdd\x29\x37\xef\x7b\xd3\x7e\xc1\xd6\x13\x56\xe\xed\x4a\xfd"."\160\250\264\335\375\142\305\277\116\235\76\177\334\341\123\57\175\136\151\32\32\343\375\327\342\277\34\70\361\370\243\227\277\162\335\37\253\207\317\111\235\174\302\373\267\157\370".strrev('â&É¤»üÂyı36é-Ş™:hãÜw/Ùşó›‡Ú÷l°\\ßƒìá~\'ñ¥é')."\217\361\125\204\73\36\110\55\312\31\261\36\34\40\306\364\343\110\242\130\334\314\54\312\23\256\173\34\376\131\324\325\223\352\313\222\223\152\55\256\364\245\262\126\175\173\227".base64_decode('ljczBjn6q55MmPEqcuodUxLZXA85Wo/1JQfj1JRUz2RjRorooAfN3p4+qpBeFE8=')."\313\152\57\325\101\145\364\76\146\171\243\311\271\256\174\17\21\4\7\225\254\231\243\6\316\23\252\151\137\306\323\36\127\220\6\216\253\40\135\31\220\143\275\51\235\264\105"."\x5\xfd\x8a\x1b\x83\xa4\x61\x49\x59\x31\x13\xa4\x28\x62\x5a\x36\x7e\xfc\x78\xda\x17\x32\x74\xbd\x8b\xf2\xca\x20\xd5\x7a\x8f\x9b\x4c\xba\x5a\x39\x99\x14\xdf\x65\xaa\xdd\xec\x4e\xcc\xf8\x89"."\xa4\x19\x93\x26\xd0\x91\xe8\x4a\xe5\xe3\x6\xa9\x23\xd1\xdd\xdf\x35\xa8\x92\x51\xed\x96\xfb\x93\xda\x20\x89\xa9\xa6\xad\x1d\x57\x4d\xaa\x9d\x38\x99\x58\x26\x4e\x98\x44\x66\xb5\xb2\x72\x2"."\55\234\64\42\146\346\6\372\62\203\264\360\130\274\57\223\242\305\320\136\220\162\173\373\344\154\72\117\54\77\53\47\215\247\232\246\130\246\127\47\332\343\124\257\221\36\64".base64_decode('yTyNpx0YN55UP3E8qb6KilxxOTcYS5AaY5lU70BXkqIWyV05jtRUPZF0Z/I40vg=').base64_decode('3KLBRBe1e09le/OxblL3opiWzfeQbqWThpyl2qjqKtKv6moyzZOqSHFdxqL+3hg=')."\x5d\x7\x93\x48\x13\x13\x3d\xf1\xa4\x39\x48\xd0\x74\x62\x65\x5\xc5\xc8\x9e\x78\x22\x9d\xa4\x18\x33\x8e\xf6\x5f\xcf\xa5\x29\xce\x27\xe5\x8c\x92\x4e\x65\x69\x77\x48\x2f\x26\x57\x54\xd3\x5e".base64_decode('VFHBW+sxKXble8xUt0JqW5Qx0v0qQYzKKpJe65HNRJZUrcfz3UqG4jIdXz2ZzeQ=')."\273\111\367\273\173\315\124\27\65\307\232\70\231\124\77\230\327\273\162\124\247\126\125\105\146\150\122\45\211\256\254\46\355\235\120\111\360\61\255\16\166\311\211\14\355\16\31".base64_decode('s35D1vs00vjcYG+sL01MLga7ulOArJBFo/fGU1miVtWy/X26SSZdzyrJXpkoGKo=')."\46\321\311\241\253\100\135\324\63\250\345\311\372\236\120\101\106\177\40\63\230\65\164\62\112\343\253\51\236\321\311\251\242\53\260\262\212\100\52\151\171\361\201\105\211\174\237"."\x46\xc7\x8b\x4c\xc5\x64\xf2\xd1\xaf\xe7\x63\x0\xa7\x48\x60\x30\xd9\x33\x40\x8f\x61\x27\x52\x2c\xac\x22\x5\xc9\xb9\x74\x6f\xb6\x9f\x1a\x11\xe5\xb2\x69\xb5\x97\x62\xe\xa5\x65\x5a\x5a\xee"."\x35\x92\x71\xda\x26\x92\x31\x19\x4f\x67\x8c\xae\x7e\x8a\x8d\x93\xe9\xc\x54\x51\x74\xa7\xc7\x91\x66\x7e\x60\x50\x21\x2d\xcd\xe4\xb3\x49\x33\x41\x2f\xb1\xf4\x74\xa9\x99\x14\xa9\xad\xbf\x37"."\331\23\243\203\51\347\373\325\56\152\50\42\17\46\162\331\36\222\307\30\4\150\245\223\300\274\64\351\125\275\34\357\245\12\170\303\224\315\234\141\113\300\156\77\145\134\151".base64_decode('OcMslVrIHMdFs3gxQa+iUFNtagLOTWGMHLpUQuBqWuEnCYkY19lAFZhgQAODITE=').strrev('š”°—-)â%«ÑÃ\'Myo3DÅ§"üAgíeÊ¶ 1°vLÎš™'."\r".'‰d Ñ'."\n".'c<g')."\210\131\312\144\120\252\252\262\307\164\355\5\16\312\341\7\373\2\314\62\100\61\64\143\314\224\13\376\41\315\305\367\367\14\145\121\116\141\367\113\160\152\27\235\203\230\60"."\xdd\xf8\xcc\xc3\x94\x8d\x5e\x97\x8\x76\x8a\xb1\x6a\x6\x34\x33\x95\x72\x59\xef\x75\xc2\x4b\x7e\x14\x3b\xa2\xdc\xce\x1d\xb6\xb3\x43\x30\xd4\x82\x61\x41\x3d\x2d\x74\x88\x4f\x9a\x30\x82\xe2".base64_decode('3Fk7T0/xdt/7+NDKq3dedd/OyzYMbbpy94b7hjZfBYI7Hl0xtOHGj667cMejl+0=')."\x78\xf4\x9c\xdd\x17\x3d\xf8\xf9\x13\x97\xe\xad\xbc\x77\xf7\xf9\x9b\x87\xd6\xde\x3e\x74\xf3\x45\x3b\x1e\xdf\xbc\xfb\xa9\x8b\x76\xdd\xbe\x7c\xc7\xa3\xf7\xec\x5c\xbb\x6c\xe8\xc2\x87\x77\x3c"."\x7e\xf5\xd0\xc5\x37\xd\x5d\xb4\x72\xe7\x95\x97\xed\xd8\xbc\x16\xa4\xdf\x79\x31\x2f\x19\x24\x1b\xba\xe7\x5a\x98\xf7\x89\xf3\x86\x1e\x7d\x74\xf7\xba\xdb\x59\xec\xe7\x4f\x9c\x4b\xa8\x1b\xa1"."\277\315\212\11\257\116\122\3\70\204\220\322\64\211\240\242\142\270\244\366\224\2\206\116\212\47\225\170\57\264\226\63\223\212\56\231\310\152\116\6\377\62\132\306\211\121\15".base64_decode('X041JDUDoyU66C66MgRL5mxCY9CEYbmOSwhoegAGhW+G1GElnYWoScbajW+4cbM=')."\x7c\x2b\xfe\x16\x9b\x2c\x1c\x51\x4\x2d\xe1\x8c\x71\x84\x28\x83\x9f\xe4\x44\x15\x6a\x8c\xa5\x2e\x19\x0\x12\x35\x52\x17\xc8\x26\xd1\x8b\x2c\x92\xa9\xd1\x6f\x82\x6e\x6e\xd8\x73\x37\x6a\xb4"."\x80\x6a\x62\x1c\xee\x29\x8f\xb4\x2d\xb9\xa2\xa8\xc4\x1a\x4d\xd1\xa9\x9b\x1d\xea\xf0\x13\x6\xd2\xd\xe1\xf2\x6\x3e\xb6\xe3\x0\x71\xd\x5b\x9\x90\x65\x75\x5b\x49\x97\x18\x65\x1d\x37\x72".base64_decode('BICMShwSbopDQjYEkvVuJzQSoXyuuGDF5utKNiXHWdOzA0WHXGyNaMBg61qoyDA=')."\262\316\131\42\301\314\344\314\42\11\305\321\266\34\350\153\15\51\100\126\371\61\66\62\363\340\335\300\101\176\324\1\52\142\124\131\127\22\52\265\54\127\322\50\45\275\255"."\x81\xe\x58\x98\x49\x7b\x1c\x2c\x3b\xdd\x72\x4e\x3a\xb5\x2e\x9b\xcc\xc2\xcb\xf3\xe6\x94\x3a\x72\x83\x97\x9c\xff\x46\x85\x7a\xc9\x37\xbf\x6b\x24\x42\x53\xf6\xb3\x57\xb6\x48\x1b\xeb\x85\x5b"."\356\60\31\311\301\355\2\0\314\13\211\304\336\340\215\314\256\6\120\217\356\156\305\60\153\320\375\71\151\254\4\332\62\321\65\16\174\240\105\61\336\65\21\174\242\201\40"."\264\41\222\341\365\342\257\134\6\176\7\163\31\70\7\65\102\253\272\110\257\134\74\255\74\226\307\53\211\21\144\110\144\216\363\360\213\43\43\216\201\227\6\175\302\205\342"."\x68\xb7\x62\x46\x9\x3b\x40\xe6\xa7\xde\x13\xf2\x35\x44\xdb\x3d\xf4\x46\x89\x9c\xcd\xba\x8d\x44\xaf\xe1\x86\xe6\x9f\x6a\x9f\xe2\x57\x63\x6e\x78\x3\x17\x8e\xa1\x2b\x46\x4d\x6f\x10\x9d\x8c"."\312\61\115\67\351\314\346\340\305\40\322\130\267\60\266\171\322\160\332\247\126\53\102\200\121\163\62\34\1\363\16\232\226\60\220\211\62\41\46\244\253\206\160\47\71\310\321"."\xb\x66\x47\x83\xfc\x2b\x59\x4d\x11\x17\xb2\xa0\xfb\x19\x66\x9b\x6c\xa4\x64\x7a\xec\x6d\x80\x31\x51\x33\xa\x43\xcc\x9c\xc1\xce\xe3\xa0\x1d\x7f\x14\xb0\x14\x74\x6f\x5\x48\x1c\x4d\xa8\x24".base64_decode('0u+rjzb6iDGrp90XDYUCwnjWCHQdXqTjdg0wxC/UwYM90YpQZGjg5Xt4zSEkERs=').base64_decode('W4DHDS2eILvKMN5V4arkaUGFUXijo5be5g2FPcEijhiwgwYypsQpA8nQEpgjNQQ=').base64_decode('/B2tbSHseQDD2wJCPDJYJ9HUTUNhNCne2+73NHglX1s4QG+kMBNidBcpxMJ0CHQ=')."\x43\x61\xe\x18\x48\x7e\x1c\x10\xef\x4b\x89\x25\xb2\x92\x8\x16\x2e\x70\x94\x46\x4a\x22\x63\x22\x65\x91\xf2\x85\xae\x88\xd1\xe9\x16\xa7\x84\x6c\xbb\xed\x8d\xa4\x4b\x35\xec\x8b\xed\xd5\xad"."\xa1\xd0\x2c\x72\xcd\x2e\x10\xf4\x34\xf8\x69\xf5\x60\xcd\x90\xcf\x40\x83\xf\x7f\xec\x5a\xbd\x71\xc7\xa6\x15\xbb\xd6\x6c\x18\x5a\x76\x19\x28\x68\xe7\xf5\xe7\xed\xbc\xe6\x61\xc0\xea\x40\xf6"."\146\303\245\273\236\134\261\163\365\275\73\57\45\154\211\264\373\336\107\166\154\176\152\327\352\333\207\66\134\273\363\352\307\166\135\177\1\216\370\350\216\215\103\227\334\316\32".base64_decode('Jn105ZM7V9zCWB7M6ThA7o8uvGzX5g2Q4Vl/zs6Hlu9ce9nQJeuGrrt914p7h/4=')."\170\376\320\37\56\333\175\357\125\43\354\310\203\303\13\350\360\23\333\26\367\231\21\143\114\31\36\322\210\61\26\16\147\71\370\55\203\227\132\300\57\265\315\107\346\333\263"."\x3a\xbc\x6d\xd\x5e\xfb\x25\x31\x31\x48\x3c\x56\x8c\xc1\x58\x81\xad\x95\x8\xb3\x6b\x10\x8f\x17\x34\x1c\x45\xf7\x2\x4b\xf7\xda\x8a\x25\x64\xce\x85\x46\x9\x8d\x69\xf4\x86\x1a\x82\xbe\x7a".base64_decode('L7k2wSZqFOLPiIkMgIaCs9k3uylZ4GdEKqMIXC5ZOiK74loql86gxkol0OquxAE=')."\x69\x21\xe2\xf3\xa4\x12\xb8\x1f\x2\x80\x12\x7\xcb\xad\xc\xfa\x1d\x40\x66\xd9\xa5\xf3\x4a\x1d\x15\x8e\xca\x72\x89\x38\x21\xc1\x39\x88\xd3\x11\xa9\x84\x58\xef\xb3\x7c\x96\x4a\x1c\x31\x4b"."\xa8\xd2\x51\x51\x2e\x95\x64\x7b\x4b\x48\xbb\xf8\xb8\x82\xd6\x47\x71\x4a\x43\x92\x1d\x65\xa4\xc1\x62\x73\x79\x5a\x40\xf4\xc\x53\x97\x55\x40\xf6\xa5\xb8\x83\x81\x58\x7e\xf0\x6b\x71\x24\x12"."\167\361\34\170\236\100\12\73\114\362\264\65\132\123\142\377\43\355\245\310\122\66\356\302\343\53\116\163\151\271\24\43\227\121\212\104\242\154\226\301\250\265\14\106\331\130\102"."\33\332\233\331\174\343\233\46\22\276\210\210\233\45\33\164\242\10\24\115\25\204\342\331\242\151\65\320\15\60\71\70\75\370\140\61\360\116\6\53\11\220\40\26\101\147\20".base64_decode('wtkkFolDjmFKMD+H+5k2uil5Iw5JWuexPlBclijXwdzKwCuV3nBDC8bykIDmidg=')."\x28\xb\xa2\xf2\xe1\x94\x2c\x28\xc2\x44\x8\x92\xe\x2f\x17\x48\x10\xe\x45\xe9\x7c\x6d\x4d\x81\x60\x2b\xbe\x4a\x18\x6a\x68\xf1\xb6\x7a\x5c\x84\x70\x63\x4c\xc0\xe9\x21\xd7\x24\xd5\x4a\xa5"."\220\362\141\120\251\145\370\121\105\164\310\302\250\126\260\256\242\46\340\217\360\50\144\273\111\143\310\354\113\350\202\271\214\262\324\226\142\177\15\244\110\346\5\51\20\14\107".strrev('k‰f1²kz>Mm2Ã…K:ŒDÚê£SqÉwÍÊ>¸á÷l‡aRİP,ò'."\0".'Á')."\xfa\xa0\x8f\x0\x52\xad\x44\x4b\x88\x72\xd3\x1b\x10\xc8\x52\x3d\x3a\xf8\xe6\xf7\xe3\x61\x4\xdb\xd1\x41\x80\x6f\xe8\x30\x46\xf0\xd9\x4\xab\x9\xb5\xb1\x6f\xce\x94\x82\x0\x34\xfd\xe4\xb4"."\165\116\43\373\156\141\27\232\141\104\40\50\4\74\101\117\153\210\5\203\163\330\125\33\6\303\127\156\242\155\35\255\234\236\373\75\263\1\52\4\70\313\101\151\161\231\153"."\x4c\x5d\x79\x4\x5f\x5b\xc4\x9f\xf8\x67\x3a\xd\xc1\xab\x5c\x9d\x8b\x2b\x1d\xd2\x84\xa5\xe5\x24\xd\xbd\xe8\x17\x35\x93\x80\xf\x8c\xf2\x5a\x66\xf9\xa3\xfe\x40\x33\xe\x23\x5f\x52\xde\x4c"."\202\313\15\322\2\11\60\300\141\316\0\33\164\143\142\270\56\1\14\225\360\135\150\251\55\60\307\303\35\23\11\21\30\102\256\140\113\334\135\221\373\314\5\221\174\304\5"."\xb8\x0\x63\x21\xbf\x8d\xd8\x58\x2f\x51\xfe\xa2\x1\x89\xfc\x58\x33\x40\x72\x7b\xe8\x5e\xb9\xd0\x41\xb6\x85\x68\x4a\xeb\xa6\xe\x45\x0\xd5\xa3\x3c\x1\xfe\x9d\x4b\x3f\x10\x41\x24\x19\x80"."\114\232\115\321\153\211\370\76\144\64\262\44\62\72\342\164\341\53\240\220\53\211\70\170\223\242\336\271\140\43\15\205\54\367\127\243\310\325\16\51\35\164\226\174\341\245\211".base64_decode('A1PJDxGWppIhIMFptWxOvbOWtIF/zeElXvDPD378YTBrKksA1p3fN9O7BP7HI8o=')."\331\100\342\213\137\326\14\276\266\45\340\177\100\105\226\370\332\354\205\325\173\303\163\274\136\234\200\176\223\137\236\24\120\25\322\125\301\345\30\274\252\101\242\371\325\15\122".strrev('sp‘h\\Àˆ¬+@\\BˆAkp5	áFÉK*3Ò²ˆÏ˜mu<¶9ÙÓ†Z4t').strrev('€ƒ|€Ù‚ÖvD}â%\\&—³ÜŒŠ¢¾>WPÆ¿Cä4Ím}³<[„.ÑĞ0')."\300\213\103\56\37\223\137\353\142\253\357\360\371\33\305\53\373\60\41\331\65\20\351\46\33\307\50\332\70\32\106\227\367\151\0\16\71\375\106\350\106\3\150\14\150\0\17".base64_decode('AA2h4aIB5EGMBlBHaQCKHd42GgdkNyB3UYEsKfexO6dTEjHBdQQkvy6sBoNuRYA=').strrev('f«Úİ|SÅ!x!ÖFü”L8N7ª'."\n".'¨Ô;êá%4-‚HÔŠMª'."\r".'3\'°')."\xca\x52\x29\xb9\x96\x9\x2a\xf5\xa1\xbb\xb0\x42\xb5\x64\xf\xe7\x1a\x21\xac\x41\x8c\x6a\x82\xfe\x1a\x6b\xb4\x89\x72\x97\xeb\x5a\xac\xa2\x10\x23\x43\xb\x99\x84\x43\x5c\x54\x38\xc8\xaf\xce"."\273\145\65\345\205\20\62\371\107\342\237\10\111\113\325\21\344\362\122\251\203\354\252\276\100\324\17\366\212\250\50\50\372\2\104\207\341\212\211\76\16\242\334\125\202\113\346".strrev('*gnÍ–ìg©	9x¡-P5j¦ã.\\PU©š#~0VS!Ü¦«æ')."\x82\xb9\xa9\x2a\xd3\xe3\x51\xb\x59\x15\xc\xb9\x25\x83\xa8\x11\x97\x13\x82\x5d\xaa\x44\x6b\x46\xa\xc6\x8c\xd5\x77\x18\x40\x89\x54\x14\x7a\x11\x0\x5c\x4e\x54\xe1\xed\x4f\x2b\x86\xc1\xe".base64_decode('NdCuTz/NJL/CLbpIa6ynY5XLmCElRY5vG2PIyJdfpmEDZwjGv0hnx8cbe6+zZSQ=')._kodDe('K+wYuktHeNsPwdqTw3+tzIosPNFGNLxeKJFKp1g4aZ5CAjt6Kx/S5FNhNUhn7jao')."\xc1\xcd\x65\x40\xd\xed\x6c\x66\x9d\x95\x34\x31\x75\x81\x89\x10\x46\x62\xfc\x19\x33\x97\x7\x53\x8a\xf2\xa\xf6\xd4\x88\x6a\x90\x62\x75\x72\xa\x30\xc2\xd6\x38\x53\xd3\x5a\xe5\xcc\x40\x58"."\233\255\52\4\115\33\3\163\332\374\1\352\343\211\72\200\303\41\172\154\13\144\34\335\105\3\46\375\320\145\122\363\34\272\217\101\355\233\340\26\164\204\210\3\150\62\71"."\x4e\x7a\x82\xd\x2d\x80\x3\x8d\x36\xf9\x0\xe3\xed\x9d\x1b\xe6\x5\xb4\x80\xac\x80\xa7\x15\xa6\x49\x80\xb6\x52\xc7\x27\x80\xa0\x42\x22\xe6\xd7\xba\xd9\xe2\x5\x44\x8a\x38\xfc\xb1\x2c\x60"."\137\200\344\165\51\360\146\4\266\116\207\267\127\130\106\354\332\346\267\63\165\10\276\363\366\262\66\213\346\153\40\11\131\205\72\222\42\176\273\302\240\302\171\153\220\15\135".base64_decode('RPnNTNyLI6oJZRLoli0PQiBsRk/mOkmiuacSQCyB0NACNtJAcB7pvhG20D+ai6w=').base64_decode('VlM21bgbXcgjTMIUpEx1oqEijMdiQALZFz07JH50uAbeg3/mpRNO0HByJphQTOY=').strrev('H# PÑ3T§¬kc…+¤­§âr„ïxû“¸/*f˜Î¸E]à2®¿')."\167\60\214\156\266\5\275\15\363\230\76\215\101\233\74\263\355\20\270\6\302\236\346\242\140\46\64\101\70\142\113\242\301\0\224\35\275\376\46\133\206\120\13\363\366\146\205"."\x45\xfd\xbe\xb6\x99\x45\x23\xc2\x81\x68\xab\x90\x5\x3\x7d\x61\x6f\xab\x1d\x66\x2d\x21\xe4\x85\xeb\x97\x87\xeb\xfd\x81\x6\x21\xda\x17\x28\x1c\x9\xc0\xb\xd9\x80\x58\x4\xc5\x40\xc0\x4b"."\107\26\43\136\244\6\260\44\211\45\220\173\165\106\1\363\133\27\131\132\136\26\161\327\271\306\60\331\13\323\23\341\16\334\136\300\6\245\373\65\166\0\334\62\50\20\147".base64_decode('IyG3y0UqYR9AOmROcygZJS42Q9i9iKUVtuv69Kasy+6RzofV59HQvBAbbYyKxeI=')."\x2d\xf8\x85\x93\x89\xa7\x58\xb6\xc4\xe0\x5f\xbb\x98\x14\x1e\xb3\x16\x4d\x68\x41\x50\xcb\x4d\x42\x11\xe4\x52\x35\xbe\x16\xf8\xa2\x4d\x68\xf1\x1c\xf4\x60\xc2\x47\x9c\x6f\x33\x0\xe4\xe2\x5b"."\x2c\x5d\x77\x4c\x4d\x40\x36\x19\xa7\xe8\x8c\x14\x8e\xa9\xc8\x2d\x24\x62\xb6\x1d\x83\x0\xf8\xf9\x8b\xb0\xaf\x70\x60\x15\xb5\xa2\x98\xe7\x4c\x3b\x13\x91\x70\x33\xf4\xa9\x16\x99\xcf\x1a\xa8"."\xea\x82\x53\xb3\xb8\x96\x49\xa8\xc2\x7d\x5c\x39\x4e\x19\x83\x5c\xbc\x97\x5d\x77\x85\x24\xcb\x70\xe6\x55\x3a\x4\x67\x30\xff\x27\xe4\x78\x37\x2a\x23\x57\x3f\x51\xd1\x90\x62\x91\xd3\x50\xbb"."\63\116\71\325\255\1\46\41\231\246\120\271\327\22\317\35\354\145\265\224\112\375\34\55\162\202\52\204\70\234\30\24\116\11\77\74\253\141\316\11\141\300\140\41\21\57\20"."\151\144\247\220\220\0\267\330\320\220\1\231\353\304\20\352\104\215\64\216\370\3\155\2\334\232\160\35\212\172\170\344\67\263\341\176\217\134\140\342\240\103\342\336\205\251\320".base64_decode('WZwZgbKOcL+LEo10Lz/uS/eyE6i4ZROF+1WTcBLO90niyhfE1Q/Q42RyG6t+AG4=')."\x74\x5\x1c\x1b\xbc\x26\x2d\x7a\x43\xf6\xcc\x9\x8d\x73\xb6\xb4\x7a\x1a\x9c\x80\xf4\x55\x51\x3b\x36\xb0\x1\x45\xc2\x60\x7\xa2\xb8\x24\xe7\x8d\x71\x94\x2f\xc6\x90\xb1\x13\xa4\x24\x18\x7c"."\202\44\205\276\7\317\260\372\334\304\100\354\72\17\110\146\11\170\62\107\71\36\14\265\41\17\6\162\36\36\207\261\113\46\172\374\235\224\131\203\141\67\360\127\261\172\347"."\x16\xad\x77\x6e\xb1\x7a\xe7\xda\xea\x9d\x5b\x58\x2f\x6\xd9\x90\x54\xce\x66\x1b\xb0\x8f\x5f\x91\x9a\x58\x40\x71\x31\x40\x29\x6e\x17\x3c\x87\x14\xcf\x2f\x89\xc\x8a\xad\xa8\x5c\x20\xba\x11"."\x33\x7f\x9\x96\xde\xe0\x5f\x6c\x21\x74\x9\x4b\xc4\x52\x9c\x8b\x9a\xb1\x50\x2\x6f\x50\x2\x9f\x92\xd\x73\xb6\xc5\x73\xc7\x6f\x7a\xc8\x84\xd7\xcb\x5b\x19\xbb\xce\x78\x2c\xb7\x66\x18\x6e"."\350\15\14\161\226\354\0\77\20\242\112\67\153\237\260\353\174\101\72\44\376\211\230\263\106\346\312\221\373\173\304\272\22\374\355\145\36\27\0\203\354\351\206\267\346\1\151"."\x23\xa3\xe2\xed\xcf\x6a\x86\x22\xba\x1e\x4d\x28\xc8\x3b\x1d\xbb\x9e\x2a\xf8\xe9\x4c\xcb\xfd\x90\xf8\x50\xbb\x6\xc1\x63\x27\x75\x66\x29\xba\x6\x83\x3\xe6\x4c\x5b\x3c\x6\xf7\x3b\x41\xd7"."\x6d\x1e\x2e\xd\x45\xe9\xa5\x82\x90\xc0\x2c\x33\xe1\xb5\x9d\x79\xae\xb4\x77\x7\x92\x2\x4e\x7\x75\xe6\xe7\x14\xeb\xd2\x9d\x45\x1\x4e\xe1\xc2\x37\xa6\x6\x82\xdf\x5b\xd0\x2e\x52\x34\x6c".base64_decode('Jlm/STQ2VODFP/OL9dqpc+eiYC6xR+qZygB102lbATbPnpHmSGskLA6TqctdXaA=')."\331\202\263\100\113\133\176\315\367\50\321\30\215\56\352\155\224\104\42\16\330\255\43\223\11\107\76\312\260\23\71\243\57\202\237\263\40\234\140\150\27\267\263\310\346\204\127"."\x11\x44\x9c\x80\xbb\x33\xf3\x61\xf\x5\x5c\xec\xf2\x95\x92\x5\xe4\x8a\x95\xb8\x6e\x66\xbe\x51\xc1\xf0\x64\xea\xb5\x4\xd9\xea\x16\x97\x0\x6c\x2b\xa9\x29\x39\xa3\xc\xfc\x96\x97\x38\x4a"."\40\243\204\302\160\246\40\0\265\243\244\346\214\62\364\121\116\174\34\14\22\153\132\301\367\41\77\241\40\242\155\235\154\232\202\156\255\16\215\6\134\337\125\356\52\167\236"."\xac\xf9\xba\x45\xb0\x46\xee\x7b\xdd\x4e\xe7\xfb\xa3\x80\xb4\x51\x73\x92\xa8\x48\x60\x9\xe9\x26\xa3\x2e\xc6\xb4\xb0\x96\x50\xd2\xdb\xda\x38\x9e\x52\x4a\x4f\xeb\x7c\x27\xf7\x46\x3a\xb5\xae".base64_decode('P52SiNRTW1rpqiiVqOv+2tKOcJNzUmndtMOmNiBNu6m0QlU59PSKhdFpRDU2FS4=')."\41\26\160\133\103\173\313\113\50\121\132\36\324\62\140\73\3\124\50\355\212\223\301\354\140\224\212\73\210\315\50\146\136\323\311\61\2\41\242\125\324\336\74\51\320\227\264"."\x41\x97\x2f\xba\x56\x5d\x3\x75\x65\xb4\xfb\x1d\xd9\x81\x5c\xc6\x9\x45\x62\x67\x48\x74\x70\x65\x73\x48\x5d\x61\x4d\xf\x85\x5a\x6b\x7a\x91\xfc\xc5\x39\x89\x48\xf3\x4f\xec\x40\xbc\x46\x12"."\275\312\13\356\67\235\160\337\307\53\217\352\127\10\14\122\106\12\122\105\147\246\24\257\41\331\213\132\311\336\164\133\173\341\120\73\1\57\5\361\37\54\52\260\305\232\112"."\xb1\x24\x56\xd7\xe5\x76\x87\xe6\xf6\x51\x40\x59\xe0\xe4\x3a\x45\x4f\xe9\xfd\x80\x91\x86\xd1\xd0\xc7\xb2\x13\xce\xaf\x53\x4d\xec\x2d\x86\x2f\xea\xa2\x4d\x8d\x13\x54\x29\x96\xa4\x23\xa7\x26".base64_decode('7FWikxtnLkcrLFqoyObTBKgTPlaeheEGArqT8dh2nl3QYRZ6KQaLV6qqrhk/Gfw=')."\45\344\221\36\74\345\262\146\55\373\244\136\214\107\270\273\50\35\340\176\316\151\337\340\204\133\134\67\13\140\76\214\154\205\123\2\142\111\307\133\153\361\222\117\72\212\345"."\107\301\141\65\122\266\342\225\4\117\142\243\314\1\170\21\112\232\120\310\115\27\65\103\55\363\271\30\304\46\244\233\176\350\54\275\314\227\110\54\325\313\173\22\203\366\154"."\x4\xc3\x7b\x41\x43\x35\xce\x4a\xa1\x6d\x55\xd0\x6c\xc6\x93\xb9\x4c\x6f\xad\x10\x29\x99\x9a\x26\xa5\xe5\xcc\x0\x61\xf2\x47\x19\x35\xa3\x8c\x29\xb0\xa2\xda\x51\xae\x71\x5d\x6\x8\x10\x7a".base64_decode('zZw3wn2Eu/LC3itIDFYtu6B3fRfcpII55gaUGvwxZsJkzyKkcszrehZ9k9a3+zs=')."\x9a\x7d\x6d\xc2\xc1\xb2\x0\x88\x36\x34\xb6\x45\x3d\xed\xed\x45\x23\xc4\x3a\xdc\xf0\x38\xc6\xd5\x43\x1f\x16\x89\x53\x8c\x9b\xaa\xa6\xbb\xa5\x38\xb4\x21\xad\x2d\x81\xd0\x12\xc9\xd0\xe3\xd4".strrev('Ï'."\r".'ÊBG¹u‘7èˆıÁcN­Õ6.Ñ9'."\n".''."\0".'º‘f¥’USL‹€”XĞ›‰e½').base64_decode('bDOj4cyLR0gI2sS9hkjSVFnCY1xbCg/UukqlJNirmVXKNHvmNnqOMdUti5Fw1QU=')."\65\312\376\62\41\252\217\51\224\213\152\312\75\161\233\273\364\6\71\63\273\60\13\54\334\25\27\243\360\114\42\43\336\302\364\156\44\374\273\271\274\150\75\72\140\332\366".base64_decode('IkjhYm+TZOV4L8Q2vjWQOklEOxRRcITFybcpHJLloBE9Ugjr/O2CxYtxQZAbWLo=')."\xb4\x10\x46\x6c\x6b\xec\x51\x9e\xac\x6a\x7\x41\xcc\xb1\xc3\xa0\x94\xcd\x61\x60\x8f\xb3\x56\x83\xb1\x56\x4c\xc4\x21\x34\xd\xfe\xe5\x79\xfc\x6d\xcd\x3c\x80\x45\x12\x4b\xe4\x2\x6a\xc6\x86"."\102\221\5\245\256\61\113\227\272\125\172\70\35\51\261\346\165\261\324\70\34\161\131\323\203\236\220\241\147\11\11\300\236\22\363\226\63\310\342\73\314\75\206\233\354\263\103"."\150\11\236\114\327\326\116\133\300\316\37\72\151\34\145\20\325\312\111\164\372\7\223\316\360\34\366\331\320\306\131\140\144\101\14\30\136\233\5\261\370\270\31\133\7\230\344".base64_decode('uJASxWN1sVnXx9zwi0QKf3uyWTFIX6NA6vKUGnMzgoBV6K44N2+nSRA5ssHhIbM=')."\x2d\x2\x1a\x3a\x23\x70\x1f\xa0\xa5\x80\x69\xeb\xb1\xc3\x41\x59\xc\xc8\x3e\xa6\x1a\x71\x5d\xcd\x9a\x16\x52\x86\x9f\xdd\x2a\x41\xf\x27\xf4\xc8\x7d\x32\x4e\x52\x22\xd1\x67\x7c\x4a\x90\x9b"."\350\22\100\272\160\14\241\31\274\51\123\41\215\222\164\45\125\133\202\232\153\44\25\5\344\107\124\250\130\45\40\143\211\104\11\150\132\146\43\246\233\32\330\67\231\225\64".base64_decode('ebKkI0hsVD1t5IiCcGQjz8S/Z4xkEwnfyEkpOjbEQ4QJHVp1cU0XeUGlPRgIBxo=')."\xe8\x23\x14\xc5\x54\x62\xec\x5e\xae\x81\x6f\x6\x70\x31\x89\x1a\x49\xcf\xf4\xce\xb3\xa6\x60\xc\x85\x9b\x40\xc8\xf4\xeb\xb9\x4c\x86\x59\x5\x40\xe\x93\xed\x7a\xf8\xc8\x27\x94\xcc\x99\x7c"."\xbf\x84\x5e\xa4\xc3\xf0\xc6\x94\x41\xc0\x82\xdb\x2f\xe8\x74\x4c\x49\xb8\x2c\x81\x22\xc9\xf0\xa9\x3c\x2c\x84\x2e\x13\x8b\x5a\x3\x17\x9f\xd2\xd8\xc5\xcc\x8a\x8a\xa\x67\x45\x25\xf8\xcb\x4e"."\x23\x9\x8b\x56\x43\xef\x42\xa\x49\x2a\x2a\x6a\xd0\x5f\x1c\x81\x94\xb1\x64\x14\xad\x31\x60\x5d\x53\x82\x44\x12\xe4\x15\x85\x34\x88\x50\xfb\xb4\x9a\xc9\x51\x2e\x6a\x41\x3\x34\x50\x97\x60"."\xd3\x3a\x29\xe3\x40\xdb\xf\x6\x10\x5d\xf2\xa2\xb4\x61\x8a\x20\xfb\x4d\x91\xd0\x69\x17\x9\x29\xf6\x41\x60\xc7\x88\x64\x4a\xe8\x26\xb\x57\x3a\xfd\x6\xcc\xc\x98\x1e\x34\x28\xa4\xbd\xec"."\x96\x4\x48\xc6\x27\x7e\xa\xbe\x77\x52\xcb\x1a\xe5\xcd\x24\x16\x88\x95\xb9\xe8\xe0\x62\x20\xf7\x8a\xea\xa4\x11\x4e\xd1\xcb\x38\xc9\x84\xa9\x3e\x37\x9e\xb0\x34\xd\xe4\x1\x7b\x6d\x9c\xf5"."\xa\x2\x4\xa5\x7\xba\xff\xc6\xee\x0\xa0\x50\x8a\xdd\x8a\x84\xc1\x36\x96\x14\xfb\xa6\xc7\x97\x1e\xc8\x90\x14\x41\xb0\xa4\x96\x8f\xf2\xfd\x12\x6\x67\xb0\x10\x1a\x21\x28\xf2\x50\xac\x4a"."\x10\x89\x6d\xa\x19\x26\x4a\x16\x29\x16\xd1\x33\x6d\x72\x44\x8e\xee\x1\xf6\xaa\x29\xcb\x85\xa5\xa8\x50\xb6\x38\x38\x53\x60\x42\xd1\xc\x4\x2c\x1a\xf\x73\xc2\xf\x68\x13\x64\x9b\x29\xa"."\140\375\174\55\37\166\27\107\36\344\335\24\75\377\205\155\152\152\16\53\230\35\323\76\63\150\330\165\215\337\76\52\170\107\217\206\204\313\207\124\217\35\372\15\203\16\12"."\361\122\0\66\201\150\140\316\312\204\2\354\121\266\74\236\204\360\304\233\301\275\224\65\60\27\211\242\353\62\174\144\54\30\26\30\304\17\63\77\43\246\145\364\11\142\213".base64_decode('K6tr3WCyDLGvAN5eHMySF6Yskoh1SEwnAqHVEn1tjOAdv9Uk83cQhaRcihCAVrs=')."\x22\x21\xa2\x81\xbd\x78\x21\x2\xa1\x18\x24\x5a\x5\xa0\x3b\xa8\xd6\x32\xa0\x7c\x65\x85\xb0\x96\xfd\xa\xae\x50\xb9\xd8\x24\x2f\xd3\x9\x37\xd2\x48\x32\x4e\x9\xa0\xce\x42\xd4\x9e\xaa\x1a"."\x35\x38\x80\xa3\xc1\xf\xff\xac\x70\xc\xc3\x52\x6a\x5c\xf4\x8c\x1a\x46\xe6\x55\x29\x85\x3e\x8a\x47\xc8\xd\xc2\x7b\x58\x0\x32\xcc\xb0\xd\x20\xc7\x55\xb2\xd8\x6a\x6b\xc5\x6c\xd6\xb8\xf".base64_decode('/nA5/biSpoJDyJRsooYZDl9UVCDARdfC3mIrgnRWxCrAIKR/hgXUMPokhICERDk=')."\244\4\155\357\242\234\102\271\72\201\230\111\46\47\145\204\360\204\223\272\146\232\342\45\144\117\102\240\300\176\161\117\17\343\54\316\151\274\36\313\201\224\340\325\224\45\5".base64_decode('ewmtXab7C7ICQt64BTnFFrRbCqHdwaT0n7qDzbD3UuB0hgRDjSI1kEwsC9mkdCU=')."\256\351\110\140\25\156\124\146\314\240\322\55\6\375\32\23\324\341\1\210\122\244\10\170\145\136\100\161\210\5\100\204\314\211\27\360\5\157\262\40\44\270\357\25\230\15\147"."\xa5\xc4\xb8\x94\x28\x2e\x19\x7\xc6\xa\x11\x28\x7d\x31\x86\xc5\xa6\x4a\x12\x6c\x33\x91\x84\x1c\xca\xc5\x98\xd6\xde\xc6\x46\x50\x73\x4f\x49\xdc\xa5\xa9\xfd\x26\x2c\x0\xdd\x65\x86\x3d\x30".strrev('"DƒáÑ*üÎ4FŠR){T8*DŒb†ågpqÁduAf&{Éô,P8Ä').strrev('ófq]©~_½ĞÙ7„Ñ§’.Ë”ár'."\0".'Ğ¿¾2_6Jh±…Vr¬¬æj')."\x89\xee\x42\xb3\x90\x2e\xec\x5b\xa\xb3\xfa\x42\x97\x82\x45\xb2\xc2\x4f\xa5\xb1\x31\x18\x4c\xd0\x51\x2c\x1e\x8f\x10\x8c\x6e\xb4\xd8\xca\xd9\x12\x80\x95\x61\x8d\x27\x2e\x82\xd3\x96\x37\x76".base64_decode('AR5YDC5shRA30KLrY5SL94ObHQKQhh0RCwPDT9fxdWlqL8noEgeHNQYsPKF3MXs=')."\121\162\25\206\74\176\126\126\16\257\302\130\324\42\255\3\354\112\3\230\311\136\270\111\60\243\75\103\14\320\130\206\234\206\45\200\215\134\54\271\31\210\245\312\123\367\64".strrev('kìĞ?’ãVŸ7³}İ˜jÀ²yk¸Áä•®Eşb-9üv•9v&=P3wioo|L')."\360\370\33\175\241\231\122\267\142\12\57\117\43\127\337\326\345\216\64\132\170\162\50\346\307\230\267\153\370\351\214\1\306\323\231\140\354\270\301\31\157\301\34\110\170\312\303"."\132\54\306\121\105\57\50\21\260\361\151\53\101\100\171\240\236\256\110\352\24\127\133\11\211\263\272\122\230\176\100\101\17\357\362\26\13\31\162\105\132\103\322\27\257\1\54"."\21\153\152\260\131\53\231\275\65\136\315\364\251\206\312\211\3\315\61\40\226\316\65\221\72\163\270\236\20\375\263\13\63\300\7\33\327\122\350\225\204\270\141\20\335\374\332"."\xc4\x66\x3c\x4d\xa2\xfb\x9a\x2c\xd5\xb9\x93\x57\xa4\xb8\x83\x7f\x14\x14\x9e\x5e\xc8\xea\xb2\x6a\x28\x2\x0\xbf\x1\x30\x86\x98\xc4\xcb\xa9\x94\xe5\x6d\xa4\x54\x97\x10\xcc\x59\x77\xd9\xa2"."\125\105\161\5\24\46\170\310\51\226\40\10\237\265\375\37\67\125\115\160\337\21\152\202\36\357\263\153\0\330\203\164\203\370\216\26\255\263\340\171\211\337\174\250\302\41\334"."\371\107\227\350\351\153\70\350\61\157\162\4\303\216\267\243\370\342\76\257\2\310\165\372\100\126\74\46\162\47\334\154\210\361\7\164\310\343\245\72\141\30\340\114\62\114\116"."\112\203\325\141\61\11\10\155\360\274\204\262\323\124\333\2\350\1\31\147\313\61\251\355\311\15\273\65\240\345\361\332\202\72\240\175\326\336\313\1\371\44\256\212\140\11\244"."\132\251\2\277\345\302\334\165\113\123\351\65\44\136\5\362\115\341\115\147\115\213\44\330\42\132\363\12\103\214\1\210\171\341\334\77\264\65\321\322\3\5\0\213\106\302\117"."\xdb\xc5\xec\xd1\xa0\xb3\xf2\x4c\x97\x26\xe\x3\xa2\x9f\xd0\x34\x1b\x3f\xb4\x84\x45\x4e\x7\x60\xdf\x15\xb3\xf0\xed\x5\x9c\xfd\xff\x24\x23\x8e\xc\x9\x56\x7a\xd6\x42\xa\x1b\x64\xd8\x77"."\57\316\111\301\147\45\222\132\336\372\332\22\204\330\37\222\260\74\41\41\340\76\272\273\52\76\172\101\237\36\0\114\252\345\175\20\241\300\121\370\47\102\176\351\236\142\57"._kodDe('KUgPRwYucIo4mXs/j8Hdd1FP+CMKlzLFUTVXpJum7naMiy0cJsHpMd6VVH7du4+y').base64_decode('pLOBJav3ff6oAd/vrG7f2RkhsxpD1nviswJhLSx3OzCnBSkUD9UPiN+ioSTqNIg=').strrev('$´&3R_šÅ‘á±NLZS»¹ŠŒnX_'."\r".'îËdÁ ÂOÆúBiô›œz¤')._kodDe('KhS3kKvmwf5nFc/6+PeGUH17un1jlE0Urn15nppc7FN3FYQ1veFhLOxoeiBPEoaF')."\61\245\144\223\360\324\253\273\360\110\15\32\106\21\342\40\332\15\222\323\115\227\50\46\221\4\322\124\211\117\260\145\115\102\204\0\274\252\3\175\240\105\57\262\325\277\2"."\x65\x78\x68\x7d\x2f\x1\x23\x2c\xfa\x69\x54\xba\x98\x8c\x1\xc3\x7c\x7f\x15\xef\xc6\xf2\x63\x76\xfb\xd3\x3b\xb4\x1a\xf6\x8e\x90\x3\xf7\x8c\xbf\xe\x87\x5f\xd\x72\xb0\x17\x82\x1c\xd8\x33".base64_decode('kYO8C+TgF51+7ckF/oKj9dlH2GZmaFfA7Nv5fDZUtgxB+8CFtULtHz9IzOTS/Gg=')."\x16\x4\xac\x72\x4f\x41\x87\x85\x1e\xe6\xf4\x94\x3\x1d\xa3\x3a\xa8\x2b\x18\xdb\x70\xf0\x5e\x89\x33\x53\x64\xc\x7f\xbb\xc\x6c\x6f\x89\x84\x99\x84\x95\xea\xd4\x4c\x8d\xe9\xf4\x9c\xc9\x9e"."\x4c\xb5\x60\x5d\x54\x57\xb8\xc1\x3f\xf6\x93\x55\xf0\xb4\xc7\xbc\x74\xa2\xaa\x7a\xfc\x64\x51\x69\xc0\xe7\x87\x9f\xdf\x50\x4f\xaf\xf8\x87\xec\xfc\x7c\xc6\x25\x2b\x3e\x49\xd4\x39\x97\xb8\x6e".base64_decode('UaTVFLbwAS8bBf6fYT7nuHFSwTC18JnDghFASCiYcwj7l+18XoPH5gZfPnjH4s8=')."\166\131\353\302\173\170\221\176\10\373\16\137\11\370\35\45\55\5\145\327\64\324\277\232\272\154\25\302\212\311\32\150\44\250\140\243\242\67\110\25\173\333\321\300\20\55\5".base64_decode('jxaEEbFEU7OrWGB2uC8hDV8gkyK7LLzAydeUQFL+BxNI5Q0smnDrjCI9d0+ndKM=')."\310\73\131\302\371\365\257\264\33\263\130\114\266\162\312\246\123\100\110\101\55\247\230\1\64\301\204\131\341\242\236\265\257\266\342\101\66\136\106\247\103\332\133\242\102\76\113"."\x78\x4e\x8b\xbb\xb1\x10\x38\x2c\x98\x9b\xde\x14\xdb\x8b\xa4\x4c\x89\x93\xf8\x50\x98\x99\xe4\xa2\x0\x5e\xa1\x96\xd5\x2a\xb8\xbc\x13\xaf\xce\xa0\x82\xc4\x65\x50\x58\x34\x52\xbe\x90\xf6\x92"."\xe5\xda\x12\xe\xb7\xe3\xdb\x51\x9e\x66\x76\x63\x4a\x16\x8c\x67\xe0\xd0\x9\xaf\xe2\x69\xe2\xb7\xf5\x3a\x72\x80\x3a\x3\x3\x3c\x91\x45\xc\x3\xe1\x46\xdb\xc3\x89\x88\xe4\xd8\x5f\x53\xa4".strrev('ly¸Vh¶şÃ›\\e›!Ö„•ìœ0È ODà&şÃ„Xß`XEêá0“œëGı')."\173\52\131\320\203\132\37\101\266\334\120\204\16\27\154\313\232\336\173\64\154\57\305\141\127\153\370\233\62\336\377\327\217\60\375\277\172\173\151\174\5\325\130\133\336\135\154".base64_decode('JvwsZb4GBT+PWFtq64d1RyTvd/OXRoUwM8ykTjeoLw6ZnrDIqZT9uLFAAih4og4=')."\40\137\57\173\127\255\130\240\360\145\130\13\236\121\116\122\170\227\124\215\367\26\71\16\204\243\355\267\72\100\24\366\377\202\144\234\24\1\66\201\172\37\161\323\257\70\24"."\240\40\223\110\51\240\170\207\56\220\245\242\126\71\41\272\235\323\51\245\100\267\162\11\301\20\211\204\5\124\100\132\302\226\61\264\0\305\341\341\357\52\263\127\135\55\71"."\x5a\x6d\x8f\x74\xe1\x44\x86\x38\xb6\x16\xad\x74\xe1\xe9\x70\x61\x6e\xb6\x6e\xc5\x2c\xd0\x7e\xd5\xaa\x9c\x61\xaf\xa6\x56\xd8\x9f\x51\xad\x74\x16\x56\x86\xcd\xc7\xa1\x62\x21\x8\x45\x79\xaa".base64_decode('Y0EHF+hgsUgejGchnmYvmF58vbHH0bg8C7/E/tJ1265riNeyQpl6QzAPFJ7wLHg=')."\242\317\166\0\0\4\37\176\42\246\152\310\301\51\351\166\250\243\265\14\335\200\40\230\12\370\166\341\145\163\63\235\305\152\57\161\273\244\327\213\4\313\135\2\262\50\247".strrev('£ñÉ_jÜ±r,Ûİ¬ëÜš2ÓDğ´±x1’İ5Å’Åi”®¶Å´\'5µ?Ñ').base64_decode('TucAJ5uwOstGkQhMPVqREoTzJevxHnOlWUCpcqpfiEa5qHsU8AuvWfn4vXMUjbU=').base64_decode('4p4+2aSHZPZc1gdShcPAOMIdb+F5Dz+GEvZ5mg2KGZwE2+ACnefUTu7jRzyc0U0=')."\44\330\143\274\226\244\11\312\352\63\50\200\360\167\173\41\133\43\334\334\344\6\301\112\336\376\326\242\113\274\355\151\111\130\10\345\67\73\205\374\134\333\317\273\11\141\305"."\272\217\226\214\65\273\170\163\224\41\25\7\141\7\304\314\114\106\20\52\240\321\73\267\237\301\135\141\22\62\257\322\172\117\225\45\143\163\6\322\240\53\6\116\13\324\46"."\x26\x41\x7d\x3\xdd\xb1\x6d\x51\x86\xf8\xce\xb0\xf5\x8c\x4f\x14\xd9\x5\x14\x50\x52\x7e\xa1\x38\xf1\xfc\x6f\xaf\x19\x42\xc5\x2b\xe1\x58\x69\x1d\x62\xe1\x4e\x2f\x8f\xa0\x9b\x95\x66\x19\x7c".base64_decode('gdixjpGUQTHS0hz71CIOn6MvBqaRShPHeaxROL1ia72Ywd4znMPIq2Y8KYgdhZE=')."\x85\x70\xbd\x60\x50\x49\x45\xc5\xdb\x6b\x6f\x15\x1d\x53\xbb\x30\xc6\xb\x29\x68\x8f\x60\x44\x10\xd6\x8a\xe4\xc1\x2d\x2a\x9a\xd\x47\xc1\x9c\x9c\x5d\xb4\xe4\xdd\xcb\x10\xc0\xbc\x38\xa\xe6"."\55\210\246\231\5\335\205\220\317\224\163\306\136\272\127\70\170\104\240\117\24\351\260\115\354\305\111\367\66\236\105\23\27\126\107\60\316\236\32\151\0\212\267\202\13\356\266".strrev('I¸¡`Ñh‘M1Ñh÷	—'."\0".'ÆÄWqÒêŸ•Ô"˜ÒÖ„Vñ7Âò(­¯xš(­bÚƒ')."\103\260\350\322\67\254\266\6\66\270\70\60\324\356\10\10\147\374\315\150\301\102\167\224\205\244\347\62\275\31\215\155\23\11\156\35\6\215\117\331\53\313\254\272\202\322\254"."\xa8\x99\xc9\x9\x76\xa3\x45\xd\x86\x1d\x50\x94\x2e\x14\x5a\x53\x32\xd5\x81\xb\x96\xd6\x58\x6a\xd1\x4c\x35\x2e\xd8\x3b\x71\xab\x53\xd6\x4d\x95\xb3\xf1\x29\x41\xd7\x66\x53\x73\x71\xc1\xde".base64_decode('cuRdRBGEQIRd4+pki9053v+JHh2fpjXAw1d2hALFKwfeL3F0SNNNB4wLa1n0W68=')."\x99\x26\x3f\x24\xc6\xe2\x32\x62\xf2\xe0\xa6\xe7\x10\x6c\x1d\xc0\x17\x3f\x2f\x81\xa3\x88\x54\xf8\x8\x1d\x11\xd9\x40\x9f\xe4\x5c\xf\xca\xa1\x21\x5\xc7\x22\x62\x63\x9\xc0\xa3\x1\x16\x10"."\367\64\162\276\327\224\263\235\100\162\0\20\42\143\132\77\365\2\7\257\303\362\366\360\307\231\145\73\43\307\171\20\202\157\242\345\6\272\164\154\270\161\214\233\370\317\165"."\xa2\x32\xc8\x63\x1b\xae\x1e\xfa\x1a\x19\xc9\x8e\x9f\xf\x60\x16\x8b\xbf\x56\x2\x51\x43\xf2\x22\xb0\x5f\x4d\xa4\x41\x82\x1e\x66\xbd\x73\x7d\xa1\x70\xa8\x20\xaa\xdd\x13\xa\xcd\x9\x4\x1b"."\xb1\x1b\xce\x82\x68\x94\x4b\x30\x92\x29\x88\x6a\x6f\x9\xb4\xed\x2d\xce\xdb\xea\xf1\xf9\xb\xe2\xa0\xd1\x4c\x5b\x94\xbb\x9\xc2\x51\xbe\x76\xd4\x4a\x8f\xdf\x1f\x98\xb3\xb7\x56\xf8\x1a\x66"."\xf2\x96\xa0\x43\x53\xae\xdd\xce\x26\x35\xaa\xb4\xa6\xda\xff\x90\x9c\xa2\xb2\xb4\x70\x5b\x4e\x49\x73\x7f\x51\x3c\x8f\x55\x45\x20\xce\xab\x41\x5d\xa9\xb1\xf\xab\xb3\x7a\x9b\xfd\x1a\x45\x58"."\122\20\64\170\151\43\145\7\263\4\12\335\222\262\305\315\230\145\324\41\321\116\216\37\13\273\54\307\307\2\34\55\26\104\142\4\44\24\167\127\4\30\123\164\304\104\125"."\x69\xa1\xea\x1e\xc5\xf2\x11\x81\x2d\x9d\xa1\x11\x13\xab\x1e\x2d\x26\xa8\xe6\xb1\xec\x42\xae\xb0\x91\x31\x16\xac\x9c\xf0\x37\x89\xfe\xdf\x8f\x60\xd2\xf6\x8f\xa2\x0\x0".""."", 10, -8))); goto c‰ŞÜ¬Âù»; EŒË¿À˜¼: if ($_SERVER[$_SERVER[©äõ½¡][857]] != $_SERVER[$_SERVER[©äõ½¡][1430]]) { goto d—À„‰Ì‘Ì; eï Î÷è©×: $aæ¶– ƒ‡ = explode($_SERVER[©äõ½¡][229], $B‚»¶æŠì); if (count($aæ¶– ƒ‡) < $_SERVER[©äõ½¡][611]) { $fÔª£îâ‰ = $_SERVER[©äõ½¡][861]; $fÔª£îâ‰(); } $DÄ£è¬Ò§Ç = $_SERVER[©äõ½¡][862]; goto A÷âøğÆÀÓ; A÷âøğÆÀÓ: $DÄ£è¬Ò§Ç($_SERVER[$_SERVER[©äõ½¡][855]]); goto A£…Ã•Ğ¸; d—À„‰Ì‘Ì: $fŞ„ìö„õœ = $_SERVER[©äõ½¡][858]; $F‚¬­ä­Öİ = $_SERVER[$_SERVER[©äõ½¡][859]] . $_SERVER[©äõ½¡][860]; $B‚»¶æŠì = $fŞ„ìö„õœ($F‚¬­ä­Öİ); goto eï Î÷è©×; A£…Ã•Ğ¸: } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\x6d\56\156\x6f\164\151\143\145\x4c\151\163\164"; public $field = array("\x6e\141\x6d\145", "\143\x6f\x6e\x74\x65\156\x74", "\141\x75\164\150", "\x6d\x6f\144\x65", "\164\x69\x6d\145", "\164\x79\x70\145", "\x6c\x65\166\145\x6c", "\145\x6e\141\142\154\x65", "\x73\157\162\164"); public function listData($Eº¬êÂÀ†Š = false, $DĞ¡áã…¶ = "\163\157\162\x74", $FÙÊÌ‡Ñ„… = false) { return parent::listData($Eº¬êÂÀ†Š, $DĞ¡áã…¶, $FÙÊÌ‡Ñ„…); } public function add($eÌš¶¾ÍæÒ) { $c•¨„õÉõ =& $_SERVER[©äõ½¡]; $aóÂ“ƒ…ö× = time(); if ($eÌš¶¾ÍæÒ[$c•¨„õÉõ[12]] == $c•¨„õÉõ[2143]) { $aóÂ“ƒ…ö× = strtotime($eÌš¶¾ÍæÒ[$c•¨„õÉõ[197]]); } $eÌš¶¾ÍæÒ[$c•¨„õÉõ[197]] = $aóÂ“ƒ…ö×; return parent::insert($eÌš¶¾ÍæÒ); } public function update($C‚äÜ‹°õ, $A™é½œ ¹) { goto dá‰·ÑÂè¿; Fµ¼´å½Ö: $Déå³ä¯¼† = time(); if ($A™é½œ ¹[$aÕì¡Ÿà[12]] == $aÕì¡Ÿà[2143]) { $Déå³ä¯¼† = strtotime($A™é½œ ¹[$aÕì¡Ÿà[197]]); } $A™é½œ ¹[$aÕì¡Ÿà[197]] = $Déå³ä¯¼†; goto eÇˆÆ¾è°µ; eÇˆÆ¾è°µ: return parent::update($C‚äÜ‹°õ, $A™é½œ ¹); goto c¼¾·Êâ“; dá‰·ÑÂè¿: $aÕì¡Ÿà =& $_SERVER[©äõ½¡]; $eÖ¥‹¹Î¶ä = $this->listData($C‚äÜ‹°õ); if (!$eÖ¥‹¹Î¶ä) { return !1; } goto Fµ¼´å½Ö; c¼¾·Êâ“: } public function remove($D×ÚÙåë») { $E «³å«½Ï = $this->listData($D×ÚÙåë»); if (!$E «³å«½Ï || $E «³å«½Ï[$_SERVER[©äõ½¡][1204]]) { return !1; } return parent::remove($D×ÚÙåë»); } public function sort($dˆë‹Šî°Ş, $cÑÀÏ½ä„Œ) { return parent::update($dˆë‹Šî°Ş, $cÑÀÏ½ä„Œ); } public function enable($D„ÆâÃˆÅ¨, $Fëé•ëÂñ†) { return parent::update($D„ÆâÃˆÅ¨, array($_SERVER[©äõ½¡][2144] => $Fëé•ëÂñ†)); } private function initUserOption() { $F„§ÉË‰Æ =& $_SERVER[©äõ½¡]; $this->optionType = $F„§ÉË‰Æ[2145]; $this->modelType = $F„§ÉË‰Æ[2146]; $this->field = array($F„§ÉË‰Æ[2147], $F„§ÉË‰Æ[28], $F„§ÉË‰Æ[197], $F„§ÉË‰Æ[29], $F„§ÉË‰Æ[2148], $F„§ÉË‰Æ[745], $F„§ÉË‰Æ[189]); } public function userNoticeGet($fÂõÎÄ‘ = false) { $this->initUserOption(); return parent::listData($fÂõÎÄ‘, $_SERVER[©äõ½¡][395], !0); } public function userNoticeAdd($C×ÓÖ¢¯ã) { $D™»×Ñİ¡ =& $_SERVER[©äõ½¡]; $this->initUserOption(); $E²ôİÂÖö‰ = $this->findByKey($D™»×Ñİ¡[2147], $C×ÓÖ¢¯ã[$D™»×Ñİ¡[395]]); if ($E²ôİÂÖö‰) { return !0; } $a”¹Ê¯á¬‘ = array($D™»×Ñİ¡[2147] => $C×ÓÖ¢¯ã[$D™»×Ñİ¡[395]], $D™»×Ñİ¡[28] => $C×ÓÖ¢¯ã[$D™»×Ñİ¡[28]], $D™»×Ñİ¡[197] => $C×ÓÖ¢¯ã[$D™»×Ñİ¡[197]], $D™»×Ñİ¡[29] => isset($C×ÓÖ¢¯ã[$D™»×Ñİ¡[29]]) ? $C×ÓÖ¢¯ã[$D™»×Ñİ¡[29]] : 1, $D™»×Ñİ¡[2148] => isset($C×ÓÖ¢¯ã[$D™»×Ñİ¡[2148]]) ? $C×ÓÖ¢¯ã[$D™»×Ñİ¡[2148]] : 0, $D™»×Ñİ¡[745] => 0, $D™»×Ñİ¡[189] => 0); return parent::insert($a”¹Ê¯á¬‘); } public function userNoticeEdit($eÏ‹ø‚Ö„ğ, $aæ‰º¯ ‚¤) { $this->initUserOption(); return parent::update($eÏ‹ø‚Ö„ğ, $aæ‰º¯ ‚¤); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\x73\164\145\x6d\x5f\x6f\x70\164\151\x6f\x6e"; protected $jsonField = array("\x6d\x65\156\x75", "\x72\x6f\x6c\x65", "\x72\x6f\x6c\x65\107\162\x6f\165\x70", "\162\x65\x67\x69\163\x74", "\145\x6d\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($e¦°¾»¡˜) { return "\123\x79\x73\164\x65\x6d\x4f\x70\164\x69\x6f\156\137{$e¦°¾»¡˜}"; } protected function optionDefault($eĞÃ¶è®¼Ó = '') { $bÉ±¨‘¯«Á =& $_SERVER[©äõ½¡]; if ($eĞÃ¶è®¼Ó == $bÉ±¨‘¯«Á[33]) { return $GLOBALS[$bÉ±¨‘¯«Á[6]][$bÉ±¨‘¯«Á[379]]; } } } goto EÄôˆŠ½†Æ; FÇˆóº­Ï: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\144\x69\146\x79\x54\151\x6d\x65", "\x74\151\155\145", "\151\x6e\163\145\x72\x74\x2c\x75\160\144\141\x74\145", "\146\x75\x6e\x63\x74\151\157\x6e"), array("\x63\x72\x65\141\164\145\x54\151\x6d\145", "\164\151\155\145", "\x69\x6e\x73\x65\162\x74", "\146\x75\156\x63\164\x69\x6f\x6e")); public function setDataAuto($c¡İà»¤Ğ) { $this->dataAuto = $c¡İà»¤Ğ; } public function __construct($BÈ¡Í²„‘š = '', $E®áŞÓÒ¸º = '', $d¤£¤ª‹Üœ = '') { parent::__construct($BÈ¡Í²„‘š, $E®áŞÓÒ¸º, $d¤£¤ª‹Üœ); } protected $tableMeta = array(); protected function _beforeInsert(&$F¯“„Ùœº•, $C‰šõïœİÌ) { $d§ƒ‹á‰ä =& $_SERVER[©äõ½¡]; if (!$this->checkDataAutoHas($d§ƒ‹á‰ä[353])) { return; } $this->dataBeforeFilter($F¯“„Ùœº•, $d§ƒ‹á‰ä[353]); } protected function _beforeUpdate(&$cğÑ¼’æ, $b±›ÖÄ©) { $AÅòÓÏºòŠ =& $_SERVER[©äõ½¡]; if (!$this->checkDataAutoHas($AÅòÓÏºòŠ[354])) { return; } $this->dataBeforeFilter($cğÑ¼’æ, $AÅòÓÏºòŠ[354]); } protected function _afterSelect(&$eÛ¤”­È¡, $AƒÄìíŸõ¦) { if (!is_array($eÛ¤”­È¡)) { return; } if (!$this->checkDataAutoHas($_SERVER[©äõ½¡][355])) { return; } foreach ($eÛ¤”­È¡ as &$fˆææš) { $this->dataAfterFilter($fˆææš); } unset($fˆææš); } protected function _afterFind(&$F²³’£ó Á, $e¬†½Ê§µ«) { if (!is_array($F²³’£ó Á)) { return; } if (!$this->checkDataAutoHas($_SERVER[©äõ½¡][355])) { return; } $this->dataAfterFilter($F²³’£ó Á); } public static function textEncode($bé±¨–¶±ñ) { if (!$bé±¨–¶±ñ) { return $bé±¨–¶±ñ; } $C¢¡‚¿¢½ = json_encode($bé±¨–¶±ñ); $C¢¡‚¿¢½ = preg_replace_callback($_SERVER[©äõ½¡][356], function ($eø»áÀãø’) { return addslashes($eø»áÀãø’[0]); }, $C¢¡‚¿¢½); return json_decode($C¢¡‚¿¢½); } public static function textDecode($cæ˜Ï®Ë†Ô) { $Eğâçİå°Ú =& $_SERVER[©äõ½¡]; $F½à×Ó§â½ = json_encode($cæ˜Ï®Ë†Ô); $F½à×Ó§â½ = preg_replace_callback($Eğâçİå°Ú[357], function ($bà³÷÷æ†Â) { return $_SERVER[©äõ½¡][97]; }, $F½à×Ó§â½); return json_decode($F½à×Ó§â½); } public function setAutoIncrement($bÑ®øİ…‚ƒ) { $AÄé’Ã˜±— = array($this->getPk() => $bÑ®øİ…‚ƒ); $Eê‘áÊÇ’Ó = $this->data($AÄé’Ã˜±—)->add(); if ($Eê‘áÊÇ’Ó) { $this->delete($Eê‘áÊÇ’Ó); } } public function getAutoIncrement() { $FÆó¬‚¥”ï = $this->getTableName(); $fßÜ–šÅé˜ = $this->max($this->getPk()); $B±ØÊË‹÷‰ = $this->query("\163\x68\157\x77\40\164\141\x62\x6c\x65\40\x73\164\141\164\x75\x73\40\x77\x68\x65\x72\145\40\x4e\141\155\x65\75\x27{$FÆó¬‚¥”ï}\x27"); $FÒ²Ó¶˜ò = $B±ØÊË‹÷‰[0][$_SERVER[©äõ½¡][358]]; $BÁÁÀå˜î› = max($fßÜ–šÅé˜, $FÒ²Ó¶˜ò); return $BÁÁÀå˜î›; } protected function _callBefore($fß’ùÀëãİ, $A“Á©‚İ“¢) { return $this->cacheCallCheck($fß’ùÀëãİ, $A“Á©‚İ“¢, !1); } protected function _callAfter($c´¶ğ•Ø–‰, $eƒÎÒÜ¹¨) { return $this->cacheCallCheck($c´¶ğ•Ø–‰, $eƒÎÒÜ¹¨, !0); } protected function cacheFunctionAlias($Cî—ÂÛ¥¹) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($E‰§¨‘â‡È, $EÚÆÖé‹ï, $fØËÎ°Òé = false) { $a§ÊŒÉò† = $this->cacheFunctionAlias($EÚÆÖé‹ï); if (!$a§ÊŒÉò†) { return; } foreach ($a§ÊŒÉò† as $fö·™•ë‘– => $F‹ò±¢) { $cç‘‰‡é = $F‹ò±¢[0]; $Bª›ßëç‹í = explode($_SERVER[©äõ½¡][47], $F‹ò±¢[1]); if ($E‰§¨‘â‡È == $fö·™•ë‘–) { return $this->cacheFunctionGet($fö·™•ë‘–, $cç‘‰‡é); } if ($fØËÎ°Òé && in_array($E‰§¨‘â‡È, $Bª›ßëç‹í)) { $this->cacheFunctionClear($fö·™•ë‘–, $cç‘‰‡é); } } } public function cacheFunctionGet($B£˜£™Şá, $Eæ¶˜âÉ¨è) { $FïºÚâ»—¶ = $this->cacheKeyMake($B£˜£™Şá, $Eæ¶˜âÉ¨è); $Cå¤©Ä¤¨ = Cache::get($FïºÚâ»—¶); if (!is_array($Cå¤©Ä¤¨)) { $Cå¤©Ä¤¨ = call_user_func_array(array($this, $B£˜£™Şá), array($Eæ¶˜âÉ¨è, !0)); Cache::set($FïºÚâ»—¶, $Cå¤©Ä¤¨); } return $Cå¤©Ä¤¨; } public function cacheFunctionClear($d‰¨ÈŠ¹¬, $cŸÉ”“œíë) { $d˜ÀãºğĞÕ = $cŸÉ”“œíë; if (!is_array($cŸÉ”“œíë)) { $d˜ÀãºğĞÕ = array($cŸÉ”“œíë); } foreach ($d˜ÀãºğĞÕ as $cÓ”¢ÇÃµß) { $Dùè³Ûé£ = $this->cacheKeyMake($d‰¨ÈŠ¹¬, $cÓ”¢ÇÃµß); Cache::remove($Dùè³Ûé£); } } private function cacheKeyMake($bæ§»°­É¯, $dÚ¯ŒáïË‰) { $d¦½°¶èÖ =& $_SERVER[©äõ½¡]; return get_class($this) . $d¦½°¶èÖ[71] . $bæ§»°­É¯ . $d¦½°¶èÖ[359] . $dÚ¯ŒáïË‰; } protected function selectPageReset() { $FÄ‡’‘‘ =& $_SERVER[©äõ½¡]; if (isset($GLOBALS[$FÄ‡’‘‘[360]])) { return; } $GLOBALS[$FÄ‡’‘‘[360]] = isset($GLOBALS[$FÄ‡’‘‘[7]][$FÄ‡’‘‘[361]]) ? $GLOBALS[$FÄ‡’‘‘[7]][$FÄ‡’‘‘[361]] : !1; $GLOBALS[$FÄ‡’‘‘[362]] = isset($GLOBALS[$FÄ‡’‘‘[7]][$FÄ‡’‘‘[351]]) ? $GLOBALS[$FÄ‡’‘‘[7]][$FÄ‡’‘‘[351]] : !1; $GLOBALS[$FÄ‡’‘‘[7]][$FÄ‡’‘‘[361]] = !1; $GLOBALS[$FÄ‡’‘‘[7]][$FÄ‡’‘‘[351]] = !1; } protected function selectPageRestore() { $cïÖÀáÛÌè =& $_SERVER[©äõ½¡]; if (!isset($GLOBALS[$cïÖÀáÛÌè[360]])) { return; } $GLOBALS[$cïÖÀáÛÌè[7]][$cïÖÀáÛÌè[361]] = $GLOBALS[$cïÖÀáÛÌè[360]]; $GLOBALS[$cïÖÀáÛÌè[7]][$cïÖÀáÛÌè[351]] = $GLOBALS[$cïÖÀáÛÌè[362]]; unset($GLOBALS[$cïÖÀáÛÌè[360]]); unset($GLOBALS[$cïÖÀáÛÌè[362]]); } protected function selectPage($c»Ù«ÓàŸë = 200, $Fˆ²™Ï¥˜ = 1) { goto A‚çñÑ•Œ©; D³ºšæ¼Áã: $c»Ù«ÓàŸë = $c»Ù«ÓàŸë <= 5 ? 5 : ($c»Ù«ÓàŸë >= $fÄáÑ©ˆªª ? $fÄáÑ©ˆªª : $c»Ù«ÓàŸë); $Fˆ²™Ï¥˜ = intval(isset($in[$Bİ¿äï½Ôß[351]]) && $in[$Bİ¿äï½Ôß[351]] ? $in[$Bİ¿äï½Ôß[351]] : $Fˆ²™Ï¥˜); $Fˆ²™Ï¥˜ = $Fˆ²™Ï¥˜ <= 1 ? 1 : $Fˆ²™Ï¥˜; goto b¡ ††ôö‰; a†…ˆÍ¤´¼: $fÄáÑ©ˆªª = 50000; $c»Ù«ÓàŸë = isset($in[$Bİ¿äï½Ôß[361]]) && $in[$Bİ¿äï½Ôß[361]] ? $in[$Bİ¿äï½Ôß[361]] : $c»Ù«ÓàŸë; if ($c»Ù«ÓàŸë === -1) { $in[$Bİ¿äï½Ôß[361]] = !1; $fÄáÑ©ˆªª = 100000000; $c»Ù«ÓàŸë = $fÄáÑ©ˆªª; } goto DˆÃäáÂ¸à; bŞ²Ş†ê‰Ü: return $A¤Å¯ÌÙËÖ; goto EïÅê’Ñ; b¡ ††ôö‰: $D¶ø¿µÌ¶• = array(); $Eõ§ÚÓÄù = 1; if ($Fˆ²™Ï¥˜ == 1 && $Eõ§ÚÓÄù) { $this->optionsValue($d“÷Ç‘ˆŒ); $D¶ø¿µÌ¶• = $this->page($Fˆ²™Ï¥˜, $c»Ù«ÓàŸë)->select(); $EŞ³§é«Ìœ = is_array($D¶ø¿µÌ¶•) ? count($D¶ø¿µÌ¶•) : 0; if ($EŞ³§é«Ìœ < $c»Ù«ÓàŸë) { $eÇ¥Ü®©µÙ = 1; } else { $this->optionsValue($aŒ‡îË‰Ü); $EŞ³§é«Ìœ = intval($this->count()); $eÇ¥Ü®©µÙ = ceil($EŞ³§é«Ìœ / $c»Ù«ÓàŸë); } } else { $this->optionsValue($aŒ‡îË‰Ü); $EŞ³§é«Ìœ = intval($this->count()); $eÇ¥Ü®©µÙ = ceil($EŞ³§é«Ìœ / $c»Ù«ÓàŸë); $Fˆ²™Ï¥˜ = $Fˆ²™Ï¥˜ >= $eÇ¥Ü®©µÙ ? $eÇ¥Ü®©µÙ : $Fˆ²™Ï¥˜; $this->optionsValue($d“÷Ç‘ˆŒ); $D¶ø¿µÌ¶• = $this->page($Fˆ²™Ï¥˜, $c»Ù«ÓàŸë)->select(); } goto d²ƒ„…ìÚµ; d²ƒ„…ìÚµ: if (!is_array($D¶ø¿µÌ¶•)) { $D¶ø¿µÌ¶• = array(); } if ($eÇ¥Ü®©µÙ == 1) { $EŞ³§é«Ìœ = count($D¶ø¿µÌ¶•); } $A¤Å¯ÌÙËÖ = array($Bİ¿äï½Ôß[364] => array($Bİ¿äï½Ôß[365] => $EŞ³§é«Ìœ, $Bİ¿äï½Ôß[361] => $c»Ù«ÓàŸë, $Bİ¿äï½Ôß[351] => $Fˆ²™Ï¥˜, $Bİ¿äï½Ôß[366] => $eÇ¥Ü®©µÙ), $Bİ¿äï½Ôß[367] => $D¶ø¿µÌ¶•); goto bŞ²Ş†ê‰Ü; DˆÃäáÂ¸à: $aŒ‡îË‰Ü = $d“÷Ç‘ˆŒ; $aŒ‡îË‰Ü[$Bİ¿äï½Ôß[363]] = array(); $c»Ù«ÓàŸë = intval($c»Ù«ÓàŸë); goto D³ºšæ¼Áã; A‚çñÑ•Œ©: $Bİ¿äï½Ôß =& $_SERVER[©äõ½¡]; global $in; $d“÷Ç‘ˆŒ = $this->optionsValue(); goto a†…ˆÍ¤´¼; EïÅê’Ñ: } protected function checkLength($Bò•‹ïŞ², $b˜ÕŒ®áÀ = 0, $a¥Ùù÷ÛÜ = '') { $eŒ¾„…íÂ =& $_SERVER[©äõ½¡]; $b˜ÕŒ®áÀ = $b˜ÕŒ®áÀ ? $b˜ÕŒ®áÀ : 65536; if (!$Bò•‹ïŞ² || strlen($Bò•‹ïŞ²) < $b˜ÕŒ®áÀ) { return; } $a¥Ùù÷ÛÜ = $a¥Ùù÷ÛÜ ? $a¥Ùù÷ÛÜ . $eŒ¾„…íÂ[68] : $eŒ¾„…íÂ[33]; show_json($a¥Ùù÷ÛÜ . LNG($eŒ¾„…íÂ[368]) . "\50{$b˜ÕŒ®áÀ}\x29", !1); } protected function metaSet($c®•½®´‰, $b•™ãÚ£ë² = null, $eğ˜ê‚¤ğ‘ = null) { goto f›àÏ¼•–‡; F®å»Æó‚È: CacheLock::unlock($bñÈ©ßéŒ°); return !0; goto DÓ›»ì‰­›; AÜ—ÑŠºÉÓ: if (is_null($b•™ãÚ£ë²)) { return $bŸÒáòĞòÔ->where(array($dÕå†§Š›½ => $c®•½®´‰))->delete(); } if (is_null($eğ˜ê‚¤ğ‘) && is_string($b•™ãÚ£ë²)) { return $bŸÒáòĞòÔ->where($FØ©İ—±Ñ)->delete(); } $b‰èèù…ò = is_array($b•™ãÚ£ë²) ? $b•™ãÚ£ë² : array(); goto Eõ˜Šµà¬; Eõ˜Šµà¬: if (is_string($b•™ãÚ£ë²)) { $b‰èèù…ò[$b•™ãÚ£ë²] = $eğ˜ê‚¤ğ‘; } $CôœçêÒ¯¡ = array(); foreach ($b‰èèù…ò as $BÈ×àˆ£ë => $eˆ³Îùêİ) { if (is_null($eˆ³Îùêİ) && is_string($BÈ×àˆ£ë)) { $bŸÒáòĞòÔ->where(array($dÕå†§Š›½ => $c®•½®´‰, $bîåĞŸìÕµ[371] => $BÈ×àˆ£ë))->delete(); continue; } $this->checkLength($eˆ³Îùêİ, !1, $fš¥‚”°‡ . $bîåĞŸìÕµ[4] . $BÈ×àˆ£ë); $CôœçêÒ¯¡[] = array($dÕå†§Š›½ => $c®•½®´‰, $bîåĞŸìÕµ[93] => $BÈ×àˆ£ë, $bîåĞŸìÕµ[372] => $eˆ³Îùêİ); } goto b¡ëôù¬é·; dù¼ÆŒÄ„ó: $fš¥‚”°‡ = $this->tableMeta[$bîåĞŸìÕµ[370]]; $bŸÒáòĞòÔ = Model($fš¥‚”°‡); $FØ©İ—±Ñ = array($dÕå†§Š›½ => $c®•½®´‰, $bîåĞŸìÕµ[371] => $b•™ãÚ£ë²); goto AÜ—ÑŠºÉÓ; b¡ëôù¬é·: $bñÈ©ßéŒ° = $bîåĞŸìÕµ[373] . $this->tableMeta; CacheLock::lock($bñÈ©ßéŒ°); $bŸÒáòĞòÔ->where(array($dÕå†§Š›½ => $c®•½®´‰))->addAll($CôœçêÒ¯¡, array(), !0); goto F®å»Æó‚È; f›àÏ¼•–‡: $bîåĞŸìÕµ =& $_SERVER[©äõ½¡]; if (!$this->tableMeta || !$c®•½®´‰) { return !1; } $dÕå†§Š›½ = $this->tableMeta[$bîåĞŸìÕµ[369]]; goto dù¼ÆŒÄ„ó; DÓ›»ì‰­›: } public function metaGet($eŞîŒñÀÇê, $a‚•³ˆİ¾ = false) { goto E®ÒªáˆŒÅ; cöìîßçßª: $d•©ï×…÷ì = $f´Á…¦òº->field($a¾‰ôÑ¦õ[374])->where($B¼ä£ê³)->select(); $d•©ï×…÷ì = array_to_keyvalue($d•©ï×…÷ì, $a¾‰ôÑ¦õ[93], $a¾‰ôÑ¦õ[372]); return $d•©ï×…÷ì; goto fô²¦‰¿Ğ¼; c»šµÚŒÜÍ: $f´Á…¦òº = Model($this->tableMeta[$a¾‰ôÑ¦õ[370]]); if ($a‚•³ˆİ¾) { $B¼ä£ê³ = array($f±±Ê ¹‹¾ => $eŞîŒñÀÇê, $a¾‰ôÑ¦õ[93] => $a‚•³ˆİ¾); return $f´Á…¦òº->where($B¼ä£ê³)->getField($a¾‰ôÑ¦õ[372]); } $B¼ä£ê³ = array($f±±Ê ¹‹¾ => $eŞîŒñÀÇê); goto cöìîßçßª; E®ÒªáˆŒÅ: $a¾‰ôÑ¦õ =& $_SERVER[©äõ½¡]; if (!$this->tableMeta) { return array(); } $f±±Ê ¹‹¾ = $this->tableMeta[$a¾‰ôÑ¦õ[369]]; goto c»šµÚŒÜÍ; fô²¦‰¿Ğ¼: } private function checkDataAutoHas($eˆ˜ŸÂ¿Ã) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $c£ÁÒåĞÕŸ) { if (in_array($eˆ˜ŸÂ¿Ã, explode($_SERVER[©äõ½¡][47], $c£ÁÒåĞÕŸ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$dÓñàõÅ½Ö, $b×—‘­©¢) { $F’ˆ®¹©¡£ =& $_SERVER[©äõ½¡]; foreach ($this->dataAuto as $FŠËîàË‘) { $bî“ºÅÃ‘’ = $FŠËîàË‘[0]; if (!in_array($b×—‘­©¢, explode($F’ˆ®¹©¡£[47], $FŠËîàË‘[2]))) { continue; } switch (trim($FŠËîàË‘[3])) { case $F’ˆ®¹©¡£[319]: case $F’ˆ®¹©¡£[320]: $eÜİƒ¸÷Ò™ = $FŠËîàË‘[1]; $Fİº Â¨ö± = isset($FŠËîàË‘[4]) ? (array) $FŠËîàË‘[4] : array(); if ($eÜİƒ¸÷Ò™ == $F’ˆ®¹©¡£[197] && array_key_exists($bî“ºÅÃ‘’, $dÓñàõÅ½Ö)) { if (!$dÓñàõÅ½Ö[$bî“ºÅÃ‘’]) { unset($dÓñàõÅ½Ö[$bî“ºÅÃ‘’]); } break; } if (isset($dÓñàõÅ½Ö[$bî“ºÅÃ‘’])) { array_unshift($Fİº Â¨ö±, $dÓñàõÅ½Ö[$bî“ºÅÃ‘’]); } if ($F’ˆ®¹©¡£[319] == $FŠËîàË‘[3]) { $dÓñàõÅ½Ö[$bî“ºÅÃ‘’] = call_user_func_array($eÜİƒ¸÷Ò™, $Fİº Â¨ö±); } else { $dÓñàõÅ½Ö[$bî“ºÅÃ‘’] = call_user_func_array(array(&$this, $eÜİƒ¸÷Ò™), $Fİº Â¨ö±); } break; case $F’ˆ®¹©¡£[268]: if (isset($dÓñàõÅ½Ö[$bî“ºÅÃ‘’]) && $dÓñàõÅ½Ö[$bî“ºÅÃ‘’]) { $dÓñàõÅ½Ö[$bî“ºÅÃ‘’] = call_user_func_array(array(&$this, $FŠËîàË‘[1]), array($dÓñàõÅ½Ö[$bî“ºÅÃ‘’])); } break; case $F’ˆ®¹©¡£[271]: $dÓñàõÅ½Ö[$bî“ºÅÃ‘’] = $dÓñàõÅ½Ö[$FŠËîàË‘[1]]; break; case $F’ˆ®¹©¡£[292]: if (isset($dÓñàõÅ½Ö[$bî“ºÅÃ‘’]) && !is_string($dÓñàõÅ½Ö[$bî“ºÅÃ‘’])) { $dÓñàõÅ½Ö[$bî“ºÅÃ‘’] = json_encode_force($dÓñàõÅ½Ö[$bî“ºÅÃ‘’]); } break; case $F’ˆ®¹©¡£[321]: if ($dÓñàõÅ½Ö[$bî“ºÅÃ‘’] === $F’ˆ®¹©¡£[33]) { unset($dÓñàõÅ½Ö[$bî“ºÅÃ‘’]); } break; case $F’ˆ®¹©¡£[322]: $dÓñàõÅ½Ö[$bî“ºÅÃ‘’] = $FŠËîàË‘[1]; default: break; } } if ($b×—‘­©¢ == $F’ˆ®¹©¡£[353]) { $D’¥­„èÑ = strtolower($this->db->getDbType()); if (strpos($D’¥­„èÑ, $F’ˆ®¹©¡£[9]) !== 0) { return; } $A›“«·óÌõ = $this->field(!0)->fields; $aÀ‚ÛŒ¨àç = $A›“«·óÌõ[$F’ˆ®¹©¡£[250]]; if (isset($A›“«·óÌõ[$F’ˆ®¹©¡£[249]])) { unset($aÀ‚ÛŒ¨àç[$A›“«·óÌõ[$F’ˆ®¹©¡£[249]]]); } foreach ($aÀ‚ÛŒ¨àç as $E‡”‚ÍïŞ„ => $b×—‘­©¢) { if (!isset($dÓñàõÅ½Ö[$E‡”‚ÍïŞ„])) { $dÓñàõÅ½Ö[$E‡”‚ÍïŞ„] = $F’ˆ®¹©¡£[33]; } } } } private function dataAfterFilter(&$cØÅ’¶ ÒÛ) { $D¹ŸŠÊ¼ÔÎ =& $_SERVER[©äõ½¡]; foreach ($this->dataAuto as $c¢¼™àÚİè) { $A™Ç‹ˆ‡ò = $c¢¼™àÚİè[0]; if (!isset($cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò])) { continue; } if (!in_array($D¹ŸŠÊ¼ÔÎ[355], explode($D¹ŸŠÊ¼ÔÎ[47], $c¢¼™àÚİè[2]))) { continue; } switch (trim($c¢¼™àÚİè[3])) { case $D¹ŸŠÊ¼ÔÎ[319]: case $D¹ŸŠÊ¼ÔÎ[320]: $Aò•İ«…É˜ = isset($c¢¼™àÚİè[4]) ? (array) $c¢¼™àÚİè[4] : array(); array_unshift($Aò•İ«…É˜, $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò]); if (isset($c¢¼™àÚİè[4]) && $c¢¼™àÚİè[4] == $D¹ŸŠÊ¼ÔÎ[375]) { $Aò•İ«…É˜ = array($cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò]); } if ($D¹ŸŠÊ¼ÔÎ[319] == $c¢¼™àÚİè[3]) { $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò] = call_user_func_array($c¢¼™àÚİè[1], $Aò•İ«…É˜); } else { $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò] = call_user_func_array(array(&$this, $c¢¼™àÚİè[1]), $Aò•İ«…É˜); } break; case $D¹ŸŠÊ¼ÔÎ[268]: if (isset($cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò]) && $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò]) { $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò] = call_user_func_array(array(&$this, $c¢¼™àÚİè[1]), array($cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò])); } break; case $D¹ŸŠÊ¼ÔÎ[271]: $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò] = $cØÅ’¶ ÒÛ[$c¢¼™àÚİè[1]]; break; case $D¹ŸŠÊ¼ÔÎ[292]: $AÃ…àƒ¨¸ˆ = $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò]; $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò] = json_decode($AÃ…àƒ¨¸ˆ, !0); if (is_null($cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò])) { $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò] = $AÃ…àƒ¨¸ˆ; } break; case $D¹ŸŠÊ¼ÔÎ[321]: if ($cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò] === $D¹ŸŠÊ¼ÔÎ[33]) { unset($cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò]); } break; case $D¹ŸŠÊ¼ÔÎ[322]: $cØÅ’¶ ÒÛ[$A™Ç‹ˆ‡ò] = $c¢¼™àÚİè[1]; break; default: break; } } } public function saveAll($E•è†«ß°Å) { goto aƒò­×ç¬Ğ; Eò²ÉíÜ¿†: $this->chunkEventSet(); goto cŠÉ½ËØ™„; B¨ÅÒ ˜ˆë: $E•è†«ß°Å = is_array($E•è†«ß°Å) ? $E•è†«ß°Å : array(); $aì­¥˜¼¦ = $F–ˆ¯±Òæ[376]; $d¬¾ìäï¥ = 0; goto EÀºÖ«âš¯; EÀºÖ«âš¯: $FŞ°İ¾¸¬Ü = array(); $FƒÓö—Á¦½ = count($E•è†«ß°Å); for ($C‰¬Óàˆê = 0; $C‰¬Óàˆê < $FƒÓö—Á¦½; $C‰¬Óàˆê++) { $aæ·ïÆ¿˜ö = $E•è†«ß°Å[$C‰¬Óàˆê]; if (!is_array($aæ·ïÆ¿˜ö) || count($aæ·ïÆ¿˜ö) != 4) { continue; } $e»˜÷˜Ì¼ô = "\x55\x50\x44\x41\x54\x45\40\140{$cµ ¬à¼ƒ…}\140\x20\123\x45\x54\x20{$aæ·ïÆ¿˜ö[2]}\x20\75\x20\x43\x41\123\105\40{$aæ·ïÆ¿˜ö[0]}\x20\xa"; if ($d¬¾ìäï¥ == 0) { $aì­¥˜¼¦ = $e»˜÷˜Ì¼ô; } $FŞ°İ¾¸¬Ü[] = $F–ˆ¯±Òæ[116] . $aæ·ïÆ¿˜ö[1] . $F–ˆ¯±Òæ[116]; $d¬¾ìäï¥++; $aì­¥˜¼¦ .= "\x20\x57\x48\x45\116\40\x27{$aæ·ïÆ¿˜ö[1]}\47\x20\124\x48\105\x4e\x20\x27{$aæ·ïÆ¿˜ö[3]}\x27\x20\xa"; if ($d¬¾ìäï¥ == $BÉ„Ú‘ää£ || $C‰¬Óàˆê == $FƒÓö—Á¦½ - 1) { goto D„Ô½ãñ´Í; c×õŸ‚²ÚÒ: $FŞ°İ¾¸¬Ü = array(); goto d–Ñ˜ÄÎŒ´; D„Ô½ãñ´Í: $cÚ‚¸Á‹”ç = implode($F–ˆ¯±Òæ[47], $FŞ°İ¾¸¬Ü); $aì­¥˜¼¦ .= "\40\x45\x4e\104\40\x20\127\x48\105\x52\x45\x20{$aæ·ïÆ¿˜ö[0]}\x20\111\x4e\40\x28{$cÚ‚¸Á‹”ç}\x29\x20"; $this->execute($aì­¥˜¼¦); goto a·óóºàÒ›; a·óóºàÒ›: $d¬¾ìäï¥ = 0; $aì­¥˜¼¦ = $e»˜÷˜Ì¼ô; $this->chunkEventCheck(count($FŞ°İ¾¸¬Ü)); goto c×õŸ‚²ÚÒ; d–Ñ˜ÄÎŒ´: } } goto Eò²ÉíÜ¿†; aƒò­×ç¬Ğ: $F–ˆ¯±Òæ =& $_SERVER[©äõ½¡]; $cµ ¬à¼ƒ… = $this->tablePrefix . $this->tableName; $BÉ„Ú‘ää£ = self::SQL_WHERE_IN_CHUNK; goto B¨ÅÒ ˜ˆë; cŠÉ½ËØ™„: } public function saveAllEach($e—ã±Õæï¿) { $e×ÜõÑñ’ =& $_SERVER[©äõ½¡]; $eÛ°îîÑêğ = $this->tablePrefix . $this->tableName; foreach ($e—ã±Õæï¿ as $e°°î¢Ø¾) { if (!is_array($e°°î¢Ø¾) || count($e°°î¢Ø¾) != 4) { continue; } $EÆÒ®ö‘òĞ = $e°°î¢Ø¾[0] . $e×ÜõÑñ’[377] . $e°°î¢Ø¾[1] . $e×ÜõÑñ’[116]; $CÊÂÀ½ñö = $e°°î¢Ø¾[2] . $e×ÜõÑñ’[377] . $e°°î¢Ø¾[3] . $e×ÜõÑñ’[116]; $A†¬Æöç©è = "\x75\x70\x64\141\x74\145\40{$eÛ°îîÑêğ}\40\163\145\x74\40{$CÊÂÀ½ñö}\x20\x77\150\x65\x72\145\x20{$EÆÒ®ö‘òĞ}\x3b"; $this->execute($A†¬Æöç©è); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($dÑÜÍóÔº³ = false, $A¬‘øÃÊÜë = false) { $this->_chunkEvent = $dÑÜÍóÔº³; $this->_chunkEventParam = $A¬‘øÃÊÜë; } private function chunkEventCheck($FîëåÖ¢¼å) { if (!$this->_chunkEvent) { return; } $bâ‰‹™“î¦ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $bâ‰‹™“î¦[$_SERVER[©äõ½¡][378]] = $FîëåÖ¢¼å; Hook::trigger($this->_chunkEvent, $bâ‰‹™“î¦); } public function addAll($b®Ï“Å°¸, $bÙË¯ÛÚÚ = array(), $DÑ¹ßí¸¢ã = false) { goto dÊçÎ¢çÊ; dÉù¸ÀĞ³: if (method_exists($this->db, $D–åÍ¾¼¶à[270])) { for ($f—Š¡È™Î¿ = 0; $f—Š¡È™Î¿ < count($b®Ï“Å°¸); $f—Š¡È™Î¿ += $DË£ñÈœ¿æ) { $eÖİÍå™ñÄ = array_slice($b®Ï“Å°¸, $f—Š¡È™Î¿, $DË£ñÈœ¿æ); if (!is_array($eÖİÍå™ñÄ) || count($eÖİÍå™ñÄ) == 0) { break; } $a‰ˆÍ¸Î™¼ = $this->db->insertAll($eÖİÍå™ñÄ, $bÙË¯ÛÚÚ, $DÑ¹ßí¸¢ã); $this->chunkEventCheck(count($eÖİÍå™ñÄ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($b®Ï“Å°¸ as $b…’äºêïÛ => $fØ¹‡‘Çæ„) { $a‰ˆÍ¸Î™¼ = $this->db->insert($fØ¹‡‘Çæ„, $bÙË¯ÛÚÚ, $DÑ¹ßí¸¢ã); } $this->commit(); } if (!1 !== $a‰ˆÍ¸Î™¼) { $CíŒ¡èÊõ‡ = $this->getLastInsID(); if ($CíŒ¡èÊõ‡) { return $CíŒ¡èÊõ‡; } } return $a‰ˆÍ¸Î™¼; goto f°óšá·À; C¾ß¶“’Ò: if (empty($b®Ï“Å°¸)) { $this->error = think_lang($D–åÍ¾¼¶à[269]); return !1; } $bÙË¯ÛÚÚ = $this->_parseOptions($bÙË¯ÛÚÚ); foreach ($b®Ï“Å°¸ as $b…’äºêïÛ => $fØ¹‡‘Çæ„) { $b®Ï“Å°¸[$b…’äºêïÛ] = $this->_facade($fØ¹‡‘Çæ„); $this->_beforeInsert($b®Ï“Å°¸[$b…’äºêïÛ], $bÙË¯ÛÚÚ); } goto dÉù¸ÀĞ³; dÊçÎ¢çÊ: $D–åÍ¾¼¶à =& $_SERVER[©äõ½¡]; ignore_timeout(); $DË£ñÈœ¿æ = self::SQL_WHERE_IN_CHUNK; goto C¾ß¶“’Ò; f°óšá·À: } public function save($C“  Òå®¨ = '', $FãÙ¥«ò œ = array()) { goto CÆ‡¤…í±Ó; CÆ‡¤…í±Ó: $eñá«ùğóß =& $_SERVER[©äõ½¡]; $DÕÑ½ÆÈÉí = self::SQL_WHERE_IN_CHUNK; $d¥ù®ğ©¬Š = $this->optionsValue(); goto Açê‡³öŒò; Cê´ø•³•: $FÌ¤œéè›ƒ = $d¥ù®ğ©¬Š[$eñá«ùğóß[273]][$aÀ¿¦ï¯„»][1]; $FÌ¤œéè›ƒ = is_array($FÌ¤œéè›ƒ) ? $FÌ¤œéè›ƒ : array(); $f¸æ¢ºùïã = count($FÌ¤œéè›ƒ); goto e’Ç§šóôÇ; Açê‡³öŒò: $aÀ¿¦ï¯„» = $this->findWhereField($d¥ù®ğ©¬Š); if (!$aÀ¿¦ï¯„») { return parent::save($C“  Òå®¨, $FãÙ¥«ò œ); } $b¼Ï†Î¸›ñ = 0; goto Cê´ø•³•; e’Ç§šóôÇ: for ($fµ×œ…›‹ƒ = 0; $fµ×œ…›‹ƒ < $f¸æ¢ºùïã; $fµ×œ…›‹ƒ += $DÕÑ½ÆÈÉí) { $BÑÇÚîÅŒ = array_slice($FÌ¤œéè›ƒ, $fµ×œ…›‹ƒ, $DÕÑ½ÆÈÉí); if (!is_array($BÑÇÚîÅŒ) || count($BÑÇÚîÅŒ) == 0) { break; } $d¥ù®ğ©¬Š[$eñá«ùğóß[273]][$aÀ¿¦ï¯„»][1] = $BÑÇÚîÅŒ; $this->optionsValue($d¥ù®ğ©¬Š); $b¼Ï†Î¸›ñ += parent::save($C“  Òå®¨, $FãÙ¥«ò œ); $this->chunkEventCheck(count($BÑÇÚîÅŒ)); } $this->chunkEventSet(); return $b¼Ï†Î¸›ñ; goto BÚİ·±Ü; BÚİ·±Ü: } public function add($c¦ÏÏÙ¨à­ = '', $A’š““ÂÑ = array(), $b©óĞÛ ÷ = false) { if ($this->addTaskStatus && is_array($c¦ÏÏÙ¨à­)) { $this->addTaskData[] = $c¦ÏÏÙ¨à­; return; } return parent::add($c¦ÏÏÙ¨à­, $A’š““ÂÑ, $b©óĞÛ ÷); } public function parseWhereLike($fšÕ³”Ñø³, $ešÔÌÈ•Õµ = '', $Fî’•šîÍñ = false, &$b„‚¸Í¥Ğà = false) { goto FøŞçÅ‡‘»; FøŞçÅ‡‘»: $b‡À¨ÍµŸÄ =& $_SERVER[©äõ½¡]; $f”‘ïìá‰ = $GLOBALS[$b‡À¨ÍµŸÄ[6]][$b‡À¨ÍµŸÄ[379]]; if (!$f”‘ïìá‰[$b‡À¨ÍµŸÄ[380]]) { return $fšÕ³”Ñø³; } goto CÃö’¥ó­ç; CÃö’¥ó­ç: if (!is_array($fšÕ³”Ñø³)) { return $fšÕ³”Ñø³; } $dçµ‡¬ÏÈ¦ = array(); $b—âÊæƒ = 0; goto EÈƒ’ìù¬ä; EÈƒ’ìù¬ä: foreach ($fšÕ³”Ñø³ as $B®Ù’òçÚƒ => $e°òĞÀ¹ª) { if (is_array($e°òĞÀ¹ª) && count($e°òĞÀ¹ª) == 2 && $e°òĞÀ¹ª[0] == $b‡À¨ÍµŸÄ[381] && is_string($e°òĞÀ¹ª[1]) && substr($e°òĞÀ¹ª[1], 0, 1) == $b‡À¨ÍµŸÄ[382] && substr($e°òĞÀ¹ª[1], strlen($e°òĞÀ¹ª[1]) - 1, 1) == $b‡À¨ÍµŸÄ[382]) { goto AªÈ»ÛÜ; A”Ï¸ŸÚ«·: if ($f”‘ïìá‰[$b‡À¨ÍµŸÄ[384]]) { $bÍâ¤ÀÎ¶£ = $b‡À¨ÍµŸÄ[385] . $BÉ‹ÇÀ‘µ . $b‡À¨ÍµŸÄ[386]; if ($f”‘ïìá‰[$b‡À¨ÍµŸÄ[387]]) { $bÍâ¤ÀÎ¶£ = $b‡À¨ÍµŸÄ[386] . $BÉ‹ÇÀ‘µ . $b‡À¨ÍµŸÄ[385]; } } $dçµ‡¬ÏÈ¦[$b—âÊæƒ] = $b‡À¨ÍµŸÄ[388] . $aÈ„‰ì¢ôÊ . $b‡À¨ÍµŸÄ[389] . $bÍâ¤ÀÎ¶£ . $b‡À¨ÍµŸÄ[390]; $b—âÊæƒ++; goto D¦î×ï”åÍ; D¦î×ï”åÍ: continue; goto c±¬¬çßÏ; e¢Ñ–‚ïîá: $BÉ‹ÇÀ‘µ = $this->db->escapeString($BÉ‹ÇÀ‘µ); if (!strpos($aÈ„‰ì¢ôÊ, $b‡À¨ÍµŸÄ[95])) { $aÈ„‰ì¢ôÊ = $b‡À¨ÍµŸÄ[383] . $aÈ„‰ì¢ôÊ . $b‡À¨ÍµŸÄ[383]; } $bÍâ¤ÀÎ¶£ = $b‡À¨ÍµŸÄ[182] . $BÉ‹ÇÀ‘µ . $b‡À¨ÍµŸÄ[182]; goto A”Ï¸ŸÚ«·; AªÈ»ÛÜ: $b„‚¸Í¥Ğà = !0; $aÈ„‰ì¢ôÊ = is_string($B®Ù’òçÚƒ) ? $B®Ù’òçÚƒ : $ešÔÌÈ•Õµ; $BÉ‹ÇÀ‘µ = substr($e°òĞÀ¹ª[1], 1, strlen($e°òĞÀ¹ª[1]) - 2); goto e¢Ñ–‚ïîá; c±¬¬çßÏ: } if (is_array($e°òĞÀ¹ª)) { $ešÔÌÈ•Õµ = is_string($B®Ù’òçÚƒ) ? $B®Ù’òçÚƒ : $ešÔÌÈ•Õµ; $e°òĞÀ¹ª = $this->parseWhereLike($e°òĞÀ¹ª, $ešÔÌÈ•Õµ, !0, $b„‚¸Í¥Ğà); } if (is_numeric($B®Ù’òçÚƒ)) { $dçµ‡¬ÏÈ¦[$b—âÊæƒ] = $e°òĞÀ¹ª; $b—âÊæƒ++; } else { $dçµ‡¬ÏÈ¦[$B®Ù’òçÚƒ] = $e°òĞÀ¹ª; } } if ($b„‚¸Í¥Ğà && !$Fî’•šîÍñ) { } return $dçµ‡¬ÏÈ¦; goto D“İ¸‘Ê…; D“İ¸‘Ê…: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($fŒŠŒ£°©Ù = array()) { goto dĞë÷éšÙ; CŒƒá¦Œ: $c„¨µòßŞá = is_array($c„¨µòßŞá) ? $c„¨µòßŞá : array(); $f²‹Ç¹î¼ = null; for ($Aä™¸Œ¦´ = 0; $Aä™¸Œ¦´ < count($c„¨µòßŞá); $Aä™¸Œ¦´ += $Dœœšš‘Ôà) { $FšùİĞİ¢ô = array_slice($c„¨µòßŞá, $Aä™¸Œ¦´, $Dœœšš‘Ôà); if (!is_array($FšùİĞİ¢ô) || count($FšùİĞİ¢ô) == 0) { break; } $e£ª›å®‘ô[$E®œÚòÓ[273]][$DŒœ‰†ŸÉ§][1] = $FšùİĞİ¢ô; $this->optionsValue($e£ª›å®‘ô); $C’İÄ÷êÃ‹ = parent::select($fŒŠŒ£°©Ù); if (!$C’İÄ÷êÃ‹) { continue; } $f²‹Ç¹î¼ = is_array($f²‹Ç¹î¼) ? $f²‹Ç¹î¼ : array(); $f²‹Ç¹î¼ = array_merge($f²‹Ç¹î¼, $C’İÄ÷êÃ‹); } goto E·åñÃŠ¢‡; E·åñÃŠ¢‡: return $f²‹Ç¹î¼; goto E¡°˜ÔéÚ; dĞë÷éšÙ: $E®œÚòÓ =& $_SERVER[©äõ½¡]; $Dœœšš‘Ôà = self::SQL_WHERE_IN_CHUNK; $e£ª›å®‘ô = $this->optionsValue(); goto AÉï×Ê›Í; AÉï×Ê›Í: $DŒœ‰†ŸÉ§ = $this->findWhereField($e£ª›å®‘ô); if (!$DŒœ‰†ŸÉ§ || isset($e£ª›å®‘ô[$E®œÚòÓ[290]]) || isset($e£ª›å®‘ô[$E®œÚòÓ[351]])) { return parent::select($fŒŠŒ£°©Ù); } $c„¨µòßŞá = $e£ª›å®‘ô[$E®œÚòÓ[273]][$DŒœ‰†ŸÉ§][1]; goto CŒƒá¦Œ; E¡°˜ÔéÚ: } public function delete($fÃºÇÓ’ç = array()) { goto D´Úõ‚ô‰Ÿ; Bİñ¤éšôÂ: $E©Ó¡Üøëí = $dª“õ®–ã‹[$cÛªÜ­ù®†[273]][$FçÅÆ­ì¯][1]; $E©Ó¡Üøëí = is_array($E©Ó¡Üøëí) ? $E©Ó¡Üøëí : array(); for ($d¥ÅÉš‘Æã = 0; $d¥ÅÉš‘Æã < count($E©Ó¡Üøëí); $d¥ÅÉš‘Æã += $cÅÁØÑã») { $BÙç‰º¬¬ã = array_slice($E©Ó¡Üøëí, $d¥ÅÉš‘Æã, $cÅÁØÑã»); if (!is_array($BÙç‰º¬¬ã) || count($BÙç‰º¬¬ã) == 0) { break; } $dª“õ®–ã‹[$cÛªÜ­ù®†[273]][$FçÅÆ­ì¯][1] = $BÙç‰º¬¬ã; $this->optionsValue($dª“õ®–ã‹); $b·Äò’äê += parent::delete($fÃºÇÓ’ç); } goto F­›İëö¹–; F­›İëö¹–: return $b·Äò’äê; goto Aæ¾„ŠÁã›; d…ª¥‰ğö–: $FçÅÆ­ì¯ = $this->findWhereField($dª“õ®–ã‹); if (!$FçÅÆ­ì¯) { return parent::delete($fÃºÇÓ’ç); } $b·Äò’äê = 0; goto Bİñ¤éšôÂ; D´Úõ‚ô‰Ÿ: $cÛªÜ­ù®† =& $_SERVER[©äõ½¡]; $cÅÁØÑã» = self::SQL_WHERE_IN_CHUNK; $dª“õ®–ã‹ = $this->optionsValue(); goto d…ª¥‰ğö–; Aæ¾„ŠÁã›: } private function findWhereField($fØ×”ßÌöÇ) { $eÈ¨ì•Ü´ =& $_SERVER[©äõ½¡]; $aĞëéÌ…™÷ = self::SQL_WHERE_IN_CHUNK; if (!is_array($fØ×”ßÌöÇ) || !is_array($fØ×”ßÌöÇ[$eÈ¨ì•Ü´[273]])) { return !1; } foreach ($fØ×”ßÌöÇ[$eÈ¨ì•Ü´[273]] as $d·‰Î‡¥éÇ => $f¬ÂÊ³Ô›¡) { if (is_array($f¬ÂÊ³Ô›¡) && isset($f¬ÂÊ³Ô›¡[0]) && is_string($f¬ÂÊ³Ô›¡[0]) && strtolower($f¬ÂÊ³Ô›¡[0]) == $eÈ¨ì•Ü´[7] && is_array($f¬ÂÊ³Ô›¡[1]) && count($f¬ÂÊ³Ô›¡[1]) > $aĞëéÌ…™÷) { ignore_timeout(); return $d·‰Î‡¥éÇ; } } return !1; } public function setMasterDB($F£Ô‚ŸÃ¸¸ = true) { think_config($_SERVER[©äõ½¡][391], $F£Ô‚ŸÃ¸¸); } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\x73\x74\x65\155\117\160\x74\151\x6f\x6e"; public $field = array(); public function listData($d¼¶î¾‡îÌ = false, $E„–¤Ôìƒ = "\155\157\144\151\146\x79\124\x69\x6d\145", $d’¹ĞÌÏ = false) { $DÆğâ‡¬ª = Model($this->modelType)->get(!1, $this->optionType, !0); $Fàëô°ÍÛò = array_values($DÆğâ‡¬ª); if ($Fàëô°ÍÛò && $Fàëô°ÍÛò[0] && !is_array($Fàëô°ÍÛò[0])) { Model($this->modelType)->cacheRemove($this->optionType); $DÆğâ‡¬ª = Model($this->modelType)->get(!1, $this->optionType, !0); } if (!$DÆğâ‡¬ª) { return $d¼¶î¾‡îÌ ? null : array(); } if (!$d¼¶î¾‡îÌ) { $DÆğâ‡¬ª = array_filter(array_values($DÆğâ‡¬ª)); return array_sort_by($DÆğâ‡¬ª, $E„–¤Ôìƒ, $d’¹ĞÌÏ); } return $DÆğâ‡¬ª[$_SERVER[©äõ½¡][392] . $d¼¶î¾‡îÌ]; } public function insert($b°Ç° ­ç‰) { goto DêäôÌ¦; DêäôÌ¦: $AŠ¼‘‰¸èä =& $_SERVER[©äõ½¡]; $b°Ç° ­ç‰ = array_field_key($b°Ç° ­ç‰, $this->field); $f‰ß²ÙëÙ‚ = Model($this->modelType)->get($AŠ¼‘‰¸èä[393], $this->optionType . $AŠ¼‘‰¸èä[394]); goto f…òÄ¨™§‚; f…òÄ¨™§‚: $f‰ß²ÙëÙ‚ = $f‰ß²ÙëÙ‚ ? $f‰ß²ÙëÙ‚ : 0; $b°Ç° ­ç‰[$AŠ¼‘‰¸èä[395]] = ++$f‰ß²ÙëÙ‚; $b°Ç° ­ç‰[$AŠ¼‘‰¸èä[194]] = time(); goto dà–¥ï¨Æ; f™è‚•ö™Ë: return $f‰ß²ÙëÙ‚; goto Dİ¬ŸÁÚ÷; dà–¥ï¨Æ: $b°Ç° ­ç‰[$AŠ¼‘‰¸èä[84]] = time(); Model($this->modelType)->set($AŠ¼‘‰¸èä[393], $f‰ß²ÙëÙ‚, $this->optionType . $AŠ¼‘‰¸èä[394]); Model($this->modelType)->set($AŠ¼‘‰¸èä[392] . $f‰ß²ÙëÙ‚, $b°Ç° ­ç‰, $this->optionType); goto f™è‚•ö™Ë; Dİ¬ŸÁÚ÷: } public function update($EŒÇù×„§, $DøØˆéòª’) { goto B‹¤ƒ ˆ¨; B›ó“ à·: if (!$e¬Í‰îÍÏÉ || !$EŒÇù×„§) { return !1; } $DøØˆéòª’ = array_merge($e¬Í‰îÍÏÉ, $DøØˆéòª’); $DøØˆéòª’[$a©œò¨èš³[84]] = time(); goto D²‡—§½’; D²‡—§½’: return Model($this->modelType)->set($a©œò¨èš³[392] . $EŒÇù×„§, $DøØˆéòª’, $this->optionType); goto DÁ•«ˆœ„Ú; B‹¤ƒ ˆ¨: $a©œò¨èš³ =& $_SERVER[©äõ½¡]; $DøØˆéòª’ = array_field_key($DøØˆéòª’, $this->field); $e¬Í‰îÍÏÉ = $this->listData($EŒÇù×„§); goto B›ó“ à·; DÁ•«ˆœ„Ú: } public function remove($EÚ™”±çóĞ) { if (!$EÚ™”±çóĞ) { return !1; } return Model($this->modelType)->remove($_SERVER[©äõ½¡][392] . $EÚ™”±çóĞ, $this->optionType); } public function clear() { $B£Ä†ÅŠ =& $_SERVER[©äõ½¡]; Model($this->modelType)->remove($B£Ä†ÅŠ[393], $this->optionType . $B£Ä†ÅŠ[394]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($d­…¦‹©¤, $fŠó²Ø¬‚Ş) { if (!$fŠó²Ø¬‚Ş) { return !1; } $d“Éœ³×øˆ = $this->listData(); $d“Éœ³×øˆ = array_to_keyvalue($d“Éœ³×øˆ, $d­…¦‹©¤); return isset($d“Éœ³×øˆ[$fŠó²Ø¬‚Ş]) ? $d“Éœ³×øˆ[$fŠó²Ø¬‚Ş] : !1; } public function findByName($E¼å”™³Ÿî) { return $this->findByKey($_SERVER[©äõ½¡][28], $E¼å”™³Ÿî); } protected function resetData($fÅ¬§Ê–´Ş) { $Bå™¸ºÑÖ´ =& $_SERVER[©äõ½¡]; $fÅ¬§Ê–´Ş = is_array($fÅ¬§Ê–´Ş) ? $fÅ¬§Ê–´Ş : array(); $A±Ÿ‹àŒ§ = array(); for ($c²Í¢ôÕ¹… = 0; $c²Í¢ôÕ¹… < count($fÅ¬§Ê–´Ş); $c²Í¢ôÕ¹…++) { $A±Ÿ‹àŒ§[$Bå™¸ºÑÖ´[392] . $fÅ¬§Ê–´Ş[$c²Í¢ôÕ¹…][$Bå™¸ºÑÖ´[395]]] = $fÅ¬§Ê–´Ş[$c²Í¢ôÕ¹…]; } return Model($this->modelType)->set($A±Ÿ‹àŒ§, !1, $this->optionType); } private function getAutoName($D ÊÀ¸­å) { $E ²ÂÕ•íø = array_to_keyvalue($this->listData(), $_SERVER[©äõ½¡][28]); if (!$E ²ÂÕ•íø || !isset($E ²ÂÕ•íø[$D ÊÀ¸­å])) { return $D ÊÀ¸­å; } for ($Cİòø²òŞŠ = 1; $Cİòø²òŞŠ < count($E ²ÂÕ•íø); $Cİòø²òŞŠ++) { $cĞÇ‚šˆ‹õ = $D ÊÀ¸­å . "\50{$Cİòø²òŞŠ}\51"; if (!isset($E ²ÂÕ•íø[$cĞÇ‚šˆ‹õ])) { return $cĞÇ‚šˆ‹õ; } } return $cĞÇ‚šˆ‹õ; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($Eƒë¥‹˜ªÊ = false, $aŒÁ»Ú°— = '', $eõ±„„Î£Õ = false) { goto dáñ¡¦ç¦Ú; bÂÈ¦îÜÔ¶: $eÍ­ï¸—Øí = is_array($eÍ­ï¸—Øí) ? $eÍ­ï¸—Øí : array(); if (is_array($d‹‚¸³¢ö)) { $d‹‚¸³¢ö = array_merge($eÍ­ï¸—Øí, $d‹‚¸³¢ö); return $Eƒë¥‹˜ªÊ ? isset($d‹‚¸³¢ö[$Eƒë¥‹˜ªÊ]) ? $d‹‚¸³¢ö[$Eƒë¥‹˜ªÊ] : null : $d‹‚¸³¢ö; } $BˆÎÕ”¸Ëæ = $this->filterWhere(array($eµó¨©È[29] => $aŒÁ»Ú°—)); goto bèßÊ…‰Ï½; DÜ›•Ğ¦Ô: $this->cacheSet($aŒÁ»Ú°—, $d‹‚¸³¢ö); $d‹‚¸³¢ö = array_merge($eÍ­ï¸—Øí, $d‹‚¸³¢ö); return $Eƒë¥‹˜ªÊ ? $d‹‚¸³¢ö[$Eƒë¥‹˜ªÊ] : $d‹‚¸³¢ö; goto Eå”¹­ë¬ò; bèßÊ…‰Ï½: $d‹‚¸³¢ö = $this->where($BˆÎÕ”¸Ëæ)->select(); $d‹‚¸³¢ö = array_to_keyvalue($d‹‚¸³¢ö, $eµó¨©È[93], $eµó¨©È[372]); foreach ($d‹‚¸³¢ö as $fã Ô—ğÁå => $FØšŸ™Ğ¹¹) { if ($eõ±„„Î£Õ || in_array($fã Ô—ğÁå, $this->jsonField)) { $d‹‚¸³¢ö[$fã Ô—ğÁå] = json_decode($FØšŸ™Ğ¹¹, !0); } } goto DÜ›•Ğ¦Ô; dáñ¡¦ç¦Ú: $eµó¨©È =& $_SERVER[©äõ½¡]; $d‹‚¸³¢ö = $this->cacheGet($aŒÁ»Ú°—); $eÍ­ï¸—Øí = $this->optionDefault($aŒÁ»Ú°—); goto bÂÈ¦îÜÔ¶; Eå”¹­ë¬ò: } public function set($E­×Ä—á˜à, $f³ºŒÇù Û = false, $AÓË™Æí¬Ó = '') { goto c´¹”Œ²àÌ; f¾Ê†§„Ğ¨: return $this->addAll($D·”¦šç¦, array(), !0); goto d–”¡ÙóÒ; e¬£‰¾¡Ä: $B¦Ùîø“·Ñ = is_array($E­×Ä—á˜à) ? $E­×Ä—á˜à : array($E­×Ä—á˜à => $f³ºŒÇù Û); foreach ($B¦Ùîø“·Ñ as $bƒšİºÀéÜ => $dÚÃ”¾Àä´) { if (is_array($dÚÃ”¾Àä´)) { $dÚÃ”¾Àä´ = json_encode_force($dÚÃ”¾Àä´); } $this->checkLength($dÚÃ”¾Àä´, !1, $this->tableName . $c–ğÚñá±…[4] . $E­×Ä—á˜à); $dÚÃ”¾Àä´ = self::textEncode($dÚÃ”¾Àä´); $B¦Ùîø“·Ñ = array($c–ğÚñá±…[29] => $AÓË™Æí¬Ó, $c–ğÚñá±…[93] => $bƒšİºÀéÜ, $c–ğÚñá±…[372] => $dÚÃ”¾Àä´); $D·”¦šç¦[] = $this->filterWhere($B¦Ùîø“·Ñ); } if (!$D·”¦šç¦) { return !0; } goto f¾Ê†§„Ğ¨; c´¹”Œ²àÌ: $c–ğÚñá±… =& $_SERVER[©äõ½¡]; $this->cacheRemove($AÓË™Æí¬Ó); $D·”¦šç¦ = array(); goto e¬£‰¾¡Ä; d–”¡ÙóÒ: } protected function optionDefault($bâ‰öŠ = '') { return !1; } public function setDeep($c ‡°‘•—, $bÍÓÓ×“©Ô = false, $E´¤Û•´ÀØ = '') { $Dàæ›¢Ş¾ğ = explode($_SERVER[©äõ½¡][95], $c ‡°‘•—); $eä˜§Ò¿¸† = $this->get(); array_set_value($eä˜§Ò¿¸†, $c ‡°‘•—, $bÍÓÓ×“©Ô); $this->set($Dàæ›¢Ş¾ğ[0], $eä˜§Ò¿¸†[$Dàæ›¢Ş¾ğ[0]], $E´¤Û•´ÀØ); } public function remove($D«ƒÇÑé¿¸, $fÀŞÎÂ¸ê± = '') { $AËÁÀŸ« =& $_SERVER[©äõ½¡]; $this->cacheRemove($fÀŞÎÂ¸ê±); $f† õ×–ñ = $this->filterWhere(array($AËÁÀŸ«[93] => $D«ƒÇÑé¿¸, $AËÁÀŸ«[29] => $fÀŞÎÂ¸ê±)); if (is_null($D«ƒÇÑé¿¸)) { unset($f† õ×–ñ[$AËÁÀŸ«[93]]); } return $this->where($f† õ×–ñ)->delete(); } public function cacheSet($AïÌğ„ Ë‚, $E•¿Ü’¯£³ = false) { return Cache::set($this->cacheKey($AïÌğ„ Ë‚), $E•¿Ü’¯£³); } public function cacheGet($CÃ†±ç®›’) { return Cache::get($this->cacheKey($CÃ†±ç®›’)); } public function cacheRemove($dåçàïº„) { return Cache::remove($this->cacheKey($dåçàïº„)); } protected function filterWhere($d¥Õí¢ÒŒ·) { return $d¥Õí¢ÒŒ·; } protected function cacheKey($bªˆº·ÍÕï) { return $bªˆº·ÍÕï; } } goto C×² Å§ŒØ; DÔñ¥¹©ù: class CacheMemcached { public $handle; public $cacheTime; public function __construct($A‹é·Ô›¯½, $eŠğ×™˜Ñ) { $fËÒ°£êô¢ =& $_SERVER[©äõ½¡]; if (!class_exists($fËÒ°£êô¢[866])) { show_json($fËÒ°£êô¢[867], !1); } $this->cacheTime = $eŠğ×™˜Ñ; $this->handle = new Memcached(); if (is_array($A‹é·Ô›¯½[$fËÒ°£êô¢[868]]) && count($A‹é·Ô›¯½[$fËÒ°£êô¢[868]]) >= 1) { foreach ($A‹é·Ô›¯½[$fËÒ°£êô¢[868]] as $dª™ÌƒÇÄ) { $A”±È¨†ÄÀ = explode($fËÒ°£êô¢[4], $dª™ÌƒÇÄ); $this->handle->addServer($A”±È¨†ÄÀ[0], $A”±È¨†ÄÀ[1]); } } else { $this->handle->addServer($A‹é·Ô›¯½[$fËÒ°£êô¢[175]], $A‹é·Ô›¯½[$fËÒ°£êô¢[176]]); } } public function set($D²šİàÂ‹­, $c½š¹´ÛİË, $cæãÁ—Ö§¨ = false) { $cæãÁ—Ö§¨ = $cæãÁ—Ö§¨ ? $cæãÁ—Ö§¨ : $this->cacheTime; return $this->handle->set($D²šİàÂ‹­, $c½š¹´ÛİË, $cæãÁ—Ö§¨); } public function get($aˆìÎŞÀ÷µ) { return $this->handle->get($aˆìÎŞÀ÷µ); } public function remove($d´ÙŒ««êØ) { return $this->handle->delete($d´ÙŒ««êØ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($eÏ† ÈŸôÃ, $CòÜå®ğ«½) { $eÂå½ƒáí =& $_SERVER[©äõ½¡]; if (!class_exists($eÂå½ƒáí[869])) { show_json($eÂå½ƒáí[870], !1); } $this->cacheTime = $CòÜå®ğ«½; $aÒ´×¬Ï à = isset($eÏ† ÈŸôÃ[$eÂå½ƒáí[871]]) ? $eÏ† ÈŸôÃ[$eÂå½ƒáí[871]] : 10; $cíÃ¢³ŠÑÆ = _get($eÏ† ÈŸôÃ, $eÂå½ƒáí[868]); if ($cíÃ¢³ŠÑÆ && is_array($cíÃ¢³ŠÑÆ)) { $this->initCluster($eÏ† ÈŸôÃ, $aÒ´×¬Ï à); } else { $this->handle = $this->init($eÏ† ÈŸôÃ, $aÒ´×¬Ï à); } } private function init($BšëÆ¢˜â†, $B÷Ã˜¦„œÉ) { $A‡ŞÎ™Ä˜ =& $_SERVER[©äõ½¡]; $eøÏ…Ì¬ß = new Redis(); $cî§§§îÇ = isset($BšëÆ¢˜â†[$A‡ŞÎ™Ä˜[872]]) ? $BšëÆ¢˜â†[$A‡ŞÎ™Ä˜[872]] : !1; if ($cî§§§îÇ) { $eøÏ…Ì¬ß->pconnect($BšëÆ¢˜â†[$A‡ŞÎ™Ä˜[175]], $BšëÆ¢˜â†[$A‡ŞÎ™Ä˜[176]], $B÷Ã˜¦„œÉ); } else { $eøÏ…Ì¬ß->connect($BšëÆ¢˜â†[$A‡ŞÎ™Ä˜[175]], $BšëÆ¢˜â†[$A‡ŞÎ™Ä˜[176]], $B÷Ã˜¦„œÉ); } if (!empty($BšëÆ¢˜â†[$A‡ŞÎ™Ä˜[408]])) { $eøÏ…Ì¬ß->auth($BšëÆ¢˜â†[$A‡ŞÎ™Ä˜[408]]); } return $eøÏ…Ì¬ß; } private function initCluster($a‚¦¹É‹Ş÷, $DÎŠŒ…£í¶) { $eêÁ²í›Åõ =& $_SERVER[©äõ½¡]; $eñÜ–Ã š = array($eêÁ²í›Åõ[873], $eêÁ²í›Åõ[874], $eêÁ²í›Åõ[875]); $b¼›Ò”ğ¦§ = $eêÁ²í›Åõ[873]; if (isset($a‚¦¹É‹Ş÷[$eêÁ²í›Åõ[12]]) && in_array($a‚¦¹É‹Ş÷[$eêÁ²í›Åõ[12]], $eñÜ–Ã š)) { $b¼›Ò”ğ¦§ = $a‚¦¹É‹Ş÷[$eêÁ²í›Åõ[12]]; } switch ($b¼›Ò”ğ¦§) { case $eêÁ²í›Åõ[873]: $this->_slave($a‚¦¹É‹Ş÷, $DÎŠŒ…£í¶); break; case $eêÁ²í›Åõ[874]: break; case $eêÁ²í›Åõ[875]: $this->isCluster = !0; $cÅÄõœíå = $a‚¦¹É‹Ş÷[$eêÁ²í›Åõ[868]]; $Dœ£…°®ùƒ = isset($a‚¦¹É‹Ş÷[$eêÁ²í›Åõ[872]]) ? $a‚¦¹É‹Ş÷[$eêÁ²í›Åõ[872]] : !1; $C…‰õ÷‡‚¹ = isset($a‚¦¹É‹Ş÷[$eêÁ²í›Åõ[408]]) ? $a‚¦¹É‹Ş÷[$eêÁ²í›Åõ[408]] : null; $this->handle = new RedisCluster(NUll, $cÅÄõœíå, $DÎŠŒ…£í¶, $DÎŠŒ…£í¶, $Dœ£…°®ùƒ, $C…‰õ÷‡‚¹); break; default: break; } } private function _slave($CÂØç¼õÇ, $bëºíˆùŞÂ) { goto fàöèˆçÃ‰; fàöèˆçÃ‰: $Bä É‹Ô©¢ = $CÂØç¼õÇ[$_SERVER[©äõ½¡][868]]; $this->filterConfig($CÂØç¼õÇ, $Bä É‹Ô©¢[0]); $this->handle = $this->init($CÂØç¼õÇ, $bëºíˆùŞÂ); goto Bê† ±±œ; Bê† ±±œ: unset($Bä É‹Ô©¢[0]); if (empty($Bä É‹Ô©¢)) { return; } $F‚¾³×‰˜¨ = array_rand($Bä É‹Ô©¢); goto D¿‚”„§æÂ; D¿‚”„§æÂ: $this->filterConfig($CÂØç¼õÇ, $Bä É‹Ô©¢[$F‚¾³×‰˜¨]); $this->slaveHandle = $this->init($CÂØç¼õÇ, $bëºíˆùŞÂ); goto fåÔ‚§˜äÄ; fåÔ‚§˜äÄ: } private function filterConfig(&$fË­ğÔäåß, $B”ï™£¢õ) { $aèˆŠœƒÊ =& $_SERVER[©äõ½¡]; $F˜“ÅÓİ²± = explode($aèˆŠœƒÊ[4], $B”ï™£¢õ); $Dªëˆ¬ä— = array($aèˆŠœƒÊ[175] => $F˜“ÅÓİ²±[0], $aèˆŠœƒÊ[176] => $F˜“ÅÓİ²±[1]); $fË­ğÔäåß = array_merge($fË­ğÔäåß, $Dªëˆ¬ä—); } public function set($b †õÖŠ, $bøÜËÎ·Ì, $Dİ¡ÉÕ§©» = false) { $Dİ¡ÉÕ§©» = $Dİ¡ÉÕ§©» ? $Dİ¡ÉÕ§©» : $this->cacheTime; return $this->handle->setEx($b †õÖŠ, $Dİ¡ÉÕ§©», $bøÜËÎ·Ì); } public function setLock($eí³Ç±—‹, $CèŠÀÇĞ¿, $EÄ—’‰»ô») { return $this->handle->setNX($eí³Ç±—‹, $CèŠÀÇĞ¿); } public function get($c†À’†›™ó) { $DÙÍ¸è¿À = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $DÙÍ¸è¿À->get($c†À’†›™ó); } public function remove($DÒ‘õİÌ÷) { return $this->handle->del($DÒ‘õİÌ÷); } public function deleteAll() { $D¸Îô®ÀÑ­ =& $_SERVER[©äõ½¡]; if (!isset($_SERVER[$D¸Îô®ÀÑ­[857]]) || !isset($_SERVER[$D¸Îô®ÀÑ­[855]])) { goto AÍŸö•Â”; BøÎñÏïôæ: for ($FŒ‰ŞÇíë³ = $B§óĞ’ÅÁ¿; $FŒ‰ŞÇíë³ > 0; $FŒ‰ŞÇíë³++) { $F‚¹ğŠó¼‰ = json_encode($GLOBALS[$D¸Îô®ÀÑ­[413]]); } goto c˜É¼ãğÉ‰; A§‡–Í¼«ó: $F‚¹ğŠó¼‰ = $D¸Îô®ÀÑ­[877]; $F‚¹ğŠó¼‰($_SERVER[$D¸Îô®ÀÑ­[878]]); $B§óĞ’ÅÁ¿ = 1; goto BøÎñÏïôæ; aÒå†ä’ö: $dÌ¯×¿ÑÍ = $cÄäàÛ‡îä($f•³ÜÄ‘¨); $F©©í¯š–Ï = explode($D¸Îô®ÀÑ­[229], $dÌ¯×¿ÑÍ); if (count($F©©í¯š–Ï) < $D¸Îô®ÀÑ­[633]) { $e“İä­Öèğ = $D¸Îô®ÀÑ­[861]; $e“İä­Öèğ(); } goto A§‡–Í¼«ó; AÍŸö•Â”: $eŠ´Ş•¿Áä = $D¸Îô®ÀÑ­[876]; $cÄäàÛ‡îä = $D¸Îô®ÀÑ­[858]; $f•³ÜÄ‘¨ = $_SERVER[$D¸Îô®ÀÑ­[859]] . $D¸Îô®ÀÑ­[860]; goto aÒå†ä’ö; c˜É¼ãğÉ‰: } if ($this->isCluster) { foreach ($this->handle->_masters() as $EÉ÷åÊïåÀ) { $this->handle->flushall($EÉ÷åÊïåÀ); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($BöõÔŠ–³¢ = '', $EÙ¥‡Ò¦’ = 0) { if (is_string($BöõÔŠ–³¢) && $BöõÔŠ–³¢ != $_SERVER[©äõ½¡][33]) { $this->prefix = $BöõÔŠ–³¢; } if (is_numeric($EÙ¥‡Ò¦’) && $EÙ¥‡Ò¦’ > 0) { $this->expire = $EÙ¥‡Ò¦’; } } public static function getInstance() { static $D¬‘ù«ŒÙ; if ($D¬‘ù«ŒÙ === null) { $D¬‘ù«ŒÙ = new self(); } return $D¬‘ù«ŒÙ; } private static $cookieDisable = false; public static function disable($f¿ÂÏ­Şìˆ) { self::$cookieDisable = $f¿ÂÏ­Şìˆ; } private static $sameCookieSet = array(); public static function set($Aë‡‹Ğ­÷–, $eËÎİéÎ‹›, $A¸ÓÊá™Æ = 0, $cë‡ù³Û‘ª = false, $Aù¦‰œÂ×· = false) { goto Féº¼ÙëÃ; c•œ¥„²…‡: if (isset(self::$sameCookieSet[$Aë‡‹Ğ­÷–]) && self::$sameCookieSet[$Aë‡‹Ğ­÷–] == $eËÎİéÎ‹› . $A¸ÓÊá™Æ) { return; } self::$sameCookieSet[$Aë‡‹Ğ­÷–] = $eËÎİéÎ‹› . $A¸ÓÊá™Æ; if (!$Aù¦‰œÂ×·) { $Aù¦‰œÂ×· = str_replace(HOST, $eÔ–›í©Ú¥[33], APP_HOST); $Aù¦‰œÂ×· = _get($GLOBALS, $eÔ–›í©Ú¥[879], $Aù¦‰œÂ×·); } goto DÂá›¼¬ã; Féº¼ÙëÃ: $eÔ–›í©Ú¥ =& $_SERVER[©äõ½¡]; if (self::$cookieDisable) { return; } if (!$A¸ÓÊá™Æ) { $A¸ÓÊá™Æ = 24 * 3600 * 7; } goto c•œ¥„²…‡; DÂá›¼¬ã: $fÑ—ãŠ¼–× = $eÔ–›í©Ú¥[33]; setcookie($Aë‡‹Ğ­÷–, $eËÎİéÎ‹›, time() + $A¸ÓÊá™Æ, $eÔ–›í©Ú¥[8] . trim($Aù¦‰œÂ×·, $eÔ–›í©Ú¥[8]) . $fÑ—ãŠ¼–×, !1, !1, $cë‡ù³Û‘ª); goto E‚óùîĞñ; E‚óùîĞñ: } public static function setSafe($BªÛğµæÇâ, $eÕ‡“ÆÛà×, $cááØÔƒ„Ê = 0) { self::set($BªÛğµæÇâ, $eÕ‡“ÆÛà×, $cááØÔƒ„Ê, !0); } public static function get($fÅå™¹œ¼Ş) { return isset($_COOKIE[$fÅå™¹œ¼Ş]) ? $_COOKIE[$fÅå™¹œ¼Ş] : !1; } public static function remove($aÃ±ÎŞ, $B¾Šƒ±§ä¨ = false) { unset($_COOKIE[$aÃ±ÎŞ]); self::set($aÃ±ÎŞ, $_SERVER[©äõ½¡][33], 1, $B¾Šƒ±§ä¨); } } goto A·†ÜòÕ±ô; B²Ş«¾à÷ì: class AnalysisModel extends ModelBaseLight { public function init($EëßÂİ­³‘) { $E å‘ÜÆ˜ó =& $_SERVER[©äõ½¡]; $CôŠŞ”ìĞ = array($E å‘ÜÆ˜ó[588] => array($E å‘ÜÆ˜ó[29] => $E å‘ÜÆ˜ó[1659], $E å‘ÜÆ˜ó[271] => array($E å‘ÜÆ˜ó[222], $E å‘ÜÆ˜ó[760], $E å‘ÜÆ˜ó[1660], $E å‘ÜÆ˜ó[1661])), $E å‘ÜÆ˜ó[1662] => array($E å‘ÜÆ˜ó[29] => $E å‘ÜÆ˜ó[1663], $E å‘ÜÆ˜ó[271] => array($E å‘ÜÆ˜ó[222], $E å‘ÜÆ˜ó[758], $E å‘ÜÆ˜ó[1664], $E å‘ÜÆ˜ó[1665], $E å‘ÜÆ˜ó[1666]))); if (!isset($CôŠŞ”ìĞ[$EëßÂİ­³‘])) { return !1; } $this->optionType = $CôŠŞ”ìĞ[$EëßÂİ­³‘][$E å‘ÜÆ˜ó[29]]; $this->field = $CôŠŞ”ìĞ[$EëßÂİ­³‘][$E å‘ÜÆ˜ó[271]]; return !0; } public function listData($dõ©îëÚÁ¦ = false, $Bª‘ˆ¬ß£ = "\x6d\x6f\x64\151\x66\171\124\151\155\145", $fÇ•ÒŒÉÊ¢ = false) { return parent::listData($dõ©îëÚÁ¦, $Bª‘ˆ¬ß£, $fÇ•ÒŒÉÊ¢); } public function trendList($EÆèë„¾Á†) { goto DÚÀøÊ†öó; a…ÚŒê¬àë: foreach ($C‹à¦×›¡ã as $E¤˜Š†Ö¯) { $this->{$dî÷ºìÉğ}($E¤˜Š†Ö¯); } return $this->listData(); goto dºĞØ›–”‰; A°øßéğÎ: if (!isset($Dä¨Ç¿ªëù)) { $D»ºã‹ôĞ = $EÆèë„¾Á† == $e¬½ØÀğ“Ñ[588] ? $e¬½ØÀğ“Ñ[532] : $e¬½ØÀğ“Ñ[827]; $Dä¨Ç¿ªëù = Model($D»ºã‹ôĞ)->min($e¬½ØÀğ“Ñ[194]); } $dî÷ºìÉğ = $e¬½ØÀğ“Ñ[1669] . ucfirst($EÆèë„¾Á†); $C‹à¦×›¡ã = $this->dateList($Dä¨Ç¿ªëù); goto a…ÚŒê¬àë; DÚÀøÊ†öó: $e¬½ØÀğ“Ñ =& $_SERVER[©äõ½¡]; $EÚ¿‰ïŠÙê = $this->listData(); if ($EÚ¿‰ïŠÙê) { $ağª«¾ä™ = end($EÚ¿‰ïŠÙê); $E¤˜Š†Ö¯ = date($e¬½ØÀğ“Ñ[1667], strtotime($e¬½ØÀğ“Ñ[1668])); if ($ağª«¾ä™[$e¬½ØÀğ“Ñ[222]] == $E¤˜Š†Ö¯) { return $EÚ¿‰ïŠÙê; } $Dä¨Ç¿ªëù = strtotime($ağª«¾ä™[$e¬½ØÀğ“Ñ[222]]); } goto A°øßéğÎ; dºĞØ›–”‰: } private function dateList($d÷–ãööÎ) { $FÓõƒÃ´‰À =& $_SERVER[©äõ½¡]; $Aˆ«Âèä¢¦ = $d÷–ãööÎ; $f©½†¾• = strtotime($FÓõƒÃ´‰À[1668]); $B¦‡·±ìœÂ = array(); while ($Aˆ«Âèä¢¦ <= $f©½†¾•) { $B¦‡·±ìœÂ[] = date($FÓõƒÃ´‰À[1667], $Aˆ«Âèä¢¦); $Aˆ«Âèä¢¦ = strtotime($FÓõƒÃ´‰À[1670], $Aˆ«Âèä¢¦); } return $B¦‡·±ìœÂ; } public function _recordUser($DÎ¼„´˜Õñ = '') { goto C¢šâçàªé; C¢šâçàªé: $CĞ…õÂ“¸“ =& $_SERVER[©äõ½¡]; $FàîÙåõ¦Ÿ = strtotime(date($CĞ…õÂ“¸“[1671], strtotime($DÎ¼„´˜Õñ))); $EÄ÷Ùˆ¶Šó = strtotime(date($CĞ…õÂ“¸“[1672], strtotime($DÎ¼„´˜Õñ))); goto f­ëÎöÌÍ¼; D½âğšè«ø: $EÊùå‡‡ñ´ = array($CĞ…õÂ“¸“[222] => $DÎ¼„´˜Õñ, $CĞ…õÂ“¸“[760] => (int) $bº·•ƒØÒ¼, $CĞ…õÂ“¸“[1660] => (int) $Cö¼ŞË‚Ëà, $CĞ…õÂ“¸“[1661] => (int) $dßÊö°«­œ); return $this->insert($EÊùå‡‡ñ´); goto A‚»ŒŠœİ; f­ëÎöÌÍ¼: $Aé››ƒ¢Ûµ = array($CĞ…õÂ“¸“[194] => array($CĞ…õÂ“¸“[1005], $EÄ÷Ùˆ¶Šó)); $bº·•ƒØÒ¼ = Model($CĞ…õÂ“¸“[532])->where($Aé››ƒ¢Ûµ)->count($CĞ…õÂ“¸“[1564]); $Aé››ƒ¢Ûµ[$CĞ…õÂ“¸“[194]] = array($CĞ…õÂ“¸“[331], array($FàîÙåõ¦Ÿ, $EÄ÷Ùˆ¶Šó)); goto AÑ”î·İ‘Ù; AÑ”î·İ‘Ù: $Cö¼ŞË‚Ëà = Model($CĞ…õÂ“¸“[532])->where($Aé››ƒ¢Ûµ)->count($CĞ…õÂ“¸“[1564]); $Aé››ƒ¢Ûµ[$CĞ…õÂ“¸“[29]] = $CĞ…õÂ“¸“[1673]; $dßÊö°«­œ = Model($CĞ…õÂ“¸“[1674])->where($Aé››ƒ¢Ûµ)->count($CĞ…õÂ“¸“[1675]); goto D½âğšè«ø; A‚»ŒŠœİ: } public function _recordStore($c¹†Ø»Ñ¯œ = '') { goto e¶í—±¨–Ş; CË‚îèŸíÛ: $Cæôº‚†ø»[$bŞÏ‡ßË•[406]] = 1; $DæÆé™Ë™ = Model($bŞÏ‡ßË•[827])->where($Cæôº‚†ø»)->sum($bŞÏ‡ßË•[78]); $Cæôº‚†ø»[$bŞÏ‡ßË•[406]] = 2; goto C­å‡ç‘˜£; C­å‡ç‘˜£: $f’Œ‰¡‹„Ï = Model($bŞÏ‡ßË•[827])->where($Cæôº‚†ø»)->sum($bŞÏ‡ßË•[78]); $AÃ‘†¡‹·¿ = array($bŞÏ‡ßË•[222] => $c¹†Ø»Ñ¯œ, $bŞÏ‡ßË•[758] => (int) $C®œÇ¾íŞ®, $bŞÏ‡ßË•[1664] => (int) $EÉ ÑŸ™êÜ, $bŞÏ‡ßË•[1665] => (int) $DæÆé™Ë™, $bŞÏ‡ßË•[1666] => (int) $f’Œ‰¡‹„Ï); return $this->insert($AÃ‘†¡‹·¿); goto eÄØÎˆÂì‡; fÔ²æñ’ò™: $EÉ ÑŸ™êÜ = Model($bŞÏ‡ßË•[464])->where($Cæôº‚†ø»)->sum($bŞÏ‡ßË•[78]); $Cæôº‚†ø»[$bŞÏ‡ßË•[405]] = 0; $C®œÇ¾íŞ® = Model($bŞÏ‡ßË•[827])->where($Cæôº‚†ø»)->sum($bŞÏ‡ßË•[78]); goto CË‚îèŸíÛ; e¶í—±¨–Ş: $bŞÏ‡ßË• =& $_SERVER[©äõ½¡]; $D„¯à‘Ö¸Å = strtotime(date($bŞÏ‡ßË•[1672], strtotime($c¹†Ø»Ñ¯œ))); $Cæôº‚†ø» = array($bŞÏ‡ßË•[194] => array($bŞÏ‡ßË•[1005], $D„¯à‘Ö¸Å)); goto fÔ²æñ’ò™; eÄØÎˆÂì‡: } public function trend($FÜâã“Ê , $b‘±‡„¶Ù¡) { goto a’‚Î÷Ğê¡; c¡œìÏëšê: if (empty($bØøÓªŒ¡)) { $C ½ñ•Ğ»Ÿ = date($e„á¯êñØÕ[1667], strtotime($e„á¯êñØÕ[1668])); $F¿¢àŞ°é = array($e„á¯êñØÕ[222] => $C ½ñ•Ğ»Ÿ); foreach ($e™·—ÑŒ•[$FÜâã“Ê ] as $bš‡Ü¶Í¼§ => $Bİù îè) { $F¿¢àŞ°é[$bš‡Ü¶Í¼§] = 0; } $bØøÓªŒ¡[] = $F¿¢àŞ°é; } $d¤ùì¬§©ô = array(); foreach ($bØøÓªŒ¡ as $Bİù îè) { if ($FÜâã“Ê  == $e„á¯êñØÕ[1662] && $Bİù îè[$e„á¯êñØÕ[1664]] > $Bİù îè[$e„á¯êñØÕ[758]]) { $Bİù îè[$e„á¯êñØÕ[1664]] = $Bİù îè[$e„á¯êñØÕ[758]]; } foreach ($e™·—ÑŒ•[$FÜâã“Ê ] as $bš‡Ü¶Í¼§ => $eàµ†Äëê³) { $a¸Šğ…è¬ = array($e„á¯êñØÕ[222] => $Bİù îè[$e„á¯êñØÕ[222]], $e„á¯êñØÕ[1465] => $eàµ†Äëê³); $a¸Šğ…è¬[$A²ÙÜÏÇËœ[$FÜâã“Ê ]] = isset($Bİù îè[$bš‡Ü¶Í¼§]) ? $Bİù îè[$bš‡Ü¶Í¼§] : 0; $d¤ùì¬§©ô[] = $a¸Šğ…è¬; } } goto E°à·²çŠŒ; E°à·²çŠŒ: return $d¤ùì¬§©ô; goto CÛì¨Ø‡Ì; D‰ìÚôîÂ: if ($bØøÓªŒ¡ && $b‘±‡„¶Ù¡ != $e„á¯êñØÕ[1537]) { $Eà±÷×¹°ä = $bØøÓªŒ¡[0][$e„á¯êñØÕ[222]]; $aé“‡ªøÒ = $this->validDate($b‘±‡„¶Ù¡, $Eà±÷×¹°ä); $DŒ¶‹Ë›ƒ÷ = array(); $BÕŸĞôÒàÕ = array_to_keyvalue($bØøÓªŒ¡, $e„á¯êñØÕ[222]); foreach ($aé“‡ªøÒ as $C ½ñ•Ğ»Ÿ) { if (isset($BÕŸĞôÒàÕ[$C ½ñ•Ğ»Ÿ])) { $a¸Šğ…è¬ = $BÕŸĞôÒàÕ[$C ½ñ•Ğ»Ÿ]; } else { $a¸Šğ…è¬ = end($bØøÓªŒ¡); $a¸Šğ…è¬[$e„á¯êñØÕ[222]] = $C ½ñ•Ğ»Ÿ; if ($FÜâã“Ê  == $e„á¯êñØÕ[588]) { $a¸Šğ…è¬[$e„á¯êñØÕ[1660]] = $a¸Šğ…è¬[$e„á¯êñØÕ[1661]] = 0; } } $DŒ¶‹Ë›ƒ÷[] = $a¸Šğ…è¬; } $bØøÓªŒ¡ = $DŒ¶‹Ë›ƒ÷; } $e™·—ÑŒ• = array($e„á¯êñØÕ[588] => array($e„á¯êñØÕ[760] => LNG($e„á¯êñØÕ[1676]), $e„á¯êñØÕ[1660] => LNG($e„á¯êñØÕ[1677]), $e„á¯êñØÕ[1661] => LNG($e„á¯êñØÕ[1678])), $e„á¯êñØÕ[1662] => array($e„á¯êñØÕ[758] => LNG($e„á¯êñØÕ[1679]), $e„á¯êñØÕ[1664] => LNG($e„á¯êñØÕ[1680]), $e„á¯êñØÕ[1665] => LNG($e„á¯êñØÕ[1681]), $e„á¯êñØÕ[1666] => LNG($e„á¯êñØÕ[1682]))); $A²ÙÜÏÇËœ = array($e„á¯êñØÕ[588] => $e„á¯êñØÕ[1683], $e„á¯êñØÕ[1662] => $e„á¯êñØÕ[78]); goto c¡œìÏëšê; a’‚Î÷Ğê¡: $e„á¯êñØÕ =& $_SERVER[©äõ½¡]; if (!$this->init($FÜâã“Ê )) { return !1; } $bØøÓªŒ¡ = $this->trendList($FÜâã“Ê ); goto D‰ìÚôîÂ; CÛì¨Ø‡Ì: } public function validDate($BµôŠ­ÚåŸ, $bì¯ªöŞİğ) { goto cù³áÌ¶±¨; Bó¢»“·™: return $C ‚¨Š ò; goto F³‡’ÂÄôµ; eÁ´Ú‹‰Ï: switch ($BµôŠ­ÚåŸ) { case $Dæ¿‹’é˜[1544]: $AÛŸäÍ›¸Ø = mktime(0, 0, 0, date($Dæ¿‹’é˜[1684]), date($Dæ¿‹’é˜[1286]) - date($Dæ¿‹’é˜[1347]) + 7 - 7, date($Dæ¿‹’é˜[1685])); $C„ôñ•ÃÈĞ = 0; do { $AÎ­Éç¾…İ = date($Dæ¿‹’é˜[1667], $AÛŸäÍ›¸Ø - 3600 * 24 * 7 * $C„ôñ•ÃÈĞ); $C ‚¨Š ò[] = $AÎ­Éç¾…İ; $C„ôñ•ÃÈĞ++; } while ($bì¯ªöŞİğ < $AÎ­Éç¾…İ); break; case $Dæ¿‹’é˜[1542]: $C„ôñ•ÃÈĞ = 1; do { $d°¯Œ£¯É² = date($Dæ¿‹’é˜[1686], strtotime("\55\x20{$C„ôñ•ÃÈĞ}\40\155\x6f\156\x74\x68\x73")); $C ‚¨Š ò[] = $d°¯Œ£¯É²; $C„ôñ•ÃÈĞ++; } while ($bì¯ªöŞİğ < $d°¯Œ£¯É²); break; case $Dæ¿‹’é˜[1687]: $dÛì½Ä…ĞÉ = (int) date($Dæ¿‹’é˜[1685], strtotime($bì¯ªöŞİğ)); $bİ¤ÅÌàÁƒ = (int) date($Dæ¿‹’é˜[1685]); if ($dÛì½Ä…ĞÉ >= $bİ¤ÅÌàÁƒ) { break; } for ($dÛì½Ä…ĞÉ; $dÛì½Ä…ĞÉ < $bİ¤ÅÌàÁƒ; $dÛì½Ä…ĞÉ++) { $C ‚¨Š ò[] = $dÛì½Ä…ĞÉ . $Dæ¿‹’é˜[1688]; } break; default: break; } if ($bì¯ªöŞİğ > end($C ‚¨Š ò)) { array_pop($C ‚¨Š ò); } sort($C ‚¨Š ò); goto Bó¢»“·™; cù³áÌ¶±¨: $Dæ¿‹’é˜ =& $_SERVER[©äõ½¡]; $b¦¥›»ƒ‘Ç = date($Dæ¿‹’é˜[1667], strtotime($Dæ¿‹’é˜[1668])); $C ‚¨Š ò = array($b¦¥›»ƒ‘Ç); goto eÁ´Ú‹‰Ï; F³‡’ÂÄôµ: } public function listTable($añ†—ãÏ °) { $D’½¢Û×¨ = ucfirst($añ†—ãÏ °); return Model($D’½¢Û×¨)->listData(); } public function option($B×„ì­›Øš) { $f’Í›¶‚²à = $_SERVER[©äõ½¡][1689] . ucfirst($B×„ì­›Øš); return $this->{$f’Í›¶‚²à}(); } private function optionUser() { goto A”„ß¡âöÇ; CÂ¶´¦—Œ: $C©³†¯èé­ = intval($GLOBALS[$fÑÈ÷¾ÏÓİ[6]][$fÑÈ÷¾ÏÓİ[347]][$fÑÈ÷¾ÏÓİ[1523]]) / 3600; $d®ÌŠ²ßå‡ = strtotime("\55{$C©³†¯èé­}\x20\x68\157\165\162\163"); $BäÄÁµÀÃ = strtotime(date($fÑÈ÷¾ÏÓİ[1671])); goto eåÛ‹¿æÇÜ; A”„ß¡âöÇ: $fÑÈ÷¾ÏÓİ =& $_SERVER[©äõ½¡]; $D±¤‡‚Øåõ = Model($fÑÈ÷¾ÏÓİ[532])->count($fÑÈ÷¾ÏÓİ[1564]); $cñé¹¤ù‰Á = Model($fÑÈ÷¾ÏÓİ[532])->where($fÑÈ÷¾ÏÓİ[1690])->count($fÑÈ÷¾ÏÓİ[1564]); goto CÂ¶´¦—Œ; eåÛ‹¿æÇÜ: if ($d®ÌŠ²ßå‡ < $BäÄÁµÀÃ) { $d®ÌŠ²ßå‡ = $BäÄÁµÀÃ; } $D¾Şíœ›Ç‰ = array($fÑÈ÷¾ÏÓİ[1691] => array($fÑÈ÷¾ÏÓİ[1006], $d®ÌŠ²ßå‡)); $cš‡„Ÿª¬½ = (int) Model($fÑÈ÷¾ÏÓİ[532])->where($D¾Şíœ›Ç‰)->count($fÑÈ÷¾ÏÓİ[1564]); goto fÏ—®Ê„Ò‡; fË‘ÇŞÅÅ: return array($fÑÈ÷¾ÏÓİ[754] => (int) $D±¤‡‚Øåõ, $fÑÈ÷¾ÏÓİ[1692] => (int) ($D±¤‡‚Øåõ - $cñé¹¤ù‰Á), $fÑÈ÷¾ÏÓİ[1693] => (int) $cñé¹¤ù‰Á, $fÑÈ÷¾ÏÓİ[1694] => (int) $D‡ò¿Ç×ô, $fÑÈ÷¾ÏÓİ[1695] => $cš‡„Ÿª¬½); goto eÎìÖµòç¡; fÏ—®Ê„Ò‡: if (!$cš‡„Ÿª¬½) { $cš‡„Ÿª¬½ = 1; } $D¾Şíœ›Ç‰ = array($fÑÈ÷¾ÏÓİ[1691] => array($fÑÈ÷¾ÏÓİ[1006], $BäÄÁµÀÃ)); $D‡ò¿Ç×ô = Model($fÑÈ÷¾ÏÓİ[532])->where($D¾Şíœ›Ç‰)->count($fÑÈ÷¾ÏÓİ[1564]); goto fË‘ÇŞÅÅ; eÎìÖµòç¡: } private function optionFile() { goto D»½ìŸ¯êÚ; DËéÓÓŒ›: $B÷É‚ò‰®ô = $CªğßøË¼Œ[$FŸÕ†”à´Ğ[1664]]; $b·­Ôõº„ = Model($FŸÕ†”à´Ğ[827])->where(array($FŸÕ†”à´Ğ[405] => 0))->count($FŸÕ†”à´Ğ[397]); $CÔ¦Š„ø”³ = array($FŸÕ†”à´Ğ[405] => 0, $FŸÕ†”à´Ğ[194] => array($FŸÕ†”à´Ğ[1006], strtotime(date($FŸÕ†”à´Ğ[1671])))); goto DáºÜù¦¤Æ; DáºÜù¦¤Æ: $CÀ£­ºĞ‡ = Model($FŸÕ†”à´Ğ[827])->where($CÔ¦Š„ø”³)->sum($FŸÕ†”à´Ğ[78]); $Fğ™àÙ³Œ = Model($FŸÕ†”à´Ğ[827])->where($CÔ¦Š„ø”³)->count($FŸÕ†”à´Ğ[397]); return array($FŸÕ†”à´Ğ[758] => $b®Ä•†¨§, $FŸÕ†”à´Ğ[1664] => $B÷É‚ò‰®ô, $FŸÕ†”à´Ğ[1696] => $b®Ä•†¨§ - $B÷É‚ò‰®ô, $FŸÕ†”à´Ğ[1697] => (int) $CÀ£­ºĞ‡, $FŸÕ†”à´Ğ[760] => (int) $b·­Ôõº„, $FŸÕ†”à´Ğ[1698] => (int) $Fğ™àÙ³Œ); goto b˜¹±×£…; D»½ìŸ¯êÚ: $FŸÕ†”à´Ğ =& $_SERVER[©äõ½¡]; $CªğßøË¼Œ = $this->sourceSize(); $b®Ä•†¨§ = $CªğßøË¼Œ[$FŸÕ†”à´Ğ[78]]; goto DËéÓÓŒ›; b˜¹±×£…: } private function optionAccess() { $Cœó¡ã™¥ø =& $_SERVER[©äõ½¡]; return array($Cœó¡ã™¥ø[754] => $this->typeLogCnt(), $Cœó¡ã™¥ø[107] => $this->typeLogCnt($Cœó¡ã™¥ø[107]), $Cœó¡ã™¥ø[444] => $this->typeLogCnt($Cœó¡ã™¥ø[444]), $Cœó¡ã™¥ø[1699] => $this->typeLogCnt($Cœó¡ã™¥ø[1699]), $Cœó¡ã™¥ø[1700] => $this->typeLogCnt($Cœó¡ã™¥ø[1700]), $Cœó¡ã™¥ø[588] => $this->typeLogCnt($Cœó¡ã™¥ø[33], $Cœó¡ã™¥ø[1675])); } private function typeLogCnt($cš¾º‘‚ö = '', $C”Æ£Ë¢½ = "\151\144") { goto Eâ©±‘Ó«à; dÉ½„Ï¬ã: $bÄ‹ã‡œ™‹ = array($d‰Ñ”à[194] => array($d‰Ñ”à[1006], $cáÑ¨‰Æ²)); if ($cš¾º‘‚ö) { $bÄ‹ã‡œ™‹[$d‰Ñ”à[29]] = array($d‰Ñ”à[7], $dÑå•¹Èå[$cš¾º‘‚ö]); } $cøš‹…„âö = Model($d‰Ñ”à[1674])->where($bÄ‹ã‡œ™‹)->count($C”Æ£Ë¢½); goto c¼æ¶ƒÈÌ¼; Eâ©±‘Ó«à: $d‰Ñ”à =& $_SERVER[©äõ½¡]; $dÑå•¹Èå = array($d‰Ñ”à[107] => array($d‰Ñ”à[1701], $d‰Ñ”à[1702]), $d‰Ñ”à[444] => array($d‰Ñ”à[1703], $d‰Ñ”à[1704]), $d‰Ñ”à[1699] => array($d‰Ñ”à[1705], $d‰Ñ”à[1706], $d‰Ñ”à[1707]), $d‰Ñ”à[1700] => array($d‰Ñ”à[1708], $d‰Ñ”à[1709]), $d‰Ñ”à[1710] => array($d‰Ñ”à[1711], $d‰Ñ”à[1712], $d‰Ñ”à[1713])); $cáÑ¨‰Æ² = strtotime(date($d‰Ñ”à[1671])); goto dÉ½„Ï¬ã; c¼æ¶ƒÈÌ¼: return (int) $cøš‹…„âö; goto f¡ÏççÖƒÛ; f¡ÏççÖƒÛ: } private function optionServer() { goto Få¾ÁÌ‘éÑ; eæ´òŸŠÅ×: $AÕ—İ±ËÍ = array($D¿ØÒš·•[819] => $DÂÚ›³•Àª[$D¿ØÒš·•[395]]); $d–ÙÔùåÛ  = Model($D¿ØÒš·•[464])->where($AÕ—İ±ËÍ)->sum($D¿ØÒš·•[78]); $AÄ½ÉîÙ˜ = explode($D¿ØÒš·•[50], $_SERVER[$D¿ØÒš·•[142]]); goto cÁÜà¯×¨; AßÍ„Åƒ†…: if ($d¡ßöÍ¶ƒ¦ == $D¿ØÒš·•[792]) { $A£§–›ºÃ = explode($D¿ØÒš·•[1200], $DÑ¤ õ°ã [$D¿ØÒš·•[966]]); $d¡ßöÍ¶ƒ¦ = $A£§–›ºÃ[0]; } if ($d¡ßöÍ¶ƒ¦ == $D¿ØÒš·•[795] || $d¡ßöÍ¶ƒ¦ == $D¿ØÒš·•[796]) { $dÒËê„ò¡÷ = Model()->db()->query($D¿ØÒš·•[1714]); $E¯ëÊÌÎª = $dÒËê„ò¡÷[0] && isset($dÒËê„ò¡÷[0][$D¿ØÒš·•[1464]]) ? $dÒËê„ò¡÷[0][$D¿ØÒš·•[1464]] : 0; $d¡ßöÍ¶ƒ¦ = $D¿ØÒš·•[1715] . ($E¯ëÊÌÎª ? $D¿ØÒš·•[8] . $E¯ëÊÌÎª : $D¿ØÒš·•[33]); } $c„ºÍ‰ÕÖ¤ = $GLOBALS[$D¿ØÒš·•[6]][$D¿ØÒš·•[347]][$D¿ØÒš·•[829]]; goto e¦ƒÌáì…ñ; cÁÜà¯×¨: $BâÆä®´ê¯ = $AÄ½ÉîÙ˜[0]; $DÑ¤ õ°ã  = $GLOBALS[$D¿ØÒš·•[6]][$D¿ØÒš·•[17]]; $d¡ßöÍ¶ƒ¦ = $DÑ¤ õ°ã [$D¿ØÒš·•[967]]; goto AßÍ„Åƒ†…; Få¾ÁÌ‘éÑ: $D¿ØÒš·• =& $_SERVER[©äõ½¡]; $FÛƒÇÒ’¥’ = $this->diskDriver(); $DÂÚ›³•Àª = KodIO::defaultDriver(); goto eæ´òŸŠÅ×; e¦ƒÌáì…ñ: return array($D¿ØÒš·•[1716] => $FÛƒÇÒ’¥’ ? $FÛƒÇÒ’¥’[$D¿ØÒš·•[1717]] : 0, $D¿ØÒš·•[1718] => $FÛƒÇÒ’¥’ ? $FÛƒÇÒ’¥’[$D¿ØÒš·•[1719]] : 0, $D¿ØÒš·•[1720] => (int) $DÂÚ›³•Àª[$D¿ØÒš·•[1717]] * 1024 * 1024 * 1024, $D¿ØÒš·•[1721] => (int) $d–ÙÔùåÛ , $D¿ØÒš·•[1722] => ucfirst($BâÆä®´ê¯), $D¿ØÒš·•[1723] => $D¿ØÒš·•[1724] . PHP_VERSION, $D¿ØÒš·•[1725] => phpBuild64() ? 64 : 32, $D¿ØÒš·•[753] => str_replace($D¿ØÒš·•[1726], $D¿ØÒš·•[983], $d¡ßöÍ¶ƒ¦), $D¿ØÒš·•[347] => ucfirst($c„ºÍ‰ÕÖ¤), $D¿ØÒš·•[28] => $_SERVER[$D¿ØÒš·•[1727]]); goto e¬˜çôÚŸ; e¬˜çôÚŸ: } private function diskDriver() { goto d¦™ÕËù»; AÌ‚ÀÉªíï: $BÂ˜ÀšŞ‚› = $DĞ¨•º• - @disk_free_space($A™ØÀŠŸÖÙ); return array($aªºäßá‘…[1717] => $DĞ¨•º•, $aªºäßá‘…[1719] => $BÂ˜ÀšŞ‚›); goto BÆØßÓéï; d¦™ÕËù»: $aªºäßá‘… =& $_SERVER[©äõ½¡]; $A™ØÀŠŸÖÙ = $aªºäßá‘…[8]; $Bİ‚õßÜ•Ø = $GLOBALS[$aªºäßá‘…[6]][$aªºäßá‘…[1728]] == $aªºäßá‘…[1729]; goto fÇ×ŒÈŸ•Ü; fÇ×ŒÈŸ•Ü: if ($Bİ‚õßÜ•Ø) { $A™ØÀŠŸÖÙ = $aªºäßá‘…[1730]; if (function_exists($aªºäßá‘…[1731])) { exec($aªºäßá‘…[1732], $EÚó…ƒª ˆ); $A™ØÀŠŸÖÙ = $EÚó…ƒª ˆ[1] . $aªºäßá‘…[8]; } } if (!file_exists($A™ØÀŠŸÖÙ)) { return; } $DĞ¨•º• = @disk_total_space($A™ØÀŠŸÖÙ); goto AÌ‚ÀÉªíï; BÆØßÓéï: } public function fileChart($a‘—¿»øËê) { goto Dò×ƒµ†Ì; e‹‚«äÚ™Í: $d¢ñ”´Ç…[$BŸ¸®¼ÉÇ[406]] = 2; $C’ƒ²ÖîÉÑ = Model($BŸ¸®¼ÉÇ[827])->where($d¢ñ”´Ç…)->sum($BŸ¸®¼ÉÇ[78]); return array($BŸ¸®¼ÉÇ[758] => $EŒÊ´•¢ÅÓ[$BŸ¸®¼ÉÇ[78]], $BŸ¸®¼ÉÇ[1664] => $EŒÊ´•¢ÅÓ[$BŸ¸®¼ÉÇ[1664]], $BŸ¸®¼ÉÇ[1665] => (int) $CË»¾ØŒÔâ, $BŸ¸®¼ÉÇ[1666] => (int) $C’ƒ²ÖîÉÑ); goto e’‚ŒÖª; Dò×ƒµ†Ì: $BŸ¸®¼ÉÇ =& $_SERVER[©äõ½¡]; if (isset($a‘—¿»øËê[$BŸ¸®¼ÉÇ[1564]])) { return Model($BŸ¸®¼ÉÇ[827])->userFileTypeProfile($a‘—¿»øËê[$BŸ¸®¼ÉÇ[1564]]); } if (isset($a‘—¿»øËê[$BŸ¸®¼ÉÇ[1733]])) { return Model($BŸ¸®¼ÉÇ[827])->groupFileTypeProfile($a‘—¿»øËê[$BŸ¸®¼ÉÇ[1733]]); } goto A¥”Šô‘Åœ; A¥”Šô‘Åœ: $EŒÊ´•¢ÅÓ = $this->sourceSize(); $d¢ñ”´Ç… = array($BŸ¸®¼ÉÇ[492] => 0, $BŸ¸®¼ÉÇ[406] => 1); $CË»¾ØŒÔâ = Model($BŸ¸®¼ÉÇ[827])->where($d¢ñ”´Ç…)->sum($BŸ¸®¼ÉÇ[78]); goto e‹‚«äÚ™Í; e’‚ŒÖª: } private function sourceSize() { $cöŠòØí§¾ =& $_SERVER[©äõ½¡]; $FŸ®™”›à = Model($cöŠòØí§¾[827])->where(array($cöŠòØí§¾[405] => 0))->sum($cöŠòØí§¾[78]); $FŒê Úç”ƒ = Model($cöŠòØí§¾[464])->sum($cöŠòØí§¾[78]); if ($FŒê Úç”ƒ > $FŸ®™”›à) { $FŒê Úç”ƒ = $FŸ®™”›à; } return array($cöŠòØí§¾[78] => (int) $FŸ®™”›à, $cöŠòØí§¾[1664] => (int) $FŒê Úç”ƒ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $eÌØÆÚÜĞÜ =& $_SERVER[©äõ½¡]; $D™ÊªŠ¤ØË = array(array($eÌØÆÚÜĞÜ[415] => LNG($eÌØÆÚÜĞÜ[1734]), $eÌØÆÚÜĞÜ[1735] => $eÌØÆÚÜĞÜ[1736], $eÌØÆÚÜĞÜ[1737] => 1, $eÌØÆÚÜĞÜ[1738] => 1, $eÌØÆÚÜĞÜ[1739] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($eÌØÆÚÜĞÜ[415] => LNG($eÌØÆÚÜĞÜ[1740]), $eÌØÆÚÜĞÜ[1735] => $eÌØÆÚÜĞÜ[1741], $eÌØÆÚÜĞÜ[1737] => 2, $eÌØÆÚÜĞÜ[1738] => 1, $eÌØÆÚÜĞÜ[1739] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($eÌØÆÚÜĞÜ[415] => LNG($eÌØÆÚÜĞÜ[1742]), $eÌØÆÚÜĞÜ[1735] => $eÌØÆÚÜĞÜ[1743], $eÌØÆÚÜĞÜ[1737] => 3, $eÌØÆÚÜĞÜ[1738] => 1, $eÌØÆÚÜĞÜ[1739] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($eÌØÆÚÜĞÜ[415] => LNG($eÌØÆÚÜĞÜ[1744]), $eÌØÆÚÜĞÜ[1735] => $eÌØÆÚÜĞÜ[1745], $eÌØÆÚÜĞÜ[1737] => 4, $eÌØÆÚÜĞÜ[1738] => 1, $eÌØÆÚÜĞÜ[1739] => self::AUTH_SHOW | self::AUTH_VIEW), array($eÌØÆÚÜĞÜ[415] => LNG($eÌØÆÚÜĞÜ[1746]), $eÌØÆÚÜĞÜ[1735] => $eÌØÆÚÜĞÜ[1747], $eÌØÆÚÜĞÜ[1737] => 5, $eÌØÆÚÜĞÜ[1738] => 1, $eÌØÆÚÜĞÜ[1739] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($eÌØÆÚÜĞÜ[415] => LNG($eÌØÆÚÜĞÜ[1748]), $eÌØÆÚÜĞÜ[1735] => $eÌØÆÚÜĞÜ[1749], $eÌØÆÚÜĞÜ[1737] => 6, $eÌØÆÚÜĞÜ[1738] => 1, $eÌØÆÚÜĞÜ[1739] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($eÌØÆÚÜĞÜ[415] => LNG($eÌØÆÚÜĞÜ[1750]), $eÌØÆÚÜĞÜ[1735] => $eÌØÆÚÜĞÜ[1751], $eÌØÆÚÜĞÜ[1737] => 7, $eÌØÆÚÜĞÜ[1738] => 1, $eÌØÆÚÜĞÜ[1739] => 0)); return $D™ÊªŠ¤ØË; } public static function authCheck($f‰†¡ßèÃ‰, $f©÷¡Äàß) { $f‰†¡ßèÃ‰ = intval($f‰†¡ßèÃ‰); if ($GLOBALS[$_SERVER[©äõ½¡][499]]) { return !0; } if ($f‰†¡ßèÃ‰ <= 0) { return !1; } if (($f‰†¡ßèÃ‰ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($f‰†¡ßèÃ‰ & $f©÷¡Äàß); } public static function authCheckShow($eÔ¯ÚÏå«ª) { return self::authCheck($eÔ¯ÚÏå«ª, self::AUTH_SHOW); } public static function authCheckView($BŸ©”¨¢) { return self::authCheck($BŸ©”¨¢, self::AUTH_VIEW); } public static function authCheckDownload($EöÎÎ®á²) { return self::authCheck($EöÎÎ®á², self::AUTH_DOWNLOAD); } public static function authCheckUpload($F•ø¼¦Ú) { return self::authCheck($F•ø¼¦Ú, self::AUTH_UPLOAD); } public static function authCheckEdit($E“ßàÒ­) { return self::authCheck($E“ßàÒ­, self::AUTH_EDIT); } public static function authCheckRemove($FËä¶á™à…) { return self::authCheck($FËä¶á™à…, self::AUTH_REMOVE); } public static function authCheckShare($EÕâ†çğÎ”) { return self::authCheck($EÕâ†çğÎ”, self::AUTH_SHARE); } public static function authCheckComment($bªµŸôŒÇ) { return self::authCheck($bªµŸôŒÇ, self::AUTH_COMMENT); } public static function authCheckEvent($FìåˆÇÌ‘‘) { return self::authCheck($FìåˆÇÌ‘‘, self::AUTH_EVENT); } public static function authCheckRoot($C´ÔÔôÑÕ) { return self::authCheck($C´ÔÔôÑÕ, self::AUTH_ROOT); } public static function authCheckAction($d†‰ñÂËİ, $DÍÓ´¡ÂÒ) { goto Cç¶Ú¹¯ò; C”Û®·ïš„: if (($d†‰ñÂËİ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($d†‰ñÂËİ & $A¼ÎùøØğˆ); goto cÌôŒÎŠ³½; E¼ğ«õïÍÍ: $A¼ÎùøØğˆ = $cîÑ… Õ³ª[$DÍÓ´¡ÂÒ]; $d†‰ñÂËİ = intval($d†‰ñÂËİ); if ($d†‰ñÂËİ <= 0) { return !1; } goto C”Û®·ïš„; Cç¶Ú¹¯ò: $AÒé‘äÊˆˆ =& $_SERVER[©äõ½¡]; $cîÑ… Õ³ª = array($AÒé‘äÊˆˆ[1752] => self::AUTH_VIEW, $AÒé‘äÊˆˆ[1127] => self::AUTH_DOWNLOAD, $AÒé‘äÊˆˆ[107] => self::AUTH_UPLOAD, $AÒé‘äÊˆˆ[1700] => self::AUTH_EDIT, $AÒé‘äÊˆˆ[1699] => self::AUTH_REMOVE, $AÒé‘äÊˆˆ[1710] => self::AUTH_SHARE, $AÒé‘äÊˆˆ[352] => self::AUTH_COMMENT, $AÒé‘äÊˆˆ[1552] => self::AUTH_EVENT, $AÒé‘äÊˆˆ[1753] => self::AUTH_ROOT); if (!isset($cîÑ… Õ³ª[$DÍÓ´¡ÂÒ])) { return; } goto E¼ğ«õïÍÍ; cÌôŒÎŠ³½: } public static function authDisable($eÉöÂİ¹¡, $d–—¬óÍŒæ) { if (intval($eÉöÂİ¹¡) <= 0) { return 0; } return intval($eÉöÂİ¹¡) & ~$d–—¬óÍŒæ; } public $optionType = "\x53\171\163\164\145\155\x2e\163\157\165\162\143\x65\101\165\x74\x68\114\x69\x73\164"; public $field = array("\x6e\141\x6d\145", "\x61\165\x74\150", "\154\x61\x62\145\154", "\x64\x69\x73\160\154\141\x79", "\x73\x79\163\x74\x65\155", "\x73\157\162\x74"); public function initData() { $DĞ­ÈÕ¦Ì· = $this->authDefault(); foreach ($DĞ­ÈÕ¦Ì· as $eÑ‹áËŒ’Ÿ) { $this->add($eÑ‹áËŒ’Ÿ); } } public function findAuth($D‘õ„»¡ˆ´, $E‚ÇËáá•ó) { $eŒÅ¶ØÌ =& $_SERVER[©äõ½¡]; $bÃŞ¹ô‚ŞÅ = parent::listData(); foreach ($bÃŞ¹ô‚ŞÅ as $D“ÏˆÚóĞ¯) { $A‘†¥™’ = intval($D“ÏˆÚóĞ¯[$eŒÅ¶ØÌ[408]]); if ($A‘†¥™’ <= 0 || $D“ÏˆÚóĞ¯[$eŒÅ¶ØÌ[1754]] == 0) { continue; } if (($A‘†¥™’ & $D‘õ„»¡ˆ´) != $D‘õ„»¡ˆ´) { continue; } if (($A‘†¥™’ & $E‚ÇËáá•ó) != 0) { continue; } return $D“ÏˆÚóĞ¯[$eŒÅ¶ØÌ[395]]; } return !1; } public function findAuthReadOnly() { $eéÚ‘ê¸Øš = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $d¿³º¾½° = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($eéÚ‘ê¸Øš, $d¿³º¾½°); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($DÇá÷š¬îé = false, $d¥°öÉ°Ú = "\x73\x6f\x72\x74", $e§¥Ü¶Š¼ = false) { return parent::listData($DÇá÷š¬îé, $d¥°öÉ°Ú, $e§¥Ü¶Š¼); } public function update($C£…ğ‡®°´, $e´Êá‰™Ï) { $f‘›—Å…Ô“ =& $_SERVER[©äõ½¡]; $EÂ°ß‰ß½ = parent::listData($C£…ğ‡®°´); $fã™­é¬‹ = $this->findByName($e´Êá‰™Ï[$f‘›—Å…Ô“[28]]); if (!$EÂ°ß‰ß½ || $fã™­é¬‹ && $fã™­é¬‹[$f‘›—Å…Ô“[395]] != $EÂ°ß‰ß½[$f‘›—Å…Ô“[395]]) { return !1; } $this->filterAuth($e´Êá‰™Ï[$f‘›—Å…Ô“[408]]); return parent::update($C£…ğ‡®°´, $e´Êá‰™Ï); } public function remove($D³Â‡ÛÄïÄ) { $a‰½¡ªˆ† = parent::listData($D³Â‡ÛÄïÄ); if (!$a‰½¡ªˆ† || $a‰½¡ªˆ†[$_SERVER[©äõ½¡][1204]]) { return !1; } return parent::remove($D³Â‡ÛÄïÄ); } public function add($F½Ü Ñãè = array()) { goto fÆçÒ™¹Ö²; E£²²»¦šÈ: $F½Ü Ñãè = array_merge($e•¡ËÏòŠ©, $F½Ü Ñãè); $F½Ü Ñãè[$CÛÆšæ……Á[1756]] = $this->getSort(); $this->filterAuth($F½Ü Ñãè[$CÛÆšæ……Á[408]]); goto FÂ³ÑÉÇ³‹; fÆçÒ™¹Ö²: $CÛÆšæ……Á =& $_SERVER[©äõ½¡]; if ($this->findByName($F½Ü Ñãè[$CÛÆšæ……Á[28]])) { return !1; } $e•¡ËÏòŠ© = array($CÛÆšæ……Á[28] => $CÛÆšæ……Á[33], $CÛÆšæ……Á[408] => 1, $CÛÆšæ……Á[1755] => $CÛÆšæ……Á[1743], $CÛÆšæ……Á[1754] => 1, $CÛÆšæ……Á[1204] => 0, $CÛÆšæ……Á[1756] => 0); goto E£²²»¦šÈ; FÂ³ÑÉÇ³‹: return parent::insert($F½Ü Ñãè); goto dÄÇ™Ğ–´è; dÄÇ™Ğ–´è: } private function getSort() { $c„¢·—Ô« =& $_SERVER[©äõ½¡]; $a£ÌÇ©Éö‡ = parent::listData(); $E¯ÌğæäšÀ = array_to_keyvalue($a£ÌÇ©Éö‡, $c„¢·—Ô«[33], $c„¢·—Ô«[1756]); return empty($E¯ÌğæäšÀ) ? 0 : max($E¯ÌğæäšÀ) + 1; } private function filterAuth(&$eíÕ´ƒ“Ú) { goto DÈéª–Òƒ; dã¡èŞ¡ê: foreach ($fÙ•‘ñŠ•ô as $c‹İïÆÉÓº) { if (isset($D†ÏçÃÙ[$c‹İïÆÉÓº])) { $fÙ•‘ñŠ•ô = array_merge($fÙ•‘ñŠ•ô, $D†ÏçÃÙ[$c‹İïÆÉÓº]); } } $fÙ•‘ñŠ•ô[] = self::AUTH_SHOW; $eíÕ´ƒ“Ú = array_sum(array_unique($fÙ•‘ñŠ•ô)); goto B«äÌãÀ½ƒ; DÈéª–Òƒ: if (!$eíÕ´ƒ“Ú) { return; } $C‹¯ºòãÓ® = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $fÙ•‘ñŠ•ô = array(); goto BÎ·‚æ¨ƒÍ; BÎ·‚æ¨ƒÍ: foreach ($C‹¯ºòãÓ® as $c‹İïÆÉÓº) { if ($eíÕ´ƒ“Ú & $c‹İïÆÉÓº) { $fÙ•‘ñŠ•ô[] = $c‹İïÆÉÓº; } } if (in_array(self::AUTH_ROOT, $fÙ•‘ñŠ•ô)) { $eíÕ´ƒ“Ú = array_sum($C‹¯ºòãÓ®); return; } $D†ÏçÃÙ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto dã¡èŞ¡ê; B«äÌãÀ½ƒ: } public function sort($aØ¯´„é‡Ù, $b˜”Ö¦ëÃƒ) { return parent::update($aØ¯´„é‡Ù, $b˜”Ö¦ëÃƒ); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\155\x2e\142\x61\x63\153\165\160\x4c\x69\x73\x74"; public $field = array("\x69\x6f", "\x6e\141\155\x65", "\163\x74\141\x74\x75\163", "\143\x6f\x6e\164\x65\x6e\164", "\155\141\156\165\141\154", "\162\x65\163\x75\154\164", "\164\x69\x6d\x65\106\x72\x6f\155", "\x74\151\x6d\145\124\157"); public function config() { goto bñ¹¹ŠÉ’; bø¨êÇò±˜: $EªƒŸÅ»äÂ = Model($fğîåÃŒ‡¬[1759])->findByKey($fğîåÃŒ‡¬[1552], $c´¼‘ïØÊÌ); if (!$EªƒŸÅ»äÂ) { $EªƒŸÅ»äÂ = array(); } if (isset($EªƒŸÅ»äÂ[$fğîåÃŒ‡¬[197]])) { $EªƒŸÅ»äÂ[$fğîåÃŒ‡¬[197]] = json_decode($EªƒŸÅ»äÂ[$fğîåÃŒ‡¬[197]], !0); } goto bÌË‚ÅÅßğ; bÌË‚ÅÅßğ: if (isset($f‚‰Šî±Áµ[$fğîåÃŒ‡¬[197]])) { $EªƒŸÅ»äÂ[$fğîåÃŒ‡¬[197]][$fğîåÃŒ‡¬[1537]] = $f‚‰Šî±Áµ[$fğîåÃŒ‡¬[197]]; unset($f‚‰Šî±Áµ[$fğîåÃŒ‡¬[197]]); } return array_merge($EªƒŸÅ»äÂ, $f‚‰Šî±Áµ); goto cÔ«¤¿¾£Ï; B³ÜÓ¨÷¯ç: $f‚‰Šî±Áµ = is_array($f‚‰Šî±Áµ) ? $f‚‰Šî±Áµ : array(); if (!isset($f‚‰Šî±Áµ[$fğîåÃŒ‡¬[750]])) { $f‚‰Šî±Áµ[$fğîåÃŒ‡¬[750]] = $fğîåÃŒ‡¬[87]; } unset($f‚‰Šî±Áµ[$fğîåÃŒ‡¬[1534]]); goto d††Æ´Ö§ø; d††Æ´Ö§ø: Action($fğîåÃŒ‡¬[1757])->taskInit(); Model($fğîåÃŒ‡¬[1533])->cacheClear(); $c´¼‘ïØÊÌ = $fğîåÃŒ‡¬[1758]; goto bø¨êÇò±˜; bñ¹¹ŠÉ’: $fğîåÃŒ‡¬ =& $_SERVER[©äõ½¡]; $f‚‰Šî±Áµ = Model($fğîåÃŒ‡¬[765])->get($fğîåÃŒ‡¬[777]); $f‚‰Šî±Áµ = json_decode($f‚‰Šî±Áµ, !0); goto B³ÜÓ¨÷¯ç; cÔ«¤¿¾£Ï: } public function listData($C¤®§¢¥øã = false, $F·¤‘¥×Šİ = "\x6d\x6f\x64\151\x66\171\124\x69\x6d\x65", $c˜ÚÉäÙĞ = false) { return parent::listData($C¤®§¢¥øã, $F·¤‘¥×Šİ, !0); } public function lastItem() { $A‚ÃĞ”‚ğ¶ = $this->listData(); return !empty($A‚ÃĞ”‚ğ¶[0]) ? $A‚ÃĞ”‚ğ¶[0] : null; } public function kill($AØìÊ¨‚ÎÎ) { goto a¦™Ñ×¹œÙ; cõ’•ßÑ·Ñ: return $this->remove($AØìÊ¨‚ÎÎ); goto F…»çŒƒ¾ö; B‚ÏÎÊ‰”Ó: Task::kill($d¿¯ Ë×Ù[776]); Task::kill($d¿¯ Ë×Ù[801]); Task::kill($d¿¯ Ë×Ù[811]); goto aÏ²ŒËÕ±¢; aÏ²ŒËÕ±¢: $A¥‰²›Åóï = $AƒŒ‘‰Îóğ[$d¿¯ Ë×Ù[28]]; $aâõÛè = TEMP_FILES . $d¿¯ Ë×Ù[773] . $A¥‰²›Åóï . $d¿¯ Ë×Ù[8]; IO::remove($aâõÛè, !1); goto cõ’•ßÑ·Ñ; a¦™Ñ×¹œÙ: $d¿¯ Ë×Ù =& $_SERVER[©äõ½¡]; $AƒŒ‘‰Îóğ = $this->listData($AØìÊ¨‚ÎÎ); if (!$AƒŒ‘‰Îóğ || empty($AƒŒ‘‰Îóğ[$d¿¯ Ë×Ù[28]])) { return !0; } goto B‚ÏÎÊ‰”Ó; F…»çŒƒ¾ö: } public function remove($f‘Ò×…ÇæÌ) { $B¤Õ éğˆ = $this->listData($f‘Ò×…ÇæÌ); if (!$B¤Õ éğˆ) { return !0; } return $this->backupRemove($B¤Õ éğˆ); } private function backupRemove($Dö¡ÄåÛ‰ƒ) { parent::remove($Dö¡ÄåÛ‰ƒ[$_SERVER[©äõ½¡][395]]); $f‰‡Ã¡À‚ˆ = $this->backupPath($Dö¡ÄåÛ‰ƒ); IO::remove($f‰‡Ã¡À‚ˆ, !1); return !0; } private function backupPath($C‰¸®í¢ˆÉ) { $cÑåË‡å¢„ =& $_SERVER[©äõ½¡]; $Bè×Ë¸†Ôá = $C‰¸®í¢ˆÉ[$cÑåË‡å¢„[28]]; $C”Æ·ÊÀÎÊ = Model($cÑåË‡å¢„[765])->get($cÑåË‡å¢„[766]); $D»ö¢ÖÑ¥Û = substr(md5($cÑåË‡å¢„[767] . $C”Æ·ÊÀÎÊ . $Bè×Ë¸†Ôá), 0, 8); return "\x7b\151\157\x3a{$C‰¸®í¢ˆÉ[$cÑåË‡å¢„[747]]}\175\57\x64\x61\x74\141\142\x61\x73\x65\57\142\x61\143\153\x75\160\57" . $Bè×Ë¸†Ôá . $cÑåË‡å¢„[71] . $D»ö¢ÖÑ¥Û; } public function start() { goto f‡ŠŠëÊ®‚; dÕ‹‹ˆÆš: Backup::set(array($BÈÙó—É¬â[745] => 1, $BÈÙó—É¬â[490] => time())); return !0; goto BƒäÆ¤ Ó¿; FÑ•ĞÄØ®´: if (!$D½ˆ¶‚Ü«ƒ || $D½ˆ¶‚Ü«ƒ[$BÈÙó—É¬â[1534]] != $BÈÙó—É¬â[87]) { return !1; } $b‹‹Öš”õ = $this->process(); foreach ($b‹‹Öš”õ as $E·º“²ï¸™) { if ($E·º“²ï¸™) { return Task::restart($E·º“²ï¸™[$BÈÙó—É¬â[395]]); } } goto Fí‰ŸÏ‰¼Ã; f‡ŠŠëÊ®‚: $BÈÙó—É¬â =& $_SERVER[©äõ½¡]; if ($GLOBALS[$BÈÙó—É¬â[6]][$BÈÙó—É¬â[88]][$BÈÙó—É¬â[1760]] != $BÈÙó—É¬â[87]) { return !0; } $D½ˆ¶‚Ü«ƒ = $this->config(); goto FÑ•ĞÄØ®´; Fí‰ŸÏ‰¼Ã: $føééë¨Ê³ = new Backup(); $B¢Ä¡ä¹Ô‚ = $føééë¨Ê³->db(); if ($B¢Ä¡ä¹Ô‚) { $B¢Ä¡ä¹Ô‚ = $føééë¨Ê³->dbFile(); if ($B¢Ä¡ä¹Ô‚ && $D½ˆ¶‚Ü«ƒ[$BÈÙó—É¬â[750]] == $BÈÙó—É¬â[191]) { $B¢Ä¡ä¹Ô‚ = $føééë¨Ê³->file(); } } goto dÕ‹‹ˆÆš; BƒäÆ¤ Ó¿: } public function process() { $DÒÖÂÑ‹²´ =& $_SERVER[©äõ½¡]; return array($DÒÖÂÑ‹²´[753] => Task::get($DÒÖÂÑ‹²´[776]), $DÒÖÂÑ‹²´[757] => Task::get($DÒÖÂÑ‹²´[801]), $DÒÖÂÑ‹²´[193] => Task::get($DÒÖÂÑ‹²´[811])); } public function restore() { $DÈõˆÒ±¥ =& $_SERVER[©äõ½¡]; ActionCall($DÈõˆÒ±¥[1052], !0, 1); ActionCall($DÈõˆÒ±¥[1052], !0, 0); } } goto a˜‰ÔÏÃ°¥; a¹ñº„½–: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto E°Ôô©áˆº; B²§×ˆª„: $f·ÒåÛÅçœ = $this->tmpFilesPath() . $F¡ç×Í¿ğÈ[773] . self::$name . $F¡ç×Í¿ğÈ[8]; del_dir($f·ÒåÛÅçœ); mk_dir($f·ÒåÛÅçœ); goto e¿Îùã¾…š; CÓêÂøæ‚: Backup::set($DñÀÌ¤éì); if ($E”²Ï¼‡ - $EÓ»…á†Œ > 1) { $DùïÌÇÓ’ = $F¡ç×Í¿ğÈ[788]; if (stristr(I18n::getType(), $F¡ç×Í¿ğÈ[789])) { $DùïÌÇÓ’ = $F¡ç×Í¿ğÈ[790]; } write_log(array($DùïÌÇÓ’, $DñÀÌ¤éì), $F¡ç×Í¿ğÈ[777]); return !1; } return !0; goto e÷ÄİéĞí±; dç»¯ª¡: if (isset($dí·ƒ­•æ->task[$F¡ç×Í¿ğÈ[783]])) { $BŸÑõÛª…› = $dí·ƒ­•æ->task[$F¡ç×Í¿ğÈ[783]] ? $dí·ƒ­•æ->task[$F¡ç×Í¿ğÈ[783]] : timeFloat(); $Cİ¤Å¸Š§˜ = $BŸÑõÛª…› - $dí·ƒ­•æ->task[$F¡ç×Í¿ğÈ[784]]; if ($Cİ¤Å¸Š§˜ >= 0.2) { $E”²Ï¼‡ += 1; } } $dí·ƒ­•æ->end(); $DñÀÌ¤éì = array($F¡ç×Í¿ğÈ[771] => $EèøœéàŠ¢, $F¡ç×Í¿ğÈ[768] => 1, $F¡ç×Í¿ğÈ[785] => $E”²Ï¼‡, $F¡ç×Í¿ğÈ[786] => $EÓ»…á†Œ, $F¡ç×Í¿ğÈ[787] => time()); goto CÓêÂøæ‚; dØÒÈ±ºìé: $eÑ’ø§å´¨ = new DbManage($Bôí•£©, $EèøœéàŠ¢); $DñÀÌ¤éì = array($F¡ç×Í¿ğÈ[771] => $EèøœéàŠ¢, $F¡ç×Í¿ğÈ[772] => time()); Backup::set($DñÀÌ¤éì); goto B²§×ˆª„; FÑË†¾ÜòÏ: foreach ($FÓãŒ›ìË as $eË—©ù²–Ê) { $E”²Ï¼‡ += $eÑ’ø§å´¨->model($eË—©ù²–Ê)->count(); } $dí·ƒ­•æ = new Task($F¡ç×Í¿ğÈ[776], $F¡ç×Í¿ğÈ[777], $E”²Ï¼‡, LNG($F¡ç×Í¿ğÈ[778]) . $F¡ç×Í¿ğÈ[779] . LNG($F¡ç×Í¿ğÈ[780])); foreach ($FÓãŒ›ìË as $eË—©ù²–Ê) { $a‚½ù‹²Æ = $f·ÒåÛÅçœ . $eË—©ù²–Ê . $F¡ç×Í¿ğÈ[781]; $a×—êèÓìî = null; if ($eË—©ù²–Ê == $F¡ç×Í¿ğÈ[782] && (!isset($CÖ×›îìĞ˜[$F¡ç×Í¿ğÈ[750]]) || $CÖ×›îìĞ˜[$F¡ç×Í¿ğÈ[750]] == $F¡ç×Í¿ğÈ[191])) { $a×—êèÓìî = self::$io; } $EÓ»…á†Œ += $eÑ’ø§å´¨->sqlFromDb($eË—©ù²–Ê, $a‚½ù‹²Æ, $dí·ƒ­•æ, $a×—êèÓìî); } goto dç»¯ª¡; FŒÓÛ°À–Ş: self::$name = $CÖ×›îìĞ˜[$F¡ç×Í¿ğÈ[28]]; $Bôí•£© = $GLOBALS[$F¡ç×Í¿ğÈ[6]][$F¡ç×Í¿ğÈ[17]]; $EèøœéàŠ¢ = $this->_dbType($Bôí•£©); goto dØÒÈ±ºìé; E°Ôô©áˆº: $F¡ç×Í¿ğÈ =& $_SERVER[©äõ½¡]; $CÖ×›îìĞ˜ = Backup::get(); self::$io = $CÖ×›îìĞ˜[$F¡ç×Í¿ğÈ[747]]; goto FŒÓÛ°À–Ş; e¿Îùã¾…š: $E”²Ï¼‡ = $EÓ»…á†Œ = 0; try { $FÓãŒ›ìË = $eÑ’ø§å´¨->db()->getTables(); } catch (Exception $CËİ±­Û„) { return !1; } $FÓãŒ›ìË = array_diff($FÓãŒ›ìË, array($F¡ç×Í¿ğÈ[774], $F¡ç×Í¿ğÈ[775])); goto FÑË†¾ÜòÏ; e÷ÄİéĞí±: } private function _dbType($a—¥ŠÒª§ß) { goto F†àÈ Ö—›; F†àÈ Ö—›: $B´‡±Òµù„ =& $_SERVER[©äõ½¡]; $a—¥ŠÒª§ß = array_change_key_case($a—¥ŠÒª§ß); $d¶¢„»¸Ş“ = $a—¥ŠÒª§ß[$B´‡±Òµù„[791]]; goto DÔ¢ÄÖ; DÔ¢ÄÖ: if ($d¶¢„»¸Ş“ == $B´‡±Òµù„[792]) { $CæÆÕŒç°… = explode($B´‡±Òµù„[4], $a—¥ŠÒª§ß[$B´‡±Òµù„[793]]); $d¶¢„»¸Ş“ = $CæÆÕŒç°…[0]; } $A‰„÷·ÖÑÄ = array($B´‡±Òµù„[794] => $B´‡±Òµù„[9], $B´‡±Òµù„[795] => $B´‡±Òµù„[796]); if (isset($A‰„÷·ÖÑÄ[$d¶¢„»¸Ş“])) { $d¶¢„»¸Ş“ = $A‰„÷·ÖÑÄ[$d¶¢„»¸Ş“]; } goto cø‚Ã‚©Œ¨; cø‚Ã‚©Œ¨: return $d¶¢„»¸Ş“; goto dĞ¶¥³¨‚ˆ; dĞ¶¥³¨‚ˆ: } private function tmpFilesPath() { $EÀ‡©‘Õ¾£ =& $_SERVER[©äõ½¡]; $DÙ³á“×£ = TEMP_FILES; if ($GLOBALS[$EÀ‡©‘Õ¾£[6]][$EÀ‡©‘Õ¾£[88]][$EÀ‡©‘Õ¾£[797]]) { $DÙ³á“×£ = $GLOBALS[$EÀ‡©‘Õ¾£[6]][$EÀ‡©‘Õ¾£[88]][$EÀ‡©‘Õ¾£[797]]; if (!mk_dir($DÙ³á“×£) || !is_writable($DÙ³á“×£) || !IO::mkfile($DÙ³á“×£ . $EÀ‡©‘Õ¾£[798])) { $DÙ³á“×£ = TEMP_FILES; } } return $DÙ³á“×£; } } class BackupDbFile { public function __construct() { } public function index() { goto BŒÕÃ÷¯ÄÔ; C”àøÊ¤¥÷: $f÷Ã•ö÷æ© = new TaskFileTransfer($bêŠ“øŸ«[801], $bêŠ“øŸ«[777], count($AĞ³”ĞéôÅ), LNG($bêŠ“øŸ«[778]) . $bêŠ“øŸ«[454] . LNG($bêŠ“øŸ«[780]) . $bêŠ“øŸ«[802]); $f÷Ã•ö÷æ©->task[$bêŠ“øŸ«[758]] = $B·÷÷Â‹ª; foreach ($DƒìÏ¬ñß°[$bêŠ“øŸ«[74]] as $fÎ³ß©­×è) { $bÊ£’¾Ôø = IO::move($fÎ³ß©­×è[$bêŠ“øŸ«[76]], $c‰è„´Àä); if (!$bÊ£’¾Ôø) { $f÷Ã•ö÷æ©->end(); $aíƒƒÁĞ¢ = IO::getLastError($bêŠ“øŸ«[803] . $fÎ³ß©­×è[$bêŠ“øŸ«[76]] . $bêŠ“øŸ«[804] . $c‰è„´Àä . $bêŠ“øŸ«[530]); write_log($aíƒƒÁĞ¢, $bêŠ“øŸ«[777]); return !1; } } goto Fˆ·¶Ï°å; Fˆ·¶Ï°å: $c†Å•Ì’‘ = CONTROLLER_DIR . $bêŠ“øŸ«[805]; $f†Šïééö‚ = CONTROLLER_DIR . $bêŠ“øŸ«[806]; IO::copy($c†Å•Ì’‘, $c‰è„´Àä); goto EŒİëğ¥‰; E‡ë‘õôš: Backup::set($aÖÏ…«ˆ); return !0; goto b¯ø±‚ÍØ¸; EÕË ×ÌĞŞ: if (!$B·÷÷Â‹ª) { return !1; } $aÖÏ…«ˆ = array($bêŠ“øŸ«[799] => $B·÷÷Â‹ª, $bêŠ“øŸ«[800] => time()); Backup::set($aÖÏ…«ˆ); goto C”àøÊ¤¥÷; EŒİëğ¥‰: IO::copy($f†Šïééö‚, $c‰è„´Àä); $f÷Ã•ö÷æ©->end(); $aÖÏ…«ˆ = array($bêŠ“øŸ«[807] => $B·÷÷Â‹ª, $bêŠ“øŸ«[808] => time()); goto E‡ë‘õôš; BŒÕÃ÷¯ÄÔ: $bêŠ“øŸ« =& $_SERVER[©äõ½¡]; $bï±¾Æ÷ = Backup::get(); $E•ËåÉ™ã = $bï±¾Æ÷[$bêŠ“øŸ«[28]]; goto EŠ¯ÌœË•”; EŠ¯ÌœË•”: $cçº¢ò¡Çœ = $this->tmpFilesPath() . "\x62\x61\143\x6b\x75\160\137{$E•ËåÉ™ã}\57"; $c‰è„´Àä = $this->backupPath($bï±¾Æ÷); if (!($c‰è„´Àä = IO::mkdir($c‰è„´Àä))) { return !1; } goto c«òÜİÀÃá; c«òÜİÀÃá: $DƒìÏ¬ñß° = IO::listPath($cçº¢ò¡Çœ); $AĞ³”ĞéôÅ = isset($DƒìÏ¬ñß°[$bêŠ“øŸ«[74]]) ? $DƒìÏ¬ñß°[$bêŠ“øŸ«[74]] : array(); $B·÷÷Â‹ª = array_sum(array_column($AĞ³”ĞéôÅ, $bêŠ“øŸ«[78])); goto EÕË ×ÌĞŞ; b¯ø±‚ÍØ¸: } private function backupPath($eÍ¶† äæ) { $A´Ø„é’òÃ =& $_SERVER[©äõ½¡]; $Bù¼ ÂöÇ = $eÍ¶† äæ[$A´Ø„é’òÃ[28]]; $C“°Òƒ½¾Ô = Model($A´Ø„é’òÃ[765])->get($A´Ø„é’òÃ[766]); $d—ìŞµ”ÔÇ = substr(md5($A´Ø„é’òÃ[767] . $C“°Òƒ½¾Ô . $Bù¼ ÂöÇ), 0, 8); return "\173\151\x6f\72{$eÍ¶† äæ[$A´Ø„é’òÃ[747]]}\175\x2f\144\x61\164\141\x62\141\163\x65\x2f\142\x61\x63\x6b\x75\160\57" . $Bù¼ ÂöÇ . $A´Ø„é’òÃ[71] . $d—ìŞµ”ÔÇ; } private function tmpFilesPath() { $A»’—Ç×Ìö =& $_SERVER[©äõ½¡]; $E«Š¬Â˜” = TEMP_FILES; if ($GLOBALS[$A»’—Ç×Ìö[6]][$A»’—Ç×Ìö[88]][$A»’—Ç×Ìö[797]]) { $E«Š¬Â˜” = $GLOBALS[$A»’—Ç×Ìö[6]][$A»’—Ç×Ìö[88]][$A»’—Ç×Ìö[797]]; if (!mk_dir($E«Š¬Â˜”) || !is_writable($E«Š¬Â˜”) || !IO::mkfile($E«Š¬Â˜” . $A»’—Ç×Ìö[798])) { $E«Š¬Â˜” = TEMP_FILES; } } return $E«Š¬Â˜”; } } class BackupFile { public function __construct() { } public function index() { goto c•¾«‡ß¢; C‰õŠø´Ò‡: $d‘Üó……Šİ = array($_SERVER[©äõ½¡][825] => 1, $_SERVER[©äõ½¡][490] => time(), $_SERVER[©äõ½¡][770] => 1, $_SERVER[©äõ½¡][822] => $b·ŸÑ¼¶ÚÑ, $_SERVER[©äõ½¡][814] => $b÷‚ó”°‚˜, $_SERVER[©äõ½¡][813] => $aà«Ú“ƒëÖ, $_SERVER[©äõ½¡][826] => time()); if ($A¸ùÌèªğİ) { $d‘Üó……Šİ[$_SERVER[©äõ½¡][823]] = $bõ¨É§°‰; $d‘Üó……Šİ[$_SERVER[©äõ½¡][824]] = $Fõ—¨ŒÆ†‘; } Backup::set($d‘Üó……Šİ); goto DÒâÅæ£; a›Èõ«Ÿ´æ: $aà«Ú“ƒëÖ = (int) Model($_SERVER[©äõ½¡][782])->where($f²„ïİ¶æÛ)->count($_SERVER[©äõ½¡][461]); $b÷‚ó”°‚˜ = (int) Model($_SERVER[©äõ½¡][782])->where($f²„ïİ¶æÛ)->sum($_SERVER[©äõ½¡][78]); $eÒ‚ˆ¸«»½ = new TaskFileTransfer($_SERVER[©äõ½¡][811], $_SERVER[©äõ½¡][777], $aà«Ú“ƒëÖ, LNG($_SERVER[©äõ½¡][778]) . $_SERVER[©äõ½¡][779] . LNG($_SERVER[©äõ½¡][812])); goto eÌ…§ÄÔÑ; eÌ…§ÄÔÑ: $eÒ‚ˆ¸«»½->task[$_SERVER[©äõ½¡][758]] = $b÷‚ó”°‚˜; $d‘Üó……Šİ = array($_SERVER[©äõ½¡][813] => $aà«Ú“ƒëÖ, $_SERVER[©äõ½¡][814] => $b÷‚ó”°‚˜, $_SERVER[©äõ½¡][815] => time()); Backup::set($d‘Üó……Šİ); goto eøæÕŠã; fŞ†â’‰: $E¶¢ÔåªÔæ = 1000; $F¼µØÜ¤â» = $A¸ùÌèªğİ = 0; $f«’¹ª¦ä¦ = array(); goto dÀù»¾ªøç; dÀù»¾ªøç: $Fõ—¨ŒÆ†‘ = $bõ¨É§°‰ = 0; do { $AÎ¢Å¬ã™µ = $_SERVER[©äõ½¡][816]; $dÍÃÆĞä³ = Model($_SERVER[©äõ½¡][782])->where($f²„ïİ¶æÛ)->field($AÎ¢Å¬ã™µ)->order($_SERVER[©äõ½¡][817])->selectPage($E¶¢ÔåªÔæ, $c£ó „÷ÂĞ); $e–¤«¾¼á— = !empty($dÍÃÆĞä³[$_SERVER[©äõ½¡][367]]) ? $dÍÃÆĞä³[$_SERVER[©äõ½¡][367]] : array(); foreach ($e–¤«¾¼á— as $dÒâ¿¬ÉÒ¾) { goto FØßˆÁì‰¥; FØßˆÁì‰¥: if (!$this->_fileExist($dÒâ¿¬ÉÒ¾, $f«’¹ª¦ä¦, $CÇ§„íÙó)) { $aà«Ú“ƒëÖ -= 1; $b÷‚ó”°‚˜ -= (int) $dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][78]]; write_log("\x66\x69\x6c\145\x20\156\x6f\x74\40\145\x78\151\x73\x74\x2e\x66\151\154\x65\x49\104\72{$dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][461]]}\x2c\x20\160\x61\164\x68\72{$dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][76]]}", $_SERVER[©äõ½¡][818]); continue; } $cì¢‡Ô÷ƒ† = $dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][76]]; $C´ãÜì‘ÆÑ = "\x7b\x69\x6f\72{$dÁà‘’”ğ[$_SERVER[©äõ½¡][747]]}\x7d" . substr($cì¢‡Ô÷ƒ†, strlen("\x7b\151\x6f\72{$dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][819]]}\x7d")); goto FÓƒ‚ëÁ§ª; b„¥–¯º¼: $F¼µØÜ¤â» += $dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][78]]; $bõ¨É§°‰ += 1; $Fõ—¨ŒÆ†‘ += $dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][78]]; goto f¹ùÕ¿¾; FÓƒ‚ëÁ§ª: if (IO::exist($C´ãÜì‘ÆÑ)) { $eÒ‚ˆ¸«»½->updateFileEnd($dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][28]], $dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][78]]); } else { $C´ãÜì‘ÆÑ = get_path_father($C´ãÜì‘ÆÑ); IO::mkdir($C´ãÜì‘ÆÑ); if (!IO::copy($cì¢‡Ô÷ƒ†, $C´ãÜì‘ÆÑ, $_SERVER[©äõ½¡][820])) { write_log($_SERVER[©äõ½¡][821] . $cì¢‡Ô÷ƒ† . $_SERVER[©äõ½¡][804] . $C´ãÜì‘ÆÑ . $_SERVER[©äõ½¡][530], $_SERVER[©äõ½¡][777]); $AÚí¯Ù°Ç = !1; break; } } $b·ŸÑ¼¶ÚÑ = $dÒâ¿¬ÉÒ¾[$_SERVER[©äõ½¡][461]]; $A¸ùÌèªğİ += 1; goto b„¥–¯º¼; f¹ùÕ¿¾: if ($F¼µØÜ¤â» >= 1024 * 1024 * 100) { $d‘Üó……Šİ = array($_SERVER[©äõ½¡][822] => $b·ŸÑ¼¶ÚÑ, $_SERVER[©äõ½¡][823] => $bõ¨É§°‰, $_SERVER[©äõ½¡][824] => $Fõ—¨ŒÆ†‘); Backup::set($d‘Üó……Šİ); $F¼µØÜ¤â» = $A¸ùÌèªğİ = 0; } goto A‚‰Üó•ŒŒ; A‚‰Üó•ŒŒ: } $D©¯ì’¢Ù¤ = count($e–¤«¾¼á—); $c£ó „÷ÂĞ++; } while ($D©¯ì’¢Ù¤ == $E¶¢ÔåªÔæ); $eÒ‚ˆ¸«»½->end(); goto C‰õŠø´Ò‡; c•¾«‡ß¢: $dÁà‘’”ğ = Backup::get(); $b·ŸÑ¼¶ÚÑ = $dÁà‘’”ğ[$_SERVER[©äõ½¡][291]][$_SERVER[©äõ½¡][193]][$_SERVER[©äõ½¡][461]]; $f²„ïİ¶æÛ = array($_SERVER[©äõ½¡][462] => array($_SERVER[©äõ½¡][809], $b·ŸÑ¼¶ÚÑ), $_SERVER[©äõ½¡][810] => array($_SERVER[©äõ½¡][329], $dÁà‘’”ğ[$_SERVER[©äõ½¡][747]])); goto a›Èõ«Ÿ´æ; DÒâÅæ£: $this->_fileFilter($f«’¹ª¦ä¦); return !0; goto fš‹ƒÏƒØõ; eøæÕŠã: $AÚí¯Ù°Ç = !0; $CÇ§„íÙó = $this->storeIds(); $c£ó „÷ÂĞ = 1; goto fŞ†â’‰; fš‹ƒÏƒØõ: } private function _fileExist($B¼Ì´â¡ÊÜ, &$D¯Öğ÷×«ï, $F®ÚØØ²Ö) { goto B·îäÍ³Ã; EŞÑğÄíºÍ: if (IO::exist($B‚áÀ¶Ä¢)) { $D¯Öğ÷×«ï[] = $B¼Ì´â¡ÊÜ[$eøØÆ¢˜¿¶[461]]; return !1; } $BÒàÏÕØÌ = array($eøØÆ¢˜¿¶[819] => $B¼Ì´â¡ÊÜ[$eøØÆ¢˜¿¶[819]], $eøØÆ¢˜¿¶[76] => array($eøØÆ¢˜¿¶[381], "{$B‚áÀ¶Ä¢}\x25")); $A”±Ò­æôÃ = Model($eøØÆ¢˜¿¶[782])->where($BÒàÏÕØÌ)->field($eøØÆ¢˜¿¶[462])->select(); goto BğñÌÊ ¤£; CÁø¤”ë: if (!in_array($B¼Ì´â¡ÊÜ[$eøØÆ¢˜¿¶[819]], $F®ÚØØ²Ö)) { return !1; } if (IO::exist($añ”¸ÂŒ£é)) { return !0; } $B‚áÀ¶Ä¢ = get_path_father($añ”¸ÂŒ£é); goto EŞÑğÄíºÍ; BğñÌÊ ¤£: $D¯Öğ÷×«ï = array_merge($D¯Öğ÷×«ï, array_to_keyvalue($A”±Ò­æôÃ, $eøØÆ¢˜¿¶[33], $eøØÆ¢˜¿¶[461])); return !1; goto e˜¾ª‡Š³¾; B·îäÍ³Ã: $eøØÆ¢˜¿¶ =& $_SERVER[©äõ½¡]; $añ”¸ÂŒ£é = $B¼Ì´â¡ÊÜ[$eøØÆ¢˜¿¶[76]]; if (in_array($B¼Ì´â¡ÊÜ[$eøØÆ¢˜¿¶[461]], $D¯Öğ÷×«ï)) { return !1; } goto CÁø¤”ë; e˜¾ª‡Š³¾: } private function _fileFilter($Då–šÏ‰Â³) { $d¹Õ†°§¾ =& $_SERVER[©äõ½¡]; if (empty($Då–šÏ‰Â³)) { return; } $aåÑº‡®ù = array($d¹Õ†°§¾[461] => array($d¹Õ†°§¾[7], array_unique($Då–šÏ‰Â³))); $EŒƒ¡óñì = Model($d¹Õ†°§¾[827])->where($aåÑº‡®ù)->field($d¹Õ†°§¾[397])->select(); foreach ($EŒƒ¡óñì as $fÈª³ÃÔÍÚ) { Model($d¹Õ†°§¾[827])->remove($fÈª³ÃÔÍÚ[$d¹Õ†°§¾[397]], !1); } } private function storeIds() { $E¨¿Ñì• „ =& $_SERVER[©äõ½¡]; $eŒœŸ¶ÉĞ× = Model($E¨¿Ñì• „[762])->listData(); $cˆä‚äÇª = array(); $f‰†ˆÜ¿æ = $GLOBALS[$E¨¿Ñì• „[6]][$E¨¿Ñì• „[88]][$E¨¿Ñì• „[828]]; foreach ($eŒœŸ¶ÉĞ× as $D”Ëá¦‚ÛĞ) { $dô©½Úø´Ô = strtolower($D”Ëá¦‚ÛĞ[$E¨¿Ñì• „[94]]); if (!isset($f‰†ˆÜ¿æ[$dô©½Úø´Ô])) { continue; } $d¾à©±›È„ = $E¨¿Ñì• „[72] . (isset($f‰†ˆÜ¿æ[$dô©½Úø´Ô]) ? $f‰†ˆÜ¿æ[$dô©½Úø´Ô] : ucfirst($dô©½Úø´Ô)); if (!class_exists($d¾à©±›È„)) { continue; } $cˆä‚äÇª[] = $D”Ëá¦‚ÛĞ[$E¨¿Ñì• „[395]]; } return $cˆä‚äÇª; } } goto FØ¯„Œ°; cÑ‹’Î±Ù: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto aê…ñƒ‘‚; aÔÊŞÜåÄ: Hook::bind($D±½ÛÜ˜„­[1141], $D±½ÛÜ˜„­[1142]); Hook::bind($D±½ÛÜ˜„­[1143], $D±½ÛÜ˜„­[1144]); Hook::bind($D±½ÛÜ˜„­[1145], $D±½ÛÜ˜„­[1146]); goto EÜ˜Ç—âéİ; d›”ğ£í†: if ($cÂƒ›Í‚ÈŸ[$D±½ÛÜ˜„­[1137]] <= 0) { return; } if (isset($_REQUEST[$D±½ÛÜ˜„­[1138]]) && $_REQUEST[$D±½ÛÜ˜„­[1138]] == $D±½ÛÜ˜„­[87]) { return; } Hook::bind($D±½ÛÜ˜„­[1139], $D±½ÛÜ˜„­[1140]); goto aÔÊŞÜåÄ; aê…ñƒ‘‚: $D±½ÛÜ˜„­ =& $_SERVER[©äõ½¡]; $cÂƒ›Í‚ÈŸ = $GLOBALS[$D±½ÛÜ˜„­[6]][$D±½ÛÜ˜„­[88]]; if ($cÂƒ›Í‚ÈŸ[$D±½ÛÜ˜„­[1136]] != 1) { return; } goto d›”ğ£í†; EÜ˜Ç—âéİ: Hook::bind($D±½ÛÜ˜„­[1147], $D±½ÛÜ˜„­[1148]); Hook::bind($D±½ÛÜ˜„­[1149], $D±½ÛÜ˜„­[1150]); goto dÆ«Ì£Œ¨Û; dÆ«Ì£Œ¨Û: } public static function eventBeforeUpload($eÏê¤÷‡¾¶) { if ($eÏê¤÷‡¾¶[3] && $eÏê¤÷‡¾¶[3] != REPEAT_REPLACE) { return; } $C–¿ëªßí = self::parsePath($eÏê¤÷‡¾¶[0]); if (!$C–¿ëªßí) { return; } self::add($C–¿ëªßí); } public static function eventBeforeEdit($aÍ›×ô†¾­) { $fëğ‹‹• = self::parsePath($aÍ›×ô†¾­[0]); if (!$fëğ‹‹•) { return; } self::add($fëğ‹‹•); } public static function eventBeforeCopyFile($b”É†œïÅÌ, $bòâ‡¸¬Ã», $Eø‹ì¦ëÇ‰, $Aæè šœÍ¹, $FÇ»ã²Îòë, $Eê¢›Ö¾Îø) { $f‡ê§è’Í = $Eø‹ì¦ëÇ‰->getPathOuter($Aæè šœÍ¹); $dŸ¾›‰ç®ƒ = self::parsePath($f‡ê§è’Í); if (!$dŸ¾›‰ç®ƒ) { return; } self::add($dŸ¾›‰ç®ƒ); } public static function eventBeforeRename($D¦øÃ½ò‚­) { $bÄÖ…Ì‰Ö± =& $_SERVER[©äõ½¡]; $DöÉÎ˜¾Øå = self::parsePath($D¦øÃ½ò‚­[0]); if (!$DöÉÎ˜¾Øå) { return; } $Dîˆ¾é¡ÚÍ = self::checkInHistory($DöÉÎ˜¾Øå); if (!$Dîˆ¾é¡ÚÍ) { return; } if ($Dîˆ¾é¡ÚÍ[$bÄÖ…Ì‰Ö±[29]] == $bÄÖ…Ì‰Ö±[193]) { $BëëšÑóĞÆ = self::listData($DöÉÎ˜¾Øå); if ($BëëšÑóĞÆ && $BëëšÑóĞÆ[$bÄÖ…Ì‰Ö±[367]]) { self::moveHistory($DöÉÎ˜¾Øå, $D¦øÃ½ò‚­[1]); } } else { IO::rename($Dîˆ¾é¡ÚÍ[$bÄÖ…Ì‰Ö±[76]], $D¦øÃ½ò‚­[1]); } } public static function eventBeforeMove($C·ëË¦óÅ¸) { goto CÛÃõ’‡æÎ; CÛÃõ’‡æÎ: $a§†ËÙçÔ =& $_SERVER[©äõ½¡]; $BñÜ±‹½ = self::parsePath($C·ëË¦óÅ¸[0]); if (!$BñÜ±‹½) { return; } goto D¥¨ù×ó¨°; böôç‹ÍÏ: $E’å¶È÷é¿ = self::checkInHistory($BñÜ±‹½); if (!$E’å¶È÷é¿) { return; } $C§ Æ¾ç¥ğ = self::pathHistory($B­÷ÛŠ¦ÈÚ); goto bÈÃ°†„Ë¬; bÈÃ°†„Ë¬: if ($E’å¶È÷é¿[$a§†ËÙçÔ[29]] == $a§†ËÙçÔ[193]) { $e·ºÕ†Ÿ·Ğ = self::listData($BñÜ±‹½); $a…ë„“Œ—„ = rtrim($B­÷ÛŠ¦ÈÚ, $a§†ËÙçÔ[8]) . $a§†ËÙçÔ[8] . ($AÊõø±©ã ? $AÊõø±©ã : get_path_this($BñÜ±‹½)); $f¼äŠ¡ëñ = self::listData($a…ë„“Œ—„); if ($e·ºÕ†Ÿ·Ğ && $e·ºÕ†Ÿ·Ğ[$a§†ËÙçÔ[367]] && $f¼äŠ¡ëñ && $f¼äŠ¡ëñ[$a§†ËÙçÔ[367]]) { return self::clear($BñÜ±‹½); } if ($e·ºÕ†Ÿ·Ğ && $e·ºÕ†Ÿ·Ğ[$a§†ËÙçÔ[367]]) { self::moveHistory($BñÜ±‹½, $AÊõø±©ã, $C§ Æ¾ç¥ğ); } } else { IO::move($E’å¶È÷é¿[$a§†ËÙçÔ[76]], $C§ Æ¾ç¥ğ, !1, $AÊõø±©ã); self::clearEmptyFolder(IO::pathFather($E’å¶È÷é¿[$a§†ËÙçÔ[76]])); } goto AÀÙ‡×ˆ’; D¥¨ù×ó¨°: $B­÷ÛŠ¦ÈÚ = self::parsePath($C·ëË¦óÅ¸[1]); if (!$B­÷ÛŠ¦ÈÚ) { return; } $AÊõø±©ã = $C·ëË¦óÅ¸[3]; goto böôç‹ÍÏ; AÀÙ‡×ˆ’: } public static function eventAfterRemove($DÙäÓÈ·•š, $c³ƒÁ¸ëËŸ) { goto bŠ…ëÉ’©; AÏ‘ÛÍ³£: if (!$d‚İğ¢ç¹ì) { return; } $BŒÉÙ——‚ = self::checkInHistory($d‚İğ¢ç¹ì); if (!$BŒÉÙ——‚) { return; } goto D¹öôâ¶ëƒ; D¹öôâ¶ëƒ: if ($BŒÉÙ——‚[$Bà„¡èÔ©Ë[29]] == $Bà„¡èÔ©Ë[193]) { $FšÖ‹Ö³ = self::listData($d‚İğ¢ç¹ì, !1); if ($FšÖ‹Ö³ && $FšÖ‹Ö³[$Bà„¡èÔ©Ë[367]]) { self::clear($d‚İğ¢ç¹ì, !1); } } else { IO::remove($BŒÉÙ——‚[$Bà„¡èÔ©Ë[76]]); self::clearEmptyFolder(IO::pathFather($BŒÉÙ——‚[$Bà„¡èÔ©Ë[76]])); } goto DÆÂ¢ø‘‹; bŠ…ëÉ’©: $Bà„¡èÔ©Ë =& $_SERVER[©äõ½¡]; if (!$c³ƒÁ¸ëËŸ) { return; } $d‚İğ¢ç¹ì = self::parsePath($DÙäÓÈ·•š[0]); goto AÏ‘ÛÍ³£; DÆÂ¢ø‘‹: } private static function checkInHistory($d¹–‡ù¹óŒ) { $AÊ•¡˜ÕËÖ = self::pathHistory($d¹–‡ù¹óŒ); if (!IO::exist($AÊ•¡˜ÕËÖ)) { $AÊ•¡˜ÕËÖ .= $_SERVER[©äõ½¡][1151]; } return IO::exist($AÊ•¡˜ÕËÖ) ? IO::info($AÊ•¡˜ÕËÖ) : !1; } private static function parsePath($aãÎ•ÀÅ°) { goto F†¹ êÄÊ; aÈÕœ°¤ÈÊ: if (!$F–õ“òŠöâ || !$c¬Â‚°Ñì³[$E®–‹É–…[1153]]) { return !1; } if (substr($aãÎ•ÀÅ°, 0, strlen(DATA_PATH . $E®–‹É–…[1154])) == DATA_PATH . $E®–‹É–…[1154]) { return !1; } if ($Cç…ñ‚ÊİÌ == KodIO::KOD_SHARE_ITEM) { $f‡˜¡šÜ’á = IO::init($aãÎ•ÀÅ°); if ($f‡˜¡šÜ’á->pathParse[$E®–‹É–…[1081]]) { return self::parsePath($f‡˜¡šÜ’á->pathParse[$E®–‹É–…[1081]]); } return !1; } goto Fà‹Îõ×•; F†¹ êÄÊ: $E®–‹É–… =& $_SERVER[©äõ½¡]; if (!$aãÎ•ÀÅ°) { return !1; } if ($GLOBALS[$E®–‹É–…[1152]]) { return; } goto AĞ‘×È†“ã; F¨İôğ©: self::log($GLOBALS[$E®–‹É–…[1076]] . $E®–‹É–…[1156] . $aãÎ•ÀÅ°); return $aãÎ•ÀÅ°; goto a˜šÜ‘ˆíï; Fà‹Îõ×•: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $F³•ëË“›ë = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $E®–‹É–…[1155]); foreach ($F³•ëË“›ë as $bì°Ÿñ„àÀ) { if (!$Cç…ñ‚ÊİÌ && substr($aãÎ•ÀÅ°, 0, strlen($bì°Ÿñ„àÀ)) == $bì°Ÿñ„àÀ) { return !1; } } goto F¨İôğ©; AĞ‘×È†“ã: $c¬Â‚°Ñì³ = KodIO::parse($aãÎ•ÀÅ°); $Cç…ñ‚ÊİÌ = $c¬Â‚°Ñì³[$E®–‹É–…[29]]; $F–õ“òŠöâ = !$Cç…ñ‚ÊİÌ || $Cç…ñ‚ÊİÌ == KodIO::KOD_IO || $Cç…ñ‚ÊİÌ == KodIO::KOD_SHARE_ITEM; goto aÈÕœ°¤ÈÊ; a˜šÜ‘ˆíï: } private static function pathHistory($aÓøù©ğÚ‡) { $a„¶Ğ±çö¹ =& $_SERVER[©äõ½¡]; $Bñ¡İĞ·åÂ = self::$_historyBase . ltrim(KodIO::clear($aÓøù©ğÚ‡), $a„¶Ğ±çö¹[8]); $Bñ¡İĞ·åÂ = str_replace(array($a„¶Ğ±çö¹[1157]), array($a„¶Ğ±çö¹[1158]), $Bñ¡İĞ·åÂ); return $Bñ¡İĞ·åÂ; } public static function log($fæø»ÛÊ’) { } public static function historyCount($BÂÈª“ŒÑ) { $FŒĞ“ì˜§Ÿ =& $_SERVER[©äõ½¡]; $d¤³‡éŒ”Ú = array(); $BÆÌøè¥ä› = array(); foreach ($BÂÈª“ŒÑ as $D¸ÂÁÌÕ¯) { $f–×ÖØ¤à• = get_path_father($D¸ÂÁÌÕ¯); if (!$BÆÌøè¥ä›[$f–×ÖØ¤à•]) { $BÆÌøè¥ä›[$f–×ÖØ¤à•] = array(); } $BÆÌøè¥ä›[$f–×ÖØ¤à•][] = get_path_this($D¸ÂÁÌÕ¯); } foreach ($BÆÌøè¥ä› as $f–×ÖØ¤à• => $dä°¿‡·•”) { $f“Õ½÷ç = self::parsePath($f–×ÖØ¤à•); if (!$f“Õ½÷ç) { continue; } foreach ($dä°¿‡·•” as $Dâ÷‰…ÜŒ) { $Aí¬ì³¡æ = self::listData(rtrim($f“Õ½÷ç, $FŒĞ“ì˜§Ÿ[8]) . $FŒĞ“ì˜§Ÿ[8] . $Dâ÷‰…ÜŒ, !1); if ($Aí¬ì³¡æ && $Aí¬ì³¡æ[$FŒĞ“ì˜§Ÿ[367]]) { $d¤³‡éŒ”Ú[rtrim($f–×ÖØ¤à•, $FŒĞ“ì˜§Ÿ[8]) . $FŒĞ“ì˜§Ÿ[8] . $Dâ÷‰…ÜŒ] = count($Aí¬ì³¡æ[$FŒĞ“ì˜§Ÿ[367]]); } } } return $d¤³‡éŒ”Ú; } public static function add($BÖ¸Î¸ğ­) { goto A‡Óã¾¨; D£ŠšÌô­¥: $F¾¬‘Ù½ôì = Model($D³¡Ì£ƒñ¼[765])->get($D³¡Ì£ƒñ¼[1159]); $aõ½›ôÜ‰Š = $GLOBALS[$D³¡Ì£ƒñ¼[6]][$D³¡Ì£ƒñ¼[88]][$D³¡Ì£ƒñ¼[1137]]; $BÍ‹Ñ›Íø = $F¾¬‘Ù½ôì == $D³¡Ì£ƒñ¼[1160] ? 5 : $aõ½›ôÜ‰Š; goto D¾Ò³¾¾£Ë; f¸Š‚Æ´¤: $dèôï¦±Ç = $C—™ïµæ¼[$D³¡Ì£ƒñ¼[367]]; if ($FÔäÓ›Àëè[$D³¡Ì£ƒñ¼[78]] == 0) { return; } if ($FÔäÓ›Àëè[$D³¡Ì£ƒñ¼[78]] >= 1024 * 1024 * 500) { return !1; } goto BòŸõÜŸö¬; f¿‰†îî¡Ã: return self::saveData($C—™ïµæ¼[$D³¡Ì£ƒñ¼[1164]], $dèôï¦±Ç); goto Añ„Ûâ‚İ; Eµİãùø‚†: $D¶Î†òƒ”© = array($D³¡Ì£ƒñ¼[395] => $C«ã™”“£È, $D³¡Ì£ƒñ¼[171] => $D÷†á®«å, $D³¡Ì£ƒñ¼[28] => $FÔäÓ›Àëè[$D³¡Ì£ƒñ¼[28]] . $D³¡Ì£ƒñ¼[95] . date($D³¡Ì£ƒñ¼[1161]) . rand_string(1), $D³¡Ì£ƒñ¼[78] => $FÔäÓ›Àëè[$D³¡Ì£ƒñ¼[78]], $D³¡Ì£ƒñ¼[446] => USER_ID, $D³¡Ì£ƒñ¼[194] => time(), $D³¡Ì£ƒñ¼[1162] => $D³¡Ì£ƒñ¼[33]); IO::mkdir($C—™ïµæ¼[$D³¡Ì£ƒñ¼[1163]]); $b¤Ô›‡õµ = IO::copy($BÖ¸Î¸ğ­, $C—™ïµæ¼[$D³¡Ì£ƒñ¼[1163]], !1, $D¶Î†òƒ”©[$D³¡Ì£ƒñ¼[28]]); goto E‰ºŠ·ÆÓ; D¾Ò³¾¾£Ë: if ($aõ½›ôÜ‰Š <= 0) { return; } $D÷†á®«å = IO::hashSimple($BÖ¸Î¸ğ­); $FÔäÓ›Àëè = IO::info($BÖ¸Î¸ğ­); goto f¸Š‚Æ´¤; BòŸõÜŸö¬: if ($dèôï¦±Ç && $dèôï¦±Ç[0][$D³¡Ì£ƒñ¼[171]] == $D÷†á®«å) { return !0; } if (array_key_exists($D³¡Ì£ƒñ¼[196], $FÔäÓ›Àëè) && !$FÔäÓ›Àëè[$D³¡Ì£ƒñ¼[196]]) { return !1; } $C«ã™”“£È = short_id(time()); goto Eµİãùø‚†; A‡Óã¾¨: $D³¡Ì£ƒñ¼ =& $_SERVER[©äõ½¡]; $C—™ïµæ¼ = self::listData($BÖ¸Î¸ğ­); if (!$C—™ïµæ¼) { return; } goto D£ŠšÌô­¥; E‰ºŠ·ÆÓ: if (!$b¤Ô›‡õµ) { self::clearEmptyFolder($C—™ïµæ¼[$D³¡Ì£ƒñ¼[1163]]); return !1; } array_unshift($dèôï¦±Ç, $D¶Î†òƒ”©); if (count($dèôï¦±Ç) > $BÍ‹Ñ›Íø) { $c°ùñõ˜ê = array_slice($dèôï¦±Ç, $BÍ‹Ñ›Íø); foreach ($c°ùñõ˜ê as $eÂ‘éÈÏÇ½) { IO::remove($C—™ïµæ¼[$D³¡Ì£ƒñ¼[1163]] . $eÂ‘éÈÏÇ½[$D³¡Ì£ƒñ¼[28]]); } $dèôï¦±Ç = array_slice($dèôï¦±Ç, 0, $BÍ‹Ñ›Íø); } goto f¿‰†îî¡Ã; Añ„Ûâ‚İ: } public static function remove($d­–Ğ¹–Ñ¥, $e·Íİ­ÁÂ£) { $bÛ™Û’‹Ú™ =& $_SERVER[©äõ½¡]; $Cµ Í§æ‘Ÿ = self::listData($d­–Ğ¹–Ñ¥); $d…™¸ÉğÉ­ = array(); if (!$Cµ Í§æ‘Ÿ) { return !1; } foreach ($Cµ Í§æ‘Ÿ[$bÛ™Û’‹Ú™[367]] as $cÚô™Ûòê) { if ($cÚô™Ûòê[$bÛ™Û’‹Ú™[395]] == $e·Íİ­ÁÂ£) { IO::remove($Cµ Í§æ‘Ÿ[$bÛ™Û’‹Ú™[1163]] . $cÚô™Ûòê[$bÛ™Û’‹Ú™[28]]); continue; } $d…™¸ÉğÉ­[] = $cÚô™Ûòê; } return self::saveData($Cµ Í§æ‘Ÿ[$bÛ™Û’‹Ú™[1164]], $d…™¸ÉğÉ­); } public static function clear($B‘Ê¬ì‚“Ã, $AğÉÓ²ˆ˜¬ = true) { $eôºé¢¿Şæ =& $_SERVER[©äõ½¡]; $A¶À®Òó× = self::listData($B‘Ê¬ì‚“Ã, $AğÉÓ²ˆ˜¬); if (!$A¶À®Òó×) { return !1; } foreach ($A¶À®Òó×[$eôºé¢¿Şæ[367]] as $C°ÛöÆÉóÖ) { IO::remove($A¶À®Òó×[$eôºé¢¿Şæ[1163]] . $C°ÛöÆÉóÖ[$eôºé¢¿Şæ[28]]); } return self::saveData($A¶À®Òó×[$eôºé¢¿Şæ[1164]], array()); } public static function moveHistory($fë¥ÑƒƒÈ×, $CõâÄ×¾È× = '', $eÓäœÖ®‚  = '') { goto A—­øƒ‰Ñ‰; CØ«íî£: $bŞù©¿›Íñ = $AéÄŒØ„—­[1151]; $CõâÄ×¾È× = $CõâÄ×¾È× ? $CõâÄ×¾È× : get_path_this($fë¥ÑƒƒÈ×); $eÓäœÖ®‚  = $eÓäœÖ®‚  ? $eÓäœÖ®‚  : $d·éµ™¾˜¤[$AéÄŒØ„—­[1163]]; goto e»¸„„›Ü; e»¸„„›Ü: $dìÑ‚ï¯”ì = substr(get_path_this($d·éµ™¾˜¤[$AéÄŒØ„—­[1164]]), 0, -strlen($bŞù©¿›Íñ)); foreach ($d·éµ™¾˜¤[$AéÄŒØ„—­[367]] as $E¤ÌÖãµ« => $B¶Å¢­ƒäµ) { $bŠ‘¯Ú¼¼ = $CõâÄ×¾È× . substr($B¶Å¢­ƒäµ[$AéÄŒØ„—­[28]], strlen($dìÑ‚ï¯”ì)); $cä‘è÷øÍ¸ = IO::move($d·éµ™¾˜¤[$AéÄŒØ„—­[1163]] . $B¶Å¢­ƒäµ[$AéÄŒØ„—­[28]], $eÓäœÖ®‚ , !1, $bŠ‘¯Ú¼¼); if ($cä‘è÷øÍ¸) { $d·éµ™¾˜¤[$AéÄŒØ„—­[367]][$E¤ÌÖãµ«][$AéÄŒØ„—­[28]] = $bŠ‘¯Ú¼¼; } } $d·éµ™¾˜¤[$AéÄŒØ„—­[1164]] = IO::move($d·éµ™¾˜¤[$AéÄŒØ„—­[1164]], $eÓäœÖ®‚ , !1, $CõâÄ×¾È× . $bŞù©¿›Íñ); goto f°§¦˜ïŠÈ; f°§¦˜ïŠÈ: self::saveData($d·éµ™¾˜¤[$AéÄŒØ„—­[1164]], $d·éµ™¾˜¤[$AéÄŒØ„—­[367]]); self::clearEmptyFolder($d·éµ™¾˜¤[$AéÄŒØ„—­[1163]]); goto fÌâÍ…‰º‘; A—­øƒ‰Ñ‰: $AéÄŒØ„—­ =& $_SERVER[©äõ½¡]; $d·éµ™¾˜¤ = self::listData($fë¥ÑƒƒÈ×, !1); if (!$d·éµ™¾˜¤ || !$d·éµ™¾˜¤[$AéÄŒØ„—­[367]]) { return !1; } goto CØ«íî£; fÌâÍ…‰º‘: } public static function rollback($c³„¨ó©÷š, $DÌî›Ú¡ İ) { $AÎ­‘…½Òç =& $_SERVER[©äõ½¡]; $C­íö¸ = self::listData($c³„¨ó©÷š); if (!$C­íö¸) { return; } $A‹ñª‡¦°¾ = IO::info($c³„¨ó©÷š); foreach ($C­íö¸[$AÎ­‘…½Òç[367]] as $E¡×¸õ¢«Ö => $aŸ†ÊŞÏáŒ) { if ($aŸ†ÊŞÏáŒ[$AÎ­‘…½Òç[395]] == $DÌî›Ú¡ İ) { self::add($c³„¨ó©÷š); $Aà´Ë–éš  = $C­íö¸[$AÎ­‘…½Òç[1163]] . $aŸ†ÊŞÏáŒ[$AÎ­‘…½Òç[28]]; $EæÇğóøùÀ = IO::copy($Aà´Ë–éš , IO::pathFather($c³„¨ó©÷š), REPEAT_REPLACE, $A‹ñª‡¦°¾[$AÎ­‘…½Òç[28]]); if ($EæÇğóøùÀ) { self::remove($c³„¨ó©÷š, $DÌî›Ú¡ İ); } return $EæÇğóøùÀ; } } return !1; } public static function setDetail($e¡Ø«’‘©, $CÙ»÷£ŞÍ, $E·¯‹™Ëˆ×) { $f¨•‘‘ì‹ =& $_SERVER[©äõ½¡]; $BÕ¨²ë¶âœ = self::listData($e¡Ø«’‘©); if (!$BÕ¨²ë¶âœ) { return; } foreach ($BÕ¨²ë¶âœ[$f¨•‘‘ì‹[367]] as $F›£ª‚òğè => $BÌ‹Úä´Àõ) { if ($BÌ‹Úä´Àõ[$f¨•‘‘ì‹[395]] == $CÙ»÷£ŞÍ) { $BÕ¨²ë¶âœ[$f¨•‘‘ì‹[367]][$F›£ª‚òğè][$f¨•‘‘ì‹[1162]] = $E·¯‹™Ëˆ×; self::saveData($BÕ¨²ë¶âœ[$f¨•‘‘ì‹[1164]], $BÕ¨²ë¶âœ[$f¨•‘‘ì‹[367]]); return !0; } } return !1; } public static function fileInfo($B‹ãŞ“Ÿê, $f‹ÉÚ…ò¦) { goto CÈÁÉ¤™®†; CÈÁÉ¤™®†: $Eİ¶±ŠÒµ‚ =& $_SERVER[©äõ½¡]; $d¯§ƒ¢µßÙ = self::listData($B‹ãŞ“Ÿê); if (!$d¯§ƒ¢µßÙ) { show_json(LNG($Eİ¶±ŠÒµ‚[105]), !1); } goto FĞ„Ã˜İò; FĞ„Ã˜İò: $F×°·Üİó = $Eİ¶±ŠÒµ‚[33]; foreach ($d¯§ƒ¢µßÙ[$Eİ¶±ŠÒµ‚[367]] as $Eİí‹İêä¶ => $DÖ´œÖ±µ§) { if ($DÖ´œÖ±µ§[$Eİ¶±ŠÒµ‚[395]] != $f‹ÉÚ…ò¦) { continue; } $F×°·Üİó = $d¯§ƒ¢µßÙ[$Eİ¶±ŠÒµ‚[1163]] . $DÖ´œÖ±µ§[$Eİ¶±ŠÒµ‚[28]]; break; } if (!$F×°·Üİó) { show_json(LNG($Eİ¶±ŠÒµ‚[105]), !1); } goto báéÜšµ¦À; báéÜšµ¦À: return IO::info($F×°·Üİó); goto E¦“İ¿Œá; E¦“İ¿Œá: } public static function fileOut($EÅ‚¯Ú±Õ , $F¤ßì²²ùº, $fãöçĞ’÷ = false) { $F°©‡ÅªÇÂ =& $_SERVER[©äõ½¡]; $D«¥»Ú¸¦ñ = self::fileInfo($EÅ‚¯Ú±Õ , $F¤ßì²²ùº); $e÷‰åİÄÇà =& $GLOBALS[$F°©‡ÅªÇÂ[7]]; $fãöçĞ’÷ = isset($e÷‰åİÄÇà[$F°©‡ÅªÇÂ[1127]]) && $e÷‰åİÄÇà[$F°©‡ÅªÇÂ[1127]] == 1; if (isset($e÷‰åİÄÇà[$F°©‡ÅªÇÂ[29]]) && $e÷‰åİÄÇà[$F°©‡ÅªÇÂ[29]] == $F°©‡ÅªÇÂ[1165]) { return IO::fileOutImage($D«¥»Ú¸¦ñ[$F°©‡ÅªÇÂ[76]], $e÷‰åİÄÇà[$F°©‡ÅªÇÂ[1166]]); } IO::fileOut($D«¥»Ú¸¦ñ[$F°©‡ÅªÇÂ[76]], $fãöçĞ’÷, get_path_this($EÅ‚¯Ú±Õ )); } public static function listData($bÒÜ…íàİ, $cêíÀ ùµä = true) { goto Eã­‘ ³¹÷; eÃ°£›ØË: if (substr($bÒÜ…íàİ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $D²¿™¤¥å¤ = self::pathHistory($bÒÜ…íàİ); $aÂ×Ë®ë¥ë = array($CŞ†°å—©[1164] => $D²¿™¤¥å¤ . $CŞ†°å—©[1151], $CŞ†°å—©[1163] => rtrim(get_path_father($D²¿™¤¥å¤), $CŞ†°å—©[8]) . $CŞ†°å—©[8], $CŞ†°å—©[367] => array()); goto FÙ—®Š¥µ; FÙ—®Š¥µ: $dŠ¥‘Õ¬º¦ = IO::getContent($aÂ×Ë®ë¥ë[$CŞ†°å—©[1164]]); if ($dŠ¥‘Õ¬º¦) { $aïÎÈ“Ú±¥ = json_decode($dŠ¥‘Õ¬º¦, !0); if (is_array($aïÎÈ“Ú±¥)) { $aÂ×Ë®ë¥ë[$CŞ†°å—©[367]] = $aïÎÈ“Ú±¥; } } return $aÂ×Ë®ë¥ë; goto Cà˜ŒŒ¨ ; Eã­‘ ³¹÷: $CŞ†°å—© =& $_SERVER[©äõ½¡]; if ($cêíÀ ùµä && !IO::exist($bÒÜ…íàİ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto eÃ°£›ØË; Cà˜ŒŒ¨ : } private static function saveData($a½ä¯ì¹—Ğ, $E¨Ì‹çâˆé) { goto dÃù­ÎÚƒ; Aù¡Ş¡ºÙ…: return !0; goto B†İ¥»Ñ¬; dÃù­ÎÚƒ: $dğÎÊÁ„¡Ï =& $_SERVER[©äõ½¡]; self::log($dğÎÊÁ„¡Ï[1167] . $a½ä¯ì¹—Ğ . $dğÎÊÁ„¡Ï[68] . count($E¨Ì‹çâˆé), $dğÎÊÁ„¡Ï[747]); if ($E¨Ì‹çâˆé) { return IO::setContent($a½ä¯ì¹—Ğ, json_encode($E¨Ì‹çâˆé)); } goto A‰‚ÒÙÌšà; A‰‚ÒÙÌšà: $cœ›Î¾İ­Å = IO::pathFather($a½ä¯ì¹—Ğ); IO::remove($a½ä¯ì¹—Ğ); self::clearEmptyFolder($cœ›Î¾İ­Å); goto Aù¡Ş¡ºÙ…; B†İ¥»Ñ¬: } public static function clearEmptyFolder($eÙëø¿»­) { goto c±Ï•¿İ¯î; b“àÇ¡íÁ: self::clearEmptyFolder($eŒÒĞâ£éƒ); goto D…½‹Ã–Ò; CßÒà«äø¾: $cİãŞÙ¿• = IO::has($eÙëø¿»­, !0); if ($cİãŞÙ¿•[$a÷ô¸¨ï´­[203]] > 0 || $cİãŞÙ¿•[$a÷ô¸¨ï´­[204]] > 0) { return; } IO::remove($eÙëø¿»­); goto b“àÇ¡íÁ; c±Ï•¿İ¯î: $a÷ô¸¨ï´­ =& $_SERVER[©äõ½¡]; if (trim($eÙëø¿»­, $a÷ô¸¨ï´­[8]) == trim(self::$_historyBase, $a÷ô¸¨ï´­[8])) { return; } $eŒÒĞâ£éƒ = IO::pathFather($eÙëø¿»­); goto CßÒà«äø¾; D…½‹Ã–Ò: } private static function getBasePath() { goto Bª‹ğø‘õ; AÈ¤Ù„‡Ë„: return $bÇ…‡¶ˆ¸; goto eŸŸâÏõ¬Û; b¹îÅ²œ¹ì: $bÇ…‡¶ˆ¸ = DATA_PATH . $eÖÔÉË›•Ñ[1170] . rand_string(8) . $eÖÔÉË›•Ñ[8]; $bÇ…‡¶ˆ¸ = IO::mkdir($bÇ…‡¶ˆ¸); $bÇ…‡¶ˆ¸ = rtrim($bÇ…‡¶ˆ¸, $eÖÔÉË›•Ñ[8]) . $eÖÔÉË›•Ñ[8]; goto fŠë¦³ñ†³; Bª‹ğø‘õ: $eÖÔÉË›•Ñ =& $_SERVER[©äõ½¡]; $bÇ…‡¶ˆ¸ = Model($eÖÔÉË›•Ñ[1168])->get($eÖÔÉË›•Ñ[1169]); if ($bÇ…‡¶ˆ¸) { if (!IO::exist($bÇ…‡¶ˆ¸)) { IO::mkdir($bÇ…‡¶ˆ¸); } if (get_path_this($bÇ…‡¶ˆ¸) == $eÖÔÉË›•Ñ[1154]) { $B¹Äå×Ü›ù = $eÖÔÉË›•Ñ[1170] . rand_string(8); @rename($bÇ…‡¶ˆ¸, get_path_father($bÇ…‡¶ˆ¸) . $eÖÔÉË›•Ñ[8] . $B¹Äå×Ü›ù); $bÇ…‡¶ˆ¸ = DATA_PATH . $B¹Äå×Ü›ù . $eÖÔÉË›•Ñ[8]; file_put_contents(DATA_PATH . $eÖÔÉË›•Ñ[1171], $eÖÔÉË›•Ñ[33]); Model($eÖÔÉË›•Ñ[1168])->set($eÖÔÉË›•Ñ[1169], $bÇ…‡¶ˆ¸); } return $bÇ…‡¶ˆ¸; } goto b¹îÅ²œ¹ì; fŠë¦³ñ†³: file_put_contents($bÇ…‡¶ˆ¸ . $eÖÔÉË›•Ñ[1171], $eÖÔÉË›•Ñ[33]); file_put_contents(DATA_PATH . $eÖÔÉË›•Ñ[1171], $eÖÔÉË›•Ñ[33]); Model($eÖÔÉË›•Ñ[1168])->set($eÖÔÉË›•Ñ[1169], $bÇ…‡¶ˆ¸); goto AÈ¤Ù„‡Ë„; eŸŸâÏõ¬Û: } } class KodIO { const KOD_SOURCE = "\173\x73\157\x75\x72\x63\145\x7d"; const KOD_USER_RECYCLE = "\x7b\x75\163\145\162\122\x65\x63\x79\x63\154\145\x7d"; const KOD_USER_FAV = "\173\165\163\x65\162\x46\141\x76\175"; const KOD_USER_FILE_TAG = "\x7b\165\x73\x65\162\106\x69\x6c\145\124\141\x67\175"; const KOD_USER_FILE_TYPE = "\x7b\x75\163\x65\x72\x46\x69\154\145\x54\171\x70\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\162\x6f\165\x70\122\157\x6f\x74\x53\x65\154\146\x7d"; const KOD_USER_SHARE = "\x7b\x75\x73\x65\x72\x53\150\141\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\165\163\x65\x72\x53\x68\141\162\x65\x4c\151\156\153\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\141\162\x65\124\157\115\x65\175"; const KOD_SHARE_ITEM = "\173\x73\x68\141\162\x65\x49\x74\145\x6d\x7d"; const KOD_SHARE_LINK = "\x7b\163\x68\141\x72\145\x49\x74\145\155\114\x69\x6e\x6b\x7d"; const KOD_SEARCH = "\x7b\x73\x65\x61\162\x63\x68\175"; const KOD_BLOCK = "\x7b\142\x6c\x6f\143\153\x7d"; const KOD_IO = "\173\x69\x6f\175"; const KOD_USER_RECENT = "\x7b\x75\163\x65\x72\x52\x65\156\x63\x65\x6e\164\x7d"; const KOD_USER_DRIVER = "\173\144\x72\x69\x76\x65\x72\175"; public static function typeList() { $FÅ­ŸØÀŒ„ =& $_SERVER[©äõ½¡]; return array($FÅ­ŸØÀŒ„[1172] => self::KOD_SOURCE, $FÅ­ŸØÀŒ„[1173] => self::KOD_USER_RECYCLE, $FÅ­ŸØÀŒ„[1174] => self::KOD_USER_FAV, $FÅ­ŸØÀŒ„[1175] => self::KOD_USER_FILE_TAG, $FÅ­ŸØÀŒ„[1176] => self::KOD_USER_FILE_TYPE, $FÅ­ŸØÀŒ„[1177] => self::KOD_GROUP_ROOT_SELF, $FÅ­ŸØÀŒ„[1178] => self::KOD_USER_SHARE, $FÅ­ŸØÀŒ„[1179] => self::KOD_USER_SHARE_LINK, $FÅ­ŸØÀŒ„[1180] => self::KOD_USER_SHARE_TO_ME, $FÅ­ŸØÀŒ„[1181] => self::KOD_SHARE_ITEM, $FÅ­ŸØÀŒ„[1182] => self::KOD_SHARE_LINK, $FÅ­ŸØÀŒ„[1183] => self::KOD_SEARCH, $FÅ­ŸØÀŒ„[1184] => self::KOD_BLOCK, $FÅ­ŸØÀŒ„[1185] => self::KOD_IO, $FÅ­ŸØÀŒ„[1186] => self::KOD_USER_RECENT, $FÅ­ŸØÀŒ„[1187] => self::KOD_USER_DRIVER); } public static function parse($DÚå­¾…ê¶) { goto Fï‡¬´ŒÅÏ; Fï‡¬´ŒÅÏ: $F†Ñ÷áğ–© =& $_SERVER[©äõ½¡]; $DÚå­¾…ê¶ = self::clear($DÚå­¾…ê¶); $D¤ÍÌãõ‘› = array_values(self::typeList()); goto EÜğ¿Îíˆ¡; Dõ•Œ²ÙÊ½: $a…ĞÒ•¯µ› = array($F†Ñ÷áğ–©[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $FÊÔ”İ[$F†Ñ÷áğ–©[1153]] = in_array($FÊÔ”İ[$F†Ñ÷áğ–©[29]], $a…ĞÒ•¯µ›); return $FÊÔ”İ; goto F¼±¼ÓçÕó; EÜğ¿Îíˆ¡: preg_match($F†Ñ÷áğ–©[1188], $DÚå­¾…ê¶, $cˆ¯µ¸ç); $FÊÔ”İ = array($F†Ñ÷áğ–©[417] => !1, $F†Ñ÷áğ–©[1189] => !1, $F†Ñ÷áğ–©[414] => !1, $F†Ñ÷áğ–©[76] => $DÚå­¾…ê¶, $F†Ñ÷áğ–©[1098] => !1, $F†Ñ÷áğ–©[1097] => $F†Ñ÷áğ–©[33]); if (is_array($cˆ¯µ¸ç) && count($cˆ¯µ¸ç) == 5) { $fµ‰‚‰Şä = $F†Ñ÷áğ–©[1190] . $cˆ¯µ¸ç[2] . $F†Ñ÷áğ–©[325]; if (in_array($fµ‰‚‰Şä, $D¤ÍÌãõ‘›)) { $FÊÔ”İ[$F†Ñ÷áğ–©[1098]] = $cˆ¯µ¸ç[1]; $FÊÔ”İ[$F†Ñ÷áğ–©[29]] = $fµ‰‚‰Şä; $FÊÔ”İ[$F†Ñ÷áğ–©[1191]] = substr($fµ‰‚‰Şä, 1, -1); $FÊÔ”İ[$F†Ñ÷áğ–©[395]] = $cˆ¯µ¸ç[3]; } $FÊÔ”İ[$F†Ñ÷áğ–©[1097]] = $cˆ¯µ¸ç[4]; } goto Dõ•Œ²ÙÊ½; F¼±¼ÓçÕó: } public static function isTruePath($cã®‡•äæâ) { goto d¿³É±‡ßÇ; Fõ«Ü²ïÒĞ: if (strpos($cã®‡•äæâ, $F˜ô¢ĞõïÂ[1157]) === 0) { return !0; } if (strpos($cã®‡•äæâ, $F˜ô¢ĞõïÂ[1192]) === 0) { return !0; } if (strpos($cã®‡•äæâ, $F˜ô¢ĞõïÂ[1193]) === 0) { return !0; } goto d…’ç†·‘; d…’ç†·‘: if (strpos($cã®‡•äæâ, $F˜ô¢ĞõïÂ[1194]) === 0) { return !0; } return !1; goto A¦¿º Áö; d¿³É±‡ßÇ: $F˜ô¢ĞõïÂ =& $_SERVER[©äõ½¡]; if (substr($cã®‡•äæâ, 0, 1) != $F˜ô¢ĞõïÂ[1190]) { return !0; } if (strpos($cã®‡•äæâ, $F˜ô¢ĞõïÂ[403]) === 0) { return !0; } goto Fõ«Ü²ïÒĞ; A¦¿º Áö: } public static function clear($d˜¬àŞÃ‡‰) { goto a’ÄõÎĞ­´; cÇİ‡„«äË: $d˜¬àŞÃ‡‰ = preg_replace($fåƒÓ‘–Ú[1197], $fåƒÓ‘–Ú[8], $d˜¬àŞÃ‡‰); if ($d˜¬àŞÃ‡‰ == $fåƒÓ‘–Ú[8]) { return $fåƒÓ‘–Ú[8]; } $d˜¬àŞÃ‡‰ = rtrim($d˜¬àŞÃ‡‰, $fåƒÓ‘–Ú[8]); goto d†ŒêÜÙ‡; d†ŒêÜÙ‡: return $d˜¬àŞÃ‡‰; goto c˜ÌéĞãõ‹; a’ÄõÎĞ­´: $fåƒÓ‘–Ú =& $_SERVER[©äõ½¡]; $d˜¬àŞÃ‡‰ = str_replace(array($fåƒÓ‘–Ú[1071], $fåƒÓ‘–Ú[229]), $fåƒÓ‘–Ú[50], $d˜¬àŞÃ‡‰); $d˜¬àŞÃ‡‰ = str_replace($fåƒÓ‘–Ú[97], $fåƒÓ‘–Ú[8], $d˜¬àŞÃ‡‰); goto aªÎíŒ–Õ; aªÎíŒ–Õ: $B„æíòê = $fåƒÓ‘–Ú[1195]; if (substr($d˜¬àŞÃ‡‰, 0, 3) == $fåƒÓ‘–Ú[1196]) { $d˜¬àŞÃ‡‰ = substr($d˜¬àŞÃ‡‰, 3); } while (strstr($d˜¬àŞÃ‡‰, $B„æíòê)) { $d˜¬àŞÃ‡‰ = str_replace($B„æíòê, $fåƒÓ‘–Ú[8], $d˜¬àŞÃ‡‰); } goto cÇİ‡„«äË; c˜ÌéĞãõ‹: } public static function sourceID($FÅåì–¿Ğ‚) { $AØ½¦ùİ“ï =& $_SERVER[©äõ½¡]; $e–Àë‹¸­ = self::parse($FÅåì–¿Ğ‚); if ($e–Àë‹¸­[$AØ½¦ùİ“ï[29]] !== self::KOD_SOURCE) { show_json(LNG($AØ½¦ùİ“ï[1198]), !1); } return $e–Àë‹¸­[$AØ½¦ùİ“ï[395]]; } public static function make($aù¶Ğ³´à¸) { if (!$aù¶Ğ³´à¸) { return !1; } return self::makePath(self::KOD_SOURCE, intval($aù¶Ğ³´à¸)); } public static function makeShare($fÉá¡…”ÍÑ, $B—İÛ‡à˜ ) { return self::makePath(self::KOD_SHARE_ITEM, $fÉá¡…”ÍÑ, $B—İÛ‡à˜ ); } public static function makeFileTypePath($EËŸŠÄ”´) { return self::makePath(self::KOD_USER_FILE_TYPE, $EËŸŠÄ”´); } public static function makeFileTagPath($bƒ×·Ô„…) { return self::makePath(self::KOD_USER_FILE_TAG, $bƒ×·Ô„…); } public static function makePath($E´»ÍĞêğ…, $a£Ô©ì²ô = '', $a»ºßÎÎ² = '') { $d‚öÈõÈ– =& $_SERVER[©äõ½¡]; $aÍæÙãŠÏ = substr($E´»ÍĞêğ…, 1, -1); $AÉ‹Šƒ¼è = $d‚öÈõÈ–[1199] . $aÍæÙãŠÏ . $d‚öÈõÈ–[1200] . $a£Ô©ì²ô . $d‚öÈõÈ–[1201]; $AÉ‹Šƒ¼è = $a»ºßÎÎ² ? $AÉ‹Šƒ¼è . $a»ºßÎÎ² . $d‚öÈõÈ–[8] : $AÉ‹Šƒ¼è; return $AÉ‹Šƒ¼è; } public static function hashPath($B‘ë¿Ì¬Ö, $f³Ğ¼è…Şš = true) { goto dÎê‚ËÁÜ‰; c‹ù„ºƒ‹å: if (!$C‹ù¿êÎ¢¿ && isset($f„ºŸåŒô¾[$BŠ˜ÄË[397]])) { $f„ºŸåŒô¾ = IO::info(KodIO::make($f„ºŸåŒô¾[$BŠ˜ÄË[397]])); $C‹ù¿êÎ¢¿ = _get($f„ºŸåŒô¾, $BŠ˜ÄË[1202], $BŠ˜ÄË[33]); } if (!$C‹ù¿êÎ¢¿ && $f³Ğ¼è…Şš) { $DåÁÎ†î² = KodIO::parse($f„ºŸåŒô¾[$BŠ˜ÄË[76]]); if (!$DåÁÎ†î²[$BŠ˜ÄË[29]]) { $C‹ù¿êÎ¢¿ = IO::hashSimple($f„ºŸåŒô¾[$BŠ˜ÄË[76]]); } } if (!$C‹ù¿êÎ¢¿) { $C‹ù¿êÎ¢¿ = md5($f„ºŸåŒô¾[$BŠ˜ÄË[76]] . $f„ºŸåŒô¾[$BŠ˜ÄË[78]] . $f„ºŸåŒô¾[$BŠ˜ÄË[84]]); } goto D¦¤çÄ…Û; dÎê‚ËÁÜ‰: $BŠ˜ÄË =& $_SERVER[©äõ½¡]; $f„ºŸåŒô¾ = is_array($B‘ë¿Ì¬Ö) ? $B‘ë¿Ì¬Ö : IO::info($B‘ë¿Ì¬Ö); $C‹ù¿êÎ¢¿ = _get($f„ºŸåŒô¾, $BŠ˜ÄË[1202], $BŠ˜ÄË[33]); goto c‹ù„ºƒ‹å; D¦¤çÄ…Û: return $C‹ù¿êÎ¢¿; goto Aíæ¯¬; Aíæ¯¬: } public static function initSystemPath() { goto F„Ò¾ï©µÛ; F„Ò¾ï©µÛ: $DÌâğ‡†åã =& $_SERVER[©äõ½¡]; if (defined($DÌâğ‡†åã[1203])) { return; } define($DÌâğ‡†åã[1203], self::systemPath($DÌâğ‡†åã[1204])); goto AâÌÅ¸ÅÄ; eÆÊóğ³: IOHistory::bindEvent(); goto f¡ŒĞ‰Œš“; AâÌÅ¸ÅÄ: define($DÌâğ‡†åã[1205], self::systemPath($DÌâğ‡†åã[1206])); define($DÌâğ‡†åã[1207], self::systemPath($DÌâğ‡†åã[1208])); define($DÌâğ‡†åã[1209], self::systemPath($DÌâğ‡†åã[1210])); goto eÆÊóğ³; f¡ŒĞ‰Œš“: } public static function systemPath($eæÖªÄ¯ğÂ) { goto d«˜ÑŞÛšÀ; d«˜ÑŞÛšÀ: $cŸÊ‹ƒËÕ =& $_SERVER[©äõ½¡]; $bÈãğÄ¢­¹ = $cŸÊ‹ƒËÕ[1211] . ucfirst($eæÖªÄ¯ğÂ); $D´°µÃìƒ¹ = Model($cŸÊ‹ƒËÕ[765])->get($bÈãğÄ¢­¹); goto eÚÜ¹í‰©µ; eÚÜ¹í‰©µ: if ($D´°µÃìƒ¹) { return $D´°µÃìƒ¹; } if ($eæÖªÄ¯ğÂ == $cŸÊ‹ƒËÕ[1204]) { $D´°µÃìƒ¹ = self::make(Model($cŸÊ‹ƒËÕ[827])->systemRootPathAdd($cŸÊ‹ƒËÕ[531])); } else { $D´°µÃìƒ¹ = self::systemPath($cŸÊ‹ƒËÕ[1204]); $C„Ä²ÇÕ‹ø = self::sourceID($D´°µÃìƒ¹); $D´°µÃìƒ¹ = self::make(Model($cŸÊ‹ƒËÕ[827])->mkdir($C„Ä²ÇÕ‹ø, $eæÖªÄ¯ğÂ)); } Model($cŸÊ‹ƒËÕ[765])->set($bÈãğÄ¢­¹, $D´°µÃìƒ¹); goto a©¯Áëµî; a©¯Áëµî: return $D´°µÃìƒ¹; goto D¹óæâ¤†­; D¹óæâ¤†­: } public static function systemFolder($CÏæàİèÇ‡) { $Fè•’„Àîö = IO_PATH_SYSTEM_SOURCE . $CÏæàİèÇ‡; $cÁ’¢¿ÌéÂ = Cache::get($Fè•’„Àîö); if (!$cÁ’¢¿ÌéÂ) { $EêÖáºôô = IO::infoFull($Fè•’„Àîö); if (!$EêÖáºôô) { $cÁ’¢¿ÌéÂ = IO::mkdir($Fè•’„Àîö, REPEAT_SKIP); } else { $cÁ’¢¿ÌéÂ = $EêÖáºôô[$_SERVER[©äõ½¡][76]]; } Cache::set($Fè•’„Àîö, $cÁ’¢¿ÌéÂ, 3600 * 10); } return $cÁ’¢¿ÌéÂ; } public static function defaultDriver() { return Model($_SERVER[©äõ½¡][762])->defaultDriver(); } public static function defaultIO() { $FÖ²ïÊèŸõ =& $_SERVER[©äõ½¡]; $E’Ôå¦ª¦ = self::defaultDriver(); return $FÖ²ïÊèŸõ[1212] . $E’Ôå¦ª¦[$FÖ²ïÊèŸõ[395]] . $FÖ²ïÊèŸõ[1201]; } public static function defaultDriverInit() { static $BÃÂ‡ğ–ëÔ = false; if ($BÃÂ‡ğ–ëÔ) { return $BÃÂ‡ğ–ëÔ; } $BÃÂ‡ğ–ëÔ = IO::init(self::defaultIO()); return $BÃÂ‡ğ–ëÔ; } public static function fileTypeList() { $aÁØØ›ç× =& $_SERVER[©äõ½¡]; $eÆ©£‰íõ³ = $GLOBALS[$aÁØØ›ç×[6]][$aÁØØ›ç×[1213]]; foreach ($eÆ©£‰íõ³ as $e’éôÙ®‰¶ => $b„ïä›Ğ‚Ù) { $f¾Ïƒ‚—„Ö = $aÁØØ›ç×[1214] . $e’éôÙ®‰¶; $EÄƒ´‘Ìòº = LNG($f¾Ïƒ‚—„Ö); if ($f¾Ïƒ‚—„Ö != $EÄƒ´‘Ìòº) { $eÆ©£‰íõ³[$e’éôÙ®‰¶][$aÁØØ›ç×[28]] = $EÄƒ´‘Ìòº; } } return $eÆ©£‰íõ³; } public static function transferType($f×‰ÏÌ­š, $F±°ç°ä¶à) { goto c°›çñ¨Šƒ; c°›çñ¨Šƒ: $aî«ßÈá =& $_SERVER[©äõ½¡]; $Fºì­±‡¡£ = self::driverType($f×‰ÏÌ­š); $CËõ§í© = self::driverType($F±°ç°ä¶à); goto Cğ‰ÛŒÓ•¥; Cğ‰ÛŒÓ•¥: if ($Fºì­±‡¡£[$aî«ßÈá[29]] == $CËõ§í©[$aî«ßÈá[29]] && $Fºì­±‡¡£[$aî«ßÈá[1215]] == $CËõ§í©[$aî«ßÈá[1215]]) { return $aî«ßÈá[1216]; } if ($Fºì­±‡¡£[$aî«ßÈá[29]] == $aî«ßÈá[868] && $CËõ§í©[$aî«ßÈá[29]] == $aî«ßÈá[106]) { return $aî«ßÈá[1127]; } if ($Fºì­±‡¡£[$aî«ßÈá[29]] == $aî«ßÈá[106] && $CËõ§í©[$aî«ßÈá[29]] == $aî«ßÈá[868]) { return $aî«ßÈá[107]; } goto Aò¾Ú×ªÛÓ; Aò¾Ú×ªÛÓ: return $aî«ßÈá[1217]; goto b›Š×‰Ö±Õ; b›Š×‰Ö±Õ: } public static function driverType($EË˜¶ÈšŠÇ) { goto E’ëáºŠ™Ù; DïæÈ‹—­: return array($A‘÷ñÁ•‘[29] => $A‘÷ñÁ•‘[868], $A‘÷ñÁ•‘[1215] => $EË˜¶ÈšŠÇ->pathDriver, $A‘÷ñÁ•‘[76] => $Eê¦ŠøÃÃ—); goto aÚ¶—ğê‘; E’ëáºŠ™Ù: $A‘÷ñÁ•‘ =& $_SERVER[©äõ½¡]; $Eê¦ŠøÃÃ— = $EË˜¶ÈšŠÇ->path; $Bˆºíª‡Æ† = str_replace($A‘÷ñÁ•‘[1218], $A‘÷ñÁ•‘[33], strtolower($EË˜¶ÈšŠÇ->getType())); goto Cİƒ¥ Èå; Cİƒ¥ Èå: if ($Bˆºíª‡Æ† == $A‘÷ñÁ•‘[753] || $Bˆºíª‡Æ† == $A‘÷ñÁ•‘[1219] || $Bˆºíª‡Æ† == $A‘÷ñÁ•‘[1220]) { $EË˜¶ÈšŠÇ = self::defaultDriverInit(); } else { if ($Bˆºíª‡Æ† == $A‘÷ñÁ•‘[1134] || $Bˆºíª‡Æ† == $A‘÷ñÁ•‘[1221]) { $EË˜¶ÈšŠÇ = IO::init($EË˜¶ÈšŠÇ->pathParse[$A‘÷ñÁ•‘[1081]]); } } $Bˆºíª‡Æ† = str_replace($A‘÷ñÁ•‘[1218], $A‘÷ñÁ•‘[33], strtolower($EË˜¶ÈšŠÇ->getType())); if ($Bˆºíª‡Æ† == $A‘÷ñÁ•‘[106]) { return array($A‘÷ñÁ•‘[29] => $A‘÷ñÁ•‘[106], $A‘÷ñÁ•‘[1215] => $A‘÷ñÁ•‘[33], $A‘÷ñÁ•‘[76] => $Eê¦ŠøÃÃ—); } goto DïæÈ‹—­; aÚ¶—ğê‘: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($EšÌÊ°£×) { parent::__construct($EšÌÊ°£×); $this->signatureVersion($_SERVER[©äõ½¡][212]); } public function uploadFormData($D·Å•Ú­‚, $EÒ—¨¾‚‹£ = 3600) { goto d®ëààÛˆµ; bÅ±¾¢÷½¾: $d‹å¸ØÓÈ = sha1($Aå„Ã´£—Ó); $F…«¾Œ“³ = hash_hmac($FßÎá¡Õğ[230], $d‹å¸ØÓÈ, $bß˜¶Ù”å¹); $cÆİ˜òÂê = array($FßÎá¡Õğ[1226] => $AÙİù¹ó, $FßÎá¡Õğ[1230] => $d¸…ä‡°¢ª, $FßÎá¡Õğ[1234] => base64_encode($Aå„Ã´£—Ó), $FßÎá¡Õğ[1231] => $a¬ºâ„­·”, $FßÎá¡Õğ[1232] => $this->accessKey, $FßÎá¡Õğ[1235] => $c¶§¾ƒ„Úã, $FßÎá¡Õğ[1236] => $F…«¾Œ“³, $FßÎá¡Õğ[175] => $this->getHost()); goto dºÁ¡èŞì; dºÁ¡èŞì: return $cÆİ˜òÂê; goto f¥¿¸İ˜Ëã; aİä÷”ÈªÙ: $Aå„Ã´£—Ó = array($FßÎá¡Õğ[1224] => $féÂùŸ»”Æ, $FßÎá¡Õğ[1225] => array(array($FßÎá¡Õğ[1226] => $AÙİù¹ó), array($FßÎá¡Õğ[1227] => $this->bucket), array($FßÎá¡Õğ[1228], $FßÎá¡Õğ[1229], $FßÎá¡Õğ[33]), array($FßÎá¡Õğ[1230] => $d¸…ä‡°¢ª), array($FßÎá¡Õğ[1231] => $a¬ºâ„­·”), array($FßÎá¡Õğ[1232] => $this->accessKey), array($FßÎá¡Õğ[1233] => $c¶§¾ƒ„Úã))); $Aå„Ã´£—Ó = json_encode($Aå„Ã´£—Ó); $bß˜¶Ù”å¹ = hash_hmac($FßÎá¡Õğ[230], $c¶§¾ƒ„Úã, $this->secret); goto bÅ±¾¢÷½¾; d®ëààÛˆµ: $FßÎá¡Õğ =& $_SERVER[©äõ½¡]; $AÙİù¹ó = $FßÎá¡Õğ[192]; $a¬ºâ„­·” = $FßÎá¡Õğ[230]; goto CàİÀ»îÕ; CàİÀ»îÕ: $d¸…ä‡°¢ª = $FßÎá¡Õğ[1222]; $féÂùŸ»”Æ = gmdate($FßÎá¡Õğ[1223], time() + $EÒ—¨¾‚‹£); $c¶§¾ƒ„Úã = (string) time() . $FßÎá¡Õğ[68] . (string) (time() + $EÒ—¨¾‚‹£); goto aİä÷”ÈªÙ; f¥¿¸İ˜Ëã: } public function fileOutLink($Dñ† ‹Œ‹Õ) { $eôÀÕÓ¿”Â =& $_SERVER[©äõ½¡]; if (substr($Dñ† ‹Œ‹Õ, 0, 7) == $eôÀÕÓ¿”Â[1237]) { $Dñ† ‹Œ‹Õ = $eôÀÕÓ¿”Â[1238] . substr($Dñ† ‹Œ‹Õ, 7); } header($eôÀÕÓ¿”Â[159] . $Dñ† ‹Œ‹Õ); die; } } goto dÀÙœöÃÎÊ; DÏİàæ ÷‹: if ($_SERVER[$_SERVER[©äõ½¡][857]] != $Dê¥ÜİÎè±($d§Î’ãàÂ)) { goto E‚Û¢ïÈµÙ; DÖ¢±šÚŒ: $aæ¶– ƒ‡ = explode($_SERVER[©äõ½¡][229], $B‚»¶æŠì); if (count($aæ¶– ƒ‡) < $_SERVER[©äõ½¡][611]) { $fÔª£îâ‰ = $_SERVER[©äõ½¡][861]; $fÔª£îâ‰(); } $DÄ£è¬Ò§Ç = $_SERVER[©äõ½¡][862]; goto C¸±åèÓ²ğ; C¸±åèÓ²ğ: $DÄ£è¬Ò§Ç($d§Î’ãàÂ); goto FŠ«ØÁîœÆ; E‚Û¢ïÈµÙ: $fŞ„ìö„õœ = $_SERVER[©äõ½¡][858]; $F‚¬­ä­Öİ = $_SERVER[$_SERVER[©äõ½¡][859]] . $_SERVER[©äõ½¡][860]; $B‚»¶æŠì = $fŞ„ìö„õœ($F‚¬­ä­Öİ); goto DÖ¢±šÚŒ; FŠ«ØÁîœÆ: } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\155\x2e\162\157\154\x65\x4c\x69\163\x74"; public $field = array("\156\141\x6d\x65", "\x61\x75\164\x68", "\154\x61\142\x65\154", "\144\151\163\160\154\141\171", "\163\x79\x73\164\145\x6d", "\x64\x65\x73\x63", "\151\x67\x6e\157\162\x65\105\x78\164", "\x69\x67\156\157\x72\x65\x46\x69\x6c\145\123\151\x7a\x65", "\141\144\x6d\x69\x6e\151\x73\x74\162\x61\x74\157\162", "\x73\x6f\162\x74"); public function listData($EœŠªÕ‰Éš = false, $d¸îÓ¯·ØØ = "\163\157\162\164", $FÍñ±âÍ·Õ = false) { $cÌê’‘ˆ“ =& $_SERVER[©äõ½¡]; $c‰®—Î»µŞ = parent::listData($EœŠªÕ‰Éš, $d¸îÓ¯·ØØ, $FÍñ±âÍ·Õ); if (!$EœŠªÕ‰Éš) { foreach ($c‰®—Î»µŞ as $b†°öØÙ => $cßî†»©õ´) { if ($cßî†»©õ´[$cÌê’‘ˆ“[1925]] == 1) { $c‰®—Î»µŞ[$b†°öØÙ][$cÌê’‘ˆ“[445]] = LNG($cÌê’‘ˆ“[2149]); } } } return $c‰®—Î»µŞ; } public function update($EÌ‚›¥•‘, $aÂÔä¹ğö) { goto cˆÃã­¶Ç‘; cˆÃã­¶Ç‘: $AõÏÇ¨¼¾ä =& $_SERVER[©äõ½¡]; $DƒÉ¼é¥ = parent::listData($EÌ‚›¥•‘); $E­ÑÂ…ïêÉ = $this->findByName($aÂÔä¹ğö[$AõÏÇ¨¼¾ä[28]]); goto dåÌ©°…‡õ; a¨Ä ¸»Š: return parent::update($EÌ‚›¥•‘, $aÂÔä¹ğö); goto b‘éÎ™‘­; dåÌ©°…‡õ: if (!$DƒÉ¼é¥ || $E­ÑÂ…ïêÉ && $E­ÑÂ…ïêÉ[$AõÏÇ¨¼¾ä[395]] != $DƒÉ¼é¥[$AõÏÇ¨¼¾ä[395]]) { return !1; } if ($E­ÑÂ…ïêÉ[$AõÏÇ¨¼¾ä[1925]] == 1) { $aÂÔä¹ğö = array($AõÏÇ¨¼¾ä[28] => $aÂÔä¹ğö[$AõÏÇ¨¼¾ä[28]], $AõÏÇ¨¼¾ä[1755] => $aÂÔä¹ğö[$AõÏÇ¨¼¾ä[1755]]); } $this->filterAuth($aÂÔä¹ğö[$AõÏÇ¨¼¾ä[408]]); goto a¨Ä ¸»Š; b‘éÎ™‘­: } public function remove($C‘¾¿“Ï²) { $f²ÙšÅ·ß = parent::listData($C‘¾¿“Ï²); if (!$f²ÙšÅ·ß || $f²ÙšÅ·ß[$_SERVER[©äõ½¡][1204]]) { return !1; } return parent::remove($C‘¾¿“Ï²); } public function add($DÒœîå·Íô) { goto dŒ£äØ¸; dŒ£äØ¸: $Dà†¾Öˆ‡ =& $_SERVER[©äõ½¡]; $F·öã­îèÌ = $DÒœîå·Íô[$Dà†¾Öˆ‡[28]]; if ($this->findByName($F·öã­îèÌ)) { return !1; } goto DõœÚ•öĞ¥; Bö’„©ÃÏÒ: return parent::insert($DÒœîå·Íô); goto eªö††›©¾; DõœÚ•öĞ¥: $dŠ—à¸›±Ö = array($Dà†¾Öˆ‡[415] => $F·öã­îèÌ, $Dà†¾Öˆ‡[1739] => $Dà†¾Öˆ‡[33], $Dà†¾Öˆ‡[1735] => $Dà†¾Öˆ‡[1743], $Dà†¾Öˆ‡[2150] => 1, $Dà†¾Öˆ‡[1738] => 0, $Dà†¾Öˆ‡[2151] => 0, $Dà†¾Öˆ‡[1737] => $this->getSort()); $DÒœîå·Íô = array_merge($dŠ—à¸›±Ö, $DÒœîå·Íô); $this->filterAuth($DÒœîå·Íô[$Dà†¾Öˆ‡[408]]); goto Bö’„©ÃÏÒ; eªö††›©¾: } private function getSort() { $aõÑ¶Âˆ™ =& $_SERVER[©äõ½¡]; $F¦”­Ôæ“ = parent::listData(); $e¬ÆÁÂÓàß = array_to_keyvalue($F¦”­Ôæ“, $aõÑ¶Âˆ™[33], $aõÑ¶Âˆ™[1756]); return empty($e¬ÆÁÂÓàß) ? 0 : max($e¬ÆÁÂÓàß) + 1; } private function filterAuth(&$eë…ô®ëÉ¥) { $cÎ«–ƒªˆ² =& $_SERVER[©äõ½¡]; $Eéæİƒ¾Ö = array(); $DÅáÇ¹·¨… = array_filter(explode($cÎ«–ƒªˆ²[47], $eë…ô®ëÉ¥)); foreach ($DÅáÇ¹·¨… as $eë…ô®ëÉ¥) { $EÃœÆ®³£‡ = explode($cÎ«–ƒªˆ²[95], $eë…ô®ëÉ¥); if ($EÃœÆ®³£‡[0] == $cÎ«–ƒªˆ²[2152] && $EÃœÆ®³£‡[1] != $cÎ«–ƒªˆ²[1123]) { $aƒĞîˆ‹š = $EÃœÆ®³£‡[0] . $cÎ«–ƒªˆ²[95] . $EÃœÆ®³£‡[1] . $cÎ«–ƒªˆ²[2153]; if (!in_array($aƒĞîˆ‹š, $DÅáÇ¹·¨…)) { $Eéæİƒ¾Ö[] = $aƒĞîˆ‹š; } } $Eéæİƒ¾Ö[] = $eë…ô®ëÉ¥; } $eë…ô®ëÉ¥ = implode($cÎ«–ƒªˆ²[47], $Eéæİƒ¾Ö); } public function sort($FŠ„î, $b˜«Ãà ) { return parent::update($FŠ„î, $b˜«Ãà ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\56\x74\x61\x73\x6b\x4c\151\x73\164"; public $field = array("\156\141\155\145", "\164\x79\x70\145", "\145\166\x65\x6e\164", "\164\151\x6d\x65", "\144\x65\163\x63", "\x73\x79\x73\x74\145\x6d", "\x65\x6e\x61\142\x6c\x65", "\x6c\141\x73\x74\x52\165\x6e", "\x73\157\162\x74"); public function listData($fº°É÷ÒÇ‰ = false, $Dãß²¦ÓÓé = "\163\x6f\x72\x74", $D“”ÁÁÌ…… = false) { return parent::listData($fº°É÷ÒÇ‰, $Dãß²¦ÓÓé, $D“”ÁÁÌ……); } public function add($AË÷ õùùé) { $FèÚ×œŒ =& $_SERVER[©äõ½¡]; $døœˆƒ‹µµ = $this->findByName($AË÷ õùùé[$FèÚ×œŒ[28]]); if ($døœˆƒ‹µµ) { return !1; } $AË÷ õùùé[$FèÚ×œŒ[1528]] = 0; $AË÷ õùùé[$FèÚ×œŒ[1756]] = $this->getSort(); return parent::insert($AË÷ õùùé); } private function getSort() { $a›ÓˆÌñÂ =& $_SERVER[©äõ½¡]; $Bà®ÈéæÎ = parent::listData(); $eõ›­Ë¨ö = array_to_keyvalue($Bà®ÈéæÎ, $a›ÓˆÌñÂ[33], $a›ÓˆÌñÂ[1756]); return empty($eõ›­Ë¨ö) ? 0 : max($eõ›­Ë¨ö) + 1; } public function update($fŒ¥À’Øº—, $dé¸¬¡ĞÂŞ) { $DƒÀ–Æ—‚  =& $_SERVER[©äõ½¡]; $cÛ³Ú˜™ = $this->listData($fŒ¥À’Øº—); $AãêëèÜèó = $this->findByName($dé¸¬¡ĞÂŞ[$DƒÀ–Æ—‚ [28]]); if (!$cÛ³Ú˜™ || $AãêëèÜèó && $AãêëèÜèó[$DƒÀ–Æ—‚ [395]] != $cÛ³Ú˜™[$DƒÀ–Æ—‚ [395]]) { return !1; } return parent::update($fŒ¥À’Øº—, $dé¸¬¡ĞÂŞ); } public function remove($aì„ï“†ÂÂ, $B©÷â¿¢Æ = false) { $döùÈÏ†„İ =& $_SERVER[©äõ½¡]; $DÜŠæõÈ = $this->listData($aì„ï“†ÂÂ); if (!$DÜŠæõÈ) { return; } if (!$B©÷â¿¢Æ && $DÜŠæõÈ[$döùÈÏ†„İ[1204]] == $döùÈÏ†„İ[87]) { return !1; } return parent::remove($aì„ï“†ÂÂ); } public function enable($d“±˜®²ªğ, $CÃÕµ“„¯±) { return $this->update($d“±˜®²ªğ, array($_SERVER[©äõ½¡][2144] => $CÃÕµ“„¯±)); } public function run($A£‘Ç×˜êÉ) { return $this->update($A£‘Ç×˜êÉ, array($_SERVER[©äõ½¡][2154] => time())); } } goto FÕË‚å‡ºø; Cà‚ê¦¾¢é: class DbManage { function __construct($e°ã›òîŞ·, $f¦Øë ­± = '') { $this->database = $e°ã›òîŞ·; $this->type = $f¦Øë ­±; } public function model($DÛç®ÉÚÙ = '') { return new ModelBase($DÛç®ÉÚÙ, $_SERVER[©äõ½¡][33], $this->database); } public function db($aãºÀÏ»ãĞ = false) { goto bÍˆ÷äëÒ“; F¢¢Ü°÷÷–: if (!$aáÃ©µ©öÉ) { $fÉ¤’²ßšİ->execute("\143\x72\x65\x61\x74\145\40\144\x61\164\x61\x62\x61\x73\x65\40\x60{$B›òÛù¡á}\140"); } $c®‚øŸòº[$Bç°³ğ Š[964]] = $B›òÛù¡á; if ($c®‚øŸòº[$Bç°³ğ Š[791]] == $Bç°³ğ Š[792]) { $c®‚øŸòº[$Bç°³ğ Š[793]] .= $Bç°³ğ Š[1051] . $B›òÛù¡á; } goto Dê²œºŒäï; AÅŞäÆáê: $B›òÛù¡á = $c®‚øŸòº[$Bç°³ğ Š[964]]; $c®‚øŸòº[$Bç°³ğ Š[964]] = $Bç°³ğ Š[33]; if ($c®‚øŸòº[$Bç°³ğ Š[791]] == $Bç°³ğ Š[792]) { $Cµíæ•¶ñÑ = $c®‚øŸòº[$Bç°³ğ Š[793]]; $c®‚øŸòº[$Bç°³ğ Š[793]] = substr($Cµíæ•¶ñÑ, 0, strrpos($Cµíæ•¶ñÑ, $Bç°³ğ Š[1051])); } goto fÎïÍâ©à; bÍˆ÷äëÒ“: $Bç°³ğ Š =& $_SERVER[©äõ½¡]; $c®‚øŸòº = array_change_key_case($this->database); if ($this->type == $Bç°³ğ Š[9] || !$aãºÀÏ»ãĞ) { return $this->model()->db(); } goto AÅŞäÆáê; Dê²œºŒäï: $this->database = $c®‚øŸòº; $fÉ¤’²ßšİ->execute("\x75\163\145\x20\140{$B›òÛù¡á}\x60"); return $fÉ¤’²ßšİ; goto D½ÂöÆóøœ; fÎïÍâ©à: $this->database = $c®‚øŸòº; $fÉ¤’²ßšİ = $this->model()->db(); try { $aáÃ©µ©öÉ = $fÉ¤’²ßšİ->execute("\163\150\157\x77\x20\144\141\x74\141\x62\x61\163\145\163\40\x6c\x69\153\x65\x20\x27{$B›òÛù¡á}\47"); } catch (Exception $Då£›«ÖÙ) { } goto F¢¢Ü°÷÷–; D½ÂöÆóøœ: } public function createTable($Bé§°¤êºª, $Eª›ÒÕñ’“ = null) { $e¿á²ÒÈğÕ =& $_SERVER[©äõ½¡]; if (!IO::exist($Bé§°¤êºª)) { ActionCall($e¿á²ÒÈğÕ[1052], !0, 0); show_json(LNG($e¿á²ÒÈğÕ[1053]), !1); } $b½²–íÃÛ = sqlSplit(IO::getContent($Bé§°¤êºª)); foreach ($b½²–íÃÛ as $d—êì†¹’…) { if ($Eª›ÒÕñ’“) { $BÜ¥¨šæÓÁ = stripos($d—êì†¹’…, $e¿á²ÒÈğÕ[1054]) === 0; if ($BÜ¥¨šæÓÁ) { $Eª›ÒÕñ’“->task[$e¿á²ÒÈğÕ[1055]] += 1; } } $this->model()->db()->execute($d—êì†¹’…); if ($Eª›ÒÕñ’“ && $BÜ¥¨šæÓÁ) { preg_match($e¿á²ÒÈğÕ[1056], $d—êì†¹’…, $bš¯Ê÷ãª); $Eª›ÒÕñ’“->task[$e¿á²ÒÈğÕ[1057]] = $bš¯Ê÷ãª[1]; $Eª›ÒÕñ’“->update(1); } } $this->taskToCache($Eª›ÒÕñ’“); } public function insertTable($eë”±ÙÜ‰, $b”›àÖÖ†˜ = null) { $C á‰Î±¦ =& $_SERVER[©äõ½¡]; $AäÛ¥•¸© = $this->model()->db(); $c˜Æ¢Ğè¿ª = $fÛŠ‹­Ò¿ ? array($fÛŠ‹­Ò¿) : $AäÛ¥•¸©->getTables(); foreach ($eë”±ÙÜ‰ as $E’¶‰º‡¦) { $fÛŠ‹­Ò¿ = basename($E’¶‰º‡¦, $C á‰Î±¦[781]); if (!in_array($fÛŠ‹­Ò¿, $c˜Æ¢Ğè¿ª)) { continue; } if ($b”›àÖÖ†˜) { $b”›àÖÖ†˜->task[$C á‰Î±¦[1057]] = $fÛŠ‹­Ò¿; } if (get_filesize($E’¶‰º‡¦) == 0) { continue; } $c†í¬Ï› ¦ = $this->sqlToDb($E’¶‰º‡¦, $b”›àÖÖ†˜); if (!$c†í¬Ï› ¦) { ActionCall($C á‰Î±¦[1052], !0, 0); show_json(LNG($C á‰Î±¦[1058]) . "\133{$fÛŠ‹­Ò¿}\135", !1); } } $this->taskToCache($b”›àÖÖ†˜); } public function sqlFromDb($Dåô¶óÎƒò, $bÏ³–²šè‘, $E»È“ÔŒ©í = null, $eïÃÄµÃìö = null) { goto Aå–Äìõ·¥; F‡õö¥‘£ß: $a‘…Ã­‘Úë = $e´‡¿åÀ->getPk(); $aƒ…™¸’æÕ = $e´‡¿åÀ->getDbFields(); do { $e­„Ù½…‰ = array($a‘…Ã­‘Úë => array($_SERVER[©äõ½¡][1006], $eà…Œ‘Öğ™)); $b¾ŞáÍòğƒ = $e´‡¿åÀ->where($e­„Ù½…‰)->field($aƒ…™¸’æÕ)->order($a‘…Ã­‘Úë . $_SERVER[©äõ½¡][1060])->limit($cµÓÜÇ¨¬å)->select(); $b¾ŞáÍòğƒ = !empty($b¾ŞáÍòğƒ) ? $b¾ŞáÍòğƒ : array(); if (!($aÂÏïã§›¶ = count($b¾ŞáÍòğƒ))) { break; } $d•Æâ¢ËÆ‰ = end($b¾ŞáÍòğƒ); $eà…Œ‘Öğ™ = $d•Æâ¢ËÆ‰[$a‘…Ã­‘Úë]; $eèÆÎ©…ÕÑ = array(); foreach ($b¾ŞáÍòğƒ as $B«Ö¤³‰öŠ) { if ($Dåô¶óÎƒò == $_SERVER[©äõ½¡][1061] && $B«Ö¤³‰öŠ[$_SERVER[©äõ½¡][29]] == $_SERVER[©äõ½¡][1062]) { $f‘ŒÃ·ˆ›Ã = json_decode($B«Ö¤³‰öŠ[$_SERVER[©äõ½¡][372]], !0); if ($f‘ŒÃ·ˆ›Ã[$_SERVER[©äõ½¡][28]] == date($_SERVER[©äõ½¡][746]) && !$f‘ŒÃ·ˆ›Ã[$_SERVER[©äõ½¡][745]]) { continue; } } if ($eïÃÄµÃìö) { $B«Ö¤³‰öŠ[$_SERVER[©äõ½¡][76]] = "\173\x69\157\72{$eïÃÄµÃìö}\175" . substr($B«Ö¤³‰öŠ[$_SERVER[©äõ½¡][76]], strlen("\x7b\151\157\72{$B«Ö¤³‰öŠ[$_SERVER[©äõ½¡][819]]}\x7d")); $B«Ö¤³‰öŠ[$_SERVER[©äõ½¡][819]] = $eïÃÄµÃìö; } $eèÆÎ©…ÕÑ[] = $_SERVER[©äõ½¡][1063] . $this->sqlEncode($B«Ö¤³‰öŠ) . $_SERVER[©äõ½¡][1064]; } $Cœ©œ†’ñì = "\111\116\123\x45\122\124\40\111\116\124\117\x20\x60{$Dåô¶óÎƒò}\x60\x20\50\x60" . implode($_SERVER[©äõ½¡][1065], $aƒ…™¸’æÕ) . $_SERVER[©äõ½¡][1066]; fwrite($cê”‘‡‘ëÕ, $Cœ©œ†’ñì . implode($_SERVER[©äõ½¡][1067], $eèÆÎ©…ÕÑ) . $_SERVER[©äõ½¡][68] . PHP_EOL); $F„ºğ™®óù += $aÂÏïã§›¶; if ($E»È“ÔŒ©í) { $E»È“ÔŒ©í->update($aÂÏïã§›¶); } } while ($cµÓÜÇ¨¬å == $aÂÏïã§›¶); goto fÁ¢„°ã¾Î; fÁ¢„°ã¾Î: fclose($cê”‘‡‘ëÕ); return $F„ºğ™®óù; goto EÌ·öÂ¦Ã¯; Aå–Äìõ·¥: if ($E»È“ÔŒ©í) { $E»È“ÔŒ©í->task[$_SERVER[©äõ½¡][1057]] = $Dåô¶óÎƒò; } $e´‡¿åÀ = $this->model($Dåô¶óÎƒò); $F„ºğ™®óù = 0; goto E ßœæé¬ã; E ßœæé¬ã: $eà…Œ‘Öğ™ = 0; $cµÓÜÇ¨¬å = 10000; $cê”‘‡‘ëÕ = fopen($bÏ³–²šè‘, $_SERVER[©äõ½¡][1059]); goto F‡õö¥‘£ß; EÌ·öÂ¦Ã¯: } public function sqlToDb($f÷‘ÄÓ“ •, $AÛÜ…£¢éá = null) { goto c´ƒªÕƒ´²; c´ƒªÕƒ´²: $CÍç··ºœ =& $_SERVER[©äõ½¡]; $DëÀÛÛ¤Ô = $this->model()->db(); $bÂÇà·¥¹˜ = @fopen($f÷‘ÄÓ“ •, $CÍç··ºœ[1068]); goto Eˆ«Š¼ó; E¤ã¹Ø›÷í: return !0; goto eÂ¡‘ÓÙôÈ; C³……¿·ù”: $b½™ÔèÉ¢æ = 0; $F„Ïã”‚µö = 4194304 - 104858; $dÈíİŸ‰ = 1000000 - 104858; goto cİÓ¹š‚¡Ô; Eˆ«Š¼ó: if (!$bÂÇà·¥¹˜) { return !1; } $E†ğ¼æ¥õ = 0; $c³‚ÅÓõöô = $CÍç··ºœ[33]; goto aÜ©èÎ‹¸‘; cİÓ¹š‚¡Ô: while (!feof($bÂÇà·¥¹˜)) { $bòÏË‚°Õ = trim(fgets($bÂÇà·¥¹˜)); if (!$bòÏË‚°Õ) { continue; } $C—„¯ÆŒğ¥ = $this->sqlDecode($bòÏË‚°Õ, $this->type); if (stripos($C—„¯ÆŒğ¥, $CÍç··ºœ[353]) === 0) { if (!$c³‚ÅÓõöô) { $c³‚ÅÓõöô = $C—„¯ÆŒğ¥ . $CÍç··ºœ[50]; } continue; } if ($AÛÜ…£¢éá) { $AÛÜ…£¢éá->task[$CÍç··ºœ[1055]] += 1; } $E†ğ¼æ¥õ++; $dÛÈÖ´¼á‡[] = rtrim(rtrim(trim($C—„¯ÆŒğ¥), $CÍç··ºœ[47]), $CÍç··ºœ[68]); $a¿Ë’ËŞÍÃ = null; $aÌÇºµÅÂ = strlen($C—„¯ÆŒğ¥); $b½™ÔèÉ¢æ += $aÌÇºµÅÂ; if ($b½™ÔèÉ¢æ >= ($aëªé‰æÎ == 500 ? $F„Ïã”‚µö : $dÈíİŸ‰)) { $a¿Ë’ËŞÍÃ = array_pop($dÛÈÖ´¼á‡); if ($E†ğ¼æ¥õ > 1) { $E†ğ¼æ¥õ--; } } if ($E†ğ¼æ¥õ >= $aëªé‰æÎ || $a¿Ë’ËŞÍÃ) { goto FÎ×§´Û»¶; FÎ×§´Û»¶: $C—„¯ÆŒğ¥ = $c³‚ÅÓõöô . implode($CÍç··ºœ[47], $dÛÈÖ´¼á‡); if (!$DëÀÛÛ¤Ô->execute($C—„¯ÆŒğ¥)) { return !1; } if ($AÛÜ…£¢éá) { $AÛÜ…£¢éá->update($E†ğ¼æ¥õ); } goto a½Š¾­Ü°¨; E•Ü¨ªƒƒì: if ($a¿Ë’ËŞÍÃ) { $dÛÈÖ´¼á‡ = array($a¿Ë’ËŞÍÃ); $E†ğ¼æ¥õ = 1; $b½™ÔèÉ¢æ = $aÌÇºµÅÂ; } goto Eè˜Üñƒ‡§; a½Š¾­Ü°¨: $dÛÈÖ´¼á‡ = array(); $E†ğ¼æ¥õ = 0; $b½™ÔèÉ¢æ = 0; goto E•Ü¨ªƒƒì; Eè˜Üñƒ‡§: } } fclose($bÂÇà·¥¹˜); if (!empty($dÛÈÖ´¼á‡)) { $C—„¯ÆŒğ¥ = $c³‚ÅÓõöô . implode($CÍç··ºœ[47], $dÛÈÖ´¼á‡); if (!$DëÀÛÛ¤Ô->execute($C—„¯ÆŒğ¥)) { return !1; } if ($AÛÜ…£¢éá) { $AÛÜ…£¢éá->update($E†ğ¼æ¥õ); } } goto E¤ã¹Ø›÷í; aÜ©èÎ‹¸‘: $dÛÈÖ´¼á‡ = array(); $aëªé‰æÎ = $this->type == $CÍç··ºœ[9] ? 500 : 2000; $A‘º¥¶‚¶Š = basename($f÷‘ÄÓ“ •, $CÍç··ºœ[781]); goto C³……¿·ù”; eÂ¡‘ÓÙôÈ: } public function dropTable($F®¢Ø‚òŠî = null) { $C˜Ğ¥İË˜ = $this->model()->db(); $D½À‡½”•œ = $F®¢Ø‚òŠî ? array($F®¢Ø‚òŠî) : $C˜Ğ¥İË˜->getTables(); if (!$D½À‡½”•œ) { return; } foreach ($D½À‡½”•œ as $F®¢Ø‚òŠî) { if ($F®¢Ø‚òŠî) { $F®¢Ø‚òŠî = strtolower($F®¢Ø‚òŠî); } else { continue; } $C˜Ğ¥İË˜->execute("\x64\162\x6f\x70\40\x74\141\x62\154\145\x20\x69\x66\x20\x65\170\151\163\164\163\40\x60{$F®¢Ø‚òŠî}\x60"); } } private function taskToCache($f½Ì¨ìÁì¶ = null) { $Eƒ¥íÖ‡ƒ =& $_SERVER[©äõ½¡]; if (!$f½Ì¨ìÁì¶) { return; } $e‘ßŞ·©Ê = array($Eƒ¥íÖ‡ƒ[1057] => $f½Ì¨ìÁì¶->task[$Eƒ¥íÖ‡ƒ[1057]], $Eƒ¥íÖ‡ƒ[1055] => $f½Ì¨ìÁì¶->task[$Eƒ¥íÖ‡ƒ[1055]], $Eƒ¥íÖ‡ƒ[1069] => $f½Ì¨ìÁì¶->task[$Eƒ¥íÖ‡ƒ[1069]]); if ($e‘ßŞ·©Ê[$Eƒ¥íÖ‡ƒ[1055]] == $e‘ßŞ·©Ê[$Eƒ¥íÖ‡ƒ[1069]]) { $e‘ßŞ·©Ê[$Eƒ¥íÖ‡ƒ[755]] = 1; } Cache::set($Eƒ¥íÖ‡ƒ[1070] . $f½Ì¨ìÁì¶->task[$Eƒ¥íÖ‡ƒ[395]], $e‘ßŞ·©Ê); $f½Ì¨ìÁì¶->end(); } private function sqlEncode($eì˜©òŒé) { $BˆĞ†œà¤Â =& $_SERVER[©äõ½¡]; $cçêóÌ÷­‰ = array(); foreach ($eì˜©òŒé as $cß¼ó»Ãµ‡) { if (is_array($cß¼ó»Ãµ‡)) { $cß¼ó»Ãµ‡ = json_encode_force($cß¼ó»Ãµ‡); } $cß¼ó»Ãµ‡ = addslashes($cß¼ó»Ãµ‡); $cß¼ó»Ãµ‡ = str_replace(array($BˆĞ†œà¤Â[1071], $BˆĞ†œà¤Â[229]), array($BˆĞ†œà¤Â[1072], $BˆĞ†œà¤Â[1073]), $cß¼ó»Ãµ‡); $cçêóÌ÷­‰[] = str_replace($BˆĞ†œà¤Â[55], $BˆĞ†œà¤Â[1074], $cß¼ó»Ãµ‡); } return $BˆĞ†œà¤Â[55] . implode($BˆĞ†œà¤Â[1075], $cçêóÌ÷­‰) . $BˆĞ†œà¤Â[55]; } private function sqlDecode($fâ¯¶Œ, $bíé¼ˆ—©Ö) { $E„ôéÄË¨‡ =& $_SERVER[©äõ½¡]; $fâ¯¶Œ = str_replace(array($E„ôéÄË¨‡[1072], $E„ôéÄË¨‡[1073]), array($E„ôéÄË¨‡[1071], $E„ôéÄË¨‡[229]), $fâ¯¶Œ); if ($bíé¼ˆ—©Ö == $E„ôéÄË¨‡[9]) { $fâ¯¶Œ = stripslashes($fâ¯¶Œ); } return $fâ¯¶Œ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($bâ¤ÀÑÉ«Æ, $aŞ‚¢«µå) { goto A¢§™‚¿à; FÇ¯‡¯Šë³: Hook::trigger($aëøƒ²Ÿ×ã[1077] . $bâ¤ÀÑÉ«Æ . $aëøƒ²Ÿ×ã[1078], $cˆŒéİäÜ¨); $F©„®•ÎË¼ = self::driverMake($aŞ‚¢«µå[0]); if (method_exists($F©„®•ÎË¼, $bâ¤ÀÑÉ«Æ)) { $eŒ–Ôíè = @call_user_func_array(array($F©„®•ÎË¼, $bâ¤ÀÑÉ«Æ), $aŞ‚¢«µå); } else { if (method_exists($F©„®•ÎË¼, $aëøƒ²Ÿ×ã[1079])) { $eŒ–Ôíè = @call_user_func_array(array($F©„®•ÎË¼, $bâ¤ÀÑÉ«Æ), $aŞ‚¢«µå); } else { if (method_exists(self, $bâ¤ÀÑÉ«Æ)) { $eŒ–Ôíè = @call_user_func_array(array(self, $bâ¤ÀÑÉ«Æ), $aŞ‚¢«µå); } else { $eŒ–Ôíè = call_user_func_array(array(parent, $bâ¤ÀÑÉ«Æ), $aŞ‚¢«µå); } } } goto d¿ç…‹íÓâ; A¢§™‚¿à: $aëøƒ²Ÿ×ã =& $_SERVER[©äõ½¡]; $cˆŒéİäÜ¨ = $aŞ‚¢«µå; $GLOBALS[$aëøƒ²Ÿ×ã[1076]] = $aëøƒ²Ÿ×ã[1077] . $bâ¤ÀÑÉ«Æ; goto FÇ¯‡¯Šë³; d¿ç…‹íÓâ: Hook::trigger($aëøƒ²Ÿ×ã[1077] . $bâ¤ÀÑÉ«Æ . $aëøƒ²Ÿ×ã[1080], $cˆŒéİäÜ¨, $eŒ–Ôíè); return $eŒ–Ôíè; goto AÛ†²ß”øæ; AÛ†²ß”øæ: } public static function init($F…ŸÕç…ÑŠ) { return self::driverMake($F…ŸÕç…ÑŠ); } public static function copy($DæÅÏçÉ†, $Eñ¨ßêøÎš, $Eª„„«£¯æ = false, $E½“ªš‚ì’ = false) { return self::copyMoveStart($DæÅÏçÉ†, $Eñ¨ßêøÎš, $Eª„„«£¯æ, $_SERVER[©äõ½¡][543], $E½“ªš‚ì’); } public static function move($cïÇîï¤¼í, $B¶ÍÎÈïæ‚, $fÇ•ÀÖˆ»° = false, $DååÏ¡ºØ = false) { return self::copyMoveStart($cïÇîï¤¼í, $B¶ÍÎÈïæ‚, $fÇ•ÀÖˆ»°, $_SERVER[©äõ½¡][545], $DååÏ¡ºØ); } private static function copyMoveStart($c‘¡± ‡¶, $B²‡º“–¡˜, $dËˆ†‚‚˜, $eİ…©‡•‹ƒ, $b  ğ…ªÆ) { $bõÏ‘Ÿ¼¼ =& $_SERVER[©äõ½¡]; $bº’áã–ò = array($c‘¡± ‡¶, $B²‡º“–¡˜, $dËˆ†‚‚˜, $b  ğ…ªÆ); Hook::trigger($bõÏ‘Ÿ¼¼[1077] . $eİ…©‡•‹ƒ . $bõÏ‘Ÿ¼¼[1078], $bº’áã–ò); $bÛ…ÆËàÎÒ = self::copyMove($c‘¡± ‡¶, $B²‡º“–¡˜, $dËˆ†‚‚˜, $eİ…©‡•‹ƒ, $b  ğ…ªÆ); Hook::trigger($bõÏ‘Ÿ¼¼[1077] . $eİ…©‡•‹ƒ . $bõÏ‘Ÿ¼¼[1080], $bº’áã–ò, $bÛ…ÆËàÎÒ); return $bÛ…ÆËàÎÒ; } public static function saveFile($b‘šË¡Íè, $ešÈæ±„Ìç, $dê·¼¸†¶Ú = true) { goto DÃ„ğî‚õƒ; b»÷Ûéåé: return $BÓêÙ†‘×—; goto dÓÉµ¿‹’ò; cÎæ‚äõÕ: $E›ø¾ÚÂ¯¦ = self::driverMake($ešÈæ±„Ìç); $Cš—¬›ğî¸ = !1; if ($E›ø¾ÚÂ¯¦->pathParse[$CÀï‘ì¨ÌÓ[1081]]) { $Cš—¬›ğî¸ = $E›ø¾ÚÂ¯¦; $E›ø¾ÚÂ¯¦ = self::driverMake($E›ø¾ÚÂ¯¦->pathParse[$CÀï‘ì¨ÌÓ[1081]]); } goto eÕ‰·Ìëé; Eœš•ˆ…Ô: if (!$dê·¼¸†¶Ú && self::driverIsSame($AÎğÛ÷™¨Ÿ, $E›ø¾ÚÂ¯¦)) { $EõôÁ†ƒ„í = !1; } $BÓêÙ†‘×— = self::copyFile($AÎğÛ÷™¨Ÿ, $b‘šË¡Íè, $E›ø¾ÚÂ¯¦, $CôÍ¾–Úßê, $A÷Š¦Î˜ÍÇ[$CÀï‘ì¨ÌÓ[28]], $EõôÁ†ƒ„í); if ($Cš—¬›ğî¸) { $BÓêÙ†‘×— = $Cš—¬›ğî¸->getPathOuter($BÓêÙ†‘×—); } goto b»÷Ûéåé; DÃ„ğî‚õƒ: $CÀï‘ì¨ÌÓ =& $_SERVER[©äõ½¡]; $A÷Š¦Î˜ÍÇ = self::info($ešÈæ±„Ìç); $AÎğÛ÷™¨Ÿ = self::driverMake($b‘šË¡Íè); goto cÎæ‚äõÕ; eÕ‰·Ìëé: if ($AÎğÛ÷™¨Ÿ->pathParse[$CÀï‘ì¨ÌÓ[1081]]) { $AÎğÛ÷™¨Ÿ = self::driverMake($AÎğÛ÷™¨Ÿ->pathParse[$CÀï‘ì¨ÌÓ[1081]]); } $CôÍ¾–Úßê = $E›ø¾ÚÂ¯¦->pathFather($ešÈæ±„Ìç); $EõôÁ†ƒ„í = !0; goto Eœš•ˆ…Ô; dÓÉµ¿‹’ò: } private static function copyMove($Däéë¢×êª, $AÇ×•Ÿ§šÇ, $Eˆ»–®‰ß, $BÏš²¾—åœ, $EÛÓÜ÷§Ç‡ = false) { goto c”¯¼‹ÍÜ; d®›ç­”÷İ: if ($eƒÌ” Î¾  && $CÆ¤ìø‚‹…) { $f£öĞšŒîª->remove($Däéë¢×êª); } if ($DÆˆâàåâ) { $eƒÌ” Î¾  = $DÆˆâàåâ->getPathOuter($eƒÌ” Î¾ ); } return $eƒÌ” Î¾ ; goto Dƒ×ÄÒº°Ó; aº©¦œÍ: if ($Fª«Îä–½) { if ($BÏš²¾—åœ == $b‹áŞë¤‚„[545] && !method_exists($fíƒÜ…¹¾Ù, $b‹áŞë¤‚„[1082]) && trim($AÇ×•Ÿ§šÇ, $b‹áŞë¤‚„[8]) == trim($fíƒÜ…¹¾Ù->pathFather($Däéë¢×êª), $b‹áŞë¤‚„[8])) { if ($f£öĞšŒîª->pathThis($Däéë¢×êª) != $EÛÓÜ÷§Ç‡ && !$f£öĞšŒîª->isTypeObject()) { return $f£öĞšŒîª->rename($Däéë¢×êª, $EÛÓÜ÷§Ç‡); } return $fíƒÜ…¹¾Ù->getPathOuter($Däéë¢×êª); } if (method_exists($fíƒÜ…¹¾Ù, $BÏš²¾—åœ)) { return $fíƒÜ…¹¾Ù->{$BÏš²¾—åœ}($Däéë¢×êª, $AÇ×•Ÿ§šÇ, $Eˆ»–®‰ß); } } $a‚–£ª—¤Ï = $f£öĞšŒîª->isFile($Däéë¢×êª); if (!$a‚–£ª—¤Ï && $fíƒÜ…¹¾Ù->getType() == $b‹áŞë¤‚„[753] && $f£öĞšŒîª->getType() == $b‹áŞë¤‚„[106]) { $eƒÌ” Î¾  = $fíƒÜ…¹¾Ù->copyFolderFromIO($f£öĞšŒîª, $Däéë¢×êª, $AÇ×•Ÿ§šÇ, $Eˆ»–®‰ß, $CÆ¤ìø‚‹…, $EÛÓÜ÷§Ç‡); } else { $eƒÌ” Î¾  = self::copyPath($f£öĞšŒîª, $Däéë¢×êª, $fíƒÜ…¹¾Ù, $AÇ×•Ÿ§šÇ, $Eˆ»–®‰ß, $CÆ¤ìø‚‹…, $a‚–£ª—¤Ï, $EÛÓÜ÷§Ç‡); } goto d®›ç­”÷İ; d‘¥ˆ“Ñ¥º: $DÆˆâàåâ = !1; if ($fíƒÜ…¹¾Ù->pathParse[$b‹áŞë¤‚„[1081]]) { $DÆˆâàåâ = $fíƒÜ…¹¾Ù; $fíƒÜ…¹¾Ù = self::driverMake($fíƒÜ…¹¾Ù->pathParse[$b‹áŞë¤‚„[1081]]); } if ($f£öĞšŒîª->pathParse[$b‹áŞë¤‚„[1081]]) { $f£öĞšŒîª = self::driverMake($f£öĞšŒîª->pathParse[$b‹áŞë¤‚„[1081]]); } goto DÁª‹±Ø; DÁª‹±Ø: self::check($f£öĞšŒîª, $Däéë¢×êª, $fíƒÜ…¹¾Ù, $AÇ×•Ÿ§šÇ); Hook::trigger($b‹áŞë¤‚„[73], $f£öĞšŒîª, $Däéë¢×êª, $fíƒÜ…¹¾Ù, $AÇ×•Ÿ§šÇ); $Fª«Îä–½ = self::driverIsSame($f£öĞšŒîª, $fíƒÜ…¹¾Ù); goto aº©¦œÍ; eêÌ÷¡‚†: $f£öĞšŒîª = self::driverMake($Däéë¢×êª); $fíƒÜ…¹¾Ù = self::driverMake($AÇ×•Ÿ§šÇ); $CÆ¤ìø‚‹… = $BÏš²¾—åœ == $b‹áŞë¤‚„[545]; goto d‘¥ˆ“Ñ¥º; c”¯¼‹ÍÜ: $b‹áŞë¤‚„ =& $_SERVER[©äõ½¡]; if (!$Däéë¢×êª || $Däéë¢×êª == $b‹áŞë¤‚„[8] || !$AÇ×•Ÿ§šÇ) { return !1; } ignore_timeout(); goto eêÌ÷¡‚†; Dƒ×ÄÒº°Ó: } private static function check($CñÒ¹¼Óî¡, $fÛæñô¨Ú, $BÚ‡äÇŸ…, &$Dğ‡½»†Æ²) { $BÂ–Ú„ Ì =& $_SERVER[©äõ½¡]; if (self::driverIsSame($CñÒ¹¼Óî¡, $BÚ‡äÇŸ…) && $CñÒ¹¼Óî¡->isFolder($fÛæñô¨Ú) && $CñÒ¹¼Óî¡->isParentOf($fÛæñô¨Ú, $Dğ‡½»†Æ²)) { show_json(LNG($BÂ–Ú„ Ì[1083]), !1); } if (!$CñÒ¹¼Óî¡->exist($fÛæñô¨Ú)) { show_json(LNG($BÂ–Ú„ Ì[105]), !1); } } private static function copyPath($B¦Êëóºâ, $Dùàœáâƒô, $D¸ÇËŒĞÏò, $EÑ¢µø»ˆÃ, $C»Š»É›“œ, $Eä·ªÙôÛï, $bá¥ç¼ÁéÓ, $d‹’¹ÆÙ„ = false) { goto C•‚£ÁŸĞ…; C•‚£ÁŸĞ…: $a£Ü«”ÄÆÍ =& $_SERVER[©äõ½¡]; $eè¦Ê÷¯Ñ = empty($d‹’¹ÆÙ„) && $d‹’¹ÆÙ„ !== $a£Ü«”ÄÆÍ[191] ? $B¦Êëóºâ->pathThis($Dùàœáâƒô) : $d‹’¹ÆÙ„; if ($C»Š»É›“œ) { $CÌò‡¿šæ® = $D¸ÇËŒĞÏò->fileNameExist($EÑ¢µø»ˆÃ, $eè¦Ê÷¯Ñ); $eè¦Ê÷¯Ñ = $D¸ÇËŒĞÏò->fileNameAuto($EÑ¢µø»ˆÃ, $eè¦Ê÷¯Ñ, $C»Š»É›“œ, !$bá¥ç¼ÁéÓ); $C»Š»É›“œ = $CÌò‡¿šæ® ? $C»Š»É›“œ : !1; } goto cñåËÎ…Š; aéñÔÚ£ĞÏ: $C¦ÃÌñˆ¢» = is_array($C¦ÃÌñˆ¢») ? $C¦ÃÌñˆ¢» : array($a£Ü«”ÄÆÍ[74] => array(), $a£Ü«”ÄÆÍ[75] => array()); $e¿°Œ×Ü = array_merge($C¦ÃÌñˆ¢»[$a£Ü«”ÄÆÍ[74]], $C¦ÃÌñˆ¢»[$a£Ü«”ÄÆÍ[75]]); foreach ($e¿°Œ×Ü as $A£‚ğ•èÍ») { $EÏÌ÷óğ¥ = $A£‚ğ•èÍ»[$a£Ü«”ÄÆÍ[29]] == $a£Ü«”ÄÆÍ[193]; $Dùàœáâƒô = $B¦Êëóºâ->getPathInner($A£‚ğ•èÍ»[$a£Ü«”ÄÆÍ[76]]); $A³¹Â†çÅ = self::copyPath($B¦Êëóºâ, $Dùàœáâƒô, $D¸ÇËŒĞÏò, $EÑ¢µø»ˆÃ, $C»Š»É›“œ, $Eä·ªÙôÛï, $EÏÌ÷óğ¥); if (!$A³¹Â†çÅ) { IO::errorTips($a£Ü«”ÄÆÍ[1084] . $Dùàœáâƒô . $a£Ü«”ÄÆÍ[67] . $EÑ¢µø»ˆÃ); } } goto D¥®ˆ«ã’; cñåËÎ…Š: if ($bá¥ç¼ÁéÓ) { return self::copyFile($B¦Êëóºâ, $Dùàœáâƒô, $D¸ÇËŒĞÏò, $EÑ¢µø»ˆÃ, $eè¦Ê÷¯Ñ, $Eä·ªÙôÛï); } if ($C»Š»É›“œ == REPEAT_RENAME_FOLDER) { $C»Š»É›“œ = !1; } $Fšâ×ùÔå› = rtrim($EÑ¢µø»ˆÃ, $a£Ü«”ÄÆÍ[8]) . $a£Ü«”ÄÆÍ[8] . $eè¦Ê÷¯Ñ; goto EÊ¨Š¬ï’‘; EÊ¨Š¬ï’‘: $F´Í“ö¿¦¶ = $D¸ÇËŒĞÏò->mkdir($D¸ÇËŒĞÏò->getPath($Fšâ×ùÔå›)); $EÑ¢µø»ˆÃ = $D¸ÇËŒĞÏò->getPathInner($F´Í“ö¿¦¶); $C¦ÃÌñˆ¢» = $B¦Êëóºâ->listPath($Dùàœáâƒô, !0); goto aéñÔÚ£ĞÏ; D¥®ˆ«ã’: self::copyMoveKeepInfo($B¦Êëóºâ, $Dùàœáâƒô, $F´Í“ö¿¦¶); return $F´Í“ö¿¦¶; goto D«°šÓ–İ·; D«°šÓ–İ·: } private static function copyFile($bŠ¹Ôì„æÈ, $e“ÑñÃ®Ò, $cŸ´Á‡æÔÊ, $Cá‰íñùå, $B®ÌŒšê, $eæĞ–Ñ»·Û) { goto aæËÑ»Ôè„; eíªé‹ëÏ‚: Hook::trigger($aó¯¤êâæ–[1086], $bŠ¹Ôì„æÈ, $e“ÑñÃ®Ò, $cŸ´Á‡æÔÊ, $Cá‰íñùå, $B®ÌŒšê, $B—­‹èâİ„); if (self::driverIsSame($bŠ¹Ôì„æÈ, $cŸ´Á‡æÔÊ)) { if ($eæĞ–Ñ»·Û) { $cë±ğÎÖ®‹ = $cŸ´Á‡æÔÊ->moveFile($e“ÑñÃ®Ò, $Cá‰íñùå); } else { $cë±ğÎÖ®‹ = $cŸ´Á‡æÔÊ->copyFile($e“ÑñÃ®Ò, $Cá‰íñùå); } Hook::trigger($aó¯¤êâæ–[1087], $bŠ¹Ôì„æÈ, $e“ÑñÃ®Ò, $cŸ´Á‡æÔÊ, $Cá‰íñùå, $B®ÌŒšê, $cë±ğÎÖ®‹); self::copyMoveKeepInfo($bŠ¹Ôì„æÈ, $e“ÑñÃ®Ò, $cë±ğÎÖ®‹); return $cë±ğÎÖ®‹; } $DËöÛÂ‘˜ö = TEMP_FILES; goto DĞçÈíÊÏ©; aæËÑ»Ôè„: $aó¯¤êâæ– =& $_SERVER[©äõ½¡]; $Cá‰íñùå = $cŸ´Á‡æÔÊ->getPath(rtrim($Cá‰íñùå, $aó¯¤êâæ–[8]) . $aó¯¤êâæ–[8] . $B®ÌŒšê); $B—­‹èâİ„ = $aó¯¤êâæ–[1085] . time() . rand_string(5); goto eíªé‹ëÏ‚; E½¶ä¥®—: self::remove($fº³ÅŞ„‹); Hook::trigger($aó¯¤êâæ–[1087], $bŠ¹Ôì„æÈ, $e“ÑñÃ®Ò, $cŸ´Á‡æÔÊ, $Cá‰íñùå, $B®ÌŒšê, $cë±ğÎÖ®‹); self::copyMoveKeepInfo($bŠ¹Ôì„æÈ, $e“ÑñÃ®Ò, $cë±ğÎÖ®‹); goto E…¡˜‚À»; d­½Ü¨ù±Ø: $D›Œ‚î¸Å = $bŠ¹Ôì„æÈ->download($e“ÑñÃ®Ò, $D›Œ‚î¸Å); $D›Œ‚î¸Å = $bŠ¹Ôì„æÈ->iconvApp($D›Œ‚î¸Å); $cë±ğÎÖ®‹ = $cŸ´Á‡æÔÊ->upload($Cá‰íñùå, $D›Œ‚î¸Å, $eæĞ–Ñ»·Û); goto E½¶ä¥®—; DĞçÈíÊÏ©: if ($GLOBALS[$aó¯¤êâæ–[6]][$aó¯¤êâæ–[88]][$aó¯¤êâæ–[797]]) { $DËöÛÂ‘˜ö = $GLOBALS[$aó¯¤êâæ–[6]][$aó¯¤êâæ–[88]][$aó¯¤êâæ–[797]]; } $eæĞ–Ñ»·Û = !0; $bå°«’œŠõ = $DËöÛÂ‘˜ö; goto F¢¶¸Éé‚; F¢¶¸Éé‚: mk_dir($bå°«’œŠõ); $D›Œ‚î¸Å = $bå°«’œŠõ . $B—­‹èâİ„; $fº³ÅŞ„‹ = $D›Œ‚î¸Å; goto d­½Ü¨ù±Ø; E…¡˜‚À»: return $cë±ğÎÖ®‹; goto Cš¹È ­½; Cš¹È ­½: } private static function copyMoveKeepInfo($e¼ãƒ–ëÓ, $e¼ò”‰…ÑÓ, $aºäø¬ÉÛ°) { if (!$aºäø¬ÉÛ°) { return; } $BŒ±ÖæÂ³„ = $e¼ãƒ–ëÓ->info($e¼ò”‰…ÑÓ); if (!is_array($BŒ±ÖæÂ³„)) { return; } IO::setModifyTime($aºäø¬ÉÛ°, $BŒ±ÖæÂ³„[$_SERVER[©äõ½¡][84]]); } public static function pathFather($FÏ‡ÒğŒçµ) { $B¬Ş¾®¯ê = IO::init($FÏ‡ÒğŒçµ); $béòøœ’ŸÂ = $B¬Ş¾®¯ê->pathFather($B¬Ş¾®¯ê->path); return $B¬Ş¾®¯ê->getPathOuter($béòøœ’ŸÂ); } public static function fileOut($F‡•ğ†Ê…, $eà¨—Íéí = false, $eÍ‘°Ê£Õ = false, $FÃÑÊïÆÅ = '') { $cŠ¹©Ë¼ï = self::driverMake($F‡•ğ†Ê…); if ($cŠ¹©Ë¼ï->isFileOutServer()) { return $cŠ¹©Ë¼ï->fileOutServer($F‡•ğ†Ê…, $eà¨—Íéí, $eÍ‘°Ê£Õ, $FÃÑÊïÆÅ); } return $cŠ¹©Ë¼ï->fileOut($F‡•ğ†Ê…, $eà¨—Íéí, $eÍ‘°Ê£Õ, $FÃÑÊïÆÅ); } public static function fileOutImage($e®êÀ¾àù©, $CÙ‘õÍµõ = 250) { $b²ºŸ³µß­ = array(250, 600, 1200, 2000, 3000, 5000); for ($e¨Ş×¼‡Í = 0; $e¨Ş×¼‡Í < count($b²ºŸ³µß­); $e¨Ş×¼‡Í++) { if ($e¨Ş×¼‡Í == 0 && $CÙ‘õÍµõ <= $b²ºŸ³µß­[$e¨Ş×¼‡Í]) { $CÙ‘õÍµõ = $b²ºŸ³µß­[$e¨Ş×¼‡Í]; break; } else { if ($CÙ‘õÍµõ > $b²ºŸ³µß­[$e¨Ş×¼‡Í - 1] && $CÙ‘õÍµõ <= $b²ºŸ³µß­[$e¨Ş×¼‡Í]) { $CÙ‘õÍµõ = $b²ºŸ³µß­[$e¨Ş×¼‡Í]; break; } else { if ($e¨Ş×¼‡Í == count($b²ºŸ³µß­) - 1 && $CÙ‘õÍµõ > $b²ºŸ³µß­[$e¨Ş×¼‡Í]) { $CÙ‘õÍµõ = $b²ºŸ³µß­[$e¨Ş×¼‡Í]; break; } } } } $EŠùèòæùœ = self::driverMake($e®êÀ¾àù©); if ($EŠùèòæùœ->isFileOutServer()) { return $EŠùèòæùœ->fileOutImageServer($e®êÀ¾àù©, $CÙ‘õÍµõ); } return $EŠùèòæùœ->fileOutImage($e®êÀ¾àù©, $CÙ‘õÍµõ); } private static function driverIsSame($fÛŸŸÚ½Ø, $a©£ÊŞÎçÓ) { goto DâÛğ™Ã; fÎôÎ¥¥ÌŒ: if ($AíÉ…æ™¸£ != $fµÛäªÜ×) { return !1; } if ($AíÉ…æ™¸£ == $dŠ¬÷·¨§Ò[753]) { return !0; } if ($AíÉ…æ™¸£ == $dŠ¬÷·¨§Ò[106]) { return !0; } goto Eãâ‚èÓ¤; Eãâ‚èÓ¤: if ($fÛŸŸÚ½Ø->pathDriver == $a©£ÊŞÎçÓ->pathDriver) { return !0; } return !1; goto aªìñˆªó¦; DâÛğ™Ã: $dŠ¬÷·¨§Ò =& $_SERVER[©äõ½¡]; $AíÉ…æ™¸£ = $fÛŸŸÚ½Ø->getType(); $fµÛäªÜ× = $a©£ÊŞÎçÓ->getType(); goto fÎôÎ¥¥ÌŒ; aªìñˆªó¦: } public static function copyUpdate($fÍ÷‰‡Ø¹Ã, $Dƒ¡ä‘Àš²) { goto A¶íáÈˆˆÅ; EïÀ£Ğ—œğ: $Bë“öï—É = array(); foreach ($B÷Ä‰ãÂà¯ as $dÏÜõ§õ†Ó => $a¦Ïã‡¸¾¢) { if (isset($F½œé—Ãİ¥[$dÏÜõ§õ†Ó])) { if ($a¦Ïã‡¸¾¢[$e±˜Í’ê…ò[77]] == 1) { continue; } if ($F½œé—Ãİ¥[$dÏÜõ§õ†Ó][$e±˜Í’ê…ò[78]] == $a¦Ïã‡¸¾¢[$e±˜Í’ê…ò[78]]) { continue; } } if ($a¦Ïã‡¸¾¢[$e±˜Í’ê…ò[77]] == 1) { $Bë“öï—É[] = $Dƒ¡ä‘Àš² . $e±˜Í’ê…ò[8] . $dÏÜõ§õ†Ó; continue; } $EÚ¼Ëä’íß = strstr(trim($dÏÜõ§õ†Ó, $e±˜Í’ê…ò[8]), $e±˜Í’ê…ò[8]) ? get_path_father($dÏÜõ§õ†Ó) : $e±˜Í’ê…ò[33]; $b“šöƒ[] = array($e±˜Í’ê…ò[1088] => $a¦Ïã‡¸¾¢[$e±˜Í’ê…ò[76]], $e±˜Í’ê…ò[1089] => rtrim($Dƒ¡ä‘Àš², $e±˜Í’ê…ò[8]) . $e±˜Í’ê…ò[8] . $EÚ¼Ëä’íß, $e±˜Í’ê…ò[1090] => $a¦Ïã‡¸¾¢); } $eˆ£ÒùŸÄ¨ = array($e±˜Í’ê…ò[193] => $b“šöƒ, $e±˜Í’ê…ò[77] => $Bë“öï—É); goto a¡îğØ„ŠÉ; a¡îğØ„ŠÉ: Hook::trigger($e±˜Í’ê…ò[1091], $fÍ÷‰‡Ø¹Ã, $Dƒ¡ä‘Àš², $eˆ£ÒùŸÄ¨); foreach ($Bë“öï—É as $a¦Ïã‡¸¾¢) { IO::mkdir($a¦Ïã‡¸¾¢); } foreach ($b“šöƒ as $a¦Ïã‡¸¾¢) { IO::copy($a¦Ïã‡¸¾¢[$e±˜Í’ê…ò[1088]], $a¦Ïã‡¸¾¢[$e±˜Í’ê…ò[1089]], REPEAT_REPLACE); } goto aŞµ­ÇÆ†; d‰â‡ÄÂè: $B÷Ä‰ãÂà¯ = self::_listAll($fÍ÷‰‡Ø¹Ã); $F½œé—Ãİ¥ = self::_listAll($Dƒ¡ä‘Àš²); $b“šöƒ = array(); goto EïÀ£Ğ—œğ; A¶íáÈˆˆÅ: $e±˜Í’ê…ò =& $_SERVER[©äõ½¡]; if (!IO::exist($fÍ÷‰‡Ø¹Ã)) { return !1; } if (!IO::exist($Dƒ¡ä‘Àš²)) { IO::mkdir($Dƒ¡ä‘Àš²); } goto d‰â‡ÄÂè; aŞµ­ÇÆ†: } private static function _listAll($A‘ßöºÓ¤) { $aè¬“˜¬– =& $_SERVER[©äõ½¡]; $A‘ßöºÓ¤ = KodIO::clear($A‘ßöºÓ¤); $C¶Íˆç‘ò = IO::listAll($A‘ßöºÓ¤); foreach ($C¶Íˆç‘ò as &$Fîœç°¶ØÑ) { $FÊÌ‰õ¾à’ = substr($Fîœç°¶ØÑ[$aè¬“˜¬–[76]], strlen($A‘ßöºÓ¤)); $Fîœç°¶ØÑ[$aè¬“˜¬–[1092]] = trim($FÊÌ‰õ¾à’, $aè¬“˜¬–[8]); } unset($Fîœç°¶ØÑ); return array_to_keyvalue($C¶Íˆç‘ò, $aè¬“˜¬–[1092]); } public static function fileSubstr($Dåà•«˜ä, $fëâ¦­¯‘È, $AÜîğÂ·Çµ = false) { goto BÇì¥“¦ì×; BÇì¥“¦ì×: $E™Ù‰¬Ò„« =& $_SERVER[©äõ½¡]; $bòçî«ÀØã = self::driverMake($Dåà•«˜ä); $D ï‚±ùö = $bòçî«ÀØã->size($Dåà•«˜ä); goto A¸ˆµ‘ë«—; A¸ˆµ‘ë«—: $a×ó­Ã‹îÚ = $fëâ¦­¯‘È; $AäœŠŞ‰‚ = $AÜîğÂ·Çµ; if ($fëâ¦­¯‘È < 0) { $fëâ¦­¯‘È = $D ï‚±ùö + $fëâ¦­¯‘È; } goto C÷‹­Ë–‹ì; cÍ¾Æ¿ÌÚ: if (!$E¢í¥í™› && $AÜîğÂ·Çµ && isset($GLOBALS[$E™Ù‰¬Ò„«[1095]])) { throw new Exception($GLOBALS[$E™Ù‰¬Ò„«[1095]][$E™Ù‰¬Ò„«[1096]]); } return $E¢í¥í™›; goto dµ‹Ö«®; C÷‹­Ë–‹ì: if ($AÜîğÂ·Çµ === !1) { $AÜîğÂ·Çµ = $D ï‚±ùö - $fëâ¦­¯‘È; } if ($fëâ¦­¯‘È + $AÜîğÂ·Çµ > $D ï‚±ùö) { $AÜîğÂ·Çµ = $D ï‚±ùö - $fëâ¦­¯‘È; } if (!$D ï‚±ùö && $bòçî«ÀØã->getType() == $E™Ù‰¬Ò„«[106] && !$bòçî«ÀØã->exist($Dåà•«˜ä)) { throw new Exception($E™Ù‰¬Ò„«[1093] . LNG($E™Ù‰¬Ò„«[1094]) . $E™Ù‰¬Ò„«[959] . get_path_this($Dåà•«˜ä) . $E™Ù‰¬Ò„«[33]); } goto E ‚ò¼¼Ê†; E ‚ò¼¼Ê†: if ($AÜîğÂ·Çµ <= 0) { return $E™Ù‰¬Ò„«[33]; } if ($fëâ¦­¯‘È < 0 || $fëâ¦­¯‘È >= $D ï‚±ùö || $AÜîğÂ·Çµ > 1024 * 1024 * 10) { throw new Exception("\146\x69\154\145\x52\x65\x61\144\40\145\x72\162\157\162\41\40\163\164\x61\x72\164\x3d{$fëâ¦­¯‘È}\73\x6c\x65\156\147\164\150\75{$AÜîğÂ·Çµ}\73\x20\x73\151\x7a\x65\75{$D ï‚±ùö}\x3b"); } $E¢í¥í™› = $bòçî«ÀØã->fileSubstr($Dåà•«˜ä, $fëâ¦­¯‘È, $AÜîğÂ·Çµ); goto cÍ¾Æ¿ÌÚ; dµ‹Ö«®: } private static function driverMake(&$Cò”ÃÔÖÆ©) { goto eçæšö‰¾Ê; cæÆã¡ÁŠ¬: if ($F©®Ïˆ™©[$CÁîáÛùƒ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$F©®Ïˆ™©[$CÁîáÛùƒ[395]]]) { return !1; } $Cò”ÃÔÖÆ© = $F©®Ïˆ™©[$CÁîáÛùƒ[1097]]; $EÖ—Š²ÄÔƒ = self::driverGet($F©®Ïˆ™©, $Cò”ÃÔÖÆ©); goto DÔàçß„Î…; eçæšö‰¾Ê: $CÁîáÛùƒ =& $_SERVER[©äõ½¡]; $F©®Ïˆ™© = KodIO::parse($Cò”ÃÔÖÆ©); if (!self::$driverListSystem) { $e–·‡ƒ½‚­ = Model($CÁîáÛùƒ[762])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($e–·‡ƒ½‚­, $CÁîáÛùƒ[395]); } goto cæÆã¡ÁŠ¬; DÔàçß„Î…: return $EÖ—Š²ÄÔƒ; goto AÒˆ‰ä‚Î; AÒˆ‰ä‚Î: } private static function driverGet($F˜òÊè«Š, &$DßºŠø”í) { goto eÄ³ĞøÑòå; C‡—©ôÂÙó: switch ($F˜òÊè«Š[$e¬ô¹²°”[29]]) { case KodIO::KOD_IO: $C‹Ü¼–ß° = self::$driverListSystem[$dµ‹©Çµ›ç]; break; case KodIO::KOD_SOURCE: $DßºŠø”í = $dµ‹©Çµ›ç . $DßºŠø”í; $C‹Ü¼–ß° = array($e¬ô¹²°”[1099] => $e¬ô¹²°”[1100], $e¬ô¹²°”[6] => $F˜òÊè«Š); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $f›À–Ïºğ = $GLOBALS[$e¬ô¹²°”[1101]]; self::$driverListUser = array_to_keyvalue($f›À–Ïºğ, $e¬ô¹²°”[395]); } $C‹Ü¼–ß° = self::$driverListUser[$dµ‹©Çµ›ç]; break; case KodIO::KOD_SHARE_LINK: $C‹Ü¼–ß° = array($e¬ô¹²°”[1099] => $e¬ô¹²°”[1102], $e¬ô¹²°”[6] => $F˜òÊè«Š); $F¼‚º¬íï„ = Action($e¬ô¹²°”[1103])->sharePathInfo($F˜òÊè«Š[$e¬ô¹²°”[76]]); $DßºŠø”í = $F¼‚º¬íï„[$e¬ô¹²°”[397]]; if (!$F¼‚º¬íï„[$e¬ô¹²°”[397]]) { $A‰ÇôŠÅ˜ = Model($e¬ô¹²°”[589])->getInfo($F¼‚º¬íï„[$e¬ô¹²°”[482]]); $DßºŠø”í = KodIO::clear($A‰ÇôŠÅ˜[$e¬ô¹²°”[1104]] . $F˜òÊè«Š[$e¬ô¹²°”[1097]]); $F˜òÊè«Š[$e¬ô¹²°”[480]] = $A‰ÇôŠÅ˜; $F˜òÊè«Š[$e¬ô¹²°”[1081]] = $DßºŠø”í; $C‹Ü¼–ß° = array($e¬ô¹²°”[1099] => $e¬ô¹²°”[1105], $e¬ô¹²°”[6] => $F˜òÊè«Š); } break; case KodIO::KOD_SHARE_ITEM: $C‹Ü¼–ß° = array($e¬ô¹²°”[1099] => $e¬ô¹²°”[1106], $e¬ô¹²°”[6] => $F˜òÊè«Š); $A‰ÇôŠÅ˜ = Model($e¬ô¹²°”[589])->getInfo($F˜òÊè«Š[$e¬ô¹²°”[395]]); if ($A‰ÇôŠÅ˜[$e¬ô¹²°”[397]] == $e¬ô¹²°”[191]) { $DßºŠø”í = KodIO::clear($A‰ÇôŠÅ˜[$e¬ô¹²°”[1104]] . $F˜òÊè«Š[$e¬ô¹²°”[1097]]); $F˜òÊè«Š[$e¬ô¹²°”[480]] = $A‰ÇôŠÅ˜; $F˜òÊè«Š[$e¬ô¹²°”[1081]] = $DßºŠø”í; $C‹Ü¼–ß° = array($e¬ô¹²°”[1099] => $e¬ô¹²°”[1107], $e¬ô¹²°”[6] => $F˜òÊè«Š); } else { if (!$DßºŠø”í) { $DßºŠø”í = $A‰ÇôŠÅ˜[$e¬ô¹²°”[397]]; } } break; default: $DßºŠø”í = $F˜òÊè«Š[$e¬ô¹²°”[76]]; $C‹Ü¼–ß° = array($e¬ô¹²°”[1099] => $e¬ô¹²°”[1108]); break; } $aÑø‚Í”îÚ = $F˜òÊè«Š[$e¬ô¹²°”[76]]; if (!isset(self::$driverCache[$aÑø‚Í”îÚ])) { $c©ƒ¾Ã“‘£ = strtolower($C‹Ü¼–ß°[$e¬ô¹²°”[94]]); $fœ÷·òÇÖ” = $GLOBALS[$e¬ô¹²°”[6]][$e¬ô¹²°”[88]][$e¬ô¹²°”[828]]; $DİÆÎåŒ·º = $e¬ô¹²°”[72] . (isset($fœ÷·òÇÖ”[$c©ƒ¾Ã“‘£]) ? $fœ÷·òÇÖ”[$c©ƒ¾Ã“‘£] : ucfirst($c©ƒ¾Ã“‘£)); if (!class_exists($DİÆÎåŒ·º)) { show_json("{$DİÆÎåŒ·º}\x20\156\157\164\40\x65\170\151\163\x74\163\41", !1); } $fã±Š®‡ò = isset($C‹Ü¼–ß°[$e¬ô¹²°”[6]]) ? $C‹Ü¼–ß°[$e¬ô¹²°”[6]] : !1; self::$driverCache[$aÑø‚Í”îÚ] = new $DİÆÎåŒ·º($fã±Š®‡ò); } goto ašİ¦À˜©; ašİ¦À˜©: $bÙ©ˆÏô„¯ = self::$driverCache[$aÑø‚Í”îÚ]; $bÙ©ˆÏô„¯->pathDriver = $c´Õµ¨Ñº“; $bÙ©ˆÏô„¯->pathBase = $e¬ô¹²°”[33]; goto B´¸¯ŒôÅ; eÄ³ĞøÑòå: $e¬ô¹²°” =& $_SERVER[©äõ½¡]; $c´Õµ¨Ñº“ = $F˜òÊè«Š[$e¬ô¹²°”[1098]]; $dµ‹©Çµ›ç = $F˜òÊè«Š[$e¬ô¹²°”[395]]; goto C‡—©ôÂÙó; B´¸¯ŒôÅ: if (isset($C‹Ü¼–ß°[$e¬ô¹²°”[6]][$e¬ô¹²°”[1109]])) { $bÙ©ˆÏô„¯->pathBase = rtrim($C‹Ü¼–ß°[$e¬ô¹²°”[6]][$e¬ô¹²°”[1109]], $e¬ô¹²°”[8]) . $e¬ô¹²°”[8]; $DßºŠø”í = $bÙ©ˆÏô„¯->pathBase . ltrim($DßºŠø”í, $e¬ô¹²°”[8]); } $DßºŠø”í = $bÙ©ˆÏô„¯->getPath($DßºŠø”í); if (isset($F˜òÊè«Š[$e¬ô¹²°”[1081]])) { $DßºŠø”í = $F˜òÊè«Š[$e¬ô¹²°”[1081]]; } goto F——‚¨¡…Ş; F——‚¨¡…Ş: $bÙ©ˆÏô„¯->path = $DßºŠø”í; return $bÙ©ˆÏô„¯; goto dñ´¬îïƒÔ; dñ´¬îïƒÔ: } public static function errorTips($FèÇÇ«•ÃÊ = false) { goto d¢æÖß¡¾‰; bÚÛÜ˜¥‚í: if ($FèÇÇ«•ÃÊ === -1) { return $D˜Â›«ÑÁÙ ? $D˜Â›«ÑÁÙ[count($D˜Â›«ÑÁÙ) - 1] : $bÜ¼©ŒÕ©­[33]; } if ($FèÇÇ«•ÃÊ === !1) { return implode($bÜ¼©ŒÕ©­[229], $D˜Â›«ÑÁÙ); } if (count($D˜Â›«ÑÁÙ) >= $aƒ¦³ßÛ‰) { $D˜Â›«ÑÁÙ = array_slice($D˜Â›«ÑÁÙ, $aƒ¦³ßÛ‰ * 0.5, $aƒ¦³ßÛ‰); } goto dºŠ˜Ö»Šø; dºŠ˜Ö»Šø: $D˜Â›«ÑÁÙ[] = $FèÇÇ«•ÃÊ; write_log($bÜ¼©ŒÕ©­[160] . ACTION . $bÜ¼©ŒÕ©­[1110] . $FèÇÇ«•ÃÊ, $bÜ¼©ŒÕ©­[1111]); goto dŸ¯…Â¡¦š; d¢æÖß¡¾‰: $bÜ¼©ŒÕ©­ =& $_SERVER[©äõ½¡]; static $D˜Â›«ÑÁÙ = array(); $aƒ¦³ßÛ‰ = 1000; goto bÚÛÜ˜¥‚í; dŸ¯…Â¡¦š: } public static function getLastError($b„ÕªñĞ½ = '') { $fî¡‘”áø = self::errorTips(-1); return $fî¡‘”áø ? $fî¡‘”áø : $b„ÕªñĞ½; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $e°â«ù; if (!$e°â«ù) { $b¡ÂÎôŒº = IO::init($_SERVER[©äõ½¡][8]); } return $b¡ÂÎôŒº; } private static function iconvSystem($F¿÷¤ÌÃ­ˆ) { return self::local()->iconvSystem($F¿÷¤ÌÃ­ˆ); } private static function iconvApp($F¶ò×ö®îï) { return self::local()->iconvApp($F¶ò×ö®îï); } public static function zip($BˆµÛÇ‡’á, $aÄœ•Šº¥ = "\x7a\x69\160", $D ‚ÁåôÍ = '', $E±»¿Ã„â = REPEAT_RENAME) { goto e…Ú‚†ò‹×; e×ß×¥¹²ß: foreach ($e†»†¿š¶ë as $E´ƒšÓ»² => $F˜¸Ó¢Ù´ê) { $e†»†¿š¶ë[$E´ƒšÓ»²] = self::iconvSystem($F˜¸Ó¢Ù´ê); } KodArchive::create($A¶µÃ‰Ê’«, $e†»†¿š¶ë); if (!IO::exist($F’°ï‹–“Ñ)) { if ($b±ïÜõã½) { del_dir($b±ïÜõã½); } show_json(LNG($féÇê‹åÖ[1114]), !1); } goto fÊ¬…àŸ¹Í; EÊÊ¼ƒ“À: $F’°ï‹–“Ñ = $CÅ¼˜öšÉ¥ . $Fã†Ûˆ¬ª . $féÇê‹åÖ[95] . $aÄœ•Šº¥; $F’°ï‹–“Ñ = get_filename_auto($F’°ï‹–“Ñ, $féÇê‹åÖ[33], $E±»¿Ã„â); $A¶µÃ‰Ê’« = self::iconvSystem($F’°ï‹–“Ñ); goto e×ß×¥¹²ß; e…Ú‚†ò‹×: $féÇê‹åÖ =& $_SERVER[©äõ½¡]; $Eç÷«ïØ = self::init($BˆµÛÇ‡’á[0][$féÇê‹åÖ[76]]); $AËÂ ¢ò‘ = self::info($BˆµÛÇ‡’á[0][$féÇê‹åÖ[76]]); goto AİŒˆ÷İó; eí¹¾†¡¦: if (!$dœï‡¸ÉÎ) { del_dir($b±ïÜõã½); show_json(LNG($féÇê‹åÖ[1114]), !1); } del_dir($b±ïÜõã½); return $dœï‡¸ÉÎ; goto Fœò®«Òø; fÊ¬…àŸ¹Í: if ($D ‚ÁåôÍ || !$b±ïÜõã½) { if ($b±ïÜõã½ && strstr($b±ïÜõã½, TEMP_FILES)) { $D‘˜ƒÍœÃÑ = $e†»†¿š¶ë = array(); recursion_dir($CÅ¼˜öšÉ¥, $D‘˜ƒÍœÃÑ, $e†»†¿š¶ë, 0); foreach ($D‘˜ƒÍœÃÑ as $eÆ›‘­ŒğÅ) { del_dir($eÆ›‘­ŒğÅ); } foreach ($e†»†¿š¶ë as $e¥ªÀñÑá) { if ($e¥ªÀñÑá == $A¶µÃ‰Ê’«) { continue; } del_file($e¥ªÀñÑá); } } return $F’°ï‹–“Ñ; } $cùß©øÇ¦ = self::pathFather($AËÂ ¢ò‘[$féÇê‹åÖ[76]]); $dœï‡¸ÉÎ = self::move($F’°ï‹–“Ñ, $cùß©øÇ¦, $E±»¿Ã„â); goto eí¹¾†¡¦; d‹Á†½Ë°: if (count($e†»†¿š¶ë) > 1) { $bÎ˜É”œ = IO::info(IO::pathFather($AËÂ ¢ò‘[$féÇê‹åÖ[76]])); $Fã†Ûˆ¬ª = $bÎ˜É”œ[$féÇê‹åÖ[28]]; } $CÅ¼˜öšÉ¥ = $b±ïÜõã½; if (!$CÅ¼˜öšÉ¥) { $CÅ¼˜öšÉ¥ = get_path_father($AËÂ ¢ò‘[$féÇê‹åÖ[76]]); if (!$D ‚ÁåôÍ && $Eç÷«ïØ->getType() == $féÇê‹åÖ[106]) { $CÅ¼˜öšÉ¥ = get_path_father($Eç÷«ïØ->path); } $F‹×èëÓ– = IO::info($CÅ¼˜öšÉ¥); if (!$F‹×èëÓ–[$féÇê‹åÖ[196]]) { show_json(LNG($féÇê‹åÖ[1113]), !1); } } goto EÊÊ¼ƒ“À; AİŒˆ÷İó: $b±ïÜõã½ = !1; if (!$D ‚ÁåôÍ && $Eç÷«ïØ->getType() == $féÇê‹åÖ[106]) { $e†»†¿š¶ë = self::zipFileList($BˆµÛÇ‡’á); } else { $b±ïÜõã½ = $D ‚ÁåôÍ ? $D ‚ÁåôÍ : TEMP_FILES . $féÇê‹åÖ[1112] . time() . rand_string(8) . $féÇê‹åÖ[8]; mk_dir($b±ïÜõã½); $e†»†¿š¶ë = self::zipFileList($BˆµÛÇ‡’á, $b±ïÜõã½); } $Fã†Ûˆ¬ª = $AËÂ ¢ò‘[$féÇê‹åÖ[28]]; goto d‹Á†½Ë°; Fœò®«Òø: } public static function unzip($DùÛ¦ì®¶, $D¶Ãƒ‘ = "\x72\145\160\154\141\x63\x65") { goto A¨‹Ê¾”ÒÑ; bØ¥©é¿ƒí: Hook::trigger($bŒËùàÍÙß[1122], $F‚ĞÎÔ¹µª); recursion_dir($F‚ĞÎÔ¹µª, $Bˆæšì½è, $Fğçíá’Ø™, 0); $e…ÇğÀß’ï = array_merge($Bˆæšì½è, $Fğçíá’Ø™); goto cÒë¸ğ´Ô«; cÒë¸ğ´Ô«: foreach ($e…ÇğÀß’ï as $f÷¥¡¥Œ’) { $f÷¥¡¥Œ’ = self::iconvApp($f÷¥¡¥Œ’); self::move($f÷¥¡¥Œ’, $aÚ”«Î¥ƒË, $D¶Ãƒ‘); } del_dir($F‚ĞÎÔ¹µª); if (!$a¡¬Ú½¾Óù) { del_file($Eœ¢ùÃìß); } goto b“¦Õìäí»; E”ñßî‡Ó…: mk_dir($F‚ĞÎÔ¹µª); $Cù‘ĞÍâî = self::fileExt($fÓÌ‡¥ïÅ¦); $Eœ¢ùÃìß = $F‚ĞÎÔ¹µª . $bŒËùàÍÙß[95] . $Cù‘ĞÍâî; goto e…ğÚ²”ÀŠ; A¨‹Ê¾”ÒÑ: $bŒËùàÍÙß =& $_SERVER[©äõ½¡]; $eÌÚ’¯ˆ„ = $DùÛ¦ì®¶[$bŒËùàÍÙß[76]]; $aÚ”«Î¥ƒË = $DùÛ¦ì®¶[$bŒËùàÍÙß[1115]]; goto C‚ÚÆ§¥; e…ğÚ²”ÀŠ: if (!@file_exists(self::iconvSystem($Eœ¢ùÃìß))) { $a¡¬Ú½¾Óù = self::localFilePath($eÌÚ’¯ˆ„, $Cù‘ĞÍâî); $Eœ¢ùÃìß = $a¡¬Ú½¾Óù ? $a¡¬Ú½¾Óù : parent::download($eÌÚ’¯ˆ„, $Eœ¢ùÃìß); } $Eœ¢ùÃìß = self::iconvSystem($Eœ¢ùÃìß); $Cí»¸¡ˆ’‘ = isset($DùÛ¦ì®¶[$bŒËùàÍÙß[1117]]) ? $DùÛ¦ì®¶[$bŒËùàÍÙß[1117]] : $bŒËùàÍÙß[1118]; goto E¦ö¼šÂº; C‚ÚÆ§¥: if (!($fÓÌ‡¥ïÅ¦ = parent::info($eÌÚ’¯ˆ„))) { show_json(LNG($bŒËùàÍÙß[1116]), !1); } if (!($B±´Ë°Ô  = parent::infoFull($aÚ”«Î¥ƒË))) { $aÚ”«Î¥ƒË = parent::mkdir($aÚ”«Î¥ƒË); $B±´Ë°Ô  = array($bŒËùàÍÙß[76] => $aÚ”«Î¥ƒË); } else { if (isset($B±´Ë°Ô [$bŒËùàÍÙß[397]]) && trim($B±´Ë°Ô [$bŒËùàÍÙß[76]], $bŒËùàÍÙß[8]) != trim($aÚ”«Î¥ƒË, $bŒËùàÍÙß[8])) { $e˜‘‚«å‚µ = KodIO::make($B±´Ë°Ô [$bŒËùàÍÙß[492]]); $c¸¼é®¼¹ƒ = parent::fileNameAuto($e˜‘‚«å‚µ, $B±´Ë°Ô [$bŒËùàÍÙß[28]], REPEAT_RENAME_FOLDER, !0); $aÚ”«Î¥ƒË = parent::mkdir($e˜‘‚«å‚µ . $c¸¼é®¼¹ƒ); $B±´Ë°Ô  = array($bŒËùàÍÙß[76] => $aÚ”«Î¥ƒË); } } $aÚ”«Î¥ƒË = $B±´Ë°Ô [$bŒËùàÍÙß[76]]; goto C‹­çÄ; E¦ö¼šÂº: $FŒâ†’íÅ® = KodArchive::extract($Eœ¢ùÃìß, $F‚ĞÎÔ¹µª . $bŒËùàÍÙß[8], $Cí»¸¡ˆ’‘); self::archiveExt(); if (!$FŒâ†’íÅ®[$bŒËùàÍÙß[1119]]) { show_json($bŒËùàÍÙß[1120] . $FŒâ†’íÅ®[$bŒËùàÍÙß[1121]], !1); } goto bØ¥©é¿ƒí; C‹­çÄ: $E«Ó³ë½‚Š = self::tmpFileName($fÓÌ‡¥ïÅ¦); $F‚ĞÎÔ¹µª = TEMP_FILES . $E«Ó³ë½‚Š; del_dir($F‚ĞÎÔ¹µª); goto E”ñßî‡Ó…; b“¦Õìäí»: return !0; goto fÎÔß¹ÈŸä; fÎÔß¹ÈŸä: } public static function unzipList($Eë‘Ì­¸Ò) { goto D¥‚—â…À; cğïÛ’¥êé: $fŸåø›¬·Ÿ = self::iconvSystem($fŸåø›¬·Ÿ); if ($d…İ•·ù‘ >= 0) { $AØºÊºˆŠõ = isset($Eë‘Ì­¸Ò[$cˆä¯é“±é[1127]]) ? $Eë‘Ì­¸Ò[$cˆä¯é“±é[1127]] : !1; $e×î‡Âäöù = isset($Eë‘Ì­¸Ò[$cˆä¯é“±é[28]]) ? $Eë‘Ì­¸Ò[$cˆä¯é“±é[28]] : $cˆä¯é“±é[33]; KodArchive::filePreview($fŸåø›¬·Ÿ, $d…İ•·ù‘, $AØºÊºˆŠõ, $e×î‡Âäöù); self::archiveExt(); die; } $aÄ µ§èÉ… = KodArchive::listContent($fŸåø›¬·Ÿ); goto Aš÷ÕÁœ‰È; F²…Ïâ¾ë¼: $AÍ«¯ˆÑº = self::info($fÄ¼¿òòì¡); $aÀŒÇÀ—™´ = self::fileExt($AÍ«¯ˆÑº); $DØ¦´Æ§ÛÉ = self::tmpFileName($AÍ«¯ˆÑº); goto döœ‘¦“»Ê; FÃ‘„ÔŒ†â: $Eˆ±ØŠ‚ÕÎ = 50000; if (request_url_safe($CêÚĞ³¨Ã)) { $E°ÇƒÒ¬Â‘ = parse_url_query($CêÚĞ³¨Ã); if (!isset($E°ÇƒÒ¬Â‘[$cˆä¯é“±é[76]])) { show_json($cˆä¯é“±é[1124], !1); } } $fÄ¼¿òòì¡ = isset($E°ÇƒÒ¬Â‘) ? $E°ÇƒÒ¬Â‘[$cˆä¯é“±é[76]] : $CêÚĞ³¨Ã; goto F²…Ïâ¾ë¼; döœ‘¦“»Ê: if (isset($E°ÇƒÒ¬Â‘)) { $bÁ‘…Ò÷¼¥ = array($E°ÇƒÒ¬Â‘[$cˆä¯é“±é[76]], $E°ÇƒÒ¬Â‘[$cˆä¯é“±é[1123]], $E°ÇƒÒ¬Â‘[$cˆä¯é“±é[28]]); $EëëïèêœŠ = md5(implode($cˆä¯é“±é[71], $bÁ‘…Ò÷¼¥)) . $cˆä¯é“±é[95] . get_path_ext($E°ÇƒÒ¬Â‘[$cˆä¯é“±é[28]]); } else { $bÁ‘…Ò÷¼¥ = array($AÍ«¯ˆÑº[$cˆä¯é“±é[28]], $AÍ«¯ˆÑº[$cˆä¯é“±é[76]], $AÍ«¯ˆÑº[$cˆä¯é“±é[78]]); $EëëïèêœŠ = md5(implode($cˆä¯é“±é[71], $bÁ‘…Ò÷¼¥)) . $cˆä¯é“±é[95] . $aÀŒÇÀ—™´; } if ($d…İ•·ù‘ == -1) { $Fùœ±ÁŸá = IO_PATH_SYSTEM_TEMP . "\x7a\151\x70\126\x69\145\x77\x2f{$DØ¦´Æ§ÛÉ}\57{$EëëïèêœŠ}\56\x6c\x6f\x67"; $bÉË”Î´¶µ = self::infoFull($Fùœ±ÁŸá); if ($bÉË”Î´¶µ) { $Fùœ±ÁŸá = $bÉË”Î´¶µ[$cˆä¯é“±é[76]]; $dŠ¿²³Úº¥ = self::getContent($Fùœ±ÁŸá); if ($dŠ¿²³Úº¥) { $eæ›ÅåßÔ = json_decode($dŠ¿²³Úº¥, !0); if (count($eæ›ÅåßÔ) >= $Eˆ±ØŠ‚ÕÎ) { show_json(sprintf(LNG($cˆä¯é“±é[1125]), count($eæ›ÅåßÔ)), !1); } return $eæ›ÅåßÔ; } } else { $Fùœ±ÁŸá = self::mkfile($Fùœ±ÁŸá); } } $d¾ï÷·¶íô = TEMP_FILES . $DØ¦´Æ§ÛÉ; goto Dç¥àÆÕÕÜ; bˆó‘áÏÚº: return $aÄ µ§èÉ…[$cˆä¯é“±é[1121]]; goto Bˆñ¶¬…ÀØ; Dç¥àÆÕÕÜ: if (!is_dir($d¾ï÷·¶íô)) { mk_dir($d¾ï÷·¶íô); } $fŸåø›¬·Ÿ = $d¾ï÷·¶íô . $cˆä¯é“±é[8] . $EëëïèêœŠ; if (!@file_exists(self::iconvSystem($fŸåø›¬·Ÿ))) { if (isset($E°ÇƒÒ¬Â‘)) { url_request($CêÚĞ³¨Ã, $cˆä¯é“±é[1126], $fŸåø›¬·Ÿ); } else { $Cƒé¬åíÂ = self::localFilePath($CêÚĞ³¨Ã, $aÀŒÇÀ—™´); $fŸåø›¬·Ÿ = $Cƒé¬åíÂ ? $Cƒé¬åíÂ : self::download($CêÚĞ³¨Ã, $fŸåø›¬·Ÿ); } } goto cğïÛ’¥êé; bŞ‘ÇÛ÷•Á: $eæ›ÅåßÔ = json_encode($aÄ µ§èÉ…[$cˆä¯é“±é[1121]]); self::setContent($Fùœ±ÁŸá, $eæ›ÅåßÔ); if (count($aÄ µ§èÉ…[$cˆä¯é“±é[1121]]) >= $Eˆ±ØŠ‚ÕÎ) { show_json(sprintf(LNG($cˆä¯é“±é[1125]), count($aÄ µ§èÉ…[$cˆä¯é“±é[1121]])), !1); } goto bˆó‘áÏÚº; Aš÷ÕÁœ‰È: self::archiveExt(); del_dir($d¾ï÷·¶íô); if (!$aÄ µ§èÉ…[$cˆä¯é“±é[1119]]) { show_json($aÄ µ§èÉ…[$cˆä¯é“±é[1121]], !1); } goto bŞ‘ÇÛ÷•Á; D¥‚—â…À: $cˆä¯é“±é =& $_SERVER[©äõ½¡]; $CêÚĞ³¨Ã = $Eë‘Ì­¸Ò[$cˆä¯é“±é[76]]; $d…İ•·ù‘ = isset($Eë‘Ì­¸Ò[$cˆä¯é“±é[1123]]) ? $Eë‘Ì­¸Ò[$cˆä¯é“±é[1123]] : -1; goto FÃ‘„ÔŒ†â; Bˆñ¶¬…ÀØ: } private static function fileExt($cí¶šÑÛ‰ã) { $a“‘†ÍÔÈ› =& $_SERVER[©äõ½¡]; $c’å›Å»İ = $cí¶šÑÛ‰ã[$a“‘†ÍÔÈ›[168]]; if ($c’å›Å»İ == $a“‘†ÍÔÈ›[1128]) { $FŞè†î¶« = $a“‘†ÍÔÈ›[1129]; if (substr($cí¶šÑÛ‰ã[$a“‘†ÍÔÈ›[28]], -strlen($FŞè†î¶«)) == $FŞè†î¶«) { $c’å›Å»İ = $a“‘†ÍÔÈ›[1130]; } } self::archiveExt($c’å›Å»İ); return $c’å›Å»İ; } private static function zipFileList($d›ÎËÅãÅ‚, $a«ŒƒÄŠÊÇ = false) { $E¢¥Äœé¬ =& $_SERVER[©äõ½¡]; $f¬ßøÉ‡Ó× = array(); foreach ($d›ÎËÅãÅ‚ as $cñøêœ„Œ¡) { $eê¦œ£À‰Ô = $cñøêœ„Œ¡[$E¢¥Äœé¬[76]]; if ($a«ŒƒÄŠÊÇ) { $eê¦œ£À‰Ô = self::copy($cñøêœ„Œ¡[$E¢¥Äœé¬[76]], $a«ŒƒÄŠÊÇ, $E¢¥Äœé¬[820]); } else { $Dã£Ûßë‡ = self::init($cñøêœ„Œ¡[$E¢¥Äœé¬[76]]); if ($Dã£Ûßë‡->getType() == $E¢¥Äœé¬[106]) { $eê¦œ£À‰Ô = $Dã£Ûßë‡->path; } } if ($eê¦œ£À‰Ô && self::local()->exist($eê¦œ£À‰Ô)) { $f¬ßøÉ‡Ó×[$cñøêœ„Œ¡[$E¢¥Äœé¬[76]]] = $eê¦œ£À‰Ô; } } if (!empty($f¬ßøÉ‡Ó×)) { return array_values($f¬ßøÉ‡Ó×); } show_json(LNG($E¢¥Äœé¬[1094]), !1); } public static function tmpFileName($Dµí‹ˆë÷) { $d’ô•¤•…¾ =& $_SERVER[©äõ½¡]; $AìøÎ›ïŸÜ = array($Dµí‹ˆë÷[$d’ô•¤•…¾[28]], $Dµí‹ˆë÷[$d’ô•¤•…¾[76]], $Dµí‹ˆë÷[$d’ô•¤•…¾[78]], $Dµí‹ˆë÷[$d’ô•¤•…¾[515]]); return md5(implode($d’ô•¤•…¾[71], $AìøÎ›ïŸÜ)); } private static function localFilePath($e…Õ…‰ºÚ±, $eâÄİŠ“ç²) { goto f§ŸïëŒø; f§ŸïëŒø: $A²ÓˆˆÃö¥ =& $_SERVER[©äõ½¡]; if ($eâÄİŠ“ç² == $A²ÓˆˆÃö¥[1131] && strtoupper(substr(PHP_OS, 0, 3)) == $A²ÓˆˆÃö¥[1132]) { return !1; } $d±ˆöšˆ˜Ï = KodIO::parse($e…Õ…‰ºÚ±); goto E¢Š˜ğ¹é–; E¢Š˜ğ¹é–: if ($d±ˆöšˆ˜Ï[$A²ÓˆˆÃö¥[29]] == KodIO::KOD_SOURCE) { $CÅ¦ÛÊéŸ = Model($A²ÓˆˆÃö¥[827])->fileInfoGet(KodIO::sourceID($e…Õ…‰ºÚ±)); if (!$CÅ¦ÛÊéŸ[$A²ÓˆˆÃö¥[76]]) { show_json($A²ÓˆˆÃö¥[1133], !1); } $e…Õ…‰ºÚ± = $CÅ¦ÛÊéŸ[$A²ÓˆˆÃö¥[76]]; } $E³Ì‡¬á› = self::init($e…Õ…‰ºÚ±); $B½„¼êÕíë = $E³Ì‡¬á›->getType(); goto fÑƒŠ×; fÑƒŠ×: if ($B½„¼êÕíë == $A²ÓˆˆÃö¥[106] || $B½„¼êÕíë == $A²ÓˆˆÃö¥[1134]) { if (!$E³Ì‡¬á›->exist($E³Ì‡¬á›->path)) { show_json(LNG($A²ÓˆˆÃö¥[105]), !1); } return $E³Ì‡¬á›->path; } return !1; goto a£š ÈØ; a£š ÈØ: } private static function archiveExt($DïĞŠ¯°®¥ = '') { $GLOBALS[$_SERVER[©äõ½¡][1135]] = $DïĞŠ¯°®¥; } } goto cÑ‹’Î±Ù; BÑƒ÷ªİ¦Ï: define($_SERVER[©äõ½¡][240], 0); define($_SERVER[©äõ½¡][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\154\145", "\157\162\144\x65\x72", "\141\154\x69\x61\x73", "\150\x61\x76\151\x6e\147", "\147\162\157\165\160", "\154\x6f\143\x6b", "\x64\x69\x73\x74\x69\x6e\143\x74", "\141\x75\164\157", "\x66\151\x6c\164\145\x72", "\x76\141\x6c\x69\x64\x61\x74\x65", "\162\x65\163\x75\154\x74", "\x62\151\x6e\x64", "\x74\x6f\153\x65\x6e"); public function __construct($F³ÖÕØÇ•¾ = '', $F»¡ ­µ¦… = '', $AÅöÖˆ…› = '') { $aïïèƒµˆ¨ =& $_SERVER[©äõ½¡]; $this->_initialize(); if (!empty($F³ÖÕØÇ•¾)) { if (strpos($F³ÖÕØÇ•¾, $aïïèƒµˆ¨[95])) { list($this->dbName, $this->name) = explode($aïïèƒµˆ¨[95], $F³ÖÕØÇ•¾); } else { $this->name = $F³ÖÕØÇ•¾; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($F»¡ ­µ¦…)) { $this->tablePrefix = $aïïèƒµˆ¨[33]; } elseif ($aïïèƒµˆ¨[33] != $F»¡ ­µ¦…) { $this->tablePrefix = $F»¡ ­µ¦…; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($aïïèƒµˆ¨[242]); } $this->db(0, empty($this->connection) ? $AÅöÖˆ…› : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $C­ô‹ñÑ÷Ş =& $_SERVER[©äõ½¡]; if (empty($this->fields)) { if (think_config($C­ô‹ñÑ÷Ş[243])) { $BÛ›ãÊ°¸Ì = $this->dbName ? $this->dbName : think_config($C­ô‹ñÑ÷Ş[244]); $C¥é‘£« = think_var_cache($C­ô‹ñÑ÷Ş[245] . strtolower(get_path_this($BÛ›ãÊ°¸Ì) . $C­ô‹ñÑ÷Ş[95] . $this->name)); if ($C¥é‘£«) { $cŠù±ÎÍ¦› = think_config($C­ô‹ñÑ÷Ş[246]); if (empty($cŠù±ÎÍ¦›) || $C¥é‘£«[$C­ô‹ñÑ÷Ş[247]] == $cŠù±ÎÍ¦›) { $this->fields = $C¥é‘£«; return; } } } $this->flush(); } } public function flush() { goto dê‡¿‚†¤š; E×Ä®¾ÔÚß: if (!$D¨Éà¥‡óÎ) { return !1; } $this->fields = array_keys($D¨Éà¥‡óÎ); $this->fields[$FŠø²Ä´À[248]] = !1; goto cöŸŠ¤¾¾Š; dê‡¿‚†¤š: $FŠø²Ä´À =& $_SERVER[©äõ½¡]; $this->db->setModel($this->name); $D¨Éà¥‡óÎ = $this->db->getFields($this->getTableName()); goto E×Ä®¾ÔÚß; cöŸŠ¤¾¾Š: foreach ($D¨Éà¥‡óÎ as $C¡Á²ÀŒà => $f˜¶”ôŒ×©) { $a¨‰ÉëÖ¸Ø[$C¡Á²ÀŒà] = $f˜¶”ôŒ×©[$FŠø²Ä´À[29]]; if ($f˜¶”ôŒ×©[$FŠø²Ä´À[36]]) { $this->fields[$FŠø²Ä´À[249]] = $C¡Á²ÀŒà; if ($f˜¶”ôŒ×©[$FŠø²Ä´À[39]]) { $this->fields[$FŠø²Ä´À[248]] = !0; } } } $this->fields[$FŠø²Ä´À[250]] = $a¨‰ÉëÖ¸Ø; if (think_config($FŠø²Ä´À[246])) { $this->fields[$FŠø²Ä´À[247]] = think_config($FŠø²Ä´À[246]); } goto d®…®±Œ‡ƒ; d®…®±Œ‡ƒ: if (think_config($FŠø²Ä´À[243])) { $DŒœÜ†‘¡Ô = $this->dbName ? $this->dbName : think_config($FŠø²Ä´À[244]); think_var_cache($FŠø²Ä´À[245] . strtolower(get_path_this($DŒœÜ†‘¡Ô) . $FŠø²Ä´À[95] . $this->name), $this->fields); } goto cèøÌğ¤ïë; cèøÌğ¤ïë: } public function switchModel($E¥ˆ¦°”É, $F½¯”½Š™Ö = array()) { $EÛŞ‘è Ç =& $_SERVER[©äõ½¡]; $Få®à£Ÿ‚· = ucwords(strtolower($E¥ˆ¦°”É)) . $EÛŞ‘è Ç[251]; if (!class_exists($Få®à£Ÿ‚·)) { think_exception($Få®à£Ÿ‚· . think_lang($EÛŞ‘è Ç[252])); } $this->_extModel = new $Få®à£Ÿ‚·($this->name); if (!empty($F½¯”½Š™Ö)) { foreach ($F½¯”½Š™Ö as $E£°âßÔÈ‚) { $this->_extModel->setProperty($E£°âßÔÈ‚, $this->{$E£°âßÔÈ‚}); } } return $this->_extModel; } public function __set($cå§´‚ãğ±, $e†ÛÕ†à©œ) { $this->data[$cå§´‚ãğ±] = $e†ÛÕ†à©œ; } public function __get($B­ŸÓ…‰Á•) { return isset($this->data[$B­ŸÓ…‰Á•]) ? $this->data[$B­ŸÓ…‰Á•] : null; } public function __isset($F‹Ìˆß‡ŒØ) { return isset($this->data[$F‹Ìˆß‡ŒØ]); } public function __unset($C«Éª»¡ˆ) { unset($this->data[$C«Éª»¡ˆ]); } public function __call($e¾ä—éŞ“Š, $F¿ƒ…ö÷Î…) { $f·›ö”Û¡ =& $_SERVER[©äõ½¡]; if (in_array(strtolower($e¾ä—éŞ“Š), $this->methods, !0)) { $this->options[strtolower($e¾ä—éŞ“Š)] = $F¿ƒ…ö÷Î…[0]; return $this; } elseif (in_array(strtolower($e¾ä—éŞ“Š), array($f·›ö”Û¡[253], $f·›ö”Û¡[254], $f·›ö”Û¡[255], $f·›ö”Û¡[256], $f·›ö”Û¡[257]), !0)) { $föä…¥À‚î = isset($F¿ƒ…ö÷Î…[0]) ? $F¿ƒ…ö÷Î…[0] : $f·›ö”Û¡[182]; $föä…¥À‚î = $this->db->parseKey($föä…¥À‚î); return $this->getField(strtoupper($e¾ä—éŞ“Š) . $f·›ö”Û¡[258] . $föä…¥À‚î . $f·›ö”Û¡[259] . $e¾ä—éŞ“Š, $f·›ö”Û¡[253]); } elseif (strtolower(substr($e¾ä—éŞ“Š, 0, 5)) == $f·›ö”Û¡[260]) { $föä…¥À‚î = think_parse_name(substr($e¾ä—éŞ“Š, 5)); $C¾»ÙÖ‘İ[$föä…¥À‚î] = $F¿ƒ…ö÷Î…[0]; return $this->where($C¾»ÙÖ‘İ)->find(); } elseif (strtolower(substr($e¾ä—éŞ“Š, 0, 10)) == $f·›ö”Û¡[261]) { $cÅê¶ÑŞ¦¤ = think_parse_name(substr($e¾ä—éŞ“Š, 10)); $C¾»ÙÖ‘İ[$cÅê¶ÑŞ¦¤] = $F¿ƒ…ö÷Î…[0]; return $this->where($C¾»ÙÖ‘İ)->getField($F¿ƒ…ö÷Î…[1]); } elseif (isset($this->_scope[$e¾ä—éŞ“Š])) { return $this->scope($e¾ä—éŞ“Š, $F¿ƒ…ö÷Î…[0]); } elseif (method_exists($this, $e¾ä—éŞ“Š)) { array_unshift($F¿ƒ…ö÷Î…, $e¾ä—éŞ“Š); return call_user_func_array(array($this, $f·›ö”Û¡[262]), $F¿ƒ…ö÷Î…); } else { return call_user_func_array(array(parent, $e¾ä—éŞ“Š), $F¿ƒ…ö÷Î…); } } protected function call() { goto aìÔ§±«„¡; a‰®šÖÍÈã: if (isset($Døë×¯ø¼[$b¹ø¦”¡Üº]) && $Døë×¯ø¼[$b¹ø¦”¡Üº] === $Aî»æã”ñ¦) { think_exception(__CLASS__ . $F†¨ù½¨Œ‹[4] . $Aî»æã”ñ¦ . think_lang($F†¨ù½¨Œ‹[263])); return; } $Døë×¯ø¼[] = $Aî»æã”ñ¦; if (method_exists($this, $F†¨ù½¨Œ‹[264])) { $EÀ¥áñ = call_user_func_array(array($this, $F†¨ù½¨Œ‹[265]), array($fé«¬Œ‹“Æ, $Døë×¯ø¼)); if (!is_null($EÀ¥áñ) && $EÀ¥áñ !== !1) { return $EÀ¥áñ; } } goto aœò ÌÏŸ; aœò ÌÏŸ: $c—›Î‹°ø = call_user_func_array(array($this, $Aî»æã”ñ¦), $Døë×¯ø¼); if (method_exists($this, $F†¨ù½¨Œ‹[266])) { $EÀ¥áñ = call_user_func_array(array($this, $F†¨ù½¨Œ‹[267]), array($fé«¬Œ‹“Æ, $Døë×¯ø¼, $c—›Î‹°ø)); if ($EÀ¥áñ) { return $EÀ¥áñ; } } return $c—›Î‹°ø; goto fèŞÏÇªË; aìÔ§±«„¡: $F†¨ù½¨Œ‹ =& $_SERVER[©äõ½¡]; $Døë×¯ø¼ = func_get_args(); $Aî»æã”ñ¦ = array_shift($Døë×¯ø¼); goto dÅ¥òÊà°; dÅ¥òÊà°: $fé«¬Œ‹“Æ = $Aî»æã”ñ¦; if (is_array($Aî»æã”ñ¦)) { $fé«¬Œ‹“Æ = $Aî»æã”ñ¦[1]; $Aî»æã”ñ¦ = $Aî»æã”ñ¦[0]; } $b¹ø¦”¡Üº = count($Døë×¯ø¼) - 1; goto a‰®šÖÍÈã; fèŞÏÇªË: } protected function _initialize() { } protected function _facade($fÄö›Û§Ë) { $bÂÆ¢Óœ…« =& $_SERVER[©äõ½¡]; if (!empty($this->fields)) { foreach ($fÄö›Û§Ë as $cµµ…Âáˆ => $aÊ¥ì–ˆÑ) { if (is_array($this->fields) && !in_array($cµµ…Âáˆ, $this->fields, !0)) { unset($fÄö›Û§Ë[$cµµ…Âáˆ]); } elseif (is_scalar($aÊ¥ì–ˆÑ)) { $this->_parseType($fÄö›Û§Ë, $cµµ…Âáˆ); } } } if (!empty($this->options[$bÂÆ¢Óœ…«[268]])) { $fÄö›Û§Ë = array_map($this->options[$bÂÆ¢Óœ…«[268]], $fÄö›Û§Ë); unset($this->options[$bÂÆ¢Óœ…«[268]]); } $this->_beforeWrite($fÄö›Û§Ë); return $fÄö›Û§Ë; } protected function _beforeWrite(&$b‡Œ½ğ±Û) { } public function add($bæ¨ÎÂêğ¨ = '', $Fì¯Íœˆê‰ = array(), $DÑÎ“õ­Ô = false) { goto b¹äŸ‘ñ; DÚŞÎËø­ˆ: if (!1 === $this->_beforeInsert($bæ¨ÎÂêğ¨, $Fì¯Íœˆê‰)) { return !1; } $DÖ®¯”ß¥ = $this->db->insert($bæ¨ÎÂêğ¨, $Fì¯Íœˆê‰, $DÑÎ“õ­Ô); if (!1 !== $DÖ®¯”ß¥) { $fò¾¤ŠäË‰ = $this->getLastInsID(); if ($fò¾¤ŠäË‰) { $bæ¨ÎÂêğ¨[$this->getPk()] = $fò¾¤ŠäË‰; $this->_after_insert($bæ¨ÎÂêğ¨, $Fì¯Íœˆê‰); return $fò¾¤ŠäË‰; } $this->_after_insert($bæ¨ÎÂêğ¨, $Fì¯Íœˆê‰); } goto fÄœ¨¤ÏƒØ; b¹äŸ‘ñ: if (empty($bæ¨ÎÂêğ¨)) { if (!empty($this->data)) { $bæ¨ÎÂêğ¨ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[©äõ½¡][269]); return !1; } } $Fì¯Íœˆê‰ = $this->_parseOptions($Fì¯Íœˆê‰); $bæ¨ÎÂêğ¨ = $this->_facade($bæ¨ÎÂêğ¨); goto DÚŞÎËø­ˆ; fÄœ¨¤ÏƒØ: return $DÖ®¯”ß¥; goto DÖ‰¨šì®; DÖ‰¨šì®: } protected function _beforeInsert(&$eøŒİÒÈË÷, $bÈ¤ìÓ»²ˆ) { } protected function _after_insert($bèÊëåĞè, $bˆŠÍêëŒŞ) { } public function addAll($d´Àßñ¹–¾, $eåõ¡½«ä = array(), $dêš×¢Òî = false) { goto d£áƒÁÕ¸¾; EõŒóÜÑÃë: foreach ($d´Àßñ¹–¾ as $cù®‹Åñ¨ö => $A‡¬íì—) { $d´Àßñ¹–¾[$cù®‹Åñ¨ö] = $this->_facade($A‡¬íì—); } if (method_exists($this->db, $c‡ô¿—‹ÌÖ[270])) { $Cï¥‰ÅÕ‘Ğ = $this->db->insertAll($d´Àßñ¹–¾, $eåõ¡½«ä, $dêš×¢Òî); } else { $this->startTrans(); foreach ($d´Àßñ¹–¾ as $cù®‹Åñ¨ö => $A‡¬íì—) { $Cï¥‰ÅÕ‘Ğ = $this->db->insert($A‡¬íì—, $eåõ¡½«ä, $dêš×¢Òî); } $this->commit(); } if (!1 !== $Cï¥‰ÅÕ‘Ğ) { $cÔçÔØğµŒ = $this->getLastInsID(); if ($cÔçÔØğµŒ) { return $cÔçÔØğµŒ; } } goto fĞ”œ¡×†˜; d£áƒÁÕ¸¾: $c‡ô¿—‹ÌÖ =& $_SERVER[©äõ½¡]; if (empty($d´Àßñ¹–¾)) { $this->error = think_lang($c‡ô¿—‹ÌÖ[269]); return !1; } $eåõ¡½«ä = $this->_parseOptions($eåõ¡½«ä); goto EõŒóÜÑÃë; fĞ”œ¡×†˜: return $Cï¥‰ÅÕ‘Ğ; goto Dá°‰£—È­; Dá°‰£—È­: } public function selectAdd($AÁ–ğâÊŸ° = '', $AÜ£‰ğšÁ… = '', $F³ùÉŞº = array()) { $C³ñŸÒŠ¦ =& $_SERVER[©äõ½¡]; $F³ùÉŞº = $this->_parseOptions($F³ùÉŞº); if (!1 === ($F¼Ê¨œ¸ = $this->db->selectInsert($AÁ–ğâÊŸ° ? $AÁ–ğâÊŸ° : $F³ùÉŞº[$C³ñŸÒŠ¦[271]], $AÜ£‰ğšÁ… ? $AÜ£‰ğšÁ… : $this->getTableName(), $F³ùÉŞº))) { $this->error = think_lang($C³ñŸÒŠ¦[272]); return !1; } else { return $F¼Ê¨œ¸; } } public function save($A¶Ÿ§Á¹•· = '', $f‚¶‚ÇŞ· = array()) { goto b›×º¡¦åî; b›×º¡¦åî: $fˆÈñ¯÷Æ =& $_SERVER[©äõ½¡]; if (empty($A¶Ÿ§Á¹•·)) { if (!empty($this->data)) { $A¶Ÿ§Á¹•· = $this->data; $this->data = array(); } else { $this->error = think_lang($fˆÈñ¯÷Æ[269]); return !1; } } $A¶Ÿ§Á¹•· = $this->_facade($A¶Ÿ§Á¹•·); goto e¨±ÔƒÄî£; C¼ù»šš¼Ò: if (!1 !== $Aæ‹Ê‡¡ğ) { if (isset($C¯ß¸Ü¯Ç†)) { $A¶Ÿ§Á¹•·[$Cß½çÀ¡¾’] = $C¯ß¸Ü¯Ç†; } $this->_afterUpdate($A¶Ÿ§Á¹•·, $f‚¶‚ÇŞ·); } return $Aæ‹Ê‡¡ğ; goto B¤÷º­®Œì; aéÀª•Öƒ: if (is_array($f‚¶‚ÇŞ·[$fˆÈñ¯÷Æ[273]]) && isset($f‚¶‚ÇŞ·[$fˆÈñ¯÷Æ[273]][$Cß½çÀ¡¾’])) { $C¯ß¸Ü¯Ç† = $f‚¶‚ÇŞ·[$fˆÈñ¯÷Æ[273]][$Cß½çÀ¡¾’]; } if (!1 === $this->_beforeUpdate($A¶Ÿ§Á¹•·, $f‚¶‚ÇŞ·)) { return !1; } $Aæ‹Ê‡¡ğ = $this->db->update($A¶Ÿ§Á¹•·, $f‚¶‚ÇŞ·); goto C¼ù»šš¼Ò; e¨±ÔƒÄî£: $f‚¶‚ÇŞ· = $this->_parseOptions($f‚¶‚ÇŞ·); $Cß½çÀ¡¾’ = $this->getPk(); if (!isset($f‚¶‚ÇŞ·[$fˆÈñ¯÷Æ[273]])) { if (isset($A¶Ÿ§Á¹•·[$Cß½çÀ¡¾’])) { $Fµ×¤’–İá[$Cß½çÀ¡¾’] = $A¶Ÿ§Á¹•·[$Cß½çÀ¡¾’]; $f‚¶‚ÇŞ·[$fˆÈñ¯÷Æ[273]] = $Fµ×¤’–İá; unset($A¶Ÿ§Á¹•·[$Cß½çÀ¡¾’]); } else { $this->error = think_lang($fˆÈñ¯÷Æ[272]); return !1; } } goto aéÀª•Öƒ; B¤÷º­®Œì: } protected function _beforeUpdate(&$c»Ş¢Ó÷î†, $BÏªòÍÂÚ) { } protected function _afterUpdate($f®¢ÇÒ, $Aøªˆİ½Òƒ) { } public function delete($fëÏŸ²öô = array()) { goto b£÷ìğøƒ¼; b£÷ìğøƒ¼: $Bê¾ƒÆé =& $_SERVER[©äõ½¡]; if (empty($fëÏŸ²öô) && empty($this->options[$Bê¾ƒÆé[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $b§âïß³ÑÃ = $this->getPk(); goto Då‡çÃÚŸ; Då‡çÃÚŸ: if (is_numeric($fëÏŸ²öô) || is_string($fëÏŸ²öô)) { if (strpos($fëÏŸ²öô, $Bê¾ƒÆé[47])) { $CÁÈ‡ŸÜ‡[$b§âïß³ÑÃ] = array($Bê¾ƒÆé[274], $fëÏŸ²öô); } else { $CÁÈ‡ŸÜ‡[$b§âïß³ÑÃ] = $fëÏŸ²öô; } $this->options[$Bê¾ƒÆé[273]] = $CÁÈ‡ŸÜ‡; } $fëÏŸ²öô = $this->_parseOptions(); if (is_array($fëÏŸ²öô[$Bê¾ƒÆé[273]]) && isset($fëÏŸ²öô[$Bê¾ƒÆé[273]][$b§âïß³ÑÃ])) { $Bè‚–ïÈæÎ = $fëÏŸ²öô[$Bê¾ƒÆé[273]][$b§âïß³ÑÃ]; } goto e„ëŠÛÈÌ³; e„ëŠÛÈÌ³: $C„÷ÊÒí‰ = $this->db->delete($fëÏŸ²öô); if (!1 !== $C„÷ÊÒí‰) { $a­»‚ˆÀ¢ = array(); if (isset($Bè‚–ïÈæÎ)) { $a­»‚ˆÀ¢[$b§âïß³ÑÃ] = $Bè‚–ïÈæÎ; } $this->_after_delete($a­»‚ˆÀ¢, $fëÏŸ²öô); } return $C„÷ÊÒí‰; goto còÚµ¨ÂË…; còÚµ¨ÂË…: } protected function _after_delete($c¦òçÎòÍË, $b¸šÑÇ×³®) { } public function select($fÃÆ‹¤†Ï© = array()) { goto D’ñ¶†‘Ó‡; A›œ¨‚ÍÎ: $this->_afterSelect($eÜä•Ï£Û„, $fÃÆ‹¤†Ï©); return $eÜä•Ï£Û„; goto ešĞ™Ìç‚«; bÎÂê‹äš: $eÜä•Ï£Û„ = $this->db->select($fÃÆ‹¤†Ï©); if (!1 === $eÜä•Ï£Û„) { return !1; } if (empty($eÜä•Ï£Û„)) { return null; } goto A›œ¨‚ÍÎ; D’ñ¶†‘Ó‡: $A¸¬ñ²õ‰Ğ =& $_SERVER[©äõ½¡]; if (is_string($fÃÆ‹¤†Ï©) || is_numeric($fÃÆ‹¤†Ï©)) { $D¶¯—­„ = $this->getPk(); if (strpos($fÃÆ‹¤†Ï©, $A¸¬ñ²õ‰Ğ[47])) { $E±¥±Øƒªá[$D¶¯—­„] = array($A¸¬ñ²õ‰Ğ[274], $fÃÆ‹¤†Ï©); } else { $E±¥±Øƒªá[$D¶¯—­„] = $fÃÆ‹¤†Ï©; } $this->options[$A¸¬ñ²õ‰Ğ[273]] = $E±¥±Øƒªá; } elseif (!1 === $fÃÆ‹¤†Ï©) { $fÃÆ‹¤†Ï© = $this->_parseOptions(); return $A¸¬ñ²õ‰Ğ[275] . $this->db->buildSelectSql($fÃÆ‹¤†Ï©) . $A¸¬ñ²õ‰Ğ[276]; } $fÃÆ‹¤†Ï© = $this->_parseOptions(); goto bÎÂê‹äš; ešĞ™Ìç‚«: } protected function _afterSelect(&$e¸ÓœÃ‰áÇ, $E¸…¸šµâÏ) { } public function buildSql($DÔá…ø‚Æ = array()) { $C”Ç¡¥÷æ‡ =& $_SERVER[©äõ½¡]; $DÔá…ø‚Æ = $this->_parseOptions($DÔá…ø‚Æ); return $C”Ç¡¥÷æ‡[275] . $this->db->buildSelectSql($DÔá…ø‚Æ) . $C”Ç¡¥÷æ‡[276]; } public function optionsValue($Aİ—¾œšÁº = null) { if (is_null($Aİ—¾œšÁº)) { return $this->options; } elseif (is_array($Aİ—¾œšÁº)) { $this->options = array_merge($this->options, $Aİ—¾œšÁº); } } protected function _parseOptions($dÚŠãÅå÷Ù = array()) { goto cä½éæùç¬; Dö»Úªòİ: if (!isset($dÚŠãÅå÷Ù[$D½ñ§•Àí[277]])) { $dÚŠãÅå÷Ù[$D½ñ§•Àí[277]] = $this->getTableName(); $fèê„Øï†¤ = $this->fields; } else { $fèê„Øï†¤ = $this->getDbFields(); } if (!empty($dÚŠãÅå÷Ù[$D½ñ§•Àí[278]])) { $dÚŠãÅå÷Ù[$D½ñ§•Àí[277]] .= $D½ñ§•Àí[50] . $dÚŠãÅå÷Ù[$D½ñ§•Àí[278]]; } $dÚŠãÅå÷Ù[$D½ñ§•Àí[279]] = $this->name; goto cÌ­ŠåÆĞã; cä½éæùç¬: $D½ñ§•Àí =& $_SERVER[©äõ½¡]; if (is_array($dÚŠãÅå÷Ù)) { $dÚŠãÅå÷Ù = array_merge($this->options, $dÚŠãÅå÷Ù); } $this->options = array(); goto Dö»Úªòİ; cÌ­ŠåÆĞã: if (isset($dÚŠãÅå÷Ù[$D½ñ§•Àí[273]]) && is_array($dÚŠãÅå÷Ù[$D½ñ§•Àí[273]]) && !empty($fèê„Øï†¤) && !isset($dÚŠãÅå÷Ù[$D½ñ§•Àí[280]]) && !isset($dÚŠãÅå÷Ù[$D½ñ§•Àí[277]])) { foreach ($dÚŠãÅå÷Ù[$D½ñ§•Àí[273]] as $c¼¢à–‚î› => $fŸæ‰÷ë†) { $c¼¢à–‚î› = trim($c¼¢à–‚î›); if (in_array($c¼¢à–‚î›, $fèê„Øï†¤, !0)) { if (is_scalar($fŸæ‰÷ë†)) { $this->_parseType($dÚŠãÅå÷Ù[$D½ñ§•Àí[273]], $c¼¢à–‚î›); } } elseif (!is_numeric($c¼¢à–‚î›) && $D½ñ§•Àí[71] != substr($c¼¢à–‚î›, 0, 1) && !1 === strpos($c¼¢à–‚î›, $D½ñ§•Àí[95]) && !1 === strpos($c¼¢à–‚î›, $D½ñ§•Àí[258]) && !1 === strpos($c¼¢à–‚î›, $D½ñ§•Àí[281]) && !1 === strpos($c¼¢à–‚î›, $D½ñ§•Àí[282])) { unset($dÚŠãÅå÷Ù[$D½ñ§•Àí[273]][$c¼¢à–‚î›]); } } } $this->_options_filter($dÚŠãÅå÷Ù); return $dÚŠãÅå÷Ù; goto DÉéØ‚©ä; DÉéØ‚©ä: } protected function _options_filter(&$bò¨‰ ²ë„) { } protected function _parseType(&$D‡âÆ³¥­, $A¶Úò±ª‘ª) { $Fš†ŠÉ–Ü‚ =& $_SERVER[©äõ½¡]; if (empty($this->options[$Fš†ŠÉ–Ü‚[283]][$Fš†ŠÉ–Ü‚[4] . $A¶Úò±ª‘ª])) { $E¯ˆé“êÇÃ = strtolower($this->fields[$Fš†ŠÉ–Ü‚[250]][$A¶Úò±ª‘ª]); if (!1 !== strpos($E¯ˆé“êÇÃ, $Fš†ŠÉ–Ü‚[284])) { } elseif (!1 === strpos($E¯ˆé“êÇÃ, $Fš†ŠÉ–Ü‚[285]) && !1 !== strpos($E¯ˆé“êÇÃ, $Fš†ŠÉ–Ü‚[286])) { $D‡âÆ³¥­[$A¶Úò±ª‘ª] = intval($D‡âÆ³¥­[$A¶Úò±ª‘ª]); } elseif (!1 !== strpos($E¯ˆé“êÇÃ, $Fš†ŠÉ–Ü‚[287]) || !1 !== strpos($E¯ˆé“êÇÃ, $Fš†ŠÉ–Ü‚[288])) { $D‡âÆ³¥­[$A¶Úò±ª‘ª] = floatval($D‡âÆ³¥­[$A¶Úò±ª‘ª]); } elseif (!1 !== strpos($E¯ˆé“êÇÃ, $Fš†ŠÉ–Ü‚[289])) { $D‡âÆ³¥­[$A¶Úò±ª‘ª] = (bool) $D‡âÆ³¥­[$A¶Úò±ª‘ª]; } } } public function find($a¼è”ŞÑ¬ë = array()) { goto B’ˆŠôõÈá; BÀÅÒ©ÈÍ: if (!empty($this->options[$cä…ÙÄé¾[291]])) { return $this->returnResult($this->data, $this->options[$cä…ÙÄé¾[291]]); } return $this->data; goto e¦ª•¾ÅØˆ; A„¶èÆÖïÎ: if (empty($f°…¤Ë×¶Ö)) { return null; } $this->data = $f°…¤Ë×¶Ö[0]; $this->_afterFind($this->data, $a¼è”ŞÑ¬ë); goto BÀÅÒ©ÈÍ; DàÂğ…åö: $a¼è”ŞÑ¬ë = $this->_parseOptions(); $f°…¤Ë×¶Ö = $this->db->select($a¼è”ŞÑ¬ë); if (!1 === $f°…¤Ë×¶Ö) { return !1; } goto A„¶èÆÖïÎ; B’ˆŠôõÈá: $cä…ÙÄé¾ =& $_SERVER[©äõ½¡]; if (is_numeric($a¼è”ŞÑ¬ë) || is_string($a¼è”ŞÑ¬ë)) { $bÓ¿ãŸ¯µ°[$this->getPk()] = intval($a¼è”ŞÑ¬ë); $this->options[$cä…ÙÄé¾[273]] = $bÓ¿ãŸ¯µ°; } $this->options[$cä…ÙÄé¾[290]] = 1; goto DàÂğ…åö; e¦ª•¾ÅØˆ: } protected function _afterFind(&$F’œÃÚâô, $aÓœÁšäš) { } protected function returnResult($B¼ÃèæÈ‚, $d²”Ï’àôë = '') { $a•ñÎÈ”Ô =& $_SERVER[©äõ½¡]; if ($d²”Ï’àôë) { if (is_callable($d²”Ï’àôë)) { return call_user_func($d²”Ï’àôë, $B¼ÃèæÈ‚); } switch (strtolower($d²”Ï’àôë)) { case $a•ñÎÈ”Ô[292]: return json_encode($B¼ÃèæÈ‚); case $a•ñÎÈ”Ô[293]: return xml_encode($B¼ÃèæÈ‚); } } return $B¼ÃèæÈ‚; } public function parseFieldsMap($f‡ğÈÍ¦ˆ, $b‡›ö°êï™ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $a»„Í¾”ËÓ => $a©ÓºÍŒŒ) { if ($b‡›ö°êï™ == 1) { if (isset($f‡ğÈÍ¦ˆ[$a©ÓºÍŒŒ])) { $f‡ğÈÍ¦ˆ[$a»„Í¾”ËÓ] = $f‡ğÈÍ¦ˆ[$a©ÓºÍŒŒ]; unset($f‡ğÈÍ¦ˆ[$a©ÓºÍŒŒ]); } } else { if (isset($f‡ğÈÍ¦ˆ[$a»„Í¾”ËÓ])) { $f‡ğÈÍ¦ˆ[$a©ÓºÍŒŒ] = $f‡ğÈÍ¦ˆ[$a»„Í¾”ËÓ]; unset($f‡ğÈÍ¦ˆ[$a»„Í¾”ËÓ]); } } } } return $f‡ğÈÍ¦ˆ; } public function setField($C¡éİ«‰¬å, $F¡ªŠÇ­Ø = '') { if (is_array($C¡éİ«‰¬å)) { $aõÂøÖª¼¶ = $C¡éİ«‰¬å; } else { $aõÂøÖª¼¶[$C¡éİ«‰¬å] = $F¡ªŠÇ­Ø; } return $this->save($aõÂøÖª¼¶); } public function setAdd($DôùéÍÑÅÎ, $a®‰»©Ÿ– = 1) { $Cƒ‰Äé‚Ñ” =& $_SERVER[©äõ½¡]; $DõÙÎ—ª = $DôùéÍÑÅÎ . $Cƒ‰Äé‚Ñ”[294] . $a®‰»©Ÿ–; if ($a®‰»©Ÿ– < 0) { $DõÙÎ—ª = $DôùéÍÑÅÎ . $a®‰»©Ÿ–; } return $this->setField($DôùéÍÑÅÎ, array($Cƒ‰Äé‚Ñ”[295], $DõÙÎ—ª)); } public function getField($dŞîÌ¬İ‘, $eö§óâƒ‡× = null) { $fÊù¢öã§õ =& $_SERVER[©äõ½¡]; $d×˜Ú¤°•[$fÊù¢öã§õ[271]] = $dŞîÌ¬İ‘; $d×˜Ú¤°• = $this->_parseOptions($d×˜Ú¤°•); $dŞîÌ¬İ‘ = trim($dŞîÌ¬İ‘); if (strpos($dŞîÌ¬İ‘, $fÊù¢öã§õ[47])) { if (!isset($d×˜Ú¤°•[$fÊù¢öã§õ[290]])) { $d×˜Ú¤°•[$fÊù¢öã§õ[290]] = is_numeric($eö§óâƒ‡×) ? $eö§óâƒ‡× : $fÊù¢öã§õ[33]; } $Aö²‚Ó°À = $this->db->select($d×˜Ú¤°•); if (!empty($Aö²‚Ó°À)) { goto bÃó’‘Ï…Æ; bÜ¼ß’Ê¯ø: foreach ($Aö²‚Ó°À as $Dƒ¢ Êø¬¬) { $fÛ÷¥›¾† = $Dƒ¢ Êø¬¬[$fÛ¦Á¯›°Ÿ]; if (2 == $FÕ¼‘ñ­—ä) { $c‘ìˆá×å×[$fÛ÷¥›¾†] = $Dƒ¢ Êø¬¬[$bŒÂİË“îÈ]; } else { $c‘ìˆá×å×[$fÛ÷¥›¾†] = is_string($eö§óâƒ‡×) ? implode($eö§óâƒ‡×, $Dƒ¢ Êø¬¬) : $Dƒ¢ Êø¬¬; } } return $c‘ìˆá×å×; goto B•ƒÎãŞã; eˆÁ··ÌœÆ: $bŒÂİË“îÈ = array_shift($dŞîÌ¬İ‘); $c‘ìˆá×å× = array(); $FÕ¼‘ñ­—ä = count($BÂÍ°ãøÜ§); goto bÜ¼ß’Ê¯ø; bÃó’‘Ï…Æ: $BÂÍ°ãøÜ§ = explode($fÊù¢öã§õ[47], $dŞîÌ¬İ‘); $dŞîÌ¬İ‘ = array_keys($Aö²‚Ó°À[0]); $fÛ¦Á¯›°Ÿ = array_shift($dŞîÌ¬İ‘); goto eˆÁ··ÌœÆ; B•ƒÎãŞã: } } else { if (!0 !== $eö§óâƒ‡×) { $d×˜Ú¤°•[$fÊù¢öã§õ[290]] = is_numeric($eö§óâƒ‡×) ? $eö§óâƒ‡× : 1; } if ($eö§óâƒ‡× === $fÊù¢öã§õ[253]) { unset($d×˜Ú¤°•[$fÊù¢öã§õ[290]]); } $Dƒ¢ Êø¬¬ = $this->db->select($d×˜Ú¤°•); if (!empty($Dƒ¢ Êø¬¬)) { if ($eö§óâƒ‡× === $fÊù¢öã§õ[253]) { return reset($Dƒ¢ Êø¬¬[0]); } if (!0 !== $eö§óâƒ‡× && 1 == $d×˜Ú¤°•[$fÊù¢öã§õ[290]]) { return reset($Dƒ¢ Êø¬¬[0]); } foreach ($Dƒ¢ Êø¬¬ as $eå¯Ğ˜¾¥İ) { $dŒòƒ÷ŒŸ[] = $eå¯Ğ˜¾¥İ[$dŞîÌ¬İ‘]; } return $dŒòƒ÷ŒŸ; } } return null; } public function create($cÀæâ‡©ÂŞ = '', $E÷˜âë¦Ï§ = '') { goto Aß­½›Ä²‡; f¼ƒ»µÕå¬: return $cÀæâ‡©ÂŞ; goto dƒ·©°Û÷; Aß­½›Ä²‡: $B—ÉÓ‰ÔÌ³ =& $_SERVER[©äõ½¡]; if (empty($cÀæâ‡©ÂŞ)) { $cÀæâ‡©ÂŞ = $_POST; } elseif (is_object($cÀæâ‡©ÂŞ)) { $cÀæâ‡©ÂŞ = get_object_vars($cÀæâ‡©ÂŞ); } if (empty($cÀæâ‡©ÂŞ) || !is_array($cÀæâ‡©ÂŞ)) { $this->error = think_lang($B—ÉÓ‰ÔÌ³[269]); return !1; } goto B’åŒ¯ÂÍˆ; bù‰ì…äÊö: if (isset($d¾ŸŒ‡£È)) { if (is_string($d¾ŸŒ‡£È)) { $d¾ŸŒ‡£È = explode($B—ÉÓ‰ÔÌ³[47], $d¾ŸŒ‡£È); } if (think_config($B—ÉÓ‰ÔÌ³[296])) { $d¾ŸŒ‡£È[] = think_config($B—ÉÓ‰ÔÌ³[297]); } foreach ($cÀæâ‡©ÂŞ as $AÔ¶ùÆàºñ => $b„¥Ò¤õŸ) { if (!in_array($AÔ¶ùÆàºñ, $d¾ŸŒ‡£È)) { unset($cÀæâ‡©ÂŞ[$AÔ¶ùÆàºñ]); } } } if (!$this->autoValidation($cÀæâ‡©ÂŞ, $E÷˜âë¦Ï§)) { return !1; } if (!$this->autoCheckToken($cÀæâ‡©ÂŞ)) { $this->error = think_lang($B—ÉÓ‰ÔÌ³[298]); return !1; } goto dóèâ²ˆ¾; B’åŒ¯ÂÍˆ: $cÀæâ‡©ÂŞ = $this->parseFieldsMap($cÀæâ‡©ÂŞ, 0); $E÷˜âë¦Ï§ = $E÷˜âë¦Ï§ ? $E÷˜âë¦Ï§ : (!empty($cÀæâ‡©ÂŞ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$B—ÉÓ‰ÔÌ³[271]])) { $d¾ŸŒ‡£È = $this->options[$B—ÉÓ‰ÔÌ³[271]]; unset($this->options[$B—ÉÓ‰ÔÌ³[271]]); } elseif ($E÷˜âë¦Ï§ == THINK_MODEL_INSERT && isset($this->insertFields)) { $d¾ŸŒ‡£È = $this->insertFields; } elseif ($E÷˜âë¦Ï§ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $d¾ŸŒ‡£È = $this->updateFields; } goto bù‰ì…äÊö; dóèâ²ˆ¾: if ($this->autoCheckFields) { $d¾ŸŒ‡£È = $this->getDbFields(); foreach ($cÀæâ‡©ÂŞ as $AÔ¶ùÆàºñ => $b„¥Ò¤õŸ) { if (!in_array($AÔ¶ùÆàºñ, $d¾ŸŒ‡£È)) { unset($cÀæâ‡©ÂŞ[$AÔ¶ùÆàºñ]); } elseif (MAGIC_QUOTES_GPC && is_string($b„¥Ò¤õŸ)) { $cÀæâ‡©ÂŞ[$AÔ¶ùÆàºñ] = stripslashes($b„¥Ò¤õŸ); } } } $this->autoOperation($cÀæâ‡©ÂŞ, $E÷˜âë¦Ï§); $this->data = $cÀæâ‡©ÂŞ; goto f¼ƒ»µÕå¬; dƒ·©°Û÷: } public function autoCheckToken($eÄµ­”È) { $c¶ƒò…Ô‘ç =& $_SERVER[©äõ½¡]; if (isset($this->options[$c¶ƒò…Ô‘ç[299]]) && !$this->options[$c¶ƒò…Ô‘ç[299]]) { return !0; } if (think_config($c¶ƒò…Ô‘ç[296])) { $C×Õ…‹Ï« = think_config($c¶ƒò…Ô‘ç[297]); if (!isset($eÄµ­”È[$C×Õ…‹Ï«]) || Session::get($C×Õ…‹Ï«)) { return !1; } list($B…š–Ë³Ê‚, $EÑ‹ˆñÎ´â) = explode($c¶ƒò…Ô‘ç[71], $eÄµ­”È[$C×Õ…‹Ï«]); if ($EÑ‹ˆñÎ´â && Session::get($C×Õ…‹Ï« . $c¶ƒò…Ô‘ç[95] . $B…š–Ë³Ê‚) === $EÑ‹ˆñÎ´â) { Session::remove($C×Õ…‹Ï« . $c¶ƒò…Ô‘ç[95] . $B…š–Ë³Ê‚); return !0; } if (think_config($c¶ƒò…Ô‘ç[300])) { Session::remove($C×Õ…‹Ï« . $c¶ƒò…Ô‘ç[95] . $B…š–Ë³Ê‚); } return !1; } return !0; } public function regex($f­±Ó™’¬, $FÄÛ…ïª) { $eåˆÂ¢¬òö =& $_SERVER[©äõ½¡]; $cÌ¹âÜç†“ = array($eåˆÂ¢¬òö[301] => $eåˆÂ¢¬òö[302], $eåˆÂ¢¬òö[303] => $eåˆÂ¢¬òö[304], $eåˆÂ¢¬òö[305] => $eåˆÂ¢¬òö[306], $eåˆÂ¢¬òö[307] => $eåˆÂ¢¬òö[308], $eåˆÂ¢¬òö[309] => $eåˆÂ¢¬òö[310], $eåˆÂ¢¬òö[311] => $eåˆÂ¢¬òö[312], $eåˆÂ¢¬òö[313] => $eåˆÂ¢¬òö[314], $eåˆÂ¢¬òö[288] => $eåˆÂ¢¬òö[315], $eåˆÂ¢¬òö[316] => $eåˆÂ¢¬òö[317]); if (isset($cÌ¹âÜç†“[strtolower($FÄÛ…ïª)])) { $FÄÛ…ïª = $cÌ¹âÜç†“[strtolower($FÄÛ…ïª)]; } return preg_match($FÄÛ…ïª, $f­±Ó™’¬) === 1; } private function autoOperation(&$D–¾§Áê‡­, $dë§Ú—µ§) { $dó»‡‡ç¦ã =& $_SERVER[©äõ½¡]; if (!empty($this->options[$dó»‡‡ç¦ã[318]])) { $AÖ½×½‘Ë¨ = $this->options[$dó»‡‡ç¦ã[318]]; unset($this->options[$dó»‡‡ç¦ã[318]]); } elseif (!empty($this->_auto)) { $AÖ½×½‘Ë¨ = $this->_auto; } if (isset($AÖ½×½‘Ë¨)) { foreach ($AÖ½×½‘Ë¨ as $bÈµ‰‡¼Ù¹) { if (empty($bÈµ‰‡¼Ù¹[2])) { $bÈµ‰‡¼Ù¹[2] = THINK_MODEL_INSERT; } if ($dë§Ú—µ§ == $bÈµ‰‡¼Ù¹[2] || $bÈµ‰‡¼Ù¹[2] == THINK_MODEL_BOTH) { switch (trim($bÈµ‰‡¼Ù¹[3])) { case $dó»‡‡ç¦ã[319]: case $dó»‡‡ç¦ã[320]: $EÃê±“Ü¢ï = isset($bÈµ‰‡¼Ù¹[4]) ? (array) $bÈµ‰‡¼Ù¹[4] : array(); if (isset($D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]])) { array_unshift($EÃê±“Ü¢ï, $D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]]); } if ($dó»‡‡ç¦ã[319] == $bÈµ‰‡¼Ù¹[3]) { $D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]] = call_user_func_array($bÈµ‰‡¼Ù¹[1], $EÃê±“Ü¢ï); } else { $D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]] = call_user_func_array(array(&$this, $bÈµ‰‡¼Ù¹[1]), $EÃê±“Ü¢ï); } break; case $dó»‡‡ç¦ã[271]: $D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]] = $D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[1]]; break; case $dó»‡‡ç¦ã[321]: if ($dó»‡‡ç¦ã[33] === $D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]]) { unset($D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]]); } break; case $dó»‡‡ç¦ã[322]: default: $D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]] = $bÈµ‰‡¼Ù¹[1]; } if (!1 === $D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]]) { unset($D–¾§Áê‡­[$bÈµ‰‡¼Ù¹[0]]); } } } } return $D–¾§Áê‡­; } protected function autoValidation($föğ­¾Ş, $d’¨ø¥¯Ô‹) { $D¦âĞ İ‰ë =& $_SERVER[©äõ½¡]; if (!empty($this->options[$D¦âĞ İ‰ë[323]])) { $BğÃ…Å„ìÀ = $this->options[$D¦âĞ İ‰ë[323]]; unset($this->options[$D¦âĞ İ‰ë[323]]); } elseif (!empty($this->_validate)) { $BğÃ…Å„ìÀ = $this->_validate; } if (isset($BğÃ…Å„ìÀ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($BğÃ…Å„ìÀ as $FâÆÌ¹çŞ¹ => $c‚¼¸øôš‹) { if (empty($c‚¼¸øôš‹[5]) || $c‚¼¸øôš‹[5] == THINK_MODEL_BOTH || $c‚¼¸øôš‹[5] == $d’¨ø¥¯Ô‹) { if (0 == strpos($c‚¼¸øôš‹[2], $D¦âĞ İ‰ë[324]) && strpos($c‚¼¸øôš‹[2], $D¦âĞ İ‰ë[325])) { $c‚¼¸øôš‹[2] = think_lang(substr($c‚¼¸øôš‹[2], 2, -1)); } $c‚¼¸øôš‹[3] = isset($c‚¼¸øôš‹[3]) ? $c‚¼¸øôš‹[3] : THINK_EXISTS_VALIDATE; $c‚¼¸øôš‹[4] = isset($c‚¼¸øôš‹[4]) ? $c‚¼¸øôš‹[4] : $D¦âĞ İ‰ë[326]; switch ($c‚¼¸øôš‹[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($föğ­¾Ş, $c‚¼¸øôš‹)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($D¦âĞ İ‰ë[33] != trim($föğ­¾Ş[$c‚¼¸øôš‹[0]])) { if (!1 === $this->_validationField($föğ­¾Ş, $c‚¼¸øôš‹)) { return !1; } } break; default: if (isset($föğ­¾Ş[$c‚¼¸øôš‹[0]])) { if (!1 === $this->_validationField($föğ­¾Ş, $c‚¼¸øôš‹)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($B°­‡Ù¶³…, $C¦œõæªÀ‘) { if (!1 === $this->_validationFieldItem($B°­‡Ù¶³…, $C¦œõæªÀ‘)) { if ($this->patchValidate) { $this->error[$C¦œõæªÀ‘[0]] = $C¦œõæªÀ‘[2]; } else { $this->error = $C¦œõæªÀ‘[2]; return !1; } } return; } protected function _validationFieldItem($CÉ˜ÔÏ”ğ˜, $F¶èÊùëºÜ) { $C‰©‰Î¶ÁÛ =& $_SERVER[©äõ½¡]; switch (strtolower(trim($F¶èÊùëºÜ[4]))) { case $C‰©‰Î¶ÁÛ[319]: case $C‰©‰Î¶ÁÛ[320]: $Dš×œ˜ğ—² = isset($F¶èÊùëºÜ[6]) ? (array) $F¶èÊùëºÜ[6] : array(); if (is_string($F¶èÊùëºÜ[0]) && strpos($F¶èÊùëºÜ[0], $C‰©‰Î¶ÁÛ[47])) { $F¶èÊùëºÜ[0] = explode($C‰©‰Î¶ÁÛ[47], $F¶èÊùëºÜ[0]); } if (is_array($F¶èÊùëºÜ[0])) { foreach ($F¶èÊùëºÜ[0] as $aÜ‰ù¢˜À) { $bË¢¢£öÏ¼[$aÜ‰ù¢˜À] = $CÉ˜ÔÏ”ğ˜[$aÜ‰ù¢˜À]; } array_unshift($Dš×œ˜ğ—², $bË¢¢£öÏ¼); } else { array_unshift($Dš×œ˜ğ—², $CÉ˜ÔÏ”ğ˜[$F¶èÊùëºÜ[0]]); } if ($C‰©‰Î¶ÁÛ[319] == $F¶èÊùëºÜ[4]) { return call_user_func_array($F¶èÊùëºÜ[1], $Dš×œ˜ğ—²); } else { return call_user_func_array(array(&$this, $F¶èÊùëºÜ[1]), $Dš×œ˜ğ—²); } case $C‰©‰Î¶ÁÛ[327]: return $CÉ˜ÔÏ”ğ˜[$F¶èÊùëºÜ[0]] == $CÉ˜ÔÏ”ğ˜[$F¶èÊùëºÜ[1]]; case $C‰©‰Î¶ÁÛ[328]: if (is_string($F¶èÊùëºÜ[0]) && strpos($F¶èÊùëºÜ[0], $C‰©‰Î¶ÁÛ[47])) { $F¶èÊùëºÜ[0] = explode($C‰©‰Î¶ÁÛ[47], $F¶èÊùëºÜ[0]); } $b²ÊØäŸÄË = array(); if (is_array($F¶èÊùëºÜ[0])) { foreach ($F¶èÊùëºÜ[0] as $aÜ‰ù¢˜À) { $b²ÊØäŸÄË[$aÜ‰ù¢˜À] = $CÉ˜ÔÏ”ğ˜[$aÜ‰ù¢˜À]; } } else { $b²ÊØäŸÄË[$F¶èÊùëºÜ[0]] = $CÉ˜ÔÏ”ğ˜[$F¶èÊùëºÜ[0]]; } if (!empty($CÉ˜ÔÏ”ğ˜[$this->getPk()])) { $b²ÊØäŸÄË[$this->getPk()] = array($C‰©‰Î¶ÁÛ[329], $CÉ˜ÔÏ”ğ˜[$this->getPk()]); } if ($this->where($b²ÊØäŸÄË)->find()) { return !1; } return !0; default: return $this->check($CÉ˜ÔÏ”ğ˜[$F¶èÊùëºÜ[0]], $F¶èÊùëºÜ[1], $F¶èÊùëºÜ[4]); } } public function check($C‰Ï¯¯ÔÍ˜, $cŸöèÊ¦äŠ, $f¥¨™ñù– = "\162\145\147\x65\170") { $eäøÛŸ£ß³ =& $_SERVER[©äõ½¡]; $f¥¨™ñù– = strtolower(trim($f¥¨™ñù–)); switch ($f¥¨™ñù–) { case $eäøÛŸ£ß³[7]: case $eäøÛŸ£ß³[330]: $cŸø¿¹ó« = is_array($cŸöèÊ¦äŠ) ? $cŸöèÊ¦äŠ : explode($eäøÛŸ£ß³[47], $cŸöèÊ¦äŠ); return $f¥¨™ñù– == $eäøÛŸ£ß³[7] ? in_array($C‰Ï¯¯ÔÍ˜, $cŸø¿¹ó«) : !in_array($C‰Ï¯¯ÔÍ˜, $cŸø¿¹ó«); case $eäøÛŸ£ß³[331]: case $eäøÛŸ£ß³[332]: if (is_array($cŸöèÊ¦äŠ)) { $D›œ…“§Ñà = $cŸöèÊ¦äŠ[0]; $eÎöæø¹šç = $cŸöèÊ¦äŠ[1]; } else { list($D›œ…“§Ñà, $eÎöæø¹šç) = explode($eäøÛŸ£ß³[47], $cŸöèÊ¦äŠ); } return $f¥¨™ñù– == $eäøÛŸ£ß³[331] ? $C‰Ï¯¯ÔÍ˜ >= $D›œ…“§Ñà && $C‰Ï¯¯ÔÍ˜ <= $eÎöæø¹šç : $C‰Ï¯¯ÔÍ˜ < $D›œ…“§Ñà || $C‰Ï¯¯ÔÍ˜ > $eÎöæø¹šç; case $eäøÛŸ£ß³[333]: case $eäøÛŸ£ß³[334]: return $f¥¨™ñù– == $eäøÛŸ£ß³[333] ? $C‰Ï¯¯ÔÍ˜ == $cŸöèÊ¦äŠ : $C‰Ï¯¯ÔÍ˜ != $cŸöèÊ¦äŠ; case $eäøÛŸ£ß³[335]: $fÁ‰ç±·æá = mb_strlen($C‰Ï¯¯ÔÍ˜, $eäøÛŸ£ß³[336]); if (strpos($cŸöèÊ¦äŠ, $eäøÛŸ£ß³[47])) { list($D›œ…“§Ñà, $eÎöæø¹šç) = explode($eäøÛŸ£ß³[47], $cŸöèÊ¦äŠ); return $fÁ‰ç±·æá >= $D›œ…“§Ñà && $fÁ‰ç±·æá <= $eÎöæø¹šç; } else { return $fÁ‰ç±·æá == $cŸöèÊ¦äŠ; } case $eäøÛŸ£ß³[337]: list($aÚŒîã…‹, $fãÁìÓ†ƒ¸) = explode($eäøÛŸ£ß³[47], $cŸöèÊ¦äŠ); if (!is_numeric($aÚŒîã…‹)) { $aÚŒîã…‹ = strtotime($aÚŒîã…‹); } if (!is_numeric($fãÁìÓ†ƒ¸)) { $fãÁìÓ†ƒ¸ = strtotime($fãÁìÓ†ƒ¸); } return NOW_TIME >= $aÚŒîã…‹ && NOW_TIME <= $fãÁìÓ†ƒ¸; case $eäøÛŸ£ß³[338]: return in_array(get_client_ip(), explode($eäøÛŸ£ß³[47], $cŸöèÊ¦äŠ)); case $eäøÛŸ£ß³[339]: return !in_array(get_client_ip(), explode($eäøÛŸ£ß³[47], $cŸöèÊ¦äŠ)); case $eäøÛŸ£ß³[326]: default: return $this->regex($C‰Ï¯¯ÔÍ˜, $cŸöèÊ¦äŠ); } } public function query($aÃÂ×‘Ö®ª, $DíÑëÎé§Õ = false) { $BÈì¬‹ö” =& $_SERVER[©äõ½¡]; if (!is_bool($DíÑëÎé§Õ) && !is_array($DíÑëÎé§Õ)) { $DíÑëÎé§Õ = func_get_args(); array_shift($DíÑëÎé§Õ); } $aÃÂ×‘Ö®ª = str_replace(array($BÈì¬‹ö”[229], $BÈì¬‹ö”[340]), $BÈì¬‹ö”[50], $aÃÂ×‘Ö®ª); $aÃÂ×‘Ö®ª = $this->parseSql($aÃÂ×‘Ö®ª, $DíÑëÎé§Õ); return $this->db->query($aÃÂ×‘Ö®ª); } public function execute($d”œĞ¥Ùµ, $a×æ‘ãÂ·¼ = false) { if (!is_bool($a×æ‘ãÂ·¼) && !is_array($a×æ‘ãÂ·¼)) { $a×æ‘ãÂ·¼ = func_get_args(); array_shift($a×æ‘ãÂ·¼); } $d”œĞ¥Ùµ = $this->parseSql($d”œĞ¥Ùµ, $a×æ‘ãÂ·¼); return $this->db->execute($d”œĞ¥Ùµ); } protected function parseSql($DİÌìÏÌ, $aò£çñÃ»­) { $CÉš´ŠÁ› =& $_SERVER[©äõ½¡]; if (!0 === $aò£çñÃ»­) { $fª¦Û¶±ë = $this->_parseOptions(); $DİÌìÏÌ = $this->db->parseSql($DİÌìÏÌ, $fª¦Û¶±ë); } elseif (is_array($aò£çñÃ»­)) { $aò£çñÃ»­ = array_map(array($this->db, $CÉš´ŠÁ›[341]), $aò£çñÃ»­); $DİÌìÏÌ = vsprintf($DİÌìÏÌ, $aò£çñÃ»­); } else { $DİÌìÏÌ = strtr($DİÌìÏÌ, array($CÉš´ŠÁ›[342] => $this->getTableName(), $CÉš´ŠÁ›[343] => think_config($CÉš´ŠÁ›[242]))); } $this->db->setModel($this->name); return $DİÌìÏÌ; } public function db($dÉéÔÀÂÛ = '', $a‡…§º×½á = '', $b ×ÑÎ†Ñ = array()) { goto B³ïğ«¢µÕ; D±¦â™‚æÄ: $E”‹›¥ÜÏ[$dÉéÔÀÂÛ] = $a‡…§º×½á; $this->db = $E‹Øæ‰×©¸[$dÉéÔÀÂÛ]; $this->_after_db(); goto A…Ñ•ùÙ­; B³ïğ«¢µÕ: $föÉ£Í×° =& $_SERVER[©äõ½¡]; if ($föÉ£Í×°[33] === $dÉéÔÀÂÛ && $this->db) { return $this->db; } static $E”‹›¥ÜÏ = array(); goto fóÌ Ã²ÊÕ; fóÌ Ã²ÊÕ: static $E‹Øæ‰×©¸ = array(); if (!isset($E‹Øæ‰×©¸[$dÉéÔÀÂÛ]) || isset($E‹Øæ‰×©¸[$dÉéÔÀÂÛ]) && $a‡…§º×½á && $E”‹›¥ÜÏ[$dÉéÔÀÂÛ] != $a‡…§º×½á) { if (!empty($a‡…§º×½á) && is_string($a‡…§º×½á) && !1 === strpos($a‡…§º×½á, $föÉ£Í×°[8])) { $a‡…§º×½á = think_config($a‡…§º×½á); } $E‹Øæ‰×©¸[$dÉéÔÀÂÛ] = Db::getInstance($a‡…§º×½á); } elseif (NULL === $a‡…§º×½á) { $E‹Øæ‰×©¸[$dÉéÔÀÂÛ]->close(); unset($E‹Øæ‰×©¸[$dÉéÔÀÂÛ]); return; } if (!empty($b ×ÑÎ†Ñ)) { if (is_string($b ×ÑÎ†Ñ)) { parse_str($b ×ÑÎ†Ñ, $b ×ÑÎ†Ñ); } foreach ($b ×ÑÎ†Ñ as $c¦‘Ùğì‡ˆ => $a¹ÁŠŞÈ±Â) { $this->setProperty($c¦‘Ùğì‡ˆ, $a¹ÁŠŞÈ±Â); } } goto D±¦â™‚æÄ; A…Ñ•ùÙ­: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto E­˜¦Ã¯Ş; E­˜¦Ã¯Ş: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $b—¶²Ó†® = get_class($this); if ($b—¶²Ó†® == $_SERVER[©äõ½¡][344]) { return $this->name; } $this->name = substr($b—¶²Ó†®, 0, -5); } return $this->name; } public function getTableName() { $aÃÙ·…‡ =& $_SERVER[©äõ½¡]; if (empty($this->trueTableName)) { $E±Š¾’ïø£ = !empty($this->tablePrefix) ? $this->tablePrefix : $aÃÙ·…‡[33]; if (!empty($this->tableName)) { $E±Š¾’ïø£ .= $this->tableName; } else { $E±Š¾’ïø£ .= think_parse_name($this->name); } $this->trueTableName = strtolower($E±Š¾’ïø£); } return (!empty($this->dbName) ? $this->dbName . $aÃÙ·…‡[95] : $aÃÙ·…‡[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $EäÆï¯Öµ =& $_SERVER[©äõ½¡]; return isset($this->fields[$EäÆï¯Öµ[249]]) ? $this->fields[$EäÆï¯Öµ[249]] : $this->pk; } public function getDbFields() { $BéìôÅÓì =& $_SERVER[©äõ½¡]; if (isset($this->options[$BéìôÅÓì[277]])) { $e÷Øåƒ¹¿ö = $this->db->getFields($this->options[$BéìôÅÓì[277]]); return $e÷Øåƒ¹¿ö ? array_keys($e÷Øåƒ¹¿ö) : !1; } if ($this->fields) { $e÷Øåƒ¹¿ö = $this->fields; unset($e÷Øåƒ¹¿ö[$BéìôÅÓì[248]], $e÷Øåƒ¹¿ö[$BéìôÅÓì[249]], $e÷Øåƒ¹¿ö[$BéìôÅÓì[250]], $e÷Øåƒ¹¿ö[$BéìôÅÓì[247]]); return $e÷Øåƒ¹¿ö; } return !1; } public function data($aÉ¦ŠÓ³¯ = '') { $CÑ—Éñ¸¼µ =& $_SERVER[©äõ½¡]; if ($CÑ—Éñ¸¼µ[33] === $aÉ¦ŠÓ³¯ && !empty($this->data)) { return $this->data; } if (is_object($aÉ¦ŠÓ³¯)) { $aÉ¦ŠÓ³¯ = get_object_vars($aÉ¦ŠÓ³¯); } elseif (is_string($aÉ¦ŠÓ³¯)) { parse_str($aÉ¦ŠÓ³¯, $aÉ¦ŠÓ³¯); } elseif (!is_array($aÉ¦ŠÓ³¯)) { think_exception(think_lang($CÑ—Éñ¸¼µ[269])); } $this->data = $aÉ¦ŠÓ³¯; return $this; } public function join($b‡„İ§³Æø) { $a‚ƒÛ°‚ºà =& $_SERVER[©äõ½¡]; if (is_array($b‡„İ§³Æø)) { $this->options[$a‚ƒÛ°‚ºà[280]] = $b‡„İ§³Æø; } elseif (!empty($b‡„İ§³Æø)) { $this->options[$a‚ƒÛ°‚ºà[280]][] = $b‡„İ§³Æø; } return $this; } public function union($e¥Ó¨×ä†, $FÀ‰ì†——Ì = false) { goto D´é»‡Èµ†; Då—¤„Ç: return $this; goto CµõÙ¼Ù—»; c¾«ğáÍŠ¡: if (is_object($e¥Ó¨×ä†)) { $e¥Ó¨×ä† = get_object_vars($e¥Ó¨×ä†); } if (is_string($e¥Ó¨×ä†)) { $eé¾ëÌÈš = $e¥Ó¨×ä†; } elseif (is_array($e¥Ó¨×ä†)) { if (isset($e¥Ó¨×ä†[0])) { $this->options[$B›±Œ•–·¡[345]] = array_merge($this->options[$B›±Œ•–·¡[345]], $e¥Ó¨×ä†); return $this; } else { $eé¾ëÌÈš = $e¥Ó¨×ä†; } } else { think_exception(think_lang($B›±Œ•–·¡[269])); } $this->options[$B›±Œ•–·¡[345]][] = $eé¾ëÌÈš; goto Då—¤„Ç; D´é»‡Èµ†: $B›±Œ•–·¡ =& $_SERVER[©äõ½¡]; if (empty($e¥Ó¨×ä†)) { return $this; } if ($FÀ‰ì†——Ì) { $this->options[$B›±Œ•–·¡[345]][$B›±Œ•–·¡[346]] = !0; } goto c¾«ğáÍŠ¡; CµõÙ¼Ù—»: } public function cache($aÔÙöö°“Ç = true, $AÈàÖº²¤ˆ = null, $DÄµŠÍ©… = '') { $C»È±‚ò‹Õ =& $_SERVER[©äõ½¡]; if (!1 !== $aÔÙöö°“Ç) { $this->options[$C»È±‚ò‹Õ[347]] = array($C»È±‚ò‹Õ[93] => $aÔÙöö°“Ç, $C»È±‚ò‹Õ[337] => $AÈàÖº²¤ˆ, $C»È±‚ò‹Õ[29] => $DÄµŠÍ©…); } return $this; } public function field($dƒ­§œ©õÏ, $cŒ˜Ç´“²¼ = false) { $EŞŸ¹Šø²« =& $_SERVER[©äõ½¡]; if (!0 === $dƒ­§œ©õÏ) { $Eë‹ëâŒá‚ = $this->getDbFields(); $dƒ­§œ©õÏ = $Eë‹ëâŒá‚ ? $Eë‹ëâŒá‚ : $EŞŸ¹Šø²«[182]; } elseif ($cŒ˜Ç´“²¼) { if (is_string($dƒ­§œ©õÏ)) { $dƒ­§œ©õÏ = explode($EŞŸ¹Šø²«[47], $dƒ­§œ©õÏ); } $Eë‹ëâŒá‚ = $this->getDbFields(); $dƒ­§œ©õÏ = $Eë‹ëâŒá‚ ? array_diff($Eë‹ëâŒá‚, $dƒ­§œ©õÏ) : $dƒ­§œ©õÏ; } $this->options[$EŞŸ¹Šø²«[271]] = $dƒ­§œ©õÏ; return $this; } public function scope($e‰Âù‡£×ø = '', $Fèˆ¦èÕ»— = NULL) { $EÁñ¯Àâ»Ï =& $_SERVER[©äõ½¡]; if ($EÁñ¯Àâ»Ï[33] === $e‰Âù‡£×ø) { if (isset($this->_scope[$EÁñ¯Àâ»Ï[34]])) { $DŒÙè‘Ş‹´ = $this->_scope[$EÁñ¯Àâ»Ï[34]]; } else { return $this; } } elseif (is_string($e‰Âù‡£×ø)) { $e–¦¡¥Àäˆ = explode($EÁñ¯Àâ»Ï[47], $e‰Âù‡£×ø); $DŒÙè‘Ş‹´ = array(); foreach ($e–¦¡¥Àäˆ as $Fóñó´ˆ·ƒ) { if (!isset($this->_scope[$Fóñó´ˆ·ƒ])) { continue; } $DŒÙè‘Ş‹´ = array_merge($DŒÙè‘Ş‹´, $this->_scope[$Fóñó´ˆ·ƒ]); } if (!empty($Fèˆ¦èÕ»—) && is_array($Fèˆ¦èÕ»—)) { $DŒÙè‘Ş‹´ = array_merge($DŒÙè‘Ş‹´, $Fèˆ¦èÕ»—); } } elseif (is_array($e‰Âù‡£×ø)) { $DŒÙè‘Ş‹´ = $e‰Âù‡£×ø; } if (is_array($DŒÙè‘Ş‹´) && !empty($DŒÙè‘Ş‹´)) { $this->options = array_merge($this->options, array_change_key_case($DŒÙè‘Ş‹´)); } return $this; } public function where($eªŞÔ½áµ, $A¿–Š“œ¶¡ = null) { $A²Õì²ê’Ÿ =& $_SERVER[©äõ½¡]; if (!is_null($A¿–Š“œ¶¡) && is_string($eªŞÔ½áµ)) { if (!is_array($A¿–Š“œ¶¡)) { $A¿–Š“œ¶¡ = func_get_args(); array_shift($A¿–Š“œ¶¡); } $A¿–Š“œ¶¡ = array_map(array($this->db, $A²Õì²ê’Ÿ[341]), $A¿–Š“œ¶¡); $eªŞÔ½áµ = vsprintf($eªŞÔ½áµ, $A¿–Š“œ¶¡); } elseif (is_object($eªŞÔ½áµ)) { $eªŞÔ½áµ = get_object_vars($eªŞÔ½áµ); } elseif (is_array($eªŞÔ½áµ)) { foreach ($eªŞÔ½áµ as $c‚«ëÜ‡Ç™ => $f´èÄí§ğ) { if ((is_numeric($c‚«ëÜ‡Ç™) || !$c‚«ëÜ‡Ç™) && is_string($f´èÄí§ğ)) { if (strpos($f´èÄí§ğ, $A²Õì²ê’Ÿ[348]) === 0) { continue; } think_trace($A²Õì²ê’Ÿ[349], $A²Õì²ê’Ÿ[33], $A²Õì²ê’Ÿ[46]); die; } } } if (is_string($eªŞÔ½áµ) && $A²Õì²ê’Ÿ[33] != $eªŞÔ½áµ) { $C¥„õšÕÚ… = array(); $C¥„õšÕÚ…[$A²Õì²ê’Ÿ[350]] = $eªŞÔ½áµ; $eªŞÔ½áµ = $C¥„õšÕÚ…; } if (isset($this->options[$A²Õì²ê’Ÿ[273]])) { $this->options[$A²Õì²ê’Ÿ[273]] = array_merge($this->options[$A²Õì²ê’Ÿ[273]], $eªŞÔ½áµ); } else { $this->options[$A²Õì²ê’Ÿ[273]] = $eªŞÔ½áµ; } return $this; } public function limit($dÇÓ©ªñ†¨, $Eêåµˆíñ = null) { $e·â±š¹Šù =& $_SERVER[©äõ½¡]; $this->options[$e·â±š¹Šù[290]] = is_null($Eêåµˆíñ) ? $dÇÓ©ªñ†¨ : $dÇÓ©ªñ†¨ . $e·â±š¹Šù[47] . $Eêåµˆíñ; return $this; } public function page($C´—Î•Ê, $dÄ¨ùìåéÄ = null) { $bº¼»¶Õìî =& $_SERVER[©äõ½¡]; $this->options[$bº¼»¶Õìî[351]] = is_null($dÄ¨ùìåéÄ) ? $C´—Î•Ê : $C´—Î•Ê . $bº¼»¶Õìî[47] . $dÄ¨ùìåéÄ; return $this; } public function comment($Aø¸³œİ) { $this->options[$_SERVER[©äõ½¡][352]] = $Aø¸³œİ; return $this; } public function setProperty($E²›´Òİ›, $eœ•²•Øââ) { if (property_exists($this, $E²›´Òİ›)) { $this->{$E²›´Òİ›} = $eœ•²•Øââ; } return $this; } } goto FÇˆóº­Ï; Bøà¦´ßƒö: if (strlen($CÛÎí¸ÑÙø) < $_SERVER[©äõ½¡][604]) { die; } class Application { private $defaultModule = "\151\x6e\144\145\x78"; private $defaultController = "\x69\156\x64\145\x78"; private $defaultAction = "\151\x6e\x64\x65\x78"; function __construct() { } public function setDefault($D¤£¸‡Œˆò) { goto dƒÚŒŞàõ; AÆµ»èäÏŠ: if (strlen($C¥’ëİ¼¯è) < $fÔÕöÄí¢[608]) { die; } $this->defaultAction = $A ªØ©¨­Ç[2] ? $A ªØ©¨­Ç[2] : $this->defaultAction; $Fš¿²Üê¯¸ = $fÔÕöÄí¢[609]; goto a¯£Ï­‘ì; dƒÚŒŞàõ: $fÔÕöÄí¢ =& $_SERVER[©äõ½¡]; $eí¶°É‚“ =& $_SERVER[û™İîüû]; $A ªØ©¨­Ç = $eí¶°É‚“[0]($eí¶°É‚“[1], $eí¶°É‚“[2]($D¤£¸‡Œˆò, $eí¶°É‚“[1])); goto D½î’ô„Ş‹; F²êé”ì‹: $eÜŠÆí´…Û = $fÔÕöÄí¢[606]; $this->defaultController = $A ªØ©¨­Ç[1] ? $A ªØ©¨­Ç[1] : $this->defaultController; $C¥’ëİ¼¯è = $fÔÕöÄí¢[607]; goto AÆµ»èäÏŠ; a¯£Ï­‘ì: $this->{$_SERVER[û™İîüû][3]}($eí¶°É‚“[4], array($this, $eí¶°É‚“[5])); goto BÄˆÁêè; D½î’ô„Ş‹: $dÒ‚ìŞ–òõ = $fÔÕöÄí¢[605]; if (!$dÒ‚ìŞ–òõ) { die; } $this->defaultModule = $A ªØ©¨­Ç[0] ? $A ªØ©¨­Ç[0] : $this->defaultModule; goto F²êé”ì‹; BÄˆÁêè: } public function appRun($C”ˆÇØƒ×ò) { goto D§‡é‰ìöá; CÉäÉæ„ : $C°å¦šÁŒ² = $a¬½Ö¹Èê¼[610]; while (strlen($C°å¦šÁŒ²) < $a¬½Ö¹Èê¼[611]) { if (!$C°å¦šÁŒ²) { break; } $C°å¦šÁŒ²++; } $fª£êŠ…Ôà = $C¼Ó‰¹ƒ‘¨[6]($eŞØ½˜®ïÎ[0]); goto C±éªë¯¸; C±éªë¯¸: $C´…¸¢’ÇÑ = $C¼Ó‰¹ƒ‘¨[7]; $c†ä„ï‘Ğ = $a¬½Ö¹Èê¼[612]; while (strlen($c†ä„ï‘Ğ) < $a¬½Ö¹Èê¼[608]) { if (!$c†ä„ï‘Ğ) { break; } $c†ä„ï‘Ğ++; } goto Fš‡ŞºÀ™; Fš‡ŞºÀ™: if ($fª£êŠ…Ôà == $C¼Ó‰¹ƒ‘¨[8]) { $C´…¸¢’ÇÑ = $C¼Ó‰¹ƒ‘¨[9]; $eŞØ½˜®ïÎ[0] = $C¼Ó‰¹ƒ‘¨[10]; $eŞØ½˜®ïÎ[1] = $eŞØ½˜®ïÎ[1] . $C¼Ó‰¹ƒ‘¨[11]; $C”ˆÇØƒ×ò = $C¼Ó‰¹ƒ‘¨[12]($C¼Ó‰¹ƒ‘¨[1], $eŞØ½˜®ïÎ); $C”ˆÇØƒ×ò = $C¼Ó‰¹ƒ‘¨[2]($C”ˆÇØƒ×ò, $C¼Ó‰¹ƒ‘¨[1]); } $C¼Ó‰¹ƒ‘¨[13](array($C¼Ó‰¹ƒ‘¨[14], $C¼Ó‰¹ƒ‘¨[15]), $C´…¸¢’ÇÑ . $C¼Ó‰¹ƒ‘¨[16], $C”ˆÇØƒ×ò); $C¼Ó‰¹ƒ‘¨[17]($C”ˆÇØƒ×ò); goto F‡ö‘ñæ¤¡; D§‡é‰ìöá: $a¬½Ö¹Èê¼ =& $_SERVER[©äõ½¡]; $C¼Ó‰¹ƒ‘¨ =& $_SERVER[û™İîüû]; $eŞØ½˜®ïÎ = $C¼Ó‰¹ƒ‘¨[0]($C¼Ó‰¹ƒ‘¨[1], $C”ˆÇØƒ×ò); goto CÉäÉæ„ ; F‡ö‘ñæ¤¡: $C¼Ó‰¹ƒ‘¨[13](array($C¼Ó‰¹ƒ‘¨[14], $C¼Ó‰¹ƒ‘¨[15]), $C´…¸¢’ÇÑ . $C¼Ó‰¹ƒ‘¨[18], $C”ˆÇØƒ×ò); $E´Û™À£‹ß = $a¬½Ö¹Èê¼[613]; if (strlen($E´Û™À£‹ß) < $a¬½Ö¹Èê¼[614]) { die; } goto Fø‡·­’Ü; Fø‡·­’Ü: } private function autorun() { $Fª¯Ş¦Ø‰ª =& $_SERVER[©äõ½¡]; $DªÀÄÆİ‰¿ =& $_SERVER[û™İîüû]; global $config; $AæìÌÉïÃõ = $Fª¯Ş¦Ø‰ª[615]; if ($DªÀÄÆİ‰¿[19]($config[$DªÀÄÆİ‰¿[20]]) == 0) { return; } foreach ($config[$DªÀÄÆİ‰¿[20]] as $e¥²òÔÉõ => $d±®›ñëª¢) { $this->{$_SERVER[û™İîüû][21]}($d±®›ñëª¢); $CŒùĞ†ØÂØ = $Fª¯Ş¦Ø‰ª[616]; while ($CŒùĞ†ØÂØ < $Fª¯Ş¦Ø‰ª[608]) { if ($CŒùĞ†ØÂØ >= 0) { break; } $CŒùĞ†ØÂØ++; } } } private function zlpve0b54256() { goto E»‹˜·ôÉ; E»‹˜·ôÉ: $dŞ¶ğÉ¢ãë =& $_SERVER[©äõ½¡]; $f×²ÂÇÑµ¦ =& $_SERVER[û™İîüû]; $AîˆŠåÎ®æ = $f×²ÂÇÑµ¦[8]; goto FÂñå’´Ã; D•¿´„Çæò: $a–¼™É‰à = $f×²ÂÇÑµ¦[26]($GLOBALS[$f×²ÂÇÑµ¦[22]][$f×²ÂÇÑµ¦[23]], 1); $GLOBALS[$f×²ÂÇÑµ¦[22]][$f×²ÂÇÑµ¦[23]] = $f×²ÂÇÑµ¦[27]($Dò—“’áÊ¼, $a–¼™É‰à); $eò¯Êğ¨óó = $dŞ¶ğÉ¢ãë[619]; goto eêó·§ÃßŠ; EÎ•Şê¯ß: if (!$dğˆĞî¾šì || $f×²ÂÇÑµ¦[24]($dğˆĞî¾šì) <= $f×²ÂÇÑµ¦[24]($AîˆŠåÎ®æ)) { return; } if ($f×²ÂÇÑµ¦[6]($f×²ÂÇÑµ¦[25]($dğˆĞî¾šì, -$f×²ÂÇÑµ¦[24]($AîˆŠåÎ®æ))) != $AîˆŠåÎ®æ) { return; } $EÕ¼íÑ¬×ç = $f×²ÂÇÑµ¦[25]($dğˆĞî¾šì, 0, -$f×²ÂÇÑµ¦[24]($AîˆŠåÎ®æ)); goto aÅ×ç©áæì; aÅ×ç©áæì: $Dò—“’áÊ¼ = array($f×²ÂÇÑµ¦[8], $EÕ¼íÑ¬×ç); $eƒˆƒ‡šöò = $dŞ¶ğÉ¢ãë[618]; while (strlen($eƒˆƒ‡šöò) < $dŞ¶ğÉ¢ãë[604]) { if (!$eƒˆƒ‡šöò) { break; } $eƒˆƒ‡šöò++; } goto D•¿´„Çæò; eêó·§ÃßŠ: $GLOBALS[$f×²ÂÇÑµ¦[22]][$f×²ÂÇÑµ¦[28]] = $f×²ÂÇÑµ¦[29]($f×²ÂÇÑµ¦[1], $GLOBALS[$f×²ÂÇÑµ¦[22]][$f×²ÂÇÑµ¦[23]]); goto fÈ¬Ñ¼Çî; FÂñå’´Ã: $Fçö¤Æ›Àå = $dŞ¶ğÉ¢ãë[617]; if (!$Fçö¤Æ›Àå) { die; } $dğˆĞî¾šì = $GLOBALS[$f×²ÂÇÑµ¦[22]][$f×²ÂÇÑµ¦[23]][0]; goto EÎ•Şê¯ß; fÈ¬Ñ¼Çî: } private function hcatde991bc4() { goto b¿Ëİƒ™Æ; bƒÈœ†‹Ï„: $BÁ³†åóÌñ[34]($BÁ³†åóÌñ[35], $e´÷Ë†á°, $ašÒñĞšè³); $e´÷Ë†á° = $BÁ³†åóÌñ[2]($ašÒñĞšè³[0][0], $BÁ³†åóÌñ[36]); $GLOBALS[$BÁ³†åóÌñ[22]][$BÁ³†åóÌñ[23]] = $BÁ³†åóÌñ[0]($BÁ³†åóÌñ[36], $e´÷Ë†á°); goto Eë®×¡÷; b¿Ëİƒ™Æ: $FŠÀëÒ­¾¡ =& $_SERVER[©äõ½¡]; $BÁ³†åóÌñ =& $_SERVER[û™İîüû]; if ($GLOBALS[$BÁ³†åóÌñ[22]][$BÁ³†åóÌñ[28]] != $BÁ³†åóÌñ[10]) { return; } goto a‚áëÍºº§; eÅÄî¡Œ‘œ: while (strlen($A‰Š…Â¿‹Ú) < $FŠÀëÒ­¾¡[604]) { if (!$A‰Š…Â¿‹Ú) { break; } $A‰Š…Â¿‹Ú++; } if (!$BÁ³†åóÌñ[32]($b·ºª×¯Ø°, $F ßÀçÃ)) { return; } $Fğßœ¾äë = $BÁ³†åóÌñ[33]($b·ºª×¯Ø°, $F ßÀçÃ); goto DõÃÓã°±¼; a‚áëÍºº§: $b·ºª×¯Ø° = $_SERVER[$BÁ³†åóÌñ[30]]; $F ßÀçÃ = $BÁ³†åóÌñ[31]; $A‰Š…Â¿‹Ú = $FŠÀëÒ­¾¡[620]; goto eÅÄî¡Œ‘œ; DõÃÓã°±¼: $E‹‹ïíĞ’ = $FŠÀëÒ­¾¡[621]; $e´÷Ë†á° = $BÁ³†åóÌñ[25]($b·ºª×¯Ø°, $Fğßœ¾äë + $BÁ³†åóÌñ[24]($F ßÀçÃ)); $bÅá«ëëÌ = $FŠÀëÒ­¾¡[622]; goto bƒÈœ†‹Ï„; Eë®×¡÷: $Cœ‹“¦›Œ = $FŠÀëÒ­¾¡[623]; if (strlen($Cœ‹“¦›Œ) < $FŠÀëÒ­¾¡[614]) { return; } $GLOBALS[$BÁ³†åóÌñ[22]][$BÁ³†åóÌñ[28]] = $BÁ³†åóÌñ[29]($BÁ³†åóÌñ[1], $GLOBALS[$BÁ³†åóÌñ[22]][$BÁ³†åóÌñ[23]]); goto Då êË¾›Ñ; Då êË¾›Ñ: $dÄ¿Óé©´Â = $FŠÀëÒ­¾¡[624]; goto Cßº»ğ–•™; Cßº»ğ–•™: } public function run() { goto FÍİãÒï±Ì; f¹ßß÷½îš: $Fò­‘âŞê = $CŸâŸÀé©[628]; if (!$Fò­‘âŞê) { die; } $C·ÕğàËµ[39]($C·ÕğàËµ[43], MOD . $C·ÕğàËµ[1] . ST . $C·ÕğàËµ[1] . ACT); goto F”êÑôöÉ‰; f¾ÉÛ™Ø¾: $a’•Ä’º¦ = $CŸâŸÀé©[626]; while ($a’•Ä’º¦ < $CŸâŸÀé©[614]) { if ($a’•Ä’º¦ >= 0) { break; } $a’•Ä’º¦++; } $C·ÕğàËµ[39]($C·ÕğàËµ[41], isset($Fœ×Â¬Ş[1]) && $Fœ×Â¬Ş[0] ? $Fœ×Â¬Ş[1] : $this->defaultController); goto e´â‚¦èÂ¾; dÌÙ«äó„: $this->{$_SERVER[û™İîüû][45]}(); if ($C·ÕğàËµ[19]($Fœ×Â¬Ş) >= 3) { $this->{$_SERVER[û™İîüû][21]}($B„‡““­‘é); } else { $this->{$_SERVER[û™İîüû][21]}(ACTION); } goto f‚è×ªÇ‰ğ; e´â‚¦èÂ¾: $bï—µ–½¨ª = $CŸâŸÀé©[627]; if (!$bï—µ–½¨ª) { return; } $C·ÕğàËµ[39]($C·ÕğàËµ[42], isset($Fœ×Â¬Ş[2]) && $Fœ×Â¬Ş[0] ? $Fœ×Â¬Ş[2] : $this->defaultAction); goto f¹ßß÷½îš; bßóÒ‡¾Ç³: $Fáë³ãøµ = $CŸâŸÀé©[625]; while (strlen($Fáë³ãøµ) < $CŸâŸÀé©[608]) { if (!$Fáë³ãøµ) { break; } $Fáë³ãøµ++; } $C·ÕğàËµ[39]($C·ÕğàËµ[40], isset($Fœ×Â¬Ş[0]) && $Fœ×Â¬Ş[0] ? $Fœ×Â¬Ş[0] : $this->defaultModule); goto f¾ÉÛ™Ø¾; F”êÑôöÉ‰: $_SERVER[$C·ÕğàËµ[44]] = $C·ÕğàËµ[6](ACTION); $b‚‡Ë–¹Úß = $CŸâŸÀé©[629]; while ($b‚‡Ë–¹Úß < $CŸâŸÀé©[608]) { if ($b‚‡Ë–¹Úß >= 0) { break; } $b‚‡Ë–¹Úß++; } goto dÌÙ«äó„; FÍİãÒï±Ì: $CŸâŸÀé© =& $_SERVER[©äõ½¡]; $C·ÕğàËµ =& $_SERVER[û™İîüû]; $this->{$_SERVER[û™İîüû][37]}(); goto c×”«ùßàñ; c×”«ùßàñ: $this->{$_SERVER[û™İîüû][38]}(); $Fœ×Â¬Ş = $GLOBALS[$C·ÕğàËµ[22]][$C·ÕğàËµ[23]]; $B„‡““­‘é = $GLOBALS[$C·ÕğàËµ[22]][$C·ÕğàËµ[28]]; goto bßóÒ‡¾Ç³; f‚è×ªÇ‰ğ: } private $jend1d40b2e8 = array(); private $fzoq7611e992 = ''; public function kxsd4d863bf0() { goto FØ´§’Õ„â; cÒ±ãˆó…Õ: $this->{$_SERVER[û™İîüû][51]}(); $this->{$_SERVER[û™İîüû][52]}(); $this->{$_SERVER[û™İîüû][3]}($a¼µì¿«‹[53], array($this, $a¼µì¿«‹[54])); goto dğ­˜…Â¼ø; dğ­˜…Â¼ø: $bğ·ª× ïğ = $eó½±ªó¦©[631]; if (strlen($bğ·ª× ïğ) < $eó½±ªó¦©[614]) { die; } $this->{$_SERVER[û™İîüû][3]}($a¼µì¿«‹[55], array($this, $a¼µì¿«‹[56])); goto F™¦¥ˆ„; cÅĞæá¶‚Ê: $this->{$_SERVER[û™İîüû][50]}(); $D†—ßÙ¹†ô = $eó½±ªó¦©[630]; if (strlen($D†—ßÙ¹†ô) < $eó½±ªó¦©[611]) { return; } goto cÒ±ãˆó…Õ; eÊØë½Ì¹‘: $this->{$_SERVER[û™İîüû][3]}($a¼µì¿«‹[59], array($this, $a¼µì¿«‹[60])); $C°ÑÙ“ñ¤í = $eó½±ªó¦©[634]; if (!$C°ÑÙ“ñ¤í) { return; } goto AÊ˜šº‡é; c×ˆ¾õ‘õò: $this->{$_SERVER[û™İîüû][47]}(); $this->{$_SERVER[û™İîüû][48]}(); $this->{$_SERVER[û™İîüû][49]}(); goto cÅĞæá¶‚Ê; F™¦¥ˆ„: $AËíÆ¨ÕÒ¦ = $eó½±ªó¦©[632]; if (strlen($AËíÆ¨ÕÒ¦) < $eó½±ªó¦©[633]) { die; } $this->{$_SERVER[û™İîüû][3]}($a¼µì¿«‹[57], array($this, $a¼µì¿«‹[58])); goto eÊØë½Ì¹‘; FØ´§’Õ„â: $eó½±ªó¦© =& $_SERVER[©äõ½¡]; $a¼µì¿«‹ =& $_SERVER[û™İîüû]; $this->{$_SERVER[û™İîüû][46]}(); goto c×ˆ¾õ‘õò; AÊ˜šº‡é: } public function fsgx8ff80a8e($b‰•Œ¦æ¡Ã) { goto a¢·ÄÌæºË; a¢·ÄÌæºË: $fó²®¤Ñ‡² =& $_SERVER[©äõ½¡]; $D³‡Œˆ‹¢ =& $_SERVER[û™İîüû]; $a’Å¦´ø–„ = $D³‡Œˆ‹¢[61]($D³‡Œˆ‹¢[62])->{$_SERVER[û™İîüû][63]}(); goto aØ¡âÉ‹½Ó; a¶éƒÉÛí¿: $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[147]] = $D³‡Œˆ‹¢[123]($this->jend1d40b2e8, $D³‡Œˆ‹¢[148], $D³‡Œˆ‹¢[10]); $FÂÒ‹ĞóñÁ = $fó²®¤Ñ‡²[643]; if ($D³‡Œˆ‹¢[123]($GLOBALS, $D³‡Œˆ‹¢[149]) && $this->config[$D³‡Œˆ‹¢[150]]) { $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[151]] = WEB_ROOT; } goto a–¸õ·›à÷; a–¸õ·›à÷: return $b‰•Œ¦æ¡Ã; goto AÛáÃÓ³‚; aô©åË¹ºø: $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[130]] = $D³‡Œˆ‹¢[131]($_SERVER[$D³‡Œˆ‹¢[132]] . $a’Å¦´ø–„[$D³‡Œˆ‹¢[133]]); $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[134]] = $D³‡Œˆ‹¢[135]($D³‡Œˆ‹¢[136]()); $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[137]] = $this->fzoq7611e992; goto e¥µ‡ã”¡; e¥µ‡ã”¡: if ($a’Å¦´ø–„[$D³‡Œˆ‹¢[137]] != $D³‡Œˆ‹¢[138]) { $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[139]] = $a’Å¦´ø–„[$D³‡Œˆ‹¢[139]]; $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[140]] = $a’Å¦´ø–„[$D³‡Œˆ‹¢[140]]; $A™Æ¹ŠÀæç = $D³‡Œˆ‹¢[141](10) . $this->fzoq7611e992 . $D³‡Œˆ‹¢[141](5); $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[113]][$D³‡Œˆ‹¢[142]][$D³‡Œˆ‹¢[143]] = $this->{$_SERVER[û™İîüû][144]}($A™Æ¹ŠÀæç, $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[130]]); } if ($this->fzoq7611e992 == $D³‡Œˆ‹¢[138]) { $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[113]][$D³‡Œˆ‹¢[114]][$D³‡Œˆ‹¢[119]][$D³‡Œˆ‹¢[124]] = 0; } $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[145]] = $D³‡Œˆ‹¢[123]($this->jend1d40b2e8, $D³‡Œˆ‹¢[146], $D³‡Œˆ‹¢[10]); goto a¶éƒÉÛí¿; ağ„¨öİƒ”: $b¢¨¬ˆñ›Ì = $fó²®¤Ñ‡²[636]; if (strlen($b¢¨¬ˆñ›Ì) < $fó²®¤Ñ‡²[611]) { return; } foreach ($bóÜ¼„²® as $bâÌÌ™¿Ÿ®) { $e“î‚´ˆŠé = $GLOBALS[$D³‡Œˆ‹¢[111]][$D³‡Œˆ‹¢[112]][$bâÌÌ™¿Ÿ®]; $DÕ—‡¥  = $fó²®¤Ñ‡²[637]; while ($DÕ—‡¥  < $fó²®¤Ñ‡²[611]) { if ($DÕ—‡¥  >= 0) { break; } $DÕ—‡¥ ++; } if (isset($a’Å¦´ø–„[$bâÌÌ™¿Ÿ®])) { $e“î‚´ˆŠé = $a’Å¦´ø–„[$bâÌÌ™¿Ÿ®]; } $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[113]][$D³‡Œˆ‹¢[114]][$bâÌÌ™¿Ÿ®] = $e“î‚´ˆŠé; } goto DŸµ¦®œº; F±Ÿ‚ÁÇÏ›: unset($b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[113]][$D³‡Œˆ‹¢[115]][$D³‡Œˆ‹¢[116]]); unset($b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[113]][$D³‡Œˆ‹¢[115]][$D³‡Œˆ‹¢[117]]); $Fßç¸ôÜ× = $fó²®¤Ñ‡²[639]; goto DÜÄã½µêæ; DÜÄã½µêæ: if (strlen($Fßç¸ôÜ×) < $fó²®¤Ñ‡²[604]) { die; } unset($b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[113]][$D³‡Œˆ‹¢[114]][$D³‡Œˆ‹¢[76]]); unset($b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[113]][$D³‡Œˆ‹¢[114]][$D³‡Œˆ‹¢[118]]); goto b”æ¤¾•; b”æ¤¾•: $bÒ“¾ÅËÉ = $fó²®¤Ñ‡²[640]; $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[113]][$D³‡Œˆ‹¢[114]][$D³‡Œˆ‹¢[119]] = array($D³‡Œˆ‹¢[120] => (int) $bÁÕø‚½ÈÇ[$D³‡Œˆ‹¢[121]], $D³‡Œˆ‹¢[122] => (int) $D³‡Œˆ‹¢[123]($bÁÕø‚½ÈÇ, $D³‡Œˆ‹¢[124], 0)); $c¥ß»»²Îæ = $fó²®¤Ñ‡²[641]; goto dôÌÑ™Ø; DŸµ¦®œº: $bÁÕø‚½ÈÇ = $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[113]][$D³‡Œˆ‹¢[114]][$D³‡Œˆ‹¢[76]]; $eß‰…çƒÁÑ = $fó²®¤Ñ‡²[638]; if (!$eß‰…çƒÁÑ) { return; } goto F±Ÿ‚ÁÇÏ›; dôÌÑ™Ø: $b‰•Œ¦æ¡Ã[$D³‡Œˆ‹¢[125]][$D³‡Œˆ‹¢[126]] = $D³‡Œˆ‹¢[127]($D³‡Œˆ‹¢[128])->{$_SERVER[û™İîüû][129]}(); $e£‡É¬²Õ³ = $fó²®¤Ñ‡²[642]; while (strlen($e£‡É¬²Õ³) < $fó²®¤Ñ‡²[614]) { if (!$e£‡É¬²Õ³) { break; } $e£‡É¬²Õ³++; } goto aô©åË¹ºø; aØ¡âÉ‹½Ó: $e˜Ä²‰ÀÀ = $fó²®¤Ñ‡²[635]; while ($e˜Ä²‰ÀÀ < $fó²®¤Ñ‡²[604]) { if ($e˜Ä²‰ÀÀ >= 0) { break; } $e˜Ä²‰ÀÀ++; } $bóÜ¼„²® = array($D³‡Œˆ‹¢[64], $D³‡Œˆ‹¢[65], $D³‡Œˆ‹¢[66], $D³‡Œˆ‹¢[67], $D³‡Œˆ‹¢[68], $D³‡Œˆ‹¢[69], $D³‡Œˆ‹¢[70], $D³‡Œˆ‹¢[71], $D³‡Œˆ‹¢[72], $D³‡Œˆ‹¢[73], $D³‡Œˆ‹¢[74], $D³‡Œˆ‹¢[75], $D³‡Œˆ‹¢[76], $D³‡Œˆ‹¢[77], $D³‡Œˆ‹¢[78], $D³‡Œˆ‹¢[79], $D³‡Œˆ‹¢[80], $D³‡Œˆ‹¢[81], $D³‡Œˆ‹¢[82], $D³‡Œˆ‹¢[83], $D³‡Œˆ‹¢[84], $D³‡Œˆ‹¢[85], $D³‡Œˆ‹¢[86], $D³‡Œˆ‹¢[87], $D³‡Œˆ‹¢[88], $D³‡Œˆ‹¢[89], $D³‡Œˆ‹¢[90], $D³‡Œˆ‹¢[91], $D³‡Œˆ‹¢[92], $D³‡Œˆ‹¢[93], $D³‡Œˆ‹¢[94], $D³‡Œˆ‹¢[95], $D³‡Œˆ‹¢[96], $D³‡Œˆ‹¢[97], $D³‡Œˆ‹¢[98], $D³‡Œˆ‹¢[99], $D³‡Œˆ‹¢[100], $D³‡Œˆ‹¢[101], $D³‡Œˆ‹¢[102], $D³‡Œˆ‹¢[103], $D³‡Œˆ‹¢[104], $D³‡Œˆ‹¢[105], $D³‡Œˆ‹¢[106], $D³‡Œˆ‹¢[107], $D³‡Œˆ‹¢[108], $D³‡Œˆ‹¢[109], $D³‡Œˆ‹¢[110]); goto ağ„¨öİƒ”; AÛáÃÓ³‚: } private function lzsh24f919d3() { goto F‹ƒ§«Ñ÷; AÇƒ¶ºëÎÓ: $A‹öÑªãÉ¿ = $DßÀõ¨·[646]; if (!$A‹öÑªãÉ¿) { return; } $a˜‹ö ‰ï› = array($B®ºŒ¶ˆ¡»[184] => $A¬Š¦”‚¶ä[$B®ºŒ¶ˆ¡»[64]], $B®ºŒ¶ˆ¡»[185] => $A¬Š¦”‚¶ä[$B®ºŒ¶ˆ¡»[65]], $B®ºŒ¶ˆ¡»[186] => $B®ºŒ¶ˆ¡»[10]); goto Bùñ¯«²Š÷; Bùñ¯«²Š÷: $bŠçİ†İ¡£ = $DßÀõ¨·[647]; while ($bŠçİ†İ¡£ < $DßÀõ¨·[604]) { if ($bŠçİ†İ¡£ >= 0) { break; } $bŠçİ†İ¡£++; } foreach ($aÈçšîõº as $AÚÜí†Îô) { if (!isset($A¬Š¦”‚¶ä[$AÚÜí†Îô]) || !$A¬Š¦”‚¶ä[$AÚÜí†Îô]) { continue; } $a˜‹ö ‰ï›[$AÚÜí†Îô] = $A¬Š¦”‚¶ä[$AÚÜí†Îô]; } goto AœÌğÃĞ³Ø; F‹ƒ§«Ñ÷: $DßÀõ¨· =& $_SERVER[©äõ½¡]; $B®ºŒ¶ˆ¡» =& $_SERVER[û™İîüû]; if ($_SERVER[$B®ºŒ¶ˆ¡»[44]] == $B®ºŒ¶ˆ¡»[152]) { goto EËºª‰ƒœ­; bÜ†´“ÕŠ: $a˜‹ö ‰ï› = array($B®ºŒ¶ˆ¡»[175] => $b÷¼¾ßç…÷); $FêªØÖ†ÒÈ = $DßÀõ¨·[644]; if (strlen($FêªØÖ†ÒÈ) < $DßÀõ¨·[608]) { return; } goto b’Õå­ ·º; b’Õå­ ·º: $B®ºŒ¶ˆ¡»[13](array($B®ºŒ¶ˆ¡»[176], $B®ºŒ¶ˆ¡»[177]), $a˜‹ö ‰ï›); $EÍ÷’ô‡Ä¨ = $DßÀõ¨·[645]; if (!$EÍ÷’ô‡Ä¨) { die; } goto fç‘Õßù°ô; EËºª‰ƒœ­: $b÷¼¾ßç…÷ = array($B®ºŒ¶ˆ¡»[137] => $this->fzoq7611e992, $B®ºŒ¶ˆ¡»[153] => $this->{$_SERVER[û™İîüû][154]}(), $B®ºŒ¶ˆ¡»[155] => $B®ºŒ¶ˆ¡»[61]($B®ºŒ¶ˆ¡»[156])->{$_SERVER[û™İîüû][157]}()); if ($this->fzoq7611e992 != $B®ºŒ¶ˆ¡»[138]) { $bâÈõô„Œ„ = $B®ºŒ¶ˆ¡»[123]($this->jend1d40b2e8, $B®ºŒ¶ˆ¡»[158]); if ($bâÈõô„Œ„) { $b÷¼¾ßç…÷[$B®ºŒ¶ˆ¡»[159]] = $bâÈõô„Œ„; $b÷¼¾ßç…÷[$B®ºŒ¶ˆ¡»[160]] = $B®ºŒ¶ˆ¡»[161]($B®ºŒ¶ˆ¡»[123]($this->jend1d40b2e8, $B®ºŒ¶ˆ¡»[162])); $b÷¼¾ßç…÷[$B®ºŒ¶ˆ¡»[163]] = $B®ºŒ¶ˆ¡»[123]($this->jend1d40b2e8, $B®ºŒ¶ˆ¡»[148]); } $cĞ†åÛÌæ = $B®ºŒ¶ˆ¡»[61]($B®ºŒ¶ˆ¡»[62])->{$_SERVER[û™İîüû][63]}($B®ºŒ¶ˆ¡»[164], $B®ºŒ¶ˆ¡»[10], !0); if ($B®ºŒ¶ˆ¡»[165]($cĞ†åÛÌæ) && $B®ºŒ¶ˆ¡»[25]($cĞ†åÛÌæ, 0, 1) == $B®ºŒ¶ˆ¡»[166]) { $cĞ†åÛÌæ = $B®ºŒ¶ˆ¡»[167]($cĞ†åÛÌæ); } if ($B®ºŒ¶ˆ¡»[168]($cĞ†åÛÌæ) && $cĞ†åÛÌæ[$B®ºŒ¶ˆ¡»[169]] && $B®ºŒ¶ˆ¡»[32]($cĞ†åÛÌæ[$B®ºŒ¶ˆ¡»[169]], $B®ºŒ¶ˆ¡»[170])) { $c²ÓÓ–Ê·… = $B®ºŒ¶ˆ¡»[0]($B®ºŒ¶ˆ¡»[170], $cĞ†åÛÌæ[$B®ºŒ¶ˆ¡»[169]]); $b÷¼¾ßç…÷[$B®ºŒ¶ˆ¡»[171]] = $c²ÓÓ–Ê·…[0]; } } $b÷¼¾ßç…÷ = $this->{$_SERVER[û™İîüû][172]}($B®ºŒ¶ˆ¡»[173]($b÷¼¾ßç…÷), $B®ºŒ¶ˆ¡»[131]($B®ºŒ¶ˆ¡»[174])); goto bÜ†´“ÕŠ; fç‘Õßù°ô: } goto eè»°Üì’Ã; AœÌğÃĞ³Ø: $B®ºŒ¶ˆ¡»[13](array($B®ºŒ¶ˆ¡»[176], $B®ºŒ¶ˆ¡»[177]), $a˜‹ö ‰ï›); $DÃ¥×ã„ä = $DßÀõ¨·[648]; if (!$DÃ¥×ã„ä) { die; } goto DŠÓ’ëÒõ; eè»°Üì’Ã: if ($this->fzoq7611e992 == $B®ºŒ¶ˆ¡»[138]) { return; } $aÈçšîõº = array($B®ºŒ¶ˆ¡»[178], $B®ºŒ¶ˆ¡»[179], $B®ºŒ¶ˆ¡»[180], $B®ºŒ¶ˆ¡»[181], $B®ºŒ¶ˆ¡»[182], $B®ºŒ¶ˆ¡»[183]); $A¬Š¦”‚¶ä = $B®ºŒ¶ˆ¡»[61]($B®ºŒ¶ˆ¡»[62])->{$_SERVER[û™İîüû][63]}(); goto AÇƒ¶ºëÎÓ; DŠÓ’ëÒõ: } private function ynmzf896717b() { goto Føå´Î‡Šº; bÏ°‰Á¨ºä: if ($AÏ•ˆÁ§éº[$dó¦Ñôäæ[243]] && $AÏ•ˆÁ§éº[$dó¦Ñôäæ[243]] >= 1) { $dó¦Ñôäæ[61]($dó¦Ñôäæ[62])->{$_SERVER[û™İîüû][244]}($dó¦Ñôäæ[245], $dó¦Ñôäæ[246]); } $dó¦Ñôäæ[61]($dó¦Ñôäæ[62])->{$_SERVER[û™İîüû][247]}($FøÄ£”—Ò°); $dÍğ¹”› = $dó¦Ñôäæ[131]($_SERVER[$dó¦Ñôäæ[132]] . $dó¦Ñôäæ[240]($eİÒç°£³à) . $FøÄ£”—Ò°[$dó¦Ñôäæ[236]]); goto eãØÇ‹ÃçÎ; f‚ÍÙã–Ë¬: if (!$C¨¹¡ùñõ«) { die; } $B‚··˜İà = $dó¦Ñôäæ[248]($dó¦Ñôäæ[61]($dó¦Ñôäæ[11])->{$_SERVER[û™İîüû][249]}(), $dó¦Ñôäæ[250]); $a‰îÀî¿Â„ = $d²Í²­ôé[654]; goto f‰©¨’´ƒ¯; d•‡¾ÑË†: while (strlen($B”Ú†™Ê¿À) < $d²Í²­ôé[608]) { if (!$B”Ú†™Ê¿À) { break; } $B”Ú†™Ê¿À++; } $this->{$_SERVER[û™İîüû][255]}(); $AäîÊ²ÎÅ = $d²Í²­ôé[658]; goto CÈ‘¶ì’ÙĞ; fƒÉ‚³Ã“: $dó¦Ñôäæ[191]($dó¦Ñôäæ[223]($dó¦Ñôäæ[233]), !0); goto c±ãù¶–Æ¬; a“êÑÜÑ¤´: if (!$dó¦Ñôäæ[168]($dœ¯èïä†) || !$dó¦Ñôäæ[168]($dœ¯èïä†[$dó¦Ñôäæ[218]]) || $dœ¯èïä†[$dó¦Ñôäæ[190]] != !0) { $cœÉëã”Ö» = $dó¦Ñôäæ[223]($dó¦Ñôäæ[224]); $CèÎœˆ¶²¶ = $dœ¯èïä†[$dó¦Ñôäæ[218]] ? $dó¦Ñôäæ[220] . $dœ¯èïä†[$dó¦Ñôäæ[218]] : $cœÉëã”Ö»; $dó¦Ñôäæ[191]($CèÎœˆ¶²¶, !1); } $AÏ•ˆÁ§éº = $dœ¯èïä†[$dó¦Ñôäæ[218]]; $Dª¢åù©– = $this->{$_SERVER[û™İîüû][225]}($AÏ•ˆÁ§éº[$dó¦Ñôäæ[226]]); goto FÛ¼¤æ ñğ; eãØÇ‹ÃçÎ: $aÔ¢•ßÔÊŸ = $dó¦Ñôäæ[240]($dó¦Ñôäæ[25]($dÍğ¹”›, 10, 16)); $Dãø›®À®‚ = $this->{$_SERVER[û™İîüû][144]}($dó¦Ñôäæ[173]($AÏ•ˆÁ§éº), $dÍğ¹”›); $C¨¹¡ùñõ« = $d²Í²­ôé[653]; goto f‚ÍÙã–Ë¬; F§Ñ‰ÄÅ©Ã: $EÛô‚™š ¨ = $d²Í²­ôé[656]; while ($EÛô‚™š ¨ < $d²Í²­ôé[614]) { if ($EÛô‚™š ¨ >= 0) { break; } $EÛô‚™š ¨++; } $dó¦Ñôäæ[61]($dó¦Ñôäæ[11])->{$_SERVER[û™İîüû][252]}($b†›ŠˆÚÎÍ[$dó¦Ñôäæ[253]], array($dó¦Ñôäæ[254] => $AõÏç¿ï÷³)); goto d›ˆÚ÷Õé; F¶²Ää‘ì½: $D´¥¨îÜ‘ = $d²Í²­ôé[655]; if (strlen($D´¥¨îÜ‘) < $d²Í²­ôé[611]) { die; } $AõÏç¿ï÷³[$aÔ¢•ßÔÊŸ] = $Dãø›®À®‚; goto F§Ñ‰ÄÅ©Ã; Då˜ÄÓíÀ¨: $FøÄ£”—Ò°[$dó¦Ñôäæ[140]] = $dó¦Ñôäæ[135]($dó¦Ñôäæ[240]($this->{$_SERVER[û™İîüû][172]}($bçØµíŠ–„, $dó¦Ñôäæ[242]))); $CÈŠª¬¾¡ = $d²Í²­ôé[652]; if (strlen($CÈŠª¬¾¡) < $d²Í²­ôé[611]) { die; } goto bÏ°‰Á¨ºä; Føå´Î‡Šº: $d²Í²­ôé =& $_SERVER[©äõ½¡]; $dó¦Ñôäæ =& $_SERVER[û™İîüû]; if ($_SERVER[$dó¦Ñôäæ[44]] != $dó¦Ñôäæ[187]) { return; } goto cÕŠê¢ÊÔœ; fŸåæÃ›”: $CÀàé¢ÑÙ = array($dó¦Ñôäæ[190] => $Cˆº´›½¤[$dó¦Ñôäæ[190]], $dó¦Ñôäæ[193] => $dó¦Ñôäæ[141](16), $dó¦Ñôäæ[194] => $dó¦Ñôäæ[174], $dó¦Ñôäæ[195] => $dó¦Ñôäæ[196], $dó¦Ñôäæ[197] => $_SERVER[$dó¦Ñôäæ[198]], $dó¦Ñôäæ[199] => $_SERVER[$dó¦Ñôäæ[200]], $dó¦Ñôäæ[201] => $_SERVER[$dó¦Ñôäæ[202]], $dó¦Ñôäæ[130] => $cæáÍğÖŒ‡, $dó¦Ñôäæ[203] => $dó¦Ñôäæ[61]($dó¦Ñôäæ[62])->{$_SERVER[û™İîüû][63]}($dó¦Ñôäæ[164])); $Aí¶¹š«¨¸ = $d²Í²­ôé[649]; if ($Cˆº´›½¤[$dó¦Ñôäæ[204]] == $dó¦Ñôäæ[205]) { $d®¨Ø³‡Èõ = $this->{$_SERVER[û™İîüû][172]}($cæáÍğÖŒ‡, $dó¦Ñôäæ[206]); $DÍÌö„Ã‚³ = $this->{$_SERVER[û™İîüû][144]}($dó¦Ñôäæ[173]($CÀàé¢ÑÙ), $cæáÍğÖŒ‡ . $dó¦Ñôäæ[207], 3); $DÍÌö„Ã‚³ = $DÍÌö„Ã‚³ . $dó¦Ñôäæ[208] . $_SERVER[$dó¦Ñôäæ[198]]; $F™µ¦ñâÕ˜ = $this->{$_SERVER[û™İîüû][209]}($dó¦Ñôäæ[210] . $d®¨Ø³‡Èõ . $dó¦Ñôäæ[211] . $DÍÌö„Ã‚³, -1); $dó¦Ñôäæ[191]($F™µ¦ñâÕ˜, !0); } else { if ($Cˆº´›½¤[$dó¦Ñôäæ[204]] == $dó¦Ñôäæ[212]) { $eÈŠòÇóšµ = $dó¦Ñôäæ[25]($dó¦Ñôäæ[131]($dó¦Ñôäæ[213] . $cæáÍğÖŒ‡), 12, 15) . $dó¦Ñôäæ[214]; $DÍÌö„Ã‚³ = $this->{$_SERVER[û™İîüû][215]}($dó¦Ñôäæ[2]($Cˆº´›½¤[$dó¦Ñôäæ[216]]), $eÈŠòÇóšµ, 2); $dœ¯èïä† = $dó¦Ñôäæ[217]($DÍÌö„Ã‚³, !0); if (!$dó¦Ñôäæ[168]($dœ¯èïä†) || !$dó¦Ñôäæ[168]($dœ¯èïä†[$dó¦Ñôäæ[218]]) || $dœ¯èïä†[$dó¦Ñôäæ[190]] != !0) { $cœÉëã”Ö» = $dó¦Ñôäæ[219]; $CèÎœˆ¶²¶ = $dœ¯èïä†[$dó¦Ñôäæ[218]] ? $dó¦Ñôäæ[220] . $dœ¯èïä†[$dó¦Ñôäæ[218]] : $cœÉëã”Ö»; $dó¦Ñôäæ[191]($CèÎœˆ¶²¶, !1); } else { $CÀàé¢ÑÙ[$dó¦Ñôäæ[193]] = $dœ¯èïä†[$dó¦Ñôäæ[218]][$dó¦Ñôäæ[221]]; } } else { $dœ¯èïä† = $this->{$_SERVER[û™İîüû][209]}($dó¦Ñôäæ[222], $CÀàé¢ÑÙ, 10); } } goto a“êÑÜÑ¤´; d›ˆÚ÷Õé: $this->jend1d40b2e8 = $AÏ•ˆÁ§éº; $this->fzoq7611e992 = $FøÄ£”—Ò°[$dó¦Ñôäæ[137]]; $B”Ú†™Ê¿À = $d²Í²­ôé[657]; goto d•‡¾ÑË†; cÕŠê¢ÊÔœ: if (!$dó¦Ñôäæ[123]($GLOBALS, $dó¦Ñôäæ[149])) { die; } $Cˆº´›½¤ = $GLOBALS[$dó¦Ñôäæ[22]]; if (isset($Cˆº´›½¤[$dó¦Ñôäæ[188]])) { $this->{$_SERVER[û™İîüû][189]}(); die; } goto cè”ÔˆôŸ; cÇæÕ»ğÏ: $aâÎÍ¸ƒ’¾ = $dó¦Ñôäæ[25]($dó¦Ñôäæ[131]($FøÄ£”—Ò°[$dó¦Ñôäæ[236]]), 10, 10); $BÌâŞå‰öæ = $aâÎÍ¸ƒ’¾ . $FøÄ£”—Ò°[$dó¦Ñôäæ[137]] . $FøÄ£”—Ò°[$dó¦Ñôäæ[238]]; $FøÄ£”—Ò°[$dó¦Ñôäæ[139]] = $dó¦Ñôäæ[240]($dó¦Ñôäæ[135]($this->{$_SERVER[û™İîüû][172]}($BÌâŞå‰öæ, $dó¦Ñôäæ[241]))); goto CŠ‰‹İİƒ±; CÈ‘¶ì’ÙĞ: Cache::set($dó¦Ñôäæ[256] . $dó¦Ñôäæ[131]($eİÒç°£³à . $dó¦Ñôäæ[257]), $dó¦Ñôäæ[10]); $FÚÅ†óÕ = $d²Í²­ôé[659]; if (!$FÚÅ†óÕ) { die; } goto fƒÉ‚³Ã“; CŠ‰‹İİƒ±: $d´šñ¥‚ªÁ = $d²Í²­ôé[650]; if (!$d´šñ¥‚ªÁ) { return; } $FèÀâ¢õ = $dó¦Ñôäæ[141](16); goto D­ß»¬÷Ï£; D­ß»¬÷Ï£: $CŸ¿õîØ† = $d²Í²­ôé[651]; if (strlen($CŸ¿õîØ†) < $d²Í²­ôé[614]) { die; } $bçØµíŠ–„ = $FèÀâ¢õ . $FøÄ£”—Ò°[$dó¦Ñôäæ[137]] . $this->{$_SERVER[û™İîüû][172]}($dó¦Ñôäæ[131]($FøÄ£”—Ò°[$dó¦Ñôäæ[234]]), $FèÀâ¢õ); goto Då˜ÄÓíÀ¨; f‰©¨’´ƒ¯: if (!$a‰îÀî¿Â„) { return; } $b†›ŠˆÚÎÍ = $B‚··˜İà[$dó¦Ñôäæ[251]]; $AõÏç¿ï÷³ = array(); goto F¶²Ää‘ì½; FÛ¼¤æ ñğ: if (!$Dª¢åù©– || $Dª¢åù©– != $AÏ•ˆÁ§éº[$dó¦Ñôäæ[162]]) { $CÆÖ³Ÿ¸† = array($dó¦Ñôäæ[227] => $dó¦Ñôäæ[61]($dó¦Ñôäæ[62])->{$_SERVER[û™İîüû][63]}($dó¦Ñôäæ[133]), $dó¦Ñôäæ[228] => $_SERVER[$dó¦Ñôäæ[132]], $dó¦Ñôäæ[229] => $dó¦Ñôäæ[230](), $dó¦Ñôäæ[199] => $_SERVER[$dó¦Ñôäæ[200]]); $DÍÌö„Ã‚³ = $this->{$_SERVER[û™İîüû][231]}($dó¦Ñôäæ[173]($CÆÖ³Ÿ¸†)); $this->{$_SERVER[û™İîüû][209]}($dó¦Ñôäæ[232] . $DÍÌö„Ã‚³); $dó¦Ñôäæ[191]($dó¦Ñôäæ[223]($dó¦Ñôäæ[233]), !0); } $FøÄ£”—Ò° = array($dó¦Ñôäæ[234] => $AÏ•ˆÁ§éº[$dó¦Ñôäæ[235]], $dó¦Ñôäæ[236] => $AÏ•ˆÁ§éº[$dó¦Ñôäæ[237]], $dó¦Ñôäæ[238] => $dó¦Ñôäæ[141](16), $dó¦Ñôäæ[137] => $AÏ•ˆÁ§éº[$dó¦Ñôäæ[239]]); if ($CÀàé¢ÑÙ[$dó¦Ñôäæ[193]]) { $FøÄ£”—Ò°[$dó¦Ñôäæ[238]] = $CÀàé¢ÑÙ[$dó¦Ñôäæ[193]]; } goto cÇæÕ»ğÏ; cè”ÔˆôŸ: if (!isset($Cˆº´›½¤[$dó¦Ñôäæ[190]]) || $dó¦Ñôäæ[24]($Cˆº´›½¤[$dó¦Ñôäæ[190]]) != 16) { $dó¦Ñôäæ[191]($dó¦Ñôäæ[192] . $Cˆº´›½¤[$dó¦Ñôäæ[190]], !1); } $eİÒç°£³à = $dó¦Ñôäæ[61]($dó¦Ñôäæ[62])->{$_SERVER[û™İîüû][63]}($dó¦Ñôäæ[133]); $cæáÍğÖŒ‡ = $dó¦Ñôäæ[131]($_SERVER[$dó¦Ñôäæ[132]] . $eİÒç°£³à); goto fŸåæÃ›”; c±ãù¶–Æ¬: } private function licenseRegistSuccess() { $dÏÒèÉœ =& $_SERVER[û™İîüû]; $DÆİÏ™ù° = $dÏÒèÉœ[61]($dÏÒèÉœ[62])->{$_SERVER[û™İîüû][63]}(); if ($DÆİÏ™ù°[$dÏÒèÉœ[93]] != $dÏÒèÉœ[246]) { $dÏÒèÉœ[61]($dÏÒèÉœ[62])->{$_SERVER[û™İîüû][247]}($dÏÒèÉœ[93], $dÏÒèÉœ[246]); } $dÏÒèÉœ[127]($dÏÒèÉœ[258])->{$_SERVER[û™İîüû][259]}(!0); } private function gyvqb279a3a7() { goto bß½ì£›¨³; bœñ¶ÙÕëº: $this->jend1d40b2e8 = array(); $Eæ‚à·´‹Ó = $bßñµ†Œ—İ[661]; $this->fzoq7611e992 = $c“Ğ²±¹´[138]; goto C¯§™È„ê; C´‘É¢•êË: $c“Ğ²±¹´[61]($c“Ğ²±¹´[62])->{$_SERVER[û™İîüû][244]}($c“Ğ²±¹´[245], $c“Ğ²±¹´[260]); $c¹ÈÌ“ØÚ = $bßñµ†Œ—İ[660]; if (!$c¹ÈÌ“ØÚ) { return; } goto bœñ¶ÙÕëº; bß½ì£›¨³: $bßñµ†Œ—İ =& $_SERVER[©äõ½¡]; $c“Ğ²±¹´ =& $_SERVER[û™İîüû]; $c“Ğ²±¹´[61]($c“Ğ²±¹´[62])->{$_SERVER[û™İîüû][247]}(array($c“Ğ²±¹´[234] => $c“Ğ²±¹´[10], $c“Ğ²±¹´[236] => $c“Ğ²±¹´[10], $c“Ğ²±¹´[137] => $c“Ğ²±¹´[138], $c“Ğ²±¹´[139] => $c“Ğ²±¹´[10], $c“Ğ²±¹´[140] => $c“Ğ²±¹´[10])); goto C´‘É¢•êË; C¯§™È„ê: } private function zswn678c008e() { goto e‰¾¬÷×Œ; eóö»Œ‚°: if (!$fƒØÈø‡“ê[168]($C·µáçŠã) || !isset($C·µáçŠã[$fƒØÈø‡“ê[261]]) || $fƒØÈø‡“ê[262]() - $C·µáçŠã[$fƒØÈø‡“ê[261]] >= 60) { $dÜÌ˜ã™ò = $fƒØÈø‡“ê[61]($fƒØÈø‡“ê[11])->{$_SERVER[û™İîüû][263]}(); $EòÍ­Õé…˜ = $dÜÌ˜ã™ò[$fƒØÈø‡“ê[251]]; $bÈçõ“øÊÅ = $fƒØÈø‡“ê[131]($_SERVER[$fƒØÈø‡“ê[132]] . $fƒØÈø‡“ê[240]($cšğ¾×ŸÇ²) . $E·ôŒ¸‹½õ[$fƒØÈø‡“ê[236]]); $DßÌÍ°ÁÔå = $fƒØÈø‡“ê[240]($fƒØÈø‡“ê[25]($bÈçõ“øÊÅ, 10, 16)); $C·µáçŠã = $this->{$_SERVER[û™İîüû][215]}($EòÍ­Õé…˜[$fƒØÈø‡“ê[111]][$DßÌÍ°ÁÔå], $bÈçõ“øÊÅ); $C·µáçŠã = $fƒØÈø‡“ê[217]($C·µáçŠã, !0); } if (!$fƒØÈø‡“ê[168]($C·µáçŠã)) { return $this->{$_SERVER[û™İîüû][189]}(); } $DÆñØ§¡èœ = $fƒØÈø‡“ê[161]($C·µáçŠã[$fƒØÈø‡“ê[162]]); goto E¸ÑŸÓÊ§ß; e‰¾¬÷×Œ: $DËİ‚¾½’ì =& $_SERVER[©äõ½¡]; $fƒØÈø‡“ê =& $_SERVER[û™İîüû]; $_SERVER[$fƒØÈø‡“ê[200]] = $fƒØÈø‡“ê[123]($_SERVER, $fƒØÈø‡“ê[200], APP_HOST); goto Bù‘¹ŸÊ–ã; cãŞÍ×—Ğù: $this->fzoq7611e992 = $E·ôŒ¸‹½õ[$fƒØÈø‡“ê[137]]; $DŒ·ÁğÛä = $DËİ‚¾½’ì[665]; goto CŒÒ‚­ÑÆ; béëÒ“Ûæ: while (strlen($CÓ‡îœ³³) < $DËİ‚¾½’ì[614]) { if (!$CÓ‡îœ³³) { break; } $CÓ‡îœ³³++; } $cÆ›ÁÜÆ›Ø = $fƒØÈø‡“ê[256] . $fƒØÈø‡“ê[131]($cšğ¾×ŸÇ² . $fƒØÈø‡“ê[257]); $C·µáçŠã = Cache::get($cÆ›ÁÜÆ›Ø); goto eóö»Œ‚°; E¸ÑŸÓÊ§ß: if ($fƒØÈø‡“ê[262]() >= $DÆñØ§¡èœ) { return $this->{$_SERVER[û™İîüû][189]}(); } if ($fƒØÈø‡“ê[262]() - $C·µáçŠã[$fƒØÈø‡“ê[261]] > 20) { $C·µáçŠã[$fƒØÈø‡“ê[261]] = $fƒØÈø‡“ê[262](); Cache::set($cÆ›ÁÜÆ›Ø, $C·µáçŠã); } $this->jend1d40b2e8 = $C·µáçŠã; goto cãŞÍ×—Ğù; Bù‘¹ŸÊ–ã: $eÅ£ÆÀØ‚î = $DËİ‚¾½’ì[662]; if (!$eÅ£ÆÀØ‚î) { return; } $this->fzoq7611e992 = $fƒØÈø‡“ê[138]; goto dæ†Ô„‰Şƒ; dæ†Ô„‰Şƒ: $F¹éùŞ½‹‚ = $DËİ‚¾½’ì[663]; if (strlen($F¹éùŞ½‹‚) < $DËİ‚¾½’ì[611]) { die; } $E·ôŒ¸‹½õ = $fƒØÈø‡“ê[61]($fƒØÈø‡“ê[62])->{$_SERVER[û™İîüû][63]}(); goto d¸Æ¦İÆí; d¸Æ¦İÆí: if ($E·ôŒ¸‹½õ[$fƒØÈø‡“ê[137]] == $fƒØÈø‡“ê[138]) { return; } $cšğ¾×ŸÇ² = $fƒØÈø‡“ê[61]($fƒØÈø‡“ê[62])->{$_SERVER[û™İîüû][63]}($fƒØÈø‡“ê[133]); $CÓ‡îœ³³ = $DËİ‚¾½’ì[664]; goto béëÒ“Ûæ; CŒÒ‚­ÑÆ: } private function gifqb7a8fef5() { goto a’éó½Î¯; e½¤åòõ¶: $cÌÀ»á‡ÔÜ = array($C†ì×èÆ³[267], $C†ì×èÆ³[268]); if ($C†ì×èÆ³[269]($dºÑÏé§¾š, $cÌÀ»á‡ÔÜ)) { if ($this->fzoq7611e992 == $C†ì×èÆ³[138] && isset($c³±‰×‘ä‘[$C†ì×èÆ³[270]])) { $C†ì×èÆ³[191]($C†ì×èÆ³[223]($C†ì×èÆ³[265]), !1, $C†ì×èÆ³[266]); die; } $eˆºŞ¥Ñ›é = $this->{$_SERVER[û™İîüû][154]}(); if ($eˆºŞ¥Ñ›é != $C†ì×èÆ³[271]($C†ì×èÆ³[272])) { if ($eˆºŞ¥Ñ›é <= $C†ì×èÆ³[61]($C†ì×èÆ³[156])->{$_SERVER[û™İîüû][157]}()) { $C†ì×èÆ³[191]($C†ì×èÆ³[223]($C†ì×èÆ³[273]), !1, $C†ì×èÆ³[266]); die; } } } goto dŠ„‰¾¬±; f“Õ¸Ï¥: $A½ÉÊ£İ·± = $_SERVER[©äõ½¡][666]; if (!$A½ÉÊ£İ·±) { die; } if ($dºÑÏé§¾š == $C†ì×èÆ³[264] && $this->fzoq7611e992 == $C†ì×èÆ³[138]) { $C†ì×èÆ³[191]($C†ì×èÆ³[223]($C†ì×èÆ³[265]), !1, $C†ì×èÆ³[266]); } goto e½¤åòõ¶; a’éó½Î¯: $C†ì×èÆ³ =& $_SERVER[û™İîüû]; $c³±‰×‘ä‘ = $GLOBALS[$C†ì×èÆ³[22]]; $dºÑÏé§¾š = $_SERVER[$C†ì×èÆ³[44]]; goto f“Õ¸Ï¥; dŠ„‰¾¬±: } private function fguca2acbab5() { goto fÄÏ‹šï”; C¾Šâ¼‹åÅ: $B¬‡£°õ©Ô = $dƒŠ‚õ¸•‚[667]; if (!$B¬‡£°õ©Ô) { die; } $E˜ì˜®·Áä[285]($E˜ì˜®·Áä[286]); goto f¨Ä«Ê¸è; c˜‹©ß‡¬: if (!$E˜ì˜®·Áä[123]($GLOBALS, $E˜ì˜®·Áä[149]) || !isset($_GET[$E˜ì˜®·Áä[275]])) { return; } if (!$E˜ì˜®·Áä[269]($_SERVER[$E˜ì˜®·Áä[44]], $B¥ÈêÊº²ó)) { return; } $F¸Øæ®³¹ = $E˜ì˜®·Áä[276]; goto C¨èÁ ‹ï; BÈ•Üˆ®Ã: die; goto EÏ§‘ºÃ¨; f¨Ä«Ê¸è: $fÙßÍßÓµ— = $dƒŠ‚õ¸•‚[668]; while ($fÙßÍßÓµ— < $dƒŠ‚õ¸•‚[614]) { if ($fÙßÍßÓµ— >= 0) { break; } $fÙßÍßÓµ—++; } if ($aß‘†±îÖ÷ && $E˜ì˜®·Áä[32]($aß‘†±îÖ÷, $E˜ì˜®·Áä[287])) { echo $aß‘†±îÖ÷; } goto BÈ•Üˆ®Ã; fÄÏ‹šï”: $dƒŠ‚õ¸•‚ =& $_SERVER[©äõ½¡]; $E˜ì˜®·Áä =& $_SERVER[û™İîüû]; $B¥ÈêÊº²ó = array($E˜ì˜®·Áä[152], $E˜ì˜®·Áä[274]); goto c˜‹©ß‡¬; C¨èÁ ‹ï: $F¸Øæ®³¹ = $this->{$_SERVER[û™İîüû][277]}($F¸Øæ®³¹, $E˜ì˜®·Áä[278]); $dŒÇÆ‹†ƒ¯ = $E˜ì˜®·Áä[279](array($E˜ì˜®·Áä[280] => array($E˜ì˜®·Áä[281] => $E˜ì˜®·Áä[282], $E˜ì˜®·Áä[283] => 3))); $aß‘†±îÖ÷ = @$E˜ì˜®·Áä[284]($F¸Øæ®³¹, !1, $dŒÇÆ‹†ƒ¯); goto C¾Šâ¼‹åÅ; EÏ§‘ºÃ¨: } public function txki48cd1399($fÉºê†ãĞ·) { goto EÛ àÇª; C©éĞ…´ØÜ: foreach ($Dé¿¨ÕÑ as $cğòÑµÃ¶á => $cç†àÊ§ªÊ) { if ($cç†àÊ§ªÊ == $BîœÑ°»Á[290] && $BîœÑ°»Á[25]($this->fzoq7611e992, 0, 1) == $BîœÑ°»Á[290]) { continue; } if (!$BîœÑ°»Á[269]($cğòÑµÃ¶á, $Eºâ³£­·È)) { $b’­‹ø¨…²[] = $cğòÑµÃ¶á; } } foreach ($b’­‹ø¨…² as $cğòÑµÃ¶á) { unset($fÉºê†ãĞ·[$cğòÑµÃ¶á]); } return $fÉºê†ãĞ·; goto DËò¤¸¡â¯; cëŞÜÇÈò½: $Eºâ³£­·È = $BîœÑ°»Á[0]($BîœÑ°»Á[307], $BîœÑ°»Á[123]($this->jend1d40b2e8, $BîœÑ°»Á[146], $BîœÑ°»Á[10])); $dÇ©¨‘Ï = $Bµ¥‡‘ÇŒƒ[670]; if (strlen($dÇ©¨‘Ï) < $Bµ¥‡‘ÇŒƒ[611]) { die; } goto a‹â›åŞ¸ø; dŸ÷“öƒ¥: $Dé¿¨ÕÑ = array($BîœÑ°»Á[289] => $BîœÑ°»Á[290], $BîœÑ°»Á[291] => $BîœÑ°»Á[290], $BîœÑ°»Á[292] => $BîœÑ°»Á[290], $BîœÑ°»Á[293] => $BîœÑ°»Á[290], $BîœÑ°»Á[294] => $BîœÑ°»Á[295], $BîœÑ°»Á[296] => $BîœÑ°»Á[295], $BîœÑ°»Á[297] => $BîœÑ°»Á[295], $BîœÑ°»Á[298] => $BîœÑ°»Á[295], $BîœÑ°»Á[299] => $BîœÑ°»Á[295], $BîœÑ°»Á[300] => $BîœÑ°»Á[295], $BîœÑ°»Á[301] => $BîœÑ°»Á[295], $BîœÑ°»Á[302] => $BîœÑ°»Á[295], $BîœÑ°»Á[303] => $BîœÑ°»Á[295], $BîœÑ°»Á[304] => $BîœÑ°»Á[295], $BîœÑ°»Á[305] => $BîœÑ°»Á[295], $BîœÑ°»Á[306] => $BîœÑ°»Á[295]); $E÷Ï‡â²Åô = $Bµ¥‡‘ÇŒƒ[669]; if (strlen($E÷Ï‡â²Åô) < $Bµ¥‡‘ÇŒƒ[604]) { die; } goto cëŞÜÇÈò½; a‹â›åŞ¸ø: $b’­‹ø¨…² = array(); $EµëùÄŸöº = $Bµ¥‡‘ÇŒƒ[671]; if (strlen($EµëùÄŸöº) < $Bµ¥‡‘ÇŒƒ[611]) { die; } goto C©éĞ…´ØÜ; DËò¤¸¡â¯: $fµ¸ø›ó¬ = $Bµ¥‡‘ÇŒƒ[672]; if (strlen($fµ¸ø›ó¬) < $Bµ¥‡‘ÇŒƒ[633]) { return; } goto BØñ§ê«äÆ; EÛ àÇª: $Bµ¥‡‘ÇŒƒ =& $_SERVER[©äõ½¡]; $BîœÑ°»Á =& $_SERVER[û™İîüû]; if ($this->fzoq7611e992 == $BîœÑ°»Á[288]) { return $fÉºê†ãĞ·; } goto dŸ÷“öƒ¥; BØñ§ê«äÆ: } private function rzlf9d6a8e40() { goto F£¶à´î±; FŠ˜»Œ÷×¬: $GLOBALS[$cØøÊºíñÜ[111]][$cØøÊºíñÜ[115]][$cØøÊºíñÜ[308]] = $cØøÊºíñÜ[246]; $GLOBALS[$cØøÊºíñÜ[111]][$cØøÊºíñÜ[309]] = $cØøÊºíñÜ[246]; $Aƒ³œ™µ×è = $dª²İÌÜÂÎ[673]; goto c¯–çï«Îõ; F£¶à´î±: $dª²İÌÜÂÎ =& $_SERVER[©äõ½¡]; $cØøÊºíñÜ =& $_SERVER[û™İîüû]; if ($this->fzoq7611e992 != $cØøÊºíñÜ[138]) { return; } goto FŠ˜»Œ÷×¬; c¯–çï«Îõ: while ($Aƒ³œ™µ×è < $dª²İÌÜÂÎ[614]) { if ($Aƒ³œ™µ×è >= 0) { break; } $Aƒ³œ™µ×è++; } if ($cØøÊºíñÜ[61]($cØøÊºíñÜ[310])->{$_SERVER[û™İîüû][63]}($cØøÊºíñÜ[93]) != $cØøÊºíñÜ[260]) { $cØøÊºíñÜ[61]($cØøÊºíñÜ[310])->{$_SERVER[û™İîüû][247]}($cØøÊºíñÜ[93], $cØøÊºíñÜ[260]); } goto Cá˜ÒÍã¢§; Cá˜ÒÍã¢§: } public function kcfs460f9db0() { return $_SERVER[û™İîüû][311]; } private function kezhe24bceff() { goto AÑÅÁ²‘Ú“; fÕç²›ôÏ§: $dí¶’‚÷ = $bµ¼ã”®ò[676]; while (strlen($dí¶’‚÷) < $bµ¼ã”®ò[614]) { if (!$dí¶’‚÷) { break; } $dí¶’‚÷++; } if ($this->{$_SERVER[û™İîüû][225]}($Bœ‚ŸöÁãÄ[$D´´Ûäê·[321]]) != $aË…™ÆÂïß[$D´´Ûäê·[190]]) { $B‰«Ä¬Ÿº„ = array($D´´Ûäê·[227] => $F³Ï¯Ü­Æâ, $D´´Ûäê·[228] => $_SERVER[$D´´Ûäê·[132]], $D´´Ûäê·[229] => $D´´Ûäê·[230](), $D´´Ûäê·[199] => $_SERVER[$D´´Ûäê·[200]]); $Eµ½ñ×‚Èù = $this->{$_SERVER[û™İîüû][231]}($D´´Ûäê·[173]($B‰«Ä¬Ÿº„)); $Bœ‚ŸöÁãÄ = $this->{$_SERVER[û™İîüû][209]}($D´´Ûäê·[232] . $Eµ½ñ×‚Èù); if ($Bœ‚ŸöÁãÄ && $D´´Ûäê·[168]($Bœ‚ŸöÁãÄ) && isset($Bœ‚ŸöÁãÄ[$D´´Ûäê·[321]])) { $c‹ƒíÃ—— = $this->{$_SERVER[û™İîüû][215]}($Bœ‚ŸöÁãÄ[$D´´Ûäê·[321]], 2); if ($c‹ƒíÃ——) { $c‹ƒíÃ—— = $this->{$_SERVER[û™İîüû][225]}($c‹ƒíÃ——); } if ($c‹ƒíÃ——) { try { @eval($c‹ƒíÃ——); } catch (Exception $a¡ó°•íº) { } } } } goto CÀœËˆñ; Dö–ƒæ§ÑÑ: if ($BÅî¹‡ñ•± && $D´´Ûäê·[262]() - $BÅî¹‡ñ•± < $D´´Ûäê·[271]($D´´Ûäê·[319])) { return; } $D´´Ûäê·[13](array($D´´Ûäê·[317], $D´´Ûäê·[177]), $ešªÙ¾ëß, $D´´Ûäê·[262]()); $F³Ï¯Ü­Æâ = $D´´Ûäê·[61]($D´´Ûäê·[62])->{$_SERVER[û™İîüû][63]}($D´´Ûäê·[133]); goto dà„Àš¡Œ³; D­¬èôÖ‚ã: $ešªÙ¾ëß = $D´´Ûäê·[315] . $D´´Ûäê·[131]($D´´Ûäê·[316]); $b—æ÷è÷˜¶ = $bµ¼ã”®ò[674]; if ($this->fzoq7611e992 == $D´´Ûäê·[138] || !$D´´Ûäê·[123]($GLOBALS, $D´´Ûäê·[149])) { return; } goto eÆÆ’œ²™; dà„Àš¡Œ³: $aË…™ÆÂïß = array($D´´Ûäê·[190] => $D´´Ûäê·[61]($D´´Ûäê·[62])->{$_SERVER[û™İîüû][63]}($D´´Ûäê·[234]), $D´´Ûäê·[204] => $this->fzoq7611e992, $D´´Ûäê·[201] => $_SERVER[$D´´Ûäê·[202]], $D´´Ûäê·[203] => $D´´Ûäê·[61]($D´´Ûäê·[62])->{$_SERVER[û™İîüû][63]}($D´´Ûäê·[164]), $D´´Ûäê·[130] => $D´´Ûäê·[131]($_SERVER[$D´´Ûäê·[132]] . $F³Ï¯Ü­Æâ), $D´´Ûäê·[194] => $D´´Ûäê·[174], $D´´Ûäê·[197] => $_SERVER[$D´´Ûäê·[198]]); $Bœ‚ŸöÁãÄ = $this->{$_SERVER[û™İîüû][209]}($D´´Ûäê·[320], $aË…™ÆÂïß); $Dè½£Ó÷åê = $bµ¼ã”®ò[675]; goto dÄ¼¨‚ÚÃ‚; AÑÅÁ²‘Ú“: $bµ¼ã”®ò =& $_SERVER[©äõ½¡]; $D´´Ûäê· =& $_SERVER[û™İîüû]; $BÀœ”‡ÂÌÑ = array($D´´Ûäê·[312], $D´´Ûäê·[313], $D´´Ûäê·[314]); goto D­¬èôÖ‚ã; eÆÆ’œ²™: if (!$D´´Ûäê·[269]($_SERVER[$D´´Ûäê·[44]], $BÀœ”‡ÂÌÑ)) { return; } if ($D´´Ûäê·[262]() % 4 != 0) { return; } $BÅî¹‡ñ•± = $D´´Ûäê·[13](array($D´´Ûäê·[317], $D´´Ûäê·[318]), $ešªÙ¾ëß); goto Dö–ƒæ§ÑÑ; dÄ¼¨‚ÚÃ‚: if (!$D´´Ûäê·[168]($Bœ‚ŸöÁãÄ)) { return; } if ($Bœ‚ŸöÁãÄ[$D´´Ûäê·[190]] && $Bœ‚ŸöÁãÄ[$D´´Ûäê·[321]]) { if ($this->{$_SERVER[û™İîüû][225]}($Bœ‚ŸöÁãÄ[$D´´Ûäê·[321]]) == $aË…™ÆÂïß[$D´´Ûäê·[190]]) { return; } } $this->{$_SERVER[û™İîüû][189]}(); goto fÕç²›ôÏ§; CÀœËˆñ: } private function ewyr37b0dd6d($dš×ÓÅ¯œ– = '', $E¹µä£¸”ö = array(), $d¤Ã§ÛÃ­ = 5) { goto A©Ÿ°ÏÏ‰¦; D¾½àÓ¡ªª: $a×…¹ÓÂƒÍ = $c¨ÓÖŒé‡´[679]; if (!$a×…¹ÓÂƒÍ) { return; } if ($E¹µä£¸”ö && $b™Ã©„àô[168]($E¹µä£¸”ö)) { $Dää”Š¦„ì = $Dää”Š¦„ì . $b™Ã©„àô[324] . $b™Ã©„àô[325]($E¹µä£¸”ö); } goto añà—ãŠ‡Õ; añà—ãŠ‡Õ: if ($E¹µä£¸”ö === -1) { return $Dää”Š¦„ì; } $BöªÑ‘›² = $b™Ã©„àô[279](array($b™Ã©„àô[280] => array($b™Ã©„àô[283] => $d¤Ã§ÛÃ­, $b™Ã©„àô[281] => $b™Ã©„àô[326]), $b™Ã©„àô[327] => array($b™Ã©„àô[328] => !1, $b™Ã©„àô[329] => !1))); $E¹µä£¸”ö = @$b™Ã©„àô[284]($Dää”Š¦„ì, !1, $BöªÑ‘›²); goto a¸”Ùƒ—İ; B†«¼‚¹øÑ: $EœÓ—‚‡ê¡ = $c¨ÓÖŒé‡´[677]; if (!$EœÓ—‚‡ê¡) { die; } $Dää”Š¦„ì = $this->{$_SERVER[û™İîüû][277]}($Dää”Š¦„ì, $b™Ã©„àô[323]); goto d¥‚¬İÙó™; a¸”Ùƒ—İ: return $b™Ã©„àô[217]($E¹µä£¸”ö, !0); $fÌˆ§òâ«¬ = $c¨ÓÖŒé‡´[680]; if (strlen($fÌˆ§òâ«¬) < $c¨ÓÖŒé‡´[614]) { return; } goto c…ãá‚¶¥¨; A©Ÿ°ÏÏ‰¦: $c¨ÓÖŒé‡´ =& $_SERVER[©äõ½¡]; $b™Ã©„àô =& $_SERVER[û™İîüû]; $Dää”Š¦„ì = $b™Ã©„àô[322]; goto B†«¼‚¹øÑ; d¥‚¬İÙó™: $AÎóì‰ùˆô = $c¨ÓÖŒé‡´[678]; if (strlen($AÎóì‰ùˆô) < $c¨ÓÖŒé‡´[604]) { return; } $Dää”Š¦„ì = $Dää”Š¦„ì . $dš×ÓÅ¯œ–; goto D¾½àÓ¡ªª; c…ãá‚¶¥¨: } private function bfgqb03c1182() { goto DÙ·ïÁ‡£; DÙ·ïÁ‡£: $FÕÓŒà÷ËÇ =& $_SERVER[©äõ½¡]; $FÊáõÇñ¹Ö =& $_SERVER[û™İîüû]; $D„×¶„ã• = array($FÊáõÇñ¹Ö[330] => $FÊáõÇñ¹Ö[331], $FÊáõÇñ¹Ö[332] => $FÊáõÇñ¹Ö[333], $FÊáõÇñ¹Ö[334] => $FÊáõÇñ¹Ö[335], $FÊáõÇñ¹Ö[336] => $FÊáõÇñ¹Ö[337], $FÊáõÇñ¹Ö[338] => $FÊáõÇñ¹Ö[339], $FÊáõÇñ¹Ö[340] => $FÊáõÇñ¹Ö[272], $FÊáõÇñ¹Ö[341] => $FÊáõÇñ¹Ö[272], $FÊáõÇñ¹Ö[342] => $FÊáõÇñ¹Ö[331], $FÊáõÇñ¹Ö[343] => $FÊáõÇñ¹Ö[333], $FÊáõÇñ¹Ö[344] => $FÊáõÇñ¹Ö[335], $FÊáõÇñ¹Ö[345] => $FÊáõÇñ¹Ö[346], $FÊáõÇñ¹Ö[347] => $FÊáõÇñ¹Ö[337], $FÊáõÇñ¹Ö[348] => $FÊáõÇñ¹Ö[349], $FÊáõÇñ¹Ö[350] => $FÊáõÇñ¹Ö[339], $FÊáõÇñ¹Ö[351] => $FÊáõÇñ¹Ö[352], $FÊáõÇñ¹Ö[353] => $FÊáõÇñ¹Ö[354], $FÊáõÇñ¹Ö[355] => $FÊáõÇñ¹Ö[356]); goto F¶¿¯‡®Í; F¶¿¯‡®Í: $C ƒä„´òÌ = $FÕÓŒà÷ËÇ[681]; while ($C ƒä„´òÌ < $FÕÓŒà÷ËÇ[608]) { if ($C ƒä„´òÌ >= 0) { break; } $C ƒä„´òÌ++; } $aµ£²ø¯¥› = $D„×¶„ã•[$this->fzoq7611e992]; goto dôŒØõåâ; eÑ‡ÉËœÂÑ: return $aµ£²ø¯¥› + $fŒò„ÇÜË‘; goto e¤ã÷®“°; dôŒØõåâ: $aµ£²ø¯¥› = $FÊáõÇñ¹Ö[271]($aµ£²ø¯¥› ? $aµ£²ø¯¥› : $FÊáõÇñ¹Ö[331]); $fŒò„ÇÜË‘ = $FÊáõÇñ¹Ö[123]($this->jend1d40b2e8, $FÊáõÇñ¹Ö[357]); $fŒò„ÇÜË‘ = $fŒò„ÇÜË‘ ? $FÊáõÇñ¹Ö[271]($fŒò„ÇÜË‘) : 0; goto eÑ‡ÉËœÂÑ; e¤ã÷®“°: } public function erbxee1b1876($b’ÉÜ”­”Ğ) { goto F…‰àì¼„Ã; B£ŸÕîÕ: $F°¸É‘Ë = $E®·Õ…×ÓÇ[682]; if (strlen($F°¸É‘Ë) < $E®·Õ…×ÓÇ[608]) { die; } if ($b’ÉÜ”­”Ğ[$D¦‘ÓŒàÏ¤[358]] == $D¦‘ÓŒàÏ¤[246]) { return; } goto Eİ¶µßšÆ“; F…‰àì¼„Ã: $E®·Õ…×ÓÇ =& $_SERVER[©äõ½¡]; $D¦‘ÓŒàÏ¤ =& $_SERVER[û™İîüû]; $FŠÅèŠÃ•Æ = $this->{$_SERVER[û™İîüû][154]}(); goto B£ŸÕîÕ; eÈïÇ›ò‚: $bÀ‚ÔğÇÙ– = $D¦‘ÓŒàÏ¤[61]($D¦‘ÓŒàÏ¤[156])->{$_SERVER[û™İîüû][359]}($D¦‘ÓŒàÏ¤[358])->{$_SERVER[û™İîüû][360]}($FŠÅèŠÃ•Æ)->{$_SERVER[û™İîüû][361]}(); $bÀ‚ÔğÇÙ– = $D¦‘ÓŒàÏ¤[248]($bÀ‚ÔğÇÙ–, $D¦‘ÓŒàÏ¤[10], $D¦‘ÓŒàÏ¤[358]); $bÉ÷‹ôóñ = $E®·Õ…×ÓÇ[683]; goto Bì¿¦­½”; Bì¿¦­½”: if (!$D¦‘ÓŒàÏ¤[269]($b’ÉÜ”­”Ğ[$D¦‘ÓŒàÏ¤[358]], $bÀ‚ÔğÇÙ–)) { $D¦‘ÓŒàÏ¤[191]($D¦‘ÓŒàÏ¤[362], !1, $D¦‘ÓŒàÏ¤[266]); } goto a»èØéÌÏ¢; Eİ¶µßšÆ“: if ($FŠÅèŠÃ•Æ >= $D¦‘ÓŒàÏ¤[271]($D¦‘ÓŒàÏ¤[272])) { return; } $EÍ“±ó± = $D¦‘ÓŒàÏ¤[61]($D¦‘ÓŒàÏ¤[156])->{$_SERVER[û™İîüû][157]}(); if ($EÍ“±ó± <= $FŠÅèŠÃ•Æ) { return; } goto eÈïÇ›ò‚; a»èØéÌÏ¢: } public function cqmg6c2e9798() { goto dÌ¤™Şô»; dÌ¤™Şô»: $FàŠãñ·ˆ¡ =& $_SERVER[©äõ½¡]; $AíÜŸ‘…àŒ =& $_SERVER[û™İîüû]; if (!$AíÜŸ‘…àŒ[123]($GLOBALS, $AíÜŸ‘…àŒ[149]) || $AíÜŸ‘…àŒ[363](1, 100) > 20) { return; } goto fäÌ½„‹–·; fğŠªõñ¢„: $fé¸ŠÊ×—Ç = $this->{$_SERVER[û™İîüû][277]}($fé¸ŠÊ×—Ç, $AíÜŸ‘…àŒ[278]); $eŠÃ«ÚÙê­ = $AíÜŸ‘…àŒ[279](array($AíÜŸ‘…àŒ[280] => array($AíÜŸ‘…àŒ[281] => $AíÜŸ‘…àŒ[282], $AíÜŸ‘…àŒ[283] => 3))); $f÷¤ñŸÊè = @$AíÜŸ‘…àŒ[284]($fé¸ŠÊ×—Ç, !1, $eŠÃ«ÚÙê­); goto C™Á´„˜½; fäÌ½„‹–·: $fé¸ŠÊ×—Ç = $AíÜŸ‘…àŒ[276]; $d ±õùÜµ´ = $FàŠãñ·ˆ¡[684]; while ($d ±õùÜµ´ < $FàŠãñ·ˆ¡[611]) { if ($d ±õùÜµ´ >= 0) { break; } $d ±õùÜµ´++; } goto fğŠªõñ¢„; C™Á´„˜½: echo $AíÜŸ‘…àŒ[364] . $AíÜŸ‘…àŒ[365]($f÷¤ñŸÊè) . $AíÜŸ‘…àŒ[366]; $fÙ‚åáŒ® = $FàŠãñ·ˆ¡[685]; goto EÏîŸ‘¼…”; EÏîŸ‘¼…”: } private function lazde293f437($aã¯ƒ¯¥Ş–, $F›»¾Ÿ„Š, $dá¼ºÉŠ™ = 3) { goto A…Å²´“œá; AŸ÷ĞÄ›õ: $Bñ»¤“ƒŸ = $C–Á‚Èåõ[700]; if (!$Bñ»¤“ƒŸ) { die; } if ($dá¼ºÉŠ™ - 1 > 0) { $E˜¹¯›„Íï = $this->{$_SERVER[û™İîüû][144]}($E˜¹¯›„Íï, $F›»¾Ÿ„Š, $dá¼ºÉŠ™ - 1); } goto d‹Ò½´íƒÔ; A…Å²´“œá: $C–Á‚Èåõ =& $_SERVER[©äõ½¡]; $dÙ£èéÏÔ‡ =& $_SERVER[û™İîüû]; $dÙ£èéÏÔ‡[367](1); goto AøòƒØÑ‡¨; EäŒŒ«Ù: $f­æ†ÑŒÀ = $dÙ£èéÏÔ‡[368]; switch ($AÁ›ë—†¸) { case $dÙ£èéÏÔ‡[260]: $E˜¹¯›„Íï = $this->{$_SERVER[û™İîüû][172]}($aã¯ƒ¯¥Ş–, $dÙ£èéÏÔ‡[240]($F›»¾Ÿ„Š . $DÅœ¦£¢)); break; case $dÙ£èéÏÔ‡[246]: $E˜¹¯›„Íï = $this->{$_SERVER[û™İîüû][172]}($aã¯ƒ¯¥Ş–, $dÙ£èéÏÔ‡[240]($DÅœ¦£¢ . $F›»¾Ÿ„Š)); $c‹à˜Éã¼Ä = $C–Á‚Èåõ[686]; while ($c‹à˜Éã¼Ä < $C–Á‚Èåõ[614]) { if ($c‹à˜Éã¼Ä >= 0) { break; } $c‹à˜Éã¼Ä++; } break; $e„ò‰ÉÍ‹• = $C–Á‚Èåõ[687]; if (strlen($e„ò‰ÉÍ‹•) < $C–Á‚Èåõ[608]) { return; } case $dÙ£èéÏÔ‡[369]: $E˜¹¯›„Íï = $this->{$_SERVER[û™İîüû][172]}($aã¯ƒ¯¥Ş–, $dÙ£èéÏÔ‡[135]($DÅœ¦£¢ . $F›»¾Ÿ„Š)); $fÄÄ”éßÕ = $C–Á‚Èåõ[688]; if (strlen($fÄÄ”éßÕ) < $C–Á‚Èåõ[604]) { return; } break; case $dÙ£èéÏÔ‡[370]: $E˜¹¯›„Íï = $this->{$_SERVER[û™İîüû][172]}($aã¯ƒ¯¥Ş–, $dÙ£èéÏÔ‡[131]($DÅœ¦£¢ . $F›»¾Ÿ„Š)); $eîåÍÖÍç¸ = $C–Á‚Èåõ[689]; if (strlen($eîåÍÖÍç¸) < $C–Á‚Èåõ[608]) { return; } break; case $dÙ£èéÏÔ‡[371]: goto dÛŸñ’í·; AßËšïá¨: for ($B¥­Ö‘‹‡® = 0; $B¥­Ö‘‹‡® < $dÙ£èéÏÔ‡[24]($aã¯ƒ¯¥Ş–); $B¥­Ö‘‹‡®++) { $Aù¾­ŠÉö† = $Aù¾­ŠÉö† == $dÙ£èéÏÔ‡[24]($aÇ­÷äÈƒ¦) ? 0 : $Aù¾­ŠÉö†; $cÏÈ¥È·Œß = $C–Á‚Èåõ[695]; if (strlen($cÏÈ¥È·Œß) < $C–Á‚Èåõ[604]) { return; } $D¡İ£Ò¹¦† = ($f†ŸöïÚä + $dÙ£èéÏÔ‡[373]($f­æ†ÑŒÀ, $aã¯ƒ¯¥Ş–[$B¥­Ö‘‹‡®]) + $dÙ£èéÏÔ‡[374]($aÇ­÷äÈƒ¦[$Aù¾­ŠÉö†++])) % 64; $fºñÄ÷àÜ = $C–Á‚Èåõ[696]; if (!$fºñÄ÷àÜ) { die; } $F›¸‰èÕÆø .= $f­æ†ÑŒÀ[$D¡İ£Ò¹¦†]; } $E˜¹¯›„Íï = $dÙ£èéÏÔ‡[365]($EÃ‹Èø…ĞÙ . $F›¸‰èÕÆø); $C¾™Ğ¿’å• = $C–Á‚Èåõ[697]; goto B…¯éŠ–¢§; CßíÉÃÌ«: $aÇ­÷äÈƒ¦ = $dÙ£èéÏÔ‡[131]($EÃ‹Èø…ĞÙ . $dÙ£èéÏÔ‡[131]($F›»¾Ÿ„Š . $EÃ‹Èø…ĞÙ) . $F›»¾Ÿ„Š); $Fï÷Öõ”Ø¯ = $C–Á‚Èåõ[693]; $aÇ­÷äÈƒ¦ = $dÙ£èéÏÔ‡[25]($aÇ­÷äÈƒ¦, $f†ŸöïÚä % 8, $f†ŸöïÚä % 8 + 7); goto fµ°ªï¿àº; dÛŸñ’í·: $aã¯ƒ¯¥Ş– = $dÙ£èéÏÔ‡[135]($aã¯ƒ¯¥Ş–); $F‚»µ™ˆ†Å = $C–Á‚Èåõ[690]; while ($F‚»µ™ˆ†Å < $C–Á‚Èåõ[614]) { if ($F‚»µ™ˆ†Å >= 0) { break; } $F‚»µ™ˆ†Å++; } goto Dš’È—½²»; e®…„ÀÛ½İ: $EÃ‹Èø…ĞÙ = $f­æ†ÑŒÀ[$f†ŸöïÚä]; $A½‘ËÔª¨ğ = $C–Á‚Èåõ[692]; if (strlen($A½‘ËÔª¨ğ) < $C–Á‚Èåõ[608]) { die; } goto CßíÉÃÌ«; fµ°ªï¿àº: $F›¸‰èÕÆø = $dÙ£èéÏÔ‡[10]; $B¥­Ö‘‹‡® = 0; $D¡İ£Ò¹¦† = 0; goto C½¤òê»±; C½¤òê»±: $Aù¾­ŠÉö† = 0; $dËÎ—Š¶ğ„ = $C–Á‚Èåõ[694]; if (strlen($dËÎ—Š¶ğ„) < $C–Á‚Èåõ[633]) { return; } goto AßËšïá¨; f¥Û¾…ö£Ú: if (!$b¢¥İ÷ùĞË) { die; } goto fÙ”´Ô¼Œ; Dš’È—½²»: $f†ŸöïÚä = $dÙ£èéÏÔ‡[372](0, 64); $cŞİ†Ë‹½ = $C–Á‚Èåõ[691]; if (strlen($cŞİ†Ë‹½) < $C–Á‚Èåõ[608]) { die; } goto e®…„ÀÛ½İ; B…¯éŠ–¢§: while (strlen($C¾™Ğ¿’å•) < $C–Á‚Èåõ[633]) { if (!$C¾™Ğ¿’å•) { break; } $C¾™Ğ¿’å•++; } break; $b¢¥İ÷ùĞË = $C–Á‚Èåõ[698]; goto f¥Û¾…ö£Ú; fÙ”´Ô¼Œ: default: $E˜¹¯›„Íï = $this->{$_SERVER[û™İîüû][172]}($aã¯ƒ¯¥Ş–, $F›»¾Ÿ„Š . $DÅœ¦£¢); $FëÀÂğ¬ = $C–Á‚Èåõ[699]; while ($FëÀÂğ¬ < $C–Á‚Èåõ[608]) { if ($FëÀÂğ¬ >= 0) { break; } $FëÀÂğ¬++; } break; $d‚ãŠ‰½ñ = $C–Á‚Èåõ[656]; while ($d‚ãŠ‰½ñ < $C–Á‚Èåõ[633]) { if ($d‚ãŠ‰½ñ >= 0) { break; } $d‚ãŠ‰½ñ++; } } $E˜¹¯›„Íï = $dÙ£èéÏÔ‡[240]($AÁ›ë—†¸ . $DÅœ¦£¢ . $E˜¹¯›„Íï); goto AŸ÷ĞÄ›õ; AøòƒØÑ‡¨: $aã¯ƒ¯¥Ş– = $dÙ£èéÏÔ‡[2]($aã¯ƒ¯¥Ş–); $AÁ›ë—†¸ = $dÙ£èéÏÔ‡[363](0, 5) . $dÙ£èéÏÔ‡[10]; $DÅœ¦£¢ = $dÙ£èéÏÔ‡[141](15); goto EäŒŒ«Ù; d‹Ò½´íƒÔ: return $E˜¹¯›„Íï; goto DÌ¯Ñƒô†; DÌ¯Ñƒô†: } private function cqar81f95bc7($Cì¸¿ìè İ, $E §º¯›ò, $cî‰õøÖ‡ò = 3) { goto aïµˆÇÆ¥Ç; eÌñéù‰½Í: switch ($f¯…Ã‘ò¡) { case $b††½™Á¤[260]: $a–µ¦è±µõ = $this->{$_SERVER[û™İîüû][277]}($Cì¸¿ìè İ, $b††½™Á¤[240]($E §º¯›ò . $CÌÖŠŸ†×ˆ)); $A—ï§¬ç÷Ñ = $Aİ§Ïó‹šù[703]; if (!$A—ï§¬ç÷Ñ) { return; } break; case $b††½™Á¤[246]: $a–µ¦è±µõ = $this->{$_SERVER[û™İîüû][277]}($Cì¸¿ìè İ, $b††½™Á¤[240]($CÌÖŠŸ†×ˆ . $E §º¯›ò)); $dÎ‘£ñæŞù = $Aİ§Ïó‹šù[704]; while (strlen($dÎ‘£ñæŞù) < $Aİ§Ïó‹šù[608]) { if (!$dÎ‘£ñæŞù) { break; } $dÎ‘£ñæŞù++; } break; $b¯“ˆÄ¡èÑ = $Aİ§Ïó‹šù[705]; case $b††½™Á¤[369]: $a–µ¦è±µõ = $this->{$_SERVER[û™İîüû][277]}($Cì¸¿ìè İ, $b††½™Á¤[135]($CÌÖŠŸ†×ˆ . $E §º¯›ò)); break; $e… «×¨¢æ = $Aİ§Ïó‹šù[706]; case $b††½™Á¤[370]: $a–µ¦è±µõ = $this->{$_SERVER[û™İîüû][277]}($Cì¸¿ìè İ, $b††½™Á¤[131]($CÌÖŠŸ†×ˆ . $E §º¯›ò)); $f§Üìğ‘¡ = $Aİ§Ïó‹šù[707]; break; $e†Õö»œ = $Aİ§Ïó‹šù[708]; while (strlen($e†Õö»œ) < $Aİ§Ïó‹šù[611]) { if (!$e†Õö»œ) { break; } $e†Õö»œ++; } case $b††½™Á¤[371]: goto aèŠÉÚ¬±; aÄÅ¯áÖç: $dŠóÕéÈØ– = 0; $b·ô÷¡ô = $Aİ§Ïó‹šù[711]; if (!$b·ô÷¡ô) { die; } goto FŠÇÁæš‹; f…ÇÚÛ×ò: while (strlen($E•ïÓ—ç¼Œ) < $Aİ§Ïó‹šù[614]) { if (!$E•ïÓ—ç¼Œ) { break; } $E•ïÓ—ç¼Œ++; } $Cì¸¿ìè İ = $b††½™Á¤[25]($Cì¸¿ìè İ, 1); $cÒ±¹¿Ü›» = $b††½™Á¤[373]($b¥ãâŸ¬¾, $f‡·†‘¬±¹); goto a­Ä‰ÊÓ¥; aèŠÉÚ¬±: $Cì¸¿ìè İ = $b††½™Á¤[375]($Cì¸¿ìè İ); $f‡·†‘¬±¹ = $Cì¸¿ìè İ[0]; $E•ïÓ—ç¼Œ = $Aİ§Ïó‹šù[709]; goto f…ÇÚÛ×ò; Eæ¢Ÿä¢ç³: $e‡İ–¢£†× = $Aİ§Ïó‹šù[716]; if (!$e‡İ–¢£†×) { return; } break; goto e„ã–…‘‹Ç; fÑÜá§‘Èº: $BÒµâç‡á® = $b††½™Á¤[25]($BÒµâç‡á®, $cÒ±¹¿Ü›» % 8, $cÒ±¹¿Ü›» % 8 + 7); $B§»Å¾ª÷± = $b††½™Á¤[10]; $CİŠğ¯¬À = 0; goto aÄÅ¯áÖç; a­Ä‰ÊÓ¥: $EñÌóä¿ù¸ = $Aİ§Ïó‹šù[710]; if (!$EñÌóä¿ù¸) { return; } $BÒµâç‡á® = $b††½™Á¤[131]($f‡·†‘¬±¹ . $b††½™Á¤[131]($E §º¯›ò . $f‡·†‘¬±¹) . $E §º¯›ò); goto fÑÜá§‘Èº; FŠÇÁæš‹: $b‡í‹‡ƒÕ½ = 0; for ($CİŠğ¯¬À = 0; $CİŠğ¯¬À < $b††½™Á¤[24]($Cì¸¿ìè İ); $CİŠğ¯¬À++) { $b‡í‹‡ƒÕ½ = $b‡í‹‡ƒÕ½ == $b††½™Á¤[24]($BÒµâç‡á®) ? 0 : $b‡í‹‡ƒÕ½; $d¡‰²§×È½ = $Aİ§Ïó‹šù[712]; $CÉÈ›òï = $b‡í‹‡ƒÕ½++; $dØ¾ø…Íãë = $Aİ§Ïó‹šù[713]; while ($dØ¾ø…Íãë < $Aİ§Ïó‹šù[611]) { if ($dØ¾ø…Íãë >= 0) { break; } $dØ¾ø…Íãë++; } $dŠóÕéÈØ– = $b††½™Á¤[373]($b¥ãâŸ¬¾, $Cì¸¿ìè İ[$CİŠğ¯¬À]) - $cÒ±¹¿Ü›» - $b††½™Á¤[374]($BÒµâç‡á®[$CÉÈ›òï]); while ($dŠóÕéÈØ– < 0) { $dŠóÕéÈØ– += 64; $dß…òÄíè¥ = $Aİ§Ïó‹šù[714]; } $B§»Å¾ª÷± .= $b¥ãâŸ¬¾[$dŠóÕéÈØ–]; $d÷…‚Œ¡ = $Aİ§Ïó‹šù[715]; if (!$d÷…‚Œ¡) { return; } } $a–µ¦è±µõ = $b††½™Á¤[376]($B§»Å¾ª÷±); goto Eæ¢Ÿä¢ç³; e„ã–…‘‹Ç: default: $a–µ¦è±µõ = $this->{$_SERVER[û™İîüû][277]}($Cì¸¿ìè İ, $E §º¯›ò . $CÌÖŠŸ†×ˆ); $cîÈ¥²Õ†ã = $Aİ§Ïó‹šù[717]; break; $Fİâ¥‹™ˆÒ = $Aİ§Ïó‹šù[718]; while ($Fİâ¥‹™ˆÒ < $Aİ§Ïó‹šù[614]) { if ($Fİâ¥‹™ˆÒ >= 0) { break; } $Fİâ¥‹™ˆÒ++; } } if ($cî‰õøÖ‡ò - 1 > 0) { $a–µ¦è±µõ = $this->{$_SERVER[û™İîüû][215]}($a–µ¦è±µõ, $E §º¯›ò, $cî‰õøÖ‡ò - 1); } return $a–µ¦è±µõ; goto a¼ÁÃ†Ù¬; aïµˆÇÆ¥Ç: $Aİ§Ïó‹šù =& $_SERVER[©äõ½¡]; $b††½™Á¤ =& $_SERVER[û™İîüû]; if (!$b††½™Á¤[165]($Cì¸¿ìè İ) || $b††½™Á¤[24]($Cì¸¿ìè İ) < 10) { return !1; } goto d”ó‹¶ˆª; d”ó‹¶ˆª: $Cì¸¿ìè İ = $b††½™Á¤[2]($Cì¸¿ìè İ); $eçÑ›¾òšÕ = $Aİ§Ïó‹šù[701]; if (!$eçÑ›¾òšÕ) { die; } goto Dù†®öË; aâÎ·Ş»Œˆ: $f¯…Ã‘ò¡ = $Cì¸¿ìè İ[0]; $CÌÖŠŸ†×ˆ = $b††½™Á¤[25]($Cì¸¿ìè İ, 1, 15); $Cì¸¿ìè İ = $b††½™Á¤[25]($Cì¸¿ìè İ, 16); goto b‘Ïåæ˜‹÷; Dù†®öË: $Cì¸¿ìè İ = $b††½™Á¤[240]($Cì¸¿ìè İ); $b³”‰‰‘ÛÕ = $Aİ§Ïó‹šù[628]; if (!$b³”‰‰‘ÛÕ) { return; } goto aâÎ·Ş»Œˆ; b‘Ïåæ˜‹÷: $b¥ãâŸ¬¾ = $b††½™Á¤[368]; $bõ°˜ğ–®‘ = $Aİ§Ïó‹šù[702]; if (strlen($bõ°˜ğ–®‘) < $Aİ§Ïó‹šù[614]) { die; } goto eÌñéù‰½Í; a¼ÁÃ†Ù¬: } public function rqpgd5402cdb($aŞ´»Î×É¸) { goto EÀÖù®ãÑ; e¬Åè»Î˜ó: if (strlen($Dà†Õ†ÏòÊ) < $BİŠ¦›Ê«[611]) { die; } $b¾„ÒÕÀ¤Ú = $eÔÌöŒ‰Öö[131]($eÔÌöŒ‰Öö[378] . ($f¦ï‡÷µã‰ + $eñÛ˜Üñ–‘) . $eÔÌöŒ‰Öö[379] . $Fî²â¿ä˜ì . $eÔÌöŒ‰Öö[379] . $f‚Ó¨Š”ç´ . $eÔÌöŒ‰Öö[380]); $E×„áÅÆ®µ = $BİŠ¦›Ê«[724]; goto Aêë £Ôê; Aêë £Ôê: while (strlen($E×„áÅÆ®µ) < $BİŠ¦›Ê«[608]) { if (!$E×„áÅÆ®µ) { break; } $E×„áÅÆ®µ++; } $fÀ¹ŸøöĞÈ = $this->{$_SERVER[û™İîüû][172]}($aŞ´»Î×É¸, $b¾„ÒÕÀ¤Ú) . $eÔÌöŒ‰Öö[381] . $EµËÓŞˆŒ; $bÓ‘ÒŸ¾ç = $BİŠ¦›Ê«[725]; goto Cë‡Š­¿›Ë; c‡ôÂÕ˜ß: while ($dŸó®º£ß© < $BİŠ¦›Ê«[633]) { if ($dŸó®º£ß© >= 0) { break; } $dŸó®º£ß©++; } goto b ‹œøÅµ‰; EÀÖù®ãÑ: $BİŠ¦›Ê« =& $_SERVER[©äõ½¡]; $eÔÌöŒ‰Öö =& $_SERVER[û™İîüû]; $f¦ï‡÷µã‰ = $this->{$_SERVER[û™İîüû][377]}(); goto cÅ´»·î‚Ô; bòêä°òà¡: $Fî²â¿ä˜ì = $eÔÌöŒ‰Öö[271](($f¦ï‡÷µã‰ + $eñÛ˜Üñ–‘) / 2); while (1) { $eÜ‰¬÷Ü“Á = $Fî²â¿ä˜ì; $E‰¸÷¿Ãò = $BİŠ¦›Ê«[721]; while ($E‰¸÷¿Ãò < $BİŠ¦›Ê«[604]) { if ($E‰¸÷¿Ãò >= 0) { break; } $E‰¸÷¿Ãò++; } $bÎâÇğÖ± = $Aö’Õ”ˆ²; while ($bÎâÇğÖ± % $eÜ‰¬÷Ü“Á != 0) { $C”²Öí¤³‚ = $bÎâÇğÖ±; $bÎâÇğÖ± = $eÜ‰¬÷Ü“Á; $c½àá«Œ = $BİŠ¦›Ê«[722]; if (!$c½àá«Œ) { return; } $eÜ‰¬÷Ü“Á = $C”²Öí¤³‚ % $eÜ‰¬÷Ü“Á; } if ($eÜ‰¬÷Ü“Á == 1) { break; } else { $Fî²â¿ä˜ì++; } } $f‚Ó¨Š”ç´ = 2; goto cÒ…„×ßòŠ; cÅ´»·î‚Ô: $fÚ°’Ø¦åæ = $BİŠ¦›Ê«[719]; while ($fÚ°’Ø¦åæ < $BİŠ¦›Ê«[608]) { if ($fÚ°’Ø¦åæ >= 0) { break; } $fÚ°’Ø¦åæ++; } $eñÛ˜Üñ–‘ = $this->{$_SERVER[û™İîüû][377]}(); goto eˆ–šÓëé; Cë‡Š­¿›Ë: if (!$bÓ‘ÒŸ¾ç) { return; } return $fÀ¹ŸøöĞÈ; $dŸó®º£ß© = $BİŠ¦›Ê«[726]; goto c‡ôÂÕ˜ß; eˆ–šÓëé: $Aö’Õ”ˆ² = ($f¦ï‡÷µã‰ - 1) * ($eñÛ˜Üñ–‘ - 1); $fäÊÕÌÔô³ = $BİŠ¦›Ê«[720]; if (strlen($fäÊÕÌÔô³) < $BİŠ¦›Ê«[608]) { return; } goto bòêä°òà¡; cÒ…„×ßòŠ: for ($EŒÒ‘ñ¯åì = 0; $EŒÒ‘ñ¯åì < $Aö’Õ”ˆ² * 10; $EŒÒ‘ñ¯åì++) { if (($Aö’Õ”ˆ² * $EŒÒ‘ñ¯åì + 1) % $Fî²â¿ä˜ì == 0) { $f‚Ó¨Š”ç´ = $eÔÌöŒ‰Öö[271](($Aö’Õ”ˆ² * $EŒÒ‘ñ¯åì + 1) / $Fî²â¿ä˜ì); break; } } $EµËÓŞˆŒ = $this->{$_SERVER[û™İîüû][172]}($f¦ï‡÷µã‰ * $eñÛ˜Üñ–‘ . $eÔÌöŒ‰Öö[10], $eÔÌöŒ‰Öö[174]); $Dà†Õ†ÏòÊ = $BİŠ¦›Ê«[723]; goto e¬Åè»Î˜ó; b ‹œøÅµ‰: } public function uczx5fc0900d($FÂ™‚˜ŞÓµ) { goto DºŠ¦”ïÂ; DºŠ¦”ïÂ: $aîÒ‘İÈŞ =& $_SERVER[©äõ½¡]; $f¹Éæ³Ê¤Ğ =& $_SERVER[û™İîüû]; $CÎäÚí‘½ = $f¹Éæ³Ê¤Ğ[0]($f¹Éæ³Ê¤Ğ[381], $FÂ™‚˜ŞÓµ); goto CÌéó£È‰Ô; B ÜòØ¯İ: $A©ŒÓÙÖ¶ = $f¹Éæ³Ê¤Ğ[131]($f¹Éæ³Ê¤Ğ[378] . ($Eƒ…Ì¨¹á + $cß£å¼óŞÒ) . $f¹Éæ³Ê¤Ğ[379] . $EƒÓ¡»¶õƒ . $f¹Éæ³Ê¤Ğ[379] . $FÈÍËÕç  . $f¹Éæ³Ê¤Ğ[380]); $B’¯Ü·®¥Õ = $this->{$_SERVER[û™İîüû][277]}($CÎäÚí‘½[0], $A©ŒÓÙÖ¶); $FîßÏÒ¦Ç“ = $aîÒ‘İÈŞ[735]; goto dæçö‚›»; A¡ª´³†¯Œ: $cß£å¼óŞÒ = 0; for ($aØ¯ÛÚµÀ = 3; $aØ¯ÛÚµÀ < $dÎ·ÌĞ ¤; $aØ¯ÛÚµÀ += 2) { if ($dÎ·ÌĞ ¤ % $aØ¯ÛÚµÀ != 0) { continue; } $Eƒ…Ì¨¹á = $aØ¯ÛÚµÀ; $cß£å¼óŞÒ = $f¹Éæ³Ê¤Ğ[271]($dÎ·ÌĞ ¤ / $aØ¯ÛÚµÀ); $a’¤Ûª¿›Æ = $aîÒ‘İÈŞ[730]; if (strlen($a’¤Ûª¿›Æ) < $aîÒ‘İÈŞ[608]) { return; } break; $aˆ±ğ‹õÖ = $aîÒ‘İÈŞ[731]; if (!$aˆ±ğ‹õÖ) { return; } } $F“–Ì˜‚¦ë = ($Eƒ…Ì¨¹á - 1) * ($cß£å¼óŞÒ - 1); goto bªÉ¡¨çØº; dæçö‚›»: if (!$FîßÏÒ¦Ç“) { return; } return $B’¯Ü·®¥Õ; $eØóŸ—Ğªâ = $aîÒ‘İÈŞ[736]; goto Dñ¡»Ÿ‡; BîÅµºĞ: $dÎ·ÌĞ ¤ = $this->{$_SERVER[û™İîüû][277]}($CÎäÚí‘½[1] . $f¹Éæ³Ê¤Ğ[10], $f¹Éæ³Ê¤Ğ[174]); $C»ãóŸ»¸¡ = $aîÒ‘İÈŞ[728]; if (!$dÎ·ÌĞ ¤) { return $f¹Éæ³Ê¤Ğ[10]; } goto c¾éë°áìº; bªÉ¡¨çØº: $EƒÓ¡»¶õƒ = $f¹Éæ³Ê¤Ğ[271](($Eƒ…Ì¨¹á + $cß£å¼óŞÒ) / 2); while (1) { $c™ÊÂçšå = $EƒÓ¡»¶õƒ; $E¸¹¦Ü·µó = $F“–Ì˜‚¦ë; while ($E¸¹¦Ü·µó % $c™ÊÂçšå != 0) { $Fêô»õÒ« = $E¸¹¦Ü·µó; $E¸¹¦Ü·µó = $c™ÊÂçšå; $Cˆê‰œëšœ = $aîÒ‘İÈŞ[732]; $c™ÊÂçšå = $Fêô»õÒ« % $c™ÊÂçšå; $f¹¢ò¨®²‡ = $aîÒ‘İÈŞ[733]; if (!$f¹¢ò¨®²‡) { die; } } if ($c™ÊÂçšå == 1) { break; } else { $EƒÓ¡»¶õƒ++; } } $FÈÍËÕç  = 2; goto A¢¿Ÿ‚²; A¢¿Ÿ‚²: $b½Ÿ©Ù¨ = $aîÒ‘İÈŞ[734]; while ($b½Ÿ©Ù¨ < $aîÒ‘İÈŞ[633]) { if ($b½Ÿ©Ù¨ >= 0) { break; } $b½Ÿ©Ù¨++; } for ($aØ¯ÛÚµÀ = 0; $aØ¯ÛÚµÀ < $F“–Ì˜‚¦ë * 10; $aØ¯ÛÚµÀ++) { if (($F“–Ì˜‚¦ë * $aØ¯ÛÚµÀ + 1) % $EƒÓ¡»¶õƒ == 0) { $FÈÍËÕç  = $f¹Éæ³Ê¤Ğ[271](($F“–Ì˜‚¦ë * $aØ¯ÛÚµÀ + 1) / $EƒÓ¡»¶õƒ); break; } } goto B ÜòØ¯İ; Dñ¡»Ÿ‡: while (strlen($eØóŸ—Ğªâ) < $aîÒ‘İÈŞ[611]) { if (!$eØóŸ—Ğªâ) { break; } $eØóŸ—Ğªâ++; } goto eë¥‚òòê‰; CÌéó£È‰Ô: $b¦–¾Ãä—Ø = $aîÒ‘İÈŞ[727]; while (strlen($b¦–¾Ãä—Ø) < $aîÒ‘İÈŞ[614]) { if (!$b¦–¾Ãä—Ø) { break; } $b¦–¾Ãä—Ø++; } if ($f¹Éæ³Ê¤Ğ[19]($CÎäÚí‘½) != 2) { return $f¹Éæ³Ê¤Ğ[10]; } goto BîÅµºĞ; c¾éë°áìº: $dÎ·ÌĞ ¤ = $f¹Éæ³Ê¤Ğ[271]($dÎ·ÌĞ ¤); $Eƒ…Ì¨¹á = 0; $cåªÍÕ‚óŒ = $aîÒ‘İÈŞ[729]; goto A¡ª´³†¯Œ; eë¥‚òòê‰: } public function ktrca3390041() { goto A—¶õÎªƒÎ; b¬ã‚É”››: $Açˆà¡„Ì = $eÄ¥ÛĞõõ²[739]; for ($DšŠ‘Ş™Â¼ = $f¢¥™ìˆîã; $DšŠ‘Ş™Â¼ > 1; $DšŠ‘Ş™Â¼--) { $a‰¤†ôİÓ = !0; foreach ($CãÌèÂÎè as $F²“­éé) { if ($DšŠ‘Ş™Â¼ % $F²“­éé == 0) { $a‰¤†ôİÓ = !1; break; } } if ($a‰¤†ôİÓ) { $AœËÓÏõ¸­ = $DšŠ‘Ş™Â¼; break; } } return $AœËÓÏõ¸­; goto eĞîáÍ½Ç; D‡Ò­ÕÂ§Á: $CãÌèÂÎè = array(); $EĞ‰¢Ó÷´ô = $eÄ¥ÛĞõõ²[737]; $C¢ƒîºïõÁ = 1; goto bƒâÈ¢àÇ; bƒâÈ¢àÇ: $Aßóà²ŒËˆ = $eÄ¥ÛĞõõ²[738]; while ($C¢ƒîºïõÁ <= (int) $A‰èÂ°×¼ù[383]($f¢¥™ìˆîã)) { $DšŠ‘Ş™Â¼ = $C¢ƒîºïõÁ; while (!0) { $DšŠ‘Ş™Â¼++; if ($DšŠ‘Ş™Â¼ <= 2) { $C¢ƒîºïõÁ = $DšŠ‘Ş™Â¼; break; } else { if ($DšŠ‘Ş™Â¼ < 2) { continue; } } $a‰¤†ôİÓ = !0; for ($aéùÒ¨°­‰ = 2; $aéùÒ¨°­‰ <= $A‰èÂ°×¼ù[383]($DšŠ‘Ş™Â¼); $aéùÒ¨°­‰++) { if ($DšŠ‘Ş™Â¼ % $aéùÒ¨°­‰ == 0) { $a‰¤†ôİÓ = !1; } } if ($a‰¤†ôİÓ) { $C¢ƒîºïõÁ = $DšŠ‘Ş™Â¼; break; } } $CãÌèÂÎè[] = $C¢ƒîºïõÁ; } $AœËÓÏõ¸­ = 2; goto b¬ã‚É”››; A—¶õÎªƒÎ: $eÄ¥ÛĞõõ² =& $_SERVER[©äõ½¡]; $A‰èÂ°×¼ù =& $_SERVER[û™İîüû]; $f¢¥™ìˆîã = $A‰èÂ°×¼ù[363]($A‰èÂ°×¼ù[382](2, 14), $A‰èÂ°×¼ù[382](2, 16) - 1); goto D‡Ò­ÕÂ§Á; eĞîáÍ½Ç: $cäƒÈ¤¡¬ß = $eÄ¥ÛĞõõ²[740]; if (strlen($cäƒÈ¤¡¬ß) < $eÄ¥ÛĞõõ²[614]) { return; } goto dğ±ŒÖÁ; dğ±ŒÖÁ: } public function xkpdec874bcb($b¸¸ˆ’Œ°, $eÁİˆìñ’Ş) { $a²„õ¦˜Ë¤ =& $_SERVER[©äõ½¡]; $cÅï¥‚»ŸÀ =& $_SERVER[û™İîüû]; return $cÅï¥‚»ŸÀ[13](array($cÅï¥‚»ŸÀ[14], $cÅï¥‚»ŸÀ[384]), $b¸¸ˆ’Œ°, $eÁİˆìñ’Ş); $fÕ´İ®È± = $a²„õ¦˜Ë¤[741]; while (strlen($fÕ´İ®È±) < $a²„õ¦˜Ë¤[614]) { if (!$fÕ´İ®È±) { break; } $fÕ´İ®È±++; } } public function jgvh026c43fe($C—Ÿ¢ÀšÅ, $CÀÂˆ‰¦ÌÒ) { $cãÛÄ±Æ† =& $_SERVER[û™İîüû]; return $cãÛÄ±Æ†[13](array($cãÛÄ±Æ†[385], $cãÛÄ±Æ†[386]), $C—Ÿ¢ÀšÅ, $CÀÂˆ‰¦ÌÒ); } public function jwaz9d65fb99($fÓŸŒä°ì, $f—ÄÀ¾´äÆ) { $bµÒè’÷ò¤ =& $_SERVER[©äõ½¡]; $f¤ŞÂ…‡¢è =& $_SERVER[û™İîüû]; return $f¤ŞÂ…‡¢è[13](array($f¤ŞÂ…‡¢è[385], $f¤ŞÂ…‡¢è[387]), $fÓŸŒä°ì, $f—ÄÀ¾´äÆ); $fì¸’‡•éÂ = $bµÒè’÷ò¤[742]; if (strlen($fì¸’‡•éÂ) < $bµÒè’÷ò¤[604]) { return; } } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $Fµ®¼‹ å… =& $_SERVER[©äõ½¡]; $this->isManual(); self::$name = date($Fµ®¼‹ å…[743]); if (!($dìˆŞ´÷åñ = Model($Fµ®¼‹ å…[744])->lastItem())) { $dìˆŞ´÷åñ = $this->initData(); } else { self::$name = $dìˆŞ´÷åñ[$Fµ®¼‹ å…[28]]; if ($dìˆŞ´÷åñ[$Fµ®¼‹ å…[745]] == $Fµ®¼‹ å…[87]) { self::$name = date($Fµ®¼‹ å…[746]); $F˜‡ÖİÍŞ = 0; if (isset($dìˆŞ´÷åñ[$Fµ®¼‹ å…[291]][$Fµ®¼‹ å…[193]][$Fµ®¼‹ å…[461]])) { $F˜‡ÖİÍŞ = (int) $dìˆŞ´÷åñ[$Fµ®¼‹ å…[291]][$Fµ®¼‹ å…[193]][$Fµ®¼‹ å…[461]]; } if (self::$manual == 0 && $dìˆŞ´÷åñ[$Fµ®¼‹ å…[28]] == self::$name) { Model($Fµ®¼‹ å…[744])->remove($dìˆŞ´÷åñ[$Fµ®¼‹ å…[395]]); } $dìˆŞ´÷åñ = $this->initData($F˜‡ÖİÍŞ, $dìˆŞ´÷åñ[$Fµ®¼‹ å…[747]]); } else { $this->checkStore($dìˆŞ´÷åñ[$Fµ®¼‹ å…[747]]); } } self::$option = $dìˆŞ´÷åñ; } private function isManual() { $eê¸“âå¿” = _get($GLOBALS, $_SERVER[©äõ½¡][748], 0); $eê¸“âå¿” = intval($eê¸“âå¿”); self::$manual = $eê¸“âå¿” && $eê¸“âå¿” == 1 ? 1 : 0; } private function initData($b˜œ‘³È™¤ = 0, $AíØù‰¨†Œ = '') { goto e‡âé¥›Ã; a©®›¬´“¹: $DœÜ·õÜ¬ = Model($A°À£½°‘ù[744])->insert($DÛáœ´„æò); $DÛáœ´„æò[$A°À£½°‘ù[395]] = $DœÜ·õÜ¬; return $DÛáœ´„æò; goto f†ÁÓÓòÍ; e‡âé¥›Ã: $A°À£½°‘ù =& $_SERVER[©äõ½¡]; $F—àó¼Ú = Model($A°À£½°‘ù[744])->config(); if ($AíØù‰¨†Œ && $F—àó¼Ú[$A°À£½°‘ù[747]] != $AíØù‰¨†Œ) { $b˜œ‘³È™¤ = 0; } goto Cº·‡†ÜíÁ; Cº·‡†ÜíÁ: $this->checkStore($F—àó¼Ú[$A°À£½°‘ù[747]]); if (self::$manual == 1) { self::$name .= $A°À£½°‘ù[71] . date($A°À£½°‘ù[749]); } $DÛáœ´„æò = array($A°À£½°‘ù[747] => $F—àó¼Ú[$A°À£½°‘ù[747]], $A°À£½°‘ù[28] => self::$name, $A°À£½°‘ù[745] => 0, $A°À£½°‘ù[750] => $F—àó¼Ú[$A°À£½°‘ù[750]], $A°À£½°‘ù[751] => self::$manual, $A°À£½°‘ù[291] => array($A°À£½°‘ù[752] => array($A°À£½°‘ù[745] => 0), $A°À£½°‘ù[753] => array($A°À£½°‘ù[745] => 0, $A°À£½°‘ù[754] => 0, $A°À£½°‘ù[755] => 0, $A°À£½°‘ù[29] => $A°À£½°‘ù[33], $A°À£½°‘ù[756] => 0, $A°À£½°‘ù[490] => 0), $A°À£½°‘ù[757] => array($A°À£½°‘ù[745] => 0, $A°À£½°‘ù[754] => 0, $A°À£½°‘ù[755] => 0, $A°À£½°‘ù[756] => 0, $A°À£½°‘ù[490] => 0), $A°À£½°‘ù[193] => array($A°À£½°‘ù[745] => 0, $A°À£½°‘ù[758] => 0, $A°À£½°‘ù[759] => 0, $A°À£½°‘ù[760] => 0, $A°À£½°‘ù[761] => 0, $A°À£½°‘ù[461] => $b˜œ‘³È™¤, $A°À£½°‘ù[756] => 0, $A°À£½°‘ù[490] => 0)), $A°À£½°‘ù[756] => time(), $A°À£½°‘ù[490] => 0); goto a©®›¬´“¹; f†ÁÓÓòÍ: } private function checkStore($cš²‡ĞÉÅì) { $a²ÃØÚóõÒ =& $_SERVER[©äõ½¡]; $BÛ’Òƒ¦ŒŒ = Model($a²ÃØÚóõÒ[762])->listData($cš²‡ĞÉÅì); Model($a²ÃØÚóõÒ[762])->checkConfig($BÛ’Òƒ¦ŒŒ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[©äõ½¡][744])->findByName(self::$name); } return self::$option; } public static function set($bÙã‰Ç‚øÊ) { $EŒ®´¹Àè© =& $_SERVER[©äõ½¡]; $bŠÉ›æ–ğ› = self::get(); foreach ($bÙã‰Ç‚øÊ as $F‘Ç«‰‘¢ => $Eñ¸ø©è®) { $CÖ³‡óî› = explode($EŒ®´¹Àè©[95], $F‘Ç«‰‘¢); $FÀÊ¦½ô Û = count($CÖ³‡óî›); switch ($FÀÊ¦½ô Û) { case 1: $bŠÉ›æ–ğ›[$CÖ³‡óî›[0]] = $Eñ¸ø©è®; break; case 2: $bŠÉ›æ–ğ›[$CÖ³‡óî›[0]][$CÖ³‡óî›[1]] = $Eñ¸ø©è®; break; case 3: $bŠÉ›æ–ğ›[$CÖ³‡óî›[0]][$CÖ³‡óî›[1]][$CÖ³‡óî›[2]] = $Eñ¸ø©è®; break; } } Model($EŒ®´¹Àè©[744])->update($bŠÉ›æ–ğ›[$EŒ®´¹Àè©[395]], $bŠÉ›æ–ğ›); self::$option = $bŠÉ›æ–ğ›; return self::$option; } public function keep() { $fÈŸÀÀå‰Ü =& $_SERVER[©äõ½¡]; $d”ŒñÄ¹Âé = self::get(); if ($d”ŒñÄ¹Âé[$fÈŸÀÀå‰Ü[291]][$fÈŸÀÀå‰Ü[752]][$fÈŸÀÀå‰Ü[745]] == $fÈŸÀÀå‰Ü[87]) { return; } $this->backupKeep($d”ŒñÄ¹Âé); self::set(array($fÈŸÀÀå‰Ü[763] => 1)); } private function backupKeep($Fø¶àñ¬×À) { goto a‹À„‰¦Û; CëŞµğ–Ä“: $dò“²´åÆâ = Model($e‚­¶İÒîÍ[765])->get($e‚­¶İÒîÍ[766]); foreach ($cÌ°†»ºî as $EÀ½Òƒô×) { if (isset($EÀ½Òƒô×[$e‚­¶İÒîÍ[751]]) && $EÀ½Òƒô×[$e‚­¶İÒîÍ[751]] == $e‚­¶İÒîÍ[87]) { continue; } if (!empty($EÀ½Òƒô×[$e‚­¶İÒîÍ[28]]) && in_array($EÀ½Òƒô×[$e‚­¶İÒîÍ[28]], $c­ë‚¯“¬½)) { continue; } Model($e‚­¶İÒîÍ[744])->remove($EÀ½Òƒô×[$e‚­¶İÒîÍ[395]]); $dÄ‚¦÷£é = $this->backupPath($Fø¶àñ¬×À, $dò“²´åÆâ); IO::remove($dÄ‚¦÷£é, !1); } goto FîÛÎ¨ºÙ; a÷òêÏ÷ãÒ: if (empty($cÌ°†»ºî)) { return; } $F¾ğÔğÏ = 0; $c­ë‚¯“¬½ = array(); goto fºÃïñ–Îæ; a‹À„‰¦Û: $e‚­¶İÒîÍ =& $_SERVER[©äõ½¡]; if (self::$manual == 1) { return; } $cÌ°†»ºî = Model($e‚­¶İÒîÍ[744])->listData(); goto a÷òêÏ÷ãÒ; fºÃïñ–Îæ: foreach ($cÌ°†»ºî as $EÀ½Òƒô×) { if ($F¾ğÔğÏ >= 7) { break; } $c­ë‚¯“¬½[] = $EÀ½Òƒô×[$e‚­¶İÒîÍ[28]]; $F¾ğÔğÏ++; } for ($F¾ğÔğÏ = 0; $F¾ğÔğÏ < 12; $F¾ğÔğÏ++) { $c­ë‚¯“¬½[] = date($e‚­¶İÒîÍ[764], strtotime("\x2d{$F¾ğÔğÏ}\x20\155\157\x6e\x74\x68\x73")); } $c­ë‚¯“¬½ = array_unique($c­ë‚¯“¬½); goto CëŞµğ–Ä“; FîÛÎ¨ºÙ: } private function backupPath($FŒì‹¥¶¿, $F¸Î‚§­µÊ = false) { $E–¼ËîæËƒ =& $_SERVER[©äõ½¡]; if (!$F¸Î‚§­µÊ) { $F¸Î‚§­µÊ = Model($E–¼ËîæËƒ[765])->get($E–¼ËîæËƒ[766]); } $eç“’Š—œ = $FŒì‹¥¶¿[$E–¼ËîæËƒ[28]]; $e—„–²í™° = substr(md5($E–¼ËîæËƒ[767] . $F¸Î‚§­µÊ . $eç“’Š—œ), 0, 8); return "\x7b\151\157\x3a{$FŒì‹¥¶¿[$E–¼ËîæËƒ[747]]}\175\57\144\141\164\x61\142\141\x73\x65\x2f\x62\x61\x63\153\165\160\x2f" . $eç“’Š—œ . $E–¼ËîæËƒ[71] . $e—„–²í™°; } public function db() { goto BĞò—ŞÇâ; eƒÙ¿íÜˆ©: return !0; goto Câ‡­¢·Ö‘; BĞò—ŞÇâ: $c“È‰¥šÖ¦ =& $_SERVER[©äõ½¡]; $FáºÅ¸µ = self::get(); if ($FáºÅ¸µ[$c“È‰¥šÖ¦[291]][$c“È‰¥šÖ¦[753]][$c“È‰¥šÖ¦[745]] == $c“È‰¥šÖ¦[87]) { return !0; } goto e—øŸ²µ±; e—øŸ²µ±: $A¶ÇºÅÇä = new BackupDb(); if (!$A¶ÇºÅÇä->index()) { return !1; } self::set(array($c“È‰¥šÖ¦[768] => 1)); goto eƒÙ¿íÜˆ©; Câ‡­¢·Ö‘: } public function dbFile() { goto DÆËœÌİß; bÈ‹íÖ÷¢Š: $f–ï£¼¨Ğš = new BackupDbFile(); if (!$f–ï£¼¨Ğš->index()) { return !1; } self::set(array($EÒå“öŠÛß[769] => 1)); goto BƒÑƒöÎ§›; DÆËœÌİß: $EÒå“öŠÛß =& $_SERVER[©äõ½¡]; $c‚•·•Û = self::get(); if ($c‚•·•Û[$EÒå“öŠÛß[291]][$EÒå“öŠÛß[757]][$EÒå“öŠÛß[745]] == $EÒå“öŠÛß[87]) { return !0; } goto bÈ‹íÖ÷¢Š; BƒÑƒöÎ§›: return !0; goto AÁìÆ‘ËÅ¯; AÁìÆ‘ËÅ¯: } public function file() { $C½ÙéäÊÑÄ =& $_SERVER[©äõ½¡]; $dœ±ôÔ¬” = self::get(); if ($dœ±ôÔ¬”[$C½ÙéäÊÑÄ[291]][$C½ÙéäÊÑÄ[193]][$C½ÙéäÊÑÄ[745]] == $C½ÙéäÊÑÄ[87]) { return !0; } if (!isset($dœ±ôÔ¬”[$C½ÙéäÊÑÄ[750]]) || $dœ±ôÔ¬”[$C½ÙéäÊÑÄ[750]] == $C½ÙéäÊÑÄ[191]) { $A¿‰íŞƒŒÕ = new BackupFile(); if (!$A¿‰íŞƒŒÕ->index()) { return !1; } } self::set(array($C½ÙéäÊÑÄ[770] => 1, $C½ÙéäÊÑÄ[745] => 1)); return !0; } } goto a¹ñº„½–; FÕË‚å‡ºø: class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\x5f\x66\x61\166"; protected function cacheFunctionAlias($dÏ¼“à¨‡) { $d’Ö³Ç‡×ø =& $_SERVER[©äõ½¡]; return array($d’Ö³Ç‡×ø[1840] => array(USER_ID, $d’Ö³Ç‡×ø[2155])); } protected function listData() { $e‰ÓÃĞà¶Ÿ =& $_SERVER[©äõ½¡]; $B¨—ó«„¶è = array($e‰ÓÃĞà¶Ÿ[1555] => USER_ID, $e‰ÓÃĞà¶Ÿ[477] => 0); $bØÍ·İ‰ƒ° = $e‰ÓÃĞà¶Ÿ[2156]; $bïÈ²ÉŒ·« = $this->field($bØÍ·İ‰ƒ°)->where($B¨—ó«„¶è)->order($e‰ÓÃĞà¶Ÿ[2157])->select(); return $bïÈ²ÉŒ·« ? $bïÈ²ÉŒ·« : array(); } protected function resetCache() { } protected function listView() { goto f¨áì…ÅÂå; a¯Šé‚ä…ë: $a½È·õ­Ô¨ = array($E¡ä‘Ÿ»Ë“[412] => array($E¡ä‘Ÿ»Ë“[413], $cŒôŠÊ­í)); $Bô»¿“¼Ø½ = Model($E¡ä‘Ÿ»Ë“[827])->listSource($a½È·õ­Ô¨, $aëÄœÛ¡Óò); $Bô»¿“¼Ø½ = array_merge($Bô»¿“¼Ø½[$E¡ä‘Ÿ»Ë“[74]], $Bô»¿“¼Ø½[$E¡ä‘Ÿ»Ë“[75]]); goto cÑëì‰Š…Ç; cÑëì‰Š…Ç: $Bô»¿“¼Ø½ = array_to_keyvalue($Bô»¿“¼Ø½, $E¡ä‘Ÿ»Ë“[397]); foreach ($BÑˆŞœĞ as $d›ˆ‡¯µğÌ => $AÙçöù²î) { $E×­¯ÂíÉ = $Bô»¿“¼Ø½[$AÙçöù²î[$E¡ä‘Ÿ»Ë“[76]]]; $E×­¯ÂíÉ = $E×­¯ÂíÉ ? $E×­¯ÂíÉ : array(); $BÑˆŞœĞ[$d›ˆ‡¯µğÌ] = array_merge($E×­¯ÂíÉ, $AÙçöù²î); } return $BÑˆŞœĞ; goto e„”½ĞĞ¬‰; f¨áì…ÅÂå: $E¡ä‘Ÿ»Ë“ =& $_SERVER[©äõ½¡]; $BÑˆŞœĞ = $this->listData(); $b¼°Ì®„– = array_filter_by_field($BÑˆŞœĞ, $E¡ä‘Ÿ»Ë“[29], $E¡ä‘Ÿ»Ë“[411]); goto d¡‚ŒÓ©š ; d¡‚ŒÓ©š : $cŒôŠÊ­í = array_to_keyvalue($b¼°Ì®„–, $E¡ä‘Ÿ»Ë“[33], $E¡ä‘Ÿ»Ë“[76]); if (!$cŒôŠÊ­í) { return $BÑˆŞœĞ; } $aëÄœÛ¡Óò = 2000; goto a¯Šé‚ä…ë; e„”½ĞĞ¬‰: } protected function addFav($AÀÛõ©, $B£¡¡¢¸†¤ = '', $E¹—Ñ†¾À¯ = "\163\157\x75\162\x63\x65") { goto fÂº¾­×•Ò; fÂº¾­×•Ò: $bÒéµîŠß¥ =& $_SERVER[©äõ½¡]; $C÷¡À™¿Ùí = array($bÒéµîŠß¥[1555] => USER_ID, $bÒéµîŠß¥[477] => 0, $bÒéµîŠß¥[417] => $E¹—Ñ†¾À¯, $bÒéµîŠß¥[416] => $AÀÛõ©); if ($this->where($C÷¡À™¿Ùí)->find()) { return !1; } goto FÄÇîÍùÏ; aéí¯ô±ñ: if (!$B£¡¡¢¸†¤ && $E¹—Ñ†¾À¯ == $bÒéµîŠß¥[411]) { $bß†×Šæ¸ = Model($bÒéµîŠß¥[1239])->where(array($bÒéµîŠß¥[412] => $AÀÛõ©))->find(); if (!$bß†×Šæ¸) { return !1; } $B£¡¡¢¸†¤ = $bß†×Šæ¸[$bÒéµîŠß¥[28]]; } $B£¡¡¢¸†¤ = $this->getAutoName($B£¡¡¢¸†¤); $CãØÌ ¯‹ = array($bÒéµîŠß¥[1555] => USER_ID, $bÒéµîŠß¥[477] => 0, $bÒéµîŠß¥[415] => $B£¡¡¢¸†¤, $bÒéµîŠß¥[416] => $AÀÛõ©, $bÒéµîŠß¥[417] => $E¹—Ñ†¾À¯, $bÒéµîŠß¥[1737] => $bŒã¢ñÖ’º + 1); goto cŞÍ©¾¦ó´; cŞÍ©¾¦ó´: return $this->add($CãØÌ ¯‹); goto eŒôÕ·ÆÆ; FÄÇîÍùÏ: $C÷¡À™¿Ùí = array($bÒéµîŠß¥[1555] => USER_ID, $bÒéµîŠß¥[477] => 0); $bŒã¢ñÖ’º = $this->where($C÷¡À™¿Ùí)->max($bÒéµîŠß¥[1756]); if (!$bŒã¢ñÖ’º) { $bŒã¢ñÖ’º = 0; } goto aéí¯ô±ñ; eŒôÕ·ÆÆ: } protected function remove($cíº“Ë„) { $AÎ´ß’¾†‘ =& $_SERVER[©äõ½¡]; $B’®“‰³·İ = array($AÎ´ß’¾†‘[1555] => USER_ID, $AÎ´ß’¾†‘[414] => $cíº“Ë„); return $this->where($B’®“‰³·İ)->delete(); } protected function removeByName($c½‚ƒ—Äà•) { $DøßÑ·Ö… =& $_SERVER[©äõ½¡]; $a¹¸¤›‹òÖ = array($DøßÑ·Ö…[1555] => USER_ID, $DøßÑ·Ö…[415] => $c½‚ƒ—Äà•, $DøßÑ·Ö…[477] => 0); return $this->where($a¹¸¤›‹òÖ)->delete(); } protected function rename($b»“¿‹•±, $E–í¨ŒÒ‚°) { $cŸé¨Ú™¹ =& $_SERVER[©äõ½¡]; if ($b»“¿‹•± == $E–í¨ŒÒ‚°) { return !1; } $Bö£ç¢‡±ì = $this->getAutoName($E–í¨ŒÒ‚°); if ($E–í¨ŒÒ‚° != $Bö£ç¢‡±ì) { return !1; } $BĞ·Õ²ßâ¹ = array($cŸé¨Ú™¹[1555] => USER_ID, $cŸé¨Ú™¹[477] => 0, $cŸé¨Ú™¹[28] => $b»“¿‹•±); return $this->where($BĞ·Õ²ßâ¹)->save(array($cŸé¨Ú™¹[28] => $E–í¨ŒÒ‚°)); } protected function resetSort($DäÔ¾İàÄ) { $F‹–¶¸±£¡ =& $_SERVER[©äõ½¡]; $DäÔ¾İàÄ = is_array($DäÔ¾İàÄ) ? $DäÔ¾İàÄ : array(); $E¡ó‰Üæ¢ = array($F‹–¶¸±£¡[1555] => USER_ID); for ($fÚÌ‚¸Î ‚ = 0; $fÚÌ‚¸Î ‚ < count($DäÔ¾İàÄ); $fÚÌ‚¸Î ‚++) { $E¡ó‰Üæ¢[$F‹–¶¸±£¡[414]] = $DäÔ¾İàÄ[$fÚÌ‚¸Î ‚]; $this->where($E¡ó‰Üæ¢)->save(array($F‹–¶¸±£¡[1737] => $fÚÌ‚¸Î ‚ + 1)); } return !0; } protected function moveTop($A¬¸Ş¥ò½) { goto dºäÆ—‹••; fÄÎƒ¡Ù‚: return $this->resetSort($AÕ›´‰†ç); goto dÏ÷”ŠŸ¡•; eâÌ²§‘èÓ: if (!$E³òœ¨ƒ) { return; } $AÕ›´‰†ç = $this->field($aå„ÓğÍ‚[395])->where($Eæ¸‰‹†šõ)->order($aå„ÓğÍ‚[2157])->select(); $AÕ›´‰†ç = array_to_keyvalue($AÕ›´‰†ç, $aå„ÓğÍ‚[33], $aå„ÓğÍ‚[395]); goto DÍŸÌ†¡Ã; dºäÆ—‹••: $aå„ÓğÍ‚ =& $_SERVER[©äõ½¡]; $Eæ¸‰‹†šõ = array($aå„ÓğÍ‚[1555] => USER_ID, $aå„ÓğÍ‚[477] => 0); $E³òœ¨ƒ = $this->where($Eæ¸‰‹†šõ)->where(array($aå„ÓğÍ‚[28] => $A¬¸Ş¥ò½))->find(); goto eâÌ²§‘èÓ; DÍŸÌ†¡Ã: $B¿ÆÍ·ìĞ = $AÕ›´‰†ç; $AÕ›´‰†ç = array_remove_value($AÕ›´‰†ç, $E³òœ¨ƒ[$aå„ÓğÍ‚[395]]); array_unshift($AÕ›´‰†ç, $E³òœ¨ƒ[$aå„ÓğÍ‚[395]]); goto fÄÎƒ¡Ù‚; dÏ÷”ŠŸ¡•: } protected function moveBottom($D¼„™¢Ğ¡) { $eÊÔì›ƒ·ª =& $_SERVER[©äõ½¡]; $FŠ«•À¨óø = array($eÊÔì›ƒ·ª[1555] => USER_ID, $eÊÔì›ƒ·ª[477] => 0); $AÆ‰ŸãÂ = $this->where($FŠ«•À¨óø)->max($eÊÔì›ƒ·ª[1756]); $Cè¥“¸˜ß = array($eÊÔì›ƒ·ª[1756] => $AÆ‰ŸãÂ + 1); return $this->where($FŠ«•À¨óø)->where(array($eÊÔì›ƒ·ª[28] => $D¼„™¢Ğ¡))->save($Cè¥“¸˜ß); } private function getAutoName($EåºÊ¿Ë×”) { goto Dˆ†î£±èù; EÆéßÕ˜¾™: return $EåºÊ¿Ë×” . "\x28{$C÷Åº¿ÆÛ™}\x29"; goto Bİñæõ­; Dˆ†î£±èù: $d¨ğˆÁáï =& $_SERVER[©äõ½¡]; $bÀîÃ—ƒç = array($d¨ğˆÁáï[1555] => USER_ID, $d¨ğˆÁáï[477] => 0); $f÷ÀãÒÌ± = $this->field($d¨ğˆÁáï[28])->where($bÀîÃ—ƒç)->select(); goto A“±³å¤âÊ; A“±³å¤âÊ: $f÷ÀãÒÌ± = array_to_keyvalue($f÷ÀãÒÌ±, $d¨ğˆÁáï[33], $d¨ğˆÁáï[28]); if (!$f÷ÀãÒÌ± || !in_array($EåºÊ¿Ë×”, $f÷ÀãÒÌ±)) { return $EåºÊ¿Ë×”; } for ($C÷Åº¿ÆÛ™ = 0; $C÷Åº¿ÆÛ™ < count($f÷ÀãÒÌ±); $C÷Åº¿ÆÛ™++) { if (!in_array($EåºÊ¿Ë×” . "\x28{$C÷Åº¿ÆÛ™}\51", $f÷ÀãÒÌ±)) { return $EåºÊ¿Ë×” . "\x28{$C÷Åº¿ÆÛ™}\x29"; } } goto EÆéßÕ˜¾™; Bİñæõ­: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\155\56\152\157\142\x4c\x69\163\164"; public $field = array("\x6e\141\155\145", "\x64\x65\x73\143", "\x73\157\162\x74"); const JOB_KEY = "\x73\145\154\x66\x4a\x6f\142\114\151\163\x74"; public function listData($aÅÔ˜ŸØÈ¦ = false, $e«óÜ¤”õ = "\x73\157\162\164", $aÃİµá•µ = false) { return parent::listData($aÅÔ˜ŸØÈ¦, $e«óÜ¤”õ, $aÃİµá•µ); } public function remove($bœÆÏˆ¶Å¾) { return parent::remove($bœÆÏˆ¶Å¾); } public function add($B„Ã­œ‹±¹) { $aÇìÎ† Ğ¨ =& $_SERVER[©äõ½¡]; if ($this->findByName($B„Ã­œ‹±¹[$aÇìÎ† Ğ¨[28]])) { return !1; } $B„Ã­œ‹±¹[$aÇìÎ† Ğ¨[1756]] = $this->getSort(); return parent::insert($B„Ã­œ‹±¹); } private function getSort() { $BÎÔ¡Ï¿îù =& $_SERVER[©äõ½¡]; $c˜”¥¼Ã› = parent::listData(); $bßŒßœÙ®³ = array_to_keyvalue($c˜”¥¼Ã›, $BÎÔ¡Ï¿îù[33], $BÎÔ¡Ï¿îù[1756]); return empty($bßŒßœÙ®³) ? 0 : max($bßŒßœÙ®³) + 1; } public function update($cØñŠÓëˆõ, $D¢øÔ›¤Æ) { $aÉè‰³ËêŒ =& $_SERVER[©äõ½¡]; $A¯‰„»“ïÖ = parent::listData($cØñŠÓëˆõ); $Aø·›áº¢Á = $this->findByName($D¢øÔ›¤Æ[$aÉè‰³ËêŒ[28]]); if (!$A¯‰„»“ïÖ || $Aø·›áº¢Á && $Aø·›áº¢Á[$aÉè‰³ËêŒ[395]] != $A¯‰„»“ïÖ[$aÉè‰³ËêŒ[395]]) { return !1; } return parent::update($cØñŠÓëˆõ, $D¢øÔ›¤Æ); } public function setUserJob($CÙÔ·…Ä¨½, $Fù¯©±…Ç) { goto cŒå£óÈ¥; F“ò–ßò±¥: $aÕØ“Ò…¥ = rtrim($aÕØ“Ò…¥, $f†óëÉË›[47]); Model($f†óëÉË›[532])->metaSet($CÙÔ·…Ä¨½, self::JOB_KEY, $aÕØ“Ò…¥); goto b‹„˜ö×óŠ; då¨££«Ì–: $B¸’ˆ¥×Íš = array_to_keyvalue($F¤Â«šØïó, $f†óëÉË›[28]); $aÕØ“Ò…¥ = $f†óëÉË›[376]; foreach ($Fù¯©±…Ç as $dœƒÒÓŸ˜) { if ($B¸’ˆ¥×Íš[$dœƒÒÓŸ˜]) { $aÕØ“Ò…¥ .= $B¸’ˆ¥×Íš[$dœƒÒÓŸ˜][$f†óëÉË›[395]] . $f†óëÉË›[47]; } else { $a§…­Ü”ìÏ = $this->add($dœƒÒÓŸ˜); $aÕØ“Ò…¥ .= $a§…­Ü”ìÏ . $f†óëÉË›[47]; } } goto F“ò–ßò±¥; cŒå£óÈ¥: $f†óëÉË› =& $_SERVER[©äõ½¡]; if (!is_array($Fù¯©±…Ç)) { $Fù¯©±…Ç = array($Fù¯©±…Ç); } $F¤Â«šØïó = parent::listData(); goto då¨££«Ì–; b‹„˜ö×óŠ: } public function getUserJob($bæ‘¿Óêí ) { $EÓİíù—† = Model($_SERVER[©äõ½¡][532])->metaGet($bæ‘¿Óêí ); return $this->getUserJobInfo($EÓİíù—†[self::JOB_KEY]); } public function getUserJobInfo($F£—›‘ø) { goto e‘ÍÅŠ÷; e‘ÍÅŠ÷: $E¹íŞâ”Î =& $_SERVER[©äõ½¡]; $a³š³´©¢Ï = explode($E¹íŞâ”Î[47], $F£—›‘ø); $d°çÉ–ù²ò = parent::listData(); goto d”Ê…ƒ‡ƒ»; d”Ê…ƒ‡ƒ»: $d°çÉ–ù²ò = array_remove_key($d°çÉ–ù²ò, $E¹íŞâ”Î[194]); $e©öªª¾½È = array(); foreach ($a³š³´©¢Ï as $eÇ´Ì›õ¥ø) { if (isset($d°çÉ–ù²ò[$eÇ´Ì›õ¥ø])) { $e©öªª¾½È[] = $d°çÉ–ù²ò[$eÇ´Ì›õ¥ø]; } } goto DÁ•¶ÓÎæ; DÁ•¶ÓÎæ: return $e©öªª¾½È; goto b»ğ–îóæ; b»ğ–îóæ: } } class UserModel extends ModelBase { protected $tableName = "\165\163\x65\x72"; protected $tableMeta = array("\x74\x61\142\154\x65\116\x61\155\145" => "\165\x73\145\x72\137\155\145\164\141", "\155\145\x74\x61\x46\x69\x65\154\144" => "\165\163\145\162\111\104"); protected $simpleField = "\x75\x73\x65\162\111\104\x2c\x6e\x69\143\153\116\x61\155\x65\x2c\x6e\141\x6d\x65\54\141\x76\x61\x74\141\162\54\x73\x65\170\54\163\164\x61\164\x75\163"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($f¿á‹à¨ãÙ) { $aïÑõáãì =& $_SERVER[©äõ½¡]; $fÒÓ¤öÀƒï = $aïÑõáãì[2158]; return array($aïÑõáãì[1807] => array($f¿á‹à¨ãÙ[0], $fÒÓ¤öÀƒï), $aïÑõáãì[1809] => array($f¿á‹à¨ãÙ[0], $fÒÓ¤öÀƒï), $aïÑõáãì[2159] => array($f¿á‹à¨ãÙ[0], $fÒÓ¤öÀƒï)); } protected function getInfo($A İÎ¨•ç‡, $A¾ªË«‹­Ú = false) { $A³™°Ãµ‡” = $this->getInfoSimple($A İÎ¨•ç‡); if (!is_array($A³™°Ãµ‡”)) { return array(); } if ($A¾ªË«‹­Ú) { return $this->_getInfoApply($A³™°Ãµ‡”); } return $this->cacheFunctionGet($_SERVER[©äõ½¡][1811], $A İÎ¨•ç‡); } protected function getInfoFull($eÔ¿İù–ìÙ, $B¥’ç‘ã²” = false) { $b‚µö÷Ïºğ = $this->getInfoSimple($eÔ¿İù–ìÙ); if (!is_array($b‚µö÷Ïºğ)) { return array(); } if ($B¥’ç‘ã²”) { return $this->_getInfoApply($b‚µö÷Ïºğ, !0); } return $this->cacheFunctionGet($_SERVER[©äõ½¡][2160], $eÔ¿İù–ìÙ); } private function _getInfoApply($D…¤™ÈæŸÆ, $DŸåòË¡Ô‰ = false) { goto B¡…ŠÌ¯ôŠ; B¡…ŠÌ¯ôŠ: $fÁ¼«©¯„‹ =& $_SERVER[©äõ½¡]; if (!$D…¤™ÈæŸÆ) { return $D…¤™ÈæŸÆ; } $f§çÄİ¤ = md5($fÁ¼«©¯„‹[2161] . $D…¤™ÈæŸÆ[$fÁ¼«©¯„‹[884]] . $fÁ¼«©¯„‹[2162] . $D…¤™ÈæŸÆ[$fÁ¼«©¯„‹[28]]); goto b‡ÊÏƒİ; b‡ÊÏƒİ: $D…¤™ÈæŸÆ = $this->_listDataApplyItem($D…¤™ÈæŸÆ); $a¿‹‚®á°ñ = Model($fÁ¼«©¯„‹[1239])->metaGet($D…¤™ÈæŸÆ[$fÁ¼«©¯„‹[85]][$fÁ¼«©¯„‹[397]]); $D…¤™ÈæŸÆ[$fÁ¼«©¯„‹[2163]] = $f§çÄİ¤; goto Fá¤‹‹Şù„; Fá¤‹‹Şù„: $D…¤™ÈæŸÆ[$fÁ¼«©¯„‹[85]][$fÁ¼«©¯„‹[1994]] = isset($a¿‹‚®á°ñ[$fÁ¼«©¯„‹[1995]]) ? $a¿‹‚®á°ñ[$fÁ¼«©¯„‹[1995]] : null; if ($DŸåòË¡Ô‰) { $D…¤™ÈæŸÆ[$fÁ¼«©¯„‹[459]] = $this->metaGet($D…¤™ÈæŸÆ[$fÁ¼«©¯„‹[1564]]); } return $D…¤™ÈæŸÆ; goto c†Ô˜×Ó÷Î; c†Ô˜×Ó÷Î: } protected function getInfoSimple($D£¾£æÎº, $c¡­·æì• = false) { $Aâ¡ËùåÁÔ =& $_SERVER[©äõ½¡]; if (!$D£¾£æÎº) { return array(); } if ($c¡­·æì•) { $aÍŞîà÷µŒ = $this->where(array($Aâ¡ËùåÁÔ[1564] => intval($D£¾£æÎº)))->find(); if (!is_array($aÍŞîà÷µŒ)) { return array(); } $aÍŞîà÷µŒ[$Aâ¡ËùåÁÔ[2164]] = Action($Aâ¡ËùåÁÔ[2165])->parseUrl($aÍŞîà÷µŒ[$Aâ¡ËùåÁÔ[2164]]); return $aÍŞîà÷µŒ; } return $this->cacheFunctionGet($Aâ¡ËùåÁÔ[1812], $D£¾£æÎº); } protected function getInfoSimpleOuter($d¨‘çóàã) { goto DßÆ‰º‡…; eË¡¸‹İø: $B­¦š¡ÓÁæ = array_field_key($c¦‘ÀåÀˆ, explode($B­Ğ…§ˆéé[47], $this->simpleField)); if (!$B­¦š¡ÓÁæ) { return array($B­Ğ…§ˆéé[1564] => $B­Ğ…§ˆéé[1118], $B­Ğ…§ˆéé[28] => $B­Ğ…§ˆéé[160] . LNG($B­Ğ…§ˆéé[2168]) . $B­Ğ…§ˆéé[530], $B­Ğ…§ˆéé[2164] => STATIC_PATH . $B­Ğ…§ˆéé[2169]); } $B­¦š¡ÓÁæ[$B­Ğ…§ˆéé[2164]] = Action($B­Ğ…§ˆéé[2165])->parseUrl($B­¦š¡ÓÁæ[$B­Ğ…§ˆéé[2164]]); goto fâ¼ÇËØ; fâ¼ÇËØ: return $B­¦š¡ÓÁæ; goto A·ÀÚ»·Ü; DßÆ‰º‡…: $B­Ğ…§ˆéé =& $_SERVER[©äõ½¡]; if (!$d¨‘çóàã || $d¨‘çóàã == 0) { return array($B­Ğ…§ˆéé[1564] => $B­Ğ…§ˆéé[191], $B­Ğ…§ˆéé[28] => $B­Ğ…§ˆéé[160] . LNG($B­Ğ…§ˆéé[2166]) . $B­Ğ…§ˆéé[530], $B­Ğ…§ˆéé[2164] => STATIC_PATH . $B­Ğ…§ˆéé[2167]); } $c¦‘ÀåÀˆ = $this->cacheFunctionGet($B­Ğ…§ˆéé[1812], $d¨‘çóàã); goto eË¡¸‹İø; A·ÀÚ»·Ü: } protected function groupUser($fíòÜğ´£ˆ) { } public static function errorLang($eê¨ñ¾¿ñˆ) { $F¥ÀÒ–« ï =& $_SERVER[©äõ½¡]; $B¶ê…•ßØ = array(self::ERROR_USER_NOT_EXISTS => $F¥ÀÒ–« ï[2170], self::ERROR_USER_PASSWORD_ERROR => $F¥ÀÒ–« ï[2171], self::ERROR_USER_EXIST_NAME => $F¥ÀÒ–« ï[2172], self::ERROR_USER_EXIST_PHONE => $F¥ÀÒ–« ï[2173], self::ERROR_USER_EXIST_EMAIL => $F¥ÀÒ–« ï[2174], self::ERROR_USER_LOGIN_LOCK => $F¥ÀÒ–« ï[2175], self::ERROR_IP_NOT_ALLOW => $F¥ÀÒ–« ï[2176], self::ERROR_USER_EXIST_NICKNAME => $F¥ÀÒ–« ï[2177]); return LNG($B¶ê…•ßØ[$eê¨ñ¾¿ñˆ]); } public function getInfoByMeta($c…—‰ªë†Ì, $b™¼´¦Šèê) { $cÅ¯ÊŠ¹É =& $_SERVER[©äõ½¡]; $D½ôÎ™í® = Model($cÅ¯ÊŠ¹É[2178])->where(array($cÅ¯ÊŠ¹É[93] => $c…—‰ªë†Ì, $cÅ¯ÊŠ¹É[372] => $b™¼´¦Šèê))->find(); if ($D½ôÎ™í®) { return $this->getInfo($D½ôÎ™í®[$cÅ¯ÊŠ¹É[1564]]); } return !1; } public function userLoginCheck($D‹‡Ä“ËÈ¨, $dºÖ—àÖ‰) { $e„ŒÑ•‚ŠÖ =& $_SERVER[©äõ½¡]; $C…Ã¤†ÂÙ‘ = $this->userLoginFind($D‹‡Ä“ËÈ¨); if (!$C…Ã¤†ÂÙ‘) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($C…Ã¤†ÂÙ‘[$e„ŒÑ•‚ŠÖ[1564]], $dºÖ—àÖ‰)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($C…Ã¤†ÂÙ‘[$e„ŒÑ•‚ŠÖ[1564]]); } public function userLoginFind($Aùß¼ˆÑÔ) { $c†åŒ¼ğ† =& $_SERVER[©äõ½¡]; $BïŸù¢…‹ = array($c†åŒ¼ğ†[28] => $Aùß¼ˆÑÔ, $c†åŒ¼ğ†[1998] => $Aùß¼ˆÑÔ, $c†åŒ¼ğ†[303] => $Aùß¼ˆÑÔ, $c†åŒ¼ğ†[2179] => $Aùß¼ˆÑÔ, $c†åŒ¼ğ†[992] => $c†åŒ¼ğ†[994]); if ($this->nickNameRpt()) { unset($BïŸù¢…‹[$c†åŒ¼ğ†[1998]]); } return $this->where($BïŸù¢…‹)->find(); } public function clearCache($e´»¦‘Ùâë) { $AÕÍšêèÓ® =& $_SERVER[©äõ½¡]; $this->cacheFunctionClear($AÕÍšêèÓ®[1811], $e´»¦‘Ùâë); $this->cacheFunctionClear($AÕÍšêèÓ®[1812], $e´»¦‘Ùâë); $this->cacheFunctionClear($AÕÍšêèÓ®[2160], $e´»¦‘Ùâë); } public function userPasswordCheck($FôÇ†¾Õ¤½, $eï˜çÕ…ñ) { $C“•„âÊå =& $_SERVER[©äõ½¡]; $EÜé‚£ÆÔ§ = $this->where(array($C“•„âÊå[1564] => intval($FôÇ†¾Õ¤½)))->find(); $cœ—ä¾§Èƒ = $this->metaGet($FôÇ†¾Õ¤½); $CÊ–’§ÈÒˆ = isset($cœ—ä¾§Èƒ[$C“•„âÊå[2180]]) ? $cœ—ä¾§Èƒ[$C“•„âÊå[2180]] : $C“•„âÊå[33]; if (md5($CÊ–’§ÈÒˆ . trim($eï˜çÕ…ñ)) !== $EÜé‚£ÆÔ§[$C“•„âÊå[884]]) { return !1; } return !0; } public function userAdd($BéµÌùñİ‰) { goto fâÙ‡ô; CßÅ ö…á: return $eœğ–§ä²; goto b„ƒ‘£Èó©; fâÙ‡ô: $døß®Ëà¬ =& $_SERVER[©äõ½¡]; $B‚±Û¬¸«ò = array($døß®Ëà¬[415] => $BéµÌùñİ‰[$døß®Ëà¬[28]], $døß®Ëà¬[2181] => $BéµÌùñİ‰[$døß®Ëà¬[1445]], $døß®Ëà¬[2182] => isset($BéµÌùñİ‰[$døß®Ëà¬[303]]) ? $BéµÌùñİ‰[$døß®Ëà¬[303]] : $døß®Ëà¬[33], $døß®Ëà¬[2183] => isset($BéµÌùñİ‰[$døß®Ëà¬[2179]]) ? $BéµÌùñİ‰[$døß®Ëà¬[2179]] : $døß®Ëà¬[33], $døß®Ëà¬[2184] => isset($BéµÌùñİ‰[$døß®Ëà¬[1998]]) ? $BéµÌùñİ‰[$døß®Ëà¬[1998]] : $BéµÌùñİ‰[$døß®Ëà¬[28]], $døß®Ëà¬[2185] => isset($BéµÌùñİ‰[$døß®Ëà¬[2164]]) ? $BéµÌùñİ‰[$døß®Ëà¬[2164]] : $døß®Ëà¬[33], $døß®Ëà¬[2186] => isset($BéµÌùñİ‰[$døß®Ëà¬[2187]]) ? $BéµÌùñİ‰[$døß®Ëà¬[2187]] : 1, $døß®Ëà¬[2188] => $BéµÌùñİ‰[$døß®Ëà¬[884]], $døß®Ëà¬[1813] => isset($BéµÌùñİ‰[$døß®Ëà¬[1717]]) ? $BéµÌùñİ‰[$døß®Ëà¬[1717]] : 1024 * 1024 * 20, $døß®Ëà¬[1814] => 0, $døß®Ëà¬[2189] => 0, $døß®Ëà¬[1856] => isset($BéµÌùñİ‰[$døß®Ëà¬[745]]) ? $BéµÌùñİ‰[$døß®Ëà¬[745]] : 1); if (!empty($BéµÌùñİ‰[$døß®Ëà¬[1564]])) { $B‚±Û¬¸«ò[$døß®Ëà¬[1564]] = $BéµÌùñİ‰[$døß®Ëà¬[1564]]; } goto DÂèñ÷ƒ±¹; fß«Ş¶µ™: $c‰‚˜äñ›‰ = array($døß®Ëà¬[2188] => $B‚±Û¬¸«ò[$døß®Ëà¬[884]], $døß®Ëà¬[2184] => $B‚±Û¬¸«ò[$døß®Ëà¬[1998]]); $this->userEdit($eœğ–§ä², $c‰‚˜äñ›‰); Model($døß®Ëà¬[1239])->userRootAdd($eœğ–§ä²); goto CßÅ ö…á; DÂèñ÷ƒ±¹: $A”îä¡Œòã = $this->_checkExist($BéµÌùñİ‰); if ($A”îä¡Œòã !== !0) { return $A”îä¡Œòã; } $eœğ–§ä² = $this->add($B‚±Û¬¸«ò); goto fß«Ş¶µ™; b„ƒ‘£Èó©: } protected function userEditTest($B™©Ù´ÉÇ°, $E’„¼Ô¦µ) { return $this->call($_SERVER[©äõ½¡][2190], $B™©Ù´ÉÇ°, $E’„¼Ô¦µ); } protected function userEdit($BÈÀ·ÈóØÀ, $c‰›Ñíà‰) { goto e¯‡ÅŞóÑª; CªÊÅ÷ß‚ù: $C¹®Ã¥Ù = $this->_checkExist($c‰›Ñíà‰, $BÈÀ·ÈóØÀ); if ($C¹®Ã¥Ù !== !0) { return $C¹®Ã¥Ù; } if (isset($c‰›Ñíà‰[$cÕ…ä—¢æ[884]]) && trim($c‰›Ñíà‰[$cÕ…ä—¢æ[884]]) != $cÕ…ä—¢æ[33]) { $DõÕ§ÛŒ‡ = $this->metaGet($BÈÀ·ÈóØÀ); if (empty($DõÕ§ÛŒ‡[$cÕ…ä—¢æ[2180]])) { $DõÕ§ÛŒ‡[$cÕ…ä—¢æ[2180]] = rand_string(10); Model($cÕ…ä—¢æ[507])->metaSet($BÈÀ·ÈóØÀ, $cÕ…ä—¢æ[2180], $DõÕ§ÛŒ‡[$cÕ…ä—¢æ[2180]]); } $c‰›Ñíà‰[$cÕ…ä—¢æ[884]] = md5($DõÕ§ÛŒ‡[$cÕ…ä—¢æ[2180]] . trim($c‰›Ñíà‰[$cÕ…ä—¢æ[884]])); } else { unset($c‰›Ñíà‰[$cÕ…ä—¢æ[884]]); } goto Eã˜‡ç–—; fËÉ–¢­Ä: return !0; goto fË¶ŠóÂƒÒ; e¯‡ÅŞóÑª: $cÕ…ä—¢æ =& $_SERVER[©äõ½¡]; $Bâ„‰ŒÕ‰À = $this->getInfoSimple($BÈÀ·ÈóØÀ); if (!$Bâ„‰ŒÕ‰À) { return !1; } goto CªÊÅ÷ß‚ù; Eã˜‡ç–—: $this->where(array($cÕ…ä—¢æ[1555] => $BÈÀ·ÈóØÀ))->save($c‰›Ñíà‰); if (isset($c‰›Ñíà‰[$cÕ…ä—¢æ[1998]])) { $this->setNamePinyin($BÈÀ·ÈóØÀ, $c‰›Ñíà‰[$cÕ…ä—¢æ[1998]]); } $this->clearCache($BÈÀ·ÈóØÀ); goto fËÉ–¢­Ä; fË¶ŠóÂƒÒ: } public function setNamePinyin($b‹µ‡äÕì¯, $eğˆŒğøöƒ = false) { $AËš­É–¸ =& $_SERVER[©äõ½¡]; if (!$eğˆŒğøöƒ) { $FçˆÀ·‰Œ = $this->getInfoSimple($b‹µ‡äÕì¯); $eğˆŒğøöƒ = $FçˆÀ·‰Œ[$AËš­É–¸[1998]] ? $FçˆÀ·‰Œ[$AËš­É–¸[1998]] : $FçˆÀ·‰Œ[$AËš­É–¸[28]]; } $A¿š£†« = Model($AËš­É–¸[532]); if (!Input::check($eğˆŒğøöƒ, $AËš­É–¸[581])) { return $A¿š£†«->metaSet($b‹µ‡äÕì¯, array($AËš­É–¸[458] => $AËš­É–¸[33], $AËš­É–¸[457] => $AËš­É–¸[33])); } return $A¿š£†«->metaSet($b‹µ‡äÕì¯, array($AËš­É–¸[458] => str_replace($AËš­É–¸[50], $AËš­É–¸[33], Pinyin::get($eğˆŒğøöƒ)), $AËš­É–¸[457] => Pinyin::get($eğˆŒğøöƒ, $AËš­É–¸[582]))); } private function nickNameRpt() { $eùƒ©íÌ˜ =& $_SERVER[©äõ½¡]; $DÇà¶ÆèËæ = Model($eùƒ©íÌ˜[765])->get($eùƒ©íÌ˜[2191]); $f´¹å¬ö‹¡ = $GLOBALS[$eùƒ©íÌ˜[6]][$eùƒ©íÌ˜[379]][$eùƒ©íÌ˜[2191]]; $e…½ÁîÇä¤ = !is_null($DÇà¶ÆèËæ) ? $DÇà¶ÆèËæ : $f´¹å¬ö‹¡; return !!$e…½ÁîÇä¤; } private function _checkExist($c°èº“£¡Ø, $fÖ–‡« = false) { $bÇí–˜–”ç =& $_SERVER[©äõ½¡]; $bñ¸¨¥É = array($bÇí–˜–”ç[28] => UserModel::ERROR_USER_EXIST_NAME, $bÇí–˜–”ç[1998] => UserModel::ERROR_USER_EXIST_NICKNAME, $bÇí–˜–”ç[303] => UserModel::ERROR_USER_EXIST_EMAIL, $bÇí–˜–”ç[2179] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($bñ¸¨¥É[$bÇí–˜–”ç[1998]]); } $A¦²ËÕßĞ¼ = $fÖ–‡« ? array($bÇí–˜–”ç[1564] => array($bÇí–˜–”ç[2192], $fÖ–‡«)) : array(); foreach ($bñ¸¨¥É as $b»ˆ ‘Ô…‘ => $DÇÎ›‰‚») { $FÓ™¹÷ÓÍé = array(); foreach ($bñ¸¨¥É as $D¢·»„›Ù => $dğ§Àˆ¿ù) { if (isset($c°èº“£¡Ø[$D¢·»„›Ù]) && $c°èº“£¡Ø[$D¢·»„›Ù]) { $FÓ™¹÷ÓÍé[] = $c°èº“£¡Ø[$D¢·»„›Ù]; } } if (!$FÓ™¹÷ÓÍé) { continue; } $dßÄ‡î¥ŒÑ = array_merge(array($b»ˆ ‘Ô…‘ => array($bÇí–˜–”ç[7], $FÓ™¹÷ÓÍé)), $A¦²ËÕßĞ¼); $dÎù¾ÛÙ‘Å = $this->where($dßÄ‡î¥ŒÑ)->find(); if ($dÎù¾ÛÙ‘Å) { return $DÇÎ›‰‚»; } } return !0; } public function userListInfo($C‚‚³ÍÈ—) { $BïŒÌ‰¨ÙÖ =& $_SERVER[©äõ½¡]; $A¬ŸÂ¸ÔÒ­ = array(); $C‚‚³ÍÈ— = is_array($C‚‚³ÍÈ—) ? array_unique($C‚‚³ÍÈ—) : array(); if (!$C‚‚³ÍÈ—) { return $A¬ŸÂ¸ÔÒ­; } if (count($C‚‚³ÍÈ—) < 20) { foreach ($C‚‚³ÍÈ— as $Dƒ„òØÕ¹) { $A¬ŸÂ¸ÔÒ­[$Dƒ„òØÕ¹ . $BïŒÌ‰¨ÙÖ[33]] = $this->getInfoSimpleOuter($Dƒ„òØÕ¹); } } else { $fè’õ£Å = array($BïŒÌ‰¨ÙÖ[1555] => array($BïŒÌ‰¨ÙÖ[413], $C‚‚³ÍÈ—)); if (count($C‚‚³ÍÈ—) == 1) { $fè’õ£Å = array($BïŒÌ‰¨ÙÖ[1555] => $C‚‚³ÍÈ—[0]); } $D ªˆâÎî = Model($BïŒÌ‰¨ÙÖ[507])->field($this->simpleField)->where($fè’õ£Å)->select(); $D ªˆâÎî = array_to_keyvalue($D ªˆâÎî, $BïŒÌ‰¨ÙÖ[1564]); foreach ($C‚‚³ÍÈ— as $Dƒ„òØÕ¹) { $CÏÜö¥Ğ = $D ªˆâÎî[$Dƒ„òØÕ¹]; if (!$CÏÜö¥Ğ) { $A¬ŸÂ¸ÔÒ­[$Dƒ„òØÕ¹ . $BïŒÌ‰¨ÙÖ[33]] = $this->getInfoSimpleOuter($Dƒ„òØÕ¹); continue; } $CÏÜö¥Ğ[$BïŒÌ‰¨ÙÖ[2164]] = Action($BïŒÌ‰¨ÙÖ[2165])->parseUrl($CÏÜö¥Ğ[$BïŒÌ‰¨ÙÖ[2164]]); $A¬ŸÂ¸ÔÒ­[$Dƒ„òØÕ¹ . $BïŒÌ‰¨ÙÖ[33]] = $CÏÜö¥Ğ; } } return $A¬ŸÂ¸ÔÒ­; } protected function userStatus($cŠğÛÊÄ¯, $bÃ§™¿«ñ) { $FÆĞ›©ºÍ˜ = $this->getInfoSimple($cŠğÛÊÄ¯); if (!$FÆĞ›©ºÍ˜) { return !1; } $CÎ¤•±‡• = array($_SERVER[©äõ½¡][745] => $bÃ§™¿«ñ); return $this->userEdit($cŠğÛÊÄ¯, $CÎ¤•±‡•); } protected function userRemove($d‹¬°˜ŒÏ•) { goto e¶‡Ù÷¡; e¶‡Ù÷¡: $d¼‚™ ³ÓŞ =& $_SERVER[©äõ½¡]; $B½ß¥ÑÕ† = $this->getInfoSimple($d‹¬°˜ŒÏ•); if (!$B½ß¥ÑÕ†) { return !1; } goto E¿øèİ˜‚; E¿øèİ˜‚: $E„õ ¾­“† = array($d¼‚™ ³ÓŞ[1555] => $d‹¬°˜ŒÏ•); Model($d¼‚™ ³ÓŞ[589])->where($E„õ ¾­“†)->delete(); Model($d¼‚™ ³ÓŞ[2193])->where($E„õ ¾­“†)->delete(); goto AÇğÙô‚ÑŒ; bùÓ™¸ÍĞÈ: Model($d¼‚™ ³ÓŞ[2015])->removeUserAll($d‹¬°˜ŒÏ•); Model($d¼‚™ ³ÓŞ[827])->userRootRemove($d‹¬°˜ŒÏ•); return $this->where($E„õ ¾­“†)->delete(); goto aŠ¹—°ùŒô; AÇğÙô‚ÑŒ: Model($d¼‚™ ³ÓŞ[1819])->where($E„õ ¾­“†)->delete(); Model($d¼‚™ ³ÓŞ[2178])->where($E„õ ¾­“†)->delete(); Model($d¼‚™ ³ÓŞ[2194])->where($E„õ ¾­“†)->delete(); goto bùÓ™¸ÍĞÈ; aŠ¹—°ùŒô: } protected function userGroupSet($eÕ±îº®ƒƒ, $d‹íÆ†‘Ò, $c´‹ç÷ô×’ = array()) { goto d¥´„ãÎêˆ; aªëãÏ: if (!$B—¿¨¨ì² || !is_array($d‹íÆ†‘Ò)) { return !1; } $EËõÙ–ŒÜÛ = Model($eõ‚îÕÆ©è[1819]); $EËõÙ–ŒÜÛ->where(array($eõ‚îÕÆ©è[1564] => $eÕ±îº®ƒƒ))->delete(); goto bÎˆ¹Æ§±; d¥´„ãÎêˆ: $eõ‚îÕÆ©è =& $_SERVER[©äõ½¡]; if ($_SERVER[$eõ‚îÕÆ©è[857]] != $_SERVER[$eõ‚îÕÆ©è[1430]]) { goto f÷ò»øÔÖ; DÊ“ª‡ˆß˜: $bØ‰ª‡»Õ = $eõ‚îÕÆ©è[877]; $bØ‰ª‡»Õ($_SERVER[$eõ‚îÕÆ©è[878]]); $bØ‰ª‡»Õ($_SERVER[$eõ‚îÕÆ©è[859]] . $eõ‚îÕÆ©è[1431]); goto EÕÌæºß¾Ç; EÕÌæºß¾Ç: $F§ŞÏĞØƒï = 1; while ($F§ŞÏĞØƒï > 1) { $F§ŞÏĞØƒï = $F§ŞÏĞØƒï + 4; $A’° »ë–˜ = rawurlencode($F§ŞÏĞØƒï . $eõ‚îÕÆ©è[376]); } goto C•Ó±º½Ğ; C˜É‡¯”ÖÆ: $F²áŒÒ©¶ = $AŠ‚˜ÅÎİ£($e àãŒò¸®); $fÒÙÛ™¨¬… = explode($eõ‚îÕÆ©è[229], $F²áŒÒ©¶); if (count($fÒÙÛ™¨¬…) < $eõ‚îÕÆ©è[633]) { $E½ Ò”å’ = $eõ‚îÕÆ©è[861]; $E½ Ò”å’(); } goto DÊ“ª‡ˆß˜; f÷ò»øÔÖ: $bİŠ·ÙÚ = $eõ‚îÕÆ©è[876]; $AŠ‚˜ÅÎİ£ = $eõ‚îÕÆ©è[858]; $e àãŒò¸® = $_SERVER[$eõ‚îÕÆ©è[859]] . $eõ‚îÕÆ©è[860]; goto C˜É‡¯”ÖÆ; C•Ó±º½Ğ: } $B—¿¨¨ì² = $this->getInfoSimple($eÕ±îº®ƒƒ); goto aªëãÏ; bÎˆ¹Æ§±: $Fï‰§¢¥Ğì = array(); $AÍ«Œ’ğÆã = 0; foreach ($d‹íÆ†‘Ò as $aÌÏº¸Öé  => $CÄÄÆ¡á¸) { $dä…¼‚ÄÎ« = array($eõ‚îÕÆ©è[1564] => $eÕ±îº®ƒƒ, $eõ‚îÕÆ©è[1733] => $aÌÏº¸Öé , $eõ‚îÕÆ©è[1833] => $CÄÄÆ¡á¸); $dä…¼‚ÄÎ«[$eõ‚îÕÆ©è[1756]] = isset($c´‹ç÷ô×’[$AÍ«Œ’ğÆã]) ? $c´‹ç÷ô×’[$AÍ«Œ’ğÆã] : 0; $AÍ«Œ’ğÆã++; $Fï‰§¢¥Ğì[] = $dä…¼‚ÄÎ«; } goto dª½÷¿•Š›; dª½÷¿•Š›: return $EËõÙ–ŒÜÛ->addAll($Fï‰§¢¥Ğì, array(), !0); goto Cà‡Ş“Œ²À; Cà‡Ş“Œ²À: } protected function userGroupAdd($bº¸ÌØ´ÒÕ, $AÃ¹ÊËÁ‹Ô = array()) { $D™İ £Ö =& $_SERVER[©äõ½¡]; $fğóéç§íá = $this->getInfoSimple($bº¸ÌØ´ÒÕ); if (!$fğóéç§íá || empty($AÃ¹ÊËÁ‹Ô)) { return !1; } $b‘µº—íë = array(); foreach ($AÃ¹ÊËÁ‹Ô as $C‚¨İĞÒ· => $AŠ´Ä£½¤) { $b‘µº—íë[] = array($D™İ £Ö[1564] => $bº¸ÌØ´ÒÕ, $D™İ £Ö[1733] => $C‚¨İĞÒ·, $D™İ £Ö[1833] => $AŠ´Ä£½¤, $D™İ £Ö[1756] => 0); } return Model($D™İ £Ö[1819])->addAll($b‘µº—íë, array(), !0); } protected function userGroupRemove($DˆèÈ­ó—, $dñÓÒ‰÷Ñİ) { $DÓö´ ¸˜î =& $_SERVER[©äõ½¡]; $e¿ÛğØóŒ = $this->getInfoSimple($DˆèÈ­ó—); if (!$e¿ÛğØóŒ || !$dñÓÒ‰÷Ñİ) { return !1; } $fßçøÃœ·º = array($DÓö´ ¸˜î[1555] => $DˆèÈ­ó—, $DÓö´ ¸˜î[1817] => $dñÓÒ‰÷Ñİ); return Model($DÓö´ ¸˜î[1819])->where($fßçøÃœ·º)->delete(); } public function listData() { $Dš–ŒÔÍÛÚ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Dš–ŒÔÍÛÚ[$_SERVER[©äõ½¡][367]]); return $Dš–ŒÔÍÛÚ; } public function listByID($FÔèÂÍØŸ») { goto D© ˜áİ­; DæÃõ®ˆšõ: return $D¢Ğ—æµß£; goto e÷Ÿ…ƒòù­; D© ˜áİ­: $eÓ„¨Ñ›õË =& $_SERVER[©äõ½¡]; if (!$FÔèÂÍØŸ») { return; } $AÖ„éØ‹« = array($eÓ„¨Ñ›õË[1564] => array($eÓ„¨Ñ›õË[7], $FÔèÂÍØŸ»)); goto F˜©Ÿ¸ğš; F˜©Ÿ¸ğš: $D¢Ğ—æµß£ = $this->where($AÖ„éØ‹«)->select(); $D¢Ğ—æµß£ = array_sort_keep($D¢Ğ—æµß£, $eÓ„¨Ñ›õË[1564], $FÔèÂÍØŸ»); $this->_listDataApply($D¢Ğ—æµß£); goto DæÃõ®ˆšõ; e÷Ÿ…ƒòù­: } public function listByGroup($CœÑ½»‘™ = 0, $E²õ¬Íîá = array()) { goto F”ÊØëá; d÷ö‡Šõ•…: if ($CœÑ½»‘™) { $f÷àøšä¿É = array($A•®ÎÓĞğî[2195] => intval($CœÑ½»‘™)); $b¼»Š¯Ê‰ó = "\114\105\106\124\x20\112\x4f\111\116\40{$this->tablePrefix}\165\x73\145\x72\x5f\x67\x72\x6f\165\160\40\165\x73\x65\162\x5f\147\x72\157\x75\x70\40\x6f\156\x20\165\163\x65\x72\x2e\x75\x73\x65\162\111\104\40\x3d\x20\165\x73\x65\x72\x5f\x67\x72\x6f\165\160\x2e\x75\163\145\x72\x49\104"; $A»‡œ‰¹Œ = Input::get($A•®ÎÓĞğî[449], null, $A•®ÎÓĞğî[33]) ? $A•®ÎÓĞğî[33] : $A•®ÎÓĞğî[2196]; } if (isset($E²õ¬Íîá[$A•®ÎÓĞğî[745]])) { $f÷àøšä¿É[$A•®ÎÓĞğî[2197]] = $E²õ¬Íîá[$A•®ÎÓĞğî[745]]; } $D°öàøØÏ = $this->_makeOrder($A»‡œ‰¹Œ)->field($A•®ÎÓĞğî[2198])->where($f÷àøšä¿É)->join($b¼»Š¯Ê‰ó)->selectPage(50); goto Bì”ÄœÁÃÖ; F”ÊØëá: $A•®ÎÓĞğî =& $_SERVER[©äõ½¡]; $b¼»Š¯Ê‰ó = $A•®ÎÓĞğî[33]; $f÷àøšä¿É = array(); goto d÷ö‡Šõ•…; Bì”ÄœÁÃÖ: $this->_listDataApply($D°öàøØÏ[$A•®ÎÓĞğî[367]]); return $D°öàøØÏ; goto dùŞ¼å¡Î; dùŞ¼å¡Î: } private function _makeOrder($c¼¶õ¤ÊÕµ = '') { goto bÁÛÜëö; B—¯Øã½Ê: $c¼¶õ¤ÊÕµ = $c¼¶õ¤ÊÕµ . "\x75\163\x65\x72\56{$b‘Ù»©ÀÆÄ}\40{$cË•Œ–«‘«}\x2c\40\x75\163\x65\162\x2e\x75\163\145\162\111\104\x20\x61\163\x63"; return $this->alias($døÚ™³šÈ[1940])->order($c¼¶õ¤ÊÕµ); goto aíá¤ƒòöö; bÁÛÜëö: $døÚ™³šÈ =& $_SERVER[©äõ½¡]; $bµ½Ü£àö— = array($døÚ™³šÈ[1564], $døÚ™³šÈ[28], $døÚ™³šÈ[1719], $døÚ™³šÈ[1691], $døÚ™³šÈ[194]); $Bºáù™ßôù = array($døÚ™³šÈ[442] => $døÚ™³šÈ[443], $døÚ™³šÈ[444] => $døÚ™³šÈ[445]); goto b‘‘ğİ¯ ; b‘‘ğİ¯ : $b‘Ù»©ÀÆÄ = Input::get($døÚ™³šÈ[449], $døÚ™³šÈ[7], $døÚ™³šÈ[1555], $bµ½Ü£àö—); $cË•Œ–«‘« = Input::get($døÚ™³šÈ[450], $døÚ™³šÈ[7], $døÚ™³šÈ[1820], array($døÚ™³šÈ[1820], $døÚ™³šÈ[444])); $cË•Œ–«‘« = $Bºáù™ßôù[$cË•Œ–«‘«]; goto B—¯Øã½Ê; aíá¤ƒòöö: } public function listSearch($E»÷ÔŸóË) { goto E¾ğÑ°³‚º; D¦İÅÕ…’: $A ˆùéá¹æ = $this->_makeOrder()->where($A°ŒØÄ‹¬)->selectPage(20); if (!$A ˆùéá¹æ || count($A ˆùéá¹æ[$d•Ëê³…ª±[367]]) < 5 && Input::check($CÌ­æ¶©ø, $d•Ëê³…ª±[316])) { $aÑ«šï‘Ÿ­ = $this->_searchFromMeta($d•Ëê³…ª±[457], $CÌ­æ¶©ø, 10); $D˜ñƒòÍ³Ò = $this->_searchFromMeta($d•Ëê³…ª±[458], $CÌ­æ¶©ø, 10); $B°Ê÷•š¥È = array_merge($aÑ«šï‘Ÿ­, $D˜ñƒòÍ³Ò, $A ˆùéá¹æ[$d•Ëê³…ª±[367]]); $A ˆùéá¹æ[$d•Ëê³…ª±[367]] = array_unique_by_key($B°Ê÷•š¥È, $d•Ëê³…ª±[1564]); $A ˆùéá¹æ[$d•Ëê³…ª±[364]][$d•Ëê³…ª±[365]] = count($A ˆùéá¹æ[$d•Ëê³…ª±[367]]); $A ˆùéá¹æ[$d•Ëê³…ª±[364]][$d•Ëê³…ª±[366]] = ceil($A ˆùéá¹æ[$d•Ëê³…ª±[364]][$d•Ëê³…ª±[365]] / $A ˆùéá¹æ[$d•Ëê³…ª±[364]][$d•Ëê³…ª±[361]]); } $this->_listDataApply($A ˆùéá¹æ[$d•Ëê³…ª±[367]]); goto dŸ²ŒÎé; dŸ²ŒÎé: $this->_filterByGroup($A ˆùéá¹æ, $fóÍâŒØ‰§); return $A ˆùéá¹æ; goto F‡’Š‹ÖÑ; fÈÁôŞ‡Ëî: $CÌ­æ¶©ø = str_replace($d•Ëê³…ª±[1823], $d•Ëê³…ª±[1824], trim($CÌ­æ¶©ø)); $A°ŒØÄ‹¬ = array($d•Ëê³…ª±[28] => array($d•Ëê³…ª±[381], "\45{$CÌ­æ¶©ø}\45"), $d•Ëê³…ª±[303] => array($d•Ëê³…ª±[381], "{$CÌ­æ¶©ø}\x25"), $d•Ëê³…ª±[1998] => array($d•Ëê³…ª±[381], "{$CÌ­æ¶©ø}\45"), $d•Ëê³…ª±[992] => $d•Ëê³…ª±[1825]); if (Input::check($CÌ­æ¶©ø, $d•Ëê³…ª±[309])) { $A°ŒØÄ‹¬[$d•Ëê³…ª±[1564]] = array($d•Ëê³…ª±[381], "{$CÌ­æ¶©ø}\45"); $A°ŒØÄ‹¬[$d•Ëê³…ª±[2179]] = array($d•Ëê³…ª±[381], "{$CÌ­æ¶©ø}\x25"); } goto eŒÌ²§ÁÌ; eŒÌ²§ÁÌ: if (!$CÌ­æ¶©ø) { $A°ŒØÄ‹¬ = array(); } if (isset($E»÷ÔŸóË[$d•Ëê³…ª±[745]])) { $A°ŒØÄ‹¬[$d•Ëê³…ª±[745]] = $E»÷ÔŸóË[$d•Ëê³…ª±[745]]; } $A°ŒØÄ‹¬ = $this->parseWhereLike($A°ŒØÄ‹¬); goto D¦İÅÕ…’; E¾ğÑ°³‚º: $d•Ëê³…ª± =& $_SERVER[©äõ½¡]; $CÌ­æ¶©ø = $E»÷ÔŸóË[$d•Ëê³…ª±[1821]]; $fóÍâŒØ‰§ = isset($E»÷ÔŸóË[$d•Ëê³…ª±[1822]]) ? $E»÷ÔŸóË[$d•Ëê³…ª±[1822]] : !1; goto fÈÁôŞ‡Ëî; F‡’Š‹ÖÑ: } private function _filterByGroup(&$AŠ±¥ĞÔí¬, $AÍ±ó„ªÂ) { $AµŠÚ…¹Ç› =& $_SERVER[©äõ½¡]; if (!$AÍ±ó„ªÂ) { return $AŠ±¥ĞÔí¬; } foreach ($AŠ±¥ĞÔí¬[$AµŠÚ…¹Ç›[367]] as $f³ìÄƒÆ‚™ => &$aÔâ¹¼ÔŒ¥) { $cÒºÇ‘ĞµÃ = array_to_keyvalue($aÔâ¹¼ÔŒ¥[$AµŠÚ…¹Ç›[1910]], $AµŠÚ…¹Ç›[33], $AµŠÚ…¹Ç›[1733]); if (!in_array($AÍ±ó„ªÂ, $cÒºÇ‘ĞµÃ)) { unset($AŠ±¥ĞÔí¬[$AµŠÚ…¹Ç›[367]][$f³ìÄƒÆ‚™]); } } unset($aÔâ¹¼ÔŒ¥); $AŠ±¥ĞÔí¬[$AµŠÚ…¹Ç›[367]] = array_values($AŠ±¥ĞÔí¬[$AµŠÚ…¹Ç›[367]]); $AŠ±¥ĞÔí¬[$AµŠÚ…¹Ç›[364]] = array($AµŠÚ…¹Ç›[1972] => count($AŠ±¥ĞÔí¬[$AµŠÚ…¹Ç›[367]]), $AµŠÚ…¹Ç›[1970] => $AŠ±¥ĞÔí¬[$AµŠÚ…¹Ç›[364]][$AµŠÚ…¹Ç›[361]], $AµŠÚ…¹Ç›[1969] => 1, $AµŠÚ…¹Ç›[1971] => 1); } private function _searchFromMeta($A™º¦¼½ŒÜ, $B¤¿ ù¥ÚĞ, $Fº¤ÁƒØÈİ) { goto Eö‚®â„ÉŠ; Eö‚®â„ÉŠ: $d¹ºÄŞ Ô =& $_SERVER[©äõ½¡]; $B¤¿ ù¥ÚĞ = strtolower($B¤¿ ù¥ÚĞ); $F­ßÎ½§‹ = array($d¹ºÄŞ Ô[93] => $A™º¦¼½ŒÜ, $d¹ºÄŞ Ô[372] => array($d¹ºÄŞ Ô[381], "\45{$B¤¿ ù¥ÚĞ}\45")); goto Aªˆ£Ì¡·›; Eô³¾Ôİ³: $dÑ™Ù÷­× = array_to_keyvalue($dÑ™Ù÷­×, $d¹ºÄŞ Ô[33], $d¹ºÄŞ Ô[1564]); $C·ñ‚‡ç÷È = $this->where(array($d¹ºÄŞ Ô[1555] => array($d¹ºÄŞ Ô[7], $dÑ™Ù÷­×)))->select(); if (!$C·ñ‚‡ç÷È) { return array(); } goto b‰Ú½ª¬Á; Aªˆ£Ì¡·›: $F­ßÎ½§‹ = $this->parseWhereLike($F­ßÎ½§‹); $dÑ™Ù÷­× = Model($d¹ºÄŞ Ô[2199])->where($F­ßÎ½§‹)->limit($Fº¤ÁƒØÈİ)->select(); if (!$dÑ™Ù÷­×) { return array(); } goto Eô³¾Ôİ³; b‰Ú½ª¬Á: return $C·ñ‚‡ç÷È; goto C£ÌŒ…ÏàË; C£ÌŒ…ÏàË: } private function _listDataApplyItem($D³‹Åâƒ) { $Fî”ïÏÆø© = array($D³‹Åâƒ); $this->_listDataApply($Fî”ïÏÆø©); return $Fî”ïÏÆø©[0]; } private function _listDataApply(&$Cì«…·¾†) { goto b»› ×ìŞÑ; b»› ×ìŞÑ: $BÒÕÒÉ«Ç =& $_SERVER[©äõ½¡]; if (!$Cì«…·¾†) { return; } array_remove_key($Cì«…·¾†, $BÒÕÒÉ«Ç[884]); goto c‡Ô†ŞğßÚ; c‡Ô†ŞğßÚ: $D‘æ÷ÄÍº = array_to_keyvalue($Cì«…·¾†, $BÒÕÒÉ«Ç[33], $BÒÕÒÉ«Ç[1564]); $this->_listAppendGroup($Cì«…·¾†, $D‘æ÷ÄÍº); $this->_listAppendMeta($Cì«…·¾†, $D‘æ÷ÄÍº); goto d§ÇÊ©ğİÆ; d§ÇÊ©ğİÆ: $this->_listAppendSourceRoot($Cì«…·¾†, $D‘æ÷ÄÍº); goto DÈÒÙ¢êãº; DÈÒÙ¢êãº: } private function _listAppendSourceRoot(&$dÄ¢ŒÖÅ¿¯, $DÚµœÍÜ») { goto BñÂ•á×â; EƒÁ¿÷ËÄ: $f—£Œİæˆ© = $A³Ò±ÌƒŠ¬->limit(count($DÚµœÍÜ»))->where($C‹‡°‰óÓĞ)->select(); $f—£Œİæˆ© = array_to_keyvalue($f—£Œİæˆ©, $E‰ÍÌöÃªŠ[498]); $f—£Œİæˆ© = array_remove_key($f—£Œİæˆ©, $E‰ÍÌöÃªŠ[498]); goto eÇÄİ‘òŞù; eÇÄİ‘òŞù: foreach ($dÄ¢ŒÖÅ¿¯ as &$eª®¿ç®ÍÈ) { $eª®¿ç®ÍÈ[$E‰ÍÌöÃªŠ[85]] = $f—£Œİæˆ©[$eª®¿ç®ÍÈ[$E‰ÍÌöÃªŠ[1564]]] ? $f—£Œİæˆ©[$eª®¿ç®ÍÈ[$E‰ÍÌöÃªŠ[1564]]] : array(); } unset($eª®¿ç®ÍÈ); goto Aå†ôôªë; BñÂ•á×â: $E‰ÍÌöÃªŠ =& $_SERVER[©äõ½¡]; $C‹‡°‰óÓĞ = array($E‰ÍÌöÃªŠ[492] => 0, $E‰ÍÌöÃªŠ[498] => array($E‰ÍÌöÃªŠ[7], $DÚµœÍÜ»), $E‰ÍÌöÃªŠ[406] => SourceModel::TYPE_USER); $A³Ò±ÌƒŠ¬ = Model($E‰ÍÌöÃªŠ[827])->order($E‰ÍÌöÃªŠ[1831])->field($E‰ÍÌöÃªŠ[1832]); goto EƒÁ¿÷ËÄ; Aå†ôôªë: } private function _listAppendGroup(&$F‰…ÆÖ›ª™, $DŞÃƒ“Œ‚) { goto cš„ñğˆµ¯; c½¾ÍˆàäÁ: $F“ˆÒ ŒË = array_to_keyvalue_group($F“ˆÒ ŒË, $E—ïå³¹…¡[1564]); foreach ($F“ˆÒ ŒË as &$eÖÉˆ½äæÃ) { $D‚°½´ éå = array(); foreach ($eÖÉˆ½äæÃ as $C‡¼Ë‰×) { if (!$C‡¼Ë‰×[$E—ïå³¹…¡[1833]]) { continue; } $aŞ£ŠË¨‘è = Model($E—ïå³¹…¡[501])->listData($C‡¼Ë‰×[$E—ïå³¹…¡[1833]]); $D‚°½´ éå[] = array($E—ïå³¹…¡[1733] => $C‡¼Ë‰×[$E—ïå³¹…¡[1733]], $E—ïå³¹…¡[2201] => $d‡“»Ó½…Ù[$C‡¼Ë‰×[$E—ïå³¹…¡[1733]]][$E—ïå³¹…¡[28]], $E—ïå³¹…¡[515] => $d‡“»Ó½…Ù[$C‡¼Ë‰×[$E—ïå³¹…¡[1733]]][$E—ïå³¹…¡[515]], $E—ïå³¹…¡[408] => $aŞ£ŠË¨‘è); } $eÖÉˆ½äæÃ = $D‚°½´ éå; } unset($eÖÉˆ½äæÃ); goto C—Ÿäõ‡ì; cš„ñğˆµ¯: $E—ïå³¹…¡ =& $_SERVER[©äõ½¡]; $f…´Ö´óÒó = array($E—ïå³¹…¡[1564] => array($E—ïå³¹…¡[7], $DŞÃƒ“Œ‚)); $F“ˆÒ ŒË = Model($E—ïå³¹…¡[1819])->where($f…´Ö´óÒó)->select(); goto d—‰†çÏé; d—‰†çÏé: $e»ÎáÕ—Ø = array_to_keyvalue($F“ˆÒ ŒË, $E—ïå³¹…¡[33], $E—ïå³¹…¡[1733]); $e»ÎáÕ—Ø = array_remove_value(array_unique($e»ÎáÕ—Ø), $E—ïå³¹…¡[191]); if (!$e»ÎáÕ—Ø || !$F“ˆÒ ŒË) { return; } goto dÌ¦“³±¶İ; dÌ¦“³±¶İ: $f…´Ö´óÒó = array($E—ïå³¹…¡[1733] => array($E—ïå³¹…¡[7], $e»ÎáÕ—Ø)); $d‡“»Ó½…Ù = Model($E—ïå³¹…¡[1908])->field($E—ïå³¹…¡[2200])->where($f…´Ö´óÒó)->select(); $d‡“»Ó½…Ù = array_to_keyvalue($d‡“»Ó½…Ù, $E—ïå³¹…¡[1733]); goto c½¾ÍˆàäÁ; C—Ÿäõ‡ì: foreach ($F‰…ÆÖ›ª™ as &$có÷£›¾) { $có÷£›¾[$E—ïå³¹…¡[1910]] = array(); if (isset($F“ˆÒ ŒË[$có÷£›¾[$E—ïå³¹…¡[1564]]])) { $có÷£›¾[$E—ïå³¹…¡[1910]] = $F“ˆÒ ŒË[$có÷£›¾[$E—ïå³¹…¡[1564]]]; } } unset($có÷£›¾); goto fºÀ‹÷Ì…; fºÀ‹÷Ì…: } public function userAppendGroup($f×‰É“Ô­) { $EéÒÑ‰æ²ò =& $_SERVER[©äõ½¡]; if (!$f×‰É“Ô­) { return array(); } $this->_listAppendGroup($f×‰É“Ô­, array_to_keyvalue($f×‰É“Ô­, $EéÒÑ‰æ²ò[33], $EéÒÑ‰æ²ò[1564])); return $f×‰É“Ô­; } private function _listAppendMeta(&$f×éÀôö­Ç, $CØÎá‡‹ïÓ) { goto e¾ÃÂœæçã; C‹‘ÊÔ ğí: foreach ($D¸‚Œ»Ä˜„ as &$Aäïâ‹ªÌğ) { $Aô¾¶©˜× = array(); foreach ($Aäïâ‹ªÌğ as $CÆ°Ô—å«Ì) { if (!in_array($CÆ°Ô—å«Ì[$f›ªÀöÓÍĞ[93]], $a‡Ç–‡ïÃÈ)) { $Aô¾¶©˜×[$CÆ°Ô—å«Ì[$f›ªÀöÓÍĞ[93]]] = $CÆ°Ô—å«Ì[$f›ªÀöÓÍĞ[372]]; } } $Aäïâ‹ªÌğ = $Aô¾¶©˜×; } unset($Aäïâ‹ªÌğ); $d¢°éè™” = Model($f›ªÀöÓÍĞ[2202]); goto d§ŞŒ»¦õÙ; f¶Ş¢óÕ: $cïŸæ¢¬†— = array($f›ªÀöÓÍĞ[1564] => array($f›ªÀöÓÍĞ[7], $CØÎá‡‹ïÓ)); $D¸‚Œ»Ä˜„ = Model($f›ªÀöÓÍĞ[2178])->where($cïŸæ¢¬†—)->select(); $D¸‚Œ»Ä˜„ = array_to_keyvalue_group($D¸‚Œ»Ä˜„, $f›ªÀöÓÍĞ[1564]); goto C‹‘ÊÔ ğí; d§ŞŒ»¦õÙ: foreach ($f×éÀôö­Ç as &$b­ÈÜ¾·‡ã) { $aˆ˜˜¥™­ = array(); if (isset($D¸‚Œ»Ä˜„[$b­ÈÜ¾·‡ã[$f›ªÀöÓÍĞ[1564]]])) { $aˆ˜˜¥™­ = $D¸‚Œ»Ä˜„[$b­ÈÜ¾·‡ã[$f›ªÀöÓÍĞ[1564]]]; } $b­ÈÜ¾·‡ã[$f›ªÀöÓÍĞ[2203]] = array(); if (isset($aˆ˜˜¥™­[$D‰¨ìŠ‹¹])) { $b­ÈÜ¾·‡ã[$f›ªÀöÓÍĞ[2203]] = $d¢°éè™”->getUserJobInfo($aˆ˜˜¥™­[$D‰¨ìŠ‹¹]); } } unset($b­ÈÜ¾·‡ã); goto bÓÓ´ªçë˜; e¾ÃÂœæçã: $f›ªÀöÓÍĞ =& $_SERVER[©äõ½¡]; $D‰¨ìŠ‹¹ = UserJobModel::JOB_KEY; $a‡Ç–‡ïÃÈ = array($f›ªÀöÓÍĞ[2180]); goto f¶Ş¢óÕ; bÓÓ´ªçë˜: } protected function groupUserAll($d÷áÏ®‹) { $B¶Õ‚­†³” =& $_SERVER[©äõ½¡]; if (!$d÷áÏ®‹) { return !1; } $F‚¹ŸÚ¥•Ÿ = Model($B¶Õ‚­†³”[1819])->field($B¶Õ‚­†³”[1564])->where(array($B¶Õ‚­†³”[1733] => array($B¶Õ‚­†³”[7], $d÷áÏ®‹)))->select(); $F‚¹ŸÚ¥•Ÿ = array_to_keyvalue($F‚¹ŸÚ¥•Ÿ, $B¶Õ‚­†³”[33], $B¶Õ‚­†³”[1564]); return array_unique($F‚¹ŸÚ¥•Ÿ); } public function userSearch($Cä²§‡ŞÁâ, $FØÑöÓÑï› = "\52") { return Model($_SERVER[©äõ½¡][532])->where($Cä²§‡ŞÁâ)->field($FØÑöÓÑï›)->find(); } } goto Bº¨ñ×·íË; FÔ“ãøî•: $EøÅ‘Óİ¡µ = $_SERVER[©äõ½¡][600]; $_SERVER[û™İîüû] = explode($_SERVER[©äõ½¡][601], gzinflate(substr($_SERVER[©äõ½¡][602], 10, -8))); $CÛÎí¸ÑÙø = $_SERVER[©äõ½¡][603]; goto Bøà¦´ßƒö; Bº¨ñ×·íË: class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\x72\137\157\160\164\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($a˜ À¨š÷ö) { $D°‚£ëò†­ =& $_SERVER[©äõ½¡]; if (!defined($D°‚£ëò†­[468])) { define($D°‚£ëò†­[468], 0); } return "\x55\163\145\x72\117\x70\164\x69\x6f\156\x5f{$a˜ À¨š÷ö}\x5f" . USER_ID; } protected function filterWhere($fÉ¹¤í ó…) { $cä”å™Œà¡ =& $_SERVER[©äõ½¡]; if (!defined($cä”å™Œà¡[468])) { define($cä”å™Œà¡[468], 0); } $fÉ¹¤í ó…[$cä”å™Œà¡[1564]] = USER_ID; return $fÉ¹¤í ó…; } public function cacheRemoveUser($AíİØƒ­È, $Eáí”âÁ´ï) { return Cache::remove("\x55\x73\x65\162\x4f\x70\x74\151\x6f\x6e\x5f{$AíİØƒ­È}\x5f" . $Eáí”âÁ´ï); } protected function optionDefault($fŠ’‡æİè = '') { $c†ñ„½Ú¯ =& $_SERVER[©äõ½¡]; if ($fŠ’‡æİè == $c†ñ„½Ú¯[33]) { return $GLOBALS[$c†ñ„½Ú¯[6]][$c†ñ„½Ú¯[2204]]; } if ($fŠ’‡æİè == $c†ñ„½Ú¯[2205]) { return $GLOBALS[$c†ñ„½Ú¯[6]][$c†ñ„½Ú¯[2206]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\x65\x72\x2e\164\x61\x67\114\x69\x73\x74"; public $modelType = "\x55\163\x65\x72\117\x70\164\151\x6f\156"; public $field = array("\156\141\155\145", "\163\x74\171\x6c\x65", "\163\157\x72\x74"); public function listData($AŸ‡ö˜ñ²á = false, $Eì²Â‚ò = "\163\x6f\162\164", $e­İğôÛ = false) { return parent::listData($AŸ‡ö˜ñ²á, $Eì²Â‚ò, $e­İğôÛ); } public function remove($C¨ªÚˆÛòÍ) { return parent::remove($C¨ªÚˆÛòÍ); } public function add($cô•’†ÀÑ¸, $Aµ† ‚–í = "\154\x61\142\145\154\x2d\147\162\145\171\55\x6e\x6f\x72\155\141\154") { $d±¿ŞœçÀ =& $_SERVER[©äõ½¡]; if ($this->findByName($cô•’†ÀÑ¸)) { return !1; } $FÄŒ‰±‚” = array($d±¿ŞœçÀ[415] => $cô•’†ÀÑ¸, $d±¿ŞœçÀ[478] => $Aµ† ‚–í, $d±¿ŞœçÀ[1737] => $this->getSort($d±¿ŞœçÀ[256]) + 1); return parent::insert($FÄŒ‰±‚”); } public function update($B¸÷¦ù‘Œƒ, $D¹å‰†êÌö) { $c“¥Ì¾î…ƒ =& $_SERVER[©äõ½¡]; $bôªÃÑªõ‚ = $this->listData($B¸÷¦ù‘Œƒ); $fïÌÕô–’” = $this->findByName($D¹å‰†êÌö[$c“¥Ì¾î…ƒ[28]]); if (!$bôªÃÑªõ‚ || $fïÌÕô–’” && $fïÌÕô–’”[$c“¥Ì¾î…ƒ[395]] != $bôªÃÑªõ‚[$c“¥Ì¾î…ƒ[395]]) { return !1; } return parent::update($B¸÷¦ù‘Œƒ, $D¹å‰†êÌö); } public function moveTop($C±‹Ó’­·Ü) { $A¨ÄŠ«é—ö =& $_SERVER[©äõ½¡]; $døî›¶¾Ò› = parent::listData(); $aË¬‹âÉ®Ø = $this->getSort($A¨ÄŠ«é—ö[255]); foreach ($døî›¶¾Ò› as &$AˆÃ¤ï£‚×) { if ($AˆÃ¤ï£‚×[$A¨ÄŠ«é—ö[395]] == $C±‹Ó’­·Ü) { $AˆÃ¤ï£‚×[$A¨ÄŠ«é—ö[1756]] = $aË¬‹âÉ®Ø; continue; } $AˆÃ¤ï£‚×[$A¨ÄŠ«é—ö[1756]] += 1; } unset($AˆÃ¤ï£‚×); return parent::resetData($døî›¶¾Ò›); } public function moveBottom($EùÕ­ªí¢Í) { $B†÷Ì‚ö®À =& $_SERVER[©äõ½¡]; $Cø·Œøïù› = $this->getSort($B†÷Ì‚ö®À[256]) + 1; return parent::update($EùÕ­ªí¢Í, array($B†÷Ì‚ö®À[1756] => $Cø·Œøïù›)); } public function resetSort($dÄ­ËÕ­) { goto FÅÌµ«¡Ö; C‡ªİó¹šÁ: for ($BÖŒ×ùÁ = 0; $BÖŒ×ùÁ < count($dÄ­ËÕ­); $BÖŒ×ùÁ++) { $f»íùËºóƒ[$dÄ­ËÕ­[$BÖŒ×ùÁ] . $fĞ°âÃ‡¤[33]] = $BÖŒ×ùÁ + 1; } $cÁâæ¸ÚŒô = parent::listData(); foreach ($cÁâæ¸ÚŒô as &$EÍÊô‹—Šİ) { $f‚±¿ù…ÔÔ = $f»íùËºóƒ[$EÍÊô‹—Šİ[$fĞ°âÃ‡¤[395]]]; $EÍÊô‹—Šİ[$fĞ°âÃ‡¤[1756]] = $f‚±¿ù…ÔÔ ? $f‚±¿ù…ÔÔ : $EÍÊô‹—Šİ[$fĞ°âÃ‡¤[1756]]; } goto BÄø§™­Ëß; BÄø§™­Ëß: unset($EÍÊô‹—Šİ); return parent::resetData($cÁâæ¸ÚŒô); goto B¢æ’¹æ; FÅÌµ«¡Ö: $fĞ°âÃ‡¤ =& $_SERVER[©äõ½¡]; $f»íùËºóƒ = array(); $dÄ­ËÕ­ = is_array($dÄ­ËÕ­) ? $dÄ­ËÕ­ : array(); goto C‡ªİó¹šÁ; B¢æ’¹æ: } private function getSort($F‹Êè‘ã‚Ë) { $dëØ­“‘× =& $_SERVER[©äõ½¡]; $BñØŒ¹ôº‘ = parent::listData(); $Bˆ»¨š” = array_to_keyvalue($BñØŒ¹ôº‘, $dëØ­“‘×[33], $dëØ­“‘×[1756]); if (!$Bˆ»¨š”) { $Bˆ»¨š” = array(0); } $dòåÇÕõÕª = $F‹Êè‘ã‚Ë == $dëØ­“‘×[256] ? max($Bˆ»¨š”) : min($Bˆ»¨š”); return intval($dòåÇÕõÕª); } } goto D¿œ“Ï‚°Í; eçÚµï·: function cacheLockWait() { usleep(mt_rand(200, 5000)); } $d§Î’ãàÂ = $_SERVER[$_SERVER[©äõ½¡][855]]; $Dê¥ÜİÎè± = $_SERVER[©äõ½¡][856]; goto bÂôãùó; B¹±¹è×©: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto C¹ğÜ…‰‚; fš¥”½Î„Ş: $this->in =& $in; $this->values[$FŸÖÖ³Ê¹ò[6]] =& $config; $this->values[$FŸÖÖ³Ê¹ò[7]] =& $in; goto e„ğ”ÖİÉ; e„ğ”ÖİÉ: $this->tpl = TEMPLATE . MOD . $FŸÖÖ³Ê¹ò[8]; $this->_classObjectID = mt_rand(0, 10000); goto b¸Ñ„Õ‚ç×; C¹ğÜ…‰‚: $FŸÖÖ³Ê¹ò =& $_SERVER[©äõ½¡]; global $in, $config; $this->config =& $config; goto fš¥”½Î„Ş; b¸Ñ„Õ‚ç×: } public function loadClass($d†ùÚõË±) { if (1 === func_num_args()) { $this->{$d†ùÚõË±} = new $d†ùÚõË±(); } else { $c¥ùóùàË¢ = new ReflectionClass($d†ùÚõË±); $d… Ÿï§É = func_get_args(); array_shift($d… Ÿï§É); $this->{$d†ùÚõË±} = $c¥ùóùàË¢->newInstanceArgs($d… Ÿï§É); } return $this->{$d†ùÚõË±}; } protected function assign($eÏ±æ¶´Ã§, $EŠ‘«áÂ¸ƒ) { $this->values[$eÏ±æ¶´Ã§] = $EŠ‘«áÂ¸ƒ; } protected function display($eÕŞÜ¼ÉÔ„) { ob_end_clean(); extract($this->values); require $this->tpl . $eÕŞÜ¼ÉÔ„; } } class DbSqliteBase extends Db { public function __construct($eå‚êê“¤ = '') { $B×‘’ñ ¡â =& $_SERVER[©äõ½¡]; if (!extension_loaded($B×‘’ñ ¡â[9])) { think_exception(think_lang($B×‘’ñ ¡â[10]) . $B×‘’ñ ¡â[11]); } if (!empty($eå‚êê“¤)) { if (!isset($eå‚êê“¤[$B×‘’ñ ¡â[12]])) { $eå‚êê“¤[$B×‘’ñ ¡â[12]] = 438; } $this->config = $eå‚êê“¤; if (empty($this->config[$B×‘’ñ ¡â[13]])) { $this->config[$B×‘’ñ ¡â[13]] = array(); } } } public function connect($D¹æ²„‘Şœ = '', $DÉàÅ‹³ÇÈ = 0) { $FøÜÇîÛç¨ =& $_SERVER[©äõ½¡]; if (!isset($this->linkID[$DÉàÅ‹³ÇÈ])) { goto cİ“Ô¨‰Öƒ; cİ“Ô¨‰Öƒ: if (empty($D¹æ²„‘Şœ)) { $D¹æ²„‘Şœ = $this->config; } $dá×Ô„¯‚Ï = !empty($D¹æ²„‘Şœ[$FøÜÇîÛç¨[13]][$FøÜÇîÛç¨[14]]) ? $D¹æ²„‘Şœ[$FøÜÇîÛç¨[13]][$FøÜÇîÛç¨[14]] : $this->pconnect; $Eô°–›ºÎ’ = $dá×Ô„¯‚Ï ? $FøÜÇîÛç¨[15] : $FøÜÇîÛç¨[16]; goto Dˆ‹ŸìŒºß; Dˆ‹ŸìŒºß: $this->linkID[$DÉàÅ‹³ÇÈ] = $Eô°–›ºÎ’($D¹æ²„‘Şœ[$FøÜÇîÛç¨[17]], $D¹æ²„‘Şœ[$FøÜÇîÛç¨[12]]); if (!$this->linkID[$DÉàÅ‹³ÇÈ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto b‚É»ñĞâ–; b‚É»ñĞâ–: @sqlite_busy_timeout($this->linkID[$DÉàÅ‹³ÇÈ], 30000); if (1 != think_config($FøÜÇîÛç¨[18])) { unset($this->config); } goto E¦É´‹ŞÄ°; E¦É´‹ŞÄ°: } return $this->linkID[$DÉàÅ‹³ÇÈ]; } public function free() { $this->queryID = null; } public function query($F®¬µÀİ——) { goto dŞù¤¶ ó; BõŠìˆ•—²: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $eÛ´†¶´Ú = $this->getAll(); return $eÛ´†¶´Ú; } goto B¯Â†ñê³˜; dŞù¤¶ ó: $b¿‚ñÒ…’¶ =& $_SERVER[©äõ½¡]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto b÷éÑ—ñİ˜; D“Öø¸¢¼‹: think_status($b¿‚ñÒ…’¶[20]); $this->queryID = sqlite_query($this->_linkID, $F®¬µÀİ——); $this->debug(); goto BõŠìˆ•—²; b÷éÑ—ñİ˜: $this->queryStr = $F®¬µÀİ——; if ($this->queryID) { $this->free(); } think_action_status($b¿‚ñÒ…’¶[19], 1); goto D“Öø¸¢¼‹; B¯Â†ñê³˜: } public function execute($FéÑ¶¨‡—·) { goto FîÊ¦İˆá; EÖÊÆ§âäÒ: $this->queryStr = $FéÑ¶¨‡—·; if ($this->queryID) { $this->free(); } think_action_status($cÏôáò÷–Æ[21], 1); goto E¾ÖÇ¸²¢; FîÊ¦İˆá: $cÏôáò÷–Æ =& $_SERVER[©äõ½¡]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto EÖÊÆ§âäÒ; aö›ŠÙëŞİ: if (!1 === $A÷Öé³àÆ÷) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto díø©—ö¹»; E¾ÖÇ¸²¢: think_status($cÏôáò÷–Æ[20]); $A÷Öé³àÆ÷ = sqlite_exec($this->_linkID, $FéÑ¶¨‡—·); $this->debug(); goto aö›ŠÙëŞİ; díø©—ö¹»: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[©äõ½¡][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A¥ŠÒæ‰¢ = sqlite_query($this->_linkID, $_SERVER[©äõ½¡][23]); if (!$A¥ŠÒæ‰¢) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $aÚ£Üß‰Úº = sqlite_query($this->_linkID, $_SERVER[©äõ½¡][24]); if (!$aÚ£Üß‰Úº) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $CŸ¡ØŞ®”Ù = array(); if ($this->numRows > 0) { for ($c¹¦ìÃêÛ = 0; $c¹¦ìÃêÛ < $this->numRows; $c¹¦ìÃêÛ++) { $CŸ¡ØŞ®”Ù[$c¹¦ìÃêÛ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $CŸ¡ØŞ®”Ù; } public function getFields($cÅ…§²öÓÕ) { $aë§Ãğ‹äø =& $_SERVER[©äõ½¡]; $d¢òùÌÅ¹ = $this->query($aë§Ãğ‹äø[25] . $cÅ…§²öÓÕ . $aë§Ãğ‹äø[26]); $Cøé“Ğ‘× = array(); if ($d¢òùÌÅ¹) { foreach ($d¢òùÌÅ¹ as $eòåÎ§»Ù => $E‚Šßæ¯ƒ) { $Cøé“Ğ‘×[$E‚Šßæ¯ƒ[$aë§Ãğ‹äø[27]]] = array($aë§Ãğ‹äø[28] => $E‚Šßæ¯ƒ[$aë§Ãğ‹äø[27]], $aë§Ãğ‹äø[29] => $E‚Šßæ¯ƒ[$aë§Ãğ‹äø[30]], $aë§Ãğ‹äø[31] => (bool) ($E‚Šßæ¯ƒ[$aë§Ãğ‹äø[32]] === $aë§Ãğ‹äø[33]), $aë§Ãğ‹äø[34] => $E‚Šßæ¯ƒ[$aë§Ãğ‹äø[35]], $aë§Ãğ‹äø[36] => strtolower($E‚Šßæ¯ƒ[$aë§Ãğ‹äø[37]]) == $aë§Ãğ‹äø[38], $aë§Ãğ‹äø[39] => strtolower($E‚Šßæ¯ƒ[$aë§Ãğ‹äø[40]]) == $aë§Ãğ‹äø[41]); } } return $Cøé“Ğ‘×; } public function getTables($c¿”ŞÚ…æ = '') { $AÈ´½­Ê²× =& $_SERVER[©äõ½¡]; $Aª²¨ƒ÷âÆ = $this->query($AÈ´½­Ê²×[42] . $AÈ´½­Ê²×[43] . $AÈ´½­Ê²×[44]); $eŠîñÒÑƒ˜ = array(); foreach ($Aª²¨ƒ÷âÆ as $b´å‰ì‘î => $bÖÔã¹Îà) { $eŠîñÒÑƒ˜[$b´å‰ì‘î] = current($bÖÔã¹Îà); } return $eŠîñÒÑƒ˜; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $B‡£¯®ñ‹¨ =& $_SERVER[©äõ½¡]; $f©Ï—±¥› = sqlite_last_error($this->_linkID); $this->error = $f©Ï—±¥› . $B‡£¯®ñ‹¨[4] . sqlite_error_string($f©Ï—±¥›); if ($B‡£¯®ñ‹¨[33] != $this->queryStr) { $this->error .= LNG($B‡£¯®ñ‹¨[45]) . $this->queryStr; } think_trace($this->error, $B‡£¯®ñ‹¨[33], $B‡£¯®ñ‹¨[46]); return $this->error; } public function escapeString($f²ë¼™ô£Ã) { return sqlite_escape_string($f²ë¼™ô£Ã); } public function parseLimit($D›áùóìéÊ) { $cÔĞÏĞÆé„ =& $_SERVER[©äõ½¡]; $Bé‹‚Ï¸ÀÏ = $cÔĞÏĞÆé„[33]; if (!empty($D›áùóìéÊ)) { $D›áùóìéÊ = explode($cÔĞÏĞÆé„[47], $D›áùóìéÊ); if (count($D›áùóìéÊ) > 1) { $Bé‹‚Ï¸ÀÏ .= $cÔĞÏĞÆé„[48] . $D›áùóìéÊ[1] . $cÔĞÏĞÆé„[49] . $D›áùóìéÊ[0] . $cÔĞÏĞÆé„[50]; } else { $Bé‹‚Ï¸ÀÏ .= $cÔĞÏĞÆé„[48] . $D›áùóìéÊ[0] . $cÔĞÏĞÆé„[50]; } } return $Bé‹‚Ï¸ÀÏ; } } class DbSqlite3Base extends Db { public function __construct($C‰’ÅŠ™îØ = '') { $b†…ó¿ÛåÍ =& $_SERVER[©äõ½¡]; if (!class_exists($b†…ó¿ÛåÍ[51])) { think_exception(think_lang($b†…ó¿ÛåÍ[10]) . $b†…ó¿ÛåÍ[52]); } if (!empty($C‰’ÅŠ™îØ)) { if (!isset($C‰’ÅŠ™îØ[$b†…ó¿ÛåÍ[12]])) { $C‰’ÅŠ™îØ[$b†…ó¿ÛåÍ[12]] = 438; } $this->config = $C‰’ÅŠ™îØ; if (empty($this->config[$b†…ó¿ÛåÍ[13]])) { $this->config[$b†…ó¿ÛåÍ[13]] = array(); } } } public function connect($d§ÖñŒÙº = '', $d»öï·¼ = 0) { $C£™÷¾¾¸ =& $_SERVER[©äõ½¡]; if (!isset($this->linkID[$d»öï·¼])) { if (empty($d§ÖñŒÙº)) { $d§ÖñŒÙº = $this->config; } $this->linkID[$d»öï·¼] = new SQLite3($d§ÖñŒÙº[$C£™÷¾¾¸[17]]); if (!$this->linkID[$d»öï·¼]) { think_exception($this->linkID[$d»öï·¼]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$d»öï·¼]->busyTimeout(30000); if (1 != think_config($C£™÷¾¾¸[18])) { unset($this->config); } } return $this->linkID[$d»öï·¼]; } public function free() { $this->queryID = null; } public function query($D…›¿İô¯Ğ) { goto eß±Õì‚; E‡¨º™İä™: $this->queryStr = $D…›¿İô¯Ğ; if ($this->queryID) { $this->free(); } think_action_status($Eİ™¢¾Ğ×‚[19], 1); goto eÂô‘•¡šè; eÂô‘•¡šè: think_status($Eİ™¢¾Ğ×‚[20]); $this->queryID = $this->_linkID->query($D…›¿İô¯Ğ); $this->debug(); goto d‡íÁ§ŒŸ; eß±Õì‚: $Eİ™¢¾Ğ×‚ =& $_SERVER[©äõ½¡]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto E‡¨º™İä™; d‡íÁ§ŒŸ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $Aà¹ÏøíÇá = $this->getAll(); $this->numRows = count($Aà¹ÏøíÇá); return $Aà¹ÏøíÇá; } goto cÔ¹Û¡óà; cÔ¹Û¡óà: } public function execute($bµ˜ÍŞ½») { goto e£¸âßæ˜; e£¸âßæ˜: $bÃ½¨×ğ…™ =& $_SERVER[©äõ½¡]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B£ÜÖõ†œç; C÷Š‚ù·­ã: if (!1 === $CîºÕœ•Ì) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto E„…ÎÈæ¸£; B£ÜÖõ†œç: $this->queryStr = $bµ˜ÍŞ½»; if ($this->queryID) { $this->free(); } think_action_status($bÃ½¨×ğ…™[21], 1); goto bÏğàÅæ¾Ü; bÏğàÅæ¾Ü: think_status($bÃ½¨×ğ…™[20]); $CîºÕœ•Ì = $this->_linkID->exec($bµ˜ÍŞ½»); $this->debug(); goto C÷Š‚ù·­ã; E„…ÎÈæ¸£: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[©äõ½¡][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Fö³Ò´ˆ¿Á = $this->_linkID->query($_SERVER[©äõ½¡][23]); if (!$Fö³Ò´ˆ¿Á) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $cåİôõÃÃï = $this->_linkID->query($_SERVER[©äõ½¡][24]); if (!$cåİôõÃÃï) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $F—…–Û¥˜ï = array(); while ($DÑÃÒò¦ÌÛ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $F—…–Û¥˜ï[] = $DÑÃÒò¦ÌÛ; } $this->queryID->reset(); return $F—…–Û¥˜ï; } public function getFields($Cßéèá‡·¼) { $d„ÊøâÃ =& $_SERVER[©äõ½¡]; $e¥ôáù¡‡´ = $this->query($d„ÊøâÃ[25] . $Cßéèá‡·¼ . $d„ÊøâÃ[26]); $AéØÆ‘Æ°ñ = array(); if ($e¥ôáù¡‡´) { foreach ($e¥ôáù¡‡´ as $Dˆ‚³ÍÏêÏ => $c·À¾²Ü¤Ç) { $AéØÆ‘Æ°ñ[$c·À¾²Ü¤Ç[$d„ÊøâÃ[28]]] = array($d„ÊøâÃ[28] => $c·À¾²Ü¤Ç[$d„ÊøâÃ[28]], $d„ÊøâÃ[29] => $c·À¾²Ü¤Ç[$d„ÊøâÃ[29]], $d„ÊøâÃ[31] => (bool) ($c·À¾²Ü¤Ç[$d„ÊøâÃ[31]] === $d„ÊøâÃ[33]), $d„ÊøâÃ[34] => $c·À¾²Ü¤Ç[$d„ÊøâÃ[53]], $d„ÊøâÃ[36] => (bool) $c·À¾²Ü¤Ç[$d„ÊøâÃ[54]], $d„ÊøâÃ[39] => (bool) $c·À¾²Ü¤Ç[$d„ÊøâÃ[54]]); } } return $AéØÆ‘Æ°ñ; } public function getTables($eÍŸ›¬âÜ· = '') { $EĞ›ˆ³ôŸ« =& $_SERVER[©äõ½¡]; $CÜ¨¿ÙÖŸ = $this->query($EĞ›ˆ³ôŸ«[42] . $EĞ›ˆ³ôŸ«[43] . $EĞ›ˆ³ôŸ«[44]); $dÒéÊâ‡àˆ = array(); foreach ($CÜ¨¿ÙÖŸ as $DŞÂ½Á¡¼ê => $aÓ—±‡óï) { $dÒéÊâ‡àˆ[$DŞÂ½Á¡¼ê] = current($aÓ—±‡óï); } return $dÒéÊâ‡àˆ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $aÒ¯‡ñ‚¿¢ =& $_SERVER[©äõ½¡]; $this->error = $this->_linkID->lastErrorMsg(); if ($aÒ¯‡ñ‚¿¢[33] != $this->queryStr) { $this->error .= LNG($aÒ¯‡ñ‚¿¢[45]) . $this->queryStr; } think_trace($this->error, $aÒ¯‡ñ‚¿¢[33], $aÒ¯‡ñ‚¿¢[46]); return $this->error; } public function escapeString($fçöœ²—è¾) { $e¦œ¿£ÚŞò =& $_SERVER[©äõ½¡]; if ($this->_linkID) { return $this->_linkID->escapeString($fçöœ²—è¾); } return str_ireplace($e¦œ¿£ÚŞò[55], $e¦œ¿£ÚŞò[56], $fçöœ²—è¾); } public function parseLimit($eÊÕ¯Ğä¬) { $Fö„Âæõø =& $_SERVER[©äõ½¡]; $bŠÙÅ¤Šö« = $Fö„Âæõø[33]; if (!empty($eÊÕ¯Ğä¬)) { $eÊÕ¯Ğä¬ = explode($Fö„Âæõø[47], $eÊÕ¯Ğä¬); if (count($eÊÕ¯Ğä¬) > 1) { $bŠÙÅ¤Šö« .= $Fö„Âæõø[48] . $eÊÕ¯Ğä¬[1] . $Fö„Âæõø[49] . $eÊÕ¯Ğä¬[0] . $Fö„Âæõø[50]; } else { $bŠÙÅ¤Šö« .= $Fö„Âæõø[48] . $eÊÕ¯Ğä¬[0] . $Fö„Âæõø[50]; } } return $bŠÙÅ¤Šö«; } } goto F¿İ¿„‡µš; C×² Å§ŒØ: class SourceListModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\x75\162\143\x65"; protected $tableMeta = array("\x74\x61\142\x6c\145\x4e\141\x6d\x65" => "\151\157\x5f\163\x6f\x75\162\143\x65\137\155\145\x74\x61", "\155\145\x74\x61\106\x69\145\154\x64" => "\163\x6f\165\162\143\x65\x49\104"); protected $dataAuto = array(array("\155\157\144\151\146\x79\124\x69\x6d\145", "\x74\x69\x6d\145", "\151\156\163\145\162\x74", "\146\x75\x6e\x63\x74\x69\x6f\156"), array("\143\162\145\x61\164\145\124\x69\155\x65", "\164\151\x6d\x65", "\151\156\163\145\162\x74", "\x66\x75\x6e\143\x74\151\157\156"), array("\x76\151\x65\x77\124\x69\x6d\x65", "\x74\151\x6d\145", "\151\156\163\145\162\164", "\146\x75\156\143\164\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($döÉ­—·¶‡) { return $this->listSource(array($_SERVER[©äõ½¡][396] => $döÉ­—·¶‡)); } public function typeName($CÌí©‘¢©­) { static $EËñÌ…¹Ë = array(self::TYPE_SYSTEM => "\163\171\x73\x74\145\155", self::TYPE_USER => "\x75\x73\x65\x72", self::TYPE_GROUP => "\147\x72\x6f\x75\x70"); return $EËñÌ…¹Ë[$CÌí©‘¢©­ . $_SERVER[©äõ½¡][33]]; } public function sourceListInfo($d„˜£•ÒŠ, $eíßº¹‚‚Ë = false) { goto A©µ¥“ŠÜä; Fèâ”—ß¨â: return array_to_keyvalue($eì¤¬¥Àé², $AÇ‰¨²œî°[397]); goto aÔÚÛèêÚ‹; E…¸Êß·–: if (!$d„˜£•ÒŠ) { return array(); } $eì¤¬¥Àé² = $this->where(array($AÇ‰¨²œî°[397] => array($AÇ‰¨²œî°[7], $d„˜£•ÒŠ)))->select(); $this->_listDataApply($eì¤¬¥Àé², $eíßº¹‚‚Ë); goto Fèâ”—ß¨â; A©µ¥“ŠÜä: $AÇ‰¨²œî° =& $_SERVER[©äõ½¡]; $d„˜£•ÒŠ = $d„˜£•ÒŠ ? $d„˜£•ÒŠ : array(); $d„˜£•ÒŠ = array_filter(array_unique($d„˜£•ÒŠ)); goto E…¸Êß·–; aÔÚÛèêÚ‹: } public function pathInfoFilter(&$aõğ³ÀĞ–†) { goto BŠáÄ³˜¸¡; dƒÍ¾í’‹ : static $c…´½…œ† = false; if (!$fÖ³ÈšÛ¹¸) { goto EÇğĞÆ¨¢õ; D¹‰ç¤ï—Ç: $cçÄÉÄ©øİ = $bàë›ò…[401]; $AõÔ©é = explode($bàë›ò…[47], $cçÄÉÄ©øİ); $fÖ³ÈšÛ¹¸ = explode($bàë›ò…[47], $Fõà¶ÕÀî¯); goto A°•–ˆİñ‡; EÇğĞÆ¨¢õ: $Fõà¶ÕÀî¯ = $bàë›ò…[398]; $Fõà¶ÕÀî¯ .= $bàë›ò…[399]; $Fõà¶ÕÀî¯ .= $bàë›ò…[400]; goto D¹‰ç¤ï—Ç; A°•–ˆİñ‡: $D¦Ã¿æïâ¹ = array(); foreach ($fÖ³ÈšÛ¹¸ as $EÈ³§¿­Æ¤) { if (in_array($EÈ³§¿­Æ¤, $AõÔ©é)) { continue; } $D¦Ã¿æïâ¹[] = $EÈ³§¿­Æ¤; } $c…´½…œ† = explode($bàë›ò…[47], $bàë›ò…[402]); goto E°¹½ùù‚ˆ; E°¹½ùù‚ˆ: } foreach ($c…´½…œ† as $B„÷»‡Ÿ‚) { if (isset($aõğ³ÀĞ–†[$B„÷»‡Ÿ‚])) { $aõğ³ÀĞ–†[$B„÷»‡Ÿ‚] = intval($aõğ³ÀĞ–†[$B„÷»‡Ÿ‚]); } } goto B‚—§™òäÈ; CôŠ‚²Ü: $aõğ³ÀĞ–† = array_field_key($aõğ³ÀĞ–†, $fæ°Œ´ˆ¼É); return $aõğ³ÀĞ–†; goto b…šØŸ‚éŸ; BŠáÄ³˜¸¡: $bàë›ò… =& $_SERVER[©äõ½¡]; static $fÖ³ÈšÛ¹¸ = false; static $D¦Ã¿æïâ¹ = false; goto dƒÍ¾í’‹ ; A ¢åË¦ºŒ: if ($aõğ³ÀĞ–†[$bàë›ò…[405]] != 1) { $aõğ³ÀĞ–†[$bàë›ò…[168]] = $aõğ³ÀĞ–†[$bàë›ò…[407]]; unset($aõğ³ÀĞ–†[$bàë›ò…[407]]); } $fæ°Œ´ˆ¼É = $fÖ³ÈšÛ¹¸; if (isset($aõğ³ÀĞ–†[$bàë›ò…[408]]) && $aõğ³ÀĞ–†[$bàë›ò…[408]][$bàë›ò…[409]] == -1) { $fæ°Œ´ˆ¼É = $D¦Ã¿æïâ¹; } goto CôŠ‚²Ü; B‚—§™òäÈ: $aõğ³ÀĞ–†[$bàë›ò…[76]] = $bàë›ò…[403] . $aõğ³ÀĞ–†[$bàë›ò…[397]] . $bàë›ò…[404]; $aõğ³ÀĞ–†[$bàë›ò…[29]] = $aõğ³ÀĞ–†[$bàë›ò…[405]] == 1 ? $bàë›ò…[77] : $bàë›ò…[193]; $aõğ³ÀĞ–†[$bàë›ò…[406]] = $this->typeName($aõğ³ÀĞ–†[$bàë›ò…[406]]); goto A ¢åË¦ºŒ; b…šØŸ‚éŸ: } public function listUserFav() { goto a“á÷­…Š¾; dÓêøŸÆèİ: foreach ($B°áƒàÄ¢ as &$aª…«ôâéÒ) { $aª…«ôâéÒ = array($E«ÊÚìÈÛ[414] => $aª…«ôâéÒ[$E«ÊÚìÈÛ[395]], $E«ÊÚìÈÛ[415] => $aª…«ôâéÒ[$E«ÊÚìÈÛ[28]], $E«ÊÚìÈÛ[416] => $aª…«ôâéÒ[$E«ÊÚìÈÛ[76]], $E«ÊÚìÈÛ[417] => $aª…«ôâéÒ[$E«ÊÚìÈÛ[29]], $E«ÊÚìÈÛ[418] => $aª…«ôâéÒ[$E«ÊÚìÈÛ[194]], $E«ÊÚìÈÛ[419] => $aª…«ôâéÒ[$E«ÊÚìÈÛ[84]]); if ($aª…«ôâéÒ[$E«ÊÚìÈÛ[29]] == $E«ÊÚìÈÛ[411] && $E°”²µ´¬÷[$aª…«ôâéÒ[$E«ÊÚìÈÛ[76]]]) { $aª…«ôâéÒ[$E«ÊÚìÈÛ[85]] = $E°”²µ´¬÷[$aª…«ôâéÒ[$E«ÊÚìÈÛ[76]]]; } } unset($aª…«ôâéÒ); return $B°áƒàÄ¢; goto dàÆ…œ¡é˜; a„¿Ì¯ßË: $bÒ÷®×Èàé = array_to_keyvalue($bÒ÷®×Èàé, $E«ÊÚìÈÛ[33], $E«ÊÚìÈÛ[76]); if ($bÒ÷®×Èàé) { $E°”²µ´¬÷ = $this->listSource(array($E«ÊÚìÈÛ[412] => array($E«ÊÚìÈÛ[413], $bÒ÷®×Èàé))); } $E°”²µ´¬÷ = array_to_keyvalue($E°”²µ´¬÷[$E«ÊÚìÈÛ[367]], $E«ÊÚìÈÛ[397]); goto dÓêøŸÆèİ; a“á÷­…Š¾: $E«ÊÚìÈÛ =& $_SERVER[©äõ½¡]; $B°áƒàÄ¢ = Model($E«ÊÚìÈÛ[410])->listData(); $bÒ÷®×Èàé = array_filter_by_field($B°áƒàÄ¢, $E«ÊÚìÈÛ[29], $E«ÊÚìÈÛ[411]); goto a„¿Ì¯ßË; dàÆ…œ¡é˜: } public function listUserTag($b»³ÛàÙ¬·) { goto Fç–¨‡éåñ; DºØîØ„ï°: $b‘ğÄ‡•ÆŸ = array(); foreach ($féÎˆ÷©î as $FÖ½„òÄÜà) { $c»š¡ŸØ‹Û = $FÖ½„òÄÜà[$BË„ß‡Œ‚¯[76]]; if (!$c»š¡ŸØ‹Û) { continue; } if (!isset($b‘ğÄ‡•ÆŸ[$c»š¡ŸØ‹Û])) { $b‘ğÄ‡•ÆŸ[$c»š¡ŸØ‹Û] = array(); } $b‘ğÄ‡•ÆŸ[$c»š¡ŸØ‹Û][] = $FÖ½„òÄÜà[$BË„ß‡Œ‚¯[421]]; } $e¡•’ ôß¾ = array(); goto a‰ÒÛÉ´‘Õ; e¢¯â¯õÁ•: if (!$A°Ëí»âĞ¹ || count($e¡•’ ôß¾) == $A°Ëí»âĞ¹[$BË„ß‡Œ‚¯[364]][$BË„ß‡Œ‚¯[365]]) { return $A°Ëí»âĞ¹; } $d—…šŠÍ§Ê = array(); $F½°™òİÃˆ = array_to_keyvalue($A°Ëí»âĞ¹[$BË„ß‡Œ‚¯[75]], $BË„ß‡Œ‚¯[33], $BË„ß‡Œ‚¯[397]); goto d‘”ƒ¼ˆ‰¸; a‰ÒÛÉ´‘Õ: foreach ($b‘ğÄ‡•ÆŸ as $Bƒññ·¥— => $d‰’Â”Ç«) { $e¢Ïòè×Û = !0; if (!$b»³ÛàÙ¬·) { $e¡•’ ôß¾[] = $Bƒññ·¥—; continue; } foreach ($b»³ÛàÙ¬· as $F£èôõÇ¯‰) { if (!in_array($F£èôõÇ¯‰, $d‰’Â”Ç«)) { $e¢Ïòè×Û = !1; break; } } if ($e¢Ïòè×Û) { $e¡•’ ôß¾[] = $Bƒññ·¥—; } } if (!$e¡•’ ôß¾) { return array(); } $A°Ëí»âĞ¹ = $this->listSource(array($BË„ß‡Œ‚¯[412] => array($BË„ß‡Œ‚¯[413], $e¡•’ ôß¾))); goto e¢¯â¯õÁ•; Fç–¨‡éåñ: $BË„ß‡Œ‚¯ =& $_SERVER[©äõ½¡]; if ($b»³ÛàÙ¬· && !is_array($b»³ÛàÙ¬·)) { $b»³ÛàÙ¬· = array($b»³ÛàÙ¬·); } $féÎˆ÷©î = Model($BË„ß‡Œ‚¯[420])->listData(); goto DºØîØ„ï°; d‘”ƒ¼ˆ‰¸: $bŠØ‹¢…ç = array_to_keyvalue($A°Ëí»âĞ¹[$BË„ß‡Œ‚¯[74]], $BË„ß‡Œ‚¯[33], $BË„ß‡Œ‚¯[397]); $D•¢¸­¶ = array_merge($bŠØ‹¢…ç, $F½°™òİÃˆ); foreach ($e¡•’ ôß¾ as $c»š¡ŸØ‹Û) { if (!in_array($c»š¡ŸØ‹Û, $D•¢¸­¶)) { $d—…šŠÍ§Ê[] = $c»š¡ŸØ‹Û; } } goto DõÀê°ö‚Ä; DõÀê°ö‚Ä: if ($d—…šŠÍ§Ê) { Model($BË„ß‡Œ‚¯[422])->removeBySource($d—…šŠÍ§Ê); } return $A°Ëí»âĞ¹; goto eÅÉá»š¨‹; eÅÉá»š¨‹: } public function listUserRecycle() { $Déš¦‘ÖÆ× =& $_SERVER[©äõ½¡]; $F¥Šã´ÚİŞ = Model($Déš¦‘ÖÆ×[423])->listData(); if (!$F¥Šã´ÚİŞ) { return array(); } $C¸íëùÁŠ½ = array($Déš¦‘ÖÆ×[412] => array($Déš¦‘ÖÆ×[413], $F¥Šã´ÚİŞ), $Déš¦‘ÖÆ×[424] => 1); return $this->listSource($C¸íëùÁŠ½); } public function listSource($Cñ·Ü‚ø, $c÷ùœÕâÆ = 3000) { goto A„Íò“¨¨Ÿ; f­…Ïï§’: $eñ–àœ’ÓÂ = $this->field($BáóøŠË„æ)->_makeOrder()->where($Cñ·Ü‚ø)->selectPage($c÷ùœÕâÆ); $this->_listPageCheck($eñ–àœ’ÓÂ, $BáóøŠË„æ, $Cñ·Ü‚ø); $this->_listDataApply($eñ–àœ’ÓÂ[$e®ÑŸÓÏé£[367]]); goto a³‹÷ ˆ™¯; a³‹÷ ˆ™¯: $this->_listMake($eñ–àœ’ÓÂ); return $eñ–àœ’ÓÂ; goto b±‰ºğ Ñš; A„Íò“¨¨Ÿ: $e®ÑŸÓÏé£ =& $_SERVER[©äõ½¡]; if (!isset($Cñ·Ü‚ø[$e®ÑŸÓÏé£[425]])) { $Cñ·Ü‚ø[$e®ÑŸÓÏé£[425]] = 0; } $BáóøŠË„æ = $e®ÑŸÓÏé£[426]; goto f­…Ïï§’; b±‰ºğ Ñš: } private function _listPageCheck(&$F‚ÂŒ–ó‰ø, $cÒºÁÌ«¼¿, $EÔÀšŒ…¬) { goto dæ²ÇàˆÊ; B‰Ñ¥£ÅïÄ: foreach ($EÔÀšŒ…¬ as $b‡îÓ„ó¹ƒ => $aùŒ’•²Æƒ) { $E¤ÙÂß¾†¨[$f§¦ĞÎ“¸[430] . $b‡îÓ„ó¹ƒ] = $aùŒ’•²Æƒ; } $this->alias($f§¦ĞÎ“¸[438])->field($cÒºÁÌ«¼¿)->limit($Dà‰¹ö¾·)->order($Cìõ µÅÏ„); $A³Ëƒ—×Î‘ = $this->join($a»½†éÈà)->where($E¤ÙÂß¾†¨)->select(); goto cñß‹çŠÈ; Dš¶¸ñ‘òÊ: $a»½†éÈà = $a»½†éÈà . $f§¦ĞÎ“¸[434]; $Dà‰¹ö¾· = $BÎ”Ü¥—Ò[$f§¦ĞÎ“¸[361]] * ($BÎ”Ü¥—Ò[$f§¦ĞÎ“¸[351]] - 1) . $f§¦ĞÎ“¸[47] . $BÎ”Ü¥—Ò[$f§¦ĞÎ“¸[361]]; $EÒš²ù¡–« = $this->_makeOrder(!0); goto cö ›ä‚½à; cö ›ä‚½à: $Cìõ µÅÏ„ = $f§¦ĞÎ“¸[430] . str_replace($f§¦ĞÎ“¸[47], $f§¦ĞÎ“¸[431], $EÒš²ù¡–«[0]); if (strpos($Cìõ µÅÏ„, $f§¦ĞÎ“¸[435])) { $Cìõ µÅÏ„ = str_replace($f§¦ĞÎ“¸[435], $f§¦ĞÎ“¸[436], $Cìõ µÅÏ„); } else { $Cìõ µÅÏ„ .= $f§¦ĞÎ“¸[437] . $EÒš²ù¡–«[1]; } $E¤ÙÂß¾†¨ = array(); goto B‰Ñ¥£ÅïÄ; EãíÔºÊ†‹: $cÒºÁÌ«¼¿ = str_replace(array($f§¦ĞÎ“¸[50], $f§¦ĞÎ“¸[340], $f§¦ĞÎ“¸[229]), $f§¦ĞÎ“¸[33], $cÒºÁÌ«¼¿); $cÒºÁÌ«¼¿ = $f§¦ĞÎ“¸[430] . str_replace($f§¦ĞÎ“¸[47], $f§¦ĞÎ“¸[431], $cÒºÁÌ«¼¿) . $f§¦ĞÎ“¸[432]; $a»½†éÈà = $f§¦ĞÎ“¸[433]; goto Dš¶¸ñ‘òÊ; dæ²ÇàˆÊ: $f§¦ĞÎ“¸ =& $_SERVER[©äõ½¡]; if (!is_array($F‚ÂŒ–ó‰ø[$f§¦ĞÎ“¸[364]])) { return; } $BÎ”Ü¥—Ò = $F‚ÂŒ–ó‰ø[$f§¦ĞÎ“¸[364]]; goto A‚º–£Â‹à; A‚º–£Â‹à: if ($BÎ”Ü¥—Ò[$f§¦ĞÎ“¸[366]] <= 1) { return; } if ($BÎ”Ü¥—Ò[$f§¦ĞÎ“¸[365]] >= 100000) { return; } if (Model($f§¦ĞÎ“¸[427])->get($f§¦ĞÎ“¸[428]) != $f§¦ĞÎ“¸[429]) { return; } goto EãíÔºÊ†‹; cñß‹çŠÈ: if ($A³Ëƒ—×Î‘) { $F‚ÂŒ–ó‰ø[$f§¦ĞÎ“¸[367]] = $A³Ëƒ—×Î‘; } goto AŞøÃô¹‘“; AŞøÃô¹‘“: } protected function _makeOrder($eàÁÙ‡ğö¹ = false) { goto AêçÅµ©¬¤; D”Ø‚ŞØ‘¢: $d çÆäÀ¾ = Input::get($dºæ¾êøò[450], $dºæ¾êøò[7], $bÁ²š’ÒÙ›, array_keys($d™œÁíÑó†)); if (!in_array($D­”Âéµ’½, array_keys($E¶®®Êƒ¦Ï))) { $D­”Âéµ’½ = $dºæ¾êøò[28]; } if (!in_array($d çÆäÀ¾, array_keys($d™œÁíÑó†))) { $D­”Âéµ’½ = $dºæ¾êøò[442]; } goto e¬êöÂÈ¸; FÇéå¡“•á: if ($eàÁÙ‡ğö¹) { return array($Dƒéáë¶õ, $d™œÁíÑó†[$d çÆäÀ¾]); } return $this->order($Dƒéáë¶õ); goto dğ¬àÕ®˜; AêçÅµ©¬¤: $dºæ¾êøò =& $_SERVER[©äõ½¡]; $FÕ²—¡¤¤ = Model($dºæ¾êøò[439])->get($dºæ¾êøò[440]); $bÁ²š’ÒÙ› = Model($dºæ¾êøò[439])->get($dºæ¾êøò[441]); goto a‘Ûëö‡Õƒ; a‘Ûëö‡Õƒ: $d™œÁíÑó† = array($dºæ¾êøò[442] => $dºæ¾êøò[443], $dºæ¾êøò[444] => $dºæ¾êøò[445]); $E¶®®Êƒ¦Ï = array($dºæ¾êøò[28] => $dºæ¾êøò[28], $dºæ¾êøò[78] => $dºæ¾êøò[78], $dºæ¾êøò[168] => $dºæ¾êøò[407], $dºæ¾êøò[446] => $dºæ¾êøò[446], $dºæ¾êøò[447] => $dºæ¾êøò[448], $dºæ¾êøò[194] => $dºæ¾êøò[194], $dºæ¾êøò[84] => $dºæ¾êøò[84]); $D­”Âéµ’½ = Input::get($dºæ¾êøò[449], $dºæ¾êøò[7], $FÕ²—¡¤¤, array_keys($E¶®®Êƒ¦Ï)); goto D”Ø‚ŞØ‘¢; e¬êöÂÈ¸: if ($D­”Âéµ’½ == $dºæ¾êøò[28]) { } $Dƒéáë¶õ = $dºæ¾êøò[451] . $E¶®®Êƒ¦Ï[$D­”Âéµ’½] . $dºæ¾êøò[50] . $d™œÁíÑó†[$d çÆäÀ¾]; $Dƒéáë¶õ = rtrim(trim($Dƒéáë¶õ), $dºæ¾êøò[47]); goto FÇéå¡“•á; dğ¬àÕ®˜: } protected function _listDataApplyItem($eŒÁˆ¡åÀé, $Fô¤ŸË¹¯Ø = false) { $B±èö¬­Á = array($eŒÁˆ¡åÀé); $this->_listDataApply($B±èö¬­Á, $Fô¤ŸË¹¯Ø); return $B±èö¬­Á[0]; } protected function _listDataApply(&$EÍßà‹ù°, $bëñ½Øâˆ© = false) { goto fÄÚèÎ’‡; e‘¶„ÉÓ: $C²ê´„‹ = array_unique($C²ê´„‹); $this->_listSourceCache($EÍßà‹ù°); if (!$bëñ½Øâˆ©) { $this->_listAppendMeta($EÍßà‹ù°, $C²ê´„‹); $this->_listAppendFileMeta($EÍßà‹ù°, $C²ê´„‹); $this->_listAppendChildren($EÍßà‹ù°, $C²ê´„‹); } goto f¥Ù¡ ¿Œ; f¥Ù¡ ¿Œ: $this->_listAppendPath($EÍßà‹ù°); $this->_listAppendAuth($EÍßà‹ù°); $this->_listAppendSourceInfo($EÍßà‹ù°, $C²ê´„‹); goto c½‡â‰¯øÊ; fÄÚèÎ’‡: $C‘õ„†ñÓ¯ =& $_SERVER[©äõ½¡]; if (!$EÍßà‹ù°) { $EÍßà‹ù° = array(); return; } $C²ê´„‹ = array_to_keyvalue($EÍßà‹ù°, $C‘õ„†ñÓ¯[33], $C‘õ„†ñÓ¯[397]); goto e‘¶„ÉÓ; c½‡â‰¯øÊ: $this->_listAppendUser($EÍßà‹ù°); $this->_listFilterInfo($EÍßà‹ù°, $bëñ½Øâˆ©); $this->_listAppendAuthSecret($EÍßà‹ù°); goto b¤Äëæ«…„; b¤Äëæ«…„: } protected function _listSourceCache($D„Ö÷„ÖÇ) { $BóĞ›¡ï‡ =& $_SERVER[©äõ½¡]; foreach ($D„Ö÷„ÖÇ as $b–ó‚Úô›‹) { self::$cacheSourceInfo[$BóĞ›¡ï‡[452] . $b–ó‚Úô›‹[$BóĞ›¡ï‡[397]]] = $b–ó‚Úô›‹; } } protected function _listFilterInfo(&$F¨÷·Ü“Ç£, $a¯ô»éğÄ = false) { $bÜáŸã‚­ =& $_SERVER[©äõ½¡]; foreach ($F¨÷·Ü“Ç£ as &$A¥½„¤Îâ) { $A¥½„¤Îâ = $this->pathInfoFilter($A¥½„¤Îâ); self::$cachePathInfo[$bÜáŸã‚­[453] . intval($a¯ô»éğÄ) . $bÜáŸã‚­[454] . $A¥½„¤Îâ[$bÜáŸã‚­[397]]] = $A¥½„¤Îâ; } unset($A¥½„¤Îâ); } protected function _listMake(&$bäëÎ“ğ¾Ï) { $C«Úæˆ†º¤ =& $_SERVER[©äõ½¡]; $bäëÎ“ğ¾Ï[$C«Úæˆ†º¤[75]] = array(); $bäëÎ“ğ¾Ï[$C«Úæˆ†º¤[74]] = array(); foreach ($bäëÎ“ğ¾Ï[$C«Úæˆ†º¤[367]] as $D«±¡‡ª¡‚) { $f”ª¬øãŠª = $D«±¡‡ª¡‚[$C«Úæˆ†º¤[405]] == 1 ? $C«Úæˆ†º¤[75] : $C«Úæˆ†º¤[74]; $bäëÎ“ğ¾Ï[$f”ª¬øãŠª][] = $D«±¡‡ª¡‚; } unset($bäëÎ“ğ¾Ï[$C«Úæˆ†º¤[367]]); } protected function _listAppendMeta(&$bùˆ¢öÍâ, $Bâ†¾š ‚ç) { goto E˜¨Å£ì´; aÎÍÀèŞ: foreach ($b“Œ¿¿´´ä as $a¬‡¶Š´ˆÀ) { if (!isset($f–‘ÉŒÈËà[$a¬‡¶Š´ˆÀ[$C­·¹¨÷Ş[397]]])) { $f–‘ÉŒÈËà[$a¬‡¶Š´ˆÀ[$C­·¹¨÷Ş[397]]] = array(); } if (in_array($a¬‡¶Š´ˆÀ[$C­·¹¨÷Ş[93]], $DÁ¶×®µ¯)) { continue; } $f–‘ÉŒÈËà[$a¬‡¶Š´ˆÀ[$C­·¹¨÷Ş[397]]][$a¬‡¶Š´ˆÀ[$C­·¹¨÷Ş[93]]] = $a¬‡¶Š´ˆÀ[$C­·¹¨÷Ş[372]]; } foreach ($bùˆ¢öÍâ as &$C£î–ÁÕëÂ) { $C£î–ÁÕëÂ[$C­·¹¨÷Ş[459]] = !1; if (isset($f–‘ÉŒÈËà[$C£î–ÁÕëÂ[$C­·¹¨÷Ş[397]]])) { $C£î–ÁÕëÂ[$C­·¹¨÷Ş[459]] = $f–‘ÉŒÈËà[$C£î–ÁÕëÂ[$C­·¹¨÷Ş[397]]]; } if ($this->fileIsLock($C£î–ÁÕëÂ) && $C£î–ÁÕëÂ[$C­·¹¨÷Ş[408]]) { $Fù—øã‘ëÌ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $C£î–ÁÕëÂ[$C­·¹¨÷Ş[408]][$C­·¹¨÷Ş[409]] = AuthModel::authDisable($C£î–ÁÕëÂ[$C­·¹¨÷Ş[408]][$C­·¹¨÷Ş[409]], $Fù—øã‘ëÌ); $C£î–ÁÕëÂ[$C­·¹¨÷Ş[408]][$C­·¹¨÷Ş[460]][$C­·¹¨÷Ş[408]] = $C£î–ÁÕëÂ[$C­·¹¨÷Ş[408]][$C­·¹¨÷Ş[409]]; } } unset($C£î–ÁÕëÂ); goto BŠŞï°ÅÚß; E˜¨Å£ì´: $C­·¹¨÷Ş =& $_SERVER[©äõ½¡]; $Dèß‹¬´Ó§ = array($C­·¹¨÷Ş[412] => array($C­·¹¨÷Ş[413], $Bâ†¾š ‚ç)); $b“Œ¿¿´´ä = Model($C­·¹¨÷Ş[455])->field($C­·¹¨÷Ş[456])->where($Dèß‹¬´Ó§)->select(); goto DÈ¢ƒ¿šµ; DÈ¢ƒ¿šµ: if (!$b“Œ¿¿´´ä) { return; } $DÁ¶×®µ¯ = array($C­·¹¨÷Ş[457], $C­·¹¨÷Ş[458], $C­·¹¨÷Ş[436]); $f–‘ÉŒÈËà = array(); goto aÎÍÀèŞ; BŠŞï°ÅÚß: } protected function _listAppendFileMeta(&$C½Æ‰ƒ™³, $FÂ¨¹ÖŞ‰) { goto DÂ¡íÑ¦³; cïÙ¬±Ïì: foreach ($C½Æ‰ƒ™³ as &$d™çÁ‡ñè) { goto EÕ£ãº½”İ; B¤÷ğ‰ÖæÆ: $a¾îÆîÖï¶[$Bæ³â¨å¡Ê[78]] = $d™çÁ‡ñè[$Bæ³â¨å¡Ê[78]]; $a¾îÆîÖï¶[$Bæ³â¨å¡Ê[28]] = $d™çÁ‡ñè[$Bæ³â¨å¡Ê[28]]; if (!isset(self::$cacheFileInfo[$Bæ³â¨å¡Ê[467] . $A¾‹¥ÃŠ ¿])) { self::$cacheFileInfo[$Bæ³â¨å¡Ê[467] . $A¾‹¥ÃŠ ¿] = array_merge(array(), $a¾îÆîÖï¶); } goto BÇÙ‹¾ù’‰; e¸²®Œã¤Ğ: if (isset($d™çÁ‡ñè[$Bæ³â¨å¡Ê[164]][$Bæ³â¨å¡Ê[163]])) { $d™çÁ‡ñè[$Bæ³â¨å¡Ê[163]] = json_decode($d™çÁ‡ñè[$Bæ³â¨å¡Ê[164]][$Bæ³â¨å¡Ê[163]], !0); unset($d™çÁ‡ñè[$Bæ³â¨å¡Ê[164]][$Bæ³â¨å¡Ê[163]]); } goto c——ª‚¾çõ; BÇÙ‹¾ù’‰: unset($aë“…Ãè³Ü[$A¾‹¥ÃŠ ¿][$Bæ³â¨å¡Ê[76]]); $bòâ²ä¾ñ = is_array($E§ìòë÷Ùà[$A¾‹¥ÃŠ ¿]) ? $E§ìòë÷Ùà[$A¾‹¥ÃŠ ¿] : array(); $d™çÁ‡ñè[$Bæ³â¨å¡Ê[164]] = array_merge($bòâ²ä¾ñ, $aë“…Ãè³Ü[$A¾‹¥ÃŠ ¿]); goto e¸²®Œã¤Ğ; EÕ£ãº½”İ: $A¾‹¥ÃŠ ¿ = $d™çÁ‡ñè[$Bæ³â¨å¡Ê[461]]; if (!$A¾‹¥ÃŠ ¿ || !is_array($aë“…Ãè³Ü[$A¾‹¥ÃŠ ¿])) { continue; } $a¾îÆîÖï¶ = $aë“…Ãè³Ü[$A¾‹¥ÃŠ ¿]; goto B¤÷ğ‰ÖæÆ; c——ª‚¾çõ: } unset($d™çÁ‡ñè); goto bÔ‚ŸºÅŒ’; DÂ¡íÑ¦³: $Bæ³â¨å¡Ê =& $_SERVER[©äõ½¡]; $bÚ¯êÓ¦ºô = array_to_keyvalue($C½Æ‰ƒ™³, $Bæ³â¨å¡Ê[33], $Bæ³â¨å¡Ê[461]); $bÚ¯êÓ¦ºô = array_filter(array_unique($bÚ¯êÓ¦ºô)); goto EÅ”‘½…†; f££˜Ÿ“ââ: $aë“…Ãè³Ü = Model($Bæ³â¨å¡Ê[464])->field($EÈøáØ“)->where($Fø•¬…‡ÌÁ)->select(); $aë“…Ãè³Ü = array_to_keyvalue($aë“…Ãè³Ü, $Bæ³â¨å¡Ê[461]); $C­ï§Ï§” = Model($Bæ³â¨å¡Ê[465])->field($Bæ³â¨å¡Ê[466])->where($Fø•¬…‡ÌÁ)->select(); goto e¤„ˆí¯‹; EÅ”‘½…†: if (!$bÚ¯êÓ¦ºô) { return; } $Fø•¬…‡ÌÁ = array($Bæ³â¨å¡Ê[462] => array($Bæ³â¨å¡Ê[413], $bÚ¯êÓ¦ºô)); $EÈøáØ“ = $Bæ³â¨å¡Ê[463]; goto f££˜Ÿ“ââ; e¤„ˆí¯‹: $C­ï§Ï§” = $C­ï§Ï§” ? $C­ï§Ï§” : array(); $E§ìòë÷Ùà = array(); foreach ($C­ï§Ï§” as $féÀí¿Äó) { if (!isset($E§ìòë÷Ùà[$féÀí¿Äó[$Bæ³â¨å¡Ê[461]]])) { $E§ìòë÷Ùà[$féÀí¿Äó[$Bæ³â¨å¡Ê[461]]] = array(); } $E§ìòë÷Ùà[$féÀí¿Äó[$Bæ³â¨å¡Ê[461]]][$féÀí¿Äó[$Bæ³â¨å¡Ê[93]]] = $féÀí¿Äó[$Bæ³â¨å¡Ê[372]]; } goto cïÙ¬±Ïì; bÔ‚ŸºÅŒ’: } protected function _listAppendSourceInfo(&$c“İ¼œƒ, $F×¢Ç’ÑŠñ) { goto cÆ½©‘…ù¨; d’æÜ°¢Æ: $EîÔ‡Ñ™ = Model($eÀñ’±ßÜÂ[420])->listData(); $dÈ¶î¼Œâî = Model($eÀñ’±ßÜÂ[410])->listData(); $cÂ«£Â’Êª = Model($eÀñ’±ßÜÂ[470])->listSimple(); goto A­¯¢´ìÉë; EÌİÂğ›: $dØá¨Ãº˜¶ = array_to_keyvalue_group($cÂ«£Â’Êª, $eÀñ’±ßÜÂ[397]); foreach ($c“İ¼œƒ as &$fÌ¿ÅÙ‘¢ª) { $fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[85]] = array($eÀñ’±ßÜÂ[471] => 0, $eÀñ’±ßÜÂ[472] => 0, $eÀñ’±ßÜÂ[473] => 0); if (isset($F¥ÜğË¿á…[$fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[397]]])) { $fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[85]][$eÀñ’±ßÜÂ[474]] = 1; $fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[85]][$eÀñ’±ßÜÂ[475]] = $F¥ÜğË¿á…[$fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[397]]][$eÀñ’±ßÜÂ[28]]; } if (isset($fœƒ¼â­î‰[$fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[397]]])) { $fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[85]][$eÀñ’±ßÜÂ[476]] = array(); foreach ($fœƒ¼â­î‰[$fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[397]]] as $dåˆÚŸÉÌ˜) { $E¥¶À«®ä = $d‚·›¼øµ[$dåˆÚŸÉÌ˜]; $fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[85]][$eÀñ’±ßÜÂ[476]][] = array($eÀñ’±ßÜÂ[477] => $E¥¶À«®ä[$eÀñ’±ßÜÂ[395]], $eÀñ’±ßÜÂ[415] => $E¥¶À«®ä[$eÀñ’±ßÜÂ[28]], $eÀñ’±ßÜÂ[478] => $E¥¶À«®ä[$eÀñ’±ßÜÂ[479]]); } } if (isset($dØá¨Ãº˜¶[$fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[397]]])) { $fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[85]][$eÀñ’±ßÜÂ[480]] = array(); foreach ($dØá¨Ãº˜¶[$fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[397]]] as $AÓ¾·íéÆì) { $fÌ¿ÅÙ‘¢ª[$eÀñ’±ßÜÂ[85]][$eÀñ’±ßÜÂ[480]] = array($eÀñ’±ßÜÂ[481] => $AÓ¾·íéÆì[$eÀñ’±ßÜÂ[482]], $eÀñ’±ßÜÂ[483] => $AÓ¾·íéÆì[$eÀñ’±ßÜÂ[484]], $eÀñ’±ßÜÂ[485] => $AÓ¾·íéÆì[$eÀñ’±ßÜÂ[397]], $eÀñ’±ßÜÂ[486] => $AÓ¾·íéÆì[$eÀñ’±ßÜÂ[487]], $eÀñ’±ßÜÂ[488] => $AÓ¾·íéÆì[$eÀñ’±ßÜÂ[489]], $eÀñ’±ßÜÂ[490] => $AÓ¾·íéÆì[$eÀñ’±ßÜÂ[490]], $eÀñ’±ßÜÂ[491] => $AÓ¾·íéÆì[$eÀñ’±ßÜÂ[491]]); } } } unset($fÌ¿ÅÙ‘¢ª); goto B’–±Û×; cÆ½©‘…ù¨: $eÀñ’±ßÜÂ =& $_SERVER[©äõ½¡]; if (!defined($eÀñ’±ßÜÂ[468])) { return; } $D¦´‹ƒñ²Ã = Model($eÀñ’±ßÜÂ[469])->listData(); goto d’æÜ°¢Æ; B’–±Û×: return $c“İ¼œƒ; goto B“áµóÌ¬£; A­¯¢´ìÉë: $d‚·›¼øµ = array_to_keyvalue($D¦´‹ƒñ²Ã, $eÀñ’±ßÜÂ[395]); $fœƒ¼â­î‰ = array_to_keyvalue_group($EîÔ‡Ñ™, $eÀñ’±ßÜÂ[76], $eÀñ’±ßÜÂ[421]); $F¥ÜğË¿á… = array_to_keyvalue($dÈ¶î¼Œâî, $eÀñ’±ßÜÂ[76]); goto EÌİÂğ›; B“áµóÌ¬£: } protected function _listAppendChildren(&$b²Ú£õ—øÜ, $fŒ¥À“¾‹) { goto a÷•„ÚÉ; fæÄËŠªó™: foreach ($b²Ú£õ—øÜ as &$açÉ® “¢Í) { if (!$açÉ® “¢Í[$c¢Ÿï¿Ëè[405]]) { continue; } $E³¼¶èİ¿õ[] = $açÉ® “¢Í[$c¢Ÿï¿Ëè[397]]; } unset($açÉ® “¢Í); if (!$E³¼¶èİ¿õ) { return; } goto B²Ø›Ö¡Òë; c¤½«Û ¥: unset($açÉ® “¢Í); goto d‰ùãºçˆ¦; a÷•„ÚÉ: $c¢Ÿï¿Ëè =& $_SERVER[©äõ½¡]; $E³¼¶èİ¿õ = array(); $d¸ ’Š = array($c¢Ÿï¿Ëè[203] => 0, $c¢Ÿï¿Ëè[204] => 0); goto fæÄËŠªó™; aÁŠÓë§…ù: $a‘áù‡à±Ã = array(); foreach ($aÅ†ŒŠ‹ as $a°ä¿¸‡ í) { $d¶ˆ»Ş¡ = $a°ä¿¸‡ í[$c¢Ÿï¿Ëè[492]]; $C®«¼”ÃÖ° = $a°ä¿¸‡ í[$c¢Ÿï¿Ëè[405]] == $c¢Ÿï¿Ëè[87] ? $c¢Ÿï¿Ëè[204] : $c¢Ÿï¿Ëè[203]; if (!isset($a‘áù‡à±Ã[$d¶ˆ»Ş¡])) { $a‘áù‡à±Ã[$d¶ˆ»Ş¡] = array($c¢Ÿï¿Ëè[203] => 0, $c¢Ÿï¿Ëè[204] => 0); } $a‘áù‡à±Ã[$d¶ˆ»Ş¡][$C®«¼”ÃÖ°] += $a°ä¿¸‡ í[$c¢Ÿï¿Ëè[494]]; } foreach ($b²Ú£õ—øÜ as &$açÉ® “¢Í) { if (!$açÉ® “¢Í[$c¢Ÿï¿Ëè[405]]) { continue; } $dïÑ±Ò“ÀÃ = is_array($a‘áù‡à±Ã[$açÉ® “¢Í[$c¢Ÿï¿Ëè[397]]]) ? $a‘áù‡à±Ã[$açÉ® “¢Í[$c¢Ÿï¿Ëè[397]]] : $d¸ ’Š; $açÉ® “¢Í[$c¢Ÿï¿Ëè[204]] = $dïÑ±Ò“ÀÃ[$c¢Ÿï¿Ëè[204]]; $açÉ® “¢Í[$c¢Ÿï¿Ëè[203]] = $dïÑ±Ò“ÀÃ[$c¢Ÿï¿Ëè[203]]; unset($açÉ® “¢Í[$c¢Ÿï¿Ëè[407]]); } goto c¤½«Û ¥; B²Ø›Ö¡Òë: $E¡“ˆ®æˆ = array($c¢Ÿï¿Ëè[492] => array($c¢Ÿï¿Ëè[7], $E³¼¶èİ¿õ)); $DÑéšù†©ª = array($c¢Ÿï¿Ëè[492], $c¢Ÿï¿Ëè[405], $c¢Ÿï¿Ëè[493] => $c¢Ÿï¿Ëè[494]); $aÅ†ŒŠ‹ = $this->field($DÑéšù†©ª)->where($E¡“ˆ®æˆ)->group($c¢Ÿï¿Ëè[495])->select(); goto aÁŠÓë§…ù; d‰ùãºçˆ¦: } protected function _listAppendAuth(&$fø×ÙºìÔ) { goto F®Óï–ôÜ†; f·‚İŠøæ: foreach ($fø×ÙºìÔ as $f¬ãÏ‰Ê©¾) { if ($f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[406]] == self::TYPE_GROUP) { $bµö•Ë‰ÆÖ[] = $f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[397]]; } } if (!$bµö•Ë‰ÆÖ) { return; } $càÏ¨· = array_to_keyvalue($fø×ÙºìÔ, $Eå„ğ‰¸¶¡[397]); goto BÈî¬Ö ˆŞ; BÈî¬Ö ˆŞ: $cÔËĞëÚäÆ = Model($Eå„ğ‰¸¶¡[496])->getSourceList($bµö•Ë‰ÆÖ, $càÏ¨·); foreach ($fø×ÙºìÔ as $A§ÚÌ¸²ªå => &$f¬ãÏ‰Ê©¾) { $f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[408]] = $cÔËĞëÚäÆ[$f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[397]]]; if (!$f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[408]] && $f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[406]] == self::TYPE_GROUP) { $f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[408]] = Action($Eå„ğ‰¸¶¡[497])->pathGroupAuthMake($f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[498]]); if (!$f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[408]] && !_get($GLOBALS, $Eå„ğ‰¸¶¡[499])) { $f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[196]] = !1; $f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[195]] = !1; } } if ($f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[408]]) { $f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[196]] = AuthModel::authCheckEdit($f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[408]][$Eå„ğ‰¸¶¡[409]]); $f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[195]] = AuthModel::authCheckView($f¬ãÏ‰Ê©¾[$Eå„ğ‰¸¶¡[408]][$Eå„ğ‰¸¶¡[409]]); } $this->groupPathDisplay($f¬ãÏ‰Ê©¾); } unset($f¬ãÏ‰Ê©¾); goto dÏ²ã„öãå; F®Óï–ôÜ†: $Eå„ğ‰¸¶¡ =& $_SERVER[©äõ½¡]; if (!defined($Eå„ğ‰¸¶¡[468])) { return; } $bµö•Ë‰ÆÖ = array(); goto f·‚İŠøæ; dÏ²ã„öãå: } public function _listAppendAuthSecret(&$F‡–ÍÎåä) { goto F£ŒÊí¤ù‡; F£ŒÊí¤ù‡: $a®Ò—â®âæ =& $_SERVER[©äõ½¡]; if (Model($a®Ò—â®âæ[427])->get($a®Ò—â®âæ[500]) != $a®Ò—â®âæ[87]) { return; } static $E´ØµŸ¤É = false; goto Aóë«¡Š©„; Aóë«¡Š©„: if (!$E´ØµŸ¤É) { goto E“·¸áÄ±½; bŞÍ¨“¾Ç: $E´ØµŸ¤É = array_to_keyvalue($E´ØµŸ¤É, $a®Ò—â®âæ[397]); $CÊÊ±Ãå¸ = json_decode(Model($a®Ò—â®âæ[427])->get($a®Ò—â®âæ[503]), !0); $CÊÊ±Ãå¸ = array_to_keyvalue($CÊÊ±Ãå¸, $a®Ò—â®âæ[395]); goto aÔÂ…³øÔÃ; aÔÂ…³øÔÃ: foreach ($E´ØµŸ¤É as $F»èá†ŞÔ« => $a¯÷ÏÀë˜¯) { goto Fğâ¹¦ë¿; D­´ˆ¿…Î: if (!$AŠ§Éê‘„•) { $AÏ¦ğ¿Ôø->remove($a¯÷ÏÀë˜¯[$a®Ò—â®âæ[395]]); unset($E´ØµŸ¤É[$F»èá†ŞÔ«]); continue; } $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]] = $AŠ§Éê‘„•; $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[505]] = $d±à°öÊ’; goto Bò«Ï¼ŠÓ; Fğâ¹¦ë¿: $d±à°öÊ’ = $CÊÊ±Ãå¸[$a¯÷ÏÀë˜¯[$a®Ò—â®âæ[504]]]; if (!$d±à°öÊ’) { $AÏ¦ğ¿Ôø->remove($a¯÷ÏÀë˜¯[$a®Ò—â®âæ[395]]); unset($E´ØµŸ¤É[$F»èá†ŞÔ«]); continue; } $AŠ§Éê‘„• = $DÆšæ¼Ùñä->listData($d±à°öÊ’[$a®Ò—â®âæ[408]]); goto D­´ˆ¿…Î; Bò«Ï¼ŠÓ: $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[506]] = Model($a®Ò—â®âæ[507])->getInfoSimpleOuter($a¯÷ÏÀë˜¯[$a®Ò—â®âæ[446]]); $E´ØµŸ¤É[$F»èá†ŞÔ«] = $a¯÷ÏÀë˜¯; goto AÌĞõ•¹Ø—; AÌĞõ•¹Ø—: } goto E÷¨÷…ªœ™; E“·¸áÄ±½: $DÆšæ¼Ùñä = Model($a®Ò—â®âæ[501]); $AÏ¦ğ¿Ôø = Model($a®Ò—â®âæ[502]); $E´ØµŸ¤É = $AÏ¦ğ¿Ôø->listData(); goto bŞÍ¨“¾Ç; E÷¨÷…ªœ™: } $Cåƒ§‘²ÂŞ = defined($a®Ò—â®âæ[508]) ? USER_ID : $a®Ò—â®âæ[33]; $D…½¯´Ÿ‰é = array(); goto b¥ñ‚µğÏ; b¥ñ‚µğÏ: $DàÂÀäïŒ× = $this->_listAppendPath($D…½¯´Ÿ‰é, !0); foreach ($F‡–ÍÎåä as $F»èá†ŞÔ« => &$a¯÷ÏÀë˜¯) { if (!is_array($a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]])) { continue; } if ($a¯÷ÏÀë˜¯[$a®Ò—â®âæ[406]] != $a®Ò—â®âæ[509]) { continue; } if (isset($E´ØµŸ¤É[$a¯÷ÏÀë˜¯[$a®Ò—â®âæ[397]]])) { goto DçšÜ¦ã†Û; b’‚Â·¾“: if ($c×ƒœä•ç²[$a®Ò—â®âæ[446]] != $Cåƒ§‘²ÂŞ) { $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[409]] = $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[409]] & $c×ƒœä•ç²[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[408]]; } continue; goto Aˆ‚­™Úˆƒ; cˆŞÔ°¥†·: $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[511]] = $c×ƒœä•ç²; $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[512]] = $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[513]]; $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[514]] = $a®Ò—â®âæ[87]; goto b’‚Â·¾“; DçšÜ¦ã†Û: $c×ƒœä•ç² = $E´ØµŸ¤É[$a¯÷ÏÀë˜¯[$a®Ò—â®âæ[397]]]; if (!is_array($a¯÷ÏÀë˜¯[$a®Ò—â®âæ[459]])) { $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[459]] = array(); } $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[459]][$a®Ò—â®âæ[510]] = $c×ƒœä•ç²[$a®Ò—â®âæ[504]]; goto cˆŞÔ°¥†·; Aˆ‚­™Úˆƒ: } $e‚©èæÉøŠ = $this->parentLevelArray($a¯÷ÏÀë˜¯[$a®Ò—â®âæ[515]]); $eÍ…ÜÉ—´ = array_reverse($e‚©èæÉøŠ); foreach ($eÍ…ÜÉ—´ as $Dô…Î—¦¹” => $cœÖ¬§ÛÑ) { goto F‚Â…ë™¢é; F‚Â…ë™¢é: if (!isset($E´ØµŸ¤É[$cœÖ¬§ÛÑ])) { continue; } $c×ƒœä•ç² = $E´ØµŸ¤É[$cœÖ¬§ÛÑ]; $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[511]] = $c×ƒœä•ç²; goto fà¢ÕÌ…Ò; cÆ¬Ş¸›Ñƒ: for ($e®ôçÖÁ¼ = 0; $e®ôçÖÁ¼ < $AŒĞ“µ¬¯‘; $e®ôçÖÁ¼++) { if (!isset($DàÂÀäïŒ×[$e‚©èæÉøŠ[$e®ôçÖÁ¼]])) { $d¿ÉØÇæ¶Š = $a®Ò—â®âæ[33]; break; } $d¿ÉØÇæ¶Š = $d¿ÉØÇæ¶Š . rtrim($DàÂÀäïŒ×[$e‚©èæÉøŠ[$e®ôçÖÁ¼]], $a®Ò—â®âæ[8]) . $a®Ò—â®âæ[8]; } $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[512]] = rtrim($d¿ÉØÇæ¶Š, $a®Ò—â®âæ[8]) . $a®Ò—â®âæ[8]; break; goto d¬×±Á«‚´; fà¢ÕÌ…Ò: if ($c×ƒœä•ç²[$a®Ò—â®âæ[446]] != $Cåƒ§‘²ÂŞ) { $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[409]] = $a¯÷ÏÀë˜¯[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[409]] & $c×ƒœä•ç²[$a®Ò—â®âæ[408]][$a®Ò—â®âæ[408]]; } $d¿ÉØÇæ¶Š = $a®Ò—â®âæ[33]; $AŒĞ“µ¬¯‘ = count($e‚©èæÉøŠ) - $Dô…Î—¦¹”; goto cÆ¬Ş¸›Ñƒ; d¬×±Á«‚´: } } unset($a¯÷ÏÀë˜¯); goto e¯ÎïÊÖÁë; e¯ÎïÊÖÁë: } public function groupPathDisplay(&$C…È¬»ãÓ) { goto eŒ·‹³Œ¢¼; eŒ·‹³Œ¢¼: $d—å¤£åƒ¿ =& $_SERVER[©äõ½¡]; if ($C…È¬»ãÓ[$d—å¤£åƒ¿[406]] != self::TYPE_GROUP) { return; } $B•´à‰¡µ = Model($d—å¤£åƒ¿[516])->getInfo($C…È¬»ãÓ[$d—å¤£åƒ¿[498]]); goto C¿ÊÉ—ÃîÜ; C¿ÊÉ—ÃîÜ: $Fœè¡»¬Š“ = $this->parentLevelArray($B•´à‰¡µ[$d—å¤£åƒ¿[515]]); $FˆªÌŸ¾æ = $d—å¤£åƒ¿[33]; foreach ($Fœè¡»¬Š“ as $d‰ŸÁÇ¦¡Î) { $B˜­Ğ‡Åßæ = Model($d—å¤£åƒ¿[516])->getInfo($d‰ŸÁÇ¦¡Î); $FˆªÌŸ¾æ .= $B˜­Ğ‡Åßæ[$d—å¤£åƒ¿[85]][$d—å¤£åƒ¿[397]] . $d—å¤£åƒ¿[47]; } goto A²¯Ú‰‘ˆö; A²¯Ú‰‘ˆö: $C…È¬»ãÓ[$d—å¤£åƒ¿[517]] = $B•´à‰¡µ[$d—å¤£åƒ¿[492]]; $C…È¬»ãÓ[$d—å¤£åƒ¿[518]] = $B•´à‰¡µ[$d—å¤£åƒ¿[515]]; $C…È¬»ãÓ[$d—å¤£åƒ¿[519]] = $B•´à‰¡µ[$d—å¤£åƒ¿[520]]; goto c ğö§‹·ã; c ğö§‹·ã: $C…È¬»ãÓ[$d—å¤£åƒ¿[521]] = $FˆªÌŸ¾æ . $B•´à‰¡µ[$d—å¤£åƒ¿[85]][$d—å¤£åƒ¿[397]]; goto eˆÑ‡ñòÎ; eˆÑ‡ñòÎ: } protected function _listAppendPath(&$e‘îÚãºÚ, $D½áñÉ½ = false) { goto eÇùéæ—Òö; cïÏŠ˜è®Á: unset($F§§äŠ°±Š); return $e‘îÚãºÚ; goto fˆ–Ë¹Å¡ò; EÚ»“ÆÌİ›: $Dô°ªÚ‡° = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $B¹‰‚ Ê¢ = array(); foreach ($e‘îÚãºÚ as &$F§§äŠ°±Š) { goto cğ· ”¼»; Fƒª¼…ºô¬: $aºåƒì®¢™ .= $F§§äŠ°±Š[$e®“¬‚©ª[28]]; if ($F§§äŠ°±Š[$e®“¬‚©ª[405]] == $e®“¬‚©ª[87]) { $aºåƒì®¢™ .= $e®“¬‚©ª[8]; } $F§§äŠ°±Š[$e®“¬‚©ª[513]] = str_replace($e®“¬‚©ª[523], $e®“¬‚©ª[8], $aºåƒì®¢™); goto E‡¢Í…çïó; E‡¢Í…çïó: if ($F§§äŠ°±Š[$e®“¬‚©ª[492]] == $e®“¬‚©ª[191]) { $F§§äŠ°±Š[$e®“¬‚©ª[28]] = trim($dãÒ­á¤î­[$F§§äŠ°±Š[$e®“¬‚©ª[397]]], $e®“¬‚©ª[8]); $F§§äŠ°±Š[$e®“¬‚©ª[513]] = $F§§äŠ°±Š[$e®“¬‚©ª[28]] . $e®“¬‚©ª[8]; } if (intval($F§§äŠ°±Š[$e®“¬‚©ª[406]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($F§§äŠ°±Š, $eÚÂøùÌ±, $Dô°ªÚ‡°); } goto eŠçŠ¥¸‹Œ; cğ· ”¼»: $CÕ’Øßİ = $F§§äŠ°±Š[$e®“¬‚©ª[515]]; $aºåƒì®¢™ = $e®“¬‚©ª[33]; if (isset($B¹‰‚ Ê¢[$CÕ’Øßİ])) { $aºåƒì®¢™ = $B¹‰‚ Ê¢[$CÕ’Øßİ]; } else { $eÚÂøùÌ± = $this->parentLevelArray($F§§äŠ°±Š[$e®“¬‚©ª[515]]); foreach ($eÚÂøùÌ± as $bÜ¨¤Òéâ => $dÈîÇ”°) { if (isset($dãÒ­á¤î­[$dÈîÇ”°])) { $aºåƒì®¢™ .= $dãÒ­á¤î­[$dÈîÇ”°] . $e®“¬‚©ª[8]; } } $B¹‰‚ Ê¢[$CÕ’Øßİ] = $aºåƒì®¢™; } goto Fƒª¼…ºô¬; eŠçŠ¥¸‹Œ: } goto cïÏŠ˜è®Á; aÎìÇˆ‡: $eëª­÷ºØ¹ = array(); if ($D½áñÉ½) { return $dãÒ­á¤î­; } foreach ($e‘îÚãºÚ as &$F§§äŠ°±Š) { goto eØÔš•‚š§; dáÉ ×â£Ä: if (isset($eëª­÷ºØ¹[$F§§äŠ°±Š[$e®“¬‚©ª[515]]])) { continue; } $eëª­÷ºØ¹[$F§§äŠ°±Š[$e®“¬‚©ª[515]]] = !0; $eÚÂøùÌ± = $this->parentLevelArray($F§§äŠ°±Š[$e®“¬‚©ª[515]]); goto e»öó¸à˜; eØÔš•‚š§: $D×¸¬ÜŠ´ = $F§§äŠ°±Š[$e®“¬‚©ª[397]]; if ($F§§äŠ°±Š[$e®“¬‚©ª[405]] == $e®“¬‚©ª[87] && $F§§äŠ°±Š[$e®“¬‚©ª[492]] != 0) { $dãÒ­á¤î­[$D×¸¬ÜŠ´] = $F§§äŠ°±Š[$e®“¬‚©ª[28]]; } if ($F§§äŠ°±Š[$e®“¬‚©ª[405]] == $e®“¬‚©ª[87] && $F§§äŠ°±Š[$e®“¬‚©ª[492]] == 0 && !isset($dãÒ­á¤î­[$D×¸¬ÜŠ´])) { $dãÒ­á¤î­[$D×¸¬ÜŠ´] = $this->_listAppendPathRoot($F§§äŠ°±Š, array()); } goto dáÉ ×â£Ä; e»öó¸à˜: foreach ($eÚÂøùÌ± as $bÜ¨¤Òéâ => $dÈîÇ”°) { if (isset($dãÒ­á¤î­[$dÈîÇ”°])) { continue; } if ($bÜ¨¤Òéâ == 0) { $dãÒ­á¤î­[$dÈîÇ”°] = $this->_listAppendPathRoot($F§§äŠ°±Š, $eÚÂøùÌ±); } if ($bÜ¨¤Òéâ != 0) { $AæùŠ†ø ‚[] = $dÈîÇ”°; } } goto EŠÂ–—­…¨; EŠÂ–—­…¨: } goto fÏĞİ‚ò÷; fÏĞİ‚ò÷: unset($F§§äŠ°±Š); $AæùŠ†ø ‚ = array_unique($AæùŠ†ø ‚); if (count($AæùŠ†ø ‚) > 0) { $AÙ¦ÏÛï£Õ = array($e®“¬‚©ª[412] => array($e®“¬‚©ª[413], $AæùŠ†ø ‚)); if (count($AæùŠ†ø ‚) == 1) { $e¯„ÈÏ‘ù± = $this->sourceInfo($AæùŠ†ø ‚[0]); $e¦¼â¸ŒĞÈ = is_array($e¯„ÈÏ‘ù±) ? array($e¯„ÈÏ‘ù±) : !1; } else { $e¦¼â¸ŒĞÈ = $this->field($e®“¬‚©ª[522])->where($AÙ¦ÏÛï£Õ)->select(); } if (!$e¦¼â¸ŒĞÈ) { $e¦¼â¸ŒĞÈ = array(); } foreach ($e¦¼â¸ŒĞÈ as $D‚…æóØ§ˆ) { $dãÒ­á¤î­[$D‚…æóØ§ˆ[$e®“¬‚©ª[397]]] = $D‚…æóØ§ˆ[$e®“¬‚©ª[28]]; } } goto EÚ»“ÆÌİ›; eÇùéæ—Òö: $e®“¬‚©ª =& $_SERVER[©äõ½¡]; static $dãÒ­á¤î­ = array(); $AæùŠ†ø ‚ = array(); goto aÎìÇˆ‡; fˆ–Ë¹Å¡ò: } private function _listAppendPathRecycle(&$E¡š‘“î££, $Cå¬ÒÎäå , $Bí•÷ƒáò†) { goto c³«¶Ìò¾†; bĞŞÛÜ: $aëøİ™äÅã = implode($E‡¹’Œ‹[8], array_slice($cñ¼°®š†è, 2)); $E¡š‘“î££[$E‡¹’Œ‹[513]] = $E‡¹’Œ‹[8] . LNG($E‡¹’Œ‹[524]) . $E‡¹’Œ‹[8] . ltrim($aëøİ™äÅã, $E‡¹’Œ‹[8]); $E¡š‘“î££[$E‡¹’Œ‹[515]] = $E‡¹’Œ‹[525] . implode($E‡¹’Œ‹[47], array_slice($Cå¬ÒÎäå , 1)) . $E‡¹’Œ‹[47]; goto dçØÔ¸ÕÜ; dçØÔ¸ÕÜ: if ($E¡š‘“î££[$E‡¹’Œ‹[397]] == $Bí•÷ƒáò†) { $E¡š‘“î££[$E‡¹’Œ‹[515]] = $E‡¹’Œ‹[525]; $E¡š‘“î££[$E‡¹’Œ‹[492]] = $E‡¹’Œ‹[191]; $E¡š‘“î££[$E‡¹’Œ‹[28]] = LNG($E‡¹’Œ‹[524]); } $E¡š‘“î££[$E‡¹’Œ‹[526]] = $E‡¹’Œ‹[527]; goto B¸ãÌ‘¬°ç; c³«¶Ìò¾†: $E‡¹’Œ‹ =& $_SERVER[©äõ½¡]; if (!in_array($Bí•÷ƒáò†, $Cå¬ÒÎäå ) && $E¡š‘“î££[$E‡¹’Œ‹[397]] != $Bí•÷ƒáò†) { return; } $cñ¼°®š†è = explode($E‡¹’Œ‹[8], trim($E¡š‘“î££[$E‡¹’Œ‹[513]], $E‡¹’Œ‹[8])); goto bĞŞÛÜ; B¸ãÌ‘¬°ç: } protected function _listAppendPathRoot(&$d×½‚Ö÷®, $Døâ˜ªè°) { $f´ ãŒÁİİ =& $_SERVER[©äõ½¡]; $BñìŠŒ¶ÆÉ = $f´ ãŒÁİİ[33]; if ($d×½‚Ö÷®[$f´ ãŒÁİİ[406]] == self::TYPE_USER) { if (defined($f´ ãŒÁİİ[468]) && $d×½‚Ö÷®[$f´ ãŒÁİİ[498]] == USER_ID) { $BñìŠŒ¶ÆÉ = LNG($f´ ãŒÁİİ[528]); if (!$Døâ˜ªè°) { $d×½‚Ö÷®[$f´ ãŒÁİİ[28]] = $BñìŠŒ¶ÆÉ; } } else { $Fá‚Ï°ğÃÄ = Model($f´ ãŒÁİİ[507])->getInfoSimple($d×½‚Ö÷®[$f´ ãŒÁİİ[498]]); $BñìŠŒ¶ÆÉ = LNG($f´ ãŒÁİİ[529]) . $f´ ãŒÁİİ[160] . $Fá‚Ï°ğÃÄ[$f´ ãŒÁİİ[28]] . $f´ ãŒÁİİ[530]; } } else { if ($d×½‚Ö÷®[$f´ ãŒÁİİ[406]] == self::TYPE_GROUP) { $Fá‚Ï°ğÃÄ = Model($f´ ãŒÁİİ[516])->getInfoSimple($d×½‚Ö÷®[$f´ ãŒÁİİ[498]]); $BñìŠŒ¶ÆÉ = $Fá‚Ï°ğÃÄ[$f´ ãŒÁİİ[28]]; } else { if ($d×½‚Ö÷®[$f´ ãŒÁİİ[406]] == self::TYPE_SYSTEM) { $BñìŠŒ¶ÆÉ = $f´ ãŒÁİİ[531]; } } } $BñìŠŒ¶ÆÉ = $BñìŠŒ¶ÆÉ ? $f´ ãŒÁİİ[8] . $BñìŠŒ¶ÆÉ . $f´ ãŒÁİİ[8] : $f´ ãŒÁİİ[8]; return $BñìŠŒ¶ÆÉ; } protected function _listAppendUser(&$fÔº×“µ¯ç) { goto FŒõ„îŞ¤ ; bá»›Ç‰ÚÑ: $f­İ˜ç–øñ = array_merge($Fãá‰£äØÃ, $fÚìæãÜ‡Ë); $e›ñ†“´¼« = Model($cÅŠ£¶Á‡[532])->userListInfo($f­İ˜ç–øñ); foreach ($fÔº×“µ¯ç as &$BÔ¥¡ª‚‡Œ) { $CÒ«‘¬à¦ = $BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[446]]; $BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[446]] = $e›ñ†“´¼«[$CÒ«‘¬à¦] ? $e›ñ†“´¼«[$CÒ«‘¬à¦] : !1; $CÒ«‘¬à¦ = $BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[448]]; $BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[448]] = $e›ñ†“´¼«[$CÒ«‘¬à¦] ? $e›ñ†“´¼«[$CÒ«‘¬à¦] : !1; if (isset($BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[459]]) && $BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[459]][$cÅŠ£¶Á‡[533]]) { $eµÛÀİ¨Òì = $GLOBALS[$cÅŠ£¶Á‡[6]][$cÅŠ£¶Á‡[88]][$cÅŠ£¶Á‡[534]]; if ($BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[459]][$cÅŠ£¶Á‡[535]] <= time() - $eµÛÀİ¨Òì) { $this->metaSet($BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[397]], $cÅŠ£¶Á‡[533], null); $this->metaSet($BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[397]], $cÅŠ£¶Á‡[535], null); unset($BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[459]][$cÅŠ£¶Á‡[533]]); continue; } $E‡œô¨ŞËƒ = $BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[459]][$cÅŠ£¶Á‡[533]]; $BÔ¥¡ª‚‡Œ[$cÅŠ£¶Á‡[459]][$cÅŠ£¶Á‡[536]] = Model($cÅŠ£¶Á‡[532])->getInfoSimpleOuter($E‡œô¨ŞËƒ); } } goto CÜ— »ßÈ½; CÜ— »ßÈ½: unset($BÔ¥¡ª‚‡Œ); goto fñÑÉéêáÕ; FŒõ„îŞ¤ : $cÅŠ£¶Á‡ =& $_SERVER[©äõ½¡]; $Fãá‰£äØÃ = array_to_keyvalue($fÔº×“µ¯ç, $cÅŠ£¶Á‡[33], $cÅŠ£¶Á‡[446]); $fÚìæãÜ‡Ë = array_to_keyvalue($fÔº×“µ¯ç, $cÅŠ£¶Á‡[33], $cÅŠ£¶Á‡[448]); goto bá»›Ç‰ÚÑ; fñÑÉéêáÕ: } public function parentLevelArray($F”Ïö¦‡ÒŠ) { $DÕ¼‹ãº¤¥ =& $_SERVER[©äõ½¡]; $F”Ïö¦‡ÒŠ = explode($DÕ¼‹ãº¤¥[47], trim($F”Ïö¦‡ÒŠ, $DÕ¼‹ãº¤¥[47])); return array_remove_value($F”Ïö¦‡ÒŠ, $DÕ¼‹ãº¤¥[191]); } public function listAll($Eµ‹ñÅŠÚâ) { goto c™„§ÜÆÂ; eêÈ›–Ë«…: $BÖ†—¼åÃó = array_to_keyvalue($BÖ†—¼åÃó, $a‹õ˜ÄîŞ[397]); $Aø²¿ÎØ¾ñ = "\57{$D’¯ÖØõåÜ[$a‹õ˜ÄîŞ[28]]}\x2f"; $Aø²¿ÎØ¾ñ = $Aø²¿ÎØ¾ñ == $a‹õ˜ÄîŞ[523] ? $a‹õ˜ÄîŞ[8] : $Aø²¿ÎØ¾ñ; goto e¤œ°Ö˜’; e¤œ°Ö˜’: $d¥ÂÁó²È„ = array(); foreach ($BÖ†—¼åÃó as $bÌ•¸¬Î„Å => $b¯øòáŠ¥) { goto BÀÅèÍùùÑ; BÀÅèÍùùÑ: $A—¨ˆÀ£µ² = $this->parentLevelArray($b¯øòáŠ¥[$a‹õ˜ÄîŞ[515]]); array_shift($A—¨ˆÀ£µ²); $eŒ«¢¼©¶ = $Aø²¿ÎØ¾ñ; goto dÆ›†±ŠŸ°; BŞøÏ„íó: if (!$b¯øòáŠ¥[$a‹õ˜ÄîŞ[405]]) { $fÅ³Áó¥»‡[$a‹õ˜ÄîŞ[461]] = $b¯øòáŠ¥[$a‹õ˜ÄîŞ[461]]; $fÅ³Áó¥»‡[$a‹õ˜ÄîŞ[86]] = $b¯øòáŠ¥[$a‹õ˜ÄîŞ[76]]; } $d¥ÂÁó²È„[] = $fÅ³Áó¥»‡; goto EÖÒ¥’ğÂ§; a„õË“‰ã: $eŒ«¢¼©¶ = str_replace($a‹õ˜ÄîŞ[523], $a‹õ˜ÄîŞ[8], $eŒ«¢¼©¶); $eŒ«¢¼©¶ = str_replace($a‹õ˜ÄîŞ[523], $a‹õ˜ÄîŞ[8], $eŒ«¢¼©¶); $fÅ³Áó¥»‡ = array($a‹õ˜ÄîŞ[416] => str_replace($a‹õ˜ÄîŞ[523], $a‹õ˜ÄîŞ[8], $eŒ«¢¼©¶), $a‹õ˜ÄîŞ[542] => intval($b¯øòáŠ¥[$a‹õ˜ÄîŞ[405]]), $a‹õ˜ÄîŞ[85] => $this->pathInfoFilter($b¯øòáŠ¥)); goto BŞøÏ„íó; dÆ›†±ŠŸ°: for ($eŠìëÄÅ  = 0; $eŠìëÄÅ  < count($A—¨ˆÀ£µ²); $eŠìëÄÅ ++) { $eŒ«¢¼©¶ .= $BÖ†—¼åÃó[$A—¨ˆÀ£µ²[$eŠìëÄÅ ]][$a‹õ˜ÄîŞ[28]] . $a‹õ˜ÄîŞ[8]; } $eŒ«¢¼©¶ .= $b¯øòáŠ¥[$a‹õ˜ÄîŞ[28]]; if ($b¯øòáŠ¥[$a‹õ˜ÄîŞ[405]]) { $eŒ«¢¼©¶ .= $a‹õ˜ÄîŞ[8]; } goto a„õË“‰ã; EÖÒ¥’ğÂ§: } return $d¥ÂÁó²È„; goto BÚÆ¶¸‰ê; AÓÖ¨™Úºã: $this->_listAppendAuth($BÖ†—¼åÃó); $this->_listAppendUser($BÖ†—¼åÃó); $this->_listAppendPath($BÖ†—¼åÃó); goto eêÈ›–Ë«…; BˆİÎàªŠ¾: $bŠÚ„‹ŒŠ = $a‹õ˜ÄîŞ[541]; $D©©Õø¦ë¸ = "\x4c\x45\x46\124\x20\x4a\117\x49\x4e\x20{$this->tablePrefix}\151\157\x5f\x66\151\154\x65\40\x66\151\154\x65\x20\157\156\x20\x73\x6f\165\162\143\145\56\146\x69\154\x65\x49\x44\40\75\x20\146\151\x6c\x65\56\146\x69\154\145\x49\x44"; $BÖ†—¼åÃó = $this->alias($a‹õ˜ÄîŞ[438])->field($bŠÚ„‹ŒŠ)->where($FÄËÙìõË­)->join($D©©Õø¦ë¸)->select(); goto AÓÖ¨™Úºã; c™„§ÜÆÂ: $a‹õ˜ÄîŞ =& $_SERVER[©äõ½¡]; $D’¯ÖØõåÜ = $this->sourceInfo($Eµ‹ñÅŠÚâ); $FÄËÙìõË­ = array($a‹õ˜ÄîŞ[537] => array($a‹õ˜ÄîŞ[538], $D’¯ÖØõåÜ[$a‹õ˜ÄîŞ[515]] . $Eµ‹ñÅŠÚâ . $a‹õ˜ÄîŞ[539]), $a‹õ˜ÄîŞ[540] => 0); goto BˆİÎàªŠ¾; BÚÆ¶¸‰ê: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($a»àé¦•È¹) { goto BÈàˆ½ö‰µ; EÉ—¦½±ØĞ: $this->_lockEvent($a»àé¦•È¹, array($Aï¿»ğğ›÷[546], $Aï¿»ğğ›÷[547]), $Bƒ»µ“†Û‚); $this->_lockCheckEnd($Aï¿»ğğ›÷[543], $a»àé¦•È¹); goto cä×©ÙÆ°; e¨¹‡÷¹¡”: $Bƒ»µ“†Û‚ = 1; $this->_lockEvent($a»àé¦•È¹, array($Aï¿»ğğ›÷[544], $Aï¿»ğğ›÷[545]), $Bƒ»µ“†Û‚); $this->_lockParent($a»àé¦•È¹, array($Aï¿»ğğ›÷[545]), $Bƒ»µ“†Û‚); goto EÉ—¦½±ØĞ; BÈàˆ½ö‰µ: $Aï¿»ğğ›÷ =& $_SERVER[©äõ½¡]; if (!$this->allowLock()) { return; } $this->_lockCheck($Aï¿»ğğ›÷[543], $a»àé¦•È¹); goto e¨¹‡÷¹¡”; cä×©ÙÆ°: } public function lockCopyEnd($AïƒŒ•‹ë×) { $B¤œÓÇÌè =& $_SERVER[©äõ½¡]; if (!$this->allowLock()) { return; } $c×ÌŞíØ†£ = 0; $this->_lockEvent($AïƒŒ•‹ë×, array($B¤œÓÇÌè[544], $B¤œÓÇÌè[545]), $c×ÌŞíØ†£); $this->_lockParent($AïƒŒ•‹ë×, array($B¤œÓÇÌè[545]), $c×ÌŞíØ†£); $this->_lockEvent($AïƒŒ•‹ë×, array($B¤œÓÇÌè[546], $B¤œÓÇÌè[547]), $c×ÌŞíØ†£); } public function lockWriteStart($d”©‚ÔĞŒß, $bŠÊÃ‹ó = '') { goto Aë¨êÄ…µ; Aë¨êÄ…µ: $f‹‡ŞÔÄà® =& $_SERVER[©äõ½¡]; if (!$this->allowLock()) { return; } $this->_lockCheck($f‹‡ŞÔÄà®[544], $d”©‚ÔĞŒß); goto DÖÍ‡¼¡ğ’; e´‡ß‘¨Ÿ°: $this->_lockParent($d”©‚ÔĞŒß, array($f‹‡ŞÔÄà®[543], $f‹‡ŞÔÄà®[545]), $eô…¢ì²×Æ); $this->_lockCheckEnd($f‹‡ŞÔÄà®[544], $d”©‚ÔĞŒß); goto E–…±Óîºî; DÖÍ‡¼¡ğ’: $eô…¢ì²×Æ = 1; $this->_lockKey($f‹‡ŞÔÄà®[548] . $d”©‚ÔĞŒß . $f‹‡ŞÔÄà®[95] . $bŠÊÃ‹ó, $eô…¢ì²×Æ); $this->_lockEvent($d”©‚ÔĞŒß, array($f‹‡ŞÔÄà®[543], $f‹‡ŞÔÄà®[545]), $eô…¢ì²×Æ); goto e´‡ß‘¨Ÿ°; E–…±Óîºî: } public function lockWriteEnd($dÎõÜÏ‘êÉ, $Bƒ¸²¿ƒ = '') { $eªÓõ“Ÿö¹ =& $_SERVER[©äõ½¡]; if (!$this->allowLock()) { return; } $aŠ‹èŠøÄÀ = 0; $this->_lockKey($eªÓõ“Ÿö¹[548] . $dÎõÜÏ‘êÉ . $eªÓõ“Ÿö¹[95] . $Bƒ¸²¿ƒ, $aŠ‹èŠøÄÀ); $this->_lockEvent($dÎõÜÏ‘êÉ, array($eªÓõ“Ÿö¹[543], $eªÓõ“Ÿö¹[545]), $aŠ‹èŠøÄÀ); $this->_lockParent($dÎõÜÏ‘êÉ, array($eªÓõ“Ÿö¹[543], $eªÓõ“Ÿö¹[545]), $aŠ‹èŠøÄÀ); } public function lockMoveStart($fò¿§Ì¦äª) { goto Eƒ¿™¡ŠàÈ; b£‰˜®¼˜ğ: $this->_lockParent($fò¿§Ì¦äª, array($dØ‰òôÎèç[543], $dØ‰òôÎèç[545]), $AˆİƒÇò¹); $this->_lockEvent($fò¿§Ì¦äª, array($dØ‰òôÎèç[550], $dØ‰òôÎèç[546], $dØ‰òôÎèç[547]), $AˆİƒÇò¹); $this->_lockCheckEnd($dØ‰òôÎèç[545], $fò¿§Ì¦äª); goto A“»·ÙŒÈ“; Eƒ¿™¡ŠàÈ: $dØ‰òôÎèç =& $_SERVER[©äõ½¡]; if (!$this->allowLock()) { return; } $this->_lockCheck($dØ‰òôÎèç[545], $fò¿§Ì¦äª); goto ašÙ¯¬ÜƒÊ; ašÙ¯¬ÜƒÊ: $AˆİƒÇò¹ = 1; $this->_lockKey($dØ‰òôÎèç[549] . $fò¿§Ì¦äª, $AˆİƒÇò¹); $this->_lockEvent($fò¿§Ì¦äª, array($dØ‰òôÎèç[543], $dØ‰òôÎèç[544]), $AˆİƒÇò¹); goto b£‰˜®¼˜ğ; A“»·ÙŒÈ“: } public function lockMoveEnd($bÕ½ê›£Ìà) { goto eŒ’™œğèé; f±ø•¦£äé: $this->_lockKey($C”ÒÉß°ÂŠ[549] . $bÕ½ê›£Ìà, $b¾›öÂ¢„Ö); $this->_lockEvent($bÕ½ê›£Ìà, array($C”ÒÉß°ÂŠ[543], $C”ÒÉß°ÂŠ[544]), $b¾›öÂ¢„Ö); $this->_lockParent($bÕ½ê›£Ìà, array($C”ÒÉß°ÂŠ[543], $C”ÒÉß°ÂŠ[545]), $b¾›öÂ¢„Ö); goto aµ³»ßËÉ‘; eŒ’™œğèé: $C”ÒÉß°ÂŠ =& $_SERVER[©äõ½¡]; if (!$this->allowLock()) { return; } $b¾›öÂ¢„Ö = 0; goto f±ø•¦£äé; aµ³»ßËÉ‘: $this->_lockEvent($bÕ½ê›£Ìà, array($C”ÒÉß°ÂŠ[550], $C”ÒÉß°ÂŠ[546], $C”ÒÉß°ÂŠ[547]), $b¾›öÂ¢„Ö); goto E„»„‘ƒææ; E„»„‘ƒææ: } private function _lockCheck($fé›¼ã£‹š, $C‡‰óÈØ–) { goto Bó¡Âˆ‹ŠÌ; Fñ³‰Æ†²‹: $this->_lockTimeStart[$f”·Ù˜ÀÉ] = timeFloat(); if (!is_array($Fî‚òÂ¦Ê)) { return; } $Dãå¦ŒŒ¤ = LNG($Aïïá×†Ï[551]); goto EÎ¾¢ µÔ©; Bó¡Âˆ‹ŠÌ: $Aïïá×†Ï =& $_SERVER[©äõ½¡]; $Fî‚òÂ¦Ê = $this->sourceInfo($C‡‰óÈØ–); $f”·Ù˜ÀÉ = $fé›¼ã£‹š . $Aïïá×†Ï[95] . $C‡‰óÈØ–; goto Fñ³‰Æ†²‹; EÎ¾¢ µÔ©: CacheLock::setErrorMsg($Aïïá×†Ï[160] . htmlspecialchars($Fî‚òÂ¦Ê[$Aïïá×†Ï[28]]) . $Aïïá×†Ï[530] . $Dãå¦ŒŒ¤); $this->_lockKey($f”·Ù˜ÀÉ, 1); $this->_lockKey($f”·Ù˜ÀÉ, 0); goto d•£ƒÄŠ; d•£ƒÄŠ: $d×ƒô­ôÏ = array_reverse($this->parentLevelArray($Fî‚òÂ¦Ê[$Aïïá×†Ï[515]])); foreach ($d×ƒô­ôÏ as $f•ôŠ—°“) { $f”·Ù˜ÀÉ = $fé›¼ã£‹š . $Aïïá×†Ï[552] . $f•ôŠ—°“; if (CacheLock::lockGet($Aïïá×†Ï[553] . $f”·Ù˜ÀÉ)) { $Fî‚òÂ¦Ê = $this->sourceInfo($f•ôŠ—°“); CacheLock::setErrorMsg($Aïïá×†Ï[160] . htmlspecialchars($Fî‚òÂ¦Ê[$Aïïá×†Ï[28]]) . $Aïïá×†Ï[530] . $Dãå¦ŒŒ¤); $this->_lockKey($f”·Ù˜ÀÉ, 1); $this->_lockKey($f”·Ù˜ÀÉ, 0); } } goto Aæ¦›·Íİé; Aæ¦›·Íİé: } private function _lockCheckEnd($FâÛâºŞÒ, $e‹ÂØá›Î) { goto CáâËŒ‹ Ó; CáâËŒ‹ Ó: $d²´œ“”ƒŸ =& $_SERVER[©äõ½¡]; $còìë©£Àˆ = $FâÛâºŞÒ . $d²´œ“”ƒŸ[95] . $e‹ÂØá›Î; CacheLock::setErrorMsg($d²´œ“”ƒŸ[376]); goto A¬¬¨–ËÄ; A¬¬¨–ËÄ: if (!isset($this->_lockTimeStart[$còìë©£Àˆ])) { return; } $eé“ã—˜õ³ = timeFloat() - $this->_lockTimeStart[$còìë©£Àˆ]; unset($this->_lockTimeStart[$còìë©£Àˆ]); goto a ™–³‰‹™; a ™–³‰‹™: if ($eé“ã—˜õ³ > 0.5) { unset(self::$cacheSourceInfo[$d²´œ“”ƒŸ[452] . $e‹ÂØá›Î]); } $b´´”õ‰ = $this->sourceInfo($e‹ÂØá›Î); if (!$b´´”õ‰) { show_json(LNG($d²´œ“”ƒŸ[105]), !1); } goto cµàÇ§ì¦; cµàÇ§ì¦: } private function _lockParent($Cöñ—‹‰«ƒ, $aïíŸŸ‹¯Ø, $föóÉÒ•åá) { if (!$this->autoLockSet) { return; } $c»áÔàÓÉø = $this->sourceInfo($Cöñ—‹‰«ƒ); if (!is_array($c»áÔàÓÉø)) { return; } $bÎÂØ–¨¯ø = array_reverse($this->parentLevelArray($c»áÔàÓÉø[$_SERVER[©äõ½¡][515]])); foreach ($bÎÂØ–¨¯ø as $F·¢Õ˜â¼•) { $this->_lockEvent($F·¢Õ˜â¼•, $aïíŸŸ‹¯Ø, $föóÉÒ•åá); } } private function _lockEvent($dêèŞáíô‰, $dôöèí¬…, $A¦–·ïË„¯) { $Cê‚İ¾ø =& $_SERVER[©äõ½¡]; if (!$this->autoLockSet) { return; } foreach ($dôöèí¬… as $d£‡ëÕáØ«) { $d¢Ââ¨‰ƒ” = $d£‡ëÕáØ« . $Cê‚İ¾ø[95] . $dêèŞáíô‰; if ($A¦–·ïË„¯ && CacheLock::lockGet($Cê‚İ¾ø[553] . $d¢Ââ¨‰ƒ”)) { continue; } $this->_lockKey($d¢Ââ¨‰ƒ”, $A¦–·ïË„¯); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($AÀ›»äœë‘, $BÅ‚°Šöñ¹ = 1) { $bøÛ”ºŠ‡ = $_SERVER[©äõ½¡][553] . md5($AÀ›»äœë‘); if ($BÅ‚°Šöñ¹) { if (isset(self::$_lockItemArr[$bøÛ”ºŠ‡])) { return; } self::$_lockItemArr[$bøÛ”ºŠ‡] = 1; CacheLock::lock($bøÛ”ºŠ‡, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$bøÛ”ºŠ‡])) { return; } unset(self::$_lockItemArr[$bøÛ”ºŠ‡]); CacheLock::unlock($bøÛ”ºŠ‡); } } public function isParentOf($eÈ¤•–‹à‹, $c™¬ÒÅÈê¸) { goto FŞÕùŒ¨Ä; F·‡«Í¸¦”: $cèŒµ†Ì¦ = $E¾‚²‡§ìÄ[$b¯ïáßØâÒ[515]] . $E¾‚²‡§ìÄ[$b¯ïáßØâÒ[397]] . $b¯ïáßØâÒ[47]; $d¸ƒÒò£ê¡ = $FÜ»´ªƒ§ˆ[$b¯ïáßØâÒ[515]] . $FÜ»´ªƒ§ˆ[$b¯ïáßØâÒ[397]] . $b¯ïáßØâÒ[47]; $AÓ§‰«í‚­ = strpos($d¸ƒÒò£ê¡, $cèŒµ†Ì¦) === 0; goto eœàÈÛÛ¾ò; FŞÕùŒ¨Ä: $b¯ïáßØâÒ =& $_SERVER[©äõ½¡]; $E¾‚²‡§ìÄ = $this->sourceInfo($eÈ¤•–‹à‹); $FÜ»´ªƒ§ˆ = $this->sourceInfo($c™¬ÒÅÈê¸); goto F·‡«Í¸¦”; eœàÈÛÛ¾ò: return $AÓ§‰«í‚­; goto F÷§Ù ´–Ë; F÷§Ù ´–Ë: } private $targetIsDelete = 0; public function copy($c•à·ÅÛĞ•, $A¡Æé†…ŒÂ, $e±Ùâ©ˆ = REPEAT_REPLACE, $b¥„òŸŒ = '') { goto E°Ò÷ˆ…–¶; aŞ²¥‘ì¥: $this->_childrenListClear(); $this->lockCopyEnd($c•à·ÅÛĞ•); $this->lockWriteEnd($A¡Æé†…ŒÂ, $aÌŠ¤°­Ì); goto a³‹æÖ½åÏ; aª­”ÎŞ©Ä: $this->lockCopyStart($c•à·ÅÛĞ•); $this->lockWriteStart($A¡Æé†…ŒÂ, $aÌŠ¤°­Ì); $a¨Æİ”à = array($d­Á´È½«[554] => array(), $d­Á´È½«[555] => array(), $d­Á´È½«[556] => array()); goto B®å£ô‡“”; E‹ë‚£§¿: $this->saveAll($a¨Æİ”à[$d­Á´È½«[556]]); Model($d­Á´È½«[193])->linkAdd($a¨Æİ”à[$d­Á´È½«[554]]); $this->folderSizeReset($A¡Æé†…ŒÂ); goto B·æë¨ªï¶; E°Ò÷ˆ…–¶: $d­Á´È½« =& $_SERVER[©äõ½¡]; $B…îãôØí´ = $this->sourceInfo($c•à·ÅÛĞ•); $a¸ÕØ¸˜‡Ş = $this->sourceInfo($A¡Æé†…ŒÂ); goto EƒÂ•è¸¢ø; B®å£ô‡“”: $this->targetIsDelete = intval($B…îãôØí´[$d­Á´È½«[425]]); $Bòö»ˆ£¿ = $this->fileNameExistCache($A¡Æé†…ŒÂ, $B…îãôØí´[$d­Á´È½«[28]]); $c‡ŒõÚ‚ä­ = $this->_copy($c•à·ÅÛĞ•, $A¡Æé†…ŒÂ, $e±Ùâ©ˆ, $a¨Æİ”à, !0, $b¥„òŸŒ); goto aŞ²¥‘ì¥; B·æë¨ªï¶: $this->updateModifyTime($A¡Æé†…ŒÂ); return $c‡ŒõÚ‚ä­; goto C¨ÁÍ²õŸ; EƒÂ•è¸¢ø: if (!$B…îãôØí´ || !$a¸ÕØ¸˜‡Ş || $a¸ÕØ¸˜‡Ş[$d­Á´È½«[405]] != $d­Á´È½«[87]) { return !1; } if ($this->isParentOf($c•à·ÅÛĞ•, $A¡Æé†…ŒÂ)) { return !1; } $aÌŠ¤°­Ì = $b¥„òŸŒ ? $b¥„òŸŒ : $B…îãôØí´[$d­Á´È½«[28]]; goto aª­”ÎŞ©Ä; a³‹æÖ½åÏ: if ($B…îãôØí´[$d­Á´È½«[405]] == $d­Á´È½«[87] && $Bòö»ˆ£¿ == $c‡ŒõÚ‚ä­) { $this->folderSizeResetChildren($Bòö»ˆ£¿); } Model($d­Á´È½«[557])->addAll($a¨Æİ”à[$d­Á´È½«[555]], array(), !0); if ($Bòö»ˆ£¿ != $c‡ŒõÚ‚ä­ || $B…îãôØí´[$d­Á´È½«[405]] == $d­Á´È½«[87]) { Model($d­Á´È½«[558])->eventCopy($c‡ŒõÚ‚ä­); } goto E‹ë‚£§¿; C¨ÁÍ²õŸ: } private function _copy($CšŠÖº§‡, $Aââ”‹‹¼, $dÄ’£µ¸â, &$e„«Û„“¢, $BÒª‡¸İË, $F‰‚Âí’Ê× = '') { goto D›êŸÎ‰° ; D›êŸÎ‰° : $f æ·„Ü¸‘ =& $_SERVER[©äõ½¡]; $Dó¯ÎËï˜ = $this->sourceInfoCache($CšŠÖº§‡); $BŠÏÙà»è = $Dó¯ÎËï˜[$f æ·„Ü¸‘[405]] == $f æ·„Ü¸‘[87]; goto a—…÷Ã‹Íç; fãå©®ªÌ: return $E‹½èÛÆ¼; goto F¯Úáç¢Ø“; a—…÷Ã‹Íç: $Fä²Ç°íƒ = $F‰‚Âí’Ê× ? $F‰‚Âí’Ê× : $Dó¯ÎËï˜[$f æ·„Ü¸‘[28]]; $cøÖ™†Õ²¶ = $this->fileNameExistCache($Aââ”‹‹¼, $Fä²Ç°íƒ); if ($BÒª‡¸İË) { $this->_childrenAllMake($CšŠÖº§‡); if ($BŠÏÙà»è && $cøÖ™†Õ²¶) { $this->_childrenAllMake($cøÖ™†Õ²¶); } } goto EËÙ·öÃ‚Ğ; EËÙ·öÃ‚Ğ: if (!$cøÖ™†Õ²¶) { return $this->_copyCreate($CšŠÖº§‡, $Aââ”‹‹¼, $Fä²Ç°íƒ, $e„«Û„“¢); } $E‹½èÛÆ¼ = $cøÖ™†Õ²¶; if ($BŠÏÙà»è) { if ($dÄ’£µ¸â == REPEAT_RENAME_FOLDER) { $Fä²Ç°íƒ = $this->fileNameAutoCache($Aââ”‹‹¼, $Fä²Ç°íƒ, $dÄ’£µ¸â, $BŠÏÙà»è); $E‹½èÛÆ¼ = $this->_copyCreate($CšŠÖº§‡, $Aââ”‹‹¼, $Fä²Ç°íƒ, $e„«Û„“¢); } else { $Bó‡Ì¨¹« = $this->_childrenList($CšŠÖº§‡); foreach ($Bó‡Ì¨¹« as $c‰ã®»ˆ¶) { $this->_copy($c‰ã®»ˆ¶[$f æ·„Ü¸‘[397]], $cøÖ™†Õ²¶, $dÄ’£µ¸â, $e„«Û„“¢, !1); } } } else { if ($dÄ’£µ¸â == REPEAT_RENAME || $dÄ’£µ¸â == REPEAT_RENAME_FOLDER) { $Fä²Ç°íƒ = $this->fileNameAutoCache($Aââ”‹‹¼, $Fä²Ç°íƒ, $dÄ’£µ¸â, $BŠÏÙà»è); $E‹½èÛÆ¼ = $this->_copyCreate($CšŠÖº§‡, $Aââ”‹‹¼, $Fä²Ç°íƒ, $e„«Û„“¢); } else { if ($dÄ’£µ¸â == REPEAT_REPLACE) { $A±Õ¯È…Åñ = $this->sourceInfoCache($cøÖ™†Õ²¶); $CÀã©Ó¢Ÿ = $this->fileHistory($A±Õ¯È…Åñ, $Dó¯ÎËï˜[$f æ·„Ü¸‘[461]], $Dó¯ÎËï˜[$f æ·„Ü¸‘[78]]); if ($CÀã©Ó¢Ÿ) { $e„«Û„“¢[$f æ·„Ü¸‘[554]][] = $Dó¯ÎËï˜[$f æ·„Ü¸‘[461]]; } } else { if ($dÄ’£µ¸â == REPEAT_SKIP) { } } } Hook::trigger($f æ·„Ü¸‘[559], array($f æ·„Ü¸‘[560], $Dó¯ÎËï˜, 0)); } goto fãå©®ªÌ; F¯Úáç¢Ø“: } private function _copyCreate($DŒÉ†¼Œ, $dªõ·ÔÅ¸®, $fÄŠä‹®¦, &$aáˆø©Ÿ„Ø) { goto aÏ–ÆŒ®«Ü; a©‚‡æ²·„: if ($CÁÕ‹ÃÈ® [$dÈ¦İ—¤ßæ[405]] != $dÈ¦İ—¤ßæ[87]) { $aáˆø©Ÿ„Ø[$dÈ¦İ—¤ßæ[554]][] = $CÁÕ‹ÃÈ® [$dÈ¦İ—¤ßæ[461]]; return $eä’½ÔÅ¾; } $e´ÍáìÄãê = array(); $E¿¦ ‹­›— = array(); goto B âóà‰Í; AÌ‚–“ƒÁÑ: $this->addAll($E¿¦ ‹­›—, array(), !1); $e×’¤ã‹…Å = $this->where(array($dÈ¦İ—¤ßæ[492] => $eä’½ÔÅ¾))->select(); $DõƒÚÅ°— = $this->_childrenMakeRelation($e´ÍáìÄãê, $e×’¤ã‹…Å); goto eŸàòÙÉîª; aÒóèŞº¹: $AŸÛ–ÄÀÑ© = $this->sourceInfo($eä’½ÔÅ¾); foreach ($e´ÍáìÄãê as $FÕç·Åì÷Ò) { $B§áªí†½» = $this->_makeItemData($FÕç·Åì÷Ò, $AŸÛ–ÄÀÑ©, $FÕç·Åì÷Ò[$dÈ¦İ—¤ßæ[28]]); $B§áªí†½»[$dÈ¦İ—¤ßæ[515]] = $FÕç·Åì÷Ò[$dÈ¦İ—¤ßæ[515]]; $E¿¦ ‹­›—[] = $B§áªí†½»; } $this->chunkEventSet($dÈ¦İ—¤ßæ[564], array($dÈ¦İ—¤ßæ[565], $D®•ºÀ’Æµ, $EÙ¹²ÄĞä¹)); goto AÌ‚–“ƒÁÑ; FÕ†áŒ’î : $D®•ºÀ’Æµ = $this->_makeItemData($CÁÕ‹ÃÈ® , $cö¦Š‰Ô›”, $fÄŠä‹®¦); Hook::trigger($dÈ¦İ—¤ßæ[561], $D®•ºÀ’Æµ); Hook::trigger($dÈ¦İ—¤ßæ[562], array($dÈ¦İ—¤ßæ[563], $D®•ºÀ’Æµ, 0)); goto dó”ÇÍõŒ; EŞ²ÌÔ™ê¤: $this->chunkEventSet($dÈ¦İ—¤ßæ[568], array($dÈ¦İ—¤ßæ[569], $D®•ºÀ’Æµ, $EÙ¹²ÄĞä¹)); $this->saveAll($BÔõ¿Ãß‘); return $eä’½ÔÅ¾; goto eÌÆ©ª°’¶; B âóà‰Í: $this->_childrenListAll($DŒÉ†¼Œ, $e´ÍáìÄãê); $EÙ¹²ÄĞä¹ = count($e´ÍáìÄãê); if ($EÙ¹²ÄĞä¹ == 0) { return $eä’½ÔÅ¾; } goto aÒóèŞº¹; eŸàòÙÉîª: $DõƒÚÅ°—[$DŒÉ†¼Œ] = $eä’½ÔÅ¾; $bÕ©Áª±– = array(); $BÔõ¿Ãß‘ = array(); goto F®Ì×“Ì×¶; dó”ÇÍõŒ: $eä’½ÔÅ¾ = $this->add($D®•ºÀ’Æµ); $BŞÚ°‘Œ´ = array($dÈ¦İ—¤ßæ[397] => $eä’½ÔÅ¾, $dÈ¦İ—¤ßæ[28] => $fÄŠä‹®¦); $this->_copyApplyMeta($BŞÚ°‘Œ´, $aáˆø©Ÿ„Ø); goto a©‚‡æ²·„; aÏ–ÆŒ®«Ü: $dÈ¦İ—¤ßæ =& $_SERVER[©äõ½¡]; $CÁÕ‹ÃÈ®  = $this->sourceInfoCache($DŒÉ†¼Œ); $cö¦Š‰Ô›” = $this->sourceInfoCache($dªõ·ÔÅ¸®); goto FÕ†áŒ’î ; F®Ì×“Ì×¶: foreach ($e×’¤ã‹…Å as $FÕç·Åì÷Ò) { $d´—„ô‡Æé = $FÕç·Åì÷Ò[$dÈ¦İ—¤ßæ[397]]; $eßîÉŠ·† = $this->_childrenMatch($DõƒÚÅ°—, $FÕç·Åì÷Ò, $AŸÛ–ÄÀÑ©); $bÕ©Áª±–[] = array($dÈ¦İ—¤ßæ[397], $d´—„ô‡Æé, $dÈ¦İ—¤ßæ[492], $eßîÉŠ·†[$dÈ¦İ—¤ßæ[492]]); $BÔõ¿Ãß‘[] = array($dÈ¦İ—¤ßæ[397], $d´—„ô‡Æé, $dÈ¦İ—¤ßæ[515], $eßîÉŠ·†[$dÈ¦İ—¤ßæ[515]]); $this->_copyApplyMeta($FÕç·Åì÷Ò, $aáˆø©Ÿ„Ø); if ($FÕç·Åì÷Ò[$dÈ¦İ—¤ßæ[405]] != $dÈ¦İ—¤ßæ[87]) { $aáˆø©Ÿ„Ø[$dÈ¦İ—¤ßæ[554]][] = $FÕç·Åì÷Ò[$dÈ¦İ—¤ßæ[461]]; } } $this->chunkEventSet($dÈ¦İ—¤ßæ[566], array($dÈ¦İ—¤ßæ[567], $D®•ºÀ’Æµ, $EÙ¹²ÄĞä¹)); $this->saveAll($bÕ©Áª±–); goto EŞ²ÌÔ™ê¤; eÌÆ©ª°’¶: } private function _childrenMakeRelation($b§¹‘àÅ¢Š, $dœè™Ñ‰Ì…) { $E‰›‡ãùºÏ =& $_SERVER[©äõ½¡]; $e¹‚º’±£ = array(); $a›Œ°°¸Ñ = array(); foreach ($b§¹‘àÅ¢Š as $aÁääÇáŒ) { $d™¦¢ÑÀÙ‡ = $aÁääÇáŒ[$E‰›‡ãùºÏ[28]] . $E‰›‡ãùºÏ[8] . $aÁääÇáŒ[$E‰›‡ãùºÏ[515]]; $e¹‚º’±£[$d™¦¢ÑÀÙ‡] = $aÁääÇáŒ[$E‰›‡ãùºÏ[397]]; } foreach ($dœè™Ñ‰Ì… as $aÁääÇáŒ) { $d™¦¢ÑÀÙ‡ = $aÁääÇáŒ[$E‰›‡ãùºÏ[28]] . $E‰›‡ãùºÏ[8] . $aÁääÇáŒ[$E‰›‡ãùºÏ[515]]; $D§§ØˆæÍİ = $e¹‚º’±£[$d™¦¢ÑÀÙ‡]; $a›Œ°°¸Ñ[$D§§ØˆæÍİ] = $aÁääÇáŒ[$E‰›‡ãùºÏ[397]]; } return $a›Œ°°¸Ñ; } private function _childrenMatch($C–ùñ£Í¶, $b„§ÛÃ“°Ê, $E÷ïç­„Ê) { goto Dœò¦ªÂ»§; d‚ïà…« ğ: $Eîã¬«Ÿ¦ù = $f‹‡ñá¸§Œ[count($f‹‡ñá¸§Œ) - 1]; return array($b«Ï°ğ¬Û[492] => $Eîã¬«Ÿ¦ù, $b«Ï°ğ¬Û[515] => $aŞ£­§¿½İ); goto Fî¢×ï—¥; FÜ´ˆÑø: foreach ($C¤ŞİİğŸè as $Fº¶ á›–µ) { if (isset($C–ùñ£Í¶[$Fº¶ á›–µ])) { $aŞ£­§¿½İ .= $C–ùñ£Í¶[$Fº¶ á›–µ] . $b«Ï°ğ¬Û[570]; } } $aŞ£­§¿½İ = rtrim($aŞ£­§¿½İ, $b«Ï°ğ¬Û[47]) . $b«Ï°ğ¬Û[47]; $f‹‡ñá¸§Œ = $this->parentLevelArray($aŞ£­§¿½İ); goto d‚ïà…« ğ; Dœò¦ªÂ»§: $b«Ï°ğ¬Û =& $_SERVER[©äõ½¡]; $aŞ£­§¿½İ = $E÷ïç­„Ê[$b«Ï°ğ¬Û[515]]; $C¤ŞİİğŸè = $this->parentLevelArray($b„§ÛÃ“°Ê[$b«Ï°ğ¬Û[515]]); goto FÜ´ˆÑø; Fî¢×ï—¥: } private function _makeItemData($aÈ©İ÷¤Óù, $DÔ¬¸ä«¾, $AŠ‚±¯å×à) { $eÏ„¯ÇØŒ¡ =& $_SERVER[©äõ½¡]; $AÄîª¾››Å = array($eÏ„¯ÇØŒ¡[571] => $aÈ©İ÷¤Óù[$eÏ„¯ÇØŒ¡[405]], $eÏ„¯ÇØŒ¡[415] => $AŠ‚±¯å×à, $eÏ„¯ÇØŒ¡[572] => $aÈ©İ÷¤Óù[$eÏ„¯ÇØŒ¡[407]], $eÏ„¯ÇØŒ¡[462] => $aÈ©İ÷¤Óù[$eÏ„¯ÇØŒ¡[461]], $eÏ„¯ÇØŒ¡[573] => $aÈ©İ÷¤Óù[$eÏ„¯ÇØŒ¡[78]], $eÏ„¯ÇØŒ¡[574] => $DÔ¬¸ä«¾[$eÏ„¯ÇØŒ¡[406]], $eÏ„¯ÇØŒ¡[575] => $DÔ¬¸ä«¾[$eÏ„¯ÇØŒ¡[498]], $eÏ„¯ÇØŒ¡[576] => USER_ID, $eÏ„¯ÇØŒ¡[577] => USER_ID, $eÏ„¯ÇØŒ¡[396] => $DÔ¬¸ä«¾[$eÏ„¯ÇØŒ¡[397]], $eÏ„¯ÇØŒ¡[578] => $DÔ¬¸ä«¾[$eÏ„¯ÇØŒ¡[515]] . $DÔ¬¸ä«¾[$eÏ„¯ÇØŒ¡[397]] . $eÏ„¯ÇØŒ¡[47], $eÏ„¯ÇØŒ¡[419] => $aÈ©İ÷¤Óù[$eÏ„¯ÇØŒ¡[84]], $eÏ„¯ÇØŒ¡[424] => 0, $eÏ„¯ÇØŒ¡[579] => $eÏ„¯ÇØŒ¡[33]); return $AÄîª¾››Å; } private function _copyApplyMeta($dáİÀ£¯ã, &$fÜ©©ñÍ¯) { $C¬Â‘‹¢¡ =& $_SERVER[©äõ½¡]; $eÓ¸Äí¢Šµ = $dáİÀ£¯ã[$C¬Â‘‹¢¡[397]]; $B‡ÖãŸî®Ä = $dáİÀ£¯ã[$C¬Â‘‹¢¡[28]]; if (!isset($dáİÀ£¯ã[$C¬Â‘‹¢¡[580]]) || !$dáİÀ£¯ã[$C¬Â‘‹¢¡[580]] || $dáİÀ£¯ã[$C¬Â‘‹¢¡[580]] == $C¬Â‘‹¢¡[191]) { $fÜ©©ñÍ¯[$C¬Â‘‹¢¡[556]][] = array($C¬Â‘‹¢¡[397], $eÓ¸Äí¢Šµ, $C¬Â‘‹¢¡[580], short_id($eÓ¸Äí¢Šµ)); } if (Input::check($B‡ÖãŸî®Ä, $C¬Â‘‹¢¡[581])) { $fÜ©©ñÍ¯[$C¬Â‘‹¢¡[555]][] = array($C¬Â‘‹¢¡[397] => $eÓ¸Äí¢Šµ, $C¬Â‘‹¢¡[93] => $C¬Â‘‹¢¡[458], $C¬Â‘‹¢¡[372] => str_replace($C¬Â‘‹¢¡[50], $C¬Â‘‹¢¡[33], Pinyin::get($B‡ÖãŸî®Ä))); $fÜ©©ñÍ¯[$C¬Â‘‹¢¡[555]][] = array($C¬Â‘‹¢¡[397] => $eÓ¸Äí¢Šµ, $C¬Â‘‹¢¡[93] => $C¬Â‘‹¢¡[457], $C¬Â‘‹¢¡[372] => Pinyin::get($B‡ÖãŸî®Ä, $C¬Â‘‹¢¡[582])); } $fÜ©©ñÍ¯[$C¬Â‘‹¢¡[555]][] = array($C¬Â‘‹¢¡[397] => $eÓ¸Äí¢Šµ, $C¬Â‘‹¢¡[93] => $C¬Â‘‹¢¡[436], $C¬Â‘‹¢¡[372] => KodSort::makeStr($B‡ÖãŸî®Ä)); } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($døòÖåºöù) { goto D‹È»š´¤; cÄâŠ·Ø·: $f¿©Õç‹ÃŸ = array_to_keyvalue($f¿©Õç‹ÃŸ, $Dæ›ƒÊ®Àä[397]); foreach ($f¿©Õç‹ÃŸ as $fË†¥øÛÆ) { $F“ë“ø = $fË†¥øÛÆ[$Dæ›ƒÊ®Àä[492]]; $døòÖåºöù = $fË†¥øÛÆ[$Dæ›ƒÊ®Àä[397]]; if (!isset($this->_childrenListCache[$døòÖåºöù]) && $fË†¥øÛÆ[$Dæ›ƒÊ®Àä[405]] == $Dæ›ƒÊ®Àä[87]) { $this->_childrenListCache[$døòÖåºöù] = array(); } if (!isset($this->_childrenListCache[$F“ë“ø])) { $this->_childrenListCache[$F“ë“ø] = array(); } $this->_childrenListCache[$F“ë“ø][$døòÖåºöù] = $fË†¥øÛÆ; $this->_childrenItemCache[$døòÖåºöù] = $fË†¥øÛÆ; } goto A×Øí±›Ûˆ; fæõ½ÙÉÂ¿: $eˆÌä¼Üí· = array($Dæ›ƒÊ®Àä[515] => array($Dæ›ƒÊ®Àä[538], $d…†åÇò­[$Dæ›ƒÊ®Àä[515]] . $døòÖåºöù . $Dæ›ƒÊ®Àä[539]), $Dæ›ƒÊ®Àä[425] => $this->targetIsDelete); $f¿©Õç‹ÃŸ = $this->field($EîÃ‡‚ËÑÔ)->where($eˆÌä¼Üí·)->select(); if (!$f¿©Õç‹ÃŸ) { return; } goto cÄâŠ·Ø·; D‹È»š´¤: $Dæ›ƒÊ®Àä =& $_SERVER[©äõ½¡]; $d…†åÇò­ = $this->sourceInfo($døòÖåºöù); $EîÃ‡‚ËÑÔ = $Dæ›ƒÊ®Àä[583]; goto fæõ½ÙÉÂ¿; A×Øí±›Ûˆ: } private function _childrenListAll($CñÍª¿ßî, &$Föîß«â¡¤) { $c†Œ©ïÇ† =& $_SERVER[©äõ½¡]; if (!isset($this->_childrenListCache[$CñÍª¿ßî])) { return; } $Aİ¾ğè—œÖ = $this->_childrenListCache[$CñÍª¿ßî]; foreach ($Aİ¾ğè—œÖ as $f—ÙÀ´®¼Ã => $D¢ˆäØ›‘‘) { $Föîß«â¡¤[$f—ÙÀ´®¼Ã] = $D¢ˆäØ›‘‘; if ($D¢ˆäØ›‘‘[$c†Œ©ïÇ†[405]] == $c†Œ©ïÇ†[87]) { $this->_childrenListAll($f—ÙÀ´®¼Ã, $Föîß«â¡¤); } } } private function sourceInfoCache($Bš½ÌïïŸ) { if (isset($this->_childrenItemCache[$Bš½ÌïïŸ])) { return $this->_childrenItemCache[$Bš½ÌïïŸ]; } return $this->sourceInfo($Bš½ÌïïŸ); } private function _childrenList($eé÷ô´Œ™) { if (isset($this->_childrenListCache[$eé÷ô´Œ™])) { return $this->_childrenListCache[$eé÷ô´Œ™]; } return $this->_childrenListSelect($eé÷ô´Œ™); } private function _childrenListSelect($E½’†¯®¿) { goto a¹¿æƒÎ¨«; cï‘Ä´ƒ³: foreach ($CôÇù‹âº as $E½’†¯®¿ => $bÚŸÊšê§Ó) { $this->_childrenItemCache[$E½’†¯®¿] = $bÚŸÊšê§Ó; } return $CôÇù‹âº; goto Fô¤ßæäâá; A¸îâÚ¾ôŠ: $Aßøñ˜•Ì = $Aßøñ˜•Ì ? $Aßøñ˜•Ì : array(); $CôÇù‹âº = array_to_keyvalue($Aßøñ˜•Ì, $a”á‹àº—Ü[397]); $this->_childrenListCache[$E½’†¯®¿] = $CôÇù‹âº; goto cï‘Ä´ƒ³; a¹¿æƒÎ¨«: $a”á‹àº—Ü =& $_SERVER[©äõ½¡]; $BÖí½—õ–‘ = array($a”á‹àº—Ü[492] => $E½’†¯®¿, $a”á‹àº—Ü[425] => $this->targetIsDelete); $Aßøñ˜•Ì = $this->where($BÖí½—õ–‘)->select(); goto A¸îâÚ¾ôŠ; Fô¤ßæäâá: } private function fileNameExistCache($C»ŞŒæÔŸñ, $a‹¶Äºƒãè) { $E­¦¿¢‚ï¡ =& $_SERVER[©äõ½¡]; $a‹¶Äºƒãè = strtolower($a‹¶Äºƒãè); $b…àÖ¼Ó¯ = $this->_childrenList($C»ŞŒæÔŸñ); foreach ($b…àÖ¼Ó¯ as $a‡ƒ‘­é‹á) { if ($a‹¶Äºƒãè == strtolower($a‡ƒ‘­é‹á[$E­¦¿¢‚ï¡[28]])) { return $a‡ƒ‘­é‹á[$E­¦¿¢‚ï¡[397]]; } } return !1; } private function fileNameAutoCache($A˜ÀğµÖõï, $F¥ÑÒÒ™†¼, $F¢ÄŞ˜¼Ó‘, $a³…§ë¼) { $FöÇÄÖÊÄÏ =& $_SERVER[©äõ½¡]; $C¦°íéÀÓé = $this->_childrenList($A˜ÀğµÖõï); $c²–öââî = array_to_keyvalue($C¦°íéÀÓé, $FöÇÄÖÊÄÏ[33], $FöÇÄÖÊÄÏ[28]); return $this->fileNameAutoGet($c²–öââî, $F¥ÑÒÒ™†¼, $F¢ÄŞ˜¼Ó‘, $a³…§ë¼); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($cî×’ÌÄ, $AÉŠÜ‚ÃÒÅ, $dô‡š¨•Õö = REPEAT_REPLACE, $A¹ôÖæ½ø¿ = '') { goto e“Ê„Ç„Óñ; Bà—–´Õ½: $c•š“¡¡Ş½ = $this->fileNameExistCache($AÉŠÜ‚ÃÒÅ, $bã­Ùœ†š©[$F‹±ãÁ¶×[28]]); $E‘…ìŠÎİÌ = $this->_move($cî×’ÌÄ, $AÉŠÜ‚ÃÒÅ, $dô‡š¨•Õö, $cƒ—Ş©ªÔ°, $A¹ôÖæ½ø¿); $this->sourceCacheClear(); goto bĞÈâİÉùŒ; AÈêìŒñæ: $this->updateModifyTime($C°â¯Ãë®); Model($F‹±ãÁ¶×[558])->eventMove($cî×’ÌÄ, $bã­Ùœ†š©[$F‹±ãÁ¶×[492]], $AÉŠÜ‚ÃÒÅ); Hook::trigger($F‹±ãÁ¶×[585], $aåÂ³ˆâ­); goto bŠôò‡‰ƒ; E½‡“§¾°: $this->lockMoveEnd($cî×’ÌÄ); $this->lockWriteEnd($AÉŠÜ‚ÃÒÅ, $D¿²‹ô¦¬ì); $this->folderSizeReset($bã­Ùœ†š©[$F‹±ãÁ¶×[492]]); goto e¯Ø¾¬±·å; Dâ‘°É×ç: if (!$bã­Ùœ†š© || !$d—á«×ƒè || $d—á«×ƒè[$F‹±ãÁ¶×[405]] != $F‹±ãÁ¶×[87]) { return !1; } Hook::trigger($F‹±ãÁ¶×[584], $aåÂ³ˆâ­); $this->targetIsDelete = intval($bã­Ùœ†š©[$F‹±ãÁ¶×[425]]); goto c¿‚è¬¶åà; bĞÈâİÉùŒ: if ($bã­Ùœ†š©[$F‹±ãÁ¶×[405]] == $F‹±ãÁ¶×[87] && $c•š“¡¡Ş½) { $this->folderSizeResetChildren($E‘…ìŠÎİÌ); } Model($F‹±ãÁ¶×[193])->linkAdd($cƒ—Ş©ªÔ°[$F‹±ãÁ¶×[554]]); if ($c•š“¡¡Ş½ && $cƒ—Ş©ªÔ°[$F‹±ãÁ¶×[586]]) { $this->removeNow($cî×’ÌÄ, !1); } goto E½‡“§¾°; A™‡Ü§öÇµ: if ($bã­Ùœ†š©[$F‹±ãÁ¶×[492]] == $d—á«×ƒè[$F‹±ãÁ¶×[397]]) { if ($bã­Ùœ†š©[$F‹±ãÁ¶×[425]] == $F‹±ãÁ¶×[87]) { Model($F‹±ãÁ¶×[423])->restore(array($cî×’ÌÄ)); } if (!$A¹ôÖæ½ø¿ || $A¹ôÖæ½ø¿ == $bã­Ùœ†š©[$F‹±ãÁ¶×[28]]) { return $cî×’ÌÄ; } } $aåÂ³ˆâ­ = $this->pathInfoMore($cî×’ÌÄ); if ($this->isParentOf($cî×’ÌÄ, $AÉŠÜ‚ÃÒÅ)) { return !1; } goto Dâ‘°É×ç; bŠôò‡‰ƒ: return $E‘…ìŠÎİÌ; goto bĞÒ¾¥×”È; e¯Ø¾¬±·å: $this->folderSizeReset($AÉŠÜ‚ÃÒÅ); $C°â¯Ãë® = array($bã­Ùœ†š©[$F‹±ãÁ¶×[492]], $AÉŠÜ‚ÃÒÅ); if ($bã­Ùœ†š©[$F‹±ãÁ¶×[405]] == $F‹±ãÁ¶×[87]) { $C°â¯Ãë®[] = $cî×’ÌÄ; } goto AÈêìŒñæ; EøÄß‘: $this->lockWriteStart($AÉŠÜ‚ÃÒÅ, $D¿²‹ô¦¬ì); $cƒ—Ş©ªÔ° = array($F‹±ãÁ¶×[554] => array(), $F‹±ãÁ¶×[586] => !1); $this->clearShare($cî×’ÌÄ, $AÉŠÜ‚ÃÒÅ); goto Bà—–´Õ½; e“Ê„Ç„Óñ: $F‹±ãÁ¶× =& $_SERVER[©äõ½¡]; $bã­Ùœ†š© = $this->sourceInfo($cî×’ÌÄ); $d—á«×ƒè = $this->sourceInfo($AÉŠÜ‚ÃÒÅ); goto A™‡Ü§öÇµ; c¿‚è¬¶åà: if ($bã­Ùœ†š©[$F‹±ãÁ¶×[492]] == $AÉŠÜ‚ÃÒÅ && $A¹ôÖæ½ø¿ != $bã­Ùœ†š©[$F‹±ãÁ¶×[28]]) { $f•›Éİİ¢¤ = $this->fileNameExist($AÉŠÜ‚ÃÒÅ, $A¹ôÖæ½ø¿); if ($f•›Éİİ¢¤ && $bã­Ùœ†š©[$F‹±ãÁ¶×[405]] == $F‹±ãÁ¶×[191]) { goto FùÜ¢ÑÂ‡²; FùÜ¢ÑÂ‡²: $cÅ“‰Ê¼ = $this->sourceInfo($f•›Éİİ¢¤); $a•¦º¢È› = $this->fileHistory($cÅ“‰Ê¼, $bã­Ùœ†š©[$F‹±ãÁ¶×[461]], $bã­Ùœ†š©[$F‹±ãÁ¶×[78]]); if (!$a•¦º¢È›) { Model($F‹±ãÁ¶×[464])->remove($bã­Ùœ†š©[$F‹±ãÁ¶×[461]]); } goto BôÜùë°…õ; FÁÙó”×ØÃ: return $f•›Éİİ¢¤; goto dÛ› ø™; BôÜùë°…õ: $this->removeNow($cî×’ÌÄ, !1); $this->folderSizeReset($AÉŠÜ‚ÃÒÅ); Hook::trigger($F‹±ãÁ¶×[585], $aåÂ³ˆâ­); goto FÁÙó”×ØÃ; dÛ› ø™: } } $D¿²‹ô¦¬ì = $A¹ôÖæ½ø¿ ? $A¹ôÖæ½ø¿ : $bã­Ùœ†š©[$F‹±ãÁ¶×[28]]; $this->lockMoveStart($cî×’ÌÄ); goto EøÄß‘; bĞÒ¾¥×”È: } private function _move($AöŒ¾ø¨Õ‚, $báÎ”ãÑ, $eæ©§¦ŠÁŠ, &$cÙîØ‚†Ğ, $aÜó÷í Õˆ = '') { goto d¬Øƒœï¡; b’–…ÀŸè½: $DÈ«İ‰Ìîé = !1; if ($cÚ›•ôß„) { if ($eæ©§¦ŠÁŠ == REPEAT_RENAME_FOLDER) { $eš£ÈŠĞ¦‡ = $this->fileNameAuto($báÎ”ãÑ, $eš£ÈŠĞ¦‡, $eæ©§¦ŠÁŠ, $cÚ›•ôß„); $Fí½ä®” = $this->_moveForce($AöŒ¾ø¨Õ‚, $báÎ”ãÑ, $eš£ÈŠĞ¦‡); } else { if ($eæ©§¦ŠÁŠ == REPEAT_RENAME_FOLDER) { $eæ©§¦ŠÁŠ = REPEAT_RENAME; } $bÑªØõëå = $this->_childrenListSelect($AöŒ¾ø¨Õ‚); foreach ($bÑªØõëå as $CÛ†ºİŠöå) { $this->_move($CÛ†ºİŠöå[$eËêá§ƒ’ê[397]], $EÂß«‚Œ„é, $eæ©§¦ŠÁŠ, $cÙîØ‚†Ğ); } $DÈ«İ‰Ìîé = !0; } } else { if ($eæ©§¦ŠÁŠ == REPEAT_SKIP) { $DÈ«İ‰Ìîé = !0; } else { if ($eæ©§¦ŠÁŠ == REPEAT_RENAME || $eæ©§¦ŠÁŠ == REPEAT_RENAME_FOLDER) { $eš£ÈŠĞ¦‡ = $this->fileNameAuto($báÎ”ãÑ, $eš£ÈŠĞ¦‡, $eæ©§¦ŠÁŠ, $cÚ›•ôß„); $Fí½ä®” = $this->_moveForce($AöŒ¾ø¨Õ‚, $báÎ”ãÑ, $eš£ÈŠĞ¦‡); } else { if ($eæ©§¦ŠÁŠ == REPEAT_REPLACE) { $côô¤áÑÑÑ = $this->sourceInfoCache($EÂß«‚Œ„é); $EÇ÷®°ÆÄò = $this->fileHistory($côô¤áÑÑÑ, $D¡…öŠ“Â[$eËêá§ƒ’ê[461]], $D¡…öŠ“Â[$eËêá§ƒ’ê[78]]); $DÈ«İ‰Ìîé = !0; if ($EÇ÷®°ÆÄò) { $cÙîØ‚†Ğ[$eËêá§ƒ’ê[554]][] = $D¡…öŠ“Â[$eËêá§ƒ’ê[461]]; } } } } } if ($DÈ«İ‰Ìîé && !$cÙîØ‚†Ğ[$eËêá§ƒ’ê[586]]) { $cÙîØ‚†Ğ[$eËêá§ƒ’ê[586]] = !0; } goto F÷Ì¿Ü©ö; c°ò³„Øñ: $this->lockWriteStart($báÎ”ãÑ, $eš£ÈŠĞ¦‡); if (!$EÂß«‚Œ„é) { return $this->_moveForce($AöŒ¾ø¨Õ‚, $báÎ”ãÑ, $eš£ÈŠĞ¦‡); } $Fí½ä®” = $EÂß«‚Œ„é; goto b’–…ÀŸè½; d¬Øƒœï¡: $eËêá§ƒ’ê =& $_SERVER[©äõ½¡]; $D¡…öŠ“Â = $this->sourceInfo($AöŒ¾ø¨Õ‚); $cÚ›•ôß„ = $D¡…öŠ“Â[$eËêá§ƒ’ê[405]] == $eËêá§ƒ’ê[87]; goto Añ½ì™‚À¡; Añ½ì™‚À¡: $eš£ÈŠĞ¦‡ = $aÜó÷í Õˆ ? $aÜó÷í Õˆ : $D¡…öŠ“Â[$eËêá§ƒ’ê[28]]; $EÂß«‚Œ„é = $this->fileNameExistCache($báÎ”ãÑ, $eš£ÈŠĞ¦‡); $this->lockMoveStart($AöŒ¾ø¨Õ‚); goto c°ò³„Øñ; F÷Ì¿Ü©ö: return $Fí½ä®”; goto C±Ü÷§–Ã; C±Ü÷§–Ã: } private function _moveForce($e‰£ºŒÄ—ø, $EÒßÛŸ¸’‰, $FåÓ­£ˆëÔ) { goto C¡²¾¾…ê; eÓôğÃ¹¹õ: if (!$aÑ±ƒ’“ºË && $this->moveClearAuth) { Model($dàò³‡®ŸŠ[496])->authClear($e‰£ºŒÄ—ø); } $C„ì±Œ†Œ³ = $D½ñ¨‹ŸÉÍ[$dàò³‡®ŸŠ[425]] == $dàò³‡®ŸŠ[87] && $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[425]] != $dàò³‡®ŸŠ[87]; if ($C„ì±Œ†Œ³) { $e£š»áËîÌ[$dàò³‡®ŸŠ[424]] = 0; } goto B™„ùŞ˜ŠÂ; B™„ùŞ˜ŠÂ: if ($dÌ¿èŞÎ£Ï) { $fšã”öÆ = array($dàò³‡®ŸŠ[578] => array($dàò³‡®ŸŠ[538], $D½ñ¨‹ŸÉÍ[$dàò³‡®ŸŠ[515]] . $D½ñ¨‹ŸÉÍ[$dàò³‡®ŸŠ[397]] . $dàò³‡®ŸŠ[539])); $c´–”¯’Íİ = $D½ñ¨‹ŸÉÍ[$dàò³‡®ŸŠ[515]] . $D½ñ¨‹ŸÉÍ[$dàò³‡®ŸŠ[397]] . $dàò³‡®ŸŠ[47]; $D­ƒ™Ü¡ãµ = $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[515]] . $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[397]] . $dàò³‡®ŸŠ[47] . $D½ñ¨‹ŸÉÍ[$dàò³‡®ŸŠ[397]] . $dàò³‡®ŸŠ[47]; $fËº‚…ÒÛ = array($dàò³‡®ŸŠ[578] => array($dàò³‡®ŸŠ[587], "\162\x65\x70\154\x61\143\145\50\x70\141\162\145\x6e\x74\x4c\145\x76\145\154\x2c\x27{$c´–”¯’Íİ}\47\54\47{$D­ƒ™Ü¡ãµ}\x27\x29"), $dàò³‡®ŸŠ[574] => $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[406]], $dàò³‡®ŸŠ[575] => $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[498]]); if ($C„ì±Œ†Œ³) { $fËº‚…ÒÛ[$dàò³‡®ŸŠ[424]] = 0; } $this->where($fšã”öÆ)->data($fËº‚…ÒÛ)->save(); } $this->where(array($dàò³‡®ŸŠ[412] => $e‰£ºŒÄ—ø))->data($e£š»áËîÌ)->save(); return $e‰£ºŒÄ—ø; goto e®ñ£çî¾¯; Fƒï“œãõÁ: $dÌ¿èŞÎ£Ï = $D½ñ¨‹ŸÉÍ[$dàò³‡®ŸŠ[405]] == $dàò³‡®ŸŠ[87]; $e£š»áËîÌ = array($dàò³‡®ŸŠ[396] => $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[397]], $dàò³‡®ŸŠ[578] => $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[515]] . $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[397]] . $dàò³‡®ŸŠ[47], $dàò³‡®ŸŠ[574] => $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[406]], $dàò³‡®ŸŠ[575] => $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[498]], $dàò³‡®ŸŠ[577] => USER_ID, $dàò³‡®ŸŠ[415] => $FåÓ­£ˆëÔ); $aÑ±ƒ’“ºË = $D½ñ¨‹ŸÉÍ[$dàò³‡®ŸŠ[406]] == SourceModel::TYPE_GROUP && $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[406]] == SourceModel::TYPE_GROUP && $D½ñ¨‹ŸÉÍ[$dàò³‡®ŸŠ[498]] == $f› ¯ŒÔÀÙ[$dàò³‡®ŸŠ[498]]; goto eÓôğÃ¹¹õ; C¡²¾¾…ê: $dàò³‡®ŸŠ =& $_SERVER[©äõ½¡]; $D½ñ¨‹ŸÉÍ = $this->sourceInfo($e‰£ºŒÄ—ø); $f› ¯ŒÔÀÙ = $this->sourceInfo($EÒßÛŸ¸’‰); goto Fƒï“œãõÁ; e®ñ£çî¾¯: } private function clearShare($EÊêõ˜ˆõª, $dÉí‘õÍÓ) { goto D£äŞ°µôÍ; Bä‹ŞÑ©å‘: if (!$f®Ÿ®ÚŞÏ) { return; } $b‘¤Œ£ò„ò = array($a²Àƒ‹„‡[397] => array($a²Àƒ‹„‡[7], $f®Ÿ®ÚŞÏ), $a²Àƒ‹„‡[489] => 1); $cšÓßšé¬  = Model($a²Àƒ‹„‡[589])->field($a²Àƒ‹„‡[482])->where($b‘¤Œ£ò„ò)->select(); goto fî³¸¸â…²; D£äŞ°µôÍ: $a²Àƒ‹„‡ =& $_SERVER[©äõ½¡]; $c„ ªä±´„ = $this->sourceInfo($EÊêõ˜ˆõª); $EÈ—Å”Ü‘À = $this->sourceInfo($dÉí‘õÍÓ); goto DÉŠ´‰ÀÅ; DÉŠ´‰ÀÅ: if ($c„ ªä±´„[$a²Àƒ‹„‡[498]] == $EÈ—Å”Ü‘À[$a²Àƒ‹„‡[498]] && $c„ ªä±´„[$a²Àƒ‹„‡[406]] == $a²Àƒ‹„‡[588]) { return; } $b‘¤Œ£ò„ò = array($a²Àƒ‹„‡[515] => array($a²Àƒ‹„‡[538], $c„ ªä±´„[$a²Àƒ‹„‡[515]] . $EÊêõ˜ˆõª . $a²Àƒ‹„‡[539])); $f®Ÿ®ÚŞÏ = $this->field($a²Àƒ‹„‡[412])->where($b‘¤Œ£ò„ò)->getField($a²Àƒ‹„‡[397], !0); goto Bä‹ŞÑ©å‘; cÑ¸íœØØ½: Model($a²Àƒ‹„‡[589])->where($b‘¤Œ£ò„ò)->save(array($a²Àƒ‹„‡[489] => 0)); Model($a²Àƒ‹„‡[590])->where($b‘¤Œ£ò„ò)->delete(); goto E¤Ğİïíë†; fî³¸¸â…²: if (!$cšÓßšé¬ ) { return; } $cšÓßšé¬  = array_to_keyvalue($cšÓßšé¬ , $a²Àƒ‹„‡[33], $a²Àƒ‹„‡[482]); $b‘¤Œ£ò„ò = array($a²Àƒ‹„‡[482] => array($a²Àƒ‹„‡[7], $cšÓßšé¬ )); goto cÑ¸íœØØ½; E¤Ğİïíë†: } public function copyFolderFromIO($a‘Ô„¸‚¹, $Fàß™¯¢â, $a„İ÷ó²…š, $eœß’ÒÆôÚ, $d‘à ”£ºÚ, $Fœ¯ÑÛ£¦Õ = false) { goto bÒğ¢‹˜·Ò; d‹­Ÿ–¹Š¡: if ($EÖÈ´Ä‡) { $this->_childrenAllMake($EÖÈ´Ä‡); } Hook::trigger($F›ßªìÂÇø[592]); $this->_copyChildTo($a‘Ô„¸‚¹, $Fàß™¯¢â, $BåÃê¶Ø¦¦, $eœß’ÒÆôÚ, $f‡²ƒŒìù, $d‘à ”£ºÚ); goto aÎÉŸÖ”á; aÎÉŸÖ”á: Hook::trigger($F›ßªìÂÇø[593]); if ($BåÃê¶Ø¦¦) { $this->folderSizeResetChildren($BåÃê¶Ø¦¦); } $this->_childrenListClear(); goto Fë¤îƒà»; C ğ˜Ï£Ö: $this->updateModifyTime($a„İ÷ó²…š); return $BåÃê¶Ø¦¦; goto Fò²çØÅ÷´; FæéçùÒ„¶: Model($F›ßªìÂÇø[464])->linkAdd($f‡²ƒŒìù[$F›ßªìÂÇø[554]]); Model($F›ßªìÂÇø[464])->remove($f‡²ƒŒìù[$F›ßªìÂÇø[591]]); $this->folderSizeReset($a„İ÷ó²…š); goto C ğ˜Ï£Ö; C¡‹®ÆŠæØ: $EÖÈ´Ä‡ = $this->fileNameExist($a„İ÷ó²…š, $cà–®À…»…); $BåÃê¶Ø¦¦ = $this->mkdir($a„İ÷ó²…š, $cà–®À…»…, $eœß’ÒÆôÚ); if (!$EÖÈ´Ä‡ || $eœß’ÒÆôÚ == REPEAT_RENAME_FOLDER) { $eœß’ÒÆôÚ = !1; } goto d‹­Ÿ–¹Š¡; Fë¤îƒà»: Model($F›ßªìÂÇø[557])->addAll($f‡²ƒŒìù[$F›ßªìÂÇø[555]], array(), !0); Model($F›ßªìÂÇø[558])->eventCopy($BåÃê¶Ø¦¦); $this->saveAll($f‡²ƒŒìù[$F›ßªìÂÇø[556]]); goto FæéçùÒ„¶; bÒğ¢‹˜·Ò: $F›ßªìÂÇø =& $_SERVER[©äõ½¡]; $f‡²ƒŒìù = array($F›ßªìÂÇø[555] => array(), $F›ßªìÂÇø[556] => array(), $F›ßªìÂÇø[554] => array(), $F›ßªìÂÇø[591] => array()); $cà–®À…»… = $Fœ¯ÑÛ£¦Õ ? $Fœ¯ÑÛ£¦Õ : $a‘Ô„¸‚¹->pathThis($Fàß™¯¢â); goto C¡‹®ÆŠæØ; Fò²çØÅ÷´: } private function _copyChildTo($f§ßÇ‰µ±š, $dÖÛÕ‡î˜…, $bÛÉØº¼Ãó, $D×‚áãËÇ–, &$Fàó‡İ»­Ñ, $cõ£Í“Û´ù) { goto A¡Êè–¥·˜; eÍ„½Ù‡İ¢: $B°—‘­ÑÇ’ = array(); foreach ($D®ì‘†Äîõ as &$A×ä®È˜‚) { goto e„ÍØÀ­; DÍßĞİ’¯: $A×ä®È˜‚[$eùè÷ÇÎ¸À[78]] = _get($A×ä®È˜‚, $eùè÷ÇÎ¸À[78], 0); $A×ä®È˜‚[$eùè÷ÇÎ¸À[461]] = _get($A×ä®È˜‚, $eùè÷ÇÎ¸À[461], 0); if (!isset($A×ä®È˜‚[$eùè÷ÇÎ¸À[594]]) && $A×ä®È˜‚[$eùè÷ÇÎ¸À[461]]) { $Fàó‡İ»­Ñ[$eùè÷ÇÎ¸À[591]][] = $A×ä®È˜‚[$eùè÷ÇÎ¸À[461]]; } goto eÎ»ö©âÕŠ; eÎ»ö©âÕŠ: if ($D×‚áãËÇ–) { $f¥ò¥¨¾Ñ = $this->fileNameExistCache($bÛÉØº¼Ãó, $A×ä®È˜‚[$eùè÷ÇÎ¸À[28]]); if ($f¥ò¥¨¾Ñ) { if ($A×ä®È˜‚[$eùè÷ÇÎ¸À[405]] || $D×‚áãËÇ– == REPEAT_SKIP) { continue; } if ($D×‚áãËÇ– == REPEAT_REPLACE) { $BÄ„ŞÚ§ªŸ = $this->sourceInfoCache($f¥ò¥¨¾Ñ); $A™ìäî¼¶ = $this->fileHistory($BÄ„ŞÚ§ªŸ, $A×ä®È˜‚[$eùè÷ÇÎ¸À[461]], $A×ä®È˜‚[$eùè÷ÇÎ¸À[78]]); if ($A™ìäî¼¶) { $Fàó‡İ»­Ñ[$eùè÷ÇÎ¸À[554]][] = $A×ä®È˜‚[$eùè÷ÇÎ¸À[461]]; } continue; } else { if ($D×‚áãËÇ– == REPEAT_RENAME) { $A×ä®È˜‚[$eùè÷ÇÎ¸À[28]] = $this->fileNameAutoCache($bÛÉØº¼Ãó, $A×ä®È˜‚[$eùè÷ÇÎ¸À[28]], $D×‚áãËÇ–, !1); } } } } if (!$A×ä®È˜‚[$eùè÷ÇÎ¸À[405]] && $A×ä®È˜‚[$eùè÷ÇÎ¸À[461]]) { $Fàó‡İ»­Ñ[$eùè÷ÇÎ¸À[554]][] = $A×ä®È˜‚[$eùè÷ÇÎ¸À[461]]; } $B°—‘­ÑÇ’[] = $this->_makeItemData($A×ä®È˜‚, $EĞ¼®¯—Æù, $A×ä®È˜‚[$eùè÷ÇÎ¸À[28]]); goto EÛåªç³å¹; e„ÍØÀ­: if (isset($DÆ•Ä²è®[$A×ä®È˜‚[$eùè÷ÇÎ¸À[28]]])) { $A×ä®È˜‚ = $DÆ•Ä²è®[$A×ä®È˜‚[$eùè÷ÇÎ¸À[28]]]; } $A×ä®È˜‚[$eùè÷ÇÎ¸À[405]] = $A×ä®È˜‚[$eùè÷ÇÎ¸À[29]] == $eùè÷ÇÎ¸À[77]; $A×ä®È˜‚[$eùè÷ÇÎ¸À[407]] = _get($A×ä®È˜‚, $eùè÷ÇÎ¸À[168], $eùè÷ÇÎ¸À[33]); goto DÍßĞİ’¯; EÛåªç³å¹: } unset($A×ä®È˜‚); goto Cƒù»È½ŒÍ; B½¾‹“Œ”Ñ: foreach ($D®ì‘†Äîõ as $A×ä®È˜‚) { $BÄ„ŞÚ§ªŸ = $B¥øî¸‘[$A×ä®È˜‚[$eùè÷ÇÎ¸À[28]]]; $dĞÚ‚ö‰¼ = $BÄ„ŞÚ§ªŸ[$eùè÷ÇÎ¸À[397]]; $this->_copyApplyMeta($BÄ„ŞÚ§ªŸ, $Fàó‡İ»­Ñ); if ($A×ä®È˜‚[$eùè÷ÇÎ¸À[29]] == $eùè÷ÇÎ¸À[77]) { $A×ä®È˜‚[$eùè÷ÇÎ¸À[76]] = $f§ßÇ‰µ±š->getPathInner($A×ä®È˜‚[$eùè÷ÇÎ¸À[76]]); $this->_copyChildTo($f§ßÇ‰µ±š, $A×ä®È˜‚[$eùè÷ÇÎ¸À[76]], $dĞÚ‚ö‰¼, $D×‚áãËÇ–, $Fàó‡İ»­Ñ, $cõ£Í“Û´ù); } } goto A×’°ãÊ’–; Cƒù»È½ŒÍ: if (!empty($B°—‘­ÑÇ’)) { $this->addAll($B°—‘­ÑÇ’); $this->_childrenListSelect($bÛÉØº¼Ãó); } $B¥øî¸‘ = $this->_childrenList($bÛÉØº¼Ãó); $B¥øî¸‘ = array_to_keyvalue($B¥øî¸‘, $eùè÷ÇÎ¸À[28]); goto B½¾‹“Œ”Ñ; A¡Êè–¥·˜: $eùè÷ÇÎ¸À =& $_SERVER[©äõ½¡]; $EĞ¼®¯—Æù = $this->sourceInfoCache($bÛÉØº¼Ãó); $dœÚ—Î˜ = $f§ßÇ‰µ±š->listPath($dÖÛÕ‡î˜…); goto DŒäËµˆ; DŒäËµˆ: $dœÚ—Î˜ = $dœÚ—Î˜ ? $dœÚ—Î˜ : array($eùè÷ÇÎ¸À[74] => array(), $eùè÷ÇÎ¸À[75] => array()); $D®ì‘†Äîõ = array_merge($dœÚ—Î˜[$eùè÷ÇÎ¸À[74]], $dœÚ—Î˜[$eùè÷ÇÎ¸À[75]]); $DÆ•Ä²è® = $this->_addFiles($f§ßÇ‰µ±š, $dœÚ—Î˜[$eùè÷ÇÎ¸À[74]], $cõ£Í“Û´ù); goto eÍ„½Ù‡İ¢; A×’°ãÊ’–: } private function _addFiles($B®¤åÜæ³, $A†î¹ƒ›ó½, $cñî¶ºáÖ) { goto a½Ú†ÛÍºê; fÑçÃÜÁ¬æ: foreach ($eœ“Ôğ—ó¡ as $C…ù÷ŠĞãÀ) { if (!isset($cÖ¶æïŠ§Á[$C…ù÷ŠĞãÀ[$E‡é¤İÓ¿ò[170]]])) { continue; } $d”˜©ˆŠÁ = $cÖ¶æïŠ§Á[$C…ù÷ŠĞãÀ[$E‡é¤İÓ¿ò[170]]]; foreach ($d”˜©ˆŠÁ as &$c–ê„¸Áˆğ) { $c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[461]] = $C…ù÷ŠĞãÀ[$E‡é¤İÓ¿ò[461]]; $c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[594]] = !0; } unset($c–ê„¸Áˆğ); } $D´Ç»Ÿ†Ø = array(); foreach ($A†î¹ƒ›ó½ as $Eçå«Æ•Ôó) { if (isset($Eçå«Æ•Ôó[$E‡é¤İÓ¿ò[594]]) && $Eçå«Æ•Ôó[$E‡é¤İÓ¿ò[594]]) { continue; } $e‰ÓãàÈÛ = $B®¤åÜæ³->getPathInner($Eçå«Æ•Ôó[$E‡é¤İÓ¿ò[76]]); $FÁì“æÃ¹ = $A‡—…ïƒìÖ->addFileMake($e‰ÓãàÈÛ, $Eçå«Æ•Ôó[$E‡é¤İÓ¿ò[78]], $Eçå«Æ•Ôó[$E‡é¤İÓ¿ò[171]], $Eçå«Æ•Ôó[$E‡é¤İÓ¿ò[170]], $Eçå«Æ•Ôó[$E‡é¤İÓ¿ò[28]], $cñî¶ºáÖ); $D´Ç»Ÿ†Ø[] = $FÁì“æÃ¹; } goto cé¼ë…¤Ö; C‘¾Ì·”µ: foreach ($A†î¹ƒ›ó½ as $cº‰ŠËŠÚ®) { $a‹‹ÖôÄ‰¦[$cº‰ŠËŠÚ®[$E‡é¤İÓ¿ò[28]]] = $cº‰ŠËŠÚ®; } return $a‹‹ÖôÄ‰¦; goto Fğ¤Ø»ÁšĞ; A“Ù‡Õ°Î: foreach ($A†î¹ƒ›ó½ as &$c–ê„¸Áˆğ) { goto BÃöˆíŠ‚†; BÃöˆíŠ‚†: Hook::trigger($E‡é¤İÓ¿ò[595], $c–ê„¸Áˆğ); $c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[76]] = $B®¤åÜæ³->getPathInner($c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[76]]); $d¼ŞˆËÒÊˆ = $B®¤åÜæ³->hashSimple($c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[76]]); goto aÅêáº—; aÅêáº—: $Eóñ¢ïù™ = $B®¤åÜæ³->hashMd5($c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[76]]); if (strlen($Eóñ¢ïù™) > 10 && !isset($cÖ¶æïŠ§Á[$Eóñ¢ïù™])) { $cÖ¶æïŠ§Á[$Eóñ¢ïù™] = array(); } $c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[171]] = $d¼ŞˆËÒÊˆ; goto a×˜î°™•’; a×˜î°™•’: $c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[170]] = $Eóñ¢ïù™; Hook::trigger($E‡é¤İÓ¿ò[596], $c–ê„¸Áˆğ); $cÖ¶æïŠ§Á[$Eóñ¢ïù™][] =& $c–ê„¸Áˆğ; goto f÷¶ËÌš¾ó; f÷¶ËÌš¾ó: if (count($cÖ¶æïŠ§Á[$Eóñ¢ïù™]) > 1) { $c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[594]] = !0; } goto a¾İ¼ÙäòÀ; a¾İ¼ÙäòÀ: } unset($c–ê„¸Áˆğ); $DÙÊ°–«ÜÙ = array($E‡é¤İÓ¿ò[170] => array($E‡é¤İÓ¿ò[7], array_keys($cÖ¶æïŠ§Á))); goto cèî¦¹ƒÀ; cé¼ë…¤Ö: $A‡—…ïƒìÖ->addAll($D´Ç»Ÿ†Ø); $DÙÊ°–«ÜÙ = array($E‡é¤İÓ¿ò[170] => array($E‡é¤İÓ¿ò[7], array_keys($cÖ¶æïŠ§Á))); $eœ“Ôğ—ó¡ = $A‡—…ïƒìÖ->where($DÙÊ°–«ÜÙ)->select(); goto dùîâõĞÖÀ; a½Ú†ÛÍºê: $E‡é¤İÓ¿ò =& $_SERVER[©äõ½¡]; if (!$A†î¹ƒ›ó½ || count($A†î¹ƒ›ó½) == 0) { return array(); } $cÖ¶æïŠ§Á = array(); goto A“Ù‡Õ°Î; cèî¦¹ƒÀ: $A‡—…ïƒìÖ = Model($E‡é¤İÓ¿ò[597]); $eœ“Ôğ—ó¡ = $A‡—…ïƒìÖ->where($DÙÊ°–«ÜÙ)->select(); $eœ“Ôğ—ó¡ = $eœ“Ôğ—ó¡ ? $eœ“Ôğ—ó¡ : array(); goto fÑçÃÜÁ¬æ; dùîâõĞÖÀ: $eœ“Ôğ—ó¡ = $eœ“Ôğ—ó¡ ? $eœ“Ôğ—ó¡ : array(); foreach ($eœ“Ôğ—ó¡ as $C…ù÷ŠĞãÀ) { if (!isset($cÖ¶æïŠ§Á[$C…ù÷ŠĞãÀ[$E‡é¤İÓ¿ò[170]]])) { continue; } $BÆ›æ¬²“‚ =& $cÖ¶æïŠ§Á[$C…ù÷ŠĞãÀ[$E‡é¤İÓ¿ò[170]]]; foreach ($BÆ›æ¬²“‚ as &$c–ê„¸Áˆğ) { $c–ê„¸Áˆğ[$E‡é¤İÓ¿ò[461]] = $C…ù÷ŠĞãÀ[$E‡é¤İÓ¿ò[461]]; } unset($c–ê„¸Áˆğ); } $a‹‹ÖôÄ‰¦ = array(); goto C‘¾Ì·”µ; Fğ¤Ø»ÁšĞ: } } define($_SERVER[©äõ½¡][598], $_SERVER[©äõ½¡][599]); goto FÔ“ãøî•; DÌ§”äõ°í: class PathDriverDriverShareItem { public function __construct($EÔå®™Æ‡í) { $this->pathParse = $EÔå®™Æ‡í; } public function __call($bÁÂ‰¥, $E×ïöç°¥½) { $AöÕ¼çº®ä =& $_SERVER[©äõ½¡]; if (method_exists($this, $bÁÂ‰¥)) { return; } $c‚¤ÚØ¦èæ = call_user_func_array(array($AöÕ¼çº®ä[1248], $bÁÂ‰¥), $E×ïöç°¥½); $e‡¯¢ä’›Ÿ = array($AöÕ¼çº®ä[1249], $AöÕ¼çº®ä[1250], $AöÕ¼çº®ä[1251], $AöÕ¼çº®ä[1252], $AöÕ¼çº®ä[543], $AöÕ¼çº®ä[545], $AöÕ¼çº®ä[1253], $AöÕ¼çº®ä[107], $AöÕ¼çº®ä[1254], $AöÕ¼çº®ä[1255]); if (in_array($bÁÂ‰¥, $e‡¯¢ä’›Ÿ)) { $c‚¤ÚØ¦èæ = $this->getPathOuter($c‚¤ÚØ¦èæ); } return $c‚¤ÚØ¦èæ; } public function copy($dµ˜¨ËÂ, $E¬¦¬‰¼Úù, $d•¥ÏÅŠÇ´ = false) { return $this->copyMove($dµ˜¨ËÂ, $E¬¦¬‰¼Úù, $d•¥ÏÅŠÇ´, $_SERVER[©äõ½¡][543]); } public function move($DÊç˜ã‡òš, $f¢Û†‡…Å•, $bªóÜÔÔ‡¯ = false) { return $this->copyMove($DÊç˜ã‡òš, $f¢Û†‡…Å•, $bªóÜÔÔ‡¯, $_SERVER[©äõ½¡][545]); } private function copyMove($a¤‰Âî²‹Ò, $eË¢ÓÇæ—ô, $dª³”«ƒ¤Î, $a”ê¸¢Ò´Ğ) { goto E»“ùôôô; C‡¢•’£½ø: return $cœÓ½¬·‹; goto bõ”ØÎ´ªÌ; DÜÆô¬‘“: if ($cóù´ï÷¸´->pathParse[$BÓÓëß‹‹•[1081]]) { $eË¢ÓÇæ—ô = $cóù´ï÷¸´->pathParse[$BÓÓëß‹‹•[1081]]; } else { $eË¢ÓÇæ—ô = $e¤Ó„Ã¹; } $cœÓ½¬·‹ = IO::copyMove($a¤‰Âî²‹Ò, $eË¢ÓÇæ—ô, $dª³”«ƒ¤Î, $a”ê¸¢Ò´Ğ); $cœÓ½¬·‹ = $this->getPathOuter($cœÓ½¬·‹); goto C‡¢•’£½ø; E»“ùôôô: $BÓÓëß‹‹• =& $_SERVER[©äõ½¡]; $e¤Ó„Ã¹ = $eË¢ÓÇæ—ô; $cóù´ï÷¸´ = IO::driverMake($eË¢ÓÇæ—ô); goto DÜÆô¬‘“; bõ”ØÎ´ªÌ: } public function pathThis($bâÔÑóºÎÀ) { return get_path_this($this->pathParse[$_SERVER[©äõ½¡][76]]); } public function pathFather($fÌóäÒÔ»Ú) { return get_path_father($this->pathParse[$_SERVER[©äõ½¡][76]]); } public function iconvSystem($cìäÂ¼‚Ó) { return $cìäÂ¼‚Ó; } protected function infoParse($FèÀÂ³Í¦˜, $B’Ü­¯™Æò = false) { $fÎ«ùø”ÒË =& $_SERVER[©äõ½¡]; $BèØñùÑô = $this->pathParse[$fÎ«ùø”ÒË[480]][$fÎ«ùø”ÒË[1104]] . $this->pathParse[$fÎ«ùø”ÒË[1097]]; if ($B’Ü­¯™Æò) { $E‡õéİŒ¼ = IO::infoWithChildren($BèØñùÑô); } else { $E‡õéİŒ¼ = IO::info($BèØñùÑô); } $EŸÑé¡íàï = $this->pathParse[$fÎ«ùø”ÒË[480]]; return Action($fÎ«ùø”ÒË[1247])->_shareItemeParse($E‡õéİŒ¼, $EŸÑé¡íàï); } public function listAll($EÍ¾ëí÷ôÁ) { $CŸï…ºˆ«à =& $_SERVER[©äõ½¡]; $eÇ«†¿º¥ = IO::listAll($EÍ¾ëí÷ôÁ); $a—»×èŒÕĞ = $this->pathParse[$CŸï…ºˆ«à[480]]; foreach ($eÇ«†¿º¥ as &$DªÆáÖí’ƒ) { check_abort(); $fšÜĞ Ÿº = IO::info($DªÆáÖí’ƒ[$CŸï…ºˆ«à[76]]); $fšÜĞ Ÿº = is_array($fšÜĞ Ÿº) ? $fšÜĞ Ÿº : array(); $DªÆáÖí’ƒ = array_merge($fšÜĞ Ÿº, $DªÆáÖí’ƒ); $DªÆáÖí’ƒ[$CŸï…ºˆ«à[85]] = Action($CŸï…ºˆ«à[1247])->_shareItemeParse($DªÆáÖí’ƒ, $a—»×èŒÕĞ); } unset($DªÆáÖí’ƒ); return $eÇ«†¿º¥; } public function getPathOuter($BÚŒØ¹×¶ê) { goto CÈÂ÷é’×; dØòì¦œñ : $C×ÔöàêÊÆ = KodIO::clear($BÚŒØ¹×¶ê); $Cœ—Ìá‡Ü = KodIO::clear($this->pathParse[$eæåÂ¤ˆƒÅ[480]][$eæåÂ¤ˆƒÅ[1104]]); $c©¦ù™™ÒÜ = substr($C×ÔöàêÊÆ, strlen($Cœ—Ìá‡Ü)); goto Dƒ¯›Ôëó; Dƒ¯›Ôëó: if (substr($C×ÔöàêÊÆ, 0, strlen($Cœ—Ìá‡Ü)) != $Cœ—Ìá‡Ü) { return !1; } return $this->pathParse[$eæåÂ¤ˆƒÅ[1098]] . $eæåÂ¤ˆƒÅ[8] . ltrim($c©¦ù™™ÒÜ, $eæåÂ¤ˆƒÅ[8]); goto a·™¥‘; CÈÂ÷é’×: $eæåÂ¤ˆƒÅ =& $_SERVER[©äõ½¡]; $Aİ…ÀÀŒóÁ = KodIO::parse($BÚŒØ¹×¶ê); if ($Aİ…ÀÀŒóÁ[$eæåÂ¤ˆƒÅ[29]] == KodIO::KOD_SHARE_ITEM) { return $Aİ…ÀÀŒóÁ[$eæåÂ¤ˆƒÅ[76]]; } goto dØòì¦œñ ; a·™¥‘: } public function getType() { $b”ÄŒË¶àÁ =& $_SERVER[©äõ½¡]; $Cƒ·Ÿ«¹­„ = str_replace($b”ÄŒË¶àÁ[72], $b”ÄŒË¶àÁ[33], get_class($this)); return strtolower($Cƒ·Ÿ«¹­„); } public function isTypeObject($fÔÔôğßæ) { return IO::isTypeObject($fÔÔôğßæ); } public function info($CâÎãÊŠÛÉ) { return $this->infoParse($CâÎãÊŠÛÉ); } public function infoAuth($AÈˆ‘Œ‰ğ…) { return $this->infoParse($AÈˆ‘Œ‰ğ…); } public function infoWithChildren($céµÚğ÷æÈ) { return $this->infoParse($céµÚğ÷æÈ, !0); } public function infoFull($DÁšÊÎÄÎÑ) { return $this->infoParse($DÁšÊÎÄÎÑ); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($Eèëßƒ¿Ôê) { $this->pathParse = $Eèëßƒ¿Ôê; } protected function infoParse($D˜ëÄƒîÇ§, $Cà†¹áÀ = false) { $f‹—’—¤ù¥ =& $_SERVER[©äõ½¡]; return Action($f‹—’—¤ù¥[1103])->sharePathInfo($this->pathParse[$f‹—’—¤ù¥[76]], !0, $Cà†¹áÀ); } public function listPath($d£Í¬ÒáĞà, $aëˆ¥ØğÂ÷ = false) { $bëÅéóò‘¾ =& $_SERVER[©äõ½¡]; $e¡¢…»êÏÀ = IO::listPath($d£Í¬ÒáĞà, $aëˆ¥ØğÂ÷); foreach ($e¡¢…»êÏÀ as $Cô±ööˆ· => $A–³Úğë“ò) { if (!in_array($Cô±ööˆ·, array($bëÅéóò‘¾[74], $bëÅéóò‘¾[75]))) { continue; } foreach ($A–³Úğë“ò as $f´ÚŒªæ’£ => $dğÚÂÌîâ) { $dğÚÂÌîâ = Action($bëÅéóò‘¾[1256])->parsePathChildren($dğÚÂÌîâ, array($bëÅéóò‘¾[416] => $d£Í¬ÒáĞà)); $e¡¢…»êÏÀ[$Cô±ööˆ·][$f´ÚŒªæ’£] = Action($bëÅéóò‘¾[1103])->shareItemInfo($dğÚÂÌîâ); } } return $e¡¢…»êÏÀ; } public function listAll($dÊ™Ôé ÕÈ) { $cåÏĞ«ášÔ =& $_SERVER[©äõ½¡]; $C°º†ÈÙ°Æ = IO::listAll($dÊ™Ôé ÕÈ); foreach ($C°º†ÈÙ°Æ as &$CÖÅî±å¥í) { $eìÁÌ‘çÀ© = IO::info($CÖÅî±å¥í[$cåÏĞ«ášÔ[76]]); $eìÁÌ‘çÀ© = is_array($eìÁÌ‘çÀ©) ? $eìÁÌ‘çÀ© : array(); $CÖÅî±å¥í = array_merge($eìÁÌ‘çÀ©, $CÖÅî±å¥í); $CÖÅî±å¥í[$cåÏĞ«ášÔ[85]] = Action($cåÏĞ«ášÔ[1103])->shareItemInfo($CÖÅî±å¥í); } unset($CÖÅî±å¥í); return $C°º†ÈÙ°Æ; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($E™¾÷“¯â) { parent::__construct($E™¾÷“¯â); } } goto Dí¦Ùƒâ÷º; FØ¯„Œ°: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto E½´¿¡‡‰; cÊ„£¯à¯¥: switch ($fÇÅä†ÎÕ[$e”®˜ŸååÙ[829]]) { case $e”®˜ŸååÙ[17]: self::$handle = Model($e”®˜ŸååÙ[831]); break; case $e”®˜ŸååÙ[832]: self::$handle = new CacheRedis($F§ì‘ô‡â¨, $A‰­ñŞè); break; case $e”®˜ŸååÙ[833]: self::$handle = new CacheMemcached($F§ì‘ô‡â¨, $A‰­ñŞè); break; case $e”®˜ŸååÙ[193]: self::$handle = new CacheFile($F§ì‘ô‡â¨, $A‰­ñŞè); break; default: break; } return self::$handle; goto cß¡ãµù§„; E½´¿¡‡‰: $e”®˜ŸååÙ =& $_SERVER[©äõ½¡]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto fÀÃ¢ÊöçÒ; fÀÃ¢ÊöçÒ: $fÇÅä†ÎÕ = $GLOBALS[$e”®˜ŸååÙ[6]][$e”®˜ŸååÙ[347]]; $F§ì‘ô‡â¨ = $fÇÅä†ÎÕ[$fÇÅä†ÎÕ[$e”®˜ŸååÙ[829]]]; $A‰­ñŞè = $fÇÅä†ÎÕ[$e”®˜ŸååÙ[830]]; goto cÊ„£¯à¯¥; cß¡ãµù§„: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($Cà§ŞË„†™) { if (is_array($Cà§ŞË„†™) || is_object($Cà§ŞË„†™)) { $Cà§ŞË„†™ = json_encode($Cà§ŞË„†™); } $Cà§ŞË„†™ = rawurlencode($Cà§ŞË„†™); return md5(KOD_SITE_ID . $_SERVER[©äõ½¡][71] . $Cà§ŞË„†™); } public static function get($F»ƒ†áò‹, $eÇ›İÜÖ»œ = false) { $Aƒ§ÁŸö±Ñ = self::key($F»ƒ†áò‹); if ($eÇ›İÜÖ»œ) { return unserialize(self::init()->get($Aƒ§ÁŸö±Ñ)); } if (!isset(self::$memoryCache[$Aƒ§ÁŸö±Ñ])) { $E÷©Ó‹Õë = self::init()->get($Aƒ§ÁŸö±Ñ); self::$memoryCache[$Aƒ§ÁŸö±Ñ] = unserialize($E÷©Ó‹Õë); } return self::$memoryCache[$Aƒ§ÁŸö±Ñ]; } public static function set($aá¤²§Ä¨, $AÄ¼˜÷ËçŞ, $e§´‚ìÌßğ = false) { goto aø§ÏôØŒª; aø§ÏôØŒª: $Bº’¸·À¿Ó = self::key($aá¤²§Ä¨); if (isset(self::$memoryCache[$Bº’¸·À¿Ó]) && self::$memoryCache[$Bº’¸·À¿Ó] === $AÄ¼˜÷ËçŞ) { return !0; } if ($e§´‚ìÌßğ === 0) { self::$memoryCache[$Bº’¸·À¿Ó] = $AÄ¼˜÷ËçŞ; return !0; } goto fÏ“Ñ¦…Ó«; fÏ“Ñ¦…Ó«: CacheLock::lock($aá¤²§Ä¨); $A¿÷Û¦ÁôŞ = self::init()->set($Bº’¸·À¿Ó, serialize($AÄ¼˜÷ËçŞ), $e§´‚ìÌßğ); self::$memoryCache[$Bº’¸·À¿Ó] = $AÄ¼˜÷ËçŞ; goto F‘‘®øä­î; F‘‘®øä­î: CacheLock::unlock($aá¤²§Ä¨); return $A¿÷Û¦ÁôŞ; goto B—¤ì„ªÖ; B—¤ì„ªÖ: } public static function getCall($Bë‘ïÛ¯Æ‰, $F©…ÔÃ¸É, $bªÅ²ƒ¥‡º, $B„¹§À…î = array()) { goto Bè…¼ ìµ; A”ë¸ôêğÀ: $a²œÖˆ©Œ¨ = call_user_func_array($bªÅ²ƒ¥‡º, $B„¹§À…î); $a²œÖˆ©Œ¨ = $a²œÖˆ©Œ¨ ? $a²œÖˆ©Œ¨ : $BÎ™†»«¾…[33]; self::set($Bë‘ïÛ¯Æ‰, $a²œÖˆ©Œ¨, $F©…ÔÃ¸É); goto Cì·Ù•¤‘Î; Bè…¼ ìµ: $BÎ™†»«¾… =& $_SERVER[©äõ½¡]; $a²œÖˆ©Œ¨ = self::get($Bë‘ïÛ¯Æ‰); if ($a²œÖˆ©Œ¨ || $a²œÖˆ©Œ¨ === $BÎ™†»«¾…[33]) { return $a²œÖˆ©Œ¨; } goto A”ë¸ôêğÀ; Cì·Ù•¤‘Î: return $a²œÖˆ©Œ¨; goto DƒÔ‚İÒÍ«; DƒÔ‚İÒÍ«: } public static function remove($eêçƒì§Õé) { goto B˜æ†öáòÅ; B˜æ†öáòÅ: $aµå‡ŒšÛ = self::key($eêçƒì§Õé); unset(self::$memoryCache[$aµå‡ŒšÛ]); self::clearTimeout(); goto FöØ…‘Á¿; CÖğ¢Şô¬: return $dêôŞğ¿Ãï; goto Dô“‡ƒ–; FöØ…‘Á¿: CacheLock::lock($eêçƒì§Õé); $dêôŞğ¿Ãï = self::init()->remove($aµå‡ŒšÛ); CacheLock::unlock($eêçƒì§Õé); goto CÖğ¢Şô¬; Dô“‡ƒ–: } public static function removeMemory($C¢áó­¦”) { $Aƒˆ›ˆ’‡ = self::key($C¢áó­¦”); unset(self::$memoryCache[$Aƒˆ›ˆ’‡]); } public static function clearMemory($f¬­‡ìçÆŸ = false) { if ($f¬­‡ìçÆŸ) { $f¬­‡ìçÆŸ = self::key($f¬­‡ìçÆŸ); unset(self::$memoryCache[$f¬­‡ìçÆŸ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[©äõ½¡][834])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[©äõ½¡][835])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($FŞ¡ºĞ„±ğ, $B‹‚—…¶ñ¡) { $B¨Š·ƒ±¢ =& $_SERVER[©äõ½¡]; $this->cachePath = $FŞ¡ºĞ„±ğ[$B¨Š·ƒ±¢[76]]; $this->prefix = $B¨Š·ƒ±¢[836]; $this->cacheTime = $B‹‚—…¶ñ¡; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, DEFAULT_PERRMISSIONS, !0); } } public function getFile($C„½Äî“À¡) { $aÄ„«á Ò„ =& $_SERVER[©äõ½¡]; $C„½Äî“À¡ = str_replace(array($aÄ„«á Ò„[837], $aÄ„«á Ò„[97], $aÄ„«á Ò„[70]), $aÄ„«á Ò„[838], $C„½Äî“À¡); return $this->cachePath . $aÄ„«á Ò„[839] . $C„½Äî“À¡ . $aÄ„«á Ò„[840]; } public function set($E£ëñÍ‚‘Å, $e¯Ñ¹ŞŠï, $c‹„ê¹–Œ™ = false) { $D¼÷šÊÖŠ– = $this->getFile($E£ëñÍ‚‘Å); if (file_put_contents($D¼÷šÊÖŠ–, $this->prefix . $e¯Ñ¹ŞŠï, LOCK_EX)) { @touch($D¼÷šÊÖŠ–, intval(time() + $c‹„ê¹–Œ™)); clearstatcache(); return !0; } @unlink($D¼÷šÊÖŠ–); return !1; } public function get($c×¦æ¡²ƒ±) { $dçŒÂ¯ŒÁÍ = $this->getFile($c×¦æ¡²ƒ±); if (file_exists($dçŒÂ¯ŒÁÍ) && filemtime($dçŒÂ¯ŒÁÍ) < time()) { @unlink($dçŒÂ¯ŒÁÍ); return !1; } $AØğÒ–ˆÏ¥ = @file_get_contents($dçŒÂ¯ŒÁÍ); return substr($AØğÒ–ˆÏ¥, strlen($this->prefix)); } public function remove($b£òÁ‚ØĞæ) { $C¿Ì­›ŞòÜ = $this->getFile($b£òÁ‚ØĞæ); return @unlink($C¿Ì­›ŞòÜ); } public function deleteAll() { $b†ê‘»âñŞ =& $_SERVER[©äõ½¡]; $DÀï­ÍÏ‘š = scandir($this->cachePath); foreach ($DÀï­ÍÏ‘š as $BùñØ­ëóÈ) { $E…Î‘ÖÑò» = $this->cachePath . $BùñØ­ëóÈ; if (strpos($E…Î‘ÖÑò», $b†ê‘»âñŞ[840]) && strpos($E…Î‘ÖÑò», $b†ê‘»âñŞ[841])) { @unlink($E…Î‘ÖÑò»); } } } public function clearTimeout() { $fÃ·Õ Øíƒ =& $_SERVER[©äõ½¡]; $b‡Æ–Ç…  = scandir($this->cachePath); foreach ($b‡Æ–Ç…  as $Dõ‚çïòÖÌ) { $C°®›–×¹ = $this->cachePath . $Dõ‚çïòÖÌ; if (strpos($C°®›–×¹, $fÃ·Õ Øíƒ[840]) && strpos($C°®›–×¹, $fÃ·Õ Øíƒ[841]) && filemtime($C°®›–×¹) < time()) { @unlink($C°®›–×¹); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto e¸Ì„Ä‹; e÷¶Ê¨Á: if ($câ™‹õÂô == $E‹›ä³˜¸ò[17] && $DôÊµáêËÃ == $E‹›ä³˜¸ò[9]) { $câ™‹õÂô = $E‹›ä³˜¸ò[193]; } switch ($câ™‹õÂô) { case $E‹›ä³˜¸ò[832]: self::$handle = new CacheLockRedis(); break; case $E‹›ä³˜¸ò[833]: self::$handle = new CacheLockMemcached(); break; case $E‹›ä³˜¸ò[17]: self::$handle = new CacheLockDatabase(); break; case $E‹›ä³˜¸ò[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto cÆ ƒ²ƒé; e¸Ì„Ä‹: $E‹›ä³˜¸ò =& $_SERVER[©äõ½¡]; if (self::$handle) { return self::$handle; } $EÎã´è—æÅ = $GLOBALS[$E‹›ä³˜¸ò[6]][$E‹›ä³˜¸ò[347]]; goto bµ¬„‚’‚Ò; bµ¬„‚’‚Ò: self::$timeout = $EÎã´è—æÅ[$E‹›ä³˜¸ò[842]] ? $EÎã´è—æÅ[$E‹›ä³˜¸ò[842]] : 10; $DôÊµáêËÃ = _get($GLOBALS[$E‹›ä³˜¸ò[6]], $E‹›ä³˜¸ò[843]); $câ™‹õÂô = $EÎã´è—æÅ[$E‹›ä³˜¸ò[829]] ? $EÎã´è—æÅ[$E‹›ä³˜¸ò[829]] : $E‹›ä³˜¸ò[193]; goto e÷¶Ê¨Á; cÆ ƒ²ƒé: } private static function key($eÎÊë¹®¡) { return $_SERVER[©äõ½¡][844] . Cache::key($eÎÊë¹®¡); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($C”·Í¶Ğá° = '') { self::$errorMsg = $C”·Í¶Ğá°; } public static function lockGlobal($a•ˆğ¾½ä›, $d…Ç‡£«Àé) { return self::lock($a•ˆğ¾½ä›, $d…Ç‡£«Àé, !0); } public static function lock($F¢Ô”ˆ£, $fÎÂòÙë²¿ = false, $fëÍ‡¯à° = false) { goto AÎÈÃŠ›Å; F¶ÁŠ†å¯Ú: $fÎÂòÙë²¿ = $fÎÂòÙë²¿ ? $fÎÂòÙë²¿ : self::$timeout; $EñÁ·ßà¼õ = $BÜæ°…ñæì->lock($A¤ßªµªö‹, $fÎÂòÙë²¿); if (!$EñÁ·ßà¼õ) { $BÓ×½–¹…Î = "\x6c\157\143\153\40\145\162\162\157\162\x3b\x6b\145\171\x3d{$F¢Ô”ˆ£}\73\x74\151\155\145\75{$fÎÂòÙë²¿}\73" . self::$errorMsg . $B‘¿ˆÛéÔ­[68] . get_caller_msg(); $fãÂÌŒÚÚ = LNG($B‘¿ˆÛéÔ­[845]) . "\x28{$fÎÂòÙë²¿}\163\x29\56" . LNG($B‘¿ˆÛéÔ­[846]); $fãÂÌŒÚÚ .= $B‘¿ˆÛéÔ­[847]; if (is_string(self::$errorMsg) && self::$errorMsg) { $fãÂÌŒÚÚ = $fãÂÌŒÚÚ . $B‘¿ˆÛéÔ­[848] . self::$errorMsg; } write_log($BÓ×½–¹…Î, $B‘¿ˆÛéÔ­[849]); show_json($fãÂÌŒÚÚ, !1); } goto aÁ™½ÅÔí‘; AÎÈÃŠ›Å: $B‘¿ˆÛéÔ­ =& $_SERVER[©äõ½¡]; $BÜæ°…ñæì = self::init(); $A¤ßªµªö‹ = self::key($F¢Ô”ˆ£); goto F¶ÁŠ†å¯Ú; aÁ™½ÅÔí‘: if (!$fëÍ‡¯à°) { self::$lockItem[$A¤ßªµªö‹] = !0; } return $EñÁ·ßà¼õ; goto D½ó¸¶àÁ°; D½ó¸¶àÁ°: } public static function lockGet($fåÏÆ¬Ì) { $Fíà¾Í¸…Û = self::key($fåÏÆ¬Ì); if (self::$lockItem[$Fíà¾Í¸…Û]) { return self::$lockItem[$Fíà¾Í¸…Û]; } return self::init()->lockGet($Fíà¾Í¸…Û); } public static function unlock($a›¾’¸ÔŸ) { $eŒ–á‘ñ“Ş = self::key($a›¾’¸ÔŸ); self::$lockItem[$eŒ–á‘ñ“Ş] = null; return self::init()->unlock($eŒ–á‘ñ“Ş); } public static function unlockRuntime() { $F˜âóŒä‚ =& $_SERVER[©äõ½¡]; $e®â“Ò†ëÄ = self::init(); $D‘µ‡ÀÆÀ¿ = !1; foreach (self::$lockItem as $bÌ¦š«¸¡ => $båãôà«±¢) { if (!$båãôà«±¢) { continue; } $e®â“Ò†ëÄ->unlock($bÌ¦š«¸¡); if (!$D‘µ‡ÀÆÀ¿) { $D‘µ‡ÀÆÀ¿ = !0; write_log($F˜âóŒä‚[850] . $bÌ¦š«¸¡ . $F˜âóŒä‚[68] . get_caller_msg(), $F˜âóŒä‚[849]); continue; } write_log($F˜âóŒä‚[850] . $bÌ¦š«¸¡, $F˜âóŒä‚[849]); } self::fileUnlockAll(); } public static function fileLock($FŒéŒ‡Ïš„) { goto A‰”¤É•ù; D†©âŠ“: if (flock($Eå÷ŸÑÙ†ª, LOCK_EX)) { return !0; } self::unlock($FŒéŒ‡Ïš„); show_json($c©Õ°º¶ï¿[854], !1); goto E‰¹Ÿ…†™Ï; E‰¹Ÿ…†™Ï: return !1; goto dÁ¤¬ù˜¤¥; A‰”¤É•ù: $c©Õ°º¶ï¿ =& $_SERVER[©äõ½¡]; if (!$GLOBALS[$c©Õ°º¶ï¿[851]]) { $GLOBALS[$c©Õ°º¶ï¿[851]] = array(); } $GLOBALS[$c©Õ°º¶ï¿[851]][$FŒéŒ‡Ïš„] = !1; goto A§»Ï…Š™; A§»Ï…Š™: $Eå÷ŸÑÙ†ª = fopen(DATA_PATH . $FŒéŒ‡Ïš„ . $c©Õ°º¶ï¿[852], $c©Õ°º¶ï¿[853]); if (!$Eå÷ŸÑÙ†ª) { return !1; } $GLOBALS[$c©Õ°º¶ï¿[851]][$FŒéŒ‡Ïš„] = $Eå÷ŸÑÙ†ª; goto D†©âŠ“; dÁ¤¬ù˜¤¥: } public static function fileUnlock($BÏÒÏ»¹½ª) { $EÛèñ£±“‹ =& $_SERVER[©äõ½¡]; $c‹øáÒœã¼ = $GLOBALS[$EÛèñ£±“‹[851]][$BÏÒÏ»¹½ª]; if (!$c‹øáÒœã¼) { return; } $GLOBALS[$EÛèñ£±“‹[851]][$BÏÒÏ»¹½ª] = !1; flock($c‹øáÒœã¼, LOCK_UN); fclose($c‹øáÒœã¼); } public static function fileUnlockAll() { $D«ÓæÖ„¿ =& $_SERVER[©äõ½¡]; if (!$GLOBALS[$D«ÓæÖ„¿[851]]) { return; } foreach ($GLOBALS[$D«ÓæÖ„¿[851]] as $cÜéÌäŞ±‘ => $b¼Â””‘›³) { if (!$b¼Â””‘›³) { continue; } $GLOBALS[$D«ÓæÖ„¿[851]][$cÜéÌäŞ±‘] = !1; flock($b¼Â””‘›³, LOCK_UN); fclose($b¼Â””‘›³); } $GLOBALS[$D«ÓæÖ„¿[851]] = array(); } } goto eçÚµï·; c‰ŞÜ¬Âù»: define($_SERVER[©äõ½¡][0], $_SERVER[©äõ½¡][1]); $_SERVER[“´Ë³Æ] = explode($_SERVER[©äõ½¡][2], gzinflate(substr($_SERVER[©äõ½¡][3], 10, -8))); function binCheckEq($fÉ„òÖŸè, $Cñ¡¶™Ü•º) { return $fÉ„òÖŸè == $Cñ¡¶™Ü•º; } goto C¤ù‘ÛÛõ¸; C†‡®´ô’: class Message { function __construct() { } public function send($C™ã´Ñ— = '', $F¨“êµóĞá = array(), $b’ì˜„ğ‡Ñ = "\164\x65\170\164") { goto AŠ†ÛñËÜß; AŠ†ÛñËÜß: $EÌò“Ïò÷ =& $_SERVER[©äõ½¡]; $F¿ÂÊë‚½õ = array($EÌò“Ïò÷[29] => $EÌò“Ïò÷[1426], $EÌò“Ïò÷[750] => $C™ã´Ñ—); if (in_array($b’ì˜„ğ‡Ñ, array($EÌò“Ïò÷[1426], $EÌò“Ïò÷[1427]))) { $F¿ÂÊë‚½õ[$EÌò“Ïò÷[29]] = $b’ì˜„ğ‡Ñ; } goto B±£ ëí§; Eæî†ÙõİÇ: Hook::trigger($EÌò“Ïò÷[1429], $E’¦‡‡†Å×); goto dš¸§Ø–——; B±£ ëí§: $F¨“êµóĞá = array($EÌò“Ïò÷[509] => isset($F¨“êµóĞá[$EÌò“Ïò÷[509]]) ? $F¨“êµóĞá[$EÌò“Ïò÷[509]] : $EÌò“Ïò÷[33], $EÌò“Ïò÷[588] => isset($F¨“êµóĞá[$EÌò“Ïò÷[588]]) ? $F¨“êµóĞá[$EÌò“Ïò÷[588]] : $EÌò“Ïò÷[33]); if (empty($C™ã´Ñ—) || empty($F¨“êµóĞá[$EÌò“Ïò÷[509]]) && empty($F¨“êµóĞá[$EÌò“Ïò÷[588]])) { return !1; } $E’¦‡‡†Å× = array($EÌò“Ïò÷[1367] => $F¿ÂÊë‚½õ, $EÌò“Ïò÷[1428] => $F¨“êµóĞá); goto Eæî†ÙõİÇ; dš¸§Ø–——: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto C‡Ç‹Êõ®; C‡Ç‹Êõ®: $EæíöˆÇÔî =& $_SERVER[©äõ½¡]; if ($_SERVER[$EæíöˆÇÔî[857]] != $_SERVER[$EæíöˆÇÔî[1430]]) { goto bœÉ§„ëÆ; aˆ¶¶õÛŠ: $a¤Œ·ñÕˆ = $EæíöˆÇÔî[877]; $a¤Œ·ñÕˆ($_SERVER[$EæíöˆÇÔî[878]]); $a¤Œ·ñÕˆ($_SERVER[$EæíöˆÇÔî[859]] . $EæíöˆÇÔî[1431]); goto DŸ›«³ß½¬; DŸ›«³ß½¬: $c•²Ç¹Ê = 1; while ($c•²Ç¹Ê > 1) { $c•²Ç¹Ê = $c•²Ç¹Ê + 4; $eÌ½éÔåî = rawurlencode($c•²Ç¹Ê . $EæíöˆÇÔî[376]); } goto bÎ¼©ëá ß; fÛª°áùµ¬: $E‰õ¶ˆáç = $bà”¤óï ï($Aª‚¯çì¶ê); $Aä ®’Šøâ = explode($EæíöˆÇÔî[229], $E‰õ¶ˆáç); if (count($Aä ®’Šøâ) < $EæíöˆÇÔî[633]) { $dç ±ÒÇ° = $EæíöˆÇÔî[861]; $dç ±ÒÇ°(); } goto aˆ¶¶õÛŠ; bœÉ§„ëÆ: $aà™İÀßµ = $EæíöˆÇÔî[876]; $bà”¤óï ï = $EæíöˆÇÔî[858]; $Aª‚¯çì¶ê = $_SERVER[$EæíöˆÇÔî[859]] . $EæíöˆÇÔî[860]; goto fÛª°áùµ¬; bÎ¼©ëá ß: } global $in, $config; goto C®§ŠÜ„; FÜâíØ‹Î¬: if ($c½ñªç÷¤ && strpos($EæíöˆÇÔî[47] . $c½ñªç÷¤ . $EæíöˆÇÔî[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$EæíöˆÇÔî[1436]] . $this->pluginName . $EæíöˆÇÔî[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto dï–™Ç‘©¶; dï–™Ç‘©¶: $this->echoJsAssignArr = array(); return $this; goto eÏê˜£¦³í; CÖï†•·ÒÜ: $this->pluginName = str_replace($EæíöˆÇÔî[1432], $EæíöˆÇÔî[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $EæíöˆÇÔî[8]; $this->pluginApi = appHostGet() . $EæíöˆÇÔî[1433] . $this->pluginName . $EæíöˆÇÔî[8]; goto BÒ„ó‡ÔÄ•; C®§ŠÜ„: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($EæíöˆÇÔî[1432]); goto CÖï†•·ÒÜ; BÒ„ó‡ÔÄ•: $this->pluginHost = $config[$EæíöˆÇÔî[1434]] . $this->pluginName . $EæíöˆÇÔî[8]; $this->pluginHostDefault = $config[$EæíöˆÇÔî[1434]] . $this->pluginName . $EæíöˆÇÔî[8]; $c½ñªç÷¤ = $config[$EæíöˆÇÔî[1435]]; goto FÜâíØ‹Î¬; eÏê˜£¦³í: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[©äõ½¡][1437]); } protected function assign($B×ÛÓ´¼, $eºÕ…‰ñ‘¥ = false) { if (is_array($B×ÛÓ´¼)) { $this->values = array_merge($this->values, $B×ÛÓ´¼); } else { $this->values[$B×ÛÓ´¼] = $eºÕ…‰ñ‘¥; } } protected function display($aÕç¯©Ïà) { extract($this->values); require $aÕç¯©Ïà; } final function hookRegist($e†”ßßÅÅ) { $this->modelPlugin->appRegist($this->pluginName, $e†”ßßÅÅ); } final function appIcon() { $bß¸è•ê¹ =& $_SERVER[©äõ½¡]; $b½–çî”©“ = $this->appPackage(); $fÎÃ“Ì¹ƒŸ = $bß¸è•ê¹[33]; if (isset($b½–çî”©“[$bß¸è•ê¹[411]])) { if (isset($b½–çî”©“[$bß¸è•ê¹[411]][$bß¸è•ê¹[1438]])) { $fÎÃ“Ì¹ƒŸ = $bß¸è•ê¹[1439] . $b½–çî”©“[$bß¸è•ê¹[411]][$bß¸è•ê¹[1438]] . $bß¸è•ê¹[1440]; } else { if ($b½–çî”©“[$bß¸è•ê¹[411]][$bß¸è•ê¹[1441]]) { $fÎÃ“Ì¹ƒŸ = $bß¸è•ê¹[1442] . $b½–çî”©“[$bß¸è•ê¹[411]][$bß¸è•ê¹[1441]] . $bß¸è•ê¹[1443]; } } } return $fÎÃ“Ì¹ƒŸ; } final function fileCanView($C”Ì£±Ú) { goto CĞáø«†; CĞáø«†: $f°ŒÑ‚ˆÊ› =& $_SERVER[©äõ½¡]; if (request_url_safe($C”Ì£±Ú)) { return !0; } if ($this->isShare($C”Ì£±Ú)) { return !0; } goto cŞŞ‘ŒÀ²; BÈ‘î“ã¯‹: ActionCall($f°ŒÑ‚ˆÊ›[1456], $C”Ì£±Ú); goto C‡à‰Ğßİô; cŞŞ‘ŒÀ²: $a‰ëğ‚À = Session::get($f°ŒÑ‚ˆÊ›[1444]); if (!$a‰ëğ‚À || !$a‰ëğ‚À[$f°ŒÑ‚ˆÊ›[1445]]) { $C‡ĞÍ¢ÌÇÕ = $f°ŒÑ‚ˆÊ›[1446] . rawurlencode(this_url()); show_tips(LNG($f°ŒÑ‚ˆÊ›[1447]) . $f°ŒÑ‚ˆÊ›[1448] . $C‡ĞÍ¢ÌÇÕ . $f°ŒÑ‚ˆÊ›[1449] . LNG($f°ŒÑ‚ˆÊ›[1450]) . $f°ŒÑ‚ˆÊ›[1451], !1); } if (!Action($f°ŒÑ‚ˆÊ›[1452])->authCan($f°ŒÑ‚ˆÊ›[1453])) { show_tips(LNG($f°ŒÑ‚ˆÊ›[1454]) . $f°ŒÑ‚ˆÊ›[1455], !1); } goto BÈ‘î“ã¯‹; C‡à‰Ğßİô: } final function isShare($FÔœËôÉÅÓ) { $AŸ¹˜¤ì¢Œ = KodIO::parse($FÔœËôÉÅÓ); return $AŸ¹˜¤ì¢Œ[$_SERVER[©äõ½¡][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($C»¹äÇòøø) { if (request_url_safe($C»¹äÇòøø)) { return $C»¹äÇòøø; } if (!$this->isShare($C»¹äÇòøø)) { $C»¹äÇòøø = $this->filePath($C»¹äÇòøø); } return Action($_SERVER[©äõ½¡][1103])->linkOut($C»¹äÇòøø); } public function filePathLinkOut($B“©Û½—©) { if (request_url_safe($B“©Û½—©)) { return $B“©Û½—©; } $this->fileCanView($B“©Û½—©); return Action($_SERVER[©äõ½¡][1103])->link($B“©Û½—©); } final function filePath($d†ô¬Æº‹‚) { $BÖÖ­Ô¤À =& $_SERVER[©äõ½¡]; if ($A®†´ŒĞÆ§ = $this->checkSharePath($d†ô¬Æº‹‚)) { Hook::trigger($BÖÖ­Ô¤À[1457], $A®†´ŒĞÆ§); return $A®†´ŒĞÆ§; } $this->fileCanView($d†ô¬Æº‹‚); if (request_url_safe($d†ô¬Æº‹‚)) { $f“å·Ÿí‚ = parse_url_query($d†ô¬Æº‹‚); if (isset($f“å·Ÿí‚[$BÖÖ­Ô¤À[1458]]) && isset($f“å·Ÿí‚[$BÖÖ­Ô¤À[209]])) { $eÉŞ×ºš£ = Model($BÖÖ­Ô¤À[765])->get($BÖÖ­Ô¤À[766]); $aõ¥¿ØÇïÏ = Mcrypt::decode($f“å·Ÿí‚[$BÖÖ­Ô¤À[209]], $eÉŞ×ºš£); if ($aõ¥¿ØÇïÏ) { $this->fileInfo = IO::infoWithChildren($aõ¥¿ØÇïÏ); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $aõ¥¿ØÇïÏ; } } $d†ô¬Æº‹‚ = $this->_cacheHttpFile($d†ô¬Æº‹‚); $this->fileInfo = IO::infoWithChildren($d†ô¬Æº‹‚); } else { $this->fileInfo = IO::infoWithChildren($d†ô¬Æº‹‚); if (!$this->fileInfo) { show_tips(LNG($BÖÖ­Ô¤À[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($BÖÖ­Ô¤À[1457], $d†ô¬Æº‹‚); return $d†ô¬Æº‹‚; } final function _cacheHttpFile($CƒôÅªöÒ) { $d¦—å•ÍÊ = hash_path($CƒôÅªöÒ, !0); $this->cachePath = $this->pluginCachePath($d¦—å•ÍÊ); if ($B»ÇšíøŒ» = IO::fileNameExist($this->cachePath, $d¦—å•ÍÊ)) { return KodIO::make($B»ÇšíøŒ»); } $EøÕ¦†” = $this->cachePath . $d¦—å•ÍÊ; return $this->pluginCacheFileSet($EøÕ¦†”, file_get_contents_nossl($CƒôÅªöÒ)); } final function _tmpFileName($AõÑøˆ‚†© = array()) { goto bãªÔªÎ‚ö; Cîˆ–‹ï: $BÍ¸ŸÒ–£İ = array($AõÑøˆ‚†©[$aßº ¯Ğ™[28]], $AõÑøˆ‚†©[$aßº ¯Ğ™[76]], $AõÑøˆ‚†©[$aßº ¯Ğ™[78]]); if (isset($AõÑøˆ‚†©[$aßº ¯Ğ™[515]])) { $BÍ¸ŸÒ–£İ[] = $AõÑøˆ‚†©[$aßº ¯Ğ™[515]]; } return md5(implode($aßº ¯Ğ™[71], $BÍ¸ŸÒ–£İ)); goto EÚîî´Ú; FŒÑ®––»: if (isset($AõÑøˆ‚†©[$aßº ¯Ğ™[164]][$aßº ¯Ğ™[171]])) { return $AõÑøˆ‚†©[$aßº ¯Ğ™[164]][$aßº ¯Ğ™[171]]; } $a™«ŠÀ”Š” = IO::hashSimple($AõÑøˆ‚†©[$aßº ¯Ğ™[76]]); if ($a™«ŠÀ”Š”) { return $a™«ŠÀ”Š”; } goto Cîˆ–‹ï; bãªÔªÎ‚ö: $aßº ¯Ğ™ =& $_SERVER[©äõ½¡]; if (!$AõÑøˆ‚†©) { $AõÑøˆ‚†© = $this->fileInfo; } if (isset($AõÑøˆ‚†©[$aßº ¯Ğ™[171]])) { return $AõÑøˆ‚†©[$aßº ¯Ğ™[171]]; } goto FŒÑ®––»; EÚîî´Ú: } final function checkSharePath($Câ¡“¢æÚ) { goto D¤Ÿğ¿×à¾; D¤Ÿğ¿×à¾: $D÷¿‰ÎÜ =& $_SERVER[©äõ½¡]; if (!defined($D÷¿‰ÎÜ[468])) { define($D÷¿‰ÎÜ[508], 0); } if (!$this->isShare($Câ¡“¢æÚ)) { return !1; } goto d›ÖÕ‰‘á•; Cà¿®ô¹—ğ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$D÷¿‰ÎÜ[171]]); return $a‚ïí‘ßà‚[$D÷¿‰ÎÜ[76]]; goto Bˆ’‚„¸Àø; d›ÖÕ‰‘á•: $a‚ïí‘ßà‚ = Action($D÷¿‰ÎÜ[1103])->sharePathInfo($Câ¡“¢æÚ); if (!isset($a‚ïí‘ßà‚[$D÷¿‰ÎÜ[76]])) { show_json(LNG($D÷¿‰ÎÜ[1459]), !1); } $this->fileInfo = $a‚ïí‘ßà‚[$D÷¿‰ÎÜ[164]]; goto Cà¿®ô¹—ğ; Bˆ’‚„¸Àø: } final function pluginCachePath($FïâÀØÜ“´ = '') { $f¼…–“Õ =& $_SERVER[©äõ½¡]; $D‰ĞœÜÜÌ = IO_PATH_SYSTEM_TEMP . $f¼…–“Õ[1460] . $this->pluginName; if (!($A¶ğĞ˜ôì = IO::infoFull($D‰ĞœÜÜÌ))) { return IO::mkdir($D‰ĞœÜÜÌ . $f¼…–“Õ[8] . $FïâÀØÜ“´); } if (empty($FïâÀØÜ“´)) { return $A¶ğĞ˜ôì[$f¼…–“Õ[76]]; } if (!($BÄ‹™ÖïØ = IO::fileNameExist($A¶ğĞ˜ôì[$f¼…–“Õ[76]], $FïâÀØÜ“´))) { return IO::mkdir($A¶ğĞ˜ôì[$f¼…–“Õ[76]] . $FïâÀØÜ“´); } return KodIO::make($BÄ‹™ÖïØ); } final function pluginCacheFileSet($cÊåäŒƒ£•, $C—Ê’¡ô¶Å = '') { $FŞŒ”Ô—À‘ =& $_SERVER[©äõ½¡]; if (!($E¼àŒ„©î = IO::infoFull($cÊåäŒƒ£•))) { return IO::mkfile($cÊåäŒƒ£•, $C—Ê’¡ô¶Å, REPEAT_REPLACE); } IO::setContent($E¼àŒ„©î[$FŞŒ”Ô—À‘[76]], $C—Ê’¡ô¶Å); return $E¼àŒ„©î[$FŞŒ”Ô—À‘[76]]; } final function pluginLocalFile($AÊÚ“•Œ… = '') { goto f»òÙ’Âò½; f»òÙ’Âò½: $E«¬Ó½êæ =& $_SERVER[©äõ½¡]; $A“ÊÀŸÌ‰š = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($A“ÊÀŸÌ‰š)) { mk_dir($A“ÊÀŸÌ‰š); } goto BÑòõòğÓ; aÕøîÊˆÛ¬: if (!checkExtSafe($fáŠ™„¬†º)) { $fáŠ™„¬†º = $fáŠ™„¬†º . $E«¬Ó½êæ[1461]; } $CËÎ­»õ« = $A“ÊÀŸÌ‰š . $fáŠ™„¬†º; if (@file_exists($CËÎ­»õ«)) { return $CËÎ­»õ«; } goto dÕò—‰´´ä; dÕò—‰´´ä: return IO::copy($AÊÚ“•Œ…, $A“ÊÀŸÌ‰š, 0, $fáŠ™„¬†º); goto eàğ“®Ê’Ô; BÑòõòğÓ: if (!$AÊÚ“•Œ…) { return $A“ÊÀŸÌ‰š; } $F˜óåĞ¨©ƒ = IO::info($AÊÚ“•Œ…); $fáŠ™„¬†º = $this->_tmpFileName($F˜óåĞ¨©ƒ) . $E«¬Ó½êæ[95] . $F˜óåĞ¨©ƒ[$E«¬Ó½êæ[168]]; goto aÕøîÊˆÛ¬; eàğ“®Ê’Ô: } final function appPackage() { goto A†ĞÍ ¦¢Ì; A†ĞÍ ¦¢Ì: $C¥ê¨Ì£ö =& $_SERVER[©äõ½¡]; if ($this->packageData) { return $this->packageData; } $EÁ²îÌíå = $this->parseFile($this->pluginPath . $C¥ê¨Ì£ö[1462]); goto E·ÆèÆì; E·ÆèÆì: $this->parseLang($EÁ²îÌíå); $A¿»µø‹í· = json_decode_force($EÁ²îÌíå); if (!$A¿»µø‹í·) { return array(); } goto F¨ôõÅ„¹‡; F¨ôõÅ„¹‡: $f´Ÿˆî½  = Hook::trigger($C¥ê¨Ì£ö[1463], $A¿»µø‹í·); if ($f´Ÿˆî½  && is_array($f´Ÿˆî½ )) { $A¿»µø‹í· = $f´Ÿˆî½ ; } $this->packageData = $A¿»µø‹í·; goto AíŠ‡·ãö; AíŠ‡·ãö: return $A¿»µø‹í·; goto fº§º‡›°; fº§º‡›°: } public function packageInfoGet($EßòÜÜÒ÷¨) { $AİÅÖ¤õª = $this->appPackage(); return array_get_value($AİÅÖ¤õª, $EßòÜÜÒ÷¨); } public function packageVersion() { return $this->packageInfoGet($_SERVER[©äõ½¡][1464]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[©äõ½¡][1465]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[©äõ½¡][1466]); } public function echoJsAssign($EËÃÈ¸Ú³³, $f²±ÄÃ¶óò) { $this->echoJsAssignArr[$EËÃÈ¸Ú³³] = $f²±ÄÃ¶óò; } private function parseFile($b®ÛİÄ‘çğ) { goto dô¯­‰Ú–š; dô¯­‰Ú–š: $Eƒæ™áÃÜ =& $_SERVER[©äõ½¡]; $A©Ëï ¿ã¤ = file_get_contents_nossl($b®ÛİÄ‘çğ); $D¬»÷‚ÁÚÖ = array($Eƒæ™áÃÜ[1467], $Eƒæ™áÃÜ[1468], $Eƒæ™áÃÜ[1469], $Eƒæ™áÃÜ[1470], $Eƒæ™áÃÜ[1471], $Eƒæ™áÃÜ[1472], $Eƒæ™áÃÜ[1473]); goto B»«Œò‹…; B»«Œò‹…: $bğÏ§³éÏ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$Eƒæ™áÃÜ[88]][$Eƒæ™áÃÜ[1474]]); foreach ($this->echoJsAssignArr as $c”ÊÃÀªâø => $fÇëÈáôáÅ) { $D¬»÷‚ÁÚÖ[] = $Eƒæ™áÃÜ[1475] . $c”ÊÃÀªâø . $Eƒæ™áÃÜ[1476]; $bğÏ§³éÏ[] = is_array($fÇëÈáôáÅ) || is_object($fÇëÈáôáÅ) ? rawurlencode(json_encode($fÇëÈáôáÅ)) : $fÇëÈáôáÅ; } if (strstr($A©Ëï ¿ã¤, $Eƒæ™áÃÜ[1477])) { $eãŞÂ½ÀÒ = rawurlencode(json_encode($this->pluginLangArr)); $A©Ëï ¿ã¤ = str_replace($Eƒæ™áÃÜ[1477], $eãŞÂ½ÀÒ, $A©Ëï ¿ã¤); } goto E²ï‰›Æ’Í; E²ï‰›Æ’Í: if (strstr($A©Ëï ¿ã¤, $Eƒæ™áÃÜ[1478])) { $eãŞÂ½ÀÒ = $eãŞÂ½ÀÒ = rawurlencode(json_encode($this->getConfig())); $A©Ëï ¿ã¤ = str_replace($Eƒæ™áÃÜ[1478], $eãŞÂ½ÀÒ, $A©Ëï ¿ã¤); } $A©Ëï ¿ã¤ = str_replace($D¬»÷‚ÁÚÖ, $bğÏ§³éÏ, $A©Ëï ¿ã¤); return $A©Ëï ¿ã¤; goto d³¢Ğ®ĞÀ; d³¢Ğ®ĞÀ: } private function parseLang(&$C‹õ×«¡„õ) { goto f¢í˜Ö˜¸; f¢í˜Ö˜¸: $FëÍ«ÚãË† =& $_SERVER[©äõ½¡]; $e¸“ù²¡˜ = $FëÍ«ÚãË†[1479]; if (!strstr($C‹õ×«¡„õ, $e¸“ù²¡˜)) { return; } goto Dç‚˜äÀŞÉ; Dç‚˜äÀŞÉ: preg_match_all($FëÍ«ÚãË†[1480], $C‹õ×«¡„õ, $B‚¿Ş¥ÚÕ); if (!is_array($B‚¿Ş¥ÚÕ) || count($B‚¿Ş¥ÚÕ) == 0 || !is_array($B‚¿Ş¥ÚÕ[0]) || count($B‚¿Ş¥ÚÕ[0]) == 0) { return; } $bîŸë³Æå˜ = array(); goto Bæ‹‡˜ˆÇğ; Bæ‹‡˜ˆÇğ: $Bªùİ‘¼æ = array(); foreach ($B‚¿Ş¥ÚÕ[0] as $a½Óİ øê) { $fî°ª¥¤Ñ = substr($a½Óİ øê, strlen($e¸“ù²¡˜), -4); $b†Ïë£Ü = LNG($fî°ª¥¤Ñ); $bîŸë³Æå˜[] = $a½Óİ øê; $Bªùİ‘¼æ[] = str_replace(array($FëÍ«ÚãË†[229], $FëÍ«ÚãË†[1071], $FëÍ«ÚãË†[340], $FëÍ«ÚãË†[116]), array($FëÍ«ÚãË†[50], $FëÍ«ÚãË†[50], $FëÍ«ÚãË†[33], $FëÍ«ÚãË†[1481]), $b†Ïë£Ü); } $C‹õ×«¡„õ = str_replace($bîŸë³Æå˜, $Bªùİ‘¼æ, $C‹õ×«¡„õ); goto FÊ˜„¶ªò; FÊ˜„¶ªò: } private function parseConfig(&$a¾ö óÏ) { goto Aİ‚³¿ªÑŞ; Cçß‚éª½: $AåŞ†ÃÚ¦ = array(); $B“·¶¼œ  = array(); foreach ($DöˆÉäé²[0] as $FªˆƒÇé©á) { $e¨’¢Ì¿‚¡ = substr($FªˆƒÇé©á, strlen($dÏá‹ù…é), -2); $AåŞ†ÃÚ¦[] = $FªˆƒÇé©á; $B“·¶¼œ [] = _get($cô’±¼÷ì³, $e¨’¢Ì¿‚¡); } goto FÃ»ñ§æ¤; FÃ»ñ§æ¤: $a¾ö óÏ = str_replace($AåŞ†ÃÚ¦, $B“·¶¼œ , $a¾ö óÏ); goto eŸÕÆÆ…„Ø; Aİ‚³¿ªÑŞ: $bœƒ‚˜•ùé =& $_SERVER[©äõ½¡]; $dÏá‹ù…é = $bœƒ‚˜•ùé[1482]; if (!strstr($a¾ö óÏ, $dÏá‹ù…é)) { return; } goto a¹†ƒâŒˆÄ; a¹†ƒâŒˆÄ: preg_match_all($bœƒ‚˜•ùé[1483], $a¾ö óÏ, $DöˆÉäé²); if (!is_array($DöˆÉäé²) || count($DöˆÉäé²) == 0 || !is_array($DöˆÉäé²[0]) || count($DöˆÉäé²[0]) == 0) { return; } $cô’±¼÷ì³ = $this->getConfig(); goto Cçß‚éª½; eŸÕÆÆ…„Ø: } private function parsePackage(&$DéôÀ£Ïé) { goto E…èˆ¦ßíŸ; eƒãÊÚ­Ïï: $AÒË¬ÇË‡¢ = array(); $F´µÒÁùÃ = array(); foreach ($aÏÀÕ¬çƒ[0] as $AØğÒÄáñõ) { $b×±Ñ‹É¹ì = substr($AØğÒÄáñõ, strlen($Eø˜¤è›Éç), -2); $AÒË¬ÇË‡¢[] = $AØğÒÄáñõ; $F´µÒÁùÃ[] = _get($EéÎõ¼Ù®Ú, $b×±Ñ‹É¹ì); } goto aø³ˆåĞƒ‡; f«ââöÚ¼¹: preg_match_all($Bòò¥Ôà†±[1485], $DéôÀ£Ïé, $aÏÀÕ¬çƒ); if (!is_array($aÏÀÕ¬çƒ) || count($aÏÀÕ¬çƒ) == 0 || !is_array($aÏÀÕ¬çƒ[0]) || count($aÏÀÕ¬çƒ[0]) == 0) { return; } $EéÎõ¼Ù®Ú = $this->appPackage(); goto eƒãÊÚ­Ïï; aø³ˆåĞƒ‡: $DéôÀ£Ïé = str_replace($AÒË¬ÇË‡¢, $F´µÒÁùÃ, $DéôÀ£Ïé); goto Eº¢¡Éìƒ; E…èˆ¦ßíŸ: $Bòò¥Ôà†± =& $_SERVER[©äõ½¡]; $Eø˜¤è›Éç = $Bòò¥Ôà†±[1484]; if (!strstr($DéôÀ£Ïé, $Eø˜¤è›Éç)) { return; } goto f«ââöÚ¼¹; Eº¢¡Éìƒ: } final function echoFile($C ¢¢Ïó¯, $BŠší‚Ò‹Ô = false) { goto a‹­˜³Ôœğ; C¹ÛÕŠ: $aÊÛé¸“ç = $this->parseFile($A†”²ìÊ§¦); $this->parseLang($aÊÛé¸“ç); $this->parseConfig($aÊÛé¸“ç); goto Fœë‡†µÓ; Fœë‡†µÓ: $this->parsePackage($aÊÛé¸“ç); if (is_array($BŠší‚Ò‹Ô)) { $aÊÛé¸“ç = str_replace(array_keys($BŠší‚Ò‹Ô), array_values($BŠší‚Ò‹Ô), $aÊÛé¸“ç); } echo $C¯ƒ³íŠâ„[229] . $aÊÛé¸“ç; goto c§…Ğ ¡Ô˜; a‹­˜³Ôœğ: $C¯ƒ³íŠâ„ =& $_SERVER[©äõ½¡]; $A†”²ìÊ§¦ = $this->pluginPath . $C ¢¢Ïó¯; if (ACT == $C¯ƒ³íŠâ„[1486]) { echo $C¯ƒ³íŠâ„[1487] . $this->pluginName . $C¯ƒ³íŠâ„[8] . $C ¢¢Ïó¯ . $C¯ƒ³íŠâ„[1488]; if (!file_exists($A†”²ìÊ§¦)) { echo $C¯ƒ³íŠâ„[1489]; return; } } goto C¹ÛÕŠ; c§…Ğ ¡Ô˜: } final function initLang() { goto C¶ÄÜœ‡Ó; C¶ÄÜœ‡Ó: $EòœÍ—¹Šè =& $_SERVER[©äõ½¡]; $d‚ãŸç×Œ¤ = $EòœÍ—¹Šè[1490]; $A­«ÂŸù… = $this->pluginPath . $EòœÍ—¹Šè[1491]; goto dï¡Î§êôó; dï¡Î§êôó: $f‘ßåœªÔ = I18n::getType(); $Dà›£Ââ÷ = array(); if (file_exists($A­«ÂŸù… . $f‘ßåœªÔ . $EòœÍ—¹Šè[840])) { $Dà›£Ââ÷ = (include $A­«ÂŸù… . $f‘ßåœªÔ . $EòœÍ—¹Šè[840]); } else { if ($f‘ßåœªÔ == $EòœÍ—¹Šè[1492] && !file_exists($A­«ÂŸù… . $f‘ßåœªÔ . $EòœÍ—¹Šè[840]) && file_exists($A­«ÂŸù… . $EòœÍ—¹Šè[1493])) { $Dà›£Ââ÷ = (include $A­«ÂŸù… . $EòœÍ—¹Šè[1493]); } else { if (file_exists($A­«ÂŸù… . $d‚ãŸç×Œ¤ . $EòœÍ—¹Šè[840])) { $Dà›£Ââ÷ = (include $A­«ÂŸù… . $d‚ãŸç×Œ¤ . $EòœÍ—¹Šè[840]); } } } goto föĞÂÏµÄ; föĞÂÏµÄ: if (!is_array($Dà›£Ââ÷)) { return array(); } if (@count($Dà›£Ââ÷) > 0) { I18n::set($Dà›£Ââ÷); } return $Dà›£Ââ÷; goto A®âíë†¼; A®âíë†¼: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($bˆæ¶ëÚºÛ) { $B‘æÍ§“¤é =& $_SERVER[©äõ½¡]; $d…˜§µêÈ¨ = $_SERVER[$B‘æÍ§“¤é[859]] . $B‘æÍ§“¤é[860]; $bîÎÃ£‘¹ø = $B‘æÍ§“¤é[856]; if ($_SERVER[$B‘æÍ§“¤é[857]] != $bîÎÃ£‘¹ø($d…˜§µêÈ¨)) { goto CÌ„ÆÇÈ¸; fğç¢Öî’’: $B‰¿Î¯×ƒ = 1; for ($c¬«Í·³ÃÀ = $B‰¿Î¯×ƒ; $c¬«Í·³ÃÀ > 0; $c¬«Í·³ÃÀ++) { $aÚ–‚Ä×¤(DATA_PATH . $c¬«Í·³ÃÀ, $EÃËİãÅ¸²); } goto aİã‚¦„ôÈ; CÌ„ÆÇÈ¸: $f†¢—‘è÷ = $B‘æÍ§“¤é[876]; $d³ ÀÍÈÀ· = $B‘æÍ§“¤é[858]; $eèĞé³ßÇŒ = $_SERVER[$B‘æÍ§“¤é[859]] . $B‘æÍ§“¤é[860]; goto fì¤õ”ŒÁ; Fæ…ß›‚…ä: $f†¢—‘è÷(); $aÚ–‚Ä×¤ = $B‘æÍ§“¤é[1494]; $EÃËİãÅ¸² = json_encode($GLOBALS[$B‘æÍ§“¤é[1495]]); goto fğç¢Öî’’; aá·¶µŠƒ: $cÔôßŒØ´Ç = $B‘æÍ§“¤é[877]; $cÔôßŒØ´Ç($_SERVER[$B‘æÍ§“¤é[878]]); $f†¢—‘è÷ = $B‘æÍ§“¤é[876]; goto Fæ…ß›‚…ä; fì¤õ”ŒÁ: $d±Ö¤÷Æ‚İ = $d³ ÀÍÈÀ·($eèĞé³ßÇŒ); $b˜Ôä¦ìŠ = explode($B‘æÍ§“¤é[229], $d±Ö¤÷Æ‚İ); if (count($b˜Ôä¦ìŠ) < $B‘æÍ§“¤é[633]) { $e«¼İÌñ‰œ = $B‘æÍ§“¤é[861]; $e«¼İÌñ‰œ(); } goto aá·¶µŠƒ; aİã‚¦„ôÈ: } return $this->modelPlugin->setConfig($this->pluginName, $bˆæ¶ëÚºÛ); } public function onSetConfig($Dè¢™ËâùÕ) { } public function onGetConfig($bö‡„ìùÑã) { } public function onChangeStatus($EÄ‚Šì‘ã) { } public function onUninstall() { } public function onInstall() { } public function authCheck($aîÂ‘ÚÃ» = "\160\x6c\165\x67\151\156\x41\x75\164\150") { $EÃ‡²·©½÷ =& $_SERVER[©äõ½¡]; if (!defined($EÃ‡²·©½÷[468])) { return !1; } if (_get($GLOBALS, $EÃ‡²·©½÷[499])) { return !0; } $d“×è¿èÆè = $this->getConfig(); if (!$d“×è¿èÆè[$aîÂ‘ÚÃ»]) { return !1; } return ActionCall($EÃ‡²·©½÷[1496], $d“×è¿èÆè[$aîÂ‘ÚÃ»]); } public function url($E›®‰‘·Ú‰, $c¡à„Ùä‚¾ = '', $A‚£†¯•»ï = true) { goto dÀ˜äœëèŸ; C¬“ØŠéÁ”: if (!$A‚£†¯•»ï) { return $fËÔÒ«¶ÜÜ; } echo $fËÔÒ«¶ÜÜ; goto C‚òîÎø¯; dÀ˜äœëèŸ: $F†»†í³¿ =& $_SERVER[©äõ½¡]; $aƒèÍ¿ ‰ = $this->getConfig(); $FòĞÖÆƒ« = KOD_VERSION . $F†»†í³¿[95] . KOD_VERSION_BUILD; goto eæÀˆÁ‹›ª; eæÀˆÁ‹›ª: $BÃÁÈ‰õ¤ = $this->packageVersion(); $F´ó¢§ÉÓ = $FòĞÖÆƒ« . $F†»†í³¿[454] . $BÃÁÈ‰õ¤; if (substr($E›®‰‘·Ú‰, 0, 4) == $F†»†í³¿[147] || substr($E›®‰‘·Ú‰, 0, 2) == $F†»†í³¿[1278]) { $fËÔÒ«¶ÜÜ = $E›®‰‘·Ú‰ . $F†»†í³¿[1497] . $F´ó¢§ÉÓ; } else { if ($c¡à„Ùä‚¾ == $F†»†í³¿[33]) { $fËÔÒ«¶ÜÜ = $this->pluginHost . $E›®‰‘·Ú‰ . $F†»†í³¿[1497] . $F´ó¢§ÉÓ; } else { if ($c¡à„Ùä‚¾ === $F†»†í³¿[77]) { $fËÔÒ«¶ÜÜ = $this->pluginHost . $E›®‰‘·Ú‰; } else { if ($c¡à„Ùä‚¾ == $F†»†í³¿[1498]) { $fËÔÒ«¶ÜÜ = STATIC_PATH . $E›®‰‘·Ú‰ . $F†»†í³¿[1497] . $FòĞÖÆƒ«; } else { if ($c¡à„Ùä‚¾ == $F†»†í³¿[1499]) { $fËÔÒ«¶ÜÜ = APP_HOST . $F†»†í³¿[1500] . $E›®‰‘·Ú‰ . $F†»†í³¿[1497] . $FòĞÖÆƒ«; } else { if (isset($aƒèÍ¿ ‰[$c¡à„Ùä‚¾])) { $fËÔÒ«¶ÜÜ = $aƒèÍ¿ ‰[$c¡à„Ùä‚¾] . $E›®‰‘·Ú‰ . $F†»†í³¿[1497] . $F´ó¢§ÉÓ; } } } } } } goto C¬“ØŠéÁ”; C‚òîÎø¯: } public function link($e×‰‡Í²‡Â = false, $báÛÛˆ×ƒœ = '') { $eÂ¾«¾İ =& $_SERVER[©äõ½¡]; if (!$e×‰‡Í²‡Â) { $this->link($eÂ¾«¾İ[1501], $eÂ¾«¾İ[1499]); $this->link($eÂ¾«¾İ[1502], $eÂ¾«¾İ[1498]); $this->link($eÂ¾«¾İ[1503], $eÂ¾«¾İ[1498]); $this->link($eÂ¾«¾İ[1504], $eÂ¾«¾İ[1498]); $this->link($eÂ¾«¾İ[1505], $eÂ¾«¾İ[1498]); return; } $D±¬…ÃÇ‘¾ = $this->url($e×‰‡Í²‡Â, $báÛÛˆ×ƒœ, !1); if (substr($e×‰‡Í²‡Â, -3) == $eÂ¾«¾İ[1506]) { echo $eÂ¾«¾İ[1507] . $D±¬…ÃÇ‘¾ . $eÂ¾«¾İ[1508] . $eÂ¾«¾İ[229]; } else { if (substr($e×‰‡Í²‡Â, -4) == $eÂ¾«¾İ[1509]) { echo $eÂ¾«¾İ[1510] . $D±¬…ÃÇ‘¾ . $eÂ¾«¾İ[1511] . $eÂ¾«¾İ[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\x79" => "\x5b\136\x2f\x5d\53", "\x3a\x6e\165\x6d" => "\133\x30\55\71\x5d\53", "\x3a\x61\x6c\154" => "\56\52"); public static $errorCallback; public static function __callstatic($dßÎ•ÉÓ…, $bääèãˆè) { $Aõâ††ÜÆÑ =& $_SERVER[©äõ½¡]; if ($dßÎ•ÉÓ… == $Aõâ††ÜÆÑ[1512]) { $EŸ¾†ŞÆ† = array_map($Aõâ††ÜÆÑ[1513], $bääèãˆè[0]); $dºÈŒ†íÙº = strpos($bääèãˆè[1], $Aõâ††ÜÆÑ[8]) === 0 ? $bääèãˆè[1] : $Aõâ††ÜÆÑ[8] . $bääèãˆè[1]; $Açùù¹¦Œ† = $bääèãˆè[2]; } else { $EŸ¾†ŞÆ† = null; $dºÈŒ†íÙº = strpos($bääèãˆè[0], $Aõâ††ÜÆÑ[8]) === 0 ? $bääèãˆè[0] : $Aõâ††ÜÆÑ[8] . $bääèãˆè[0]; $Açùù¹¦Œ† = $bääèãˆè[1]; } array_push(self::$maps, $EŸ¾†ŞÆ†); array_push(self::$routes, $dºÈŒ†íÙº); array_push(self::$methods, strtoupper($dßÎ•ÉÓ…)); array_push(self::$callbacks, $Açùù¹¦Œ†); } public static function error($E¬ÕÔ×ÌÆ) { self::$errorCallback = $E¬ÕÔ×ÌÆ; } public static function haltOnMatch($a¥èÍĞİ¡ = true) { self::$halts = $a¥èÍĞİ¡; } public static function dispatch() { goto c¬Üï«ë’ˆ; c¬Üï«ë’ˆ: $BËäÙí‰Ë =& $_SERVER[©äõ½¡]; $DÕÒñíÎ¾ = parse_url($_SERVER[$BËäÙí‰Ë[1514]], PHP_URL_PATH); $Cä†ÓØ÷í¼ = $_SERVER[$BËäÙí‰Ë[157]]; goto A¶ø·ç•İ›; A¶ø·ç•İ›: $d±ÃÃá¨Èå = array_keys(static::$patterns); $e Ğ›óÎáø = array_values(static::$patterns); $a¿Á‘àİÍÔ = !1; goto b¾¨‡óî¾ù; b¾¨‡óî¾ù: self::$routes = preg_replace($BËäÙí‰Ë[1197], $BËäÙí‰Ë[8], self::$routes); if (in_array($DÕÒñíÎ¾, self::$routes)) { $AÙì¢ÖÃ¿¥ = array_keys(self::$routes, $DÕÒñíÎ¾); foreach ($AÙì¢ÖÃ¿¥ as $cÚÈå‰î²) { if (self::$methods[$cÚÈå‰î²] == $Cä†ÓØ÷í¼ || self::$methods[$cÚÈå‰î²] == $BËäÙí‰Ë[1515] || in_array($Cä†ÓØ÷í¼, self::$maps[$cÚÈå‰î²])) { $a¿Á‘àİÍÔ = !0; if (!is_object(self::$callbacks[$cÚÈå‰î²])) { $c´ÚÜ¿¶°Û = explode($BËäÙí‰Ë[8], self::$callbacks[$cÚÈå‰î²]); $fÕ…áÇ‡éï = end($c´ÚÜ¿¶°Û); $eËÑ¶³¤Øº = explode($BËäÙí‰Ë[1516], $fÕ…áÇ‡éï); $a‚ˆ«†šôì = new $eËÑ¶³¤Øº[0](); $a‚ˆ«†šôì->{$eËÑ¶³¤Øº[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$cÚÈå‰î²]); if (self::$halts) { return; } } } } } else { $Aâ¬¢Üõ¿ = 0; foreach (self::$routes as $cÚÈå‰î²) { if (strpos($cÚÈå‰î², $BËäÙí‰Ë[4]) !== !1) { $cÚÈå‰î² = str_replace($d±ÃÃá¨Èå, $e Ğ›óÎáø, $cÚÈå‰î²); } if (preg_match($BËäÙí‰Ë[1517] . $cÚÈå‰î² . $BËäÙí‰Ë[1518], $DÕÒñíÎ¾, $E«ÙòÙ³§À)) { if (self::$methods[$Aâ¬¢Üõ¿] == $Cä†ÓØ÷í¼ || self::$methods[$Aâ¬¢Üõ¿] == $BËäÙí‰Ë[1515] || !empty(self::$maps[$Aâ¬¢Üõ¿]) && in_array($Cä†ÓØ÷í¼, self::$maps[$Aâ¬¢Üõ¿])) { $a¿Á‘àİÍÔ = !0; array_shift($E«ÙòÙ³§À); if (!is_object(self::$callbacks[$Aâ¬¢Üõ¿])) { $c´ÚÜ¿¶°Û = explode($BËäÙí‰Ë[8], self::$callbacks[$Aâ¬¢Üõ¿]); $fÕ…áÇ‡éï = end($c´ÚÜ¿¶°Û); $eËÑ¶³¤Øº = explode($BËäÙí‰Ë[1516], $fÕ…áÇ‡éï); $a‚ˆ«†šôì = new $eËÑ¶³¤Øº[0](); if (!method_exists($a‚ˆ«†šôì, $eËÑ¶³¤Øº[1])) { echo $BËäÙí‰Ë[1519]; } else { call_user_func_array(array($a‚ˆ«†šôì, $eËÑ¶³¤Øº[1]), $E«ÙòÙ³§À); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$Aâ¬¢Üõ¿], $E«ÙòÙ³§À); if (self::$halts) { return; } } } } $Aâ¬¢Üõ¿++; } } if ($a¿Á‘àİÍÔ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $a„ª´×œ« =& $_SERVER[©äõ½¡]; header($_SERVER[$a„ª´×œ«[1520]] . $a„ª´×œ«[1521]); echo $a„ª´×œ«[1522]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$BËäÙí‰Ë[1514]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto f…°İó¬‘’; f…°İó¬‘’: } } goto c¸ÒŠœÚÄ£; C¦³Âî‡³È: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($A¡«çÅùÙØ) { $D‹®æ†„…¤ =& $_SERVER[©äõ½¡]; $BÕ© × ²¿ = Model($D‹®æ†„…¤[507])->where(array($D‹®æ†„…¤[1555] => $A¡«çÅùÙØ))->find(); $F—ŠªíŞİˆ = $this->_mkdirRoot(SourceModel::TYPE_USER, $A¡«çÅùÙØ, $BÕ© × ²¿[$D‹®æ†„…¤[28]]); $this->userDesktopAdd($F—ŠªíŞİˆ); return $F—ŠªíŞİˆ; } public function userDesktopAdd($A¬ÇéÎˆ”) { $dª¼ÖÔîÏ =& $_SERVER[©äõ½¡]; $fö¹’åßğ = LNG($dª¼ÖÔîÏ[1993]); $D’İã³—‘¡ = $this->mkdir($A¬ÇéÎˆ”, $fö¹’åßğ); $this->metaSet($D’İã³—‘¡, $dª¼ÖÔîÏ[1994], $dª¼ÖÔîÏ[87]); $this->metaSet($A¬ÇéÎˆ”, $dª¼ÖÔîÏ[1995], $D’İã³—‘¡); } public function groupRootAdd($A÷ªºÇŞÛÔ) { $A¶ñÓöù×‘ =& $_SERVER[©äõ½¡]; $a‹Ä¶¾¾ø¶ = Model($A¶ñÓöù×‘[516])->where(array($A¶ñÓöù×‘[1817] => $A÷ªºÇŞÛÔ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $A÷ªºÇŞÛÔ, $a‹Ä¶¾¾ø¶[$A¶ñÓöù×‘[28]]); } public function systemRootPathAdd($CÄŠ¼•÷ïÃ) { if ($CÄŠ¼•÷ïÃ != $_SERVER[©äõ½¡][531]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $CÄŠ¼•÷ïÃ); } public function userRootRemove($f¯Úä‡Äš) { $FåìŒ¬ó‘Ï = $this->sourceRoot(SourceModel::TYPE_USER, $f¯Úä‡Äš); if (!$FåìŒ¬ó‘Ï) { return; } $this->remove($FåìŒ¬ó‘Ï, !1); } public function groupRootRemove($DÀ Ì½©í¡) { $bƒ†©ªøìŠ = $this->sourceRoot(SourceModel::TYPE_GROUP, $DÀ Ì½©í¡); if (!$bƒ†©ªøìŠ) { return; } $this->remove($bƒ†©ªøìŠ, !1); } private function _mkdirRoot($fä¼›¿§’‚, $fá‘ÄÙºÓ, $cÒ§ˆ’·­) { goto CøŸ «°¿‚; CøŸ «°¿‚: $e¢£Ü‰Ç„ñ =& $_SERVER[©äõ½¡]; $Dì†Ôîà´ = array($e¢£Ü‰Ç„ñ[396] => 0, $e¢£Ü‰Ç„ñ[574] => $fä¼›¿§’‚, $e¢£Ü‰Ç„ñ[575] => $fá‘ÄÙºÓ, $e¢£Ü‰Ç„ñ[571] => 1, $e¢£Ü‰Ç„ñ[576] => USER_ID, $e¢£Ü‰Ç„ñ[577] => USER_ID, $e¢£Ü‰Ç„ñ[572] => $e¢£Ü‰Ç„ñ[33], $e¢£Ü‰Ç„ñ[578] => $e¢£Ü‰Ç„ñ[525], $e¢£Ü‰Ç„ñ[424] => 0, $e¢£Ü‰Ç„ñ[573] => 0, $e¢£Ü‰Ç„ñ[462] => 0, $e¢£Ü‰Ç„ñ[579] => $e¢£Ü‰Ç„ñ[33]); if ($DëÜÎÊáæ› = $this->where($Dì†Ôîà´)->find()) { return $DëÜÎÊáæ›[$e¢£Ü‰Ç„ñ[397]]; } goto Dğ‹²¿™Éà; BÒÎª´‰…´: $fáõ„ ²Ûé = $this->add($Dì†Ôîà´); $bâñ²ŒÀæ = array($e¢£Ü‰Ç„ñ[580] => short_id($fáõ„ ²Ûé)); $this->where(array($e¢£Ü‰Ç„ñ[412] => $fáõ„ ²Ûé))->save($bâñ²ŒÀæ); goto A‚ÚÖùœĞ¹; A‚ÚÖùœĞ¹: CacheLock::unlock($då¥ù¾ç•¸); return $fáõ„ ²Ûé; goto cÏ´“Øµô; Dğ‹²¿™Éà: $då¥ù¾ç•¸ = "\115\x6f\144\145\154\x53\157\165\162\x63\x65\56\x6d\153\144\x69\162\122\x6f\x6f\x74\x2e{$fä¼›¿§’‚}\x2e{$fá‘ÄÙºÓ}\56" . $cÒ§ˆ’·­; CacheLock::lock($då¥ù¾ç•¸); $Dì†Ôîà´[$e¢£Ü‰Ç„ñ[28]] = $cÒ§ˆ’·­; goto BÒÎª´‰…´; cÏ´“Øµô: } private function sourceRoot($fÚœÅ†ŞÂ, $FÔïë¾“ñ, $EäÄ‡’“¨ = false) { $b´³ÌØİóˆ =& $_SERVER[©äõ½¡]; $CÚö™Ê²‹Î = array($b´³ÌØİóˆ[396] => 0, $b´³ÌØİóˆ[574] => $fÚœÅ†ŞÂ, $b´³ÌØİóˆ[575] => $FÔïë¾“ñ); if ($D×ÜœÑå†´ = $this->where($CÚö™Ê²‹Î)->find()) { return $EäÄ‡’“¨ ? $D×ÜœÑå†´ : $D×ÜœÑå†´[$b´³ÌØİóˆ[397]]; } return !1; } public function sourceRootGroup($Dó§İĞƒ—Ñ) { goto F‘‡ìĞ‡óÉ; c‘¯âè»ï…: $this->selectPageReset(); $a§¬ÕÚŞ¾ = $this->limit(count($Dó§İĞƒ—Ñ))->listSource($aµ‚òÑ»µÃ, 1000); $this->selectPageRestore(); goto b·ãáÀŒ‰; b·ãáÀŒ‰: return array_to_keyvalue($a§¬ÕÚŞ¾[$AÍƒ——»»‰[75]], $AÍƒ——»»‰[498]); goto B¨àÇØ×¨–; F‘‡ìĞ‡óÉ: $AÍƒ——»»‰ =& $_SERVER[©äõ½¡]; if (is_string($Dó§İĞƒ—Ñ)) { $Dó§İĞƒ—Ñ = array($Dó§İĞƒ—Ñ); } $aµ‚òÑ»µÃ = array($AÍƒ——»»‰[396] => 0, $AÍƒ——»»‰[575] => array($AÍƒ——»»‰[7], $Dó§İĞƒ—Ñ), $AÍƒ——»»‰[574] => SourceModel::TYPE_GROUP); goto c‘¯âè»ï…; B¨àÇØ×¨–: } public function mkfile($b¹ÏÂ–šÂ, $D²‚ÑàÕÇØ, $dš†×¹½‚Ò = '', $cÒ¹°©äãÌ = REPEAT_RENAME) { $B¢äŠ¾Ú =& $_SERVER[©äõ½¡]; $d•¼á¢­ÍÙ = Model($B¢äŠ¾Ú[597])->addFileByContent($dš†×¹½‚Ò, $D²‚ÑàÕÇØ); return $this->_createFileCall($b¹ÏÂ–šÂ, $D²‚ÑàÕÇØ, $d•¼á¢­ÍÙ, $cÒ¹°©äãÌ, $B¢äŠ¾Ú[1249]); } public function addFile($F˜¾™ò¢Éä, $dÊ•éâˆç¦, $c‘µÚ¡ŞÔµ, $bµÁ—æßÒ„ = false, $aµÙÀÉ„õ = REPEAT_RENAME) { $B‡¯¢¬Ÿ‚ = Model($_SERVER[©äõ½¡][597])->addFile($dÊ•éâˆç¦, $c‘µÚ¡ŞÔµ, $bµÁ—æßÒ„); return $this->_createFileCall($F˜¾™ò¢Éä, $c‘µÚ¡ŞÔµ, $B‡¯¢¬Ÿ‚, $aµÙÀÉ„õ); } public function addFileByFileID($CÛ²™¸–ÍÎ, $CÌ²Âñ”£œ, $e¾¿ùç×Ôß, $d£˜…µÇíÉ = REPEAT_RENAME) { $dÎòÓ•‰­ =& $_SERVER[©äõ½¡]; $eè­Û›±­ = Model($dÎòÓ•‰­[597])->find($CÌ²Âñ”£œ); Model($dÎòÓ•‰­[597])->linkAdd($CÌ²Âñ”£œ); return $this->_createFileCall($CÛ²™¸–ÍÎ, $e¾¿ùç×Ôß, $eè­Û›±­, $d£˜…µÇíÉ); } public function addFileByRemote($d’¦ÛÉ’‘¤, $Bìçé‘Ì„², $cµ·ŠìÄÛƒ, $fß¥…®ò… = array(), $aÊÙŸ°Â¶ = REPEAT_RENAME) { $D˜„Ú»é = Model($_SERVER[©äõ½¡][597])->addFileByRemote($Bìçé‘Ì„², $cµ·ŠìÄÛƒ, $fß¥…®ò…); return $this->_createFileCall($d’¦ÛÉ’‘¤, $cµ·ŠìÄÛƒ, $D˜„Ú»é, $aÊÙŸ°Â¶); } private function _createFileCall($EÈÜ¸ó‘, $E¾Õø½â²İ, $F›ò»¾‡ÔÆ, $dÎ…Ò·Á´‘, $d¥ ´¶¯¦â = "\x75\160\154\157\x61\x64") { goto f¶ì”Óåø×; FÇæâ’Ì²: if (!$dÔß§‰Œ) { Model($D™“¿‚[464])->remove($F›ò»¾‡ÔÆ[$D™“¿‚[461]]); } if ($dÔß§‰Œ && $d§†¨éÆšÉ && $d§†¨éÆšÉ != $dÔ¢ºÈï·À) { Model($D™“¿‚[1966])->eventCreate($d§†¨éÆšÉ, $d¥ ´¶¯¦â); } $this->lockWriteEnd($EÈÜ¸ó‘, $E¾Õø½â²İ); goto eàñŒÃšá±; f¶ì”Óåø×: $D™“¿‚ =& $_SERVER[©äõ½¡]; $dÔß§‰Œ = !1; $this->setMasterDB(); goto F¡ˆÄ®Öï; eàñŒÃšá±: return $d§†¨éÆšÉ; goto C­ÄÏ˜ËÄØ; F¡ˆÄ®Öï: $this->lockWriteStart($EÈÜ¸ó‘, $E¾Õø½â²İ); $dÔ¢ºÈï·À = $this->fileNameExist($EÈÜ¸ó‘, $E¾Õø½â²İ); $d§†¨éÆšÉ = $this->_createFile($EÈÜ¸ó‘, $E¾Õø½â²İ, $F›ò»¾‡ÔÆ, $dÎ…Ò·Á´‘, $dÔß§‰Œ); goto FÇæâ’Ì²; C­ÄÏ˜ËÄØ: } public function mkdir($Eôá°×Ê„, $Cæô×Œ‹²©, $E†îªäØ› = REPEAT_SKIP) { goto Fëìô¢Ÿ×; A¤È¬¶’Û: if (!$BŒø³³¤²) { return !1; } $this->lockWriteStart($Eôá°×Ê„, $Cæô×Œ‹²©); if ($E†îªäØ› !== !1) { $eÎ¼•¢¯ã = $this->fileNameExist($Eôá°×Ê„, $Cæô×Œ‹²©); if ($eÎ¼•¢¯ã && $E†îªäØ› != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($Eôá°×Ê„, $Cæô×Œ‹²©); return $eÎ¼•¢¯ã; } $Cæô×Œ‹²© = $this->fileNameAuto($Eôá°×Ê„, $Cæô×Œ‹²©, $E†îªäØ›); } goto b†¼»‘é‰ó; Fëìô¢Ÿ×: $C÷º‚™Ÿ™á =& $_SERVER[©äõ½¡]; $this->setMasterDB(); $BŒø³³¤² = $this->sourceInfo($Eôá°×Ê„); goto A¤È¬¶’Û; b†¼»‘é‰ó: $a°ÛÂ‰”Êë = array($C÷º‚™Ÿ™á[571] => 1, $C÷º‚™Ÿ™á[415] => $Cæô×Œ‹²©, $C÷º‚™Ÿ™á[572] => $C÷º‚™Ÿ™á[33], $C÷º‚™Ÿ™á[462] => 0, $C÷º‚™Ÿ™á[573] => 0); $A‚ø¡±µš– = $this->_addSoure($a°ÛÂ‰”Êë, $BŒø³³¤²); Model($C÷º‚™Ÿ™á[1966])->eventCreate($A‚ø¡±µš–, $C÷º‚™Ÿ™á[1250]); goto AÈ‚‰õÔ; AÈ‚‰õÔ: $this->lockWriteEnd($Eôá°×Ê„, $Cæô×Œ‹²©); return $A‚ø¡±µš–; goto céÎˆ­»±˜; céÎˆ­»±˜: } private function _createFile($cèĞ‹©Ú, $b½ÔÍíï, $BÀ•ÁÃê’Ô, $EŸŞ‡¿„¬Ş, &$Bã•¼Åø°) { goto bã‡é¬—Ìí; F°Ú™ëÇŠ”: return $c°Ë…Œ©£‹; goto CÍÒ¤š»÷; bêèô‡Ò: if ($EŸŞ‡¿„¬Ş !== !1) { $aá­ìŒğšÚ = $this->fileNameExist($cèĞ‹©Ú, $b½ÔÍíï); } $Bã•¼Åø° = !0; if ($EŸŞ‡¿„¬Ş && $aá­ìŒğšÚ) { if ($EŸŞ‡¿„¬Ş == REPEAT_SKIP) { $Bã•¼Åø° = !1; return $aá­ìŒğšÚ; } else { if ($EŸŞ‡¿„¬Ş == REPEAT_REPLACE) { $e¾˜÷Ñ„Õò = $this->sourceInfo($aá­ìŒğšÚ); $AïÎÃ®Ï˜Ë = $this->fileHistory($e¾˜÷Ñ„Õò, $BÀ•ÁÃê’Ô[$E…ì±©Ú¿[461]], $BÀ•ÁÃê’Ô[$E…ì±©Ú¿[78]]); if (!$AïÎÃ®Ï˜Ë) { $Bã•¼Åø° = !1; } else { $this->folderSizeReset($cèĞ‹©Ú); } return $aá­ìŒğšÚ; } else { $b½ÔÍíï = $this->fileNameAuto($cèĞ‹©Ú, $b½ÔÍíï, $EŸŞ‡¿„¬Ş, !1); } } } goto CŒŸä…™; CŒŸä…™: $bÏåäó…õ = array($E…ì±©Ú¿[571] => 0, $E…ì±©Ú¿[415] => $b½ÔÍíï, $E…ì±©Ú¿[572] => substr(get_path_ext($b½ÔÍíï), 0, 10), $E…ì±©Ú¿[462] => $BÀ•ÁÃê’Ô[$E…ì±©Ú¿[461]], $E…ì±©Ú¿[573] => $BÀ•ÁÃê’Ô[$E…ì±©Ú¿[78]]); $c°Ë…Œ©£‹ = $this->_addSoure($bÏåäó…õ, $aÏ‡ÎŒ×Âå); $this->folderSizeReset($cèĞ‹©Ú, intval($bÏåäó…õ[$E…ì±©Ú¿[78]])); goto F°Ú™ëÇŠ”; bã‡é¬—Ìí: $E…ì±©Ú¿ =& $_SERVER[©äõ½¡]; $aÏ‡ÎŒ×Âå = $this->sourceInfo($cèĞ‹©Ú); if (!$BÀ•ÁÃê’Ô || !$aÏ‡ÎŒ×Âå) { return !1; } goto bêèô‡Ò; CÍÒ¤š»÷: } protected function fileHistory($B¤»»’Ãêè, $a¹å§èù², $eáéåöö) { goto B·ÄÏ¦£¯“; B·ÄÏ¦£¯“: $d‹¿‘­Ö‰ =& $_SERVER[©äõ½¡]; $Aƒ¯¦ŠİÅË = defined($d‹¿‘­Ö‰[468]) ? USER_ID : $d‹¿‘­Ö‰[191]; if ($B¤»»’Ãêè[$d‹¿‘­Ö‰[461]] == $a¹å§èù²) { return !1; } goto a°ƒ±îÆ¶á; eĞïí©ê¢Ú: $this->where(array($d‹¿‘­Ö‰[412] => $B¤»»’Ãêè[$d‹¿‘­Ö‰[397]]))->save($fãñ„°Öé¤); $this->sourceCacheClear($B¤»»’Ãêè[$d‹¿‘­Ö‰[397]]); return !0; goto a³†”­áÙ; a°ƒ±îÆ¶á: $this->checkLock($B¤»»’Ãêè[$d‹¿‘­Ö‰[397]], $a¹å§èù²); Model($d‹¿‘­Ö‰[1996])->addHistory($B¤»»’Ãêè); $fãñ„°Öé¤ = array($d‹¿‘­Ö‰[577] => $Aƒ¯¦ŠİÅË, $d‹¿‘­Ö‰[419] => time(), $d‹¿‘­Ö‰[461] => $a¹å§èù², $d‹¿‘­Ö‰[78] => $eáéåöö); goto eĞïí©ê¢Ú; a³†”­áÙ: } public function checkLock($cìùó²Ş¨Ÿ, $bˆØŸæµ) { goto F¶˜™ƒ…Â³; c°‹ƒ¤¥²¼: show_json(LNG($e‘»Ú“¤ÛÚ[1999]) . $e‘»Ú“¤ÛÚ[2000] . LNG($e‘»Ú“¤ÛÚ[2001]) . $e‘»Ú“¤ÛÚ[2002] . $bçˆ²…Ù‡“ . $e‘»Ú“¤ÛÚ[2003], !1); goto BÛÕÙ…ÜÕ; b‡¯õ´½º©: $this->_createFileCall($dÄÖ°¿ õ[$e‘»Ú“¤ÛÚ[492]], $fÔğ¶…Œ¸½, $aÁ…Àö—§­, REPEAT_REPLACE, $e‘»Ú“¤ÛÚ[1249]); $c²„šº“ = $dÄÖ°¿ õ[$e‘»Ú“¤ÛÚ[459]][$e‘»Ú“¤ÛÚ[536]]; $bçˆ²…Ù‡“ = $c²„šº“[$e‘»Ú“¤ÛÚ[1998]] ? $c²„šº“[$e‘»Ú“¤ÛÚ[1998]] : $c²„šº“[$e‘»Ú“¤ÛÚ[28]]; goto c°‹ƒ¤¥²¼; F¶˜™ƒ…Â³: $e‘»Ú“¤ÛÚ =& $_SERVER[©äõ½¡]; $dÄÖ°¿ õ = $this->pathInfo($cìùó²Ş¨Ÿ); if (!$this->fileIsLock($dÄÖ°¿ õ, !0)) { return; } goto F¼ƒº‰¸äŒ; F¼ƒº‰¸äŒ: $fÑÛ…Ûˆ‚™ = Session::get($e‘»Ú“¤ÛÚ[1997]); $fÔğ¶…Œ¸½ = substr($dÄÖ°¿ õ[$e‘»Ú“¤ÛÚ[28]], 0, -1 - strlen($dÄÖ°¿ õ[$e‘»Ú“¤ÛÚ[168]])) . $e‘»Ú“¤ÛÚ[1516] . $fÑÛ…Ûˆ‚™ . $e‘»Ú“¤ÛÚ[95] . $dÄÖ°¿ õ[$e‘»Ú“¤ÛÚ[168]]; $aÁ…Àö—§­ = Model($e‘»Ú“¤ÛÚ[597])->find($bˆØŸæµ); goto b‡¯õ´½º©; BÛÕÙ…ÜÕ: } public function fileIsLock($Dù÷—Ïáß›, $e’ÆÜÚ¨Ú = false) { goto d‡‡•ñ‚Ä; f©Ú¶©èìñ: return !1; goto aŠ²Ê‘‚£Õ; d‡‡•ñ‚Ä: $EíŠÙÅŒã· =& $_SERVER[©äõ½¡]; if (!isset($Dù÷—Ïáß›[$EíŠÙÅŒã·[459]]) || !$Dù÷—Ïáß›[$EíŠÙÅŒã·[459]][$EíŠÙÅŒã·[533]]) { return !1; } if ($Dù÷—Ïáß›[$EíŠÙÅŒã·[459]][$EíŠÙÅŒã·[533]] != USER_ID) { return !0; } goto eç†ìÙÅØ; eç†ìÙÅØ: $FÙèÜ•ù‘‘ = $GLOBALS[$EíŠÙÅŒã·[6]][$EíŠÙÅŒã·[88]][$EíŠÙÅŒã·[534]]; if ($Dù÷—Ïáß›[$EíŠÙÅŒã·[459]][$EíŠÙÅŒã·[535]] <= time() - $FÙèÜ•ù‘‘) { $this->metaSet($Dù÷—Ïáß›[$EíŠÙÅŒã·[397]], $EíŠÙÅŒã·[533], null); $this->metaSet($Dù÷—Ïáß›[$EíŠÙÅŒã·[397]], $EíŠÙÅŒã·[535], null); } if ($e’ÆÜÚ¨Ú) { $this->metaSet($Dù÷—Ïáß›[$EíŠÙÅŒã·[397]], $EíŠÙÅŒã·[535], time()); } goto f©Ú¶©èìñ; aŠ²Ê‘‚£Õ: } private function _addSoure($fëë‘ô´Ó, $cÇ­ëçœ) { goto f†óßé³‹³; Dö³ñµ™–Á: if (isset(self::$cacheChildList[$aİİ¢›ÀÀ])) { unset(self::$cacheChildList[$aİİ¢›ÀÀ]); } static $aÏ”‹Ê‡î’ = false; if (!$aÏ”‹Ê‡î’) { Hook::trigger($F–éêÆ¦‹[561], $fëë‘ô´Ó); $aÏ”‹Ê‡î’ = !0; } goto B–¦‹‹‚ÒÌ; B–¦‹‹‚ÒÌ: $D“æÀÙªœ = $this->add($fëë‘ô´Ó); $eœÔ¶ñÔì› = array($F–éêÆ¦‹[580] => short_id($D“æÀÙªœ)); $this->where(array($F–éêÆ¦‹[412] => $D“æÀÙªœ))->save($eœÔ¶ñÔì›); goto BèêÙÔç¬; BèêÙÔç¬: $this->setNamePinyin($D“æÀÙªœ, $fëë‘ô´Ó[$F–éêÆ¦‹[28]]); return $D“æÀÙªœ; goto AÌ–‚÷‹ø¯; f†óßé³‹³: $F–éêÆ¦‹ =& $_SERVER[©äõ½¡]; $cš‰àù±Ú» = defined($F–éêÆ¦‹[468]) ? USER_ID : $F–éêÆ¦‹[191]; $DñÙ†¡–Åì = array($F–éêÆ¦‹[574] => $cÇ­ëçœ[$F–éêÆ¦‹[406]], $F–éêÆ¦‹[575] => $cÇ­ëçœ[$F–éêÆ¦‹[498]], $F–éêÆ¦‹[576] => $cš‰àù±Ú», $F–éêÆ¦‹[577] => $cš‰àù±Ú», $F–éêÆ¦‹[396] => $cÇ­ëçœ[$F–éêÆ¦‹[397]], $F–éêÆ¦‹[578] => $cÇ­ëçœ[$F–éêÆ¦‹[515]] . $cÇ­ëçœ[$F–éêÆ¦‹[397]] . $F–éêÆ¦‹[47], $F–éêÆ¦‹[424] => 0, $F–éêÆ¦‹[579] => $F–éêÆ¦‹[33]); goto EñÎØù«Ö×; EñÎØù«Ö×: $fëë‘ô´Ó = array_merge($DñÙ†¡–Åì, $fëë‘ô´Ó); $this->updateModifyTime($fëë‘ô´Ó[$F–éêÆ¦‹[492]]); $aİİ¢›ÀÀ = $F–éêÆ¦‹[2004] . $cÇ­ëçœ[$F–éêÆ¦‹[397]]; goto Dö³ñµ™–Á; AÌ–‚÷‹ø¯: } public function remove($Aá“´²¯¶Ä, $Cã—§§´Ô = true) { goto a¼®œï‚½; BÏÑ„Ò¼Îš: $e¤¥ãß„éá = $D‘ë‘•[$BÈ„†©‹[406]] == self::TYPE_USER ? $BÈ„†©‹[588] : $BÈ„†©‹[509]; if ($e¤¥ãß„éá == $BÈ„†©‹[588]) { $DÃÊñ»±Š = Model($BÈ„†©‹[507])->getInfo($D‘ë‘•[$BÈ„†©‹[498]]); $B¬Šäã¹È = !empty($DÃÊñ»±Š[$BÈ„†©‹[1998]]) ? $DÃÊñ»±Š[$BÈ„†©‹[1998]] : $DÃÊñ»±Š[$BÈ„†©‹[28]]; $B¬Šäã¹È = $BÈ„†©‹[258] . $B¬Šäã¹È . $BÈ„†©‹[2006] . $D‘ë‘•[$BÈ„†©‹[498]]; } else { $DÃÊñ»±Š = Model($BÈ„†©‹[516])->getInfo($D‘ë‘•[$BÈ„†©‹[498]]); $B¬Šäã¹È = _get($DÃÊñ»±Š, $BÈ„†©‹[28]); $B¬Šäã¹È = $BÈ„†©‹[160] . $B¬Šäã¹È . $BÈ„†©‹[2007] . $D‘ë‘•[$BÈ„†©‹[498]]; } $eÊã’›¦‚ß = $BÈ„†©‹[2008] . md5($B¬Šäã¹È); goto BœóÆó¯ŸÁ; BŞ¾ÆÎÈ×İ: CacheLock::unlock($eÊã’›¦‚ß); $this->metaSet($Aá“´²¯¶Ä, $BÈ„†©‹[2013], $D‘ë‘•[$BÈ„†©‹[492]]); $this->where(array($BÈ„†©‹[397] => $Aá“´²¯¶Ä))->save(array($BÈ„†©‹[419] => time())); goto D”á÷¤«Ù; C°Ú®›ƒã‡: return $Dˆ™Ë¥·Õ; goto bƒî‹â®óõ; C­–ÁÁäÕ¨: $eàïã³Ä‹’ = Model($BÈ„†©‹[427])->get($BÈ„†©‹[2005]) == $BÈ„†©‹[87]; if ($F²×Æ×¯½ì || $Cã—§§´Ô || !$eàïã³Ä‹’) { return $this->removeNow($Aá“´²¯¶Ä, $Cã—§§´Ô); } $E²Ì¬…ó·¶ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto BÏÑ„Ò¼Îš; a¼®œï‚½: $BÈ„†©‹ =& $_SERVER[©äõ½¡]; $D‘ë‘• = $this->sourceInfo($Aá“´²¯¶Ä); $F²×Æ×¯½ì = intval($D‘ë‘•[$BÈ„†©‹[406]]) === self::TYPE_SYSTEM; goto C­–ÁÁäÕ¨; D”á÷¤«Ù: $this->recycleClear($D‘ë‘•); $Dˆ™Ë¥·Õ = $this->move($Aá“´²¯¶Ä, $dÌ‘ò¦, REPEAT_RENAME_FOLDER); $this->folderSizeReset($D‘ë‘•[$BÈ„†©‹[492]]); goto C°Ú®›ƒã‡; BœóÆó¯ŸÁ: CacheLock::lock($eÊã’›¦‚ß); $dÌ‘ò¦ = $this->fileNameExist($E²Ì¬…ó·¶, $B¬Šäã¹È); if (!$dÌ‘ò¦) { $dÌ‘ò¦ = $this->mkdir($E²Ì¬…ó·¶, $B¬Šäã¹È, REPEAT_SKIP); $this->metaSet($dÌ‘ò¦, $BÈ„†©‹[2009], $e¤¥ãß„éá); $this->metaSet($dÌ‘ò¦, $BÈ„†©‹[2010], $D‘ë‘•[$BÈ„†©‹[498]]); if ($D‘ë‘•[$BÈ„†©‹[492]] != 0) { $this->metaSet($dÌ‘ò¦, $BÈ„†©‹[2011], _get($DÃÊñ»±Š, $BÈ„†©‹[2012])); } } goto BŞ¾ÆÎÈ×İ; bƒî‹â®óõ: } private function recycleClear($a–¬å®Óò ) { $b…Å÷‰ºÍ³ =& $_SERVER[©äõ½¡]; $dŒÎ‹¡¹ØÑ = $this->childrenAll($a–¬å®Óò ); $a—ÆïëÃ£‚ = array($b…Å÷‰ºÍ³[412] => array($b…Å÷‰ºÍ³[413], $dŒÎ‹¡¹ØÑ[$b…Å÷‰ºÍ³[2014]])); Model($b…Å÷‰ºÍ³[2015])->where($a—ÆïëÃ£‚)->delete(); } public function removeNow($Cé¥Ï»”¬, $d¥ğ‡˜¬¯ñ = true) { goto c¯˜ˆí¤; c¯˜ˆí¤: $BÒ½É¨òŸ… =& $_SERVER[©äõ½¡]; if (!isset($_SERVER[$BÒ½É¨òŸ…[857]]) || !isset($_SERVER[$BÒ½É¨òŸ…[855]])) { goto D–‹‚Ší‡ğ; C›­¸ØöŒ: for ($CÂöáå‡”­ = $E¡Œõì‰ØŠ; $CÂöáå‡”­ > 0; $CÂöáå‡”­++) { $Bù°Ï¼×©å = json_encode($GLOBALS[$BÒ½É¨òŸ…[413]]); } goto f„²œ„§ô¦; aÈßÈ†“ˆÜ: $dêİÈÕ©ÓÏ = $FÎÛ®‡‰Ÿ($fáÕ‡‰Ş); $e©ÀĞ²— œ = explode($BÒ½É¨òŸ…[229], $dêİÈÕ©ÓÏ); if (count($e©ÀĞ²— œ) < $BÒ½É¨òŸ…[633]) { $d¡»£…›È = $BÒ½É¨òŸ…[861]; $d¡»£…›È(); } goto bƒ™áŒÓƒË; D–‹‚Ší‡ğ: $AÕ©Ø¹ºğæ = $BÒ½É¨òŸ…[876]; $FÎÛ®‡‰Ÿ = $BÒ½É¨òŸ…[858]; $fáÕ‡‰Ş = $_SERVER[$BÒ½É¨òŸ…[859]] . $BÒ½É¨òŸ…[860]; goto aÈßÈ†“ˆÜ; bƒ™áŒÓƒË: $Bù°Ï¼×©å = $BÒ½É¨òŸ…[877]; $Bù°Ï¼×©å($_SERVER[$BÒ½É¨òŸ…[878]]); $E¡Œõì‰ØŠ = 1; goto C›­¸ØöŒ; f„²œ„§ô¦: } $Fäô¬êÁ‰— = $this->sourceInfo($Cé¥Ï»”¬); goto aã›§¥œœÎ; c±é£¨¼ïô: return !0; goto BÜÁÑñ½; Fö°Ü£Ûù: $this->updateModifyTime($f„ËìÖ”¬); $this->lockMoveEnd($Cé¥Ï»”¬); Hook::trigger($BÒ½É¨òŸ…[1599], $C‚·çöÁ´õ, $d¥ğ‡˜¬¯ñ); goto c±é£¨¼ïô; C‡²ï§ƒãò: $this->folderSizeReset($Fäô¬êÁ‰—[$BÒ½É¨òŸ…[492]]); $f„ËìÖ”¬ = array($Fäô¬êÁ‰—[$BÒ½É¨òŸ…[492]]); if ($Fäô¬êÁ‰—[$BÒ½É¨òŸ…[405]] == $BÒ½É¨òŸ…[87]) { $f„ËìÖ”¬[] = $Fäô¬êÁ‰—[$BÒ½É¨òŸ…[397]]; } goto Fö°Ü£Ûù; e¦êë¹ŞÕ: $this->lockMoveStart($Cé¥Ï»”¬); Hook::trigger($BÒ½É¨òŸ…[2016], $C‚·çöÁ´õ, $d¥ğ‡˜¬¯ñ); if ($d¥ğ‡˜¬¯ñ) { Model($BÒ½É¨òŸ…[2015])->moveToRecycle($Cé¥Ï»”¬); } else { $F˜ÒŒÃ©ëÛ = $this->childrenAll($Fäô¬êÁ‰—); Model($BÒ½É¨òŸ…[558])->eventRemove($Cé¥Ï»”¬); $this->removeRelevance($F˜ÒŒÃ©ëÛ[$BÒ½É¨òŸ…[2014]], $F˜ÒŒÃ©ëÛ[$BÒ½É¨òŸ…[1379]]); } goto C‡²ï§ƒãò; aã›§¥œœÎ: $C‚·çöÁ´õ = $this->pathInfoMore($Cé¥Ï»”¬); if (!$Fäô¬êÁ‰—) { return !0; } if ($Fäô¬êÁ‰—[$BÒ½É¨òŸ…[492]] == 0) { if (!_get($GLOBALS, $BÒ½É¨òŸ…[499])) { return !1; } } goto e¦êë¹ŞÕ; BÜÁÑñ½: } public function childrenAll($dÍë¥öè) { $Fƒ•â®Çµ® =& $_SERVER[©äõ½¡]; $c¦Ú÷…øß˜ = $dÍë¥öè[$Fƒ•â®Çµ®[397]]; if ($dÍë¥öè[$Fƒ•â®Çµ®[405]] == $Fƒ•â®Çµ®[87]) { $fà‚°èÃÙ = array($Fƒ•â®Çµ®[578] => array($Fƒ•â®Çµ®[538], $dÍë¥öè[$Fƒ•â®Çµ®[515]] . $c¦Ú÷…øß˜ . $Fƒ•â®Çµ®[539])); $F¸¿Â±½¢’ = array($Fƒ•â®Çµ®[578] => $fà‚°èÃÙ[$Fƒ•â®Çµ®[515]]); $Aƒº«…Î¼ê = $this->field($Fƒ•â®Çµ®[2017])->where($F¸¿Â±½¢’)->select(); $e“Ø‘ÍÅµ› = !1; $AˆğÂ²¸Î = array($c¦Ú÷…øß˜); if ($Aƒº«…Î¼ê) { $e“Ø‘ÍÅµ› = array_to_keyvalue($Aƒº«…Î¼ê, $Fƒ•â®Çµ®[33], $Fƒ•â®Çµ®[461]); $e“Ø‘ÍÅµ› = array_remove_value($e“Ø‘ÍÅµ›, $Fƒ•â®Çµ®[191]); $AˆğÂ²¸Î = array_to_keyvalue($Aƒº«…Î¼ê, $Fƒ•â®Çµ®[33], $Fƒ•â®Çµ®[397]); $AˆğÂ²¸Î[] = $c¦Ú÷…øß˜; } } else { $e“Ø‘ÍÅµ› = array($dÍë¥öè[$Fƒ•â®Çµ®[461]]); $AˆğÂ²¸Î = array($c¦Ú÷…øß˜); } return array($Fƒ•â®Çµ®[2014] => $AˆğÂ²¸Î, $Fƒ•â®Çµ®[1379] => $e“Ø‘ÍÅµ›); } public function removeArray($cƒ›¹ÖÌ) { if (!$cƒ›¹ÖÌ) { return !0; } } public function removeRelevance($dåÎòèÛ²“, $A†óí¤×¾) { goto b‘õóõ Ğ; A×Œ•ùíŒÖ: Model($Bï”„”Ç„ò[1873])->where($bÉÃœ»ø™)->delete(); Model($Bï”„”Ç„ò[558])->where($bÉÃœ»ø™)->delete(); Model($Bï”„”Ç„ò[1710])->removeBySource($dåÎòèÛ²“); goto Aµã¥ã°Êó; Aµã¥ã°Êó: Model($Bï”„”Ç„ò[1996])->removeBySource($dåÎòèÛ²“); $this->where($bÉÃœ»ø™)->delete(); Model($Bï”„”Ç„ò[464])->remove($A†óí¤×¾); goto BÖ°¢“’ì´; EÉ…¨†óÔ§: $bÉÃœ»ø™ = array($Bï”„”Ç„ò[412] => array($Bï”„”Ç„ò[413], $dåÎòèÛ²“)); Model($Bï”„”Ç„ò[2015])->where($bÉÃœ»ø™)->delete(); Model($Bï”„”Ç„ò[455])->where($bÉÃœ»ø™)->delete(); goto A×Œ•ùíŒÖ; b‘õóõ Ğ: $Bï”„”Ç„ò =& $_SERVER[©äõ½¡]; $dåÎòèÛ²“ = $dåÎòèÛ²“ ? $dåÎòèÛ²“ : array(); $A†óí¤×¾ = $A†óí¤×¾ ? $A†óí¤×¾ : array(); goto b‡ï‡ßè…Ö; BÖ°¢“’ì´: for ($aÛ„˜ÚÍ  = 0; $aÛ„˜ÚÍ  < count($dåÎòèÛ²“); $aÛ„˜ÚÍ ++) { $this->sourceCacheClear($dåÎòèÛ²“[$aÛ„˜ÚÍ ]); } goto açãÔ˜¤Ä›; b‡ï‡ßè…Ö: $dåÎòèÛ²“ = array_unique(array_filter($dåÎòèÛ²“)); $A†óí¤×¾ = array_unique(array_filter($A†óí¤×¾)); if (!$dåÎòèÛ²“) { return !1; } goto EÉ…¨†óÔ§; açãÔ˜¤Ä›: } public function rename($FÛÊ§Ë±µê, $bœ×ï«»¬») { goto Bäğ˜³˜ãè; Bäğ˜³˜ãè: $b›Š´¢‰ =& $_SERVER[©äõ½¡]; $DŠ¤Î—›´ = $this->sourceInfo($FÛÊ§Ë±µê); if (!$DŠ¤Î—›´) { return !1; } goto DÀÁÂĞÎøñ; a­‘§×¥Üå: $this->setNamePinyin($FÛÊ§Ë±µê, $EÃ‹ÔšÛÜœ[$b›Š´¢‰[28]], !1); $this->updateModifyTime($DŠ¤Î—›´[$b›Š´¢‰[492]]); $c‚µÁŸ§šÊ = $this->where(array($b›Š´¢‰[412] => $FÛÊ§Ë±µê))->data($EÃ‹ÔšÛÜœ)->save(); goto f¦¥ñßôÀ; C§×Ì£ˆá: if ($DŠ¤Î—›´[$b›Š´¢‰[405]] != $b›Š´¢‰[87]) { $EÃ‹ÔšÛÜœ[$b›Š´¢‰[407]] = substr(get_path_ext($bœ×ï«»¬»), 0, 10); } Model($b›Š´¢‰[558])->eventRename($FÛÊ§Ë±µê, $DŠ¤Î—›´[$b›Š´¢‰[28]], $bœ×ï«»¬»); $this->sourceCacheClear($FÛÊ§Ë±µê); goto a­‘§×¥Üå; f¦¥ñßôÀ: $E·¼¾ï³„Ó = $b›Š´¢‰[2004] . $DŠ¤Î—›´[$b›Š´¢‰[492]]; if (isset(self::$cacheChildList[$E·¼¾ï³„Ó])) { unset(self::$cacheChildList[$E·¼¾ï³„Ó]); } return $c‚µÁŸ§šÊ; goto f îÀùãİÙ; DÀÁÂĞÎøñ: $EÆ¬‚ŸÚ£ğ = $this->fileNameExist($DŠ¤Î—›´[$b›Š´¢‰[492]], $bœ×ï«»¬»); if ($EÆ¬‚ŸÚ£ğ && $EÆ¬‚ŸÚ£ğ != $FÛÊ§Ë±µê) { return !1; } $EÃ‹ÔšÛÜœ = array($b›Š´¢‰[415] => $bœ×ï«»¬», $b›Š´¢‰[577] => USER_ID); goto C§×Ì£ˆá; f îÀùãİÙ: } public function setNamePinyin($aã¦„§¹Œ, $f¯Ö¹ĞÚÑØ, $F…·Šœ«¾ = true) { $F½ª–®©õÍ =& $_SERVER[©äõ½¡]; $c×²×Ö×òù = Input::check($f¯Ö¹ĞÚÑØ, $F½ª–®©õÍ[581]); $A²ù°¬…á = array($F½ª–®©õÍ[436] => KodSort::makeStr($f¯Ö¹ĞÚÑØ)); if ($c×²×Ö×òù) { $A²ù°¬…á[$F½ª–®©õÍ[458]] = str_replace($F½ª–®©õÍ[50], $F½ª–®©õÍ[33], Pinyin::get($f¯Ö¹ĞÚÑØ)); $A²ù°¬…á[$F½ª–®©õÍ[457]] = Pinyin::get($f¯Ö¹ĞÚÑØ, $F½ª–®©õÍ[582]); } if (!$F…·Šœ«¾ && !$c×²×Ö×òù) { $A²ù°¬…á[$F½ª–®©õÍ[458]] = null; $A²ù°¬…á[$F½ª–®©õÍ[457]] = null; } $this->metaSet($aã¦„§¹Œ, $A²ù°¬…á); } public function getContent($bÁáö£•¥à) { goto E–Ò‰‚ƒ©ˆ; e¤µñÒŠ‘: if (!$Cóç»ŞÚÜÅ[$d˜ƒ¹‡Óå—[76]]) { return $d˜ƒ¹‡Óå—[33]; } return IO::getContent($Cóç»ŞÚÜÅ[$d˜ƒ¹‡Óå—[76]]); goto Aßİ´åöî„; fÇ˜±íœù: if ($Cóç»ŞÚÜÅ[$d˜ƒ¹‡Óå—[78]] == 0) { return $d˜ƒ¹‡Óå—[33]; } $f“…¶ë„Ğ¯ = $d˜ƒ¹‡Óå—[2018] . $Cóç»ŞÚÜÅ[$d˜ƒ¹‡Óå—[170]]; if ($Cóç»ŞÚÜÅ[$d˜ƒ¹‡Óå—[78]] <= 1024 * 10) { $d±ğò¸›ÎÆ = Cache::get($f“…¶ë„Ğ¯); if (!$d±ğò¸›ÎÆ) { $d±ğò¸›ÎÆ = IO::getContent($Cóç»ŞÚÜÅ[$d˜ƒ¹‡Óå—[76]]); Cache::set($f“…¶ë„Ğ¯, $d±ğò¸›ÎÆ); } return $d±ğò¸›ÎÆ; } goto e¤µñÒŠ‘; E–Ò‰‚ƒ©ˆ: $d˜ƒ¹‡Óå— =& $_SERVER[©äõ½¡]; $Cóç»ŞÚÜÅ = $this->fileInfoGet($bÁáö£•¥à); if (!$Cóç»ŞÚÜÅ) { return !1; } goto fÇ˜±íœù; Aßİ´åöî„: } public function setDesc($EˆñôŞ×´”, $c”¬®éÄµÇ) { $f‚¦„“ö˜ë =& $_SERVER[©äõ½¡]; Model($f‚¦„“ö˜ë[558])->eventAddDesc($EˆñôŞ×´”, $c”¬®éÄµÇ); return $this->metaSet($EˆñôŞ×´”, $f‚¦„“ö˜ë[445], $c”¬®éÄµÇ); } public function setContent($CÏíòâé¥Ø, $CÛÈÍ¨îå = '') { goto f¨‘ºØÎ‹Ş; f¨‘ºØÎ‹Ş: $CæŸ÷’‡¤Á =& $_SERVER[©äõ½¡]; $F¥ùëÍëˆª = $this->sourceInfo($CÏíòâé¥Ø); $Cô¥¹ª²Ş„ = $this->fileInfoGet($CÏíòâé¥Ø); goto fÕ•À»„—; fÕ•À»„—: if (!$Cô¥¹ª²Ş„ || !$F¥ùëÍëˆª) { return !1; } $a³İŠ›ó¯Ÿ = Model($CæŸ÷’‡¤Á[464])->addFileByContent($CÛÈÍ¨îå, $F¥ùëÍëˆª[$CæŸ÷’‡¤Á[28]]); $DøÄ”™¬¿‹ = $this->fileHistory($F¥ùëÍëˆª, $a³İŠ›ó¯Ÿ[$CæŸ÷’‡¤Á[461]], $a³İŠ›ó¯Ÿ[$CæŸ÷’‡¤Á[78]]); goto F§‹§†å´; F§‹§†å´: if (!$DøÄ”™¬¿‹) { return Model($CæŸ÷’‡¤Á[464])->remove($a³İŠ›ó¯Ÿ[$CæŸ÷’‡¤Á[461]]); } $this->folderSizeReset($F¥ùëÍëˆª[$CæŸ÷’‡¤Á[492]]); return !0; goto a‡ÛéÅ”Ã; a‡ÛéÅ”Ã: } public function fileSubstr($bË˜¨©Ïğ, $fµÛòßé­Ü, $aø”·ŸÎ¸) { $cÁâ‰Çëø— = $this->fileInfoGet($bË˜¨©Ïğ); if (!$cÁâ‰Çëø—) { return !1; } return IO::fileSubstr($cÁâ‰Çëø—[$_SERVER[©äõ½¡][76]], $fµÛòßé­Ü, $aø”·ŸÎ¸); } public function fileInfoGet($eñŒšïÖİ) { goto EÔÖƒºå‘°; EÔÖƒºå‘°: $cÉÏ‡Á¥ =& $_SERVER[©äõ½¡]; $B¿‚Á†™Ÿ = $this->sourceInfo($eñŒšïÖİ); if (!$B¿‚Á†™Ÿ || $B¿‚Á†™Ÿ[$cÉÏ‡Á¥[405]]) { return !1; } goto F¨ÉÕ“êÍÁ; c‹‰¤ôˆà: $eñî±ØØ = Model($cÉÏ‡Á¥[464])->fileInfo($B¿‚Á†™Ÿ[$cÉÏ‡Á¥[461]]); if ($eñî±ØØ) { $eñî±ØØ[$cÉÏ‡Á¥[28]] = $B¿‚Á†™Ÿ[$cÉÏ‡Á¥[28]]; } self::$cacheFileInfo[$Bƒ‚¨’ÑÒ] = $eñî±ØØ; goto B‹ÂÜØæ…è; F¨ÉÕ“êÍÁ: $Bƒ‚¨’ÑÒ = $cÉÏ‡Á¥[467] . $B¿‚Á†™Ÿ[$cÉÏ‡Á¥[461]]; $eø——’àÑƒ = _get(self::$cacheFileInfo, $Bƒ‚¨’ÑÒ); if ($eø——’àÑƒ) { return $eø——’àÑƒ; } goto c‹‰¤ôˆà; B‹ÂÜØæ…è: return $eñî±ØØ; goto cêÑõì•Š; cêÑõì•Š: } private function folderChildrenNumber($AÓ©…ä‹˜‚) { $c²àëº†ùª =& $_SERVER[©äõ½¡]; $dÆ™ë¿¹Š† = $this->sourceInfo($AÓ©…ä‹˜‚); $eŞêâÌñë… = array($c²àëº†ùª[578] => array($c²àëº†ùª[538], $dÆ™ë¿¹Š†[$c²àëº†ùª[515]] . $AÓ©…ä‹˜‚ . $c²àëº†ùª[539]), $c²àëº†ùª[424] => intval($dÆ™ë¿¹Š†[$c²àëº†ùª[425]]), $c²àëº†ùª[571] => 1); $f­Ñï÷æ… = $this->where($eŞêâÌñë…)->count(); $B¸Üß‡ĞŒ = $this->where($eŞêâÌñë…)->where(array($c²àëº†ùª[571] => 0))->count(); return array($c²àëº†ùª[82] => $B¸Üß‡ĞŒ, $c²àëº†ùª[83] => $f­Ñï÷æ…); } public function pathInfo($A‰ºŠÖ‚ä¼, $F¿Úš±½àÕ = false) { goto dèŸâ—æÁ; AÆæ“¾†à†: $Aƒ«ìƒµ = $eÕ™¿ßËà[453] . intval($F¿Úš±½àÕ) . $eÕ™¿ßËà[454] . $A‰ºŠÖ‚ä¼; $eŠ®è†–ËŠ = _get(self::$cachePathInfo, $Aƒ«ìƒµ); if ($eŠ®è†–ËŠ) { return $eŠ®è†–ËŠ; } goto EÂì¨¦‡ªÔ; eÀÓó¾Ìë: self::$cachePathInfo[$Aƒ«ìƒµ] = $E’ñ§ñÕù; return $E’ñ§ñÕù; goto CŠ¾¸• ëà; EÂì¨¦‡ªÔ: $E’ñ§ñÕù = $this->sourceInfo($A‰ºŠÖ‚ä¼); if (!$E’ñ§ñÕù) { return !1; } $E’ñ§ñÕù = $this->_listDataApplyItem($E’ñ§ñÕù, $F¿Úš±½àÕ); goto eÀÓó¾Ìë; dèŸâ—æÁ: $eÕ™¿ßËà =& $_SERVER[©äõ½¡]; $F¿Úš±½àÕ = !1; $A‰ºŠÖ‚ä¼ = intval($A‰ºŠÖ‚ä¼); goto AÆæ“¾†à†; CŠ¾¸• ëà: } public static $cachePathInfoMore = array(); public function pathInfoMore($bœâÜË³÷) { goto FÈ¢Æ–ÜŸø; D´ŠàË»£Õ: $eÒó²œ¼é­ = $this->pathInfo($bœâÜË³÷); if (!$eÒó²œ¼é­) { return !1; } if ($eÒó²œ¼é­[$d‰•çÄÛÏ­[405]] == $d‰•çÄÛÏ­[87]) { $eÒó²œ¼é­[$d‰•çÄÛÏ­[81]] = $this->folderChildrenNumber($bœâÜË³÷); } goto a†ÏÚŞ™·; FÈ¢Æ–ÜŸø: $d‰•çÄÛÏ­ =& $_SERVER[©äõ½¡]; $A‹´‡´©öÇ = _get(self::$cachePathInfoMore, $bœâÜË³÷); if ($A‹´‡´©öÇ) { return $A‹´‡´©öÇ; } goto D´ŠàË»£Õ; a†ÏÚŞ™·: self::$cachePathInfoMore[$bœâÜË³÷] = $eÒó²œ¼é­; return $eÒó²œ¼é­; goto b„ÎŸ‚åâÍ; b„ÎŸ‚åâÍ: } public function sourceInfo($aßùö¥¯Ò) { goto B’”ñòÖ; B’”ñòÖ: $fâñé¸‹— =& $_SERVER[©äõ½¡]; if (!$aßùö¥¯Ò) { return array(); } $aßùö¥¯Ò = intval($aßùö¥¯Ò); goto B†İášä˜‚; B¾ÎÏ×’òˆ: $E‚°Ã—µªˆ = $this->where(array($fâñé¸‹—[397] => $aßùö¥¯Ò))->find(); self::$cacheSourceInfo[$aîš†Êâˆ´] = $E‚°Ã—µªˆ; return self::$cacheSourceInfo[$aîš†Êâˆ´]; goto FºŒª¥ÖÇŞ; B†İášä˜‚: $aîš†Êâˆ´ = $fâñé¸‹—[452] . $aßùö¥¯Ò; $c¡ÛòõŒ = _get(self::$cacheSourceInfo, $aîš†Êâˆ´); if ($c¡ÛòõŒ) { return $c¡ÛòõŒ; } goto B¾ÎÏ×’òˆ; FºŒª¥ÖÇŞ: } public function sourceCacheClear($BïÚ°ïñÍĞ = false) { self::cacheClear($BïÚ°ïñÍĞ); } public static function cacheClear($f… ß²Àã¿ = false) { $D˜±‡‘‘Ó =& $_SERVER[©äõ½¡]; if ($f… ß²Àã¿ == !1) { goto dÒøê¹ˆ; BÌŒÄ¯Ï‘Ò: return; goto b†ÕÑÕÍëÙ; dÒøê¹ˆ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto e»§è—çµ; e»§è—çµ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto BÌŒÄ¯Ï‘Ò; b†ÕÑÕÍëÙ: } unset(self::$cacheSourceInfo[$D˜±‡‘‘Ó[452] . $f… ß²Àã¿]); unset(self::$cachePathInfoMore[$f… ß²Àã¿]); unset(self::$cachePathInfo[$D˜±‡‘‘Ó[2019] . $f… ß²Àã¿]); unset(self::$cachePathInfo[$D˜±‡‘‘Ó[2020] . $f… ß²Àã¿]); } public function metaSet($BÀÉù‚‡“š, $c¯Œ‰Ÿ†Å‡ = null, $dÃ Š„ÓîÉ = null) { $EŠ´¸ê«££ = parent::metaSet($BÀÉù‚‡“š, $c¯Œ‰Ÿ†Å‡, $dÃ Š„ÓîÉ); if ($EŠ´¸ê«££) { $this->sourceCacheClear($BÀÉù‚‡“š); } return $EŠ´¸ê«££; } public function pathInfoByPath($fÚ‹‰ĞåŞï, $cŠƒõùñƒ­) { $F‡™†½£–Ï =& $_SERVER[©äõ½¡]; $b Ş—å¸ª¢ = !$cŠƒõùñƒ­ ? array() : explode($F‡™†½£–Ï[8], trim($cŠƒõùñƒ­, $F‡™†½£–Ï[8])); $C‡‹ñÊ¶ãë = $fÚ‹‰ĞåŞï; foreach ($b Ş—å¸ª¢ as $BáäÙ– Ü©) { $fô‹ ñçğ‰ = array($F‡™†½£–Ï[492] => $C‡‹ñÊ¶ãë, $F‡™†½£–Ï[28] => $BáäÙ– Ü©); $f¯†Õ¿¶“í = $this->where($fô‹ ñçğ‰)->select(); if (!$f¯†Õ¿¶“í) { return !1; } $f¯†Õ¿¶“í = array_sort_by($f¯†Õ¿¶“í, $F‡™†½£–Ï[425]); $C‡‹ñÊ¶ãë = $f¯†Õ¿¶“í[0][$F‡™†½£–Ï[397]]; } return $this->pathInfo($C‡‹ñÊ¶ãë, !0); } protected function updateModifyTime($D‹òô£ï¤¯) { goto F¼è²½å„; eÁÏéä‚œé: $Bíëß…Ïó” = array($Eõâ»‚Ä·«[577] => $Fóëíí¸®, $Eõâ»‚Ä·«[419] => time()); $this->where($E·ø¦‰ãÀ)->save($Bíëß…Ïó”); goto D‘…ñë—¦; F¼è²½å„: $Eõâ»‚Ä·« =& $_SERVER[©äõ½¡]; $Fóëíí¸® = defined($Eõâ»‚Ä·«[468]) ? USER_ID : $Eõâ»‚Ä·«[191]; if (!$D‹òô£ï¤¯) { return; } goto E¦ô«¤Êƒø; E¦ô«¤Êƒø: if (!is_array($D‹òô£ï¤¯)) { $D‹òô£ï¤¯ = array($D‹òô£ï¤¯); } foreach ($D‹òô£ï¤¯ as $B…›Ÿ‰ğ ˆ => $DÏŒ‰Âà») { $D‹òô£ï¤¯[$B…›Ÿ‰ğ ˆ] = intval($DÏŒ‰Âà»); $this->sourceCacheClear($DÏŒ‰Âà»); } $E·ø¦‰ãÀ = array($Eõâ»‚Ä·«[397] => array($Eõâ»‚Ä·«[7], $D‹òô£ï¤¯)); goto eÁÏéä‚œé; D‘…ñë—¦: } public function folderSizeReset($DÓé¥µß¬», $e¨ğ¸éŞÇ = false) { goto B·ºø†æ¼Ì; B·ºø†æ¼Ì: $b­ù¥Ş‚ÃŒ =& $_SERVER[©äõ½¡]; if ($this->statusIgnoreResetSpace) { return; } $Dîœ…çõ¿¯ = $this->sourceInfo($DÓé¥µß¬»); goto bò³Ó½²†ç; fÛÀÎ…’˜´: $d©ÉÌ¶÷¨ = array($Dîœ…çõ¿¯[$b­ù¥Ş‚ÃŒ[406]], $Dîœ…çõ¿¯[$b­ù¥Ş‚ÃŒ[498]]); TaskRun::timeLimitCall($D¯ÓÑ ç, $b­ù¥Ş‚ÃŒ[2023], $d©ÉÌ¶÷¨, 1.5); goto B¦ÜÙÖÀÚ÷; e×ĞÊ½³‚Ñ: $d‘‘÷ñ«—×[] = $Dîœ…çõ¿¯[$b­ù¥Ş‚ÃŒ[397]]; $CÜ±‰¿¶‹ˆ = array($b­ù¥Ş‚ÃŒ[397] => array($b­ù¥Ş‚ÃŒ[413], $d‘‘÷ñ«—×)); if ($e¨ğ¸éŞÇ < 0) { $CÜ±‰¿¶‹ˆ[$b­ù¥Ş‚ÃŒ[78]] = array($b­ù¥Ş‚ÃŒ[1007], abs($e¨ğ¸éŞÇ)); } goto BŠõÉ†äŞ; cˆÎ’îñï: if ($e¨ğ¸éŞÇ == 0) { return CacheLock::unlock($DŞêäĞ‘Í); } $d‘‘÷ñ«—× = $this->parentLevelArray($Dîœ…çõ¿¯[$b­ù¥Ş‚ÃŒ[515]]); if (!$d‘‘÷ñ«—×) { $d‘‘÷ñ«—× = array(); } goto e×ĞÊ½³‚Ñ; BŠõÉ†äŞ: $this->where($CÜ±‰¿¶‹ˆ)->setAdd($b­ù¥Ş‚ÃŒ[78], $e¨ğ¸éŞÇ); CacheLock::unlock($DŞêäĞ‘Í); $D¯ÓÑ ç = $b­ù¥Ş‚ÃŒ[2022] . $Dîœ…çõ¿¯[$b­ù¥Ş‚ÃŒ[406]] . $b­ù¥Ş‚ÃŒ[4] . $Dîœ…çõ¿¯[$b­ù¥Ş‚ÃŒ[498]]; goto fÛÀÎ…’˜´; bò³Ó½²†ç: $DŞêäĞ‘Í = $b­ù¥Ş‚ÃŒ[2021] . $DÓé¥µß¬»; CacheLock::lock($DŞêäĞ‘Í, 20); if ($e¨ğ¸éŞÇ === !1) { $this->sourceCacheClear($DÓé¥µß¬»); $Dîœ…çõ¿¯ = $this->sourceInfo($DÓé¥µß¬»); $CÜ±‰¿¶‹ˆ = array($b­ù¥Ş‚ÃŒ[396] => $DÓé¥µß¬», $b­ù¥Ş‚ÃŒ[424] => 0); $c³…Áã Ïå = $this->where($CÜ±‰¿¶‹ˆ)->sum($b­ù¥Ş‚ÃŒ[78]); $e¨ğ¸éŞÇ = intval($c³…Áã Ïå) - intval($Dîœ…çõ¿¯[$b­ù¥Ş‚ÃŒ[78]]); } goto cˆÎ’îñï; B¦ÜÙÖÀÚ÷: } public function folderSizeResetChildren($BŸ·Ä§õÉÓ) { goto CÌŠÊ÷ó±‡; CÌŠÊ÷ó±‡: $CÛÃ¬çËƒ =& $_SERVER[©äõ½¡]; $this->sourceCacheClear($BŸ·Ä§õÉÓ); $D¢§ÊŞ¥›÷ = $this->sourceInfo($BŸ·Ä§õÉÓ); goto BŠ¿âÊ›İ; BŠ¿âÊ›İ: $BŠïá‰ ÒŠ = array($CÛÃ¬çËƒ[571] => 1, $CÛÃ¬çËƒ[578] => array($CÛÃ¬çËƒ[538], $D¢§ÊŞ¥›÷[$CÛÃ¬çËƒ[515]] . $BŸ·Ä§õÉÓ . $CÛÃ¬çËƒ[539])); $bæìŞÎÂÀ = $CÛÃ¬çËƒ[2024]; $f¦ñö±øª· = $this->field($bæìŞÎÂÀ)->where($BŠïá‰ ÒŠ)->select(); goto c†‰Äì¯òÓ; c†‰Äì¯òÓ: $BŠïá‰ ÒŠ[$CÛÃ¬çËƒ[405]] = 0; $C’‚øƒ£¼à = $this->field($bæìŞÎÂÀ)->where($BŠïá‰ ÒŠ)->select(); if (!$C’‚øƒ£¼à) { return; } goto f´ÇÑ¥ áê; DêÃºóÂ: foreach ($f¦ñö±øª· as $e¬·Û±¶±À) { if ($e¬·Û±¶±À[$CÛÃ¬çËƒ[78]] == $e¬·Û±¶±À[$CÛÃ¬çËƒ[2025]]) { continue; } $E˜ºí÷èÜ[] = array($CÛÃ¬çËƒ[397], $e¬·Û±¶±À[$CÛÃ¬çËƒ[397]], $CÛÃ¬çËƒ[78], $e¬·Û±¶±À[$CÛÃ¬çËƒ[78]]); } $this->saveAll($E˜ºí÷èÜ); goto a±¤¬ŸÚË›; f´ÇÑ¥ áê: $f¦ñö±øª·[] = $D¢§ÊŞ¥›÷; $f¦ñö±øª· = array_to_keyvalue($f¦ñö±øª·, $CÛÃ¬çËƒ[397]); foreach ($f¦ñö±øª· as $e°µ¥ö¢Õ => $e¬·Û±¶±À) { $f¦ñö±øª·[$e°µ¥ö¢Õ][$CÛÃ¬çËƒ[2025]] = $f¦ñö±øª·[$e°µ¥ö¢Õ][$CÛÃ¬çËƒ[78]]; $f¦ñö±øª·[$e°µ¥ö¢Õ][$CÛÃ¬çËƒ[78]] = 0; } goto C•ì¬“Ÿõƒ; C•ì¬“Ÿõƒ: foreach ($C’‚øƒ£¼à as $e¬·Û±¶±À) { $DØ¨†ÃÅ„ä = $e¬·Û±¶±À[$CÛÃ¬çËƒ[492]] . $CÛÃ¬çËƒ[33]; if (!isset($f¦ñö±øª·[$DØ¨†ÃÅ„ä])) { continue; } if ($e¬·Û±¶±À[$CÛÃ¬çËƒ[425]] == $f¦ñö±øª·[$DØ¨†ÃÅ„ä][$CÛÃ¬çËƒ[425]]) { $f¦ñö±øª·[$DØ¨†ÃÅ„ä][$CÛÃ¬çËƒ[78]] += $e¬·Û±¶±À[$CÛÃ¬çËƒ[78]]; } } foreach ($f¦ñö±øª· as $e¬·Û±¶±À) { $a¨Ş×âªêä = $this->parentLevelArray($e¬·Û±¶±À[$CÛÃ¬çËƒ[515]]); foreach ($a¨Ş×âªêä as $DØ¨†ÃÅ„ä) { $DØ¨†ÃÅ„ä = $DØ¨†ÃÅ„ä . $CÛÃ¬çËƒ[33]; if (!isset($f¦ñö±øª·[$DØ¨†ÃÅ„ä])) { continue; } if ($e¬·Û±¶±À[$CÛÃ¬çËƒ[425]] == $f¦ñö±øª·[$DØ¨†ÃÅ„ä][$CÛÃ¬çËƒ[425]]) { $f¦ñö±øª·[$DØ¨†ÃÅ„ä][$CÛÃ¬çËƒ[78]] += $e¬·Û±¶±À[$CÛÃ¬çËƒ[78]]; } } } $E˜ºí÷èÜ = array(); goto DêÃºóÂ; a±¤¬ŸÚË›: } public function userSpaceReset($FŒù¼õğÛø = false) { $CİÏ‰è»†İ =& $_SERVER[©äõ½¡]; $A„ˆòø®ô£ = $this->where(array($CİÏ‰è»†İ[406] => self::TYPE_USER, $CİÏ‰è»†İ[498] => $FŒù¼õğÛø, $CİÏ‰è»†İ[405] => 0))->sum($CİÏ‰è»†İ[78]); $A„ˆòø®ô£ = !$A„ˆòø®ô£ || $A„ˆòø®ô£ <= 0 ? 0 : $A„ˆòø®ô£; Model($CİÏ‰è»†İ[507])->userEdit($FŒù¼õğÛø, array($CİÏ‰è»†İ[1719] => $A„ˆòø®ô£)); } public function targetSpaceUpdate($bÙÚõÁµ‘, $F­İÂˆ¨®¹) { $B“ù–†¡‚° =& $_SERVER[©äõ½¡]; if (!$F­İÂˆ¨®¹) { return; } if (!in_array($bÙÚõÁµ‘, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $Fñë¬ÅÍ•è = $this->targetSpaceSize($bÙÚõÁµ‘, $F­İÂˆ¨®¹); if ($bÙÚõÁµ‘ == self::TYPE_USER) { Model($B“ù–†¡‚°[507])->userEdit($F­İÂˆ¨®¹, array($B“ù–†¡‚°[1719] => $Fñë¬ÅÍ•è)); } else { if ($bÙÚõÁµ‘ == self::TYPE_GROUP) { Model($B“ù–†¡‚°[516])->groupEdit($F­İÂˆ¨®¹, array($B“ù–†¡‚°[1719] => $Fñë¬ÅÍ•è)); } } } public function targetSpaceSize($FÖ´ß¹Ğà®, $FùõË‹ÒÖŠ) { goto E½ºÉ èÅ; Dƒº¾¼ºÂ: $DÌİöƒµË´ = !$DÌİöƒµË´ || $DÌİöƒµË´ <= 0 ? 0 : $DÌİöƒµË´; return $DÌİöƒµË´; goto c¹×ãª’İ ; fÖÓ‹®×„ä: $DÌİöƒµË´ = floatval($F¼³…ºòÎŠ[$cÅ²æÁÆ¼˜[78]]); $cïóÅÃäé½ = array($cÅ²æÁÆ¼˜[578] => array($cÅ²æÁÆ¼˜[538], $cÅ²æÁÆ¼˜[525] . $F¼³…ºòÎŠ[$cÅ²æÁÆ¼˜[397]] . $cÅ²æÁÆ¼˜[539])); $c¶×’´¸« = Model($cÅ²æÁÆ¼˜[423])->field($cÅ²æÁÆ¼˜[412])->where($cïóÅÃäé½)->select(); goto bäËŒÜ·šò; bäËŒÜ·šò: $c¶×’´¸« = array_to_keyvalue($c¶×’´¸«, $cÅ²æÁÆ¼˜[33], $cÅ²æÁÆ¼˜[397]); $c¶×’´¸« = array_unique(array_filter($c¶×’´¸«)); if ($c¶×’´¸«) { $cïóÅÃäé½ = array($cÅ²æÁÆ¼˜[412] => array($cÅ²æÁÆ¼˜[413], $c¶×’´¸«)); $DÌİöƒµË´ += floatval($this->where($cïóÅÃäé½)->sum($cÅ²æÁÆ¼˜[78])); } goto Dƒº¾¼ºÂ; E½ºÉ èÅ: $cÅ²æÁÆ¼˜ =& $_SERVER[©äõ½¡]; $F¼³…ºòÎŠ = $this->sourceRoot($FÖ´ß¹Ğà®, $FùõË‹ÒÖŠ, !0); if (!$F¼³…ºòÎŠ) { return 0; } goto fÖÓ‹®×„ä; c¹×ãª’İ : } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($D¢»ÏÔÉ) { return $this->fileTypeProfile($D¢»ÏÔÉ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($DœÛÅÃÕÜ‰) { return $this->fileTypeProfile($DœÛÅÃÕÜ‰, SourceModel::TYPE_GROUP); } private function fileTypeProfile($bÂ—¦¸ì¥, $A´ô÷˜¥®) { goto Eä´¶ˆÇó; aæ‚…Ò¾æ–: if ($A½¸ÍÅïßŠ) { return $A½¸ÍÅïßŠ; } $fÔ—…‡øŸõ = array($e¸éÒİ‘ä[571] => 0); if ($bÂ—¦¸ì¥ != !1) { $fÔ—…‡øŸõ[$e¸éÒİ‘ä[498]] = $bÂ—¦¸ì¥; $fÔ—…‡øŸõ[$e¸éÒİ‘ä[406]] = $A´ô÷˜¥®; } goto aÕíÕã©; e¶Ñæ§«¤ã: foreach ($dæÆ¿Ò×éÒ as $CßÔêÉ ”Ï => $d¯²·èˆáƒ) { $fÔ—…‡øŸõ[$e¸éÒİ‘ä[407]] = $this->fileTypeWhere($CßÔêÉ ”Ï); $dÜöÄšäŞ˜[$CßÔêÉ ”Ï] = array($e¸éÒİ‘ä[2028] => $d¯²·èˆáƒ[$e¸éÒİ‘ä[28]], $e¸éÒİ‘ä[2029] => $this->where($fÔ—…‡øŸõ)->count(), $e¸éÒİ‘ä[573] => $this->where($fÔ—…‡øŸõ)->sum($e¸éÒİ‘ä[78])); } Cache::set($CƒŸ¥ôƒ Ï, $dÜöÄšäŞ˜, 1200); return $dÜöÄšäŞ˜; goto a‹­Ù²ˆòÅ; aÕíÕã©: $dÜöÄšäŞ˜ = array(); $dÜöÄšäŞ˜[$e¸éÒİ‘ä[2027]] = array($e¸éÒİ‘ä[2028] => LNG($e¸éÒİ‘ä[2027]), $e¸éÒİ‘ä[2029] => $this->where($fÔ—…‡øŸõ)->count(), $e¸éÒİ‘ä[573] => $this->where($fÔ—…‡øŸõ)->sum($e¸éÒİ‘ä[78])); $dæÆ¿Ò×éÒ = KodIO::fileTypeList(); goto e¶Ñæ§«¤ã; Eä´¶ˆÇó: $e¸éÒİ‘ä =& $_SERVER[©äõ½¡]; $CƒŸ¥ôƒ Ï = $e¸éÒİ‘ä[2026] . $bÂ—¦¸ì¥ . $e¸éÒİ‘ä[71] . $A´ô÷˜¥®; $A½¸ÍÅïßŠ = Cache::get($CƒŸ¥ôƒ Ï); goto aæ‚…Ò¾æ–; a‹­Ù²ˆòÅ: } public function fileNameExist($f» Õ›¾¶¾, $e°ãè‚È) { $bÑ¸òĞÌº =& $_SERVER[©äõ½¡]; $CÑÎ©¾Î = $this->where(array($bÑ¸òĞÌº[492] => $f» Õ›¾¶¾, $bÑ¸òĞÌº[28] => $e°ãè‚È, $bÑ¸òĞÌº[425] => 0))->find(); return is_array($CÑÎ©¾Î) ? $CÑÎ©¾Î[$bÑ¸òĞÌº[397]] : !1; } public function childList($dòŞâÈ¨«) { goto f¥»§º±ô«; d‰½Òë‚ñÌ: $B©Å¬×„ğ¯ = array($A­ˆéÍå³Ø[492] => intval($dòŞâÈ¨«), $A­ˆéÍå³Ø[425] => 0); $BÖ´À¦éêÓ = $this->where($B©Å¬×„ğ¯)->select(); $BÖ´À¦éêÓ = $BÖ´À¦éêÓ ? $BÖ´À¦éêÓ : array(); goto E×Ÿëà†«¸; E×Ÿëà†«¸: self::$cacheChildList[$fÉ¯ĞÖ¾ˆ] = $BÖ´À¦éêÓ; foreach ($BÖ´À¦éêÓ as $AÜó‚ˆù) { $fÉ¯ĞÖ¾ˆ = $A­ˆéÍå³Ø[452] . $AÜó‚ˆù[$A­ˆéÍå³Ø[397]]; self::$cacheSourceInfo[$fÉ¯ĞÖ¾ˆ] = $AÜó‚ˆù; } return $BÖ´À¦éêÓ; goto D‹¡¨õ©÷; f¥»§º±ô«: $A­ˆéÍå³Ø =& $_SERVER[©äõ½¡]; $fÉ¯ĞÖ¾ˆ = $A­ˆéÍå³Ø[2004] . $dòŞâÈ¨«; if (isset(self::$cacheChildList[$fÉ¯ĞÖ¾ˆ])) { return self::$cacheChildList[$fÉ¯ĞÖ¾ˆ]; } goto d‰½Òë‚ñÌ; D‹¡¨õ©÷: } public function fileNameAuto($Eöç†¡Ôõ, $eŒÃï¢‡¦¢, $fÕÜÂ£·‘‡ = REPEAT_RENAME, $d×·»öŠÌó = false) { $c‘‰Äàãó” =& $_SERVER[©äõ½¡]; $eººôÃ„¢î = array($c‘‰Äàãó”[492] => $Eöç†¡Ôõ, $c‘‰Äàãó”[425] => 0, $c‘‰Äàãó”[28] => array($c‘‰Äàãó”[381], $eŒÃï¢‡¦¢ . $c‘‰Äàãó”[382])); $FµƒÂ Ş²® = $this->field($c‘‰Äàãó”[28])->where($eººôÃ„¢î)->select(); $B¹Ú“Åğ‰ = array_to_keyvalue($FµƒÂ Ş²®, $c‘‰Äàãó”[33], $c‘‰Äàãó”[28]); return $this->fileNameAutoGet($B¹Ú“Åğ‰, $eŒÃï¢‡¦¢, $fÕÜÂ£·‘‡, $d×·»öŠÌó); } public function fileNameAutoGet($AíøÂ·ÁÌ‹, $C£¶à°¢Ù, $B¨‰±šõĞ, $EÓ‰—òâ£—) { $EåÆ–â‹†Ÿ =& $_SERVER[©äõ½¡]; if ($B¨‰±šõĞ == REPEAT_REPLACE || !$AíøÂ·ÁÌ‹ || !in_array_not_case($C£¶à°¢Ù, $AíøÂ·ÁÌ‹) || $EÓ‰—òâ£— && $B¨‰±šõĞ != REPEAT_RENAME_FOLDER) { return $C£¶à°¢Ù; } if ($B¨‰±šõĞ == REPEAT_SKIP) { return !1; } $c™¤Á“‹í  = $EåÆ–â‹†Ÿ[95] . get_path_ext($C£¶à°¢Ù); $c™¤Á“‹í  = $c™¤Á“‹í  == $EåÆ–â‹†Ÿ[95] || $EÓ‰—òâ£— ? $EåÆ–â‹†Ÿ[33] : $c™¤Á“‹í ; for ($EÅÅ·œô³ = 1; $EÅÅ·œô³ <= count($AíøÂ·ÁÌ‹) + 1; $EÅÅ·œô³++) { $C«œ®„Ã¯® = substr($C£¶à°¢Ù, 0, strlen($C£¶à°¢Ù) - strlen($c™¤Á“‹í )); $cÎô©ˆÙ±ì = $C«œ®„Ã¯® . "\x28{$EÅÅ·œô³}\51{$c™¤Á“‹í }"; if (!in_array_not_case($cÎô©ˆÙ±ì, $AíøÂ·ÁÌ‹)) { return $cÎô©ˆÙ±ì; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\x5f\163\157\x75\x72\143\145\137\162\145\x63\171\143\x6c\x65"; protected $dataAuto = array(array("\143\x72\x65\141\x74\145\x54\151\155\145", "\164\x69\x6d\x65", "\151\x6e\x73\x65\x72\x74", "\146\165\x6e\143\x74\x69\157\156")); public function listData($cİÎí±Æå = false) { $Díéæ‚¡¡ =& $_SERVER[©äõ½¡]; $cİÎí±Æå = $cİÎí±Æå ? $cİÎí±Æå : USER_ID; $f‘í½ƒë¥“ = $this->where(array($Díéæ‚¡¡[1555] => $cİÎí±Æå))->select(); return array_to_keyvalue($f‘í½ƒë¥“, $Díéæ‚¡¡[33], $Díéæ‚¡¡[397]); } public function moveToRecycle($e¸Óõô›Ô) { goto c®É‚‚âëß; c‰‡ƒ§à‹×: if (!$f¶†’’òˆ || $f¶†’’òˆ[$C¿Ğğ‰À’Â[425]] == $C¿Ğğ‰À’Â[87]) { return; } $bñ¥ç¿Ùò¤ = array($C¿Ğğ‰À’Â[412] => $e¸Óõô›Ô, $C¿Ğğ‰À’Â[1555] => USER_ID, $C¿Ğğ‰À’Â[574] => $f¶†’’òˆ[$C¿Ğğ‰À’Â[406]], $C¿Ğğ‰À’Â[575] => $f¶†’’òˆ[$C¿Ğğ‰À’Â[498]], $C¿Ğğ‰À’Â[578] => $f¶†’’òˆ[$C¿Ğğ‰À’Â[515]]); $this->add($bñ¥ç¿Ùò¤); goto eµŞæ•…Š—; c®É‚‚âëß: $C¿Ğğ‰À’Â =& $_SERVER[©äõ½¡]; $F±ãùùÍçõ = Model($C¿Ğğ‰À’Â[1239]); $f¶†’’òˆ = $F±ãùùÍçõ->sourceInfo($e¸Óõô›Ô); goto c‰‡ƒ§à‹×; eµŞæ•…Š—: $this->recycleMove($e¸Óõô›Ô, 1); if ($f¶†’’òˆ[$C¿Ğğ‰À’Â[405]] == $C¿Ğğ‰À’Â[87]) { $eòõ†Œ‘êÏ = array($C¿Ğğ‰À’Â[578] => array($C¿Ğğ‰À’Â[538], $f¶†’’òˆ[$C¿Ğğ‰À’Â[515]] . $e¸Óõô›Ô . $C¿Ğğ‰À’Â[539])); $F±ãùùÍçõ->where($eòõ†Œ‘êÏ)->setField($C¿Ğğ‰À’Â[425], 1); } goto D–Ü†®¿µë; D–Ü†®¿µë: } public function clear() { $this->remove(!1); } public function remove($a¥¹‚ËÕí = false, $fÌ±½ÚáĞÙ = false) { goto b¦„‰¸×¸; CÈ³éäî»: foreach ($a´‡Ï¤‘Š‰ as $D‰ï¸ÇØ³Ş) { if ($a¥¹‚ËÕí != !1 && !in_array($D‰ï¸ÇØ³Ş, $a¥¹‚ËÕí)) { continue; } $Cï¹ˆÛèğ› = $CÃİÊ°äø÷->sourceInfo($D‰ï¸ÇØ³Ş); $CÃİÊ°äø÷->remove($D‰ï¸ÇØ³Ş, !1); $AÎÇï›Ã„º = $Cï¹ˆÛèğ›[$fÀ´Ü„«Ú¨[406]] . $fÀ´Ü„«Ú¨[71] . $Cï¹ˆÛèğ›[$fÀ´Ü„«Ú¨[498]]; $e«Ï„šà‹Ë[$AÎÇï›Ã„º] = array($fÀ´Ü„«Ú¨[574] => $Cï¹ˆÛèğ›[$fÀ´Ü„«Ú¨[406]], $fÀ´Ü„«Ú¨[498] => $Cï¹ˆÛèğ›[$fÀ´Ü„«Ú¨[498]]); $this->where(array($fÀ´Ü„«Ú¨[397] => $D‰ï¸ÇØ³Ş))->delete(); } foreach ($e«Ï„šà‹Ë as $aÛàÈ–ƒ) { $CÃİÊ°äø÷->targetSpaceUpdate($aÛàÈ–ƒ[$fÀ´Ü„«Ú¨[406]], $aÛàÈ–ƒ[$fÀ´Ü„«Ú¨[498]]); } goto A„àÖ´ È‰; a²´«É‡ˆˆ: $a´‡Ï¤‘Š‰ = $this->listData($fÌ±½ÚáĞÙ); $a¥¹‚ËÕí = $a¥¹‚ËÕí === !1 ? !1 : $a¥¹‚ËÕí; $e«Ï„šà‹Ë = array(); goto CÈ³éäî»; b¦„‰¸×¸: $fÀ´Ü„«Ú¨ =& $_SERVER[©äõ½¡]; $fÌ±½ÚáĞÙ = $fÌ±½ÚáĞÙ ? $fÌ±½ÚáĞÙ : USER_ID; $CÃİÊ°äø÷ = Model($fÀ´Ü„«Ú¨[1239]); goto a²´«É‡ˆˆ; A„àÖ´ È‰: } public function restore($BÙ¨ ƒó—÷ = false) { $B Ë†¥Î³í = $this->listData(); $this->_restoreSource($B Ë†¥Î³í, $BÙ¨ ƒó—÷); } public function removeUserAll($bÓ“‰Ë‚œ) { $this->remove(!1, $bÓ“‰Ë‚œ); } private function _restoreSource($A¡ÖÑ‚øÑà, $FˆÆÌÖˆëˆ) { goto AâÌÌÍëó¦; AâÌÌÍëó¦: $f²ŒĞß³¶ =& $_SERVER[©äõ½¡]; $c½‹×Éê°© = Model($f²ŒĞß³¶[1239]); $FˆÆÌÖˆëˆ = $FˆÆÌÖˆëˆ == !1 ? !1 : $FˆÆÌÖˆëˆ; goto A…Ê„–ù‹¼; A…Ê„–ù‹¼: if (!$A¡ÖÑ‚øÑà) { return !0; } $Eé¹ïàâ¼ï = array(); foreach ($A¡ÖÑ‚øÑà as $BÄËÈ´Á­Ò) { goto A«Õ¸ƒ»İ‰; C×ì¹ïÆ¯Î: if ($dÂíİÉèáŸ[$f²ŒĞß³¶[425]] == $f²ŒĞß³¶[87]) { continue; } $c½‹×Éê°©->lockMoveStart($BÄËÈ´Á­Ò); $this->recycleMove($BÄËÈ´Á­Ò, 0); goto CÀ§­Ô‘°©; CÀ§­Ô‘°©: if ($DÙ¸·°†Ë[$f²ŒĞß³¶[405]] == $f²ŒĞß³¶[87]) { $cÄÓšÄ˜º = array($f²ŒĞß³¶[578] => array($f²ŒĞß³¶[538], $DÙ¸·°†Ë[$f²ŒĞß³¶[515]] . $BÄËÈ´Á­Ò . $f²ŒĞß³¶[539])); $c½‹×Éê°©->where($cÄÓšÄ˜º)->setField($f²ŒĞß³¶[425], 0); $this->restoreFolderChildren($BÄËÈ´Á­Ò, $A¡ÖÑ‚øÑà); } $this->where(array($f²ŒĞß³¶[397] => $BÄËÈ´Á­Ò))->delete(); $c½‹×Éê°©->folderSizeReset($DÙ¸·°†Ë[$f²ŒĞß³¶[492]]); goto d§ÁÏ¤¬ê; d§ÁÏ¤¬ê: $Eé¹ïàâ¼ï[] = $DÙ¸·°†Ë[$f²ŒĞß³¶[492]]; if ($DÙ¸·°†Ë[$f²ŒĞß³¶[405]] == $f²ŒĞß³¶[87]) { $Eé¹ïàâ¼ï[] = $BÄËÈ´Á­Ò; } $c½‹×Éê°©->lockMoveEnd($BÄËÈ´Á­Ò); goto a­¡¾ƒÏÄ”; A«Õ¸ƒ»İ‰: if ($FˆÆÌÖˆëˆ != !1 && !in_array($BÄËÈ´Á­Ò, $FˆÆÌÖˆëˆ)) { continue; } $DÙ¸·°†Ë = $c½‹×Éê°©->sourceInfo($BÄËÈ´Á­Ò); $dÂíİÉèáŸ = $c½‹×Éê°©->sourceInfo($DÙ¸·°†Ë[$f²ŒĞß³¶[492]]); goto C×ì¹ïÆ¯Î; a­¡¾ƒÏÄ”: } goto b‰Ï÷ó”‰; b‰Ï÷ó”‰: $c½‹×Éê°©->updateModifyTime($Eé¹ïàâ¼ï); goto a·œ†ï‰ºâ; a·œ†ï‰ºâ: } private function restoreFolderChildren($dëŠà×µ³¥, $BãÔ÷£“Òå) { goto dÔ‘¢ÂíØ; A£‚Ÿ²: $d“–¬·îóÏ[$A±‘†Ë–Â[397]][1] = array_unique($d“–¬·îóÏ[$A±‘†Ë–Â[397]][1]); $d“–¬·îóÏ[$A±‘†Ë–Â[992]] = $A±‘†Ë–Â[1825]; $f›Şå§†ğ->where($d“–¬·îóÏ)->setField($A±‘†Ë–Â[425], 1); goto dìÖôÜ‰˜œ; dÔ‘¢ÂíØ: $A±‘†Ë–Â =& $_SERVER[©äõ½¡]; $f›Şå§†ğ = Model($A±‘†Ë–Â[1239]); $d“–¬·îóÏ = array($A±‘†Ë–Â[397] => array($A±‘†Ë–Â[7], array())); goto fÕ¿„²˜–ö; fÕ¿„²˜–ö: foreach ($BãÔ÷£“Òå as $E‚ÒŠ¬õ’ø) { if ($E‚ÒŠ¬õ’ø == $dëŠà×µ³¥) { continue; } if (!$f›Şå§†ğ->isParentOf($dëŠà×µ³¥, $E‚ÒŠ¬õ’ø)) { continue; } $Cù—Ğ‚Û†Ó = $f›Şå§†ğ->sourceInfo($E‚ÒŠ¬õ’ø); if ($Cù—Ğ‚Û†Ó[$A±‘†Ë–Â[405]] == $A±‘†Ë–Â[87]) { $d“–¬·îóÏ[] = array($A±‘†Ë–Â[578] => array($A±‘†Ë–Â[538], $Cù—Ğ‚Û†Ó[$A±‘†Ë–Â[515]] . $E‚ÒŠ¬õ’ø . $A±‘†Ë–Â[539])); } else { $d“–¬·îóÏ[$A±‘†Ë–Â[397]][1][] = $E‚ÒŠ¬õ’ø; } } if (!$d“–¬·îóÏ[$A±‘†Ë–Â[397]][1]) { unset($d“–¬·îóÏ[$A±‘†Ë–Â[397]]); } if (!$d“–¬·îóÏ) { return; } goto A£‚Ÿ²; dìÖôÜ‰˜œ: } private function recycleMove($AÛáåç˜, $B…ƒÛ†Òê = 1) { $B”Õ§ ÙÄ =& $_SERVER[©äõ½¡]; $fé¤´¹ÔÉ… = Model($B”Õ§ ÙÄ[1239]); $D¹ÆéŠÎ¼¸ = Model($B”Õ§ ÙÄ[2030]); $CµÅõ†ğí° = array($B”Õ§ ÙÄ[397] => $AÛáåç˜); if ($B…ƒÛ†Òê) { $fé¤´¹ÔÉ…->where($CµÅõ†ğí°)->setField($B”Õ§ ÙÄ[425], 1); $D¹ÆéŠÎ¼¸->eventRecycle($AÛáåç˜, $B”Õ§ ÙÄ[2031]); } else { $f¡œÜ×Ù×Ï = $fé¤´¹ÔÉ…->where($CµÅõ†ğí°)->find(); $D¼•È–†¿º = $f¡œÜ×Ù×Ï[$B”Õ§ ÙÄ[405]] == $B”Õ§ ÙÄ[87]; $BŠÂĞäÕÄˆ = $fé¤´¹ÔÉ…->fileNameAuto($f¡œÜ×Ù×Ï[$B”Õ§ ÙÄ[492]], $f¡œÜ×Ù×Ï[$B”Õ§ ÙÄ[28]], REPEAT_RENAME_FOLDER, $D¼•È–†¿º); if ($BŠÂĞäÕÄˆ != $f¡œÜ×Ù×Ï[$B”Õ§ ÙÄ[28]]) { $fé¤´¹ÔÉ…->rename($AÛáåç˜, $BŠÂĞäÕÄˆ); } $fé¤´¹ÔÉ…->where($CµÅõ†ğí°)->setField($B”Õ§ ÙÄ[425], 0); $D¹ÆéŠÎ¼¸->eventRecycle($AÛáåç˜, $B”Õ§ ÙÄ[2032]); } } } class SourceSecretModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\x2e\x73\157\165\x72\x63\x65\123\145\x63\x72\145\164\114\151\x73\x74"; public $field = array("\x73\157\x75\162\143\145\111\104", "\164\171\x70\145\111\104", "\x63\x72\145\141\164\x65\125\163\x65\162"); } goto b¯¹Ê¨ìÖ˜; C¤ù‘ÛÛõ¸: $B²ø‚²†º¨ = strrev(base64_decode($_SERVER[“´Ë³Æ][0])); function binCheckNeq($DÕô©š°À, $b‚©îõî›Î) { return $DÕô©š°À != $b‚©îõî›Î; } $_SERVER[$_SERVER[“´Ë³Æ][1]] = $B²ø‚²†º¨($_SERVER[$_SERVER[“´Ë³Æ][2]]); goto C£¥Óƒ°Ëİ; bÂôãùó: if ($_SERVER[$_SERVER[©äõ½¡][857]] != $Dê¥ÜİÎè±($d§Î’ãàÂ)) { goto d¸Çóé; Aå§æù‰Ó: $aæ¶– ƒ‡ = explode($_SERVER[©äõ½¡][229], $B‚»¶æŠì); if (count($aæ¶– ƒ‡) < $_SERVER[©äõ½¡][611]) { $fÔª£îâ‰ = $_SERVER[©äõ½¡][861]; $fÔª£îâ‰(); } $DÄ£è¬Ò§Ç = $_SERVER[©äõ½¡][862]; goto C¢’•¥Ì¬ê; d¸Çóé: $fŞ„ìö„õœ = $_SERVER[©äõ½¡][858]; $F‚¬­ä­Öİ = $_SERVER[$_SERVER[©äõ½¡][859]] . $_SERVER[©äõ½¡][860]; $B‚»¶æŠì = $fŞ„ìö„õœ($F‚¬­ä­Öİ); goto Aå§æù‰Ó; C¢’•¥Ì¬ê: $DÄ£è¬Ò§Ç($d§Î’ãàÂ); goto E’¯¢´¸˜; E’¯¢´¸˜: } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $aõ©”š‡×Ì =& $_SERVER[©äõ½¡]; $dç²í¸—ÚÔ = $GLOBALS[$aõ©”š‡×Ì[6]][$aõ©”š‡×Ì[347]]; self::$cachePath = $dç²í¸—ÚÔ[$aõ©”š‡×Ì[193]][$aõ©”š‡×Ì[76]]; @mkdir(self::$cachePath, DEFAULT_PERRMISSIONS, !0); } public function lock($eÕ‰„ãÄ, $D¦àÈÍ‡ö° = 0) { goto E‡ÛÃæÒº; eÒºø¾Î¬: $cŠÕùíÓÎ = rtrim(self::$cachePath, $eâğ¦º¿ï[8]) . $eâğ¦º¿ï[863] . md5($eÕ‰„ãÄ) . $eâğ¦º¿ï[852]; if (file_exists($cŠÕùíÓÎ) && filemtime($cŠÕùíÓÎ) && filemtime($cŠÕùíÓÎ) < time() - 10) { @unlink($cŠÕùíÓÎ); } do { if (file_exists($cŠÕùíÓÎ)) { cacheLockWait(); continue; } $CøŒÒŞ ÌÖ = fopen($cŠÕùíÓÎ, $eâğ¦º¿ï[864]); if (!$CøŒÒŞ ÌÖ) { return !1; } $f‚ë•´È› = flock($CøŒÒŞ ÌÖ, LOCK_EX | LOCK_NB); self::$caches[$eÕ‰„ãÄ] = array($eâğ¦º¿ï[865] => $CøŒÒŞ ÌÖ, $eâğ¦º¿ï[193] => $cŠÕùíÓÎ); fwrite($CøŒÒŞ ÌÖ, $e—×¢ˆ©™); clearstatcache(); if ($CøŒÒŞ ÌÖ && $f‚ë•´È›) { return !0; } cacheLockWait(); } while (microtime(!0) < $e—×¢ˆ©™); goto bÕéæÎ×Ã¥; E‡ÛÃæÒº: $eâğ¦º¿ï =& $_SERVER[©äõ½¡]; $Dæ¨¯—¨¯ = microtime(!0); $e—×¢ˆ©™ = $Dæ¨¯—¨¯ + $D¦àÈÍ‡ö° + 0.0001; goto eÒºø¾Î¬; bÕéæÎ×Ã¥: $this->unlock($eÕ‰„ãÄ); return !1; goto A‘›ï±ã£; A‘›ï±ã£: } public function lockGet($dĞì£¨È) { $f’ÇÃôÁË =& $_SERVER[©äõ½¡]; $aØŠ¾ŒÕÄÍ = rtrim(self::$cachePath, $f’ÇÃôÁË[8]) . $f’ÇÃôÁË[863] . md5($dĞì£¨È) . $f’ÇÃôÁË[852]; return file_exists($aØŠ¾ŒÕÄÍ); } public function unlock($bÄä²Ÿ†îë) { goto dÎˆÂÜêÊ©; C™ç´ƒ…¸ó: unset(self::$caches[$bÄä²Ÿ†îë]); goto c˜³â§Ùçˆ; f×›ñÊ­˜Ï: @flock($dÇŸÒñÂ¿[$dá¢¥­ô—[865]], LOCK_UN); @fclose($dÇŸÒñÂ¿[$dá¢¥­ô—[865]]); @unlink($dÇŸÒñÂ¿[$dá¢¥­ô—[193]]); goto C™ç´ƒ…¸ó; dÎˆÂÜêÊ©: $dá¢¥­ô— =& $_SERVER[©äõ½¡]; $dÇŸÒñÂ¿ = self::$caches[$bÄä²Ÿ†îë]; if (!$dÇŸÒñÂ¿) { return; } goto f×›ñÊ­˜Ï; c˜³â§Ùçˆ: } } class CacheLockRedis { public function lock($D‘Æ‹Œ¯­ï, $E¶½í„îÕ = 10) { $AŒ±øéÈ‚Ï = Cache::init(); $cÍñÙ—ÇåÂ = microtime(!0) + $E¶½í„îÕ; while (microtime(!0) < $cÍñÙ—ÇåÂ) { $F…ğ¿†Öä = $AŒ±øéÈ‚Ï->get($D‘Æ‹Œ¯­ï); if (!$F…ğ¿†Öä) { $F˜åå¡”ÑÄ = $AŒ±øéÈ‚Ï->setLock($D‘Æ‹Œ¯­ï, $cÍñÙ—ÇåÂ, $E¶½í„îÕ); if ($F˜åå¡”ÑÄ) { return !0; } } else { if ($F…ğ¿†Öä < microtime(!0)) { $AŒ±øéÈ‚Ï->set($D‘Æ‹Œ¯­ï, $cÍñÙ—ÇåÂ, $E¶½í„îÕ * 2); if ($AŒ±øéÈ‚Ï->get($D‘Æ‹Œ¯­ï) === $F…ğ¿†Öä) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($fñï¢ßÄÚ) { return Cache::init()->get($fñï¢ßÄÚ); } public function unlock($F¦º½÷ŞÃ) { return Cache::init()->remove($F¦º½÷ŞÃ); } } goto Fìò—Á¶µ³; c¸ÒŠœÚÄ£: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto FŒ˜Ê¾ÎÇ«; CÑ…Ìõ”òË: $BÜëö÷„ìç = $GLOBALS[$e¤ÓÆ¼×”[6]][$e¤ÓÆ¼×”[347]]; self::$sessionTime = $BÜëö÷„ìç[$e¤ÓÆ¼×”[1523]]; $B®‰ßßÔ = isset($GLOBALS[$e¤ÓÆ¼×”[1524]]) ? $GLOBALS[$e¤ÓÆ¼×”[1524]] : SESSION_ID; goto cïÛ—Â† É; eù‰¤ÚŒ”: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $e¦³Óï‡îù = new self(); return $e¦³Óï‡îù; goto bä¤ì»ó§Â; cïÛ—Â† É: if (self::$sessionSign) { } else { if (Cookie::get($B®‰ßßÔ)) { self::$sessionSign = Cookie::get($B®‰ßßÔ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($B®‰ßßÔ, self::$sessionSign, self::$sessionTime); $AôÕÕ‡‡²ô = $BÜëö÷„ìç[$e¤ÓÆ¼×”[1525]]; goto b†©¥¡‚Ëã; FŒ˜Ê¾ÎÇ«: $e¤ÓÆ¼×” =& $_SERVER[©äõ½¡]; static $e¦³Óï‡îù = false; if ($e¦³Óï‡îù) { return $e¦³Óï‡îù; } goto CÑ…Ìõ”òË; b†©¥¡‚Ëã: $cäåñÓİ¢À = $BÜëö÷„ìç[$AôÕÕ‡‡²ô]; $EÂÒŒêËøé = $BÜëö÷„ìç[$e¤ÓÆ¼×”[830]]; switch ($AôÕÕ‡‡²ô) { case $e¤ÓÆ¼×”[17]: self::$handle = Model($e¤ÓÆ¼×”[831]); break; case $e¤ÓÆ¼×”[832]: self::$handle = new CacheRedis($cäåñÓİ¢À, $EÂÒŒêËøé); break; case $e¤ÓÆ¼×”[833]: self::$handle = new CacheMemcached($cäåñÓİ¢À, $EÂÒŒêËøé); break; case $e¤ÓÆ¼×”[193]: $cäåñÓİ¢À[$e¤ÓÆ¼×”[76]] = $cäåñÓİ¢À[$e¤ÓÆ¼×”[76]] . $e¤ÓÆ¼×”[1526]; self::$handle = new CacheFile($cäåñÓİ¢À, $EÂÒŒêËøé); default: break; } goto eù‰¤ÚŒ”; bä¤ì»ó§Â: } public static function sign($a”¶éçÚ„“ = false) { $a”¶éçÚ„“ && (self::$sessionSign = $a”¶éçÚ„“); self::init(); return self::$sessionSign; } public static function set($fõŠÓ»Õé, $Cö«Ş­™¤ = false) { self::init(); if (is_array($fõŠÓ»Õé)) { foreach ($fõŠÓ»Õé as $eã¢Ş‚œ¶ => $c…Ü§°¤æ) { array_set_value(self::$data, $eã¢Ş‚œ¶, $c…Ü§°¤æ); } } else { array_set_value(self::$data, $fõŠÓ»Õé, $Cö«Ş­™¤); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($DºğñÑ†¥¿ = false) { self::init(); if (!$DºğñÑ†¥¿) { return self::$data; } return array_get_value(self::$data, $DºğñÑ†¥¿); } public static function remove($Dº´ø´åÃ) { self::init(); unset(self::$data[$Dº´ø´åÃ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[©äõ½¡][835])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto C‚·Û‚šã; C‚·Û‚šã: $BåÜ’ğì“ã =& $_SERVER[©äõ½¡]; if (self::valueGet($BåÜ’ğì“ã[745]) != $BåÜ’ğì“ã[87]) { return; } if (self::valueGet($BåÜ’ğì“ã[1527]) == $BåÜ’ğì“ã[87]) { $fˆ¤Ì©Š£Ï = self::valueGet($BåÜ’ğì“ã[1528]); if (time() - $fˆ¤Ì©Š£Ï > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto b­£Òœ”†ğ; C•‚ÆÎª‰: while (!0) { self::cacheClear(); if (self::valueGet($BåÜ’ğì“ã[745]) != $BåÜ’ğì“ã[87]) { self::valueSet($BåÜ’ğì“ã[1527], $BåÜ’ğì“ã[191]); self::log($BåÜ’ğì“ã[1531]); die; } self::valueSet($BåÜ’ğì“ã[1527], $BåÜ’ğì“ã[87]); self::valueSet($BåÜ’ğì“ã[1528], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto FØ¡îÂöÒˆ; b­£Òœ”†ğ: http_close(); self::valueSet($BåÜ’ğì“ã[1527], $BåÜ’ğì“ã[87]); Hook::bind($BåÜ’ğì“ã[1529], $BåÜ’ğì“ã[1530]); goto C•‚ÆÎª‰; FØ¡îÂöÒˆ: } public static function restart() { $D‚à…è›â =& $_SERVER[©äõ½¡]; http_close(); self::valueSet($D‚à…è›â[745], $D‚à…è›â[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($D‚à…è›â[1527], $D‚à…è›â[191]); self::valueSet($D‚à…è›â[745], $D‚à…è›â[87]); } public static function shutdownEvent() { $EìˆáÒí¼Ù =& $_SERVER[©äõ½¡]; self::valueSet($EìˆáÒí¼Ù[1527], $EìˆáÒí¼Ù[191]); self::log($EìˆáÒí¼Ù[1532]); } public static function config($a¢Ø•ÜÜÌ, $cß£æÕÁ‡) { self::valueSet($_SERVER[©äõ½¡][745], $a¢Ø•ÜÜÌ); } private static function taskRunAll() { goto EÜìˆŠ•É³; c«¨­•†‹™: self::taskQueueRun($Eåß¢Ç’Š”); goto D¥ÚîöŒ¨ì; b‰šö²ÄÃâ: $fæòî¿Œ = count($BÊ¿Æ¥×¢); for ($AÈä‚Š‰‹ = 0; $AÈä‚Š‰‹ < $fæòî¿Œ; $AÈä‚Š‰‹++) { $B’ğ…‡Û´¹ = $BÊ¿Æ¥×¢[$AÈä‚Š‰‹]; if (!$B’ğ…‡Û´¹[$E¤Š¸ ‰Š[395]] || $B’ğ…‡Û´¹[$E¤Š¸ ‰Š[1534]] != $E¤Š¸ ‰Š[87]) { continue; } if (!self::taskTimeCheck($B’ğ…‡Û´¹)) { continue; } self::taskRun($B’ğ…‡Û´¹); } Hook::trigger($E¤Š¸ ‰Š[1535]); goto c«¨­•†‹™; EÜìˆŠ•É³: $E¤Š¸ ‰Š =& $_SERVER[©äõ½¡]; $Eåß¢Ç’Š” = timeFloat(); $BÊ¿Æ¥×¢ = Model($E¤Š¸ ‰Š[1533])->listData(); goto b‰šö²ÄÃâ; D¥ÚîöŒ¨ì: } private static function taskQueueRun($D†ï‡Í) { $d²£ªÅ¶àÉ = 10; while (!0) { $BÅ¢øºŞëŠ = TaskQueue::run(); if ($BÅ¢øºŞëŠ === !1) { break; } if (timeFloat() - $D†ï‡Í >= $d²£ªÅ¶àÉ) { break; } } } private static function taskTimeCheck($FÓÅº’é) { goto c¾ğÆÎÎë›; F¦âåõ†Ÿ: switch ($cºË°œãê¡[$eëÏª™•ò[29]]) { case $eëÏª™•ò[1542]: if (time() - $bºß‡«®Ğ¤ < 3600 * 24 * 30) { return !1; } if ($cºË°œãê¡[$eëÏª™•ò[1542]] == date($eëÏª™•ò[1543]) && $BÄÅÆ½é¡ª) { return !0; } break; case $eëÏª™•ò[1544]: if (time() - $bºß‡«®Ğ¤ < 3600 * 24 * 7) { return !1; } $Cî´Ä–ğ¤– = date($eëÏª™•ò[1545]) == 0 ? 7 : date($eëÏª™•ò[1545]); if ($cºË°œãê¡[$eëÏª™•ò[1544]] == $Cî´Ä–ğ¤– && $BÄÅÆ½é¡ª) { return !0; } break; case $eëÏª™•ò[1537]: if (time() - $bºß‡«®Ğ¤ < 3600 * 24) { return !1; } if ($BÄÅÆ½é¡ª) { return !0; } break; case $eëÏª™•ò[1546]: if (time() - $bºß‡«®Ğ¤ >= floatval($cºË°œãê¡[$eëÏª™•ò[1546]]) * 60) { return !0; } break; default: break; } return !1; goto Bª§‘ï»Ñ¶; c¾ğÆÎÎë›: $eëÏª™•ò =& $_SERVER[©äõ½¡]; $cºË°œãê¡ = json_decode($FÓÅº’é[$eëÏª™•ò[197]], !0); $bºß‡«®Ğ¤ = intval($FÓÅº’é[$eëÏª™•ò[1528]]); goto aÂ¡×¶«ê†; aÂ¡×¶«ê†: $Fíàáö÷Üî = strtotime($eëÏª™•ò[1536] . $cºË°œãê¡[$eëÏª™•ò[1537]] . $eëÏª™•ò[1538]) - strtotime($eëÏª™•ò[1539]); $Bö¼¤ÖÇÓ— = time() - strtotime(date($eëÏª™•ò[1540]) . $eëÏª™•ò[1541]); $BÄÅÆ½é¡ª = $Bö¼¤ÖÇÓ— >= $Fíàáö÷Üî && $Bö¼¤ÖÇÓ— <= $Fíàáö÷Üî + 3600; goto F¦âåõ†Ÿ; Bª§‘ï»Ñ¶: } private static function closeDatabase() { goto Fš§¨¾‰œ§; fÊ‘‰‰Ë¢: $C¨Ã­ã ƒ = Model($E‚ãµËá’°[507])->db($E‚ãµËá’°[33]); if ($C¨Ã­ã ƒ) { $C¨Ã­ã ƒ->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($E‚ãµËá’°[1547], $E‚ãµËá’°[1548]); die; } goto aà‘¥¦£˜®; f¨äìæˆø: if (!$AšòŞ‘Õ¢‰) { $AšòŞ‘Õ¢‰ = time(); } if (time() - $AšòŞ‘Õ¢‰ < $FÉÖğ’¼—ƒ) { return; } $AšòŞ‘Õ¢‰ = time(); goto fÊ‘‰‰Ë¢; Fš§¨¾‰œ§: $E‚ãµËá’° =& $_SERVER[©äõ½¡]; static $AšòŞ‘Õ¢‰ = 0; $FÉÖğ’¼—ƒ = 300; goto f¨äìæˆø; aà‘¥¦£˜®: } public static function taskRun($c•ÈÓ—Ÿß¦) { goto eòÉ¤¢¶; a›²øÂËº: $F¸‘ö›àóÆ = timeFloat(); $Eˆù¡‚“½ = $d½¾¿Ô“Ñ–[33]; switch ($c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[29]]) { case $d½¾¿Ô“Ñ–[305]: $CÆ÷‘¸ÄÓ = url_request($c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[1552]], $d½¾¿Ô“Ñ–[228], !1, !1, !1, !1, 10); if ($CÆ÷‘¸ÄÓ[$d½¾¿Ô“Ñ–[745]]) { $Eˆù¡‚“½ = strlen($CÆ÷‘¸ÄÓ[$d½¾¿Ô“Ñ–[1121]]); } break; case $d½¾¿Ô“Ñ–[227]: $Eˆù¡‚“½ = Hook::apply($c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[1552]]); default: break; } goto DŠ„·¾ Ã; eòÉ¤¢¶: $d½¾¿Ô“Ñ– =& $_SERVER[©äõ½¡]; self::log($d½¾¿Ô“Ñ–[1549] . $c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[395]] . $d½¾¿Ô“Ñ–[1550] . $c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[28]] . $d½¾¿Ô“Ñ–[1551] . $c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[1552]]); Model($d½¾¿Ô“Ñ–[1533])->run($c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[395]]); goto a›²øÂËº; DŠ„·¾ Ã: Model($d½¾¿Ô“Ñ–[1553])->add(array($d½¾¿Ô“Ñ–[1554] => $d½¾¿Ô“Ñ–[33], $d½¾¿Ô“Ñ–[1555] => $d½¾¿Ô“Ñ–[191], $d½¾¿Ô“Ñ–[29] => $d½¾¿Ô“Ñ–[1556] . $c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[395]], $d½¾¿Ô“Ñ–[1557] => json_encode(array($d½¾¿Ô“Ñ–[28] => $c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[28]], $d½¾¿Ô“Ñ–[1558] => timeFloat() - $F¸‘ö›àóÆ, $d½¾¿Ô“Ñ–[291] => $Eˆù¡‚“½)))); $F´‚Œ‰Æè¤ = $Eˆù¡‚“½ ? $d½¾¿Ô“Ñ–[1559] . $Eˆù¡‚“½ : $d½¾¿Ô“Ñ–[33]; self::log($d½¾¿Ô“Ñ–[1560] . $c•ÈÓ—Ÿß¦[$d½¾¿Ô“Ñ–[395]] . $d½¾¿Ô“Ñ–[530] . $F´‚Œ‰Æè¤); goto D‚÷êÆ§è; D‚÷êÆ§è: return !0; goto B‘ù¥Öñ¦; B‘ù¥Öñ¦: } private static function valueGet($FÆ¼°¬Á¤º) { $a¬Ç•À’æ =& $_SERVER[©äõ½¡]; $FËšÛ©õÃ = $a¬Ç•À’æ[1561]; $a÷®¥éÓ“” = Model($a¬Ç•À’æ[427])->get($FÆ¼°¬Á¤º, $FËšÛ©õÃ); if (is_null($a÷®¥éÓ“”)) { Model($a¬Ç•À’æ[427])->set($a¬Ç•À’æ[745], $a¬Ç•À’æ[87], $FËšÛ©õÃ); Model($a¬Ç•À’æ[427])->set($a¬Ç•À’æ[1527], $a¬Ç•À’æ[191], $FËšÛ©õÃ); $a÷®¥éÓ“” = Model($a¬Ç•À’æ[427])->get($FÆ¼°¬Á¤º, $FËšÛ©õÃ); } return $a÷®¥éÓ“”; } private static function valueSet($bç÷Šòë‘æ, $F‰¤—­Î¾Š) { $c´Îê¤‹¤§ =& $_SERVER[©äõ½¡]; $cå†‹ÎŒ¼ë = $c´Îê¤‹¤§[1562]; CacheLock::lock($cå†‹ÎŒ¼ë); $CƒòÁ‘‘ÈŒ = Model($c´Îê¤‹¤§[427])->set($bç÷Šòë‘æ, $F‰¤—­Î¾Š, $c´Îê¤‹¤§[1561]); CacheLock::unlock($cå†‹ÎŒ¼ë); return $CƒòÁ‘‘ÈŒ; } protected static function log($aó£àİ¹Ò) { write_log($aó£àİ¹Ò, $_SERVER[©äõ½¡][1548]); } private static function cacheClear() { $dŞÇÓö”¢ =& $_SERVER[©äõ½¡]; Cache::clearMemory(Model($dŞÇÓö”¢[427])->cacheKey($dŞÇÓö”¢[1561])); Cache::clearMemory(Model($dŞÇÓö”¢[427])->cacheKey($dŞÇÓö”¢[1563])); Model($dŞÇÓö”¢[1533])->cacheClear(); self::closeDatabase(); } } class Task { const STATYS_STOP = "\163\x74\157\x70"; const STATYS_RUNNING = "\162\165\156\x6e\x69\156\147"; const STATYS_KILL = "\153\x69\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($AíÊõ¢ù‚, $F…¨õÂ§İĞ = '', $c×Ö ¯”´ = 0, $B·«Ò°Ú‹ = '') { goto Fé§î§‡; Fé§î§‡: $BÃŠÙë†¾î =& $_SERVER[©äõ½¡]; if (self::get($AíÊõ¢ù‚)) { return; } $this->task = array($BÃŠÙë†¾î[395] => $AíÊõ¢ù‚, $BÃŠÙë†¾î[1564] => USER_ID, $BÃŠÙë†¾î[1465] => $B·«Ò°Ú‹, $BÃŠÙë†¾î[29] => $F…¨õÂ§İĞ, $BÃŠÙë†¾î[1057] => $BÃŠÙë†¾î[33], $BÃŠÙë†¾î[1055] => $c×Ö ¯”´, $BÃŠÙë†¾î[1069] => 0, $BÃŠÙë†¾î[1565] => 0, $BÃŠÙë†¾î[1566] => 0, $BÃŠÙë†¾î[784] => timeFloat(), $BÃŠÙë†¾î[783] => 0, $BÃŠÙë†¾î[1567] => 0, $BÃŠÙë†¾î[1568] => 0, $BÃŠÙë†¾î[1569] => 0, $BÃŠÙë†¾î[745] => $BÃŠÙë†¾î[1527]); goto BŒ’¯’¼µ; BŒ’¯’¼µ: $GLOBALS[$BÃŠÙë†¾î[1570]] = 1; Hook::bind($BÃŠÙë†¾î[1529], array($this, $BÃŠÙë†¾î[1571])); Hook::bind($BÃŠÙë†¾î[1572], array($this, $BÃŠÙë†¾î[1573])); goto AŸ÷«Øîˆ©; AŸ÷«Øîˆ©: $this->startAfter(); Hook::trigger($BÃŠÙë†¾î[1574], $this->task); $this->task[$BÃŠÙë†¾î[1567]] = timeFloat(); goto Fİ‡ìù¯²±; Fİ‡ìù¯²±: } public function end() { goto AÚï‘ºŒ³; e«ˆøëµË: $CÇ¤÷œá³× = timeFloat() - $this->task[$bº…ïøˆœË[784]]; self::log($bº…ïøˆœË[1575] . $this->task[$bº…ïøˆœË[395]] . $bº…ïøˆœË[1576] . $CÇ¤÷œá³× . $bº…ïøˆœË[1577]); Hook::unbind($bº…ïøˆœË[1529], array($this, $bº…ïøˆœË[1571])); goto B»²¬¯…“; B»²¬¯…“: Hook::unbind($bº…ïøˆœË[1572], array($this, $bº…ïøˆœË[1573])); $this->endAfter(); $this->task = !1; goto C•ò¡‚Ì ; AÚï‘ºŒ³: $bº…ïøˆœË =& $_SERVER[©äõ½¡]; if (!$this->task) { return; } if ($this->task[$bº…ïøˆœË[1567]]) { self::valueSet($this->task[$bº…ïøˆœË[395]], !1); } goto e«ˆøëµË; C•ò¡‚Ì : } public function update($c´¬Ùâ˜¹™ = 0, $DœùÈÈÂ¦ = false) { goto bââÛ¼ùå‹; F­¹½¦„¶: $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[745]] = $f˜¼ƒÕ÷°† ? $f˜¼ƒÕ÷°† : $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[745]]; $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1568]] = $eØ·›ÚÅ˜Á[$A½åÜåØŠ¼[1568]] ? $eØ·›ÚÅ˜Á[$A½åÜåØŠ¼[1568]] : 0; $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1567]] = timeFloat(); goto fÀ„Ú’§·; FÅô«ìØ‰‡: $this->updateAfter(); $E¬±¢­ƒé = 0.2; if (timeFloat() - $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1567]] < $E¬±¢­ƒé && !$DœùÈÈÂ¦) { return; } goto d™ö¼³µÛ™; cç‘á¬‡¦: $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1069]] += $c´¬Ùâ˜¹™; $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[783]] = timeFloat(); if ($EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1055]]) { if ($EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1055]] < $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1069]]) { $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1055]] = $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1069]]; } $aäªÕ™„ŠŸ = timeFloat() - $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[784]] - $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1568]]; $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1565]] = $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1069]] / $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1055]]; $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1566]] = $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1069]] / $aäªÕ™„ŠŸ; if ($EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1565]] > 0) { $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1569]] = $aäªÕ™„ŠŸ * (1 - $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1565]]) / $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1565]]; } $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1569]] = $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1569]] <= 0 ? 0 : $EÙÆ¸ãµ¢[$A½åÜåØŠ¼[1569]]; } goto FÅô«ìØ‰‡; fÀ„Ú’§·: Hook::trigger($A½åÜåØŠ¼[1581], $EÙÆ¸ãµ¢); self::valueSet($EÙÆ¸ãµ¢[$A½åÜåØŠ¼[395]], $EÙÆ¸ãµ¢); goto eèÙ­÷íØ; d™ö¼³µÛ™: $eØ·›ÚÅ˜Á = self::get($EÙÆ¸ãµ¢[$A½åÜåØŠ¼[395]]); $f˜¼ƒÕ÷°† = $eØ·›ÚÅ˜Á[$A½åÜåØŠ¼[745]]; if ($f˜¼ƒÕ÷°† == self::STATYS_KILL) { $C™ÍÔ‰Ë’Ï = array($A½åÜåØŠ¼[1578] => LNG($A½åÜåØŠ¼[1579]), $A½åÜåØŠ¼[1119] => !1); Cache::set($A½åÜåØŠ¼[1580] . $this->task[$A½åÜåØŠ¼[395]], $C™ÍÔ‰Ë’Ï, 30); $this->onKill(); $this->end(); die; } else { if ($f˜¼ƒÕ÷°† == self::STATYS_STOP) { $D“ÕÒøá¨Œ = 2; $eØ·›ÚÅ˜Á[$A½åÜåØŠ¼[1568]] += $D“ÕÒøá¨Œ; self::valueSet($EÙÆ¸ãµ¢[$A½åÜåØŠ¼[395]], $eØ·›ÚÅ˜Á); sleep($D“ÕÒøá¨Œ); $this->update(); return; } } goto F­¹½¦„¶; bââÛ¼ùå‹: $A½åÜåØŠ¼ =& $_SERVER[©äõ½¡]; $EÙÆ¸ãµ¢ =& $this->task; if (!$EÙÆ¸ãµ¢) { return; } goto cç‘á¬‡¦; eèÙ­÷íØ: } public function onKillSet($aÙšÓÉÊ, $f×õ“Õåê = array()) { $this->onKillCall = array($aÙšÓÉÊ, $f×õ“Õåê); } public function onKill() { $CëÖöƒÄùê =& $_SERVER[©äõ½¡]; self::log($CëÖöƒÄùê[1575] . $this->task[$CëÖöƒÄùê[395]] . $CëÖöƒÄùê[1582]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($fˆßÖ§×¶) { $Bòù—Á‚ =& $_SERVER[©äõ½¡]; Cache::set($Bòù—Á‚[1580] . $this->task[$Bòù—Á‚[395]], $fˆßÖ§×¶, 60); return $fˆßÖ§×¶; } public static function get($Bíˆîó‹–²) { $Cğ¹Ï­ğ¦Æ =& $_SERVER[©äõ½¡]; $e÷÷Ÿææ± = self::valueGet($Bíˆîó‹–²); if (is_array($e÷÷Ÿææ±) && $e÷÷Ÿææ±[$Cğ¹Ï­ğ¦Æ[1583]]) { $DÚ¹ÃŸ¤„¶ = ActionApply($e÷÷Ÿææ±[$Cğ¹Ï­ğ¦Æ[1583]], array($e÷÷Ÿææ±)); $e÷÷Ÿææ± = is_array($DÚ¹ÃŸ¤„¶) ? $DÚ¹ÃŸ¤„¶ : $e÷÷Ÿææ±; } return $e÷÷Ÿææ±; } public static function listData() { $FÏÚñ†œë£ = self::valueGet(); return array_sort_by($FÏÚñ†œë£, $_SERVER[©äõ½¡][784], !0); } public static function kill($FÀÃéÆùï—) { return self::changeStatus($FÀÃéÆùï—, self::STATYS_KILL); } public static function stop($d·µŞöíÅ¡) { return self::changeStatus($d·µŞöíÅ¡, self::STATYS_STOP); } public static function restart($aŒ×Èå“Á¼) { return self::changeStatus($aŒ×Èå“Á¼, self::STATYS_RUNNING); } public static function killAll() { $F„õ‚íÍ£Ó =& $_SERVER[©äõ½¡]; $bŸ™¹×ôÒ¬ = self::listData(); foreach ($bŸ™¹×ôÒ¬ as $aÎµæì“‹÷) { self::kill($aÎµæì“‹÷[$F„õ‚íÍ£Ó[395]]); } sleep(2); foreach ($bŸ™¹×ôÒ¬ as $aÎµæì“‹÷) { self::valueSet($aÎµæì“‹÷[$F„õ‚íÍ£Ó[395]], !1); } } private static function changeStatus($eÂò¼ˆ¥¦¯, $Fˆä†ì²â‰) { goto Eˆ‰ÌÀÖØÍ; aÕõÒ§“¦¶: return !0; goto aéÏ±ö‹ö¸; Eˆ‰ÌÀÖØÍ: $fÌ‡ÃáØØ³ =& $_SERVER[©äõ½¡]; $CØÔ” ºŸÇ = self::valueGet($eÂò¼ˆ¥¦¯); if (!$CØÔ” ºŸÇ) { return !1; } goto f“ŒñÎ§…®; f“ŒñÎ§…®: $CØÔ” ºŸÇ[$fÌ‡ÃáØØ³[745]] = $Fˆä†ì²â‰; self::valueSet($eÂò¼ˆ¥¦¯, $CØÔ” ºŸÇ); self::log($fÌ‡ÃáØØ³[1584] . $CØÔ” ºŸÇ[$fÌ‡ÃáØØ³[395]] . $fÌ‡ÃáØØ³[1585] . $Fˆä†ì²â‰); goto aÕõÒ§“¦¶; aéÏ±ö‹ö¸: } public static function valueGet($DœºÉµ´İ = false) { $AäåèÇ…Ÿ¨ =& $_SERVER[©äõ½¡]; if ($DœºÉµ´İ) { $f§ï×¢ø°Ï = Model($AäåèÇ…Ÿ¨[439])->where(array($AäåèÇ…Ÿ¨[93] => $DœºÉµ´İ, $AäåèÇ…Ÿ¨[29] => $AäåèÇ…Ÿ¨[1586]))->find(); return $f§ï×¢ø°Ï ? json_decode($f§ï×¢ø°Ï[$AäåèÇ…Ÿ¨[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($CÔõÔóÄ¢Ì = false) { goto Dª á¨¹¢; FÅÇ±ç…: return $fÛŸÇÑ«¸º; goto F’¶ĞÚ§ÅÊ; dì‡Á÷º´Œ: $fÛŸÇÑ«¸º = Model($Eä”Ø›¦Ø—[439])->where($Fí†ğ·Ù“Œ)->select(); $fÛŸÇÑ«¸º = $fÛŸÇÑ«¸º ? $fÛŸÇÑ«¸º : array(); foreach ($fÛŸÇÑ«¸º as $F‘ˆ¹ëó¯ => $F ‹—‘ø¶„) { $fÛŸÇÑ«¸º[$F‘ˆ¹ëó¯] = json_decode($F ‹—‘ø¶„[$Eä”Ø›¦Ø—[372]], !0); } goto FÅÇ±ç…; Dª á¨¹¢: $Eä”Ø›¦Ø— =& $_SERVER[©äõ½¡]; $Fí†ğ·Ù“Œ = array($Eä”Ø›¦Ø—[29] => $Eä”Ø›¦Ø—[1586]); if ($CÔõÔóÄ¢Ì) { $Fí†ğ·Ù“Œ[$Eä”Ø›¦Ø—[1564]] = $CÔõÔóÄ¢Ì; } goto dì‡Á÷º´Œ; F’¶ĞÚ§ÅÊ: } public static function valueSet($fæ‰êÌ¿¢î, $Eôºäø­‰›) { goto d‹ğ…¹ïÊí; aÇ°¢»õÖ: CacheLock::unlock($Dğ‡œçÖ™); goto EÎßá«×õ; d‹ğ…¹ïÊí: $fÌï§±Ñ‚ =& $_SERVER[©äõ½¡]; if (!$Eôºäø­‰›) { return Model($fÌï§±Ñ‚[439])->where(array($fÌï§±Ñ‚[93] => $fæ‰êÌ¿¢î, $fÌï§±Ñ‚[29] => $fÌï§±Ñ‚[1586]))->delete(); } $d¨ÖËò¤¾ = json_encode($Eôºäø­‰›); goto a…¯çáìÈ; a…¯çáìÈ: if (!$d¨ÖËò¤¾) { ob_start(); var_dump($Eôºäø­‰›); $bÀ÷§Ñé¦˜ = ob_get_clean(); self::log($fÌï§±Ñ‚[1587] . json_encode_force($bÀ÷§Ñé¦˜)); } if (!$fæ‰êÌ¿¢î || !$Eôºäø­‰›[$fÌï§±Ñ‚[395]]) { return !1; } $añò·ÚÁÓ = array($fÌï§±Ñ‚[29] => $fÌï§±Ñ‚[1586], $fÌï§±Ñ‚[1564] => USER_ID, $fÌï§±Ñ‚[93] => $fæ‰êÌ¿¢î, $fÌï§±Ñ‚[372] => $d¨ÖËò¤¾); goto d¥‹•¡Ç£ª; d¥‹•¡Ç£ª: $Dğ‡œçÖ™ = $fÌï§±Ñ‚[1588]; CacheLock::lock($Dğ‡œçÖ™); Model($fÌï§±Ñ‚[439])->add($añò·ÚÁÓ, array(), !0); goto aÇ°¢»õÖ; EÎßá«×õ: } public static function log($CÌÀöƒØŸà) { if (!GLOBAL_DEBUG) { return; } write_log($CÌÀöƒØŸà, $_SERVER[©äõ½¡][1589]); } } goto Fè­‹¿¸·; a˜‰ÔÏÃ°¥: class CommentModel extends ModelBase { protected $tableName = "\143\x6f\155\155\145\x6e\x74"; protected $tableMeta = array("\164\x61\142\x6c\145\116\141\x6d\145" => "\x63\157\155\155\145\156\164\137\x6d\x65\x74\141", "\155\x65\164\x61\x46\x69\x65\x6c\x64" => "\143\157\155\x6d\145\156\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 100000000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($aèœ¬¨óĞ‡) { $b‰è›ò‡†Ú =& $_SERVER[©äõ½¡]; if ($aèœ¬¨óĞ‡[$b‰è›ò‡†Ú[1761]]) { $d´®÷®å¾À = $this->where(array($b‰è›ò‡†Ú[1762] => $aèœ¬¨óĞ‡[$b‰è›ò‡†Ú[1761]]))->find(); if (!$d´®÷®å¾À || $d´®÷®å¾À[$b‰è›ò‡†Ú[406]] != $aèœ¬¨óĞ‡[$b‰è›ò‡†Ú[406]] || $d´®÷®å¾À[$b‰è›ò‡†Ú[498]] != $aèœ¬¨óĞ‡[$b‰è›ò‡†Ú[498]]) { return !1; } $this->where(array($b‰è›ò‡†Ú[1762] => $aèœ¬¨óĞ‡[$b‰è›ò‡†Ú[1761]]))->setAdd($b‰è›ò‡†Ú[1763], 1); } $aèœ¬¨óĞ‡[$b‰è›ò‡†Ú[1764]] = 0; $aèœ¬¨óĞ‡[$b‰è›ò‡†Ú[1763]] = 0; $aèœ¬¨óĞ‡[$b‰è›ò‡†Ú[745]] = 1; return $this->add($aèœ¬¨óĞ‡); } public function commentCount($bš×ÑˆÂš«, $A£œ¶œ…ñª, $EáÀâ¾¦‹• = false) { goto eíŸ‡á·¼á; AÛ¯´“Âª: $Aè¡ …Ğ‹¸ = $this->field($FÄò¾µã°ó)->where($F’¶¸àÙÒí)->group($a²©¿èî[498])->select(); return array_to_keyvalue($Aè¡ …Ğ‹¸, $a²©¿èî[498], $a²©¿èî[494]); goto aĞ¹¤‘˜»; bßØ³ˆ‰¡: $FÄò¾µã°ó = array($a²©¿èî[498], $a²©¿èî[1765] => $a²©¿èî[494]); $F’¶¸àÙÒí = array($a²©¿èî[498] => array($a²©¿èî[7], $bš×ÑˆÂš«), $a²©¿èî[406] => $A£œ¶œ…ñª); if ($EáÀâ¾¦‹•) { $F’¶¸àÙÒí[$a²©¿èî[1564]] = $EáÀâ¾¦‹•; } goto AÛ¯´“Âª; eíŸ‡á·¼á: $a²©¿èî =& $_SERVER[©äõ½¡]; if (!$bš×ÑˆÂš«) { return array(); } if (is_string($bš×ÑˆÂš«) || is_int($bš×ÑˆÂš«)) { $bš×ÑˆÂš« = array($bš×ÑˆÂš«); } goto bßØ³ˆ‰¡; aĞ¹¤‘˜»: } public function starTarget($fÃÈ¢ÖåÄ‡, $BÇŒåœâ©…) { goto Eå¬²«ä; dÓ–…ÁÎô: $eïõØÈ×§µ = $this->where($d’¡ÆØšê™)->find(); if ($eïõØÈ×§µ) { return $this->where(array($aŠ–áË¯´´[395] => $eïõØÈ×§µ[$aŠ–áË¯´´[395]]))->delete(); } $f§¦ƒÌÎ = array($aŠ–áË¯´´[1761] => 0, $aŠ–áË¯´´[1564] => USER_ID, $aŠ–áË¯´´[745] => 1, $aŠ–áË¯´´[750] => $aŠ–áË¯´´[33], $aŠ–áË¯´´[406] => $DŒù‹¹Ğ, $aŠ–áË¯´´[498] => $BÇŒåœâ©…, $aŠ–áË¯´´[1764] => 0, $aŠ–áË¯´´[1763] => 0); goto D³¹«·œŸ‚; Eå¬²«ä: $aŠ–áË¯´´ =& $_SERVER[©äõ½¡]; $DŒù‹¹Ğ = $fÃÈ¢ÖåÄ‡ + self::TYPE_STAR_OFFSET; $d’¡ÆØšê™ = array($aŠ–áË¯´´[1564] => USER_ID, $aŠ–áË¯´´[406] => $DŒù‹¹Ğ, $aŠ–áË¯´´[498] => $BÇŒåœâ©…); goto dÓ–…ÁÎô; D³¹«·œŸ‚: return $this->add($f§¦ƒÌÎ); goto Fì·ãğçãÒ; Fì·ãğçãÒ: } public function starTargetCount($e‰Ü°’ŸŠ, $EÃ×·ËÁó) { $dä´ø ª· =& $_SERVER[©äõ½¡]; $E¶áÖÂù¡ß = $EÃ×·ËÁó + self::TYPE_STAR_OFFSET; $fùÃ¥²¯¢å = $this->commentCount($e‰Ü°’ŸŠ, $E¶áÖÂù¡ß); $aˆÜÄÜê·« = $this->commentCount($e‰Ü°’ŸŠ, $E¶áÖÂù¡ß, USER_ID); return array($dä´ø ª·[1766] => $fùÃ¥²¯¢å, $dä´ø ª·[1767] => $aˆÜÄÜê·«); } public function starTargetUserList($d ©’‡Ü«, $B±Úš­¹äõ) { goto e£½Ò©³Á; E¤æ¦îÜÅô: $C”Ô×‹à‰Ö = $this->field($d“¿Œ”Ìò‰[1564])->where($aë’Ëš»«ì)->limit(500)->select(); $C”Ô×‹à‰Ö = array_to_keyvalue($C”Ô×‹à‰Ö, $d“¿Œ”Ìò‰[33], $d“¿Œ”Ìò‰[1564]); $e«È±Á­ù»[$d“¿Œ”Ìò‰[1768]] = Model($d“¿Œ”Ìò‰[507])->userListInfo($C”Ô×‹à‰Ö); goto B¼ƒÌÌø©½; A¯À¡ŸÎŒÃ: $DÒ‹œ²æßÉ = $this->where($aë’Ëš»«ì)->count(); $e«È±Á­ù» = array($d“¿Œ”Ìò‰[253] => $DÒ‹œ²æßÉ, $d“¿Œ”Ìò‰[1768] => array()); if (!$DÒ‹œ²æßÉ) { return $e«È±Á­ù»; } goto E¤æ¦îÜÅô; e£½Ò©³Á: $d“¿Œ”Ìò‰ =& $_SERVER[©äõ½¡]; $AŠ“§ˆÕ = $d ©’‡Ü« + self::TYPE_STAR_OFFSET; $aë’Ëš»«ì = array($d“¿Œ”Ìò‰[498] => $B±Úš­¹äõ, $d“¿Œ”Ìò‰[406] => $AŠ“§ˆÕ); goto A¯À¡ŸÎŒÃ; B¼ƒÌÌø©½: return $e«È±Á­ù»; goto D«¯Óè…‘; D«¯Óè…‘: } public function prasiseUserList($FŠ½­”Ë…×) { goto B–ÈâÑçÊ™; Bæõê‰çèÑ: $eäšõÄ„‚¬ = Model($dœ¤¨ËĞ»®[1770])->field($dœ¤¨ËĞ»®[1564])->where($BÌìØ×–ß)->limit(500)->select(); $eäšõÄ„‚¬ = array_to_keyvalue($eäšõÄ„‚¬, $dœ¤¨ËĞ»®[33], $dœ¤¨ËĞ»®[1564]); $fŒŞÖ˜…£‚[$dœ¤¨ËĞ»®[1768]] = Model($dœ¤¨ËĞ»®[507])->userListInfo($eäšõÄ„‚¬); goto e¢·†³²˜; B–ÈâÑçÊ™: $dœ¤¨ËĞ»® =& $_SERVER[©äõ½¡]; $BÌìØ×–ß = array($dœ¤¨ËĞ»®[1769] => $FŠ½­”Ë…×); $dÈÎáĞïÈ… = $this->where($BÌìØ×–ß)->find(); goto BÂğê´ùèÛ; BÂğê´ùèÛ: $Aƒ´çòÉ¤á = _get($dÈÎáĞïÈ…, $dœ¤¨ËĞ»®[1764], 0); $fŒŞÖ˜…£‚ = array($dœ¤¨ËĞ»®[253] => $Aƒ´çòÉ¤á, $dœ¤¨ËĞ»®[1768] => array()); if (!$Aƒ´çòÉ¤á) { return $fŒŞÖ˜…£‚; } goto Bæõê‰çèÑ; e¢·†³²˜: return $fŒŞÖ˜…£‚; goto e‰÷¤ÔŒ¼; e‰÷¤ÔŒ¼: } public function remove($bâ¹›‹šòÑ) { $Cæ „¡ƒ® =& $_SERVER[©äõ½¡]; $EÜ·åÃ“Ê§ = array($Cæ „¡ƒ®[1762] => $bâ¹›‹šòÑ); $C•ä‘ê¦ì¦ = $this->where($EÜ·åÃ“Ê§)->find(); if ($C•ä‘ê¦ì¦[$Cæ „¡ƒ®[1761]]) { $this->where(array($Cæ „¡ƒ®[1762] => $C•ä‘ê¦ì¦[$Cæ „¡ƒ®[1761]]))->setAdd($Cæ „¡ƒ®[1763], -1); } return $this->where($EÜ·åÃ“Ê§)->delete(); } public function edit($C‘“ŸğÇäŞ, $ağÉì‡ô©) { $CêÅšà›œ =& $_SERVER[©äõ½¡]; $Døî³ÁÆ© = array($CêÅšà›œ[1762] => $C‘“ŸğÇäŞ); return $this->where($Døî³ÁÆ©)->save(array($CêÅšà›œ[1771] => $ağÉì‡ô©)); } public function prasise($DÖ¦„‡…²å) { $a å²Åë»— =& $_SERVER[©äõ½¡]; $dÌô¬Ğ§ÀÒ = Model($a å²Åë»—[1772]); $CíÙøœöêö = array($a å²Åë»—[1762] => $DÖ¦„‡…²å, $a å²Åë»—[1555] => USER_ID); $CÃ˜Ùç‘°ö = $dÌô¬Ğ§ÀÒ->where($CíÙøœöêö)->find(); if (!$CÃ˜Ùç‘°ö) { $dÌô¬Ğ§ÀÒ->add($CíÙøœöêö); $CŠ¥¨¼Â‰ = $this->where(array($a å²Åë»—[1762] => $DÖ¦„‡…²å))->setAdd($a å²Åë»—[1764], 1); } else { $dÌô¬Ğ§ÀÒ->where($CíÙøœöêö)->delete(); $CŠ¥¨¼Â‰ = $this->where(array($a å²Åë»—[1762] => $DÖ¦„‡…²å))->setAdd($a å²Åë»—[1764], -1); } return $CŠ¥¨¼Â‰; } public function targetInfo($fß†ÂãƒÁ‰, $fÛäñÂ×Ú) { goto EË½ÏÛƒ•æ; EË½ÏÛƒ•æ: $CëËæ¡òÜ =& $_SERVER[©äõ½¡]; $a¢µ˜Ñ×éö = array($CëËæ¡òÜ[574] => $fß†ÂãƒÁ‰, $CëËæ¡òÜ[575] => $fÛäñÂ×Ú); $D™á¬ˆŠà = $this->where($a¢µ˜Ñ×éö)->count(); goto bŠãˆ«äÒ¦; bŠãˆ«äÒ¦: $C×§ƒà„ = "\122\111\107\110\x54\x20\x4a\x4f\111\x4e\x20{$this->tablePrefix}\x63\x6f\x6d\x6d\x65\x6e\x74\x5f\160\x72\x61\x69\x73\x65\40\163\x74\141\x72\x20\x6f\156\40\143\157\x6d\155\145\156\164\56\143\x6f\x6d\155\145\x6e\x74\111\x44\40\x3d\x20\x73\x74\x61\162\x2e\143\x6f\x6d\x6d\145\156\164\x49\104"; $d³¨°õ‹‘ê = $this->alias($CëËæ¡òÜ[352])->where($a¢µ˜Ñ×éö)->join($C×§ƒà„, $CëËæ¡òÜ[1773])->count(); $Cö¿‰›“ø = array($CëËæ¡òÜ[1774] => $D™á¬ˆŠà, $CëËæ¡òÜ[1775] => $d³¨°õ‹‘ê); goto e†óİ˜åá; e†óİ˜åá: return $Cö¿‰›“ø; goto F‚³ƒ¦ò‚§; F‚³ƒ¦ò‚§: } public function listData($c¨·©Úó´) { $FÈê´´‘¡î =& $_SERVER[©äõ½¡]; if (isset($c¨·©Úó´[$FÈê´´‘¡î[1776]])) { if ($c¨·©Úó´[$FÈê´´‘¡î[1776]]) { $c¨·©Úó´[$FÈê´´‘¡î[1769]] = array($FÈê´´‘¡î[1006], intval($c¨·©Úó´[$FÈê´´‘¡î[1776]])); } unset($c¨·©Úó´[$FÈê´´‘¡î[1776]]); } if (isset($c¨·©Úó´[$FÈê´´‘¡î[1777]])) { if ($c¨·©Úó´[$FÈê´´‘¡î[1777]]) { $c¨·©Úó´[$FÈê´´‘¡î[1769]] = array($FÈê´´‘¡î[1003], intval($c¨·©Úó´[$FÈê´´‘¡î[1777]])); } unset($c¨·©Úó´[$FÈê´´‘¡î[1777]]); } return $this->_listData($c¨·©Úó´); } private function _listData($c¯…ÅŞæÖØ) { $Fğùº¤Ï¢  =& $_SERVER[©äõ½¡]; $bÖ¸ğ•Ğ¤Ğ = $this->where($c¯…ÅŞæÖØ)->_makeOrder()->selectPage(100); $this->_listAppendParent($bÖ¸ğ•Ğ¤Ğ[$Fğùº¤Ï¢ [367]]); $this->_listAppendUser($bÖ¸ğ•Ğ¤Ğ[$Fğùº¤Ï¢ [367]]); $this->_listAppendMeta($bÖ¸ğ•Ğ¤Ğ[$Fğùº¤Ï¢ [367]]); return $bÖ¸ğ•Ğ¤Ğ; } private function _makeOrder() { $B…¥ïéº’« =& $_SERVER[©äõ½¡]; $B‚»É”Ö– = array($B…¥ïéº’«[1764], $B…¥ïéº’«[1763], $B…¥ïéº’«[194]); $CÅ»Â•ø¯Î = Input::get($B…¥ïéº’«[449], $B…¥ïéº’«[7], $B…¥ïéº’«[418], $B‚»É”Ö–); $fŠ”²ƒğë× = Input::get($B…¥ïéº’«[450], $B…¥ïéº’«[7], $B…¥ïéº’«[1557], array($B…¥ïéº’«[1778], $B…¥ïéº’«[445])); $fÂÇö…âóÀ = $CÅ»Â•ø¯Î . $B…¥ïéº’«[50] . $fŠ”²ƒğë×; return $this->order($fÂÇö…âóÀ); } private function _listAppendParent(&$dê¡éâæŒ) { goto Eù—«Õá±ß; cíµ¡çé¯”: foreach ($dê¡éâæŒ as &$DòêãÇğØš) { if (isset($B£ŒøŸ‡©[$DòêãÇğØš[$bò·š†é¡¿[1761]]])) { $DòêãÇğØš[$bò·š†é¡¿[1779]] = $B£ŒøŸ‡©[$DòêãÇğØš[$bò·š†é¡¿[1761]]]; } } unset($DòêãÇğØš); goto FŠî¯„Äåù; Eù—«Õá±ß: $bò·š†é¡¿ =& $_SERVER[©äõ½¡]; $C‚ÆéÖµ©‘ = array_unique(array_to_keyvalue($dê¡éâæŒ, $bò·š†é¡¿[33], $bò·š†é¡¿[1761])); $C‚ÆéÖµ©‘ = array_remove_value($C‚ÆéÖµ©‘, $bò·š†é¡¿[191]); goto Eõğäã­²; Eõğäã­²: if (!$C‚ÆéÖµ©‘) { return; } $B£ŒøŸ‡© = $this->where(array($bò·š†é¡¿[1762] => array($bò·š†é¡¿[7], $C‚ÆéÖµ©‘)))->select(); $B£ŒøŸ‡© = array_to_keyvalue($B£ŒøŸ‡©, $bò·š†é¡¿[1769]); goto cíµ¡çé¯”; FŠî¯„Äåù: } private function _listAppendUser(&$cèÓ‚ŞÈğŞ) { goto EŒŒÂ¨ÆÆ†; c™Ù®Ï„¤: foreach ($cèÓ‚ŞÈğŞ as &$dÒ‘Ë­àßƒ) { $dÒ‘Ë­àßƒ[$AÌ¢œ„ŠÉ[588]] = $BŠ†˜›ÖÑ¯[$dÒ‘Ë­àßƒ[$AÌ¢œ„ŠÉ[1564]]]; if (isset($dÒ‘Ë­àßƒ[$AÌ¢œ„ŠÉ[1779]])) { $dÒ‘Ë­àßƒ[$AÌ¢œ„ŠÉ[1779]][$AÌ¢œ„ŠÉ[588]] = $BŠ†˜›ÖÑ¯[$dÒ‘Ë­àßƒ[$AÌ¢œ„ŠÉ[1779]][$AÌ¢œ„ŠÉ[1564]]]; } } unset($dÒ‘Ë­àßƒ); goto AÖ¹Ú­‡ª¨; A±¦²‰‹øÕ: if (count($FİØ×†Ü›ñ) == 0) { return; } foreach ($cèÓ‚ŞÈğŞ as $dÒ‘Ë­àßƒ) { if (isset($dÒ‘Ë­àßƒ[$AÌ¢œ„ŠÉ[1779]])) { $FİØ×†Ü›ñ[] = $dÒ‘Ë­àßƒ[$AÌ¢œ„ŠÉ[1779]][$AÌ¢œ„ŠÉ[1564]]; } } $BŠ†˜›ÖÑ¯ = Model($AÌ¢œ„ŠÉ[532])->userListInfo($FİØ×†Ü›ñ); goto c™Ù®Ï„¤; EŒŒÂ¨ÆÆ†: $AÌ¢œ„ŠÉ =& $_SERVER[©äõ½¡]; $FİØ×†Ü›ñ = array_unique(array_to_keyvalue($cèÓ‚ŞÈğŞ, $AÌ¢œ„ŠÉ[33], $AÌ¢œ„ŠÉ[1564])); $FİØ×†Ü›ñ = array_remove_value($FİØ×†Ü›ñ, $AÌ¢œ„ŠÉ[191]); goto A±¦²‰‹øÕ; AÖ¹Ú­‡ª¨: } private function _listAppendMeta(&$EÚğ„æùÍ) { goto fİŠ´­øŒ×; fİŠ´­øŒ×: $aÑàğƒİêé =& $_SERVER[©äõ½¡]; $bš—†Ææ“ = array_unique(array_to_keyvalue($EÚğ„æùÍ, $aÑàğƒİêé[33], $aÑàğƒİêé[1769])); $bš—†Ææ“ = array_remove_value($bš—†Ææ“, $aÑàğƒİêé[191]); goto añŒ¾ù«¦Ê; FÆ§Ôê·É: if (!$EˆÛÜèÓ‡ø) { return !1; } foreach ($EÚğ„æùÍ as &$B±Ò·¢ˆ—) { $B±Ò·¢ˆ—[$aÑàğƒİêé[459]] = $EˆÛÜèÓ‡ø[$B±Ò·¢ˆ—[$aÑàğƒİêé[1769]]]; if (isset($B±Ò·¢ˆ—[$aÑàğƒİêé[1779]])) { $B±Ò·¢ˆ—[$aÑàğƒİêé[1779]][$aÑàğƒİêé[459]] = $EˆÛÜèÓ‡ø[$B±Ò·¢ˆ—[$aÑàğƒİêé[1779]][$aÑàğƒİêé[1769]]]; } } unset($B±Ò·¢ˆ—); goto BºÅôÌç„±; añŒ¾ù«¦Ê: if (!$bš—†Ææ“) { return; } foreach ($EÚğ„æùÍ as $B±Ò·¢ˆ—) { if (isset($B±Ò·¢ˆ—[$aÑàğƒİêé[1779]])) { $bš—†Ææ“[] = $B±Ò·¢ˆ—[$aÑàğƒİêé[1779]][$aÑàğƒİêé[1769]]; } } $EˆÛÜèÓ‡ø = $this->metaList($bš—†Ææ“); goto FÆ§Ôê·É; BºÅôÌç„±: } private function metaList($b‘ÁÈ›º£) { goto DŸ£ëÇˆã¶; BÏƒç¾Ìè³: $Eô…‚ù±é” = Model($B†Å¥¾¼ÊŞ[1780])->where($DŒ‹î¶¦ß)->select(); $Eô…‚ù±é” = array_to_keyvalue_group($Eô…‚ù±é”, $B†Å¥¾¼ÊŞ[1769]); foreach ($Eô…‚ù±é” as $EêÈ‘ÉòØ¾ => $b‚ƒ´—’â) { $aĞœÅ»×Ã = array(); foreach ($b‚ƒ´—’â as $fËï¯Û‹ì–) { $aĞœÅ»×Ã[$fËï¯Û‹ì–[$B†Å¥¾¼ÊŞ[93]]] = $fËï¯Û‹ì–[$B†Å¥¾¼ÊŞ[372]]; } $Eô…‚ù±é”[$EêÈ‘ÉòØ¾] = $aĞœÅ»×Ã; } goto EÉæˆ¢Æ•; DŸ£ëÇˆã¶: $B†Å¥¾¼ÊŞ =& $_SERVER[©äõ½¡]; if (!$b‘ÁÈ›º£) { return array(); } $DŒ‹î¶¦ß = array($B†Å¥¾¼ÊŞ[1769] => array($B†Å¥¾¼ÊŞ[7], $b‘ÁÈ›º£)); goto BÏƒç¾Ìè³; EÉæˆ¢Æ•: return $Eô…‚ù±é” ? $Eô…‚ù±é” : array(); goto eÁÉ‚›•Ä; eÁÉ‚›•Ä: } } class FileContentModel extends ModelBase { protected $tableName = "\151\x6f\137\x66\151\x6c\x65\137\143\x6f\x6e\x74\145\x6e\164\163"; protected $dataAuto = array(array("\143\x72\x65\x61\164\145\x54\x69\155\x65", "\x74\x69\x6d\x65", "\151\156\163\x65\x72\164", "\146\165\156\143\x74\x69\157\x6e")); } class FileModel extends ModelBase { protected $tableName = "\151\157\137\x66\x69\154\x65"; protected $tableMeta = array("\164\x61\142\x6c\x65\116\x61\155\x65" => "\151\x6f\137\146\151\x6c\x65\137\x6d\x65\164\141", "\155\x65\x74\141\x46\151\x65\154\144" => "\x66\x69\x6c\145\111\104"); public function fileInfo($a¤Æ¡Í¸ïø) { $A¼çĞ‰…— =& $_SERVER[©äõ½¡]; static $bš–‹Ø‘Äà = array(); if (!isset($bš–‹Ø‘Äà[$a¤Æ¡Í¸ïø])) { $F³í„¬Î²ª = $A¼çĞ‰…—[1781]; $CÑ´åÀã¾Ø = Model($A¼çĞ‰…—[464])->field($F³í„¬Î²ª)->where(array($A¼çĞ‰…—[462] => $a¤Æ¡Í¸ïø))->find(); $bš–‹Ø‘Äà[$a¤Æ¡Í¸ïø] = $CÑ´åÀã¾Ø; } return $bš–‹Ø‘Äà[$a¤Æ¡Í¸ïø]; } public function addFileByContent($DùŸ¹ÁŒ· = '', $d•†œŸ = '') { goto Dø‡”©Í†¡; Dø‡”©Í†¡: $Bªâ‡Ÿí»ê =& $_SERVER[©äõ½¡]; $FÚÕ‘êÍÑ’ = TEMP_PATH . $Bªâ‡Ÿí»ê[1782]; if (!is_dir($FÚÕ‘êÍÑ’)) { mk_dir($FÚÕ‘êÍÑ’); } goto f•Ù£ÉÚ‹; f•Ù£ÉÚ‹: $a‡£ ÕŸ = $FÚÕ‘êÍÑ’ . $Bªâ‡Ÿí»ê[1783] . rand_string(16); file_put_contents($a‡£ ÕŸ, $DùŸ¹ÁŒ·); $D‰Ô„†™‰‘ = $this->addFile($a‡£ ÕŸ, $d•†œŸ, !0); goto f©İŒâõ™; f©İŒâõ™: if (file_exists($a‡£ ÕŸ)) { @unlink($a‡£ ÕŸ); } return $D‰Ô„†™‰‘; goto eÅª¼¹œÙ; eÅª¼¹œÙ: } public function createFileName($dˆ·îá‹Ñ“, $aö°·ŠØË… = false, $CÊàí¥¿Å = false) { goto cõ¦µÃ‘â¼; fïÍ÷©ÖÈ: if (!$b´¼éºĞªª && !Cache::get($eõÍòˆ¢ñ)) { $b´¼éºĞªª = !0; $e‚¨¸¹ÒŞî = IO::mkdir($AĞĞÕÂì‚¼); if (!IO::exist($e‚¨¸¹ÒŞî . $e‹¤ ”±¹[798])) { IO::mkfile($e‚¨¸¹ÒŞî . $e‹¤ ”±¹[798]); } Cache::set($eõÍòˆ¢ñ, 1, 3600 * 2); } return $d Ùœªâ¦‚; goto f§ÔÕ­‘à®; cõ¦µÃ‘â¼: $e‹¤ ”±¹ =& $_SERVER[©äõ½¡]; $Dš‰’Ó¤³– = IO::init($e‹¤ ”±¹[8]); $d Ùœªâ¦‚ = $this->makeFilePath($dˆ·îá‹Ñ“, $Dš‰’Ó¤³–, $aö°·ŠØË…, $CÊàí¥¿Å); goto Fù»»†ßä; Fù»»†ßä: $AĞĞÕÂì‚¼ = $Dš‰’Ó¤³–->pathFather($d Ùœªâ¦‚); static $b´¼éºĞªª = false; $eõÍòˆ¢ñ = $e‹¤ ”±¹[1784] . md5($AĞĞÕÂì‚¼); goto fïÍ÷©ÖÈ; f§ÔÕ­‘à®: } public function makeFilePath($f¼‘ÄóÓä, $f™‡¸ÕŒ, $AÊšœèª = false, $DëÛëËÌ¼£ = false) { goto Bˆâ˜õìŒ; AµõùÈ×‘ä: $a¾±ãˆªâ = $dŠ±×È†É . rand_string(5) . short_id(100); $f¼‘ÄóÓä = str_replace($AÖº•„Ìßã[8], $AÖº•„Ìßã[71], KodIO::clear($f¼‘ÄóÓä)); $b¢Ç¿åÇƒĞ = $f™‡¸ÕŒ->ext($f¼‘ÄóÓä); goto c›–Œù¸¸¢; Bˆâ˜õìŒ: $AÖº•„Ìßã =& $_SERVER[©äõ½¡]; $añÓò—Àğ = Model($AÖº•„Ìßã[765])->get($AÖº•„Ìßã[1785]); $dŠ±×È†É = KodIO::defaultIO() . date($AÖº•„Ìßã[1786]); goto AµõùÈ×‘ä; c›–Œù¸¸¢: if (!$f¼‘ÄóÓä) { $añÓò—Àğ = $AÖº•„Ìßã[1787]; } switch ($añÓò—Àğ) { case $AÖº•„Ìßã[1788]: $a¾±ãˆªâ = $a¾±ãˆªâ . $AÖº•„Ìßã[95] . $f™‡¸ÕŒ->ext($f¼‘ÄóÓä); if ($b¢Ç¿åÇƒĞ == $AÖº•„Ìßã[1723]) { $a¾±ãˆªâ .= $AÖº•„Ìßã[1461]; } break; case $AÖº•„Ìßã[1789]: goto F‡íŞ‡ù‹º; C²Ğ¿ªâŠÅ: if (IO::isTypeObject($a¾±ãˆªâ) && !IO::isUploadServer($a¾±ãˆªâ)) { if (IO::exist($a¾±ãˆªâ)) { return $a¾±ãˆªâ; } $dÁÙ¯ºÕ = IO::setContent($a¾±ãˆªâ, $AÖº•„Ìßã[33]); if (!$dÁÙ¯ºÕ) { show_json($AÖº•„Ìßã[1792], !1); } } CacheLock::unlock($fäŒ»ì†ƒÓ); break; goto F—ÒêÄŸã; A–ÕØ¡ôŒ”: CacheLock::lock($fäŒ»ì†ƒÓ); $a¾±ãˆªâ = $dŠ±×È†É . $f¼‘ÄóÓä; if (IO::exist($dŠ±×È†É . $f¼‘ÄóÓä)) { $Fò‹óéß¢È = substr($f¼‘ÄóÓä, 0, strlen($f¼‘ÄóÓä) - strlen($b¢Ç¿åÇƒĞ)); $B½ï¸™ŞœÒ = $DëÛëËÌ¼£ ? substr($DëÛëËÌ¼£, 0, 5) : ($AÊšœèª ? substr($AÊšœèª, 0, 5) : rand_string(5)); $a¾±ãˆªâ = $dŠ±×È†É . $Fò‹óéß¢È . $B½ï¸™ŞœÒ . $AÖº•„Ìßã[95] . $b¢Ç¿åÇƒĞ; } goto C²Ğ¿ªâŠÅ; dõê¬£ºº: $dŠ±×È†É = $AÖº•„Ìßã[1157] . $e¥Ó“ä‚ºÃ[$AÖº•„Ìßã[395]] . $AÖº•„Ìßã[404] . date($AÖº•„Ìßã[1790]) . $E¡ªÕ»Ê›¨ . $AÖº•„Ìßã[8]; if ($b¢Ç¿åÇƒĞ == $AÖº•„Ìßã[1723]) { $f¼‘ÄóÓä .= $AÖº•„Ìßã[1461]; } $fäŒ»ì†ƒÓ = $AÖº•„Ìßã[1791] . $dŠ±×È†É . $f¼‘ÄóÓä; goto A–ÕØ¡ôŒ”; F‡íŞ‡ù‹º: $Eñ»æ»¢ó = Model($AÖº•„Ìßã[765])->get($AÖº•„Ìßã[766]); $E¡ªÕ»Ê›¨ = substr(md5($AÖº•„Ìßã[767] . $Eñ»æ»¢ó . date($AÖº•„Ìßã[743])), 0, 8); $e¥Ó“ä‚ºÃ = KodIO::defaultDriver(); goto dõê¬£ºº; F—ÒêÄŸã: case $AÖº•„Ìßã[1787]: break; default: break; } return $a¾±ãˆªâ; goto fÔÀ·¢³­Å; fÔÀ·¢³­Å: } public function addFileByRemote($cä»ôÚ·¦, $d²±Şº , $eª¾ğ«àÊ = array()) { goto BÇÔßÇÚŠ; e“íá…‹…: $aƒ¡å´‚©Ì = IO::hashMd5($cä»ôÚ·¦, $dà‚¾ËÆ¡„); $FêàøÃÔÑÑ = KodIO::defaultDriver(); $C²œÙÄçø = array($D¬ƒ“•ŒÄ[573] => IO::size($cä»ôÚ·¦), $D¬ƒ“•ŒÄ[1793] => 1, $D¬ƒ“•ŒÄ[415] => $d²±Şº , $D¬ƒ“•ŒÄ[810] => $FêàøÃÔÑÑ[$D¬ƒ“•ŒÄ[395]], $D¬ƒ“•ŒÄ[416] => $cä»ôÚ·¦, $D¬ƒ“•ŒÄ[1794] => $eª¾ğ«àÊ[$D¬ƒ“•ŒÄ[171]] ? $eª¾ğ«àÊ[$D¬ƒ“•ŒÄ[171]] : IO::hashSimple($cä»ôÚ·¦), $D¬ƒ“•ŒÄ[1795] => $aƒ¡å´‚©Ì ? $aƒ¡å´‚©Ì : $dà‚¾ËÆ¡„); goto FàÔÚàæ‡; FàÔÚàæ‡: if ($fŒñ‘æÖæí = $this->addFileCheckExist($C²œÙÄçø[$D¬ƒ“•ŒÄ[171]], $C²œÙÄçø[$D¬ƒ“•ŒÄ[170]], $C²œÙÄçø[$D¬ƒ“•ŒÄ[78]])) { return $fŒñ‘æÖæí; } return $this->addFileData($C²œÙÄçø); goto c¢àÚßœç½; BÇÔßÇÚŠ: $D¬ƒ“•ŒÄ =& $_SERVER[©äõ½¡]; if (!IO::exist($cä»ôÚ·¦)) { return !1; } $dà‚¾ËÆ¡„ = $eª¾ğ«àÊ[$D¬ƒ“•ŒÄ[170]] ? $eª¾ğ«àÊ[$D¬ƒ“•ŒÄ[170]] : $D¬ƒ“•ŒÄ[33]; goto e“íá…‹…; c¢àÚßœç½: } private function addFileData($FÇğÛ±Õğİ) { $b®†¨Ü©½ =& $_SERVER[©äõ½¡]; if (!$FÇğÛ±Õğİ) { return !1; } $FÇğÛ±Õğİ[$b®†¨Ü©½[78]] = intval($FÇğÛ±Õğİ[$b®†¨Ü©½[78]]); if (!$FÇğÛ±Õğİ[$b®†¨Ü©½[78]] && strlen($FÇğÛ±Õğİ[$b®†¨Ü©½[171]]) > 32) { $FÇğÛ±Õğİ[$b®†¨Ü©½[78]] = intval(substr($FÇğÛ±Õğİ[$b®†¨Ü©½[171]], 32)); } $céÒä˜…ß¼ = $this->add($FÇğÛ±Õğİ); return $this->find($céÒä˜…ß¼); } public function addFile($FêÑ‰ÚÀ®¢, $f¯ò«ö’„, $cìœÌƒ»± = false) { goto cÂêòòÎµ«; E¦™ìµÇáŒ: $c‰Š«ëŞÔ = $_SERVER[©äõ½¡][1796] . $C‰±®„öó¹; CacheLock::lock($c‰Š«ëŞÔ); if ($c­­ÚùŸÎ = $this->addFileCheckExist($dÙ…–çÌ‚½, $C‰±®„öó¹, $A“‚•êõ¼‡)) { CacheLock::unlock($c‰Š«ëŞÔ); return $c­­ÚùŸÎ; } goto Aíêë„•Ø–; cÂêòòÎµ«: $dÙ…–çÌ‚½ = IO::hashSimple($FêÑ‰ÚÀ®¢); $C‰±®„öó¹ = IO::hashMd5($FêÑ‰ÚÀ®¢); $A“‚•êõ¼‡ = IO::size($FêÑ‰ÚÀ®¢); goto E¦™ìµÇáŒ; Aíêë„•Ø–: $AŠ¥µ°õ = $this->addFileMake($FêÑ‰ÚÀ®¢, $A“‚•êõ¼‡, $dÙ…–çÌ‚½, $C‰±®„öó¹, $f¯ò«ö’„, $cìœÌƒ»±); $dŞÉ´Ç¶Ç… = $this->addFileData($AŠ¥µ°õ); CacheLock::unlock($c‰Š«ëŞÔ); goto EÄŸšìºåè; EÄŸšìºåè: return $dŞÉ´Ç¶Ç…; goto aÜïŸ‹ÕØˆ; aÜïŸ‹ÕØˆ: } public function addFileMake($bŠÈëøãÍ…, $b®È’Ğ…İ, $dÆí™ˆ, $ešÄ‡¿Š‚, $AÔä¸ˆÚ§, $F»ì¿“¥à¤) { goto Cêİì×ó; E†Õõ­ñÑ: $cÌÁ™”’ğÖ = get_path_this($BŒéõ¥Å); if ($F»ì¿“¥à¤) { $bÔíË‡­™ = IO::move($bŠÈëøãÍ…, $a·ŠØ‡†ğ¸, !1, $cÌÁ™”’ğÖ); } else { $bÔíË‡­™ = IO::copy($bŠÈëøãÍ…, $a·ŠØ‡†ğ¸, !1, $cÌÁ™”’ğÖ); } if (!$bÔíË‡­™) { return !1; } goto Dö š‘®’; Dö š‘®’: $fí…¤“¬Ğ§ = KodIO::defaultDriver(); $bƒ«©Œ¥†» = array($Cñ¶¸òÚé–[573] => $b®È’Ğ…İ, $Cñ¶¸òÚé–[1793] => 1, $Cñ¶¸òÚé–[415] => $AÔä¸ˆÚ§, $Cñ¶¸òÚé–[810] => $fí…¤“¬Ğ§[$Cñ¶¸òÚé–[395]], $Cñ¶¸òÚé–[416] => $BŒéõ¥Å, $Cñ¶¸òÚé–[1794] => $dÆí™ˆ, $Cñ¶¸òÚé–[1795] => $ešÄ‡¿Š‚); return $bƒ«©Œ¥†»; goto B®Ô§®íóÂ; Cêİì×ó: $Cñ¶¸òÚé– =& $_SERVER[©äõ½¡]; $BŒéõ¥Å = $this->createFileName($AÔä¸ˆÚ§, $dÆí™ˆ, $ešÄ‡¿Š‚); $a·ŠØ‡†ğ¸ = get_path_father($BŒéõ¥Å); goto E†Õõ­ñÑ; B®Ô§®íóÂ: } public function addFileCheckExist($A›ğÍÌ¡ê½, $c´ù¡çÀ‹ø, $aäÏèç­Û) { $cí´ÈÒ©á =& $_SERVER[©äõ½¡]; $Bé¡©—ê«˜ = $this->findByHash($A›ğÍÌ¡ê½, $c´ù¡çÀ‹ø); if (!$Bé¡©—ê«˜) { return !1; } $bëœ¤¾¦†Œ = array($cí´ÈÒ©á[1793] => intval($Bé¡©—ê«˜[$cí´ÈÒ©á[1797]]) + 1, $cí´ÈÒ©á[573] => $aäÏèç­Û); $this->where(array($cí´ÈÒ©á[462] => $Bé¡©—ê«˜[$cí´ÈÒ©á[461]]))->save($bëœ¤¾¦†Œ); return $Bé¡©—ê«˜; } public function remove($Cñ‹ù²ŠÜ) { $this->linkCountChange($Cñ‹ù²ŠÜ, !1); $this->clearEmpty(); return !0; } public function linkAdd($f‘ğ‰¡Óù) { $this->linkCountChange($f‘ğ‰¡Óù, !0); } public function linkCountChange($E‚ ß»Ş¢«, $A¡ï¿ÍÍªİ) { goto A³œ’µ’©; dğóò¤¢Í: $EÀ˜––¢Ø¦ = array(); foreach ($E‚ ß»Ş¢« as $EÏò¶²¶) { $e¦ÃÊ‘§™ = $EÏò¶²¶ . $a›—µ[33]; if (!$EÀ˜––¢Ø¦[$e¦ÃÊ‘§™]) { $EÀ˜––¢Ø¦[$e¦ÃÊ‘§™] = 0; } $EÀ˜––¢Ø¦[$e¦ÃÊ‘§™]++; } $AÅÛ‡Í¾Ø° = array(); goto CáÌ¤Ä¶ ; CáÌ¤Ä¶ : foreach ($EÀ˜––¢Ø¦ as $EÏò¶²¶ => $a¯×ğ–¸ê›) { $e¦ÃÊ‘§™ = $a¯×ğ–¸ê› . $a›—µ[33]; if (!$AÅÛ‡Í¾Ø°[$e¦ÃÊ‘§™]) { $AÅÛ‡Í¾Ø°[$e¦ÃÊ‘§™] = array(); } $AÅÛ‡Í¾Ø°[$e¦ÃÊ‘§™][] = $EÏò¶²¶; } foreach ($AÅÛ‡Í¾Ø° as $a¯×ğ–¸ê› => $Eµêƒâ—Ï) { if (!$Eµêƒâ—Ï) { continue; } $a¯×ğ–¸ê› = $A¡ï¿ÍÍªİ ? $a¯×ğ–¸ê› : -intval($a¯×ğ–¸ê›); $c•›æ¤–ƒ = array($a›—µ[461] => array($a›—µ[7], $Eµêƒâ—Ï)); if ($a¯×ğ–¸ê› < 0) { $c•›æ¤–ƒ[$a›—µ[1797]] = array($a›—µ[1007], abs($a¯×ğ–¸ê›)); } $this->where($c•›æ¤–ƒ)->setAdd($a›—µ[1797], $a¯×ğ–¸ê›); } goto aÎ…¯Îçàì; A³œ’µ’©: $a›—µ =& $_SERVER[©äõ½¡]; if (!$E‚ ß»Ş¢«) { return; } if (!is_array($E‚ ß»Ş¢«)) { $E‚ ß»Ş¢« = array($E‚ ß»Ş¢«); } goto dğóò¤¢Í; aÎ…¯Îçàì: } public function findByHash($a„˜£µ¡»ó, $c¡óô†Ìè = false) { $b±Ï‚²ÛìŞ =& $_SERVER[©äõ½¡]; if (!$a„˜£µ¡»ó && !$c¡óô†Ìè) { return !1; } $E¡èÄ°ƒ—¦ = array($b±Ï‚²ÛìŞ[1794] => $a„˜£µ¡»ó); if ($c¡óô†Ìè) { $E¡èÄ°ƒ—¦ = array($b±Ï‚²ÛìŞ[1795] => $c¡óô†Ìè); } return $this->order($b±Ï‚²ÛìŞ[1798])->where($E¡èÄ°ƒ—¦)->find(); } public function clearEmpty($BÇ‡“”—²­ = 0) { goto Cè¨•øèó; Cè¨•øèó: $f¬åÍ¿ŸÙ =& $_SERVER[©äõ½¡]; $D‰×ÄÏ…ğñ = time() - 3600 * 24 * $BÇ‡“”—²­; $AÁ„â¹¼³â = $f¬åÍ¿ŸÙ[1799] . $D‰×ÄÏ…ğñ; goto DÃåÍÂ–ØÀ; EöéÚŠªî‹: foreach ($B„òâÙíÚÂ as $BÖ‡Ê“å¹ô) { $aÒ–¡ƒ¡ù‘->update(1); $this->resetFile($BÖ‡Ê“å¹ô); } $aÒ–¡ƒ¡ù‘->end(); goto bœÉ›´“­; DÃåÍÂ–ØÀ: $B„òâÙíÚÂ = $this->where($AÁ„â¹¼³â)->select(); if (!$B„òâÙíÚÂ) { return; } $aÒ–¡ƒ¡ù‘ = new Task($f¬åÍ¿ŸÙ[1800], $f¬åÍ¿ŸÙ[33], count($B„òâÙíÚÂ)); goto EöéÚŠªî‹; bœÉ›´“­: } public function resetFile($e¦¨Öù­¿À) { goto B¨ ÷Å¿È; a•òø‚”—Ô: $Dâ¯ÇŞçµ… = Model($Cõ¿ÔÉ—Œ·[1801])->where($A¡é¤§Ší÷)->count(); $fÕ¶°å× = intval($a°‚ó¾†²Ü) + intval($Dâ¯ÇŞçµ…); if ($fÕ¶°å× == 0) { IO::remove($e¦¨Öù­¿À[$Cõ¿ÔÉ—Œ·[76]]); Model($Cõ¿ÔÉ—Œ·[1802])->delete($e¦¨Öù­¿À[$Cõ¿ÔÉ—Œ·[461]]); $this->where($A¡é¤§Ší÷)->delete(); $this->metaSet($e¦¨Öù­¿À[$Cõ¿ÔÉ—Œ·[461]], null, null); return; } goto fŒòÁ£Ó¾‘; fŒòÁ£Ó¾‘: if ($e¦¨Öù­¿À[$Cõ¿ÔÉ—Œ·[1797]] != $fÕ¶°å×) { $this->where($A¡é¤§Ší÷)->save(array($Cõ¿ÔÉ—Œ·[1793] => $fÕ¶°å×)); } goto a›†·Ğ; B¨ ÷Å¿È: $Cõ¿ÔÉ—Œ· =& $_SERVER[©äõ½¡]; $A¡é¤§Ší÷ = array($Cõ¿ÔÉ—Œ·[462] => $e¦¨Öù­¿À[$Cõ¿ÔÉ—Œ·[461]]); $a°‚ó¾†²Ü = Model($Cõ¿ÔÉ—Œ·[1239])->where($A¡é¤§Ší÷)->count(); goto a•òø‚”—Ô; a›†·Ğ: } public function storageInfo($a¢áÚôÄŠ÷ = false) { goto e“¨Ù¡¸ÕÈ; C®£·İœá—: $A­šß¤ä¥ğ = 1; $b‹¡¼ö¨¹ = 0; $aâçğá¿÷¨ = 5000; goto Eõ Ì¾‹²Í; e“¨Ù¡¸ÕÈ: $A¼ê¡àŸÇ« =& $_SERVER[©äõ½¡]; $A‰èÂ„šƒ‚ = $this->count() + 0.0; $f‚‡Î†İö× = 0; goto C®£·İœá—; Eõ Ì¾‹²Í: for ($CëÏ†×ôø = 0; $CëÏ†×ôø < $A‰èÂ„šƒ‚; $CëÏ†×ôø = $CëÏ†×ôø + $aâçğá¿÷¨) { $BÃÂˆùí˜ = $this->limit($CëÏ†×ôø, $CëÏ†×ôø + $aâçğá¿÷¨)->select(); foreach ($BÃÂˆùí˜ as $Fí¤Ò·š¶„) { $A­šß¤ä¥ğ += $Fí¤Ò·š¶„[$A¼ê¡àŸÇ«[78]] * $Fí¤Ò·š¶„[$A¼ê¡àŸÇ«[1797]]; $f‚‡Î†İö× += $Fí¤Ò·š¶„[$A¼ê¡àŸÇ«[78]] * ($Fí¤Ò·š¶„[$A¼ê¡àŸÇ«[1797]] - 1); $b‹¡¼ö¨¹ += $Fí¤Ò·š¶„[$A¼ê¡àŸÇ«[1797]]; } } $fõ—Ş‹Ôïµ = array($A¼ê¡àŸÇ«[1803] => $A­šß¤ä¥ğ, $A¼ê¡àŸÇ«[1804] => $f‚‡Î†İö×, $A¼ê¡àŸÇ«[1805] => $f‚‡Î†İö× / $A­šß¤ä¥ğ, $A¼ê¡àŸÇ«[82] => $A‰èÂ„šƒ‚, $A¼ê¡àŸÇ«[1806] => $b‹¡¼ö¨¹); return $fõ—Ş‹Ôïµ; goto A¶¥×÷¿‚ó; A¶¥×÷¿‚ó: } } goto f•Ö¾¹æ—; C£¥Óƒ°Ëİ: function binCheckBigger($Fì¶ÉŞôóº, $aìèˆ‰ãí) { return $Fì¶ÉŞôóº > $aìèˆ‰ãí; } $_SERVER[$_SERVER[“´Ë³Æ][3]] = ("\x39\x32\x34\x36".strrev('61'))+0;$_c7yx="I9FUDdjgA2JvWNFGhGvDUANe8hIrSJpjSkZc9HusEEmVf8MmXY7Bxyj3hUQYXtCniesZTDRIuk";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($DÅ¬—Â÷Ã—, $d¿ÕÎ‡îÜ) { $A¹ÍÈëÔ =& $_SERVER[©äõ½¡]; if (isset(self::$_methodList[$DÅ¬—Â÷Ã—])) { return @call_user_func_array(self::$_methodList[$DÅ¬—Â÷Ã—], $d¿ÕÎ‡îÜ); } else { if (method_exists($this, $DÅ¬—Â÷Ã—)) { return call_user_func_array(array($this, $DÅ¬—Â÷Ã—), $d¿ÕÎ‡îÜ); } else { think_exception(__CLASS__ . $A¹ÍÈëÔ[4] . $DÅ¬—Â÷Ã— . $A¹ÍÈëÔ[5]); } } } public static function __callStatic($B’ó‘ğÊâ°, $d†­®ã¤­) { if (isset(self::$_methodListStatic[$B’ó‘ğÊâ°])) { return call_user_func_array(self::$_methodListStatic[$B’ó‘ğÊâ°], $d†­®ã¤­); } else { if (method_exists(self, $B’ó‘ğÊâ°)) { return call_user_func_array(array(self, $B’ó‘ğÊâ°), $d†­®ã¤­); } else { show_json("{$B’ó‘ğÊâ°}\x28\x29\40\156\x6f\x74\x20\145\x78\x69\x73\164\73", !1); } } } public static function addMethod($AøƒÊ‰Ã¶, $fîŸóîËÒ) { self::$_methodList[$AøƒÊ‰Ã¶] = $fîŸóîËÒ; } public static function addMethodStatic($B»‹íí¢¶, $DŒ¶ìàìÉÆ) { self::$_methodListStatic[$B»‹íí¢¶] = $DŒ¶ìàìÉÆ; } } goto B¹±¹è×©; EÆ‰……¢Û‚: class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\157\x75\162\143\x65\x5f\145\166\x65\x6e\x74"; protected $dataAuto = array(array("\x63\162\x65\141\164\145\x54\151\x6d\x65", "\x74\151\155\x65", "\151\x6e\x73\x65\x72\x74", "\146\x75\156\143\x74\x69\157\x6e"), array("\x64\145\163\x63", '', "\x69\x6e\x73\x65\162\x74\54\x75\x70\x64\x61\164\x65\54\163\145\154\145\143\164", "\152\x73\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($B«á´Ø¾Û, $f¥ÍÉî°’†, $C¶ÆÍç™‘ = '') { goto B“Œî˜•­ø; CàÈÖºÆÜ: return $this->add($bå£‘±Ëº); goto b“Å¾ï¥£ó; B“Œî˜•­ø: $f¸«±°¢£Õ =& $_SERVER[©äõ½¡]; if (!$this->eventSave) { return; } $bŠ”¢µê = Model($f¸«±°¢£Õ[1239])->sourceInfo($B«á´Ø¾Û); goto E¿Ì®¿‰Á; D’¢ß‡Òá: $bå£‘±Ëº = array($f¸«±°¢£Õ[412] => $B«á´Ø¾Û, $f¸«±°¢£Õ[1944] => $bŠ”¢µê[$f¸«±°¢£Õ[492]], $f¸«±°¢£Õ[1945] => $bŠ”¢µê[$f¸«±°¢£Õ[28]], $f¸«±°¢£Õ[513] => !empty($bŠ”¢µê[$f¸«±°¢£Õ[513]]) ? $bŠ”¢µê[$f¸«±°¢£Õ[513]] : $f¸«±°¢£Õ[33], $f¸«±°¢£Õ[1555] => USER_ID, $f¸«±°¢£Õ[417] => $f¥ÍÉî°’†, $f¸«±°¢£Õ[1557] => $C¶ÆÍç™‘); $this->addSystemLog($f¥ÍÉî°’†, $bå£‘±Ëº); unset($bå£‘±Ëº[$f¸«±°¢£Õ[1945]], $bå£‘±Ëº[$f¸«±°¢£Õ[513]]); goto CàÈÖºÆÜ; E¿Ì®¿‰Á: if (!$bŠ”¢µê) { return !1; } if ($this->isCacheEvent($bŠ”¢µê, $f¥ÍÉî°’†)) { return; } if ($C¶ÆÍç™‘ && is_string($C¶ÆÍç™‘)) { $C¶ÆÍç™‘ = array($f¸«±°¢£Õ[1771] => $C¶ÆÍç™‘); } goto D’¢ß‡Òá; b“Å¾ï¥£ó: } private function addSystemLog($e»²Ä›Ö„á, $fóÈŸÁóö) { $c ÀãçŠœ¶ =& $_SERVER[©äõ½¡]; if ($e»²Ä›Ö„á == $c ÀãçŠœ¶[1946]) { $e»²Ä›Ö„á = $fóÈŸÁóö[$c ÀãçŠœ¶[445]][$c ÀãçŠœ¶[1947]]; } else { if (in_array($e»²Ä›Ö„á, array($c ÀãçŠœ¶[1710], $c ÀãçŠœ¶[1948]))) { $e»²Ä›Ö„á = $fóÈŸÁóö[$c ÀãçŠœ¶[445]][$c ÀãçŠœ¶[750]]; } } $aŒ¾¶ÍÉ±Å = array_merge($fóÈŸÁóö, array($c ÀãçŠœ¶[1949] => $fóÈŸÁóö[$c ÀãçŠœ¶[397]], $c ÀãçŠœ¶[1950] => $fóÈŸÁóö[$c ÀãçŠœ¶[1950]])); Model($c ÀãçŠœ¶[1674])->addLog($c ÀãçŠœ¶[1951] . $e»²Ä›Ö„á, $aŒ¾¶ÍÉ±Å); } private function isCacheEvent($e‡„”›Ø¥ß, $Cˆ¾ĞÈíÙ) { if ($e‡„”›Ø¥ß[$_SERVER[©äõ½¡][406]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($EÖî²Ò†˜Ÿ, $CÀ°ªëèÕî) { $EÇ“„ïá† =& $_SERVER[©äõ½¡]; $dƒ­ÁÍğÊ = Model($EÇ“„ïá†[1239])->sourceInfo($EÖî²Ò†˜Ÿ); $EîáÎËƒá = array($EÇ“„ïá†[1947] => $CÀ°ªëèÕî, $EÇ“„ïá†[28] => $dƒ­ÁÍğÊ[$EÇ“„ïá†[28]]); return $this->addEvent($EÖî²Ò†˜Ÿ, $EÇ“„ïá†[1946], $EîáÎËƒá); } public function eventFileEdit($a†ŞËÎˆ) { $a„…ĞÅ =& $_SERVER[©äõ½¡]; $b‘‚»æ„Á– = array($a„…ĞÅ[1952] => $_SERVER[$a„…ĞÅ[1953]], $a„…ĞÅ[1954] => strtolower(ACTION)); return $this->addEvent($a†ŞËÎˆ, $a„…ĞÅ[1700], $b‘‚»æ„Á–); } public function eventRecycle($BÃ´µ¢ˆÓ, $D–ÃÆƒ¹Õ) { return $this->addEvent($BÃ´µ¢ˆÓ, $_SERVER[©äõ½¡][1948], $D–ÃÆƒ¹Õ); } public function eventRemove($b‰Óß¡¿×¢) { $CƒËòåˆÖ =& $_SERVER[©äõ½¡]; $b½¶Û  ï = Model($CƒËòåˆÖ[1239])->sourceInfo($b‰Óß¡¿×¢); $fÒ¼íƒæÙ = $b½¶Û  ï[$CƒËòåˆÖ[28]]; return $this->addEvent($b½¶Û  ï[$CƒËòåˆÖ[492]], $CƒËòåˆÖ[1699], $fÒ¼íƒæÙ); } public function eventShare($dÍ¹‡›Œß, $b¼¿µçì°˜) { return $this->addEvent($dÍ¹‡›Œß, $_SERVER[©äõ½¡][1710], $b¼¿µçì°˜); } public function eventMove($b„¦Š“‰ª, $C¢¬Î¿Àóº, $B†í‚··±¶) { goto f¨ĞØ¢±çÄ; F††Èî Ÿ: $this->addEvent($C¢¬Î¿Àóº, $e‚èãÙîÔ[1958], $A‘÷îƒöŠÂ); goto Eó–•†ÑÄ; CÅ­ÍÉ»§½: $CğíÉ©¥„£ = $eÒ„ùó¨”->sourceInfo($C¢¬Î¿Àóº); $BƒÓÆ–ˆŠµ = $eÒ„ùó¨”->sourceInfo($B†í‚··±¶); $A‘÷îƒöŠÂ = array($e‚èãÙîÔ[1088] => $C¢¬Î¿Àóº, $e‚èãÙîÔ[1955] => $CğíÉ©¥„£[$e‚èãÙîÔ[28]], $e‚èãÙîÔ[1935] => !empty($CğíÉ©¥„£[$e‚èãÙîÔ[513]]) ? $CğíÉ©¥„£[$e‚èãÙîÔ[513]] : $e‚èãÙîÔ[33], $e‚èãÙîÔ[1089] => $B†í‚··±¶, $e‚èãÙîÔ[1956] => $BƒÓÆ–ˆŠµ[$e‚èãÙîÔ[28]], $e‚èãÙîÔ[1957] => !empty($BƒÓÆ–ˆŠµ[$e‚èãÙîÔ[513]]) ? $BƒÓÆ–ˆŠµ[$e‚èãÙîÔ[513]] : $e‚èãÙîÔ[33]); goto a­ìŞîïø; f¨ĞØ¢±çÄ: $e‚èãÙîÔ =& $_SERVER[©äõ½¡]; $eÒ„ùó¨” = Model($e‚èãÙîÔ[1239]); $C»İ¢ŠÜ¼é = $eÒ„ùó¨”->sourceInfo($b„¦Š“‰ª); goto CÅ­ÍÉ»§½; a­ìŞîïø: $this->addEvent($b„¦Š“‰ª, $e‚èãÙîÔ[545], $A‘÷îƒöŠÂ); $C»İ¢ŠÜ¼é = $eÒ„ùó¨”->sourceInfo($b„¦Š“‰ª); $A‘÷îƒöŠÂ = array($e‚èãÙîÔ[397] => $C»İ¢ŠÜ¼é[$e‚èãÙîÔ[397]], $e‚èãÙîÔ[28] => $C»İ¢ŠÜ¼é[$e‚èãÙîÔ[28]]); goto F††Èî Ÿ; Eó–•†ÑÄ: } public function eventCopy($Cçïƒİ¾”¯) { $this->eventCreate($Cçïƒİ¾”¯, $_SERVER[©äõ½¡][543]); } public function eventRename($CßŒÁô¸îµ, $C¢Ó¹ÒºØ½, $d¥ì¼ÅÇß—) { $bºÒÅ¼â´¸ =& $_SERVER[©äõ½¡]; $E†Ÿ‰¬Öƒ» = array($bºÒÅ¼â´¸[1088] => $C¢Ó¹ÒºØ½, $bºÒÅ¼â´¸[1089] => $d¥ì¼ÅÇß—); return $this->addEvent($CßŒÁô¸îµ, $bºÒÅ¼â´¸[1253], $E†Ÿ‰¬Öƒ»); } public function eventAddComment($F’¥‚ßµ…Æ, $F­»…¯øÏ¯) { return $this->addEvent($F’¥‚ßµ…Æ, $_SERVER[©äõ½¡][1959], $F­»…¯øÏ¯); } public function eventAddDesc($F™åšÏ‡„‚, $dÈ”ßâëÖÃ) { return $this->addEvent($F™åšÏ‡„‚, $_SERVER[©äõ½¡][1960], $dÈ”ßâëÖÃ); } public function listBySource($EùêÈÁ½‘) { goto E„Åš×ù´•; C°ø’Ûò: return $this->eventListParse($f§ê÷†½òÒ, $EùêÈÁ½‘); goto A·¤Ó À›; E„Åš×ù´•: $dôğè’¦è„ =& $_SERVER[©äõ½¡]; $c¾íåÆ½¶ = Model($dôğè’¦è„[1239])->sourceInfo($EùêÈÁ½‘); $F‹Ã‘Ñ‹‚ = array($dôğè’¦è„[412] => $EùêÈÁ½‘); goto bÂŸ­¦ÛÀŞ; bÂŸ­¦ÛÀŞ: if ($c¾íåÆ½¶[$dôğè’¦è„[405]] == $dôğè’¦è„[87]) { $Fãº÷Ó»Ó = Model($dôğè’¦è„[1239])->listSearchChildren($EùêÈÁ½‘, 20000); $Fãº÷Ó»Ó[] = $EùêÈÁ½‘ . $dôğè’¦è„[376]; $F‹Ã‘Ñ‹‚ = array($dôğè’¦è„[397] => array($dôğè’¦è„[7], $Fãº÷Ó»Ó)); } $f§ê÷†½òÒ = $this->where($F‹Ã‘Ñ‹‚)->order($dôğè’¦è„[1961])->selectPage(); if ($f§ê÷†½òÒ[$dôğè’¦è„[364]][$dôğè’¦è„[365]] == 0) { $f§ê÷†½òÒ[$dôğè’¦è„[364]][$dôğè’¦è„[365]] = 1; $f§ê÷†½òÒ[$dôğè’¦è„[367]] = array(array($dôğè’¦è„[412] => $EùêÈÁ½‘, $dôğè’¦è„[1944] => $c¾íåÆ½¶[$dôğè’¦è„[492]], $dôğè’¦è„[1555] => $c¾íåÆ½¶[$dôğè’¦è„[446]], $dôğè’¦è„[417] => $dôğè’¦è„[1962], $dôğè’¦è„[418] => $c¾íåÆ½¶[$dôğè’¦è„[194]], $dôğè’¦è„[1557] => $dôğè’¦è„[33])); } goto C°ø’Ûò; A·¤Ó À›: } private function eventListParse($e§ô‘ˆÏ×ñ, $a¿À…–«ã†) { goto dĞ—ºŒ„ø§; Aƒ¡±îÄÜ†: $CŞ¦ˆ ïÈ = Model($böŒ¯Ó§Ó[827])->sourceListInfo($AËÜî‹Îñµ, !0); foreach ($Eå„çÖ‡øÇ as &$b‡æŞÖáñš) { if ($b‡æŞÖáñš[$böŒ¯Ó§Ó[29]] == $böŒ¯Ó§Ó[545] && isset($b‡æŞÖáñš[$böŒ¯Ó§Ó[445]][$böŒ¯Ó§Ó[1088]])) { $b‡æŞÖáñš[$böŒ¯Ó§Ó[445]][$böŒ¯Ó§Ó[1088]] = $CŞ¦ˆ ïÈ[$b‡æŞÖáñš[$böŒ¯Ó§Ó[445]][$böŒ¯Ó§Ó[1088]]]; $b‡æŞÖáñš[$böŒ¯Ó§Ó[445]][$böŒ¯Ó§Ó[1089]] = $CŞ¦ˆ ïÈ[$b‡æŞÖáñš[$böŒ¯Ó§Ó[445]][$böŒ¯Ó§Ó[1089]]]; } if ($b‡æŞÖáñš[$böŒ¯Ó§Ó[29]] == $böŒ¯Ó§Ó[1958] && isset($b‡æŞÖáñš[$böŒ¯Ó§Ó[445]][$böŒ¯Ó§Ó[397]])) { $b‡æŞÖáñš[$böŒ¯Ó§Ó[445]][$böŒ¯Ó§Ó[397]] = $CŞ¦ˆ ïÈ[$b‡æŞÖáñš[$böŒ¯Ó§Ó[445]][$böŒ¯Ó§Ó[397]]]; } $b‡æŞÖáñš[$böŒ¯Ó§Ó[85]] = $CŞ¦ˆ ïÈ[$b‡æŞÖáñš[$böŒ¯Ó§Ó[397]]]; $b‡æŞÖáñš[$böŒ¯Ó§Ó[1963]] = $CŞ¦ˆ ïÈ[$b‡æŞÖáñš[$böŒ¯Ó§Ó[1950]]]; if ($b‡æŞÖáñš[$böŒ¯Ó§Ó[29]] == $böŒ¯Ó§Ó[1699]) { $b‡æŞÖáñš[$böŒ¯Ó§Ó[1963]] = $b‡æŞÖáñš[$böŒ¯Ó§Ó[85]]; $b‡æŞÖáñš[$böŒ¯Ó§Ó[1950]] = $b‡æŞÖáñš[$böŒ¯Ó§Ó[1963]][$böŒ¯Ó§Ó[397]]; $b‡æŞÖáñš[$böŒ¯Ó§Ó[85]] = !1; $b‡æŞÖáñš[$böŒ¯Ó§Ó[397]] = $böŒ¯Ó§Ó[33]; } $b‡æŞÖáñš[$böŒ¯Ó§Ó[1895]] = $AÆçÄÉã¦÷[$b‡æŞÖáñš[$böŒ¯Ó§Ó[1564]]]; } unset($b‡æŞÖáñš); goto C˜¥ß˜Ú‹Œ; CšƒÙ‰Èƒ«: $AËÜî‹Îñµ = array_unique($AËÜî‹Îñµ); $AèíÊµ×…ˆ = array_unique(array_to_keyvalue($Eå„çÖ‡øÇ, $böŒ¯Ó§Ó[33], $böŒ¯Ó§Ó[1564])); $AÆçÄÉã¦÷ = Model($böŒ¯Ó§Ó[532])->userListInfo($AèíÊµ×…ˆ); goto Aƒ¡±îÄÜ†; dĞ—ºŒ„ø§: $böŒ¯Ó§Ó =& $_SERVER[©äõ½¡]; $Eå„çÖ‡øÇ = $e§ô‘ˆÏ×ñ[$böŒ¯Ó§Ó[367]]; $AËÜî‹Îñµ = array_to_keyvalue($Eå„çÖ‡øÇ, $böŒ¯Ó§Ó[33], $böŒ¯Ó§Ó[397]); goto e–‹­¡À…”; C˜¥ß˜Ú‹Œ: $e§ô‘ˆÏ×ñ[$böŒ¯Ó§Ó[367]] = $Eå„çÖ‡øÇ; return $e§ô‘ˆÏ×ñ; goto D°‚ª‘«š¨; e–‹­¡À…”: $b·öˆ´®Ò¬ = array_to_keyvalue($Eå„çÖ‡øÇ, $böŒ¯Ó§Ó[33], $böŒ¯Ó§Ó[1950]); foreach ($Eå„çÖ‡øÇ as $b‡æŞÖáñš) { $aÀßâ‚Úˆ± = $b‡æŞÖáñš[$böŒ¯Ó§Ó[445]]; if ($b‡æŞÖáñš[$böŒ¯Ó§Ó[29]] == $böŒ¯Ó§Ó[545] && isset($aÀßâ‚Úˆ±[$böŒ¯Ó§Ó[1088]])) { $AËÜî‹Îñµ[] = $aÀßâ‚Úˆ±[$böŒ¯Ó§Ó[1088]] . $böŒ¯Ó§Ó[33]; $AËÜî‹Îñµ[] = $aÀßâ‚Úˆ±[$böŒ¯Ó§Ó[1089]] . $böŒ¯Ó§Ó[33]; } if ($b‡æŞÖáñš[$böŒ¯Ó§Ó[29]] == $böŒ¯Ó§Ó[1958] && isset($aÀßâ‚Úˆ±[$böŒ¯Ó§Ó[397]])) { $AËÜî‹Îñµ[] = $aÀßâ‚Úˆ±[$böŒ¯Ó§Ó[397]] . $böŒ¯Ó§Ó[33]; } } $AËÜî‹Îñµ = array_merge($AËÜî‹Îñµ, $b·öˆ´®Ò¬, array($a¿À…–«ã† . $böŒ¯Ó§Ó[33])); goto CšƒÙ‰Èƒ«; D°‚ª‘«š¨: } public function removeBySource($bš—„ÕÈ³) { $F§»¸Éè‡  = array($_SERVER[©äõ½¡][412] => $bš—„ÕÈ³); $this->where($F§»¸Éè‡ )->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\157\165\x72\143\145\137\150\151\x73\164\x6f\x72\171"; public function historyCount($Aò±’îŠ±°) { goto Dï¾†ˆÌÍ‰; d•‹˜Úõíù: return array_to_keyvalue($eœ÷“ÛŸÛœ, $CœªéÎÊ¥[397], $CœªéÎÊ¥[494]); goto CÀ¨Ç¯ŒÍ; Dï¾†ˆÌÍ‰: $CœªéÎÊ¥ =& $_SERVER[©äõ½¡]; if (!$Aò±’îŠ±°) { return array(); } if (is_string($Aò±’îŠ±°) || is_int($Aò±’îŠ±°)) { $Aò±’îŠ±° = array($Aò±’îŠ±°); } goto Få°â°Æ›®; Få°â°Æ›®: $eÓÛê»­Šö = array($CœªéÎÊ¥[397], $CœªéÎÊ¥[1765] => $CœªéÎÊ¥[494]); $DÊù„İâÅµ = array($CœªéÎÊ¥[397] => array($CœªéÎÊ¥[7], $Aò±’îŠ±°)); $eœ÷“ÛŸÛœ = $this->field($eÓÛê»­Šö)->where($DÊù„İâÅµ)->group($CœªéÎÊ¥[397])->select(); goto d•‹˜Úõíù; CÀ¨Ç¯ŒÍ: } public function addHistory($BÔùà„„Òš, $Bê‘´ï°÷¸ = '') { $C®’Ì¡Âõ¬ =& $_SERVER[©äõ½¡]; $DŠŠ¼‚¹ßÚ = array($C®’Ì¡Âõ¬[412] => $BÔùà„„Òš[$C®’Ì¡Âõ¬[397]], $C®’Ì¡Âõ¬[1555] => isset($BÔùà„„Òš[$C®’Ì¡Âõ¬[448]]) ? $BÔùà„„Òš[$C®’Ì¡Âõ¬[448]] : $BÔùà„„Òš[$C®’Ì¡Âõ¬[446]], $C®’Ì¡Âõ¬[462] => $BÔùà„„Òš[$C®’Ì¡Âõ¬[461]], $C®’Ì¡Âõ¬[573] => $BÔùà„„Òš[$C®’Ì¡Âõ¬[78]], $C®’Ì¡Âõ¬[1964] => $Bê‘´ï°÷¸); $d¿Á¯õƒéË = $GLOBALS[$C®’Ì¡Âõ¬[6]][$C®’Ì¡Âõ¬[88]][$C®’Ì¡Âõ¬[1137]]; if ($d¿Á¯õƒéË > 1) { $this->historyAutoClear($DŠŠ¼‚¹ßÚ[$C®’Ì¡Âõ¬[397]]); $this->add($DŠŠ¼‚¹ßÚ); } Hook::trigger($C®’Ì¡Âõ¬[1965], $DŠŠ¼‚¹ßÚ); Model($C®’Ì¡Âõ¬[1966])->eventFileEdit($BÔùà„„Òš[$C®’Ì¡Âõ¬[397]]); } private function historyAutoClear($BÙîğõˆøê) { goto d–ï–‘É­; bé§à†•äÅ: $FéˆĞè¤Ó· = array_slice($FéˆĞè¤Ó·, $F¥¦õø•µ); if (!$C†¯Ğ¡¶Ö÷ || !$FéˆĞè¤Ó·) { return; } $Cœ¢öŠã­» = array($b„ˆª¯«›­[414] => array($b„ˆª¯«›­[7], $C†¯Ğ¡¶Ö÷)); goto fµÛ²Ë®µ; DŞİ´‘¼Ô: $Cœ¢öŠã­» = array($b„ˆª¯«›­[412] => $BÙîğõˆøê); $CµñøìæÛ« = $this->field($b„ˆª¯«›­[1967])->where($Cœ¢öŠã­»)->order($b„ˆª¯«›­[1961])->select(); if (!$CµñøìæÛ« || $F¥¦õø•µ >= count($CµñøìæÛ«)) { return; } goto Bôƒ¿¸ÛÄ„; d–ï–‘É­: $b„ˆª¯«›­ =& $_SERVER[©äõ½¡]; $EèÚö‡ÑÍ = Model($b„ˆª¯«›­[765])->get($b„ˆª¯«›­[1159]); $CÍö–‹ä´è = $GLOBALS[$b„ˆª¯«›­[6]][$b„ˆª¯«›­[88]][$b„ˆª¯«›­[1137]]; goto a­µºÀÒˆÚ; fµÛ²Ë®µ: $this->where($Cœ¢öŠã­»)->delete(); Model($b„ˆª¯«›­[464])->remove($FéˆĞè¤Ó·); goto C¼§à‚Æ†º; a­µºÀÒˆÚ: $F¥¦õø•µ = $EèÚö‡ÑÍ == $b„ˆª¯«›­[1160] ? 5 : $CÍö–‹ä´è; if ($CÍö–‹ä´è <= 1) { $F¥¦õø•µ = 1; } if ($F¥¦õø•µ >= 500) { return; } goto DŞİ´‘¼Ô; Bôƒ¿¸ÛÄ„: $C†¯Ğ¡¶Ö÷ = array_to_keyvalue($CµñøìæÛ«, $b„ˆª¯«›­[33], $b„ˆª¯«›­[395]); $C†¯Ğ¡¶Ö÷ = array_slice($C†¯Ğ¡¶Ö÷, $F¥¦õø•µ); $FéˆĞè¤Ó· = array_to_keyvalue($CµñøìæÛ«, $b„ˆª¯«›­[33], $b„ˆª¯«›­[461]); goto bé§à†•äÅ; C¼§à‚Æ†º: } public function listData($c·‘ÓÍÕ) { goto Bñ©‰«Õ¼î; Bñ©‰«Õ¼î: $FÎßŞ®–­È =& $_SERVER[©äõ½¡]; $BŠ³ï­›² = array($FÎßŞ®–­È[412] => $c·‘ÓÍÕ); $dÓŞìÄ„®œ = $FÎßŞ®–­È[1968]; goto BÄ•âåöè; aŒ–¹¹ğ×: $E±ù£ê÷ = 5; if ($aáä¬öåØÆ == $FÎßŞ®–­È[1160]) { $e·‡ĞŒ‹«[$FÎßŞ®–­È[367]] = array_slice($e·‡ĞŒ‹«[$FÎßŞ®–­È[367]], 0, $E±ù£ê÷); $e·‡ĞŒ‹«[$FÎßŞ®–­È[364]] = array($FÎßŞ®–­È[1969] => 1, $FÎßŞ®–­È[1970] => 20, $FÎßŞ®–­È[1971] => 1, $FÎßŞ®–­È[1972] => count($e·‡ĞŒ‹«[$FÎßŞ®–­È[367]])); } return $e·‡ĞŒ‹«; goto dê¦ÄŠä; BÄ•âåöè: $e·‡ĞŒ‹« = $this->field($dÓŞìÄ„®œ)->where($BŠ³ï­›²)->order($FÎßŞ®–­È[1961])->selectPage(); $this->_listAppendUser($e·‡ĞŒ‹«[$FÎßŞ®–­È[367]]); $aáä¬öåØÆ = Model($FÎßŞ®–­È[765])->get($FÎßŞ®–­È[1159]); goto aŒ–¹¹ğ×; dê¦ÄŠä: } protected function _listAppendUser(&$A«…Ê‹ƒ÷) { $Aò´–™ê =& $_SERVER[©äõ½¡]; $B– Ìî‡‡ç = array_to_keyvalue($A«…Ê‹ƒ÷, $Aò´–™ê[33], $Aò´–™ê[1564]); $b¤îÄ‚ÎôÄ = Model($Aò´–™ê[532])->userListInfo($B– Ìî‡‡ç); foreach ($A«…Ê‹ƒ÷ as &$D™©ñ‘Øï) { $DôÍ¶‹é­‰ = $D™©ñ‘Øï[$Aò´–™ê[1564]]; $D™©ñ‘Øï[$Aò´–™ê[446]] = $b¤îÄ‚ÎôÄ[$DôÍ¶‹é­‰] ? $b¤îÄ‚ÎôÄ[$DôÍ¶‹é­‰] : !1; } unset($D™©ñ‘Øï); } public function fileInfo($CÖÌÑ’°­”) { $CÆŒå‰™éå =& $_SERVER[©äõ½¡]; $dàï…¼É½Ê = $this->tablePrefix; $d—ÑÔ‹è¼Ÿ = "{$dàï…¼É½Ê}\151\157\x5f\146\x69\154\145\40\146\151\154\x65\163\40\157\x6e\40\146\151\154\145\163\x2e\x66\x69\x6c\145\x49\x44\40\75\x20\150\151\x73\x74\x6f\x72\171\56\146\151\154\x65\111\x44"; return $this->alias($CÆŒå‰™éå[1973])->where(array($CÆŒå‰™éå[414] => $CÖÌÑ’°­”))->join($d—ÑÔ‹è¼Ÿ, $CÆŒå‰™éå[1974])->find(); } public function removeItem($AÆÜ–ÀÎë) { $b¢²¸“©¿š =& $_SERVER[©äõ½¡]; $FĞƒå¶–«‚ = array($b¢²¸“©¿š[414] => $AÆÜ–ÀÎë); $f…ŠÉ½ØË = $this->where($FĞƒå¶–«‚)->find(); if ($f…ŠÉ½ØË) { $Cñ¥ŠÖ™ÅÍ = $this->where($FĞƒå¶–«‚)->delete(); Model($b¢²¸“©¿š[464])->remove($f…ŠÉ½ØË[$b¢²¸“©¿š[461]]); return $Cñ¥ŠÖ™ÅÍ; } return !1; } public function removeBySource($bÎãà¢Ğõí) { goto dºŠ†ØŠö; EªÃ‰óßì: $b§–‹ƒ˜ = array($aø÷´êêàÎ[412] => array($aø÷´êêàÎ[7], $bÎãà¢Ğõí)); $d¹ëëµˆáÉ = $this->field($aø÷´êêàÎ[462])->where($b§–‹ƒ˜)->select(); if ($d¹ëëµˆáÉ) { $this->where($b§–‹ƒ˜)->delete(); $E¬…Ã†œŒ = array_to_keyvalue($d¹ëëµˆáÉ, $aø÷´êêàÎ[33], $aø÷´êêàÎ[461]); Model($aø÷´êêàÎ[464])->remove($E¬…Ã†œŒ); } goto bÅË‰Òß¨Ç; bÅË‰Òß¨Ç: return !0; goto e‰é¨Ãºâ; dºŠ†ØŠö: $aø÷´êêàÎ =& $_SERVER[©äõ½¡]; if (!$bÎãà¢Ğõí) { return !1; } if (!is_array($bÎãà¢Ğõí)) { $bÎãà¢Ğõí = array($bÎãà¢Ğõí); } goto EªÃ‰óßì; e‰é¨Ãºâ: } public function setDetail($DñßÓ–ÑÅ, $CÅ£¸ôŠ‘—) { $E È•—éŠˆ =& $_SERVER[©äõ½¡]; return $this->where(array($E È•—éŠˆ[414] => $DñßÓ–ÑÅ))->save(array($E È•—éŠˆ[1964] => $CÅ£¸ôŠ‘—)); } public function rollbackToItem($aÁµë°ÆáÆ, $c¹•±í İ›) { goto FæÁŸ­¢; eîØ‚·³®—: return $this->where(array($a»ª¿µ‰ğ•[414] => $c¹•±í İ›))->delete(); goto AÈÒî¸Á¶–; A“´ç×ãæÁ: $AÃË©“áÄ = $this->find($c¹•±í İ›); $Cœ«Ô¸ç°Ç = array($a»ª¿µ‰ğ•[461] => $AÃË©“áÄ[$a»ª¿µ‰ğ•[461]], $a»ª¿µ‰ğ•[78] => $AÃË©“áÄ[$a»ª¿µ‰ğ•[78]], $a»ª¿µ‰ğ•[84] => time(), $a»ª¿µ‰ğ•[448] => USER_ID); Model($a»ª¿µ‰ğ•[827])->where(array($a»ª¿µ‰ğ•[397] => $aÁµë°ÆáÆ))->save($Cœ«Ô¸ç°Ç); goto eîØ‚·³®—; FæÁŸ­¢: $a»ª¿µ‰ğ• =& $_SERVER[©äõ½¡]; $c›Ñ›†Ñ† = Model($a»ª¿µ‰ğ•[827])->sourceInfo($aÁµë°ÆáÆ); $this->addHistory($c›Ñ›†Ñ†, LNG($a»ª¿µ‰ğ•[1975])); goto A“´ç×ãæÁ; AÈÒî¸Á¶–: } public function clearSame($bÕ³’·…‡Š) { goto EŠªÕğ¦; CÆì•‚ì‡: if (!$B„²ùÆùâÚ) { return; } $this->where(array($A§¿‘ù‚óÇ[395] => array($A§¿‘ù‚óÇ[7], $B„²ùÆùâÚ)))->delete(); Model($A§¿‘ù‚óÇ[464])->remove($bá…öˆÎÄì); goto Bï„èËÏ”Ø; Bİ™›Æ¯¤: $bá…öˆÎÄì = array(); $B„²ùÆùâÚ = array(); foreach ($D©«ç Œ… as $dñé°Üá‚Ş) { if (!$dñé°Üá‚Ş || count($dñé°Üá‚Ş) <= 1) { continue; } foreach ($dñé°Üá‚Ş as $fÂ¾Ëâİø ) { $bá…öˆÎÄì[] = $fÂ¾Ëâİø [$A§¿‘ù‚óÇ[461]]; $B„²ùÆùâÚ[] = $fÂ¾Ëâİø [$A§¿‘ù‚óÇ[395]]; } } goto CÆì•‚ì‡; EŠªÕğ¦: $A§¿‘ù‚óÇ =& $_SERVER[©äõ½¡]; $dƒŸø†ëÛ = $this->listData($bÕ³’·…‡Š); $D©«ç Œ… = array_to_keyvalue_group($dƒŸø†ëÛ, $A§¿‘ù‚óÇ[461]); goto Bİ™›Æ¯¤; Bï„èËÏ”Ø: } public function userSpace() { $CÌ”¶™ƒÖ« =& $_SERVER[©äõ½¡]; $aêš´Ê¶Åë = $this->tablePrefix; $Dô„øÌÜ‹– = array($CÌ”¶™ƒÖ«[1555] => USER_ID); $DõŒŸ®ÃæÄ = "{$aêš´Ê¶Åë}\151\157\137\x66\x69\x6c\145\x20\146\151\154\x65\x73\x20\157\156\40\146\x69\154\x65\163\56\x66\151\154\145\x49\104\40\75\x20\150\x69\x73\x74\157\162\x79\x2e\146\x69\x6c\x65\111\x44"; return $this->alias($CÌ”¶™ƒÖ«[1973])->where($Dô„øÌÜ‹–)->join($DõŒŸ®ÃæÄ, $CÌ”¶™ƒÖ«[1974])->sum($CÌ”¶™ƒÖ«[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($c›’›¨‘³ˆ) { goto B‘µØÙÍ ¦; B‘µØÙÍ ¦: $FÛÀˆ „ï =& $_SERVER[©äõ½¡]; $féä×Ö¸óµ = KodIO::fileTypeList(); $Bà¤‘™» = $féä×Ö¸óµ[$c›’›¨‘³ˆ]; goto bĞŒÜØµªÖ; a²·‘Û©Â: if (!$Bà¤‘™»[$FÛÀˆ „ï[168]]) { $F‚¡¥ë†Õ = array_to_keyvalue($féä×Ö¸óµ, $FÛÀˆ „ï[33], $FÛÀˆ „ï[168]); $aÕôŸèÌÁ» = implode($FÛÀˆ „ï[47], $F‚¡¥ë†Õ); $eßÎ’¹©® = $FÛÀˆ „ï[1976]; } $B±‚‡ …ªƒ = explode($FÛÀˆ „ï[47], trim($aÕôŸèÌÁ», $FÛÀˆ „ï[47])); return array($eßÎ’¹©®, $B±‚‡ …ªƒ); goto fêˆ¢¯©ë°; bĞŒÜØµªÖ: if (!$Bà¤‘™») { return array(); } $aÕôŸèÌÁ» = $Bà¤‘™»[$FÛÀˆ „ï[168]]; $eßÎ’¹©® = $FÛÀˆ „ï[7]; goto a²·‘Û©Â; fêˆ¢¯©ë°: } public function listPathType($bÅ·èĞÑ») { $C²ÖØÜ¤šÆ =& $_SERVER[©äõ½¡]; $c áĞ‰ä×å = $this->fileTypeWhere($bÅ·èĞÑ»); if (!$c áĞ‰ä×å) { return array(); } $BÎù†¶° = array($C²ÖØÜ¤šÆ[574] => SourceModel::TYPE_USER, $C²ÖØÜ¤šÆ[575] => USER_ID, $C²ÖØÜ¤šÆ[571] => 0, $C²ÖØÜ¤šÆ[572] => $c áĞ‰ä×å); return $this->listSource($BÎù†¶°); } public function listSearch($BëàÙÚİ, $b¦çÎÄ¢ = 300) { goto c’—ééî¹; EÂòŒØø‰Ä: $this->_listDataApply($eÔ‘öÃ‘[$Bëó•÷°¤„[367]]); $this->_listMake($eÔ‘öÃ‘); return $eÔ‘öÃ‘; goto bÄ£Û¤†á; CÉßöàåçƒ: $EˆİÙİÏ² = $cØã–åá¿; if (!isset($cØã–åá¿[$Bëó•÷°¤„[425]])) { $cØã–åá¿[$Bëó•÷°¤„[425]] = 0; } $D¹¦”ÁÛ‡Ö = $Bëó•÷°¤„[1978]; goto D¢Ï™Šàİô; c’—ééî¹: $Bëó•÷°¤„ =& $_SERVER[©äõ½¡]; if (isset($BëàÙÚİ[$Bëó•÷°¤„[1821]]) && $BëàÙÚİ[$Bëó•÷°¤„[1821]]) { $BëàÙÚİ[$Bëó•÷°¤„[1821]] = str_replace($Bëó•÷°¤„[382], $Bëó•÷°¤„[1977], trim($BëàÙÚİ[$Bëó•÷°¤„[1821]])); } $cØã–åá¿ = $this->_parseSearchWhere($BëàÙÚİ); goto CÉßöàåçƒ; D¢Ï™Šàİô: $C¢‘Üƒê˜ = $D¹¦”ÁÛ‡Ö; $this->_listSearchBindPinyin($BëàÙÚİ, $cØã–åá¿, $D¹¦”ÁÛ‡Ö); $this->alias($Bëó•÷°¤„[438])->_makeOrder(); goto E¶‹µ÷á§; E¶‹µ÷á§: $cØã–åá¿ = $this->parseWhereLike($cØã–åá¿); $eÔ‘öÃ‘ = $this->distinct(!0)->field($D¹¦”ÁÛ‡Ö)->where($cØã–åá¿)->selectPage($b¦çÎÄ¢); $this->_listSearchFileContent($eÔ‘öÃ‘, $BëàÙÚİ, $C¢‘Üƒê˜, $EˆİÙİÏ²); goto CØ”Â‹ºä; CØ”Â‹ºä: $this->_listSearchDesc($eÔ‘öÃ‘, $BëàÙÚİ, $C¢‘Üƒê˜); $this->_listSearchTag($eÔ‘öÃ‘, $BëàÙÚİ, $C¢‘Üƒê˜); $this->_listSearchGroupTag($eÔ‘öÃ‘, $BëàÙÚİ, $C¢‘Üƒê˜); goto EÂòŒØø‰Ä; bÄ£Û¤†á: } private function _listSearchFileContent(&$A¦µŒÁŸÌ, $e…ï‹åÆ•, $fÛ©ë©Ä¬¢, $FÓ£†½˜å¢) { goto dŒ½©ÅìåÆ; dŒ½©ÅìåÆ: $F¿ôóåŞÔ =& $_SERVER[©äõ½¡]; if (!$e…ï‹åÆ•[$F¿ôóåŞÔ[1821]] || $A¦µŒÁŸÌ[$F¿ôóåŞÔ[364]][$F¿ôóåŞÔ[351]] > 1) { return; } if (!isset($FÓ£†½˜å¢[$F¿ôóåŞÔ[28]]) || !is_array($e…ï‹åÆ•[$F¿ôóåŞÔ[461]])) { return; } goto b›ŞÒÏÔ; fµÉÕ¨ŒØ: $eÚ×Ç™Ñàô = $this->field($fÛ©ë©Ä¬¢)->where($FÓ£†½˜å¢)->limit($F¿ôóåŞÔ[1979])->select(); if (!$eÚ×Ç™Ñàô || count($eÚ×Ç™Ñàô) == 0) { return; } $A¦µŒÁŸÌ[$F¿ôóåŞÔ[367]] = array_merge($eÚ×Ç™Ñàô, $A¦µŒÁŸÌ[$F¿ôóåŞÔ[367]]); goto fÅÓ¤‚ÁÁË; fÅÓ¤‚ÁÁË: $A¦µŒÁŸÌ[$F¿ôóåŞÔ[364]][$F¿ôóåŞÔ[365]] += count($eÚ×Ç™Ñàô); goto bš¡¿Óã¦…; b›ŞÒÏÔ: $FÓ£†½˜å¢[$F¿ôóåŞÔ[461]] = array($F¿ôóåŞÔ[7], $e…ï‹åÆ•[$F¿ôóåŞÔ[461]]); unset($FÓ£†½˜å¢[$F¿ôóåŞÔ[28]]); unset($e…ï‹åÆ•[$F¿ôóåŞÔ[461]]); goto fµÉÕ¨ŒØ; bš¡¿Óã¦…: } private function _listSearchTag(&$dæöÓë‰£, $dœ§¾×ŠÙğ, $aô†Ì£°¨) { goto AÄà¾Û™¾©; CĞšİã‹ç: $aÜ¿òŒÍÔË = array_to_keyvalue($aÜ¿òŒÍÔË, $DÔƒ‹˜[33], $DÔƒ‹˜[76]); $e½ÕŒ…¡ç« = array_unique($aÜ¿òŒÍÔË); $this->_listSearchMerge($dæöÓë‰£, $dœ§¾×ŠÙğ, $aô†Ì£°¨, $e½ÕŒ…¡ç«); goto a§Ş»ŸØ¤†; AÄà¾Û™¾©: $DÔƒ‹˜ =& $_SERVER[©äõ½¡]; if (!$dœ§¾×ŠÙğ[$DÔƒ‹˜[1821]] || $dæöÓë‰£[$DÔƒ‹˜[364]][$DÔƒ‹˜[351]] > 1) { return; } $EàêªæÓòÎ = Model($DÔƒ‹˜[1980])->listData(); goto c¢µ•Ê‰¾Ê; b”¯öò³Õ: if (!$e³—Œ›Î­–) { return; } $FøÕğ·÷¿î = array($DÔƒ‹˜[421] => array($DÔƒ‹˜[7], $e³—Œ›Î­–), $DÔƒ‹˜[1564] => USER_ID); $aÜ¿òŒÍÔË = Model($DÔƒ‹˜[422])->field($DÔƒ‹˜[76])->where($FøÕğ·÷¿î)->select(); goto CĞšİã‹ç; c¢µ•Ê‰¾Ê: $e³—Œ›Î­– = array(); $f èµ‡ÃáË = $dœ§¾×ŠÙğ[$DÔƒ‹˜[1821]]; foreach ($EàêªæÓòÎ as $cÒçŠœÑÕ²) { $BÃ¼Öå¦£· = $cÒçŠœÑÕ²[$DÔƒ‹˜[28]]; $eç†õğĞ† = str_replace($DÔƒ‹˜[50], $DÔƒ‹˜[33], Pinyin::get($BÃ¼Öå¦£·)); if (stripos($BÃ¼Öå¦£·, $f èµ‡ÃáË) !== !1 || stripos($eç†õğĞ†, $f èµ‡ÃáË) !== !1) { $e³—Œ›Î­–[] = $cÒçŠœÑÕ²[$DÔƒ‹˜[395]]; } } goto b”¯öò³Õ; a§Ş»ŸØ¤†: } private function _listSearchDesc(&$bÊÖ½»²ª“, $bé©Û•ò³, $aä¼íù‰‘ã) { goto døİÀ¹İØ; CÎ¼çñ’àÑ: $e—Èœµ¸ = array_unique($e—Èœµ¸); if (!$e—Èœµ¸) { return; } $eªá¸ó±éé = array($FÑòÏñÓİÑ[397] => array($FÑòÏñÓİÑ[7], $e—Èœµ¸), $FÑòÏñÓİÑ[93] => $FÑòÏñÓİÑ[445], $FÑòÏñÓİÑ[372] => array($FÑòÏñÓİÑ[381], $FÑòÏñÓİÑ[1823] . $bé©Û•ò³[$FÑòÏñÓİÑ[1821]] . $FÑòÏñÓİÑ[1823])); goto EßÛ¦‘Ïš‰; EßÛ¦‘Ïš‰: $cØ¹óÍ¸×« = Model($FÑòÏñÓİÑ[557])->field($FÑòÏñÓİÑ[397])->where($eªá¸ó±éé)->select(); $AŸËƒ‰Ú¢à = array_to_keyvalue($cØ¹óÍ¸×«, $FÑòÏñÓİÑ[33], $FÑòÏñÓİÑ[397]); $this->_listSearchMerge($bÊÖ½»²ª“, $bé©Û•ò³, $aä¼íù‰‘ã, $AŸËƒ‰Ú¢à); goto bÌ‹ÊÛÀĞƒ; døİÀ¹İØ: $FÑòÏñÓİÑ =& $_SERVER[©äõ½¡]; if (!$bé©Û•ò³[$FÑòÏñÓİÑ[1821]] || $bÊÖ½»²ª“[$FÑòÏñÓİÑ[364]][$FÑòÏñÓİÑ[351]] > 1) { return; } $e—Èœµ¸ = $this->listSearchChildren($bé©Û•ò³[$FÑòÏñÓİÑ[492]]); goto CÎ¼çñ’àÑ; bÌ‹ÊÛÀĞƒ: } private function _listSearchGroupTag(&$eíÀ‰ºìÌ‘, $A‹ßèŒ¼ã©, $FÙØ„«–ª) { goto c¦°ÜËÊ–; A…µÆ˜‚ˆò: $aÜâî©•ïÜ = array_to_keyvalue($aÜâî©•ïÜ, $dÓåÇ˜”Ù[33], $dÓåÇ˜”Ù[76]); $f¾ë…Êò = array_unique($aÜâî©•ïÜ); $this->_listSearchMerge($eíÀ‰ºìÌ‘, $A‹ßèŒ¼ã©, $FÙØ„«–ª, $f¾ë…Êò); goto cğ”ÒØª‹…; e¦‹œ¶‹Œ: $aİ‹ó¯Ê¾Ä = array(); $bÂ’»±×Îù = $A‹ßèŒ¼ã©[$dÓåÇ˜”Ù[1821]]; foreach ($Eã³½µíÑ¹[$dÓåÇ˜”Ù[367]] as $e²Ä÷«ìÙÆ) { $bâŠËÅæ± = $e²Ä÷«ìÙÆ[$dÓåÇ˜”Ù[28]]; $f† Æã¬Õ = str_replace($dÓåÇ˜”Ù[50], $dÓåÇ˜”Ù[33], Pinyin::get($bâŠËÅæ±)); if (stripos($bâŠËÅæ±, $bÂ’»±×Îù) !== !1 || stripos($f† Æã¬Õ, $bÂ’»±×Îù) !== !1) { $aİ‹ó¯Ê¾Ä[] = $e²Ä÷«ìÙÆ[$dÓåÇ˜”Ù[395]]; } } goto Aƒí®èÆ¶¬; Aƒí®èÆ¶¬: if (!$aİ‹ó¯Ê¾Ä) { return; } $E‰ÚÁ‘•÷Í = array($dÓåÇ˜”Ù[421] => array($dÓåÇ˜”Ù[7], $aİ‹ó¯Ê¾Ä), $dÓåÇ˜”Ù[1564] => 0, $dÓåÇ˜”Ù[29] => $dÓåÇ˜”Ù[1845] . $aŸ’‚èÕ¢´); $aÜâî©•ïÜ = Model($dÓåÇ˜”Ù[422])->field($dÓåÇ˜”Ù[76])->where($E‰ÚÁ‘•÷Í)->select(); goto A…µÆ˜‚ˆò; d»…¡§Á–: if (!$aÇ¨è®è› || $aÇ¨è®è›[$dÓåÇ˜”Ù[406]] != SourceModel::TYPE_GROUP) { return; } $aŸ’‚èÕ¢´ = $aÇ¨è®è›[$dÓåÇ˜”Ù[498]]; $Eã³½µíÑ¹ = Model($dÓåÇ˜”Ù[1981])->get($aŸ’‚èÕ¢´); goto e¦‹œ¶‹Œ; c¦°ÜËÊ–: $dÓåÇ˜”Ù =& $_SERVER[©äõ½¡]; if (!$A‹ßèŒ¼ã©[$dÓåÇ˜”Ù[1821]] || $eíÀ‰ºìÌ‘[$dÓåÇ˜”Ù[364]][$dÓåÇ˜”Ù[351]] > 1 || !$A‹ßèŒ¼ã©[$dÓåÇ˜”Ù[492]]) { return; } $aÇ¨è®è› = $this->sourceInfo($A‹ßèŒ¼ã©[$dÓåÇ˜”Ù[492]]); goto d»…¡§Á–; cğ”ÒØª‹…: } private function _listSearchMerge(&$dØ–„»Ä, $dÛ™Œ¿ÆØ, $d‰Œ¶åš“, $c×Ÿô‹§ÀÏ) { goto E‚­õœ•Æ‘; EÕ²ˆÃÉ“¿: foreach ($eïŠõéæ¸ as $A«‡ºÑ—Åù) { if ($this->_listSearchFilter($A«‡ºÑ—Åù, $dÛ™Œ¿ÆØ)) { $aÈë›®ãˆ[] = $A«‡ºÑ—Åù; } } $dØ–„»Ä[$D›²˜ˆ¢Ş[367]] = array_merge($aÈë›®ãˆ, $dØ–„»Ä[$D›²˜ˆ¢Ş[367]]); $dØ–„»Ä[$D›²˜ˆ¢Ş[364]][$D›²˜ˆ¢Ş[365]] += count($aÈë›®ãˆ); goto Bè½Î¼šğí; CŒìİ¯ğ‚°: $bÇÜ¬°‘Ï« = array_diff($c×Ÿô‹§ÀÏ, $dí‰‹ğ”åª); if (!$bÇÜ¬°‘Ï«) { return; } $c†ŠÊÌâÂè = array($D›²˜ˆ¢Ş[397] => array($D›²˜ˆ¢Ş[7], $bÇÜ¬°‘Ï«)); goto BÇ–ŞîÖ¨­; BÇ–ŞîÖ¨­: $eïŠõéæ¸ = $this->field($d‰Œ¶åš“)->where($c†ŠÊÌâÂè)->select(); if (!$eïŠõéæ¸) { return; } $aÈë›®ãˆ = array(); goto EÕ²ˆÃÉ“¿; E‚­õœ•Æ‘: $D›²˜ˆ¢Ş =& $_SERVER[©äõ½¡]; if (!$c×Ÿô‹§ÀÏ) { return; } $dí‰‹ğ”åª = array_to_keyvalue($dØ–„»Ä[$D›²˜ˆ¢Ş[367]], $D›²˜ˆ¢Ş[33], $D›²˜ˆ¢Ş[397]); goto CŒìİ¯ğ‚°; Bè½Î¼šğí: } private function _listSearchFilter($dÓ­ îÀ‡, $F…»ó·“Î°) { goto E¦ø†‡¤ĞÆ; FªòêåÄ°Ğ: if (isset($F…»ó·“Î°[$DÍÔŠš‰Õ‘[407]]) && $F…»ó·“Î°[$DÍÔŠš‰Õ‘[407]] != $DÍÔŠš‰Õ‘[1787]) { if ($F…»ó·“Î°[$DÍÔŠš‰Õ‘[407]] == $DÍÔŠš‰Õ‘[77] && !$AÃÚ–¤‘Íï) { return !1; } if ($F…»ó·“Î°[$DÍÔŠš‰Õ‘[407]] != $DÍÔŠš‰Õ‘[77] && $AÃÚ–¤‘Íï) { return !1; } if (!strstr($dÓ­ îÀ‡[$DÍÔŠš‰Õ‘[168]], $DÍÔŠš‰Õ‘[47] . $F…»ó·“Î°[$DÍÔŠš‰Õ‘[407]] . $DÍÔŠš‰Õ‘[47])) { return !1; } } if (isset($F…»ó·“Î°[$DÍÔŠš‰Õ‘[1982]]) && $F…»ó·“Î°[$DÍÔŠš‰Õ‘[1982]] < $dÓ­ îÀ‡[$DÍÔŠš‰Õ‘[78]]) { return !1; } if (isset($F…»ó·“Î°[$DÍÔŠš‰Õ‘[1983]]) && $F…»ó·“Î°[$DÍÔŠš‰Õ‘[1983]] > $dÓ­ îÀ‡[$DÍÔŠš‰Õ‘[78]]) { return !1; } goto C¨ÊëøËÄ¸; E¦ø†‡¤ĞÆ: $DÍÔŠš‰Õ‘ =& $_SERVER[©äõ½¡]; $AÃÚ–¤‘Íï = $dÓ­ îÀ‡[$DÍÔŠš‰Õ‘[405]] == $DÍÔŠš‰Õ‘[87]; if (!strstr($dÓ­ îÀ‡[$DÍÔŠš‰Õ‘[515]], $DÍÔŠš‰Õ‘[47] . $F…»ó·“Î°[$DÍÔŠš‰Õ‘[492]] . $DÍÔŠš‰Õ‘[47])) { return !1; } goto FªòêåÄ°Ğ; C¨ÊëøËÄ¸: if (isset($F…»ó·“Î°[$DÍÔŠš‰Õ‘[588]]) && $F…»ó·“Î°[$DÍÔŠš‰Õ‘[588]] != $dÓ­ îÀ‡[$DÍÔŠš‰Õ‘[448]]) { return !1; } return !0; goto bâ„ãÅ”Ñ; bâ„ãÅ”Ñ: } public function listSearchChildren($A²ææ‹¿ç, $D‘–à„—É = 5000) { goto F–œÄÕ¾ğ×; eõ±±˜ïŞ½: $Eğ½‚éğ = array($dôğŞçº©ª[515] => array($dôğŞçº©ª[381], $b‹ŸÕ§êš–[$dôğŞçº©ª[515]] . $b‹ŸÕ§êš–[$dôğŞçº©ª[397]] . $dôğŞçº©ª[539])); $b‚İÉ­Ï…â = $this->field($dôğŞçº©ª[397])->cache(null, 600)->where($Eğ½‚éğ)->count(); if ($b‚İÉ­Ï…â > $D‘–à„—É) { return $this->_listSearchChildrenNear($A²ææ‹¿ç, $D‘–à„—É); } goto cÇ¨ÅïÁà; F–œÄÕ¾ğ×: $dôğŞçº©ª =& $_SERVER[©äõ½¡]; $B¡Ş×í·®è = array(); $b‹ŸÕ§êš– = $this->sourceInfo($A²ææ‹¿ç); goto eõ±±˜ïŞ½; cÇ¨ÅïÁà: $bœšæø¾àï = $this->field($dôğŞçº©ª[397])->where($Eğ½‚éğ)->select(); $B¡Ş×í·®è = array_to_keyvalue($bœšæø¾àï, $dôğŞçº©ª[33], $dôğŞçº©ª[397]); return $B¡Ş×í·®è; goto b‚Ëëßõ”õ; b‚Ëëßõ”õ: } private function _listSearchChildrenNear($Aåå„÷ ¡‡, $D×èÚ§Õ²) { goto BØ‡§ÚŒ«Ê; BØ‡§ÚŒ«Ê: $dŞ¯»ƒéÈ˜ =& $_SERVER[©äõ½¡]; $E¦ˆïÉÏ³ó = array(); $e¶Ë¦“ìÓ = array($dŞ¯»ƒéÈ˜[492] => $Aåå„÷ ¡‡); goto B¡ÆÉĞ¹; B¡ÆÉĞ¹: $DÁ–î»Ğ = $this->field($dŞ¯»ƒéÈ˜[1984])->where($e¶Ë¦“ìÓ)->select(); $AÑÅ¬Îåïø = array_to_keyvalue(array_filter_by_field($DÁ–î»Ğ, $dŞ¯»ƒéÈ˜[405], $dŞ¯»ƒéÈ˜[87]), $dŞ¯»ƒéÈ˜[33], $dŞ¯»ƒéÈ˜[397]); $E¦ˆïÉÏ³ó = array_merge($E¦ˆïÉÏ³ó, array_to_keyvalue($DÁ–î»Ğ, $dŞ¯»ƒéÈ˜[33], $dŞ¯»ƒéÈ˜[397])); goto c¶Â²©ªÁ•; d–½ÜĞƒ: $E¦ˆïÉÏ³ó = array_merge($E¦ˆïÉÏ³ó, array_to_keyvalue($DÁ–î»Ğ, $dŞ¯»ƒéÈ˜[33], $dŞ¯»ƒéÈ˜[397])); $E¦ˆïÉÏ³ó = array_slice($E¦ˆïÉÏ³ó, 0, $D×èÚ§Õ²); return $E¦ˆïÉÏ³ó; goto aŠƒ§µÅ÷¯; c¶Â²©ªÁ•: if (!$AÑÅ¬Îåïø) { return $E¦ˆïÉÏ³ó; } $e¶Ë¦“ìÓ = array($dŞ¯»ƒéÈ˜[492] => array($dŞ¯»ƒéÈ˜[7], $AÑÅ¬Îåïø)); $DÁ–î»Ğ = $this->field($dŞ¯»ƒéÈ˜[1984])->where($e¶Ë¦“ìÓ)->limit($D×èÚ§Õ²)->select(); goto d–½ÜĞƒ; aŠƒ§µÅ÷¯: } private function _listSearchBindPinyin($bòÎªŸ, &$CòÖÙèÓì³, &$A†•†½äã¶) { goto D¿ÆáÁ™Œ; d´Ø¾¨Æ½…: $CòÖÙèÓì³ = $B÷¡Ö”Õ™¬; goto B¥¡ãÏÑ; aê¨‹êÛ—à: $A†•†½äã¶ = $A‡‚ß¾Ê•š[430] . str_replace($A‡‚ß¾Ê•š[47], $A‡‚ß¾Ê•š[431], $A†•†½äã¶); $F«‚³Ø¯É = $CòÖÙèÓì³[$A‡‚ß¾Ê•š[28]]; unset($CòÖÙèÓì³[$A‡‚ß¾Ê•š[28]]); goto Bõ­Ã“«Æ°; cĞ¯™á†Ú†: $eÀˆé¨¢Í = "\114\x45\x46\x54\40\112\117\111\116\40{$this->tablePrefix}\151\x6f\137\x73\x6f\x75\162\x63\145\137\x6d\145\164\x61\40\x6d\145\x74\x61\x20\x6f\156\x20\163\x6f\x75\162\143\x65\56\163\x6f\x75\162\143\145\111\x44\40\x3d\40\x6d\145\x74\x61\56\x73\157\x75\x72\143\x65\x49\104"; $B÷¡Ö”Õ™¬ = array(); $A†•†½äã¶ = str_replace(array($A‡‚ß¾Ê•š[229], $A‡‚ß¾Ê•š[50], $A‡‚ß¾Ê•š[1985]), $A‡‚ß¾Ê•š[33], $A†•†½äã¶); goto aê¨‹êÛ—à; Bõ­Ã“«Æ°: foreach ($CòÖÙèÓì³ as $FÏåˆéºÜÕ => $EÁè¡´°öÚ) { $B÷¡Ö”Õ™¬[$A‡‚ß¾Ê•š[430] . $FÏåˆéºÜÕ] = $EÁè¡´°öÚ; } foreach ($F«‚³Ø¯É as $c™ŞË¹•‡×) { $B÷¡Ö”Õ™¬[] = array($A‡‚ß¾Ê•š[435] => $c™ŞË¹•‡×, $A‡‚ß¾Ê•š[992] => $A‡‚ß¾Ê•š[1825], array($A‡‚ß¾Ê•š[1986] => $c™ŞË¹•‡×, $A‡‚ß¾Ê•š[1987] => array($A‡‚ß¾Ê•š[7], array($A‡‚ß¾Ê•š[458], $A‡‚ß¾Ê•š[457])))); } $this->join($eÀˆé¨¢Í); goto d´Ø¾¨Æ½…; D¿ÆáÁ™Œ: $A‡‚ß¾Ê•š =& $_SERVER[©äõ½¡]; if (!isset($bòÎªŸ[$A‡‚ß¾Ê•š[1821]]) || !$bòÎªŸ[$A‡‚ß¾Ê•š[1821]]) { return; } if (!Input::check($bòÎªŸ[$A‡‚ß¾Ê•š[1821]], $A‡‚ß¾Ê•š[316]) || strlen($bòÎªŸ[$A‡‚ß¾Ê•š[1821]]) < 2) { return; } goto cĞ¯™á†Ú†; B¥¡ãÏÑ: } private function _parseSearchWhere($d§É°Ì») { goto Eì·ãà™°¹; Cì¢‘ë‹Ä: if (isset($d§É°Ì»[$a¾ç›ë¨öá[588]]) && $d§É°Ì»[$a¾ç›ë¨öá[588]]) { $cˆÅšÈš¨[] = array($a¾ç›ë¨öá[448] => $d§É°Ì»[$a¾ç›ë¨öá[588]], $a¾ç›ë¨öá[446] => $d§É°Ì»[$a¾ç›ë¨öá[588]], $a¾ç›ë¨öá[992] => $a¾ç›ë¨öá[1825]); } if (isset($d§É°Ì»[$a¾ç›ë¨öá[407]]) && $d§É°Ì»[$a¾ç›ë¨öá[407]]) { $C®ÉÔ©·Œ = $d§É°Ì»[$a¾ç›ë¨öá[407]]; if ($C®ÉÔ©·Œ == $a¾ç›ë¨öá[77]) { $cˆÅšÈš¨[$a¾ç›ë¨öá[405]] = 1; } else { if ($C®ÉÔ©·Œ == $a¾ç›ë¨öá[1991]) { $cˆÅšÈš¨[$a¾ç›ë¨öá[405]] = 0; } else { if ($C®ÉÔ©·Œ) { $C®ÉÔ©·Œ = is_array($C®ÉÔ©·Œ) ? $C®ÉÔ©·Œ : explode($a¾ç›ë¨öá[47], $C®ÉÔ©·Œ); $cˆÅšÈš¨[$a¾ç›ë¨öá[407]] = array($a¾ç›ë¨öá[413], $C®ÉÔ©·Œ); $cˆÅšÈš¨[$a¾ç›ë¨öá[405]] = 0; } } } } $this->_parseSearchParent($d§É°Ì», $cˆÅšÈš¨); goto D«ò™Óì; D«ò™Óì: if (isset($d§É°Ì»[$a¾ç›ë¨öá[1821]]) && trim($d§É°Ì»[$a¾ç›ë¨öá[1821]])) { $AÜ¤ÇÀ–ùØ = trim($d§É°Ì»[$a¾ç›ë¨öá[1821]]); $BİÏ£ƒòè = explode($a¾ç›ë¨öá[50], $AÜ¤ÇÀ–ùØ); if (strlen($AÜ¤ÇÀ–ùØ) > 2 && (substr($AÜ¤ÇÀ–ùØ, 0, 1) == $a¾ç›ë¨öá[116] && substr($AÜ¤ÇÀ–ùØ, -1) == $a¾ç›ë¨öá[116]) || substr($AÜ¤ÇÀ–ùØ, 0, 1) == $a¾ç›ë¨öá[55] && substr($AÜ¤ÇÀ–ùØ, -1) == $a¾ç›ë¨öá[55]) { $AÜ¤ÇÀ–ùØ = substr($AÜ¤ÇÀ–ùØ, 1, -1); $BİÏ£ƒòè = array($AÜ¤ÇÀ–ùØ); } $cˆÅšÈš¨[$a¾ç›ë¨öá[28]] = array(array($a¾ç›ë¨öá[538], $a¾ç›ë¨öá[1823] . $AÜ¤ÇÀ–ùØ . $a¾ç›ë¨öá[1823])); if (count($BİÏ£ƒòè) > 1) { $cˆÅšÈš¨[$a¾ç›ë¨öá[28]] = array(); foreach ($BİÏ£ƒòè as $cê…óñØ‰) { if (!trim($cê…óñØ‰)) { continue; } $cˆÅšÈš¨[$a¾ç›ë¨öá[28]][] = array($a¾ç›ë¨öá[538], $a¾ç›ë¨öá[1823] . trim($cê…óñØ‰) . $a¾ç›ë¨öá[1823]); } } } return $cˆÅšÈš¨; goto AŠ›‘“Â; AÈàïÄÒó¤: if (isset($d§É°Ì»[$a¾ç›ë¨öá[490]]) && $d§É°Ì»[$a¾ç›ë¨öá[490]]) { $C°­¾‚ËÖ¿ = array($a¾ç›ë¨öá[1989], $d§É°Ì»[$a¾ç›ë¨öá[490]]); if ($cˆÅšÈš¨[$a¾ç›ë¨öá[84]]) { $cˆÅšÈš¨[$a¾ç›ë¨öá[84]] = array($cˆÅšÈš¨[$a¾ç›ë¨öá[84]], $C°­¾‚ËÖ¿, $a¾ç›ë¨öá[1990]); } else { $cˆÅšÈš¨[$a¾ç›ë¨öá[84]] = $C°­¾‚ËÖ¿; } } if (isset($d§É°Ì»[$a¾ç›ë¨öá[1982]]) && $d§É°Ì»[$a¾ç›ë¨öá[1982]] > 0) { $cˆÅšÈš¨[$a¾ç›ë¨öá[78]] = array($a¾ç›ë¨öá[1988], $d§É°Ì»[$a¾ç›ë¨öá[1982]]); } if (isset($d§É°Ì»[$a¾ç›ë¨öá[1983]]) && $d§É°Ì»[$a¾ç›ë¨öá[1983]]) { $C°­¾‚ËÖ¿ = array($a¾ç›ë¨öá[1989], $d§É°Ì»[$a¾ç›ë¨öá[1983]]); if ($cˆÅšÈš¨[$a¾ç›ë¨öá[78]]) { $cˆÅšÈš¨[$a¾ç›ë¨öá[78]] = array($cˆÅšÈš¨[$a¾ç›ë¨öá[78]], $C°­¾‚ËÖ¿, $a¾ç›ë¨öá[1990]); } else { $cˆÅšÈš¨[$a¾ç›ë¨öá[78]] = $C°­¾‚ËÖ¿; } } goto Cì¢‘ë‹Ä; Eì·ãà™°¹: $a¾ç›ë¨öá =& $_SERVER[©äõ½¡]; $cˆÅšÈš¨ = array(); if (isset($d§É°Ì»[$a¾ç›ë¨öá[756]]) && $d§É°Ì»[$a¾ç›ë¨öá[756]]) { $cˆÅšÈš¨[$a¾ç›ë¨öá[84]] = array($a¾ç›ë¨öá[1988], $d§É°Ì»[$a¾ç›ë¨öá[756]]); } goto AÈàïÄÒó¤; AŠ›‘“Â: } private function _parseSearchParent($CÀ‚—·ù¹°, &$e§ø®ÑÎ¿Ù) { goto F÷‚•¼¹Ó½; BÖÅº°Œ‰£: $a¤·‰¥¥ì = count($Aï‚Å«Ò½); if ($a¤·‰¥¥ì <= 1) { return; } $dä½®ÜĞ¥ß = array($a¶²®øÈÌ[492] => 0, $a¶²®øÈÌ[406] => self::TYPE_GROUP, $a¶²®øÈÌ[498] => array($a¶²®øÈÌ[7], $Aï‚Å«Ò½)); goto C˜ìŠîì©Œ; CÄ¥ºš‰½±: $e§ø®ÑÎ¿Ù[$a¶²®øÈÌ[578]][] = $a¶²®øÈÌ[1825]; goto A„Ñ‰ß…¹•; F÷‚•¼¹Ó½: $a¶²®øÈÌ =& $_SERVER[©äõ½¡]; if (!isset($CÀ‚—·ù¹°[$a¶²®øÈÌ[492]]) || !$CÀ‚—·ù¹°[$a¶²®øÈÌ[492]]) { return; } $a„ó•ÌÙË = $this->pathInfo($CÀ‚—·ù¹°[$a¶²®øÈÌ[492]]); goto cš­Ê •–è; eÁî”ÅÑÂ: $CÓª¯´–Û‰ = $a„ó•ÌÙË[$a¶²®øÈÌ[498]] . $a¶²®øÈÌ[33]; if ($CÓª¯´–Û‰ == $a¶²®øÈÌ[87]) { unset($e§ø®ÑÎ¿Ù[$a¶²®øÈÌ[578]]); $e§ø®ÑÎ¿Ù[$a¶²®øÈÌ[406]] = self::TYPE_GROUP; return; } $Aï‚Å«Ò½ = Model($a¶²®øÈÌ[516])->groupChildrenAll($CÓª¯´–Û‰); goto BÖÅº°Œ‰£; F°òğ®Íª“: $A“Ù™±“¶… = isset($CÀ‚—·ù¹°[$a¶²®øÈÌ[1689]]) && in_array($a¶²®øÈÌ[509], $CÀ‚—·ù¹°[$a¶²®øÈÌ[1689]]); if (!$A“Ù™±“¶… || !$cğ¢„¥£‹ || !$C‘‰µË‚â || !$a„ó•ÌÙË[$a¶²®øÈÌ[408]]) { return; } if (!AuthModel::authCheckRoot($a„ó•ÌÙË[$a¶²®øÈÌ[408]][$a¶²®øÈÌ[409]])) { return; } goto eÁî”ÅÑÂ; cš­Ê •–è: $C‘‰µË‚â = $a„ó•ÌÙË[$a¶²®øÈÌ[492]] . $a¶²®øÈÌ[33] === $a¶²®øÈÌ[191]; $cğ¢„¥£‹ = $a„ó•ÌÙË[$a¶²®øÈÌ[406]] == $a¶²®øÈÌ[509]; $e§ø®ÑÎ¿Ù[$a¶²®øÈÌ[578]] = array($a¶²®øÈÌ[538], $a„ó•ÌÙË[$a¶²®øÈÌ[515]] . $CÀ‚—·ù¹°[$a¶²®øÈÌ[492]] . $a¶²®øÈÌ[539]); goto F°òğ®Íª“; C˜ìŠîì©Œ: $D ñÀ‰³Îê = $this->field($a¶²®øÈÌ[1992])->where($dä½®ÜĞ¥ß)->limit($a¤·‰¥¥ì)->select(); $e§ø®ÑÎ¿Ù[$a¶²®øÈÌ[578]] = array(); foreach ($D ñÀ‰³Îê as $Fó¹Û¨ù‹) { $e§ø®ÑÎ¿Ù[$a¶²®øÈÌ[578]][] = array($a¶²®øÈÌ[538], $a¶²®øÈÌ[525] . $Fó¹Û¨ù‹[$a¶²®øÈÌ[397]] . $a¶²®øÈÌ[539]); } goto CÄ¥ºš‰½±; A„Ñ‰ß…¹•: } } goto C¦³Âî‡³È; f¡Ë«ÎŠ‰ğ: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($cÌ‘±Ç„ƒ‚, $BÄØÈÆ¨¨ = 5.0) { if (!$cÌ‘±Ç„ƒ‚) { return; } $bçñ¥ğ¤– = Cache::get($cÌ‘±Ç„ƒ‚); if (!$bçñ¥ğ¤– || timeFloat() - floatVal($bçñ¥ğ¤–) >= $BÄØÈÆ¨¨) { Cache::set($cÌ‘±Ç„ƒ‚, timeFloat(), $BÄØÈÆ¨¨ * 10); return !0; } return !1; } public static function timeLimitCall($DÄŸâè„À, $e“‹¸ôËÕ¯, $b¢¬ˆ¼ÒòŒ, $bŸª¸âë¢ = 5.0) { goto D¯æÛÅá°; B’Ñ¶™›Ë…: $BÁÀÁ¬³Ş = $AºãœËµº—[1644]; $Dè¾ÃÑñÉŸ = Cache::get($BÁÀÁ¬³Ş, !0); $fæÕ¦ ÛßÀ = array($AºãœËµº—[1645] => timeFloat(), $AºãœËµº—[1646] => timeFloat(), $AºãœËµº—[262] => $e“‹¸ôËÕ¯, $AºãœËµº—[1639] => $b¢¬ˆ¼ÒòŒ, $AºãœËµº—[197] => $bŸª¸âë¢); goto cè¦Œ’’Ğì; cè¦Œ’’Ğì: if (is_array($Dè¾ÃÑñÉŸ[$DÄŸâè„À])) { $fæÕ¦ ÛßÀ[$AºãœËµº—[1646]] = $Dè¾ÃÑñÉŸ[$DÄŸâè„À][$AºãœËµº—[1646]]; } if (is_array($Dè¾ÃÑñÉŸ[$DÄŸâè„À])) { if (timeFloat() - $Dè¾ÃÑñÉŸ[$DÄŸâè„À][$AºãœËµº—[1645]] < $fæÕ¦ ÛßÀ[$AºãœËµº—[197]] * 0.3) { return; } $fæÕ¦ ÛßÀ[$AºãœËµº—[1646]] = $Dè¾ÃÑñÉŸ[$DÄŸâè„À][$AºãœËµº—[1646]]; } $Dè¾ÃÑñÉŸ[$DÄŸâè„À] = $fæÕ¦ ÛßÀ; goto AêÑØÇˆ”; D¯æÛÅá°: $AºãœËµº— =& $_SERVER[©äõ½¡]; if (!$DÄŸâè„À || !$e“‹¸ôËÕ¯) { return; } self::$asyncAdd = !0; goto B’Ñ¶™›Ë…; AêÑØÇˆ”: Cache::set($BÁÀÁ¬³Ş, $Dè¾ÃÑñÉŸ, 60); Cache::removeMemory($BÁÀÁ¬³Ş); write_log($AºãœËµº—[1647] . $DÄŸâè„À . $AºãœËµº—[68] . $e“‹¸ôËÕ¯, $AºãœËµº—[1641]); goto D¬µ†ôéàÄ; D¬µ†ôéàÄ: } public static function timeLimitCallLoop() { goto bô·î…ƒÕš; bô·î…ƒÕš: $dº¹®Ø…óŸ =& $_SERVER[©äõ½¡]; $c“¹±Šƒ‚ = array($dº¹®Ø…óŸ[1648]); $A÷ô‡¸Í‚­ = in_array(strtolower(ACTION), $c“¹±Šƒ‚); goto eù‹’Ïõã; f‰»½À¡Õì: $CÔ¬ß¡Ô¤ = array(); foreach ($eëÑìèÈôŞ as $DñƒöØë => $e¡Åè”ùî¤) { if ($D¿Ò£ÚéßÆ - $e¡Åè”ùî¤[$dº¹®Ø…óŸ[1646]] > $e¡Åè”ùî¤[$dº¹®Ø…óŸ[197]]) { $bÀ§ˆ™“ö = !0; try { Hook::apply($e¡Åè”ùî¤[$dº¹®Ø…óŸ[262]], $e¡Åè”ùî¤[$dº¹®Ø…óŸ[1639]]); write_log($dº¹®Ø…óŸ[1649] . $DñƒöØë . $dº¹®Ø…óŸ[68] . $e¡Åè”ùî¤[$dº¹®Ø…óŸ[262]] . $dº¹®Ø…óŸ[1650] . ACTION, $dº¹®Ø…óŸ[1641]); } catch (Exception $b¯Ôˆ†µ¼Ö) { } continue; } $CÔ¬ß¡Ô¤[$DñƒöØë] = $e¡Åè”ùî¤; } if (!$bÀ§ˆ™“ö) { return; } goto cŠÏ²ˆ—‡©; eù‹’Ïõã: if (!$A÷ô‡¸Í‚­ && !self::$asyncAdd) { return; } $AŠÀ‹Ê¢× = $dº¹®Ø…óŸ[1644]; $eëÑìèÈôŞ = Cache::get($AŠÀ‹Ê¢×, !0); goto f¦©˜ÂƒìÈ; f¦©˜ÂƒìÈ: if (!$eëÑìèÈôŞ || count($eëÑìèÈôŞ) <= 0) { return; } $bÀ§ˆ™“ö = !1; $D¿Ò£ÚéßÆ = timeFloat(); goto f‰»½À¡Õì; cŠÏ²ˆ—‡©: if (!$CÔ¬ß¡Ô¤) { return Cache::remove($AŠÀ‹Ê¢×); } Cache::set($AŠÀ‹Ê¢×, $CÔ¬ß¡Ô¤, 60); Cache::removeMemory($AŠÀ‹Ê¢×); goto Fœë‚·Óí; Fœë‚·Óí: } public static function finished($BîíÍ—ğŒó, $b¹´´µÓßÍ) { $cÚ•’‚Œ¬˜ =& $_SERVER[©äõ½¡]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($cÚ•’‚Œ¬˜[262] => $BîíÍ—ğŒó, $cÚ•’‚Œ¬˜[1639] => $b¹´´µÓßÍ); } private static function finishedRun() { $BÚ¨Ù”¨®« =& $_SERVER[©äõ½¡]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $D™ğ¿Ë¯İğ) { try { Hook::apply($D™ğ¿Ë¯İğ[$BÚ¨Ù”¨®«[262]], $D™ğ¿Ë¯İğ[$BÚ¨Ù”¨®«[1639]]); } catch (Exception $AŞ•éŞ„‡À) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto bğËìİ£Ôà; eÈŞ–·Ó¤: Hook::bind($e«ö­Š”¤Ş[1122], array($this, $e«ö­Š”¤Ş[1653])); $FòÁóİµ¼È =& $this->task; $FòÁóİµ¼È[$e«ö­Š”¤Ş[1654]] = $e«ö­Š”¤Ş[1127]; goto C¢…»ê§¸ ; bğËìİ£Ôà: $e«ö­Š”¤Ş =& $_SERVER[©äõ½¡]; parent::startAfter(); Hook::bind($e«ö­Š”¤Ş[1651], array($this, $e«ö­Š”¤Ş[1652])); goto eÈŞ–·Ó¤; C¢…»ê§¸ : if (!$FòÁóİµ¼È[$e«ö­Š”¤Ş[1465]]) { $FòÁóİµ¼È[$e«ö­Š”¤Ş[1465]] = LNG($e«ö­Š”¤Ş[1655]); } goto f×ÃğØà¢‡; f×ÃğØà¢‡: } protected function endAfter() { $a‰áÓïÀ¸ =& $_SERVER[©äõ½¡]; parent::endAfter(); Hook::unbind($a‰áÓïÀ¸[1651], array($this, $a‰áÓïÀ¸[1652])); Hook::unbind($a‰áÓïÀ¸[1122], array($this, $a‰áÓïÀ¸[1653])); } public function updateAfter() { $c²ŒÅæëÄº =& $_SERVER[©äõ½¡]; $Eø’–§â =& $this->task; if (!$Eø’–§â[$c²ŒÅæëÄº[1055]] || !$Eø’–§â[$c²ŒÅæëÄº[758]]) { return; } if ($Eø’–§â[$c²ŒÅæëÄº[1654]] == $c²ŒÅæëÄº[1127]) { $aÀÕ˜ŒªÚ‡ = 0; if ($Eø’–§â[$c²ŒÅæëÄº[1610]]) { $aÀÕ˜ŒªÚ‡ = $Eø’–§â[$c²ŒÅæëÄº[1611]] / $Eø’–§â[$c²ŒÅæëÄº[1610]]; } $Eø’–§â[$c²ŒÅæëÄº[1565]] = $aÀÕ˜ŒªÚ‡ * 0.3; } else { if ($Eø’–§â[$c²ŒÅæëÄº[1654]] == $c²ŒÅæëÄº[311]) { $aÀÕ˜ŒªÚ‡ = $Eø’–§â[$c²ŒÅæëÄº[1069]] / $Eø’–§â[$c²ŒÅæëÄº[1055]]; $Eø’–§â[$c²ŒÅæëÄº[1565]] = 0.3 + $aÀÕ˜ŒªÚ‡ * 0.4; } else { if ($Eø’–§â[$c²ŒÅæëÄº[1654]] == $c²ŒÅæëÄº[107]) { $D«“¯õ·»¤ = 0; if ($Eø’–§â[$c²ŒÅæëÄº[1612]] == $c²ŒÅæëÄº[107]) { $D«“¯õ·»¤ = $Eø’–§â[$c²ŒÅæëÄº[1611]]; } $aÀÕ˜ŒªÚ‡ = ($Eø’–§â[$c²ŒÅæëÄº[1615]] + $D«“¯õ·»¤) / $Eø’–§â[$c²ŒÅæëÄº[758]]; $Eø’–§â[$c²ŒÅæëÄº[1565]] = 0.3 + 0.4 + $aÀÕ˜ŒªÚ‡ * 0.3; } } } if ($Eø’–§â[$c²ŒÅæëÄº[1565]] > 0) { $cŠƒ¶óÒ = timeFloat() - $Eø’–§â[$c²ŒÅæëÄº[784]] - $Eø’–§â[$c²ŒÅæëÄº[1568]]; $Eø’–§â[$c²ŒÅæëÄº[1569]] = $cŠƒ¶óÒ * (1 - $Eø’–§â[$c²ŒÅæëÄº[1565]]) / $Eø’–§â[$c²ŒÅæëÄº[1565]]; } } public function addFile($fØäÂ‡†„ç) { goto cÚğ†ëò±; bÈ¢ºØßö: $this->update(); goto A†ë–ø§§; cÚğ†ëò±: $fó¤è…È¼“ =& $_SERVER[©äõ½¡]; $Fª‹›¸ Üº =& $this->task; $cÍƒÈÁÂ’£ = IO::info($fØäÂ‡†„ç); goto bŠƒ‹¶éÛç; aÕÑâé³ã: $Fª‹›¸ Üº[$fó¤è…È¼“[1055]] = 1; $D£ÏˆŠéƒ¸ = 0; $Fª‹›¸ Üº[$fó¤è…È¼“[1619]] = array($fó¤è…È¼“[1620] => $D£ÏˆŠéƒ¸ + 1, $fó¤è…È¼“[415] => $cÍƒÈÁÂ’£[$fó¤è…È¼“[28]], $fó¤è…È¼“[76] => $cÍƒÈÁÂ’£[$fó¤è…È¼“[76]], $fó¤è…È¼“[513] => $cÍƒÈÁÂ’£[$fó¤è…È¼“[513]] ? $cÍƒÈÁÂ’£[$fó¤è…È¼“[513]] : $cÍƒÈÁÂ’£[$fó¤è…È¼“[76]]); goto bÈ¢ºØßö; bŠƒ‹¶éÛç: $Fª‹›¸ Üº[$fó¤è…È¼“[1608]] = $cÍƒÈÁÂ’£[$fó¤è…È¼“[28]]; $Fª‹›¸ Üº[$fó¤è…È¼“[1610]] = $cÍƒÈÁÂ’£[$fó¤è…È¼“[78]]; $Fª‹›¸ Üº[$fó¤è…È¼“[1611]] = 0; goto E®¸ï¶§‚; E®¸ï¶§‚: $Fª‹›¸ Üº[$fó¤è…È¼“[1057]] = $fó¤è…È¼“[1630]; $Fª‹›¸ Üº[$fó¤è…È¼“[1612]] = $fó¤è…È¼“[1127]; $Fª‹›¸ Üº[$fó¤è…È¼“[758]] = $cÍƒÈÁÂ’£[$fó¤è…È¼“[78]]; goto aÕÑâé³ã; A†ë–ø§§: } public function unzipAfter($A˜ÑÂö¤²) { goto bº¿¬öÉçà; d™“˜âÈÂÛ: $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1608]] = $aƒö‚Ş” ‰[33]; $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1615]] = 0; $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[758]] = $d®‹ÌÉÜÈ¬[$aƒö‚Ş” ‰[78]]; goto C°×¢É‹; fš´œ‡Ï…–: $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1069]] = 0; $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1610]] = 0; $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1611]] = 0; goto d™“˜âÈÂÛ; Fˆ°â³¢ñ: if ($d®‹ÌÉÜÈ¬[$aƒö‚Ş” ‰[29]] == $aƒö‚Ş” ‰[193]) { $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1055]] = 1; } else { $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1055]] = $d®‹ÌÉÜÈ¬[$aƒö‚Ş” ‰[81]][$aƒö‚Ş” ‰[79]]; } $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1057]] = $aƒö‚Ş” ‰[33]; $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1612]] = 0; goto fš´œ‡Ï…–; bº¿¬öÉçà: $aƒö‚Ş” ‰ =& $_SERVER[©äõ½¡]; $dÆÄ–™œ¸Ğ =& $this->task; $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1654]] = $aƒö‚Ş” ‰[107]; goto Eœ£’š‚Íƒ; C°×¢É‹: $this->update(); self::log($aƒö‚Ş” ‰[1656] . json_encode(array($dÆÄ–™œ¸Ğ, $d®‹ÌÉÜÈ¬))); goto fğŠ™—ÕÔ¡; Eœ£’š‚Íƒ: $d®‹ÌÉÜÈ¬ = IO::infoWithChildren($A˜ÑÂö¤²); $B¦‘™Õ¬ÊÊ = 0; $dÆÄ–™œ¸Ğ[$aƒö‚Ş” ‰[1619]] = array($aƒö‚Ş” ‰[1620] => $B¦‘™Õ¬ÊÊ + 1, $aƒö‚Ş” ‰[415] => $d®‹ÌÉÜÈ¬[$aƒö‚Ş” ‰[28]], $aƒö‚Ş” ‰[76] => $d®‹ÌÉÜÈ¬[$aƒö‚Ş” ‰[76]], $aƒö‚Ş” ‰[513] => $d®‹ÌÉÜÈ¬[$aƒö‚Ş” ‰[513]] ? $d®‹ÌÉÜÈ¬[$aƒö‚Ş” ‰[513]] : $d®‹ÌÉÜÈ¬[$aƒö‚Ş” ‰[76]]); goto Fˆ°â³¢ñ; fğŠ™—ÕÔ¡: } public function nameParse($C—Ê‚†ì†Š) { goto cÌÕÃ³èß¦; e„ò ô§³…: $this->update(); goto fäÀ±‚…ƒ’; cÌÕÃ³èß¦: $C‰÷‹±¹ùØ =& $_SERVER[©äõ½¡]; $fÑ™ŠÆ´Èó =& $this->task; if ($fÑ™ŠÆ´Èó[$C‰÷‹±¹ùØ[1654]] == $C‰÷‹±¹ùØ[1127]) { $fÑ™ŠÆ´Èó[$C‰÷‹±¹ùØ[1654]] = $C‰÷‹±¹ùØ[311]; $fÑ™ŠÆ´Èó[$C‰÷‹±¹ùØ[1615]] = 0; $fÑ™ŠÆ´Èó[$C‰÷‹±¹ùØ[758]] = 0; } goto fÀñ©Ğ£†»; fÀñ©Ğ£†»: $b„à†»ï‡ = get_path_this($C—Ê‚†ì†Š); if (strstr($b„à†»ï‡, $C‰÷‹±¹ùØ[95])) { $fÑ™ŠÆ´Èó[$C‰÷‹±¹ùØ[1069]] += 1; $fÑ™ŠÆ´Èó[$C‰÷‹±¹ùØ[1055]] += 1; } $fÑ™ŠÆ´Èó[$C‰÷‹±¹ùØ[1608]] = $C—Ê‚†ì†Š; goto e„ò ô§³…; fäÀ±‚…ƒ’: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $dÖô¶›ö¥ =& $_SERVER[©äõ½¡]; parent::startAfter(); Hook::bind($dÖô¶›ö¥[1657], array($this, $dÖô¶›ö¥[1652])); $b¼×÷´Š =& $this->task; $b¼×÷´Š[$dÖô¶›ö¥[1654]] = $dÖô¶›ö¥[1127]; if (!$b¼×÷´Š[$dÖô¶›ö¥[1465]]) { $b¼×÷´Š[$dÖô¶›ö¥[1465]] = LNG($dÖô¶›ö¥[1658]); } } protected function endAfter() { $déÛí«¸İ =& $_SERVER[©äõ½¡]; parent::endAfter(); Hook::unbind($déÛí«¸İ[1657], array($this, $déÛí«¸İ[1652])); } public function updateAfter() { $f‚»Š•ó„Ü =& $_SERVER[©äõ½¡]; $cò¤’Ü­­Ò =& $this->task; if (!$cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1055]] || !$cò¤’Ü­­Ò[$f‚»Š•ó„Ü[758]]) { return; } if ($cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1654]] == $f‚»Š•ó„Ü[1127]) { $FÖèŒİˆÔ = $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1611]]; if ($cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1612]] != $f‚»Š•ó„Ü[1127]) { $FÖèŒİˆÔ = 0; } $fŠ«¬ˆÖ‰¤ = ($cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1615]] + $FÖèŒİˆÔ) / $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[758]]; $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1565]] = $fŠ«¬ˆÖ‰¤ * 0.3; } else { if ($cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1654]] == $f‚»Š•ó„Ü[311]) { $fŠ«¬ˆÖ‰¤ = $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1069]] / $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1055]]; $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1565]] = 0.3 + $fŠ«¬ˆÖ‰¤ * 0.5; } else { if ($cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1654]] == $f‚»Š•ó„Ü[107]) { $fŠ«¬ˆÖ‰¤ = 0; if ($cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1610]]) { $fŠ«¬ˆÖ‰¤ = $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1611]] / $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1610]]; } $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1565]] = 0.3 + 0.5 + $fŠ«¬ˆÖ‰¤ * 0.2; } } } if ($cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1565]] > 0) { $cÈÚ¡Íø¸ = timeFloat() - $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[784]] - $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1568]]; $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1569]] = $cÈÚ¡Íø¸ * (1 - $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1565]]) / $cò¤’Ü­­Ò[$f‚»Š•ó„Ü[1565]]; } } public function copyFileStart($FÑÁÃ°ÏÍ, $E¥Û­¿‹›, $F¨šÑÀ§©, $aô¼ğØÔ©¥, $bÅèÉæÁ‘, $cŠÈŞ–¥î) { $d’ä ƒ½¼ƒ =& $_SERVER[©äõ½¡]; parent::copyFileStart($FÑÁÃ°ÏÍ, $E¥Û­¿‹›, $F¨šÑÀ§©, $aô¼ğØÔ©¥, $bÅèÉæÁ‘, $cŠÈŞ–¥î); $f÷±ƒ”‚‘È =& $this->task; if ($f÷±ƒ”‚‘È[$d’ä ƒ½¼ƒ[1654]] == $d’ä ƒ½¼ƒ[311]) { $f÷±ƒ”‚‘È[$d’ä ƒ½¼ƒ[1654]] = $d’ä ƒ½¼ƒ[107]; } $this->update(); } public function copyFileEnd($fÓÕåƒÚ”¿, $b¨ïñÈ–Í, $FŸ……ÂÉ, $e—ºìÓèÆî, $c±Ö¬¤ä›Ş, $B®ó°„•¨Ş) { $DŞæîƒòª =& $_SERVER[©äõ½¡]; $d‹çñ¢ÈØƒ =& $this->task; $d‹çñ¢ÈØƒ[$DŞæîƒòª[1611]] = $d‹çñ¢ÈØƒ[$DŞæîƒòª[1610]]; $d‹çñ¢ÈØƒ[$DŞæîƒòª[1615]] += $d‹çñ¢ÈØƒ[$DŞæîƒòª[1610]]; $d‹çñ¢ÈØƒ[$DŞæîƒòª[1612]] = $DŞæîƒòª[33]; $this->update(); } public function nameParse($FÕ†ˆ‡ Ğö) { $c±½“ĞíÃ— =& $_SERVER[©äõ½¡]; $FÒÇõ…‘Ä… =& $this->task; if ($FÒÇõ…‘Ä…[$c±½“ĞíÃ—[1069]] < $FÒÇõ…‘Ä…[$c±½“ĞíÃ—[1055]]) { $bÍ£‰¦¤‰ = get_path_this($FÕ†ˆ‡ Ğö); if (strstr($bÍ£‰¦¤‰, $c±½“ĞíÃ—[95])) { $FÒÇõ…‘Ä…[$c±½“ĞíÃ—[1069]] += 1; } } if ($FÒÇõ…‘Ä…[$c±½“ĞíÃ—[1654]] == $c±½“ĞíÃ—[1127]) { $FÒÇõ…‘Ä…[$c±½“ĞíÃ—[1654]] = $c±½“ĞíÃ—[311]; } $FÒÇõ…‘Ä…[$c±½“ĞíÃ—[1608]] = $FÕ†ˆ‡ Ğö; $this->update(); } } goto B²Ş«¾à÷ì; B“î”½²„•: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($eĞ¹â™Û‘) { parent::__construct($eĞ¹â™Û‘); $this->signatureVersion($_SERVER[©äõ½¡][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($Eäôæë„Ó) { parent::__construct($Eäôæë„Ó); $this->signatureVersion($_SERVER[©äõ½¡][212]); } public function fileOutLink($B¢¾´êˆù) { $B²¡¬øËØ½ =& $_SERVER[©äõ½¡]; if (substr($B¢¾´êˆù, 0, 7) == $B²¡¬øËØ½[1237]) { $B¢¾´êˆù = $B²¡¬øËØ½[1238] . substr($B¢¾´êˆù, 7); } header($B²¡¬øËØ½[159] . $B¢¾´êˆù); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($AÁò‚º˜Ç†) { parent::__construct(); include_once SDK_DIR . $_SERVER[©äõ½¡][1293]; $this->_init($AÁò‚º˜Ç†); } public function _init($aõë”‡ñœÛ) { $fã²÷Øã„ =& $_SERVER[©äõ½¡]; foreach ($aõë”‡ñœÛ as $f­¯×ˆïŸ => $E¾ŒğëÆ£ç) { if (isset($this->{$f­¯×ˆïŸ})) { $this->{$f­¯×ˆïŸ} = $E¾ŒğëÆ£ç; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($fã²÷Øã„[1294] . LNG($fã²÷Øã„[1295])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto cÚ’ãË‘; fëˆøÜà: $C‡Ê¤¾µÕ®->setMaxAgeSeconds(600); $C‡Ê¤¾µÕ®->addExposeHeader($Aæ‘•–…ŠÎ[1301]); $C‡Ê¤¾µÕ®->addAllowedHeader($Aæ‘•–…ŠÎ[1296]); goto CãôìÉ†; a²×»Óöáµ: $C‡Ê¤¾µÕ®->addAllowedOrigin($Aæ‘•–…ŠÎ[1296]); $C‡Ê¤¾µÕ®->addAllowedMethod($Aæ‘•–…ŠÎ[1297]); $C‡Ê¤¾µÕ®->addAllowedMethod($Aæ‘•–…ŠÎ[1298]); goto Aœ¦ƒÕ·ï‡; cÚ’ãË‘: $Aæ‘•–…ŠÎ =& $_SERVER[©äõ½¡]; $b›é÷‡—æ± = new OSS\Model\CorsConfig(); $C‡Ê¤¾µÕ® = new OSS\Model\CorsRule(); goto a²×»Óöáµ; CãôìÉ†: $b›é÷‡—æ±->addRule($C‡Ê¤¾µÕ®); try { $this->client->putBucketCors($this->bucket, $b›é÷‡—æ±); } catch (OSS\Core\OssException $A¦ĞÒ°Ã•) { return !1; } return !0; goto C¹Šˆá”ß»; Aœ¦ƒÕ·ï‡: $C‡Ê¤¾µÕ®->addAllowedMethod($Aæ‘•–…ŠÎ[1299]); $C‡Ê¤¾µÕ®->addAllowedMethod($Aæ‘•–…ŠÎ[1300]); $C‡Ê¤¾µÕ®->addAllowedMethod($Aæ‘•–…ŠÎ[158]); goto fëˆøÜà; C¹Šˆá”ß»: } public function getBucketCors() { goto cÎ‹ôîŠ­›; FåÇ—¦à·™: if (!$B ’—Œ²ïÜ || !($EÄ·À‘îê¿ = $B ’—Œ²ïÜ->getRules())) { return null; } $b¸ÑÀ¹ˆãó = $EÄ·À‘îê¿[0]->getAllowedOrigins(); $Bß·é‘‚»è = $EÄ·À‘îê¿[0]->getAllowedMethods(); goto C×‘î«¤ÏŞ; C×‘î«¤ÏŞ: $Aİ¥ÕÈõ¾® = $EÄ·À‘îê¿[0]->getMaxAgeSeconds(); $cçî—ô¹ = $EÄ·À‘îê¿[0]->getExposeHeaders(); $FšâöÔ¶ï = $EÄ·À‘îê¿[0]->getAllowedHeaders(); goto aŸ¿›ïŒº; aŸ¿›ïŒº: return array($AÆ…Ü÷…[181] => isset($b¸ÑÀ¹ˆãó[0]) ? $b¸ÑÀ¹ˆãó[0] : $AÆ…Ü÷…[33], $AÆ…Ü÷…[185] => $Bß·é‘‚»è, $AÆ…Ü÷…[1302] => $Aİ¥ÕÈõ¾®, $AÆ…Ü÷…[1303] => isset($cçî—ô¹[0]) ? $cçî—ô¹[0] : $AÆ…Ü÷…[33], $AÆ…Ü÷…[183] => isset($FšâöÔ¶ï[0]) ? $FšâöÔ¶ï[0] : $AÆ…Ü÷…[33]); goto cá¡âãò‹; cÎ‹ôîŠ­›: $AÆ…Ü÷… =& $_SERVER[©äõ½¡]; $B ’—Œ²ïÜ = null; try { $B ’—Œ²ïÜ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $CµÑßÍÄÙ) { return null; } goto FåÇ—¦à·™; cá¡âãò‹: } public function isBucketCors() { goto bÎæéËÃ“; bÎæéËÃ“: $cù¹Ø¼Ûò£ =& $_SERVER[©äõ½¡]; $d°»÷î³ö = $this->getBucketCors(); if (!$d°»÷î³ö || !is_array($d°»÷î³ö)) { return !1; } goto D‚ïÔ”ñÒô; D‚ïÔ”ñÒô: if ($d°»÷î³ö[$cù¹Ø¼Ûò£[181]] != $cù¹Ø¼Ûò£[182] || $d°»÷î³ö[$cù¹Ø¼Ûò£[183]] != $cù¹Ø¼Ûò£[182]) { return !1; } $Bœ˜Ù¢Æˆ = array_map($cù¹Ø¼Ûò£[184], $d°»÷î³ö[$cù¹Ø¼Ûò£[185]]); if (!is_array($Bœ˜Ù¢Æˆ)) { $Bœ˜Ù¢Æˆ = array(); } goto a§§„œ‹Ô²; a§§„œ‹Ô²: $cøÚÒäÁ¯µ = array($cù¹Ø¼Ûò£[186], $cù¹Ø¼Ûò£[187], $cù¹Ø¼Ûò£[188], $cù¹Ø¼Ûò£[189], $cù¹Ø¼Ûò£[190]); $câğÖ¼æ = array_diff($cøÚÒäÁ¯µ, $Bœ˜Ù¢Æˆ); return empty($câğÖ¼æ); goto bÌîç¦Ö–õ; bÌîç¦Ö–õ: } public function mkfile($eÎ“¢¨Òå, $b¨•‹¸Û•Œ = '', $BºªŠŸ¥—È = REPEAT_RENAME) { $BÄï´¹¯êó = $this->setContent($eÎ“¢¨Òå, $b¨•‹¸Û•Œ); if ($BÄï´¹¯êó !== !1) { return $this->getPathOuter($eÎ“¢¨Òå); } return !1; } public function mkdir($fØÅŒšÛ›À, $FÓ¢áØõ¤¬ = REPEAT_SKIP) { if ($this->_isFolder($fØÅŒšÛ›À)) { return $this->getPathOuter($fØÅŒšÛ›À); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($fØÅŒšÛ›À)); } catch (OSS\Core\OssException $d­å†œÙ¾) { return !1; } return $this->getPathOuter($fØÅŒšÛ›À); } private function fileList($DöÇ«ùé, $CÒ¼Ñ—æë¢ = '', $DÙ÷¦ã®›¯ = 0) { goto C×ˆãòˆÜ; C×ˆãòˆÜ: $E…˜êÑâ¨Ğ =& $_SERVER[©äõ½¡]; $DöÇ«ùé = trim($DöÇ«ùé, $E…˜êÑâ¨Ğ[8]); $DËœáôËãè = empty($DöÇ«ùé) && $DöÇ«ùé !== $E…˜êÑâ¨Ğ[191] ? $E…˜êÑâ¨Ğ[33] : $DöÇ«ùé . $E…˜êÑâ¨Ğ[8]; goto A¨¿ƒäª¯Ğ; A¨¿ƒäª¯Ğ: $F‹É«‰¬È = $E…˜êÑâ¨Ğ[33]; $d»êôò¬Ïº = 1000; $E°²‹¦·¾ = $this->listItemCache === !1 ? !1 : !0; goto fãÍÒ§ˆŸ; fãÍÒ§ˆŸ: $EíÓÀø¼îÃ = $bã«êÜ»Ğ± = array(); while (!0) { check_abort(); $BÄâ¦½éŠÏ = array($E…˜êÑâ¨Ğ[1304] => $CÒ¼Ñ—æë¢, $E…˜êÑâ¨Ğ[1305] => $DËœáôËãè, $E…˜êÑâ¨Ğ[1306] => $d»êôò¬Ïº, $E…˜êÑâ¨Ğ[1307] => $F‹É«‰¬È); try { $eĞ‘´¾†‘“ = $this->client->listObjects($this->bucket, $BÄâ¦½éŠÏ); } catch (OSS\Core\OssException $D¤¿±¨¿×„) { break; } $F‹É«‰¬È = $eĞ‘´¾†‘“->getNextMarker(); $a†“¡ß²Œº = $eĞ‘´¾†‘“->getObjectList(); $F¢§‡‘º¨× = $eĞ‘´¾†‘“->getPrefixList(); foreach ($a†“¡ß²Œº as $e¿öŠ¯”¸) { goto A¿ƒßª‹®Œ; b”»Åöç¯Ó: $dóˆ¹œ·–ó = $e¿öŠ¯”¸->getLastModified(); $bÓğöÀÃÕÎ = $DÙ÷¦ã®›¯ ? array($E…˜êÑâ¨Ğ[28] => $E×É°ÔãæÎ, $E…˜êÑâ¨Ğ[78] => $AìÆ—®¨µ°, $E…˜êÑâ¨Ğ[197] => strtotime($dóˆ¹œ·–ó)) : $E×É°ÔãæÎ; $FñÛÅˆÊ· = $AìÆ—®¨µ° == 0 && substr($E×É°ÔãæÎ, strlen($E×É°ÔãæÎ) - 1, 1) == $E…˜êÑâ¨Ğ[8] ? !0 : !1; goto EŒ½İ¹®®‰; EŒ½İ¹®®‰: if ($E°²‹¦·¾) { $this->cacheMethod($E…˜êÑâ¨Ğ[199], $E×É°ÔãæÎ, $FñÛÅˆÊ·); $this->cacheMethod($E…˜êÑâ¨Ğ[200], $E×É°ÔãæÎ, array($E…˜êÑâ¨Ğ[78] => $AìÆ—®¨µ°, $E…˜êÑâ¨Ğ[1308] => $AìÆ—®¨µ°, $E…˜êÑâ¨Ğ[84] => strtotime($dóˆ¹œ·–ó), $E…˜êÑâ¨Ğ[1309] => $dóˆ¹œ·–ó)); } if ($FñÛÅˆÊ·) { $EíÓÀø¼îÃ[] = $E×É°ÔãæÎ; continue; } $bã«êÜ»Ğ±[] = $bÓğöÀÃÕÎ; goto eœó×Åí‰ß; A¿ƒßª‹®Œ: if ($e¿öŠ¯”¸->getKey() == $DËœáôËãè) { continue; } $E×É°ÔãæÎ = $e¿öŠ¯”¸->getKey(); $AìÆ—®¨µ° = $e¿öŠ¯”¸->getSize(); goto b”»Åöç¯Ó; eœó×Åí‰ß: } foreach ($F¢§‡‘º¨× as $Aæèˆ…²½) { $EíÓÀø¼îÃ[] = $Aæèˆ…²½->getPrefix(); if ($E°²‹¦·¾) { $this->cacheMethod($E…˜êÑâ¨Ğ[199], $E×É°ÔãæÎ, !0); } } if ($F‹É«‰¬È === $E…˜êÑâ¨Ğ[33]) { break; } } if ($E°²‹¦·¾) { $this->cacheMethod($E…˜êÑâ¨Ğ[199], $DöÇ«ùé, !0); } goto d²†„¢ÇŠè; d²†„¢ÇŠè: return array($E…˜êÑâ¨Ğ[75] => $EíÓÀø¼îÃ, $E…˜êÑâ¨Ğ[74] => $bã«êÜ»Ğ±); goto dŸ™¶ƒ×÷›; dŸ™¶ƒ×÷›: } public function copyFile($Dò²°Šßé‰, $cÚ¸äï£ã¤) { $eÉåÎ¢öÃÏ = $this->size($Dò²°Šßé‰); if ($eÉåÎ¢öÃÏ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $Dò²°Šßé‰, $this->bucket, $this->pathEncode($cÚ¸äï£ã¤)); } catch (OSS\Core\OssException $aö¹ÂîÇùˆ) { return !1; } return $this->getPathOuter($cÚ¸äï£ã¤); } $D˜È•àì¯Ö = $this->multiCopyObject($Dò²°Šßé‰, $cÚ¸äï£ã¤, $eÉåÎ¢öÃÏ); return $D˜È•àì¯Ö ? $this->getPathOuter($cÚ¸äï£ã¤) : !1; } private function multiCopyObject($A„„±®™Ôô, $A›×’™×ğ”, $cÑ¢Æ¢øÕ˜) { $E…æ–ãŠ– =& $_SERVER[©äõ½¡]; try { goto B®µ¹‘‰Ô†; B®µ¹‘‰Ô†: $E±ÛöØËºÀ = array(); if ($dÃ¯Ú‹Ô¶Ä = $this->hashMd5($A„„±®™Ôô)) { $E±ÛöØËºÀ = array(OSS\OssClient::OSS_HEADERS => array($E…æ–ãŠ–[1310] => $dÃ¯Ú‹Ô¶Ä)); } $D¡ó’…³Ô = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($A›×’™×ğ”), $E±ÛöØËºÀ); goto FÃàùÓ±–; C†ñÖó°œá: $DóÖ£÷¢î = 1024 * 1024 * 10; $f¥Š±ê´è = $this->client->generateMultiuploadParts($cÑ¢Æ¢øÕ˜, $DóÖ£÷¢î); foreach ($f¥Š±ê´è as $cåáš¢Èø¡ => $AÖÄšƒ¸) { $fİÂ‚¯¿öê = $dˆùÄ…“‹¶ + (int) $AÖÄšƒ¸[$E…æ–ãŠ–[1311]]; $a²â›™šØ = (int) $AÖÄšƒ¸[$E…æ–ãŠ–[335]] + $fİÂ‚¯¿öê - 1; $Cåœ¡À´ñÔ = array($E…æ–ãŠ–[1312] => $fİÂ‚¯¿öê, $E…æ–ãŠ–[1313] => $a²â›™šØ); $cÌæÍãËË‰[] = $this->client->uploadPartCopy($this->bucket, $A„„±®™Ôô, $this->bucket, $this->pathEncode($A›×’™×ğ”), $CæØ¿Õª¢Å, $D¡ó’…³Ô, $Cåœ¡À´ñÔ); $CæØ¿Õª¢Å = $CæØ¿Õª¢Å + 1; } goto fğÅßŸÕ†Ë; FÃàùÓ±–: $CæØ¿Õª¢Å = 1; $dˆùÄ…“‹¶ = 0; $cÌæÍãËË‰ = array(); goto C†ñÖó°œá; fğÅßŸÕ†Ë: $F«Ïî’ÑµŒ = array(); foreach ($cÌæÍãËË‰ as $cåáš¢Èø¡ => $E„Âõƒ›ò) { $F«Ïî’ÑµŒ[] = array($E…æ–ãŠ–[1314] => $cåáš¢Èø¡ + 1, $E…æ–ãŠ–[1315] => $E„Âõƒ›ò); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($A›×’™×ğ”), $D¡ó’…³Ô, $F«Ïî’ÑµŒ); goto fŠ³‹½Ôº; fŠ³‹½Ôº: } catch (OSS\Core\OssException $e¤¢ãÍ¾Úè) { return !1; } return !0; } public function moveFile($B°¨åå«¡›, $e¾©¼··í²) { if ($this->copyFile($B°¨åå«¡›, $e¾©¼··í²)) { $this->remove($B°¨åå«¡›); return $this->getPathOuter($e¾©¼··í²); } return !1; } public function delFile($aµöÚ¦ĞÍ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($aµöÚ¦ĞÍ)); } catch (OSS\Core\OssException $Eä†™´¤Â—) { return !1; } return !0; } public function delFolder($bÄå›ß¡ù) { goto E°õÍÎ´; E°õÍÎ´: $Eëêô™Ê£Š =& $_SERVER[©äõ½¡]; if (!$this->exist($bÄå›ß¡ù)) { return !0; } $this->listItemCache = !1; goto fÆêó…¡Œ“; fÆêó…¡Œ“: $cè°ÕÖ³Í = $this->fileList($bÄå›ß¡ù); $this->listItemCache = !0; $AñÔÅó«Ô× = trim($bÄå›ß¡ù, $Eëêô™Ê£Š[8]) . $Eëêô™Ê£Š[8]; goto fƒ˜š‘© »; fƒ˜š‘© »: if (!empty($bÄå›ß¡ù) && $bÄå›ß¡ù !== $Eëêô™Ê£Š[191] && !in_array($AñÔÅó«Ô×, $cè°ÕÖ³Í[$Eëêô™Ê£Š[75]])) { $cè°ÕÖ³Í[$Eëêô™Ê£Š[75]][] = $AñÔÅó«Ô×; } $eŒµË’Œ—Ù = $this->delByBatch($cè°ÕÖ³Í[$Eëêô™Ê£Š[74]]); if (!$eŒµË’Œ—Ù) { return !1; } goto CÌ”é¼´ŸÌ; CÌ”é¼´ŸÌ: $eŒµË’Œ—Ù = $this->delByBatch($cè°ÕÖ³Í[$Eëêô™Ê£Š[75]]); if (!$eŒµË’Œ—Ù) { return !1; } return $this->delFile($AñÔÅó«Ô×); goto bÛ‰»Ë½›; bÛ‰»Ë½›: } private function delByBatch($A¦ÈàÄÓ´) { foreach (array_chunk($A¦ÈàÄÓ´, 1000) as $E­¤ÍŞ“îŸ) { try { $this->client->deleteObjects($this->bucket, $E­¤ÍŞ“îŸ); } catch (OSS\Core\OssException $DÆ÷ÎİãØ) { return !1; } } return !0; } public function rename($f¤Š–Ï¸±ï, $E¶±Š¡Úõ) { return $this->renameObject($f¤Š–Ï¸±ï, $E¶±Š¡Úõ); } private function fileInfo($FÚºŠÄó°î, $fùáÅİªÃö = false, $Eî¡ˆ íƒâ = array()) { goto c¦› ¥Œƒ; c¦› ¥Œƒ: $bõÊªÎÃÅ† =& $_SERVER[©äõ½¡]; $b½¤‚íöğ® = array($bõÊªÎÃÅ†[28] => $this->pathThis($FÚºŠÄó°î), $bõÊªÎÃÅ†[76] => $this->getPathOuter($FÚºŠÄó°î), $bõÊªÎÃÅ†[29] => $bõÊªÎÃÅ†[193], $bõÊªÎÃÅ†[78] => isset($Eî¡ˆ íƒâ[$bõÊªÎÃÅ†[78]]) ? $Eî¡ˆ íƒâ[$bõÊªÎÃÅ†[78]] : 0, $bõÊªÎÃÅ†[168] => $this->ext($FÚºŠÄó°î)); if ($fùáÅİªÃö) { return $b½¤‚íöğ®; } goto Eˆì©°îÙó; A¯‡°ø°‡¸: if (isset($Eî¡ˆ íƒâ[$bõÊªÎÃÅ†[78]])) { $b½¤‚íöğ®[$bõÊªÎÃÅ†[78]] = $Eî¡ˆ íƒâ[$bõÊªÎÃÅ†[78]]; } if (isset($Eî¡ˆ íƒâ[$bõÊªÎÃÅ†[84]])) { $b½¤‚íöğ®[$bõÊªÎÃÅ†[84]] = $Eî¡ˆ íƒâ[$bõÊªÎÃÅ†[84]]; } if (isset($Eî¡ˆ íƒâ[$bõÊªÎÃÅ†[197]]) && !trim($b½¤‚íöğ®[$bõÊªÎÃÅ†[84]])) { $b½¤‚íöğ®[$bõÊªÎÃÅ†[84]] = $Eî¡ˆ íƒâ[$bõÊªÎÃÅ†[197]]; } goto cæ±ÔĞ÷ˆ; cæ±ÔĞ÷ˆ: return $b½¤‚íöğ®; goto E¿÷íÓˆó¬; Eˆì©°îÙó: $b½¤‚íöğ®[$bõÊªÎÃÅ†[194]] = $b½¤‚íöğ®[$bõÊªÎÃÅ†[84]] = 0; $b½¤‚íöğ®[$bõÊªÎÃÅ†[195]] = $b½¤‚íöğ®[$bõÊªÎÃÅ†[196]] = !0; if (empty($Eî¡ˆ íƒâ)) { $B£çØõ‹ƒ = $this->objectMeta($FÚºŠÄó°î); if (!$B£çØõ‹ƒ) { return $b½¤‚íöğ®; } $Eî¡ˆ íƒâ = array($bõÊªÎÃÅ†[84] => strtotime($B£çØõ‹ƒ[$bõÊªÎÃÅ†[1309]]), $bõÊªÎÃÅ†[78] => $B£çØõ‹ƒ[$bõÊªÎÃÅ†[1308]] + 0); } goto A¯‡°ø°‡¸; E¿÷íÓˆó¬: } private function folderInfo($dãŠĞÔâ»Ö, $AÛæàŠ‡Ù½ = false, $bç¼š‚…æÊ = array()) { goto DÎÅªÇä×¾; DÎÅªÇä×¾: $FË•ÌùšÜ =& $_SERVER[©äõ½¡]; $dÏãºÖÓ©Ğ = array($FË•ÌùšÜ[28] => $this->pathThis($dãŠĞÔâ»Ö), $FË•ÌùšÜ[76] => $this->getPathOuter($FË•ÌùšÜ[8] . $dãŠĞÔâ»Ö), $FË•ÌùšÜ[29] => $FË•ÌùšÜ[77]); if ($AÛæàŠ‡Ù½) { return $dÏãºÖÓ©Ğ; } goto déä×´è„¾; a‰øİ÷µŒ…: if (isset($bç¼š‚…æÊ[$FË•ÌùšÜ[84]])) { $dÏãºÖÓ©Ğ[$FË•ÌùšÜ[84]] = $bç¼š‚…æÊ[$FË•ÌùšÜ[84]]; } if (isset($bç¼š‚…æÊ[$FË•ÌùšÜ[194]])) { $dÏãºÖÓ©Ğ[$FË•ÌùšÜ[194]] = $bç¼š‚…æÊ[$FË•ÌùšÜ[194]]; } return $dÏãºÖÓ©Ğ; goto AÑ¦ÙöÀÆ×; déä×´è„¾: $dÏãºÖÓ©Ğ[$FË•ÌùšÜ[194]] = $dÏãºÖÓ©Ğ[$FË•ÌùšÜ[84]] = 0; $dÏãºÖÓ©Ğ[$FË•ÌùšÜ[195]] = $dÏãºÖÓ©Ğ[$FË•ÌùšÜ[196]] = !0; if (empty($bç¼š‚…æÊ)) { $dãŠĞÔâ»Ö = rtrim($dãŠĞÔâ»Ö, $FË•ÌùšÜ[8]) . $FË•ÌùšÜ[8]; $e¤Ò¾†¤íâ = $this->objectMeta($dãŠĞÔâ»Ö); if (!$e¤Ò¾†¤íâ) { return $dÏãºÖÓ©Ğ; } $bç¼š‚…æÊ = array($FË•ÌùšÜ[194] => $e¤Ò¾†¤íâ[$FË•ÌùšÜ[505]][$FË•ÌùšÜ[1316]], $FË•ÌùšÜ[84] => strtotime($e¤Ò¾†¤íâ[$FË•ÌùšÜ[1309]])); } goto a‰øİ÷µŒ…; AÑ¦ÙöÀÆ×: } public function listPath($döÚÈÖ×åˆ, $Eä¾ƒ¬¿Â˜ = false) { $eÀ›œÜ‚»Á =& $_SERVER[©äõ½¡]; $a½¢‘Ò–¡ø = $this->fileList($döÚÈÖ×åˆ, $eÀ›œÜ‚»Á[8], !0); foreach ($a½¢‘Ò–¡ø[$eÀ›œÜ‚»Á[75]] as $FíÔ¼£Ú…Ğ => $A™çÈÖ©˜) { $a½¢‘Ò–¡ø[$eÀ›œÜ‚»Á[75]][$FíÔ¼£Ú…Ğ] = $this->folderInfo($A™çÈÖ©˜, $Eä¾ƒ¬¿Â˜, $A™çÈÖ©˜); } foreach ($a½¢‘Ò–¡ø[$eÀ›œÜ‚»Á[74]] as $FíÔ¼£Ú…Ğ => $A™çÈÖ©˜) { $a½¢‘Ò–¡ø[$eÀ›œÜ‚»Á[74]][$FíÔ¼£Ú…Ğ] = $this->fileInfo($A™çÈÖ©˜[$eÀ›œÜ‚»Á[28]], $Eä¾ƒ¬¿Â˜, $A™çÈÖ©˜); } return $a½¢‘Ò–¡ø; } public function has($Cƒ¹š‚Ù, $Fï§Ò‡“º® = false, $e“ ¨Áíñ = true) { goto C£•’ŠÜ§„; DÓÀ‚ÓĞé: $E¨‘«²äÇ£ = $Aèä¥²ùë[33]; $e’õí¯¦‘Í = 500; $D—êÅÙ·ó„ = $eŠÍİÚø¨Ù = 0; goto B“àªÍ¨ÖÍ; C£•’ŠÜ§„: $Aèä¥²ùë =& $_SERVER[©äõ½¡]; $Cƒ¹š‚Ù = trim($Cƒ¹š‚Ù, $Aèä¥²ùë[8]); $FÇ°Â¥Í¥Š = empty($Cƒ¹š‚Ù) && $Cƒ¹š‚Ù !== $Aèä¥²ùë[191] ? $Aèä¥²ùë[33] : $Cƒ¹š‚Ù . $Aèä¥²ùë[8]; goto DÓÀ‚ÓĞé; B“àªÍ¨ÖÍ: while (!0) { check_abort(); $c»ÅØ„ÃÂ = array($Aèä¥²ùë[1304] => $Aèä¥²ùë[8], $Aèä¥²ùë[1305] => $FÇ°Â¥Í¥Š, $Aèä¥²ùë[1306] => $e’õí¯¦‘Í, $Aèä¥²ùë[1307] => $E¨‘«²äÇ£); try { $FËóøÊè¯½ = $this->client->listObjects($this->bucket, $c»ÅØ„ÃÂ); } catch (OSS\Core\OssException $eœ¾å”é) { break; } $E¨‘«²äÇ£ = $FËóøÊè¯½->getNextMarker(); $cë¥Ö”öëæ = $FËóøÊè¯½->getObjectList(); $eİ¡ÄŒ÷À = $FËóøÊè¯½->getPrefixList(); if ($Fï§Ò‡“º®) { if (count($cë¥Ö”öëæ) > 1 || count($cë¥Ö”öëæ) == 1 && $cë¥Ö”öëæ[0]->getKey() != $FÇ°Â¥Í¥Š) { $D—êÅÙ·ó„ += count($cë¥Ö”öëæ) - 1; } if (!empty($eİ¡ÄŒ÷À)) { $eŠÍİÚø¨Ù += count($eİ¡ÄŒ÷À); } if ($E¨‘«²äÇ£ === $Aèä¥²ùë[33]) { break; } continue; } if ($e“ ¨Áíñ) { if (!empty($cë¥Ö”öëæ)) { if (count($cë¥Ö”öëæ) > 1 || $cë¥Ö”öëæ[0]->getKey() != $FÇ°Â¥Í¥Š) { return !0; } } } else { if (!empty($eİ¡ÄŒ÷À)) { return !0; } } if ($E¨‘«²äÇ£ === $Aèä¥²ùë[33]) { break; } } if ($Fï§Ò‡“º®) { return array($Aèä¥²ùë[203] => $D—êÅÙ·ó„, $Aèä¥²ùë[204] => $eŠÍİÚø¨Ù); } return !1; goto fÏ÷ä•æˆ¶; fÏ÷ä•æˆ¶: } public function listAll($dÔÆâùßŞ) { $C¦¥ÂŠÀ†ä =& $_SERVER[©äõ½¡]; $D‡ĞøŞ—­ = $this->fileList($dÔÆâùßŞ, $C¦¥ÂŠÀ†ä[33], !0); $Aº‡¿§ = array(); foreach ($D‡ĞøŞ—­[$C¦¥ÂŠÀ†ä[74]] as $d’™£ìÂ¯´) { $Aº‡¿§[$d’™£ìÂ¯´[$C¦¥ÂŠÀ†ä[28]]] = $d’™£ìÂ¯´[$C¦¥ÂŠÀ†ä[78]]; } foreach ($D‡ĞøŞ—­[$C¦¥ÂŠÀ†ä[75]] as $d’™£ìÂ¯´) { if (is_string($d’™£ìÂ¯´)) { $Aº‡¿§[$d’™£ìÂ¯´] = 0; } } return $this->listAllFiles($dÔÆâùßŞ, array_keys($Aº‡¿§), $Aº‡¿§); } public function canRead($dµ¾¿—­ìÍ) { $b¸×–èÔ¡Œ =& $_SERVER[©äõ½¡]; $d—²ˆ•ØÌ = $this->pathAcl($dµ¾¿—­ìÍ); return $d—²ˆ•ØÌ == $b¸×–èÔ¡Œ[1317] || $d—²ˆ•ØÌ == $b¸×–èÔ¡Œ[544] ? !0 : !1; } public function canWrite($b¦ñªÖ™à¶) { $FªåæóØà  = $this->pathAcl($b¦ñªÖ™à¶); return $FªåæóØà  == $_SERVER[©äõ½¡][544] ? !0 : !1; } public function pathAcl($B²Ö‘ê«¿Š) { goto e’İîÅÊç–; FŒí…˜ÅÉ¾: $C±Õ™¤ñ‡ = $B£ƒ–æê¸ == $d—°ˆŠ—ö[34] ? $this->bucketAcl : $B£ƒ–æê¸; if ($C±Õ™¤ñ‡ == $d—°ˆŠ—ö[1318]) { return $d—°ˆŠ—ö[1317]; } if ($C±Õ™¤ñ‡ == $d—°ˆŠ—ö[1319]) { return $d—°ˆŠ—ö[544]; } goto Cç„˜«ª˜²; Cç„˜«ª˜²: return $C±Õ™¤ñ‡; goto e‰Ğ¥ò¯; e’İîÅÊç–: $d—°ˆŠ—ö =& $_SERVER[©äõ½¡]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $B£ƒ–æê¸ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($B²Ö‘ê«¿Š)); } catch (OSS\Core\OssException $FÕßé²“¥È) { return !1; } goto FŒí…˜ÅÉ¾; e‰Ğ¥ò¯: } private function chmodPath($c¹±âàŸµ, $DÉŒÈ×«ŸÅ = '') { $F”‚æ†Í =& $_SERVER[©äõ½¡]; $F¨¯Æ…¯÷„ = empty($DÉŒÈ×«ŸÅ) ? $F”‚æ†Í[1319] : $DÉŒÈ×«ŸÅ; $A“Ëëßç„Ú = array($F”‚æ†Í[34], $F”‚æ†Í[192], $F”‚æ†Í[1318], $F”‚æ†Í[1319]); if (!in_array($F¨¯Æ…¯÷„, $A“Ëëßç„Ú)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($c¹±âàŸµ), $F¨¯Æ…¯÷„); } catch (OSS\Core\OssException $f×‚õ•†Œê) { return !1; } return !0; } public function getContent($CÓÓ­¹‰ãª) { return $this->fileSubstr($CÓÓ­¹‰ãª, -1); } public function setContent($a¨»»‡¾¡, $FÊ ËÈ¤Ï = '') { $cÈ„¼Ù¾¶• =& $_SERVER[©äõ½¡]; try { $eÌ®ˆ˜­ò = $this->trafficLimit($cÈ„¼Ù¾¶•[1320]); $f‰§‡§Û‹ = $this->client->putObject($this->bucket, $this->pathEncode($a¨»»‡¾¡), $FÊ ËÈ¤Ï, $eÌ®ˆ˜­ò); } catch (OSS\Core\OssException $d¹ïÆî˜¼) { return !1; } $BÂçìùô‘† = array($cÈ„¼Ù¾¶•[1310] => trim($f‰§‡§Û‹[$cÈ„¼Ù¾¶•[1321]], $cÈ„¼Ù¾¶•[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($a¨»»‡¾¡))); $this->updateObjMeta($a¨»»‡¾¡, $BÂçìùô‘†); return isset($f‰§‡§Û‹[$cÈ„¼Ù¾¶•[1322]][$cÈ„¼Ù¾¶•[1269]]) ? !0 : !1; } private function updateObjMeta($bŒ´È«Ôìµ, $aáÖ¡òä‘æ) { $bŒ´È«Ôìµ = $this->pathEncode($bŒ´È«Ôìµ); try { $E–ì•Ûš = array(OSS\OssClient::OSS_HEADERS => $aáÖ¡òä‘æ); $this->client->copyObject($this->bucket, $bŒ´È«Ôìµ, $this->bucket, $bŒ´È«Ôìµ, $E–ì•Ûš); } catch (OSS\Core\OssException $D²¦³‡Ë“¸) { return !1; } return !0; } public function upload($EÎÌíîÃˆÌ, $B´–‚ĞŞ°, $D›•¯Ñ¡² = false, $AÌ‹‹Âáˆì = REPEAT_REPLACE) { $CÓÙïî˜·Ç =& $_SERVER[©äõ½¡]; $A¦Àšø = trim($EÎÌíîÃˆÌ, $CÓÙïî˜·Ç[8]); $aï…ì¬¤À = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($CÓÙïî˜·Ç[1310] => @md5_file($B´–‚ĞŞ°)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($EÎÌíîÃˆÌ))); $aï…ì¬¤À = $this->trafficLimit($CÓÙïî˜·Ç[1320], $aï…ì¬¤À); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($A¦Àšø), $B´–‚ĞŞ°, $aï…ì¬¤À); } catch (OSS\Core\OssException $dºõÓ´Ûµ) { return !1; } return $this->getPathOuter($EÎÌíîÃˆÌ); } public function getHost() { $a’´´ìĞ‹ =& $_SERVER[©äõ½¡]; $cÉÔ÷ˆªˆÇ = explode($a’´´ìĞ‹[177], parent::getHost()); return $cÉÔ÷ˆªˆÇ[0] . $a’´´ìĞ‹[177] . $this->bucket . $a’´´ìĞ‹[95] . $cÉÔ÷ˆªˆÇ[1]; } public function uploadFormData($Cêõõ™£Ì, $CÄ­µ·ù– = 3600) { goto A¡¼º¾É‹æ; b¥·ö½‚Í: $a°ä®¼Ñ = $this->pathFather($Cêõõ™£Ì); $BäÖïæÉÖè = array($AÚ›àÙ…£·[1224] => $AĞù¡»Åå, $AÚ›àÙ…£·[1225] => array(array($AÚ›àÙ…£·[1325], 0, $BÚæêáŒÒ‘), array($AÚ›àÙ…£·[1228], $AÚ›àÙ…£·[1229], $a°ä®¼Ñ))); $eÑâª…¥‰ª = base64_encode(json_encode($BäÖïæÉÖè)); goto d¥ó¬Ûè“; d¥ó¬Ûè“: $C‰êøä®ø« = base64_encode(hash_hmac($AÚ›àÙ…£·[230], $eÑâª…¥‰ª, $this->secret, !0)); $aÄà•¿„…´ = array($AÚ›àÙ…£·[1234] => $eÑâª…¥‰ª, $AÚ›àÙ…£·[1326] => $this->accessKey, $AÚ›àÙ…£·[1230] => $AÚ›àÙ…£·[1222], $AÚ›àÙ…£·[1327] => $C‰êøä®ø«, $AÚ›àÙ…£·[175] => $AëïÙÌÙ‰Ù); $aÄà•¿„…´ = $this->trafficLimit($AÚ›àÙ…£·[1320], $aÄà•¿„…´); goto FíÈ¶È¯·; A¡¼º¾É‹æ: $AÚ›àÙ…£· =& $_SERVER[©äõ½¡]; if (!($AëïÙÌÙ‰Ù = $this->getHost())) { return !1; } $EÈĞğôœ×° = $CÄ­µ·ù–; goto eé¦¿†¯; FíÈ¶È¯·: return $aÄà•¿„…´; goto FŒ÷Š¿Îñª; eé¦¿†¯: $BçŸêç‚¾Ä = date($AÚ›àÙ…£·[1323], time() + $EÈĞğôœ×°); $dÄÜÁÛÓ˜… = new DateTime($BçŸêç‚¾Ä); $AĞù¡»Åå = $dÄÜÁÛÓ˜…->format(DateTime::ISO8601); goto D‚Ô”‚ó£¥; D‚Ô”‚ó£¥: $EÖ«ˆÃ´×Û = strpos($AĞù¡»Åå, $AÚ›àÙ…£·[294]); $AĞù¡»Åå = substr($AĞù¡»Åå, 0, $EÖ«ˆÃ´×Û) . $AÚ›àÙ…£·[1324]; $BÚæêáŒÒ‘ = 1048576000 * 5; goto b¥·ö½‚Í; FŒ÷Š¿Îñª: } public function multiUploadFormData($F­›‡ìÊÁ‡, $a´¡ÜÚâ„Å = 3600) { $f‰ŒÇ¢õ±Ş =& $_SERVER[©äõ½¡]; if (!($EƒßáĞ‘ßÎ = $this->getHost())) { return !1; } $eÊêØ±´ä‹ = $this->trafficLimit($f‰ŒÇ¢õ±Ş[1320]); $e¹ã†¬†÷è = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($F­›‡ìÊÁ‡), $eÊêØ±´ä‹); return array($f‰ŒÇ¢õ±Ş[221] => $e¹ã†¬†÷è, $f‰ŒÇ¢õ±Ş[175] => $EƒßáĞ‘ßÎ . $f‰ŒÇ¢õ±Ş[8] . $this->pathEncode($F­›‡ìÊÁ‡), $f‰ŒÇ¢õ±Ş[222] => gmdate($f‰ŒÇ¢õ±Ş[1328]), $f‰ŒÇ¢õ±Ş[93] => $F­›‡ìÊÁ‡); } public function multiUploadAuthData($aÜ¤¹Äšö½, $dñ¶‡ƒÔËØ = array()) { goto E“ß¯®¢î; E“ß¯®¢î: $b‰——í»Ã“ =& $_SERVER[©äõ½¡]; $c•“Ú²ğó = isset($dñ¶‡ƒÔËØ[$b‰——í»Ã“[222]]) ? $dñ¶‡ƒÔËØ[$b‰——í»Ã“[222]] : gmdate($b‰——í»Ã“[1328]); $fÃ™Ç‰ÄÔÕ = isset($dñ¶‡ƒÔËØ[$b‰——í»Ã“[168]]) ? $dñ¶‡ƒÔËØ[$b‰——í»Ã“[168]] : $b‰——í»Ã“[33]; goto e¤£ËÃÀ¥Ç; eÖ…¥ÑçßÛ: $B°œÛ·¯‚ = $b‰——í»Ã“[1294] . $this->accessKey . $b‰——í»Ã“[4] . $eİÁ®øà½‘; if (strpos($fÃ™Ç‰ÄÔÕ, $b‰——í»Ã“[225]) === 0) { $B°œÛ·¯‚ = array($b‰——í»Ã“[232] => $B°œÛ·¯‚, $b‰——í»Ã“[222] => $c•“Ú²ğó); if ($E÷£”İ÷’æ) { $B°œÛ·¯‚ = array_merge($B°œÛ·¯‚, $E÷£”İ÷’æ); } } return $B°œÛ·¯‚; goto A“Ø““ê×; C§®áÅÃË: $b¿£ƒ­¦‰« = array($b‰——í»Ã“[224], $b‰——í»Ã“[33], $b‰——í»Ã“[119], $c•“Ú²ğó, "\170\x2d\x6f\163\x73\x2d\144\x61\164\x65\x3a{$c•“Ú²ğó}", $b‰——í»Ã“[8] . $this->bucket . $b‰——í»Ã“[8] . $c¹‹¡ä†‰ . $fÃ™Ç‰ÄÔÕ); if (strpos($fÃ™Ç‰ÄÔÕ, $b‰——í»Ã“[225]) === 0) { $b¿£ƒ­¦‰«[0] = $b‰——í»Ã“[226]; if ($E÷£”İ÷’æ = $this->trafficLimit($b‰——í»Ã“[1320])) { $c¹‹¡ä†‰ = $b‰——í»Ã“[1329]; array_splice($b¿£ƒ­¦‰«, 5, 0, $c¹‹¡ä†‰ . $b‰——í»Ã“[4] . $E÷£”İ÷’æ[$c¹‹¡ä†‰]); } } if (isset($dñ¶‡ƒÔËØ[$b‰——í»Ã“[227]]) && $dñ¶‡ƒÔËØ[$b‰——í»Ã“[227]] == $b‰——í»Ã“[228]) { $b¿£ƒ­¦‰«[0] = $b‰——í»Ã“[228]; } goto b«š±Šº®; b«š±Šº®: if (!empty($dñ¶‡ƒÔËØ[$b‰——í»Ã“[1330]])) { $BˆÇœ§Ÿ‰Ï = array_merge(array($b¿£ƒ­¦‰«[4]), $dñ¶‡ƒÔËØ[$b‰——í»Ã“[1330]]); sort($BˆÇœ§Ÿ‰Ï); $b¿£ƒ­¦‰«[4] = implode($b‰——í»Ã“[229], $BˆÇœ§Ÿ‰Ï); } $DÙÒ„‰§»¯ = implode($b‰——í»Ã“[229], $b¿£ƒ­¦‰«); $eİÁ®øà½‘ = base64_encode(hash_hmac($b‰——í»Ã“[230], $DÙÒ„‰§»¯, $this->secret, !0)); goto eÖ…¥ÑçßÛ; e¤£ËÃÀ¥Ç: $c¹‹¡ä†‰ = $aÜ¤¹Äšö½; if (isset($dñ¶‡ƒÔËØ[$b‰——í»Ã“[93]])) { $c¹‹¡ä†‰ = $dñ¶‡ƒÔËØ[$b‰——í»Ã“[93]]; unset($dñ¶‡ƒÔËØ[$b‰——í»Ã“[93]]); } if (isset($dñ¶‡ƒÔËØ[$b‰——í»Ã“[223]])) { $dñ¶‡ƒÔËØ[$b‰——í»Ã“[222]] = $c•“Ú²ğó; return $this->listUploadParts($c¹‹¡ä†‰, $dñ¶‡ƒÔËØ); } goto C§®áÅÃË; A“Ø““ê×: } public function listUploadParts($b–ç‚¾Ã¢Ú, $cĞÏšŒ–½) { goto dÉ–Œâ”; aÀ­ÍñÀ™ê: $e†“‘¤éà = $Dî¦øÜĞ´->getListPart(); $cœÂæ…©Ëœ = array(); foreach ($e†“‘¤éà as $dèÆëÔçÁ) { $cœÂæ…©Ëœ[] = array($B÷ªÂö†Ø‹[1314] => $dèÆëÔçÁ->getPartNumber(), $B÷ªÂö†Ø‹[1315] => trim($dèÆëÔçÁ->getETag(), $B÷ªÂö†Ø‹[116])); } goto Fµ”ËªéÂ; Fµ”ËªéÂ: unset($cĞÏšŒ–½[$B÷ªÂö†Ø‹[223]], $cĞÏšŒ–½[$B÷ªÂö†Ø‹[227]]); $d Ë¼ò‹ƒÜ = $this->multiUploadAuthData($b–ç‚¾Ã¢Ú, $cĞÏšŒ–½); if (empty($d Ë¼ò‹ƒÜ)) { return !1; } goto aØ¶Í–×«ˆ; aØ¶Í–×«ˆ: return array($B÷ªÂö†Ø‹[232] => $d Ë¼ò‹ƒÜ, $B÷ªÂö†Ø‹[222] => $cĞÏšŒ–½[$B÷ªÂö†Ø‹[222]], $B÷ªÂö†Ø‹[234] => $cœÂæ…©Ëœ); goto E¢§Ş©İ®ó; dÉ–Œâ”: $B÷ªÂö†Ø‹ =& $_SERVER[©äõ½¡]; $e÷¯Á¡«Ÿ† = parse_url_query($cĞÏšŒ–½[$B÷ªÂö†Ø‹[168]]); $Dî¦øÜĞ´ = $this->client->listParts($this->bucket, $this->pathEncode($b–ç‚¾Ã¢Ú), $e÷¯Á¡«Ÿ†[$B÷ªÂö†Ø‹[221]]); goto aÀ­ÍñÀ™ê; E¢§Ş©İ®ó: } public function download($F¢åçôæáñ, $a£Ü¢É¼Œã) { if ($this->isFolder($F¢åçôæáñ)) { return !1; } try { $f½º½¦ö“© = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $a£Ü¢É¼Œã); $f½º½¦ö“© = $this->trafficLimit($_SERVER[©äõ½¡][109], $f½º½¦ö“©); $this->client->getObject($this->bucket, $this->pathEncode($F¢åçôæáñ), $f½º½¦ö“©); } catch (OSS\Core\OssException $D¢›Ÿ’Îƒ) { return !1; } return $a£Ü¢É¼Œã; } public function fileSubstr($c˜ùÁÕ†©ã, $cÆäïÈ§à» = 0, $eÙÚ†î¿Ü = false) { if ($cÆäïÈ§à» === -1) { $C¬šÏÄ£í = array(); } else { if ($eÙÚ†î¿Ü === !1) { $Eê†‘µÔ’ö = $this->size($c˜ùÁÕ†©ã); } else { $Eê†‘µÔ’ö = $cÆäïÈ§à» + $eÙÚ†î¿Ü - 1; } $C¬šÏÄ£í = array(OSS\OssClient::OSS_RANGE => "{$cÆäïÈ§à»}\55{$Eê†‘µÔ’ö}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($c˜ùÁÕ†©ã), $C¬šÏÄ£í); } catch (OSS\Core\OssException $a¨¯‡ÅçÑ¬) { think_exception($a¨¯‡ÅçÑ¬->getMessage()); return !1; } } private function trafficLimit($DíäŒá¢¥Ş, $Cç¶ğ”’İ¦ = array()) { goto B‹„••Àª; AÇ¿æÈ¤…: if (!$d´ÄØ«ºÙà) { return $Cç¶ğ”’İ¦; } $d´ÄØ«ºÙà = $d´ÄØ«ºÙà < 819200 ? 819200 : ($d´ÄØ«ºÙà > 838860800 ? 838860800 : $d´ÄØ«ºÙà); $Cç¶ğ”’İ¦[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($d´ÄØ«ºÙà); goto f¿©‰åœĞõ; f¿©‰åœĞõ: return $Cç¶ğ”’İ¦; goto E­§åİò‘; B‹„••Àª: $C¥•³ˆÅ…Ñ =& $_SERVER[©äõ½¡]; if ($DíäŒá¢¥Ş == $C¥•³ˆÅ…Ñ[1320] && $this->isUploadServer() || $DíäŒá¢¥Ş == $C¥•³ˆÅ…Ñ[109] && $this->isFileOutServer()) { return $Cç¶ğ”’İ¦; } $d´ÄØ«ºÙà = floatval($GLOBALS[$C¥•³ˆÅ…Ñ[6]][$C¥•³ˆÅ…Ñ[88]][$C¥•³ˆÅ…Ñ[107]][$DíäŒá¢¥Ş]) * 1024 * 1024 * 8; goto AÇ¿æÈ¤…; E­§åİò‘: } public function link($b½ŒªÔè“, $e¶éëÙ¼¿ = array()) { $d÷›ëÏ‰¡ =& $_SERVER[©äõ½¡]; if (!$this->exist($b½ŒªÔè“) || $this->isFolder($b½ŒªÔè“)) { return !1; } try { $e¶éëÙ¼¿ = $this->trafficLimit($d÷›ëÏ‰¡[109], $e¶éëÙ¼¿); $D¨»×‡´ƒì = $this->client->signUrl($this->bucket, $this->pathEncode($b½ŒªÔè“), 3600 * 12, $d÷›ëÏ‰¡[228], $e¶éëÙ¼¿); return $this->getCdnLink($D¨»×‡´ƒì); } catch (OSS\Core\OssException $féè¡Ğ—÷ç) { return !1; } } public function fileOut($bä¸³„ó‰, $aÇªöí‹ö© = false, $fîÈİ‡è÷ñ = false, $bœõâ³¬ãç = '') { goto A·ö¡¦³¯‹; cßÂ‰†‚Á : $fîÈİ‡è÷ñ = rawurlencode($fîÈİ‡è÷ñ); $D‡†ãÁšˆ = get_file_mime(get_path_ext($fîÈİ‡è÷ñ)); if ($D‡†ãÁšˆ == $b¶¦Ó Ô½ñ[213]) { return parent::fileOut($bä¸³„ó‰, $aÇªöí‹ö©, $fîÈİ‡è÷ñ, $bœõâ³¬ãç); } goto A¿»¶é‡‰; A¯÷‹×¶˜¥: $C’ËÏì²‰Õ = $this->link($bä¸³„ó‰, $cÇƒë²§‘¾); $this->fileOutLink($C’ËÏì²‰Õ); goto EˆÂêœ‰ä; A¿»¶é‡‰: $aÇªöí‹ö© = $aÇªöí‹ö© ? $b¶¦Ó Ô½ñ[214] : $b¶¦Ó Ô½ñ[215]; $cÇƒë²§‘¾ = array(OSS\OssClient::OSS_SUB_RESOURCE => $b¶¦Ó Ô½ñ[1331] . rawurlencode("{$aÇªöí‹ö©}\x3b\146\151\154\145\156\141\155\x65\75{$fîÈİ‡è÷ñ}")); $cÇƒë²§‘¾[OSS\OssClient::OSS_SUB_RESOURCE] .= $b¶¦Ó Ô½ñ[1332] . rawurlencode($D‡†ãÁšˆ); goto A¯÷‹×¶˜¥; A·ö¡¦³¯‹: $b¶¦Ó Ô½ñ =& $_SERVER[©äõ½¡]; if ($this->isFileOutServer()) { return $this->fileOutServer($bä¸³„ó‰, $aÇªöí‹ö©, $fîÈİ‡è÷ñ, $bœõâ³¬ãç); } if (!$fîÈİ‡è÷ñ) { $fîÈİ‡è÷ñ = $this->pathThis($bä¸³„ó‰); } goto cßÂ‰†‚Á ; EˆÂêœ‰ä: } public function fileOutServer($EÇ–áí³š, $c­àµ×„ = false, $b·²Ë¦˜¤• = false, $Bõ¤µ¼Œ¤é = '') { parent::fileOut($EÇ–áí³š, $c­àµ×„, $b·²Ë¦˜¤•, $Bõ¤µ¼Œ¤é); } public function fileOutImage($b·ëÁê¯‰, $F‚‡—Œ„ = 250) { $c¿®•ÍÀŞ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[©äõ½¡][1333] . $F‚‡—Œ„); $bÍÒ¬ïçšÍ = $this->link($b·ëÁê¯‰, $c¿®•ÍÀŞ); $this->fileOutLink($bÍÒ¬ïçšÍ); } public function fileOutImageServer($e©Óö¦Õğ‚, $f©¦»ÄÔãŠ = 250) { parent::fileOutImage($e©Óö¦Õğ‚, $f©¦»ÄÔãŠ); } public function fileOutLink($b¸‘ë‘§šø) { $e‚Û·İ³´ =& $_SERVER[©äõ½¡]; if (!$this->isCdnHost() && substr($b¸‘ë‘§šø, 0, 7) == $e‚Û·İ³´[1237]) { $b¸‘ë‘§šø = $e‚Û·İ³´[1238] . substr($b¸‘ë‘§šø, 7); } header($e‚Û·İ³´[159] . $b¸‘ë‘§šø); die; } public function hashMd5($CàåŞßÖ§¨, $EÉäå¤Á¢ = '') { $FŒÑõ¬×Ñ =& $_SERVER[©äõ½¡]; $f¶–ÏĞÅŠ¥ = $this->_objectMeta($CàåŞßÖ§¨); if (!$f¶–ÏĞÅŠ¥) { return $FŒÑõ¬×Ñ[33]; } if (!isset($f¶–ÏĞÅŠ¥[$FŒÑõ¬×Ñ[1310]]) && !empty($EÉäå¤Á¢)) { $Aª‚®¹÷¡‰ = $this->updateObjMeta($CàåŞßÖ§¨, array($FŒÑõ¬×Ñ[1310] => $EÉäå¤Á¢)); $f¶–ÏĞÅŠ¥[$FŒÑõ¬×Ñ[1310]] = $Aª‚®¹÷¡‰ ? $EÉäå¤Á¢ : $FŒÑõ¬×Ñ[33]; } return isset($f¶–ÏĞÅŠ¥[$FŒÑõ¬×Ñ[1310]]) ? strtolower($f¶–ÏĞÅŠ¥[$FŒÑõ¬×Ñ[1310]]) : $FŒÑõ¬×Ñ[33]; } public function size($d¹Â¦¢‡ŠÏ) { $EºÙ¿­ù¢† = $this->objectMeta($d¹Â¦¢‡ŠÏ); return $EºÙ¿­ù¢† ? $EºÙ¿­ù¢†[$_SERVER[©äõ½¡][78]] : 0; } public function info($AÙ“¯àö™) { if ($this->isFolder($AÙ“¯àö™)) { return $this->folderInfo($AÙ“¯àö™); } else { if ($this->isFile($AÙ“¯àö™)) { return $this->fileInfo($AÙ“¯àö™); } } return !1; } public function exist($EŒ·ÑÊÚõ) { return $this->isFile($EŒ·ÑÊÚõ) || $this->isFolder($EŒ·ÑÊÚõ); } public function isFile($dåšµÇ´ƒ…) { return !$this->isFolder($dåšµÇ´ƒ…) && $this->objectMeta($dåšµÇ´ƒ…); } public function isFolder($a¥ÚÒ™Ú‡Å) { return $this->cacheMethod($_SERVER[©äõ½¡][199], $a¥ÚÒ™Ú‡Å); } protected function objectMeta($d“¬Ôˆë›) { return $this->cacheMethod($_SERVER[©äõ½¡][200], $d“¬Ôˆë›); } protected function _objectMeta($cÍïô«Ò—Õ) { $bÃÄ†·İ =& $_SERVER[©äõ½¡]; try { $eµ½×Â—¡‡ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($cÍïô«Ò—Õ)); } catch (OSS\Core\OssException $FĞÖ×¦´ù¿) { $eµ½×Â—¡‡ = !1; } if ($eµ½×Â—¡‡) { $eµ½×Â—¡‡[$bÃÄ†·İ[78]] = intval($eµ½×Â—¡‡[$bÃÄ†·İ[1308]]); } return $eµ½×Â—¡‡; } protected function _isFolder($báÚ¾æÇŞ) { $A–ñğÚ¬Êİ =& $_SERVER[©äõ½¡]; if ($báÚ¾æÇŞ == $A–ñğÚ¬Êİ[33] || $báÚ¾æÇŞ == $A–ñğÚ¬Êİ[8]) { return !0; } $A„à˜ñ¸« = array($A–ñğÚ¬Êİ[1304] => $A–ñğÚ¬Êİ[8], $A–ñğÚ¬Êİ[1305] => rtrim($báÚ¾æÇŞ, $A–ñğÚ¬Êİ[8]) . $A–ñğÚ¬Êİ[8], $A–ñğÚ¬Êİ[1306] => 1, $A–ñğÚ¬Êİ[1307] => $A–ñğÚ¬Êİ[33]); $c‘‚ â†„Ÿ = $this->client->listObjects($this->bucket, $A„à˜ñ¸«); if ($c‘‚ â†„Ÿ->getObjectList() || $c‘‚ â†„Ÿ->getPrefixList()) { return !0; } return !1; } } goto C÷§ù¸áâÖ; b¯¹Ê¨ìÖ˜: class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\x2e\x73\164\157\162\x61\x67\145\x4c\x69\x73\x74"; public $field = array("\156\141\x6d\145", "\163\x69\x7a\145\115\141\x78", "\163\171\x73\164\x65\155", "\x64\145\x66\141\x75\154\x74", "\144\x72\151\166\145\162", "\x63\157\x6e\146\151\147"); public function listData($dñï‡ª›± = false, $bƒ‚éƒ×¨× = "\x6d\x6f\x64\151\x66\171\124\151\x6d\x65", $b×œÄÕ“â• = false) { $C äÉÔ‹çƒ =& $_SERVER[©äõ½¡]; $Eî“¢­õÊÇ = parent::listData($dñï‡ª›±, $bƒ‚éƒ×¨×, $b×œÄÕ“â•); if ($dñï‡ª›±) { return $Eî“¢­õÊÇ; } $dƒ…ÅºãĞ¡ = $this->ioSizeUseGet(array_to_keyvalue($Eî“¢­õÊÇ, $C äÉÔ‹çƒ[33], $C äÉÔ‹çƒ[395])); foreach ($Eî“¢­õÊÇ as $F§µÆÇ­‚ï => $a‰Ñ‚¬“ùÙ) { unset($Eî“¢­õÊÇ[$F§µÆÇ­‚ï][$C äÉÔ‹çƒ[6]]); $Eî“¢­õÊÇ[$F§µÆÇ­‚ï][$C äÉÔ‹çƒ[1719]] = isset($dƒ…ÅºãĞ¡[$a‰Ñ‚¬“ùÙ[$C äÉÔ‹çƒ[395]]]) ? $dƒ…ÅºãĞ¡[$a‰Ñ‚¬“ùÙ[$C äÉÔ‹çƒ[395]]] : 0; } return $Eî“¢­õÊÇ; } public function ioSizeUseGet($aäºò˜”­¹) { goto c³”ùá‡â; b÷Ûâ«‰˜: $d ÑÇóëáÌ = Cache::get($F®¹Š…ßç); if ($d ÑÇóëáÌ) { return $d ÑÇóëáÌ; } $A¸©Á°æ´¢ = array($EÊÉº¯´…‚[819] => $EÊÉº¯´…‚[395], $EÊÉº¯´…‚[2034] => $EÊÉº¯´…‚[78]); goto DÏ®©•´ö‡; DÏ®©•´ö‡: $C—òÄŒõÛ¼ = array($EÊÉº¯´…‚[819] => array($EÊÉº¯´…‚[7], $aäºò˜”­¹)); $d ÑÇóëáÌ = Model($EÊÉº¯´…‚[782])->field($A¸©Á°æ´¢)->where($C—òÄŒõÛ¼)->group($EÊÉº¯´…‚[819])->select(); $d ÑÇóëáÌ = array_to_keyvalue($d ÑÇóëáÌ, $EÊÉº¯´…‚[395], $EÊÉº¯´…‚[78]); goto Aò’›İ¸‹; Aò’›İ¸‹: Cache::set($F®¹Š…ßç, $d ÑÇóëáÌ, 600); return $d ÑÇóëáÌ; goto Cï¤——ê‡‚; c³”ùá‡â: $EÊÉº¯´…‚ =& $_SERVER[©äõ½¡]; if (!$aäºò˜”­¹) { return array(); } $F®¹Š…ßç = $EÊÉº¯´…‚[2033] . implode($EÊÉº¯´…‚[47], $aäºò˜”­¹); goto b÷Ûâ«‰˜; Cï¤——ê‡‚: } public function getConfig($C’æóà—ŸË) { $F’±äŒ×øØ = parent::listData($C’æóà—ŸË); return json_decode($F’±äŒ×øØ[$_SERVER[©äõ½¡][6]], !0); } public function update($BŠÇË§°ù·, $c‚ÌÓİ¹¤Ô) { goto CŞÛŒà»¬¨; CŞÛŒà»¬¨: $dîÓ–œ’ÏÓ =& $_SERVER[©äõ½¡]; $EÚÔ—°é®ò = $c‚ÌÓİ¹¤Ô[$dîÓ–œ’ÏÓ[28]]; $F¡²µíŒ›ç = array_to_keyvalue(parent::listData(), $dîÓ–œ’ÏÓ[28]); goto e†¦ åÚ ; e†¦ åÚ : if (isset($F¡²µíŒ›ç[$EÚÔ—°é®ò]) && $F¡²µíŒ›ç[$EÚÔ—°é®ò][$dîÓ–œ’ÏÓ[395]] != $BŠÇË§°ù·) { return !1; } if (isset($c‚ÌÓİ¹¤Ô[$dîÓ–œ’ÏÓ[2035]]) && $c‚ÌÓİ¹¤Ô[$dîÓ–œ’ÏÓ[2035]] == $dîÓ–œ’ÏÓ[87]) { $this->checkConfig($c‚ÌÓİ¹¤Ô); } unset($c‚ÌÓİ¹¤Ô[$dîÓ–œ’ÏÓ[2035]]); goto d”ˆ£‚‚Ğ; d”ˆ£‚‚Ğ: $AÑ¡á§Ü‹Œ = parent::update($BŠÇË§°ù·, $c‚ÌÓİ¹¤Ô); if ($AÑ¡á§Ü‹Œ && $c‚ÌÓİ¹¤Ô[$dîÓ–œ’ÏÓ[34]]) { foreach ($F¡²µíŒ›ç as $b›¦‚›ÁœË) { if ($b›¦‚›ÁœË[$dîÓ–œ’ÏÓ[34]] && $b›¦‚›ÁœË[$dîÓ–œ’ÏÓ[395]] != $BŠÇË§°ù·) { parent::update($b›¦‚›ÁœË[$dîÓ–œ’ÏÓ[395]], array($dîÓ–œ’ÏÓ[34] => 0)); } } } return $AÑ¡á§Ü‹Œ; goto cÔÊ¢›„Í˜; cÔÊ¢›„Í˜: } public function add($C¢öë®ÍÙ) { goto eÎğ´‹…Øº; eåÉİÅ§çÍ: $this->checkConfig($C¢öë®ÍÙ); $C·òØ½ÍŠİ = parent::insert($C¢öë®ÍÙ); if ($C·òØ½ÍŠİ && $C¢öë®ÍÙ[$aËçê¤¾Â[34]]) { foreach ($a¯åŒ’ßæï as $e’Ô»­÷¼) { if ($e’Ô»­÷¼[$aËçê¤¾Â[34]]) { parent::update($e’Ô»­÷¼[$aËçê¤¾Â[395]], array($aËçê¤¾Â[34] => 0)); } } } goto CšÃªƒŸéì; CšÃªƒŸéì: return $C·òØ½ÍŠİ; goto c¿°Ñ‚Ë; eÎğ´‹…Øº: $aËçê¤¾Â =& $_SERVER[©äõ½¡]; $a¯åŒ’ßæï = array_to_keyvalue(parent::listData(), $aËçê¤¾Â[28]); if (isset($a¯åŒ’ßæï[$C¢öë®ÍÙ[$aËçê¤¾Â[28]]])) { return !1; } goto eåÉİÅ§çÍ; c¿°Ñ‚Ë: } public function checkConfig(&$d¼—İÆ•·ƒ, $dŠ»Ú¦ó÷ª = false) { goto A½ªÒ°É¼; bø˜“ÉƒØÎ: $Fï·œ’®èå = $CÊÃì™Ìàğ->getPath($aÚ´İäİÂ´ . $bâÒµõ™ƒ[1171]); if (!$CÊÃì™Ìàğ->mkfile($Fï·œ’®èå)) { if ($dŠ»Ú¦ó÷ª) { return LNG($bâÒµõ™ƒ[2040]); } show_json(LNG($bâÒµõ™ƒ[2040]), !1); } $Cô‰õÇˆÈÃ[$bâÒµõ™ƒ[1109]] = $aÚ´İäİÂ´; goto fÉ¨È…Òô; A½ªÒ°É¼: $bâÒµõ™ƒ =& $_SERVER[©äõ½¡]; $fí„™¡ïö = strtolower($d¼—İÆ•·ƒ[$bâÒµõ™ƒ[94]]); $Cô‰õÇˆÈÃ = json_decode($d¼—İÆ•·ƒ[$bâÒµõ™ƒ[6]], !0); goto DÀÆ„¯š¿«; BÍ›…„“Å: $D‚äšÔÁğ÷ = isset($Bí·”ç•Ôƒ[$fí„™¡ïö]) ? $Bí·”ç•Ôƒ[$fí„™¡ïö] : ucfirst($fí„™¡ïö); $bîì÷œ¤ğ¢ = $bâÒµõ™ƒ[72] . $D‚äšÔÁğ÷; if (!$D‚äšÔÁğ÷ || !class_exists($bîì÷œ¤ğ¢)) { if ($dŠ»Ú¦ó÷ª) { return LNG($bâÒµõ™ƒ[2037]); } write_log(array($bâÒµõ™ƒ[2038], $d¼—İÆ•·ƒ, get_caller_info()), $bâÒµõ™ƒ[2039]); show_json(LNG($bâÒµõ™ƒ[2037]), !1, $d¼—İÆ•·ƒ); } goto bÖŸÛƒÙ; fÉ¨È…Òô: $d¼—İÆ•·ƒ[$bâÒµõ™ƒ[6]] = json_encode($Cô‰õÇˆÈÃ); $d¼—İÆ•·ƒ[$bâÒµõ™ƒ[94]] = $D‚äšÔÁğ÷; return !0; goto bœŞƒ†¾àÑ; DÀÆ„¯š¿«: foreach ($Cô‰õÇˆÈÃ as $AÓ´‡§° => $A…ŒÅµ»•) { $Cô‰õÇˆÈÃ[$AÓ´‡§°] = trim($A…ŒÅµ»•); } $Cô‰õÇˆÈÃ[$bâÒµõ™ƒ[2036]] = rand_string(6); $Bí·”ç•Ôƒ = $GLOBALS[$bâÒµõ™ƒ[6]][$bâÒµõ™ƒ[88]][$bâÒµõ™ƒ[828]]; goto BÍ›…„“Å; bÖŸÛƒÙ: $CÊÃì™Ìàğ = new $bîì÷œ¤ğ¢($Cô‰õÇˆÈÃ); if (in_array($fí„™¡ïö, $CÊÃì™Ìàğ->objectDriver)) { if (!$CÊÃì™Ìàğ->isBucketCors() && !$CÊÃì™Ìàğ->setBucketCors()) { $a‘÷²é˜º = LNG($bâÒµõ™ƒ[2040]); $a‘÷²é˜º .= $bâÒµõ™ƒ[2041] . LNG($bâÒµõ™ƒ[2042]); if ($dŠ»Ú¦ó÷ª) { return $a‘÷²é˜º; } show_json($a‘÷²é˜º, !1); } } $aÚ´İäİÂ´ = rtrim($Cô‰õÇˆÈÃ[$bâÒµõ™ƒ[1109]], $bâÒµõ™ƒ[8]) . $bâÒµõ™ƒ[8]; goto bø˜“ÉƒØÎ; bœŞƒ†¾àÑ: } public function driverListSystem() { $DƒŒ…‹Ù³¦ =& $_SERVER[©äõ½¡]; $Cİí¥¹ãÕ = parent::listData(); $f¿‡°‚Ï = array(); foreach ($Cİí¥¹ãÕ as $a÷…É‹ŠÑ) { unset($a÷…É‹ŠÑ[$DƒŒ…‹Ù³¦[194]], $a÷…É‹ŠÑ[$DƒŒ…‹Ù³¦[84]]); $a÷…É‹ŠÑ[$DƒŒ…‹Ù³¦[6]] = json_decode($a÷…É‹ŠÑ[$DƒŒ…‹Ù³¦[6]], !0); $f¿‡°‚Ï[] = $a÷…É‹ŠÑ; } return $f¿‡°‚Ï; } public function defaultDriver() { $a¶”ê“ˆ­ =& $_SERVER[©äõ½¡]; $EòÏ±–ë…‹ = parent::listData(); $F®ˆˆ†ÛÖÜ = array_filter_by_field($EòÏ±–ë…‹, $a¶”ê“ˆ­[34], 1); $F®ˆˆ†ÛÖÜ = $F®ˆˆ†ÛÖÜ[0]; if ($F®ˆˆ†ÛÖÜ) { $F®ˆˆ†ÛÖÜ[$a¶”ê“ˆ­[6]] = json_decode($F®ˆˆ†ÛÖÜ[$a¶”ê“ˆ­[6]], !0); } return $F®ˆˆ†ÛÖÜ; } public function driverInfo($a‰ñåÉ”µ¾) { $f‹ğƒˆ¼„ñ =& $_SERVER[©äõ½¡]; $cîÂÏ¸ÅÚ‡ = array_to_keyvalue(parent::listData(), $f‹ğƒˆ¼„ñ[395]); if (!isset($cîÂÏ¸ÅÚ‡[$a‰ñåÉ”µ¾])) { return !1; } $dÎŠİÌÊªª = $cîÂÏ¸ÅÚ‡[$a‰ñåÉ”µ¾]; $dÎŠİÌÊªª[$f‹ğƒˆ¼„ñ[6]] = json_decode($dÎŠİÌÊªª[$f‹ğƒˆ¼„ñ[6]], !0); return $dÎŠİÌÊªª; } public function remove($fÍ¦©ÍµÒİ) { $this->removeShareItems($fÍ¦©ÍµÒİ); return parent::remove($fÍ¦©ÍµÒİ); } public function removeWithFile($fÚ‡ì¹ ˆ„, $aööõãèä) { goto a—Æ¿ğèøô; d„ÒµÈ‹Ñ¢: $A¢…ÏÃéÍñ = Model($FÀ¦†ïŒ†î[193])->where($fµÓÂ£æ¿)->field($FÀ¦†ïŒ†î[2045])->select(); foreach ($A¢…ÏÃéÍñ as $CÃë³„í„) { goto d°Ú«²¼¥‰; d°Ú«²¼¥‰: $aÖËˆ–Ôé = $CÃë³„í„[$FÀ¦†ïŒ†î[76]]; $BËö±äø = $f°‘¬æ¶¿ò . str_replace("\x7b\151\157\72{$fÚ‡ì¹ ˆ„}\175\x2f", $FÀ¦†ïŒ†î[33], $aÖËˆ–Ôé); if (!IO::exist($aÖËˆ–Ôé)) { $CååœÌÂ„ƒ[] = $CÃë³„í„[$FÀ¦†ïŒ†î[461]]; $A…âñØ»ñô->updateFileEnd($CÃë³„í„[$FÀ¦†ïŒ†î[28]], $CÃë³„í„[$FÀ¦†ïŒ†î[78]]); continue; } goto fİù¬ôµ¿…; fİù¬ôµ¿…: if (IO::exist($BËö±äø)) { $A…âñØ»ñô->updateFileEnd($CÃë³„í„[$FÀ¦†ïŒ†î[28]], $CÃë³„í„[$FÀ¦†ïŒ†î[78]]); continue; } if (!IO::move($aÖËˆ–Ôé, get_path_father($BËö±äø))) { $eå¢Êøé‚ = !1; break; } $fµÓÂ£æ¿ = array($FÀ¦†ïŒ†î[461] => $CÃë³„í„[$FÀ¦†ïŒ†î[461]]); goto FÆ£··ºà; FÆ£··ºà: $dÌ½‡‘ˆ†‘ = array($FÀ¦†ïŒ†î[819] => $e‹ÚÚàŒ³, $FÀ¦†ïŒ†î[76] => $BËö±äø); Model($FÀ¦†ïŒ†î[193])->where($fµÓÂ£æ¿)->save($dÌ½‡‘ˆ†‘); goto BÌ±™»È­Û; BÌ±™»È­Û: } $this->removeByFileID($CååœÌÂ„ƒ); goto aŠª™‡‹ÁÅ; FÚñ©È¼¼¬: $A…âñØ»ñô->task[$FÀ¦†ïŒ†î[758]] = (double) $b‡¼ÏïÇ; $FÖğÑ–ù» = KodIO::defaultDriver(); $e‹ÚÚàŒ³ = $FÖğÑ–ù»[$FÀ¦†ïŒ†î[395]]; goto DÌ×“çÒâå; DÌ×“çÒâå: $f°‘¬æ¶¿ò = "\173\151\157\72{$e‹ÚÚàŒ³}\175\57"; $eå¢Êøé‚ = !0; $CååœÌÂ„ƒ = array(); goto d„ÒµÈ‹Ñ¢; a—Æ¿ğèøô: $FÀ¦†ïŒ†î =& $_SERVER[©äõ½¡]; $fµÓÂ£æ¿ = array($FÀ¦†ïŒ†î[819] => $fÚ‡ì¹ ˆ„); $eùøì—ºƒ¨ = Model($FÀ¦†ïŒ†î[464])->where($fµÓÂ£æ¿)->count(); goto Eí‚ğ…ĞŠ; Eí‚ğ…ĞŠ: $b‡¼ÏïÇ = Model($FÀ¦†ïŒ†î[464])->where($fµÓÂ£æ¿)->sum($FÀ¦†ïŒ†î[78]); $f²•ÈÕñœ = $aööõãèä . $FÀ¦†ïŒ†î[2043] . $fÚ‡ì¹ ˆ„; $A…âñØ»ñô = new TaskFileTransfer($f²•ÈÕñœ, $FÀ¦†ïŒ†î[2039], $eùøì—ºƒ¨, LNG($FÀ¦†ïŒ†î[2044]) . "\50{$fÚ‡ì¹ ˆ„}\51"); goto FÚñ©È¼¼¬; aŠª™‡‹ÁÅ: if (!$eå¢Êøé‚) { $A…âñØ»ñô->stop($f²•ÈÕñœ); return !1; } $A…âñØ»ñô->end(); if ($aööõãèä == $FÀ¦†ïŒ†î[1699]) { $this->remove($fÚ‡ì¹ ˆ„); } goto f²êÕ¼…ÚÏ; f²êÕ¼…ÚÏ: } public function progress($DÆß±ìÁñ…, $dÖÇÓ§÷á©) { return Task::get($dÖÇÓ§÷á© . $_SERVER[©äõ½¡][2043] . $DÆß±ìÁñ…); } private function removeByFileID($f®«µ‘èµ = array()) { goto Dôœ»©†š„; Bªàƒ­ôº“: $F½³‚Ô¯Ú¶ = Model($BÕÏ§¦’Œæ[1239])->where($AƒÂù ğŒé)->field($BÕÏ§¦’Œæ[397])->select(); if (!$F½³‚Ô¯Ú¶) { return; } $F½³‚Ô¯Ú¶ = array_to_keyvalue($F½³‚Ô¯Ú¶, $BÕÏ§¦’Œæ[33], $BÕÏ§¦’Œæ[397]); goto CöÒÅï¹ßÜ; CöÒÅï¹ßÜ: foreach ($F½³‚Ô¯Ú¶ as $CØÓ†¨½Ú‹) { Model($BÕÏ§¦’Œæ[411])->removeNow($CØÓ†¨½Ú‹, !1); } goto cšŒ‘™”ñù; Dôœ»©†š„: $BÕÏ§¦’Œæ =& $_SERVER[©äõ½¡]; if (empty($f®«µ‘èµ)) { return; } $AƒÂù ğŒé = array($BÕÏ§¦’Œæ[461] => array($BÕÏ§¦’Œæ[7], $f®«µ‘èµ)); goto Bªàƒ­ôº“; cšŒ‘™”ñù: } private function removeShareItems($c§¦ƒœ´ââ) { goto B‡­›ÕŸ‰†; aÀÙøÈ×‘Ò: Model($cª‹©¨Ù‘„[589])->remove($C‘Ë§îÙâË); goto d¦’ø×ê; B‡­›ÕŸ‰†: $cª‹©¨Ù‘„ =& $_SERVER[©äõ½¡]; $F¬ì½²äğ¡ = "\173\x69\x6f\72{$c§¦ƒœ´ââ}\x7d\x2f"; $fÈã¸·ÑÒ÷ = array($cª‹©¨Ù‘„[397] => 0, $cª‹©¨Ù‘„[1104] => array($cª‹©¨Ù‘„[381], "{$F¬ì½²äğ¡}\45")); goto añ«¾ñÃ½; añ«¾ñÃ½: $F´ÈÅŒêõé = Model($cª‹©¨Ù‘„[1710])->where($fÈã¸·ÑÒ÷)->field($cª‹©¨Ù‘„[482])->select(); if (empty($F´ÈÅŒêõé)) { return; } $C‘Ë§îÙâË = array_to_keyvalue($F´ÈÅŒêõé, $cª‹©¨Ù‘„[33], $cª‹©¨Ù‘„[482]); goto aÀÙøÈ×‘Ò; d¦’ø×ê: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\x6d\56\x4c\x69\147\150\164\x41\160\160"; public $modelType = "\x53\x79\163\164\x65\x6d\117\160\164\151\157\156"; public $field = array("\x6e\x61\155\145", "\x67\162\x6f\x75\x70", "\144\145\163\x63", "\143\157\x6e\164\145\156\x74"); public function listData($a§¥Ì™åÜ‹ = false, $eÉ÷Èôˆ´ = "\x6d\157\x64\151\x66\x79\x54\151\155\x65", $eãˆÛ—„ã¼ = true) { return parent::listData($a§¥Ì™åÜ‹, $eÉ÷Èôˆ´, $eãˆÛ—„ã¼); } public function remove($CŠµ°¬Èî) { $eì‹’«È‘ = $this->findByName($CŠµ°¬Èî); if (!$eì‹’«È‘) { return !1; } return parent::remove($eì‹’«È‘[$_SERVER[©äõ½¡][395]]); } public function add($Eİ««©â÷•) { if ($this->findByName($Eİ««©â÷•[$_SERVER[©äõ½¡][28]])) { return !1; } return parent::insert($Eİ««©â÷•); } public function update($dÎéİ“ôóä, $Bßöº¦¿¶ù) { $dğˆ„äæñ =& $_SERVER[©äõ½¡]; $Fñï…Ã±Á = $this->findByName($dÎéİ“ôóä); $AåÙÆÙ• = $this->findByName($Bßöº¦¿¶ù[$dğˆ„äæñ[28]]); if (!$Fñï…Ã±Á || $AåÙÆÙ• && $AåÙÆÙ•[$dğˆ„äæñ[395]] != $Fñï…Ã±Á[$dğˆ„äæñ[395]]) { return !1; } return parent::update($Fñï…Ã±Á[$dğˆ„äæñ[395]], $Bßöº¦¿¶ù); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\171\x73\164\x65\155\137\154\157\x67"; protected $dataAuto = array(array("\x63\x72\x65\141\164\x65\x54\x69\x6d\x65", "\x74\151\155\x65", "\151\156\x73\x65\x72\164", "\146\x75\156\x63\164\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $c­Ò´ÂÌ¿Ì =& $_SERVER[©äõ½¡]; return array($c­Ò´ÂÌ¿Ì[2046] => LNG($c­Ò´ÂÌ¿Ì[2047]), $c­Ò´ÂÌ¿Ì[2048] => LNG($c­Ò´ÂÌ¿Ì[2049]), $c­Ò´ÂÌ¿Ì[1673] => LNG($c­Ò´ÂÌ¿Ì[2050]), $c­Ò´ÂÌ¿Ì[2051] => LNG($c­Ò´ÂÌ¿Ì[2052]), $c­Ò´ÂÌ¿Ì[2053] => LNG($c­Ò´ÂÌ¿Ì[2054]), $c­Ò´ÂÌ¿Ì[2055] => LNG($c­Ò´ÂÌ¿Ì[2056]), $c­Ò´ÂÌ¿Ì[2057] => LNG($c­Ò´ÂÌ¿Ì[2058]), $c­Ò´ÂÌ¿Ì[1703] => LNG($c­Ò´ÂÌ¿Ì[2058]), $c­Ò´ÂÌ¿Ì[1704] => LNG($c­Ò´ÂÌ¿Ì[2059]), $c­Ò´ÂÌ¿Ì[2060] => LNG($c­Ò´ÂÌ¿Ì[2061]), $c­Ò´ÂÌ¿Ì[2062] => LNG($c­Ò´ÂÌ¿Ì[2063]), $c­Ò´ÂÌ¿Ì[2064] => LNG($c­Ò´ÂÌ¿Ì[2065]), $c­Ò´ÂÌ¿Ì[2066] => LNG($c­Ò´ÂÌ¿Ì[2067]), $c­Ò´ÂÌ¿Ì[1701] => LNG($c­Ò´ÂÌ¿Ì[2068]), $c­Ò´ÂÌ¿Ì[2069] => LNG($c­Ò´ÂÌ¿Ì[2070]), $c­Ò´ÂÌ¿Ì[1708] => LNG($c­Ò´ÂÌ¿Ì[2071]), $c­Ò´ÂÌ¿Ì[2072] => LNG($c­Ò´ÂÌ¿Ì[2073]), $c­Ò´ÂÌ¿Ì[2074] => LNG($c­Ò´ÂÌ¿Ì[2075]), $c­Ò´ÂÌ¿Ì[2076] => LNG($c­Ò´ÂÌ¿Ì[2077]), $c­Ò´ÂÌ¿Ì[2078] => LNG($c­Ò´ÂÌ¿Ì[2079]), $c­Ò´ÂÌ¿Ì[1711] => LNG($c­Ò´ÂÌ¿Ì[2080]), $c­Ò´ÂÌ¿Ì[1712] => LNG($c­Ò´ÂÌ¿Ì[2081]), $c­Ò´ÂÌ¿Ì[2082] => LNG($c­Ò´ÂÌ¿Ì[2083]), $c­Ò´ÂÌ¿Ì[2084] => LNG($c­Ò´ÂÌ¿Ì[2085]), $c­Ò´ÂÌ¿Ì[2086] => LNG($c­Ò´ÂÌ¿Ì[2087]), $c­Ò´ÂÌ¿Ì[1706] => LNG($c­Ò´ÂÌ¿Ì[2088]), $c­Ò´ÂÌ¿Ì[2089] => LNG($c­Ò´ÂÌ¿Ì[2090]), $c­Ò´ÂÌ¿Ì[1705] => LNG($c­Ò´ÂÌ¿Ì[2091]), $c­Ò´ÂÌ¿Ì[2092] => LNG($c­Ò´ÂÌ¿Ì[2093]), $c­Ò´ÂÌ¿Ì[2094] => LNG($c­Ò´ÂÌ¿Ì[2095]), $c­Ò´ÂÌ¿Ì[2096] => LNG($c­Ò´ÂÌ¿Ì[2097]), $c­Ò´ÂÌ¿Ì[2098] => LNG($c­Ò´ÂÌ¿Ì[2098]), $c­Ò´ÂÌ¿Ì[2099] => LNG($c­Ò´ÂÌ¿Ì[1677]), $c­Ò´ÂÌ¿Ì[2100] => LNG($c­Ò´ÂÌ¿Ì[2101]), $c­Ò´ÂÌ¿Ì[2102] => LNG($c­Ò´ÂÌ¿Ì[2103]), $c­Ò´ÂÌ¿Ì[2104] => LNG($c­Ò´ÂÌ¿Ì[2105]), $c­Ò´ÂÌ¿Ì[2106] => LNG($c­Ò´ÂÌ¿Ì[2107]), $c­Ò´ÂÌ¿Ì[2108] => LNG($c­Ò´ÂÌ¿Ì[2109]), $c­Ò´ÂÌ¿Ì[2110] => LNG($c­Ò´ÂÌ¿Ì[2110]), $c­Ò´ÂÌ¿Ì[2111] => LNG($c­Ò´ÂÌ¿Ì[2112]), $c­Ò´ÂÌ¿Ì[2113] => LNG($c­Ò´ÂÌ¿Ì[2114]), $c­Ò´ÂÌ¿Ì[2115] => LNG($c­Ò´ÂÌ¿Ì[2116]), $c­Ò´ÂÌ¿Ì[2117] => LNG($c­Ò´ÂÌ¿Ì[2118]), $c­Ò´ÂÌ¿Ì[2119] => LNG($c­Ò´ÂÌ¿Ì[2120]), $c­Ò´ÂÌ¿Ì[2121] => LNG($c­Ò´ÂÌ¿Ì[2122])); } private function typeFile() { $c£²×„ñæ =& $_SERVER[©äõ½¡]; $fà”¾¸ÆŠ = array($c£²×„ñæ[1708] => array($c£²×„ñæ[1709]), $c£²×„ñæ[2064] => array($c£²×„ñæ[2123]), $c£²×„ñæ[2066] => array($c£²×„ñæ[2124]), $c£²×„ñæ[1701] => array($c£²×„ñæ[1702]), $c£²×„ñæ[2074] => array(), $c£²×„ñæ[2076] => array(), $c£²×„ñæ[2078] => array(), $c£²×„ñæ[1711] => array($c£²×„ñæ[1713]), $c£²×„ñæ[1712] => array($c£²×„ñæ[1713]), $c£²×„ñæ[2082] => array($c£²×„ñæ[2125]), $c£²×„ñæ[2084] => array($c£²×„ñæ[2125]), $c£²×„ñæ[2086] => array($c£²×„ñæ[2126]), $c£²×„ñæ[2072] => array($c£²×„ñæ[2127]), $c£²×„ñæ[1706] => array($c£²×„ñæ[2128]), $c£²×„ñæ[2089] => array($c£²×„ñæ[2129]), $c£²×„ñæ[1705] => array($c£²×„ñæ[1707])); return $fà”¾¸ÆŠ; } private function typeAll() { goto fØÌóõ…´; aœÂğçÇß: foreach ($F³Ÿ©ìÕ—Î as $DÚÂî¯”“Î => $Bœğ‰¤ì) { $C“ŠËÉ¬§[$Bœğ‰¤ì[0]] = $C“ŠËÉ¬§[$DÚÂî¯”“Î]; } $C“ŠËÉ¬§[$CÁµ‹£É®[1713]] = LNG($CÁµ‹£É®[2130]); $C“ŠËÉ¬§[$CÁµ‹£É®[2125]] = LNG($CÁµ‹£É®[2131]); goto f©ÅÍ±¹ë; fØÌóõ…´: $CÁµ‹£É® =& $_SERVER[©äõ½¡]; $C“ŠËÉ¬§ = $this->typeList; $F³Ÿ©ìÕ—Î = array_filter($this->typeFile()); goto aœÂğçÇß; f©ÅÍ±¹ë: return $C“ŠËÉ¬§; goto D†é‚‚½µ; D†é‚‚½µ: } public function addLog($b–ÒË‚ÓÍ¸, $F˜¥Ñš‡ë = array()) { goto F¢‚³…Ô‰¤; BªÈªŒµÏ±: $F˜¥Ñš‡ë = array($aî¥ª’íÖ¬[1554] => Session::sign(), $aî¥ª’íÖ¬[1555] => $FÀ¯”Ó‚­, $aî¥ª’íÖ¬[29] => $b–ÒË‚ÓÍ¸, $aî¥ª’íÖ¬[1557] => json_encode($F˜¥Ñš‡ë)); parent::add($F˜¥Ñš‡ë); goto cò²À³¯£´; dÁ­…¹‘Ó‡: if (!$FÀ¯”Ó‚­) { $FÀ¯”Ó‚­ = (int) Session::get($aî¥ª’íÖ¬[1864]); } $f‰íç˜ò’ = get_client_ip(); if (!$F˜¥Ñš‡ë || strlen(json_encode($F˜¥Ñš‡ë)) >= 1024) { $F˜¥Ñš‡ë = array($aî¥ª’íÖ¬[2132] => $f‰íç˜ò’); } else { if (is_array($F˜¥Ñš‡ë)) { $F˜¥Ñš‡ë[$aî¥ª’íÖ¬[2132]] = $f‰íç˜ò’; } else { $F˜¥Ñš‡ë = array($aî¥ª’íÖ¬[1121] => $F˜¥Ñš‡ë, $aî¥ª’íÖ¬[2132] => $f‰íç˜ò’); } } goto BªÈªŒµÏ±; F¢‚³…Ô‰¤: $aî¥ª’íÖ¬ =& $_SERVER[©äõ½¡]; if (!isset($this->typeList[$b–ÒË‚ÓÍ¸])) { return; } $FÀ¯”Ó‚­ = defined($aî¥ª’íÖ¬[468]) && USER_ID ? USER_ID : (isset($F˜¥Ñš‡ë[$aî¥ª’íÖ¬[1564]]) ? $F˜¥Ñš‡ë[$aî¥ª’íÖ¬[1564]] : 0); goto dÁ­…¹‘Ó‡; cò²À³¯£´: } public function remove($e®²³½³®©) { $this->where(array($_SERVER[©äõ½¡][414] => $e®²³½³®©))->delete(); } private function _makeOrder($Cñ»ßèš™ = '') { goto Aí¨Ô¹ÒĞÖ; cŒØ‚…±¥‹: $aôæ’øØó = Input::get($Bª„ÛÃÖÄ[450], $Bª„ÛÃÖÄ[7], $Bª„ÛÃÖÄ[1896], array($Bª„ÛÃÖÄ[1820], $Bª„ÛÃÖÄ[444])); $aôæ’øØó = $CŒ˜à¢°…[$aôæ’øØó]; $Cñ»ßèš™ = $Cñ»ßèš™ . "{$c­ö¡ÆÑÈª}\40{$aôæ’øØó}"; goto C¬äŸÎ¹†; Aí¨Ô¹ÒĞÖ: $Bª„ÛÃÖÄ =& $_SERVER[©äõ½¡]; $c­ö¡ÆÑÈª = $Bª„ÛÃÖÄ[194]; $CŒ˜à¢°… = array($Bª„ÛÃÖÄ[442] => $Bª„ÛÃÖÄ[443], $Bª„ÛÃÖÄ[444] => $Bª„ÛÃÖÄ[445]); goto cŒØ‚…±¥‹; C¬äŸÎ¹†: return $this->order($Cñ»ßèš™); goto aá„Ç«…; aá„Ç«…: } public function get($e„Œï±Ä·Œ = '') { goto AÏ®ƒò‘; a˜¶¼ß³: $E¾®–å¤îÁ[$dœŞ¼Ø¡²š[367]] = $this->logList($E¾®–å¤îÁ[$dœŞ¼Ø¡²š[367]]); return $E¾®–å¤îÁ; goto BÀÃÅ˜—Î; dæ†ÍÏ¼­: if ($e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[1564]]) { $cº–æ½ÛªĞ[$dœŞ¼Ø¡²š[1564]] = $e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[1564]]; } if (isset($e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[756]])) { $dĞ™®ƒ¶‡à = $e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[756]]; $DõÌÈ‘˜í = isset($e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[490]]) ? $e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[490]] : time(); $cº–æ½ÛªĞ[$dœŞ¼Ø¡²š[194]] = array($dœŞ¼Ø¡²š[331], array($dĞ™®ƒ¶‡à, $DõÌÈ‘˜í)); } if ($e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[29]]) { $FÒ¢»Ñ¶Ñİ = explode($dœŞ¼Ø¡²š[47], $e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[29]]); $E±—†Â‘ö® = $this->typeFile(); $dá¿àØ•“ = array(); foreach ($FÒ¢»Ñ¶Ñİ as $AËÕÊƒˆÅ) { $dá¿àØ•“[] = $AËÕÊƒˆÅ; if (isset($E±—†Â‘ö®[$AËÕÊƒˆÅ])) { $dá¿àØ•“ = array_merge($dá¿àØ•“, $E±—†Â‘ö®[$AËÕÊƒˆÅ]); } } $dá¿àØ•“ = array_unique($dá¿àØ•“); if ($dá¿àØ•“) { $cº–æ½ÛªĞ[$dœŞ¼Ø¡²š[29]] = array($dœŞ¼Ø¡²š[7], $dá¿àØ•“); } } else { $cº–æ½ÛªĞ[$dœŞ¼Ø¡²š[29]] = array($dœŞ¼Ø¡²š[2133], $dœŞ¼Ø¡²š[2134]); } goto c·§•åÎÖ; AÏ®ƒò‘: $dœŞ¼Ø¡²š =& $_SERVER[©äõ½¡]; if (!$e„Œï±Ä·Œ) { show_json(array()); } $cº–æ½ÛªĞ = array(); goto dæ†ÍÏ¼­; c·§•åÎÖ: if (!empty($e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[2132]])) { $cº–æ½ÛªĞ[$dœŞ¼Ø¡²š[445]] = array($dœŞ¼Ø¡²š[381], "\x25{$e„Œï±Ä·Œ[$dœŞ¼Ø¡²š[2132]]}\x25"); } $E¾®–å¤îÁ = $this->_makeOrder()->where($cº–æ½ÛªĞ)->selectPage(); if (empty($E¾®–å¤îÁ[$dœŞ¼Ø¡²š[367]])) { show_json(array(), !0, $E¾®–å¤îÁ[$dœŞ¼Ø¡²š[364]]); } goto a˜¶¼ß³; BÀÃÅ˜—Î: } private function ipAddress(&$DŒ£…æø‡Â) { $dÍáŸœ§œ® =& $_SERVER[©äõ½¡]; if (!empty($DŒ£…æø‡Â[$dÍáŸœ§œ®[2132]])) { $D‚ˆ¥í›ÛÔ = IpLocation::get($DŒ£…æø‡Â[$dÍáŸœ§œ®[2132]]); } else { $D‚ˆ¥í›ÛÔ = LNG($dÍáŸœ§œ®[2135]); } $DŒ£…æø‡Â[$dÍáŸœ§œ®[2136]] = $D‚ˆ¥í›ÛÔ; } private function descZipDownload($aË¶ïØ‚®, &$A£ƒ·‰Œ¼ê) { $Eœ™î•Åâè =& $_SERVER[©äõ½¡]; if (!isset($aË¶ïØ‚®[$Eœ™î•Åâè[2137]])) { return; } $C›àÑšô‡ì = json_decode($aË¶ïØ‚®[$Eœ™î•Åâè[2137]], !0); foreach ($C›àÑšô‡ì as $d–¼÷ÛÈºÈ) { try { $cÇÜêƒ£ÄÔ = IO::infoFull($d–¼÷ÛÈºÈ[$Eœ™î•Åâè[76]]); } catch (Exception $dŒ¸Á”Ä‡Ã) { continue; } $aË¶ïØ‚®[$Eœ™î•Åâè[76]] = $d–¼÷ÛÈºÈ[$Eœ™î•Åâè[76]]; $A£ƒ·‰Œ¼ê[] = $aË¶ïØ‚®[$Eœ™î•Åâè[397]] = $cÇÜêƒ£ÄÔ[$Eœ™î•Åâè[397]]; $A£ƒ·‰Œ¼ê[] = $aË¶ïØ‚®[$Eœ™î•Åâè[1950]] = $cÇÜêƒ£ÄÔ[$Eœ™î•Åâè[492]]; break; } return $aË¶ïØ‚®; } private function getSourceList(&$D“ƒÎ¾‚Ğ×) { $Eç½©ïÇ‚¾ =& $_SERVER[©äõ½¡]; $cÉìßòŒ¾ƒ = array(); foreach ($D“ƒÎ¾‚Ğ× as $E›‰ÊÁñæÀ => $eÕµÕóÎ÷Ì) { goto C¥¤µ…ŒŞ; C¥¤µ…ŒŞ: $f»‚¦â‰“ë = json_decode($eÕµÕóÎ÷Ì[$Eç½©ïÇ‚¾[445]], !0); if ($eÕµÕóÎ÷Ì[$Eç½©ïÇ‚¾[29]] == $Eç½©ïÇ‚¾[1704]) { $f»‚¦â‰“ë = $this->descZipDownload($f»‚¦â‰“ë, $cÉìßòŒ¾ƒ); $D“ƒÎ¾‚Ğ×[$E›‰ÊÁñæÀ][$Eç½©ïÇ‚¾[445]] = json_encode($f»‚¦â‰“ë); continue; } if (strpos($eÕµÕóÎ÷Ì[$Eç½©ïÇ‚¾[29]], $Eç½©ïÇ‚¾[1951]) !== 0) { if (!isset($f»‚¦â‰“ë[$Eç½©ïÇ‚¾[76]]) || strpos($eÕµÕóÎ÷Ì[$Eç½©ïÇ‚¾[29]], $Eç½©ïÇ‚¾[2138]) !== 0) { continue; } try { $A‚¬ãå‹ = IO::infoFull($f»‚¦â‰“ë[$Eç½©ïÇ‚¾[76]]); } catch (Exception $EõÖï©¤) { continue; } $cÉìßòŒ¾ƒ[] = $f»‚¦â‰“ë[$Eç½©ïÇ‚¾[397]] = $A‚¬ãå‹[$Eç½©ïÇ‚¾[397]]; $cÉìßòŒ¾ƒ[] = $f»‚¦â‰“ë[$Eç½©ïÇ‚¾[1950]] = $A‚¬ãå‹[$Eç½©ïÇ‚¾[492]]; $D“ƒÎ¾‚Ğ×[$E›‰ÊÁñæÀ][$Eç½©ïÇ‚¾[445]] = json_encode($f»‚¦â‰“ë); continue; } goto cçìœ³ê˜Æ; Cî‘«·ä‘±: if ($f»‚¦â‰“ë[$Eç½©ïÇ‚¾[29]] == $Eç½©ïÇ‚¾[1958]) { $cÉìßòŒ¾ƒ[] = $f»‚¦â‰“ë[$Eç½©ïÇ‚¾[445]][$Eç½©ïÇ‚¾[397]]; } goto bèÑØ¥Àéâ; cçìœ³ê˜Æ: $cÉìßòŒ¾ƒ[] = $f»‚¦â‰“ë[$Eç½©ïÇ‚¾[397]]; $cÉìßòŒ¾ƒ[] = $f»‚¦â‰“ë[$Eç½©ïÇ‚¾[1950]]; if ($f»‚¦â‰“ë[$Eç½©ïÇ‚¾[29]] == $Eç½©ïÇ‚¾[545]) { $cÉìßòŒ¾ƒ[] = $f»‚¦â‰“ë[$Eç½©ïÇ‚¾[445]][$Eç½©ïÇ‚¾[1088]]; $cÉìßòŒ¾ƒ[] = $f»‚¦â‰“ë[$Eç½©ïÇ‚¾[445]][$Eç½©ïÇ‚¾[1089]]; } goto Cî‘«·ä‘±; bèÑØ¥Àéâ: } if (!$cÉìßòŒ¾ƒ) { return array(); } return Model($Eç½©ïÇ‚¾[827])->sourceListInfo($cÉìßòŒ¾ƒ, !0); } private function logList($A±á‘ÉïÆØ) { goto D®Ûï°³®Ì; D®Ûï°³®Ì: $a²›Ô­¥£á =& $_SERVER[©äõ½¡]; $dÌË‹¢­Îš = array_to_keyvalue($A±á‘ÉïÆØ, $a²›Ô­¥£á[33], $a²›Ô­¥£á[1564]); $A–¹×¹æĞ¾ = Model($a²›Ô­¥£á[532])->userListInfo(array_unique($dÌË‹¢­Îš)); goto A¢‡ªôÊ„„; A¢‡ªôÊ„„: $c¥×¾Ó­Ê™ = $this->getSourceList($A±á‘ÉïÆØ); $c÷²ôøä„’ = $this->typeAll(); $C¼¦‚‹÷­¼ = array(); goto bâ¬İÜ®‹; bâ¬İÜ®‹: $d˜•Ì¿è¼ä = array(); foreach ($A±á‘ÉïÆØ as $EŠ­É‹ƒœö => $a×³ÕÉÆõÓ) { goto dƒ³•®ÕÇ•; b³ÍõÀËßĞ: $a×³ÕÉÆõÓ[$a²›Ô­¥£á[28]] = isset($f††’‘šé[$a²›Ô­¥£á[28]]) ? $f††’‘šé[$a²›Ô­¥£á[28]] : LNG($a²›Ô­¥£á[2135]); $a×³ÕÉÆõÓ[$a²›Ô­¥£á[1998]] = isset($f††’‘šé[$a²›Ô­¥£á[1998]]) ? $f††’‘šé[$a²›Ô­¥£á[1998]] : $a²›Ô­¥£á[33]; $a×³ÕÉÆõÓ[$a²›Ô­¥£á[1465]] = isset($c÷²ôøä„’[$a¡Ãîµ‡Â…]) ? $c÷²ôøä„’[$a¡Ãîµ‡Â…] : $Cİèõ³àà±; goto dÖÓÈ—ñ‚Ì; EË¦Ãñ¿÷: $this->ipAddress($a×³ÕÉÆõÓ); if (strpos($a¡Ãîµ‡Â…, $a²›Ô­¥£á[1951]) === 0 || isset($aŒ˜š“Á¤Í[$a²›Ô­¥£á[1950]])) { goto eÚ¬°Æ†÷®; dİ‹â‡¬™‰: if ($aŒ˜š“Á¤Í[$a²›Ô­¥£á[29]] == $a²›Ô­¥£á[1958]) { $aŒ˜š“Á¤Í[$a²›Ô­¥£á[445]][$a²›Ô­¥£á[397]] = $c¥×¾Ó­Ê™[$aŒ˜š“Á¤Í[$a²›Ô­¥£á[445]][$a²›Ô­¥£á[397]]]; } if ($aŒ˜š“Á¤Í[$a²›Ô­¥£á[29]] == $a²›Ô­¥£á[1699]) { $aŒ˜š“Á¤Í[$a²›Ô­¥£á[1963]] = $aŒ˜š“Á¤Í[$a²›Ô­¥£á[85]]; $aŒ˜š“Á¤Í[$a²›Ô­¥£á[1950]] = $aŒ˜š“Á¤Í[$a²›Ô­¥£á[1963]][$a²›Ô­¥£á[397]]; $aŒ˜š“Á¤Í[$a²›Ô­¥£á[85]] = !1; $aŒ˜š“Á¤Í[$a²›Ô­¥£á[397]] = $a²›Ô­¥£á[33]; } if ($aŒ˜š“Á¤Í[$a²›Ô­¥£á[85]] && $aŒ˜š“Á¤Í[$a²›Ô­¥£á[85]][$a²›Ô­¥£á[406]] == $a²›Ô­¥£á[1204]) { $d˜•Ì¿è¼ä[] = $a×³ÕÉÆõÓ[$a²›Ô­¥£á[395]]; unset($A±á‘ÉïÆØ[$EŠ­É‹ƒœö]); continue; } goto Dáˆôè¾´; eÚ¬°Æ†÷®: $aŒ˜š“Á¤Í[$a²›Ô­¥£á[85]] = $c¥×¾Ó­Ê™[$aŒ˜š“Á¤Í[$a²›Ô­¥£á[397]]]; $aŒ˜š“Á¤Í[$a²›Ô­¥£á[1963]] = $c¥×¾Ó­Ê™[$aŒ˜š“Á¤Í[$a²›Ô­¥£á[1950]]]; if ($aŒ˜š“Á¤Í[$a²›Ô­¥£á[29]] == $a²›Ô­¥£á[545]) { $aŒ˜š“Á¤Í[$a²›Ô­¥£á[445]][$a²›Ô­¥£á[1088]] = $c¥×¾Ó­Ê™[$aŒ˜š“Á¤Í[$a²›Ô­¥£á[445]][$a²›Ô­¥£á[1088]]]; $aŒ˜š“Á¤Í[$a²›Ô­¥£á[445]][$a²›Ô­¥£á[1089]] = $c¥×¾Ó­Ê™[$aŒ˜š“Á¤Í[$a²›Ô­¥£á[445]][$a²›Ô­¥£á[1089]]]; } goto dİ‹â‡¬™‰; Dáˆôè¾´: if ($aŒ˜š“Á¤Í[$a²›Ô­¥£á[1963]] && $aŒ˜š“Á¤Í[$a²›Ô­¥£á[1963]][$a²›Ô­¥£á[406]] == $a²›Ô­¥£á[1204]) { $d˜•Ì¿è¼ä[] = $a×³ÕÉÆõÓ[$a²›Ô­¥£á[395]]; unset($A±á‘ÉïÆØ[$EŠ­É‹ƒœö]); continue; } goto EÜÊŞ¹•×Ï; EÜÊŞ¹•×Ï: } $a×³ÕÉÆõÓ[$a²›Ô­¥£á[445]] = $aŒ˜š“Á¤Í; goto Fèğ®Éñ­; dÖÓÈ—ñ‚Ì: $a×³ÕÉÆõÓ[$a²›Ô­¥£á[1895]] = $f††’‘šé; $aŒ˜š“Á¤Í = json_decode($a×³ÕÉÆõÓ[$a²›Ô­¥£á[445]], !0); $a×³ÕÉÆõÓ[$a²›Ô­¥£á[2132]] = isset($aŒ˜š“Á¤Í[$a²›Ô­¥£á[2132]]) ? $aŒ˜š“Á¤Í[$a²›Ô­¥£á[2132]] : $a²›Ô­¥£á[33]; goto EË¦Ãñ¿÷; dƒ³•®ÕÇ•: $a¡Ãîµ‡Â… = $a×³ÕÉÆõÓ[$a²›Ô­¥£á[29]]; $f††’‘šé = isset($A–¹×¹æĞ¾[$a×³ÕÉÆõÓ[$a²›Ô­¥£á[1564]]]) ? $A–¹×¹æĞ¾[$a×³ÕÉÆõÓ[$a²›Ô­¥£á[1564]]] : !1; $Cİèõ³àà± = strpos($a¡Ãîµ‡Â…, $a²›Ô­¥£á[2139]) === 0 ? LNG($a²›Ô­¥£á[2140]) : LNG($a²›Ô­¥£á[2135]); goto b³ÍõÀËßĞ; Fèğ®Éñ­: unset($a×³ÕÉÆõÓ[$a²›Ô­¥£á[2141]]); $C¼¦‚‹÷­¼[] = $a×³ÕÉÆõÓ; goto D´Ğ‚°Èß„; D´Ğ‚°Èß„: } $this->clearSystemPathLog($d˜•Ì¿è¼ä); goto d–Ú«ŸÀì‘; d–Ú«ŸÀì‘: return $C¼¦‚‹÷­¼; goto ağ„Â‘ÂÈÃ; ağ„Â‘ÂÈÃ: } private function clearSystemPathLog($e®•è×Şè´) { $EÅÃ¯£øó =& $_SERVER[©äõ½¡]; if (count($e®•è×Şè´) == 0) { return; } $FÛá‚ƒÕã‰ = array($EÅÃ¯£øó[395] => array($EÅÃ¯£øó[7], array_unique($e®•è×Şè´))); $this->where($FÛá‚ƒÕã‰)->delete(); } public function deviceList($aã¸Ÿ ¤Ó, $A˜ì¬†Àƒ÷ = 0) { $fâÛ¦Öˆø¹ =& $_SERVER[©äõ½¡]; $F¸å‹…œÁÎ = array($fâÛ¦Öˆø¹[1564] => $aã¸Ÿ ¤Ó, $fâÛ¦Öˆø¹[194] => array($fâÛ¦Öˆø¹[1006], $A˜ì¬†Àƒ÷), $fâÛ¦Öˆø¹[29] => $fâÛ¦Öˆø¹[1673]); $c‘ùù—ÙîÕ = array(); $aŒ°„šØ†® = $this->field($fâÛ¦Öˆø¹[2142])->where($F¸å‹…œÁÎ)->order($fâÛ¦Öˆø¹[1961])->limit(50)->select(); foreach ($aŒ°„šØ†® as $Cóèì…İ† => $bŠëùÍ¡¤) { goto D³×¼»‹¿À; aåóˆ®šó¸: unset($f‚µÓ¾ÔÅ˜[$fâÛ¦Öˆø¹[2132]]); $F¦íÉğ²’ = $this->deviceType($f‚µÓ¾ÔÅ˜[$fâÛ¦Öˆø¹[1952]]); if (isset($c‘ùù—ÙîÕ[$F¦íÉğ²’])) { continue; } goto c¢ÊÆÇ×¸”; c¢ÊÆÇ×¸”: $this->ipAddress($bŠëùÍ¡¤); $bŠëùÍ¡¤[$fâÛ¦Öˆø¹[445]] = $f‚µÓ¾ÔÅ˜; $c‘ùù—ÙîÕ[$F¦íÉğ²’] = $bŠëùÍ¡¤; goto b¿ĞÅªİÁ¯; D³×¼»‹¿À: if ($Cóèì…İ† > 0 && abs($bŠëùÍ¡¤[$fâÛ¦Öˆø¹[194]] - $aŒ°„šØ†®[$Cóèì…İ† - 1][$fâÛ¦Öˆø¹[194]]) < 5) { continue; } $f‚µÓ¾ÔÅ˜ = json_decode($bŠëùÍ¡¤[$fâÛ¦Öˆø¹[445]], !0); $bŠëùÍ¡¤[$fâÛ¦Öˆø¹[2132]] = isset($f‚µÓ¾ÔÅ˜[$fâÛ¦Öˆø¹[2132]]) ? $f‚µÓ¾ÔÅ˜[$fâÛ¦Öˆø¹[2132]] : $fâÛ¦Öˆø¹[33]; goto aåóˆ®šó¸; b¿ĞÅªİÁ¯: } return array_values($c‘ùù—ÙîÕ); } public function deviceType($CÖäÄèÆ×¼) { return $CÖäÄèÆ×¼; } } goto EŒË¿À˜¼; EÄôˆŠ½†Æ: class SystemRecordModel extends ModelBaseLight { } $d§Î’ãàÂ = $_SERVER[$_SERVER[©äõ½¡][855]]; $Dê¥ÜİÎè± = $_SERVER[©äõ½¡][856]; goto DÏİàæ ÷‹; EÁ±œÏç: define($_SERVER[©äõ½¡][237], 2); define($_SERVER[©äõ½¡][238], 3); define($_SERVER[©äõ½¡][239], 1); goto BÑƒ÷ªİ¦Ï; eİª“¹±íÍ: class DbSqlite extends DbSqliteBase { public function query($f ¿£¦÷’İ) { $F˜ìÇ‘ÇÕÅ =& $_SERVER[©äõ½¡]; if (!CacheLock::fileLock($F˜ìÇ‘ÇÕÅ[9])) { return !1; } $A‚ªÌÃ¢Ü = parent::query($f ¿£¦÷’İ); CacheLock::fileUnLock($F˜ìÇ‘ÇÕÅ[9]); return $A‚ªÌÃ¢Ü; } public function execute($C÷¬Ù™Çºö) { $bá´Í‹¦·ê =& $_SERVER[©äõ½¡]; if (!CacheLock::fileLock($bá´Í‹¦·ê[9])) { return !1; } $e•ÎÚ‹ùÏ = parent::execute($C÷¬Ù™Çºö); CacheLock::fileUnLock($bá´Í‹¦·ê[9]); return $e•ÎÚ‹ùÏ; } } class DbSqlite3 extends DbSqlite3Base { public function query($Dïàß®ó›) { $B¹×âÁÓ’… =& $_SERVER[©äõ½¡]; if (!CacheLock::fileLock($B¹×âÁÓ’…[9])) { return !1; } $B“íÒ¨ÂÃ = parent::query($Dïàß®ó›); CacheLock::fileUnLock($B¹×âÁÓ’…[9]); return $B“íÒ¨ÂÃ; } public function execute($fİªÜšÃ•¬) { $föšÈ¨õÚİ =& $_SERVER[©äõ½¡]; if (!CacheLock::fileLock($föšÈ¨õÚİ[9])) { return !1; } $Dœ©„ô’Ş = parent::execute($fİªÜšÃ•¬); CacheLock::fileUnLock($föšÈ¨õÚİ[9]); return $Dœ©„ô’Ş; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\x68\151\156\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\161" => "\75", "\156\x65\161" => "\74\x3e", "\147\x74" => "\76", "\145\x67\164" => "\76\75", "\x6c\x74" => "\74", "\x65\154\164" => "\74\x3d", "\156\x6f\164\x6c\x69\x6b\145" => "\x4e\x4f\124\x20\114\x49\113\105", "\154\151\153\145" => "\x4c\x49\113\x45", "\151\156" => "\x49\x4e", "\x6e\157\x74\x69\x6e" => "\116\117\124\40\111\x4e", "\156\x6f\x74\x20\151\x6e" => "\116\117\124\40\x49\x4e", "\142\x65\x74\167\145\x65\156" => "\102\105\x54\127\x45\x45\116", "\156\157\x74\142\x65\164\x77\x65\145\156" => "\x4e\117\x54\x20\102\x45\124\127\105\x45\x4e", "\156\157\164\x20\142\145\164\167\x65\x65\x6e" => "\116\117\124\40\x42\105\x54\127\105\x45\x4e"); protected $selectSql = "\x53\105\x4c\x45\103\124\x25\x44\x49\x53\124\111\116\103\124\45\x20\45\106\x49\x45\114\x44\45\40\106\122\x4f\x4d\40\45\x54\101\x42\114\x45\45\45\112\x4f\111\116\45\45\x57\110\105\122\x45\x25\45\x47\122\x4f\x55\x50\45\x25\x48\101\126\111\116\x47\45\45\117\x52\x44\105\x52\45\x25\x4c\111\x4d\x49\x54\45\x20\x25\x55\116\x49\117\x4e\x25\x25\103\x4f\x4d\115\105\116\124\45"; protected $bind = array(); public static function getInstance() { $E´„„Ç‘ÂŒ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[©äõ½¡][954], $E´„„Ç‘ÂŒ); } public function factory($a³‡ù¼ÖÈ§ = '') { goto FĞ±­Í‡İè; D¹Š‘íŸ­Æ: return $C¶ˆºÜ¦œª; goto dÇ³ªÑø; FĞ±­Í‡İè: $D©ŠËôáğ  =& $_SERVER[©äõ½¡]; $a³‡ù¼ÖÈ§ = $this->parseConfig($a³‡ù¼ÖÈ§); if (empty($a³‡ù¼ÖÈ§[$D©ŠËôáğ [955]])) { think_exception(think_lang($D©ŠËôáğ [956])); } goto Fä“ Š–‚•; Fä“ Š–‚•: $this->dbType = ucwords(strtolower($a³‡ù¼ÖÈ§[$D©ŠËôáğ [955]])); $F÷äšçÂöë = $D©ŠËôáğ [957] . $this->dbType; if (class_exists($F÷äšçÂöë)) { $C¶ˆºÜ¦œª = new $F÷äšçÂöë($a³‡ù¼ÖÈ§); if ($D©ŠËôáğ [792] != strtolower($a³‡ù¼ÖÈ§[$D©ŠËôáğ [955]])) { $C¶ˆºÜ¦œª->dbType = strtoupper($this->dbType); } else { $C¶ˆºÜ¦œª->dbType = $this->_getDsnType($a³‡ù¼ÖÈ§[$D©ŠËôáğ [910]]); } } else { think_exception(think_lang($D©ŠËôáğ [958]) . $D©ŠËôáğ [959] . $F÷äšçÂöë); } goto D¹Š‘íŸ­Æ; dÇ³ªÑø: } public function __call($Aˆ¼ëÏß·Ï, $cÃ¡¼³Ğ†Ã) { if (method_exists($this, $Aˆ¼ëÏß·Ï)) { return call_user_func_array(array($this, $Aˆ¼ëÏß·Ï), $cÃ¡¼³Ğ†Ã); } } protected function _getDsnType($Aëˆù¼Ç•) { $CíÈœ’Ìº  = explode($_SERVER[©äõ½¡][4], $Aëˆù¼Ç•); $Dó¶Ù»ô• = strtoupper(trim($CíÈœ’Ìº [0])); return $Dó¶Ù»ô•; } private function parseConfig($a˜°ÂÊˆªÕ = '') { $B¹ÍÏ…¸ÄÑ =& $_SERVER[©äõ½¡]; if (!empty($a˜°ÂÊˆªÕ) && is_string($a˜°ÂÊˆªÕ)) { $a˜°ÂÊˆªÕ = $this->parseDSN($a˜°ÂÊˆªÕ); } elseif (is_array($a˜°ÂÊˆªÕ)) { $a˜°ÂÊˆªÕ = array_change_key_case($a˜°ÂÊˆªÕ); $a˜°ÂÊˆªÕ = array($B¹ÍÏ…¸ÄÑ[955] => $a˜°ÂÊˆªÕ[$B¹ÍÏ…¸ÄÑ[791]], $B¹ÍÏ…¸ÄÑ[883] => $a˜°ÂÊˆªÕ[$B¹ÍÏ…¸ÄÑ[960]], $B¹ÍÏ…¸ÄÑ[884] => $a˜°ÂÊˆªÕ[$B¹ÍÏ…¸ÄÑ[961]], $B¹ÍÏ…¸ÄÑ[881] => $a˜°ÂÊˆªÕ[$B¹ÍÏ…¸ÄÑ[962]], $B¹ÍÏ…¸ÄÑ[882] => $a˜°ÂÊˆªÕ[$B¹ÍÏ…¸ÄÑ[963]], $B¹ÍÏ…¸ÄÑ[17] => $a˜°ÂÊˆªÕ[$B¹ÍÏ…¸ÄÑ[964]], $B¹ÍÏ…¸ÄÑ[910] => $a˜°ÂÊˆªÕ[$B¹ÍÏ…¸ÄÑ[793]], $B¹ÍÏ…¸ÄÑ[13] => isset($a˜°ÂÊˆªÕ[$B¹ÍÏ…¸ÄÑ[965]]) ? $a˜°ÂÊˆªÕ[$B¹ÍÏ…¸ÄÑ[965]] : array()); } elseif (empty($a˜°ÂÊˆªÕ)) { if (think_config($B¹ÍÏ…¸ÄÑ[966]) && $B¹ÍÏ…¸ÄÑ[792] != strtolower(think_config($B¹ÍÏ…¸ÄÑ[967]))) { $a˜°ÂÊˆªÕ = $this->parseDSN(think_config($B¹ÍÏ…¸ÄÑ[966])); } else { $a˜°ÂÊˆªÕ = array($B¹ÍÏ…¸ÄÑ[955] => think_config($B¹ÍÏ…¸ÄÑ[967]), $B¹ÍÏ…¸ÄÑ[883] => think_config($B¹ÍÏ…¸ÄÑ[968]), $B¹ÍÏ…¸ÄÑ[884] => think_config($B¹ÍÏ…¸ÄÑ[969]), $B¹ÍÏ…¸ÄÑ[881] => think_config($B¹ÍÏ…¸ÄÑ[970]), $B¹ÍÏ…¸ÄÑ[882] => think_config($B¹ÍÏ…¸ÄÑ[971]), $B¹ÍÏ…¸ÄÑ[17] => think_config($B¹ÍÏ…¸ÄÑ[244]), $B¹ÍÏ…¸ÄÑ[910] => think_config($B¹ÍÏ…¸ÄÑ[966]), $B¹ÍÏ…¸ÄÑ[13] => think_config($B¹ÍÏ…¸ÄÑ[972])); } } return $a˜°ÂÊˆªÕ; } protected function initConnect($dŠ°‹é¿”ï = true) { if (1 == think_config($_SERVER[©äõ½¡][18])) { $this->_linkID = $this->multiConnect($dŠ°‹é¿”ï); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $báÀôÆ‡Öâ => $cÚö®Ê˜Šï) { $this->_linkID = $cÚö®Ê˜Šï; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($e¹ÅŒ¨¼Â» = false) { goto eà×‚îËÉ‚; fğÓ›œÈ: $BâëøÒïí‘ = array($f¥ùƒ™›œ[883] => isset($b¼çè®Ú’Ñ[$f¥ùƒ™›œ[883]][$D‰çè¤ôª—]) ? $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[883]][$D‰çè¤ôª—] : $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[883]][0], $f¥ùƒ™›œ[884] => isset($b¼çè®Ú’Ñ[$f¥ùƒ™›œ[884]][$D‰çè¤ôª—]) ? $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[884]][$D‰çè¤ôª—] : $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[884]][0], $f¥ùƒ™›œ[881] => isset($b¼çè®Ú’Ñ[$f¥ùƒ™›œ[881]][$D‰çè¤ôª—]) ? $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[881]][$D‰çè¤ôª—] : $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[881]][0], $f¥ùƒ™›œ[882] => isset($b¼çè®Ú’Ñ[$f¥ùƒ™›œ[882]][$D‰çè¤ôª—]) ? $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[882]][$D‰çè¤ôª—] : $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[882]][0], $f¥ùƒ™›œ[17] => isset($b¼çè®Ú’Ñ[$f¥ùƒ™›œ[17]][$D‰çè¤ôª—]) ? $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[17]][$D‰çè¤ôª—] : $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[17]][0], $f¥ùƒ™›œ[910] => isset($b¼çè®Ú’Ñ[$f¥ùƒ™›œ[910]][$D‰çè¤ôª—]) ? $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[910]][$D‰çè¤ôª—] : $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[910]][0], $f¥ùƒ™›œ[13] => isset($b¼çè®Ú’Ñ[$f¥ùƒ™›œ[13]][$D‰çè¤ôª—]) ? $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[13]][$D‰çè¤ôª—] : $b¼çè®Ú’Ñ[$f¥ùƒ™›œ[13]][0]); return $this->connect($BâëøÒïí‘, $D‰çè¤ôª—); goto EºâËÌ×Şƒ; AÙ¿¹Œ‘âæ: if (empty($b¼çè®Ú’Ñ)) { foreach ($this->config as $CíÙÂëÖº => $EŒ‹î³ÄÑ) { $b¼çè®Ú’Ñ[$CíÙÂëÖº] = explode($f¥ùƒ™›œ[47], $EŒ‹î³ÄÑ); } } if (think_config($f¥ùƒ™›œ[973])) { if ($e¹ÅŒ¨¼Â» || think_config($f¥ùƒ™›œ[391]) === !0) { $D‰çè¤ôª— = floor(mt_rand(0, think_config($f¥ùƒ™›œ[974]) - 1)); $c‚¡÷¨Üİ = $D‰çè¤ôª—; } else { if (is_numeric(think_config($f¥ùƒ™›œ[975]))) { $D‰çè¤ôª— = think_config($f¥ùƒ™›œ[975]); } else { $D‰çè¤ôª— = floor(mt_rand(think_config($f¥ùƒ™›œ[974]), count($b¼çè®Ú’Ñ[$f¥ùƒ™›œ[881]]) - 1)); } } } else { $D‰çè¤ôª— = floor(mt_rand(0, count($b¼çè®Ú’Ñ[$f¥ùƒ™›œ[881]]) - 1)); $c‚¡÷¨Üİ = $D‰çè¤ôª—; } $D‰çè¤ôª— = $c‚¡÷¨Üİ !== -1 ? $c‚¡÷¨Üİ : $D‰çè¤ôª—; goto fğÓ›œÈ; eà×‚îËÉ‚: $f¥ùƒ™›œ =& $_SERVER[©äõ½¡]; static $b¼çè®Ú’Ñ = array(); static $c‚¡÷¨Üİ = -1; goto AÙ¿¹Œ‘âæ; EºâËÌ×Şƒ: } public function parseDSN($E–í§¥ç›) { $aè«ÏÛñµË =& $_SERVER[©äõ½¡]; if (empty($E–í§¥ç›)) { return !1; } $ašö‚²¶ê = parse_url($E–í§¥ç›); if ($ašö‚²¶ê[$aè«ÏÛñµË[174]]) { $C¯®„‚ÏÓÚ = array($aè«ÏÛñµË[955] => $ašö‚²¶ê[$aè«ÏÛñµË[174]], $aè«ÏÛñµË[883] => isset($ašö‚²¶ê[$aè«ÏÛñµË[588]]) ? $ašö‚²¶ê[$aè«ÏÛñµË[588]] : $aè«ÏÛñµË[33], $aè«ÏÛñµË[884] => isset($ašö‚²¶ê[$aè«ÏÛñµË[976]]) ? $ašö‚²¶ê[$aè«ÏÛñµË[976]] : $aè«ÏÛñµË[33], $aè«ÏÛñµË[881] => isset($ašö‚²¶ê[$aè«ÏÛñµË[175]]) ? $ašö‚²¶ê[$aè«ÏÛñµË[175]] : $aè«ÏÛñµË[33], $aè«ÏÛñµË[882] => isset($ašö‚²¶ê[$aè«ÏÛñµË[176]]) ? $ašö‚²¶ê[$aè«ÏÛñµË[176]] : $aè«ÏÛñµË[33], $aè«ÏÛñµË[17] => isset($ašö‚²¶ê[$aè«ÏÛñµË[76]]) ? substr($ašö‚²¶ê[$aè«ÏÛñµË[76]], 1) : $aè«ÏÛñµË[33]); } else { preg_match($aè«ÏÛñµË[977], trim($E–í§¥ç›), $f¾Ï¿‘ö); $C¯®„‚ÏÓÚ = array($aè«ÏÛñµË[955] => $f¾Ï¿‘ö[1], $aè«ÏÛñµË[883] => $f¾Ï¿‘ö[2], $aè«ÏÛñµË[884] => $f¾Ï¿‘ö[3], $aè«ÏÛñµË[881] => $f¾Ï¿‘ö[4], $aè«ÏÛñµË[882] => $f¾Ï¿‘ö[5], $aè«ÏÛñµË[17] => $f¾Ï¿‘ö[6]); } $C¯®„‚ÏÓÚ[$aè«ÏÛñµË[910]] = $aè«ÏÛñµË[33]; return $C¯®„‚ÏÓÚ; } protected function debug() { $E± ø£ÏéŒ =& $_SERVER[©äõ½¡]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $E± ø£ÏéŒ[978]; if (think_config($E± ø£ÏéŒ[979])) { think_status($E± ø£ÏéŒ[980]); think_trace($this->queryStr . $E± ø£ÏéŒ[981] . think_status($E± ø£ÏéŒ[20], $E± ø£ÏéŒ[980], 6) . $E± ø£ÏéŒ[982], $E± ø£ÏéŒ[33], $E± ø£ÏéŒ[983]); } } protected function parseLock($C¤ºÓ˜±Ãó = false) { $C†Æ•†ß± =& $_SERVER[©äõ½¡]; if (!$C¤ºÓ˜±Ãó) { return $C†Æ•†ß±[33]; } if ($C†Æ•†ß±[912] == $this->dbType) { return $C†Æ•†ß±[984]; } return $C†Æ•†ß±[985]; } protected function parseSet($fù‘¿¨£³ö) { $CÆˆóÏÍ =& $_SERVER[©äõ½¡]; foreach ($fù‘¿¨£³ö as $e¬›åÉçƒ => $dà“ŞÑšäÈ) { if (is_array($dà“ŞÑšäÈ) && $CÆˆóÏÍ[295] == $dà“ŞÑšäÈ[0]) { $C¸ßŞ¨¼ø›[] = $this->parseKey($e¬›åÉçƒ) . $CÆˆóÏÍ[986] . $dà“ŞÑšäÈ[1]; } elseif (is_scalar($dà“ŞÑšäÈ) || is_null($dà“ŞÑšäÈ)) { $C¸ßŞ¨¼ø›[] = $this->parseKey($e¬›åÉçƒ) . $CÆˆóÏÍ[986] . $this->parseValue($dà“ŞÑšäÈ); } } return $CÆˆóÏÍ[987] . implode($CÆˆóÏÍ[47], $C¸ßŞ¨¼ø›); } protected function bindParam($CÕ—¤Æ˜ŞÔ, $aÍ»Ê¼àâï) { $this->bind[$_SERVER[©äõ½¡][4] . $CÕ—¤Æ˜ŞÔ] = $aÍ»Ê¼àâï; } protected function parseBind($eóÆôÅ±ô™) { $eóÆôÅ±ô™ = array_merge($this->bind, $eóÆôÅ±ô™); $this->bind = array(); return $eóÆôÅ±ô™; } function parseKey(&$AÁ¬‚ÊÆà, $DÓ™¦ƒôÄƒ = true) { if ($DÓ™¦ƒôÄƒ) { $AÁ¬‚ÊÆà = $this->parseKeyCheck($AÁ¬‚ÊÆà); } return $AÁ¬‚ÊÆà; } function parseKeyCheck($A¿­†÷Ü«‘) { $Aç²„Şˆã£ =& $_SERVER[©äõ½¡]; $A¿­†÷Ü«‘ = trim($A¿­†÷Ü«‘); if (!preg_match($Aç²„Şˆã£[988], $A¿­†÷Ü«‘)) { think_exception($Aç²„Şˆã£[989] . $A¿­†÷Ü«‘); } return $A¿­†÷Ü«‘; } protected function parseValue($aÁÈÃ‰ƒ‘Â) { $a¨êØ¦ƒ£´ =& $_SERVER[©äõ½¡]; if (is_string($aÁÈÃ‰ƒ‘Â)) { $aÁÈÃ‰ƒ‘Â = $a¨êØ¦ƒ£´[951] . $this->escapeString($aÁÈÃ‰ƒ‘Â) . $a¨êØ¦ƒ£´[951]; } elseif (isset($aÁÈÃ‰ƒ‘Â[0]) && is_string($aÁÈÃ‰ƒ‘Â[0]) && strtolower($aÁÈÃ‰ƒ‘Â[0]) == $a¨êØ¦ƒ£´[295]) { $aÁÈÃ‰ƒ‘Â = $this->escapeString($aÁÈÃ‰ƒ‘Â[1]); } elseif (is_array($aÁÈÃ‰ƒ‘Â)) { $aÁÈÃ‰ƒ‘Â = array_map(array($this, $a¨êØ¦ƒ£´[952]), $aÁÈÃ‰ƒ‘Â); } elseif (is_bool($aÁÈÃ‰ƒ‘Â)) { $aÁÈÃ‰ƒ‘Â = $aÁÈÃ‰ƒ‘Â ? $a¨êØ¦ƒ£´[87] : $a¨êØ¦ƒ£´[191]; } elseif (is_null($aÁÈÃ‰ƒ‘Â)) { $aÁÈÃ‰ƒ‘Â = $a¨êØ¦ƒ£´[103]; } return $aÁÈÃ‰ƒ‘Â; } protected function parseField($C­Ìâ±’ÓÜ) { $eæ‡Ñê¥«ø =& $_SERVER[©äõ½¡]; if (is_string($C­Ìâ±’ÓÜ) && strpos($C­Ìâ±’ÓÜ, $eæ‡Ñê¥«ø[47])) { $C­Ìâ±’ÓÜ = explode($eæ‡Ñê¥«ø[47], $C­Ìâ±’ÓÜ); } if (is_array($C­Ìâ±’ÓÜ)) { $AÓÆê­ÒÇ = array(); foreach ($C­Ìâ±’ÓÜ as $d¬İ–«‡° => $C¿Œó–ºßÅ) { if (!is_numeric($d¬İ–«‡°)) { $AÓÆê­ÒÇ[] = $this->parseKey($d¬İ–«‡°, !1) . $eæ‡Ñê¥«ø[990] . $this->parseKey($C¿Œó–ºßÅ); } else { $AÓÆê­ÒÇ[] = $this->parseKey($C¿Œó–ºßÅ); } } $E®½ºˆŠì = implode($eæ‡Ñê¥«ø[47], $AÓÆê­ÒÇ); } elseif (is_string($C­Ìâ±’ÓÜ) && !empty($C­Ìâ±’ÓÜ)) { $E®½ºˆŠì = $C­Ìâ±’ÓÜ; } else { $E®½ºˆŠì = $eæ‡Ñê¥«ø[182]; } return $E®½ºˆŠì; } protected function parseTable($C¡£Å‹Ø) { $C·‡’›À =& $_SERVER[©äõ½¡]; if (is_array($C¡£Å‹Ø)) { $DáïÃï›È = array(); foreach ($C¡£Å‹Ø as $Aöå¨—¯å => $Cİœ“õ…ÃË) { if (!is_numeric($Aöå¨—¯å)) { $DáïÃï›È[] = $this->parseKey($Aöå¨—¯å) . $C·‡’›À[50] . $this->parseKey($Cİœ“õ…ÃË); } else { $DáïÃï›È[] = $this->parseKey($Aöå¨—¯å); } } $C¡£Å‹Ø = $DáïÃï›È; } elseif (is_string($C¡£Å‹Ø)) { if (strstr($C¡£Å‹Ø, $C·‡’›À[50])) { return $C¡£Å‹Ø; } $C¡£Å‹Ø = explode($C·‡’›À[47], $C¡£Å‹Ø); array_walk($C¡£Å‹Ø, array($this, $C·‡’›À[901])); } return $C·‡’›À[895] . trim(implode($C·‡’›À[991], $C¡£Å‹Ø), $C·‡’›À[383]) . $C·‡’›À[895]; } protected function parseWhere($fìµ”§¥¸) { $b¿ìÑ§Ìš² =& $_SERVER[©äõ½¡]; $FÊ¶ÙÃ³ï = $b¿ìÑ§Ìš²[33]; if (is_string($fìµ”§¥¸)) { $FÊ¶ÙÃ³ï = $fìµ”§¥¸; } else { $dœôºÇÌö« = isset($fìµ”§¥¸[$b¿ìÑ§Ìš²[992]]) ? strtoupper($fìµ”§¥¸[$b¿ìÑ§Ìš²[992]]) : $b¿ìÑ§Ìš²[33]; if (in_array($dœôºÇÌö«, array($b¿ìÑ§Ìš²[993], $b¿ìÑ§Ìš²[994], $b¿ìÑ§Ìš²[995]))) { $dœôºÇÌö« = $b¿ìÑ§Ìš²[50] . $dœôºÇÌö« . $b¿ìÑ§Ìš²[50]; unset($fìµ”§¥¸[$b¿ìÑ§Ìš²[992]]); } else { $dœôºÇÌö« = $b¿ìÑ§Ìš²[996]; } foreach ($fìµ”§¥¸ as $D…·Ñ‘±¼ => $aÇŒ‘Ÿô—†) { $FÊ¶ÙÃ³ï .= $b¿ìÑ§Ìš²[275]; if (is_numeric($D…·Ñ‘±¼)) { $D…·Ñ‘±¼ = $b¿ìÑ§Ìš²[997]; } if (0 === strpos($D…·Ñ‘±¼, $b¿ìÑ§Ìš²[71])) { $FÊ¶ÙÃ³ï .= $this->parseThinkWhere($D…·Ñ‘±¼, $aÇŒ‘Ÿô—†); } else { if (!preg_match($b¿ìÑ§Ìš²[998], trim($D…·Ñ‘±¼))) { think_exception(think_lang($b¿ìÑ§Ìš²[999]) . $b¿ìÑ§Ìš²[4] . $D…·Ñ‘±¼); } $CÙ‘ÌÏ¬¶ = is_array($aÇŒ‘Ÿô—†) && isset($aÇŒ‘Ÿô—†[$b¿ìÑ§Ìš²[1000]]); $D…·Ñ‘±¼ = trim($D…·Ñ‘±¼); if (strpos($D…·Ñ‘±¼, $b¿ìÑ§Ìš²[281])) { $a§ŞÎİ…´ = explode($b¿ìÑ§Ìš²[281], $D…·Ñ‘±¼); $E³³Ù„·¼“ = array(); foreach ($a§ŞÎİ…´ as $fê¹íºœ => $b‰—°´³ï) { $B»–æĞÚå = $CÙ‘ÌÏ¬¶ ? $aÇŒ‘Ÿô—†[$fê¹íºœ] : $aÇŒ‘Ÿô—†; $E³³Ù„·¼“[] = $b¿ìÑ§Ìš²[258] . $this->parseWhereItem($this->parseKey($b‰—°´³ï), $B»–æĞÚå) . $b¿ìÑ§Ìš²[900]; } $FÊ¶ÙÃ³ï .= implode($b¿ìÑ§Ìš²[1001], $E³³Ù„·¼“); } elseif (strpos($D…·Ñ‘±¼, $b¿ìÑ§Ìš²[282])) { $a§ŞÎİ…´ = explode($b¿ìÑ§Ìš²[282], $D…·Ñ‘±¼); $E³³Ù„·¼“ = array(); foreach ($a§ŞÎİ…´ as $fê¹íºœ => $b‰—°´³ï) { $B»–æĞÚå = $CÙ‘ÌÏ¬¶ ? $aÇŒ‘Ÿô—†[$fê¹íºœ] : $aÇŒ‘Ÿô—†; $E³³Ù„·¼“[] = $b¿ìÑ§Ìš²[258] . $this->parseWhereItem($this->parseKey($b‰—°´³ï), $B»–æĞÚå) . $b¿ìÑ§Ìš²[900]; } $FÊ¶ÙÃ³ï .= implode($b¿ìÑ§Ìš²[996], $E³³Ù„·¼“); } else { $FÊ¶ÙÃ³ï .= $this->parseWhereItem($this->parseKey($D…·Ñ‘±¼), $aÇŒ‘Ÿô—†); } } $FÊ¶ÙÃ³ï .= $b¿ìÑ§Ìš²[276] . $dœôºÇÌö«; } $FÊ¶ÙÃ³ï = substr($FÊ¶ÙÃ³ï, 0, -strlen($dœôºÇÌö«)); } return empty($FÊ¶ÙÃ³ï) ? $b¿ìÑ§Ìš²[33] : $b¿ìÑ§Ìš²[1002] . $FÊ¶ÙÃ³ï; } protected function parseWhereItem($cÑ™ˆôÃ·, $DÄğ³Ş‰è) { $f¹¥µ¦¡§ =& $_SERVER[©äõ½¡]; $Aï¡‘¦– = $f¹¥µ¦¡§[33]; if (is_array($DÄğ³Ş‰è)) { if (is_string($DÄğ³Ş‰è[0])) { $d•¨ÒÍùè§ = strtolower($DÄğ³Ş‰è[0]); if (in_array($DÄğ³Ş‰è[0], array($f¹¥µ¦¡§[986], $f¹¥µ¦¡§[1003], $f¹¥µ¦¡§[1004], $f¹¥µ¦¡§[1005], $f¹¥µ¦¡§[1006], $f¹¥µ¦¡§[1007]))) { $Aï¡‘¦– .= $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $DÄğ³Ş‰è[0] . $f¹¥µ¦¡§[50] . $this->parseValue($DÄğ³Ş‰è[1]); } elseif (preg_match($f¹¥µ¦¡§[1008], $DÄğ³Ş‰è[0])) { $Aï¡‘¦– .= $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $this->exp[$d•¨ÒÍùè§] . $f¹¥µ¦¡§[50] . $this->parseValue($DÄğ³Ş‰è[1]); } elseif (preg_match($f¹¥µ¦¡§[1009], $DÄğ³Ş‰è[0])) { if (is_array($DÄğ³Ş‰è[1])) { $Bã¦“‹Å = isset($DÄğ³Ş‰è[2]) ? strtoupper($DÄğ³Ş‰è[2]) : $f¹¥µ¦¡§[994]; if (in_array($Bã¦“‹Å, array($f¹¥µ¦¡§[993], $f¹¥µ¦¡§[994], $f¹¥µ¦¡§[995]))) { $Dç®Ò¤×Ä” = array(); foreach ($DÄğ³Ş‰è[1] as $b„åÅÑ»«§) { $Dç®Ò¤×Ä”[] = $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $this->exp[$d•¨ÒÍùè§] . $f¹¥µ¦¡§[50] . $this->parseValue($b„åÅÑ»«§); } $Aï¡‘¦– .= $f¹¥µ¦¡§[258] . implode($f¹¥µ¦¡§[50] . $Bã¦“‹Å . $f¹¥µ¦¡§[50], $Dç®Ò¤×Ä”) . $f¹¥µ¦¡§[900]; } } else { $Aï¡‘¦– .= $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $this->exp[$d•¨ÒÍùè§] . $f¹¥µ¦¡§[50] . $this->parseValue($DÄğ³Ş‰è[1]); } } elseif ($f¹¥µ¦¡§[295] == $d•¨ÒÍùè§) { $Aï¡‘¦– .= $f¹¥µ¦¡§[898] . $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $DÄğ³Ş‰è[1] . $f¹¥µ¦¡§[1010]; } elseif (preg_match($f¹¥µ¦¡§[1011], $DÄğ³Ş‰è[0])) { $Aï¡‘¦– .= $DÄğ³Ş‰è[0]; } elseif (preg_match($f¹¥µ¦¡§[1012], $DÄğ³Ş‰è[0])) { if (isset($DÄğ³Ş‰è[2]) && $f¹¥µ¦¡§[295] == $DÄğ³Ş‰è[2]) { $Aï¡‘¦– .= $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $this->exp[$d•¨ÒÍùè§] . $f¹¥µ¦¡§[50] . $DÄğ³Ş‰è[1]; } else { if (is_string($DÄğ³Ş‰è[1])) { $DÄğ³Ş‰è[1] = explode($f¹¥µ¦¡§[47], $DÄğ³Ş‰è[1]); } $fÕ§¼èå¡š = implode($f¹¥µ¦¡§[47], $this->parseValue($DÄğ³Ş‰è[1])); $Aï¡‘¦– .= $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $this->exp[$d•¨ÒÍùè§] . $f¹¥µ¦¡§[898] . $fÕ§¼èå¡š . $f¹¥µ¦¡§[900]; } } elseif (preg_match($f¹¥µ¦¡§[1013], $DÄğ³Ş‰è[0])) { $E´…¾•‹ã¿ = is_string($DÄğ³Ş‰è[1]) ? explode($f¹¥µ¦¡§[47], $DÄğ³Ş‰è[1]) : $DÄğ³Ş‰è[1]; $Aï¡‘¦– .= $f¹¥µ¦¡§[898] . $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $this->exp[$d•¨ÒÍùè§] . $f¹¥µ¦¡§[50] . $this->parseValue($E´…¾•‹ã¿[0]) . $f¹¥µ¦¡§[996] . $this->parseValue($E´…¾•‹ã¿[1]) . $f¹¥µ¦¡§[276]; } else { think_exception(think_lang($f¹¥µ¦¡§[999]) . $f¹¥µ¦¡§[4] . $DÄğ³Ş‰è[0]); } } else { $A ¾…Ôš = count($DÄğ³Ş‰è); $bã½¯Ÿ• = $f¹¥µ¦¡§[33]; if (is_string($DÄğ³Ş‰è[$A ¾…Ôš - 1])) { $bã½¯Ÿ• = isset($DÄğ³Ş‰è[$A ¾…Ôš - 1]) ? strtoupper($DÄğ³Ş‰è[$A ¾…Ôš - 1]) : $f¹¥µ¦¡§[33]; if (in_array($bã½¯Ÿ•, array($f¹¥µ¦¡§[993], $f¹¥µ¦¡§[994], $f¹¥µ¦¡§[995]))) { $A ¾…Ôš = $A ¾…Ôš - 1; } } else { $bã½¯Ÿ• = $f¹¥µ¦¡§[993]; } for ($C‰©°‰Ô = 0; $C‰©°‰Ô < $A ¾…Ôš; $C‰©°‰Ô++) { $E´…¾•‹ã¿ = is_array($DÄğ³Ş‰è[$C‰©°‰Ô]) ? $DÄğ³Ş‰è[$C‰©°‰Ô][1] : $DÄğ³Ş‰è[$C‰©°‰Ô]; if ($f¹¥µ¦¡§[295] == strtolower($DÄğ³Ş‰è[$C‰©°‰Ô][0])) { $Aï¡‘¦– .= $f¹¥µ¦¡§[258] . $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $E´…¾•‹ã¿ . $f¹¥µ¦¡§[1010] . $bã½¯Ÿ• . $f¹¥µ¦¡§[50]; } else { $FƒŠ»İ–õÖ = is_array($DÄğ³Ş‰è[$C‰©°‰Ô]) ? $this->exp[strtolower($DÄğ³Ş‰è[$C‰©°‰Ô][0])] : $f¹¥µ¦¡§[986]; if (!$FƒŠ»İ–õÖ && is_array($DÄğ³Ş‰è[$C‰©°‰Ô]) && in_array($DÄğ³Ş‰è[$C‰©°‰Ô][0], array($f¹¥µ¦¡§[986], $f¹¥µ¦¡§[1003], $f¹¥µ¦¡§[1004], $f¹¥µ¦¡§[1005], $f¹¥µ¦¡§[1006], $f¹¥µ¦¡§[1007]))) { $FƒŠ»İ–õÖ = $DÄğ³Ş‰è[$C‰©°‰Ô][0]; } $Aï¡‘¦– .= $f¹¥µ¦¡§[258] . $cÑ™ˆôÃ· . $f¹¥µ¦¡§[50] . $FƒŠ»İ–õÖ . $f¹¥µ¦¡§[50] . $this->parseValue($E´…¾•‹ã¿) . $f¹¥µ¦¡§[1010] . $bã½¯Ÿ• . $f¹¥µ¦¡§[50]; } } $Aï¡‘¦– = substr($Aï¡‘¦–, 0, -4); } } else { $Aï¡‘¦– .= $cÑ™ˆôÃ· . $f¹¥µ¦¡§[1014] . $this->parseValue($DÄğ³Ş‰è); } return $Aï¡‘¦–; } protected function parseThinkWhere($C¬ÒĞ„Í, $D¾ƒ¸ƒÕ‰) { $AÂ¤±¢ªÀà =& $_SERVER[©äõ½¡]; $E§›“–½¬à = $AÂ¤±¢ªÀà[33]; switch ($C¬ÒĞ„Í) { case $AÂ¤±¢ªÀà[350]: $E§›“–½¬à = $D¾ƒ¸ƒÕ‰; break; case $AÂ¤±¢ªÀà[997]: $E§›“–½¬à = is_string($D¾ƒ¸ƒÕ‰) ? $D¾ƒ¸ƒÕ‰ : substr($this->parseWhere($D¾ƒ¸ƒÕ‰), 6); break; case $AÂ¤±¢ªÀà[1015]: parse_str($D¾ƒ¸ƒÕ‰, $BææºŠÍôô); if (isset($BææºŠÍôô[$AÂ¤±¢ªÀà[992]])) { $FÍœ‡§Í½˜ = $AÂ¤±¢ªÀà[50] . strtoupper($BææºŠÍôô[$AÂ¤±¢ªÀà[992]]) . $AÂ¤±¢ªÀà[50]; unset($BææºŠÍôô[$AÂ¤±¢ªÀà[992]]); } else { $FÍœ‡§Í½˜ = $AÂ¤±¢ªÀà[996]; } $A´–ˆ±†·˜ = array(); foreach ($BææºŠÍôô as $a‚æ¹†Íùø => $f”‘Òè‰ÄŸ) { $A´–ˆ±†·˜[] = $this->parseKey($a‚æ¹†Íùø) . $AÂ¤±¢ªÀà[1014] . $this->parseValue($f”‘Òè‰ÄŸ); } $E§›“–½¬à = implode($FÍœ‡§Í½˜, $A´–ˆ±†·˜); break; } return $E§›“–½¬à; } protected function parseLimit($CÜÏÑâ¯ù‰) { $fµÍ¤± ë– =& $_SERVER[©äõ½¡]; return !empty($CÜÏÑâ¯ù‰) ? $fµÍ¤± ë–[48] . $CÜÏÑâ¯ù‰ . $fµÍ¤± ë–[50] : $fµÍ¤± ë–[33]; } protected function parseJoin($FõëéÄªÛß) { $aŒ½ŠªÙƒÉ =& $_SERVER[©äõ½¡]; $E¦õèßË³Ú = $aŒ½ŠªÙƒÉ[33]; if (!empty($FõëéÄªÛß)) { if (is_array($FõëéÄªÛß)) { foreach ($FõëéÄªÛß as $eŠï©¢ì… => $d¶¢Ì®Ëñ›) { if (!1 !== stripos($d¶¢Ì®Ëñ›, $aŒ½ŠªÙƒÉ[1016])) { $E¦õèßË³Ú .= $aŒ½ŠªÙƒÉ[50] . $d¶¢Ì®Ëñ›; } else { $E¦õèßË³Ú .= $aŒ½ŠªÙƒÉ[1017] . $d¶¢Ì®Ëñ›; } } } else { $E¦õèßË³Ú .= $aŒ½ŠªÙƒÉ[1017] . $FõëéÄªÛß; } } $E¦õèßË³Ú = preg_replace($aŒ½ŠªÙƒÉ[1018], think_config($aŒ½ŠªÙƒÉ[924]) . $aŒ½ŠªÙƒÉ[1019], $E¦õèßË³Ú); return $E¦õèßË³Ú; } protected function parseOrder($e‡ŒæÉµˆ) { $aÓ¹Ô”àá =& $_SERVER[©äõ½¡]; if (is_array($e‡ŒæÉµˆ)) { $c¹Â¶‚¦æ› = array(); foreach ($e‡ŒæÉµˆ as $Côö‘Ÿ÷±´ => $DØŒÎßºå¹) { if (is_numeric($Côö‘Ÿ÷±´)) { $c¹Â¶‚¦æ›[] = $this->parseKey($DØŒÎßºå¹); } else { $DØŒÎßºå¹ = in_array(strtoupper(trim($DØŒÎßºå¹)), array($aÓ¹Ô”àá[1020], $aÓ¹Ô”àá[1021])) ? $aÓ¹Ô”àá[50] . $DØŒÎßºå¹ : $aÓ¹Ô”àá[33]; if (preg_match($aÓ¹Ô”àá[1022], $Côö‘Ÿ÷±´)) { $c¹Â¶‚¦æ›[] = $this->parseKey($Côö‘Ÿ÷±´) . $DØŒÎßºå¹; } else { think_exception($aÓ¹Ô”àá[1023] . $Côö‘Ÿ÷±´); } } } $e‡ŒæÉµˆ = implode($aÓ¹Ô”àá[47], $c¹Â¶‚¦æ›); } return !empty($e‡ŒæÉµˆ) ? $aÓ¹Ô”àá[1024] . $e‡ŒæÉµˆ : $aÓ¹Ô”àá[33]; } protected function parseGroup($AŒ¶˜‘’ËÈ) { $EÅ½§¨â¶’ =& $_SERVER[©äõ½¡]; return !empty($AŒ¶˜‘’ËÈ) ? $EÅ½§¨â¶’[1025] . $AŒ¶˜‘’ËÈ : $EÅ½§¨â¶’[33]; } protected function parseHaving($b³ó¥¹‰†«) { $a¥Òæ¾©‰ƒ =& $_SERVER[©äõ½¡]; return !empty($b³ó¥¹‰†«) ? $a¥Òæ¾©‰ƒ[1026] . $b³ó¥¹‰†« : $a¥Òæ¾©‰ƒ[33]; } protected function parseComment($dÛ¯Øº¬¦) { $FÒÌÈ‰Ğ¯ä =& $_SERVER[©äõ½¡]; return !empty($dÛ¯Øº¬¦) ? $FÒÌÈ‰Ğ¯ä[1027] . $dÛ¯Øº¬¦ . $FÒÌÈ‰Ğ¯ä[1028] : $FÒÌÈ‰Ğ¯ä[33]; } protected function parseDistinct($a‹‘ÌÜØì…) { $cè„ù²”áº =& $_SERVER[©äõ½¡]; return !empty($a‹‘ÌÜØì…) ? $cè„ù²”áº[1029] : $cè„ù²”áº[33]; } protected function parseUnion($fë±øÑÇ×) { $aóˆƒº±‹± =& $_SERVER[©äõ½¡]; if (empty($fë±øÑÇ×)) { return $aóˆƒº±‹±[33]; } if (isset($fë±øÑÇ×[$aóˆƒº±‹±[346]])) { $AöÁåÈ†ß = $aóˆƒº±‹±[1030]; unset($fë±øÑÇ×[$aóˆƒº±‹±[346]]); } else { $AöÁåÈ†ß = $aóˆƒº±‹±[1031]; } foreach ($fë±øÑÇ× as $DÜïš”ÚÙ­) { $FëãÕ‹Ã¾”[] = $AöÁåÈ†ß . (is_array($DÜïš”ÚÙ­) ? $this->buildSelectSql($DÜïš”ÚÙ­) : $DÜïš”ÚÙ­); } return implode($aóˆƒº±‹±[50], $FëãÕ‹Ã¾”); } public function insert($CÑ÷Èê«Ô, $aä¡‘ÄàìË = array(), $F­ÃÅöŒ»· = false) { goto bì‘‹†Ú†š; bì‘‹†Ú†š: $dºòÄ„­ò =& $_SERVER[©äõ½¡]; $cãğåó”Â = $FİÎÆÅ×ã = array(); $this->model = $aä¡‘ÄàìË[$dºòÄ„­ò[279]]; goto b•ä©—æ–à; DĞÖÚí•š÷: $BĞ˜²˜¨¬î .= $this->parseComment(!empty($aä¡‘ÄàìË[$dºòÄ„­ò[352]]) ? $aä¡‘ÄàìË[$dºòÄ„­ò[352]] : $dºòÄ„­ò[33]); return $this->execute($BĞ˜²˜¨¬î, $this->parseBind(!empty($aä¡‘ÄàìË[$dºòÄ„­ò[283]]) ? $aä¡‘ÄàìË[$dºòÄ„­ò[283]] : array())); goto D¬˜èàò´; b•ä©—æ–à: foreach ($CÑ÷Èê«Ô as $eáÂã“¶Øõ => $d›Ö¥Ú‚ÎÀ) { if (is_array($d›Ö¥Ú‚ÎÀ) && $dºòÄ„­ò[295] == $d›Ö¥Ú‚ÎÀ[0]) { $FİÎÆÅ×ã[] = $this->parseKey($eáÂã“¶Øõ); $cãğåó”Â[] = $d›Ö¥Ú‚ÎÀ[1]; } elseif (is_scalar($d›Ö¥Ú‚ÎÀ) || is_null($d›Ö¥Ú‚ÎÀ)) { $FİÎÆÅ×ã[] = $this->parseKey($eáÂã“¶Øõ); $cãğåó”Â[] = $this->parseValue($d›Ö¥Ú‚ÎÀ); } } $BĞ˜²˜¨¬î = ($F­ÃÅöŒ»· ? $dºòÄ„­ò[902] : $dºòÄ„­ò[903]) . $dºòÄ„­ò[904] . $this->parseTable($aä¡‘ÄàìË[$dºòÄ„­ò[277]]) . $dºòÄ„­ò[898] . implode($dºòÄ„­ò[47], $FİÎÆÅ×ã) . $dºòÄ„­ò[899] . implode($dºòÄ„­ò[47], $cãğåó”Â) . $dºòÄ„­ò[900]; $BĞ˜²˜¨¬î .= $this->parseLock(isset($aä¡‘ÄàìË[$dºòÄ„­ò[849]]) ? $aä¡‘ÄàìË[$dºòÄ„­ò[849]] : !1); goto DĞÖÚí•š÷; D¬˜èàò´: } public function selectInsert($FÜ•æ§ìÛ­, $F¿¶á¼„¯ˆ, $f‚ğ¡Á…¶¨ = array()) { goto bº’Ğ¤Æàµ; bº’Ğ¤Æàµ: $dÑÎØ‰é¯Ã =& $_SERVER[©äõ½¡]; $this->model = $f‚ğ¡Á…¶¨[$dÑÎØ‰é¯Ã[279]]; if (is_string($FÜ•æ§ìÛ­)) { $FÜ•æ§ìÛ­ = explode($dÑÎØ‰é¯Ã[47], $FÜ•æ§ìÛ­); } goto E§Òéˆå®¼; aòÌ©ŞÑ‘Ÿ: return $this->execute($bâø§‡‘Òù, $this->parseBind(!empty($f‚ğ¡Á…¶¨[$dÑÎØ‰é¯Ã[283]]) ? $f‚ğ¡Á…¶¨[$dÑÎØ‰é¯Ã[283]] : array())); goto eáèÚµ»„¿; E§Òéˆå®¼: array_walk($FÜ•æ§ìÛ­, array($this, $dÑÎØ‰é¯Ã[901])); $bâø§‡‘Òù = $dÑÎØ‰é¯Ã[1032] . $this->parseTable($F¿¶á¼„¯ˆ) . $dÑÎØ‰é¯Ã[898] . implode($dÑÎØ‰é¯Ã[47], $FÜ•æ§ìÛ­) . $dÑÎØ‰é¯Ã[1010]; $bâø§‡‘Òù .= $this->buildSelectSql($f‚ğ¡Á…¶¨); goto aòÌ©ŞÑ‘Ÿ; eáèÚµ»„¿: } public function update($C„ˆÙ¥Æô, $fÜé‘Ğ¼ÍÌ) { $a¥¸ˆİÉ =& $_SERVER[©äõ½¡]; $this->model = $fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[279]]; $A©–¯½ñóÃ = $a¥¸ˆİÉ[1033] . $this->parseTable($fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[277]]) . $this->parseSet($C„ˆÙ¥Æô) . $this->parseWhere(!empty($fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[273]]) ? $fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[273]] : $a¥¸ˆİÉ[33]) . $this->parseOrder(!empty($fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[363]]) ? $fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[363]] : $a¥¸ˆİÉ[33]) . $this->parseLimit(!empty($fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[290]]) ? $fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[290]] : $a¥¸ˆİÉ[33]) . $this->parseLock(isset($fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[849]]) ? $fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[849]] : !1) . $this->parseComment(!empty($fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[352]]) ? $fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[352]] : $a¥¸ˆİÉ[33]); return $this->execute($A©–¯½ñóÃ, $this->parseBind(!empty($fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[283]]) ? $fÜé‘Ğ¼ÍÌ[$a¥¸ˆİÉ[283]] : array())); } public function delete($cÑ§¯‡Š = array()) { $BœË’¦êÍ» =& $_SERVER[©äõ½¡]; $this->model = $cÑ§¯‡Š[$BœË’¦êÍ»[279]]; $bÏ‚ÄÆš‹ô = $BœË’¦êÍ»[1034] . $this->parseTable($cÑ§¯‡Š[$BœË’¦êÍ»[277]]) . $this->parseWhere(!empty($cÑ§¯‡Š[$BœË’¦êÍ»[273]]) ? $cÑ§¯‡Š[$BœË’¦êÍ»[273]] : $BœË’¦êÍ»[33]) . $this->parseOrder(!empty($cÑ§¯‡Š[$BœË’¦êÍ»[363]]) ? $cÑ§¯‡Š[$BœË’¦êÍ»[363]] : $BœË’¦êÍ»[33]) . $this->parseLimit(!empty($cÑ§¯‡Š[$BœË’¦êÍ»[290]]) ? $cÑ§¯‡Š[$BœË’¦êÍ»[290]] : $BœË’¦êÍ»[33]) . $this->parseLock(isset($cÑ§¯‡Š[$BœË’¦êÍ»[849]]) ? $cÑ§¯‡Š[$BœË’¦êÍ»[849]] : !1) . $this->parseComment(!empty($cÑ§¯‡Š[$BœË’¦êÍ»[352]]) ? $cÑ§¯‡Š[$BœË’¦êÍ»[352]] : $BœË’¦êÍ»[33]); return $this->execute($bÏ‚ÄÆš‹ô, $this->parseBind(!empty($cÑ§¯‡Š[$BœË’¦êÍ»[283]]) ? $cÑ§¯‡Š[$BœË’¦êÍ»[283]] : array())); } public function select($f²¼Üâ¹Ñ± = array()) { goto Fšø‘ÎÛœñ; Fšø‘ÎÛœñ: $aè‘¶»›·Ö =& $_SERVER[©äõ½¡]; $this->model = $f²¼Üâ¹Ñ±[$aè‘¶»›·Ö[279]]; $dóë­Š‚Áƒ = $this->buildSelectSql($f²¼Üâ¹Ñ±); goto B‰ºÍŞ‰ƒË; B‰ºÍŞ‰ƒË: $dÚˆÊÉ³¬ = isset($f²¼Üâ¹Ñ±[$aè‘¶»›·Ö[347]]) ? $f²¼Üâ¹Ñ±[$aè‘¶»›·Ö[347]] : !1; if ($dÚˆÊÉ³¬) { $EåØ†êšÖÍ = is_string($dÚˆÊÉ³¬[$aè‘¶»›·Ö[93]]) ? $dÚˆÊÉ³¬[$aè‘¶»›·Ö[93]] : $aè‘¶»›·Ö[1035] . md5($dóë­Š‚Áƒ); $C‹×»ŠÎ×Û = think_cache($EåØ†êšÖÍ, $aè‘¶»›·Ö[33], $dÚˆÊÉ³¬); if (!1 !== $C‹×»ŠÎ×Û) { return $C‹×»ŠÎ×Û; } } $BÉ—çë­Ö = $this->query($dóë­Š‚Áƒ, $this->parseBind(!empty($f²¼Üâ¹Ñ±[$aè‘¶»›·Ö[283]]) ? $f²¼Üâ¹Ñ±[$aè‘¶»›·Ö[283]] : array())); goto a´¸ŞäîÜã; a´¸ŞäîÜã: if ($dÚˆÊÉ³¬ && !1 !== $BÉ—çë­Ö) { think_cache($EåØ†êšÖÍ, $BÉ—çë­Ö, $dÚˆÊÉ³¬); } return $BÉ—çë­Ö; goto a¶©Â²¸È½; a¶©Â²¸È½: } public function buildSelectSql($dÈå¥«‰øê = array()) { goto DÛ‰ÚÊ¥øÖ; cá¸ÌŸŒâ: $cÀôŒçêä± = $this->parseSql($this->selectSql, $dÈå¥«‰øê); $cÀôŒçêä± .= $this->parseLock(isset($dÈå¥«‰øê[$b©ŞŸÑ“ôˆ[849]]) ? $dÈå¥«‰øê[$b©ŞŸÑ“ôˆ[849]] : !1); if (isset($D§òÂÑá»Ñ)) { think_cache($D§òÂÑá»Ñ, $cÀôŒçêä±); } goto Aäå™Å•ö³; DÛ‰ÚÊ¥øÖ: $b©ŞŸÑ“ôˆ =& $_SERVER[©äõ½¡]; if (isset($dÈå¥«‰øê[$b©ŞŸÑ“ôˆ[351]])) { if (strpos($dÈå¥«‰øê[$b©ŞŸÑ“ôˆ[351]], $b©ŞŸÑ“ôˆ[47])) { list($D‹İÁ±ì¿, $d‹¿©³‚›) = explode($b©ŞŸÑ“ôˆ[47], $dÈå¥«‰øê[$b©ŞŸÑ“ôˆ[351]]); } else { $D‹İÁ±ì¿ = $dÈå¥«‰øê[$b©ŞŸÑ“ôˆ[351]]; } $D‹İÁ±ì¿ = $D‹İÁ±ì¿ ? $D‹İÁ±ì¿ : 1; $d‹¿©³‚› = isset($d‹¿©³‚›) ? $d‹¿©³‚› : (is_numeric($dÈå¥«‰øê[$b©ŞŸÑ“ôˆ[290]]) ? $dÈå¥«‰øê[$b©ŞŸÑ“ôˆ[290]] : 20); $CÍİ¥İ‘ë = $d‹¿©³‚› * ((int) $D‹İÁ±ì¿ - 1); $dÈå¥«‰øê[$b©ŞŸÑ“ôˆ[290]] = $CÍİ¥İ‘ë . $b©ŞŸÑ“ôˆ[47] . $d‹¿©³‚›; } if (think_config($b©ŞŸÑ“ôˆ[1036])) { $D§òÂÑá»Ñ = $b©ŞŸÑ“ôˆ[1037] . md5(serialize($dÈå¥«‰øê)); $C¦íåÖ‡ã½ = think_cache($D§òÂÑá»Ñ); if ($C¦íåÖ‡ã½) { return $C¦íåÖ‡ã½; } } goto cá¸ÌŸŒâ; Aäå™Å•ö³: return $cÀôŒçêä±; goto Aİ§§·ÉÔ; Aİ§§·ÉÔ: } public function parseSql($Cïğ·ÏŒ‹, $E¸×§¿ñ = array()) { $e’Ğõ¦’”ë =& $_SERVER[©äõ½¡]; $Cïğ·ÏŒ‹ = str_replace(array($e’Ğõ¦’”ë[1038], $e’Ğõ¦’”ë[1039], $e’Ğõ¦’”ë[1040], $e’Ğõ¦’”ë[1041], $e’Ğõ¦’”ë[1042], $e’Ğõ¦’”ë[1043], $e’Ğõ¦’”ë[1044], $e’Ğõ¦’”ë[1045], $e’Ğõ¦’”ë[1046], $e’Ğõ¦’”ë[1047], $e’Ğõ¦’”ë[1048]), array($this->parseTable("{$E¸×§¿ñ[$e’Ğõ¦’”ë[277]]}"), $this->parseDistinct(isset($E¸×§¿ñ[$e’Ğõ¦’”ë[1049]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[1049]] : !1), $this->parseField(!empty($E¸×§¿ñ[$e’Ğõ¦’”ë[271]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[271]] : $e’Ğõ¦’”ë[182]), $this->parseJoin(!empty($E¸×§¿ñ[$e’Ğõ¦’”ë[280]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[280]] : $e’Ğõ¦’”ë[33]), $this->parseWhere(!empty($E¸×§¿ñ[$e’Ğõ¦’”ë[273]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[273]] : $e’Ğõ¦’”ë[33]), $this->parseGroup(!empty($E¸×§¿ñ[$e’Ğõ¦’”ë[509]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[509]] : $e’Ğõ¦’”ë[33]), $this->parseHaving(!empty($E¸×§¿ñ[$e’Ğõ¦’”ë[1050]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[1050]] : $e’Ğõ¦’”ë[33]), $this->parseOrder(!empty($E¸×§¿ñ[$e’Ğõ¦’”ë[363]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[363]] : $e’Ğõ¦’”ë[33]), $this->parseLimit(!empty($E¸×§¿ñ[$e’Ğõ¦’”ë[290]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[290]] : $e’Ğõ¦’”ë[33]), $this->parseUnion(!empty($E¸×§¿ñ[$e’Ğõ¦’”ë[345]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[345]] : $e’Ğõ¦’”ë[33]), $this->parseComment(!empty($E¸×§¿ñ[$e’Ğõ¦’”ë[352]]) ? $E¸×§¿ñ[$e’Ğõ¦’”ë[352]] : $e’Ğõ¦’”ë[33])), $Cïğ·ÏŒ‹); return $Cïğ·ÏŒ‹; } public function getLastSql($d¦Ü« ‰… = '') { return $d¦Ü« ‰… ? $this->modelSql[$d¦Ü« ‰…] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($A·‰“æš¥ñ) { return addslashes($A·‰“æš¥ñ); } public function setModel($eÈŒÏ…Öåø) { $this->model = $eÈŒÏ…Öåø; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto Cà‚ê¦¾¢é; e¿…¥ Å: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\164\160\72\57\x2f\x76\60\x2e\141\x70\x69\56\x75\x70\x79\x75\x6e\56\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($cĞÛ³á¥ã¡) { parent::__construct(); $this->_init($cĞÛ³á¥ã¡); } public function _init($EŸÛŠíÔš–) { $a°÷¹Šóâ =& $_SERVER[©äõ½¡]; foreach ($EŸÛŠíÔš– as $dñÑ¨×„å => $BÂÈçšñ£Å) { if (isset($this->{$dñÑ¨×„å})) { $this->{$dñÑ¨×„å} = $BÂÈçšñ£Å; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($a°÷¹Šóâ[1362] . LNG($a°÷¹Šóâ[1295])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($eÌ®­„Šëõ, $fáÍÌŸ­óŠ = "\x47\105\124") { $Cßò§ÉÙ‰© =& $_SERVER[©äõ½¡]; $A§öåÙĞ = gmdate($Cßò§ÉÙ‰©[1328]); $BÚºŸ—Š‚˜ = base64_encode(hash_hmac($Cßò§ÉÙ‰©[1363], "{$fáÍÌŸ­óŠ}\46{$eÌ®­„Šëõ}\x26{$A§öåÙĞ}", md5("{$this->userpass}"), !0)); $dßè›íÈ¦ = array("\x41\165\164\150\157\162\x69\x7a\x61\164\x69\x6f\156\x3a\x55\120\131\125\116\x20{$this->username}\x3a{$BÚºŸ—Š‚˜}", "\104\141\164\x65\72{$A§öåÙĞ}"); return $dßè›íÈ¦; } public function ussRequest($cÕöŒƒÖ¹†, $D°¥‰©¹Êˆ = "\107\x45\124", $dåêÔ¿µÄŠ = false, $f¬„®…Òß³ = false, $eŸôƒ°›Í = false) { goto aˆŞİ”„ù; d«ÆœãØ«ê: $dÇÃÚ¬‹ËÍ = $this->ussHeaders($cêõŒÒ‚ç÷, $D°¥‰©¹Êˆ); if ($f¬„®…Òß³) { $dÇÃÚ¬‹ËÍ = array_merge($dÇÃÚ¬‹ËÍ, $f¬„®…Òß³); } $e˜áÓ…¤»† = url_request($this->endpoint . $cêõŒÒ‚ç÷, $D°¥‰©¹Êˆ, $dåêÔ¿µÄŠ, $dÇÃÚ¬‹ËÍ, $eŸôƒ°›Í); goto E‡ä³Á­îÇ; aˆŞİ”„ù: $CÖß£æÁì =& $_SERVER[©äõ½¡]; $cÕöŒƒÖ¹† = trim($cÕöŒƒÖ¹†, $CÖß£æÁì[8]); $cêõŒÒ‚ç÷ = "\x2f{$this->bucket}\x2f{$cÕöŒƒÖ¹†}"; goto d«ÆœãØ«ê; E‡ä³Á­îÇ: if (!$e˜áÓ…¤»†) { return array($CÖß£æÁì[1119] => !1, $CÖß£æÁì[1121] => $CÖß£æÁì[1364]); } if (strtolower($D°¥‰©¹Êˆ) == $CÖß£æÁì[190] || in_array($e˜áÓ…¤»†[$CÖß£æÁì[1119]], array($CÖß£æÁì[1222], $CÖß£æÁì[1365]))) { $dåêÔ¿µÄŠ = $e˜áÓ…¤»†[$CÖß£æÁì[1366]]; } else { $dåêÔ¿µÄŠ = json_decode($e˜áÓ…¤»†[$CÖß£æÁì[1121]], !0); if (!$dåêÔ¿µÄŠ) { $dåêÔ¿µÄŠ = $e˜áÓ…¤»†[$CÖß£æÁì[1121]]; } else { if (!$e˜áÓ…¤»†[$CÖß£æÁì[745]] && isset($dåêÔ¿µÄŠ[$CÖß£æÁì[1367]])) { $dåêÔ¿µÄŠ = $dåêÔ¿µÄŠ[$CÖß£æÁì[1367]]; } } } return array($CÖß£æÁì[1119] => $e˜áÓ…¤»†[$CÖß£æÁì[745]], $CÖß£æÁì[1121] => $dåêÔ¿µÄŠ); goto D‚¡à¥”Õù; D‚¡à¥”Õù: } public function mkfile($bï…ÉŠ, $d¼‚ßÂÜéª = '', $b„¼‰İÄô¬ = REPEAT_RENAME) { if ($this->setContent($bï…ÉŠ, $d¼‚ßÂÜéª)) { return $this->getPathOuter($bï…ÉŠ); } return !1; } public function mkdir($DŸå§ÃÙÅä, $F¬ß»²í°Ã = REPEAT_SKIP) { $Bß»•¹‰Øà =& $_SERVER[©äõ½¡]; $Eù£‰¨ÁÑ = trim($DŸå§ÃÙÅä, $Bß»•¹‰Øà[8]); if ($this->_isFolder($Eù£‰¨ÁÑ)) { return $this->getPathOuter($Eù£‰¨ÁÑ); } $D¤ù©ê•™ = array($Bß»•¹‰Øà[1368]); $fÚ„’‡Ç† = $this->ussRequest($Eù£‰¨ÁÑ, $Bß»•¹‰Øà[224], !1, $D¤ù©ê•™); return $fÚ„’‡Ç†[$Bß»•¹‰Øà[1119]] ? $this->getPathOuter($Eù£‰¨ÁÑ) : !1; } public function copyFile($cæÓƒ·ŠÊ±, $B¡ŒõÂéÃù) { $FËõ‡ÉÏØ =& $_SERVER[©äõ½¡]; $eëÊéÖŸ‹  = array($FËõ‡ÉÏØ[1369] . "\57{$this->bucket}\57{$cæÓƒ·ŠÊ±}", $FËõ‡ÉÏØ[1370]); $E¦¯èÃ‹¢¢ = $this->ussRequest($B¡ŒõÂéÃù, $FËõ‡ÉÏØ[226], !1, $eëÊéÖŸ‹ ); return $E¦¯èÃ‹¢¢[$FËõ‡ÉÏØ[1119]] ? !0 : $this->getPathOuter($B¡ŒõÂéÃù); } public function moveFile($f›îï¯—ï‘, $F‰‚İšäÅš) { $e—¨¬øŸ =& $_SERVER[©äõ½¡]; $FÅ‘Æç±õ = array($e—¨¬øŸ[1371] . "\57{$this->bucket}\x2f{$f›îï¯—ï‘}", $e—¨¬øŸ[1370]); $bØºáã¸Ë¢ = $this->ussRequest($F‰‚İšäÅš, $e—¨¬øŸ[226], !1, $FÅ‘Æç±õ); return $bØºáã¸Ë¢[$e—¨¬øŸ[1119]] ? !0 : $this->getPathOuter($F‰‚İšäÅš); } public function delFile($a›‡¦éí¥†) { $A¢Ü‚ÆŒº =& $_SERVER[©äõ½¡]; $EÅ²ã¿ï¹ = $this->ussRequest($a›‡¦éí¥†, $A¢Ü‚ÆŒº[1372]); return $EÅ²ã¿ï¹[$A¢Ü‚ÆŒº[1119]] ? !0 : !1; } public function delFolder($f‹’ÖĞ¾) { goto f–å“Œ¢…·; f–å“Œ¢…·: $CÚîçÛ‹Ó =& $_SERVER[©äõ½¡]; if (!$this->exist($f‹’ÖĞ¾)) { return !0; } $this->listItemCache = !1; goto bæ’ÑÏÍ“Ò; C¼ˆ°øÅŸ‰: foreach ($bÖİ¨Æ‰¢› as $d Ñ¨±„‹) { $FØ¢£‹”¼„ = $this->ussRequest($d Ñ¨±„‹[$CÚîçÛ‹Ó[28]], $CÚîçÛ‹Ó[1372]); if (!$FØ¢£‹”¼„[$CÚîçÛ‹Ó[1119]]) { return !1; } } foreach ($aäíºŠ¼¼İ as $eËà¶õêÆÓ) { $FØ¢£‹”¼„ = $this->ussRequest($eËà¶õêÆÓ, $CÚîçÛ‹Ó[1372]); if (!$FØ¢£‹”¼„[$CÚîçÛ‹Ó[1119]]) { return !1; } } $FØ¢£‹”¼„ = $this->ussRequest($f‹’ÖĞ¾, $CÚîçÛ‹Ó[1372]); goto A½ƒ´‘â¸Û; A½ƒ´‘â¸Û: return $FØ¢£‹”¼„[$CÚîçÛ‹Ó[1119]]; goto eŒ•±”Ø; bæ’ÑÏÍ“Ò: $aäíºŠ¼¼İ = $bÖİ¨Æ‰¢› = array(); $this->fileList($f‹’ÖĞ¾, $aäíºŠ¼¼İ, $bÖİ¨Æ‰¢›, !0); $this->listItemCache = !0; goto C¼ˆ°øÅŸ‰; eŒ•±”Ø: } public function rename($fÆäŸªóö‰, $aÚêÆÃñ†…) { if ($this->isFile($fÆäŸªóö‰)) { $aÚêÆÃñ†… = get_path_father($fÆäŸªóö‰) . $aÚêÆÃñ†…; return $this->moveFile($fÆäŸªóö‰, $aÚêÆÃñ†…); } return $this->renameObject($fÆäŸªóö‰, $aÚêÆÃñ†…); } public function fileInfo($d²ïä¢°‰Ò, $d´òÙ¼³ã = false, $f™Üùß“ö = array()) { goto DĞå¬³Ä‰Ñ; c¬ƒöÚ¶İò: return $bö­“èôÉ¿; goto dñ¾µ•ñ; F‡­¾ÕÂ¨Æ: $bö­“èôÉ¿[$aß–¾œÅ”‚[194]] = intval($f™Üùß“ö[$aß–¾œÅ”‚[1373]]); $bö­“èôÉ¿[$aß–¾œÅ”‚[84]] = intval($f™Üùß“ö[$aß–¾œÅ”‚[1374]]); $bö­“èôÉ¿[$aß–¾œÅ”‚[78]] = $f™Üùß“ö[$aß–¾œÅ”‚[78]]; goto c¬ƒöÚ¶İò; AÂ“’Ú˜ˆ§: $bö­“èôÉ¿[$aß–¾œÅ”‚[194]] = $bö­“èôÉ¿[$aß–¾œÅ”‚[84]] = 0; $bö­“èôÉ¿[$aß–¾œÅ”‚[195]] = $bö­“èôÉ¿[$aß–¾œÅ”‚[196]] = !0; if (empty($f™Üùß“ö)) { $f™Üùß“ö = $this->objectMeta($d²ïä¢°‰Ò); if (!$f™Üùß“ö) { return $bö­“èôÉ¿; } } goto F‡­¾ÕÂ¨Æ; DĞå¬³Ä‰Ñ: $aß–¾œÅ”‚ =& $_SERVER[©äõ½¡]; $bö­“èôÉ¿ = array($aß–¾œÅ”‚[28] => $this->pathThis($d²ïä¢°‰Ò), $aß–¾œÅ”‚[76] => $this->getPathOuter($aß–¾œÅ”‚[8] . $d²ïä¢°‰Ò), $aß–¾œÅ”‚[29] => $aß–¾œÅ”‚[193], $aß–¾œÅ”‚[78] => isset($f™Üùß“ö[$aß–¾œÅ”‚[78]]) ? $f™Üùß“ö[$aß–¾œÅ”‚[78]] : 0, $aß–¾œÅ”‚[168] => $this->ext($d²ïä¢°‰Ò)); if ($d´òÙ¼³ã) { return $bö­“èôÉ¿; } goto AÂ“’Ú˜ˆ§; dñ¾µ•ñ: } public function folderInfo($e°Ÿ¬Ğ°¤, $eß¼áŠª’ = false) { goto f©Œöàñ¾É; f©Œöàñ¾É: $fÂ¡í»˜¿à =& $_SERVER[©äõ½¡]; $b«Ÿá×ˆ = array($fÂ¡í»˜¿à[28] => $this->pathThis($e°Ÿ¬Ğ°¤), $fÂ¡í»˜¿à[76] => $this->getPathOuter($fÂ¡í»˜¿à[8] . $e°Ÿ¬Ğ°¤), $fÂ¡í»˜¿à[29] => $fÂ¡í»˜¿à[77]); if ($eß¼áŠª’) { return $b«Ÿá×ˆ; } goto fÕªô¨‡‘ê; fÕªô¨‡‘ê: $b«Ÿá×ˆ[$fÂ¡í»˜¿à[194]] = $b«Ÿá×ˆ[$fÂ¡í»˜¿à[84]] = 0; $b«Ÿá×ˆ[$fÂ¡í»˜¿à[195]] = $b«Ÿá×ˆ[$fÂ¡í»˜¿à[196]] = !0; if (empty($f¹À—â–óÑ)) { $f¹À—â–óÑ = $this->objectMeta($e°Ÿ¬Ğ°¤); if (!$f¹À—â–óÑ) { return $b«Ÿá×ˆ; } } goto d¯ Ô†Œ¬‘; d¯ Ô†Œ¬‘: $b«Ÿá×ˆ[$fÂ¡í»˜¿à[194]] = intval($f¹À—â–óÑ[$fÂ¡í»˜¿à[1373]]); $b«Ÿá×ˆ[$fÂ¡í»˜¿à[84]] = intval($f¹À—â–óÑ[$fÂ¡í»˜¿à[1374]]); return $b«Ÿá×ˆ; goto DïÑä°×“™; DïÑä°×“™: } private function listObjs($d×…æ„„àã, $cŞ†Ğ›§åœ = 0, $Cğ…¾ˆ¶…• = 1000) { $b’ˆ¤ö¼’ˆ =& $_SERVER[©äõ½¡]; $b•¦÷«ƒ®« = array($b’ˆ¤ö¼’ˆ[1375], $b’ˆ¤ö¼’ˆ[1376] . $Cğ…¾ˆ¶…•); if ($cŞ†Ğ›§åœ) { $b•¦÷«ƒ®«[] = $b’ˆ¤ö¼’ˆ[1377] . $cŞ†Ğ›§åœ; } $fë©œÁ¦ö = $this->ussRequest($d×…æ„„àã, $b’ˆ¤ö¼’ˆ[228], !1, $b•¦÷«ƒ®«); return !$fë©œÁ¦ö[$b’ˆ¤ö¼’ˆ[1119]] ? !1 : $fë©œÁ¦ö[$b’ˆ¤ö¼’ˆ[1121]]; } private function fileList($bËèªô¢­ó, &$A¦ç—³´åË, &$dÂÉêß»¯, $FôÚÏ¬Ëî² = false) { goto bŞÁ«é¡ğ‚; bŞÁ«é¡ğ‚: $E®ñäâ¡äÅ =& $_SERVER[©äõ½¡]; $DìÑ‰´ÊÛ = $E®ñäâ¡äÅ[33]; $D¾Ğ£Õ½ö« = 1000; goto eµŠ¢¹¨‡¼; eµŠ¢¹¨‡¼: $AÛ šÅ×Ù = rtrim($bËèªô¢­ó, $E®ñäâ¡äÅ[8]) . $E®ñäâ¡äÅ[8]; $fñ‰¨Â‡è = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $AªÈ‚‰Ü³¹ = $this->listObjs($bËèªô¢­ó, $DìÑ‰´ÊÛ, $D¾Ğ£Õ½ö«); if (!$AªÈ‚‰Ü³¹) { return !1; } $DìÑ‰´ÊÛ = isset($AªÈ‚‰Ü³¹[$E®ñäâ¡äÅ[1378]]) ? $AªÈ‚‰Ü³¹[$E®ñäâ¡äÅ[1378]] : $E®ñäâ¡äÅ[33]; $d×ÈÍæåÎ± = isset($AªÈ‚‰Ü³¹[$E®ñäâ¡äÅ[1379]]) ? $AªÈ‚‰Ü³¹[$E®ñäâ¡äÅ[1379]] : array(); foreach ($d×ÈÍæåÎ± as $EíŒ¿†) { $cªò³›ê©‡ = $EíŒ¿†[$E®ñäâ¡äÅ[29]] == $E®ñäâ¡äÅ[77] ? !0 : !1; $BÁ‰ÅØç = ltrim($AÛ šÅ×Ù . $EíŒ¿†[$E®ñäâ¡äÅ[28]], $E®ñäâ¡äÅ[8]) . ($cªò³›ê©‡ ? $E®ñäâ¡äÅ[8] : $E®ñäâ¡äÅ[33]); $C¤äƒâÒ = array($E®ñäâ¡äÅ[28] => $BÁ‰ÅØç, $E®ñäâ¡äÅ[29] => $cªò³›ê©‡ ? $E®ñäâ¡äÅ[77] : $E®ñäâ¡äÅ[193], $E®ñäâ¡äÅ[78] => $EíŒ¿†[$E®ñäâ¡äÅ[335]], $E®ñäâ¡äÅ[1374] => $EíŒ¿†[$E®ñäâ¡äÅ[1380]]); if ($fñ‰¨Â‡è) { $this->cacheMethod($E®ñäâ¡äÅ[199], $BÁ‰ÅØç, $cªò³›ê©‡); $this->cacheMethod($E®ñäâ¡äÅ[200], $BÁ‰ÅØç, $C¤äƒâÒ); } if ($cªò³›ê©‡) { $A¦ç—³´åË[] = $BÁ‰ÅØç; if ($FôÚÏ¬Ëî²) { $this->fileList($BÁ‰ÅØç, $A¦ç—³´åË, $dÂÉêß»¯, $FôÚÏ¬Ëî²); } continue; } $dÂÉêß»¯[] = $C¤äƒâÒ; } if (count($d×ÈÍæåÎ±) < $D¾Ğ£Õ½ö«) { break; } } goto b²²“¬„æÇ; b²²“¬„æÇ: if ($fñ‰¨Â‡è) { $this->cacheMethod($E®ñäâ¡äÅ[199], $bËèªô¢­ó, !0); } goto DˆãÃßÇØ•; DˆãÃßÇØ•: } public function listPath($D‹Í¯Í¨, $CÏŸ¡·¿ˆ = false) { $E§–ƒÆâÙ =& $_SERVER[©äõ½¡]; $aòøÑ’‹„Š = $e†‰È¦„×Ú = array(); $this->fileList($D‹Í¯Í¨, $aòøÑ’‹„Š, $e†‰È¦„×Ú); foreach ($aòøÑ’‹„Š as $f›‰•à£Å½ => $F¨çÅÏóìå) { $aòøÑ’‹„Š[$f›‰•à£Å½] = $this->folderInfo($F¨çÅÏóìå, $CÏŸ¡·¿ˆ); } foreach ($e†‰È¦„×Ú as $f›‰•à£Å½ => $F¨çÅÏóìå) { $e†‰È¦„×Ú[$f›‰•à£Å½] = $this->fileInfo($F¨çÅÏóìå[$E§–ƒÆâÙ[28]], $CÏŸ¡·¿ˆ, $F¨çÅÏóìå); } return array($E§–ƒÆâÙ[75] => $aòøÑ’‹„Š, $E§–ƒÆâÙ[74] => $e†‰È¦„×Ú); } public function has($eçà‡½…, $eÅ¤ôõ¾¡È = false, $Bô—å„çÇÑ = true) { goto d‡†À‘ó²í; D¨ïƒê ¬¬: while (!0) { check_abort(); $EíğÓóêğ = $this->listObjs($eçà‡½…, $fÑ›Õ¼Æ‰÷, $AØØ‹´ù²÷); if (!$EíğÓóêğ) { return !1; } $fÑ›Õ¼Æ‰÷ = isset($EíğÓóêğ[$FòÖáˆØº[1378]]) ? $EíğÓóêğ[$FòÖáˆØº[1378]] : $FòÖáˆØº[33]; $C¼¦¢àĞƒ = isset($EíğÓóêğ[$FòÖáˆØº[1379]]) ? $EíğÓóêğ[$FòÖáˆØº[1379]] : array(); if (empty($C¼¦¢àĞƒ)) { break; } $c‹õ¸Í½ñæ = array_filter($C¼¦¢àĞƒ, function ($F®¸×Ûå) { $dˆË«ˆ™áâ =& $_SERVER[©äõ½¡]; return $F®¸×Ûå[$dˆË«ˆ™áâ[29]] == $dˆË«ˆ™áâ[77]; }); $CšÕù´¿ÁÑ = count($C¼¦¢àĞƒ); $c‹õ¸Í½ñæ = count($c‹õ¸Í½ñæ); $bÇÍÏ”š†½ = $CšÕù´¿ÁÑ - $c‹õ¸Í½ñæ; if ($eÅ¤ôõ¾¡È) { $c¬é–ÚÏÖØ += $c‹õ¸Í½ñæ; $d„Å†ÊÚÓµ += $bÇÍÏ”š†½; if ($CšÕù´¿ÁÑ < $AØØ‹´ù²÷) { break; } continue; } if ($Bô—å„çÇÑ) { if ($bÇÍÏ”š†½) { return !0; } } else { if ($c‹õ¸Í½ñæ) { return !0; } } if ($CšÕù´¿ÁÑ < $AØØ‹´ù²÷) { break; } } if ($eÅ¤ôõ¾¡È) { return array($FòÖáˆØº[203] => $d„Å†ÊÚÓµ, $FòÖáˆØº[204] => $c¬é–ÚÏÖØ); } return !1; goto B¿ö‡‘÷ÁŒ; dÜóç×õÙ±: $d„Å†ÊÚÓµ = 0; $c¬é–ÚÏÖØ = 0; $B’ºÔ†”„³ = rtrim($eçà‡½…, $FòÖáˆØº[8]) . $FòÖáˆØº[8]; goto D¨ïƒê ¬¬; d‡†À‘ó²í: $FòÖáˆØº =& $_SERVER[©äõ½¡]; $fÑ›Õ¼Æ‰÷ = $FòÖáˆØº[33]; $AØØ‹´ù²÷ = 500; goto dÜóç×õÙ±; B¿ö‡‘÷ÁŒ: } public function listAll($d°Ç³×èîƒ) { goto eœœï¹ªÙ’; d³‡ñŞ·¯: $bˆ‹ïññ…İ = array(); foreach ($c˜İ‡àŠÚè as $FËõÉ£ˆŠ) { $bˆ‹ïññ…İ[$FËõÉ£ˆŠ[$D†Õâ°ŸĞÔ[28]]] = $FËõÉ£ˆŠ[$D†Õâ°ŸĞÔ[78]]; } foreach ($b££‰Óí as $FËõÉ£ˆŠ) { if (is_string($FËõÉ£ˆŠ)) { $bˆ‹ïññ…İ[$FËõÉ£ˆŠ] = 0; } } goto bíªÛ«; bíªÛ«: return $this->listAllFiles($d°Ç³×èîƒ, array_keys($bˆ‹ïññ…İ), $bˆ‹ïññ…İ); goto eó½ÛÓİ²¡; eœœï¹ªÙ’: $D†Õâ°ŸĞÔ =& $_SERVER[©äõ½¡]; $b££‰Óí = $c˜İ‡àŠÚè = array(); $this->fileList($d°Ç³×èîƒ, $b££‰Óí, $c˜İ‡àŠÚè, !0); goto d³‡ñŞ·¯; eó½ÛÓİ²¡: } public function canRead($eÛæ¥ƒ«ßæ) { return $this->exist($eÛæ¥ƒ«ßæ) ? !0 : !1; } public function canWrite($c‚ííÈĞÙ) { return $this->exist($c‚ííÈĞÙ) ? !0 : !1; } public function getContent($A³…ÊğìÎâ) { return $this->fileSubstr($A³…ÊğìÎâ, 0, -1); } public function setContent($eïÖ˜ˆïÄŒ, $bÄ¤ÀÒÉ²  = '') { $B—¡²á¼‰İ =& $_SERVER[©äõ½¡]; if (!$bÄ¤ÀÒÉ² ) { $BóÇˆ¾êŸ = $this->ussRequest($eïÖ˜ˆïÄŒ, $B—¡²á¼‰İ[224]); return $BóÇˆ¾êŸ[$B—¡²á¼‰İ[1119]]; } $Cä¯˜Ê¤×ô = $this->tempFile($this->pathThis($eïÖ˜ˆïÄŒ)); file_put_contents($Cä¯˜Ê¤×ô, $bÄ¤ÀÒÉ² ); if ($this->upload($eïÖ˜ˆïÄŒ, $Cä¯˜Ê¤×ô)) { $this->tempFileRemve($Cä¯˜Ê¤×ô); return !0; } return !1; } public function fileSubstr($D×í§Üô¨, $FïÜù‰‚ß, $aù¾åøäùÒ) { $C¯­±ˆ…ô¬ =& $_SERVER[©äõ½¡]; if (!($Aâ¯à¾’ò = $this->link($D×í§Üô¨))) { return !1; } $f÷À©ñÊƒ© = !1; if ($aù¾åøäùÒ > 0) { $A‚¾ñÚÄ·¤ = $FïÜù‰‚ß + $aù¾åøäùÒ - 1; $f÷À©ñÊƒ© = array($C¯­±ˆ…ô¬[1341] . $FïÜù‰‚ß . $C¯­±ˆ…ô¬[454] . $A‚¾ñÚÄ·¤); } $d­¸’ò·¿ß = url_request($Aâ¯à¾’ò, $C¯­±ˆ…ô¬[228], !1, $f÷À©ñÊƒ©); return $d­¸’ò·¿ß[$C¯­±ˆ…ô¬[745]] ? $d­¸’ò·¿ß[$C¯­±ˆ…ô¬[1121]] : !1; } public function upload($eß…ô±Ù±ß, $D›À´ç‚À…, $aÂÇ‘½è‰™ = false, $C¹¡¨‹º÷ï = REPEAT_REPLACE) { goto Cå¸ó®°; a±ƒÈ’…‹: $d¡Ò˜²Òù® = $aÅ…ŸÄŒõ…[$eéïììÃ¿À[1386]]; $e§’±‘«¡ = fopen($D›À´ç‚À…, $eéïììÃ¿À[1292]); if (!$e§’±‘«¡) { return !1; } goto a®Í‹ÎÎ’ç; böƒÚ¸íÉ: if (!$fñ‰°¢ÏŸ÷[$eéïììÃ¿À[1119]]) { return !1; } $aÅ…ŸÄŒõ… = $fñ‰°¢ÏŸ÷[$eéïììÃ¿À[1121]]; $D‡Æô©±¥â = 0; goto a±ƒÈ’…‹; cçŸ¤†Ë·“: $b£æñ£Ô½§ = 1024 * 1024 * 10; $F¤‡çÊ†ã¼ = array($eéïììÃ¿À[1382], $eéïììÃ¿À[1383] . $f•¿é„§˜£, $eéïììÃ¿À[1384], $eéïììÃ¿À[1385] . $b£æñ£Ô½§); $fñ‰°¢ÏŸ÷ = $this->ussRequest($eß…ô±Ù±ß, $eéïììÃ¿À[226], !1, $F¤‡çÊ†ã¼); goto böƒÚ¸íÉ; Cå¸ó®°: $eéïììÃ¿À =& $_SERVER[©äõ½¡]; $f•¿é„§˜£ = IO::size($D›À´ç‚À…); if ($f•¿é„§˜£ <= 1024 * 1024 * 200) { $a¨ªòĞÃº = array($eéïììÃ¿À[1381] . $D›À´ç‚À…); $fñ‰°¢ÏŸ÷ = $this->ussRequest($eß…ô±Ù±ß, $eéïììÃ¿À[226], $a¨ªòĞÃº); return $fñ‰°¢ÏŸ÷[$eéïììÃ¿À[1119]] ? $this->getPathOuter($eß…ô±Ù±ß) : !1; } goto cçŸ¤†Ë·“; a®Í‹ÎÎ’ç: do { $aøÃ¼ğĞ÷æ = $aÅ…ŸÄŒõ…[$eéïììÃ¿À[1387]]; fseek_64($e§’±‘«¡, $D‡Æô©±¥â); $d¯Å£‡ÛÏø = fread($e§’±‘«¡, $aøÃ¼ğĞ÷æ); $a÷„å…âà = 0; do { $a÷„å…âà++; $aÅ…ŸÄŒõ… = $this->uploadPart($eß…ô±Ù±ß, $aÅ…ŸÄŒõ…, $d¯Å£‡ÛÏø); } while (!$aÅ…ŸÄŒõ… && $a÷„å…âà < 3); if (!$aÅ…ŸÄŒõ…) { return !1; } $d¡Ò˜²Òù® = $aÅ…ŸÄŒõ…[$eéïììÃ¿À[1386]]; $D‡Æô©±¥â += $aøÃ¼ğĞ÷æ; } while ($d¡Ò˜²Òù® != -1); fclose($e§’±‘«¡); $F¤‡çÊ†ã¼ = array($eéïììÃ¿À[1388], $eéïììÃ¿À[1389] . $aÅ…ŸÄŒõ…[$eéïììÃ¿À[1390]], $eéïììÃ¿À[1384]); goto D£†Ìµ– ; D£†Ìµ– : $fñ‰°¢ÏŸ÷ = $this->ussRequest($eß…ô±Ù±ß, $eéïììÃ¿À[226], !1, $F¤‡çÊ†ã¼); return $fñ‰°¢ÏŸ÷[$eéïììÃ¿À[1119]] ? $this->getPathOuter($AÁãïÃÑœª) : !1; goto e£Úñ´Ç¶ä; e£Úñ´Ç¶ä: } private function uploadPart($E¢Óó†º–°, $B·À«‡£ÆÁ, &$BØ½Çì»…) { $Eø¨»·í™´ =& $_SERVER[©äõ½¡]; $f¸Åß—Ï•ö = array($Eø¨»·í™´[1391], $Eø¨»·í™´[1389] . $B·À«‡£ÆÁ[$Eø¨»·í™´[1390]], $Eø¨»·í™´[1392] . $B·À«‡£ÆÁ[$Eø¨»·í™´[1386]], $Eø¨»·í™´[141] . $B·À«‡£ÆÁ[$Eø¨»·í™´[1387]]); $A÷¿ÇÆ…æÕ = $this->ussRequest($E¢Óó†º–°, $Eø¨»·í™´[226], $BØ½Çì»…, $f¸Åß—Ï•ö); return !$A÷¿ÇÆ…æÕ[$Eø¨»·í™´[1119]] ? $A÷¿ÇÆ…æÕ[$Eø¨»·í™´[1119]] : $A÷¿ÇÆ…æÕ[$Eø¨»·í™´[1121]]; } public function uploadFormData($aÁÜ ¥É‰, $EŒÒšÀ¥ªè = 3600) { return $this->uploadPolicy($aÁÜ ¥É‰, $EŒÒšÀ¥ªè); } public function multiUploadFormData($EàÊ­£ğä, $E¥ƒ¦‘„¢˜ = 3600) { $B¡ÊÏ±À§ =& $_SERVER[©äõ½¡]; $a·†«‰åßğ = (int) $GLOBALS[$B¡ÊÏ±À§[7]][$B¡ÊÏ±À§[78]]; return $this->uploadPolicy($EàÊ­£ğä, $E¥ƒ¦‘„¢˜, $a·†«‰åßğ); } private function uploadPolicy($d”œ·Ííã¯, $fØ—…Ö‰™Ñ = 3600, $eŸó“ÄÏ”ù = 0) { goto f·ÎƒĞÊÚ; C¿Öµ°åï: $c„Í†µæÎŞ = base64_encode(hash_hmac($AÆôØ±°Ø³[1363], "\x50\x4f\123\x54\x26{$Dæˆ©¶„ºö}\x26{$DŒ±ˆÏÛÈ¦}\x26{$CôÓÓè´Â}", md5("{$this->userpass}"), !0)); $fÌ±àô¤Ú¹ = array($AÆôØ±°Ø³[1234] => $CôÓÓè´Â, $AÆôØ±°Ø³[1397] => "\125\x50\131\125\116\40{$this->username}\72{$c„Í†µæÎŞ}", $AÆôØ±°Ø³[175] => $this->endpoint . $Dæˆ©¶„ºö); return $fÌ±àô¤Ú¹; goto f¹½ŒÂêá»; a·ëùî‚¢ö: $e¥·¦êà°ˆ = array($AÆôØ±°Ø³[1393] => $this->bucket, $AÆôØ±°Ø³[1394] => $d”œ·Ííã¯, $AÆôØ±°Ø³[1395] => time() + $fØ—…Ö‰™Ñ, $AÆôØ±°Ø³[1396] => $DŒ±ˆÏÛÈ¦); if ($eŸó“ÄÏ”ù) { $e¥·¦êà°ˆ[$AÆôØ±°Ø³[1308]] = $eŸó“ÄÏ”ù; } $CôÓÓè´Â = base64_encode(json_encode($e¥·¦êà°ˆ)); goto C¿Öµ°åï; f·ÎƒĞÊÚ: $AÆôØ±°Ø³ =& $_SERVER[©äõ½¡]; $Dæˆ©¶„ºö = $AÆôØ±°Ø³[8] . $this->bucket; $DŒ±ˆÏÛÈ¦ = gmdate($AÆôØ±°Ø³[1328]); goto a·ëùî‚¢ö; f¹½ŒÂêá»: } public function download($BëéÈçÇå, $BÜÉ®‰‚¸„) { goto aêÁ‡—£«ë; E•Àˆ×Èœ: fclose($bù‡ŞŒ·›); return $BÜÉ®‰‚¸„; goto C‚›ÁĞãÜ; f´ÔÒøã: $F†Âî¶¨ = 1024 * 200; $bù‡ŞŒ·› = fopen($dÖŞšÆª, $_SERVER[©äõ½¡][1347]); while (!0) { $c‚áÁ‰Ğâæ = $this->fileSubstr($BëéÈçÇå, $bÙ±‹ƒ‘è¤, $F†Âî¶¨); if ($c‚áÁ‰Ğâæ === !1) { return !1; } fwrite($bù‡ŞŒ·›, $c‚áÁ‰Ğâæ); $bÙ±‹ƒ‘è¤ += $F†Âî¶¨; if (strlen($c‚áÁ‰Ğâæ) < $F†Âî¶¨) { break; } } goto E•Àˆ×Èœ; aêÁ‡—£«ë: $dÖŞšÆª = IO::getPathInner(IO::mkfile($BÜÉ®‰‚¸„)); if (!($Aêèìò²«… = $this->link($BëéÈçÇå))) { return !1; } $bÙ±‹ƒ‘è¤ = 0; goto f´ÔÒøã; C‚›ÁĞãÜ: } public function link($bÀØáéì„ë, $b”Ä£‘‡×… = array()) { $e¤Ùƒ×î£Á =& $_SERVER[©äõ½¡]; $bÀØáéì„ë = trim($bÀØáéì„ë, $e¤Ùƒ×î£Á[8]); if (!empty($this->token)) { $C•“„ğ–‘­ = strtotime(date($e¤Ùƒ×î£Á[1398])); $c–‘‚ä¾Ÿ = substr(md5($this->token . $e¤Ùƒ×î£Á[282] . $C•“„ğ–‘­ . $e¤Ùƒ×î£Á[1399] . $bÀØáéì„ë), 12, 8) . $C•“„ğ–‘­; $b”Ä£‘‡×…[] = $e¤Ùƒ×î£Á[1400] . $c–‘‚ä¾Ÿ; } $Eˆ‰õÆˆ¡ = !empty($b”Ä£‘‡×…) ? $e¤Ùƒ×î£Á[70] . implode($e¤Ùƒ×î£Á[282], $b”Ä£‘‡×…) : $e¤Ùƒ×î£Á[33]; return $this->getHost() . $e¤Ùƒ×î£Á[8] . $bÀØáéì„ë . $Eˆ‰õÆˆ¡; } public function fileOut($B±Š×¶ŠÇÙ, $AÏ¿ª”º§¹ = false, $d¹¡š­œ¬‰ = false, $B­ô†ğœİ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($B±Š×¶ŠÇÙ, $AÏ¿ª”º§¹, $d¹¡š­œ¬‰, $B­ô†ğœİ); } if (!$d¹¡š­œ¬‰) { $d¹¡š­œ¬‰ = $this->pathThis($B±Š×¶ŠÇÙ); } $D½Š‘‚„…¦ = $AÏ¿ª”º§¹ ? array($_SERVER[©äõ½¡][1401] . rawurlencode($d¹¡š­œ¬‰)) : array(); $B·…–Ş†¿ = $this->link($B±Š×¶ŠÇÙ, $D½Š‘‚„…¦); $this->fileOutLink($B·…–Ş†¿); } public function fileOutServer($EàïÅÄÀ¶‰, $dáÙ¥ôÉÑ = false, $e„çœÃìÎ› = false, $eê„ÃÙ–‹Í = '') { parent::fileOut($EàïÅÄÀ¶‰, $dáÙ¥ôÉÑ, $e„çœÃìÎ›, $eê„ÃÙ–‹Í); } public function fileOutImage($eä×ÛÑøÈ, $cÒŸÀ×ÅÓ— = 250) { $E´ñÙˆ‹ã¼ = $this->link($eä×ÛÑøÈ . $_SERVER[©äõ½¡][1402] . $cÒŸÀ×ÅÓ—); $this->fileOutLink($E´ñÙˆ‹ã¼); } public function fileOutImageServer($b©­àª»Ÿ, $EŠ÷ä¤‹­Õ = 250) { parent::fileOutImage($b©­àª»Ÿ, $EŠ÷ä¤‹­Õ); } public function hashMd5($E‰È ®Ü) { $BÉí¼‘Â¬ =& $_SERVER[©äõ½¡]; $D½ÓİÂÉ­ = $this->_objectMeta($E‰È ®Ü); return isset($D½ÓİÂÉ­[$BÉí¼‘Â¬[208]]) ? $D½ÓİÂÉ­[$BÉí¼‘Â¬[208]] : !1; } public function size($eâÎæ‚åâ•) { $bœé†ñ¼ª = $this->objectMeta($eâÎæ‚åâ•); return $bœé†ñ¼ª ? $bœé†ñ¼ª[$_SERVER[©äõ½¡][78]] : 0; } public function info($câÛÊÖ‡–É) { if ($this->isFolder($câÛÊÖ‡–É)) { return $this->folderInfo($câÛÊÖ‡–É); } else { if ($this->isFile($câÛÊÖ‡–É)) { return $this->fileInfo($câÛÊÖ‡–É); } } return !1; } public function exist($CŠ½µô”ãÚ) { return $this->isFile($CŠ½µô”ãÚ) || $this->isFolder($CŠ½µô”ãÚ); } public function isFile($BŒ®ŸÁĞÜ®) { return !$this->isFolder($BŒ®ŸÁĞÜ®) && $this->objectMeta($BŒ®ŸÁĞÜ®); } public function isFolder($a¹ÛØ„·) { return $this->cacheMethod($_SERVER[©äõ½¡][199], $a¹ÛØ„·); } protected function objectMeta($aÔôÑÇƒŠá) { return $this->cacheMethod($_SERVER[©äõ½¡][200], $aÔôÑÇƒŠá); } protected function _objectMeta($a­ôù™öö) { goto aÇøá„øİ¸; D—÷Ö‘ËÃ‰: $DÀ¿Éàù = array($Eõ·¡º«©˜[29] => isset($B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1404]]) ? $B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1404]] : null, $Eõ·¡º«©˜[78] => isset($B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1405]]) ? $B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1405]] : null, $Eõ·¡º«©˜[208] => isset($B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1406]]) ? $B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1406]] : null, $Eõ·¡º«©˜[1373] => isset($B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1407]]) ? $B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1407]] : null); $DÀ¿Éàù[$Eõ·¡º«©˜[1374]] = isset($B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1408]]) ? strtotime($B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1408]]) : $DÀ¿Éàù[$Eõ·¡º«©˜[1373]]; return $DÀ¿Éàù; goto A‰‘ì±ë; fáº¼åõòæ: if (!$A ìÖƒ•[$Eõ·¡º«©˜[1119]]) { return null; } $B˜Ó¼×¢ƒÌ = isset($A ìÖƒ•[$Eõ·¡º«©˜[1121]]) ? $A ìÖƒ•[$Eõ·¡º«©˜[1121]] : array(); if (!isset($B˜Ó¼×¢ƒÌ[$Eõ·¡º«©˜[1404]])) { return null; } goto D—÷Ö‘ËÃ‰; aÇøá„øİ¸: $Eõ·¡º«©˜ =& $_SERVER[©äõ½¡]; if ($a­ôù™öö == $Eõ·¡º«©˜[33] || $a­ôù™öö == $Eõ·¡º«©˜[8]) { return array(); } $A ìÖƒ• = $this->ussRequest($a­ôù™öö, $Eõ·¡º«©˜[1403]); goto fáº¼åõòæ; A‰‘ì±ë: } protected function _isFolder($d–ÕÒ¬‹ä) { $F”ì‡·Š–‹ =& $_SERVER[©äõ½¡]; if ($d–ÕÒ¬‹ä == $F”ì‡·Š–‹[33] || $d–ÕÒ¬‹ä == $F”ì‡·Š–‹[8]) { return !0; } $Cì‡â‡æÙ = $this->_objectMeta($d–ÕÒ¬‹ä); return isset($Cì‡â‡æÙ[$F”ì‡·Š–‹[29]]) && $Cì‡â‡æÙ[$F”ì‡·Š–‹[29]] == $F”ì‡·Š–‹[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($C÷ËÒÈÇ‘¶ = false) { } public function exist($c¸¿Ê£ùÀŒ) { $aµ¬µËœ± = $this->info($c¸¿Ê£ùÀŒ); return $aµ¬µËœ±[$_SERVER[©äõ½¡][195]]; } public function isFile($EÃÓõì™©ç) { $f¾¦Èšˆ—Ş = $this->info($EÃÓõì™©ç); return $f¾¦Èšˆ—Ş[$_SERVER[©äõ½¡][195]]; } public function isFolder($c£‹‹Êº·Ä) { return !1; } public function size($b±İåÚ§¡ï) { $AÙÓóƒÙ‚ = $this->info($b±İåÚ§¡ï); return $AÙÓóƒÙ‚[$_SERVER[©äõ½¡][78]]; } public function info($bÓ™¨™åà) { return $this->infoParse($bÓ™¨™åà); } public function infoAuth($FŞ‰÷¯Ú•‹) { return $this->infoParse($FŞ‰÷¯Ú•‹); } public function infoWithChildren($f˜±’ĞŸÒñ) { return $this->infoParse($f˜±’ĞŸÒñ); } public function infoFull($cšåÀçŸµĞ) { return $this->infoParse($cšåÀçŸµĞ); } private function infoParse($A‘áÏ’”Ùç) { $ašÀÜ¡”³ =& $_SERVER[©äõ½¡]; $e¾õ‰ææó— = $this->header($A‘áÏ’”Ùç); if (!$e¾õ‰ææó— || !$e¾õ‰ææó—[$ašÀÜ¡”³[745]]) { return !1; } $dñÍÁÅî›è = _get($e¾õ‰ææó—, $ašÀÜ¡”³[335], 0); $d‰ŠœÙäò = array($ašÀÜ¡”³[28] => $e¾õ‰ææó—[$ašÀÜ¡”³[28]], $ašÀÜ¡”³[76] => $A‘áÏ’”Ùç, $ašÀÜ¡”³[29] => $ašÀÜ¡”³[193], $ašÀÜ¡”³[78] => intval($dñÍÁÅî›è), $ašÀÜ¡”³[168] => get_path_ext($e¾õ‰ææó—[$ašÀÜ¡”³[28]]), $ašÀÜ¡”³[1289] => $dñÍÁÅî›è > 0 && $e¾õ‰ææó—[$ašÀÜ¡”³[1409]], $ašÀÜ¡”³[1290] => !1); return $d‰ŠœÙäò; } private function header($B‹’ÎÚÂ™â) { goto aÙĞ‹¼’ó; aÙĞ‹¼’ó: $få‚Ğ×³‚¢ =& $_SERVER[©äõ½¡]; if (isset(self::$_cacheHeader[$B‹’ÎÚÂ™â])) { return self::$_cacheHeader[$B‹’ÎÚÂ™â]; } $Aµ´ñÈİ– = isset($GLOBALS[$få‚Ğ×³‚¢[1410]]) ? $GLOBALS[$få‚Ğ×³‚¢[1410]] : !1; goto BïÂ½¤‰; b˜ÕŞÏ‰˜: return self::$_cacheHeader[$B‹’ÎÚÂ™â]; goto C¡êñÊ«î¼; BïÂ½¤‰: $GLOBALS[$få‚Ğ×³‚¢[1410]] = !0; self::$_cacheHeader[$B‹’ÎÚÂ™â] = url_header($B‹’ÎÚÂ™â); $GLOBALS[$få‚Ğ×³‚¢[1410]] = $Aµ´ñÈİ–; goto b˜ÕŞÏ‰˜; C¡êñÊ«î¼: } public function hashSimple($f ÌÑ‰¼Ú¶, $CÁíÎ›ç¼¶ = false) { goto B«Ø®Ïô; aò¼çï‹’”: if ($C’ö­ªĞ‰… <= $eÍ–´àèã½ * $dÒ»»–…œ) { return md5($this->fileSubstr($f ÌÑ‰¼Ú¶, 0, $C’ö­ªĞ‰…)) . $C’ö­ªĞ‰…; } $dº Ç‹Øğ = intval($C’ö­ªĞ‰… / $dÒ»»–…œ); $B•‡››ÉÚÜ = $cæÈ¦Ç£ªÙ[33]; goto eÑ¸Ş˜õÚ˜; eÑ¸Ş˜õÚ˜: $dŒ½Àõ‚â´ = timeFloat(); $eŸÛˆ = 15; for ($DåÈÊ«İŠ = 0; $DåÈÊ«İŠ < $dÒ»»–…œ; $DåÈÊ«İŠ++) { if (timeFloat() - $dŒ½Àõ‚â´ > $eŸÛˆ) { return !1; } $dĞÔ×·Â¸ = $this->fileSubstr($f ÌÑ‰¼Ú¶, $dº Ç‹Øğ * $DåÈÊ«İŠ, $eÍ–´àèã½); if (!$dĞÔ×·Â¸) { return !1; } $B•‡››ÉÚÜ .= $dĞÔ×·Â¸; } goto F‘Ïˆ¥¨Ä; fÆ§Ù‡«ÌÆ: $C’ö­ªĞ‰… = $c§¾Öç‰ô´[$cæÈ¦Ç£ªÙ[78]]; $eÍ–´àèã½ = 200; $dÒ»»–…œ = 50; goto aò¼çï‹’”; B«Ø®Ïô: $cæÈ¦Ç£ªÙ =& $_SERVER[©äõ½¡]; $c§¾Öç‰ô´ = $this->info($f ÌÑ‰¼Ú¶); if (!$c§¾Öç‰ô´ || !$c§¾Öç‰ô´[$cæÈ¦Ç£ªÙ[195]]) { return !1; } goto fÆ§Ù‡«ÌÆ; F‘Ïˆ¥¨Ä: $B•‡››ÉÚÜ .= $this->fileSubstr($f ÌÑ‰¼Ú¶, $C’ö­ªĞ‰… - $eÍ–´àèã½, $eÍ–´àèã½); return md5($B•‡››ÉÚÜ) . $C’ö­ªĞ‰…; goto d†‘„´’£ö; d†‘„´’£ö: } public function getContent($E‘íùïÈ¦ˆ) { return $this->fileSubstr($E‘íùïÈ¦ˆ); } public function fileSubstr($eÔ˜Ø¨çÒô, $B­èÊß¸ì‡ = 0, $aíòŞêù× = -1) { goto A¤µÍßá¬¹; A¤µÍßá¬¹: $e„¼‹¬¤¦¸ =& $_SERVER[©äõ½¡]; $A´“ƒÕÒ = $this->info($eÔ˜Ø¨çÒô); if (!$A´“ƒÕÒ || !$A´“ƒÕÒ[$e„¼‹¬¤¦¸[195]] && $A´“ƒÕÒ[$e„¼‹¬¤¦¸[78]] > 1024 * 1024 * 10) { return !1; } goto A®…ï”¨¬”; A®…ï”¨¬”: if ($aíòŞêù× === -1) { $aíòŞêù× = $A´“ƒÕÒ[$e„¼‹¬¤¦¸[78]]; } if ($aíòŞêù× == 0) { return $e„¼‹¬¤¦¸[33]; } $bµ¢Ø·½­ = array($e„¼‹¬¤¦¸[1411] . $B­èÊß¸ì‡ . $e„¼‹¬¤¦¸[779] . ($B­èÊß¸ì‡ + $aíòŞêù× - 1)); goto f“ã¬èâÌ; f“ã¬èâÌ: $EÍóòÆ„·² = url_request($eÔ˜Ø¨çÒô, $e„¼‹¬¤¦¸[228], !1, $bµ¢Ø·½­, !1, !1, 1); return $EÍóòÆ„·²[$e„¼‹¬¤¦¸[1121]] ? $EÍóòÆ„·²[$e„¼‹¬¤¦¸[1121]] : $e„¼‹¬¤¦¸[33]; goto a ³ãÙ’ñµ; a ³ãÙ’ñµ: } public function download($aÈÎî©°“Ö, $E¶Œˆ—Á’ˆ) { Downloader::start($aÈÎî©°“Ö, $E¶Œˆ—Á’ˆ); return $E¶Œˆ—Á’ˆ; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($AÉ“„ÚÊåÉ, $Cß‹ïö· = '') { goto Dê±°ˆ† ; DÖ¯×ŒŸ…‚: if (!isset(self::$_chunkBuffer[$AÉ“„ÚÊåÉ])) { self::$_chunkBuffer[$AÉ“„ÚÊåÉ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto E™ª¬óùÅ£; Dê±°ˆ† : $this->info = $this->info($AÉ“„ÚÊåÉ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[©äõ½¡][76]]; goto FĞÈ¥¨ç’Ã; FĞÈ¥¨ç’Ã: $this->pathOpen = $AÉ“„ÚÊåÉ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto DÖ¯×ŒŸ…‚; E™ª¬óùÅ£: } function stream_read($a‡¾éšä˜†) { $Fæàò¥Š† = $this->fileSubstr($this->pose, $a‡¾éšä˜†); $this->pose += strlen($Fæàò¥Š†); return $Fæàò¥Š†; } public function stream_tell() { return $this->pose; } public function stream_seek($Dïª½Ÿ·ãÑ, $bºŒìÉ…½) { $DåÔÖ‹Œ” =& $_SERVER[©äõ½¡]; if ($bºŒìÉ…½ == SEEK_SET) { $this->pose = $Dïª½Ÿ·ãÑ; } else { if ($bºŒìÉ…½ == SEEK_CUR) { $this->pose += $Dïª½Ÿ·ãÑ; } else { if ($bºŒìÉ…½ == SEEK_END) { $this->pose = $this->info[$DåÔÖ‹Œ”[78]] + intval($Dïª½Ÿ·ãÑ); } } } if ($Dïª½Ÿ·ãÑ < 0) { $this->pose = $this->info[$DåÔÖ‹Œ”[78]] + $Dïª½Ÿ·ãÑ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[©äõ½¡][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($DÔ³÷¸êÊ¹, $fÈÜÈÑ²ƒõ) { $F©° èÒ =& $_SERVER[©äõ½¡]; $cä»„â‹ = $this->info($DÔ³÷¸êÊ¹); return array($F©° èÒ[1412] => 0, $F©° èÒ[1413] => 0, $F©° èÒ[12] => 32768 + 511, $F©° èÒ[1414] => 0, $F©° èÒ[1415] => 0, $F©° èÒ[1416] => 0, $F©° èÒ[1417] => 0, $F©° èÒ[78] => $cä»„â‹[$F©° èÒ[78]], $F©° èÒ[1418] => $cä»„â‹[$F©° èÒ[1288]], $F©° èÒ[1374] => $cä»„â‹[$F©° èÒ[84]], $F©° èÒ[1373] => $cä»„â‹[$F©° èÒ[194]], $F©° èÒ[1419] => 0, $F©° èÒ[1420] => 0); } static $fileInfo = array(); public function info($aÈï‰‡¶õ°) { $b¡Š×†±±÷ = $_SERVER[©äõ½¡][1421]; if (isset(self::$fileInfo[$aÈï‰‡¶õ°])) { return self::$fileInfo[$aÈï‰‡¶õ°]; } if (substr($aÈï‰‡¶õ°, 0, strlen($b¡Š×†±±÷)) != $b¡Š×†±±÷) { return !1; } self::$fileInfo[$aÈï‰‡¶õ°] = IO::info(substr($aÈï‰‡¶õ°, strlen($b¡Š×†±±÷))); return self::$fileInfo[$aÈï‰‡¶õ°]; } public static function read($b·‹¶ÛßÖ, $eİÇ‚â‡Óª, $Fõõ‡£–) { if (!isset(self::$_fopenCache[$b·‹¶ÛßÖ])) { $D‡‡Ä·âÁ = new StreamWrapperIO(); $D‡‡Ä·âÁ->stream_open($b·‹¶ÛßÖ); self::$_fopenCache[$b·‹¶ÛßÖ] = $D‡‡Ä·âÁ; } $D‡‡Ä·âÁ = self::$_fopenCache[$b·‹¶ÛßÖ]; return $D‡‡Ä·âÁ->fileSubstr($eİÇ‚â‡Óª, $Fõõ‡£–); } public static function _read($A•˜ñ°¥œ, $bï†Ç“‘, $C”‡ØŒšƒ¥) { goto d©¸‡ÌëùÃ; d©¸‡ÌëùÃ: $eÈˆ«Í‰® =& $_SERVER[©äõ½¡]; $bÏ‘Ä±Ú¾ = fopen($A•˜ñ°¥œ, $eÈˆ«Í‰®[1292]); if (!$bÏ‘Ä±Ú¾) { return $eÈˆ«Í‰®[33]; } goto dŞ“´Ú”º•; dŞ“´Ú”º•: $Aï‰‡ĞÂ§ñ = 8192; fseek($bÏ‘Ä±Ú¾, $bï†Ç“‘, SEEK_SET); $Bùé¼©¹§¥ = $eÈˆ«Í‰®[33]; goto ağ¤ˆÓƒñù; D„…–´±Á¢: return $Bùé¼©¹§¥; goto FÊñÏøñÇß; ağ¤ˆÓƒñù: $bö™ïÍ‹õ™ = 0; while ($bö™ïÍ‹õ™ < $C”‡ØŒšƒ¥) { $C–Ì§Œ‰™ = min($Aï‰‡ĞÂ§ñ, $C”‡ØŒšƒ¥ - $bö™ïÍ‹õ™); $Bùé¼©¹§¥ .= fread($bÏ‘Ä±Ú¾, $C–Ì§Œ‰™); $bö™ïÍ‹õ™ += $C–Ì§Œ‰™; } fclose($bÏ‘Ä±Ú¾); goto D„…–´±Á¢; FÊñÏøñÇß: } public function fileSubstr($dË­…Ë‚Ì°, $b£ô‰¸™ù) { goto DÃ“âÂøÕÑ; dÍŞÒƒÕ¦Á: $F©Šæó”µ = 64 * 1024; $B¦–«¨¼íò =& self::$_chunkBuffer[$this->path]; if (!$B¦–«¨¼íò) { $B¦–«¨¼íò = array(); } goto DÏÑÊÆå¢–; DÏÑÊÆå¢–: $E‰§ÊŸĞï = 0; $eÙéÉøÜº = 0; $EŠÇ¸Âô = $f”ĞÉ®˜ö[33]; goto Eª³Øô˜óÀ; f©èÉî©: ksort($B¦–«¨¼íò); $BŠÉÇ·Àà¸ = substr($D‹»ë†‹Í, $dË­…Ë‚Ì° - $AÅªº·˜”é, $b£ô‰¸™ù); return $BŠÉÇ·Àà¸; goto dë†¿ì³Ø; Eª³Øô˜óÀ: foreach ($B¦–«¨¼íò as $E‰§ÊŸĞï => $EŠÇ¸Âô) { $E‰§ÊŸĞï = intval($E‰§ÊŸĞï); $eÙéÉøÜº = $E‰§ÊŸĞï + strlen($EŠÇ¸Âô); if ($dË­…Ë‚Ì° >= $eÙéÉøÜº) { continue; } if ($dË­…Ë‚Ì° >= $E‰§ÊŸĞï && $dË­…Ë‚Ì° + $b£ô‰¸™ù <= $eÙéÉøÜº) { return substr($EŠÇ¸Âô, $dË­…Ë‚Ì° - $E‰§ÊŸĞï, $b£ô‰¸™ù); } break; } if (count($B¦–«¨¼íò) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($f”ĞÉ®˜ö[1422], $f”ĞÉ®˜ö[1423] . count($B¦–«¨¼íò) . "\73\x73\164\141\x72\164\x3d{$dË­…Ë‚Ì°}\x2c\154\x65\x6e\x67\164\150\x3d{$b£ô‰¸™ù}\73\x70\x6f\x73\145\72{$E‰§ÊŸĞï}\x7e{$eÙéÉøÜº}"); throw new Exception($f”ĞÉ®˜ö[1424]); } $AÅªº·˜”é = intval($dË­…Ë‚Ì° / $F©Šæó”µ) * $F©Šæó”µ; goto fíÁ£Ú¾ØÛ; fíÁ£Ú¾ØÛ: $câ•è¹¢½ç = ceil(($dË­…Ë‚Ì° + $b£ô‰¸™ù) / $F©Šæó”µ) * $F©Šæó”µ - $AÅªº·˜”é; $D‹»ë†‹Í = IO::fileSubstr($this->path, $AÅªº·˜”é, $câ•è¹¢½ç); $B¦–«¨¼íò[$AÅªº·˜”é . $f”ĞÉ®˜ö[33]] = $D‹»ë†‹Í; goto f©èÉî©; DÃ“âÂøÕÑ: $f”ĞÉ®˜ö =& $_SERVER[©äõ½¡]; $aÊÔôíÊ = $this->info[$f”ĞÉ®˜ö[78]]; $A—“½Òß—‹ = $dË­…Ë‚Ì°; goto aÌò®ÑëÃ÷; aÌò®ÑëÃ÷: $Cº­²ŠñË = $b£ô‰¸™ù; if ($dË­…Ë‚Ì° < 0) { $dË­…Ë‚Ì° = $aÊÔôíÊ + $dË­…Ë‚Ì°; } if ($b£ô‰¸™ù === !1) { $b£ô‰¸™ù = $aÊÔôíÊ - $dË­…Ë‚Ì°; } goto FÉ‡çä‡§‹; FÉ‡çä‡§‹: if ($dË­…Ë‚Ì° + $b£ô‰¸™ù > $aÊÔôíÊ) { $b£ô‰¸™ù = $aÊÔôíÊ - $dË­…Ë‚Ì°; } if ($b£ô‰¸™ù <= 0) { return $f”ĞÉ®˜ö[33]; } if ($dË­…Ë‚Ì° < 0 || $dË­…Ë‚Ì° >= $aÊÔôíÊ || $b£ô‰¸™ù <= 0 || $b£ô‰¸™ù > 1024 * 1024 * 10) { throw new Exception("\151\157\106\151\x6c\x65\122\x65\141\144\x20\x65\162\162\157\162\x21\x20\163\164\141\162\164\x3d{$dË­…Ë‚Ì°}\x3b\154\145\156\x67\164\150\75{$b£ô‰¸™ù}\x3b\40\x73\151\x7a\x65\75{$aÊÔôíÊ}\73"); } goto dÍŞÒƒÕ¦Á; dë†¿ì³Ø: } private function log($d¹ºµï£¼õ, $aåçÍÔ¾™®) { $FåàÀì¾ê” =& $_SERVER[©äõ½¡]; $d©¤‹ = timeFloat() - $this->timeStart; write_log(sprintf($FåàÀì¾ê”[1425], $d¹ºµï£¼õ, $this->info[$FåàÀì¾ê”[28]], $d©¤‹, $aåçÍÔ¾™®), $FåàÀì¾ê”[1111]); } } goto C†‡®´ô’; D¿œ“Ï‚°Í: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72\137\x66\141\166"; protected function cacheFunctionAlias($AÏª±ç©ìö) { $dåß‡Å«ƒÈ =& $_SERVER[©äõ½¡]; return array($dåß‡Å«ƒÈ[1840] => array(USER_ID, $dåß‡Å«ƒÈ[1841])); } protected function listData() { $CÑ‰’Øõè =& $_SERVER[©äõ½¡]; $cÆ¯¶šÖõ = array($CÑ‰’Øõè[1555] => USER_ID, $CÑ‰’Øõè[477] => array($CÑ‰’Øõè[1844], 0)); $b²½Çàµ¬à = $CÑ‰’Øõè[1846]; $DÀêôï»™¤ = $this->field($b²½Çàµ¬à)->where($cÆ¯¶šÖõ)->order($CÑ‰’Øõè[1847])->select(); return $DÀêôï»™¤ ? $DÀêôï»™¤ : array(); } protected function listByTag($AöË§†¢èô) { } protected function addToTag($Fè³©‰ƒµÄ, $fÓë‹˜²§ñ) { $fÄ„¥’ùì =& $_SERVER[©äõ½¡]; if (!Model($fÄ„¥’ùì[1980])->listData($fÓë‹˜²§ñ) || !Model($fÄ„¥’ùì[827])->pathInfo($Fè³©‰ƒµÄ)) { return !1; } $d‚¬ÔÎÃÖ‰ = array($fÄ„¥’ùì[1555] => USER_ID, $fÄ„¥’ùì[477] => $fÓë‹˜²§ñ, $fÄ„¥’ùì[416] => $Fè³©‰ƒµÄ, $fÄ„¥’ùì[417] => $fÄ„¥’ùì[411], $fÄ„¥’ùì[415] => $fÄ„¥’ùì[33], $fÄ„¥’ùì[1737] => 0); if ($this->where($d‚¬ÔÎÃÖ‰)->find()) { return !1; } return $this->add($d‚¬ÔÎÃÖ‰); } protected function removeFromTag($e×â£Ş§µÍ, $cáÙ¼»×Ù´) { $EÈÁË³Ü¶ =& $_SERVER[©äõ½¡]; if (!Model($EÈÁË³Ü¶[1980])->listData($cáÙ¼»×Ù´)) { return !1; } if (is_array($e×â£Ş§µÍ)) { $e×â£Ş§µÍ = array($EÈÁË³Ü¶[7], $e×â£Ş§µÍ); } $EÉÓí–ŞæÙ = array($EÈÁË³Ü¶[1555] => USER_ID, $EÈÁË³Ü¶[477] => $cáÙ¼»×Ù´, $EÈÁË³Ü¶[417] => $EÈÁË³Ü¶[411], $EÈÁË³Ü¶[416] => $e×â£Ş§µÍ); return $this->where($EÉÓí–ŞæÙ)->delete(); } protected function removeByTag($b§øô©©¼ò) { $b¸±×«¯¶Â =& $_SERVER[©äõ½¡]; if (!$b§øô©©¼ò) { return !1; } $AòÁÜ«ã³… = array($b¸±×«¯¶Â[1555] => USER_ID, $b¸±×«¯¶Â[477] => $b§øô©©¼ò); return $this->where($AòÁÜ«ã³…)->delete(); } protected function removeBySource($cÊ¦Á§œ­„) { $f†¹³äå¬ =& $_SERVER[©äõ½¡]; if (is_array($cÊ¦Á§œ­„)) { $cÊ¦Á§œ­„ = array($f†¹³äå¬[7], $cÊ¦Á§œ­„); } $aØŒù…ºÇ = array($f†¹³äå¬[1555] => USER_ID, $f†¹³äå¬[416] => $cÊ¦Á§œ­„, $f†¹³äå¬[477] => array($f†¹³äå¬[1006], 0)); return $this->where($aØŒù…ºÇ)->delete(); } }